标题title
一种基于粒子网格适配算法的流固耦合方法以及装置
摘要abst
本申请涉及一种基于粒子网格适配算法的流固耦合方法以及装置。所述方法包括：根据流固耦合实验要求进行初始化，生成临界网格，确定接触粒子；以临界网格作为中间媒介实现流体端和耦合框架preCICE之间的连接，将流体端产生的力和临界网格进行插值从而传递给preCICE，然后preCICE再将力传递到固体结构，固体结构受到了力并且产生了形变的位移，并且把形变位移通过preCICE回传给临界网格，临界网格把形变位移和接触粒子进行插值进而更新其粒子的位置坐标信息。本发明能够复用网格接口的同时又可以通过粒子插值的方式支持无网格方法的耦合，极大的扩充了preCICE耦合软件的应用范围。
权利要求书clms
1.一种基于粒子网格适配算法的流固耦合方法，其特征在于，所述方法包括：根据流固耦合实验要求信息建立初始的物理模型；所述物理模型设定了求解区域以及耦合边界条件；所述求解区域包括流体端和固体端；根据所述耦合边界条件和preCICE接口的定义标准生成临界网格；根据所述流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；计算所述流体粒子对所述临界网格产生的合力，将所述合力和所述临界网格进行插值，并通过preCICE将力传递给所述固体端；在所述固体端在所述合力的作用下产生形变位移后，通过preCICE将所述形变位移回传给所述临界网格，通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息；在所述流体端和所述固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到流固耦合实验的耦合响应。2.根据权利要求1所述的方法，其特征在于，在根据所述耦合边界条件和preCICE接口的定义标准生成临界网格之后，还包括：在preCICE的配置文件中配置耦合参数；所述耦合参数用于确定流体端和固体端的求解器、preCICE使用的映射规则、通信方式和耦合方案。3.根据权利要求2所述的方法，其特征在于，在preCICE的配置文件中配置耦合参数；所述耦合参数用于确定流体端和固体端的求解器、preCICE使用的映射规则、通信方式和耦合方案，包括：在precice-configure.xml配置文件里面定义流体求解器FluidSolver和固体求解器SolidSolver；设置数据映射方案；所述数据映射方案包括最近邻映射，最近投影和最径向基插值映射；配置通信方式；所述通信方式包括基于MPI方式的通信模式和基于TC/IP协议的网格通信模式；配置耦合方案；所述耦合方案包括显示串行、显示并行、隐式串行和隐式并行；当程序加载并开始运行时，将所述precice-configure.xml配置文件读取到preCICE中；由preCICE根据所述precice-configure.xml配置文件加载对应的耦合参数。4.根据权利要求1所述的方法，其特征在于，在通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息之前，还包括：施加耦合边界条件，以约束所述接触粒子不穿透所述固体端的边界。5.根据权利要求1所述的方法，其特征在于，所述临界网格位于所述流体端和所述固体端之间的接触面之间。6.根据权利要求1所述的方法，其特征在于，根据所述流体端的流体粒子到临界网格面片法向量的距离确定接触粒子，包括：获取所述求解区域中流体端的流体粒子到临界网格面片法向量的距离；若距离小于预设的接触阈值，则判定流体粒子与临界网格面片产生接触，所述流体粒子为接触粒子；所述接触阈值为SPH算法的光滑长度。7.根据权利要求1所述的方法，其特征在于，将所述合力和所述临界网格进行插值，包括：根据设定的插值精度将所述合力和所述临界网格进行插值，以使从所述流体端传递到所述固体端的力与所述流体粒子对临界网格产生的合力一致；其中，插值操作通过多线程并行进行。8.根据权利要求1所述的方法，其特征在于，通过所述临界网格将所述形变位移和所述接触粒子进行插值，包括：通过所述临界网格根据设定的插值精度将所述形变位移和所述接触粒子进行插值，以使所述流体粒子位置的更新能够遵守质量，动量以及能量守恒定律；其中，插值操作通过多线程并行进行。9.一种基于粒子网格适配算法的流固耦合装置，其特征在于，所述装置包括：初始化模块，用于根据流固耦合实验要求信息建立初始的物理模型；所述物理模型设定了求解区域以及耦合边界条件；所述求解区域包括流体端和固体端；临界网格确定模块，用于根据所述耦合边界条件和preCICE接口的定义标准生成临界网格；接触粒子确定模块，用于根据所述流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；力插值模块，用于计算所述流体粒子对所述临界网格产生的合力，将所述合力和所述临界网格进行插值，并通过preCICE将力传递给固体端；位移插值模块，用于在所述固体端在所述合力的作用下产生形变位移后，通过preCICE将所述形变位移回传给所述临界网格，通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息；迭代求解模块，用于在流体端和固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到流固耦合实验的耦合响应。10.根据权利要求9所述的装置，其特征在于，所述临界网格确定模块还用于：在preCICE的配置文件中配置耦合参数；所述耦合参数用于确定流体端和固体端的求解器、preCICE使用的映射规则、通信方式和耦合方案。
说明书desc
技术领域本申请涉及并行计算以及计算流体力学领域，特别是涉及一种基于粒子网格适配算法的流固耦合方法以及装置。背景技术在实际的物理问题的研究中，大部分都可以归结为多物理场求解的问题，而其中流固耦合是一项重要的研究内容，它涉及到计算流体力学，计算固体力学以及材料学的相关理论基础。目前还没有一个统一的理论能够解决其中面临的所有问题，流固耦合的现象发生在实际中随处可见，并且影响着各个方面。随着计算机技术的发展，流固耦合问题能够用计算机进行求解，它极大的推动了航空航天，工业制造，能源开发等领域的发展，但目前由于技术有限，仍然存在很多难以克服的问题。多物理场耦合框架是一个多物理场耦合库，它功能强大以及目前有活跃的用户作为支持，提供了数据映射以及各种耦合方案，并且提供各种类型的接口支持外部调用，使得耦合的求解器容易更新和进一步更新，同时，该软件的模块化程度高，可以当作黑盒模型进行使用，因此目前该软件兼容了大部分的在数值模拟领域具有极大影响力的开源软件，包括开源软件Alya，Ateles和闭源软件甚至商业软件COMSOL Multiphysics，Ansys Fluent等，它能够非常方便的直接进行FSI问题的求解，并且更换不同的求解器仅需更换连接preCICE耦合库的适配器，基于以上的这些优点，使得即便没有掌握许多的耦合理论的研究者也能够最快速的使用该耦合框架。极大的加速了流固耦合工作的研究进程，因此preCICE耦合框架是研究流固耦合理论的首选原型系统。在使用preCICE进行流固耦合的开发时，流体端和固体端均采用基于网格的方法进行计算，例如基于有限体积方法实现的开源软件OpenFoam，以及基于有限元方法实现的软件Deal.II，这些方法都存在一个特点，在计算的时候都依赖于网格，网格的质量好坏直接影响到最终的计算结果以及精度。preCICE在多物理场耦合领域取得了很大的成功，目前还没有提供基于粒子方法的耦合方案，以往提供兼容的求解器都是基于网格的方法。这样导致擅长模拟自由表面流，大变形以及高速冲击响应问题的粒子方法没有发挥出应有的长处。因此，开发出能够耦合基于无网格的粒子方法兼容到preCICE多物理场耦合库是一项重要且富有前景的研究内容。发明内容基于此，有必要针对上述技术问题，提供一种能够将无网格方法纳入到耦合框架preCICE中求解FSI问题的基于粒子网格适配的流固耦合求解方法、装置、计算机设备和存储介质。一种基于粒子网格适配算法的流固耦合方法，所述方法包括：根据流固耦合实验要求信息建立初始的物理模型；所述物理模型设定了求解区域以及耦合边界条件；所述求解区域包括流体端和固体端；根据所述耦合边界条件和preCICE接口的定义标准生成临界网格；根据所述流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；计算所述流体粒子对所述临界网格产生的合力，将所述合力和所述临界网格进行插值，并通过preCICE将力传递给所述固体端；在所述固体端在所述合力的作用下产生形变位移后，通过preCICE将所述形变位移回传给所述临界网格，通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息；在所述流体端和所述固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到流固耦合实验的耦合响应。在其中一个实施例中，还包括：在preCICE的配置文件中配置耦合参数；所述耦合参数用于确定流体端和固体端的求解器、preCICE使用的映射规则、通信方式和耦合方案。在其中一个实施例中，还包括：在precice-configure.xml配置文件里面定义流体求解器FluidSolver和固体求解器SolidSolver；设置数据映射方案；所述数据映射方案包括最近邻映射，最近投影和最径向基插值映射；配置通信方式；所述通信方式包括基于MPI方式的通信模式和基于TC/IP协议的网格通信模式；配置耦合方案；所述耦合方案包括显示串行、显示并行、隐式串行和隐式并行；当程序加载并开始运行时，将所述precice-configure.xml配置文件读取到preCICE中；由preCICE根据所述precice-configure.xml配置文件加载对应的耦合参数。在其中一个实施例中，还包括：在通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息之前，施加耦合边界条件，以约束所述接触粒子不穿透所述固体端的边界。在其中一个实施例中，还包括：所述临界网格位于所述流体端和所述固体端之间的接触面之间。在其中一个实施例中，还包括：获取所述求解区域中流体端的流体粒子到临界网格面片法向量的距离；若距离小于预设的接触阈值，则判定流体粒子与临界网格面片产生接触，所述流体粒子为接触粒子；所述接触阈值为SPH算法的光滑长度。在其中一个实施例中，还包括：根据设定的插值精度将所述合力和所述临界网格进行插值，以使从所述流体端传递到所述固体端的力与所述流体粒子对临界网格产生的合力一致；其中，插值操作通过多线程并行进行；其中，插值操作通过多线程并行进行。在其中一个实施例中，还包括：通过所述临界网格根据设定的插值精度将所述形变位移和所述接触粒子进行插值，以使所述流体粒子位置的更新能够遵守质量，动量以及能量守恒定律；其中，插值操作通过多线程并行进行。一种基于粒子网格适配算法的流固耦合装置，所述装置包括：初始化模块，用于根据流固耦合实验要求建立初始的物理模型；所述物理模型设定了求解区域以及耦合边界条件；所述求解区域包括流体端和固体端；临界网格确定模块，用于根据所述耦合边界条件和preCICE接口的定义标准生成临界网格；接触粒子确定模块，用于根据所述流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；力插值模块，用于计算所述流体粒子对临界网格产生的合力，将所述合力和所述临界网格进行插值，并通过preCICE将力传递给固体端；位移插值模块，用于在固体端受到所述合力的作用后产生形变位移后，通过preCICE将所述形变位移回传给所述临界网格，通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息；迭代求解模块，用于在流体端和固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到所述流固耦合实验的耦合响应。一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，所述处理器执行所述计算机程序时实现以下步骤：根据流固耦合实验要求建立初始的物理模型；所述物理模型设定了求解区域以及耦合边界条件；所述求解区域包括流体端和固体端；根据所述耦合边界条件和preCICE接口的定义标准生成临界网格；根据所述流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；计算所述流体粒子对临界网格产生的合力，将所述合力和所述临界网格进行插值，并通过preCICE将力传递给固体端；在固体端受到所述合力的作用后产生形变位移后，通过preCICE将所述形变位移回传给所述临界网格，通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息；在流体端和固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到所述流固耦合实验的耦合响应。一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现以下步骤：根据流固耦合实验要求建立初始的物理模型；所述物理模型设定了求解区域以及耦合边界条件；所述求解区域包括流体端和固体端；根据所述耦合边界条件和preCICE接口的定义标准生成临界网格；根据所述流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；计算所述流体粒子对临界网格产生的合力，将所述合力和所述临界网格进行插值，并通过preCICE将力传递给固体端；在固体端受到所述合力的作用后产生形变位移后，通过preCICE将所述形变位移回传给所述临界网格，通过所述临界网格将所述形变位移和所述接触粒子进行插值，得到所述接触粒子更新后的位置坐标信息；在流体端和固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到所述流固耦合实验的耦合响应。上述基于粒子网格适配的流固耦合求解方法、装置、计算机设备和存储介质，根据流固耦合实验要求设定求解区域以及耦合边界条件，根据耦合边界条件和preCICE接口的定义标准生成临界网格；根据流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；以临界网格作为中间媒介实现流体端和耦合框架preCICE之间的连接，将流体端产生的力和临界网格进行插值从而传递给preCICE，然后preCICE再将力传递到固体结构，固体结构受到了力并且产生了形变的位移，并且把形变位移通过preCICE回传给临界网格，临界网格把形变位移和接触粒子进行插值进而更新其粒子的位置坐标信息。本发明提出的基于粒子网格适配的分离式的耦合方法通过临界网格完成插值，它能够复用网格接口的同时又可以通过粒子插值的方式支持无网格方法的耦合，极大的扩充了preCICE耦合软件的应用范围。附图说明图1为一个实施例中基于粒子网格适配的流固耦合求解方法的流程示意图；图2为一个实施例中光滑粒子流体动力学方法的粒子近似原理示意图；图3为一个实施例中基于粒子网格适配方法下力和位移的插值过程示意图，其中为第一阶段力的计算过程示意图，为第二阶段位移的计算过程示意图；图4为一个实施例中基于粒子网格适配的流固耦合求解装置的结构框图；图5为一个实施例中计算机设备的内部结构图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。在一个实施例中，如图1所示，提供了一种基于粒子网格适配算法的流固耦合方法，包括以下步骤：步骤102，根据流固耦合实验要求信息建立初始的物理模型。物理模型设定了求解区域以及耦合边界条件。求解区域包括流体端和固体端。步骤104，根据耦合边界条件和preCICE接口的定义标准生成临界网格。耦合框架preCICE是一个多物理场耦合库，它允许不同的求解器进行联合的求解从而解决实际多物理场的问题，但是该开源软件仅仅提供基于网格方法的接口，不同的网格方法根据接口的定义建立连接从而进行耦合求解多物理场问题。本发明提出了一种临界网格作为中间媒介实现流体端和耦合框架preCICE之间的连接。流体端要设置和固体端相互对应的边界条件，该边界条件用来产生临界网格作为连接粒子方法和耦合框架preCICE之间的媒介。临界网格的定义和剖分遵循preCICE接口的定义标准。步骤106，根据流体端的流体粒子到临界网格面片法向量的距离确定接触粒子。在流体端和固体端进行数据映射之前，要实现流体粒子和临界网格的接触算法。流体粒子首先和临界网格进行接触，接触半径是SPH方法的光滑长度h，SPH方法是现有技术，如图2为SPH方法的粒子近似原理示意图，其中，kh表示影响半径，即本实施例中的光滑长度h；流体粒子只和最近的临界网格面片进行接触，粒子到面片的距离是由面片中心的距离来决定的，如果粒子在面片法向量方向的距离小于接触阈值h，则认为粒子和面片产生接触，否则认为没有发生接触，发生接触的流体粒子称为临界网格面片的接触粒子。该部分的粒子需要和临界网格进行插值。在进行接触粒子的搜索之前，首先对流体粒子对应的区域进行分区，每一个区对应实际物理场的一个区域，并且每个区域互不重叠，在搜索接触粒子时，先搜索靠近区域的粒子，远离网格区域的粒子就不需要搜索，这样就能极大的减少搜索的时间，节约计算资源，提高搜索的接触粒子的效率。步骤108，计算流体粒子对临界网格产生的合力，将合力和临界网格进行插值，并通过preCICE将力传递给固体端。根据接触粒子，在求解流固耦合问题中需要计算流体粒子对临界网格产生的合力。其中每个粒子的产生的力通过牛顿第二定律F=M·A进行计算。其中M表示流体粒子的质量，A根据动量守恒方程求解出的加速度。F则是每个接触粒子在不同维度上产生的力，最终将所有的接触粒子产生的力进行相加就是临界网格受到力的大小。将合力通过临界网格传递给固体结构。步骤110，在固体端在合力的作用下产生形变位移后，通过preCICE将形变位移回传给临界网格，通过临界网格将形变位移和接触粒子进行插值，得到接触粒子更新后的位置坐标信息。固体端受到了流体粒子力的作用之后，固体结构则会产生相应的变形位移，该位移通过各个网格的顶点坐标回传给临界网格。临界网格根据位移更新接触粒子的位置信息。步骤112，在流体端和固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到流固耦合实验的耦合响应。上述基于粒子网格适配的流固耦合求解方法中，根据流固耦合实验要求设定求解区域以及耦合边界条件，根据耦合边界条件和preCICE接口的定义标准生成临界网格；根据流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；以临界网格作为中间媒介实现流体端和耦合框架preCICE之间的连接，将流体端产生的力和临界网格进行插值从而传递给preCICE，然后preCICE再将力传递到固体结构，固体结构受到了力并且产生了形变的位移，并且把形变位移通过preCICE回传给临界网格，临界网格把形变位移和接触粒子进行插值进而更新其粒子的位置坐标信息。与现有技术相比，本发明的优点在于：1、本发明的基于粒子网格适配的流固耦合求解方法，相比传统的基于网格的耦合方法，提供了兼容无网格方法的支持，仅仅通过设置一个临界网格便可以进行连接耦合框架完成流固耦合问题的求解，使得preCICE能偶兼容更多类型的求解器。2、本发明的基于粒子网格适配的流固耦合求解方法，由于兼容了无网格方法，而无网格方法更加适合模拟大变形，材料的冲击响应，自由表面流等场景的模拟。因此本发明极大的推广了流固耦合的应用范围，使得许多不能使用网格方法模拟的现象也可以通过本文提出的基于粒子网格适配方法进行求解。而且，该方法在理论上能够达到和网格方法的同样的精度。在其中一个实施例中，还包括：在precice-configure.xml配置文件里面定义流体求解器FluidSolver和固体求解器SolidSolver；设置数据映射方案；数据映射方案包括最近邻映射，最近投影和最径向基插值映射；配置通信方式；通信方式包括基于MPI方式的通信模式和基于TC/IP协议的网格通信模式，前者能够高效的运行在现代化的超级计算机中，后者能够提供更加广泛的底层资源的支持；配置耦合方案；耦合方案包括显示串行、显示并行、隐式串行和隐式并行，由于采用的算法本身的特性，显式耦合方案不容易收敛，需要每次迭代都需要进行一次反馈直至最终程序的收敛。而隐式耦合方法会设置固定点迭代，在每一个固定点处作为是否收敛的checkpoints，用来检查在耦合过程在子迭代中是否收敛，因此，隐式耦合方法更加稳定且容易收敛；当程序加载并开始运行时，将precice-configure.xml配置文件读取到preCICE中；由preCICE根据precice-configure.xml配置文件加载对应的耦合参数。在其中一个实施例中，还包括：在通过临界网格将形变位移和接触粒子进行插值，得到接触粒子更新后的位置坐标信息之前，施加耦合边界条件，以约束接触粒子不穿透固体端的边界。如果没有施加边界条件则容易造成粒子对固体边界造成非物理穿透，因此边界需要满足如下的关系。其中表示临界网格的位移，v表示临界网格的移动速度，n表示临界网格面片对应的法向量。该边界条件表明，要确保粒子不穿透固体边界则需要满足面片在法向量方向的移动速度要等于粒子的移动速度。在其中一个实施例中，还包括：临界网格位于流体端和固体端之间的接触面之间。在其中一个实施例中，还包括：根据设定的插值精度将合力和临界网格进行插值，以使从流体端传递到固体端的力与流体粒子对临界网格产生的合力一致。通过临界网格根据设定的插值精度将形变位移和接触粒子进行插值，以使流体粒子位置的更新能够遵守质量，动量以及能量守恒定律；其中，插值操作通过多线程并行进行。和临界网格插值时的精度决定了最终的计算的精度。临界网格关于力和位移的插值精度需要得到保障，它要求流体传递到固体的力要保持接触粒子合力一致，而固体端传递相应的位移用来更新和临界网格接触的流体粒子，该过程需要严格的遵守质量，动量以及能量守恒定律，否则计算容易造成发散。关于力以及位移和临界网格实现插值，该部分的计算非常耗时，考虑到每个粒子的计算是没有前后依赖关系的，最终只要把所有的粒子产生的力施加到临界网格作为总的合力传递给固体网格，其次位移的设置仅仅对接触粒子进行实施的，因此力以及位移和临界网格插值的过程可以使用多线程并行来提高计算的效率。应该理解的是，虽然图1的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，图1中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些子步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。在另一个实施例中，提供了一种基于粒子网格适配算法的流固耦合方法，包括：根据实验背景设置初始条件，建立初始的物理模型。配置耦合参数，包括使用的映射规则，通信方式以及耦合方案。粒子网格接触求解，计算出临界网格的接触粒子。接触粒子和临界网格实现力的插值。接触粒子和临界网格实现位移的插值。施加耦合边界条件，约束接触粒子不穿透固体边界。流体求解之后再求解固体，并且不断的交互；判断是否满足迭代次数，若是，则完成并结束计算，否则，返回步骤，不断重复此过程。首先需要设置临界网格，然后进行耦合求解的初步配置，所有的参数均在precise－configure文件里实现，其中包括配置映射关系，耦合方案以及通信方法。然后实现力和位移的插值，流体和临界需要置换力和回写位移。如图3为基于粒子网格适配方法下力和位移的插值过程示意图，表示粒子的应力，表示插值过程，表示耦合过程，表示固体网格。第一阶段是力的计算，流体粒子产生的力通过牛顿第二定律进行计算该合力，把合力进行插值给临界网格，然后再由临界网格传递给固体结构。第二阶段是计算位移，固体结构接收到流体粒子产生力并且产生了形变，将形变以位移的形式回写给固体结构。在一个实施例中，如图4所示，提供了一种基于粒子网格适配算法的流固耦合装置，包括：初始化模块402、临界网格确定模块404、接触粒子确定模块406、力插值模块408、位移插值模块410和迭代求解模块412，其中：初始化模块402，用于根据流固耦合实验要求建立初始的物理模型；物理模型设定了求解区域以及耦合边界条件；求解区域包括流体端和固体端；临界网格确定模块404，用于根据耦合边界条件和preCICE接口的定义标准生成临界网格；接触粒子确定模块406，用于根据流体端的流体粒子到临界网格面片法向量的距离确定接触粒子；力插值模块408，用于计算流体粒子对临界网格产生的合力，将合力和临界网格进行插值，并通过preCICE将力传递给固体端；位移插值模块410，用于在固体端受到合力的作用后产生形变位移后，通过preCICE将形变位移回传给临界网格，通过临界网格将形变位移和接触粒子进行插值，得到接触粒子更新后的位置坐标信息；迭代求解模块412，用于在流体端和固体端进行交互求解，若未满足迭代停止条件，则重新计算接触粒子进行迭代，否则，结束迭代，得到流固耦合实验的耦合响应。临界网格确定模块404还用于在preCICE的配置文件中配置耦合参数；耦合参数用于确定流体端和固体端的求解器、preCICE使用的映射规则、通信方式和耦合方案。临界网格确定模块404还用于在precice-configure.xml配置文件里面定义流体求解器FluidSolver和固体求解器SolidSolver；设置数据映射方案；数据映射方案包括最近邻映射，最近投影和最径向基插值映射；配置通信方式；通信方式包括基于MPI方式的通信模式和基于TC/IP协议的网格通信模式；配置耦合方案；耦合方案包括显示串行、显示并行、隐式串行和隐式并行；当程序加载并开始运行时，将precice-configure.xml配置文件读取到preCICE中；由preCICE根据precice-configure.xml配置文件加载对应的耦合参数。位移插值模块410还用于施加耦合边界条件，以约束接触粒子不穿透固体端的边界。接触粒子确定模块406还用于获取求解区域中流体端的流体粒子到临界网格面片法向量的距离；若距离小于预设的接触阈值，则判定流体粒子与临界网格面片产生接触，流体粒子为接触粒子；接触阈值为SPH算法的光滑长度。力插值模块408还用于根据设定的插值精度将合力和临界网格进行插值，以使从流体端传递到固体端的力与流体粒子对临界网格产生的合力一致；其中，插值操作通过多线程并行进行。位移插值模块410还用于通过临界网格根据设定的插值精度将形变位移和接触粒子进行插值，以使流体粒子位置的更新能够遵守质量，动量以及能量守恒定律；其中，插值操作通过多线程并行进行。关于基于粒子网格适配的流固耦合求解装置的具体限定可以参见上文中对于基于粒子网格适配的流固耦合求解方法的限定，在此不再赘述。上述基于粒子网格适配的流固耦合求解装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。在一个实施例中，提供了一种计算机设备，该计算机设备可以是终端，其内部结构图可以如图5所示。该计算机设备包括通过系统总线连接的处理器、存储器、网络接口、显示屏和输入装置。其中，该计算机设备的处理器用于提供计算和控制能力。该计算机设备的存储器包括非易失性存储介质、内存储器。该非易失性存储介质存储有操作系统和计算机程序。该内存储器为非易失性存储介质中的操作系统和计算机程序的运行提供环境。该计算机设备的网络接口用于与外部的终端通过网络连接通信。该计算机程序被处理器执行时以实现一种基于粒子网格适配算法的流固耦合方法。该计算机设备的显示屏可以是液晶显示屏或者电子墨水显示屏，该计算机设备的输入装置可以是显示屏上覆盖的触摸层，也可以是计算机设备外壳上设置的按键、轨迹球或触控板，还可以是外接的键盘、触控板或鼠标等。本领域技术人员可以理解，图5中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备的限定，具体的计算机设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。在一个实施例中，提供了一种计算机设备，包括存储器和处理器，该存储器存储有计算机程序，该处理器执行计算机程序时实现上述方法实施例中的步骤。在一个实施例中，提供了一种计算机可读存储介质，其上存储有计算机程序，计算机程序被处理器执行时实现上述方法实施例中的步骤。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一非易失性计算机可读取存储介质中，该计算机程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、存储、数据库或其它介质的任何引用，均可包括非易失性和/或易失性存储器。非易失性存储器可包括只读存储器、可编程ROM、电可编程ROM、电可擦除可编程ROM或闪存。易失性存储器可包括随机存取存储器或者外部高速缓冲存储器。作为说明而非局限，RAM以多种形式可得，诸如静态RAM、动态RAM、同步DRAM、双数据率SDRAM、增强型SDRAM、同步链路 DRAM、存储器总线直接RAM、直接存储器总线动态RAM、以及存储器总线动态RAM等。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
