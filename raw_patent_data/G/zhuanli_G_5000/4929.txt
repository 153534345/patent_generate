标题title
基于番茄光响应差分特征的全生长期光强调控方法
摘要abst
本发明涉及一种基于番茄光响应数据集差分特征的全生长期光强调控方法，属于设施农业的作物环境智能调控领域，基于极限学习机建立了全生长期光合预测模型，并针对光合数据的特征进行了模型优化；基于光合预测模型，得到了植株净光合速率Pn对光强响应的离散集并绘制曲线；为了确定不同调控目标下温室适宜的光量子通量密度PPFD值以指导补光光强，对离散集进行了二阶中心差分运算，根据差分曲线与原曲线的对应关系，找到光合速率变化速度改变的分界点，基于该分界点使用三维三角插值法建立了光强目标值模型；提出了与“收益最大化”、“作物产出最大化”、“投入和产出平衡”等温室生产目标相对应的光强调控方法和策略。
权利要求书clms
1.基于光响应曲线差分特征的番茄全生长期光强调控方法，其特征在于：所述方法包括以下步骤：S1：数据采集使用温室内布置的无线传感器网络节点采集不同有效光合波段内的环境参数数据，所述环境参数包括光量子通量密度PPFD、环境光照的红蓝比例R:B、室内二氧化碳浓度CO2、空气温度T和空气相对湿度RH；通过路由器将节点环境参数数据上传至远程服务器平台，并进行本地储存，方便后续数据分析；使用光合速率仪获取番茄单叶的光合数据，通过叶室控制并稳定叶片环境，获得不同环境条件下所对应的净光合速率Pn；所述采集步骤分别于番茄的苗期、开花期和果期进行；S2：数据分析S2.1：数据预处理数据预处理包括数据匹配与清洗、变量筛选与归一化和数据集划分；S2.1.1：数据匹配与清洗采集过程中存在对同一样本的重复测量，求取平均值作为真实值，对数据集进行规范整理；数据匹配：获取的光合数据需要与环境参数数据进行匹配，从而排除测量过程中由于短时环境波动、仪器气流不稳定等扰动带来的异常数据点；数据清洗：绘制数据的箱线图，根据四分位数法检测并剔除离群值，从而实现对原始数据的清洗；S2.1.2：变量筛选和归一化变量筛选：即通过相关分析和平均影响值法来筛选变量；如果数据符合正态分布，且通过方差齐性检验，则对模型输入、输出进行相关分析，判断各变量和被测变量的相关性；同时借助平均影响值法计算变量的权重，判断影响的相对重要性；剔除与模型输出无关的输入变量，完成变量筛选；若筛选后变量的维度仍过高，使用主成分分析方法，将原数据不断转换到新坐标系中，取包含大部分方差的前几个坐标系，并忽略余下的坐标轴，从而降低变量维度；归一化处理：使用max-min标准化方法将数据集的各维度统一在区间内，从而消除各维度量纲差异；S2.1.3：数据集划分为了验证模型有效性，通过数据集划分得到训练集和测试集，使用训练集数据进行模型训练，使用测试集数据完成验证；随机取整体数据集的80％作为训练集，余下20％作为测试集；S2.2：光合预测模型的建立S2.2.1：模型参数优化光合预测模型的结构：光合预测模型包括原始输入层、预处理层、神经网络和预测输出层四部分；原始输入层负责读取步骤S1中所获取的环境参数及作物光合数据，并整理数据类型及矩阵形状；预处理层对数据进行匹配和清洗，同时，还对数据集进行了筛选和归一化操作，从而降低数据集维度并统一量纲；神经网络为光合预测模型的主体，包括网络输入层、网络隐含层和网络输出层，将模型输入的环境参数及作物光合数据和模型输出的净光合速率Pn建立联系，从而实现净光合速率Pn的实时预测；最终，预测输出层将预测数据进行反归一化数据解析处理，使模型输出净光合速率Pn预测值；模型原始输入层数据{x′1,x′2,...x′k}包括温室当前的空气温度、空气相对湿度、室内二氧化碳浓度、光量子通量密度、环境光照的红蓝比例和植株的生长期，经步骤S2.1数据预处理后连接光合预测模型中神经网络的网络输入层神经元{x1,x2,...,xn}，光合预测模型的输出为植株的实时净光合速率Pn；使用增量式网络构造的方法确定网络的隐含层节点数，建立基于增量构造极限学习机I-ELM的神经网络；I-ELM网络权值和阈值优化：使用进化算法中的麻雀搜索算法实现权值和阈值的优化；S2.2.2：光合预测模型建立与验证基于步骤S2.2.1优化的模型参数，以步骤S2.1.3中数据预处理中划分好的训练集为模型训练的数据集对模型展开训练，得到光合预测模型；使用交叉验证的方法将原训练集数据进一步划分为新训练集和验证集，以验证集的模型误差表现为依据筛选出最优模型，克服样本量方面的不足；S2.3：光强目标值模型的建立S2.3.1：净光合速率Pn预测根据得到的光合预测模型，预测各生长期不同温度及二氧化碳浓度条件对应的净光合速率Pn离散集；S2.3.2：光响应曲线差分特征分析对苗期、开花期和果期的番茄植株在各环境梯度下的离散集数据进行差分运算和结果分析；如公式1和2所示，采用中心差分法，先对各生长期不同温度及二氧化碳浓度条件对应的净光合速率Pn的离散集分别进行一阶和二阶差分运算，再使用三次样条插值法提高差分曲线的分辨率，从而得到一阶和二阶差分曲线；其中，c为净光合速率对光强的响应函数，单位为μmol·m-2·s-1；c′和c″分别为一阶和二阶差分函数，单位均为μmol·m-2·s-1；等距节点xk＝x0+kh，单位为μmol·m-2·s-1，且常数k＝0,1,…,n；等距节点的步长h为常数，单位为μmol·m-2·s-1；S2.3.3：光强目标值模型使用搜索算法提取差分曲线的极值点，通过三角插值法分别建立番茄苗期、开花期和果期的光强调控目标值超平面；苗期、开花期和果期的番茄植株在各环境梯度下的离散集数据的二阶差分曲线有三个极值点，根据二阶差分曲线各段的分界点，原函数被划分到了四个区间上：区间1：该区间内二阶差分值从0开始，绝对值逐渐增大，表明原函数是从线性增长开始的，随后速度发生改变；记二阶差分曲线邻域内第一个极值点组成的集合为PPFD′1，所述第一个极值点为极小值点，此时二阶差分值为负且极小，表明一阶差分值下降的速度在该邻域内最小；区间记为区间1，区间1内二阶差分值为负且绝对值一直增大，即一阶差分值下降得快，也就是原函数增长放缓的速度快，区间1包括了光合作用的线性阶段及进入增长缓慢的转变阶段；区间2：记邻域内第二个极值点组成的集合为PPFD′2，所述第二个极值点为极大值点，区间记为区间2，区间2内二阶差分值的绝对值一直减小，即速度放缓，也就是原函数增长放缓的速度慢，在其他环境条件一定的情况下，区间1和区间2内限制光合作用的主要条件是光强；区间3：记邻域内第三个极值点组成的集合为PPFD′3，区间记为区间3，所述第三个极值点为极小值点，区间3内二阶差分值的绝对值开始增大，即一阶差分值最后一次快速下降，对应原函数增长速度快速放缓，原函数进入二氧化碳限制阶段，限制光合的主要外界条件是环境二氧化碳，表明光合作用趋向了饱和；区间4：区间记为区间4，原函数的一阶差分值经过区间3这段快速减小后，出现极小值，该点后二阶差分值的绝对值继续变小，对应原函数增长放缓的速度慢，即原函数值已基本不变了，表明光合作用到达了光饱和状态；差分分析的结果如下：原函数增长速度在一直放缓，但放缓得有快有慢，区间1和区间3为快，区间2和区间4为慢，以二阶差分特征为切入点，将光响应曲线按增长速度划分为第一快速放缓区间、第一缓慢放缓区间、第二快速放缓区间、第二缓慢放缓区间四部分；区间1和区间2分别对应线性增长阶段、开始向二氧化碳限制转变的增长缓慢阶段，这两个区间二阶差分值的绝对值先增后减，一阶差分值较大，净光合速率主要受光限制；区间3和区间4分别对应开始趋向光饱和的快速变缓阶段、发生光饱和的速度基本不变阶段，这两个区间二阶差分值的绝对值先增后减，但一阶差分值较小，净光合速率主要受二氧化碳等非光限制；为提高模型的精度和光强调控的分辨率，使用三角插值的方法对分界点进行插值分析，得到各分界点所组成的目标值超平面，即为第一目标值超平面PPFD1、第二目标值超平面PPFD2、第三目标值超平面PPFD3，作为光强调控的目标值，所述目标值超平面的因变量为光量子通量密度PPFD，自变量包含生长期、二氧化碳浓度和空气温度，当生长期确定后，目标值超平面为三维曲面，x轴为二氧化碳浓度、y轴为空气温度、z轴为光量子通量密度PPFD；S3:根据差分分析的结果，建立调控方法S3.1:当调控需求为作物产出最大化时，则调节目标光量子通量密度PPFD，使之不小于第三目标值超平面PPFD3；此时，通过补光使作物达到光饱和状态，最大化作物的产出；S3.2:当调控需求为投入和产出平衡时，则调节目标光量子通量密度PPFD，使之不小于第二目标值超平面PPFD2；此时，最大化目标光量子通量密度PPFD而又防止进入区间3和区间4，避免发生光饱和的情况，使得投入和产出相平衡；S3.3:当调控需求为收益最大化时，则调节目标光量子通量密度PPFD，使之不小于第一目标值超平面PPFD1；此时，令目标光量子通量密度PPFD达到原函数增速迅速变缓时的光强值，此处在区间1内对应净光合速率Pn最大，避免高能耗的同时，保证了收益最大。2.如权利要求1所述的基于光响应曲线差分特征的番茄全生长期光强调控方法，其特征在于：步骤S3中，还包括如下步骤：S3.4:监测状态：只对当前光强进行监测和预警，不实施控制操作；当光强小于第一目标值超平面PPFD1，即处于区间1时，说明监测到植株在当前环境下存在光限制，即光强成为植株生长的潜在胁迫因素，做出“低光强”提示；当光强超过第三目标值超平面PPFD3时，即处于区间4时，说明监测到植株在当前环境下存在光抑制，即光合作用状态已经达到光饱和状态，若继续增加光强则对作物造成损害，做出“高光强”提示。3.如权利要求1所述的基于光响应曲线差分特征的番茄全生长期光强调控方法，其特征在于：步骤S3中，还包括如下步骤：S3.5保护状态：根据监测到的目标光量子通量密度PPFD，对高于第三目标值超平面PPFD3的光强进行控制；此时，令目标光量子通量密度PPFD不大于第三目标值超平面PPFD3，降低目标光量子通量密度PPFD从而做到保护植株。4.如权利要求1所述的基于光响应曲线差分特征的番茄全生长期光强调控方法，其特征在于：步骤S1中，测量时要求环境稳定，即二氧化碳浓度波动小于0.2μmol·mol-1，净光合速率Pn波动小于0.1μmol·m-2·s-1，且蒸腾速率与胞间二氧化碳浓度均大于0，气孔导度大于0且小于1时，进行读数记录，记为一个样本点；在每次测量的间隔，及时进行匹配操作以消除连续测量带来的误差；测量的对象为长势均一且健康的植株，选取平整的叶片进行测量以保证叶面积一定，叶片位置为植株从上到下的第四叶序的顶叶；数据梯度方面，光量子通量密度PPFD共设置8个梯度，为200μmol·m-2·s-1、400μmol·m-2·s-1、600μmol·m-2·s-1、800μmol·m-2·s-1、1000μmol·m-2·s-1、1200μmol·m-2·s-1、1400μmol·m-2·s-1和1600μmol·m-2·s-1；二氧化碳浓度共4个梯度，为400μmol·mol-1、700μmol·mol-1、1000μmol·mol-1和1300μmol·mol-1；温度共5个梯度，为25℃、27℃、29℃、31℃和33℃；流速设定为500μmol·s-1；数据量方面，每次重复记录3个样本点，实验期间共测得苗期、开花期和果期共计1440个样本点。5.如权利要求1所述的基于光响应曲线差分特征的番茄全生长期光强调控方法，其特征在于：步骤S2.1.3中，在每个生长期下，在每个温度及二氧化碳浓度的小梯度下，对该梯度内的所有光强条件对应的数据按80％的比例选择为训练集，从而做到整体上训练集占比80％，而余下的20％则作为测试集。6.如权利要求1所述的基于光响应曲线差分特征的番茄全生长期光强调控方法，其特征在于：步骤S2.3.2中，插值节点为光合预测模型得到的步长为10的离散集数据，插值后的响应曲线步长为1。7.如权利要求1所述的基于光响应曲线差分特征的番茄全生长期光强调控方法，其特征在于：步骤S2.3.3中，原始插值节点为包含苗期、开花期和果期番茄光响应曲线的分界点PPFD′1、PPFD′2、PPFD′3，环境空气温度为25℃、27℃、29℃、31℃、33℃，二氧化碳浓度为400μmol·m-2·s-1、700μmol·m-2·s-1、1000μmol·m-2·s-1、1300μmol·mol-1；运算后得到的插值曲面的温度分辨率为1℃，二氧化碳浓度分辨率为50μmol·mol-1。
说明书desc
技术领域本发明涉及一种基于番茄光响应数据集差分特征的全生长期光强调控方法，属于设施农业的作物环境智能调控领域。背景技术中国北方地区为典型的大陆性季风的气候环境，有着冬季寒冷干燥，夏季多雨的特点。在冬季，日光温室可以实现在不加温或少加温的条件下生产喜温蔬菜，保证了淡季的蔬菜供给，也带来了丰厚的经济效益。因此，日光温室等设施农业在中国北方地区有着大面积的应用。日光温室以太阳辐射为主要能源，节能环保，具有保温效果好、成本低等特点，在我国广泛推广。但是，日光温室背面和东西侧面均为墙体，相对于塑料大棚和玻璃温室，其采光效果较差，进入日光温室的光线强度比室外降低约20％-60％。而且，当室外环境温度较低时，为维持温室内正常温度需要牺牲光照，例如温室保温被揭棚时间推迟、盖棚时间提前。在秋冬季节，连续的阴霾天气也使得温室内部的光照无法保证，影响着正常的农业生产。补光可以弥补日光温室光照的不足，为植株的生长提供保障。近年来，发光二极管被迅速引入温室栽培系统。LED节能环保，发光效率高而热效应不显著，为番茄和其他温室作物的辅助照明提供了良好选择。合理的补光光强可以提高温室作物的光合速率，为增产做出贡献，然而过量的补光不仅增加了电力消耗，从而导致收入产出比下降，而且会增加作物光抑制等不良反应，危害作物生长，造成更大损失。此外，不同温度、二氧化碳浓度等条件下的作物对光强的敏感性不同，不同生长期的作物对光强的敏感性也不同，即作物的需光量随外界环境与自身生长而变化，因此，补光需要结合具体作物及其生长阶段和生长环境而进行精细化管理。综上，需要建立一个根据外界环境与作物生长期等变量做出响应的作物光合速率预测模型，以实时地评估作物光合状态。净光合速率表征了植株光合作用固定二氧化碳的速度，一定程度上决定了作物的产量和产值。光量子通量密度，即有效光合波段内的光强对Pn有重要影响，此外Pn还受植株所处环境的温度、二氧化碳浓度等影响，因此需要根据环境对Pn作用的规律，进一步确定温室补光的目标光强，建立光强调控目标值模型，从而实现温室精细化科学补光。本发明提出的光合预测模型与目标值调控模型，适用于苗期、开花期及果期的温室番茄，可以实现不同光照强度、二氧化碳浓度、空气温度、空气相对湿度等环境条件下番茄植株Pn的实时预测。以此为基础，本发明进一步提出了一种补光方法，根据光响应曲线的差分分析结果，在全生长期的不同环境条件下，确定了光合离散数据变化速度发生改变的关键点，即光响应曲线的分界点，并进一步基于分界点建立了光强调控的目标值模型。判断环境光强在目标值模型中的空间位置，根据调控目的输出目标值模型的光强值，指导温室补光。该方法避免了传统补光方法以最大光强为单一目标值进行调控所带来的高能耗与高成本问题，将补光调控与生产需求相结合，实现了温室补光的经济性。发明内容本发明的目的在于提供一种基于光响应曲线差分特征的番茄全生长期光强调控方法，实现全生长期净光合速率Pn的光合实时预测与温室补光光强调控目标值的获取；基于极限学习机建立了全生长期光合预测模型，并针对光合数据的特征进行了模型优化；基于光合预测模型，得到了植株净光合速率Pn对光强响应的离散集并绘制曲线；为了确定不同调控目标下温室适宜的光量子通量密度PPFD值以指导补光光强，对离散集进行了二阶中心差分运算，根据差分曲线与原曲线的对应关系，找到光合速率变化速度改变的分界点，基于该分界点使用三维三角插值法建立了光强目标值模型；提出了与“收益最大化”、“作物产出最大化”、“投入和产出平衡”等温室生产目标相对应的光强调控方法和策略。为了达到上述目的，本发明提供了如下技术方案：基于光响应曲线差分特征的番茄全生长期光强调控方法，其中，所述方法包括以下步骤：S1：数据采集使用温室内布置的无线传感器网络节点采集不同有效光合波段内的环境参数数据，所述环境参数包括光量子通量密度PPFD、环境光照的红蓝比例R:B、室内二氧化碳浓度CO2、空气温度T和空气相对湿度RH；通过路由器将节点环境参数数据上传至远程服务器平台，并进行本地储存，方便后续数据分析；使用光合速率仪获取番茄单叶的光合数据，通过叶室控制并稳定叶片环境，获得不同环境条件下所对应的净光合速率Pn；所述采集步骤分别于番茄的苗期、开花期和果期进行；S2：数据分析S2.1：数据预处理数据预处理包括数据匹配与清洗、变量筛选与归一化和数据集划分；S2.1.1：数据匹配与清洗采集过程中存在对同一样本的重复测量，求取平均值作为真实值，对数据集进行规范整理；数据匹配：获取的光合数据需要与环境参数数据进行匹配，从而排除测量过程中由于短时环境波动、仪器气流不稳定等扰动带来的异常数据点；数据清洗：绘制数据的箱线图，根据四分位数法检测并剔除离群值，从而实现对原始数据的清洗；S2.1.2：变量筛选和归一化变量筛选：即通过相关分析和平均影响值法来筛选变量；如果数据符合正态分布，且通过方差齐性检验，则对模型输入、输出进行相关分析，判断各变量和被测变量的相关性；同时借助平均影响值法计算变量的权重，判断影响的相对重要性；剔除与模型输出无关的输入变量，完成变量筛选；若筛选后变量的维度仍过高，使用主成分分析方法，将原数据不断转换到新坐标系中，取包含大部分方差的前几个坐标系，并忽略余下的坐标轴，从而降低变量维度；归一化处理：使用max-min标准化方法将数据集的各维度统一在区间内，从而消除各维度量纲差异；S2.1.3：数据集划分为了验证模型有效性，通过数据集划分得到训练集和测试集，使用训练集数据进行模型训练，使用测试集数据完成验证；随机取整体数据集的80％作为训练集，余下20％作为测试集；S2.2：光合预测模型的建立S2.2.1：模型参数优化光合预测模型的结构：光合预测模型包括原始输入层、预处理层、神经网络和预测输出层四部分；原始输入层负责读取步骤S1中所获取的环境参数及作物光合数据，并整理数据类型及矩阵形状；预处理层对数据进行匹配和清洗，同时，还对数据集进行了筛选和归一化操作，从而降低数据集维度并统一量纲；神经网络为光合预测模型的主体，包括网络输入层、网络隐含层和网络输出层，将模型输入的环境参数及作物光合数据和模型输出的净光合速率Pn建立联系，从而实现净光合速率Pn的实时预测；最终，预测输出层将预测数据进行反归一化数据解析处理，使模型输出净光合速率Pn预测值；模型原始输入层数据{x′1,x′2,...x′k}包括温室当前的空气温度、空气相对湿度、室内二氧化碳浓度、光量子通量密度、环境光照的红蓝比例和植株的生长期，经步骤S2.1数据预处理后连接光合预测模型中神经网络的网络输入层神经元{x1,x2,...,xn}，光合预测模型的输出为植株的实时净光合速率Pn；使用增量式网络构造的方法确定网络的隐含层节点数，建立基于增量构造极限学习机I-ELM的神经网络；I-ELM网络权值和阈值优化：使用进化算法中的麻雀搜索算法实现权值和阈值的优化；S2.2.2：光合预测模型建立与验证基于步骤S2.2.1优化的模型参数，以步骤S2.1.3中数据预处理中划分好的训练集为模型训练的数据集对模型展开训练，得到光合预测模型；使用交叉验证的方法将原训练集数据进一步划分为新训练集和验证集，以验证集的模型误差表现为依据筛选出最优模型，克服样本量方面的不足；S2.3：光强目标值模型的建立S2.3.1：净光合速率Pn预测根据得到的光合预测模型，预测各生长期不同温度及二氧化碳浓度条件对应的净光合速率Pn离散集；S2.3.2：光响应曲线差分特征分析对苗期、开花期和果期的番茄植株在各环境梯度下的离散集数据进行差分运算和结果分析；如公式1和2所示，采用中心差分法，先对各生长期不同温度及二氧化碳浓度条件对应的净光合速率Pn的离散集分别进行一阶和二阶差分运算，再使用三次样条插值法提高差分曲线的分辨率，从而得到一阶和二阶差分曲线；其中，c为净光合速率对光强的响应函数，单位为μmol·m-2·s-1；c′和c″分别为一阶和二阶差分函数，单位均为μmol·m-2·s-1；等距节点xk＝x0+kh，单位为μmol·m-2·s-1，且常数k＝0,1,…,n；等距节点的步长h为常数，单位为μmol·m-2·s-1；S2.3.3：光强目标值模型使用搜索算法提取差分曲线的极值点，通过三角插值法分别建立番茄苗期、开花期和果期的光强调控目标值超平面；苗期、开花期和果期的番茄植株在各环境梯度下的离散集数据的二阶差分曲线有三个极值点，根据二阶差分曲线各段的分界点，原函数被划分到了四个区间上：区间1：该区间内二阶差分值从0开始，绝对值逐渐增大，表明原函数是从线性增长开始的，随后速度发生改变；记二阶差分曲线邻域内第一个极值点组成的集合为PPFD′1，所述第一个极值点为极小值点，此时二阶差分值为负且极小，表明一阶差分值下降的速度在该邻域内最小；区间记为区间1，区间1内二阶差分值为负且绝对值一直增大，即一阶差分值下降得快，也就是原函数增长放缓的速度快，区间1包括了光合作用的线性阶段及进入增长缓慢的转变阶段；区间2：记邻域内第二个极值点组成的集合为PPFD′2，所述第二个极值点为极大值点，区间记为区间2，区间2内二阶差分值的绝对值一直减小，即速度放缓，也就是原函数增长放缓的速度慢，在其他环境条件一定的情况下，区间1和区间2内限制光合作用的主要条件是光强；区间3：记邻域内第三个极值点组成的集合为PPFD′3，区间记为区间3，所述第三个极值点为极小值点，区间3内二阶差分值的绝对值开始增大，即一阶差分值最后一次快速下降，对应原函数增长速度快速放缓，原函数进入二氧化碳限制阶段，限制光合的主要外界条件是环境二氧化碳，表明光合作用趋向了饱和；区间4：区间记为区间4，原函数的一阶差分值经过区间3这段快速减小后，出现极小值，该点后二阶差分值的绝对值继续变小，对应原函数增长放缓的速度慢，即原函数值已基本不变了，表明光合作用到达了光饱和状态；差分分析的结果如下：原函数增长速度在一直放缓，但放缓得有快有慢，区间1和区间3为快，区间2和区间4为慢，以二阶差分特征为切入点，将光响应曲线按增长速度划分为第一快速放缓区间、第一缓慢放缓区间、第二快速放缓区间、第二缓慢放缓区间四部分；区间1和区间2分别对应线性增长阶段、开始向二氧化碳限制转变的增长缓慢阶段，这两个区间二阶差分值的绝对值先增后减，一阶差分值较大，净光合速率主要受光限制；区间3和区间4分别对应开始趋向光饱和的快速变缓阶段、发生光饱和的速度基本不变阶段，这两个区间二阶差分值的绝对值先增后减，但一阶差分值较小，净光合速率主要受二氧化碳等非光限制；为提高模型的精度和光强调控的分辨率，使用三角插值的方法对分界点进行插值分析，得到各分界点所组成的目标值超平面，即为第一目标值超平面PPFD1、第二目标值超平面PPFD2、第三目标值超平面PPFD3，作为光强调控的目标值，所述目标值超平面的因变量为光量子通量密度PPFD，自变量包含生长期、二氧化碳浓度和空气温度，当生长期确定后，目标值超平面为三维曲面，x轴为二氧化碳浓度、y轴为空气温度、z轴为光量子通量密度PPFD；S3:根据差分分析的结果，建立调控方法S3.1:当调控需求为作物产出最大化时，则调节目标光量子通量密度PPFD，使之不小于第三目标值超平面PPFD3；此时，通过补光使作物达到光饱和状态，最大化作物的产出；S3.2:当调控需求为投入和产出平衡时，则调节目标光量子通量密度PPFD，使之不小于第二目标值超平面PPFD2；此时，最大化目标光量子通量密度PPFD而又防止进入区间3和区间4，避免发生光饱和的情况，使得投入和产出相平衡；S3.3:当调控需求为收益最大化时，则调节目标光量子通量密度PPFD，使之不小于第一目标值超平面PPFD1；此时，令目标光量子通量密度PPFD达到原函数增速迅速变缓时的光强值，此处在区间1内对应净光合速率Pn最大，避免高能耗的同时，保证了收益最大。其中，步骤S3中，还包括如下步骤：S3.4:监测状态：只对当前光强进行监测和预警，不实施控制操作；当光强小于第一目标值超平面PPFD1，即处于区间1时，说明监测到植株在当前环境下存在光限制，即光强成为植株生长的潜在胁迫因素，做出“低光强”提示；当光强超过第三目标值超平面PPFD3时，即处于区间4时，说明监测到植株在当前环境下存在光抑制，即光合作用状态已经达到光饱和状态，若继续增加光强则对作物造成损害，做出“高光强”提示。其中，步骤S3中，还包括如下步骤：S3.5保护状态：根据监测到的目标光量子通量密度PPFD，对高于第三目标值超平面PPFD3的光强进行控制；此时，令目标光量子通量密度PPFD不大于第三目标值超平面PPFD3，降低目标光量子通量密度PPFD从而做到保护植株。其中，步骤S1中，测量时要求环境稳定，即二氧化碳浓度波动小于0.2μmol·mol-1，净光合速率Pn波动小于0.1μmol·m-2·s-1，且蒸腾速率与胞间二氧化碳浓度均大于0，气孔导度大于0且小于1时，进行读数记录，记为一个样本点；在每次测量的间隔，及时进行匹配操作以消除连续测量带来的误差；测量的对象为长势均一且健康的植株，选取平整的叶片进行测量以保证叶面积一定，叶片位置为植株从上到下的第四叶序的顶叶；数据梯度方面，光量子通量密度PPFD共设置8个梯度，为200μmol·m-2·s-1、400μmol·m-2·s-1、600μmol·m-2·s-1、800μmol·m-2·s-1、1000μmol·m-2·s-1、1200μmol·m-2·s-1、1400μmol·m-2·s-1和1600μmol·m-2·s-1；二氧化碳浓度共4个梯度，为400μmol·mol-1、700μmol·mol-1、1000μmol·mol-1和1300μmol·mol-1；温度共5个梯度，为25℃、27℃、29℃、31℃和33℃；流速设定为500μmol·s-1；数据量方面，每次重复记录3个样本点，实验期间共测得苗期、开花期和果期共计1440个样本点。其中，步骤S2.1.3中，在每个生长期下，在每个温度及二氧化碳浓度的小梯度下，对该梯度内的所有光强条件对应的数据按80％的比例选择为训练集，从而做到整体上训练集占比80％，而余下的20％则作为测试集。其中，步骤S2.3.2中，插值节点为光合预测模型得到的步长为10的离散集数据，插值后的响应曲线步长为1。其中，步骤S2.3.3中，原始插值节点为包含苗期、开花期和果期番茄光响应曲线的分界点PPFD′1、PPFD′2、PPFD′3，环境空气温度为25℃、27℃、29℃、31℃、33℃，二氧化碳浓度为400μmol·mol-1、700μmol·mol-1、1000μmol·mol-1、1300μmol·mol-1；运算后得到的插值曲面的温度分辨率为1℃，二氧化碳浓度分辨率为50μmol·mol-1。与现有技术相比，本发明的有益效果在于：为了克服光合数据测量复杂、数据量有限的问题，实现净光合速率Pn的实时预测与光合离散集的获取，本申请基于极限学习机建立了全生长期光合预测模型，并针对光合数据的特征进行了模型优化。基于光合预测模型，得到了植株净光合速率Pn对光强响应的离散集并绘制曲线。为了确定不同调控目标下温室适宜的净光合速率PPFD值以指导补光光强，本申请对离散集进行了二阶中心差分运算，根据差分曲线与原曲线的对应关系，找到光合速率变化速度改变的分界点，基于该分界点使用三维三角插值法建立了光强目标值模型，并提出了与“收益最大化”、“作物产出最大化”、“投入和产出平衡”等温室生产目标相对应的光强调控方法和策略。本申请为解决各生长期模型的通用性问题，将生长期作为输入建立了光合预测模型。对极限学习机进行了网络超参数优化并引入核函数，所建立的全生长期光合预测模型的运算复杂度低，速度快，精度高。以光合预测模型得到的光合离散集与曲线为基础，使用中心差分运算分析了光响应曲线的变化特征，揭示了番茄植株净光合速率Pn随光量子通量密度PPFD的变化规律。提取二阶差分曲线的极值点作为分界点，实现了全生长期番茄植株光响应曲线的四个阶段划分，为建立光强调控模型提供了基础。以分界点为基础，使用三角插值法建立了光强调控目标值曲面模型，实现了补光光强目标值的科学设定。基于光响应曲线差分特征和光强调控目标值，提出了一种光强调控方法，解决了传统补光以饱和光强为单一目标值进行调控所带来的高能耗与高成本问题，实现了与生产目标相对应的光强量化管理。附图说明图1为本发明的一种基于番茄光响应数据集差分特征的全生长期光强调控方法的示意图；图2为本发明的一种基于番茄光响应数据集差分特征的全生长期光强调控方法的光强调控目标值模型建立过程；图3为本发明的一种基于番茄光响应数据集差分特征的全生长期光强调控方法的模型结构示意图；图4为I-ELM网络权值和阈值优化原理图；图5为五折交叉验证的数据集划分示意图；图6为400μmol·mol-1CO2、25-33℃环境温度条件下，净光合速率Pn对光量子通量密度PPFD的离散集响应图；图7为图6的离散集数据的一阶差分曲线图；图8为图6的离散集数据的二阶差分曲线图；图9为原函数的区间划分；图10为图6的离散集数据的二阶差分曲线图及各区间分界点；图11为苗期光强调控目标值模型示意图；图12为开花期光强调控目标值模型示意图；图13为果期光强调控目标值模型示意图。具体实施方式下面结合附图对本发明的具体实施方式作进一步说明。如图1和图2所示，基于光响应曲线差分特征的番茄全生长期光强调控方法，包括以下步骤：S1：数据采集使用温室内布置的无线传感器网络节点采集不同有效光合波段内的环境参数数据，所述环境参数包括光强、环境光照的红蓝比例、室内二氧化碳浓度、空气温度和空气相对湿度。通过路由器将节点环境参数数据上传至远程服务器平台，并进行本地储存，方便后续数据分析。使用光合速率仪获取番茄单叶的光合数据，通过叶室控制并稳定叶片环境，获得不同环境条件下所对应的净光合速率Pn。优选地，所述光合速率仪的型号为LI-6400XT，LI-COR，USA。所述采集步骤分别于番茄的苗期、开花期和果期进行。测量时要求环境稳定，即二氧化碳浓度波动小于0.2μmol·mol-1，净光合速率Pn波动小于0.1μmol·m-2·s-1，且蒸腾速率与胞间二氧化碳浓度均大于0，气孔导度大于0且小于1时，进行读数记录，记为一个样本点；在每次测量的间隔，及时进行匹配操作以消除连续测量带来的误差。测量的对象为长势均一且健康的植株，选取平整的叶片进行测量以保证叶面积一定，叶片位置为植株从上到下的第四叶序的顶叶。数据梯度方面，光量子通量密度PPFD共设置8个梯度，为200μmol·m-2·s-1、400μmol·m-2·s-1、600μmol·m-2·s-1、800μmol·m-2·s-1、1000μmol·m-2·s-1、1200μmol·m-2·s-1、1400μmol·m-2·s-1和1600μmol·m-2·s-1；二氧化碳浓度共4个梯度，为400μmol·mol-1、700μmol·mol-1、1000μmol·mol-1和1300μmol·mol-1；温度共5个梯度，为25℃、27℃、29℃、31℃和33℃；流速设定为500μmol·s-1。数据量方面，每次重复记录3个样本点，实验期间共测得苗期、开花期和果期共计1440个样本点。S2：数据分析S2.1：数据预处理数据预处理包括数据匹配与清洗、变量筛选与归一化和数据集划分。S2.1.1：数据匹配与清洗采集过程中存在对同一样本的重复测量，求取平均值作为真实值，对数据集进行规范整理。数据匹配：获取的光合数据需要与环境参数数据进行匹配，从而排除测量过程中由于短时环境波动、仪器气流不稳定等扰动带来的异常数据点。数据清洗：绘制数据的箱线图，根据四分位数法检测并剔除离群值，从而实现对原始数据的清洗。S2.1.2：变量筛选和归一化数据集的变量一般较多、存在冗余和耦合，且各变量的量纲存在差异，影响建模的效果，所以需要进行变量筛选和归一化处理。变量筛选：即通过相关分析和平均影响值法来筛选变量。如果数据符合正态分布，且通过方差齐性检验，则对模型输入、输出进行相关分析，判断各变量和被测变量的相关性。同时借助平均影响值法计算变量的权重，判断影响的相对重要性。综上，剔除与模型输出无关的输入变量，完成变量筛选。若筛选后变量的维度仍过高，使用主成分分析方法，将原数据不断转换到新坐标系中，取包含大部分方差的前几个坐标系，并忽略余下的坐标轴，从而降低变量维度。归一化处理：各变量的量纲一般存在差异，影响着预测模型中输入的权重，给光合预测带来了误差。使用max-min标准化方法将数据集的各维度统一在区间内，从而消除各维度量纲差异。S2.1.3：数据集划分为了验证模型有效性，通过数据集划分得到训练集和测试集，使用训练集数据进行模型训练，使用测试集数据完成验证。随机取整体数据集的80％作为训练集，余下20％作为测试集。在每个生长期下，在每个温度及二氧化碳浓度的小梯度下，对该梯度内的所有光强条件对应的数据按80％的比例选择为训练集，从而做到整体上训练集占比80％，而余下的20％则作为测试集。梯度划分法比整体划分法更能保证训练数据和测试数据的代表性，不仅能保证训练的充分性，防止出现欠拟合现象，也能增加测试集的代表性，使测试结果客观有效。S2.2：光合预测模型的建立S2.2.1：模型参数优化光合预测模型是对作物光合作用的函数化表达，通过光合预测模型，能够得到不同条件下作物净光合速率Pn的离散值，为基于离散值差分分析的光强目标值模型的建立提供了基础。本申请基于极限学习机方法进行建模，即以单隐含层的前馈神经网络为基础建立光合预测模型。但是极限学习机的网络结构和网络参数需要针对光合数据进行优化，以取得较好的预测效果。光合预测模型的结构：如图3所示，光合预测模型包括原始输入层、预处理层、神经网络和预测输出层四部分。原始输入层负责读取步骤S1中所获取的环境参数及作物光合数据，并整理数据类型及矩阵形状，方便后续处理层的正常工作。预处理层负责对数据进行匹配和清洗，从而使数据集规范化、精简化，同时，还对数据集进行了筛选和归一化操作，从而降低数据集维度并统一量纲。神经网络为光合预测模型的主体，包括网络输入层、网络隐含层和网络输出层，以ELM理论为基础将模型输入的环境参数及作物光合数据和模型输出的净光合速率Pn建立联系，从而实现净光合速率Pn的实时预测；最终，预测输出层将预测数据进行反归一化数据解析处理，使模型输出净光合速率Pn预测值。本申请所定义的模型原始输入层数据{x′1,x′2,...x′k}包括温室当前的空气温度、空气相对湿度、室内二氧化碳浓度、光量子通量密度、环境光照的红蓝比例和植株的生长期，经步骤S2.1数据预处理后连接光合预测模型中神经网络的网络输入层神经元{x1,x2,...,xn}，光合预测模型的输出为植株的实时净光合速率Pn。ELM网络只具有一层隐含层，隐含层的神经元数量即隐含层节点数通常由经验公式得到，缺乏对光合预测的适用性。本申请使用增量式网络构造的方法确定网络的隐含层节点数，建立了基于增量构造极限学习机的神经网络，即：先初始化一个简单网络，然后在简单的初始网络上逐个添加隐含层节点，最后通过判断隐含层节点的最大值和预期误差来停止学习过程，从而获得最优网络结构。使用增量式网络构建光合预测模型中最优网络结构的方法，包括以下步骤：给定训练集D＝{|xi∈Rn,yi∈R,i＝1,2,…N}，激活函数g，期望学习误差为ε，隐含层最大节点数为步骤a、网络初始化。设置网络隐含层节点数残差初始化为训练集的期望目标向量E＝t＝T；步骤b、网络构建。当且‖E‖＞ε时，执行并将新增节点的权值与阈值进行随机赋值，计算新网络的输出权值计算新网络输出结果的残差。当隐含层节点数大于节点数最大值或残差不大于期望误差时结束，得到最优的隐含层节点数，完成最优网络结构构建。I-ELM网络权值和阈值优化：I-ELM网络的输入层连接权值ω和阈值b是随机得到的，这对模型精度产生了影响。本申请使用进化算法中的麻雀搜索算法实现权值和阈值的优化。网络输入层连接权值ω和阈值b的优化方法如图4所示，包括以下步骤：步骤a、参数初始化。将网络预测误差作为算法的适应度函数，将算法中的个体位置编码为权值和阈值，将种群大小设置为10，最大迭代次数设置为50，设定个体速度的范围为，设定生产者占比为20％。随机初始化个体位置和个体速度。步骤b、种群个体迭代更新。若当前迭代次数小于最大迭代次数且误差大于期望误差，则更新迭代次数、个体的位置和速度、适应度函数值，并将超出速度范围的个体约束在设定范围内，超出最大速度者约束为最大速度，超出最小速度者约束为最小速度。根据更新后的种群，计算并保存当前最优个体及其对应的适应度函数值。步骤c、解码与赋值。读取步骤b中获取到的最优个体，将其解码为权值和阈值，并将其赋值给I-ELM网络，得到最优的权值和阈值，最终完成高精度光合预测模型的构建。S2.2.2：光合预测模型建立与验证基于步骤S2.2.1优化的模型参数，以步骤S2.1.3中数据预处理中划分好的训练集为模型训练的数据集对模型展开训练，得到光合预测模型。值得强调的是，植物在不同的生理阶段有着不同的光照、温度等环境条件的需求，传统方法通常选择一个通用性较强的模型进行应用，或简单联合所有生长期数据，建立一个通用模型，这些方法虽然一定程度上解决了各生长期模型的适用性问题，但是降低了模型在单个生长期的表现。本申请将生长期作为模型输入，在实现多生长期适用性的同时，保障了预测精度。此外，模型输入包含了环境光照的红蓝光比例，提高了不同光质辐射条件下的光合预测精度。光合数据集有小样本量的特征，可以使用交叉验证的方法将原训练集数据进一步划分为新训练集和验证集，以验证集的模型误差表现为依据筛选出最优模型，克服样本量方面的不足。如图5所示，使用了五折交叉验证，通过对比不同模型在五折数据集中验证集的平均误差，筛选出最优模型。S2.3：光强目标值模型的建立S2.3.1：净光合速率Pn预测根据得到的光合预测模型，预测各生长期不同温度及二氧化碳浓度条件对应的净光合速率Pn离散集。如图6所示，展示了三次样条差分后的苗期番茄植株在400μmol·mol-1CO2、25-33℃环境温度条件下对应的离散集，其光量子通量密度PPFD步长为10。在光量子通量密度PPFD为0-1800μmol·m-2·s-1的范围内，离散点构成了光响应曲线，趋势表明净光合速率Pn随光量子通量密度PPFD一直增加，且增长速度在持续降低，后期增长缓慢或出现极值，以净光合速率Pn最大值对应的光量子通量密度PPFD作为调控目标值可以实现产出最大，但是高光强也带来了高成本和浪费问题。因此，接下来将使用差分运算对离散集的变化情况进行分析，根据净光合速率Pn随光量子通量密度PPFD变缓的速度设置光强调控目标，找到变化发生的关键点，即每个阶段的分界点，以分界点为调控目标值，建立光强调控目标值模型，从而实现光强按需控制。S2.3.2：光响应曲线差分特征分析对苗期、开花期和果期的番茄植株在各环境梯度下的离散集数据进行差分运算和结果分析。如公式1和2所示，采用中心差分法，先对各生长期不同温度及二氧化碳浓度条件对应的净光合速率Pn的离散集分别进行一阶和二阶差分运算，再使用三次样条插值法提高差分曲线的分辨率，从而得到一阶和二阶差分曲线。如图7所示，为图6的离散集数据的一阶差分曲线图。一阶差分为正，且绝对值持续变小。说明原函数增长，且速度在一直减小。其中，c为净光合速率对光强的响应函数，单位为μmol·m-2·s-1；c′和c″分别为一阶和二阶差分函数，单位均为μmol·m-2·s-1；等距节点xk＝x0+kh，单位为μmol·m-2·s-1，且常数k＝0,1,…,n；等距节点的步长h为常数，单位为μmol·m-2·s-1。对各生长期不同温度及二氧化碳浓度条件对应的净光合速率Pn离散集进行二阶差分运算，同时使用三次样条提高曲线的分辨率，得到二阶差分曲线。插值节点为光合预测模型得到的步长为10的离散集数据，插值后的响应曲线步长为1。对图6进行运算后得到如图8所示的二阶差分曲线。S2.3.3：光强目标值模型使用搜索算法提取差分曲线的极值点，通过三角插值法分别建立番茄苗期、开花期和果期的光强调控目标值超平面，为光强调控方法的确立提供基础。苗期、开花期和果期的番茄植株在各环境梯度下的离散集数据的二阶差分曲线有三个极值点，应用进化算法进行局部寻优，提取二阶差分曲线的极值点，如图10中空心圆的标记点，二阶差分点在原函数中对应的位置如图9中空心圆标记。根据二阶差分曲线各段的分界点，原函数被划分到了四个区间上。区间1：该区间内二阶差分值从0开始，绝对值逐渐增大，表明原函数是从线性增长开始的，随后速度发生改变。记二阶差分曲线邻域内第一个极值点组成的集合为PPFD′1，所述第一个极值点为极小值点，此时二阶差分值为负且极小，表明一阶差分值下降的速度在该邻域内最小。区间记为区间1，区间1内二阶差分值为负且绝对值一直增大，即一阶差分值下降得快，也就是原函数增长放缓的速度快，区间1包括了光合作用的线性阶段及进入增长缓慢的转变阶段。区间2：记邻域内第二个极值点组成的集合为PPFD′2，所述第二个极值点为极大值点，区间记为区间2，区间2内二阶差分值的绝对值一直减小，即速度放缓，也就是原函数增长放缓的速度慢，在其他环境条件一定的情况下，区间1和区间2内限制光合作用的主要条件是光强。区间3：记邻域内第三个极值点组成的集合为PPFD′3，区间记为区间3，所述第三个极值点为极小值点，区间3内二阶差分值的绝对值开始增大，即一阶差分值最后一次快速下降，对应原函数增长速度快速放缓，原函数进入二氧化碳限制阶段，限制光合的主要外界条件是环境二氧化碳，表明光合作用趋向了饱和。区间4：区间记为区间4，原函数的一阶差分值经过区间3这段快速减小后，已经非常小了，故二阶差分值出现极小值，该点后二阶差分值的绝对值继续变小，对应原函数增长放缓的速度慢，即原函数值已基本不变了，表明光合作用到达了光饱和状态。综上，可以得到差分分析的结果如下：原函数增长速度在一直放缓，但放缓得有快有慢，区间1和区间3为快，区间2和区间4为慢，以二阶差分特征为切入点，将光响应曲线按增长速度划分为第一快速放缓区间、第一缓慢放缓区间、第二快速放缓区间、第二缓慢放缓区间四部分。区间1和区间2分别对应线性增长阶段、开始向二氧化碳限制转变的增长缓慢阶段，这两个区间二阶差分值的绝对值先增后减，一阶差分值较大，净光合速率主要受光限制；区间3和区间4分别对应开始趋向光饱和的快速变缓阶段、发生光饱和的速度基本不变阶段，这两个区间二阶差分值的绝对值先增后减，但一阶差分值较小，净光合速率主要受二氧化碳等非光限制。为提高模型的精度和光强调控的分辨率，使用三角插值的方法对分界点进行插值分析，得到各分界点所组成的目标值超平面，即为第一目标值超平面PPFD1、第二目标值超平面PPFD2、第三目标值超平面PPFD3，作为光强调控的目标值，所述目标值超平面的因变量为光量子通量密度PPFD，自变量包含生长期、二氧化碳浓度和空气温度，当生长期确定后，目标值超平面为三维曲面，x轴为二氧化碳浓度、y轴为空气温度、z轴为光量子通量密度PPFD。原始插值节点为包含苗期、开花期和果期番茄光响应曲线的分界点PPFD′1、PPFD′2、PPFD′3，环境空气温度为25℃、27℃、29℃、31℃和33℃，二氧化碳浓度为400μmol·mol-1、700μmol·mol-1、1000μmol·mol-1和1300μmol·mol-1。运算后得到的插值曲面的温度分辨率为1℃，二氧化碳分辨率为50μmol·mol-1。图11、图12和图13分别为番茄苗期、开花期和果期的光强调控目标值模型示意图，目标值超平面PPFD1、PPFD2和PPFD3将空间分为了四部分，对应差分特征分析中的区间1、区间2、区间3和区间4。S3:根据差分分析的结果，建立调控方法S3.1:当调控需求为作物产出最大化时，则调节目标光量子通量密度PPFD，使之不小于第三目标值超平面PPFD3。此时，通过补光使作物达到光饱和状态，最大化作物的产出；S3.2:当调控需求为投入和产出平衡时，则调节目标光量子通量密度PPFD，使之不小于第二目标值超平面PPFD2。此时，最大化目标光量子通量密度PPFD而又防止进入区间3和区间4，避免发生光饱和的情况，使得投入和产出相平衡；S3.3:当调控需求为收益最大化时，则调节目标光量子通量密度PPFD，使之不小于第一目标值超平面PPFD1；此时，令目标光量子通量密度PPFD达到原函数增速迅速变缓时的光强值，此处在区间1内对应净光合速率Pn最大，避免高能耗的同时，保证了收益最大；S3.4:监测状态：只对当前光强进行监测和预警，不实施控制操作；当光强小于第一目标值超平面PPFD1，即处于区间1时，说明监测到植株在当前环境下存在光限制，即光强成为植株生长的潜在胁迫因素，做出“低光强”提示；当光强超过第三目标值超平面PPFD3时，即处于区间4时，说明监测到植株在当前环境下存在光抑制，即光合作用状态已经达到光饱和状态，若继续增加光强则对作物造成损害，做出“高光强”提示。S3.5保护状态：根据监测到的目标光量子通量密度PPFD，对高于第三目标值超平面PPFD3的光强进行控制；此时，令目标光量子通量密度PPFD不大于第三目标值超平面PPFD3，降低目标光量子通量密度PPFD从而做到保护植株。基于光响应曲线差分特征的光强目标值调控模型为精细化光强调控提供了指导，通过对比环境光强与光强调控目标值模型的空间位置，能够判断出当前作物的光合状态，并根据调控需求实时输出光强调控的目标值。该模型融合了温室番茄的苗期、开花期和果期，能对实际生产中不同温度、二氧化碳浓度和光照红蓝比例等环境条件做出实时响应，满足温室中不同的光强调控需求，实现光环境的量化管理。实施例S1：数据采集实验于2021年3月2日至5月28日在北京农林科学院实验基地9号日光温室开展，实验温室坐北朝南，东西方向长30m，南北宽7m，后墙高3m，温室为下沉式半拱型结构，实验期间室内空气温度为28.70±4.00℃，空气相对湿度为36±12％。实验被试品种为“浙粉702”无限生长型番茄，当植株生长至4-6片真叶时移栽到温室中。实验期间，不额外施用化肥与农药，温室内进行标准且均一的水分管理，以保证植株健康且长势均一。使用便携式光合速率仪和子模块实现净光合速率Pn的测量和叶室环境的精确控制，实验所使用的叶室为标准叶室，通过LED红蓝光源控制叶室内的光量子通量密度PPFD，并通过二氧化碳注入系统控制叶室内二氧化碳浓度，根据当前温室环境值，使用温度控制模块精确稳定当前叶室的温度T，实现温度控制。同时，通过无线传感器网络平台实现测量开展期间温室的环境参数测量。实验期间，光量子通量密度PPFD共设置8个梯度，为200μmol·m-2·s-1,400μmol·m-2·s-1、600μmol·m-2·s-1、800μmol·m-2·s-1、1000μmol·m-2·s-1、1200μmol·m-2·s-1、1400μmol·m-2·s-1和1600μmol·m-2·s-1；二氧化碳浓度共4个梯度，为400μmol·mol-1、700μmol·mol-1、1000μmol·mol-1和1300μmol·mol-1；温度共5个梯度，为25℃，27℃，29℃，31℃和33℃；流速设定为500μmol·s-1。分别于苗期，开花期和果期，先后共三次开展光合测量实验。测量前，充分进行光诱导直到叶片状态稳定；测量时，等待环境稳定，二氧化碳浓度波动小于0.2μmol·mol-1，净光合速率Pn波动小于0.1μmol·m-2·s-1，且蒸腾速率与胞间二氧化碳浓度均大于0，气孔导度大于0且小于1时，进行读数记录；在每次测量的间隔，及时进行匹配操作以消除连续测量带来的误差。测量的对象为长势均一且健康的植株，选取平整的叶片进行测量以保证叶面积一定，叶片位置为植株从上到下的第四叶序的顶叶。S2：数据分析S2.1：数据预处理S2.1.1：数据匹配与清洗将光合数据与环境数据进行匹配，先后滤除状态不稳定的冗余值及超过四分位数的离群值。经匹配和清洗后，共有全生长期的1440组光合数据。S2.1.2：变量筛选和归一化处理数据集的变量包含叶片温度、空气温度、空气相对湿度、空气二氧化碳浓度、大气压强、光量子通量密度、光照红蓝比例等，及对应条件下植株的净光合速率、气孔导度、蒸腾速率、胞间二氧化碳浓度等。经过变量筛选步骤发现，在各变量中，空气温度、空气二氧化碳浓度、光量子通量密度及生长期与植株的净光合速率呈显著相关，因此，将光合预测模型的输入定义为空气温度、空气二氧化碳浓度、光量子通量密度及生长期，模型的输出定义为Pn。各输入变量的量纲存在差异，影响着预测模型中输入的权重，带来了预测误差。使用max-min标准化方法将数据集的各维度统一在区间内，从而消除各维度量纲差异。S2.1.3，数据集划分选取一个生长期梯度，在该梯度内的每个温度及二氧化碳浓度的小梯度下，对所有光量子通量密度条件对应的净光合速率Pn数据按80％的比例选择为训练集，余下的20％则作为测试集，并重复该操作直到遍历所有生长期，完成80％训练集与20％测试集的数据集划分。S2.2：光合预测模型的建立S2.2.1：模型参数优化网络结构：为了实现不同生长期净光合速率Pn的高精度预测，使用极限学习机的方法，并通过增量式网络构造方法确定网络结构。将网络最大节点数设为12，预期学习误差ε设为1，当隐含层节点数为10时满足要求，获得最佳网络结构。网络权值和阈值优化：为了提高模型的预测精度，使用EC算法中的SSA优化算法对网络的权值和阈值进行优化，将算法中的个体编码为权值和阈值，将网络预测误差作为算法的适应度函数，通过优化获取最佳权值和阈值。具体地，将种群大小设置为10，最大迭代次数设置为50，将“生产者”占总个体的比例设置为20％。随着迭代计算的进行，网络的预测误差持续下降并达到稳定，得到了最优网络权值和阈值。此处，对比了同等参数条件设置下遗传算法和粒子群算法的优化结果，表明SSA效果在三者中为最佳，最佳权值和阈值如表1和2所示。表1优化后的网络权值表2优化后的网络阈值S2.2.2：光合预测模型建立与验证基于步骤S2.2.1优化的模型参数，以步骤S2.1.3中数据预处理中划分好的训练集为模型训练的数据集对模型展开训练，并通过5折交叉验证选择优选出验证集误差最小的训练模型，保存该模型为最终的光合预测模型。如表3所示，基于本申请方法所构建的SSA-I-ELM模型误差小、预测准确。表3光合预测模型的评价指标对比表注：SSA-I-ELM为本申请所提出的模型S2.3：光强目标值模型的建立S2.3.1：净光合速率Pn预测调用光合速率预测模型，获取全生长期光合离散数据集，以700μmol·mol-1CO2浓度条件下的苗期植株为例，输入分别设置为苗、花和果期，温度为25-33℃，二氧化碳浓度为400-1300μmol·mol-1，光量子通量密度为200-1600μmol·m-2·s-1，光质为温室环境的红蓝比值，通过调用模型获取得到植株全生长期的净光合速率值，即完整的光响应离散集。对离散数据进行插值运算，得到光响应曲线。S2.3.2：光响应曲线差分特征分析对光响应曲线进行中心差分计算，得到一阶差分结果，根据差分结果使用三次样条绘制一阶差分曲线。结果表明，一阶差分函数值为正，为单调递减函数，光量子通量密度PPFD为0时初始值较高，然后通常在光量子通量密度PPFD最高时趋向于0；在不同光量子通量密度PPFD区间内，下降速度有差异，曲线在开始的区间内较为陡峭，结束的区间内较为平缓的。一阶差分结果表明原函数单调递增，且增长速度一直减小。对光响应曲线进行二阶中心差分计算，得到二阶差分结果，根据差分结果使用三次样条绘制二阶差分曲线。在测量区间内，大部分温度条件对应的二阶差分曲线均存在3个极值点，曲线呈现“W”形状，函数被划分在了4个区间内。S2.3.3：光强调控目标值模型为建立高精度光强调控目标值模型，从而指导温室补光光强，使用三角插值法对二阶差分极值点进行三维曲面构建，由点集PPFD′1、PPFD′2、PPFD′3经过插值分别得到目标值超平面PPFD1、PPFD2、PPFD3。结合上述差分特征分析，当环境条件对应的点位于第三目标值超平面PPFD3上方时，即二维中的区间4，则植株的Pn增长的速度和加速度均很小，甚至同时趋向于0，表明区间内光合是趋于光饱和或达到光饱和的状态，继续提高光量子通量密度PPFD对净光合速率Pn的增益不大，所以第三目标值超平面PPFD3是理想的最大光强调控目标值，可以实现避免光饱和状态的作物产出最大。当环境条件位于第一目标值超平面PPFD1下方时，即二维中的区间1，植株净光合速率Pn增长的速度最快，但速度下降得也越来越快，所以如果以第一目标值超平面PPFD1作为光强调控目标值，则可以在速度下降最快前及时截止。与第三目标值超平面PPFD3对比，此时的补光投入均有效提高了植株的净光合，以较为保守目标值实现了补光投入的效益最大化。第二目标值超平面PPFD2对应二维中的点集PPFD′2，在第二目标值超平面PPFD2上方和下方空间，即二维中的区间1、区间2和区间3、区间4部分，二阶差分值的绝对值均先增后减，即速度先迅速降低后稳定，区别是在第二目标值超平面PPFD2上方空间，限制净光合速率Pn增长的是光量子通量密度PPFD，在第二目标值超平面PPFD2下方空间，限制净光合速率Pn增长的是不再是光量子通量密度PPFD。在第二目标值超平面PPFD2位置上二阶差分值第一次接近于0，即该位置对应速度不为0且变化不大，呈现一个平台，所以第二目标值超平面PPFD2是两种状态的分界，如果以第二目标值超平面PPFD2作为光强调控目标值，则可以在提高净光合速率Pn的同时避免继续增加光量子通量密度PPFD使得速度降低，是产出和投入效益之间的平衡位置。以光合速率最大值位置对应的净光合速率Pn和光量子通量密度PPFD为100％，第三目标值超平面PPFD3在全生长期的Pn为97.84％，PPFD为89.14％，若将补光光强作为投入成本，植株的净光合速率Pn为产出效益，即可计算投入产出比。第三目标值超平面PPFD3对应的比值为1.10，其净光合产出最大；第一目标值超平面PPFD1的Pn为62.10％，PPFD为30.86％，两者比值为2.01，其投入部分的收益最大；第二目标值超平面PPFD2的Pn为67.17％，PPFD为89.36％，两者比值为1.33，是一种投入与收益相平衡的方法。各项指标在每个生长期中的具体表现见表4。表4各目标值对应补光消耗与光合产出对比表S3:根据差分分析的结果，建立调控方法S3.1:当调控需求为作物产出最大化时，则调节目标光量子通量密度PPFD，使之不小于第三目标值超平面PPFD3。此时，通过补光使作物达到光饱和状态，最大化作物的产出；S3.2:当调控需求为投入和产出平衡时，则调节目标光量子通量密度PPFD，使之不小于第二目标值超平面PPFD2。此时，最大化目标光量子通量密度PPFD而又防止进入区间3和区间4，避免发生光饱和的情况，使得投入和产出相平衡；S3.3:当调控需求为收益最大化时，则调节目标光量子通量密度PPFD，使之不小于第一目标值超平面PPFD1。此时，令目标光量子通量密度PPFD达到原函数增速迅速变缓时的光强值，此处在区间1内对应净光合速率Pn最大，避免高能耗的同时，保证了收益最大；S3.4:监测状态：只对当前光强进行监测和预警，不实施控制操作；当光强小于第一目标值超平面PPFD1，即处于区间1时，说明监测到植株在当前环境下存在光限制，即光强成为植株生长的潜在胁迫因素，做出“低光强”提示；当光强超过第三目标值超平面PPFD3时，即处于区间4时，说明监测到植株在当前环境下存在光抑制，即光合作用状态已经达到光饱和状态，若继续增加光强则对作物造成损害，做出“高光强”提示；S3.5保护状态：根据监测到的目标光量子通量密度PPFD，对高于第三目标值超平面PPFD3的光强进行控制；此时，令目标光量子通量密度PPFD不大于第三目标值超平面PPFD3，降低目标光量子通量密度PPFD从而做到保护植株。基于光响应曲线差分特征的光强目标值调控模型为精细化光强调控提供了指导，通过对比环境光强与光强调控目标值模型的空间位置，可以判断出当前作物的光合状态，并根据调控需求实时输出光强调控的目标值。该模型融合了温室番茄的苗期、开花期和果期，能对实际生产中不同温度和二氧化碳浓度等环境条件做出实时响应，满足温室中不同的光强调控需求，实现光环境的量化管理。
