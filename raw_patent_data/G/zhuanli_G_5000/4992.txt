标题title
基于图像分析的金手指电路板检测方法
摘要abst
本发明涉及图像数据处理技术领域，具体涉及一种基于图像分析的金手指电路板检测方法，该方法包括：获取包括金手指区域的PCB板表面的灰度图像；计算灰度图像中每个像素点与其邻域像素点之间的灰度差异值，以得到像素点的显著差异方向判断因子，基于显著差异方向判断因子得到每个邻域像素点的灰度信息校正因子；获取至少两张PCB板表面的差分图像并根据差分图像中对应位置像素点的显著差异方向判断因子得到对应位置像素点的异常程度，结合像素点对应邻域像素点的灰度信息校正因子得到隶属度校正因子，进而得到优化隶属度影响因子，根据优化隶属度影响因子得到金手指区域进行质量检测，提高了分割的准确性和质量检测结果的可靠性。
权利要求书clms
1.一种基于图像分析的金手指电路板检测方法，其特征在于，该方法包括以下步骤：获取包括金手指区域的PCB板表面的灰度图像；计算所述灰度图像中每个像素点与其邻域像素点之间的灰度差异值；根据所述灰度差异值获取每个像素点的显著差异方向判断因子，基于所述显著差异方向判断因子得到每个邻域像素点的灰度信息校正因子；获取至少两张PCB板表面的差分图像，根据所有所述差分图像中对应位置像素点的所述显著差异方向判断因子，得到对应位置像素点的异常程度；根据像素点的所述异常程度、对应邻域像素点的所述灰度信息校正因子以及邻域像素点对应的灰度差异值得到对应邻域像素点的隶属度校正因子；基于所述隶属度校正因子得到FLICM算法中的优化隶属度影响因子，基于所述优化隶属度影响因子分割灰度图像中的金手指区域并进行质量检测。2.根据权利要求1所述的一种基于图像分析的金手指电路板检测方法，其特征在于，所述根据所述灰度差异值获取每个像素点的显著差异方向判断因子的步骤，包括：以任意像素点为中心点，将所述中心点在竖直方向上与上邻域像素点的灰度差异值、所述中心点在竖直方向上与下邻域像素点的灰度差异值的求和记为第一求和结果；将所述中心点在水平方向上与左邻域像素点的灰度差异值、所述中心点在水平方向上与右邻域像素点的灰度差异值的求和记为第二求和结果；获取所述第一求和结果与所述第二求和结果的差值以及所述第一求和结果与所述第二求和结果的差值绝对值；所述差值与所述差值绝对值的比值为所述中心点的显著差异方向判断因子。3.根据权利要求2所述的一种基于图像分析的金手指电路板检测方法，其特征在于，所述基于所述显著差异方向判断因子得到每个邻域像素点的灰度信息校正因子的步骤，包括：若所述显著差异方向判断因子取值为1，则选取所述中心点在水平方向上的左邻域像素点和右邻域像素点为参考点；若所述显著差异方向判断因子取值为-1，则选取所述中心点在竖直方向上的上邻域像素点和下邻域像素点为参考点；对所述中心点与其对应的所有邻域像素点之间的灰度差异值进行归一化，所述参考点对应的归一化后的灰度差异值为对应参考点的灰度信息校正因子；非参考点的邻域像素点的灰度信息校正因子为零。4.根据权利要求2所述的一种基于图像分析的金手指电路板检测方法，其特征在于，所述根据所述灰度差异值获取每个像素点的显著差异方向判断因子的步骤，还包括：若所述第一求和结果与所述第二求和结果的差值绝对值不大于预设的差异判断阈值，所述中心点的显著差异方向判断因子为0。5.根据权利要求1所述的一种基于图像分析的金手指电路板检测方法，其特征在于，所述根据所有所述差分图像中对应位置像素点的所述显著差异方向判断因子，得到对应位置像素点的异常程度的步骤，包括：对于任意一个像素点，获取所述像素点在所有所述差分图像中对应位置像素点的显著差异方向判断因子的求和绝对值；根据所述求和绝对值与所有所述差分图像的数量的比值获取所述像素点的异常程度，所述异常程度与所述比值呈负相关关系。6.根据权利要求1所述的一种基于图像分析的金手指电路板检测方法，其特征在于，所述根据像素点的所述异常程度、对应邻域像素点的所述灰度信息校正因子以及邻域像素点对应的灰度差异值得到对应邻域像素点的隶属度校正因子的步骤，包括：将预设常数与像素点对应所述异常程度相加得到第一相加结果；对于像素点的任意一个邻域像素点，获取邻域像素点的灰度差异值，在像素点对应的所有邻域像素点的灰度差异值的求和中的占比，计算所述占比与对应邻域像素点的灰度信息校正因子的求和结果并进行归一化，将归一化后的求和结果与预设常数相加得到第二相加结果；所述第一相加结果与所述第二相加结果的乘积为对应邻域像素点的隶属度校正因子。7.根据权利要求1所述的一种基于图像分析的金手指电路板检测方法，其特征在于，所述基于所述隶属度校正因子得到FLICM算法中的优化隶属度影响因子的步骤，包括：所述优化隶属度影响因子为：其中，表示校正后的第i个像素点的隶属度影响因子，即优化隶属度影响因子； 表示以第i个像素点为中心点时，第j个邻域像素点与中心点之间的欧式距离；表示第j个邻域像素点对应的隶属度校正因子；表示第j个邻域像素点属于第k类的隶属度； 表示第k类的聚类中心；表示第j个邻域像素点；表示第j个邻域像素点与第k类的聚类中心之间的欧式距离；表示以第i个像素点为中心点时邻域像素点的数量；m表示隶属度模糊加权指数。8.根据权利要求1所述的一种基于图像分析的金手指电路板检测方法，其特征在于，所述基于所述优化隶属度影响因子分割灰度图像中的金手指区域并进行质量检测的步骤，包括：通过优化隶属度影响因子下的FLICM算法对灰度图像进行分割，得到金手指区域的图像，若所述金手指区域的图像存在边缘缺失或者凹坑，所述金手指区域的质量不佳。
说明书desc
技术领域本发明涉及图像数据处理技术领域，具体涉及一种基于图像分析的金手指电路板检测方法。背景技术在PCB板的生产过程中，需要对PCB板上的金手指区域进行质量检测，以判断生产的PCB板中的金手指是否符合生产质量要求；在对金手指区域进行检测之前需要将PCB板中的金手指区域进行分割，然后对分割出的金手指区域进行异常识别；而实际检测过程中可能由于相机分辨率以及外界因素等情况无法获取PCB板的高清图像，以至于对金手指区域进行分割时会受到模糊像素点的影响。为了避免模糊像素点对金手指区域分割的效果，一般采用FLICM算法进行分割，该方法是基于像素点的局部信息进行分割，像素点的局部信息可以帮助像素点对抗因为模糊导致的无法准确分割的问题；但利用FLICM算法分割时忽略了金手指表面可能存在的缺陷区域，当金手指区域存在缺陷时，像素点的局部信息会受到异常信息的干扰，可能会将部分异常像素点当作正常像素点进行分割，导致最终的分割效果较差，进而金手指区域质量检测的结果也不够准确。发明内容为了解决现有FLICM算法分割效果差，导致金手指区域质量检测不准确的问题，本发明的目的在于提供一种基于图像分析的金手指电路板检测方法，所采用的技术方案具体如下：本发明一个实施例提供了一种基于图像分析的金手指电路板检测方法，该方法包括以下步骤：获取包括金手指区域的PCB板表面的灰度图像；计算所述灰度图像中每个像素点与其邻域像素点之间的灰度差异值；根据所述灰度差异值获取每个像素点的显著差异方向判断因子，基于所述显著差异方向判断因子得到每个邻域像素点的灰度信息校正因子；获取至少两张PCB板表面的差分图像，根据所有所述差分图像中对应位置像素点的所述显著差异方向判断因子，得到对应位置像素点的异常程度；根据像素点的所述异常程度、对应邻域像素点的所述灰度信息校正因子以及邻域像素点对应的灰度差异值得到对应邻域像素点的隶属度校正因子；基于所述隶属度校正因子得到FLICM算法中的优化隶属度影响因子，基于所述优化隶属度影响因子分割灰度图像中的金手指区域并进行质量检测。优选的，所述根据所述灰度差异值获取每个像素点的显著差异方向判断因子的步骤，包括：以任意像素点为中心点，将所述中心点在竖直方向上与上邻域像素点的灰度差异值、所述中心点在竖直方向上与下邻域像素点的灰度差异值的求和记为第一求和结果；将所述中心点在水平方向上与左邻域像素点的灰度差异值、所述中心点在水平方向上与右邻域像素点的灰度差异值的求和记为第二求和结果；获取所述第一求和结果与所述第二求和结果的差值以及所述第一求和结果与所述第二求和结果的差值绝对值；所述差值与所述差值绝对值的比值为所述中心点的显著差异方向判断因子。优选的，所述基于所述显著差异方向判断因子得到每个邻域像素点的灰度信息校正因子的步骤，包括：若所述显著差异方向判断因子取值为1，则选取所述中心点在水平方向上的左邻域像素点和右邻域像素点为参考点；若所述显著差异方向判断因子取值为-1，则选取所述中心点在竖直方向上的上邻域像素点和下邻域像素点为参考点；对所述中心点与其对应的所有邻域像素点之间的灰度差异值进行归一化，所述参考点对应的归一化后的灰度差异值为对应参考点的灰度信息校正因子；非参考点的邻域像素点的灰度信息校正因子为零。优选的，所述根据所述灰度差异值获取每个像素点的显著差异方向判断因子的步骤，还包括：若所述第一求和结果与所述第二求和结果的差值绝对值不大于预设的差异判断阈值，所述中心点的显著差异方向判断因子为0。优选的，所述根据所有所述差分图像中对应位置像素点的所述显著差异方向判断因子，得到对应位置像素点的异常程度的步骤，包括：对于任意一个像素点，获取所述像素点在所有所述差分图像中对应位置像素点的显著差异方向判断因子的求和绝对值；根据所述求和绝对值与所有所述差分图像的数量的比值获取所述像素点的异常程度，所述异常程度与所述比值呈负相关关系。优选的，所述根据像素点的所述异常程度、对应邻域像素点的所述灰度信息校正因子以及邻域像素点对应的灰度差异值得到对应邻域像素点的隶属度校正因子的步骤，包括：将预设常数与像素点对应所述异常程度相加得到第一相加结果；对于像素点的任意一个邻域像素点，获取邻域像素点的灰度差异值，在像素点对应的所有邻域像素点的灰度差异值的求和中的占比，计算所述占比与对应邻域像素点的灰度信息校正因子的求和结果并进行归一化，将归一化后的求和结果与预设常数相加得到第二相加结果；所述第一相加结果与所述第二相加结果的乘积为对应邻域像素点的隶属度校正因子。优选的，所述基于所述隶属度校正因子得到FLICM算法中的优化隶属度影响因子的步骤，包括：所述优化隶属度影响因子为：其中，表示校正后的第个像素点的隶属度影响因子，即优化隶属度影响因子；表示以第个像素点为中心点时，第个邻域像素点与中心点之间的欧式距离；表示第个邻域像素点对应的隶属度校正因子；表示第个邻域像素点属于第类的隶属度；表示第类的聚类中心；表示第个邻域像素点；表示第个邻域像素点与第类的聚类中心之间的欧式距离；表示以第个像素点为中心点时邻域像素点的数量；表示隶属度模糊加权指数。优选的，所述基于所述优化隶属度影响因子分割灰度图像中的金手指区域并进行质量检测的步骤，包括：通过优化隶属度影响因子下的FLICM算法对灰度图像进行分割，得到金手指区域的图像，若所述金手指区域的图像存在边缘缺失或者凹坑，所述金手指区域的质量不佳。本发明具有如下有益效果：本发明实施例通过对FLICM算法中的隶属度影响因子进行优化，基于优化隶属度影响因子进行金手指区域的分割和质量检测，提高了分割的准确性，从而确保了质量检测结果的可靠性；在获取优化隶属度影响因子时，首先基于每个像素点与邻域像素点之间的灰度差异值得到显著差异方向判断因子，进而根据显著差异方向判断因子得到灰度校正因子，以根据灰度差异值初步筛选掉一些对金手指区域分割作用不大的像素点，后续结合不同差分图像中对应位置像素点的显著差异方向判断因子进行异常程度的获取，避免了仅考虑像素点周围局部信息导致的误分割情况，通过不同差分图像中的显著差异方向判断因子得到的异常程度也更加准确可靠；结合像素点的异常程度、像素点的邻域像素点的灰度信息校正因子以及邻域像素点的灰度差异值进行隶属度校正因子的获取，得到的隶属度校正因子所结合的信息更加全面，相较于单一的灰度信息进行分析得到的结果更加具有说服力，因此根据隶属度校正因子得到的FLICM算法中的优化隶属度影响因子，为后续利用该算法进行分割的准确度提供了保障，并且对金手指区域的质量检测结果也更加准确。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明一个实施例所提供的一种基于图像分析的金手指电路板检测方法流程图；图2为本发明一个实施例所提供的一种金手指区域边缘缺失的示意图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种基于图像分析的金手指电路板检测方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构、或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种基于图像分析的金手指电路板检测方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种基于图像分析的金手指电路板检测方法流程图，该方法包括以下步骤：步骤S100，获取包括金手指区域的PCB板表面的灰度图像。在PCB板的生产过程中需要对PCB板的质量进行检测，检测PCB板的金手指区域时，往往是将金手指区域进行分割，以针对性的检测金手指区域的生产质量；而由于工业相机所采集到的图像可能会存在分辨率低和成像模糊的问题，因此根据采集的图像进行金手指区域的分割时，会受到图像质量的干扰。在图像分割过程中，为了保证分割的质量，常采用基于局部信息的模糊聚类方法FLICM对图像进行分割，以避免边缘像素点因为图像模糊造成错误分割；但是在使用FLICM算法实际进行分割时，忽略了图像中可能出现缺陷这一影响，因此局部信息的影响可能会导致金手指区域的缺陷像素点被分割为正常区域的像素点，导致对金手指区域的检测不够准确，进而会导致无法准确的检测出金手指区域的质量问题，因此本实施例的目的是对FLICM算法修正，以使得分割出的金手指区域更加准确，以便于后续进行质量检测。具体的，在PCB板生产过程中，通过工业相机采集PCB板上包括金手指区域的图像，为便于后续的计算，对图像进行灰度化处理得到对应的灰度图像，灰度化处理的方法为公知手段，不再赘述。步骤S200，计算灰度图像中每个像素点与其邻域像素点之间的灰度差异值；根据灰度差异值获取每个像素点的显著差异方向判断因子，基于显著差异方向判断因子得到每个邻域像素点的灰度信息校正因子。考虑到金手指区域的像素点分布固定，边缘基本都是竖直或者水平分布，因此在FLICM算法中对隶属度影响因子的计算过程中考虑到像素点的分布信息，加强像素点两侧的邻域像素点影响，并且当某个像素点与其邻域像素点之间的灰度差异较大时，需要考虑该点是否为异常像素点，以避免获取到的隶属度影响因子不准确，影响最终分割效果。在分割过程中由于隶属度影响因子的原因，可能会使得图像中边缘区域划分为不规则的形状，因此会无法判断金手指区域的边缘完整性和异常信息，需要对隶属度影响因子进行优化校正。以任意像素点为中心点，将中心点在竖直方向上与上邻域像素点的灰度差异值、中心点在竖直方向上与下邻域像素点的灰度差异值的求和记为第一求和结果；将中心点在水平方向上与左邻域像素点的灰度差异值、中心点在水平方向上与右邻域像素点的灰度差异值的求和记为第二求和结果；获取第一求和结果与第二求和结果的差值以及第一求和结果与第二求和结果的差值绝对值；差值与差值绝对值的比值为中心点的显著差异方向判断因子。首先，以灰度图像中每个像素点为中心点，获取该中心点对应的八邻域内的邻域像素点，计算每个邻域像素点与该中心点之间的灰度差异值，该灰度差异值是指邻域像素点与中心点之间的灰度差值绝对值，即差异值为：其中，表示中心点的灰度值； 表示中心点的八邻域内第个邻域像素点的灰度值；表示中心点的八邻域内第个邻域像素点对应的灰度差异值；表示取绝对值。然后，根据中心点与其邻域像素点之间的灰度差异值获取显著差异方向判断因子，显著差异方向判断因子的计算为：其中，表示第个像素点的显著差异方向判断因子，也即是中心点的显著差异方向判断因子；表示中心点的八邻域内第2个邻域像素点对应的差异值；表示中心点的八邻域内第4个邻域像素点对应的差异值；表示中心点的八邻域内第6个邻域像素点对应的差异值；表示中心点的八邻域内第8个邻域像素点对应的差异值；表示取绝对值。通过差异判断阈值进行衡量，判断分母项的取值是否大于预设的差异判断阈值，若大于，则认为该中心点的邻域信息存在主要差异方向，基于显著差异判断因子对中心点的参考点进行分析，若不大于，则认为该中心点不存在主要差异方向，对应显著差异判断方向因子为0；通过该部分筛选，可以初步确定出其中的边缘像素点进行后续参考点的获取，本发明实施例中给出差异判断阈值的推荐值为30，在其他实施例中实施者根据实际情况确定，差异判断阈值可通过图像进行试验获取，数值为通过Canny算子进行边缘检测时的第一个阈值。分子项实际是，本实施例中对中心点的八邻域像素点进行序号标记时，以左上角的邻域像素点为第1个邻域像素点，然后逆时针的顺序以此标记的8个邻域像素点，因此和是中心点在竖直方向上下相邻的两个邻域像素点的灰度差异值，和是中心点水平方向左右相邻的两个邻域像素点的灰度差异值，则分子项 即为中心点在竖直方向上与邻域像素点的灰度差异值之和与中心点在水平方向上与邻域像素点的灰度差异值之和的差值；的取值为1或者-1，当取值为1时，说明中心点在竖直方向上的差异值之和大于中心点在水平方向上的差异值之和，此时中心点的主要参考方向为竖直方向，则更多的通过水平方向的邻域像素点作为隶属度影响因子的修正参考；反之，当取值为-1时，说明中心点在竖直方向上的差异值之和小于中心点在水平方向上的差异值之和，此时中心点的主要参考方向为水平方向，则更多的通过竖直方向的邻域像素点作为隶属度影响因子的修正参考。若显著差异方向判断因子取值为1，则选取中心点在水平方向上的左邻域像素点和右邻域像素点为参考点；若显著差异方向判断因子取值为-1，则选取中心点在竖直方向上的上邻域像素点和下邻域像素点为参考点；对中心点与其对应的所有邻域像素点之间的灰度差异值进行归一化，参考点对应的归一化后的灰度差异值为对应参考点的灰度信息校正因子；非参考点的邻域像素点的灰度信息校正因子为零。基于像素点的显著差异方向判断因子可选取出两个邻域像素点作为参考点，当时，选取第4个邻域像素点和第8个邻域像素点为参考点；当时，选取第2个邻域像素点和第6个邻域像素点为参考点。进一步的，基于每个像素点的显著差异方向判断因子选取出邻域像素点中的参考点之后，获取参考点对应的灰度信息校正因子，灰度信息校正因子的获取为：对像素点对应八邻域像素点的灰度差异值进行归一化，归一化后的参考点的灰度差异值为该参考点的灰度信息校正因子；对于除参考点之外的其他邻域像素点，其对应的灰度信息校正因子为0；由此得到像素点对应的每个邻域像素点的灰度信息校正因子。通过主要参考方向确定范围内的参考点，可以避免在边缘区域像素点分割时出现不规则的问题，使得边缘区域的像素点的隶属度影响因子可以更多的考虑到像素点对应参考点的方向，降低了边缘区域像素点的两侧像素点对于该像素点簇类划分的影响，在此基础上通过灰度信息校正因子对隶属度影响因子进行校正，提高准确性。步骤S300，获取至少两张PCB板表面的差分图像，根据所有差分图像中对应位置像素点的显著差异方向判断因子，得到对应位置像素点的异常程度。除了考虑像素点的参考点对簇类分割过程中的影响之外，还需要考虑在遇到缺陷区域时如何使得局部信息的隶属度影响因子不会造成异常像素点的错误分割；在出现缺陷区域时，金手指区域中的正常像素点即使在图像模糊的情况下，其显著方向判断因子也并不会发生变化，而在工业相机采集PCB板图像时，不同分辨率下采集到的图像的模糊程度不同，因此灰度图像中可能会存在显著差异方向判断因子出现变化的像素点，因此根据同一个像素点在不同模糊程度的图像下对应的显著差异方向判断因子分析像素点处的异常情况。具体的，工业相机在拍摄PCB板图像时存在一个聚焦的过程，在整个聚焦的过程中工业相机会拍摄到不同模糊程度的图像，将拍摄得到的最清晰的图像记为原始图像，也即是上述步骤中的灰度图像；选取多张拍摄的不同模糊程度的图像作为模糊图像，则原始图像与其他每张模糊图像之间存在对应的差分图像，模糊图像与原始图像中拍摄的PCB板相同，也即是原始图像与模糊图像中仅存在图像模糊程度上的差异；基于原始图像与模糊图像之间的差分图像进行像素点异常程度的分析，差分图像的获取方法为公知技术，本实施例中不再赘述；模糊图像数量的选取由实施者自行设定，本实施例中设定数量为5，则根据原始图像与5张不同模糊程度的模糊图像可得到对应的5张差分图像。基于步骤S200中获取灰度图像中每个像素点的显著差异方向判断因子同样的方法，获取差分图像中每个像素点对应的显著差异方向判断因子，因为5张差异图像的尺寸一致，同一位置会存在5个像素点，也即是每个差异图像中每个像素点在其他4张差异图像中均存在相同位置对应的像素点，由于显著差异方向判断因子的取值只有1和-1，因此如果同一位置像素点在多张差分图像中对应的显著差异方向判断因子的取值始终相同时，则表明该像素点不存在异常，如果同一位置像素点在多张差分图像中对应的显著差异方向判断因子的取值存在不同的差异，则该像素点的异常程度越大，根据同一位置的像素点在不同差分图像中的显著差异方向判断因子得到该位置像素点的异常程度；对于任意一个像素点，获取像素点在所有差分图像中对应位置像素点的显著差异方向判断因子的求和绝对值；根据求和绝对值与所有差分图像的数量的比值获取像素点的异常程度，异常程度与比值呈负相关关系。以第 个像素点为例，该像素点的异常程度的计算为：其中，表示第个像素点的异常程度；表示第张差分图像中第个像素点对应位置像素点的显著差异方向判断因子；表示差分图像的数量，本实施例中；表示取绝对值。由于显著差异方向判断因子的取值只有1和-1，因此当第个像素点的显著差异方向判断因子在5张差分图像均取1或者均取-1时， 的取值结果为5，则 取值为1，也即是第个像素点的异常程度为0；当第个像素点的显著差异方向判断因子在5张差分图像中的取值不一致时，则不同取值之间相加结果会小于5，则 的取值会小于1，该项取值越大，表明差异图像中显著差异方向判断因子存在差异的越少，则第个像素点的异常程度越小。基于获取第个像素点的异常程度相同的方法，获取灰度图像中每个位置像素点对应的异常程度。现有对像素点的异常程度判断的方法大多是基于该像素点与其对应的邻域像素点之间的差异进行分析，通过差异数值在全局图像中的数值大小得到像素点的异常程度；而本发明实施例中通过像素点的位置情况，结合不同模糊程度下的差分图像进行分析，通过每个位置像素点的显著差异方向判断因子获取每个像素点的异常程度，可以避免进行全局的运算，同时可以通过像素点的分布特征对像素点的异常程度进行更加显著的表征；对于正常的像素点而言，其在不同差分图像中的显著差异方向判断因子不会发生变化，而异常像素点在不同差分图像中会发生随机的变化，因此通过变化的次数对像素点的异常程度进行衡量，结果更加直接且准确性也高。步骤S400，根据像素点的异常程度、对应邻域像素点的灰度信息校正因子以及邻域像素点对应的灰度差异值得到对应邻域像素点的隶属度校正因子。由步骤S300获取到灰度图像中每个像素点对应的异常程度，步骤S200中获取像素点对应的每个邻域像素点的灰度信息校正因子，对于每个像素点而言，其对应的邻域像素点的灰度信息校正因子不同，且像素点与邻域像素点之间的灰度差异值也不同，因此在进行FLICM算法对像素点的局部信息进行分析时，需要考虑像素点对应的每个邻域像素点的影响情况，本发明实施例中通过获取每个邻域像素点的隶属度校正因子对FLICM算法中局部信息的隶属度影响因子进行优化；将预设常数与像素点对应异常程度相加得到第一相加结果；对于像素点的任意一个邻域像素点，获取像素点对应的每个邻域像素点的灰度差异值，在像素点对应的所有邻域像素点的灰度差异值的求和中的占比，计算占比与对应邻域像素点的灰度信息校正因子的求和结果并进行归一化，将归一化后的求和结果与预设常数相加得到第二相加结果；第一相加结果与第二相加结果的乘积为邻域像素点的隶属度校正因子。以第个像素点为中心点，对该中心点对应的每个邻域像素点的隶属度校正因子进行获取；以中心点对应的八邻域内第个邻域像素点为例，获取第个邻域像素点对应的隶属度校正因子为：其中，表示第个邻域像素点对应的隶属度校正因子；表示第个邻域像素点对应的灰度信息校正因子； 表示中心点的异常程度，也即是第个像素点的异常程度；表示第个邻域像素点对应的灰度差异值；表示第个像素点为中心点时的邻域像素点数量，本实施例中取值为8；表示归一化函数；1为本实施例中的预设常数；为第一相加结果； 为第二相加结果。表示中心点八邻域内所有邻域像素点对应的灰度差异值的求和；表示每个邻域像素点的灰度差异值在八邻域所有邻域像素点的灰度差异值的求和的占比，当邻域像素点的灰度信息校正因子越大，且该邻域像素点对应的灰度差异值的占比越大时，说明该邻域像素点所起到的影响作用越大，越应该被关注，则对应的隶属度校正因子越大；同时，由于邻域像素点的灰度信息校正因子存在差异，除了中心点的参考点之外的邻域像素点的灰度信息校正因子均为0，也即是考虑到中心点的主要参考方向进行判断，通过灰度信息校正因子与灰度差异值结合分析，结果更加准确；相应的，当该像素点的异常程度越大时，越可能为异常像素点，则越关注像素点周围的邻域像素点的信息，以防止错误分割。基于上述获取第个邻域像素点的隶属度校正因子同样的方法，获取每个邻域像素点对应的隶属度校正因子。步骤S500，基于隶属度校正因子得到FLICM算法中的优化隶属度影响因子，基于优化隶属度影响因子分割灰度图像中的金手指区域并进行质量检测。由步骤S400中得到每个邻域像素点对应的隶属度校正因子，也即是灰度图像中每个像素点对应的隶属度校正因子，根据每个像素点的隶属度校正因子对FLICM算法中的隶属度影响因子进行校正，以避免在模糊像素点影响情况下的误分割现象，校正后的隶属度影响因子为：其中，表示校正后的第个像素点的隶属度影响因子，记为优化隶属度影响因子；表示以第个像素点为中心点时，第个邻域像素点与中心点之间的欧式距离；表示第个邻域像素点对应的隶属度校正因子；表示第个邻域像素点属于第类的隶属度；表示第类的聚类中心；表示第个邻域像素点；表示第个邻域像素点与第类的聚类中心之间的欧式距离；表示以第个像素点为中心点时邻域像素点的数量；表示隶属度模糊加权指数。隶属度影响因子为FLICM算法中的公知公式，不作详细赘述，本实施例中根据每个像素点的邻域像素点对应隶属度校正因子对隶属度影响因子进行修正，使得在聚类迭代过程中可以考虑到像素点的主要差异方向，提高边缘像素点的整齐性，并且考虑到了每个像素点的异常程度，使得即便是异常区域的像素点也可以被完整准确的分割，基于优化隶属度影响因子下的FLICM算法对灰度图像进行分割，具体方法为公知手段，不作详细说明，分割得到消除模糊后分割的金手指区域的图像，此时的金手指区域的图像有效避免了异常像素点的影响，根据分割出的金手指区域的图像进行生产质量的检测，通过对金手指区域的连通域信息的缺失情况进行分析，当金手指区域存在边缘缺失或者凹坑时，例如图2所示的一种金手指区域边缘缺失的示意图，判定该金手指区域的生产质量不佳，以此完成了金手指区域的生产质量检测。综上所述，本发明实施例通过获取包括金手指区域的PCB板表面的灰度图像；计算灰度图像中每个像素点与其邻域像素点之间的灰度差异值；根据灰度差异值获取每个像素点的显著差异方向判断因子，基于显著差异方向判断因子得到每个邻域像素点的灰度信息校正因子；获取至少两张PCB板表面的差分图像，根据所有差分图像中对应位置像素点的显著差异方向判断因子，得到对应位置像素点的异常程度；根据像素点的异常程度、对应邻域像素点的灰度信息校正因子以及邻域像素点对应的灰度差异值得到对应邻域像素点的隶属度校正因子；基于隶属度校正因子得到FLICM算法中的优化隶属度影响因子，基于优化隶属度影响因子分割灰度图像中的金手指区域并进行质量检测，提高了金手指区域分割的准确性，同时保证了质量检测的准确性。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
