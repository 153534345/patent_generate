标题title
一种基于数字地形模型精准识别农田洼地特征的方法
摘要abst
本本发明公开了一种基于数字地形模型精准识别农田洼地特征的方法，包括以下步骤：基于无人机航拍图像建立厘米级高精度农田数字地形模型，并以DTM的平均高程为基准，建立反转数字地形模型；在RDTM环境下，提取农田高程极大值点；选取高程、地形起伏度和坡度三个地形因子，通过熵权法确定上述地形因子的权重，利用加权法获取地形因子综合隶属度，并通过多窗口地形因子综合隶属度确定阈值，定位农田洼地特征的位置；利用等高线分析法识别农田洼地特征的外形轮廓，计算各洼地特征的填方量。本方法结合无人机遥感及图像处理技术，能够精准识别农田洼地特征，可为土地复垦、高标准农田平整提供理论数据。
权利要求书clms
1.一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：包括以下步骤：步骤一、采用搭载高像素航拍相机的测绘无人机，进行航拍测绘作业获取航片，基于运动恢复结构技术，获取厘米级高精度农田数字地形模型DTM；步骤二、利用3×3像素窗口对步骤一得到的DTM进行均值滤波处理；步骤三、将滤波处理后的DTM平均高程作为水平面基准，经反向翻转建立反转地形模型RDTM，RDTM与DTM存在反转对称关系；步骤四、设定分析窗口尺度的初值为10×10像素，步长为10像素，终值为100×100像素，统计各分析窗口尺度下的高程方差，分析高程方差随窗口尺度的变化规律，确定高程方差取极值时的窗口尺度为y，设×像素为窗口x，×像素为窗口z；步骤五、在z分析窗口下获取RDTM极大值栅格数据，并提取农田高程极大值点；步骤六、选取高程、地形起伏度和坡度3个地形因子作为高程极大值点的评价指标；步骤七、为了避免主观因素的干扰，采用熵权法确定在各窗口尺度下3个地形因子的权重；步骤八、根据在各窗口下3个地形因子的权重，对高程极大值点进行综合评价，分别计算在各窗口下的地形因子综合隶属度；步骤九、确定各窗口的权重，同时结合各窗口下高程极值点的地形因子综合隶属度，获取多窗口地形因子综合隶属度；步骤十、通过多窗口地形因子综合隶属度确定阈值，提取多窗口地形因子综合隶属度大于该阈值的高程极大值点，即为洼地特征极值点，实现洼地特征的定位；步骤十一、以DTM的空间分辨率为等高距，获取农田等高线图；步骤十二、利用等高线分析法识别农田洼地特征的外形轮廓，即提取洼地特征；步骤十三、向外偏置洼地特征轮廓50cm作为缓冲区，计算各洼地特征及缓冲区域的高程均值，即确定基准面高度；步骤十四、根据洼地特征的基准面高度，计算洼地特征的填方量。2.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤一中所述无人机采用固定翼、多旋翼以及直升机形式的无人机，无人机的飞行高度根据农田数字地形模型DTM的空间分辨率设定，获取航片时保障航片横向重叠率及纵向重叠率均不小于80％，厘米级高精度农田数字地形模型DTM的空间分辨率不低于5cm。3.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤三中，RDTM与DTM两者坡度相差180°，原始DTM的高程值极小点表现为RDTM的高程值极大点。4.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤五中，高程极大值点的提取方法为：与RDTM数据进行空间求差运算得差值栅格数据，将差值栅格数据进行二值化重分类，即将值为0的栅格赋值为1，而将其余栅格赋值为0，提取值为1的栅格，即高程极大值点。5.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤六中，使用归一化公式对3个地形因子进行归一化处理；其中，fijk为地形因子归一化值，i为地形因子序号，分别代表高程、地形起伏度和坡度，j为高程极值点序号，k为窗口尺度，max、min分别为在窗口尺度k下各地形因子的最大值和最小值，xijk为在窗口尺度k下第j个高程极值点的值。6.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤七中，熵权法的具体步骤为：根据公式计算在窗口尺度z下第j个高程极值点的各地形因子的比重；利用公式确定在窗口尺度z下各地形因子的熵值；通过公式确定3个地形因子在窗口尺度z下的权重；重复上述方法获取在x窗口和y窗口下的高程、坡度及地形起伏度的权重。7.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤八中，利用公式对高程极大值点进行综合评价，其中，为在窗口尺度k下地形因子对各农田高程极值点的地形因子综合隶属度。8.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤九中，各窗口的权重利用线性加权公式得出，其中，γk为分析窗口的权重，k1、k2、k3分别为x，y，z分析窗口尺寸；使用公式获取多窗口地形因子综合隶属度，其中，ψjk为多窗口综合地形因子综合隶属度。9.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤十中，确定阈值的具体方法为：计算多窗口地形因子综合隶属度的分级组数和分级组距，并分析高程极值点的数量随多窗口地形因子综合隶属度的变化规律，确定高程极值点数量急剧减小时的多窗口地形因子综合隶属度的值为阈值；其中利用斯特吉斯公式n＝1+log10C/log102和公式分别计算多窗口地形因子综合隶属度的分级组数和分级组距，其中，C为高程极值点数量；分别为阈值的最大值和最小值。10.根据权利要求1所述的一种基于数字地形模型精准识别农田洼地特征的方法，其特征在于：步骤十二中，等高线分析法的具体方法为：将包含洼地特征极值点的闭合等高线作为初始等高线，由内向外搜寻包含各洼地特征极值点的闭合等高线，当闭合等高线内出现未包含洼地特征极值点的闭合等高线时终止搜寻，确定上一条等高线所包围的区域为洼地特征轮廓；步骤十四中，利用公式计算洼地特征的填方量，其中，V填为洼地特征的填方量/m3，n为洼地特征包含的栅格数量，Δσi为栅格底面积/m2，Zi为栅格高程/m。
说明书desc
技术领域本发明属于数字图像处理在农业遥感领域的应用领域，具体涉及一种基于数字地形模型精准识别农田洼地特征的方法。背景技术近年来，自然灾害频发，导致农田损毁，出现洼地特征，不利于农业生产:372-385.)。洼地特征表征为四周高、中间低的封闭地势。农田洼地特征与经典地貌学中的山谷相似，指包含一个或多个高程极小值点的局部区域。农田中的洼地特征易造成积水，影响灌溉效率。精准识别农田洼地特征是土地复垦和建设高标准农田不可或缺的一个环节。传统土地平整忽视了农田洼地特征的结构尺寸和地理位置，易造成平整地机具空载率偏高，作业效率低下:21-29.)。近年来，数字地形模型技术快速发展，在获取农田微地形信息方面得到了广泛应用。DTM不仅是地表形态的数字化表达形式，还是分析地形特征的重要工具:012036.)。基于数字地形模型提取地形特征包括地形几何法、水文模拟法、图像处理法。其中，地形几何法利用DTM网格水平及竖直方向的凹凸性判定地形特征，但无法消除DTM空间分辨率变化对提取结果的影响。水文模拟法与图像处理法分别通过人为确定分析窗口尺度与提取阈值，精度均受人为主观因素的影响。为提高农田洼地特征的提取精度与可靠度，本发明获取无人机遥感图像，建立厘米级高精度农田DTM，并基于农田DTM提供一种精准识别农田洼地特征的方法，可为提取农田微地形特征提供技术支持与土地复垦提供理论数据。发明内容本发明为解决上述问题，提出了一种基于数字地形模型精准识别农田洼地特征的方法，本发明基于无人机遥感图像建立高精度农田DTM，在此基础上精准识别农田洼地特征。本发明通过以下技术方案来实现：一种基于数字地形模型精准识别农田洼地特征的方法，包括以下步骤：步骤一、采用搭载高像素航拍相机的测绘无人机，进行航拍测绘作业获取航片，基于运动恢复结构技术，获取厘米级高精度农田数字地形模型DTM；步骤二、利用3×3像素窗口对步骤一得到的DTM进行均值滤波处理；步骤三、将滤波处理后的DTM平均高程作为水平面基准，经反向翻转建立反转地形模型RDTM，RDTM与DTM存在反转对称关系；步骤四、设定分析窗口尺度的初值为10×10像素，步长为10像素，终值为100×100像素，统计各分析窗口尺度下的高程方差，分析高程方差随窗口尺度的变化规律，确定高程方差取极值时的窗口尺度为y，设×像素为窗口x，×像素为窗口z；步骤五、在z分析窗口下获取RDTM极大值栅格数据，并提取农田高程极大值点；步骤六、选取高程、地形起伏度和坡度3个地形因子作为高程极大值点的评价指标；步骤七、为了避免主观因素的干扰，采用熵权法确定在各窗口尺度下3个地形因子的权重；步骤八、根据在各窗口下3个地形因子的权重，对高程极大值点进行综合评价，分别计算在各窗口下的地形因子综合隶属度；步骤九、确定各窗口的权重，同时结合各窗口下高程极值点的地形因子综合隶属度，获取多窗口地形因子综合隶属度；步骤十、通过多窗口地形因子综合隶属度确定阈值，提取多窗口地形因子综合隶属度大于该阈值的高程极大值点，即为洼地特征极值点，实现洼地特征的定位；步骤十一、以DTM的空间分辨率为等高距，获取农田等高线图；步骤十二、利用等高线分析法识别农田洼地特征的外形轮廓，即提取洼地特征；步骤十三、向外偏置洼地特征轮廓50cm作为缓冲区，计算各洼地特征及缓冲区域的高程均值，即确定基准面高度；步骤十四、根据洼地特征的基准面高度，计算洼地特征的填方量。进一步的，步骤一中所述无人机采用固定翼、多旋翼以及直升机形式的无人机，无人机的飞行高度根据农田数字地形模型DTM的空间分辨率设定，获取航片时保障航片横向重叠率及纵向重叠率均不小于80％，厘米级高精度农田数字地形模型DTM的空间分辨率不低于5cm。进一步的，步骤三中，RDTM与DTM两者坡度相差180°，原始DTM的高程值极小点表现为RDTM的高程值极大点。进一步的，步骤五中，高程极大值点的提取方法为：与RDTM数据进行空间求差运算得差值栅格数据，将差值栅格数据进行二值化重分类，即将值为0的栅格赋值为1，而将其余栅格赋值为0，提取值为1的栅格，即高程极大值点。进一步的，步骤六中，使用归一化公式对3个地形因子进行归一化处理；其中，fijk为地形因子归一化值，i为地形因子序号，分别代表高程、地形起伏度和坡度，j为高程极值点序号，k为窗口尺度，max、min分别为在窗口尺度k下各地形因子的最大值和最小值，xijk为在窗口尺度k下第j个高程极值点的值。进一步的，步骤七中，熵权法的具体步骤为：根据公式计算在窗口尺度z下第j个高程极值点的各地形因子的比重；利用公式确定在窗口尺度z下各地形因子的熵值；通过公式确定3个地形因子在窗口尺度z下的权重；重复上述方法获取在x窗口和y窗口下的高程、坡度及地形起伏度的权重。进一步的，步骤八中，利用公式对高程极大值点进行综合评价，其中，/＞为在窗口尺度k下地形因子对各农田高程极值点的地形因子综合隶属度。进一步的，步骤九中，各窗口的权重利用线性加权公式得出，其中，γk为分析窗口的权重，k1、k2、k3分别为x，y，z分析窗口尺寸；使用公式获取多窗口地形因子综合隶属度，其中，ψjk为多窗口综合地形因子综合隶属度。进一步的，步骤十中，确定阈值的具体方法为：计算多窗口地形因子综合隶属度的分级组数和分级组距，并分析高程极值点的数量随多窗口地形因子综合隶属度的变化规律，确定高程极值点数量急剧减小时的多窗口地形因子综合隶属度的值为阈值；其中利用斯特吉斯公式n＝1+log10C/log102和公式，分别计算多窗口地形因子综合隶属度的分级组数和分级组距，其中，c为高程极值点数量；分别为阈值的最大值和最小值。进一步的，步骤十二中，等高线分析法的具体方法为：将包含洼地特征极值点的闭合等高线作为初始等高线，由内向外搜寻包含各洼地特征极值点的闭合等高线，当闭合等高线内出现未包含洼地特征极值点的闭合等高线时终止搜寻，确定上一条等高线所包围的区域为洼地特征轮廓；步骤十四中，利用公式，计算洼地特征的填方量，其中，V镇为洼地特征的填方量/m3，n为洼地特征包含的栅格数量，Δσi为栅格底面积/m2，Zi为栅格高程/m。本发明的有益效果在于：本发明基于厘米级高精度农田地形图，提出了一种农田洼地特征精准识别方法。该方法结合无人机遥感及图像处理技术，简单高效、测算方便、能够快速获取农田洼地特征的空间位置、数量信息以及填埋土方量，可为农田复垦、土地平整与高标准农田建设提供理论数据和方法借鉴。附图说明图1是本发明方法的流程图；图2是本发明建立的高精度农田数字地形模型；图3是本发明建立的反转高精度农田数字地形模型；图4是本发明的高程极大值点提取图；图5是本发明的洼地特征空间位置图；图6是本发明的等高线图；图7是本发明识别的洼地特征。具体实施方式下面根据附图对本发明实施例中的技术方案进行清楚、完整地描述。实施例1如附图所示，一种基于数字地形模型精准识别农田洼地特征的方法，包括以下步骤：步骤一、采用固定翼、多旋翼以及直升机式的测绘无人机，搭载机械全局快门2000万的像素航拍相机，以80米地面相对高度进行航拍测绘作业，共获取42张航片，航片横向重叠率85％、纵向重叠率80％。基于运动恢复结构技术，获取空间分辨率3cm的DTM，如图2所示；步骤二、利用3×3像素窗口的均值滤波，对DTM进行滤波处理，消除农田DTM中土块、细碎的石块及作物残茬对提取结果的影响；步骤三、以DTM平均高程作为水平面基准，经反向翻转建立反转地形模型，RDTM与DTM存在反转对称关系，两者坡度相差180°，原始DTM的高程值极小点表现为RDTM的高程值极大点，如图3所示；步骤四、设定分析窗口尺度的初值为10×10像素，步长为10像素，终值为100×100像素，统计各分析窗口下的高程方差。分析高程方差随窗口尺度的变化规律，确定高程方差取极小值时的40×40像素为窗口y，则30×30像素及50×50像素分别为窗口x、窗口z；步骤五、在窗口z下提取RDTM中极大高程值栅格数据，与RDTM数据进行空间求差运算得差值栅格数据，对求差获取的栅格图像进行重分类，将差值栅格数据进行二值化重分类，即将值为0的栅格赋值为1，而将其余栅格赋值为0，提取值为1的栅格，共提取309个高程极大值点，如图4所示；步骤六、确定坡度、高程和地形起伏度，作为高程极大值点的参评因子，并使用归一化公式对3个地形因子进行归一化处理，其中，i为地形因子序号，i＝1,2,3分别为高程，地形起伏度和坡度，j为高程极值点序号，j＝1,2,…,309，k＝x、y、z，max、min分别为在窗口尺度k下第i个地形因子的最大值和最小值，xijk为在窗口尺度k下第j个高程极值点在第i个地形因子上的值；步骤七、为了避免主观因素的干扰，采用熵权法确定在各窗口下3个指标的权重，具体地，首先，根据公式计算在窗口尺度k下第j个高程极值点的第i个地形因子的比重，其次，利用公式/＞确定在窗口尺度k下第i个地形因子的熵值，最后，通过公式/＞确定高程、地形起伏度和坡度在z窗口下的权重分别为0.373、0.436和0.191，重复上述方法在x和y窗口下的权重为0.393、0.501和0.206，0379、0.468和0.152；步骤八、根据在各窗口下确定3个地形因子的权重，利用公式对高程极大值点进行综合评价，分别获取在各窗口下的地形因子综合隶属度，其中/＞为在窗口尺度k下地形因子对各农田高程极值点的地形因子综合隶属度；步骤九、通过线性加权公式分别计算3个窗口下的权重为0.252、0.333和0.415，同时结合各窗口的地形因子综合隶属度，使用公式/＞获取多窗口地形因子综合隶属度，其中，γk为局部分析窗口的权重，k1、k2、k3分别为x，y，z分析窗口，ψjk为多窗口综合地形因子综合隶属度；步骤十、利用斯特吉斯公式n＝1+log10C/log102和公式分别计算多窗口地形因子综合隶属度的分级组数为9和分级组距0.071，其中，C为高程极值点数量；/＞分别为阈值的最大值和最小值。分析高程极值点的数量随多窗口地形因子综合隶属度的变化规律，确定高程极值点数量急剧减小时的多窗口地形因子综合隶属度的值为阈值。提取多窗口地形因子综合隶属度大于该阈值的高程极大值点，即为洼地特征极值点，实现9个洼地特征的定位，如图5所示；步骤十一、以DTM的空间分辨率为等高距，获取等高距为3cm的农田等高线图，如图6所示；步骤十二、将包含洼地特征极值点的闭合等高线作为初始等高线，由内向外搜寻包含各洼地特征极值点的闭合等高线。当闭合等高线内出现未包含洼地特征极值点的闭合等高线时终止搜寻，确定上一条等高线所包围的区域为洼地特征轮廓，即提取洼地特征，如图7所示；步骤十三、向外偏置洼地特征轮廓50cm作为缓冲区，计算各洼地特征及缓冲区域的高程均值，即确定基准面高度；步骤十四、根据各洼地特征的基准面高度，利用公式计算土方量，重复上述方法，获取各洼地特征的土方量，其中，V填为洼地特征的填方量/m3，n为洼地特征包含的栅格数量，Δσi为栅格底面积/m2，Zi为栅格高程/m。以上显示和描述了本发明的基本原理、主要特征和优点，本行业的技术人员应该了解，本发明不受上述实施例的限制，上述实施例和说明书中描述的只是说明本发明的原理，在不脱离本发明精神和范围的前提下，本发明还会有各种变化和改进，这些变化和改进都落入要求保护的本发明范围内，本发明要求保护范围由所附的权利要求书及其等效物界定。
