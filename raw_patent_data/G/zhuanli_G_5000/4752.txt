标题title
基于贝叶斯数据融合脑电ERS_ERD的分析方法
摘要abst
本发明提供了一种基于贝叶斯数据融合脑电ERS_ERD的分析方法，S1，通过脑电实验流程被试操作的任务及任务的试验次数，招募被试完成实验任务，获取脑电波信号数据；­S2，对获取到的脑电波信号数据通过脑电预处理的python工具库MNE进行预处理；通过运用贝叶斯数据融合的算法对多个导联上的采样值进行融合，将ERS_ERD振荡的采样范围从单一导联扩展到附近脑区的多处导联，从而提高了采样信息的利用率，同时通过在移动平均平滑处理中加入平滑度的计算，解决了EWMA指数加权移动平均算法中权重系数存在的平稳性与时效性之间的矛盾，能够在保证EWMA预测序列平稳性的基础上，让EWMA预测序列对数据的实际变动更加敏感，减少了一般平滑处理中存在的时延问题。
权利要求书clms
1.一种基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，所述方法包括以下步骤：S1，通过脑电实验流程被试操作的任务及任务的试验次数，招募被试完成实验任务，获取脑电波信号数据；S2，对获取到的脑电波信号数据通过脑电预处理的python工具库MNE进行预处理；S3，通过在脑电波信号数据中选择出现ERS_ERD现象的脑波频段，并确定该频段对应的导联并对预处理的脑电波信号数据进行带通滤波；S4，对滤波后脑电波信号数据中的每个采样值取平方，获得对应的功率采样值；S5，通过贝叶斯的数据融合算法将各个导联在相同时间位置的功率采样值进行数据融合后得到带加权的功率采样值；S6，通过EWMA指数加权移动平均算法，对获得的加权功率采样值序列进行数据平滑处理；S7，通过选择脑电ERS_ERD分析参考时间段，以该时间段为基准，计算功率值上升或下降的百分比。2.根据权利要求1所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，在所述步骤S1中，所述脑电波信号数据的采样率为λHz；所述脑电波信号数据包括M个trial，即M次试验；且在每次试验中，每个脑电导联都有N个采样值。3.根据权利要求2所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，在所述步骤S2中，所述预处理包括进行定位通道位置、设置通道类型、滤波与去伪迹。4.根据权利要求3所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，在所述步骤S3中，选择的所述脑波频段为Hz～Hz，且该频段对应的导联数目为P，所述为低通滤波的参数，所述为高通滤波的参数。5.根据权利要求4所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，在所述步骤S4中，滤波后脑电波信号数据中的采样值为：，其中表示第i次试验中在第j个导联上的第k个功率采样值，表示经过滤波的第i次试验中在第j个导联上的第k个采样值，M为试验次数，P为导联个数，N为功率采样值个数。6.根据权利要求5所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，所述步骤S5包括以下子步骤，S51，将采样值汇总得到第j个导联上的第个功率采样值集合={| 1≤i≤M} ，其中表示全部M次试验中第j个导联上的第个功率采样值所组成的数集；S52，通过计算任意两个导联第个导联和第个导联，，之间采样数据的置信距离和，其中 ；  式中，和是条件概率；其中，，；其中，，；S53，通过计算置信距离矩阵，其中；确定合适的临界值α，将置信距离矩阵转化为关系布尔矩阵；S54，筛选出个采样数值有效的导联，对它们的采样数值进行融合，计算，，最终的融合结果为：其中1≤≤N；S55，确定合适的阈值，对于一处导联的采样，当它被多于个导联的采样支持时认为该导联的采样数值有效，重复执行步骤S52~S54，总共N次，得到，，，…，，对应N个采样时刻的加权功率采样值，记加权功率采样集合为。7.根据权利要求6所述的脑电ERS_ERD的分析方法，其特征在于，所述步骤S6包括以下子步骤，S61，通过EWMA指数加权移动平均算法对集合进行数据平滑处理得到：，, 2≤k≤N其中为对第k次采样的平滑值，为第k次的加权功率采样值， 是EWMA对于加权功率采样值的权重系数，其初始值设为；S62，通过设定，并定义动态数据序列为：并根据以下公式计算数据序列的平均平滑度：；S63，若＜0.8，调整的值，重新计算，直至数据序列的平均平滑度≥0.8；若≥0.8，保留数据序列中的所有EWMA预测值；S64，以为起始值，为步长更新动态数据序列，重复执行步骤S62~S63，直至获得调整后的N个EWMA预测值，，…，，，获得最终的功率集合。8.根据权利要求7所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，所述步骤S7包括以子下步骤：S71，将所选参考时间段记为，计算参考时间段reference平均能量：。9.根据权利要求8所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法，其特征在于，所述步骤S7包括以子下步骤：S72，计算功率值相对于参考时间段reference的上升/下降百分比：。
说明书desc
技术领域本发明涉及计算机应用技术领域，更具体地说，涉及一种基于贝叶斯数据融合脑电ERS_ERD的分析方法。背景技术随着用户体验度量在各行各业的普及，用户研究员寻求更加客观的用户体验度量方法，新兴的神经营销研究就是代表。其中脑电信号中delta频段、alpha频段、theta频段、gamma频段的振荡可以反映用户使用电子产品的体验，也可以反映消费者的购物旅程体验。脑电信号的振荡的隐藏了许多内隐信息，合理利用这些信息，将会为评估认知体验和情感体验带来帮助。现有技术中有关脑电信号的振荡的分析，往往采用ERS_ERD  分析方法，它作为最经典的脑电分析方法之一，已得到广泛的实践。经典的ERS_ERD分析流程包括：对原始脑电信号进行带通滤波；计算滤波后的脑电信号每个样本点的平方；对功率采样点做叠加平均；移动平均处理平滑采样值；计算ERS_ERD百分比。但是，该流程的不足之处在于：只能获得单一导联的ERS_ERD振荡情况，而特定频段的脑波ERS_ERD振荡往往分布于特定脑区的多个导联；移动平均处理算法存在平稳性和时效性的矛盾。发明内容本发明要解决的技术问题在于，针对上述技术方案存在的不足，提供基于贝叶斯数据融合脑电ERS_ERD的分析方法能够提升分析的适用性与准确性。本发明提供一种基于贝叶斯数据融合脑电ERS_ERD的分析方法，所述方法包括以下步骤：S1，通过脑电实验流程被试操作的任务及任务的试验次数，招募被试完成实验任务，获取脑电波信号数据；S2，对获取到的脑电波信号数据通过脑电预处理的python工具库MNE进行预处理；S3，通过在脑电波信号数据中选择出现ERS_ERD现象的脑波频段，并确定该频段对应的导联并对预处理的脑电波信号数据进行带通滤波；S4，对滤波后脑电波信号数据中的每个采样值取平方，获得对应的功率采样值；S5，通过贝叶斯的数据融合算法将各个导联在相同时间位置的功率采样值进行数据融合后得到带加权的功率采样值；S6，通过EWMA指数加权移动平均算法，对获得的加权功率采样值序列进行数据平滑处理；S7，通过选择脑电ERS_ERD分析参考时间段，以该时间段为基准，计算功率值上升或下降的百分比。在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，在所述步骤S1中，所述脑电波信号数据的采样率为λHz；所述脑电波信号数据包括M个trial，即M次试验；且在每次试验中，每个脑电导联都有N个采样值。在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，在所述步骤S2中，所述预处理包括进行定位通道位置、设置通道类型、滤波与去伪迹。在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，在所述步骤S3中，选择的所述脑波频段为Hz～Hz，且该频段对应的导联数目为P，所述为低通滤波的参数，所述为高通滤波的参数。在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，在所述步骤S4中，滤波后脑电波信号数据中的采样值为：，其中表示第i次试验中在第j个导联上的第k个功率采样值，表示经过滤波的第i次试验中在第j个导联上的第k个采样值，M为试验次数，P为导联个数，N为功率采样值个数。在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，所述步骤S5包括以下子步骤，S51，将采样值汇总得到第j个导联上的第个功率采样值集合={| 1≤i≤M} ，其中表示全部M次试验中第j个导联上的第个功率采样值所组成的数集；S52，通过计算任意两个导联第个导联和第个导联，且，之间采样数据的置信距离和，其中 ；  式中，和是条件概率；其中，，；其中，，；S53，通过计算置信距离矩阵，其中；确定合适的临界值α，将置信距离矩阵转化为关系布尔矩阵；S54，筛选出个采样数值有效的导联，对它们的采样数值进行融合，计算，，最终的融合结果为：其中1≤≤N；S55，确定合适的阈值，对于一处导联的采样，当它被多于个导联的采样支持时认为该导联的采样数值有效，重复执行步骤S52~S54，总共N次，得到，，，…，，对应N个采样时刻的加权功率采样值，记加权功率采样集合为；在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，所述步骤S6包括以下子步骤，S61，通过EWMA指数加权移动平均算法对集合进行数据平滑处理得到：，, 2≤k≤N其中为对第k次采样的平滑值，为第k次的加权功率采样值， 是EWMA对于加权功率采样值的权重系数，其初始值设为；S62，通过设定，并定义动态数据序列为：并根据以下公式计算数据序列的平均平滑度：；S63，若＜0.8，调整的值，重新计算，直至数据序列的平均平滑度≥0.8；若≥0.8，保留数据序列中的所有EWMA预测值；S64，以为起始值，为步长更新动态数据序列，重复执行步骤S62~S63，直至获得调整后的N个EWMA预测值，，…，，，获得最终的功率集合。在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，其特征在于，所述步骤S7包括以子下步骤：S71，将所选参考时间段记为，计算参考时间段reference平均能量：。在本发明所述的基于贝叶斯数据融合脑电ERS_ERD的分析方法中，所述步骤S7包括以子下步骤：S72，计算功率值相对于参考时间段reference的上升/下降百分比：。本发明的基于贝叶斯数据融合脑电ERS_ERD的分析方法通过运用贝叶斯数据融合的算法对多个导联上的采样值进行融合，将ERS_ERD振荡的采样范围从单一导联扩展到附近脑区的多处导联，从而提高了采样信息的利用率，同时通过在移动平均平滑处理中加入平滑度的计算，解决了EWMA指数加权移动平均算法中权重系数存在的平稳性与时效性之间的矛盾，能够在保证EWMA预测序列平稳性的基础上，让EWMA预测序列对数据的实际变动更加敏感，减少了一般平滑处理中存在的“时延”问题。附图说明图1是本发明基于贝叶斯数据融合脑电ERS_ERD的分析方法实施例的流程示意图；图2是本发明参考的脑波各频段ERS_ERD现象与导联的对应关系。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。如图1-2所示，是本发明基于贝叶斯数据融合脑电ERS_ERD的分析方法实施例的流程示意图。提供一种基于贝叶斯数据融合脑电ERS_ERD的分析方法，包括以下步骤：在步骤S1中，通过脑电实验流程被试操作的任务及任务的试验次数，招募被试完成实验任务，获取脑电波信号数据；在步骤S2中，对获取到的脑电波信号数据通过脑电预处理的python工具库MNE进行预处理；在步骤S3中，通过在脑电波信号数据中选择出现ERS_ERD现象的脑波频段，并确定该频段对应的导联并对预处理的脑电波信号数据进行带通滤波；在步骤S4中，对滤波后脑电波信号数据中的每个采样值取平方，获得对应的功率采样值；在步骤S5中，通过贝叶斯的数据融合算法将各个导联在相同时间位置的功率采样值进行数据融合后得到带加权的功率采样值；在步骤S6中，通过EWMA指数加权移动平均算法，对获得的加权功率采样值序列进行数据平滑处理；在步骤S7中，通过选择脑电ERS_ERD分析参考时间段，以该时间段为基准，计算功率值上升或下降的百分比。在一实施例中，在步骤S1中，所述脑电波信号数据的采样率为λHz；脑电波信号数据包括M个trial，即M次试验；且在每次试验中，每个脑电导联都有N个采样值。在一实施例中，在步骤S2中，预处理包括进行定位通道位置、设置通道类型、滤波与去伪迹。在一实施例中，在步骤S3中，选择的脑波频段为Hz～Hz，且该频段对应的导联数目为P，为低通滤波的参数，为高通滤波的参数。在一实施例中，在步骤S4中，滤波后中的采样值为：，其中表示第i次试验中在第j个导联上的第k个功率采样值，表示经过滤波的第i次试验中在第j个导联上的第k个采样值，M为试验次数，P为导联个数，N为功率采样值个数。在一实施例中，步骤S5包括以下子步骤，S51，定义关于第j个导联上的第个功率采样值集合={| 1≤i≤M} ，其中表示全部M次试验中第j个导联上的第个功率采样值所组成的数集；S52，通过计算任意两个导联第个导联和第个导联，且，之间采样数据的置信距离和，其中 ；  式中，和是条件概率；其中，，;其中，，；S53，通过计算置信距离矩阵，其中；确定合适的临界值α，将置信距离矩阵转化为关系布尔矩阵；S54，筛选出个采样数值有效的导联，对它们的采样数值进行融合，计算，，最终的融合结果为：其中1≤≤N；S55，确定合适的阈值，对于一处导联的采样，当它被多于个导联的采样支持时认为该导联的采样数值有效，重复执行步骤S52~S54，总共N次，得到，，，…，，对应N个采样时刻的加权功率采样值，记加权功率采样集合为；在一实施例中，步骤S6包括以下子步骤，S61，通过EWMA指数加权移动平均算法对集合进行数据平滑处理得到：，, 2≤k≤N其中为对第k次采样的平滑值，为第k次的加权功率采样值， 是EWMA对于加权功率采样值的权重系数，其初始值设为；S62，通过设定，并定义动态数据序列为：并根据以下公式计算数据序列的平均平滑度：；S63，若＜0.8，调整的值，重新计算，直至数据序列的平均平滑度≥0.8；若≥0.8，保留数据序列中的所有EWMA预测值；S64，为起始值，，重复执行步骤S62~S63，直至获得调整后的N个EWMA预测值，，…，，，获得最终的功率集合。在一实施例中，步骤S7包括以子下步骤：S71，将所选参考时间段记为，计算参考时间段reference平均能量：。在一实施例中，步骤S7包括以子下步骤：S72，计算功率值相对于参考时间段reference的上升/下降百分比：,1≤k≤N。需要说明的是，对于前述的各方法实施例，为了简单描述，故将其都表述为一系列的动作组合，但是本领域技术人员应该知悉，本发明并不受所描述的动作顺序的限制，因为依据本发明，某些步骤可以采用其他顺序或者同时进行。其次，本领域技术人员也应该知悉，说明书中所描述的实施例均属于优选实施例，所涉及的动作和模块并不一定是本发明所必须的。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到根据上述实施例的方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台终端设备执行本发明各个实施例所述的方法。因此，以上所述，仅为本发明较佳的具体实施方式，本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内，本发明的保护范围应该以权利要求的保护范围为准。
