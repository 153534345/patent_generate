标题title
小动物磁粒子成像和荧光分子断层成像多模态成像系统
摘要abst
本发明属于医学成像与检测技术领域，具体涉及一种小动物磁粒子成像和荧光分子断层成像多模态成像系统及，旨在解决现有磁纳米粒子成像分辨率不足，荧光分子成像视野不足，导致图像重建精度较低的问题。本发明装置包括：图像处理模块、显示模块、控制模块、置物平台、梯度线圈、驱动线圈、接收线圈、荧光相机、光源模块；梯度线圈，包括第一圆角矩形线圈和第二圆角矩形线圈；驱动线圈，包括第三圆角矩形线圈、第四圆角矩形线圈、第五圆角矩形线圈；接收线圈为圆形线圈。本发明可同时获取磁纳米粒子浓度分布和荧光分子分布图像，实现“功能‑分子‑结构”成像信息的快速融合可视化，进而提升了图像重建的精度。
权利要求书clms
1.一种小动物磁粒子成像和荧光分子断层成像多模态成像系统，包括图像处理模块、显示模块、控制模块、置物平台，其特征在于，该系统还包括：梯度线圈、驱动线圈、接收线圈、荧光相机、光源模块；所述梯度线圈，包括第一圆角矩形线圈和第二圆角矩形线圈；所述第一圆角矩形线圈、所述第二圆角矩形线圈位于同一水平面，并将该水平面作为第一水平面；所述第一圆角矩形线圈、所述第二圆角矩形线圈长边相对、短边齐平、轴线方向平行且对称分布于所述置物平台中心的纵轴线的两侧；所述梯度线圈，用于构建静态磁场自由线，使磁场自由线周围的磁粒子达到饱和，在空间中形成梯度磁场；所述驱动线圈，包括第三圆角矩形线圈、第四圆角矩形线圈、第五圆角矩形线圈；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈位于同一水平面，并将该水平面作为第二水平面；所述第二水平面与所述第一水平面平行；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈长边彼此平行、短边齐平；所述第三圆角矩形线圈的中心与所述置物平台的中心位于同一纵轴线上；所述第四圆角矩形线圈、所述第五圆角矩形线圈位于所述第三圆角矩形线圈的两侧，且到所述第三圆角矩形线圈的间距相同；所述驱动线圈，用于抵消梯度线圈磁场，控制磁场自由线产生平移运动；所述接收线圈为圆形线圈，设置于所述置物平台的正下方、所述梯度线圈上方；所述接收线圈，用于采集磁粒子的非线性响应信号；所述荧光相机，设置于所述置物平台的正上方；所述荧光相机，用于对放置于所述置物平台上的目标对象进行实时成像；所述光源模块，固定于所述荧光相机的荧光镜头的外周；所述光源模块，用于控制所述荧光相机的成像模式；所述图像处理模块，配置为对所述荧光相机实时成像的图像进行处理，作为第一图像；对所述接收线圈接收的非线性响应信号进行处理与重建，将重建后的图像作为第二图像；将所述第一图像、所述第二图像进行融合，作为最终获取的成像结果。2.根据权利要求1所述的小动物磁粒子成像和荧光分子断层成像多模态成像系统，其特征在于，所述小动物磁粒子成像和荧光分子断层成像多模态成像系统以所述置物平台中心的纵轴线的方向为 方向，以所述置物平台中心的纵轴线的左右方向为/＞方向。3.根据权利要求2所述的小动物磁粒子成像和荧光分子断层成像多模态成像系统，其特征在于，所述荧光采集模块与所述置物平台的中心位于同一垂线；所述光源模块为环形光源，包括白光光源、荧光光源成像集成模式。4.根据权利要求2所述的小动物磁粒子成像和荧光分子断层成像多模态成像系统，其特征在于，所述置物平台，可实现方向的升降、旋转。5.根据权利要求2所述的小动物磁粒子成像和荧光分子断层成像多模态成像系统，其特征在于，所述梯度线圈构建静态磁场自由线，其方法为：对所述第一圆角矩形线圈与所述第二矩形线圈施加大小相等方向相反的电流。6.一种小动物磁粒子成像和荧光分子断层成像多模态成像方法，基于权利要求1-5任一项所述的小动物磁粒子成像和荧光分子断层成像多模态成像系统，其特征在于，该方法包括：步骤S100，将待成像的目标对象固定于所述置物平台，并将磁纳米和光学多模探针注射到待成像的目标对象体内；步骤S200，对所述梯度线圈通入电流，生成静态磁场自由线；步骤S300，对所述驱动线圈施加高频激励电流，改变梯度线圈与驱动线圈之间的电流比例，控制磁场自由线在空间中的平移旋转，对所述置物平台上待成像的目标对象进行扫描成像；步骤S400，解码所述接收线圈接收的非线性响应信号并进行重建，得到包含不同深度位置粒子浓度信息的MPI断层图像；步骤S500，荧光相机将采集的原始荧光信号与预先采集背景信号灰度值相减得到目标对象表面的荧光图像；对所述目标对象表面的荧光图像进行增强、去噪预处理，得到预处理的荧光图像；步骤S600，提取所述MPI断层图像中磁粒子位置以及该位置处磁粒子的浓度信息，基于固定的配准参考点，将MPI图像配准到CT三维网格空间中，作为荧光断层重建先验域；在荧光断层重建先验域中，使用预处理的荧光图像进行荧光分子断层重建，得到待成像的目标对象体内病灶区域的三维结构荧光分布；步骤S700，将所述MPI断层图像中磁粒子的浓度信息赋予在所述三维结构荧光分布的网格节点上，得到包含荧光三维分布、磁粒子浓度信息以及三维结构的图像融合结果。7.根据权利要求6所述的小动物磁粒子成像和荧光分子断层成像多模态成像方法，其特征在于，对所述目标对象表面的荧光图像进行增强去噪预处理，得到预处理的荧光图像，其方法为：采用分段线性灰度变换法对所述目标对象表面的荧光图像进行图像增强，并采用双边高斯滤波方法进行去噪，进而得到高对比度的荧光图像，即预处理的荧光图像。8.根据权利要求6所述的小动物磁粒子成像和荧光分子断层成像多模态成像方法，其特征在于，待成像的目标对象体内病灶区域的三维结构荧光分布，其获取方法为：构建荧光分子断层重建模型并进行逆向求解，逆向求解表示为：；其中，/＞表示前向系统矩阵，/＞表示所求的荧光分子分布，/＞ 表示表面荧光信号；将逆向求解问题转化为最小二乘问题：/＞；其中，/＞表示优化函数；由于系统矩阵  具有病态性与不适定性，在求解最小二乘问题时，添加L1范数约束：；其中，/＞ 表示正则化参数；对添加L1范数约束后的最小二乘问题，采用斜投影匹配追踪方法进行求解，进而得到待成像的目标对象体内病灶区域的三维结构荧光分布。9.根据权利要求6所述的小动物磁粒子成像和荧光分子断层成像多模态成像方法，其特征在于，对添加L1范数约束后的最小二乘问题，采用斜投影匹配追踪方法进行求解，进而得到待成像的目标对象体内病灶区域的三维结构荧光分布，其方法为：在预选过程中，选取强度大于设定强度阈值的荧光信号中的节点，并增入预构建的预选集/＞，计算所述预选集中各节点斜投影的投影算子和补投影算子；其中，斜投影算子和补投影算子表示为：；/＞；其中，/＞为预选集/＞在A中对应的列，/＞表示/＞的伪逆，/＞表示span上的投影算子，即斜投影算子，/＞表示在span正交补空间上的投影算子，即补投影算子，/＞表示单位矩阵；循环迭代的过程：计算系统矩阵A中剩余列与上一次迭代残差之间相关性最强的列，将选中的列的编号加入支撑集T；其中，相关性通过两者的内积来计算；支撑集由系统矩阵中部分符合条件的列元素组成，在首次迭代前支撑集设为空矩阵；基于支撑集计算临时解X和残差：/＞；/＞；其中，/＞表示当前迭代前支撑集对应系统矩阵A中的原子的展开；当满足迭代停止条件：当前迭代的残差小于预设阈值/＞，退出迭代；输出当前迭代的临时解与支撑集。/＞
说明书desc
技术领域本发明属于医学成像与检测技术领域，具体涉及一种小动物磁粒子成像和荧光分子断层成像多模态成像系统及方法。背景技术在临床检测与诊断中，如何精准实现目标病灶的在体高灵敏高分辨成像与定位一直是国际上的研究热点与挑战性问题。磁粒子成像技术是一种全新的基于示踪剂的成像方式，它根据对人体无害的超顺磁氧化铁纳米颗粒对磁场的非线性磁化响应响应，通过重建粒子的空间浓度分布，对检测目标进行精准定位，是一种不受成像深度限制的三维成像技术。此外，MPI没有任何有害辐射，信号强度与示踪剂的浓度存在直接关系，所以可以定量磁粒子中的铁含量，且无背景信号的干扰。目前，该技术开始应用于细胞跟踪、血管造影以及炎症成像等基础研究领域，在医学应用方面具有巨大潜力。但MPI成像无法显示被测对象的解剖结构，分辨率较低，难以观测到小于亚毫米级的病灶，如微小肿瘤、病变组织等。而现有的荧光成像依靠荧光探针标记技术跟踪生物组织和细胞中的分子和蛋白变化，荧光成像结果包含组织解剖结构信息，具有成像效果直观、分辨率高等优势。荧光分子断层成像重建可获得荧光分子在三维空间的分布情况。其缺陷在于受限于组织散射效应，且无法准确反映分子定量信息。两者在优劣上的互补与融合有助于实现高分辨率高灵敏的病灶三维信息可视化。发明内容为了解决现有技术中的上述问题，即为了解决现有磁纳米粒子成像分辨率不足，荧光分子成像视野不足，导致图像重建精度较低的问题，本发明提出了一种小动物磁粒子成像和荧光分子断层成像多模态成像系统，包括图像处理模块、显示模块、控制模块、置物平台，该装置还包括：梯度线圈、驱动线圈、接收线圈、荧光相机、光源模块；所述梯度线圈，包括第一圆角矩形线圈和第二圆角矩形线圈；所述第一圆角矩形线圈、所述第二圆角矩形线圈位于同一水平面，并将该水平面作为第一水平面；所述第一圆角矩形线圈、所述第二圆角矩形线圈长边相对、短边齐平、轴线方向平行且对称分布于所述置物平台中心的纵轴线的两侧；所述梯度线圈，用于构建静态磁场自由线，使磁场自由线周围的磁粒子达到饱和，在空间中形成梯度磁场；所述驱动线圈，包括第三圆角矩形线圈、第四圆角矩形线圈、第五圆角矩形线圈；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈位于同一水平面，并将该水平面作为第二水平面；所述第二水平面与所述第一水平面平行；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈长边彼此平行、短边齐平；所述第三圆角矩形线圈的中心与所述置物平台的中心位于同一纵轴线上；所述第四圆角矩形线圈、所述第五圆角矩形线圈位于所述第三圆角矩形线圈的两侧，且到所述第三圆角矩形线圈的间距相同；所述驱动线圈，用于抵消梯度线圈磁场，控制磁场自由线产生平移运动；所述接收线圈为圆形线圈，设置于所述置物平台的正下方、所述梯度线圈上方；所述接收线圈，用于采集磁粒子的非线性响应信号；所述荧光相机，设置于所述置物平台的正上方；所述荧光相机，用于对放置于所述置物平台上的目标对象进行实时成像；所述光源模块，固定于所述荧光相机的荧光镜头的外周；所述光源模块，用于控制所述荧光相机的成像模式；所述图像处理模块，配置为对所述荧光相机实时成像的图像进行处理，作为第一图像；对所述接收线圈接收的非线性响应信号进行处理与重建，将重建后的图像作为第二图像；将所述第一图像、所述第二图像进行融合，作为最终获取的成像结果。在一些优选的实施方式中，所述小动物磁粒子成像和荧光分子断层成像多模态成像系统以所述置物平台中心的纵轴线的方向为方向，以所述置物平台中心的纵轴线的左右方向为/＞方向。在一些优选的实施方式中，所述荧光采集模块与所述置物平台的中心位于同一垂线；所述光源模块为环形光源，包括白光光源、荧光光源成像集成模式。所述置物平台，可实现方向的升降、旋转。在一些优选的实施方式中，所述梯度线圈构建静态磁场自由线，其方法为：对所述第一圆角矩形线圈与所述第二矩形线圈施加大小相等方向相反的电流。本发明的第二方面，提出了一种小动物磁粒子成像和荧光分子断层成像多模态成像方法，基于上述的小动物磁粒子成像和荧光分子断层成像多模态成像系统，该方法包括：步骤S100，将待成像的目标对象固定于所述置物平台，并将磁纳米和光学多模探针注射到待成像的目标对象体内；步骤S200，对所述梯度线圈通入电流，生成静态磁场自由线；步骤S300，对所述驱动线圈施加高频激励电流，改变梯度线圈与驱动线圈之间的电流比例，控制磁场自由线在空间中的平移旋转，对所述置物平台上待成像的目标对象进行扫描成像；步骤S400，解码所述接收线圈接收的非线性响应信号并进行重建，得到包含不同深度位置粒子浓度信息的MPI断层图像；步骤S500，荧光相机将采集的原始荧光信号与预先采集背景信号灰度值相减得到目标对象表面的荧光图像；对所述目标对象表面的荧光图像进行增强、去噪预处理，得到预处理的荧光图像；步骤S600，提取所述MPI断层图像中磁粒子位置以及该位置处磁粒子的浓度信息，基于固定的配准参考点，将MPI图像配准到CT三维网格空间中，作为荧光断层重建先验域；在荧光断层重建先验域中，使用预处理的荧光图像进行荧光分子断层重建，得到待成像的目标对象体内病灶区域的三维结构荧光分布；步骤S700，将所述MPI断层图像中磁粒子的浓度信息赋予在所述三维结构荧光分布的网格节点上，得到包含荧光三维分布、磁粒子浓度信息以及三维结构的图像融合结果。在一些优选的实施方案中，对所述目标对象表面的荧光图像进行增强去噪预处理，得到预处理的荧光图像，其方法为：采用分段线性灰度变换法对所述目标对象表面的荧光图像进行图像增强，并采用双边高斯滤波方法进行去噪，进而得到高对比度的荧光图像，即预处理的荧光图像。在一些优选的实施方式中，待成像的目标对象体内病灶区域的三维结构荧光分布，其获取方法为：构建荧光分子断层重建模型并进行逆向求解，逆向求解表示为：其中， 表示前向系统矩阵，/＞表示所求的荧光分子分布，/＞ 表示表面荧光信号；将逆向求解问题转化为最小二乘问题：其中， 表示优化函数；由于系统矩阵  具有病态性与不适定性，在求解最小二乘问题时，添加L1范数约束：其中， 表示正则化参数；对添加L1范数约束后的最小二乘问题，采用斜投影匹配追踪方法进行求解，进而得到待成像的目标对象体内病灶区域的三维结构荧光分布。在一些优选的实施方式中，对添加L1范数约束后的最小二乘问题，采用斜投影匹配追踪方法进行求解，进而得到待成像的目标对象体内病灶区域的三维结构荧光分布，其方法为：在预选过程中，选取强度大于设定强度阈值的荧光信号中的节点，并增入预构建的预选集/＞，计算所述预选集中各节点斜投影的投影算子和补投影算子；其中，斜投影算子和补投影算子表示为：其中，为预选集 /＞在A中对应的列 /＞表示/＞的伪逆，/＞表示span上的投影算子，即斜投影算子，/＞表示在span正交补空间上的投影算子，即补投影算子，/＞表示单位矩阵；循环迭代的过程：计算系统矩阵A中剩余列与上一次迭代残差之间相关性最强的列，将选中的列的编号加入支撑集T；其中，相关性通过两者的内积来计算；支撑集由系统矩阵中部分符合条件的列元素组成，在首次迭代前支撑集设为空矩阵；基于支撑集计算临时解X和残差：其中，表示当前迭代前支撑集对应系统矩阵A中的原子的展开；当满足迭代停止条件：当前迭代的残差小于预设阈值，退出迭代；输出当前迭代的临时解与支撑集。本发明的有益效果：本发明可同时获取磁纳米粒子浓度分布和荧光分子分布图像，实现“功能-分子-结构”成像信息的快速融合可视化，进而提升了图像重建的精度。本发明可同时获取磁纳米粒子浓度分布和荧光分子图像，一方面为荧光断层成像提供组织深度信息，另一方面为磁纳米粒子成像结果提供解剖结构信息，融合荧光分子断层成像和磁粒子成像的优势，获得检测精度的提升，实现高分辨率高灵敏的病灶三维信息可视化。附图说明通过阅读参照以下附图所做的对非限制性实施例所做的详细描述，本申请的其他特征、目的和优点将会变得更明显。图1 是本发明一种实施例的小动物磁粒子成像和荧光分子断层成像多模态成像系统的框架示意图；图2是本发明一种实施例的小动物磁粒子成像和荧光分子断层成像多模态成像方法的流程示意图；图3是本发明一种实施例的小动物磁粒子成像和荧光分子断层成像多模态成像系统的模块划分示意图；图4是本发明一种实施例的斜投影匹配追踪方法处理过程的简略流程示意图；图5是本发明一种实施例的适于用来实现本申请实施例的电子设备的计算机系统的结构示意图；附图标记说明：11、置物平台；12、梯度线圈；13、驱动线圈；14、接收线圈；15、控制模块；16、荧光相机；17、光源模块；18、图像处理模块；19、显示模块。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。下面结合附图和实施例对本申请作进一步的详细说明。可以理解的是，此处所描述的具体实施例仅仅用于解释相关发明，而非对该发明的限定。需要说明的是，在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。本发明提出了一种小动物磁粒子成像和荧光分子断层成像多模态成像系统，如图1所示，包括图像处理模块、显示模块、控制模块、置物平台，该装置还包括：梯度线圈、驱动线圈、接收线圈、荧光相机、光源模块；所述梯度线圈，包括第一圆角矩形线圈和第二圆角矩形线圈；所述第一圆角矩形线圈、所述第二圆角矩形线圈位于同一水平面，并将该水平面作为第一水平面；所述第一圆角矩形线圈、所述第二圆角矩形线圈长边相对、短边齐平、轴线方向平行且对称分布于所述置物平台中心的纵轴线的两侧；所述梯度线圈，用于构建静态磁场自由线，使磁场自由线周围的磁粒子达到饱和，在空间中形成梯度磁场；所述驱动线圈，包括第三圆角矩形线圈、第四圆角矩形线圈、第五圆角矩形线圈；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈位于同一水平面，并将该水平面作为第二水平面；所述第二水平面与所述第一水平面平行；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈长边彼此平行、短边齐平；所述第三圆角矩形线圈的中心与所述置物平台的中心位于同一纵轴线上；所述第四圆角矩形线圈、所述第五圆角矩形线圈位于所述第三圆角矩形线圈的两侧，且到所述第三圆角矩形线圈的间距相同；所述驱动线圈，用于抵消梯度线圈磁场，控制磁场自由线产生平移运动；所述接收线圈为圆形线圈，设置于所述置物平台的正下方、所述梯度线圈上方；所述接收线圈，用于采集磁粒子的非线性响应信号；所述荧光相机，设置于所述置物平台的正上方；所述荧光相机，用于对放置于所述置物平台上的目标对象进行实时成像；所述光源模块，固定于所述荧光相机的荧光镜头的外周；所述光源模块，用于控制所述荧光相机的成像模式；所述图像处理模块，配置为对所述荧光相机实时成像的图像进行处理，作为第一图像；对所述接收线圈接收的非线性响应信号进行处理与重建，将重建后的图像作为第二图像；将所述第一图像、所述第二图像进行融合，作为最终获取的成像结果。为了更清晰地对本发明一种小动物磁粒子成像和荧光分子断层成像多模态成像系统进行说明，下面结合附图，对本发明系统一种实施例中各模块进行展开详述。本发明一种小动物磁粒子成像和荧光分子断层成像多模态成像系统，如图1所示，该系统包括：置物平台11，为一个圆形平台，用于放置待成像的目标对象；在本发明中，所述小动物磁粒子成像和荧光分子断层成像多模态成像系统以所述置物平台中心的纵轴线的方向为方向，以所述置物平台中心的纵轴线的左右方向为/＞方向，如图1所示。而置物平台可实现/＞方向的升降与旋转。梯度线圈12，包括第一圆角矩形线圈和第二圆角矩形线圈；所述第一圆角矩形线圈、所述第二圆角矩形线圈位于同一水平面，并将该水平面作为第一水平面；所述第一圆角矩形线圈、所述第二圆角矩形线圈长边相对、短边齐平、轴线方向平行且对称分布于所述置物平台中心的纵轴线的两侧；在其他实施例中，梯度线圈中的第一圆角矩形线圈、第二圆角矩形线圈可替换为永磁体组，尤其是小型的MPI系统，其优点是比较小巧且容易搭建，无需考虑散热和功率损耗，易产生梯度磁场，其能显著提高扫描仪的性能。在大型的MPI成像系统中优选电磁线圈，控制比较灵活，能随实验的需求改变磁场的大小，但应考虑及时散热及电压的较高要求。所述梯度线圈，用于构建静态磁场自由线，使磁场自由线周围的磁粒子达到饱和，在空间中形成梯度磁场；具体为：第一圆角矩形线圈与第二圆角矩形线圈中通入大小相等方向相反电流，反向电流产生静态磁场自由线，适应不同应用场景下磁场自由线的基准高度，通过改变反向电流的大小来调整磁场梯度值。驱动线圈13采用激励线圈，包括第三圆角矩形线圈、第四圆角矩形线圈、第五圆角矩形线圈；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈位于同一水平面，并将该水平面作为第二水平面；所述第二水平面与所述第一水平面平行；所述第三圆角矩形线圈、所述第四圆角矩形线圈、所述第五圆角矩形线圈长边彼此平行、短边齐平；所述第三圆角矩形线圈的中心与所述置物平台的中心位于同一纵轴线上；所述第四圆角矩形线圈、所述第五圆角矩形线圈位于所述第三圆角矩形线圈的两侧，且到所述第三圆角矩形线圈的间距相同；所述驱动线圈，用于抵消梯度线圈磁场，控制磁场自由线产生平移运动。具体为：对第三、第四、第五圆角矩形线圈施加不同频率不同方向电流，调节与梯度线圈中电流大小的比例，控制磁场自由线在空间的移动。接收线圈14优选由Litz线缠绕制成为圆形线圈，设置于所述置物平台的正下方、所述梯度线圈上方；所述接收线圈，用于采集磁粒子的非线性响应信号，并发送至图像处理模块；荧光相机16，设置于所述置物平台的正上方，与置物平台位于同一纵轴线，配有荧光镜头调节不同尺寸的目标视野；所述荧光相机，用于对放置于所述置物平台上的目标对象进行实时成像；光源模块17，固定于所述荧光相机的荧光镜头的外周，所述荧光采集模块与所述置物平台的中心位于同一垂线；所述光源模块为环形光源，包括白光光源、荧光光源成像集成模式；所述光源模块，用于控制所述荧光相机的成像模式，采集白光图像与荧光图像；图像处理模块18，配置为对所述荧光相机实时成像的图像进行处理，作为第一图像；对所述接收线圈接收的非线性响应信号进行处理与重建，将重建后的图像作为第二图像；将所述第一图像、所述第二图像进行融合，作为最终获取的成像结果；显示模块19，用于对图像处理模块最终获取的成像结果进行可视化。控制模块15，配置为按照设定的控制命令控制梯度线圈对电流大小和方向的变化、控制驱动线圈之间电流比例的变化，控制置物平台的升降和旋转，实现所产生的磁场自由线的平移旋转和逐层扫描，以实现对待成像的目标对象进行目标区域的扫描成像。需要说明的是，上述实施例提供的小动物磁粒子成像和荧光分子断层成像多模态成像系统，仅以上述各功能模块的划分进行举例说明，在实际应用中，可以根据需要而将上述功能分配由不同的功能模块来完成，即将本发明实施例中的模块或者步骤再分解或者组合，例如，上述实施例的模块可以合并为一个模块，也可以进一步拆分成多个子模块，以完成以上描述的全部或者部分功能。对于本发明实施例中涉及的模块、步骤的名称，仅仅是为了区分各个模块或者步骤，不视为对本发明的不当限定。本发明第二实施例的一种小动物磁粒子成像和荧光分子断层成像多模态成像方法扫描成像的方法），如图2所示，基于上述的小动物磁粒子成像和荧光分子断层成像多模态成像系统；该方法包括：步骤S100，将待成像的目标对象固定于所述置物平台，并将磁纳米和光学多模探针注射到待成像的目标对象体内；在本实施例中，先将待成像的目标对象固定于所述置物平台，保证待成像的目标对象在视野范围内，将磁纳米和光学多模探针注射到目标对象体内。在本发明中优选通过尾静脉注射，目标对象优选为小动物。步骤S200，对所述梯度线圈通入电流，生成静态磁场自由线；在本实施例中，对所述第一圆角矩形线圈、所述第二圆角矩形线圈通入大小相等方向相反的电流，构建梯度磁场，生成静态的磁场自由线。步骤S300，对所述驱动线圈施加高频激励电流，改变梯度线圈与驱动线圈之间的电流比例，控制磁场自由线在空间中的平移旋转，对所述置物平台上待成像的目标对象进行扫描成像；在本实施例中，对驱动线圈施加高频激励电流控制MPI中心为待成像的目标对象的成像区域。对控制梯度线圈与驱动线圈通入不同频率、大小、比例的电流，控制磁场自由线在目标空间中平移与旋转，完成对目标内体磁粒子的激励，对所述置物平台上待成像的目标对象进行扫描成像。步骤S400，解码所述接收线圈接收的非线性响应信号并进行重建，得到包含不同深度位置粒子浓度信息的MPI断层图像；在本实施例中，通过接收线圈采集不同位置磁场自由线内的磁纳米粒子浓度对应的电压信号，然后传输至图像处理模块；对采集到的电压信号进行滤波和放大后，进行图像重建获得MPI断层图像。本发明中优选采用x-space方法进行MPI断层图像重建。骤S500，荧光相机将采集的原始荧光信号与预先采集背景信号灰度值相减得到目标对象表面的荧光图像；对所述目标对象表面的荧光图像进行增强、去噪预处理，得到预处理的荧光图像；在本实施例中，荧光相机可在首次使用时采集背景信号，在采集到原始荧光信号后，相机会自动设置荧光图像减去背景图像，以减小相机热噪声带来的干扰。荧光相机获取待成像的目标对象的表面荧光图像，然后采用分段线性灰度变换法进行图像增强，并采用双边高斯滤波方法进行去噪，获得高对比度的光学图像，即预处理后的荧光图像。步骤S600，提取所述MPI断层图像中磁粒子位置以及该位置处磁粒子的浓度信息，基于固定的配准参考点，将MPI图像配准到CT三维网格空间中，作为荧光断层重建先验域；在荧光断层重建先验域中，使用预处理的荧光图像进行荧光分子断层重建，得到待成像的目标对象体内病灶区域的三维结构荧光分布；在本实施例中，对MPI重建图像中所包含的目标深度信息和SPIOs浓度信息进行提取。基于固定的配准参考点，将MPI图像配准到CT三维网格空间中，作为荧光断层重建先验域；其中，所述配准点为成像空间中的三个固定参考点，其可在荧光模式、MPI模式、CT模式下均被采集到；以深度作为荧光分子断层重建的先验区域，进行荧光分子断层成像重建，获得待成像的目标对象体内病灶区域的三维结构荧光分布。具体为：所述光学三维重建单元用于将MPI图像中的深度信息作为先验知识，利用采集到的二维荧光图像以及CT结构数据重建出目标在体内的三维分布；所述荧光分子断层重建模型逆向求解可以示为，/＞ 表示前向系统矩阵，/＞ 表示所求的荧光分子分布，/＞ 表示表面荧光信号。荧光分子断层重建过程即为，已知/＞ 和/＞ 求/＞的逆问题。该问题可转化为最小二乘问题 /＞。由于系统矩阵/＞ 具有病态性与不适定性，可以添加L1范数约束转化/＞，/＞ 表示正则化参数，/＞表示优化函数。解决上述问题，本发明提出斜投影匹配追踪方法来解决。其中，斜投影匹配追踪方法包含预选过程和迭代过程，如图4所示。在预选过程中，选取测得荧光信号中信号强度较大的若干节点，计算这些节点元素斜投影的投影算子和补投影算子。迭代过程中，依次进行相关性计算，支撑集更新，临时解计算，残差计算。其中残差计算步骤中使用斜投影算子。当满足迭代停止条件时，退出迭代。所述斜投影算子和补投影算子可表示为：其中，为预选集/＞在A中对应的列，/＞表示/＞的伪逆，/＞表示span上的投影算子，即斜投影算子，/＞表示在span正交补空间上的投影算子，即补投影算子，/＞表示单位矩阵。循环迭代的过程：计算系统矩阵A中剩余列与上一次迭代残差之间相关性最强的列，将选中的列的编号加入支撑集T；其中，相关性通过两者的内积来计算；支撑集由系统矩阵中部分符合条件的列元素组成，在首次迭代前支撑集设为空矩阵；基于支撑集计算临时解X和残差： 其中，表示当前迭代前支撑集对应系统矩阵A中的原子的展开；当满足迭代停止条件：当前迭代的残差小于预设阈值，退出迭代；输出当前迭代的临时解与支撑集。步骤S700，将所述MPI断层图像中磁粒子的浓度信息赋予在所述三维结构荧光分布的网格节点上，得到包含荧光三维分布、磁粒子浓度信息以及三维结构的图像融合结果。在本实施例中，将MPI断层图像中包含的粒子浓度信息被赋予在三维结构荧光分布的网格节点上，可以得到包含荧光三维分布、磁粒子浓度信息以及三维结构的图像融合结果。综上所述，步骤S600、步骤S700，用于基于配准参考点，将所述荧光图像与所述MPI图像进行融合配准，基于配准后的荧光图像与MPI图像同时映射到成像目标对象CT三维空间网格，以MPI深度信息作为荧光重建的先验进行荧光分子断层重建，并将粒子浓度相关信息赋予在荧光重建结果的网格节点，得到包含荧光三维分布、磁粒子浓度信息以及三维结构的图像融合结果。另外，基于上述的小动物磁粒子成像和荧光分子断层成像多模态成像方法，可以将小动物磁粒子成像和荧光分子断层成像多模态成像系统模块划分为3大块，如图3所示，磁粒子图像采集模块、荧光图像采集模块和双模融合模块；其中，磁粒子图像采集模块包括磁场自由线生成单元、磁场自由线扫描单元、MPI图像重建单元；所述磁场自由线生成单元，用于对所述梯度线圈通入电流，生成静态磁场自由线；所述磁场自由线扫描单元，用于对所述驱动线圈施加高频激励电流，改变梯度线圈与驱动线圈之间的电流比例，控制磁场自由线在空间中的平移旋转，对所述置物平台上待成像的目标对象进行扫描；所述MPI图像重建单元，用于解码所述接收线圈接收的非线性响应信号并进行重建，得到包含不同深度位置粒子浓度信息的MPI断层图像；荧光图像采集模块包括光源激发单元、光学图像采集单元、光学图像处理单元；所述光源激发单元、所述光学图像采集单元、所述光学图像处理单元，用于荧光相机将采集的原始荧光信号与预先采集背景信号灰度值相减得到目标对象表面的荧光图像；对所述目标对象表面的荧光图像进行增强、去噪预处理，得到预处理的荧光图像；双模融合模块包括MPI信息提取单元、光学三维重建单元、融合显示单元；所述MPI信息提取单元，用于提取所述MPI断层图像中磁粒子位置以及该位置处磁粒子的浓度信息；所述光学三维重建单元，用于基于固定的配准参考点，将MPI图像配准到CT三维网格空间中，作为荧光断层重建先验域；在荧光断层重建先验域中，使用预处理的荧光图像进行荧光分子断层重建，得到待成像的目标对象体内病灶区域的三维结构荧光分布；所述融合显示单元，用于将所述MPI断层图像中磁粒子的浓度信息赋予在所述三维结构荧光分布的网格节点上，得到包含荧光三维分布、磁粒子浓度信息以及三维结构的图像融合结果；所述技术领域的技术人员可以清楚的了解到，为描述的方便和简洁，上述描述的方法的具体的工作过程及有关说明，可以参考前述装置实施例中的对应过程，在此不再赘述。本发明第三实施例的一种电子设备，至少一个处理器；以及与至少一个所述处理器通信连接的存储器；其中，所述存储器存储有可被所述处理器执行的指令，所述指令用于被所述处理器执行以实现上述的小动物磁粒子成像和荧光分子断层成像多模态成像方法。本发明第四实施例的一种计算机可读存储介质，所述计算机可读存储介质存储有计算机指令，所述计算机指令用于被所述计算机执行以实现上述的小动物磁粒子成像和荧光分子断层成像多模态成像方法。所述技术领域的技术人员可以清楚的了解到，为描述的方便和简洁，上述描述的电子设备、计算机可读存储介质的具体工作过程及有关说明，可以参考前述方法实例中的对应过程，在此不再赘述。下面参考图5，其示出了适于用来实现本申请方法、装置实施例的服务器的计算机系统的结构示意图。图5示出的服务器仅仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图5所示，计算机系统包括中央处理单元501，其可以根据存储在只读存储器502中的程序或者从存储部分508加载到随机访问存储器503中的程序而执行各种适当的动作和处理。在RAM 503中，还存储有系统操作所需的各种程序和数据。CPU501、ROM 502以及RAM503通过总线504彼此相连。输入/输出接口505也连接至总线504。以下部件连接至I/O接口505：包括键盘、鼠标等的输入部分506；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分507；包括硬盘等的存储部分508；以及包括诸如LAN卡、调制解调器等的网络接口卡的通讯部分509。通讯部分509经由诸如因特网的网络执行通信处理。驱动器510也根据需要连接至I/O接口505。可拆卸介质511，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器510上，以便于从其上读出的计算机程序根据需要被安装入存储部分508。特别地，根据本发明的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本发明的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通讯部分509从网络上被下载和安装，和/或从可拆卸介质511被安装。在该计算机程序被中央处理单元、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本申请中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、电线、光缆、RF等等，或者上述的任意合适的组合。可以以一种或多种程序设计语言或其组合来编写用于执行本申请的操作的计算机程序代码，上述程序设计语言包括面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，可以连接到外部计算机。附图中的流程图和框图，图示了按照本申请各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，该模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。术语“第一”、 “第二”等是用于区别类似的对象，而不是用于描述或表示特定的顺序或先后次序。术语“包括”或者任何其它类似用语旨在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备/装置不仅包括那些要素，而且还包括没有明确列出的其它要素，或者还包括这些过程、方法、物品或者设备/装置所固有的要素。至此，已经结合附图所示的优选实施方式描述了本发明的技术方案，但是，本领域技术人员容易理解的是，本发明的保护范围显然不局限于这些具体实施方式。在不偏离本发明的原理的前提下，本领域技术人员可以对相关技术特征作出等同的更改或替换，这些更改或替换之后的技术方案都将落入本发明的保护范围之内。
