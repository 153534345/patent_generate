标题title
一种焊缝数据的优化聚类分割方法
摘要abst
本发明涉及数据处理技术领域，具体涉及一种焊缝数据的优化聚类分割方法，该方法包括：获取焊缝图像，距离最短的两个像素点与距离最长的两个像素点确定步长范围；根据步长范围中不同的步长获得对应的聚类结果图像；计算同一簇类中像素点之间的距离，进而获得簇类的纯净程度；根据同一簇类中像素点的像素值计算簇类的紧密度，进而得到聚类效果评价；根据步长范围中不同的步长获得对应的聚类完成的聚类时间，对聚类时间进行归一化处理；根据归一化后的聚类时间与聚类效果评价得到聚类步长评价，根据聚类步长评价获得聚类最优步长，获得最优步长的聚类分割结果。本发明使得焊缝图像的聚类效果更优的同时，聚类速度更快。
权利要求书clms
1.一种焊缝数据的优化聚类分割方法，其特征在于，该方法包括以下步骤：基于X光射线获取焊缝图像，根据焊缝图像中距离最短的两个像素点与距离最长的两个像素点确定步长范围；根据步长范围中不同的步长获得对应的聚类结果图像；将各聚类结果图像转换为LAB颜色图像，根据两个像素点在颜色空间的各个分量对应的差值计算同一簇类中像素点之间的距离，根据同一簇类中像素点之间的距离计算簇类的纯净程度；根据各聚类结果图像中同一簇类内任意两个像素点的像素值之差得到簇类的紧密度，根据紧密度与纯净程度的比值得到簇类的聚类效果评价；根据步长范围中不同的步长获得对应的聚类完成的聚类时间，对聚类时间进行归一化处理；根据归一化后的聚类时间与聚类效果评价得到聚类步长评价，根据聚类步长评价获得聚类最优步长，获得最优步长的聚类分割结果。2.根据权利要求1所述的一种焊缝数据的优化聚类分割方法，其特征在于，所述根据焊缝图像中距离最短的两个像素点与距离最长的两个像素点确定步长范围具体为：将距离最短的两个像素之间灰度值的差值作为最小步长，将距离最长的两个像素之间灰度值的差值作为最大步长，根据最小步长与最大步长得到步长范围。3.根据权利要求1所述的一种焊缝数据的优化聚类分割方法，其特征在于，所述根据两个像素点在颜色空间的各个分量对应的差值计算同一簇类中像素点之间的距离具体为：其中，表示像素点a和像素点b之间的距离，、和分别表示像素点a在颜色空间的各个分量，、和分别表示像素点b在颜色空间的各个分量。4.根据权利要求1所述的一种焊缝数据的优化聚类分割方法，其特征在于，所述簇类的纯净程度的获取方法具体为：其中，P表示簇类的纯净程度，表示第i个距离的取值，n表示该簇类内所有距离的数量，表示该簇类内所有距离集合的标准差。5.根据权利要求1所述的一种焊缝数据的优化聚类分割方法，其特征在于，所述簇类的紧密度的获取方法具体为：其中，C表示簇类的紧密度，表示该簇类内像素点u的像素值，表示该簇类内像素点v的像素值，表示该簇类内簇类中心的像素值，表示该簇类内像素点的总数量。6.根据权利要求1所述的一种焊缝数据的优化聚类分割方法，其特征在于，所述对聚类时间进行归一化处理具体为：其中，T为归一化后的聚类时间，为所有聚类步长完成聚类的时间最大值；为当前聚类步长完成聚类的时间；为所有聚类步长完成聚类的时间最小值。
说明书desc
技术领域本发明涉及数据处理技术领域，具体涉及一种焊缝数据的优化聚类分割方法。背景技术在焊接过程中，因为焊接工艺问题会在焊缝位置产生裂痕，通常是经X射线照射后使用计算机视觉处理捕获图像。聚类算法将图像中相似的像素归为一类，根据聚类的结果分割出图像的不同部位，进行判断细节。现有方法中在对焊缝X光图像进行聚类时，通常使用预设的固定步长进行K均值聚类，其中，K均值聚类的步长为样本点至聚类中心的距离。但是K均值聚类的步长无法进行自适应，步长选取的较不准确，进而可能导致将不同类像素点归为同一类别，导致图像的聚类效果不佳，影响分割的效果。发明内容为了解决上述技术问题，本发明的目的在于提供一种焊缝数据的优化聚类分割方法，所采用的技术方案具体如下：基于X光射线获取焊缝图像，根据焊缝图像中距离最短的两个像素点与距离最长的两个像素点确定步长范围；根据步长范围中不同的步长获得对应的聚类结果图像；将各聚类结果图像转换为LAB颜色图像，根据两个像素点在颜色空间的各个分量对应的差值计算同一簇类中像素点之间的距离，根据同一簇类中像素点之间的距离计算簇类的纯净程度；根据各聚类结果图像中同一簇类内任意两个像素点的像素值之差得到簇类的紧密度，根据紧密度与纯净程度的比值得到簇类的聚类效果评价；根据步长范围中不同的步长获得对应的聚类完成的聚类时间，对聚类时间进行归一化处理；根据归一化后的聚类时间与聚类效果评价得到聚类步长评价，根据聚类步长评价获得聚类最优步长，获得最优步长的聚类分割结果。优选地，所述根据焊缝图像中距离最短的两个像素点与距离最长的两个像素点确定步长范围具体为：将距离最短的两个像素之间灰度值的差值作为最小步长，将距离最长的两个像素之间灰度值的差值作为最大步长，根据最小步长与最大步长得到步长范围。优选地，所述根据两个像素点在颜色空间的各个分量对应的差值计算同一簇类中像素点之间的距离具体为：其中，表示像素点a和像素点b之间的距离，、和分别表示像素点a在颜色空间的各个分量，、和分别表示像素点b在颜色空间的各个分量。优选地，所述簇类的纯净程度的获取方法具体为：其中，P表示簇类的纯净程度，表示第i个距离的取值，n表示该簇类内所有距离的数量，表示该簇类内所有距离集合的标准差。优选地，所述簇类的紧密度的获取方法具体为：其中，C表示簇类的紧密度，表示该簇类内像素点u的像素值，表示该簇类内像素点v的像素值，表示该簇类内簇类中心的像素值，表示该簇类内像素点的总数量。优选地，所述对聚类时间进行归一化处理具体为：其中，T为归一化后的聚类时间，为所有聚类步长完成聚类的时间最大值；为当前聚类步长完成聚类的时间；为所有聚类步长完成聚类的时间最小值。本发明实施例至少具有如下有益效果：本发明通过对不同的聚类步长下的聚类结果进行簇类类别的纯净度和紧密度进行判断，进而能够自适应地获取K均值聚类的步长，使K均值聚类能够对变化的焊缝图像也能自适应的获得聚类步长，达到更好的聚类效果，令根据聚类效果进行的判断精度更高，判断结果更可信。利用该方法获得图像进行聚类的最优步长，使得焊缝图像的聚类效果更优的同时，聚类速度更快。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1是本发明的一种焊缝数据的优化聚类分割方法的方法流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种焊缝数据的优化聚类分割方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种焊缝数据的优化聚类分割方法的具体方案。实施例：本发明的主要目的是：通过聚类的不同步长对焊缝X光图像进行聚类，并根据图像灰度自适应地获取K均值聚类的步长，并得到该图像的聚类最优步长。本发明针对的场景为：因生产流程需要对焊缝图像聚类分割出缺陷位置，而生产线根据预设的聚类步长对图像进行聚类，但因为焊接的母材与焊接人员的工艺水平不同，造成采集的X光图像在聚类时并不完全符合预设的步长，导致聚类的效果较差，聚类速度较慢，最后影响分割的效果。请参阅图1，其示出了本发明一个实施例提供的一种焊缝数据的优化聚类分割方法的方法流程图，该方法包括以下步骤：步骤一，基于X光射线获取焊缝图像，根据焊缝图像中距离最短的两个像素点与距离最长的两个像素点确定步长范围。具体地，采用X光射线对焊缝进行检测获得焊缝图像，由于工件中母料的焊缝缺陷处的材料密度不同，所以X光穿透工件后衰减的强度不同，在图像中呈现出不同的形态。同时，在利用X光获取图像后，需对图像进行滤波去噪等预处理操作。需要说明的是，由于工件上焊缝和缺陷经常不同，固定步长进行聚类时不能很好的符合图像中变化的特征，导致聚类效果不佳，聚类的速度较慢。因此需要根据图像针对性的设计聚类步长评价方法对各个聚类步长进行评价，使聚类步长能够符合不同图像中变化的特征，使图像进行聚类时的聚类效果较好，聚类速度较快。同时，通过设置聚类步长评价方法，便于对不同步长下的聚类效果进行量化评价，便于后续筛选出对该图像进行聚类时最优的步长。在利用不同步长对图像进行聚类时，需要首先确定对图像进行聚类的类别值，便以明确图像的各部分。在本实施例中，焊缝在实际中包含三个部分，即焊接母材，密度较均匀；焊缝中心，熔融后的焊条和母材，密度与母材不同；焊缝缺陷部位，通常为与背景颜色相近的长条、斑点形状。综上，在本实施例中选择的聚类的类别值为3。保证聚类的结果中可以完整包含图像各部位的信息。在部位细节都有类别能被充分表示的情况下，就可以针对不同的步长进行聚类，获取每一次的聚类结果和聚类完成的速度。聚类的步长不合适会导致较小簇类的像素点被遗漏，聚类的步长较大时簇类的像素点检测效率较低。则首先获取聚类时采用的步长范围。获取图像之中距离最短的两个像素之间距离以及图像之中距离最长的两个像素之间距离，由于X光的成像原理，采集的图像为灰度图像，因此距离轴为灰度轴，即分别计算距离最短和距离最长两个像素之间灰度值的差值。具体地，步长范围用公式表示为：式中，为最小步长，为最大步长。最小步长为图像之中距离最短的两个像素之间距离，而由于X光的成像原理，采集的图像为灰度图像，因此距离轴为灰度轴，则距离最短的两个像素之间灰度值的差值为最小步长。最大步长为图像之中距离最长的两个像素之间距离，而由于X光的成像原理，采集的图像为灰度图像，因此距离轴为灰度轴，则距离最长的两个像素之间灰度值的差值为最大步长。至此，获得了聚类的步长范围，通过步长范围可以获得对应的聚类结果图像和聚类完成的时间，以便后续分析聚类结果图像的聚类效果，获得聚类效果评价方法。步骤二，将各聚类结果图像转换为LAB颜色图像，根据两个像素点在颜色空间的各个分量对应的差值计算同一簇类中像素点之间的距离，根据同一簇类中像素点之间的距离计算簇类的纯净程度。需要说明的是，通过聚类的步长范围F，获得了对应的聚类结果图像和聚类完成的时间。接下来需要对不同的步长产生的聚类结果图像进行分析，获得聚类效果评价方法，对不同步长的聚类效果进行量化评价，以便衡量出哪一个步长下的聚类结果最优良。对于聚类结果来说，良好的聚类结果应该是一个簇类中仅含有该标记的像素点；簇类中的像素点足够紧凑，簇类之间的距离足够远。但是对于焊缝的X光图像来说，由于存在的物质类别较少，上述类别值为3，不需要考虑过多的聚类簇类之间的影响，而聚类结果的目的是为了分割缺陷位置，因此需要聚类结果中簇类含有的像素点为统一像素点，体现在图像上为仅包含有缺陷位置的像素点，不会将其他位置的像素点也聚进此类；而且其簇类的密度需要较紧密，体现在图像上为在一较小的范围内缺陷位置像素值较为靠近。由于LAB颜色空间更符合人眼视觉，因此需要对颜色空间进行转化。将上述步骤中获得的不同步长下的聚类结果图像转换为LAB颜色图像。其中，对应图像进行颜色空间的转换为公知技术，在此不再过多介绍。由于待测图中缺陷位置边缘与背景的像素值较接近，因此会有缺陷位置附近的像素也被归入缺陷簇类中。由像素范围来说，相近的像素值需要更小的步长进行聚类，例如两像素的像素值分别为110，120，使用15的步长可能会将两像素点归为一类，使用5的步长可能会将两像素点分为不同类别。因此通过某一步长聚类之后，统计簇类之中各像素点之间的距离，筛选与同簇类中其他像素点相距较大的误差点，通过误差点的数量判断一簇类中仅含有该簇类标签的像素点的纯净程度。通过计算簇类中目标簇类的纯净度，保证了缺陷位置的细节完整性，应防止其他误差位置被识别进缺陷部位的簇类中。具体地，对于一个簇类，计算该簇类内任意两个像素点之间的距离，用公式表示为；其中，表示像素点a和像素点b之间的距离，、和分别表示像素点a在颜色空间的各个分量，、和分别表示像素点b在颜色空间的各个分量。进而获得各簇类内所有像素点之间的距离，纯净程度P筛选的存在误差的像素点为距离方面，即不能存在与大部分像素点之间距离较远的点，即根据同一簇类中像素点之间的距离计算簇类的纯净程度，用公式表示为：其中，P表示簇类的纯净程度，表示第i个距离的取值，n表示该簇类内所有距离的数量，表示该簇类内所有距离集合的标准差。代表同一聚类中任意两点的距离的平均值；代表超过均值三倍标准差的像素点，筛选距离过大的像素点，保证距离过大的像素点不会影响计算结果。因需要筛选距离过大的像素点，而目标缺陷部位的像素点产生的特点为排布范围较限定范围，所以通过该式可以筛选出距离较大的像素点，避免误差干扰聚类的结果，该式结果越大则说明存在误差越严重。步骤三，根据各聚类结果图像中同一簇类内任意两个像素点的像素值之差得到簇类的紧密度，根据紧密度与纯净程度的比值得到簇类的聚类效果评价。需要说明的是，通过纯净度判断了各簇类中不会存在其他误差位置的像素点，但对于缺陷位置来说，其缺陷位置边缘有像素点会被归为一类，通过距离判断难以进行区分，因此需要判断目标簇类的紧密度，将缺陷位置附近的像素点也进行排除，最大限度保证各个簇类中不含有其他部位的像素点。则根据各聚类结果图像中同一簇类内任意两个像素点的像素值之差得到簇类的紧密度，用公式表示为：其中，C表示簇类的紧密度，表示该簇类内像素点u的像素值，表示该簇类内像素点v的像素值，表示该簇类内簇类中心的像素值，表示该簇类内像素点的总数量。表示簇类中任两点的像素值之差的平均值，表示均值与聚类中心的像素值之差的绝对值，因为可能出现负数，为进行统一计算，添加绝对值使结果均为正值方便后续进行结合。紧密度C的结果越大则说明该聚类中出现其余像素值的概率越小，理想情况像素值均一的计算结果为聚类中心本身像素值，说明该簇类中不含有其他像素值的像素。综合簇类的纯净程度P，簇类的紧密度C，构建不同步长的聚类效果评价，簇类的纯净程度P衡量了像素之间的距离，簇类的紧密度C衡量了像素之间值的距离。将两参数结合为聚类效果评价方法，综合的评定了某一步长的聚类效果，以便后续联系聚类完成时间进行判定。计算簇类的聚类效果评价，用公式表示为：其中，表示第t个簇类的聚类效果评价，表示第t个簇类的紧密度，表示第t个簇类的纯净程度。的值越大效果越好，将其放置于分子位置；的值越小效果越好，将其放置于分母位置。步骤四，根据步长范围中不同的步长获得对应的聚类完成的聚类时间，对聚类时间进行归一化处理；根据归一化后的聚类时间与聚类效果评价得到聚类步长评价，根据聚类步长评价获得聚类最优步长，获得最优步长的聚类分割结果。需要说明的是，良好的聚类效果可能伴随着较长的聚类完成时间，对于工业生产来说，较慢的检测时间会影响产量，因此需要通过时间和检测结果综合进行选取最优步长，在保证聚类结果良好的同时拥有较短的检测时间。故根据步长范围分别获取不同步长对应的聚类完成的聚类时间，并对聚类时间进行归一化处理。具体地，对聚类时间进行归一化处理用公式表示为：其中，T为归一化后的聚类时间，为所有聚类步长完成聚类的时间最大值；为当前聚类步长完成聚类的时间；为所有聚类步长完成聚类的时间最小值。通过归一化，使数据分布至合理区间，避免极端数据产生计算误差。根据归一化后的聚类时间与聚类效果评价得到聚类步长评价，用公式表示为：其中，FE表示聚类步长评价，表示第t个簇类的聚类效果评价，表示第t个簇类归一化处理后的聚类时间，和表示人工设置的权重，在本实施例中，权重的取值为，表示聚类效果与聚类时间并重，可以通过不同阈值选择，调整判断的侧重。根据聚类步长评价既可以通过人为选取需要判断精度还是检测速度进行选取步长，又可以根据二者的平衡效率自适应确定步长，获得最优步长的聚类分割结果，使焊缝图像聚类效果更加优秀的同时聚类速度更快，极大地提高了生产效率。以上所述实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围，均应包含在本申请的保护范围之内。
