标题title
基于光影特征的OCT图像中导丝识别方法及识别系统
摘要abst
本发明公开了一种基于光影特征的OCT图像中导丝识别方法及系统，该方法包括：获取OCT图像，并去除OCT图像中的导管区域；对去除导管区域的OCT图像，得到灰度值累加曲线并对得到的灰度值累加曲线进行平滑化处理；对平滑化后的灰度值累加曲线，根据预设的步长进行累加，得到步长累加曲线；根据步长累加曲线，得到导丝位置并对导丝位置进行纠正，完成导丝的识别。采用灰度值累加处理，进一步得到步长累加曲线，根据步长累加曲线逐帧判断导丝位置，再根据前后参照帧对导丝进行纠正，相比直接根据像素值进行判断，本申请技术方案更加周密严谨，避免其他光影噪声的影响。
权利要求书clms
1.一种基于光影特征的OCT图像中导丝识别方法，其特征在于，包括以下步骤：S1、获取OCT图像，并去除OCT图像中的导管区域；S2、对去除导管区域的OCT图像，得到灰度值累加曲线并对得到的灰度值累加曲线进行平滑化处理；S3、对平滑化后的灰度值累加曲线，根据预设的步长进行累加，得到步长累加曲线；S4、根据步长累加曲线，得到导丝位置并对导丝位置进行纠正，完成导丝的识别。2.根据权利要求1所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，在S1中，所述获取OCT图像，并去除OCT图像中的导管区域包括以下步骤：S101、在极坐标系下获取OCT图像；S102、对获取OCT图像进行导管区域识别；S103、对识别出的导管区域的像素值重新赋值；S104、将赋值处理后的OCT图像变换到平面直角坐标系下。3.根据权利要求1所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，S2中，还包括对去除导管区域的OCT图像进行二值化处理，并对二值化处理后的图像进行灰度值累加计算，得到灰度值累加曲线。4.根据权利要求1所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，在S2中，所述对去除导管区域的OCT图像，得到的灰度值累加曲线采用如下公式表示：式中，表示灰度值累加曲线，表示平面直角坐标系下OCT图像高度，表示平面直角坐标系下第行第列的OCT图像像素值。5.根据权利要求4所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，在S2中，所述对得到的灰度值累加曲线进行平滑化处理，包括：按照设置的平滑次数和平滑块长度，对得到的灰度值累加曲线按照如下公式进行平滑化处理：式中：表示平滑后曲线，表示原曲线，表示平面直角坐标系下OCT图像宽度。6.根据权利要求1所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，在S3中，所述根据预设的步长进行累加，得到的步长累加曲线按照如下公式表示：式中，表示步长累加曲线，表示平滑化曲线，表示平面直角坐标系下OCT图像宽度，表示累加步长长度，所述累加步长长度取值为导丝宽度。7.根据权利要求1所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，在S4中，所述根据步长累加曲线，得到导丝位置包括：在OCT图像中把曲线最小值对应的横坐标视为导丝中心位置，按照如下公式对曲线连续取最小值，得到导丝位置；式中，表示第帧图像中导丝位置，表示第帧对应的步长累加曲线。8.根据权利要求1所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，在S4中，根据步长累加曲线，得到导丝位置并对导丝位置进行纠正时，包括以下方法：S401、设定导丝纠正参照帧数、导丝纠正容许偏差、概率分布函数以及各帧导丝位置参数；所述导丝纠正参照帧数包括前后相邻帧、前后奇数或偶数帧以及前后设置不同权重系数的参照帧；S402、按照如下公式计算当前帧导丝位置概率分布；式中，表示第帧导丝位置概率分布，表示第帧导丝位置；S403、根据上式得出最大函数值对应的横坐标，把区间视为导丝可存在区域，否则进行纠正。9.根据权利要求8所述的基于光影特征的OCT图像中导丝识别方法，其特征在于，纠正后导丝位置按照如下公式表示：式中，表示第帧的纠正后导丝位置。10.一种基于光影特征的OCT图像中导丝识别系统，其特征在于，用于实施上述权利要求1-8中任意一项所述的基于光影特征的OCT图像中导丝识别方法，包括：图像获取模块，用于获取OCT图像，并去除OCT图像中的导管区域；平滑处理模块，用于对去除导管区域的OCT图像，得到灰度值累加曲线并对得到的灰度值累加曲线进行平滑化处理；曲线计算模块，用于对平滑化后的灰度值累加曲线，根据预设的步长进行累加，得到步长累加曲线；导丝纠正模块，用于根据步长累加曲线，得到导丝位置并对导丝位置进行纠正，完成导丝的识别。
说明书desc
技术领域本发明涉及OCT图像识别技术领域，尤其涉及一种基于光影特征的OCT图像中导丝识别方法及识别系统。背景技术光学相干断层扫描技术可以指导经皮冠状动脉介入治疗。与单纯造影相比，可以优化支架植入指导和临床预后，即改善支架的膨胀与贴壁情况，降低支架植入的并发症发生率等。一次OCT扫描可以得到200~300张图像序列，图像中通常存在三种光影，即：导丝、支架、血管分支等，具体如图1。其中，按照当前OCT采集图像方法，图像中不得不出现导丝及其形成光影，且导丝光影与较宽支架的光影相似容易混淆，这为以OCT图像作为研究对象的图像处理算法做进一步研究和工程化带来了阻碍。现有的技术中，对于OCT中导丝的识别与去除多采用直接通过像素修正，例如专利号为 CN201910839921.X，名称为一种血管内光学相干层析成像血管壁内轮廓自动识别方法的专利中，对导丝进行识别时“将图像Inone在0~n/5的列坐标范围内按照行数进行遍历，若同一行中的连续为1的像素数目小于20，则将这些像素置为0，从而去除导丝”类似此种方法，常常会因为血管内环境与导丝光影相似，造成误判，因此，需要提供一种更为科学严谨的基于光影特征的OCT图像中导丝识别方法及识别系统。发明内容因此，本发明的目的在于提供一种基于光影特征的OCT图像中导丝识别方法及识别系统，基于OCT图像中光影特征，识别导丝存在区域。为了实现上述目的，本发明的一种基于光影特征的OCT图像中导丝识别方法，包括以下步骤：S1、获取OCT图像，并去除OCT图像中的导管区域；S2、对去除导管区域的OCT图像，得到灰度值累加曲线并对得到的灰度值累加曲线进行平滑化处理；S3、对平滑化后的灰度值累加曲线，根据预设的步长进行累加，得到步长累加曲线；S4、根据步长累加曲线，得到导丝位置并对导丝位置进行纠正，完成导丝的识别。进一步优选的，在S1中，所述获取OCT图像，并去除OCT图像中的导管区域包括以下步骤：S101、在极坐标系下获取OCT图像；S102、对获取OCT图像进行导管区域识别；S103、对识别出的导管区域的像素值重新赋值；S104、将赋值处理后的OCT图像变换到平面直角坐标系下。进一步优选的，S2中，还包括对去除导管区域的OCT图像进行二值化处理，并对二值化处理后的图像进行灰度值累加计算，得到灰度值累加曲线。进一步优选的，在S2中，所述对去除导管区域的OCT图像，得到的灰度值累加曲线采用如下公式表示：式中，表示灰度值累加曲线，表示平面直角坐标下OCT图像高度，表示平面直角坐标下第行第列的OCT图像像素值。进一步优选的，在S2中，所述对得到的灰度值累加曲线进行平滑化处理，包括：按照设置的平滑次数和平滑块长度，对得到的灰度值累加曲线按照如下公式进行平滑化处理：式中：表示平滑后曲线，表示灰度值累加曲线，表示平面直角坐标下OCT图像宽度。进一步优选的，在S3中，所述根据预设的步长进行累加，得到的步长累加曲线按照如下公式表示：式中，表示步长累加曲线，表示平滑化曲线，表示平面直角坐标下OCT图像宽度，表示累加步长长度，所述累加步长长度取值为导丝宽度。进一步优选的，在S4中，所述根据步长累加曲线，得到导丝位置包括：在OCT图像中把曲线最低值对应的横坐标视为导丝中心位置，按照如下公式对曲线连续取最小值，得到导丝位置；式中，表示第帧图像中导丝位置，表示第帧对应的步长累加曲线。进一步优选的，在S4中，根据步长累加曲线，得到导丝位置并对导丝位置进行纠正时，包括以下方法：S401、设定导丝纠正参照帧数、导丝纠正容许偏差、概率分布函数以及各帧导丝位置参数；所述导丝纠正参照帧数包括前后相邻帧、前后奇数或偶数帧以及前后设置不同权重系数的参照帧；S402、按照如下公式计算当前帧导丝位置概率分布；式中，表示第帧导丝位置概率分布，表示第帧导丝位置；S403、根据上式得出最大函数值对应的横坐标，把区间视为导丝可存在区域，否则进行纠正。进一步优选的，纠正后导丝位置按照如下公式表示：式中，表示第帧的纠正后导丝位置。本发明还提供一种基于光影特征的OCT图像中导丝识别系统，用于实施上述基于光影特征的OCT图像中导丝识别方法，包括：图像获取模块，用于获取OCT图像，并去除OCT图像中的导管区域；平滑处理模块，用于对去除导管区域的OCT图像，得到灰度值累加曲线并对得到的灰度值累加曲线进行平滑化处理；曲线计算模块，用于对平滑化后的灰度值累加曲线，根据预设的步长进行累加，得到步长累加曲线；导丝纠正模块，用于根据步长累加曲线，得到导丝位置并对导丝位置进行纠正，完成导丝的识别。本申请公开的一种基于光影特征的OCT图像中导丝识别方法及系统，相比于现有技术至少具有以下优点：本申请对去除导管区域的OCT图像中，采用灰度值累加处理，进一步得到步长累加曲线，根据步长累加曲线逐帧判断导丝位置，再根据前后参照帧对导丝进行纠正，相比直接根据像素值进行判断，本申请技术方案更加周密严谨，避免其他光影噪声的影响。本申请中还对当前帧得到导丝位置根据前后参考帧按照概率分布函数进行纠正，方案更具科学性，避免在进行后期导丝删除时，对其他血管内环境造成影响。附图说明图1为背景技术中存在三种光影的平面直角坐标系下OCT图像。图2为背景技术中存在宽支架的平面直角坐标系下OCT图像。图3为本申请实施例1中获取的极坐标系下OCT图像。图4为本申请实施例1中去除导管区域的平面直角坐标系下OCT图像。图5为本申请实施例2中极坐标系下OCT图像。图6为本申请实施例2中去除导管区域的平面直角坐标系下OCT图像。图7为本申请在平面直角坐标系下OCT图像，大津法处理效果图。图8为本申请随横坐标变化的方向累加值曲线。图9为本申请中平滑化后的累加值曲线。图10为本申请中步长累加曲线与导丝位置示意图。图11为本申请中实施例3所示的第一帧中步长累加曲线、导丝位置、对应的概率分布曲线示意图。图12为本申请中实施例3所示的第二帧中步长累加曲线、导丝位置、对应的概率分布曲线示意图。图13为本申请中实施例3所示的第三帧中步长累加曲线、导丝位置、对应的概率分布曲线示意图。图14为本申请中实施例3所示的第四帧中步长累加曲线、导丝位置、对应的概率分布曲线示意图。图15为本申请中实施例3所示的第五帧中步长累加曲线、导丝位置、对应的概率分布曲线示意图。图16为本申请中导丝位置概率分布曲线以及针对图13纠正后导丝位置。图17为本申请中基于光影特征的OCT图像中导丝识别方法的流程示意图。具体实施方式以下通过附图和具体实施方式对本发明作进一步的详细说明。如图17所示，本发明一方面实施例提供的基于光影特征的OCT图像中导丝识别方法。包括以下步骤：S1、获取OCT图像，并去除OCT图像中的导管区域；S2、对去除导管区域的OCT图像，得到灰度值累加曲线并对得到的灰度值累加曲线进行平滑化处理；S3、对平滑化后的灰度值累加曲线，根据预设的步长进行累加，得到步长累加曲线；S4、根据步长累加曲线，得到导丝位置并对导丝位置进行纠正，完成导丝的识别。如图3所示，在S1中，所述获取OCT图像，并去除OCT图像中的导管区域包括以下步骤：S101、在极坐标系下获取OCT图像；S102、对获取OCT图像进行导管区域识别；S103、对识别出的导管区域的像素值重新赋值；S104、将赋值处理后的OCT图像变换到平面直角坐标系下。实施例1在极坐标系下，在行列OCT图像中，由医师选定导管区域。本方法假设导管区域为圆形，即接受信息为导管区域的圆心坐标与圆半径，如图3中曲线所示。然后把该区域映射至平面直角坐标系区域，并将平面直角坐标系下行列OCT图像中该区域像素值置为零，或置为较小值如图4。图3为极坐标系下OCT图像，曲线表示医生选定的导管区域。 图4为导管区域被去除的平面直角坐标系下OCT图像。实施例2，由医师选定导管区域的原因是，在临床中导管区域不一定在OCT图像正中心。当导管区域在OCT图像中非正中心时，平面直角坐标系下相应区域应随之变化，具体如图5与图6所示。 图5为，极坐标系下OCT图像，曲线表示医生选定的导管区域。图6为导管区域图5中曲线内区域被去除的平面直角坐标系下OCT图像。需要说明的是，导管区域”假设为圆形，是便于描述与处理。“导管区域”假设为任意多边形进行处理，也应在本专利保护范围中。极坐标系下图像与平面直角坐标系下图像，其行列大小没有绝对关系，可任意缩放。应在本专利保护范围中。描述“像素值置为零”可替代为“像素值置为低值”，应在本专利保护范围中。S2中，还包括对去除导管区域的OCT图像进行二值化处理，并对二值化处理后的图像进行灰度值累加计算，得到灰度值累加曲线。进一步，对原图像不进行二值化，直接进行灰度值累加得到曲线，也应在本专利保护范围中。做二值化是便于减少图像中噪声对曲线平滑程度的影响。首先，在平面直角坐标系下，对行列OCT图像进行二值化，具体方法可以采用大津法，其处理效果如图7。并在图像中，分别把不同对应的方向全部像素值进行累加，得到曲线如图8所示。在S2中，所述对去除导管区域的OCT图像，得到的灰度值累加曲线采用如下公式1表示：式中，表示灰度值累加曲线，表示平面直角坐标系下OCT图像高度，表示平面直角坐标下第行第列的OCT图像像素值。其次，在S2中，所述对得到的灰度值累加曲线进行平滑化处理，包括：按照设置的平滑次数和平滑块长度，对得到的灰度值累加曲线按照如下公式进行平滑化处理：式中：表示平滑后曲线，表示原曲线，表示平面直角坐标系下OCT图像宽度。曲线平滑化的目的是：减少图像中噪声对曲线平滑程度的影响。因此平滑方式本身，可以采用上方数学表达式，但不局限于该表达式。以“曲线平滑化”作为直接目的或间接目的方法，均应在本专利保护范围中。每次平滑化后完全替代原曲线，即：，直至平滑化次数达到次。取时曲线平滑化效果如图9，由曲线表示。进一步在S3中，所述根据预设的步长进行累加，得到的步长累加曲线，做曲线步长累加的目的，是为找到曲线中“连续低值”的区间。可以通过下文数学表达式，但不限于该方法，应在本专利保护范围中。具体包括把假设的导丝宽度作为步长长度，对曲线进行步长累加，步长累加曲线表达式为：式中，表示步长累加曲线，表示平滑化曲线，表示平面直角坐标系下OCT图像宽度，表示累加步长长度，所述累加步长长度取值为导丝宽度。最后，基于步长累加曲线得出导丝位置，即在OCT图像中把曲线最低值对应的横坐标视为导丝中心位置。如图10所示，步长累加曲线由曲线表示，导丝位置由直线表示。在共有帧的OCT图像序列中，设为导丝位置，则有： 式中，表示第帧图像中导丝位置，表示第帧对应的步长累加曲线。当OCT图像中存在较宽支架时，可能把该支架误识别为导丝。为了减少导丝误判，对全部帧导丝识别后，根据前后帧导丝位置相对连续的特点进行导丝位置纠正。具体为，在S4中，根据步长累加曲线，得到导丝位置并对导丝位置进行纠正时，包括以下方法：设定导丝纠正参照帧数，导丝纠正容许偏差，概率分布函数，并设各帧导丝位置。对第帧进行导丝纠正时，首先基于其前后帧导丝位置得到当前帧导丝位置概率分布，表达式如下：式中，表示第帧导丝位置概率分布，表示第帧导丝位置。不局限于上述数学表达式。导丝纠正参照帧数包括前后相邻帧、前后奇数或偶数帧以及前后设置不同权重系数的参照帧；均应在本专利保护范围中。S403、根据上式得出最大函数值对应的横坐标，把区间视为导丝可存在区域，否则进行纠正。正后导丝位置按照如下公式表示：式中，表示第帧的纠正后导丝位置。实施例3中采用如图11至图15所示的，连续5帧OCT图像序列中对连续帧的导丝识别结果，以及相应的概率分布曲线。其中，图13、图14是识别错误的。导丝纠正过程是针对图13进行的。图16是参照了图11、12、14、15 后对原图13纠正后的。纠正之前，各帧的【概率分布曲线】只是根据当前帧计算得出。然后根据图11、12、14、15，计算得出【概率分布曲线】并进行纠正。因此图16中与原图13相比曲线高峰位置发生相应变化。图11、12、13、14、15中步长累加曲线由曲线表示、导丝位置由直线表示、对应的概率分布曲线由曲线所示；图16中相应的概率分布曲线由曲线表示，以及纠正结果即纠正后的导丝位置采用直线表示。本发明还提供一种基于光影特征的OCT图像中导丝识别系统，用于实施上述基于光影特征的OCT图像中导丝识别方法，包括：图像获取模块，用于获取OCT图像，并去除OCT图像中的导管区域；平滑处理模块，用于对去除导管区域的OCT图像，得到灰度值累加曲线并对得到的灰度值累加曲线进行平滑化处理；曲线计算模块，用于对平滑化后的灰度值累加曲线，根据预设的步长进行累加，得到步长累加曲线；导丝纠正模块，用于根据步长累加曲线，得到导丝位置并对导丝位置进行纠正，完成导丝的识别。具体实施例参见上述描述。显然，上述实施例仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引伸出的显而易见的变化或变动仍处于本发明创造的保护范围之中。
