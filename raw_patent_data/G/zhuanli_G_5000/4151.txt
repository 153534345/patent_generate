标题title
一种软件模拟电池停充的系统及其方法
摘要abst
本发明提供一种软件模拟电池停充的系统及其方法，该方法包括当确定当前系统进入粗调停充模式，判断当前电池电压是否大于模糊电池电压，如是，则系统控制充电电流档位减少1档，继续判断当前电池电压是否大于停充电压，如是，则继续控制充电电流档位减少1档，直到当前电池电压小于停充电压时，则进入细调停充模式；判断当前电池电压是否超过停充电压的上下限，若超过停充电压的上限，则系统控制充电电流档位减少1档；若超过停充电压的下限，则系统控制充电电流档位增加1档；判断当前电池电压和电流是否满足停充条件。本发明可以实现对电池进行模拟停充，可灵活设置停充电压和停充电流，具有预先判断停充电压的粗调作用等优点。
权利要求书clms
1.一种软件模拟电池停充的系统，其特征在于，包括：电池参数采集模块，用于采集电池运行过程中的参数，并将数据传输至系统运行逻辑单元；充电电流控制模块，对电池进行实时充电电流控制；计时模块，用于计算采集时间和运行时间；系统运行逻辑单元，根据预先设置的电池停充条件，用于生成控制指令至充电电流控制模块，以控制电池在预设的电压下断开电池及供电回路；其中，所述电池停充条件的参数包括系统装载停充电压、停充电流、停充电压误差、粗细调界限电流、模糊电池电压、充电档位。2.一种软件模拟电池停充的方法，其特征在于，该方法应用于如权利要求1所述的一种软件模拟电池停充的系统进行模拟电池停充，该方法包括以下步骤：设置电池停充条件，当系统正常运行后开始对电池进行充电；根据间隔时间实时采集充电时K次电池电流和电池电压，并将采集到的数据分别存到数组中，并丢弃每组数据的最大最小值，取其数学平均值为每组数据的采样有效值；判断是否进入粗调停充模式或细调停充模式，当确实当前系统进入粗调停充模式，判断当前电池电压是否大于模糊电池电压，如是，则系统控制充电电流档位减少1档，继续判断当前电池电压是否大于停充电压，如是，则继续控制充电电流档位减少1档，直到当前电池电压小于停充电压时，则进入细调停充模式；当确定当前系统进入细调停充模式时，判断当前电池电压是否超过停充电压的上下限，若超过停充电压的上限，则系统控制充电电流档位减少1档；若超过停充电压的下限，则系统控制充电电流档位增加1档；判断当前电池电压和电流是否满足停充条件，如是，则系统控制断开电池及供电回路，置停充标志位为1，关闭充电使能。3.根据权利要求2所述的方法，其特征在于：假设停充电压为VBAT_SET_STOP，停充电流为IBAT_SET_STOP，停充电压误差为VBAT_OFFSET，粗细调界限电流为IBAT_LIMIT，模糊电池电压为VBAT_UP，充电电流档位为IBAT_LSB；其中，停充电压VBAT_SET_STOP为系统预先设置的停充电压；停充电流IBAT_SET_STOP为系统预设的停充电流；粗细调界限电流IBAT_LIMIT为：当电池电流IBAT大于粗细调界限电流IBAT_LIMIT，则系统进入粗调停充模式；当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压VBAT达到模糊电池电压VBAT_UP后减档充电电流使电池电压低于停充电压后，则系统进入细调停充模式；模糊电池电压VBAT_UP为：在系统进入细调停充模式前，需要将电池电压充到模糊电池电压VBAT_UP之上，该模糊电压为预先把电池充到比停充电压高的电压，然后开始减充电电流档位，该模糊电压刚好与减充电电流档位造成的压差下降相抵消；充电电流档位IBAT_LSB为：每个充电电流档位电池电流的变化量。4.根据权利要求3所述的方法，其特征在于：判断当前电池电压VBAT是否超过停充电压的上下限的条件包括：定义上下限停充电压公式，表示为公式：VBAT_SET_STOP_UP＝VBAT_SET_STOP+VBAT_OFFSET；VBAT_SET_STOP_DOWN＝VBAT_SET_STOP-VBAT_OFFSET 其中，VBAT_SET_STOP_UP为停充上限电压，VBAT_SET_STOP_DOWN为停充下限电压，VBAT_OFFSET为停充电压误差。5.根据权利要求3所述的方法，其特征在于：所述停充条件包括，若当前电池电流IBAT小于停充电流IBAT_SET_STOP，并且当前电池电压VBAT大于停充电压VBAT_SET_STOP，则认为当前电池电量已经充足，当前电池电压和电流满足停充条件。6.根据权利要求3所述的方法，其特征在于：当电池电流IBAT大于粗细调界限电流IBAT_LIMIT时，系统开始进入粗调停充模式，此时系统需充电直至达到模糊电池电压VBAT_UP，当电池电压VBAT达到模糊电池电压VBAT_UP时，系统开始控制充电电流档位减少档位，直到电池电压VBAT小于停充电压VBAT_SET_STOP时才停止减少档位，此时系统进入细调停充模式。7.根据权利要求6所述的方法，其特征在于：设电池内阻和线材总内阻为r，则r表示为公式：r＝/则模糊电池电压VBAT_UP表示为公式：VBAT_UP＝r*+VBAT_SET_STOP 。8.根据权利要求4所述的方法，其特征在于：当电池电压VBAT大于模糊电池电VBAT_UP时，则系统进入粗调停充模式，控制充电电流档位减少一个档位的电流，在减完档位之后再次判断此时系统电池电压VBAT是否大于停充电压VBAT_SET_STOP，如是，则继续控制充电电流档位减少一个档位的电流，直到电池电压小于停充电压VBAT_SET_STOP，系统开始切换到细调停充模式。9.根据权利要求4所述的方法，其特征在于：当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压VBAT达到模糊电池电压VBAT_UP后减档充电电流使电池电压低于停充电压后，系统开始进入细调停充模式，当电池电压VBAT达到预设的停充上限电压VBAT_SET_STOP_UP时，则控制充电电流档位减少一个档位的电流，若电池电压VBAT小于停充下限电压VBAT_SET_STOP_DOWN，则控制充电电流增加一个档位的电流；若当前电池电流IBAT小于停充电流IBAT_STOP，并且当前电池电压VBAT大于停充电压VBAT_SET_STOP，则认为当前电池电量已经充足，当前电池电压和电流满足停充条件。10.根据权利要求3所述的方法，其特征在于：当系统开始对电池进行充电时，系统以最大电流对电池进行恒流充电，并实时监测电池电压VBAT是否达到模糊电池电压VBAT_UP以及电池电流IBAT是否小于粗细调界限电流IBAT_LIMIT，来判断系统是否进入细调停充模式，若系统小于粗细调界限电流IBAT_LIMIT，则系统立即切换到细调停充模式。
说明书desc
技术领域本发明涉及电池停充技术领域，具体涉及一种适用于软件模拟电池停充的系统以及应用该系统的停充方法。背景技术目前，市面上使用锂电池的场景越来越多，各种便携式以及消费电子设备都需要用锂电池来供电，给锂电池充饱，以及在合适的电池电压下正确停充成为了一个重要的方向。在充电过程中，用户不可能实时监控电池的充电情况，导致经常会出现电池过充现象。如果电池充满电后继续对电池进行充电，会对手机电池会造成一定的伤害，如引起电池会因发热或过热，损坏锂电池的蓄电量，影响电池性能。在实际应用上，现在很多电源管理芯片都设计有硬件停充逻辑，都可以让锂电池在设定好的电压下停充，但一般这种设置停充的电压只有几个档位，而且电源管理芯片硬件停充逻辑并不能满足所有的场景，局限性很大，不够灵活多变。例如，有时候应用场景需要锂电池在不是饱和电压乃至特定电压下停充，还有应用场景是需要锂电池的停充需要与其他事件交互下触发才进行，至少存在应用场景少、浪费电能、可靠性差与使用不方便等缺陷。另外，对于通过硬件充电单元进行充电的情况，目前能够实现充满电后自动断电，但都采用了硬件方式，比如移动终端充满电后自动断电的装置、充满电后自动断电的排插以及自动断电的万能充电器等。从硬件的角度出发解决电池充满电后自动停止充电的缺陷存在以下问题：硬件设计本身较为复杂，消耗的时间和成本较高；其次从用户需要随身携带这些硬件装置才能够解决过充的问题。发明内容为了克服现有技术的不足，本发明的目的在于提供一种软件模拟电池停充的系统及其方法，该系统和方法可以解决现有技术应用场景单一，局限性大，不够灵活，可靠性差，使用不方便，以及硬件成本过高等问题，可以实现对电池进行模拟停充，可灵活设置停充电压和停充电流，并且具有预先判断停充电压的粗调作用的优点。为解决上述问题，本发明所采用的技术方案如下：一种软件模拟电池停充的系统，包括：电池参数采集模块，用于采集电池运行过程中的参数，并将数据传输至系统运行逻辑单元；充电电流控制模块，对电池进行实时充电电流控制；计时模块，用于计算采集时间和运行时间；系统运行逻辑单元，根据预先设置的电池停充条件，用于生成控制指令至充电电流控制模块，以控制电池在预设的电压下断开电池及供电回路；其中，所述电池停充条件的参数包括系统装载停充电压、停充电流、停充电压误差、粗细调界限电流、模糊电池电压、充电档位。一种软件模拟电池停充的方法，该方法应用于上述一种软件模拟电池停充的系统进行控制，该方法包括以下步骤：设置电池停充条件，当系统正常运行后开始对电池进行充电；根据间隔时间实时采集充电时K次电池电流和电池电压，并将采集到的数据分别存到数组中，并丢弃每组数据的最大最小值，取其数学平均值为每组数据的采样有效值；判断是否进入粗调停充模式或细调停充模式，当确定当前系统进入粗调停充模式，判断当前电池电压是否大于模糊电池电压，如是，则系统控制充电电流档位减少1档，继续判断当前电池电压是否大于停充电压，如是，则继续控制充电电流档位减少1档，直到当前电池电压小于停充电压时，则进入细调停充模式；当确定当前系统进入细调停充模式时，判断当前电池电压是否超过停充电压的上下限，若超过停充电压的上限，则系统控制充电电流档位减少1档；若超过停充电压的下限，则系统控制充电电流档位增加1档；判断当前电池电压和电流是否满足停充条件，如是，则系统控制断开电池及供电回路，置停充标志位为1，关闭充电使能。根据本发明提供的一种软件模拟电池停充的方法，假设停充电压为VBAT_SET_STOP，停充电流为IBAT_SET_STOP，停充电压误差为VBAT_OFFSET，粗细调界限电流为IBAT_LIMIT，模糊电池电压为VBAT_UP，充电电流档位为IBAT_LSB；其中，停充电压VBAT_SET_STOP为系统预先设置的停充电压；停充电流IBAT_SET_STOP为系统预设的停充电流；粗细调界限电流IBAT_LIMIT为：当电池电流IBAT大于粗细调界限电流IBAT_LIMIT，则系统进入粗调停充模式；当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压VBAT达到模糊电池电压VBAT_UP后减档充电电流使电池电压低于停充电压后，则系统进入细调停充模式；模糊电池电压VBAT_UP为：在系统进入细调停充模式前，需要将电池电压充到模糊电池电压VBAT_UP之上，该模糊电压为预先把电池充到比停充电压高的电压，然后开始减充电电流档位，该模糊电压刚好与减充电电流档位造成的压差下降相抵消；充电电流档位IBAT_LSB为：每个充电电流档位电池电流的变化量。根据本发明提供的一种软件模拟电池停充的方法，判断当前电池电压VBAT是否超过停充电压的上下限的条件包括：定义上下限停充电压公式，表示为公式：VBAT_SET_STOP_UP＝VBAT_SET_STOP+VBAT_OFFSET；VBAT_SET_STOP_DOWN＝VBAT_SET_STOP-VBAT_OFFSET 其中，VBAT_SET_STOP_UP为停充上限电压，VBAT_SET_STOP_DOWN为停充下限电压，VBAT_OFFSET为停充电压误差。根据本发明提供的一种软件模拟电池停充的方法，所述停充条件包括，若当前电池电流IBAT小于停充电流IBAT_SET_STOP，并且当前电池电压VBAT大于停充电压VBAT_SET_STOP，则认为当前电池电量已经充足，当前电池电压和电流满足停充条件。根据本发明提供的一种软件模拟电池停充的方法，当电池电流IBAT大于粗细调界限电流IBAT_LIMIT时，系统开始进入粗调停充模式，此时系统需充电直至达到模糊电池电压VBAT_UP，当电池电压VBAT达到模糊电池电压VBAT_UP时，系统开始控制充电电流档位减少档位，直到电池电压VBAT小于停充电压VBAT_SET_STOP时才停止减少档位，此时系统进入细调停充模式。根据本发明提供的一种软件模拟电池停充的方法，设电池内阻和线材总内阻为r，则r表示为公式：r＝/则模糊电池电压VBAT_UP表示为公式：VBAT_UP＝r*+VBAT_SET_STOP 。根据本发明提供的一种软件模拟电池停充的方法，当电池电压VBAT大于模糊电池电VBAT_UP时，则系统进入粗调停充模式，控制充电电流档位减少一个档位的电流，在减完档位之后再次判断此时系统电池电压VBAT是否大于停充电压VBAT_SET_STOP，如是，则继续控制充电电流档位减少一个档位的电流，直到电池电压小于停充电压VBAT_SET_STOP，系统开始切换到细调停充模式。根据本发明提供的一种软件模拟电池停充的方法，当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压VBAT达到模糊电池电压VBAT_UP后减档充电电流使电池电压低于停充电压后，该系统开始进入细调停充模式，当电池电压VBAT达到预设的停充上限电压VBAT_SET_STOP_UP时，则控制充电电流档位减少一个档位的电流，若电池电压VBAT小于停充下限电压VBAT_SET_STOP_DOWN，则控制充电电流增加一个档位的电流；若当前电池电流IBAT小于停充电流IBAT_STOP，并且当前电池电压VBAT大于停充电压VBAT_SET_STOP，则认为当前电池电量已经充足，当前电池电压和电流满足停充条件。根据本发明提供的一种软件模拟电池停充的方法，当系统开始对电池进行充电时，系统以最大电流对电池进行恒流充电，并实时监测电池电压VBAT是否达到模糊电池电压VBAT_UP以及电池电流IBAT是否小于粗细调界限电流IBAT_LIMIT，来判断系统是否进入细调停充模式，若系统小于粗细调界限电流IBAT_LIMIT，则系统立即切换到细调停充模式。由此可见，本发明可以预先设置好系统装载停充电压、停充电流，停充电压误差，粗细调界限电流，模糊电池电压，充电档位，在开始充电时先给电池以最大充电电流开始恒流充电，并实时采集电池电压和电池电流来决定是否进行电池停充，在软件模拟电池停充时，系统分为粗调停充模式和细调停充模式两个过程，采用预先设置的两种停充模式调整停充的电压电流，从而实现对电池进行模拟停充，达到停充电压粗调整或细调整的效果，满足不同停充需求的场景。此外，本发明系统不仅具有电路结构简单、采用元件少、体积小、制作成本低和容易制作的特点，尤其自动停止充电性能稳定，有益于推广。下面结合附图和具体实施方式对本发明作进一步详细说明。附图说明图1是本发明一种软件模拟电池停充的系统实施例的电路原理图。图2是本发明一种软件模拟电池停充的方法实施例的流程图。图3是本发明一种软件模拟电池停充的方法实施例的具体流程图。图4是本发明一种软件模拟电池停充的方法实施例中关于模拟电池停充的全局波形图。图5是本发明一种软件模拟电池停充的方法实施例中关于模拟电池停充的局部波形图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。一种软件模拟电池停充的系统实施例：参见图1，本发明提供的一种软件模拟电池停充的系统，包括：电池参数采集模块10，用于采集电池运行过程中的参数，如实时采集电池电压VBAT和电池电流IBAT，并将数据传输至系统运行逻辑单元；充电电流控制模块20，对电池进行实时充电电流控制；计时模块30，用于计算采集时间和运行时间；系统运行逻辑单元40，整合前三个模块的数据，根据预先设置的电池停充条件，用于生成控制指令至充电电流控制模块20，以控制电池在预设的电压下断开电池及供电回路；其中，电池停充条件的参数包括系统装载停充电压VBAT_SET_STOP、停充电流IBAT_SET_STOP，停充电压误差VBAT_OFFSET，粗细调界限电流IBAT_LIMIT，模糊电池电压VBAT_UP，充电档位IBAT_LSB，确保把电池在预设的电压下停充。停充电压VBAT_SET_STOP：系统预设的停充电压，这是系统停充的条件之一，本实施例停充电压的取值范围为。停充电流IBAT_SET_STOP：系统预设的停充电流，这是系统停充的条件之一，本实施例停充电流的取值范围为。当系统的电池电压VBAT大于停充电压VBAT_SET_STOP，而此时系统的电池电流IBAT又小于停充电流IBAT_SET_STOP，系统才会真的停止充电，此时电池刚好被充饱。粗细调界限电流IBAT_LIMIT：当电池电流IBAT大于粗细调界限电流IBAT_LIMIT，系统开始粗调；当电池电流小于粗细调界限电流IBAT_LIMIT或者电池电压达到模糊电池电压VBAT_UP减档充电电流切换过来的，系统开始细调。模糊电池电压VBAT_UP：这个是系统进行细调前，要先把电池电压充到模糊电池电压VBAT_UP之上。充电档位IBAT_LSB：每个档位，电池电流的变化量，本实施例的取值范围为。作为优选，本实施例的系统还设置有一报警发生电路，系统运行逻辑单元40与报警发生电路相连接，可以在电池充电完成后，自动停止充电并及时发出警示声音，提醒用户在充电结束后的第一时间里把电池从充电器上取下，既可以对电池进行保护，还可以减少不必要的电能消耗。因此，本系统制造成本低廉，节能可靠，使用方便；从而可以克服现有技术中浪费电能、可靠性差与使用不方便的缺陷，以实现成本低廉、节能可靠与使用方便的优点。一种软件模拟电池停充的方法实施例：一种软件模拟电池停充的方法，该方法应用于上述一种软件模拟电池停充的系统进行控制，如图2所示。该方法包括以下步骤：步骤S1，设置电池停充条件，当系统正常运行后开始对电池进行充电；步骤S2，根据间隔时间实时采集充电时K次电池电流和电池电压，并将采集到的数据分别存到数组中，并丢弃每组数据的最大最小值，取其数学平均值为每组数据的采样有效值；步骤S3，判断是否进入粗调停充模式和细调停充模式，当确实当前系统进入粗调停充模式，判断当前电池电压是否大于模糊电池电压，如是，则系统控制充电电流档位减少1档，继续判断当前电池电压是否大于停充电压，如是，则继续控制充电电流档位减少1档，直到当前电池电压小于停充电压时，则进入细调停充模式；步骤S4，当确定当前系统进入细调停充模式时，判断当前电池电压是否超过停充电压的上下限，若超过停充电压的上限，则系统控制充电电流档位减少1档；若超过停充电压的下限，则系统控制充电电流档位增加1档；步骤S5，判断当前电池电压和电流是否满足停充条件，如是，则系统控制断开电池及供电回路，置停充标志位为1，关闭充电使能。本实施例的软件模拟锂电池停充主要是看两个参数来停充的，一是停充电池电压VBAT_STOP，二是停充电流IBAT_STOP，当这两个条件同时达到的时候，这个时候的锂电池也才可以说是充饱了，电池也可以正常停充。在上述步骤S1中，假设停充电压为VBAT_SET_STOP，停充电流为IBAT_SET_STOP，停充电压误差为VBAT_OFFSET，粗细调界限电流为IBAT_LIMIT，模糊电池电压为VBAT_UP，充电电流档位为IBAT_LSB。其中，停充电压VBAT_SET_STOP为系统预先设置的停充电压；停充电流IBAT_SET_STOP为系统预设的停充电流。粗细调界限电流IBAT_LIMIT为：当电池电流IBAT大于粗细调界限电流IBAT_LIMIT，则系统进入粗调停充模式；当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压VBAT达到模糊电池电压VBAT_UP后减档充电电流使电池电压低于停充电压后，则系统进入细调停充模式。模糊电池电压VBAT_UP为：在系统进入细调停充模式前，需要将电池电压充到模糊电池电压VBAT_UP之上，该模糊电压为预先把电池充到比停充电压高的电压，然后开始减充电电流档位，该模糊电压刚好与减充电电流档位造成的压差下降相抵消。充电电流档位IBAT_LSB为：每个充电电流档位电池电流的变化量。在本实施例中，判断当前电池电压VBAT是否超过停充电压的上下限的条件包括：定义上下限停充电压公式，表示为公式：VBAT_SET_STOP_UP＝VBAT_SET_STOP+VBAT_OFFSET；VBAT_SET_STOP_DOWN＝VBAT_SET_STOP-VBAT_OFFSET 其中，VBAT_SET_STOP_UP为停充上限电压，VBAT_SET_STOP_DOWN为停充下限电压，VBAT_OFFSET为停充电压误。在本实施例中，停充条件包括，若当前电池电流IBAT小于停充电流IBAT_SET_STOP，并且当前电池电压VBAT大于停充电压VBAT_SET_STOP，则认为当前电池电量已经充足，当前电池电压和电流满足停充条件。在本实施例中，当电池电流IBAT大于粗细调界限电流IBAT_LIMIT时，系统开始进入粗调停充模式，此时系统需充电直至达到模糊电池电压VBAT_UP，当电池电压VBAT达到模糊电池电压VBAT_UP时，系统开始控制充电电流档位减少档位，直到电池电压VBAT小于停充电压VBAT_SET_STOP时才停止减少档位，此时系统进入细调停充模式。在本实施例中，设电池内阻和线材总内阻为r，则r表示为公式：r＝/则模糊电池电压VBAT_UP表示为公式：VBAT_UP＝r*+VBAT_SET_STOP 。在本实施例中，当电池电压VBAT大于模糊电池电VBAT_UP时，则系统进入粗调停充模式，控制充电电流档位减少一个档位的电流，在减完档位之后再次判断此时系统电池电压VBAT是否大于停充电压VBAT_SET_STOP，如是，则继续控制充电电流档位减少一个档位的电流，直到电池电压小于停充电压VBAT_SET_STOP，系统开始切换到细调停充模式。在本实施例中，当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压VBAT达到模糊电池电压VBAT_UP后减档充电电流使电池电压低于停充电压后，系统开始进入细调停充模式，当电池电压VBAT达到预设的停充上限电压VBAT_SET_STOP_UP时，则控制充电电流档位减少一个档位的电流，若电池电压VBAT小于停充下限电压VBAT_SET_STOP_DOWN，则控制充电电流增加一个档位的电流；若当前电池电流IBAT小于停充电流IBAT_STOP，并且当前电池电压VBAT大于停充电压VBAT_SET_STOP，则认为当前电池电量已经充足，当前电池电压和电流满足停充条件。在本实施例中，当系统开始对电池进行充电时，系统以最大电流对电池进行恒流充电，并实时监测电池电压VBAT是否达到模糊电池电压VBAT_UP以及电池电流IBAT是否小于粗细调界限电流IBAT_LIMIT，来判断系统是否进入细调停充模式，若系统小于粗细调界限电流IBAT_LIMIT，则系统立即切换到细调停充模式。具体的，在本发明方法使用软件模拟电池停充时，通过系统实时采集电池电压VBAT和电池电流IBAT，如每秒采取10个数据，分别存到数组VBAT和IBAT中，并丢弃这两个数组中的最大值和最小值，剩余八个数据做数学平均，作为这次采样的有效值。其中，在一开始充电时，先给电池以最大充电电流开始恒流充电。本实施例的软件模拟电池停充分为粗调过程和细调过程两个过程：当电池电流IBAT大于粗细调界限电流IBAT_LIMIT，系统开始粗调，此时系统应当需要充到一个模糊的电池电压，当电池电压VBAT达到这个模糊的电池电压时，系统开始减档位后，直到电池电压小于停充电压VBAT_SET_STOP时才停止减档位，减完档位后刚好电池电压VBAT和电池电流IBAT能在停充电压和停充电流附近徘徊。设此时电池电流为IBAT，电池内阻和线材总内阻为r，r可以通过实测得到一般的值，模糊电池电压为VBAT_UP，则有公式：r＝/由公式得出公式：VBAT_UP＝r*+VBAT_SET_STOP通过上述公式，可以算出模糊电池电压VBAT_UP。当电池电压VBAT大于模糊电池电压VBAT_UP时，系统进行粗调，控制充电电流档位减一个档位的电流，减完档位之后再次判断如果此时系统电池电压是否大于停充电压VBAT_SET_STOP，如是，则继续控制充电电流档位减一个档位的电流，直到电池电压VBAT小于停充电压VBAT_SET_STOP时，则系统开始切换到细调停充模式。当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压VBAT达到模糊电池电压VBAT_UP后减档充电电流使电池电压低于停充电压后，系统开始细调，当电池电压VBAT达到预设的VBAT_SET_STOP_UP时，则控制充电电流减一个档位的电流，若电池电压小于停充上限电压VBAT_SET_STOP_DOWN，则控制充电电流档位增加一个档位的电流。当电池电流IBAT小于停充电流IBAT_STOP，且这个时候电池电压VBAT大于VBAT_SET_STOP，则认为电池已经充饱，可以正常停充。在实际应用中，如3所示。本实施例所提供的一种软件模拟电池停充的方法，具体包括：、系统各参数初始化，将电池参数采集模块10、充电电流控制模块20和计时模块30各个模块使能打开；、实时采集充电时的电池电压和电池电流，每秒采取10个数据，分别存到数组VBAT和IBAT中，丢弃这两个数组中的最大值和最小值，剩余八个数据做数学平均，作为这次采样的有效值；、设此时电池电流为IBAT，电池内阻和线材总内阻为r，r可以通过实测得到一般的值，模糊电池电压为VBAT_UP，该模糊电池电压VBAT_UP需要考虑一种情况，就是停充电压和电池饱和电压差距越大，这个粗调越有用，这种粗调效果类似于预先评估的作用，可以保证系统在最后进入细调停充模式时，电池电流IBAT和电池电压VBAT的大小在停充电流和停充电压附近。此外，如果设置的停充电压和饱和电压基本相等，则系统不会进入粗调停充模式；、系统装载停充电压VBAT_SET_STOP、停充电流IBAT_SET_STOP，停充电压误差VBAT_OFFSET，粗细调界限电流IBAT_LIMIT，模糊电池电压VBAT_UP，充电档位IBAT_LSB；、系统开始以最大电流对电池进行恒流充电，实时监测电池电压VBAT是否达到停充电池电压VBAT_UP以及电池电流IBAT是否小于粗细调界限电流IBAT_LIMIT，来决定是否进入细调停充模式；、如果电池电压VBAT达到停充电池电压VBAT_UP，则控制充电电流档位减一个档位的电流。在减完档位之后再次判断如果此时系统电池电压VBAT大于VBAT_SET_STOP，则继续控制充电电流档位减一个档位的电流，直到电池电压VBAT小于VBAT_SET_STOP时，则系统开始切换到细调停充模式；如果此时电池电流IBAT小于粗细调界限电流IBAT_LIMIT，系统立即切换到细调停充模式；、当电池电流IBAT小于粗细调界限电流IBAT_LIMIT或者电池电压达到模糊电池电压VBAT_UP减档充电电流切换过来的，系统开始细调。当电池电压VBAT达到预设的停充上限电压VBAT_SET_STOP_UP时，则控制充电电流档位减一个档位的电流，若电池电压VBAT小于停充下限电压VBAT_SET_STOP_DOWN，则控制充电电流档位增加一个档位的电流。当电池电流IBAT小于停充电流IBAT_STOP，且这个时候电池电压VBAT大于停充电压VBAT_SET_STOP，则认为电池已经充饱，可以正常停充，置停充标志位为1；、如果正确停充后，关闭充电使能，让充电电流为0，如果没有正确停充，则重新从步骤5开始。如图4和图5所示，图4是模拟电池停充的全局波形图，图5是模拟电池停充的局部波形图，设停充电压VBAT_SET_STOP为4050MV，停充电流IBAT_SET_STOP为200MA，假设此时电池电流IBAT为2200MA，内阻r为45毫欧，则有：VBAT_UP＝*r+VBAT_SET_STOP＝ *45/1000+4050＝4140MV，则有VBAT_SET_STOP_UP为4060MV，VBAT_SET_STOP_DOWN为4040MV。从图4可以看到，系统会直接把电池电压充到大于4140MV时，系统开始粗调，开始降充电电流档位，直到把电池电压拉下到4050MV以下，然后系统进入细调。从图5可以看到，当电池电压充到大于4060MV时，会减充电档位，从而把电池电压降下来，而当电池电压充到小于4040MV时，则会加充电档位，从而把电池电压升下来，最终电池会在大于4050MV且电池电流小于200MA的地方真正停止充电。另外，本实施例还建立一个统一的电池数据库，在电池数据库中记录并存储电池的生产、销售、使用、维护、回收、梯次利用等全生命周期的历史数据，并与电池的生产厂家、电池应用设备的生产厂家、电池维修厂家以及退运电池利用厂家建立数据采集和交换系统。本实施例还将每块电池在不同阶段的使用情况上传至电池数据库。具体地，将每块电池在出厂前的相关参数、出厂后不同阶段的使用情况和电池退役时的相关信息上传至电池数据库。然后，从电池数据库中获取所需电池的历史数据。根据实际需求，从电池数据库中获取所需要查找的电池的历史数据，并根据电池的历史数据来评估该电池的状态。可以看出，实施例通过将每块电池在不同阶段的使用情况上传至电池数据库，这样电池数据库能够完整记录并存储电池整个生命周期的数据，有效地保证电池的历史数据的完整和准确，解决了现有技术中电池的历史数据的保存不完整的问题，并且，电池数据库存储的各电池的历史数据为各电池的快速诊断和状态评估提供了必要的参数信息，有效地提高了诊断和评估的准确性，以及，只需根据实际需求即可从电池数据库中获取所需电池的历史数据，操作简单，同时，电池数据库还为电池所应用设备的所有人提供了电池采集和交换的平台。由此可见，本发明可以预先设置好系统装载停充电压、停充电流，停充电压误差，粗细调界限电流，模糊电池电压，充电档位，在开始充电时先给电池以最大充电电流开始恒流充电，并实时采集电池电压和电池电流来决定是否进行电池停充，在软件模拟电池停充时，系统分为粗调停充模式和细调停充模式两个过程，采用预先设置的两种停充模式调整停充的电压电流，从而实现对电池进行模拟停充，达到停充电压粗调整或细调整的效果，满足不同停充需求的场景。此外，本发明系统不仅具有电路结构简单、采用元件少、体积小、制作成本低和容易制作的特点，尤其自动停止充电性能稳定，有益于推广。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。上述实施方式仅为本发明的优选实施方式，不能以此来限定本发明保护的范围，本领域的技术人员在本发明的基础上所做的任何非实质性的变化及替换均属于本发明所要求保护的范围。
