标题title
一种基于区块链的多级供应链信用跨层级验证方法及系统
摘要abst
一种基于区块链的多级供应链信用跨层级验证方法，其特征在于，包括以下步骤：获取联盟链中上游企业与核心企业在合作过程中的所有交易信息，其中交易信息包括上游企业与核心企业之间的贸易单号、上游企业与中间企业之间的交易凭证和/或中间企业之间的交易凭证；对交易信息进行加密，并获取加密后交易信息的第一哈希值，将所有的第一哈希值作为Merkle树叶子节点，生成Merkle树的第一根哈希值，对作为Merkle树叶子节点的第一哈希值按位置进行保存，在本发明中存储的数据是加密数据的哈希，加上Merkle树的结构特性，可以保证在证明上游企业和核心企业之间存在交易往来的过程中，不会泄露中间企业的隐私贸易信息，甚至不会泄露该长链条交易过程中有哪些中间企业参与。
权利要求书clms
1.一种基于区块链的多级供应链信用跨层级验证方法，其特征在于，包括以下步骤：获取联盟链中上游企业与核心企业在合作过程中的所有交易信息，其中所述交易信息包括上游企业与核心企业之间的贸易单号、上游企业与中间企业之间的交易凭证和/或中间企业之间的交易凭证；对所述交易信息进行加密，并获取加密后所述交易信息的第一哈希值，将所有的所述第一哈希值作为Merkle树叶子节点，生成Merkle树的第一根哈希值，对作为Merkle树叶子节点的第一哈希值按位置进行保存；将上游企业与核心企业之间的贸易单号以及Merkle树的第一根哈希值组合生成一个新区块，并将所述新区块上链至区块链的末端；当接收到第三方的信用认证请求时，获取信用认证请求中的请求信息，其中所述请求信息包括上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号；根据所述贸易单号查找出区块链中对应的Merkle树的第一根哈希值；对上游企业与任一中间企业的交易凭证进行加密并求出其加密后的第二哈希值，根据在Merkle树的叶子节点数据，找出所述第二哈希值在叶子节点的位置，并通过其他第一哈希值与第二哈希值重新计算得到Merkle树的第二根哈希值；判断第一根哈希值与第二哈希值是否一致，若一致，则生成上游企业具有可信度的信用报告，若不一致，则出现上游企业不具备可信度的信用报告。2.根据权利要求2所述的一种基于区块链的多级供应链信用跨层级验证方法，其特征在于，所述第一哈希值还包括使用所述核心企业公钥加密后计算的哈希值。3.根据权利要求2所述的一种基于区块链的多级供应链信用跨层级验证方法，其特征在于，生成第一根哈希值或第二根哈希值的过程如下：步骤A：叶子节点中的第一哈希值和/或第二哈希值进行两两组合得到若干中间哈希值；步骤B：将所有的中间哈希值进行两两组合得到若干另一中间哈希值；重复步骤B直至剩下一个哈希值，将该哈希值作为第一根哈希值或第二根哈希值。4.根据权利要求1所述的一种基于区块链的多级供应链信用跨层级验证方法，其特征在于，对所述交易信息进行加密的具体方式如下：获取在交易中企业的公钥，使用交易中的企业公钥对对应的交易信息进行加密。5.根据权利要求1所述的一种基于区块链的多级供应链信用跨层级验证方法，其特征在于，对交易信息加密前还需对交易信息的真实性进行判断；其中判断的过程如下：获取该交易信息双方的企业名称，根据企业名称获取该企业在上传区块链时的交易信息；判断企业双方的交易信息是否一致，若一致，则表示该交易信息为真实，若不一致，则表明该交易信息为非真实信息。6.一种基于区块链的多级供应链信用跨层级验证系统，使用权利要求1～5任一项所述一种基于区块链的多级供应链信用跨层级验证方法，其特征在于，包括：信息获取模块、加密模块、区块生成模块、认证请求模块、查找模块以及结果判定模块；其中获取模块用于获取联盟链中上游企业与核心企业在合作过程中的所有交易信息；所述加密模块用于对所述交易信息进行加密，并获取加密后所述交易信息的第一哈希值，将所有的所述第一哈希值作为Merkle树叶子节点，生成Merkle树的第一根哈希值，对作为Merkle树叶子节点的第一哈希值按位置进行保存；所述区块生成模块用于将上游企业与核心企业之间的贸易单号以及Merkle树的第一根哈希值组合生成一个新区块，并将所述新区块上链至区块链的末端；所述认证请求模块用于接收到第三方的信用认证请求时，获取信用认证请求中的请求信息，其中所述请求信息包括上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号；所述查找模块用于根据所述贸易单号查找出区块链中对应的Merkle树的第一根哈希值；所述果判定模块用于对上游企业与任一中间企业的交易凭证进行加密并求出其加密后的第二哈希值，根据在Merkle树的叶子节点数据，找出所述第二哈希值在叶子节点的位置，并通过其他第一哈希值与第二哈希值重新计算得到Merkle树的第二根哈希值；判断第一根哈希值与第二哈希值是否一致，若一致，则生成上游企业具有可信度的信用报告，若不一致，则出现上游企业不具备可信度的信用报告。7.根据权利要求6所述的一种基于区块链的多级供应链信用跨层级验证系统，其特征在于，所述加密模块还包括公钥加密模块；所述公钥加密模块用于获取使用所述核心企业公钥加密后计算的哈希值。8.根据权利要求6所述的一种基于区块链的多级供应链信用跨层级验证系统，其特征在于，还包括根哈希值生成模块；所述根哈希值生成模块用于叶子节点中的第一哈希值和/或第二哈希值进行两两组合得到若干中间哈希值；将所有的中间哈希值进行两两组合得到若干另一中间哈希值，重复组合，直至剩下一个哈希值，将该哈希值作为第一根哈希值或第二根哈希值。9.根据权利要求6所述的一种基于区块链的多级供应链信用跨层级验证系统，其特征在于，还包括真实性判断模块；所述真实性判断模块用于获取该交易信息双方的企业名称，根据企业名称获取该企业在上传区块链时的交易信息；判断企业双方的交易信息是否一致，若一致，则表示该交易信息为真实，若不一致，则表明该交易信息为非真实信息。
说明书desc
技术领域本发明涉及区块链技术领域，特别是一种基于区块链的多级供应链信用跨层级验证方法及系统。背景技术随着社会经济的不断发展，绝大多数产业供应链上的参与节点越来越多，链条越来越长。在这种场景下，核心企业优质信用如何高效地传递到其2级甚至n级供应商，是一个十分重要的问题。区块链，是一种去中心化分布式的数字账本技术，具有去中心化、匿名性、不可篡改性等重要特征，同时支持智能合约技术。区块链技术能够保证上链数据的真实性以及不可篡改性，同时智能合约的应用也有助于链上数据权限的管理。区块链技术可以有效赋能供应链上的信用传递。在上述的多级供应链场景下，要想使用现有的供应链信用传递方法，将核心企业的优质信用传递到其他企业，信用需要经过供应链中间企业的层层传递。这种信用传递方法存在以下问题：上游企业在证明自己与核心企业存在交易时，需要提供与中间企业的交易信息，这会某种程度上泄露中间企业的隐私；为了保护中间企业的隐私，上游企业在证明自己与核心企业存在交易时，需要请求中间企业的协同证明，这会增加上游企业的融资成本，并降低信用传递和上游企业融资的效率。发明内容针对上述缺陷，本发明的目的在于提出一种基于区块链的多级供应链信用跨层级验证方法及系统，解决上游企业在进行信用证明时可能泄露中间企业信息以及证明时间长的问题。为达此目的，本发明采用以下技术方案：一种基于区块链的多级供应链信用跨层级验证方法，包括以下步骤：获取联盟链中上游企业与核心企业在合作过程中的所有交易信息，其中所述交易信息包括上游企业与核心企业之间的贸易单号、上游企业与中间企业之间的交易凭证和/或中间企业之间的交易凭证；对所述交易信息进行加密，并获取加密后所述交易信息的第一哈希值，将所有的所述第一哈希值作为Merkle树叶子节点，生成Merkle树的第一根哈希值，对作为Merkle树叶子节点的第一哈希值按位置进行保存；将上游企业与核心企业之间的贸易单号以及Merkle树的第一根哈希值组合生成一个新区块，并将所述新区块上链至区块链的末端；当接收到第三方的信用认证请求时，获取信用认证请求中的请求信息，其中所述请求信息包括上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号；根据所述贸易单号查找出区块链中对应的Merkle树的第一根哈希值；对上游企业与任一中间企业的交易凭证进行加密并求出其加密后的第二哈希值，根据在Merkle树的叶子节点数据，找出所述第二哈希值在叶子节点的位置，并通过其他第一哈希值与第二哈希值重新计算得到Merkle树的第二根哈希值；判断第一根哈希值与第二哈希值是否一致，若一致，则生成上游企业具有可信度的信用报告，若不一致，则出现上游企业不具备可信度的信用报告。优选的，所述第一哈希值还包括使用所述核心企业公钥加密后计算的哈希值。优选的，生成第一根哈希值或第二根哈希值的过程如下：步骤A：叶子节点中的第一哈希值和/或第二哈希值进行两两组合得到若干中间哈希值；步骤B：将所有的中间哈希值进行两两组合得到若干另一中间哈希值；重复步骤B直至剩下一个哈希值，将该哈希值作为第一根哈希值或第二根哈希值。优选的，对所述交易信息进行加密的具体方式如下：获取在交易中企业的公钥，使用交易中的企业公钥对对应的交易信息进行加密。优选的，对交易信息加密前还需对交易信息的真实性进行判断；其中判断的过程如下：获取该交易信息双方的企业名称，根据企业名称获取该企业在上传区块链时的交易信息；判断企业双方的交易信息是否一致，若一致，则表示该交易信息为真实，若不一致，则表明该交易信息为非真实信息。一种基于区块链的多级供应链信用跨层级验证系统，使用所述一种基于区块链的多级供应链信用跨层级验证方法，包括：信息获取模块、加密模块、区块生成模块、认证请求模块、查找模块以及结果判定模块；其中获取模块用于获取联盟链中上游企业与核心企业在合作过程中的所有交易信息；所述加密模块用于对所述交易信息进行加密，并获取加密后所述交易信息的第一哈希值，将所有的所述第一哈希值作为Merkle树叶子节点，生成Merkle树的第一根哈希值，对作为Merkle树叶子节点的第一哈希值按位置进行保存；所述区块生成模块用于将上游企业与核心企业之间的贸易单号以及Merkle树的第一根哈希值组合生成一个新区块，并将所述新区块上链至区块链的末端；所述认证请求模块用于接收到第三方的信用认证请求时，获取信用认证请求中的请求信息，其中所述请求信息包括上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号；所述查找模块用于根据所述贸易单号查找出区块链中对应的Merkle树的第一根哈希值；所述果判定模块用于对上游企业与任一中间企业的交易凭证进行加密并求出其加密后的第二哈希值，根据在Merkle树的叶子节点数据，找出所述第二哈希值在叶子节点的位置，并通过其他第一哈希值与第二哈希值重新计算得到Merkle树的第二根哈希值；判断第一根哈希值与第二哈希值是否一致，若一致，则生成上游企业具有可信度的信用报告，若不一致，则出现上游企业不具备可信度的信用报告。优选的，所述加密模块还包括公钥加密模块；所述公钥加密模块用于获取使用所述核心企业公钥加密后计算的哈希值。优选的，还包括根哈希值生成模块；所述根哈希值生成模块用于叶子节点中的第一哈希值和/或第二哈希值进行两两组合得到若干中间哈希值；将所有的中间哈希值进行两两组合得到若干另一中间哈希值，重复组合，直至剩下一个哈希值，将该哈希值作为第一根哈希值或第二根哈希值。优选的，还包括真实性判断模块；所述真实性判断模块用于获取该交易信息双方的企业名称，根据企业名称获取该企业在上传区块链时的交易信息；判断企业双方的交易信息是否一致，若一致，则表示该交易信息为真实，若不一致，则表明该交易信息为非真实信息。上述技术方案中的一个技术方案具有如下优点或有益效果：在本发明中存储的数据是加密数据的哈希值，加上Merkle树的结构特性，可以保证在证明上游企业和核心企业之间存在交易往来的过程中，不会泄露中间企业的隐私贸易信息，甚至不会泄露该长链条交易过程中有哪些中间企业参与。因此可以很好的实现隐私保护的要求的同时，证明上游企业与核心企业之间存在有合作。大大加快了上游企业的信用证明速度。附图说明图1是本发明方法的一个实施例的流程图；图2是本发明系统的一个实施例的结构示意图；图3是本发明的一个实施例中根哈希值的生成过程图。具体实施方式下面详细描述本发明的实施方式，实施方式的示例在附图中示出，其中，相同或类似的标号自始至终表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施方式是示例性的，仅用于解释本发明，而不能理解为对本发明的限制。在本发明的实施方式的描述中，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个所述特征。在本发明的实施方式的描述中，“多个”的含义是两个或两个以上，除非另有明确具体的限定。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本发明的描述中，除非另有说明，“多个”的含义是两个或两个以上。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。如图1～3所示，一种基于区块链的多级供应链信用跨层级验证方法，包括以下步骤：获取联盟链中上游企业与核心企业在合作过程中的所有交易信息，其中所述交易信息包括上游企业与核心企业之间的贸易单号、上游企业与中间企业之间的交易凭证和/或中间企业之间的交易凭证；对所述交易信息进行加密，并获取加密后所述交易信息的第一哈希值，将所有的所述第一哈希值作为Merkle树叶子节点，生成Merkle树的第一根哈希值，对作为Merkle树叶子节点的第一哈希值按位置进行保存；将上游企业与核心企业之间的贸易单号以及Merkle树的第一根哈希值组合生成一个新区块，并将所述新区块上链至区块链的末端；当接收到第三方的信用认证请求时，获取信用认证请求中的请求信息，其中所述请求信息包括上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号；根据所述贸易单号查找出区块链中对应的Merkle树的第一根哈希值；对上游企业与任一中间企业的交易凭证进行加密并求出其加密后的第二哈希值，根据在Merkle树的叶子节点数据，找出所述第二哈希值在叶子节点的位置，并通过其他第一哈希值与第二哈希值重新计算得到Merkle树的第二根哈希值；判断第一根哈希值与第二哈希值是否一致，若一致，则生成上游企业具有可信度的信用报告，若不一致，则出现上游企业不具备可信度的信用报告。在本发明中，参与交易的企业均需要加入到联盟链后，本发明所提供的方法才能有实现。其中在联盟链中，企业的每一笔交易都需要上链。而在本发明中，核心企业与上游企业进行合作后，其中任一一方可以发起用于生成证明其真实有效的新区块的请求；在发起请求后，联盟链中的智能合约会获取上游企业与核心企业在合作过程中的所有交易信息，例如上游企业与核心企业的贸易单号、上游企业与中间企业之间的交易凭证和/或中间企业之间的交易凭证。因为上游企业在完成该贸易单号时可能需要中间企业提供业务的帮助，所以所有交易信息中会包含有上游企业与中间企业的交易凭证。当获取所有的交易信息后，将所有的交易信息进行加密，增加信息的安全性，避免交易信息泄露。然后将所有加密后的交易信息计算获取得到对应的第一哈希值。然后根据Merkle树的特点，生成具有唯一性的第一根哈希值，并对第一根哈希值以及贸易单号进行组合，得到一个新区块。并将所述新区块上链至区块链的末端，利用区块链的不可篡改性质保证第一根哈希值的真实性。由于在本发明中，获取的交易信息是从联盟链中的区块链获取的，已经确保交易信息的真实有效。值得一提的是，由于本发明中企业之间存在有联盟链，在新区块上链时，需要将新区块中的内容公示给联盟链中其他节点，当其他节点认为信息没有问题后，所述新区块才能上链。而当上游企业需要进行融资或进行某个投资操作时，上游企业向金融机构证明自己与核心企业存在交易，而证明时还需要提供与中间企业的交易信息，这会某种程度上泄露中间企业的隐私。为此本发明，上游企业在金融机构证明时，需要上游企业向金融机构提供上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号，金融机构需要将上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号输入至智能合约中进行信用认证请求，此时智能合约会根据所述贸易单号找到区块链中包含有该贸易单号的区块，并获取该区块中是否存在有第一根哈希值。若存在有第一根哈希值，则通过上游企业与任一中间企业的交易凭证进行加密并求出其第二哈希值。由于在智能合约中存储有Merkle树叶子节点所有第一哈希值的信息，通过第二哈希值与第一哈希值的直接对比可以找到所述第二哈希值在Merkle树叶子节点的位置，再次通过所述第一哈希值与第二哈希值求出Merkle树的第二根哈希值，此时只需要判断第二跟哈希值与第一哈希值是否一致即可证明上游企业的可信度，同时也不会泄露中间企业的隐私。因为存储的数据是加密数据的哈希值，加上Merkle树的结构特性，可以保证在证明上游企业和核心企业之间存在交易往来的过程中，不会泄露中间企业的隐私贸易信息，甚至不会泄露该长链条交易过程中有哪些中间企业参与。因此可以很好的实现隐私保护的要求的同时，证明上游企业与核心企业之间存在有合作。大大加快了上游企业的信用证明速度。优选的，所述第一哈希值还包括使用所述核心企业公钥加密后计算的哈希值。优选的，生成第一根哈希值或第二根哈希值的过程如下：步骤A：叶子节点中的第一哈希值和/或第二哈希值进行两两组合得到若干中间哈希值；步骤B：将所有的中间哈希值进行两两组合得到若干另一中间哈希值；重复步骤B直至剩下一个哈希值，将该哈希值作为第一根哈希值或第二根哈希值。优选的，对所述交易信息进行加密的具体方式如下：获取在交易中企业的公钥，使用交易中的企业公钥对对应的交易信息进行加密。如图3所示，在一个实施例中，存在有若干个中间企业，在进行第一根哈希值的运算时，智能合约会获取每一个企业的交易凭证，例如以上游企业U与中间企业M1来说，存在有交易凭证U-M1，在智能合约获取交易信息时会同时获取上游企业U上传的交易凭证U-M1与中间企业上传的交易凭证U-M1，此时两个交易凭证U-M1由于由不同的企业上传，在加密时，需要使用对应上传其的企业公钥对交易凭证U-M1进行加密，分别得到两个加密后的U-M1加密数据，随后再分别对两个U-M1加密数据进行哈希值的求算。以此类推，所有的交易凭证均需要按照上述方式使用对应的企业公钥对交易信息进行加密后再进行哈希值的求取。值得一提的是，在本发明中还使用了核心企业公钥所求算的第一哈希值进行第一根哈希值的运算，以确保在贸易单号与核心企业的公钥之间存在关联，保证在该第一根哈希值能够在解析时可以证明核心企业确实存在在该次的交易中。当求出所有的第一哈希值后，会将所有的第一哈希值作为Merkle树叶子节点，进行第一根哈希值的求算，如图3所示，两个U-M1加密数据分别加运算成第一哈希值中的哈希值H1和哈希值H2，而其他的加密数据被运算为哈希值H3～哈希值Hn，哈希值H1～哈希值Hn为Merkle树叶子节点，此时只能合约会保存作为Merkle树叶子节点的所有第一哈希值的位置，而后对第一哈希值进行运输，其中，哈希值H1与哈希值H2结果，生产中间哈希值的哈希值H12，其他第一哈希值同样两两结合生成中间哈希值，重复此步骤，直到所有第一哈希值结合为一个哈希值，该哈希值就作为第一根哈希值。同理，在第二根哈希值的运输中采用同样的方式进行运送，由于智能合约保存了第一哈希值的位置，所以在通过第二哈希值进行第二根哈希值的运算是，不会搞乱第一哈希值之间的结合位置，从而影响判断的结果。优选的，对交易信息加密前还需对交易信息的真实性进行判断；其中判断的过程如下：获取该交易信息双方的企业名称，根据企业名称获取该企业在上传区块链时的交易信息；判断企业双方的交易信息是否一致，若一致，则表示该交易信息为真实，若不一致，则表明该交易信息为非真实信息。因为交易凭证是企业双方签署的，所以双方都保存有交易凭证。虽然在企业上传交易信息至联盟链的区块链时，会展示给其他联盟链的其他节点看，但是也可能存在有失误的情况。所以在对交易信息加密的前，需要判断交易信息的真实性，以防第一根哈希值的求算中使用了错误的交易信息，从而影响了第一跟哈希值所记载的信息真实性与可靠性。一种基于区块链的多级供应链信用跨层级验证系统，使用所述一种基于区块链的多级供应链信用跨层级验证方法，包括：信息获取模块、加密模块、区块生成模块、认证请求模块、查找模块以及结果判定模块；其中获取模块用于获取联盟链中上游企业与核心企业在合作过程中的所有交易信息；所述加密模块用于对所述交易信息进行加密，并获取加密后所述交易信息的第一哈希值，将所有的所述第一哈希值作为Merkle树叶子节点，生成Merkle树的第一根哈希值，对作为Merkle树叶子节点的第一哈希值按位置进行保存；所述区块生成模块用于将上游企业与核心企业之间的贸易单号以及Merkle树的第一根哈希值组合生成一个新区块，并将所述新区块上链至区块链的末端；所述认证请求模块用于接收到第三方的信用认证请求时，获取信用认证请求中的请求信息，其中所述请求信息包括上游企业与任一中间企业的交易凭证以及上游企业与核心企业之间的贸易单号；所述查找模块用于根据所述贸易单号查找出区块链中对应的Merkle树的第一根哈希值；所述果判定模块用于对上游企业与任一中间企业的交易凭证进行加密并求出其加密后的第二哈希值，根据在Merkle树的叶子节点数据，找出所述第二哈希值在叶子节点的位置，并通过其他第一哈希值与第二哈希值重新计算得到Merkle树的第二根哈希值；判断第一根哈希值与第二哈希值是否一致，若一致，则生成上游企业具有可信度的信用报告，若不一致，则出现上游企业不具备可信度的信用报告。优选的，所述加密模块还包括公钥加密模块；所述公钥加密模块用于获取使用所述核心企业公钥加密后计算的哈希值。优选的，还包括根哈希值生成模块；所述根哈希值生成模块用于叶子节点中的第一哈希值和/或第二哈希值进行两两组合得到若干中间哈希值；将所有的中间哈希值进行两两组合得到若干另一中间哈希值，重复组合，直至剩下一个哈希值，将该哈希值作为第一根哈希值或第二根哈希值。优选的，还包括真实性判断模块；所述真实性判断模块用于获取该交易信息双方的企业名称，根据企业名称获取该企业在上传区块链时的交易信息；判断企业双方的交易信息是否一致，若一致，则表示该交易信息为真实，若不一致，则表明该交易信息为非真实信息。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示意性实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不一定指的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任何的一个或多个实施例或示例中以合适的方式结合。尽管上面已经示出和描述了本发明的实施方式，可以理解的是，上述实施方式是示例性的，不能理解为对本发明的限制，本领域的普通技术人员在本发明的范围内可以对上述实施实施进行变化、修改、替换和变型。
