标题title
一种基于参数压缩的业务模型联合更新方法及系统
摘要abst
本说明书实施例提供一种基于参数压缩的业务模型联合更新方法及系统，在更新业务模型的方法中，服务器在判断本轮迭代的轮次为预设的目标轮次时，基于相邻两轮的学习率或者参数的变化幅度，判断模型更新过程是否进入到了关键阶段。在还没有进入关键阶段时，服务器向每个参与方发送对应于k个维度的k个指示信息，其中的每个指示信息是服务器根据从n个参与方接收的n份局部参数向量的每个维度的收敛情况确定的，用于指示在本轮以及后续的若干轮迭代中是否对对应维度进行压缩。由此使得每个参与方在本轮以及后续的若干轮迭代中，对确定的局部参数向量中已经收敛或接近收敛的维度进行压缩，并将得到的数据量变小的目标参数向量提供给服务器。
权利要求书clms
1.一种基于参数压缩的业务模型联合更新方法，涉及服务器和n个参与方；所述方法包括多轮迭代，其中任意的第t轮迭代包括：每个参与方i，根据本地样本集和业务模型的本地模型参数，确定具有k个维度的局部参数向量，并将其提供给所述服务器；所述服务器，在所述t等于预设的目标轮次的情况下，并行进行第一条件的判断和维度收敛检测；所述第一条件包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值；所述第t轮聚合参数向量，通过聚合所述n个参与方发送的n份局部参数向量而得到；所述维度收敛检测包括：对所述n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况；以及将每个维度j对应的信噪比与占比阈值进行大小比较，得到对应的指示信息，该指示信息用于指示在本轮以及后续的若干轮迭代中是否对维度j进行压缩处理；所述服务器，在所述第一条件不满足的情况下，向每个参与方i发送对应于所述k个维度的k个指示信息；每个参与方i，根据所述k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给所述服务器；所述服务器，基于所述n个参与方发送的n份目标参数向量，获取所述业务模型的第一更新参数，并将其下发至每个参与方i，以供每个参与方i基于所述第一更新参数，更新其本地模型参数，以用于下一轮迭代。2.根据权利要求1所述的方法，还包括：在所述第一条件满足的情况下，所述服务器基于所述n份局部参数向量，获取所述业务模型的第二更新参数，并将其下发至每个参与方i，以供每个参与方i基于所述第二更新参数，更新其本地模型参数，以用于下一轮迭代。3.根据权利要求1所述的方法，其中，所述目标距离，通过计算第t轮聚合参数向量与第t-1轮聚合参数向量的二阶范数距离，以及第t-1轮聚合参数向量的二阶范数后，再计算所述二阶范数距离与所述二阶范数之比而得到。4.根据权利要求1所述的方法，其中，所述确定对应于每个维度j的信噪比，包括：计算对应于每个维度j的平均值与方差值之比，得到对应于每个维度j的信噪比。5.根据权利要求1所述的方法，其中，所述k个指示信息中的每个指示信息，在对应维度的信噪比小于占比阈值的情况下为压缩指示，在对应维度的信噪比不小于占比阈值的情况下为不压缩指示。6.根据权利要求1所述的方法，其中，所述目标参数向量通过以下步骤获得：对于所述k个维度中的每个维度j，判断所述维度j对应的指示信息是压缩指示还是不压缩指示；在所述指示信息为压缩指示的情况下，对所述局部参数向量对应于维度j的元素值进行量化处理，得到量化值，作为处理结果；该量化值所含比特数小于所述元素值所含比特数；在所述指示信息为不压缩指示的情况下，保留所述局部参数向量对应于维度j的元素值，作为处理结果；基于所述k个维度中各个维度各自对应的处理结果，形成所述目标参数向量。7.根据权利要求1所述的方法，其中，所述目标参数向量通过以下步骤获得：对于所述k个维度中的每个维度j，判断所述维度j对应的指示信息是压缩指示还是不压缩指示；在所述指示信息为压缩指示的情况下，判断所述局部参数向量对应于维度j的元素值是否小于元素值阈值，如果是，则将0作为处理结果，否则将所述元素值作为处理结果；在所述指示信息为不压缩指示的情况下，保留所述局部参数向量对应于维度j的元素值，作为处理结果；基于所述k个维度中各个维度各自对应的处理结果，形成所述目标参数向量。8.根据权利要求1所述的方法，其中，所述获取所述业务模型的第一更新参数，包括：聚合所述n份目标参数向量，得到更新的第t轮聚合参数向量；将所述业务模型的全局模型参数减去所述更新的第t轮聚合参数向量与第t轮学习率的乘积，得到所述业务模型的第一更新参数。9.根据权利要求1所述的方法，其中，所述局部参数向量包括梯度向量或模型参数向量。10.一种基于参数压缩的业务模型联合更新系统，包括服务器和n个参与方；每个参与方i，用于根据本地样本集和业务模型的本地模型参数，确定具有k个维度的局部参数向量，并将其提供给所述服务器；所述服务器，用于在所述t等于预设的目标轮次的情况下，并行进行第一条件的判断和维度收敛检测；所述第一条件包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值；所述第t轮聚合参数向量，通过聚合所述n个参与方发送的n份局部参数向量而得到；所述维度收敛检测包括：对所述n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况；以及将每个维度j对应的信噪比与占比阈值进行大小比较，得到对应的指示信息，该指示信息用于指示在本轮以及后续的若干轮迭代中是否对维度j进行压缩处理；所述服务器，还用于在所述第一条件不满足的情况下，向每个参与方i发送对应于所述k个维度的k个指示信息；每个参与方i，还用于根据所述k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给所述服务器；所述服务器，还用于基于所述n个参与方发送的n份目标参数向量，获取所述业务模型的第一更新参数，并将其下发至每个参与方i，以供每个参与方i基于所述第一更新参数，更新其本地模型参数，以用于下一轮迭代。
说明书desc
技术领域本说明书一个或多个实施例涉及机器学习领域，尤其涉及一种基于参数压缩的业务模型联合更新方法及系统。背景技术大宗商品供应链集成服务企业集团因产业多元化、业务规模庞大，且覆盖采购、制造、分销、仓储、物流、配送、融资等集成服务全流程，沉淀、积累了海量的业务数据和财务数据，为充分挖掘数据价值赋能业务运营提高企业效率，我们会基于海量的业务数据和财务数据，采用分布式学习的方法来更新业务模型。在这种情况下，多参与方联合更新模型是最广泛采用的方法，需要在每轮迭代中结合各梯度或者模型参数更新。然而在如此大的参数范围内频繁传递参数会影响模型的更新效率。因此，如何在大规模集群中，高效更新模型成为重点关注的问题。为了缓解通信瓶颈，部分方案提出增加样本批量的大小，即由每个参与方基于大批量样本计算参数，从而减少每轮迭代的通信频率。本方案中，对模型更新过程中的关键阶段进行识别，从而在保证模型精度的同时，大幅度降低通信量。发明内容本说明书一个或多个实施例描述了一种基于参数压缩的业务模型联合更新方法及系统，可以在保证模型精度的同时，大幅度降低通信量。第一方面，提供了一种基于参数压缩的业务模型联合更新方法，包括：每个参与方i，根据本地样本集和业务模型的本地模型参数，确定具有k个维度的局部参数向量，并将其提供给所述服务器；所述服务器，在所述t等于预设的目标轮次的情况下，并行进行第一条件的判断和维度收敛检测；所述第一条件包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值；所述第t轮聚合参数向量，通过聚合所述n个参与方发送的n份局部参数向量而得到；所述维度收敛检测包括：对所述n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况；以及将每个维度j对应的信噪比与占比阈值进行大小比较，得到对应的指示信息，该指示信息用于指示在本轮以及后续的若干轮迭代中是否对维度j进行压缩处理；所述服务器，在所述第一条件不满足的情况下，向每个参与方i发送对应于所述k个维度的k个指示信息；每个参与方i，根据所述k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给所述服务器；所述服务器，基于所述n个参与方发送的n份目标参数向量，获取所述业务模型的第一更新参数，并将其下发至每个参与方i，以供每个参与方i基于所述第一更新参数，更新其本地模型参数，以用于下一轮迭代。第二方面，提供了一种基于参数压缩的业务模型联合更新系统，包括：每个参与方i，用于根据本地样本集和业务模型的本地模型参数，确定具有k个维度的局部参数向量，并将其提供给所述服务器；所述服务器，用于在所述t等于预设的目标轮次的情况下，并行进行第一条件的判断和维度收敛检测；所述第一条件包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值；所述第t轮聚合参数向量，通过聚合所述n个参与方发送的n份局部参数向量而得到；所述维度收敛检测包括：对所述n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况；以及将每个维度j对应的信噪比与占比阈值进行大小比较，得到对应的指示信息，该指示信息用于指示在本轮以及后续的若干轮迭代中是否对维度j进行压缩处理；所述服务器，还用于在所述第一条件不满足的情况下，向每个参与方i发送对应于所述k个维度的k个指示信息；每个参与方i，还用于根据所述k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给所述服务器；所述服务器，还用于基于所述n个参与方发送的n份目标参数向量，获取所述业务模型的第一更新参数，并将其下发至每个参与方i，以供每个参与方i基于所述第一更新参数，更新其本地模型参数，以用于下一轮迭代。本说明书一个或多个实施例提供的基于参数压缩的业务模型联合更新方法及系统，服务器在判断本轮迭代的轮次为预设的目标轮次的情况下，基于相邻两轮的学习率或者参数的变化幅度，判断模型更新过程是否进入到了关键阶段。在还没有进入关键阶段时，服务器向每个参与方发送对应于k个维度的k个指示信息，其中的每个指示信息是服务器根据从n个参与方接收的n份局部参数向量的每个维度的收敛情况确定的，用于指示在本轮以及后续的若干轮迭代中是否对对应维度进行压缩。由此使得每个参与方在本轮以及后续的若干轮迭代中，对确定的局部参数向量中已经收敛或接近收敛的维度进行压缩，并将得到的数据量变小的目标参数向量提供给服务器。由此可以实现在保证模型精度的同时，大幅度降低通信量。附图说明为了更清楚地说明本说明书实施例的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本说明书的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1示出根据一个实施例的基于参数压缩的业务模型联合更新系统示意图之一；图2示出根据一个实施例的基于参数压缩的业务模型联合更新方法交互图；图3示出根据一个实施例的基于参数压缩的商品推荐模型联合更新方法交互图；图4示出根据一个实施例的基于参数压缩的业务模型联合更新系统示意图之二。具体实施方式下面结合附图，对本说明书提供的方案进行描述。图1示出根据一个实施例的基于参数压缩的业务模型联合更新系统示意图之一。图1中，该系统包括服务器和n个参与方，其中，n为正整数。各参与方可以实现为任何具有计算、处理能力的设备、平台、服务器或设备集群。该服务器包括关键阶段识别装置、收敛检测装置、压缩装置和更新装置。图1中，参与方1-参与方n中的每个参与方i，可以根据其本地样本集和业务模型的本地模型参数，确定对应的具有k个维度的局部参数向量，并将其提供给服务器。其中，k为正整数。这里的业务模型用于预测业务对象的分类或回归值。其中的业务对象例如可以为图片、文本、用户或者商品等。其中，i为正整数，且1≤i≤n。服务器在接收到n个参与方发送的n份局部参数向量后，可以先判断本轮迭代的轮次是否为预设的目标轮次，如果是，则通过其中的关键阶段识别装置进行第一条件的判断，以及通过其中的收敛检测装置进行维度收敛检测。应理解，这里的第一条件的判断和维度收敛检测可以并行执行。需要说明，上述的第一条件的判断是用于识别模型更新过程的关键阶段。该第一条件包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值。该第t轮聚合参数向量，通过聚合n个参与方发送的n份局部参数向量而得到。也就是说，本方案是基于相邻两轮的学习率或者参数的变化幅度，来识别模型更新过程是否进入到了关键阶段。上述的维度收敛检测具体可以包括：对n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况。其中，j为正整数，且1≤j≤k。上述的维度收敛检测还包括：基于针对每个维度j确定的信噪比，获取对应的指示信息，如此得到对应于k个维度的k个指示信息。以k个维度中任意的第一维度为例来说，如果对应于第一维度的信噪比小于占比阈值，则确定对应于第一维度的指示信息为压缩。而如果对应于第一维度的信噪比不小于占比阈值，则确定对应于第一维度的指示信息为不压缩。在第一条件不满足的情况下，或者说，在模型更新过程未进入到关键阶段的情况下，通过压缩装置，向每个参与方i发送该k个指示信息。每个参与方i，根据接收的k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给服务器。服务器通过其中的更新装置，基于n个参与方发送的n份目标参数向量，获取业务模型的第一更新参数，并将其下发至每个参与方i，以供每个参与方i基于第一更新参数，更新其本地模型参数，以用于下一轮迭代。应理解，在进入下一轮迭代后，每个参与方i在计算得到局部参数向量之后，根据接收的k个指示信息，对局部参数向量的每个维度j进行压缩或不压缩处理，直至到达压缩结束条件。这里的压缩结束条件包括，接收到更新的k个指示信息或停止压缩指示，或者，满足迭代结束条件等。需要说明，在服务器通过关键阶段识别装置识别还没有进入关键阶段时，服务器向每个参与方发送对应于k个维度的k个指示信息，以指示每个参与方在本轮以及后续的若干轮迭代中对对应维度进行压缩。由于压缩后的参数量小于压缩前的参数量，从而本方案可以减小参与方与服务器之间传输的数据量。此外，由于上述的压缩处理是指非关键阶段执行的，从而不会影响模型的精度。也就是说，本方案可以在保证模型精度的同时，大幅度降低通信量。图2示出根据一个实施例的基于参数压缩的业务模型联合更新方法交互图。需要说明，该方法涉及多轮迭代，图2中示出其中第t轮迭代包括的交互步骤，并且，因参与第t轮迭代的各个参与方与服务器的交互过程相近，所以图2中主要示出参与该第t轮迭代的任一个参与方与服务器的交互步骤，参与该轮迭代的其它参与方与服务器的交互步骤，可以参见该第一参与方与服务器的交互步骤。如图2所示，该方法可以包括如下步骤：步骤202，每个参与方i根据本地样本集和业务模型的本地模型参数，确定具有k个维度的局部参数向量，并将其提供给服务器。以任一参与方为例来说，其维护的本地样本集中的样本所对应的业务对象，可以包括以下中的任一种：图片、文本、用户以及商品等。此外，上述业务模型可以分类模型或回归模型，用于预测上述业务对象的分类或回归值。在一个实施例中，该业务模型可以基于决策树算法、贝叶斯算法等实现，在另一个实施例中，该业务模型可以基于神经网络实现。需要说明，当第t轮迭代为首轮迭代时，上述本地模型参数可以是由服务器在多轮迭代开始之前，对业务模型进行初始化，然后将初始化的模型参数下发或提供给各参与方，从而各参与方可以将上述初始化的模型参数作为本地模型参数。当然，在实际应用中，也可以是由各参与方先约定好模型的结构，之后再进行相同的初始化，以得到各自的本地模型参数。当第t轮迭代为非首轮迭代时，上述本地模型参数可以是在第t-1轮迭代中更新得到。最后，上述局部参数向量可以包括梯度向量或模型参数向量，关于局部参数向量的确定可参考现有技术。以梯度向量为例来说，其确定方法可以如下：可以先根据本地样本集以及本地模型参数，确定预测结果，再根据预测结果以及样本标签，确定预测损失。最后，再根据预测损失，并利用反向传播法，确定本地模型参数对应的梯度向量。应理解，在实际应用中，上述局部参数向量的确定方法也包括多轮迭代，具体地的迭代轮次可以预先设定。步骤204，服务器在判断t等于预设的目标轮次的情况下，并行进行第一条件的判断和维度收敛检测。应理解，上述t即为本轮迭代的轮次。在实际应用中，上述预设的目标轮次可以为多个。在预设的目标轮次为多个的情况下，可以将t依次与每个预设的目标轮次进行比对，以判断t是否等于预设的目标轮次。上述的第一条件的判断也可以理解为是对模型更新过程的关键阶段进行识别。该第一条件可以包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值。在机器学习中，梯度下降是一个广泛被用来最小化模型误差的参数优化算法。梯度下降法通过多轮迭代，并在每一轮迭代中最小化损失函数来估计模型参数。在梯度下降法中，通常会给定统一的学习率，该学习率用于在迭代过程中控制模型的学习进度。通常而言，在前期的迭代中，学习率较大，从而前进的步长会较长，这时便能以较快的速度进行梯度下降。而在后期的迭代中，逐步减小学习率，以减小学习步长，这样有助于模型的收敛，更容易接近最优解。故而本方案，基于相邻两轮的学习率的变化幅度，来识别关键阶段。具体地，在第t+1轮学习率与第t轮学习率之比小于学习率阈值时，判定为第一条件满足，也即进入模型更新过程的关键阶段。参照前述的学习率设定方法，可以得出本方案是将后期的迭代作为模型更新过程的关键阶段。此外，本方案还基于相邻两轮参数的变化幅度，来识别关键阶段。具体地，在第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值时，判定为第一条件满足，也即进入模型更新过程的关键阶段。也就是说，本方案是将参数变化幅度较大的迭代作为模型更新过程的关键阶段。上述的第t轮聚合参数向量，通过聚合n个参与方发送的n份局部参数向量而得到。在一个示例中，通过对n份局部参数向量求和，得到第t轮聚合参数向量。上述的第t-1轮聚合参数向量与第t轮聚合参数向量的计算方法相似，其是通过聚合n个参与方在第t-1轮发送的n份局部参数向量而得到。在一个示例中，上述目标距离，通过计算第t轮聚合参数向量与第t-1轮聚合参数向量的二阶范数距离，以及第t-1轮聚合参数向量的二阶范数后，再计算二阶范数距离与二阶范数之比而得到。具体的计算公式可以如下：其中，d为目标距离，gradt为第t轮聚合参数向量，gradt-1为第t-1轮聚合参数向量。总之，在相邻两轮学习率之比小于学习率阈值，或者，在相邻两轮聚合参数向量的目标距离不小于距离阈值的情况下，判定第一条件满足，也即进入模型更新过程的关键阶段，否则判定第一条件不满足。步骤204中的维度收敛检测可以包括：对n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况。也即针对k个维度中的每个维度，对n份局部参数向量对应于该维度的n个元素值进行求平均和求方差，得到k个维度对应的k个平均值和k个方差值。之后，可以计算每个维度j对应的1个平均值和1个方差值之比，得到每个维度j对应的信噪比。这里k个维度对应的k个信噪比可以形成信噪比向量。接着，对于每个维度j对应的信噪比，可以将该信噪比与对应的占比阈值进行比较，如果小于占比阈值，则说明该维度已经进入了平稳阶段，接近收敛，从而将对应于该维度的指示信息确定为压缩指示。而如果不小于占比阈值，则说明该维度还在动态变化中，未收敛，从而将对应于该维度的指示信息确定为不压缩指示。在针对每个维度j，确定对应的指示信息之后，就可以得到对应于k个维度的k个指示信息，每个指示信息用于指示在本轮以及后续的若干轮迭代中是否对对应维度进行压缩处理。换句话说，每个参与方i在本轮以及后续的若干轮迭代中，根据该k个指示信息，确定是否对所确定的n份局部参数向量的每个维度进行压缩或不压缩处理。步骤206，服务器在第一条件不满足的情况下，向每个参与方i发送对应于k个维度的k个指示信息。换句话说，服务器在识别模型更新过程还未进入到关键阶段时，向每个参与方i发送对应于k个维度的k个指示信息，以便于每个参与方i根据该k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理。而在识别模型更新过程进入到关键阶段时，不发送对应于k个维度的k个指示信息。也即，维度收敛检测的结果在第一条件不满足的情况下才被使用。步骤208，每个参与方i根据k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给服务器。在一个示例中，上述目标参数向量通过以下步骤获得：对于k个维度中的每个维度j，判断维度j对应的指示信息是压缩指示还是不压缩指示。在该指示信息为压缩指示的情况下，对局部参数向量对应于维度j的元素值进行量化处理，得到量化值，作为处理结果。该量化值所含比特数小于元素值所含比特数。在该指示信息为不压缩指示的情况下，保留局部参数向量对应于维度j的元素值，作为处理结果。基于k个维度中各个维度各自对应的处理结果，形成目标参数向量。在一个例子中，上述量化处理可以包括：将维度j对应的元素值转换为整数，然后从末尾开始截取预定数目个比特作为对应的量化值。当然，在实际应用中，还可以通过其它量化处理方法，获取对应于任一维度的量化值，本说明书对此不作限定。在另一个示例中，上述目标参数向量通过以下步骤获得：对于k个维度中的每个维度j，判断维度j对应的指示信息是压缩指示还是不压缩指示。在该指示信息为压缩指示的情况下，判断局部参数向量对应于维度j的元素值是否小于元素值阈值，如果是，则将0作为处理结果，否则将元素值本身作为处理结果。在该指示信息为不压缩指示的情况下，保留局部参数向量对应于维度j的元素值，作为处理结果。基于k个维度中各个维度各自对应的处理结果，形成目标参数向量。步骤210，服务器基于n个参与方发送的n份目标参数向量，获取业务模型的第一更新参数，并将其下发至每个参与方i，以供每个参与方i基于第一更新参数，更新其本地模型参数，以用于下一轮迭代。在一个示例中，上述获取业务模型的第一更新参数，包括：聚合n份目标参数向量，得到更新的第t轮聚合参数向量。将业务模型的全局模型参数减去更新的第t轮聚合参数向量与第t轮学习率的乘积，得到业务模型的第一更新参数。其中，上述聚合n份目标参数向量可以包括：对n份目标参数向量进行求平均或者求加权平均，得到更新的第t轮聚合参数向量。在一个例子中，可以参照如下公式得到业务模型的第一更新参数。其中， wt为第一更新参数，wt-1为服务器当前维护的全局模型参数。ηt为第t轮学习率，也称学习步长，n为目标参数向量的数目，mi为第i个目标参数向量。应理解，在获取到上述第一更新参数之后，服务器可以利用该第一更新参数，更新其当前维护的全局模型参数，从而得到更新的全局模型参数，以用于下一轮迭代。此外，每个参与方i在接收到上述第一更新参数后，可以利用该第一更新参数，更新其本地维护的本地模型参数，从而得到更新的本地模型参数，以用于下一轮迭代。应理解，由于在第t轮迭代中接收到了k个指示信息，因此在进入下一轮迭代后，每个参与方i根据本地样本集和更新的本地模型参数，确定第t+1轮局部参数向量后，基于在第t轮接收的k个指示信息，对第t+1轮局部参数向量的每个维度j进行压缩或不压缩处理，得到第t+1轮目标参数向量，并将其提供给服务器。之后，服务器可以聚合n个参与方发送的n份第t+1轮目标参数向量，得到第t+1轮更新参数，并将其下发至每个参与方i，从而服务器和每个参与方i进行第t+1轮模型参数的更新；依次类推，直至到达压缩结束条件。这里的压缩结束条件包括，接收到更新的k个指示信息或停止压缩指示，或者，满足迭代结束条件等。需要说明，由于在从第t轮开始的各轮迭代中，每个参与方i向服务器发送相比于初始的局部参数向量数据量较小的目标参数向量，从而本方案可以减小在模型更新过程中参与方与服务器之间的数据传输量，进而可以提升数据传输效率，这有助于提升模型更新效率。以上对在第一条件满足的情况下，也即在非关键阶段，第t轮模型参数的更新方法进行了说明。在第一条件不满足的情况下，也即在关键阶段，直接利用每个参与方i发送的局部参数向量，进行第t轮模型参数的更新。也即在关键阶段，不对每个参与方的局部参数向量的各个维度进行压缩处理，从而使得该局部参数向量包含更多有用的信息，进而不会影响模型更新的过程。上述直接利用每个参与方i发送的局部参数向量，进行第t轮模型参数的更新，包括: 服务器基于n份局部参数向量，获取业务模型的第二更新参数，并将其下发至每个参与方i，以供每个参与方i基于第二更新参数，更新其本地模型参数，以用于下一轮迭代。当然，在实际应用中，如果识别为关键阶段，服务器可以指示各参与方针对各自的局部参数向量进行低压缩比的压缩，本说明书对此不作限定。这里的第二更新参数的获取方法可以参照上述公式2，本说明书在此不复赘述。还需要说明，在步骤204中，如果服务器判断t不等于预设的目标轮次，或者说，判断本轮迭代的轮次不等于预设的目标轮次，那么步骤206-步骤210可以替换为：服务器基于n个参与方发送的n份局部参数向量，获取业务模型的其它更新参数，并将其下发至每个参与方i，以供每个参与方i基于其它更新参数，更新其本地模型参数，以用于下一轮迭代。最后，在多轮迭代后，每个参与方i将其得到的本地模型参数，作为其与其它参与方协同更新的业务模型。以任一参与方为例来说，在其本地样本集中的样本对应的业务对象为图片的情况下，那么其与其它参与方协同更新的业务模型可以为图片识别模型。在其本地样本集中的样本对应的业务对象为文本的情况下，那么其与其它参与方协同更新的业务模型可以为文本识别模型。在其本地样本集中的样本对应的业务对象为商品和用户的情况下，那么其与其它参与方协同更新的业务模型可以为商品推荐模型等等。综上，本说明书实施例提供的基于参数压缩的业务模型联合更新方法，可以对模型更新过程中的关键阶段进行识别，当识别进入关键阶段时，为了避免影响模型参数收敛，尽可能减少对参与方待传输参数的压缩。而当识别进入非关键阶段时，尽可能提高对参与方待传输参数的压缩，降低通信量。并且从识别到参数的压缩是自动执行的，从而提高了决策的自动程度。此外，服务器基于维度收敛检测的结果，向每个参与方发送k个指示信息，可以实现对参与方参数压缩的自动控制。此外，本方案自动识别出模型更新的关键阶段，从而采取合适的压缩措施，避免了盲目压缩带来的模型精度的损失，甚至因为盲目压缩使得模型参数不收敛。通过本方案的自动识别方法，使得参与方能够在必要情况下压缩通信，降低通信量，提升模型更新速度，并且提高了模型更新的可扩展性，可以支持更大规模的集群，更大规模的模型大小。总之，本方案是一种自适应自动切换压缩与不压缩参数的方法，且通过在关键阶段选择低压缩和其它地方的高压缩，可以大幅度降低通信量，并且保证了模型参数收敛的精度和效果。以下以业务模型为商品推荐模型为例，对本方案进行说明。图3示出根据一个实施例的基于参数压缩的商品推荐模型联合更新方法交互图。需要说明，该方法涉及多轮迭代，图3中示出其中第t轮迭代包括的交互步骤，并且，因参与第t轮迭代的各个参与方与服务器的交互过程相近，所以图3中主要示出参与该第t轮迭代的任一个参与方与服务器的交互步骤，参与该轮迭代的其它参与方与服务器的交互步骤，可以参见该第一参与方与服务器的交互步骤。如图3所示，该方法可以包括如下步骤：步骤302，每个参与方i根据本地样本集和商品推荐模型的本地模型参数，确定具有k个维度的局部参数向量，并将其提供给服务器。上述本地样本集中的样本所对应的业务对象包括用户和商品，样本的特征包括用户属性、操作行为和商品属性。步骤304，服务器在判断t等于预设的目标轮次的情况下，并行进行第一条件的判断和维度收敛检测。上述第一条件包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值。该第t轮聚合参数向量，通过聚合n个参与方发送的n份局部参数向量而得到。上述维度收敛检测包括：对n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况；以及将每个维度j对应的信噪比与占比阈值进行比对，得到对应的指示信息，该指示信息用于指示在本轮以及后续的若干轮迭代中是否对维度j进行压缩处理。步骤306，服务器在第一条件不满足的情况下，向每个参与方i发送对应于k个维度的k个指示信息。步骤308，每个参与方i根据k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给服务器。步骤310，服务器基于n个参与方发送的n份目标参数向量，获取商品推荐模型的第一更新参数，并将其下发至每个参与方i，以供每个参与方i基于该第一更新参数，更新其本地模型参数，以用于下一轮迭代。在多轮迭代后，每个参与方i将其得到的本地模型参数，作为其与其它参与方协同更新的商品推荐模型。综上，本说明书实施例提供的基于参数压缩的商品推荐模型联合更新方法，可以在节约通信资源的情况下，对商品推荐模型进行更新。与上述基于参数压缩的业务模型联合更新方法对应地，本说明书一个实施例还提供的一种基于参数压缩的业务模型联合更新系统，如图4所示，该系统可以包括：服务器402和n个参与方404。每个参与方404，用于根据本地样本集和业务模型的本地模型参数，确定具有k个维度的局部参数向量，并将其提供给服务器402。其中，该局部参数向量包括梯度向量或模型参数向量。服务器402，用于在t等于预设的目标轮次的情况下，并行进行第一条件的判断和维度收敛检测。其中，第一条件包括：第t+1轮学习率与第t轮学习率之比小于学习率阈值，或者，第t轮聚合参数向量与第t-1轮聚合参数向量的目标距离不小于距离阈值。该第t轮聚合参数向量，通过聚合n个参与方404发送的n份局部参数向量而得到。其中，上述目标距离，通过计算第t轮聚合参数向量与第t-1轮聚合参数向量的二阶范数距离，以及第t-1轮聚合参数向量的二阶范数后，再计算该二阶范数距离与该二阶范数之比而得到。上述维度收敛检测包括：对n份局部参数向量对应于每个维度j的n个元素值进行求平均和求方差，并根据对每个维度j计算的平均值和方差值，确定对应于每个维度j的信噪比，该信噪比用于指示对应维度的收敛情况；以及将每个维度j对应的信噪比与占比阈值进行大小比较，得到对应的指示信息，该指示信息用于指示在本轮以及后续的若干轮迭代中是否对维度j进行压缩处理。其中，上述确定对应于每个维度j的信噪比，包括：计算对应于每个维度j的平均值与方差值之比，得到对应于每个维度j的信噪比。此外，上述每个指示信息，在对应维度的信噪比小于占比阈值的情况下为压缩指示，在对应维度的信噪比不小于占比阈值的情况下为不压缩指示。服务器402，还用于在第一条件不满足的情况下，向每个参与方404发送对应于k个维度的k个指示信息。每个参与方404，还用于根据k个指示信息，对对应的局部参数向量的每个维度j进行压缩或不压缩处理，得到目标参数向量，并将其提供给服务器402。在一个示例中，每个参与方404具体用于：对于k个维度中的每个维度j，判断维度j对应的指示信息是压缩指示还是不压缩指示。在指示信息为压缩指示的情况下，对局部参数向量对应于维度j的元素值进行量化处理，得到量化值，作为处理结果。该量化值所含比特数小于所述元素值所含比特数。在指示信息为不压缩指示的情况下，保留局部参数向量对应于维度j的元素值，作为处理结果。基于k个维度中各个维度各自对应的处理结果，形成目标参数向量。在另一个示例中，每个参与方404具体用于：对于k个维度中的每个维度j，判断维度j对应的指示信息是压缩指示还是不压缩指示。在指示信息为压缩指示的情况下，判断局部参数向量对应于维度j的元素值是否小于元素值阈值，如果是，则将0作为处理结果，否则将元素值作为处理结果。在指示信息为不压缩指示的情况下，保留局部参数向量对应于维度j的元素值，作为处理结果。基于k个维度中各个维度各自对应的处理结果，形成目标参数向量。服务器402，还用于基于n个参与方404发送的n份目标参数向量，获取业务模型的第一更新参数，并将其下发至每个参与方404，以供每个参与方404基于第一更新参数，更新其本地模型参数，以用于下一轮迭代。服务器402具体用于：聚合n份目标参数向量，得到更新的第t轮聚合参数向量。将业务模型的全局模型参数减去更新的第t轮聚合参数向量与第t轮学习率的乘积，得到业务模型的第一更新参数。可选地，服务器402，还用于在第一条件满足的情况下，基于n份局部参数向量，获取业务模型的第二更新参数，并将其下发至每个参与方404，以供每个参与方404基于第二更新参数，更新其本地模型参数，以用于下一轮迭代。本说明书上述实施例装置的各功能模块的功能，可以通过上述方法实施例的各步骤来实现，因此，本说明书一个实施例提供的装置的具体工作过程，在此不复赘述。本说明书一个实施例提供的基于参数压缩的业务模型联合更新系统，可以在节约通信资源的情况下，对业务模型进行更新。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于系统实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。结合本说明书公开内容所描述的方法或者算法的步骤可以硬件的方式来实现，也可以是由处理器执行软件指令的方式来实现。软件指令可以由相应的软件模块组成，软件模块可以被存放于RAM存储器、闪存、ROM存储器、EPROM存储器、EEPROM存储器、寄存器、硬盘、移动硬盘、CD-ROM或者本领域熟知的任何其它形式的存储介质中。一种示例性的存储介质耦合至处理器，从而使处理器能够从该存储介质读取信息，且可向该存储介质写入信息。当然，存储介质也可以是处理器的组成部分。处理器和存储介质可以位于ASIC中。另外，该ASIC可以位于服务器中。当然，处理器和存储介质也可以作为分立组件存在于服务器中。本领域技术人员应该可以意识到，在上述一个或多个示例中，本发明所描述的功能可以用硬件、软件、固件或它们的任意组合来实现。当使用软件实现时，可以将这些功能存储在计算机可读介质中或者作为计算机可读介质上的一个或多个指令或代码进行传输。计算机可读介质包括计算机存储介质和通信介质，其中通信介质包括便于从一个地方向另一个地方传送计算机程序的任何介质。存储介质可以是通用或专用计算机能够存取的任何可用介质。上述对本说明书特定实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。以上所述的具体实施方式，对本说明书的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上所述仅为本说明书的具体实施方式而已，并不用于限定本说明书的保护范围，凡在本说明书的技术方案的基础之上，所做的任何修改、等同替换、改进等，均应包括在本说明书的保护范围之内。
