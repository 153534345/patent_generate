标题title
一种基于物联网应用服务系统的数据管理方法
摘要abst
本发明涉及数据处理领域，具体涉及一种基于物联网应用服务系统的数据管理方法，包括：根据待分析数据序列与标准数据序列得到距离集合，进而得到待分析时间段；根据待分析时间段得到第一临时序列以及第二临时序列；根据路程长度差异以及第一临时序列、第二临时序列的趋势变化次数得到初始变化趋势差异，结合时间差距离得到最终变化趋势差异；确定校正系数，进而得到相似程度；结合存储天数得到清除系数，进而对待分析数据序列进行清除。本发明可以使物联网应用服务系统对重要的异常数据进行长期存储，对冗余的无效数据及时精准的进行清除。
权利要求书clms
1.一种基于物联网应用服务系统的数据管理方法，其特征在于，该方法包括以下步骤：获取待分析数据序列以及标准数据序列；获取待分析数据序列与标准数据序列的最佳匹配路径，根据最佳匹配路径得到距离集合；根据距离集合得到距离变化曲线，根据距离变化曲线上的各个数据点得到待分析时间段；将待分析时间段在待分析数据序列、标准数据序列中对应数据构成的序列分别称为第一临时序列以及第二临时序列；根据第一、二临时序列对应的各个数据点分别得到第一、二临时序列的向量集合以及参照向量；根据第一、二临时序列的向量集合中各个向量的聚类结果得到第一路程长度以及第二路程长度；根据第一、二临时序列的参照向量得到第一临时序列的所属侧以及第二临时序列的所属侧；根据第一路程长度、第二路程长度、第一临时序列的所属侧与第二临时序列的所属侧得到待分析时间段对应的路程长度差异；根据第一临时序列与第二临时序列对应的向量集合中各个向量与相邻向量所属聚类结果，得到时间差距离以及第一临时序列、第二临时序列的趋势变化次数；根据路程长度差异以及第一临时序列与第二临时序列的趋势变化次数得到初始变化趋势差异；根据时间差距离以及初始变化趋势差异得到待分析时间段对应的最终变化趋势差异；根据所有待分析时间段的最终变化趋势差异、时间长度、第一临时序列中所有数据的均值与第二临时序列中所有数据的均值得到校正系数；根据校正系数以及距离集合得到相似程度；根据相似程度以及存储天数得到清除系数；根据清除系数对待分析数据序列进行清除；所述路程长度差异的获取方法为：当第一临时序列的所属侧与第二临时序列的所属侧相同时，路程长度差异为第一路程长度与第二路程长度之间差值的绝对值；否则，路程长度差异为第一路程长度与第二路程长度之间的加和结果；所述初始变化趋势差异的获取表达式为：其中，为初始变化趋势差异；D表示路程长度差异；/＞和/＞分别表示第一临时序列与第二临时序列的趋势变化次数；所述校正系数的获取表达式为：其中，P为校正系数；表示第j个待分析时间段的最终变化趋势差异，/＞表示第j个待分析时间段的时间长度；/＞和/＞分别表示第j个待分析时间段对应第一临时序列与第二临时序列中所有数据的平均值，m为待分析时间段的个数，/＞为以自然常数为底数的指数函数；所述相似程度的获取表达式为：其中，R为待分析数据序列与标准数据序列的相似程度，P表示校正系数，为距离集合中的第i个距离值，n为距离集合中包含的距离值的个数，/＞为以自然常数为底数的指数函数；清除系数计算公式为：其中，T表示清除系数，R为待分析数据序列与标准数据序列的相似程度，其值越小越重要，需要长期存储，K为待分析数据序列已保留的天数；其中，根据清除系数对待分析数据序列进行清除，包括：将所述清除系数大于清除阈值的所述待分析数据序列进行清除。2.根据权利要求1所述的一种基于物联网应用服务系统的数据管理方法，其特征在于，所述根据距离变化曲线上的各个数据点得到待分析时间段的获取步骤包括：获取距离变化曲线的所有波峰点，以距离集合中所有数据的平均值为距离阈值，将纵坐标大于距离阈值的波峰点所处的波峰区域为一个待分析时间段。3.根据权利要求2所述的一种基于物联网应用服务系统的数据管理方法，其特征在于，所述波峰区域的获取步骤包括：对于任意一个波峰点，以距离波峰点最近的两个波谷点为波峰区域的两个端点，这两个端点之间的所有数据点构成了一个波峰区域。4.根据权利要求1所述的一种基于物联网应用服务系统的数据管理方法，其特征在于，所述第一、二临时序列的向量集合以及参照向量的获取方法为：以第一临时序列中各个数据点为向量起点，以各个数据点的相邻数据点为向量终点得到各个数据点对应的向量；第一临时序列中所有数据点对应的向量构成了第一临时序列的向量集合；将以第一临时序列中的第一个数据点为向量起点，以最后一个数据点为向量终点构成的向量作为第一临时序列的参照向量；以第二临时序列中各个数据点为向量起点，以各个数据点的相邻数据点为向量终点得到各个数据点对应的向量；第二临时序列中所有数据点对应的向量构成了第二临时序列的向量集合；将以第二临时序列中的第一个数据点为向量起点，以最后一个数据点为向量终点构成的向量作为第二临时序列的参照向量。5.根据权利要求1所述的一种基于物联网应用服务系统的数据管理方法，其特征在于，所述第一路程长度和所述第二路程长度的获取方法为：将第一临时序列中各个聚类结果包含的所有向量之和作为各个聚类结果对应的累加向量，将各个聚类结果对应的累加向量之间的夹角作为第一路程长度；将第二临时序列中各个聚类结果包含的所有向量之和作为各个聚类结果对应的累加向量，将各个聚类结果对应的累加向量之间的夹角作为第二路程长度。6.根据权利要求1所述的一种基于物联网应用服务系统的数据管理方法，其特征在于，所述第一临时序列的所属侧和所述第二临时序列的所属侧的获取方法为：以第一临时序列的参照向量所在的直线为分界线，统计第一临时序列中各个数据点在分界线上方区域与下方区域中的数据点的个数，将最大的数据点个数所在的区域作为第一临时序列的所属侧；以第二临时序列的参照向量所在的直线为分界线，统计第二临时序列中各个数据点在分界线上方区域与下方区域中的数据点的个数，将最大的数据点个数所在的区域作为第二临时序列的所属侧。
说明书desc
技术领域本发明涉及数据处理领域，具体涉及一种基于物联网应用服务系统的数据管理方法。背景技术物联网是通过识别感知和网络通信，将不同的信息传感设备与互联网相结合，形成了能够在各种场景下连接人、机、物的巨大网络，以实现智能化识别、定位、跟踪、监管等功能。随着物联网技术在绿色农业、工业监控和环境监测等领域的应用日益广泛，传感器、摄像头等不同类型的数据采集设备数量快速增长，使得数据库中存储的数据量也飞速增加。为了确保数据库的存储空间始终保持一定的可用容量，数据库会根据保留天数自动清除过期数据。然而在许多场景下数据采集设备每日采集的数据存在较大的重复性，如车间温度、设备运行数据等，只有出现异常时，当日采集的数据才会出现较大的变化，而这些异常数据往往是我们需要进行分析的重要数据。若只根据保留天数进行数据清除，易导致异常的重要数据被清除，而每日重复出现的正常数据被大量保存。因此精准的清除冗余的无效数据是物联网应用服务系统数据管理的关键之一。发明内容本发明提供一种基于物联网应用服务系统的数据管理方法，以解决现有的问题。本发明的一种基于物联网应用服务系统的数据管理方法采用如下技术方案：本发明一个实施例提供了一种基于物联网应用服务系统的数据管理方法，该方法包括以下步骤：获取待分析数据序列以及标准数据序列；获取待分析数据序列与标准数据序列的最佳匹配路径，根据最佳匹配路径得到距离集合；根据距离集合得到距离变化曲线，根据距离变化曲线上的各个数据点得到待分析时间段；将待分析时间段在待分析数据序列、标准数据序列中对应数据构成的序列分别称为第一临时序列以及第二临时序列；根据第一、二临时序列对应的各个数据点分别得到第一、二临时序列的向量集合以及参照向量；根据第一、二临时序列的向量集合中各个向量的聚类结果得到第一路程长度以及第二路程长度；根据第一、二临时序列的参照向量得到第一临时序列的所属侧以及第二临时序列的所属侧；根据第一路程长度、第二路程长度、第一临时序列的所属侧与第二临时序列的所属侧得到待分析时间段对应的路程长度差异；根据第一临时序列与第二临时序列对应的向量集合中各个向量与相邻向量所属聚类结果，得到时间差距离以及第一临时序列、第二临时序列的趋势变化次数；根据路程长度差异以及第一临时序列与第二临时序列的趋势变化次数得到初始变化趋势差异；根据时间差距离以及初始变化趋势差异得到待分析时间段对应的最终变化趋势差异；根据所有待分析时间段的最终变化趋势差异、时间长度、第一临时序列中所有数据的均值与第二临时序列中所有数据的均值得到校正系数；根据校正系数以及距离集合得到相似程度；根据相似程度以及存储天数得到清除系数；根据清除系数对待分析数据序列进行清除。优选的，所述根据距离变化曲线上的各个数据点得到待分析时间段的获取步骤包括：获取距离变化曲线的所有波峰点，以距离集合中所有数据的平均值为距离阈值，将纵坐标大于距离阈值的波峰点所处的波峰区域为一个待分析时间段。优选的，所述波峰区域的获取步骤包括：对于任意一个波峰点，以距离波峰点最近的两个波谷点为波峰区域的两个端点，这两个端点之间的所有数据点构成了一个波峰区域。优选的，所述第一、二临时序列的向量集合以及参照向量的获取方法为：以第一临时序列中各个数据点为向量起点，以各个数据点的相邻数据点为向量终点得到各个数据点对应的向量；第一临时序列中所有数据点对应的向量构成了第一临时序列的向量集合；将以第一临时序列中的第一个数据点为向量起点，以最后一个数据点为向量终点构成的向量作为第一临时序列的参照向量；以第二临时序列中各个数据点为向量起点，以各个数据点的相邻数据点为向量终点得到各个数据点对应的向量；第二临时序列中所有数据点对应的向量构成了第二临时序列的向量集合；将以第二临时序列中的第一个数据点为向量起点，以最后一个数据点为向量终点构成的向量作为第二临时序列的参照向量。优选的，所述第一路程长度和所述第二路程长度的获取方法为：将第一临时序列中各个聚类结果包含的所有向量之和作为各个聚类结果对应的累加向量，将各个聚类结果对应的累加向量之间的夹角作为第一路程长度；将第二临时序列中各个聚类结果包含的所有向量之和作为各个聚类结果对应的累加向量，将各个聚类结果对应的累加向量之间的夹角作为第二路程长度。优选的，所述第一临时序列的所属侧和所述第二临时序列的所属侧的获取方法为：以第一临时序列的参照向量所在的直线为分界线，统计第一临时序列中各个数据点在分界线上方区域与下方区域中的数据点的个数，将最大的数据点个数所在的区域作为第一临时序列的所属侧；以第二临时序列的参照向量所在的直线为分界线，统计第二临时序列中各个数据点在分界线上方区域与下方区域中的数据点的个数，将最大的数据点个数所在的区域作为第二临时序列的所属侧。优选的，所述路程长度差异的获取方法为：当第一临时序列的所属侧与第二临时序列的所属侧相同时，路程长度差异为第一路程长度与第二路程长度之间差值的绝对值；否则，路程长度差异为第一路程长度与第二路程长度之间的加和结果。优选的，所述初始变化趋势差异的获取表达式为：其中，为初始变化趋势差异；D表示路程长度差异；和分别表示第一临时序列与第二临时序列的趋势变化次数。优选的，所述校正系数的获取表达式为：其中，P为校正系数；表示第j个待分析时间段的最终变化趋势差异，表示第j个待分析时间段的时间长度；和分别表示第j个待分析时间段对应第一临时序列与第二临时序列中所有数据的平均值，m为待分析时间段的个数，为以自然常数为底数的指数函数。优选的，所述相似程度的获取表达式为：其中R为待分析数据序列与标准数据序列的相似程度，P表示校正系数，为距离集合中的第i个距离值，n为距离集合中包含的距离值的个数，为以自然常数为底数的指数函数。优选的，清除系数计算公式为：其中，T表示清除系数，R为待分析数据序列与标准数据序列的相似程度，其值越小越重要，需要长期存储，K为待分析数据序列已保留的天数；优选的，根据清除系数对待分析数据序列进行清除，包括：将所述清除系数大于清除阈值的所述待分析数据序列进行清除。本发明的有益效果是：首先根据DTW算法获取待分析数据序列与标准数据序列的最佳匹配路径，根据最佳匹配路径获取距离集合，从而获取标准数据序列以及待分析数据序列中的不相似的时间段，也就是待分析时间段，而DTW算法在这些待分析时间段内只会根据欧氏距离进行失真匹配，强行降低待分析数据序列与标准数据序列在这些待分析时间段内的DTW距离，导致标准数据序列与待分析数据序列的相似程度相对于实际相似程度会偏高，因此本发明根据待分析时间段内，标准数据序列以及待分析数据序列存在的相同特征，分析标准数据序列与待分析数据序列之间的趋势变化差异以及实际的数据值差异，获取待分析时间段内实际的相似程度，并以此为DTW距离的校正系数，从而准确的获取标准数据序列以及待分析数据序列的相似程度，最后结合存储天数判断待分析数据序列是否需要清除，使得数据库可以对重要的异常数据进行长期存储，对冗余的无效数据及时精准的进行清除。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明的一种基于物联网应用服务系统的数据管理方法的步骤流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种基于物联网应用服务系统的数据管理方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种基于物联网应用服务系统的数据管理方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种基于物联网应用服务系统的数据管理方法的步骤流程图，该方法包括以下步骤：步骤S001：获取标准数据序列以及待分析数据序列。在物联网技术的应用领域中许多场景下数据采集设备每日采集的数据重复出现，如农业大棚内的温度、湿度和工厂设备运行数据等，以工厂设备运行数据为例，在无故障的情况下，两日内的设备运行数据变化相似，若出现故障，则当日设备运行数据会出现较大的变化，而这些异常数据往往是本实施例需要进行分析的重要数据。若只根据保留天数进行数据清除，易导致异常的重要数据被清除，而每日重复出现的正常数据被大量保存。故本实施例根据每日采集数据的异常程度，结合保留天数，设置清除阈值，对重要的异常数据长期存储，而对冗余的无效数据及时精准清除。已知物联网设备中获取的数据为模式自由不断产生的流式数据，即时序数据；因此在判断某一日期内由工厂设备产生的时序数据是否需要清除时，以该日期为目标日期，首先获取目标日期内产生时序数据，并将该时序数据称为待分析数据序列；然后人工选取设备正常运行的一天内产生的时序数据，将所得时序数据称为标准数据序列，用以作为待分析数据序列的异常程度的参考数据，即通过分析待分析数据序列与标准数据序列之间的相似性，来判断待分析数据序列的异常程度。步骤S002：根据第一临时序列以及第二临时序列分别对应的向量集合以及参照向量，得到第一路程长度、第二路程长度、第一临时序列的所属侧与第二临时序列的所属侧，进而得到路程长度差异以及时间差距离；结合第一临时序列、第二临时序列的趋势变化次数，得到初始变化趋势差异。1、利用DTW算法获取待分析数据序列与标准数据序列的对应关系，阈值分割获取标准数据序列以及待分析数据序列中待分析时间段。当目标日期内工厂设备出现故障，所得待分析数据序列与标准数据序列会存在较大的差异，而DTW算法利用欧氏距离要求所有的数据点都必须匹配，且匹配应具有连续性，导致时序数据中不相似部分的匹配失真较为严重，则在计算这些不相似部分之间的相似性的过程中必然存在偏差。本实施例通过提取出待分析数据序列与标准数据序列中待分析时间段，将这些待分析时间段作为本实施例的各个待分析时间段，通过对各个待分析时间段内的特征进行量化分析，根据量化结果来调整DTW距离，从而获取各个待分析时间段更加准确的相似程度。具体过程如下：首先使用DTW算法对标准数据序列以及待分析数据序列进行匹配，其中DTW算法为公知技术，其原理是根据一个序列中的各个数据到另一个序列中各个数据之间的距离构建距离矩阵，然后在这个距离矩阵中寻找从这两个序列的起点到这两个序列终点之间的最小距离路径，本实施例将标准数据序列与待分析数据序列对应的最小距离路径称为最佳匹配路径，记最佳匹配路径上对应的各个欧氏距离构成了距离集合A，则，其中为最佳匹配路径上第i个距离值，n为距离集合中包含的距离值的个数；然后以距离集合A中各个距离值在距离集合中的序号为横轴，以各个距离值的大小为纵轴，利用最小二乘法对距离集合A中的各个距离值进行曲线拟合，得到距离变化曲线，则距离变化曲线上第i个数据点的坐标可以表示为；由于在两个时序数据变化较为相似的时间段内，距离变化曲线的对应区域接近直线，而在两个时序数据变化不相似的时间段，距离变化曲线的对应区域表现为波峰状；因此获取距离变化曲线上的各个波峰点以及波谷点，以距离集合A中所有数据的均值为距离阈值，波峰点的纵坐标大于距离阈值的波峰点所处的波峰区域为标准数据序列与待分析数据序列变化不相似的时间段，即本实施例的各个待分析时间段。其中波峰区域的获取过程为：对于任意一个波峰点，以距离该波峰点最近的两个波谷点为波峰区域的两个端点，则这两个端点之间的所有数据点构成了一个波峰区域，对各个波峰点进行处理，得到各个波峰区域。纵坐标大于距离阈值的各个波峰点所处的波峰区域在待分析数据序列中对应数据的采集时刻构成了本实施例的各个待分析时间段；各个待分析时间段在待分析数据序列、标准数据序列中对应数据分别构成了本实施例的各个第一临时序列以及各个第二临时序列。2、对待分析时间段内的特征进行量化分析。由于DTW算法会在标准数据序列以及待分析数据序列中不相似的时间段内进行失真匹配，来强行降低此区域的DTW距离，使得最终的相似性结果偏高，因此本实施例根据各个待分析时间段内，第一临时序列与第二临时序列的变化趋势之间的差异以及数据值之间的差异，获取各个待分析时间段对应的相似程度，以此为DTW距离的校正系数。对于任意一个待分析时间段对应的第一临时序列以及第二临时序列，标准数据序列在该待分析时间段内的起点、终点与待分析数据序列在该待分析时间段内的起点、终点之间的欧氏距离较小，即这两对数据点应处于重合或接近于重合的状态，此时在该待分析时间段内，标准数据序列对应的所有相邻数据点的向量累加和，应与待分析数据序列对应的所有相邻数据点的向量累加和之间的大小一致，因此可通过该一致特征来分析标准数据序列与待分析数据序列的差异特征；则对于任意一个待分析时间段，首先获取待分析数据序列在该待分析时间段内的相邻数据点的向量，即首先获取该待分析时间段对应的第一临时序列中相邻数据点形成的向量，例如对于第一临时序列的第k个数据点，与该数据点相邻的数据点为第k+1个数据点，则第k个数据点对应的向量为以该第k个数据点为向量起点，第k+1个数据点为向量终点构成的向量；由此得到在该待分析时间段内，待分析数据序列对应的向量集合，即第一临时序列对应的向量集合；再以该第一临时序列中的第一个数据点为向量起点，以最后一个数据点为向量的终点，将所得向量作为第一临时序列的参照向量；此时，向量集合中所有向量之和等于，且向量集合中所有向量可以被划分为两类：远离参照向量和靠近参照向量；因此本实施例使用K-means聚类算法对向量集合中的各个向量进行聚类，并设置K-means聚类算法的聚类结果个数为2，由此得到两个聚类结果；然后分别计算各个聚类结果中包含的所有向量之和，将这两个聚类结果对应的向量之和分别记为累加向量和，当和的夹角越大时，表示从第一临时序列中第一个数据点到最后一个数据点的过程中，存在与参照向量偏离程度较大的数据点，对应从第一数据点到最后一个数据点所经过的路程越长，因此和的夹角也可以表示第一临时序列中数据点经过的路程长度，故本实施例将和之间的夹角记为第一路程长度。同理，根据标准数据序列在该待分析时间段内对应的第二临时序列得到第二路程长度。然后以第一临时序列的参照向量所在的直线为分界线，获取第一临时序列中处于分界线下方区域的数据点个数以及处于分界线上方区域的数据点个数，将与最大值对应的区域作为第一临时序列的所属侧；同理，根据第二临时序列的参照向量得到第二临时序列的所属侧。由此获取标准数据序列以及待分析数据序列在该待分析时间段内对应数据点所经过的路程长度差异D为：其中，和分别为第一路程长度以及第二路程长度；和分别表示第一临时序列的所属侧以及第二临时序列的所属侧。当时，表示在该待分析时间段内，第一临时序列与第二临时序列中大部分数据点处于对应分界线的同一侧，说明此时第一临时序列以及第二临时序列中数据点变化的整体趋势较为相同，故用表示经过的路程长度差异；而当时，表示在该待分析时间段内，第一临时序列与第二临时序列中大部分数据点相对于对应分界线的不同侧，说明此时第一临时序列以及第二临时序列中数据点变化的整体趋势相反，故此时用表示经过的路程长度差异。已知第一临时序列对应的向量集合中的向量被划分为两个聚类结果，将向量集合中与相邻向量不为同一聚类结果的向量个数称为第一临时序列的趋势变化次数，表示该待分析时间段对应的第一临时序列中所有数据点的转折次数，用以表征第一临时序列中数据点的变化趋势，例如对于向量和，当与其相邻向量不属于同一聚类结果时，认为为一个趋势发生变化的向量，否则，认为不是一个趋势发生变化的向量。同理，将该待分析时间段对应的第二临时序列的趋势变化次数为，用以表征第二临时序列中数据点的变化趋势；则在该待分析时间段内，待分析数据序列对应的第一临时序列与标准数据序列对应的第二临时序列之间的初始变化趋势差异F可以表示为：其中D表示第一临时序列与第二临时序列之间的路程长度差异；和分别表示第一临时序列与第二临时序列的趋势变化次数。D体现了第一临时序列与第二临时序列中数据点整体变化趋势之间的差异，表示第一临时序列与第二临时序列中数据点的变化趋势改变次数之间的差异，两者的值越大，则标准数据序列以及待分析数据序列在该待分析时间段内数据点的变化趋势之间的差异越明显，因此本实施例通过综合第一临时序列与第二临时序列的路程长度差异以及趋势变化次数之间的差异来表示标准数据序列以及待分析数据序列在该待分析时间段内数据点变化趋势之间的差异。步骤S003：根据时间差距离以及初始变化趋势差异得到待分析时间段对应的最终变化趋势差异；根据所有待分析时间段的最终变化趋势差异、时间长度、第一临时序列中所有数据的均值与第二临时序列中所有数据的均值得到校正系数，进而得到相似程度。由于初始变化趋势差异F的获取只考虑了该待分析时间段对应的第一临时序列与第二临时序列中数据整体变化趋势和局部变化趋势改变的次数，未考虑标准数据序列以及待分析数据序列中趋势变化时对应的时间信息，因此第一临时序列与第二临时序列的初始变化趋势差异F仍然存在误差，需要根据标准数据序列以及待分析数据序列中各局部变化趋势改变时的时间变化对F进行校正。故分别获取该待分析时间段对应的第一临时序列与第二临时序列中出现趋势变化的各个数据点的采集时刻，得到第一趋势变化序列以及第二趋势变化序列，再利用DTW算法获取第一趋势变化序列与第二趋势变化序列之间的时间差距离，本实施例将该时间差距离记为G，由此得到第一临时序列与第二临时序列之间的最终变化趋势差异为：其中F表示第一临时序列与第二临时序列之间的初始变化趋势差，G表示第一临时序列与第二临时序列之间的时间差距离；G的值越大，对应第一临时序列与第二临时序列中发生趋势变化的数据点之间的时间差越大，故本实施例以时间差距离G为初始变化趋势差异F的校正系数，用以获取第一临时序列与第二临时序列之间真正的变化趋势之间的差异，也就是第一临时序列与第二临时序列之间的最终变化趋势差异。对标准数据序列以及待分析数据序列中所有的待分析时间段进行处理，得到所有待分析时间段对应的最终变化趋势差异。由于DTW算法会在标准数据序列以及待分析数据序列中不相似的时间段内进行失真匹配，来强行降低此区域的DTW距离，使得最终的相似性结果偏高。因此本实施例通过计算标准数据序列以及待分析数据序列中各个待分析时间段之间的不相似程度，并将所得不相似程度作为DTW距离的校正系数。则标准数据序列以及待分析数据序列DTW距离的校正系数P为：其中，P为校正系数；表示第j个待分析时间段的最终变化趋势差异，表示第j个待分析时间段的时间长度；和分别表示第j个待分析时间段对应第一临时序列与第二临时序列中所有数据的平均值，m为待分析时间段的个数，为以自然常数为底数的指数函数。表示第j个待分析时间段对应的第一临时序列与第二临时序列之间的最终变化趋势差异，即第j个待分析时间段对应的最终变化趋势差异；表示第j个待分析时间段对应的第一临时序列与第二临时序列中数据值之间的差异，即第j个待分析时间段对应的数据值差异；将两者的乘积表示第j个待分析时间段对应的第一临时序列与第二临时序列之间不相似程度，其值越大，说明该待分析时间段内的DTW距离的可信度越低，且DTW距离偏低，即此时失真匹配的程度越大，故需要较大的校正系数，本实施例根据所有待分析时间段对应的最终变化趋势差异以及对应的数据值差异来获取标准数据序列以及待分析数据序列DTW距离的校正系数。根据校正系数以及最佳匹配路径上的各个距离值得到标准数据序列以及待分析数据序列的相似程度R为：其中R为待分析数据序列与标准数据序列的相似程度，P表示标准数据序列以及待分析数据序列DTW距离的校正系数，为距离集合中的第i个距离值，n为距离集合中包含的距离值的个数，为以自然常数为底数的指数函数；为标准数据序列以及待分析数据序列的DTW距离，其值越小，标准数据序列以及待分析数据序列相似程度越大；当存在失真匹配时，会使得待分析数据序列与标准数据序列在待分析时间段内对应的第一临时序列、第二临时序列中的DTW距离偏小，即失真匹配会使相似程度增加，此时如果校正系数较大时，说明此时的相似程度越不可靠，需要校正的程度也越大，从而降低相似程度；即校正系数的大小与相似程度呈负相关关系，DTW距离也与相似程度呈负相关关系。步骤S004：根据相似程度以及存储天数得到清除系数；根据清除系数对待分析数据序列进行清除。当待分析数据序列与标准数据序列的相似程度越小，表示此时待分析数据序列出现异常的概率越大，对应待分析数据序列越重要，越需要进行长期存储，考虑到现有的数据库管理方式会对保留时间较长的数据进行自动清除，此时待分析数据序列的清除系数T为：其中T表示清除系数，R为待分析数据序列与标准数据序列的相似程度，其值越小越重要，需要长期存储，K为待分析数据序列已保留的天数，其值越小，需要清除的概率越小。本实施例设置清除阈值为0.9，实施者可根据实际需求自行设定，则当T＞0.9时，清除待分析数据序列，否则保留待分析数据序列。同理判断其它日期对应的时序数据是否需要清除，从而实现物联网应用服务系统的高效数据管理。本实施例首先根据DTW算法获取待分析数据序列与标准数据序列的最佳匹配路径，根据最佳匹配路径获取距离集合，从而获取标准数据序列以及待分析数据序列中的不相似的时间段，也就是待分析时间段，而DTW算法在这些待分析时间段内只会根据欧氏距离进行失真匹配，强行降低待分析数据序列与标准数据序列在这些待分析时间段内的DTW距离，导致标准数据序列与待分析数据序列的相似程度相对于实际相似程度会偏高，因此本实施例根据待分析时间段内，标准数据序列以及待分析数据序列存在的相同特征，分析标准数据序列与待分析数据序列之间的趋势变化差异以及实际的数据值差异，获取待分析时间段内实际的相似程度，并以此为DTW距离的校正系数，从而准确的获取标准数据序列以及待分析数据序列的相似程度，最后结合存储天数判断待分析数据序列是否需要清除，使得数据库可以对重要的异常数据进行长期存储，对冗余的无效数据及时精准的进行清除。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
