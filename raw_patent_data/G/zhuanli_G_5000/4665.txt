标题title
基于时频分析的跳频信号检测与参数估计方法及系统
摘要abst
本发明公开了基于时频分析的跳频信号检测与参数估计方法及系统，属于电磁频谱监测技术领域，方法包括对跳频信号的时频图像进行双门限阈值分割处理、连通区域标记处理，得到连通域图像的特征信息；根据连通域图像的长度特征对连通域进行粗聚类；对粗聚类结果进行细分聚类处理；最后根据连通域图像对跳速、幅度、带宽、驻留时间、跳频频率集等任一参数或多个参数进行估计。本发明通过时频图像的起始坐标特征对粗聚类结果进行细分聚类处理，相较现有聚类方法时间复杂度大大降低，聚类效率高；同时基于第一差值对临时跳周期求余处理，能够适用于所有聚类场景，进一步提高了检测效率，分选出相同跳速、不同起跳时间的跳频网台。
权利要求书clms
1.基于时频分析的跳频信号检测与参数估计方法，其特征在于：其包括以下步骤：对跳频信号的时频图像进行双门限阈值分割处理、连通区域标记处理，得到连通域图像的特征信息，所述特征信息包括长度特征；根据连通域图像的长度特征对连通域进行粗聚类，得到不同跳速的粗聚类结果；所述方法还包括细分聚类步骤，包括以下子步骤：根据连通域图像的起始坐标特征，对粗聚类结果进行细分聚类处理，进而实现对跳速相同、起跳时间不同的网台的分选；所述方法还包括对参数估计步骤，具体包括以下子步骤：根据各组分类结果中连通域图像的长度特征估计跳频信号的驻留时间；和/或，根据各组分类结果中连通域图像的起始坐标特征估计跳频信号的跳周期及跳速；和/或，根据各组分类结果中连通域图像的高度特征估计跳频信号的带宽；和/或，根据各组分类结果中连通域图像的幅值特征估计跳频信号的幅度；和/或，根据各组分类结果中连通域图像的质心特征估计跳频信号的频率集；最后上报不同跳速的跳频信号粗聚类结果和/或跳速相同但起跳时间不同的细分聚类结果，以及对跳速、幅度、带宽、驻留时间、跳频频率集等任一参数或多个参数组合的参数估计结果；所述细分聚类处理包括以下子步骤：根据时频图像的起始坐标特征对粗聚类结果进行排序，得到坐标特征序列和对应的连通域标签序列；计算起始坐标特征的差分结果的均值，得到临时跳周期；选取任意一起始坐标特征作为基准值，计算当前起始坐标特征与基准值的第一差值，并对第一差值与临时跳周期进行求余计算，得到求余结果；比较求余结果与第二阈值的大小，或比较临时跳周期与求余结果的第二差值与第二阈值的大小，并结合坐标特征序列对应的连通域标签实现细分聚类处理。2.根据权利要求1所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：所述双门限阈值分割处理包括以下子步骤：根据下发的第一上门限、第一下门限对时频图像进行双门限阈值分割处理；和/或，计算时频图像的能量分布数，根据能量分布数获取去噪门限值，将去噪门限值作为第二下门限，并令最大像素值为第二上门限，根据第二上门限、第二下门限对时频图像进行双门限阈值分割处理。3.根据权利要求2所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：所述根据第一上门限、第一下门限对时频图像进行双门限阈值分割处理的计算式为：其中，B1表示双门限阈值分割结果；i1,m1分别表示时频图像X2的长度值、宽度值；thresholdH表示上门限，本示例中指第一上门限；thresholdL表示下门限，本示例中指第一下门限。4.根据权利要求2所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：所述第二门限的计算公式为：th＝j*0.1*Pj＝1,2,3,…,n其中，P表示总能量；N、M均为求和符号上界，分别表示时频图像X2的长度最大值和宽度最大值；i、m均为求和符号下界，分别表示时频图像X2的长度起始值和宽度起始值；th表示去噪门限；j表示迭代次数；C表示能量分布数；对能量分布数进行二次差分处理，并求其拐点，将将拐点处对应的系数k作为噪声系数，对应th的值作为第二阈值下限。5.根据权利要求1所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：所述驻留时间的预估计算公式为：其中，Tr表示预估的驻留时间；长度特征序列lk为，k为序号。6.根据权利要求1所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：所述跳周期及跳速的预估计算公式为：Vh＝1/Th其中，Th为表示预估的跳周期；Vh表示预估的跳速；初始坐标特征序列为{,,…,}，k为序号。7.根据权利要求1所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：所述带宽的预估计算公式为：其中，B表示预估的带宽；fs表示采样率；高度特征序列bk为，k为序号。8.根据权利要求1所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：在幅度估计步骤中，每一跳信号的幅度为质心在时频矩阵中对应位置的值。9.根据权利要求1所述的基于时频分析的跳频信号检测与参数估计方法，其特征在于：所述频率计的预估计算公式为：fk＝xkfs/N2其中，fk表示预估的跳频频率；fs表示采样率；N2为短时傅里叶变换步长；质心特征序列xk为{,,…,}，k为序号。10.基于时频分析的跳频信号检测与参数估计系统，其特征在于：所述系统包括：图像处理单元，用于对跳频信号的时频图像进行双门限阈值分割处理、连通区域标记处理，得到连通域图像的特征信息，包括长度特征；信号盲检测单元，用于根据连通域图像的长度特征对连通域进行粗聚类，得到不同跳速的粗聚类结果；细分聚类单元，用于根据连通域图像的起始坐标特征，对粗聚类结果进行细分聚类处理，进而实现对跳速相同、起跳时间不同的网台的分选；所述细分聚类处理包括以下子步骤：根据时频图像的起始坐标特征对粗聚类结果进行排序，得到坐标特征序列和对应的连通域标签序列；计算起始坐标特征的差分结果的均值，得到临时跳周期；选取任意一起始坐标特征作为基准值，计算当前起始坐标特征与基准值的第一差值，并对第一差值与临时跳周期进行求余计算，得到求余结果；比较求余结果与第二阈值的大小，或比较临时跳周期与求余结果的第二差值与第二阈值的大小，并结合坐标特征序列对应的连通域标签实现细分聚类处理；驻留时间估计单元，用于根据各组分类结果中连通域图像的长度特征估计跳频信号的驻留时间；和/或，跳周期及跳速估计单元，用于根据各组分类结果中连通域图像的起始坐标特征估计跳频信号的跳周期及跳速；和/或，带宽估计单元，用于根据各组分类结果中连通域图像的高度特征估计跳频信号的带宽；和/或，幅度估计单元，用于根据各组分类结果中连通域图像的幅值特征估计跳频信号的幅度；和/或，频率集估计单元，用于根据各组分类结果中连通域图像的质心特征估计跳频信号的频率集；上报单元，用于上报不同跳速的跳频信号粗聚类结果和/或跳速相同但起跳时间不同的细分聚类结果，以及对跳速、幅度、带宽、驻留时间、跳频频率集等任一参数或多个参数组合的参数估计结果。
说明书desc
技术领域本发明涉及电磁频谱监测技术领域，尤其涉及基于时频分析的跳频信号检测与参数估计方法及系统。背景技术跳频技术利用伪随机码序列进行频移键控，使载波频率不断跳变而扩展频谱。跳频信号的频率在较宽的频带内随时间不停的随机跳变，抗干扰能力和抗截获能力突出。由于移动通信信道环境恶劣，各种干扰会不约而至，为了抵御出现的某些频率的干扰，采用跳频信号是有效的方法之一。同时，无线电通信技术迅猛发展，电磁环境复杂多变，加大了跳频信号的监测难度。为更好去除背景噪声，现有跳频监测方法先通过形态学滤波去除背景噪声，再对二值时频图中的信号进行连通区域标记处理，获取各个时频分量的参数信息，最后根据各参数采用K-means方法或者改进的K-means方法进行聚类，并对聚类结果进行判定，当超过设定门限时则判定存在跳频信号。上述方法存在以下问题：1.传统的K-means聚类方法时间复杂度为O，其中，N表示数据长度，K表示类簇数，T表示迭代次数，由于信号种类较多，且需要不断迭代收敛，因此计算复杂度高，收敛慢，效率低。2.通过单门限判断是否存在跳频信号，无法较好过滤干扰，且门限取值难以控制，使得检测准确率大大降低。综上，一种能够快速、准确筛选跳频信号，以提高跳频信号的检测速度、截获概率和识别准确性的基于时频分析的跳频信号检测与参数估计方法的发明就显得很有必要。发明内容本发明的目的在于克服现有技术的问题，提供了一种基于时频分析的跳频信号检测与参数估计方法及系统。本发明的目的是通过以下技术方案来实现的：一种跳频信号实时盲检测方法，该方法包括以下步骤：对跳频信号的时频图像进行双门限阈值分割处理、连通区域标记处理，得到连通域图像的特征信息，包括连通域图像的长度特征；优选地，连通域图像的特征信息还包括高度特征、质心特征、幅值特征和坐标特征的任意一种或多种。根据连通域图像的长度特征对连通域进行粗聚类，得到不同跳速的粗聚类结果，实现对不同跳速的跳频网台的分选。具体地，分割处理即实现时频图像前景目标与背景噪声的分离，以此有效提取连通域图像的特征信息，进而实现跳频信号的聚类。连通域标记即对邻接连通域进行标记，进而将时频图像中每个连通域提取出来。在一示例中，在连通域标记处理前还包括形态学滤波处理步骤，进一步抑制背景噪声。当然，也可在时频图像进行双门限阈值分割处理前进行形态学滤波处理。本发明采用双门限阈值对时频图像进行分割处理，相较于单门限图像分割，双门限能够更好过滤干扰，进而提高信号检测准确率。更为具体地，本发明基于连通域图像的长度特征进行粗聚类，时间复杂度为O，N1表示数据长度，即聚类时间复杂度仅取决于数据点数，整个过程无需迭代，能够快速得到不同跳速的粗聚类结果，实现了跳频信号的实时盲检测，同时大大提高了聚类计算效率。在一示例中，本发明方法还包括以下步骤：跳频信号采集及预处理；具体地，连续时间内采集外界电磁信号的IQ信号数据st，并对数据st进行步长为N2的短时傅里叶变换，存入时频矩阵，进而得到时频图像X2；在一示例中，所述双门限阈值分割处理包括以下子步骤：基于手动门限进行图像分割处理：根据下发的第一上门限、第一下门限对时频图像进行双门限阈值分割处理；和/或，基于自适应门限进行图像分割处理：计算时频图像的能量分布数，根据能量分布数获取去噪门限值，将去噪门限值作为第二下门限，并令最大像素值为第二上门限，根据第二上门限、第二下门限对时频图像进行双门限阈值分割处理。优选基于上述两种方式实现图像的分割处理，在一示例中，通过判别门限类别确定当前双门限值，若当前门限类别为手动门限，直接根据下发的第一上门限、第一下门限对时频图像进行双门限阈值分割处理；若当前门限类别为自适应门限，通过第二上门限、第二下门限对时频图像进行双门限阈值分割处理。在一种优选示例中，先通过自适应门限获取适配当前图像的第二门限，并进一步手动调整第二双门限得到最佳的第一门限，以此提高图像分割精准度，使检测效果达到最佳，同步提升了用户体验度与信号检测准确率。在一示例中，第一上门限、第一下门限可根据历史数据或者技术人员经验确定。根据第一上门限、第一下门限对时频图像进行双门限阈值分割处理的计算式为：其中，B1表示双门限阈值分割结果；i1,m1分别表示时频图像X2的长度值、宽度值；thresholdH表示上门限，本示例中指第一上门限；thresholdL表示下门限，本示例中指第一下门限。在一示例中，第二门限的计算公式为：th＝j*0.1*P j＝1,2,3,…,n其中，P表示总能量；N、M均为求和符号上界，分别表示时频图像X2的长度最大值和宽度最大值；i、m均为求和符号下界，分别表示时频图像X2的长度起始值和宽度起始值；th表示去噪门限；j表示迭代次数；C表示能量分布数。对能量分布数进行二次差分处理，并求其拐点，将将拐点处对应的系数k作为噪声系数，对应th的值作为第二阈值下限，同时令第二阈值上限为255。在一示例中，所述根据连通域图像的长度特征对连通域进行粗聚类包括以下子步骤：S321：对时频图像的长度特征进行排序，得到长度序列和对应的连通域标签序列；S322：对长度序列进行差分运算，得到差分长度序列；S323：比较差分长度序列与第一阈值的大小，并结合差分长度序列对应的连通域标签实现粗聚类处理。其中，若长度序列估计的绝对误差为e1，第一阈值为3e1。更为具体地，步骤S323具体包括以下子步骤：比较当前差分长度序列是否大于第一阈值，若大于，将当前差分长度序列的序号存入标签长度数组labellen中，将labellen—labellen-1对应的标签序列归为同一聚类，n表示标签长度数组的序号；重复上述步骤S321-步骤S323，直至所有长度特征轮询完毕，得到粗聚类结果，实现对不同跳速的跳频信号分选，即分选出不同跳速的跳频网台。在一示例中，所述方法还包括细分聚类步骤，包括以下子步骤：根据连通域图像的起始坐标特征，对粗聚类结果进行细分聚类处理，起始坐标特征代表了跳频信号的起跳时间，因此可根据该细分聚类结果实现对跳速相同、起跳时间不同的跳频网台的分选。本示例中，连通域图像的特征信息包括坐标特征，坐标特征包括起始坐标特征。在一示例中，所述细分聚类处理包括以下子步骤：S331：根据时频图像的起始坐标特征对粗聚类结果进行排序，得到坐标特征序列和对应的连通域标签序列；S332：计算起始坐标特征的差分结果的均值，得到临时跳周期；S333：选取任意一起始坐标特征作为基准值，计算当前起始坐标特征与基准值的第一差值，并对第一差值与临时跳周期进行求余计算，得到求余结果；S334：比较求余结果与第二阈值的大小，或比较临时跳周期与求余结果的第二差值与第二阈值的大小，并结合坐标特征序列对应的连通域标签实现细分聚类处理。其中，若起始坐标估计的绝对误差为e2，第二阈值为3e2。更为具体地，步骤S334具体包括以下子步骤：S3341：比较求余结果是否小于等于第二阈值，或比较临时跳周期与求余结果的第二差值是否小于等于第二阈值，若是，将初始坐标特征对应的标签存入新的聚类分组中，反之，存入临时起始坐标数组中；S3342：重复上述步骤，直至所有起始坐标特征轮询完毕；S3343：将临时起始坐标特征赋值至起始坐标特征；S3344：重复步骤S333至步骤S3343，直至临时起始坐标特征为0；S3345：重复步骤S331至步骤S3344，直至对粗聚类结果轮询完毕，得到细分聚类结果。在一示例中，本发明还包括结果上报步骤，用于上报跳频信号的实时盲检测结果，包括不同跳速的跳频信号粗聚类结果和/或不同起跳时间的细分聚类结果。需要进一步说明的是，上述实时盲检测方法各示例对应的技术特征可以相互组合或替换构成新的技术方案。本发明还包括一种跳频信号实时参数估计方法，该参数估计方法基于上述任一示例或多个示例组成形成的跳频信号实时盲检测方法进行实施，此时连通域图像的特征信息包括长度特征、高度特征、质心特征、幅值特征和坐标特征，坐标特征包括初始坐标特征，参数估计方法包括以下步骤：根据各组分类结果中连通域图像的长度特征估计跳频信号的驻留时间；和/或，根据各组分类结果中连通域图像的起始坐标特征估计跳频信号的跳周期及跳速；和/或，根据各组分类结果中连通域图像的高度特征估计跳频信号的带宽；和/或，根据各组分类结果中连通域图像的幅值特征估计跳频信号的幅度；和/或，根据各组分类结果中连通域图像的质心特征估计跳频信号的频率集。需要进一步说明的是，上述各示例对应的技术特征可以相互组合或替换构成新的技术方案。在一示例中，驻留时间的预估计算公式为：其中，Tr表示预估的驻留时间；长度特征序列lk为，k为序号。在一示例中，跳周期及跳速的预估计算公式为：Vh＝1/Th其中，Th为表示预估的跳周期；Vh表示预估的跳速；初始坐标特征序列为{,,…,}，k为序号。在一示例中，带宽的预估计算公式为：其中，B表示预估的带宽；fs表示采样率；高度特征序列bk为，k为序号。在一示例中，在幅度估计步骤中，每一跳信号的幅度即质心在时频矩阵中对应位置的值。在一示例中，频率计的预估计算公式为：fk＝xkfs/N2其中，fk表示预估的跳频频率；fs表示采样率；N2为短时傅里叶变换步长；质心特征序列xk为{,,…,}，k为序号。在一示例中，本发明还包括结果上报步骤，用于上报跳频信号的实时盲检测结果和参数估计结果，实时盲检测结果包括不同跳速的跳频信号粗聚类结果和/或跳速相同但起跳时间不同的细分聚类结果；参数估计结果包括对跳速、幅度、带宽、驻留时间、跳频频率集等任一参数或多个参数组合的参数估计结果。需要进一步说明的是，上述实时参数估计方法各示例对应的技术特征可以相互组合或替换构成新的技术方案。本发明还包括一种跳频信号实时盲检测系统，与上述跳频信号实时盲检测方法具有相同的技术构思，系统包括：图像处理单元，用于对跳频信号的时频图像进行双门限阈值分割处理、连通区域标记处理，得到连通域图像的特征信息，包括长度特征；信号盲检测单元，用于根据连通域图像的长度特征对连通域进行粗聚类，得到不同跳速的粗聚类结果。在一示例中，系统还包括细分聚类单元，用于根据连通域图像的起始坐标特征，对粗聚类结果进行细分聚类处理，进而实现对跳速相同、起跳时间不同的网台的分选。作为一优选，图像处理单元、信号盲检测单元和细分聚类单元能够执行上述任一示例或多个示例组成形成的跳频信号实时盲检测方法。在一示例中，系统还包括数据采集及预处理单元，用于采集跳频信号并预处理，进而得到跳频信号的时频图像。在一示例中，系统还包括上报单元，用于上报跳频信号的实时盲检测结果，包括不同跳速的跳频信号粗聚类结果和/或跳速相同、起跳时间不同的跳频信号细分聚类结果。在一示例中，系统还包括显示单元，用于显示实时盲检测结果。需要进一步说明的是，上述实时盲检测系统各示例对应的技术特征可以相互组合或替换构成新的技术方案。本发明还包括一种跳频信号实时参数估计系统，与上述跳频信号实时参数估计方法具有相同的技术构思，并包括上述任一示例或多个示例组成的实时盲检测系统中的单元结构，此时基于图像处理单元得到连通域图像的特征信息包括长度特征、高度特征、质心特征、幅值特征和坐标特征，坐标特征包括初始坐标特征，所述参数估计系统包括：驻留时间估计单元，用于根据各组分类结果中连通域图像的长度特征估计跳频信号的驻留时间；和/或，跳周期及跳速估计单元，用于根据各组分类结果中连通域图像的起始坐标特征估计跳频信号的跳周期及跳速；和/或，带宽估计单元，用于根据各组分类结果中连通域图像的高度特征估计跳频信号的带宽；和/或，幅度估计单元，用于根据各组分类结果中连通域图像的幅值特征估计跳频信号的幅度；和/或，频率集估计单元，用于根据各组分类结果中连通域图像的质心特征估计跳频信号的频率集。优选地，系统包括驻留时间估计单元、跳周期及跳速估计单元、带宽估计单元、幅度估计单元以及频率集估计单元。在一示例中，系统还包括上报单元，用于上报跳频信号的实时盲检测结果和参数估计结果，实时盲检测结果包括不同跳速的跳频信号粗聚类结果和/或跳速相同、起跳时间不同的跳频信号细分聚类结果；参数估计结果包括对跳速、幅度、带宽、驻留时间、跳频频率集等任一参数或多个参数组合的参数估计结果。在一示例中，系统还包括显示单元，用于显示实时盲检测结果和/或参数估计结果。需要进一步说明的是，上述跳频信号实时参数估计系统各示例对应的技术特征可以相互组合或替换构成新的技术方案。本发明还包括一种存储介质，其上存储有计算机指令，所述计算机指令运行时执行上述任一示例或多个示例组成形成的所述跳频信号实时盲检测方法的步骤，和/或，执行上述任一示例或多个示例组合形成的所述一种跳频信号实时参数估计方法的步骤。本发明还包括一种终端，包括存储器和处理器，所述存储器上存储有可在所述处理器上运行的计算机指令，所述处理器运行所述计算机指令时执行上述任一示例或多个示例形成的所述跳频信号实时盲检测方法的步骤，和/或，执行上述任一示例或多个示例组合形成的所述一种跳频信号实时参数估计方法的步骤。与现有技术相比，本发明有益效果是：1.在一示例中，采用双门限阈值对时频图像进行分割处理，能够更好过滤干扰，提高信号检测准确率；同时，基于连通域图像的长度特征进行粗聚类，大大降低了时间复杂度，整个聚类过程无需收敛迭代，能够快速得到不同跳速的粗聚类结果，即实现不同跳速的跳频网台的分选，实现了跳频信号的实时盲检测，同时大大提高了聚类计算效率。2.在一示例中，通过下发双门限方式结合自适应计算双门限方式，能够基于自适应计算得到的双门限进一步调整需下发的双门限，以得出适应当前检测环境的最佳双门限值，以此提高图像分割精准度，使检测效果达到最佳，同步提升了用户体验度与信号检测准确率。3.在一示例中，本发明基于连通域图像的起始坐标特征实现对跳速相同、起跳时间不同的网台的分选，运算量小且实时有效，进一步拓展了信号盲检测功能。4.在一示例中，本发明通过时频图像的起始坐标特征对粗聚类结果进行细分聚类处理，相较现有聚类方法时间复杂度大大降低，聚类效率高；同时基于第一差值对临时跳周期求余处理，能够适用于所有聚类场景，进一步提高了检测效率，分选出相同跳速、不同起跳时间的跳频网台。5.在一示例中，本发明基于各组分类结果中连通域图像的长度特征、高度特征、质心特征、幅值特征和坐标特征实现了跳频参数的准确估计，包括跳速、幅度、带宽、驻留时间、频率集等，提供了跳频参数估计的新思路。附图说明下面结合附图对本发明的具体实施方式作进一步详细的说明，此处所说明的附图用来提供对本申请的进一步理解，构成本申请的一部分，在这些附图中使用相同的参考标号来表示相同或相似的部分，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。图1为本发明一示例中的方法流程图；图2为本发明一示例中的优选方法流程图；图3为本发明一示例中完成图像二值化分割的连通域图像示意图；图4为本发明一示例中完成形态学滤波处理的连通域图像示意图；图5为本发明一示例中4邻接连通域标记示意图；图6为本发明一示例中8邻接连通域标记示意图；图7为本发明一示例中完成连通域标记的连通域图像示意图；图8为本发明一示例中频间间隔性能示意图；图9为本发明一示例中驻留时间性能示意图；图10为本发明一示例中用时性能分析示意图。图中：1-第一连通域、2-第二连通域、3-第三连通域、4-第四连通域、5-第五连通域、6-第六连通域、7-第七连通域、8-第八连通域、9-第九连通域、10-第十连通域、11-第十一连通域、12-第十二连通域、13-第十三连通域、14-第十四连通域、15-第十五连通域、16-第十六连通域、17-第十七连通域、18-第十八连通域、19-第十九连通域、20-第二十连通域、21-第二十一连通域、22-第二十二连通域、23-第二十三连通域、24-第二十四连通域、25-第二十五连通域、26-第二十六连通域、27-第二十七连通域、28-第二十八连通域、29-第二十九连通域、30-第三十连通域、31-第三十一连通域、32-第三十二连通域、33-第三十三连通域、34-第三十四连通域、35-第三十五连通域、36-第三十六连通域、37-第三十七连通域、38-第三十八连通域、39-第三十九连通域、40-第四十连通域、41-第四十一连通域。具体实施方式下面结合附图对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要说明的是，属于“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方向或位置关系为基于附图所述方向或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，使用序数词是为了对物体进行区分，并不限于该顺序，而不能理解为指示或暗示相对重要性。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，属于“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。此外，下面所描述的本发明不同实施方式中所涉及的技术特征只要彼此之间未构成冲突就可以相互结合。在一示例中，如图1所示，一种跳频信号实时盲检测方法，具体包括以下步骤：步骤1：对跳频信号的时频图像进行双门限阈值分割处理、连通区域标记处理，得到连通域图像的特征信息，包括长度特征；步骤2：根据连通域图像的长度特征对连通域进行粗聚类，得到不同跳速的粗聚类结果。本发明采用双门限阈值对时频图像进行分割处理，相较于单门限图像分割，双门限能够更好过滤干扰，进而提高信号检测准确率。同时，基于连通域图像的长度特征进行粗聚类，时间复杂度仅取决于数据点数，整个过程无需迭代，能够快速得到不同跳速的粗聚类结果，实现了跳频信号的实时盲检测，同时大大提高了聚类计算效率。作为一优选，将跳频信号实时盲检测方法与参数预估方法进行结合，得到一种跳频信号实时盲检测与参数预估方法，如图2所示，具体包括以下步骤：S1：数据采集及预处理：采集电磁数据并进行数据预处理，包括以下子步骤：S11：连续1s时间内采集外界电磁信号IQ数据st；具体地，采用复杂CNI信号环境模拟器发射跳频信号和干扰信号，并用20MHz～8GHz垂直极化监测天线将信号辐射出来，实现信号的采集；采用成都中星世通电子科技有限公司的CS-8000AT数字宽带监测接收机对外界电磁信号进行IQ数据采集，采样频率为204.8MHz；采用成都中星世通电子科技有限公司CSCCRMS6.0软件进行数据处理和界面展示。同时，由于图片篇幅限制及更好的观测效果，本实施例中图3～图4、图7均为112ms窗口内的数据展示结果，其余为1s窗口内的数据展示结果，此后不再赘述。S12：对数据st进行步长为N2的短时傅里叶变换，存放入时频矩阵。S2：采用图像处理技术对时频矩阵进行图像分割、形态学滤波、连通域标记；S21：判定门限类别，根据不同门限类别的上门限和下门限进行图像双门限分割，本实施例采用自动门限；S211：基于能量统计算法，计算自适应门限thresholdauto；S212：根据求得的thresholdauto完成图像二值化分割，如图3所示，图3中白色框为连通域。S22：选择结构化元素对分割后的图像进行形态学滤波，得到的连通域图像如图4所示；S23：对滤波后的时频矩阵B2进行连通域标记，如图5所示为4邻接连通域标记，其中，通过黑色填充的矩形方框表示当前连通域；通过斜线填充的矩形方框表示邻接连通域；如图6所示为8邻接连通域标记等，本实施例采用的8邻接连通域标记，共标记了41个连通域，如图7所示，包括第一连通域1、第二连通域2、第三连通域3、第四连通域4、第五连通域5、第六连通域6、第七连通域7、第八连通域8、第九连通域9、第十连通域10、第十一连通域11、第十二连通域12、第十三连通域13、第十四连通域14、第十五连通域15、第十六连通域16、第十七连通域17、第十八连通域18、第十九连通域19、第二十连通域20、第二十一连通域21、第二十二连通域22、第二十三连通域23、第二十四连通域24、第二十五连通域25、第二十六连通域26、第二十七连通域27、第二十八连通域28、第二十九连通域29、第三十连通域30、第三十一连通域31、第三十二连通域32、第三十三连通域33、第三十四连通域34、第三十五连通域35、第三十六连通域36、第三十七连通域37、第三十八连通域38、第三十九连通域39、第四十连通域40、第四十一连通域41。需要进一步说明的是，本申请图3-图4、图7均为仿真图，不用于限定本申请技术方案的保护范围；图7中部分连通域无法肉眼识别，如第四连通域4、第十七连通域17、第十八连通域18、第二十一连通域21、第二十二连通域22等。S3：根据连通域图像的长度特征实现跳频信号的盲检测，并根据连通域图像的坐标特征实现跳速不同的跳频网台的分选，具体包括以下子步骤：S31：提取连通域图像的特征信息，包括长度特征、高度特征、质心特征、幅值特征和坐标特征，坐标特征包括起始坐标特征。S32：根据图像长度特征，对连通域进行粗聚类，具体包括以下子步骤：S321：根据长度特征length进行排序，构成长度序列Len和连通域标记的标签序列Label；S322：对长度序列Len进行差分运算，本实施例得到长度为40的差分长度序列Dlen。S323：选取第一阈值thresholdl，当Dlen＞thresholdl时，差分长度序列Dlen的序号k存放入标签长度数组labellen中；S324：将labellen—labellen-1对应的标签序列归为同一聚类；S325：重复步骤S324，直至所有标签label聚类完毕，本实施例的粗聚类结果如表1所示：表1粗聚类结果表S33：在步骤S32基础上，根据图像初始坐标特征s-coordinate，对粗聚类的结果再次细分聚类，具体包括以下子步骤：S331：根据初始坐标特征s-coordinate对步骤S32的聚类结果排序；S332：对初始坐标特征s-coordinate的差分结果求均值，得到临时跳周期tc；S333：选取基准值basevalue，初始坐标数组s-coordinate与basevalue的差值为tempvalue；S334：选取第二阈值thresholds，若差值tempvalue与临时跳周期的求余结果≤thresholds，则将初始坐标特征s-coordinate对应的标签存入新的聚类分组中；否则，将s-coordinate存入临时初始坐标数组s-coordinate-temp中；S335：重复S334，直至始坐标特征轮询完毕；S336：将s-coordinate-temp赋值给s-coordinate；S337：重复S333～S336，直至s-coordinate-temp的大小为0；S338：重复S331～S337，直至S32的粗聚类结果分组轮询完毕。本示例中，细分聚类的示意图如表2所示：表2细分聚类结果表聚类分组连通域的标签1{6,9,12,15,19,24,27,30,33,36}2{7,10,13,16,20,25,28,31,34,37}3{5,8,11,14,23,26,29,32,35,38}S34：根据聚类结果判决是否存在跳频信号；S4：跳频参数估计，包括跳速估计、幅度估计、带宽估计、驻留时间估计、跳频频率集估计等；本示例中，最终参数估计结果如表3、表4所示：表3第一时间段的参数估计结果表表4第二时间段的参数估计结果表S5：结果上报：将跳频信号盲检测结果及参数估计结果上报并实时展示。S51：打包跳频信号个数，相关信号参数及跳频图案等信息；S52：上报至显控界面。本实施例中，对跳频信号盲检测性能和参数估计性能进行分析，首先对单一信号进行测试验证，具体分析可检测的跳频信号频间间隔、驻留时间估计误差、频率估计误差、频率集捕获概率等性能。对于频间间隔性能，设置1000hop/s的信号，频率范围7200MHz～7260MHz，频率集的频率点数分别设置为64、128、256、300，频率在设定范围内递增生成，因此频间间隔分别为：952.38kHz，472.44kHz，235.29kHz，200.67kHz。如图8所示，图中横坐标为频间间隔，单位为kHz；纵坐标为检测正确率，当频间间隔大于或等于9个像素，信号检测的准确性大于95％。对于驻留时间性能，设置频率范围7200MHz～7260MHz，频率集的频率点数设置为256，跳周期分别设置为0.1s、0.01s、5ms、4ms、2.5ms、2ms、1ms，由于CNI-SIM-1000切频速度快，时间可忽略，因此驻留时间约等于跳周期。如图9所示，图中横坐标为测试次数；纵坐标为估计误差，单位为微秒，由图9可知，估计的驻留时间与实际驻留时间的差值均低于一个时间像素，性能较佳。对于频率估计误差的性能分析，设置单个1000hop/s的信号，频率范围7200MHz～7260MHz，频率集的频率点数分别设置为16、32，得到的估计频率集如表5所示：表5频率集预估表由表5可见，频率的估计误差基本在13kHz及以下，其估计误差基本在一个像素范围内，性能较佳。在频率集捕获概率性能方面，设置单个1000hop/s的信号，频率范围7200MHz～7260MHz，频率集的频率点数分别设置为32、64、128、256，测试结果如表6所示：表6频点截获测试结果表实际频点数截获频点数频率集截获概率3232100％6464100％128128100％256256100％由表6可知，频率集捕获概率高达100％。对本发明方法的网台分选能力进行测试。针对不同跳速的网台分选，设置信号跳速1000hop/s、200hop/s、100hop/s，频率范围均为7200MHz～7260MHz，频率点数分别为130、58、30，三个跳频在一个带宽范围内，频率交错但不重叠。如表3可知，本实施例可同时分选3个及以上同步跳频网台。针对相同跳速的异步网台分选，设置三个跳速为400hop/s的跳频信号，三个跳频信号的频率集合相同，跳频图案不同，并分别设置三个跳频信号的起始时间为0s、0.9ms和1.8ms。由表4可知，在异步非正交的基础上，本实施例可正确分选3个及以上异步正交跳频网台。针对本实施例所提出的方法用时性能分析，如图10所示，图中横坐标为数据窗口，单位为ms；纵坐标为算法用时，单位为ms。由图10可知当数据窗口小于1s时，方法所用时间均低于1s，即1s内的电磁信号可在1s时间内实时地被检测并估计出参数；当数据窗口为3s时，方法所用时间为1.8s，远低于数据窗口时间。综上所述，本实施例所提出的方法可快速、有效、准确地检测出跳频信号并对其进行参数估计。进一步地，上述优选跳频信号实时盲检测与参数估计方法已广泛应用于CS-100A、CS-200A、CS-200B、CS-300A、CS-900A等系列监测测向系统和CS-8000A、CS-8000AT、CS-8000B、CS-8000BT、CS-18GB、CS-26.5GB等系列数字宽带监测接收机设备中，均具有良好的检测效果和参数估计效果。基于上述跳频信号实时盲检测与参数估计方法相同的发明构思，将跳频信号实时盲检测系统、跳频信号实时参数估计系统进行组合，得到一种跳频信号实时盲检测与参数估计系统，该系统包括：数据采集及预处理单元，用于采集跳频信号并预处理，进而得到跳频信号的时频图像；图像处理单元，用于对跳频信号的时频图像进行双门限阈值分割处理、连通区域标记处理，得到连通域图像的特征信息，包括长度特征；信号盲检测单元，用于根据连通域图像的长度特征对连通域进行粗聚类，得到不同跳速的粗聚类结果；细分聚类单元，用于根据连通域图像的起始坐标特征，对粗聚类结果进行细分聚类处理，进而实现对跳速相同、起跳时间不同的网台的分选；驻留时间估计单元，用于根据各组分类结果中连通域图像的长度特征估计跳频信号的驻留时间；跳周期及跳速估计单元，用于根据各组分类结果中连通域图像的起始坐标特征估计跳频信号的跳周期及跳速；带宽估计单元，用于根据各组分类结果中连通域图像的高度特征估计跳频信号的带宽；幅度估计单元，用于根据各组分类结果中连通域图像的幅值特征估计跳频信号的幅度；频率集估计单元，用于根据各组分类结果中连通域图像的质心特征估计跳频信号的频率集；上报单元，用于上报跳频信号的实时盲检测结果和参数估计结果；显示单元，用于显示实时盲检测结果和/或参数估计结果。本申请还包括一种存储介质，与上述跳频信号实时盲检测与参数估计方法具有相同的发明构思，其上存储有计算机指令，所述计算机指令运行时执行上述跳频信号实时盲检测与参数估计方法的步骤。基于这样的理解，本实施例的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。本申请还包括一种终端，与上述跳频信号实时盲检测与参数估计方法具有相同的发明构思，包括存储器和处理器，所述存储器上存储有可在所述处理器上运行的计算机指令，所述处理器运行所述计算机指令时执行上述跳频信号实时盲检测与参数估计方法的步骤。处理器可以是单核或者多核中央处理单元或者特定的集成电路，或者配置成实施本发明的一个或者多个集成电路。在本发明提供的实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。以上具体实施方式是对本发明的详细说明，不能认定本发明的具体实施方式只局限于这些说明，对于本发明所属技术领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干简单推演和替代，都应当视为属于本发明的保护范围。
