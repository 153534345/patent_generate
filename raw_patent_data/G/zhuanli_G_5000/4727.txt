标题title
语言模型的训练方法、装置、介质及设备
摘要abst
本公开提供了一种语言模型的训练方法、装置、介质及设备，涉及人工智能技术领域，尤其涉及自然语言处理领域。实现方案为：获取样本文本和相应的样本标签；基于样本文本，获取第一分词序列和第二分词序列；将第一分词序列的多个分词输入到第一子模型中，以获得第一预测结果；将第二分词序列的多个分词输入到第二子模型中，以获得第二预测结果；基于第一预测结果和第二预测结果，计算第一损失函数；基于第一预测结果、第二预测结果和该样本数据相应的样本标签，计算第二损失函数；以及基于第一损失函数和第二损失函数，调整初始语言模型的至少一个参数，以获得语言模型。
权利要求书clms
1.一种语言模型的训练方法，所述语言模型用于执行目标任务，所述方法包括：获取样本文本和相应的样本标签，所述样本标签与所述目标任务相对应；基于所述样本文本，获取第一分词序列和第二分词序列，其中，所述第一分词序列和第二分词序列不相同；将所述第一分词序列的多个分词输入到第一子模型中，以获得所述第一子模型输出的第一预测结果；将所述第二分词序列的多个分词输入到第二子模型中，以获得所述第二子模型输出的第二预测结果，其中，所述第一子模型和所述第二子模型分别通过改变初始语言模型的网络结构获得，并且所述第一子模型的网络结构和所述第二子模型的网络结构不相同；基于所述第一预测结果和所述第二预测结果，计算第一损失函数；基于所述第一预测结果、所述第二预测结果和该样本数据相应的样本标签，计算第二损失函数；以及基于所述第一损失函数和所述第二损失函数，调整所述初始语言模型的至少一个参数，以获得所述语言模型。2.根据权利要求1所述的方法，其中，所述基于所述样本文本，获取第一分词序列和第二分词序列包括：对所述样本文本进行多次随机切词，以获取多个分词序列，其中，所述多个分词序列包括词粒度分词序列以及字词混合粒度分词序列中的至少一者，所述多个分词序列中的每个分词序列均不相同；在所述多个分词序列中随机选择两个分词序列，以作为所述第一分词序列和所述第二分词序列。3.根据权利要求2所述的方法，其中，所述多个分词序列还包括字粒度分词序列。4.根据权利要求1至3中任一项所述的方法，其中，所述第一损失函数为相对熵损失函数。5.根据权利要求1至4中任一项所述的方法，其中，所述基于所述第一损失函数和所述第二损失函数，调整所述初始语言模型的至少一个参数包括：对所述第一损失函数和所述第二损失函数进行加权计算，以获取综合损失函数；以及基于所述综合损失函数，调整所述初始语言模型的至少一个参数。6.根据权利要求1至5中任一项所述的方法，其中，所述第一子模型和所述第二子模型的获得包括：对所述初始语言模型中的多个神经元进行两次随机掩盖，以分别获得所述第一子模型和所述第二子模型，其中，所述第一子模型中被掩盖的至少一个神经元和所述第二子模型中被掩盖的至少一个神经元不相同，并且，所述被掩盖的至少一个神经元中的每个神经元停止工作。7.一种语言模型的训练装置，所述语言模型用于执行目标任务，所述装置包括：第一获取单元，被配置为获取样本文本和相应的样本标签，所述样本标签与所述目标任务相对应；第二获取单元，被配置为基于所述样本文本，获取第一分词序列和第二分词序列，其中，所述第一分词序列和第二分词序列不相同；第一输入单元，被配置为将所述第一分词序列的多个分词输入到第一子模型中，以获得所述第一子模型输出的第一预测结果；第二输入单元，被配置为将所述第二分词序列的多个分词输入到第二子模型中，以获得所述第二子模型输出的第二预测结果，其中，所述第一子模型和所述第二子模型分别通过改变初始语言模型的网络结构获得，并且所述第一子模型的网络结构和所述第二子模型的网络结构不相同；第一计算单元，被配置为基于所述第一预测结果和所述第二预测结果，计算第一损失函数；第二计算单元，被配置为基于所述第一预测结果、所述第二预测结果和该样本数据相应的样本标签，计算第二损失函数；以及调整单元，被配置为基于所述第一损失函数和所述第二损失函数，调整所述初始语言模型的至少一个参数，以获得所述语言模型。8.根据权利要求7所述的装置，其中，所述第二获取单元包括：切词子单元，被配置为对所述样本文本进行多次随机切词，以获取多个分词序列，其中，所述多个分词序列包括词粒度分词序列以及字词混合粒度分词序列中的至少一者，所述多个分词序列中的每个分词序列均不相同；选择子单元，被配置为在所述多个分词序列中随机选择两个分词序列，以作为所述第一分词序列和所述第二分词序列。9.根据权利要求8所述的装置，其中，所述多个分词序列还包括字粒度分词序列。10.根据权利要求7至9中任一项所述的装置，其中，所述第一损失函数为相对熵损失函数。11.根据权利要求7至10中任一项所述的装置，其中，所述调整单元包括：计算子单元，被配置为对所述第一损失函数和所述第二损失函数进行加权计算，以获取综合损失函数；以及调整子单元，被配置为基于所述综合损失函数，调整所述初始语言模型的至少一个参数。12.根据权利要求7至11中任一项所述的装置，所述装置还包括：第三获取单元，被配置为对所述初始语言模型中的多个神经元进行两次随机掩盖，以分别获得所述第一子模型和所述第二子模型，其中，所述第一子模型中被掩盖的至少一个神经元和所述第二子模型中被掩盖的至少一个神经元不相同，并且，所述被掩盖的至少一个神经元中的每个神经元停止工作。13.一种电子设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-6中任一项所述的方法。14.一种存储有计算机指令的非瞬时计算机可读存储介质，其中，所述计算机指令用于使所述计算机执行根据权利要求1-6中任一项所述的方法。15.一种计算机程序产品，包括计算机程序，其中，所述计算机程序在被处理器执行时实现权利要求1-6中任一项所述的方法。
说明书desc
技术领域本公开涉及人工智能技术领域，尤其涉及自然语言处理领域，具体涉及一种语言模型的训练方法、装置、电子设备、计算机可读存储介质和计算机程序产品。背景技术人工智能是研究使计算机来模拟人的某些思维过程和智能行为的学科，既有硬件层面的技术也有软件层面的技术。人工智能硬件技术一般包括如传感器、专用人工智能芯片、云计算、分布式存储、大数据处理等技术；人工智能软件技术主要包括计算机视觉技术、语音识别技术、自然语言处理技术以及机器学习/深度学习、大数据处理技术、知识图谱技术等几大方向。近年来，以BERT为代表的预训练模型提出了“预训练+微调”的训练方法，大幅提升了各类自然语言处理任务的效果。在预训练阶段，其采用深层Transformer模型结构，使用海量无监督文本学习上下文相关表示；在微调阶段，其使用通用统一的方式解决各类自然语言处理任务。在此部分中描述的方法不一定是之前已经设想到或采用的方法。除非另有指明，否则不应假定此部分中描述的任何方法仅因其包括在此部分中就被认为是现有技术。类似地，除非另有指明，否则此部分中提及的问题不应认为在任何现有技术中已被公认。发明内容本公开提供了一种语言模型的训练方法、装置、电子设备、计算机可读存储介质和计算机程序产品。根据本公开的一方面，提供了一种语言模型的训练方法，语言模型用于执行目标任务，包括：获取样本文本和相应的样本标签，样本标签与目标任务相对应；基于样本文本，获取第一分词序列和第二分词序列，其中，第一分词序列和第二分词序列不相同；将第一分词序列的多个分词输入到第一子模型中，以获得第一子模型输出的第一预测结果；将第二分词序列的多个分词输入到第二子模型中，以获得第二子模型输出的第二预测结果，其中，第一子模型和第二子模型分别通过改变初始语言模型的网络结构获得，并且第一子模型的网络结构和第二子模型的网络结构不相同；基于第一预测结果和第二预测结果，计算第一损失函数；基于第一预测结果、第二预测结果和该样本数据相应的样本标签，计算第二损失函数；以及基于第一损失函数和第二损失函数，调整初始语言模型的至少一个参数，以获得语言模型。根据本公开的另一方面，提供了一种语言模型的训练装置，语言模型用于执行目标任务，包括：第一获取单元，被配置为获取样本文本和相应的样本标签，样本标签与目标任务相对应；第二获取单元，被配置为基于样本文本，获取第一分词序列和第二分词序列，其中，第一分词序列和第二分词序列不相同；第一输入单元，被配置为将第一分词序列的多个分词输入到第一子模型中，以获得第一子模型输出的第一预测结果；第二输入单元，被配置为将第二分词序列的多个分词输入到第二子模型中，以获得第二子模型输出的第二预测结果，其中，第一子模型和第二子模型分别通过改变初始语言模型的网络结构获得，并且第一子模型的网络结构和第二子模型的网络结构不相同；第一计算单元，被配置为基于第一预测结果和第二预测结果，计算第一损失函数；第二计算单元，被配置为基于第一预测结果、第二预测结果和该样本数据相应的样本标签，计算第二损失函数；以及调整单元，被配置为基于第一损失函数和第二损失函数，调整初始语言模型的至少一个参数，以获得语言模型。根据本公开的另一方面，提供了一种电子设备，包括：至少一个处理器；以及与至少一个处理器通信连接的存储器；其中存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行本公开的语言模型训练方法。根据本公开的另一方面，提供了一种存储有计算机指令的非瞬时计算机可读存储介质，其中，计算机指令用于使计算机执行本公开的语言模型训练方法。根据本公开的另一方面，提供了一种计算机程序产品，包括计算机程序，其中，计算机程序在被处理器执行时实现本公开的语言模型训练方法。根据本公开的一个或多个实施例，能够在提升模型鲁棒性和泛化能力的同时，进一步提升模型训练的效率。应当理解，本部分所描述的内容并非旨在标识本公开的实施例的关键或重要特征，也不用于限制本公开的范围。本公开的其它特征将通过以下的说明书而变得容易理解。附图说明附图示例性地示出了实施例并且构成说明书的一部分，与说明书的文字描述一起用于讲解实施例的示例性实施方式。所示出的实施例仅出于例示的目的，并不限制权利要求的范围。在所有附图中，相同的附图标记指代类似但不一定相同的要素。图1示出了根据本公开的实施例的可以在其中实施本文描述的各种方法的示例性系统的示意图；图2示出了根据本公开的实施例的语言模型的训练方法的流程图；图3示出了根据本公开的示例性实施例的语言模型的训练方法的示意图；图4示出了根据本公开的实施例的语言模型的训练装置的结构框图；图5示出了能够用于实现本公开的实施例的示例性电子设备的结构框图。具体实施方式以下结合附图对本公开的示范性实施例做出说明，其中包括本公开实施例的各种细节以助于理解，应当将它们认为仅仅是示范性的。因此，本领域普通技术人员应当认识到，可以对这里描述的实施例做出各种改变和修改，而不会背离本公开的范围。同样，为了清楚和简明，以下的描述中省略了对公知功能和结构的描述。在本公开中，除非另有说明，否则使用术语“第一”、“第二”等来描述各种要素不意图限定这些要素的位置关系、时序关系或重要性关系，这种术语只是用于将一个要素与另一要素区分开。在一些示例中，第一要素和第二要素可以指向该要素的同一实例，而在某些情况下，基于上下文的描述，它们也可以指代不同实例。在本公开中对各种所述示例的描述中所使用的术语只是为了描述特定示例的目的，而并非旨在进行限制。除非上下文另外明确地表明，如果不特意限定要素的数量，则该要素可以是一个也可以是多个。此外，本公开中所使用的术语“和/或”涵盖所列出的项目中的任何一个以及全部可能的组合方式。下面将结合附图详细描述本公开的实施例。图1示出了根据本公开的实施例可以将本文描述的各种方法和装置在其中实施的示例性系统100的示意图。参考图1，该系统100包括一个或多个客户端设备101、102、103、104、105和106、服务器120以及将一个或多个客户端设备耦接到服务器120的一个或多个通信网络110。客户端设备101、102、103、104、105和106可以被配置为执行一个或多个应用程序。在本公开的实施例中，服务器120可以运行使得能够执行上述语言模型的训练方法的一个或多个服务或软件应用。在某些实施例中，服务器120还可以提供其他服务或软件应用，这些服务或软件应用可以包括非虚拟环境和虚拟环境。在某些实施例中，这些服务可以作为基于web的服务或云服务提供，例如在软件即服务模型下提供给客户端设备101、102、103、104、105和/或106的用户。在图1所示的配置中，服务器120可以包括实现由服务器120执行的功能的一个或多个组件。这些组件可以包括可由一个或多个处理器执行的软件组件、硬件组件或其组合。操作客户端设备101、102、103、104、105和/或106的用户可以依次利用一个或多个客户端应用程序来与服务器120进行交互以利用这些组件提供的服务。应当理解，各种不同的系统配置是可能的，其可以与系统100不同。因此，图1是用于实施本文所描述的各种方法的系统的一个示例，并且不旨在进行限制。用户可以使用客户端设备101、102、103、104、105和/或106来获取模型训练所需的样本数据。客户端设备可以提供使客户端设备的用户能够与客户端设备进行交互的接口。客户端设备还可以经由该接口向用户输出信息。尽管图1仅描绘了六种客户端设备，但是本领域技术人员将能够理解，本公开可以支持任何数量的客户端设备。客户端设备101、102、103、104、105和/或106可以包括各种类型的计算机设备，例如便携式手持设备、通用计算机、工作站计算机、可穿戴设备、智能屏设备、自助服务终端设备、服务机器人、游戏系统、瘦客户端、各种消息收发设备、传感器或其他感测设备等。这些计算机设备可以运行各种类型和版本的软件应用程序和操作系统，例如MICROSOFT Windows、APPLE iOS、类UNIX操作系统、Linux或类Linux操作系统；或包括各种移动操作系统，例如MICROSOFT WindowsMobile OS、iOS、Windows Phone、Android。便携式手持设备可以包括蜂窝电话、智能电话、平板电脑、个人数字助理等。可穿戴设备可以包括头戴式显示器和其他设备。游戏系统可以包括各种手持式游戏设备、支持互联网的游戏设备等。客户端设备能够执行各种不同的应用程序，例如各种与Internet相关的应用程序、通信应用程序、短消息服务应用程序，并且可以使用各种通信协议。网络110可以是本领域技术人员熟知的任何类型的网络，其可以使用多种可用协议中的任何一种来支持数据通信。仅作为示例，一个或多个网络110可以是局域网、基于以太网的网络、令牌环、广域网、因特网、虚拟网络、虚拟专用网络、内部网、外部网、区块链网络、公共交换电话网、红外网络、无线网络和/或这些和/或其他网络的任意组合。服务器120可以包括一个或多个通用计算机、专用服务器计算机服务器、UNIX服务器、中端服务器)、刀片式服务器、大型计算机、服务器群集或任何其他适当的布置和/或组合。服务器120可以包括运行虚拟操作系统的一个或多个虚拟机，或者涉及虚拟化的其他计算架构。在各种实施例中，服务器120可以运行提供下文所描述的功能的一个或多个服务或软件应用。服务器120中的计算单元可以运行包括上述任何操作系统以及任何商业上可用的服务器操作系统的一个或多个操作系统。服务器120还可以运行各种附加服务器应用程序和/或中间层应用程序中的任何一个，包括HTTP服务器、FTP服务器、CGI服务器、JAVA服务器、数据库服务器等。在一些实施方式中，服务器120可以包括一个或多个应用程序，以分析和合并从客户端设备101、102、103、104、105和/或106的用户接收的数据馈送和/或事件更新。服务器120还可以包括一个或多个应用程序，以经由客户端设备101、102、103、104、105和/或106的一个或多个显示设备来显示数据馈送和/或实时事件。在一些实施方式中，服务器120可以为分布式系统的服务器，或者是结合了区块链的服务器。服务器120也可以是云服务器，或者是带人工智能技术的智能云计算服务器或智能云主机。云服务器是云计算服务体系中的一项主机产品，以解决传统物理主机与虚拟专用服务器服务中存在的管理难度大、业务扩展性弱的缺陷。系统100还可以包括一个或多个数据库130。在某些实施例中，这些数据库可以用于存储数据和其他信息。例如，数据库130中的一个或多个可用于存储诸如音频文件和视频文件的信息。数据库130可以驻留在各种位置。例如，由服务器120使用的数据库可以在服务器120本地，或者可以远离服务器120且可以经由基于网络或专用的连接与服务器120通信。数据库130可以是不同的类型。在某些实施例中，由服务器120使用的数据库例如可以是关系数据库。这些数据库中的一个或多个可以响应于命令而存储、更新和检索到数据库以及来自数据库的数据。在某些实施例中，数据库130中的一个或多个还可以由应用程序使用来存储应用程序数据。由应用程序使用的数据库可以是不同类型的数据库，例如键值存储库，对象存储库或由文件系统支持的常规存储库。图1的系统100可以以各种方式配置和操作，以使得能够应用根据本公开所描述的各种方法和装置。根据本公开的实施例，如图2所示，提供了一种语言模型的训练方法，上述方法包括：步骤S201、获取样本文本和相应的样本标签，样本标签与目标任务相对应；步骤S202、基于样本文本，获取第一分词序列和第二分词序列，其中，第一分词序列和第二分词序列不相同；步骤S203、将第一分词序列的多个分词输入到第一子模型中，以获得第一子模型输出的第一预测结果；步骤S204、将第二分词序列的多个分词输入到第二子模型中，以获得第二子模型输出的第二预测结果，其中，第一子模型和第二子模型分别通过改变初始语言模型的网络结构获得，并且第一子模型的网络结构和第二子模型的网络结构不相同；步骤S205、基于第一预测结果和第二预测结果，计算第一损失函数；步骤S206、基于第一预测结果、第二预测结果和该样本数据相应的样本标签，计算第二损失函数；以及步骤S207、。根据本公开的一个或多个实施例，能够在提升模型鲁棒性和泛化能力的同时，进一步提升模型训练的效率。在一些实施例中，语言模型训练可以是已经经过预训练的语言模型，该语言模型例如可以为BERT、ERNIE等语言模型。在一些实施例中，上述语言模型用于执行目标任务。所述目标任务例如可以包括文本匹配、文本生成、情感分类、文本摘要、问答、检索等任务。在一些实施例中，上述语言模型的训练方法可以应用于预训练语言模型的微调训练。微调训练面向该语言模型的目标任务，相应的，用于进行模型训练的样本数据集亦是针对该目标任务所构建的。例如，目标任务为基于文本进行情感分类，则相应的每个样本数据的样本标签则可以包括多个情感类别标签。在一些实施例中，基于样本数据集进行模型训练的过程中，在每次将样本文本输入到语言模型之前，可以首先对语言模型的网络结构进行一定的改动，例如基于预设的规则删除语言模型中的一个或多个神经元，从而获得一个子模型，使该子模型能够与上述语言模型在网络结构上发生微小变化，例如，子模型与原语言模型相比，仅少了一个或数个神经元。由此，通过每次在输入样本数据之前对模型进行微小改动，由此，为模型训练引入了一定的扰动，所训练获得的模型能够在完成相应目标任务的同时，具有忽略上述扰动的能力，从而提升了模型的鲁棒性。在一些实施例中，可以基于上述方法，分别对该语言模型进行两次不同的改动，从而获得第一子模型和第二子模型。在一些实施例中，第一子模型和第二子模型的获得包括：对初始语言模型中的多个神经元进行两次随机掩盖，以分别获得第一子模型和第二子模型，其中，第一子模型中被掩盖的至少一个神经元和第二子模型中被掩盖的至少一个神经元不相同，并且，被掩盖的至少一个神经元中的每个神经元停止工作。在一些实施例中，可以基于预定概率，对语言模型中的多个神经元进行随机掩盖，从而获得一个子模型。通过对语言模型进行两次不同的上述操作，即可分别获取到第一子模型和第二子模型。在一些实施例中，第一子模型和第二子模型中被掩盖的神经元的数量可以是相同的，也可以是不同的，在此不作限制。由此，通过对语言模型中的至少一个神经元进行随机掩盖，进一步增加了子模型的随机性和差异性，从而进一步提升模型的鲁棒性和泛化能力的同时，提升了模型微调的效率。在一些实施例中，在获取到第一子模型和第二子模型的基础上，可以进一步对所要输入到第一子模型和第二子模型中的样本数据进行处理。样本文本在输入到两个子模型之前，首先需要对其进行切词操作。在一些实施例中，可以对一个样本文本分别基于不同的切词方式进行两次分词，从而获得包含不同分词的第一分词序列和第二分词序列，例如，对于样本文本“南京市长江大桥”进行切分，则第一分词序列可以为“南、京、市、长、江、大、桥”，而第二分词序列则可以为“南京、市、长江、大、桥”。在一些实施例中，基于样本文本，获取第一分词序列和第二分词序列包括：对样本文本进行多次随机切词，以获取多个分词序列，其中，多个分词序列包括词粒度分词序列以及字词混合粒度分词序列中的至少一者，多个分词序列中的每个分词序列均不相同；在多个分词序列中随机选择两个分词序列，以作为第一分词序列和第二分词序列。在一些实施例中，可以对一个样本文本分别进行多次随机分词，并获得分别包含不同切分方法的多个分词序列，其中，每个分词序列均不相同。在一些实施例中，可以对分词粒度进行设置。在一个示例中，可以将分词粒度设置为词粒度，则所获得的分词序列中的每个分词均是词粒度，例如，样本文本“南京市长江大桥”可以被切分为“南京市、长江、大桥”；在一个示例中，也可以将分词粒度设置为字词混合粒度，则所获得的分词序列中可以既包括词粒度分词，也包括字粒度分词，例如，样本文本“南京市长江大桥”可以被切分为“南京、市、长江、大桥”。在一些实施例中，多个分词序列中可以包括词粒度分词序列以及字词混合粒度分词序列中的至少一者。由此，通过在多个分词序列中随机选择两个，能够分别获得均为词粒度的、均为混合粒度的、一者为词粒度一者为混合粒度的不同的两个序列，从而进一步为模型微调引入不同维度的序列差别，进一步提升模型训练效率。在一些实施例中，多个分词序列还包括字粒度分词序列。在一些实施例中，可以将分词粒度设置为字粒度，则可以获得样本文本的字粒度分词序列，例如，样本文本“南京市长江大桥”可以被切分为“南、京、市、长、江、大、桥”。由此，进一步引入字粒度分词序列，通过在多个分词序列中随机选择两个，能够进而获得一者为字粒度一者为混合粒度的，或一者为字粒度一者为词粒度不同的两个分词序列，从而进一步为模型微调引入不同维度的序列差别，进一步提升模型训练效率。图3示出了根据本公开的示例性实施例的语言模型的训练方法的示意图。在一些实施例中，如图3所示，将通过上述方法获得的第一分词序列和第二分词序列，分别输入到该轮预测过程中，基于语言模型获得的第一子模型310和第二子模型320中，从而分别获得第一预测结果和第二预测结果，随后，即可基于第一预测结果和第二预测结果计算第一损失函数。在一些实施例中，第一损失函数可以为相对熵损失函数。相对熵损失函数，又被称为Kullback-Leibler散度或信息散度，是两个概率分布间差异的非对称性度量。在一些实施例中，第一预测结果和第二预测结果可以分别为第一预测概率P和第二预测概率Q，则相对熵损失函数KL即可通过下述公式表示，其中X表示一个样本数据批次，x表示该样本数据批次中的一个样本数据：由此，通过上述相对熵损失函数能够衡量两子模型的输出的概率分布差异，并基于该差异对预训练语言模型进行训练，从而能够使模型忽略输入文本的分词粒度以及模型网络结构的变动等所产生的多种维度的微小扰动，从而提升模型的鲁棒性和泛化能力，提升模型的综合性能。在一些实施例中，第二损失函数例如可以为交叉熵损失函数，从而能够基于样本标签，对语言模型进行面向目标任务的微调训练。可理解的，相关技术人员可以基于具体的目标任务进行第二损失函数的选择，在此不做限制。在一些实施例中，可以分别基于第一预测结果和样本标签、第二预测结果和样本标签分别进行损失函数的计算，并对上述所得的两个部分进行加权求和，从而获得第二损失函数。在一些实施例中，基于第一损失函数和第二损失函数，调整语言模型的至少一个参数包括：对第一损失函数和第二损失函数进行加权计算，以获取综合损失函数；以及基于综合损失函数，调整初始语言模型的至少一个参数。由此，通过对两种损失函数进行加权求和，并基于综合损失函数对模型进行训练，能够在对模型进行面向目标任务的微调的同时，提升模型的鲁棒性和泛化能力。其中，第一损失函数和第二损失函数相应的权重可基于实际需要确定，在此不做赘述。通过本公开的上述模型训练方法，不仅能够使语言模型具有完成目标任务的能力，也能够通过引入输入文本的分词粒度以及模型网络结构的变动等多种维度的微小扰动，使模型具备了更好的鲁棒性和泛化能力；同时，通过多种扰动的共同引入，能够进一步提升模型的微调效率，使模型能够更快地完成微调训练。在一些实施例中，如图4所示，还提供了一种语言模型的训练装置400，语言模型用于执行目标任务，上述装置400包括：第一获取单元410，被配置为获取样本文本和相应的样本标签，样本标签与目标任务相对应；第二获取单元420，被配置为基于样本文本，获取第一分词序列和第二分词序列，其中，第一分词序列和第二分词序列不相同；第一输入单元430，被配置为将第一分词序列的多个分词输入到第一子模型中，以获得第一子模型输出的第一预测结果；第二输入单元440，被配置为将第二分词序列的多个分词输入到第二子模型中，以获得第二子模型输出的第二预测结果，其中，第一子模型和第二子模型分别通过改变初始语言模型的网络结构获得，并且第一子模型的网络结构和第二子模型的网络结构不相同；第一计算单元450，被配置为基于第一预测结果和第二预测结果，计算第一损失函数；第二计算单元460，被配置为基于第一预测结果、第二预测结果和该样本数据相应的样本标签，计算第二损失函数；以及调整单元470，被配置为基于第一损失函数和第二损失函数，调整初始语言模型的至少一个参数，以获得语言模型。其中，语言模型的训练装置400中的单元410～单元470所执行的操作与上述语言模型的训练方法中的步骤S201～步骤S207的操作类似，在此不做赘述。在一些实施例中，第二获取单元可以包括：切词子单元，被配置为对所述样本文本进行多次随机切词，以获取多个分词序列，其中，所述多个分词序列包括词粒度分词序列以及字词混合粒度分词序列中的至少一者，所述多个分词序列中的每个分词序列均不相同；选择子单元，被配置为在所述多个分词序列中随机选择两个分词序列，以作为所述第一分词序列和所述第二分词序列。在一些实施例中，多个分词序列还可以包括字粒度分词序列。在一些实施例中，第一损失函数可以为相对熵损失函数。在一些实施例中，调整单元可以包括：计算子单元，被配置为对所述第一损失函数和所述第二损失函数进行加权计算，以获取综合损失函数；以及调整子单元，被配置为基于所述综合损失函数，调整所述初始语言模型的至少一个参数。在一些实施例中，上述语言模型的训练装置还包括：第三获取单元，被配置为对所述初始语言模型中的多个神经元进行两次随机掩盖，以分别获得所述第一子模型和所述第二子模型，其中，所述第一子模型中被掩盖的至少一个神经元和所述第二子模型中被掩盖的至少一个神经元不相同，并且，所述被掩盖的至少一个神经元中的每个神经元停止工作。根据本公开的实施例，还提供了一种电子设备、一种可读存储介质和一种计算机程序产品。参考图5，现将描述可以作为本公开的服务器或客户端的电子设备500的结构框图，其是可以应用于本公开的各方面的硬件设备的示例。电子设备旨在表示各种形式的数字电子的计算机设备，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本公开的实现。如图5所示，电子设备500包括计算单元501，其可以根据存储在只读存储器502中的计算机程序或者从存储单元508加载到随机访问存储器503中的计算机程序，来执行各种适当的动作和处理。在RAM503中，还可存储电子设备500操作所需的各种程序和数据。计算单元501、ROM 502以及RAM 503通过总线504彼此相连。输入/输出接口505也连接至总线504。电子设备500中的多个部件连接至I/O接口505，包括：输入单元506、输出单元507、存储单元508以及通信单元509。输入单元506可以是能向电子设备500输入信息的任何类型的设备，输入单元506可以接收输入的数字或字符信息，以及产生与电子设备的用户设置和/或功能控制有关的键信号输入，并且可以包括但不限于鼠标、键盘、触摸屏、轨迹板、轨迹球、操作杆、麦克风和/或遥控器。输出单元507可以是能呈现信息的任何类型的设备，并且可以包括但不限于显示器、扬声器、视频/音频输出终端、振动器和/或打印机。存储单元508可以包括但不限于磁盘、光盘。通信单元509允许电子设备500通过诸如因特网的计算机网络和/或各种电信网络与其他设备交换信息/数据，并且可以包括但不限于调制解调器、网卡、红外通信设备、无线通信收发机和/或芯片组，例如蓝牙TM设备、802.11设备、WiFi设备、WiMax设备、蜂窝通信设备和/或类似物。计算单元501可以是各种具有处理和计算能力的通用和/或专用处理组件。计算单元501的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的计算单元、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。计算单元501执行上文所描述的各个方法和处理，例如上述语言模型训练方法。例如，在一些实施例中，上述语言模型训练方法可被实现为计算机软件程序，其被有形地包含于机器可读介质，例如存储单元508。在一些实施例中，计算机程序的部分或者全部可以经由ROM 502和/或通信单元509而被载入和/或安装到电子设备500上。当计算机程序加载到RAM 503并由计算单元501执行时，可以执行上文描述的上述语言模型训练方法的一个或多个步骤。备选地，在其他实施例中，计算单元501可以通过其他任何适当的方式而被配置为执行上述语言模型训练方法。本文中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、复杂可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本公开的方法的程序代码可以采用一个或多个编程语言的任何组合来编写。这些程序代码可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器或控制器，使得程序代码当由处理器或控制器执行时使流程图和/或框图中所规定的功能/操作被实施。程序代码可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本公开的上下文中，机器可读介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的程序。机器可读介质可以是机器可读信号介质或机器可读储存介质。机器可读介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在计算机上实施此处描述的系统和技术，该计算机具有：用于向用户显示信息的显示装置或者LCD监视器)；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给计算机。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网和互联网。计算机系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，也可以为分布式系统的服务器，或者是结合了区块链的服务器。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本公开中记载的各步骤可以并行地执行、也可以顺序地或以不同的次序执行，只要能够实现本公开公开的技术方案所期望的结果，本文在此不进行限制。虽然已经参照附图描述了本公开的实施例或示例，但应理解，上述的方法、系统和设备仅仅是示例性的实施例或示例，本发明的范围并不由这些实施例或示例限制，而是仅由授权后的权利要求书及其等同范围来限定。实施例或示例中的各种要素可以被省略或者可由其等同要素替代。此外，可以通过不同于本公开中描述的次序来执行各步骤。进一步地，可以以各种方式组合实施例或示例中的各种要素。重要的是随着技术的演进，在此描述的很多要素可以由本公开之后出现的等同要素进行替换。
