标题title
一种基于自适应学习推荐系统生成方法及系统
摘要abst
本发明涉及推荐系统技术领域，且公开了一种基于自适应学习推荐系统生成方法及系统，步骤一、构建模型输入数据结构；步骤二、设置模型训练任务：每一轮迭代都会对以下训练方式进行平均采样并执行；步骤三、建立自适应学习推荐系统，相比于采用大量的特征提取技术获得模型的输入特征值，本模型采用相对简单的特征数据作为输入，节省了相对较多的数据预处理时间并达到了几乎相同的推荐效果，交互性和针对性更强，相比于单纯地对离散时间点特征进行预测，本模型直接对推荐交互过程进行建模，在保证推荐轮次的连续性的同时，在每一轮推荐中有88％‑93％的情况能根据上一轮更新的结果给出更为准确且有效的输出。
权利要求书clms
1.一种基于自适应学习推荐系统生成方法，其特征在于：步骤一、构建模型输入数据结构；步骤二、设置模型训练任务：每一轮迭代都会对以下训练方式进行平均采样并执行；步骤三、建立自适应学习推荐系统。2.根据权利要求1所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤一的具体步骤为：从数据库中获取学生和题目的交互历史数据，并得到学生对题库中对所有题目最近一次的正确情况和作答答案构建学生的特征矩阵Uc、Ua，其中若学生作答正确为1，未曾作答和作答错误为0，此特征也作为训练时的标签，作答的答案为0、1、2、3，分别对应题目选项的A、B、C、D，未曾作答默认为0；在学生已完成的习题中按照一定的比例划分支持集setsupport和查询集setquery，并得到支持掩码矩阵maskinput和查询掩码矩阵maskoutput。3.根据权利要求1所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤二包括有：首轮预测，具体为：a.创建输入矩阵masktrain并将初始化为零；b.根据支持掩码矩阵对每一位学生随机采样n道题目，对输入矩阵masktrain的对应位置更新；c.将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；d.通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；e.通过输入掩码的特征提取层将输入矩阵maskinput转化为嵌入特征embededother；f.将d，e得到的特征拼接并送入输出层得到模型输出output。4.根据权利要求3所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤二还包括有：自适应学习，具体为：a.创建输入矩阵masktrain并将初始化为零；b.执行m次迭代；c.将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；d.通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；e.通过输入掩码的特征提取层将输入矩阵maskinput转化为嵌入特征embededother；f.将d，e得到的特征拼接并送入输出层根据情况计算模型输出output。5.根据权利要求4所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤b的具体操作为：每次将执行以下步骤：将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；通过输入掩码的特征提取层将输入矩阵masktrain转化为嵌入特征embededother；将，得到的特征拼接并送入输出层得到模型输出output；根据模型的输出output选取输出值最大的n道题目，并根据题目的索引更新输入矩阵masktrain。6.根据权利要求1所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤三包括有训练的初始化，具体为：定义元模型modelmeta和子任务模型modelsub；将学生的特征矩阵Uc、Ua按照一定的比例划分为训练集settrain和测试集settest。7.根据权利要求1所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤三还包括有训练阶段：使用元学习算法Losssub对模型参数进行初始化：使用元模型modelmeta参数对子任务模型modelsub初始化；在1-N中随机取样任务n和采样一种训练任务；在训练集中使用支持集对子任务模型modelsub；进行参数优化，而后使用子任务模型modelsub在查询集/＞下计算损失值Losssub，对元模型进行优化modelmeta；在测试集中使用支持集对元模型modelmeta进行微调，而后在查询集下评估元模型modelmeta的能力。8.根据权利要求1所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤三还包括有：开始训练：导入元模型modelmeta参数；在1-N中随机取样任务n和采样一种训练任务；分别在训练集settrain中划分的支持集和查询集/＞计算出损失值losssupport、lossquery，并加权平均得到总损失值losstotal，根据梯度下降算法对模型进行参数的更新；在测试集settest中对模型modelmeta进行评估。9.根据权利要求1所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤三还包括有：推理阶段：a.得到当前学生的特征Uc、Ua；b.设置题目数量为n并将特征Uc、Ua输入模型计算。10.根据权利要求1所述的一种基于自适应学习推荐系统生成方法，其特征在于：所述步骤b中的具体步骤为：创建输入矩阵masktrain并将初始化为零；将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；通过学生特征的嵌入层将输入特征vectorinput转化为学生嵌入特征embededinput；通过输入掩码的特征提取层将输入矩阵masktrain转化为嵌入特征embededother；将,得到的特征拼接并送入输出层得到模型输出output；根据模型的输出output选取输出值最大的n道题目；返回选取题目的索引ID。
说明书desc
技术领域本发明涉及推荐系统技术领域，尤其涉及一种基于自适应学习推荐系统生成方法及系统。技术背景在大数据和人工智能大发展的今天，教育的数字化改革也开始渐渐地引进相关的计算机技术，使得教师工作效率提高，也让学生能够更有针对性地学习，提升自我能力素养。由于传统在线教育辅导系统习题结构单一、学习效率低和没有针对性等诸多因素的存在，智能推荐习题系统的引入能使系统能根据每个学生的学习情况进行分析并进行个性化的习题推荐，提高学生的学习效率。目前的智能推荐习题系统的推荐方式包括以下几种：传统方法：主要利用学生-题目交互表对学生或者题目计算相似度，取最为相似的若干道题目进行推荐。此类方法存在着数据冷启动的问题，数据冷启动即为对于新用户的第一轮推荐，由于没有任何的交互数据，系统无法根据当前用户的交互历史进行计算并推荐。深度学习：使用深度神经网络对学生和题目的交互历史进行建模，得到学生对题目的准确率或重要程度，再根据规则进行推荐。而一般的深度学习推荐方法中，模型学习的为固定时间的交互数据，对于同一用户的不同时间节点的交互预测效果不尽如人意。技术方案为了解决上述方法存在的问题，本发明提出的目的是实现一种自适应学习的，能不受初始数据的影响，并能很好地体现交互性的习题推荐系统。本发明提出的技术方案包括以下步骤：为实现上述目的，本发明提供如下技术方案：一种基于自适应学习推荐系统生成方法及系统，步骤一、构建模型输入数据结构；步骤二、设置模型训练任务：每一轮迭代都会对以下训练方式进行平均采样并执行；步骤三、建立自适应学习推荐系统。优选的，所述步骤一的具体步骤为：从数据库中获取学生和题目的交互历史数据，并得到学生对题库中对所有题目最近一次的正确情况和作答答案构建学生的特征矩阵Uc、Ua，其中若学生作答正确为1，未曾作答和作答错误为0，此特征也作为训练时的标签，作答的答案为0、1、2、3，分别对应题目选项的A、B、C、D，未曾作答默认为0；在学生已完成的习题中按照一定的比例划分支持集setsupport和查询集setquery，并得到支持掩码矩阵maskinput和查询掩码矩阵maskoutput。优选的，所述步骤二包括有：首轮预测，具体为：a.创建输入矩阵masktrain并将初始化为零；b.根据支持掩码矩阵对每一位学生随机采样n道题目，对输入矩阵masktrain的对应位置更新；c.将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；d.通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；e.通过输入掩码的特征提取层将输入矩阵maskinput转化为嵌入特征embededother；f.将d，e得到的特征拼接并送入输出层得到模型输出output。优选的，所述步骤二还包括有：自适应学习，具体为：a.创建输入矩阵masktrain并将初始化为零；b.执行m次迭代；c.将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；d.通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；e.通过输入掩码的特征提取层将输入矩阵maskinput转化为嵌入特征embededother；f.将d，e得到的特征拼接并送入输出层根据情况计算模型输出output。优选的，所述步骤b的具体操作为：每次将执行以下步骤：将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput。通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput。通过输入掩码的特征提取层将输入矩阵masktrain转化为嵌入特征embededother。将，得到的特征拼接并送入输出层得到模型输出output。根据模型的输出output选取输出值最大的n道题目，并根据题目的索引更新输入矩阵masktrain。优选的，所述步骤三包括有训练的初始化，具体为：定义元模型modelmeta和子任务模型modelsub；将学生的特征矩阵Uc、Ua按照一定的比例划分为训练集settrain和测试集settest。优选的，所述步骤三还包括有训练阶段：使用元学习算法Losssub对模型参数进行初始化：使用元模型modelmeta参数对子任务模型modelsub初始化；在1-N中随机取样任务n和采样一种训练任务；在训练集中使用支持集对子任务模型modelsub；进行参数优化，而后使用子任务模型modelsub在查询集/＞下计算损失值Losssub，对元模型进行优化modelmeta。在测试集中使用支持集对元模型modelmeta进行微调，而后在查询集/＞下评估元模型modelmeta的能力。优选的，所述步骤三还包括有：开始训练：导入元模型modelmeta参数；在1-N中随机取样任务n和采样一种训练任务；分别在训练集settrain中划分的支持集和查询集/＞计算出损失值losssupport、lossquery，并加权平均得到总损失值losstotal，根据梯度下降算法对模型进行参数的更新；在测试集settest中对模型modelmeta进行评估。优选的，所述步骤三还包括有：推理阶段：a.得到当前学生的特征Uc、Ua；b.设置题目数量为n并将特征Uc、Ua输入模型计算。优选的，所述步骤b中的具体步骤为：创建输入矩阵masktrain并将初始化为零；将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；通过学生特征的嵌入层将输入特征vectorinput转化为学生嵌入特征embededinput；通过输入掩码的特征提取层将输入矩阵masktrain转化为嵌入特征embededother；将,得到的特征拼接并送入输出层得到模型输出output；根据模型的输出output选取输出值最大的n道题目；返回选取题目的索引ID。与现有技术相比，本发明提供了一种基于自适应学习推荐系统生成方法及系统，具备以下有益效果：1、该基于自适应学习推荐系统生成方法及系统，相比于采用大量的特征提取技术获得模型的输入特征值，本模型采用相对简单的特征数据作为输入，节省了相对较多的数据预处理时间并达到了几乎相同的推荐效果。2、该基于自适应学习推荐系统生成方法及系统，交互性和针对性更强，相比于单纯地对离散时间点特征进行预测，本模型直接对推荐交互过程进行建模，在保证推荐轮次的连续性的同时，在每一轮推荐中有88％-93％的情况能根据上一轮更新的结果给出更为准确且有效的输出。3、该基于自适应学习推荐系统生成方法及系统，在一定程度上解决了数据冷启动的问题，在系统第一次推荐时，传统的基于用户或题目的相似性推荐的推荐算法会因无法得到特征而无法计算，本模型在第一次推荐时对题目的平均准确率为84.80％。4、该基于自适应学习推荐系统生成方法及系统，在多任务联合训练的过程中，相比于将各任务损失值加权平均更新参数的方式，元学习能使模型自行学习参数初始化，并在正式训练完成后使模型对各个任务的性能相差不到5％。附图说明:图1为模型网络结构图；图2为训练任务中首轮预测的计算程序流程图；图3为训练任务中自适应学习的计算程序流程图；图4为元学习参数初始化流程图；图5为模型训练的流程图；图6为模型推理的程序计算流程图；图7方案一获得训练所需格式的数据；图8方案一获得训练所需格式的数据。具体实施方式本发明的实施方式如下：一种基于自适应学习推荐系统生成方法及系统，步骤一、构建模型输入数据结构；步骤二、设置模型训练任务：每一轮迭代都会对以下训练方式进行平均采样并执行；步骤三、建立自适应学习推荐系统。所述步骤一的具体步骤为：从数据库中获取学生和题目的交互历史数据，并得到学生对题库中对所有题目最近一次的正确情况和作答答案构建学生的特征矩阵Uc、Ua，其中若学生作答正确为1，未曾作答和作答错误为0，此特征也作为训练时的标签，作答的答案为0、1、2、3，分别对应题目选项的A、B、C、D，未曾作答默认为0；在学生已完成的习题中按照一定的比例划分支持集setsupport和查询集setquery，并得到支持掩码矩阵maskinput和查询掩码矩阵maskoutput。二、模型结构：1.学生特征的嵌入层，具体表达式如下：embeded＝WembedX+bembed式中X为输入特征向量，Wembed为对应特征的嵌入矩阵,bembed为对应特征的嵌入偏置矩阵。2.特征提取层，对于每一个多层感知机单元具体表达式如下：H＝Wh X+bhO＝Wdropout Relu式中X为输入特征向量，Wh，bh为全连接层的权重参数和偏置矩阵，Wdropout为dropout层权重参数矩阵，Relu为激活函数。具体公式为：f＝max3.输出层。具体表达式如下：output＝σ式中X为输入特征向量，Wout、bembed为输出层权重参数矩阵和偏置矩阵。σ为sigmoid函数,具体表达式为：σ＝1/)所述步骤二包括有：首轮预测，具体为：a.创建输入矩阵masktrain并将初始化为零；b.根据支持掩码矩阵对每一位学生随机采样n道题目，对输入矩阵masktrain的对应位置更新；c.将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；d.通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；e.通过输入掩码的特征提取层将输入矩阵maskinput转化为嵌入特征embededother；f.将d，e得到的特征拼接并送入输出层得到模型输出output。所述步骤二还包括有：自适应学习，具体为：a.创建输入矩阵masktrain并将初始化为零；b.执行m次迭代；c.将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；d.通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；e.通过输入掩码的特征提取层将输入矩阵maskinput转化为嵌入特征embededother；f.将d，e得到的特征拼接并送入输出层根据情况计算模型输出output。所述步骤b的具体操作为：每次将执行以下步骤：将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；通过学生特征的嵌入层将输入特征矩阵vectorinput转化为学生嵌入特征embededinput；通过输入掩码的特征提取层将输入矩阵masktrain转化为嵌入特征embededother；将，得到的特征拼接并送入输出层得到模型输出output；根据模型的输出output选取输出值最大的n道题目，并根据题目的索引更新输入矩阵masktrain。所述步骤三包括有训练的初始化，具体为：定义元模型modelmeta和子任务模型modelsub；将学生的特征矩阵Uc、Ua按照一定的比例划分为训练集settrain和测试集settest。所述步骤三还包括有训练阶段：使用元学习算法Losssub对模型参数进行初始化：使用元模型modelmeta参数对子任务模型modelsub初始化；在1-N中随机取样任务n和采样一种训练任务；在训练集中使用支持集对子任务模型modelsub；进行参数优化，而后使用子任务模型modelsub在查询集/＞下计算损失值Losssub，对元模型modelmeta进行优化；在测试集中使用支持集对元模型modelmeta进行微调，而后在查询集/＞下评估元模型modelmeta的能力；所述步骤三还包括有：开始训练：导入元模型modelmeta参数；在1-N中随机取样任务n和采样一种训练任务；分别在训练集settrain中划分的支持集和查询集/＞计算出损失值losssupport、lossquery，并加权平均得到总损失值losstotal，根据梯度下降算法对模型进行参数的更新；在测试集settest中对模型modelmeta进行评估。所述步骤三还包括有：推理阶段：a.得到当前学生的特征Uc、Ua；b.设置题目数量为n并将特征Uc、Ua输入模型计算。所述步骤b中的具体步骤为：创建输入矩阵masktrain并将初始化为零；将输入矩阵masktrain和特征矩阵Uc、Ua相乘得到输入特征矩阵vectorinput；通过学生特征的嵌入层将输入特征vectorinput转化为学生嵌入特征embededinput；通过输入掩码的特征提取层将输入矩阵masktrain转化为嵌入特征embededother；将,得到的特征拼接并送入输出层得到模型输出output；根据模型的输出output选取输出值最大的n道题目；返回选取题目的索引ID。方案一1.在题库系统的后台数据库中根据技术方案一获得训练所需格式的数据，类似如下图7和8。其中0代表未曾作答和作答错误，1代表作答正确。其中0、1、2、3分别对应题目选项的A、B、C、D。具体表达式为：上式中，N表示所有题目数量，为第i个学生N道题目的作答对错向量，/＞为第i个学生N道题目的作答答案向量,且i∈N+∩，M为学生的数量。2.按照4：1的比例划分支持集setsupport和查询集setquery并以掩码矩阵mask的形式给出，按照4：1的比例划分训练集settrain和测试集settest。具体表示为：式中为第i个学生的支持集掩码矩阵。式中为第i个学生的查询集掩码矩阵。模型损失值的计算方法为二分交叉熵：/＞3.模型在正式训练前，需进行元学习初始化。初始化的目的是使模型的参数在第一步计算取得比较好的效果，即让模型自己学会更好的初始参数，在正式训练中拥有更好的潜力。在初始化的过程中，最终的目的是更新元模型参数，所以需要创建子任务模型进行第一次训练更新，使用更新后的参数对当前任务计算损失值，而后使用该损失值来对元模型进行优化。具体的步骤为:a.定义元模型modelmata，初始化参数为b.对于第k轮迭代,创建子任务模型，载入元模型参数即/＞c.对每个学生的特征向量和输入矩阵/＞在训练集的支持集使用子任务模型计算损失值Losssub，具体公式为：上式中，对应第i个学生的支持集掩码矩阵。d.根据损失值Losssub对子任务模型进行优化,具体公式为:其中式中β为子任务模型学习率。e.对每个学生的特征向量在训练集的查询集使用更新后子任务模型计算损失值Lossmeta，具体公式为：上式中，对应第i个学生的查询集掩码矩阵。f.使用损失值Lossmeta对元模型进行参数优化，具体公式为:其中式中α为元模型学习率。g.在测试集的支持集上使用元模型计算损失值Lossmeta，具体公式为：上式中，对应第i个学生的支持集掩码矩阵。f.使用损失值Loss‘meta对元模型进行参数优化，具体公式为：其中式中是/＞中的输出层参数，α为元模型学习率。4.设立训练任务。在训练时，为了满足系统交互性强的特点,设立自适应学习的训练任务，此任务模拟系统在每一轮推荐的计算过程，即输入特征——得到预测结果——同步结果后再输入特征——继续进行预测，于是使用输入矩阵来记录每轮推荐的结果，并在第一轮推荐前初始化矩阵元素为零，用于模拟新用户的场景，在每轮推荐结束后，输入矩阵根据推荐结果进行更新。在进行m轮推荐后，将输入矩阵与特征矩阵和标签矩阵相乘，筛选出已推荐的题目特征及其标签，而后求其损失值并优化参数。同时，第一轮推荐结果的好坏决定了模型之后推荐结果的质量，所以另外为模型设置了首轮预测任务，用以针对第一轮推荐后的训练，即对于特定数量的任务，随机选取相同数量但不同的题目作为模型的输入进行预测并更新参数。最后为了使模型在应用时拥有更好的泛化性,能够在推荐不同数量题目的要求下性能稳定，训练的方式采用联合训练的方式，即在每轮训练中，先采样推荐任务，再采样训练任务。结合3，具体的步骤伪代码如下：执行训练：按照一定的分布采样训练任务:if训练任务为自适应学习，then对每一个学生i：初始化输入矩阵在m轮推荐轮数迭代中:①输入特征和输入矩阵得到模型输出outputi。②根据模型输出更新具体为：其中index为取对应值的索引，topk为取序列中最大的n个值,代表输入矩阵/＞的第x个元素值，/＞代表第i个学生的支持掩码矩阵。输入特征和输入矩阵得到模型输出outputi。if训练任务为首轮预测任务，then对每一个学生i:初始化输入矩阵在支持集中随机采样n道题目更新具体为：对每一个用户i，/＞其中x∈D，D为随机采样的题目索引集。输入特征和输入矩阵得到模型输出outputi。开始训练：元学习初始化：a.定义元模型modelmeta，初始化参数。b.对于K轮迭代：采样推荐任务n。定义子任务模型modelsub并载入元模型参数modelmeta。将子任务模型modelsub执行训练，得到outputsub。根据outputsub计算得到Losssub，优化更新子任务模型modelsub。将更新后的子任务模型modelsub执行训练得到output’sub。根据output’sub计算得到Lossmeta，优化更新元模型modelmeta。将更新后元模型modelmeta执行训练,得到outputmeta。根据outputmeta计算得到Loss‘meta，对元模型modelmeta进行微调。正式训练：a.定义模型model,载入元模型modelmeta参数。b.对于K轮迭代：采样推荐任务n。将模型model执行训练，得到输出值output。根据output计算得到损失值Losssupport、Lossquery和Loss，具体公式如下:其中式中γ为加权因子。使用损失值Loss优化更新模型model，具体为：其中式中W为模型model参数,η为模型model学习率。5.在训练完成后，模型的推理只需要输入用户对应的特征即可进行推荐并返回推荐题目的索引ID。具体过程为：a.从数据库中得到用户对应特征数据Uc、Ua。b.提取输入掩码矩阵mask＝。其中:c.创建模型并载入模型参数W,即f。d.设置推荐题目数量n，将模型输入模型得到输出output。其中：output＝fe.根据输出output得到推荐题目索引ID列表select。具体为：select＝index)在实际使用时，可结合数据库和前端展示界面，用户与展示界面交互后，后台数据库将特定的用户特征输入推荐模型，得到结果后根据相应的题目索引将相应的题目同步到展示页面即可。
