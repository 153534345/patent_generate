标题title
商品推荐方法、装置、设备及介质
摘要abst
本申请公开了一种商品推荐方法、装置、设备及介质，涉及机器学习领域。该方法包括：在目标商品嵌入向量的监督下，通过用户帐号关系嵌入向量将目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在目标用户帐号嵌入向量的监督下，通过商品关系嵌入向量将目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征计算目标用户帐号表征和目标商品表征之间的距离，得到推荐分数；从目标商品中确定出目标用户帐号的推荐商品。本申请得到的目标用户帐号表征和目标商品表征更具表达性，能够更好地表达目标用户帐号和目标商品的特征，故由此得到的推荐结果的准确性更好。
权利要求书clms
1.一种商品推荐方法，其特征在于，所述方法包括：从知识图谱中获取目标用户帐号实体与邻居用户帐号实体之间的用户帐号实体关系，以及目标商品实体和邻居商品实体之间的商品实体关系；将用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和所述商品实体关系转化为商品嵌入向量和商品关系嵌入向量；在目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量将所述目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在所述目标用户帐号嵌入向量的监督下，通过所述商品关系嵌入向量将所述目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征；计算所述目标用户帐号表征和所述目标商品表征之间的距离，得到推荐分数，所述推荐分数用于表示目标用户帐号和目标商品之间的匹配程度；根据所述推荐分数，从所述目标商品中确定出所述目标用户帐号的推荐商品。2.根据权利要求1所述的方法，其特征在于，所述目标用户帐号嵌入向量包括：第a个用户帐号嵌入向量；所述在目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量将目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征，包括：在所述目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量，融合所述第a个用户帐号实体对应的邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征，a为正整数；融合所述第a个中间用户帐号邻居表征和所述第a个用户帐号嵌入向量，得到第a个中间整体用户帐号表征；通过所述第a个中间整体用户帐号表征更新所述第a个用户帐号嵌入向量；重复上述三个步骤L1次后，将所述第a个用户帐号嵌入向量确定为所述目标用户帐号表征，所述L1为不小于所述目标用户帐号实体的邻居深度的整数。3.根据权利要求2所述的方法，其特征在于，所述第a个用户帐号实体包括j个直接邻居用户帐号实体，所述j个直接邻居用户帐号实体与所述第a个用户帐号实体之间存在直接关系；所述在所述目标商品嵌入向量的监督下，对于所述知识图谱中第a个用户帐号实体，通过所述用户帐号关系嵌入向量，融合所述第a个用户帐号实体对应的邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征，包括：对于所述知识图谱中所述第a个用户帐号实体，通过所述用户帐号关系嵌入向量，将所述目标商品嵌入向量和j个直接邻居用户帐号嵌入向量进行特征交互，得到j个用户帐号注意力得分，j为正整数；加权组合所述j个用户帐号注意力得分和所述j个直接邻居用户帐号嵌入向量，得到所述第a个中间用户帐号邻居表征。4.根据权利要求3所述的方法，其特征在于，所述加权组合所述j个用户帐号注意力得分和所述j个直接邻居用户帐号嵌入向量，得到所述第a中间用户帐号邻居表征，包括：对所述j个用户帐号注意力得分进行归一化，得到归一化后的j个用户帐号注意力得分；加权组合所述归一化后的j个用户帐号注意力得分和所述j个直接邻居用户帐号嵌入向量，得到所述第a个中间用户帐号邻居表征。5.根据权利要求1所述的方法，其特征在于，所述目标商品嵌入向量包括：第b个商品嵌入向量；所述在所述目标用户帐号嵌入向量的监督下，通过所述商品关系嵌入向量将所述目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征，包括：在所述目标用户帐号嵌入向量的监督下，对于所述知识图谱中第b个商品实体，通过所述商品关系嵌入向量，融合所述第b个商品实体对应的邻居商品嵌入向量，得到第b个中间商品邻居表征，b为正整数；聚合所述第b个中间商品邻居表征和所述第b个商品嵌入向量，得到第b个中间整体商品表征；通过所述第b个中间整体商品表征更新所述第b个商品嵌入向量；重复上述三个步骤L2次后，将所述第b个目标商品嵌入向量确定为所述目标商品表征，所述L2为不小于所述目标商品实体的邻居深度的整数。6.根据权利要求5所述的方法，其特征在于，所述第b个商品实体包括k个直接邻居商品实体，所述k个直接邻居商品实体与所述第b个商品实体之间存在直接关系；所述在所述目标用户帐号嵌入向量的监督下，对于所述知识图谱中第b个商品实体，通过所述关系嵌入向量，融合所述b个商品实体对应的邻居商品嵌入向量，得到第b个中间商品邻居表征，包括：对于所述知识图谱中所述第b个商品实体，通过所述商品关系嵌入向量，将所述目标用户帐号嵌入向量和k个直接邻居商品嵌入向量进行特征交互，得到k个商品注意力得分，k为正整数；加权组合所述k个商品注意力得分和所述k个直接邻居商品嵌入向量，得到所述第b个中间商品邻居表征。7.根据权利要求6所述的方法，其特征在于，所述加权组合所述k个商品注意力得分和所述k个直接邻居商品嵌入向量，得到所述第b个中间商品邻居表征，包括：对所述k个商品注意力得分进行归一化，得到归一化后的k个商品注意力得分；加权组合所述归一化后的k个商品注意力得分和所述k个直接邻居商品嵌入向量，得到所述第b个中间商品邻居表征。8.根据权利要求1至7任一所述的方法，其特征在于，所述将用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和所述商品实体关系转化为商品嵌入向量和商品关系嵌入向量，包括：调用卷积网络，通过向量查找操作，将所述用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和所述用户帐号关系嵌入向量，以及将所述商品实体和所述商品实体关系转化为所述商品嵌入向量和所述商品关系嵌入向量。9.根据权利要求8所述的方法，其特征在于，所述方法还包括：获取所述样本知识图谱；调用所述卷积网络，确定所述样本知识图谱中的有效三元组，所述有效三元组包括样本头实体、样本实体关系和样本尾实体；将所述样本头实体转化为样本头实体嵌入向量，将所述样本实体关系转化为样本实体关系嵌入向量，以及将所述样本尾实体转化为样本尾实体嵌入向量；根据所述样本头实体嵌入向量、所述样本实体关系嵌入向量和所述样本尾实体嵌入向量，计算所述样本知识图谱中所有有效三元组的匹配得分和；根据所述匹配得分和对所述卷积网络进行训练。10.根据权利要求1至7任一所述的方法，其特征在于，所述根据所述推荐分数，从所述目标商品中确定出所述目标用户帐号的推荐商品，包括：从所述目标商品中将所述推荐分数大于分数阈值的所述目标商品确定为所述目标用户帐号的推荐商品；或，根据所述推荐分数的排列顺序，从所述目标商品中确定出所述目标用户帐号的推荐商品。11.根据权利要求1至7任一所述的方法，其特征在于，所述方法还包括：获取训练数据集，所述训练数据集包括样本知识图谱和所述样本知识图谱对应的真实标注；调用商品推荐模型，从所述样本知识图谱中获取样本目标用户帐号实体与样本邻居用户帐号实体之间的样本用户帐号实体关系，以及样本目标商品实体和样本邻居商品实体之间的样本商品实体关系；将样本用户帐号实体和所述样本用户帐号实体关系转化为样本用户帐号嵌入向量和样本用户帐号关系嵌入向量，以及将样本商品实体和所述样本商品实体关系转化为样本商品嵌入向量和样本商品关系嵌入向量；在样本目标商品嵌入向量的监督下，通过所述样本用户帐号关系嵌入向量将样本目标用户帐号嵌入向量和样本邻居用户帐号嵌入向量，融合为样本目标用户帐号表征；在所述样本目标用户帐号嵌入向量的监督下，通过所述样本商品关系嵌入向量将所述样本目标商品嵌入向量和样本邻居商品嵌入向量，融合为样本目标商品表征；计算所述样本目标用户帐号表征和所述样本目标商品表征之间的距离，得到样本推荐分数，所述样本推荐分数用于表示样本目标用户帐号和样本目标商品之间的匹配程度；根据所述样本推荐分数与所述真实标注之间的损失差值，对所述商品推荐模型进行训练。12.一种商品推荐装置，其特征在于，所述装置包括：获取模块，用于从知识图谱中获取目标用户帐号实体与邻居用户帐号实体之间的用户帐号实体关系，以及目标商品实体和邻居商品实体之间的商品实体关系；转换模块，用于将用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和所述商品实体关系转化为商品嵌入向量和商品关系嵌入向量；融合模块，用于在目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量将所述目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在所述目标用户帐号嵌入向量的监督下，通过所述商品关系嵌入向量将所述目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征；计算模块，用于计算所述目标用户帐号表征和所述目标商品表征之间的距离，得到推荐分数，所述推荐分数用于表示目标用户帐号和目标商品之间的匹配程度；推荐模块，用于根据所述推荐分数，从所述目标商品中确定出所述目标用户帐号的推荐商品。13.根据权利要求12所述的装置，其特征在于，所述装置还包括：训练模块，用于获取训练数据集，所述训练数据集包括样本知识图谱和所述样本知识图谱对应的真实标注；调用商品推荐模型，从所述样本知识图谱中获取样本目标用户帐号实体与样本邻居用户帐号实体之间的样本用户帐号实体关系，以及样本目标商品实体和样本邻居商品实体之间的样本商品实体关系；将样本用户帐号实体和所述样本用户帐号实体关系转化为样本用户帐号嵌入向量和样本用户帐号关系嵌入向量，以及将样本商品实体和所述样本商品实体关系转化为样本商品嵌入向量和样本商品关系嵌入向量；在样本目标商品嵌入向量的监督下，通过所述样本用户帐号关系嵌入向量将样本目标用户帐号嵌入向量和样本邻居用户帐号嵌入向量，融合为样本目标用户帐号表征；在所述样本目标用户帐号嵌入向量的监督下，通过所述样本商品关系嵌入向量将所述样本目标商品嵌入向量和样本邻居商品嵌入向量，融合为样本目标商品表征；计算所述样本目标用户帐号表征和所述样本目标商品表征之间的距离，得到样本推荐分数，所述样本推荐分数用于表示样本目标用户帐号和样本目标商品之间的匹配程度；根据所述样本推荐分数与所述真实标注之间的损失差值，对所述商品推荐模型进行训练。14.一种计算机设备，其特征在于，所述计算机设备包括：处理器和存储器，所述存储器中存储有至少一条指令、至少一段程序、代码集或指令集，所述至少一条指令、所述至少一段程序、所述代码集或指令集由所述处理器加载并执行以实现如权利要求1至11中任一项所述的商品推荐方法。15.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有至少一条程序代码，所述程序代码由处理器加载并执行以实现如权利要求1至11中任一项所述的商品推荐方法。
说明书desc
技术领域本申请涉及机器学习领域，特别涉及一种商品推荐方法、装置、设备及介质。背景技术随着信息的爆炸式增长，推荐系统在各种在线平台发挥着越来越重要的作用。推荐系统能够从用户的档案或历史交互记录中学习出用户潜在的兴趣偏好，从而为其个性化推荐感兴趣的目标商品。相关技术会训练一个知识图谱嵌入算法模型，通过知识图谱嵌入算法来处理知识图谱中的知识三元组，知识三元组包括实体和实体关系，知识图谱嵌入算法模型根据距离相似性将实体和实体关系分别映射为实体低维向量和实体关系低维向量，然后将上述实体低维向量和实体关系低维向量转化为推荐分数，通过推荐分数的排序确定推荐商品。相关技术只会对具有直接连接关系的知识三元组进行处理，因此只能获取具有直接连接关系的实体的信息，而具有直接连接关系的知识三元组所包含的信息只是知识图谱中的低阶信息，根据低阶信息得到的推荐商品不准确。发明内容本申请实施例提供了一种商品推荐方法、装置、设备及介质，该方法会充分利用知识图谱中的用户帐号信息和商品信息，提高推荐结果的准确性。所述技术方案如下：根据本申请的一个方面，提供了一种商品推荐方法，该方法包括：从知识图谱中获取目标用户帐号实体与邻居用户帐号实体之间的用户帐号实体关系，以及目标商品实体和邻居商品实体之间的商品实体关系；将用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和所述商品实体关系转化为商品嵌入向量和商品关系嵌入向量；在目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量将目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在所述目标用户帐号嵌入向量的监督下，通过所述商品关系嵌入向量将所述目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征；计算所述目标用户帐号表征和所述目标商品表征之间的距离，得到推荐分数，所述推荐分数用于表示目标用户帐号和目标商品之间的匹配程度；根据所述推荐分数，从所述目标商品中确定出所述目标用户帐号的推荐商品。根据本申请的一个方面，提供了一种商品推荐装置，该装置包括：获取模块，用于从知识图谱中获取目标用户帐号实体与邻居用户帐号实体之间的用户帐号实体关系，以及目标商品实体和邻居商品实体之间的商品实体关系；转换模块，用于将用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和所述商品实体关系转化为商品嵌入向量和商品关系嵌入向量；融合模块，用于在目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量将目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在所述目标用户帐号嵌入向量的监督下，通过所述商品关系嵌入向量将所述目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征；计算模块，用于计算所述目标用户帐号表征和所述目标商品表征之间的距离，得到推荐分数，所述推荐分数用于表示目标用户帐号和目标商品之间的匹配程度；推荐模块，用于根据所述推荐分数，从所述目标商品中确定出所述目标用户帐号的推荐商品。在本申请的一个可选设计中，所述融合模块，还用于在所述目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量，融合所述第a个用户帐号实体对应的邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征，a为正整数；融合所述第a个中间用户帐号邻居表征和所述第a个用户帐号嵌入向量，得到第a个中间整体用户帐号表征；通过所述第a个中间整体用户帐号表征更新所述第a个用户帐号嵌入向量；重复上述三个步骤L1次后，将所述第a个用户帐号嵌入向量确定为所述目标用户帐号表征，所述L1为不小于所述目标用户帐号实体的邻居深度的整数。在本申请的一个可选设计中，所述融合模块，还用于对于所述知识图谱中所述第a个用户帐号实体，通过所述用户帐号关系嵌入向量，将所述目标商品嵌入向量和j个直接邻居用户帐号嵌入向量进行特征交互，得到j个用户帐号注意力得分，j为正整数；加权组合所述j个用户帐号注意力得分和所述j个直接邻居用户帐号嵌入向量，得到所述第a个中间用户帐号邻居表征。在本申请的一个可选设计中，所述融合模块，还用于对所述j个用户帐号注意力得分进行归一化，得到归一化后的j个用户帐号注意力得分；加权组合所述归一化后的j个用户帐号注意力得分和所述j个直接邻居用户帐号嵌入向量，得到所述第a个中间用户帐号邻居表征。在本申请的一个可选设计中，所述融合模块，还用于在所述目标用户帐号嵌入向量的监督下，对于所述知识图谱中第b个商品实体，通过所述商品关系嵌入向量，融合所述第b个商品实体对应的邻居商品嵌入向量，得到第b个中间商品邻居表征，b为正整数；聚合所述第b个中间商品邻居表征和所述第b个商品嵌入向量，得到第b中间整体商品表征；通过所述第b个中间整体商品表征更新所述第b个商品嵌入向量；重复上述三个步骤L2次后，将所述第b个目标商品嵌入向量确定为所述目标商品表征，所述L2为不小于所述目标商品实体的邻居深度的整数。在本申请的一个可选设计中，所述融合模块，还用于对于所述知识图谱中所述第b个商品实体，通过所述商品关系嵌入向量，将所述目标用户帐号嵌入向量和k个直接邻居商品嵌入向量进行特征交互，得到k个商品注意力得分，k为正整数；加权组合所述k个商品注意力得分和所述k个直接邻居商品嵌入向量，得到所述第b个中间商品邻居表征。在本申请的一个可选设计中，所述融合模块，还用于对所述k个商品注意力得分进行归一化，得到归一化后的k个商品注意力得分；加权组合所述归一化后的k个商品注意力得分和所述k个直接邻居商品嵌入向量，得到所述第b个中间商品邻居表征。在本申请的一个可选设计中，所述转换模块，还用于调用卷积网络，通过向量查找操作，将所述用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和所述用户帐号关系嵌入向量，以及将所述商品实体和所述商品实体关系转化为所述商品嵌入向量和所述商品关系嵌入向量。在本申请的一个可选设计中，所述装置还包括训练模块；所述训练模块，用于获取所述知识图谱；调用所述卷积网络，确定所述知识图谱中的有效三元组，所述有效三元组包括样本头实体、样本实体关系和样本尾实体；将所述样本头实体转化为样本头实体嵌入向量，将所述样本实体关系转化为样本实体关系嵌入向量，以及将所述样本尾实体转化为样本尾实体嵌入向量；根据所述样本头实体嵌入向量、所述样本实体关系嵌入向量和所述样本尾实体嵌入向量，计算所述样本知识图谱中所有有效三元组的匹配得分和；根据所述匹配得分和对所述卷积网络进行训练。在本申请的一个可选设计中，所述推荐模块，还用于从所述目标商品中将所述推荐分数大于分数阈值的所述目标商品确定为所述目标用户帐号的推荐商品；或，根据所述推荐分数的排列顺序，从所述目标商品中确定出所述目标用户帐号的推荐商品。在本申请的一个可选设计中，所述训练模块，还用于获取训练数据集，所述训练数据集包括样本知识图谱和所述样本知识图谱对应的真实标注；调用商品推荐模型，从所述样本知识图谱中获取样本目标用户帐号实体与样本邻居用户帐号实体之间的样本用户帐号实体关系，以及样本目标商品实体和样本邻居商品实体之间的样本商品实体关系；将样本用户帐号实体和所述样本用户帐号实体关系转化为样本用户帐号嵌入向量和样本用户帐号关系嵌入向量，以及将样本商品实体和所述样本商品实体关系转化为样本商品嵌入向量和样本商品关系嵌入向量；在样本目标商品嵌入向量的监督下，通过所述样本用户帐号关系嵌入向量将样本目标用户帐号嵌入向量和样本邻居用户帐号嵌入向量，融合为样本目标用户帐号表征；在所述样本目标用户帐号嵌入向量的监督下，通过所述样本商品关系嵌入向量将所述样本目标商品嵌入向量和样本邻居商品嵌入向量，融合为样本目标商品表征；计算所述样本目标用户帐号表征和所述样本目标商品表征之间的距离，得到样本推荐分数，所述样本推荐分数用于表示样本目标用户帐号和样本目标商品之间的匹配程度；根据所述样本推荐分数与所述真实标注之间的损失差值，对所述商品推荐模型进行训练。根据本申请的另一方面，提供了一种计算机设备，该计算机设备包括：处理器和存储器，存储器中存储有至少一条指令、至少一段程序、代码集或指令集，至少一条指令、至少一段程序、代码集或指令集由处理器加载并执行以实现如上方面所述的商品推荐方法。根据本申请的另一方面，提供了一种计算机存储介质，计算机可读存储介质中存储有至少一条程序代码，程序代码由处理器加载并执行以实现如上方面所述的商品推荐方法。根据本申请的另一方面，提供了一种计算机程序产品或计算机程序，上述计算机程序产品或计算机程序包括计算机指令，上述计算机指令存储在计算机可读存储介质中。计算机设备的处理器从上述计算机可读存储介质读取上述计算机指令，上述处理器执行上述计算机指令，使得上述计算机设备执行如上方面所述的商品推荐方法。本申请实施例提供的技术方案带来的有益效果至少包括：通过目标用户帐号嵌入向量和邻居用户帐号嵌入向量，得到目标用户帐号表征，通过目标商品嵌入向量和邻居商品嵌入向量，得到目标商品表征。由此得到的目标用户帐号表征既包括目标用户帐号的特征，也包括邻居用户帐号的特征，同样地，目标商品表征既包括目标商品的特征，也包括邻居商品的特征，因此，目标用户帐号表征和目标商品表征更具表达性，能够更好地表达目标用户帐号和目标商品的特征，所以由此得到的推荐结果的准确性更好。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本申请一个示例性实施例提供的计算机系统的结构示意图；图2是本申请一个示例性实施例提供的商品推荐模型的示意图；图3是本申请一个示例性实施例提供的商品推荐方法的流程示意图；图4是本申请一个示例性实施例提供的知识图谱的示意图；图5是本申请一个示例性实施例提供的单层注意力信息传播与聚合子网络层的示意图；图6是本申请一个示例性实施例提供的计算目标用户帐号表征的示意性流程；图7是本申请一个示例性实施例提供的知识图谱用户帐号侧子图；图8是本申请一个示例性实施例提供的计算目标商品表征的示意性流程；图9是本申请一个示例性实施例提供的知识图谱商品侧子图；图10是本申请一个示例性实施例提供的预训练卷积网络方法的流程示意图；图11是本申请一个示例性实施例提供的训练商品推荐模型方法的流程示意图；图12是本申请一个示例性实施例提供的示例性商品推荐方法的流程示意图；图13是本申请一个示例性实施例提供的商品推荐装置的示意图；图14是本申请一个示例性实施例提供的计算机设备的结构示意图。具体实施方式为使本申请的目的、技术方案和优点更加清楚，下面将结合附图对本申请实施方式作进一步地详细描述。首先，对本申请实施例中涉及的名词进行介绍：人工智能：利用数字计算机或者数字计算机控制的机器模拟、延伸和扩展人的智能，感知环境、获取知识并使用知识获得最佳结果的理论、方法、技术及应用系统。换句话说，人工智能是计算机科学的一个综合技术，它企图了解智能的实质，并生产出一种新的能以人类智能相似的方式做出反应的智能机器。人工智能也就是研究各种智能机器的设计原理与实现方法，使机器具有感知、推理与决策的功能。人工智能技术是一门综合学科，涉及领域广泛，既有硬件层面的技术也有软件层面的技术。人工智能基础技术一般包括如传感器、专用人工智能芯片、云计算、分布式存储、大数据处理技术、操作/交互系统、机电一体化等技术。人工智能软件技术主要包括计算机视觉技术、语音处理技术、自然语言处理技术以及机器学习/深度学习等几大方向。机器学习：是一门多领域交叉学科，涉及概率论、统计学、逼近论、凸分析、算法复杂度理论等多门学科。专门研究计算机怎样模拟或实现人类的学习行为，以获取新的知识或技能，重新组织已有的知识结构使之不断改善自身的性能。机器学习是人工智能的核心，是使计算机具有智能的根本途径，其应用遍及人工智能的各个领域。机器学习和深度学习通常包括人工神经网络、置信网络、强化学习、迁移学习、归纳学习、示教学习等技术。知识图谱：是显示知识发展进程与结构关系的一系列各种不同的图形，用可视化技术描述知识资源及其载体，挖掘、分析、构建、绘制和显示知识及它们之间的相互联系。知识图谱包括实体、关系和属性，其中，关系用于表示实体与实体之间的联系，而属性用于表示实体的固有属性。邻居实体：在知识图谱中，通过关系连接起来的实体与实体之间被相互称为邻居实体，这里的关系既包括直接关系，也包括间接关系。因此，对应的实体邻居既包括直接邻居实体，也包括间接邻居实体。商品：表示用于交互的劳动产品，这里的劳动产品既可以是有形的产品，也可以是无形的服务，还可以是虚拟的产品。例如，商品既可以是电子产品、食品、办公用品等这类有形的产品，也可以指保险产品、金融产品等这类无形的服务，还可以是视频、电子图片等这类虚拟的产品。随着人工智能技术研究和进步，人工智能技术在多个领域展开研究和应用，例如常见的智能家居、智能穿戴设备、虚拟助理、智能音箱、智能营销、无人驾驶、自动驾驶、无人机、机器人、智能医疗、智能客服等，相信随着技术的发展，人工智能技术将在更多的领域得到应用，并发挥越来越重要的价值。在商品推荐场景中，通常有用户帐号实体集合以及商品实体集合用户帐号u和商品i的历史交互数据使用一个矩阵Y∈RM×N来表示。在矩阵中，yui＝1意味着用户帐号u和商品i之间存在着交互记录，否则yui＝0。此外，将包含实体集合和关系集合的知识图谱定义为表示实体，表示实体关系。中每个有效三元组表示头实体h和尾实体t之间存在着实体关系r。在推荐场景下的知识图谱，用户帐号和商品都是实体的一部分，即和可选地，有效三元组则包括用户帐号实体三元组、商品实体三元组和用户帐号-商品交互三元组中的至少一种。给定一个用户帐号-商品交互矩阵Y以及用户帐号-商品统一知识图谱本申请的商品推荐模型旨在学习一个预测函数其中，Θ是商品推荐模型的参数，而表示模型所预测的用户帐号u会跟从未交互过的商品i有交互行为的概率。换言之，就是用户帐号u跟商品i的匹配分数，匹配分数越高，就越有可能将商品i推荐给用户帐号u。图1示出了本申请一个示例性实施例提供的计算机系统的结构示意图。计算机系统100包括：终端120和服务器140。终端120上安装有与商品推荐相关的应用程序。该应用程序可以是app中的小程序，也可以是专门的应用程序，也可以是网页客户端。示例性的，用户在终端120上查询推荐商品，或者，终端120接收到由服务器发送的推荐商品的信息。终端120是智能手机、平板电脑、电子书阅读器、MP3播放器、MP4播放器、膝上型便携计算机和台式计算机中的至少一种。终端120通过无线网络或有线网络与服务器140相连。服务器140可以是独立的物理服务器，也可以是多个物理服务器构成的服务器集群或者分布式系统，还可以是提供云服务、云数据库、云计算、云函数、云存储、网络服务、云通信、中间件服务、域名服务、安全服务、CDN、以及大数据和人工智能平台等基础云计算服务的云服务器。服务器140用于为商品推荐的应用程序提供后台服务，并将商品推荐的结果发送到终端120上。可选地，服务器140承担主要计算工作，终端120承担次要计算工作；或者，服务器140承担次要计算工作，终端120承担主要计算工作；或者，服务器140和终端120两者采用分布式计算架构进行协同计算。图2示出了本申请一个示例性实施例提供的商品推荐模型的示意图。商品推荐模型包括：输入嵌入层21、交互注意力层22和预测层23。输入嵌入层21用于从知识图谱中提取实体嵌入向量和实体关系嵌入向量，其中，实体嵌入向量包括用户帐号嵌入向量和商品嵌入向量，实体关系嵌入向量包括用户帐号关系嵌入向量、商品关系嵌入向量和用户帐号-商品关系嵌入向量。输入嵌入层21的输入是知识图谱201，输出是用户帐号嵌入向量和商品嵌入向量。可选地，输入嵌入层21通过ConvE模型、ConvKB模型、R-GCN模型、ConvR模型中的至少一种来实现。交互注意力层22用于通过交互注意力机制得到用户帐号表征和商品表征。交互注意力层22的输入是实体嵌入向量和实体关系嵌入向量，输出是用户帐号表征204和商品表征205。其中，交互注意力层22包括多层注意力信息传播与聚合子网络层。示例性的，在用户帐号侧，包括了L1层注意力信息传播与聚合子网络层，L1表示用户帐号的邻居深度，对于第i层注意力信息传播与聚合子网络层，其输入是第i-1层注意力信息传播与聚合子网络层输出的用户帐号嵌入向量和商品嵌入向量203，输出是用户帐号嵌入向量。示例性的，在商品侧，包括了L2层注意力信息传播与聚合子网络层，L2表示商品的邻居深度，对于第i层注意力信息传播与聚合子网络层，其输入是第i-1层注意力信息传播与聚合子网络层输出的商品嵌入向量和用户帐号嵌入向量202，输出是商品嵌入向量。预测层23用于根据用户帐号表征和商品表征计算推荐分数。预测层23的输入数用户帐号表征204和商品表征205，输出是推荐分数206。可选地，采用点积操作和计算余弦相似度中的至少一种方法计算推荐分数。图3示出了本申请一个示例性实施例提供的商品推荐方法的流程示意图。该方法可由图1所示的终端120或服务器140或其他计算机设备执行，该方法包括以下步骤：步骤302：从知识图谱中获取目标用户帐号实体与邻居用户帐号实体之间的用户帐号实体关系，以及目标商品实体和邻居商品实体之间的商品实体关系。目标用户帐号实体既可以是一个用户帐号，也可以是多个用户帐号。目标商品实体既可以是一个商品，也可以是多个商品。知识图谱包括用户帐号实体和商品实体，其中，用户帐号实体包括目标用户帐号实体与邻居用户帐号实体，目标用户帐号实体是用户帐号实体中的任意一个用户帐号实体，邻居用户帐号实体是目标用户帐号实体的直接邻居实体或间接邻居实体。对应的，商品实体包括目标商品实体与邻居商品实体，目标商品实体是商品实体中的任意一个商品实体，邻居商品实体是目标商品实体的直接邻居实体或间接邻居实体。可选地，用户帐号实体与商品实体之间存在用户帐号-商品关系。示例性的，用户帐号实体402与用户帐号实体405不存在直接的实体关系，但是，用户帐号实体402与用户帐号实体404之间存在实体关系C，用户帐号实体404与用户帐号实体405之间存在实体关系D，因此，用户帐号实体402与用户帐号实体405通过用户帐号404建立了间接的关系，故用户帐号实体405是用户帐号实体402的间接邻居实体。示例性的，如图4所示，知识图谱包括用户帐号实体和商品实体，商品实体401与商品实体403之间存在商品实体关系B，商品实体401与用户帐号实体402之间存在用户帐号-商品关系A。需要说明的是，在本申请实施例中，商品表示的是用于交互的劳动产品，这里的劳动产品既可以是有形的产品，也可以是无形的服务，还可以是虚拟的产品。例如，商品既可以是电子产品、食品、办公用品等这类有形的产品，也可以指保险产品、金融产品等这类无形的服务，还可以是视频、电子图片等这类虚拟的产品。步骤304：将用户帐号实体和用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和商品实体关系转化为商品嵌入向量和商品关系嵌入向量。用户帐号嵌入向量是与用户帐号实体对应的嵌入向量。用户帐号关系嵌入向量是与用户帐号实体关系对应的嵌入向量。商品嵌入向量是与商品实体对应的嵌入向量。商品关系嵌入向量是与商品实体关系对应的嵌入向量。可选地，在本申请的实施例中，调用卷积网络，通过向量查找操作，将用户帐号实体和用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和商品实体关系转化为商品嵌入向量和商品关系嵌入向量。其中，向量查找操作用于根据实体和/或实体关系查找对应的嵌入向量。示例性的，调用卷积网络，通过向量查找操作，根据用户帐号实体在向量存储模块中查找用户帐号嵌入向量；根据用户帐号实体关系在向量存储模块中查找用户帐号关系嵌入向量；根据商品实体在向量存储模块中查找商品嵌入向量；根据商品实体关系在向量存储模块中查找商品关系嵌入向量。向量存储模块内存储有实体-嵌入向量对应关系和实体关系-嵌入向量对应关系中的至少一种。可选地，卷积网络的结构包括ConvE模型、ConvKB模型、R-GCN模型和ConvR模型中的至少一种。本申请对卷积网络的具体结构不做限定。步骤306：在目标商品嵌入向量的监督下，通过用户帐号关系嵌入向量将目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在目标用户帐号嵌入向量的监督下，通过商品关系嵌入向量将目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征。目标用户帐号表征包括目标用户帐号的特征和邻居用户帐号的特征。目标商品表征包括目标商品的特征和邻居商品的特征。可选地，在迭代的方式下，通过注意力信息传播和信息聚合来得到目标用户帐号表征和目标商品表征。由于目标用户帐号实体会随着迭代的进行，接收来自间接邻居用户帐号实体和间接邻居商品实体的信息，因此，目标用户帐号表征和目标商品表征包括知识图谱中的高阶结构化信息。步骤308：计算目标用户帐号表征和目标商品表征之间的距离，得到推荐分数，推荐分数用于表示目标用户帐号和目标商品之间的匹配程度。可选地，通过点积操作，计算目标用户帐号表征和目标商品表征之间的距离。示例性的，使用eu表示目标用户帐号表征，ei表示目标商品表征。则匹配分数其中，σ表示Sigmoid函数。可选地，推荐分数属于区间。可选地，计算目标用户帐号表征和目标商品表征的余弦相似度，得到推荐分数。步骤310：根据推荐分数，从目标商品中确定出目标用户帐号的推荐商品。可选地，从目标商品中将推荐分数大于分数阈值的目标商品确定为目标用户帐号的推荐商品。示例性的，将分数阈值设置为0.5，则将目标商品中推荐分数大于0.5的商品确定为推荐商品。可选地，根据推荐分数的排列顺序，从目标商品中确定出目标用户帐号的推荐商品。示例性的，目标商品A的推荐分数是0.2，目标商品B的推荐分数是0.9，目标商品C的推荐分数是0.45，目标商品D的推荐分数是0.7，目标商品E的推荐分数是0.3，则根据推荐分数将目标商品从大到小进行排列得到“目标商品B-目标商品D-目标商品C-目标商品E-目标商品A”，取该排序中的前两位作为推荐商品，得到推荐商品是目标商品B和目标商品D。综上所述，本实施例通过目标用户帐号嵌入向量和邻居用户帐号嵌入向量，得到目标用户帐号表征，通过目标商品嵌入向量和邻居商品嵌入向量，得到目标商品表征。由此得到的目标用户帐号表征既包括目标用户帐号的特征，也包括邻居用户帐号的特征，同样地，目标商品表征既包括目标商品的特征，也包括邻居商品的特征，因此，目标用户帐号表征和目标商品表征更具表达性，能够更好地表达目标用户帐号和目标商品的特征，所以由此得到的推荐结果的准确性更好。图5示出了本申请一个示例性实施例提供的单层注意力信息传播与聚合子网络层的示意图。图5中以用户帐号侧的单层注意力信息传播与聚合子网络层为例进行说明，首先，表示在第i层注意力信息传播与聚合子网络层中，用户帐号u的直接邻居用户帐号对应的直接邻居用户帐号嵌入向量，其中，表示直接邻居用户帐号构成的集合，k为直接邻居用户帐号的总数。将上述的直接邻居用户帐号嵌入向量与目标商品嵌入向量501通过注意力计算机制得到直接邻居用户帐号嵌入向量的整体表征502，目标商品嵌入向量501表示为ei，整体表征502表示为之后，聚合计算整体表征502和用户帐号实体u的用户帐号表示503得到用户帐号表示504，并将用户帐号表示504传播到第i+1层注意力信息传播与聚合子网络层。其中，用户帐号表示503为eu，用户帐号表示504为eu。在接下来的实施例中，提供了一种示例性的计算目标用户帐号表征的方法，通过交互式注意力机制，有选择地聚合来自邻居用户帐号实体的信息，并通过迭代的方法不断地更新目标用户帐号表征，使得目标用户帐号实体能够接收到较为全面的邻居用户帐号信息。因此从用户帐号侧而言，每个用户帐号实体在目标商品嵌入向量ei的监督下，有选择地聚合来自用户帐号实体n的直接邻居用户帐号实体嵌入向量表示用户帐号实体n的直接邻居用户帐号实体构成的集合)，得到经过信息传播之后，聚合用户帐号嵌入向量和邻居用户帐号嵌入向量以获得将在下一次迭代中使用的值。图6示出了本申请一个示例性实施例提供的计算目标用户帐号表征的示意性流程。该方法可由图1所示的终端120或服务器140或其他计算机设备执行，该方法包括以下步骤：步骤601：在目标商品嵌入向量的监督下，通过用户帐号关系嵌入向量，融合第a个用户帐号实体对应的邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征。第a个用户帐号实体为知识图谱中任意一个用户帐号实体。在本实施例中，融合的第a个用户帐号实体对应的邻居用户帐号嵌入向量可以是全部邻居用户帐号嵌入向量，也可以是部分邻居用户帐号嵌入向量。在本实施例中，目标用户帐号嵌入向量包括：第a个用户帐号嵌入向量，a为正整数。可选地，第a个用户帐号实体包括j个直接邻居用户帐号实体，j个直接邻居用户帐号实体与第a个用户帐号实体之间存在直接关系，j为自然数，则本步骤包括以下子步骤：1、对于知识图谱中第a个用户帐号实体，通过用户帐号关系嵌入向量，将目标商品嵌入向量和j个直接邻居用户帐号嵌入向量进行特征交互，得到j个用户帐号注意力得分。可选地，使用n来表示直接邻居用户帐号实体，u表示第a个用户帐号实体，i表示目标商品，ru,n表示第a个用户帐号实体和直接邻居用户帐号实体之间的关系，则用户帐号注意力得分：其中，ei表示目标商品嵌入向量，表示用户帐号关系嵌入向量，en表示直接邻居用户帐号嵌入向量。可选地，对j个用户帐号注意力得分进行归一化，得到归一化后的j个用户帐号注意力得分。示例性的，归一化后的用户帐号注意力得分：其中，表示未归一化的注意力得分，表示j个直接邻居用户帐号实体构成的集合，表示知识图谱，exp表示取以自然对数e为底的指数函数。2、加权组合j个用户帐号注意力得分和j个直接邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征。第a个中间用户帐号邻居表征用于表示第a个用户帐号实体的直接邻居用户帐号实体的整体表征。可选地，加权组合归一化后的j个用户帐号注意力得分和j个直接邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征。示例性的，通过加权组合归一化后的j个用户帐号注意力得分和j个直接邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征：其中，en表示直接邻居用户帐号嵌入向量，是与en对应的归一化后的用户帐号注意力得分。步骤602：融合第a个中间用户帐号邻居表征和第a个用户帐号嵌入向量，得到第a个中间整体用户帐号表征。第a个中间整体用户帐号表征用于表示在迭代过程还未结束时，第a个用户帐号实体临时的用户帐号表征。可选地，通过聚合器融合第a个中间用户帐号邻居表征和第a个用户帐号嵌入向量，得到第a个中间整体用户帐号表征。示例性的，第a个中间整体用户帐号表征为：其中，agg表示门控聚合器，eu表示第a个用户帐号嵌入向量，式子中的W和b分别为权重参数和偏置参数，表示第a个中间用户帐号邻居表征，⊙表示按元素乘法运算，gu∈Rd是门控向量，d是嵌入向量的维度，进一步地，这里表示连接操作，其中Wg∈Rd×d和bg∈Rd用于计算门控向量的权重和偏置，σ表示Sigmoid函数。步骤603：通过第a个中间整体用户帐号表征更新第a个用户帐号嵌入向量。可选地，使用第a个中间整体用户帐号表征替换第a个用户帐号嵌入向量。步骤604：重复上述三个步骤L1次后，将第a个用户帐号嵌入向量确定为目标用户帐号表征。L1为不小于目标用户帐号实体的邻居深度的整数。示例性的，如图7所示，用户帐号实体U作为目标用户帐号实体，则用户帐号实体A和用户帐号实体B为用户帐号实体U的直接邻居用户帐号实体，用户帐号实体C、用户帐号实体D和用户帐号实体E为用户帐号实体U的间接邻居用户帐号实体，邻居深度为2。示例性的，如图7所示，将用户帐号实体U作为目标用户帐号实体，首先确定出知识图谱还包括用户帐号实体A、用户帐号实体B、用户帐号实体C、用户帐号实体D和用户帐号实体E。则在第一次迭代中，用户帐号实体U的直接邻居用户帐号实体是用户帐号实体A和用户帐号实体B，对用户帐号实体A和用户帐号实体B进行信息聚合，并将聚合后的信息再次聚合到用户帐号实体U中。用户帐号实体A的直接邻居用户帐号实体是用户帐号实体C和用户帐号实体D，用户帐号实体C和用户帐号实体D进行信息聚合，并将聚合后的信息再次聚合到用户帐号实体A中。同样的，用户帐号实体B的直接邻居用户帐号实体是用户帐号实体E，将用户帐号实体E的信息直接聚合到用户帐号实体B中。因此，第一次迭代完成后，用户帐号实体U内包括用户帐号实体U的信息、用户帐号实体A的信息和用户帐号实体B的信息。用户帐号实体A内包括用户帐号实体A的信息、用户帐号实体C的信息和用户帐号实体D的信息。用户帐号实体B内包括用户帐号实体B的信息和用户帐号实体E的信息。而在第二次迭代中，主要是用户帐号实体A和用户帐号实体B进行信息聚合，并将聚合后的信息再次聚合到用户帐号实体U中。由于在第一次迭代完成后，用户帐号实体A还包括用户帐号实体C和用户帐号实体D的信息，用户帐号实体B还包括用户帐号实体E的信息，所以在第二次迭代完成后，用户帐号实体C的信息、用户帐号实体D的信息和用户帐号实体E的信息都被传递到用户帐号实体U中。因此，在第二次迭代完成后，用户帐号实体U不仅包括用户帐号U自身的信息，还包括用户帐号实体A、用户帐号实体B、用户帐号实体C、用户帐号实体D和用户帐号实体E的信息。综上所述，本实施例提供了一种获取目标用户帐号表征的方法，使得目标用户帐号表征能够有效地获取到知识图谱中直接邻居用户帐号实体的信息和间接邻居用户帐号实体的信息，有效地捕捉了知识图谱的高阶结构化信息，而且使用了交互式图注意力机制网络，能够对知识图谱高阶结构化信息和用户商品交互信息进行建模，使得模型能够有效捕捉用户商品协同信号，使得最终的推荐结果更加符合用户的意向。在基于知识图谱的推荐系统中学习目标用户帐号表征和目标商品表征时，强调了交互式学习的重要性，使得学习到的目标用户帐号表征能够感知商品的属性特征，学习到的目标商品表征能够感知用户的兴趣爱好。在接下来的实施例中，提供了一种示例性的计算目标商品表征的方法，通过交互式注意力机制，有选择地聚合来自邻居商品实体的信息，并通过迭代的方法不断地更新目标商品表征，使得目标商品实体能够接收到较为全面的邻居商品信息。因此从商品侧而言，每个商品实体在目标用户帐号嵌入向量eu的监督下，有选择地聚合来自商品实体n的直接商品实体嵌入向量表示商品实体n的直接邻居商品实体构成的集合)，得到经过信息传播之后，聚合商品嵌入向量和邻居商品嵌入向量以获得将在下一次迭代中使用的值。图8示出了本申请一个示例性实施例提供的计算目标商品表征的示意性流程。该方法可由图1所示的终端120或服务器140或其他计算机设备执行，该方法包括以下步骤：步骤801：在目标用户帐号嵌入向量的监督下，对于知识图谱中第b个商品实体，通过商品关系嵌入向量，融合第b个商品实体对应的邻居商品嵌入向量，得到第b个中间商品邻居表征。第b个商品实体为知识图谱中任意一个商品实体。在本实施例中，融合的第b个商品实体对应的邻居商品嵌入向量可以是全部邻居商品嵌入向量，也可以是部分邻居商品嵌入向量。在本实施例中，目标商品嵌入向量包括：第b个商品嵌入向量，b为正整数。可选地，第b个商品实体包括k个直接邻居商品实体，k个直接邻居商品实体与第b个商品实体之间存在直接关系，k为自然数，则本步骤包括以下子步骤：1、对于知识图谱中第b个商品实体，通过商品关系嵌入向量，将目标用户帐号嵌入向量和k个直接邻居商品嵌入向量进行特征交互，得到k个商品注意力得分。可选地，使用n来表示直接邻居商品实体，i表示第b个商品实体，u表示目标用户帐号，ri,n表示第a个用户帐号实体和直接邻居用户帐号实体之间的关系，则商品注意力得分：其中，eu表示目标用户帐号嵌入向量，表示商品关系嵌入向量，en表示直接邻居商品嵌入向量。可选地，对k个商品注意力得分进行归一化，得到归一化后的k个商品注意力得分。示例性的，归一化后的商品注意力得分：其中，表示未归一化的注意力得分，表示k个直接邻居商品实体构成的集合，表示知识图谱，exp表示取以自然对数e为底的指数函数。2、加权组合k个商品注意力得分和k个直接邻居商品嵌入向量，得到第b个中间商品邻居表征。第b个中间商品邻居表征用于表示第b个商品实体的直接邻居商品实体的整体表征。可选地，加权组合归一化后的k个商品注意力得分和k个直接邻居商品嵌入向量，得到第b个中间商品邻居表征。示例性的，通过加权组合归一化后的k个商品注意力得分和k个直接邻居商品嵌入向量，得到第b个中间商品邻居表征：其中，en表示直接邻居用户帐号嵌入向量，是与en对应的归一化后的商品注意力得分。步骤802：聚合第b个中间商品邻居表征和第b个商品嵌入向量，得到第b个中间整体商品表征。第b个中间整体商品表征用于表示在迭代过程还未结束时，第b个商品实体临时的商品表征。可选地，通过聚合器融合第b个中间商品邻居表征和第b个商品嵌入向量，得到第b个中间整体商品表征。示例性的，第b个中间整体商品表征为：其中，agg表示门控聚合器，ei表示第b个商品嵌入向量，式子中的W和b分别为权重参数和偏置参数，表示第b个中间商品邻居表征，⊙表示按元素乘法运算，gi∈Rd是门控向量，d是嵌入向量的维度，进一步地，这里表示连接操作，其中Wg∈Rd×d和bg∈Rd用于计算门控向量的权重和偏置，σ表示Sigmoid函数。步骤803：通过第b个中间整体商品表征更新第b个商品嵌入向量。可选地，使用第b个中间整体商品表征替换第b个商品嵌入向量。步骤804：重复上述三个步骤L2次后，将第b个目标商品嵌入向量确定为目标商品表征。L2为不小于目标商品实体的邻居深度的整数。示例性的，如图9所示，商品实体I作为目标商品实体，则商品实体P和商品实体Q为商品实体I的直接邻居商品实体，商品实体X、商品实体Y和商品实体E为商品实体Z的间接邻居商品实体，邻居深度为2。示例性的，如图9所示，将商品实体I作为目标商品实体，首先确定出知识图谱还包括商品实体P、商品实体Q、商品实体X、商品实体Y和商品实体Z。则在第一次迭代中，商品实体I的直接邻居商品实体是商品实体P和商品实体Q，对商品实体P和商品实体Q进行信息聚合，并将聚合后的信息再次聚合到商品实体I中。商品实体P的直接邻居商品实体是商品实体X和商品实体Y，商品实体X和商品实体Y进行信息聚合，并将聚合后的信息再次聚合到商品实体P中。同样的，商品实体Q的直接邻居商品实体是商品实体Z，将商品实体Z的信息直接聚合到商品实体Q中。因此，第一次迭代完成后，商品实体I内包括商品实体I的信息、商品实体P的信息和商品实体Q的信息。商品实体P内包括商品实体P的信息、商品实体X的信息和商品实体Y的信息。商品实体Q内包括商品实体Q的信息和商品实体Z的信息。而在第二次迭代中，主要是商品实体P和商品实体Q进行信息聚合，并将聚合后的信息再次聚合到商品实体I中。由于在第一次迭代完成后，商品实体P还包括商品实体X和商品实体Y的信息，商品实体Q还包括商品实体Z的信息，所以在第二次迭代完成后，商品实体X的信息、商品实体Y的信息和商品实体Z的信息都被传递到商品实体I中。因此，在第二次迭代完成后，商品实体I不仅包括商品实体I自身的信息，还包括商品实体P、商品实体Q、商品实体X、商品实体Y和商品实体Z的信息。综上所述，本实施例提供了一种获取目标商品表征的方法，使得目标商品表征能够有效地获取到知识图谱中直接邻居商品实体的信息和间接邻居商品实体的信息，有效地捕捉了知识图谱的高阶结构化信息，而且使用了交互式图注意力机制网络，能够对知识图谱高阶结构化信息和用户商品交互信息进行建模，使得模型能够有效捕捉用户商品协同信号，使得最终的推荐结果更加符合用户的意向。在基于知识图谱的推荐系统中学习目标用户帐号表征和目标商品表征时，强调了交互式学习的重要性，使得学习到的目标用户帐号表征能够感知商品的属性特征，学习到的目标商品表征能够感知用户的兴趣爱好。为通过卷积网络得到实体嵌入向量和实体关系嵌入向量，需要先对卷积网络进行训练才能得到较为准确的实体嵌入向量和实体关系嵌入向量。在本申请实施例中以卷积网络ConvE模型为例进行说明。图10示出了本申请一个示例性实施例提供的预训练卷积网络方法的流程示意图。该方法可由图1所示的终端120或服务器140或其他计算机设备执行，该方法包括以下步骤：步骤1001：获取样本知识图谱。样本知识图谱是用作训练样本的知识图谱。步骤1002：调用卷积网络，确定知识图谱中的有效三元组。在知识图谱中，有效三元组包括样本头实体、样本实体关系和样本尾实体，将有效三元组表示为，用于表示样本头实体h和样本尾实体t之间存在着样本实体关系r。步骤1003：将样本头实体转化为样本头实体嵌入向量，将样本实体关系转化为样本实体关系嵌入向量，以及将样本尾实体转化为样本尾实体嵌入向量。步骤1004：根据样本头实体嵌入向量、样本实体关系嵌入向量和样本尾实体嵌入向量，计算样本知识图谱中所有有效三元组的匹配得分和。可选地，计算匹配得分的方法如下：其中，eh∈Rd，er∈Rd和et∈Rd分别是头实体嵌入向量，实体关系嵌入向量和尾实体嵌入向量，d是嵌入向量维度，和表示eh和er的二维重塑，且，d＝d1×d2。ω表示卷积核，vec表示矩阵拉直运算，W为转换矩阵，ReLU表示线性整流函数。步骤1005：根据匹配得分和对卷积网络进行训练。可选地，根据误差反向传播算法，对卷积网络进行训练。可选地，当匹配得分和收敛时，卷积网络训练完成。综上所述，本实施例提供了一种卷积网络的预训练方法，能够有效地得到卷积网络，使得获得的嵌入向量更加准确，提高了计算效率。图11示出了本申请一个示例性实施例提供的训练商品推荐模型方法的流程示意图。该方法可由图1所示的终端120或服务器140或其他计算机设备执行，该方法包括以下步骤：步骤1101：获取训练数据集。训练数据集包括样本知识图谱和样本知识图谱对应的真实标注。若用户帐号实体与商品实体之间存在历史交互记录，则真实标注的值为1；若用户帐号实体与商品实体之间不存在历史交互记录，则真实标注的值为0。步骤1102：调用商品推荐模型，从样本知识图谱中获取样本目标用户帐号实体与样本邻居用户帐号实体之间的样本用户帐号实体关系，以及样本目标商品实体和样本邻居商品实体之间的样本商品实体关系。样本知识图谱包括样本用户帐号实体和样本商品实体，其中，样本用户帐号实体包括样本目标用户帐号实体与样本邻居用户帐号实体，样本目标用户帐号实体是样本用户帐号实体中的任意一个用户帐号实体，样本邻居用户帐号实体是样本目标用户帐号实体的直接邻居实体或间接邻居实体。对应的，样本商品实体包括样本目标商品实体与样本邻居商品实体，样本目标商品实体是样本商品实体中的任意一个商品实体，样本邻居商品实体是样本目标商品实体的直接邻居实体或间接邻居实体。可选地，样本用户帐号实体与样本商品实体之间存在样本用户帐号-商品关系。步骤1103：将样本用户帐号实体和样本用户帐号实体关系转化为样本用户帐号嵌入向量和样本用户帐号关系嵌入向量，以及将样本商品实体和样本商品实体关系转化为样本商品嵌入向量和样本商品关系嵌入向量。可选地，在本申请的实施例中，调用卷积网络，通过向量查找操作，将样本用户帐号实体和样本用户帐号实体关系转化为样本用户帐号嵌入向量和样本用户帐号关系嵌入向量，以及将样本商品实体和样本商品实体关系转化为样本商品嵌入向量和样本商品关系嵌入向量。其中，向量查找操作用于根据实体和/或实体关系查找对应的嵌入向量。可选地，卷积网络的结构包括ConvE模型、ConvKB模型、R-GCN模型和ConvR模型中的至少一种。本申请对卷积网络的具体结构不做限定。步骤1104：在样本目标商品嵌入向量的监督下，通过样本用户帐号关系嵌入向量将样本目标用户帐号嵌入向量和样本邻居用户帐号嵌入向量，融合为样本目标用户帐号表征；在样本目标用户帐号嵌入向量的监督下，通过样本商品关系嵌入向量将样本目标商品嵌入向量和样本邻居商品嵌入向量，融合为样本目标商品表征。样本目标用户帐号表征包括样本目标用户帐号的特征和样本邻居用户帐号的特征。样本目标商品表征包括样本目标商品的特征和样本邻居商品的特征。可选地，在迭代的方式下，通过注意力信息传播和信息聚合来得到样本目标用户帐号表征和样本目标商品表征。由于迭代的过程中分别会聚合来自样本间接邻居用户帐号实体和样本间接邻居商品实体的信息，因此，样本目标用户帐号表征和样本目标商品表征包括样本知识图谱中的高阶结构化信息。步骤1105：计算样本目标用户帐号表征和样本目标商品表征之间的距离，得到样本推荐分数。样本推荐分数用于表示样本目标用户帐号和样本目标商品之间的匹配程度。可选地，通过点积操作，计算目样本标用户帐号表征和样本目标商品表征之间的距离。可选地，样本推荐分数属于区间。可选地，计算样本目标用户帐号表征和样本目标商品表征的余弦相似度，得到样本推荐分数。步骤1106：根据样本推荐分数与真实标注之间的损失差值，对商品推荐模型进行训练。可选地，调用损失函数，计算样本推荐分数与真实标注之间的损失差值；根据损失差值，对商品推荐模型进行训练。示例性的，损失函数：其中，和分别是正样本对和负样本对，u表示目标用户帐号实体，i表示正样本对中的商品实体，j表示负样本对中的商品实体。log表示对数运算，表示商品实体i的样本推荐分数，表示商品实体j的样本推荐分数。综上所述，本实施例提供了一种商品推荐模型的训练方法，能够快速且有效地得到商品推荐模型，缩短了商品推荐模型的训练时间，提高了训练效率。图12示出了本申请一个示例性实施例提供的示例性商品推荐方法的流程示意图。该方法可由图1所示的计算机系统执行，该方法包括以下步骤：步骤1201：终端向服务器发送推荐请求。推荐请求用于向服务器请求返回目标用户帐号的推荐商品。步骤1202：服务器根据推荐请求确定知识图谱。可选地，推荐请求包括目标用户帐号。服务器根据推荐请求包括的目标用户帐号确定知识图谱。步骤1203：服务器从知识图谱中获取目标用户帐号实体与邻居用户帐号实体之间的用户帐号实体关系，以及目标商品实体和邻居商品实体之间的商品实体关系。目标用户帐号实体在本实施例中特指发送推荐请求的终端对应的用户帐号。目标商品实体既可以是一个商品，也可以是多个商品。知识图谱包括用户帐号实体和商品实体，其中，用户帐号实体包括目标用户帐号实体与邻居用户帐号实体，目标用户帐号实体是用户帐号实体中的任意一个用户帐号实体，邻居用户帐号实体是目标用户帐号实体的直接邻居实体或间接邻居实体。对应的，商品实体包括目标商品实体与邻居商品实体，目标商品实体是商品实体中的任意一个商品实体，邻居商品实体是目标商品实体的直接邻居实体或间接邻居实体。可选地，用户帐号实体与商品实体之间存在用户帐号-商品关系。步骤1204：服务器将用户帐号实体和用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和商品实体关系转化为商品嵌入向量和商品关系嵌入向量。用户帐号嵌入向量是与用户帐号实体对应的嵌入向量。用户帐号关系嵌入向量是与用户帐号实体关系对应的嵌入向量。商品嵌入向量是与商品实体对应的嵌入向量。商品关系嵌入向量是与商品实体关系对应的嵌入向量。可选地，在本申请的实施例中，调用卷积网络，通过向量查找操作，将用户帐号实体和用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和商品实体关系转化为商品嵌入向量和商品关系嵌入向量。其中，向量查找操作用于根据实体和/或实体关系查找对应的嵌入向量。步骤1205：在目标商品嵌入向量的监督下，服务器通过用户帐号关系嵌入向量将目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在目标用户帐号嵌入向量的监督下，服务器通过商品关系嵌入向量将目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征。目标用户帐号表征包括目标用户帐号的特征和邻居用户帐号的特征。目标商品表征包括目标商品的特征和邻居商品的特征。可选地，在迭代的方式下，通过注意力信息传播和信息聚合来得到目标用户帐号表征和目标商品表征。由于迭代的过程中会聚合来自间接邻居用户帐号实体和间接邻居商品实体的信息，因此，目标用户帐号表征和目标商品表征包括知识图谱中的高阶结构化信息。步骤1206：服务器计算目标用户帐号表征和目标商品表征之间的距离，得到推荐分数。可选地，通过点积操作，计算目标用户帐号表征和目标商品表征之间的距离。可选地，计算目标用户帐号表征和目标商品表征的余弦相似度，得到推荐分数。步骤1207：服务器根据推荐分数，从目标商品中确定出目标用户帐号的推荐商品。可选地，从目标商品中将推荐分数大于分数阈值的目标商品确定为目标用户帐号的推荐商品。示例性的，将分数阈值设置为0.5，则将目标商品中推荐分数大于0.5的商品确定为推荐商品。可选地，根据推荐分数的排列顺序，从目标商品中确定出目标用户帐号的推荐商品。步骤1208：服务器向终端发送推荐信息。推荐信息包括推荐商品的信息。可选地，推荐信息还包括目标用户帐号信息。步骤1209：终端显示推荐商品。综上所述，本实施例在基于知识图谱的推荐系统中学习目标用户帐号表征和目标商品表征时，强调了交互式学习的重要性，使得学习到的目标用户帐号表征能够感知商品的属性特征，学习到的目标商品表征能够感知用户的兴趣爱好。而且使用了交互式图注意力机制网络，其显式对知识图谱高阶结构化信息和用户商品交互信息进行建模，使得模型能够有效捕捉用户商品协同信号，使得系统的推荐结果更加符合用户的意向。在典型的应用场景如广告推荐中，本实施例可以根据平台流量的众多用户行为如点击和转化数据，以及用户画像和商品画像数据，构建用户商品统一知识图谱，为用户推荐与其意图更相关的商品广告，从而有效提升商品广告的点击转化率，提升用户体验。下面为本申请的装置实施例，对于装置实施例中未详细描述的细节，可以结合参考上述方法实施例中相应的记载，本文不再赘述。图13示出了本申请的一个示例性实施例提供的商品推荐装置的结构示意图。该装置可以通过软件、硬件或者两者的结合实现成为计算机设备的全部或一部分，该装置1300包括：获取模块1301，用于从知识图谱中获取目标用户帐号实体与邻居用户帐号实体之间的用户帐号实体关系，以及目标商品实体和邻居商品实体之间的商品实体关系；转换模块1302，用于将用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和用户帐号关系嵌入向量，以及将商品实体和所述商品实体关系转化为商品嵌入向量和商品关系嵌入向量；融合模块1303，用于在目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量将目标用户帐号嵌入向量和邻居用户帐号嵌入向量，融合为目标用户帐号表征；在所述目标用户帐号嵌入向量的监督下，通过所述商品关系嵌入向量将所述目标商品嵌入向量和邻居商品嵌入向量，融合为目标商品表征；计算模块1304，用于计算所述目标用户帐号表征和所述目标商品表征之间的距离，得到推荐分数，所述推荐分数用于表示目标用户帐号和目标商品之间的匹配程度；推荐模块1305，用于根据所述推荐分数，从所述目标商品中确定出所述目标用户帐号的推荐商品。在本申请的一个可选设计中，所述融合模块1303，还用于在所述目标商品嵌入向量的监督下，通过所述用户帐号关系嵌入向量，融合所述第a个用户帐号实体对应的邻居用户帐号嵌入向量，得到第a个中间用户帐号邻居表征，a为正整数；融合所述第a个中间用户帐号邻居表征和所述第a个用户帐号嵌入向量，得到第a个中间整体用户帐号表征；通过所述第a个中间整体用户帐号表征更新所述第a个用户帐号嵌入向量；重复上述三个步骤L1次后，将所述第a个用户帐号嵌入向量确定为所述目标用户帐号表征，所述L1为不小于所述目标用户帐号实体的邻居深度的整数。在本申请的一个可选设计中，所述融合模块1303，还用于对于所述知识图谱中所述第a个用户帐号实体，通过所述用户帐号关系嵌入向量，将所述目标商品嵌入向量和j个直接邻居用户帐号嵌入向量进行特征交互，得到j个用户帐号注意力得分，j为正整数；加权组合所述j个用户帐号注意力得分和所述j个直接邻居用户帐号嵌入向量，得到所述第a个中间用户帐号邻居表征。在本申请的一个可选设计中，所述融合模块1303，还用于对所述j个用户帐号注意力得分进行归一化，得到归一化后的j个用户帐号注意力得分；加权组合所述归一化后的j个用户帐号注意力得分和所述j个直接邻居用户帐号嵌入向量，得到所述第a个中间用户帐号邻居表征。在本申请的一个可选设计中，所述融合模块1303，还用于在所述目标用户帐号嵌入向量的监督下，对于所述知识图谱中第b个商品实体，通过所述商品关系嵌入向量，融合所述第b个商品实体对应的邻居商品嵌入向量，得到第b个中间商品邻居表征，b为正整数；聚合所述第b个中间商品邻居表征和所述第b个商品嵌入向量，得到第b中间整体商品表征；通过所述第b个中间整体商品表征更新所述第b个商品嵌入向量；重复上述三个步骤L2次后，将所述第b个目标商品嵌入向量确定为所述目标商品表征，所述L2为不小于所述目标商品实体的邻居深度的整数。在本申请的一个可选设计中，所述融合模块1303，还用于对于所述知识图谱中所述第b个商品实体，通过所述商品关系嵌入向量，将所述目标用户帐号嵌入向量和k个直接邻居商品嵌入向量进行特征交互，得到k个商品注意力得分，k为正整数；加权组合所述k个商品注意力得分和所述k个直接邻居商品嵌入向量，得到所述第b个中间商品邻居表征。在本申请的一个可选设计中，所述融合模块1303，还用于对所述k个商品注意力得分进行归一化，得到归一化后的k个商品注意力得分；加权组合所述归一化后的k个商品注意力得分和所述k个直接邻居商品嵌入向量，得到所述第b个中间商品邻居表征。在本申请的一个可选设计中，所述转换模块1302，还用于调用卷积网络，通过向量查找操作，将所述用户帐号实体和所述用户帐号实体关系转化为用户帐号嵌入向量和所述用户帐号关系嵌入向量，以及将所述商品实体和所述商品实体关系转化为所述商品嵌入向量和所述商品关系嵌入向量。在本申请的一个可选设计中，所述装置还包括训练模块1306；所述训练模块，用于获取所述知识图谱；调用所述卷积网络，确定所述知识图谱中的有效三元组，所述有效三元组包括样本头实体、样本实体关系和样本尾实体；将所述样本头实体转化为样本头实体嵌入向量，将所述样本实体关系转化为样本实体关系嵌入向量，以及将所述样本尾实体转化为样本尾实体嵌入向量；根据所述样本头实体嵌入向量、所述样本实体关系嵌入向量和所述样本尾实体嵌入向量，计算所述样本知识图谱中所有有效三元组的匹配得分和；根据所述匹配得分和对所述卷积网络进行训练。在本申请的一个可选设计中，所述推荐模块1305，还用于从所述目标商品中将所述推荐分数大于分数阈值的所述目标商品确定为所述目标用户帐号的推荐商品；或，根据所述推荐分数的排列顺序，从所述目标商品中确定出所述目标用户帐号的推荐商品。在本申请的一个可选设计中，所述训练模块1306，还用于获取训练数据集，所述训练数据集包括样本知识图谱和所述样本知识图谱对应的真实标注；调用商品推荐模型，从所述样本知识图谱中获取样本目标用户帐号实体与样本邻居用户帐号实体之间的样本用户帐号实体关系，以及样本目标商品实体和样本邻居商品实体之间的样本商品实体关系；将样本用户帐号实体和所述样本用户帐号实体关系转化为样本用户帐号嵌入向量和样本用户帐号关系嵌入向量，以及将样本商品实体和所述样本商品实体关系转化为样本商品嵌入向量和样本商品关系嵌入向量；在样本目标商品嵌入向量的监督下，通过所述样本用户帐号关系嵌入向量将样本目标用户帐号嵌入向量和样本邻居用户帐号嵌入向量，融合为样本目标用户帐号表征；在所述样本目标用户帐号嵌入向量的监督下，通过所述样本商品关系嵌入向量将所述样本目标商品嵌入向量和样本邻居商品嵌入向量，融合为样本目标商品表征；计算所述样本目标用户帐号表征和所述样本目标商品表征之间的距离，得到样本推荐分数，所述样本推荐分数用于表示样本目标用户帐号和样本目标商品之间的匹配程度；根据所述样本推荐分数与所述真实标注之间的损失差值，对所述商品推荐模型进行训练。综上所述，本实施例通过目标用户帐号嵌入向量和邻居用户帐号嵌入向量，得到目标用户帐号表征，通过目标商品嵌入向量和邻居商品嵌入向量，得到目标商品表征。由此得到的目标用户帐号表征既包括目标用户帐号的特征，也包括邻居用户帐号的特征，同样地，目标商品既包括目标商品的特征，也包括邻居商品的特征，因此，目标用户帐号表征和目标商品表征更具表达性，能够更好地表达目标用户帐号和目标商品的特征，所以由此得到的推荐结果的准确性更好。图14是根据一示例性实施例示出的一种计算机设备的结构示意图。所述计算机设备1400包括中央处理单元1401、包括随机存取存储器1402和只读存储器1403的系统存储器1404，以及连接系统存储器1404和中央处理单元1401的系统总线1405。所述计算机设备1400还包括帮助计算机设备内的各个器件之间传输信息的基本输入/输出系统1406，和用于存储操作系统1413、应用程序1414和其他程序模块1415的大容量存储设备1407。所述基本输入/输出系统1406包括有用于显示信息的显示器1408和用于用户输入信息的诸如鼠标、键盘之类的输入设备1409。其中所述显示器1408和输入设备1409都通过连接到系统总线1405的输入输出控制器1410连接到中央处理单元1401。所述基本输入/输出系统1406还可以包括输入输出控制器1410以用于接收和处理来自键盘、鼠标、或电子触控笔等多个其他设备的输入。类似地，输入输出控制器1410还提供输出到显示屏、打印机或其他类型的输出设备。所述大容量存储设备1407通过连接到系统总线1405的大容量存储控制器连接到中央处理单元1401。所述大容量存储设备1407及其相关联的计算机设备可读介质为计算机设备1400提供非易失性存储。也就是说，所述大容量存储设备1407可以包括诸如硬盘或者只读光盘驱动器之类的计算机设备可读介质。不失一般性，所述计算机设备可读介质可以包括计算机设备存储介质和通信介质。计算机设备存储介质包括以用于存储诸如计算机设备可读指令、数据结构、程序模块或其他数据等信息的任何方法或技术实现的易失性和非易失性、可移动和不可移动介质。计算机设备存储介质包括RAM、ROM、可擦除可编程只读存储器、带电可擦可编程只读存储器，CD-ROM、数字视频光盘或其他光学存储、磁带盒、磁带、磁盘存储或其他磁性存储设备。当然，本领域技术人员可知所述计算机设备存储介质不局限于上述几种。上述的系统存储器1404和大容量存储设备1407可以统称为存储器。根据本公开的各种实施例，所述计算机设备1400还可以通过诸如因特网等网络连接到网络上的远程计算机设备运行。也即计算机设备1400可以通过连接在所述系统总线1405上的网络接口单元1412连接到网络1411，或者说，也可以使用网络接口单元1412来连接到其他类型的网络或远程计算机设备系统。所述存储器还包括一个或者一个以上的程序，所述一个或者一个以上程序存储于存储器中，中央处理器1401通过执行该一个或一个以上程序来实现上述商品推荐方法的全部或者部分步骤。在示例性实施例中，还提供了一种计算机可读存储介质，所述计算机可读存储介质中存储有至少一条指令、至少一段程序、代码集或指令集，所述至少一条指令、所述至少一段程序、所述代码集或指令集由处理器加载并执行以实现上述各个方法实施例提供的商品推荐方法。本申请还提供一种计算机可读存储介质，所述存储介质中存储有至少一条指令、至少一段程序、代码集或指令集，所述至少一条指令、所述至少一段程序、所述代码集或指令集由所述处理器加载并执行以实现上述方法实施例提供的商品推荐方法。可选地，本申请还提供了一种包含指令的计算机程序产品，当其在计算机设备上运行时，使得计算机设备执行上述各方面所述的商品推荐方法。上述本申请实施例序号仅仅为了描述，不代表实施例的优劣。本领域普通技术人员可以理解实现上述实施例的全部或部分步骤可以通过硬件来完成，也可以通过程序来指令相关的硬件完成，所述的程序可以存储于一种计算机可读存储介质中，上述提到的存储介质可以是只读存储器，磁盘或光盘等。以上所述仅为本申请的可选实施例，并不用以限制本申请，凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
