标题title
基于多通道频谱组合的带状跨海似大地水准面精化方法
摘要abst
本发明公开了一种基于多通道频谱组合的带状跨海似大地水准面精化方法。在传统的只用单一重力场模型确定GNSS正常高的基础上，利用波谱扩展方法作为一个通道，组合经典重力场模型EGM2008和最新的GOCE模型，确定扩展后的模型高程异常；利用偏差地形法作为另一个通道，结合SRTM数据，确定偏差高程异常；利用台球算法优化的BP神经网络法作为第三通道，拟合残余高程异常，最后综合各个通道的结果，确定GNSS点位正常高，达到精化长距离带状跨海似大地水准面的目的。并通过实测GNSS/水准数据，对正常高精度进行讨论分析。结果表明，利用多通道频谱组合的精化方法能极大提高长距离带状区域似大地水准面精度，其它类似区域进行似大地水准面精化时可参考此方法。
权利要求书clms
1.一种基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，包括通道一：利用偏差地形法，根据地形模型位系数求解已知点的DTM高程，根据SRTM原始数据和已知点上DTM高程求出偏差高程异常，计算出目标区的偏差高程异常值；通道二：采用波谱扩展法确定扩展后的高精度重力场模型；通道三：输入通道一得到的偏差高程异常值、平面坐标及地形数据，采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合，得到高程异常拟合值；将高程异常拟合值和偏差高程异常值，统一到扩展后的高精度重力场模型中，确定GNSS点位的正常高。2.根据权利要求1所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在确定GNSS点位的正常高时，采用如下公式实现大地高到正常高的高精度转换：式中，为地面某点大地高，为该点正常高，为高程异常值。3.根据权利要求1所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在通道一中，所述利用偏差地形法，根据地形模型位系数求解已知点的DTM高程包括以下步骤：S101、根据已知点的经纬度坐标，求解出已知点的地心经纬度坐标；S102、根据已知点的地心纬度求解出已知点的地心余纬；S103、根据已知点的地心余纬求出已知点的完全规格化的缔合勒让德函数；S104、根据S101-S103求出的数据以及地形模型位系数文件求出已知点上的DTM高程。4.根据权利要求1所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在通道一中，还包括对SRTM原始数据按照以下步骤进行处理：S01、对SRTM原始数据进行处理，获得包含目标区域及以外200公里范围内的带坐标的格网经纬度和SRTM高程的3秒分辨率数据；S02、对S01中获得的SRTM高程的3秒分辨率数据进行平滑，获得分辨率为15秒的SRTM数据；S03、将目标区外围分成详细区域和粗糙区域两个部分，其中，详细区域格网的分辨率为3秒，粗糙区域格网的分辨率为15秒；S04、根据S03的所有数据，计算出目标区格网点的偏差高程异常值。5.根据权利要求1所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在通道三中，采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合，其中，所述台球算法用于BP神经网络的权值和阈值，具体包括以下步骤：S201、初始化BP神经网络的权值、阈值和适应度函数，将每个权值阈值串视作一个个体，每个个体作为台球桌面上的目标球；适应度函数表示洞口；S202、初始化每个个体的参数，所述参数包括对个体赋以的速度项、惯性项、随机方向以及适应度；所述随机方向表示目标球被击打之后运动的方向，采用的适应度函数如下公式：式中为第个点的高程异常拟合值，为第个点的高程异常真实值，为拟合点和检验点的总个数；S203、每一次迭代表示每一次击球，所有目标球通过迭代向洞口靠近，每次迭代后淘汰离洞口最远的个体，并更新每个个体的参数，重复迭代直至有目标球进洞时，视为满足精度要求，返回最佳权值和阈值给BP神经网络，否则，重复S201-S203；S204、获取满足条件的最优权值和阈值，在BP神经网络中进行GNSS高程异常拟合并计算误差；S205、更新BP神经网络的当前权值和阈值为最优权值和阈值，并判定所述误差是否满足误差精度要求；如果满足要求，则输出拟合的结果，否则，重新获取最优权值和阈值，并重复S204和S205。6.根据权利要求1所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在通道三中，所述地形数据包括EGM2008高程异常、DTM2006高程异常、SRTM高程。7.根据权利要求5所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在通道三中，所述采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合包括：将偏差高程异常值、平面坐标及地形数据输入BP神经网络中，利用优化好的BP神经网络的阈值和权值，对BP神经网络进行训练，输出高程异常拟合值；将输出的高程异常拟合值与高程异常真实值进行比较，计算拟合精度。8.根据权利要求1所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，通道一中，使用重力场模型计算高程异常，根据下式计算得到：式中：表示点的地心经度；表示点的地心余纬；表示点的地心向径；表示点的地心引力常数；表示参考椭球的长半轴，单位为米；表示重力场模型的最大截断阶数；和表示完全规格化的球谐位系数；为完全规格化的缔合勒让德函数，表示正常重力；和分别表示重力场模型的截断次和阶。9.根据权利要求1所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在通道二中采用波谱扩展法确定扩展后的高精度重力场模型包括：采用波谱扩展方法，确定扩展后的模型；综合不同重力场模型频谱所含信息，对GRACE/GOCE重力场模型进行不同阶次的截断，扩展为高精度重力场模型；利用GRACE/GOCE重力场模型，将GNSS数据统一到同一参考框架和潮汐系统，确定扩展后的模型高程异常。10.根据权利要求9所述的基于多通道频谱组合的带状跨海似大地水准面精化方法，其特征在于，在通道二中采用波谱扩展法确定扩展后的高精度重力场模型，包括以下步骤：S301、比较不同重力场模型的阶误差或位系数差的阶误差，并以大地水准面高的形式表示；S302、根据不同阶次选取模型精度高的谱域位系数相加组合，并按照如下公式表示扩展后的重力场模型确定的高程异常：；S303、按照如下公式将不同重力场位系数统一到相同的椭球；；其中，和分别为GOCE卫星重力场模型和EGM2008重力场模型截断阶次计算的点位高程异常；、、分别为GOCE模型位系数、引力常数、长半径；、为EGM2008模型的引力常数、长半径，表示重力场模型的最大截断阶数，n表示重力场模型的截断阶数；表示统一后的椭球场位系数。
说明书desc
技术领域本发明涉及环境测绘技术领域，尤其涉及一种基于多通道频谱组合的带状跨海似大地水准面精化方法。背景技术在空间测量技术还没有出现以前，一般采用天文水准测量或天文重力水准测量来测定大地水准面高度，而采用该方法测定的大地水准面相对精度高，但是分辨率不高。由于GNSS技术的发展和普及，用户可以在全球范围内获得大地高程。然而，传统的获得高程的方法是只用单一重力场模型确定GNSS正常高，无法确定重力场模型的高程异常、无法进一步确定偏差高程异常以及无法确定残余高程异常，不能解决以上问题就意味着对于特殊地形例如长距离的带状区域似大地水准面，现有的方法无法达到对高程精度和分辨率的要求。具体来说，GNSS在高程测量中还存在一定的局限性，即GNSS测量的高程是相对于某参考椭球的大地高，它只是一个几何量，并没有明显的物理意义。而我国采用的是以似大地水准面为基准面的正常高系统，在忽略垂线偏差的情况下，两者的关系如下：其中，为地面某点大地高，为该点正常高，两者差值即为高程异常。因此，除了个别特殊用途外，为了能真正反映地面地势高低及液体的流动方向，将GNSS大地高转换为正常高是非常必要的。一方面，当前国内外常用实现高程转换的方法主要有4种：①数学模型拟合法；②重力似大地水准面拟合法；③加权组合模型法；④神经网络法。常用的数学模型有多项式曲线或曲面拟合法、三次样条曲线拟合法及多面函数拟合法等，但由于模型误差的存在，这些方法仅适用于地形较为简单的地区，在诸如山区和丘陵等地形条件较为复杂的地区，其拟合精度欠佳。重力似大地水准面拟合法在使用过程中需要用到大量高精度、分布均匀的地形数据和重力测量数据，部分数据在实际工程中难以获得，限制了该方法的使用。加权组合模型法相对数学模型法可将拟合效果提升10%～30% ，但其在极端地形情况下的效果仍有待于研究。近年来，BP神经网络方法逐渐被应用于高程转换之中，其拟合精度显著优于传统的数学几何拟合方法，但BP神经网络还存在诸如收敛速度慢、易受局部极小值点困扰和鲁棒性差等缺点，若想进一步提高拟合精度，需采用一些方法对BP神经网络进行优化。神经网络法是近年来被广泛应用于高程转换之中，其中BP神经网络最为常用。不同学者的研究结果均表明，BP神经网络的拟合精度显著优于前述3种方法。然而，BP神经网络自身也存在一定的缺陷，如权值和阈值的随机性导致每次拟合的效果和收敛速度可能相差甚远。针对此问题，一些学者采用一些优化算法对BP神经网络的权值和阈值进行优化，从而削弱这些缺陷对转换精度的影响。目前，已经应用到高程转换的优化算法主要有遗传算法、模拟退火算法和粒子群算法。这些算法相较于传统的BP神经网络均能有效提高高程转换的精度，取得了不错的效果。但是这些优化算法在进行高程转换时，精度较低，适应性不好，因此，需要采用合适的优化算法提高高程转换的精度。另一方面，对于重力场模型来说，伴随着卫星测量重力技术的发展，由地面重力数据和全球卫星重力数据计算而来的全球重力场模型的精度正逐步提高，特别是EIGEN-6C4等模型的发布，使得在利用全球重力场模型对大地高转换正常高的准确度和可靠性得到了极大的提升。然而，由于全球重力场模型阶数有限，存在截断误差，EGM2008和EIGEN-6C4等模型虽然达到了2190阶，但其空间分辨率也仅为9公里左右。在实际应用中由于无法反应重力场的高频信息，所以GNSS大地高转换正常高的准确度需要提升。偏差高程异常可以反映重力场的高频信息，进一步可用来提升真实高程异常的精度。目前已公布的全球重力场模型有很多，它们的分辨率也不尽相同。例如最新的XGM2019e阶数就高达5540阶，而仅利用卫星跟踪数据的重力场模型就只能获得中低阶重力场模型系数，但其一般拥有较高的精度。单一的重力场模型无法适应特殊的地形要求，因此，可以使用谱组合的方式来提高重力场模型的精度，提升真实高程异常的精度。最后，传统的利用重力场在进行高程转换时，仅仅考虑单一重力场的高程异常，并未考虑不同频谱的最佳精度，未考虑到残余的高程异常，故本申请中提出一种波谱扩展法，扩展重力场模型，以此提高大地高向正常高转换的精度。目前，基于GOCE卫星数据最新推出的重力场模型TIM_R6和DIR_R6模型阶次均只达到300阶；而重力场模型EGM2008虽然长波精度略低于最新的卫星重力场模型，但使用了大量的地面及航空等局部重力数据，模型达到了2190阶，能有效的表示短波信息。因此可以将GOCE研制的时域法TIM、直接法DIR重力场模型的中长波信号与EGM2008的短波信号进行频谱组合，扩展为更高精度的重力场模型。发明内容因此，本发明的目的在于提供一种基于多通道频谱组合的带状跨海似大地水准面精化方法，在传统的只用单一重力场模型确定GNSS正常高的基础上，利用波谱扩展方法作为通道1，组合经典重力场模型EGM2008和最新的GOCE模型，确定扩展后的模型高程异常；利用偏差地形法作为通道2，结合SRTM数据，确定偏差高程异常；利用台球算法优化的BP神经网络法作为通道3，得到高程异常拟合值，最后综合通道1、通道2、通道3结果，确定GNSS点位正常高，达到精化长距离带状跨海似大地水准面的目的。并通过实测GNSS/水准数据，对正常高精度进行讨论分析。结果表明，利用多通道频谱组合的精化方法能极大提高长距离带状区域似大地水准面精度，其它类似区域进行似大地水准面精化时可参考此方法。为了实现上述目的，一种基于多通道频谱组合的带状跨海似大地水准面精化方法，包括通道一：利用偏差地形法，根据地形模型位系数求解已知点的DTM高程，根据SRTM原始数据和已知点上DTM高程求出偏差高程异常，计算出目标区的偏差高程异常值；通道二：采用波谱扩展法确定扩展后的高精度重力场模型；通道三：输入通道一输出的偏差高程异常值、平面坐标及其他地形数据，采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合，得到高程异常拟合值值；将输出的高程异常值和偏差高程异常值统一到扩展后的高精度重力场模型中，确定GNSS点位的正常高。进一步优选的，在确定GNSS点位的正常高时，采用如下公式实现大地高到正常高的高精度转换：式中，为地面某点大地高，为该点正常高，为高程异常值。进一步优选的，在通道一中所述利用偏差地形法，根据地形模型位系数求解已知点的DTM高程包括以下步骤：S101、根据已知点的经纬度坐标，求解出已知点的地心经纬度坐标；S102、根据已知点的地心纬度求解出已知点的地心余纬；S103、根据已知点的地心余纬求出已知点的完全规格化的缔合勒让德函数；S104、根据S101-S103求出的数据以及地形模型位系数文件求出已知点上的DTM高程。进一步优选的，在通道一中，还包括对SRTM数据按照以下步骤进行处理：S01、对SRTM数据进行处理，获得包含目标区域及以外约200公里范围内的带坐标的格网经纬度和SRTM高程的3秒分辨率数据；S02、对S01中获得SRTM高程的3秒分辨率数据进行平滑，获得分辨率为15秒的SRTM数据；S03、将目标区外围分成详细区域和粗糙区域两个部分，其中详细区域格网的分辨率为3秒，粗糙区域格网的分辨率为15秒；S04、根据S03的数据计算出目标区格网点的偏差高程异常。进一步优选的，在通道三中，采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合，其中，所述台球算法用于BP神经网络的权值和阈值，具体包括以下步骤：S201、初始化BP神经网络的权值、阈值和适应度函数，将每个权值阈值串视作一个个体，每个个体作为台球桌面上的目标球；适应度函数表示洞口；S202、初始化每个个体的参数，所述参数包括对个体赋以的速度项、惯性项、随机方向以及适应度；所述随机方向表示目标球被击打之后运动的方向，适应度值越小表示离洞口越近，采用的适应度函数如下式：式中为第个点的高程异常拟合值，为第个点的高程异常真实值，为拟合点和检验点的总个数，本适应度函数为每个点高程异常拟合值和真实高程异常的差值的绝对值之和来表示适应度，适应度越好，代表拟合效果越好；S203、每一次迭代表示每一次击球，所有目标球通过迭代向洞口靠近，每次迭代后淘汰离洞口最远的个体，并更新每个每个个体的参数，重复迭代直至有目标球进洞时，视为满足精度要求，返回最佳权值和阈值给BP神经网络，否则，重复S201-S203；S204、获取满足条件的最优权值和阈值，在BP神经网络中进行GNSS高程异常拟合并计算误差；S205、更新BP神经网络的当前权值和阈值为最优权值和阈值，并判定所述误差结果是否满足误差精度要求；如果满足误差精度要求，则输出拟合的结果，否则，重新获取最优权值和阈值，并重复S204和S205。进一步优选的，在通道三中，所述输入地形数据包括EGM2008高程异常、DTM2006高程异常、SRTM高程以及偏差高程异常。进一步优选的，在通道三中，所述采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合包括：将平面坐标和/或多种不同地形数据输入BP神经网络中，利用优化好的BP神经网络的阈值和权值，对BP神经网络进行训练，输出高程异常拟合值；将输出的高程异常拟合值与高程异常真实值进行比较，计算拟合精度。进一步优选的，通道一中，使用重力场模型计算高程异常，根据下式计算得到：式中：表示点的地心经度；表示点的地心余纬；表示点的地心向径；表示点的地心引力常数；表示参考椭球的长半轴，单位为米；表示重力场模型的最大截断阶数；和表示完全规格化的球谐位系数；为完全规格化的缔合勒让德函数，表示正常重力；和分别表示重力场模型的截断次和阶。进一步优选的，在通道二中采用波谱扩展法确定扩展后的高精度重力场模型包括：采用波谱扩展方法，确定扩展后的模型；综合不同重力场模型频谱所含信息，对GRACE/GOCE重力场模型进行不同阶次的截断，扩展为高精度重力场模型；利用GRACE/GOCE重力场模型，将GNSS数据统一到同一参考框架和潮汐系统，确定扩展后的模型高程异常。进一步优选的，在通道二中采用波谱扩展法确定扩展后的高精度重力场模型，包括以下步骤：S301、比较不同重力场模型的阶误差或位系数差的阶误差，并以大地水准面高的形式表示；S302、根据不同阶次选取模型精度高的谱域位系数相加组合，并按照如下公式表示扩展后的重力场模型确定的高程异常：；S303、按照如下公式将不同重力场位系数统一到相同的椭球；；其中，和分别为GOCE卫星重力场模型和EGM2008重力场模型截断阶次计算的点位高程异常；而、、分别为GOCE模型位系数、引力常数、长半径；、为EGM2008模型的引力常数、长半径；表示重力场模型的最大截断阶数，表示重力场模型的截断阶数表示统一后的椭球场位系数。本申请公开的基于多通道频谱组合的带状跨海似大地水准面精化方法，相比于现有技术至少具有以下优点：1、在传统的只用单一重力场模型确定GNSS正常高的基础上，利用波谱扩展方法作为通道1，组合经典重力场模型EGM2008和最新的GOCE模型，确定扩展后的模型高程异常；利用偏差地形法作为通道2，结合SRTM数据，确定偏差高程异常；利用台球算法优化的BP神经网络法作为通道3，得到高程异常拟合值，最后综合通道1、通道2、通道3结果，确定GNSS点位正常高，达到精化长距离带状跨海似大地水准面的目的。并通过实测GNSS/水准数据，对正常高精度进行讨论分析。结果表明，利用多通道频谱组合的精化方法能极大提高长距离带状区域似大地水准面精度，其它类似区域进行似大地水准面精化时可参考此方法。2、基于台球算法对BP神经网络进行优化后在线状和面状区域都能保证良好的拟合效果，尤其是算在法稳定性上更加突出。3、除现有技术输入的平面坐标之外，加入了几种与地形相关的数据，在BP神经网络之中引入了拟合区域的地形信息。实验表明：在拟合点/检验点分布不均匀的情况下，加入与地形有关的数据能显著提高拟合精度；若拟合区域地形本身存在较为明显的规律性，加入地形数据后提升效果更为明显。4、利用偏差高程异常可以补偿重力场模型的截断误差，在本次计算中，地形起伏大的区域，由地形产生的高程异常高达分米级，同时对拟合精度的提升很明显。5、本发明基于谱方法组合的重力场模型，最大程度利用了不同重力场模型各频谱的最高精度信息，较单一重力场模型精度有所提高。6、确定了统一的区域高程基准。将重力场模型基准面、GNSS参考椭球面、我国高程基准面三者进行统一，解决基准不统一造成转换过程中的GNSS正常高系统偏差问题，本发明复杂程度低、计算效率高，且易于实现，可实现高精度高程转换。附图说明图1为本申请基于多通道频谱组合的带状跨海似大地水准面精化方法的流程图；图2为基于台球算法的BP神经网络的高程转换法流程图；图3偏差高程异常流程图；图4为基于波普扩展方法，综合不同重力场模型的GNSS高程转换方法流程图。具体实施方式以下通过附图和具体实施方式对本发明作进一步的详细说明。如图1所示，本发明一方面实施例提供的一种基于多通道频谱组合的带状跨海似大地水准面精化方法，包括：通道一：利用偏差地形法，根据地形模型位系数求解已知点的DTM高程，根据SRTM原始数据和已知点上DTM高程求出偏差高程异常，计算出目标区的偏差高程异常值；通道二：采用波谱扩展法确定扩展后的高精度重力场模型；通道三：输入通道一输出的偏差高程异常值、平面坐标及其他地形数据，采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合，得到高程异常拟合值；最后，将高程异常拟合值和偏差高程异常值统一到扩展后的高精度重力场模型中，确定GNSS点位的正常高。在确定GNSS点位的正常高时，采用如下公式实现大地高到正常高的高精度转换：式中，为地面某点大地高，为该点正常高，两者差值即为高程异常。在通道一中所述利用偏差地形法，根据地形模型位系数求解已知点的DTM高程包括以下步骤：S101、根据已知点的经纬度坐标，求解出已知点的地心经纬度坐标；S102、根据已知点的地心纬度求解出已知点的地心余纬；S103、根据已知点的地心余纬求出已知点的完全规格化的缔合勒让德函数；S104、根据S101-S103求出的数据以及地形模型位系数文件求出已知点上的DTM高程。如图3所示，在通道一中，还包括对SRTM数据按照以下步骤进行处理：S01、对SRTM数据进行处理，获得包含目标区域及以外约200公里范围内的带坐标的格网经纬度和SRTM高程的3秒分辨率的标准格网数据；S02、对S01中获得数据进行平滑，获得分辨率为15秒的低分辨率SRTM数据；S03、将目标区外围标准格网数据分成详细区域和粗糙区域两个部分，其中详细区域格网的分辨率为3秒高分辨率格网，粗糙区域格网的分辨率为15秒低分辨率格网；S04、根据S03的数据计算出目标区格网点的偏差高程异常。进一步优选的，通道一中使用重力场模型计算高程异常，根据下式计算得到：式中：表示点的地心经度；表示点的地心余纬；表示点的地心向径；表示点的地心引力常数；表示参考椭球的长半轴，单位为米；表示重力场模型的最大截断阶数；和表示完全规格化的球谐位系数；为完全规格化的缔合勒让德函数，表示正常重力；和分别表示重力场模型的截断次和阶。为完全规格化的缔合勒让德函数，偏差高程异常就是利用高分辨率的SRTM数据与低分辨率的DTM数据之间的差值来反映高频地形，DTM数据充当高通滤波器，余下部分便是偏差地形，即： 式中：可由SRTM原始数据，经过ArcGIS软件或其他方法处理获得，由DTM模型位系数计算得到，即：式中，为DTM高程模型的最大阶数，和为正则化的球谐高程系数，其他符号含义见公式；表示点的地心经度；表示点的地心余纬；l和表示DTM高程模型的截断次和阶。偏差高程异常的求解可以采用下式计算得到：公式中，为计算点坐标，是计算点与流动点之间的平面距离，是计算点与流动点之间的高程值，为正四边形棱柱的横坐标、纵坐标和竖坐标边界值，为流动点的DTM的高程值，为流动点SRTM的高程值。表示地壳密度，通常取，表示地心引力常数。根据式可计算偏差地形模型引起的高程异常。式中：表示流动点上的正常重力。如图2所示，在通道三中，采用台球算法优化后的BP神经网络，进行GNSS高程异常拟合，其中，所述台球算法用于BP神经网络的权值和阈值，具体包括以下步骤S201、确定网络拓扑结构，一般包括输入层、中间层和输出层；初始化BP神经网络的权值、阈值和适应度函数，将每个权值阈值串视作一个个体，每个个体作为台球桌面上的目标球；适应度函数表示洞口；S202、初始化每个个体的参数，所述参数包括对个体赋以的速度项、惯性项、随机方向以及适应度；所述随机方向表示目标球被击打之后运动的方向，适应度值越小表示离洞口越近，本专利采用的适应度函数为式如下：式中为第个点的高程异常拟合值，为第个点的高程异常真实值，为拟合点和检验点的总个数，本适应度函数即为每个点高程异常拟合值和真实高程异常的差值的绝对值之和来表示适应度，适应度越好，代表拟合效果越好；S203、每一次迭代表示每一次击球，所有目标球通过迭代向洞口靠近，每次迭代后淘汰离洞口最远的个体，并更新每个个体的参数，重复迭代直至满足有目标球进洞，视为满足精度要求，返回最佳权值和阈值给BP神经网络，即计算个体最优值和全局最优值，否则，重复S201-S203；S204、获取满足条件的最优权值和阈值，在BP神经网络中进行GNSS高程异常拟合并计算误差；S205、更新BP神经网络的当前权值和阈值为最优权值和阈值，并判定误差结果是否满足误差精度要求；如果误差精度满足要求，则输出拟合的结果，否则，重新获取最优权值和阈值，并重复S204和S205。BP神经网络相关参数：隐层节点数个数：机器学习参数，建议5-20之间；输入层几点个数：机器学习参数，跟输入数据的维度有关，若只输入平面坐标，则为2，若加入地形数据和平面坐标并行输入，则为3；输出层节点个数：机器学习参数，跟输出数据的维度有关，输出值一般为高程异常值，则输出层节点个数为1；动量因子：机器学习参数，大于0小于1之间，一般为0.2；目标精度：机器学习参数，自行设置，当精度达到目标精度后，BP神经网络停止迭代，输出最终结果；迭代次数：BP神经网络迭代的次数，若达到预定迭代次数时，停止计算并输出结果；台球算法相关参数：进化代数：台球算法进化的次数，大于0，数值越大迭代次数越多；种群数量：机器学习参数，表示桌面存在的目标球个数，大于0，默认为0，数值越大种群数量越大，参与寻优的个体数量越多，但数量过大会降低计算效率，一般设置20左右；速度因子1：机器学习参数，表示目标球运动的快慢，即击球时的力度，大于1，建议设置2；速度因子2：机器学习参数，惯性项，表示球在运动过程中的惯性，大于1，建议设置2；在通道三中，所述输入地形数据包括EGM2008高程异常、DTM2006高程异常、SRTM高程以及偏差高程异常。所述利用BP神经网络，进行GNSS高程异常拟合包括：将平面坐标和/或多种不同地形数据输入BP神经网络中，利用优化好的BP神经网络的阈值和权值，对BP神经网络进行训练，输出高程异常拟合值；将输出的高程异常拟合值与高程异常真实值进行比较，计算拟合精度。与平面坐标一起输入多种地形数据，以向BP神经网络传达更多拟合区域的地形信息，并在拟合点分布极为不均匀的情况下分别讨论了EGM2OO8高程异常、DTM2006高程、RTM高程异常和SRTM高程的优劣，给出了针对不同地形条件和控制点分布下的最佳转换方案。实验结果如下：若拟合点分布不均匀，拟合区域范围不大且地形情况较好，在输入数据中加入SRTM高程、DTM2006高程、剩余地形模型高程异常等数据均能有效提高BP神经网络的拟合精度；若范围较大或地形较复杂，加入SRTM高程效果最佳。无论哪种情况，加入EGM2008高程异常均不能提升精度，可能的原因是EGM2008高程异常并无规律可言，虽然它和真实高程异常相差不大，但缺少与地形的相关性，BP神经网络不能从中学习到规律性的东西。无论是块状区域还是带状区域，四种优化方法均可选择。考虑效率和稳定性，在小范围面状区域，SSA-BP拟合效果最佳；在带状区域，PSO-BP拟合效果最佳；若带状区域范围较大，也可基于结论加入SRTM高程以提高拟合精度。如图4所示，在通道二中采用波谱扩展法确定扩展后的高精度重力场模型包括采用波谱扩展方法，确定扩展后的模型，综合不同重力场模型频谱所含信息，对GRACE/GOCE重力场模型进行不同阶次的截断，扩展为高精度重力场模型；GRACE/GOCE重力场模型，将GNSS数据统一到同一参考框架和潮汐系统，最后确定扩展后的模型高程异常。进一步优选的，在通道二中采用波谱扩展法确定扩展后的高精度重力场模型，包括以下步骤：S301、比较不同重力场模型的阶误差或位系数差的阶误差，并以大地水准面高的形式表示；分析地球重力场模型精度，以更好的对不同重力场模型进行频谱组合。模型精度分析的方法有两种: 一种是比较各自重力场模型的阶误差，另一种是比较不同重力场模型位系数差的阶误差，二者均可以以大地水准面高的形式表示。其中，和为模型位系数的误差或两组位系数的差值，为模型各阶的阶误差或模型位系数差的阶误差；S302、根据不同阶次选取模型精度高的谱域位系数相加组合，并按照如下公式表示扩展后的重力场模型确定的高程异常：S303、按照如下公式将不同重力场位系数统一到相同的椭球；其中，和分别为GOCE卫星重力场模型和EGM2008重力场模型截断阶次计算的点位高程异常；、、分别为GOCE模型位系数、引力常数、长半径；、为EGM2008模型的引力常数、长半径，表示重力场模型的最大截断阶数，表示重力场模型的截断阶数；表示统一后的椭球场位系数。显然，上述实施例仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引伸出的显而易见的变化或变动仍处于本发明创造的保护范围之中。
