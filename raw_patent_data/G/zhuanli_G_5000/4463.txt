标题title
一种基于NFC防伪标签进行跨区窜货检查的处理方法
摘要abst
本发明实施例涉及一种基于NFC防伪标签进行跨区窜货检查的处理方法，所述方法包括：NFC抽检终端进行当前地区代码设置；进行随机数生成处理；向第一标签发送U I D读取指令；接收回发的第一U I D数据；将标签验证密钥加密指令向第一标签发送；接收回发的第一加密数据；将地区校验指令向第一服务器发送；并接收回发的第二地区代码；当第一、第二地区代码匹配时显示正品提示信息；当第一、第二地区代码不匹配且第二地区代码不为无匹配地区代码时显示窜货商品提示信息；当第二地区代码为无匹配地区代码时显示假冒商品提示信息。通过本发明，可以解决常规防窜货操作中由错误的U I D‑地区代码绑定关系导致的窜货、假冒商品失察漏洞。
权利要求书clms
1.一种基于NFC防伪标签进行跨区窜货检查的处理方法，其特征在于，所述方法包括：NFC抽检终端进行当前地区代码设置处理生成对应的第一地区代码；并调用本地的随机数产生模块进行随机数生成处理得到对应的第一随机数；并将当前抽检商品的NFC防伪标签作为对应的第一标签；向所述第一标签发送UID读取指令；并接收所述第一标签回发的第一UID数据；将携带了所述第一随机数的标签验证密钥加密指令向所述第一标签发送；并接收所述第一标签回发的第一加密数据；将携带了所述第一地区代码、所述第一UID数据、所述第一随机数和所述第一加密数据的地区校验指令向远程的第一服务器发送；并接收所述第一服务器回发的第二地区代码；当所述第一、第二地区代码匹配时，显示预设的当前商品为正品且不为窜货商品的提示信息；当所述第一、第二地区代码不匹配且所述第二地区代码不为预设的无匹配地区代码时，显示预设的当前商品为正品但为窜货商品的提示信息；当所述第二地区代码为所述无匹配地区代码时，显示预设的当前商品为假冒商品的提示信息。2.根据权利要求1所述的基于NFC防伪标签进行跨区窜货检查的处理方法，其特征在于，所述NFC抽检终端进行当前地区代码设置处理生成对应的第一地区代码，具体包括：所述NFC抽检终端在用户设定抽检商品地区时，生成抽检商品地区确认界面；所述抽检商品地区确认界面包括人工输入选项和自动定位选项；在用户点击所述人工输入选项时生成对应的商品地区代码输入界面；并通过所述商品地区代码输入界面获取用户输入数据作为对应的所述第一地区代码；在用户点击所述自动定位选项时调用本地的定位模块获取对应的定位信息；并将携带了所述定位信息的地区代码查询指令向所述第一服务器发送，并将所述第一服务器回发的查询指令返回数据作为对应的所述第一地区代码。3.根据权利要求2所述的基于NFC防伪标签进行跨区窜货检查的处理方法，其特征在于，所述将携带了所述定位信息的地区代码查询指令向所述第一服务器发送之后，所述方法还包括：所述第一服务器在接收到所述NFC抽检终端发送的所述地区代码查询指令时，从所述地区代码查询指令中提取出所述定位信息；调用预设的定位地图解析接口对所述定位信息进行地图位置解析生成对应的第一位置数据；所述第一位置数据包括第一国家信息、第一省/州/自治区信息和第一地/市/县信息；查询预设的反映地理位置与销售地区对应关系的第一对应关系表，将所述第一对应关系表中一级位置字段与所述第一国家信息匹配、二级位置字段与所述第一省/州/自治区信息匹配且三级位置字段与所述第一地/市/县信息匹配的第一对应关系记录的第一销售地区代码字段提取出来作为对应的当次查询结果；所述第一对应关系表包括多个所述第一对应关系记录；所述第一对应关系记录包括所述一级位置字段、所述二级位置字段、所述三级位置字段和所述第一销售地区代码字段；将所述当次查询结果作为对应的所述查询指令返回数据向所述NFC抽检终端回发。4.根据权利要求1所述的基于NFC防伪标签进行跨区窜货检查的处理方法，其特征在于，所述向所述第一标签发送UID读取指令之后，所述方法还包括：所述第一标签在接收到所述NFC抽检终端发送的所述UID读取指令时，从本地的存储模块读取预置的标签UID信息作为对应的所述第一UID数据向所述NFC抽检终端回发。5.根据权利要求1所述的基于NFC防伪标签进行跨区窜货检查的处理方法，其特征在于，所述将携带了所述第一随机数的标签验证密钥加密指令向所述第一标签发送之后，所述方法还包括：所述第一标签在接收到所述NFC抽检终端发送的所述标签验证密钥加密指令时，从所述标签验证密钥加密指令中提取出所述第一随机数作为对应的第一待加密明文；并将本地预置的第一标签验证密钥作为对应的第一加密密钥；并基于预设的第一加解密算法使用所述第一加密密钥对所述第一待加密明文进行加密处理生成对应的第一加密密文；并将得到的所述第一加密密文作为对应的所述第一加密数据向NFC抽检终端回发；所述第一加解密算法默认为国密SM7算法。6.根据权利要求1所述的基于NFC防伪标签进行跨区窜货检查的处理方法，其特征在于，所述将携带了所述第一地区代码、所述第一UID数据、所述第一随机数和所述第一加密数据的地区校验指令向远程的第一服务器发送之后，所述方法还包括：所述第一服务器在接收到所述NFC抽检终端发送的所述地区校验指令时，从所述地区校验指令中提取出所述第一地区代码、所述第一UID数据、所述第一随机数和所述第一加密数据；查询预设的第一地区根密钥列表，将所述第一地区根密钥列表中第二销售地区代码字段与所述第一地区代码匹配的第一地区根密钥记录记为对应的第一记录；并将所述第一记录的第一地区根密钥字段提取出来作为对应的第一地区根密钥；所述第一地区根密钥列表包括多个所述第一地区根密钥记录；所述第一地区根密钥记录包括所述第二销售地区代码字段和所述第一地区根密钥字段；以所述第一UID数据为第二待加密明文，并基于预设的第二加解密算法使用所述第一地区根密钥对所述第二待加密明文进行加密处理生成对应的第二加密密文；并将得到的所述第二加密密文作为对应的第二标签验证密钥；第二加解密算法默认为国密SM1算法；以所述第一随机数为第三待加密明文，并基于预设的第一加解密算法使用所述第二标签验证密钥对所述第三待加密明文进行加密处理生成对应的第三加密密文；第一加解密算法默认为国密SM7算法；对所述第三加密密文与所述第一加密数据进行匹配比对；当所述第三加密密文与所述第一加密数据匹配时，设置所述第二地区代码为所述第一地区代码，并将完成设置的所述第二地区代码向所述NFC抽检终端回发；当所述第三加密密文与所述第一加密数据不匹配时，初始化第二记录为空；并对所述第一地区根密钥列表中除所述第一记录之外的其他所述第一地区根密钥记录进行遍历；并在遍历时，将当前遍历的所述第一地区根密钥记录记为当前记录、将所述当前记录的所述第一地区根密钥字段提取出来作为对应的第二地区根密钥，并基于所述第二加解密算法使用所述第二地区根密钥对所述第一UID数据进行加密处理生成对应的第四加密密文，并将所述第四加密密文作为对应的第三标签验证密钥，并基于所述第一加解密算法使用所述第三标签验证密钥对所述第一随机数进行加密处理生成对应的第五加密密文，并对所述第五加密密文与所述第一加密数据进行匹配比对，若所述第五加密密文与所述第一加密数据匹配则将所述第二记录设为所述当前记录并结束后续遍历，若所述第五加密密文与所述第一加密数据不匹配则转至下一个所述第一地区根密钥记录继续遍历直到最后一个所述第一地区根密钥记录遍历结束为止；并在遍历结束时，对所述第二记录是否为空进行识别；若所述第二记录不为空，则将所述第二记录的所述第二销售地区代码字段提取出来作为对应的所述第二地区代码向所述NFC抽检终端回发；若所述第二记录为空，则根据预设的无匹配地区代码对所述第二地区代码进行设置，并将设置后的所述第二地区代码向所述NFC抽检终端回发；向所述NFC抽检终端回发所述第二地区代码之后，若所述第二地区代码与所述第一地区代码不匹配且所述第二地区代码不为无匹配地区代码，则在预设的第一窜货记录列表中新增一个第一窜货记录，并将新增的第一窜货记录的第一标签UID字段设为所述第一UID数据、将第一应发地区字段设为所述第二地区代码、将第一窜货地区字段设为所述第一地区代码；若所述第二地区代码与所述第一地区代码不匹配且所述第二地区代码为无匹配地区代码，则在预设的第一假冒商品记录列表中新增一个第一假冒商品记录，并将新增的第一假冒商品记录的第二标签UID字段设为所述第一UID数据、将第一假冒地区字段设为所述第一地区代码；所述第一窜货记录列表包括多个所述第一窜货记录，所述第一窜货记录包括所述第一标签UID字段、所述第一应发地区字段和所述第一窜货地区字段；所述第一假冒商品记录列表包括多个所述第一假冒商品记录，所述第一假冒商品记录包括所述第二标签UID字段和所述第一假冒地区字段。7.一种电子设备，其特征在于，包括：存储器、处理器和收发器；所述处理器用于与所述存储器耦合，读取并执行所述存储器中的指令，以实现权利要求1-6任一项所述的方法步骤；所述收发器与所述处理器耦合，由所述处理器控制所述收发器进行消息收发。8.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机指令，当所述计算机指令被计算机执行时，使得所述计算机执行权利要求1-6任一项所述的方法的指令。
说明书desc
技术领域本发明涉及数据处理技术领域，特别涉及一种基于NFC防伪标签进行跨区窜货检查的处理方法。背景技术窜货，是指经销商置经销协议和制造商长期利益于不顾，进行产品跨地区降价销售。这在传统的烟草行业中也是屡见不鲜。目前各烟厂传统的防窜货操作就是在商品上加载近场通信防伪标签，并在商品进入各地区物流、销售渠道之前将NFC防伪标签的标签UID信息与销售地区代码绑定，并定期对各销售地区的商品进行抽检，抽检时通过查询标签UID信息与销售地区代码的绑定关系来确认是否发生窜货。这种处理方式存在一个漏洞，那就是标签UID信息与销售地区代码的绑定关系一般都是通过人工操作实现的，在人工操作时因为操作数据量很大很难保证不发生错录、漏录的问题，而一旦发生这些错误操作就有可能对窜货商品失察，甚至还会把正品识别成假冒商品。另外，这种处理方式随着绑定关系的增加，其后台检查效率也会明显降低。发明内容本发明的目的，就是针对现有技术的缺陷，提供一种基于NFC防伪标签进行跨区窜货检查的处理方法、电子设备及计算机可读存储介质；预先为各个销售片区分配一个唯一的地区根密钥，并在商品进入各地区物流、销售渠道之前基于地区根密钥和标签UID信息为各个NFC防伪标签生成一个唯一的标签验证密钥加载到标签上；在进行跨区窜货检查时，由前端的NFC抽检终端获取抽检商品的地区代码，再通过NFC防伪标签的标签验证密钥对一个随机数做一次加密得到加密数据，再由NFC抽检终端将地区代码、NFC防伪标签的标签UID信息、随机数和加密数据一并发往后台服务器进行检查，后台服务器根据地区代码对应的地区根密钥+标签UID信息分散出对等的标签验证密钥，再基于该标签验证密钥对随机数进行加密，再基于当次加密密文与NFC抽检终端上传的加密数据的比对结果来判断是否发生窜货、是否为假冒商品，并将判断结果回发给NFC抽检终端进行显示。通过本发明，给出了一种新的跨区窜货检查处理机制，这种新的处理机制中后台服务器只需保存为数很少的地区根密钥、并不需要对任何NFC防伪标签的标签验证密钥进行保存，更不需要在后台服务器上通过人工操作方式对各个标签验证密钥与地区根密钥进行绑定，自然也就不会发生类似常规防窜货操作中由绑定关系错误导致的窜货商品、假冒商品失察等问题；这种新的处理机制在后台服务器不存在大量检索的问题，每次只做很少次数的加密计算，每次检查的处理时长并不会随着标签数量的增加而发生关联波动，相对常规防窜货操作而言本发明的检查效率得到明显提高；本发明提供的这种处理机制既可以作为一种独立的跨区窜货检查技术方案，也可以作为常规防窜货操作的补充技术方案并在常规方案出错时对其进行修正。为实现上述目的，本发明实施例第一方面提供了一种基于NFC防伪标签进行跨区窜货检查的处理方法，所述方法包括：NFC抽检终端进行当前地区代码设置处理生成对应的第一地区代码；并调用本地的随机数产生模块进行随机数生成处理得到对应的第一随机数；并将当前抽检商品的NFC防伪标签作为对应的第一标签；向所述第一标签发送UID读取指令；并接收所述第一标签回发的第一UID数据；将携带了所述第一随机数的标签验证密钥加密指令向所述第一标签发送；并接收所述第一标签回发的第一加密数据；将携带了所述第一地区代码、所述第一UID数据、所述第一随机数和所述第一加密数据的地区校验指令向远程的第一服务器发送；并接收所述第一服务器回发的第二地区代码；当所述第一、第二地区代码匹配时，显示预设的当前商品为正品且不为窜货商品的提示信息；当所述第一、第二地区代码不匹配且所述第二地区代码不为预设的无匹配地区代码时，显示预设的当前商品为正品但为窜货商品的提示信息；当所述第二地区代码为所述无匹配地区代码时，显示预设的当前商品为假冒商品的提示信息。优选的，所述NFC抽检终端进行当前地区代码设置处理生成对应的第一地区代码，具体包括：所述NFC抽检终端在用户设定抽检商品地区时，生成抽检商品地区确认界面；所述抽检商品地区确认界面包括人工输入选项和自动定位选项；在用户点击所述人工输入选项时生成对应的商品地区代码输入界面；并通过所述商品地区代码输入界面获取用户输入数据作为对应的所述第一地区代码；在用户点击所述自动定位选项时调用本地的定位模块获取对应的定位信息；并将携带了所述定位信息的地区代码查询指令向所述第一服务器发送，并将所述第一服务器回发的查询指令返回数据作为对应的所述第一地区代码。进一步的，所述将携带了所述定位信息的地区代码查询指令向所述第一服务器发送之后，所述方法还包括：所述第一服务器在接收到所述NFC抽检终端发送的所述地区代码查询指令时，从所述地区代码查询指令中提取出所述定位信息；调用预设的定位地图解析接口对所述定位信息进行地图位置解析生成对应的第一位置数据；所述第一位置数据包括第一国家信息、第一省/州/自治区信息和第一地/市/县信息；查询预设的反映地理位置与销售地区对应关系的第一对应关系表，将所述第一对应关系表中一级位置字段与所述第一国家信息匹配、二级位置字段与所述第一省/州/自治区信息匹配且三级位置字段与所述第一地/市/县信息匹配的第一对应关系记录的第一销售地区代码字段提取出来作为对应的当次查询结果；所述第一对应关系表包括多个所述第一对应关系记录；所述第一对应关系记录包括所述一级位置字段、所述二级位置字段、所述三级位置字段和所述第一销售地区代码字段；将所述当次查询结果作为对应的所述查询指令返回数据向所述NFC抽检终端回发。优选的，所述向所述第一标签发送UID读取指令之后，所述方法还包括：所述第一标签在接收到所述NFC抽检终端发送的所述UID读取指令时，从本地的存储模块读取预置的标签UID信息作为对应的所述第一UID数据向所述NFC抽检终端回发。优选的，所述将携带了所述第一随机数的标签验证密钥加密指令向所述第一标签发送之后，所述方法还包括：所述第一标签在接收到所述NFC抽检终端发送的所述标签验证密钥加密指令时，从所述标签验证密钥加密指令中提取出所述第一随机数作为对应的第一待加密明文；并将本地预置的第一标签验证密钥作为对应的第一加密密钥；并基于预设的第一加解密算法使用所述第一加密密钥对所述第一待加密明文进行加密处理生成对应的第一加密密文；并将得到的所述第一加密密文作为对应的所述第一加密数据向NFC抽检终端回发；所述第一加解密算法默认为国密SM7算法。优选的，所述将携带了所述第一地区代码、所述第一UID数据、所述第一随机数和所述第一加密数据的地区校验指令向远程的第一服务器发送之后，所述方法还包括：所述第一服务器在接收到所述NFC抽检终端发送的所述地区校验指令时，从所述地区校验指令中提取出所述第一地区代码、所述第一UID数据、所述第一随机数和所述第一加密数据；查询预设的第一地区根密钥列表，将所述第一地区根密钥列表中第二销售地区代码字段与所述第一地区代码匹配的第一地区根密钥记录记为对应的第一记录；并将所述第一记录的第一地区根密钥字段提取出来作为对应的第一地区根密钥；所述第一地区根密钥列表包括多个所述第一地区根密钥记录；所述第一地区根密钥记录包括所述第二销售地区代码字段和所述第一地区根密钥字段；以所述第一UID数据为第二待加密明文，并基于预设的第二加解密算法使用所述第一地区根密钥对所述第二待加密明文进行加密处理生成对应的第二加密密文；并将得到的所述第二加密密文作为对应的第二标签验证密钥；第二加解密算法默认为国密SM1算法；以所述第一随机数为第三待加密明文，并基于预设的第一加解密算法使用所述第二标签验证密钥对所述第三待加密明文进行加密处理生成对应的第三加密密文；第一加解密算法默认为国密SM7算法；对所述第三加密密文与所述第一加密数据进行匹配比对；当所述第三加密密文与所述第一加密数据匹配时，设置所述第二地区代码为所述第一地区代码，并将完成设置的所述第二地区代码向所述NFC抽检终端回发；当所述第三加密密文与所述第一加密数据不匹配时，初始化第二记录为空；并对所述第一地区根密钥列表中除所述第一记录之外的其他所述第一地区根密钥记录进行遍历；并在遍历时，将当前遍历的所述第一地区根密钥记录记为当前记录、将所述当前记录的所述第一地区根密钥字段提取出来作为对应的第二地区根密钥，并基于所述第二加解密算法使用所述第二地区根密钥对所述第一UID数据进行加密处理生成对应的第四加密密文，并将所述第四加密密文作为对应的第三标签验证密钥，并基于所述第一加解密算法使用所述第三标签验证密钥对所述第一随机数进行加密处理生成对应的第五加密密文，并对所述第五加密密文与所述第一加密数据进行匹配比对，若所述第五加密密文与所述第一加密数据匹配则将所述第二记录设为所述当前记录并结束后续遍历，若所述第五加密密文与所述第一加密数据不匹配则转至下一个所述第一地区根密钥记录继续遍历直到最后一个所述第一地区根密钥记录遍历结束为止；并在遍历结束时，对所述第二记录是否为空进行识别；若所述第二记录不为空，则将所述第二记录的所述第二销售地区代码字段提取出来作为对应的所述第二地区代码向所述NFC抽检终端回发；若所述第二记录为空，则根据预设的无匹配地区代码对所述第二地区代码进行设置，并将设置后的所述第二地区代码向所述NFC抽检终端回发；向所述NFC抽检终端回发所述第二地区代码之后，若所述第二地区代码与所述第一地区代码不匹配且所述第二地区代码不为无匹配地区代码，则在预设的第一窜货记录列表中新增一个第一窜货记录，并将新增的第一窜货记录的第一标签UID字段设为所述第一UID数据、将第一应发地区字段设为所述第二地区代码、将第一窜货地区字段设为所述第一地区代码；若所述第二地区代码与所述第一地区代码不匹配且所述第二地区代码为无匹配地区代码，则在预设的第一假冒商品记录列表中新增一个第一假冒商品记录，并将新增的第一假冒商品记录的第二标签UID字段设为所述第一UID数据、将第一假冒地区字段设为所述第一地区代码；所述第一窜货记录列表包括多个所述第一窜货记录，所述第一窜货记录包括所述第一标签UID字段、所述第一应发地区字段和所述第一窜货地区字段；所述第一假冒商品记录列表包括多个所述第一假冒商品记录，所述第一假冒商品记录包括所述第二标签UID字段和所述第一假冒地区字段。本发明实施例第二方面提供了一种电子设备，包括：存储器、处理器和收发器；所述处理器用于与所述存储器耦合，读取并执行所述存储器中的指令，以实现上述第一方面所述的方法步骤；所述收发器与所述处理器耦合，由所述处理器控制所述收发器进行消息收发。本发明实施例第三方面提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机指令，当所述计算机指令被计算机执行时，使得所述计算机执行上述第一方面所述的方法的指令。本发明实施例提供了一种基于NFC防伪标签进行跨区窜货检查的处理方法、电子设备及计算机可读存储介质，预先为各个销售片区分配一个唯一的地区根密钥，并在商品进入各地区物流、销售渠道之前基于地区根密钥和标签UID信息为各个NFC防伪标签生成一个唯一的标签验证密钥加载到标签上；在进行跨区窜货检查时，由前端的NFC抽检终端获取抽检商品的地区代码，再通过NFC防伪标签的标签验证密钥对一个随机数做一次加密得到加密数据，再由NFC抽检终端将地区代码、NFC防伪标签的标签UID信息、随机数和加密数据一并发往后台服务器进行检查，后台服务器根据地区代码对应的地区根密钥+标签UID信息分散出对等的标签验证密钥，再基于该标签验证密钥对随机数进行加密，再基于当次加密密文与NFC抽检终端上传的加密数据的比对结果来判断是否发生窜货、是否为假冒商品，并将判断结果回发给NFC抽检终端进行显示。通过本发明，给出了一种新的跨区窜货检查处理机制，这种新的处理机制中后台服务器只需保存为数很少的地区根密钥、并不需要对任何NFC防伪标签的标签验证密钥进行保存，更不需要在后台服务器上通过人工操作方式对各个标签验证密钥与地区根密钥进行绑定，自然也就解决了常规防窜货操作中由绑定关系错误导致的窜货、假冒商品失察漏洞；这种新的处理机制在后台服务器不存在大量检索的问题，每次只做很少次数的加密计算，每次检查的处理时长并不会随着标签数量的增加而发生关联波动，相对常规防窜货操作而言本发明的检查效率得到了明显提高；本发明提供的这种处理机制既可以作为一种独立的跨区窜货检查技术方案，还可以作为常规防窜货操作的补充方案并在常规方案出错时能对其进行有效修正。附图说明图1为本发明实施例一提供的一种基于NFC防伪标签进行跨区窜货检查的处理方法示意图；图2为本发明实施例二提供的一种电子设备的结构示意图。具体实施方式为了使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步地详细描述，显然，所描述的实施例仅仅是本发明一部份实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。本发明实施例一提供的一种基于NFC防伪标签进行跨区窜货检查的处理方法通过NFC防伪标签、NFC抽检终端和第一服务器间的指令互动实现商品跨区窜货检查；需要预先说明的是，本发明实施例一的NFC防伪标签为加载在商品上的防伪标签，各个NFC防伪标签随着商品进入各地区物流、销售渠道之前都加载了一个唯一的标签UID信息和一个唯一的标签验证密钥，该标签验证密钥是由对应商品指定销售地区的地区根密钥分散而来，密钥分散算法为以地区根密钥按预设加解密算法对自身标签UID信息进行加密并将加密结果作为分散密钥即标签验证密钥；图1为本发明实施例一提供的一种基于NFC防伪标签进行跨区窜货检查的处理方法示意图，如图1所示，本方法主要包括如下步骤：步骤1，NFC抽检终端进行当前地区代码设置处理生成对应的第一地区代码；并调用本地的随机数产生模块进行随机数生成处理得到对应的第一随机数；并将当前抽检商品的NFC防伪标签作为对应的第一标签。这里，本发明实施例的NFC抽检终端是抽检人员进行商品抽检时使用的终端，该终端可为移动终端、PC电脑、移动电脑、平板电脑、手机等终端设备；NFC抽检终端自带或外接NFC通信组件用于与商品上的NFC防伪标签进行指令交互，自带或外接有线或无线网络通信组件用于与远程的第一服务器进行指令交互，自带或外接随机数产生模块用于产生高随机性的随机数，自带或外接定位模块用于获取当前的实时定位信息。步骤1中，NFC抽检终端进行当前地区代码设置处理生成对应的第一地区代码，具体包括：步骤A1，NFC抽检终端在用户设定抽检商品地区时，生成抽检商品地区确认界面；抽检商品地区确认界面包括人工输入选项和自动定位选项；步骤A2，在用户点击人工输入选项时生成对应的商品地区代码输入界面；并通过商品地区代码输入界面获取用户输入数据作为对应的第一地区代码；步骤A3，在用户点击自动定位选项时调用本地的定位模块获取对应的定位信息；并将携带了定位信息的地区代码查询指令向第一服务器发送，并将第一服务器回发的查询指令返回数据作为对应的第一地区代码。此处，对应步骤A3中NFC抽检终端将携带了定位信息的地区代码查询指令向第一服务器发送之后，在第一服务器侧的处理步骤具体包括：步骤B1，第一服务器在接收到NFC抽检终端发送的地区代码查询指令时，从地区代码查询指令中提取出定位信息；步骤B2，调用预设的定位地图解析接口对定位信息进行地图位置解析生成对应的第一位置数据；其中，第一位置数据包括第一国家信息、第一省/州/自治区信息和第一地/市/县信息；步骤B3，查询预设的反映地理位置与销售地区对应关系的第一对应关系表，将第一对应关系表中一级位置字段与第一国家信息匹配、二级位置字段与第一省/州/自治区信息匹配且三级位置字段与第一地/市/县信息匹配的第一对应关系记录的第一销售地区代码字段提取出来作为对应的当次查询结果；其中，第一对应关系表包括多个第一对应关系记录；第一对应关系记录包括一级位置字段、二级位置字段、三级位置字段和第一销售地区代码字段；步骤B4，将当次查询结果作为对应的查询指令返回数据向NFC抽检终端回发。这里，NFC抽检终端向抽检人员提供抽检商品地区确认界面进行当前地区代码设置，该界面有两种设置选项：人工输入选项和自动定位选项；抽检人员若点击人工输入选项，NFC抽检终端就会向其提供一个商品地区代码输入界面用以获取抽检人员手动输入的第一地区代码；抽检人员若点击自动定位选项，NFC抽检终端就会通过自带或外接的定位模块对抽检人员当前所在定位进行实时获取生成对应的定位信息并通过与第一服务器的地区代码查询指令交互获得该定位信息所属的商品地区代码作为第一地区代码。步骤2，NFC抽检终端向第一标签发送UID读取指令；并接收第一标签回发的第一UID数据。此处，对应步骤2中NFC抽检终端向第一标签发送UID读取指令之后，在第一标签侧的处理步骤具体包括：第一标签在接收到NFC抽检终端发送的UID读取指令时，从本地的存储模块读取预置的标签UID信息作为对应的第一UID数据向NFC抽检终端回发。这里，NFC抽检终端通过与第一标签的UID读取指令交互获得该标签的标签UID信息即第一UID数据。步骤3，NFC抽检终端将携带了第一随机数的标签验证密钥加密指令向第一标签发送；并接收第一标签回发的第一加密数据。此处，对应步骤3中NFC抽检终端将携带了第一随机数的标签验证密钥加密指令向第一标签发送之后，在第一标签侧的处理步骤具体包括：第一标签在接收到NFC抽检终端发送的标签验证密钥加密指令时，从标签验证密钥加密指令中提取出第一随机数作为对应的第一待加密明文；并将本地预置的第一标签验证密钥作为对应的第一加密密钥；并基于预设的第一加解密算法使用第一加密密钥对第一待加密明文进行加密处理生成对应的第一加密密文；并将得到的第一加密密文作为对应的第一加密数据向NFC抽检终端回发；其中，第一加解密算法默认为国密SM7算法。这里，NFC抽检终端通过与第一标签的标签验证密钥加密指令交互获得该标签使用自带的第一标签验证密钥对第一随机数进行加密的结果即第一加密数据；本发明实施例的第一标签使用标签验证密钥进行加密时使用的加密算法为预设的第一加解密算法。步骤4，NFC抽检终端将携带了第一地区代码、第一UID数据、第一随机数和第一加密数据的地区校验指令向远程的第一服务器发送；并接收第一服务器回发的第二地区代码。这里，NFC抽检终端通过与第一服务器的地区校验指令交互获得该标签应属销售地区的商品地区代码即第二地区代码。此处，对应步骤4中NFC抽检终端将携带了第一地区代码、第一UID数据、第一随机数和第一加密数据的地区校验指令向远程的第一服务器发送之后，在第一服务器侧的处理步骤具体包括：步骤C1，第一服务器在接收到NFC抽检终端发送的地区校验指令时，从地区校验指令中提取出第一地区代码、第一UID数据、第一随机数和第一加密数据；步骤C2，查询预设的第一地区根密钥列表，将第一地区根密钥列表中第二销售地区代码字段与第一地区代码匹配的第一地区根密钥记录记为对应的第一记录；并将第一记录的第一地区根密钥字段提取出来作为对应的第一地区根密钥；其中，第一地区根密钥列表包括多个第一地区根密钥记录；第一地区根密钥记录包括第二销售地区代码字段和第一地区根密钥字段；这里，本发明实施例为各个销售地区分配了唯一的地区根密钥保存在第一地区根密钥列表中；各地区商品的NFC标签的标签验证密钥都是由对应的地区根密钥分散得到的，密钥分散算法为以地区根密钥为加密密钥按预设加解密算法即下文的第二加解密算法对标签UID信息进行加密并将加密结果作为每个NFC标签对应的标签验证密钥；第一地区根密钥是当前抽检商品所在地区对应的地区根密钥；步骤C3，以第一UID数据为第二待加密明文，并基于预设的第二加解密算法使用第一地区根密钥对第二待加密明文进行加密处理生成对应的第二加密密文；并将得到的第二加密密文作为对应的第二标签验证密钥；其中，第二加解密算法默认为国密SM1算法；这里，第一服务器是按与标签验证密钥相同的密钥分散算法推算第一标签的标签验证密钥；推算过程为以当前抽检商品所在地区对应的地区根密钥即第一地区根密钥基于预设的第二加解密算法对当前抽检商品的NFC防伪便签即第一标签的标签UID信息即第一UID数据进行加密，并将得到的密文作为推算结果即第二标签验证密钥；倘若当前抽检商品不是窜货或假冒商品，那么推算出的第二标签验证密钥应与第一标签的第一标签验证密钥相同；第一服务器在进行数据加密时，可基于自带的数据加密模块实现，也可基于外接的加密机实现；步骤C4，以第一随机数为第三待加密明文，并基于预设的第一加解密算法使用第二标签验证密钥对第三待加密明文进行加密处理生成对应的第三加密密文；其中，第一加解密算法默认为国密SM7算法；这里，第一服务器是按与第一标签使用第一标签验证密钥对第一随机数进行加密产生第一加密数据的相同加密过程，使用第二标签验证密钥基于第一加解密算法对第一随机数进行加密得到第三加密密文；倘若当前抽检商品不是窜货或假冒商品，那么得到的第三加密密文应与第一标签发给NFC抽检终端的第一加密数据相同；步骤C5，对第三加密密文与第一加密数据进行匹配比对；当第三加密密文与第一加密数据匹配时，转至步骤C6；当第三加密密文与第一加密数据不匹配时，转至步骤C7；这里，倘若当前抽检商品不是窜货或假冒商品，则第三加密密文与第一加密数据应是匹配的，后续应转至步骤C6进行处理；若第三加密密文与第一加密数据不匹配，则当前抽检商品应为窜货或假冒商品，后续应转至步骤C7进行处理；步骤C6，设置第二地区代码为第一地区代码，并将完成设置的第二地区代码向NFC抽检终端回发；转至步骤C8；这里，第一服务器向NFC抽检终端回发的第二地区代码是地区校验指令的指令返回数据，第二地区代码为当前抽检商品的应属销售地区的地区代码；在第三加密密文与第一加密数据匹配时，当前抽检商品不是窜货或假冒商品，第二地区代码与第一地区代码相同；步骤C7，初始化第二记录为空；并对第一地区根密钥列表中除第一记录之外的其他第一地区根密钥记录进行遍历；并在遍历时，将当前遍历的第一地区根密钥记录记为当前记录、将当前记录的第一地区根密钥字段提取出来作为对应的第二地区根密钥，并基于第二加解密算法使用第二地区根密钥对第一UID数据进行加密处理生成对应的第四加密密文，并将第四加密密文作为对应的第三标签验证密钥，并基于第一加解密算法使用第三标签验证密钥对第一随机数进行加密处理生成对应的第五加密密文，并对第五加密密文与第一加密数据进行匹配比对，若第五加密密文与第一加密数据匹配则将第二记录设为当前记录并结束后续遍历，若第五加密密文与第一加密数据不匹配则转至下一个第一地区根密钥记录继续遍历直到最后一个第一地区根密钥记录遍历结束为止；并在遍历结束时，对第二记录是否为空进行识别；若第二记录不为空，则将第二记录的第二销售地区代码字段提取出来作为对应的第二地区代码向NFC抽检终端回发；若第二记录为空，则根据预设的无匹配地区代码对第二地区代码进行设置，并将设置后的第二地区代码向NFC抽检终端回发；这里，在第三加密密文与第一加密数据不匹配时，当前抽检商品应为窜货或假冒商品，此时需要对当前抽检商品进行窜货商品和假冒商品区分；此处，本发明实施例通过遍历地区根密钥来实现窜货、假冒商品区分；在遍历地区根密钥时，本发明实施例对第一地区根密钥列表中除第一记录之外的其他地区根密钥进行逐个遍历，遍历时采用与步骤C2、C3类似的密钥分散和数据加密方式得到第五加密密文，再基于第五加密密文与第一加密数据进行比对；若遍历过程中某个第五加密密文能与第一加密数据匹配，那就说明当前抽检商品是窜货商品，第二地区代码应为该第五加密密文对应的地区根密钥所在的第一地区根密钥记录的第二销售地区代码字段；若遍历过程中的所有第五加密密文都不能与第一加密数据匹配，那就说明当前抽检商品是假冒商品，此时本发明实施例会基于一个预设的用于标识假冒商品的地区代码即无匹配地区代码来对第二地区代码进行设置；在得到第二地区代码之后，第一服务器向NFC抽检终端回发；步骤C8，向NFC抽检终端回发第二地区代码之后，若第二地区代码与第一地区代码不匹配且第二地区代码不为无匹配地区代码，则在预设的第一窜货记录列表中新增一个第一窜货记录，并将新增的第一窜货记录的第一标签UID字段设为第一UID数据、将第一应发地区字段设为第二地区代码、将第一窜货地区字段设为第一地区代码；若第二地区代码与第一地区代码不匹配且第二地区代码为无匹配地区代码，则在预设的第一假冒商品记录列表中新增一个第一假冒商品记录，并将新增的第一假冒商品记录的第二标签UID字段设为第一UID数据、将第一假冒地区字段设为第一地区代码；其中，第一窜货记录列表包括多个第一窜货记录，第一窜货记录包括第一标签UID字段、第一应发地区字段和第一窜货地区字段；第一假冒商品记录列表包括多个第一假冒商品记录，第一假冒商品记录包括第二标签UID字段和第一假冒地区字段。这里，本发明实施例的第一服务器向NFC抽检终端回发第二地区代码之后，还会在预设的第一窜货记录列表或第一假冒商品记录列表中对当次检查出的窜货商品或假冒商品的相关信息进行记录。步骤5，NFC抽检终端在第一、第二地区代码匹配时，显示预设的当前商品为正品且不为窜货商品的提示信息；在第一、第二地区代码不匹配且第二地区代码不为预设的无匹配地区代码时，显示预设的当前商品为正品但为窜货商品的提示信息；在第二地区代码为无匹配地区代码时，显示预设的当前商品为假冒商品的提示信息。这里，若第一、第二地区代码匹配，说明当前抽检商品是正品且不是窜货商品；若第一、第二地区代码不匹配但第二地区代码不为无匹配地区代码，说明当前抽检商品是正品但也是窜货商品；若第二地区代码为无匹配地区代码，说明当前抽检商品是假冒商品。另外还需要说明的是，本发明实施例的第一服务器还会定期根据第一窜货记录列表进行区域窜货情况分析，具体为：对第一窜货记录列表中第一窜货地区字段相同的第一窜货记录进行聚类得到多个第一聚类记录集合，并对得到的多个第一聚类记录集合按集合记录数量从大到小的顺序排序生成对应的第一聚类记录集合序列；并对各个第一聚类记录集合的第一窜货地区字段进行提取生成对应的第一窜货地区代码；并对得到的各个第一窜货地区代码按对应的第一聚类记录集合在第一聚类记录集合序列中排序顺序进行排序得到对应的第一窜货地区代码序列；并将第一窜货地区代码序列作为区域窜货情况分析结果输出。另外还需要说明的是，本发明实施例的第一服务器还会定期根据第一假冒商品记录列表进行区域假冒商品情况分析，具体为：对第一假冒商品记录列表中第一假冒地区字段相同的第一假冒商品记录进行聚类得到多个第三聚类记录集合，并对得到的多个第三聚类记录集合按集合记录数量从大到小的顺序排序生成对应的第三聚类记录集合序列；并对各个第三聚类记录集合的第一假冒地区字段进行提取生成对应的第一假冒地区代码；并对得到的各个第一假冒地区代码按对应的第三聚类记录集合在第三聚类记录集合序列中排序顺序进行排序得到对应的第一假冒地区代码序列；并将第一假冒地区代码序列作为区域假冒商品情况分析结果输出。图2为本发明实施例二提供的一种电子设备的结构示意图。该电子设备可以为实现本发明实施例方法的终端设备或者服务器，也可以为与前述终端设备或者服务器连接的实现本发明实施例方法的终端设备或服务器。如图2所示，该电子设备可以包括：处理器301、存储器302、收发器303；收发器303耦合至处理器301，处理器301控制收发器303的收发动作。存储器302中可以存储各种指令，以用于完成各种处理功能以及实现前述方法实施例描述的处理步骤。优选的，本发明实施例涉及的电子设备还包括：电源304、系统总线305以及通信端口306。系统总线305用于实现元件之间的通信连接。上述通信端口306用于电子设备与其他外设之间进行连接通信。在图2中提到的系统总线305可以是外设部件互连标准总线或扩展工业标准结构总线等。该系统总线可以分为地址总线、数据总线、控制总线等。为便于表示，图中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。通信接口用于实现数据库访问装置与其他设备之间的通信。存储器可能包含随机存取存储器，也可能还包括非易失性存储器，例如至少一个磁盘存储器。上述的处理器可以是通用处理器，包括中央处理器、网络处理器、图形处理器等；还可以是数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。需要说明的是，本发明实施例还提供一种计算机可读存储介质，该计算机可读存储介质中存储有指令，当其在计算机上运行时，使得计算机执行上述实施例中提供的方法和处理过程。本发明实施例还提供一种运行指令的芯片，该芯片用于执行前述方法实施例描述的处理步骤。本发明实施例提供了一种基于NFC防伪标签进行跨区窜货检查的处理方法、电子设备及计算机可读存储介质，预先为各个销售片区分配一个唯一的地区根密钥，并在商品进入各地区物流、销售渠道之前基于地区根密钥和标签UID信息为各个NFC防伪标签生成一个唯一的标签验证密钥加载到标签上；在进行跨区窜货检查时，由前端的NFC抽检终端获取抽检商品的地区代码，再通过NFC防伪标签的标签验证密钥对一个随机数做一次加密得到加密数据，再由NFC抽检终端将地区代码、NFC防伪标签的标签UID信息、随机数和加密数据一并发往后台服务器进行检查，后台服务器根据地区代码对应的地区根密钥+标签UID信息分散出对等的标签验证密钥，再基于该标签验证密钥对随机数进行加密，再基于当次加密密文与NFC抽检终端上传的加密数据的比对结果来判断是否发生窜货、是否为假冒商品，并将判断结果回发给NFC抽检终端进行显示。通过本发明，给出了一种新的跨区窜货检查处理机制，这种新的处理机制中后台服务器只需保存为数很少的地区根密钥、并不需要对任何NFC防伪标签的标签验证密钥进行保存，更不需要在后台服务器上通过人工操作方式对各个标签验证密钥与地区根密钥进行绑定，自然也就解决了常规防窜货操作中由绑定关系错误导致的窜货、假冒商品失察漏洞；这种新的处理机制在后台服务器不存在大量检索的问题，每次只做很少次数的加密计算，每次检查的处理时长并不会随着标签数量的增加而发生关联波动，相对常规防窜货操作而言本发明的检查效率得到了明显提高；本发明提供的这种处理机制既可以作为一种独立的跨区窜货检查技术方案，还可以作为常规防窜货操作的补充方案并在常规方案出错时能对其进行有效修正。专业人员应该还可以进一步意识到，结合本文中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、计算机软件或者二者的结合来实现，为了清楚地说明硬件和软件的可互换性，在上述说明中已经按照功能一般性地描述了各示例的组成及步骤。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本发明的范围。结合本文中所公开的实施例描述的方法或算法的步骤可以用硬件、处理器执行的软件模块，或者二者的结合来实施。软件模块可以置于随机存储器、内存、只读存储器、电可编程ROM、电可擦除可编程ROM、寄存器、硬盘、可移动磁盘、CD-ROM、或技术领域内所公知的任意其它形式的存储介质中。以上所述的具体实施方式，对本发明的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上所述仅为本发明的具体实施方式而已，并不用于限定本发明的保护范围，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
