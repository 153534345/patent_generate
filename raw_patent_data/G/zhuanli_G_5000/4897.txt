标题title
分子处理方法、装置、电子设备、存储介质及程序产品
摘要abst
本申请提供了一种基于人工智能的分子处理方法、装置、电子设备、计算机可读存储介质及计算机程序产品；方法包括：获取目标分子的三维结构；调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差；其中，神经网络模型是通过拟合样本分子的能量误差进行训练得到的，样本分子的能量误差指分别按照两种能量计算机制来计算样本分子的能量时得到的计算结果差值；对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量；基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量。通过本申请，能够同时提高分子能量计算的精度以及速度。
权利要求书clms
1.一种基于人工智能的分子处理方法，其特征在于，所述方法包括：获取目标分子的三维结构；调用神经网络模型对所述目标分子的三维结构进行能量误差预测处理，得到所述目标分子的能量误差；其中，所述神经网络模型是通过拟合样本分子的能量误差进行训练得到的，所述样本分子的能量误差指分别按照两种能量计算机制来计算所述样本分子的能量时得到的计算结果差值，所述两种能量计算机制包括第一能量计算处理以及第二能量计算处理，所述第一能量计算处理的精度小于所述第二能量计算处理的精度，且所述第一能量计算处理的速度大于所述第二能量计算处理的速度；对所述目标分子的三维结构进行所述第一能量计算处理，得到所述目标分子的第一能量；基于所述目标分子的能量误差对所述目标分子的第一能量进行误差修正处理，得到所述目标分子的第二能量。2.根据权利要求1所述的方法，其特征在于，所述调用神经网络模型对所述目标分子的三维结构进行能量误差预测处理，得到所述目标分子的能量误差，包括：通过所述神经网络模型对所述三维结构进行特征提取处理，得到所述目标分子的能量误差特征；通过所述神经网络模型对所述能量误差特征进行全连接处理，得到所述目标分子的能量误差。3.根据权利要求2所述的方法，其特征在于，所述神经网络模型包括N个级联的特征网络，所述通过所述神经网络模型对所述三维结构进行特征提取处理，得到所述目标分子的能量误差特征，包括：对所述三维结构中每个原子进行初始特征提取处理，得到每个原子的初始特征；当n取值为1≤n≤N-2时，通过N个级联的特征网络中的第n特征网络，对所述第n特征网络的输入进行第n特征提取处理，得到每个所述原子的第n特征，并将所述第n特征传输到第n+1特征网络以继续进行第n+1特征提取处理；当n取值为N-1时，通过所述第n+1特征网络对每个所述原子的第n特征进行属性特征提取处理，得到每个所述原子的第n+1属性特征，并通过所述第n+1特征网络对每个所述原子的第n特征进行坐标特征提取处理，得到每个所述原子的第n+1坐标特征，将每个所述原子的第n+1属性特征以及第n+1坐标特征组成所述能量误差特征；其中，N的取值范围满足2≤N，n为取值从1开始递增的整数，且n的取值范围满足1≤n≤N-1；当n取值为1时，所述第n特征网络的输入为每个原子的初始特征，当n取值为2≤n≤N-1时，所述第n特征网络的输入为第n-1特征网络输出的每个原子的第n-1特征。4.根据权利要求3所述的方法，其特征在于，所述对所述三维结构中每个原子进行初始特征提取处理，得到每个原子的初始特征，包括：获取所述三维结构中每个原子的初始属性特征，并获取所述三维结构中每个原子的初始坐标特征；其中，所述初始属性特征表征所述原子的属性信息，所述初始坐标特征表征所述原子的位置信息；针对所述三维结构中每个所述原子执行以下处理：获取所述三维结构中除所述原子之外的至少一个其他原子，并获取所述原子与每个所述其他原子之间的初始关系特征，其中，所述初始关系特征表征所述原子与其他原子的连接关系；将每个所述原子的初始属性特征、每个所述原子的初始坐标特征以及每个所述原子的初始关系特征，组成每个所述原子的初始特征。5.根据权利要求3所述的方法，其特征在于，所述通过N个级联的特征网络中的第n特征网络，对所述第n特征网络的输入进行第n特征提取处理，得到每个所述原子的第n特征，包括：通过所述第n特征网络对每个所述原子执行以下处理：获取所述三维结构中除所述原子之外的其他原子；对所述原子的第n-1特征以及每个所述其他原子的第n-1特征，执行第一映射处理，得到所述原子对应每个所述其他原子的第n关联特征；对所述原子的第n-1特征以及所述原子对应每个所述其他原子的第n关联特征，执行第二映射处理，得到所述原子的第n特征。6.根据权利要求5所述的方法，其特征在于，所述对所述原子的第n-1特征以及每个所述其他原子的第n-1特征，执行第一映射处理，得到所述原子对应每个所述其他原子的第n关联特征，包括：从所述原子的第n-1特征中提取出所述原子的第n-1坐标特征、所述原子的第n-1属性特征、以及所述原子的第n-1关系特征；从每个所述其他原子的第n-1特征中提取出每个所述其他原子的第n-1坐标特征、以及每个所述其他原子的第n-1属性特征；针对每个所述其他原子执行以下处理：从所述原子的第n-1关系特征中提取所述原子针对所述其他原子的第n-1关系特征；获取所述原子的第n-1坐标特征与所述其他原子的第n-1坐标特征之间的第一特征距离；对所述第一特征距离的平方、所述原子的第n-1属性特征、所述其他原子的第n-1属性特征、以及所述原子针对所述其他原子的第n-1关系特征，执行第一融合处理，得到所述原子对应所述其他原子的第n关联特征。7.根据权利要求6所述的方法，其特征在于，所述对所述原子的第n-1特征以及所述原子对应每个所述其他原子的第n关联特征，执行第二映射处理，得到所述原子的第n特征，包括：将所述原子对应多个所述其他原子的第n关联特征进行求和处理，得到所述原子的第n关联特征；对所述原子的第n-1属性特征以及所述原子的第n关联特征进行第二融合处理，得到所述原子的第n属性特征；获取所述原子的第n-1坐标特征与每个所述其他原子的第n-1坐标特征之间的第一特征差值；对所述原子对应每个所述其他原子的第n关联特征进行线性映射处理，得到每个所述其他原子的权重；基于每个所述其他原子的权重，对多个所述其他原子的第一特征差值进行加权平均处理，得到对应所述原子的加权平均结果；将所述原子的加权平均结果与所述原子的第n-1坐标特征进行求和处理，得到所述原子的第n坐标特征；将所述原子的初始关系特征作为所述原子的第n关系特征，并将所述原子的第n关系特征、所述原子的第n属性特征以及所述原子的第n坐标特征，组成所述原子的第n特征。8.根据权利要求3所述的方法，其特征在于，所述通过所述第n+1特征网络对每个所述原子的第n特征进行属性特征提取处理，得到每个所述原子的第n+1属性特征，包括：从每个所述原子的第n特征中提取出所述原子的第n坐标特征、所述原子的第n属性特征以及所述原子的第n关系特征；针对每个所述原子，获取所述三维结构中除所述原子外的其他原子，并针对每个所述其他原子执行以下处理：从所述原子的第n关系特征中提取所述原子针对所述其他原子的第n关系特征，并获取所述原子的第n坐标特征与所述其他原子的第n坐标特征之间的第二特征距离；对所述第二特征距离的平方、所述原子的第n属性特征、所述其他原子的第n属性特征、以及所述原子针对所述其他原子的第n关系特征，执行第一融合处理，得到所述原子对应所述其他原子的第n+1关联特征；将所述原子对应多个所述其他原子的第n+1关联特征进行求和处理，得到所述原子的第n+1关联特征；对所述原子的第n属性特征以及所述原子的第n+1关联特征进行第二融合处理，得到所述原子的第n+1属性特征。9.根据权利要求1所述的方法，其特征在于，在调用神经网络模型对所述目标分子的三维结构进行能量误差预测处理，得到所述目标分子的能量误差之前，所述方法还包括：获取样本分子，并对所述样本分子进行构象生成处理，得到多个样本分子构象；获取每个所述样本分子构象的标签能量误差；将每个所述样本分子构象在初始化的神经网络模型中进行正向传播，得到每个所述样本分子构象的预测能量误差；基于每个所述样本分子构象的标签能量误差以及每个所述样本分子构象的预测能量误差，确定综合损失；将所述综合损失在所述初始化的神经网络模型中进行反向传播处理，得到所述综合损失收敛时所述初始化的神经网络模型的参数变化值，并基于所述参数变化值更新所述初始化的神经网络模型的参数。10.根据权利要求9所述的方法，其特征在于，所述获取每个所述样本分子构象的标签能量误差，包括：针对每个所述样本分子构象执行以下处理：对所述样本分子构象进行第一能量计算处理，得到所述样本分子构象的第一能量；对所述样本分子构象进行第二能量计算处理，得到所述样本分子构象的第二能量；获取所述样本分子构象的第二能量与所述样本分子构象的第一能量之间的第一差值，作为所述样本分子构象的标签能量误差。11.根据权利要求9所述的方法，其特征在于，所述基于每个所述样本分子构象的标签能量误差以及每个所述样本分子构象的预测能量误差，确定综合损失，包括：针对每个所述样本分子构象执行以下处理：基于所述样本分子构象的标签能量误差以及所述样本分子构象的预测能量误差，确定所述样本分子构象的第一均方根误差；获取所述样本分子的除所述样本分子构象之外的其他样本分子构象；针对每个所述其他样本分子构象执行以下处理：确定所述样本分子构象的标签能量误差与所述其他样本分子构象的标签能量误差之间的第二差值，并确定所述样本分子构象的预测能量误差与所述其他样本分子构象的预测能量误差之间的第三差值；对所述第二差值以及所述第三差值执行均方根处理，得到所述样本分子构象对应所述其他样本分子构象的第二均方根误差；将所述样本分子构象对应多个所述其他样本分子构象的第二均方根误差进行求和处理，得到所述样本分子构象的第三均方根误差；对多个所述样本分子构象的第一均方根误差以及多个所述样本分子构象的第三均方根误差进行第三融合处理，得到对应所述神经网络模型的综合损失。12.一种基于人工智能的分子处理装置，其特征在于，所述装置包括：获取模块，用于获取目标分子的三维结构；神经网络模块，用于调用神经网络模型对所述目标分子的三维结构进行能量误差预测处理，得到所述目标分子的能量误差；其中，所述神经网络模型是通过拟合样本分子的能量误差进行训练得到的，所述样本分子的能量误差指分别按照两种能量计算机制来计算所述样本分子的能量时得到的计算结果差值，所述两种能量计算机制包括第一能量计算处理以及第二能量计算处理，所述第一能量计算处理的精度小于所述第二能量计算处理的精度，且所述第一能量计算处理的速度大于所述第二能量计算处理的速度；计算模块，用于对所述目标分子的三维结构进行所述第一能量计算处理，得到所述目标分子的第一能量；修正模块，用于基于所述目标分子的能量误差对所述目标分子的第一能量进行误差修正处理，得到所述目标分子的第二能量。13.一种电子设备，其特征在于，所述电子设备包括：存储器，用于存储可执行指令；处理器，用于执行所述存储器中存储的计算机可执行指令时，实现权利要求1至11任一项所述的基于人工智能的分子处理方法。14.一种计算机可读存储介质，存储有计算机可执行指令，其特征在于，所述计算机可执行指令被处理器执行时实现权利要求1至11任一项所述的基于人工智能的分子处理方法。15.一种计算机程序产品，包括计算机程序或计算机可执行指令，其特征在于，所述计算机程序或计算机可执行指令被处理器执行时实现权利要求1至11任一项所述的基于人工智能的分子处理方法。
说明书desc
技术领域本申请涉及人工智能技术，尤其涉及一种基于人工智能的分子处理方法、装置、电子设备、计算机可读存储介质及计算机程序产品。背景技术人工智能是计算机科学的一个综合技术，通过研究各种智能机器的设计原理与实现方法，使机器具有感知、推理与决策的功能。人工智能技术是一门综合学科，涉及领域广泛，例如自然语言处理技术以及机器学习/深度学习等几大方向，随着技术的发展，人工智能技术将在更多的领域得到应用，并发挥越来越重要的价值。在新药研发流程和材料研发流程中，如图1所示，在完成靶点识别与验证之后，需要对候选药物化合物进行筛选。在筛选过程中，对分子性质计算等场景中通常要计算分子的能量。计算结果有助于药物研发人员分析分子性质、分子与蛋白质口袋的结合能力等。相关技术中通常使用计算化学的方式获取分子能量，无法兼顾获取分子能量的精度以及速度。发明内容本申请实施例提供一种基于人工智能的分子处理方法、装置、电子设备、计算机可读存储介质及计算机程序产品，能够同时提高分子能量计算的精度以及速度。本申请实施例的技术方案是这样实现的：本申请实施例提供一种基于人工智能的分子处理方法，包括：获取目标分子的三维结构；调用神经网络模型对所述目标分子的三维结构进行能量误差预测处理，得到所述目标分子的能量误差；其中，所述神经网络模型是通过拟合样本分子的能量误差进行训练得到的，所述样本分子的能量误差指分别按照两种能量计算机制来计算所述样本分子的能量时得到的计算结果差值，所述两种能量计算机制包括第一能量计算处理以及第二能量计算处理，所述第一能量计算处理的精度小于所述第二能量计算处理的精度，且所述第一能量计算处理的速度大于所述第二能量计算处理的速度；对所述目标分子的三维结构进行所述第一能量计算处理，得到所述目标分子的第一能量；基于所述目标分子的能量误差对所述目标分子的第一能量进行误差修正处理，得到所述目标分子的第二能量。本申请实施例提供一种基于人工智能的分子处理装置，包括：获取模块，用于获取目标分子的三维结构；神经网络模块，用于调用神经网络模型对所述目标分子的三维结构进行能量误差预测处理，得到所述目标分子的能量误差；其中，所述神经网络模型是通过拟合样本分子的能量误差进行训练得到的，所述样本分子的能量误差指分别按照两种能量计算机制来计算所述样本分子的能量时得到的计算结果差值，所述两种能量计算机制包括第一能量计算处理以及第二能量计算处理，所述第一能量计算处理的精度小于所述第二能量计算处理的精度，且所述第一能量计算处理的速度大于所述第二能量计算处理的速度；计算模块，用于对所述目标分子的三维结构进行所述第一能量计算处理，得到所述目标分子的第一能量；修正模块，用于基于所述目标分子的能量误差对所述目标分子的第一能量进行误差修正处理，得到所述目标分子的第二能量。在上述方案中，所述神经网络模块，还用于：通过所述神经网络模型对所述三维结构进行特征提取处理，得到所述目标分子的能量误差特征；通过所述神经网络模型对所述能量误差特征进行全连接处理，得到所述目标分子的能量误差。在上述方案中，所述神经网络模型包括N个级联的特征网络，所述神经网络模块，还用于：对所述三维结构中每个原子进行初始特征提取处理，得到每个原子的初始特征；当n取值为1≤n≤N-2时，通过N个级联的特征网络中的第n特征网络，对所述第n特征网络的输入进行第n特征提取处理，得到每个所述原子的第n特征，并将所述第n特征传输到第n+1特征网络以继续进行第n+1特征提取处理；当n取值为N-1时，通过所述第n+1特征网络对每个所述原子的第n特征进行属性特征提取处理，得到每个所述原子的第n+1属性特征，并通过所述第n+1特征网络对每个所述原子的第n特征进行坐标特征提取处理，得到每个所述原子的第n+1坐标特征，并将每个所述原子的第n+1属性特征以及第n+1坐标特征组成所述能量误差特征；其中，n为取值从1开始递增的整数，且n的取值范围满足1≤n≤N-1；当n取值为1时，所述第n特征网络的输入为每个原子的初始特征，当n取值为2≤n≤N-1时，所述第n特征网络的输入为第n-1特征网络输出的每个原子的第n-1特征。在上述方案中，所述神经网络模块，还用于：获取所述三维结构中每个原子的初始属性特征，并获取所述三维结构中每个原子的初始坐标特征；其中，所述初始属性特征表征所述原子的属性信息，所述初始坐标特征表征所述原子的位置信息；针对所述三维结构中每个所述原子执行以下处理：获取所述三维结构中除所述原子之外的至少一个其他原子，并获取所述原子与每个所述其他原子之间的初始关系特征，其中，所述初始关系特征表征所述原子与其他原子的连接关系；将每个所述原子的初始属性特征、每个所述原子的初始坐标特征以及每个所述原子的初始关系特征，组成每个所述原子的初始特征。在上述方案中，所述神经网络模块，还用于：通过所述第n特征网络对每个所述原子执行以下处理：获取所述三维结构中除所述原子之外的其他原子；对所述原子的第n-1特征以及每个所述其他原子的第n-1特征，执行第一映射处理，得到所述原子对应每个所述其他原子的第n关联特征；对所述原子的第n-1特征以及所述原子对应每个所述其他原子的第n关联特征，执行第二映射处理，得到所述原子的第n特征。在上述方案中，所述神经网络模块，还用于：从所述原子的第n-1特征中提取出所述原子的第n-1坐标特征，并从每个所述其他原子的第n-1特征中提取出每个所述其他原子的第n-1坐标特征；从所述原子的第n-1特征中提取出所述原子的第n-1属性特征，并从每个所述其他原子的第n-1特征中提取出每个所述其他原子的第n-1属性特征；从所述原子的第n-1特征中提取出所述原子的第n-1关系特征；针对每个所述其他原子执行以下处理：从所述原子的第n-1关系特征中提取所述原子针对所述其他原子的第n-1关系特征；获取所述原子的第n-1坐标特征与所述其他原子的第n-1坐标特征之间的第一特征距离；对所述第一特征距离的平方、所述原子的第n-1属性特征、所述其他原子的第n-1属性特征、以及所述原子针对所述其他原子的第n-1关系特征，执行第一融合处理，得到所述原子对应所述其他原子的第n关联特征。在上述方案中，所述神经网络模块，还用于：当所述其他原子的数目为多个时，将所述原子对应多个所述其他原子的第n关联特征进行求和处理，得到所述原子的第n关联特征；对所述第n-1属性特征以及所述原子的第n关联特征进行第二融合处理，得到所述原子的第n属性特征；获取所述原子的第n-1坐标特征与每个所述其他原子的第n-1坐标特征之间的第一特征差值；对所述原子对应每个所述其他原子的第n关联特征进行线性映射处理，得到每个所述其他原子的权重；基于每个所述其他原子的权重，对多个所述其他原子的第一特征差值进行加权平均处理，得到对应所述原子的加权平均结果；将所述原子的加权平均结果与所述原子的第n-1坐标特征进行求和处理，得到所述原子的第n坐标特征；将所述原子的初始关系特征作为所述原子的第n关系特征；将所述原子的第n关系特征、所述原子的第n属性特征以及所述原子的第n坐标特征，组成所述原子的第n特征。在上述方案中，所述神经网络模块，还用于：从所述原子的第n特征中提取出所述原子的第n坐标特征，并从每个所述其他原子的第n特征中提取出每个所述其他原子的第n坐标特征；从所述原子的第n特征中提取出所述原子的第n属性特征，并从每个所述其他原子的第n特征中提取出每个所述其他原子的第n属性特征；从所述原子的第n特征中提取出所述原子的第n关系特征；针对每个所述其他原子执行以下处理：从所述原子的第n关系特征中提取所述原子针对所述其他原子的第n关系特征；获取所述原子的第n坐标特征与所述其他原子的第n坐标特征之间的第二特征距离；对所述第二特征距离的平方、所述原子的第n属性特征、所述其他原子的第n属性特征、以及所述原子针对所述其他原子的第n关系特征，执行第一融合处理，得到所述原子对应所述其他原子的第n+1关联特征；当所述其他原子的数目为多个时，执行以下处理：将所述原子对应多个所述其他原子的第n+1关联特征进行求和处理，得到所述原子的第n+1关联特征；对所述第n属性特征以及所述原子的第n+1关联特征进行第二融合处理，得到所述原子的第n+1属性特征。在上述方案中，在调用神经网络模型对所述目标分子的三维结构进行能量误差预测处理，得到所述目标分子的能量误差之前，所述装置还包括：训练模块，用于：获取样本分子，并对所述样本分子进行构象生成处理，得到多个样本分子构象；获取每个所述样本分子构象的标签能量误差；将每个所述样本分子构象在所述神经网络模型中进行正向传播，得到每个所述样本分子构象的预测能量误差；基于每个所述样本分子构象的标签能量误差以及每个所述样本分子构象的预测能量误差，确定对应所述神经网络模型的综合损失；将所述综合损失在所述神经网络模型中进行反向传播处理，得到所述综合损失收敛时所述神经网络模型的参数变化值，并基于所述参数变化值更新所述神经网络模型的参数。在上述方案中，所述训练模块，还用于：针对每个所述样本分子构象执行以下处理：对所述样本分子构象进行第一能量计算处理，得到所述样本分子构象的第一能量；对所述样本分子构象进行第二能量计算处理，得到所述样本分子构象的第二能量；获取所述样本分子的第二能量与所述样本分子的第一能量的第一差值，作为所述样本分子构象的标签能量误差。在上述方案中，所述第一能量计算处理是基于半经验量子力学的能量计算处理，所述第二能量计算处理是基于密度泛函的能量计算处理。在上述方案中，所述训练模块，还用于：针对每个所述样本分子构象执行以下处理：基于所述样本分子构象的标签能量误差以及所述样本分子构象的预测能量误差，确定所述样本分子构象的第一均方根误差；获取所述样本分子的除所述样本分子构象之外的其他样本分子构象；针对每个所述其他样本分子构象执行以下处理：确定所述样本分子构象的标签能量误差与所述其他样本分子构象的标签能量误差之间的第二差值，并确定所述样本分子构象的预测能量误差与所述其他样本分子构象的预测能量误差之间的第三差值；对所述第二差值以及所述第三差值执行均方根处理，得到所述样本分子构象对应所述其他样本分子构象的第二均方根误差；将所述样本分子构象对应多个所述其他样本分子构象的第二均方根误差进行求和处理，得到所述样本分子构象的第三均方根误差；对多个所述样本分子构象的第一均方根误差以及多个所述样本分子的第三均方根误差进行第三融合处理，得到对应所述神经网络模型的综合损失。本申请实施例提供一种电子设备，包括：存储器，用于存储可执行指令；处理器，用于执行所述存储器中存储的可执行指令时，实现本申请实施例提供的方法。本申请实施例提供一种计算机可读存储介质，存储有可执行指令，用于被处理器执行时，实现本申请实施例提供的基于人工智能的分子处理方法。本申请实施例具有以下有益效果：通过对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，由于第一能量计算处理的速度高于第二能量计算处理，从而提高能量计算处理的速度，通过神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，并基于能量误差对计算得到的第一能量进行误差修正处理，得到目标分子的第二能量，由于能量误差可以表征高精度的第二能量计算处理与低精度的第一能量计算处理之间的计算结果差异，从而可以利用深度学习预测得到的能量误差对计算得到的第一能量进行修正，从而提高第二能量的精度。附图说明图1是本申请实施例提供的药物研发流程示意图；图2是本申请实施例提供的基于人工智能的分子处理系统的架构示意图；图3是本申请实施例提供的电子设备的结构示意图；图4A-图4C是本申请实施例提供的基于人工智能的分子处理方法的流程示意图；图5是本申请实施例提供的深度量子化学模型的结构示意图；图6是本申请实施例提供的针对第一数据集的效果对比图；图7是本申请实施例提供的针对第二数据集的效果对比图。具体实施方式为了使本申请的目的、技术方案和优点更加清楚，下面将结合附图对本申请作进一步地详细描述，所描述的实施例不应视为对本申请的限制，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本申请保护的范围。在以下的描述中，涉及到“一些实施例”，其描述了所有可能实施例的子集，但是可以理解,“一些实施例”可以是所有可能实施例的相同子集或不同子集，并且可以在不冲突的情况下相互结合。在以下的描述中，所涉及的术语“第一第二第三”仅仅是是区别类似的对象，不代表针对对象的特定排序，可以理解地，“第一第二第三”在允许的情况下可以互换特定的顺序或先后次序，以使这里描述的本申请实施例能够以除了在这里图示或描述的以外的顺序实施。除非另有定义，本文所使用的所有的技术和科学术语与属于本申请的技术领域的技术人员通常理解的含义相同。本文中所使用的术语只是为了描述本申请实施例的目的，不是旨在限制本申请。对本申请实施例进行进一步详细说明之前，对本申请实施例中涉及的名词和术语进行说明，本申请实施例中涉及的名词和术语适用于如下的解释。1)计算化学：是理论化学的一个分支，主要目的是利用有效的数学近似以及电脑程序计算分子的性质，例如总能量、偶极矩、四极矩、振动频率、反应活性等，并用以解释一些具体的化学问题。2)分子能量：分子能量包括分子的动能和势能。分子动能指分子由于运动而具有的能，分子势能指分子具有的由分子力所产生的，并由相对位置所决定的势能。3)半经验的量子力学方法：量子力学方法在理论上准确度高，但是面对生物大分子体系，计算代价很大，无法满足实际应用需求，引入经验参数的半经验量子力学方法是一种以近似方法，在时间和准确性之间折中，可用于评分以及估算配体与蛋白质的亲和力，在计算机辅助药物设计中具有重要意义。4)增量学习：增量学习是指一个学习系统能不断地从新样本中学习新的知识，并能保存大部分以前已经学习到的知识。增量学习非常类似于人类自身的学习模式。5)从头计算法在量子化学计算中指基于量子力学基本原理直接求解薛定谔方程的量子化学计算方法。从头计算法的特点是没有经验参数，并且对体系不作过多的简化。对各种不同的化学体系采用基本相同的方法进行计算。6)密度泛函理论：是一种研究多电子体系电子结构的方法。密度泛函理论在物理和化学上都有广泛的应用，特别是用来研究分子和凝聚态的性质，是凝聚态物理计算材料学和计算化学领域最常用的方法之一。相关技术的分子能量计算方式主要包括基于计算化学和基于深度学习两种方式。计算化学方式包括量子力学的方式和分子力学的方式。量子力学的方式包括从头计算法和半经验的量子力学方式，从头计算法是一种基于量子化学第一性原理，并使用严密的近似求解薛定谔方程的方式。在从头计算方式中，有基于波函数的方式和基于密度泛函的方式，基于波函数的代表性方式是基于哈特里-福克方程的方式，基于密度泛函的代表性方式是基于密度泛函理论的方式。在分子力学方式中，通常用分子力场来描述各种形式相互作用力对分子势能影响，它不计算电子相互作用，它是对分子结构的一种简化模型。在深度学习方式中，主要是运用深度学习模型来预测分子能量，将小数据集作为训练样本集合，基于训练样本集合对深度学习模型进行训练，从而深度学习模型可以学习到原子结构特征，并基于抽取得到的特征预测分子能量。量子力学的从头计算方式具有较高的计算精确度，但是需要耗费较大的计算量，从而提高计算耗时，使得难以利用从头计算方式进行大规模计算；量子力学的半经验方式使用半经验参数代替了分子积分，可以加快计算速度，但它牺牲了计算精度。基于分子力学力场的方式可以实现较高地计算速度，同时也是精度最低的方式。深度学习方式对原子特征利用不够充分，且它支持的原子类型少，对分子长程相互作用捕获能力差，并且没有对分子不同构象的能量预测进行探索。单纯的深度学习方式在分子能量预测的精度上有待提高。为了解决上述问题，本申请实施例提供一种基于人工智能的分子处理方法、装置、电子设备、计算机可读存储介质及计算机程序产品，能够同时提高分子能量计算的精度以及速度。本申请实施例所提供的基于人工智能的分子处理方法，可以由终端/服务器独自实现；也可以由终端和服务器协同实现，例如终端独自承担下文所述的基于人工智能的分子处理方法，或者，终端向服务器发送针对目标分子的能量评估请求，服务器根据接收的该针对目标分子的能量评估请求执行基于人工智能的分子处理方法，获取目标分子的三维结构，并调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量，从而研发人员可以基于目标分子的第二能量可以进行后续的分析研究，例如通过目标分子的第二能量确定出目标分子与蛋白质口袋结合能力，并基于目标分子与蛋白质口袋结合能力对候选药物化合物进行筛选。本申请实施例提供的用于分子处理的电子设备可以是各种类型的终端设备或服务器，其中，服务器可以是独立的物理服务器，也可以是多个物理服务器构成的服务器集群或者分布式系统，还可以是提供云计算服务的云服务器；终端可以是智能手机、平板电脑、笔记本电脑、台式计算机、智能音箱、智能手表等，但并不局限于此。终端以及服务器可以通过有线或无线通信方式进行直接或间接地连接，本申请在此不做限制。以服务器为例，例如可以是部署在云端的服务器集群，向用户开放人工智能云服务，AIaaS平台会把几类常见的AI服务进行拆分，并在云端提供独立或者打包的服务，这种服务模式类似于一个AI主题商城，所有的用户都可以通过应用程序编程接口的方式来接入使用AIaaS平台提供的一种或者多种人工智能服务。例如，其中的一种人工智能云服务可以为分子处理服务，即云端的服务器封装有本申请实施例提供的分子处理的程序。用户通过终端调用云服务中的分子处理服务，以使部署在云端的服务器调用封装的分子处理的程序，获取目标分子的三维结构，并调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量，从而研发人员可以基于目标分子的第二能量可以进行后续的分析研究，例如通过目标分子的第二能量确定出目标分子与蛋白质口袋结合能力，并基于目标分子与蛋白质口袋结合能力对候选药物化合物进行筛选。参见图2，图2是本申请实施例提供的基于人工智能的分子处理系统的架构示意图，终端400通过网络300连接服务器200，网络300可以是广域网或者局域网，又或者是二者的组合。终端400可以被用来获取针对目标分子的能量评估请求，例如，研发人员通过终端400的输入界面输入目标分子，则自动生成针对目标分子的能量评估请求，终端400将目标分子的能量预测请求发送至服务器200，服务器200获取目标分子的三维结构，并调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量，服务器200将目标分子的第二能量返回至终端400，从而研发人员可以基于目标分子的第二能量可以进行后续的分析研究，例如通过目标分子的第二能量确定出目标分子与蛋白质口袋结合能力，并基于目标分子与蛋白质口袋结合能力对候选药物化合物进行筛选。在一些实施例中，终端中运行的客户端中可以植入有分子处理插件，用以在客户端本地实现基于人工智能的分子处理方法。例如，终端400获取针对目标分子的能量评估请求后，调用分子处理插件，以实现基于人工智能的分子处理方法，获取目标分子的三维结构，并调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量，从而研发人员可以基于目标分子的第二能量可以进行后续的分析研究，例如通过目标分子的第二能量确定出目标分子与蛋白质口袋结合能力，并基于目标分子与蛋白质口袋结合能力对候选药物化合物进行筛选。在一些实施例中，终端400获取针对目标分子的能量评估请求后，调用服务器200的分子处理接口，服务器200获取目标分子的三维结构，并调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量，从而研发人员可以基于目标分子的第二能量可以进行后续的分析研究，例如通过目标分子的第二能量确定出目标分子与蛋白质口袋结合能力，并基于目标分子与蛋白质口袋结合能力对候选药物化合物进行筛选。参见图3，图3是本申请实施例提供的电子设备的结构示意图，图3所示的终端400包括：至少一个处理器410、存储器450、至少一个网络接口420和用户接口430。终端400中的各个组件通过总线系统440耦合在一起。可理解，总线系统440用于实现这些组件之间的连接通信。总线系统440除包括数据总线之外，还包括电源总线、控制总线和状态信号总线。但是为了清楚说明起见，在图3中将各种总线都标为总线系统440。处理器410可以是一种集成电路芯片，具有信号的处理能力，例如通用处理器、数字信号处理器，或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等，其中，通用处理器可以是微处理器或者任何常规的处理器等。用户接口430包括使得能够呈现媒体内容的一个或多个输出装置431，包括一个或多个扬声器和/或一个或多个视觉显示屏。用户接口430还包括一个或多个输入装置432，包括有助于用户输入的用户接口部件，比如键盘、鼠标、麦克风、触屏显示屏、摄像头、其他输入按钮和控件。存储器450可以是可移除的，不可移除的或其组合。示例性的硬件设备包括固态存储器，硬盘驱动器，光盘驱动器等。存储器450可选地包括在物理位置上远离处理器410的一个或多个存储设备。存储器450包括易失性存储器或非易失性存储器，也可包括易失性和非易失性存储器两者。非易失性存储器可以是只读存储器，易失性存储器可以是随机存取存储器。本申请实施例描述的存储器450旨在包括任意适合类型的存储器。在一些实施例中，存储器450能够存储数据以支持各种操作，这些数据的示例包括程序、模块和数据结构或者其子集或超集，下面示例性说明。操作系统451，包括用于处理各种基本系统服务和执行硬件相关任务的系统程序，例如框架层、核心库层、驱动层等，用于实现各种基础业务以及处理基于硬件的任务；网络通信模块452，用于经由一个或多个网络接口420到达其他计算设备，示例性的网络接口420包括：蓝牙、无线相容性认证、和通用串行总线等；呈现模块453，用于经由一个或多个与用户接口430相关联的输出装置431使得能够呈现信息；输入处理模块454，用于对一个或多个来自一个或多个输入装置432之一的一个或多个用户输入或互动进行检测以及翻译所检测的输入或互动。在一些实施例中，本申请实施例提供的基于人工智能的分子处理装置可以采用软件方式实现，图3示出了存储在存储器450中的基于人工智能的分子处理装置455，其可以是程序和插件等形式的软件，包括以下软件模块：获取模块4551、神经网络模块4552、计算模块4553、修正模块4554以及训练模块4555，这些模块是逻辑上的，因此根据所实现的功能可以进行任意的组合或进一步拆分。将在下文中说明各个模块的功能。如前所述，本申请实施例提供的基于人工智能的分子处理方法可以由各种类型的电子设备实施。参见图4A，图4A是本申请实施例提供的基于人工智能的分子处理方法的流程示意图，结合图4A示出的步骤101至步骤104进行说明。在步骤101中，获取目标分子的三维结构。作为示例，目标分子具有多个分子构象，每个分子构象具有对应的三维结构，目标分子包括至少一个原子，针对具有多个原子的目标分子而言，三维结构即是由多个原子以及至少一个化学键构成的立体结构。在步骤102中，调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差。作为示例，通过神经网络模型对目标分子的三维结构进行特征提取处理，得到能量误差特征，并将能量误差特征映射为通过两种给定的能量计算机制对目标分子进行能量计算时得到的计算结果差值，神经网络模型是根据特征映射，拟合得到能量误差，并不需要真的通过两种给定的能量计算机制对目标分子进行能量计算，这是因为神经网络模型所能够实现的功能取决于训练方式，神经网络模型是通过拟合样本分子的能量误差进行训练得到的，样本分子的能量误差指分别按照两种能量计算机制来计算样本分子的能量时得到的计算结果差值，能量计算机制表征对给定分子进行能量计算的方式，能量计算的方式可以为基于计算化学的能量计算处理，基于计算化学的能量计算处理包括量子力学方式和分子力学方式。量子力学方式包括从头计算方式和半经验量子力学方式，两种能量计算机制包括第一能量计算处理以及第二能量计算处理，第一能量计算处理的精度小于第二能量计算处理的精度，且第一能量计算处理的速度大于第二能量计算处理的速度。在步骤103中，对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量。作为示例，第一能量计算处理以及第二能量计算处理可以为计算化学的能量计算处理，计算化学的能量计算处理包括量子力学方式和分子力学方式。量子力学的方式包括从头计算方式和半经验的量子力学方式，第一能量计算处理可以为半经验的量子力学方式，第二能量计算处理可以为头计算方式，从头计算方式是一种基于量子化学第一性原理，并使用严密的近似求解薛定谔方程的方式。在从头计算方式中，有基于波函数的方式和基于密度泛函的方式，基于波函数的代表性方式是基于哈特里-福克方程的方式，基于密度泛函的代表性方式是基于密度泛函理论的方式。在步骤104中，基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量。作为示例，误差修正处理指对第一能量与能量误差进行相加或者相减处理，当能量误差用于表征第一能量计算处理与第二能量计算处理之间的计算结果差值时，误差修正处理是对第一能量与能量误差进行相减处理，得到目标分子的第二能量，当能量误差用于表征第二能量计算处理与第一能量计算处理之间的计算结果差值时，误差修正处理是对第一能量与能量误差进行相加处理，得到目标分子的第二能量。在一些实施例中，参见图4B，图4B是本申请实施例提供的基于人工智能的分子处理方法的流程示意图，步骤102中调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差可以通过图4B示出的步骤1021至步骤1022实现。在步骤1021中，通过神经网络模型对三维结构进行特征提取处理，得到目标分子的能量误差特征。在步骤1022中，通过神经网络模型对能量误差特征进行全连接处理，得到目标分子的能量误差。通过人工智能的方式提取三维结构的能量误差特征，并基于能量误差特征预测目标分子的能量误差，从而可以智能化地确定出利用两种能量计算处理计算目标分子的分子能量的计算结果差值。在一些实施例中，神经网络模型包括N个级联的特征网络，步骤1021中通过神经网络模型对三维结构进行特征提取处理，得到目标分子的能量误差特征，可以通过以下步骤A至步骤C实现。在步骤A中，对三维结构中每个原子进行初始特征提取处理，得到每个原子的初始特征。作为示例，当目标分子E包括三个原子以及一个化学键时，针对每个原子进行初始特征提取处理，获取三维结构中每个原子的初始属性特征，初始属性特征表征原子的属性信息，属性信息包括以下至少之一：原子的种类、原子的性质等等，获取三维结构中每个原子的初始坐标特征，初始坐标特征表征原子的位置信息，位置信息指每个原子的三维坐标，以三个原子中任意一个原子作为原点建立三维坐标系，从而可以确定出其他两个原子的三维坐标，针对三维结构中每个原子执行以下处理，例如，针对原子A执行以下处理：获取三维结构中除原子A之外的至少一个其他原子，并获取原子与每个其他原子之间的初始关系特征，初始关系特征表征原子与其他原子的连接关系，初始关系特征表征原子A与原子B的连接关系以及原子A与原子C的连接关系，存在两种连接关系，有连接关系以及无连接关系，若两个原子通过化学键相连，则两个原子有连接关系，若两个原子未通过化学键相连，则两个原子没有连接关系，将每个原子的初始属性特征、每个原子的初始坐标特征以及每个原子的初始关系特征，组成每个原子的初始特征。将初始属性特征、初始关系特征以及初始坐标特征组成初始特征，不仅可以表征原子的种类属性，还可以表征原子的相对位置以及通过化学键的连接情况，从而有效提高初始特征的表征能力，在步骤B中，当n取值为1≤n≤N-2时，通过N个级联的特征网络中的第n特征网络，对第n特征网络的输入进行第n特征提取处理，得到每个原子的第n特征，并将第n特征传输到第n+1特征网络以继续进行第n+1特征提取处理。作为示例，N的取值范围满足2≤N，n为取值从1开始递增的整数，且n的取值范围满足1≤n≤N-1；当n取值为1时，第n特征网络的输入为每个原子的初始特征，当n取值为2≤n≤N-1时，第n特征网络的输入为第n-1特征网络输出的每个原子的第n-1特征。作为示例，假设N取值为3，仍然以原子A为例执行以下处理：通过第1特征网络对原子A的初始特征进行第1特征提取处理，得到原子A的第1特征，并将第1特征传输到第2特征网络以继续进行第2特征提取处理，通过第2特征网络对原子A的第1特征进行第2特征提取处理，得到原子A的第2特征。在步骤C中，当n取值为N-1时，通过第n+1特征网络对每个原子的第n特征进行属性特征提取处理，得到每个原子的第n+1属性特征，并通过第n+1特征网络对每个原子的第n特征进行坐标特征提取处理，得到每个原子的第n+1坐标特征，将每个原子的第n+1属性特征以及第n+1坐标特征组成能量误差特征。作为示例，假设N取值为3，仍然以原子A为例执行以下处理：通过第3特征网络对原子A的第2特征进行第3属性特征提取处理，得到原子A的第3属性特征，通过第3特征网络对原子A的第2特征进行第3坐标特征提取处理，得到原子A的第3坐标特征，并将原子A的第3属性特征以及原子A的第3坐标特征作为能量误差特征。通过本申请实施例可以通过迭代的方式获取每个原子的坐标特征以及每个原子的属性特征，再将多个原子的坐标特征以及多个原子的属性特征组成能量误差特征，可以有效提高能量误差特征的特征表达能力，从而提高后续预测能量误差的精度。在一些实施例中，步骤B中通过N个级联的特征网络中的第n特征网络，对第n特征网络的输入进行第n特征提取处理，得到每个原子的第n特征，可以通过第n特征网络对每个原子执行以下步骤实现。在步骤B1中，获取三维结构中除原子之外的其他原子，仍然以目标分子E为例，其他原子是除原子A之外的其他原子B以及其他原子C。在步骤B2中，对原子的第n-1特征以及每个其他原子的第n-1特征，执行第一映射处理，得到原子对应每个其他原子的第n关联特征。从原子的第n-1特征中提取出原子的第n-1坐标特征，并从每个其他原子的第n-1特征中提取出每个其他原子的第n-1坐标特征；从原子的第n-1特征中提取出原子的第n-1属性特征，并从每个其他原子的第n-1特征中提取出每个其他原子的第n-1属性特征；从原子的第n-1特征中提取出原子的第n-1关系特征；针对每个其他原子执行以下处理：从原子的第n-1关系特征中提取原子针对其他原子的第n-1关系特征；获取原子的第n-1坐标特征与其他原子的第n-1坐标特征之间的第一特征距离；对第一特征距离的平方、原子的第n-1属性特征、其他原子的第n-1属性特征、以及原子针对其他原子的第n-1关系特征，执行第一融合处理，得到原子对应其他原子的第n关联特征。通过本申请实施例将任意两个原子之间的特征距离以及任意两个原子的连接关系考虑到关联特征中去，从而关联特征可以学习到三维结构的全局信息，可以提高神经网络模型的全局信息学习能力。作为示例，假设N取值为3，仍然以原子A以及其他原子B为例进行说明，从原子A的第2特征中提取出原子A的第2坐标特征，从原子B的第2特征中提取出原子B的第2坐标特征，从原子A的第2特征中提取出原子的第2属性特征，从原子B的第2特征中提取出原子B的第2属性特征。第n-1关系特征即为初始关系特征，即关系特征并非会因为特征迭代而变化，从原子A的第2特征中提取出原子A的第2关系特征，从原子B的第2特征中提取出原子的第2关系特征。作为示例，针对其他原子B执行后续处理，参见公式：其中，是原子A的第n-1属性特征，是原子B的第n-1属性特征，是原子A的第n-1坐标特征，是原子B的第n-1坐标特征，aij是原子A对应原子B的第n-1关系特征，φe表征第一融合处理，表征原子A的第n-1坐标特征与原子B的第n-1坐标特征之间的第二特征距离，mij是原子A对应其他原子B的第n关联特征。在步骤B3中，对原子的第n-1特征以及原子对应每个其他原子的第n关联特征，执行第二映射处理，得到原子的第n特征。将原子对应多个其他原子的第n关联特征进行求和处理，得到原子的第n关联特征；对原子的第n-1属性特征以及原子的第n关联特征进行第二融合处理，得到原子的第n属性特征；获取原子的第n-1坐标特征与每个其他原子的第n-1坐标特征之间的第一特征差值；对原子对应每个其他原子的第n关联特征进行线性映射处理，得到每个其他原子的权重；基于每个其他原子的权重，对多个其他原子的第一特征差值进行加权平均处理，得到对应原子的加权平均结果；将原子的加权平均结果与原子的第n-1坐标特征进行求和处理，得到原子的第n坐标特征；将原子的初始关系特征作为原子的第n关系特征；将原子的第n关系特征、原子的第n属性特征以及原子的第n坐标特征，组成原子的第n特征。通过本申请实施例将任意两个原子之间的特征距离以及任意两个原子的连接关系考虑到第n特征中去，从而第n特征可以学习到三维结构的全局信息，可以提高神经网络模型的全局信息学习能力。作为示例，将原子A对应多个其他原子的第n关联特征进行求和处理，得到原子A的第n关联特征，参见公式：其中，i是原子A，j是原子B以及原子C，mi是原子A的第n关联特征，mij是原子A对应原子B的第n关联特征以及原子A对应原子C的第n关联特征。作为示例，对原子A的第n-1属性特征以及原子A的第n关联特征进行第二融合处理，得到原子A的第n属性特征，参见公式：其中，i是原子A，是原子A的第n属性特征，是原子A的第n-1属性特征，mi是原子A的第n关联特征，φh是第二融合处理。作为示例，获取原子A的第n-1坐标特征与其他原子的第n-1坐标特征之间的第一特征差值；以原子A对应每个其他原子的第n关联特征为权重，对多个其他原子的第一特征差值进行加权平均处理，得到对应原子A的加权平均结果；将原子A的加权平均结果与原子A的第n-1坐标特征进行求和处理，得到原子A的第n坐标特征，针对原子A、其他原子的上述处理可以参见公式：其中，是原子A的第n坐标特征，是原子A的第n-1坐标特征，是其他原子的第n-1坐标特征，mij是原子A对应其他原子B的第n关联特征，M是目标分子中原子数目的倒数，是坐标线性映射处理。作为示例，将原子A的初始关系特征作为原子A的第n关系特征；将原子A对应每个其他原子的第n关系特征aij、原子A的第n属性特征以及原子A的第n坐标特征，组成原子的第n特征。在一些实施例中，步骤C中通过第n+1特征网络对每个原子的第n特征进行属性特征提取处理，得到每个原子的第n+1属性特征，可以通过以下技术方案实现：从每个原子的第n特征中提取出原子的第n坐标特征、原子的第n属性特征以及原子的第n关系特征；针对每个原子执行以下处理：获取三维结构中除原子外的其他原子，并针对每个其他原子执行以下处理：从原子的第n关系特征中提取原子针对其他原子的第n关系特征，并获取原子的第n坐标特征与其他原子的第n坐标特征之间的第二特征距离；对第二特征距离的平方、原子的第n属性特征、其他原子的第n属性特征、以及原子针对其他原子的第n关系特征，执行第一融合处理，得到原子对应其他原子的第n+1关联特征；将原子对应多个其他原子的第n+1关联特征进行求和处理，得到原子的第n+1关联特征；对原子的第n属性特征以及原子的第n+1关联特征进行第二融合处理，得到原子的第n+1属性特征。作为示例，从每个所述原子的第n特征中提取出所述原子的第n坐标特征、所述原子的第n属性特征以及所述原子的第n关系特征，具体而言，假设N取值为3，仍然以原子A、原子B以及原子C为例执行以下处理，从原子A的第2特征中提取出原子的第2坐标特征，从原子B的第2特征中提取出原子B的第2坐标特征，从原子C的第2特征中提取出原子C的第2坐标特征，从原子A的第2特征中提取出原子的第2属性特征，从原子B的第2特征中提取出原子B的第2属性特征，从原子C的第2特征中提取出原子C的第2属性特征。第n关系特征即为初始关系特征，即关系特征并非会因为特征迭代而变化，从原子A的第2特征中提取出原子的第2关系特征，从原子B的第2特征中提取出原子的第2关系特征，从原子C的第2特征中提取出原子的第2关系特征。作为示例，针对每个原子，获取三维结构中除原子外的其他原子B以及其他原子C，并针对每个其他原子执行后续处理，参见公式：其中，是原子A的第n属性特征，是原子B的第n属性特征，是原子A的第n坐标特征，是原子B的第n坐标特征，aij是原子A对应原子B的第n关系特征，φe表征第一融合处理，表征原子A的第n坐标特征与原子B的第n坐标特征之间的第二特征距离，mij是原子A对应其他原子B的第n+1关联特征。作为示例，将原子A对应多个其他原子的第n+1关联特征进行求和处理，得到原子A的第n+1关联特征，参见公式：其中，i是原子A，j是原子B以及原子C，mi是原子A的第n+1关联特征，mij是原子A对应其他原子B的第n+1关联特征。作为示例，对原子A的第n属性特征以及原子A的第n+1关联特征进行第二融合处理，得到原子A的第n+1属性特征，参见公式：其中，i是原子A，是原子A的第n+1属性特征，是原子A的第n属性特征，mi是原子A的第n+1关联特征，φh是第二融合处理。在一些实施例中，参见图4C，在调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差之前，还可以执行图4C示出的步骤105至步骤109。在步骤105中，获取样本分子，并对样本分子进行构象生成处理，得到多个样本分子构象。作为示例，样本分子来自于任意分子数据集，例如QMugs数据集，对样本分子进行构象生成处理，可以得到多个样本分子构象，构象生成处理包括对化学键进行扭转，得到的多个样本分子构象包括样本分子本身的分子构象以及经过化学键扭转得到的其他分子构象，构象生成处理不能改变分子中各个原子的种类，但是可以改变分子中各个原子的坐标以及各个原子的距离。在步骤106中，获取每个样本分子构象的标签能量误差。在一些实施例中，步骤106中获取每个样本分子构象的标签能量误差，可以通过以下技术方案实现：针对每个样本分子构象执行以下处理：对样本分子构象进行第一能量计算处理，得到样本分子构象的第一能量；对样本分子构象进行第二能量计算处理，得到样本分子构象的第二能量；获取样本分子的第二能量与样本分子的第一能量的第一差值，作为样本分子构象的标签能量误差。作为示例，使用高精度的第二能量处理方式计算分子的分子能量，例如，利用DFT计算理论层级与基组“WB97X-D3/def2-TZVP”来计算分子的量子力学能量作为分子能量，将计算得到的分子能量记为E_dft，同时，使用高速度的第一能量处理方式计算分子的分子能量，例如，使用半经验量子力学方法计算分子的半经验量子力学能量作为分子能量，将计算得到的分子能量记为E_xtb，将二者之差E_delta＝E_dft-E_xtb作为分子构象的标签能量误差。在步骤107中，将每个样本分子构象在初始化的神经网络模型中进行正向传播，得到每个样本分子构象的预测能量误差。作为示例，通过初始化的神经网络模型对三维结构进行特征提取处理，得到目标分子的能量误差特征；通过初始化的神经网络模型对能量误差特征进行全连接处理，得到目标分子的能量误差。初始化的神经网络模型的处理过程可以参考上述实施例，区别仅在于处理过程中所使用的参数是初始化的参数，而非训练后得到的参数。在步骤108中，基于每个样本分子构象的标签能量误差以及每个样本分子构象的预测能量误差，确定对应神经网络模型的综合损失。在一些实施例中，步骤108中基于每个样本分子构象的标签能量误差以及每个样本分子构象的预测能量误差，确定对应神经网络模型的综合损失，可以通过以下技术方案实现：针对每个样本分子构象执行以下处理：基于样本分子构象的标签能量误差以及样本分子构象的预测能量误差，确定样本分子构象的第一均方根误差；获取样本分子的除样本分子构象之外的其他样本分子构象；针对每个其他样本分子构象执行以下处理：确定样本分子构象的标签能量误差与其他样本分子构象的标签能量误差之间的第二差值，并确定样本分子构象的预测能量误差与其他样本分子构象的预测能量误差之间的第三差值；对第二差值以及第三差值执行均方根处理，得到样本分子构象对应其他样本分子构象的第二均方根误差；将样本分子构象对应多个其他样本分子构象的第二均方根误差进行求和处理，得到样本分子构象的第三均方根误差；对多个样本分子构象的第一均方根误差以及多个样本分子的第三均方根误差进行第三融合处理，得到对应神经网络模型的综合损失。作为示例，神经网络模型的综合损失参见公式：其中，是第一均方根误差，是样本分子构象i的标签能量误差，Ei是样本分子构象i的预测能量误差，L2表征均方根处理，是样本分子构象i的标签能量误差与其他样本分子构象m的标签能量误差之间的第二差值，Ei-Em是样本分子构象i的预测能量误差与其他样本分子构象m的预测能量误差之间的第三差值，是样本分子构象i的第三均方根误差，是综合损失。在步骤109中，将综合损失在神经网络模型中进行反向传播处理，得到综合损失收敛时神经网络模型的参数变化值，并基于参数变化值更新神经网络模型的参数。作为示例，反向传播可以利用反向传播算法实现，反向传播算法主要由两个环节反复循环迭代，直到网络的对输入的响应达到预定的目标范围为止。反向传播算法的学习过程由正向传播过程和反向传播过程组成。在正向传播过程中，输入信息通过输入层经隐含层，逐层处理并传向输出层。如果在输出层得不到期望的输出值，则取输出与期望的误差的平方和作为目标函数，转入反向传播，逐层求出目标函数对各神经元权值的偏导数，构成目标函数对权值向量的梯量，作为修改权值的依据，网络的学习在权值修改过程中完成。综合损失收敛到期望值时，神经网络模型的学习结束。下面，将说明本申请实施例在一个实际的应用场景中的示例性应用。终端可以被用来获取针对目标分子的能量评估请求，例如，研发人员通过终端的输入界面输入目标分子，则自动生成针对目标分子的能量评估请求，终端将目标分子的能量预测请求发送至服务器，服务器获取目标分子的三维结构，并调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量，服务器将目标分子的第二能量返回至终端，从而研发人员可以基于目标分子的第二能量可以进行后续的分析研究，例如通过目标分子的第二能量确定出目标分子与蛋白质口袋结合能力，并基于目标分子与蛋白质口袋结合能力对候选药物化合物进行筛选。本申请实施例提供的基于人工智能的分子处理方法可以用在新药研发流程以及材料研发流程中，以新药研发流程为例，如图1所示，在新药研发流程中，在完成靶点识别与验证之后，需要对候选药物化合物进行筛选。在筛选过程中，对分子性质计算、分子与蛋白质口袋结合能力计算等场景中通常要计算分子的能量。计算结果有助于药物研发人员分析分子性质、分子与蛋白质口袋的结合能力等，可以帮助研发人员设计出更有效的药物分子，大大提高研发效率，降低了药物研发成本。首先需要构建深度量子化学模型的训练数据集，以任意数据集为基础，构建增强数据集，增强数据集中有66万种分子，每种分子分别有3个分子构象，所以总共有近200万条数据。对于增强数据集中的每个分子构象，使用高精度的第二能量处理方式计算分子的分子能量，例如，利用DFT计算理论层级与基组“WB97X-D3/def2-TZ VP”来计算分子的量子力学能量作为分子能量，将计算得到的分子能量记为E_dft，同时，使用高速度的第一能量处理方式计算分子的分子能量，例如，使用半经验量子力学方法计算分子的半经验量子力学能量作为分子能量，将计算得到的分子能量记为E_xtb，将二者之差E_delta＝E_dft-E_xtb作为分子构象的标签能量误差，使用Psi4工具实现第二能量处理方式涉及到的量子力学计算，使用xTB工具实现第一能量处理方式涉及到的半经验量子力学计算。将增强数据集按照8:1:1的比例切分，分别作为DeepQC的训练集、验证集和测试集。DeepQC模型的架构如图5所示，DeepQC模型包括涉及深度学习的神经网络模型以及涉及计算化学的第一能量处理方式，神经网络模型可以为等变图神经网络，神经网络模型的输入是分子的三维结构坐标，神经网络模型的输出是E_delta预测值。在训练过程中，将前向传播获得E_delta预测值与E_delta标签值之间计算综合损失，并对综合损失进行反向传播，得到每个网络层的梯度，并使用自适应矩估计算法更新神经网络模型的参数。神经网络模型的综合损失参见公式：其中，损失函数中包含两个部分，第一部分是模型输出的E_delta预测值与E_delta标签值之间的均方根误差，第二部分是预测差与标签差之间的均方根误差，预测差指相同分子的不同构象之间的E_delta预测值差异，标签差指相同分子的不同构象之间的E_delta标签值差异。DeepQC模型的训练超参数如表1所示：表1 DeepQC模型的超参数表层数8学习率0.002训练集规模32权重衰减0.000001训练重复次数100丢弃率0.1可以通过训练好的DeepQC模型来预测分子的能量，将分子的三维坐标输入到DeepQC模型中，通过第一能量计算处理可以得到第一能量E_xtb，通过神经网络模型会预测得到能量误差E_delta，将二者累加就得到最终的预测能量值E_dft。在新药/新材料研发流程中需要计算分子的能量，在相关技术的计算方法中，量子力学方法的计算量大且计算耗时，无法进行大规模计算；深度学习方法在长程作用上预测较差，精度有待提升。本申请实施例提出的DeepQC模型旨在计算量小的前提下同时保持较高精度。为了更好验证DeepQC模型的效果，将DeepQC模型在测试集上进行验证，在Conformer Benchmark和TorsionNet500两个数据集上进行针对计算精度的测试，并与计算化学方法、半经验量子力学方法和深度学习方法进行对比，图6纵轴表示在Conformer Benchmark中各种方法计算出的分子能量与理论值之间的相关性，图7纵轴表示在TorsionNet500中各种方法计算出的分子能量与理论值之间的相关性，理论值是通过高精度的量子力学方法计算得到的分子能量。在算法速度上，本申请实施例提出的DeepQC模型与高精度的量子力学方法相比，DeepQC模型在速度上有数百倍的提升。下面继续说明本申请实施例提供的基于人工智能的分子处理装置455的实施为软件模块的示例性结构，在一些实施例中，如图3所示，存储在存储器450的基于人工智能的分子处理装置455中的软件模块可以包括：获取模块4551，用于获取目标分子的三维结构；神经网络模块4552，用于调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差；其中，神经网络模型是通过拟合样本分子的能量误差进行训练得到的，样本分子的能量误差指分别按照两种能量计算机制来计算样本分子的能量时得到的计算结果差值，两种能量计算机制包括第一能量计算处理以及第二能量计算处理，第一能量计算处理的精度小于第二能量计算处理的精度，且第一能量计算处理的速度大于第二能量计算处理的速度；计算模块4553，用于对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量；修正模块4554，用于基于目标分子的能量误差对目标分子的第一能量进行误差修正处理，得到目标分子的第二能量。在一些实施例中，神经网络模块4552，还用于：通过神经网络模型对三维结构进行特征提取处理，得到目标分子的能量误差特征；通过神经网络模型对能量误差特征进行全连接处理，得到目标分子的能量误差。在一些实施例中，神经网络模型包括N个级联的特征网络，神经网络模块4552，还用于：对三维结构中每个原子进行初始特征提取处理，得到每个原子的初始特征；当n取值为1≤n≤N-2时，通过N个级联的特征网络中的第n特征网络，对第n特征网络的输入进行第n特征提取处理，得到每个原子的第n特征，并将第n特征传输到第n+1特征网络以继续进行第n+1特征提取处理；当n取值为N-1时，通过第n+1特征网络对每个原子的第n特征进行属性特征提取处理，得到每个原子的第n+1属性特征，并通过第n+1特征网络对每个原子的第n特征进行坐标特征提取处理，得到每个原子的第n+1坐标特征，并将每个原子的第n+1属性特征以及第n+1坐标特征组成能量误差特征；其中，n为取值从1开始递增的整数，且n的取值范围满足1≤n≤N-1；当n取值为1时，第n特征网络的输入为每个原子的初始特征，当n取值为2≤n≤N-1时，第n特征网络的输入为第n-1特征网络输出的每个原子的第n-1特征。在一些实施例中，神经网络模块4552，还用于：获取三维结构中每个原子的初始属性特征，并获取三维结构中每个原子的初始坐标特征；其中，初始属性特征表征原子的属性信息，初始坐标特征表征原子的位置信息；针对三维结构中每个原子执行以下处理：获取三维结构中除原子之外的至少一个其他原子，并获取原子与每个其他原子之间的初始关系特征，其中，初始关系特征表征原子与其他原子的连接关系；将每个原子的初始属性特征、每个原子的初始坐标特征以及每个原子的初始关系特征，组成每个原子的初始特征。在一些实施例中，神经网络模块4552，还用于：通过第n特征网络对每个原子执行以下处理：获取三维结构中除原子之外的其他原子；对原子的第n-1特征以及每个其他原子的第n-1特征，执行第一映射处理，得到原子对应每个其他原子的第n关联特征；对原子的第n-1特征以及原子对应每个其他原子的第n关联特征，执行第二映射处理，得到原子的第n特征。在一些实施例中，神经网络模块4552，还用于：从原子的第n-1特征中提取出原子的第n-1坐标特征，并从每个其他原子的第n-1特征中提取出每个其他原子的第n-1坐标特征；从原子的第n-1特征中提取出原子的第n-1属性特征，并从每个其他原子的第n-1特征中提取出每个其他原子的第n-1属性特征；从原子的第n-1特征中提取出原子的第n-1关系特征；针对每个其他原子执行以下处理：从原子的第n-1关系特征中提取原子针对其他原子的第n-1关系特征；获取原子的第n-1坐标特征与其他原子的第n-1坐标特征之间的第一特征距离；对第一特征距离的平方、原子的第n-1属性特征、其他原子的第n-1属性特征、以及原子针对其他原子的第n-1关系特征，执行第一融合处理，得到原子对应其他原子的第n关联特征。在一些实施例中，神经网络模块4552，还用于：当其他原子的数目为多个时，将原子对应多个其他原子的第n关联特征进行求和处理，得到原子的第n关联特征；对第n-1属性特征以及原子的第n关联特征进行第二融合处理，得到原子的第n属性特征；获取原子的第n-1坐标特征与每个其他原子的第n-1坐标特征之间的第一特征差值；以原子对应每个其他原子的第n关联特征为权重，对多个其他原子的第一特征差值进行加权平均处理，得到对应原子的加权平均结果；将原子的加权平均结果与原子的第n-1坐标特征进行求和处理，得到原子的第n坐标特征；将原子的初始关系特征作为原子的第n关系特征；将原子的第n关系特征、原子的第n属性特征以及原子的第n坐标特征，组成原子的第n特征。在一些实施例中，神经网络模块4552，还用于：从原子的第n特征中提取出原子的第n坐标特征，并从每个其他原子的第n特征中提取出每个其他原子的第n坐标特征；从原子的第n特征中提取出原子的第n属性特征，并从每个其他原子的第n特征中提取出每个其他原子的第n属性特征；从原子的第n特征中提取出原子的第n关系特征；针对每个其他原子执行以下处理：从原子的第n关系特征中提取原子针对其他原子的第n关系特征；获取原子的第n坐标特征与其他原子的第n坐标特征之间的第二特征距离；对第二特征距离的平方、原子的第n属性特征、其他原子的第n属性特征、以及原子针对其他原子的第n关系特征，执行第一融合处理，得到原子对应其他原子的第n+1关联特征；当其他原子的数目为多个时，执行以下处理：将原子对应多个其他原子的第n+1关联特征进行求和处理，得到原子的第n+1关联特征；对第n属性特征以及原子的第n+1关联特征进行第二融合处理，得到原子的第n+1属性特征。在一些实施例中，在调用神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差之前，装置还包括：训练模块4555，用于：获取样本分子，并对样本分子进行构象生成处理，得到多个样本分子构象；获取每个样本分子构象的标签能量误差；将每个样本分子构象在神经网络模型中进行正向传播，得到每个样本分子构象的预测能量误差；基于每个样本分子构象的标签能量误差以及每个样本分子构象的预测能量误差，确定对应神经网络模型的综合损失；将综合损失在神经网络模型中进行反向传播处理，得到综合损失收敛时神经网络模型的参数变化值，并基于参数变化值更新神经网络模型的参数。在一些实施例中，训练模块4555，还用于：针对每个样本分子构象执行以下处理：对样本分子构象进行第一能量计算处理，得到样本分子构象的第一能量；对样本分子构象进行第二能量计算处理，得到样本分子构象的第二能量；获取样本分子的第二能量与样本分子的第一能量的第一差值，作为样本分子构象的标签能量误差。在一些实施例中，第一能量计算处理是基于半经验量子力学的能量计算处理，第二能量计算处理是基于密度泛函的能量计算处理。在一些实施例中，训练模块4555，还用于：针对每个样本分子构象执行以下处理：基于样本分子构象的标签能量误差以及样本分子构象的预测能量误差，确定样本分子构象的第一均方根误差；获取样本分子的除样本分子构象之外的其他样本分子构象；针对每个其他样本分子构象执行以下处理：确定样本分子构象的标签能量误差与其他样本分子构象的标签能量误差之间的第二差值，并确定样本分子构象的预测能量误差与其他样本分子构象的预测能量误差之间的第三差值；对第二差值以及第三差值执行均方根处理，得到样本分子构象对应其他样本分子构象的第二均方根误差；将样本分子构象对应多个其他样本分子构象的第二均方根误差进行求和处理，得到样本分子构象的第三均方根误差；对多个样本分子构象的第一均方根误差以及多个样本分子的第三均方根误差进行第三融合处理，得到对应神经网络模型的综合损失。本申请实施例提供了一种计算机程序产品，该计算机程序产品包括计算机程序或者计算机可执行指令，该计算机可执行指令存储在计算机可读存储介质中。电子设备的处理器从计算机可读存储介质读取该计算机可执行指令，处理器执行该计算机可执行指令，使得该电子设备执行本申请实施例上述的基于人工智能的分子处理方法。本申请实施例提供一种存储有计算机可执行指令的计算机可读存储介质，其中存储有计算机可执行指令，当计算机可执行指令被处理器执行时，将被处理器执行本申请实施例提供的基于人工智能的分子处理方法，例如，如图4A-图4C示出的基于人工智能的分子处理方法。在一些实施例中，计算机可读存储介质可以是FRAM、ROM、PROM、EP ROM、EEPROM、闪存、磁表面存储器、光盘、或CD-ROM等存储器；也可以是包括上述存储器之一或任意组合的各种设备。在一些实施例中，可执行指令可以采用程序、软件、软件模块、脚本或代码的形式，按任意形式的编程语言来编写，并且其可按任意形式部署，包括被部署为独立的程序或者被部署为模块、组件、子例程或者适合在计算环境中使用的其它单元。作为示例，可执行指令可以但不一定对应于文件系统中的文件，可以可被存储在保存其它程序或数据的文件的一部分，例如，存储在超文本标记语言文档中的一个或多个脚本中，存储在专用于所讨论的程序的单个文件中，或者，存储在多个协同文件中。作为示例，可执行指令可被部署为在一个计算设备上执行，或者在位于一个地点的多个计算设备上执行，又或者，在分布在多个地点且通过通信网络互连的多个计算设备上执行。综上所述，通过本申请实施例对目标分子的三维结构进行第一能量计算处理，得到目标分子的第一能量，由于第一能量计算处理的速度高于第二能量计算处理，从而提高能量计算处理的速度，通过神经网络模型对目标分子的三维结构进行能量误差预测处理，得到目标分子的能量误差，并基于能量误差对计算得到的第一能量进行误差修正处理，得到目标分子的第二能量，由于能量误差可以表征高精度的第二能量计算处理与低精度的第一能量计算处理之间的计算结果差异，从而可以利用深度学习预测得到的能量误差对计算得到的第一能量进行修正，从而提高第二能量的精度。以上所述，仅为本申请的实施例而已，并非用于限定本申请的保护范围。凡在本申请的精神和范围之内所作的任何修改、等同替换和改进等，均包含在本申请的保护范围之内。
