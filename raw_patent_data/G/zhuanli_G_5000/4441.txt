标题title
模型的训练方法、训练装置、电子设备和可读存储介质
摘要abst
本公开提供了一种模型的训练方法、训练装置、电子设备和可读存储介质，涉及机器学习技术领域。其中，人脸三维构建模型的训练方法包括：获取多项编码信息，多项编码信息包括基于图像采集设备获取到的光线的方向编码和采样编码，以及采集到的人脸形状编码和人脸外观编码；基于多项编码信息进行网络模型的模型训练，并使网络模型输出多角度人脸训练特征；基于多角度人脸训练特征和待重建人脸二维图像计算网络模型的模型损失；将模型损失输入网络模型进行反向传播，以迭代更新网络模型的模型参数，直至网络模型收敛，得到人脸三维构建模型。通过本公开的技术方案，在降低方案实施成本的同时，保证了三维重构操作的实用性与可靠性。
权利要求书clms
1.一种人脸三维构建模型的训练方法，其特征在于，包括：获取多项编码信息，所述多项编码信息包括基于图像采集设备获取到的光线的方向编码和采样编码，以及采集到的人脸形状编码和人脸外观编码；基于所述多项编码信息进行网络模型的模型训练，并使所述网络模型输出多角度人脸训练特征；基于所述多角度人脸训练特征和待重建人脸二维图像计算所述网络模型的模型损失；将所述模型损失输入所述网络模型进行反向传播，以迭代更新所述网络模型的模型参数，直至所述网络模型收敛，得到所述人脸三维构建模型。2.根据权利要求1所述的人脸三维构建模型的训练方法，其特征在于，所述获取多项编码信息包括：获取所述图像采集设备的位姿信息；基于光线投射算法对所述位姿信息进行体绘制处理，生成所述图像采集设备基于所述位姿信息采集到的光线的所述方向编码和所述采样编码；基于对标准高斯分布进行随机采样获取所述人脸形状编码和所述人脸外观编码，以结合所述方向编码和所述采样编码得到所述多项编码信息。3.根据权利要求2所述的人脸三维构建模型的训练方法，其特征在于，所述网络模型包括第一网络和第二网络，所述基于所述多项编码信息进行网络模型的模型训练包括：基于所述多项编码信息进行所述第一网络的训练，得到生成式神经特征场模块，所述生成式神经特征场模块用于基于所述多项编码信息生成场景图像，并输出所述场景图像的张量信息，所述张量信息包括体素密度张量和特征张量；基于所述张量信息进行所述第二网络的训练，得到神经渲染模块，所述神经渲染模块用于将所述体素密度张量和所述特征张量映射上采样到合成的多角度人脸图像，以将所述多角度人脸图像和所述特征张量确定为所述多角度人脸训练特征。4.根据权利要求3所述的人脸三维构建模型的训练方法，其特征在于，所述第一网络基于全连接网络构建。5.根据权利要求3所述的人脸三维构建模型的训练方法，其特征在于，所述第二网络基于全连接网络构建。6.根据权利要求3所述的人脸三维构建模型的训练方法，其特征在于，所述基于所述多角度人脸训练特征和待重建人脸二维图像计算所述网络模型的模型损失包括：将所述多角度人脸图像和所述待重建人脸二维图像输入鉴别器，以基于所述鉴别器对所述多角度人脸图像和所述待重建人脸二维图像进行判别，基于判别结果得到第一损失值；基于第一编码器对所述特征张量进行编码，生成第一特征图；基于第二编码器对所述待重建人脸二维图像进行特征提取，生成第二特征图，以基于所述第二特征图对所述待重建人脸二维图像的身份信息进行约束；度量所述第一特征图和所述第二特征图之间的损失，得到第二损失值；基于所述第一损失值和所述第二损失值得到所述网络模型的模型损失。7.根据权利要求6所述的人脸三维构建模型的训练方法，其特征在于，还包括：基于VGG-16网络和/或ResNet网络构建所述鉴别器。8.根据权利要求6所述的人脸三维构建模型的训练方法，其特征在于，还包括：基于VGG-16网络和/或ResNet网络构建所述第一编码器。9.根据权利要求6所述的人脸三维构建模型的训练方法，其特征在于，基于人脸数据集对网络VGG-16和/或Light-CNN网络进行预训练，得到所述第二编码器。10.根据权利要求6所述的人脸三维构建模型的训练方法，其特征在于，所述基于比较结果得到第一损失值包括：将所述判别结果输入GAN损失函数，并输出所述第一损失值。11.根据权利要求6所述的人脸三维构建模型的训练方法，其特征在于，所述对所述第一特征图和所述第二特征图进行损失度量，得到第二损失值包括：基于均方损失函数对所述第一特征图和所述第二特征图进行损失度量，得到所述第二损失值。12.根据权利要求1至11中任一项所述的人脸三维构建模型的训练方法，其特征在于，还包括：将所述待重建人脸二维图像输入所述人脸三维构建模型，以由所述人脸三维构建模型中的神经渲染模块学习所述待重建人脸二维图像的隐式三维结构输出，并输出对应的三维人脸结构。13.一种人脸三维构建模型的训练装置，其特征在于，包括：获取模块，用于获取多项编码信息，所述多项编码信息包括基于图像采集设备获取到的光线的方向编码和采样编码，以及采集到的人脸形状编码和人脸外观编码；模型训练模块，用于基于所述多项编码信息进行网络模型的模型训练，并使所述网络模型输出多角度人脸训练特征；计算模块，用于基于所述多角度人脸训练特征和待重建人脸二维图像计算所述网络模型的模型损失；迭代更新模块，用于将所述模型损失输入所述网络模型进行反向传播，以迭代更新所述网络模型的模型参数，直至所述网络模型收敛，得到所述人脸三维构建模型。14.一种电子设备，其特征在于，包括：处理器；以及存储器，用于存储所述处理器的可执行指令；其中，所述处理器配置为经由执行所述可执行指令来执行权利要求1～12中任意一项所述的人脸三维构建模型的训练方法。15.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1～12中任意一项所述的人脸三维构建模型的训练方法。
说明书desc
技术领域本公开涉及机器学习技术领域，尤其涉及一种人脸三维构建模型的训练方法、一种人脸三维构建模型的训练装置、一种电子设备和一种计算机可读存储介质。背景技术随着虚拟平台应用的日益广泛，比如应用到线上会议、远程网课、线上购物等场景中，虚拟平台也逐渐从二维显示向三维显示过渡，相应地，在虚拟平台中显示的用户的人脸也需要从二维人脸图像转化为三维人脸结构。相关技术中，虽然通过使用雷达或深度摄像机等硬件设备实现三维人脸显示模型的构建，但是由于硬件设备的造价高昂，导致实现三维人脸显示模型的构建的方案成本较高，实用性不强。需要说明的是，在上述背景技术部分公开的信息仅用于加强对本公开的背景的理解，因此可以包括不构成对本领域普通技术人员已知的现有技术的信息。发明内容本公开的目的在于提供一种网络切换的引导方法、装置、电子设备、终端和存储介质，至少在一定程度上克服由于相关技术中三维人脸显示模型的构建的方案成本较高以及实用性不强的问题。本公开的其他特性和优点将通过下面的详细描述变得显然，或部分地通过本公开的实践而习得。根据本公开的一个方面，提供一种人脸三维构建模型的训练方法，包括：获取多项编码信息，所述多项编码信息包括基于图像采集设备获取到的光线的方向编码和采样编码，以及采集到的人脸形状编码和人脸外观编码；基于所述多项编码信息进行网络模型的模型训练，并使所述网络模型输出多角度人脸训练特征；基于所述多角度人脸训练特征和待重建人脸二维图像计算所述网络模型的模型损失；将所述模型损失输入所述网络模型进行反向传播，以迭代更新所述网络模型的模型参数，直至所述网络模型收敛，得到所述人脸三维构建模型。在一个实施例中，所述获取多项编码信息包括：获取所述图像采集设备的位姿信息；基于光线投射算法对所述位姿信息进行体绘制处理，生成所述图像采集设备基于所述位姿信息采集到的光线的所述方向编码和所述采样编码；基于对标准高斯分布进行随机采样获取所述人脸形状编码和所述人脸外观编码，以结合所述方向编码和所述采样编码得到所述多项编码信息。在一个实施例中，所述网络模型包括第一网络和第二网络，所述基于所述多项编码信息进行网络模型的模型训练包括：基于所述多项编码信息进行所述第一网络的训练，得到生成式神经特征场模块，所述生成式神经特征场模块用于基于所述多项编码信息生成场景图像，并输出所述场景图像的张量信息，所述张量信息包括体素密度张量和特征张量；基于所述张量信息进行所述第二网络的训练，得到神经渲染模块，所述神经渲染模块用于将所述体素密度张量和所述特征张量映射上采样到合成的多角度人脸图像，以将所述多角度人脸图像和所述特征张量确定为所述多角度人脸训练特征在一个实施例中，所述第一网络基于全连接网络构建。在一个实施例中，所述第二网络基于全连接网络构建。在一个实施例中，所述基于所述多角度人脸训练特征和待重建人脸二维图像计算所述网络模型的模型损失包括：将所述多角度人脸图像和所述待重建人脸二维图像输入鉴别器，以基于所述鉴别器对所述多角度人脸图像和所述待重建人脸二维图像进行判别，基于判别结果得到第一损失值；基于第一编码器对所述特征张量进行编码，生成第一特征图；基于第二编码器对所述待重建人脸二维图像进行特征提取，生成第二特征图，以基于所述第二特征图对所述待重建人脸二维图像的身份信息进行约束；度量所述第一特征图和所述第二特征图之间的损失，得到第二损失值；基于所述第一损失值和所述第二损失值得到所述网络模型的模型损失。在一个实施例中，还包括：基于VGG-16网络和/或ResNet网络构建所述鉴别器。在一个实施例中，还包括：基于VGG-16网络和/或ResNet网络构建所述第一编码器。在一个实施例中，基于人脸数据集对网络VGG-16和/或Light-CNN网络进行预训练，得到所述第二编码器。在一个实施例中，所述基于比较结果得到第一损失值包括：将所述判别结果输入GAN损失函数，并输出所述第一损失值。在一个实施例中，所述对所述第一特征图和所述第二特征图进行损失度量，得到第二损失值包括：基于均方损失函数对所述第一特征图和所述第二特征图进行损失度量，得到所述第二损失值。在一个实施例中，还包括：将待重建人脸二维图像输入所述人脸三维构建模型，以由所述人脸三维构建模型中的神经渲染模块学习所述待重建人脸二维图像的隐式三维结构输出，并输出对应的三维人脸结构。根据本公开的另一个方面，提供一种人脸三维构建模型的训练装置，包括：获取模块，用于获取多项编码信息，所述多项编码信息包括基于图像采集设备获取到的光线的方向编码和采样编码，以及采集到的人脸形状编码和人脸外观编码；模型训练模块，用于基于所述多项编码信息进行网络模型的模型训练，并使所述网络模型输出多角度人脸训练特征；计算模块，用于基于所述多角度人脸训练特征和待重建人脸二维图像计算所述网络模型的模型损失；迭代更新模块，用于将所述模型损失输入所述网络模型进行反向传播，以迭代更新所述网络模型的模型参数，直至所述网络模型收敛，得到所述人脸三维构建模型。根据本公开的再一个方面，提供一种电子设备，包括：处理器；以及存储器，用于存储处理器的可执行指令；其中，处理器配置为经由执行可执行指令来执行上述第二方面技术方案中任意一项的所述的人脸三维构建模型的训练方法。根据本公开的又一个方面，提供一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述的人脸三维构建模型的训练方法。本公开的实施例所提供的人脸三维构建模型的训练方法和装置，通过获取能够分别反映出人脸的三维特征与二维特征之间的映射关系，以及人脸上的形状特征和外观特征的多项编码，基于多项编码信息进行网络模型的模型训练，并进一步基于网络模型输出的合成的多角度人脸图像和待重建人脸二维图像计算网络模型的模型损失，以进行反向传播，实现网络模型的参数的调整，通过模型的不断迭代更新，得到人脸三维构建模型，从而使生成的人脸三维构建模型在不需要借助硬件设备的情况下就能够实现对人脸二维图像进行三维重构，在降低方案实施成本的同时，保证了三维重构操作的实用性与可靠性。应当理解的是，以上的一般描述和后文的细节描述仅是示例性和解释性的，并不能限制本公开。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本公开的实施例，并与说明书一起用于解释本公开的原理。显而易见地，下面描述中的附图仅仅是本公开的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1示出本公开实施例中一种人脸三维构建模型的训练系统的示意框图；图2示出本公开实施例中一种人脸三维构建模型的训练方法的示意图；图3示出本公开实施例中另一种人脸三维构建模型的训练方法的示意图；图4示出本公开实施例中再一种人脸三维构建模型的训练方法的示意图；图5示出本公开实施例中又一种人脸三维构建模型的训练方法的流程图；图6示出本公开实施例中又一种人脸三维构建模型的训练方案的模块示意图；图7示出本公开实施例中又一种人脸三维构建模型的训练方法的流程图；图8示出本公开实施例中一种人脸三维构建模型的训练装置的示意图；图9示出本公开实施例中一种电子设备的结构框图。具体实施方式现在将参考附图更全面地描述示例实施方式。然而，示例实施方式能够以多种形式实施，且不应被理解为限于在此阐述的范例；相反，提供这些实施方式使得本公开将更加全面和完整，并将示例实施方式的构思全面地传达给本领域的技术人员。所描述的特征、结构或特性可以以任何合适的方式结合在一个或更多实施方式中。此外，附图仅为本公开的示意性图解，并非一定是按比例绘制。图中相同的附图标记表示相同或类似的部分，因而将省略对它们的重复描述。附图中所示的一些方框图是功能实体，不一定必须与物理或逻辑上独立的实体相对应。可以采用软件形式来实现这些功能实体，或在一个或多个硬件模块或集成电路中实现这些功能实体，或在不同网络和/或处理器装置和/或微控制器装置中实现这些功能实体。本申请提供的方案，通过获取能够分别反映出人脸的三维特征与二维特征之间的映射关系，以及人脸上的形状特征和外观特征的多项编码，基于多项编码信息进行网络模型的模型训练，并进一步基于网络模型输出的合成的多角度人脸图像和待重建人脸二维图像计算网络模型的模型损失，以进行反向传播，实现网络模型的参数的调整，通过模型的不断迭代更新，得到人脸三维构建模型，从而使生成的人脸三维构建模型在不需要借助硬件设备的情况下就能够实现对人脸二维图像进行三维重构，在降低方案实施成本的同时，保证了三维重构操作的实用性与可靠性。为了便于理解，下面首先对本申请涉及到的几个名词进行解释。全连接网络：又称为全连接神经网络，全连接神经网络训练分为前向传播、后向传播两个过程，前向传播数据沿输入到输出后计算损失函数值，后向传播则是一个优化过程，利用梯度下降法减小前向传播产生的损失函数值，从而优化、更新参数。VGG-16网络：是一种卷积神经网络，vgg16总共有16层，13个卷积层和3个全连接层，第一次经过64个卷积核的两次卷积后，采用一次pooling，第二次经过两次128个卷积核卷积后，再采用pooling，再重复两次三个512个卷积核卷积后，再pooling，最后经过三次全连接。ResNet网络：即残差网络，ResNet网络参考了VGG19网络，在其基础上进行了修改，并通过短路机制加入了残差单元，变化主要体现在ResNet直接使用stride＝2的卷积做下采样，并且用global average pool层替换了全连接层。Light-CNN网络：也可以称为浅光CNN，其引入了一个深度可分离的模块和剩余的网络模块，通过改变卷积方法来减少网络参数。图1示出本公开实施例中一种人脸三维构建模型的训练系统的结构示意图，包括多个终端120和服务器集群140。终端120可以是手机、游戏主机、平板电脑、电子书阅读器、智能眼镜、MP4播放器、智能家居设备、AR设备、VR设备等移动终端，或者，终端120也可以是个人计算机，比如膝上型便携计算机和台式计算机等等。其中，终端120中可以安装有用于提供模型训练的应用程序。终端120与服务器集群140之间通过通信网络相连。可选的，通信网络是有线网络或无线网络。服务器集群140是一台服务器，或者由若干台服务器组成，或者是一个虚拟化平台，或者是一个云计算服务中心。服务器集群140用于为提供人脸三维构建模型的训练的应用程序提供后台服务。可选地，服务器集群140承担主要计算工作，终端120承担次要计算工作；或者，服务器集群140承担次要计算工作，终端120承担主要计算工作；或者，终端120和服务器集群140之间采用分布式计算架构进行协同计算。在一些可选的实施例中，服务器集群140用于存储人脸三维构建模型的训练程序等。可选地，不同的终端120中安装的应用程序的客户端是相同的，或两个终端120上安装的应用程序的客户端是不同控制系统平台的同一类型应用程序的客户端。基于终端平台的不同，该应用程序的客户端的具体形态也可以不同，比如，该应用程序客户端可以是手机客户端、PC客户端或者全球广域网客户端等。本领域技术人员可以知晓，上述终端120的数量可以更多或更少。比如上述终端可以仅为一个，或者上述终端为几十个或几百个，或者更多数量。本申请实施例对终端的数量和设备类型不加以限定。可选的，该系统还可以包括管理设备，该管理设备与服务器集群140之间通过通信网络相连。可选的，通信网络是有线网络或无线网络。可选的，上述的无线网络或有线网络使用标准通信技术和/或协议。网络通常为因特网、但也可以是任何网络，包括但不限于局域网、城域网、广域网、移动、有线或者无线网络、专用网络或者虚拟专用网络的任何组合)。在一些实施例中，使用包括超文本标记语言、可扩展标记语言等的技术和/或格式来代表通过网络交换的数据。此外还可以使用诸如安全套接字层、传输层安全、虚拟专用网络、网际协议安全等常规加密技术来加密所有或者一些链路。在另一些实施例中，还可以使用定制和/或专用数据通信技术取代或者补充上述数据通信技术。下面，将结合附图及实施例对本示例实施方式中的人脸三维构建模型的训练方法的各个步骤进行更详细的说明。如图2所示，根据本公开的一个实施例的人脸三维构建模型的训练方法，包括：步骤S202，获取多项编码信息，多项编码信息包括基于图像采集设备获取到的光线的方向编码和采样编码，以及采集到的人脸形状编码和人脸外观编码。其中，采样编码具体可以包括基于图像采集设备采集到的光线上的采样点的颜色值和不透明度。另外，人脸形状编码具体为反映人脸五官的形状以及人脸轮廓形状的编码，人脸外观编码具体为反映人脸肤色、人脸风格等特征的编码。步骤S204，基于多项编码信息进行网络模型的模型训练，并使网络模型输出多角度人脸训练特征。其中，由于多项编码能够分别反映出人脸的三维特征与二维特征之间的映射关系，以及人脸上的形状特征和外观特征，通过基于多项编码信息进行网络模型的模型训练，能够对上述特征和映射关系进行机器学习，以使生成的人脸三维构建模型能够实现对人脸二维图像进行三维的重构。步骤S206，基于多角度人脸训练特征和待重建人脸二维图像计算网络模型的模型损失。其中，基于网络模型输出的多角度人脸图像和输入的待重建人脸二维图像进行模型损失的计算，以确定模型的预测值和真实值之间的差距。步骤S208，将模型损失输入网络模型进行反向传播，以迭代更新网络模型的模型参数，直至网络模型收敛，得到人脸三维构建模型。其中，反向传播指利用模型损失，对网络模型中的参数进行调整，以降低模型损失，通过不断迭代，使网络模型达到收敛状态时，即可确定训练完毕，生成的人脸三维构建模型即可将待重建人脸二维图像重建为三维人脸结构。在该实施例中，通过获取能够分别反映出人脸的三维特征与二维特征之间的映射关系，以及人脸上的形状特征和外观特征的多项编码，基于多项编码信息进行网络模型的模型训练，并进一步基于网络模型输出的合成的多角度人脸图像和待重建人脸二维图像计算网络模型的模型损失，以进行反向传播，实现网络模型的参数的调整，通过模型的不断迭代更新，得到人脸三维构建模型，从而使生成的人脸三维构建模型在不需要借助硬件设备的情况下就能够实现对人脸二维图像进行三维重构，在降低方案实施成本的同时，保证了三维重构操作的实用性与可靠性。如图3所示，在一个实施例中，步骤S202中，获取多项编码信息的一种实现方式，包括：步骤S302，获取图像采集设备的位姿信息。其中，由于位姿通常以三维空间中的欧式变换来表示，因此能够基于位置信息获取对应的三维立体数据。步骤S304，基于光线投射算法对位姿信息进行体绘制处理，生成图像采集设备基于位姿信息采集到的光线的方向编码和采样编码。其中，光线投射算法可以理解为从图像采集设备的屏幕上的每个像素点出发，沿着视线方向发射出一条光线，当光线穿过立体时，沿着光线方向等距离采样，利用插值计算出采样点的颜色值和不透明度，接着按照从前到后或从后到前的顺序对光线上的采样点进行合成，计算出该光线对应的屏幕上像素点的颜色值，得到采样编码，视线方向即为方向编码。步骤S306，基于对标准高斯分布进行随机采样获取人脸形状编码和人脸外观编码，以结合方向编码和采样编码得到多项编码信息。在该实施例中，通过使用光线投射算法，将采集到的表征三维立体的数据基于光线方向映射为颜色和不透明度，以得到光线对应的二维屏幕上的像素点的颜色，具体到人像上，即为人脸图像上的像素点的颜色，结合人脸形状编码和人脸外观编码，能够保证网络模型训练的可靠性。如图4所示，在一个实施例中，网络模型包括第一网络和第二网络，基于多项编码信息进行网络模型的模型训练包括：步骤S402，基于多项编码信息进行第一网络的训练，得到生成式神经特征场模块，生成式神经特征场模块用于基于多项编码信息生成场景图像，并输出场景图像的张量信息，张量信息包括体素密度张量和特征张量。其中，第一网络基于全连接网络构建。具体地，张量是机器学习程序中的数字容器，本质上就是各种不同维度的数组。体素则包括像素、体积和元素等。特征张量，即图像特征张量，可以理解为由宽度、高度和颜色深度表征的图像特征。通过构建生成式神经特征场模块，能够将人像场景表示为合成生成神经特征场，以从背景中分离出一个或多个人脸特征对象以及单个特征对象的形状和外观，同时从非结构化和未定位的图像集合中学习，而无需任何额外的监督，以使生成的张量信息从不同的角度表征人脸图像。步骤S404，基于张量信息进行第二网络的训练，得到神经渲染模块，神经渲染模块用于将体素密度张量和特征张量映射上采样到合成的多角度人脸图像，以将多角度人脸图像和特征张量确定为多角度人脸训练特征。其中，第二网络基于全连接网络构建。具体地，上采样指将低分辨率的特征通过卷积核过滤，产生高分辨率的特征映射，以基于神经渲染模块得到高分辨率的多角度的人脸合成的图像。在该实施例中，通过构建生成式神经特征场模块，能够输出从不同角度展示人脸特征的张量信息，通过构建神经渲染模块，则可以学习人脸图像的隐式三维结构，结合生成式神经特征场模块和神经渲染模块，实现了基于人脸场景图像的快速且逼真的合成多角度人脸图像。如图5所示，在一个实施例中，基于多角度人脸训练特征和待重建人脸二维图像计算网络模型的模型损失包括：步骤S502，将多角度人脸图像和待重建人脸二维图像输入鉴别器，以基于鉴别器对多角度人脸图像和待重建人脸二维图像进行判别，基于判别结果得到第一损失值。其中，基于VGG-16网络和/或ResNet网络构建鉴别器。具体地，鉴别器可以包括卷积层、全连接层和密集连接层，对于每张多角度人脸图像，通过鉴别器得到判别信息，再将对应的真实图像通过鉴别器得到判别信息，将判别信息融入损失函数进行统一计算，得到第一损失值。步骤S504，基于第一编码器对特征张量进行编码，生成第一特征图。其中，基于VGG-16网络和/或ResNet网络构建第一编码器。步骤S506，基于第二编码器对待重建人脸二维图像进行特征提取，生成第二特征图，以基于第二特征图对待重建人脸二维图像的身份信息进行约束。其中，基于人脸数据集对网络VGG-16和/或Light-CNN网络进行预训练，得到第二编码器。具体地，通过构建第一编码器和第二编码器，编码器具有多个隐藏层的神经网络，而每个层都可以在不同的抽象级别学习特性，在保证对图像特征进行可靠提取的同时，能够对过程中的特征图进行约束，针对第二编码器，能够实习对待重建人脸二维图像的身份信息的保持。步骤S508，度量第一特征图和第二特征图之间的损失，得到第二损失值。步骤S510，基于第一损失值和第二损失值得到网络模型的模型损失。在该实施例中，通过构建鉴别器、第一编码器和第二编码器，以由鉴别器对神经渲染模块合成的多角度人脸图像基于真实的待重建人脸二维图像进行真实性的鉴别，基于鉴别结果得到第一损失值，由第一编码器和第二编码器基于各自提取的图像特征进行度量，基于度量结果得到第二损失值，结合第一损失值和第二损失值作为网络训练模型的模型损失，能够保证训练生成的人脸三维构建模型重建的三维人脸结构的真实性。另外，基于第二编码器对待重建人脸二维图像的图像特征进行提取，结合第二损失值的计算，能够实现模型训练过程中对待重建人脸二维图像的特征图的约束，从而能够使重建的三维人脸结构也能够保持原始人脸二维图像的身份信息，在提升三维人脸结构的重建精度的同时，也能够使重建后的三维人脸结构用于身份验证，以进一步提升其实用性。在一个实施例中，基于比较结果得到第一损失值包括：将判别结果输入GAN损失函数，并输出第一损失值。在该实施例中，基于GAN损失函数输出第一损失值，第一损失值用于表征多角度人脸图像相对真实的待重建人脸二维图像的真实度，从而能够通过第一损失值优化网络模型的模型参数，以提升构建的三维人脸结构与真实人脸二维图像的相似度。在一个实施例中，对第一特征图和第二特征图进行损失度量，得到第二损失值包括：基于均方损失函数对第一特征图和第二特征图进行损失度量，得到第二损失值，均方损失函数的公式如公式所示：loss＝2其中，loss、x和y的维度相同，i是下标，x指第一特征图向量，y指第二特征图向量。在该实施例中，通过采样均方损失函数计算第二损失值，能够在计算过程中保持身份信息的完整性。在一个实施例中，还包括：将待重建人脸二维图像输入人脸三维构建模型，以由人脸三维构建模型中的神经渲染模块学习待重建人脸二维图像的隐式三维结构输出，并输出对应的三维人脸结构。如图6所示，根据本公开的一种人脸三维构建模型的训练，包括：光线投射计算模块602、生成式神经特征场模块604、神经渲染模块606、第一编码器608、第二编码器610和鉴别器612。光线投射计算模块602的输入为相机，即图像采集设备的位姿p，通过计算相机位姿信息p，获得光线方向编码d，之后使用3D点采样生成光线的采样编码x，用于作为生成式神经特征场模块604的输入。光线投射算法是一种基于图像序列的直接体绘制算法，也可称为Ray Casting算法。生成式神经特征场模块604用于对多项输入信息进行计算处理，生成由人像体和背景组成的场景图像，用于后续的渲染操作，其输入是光线投射计算模块生成的采样编码x、方向编码d及外部输入的人脸形状编码Zs和人脸外观编码Za，输出是场景图像的体素密度张量c以及特征张量f。生成式神经特征场模块604可由全连接网络结构构建。神经渲染模块606用于将生成式神经特征场生成的低分辨率的特征映射上采样到高分辨率的RGB图像，用于后续处理，其输入是生成式神经特征场生成的体素密度张量c以及特征张量f，输出是合成的RGB多角度人脸图像。神经渲染模块606可由全连接网络结构构建。第一编码器608用于对输入的特征张量f进行编码，即编码过程，其输入为特征张量f，输出为第一特征图。第一编码器608可由VGG-16、ResNet等网络结构构建。第二编码器610用于对输入的真实人脸图像进行特征图提取，其输入为外部设备输入的待重建真实人脸图像，输出为第二特征图，该第二编码器已经过预训练，不参与模型训练。第二编码器610可由VGG-face、LightCNN等在人脸数据集上经过预训练的模型构建。鉴别器612用于对输出的多角度人脸图像与真实人脸图像进行比较，度量其损失值，计算梯度反向传播进而迭代更新网络的参数，即模型训练过程，其输入为神经渲染模块生成的多角度人脸图像以及外部输入的真实人脸图像，输出为损失值。鉴别器612可由VGG-16、ResNet等网络结构构建。如图7所示，根据本公开的另一个实施例的人脸三维构建模型的训练方法，包括：步骤S702，构建光线投射计算模块。其中，可以基于图像序列的直接体绘制算法构建光线投射计算模块。步骤S704，将图像采集装置的位姿信息输入到光线投射计算模块。步骤S706，由光线投射计算模块输出光线的方向编码和采样编码。步骤S708，获取人脸形状编码和人脸外观编码。其中，通过在标准高斯分布上随机采样得到人脸形状编码Zs以及人脸外观编码Za。步骤S710，构建生成式神经特征场模块。步骤S712，将方向编码、采样编码、人脸形状编码和人脸外观编码输入生成式神经特征场模块。步骤S714，由生成式神经特征场模块输出素体密度张量和特征张量。步骤S716，构建神经渲染模块。步骤S718，将素体密度张量和特征张量输入神经渲染模块。步骤S720，由神经渲染模块渲染输出多角度人脸图像。步骤S722，构建鉴别器。步骤S724，将多角度人脸图像待重建人脸二维图像输入鉴别器，由鉴别器对多角度人脸图像和待重建人脸二维图像进行判别，得到第一损失值。步骤S726，构建第一编码器。步骤S728，将特征张量输入第一编码器输出第一特征图。步骤S730，构建第二编码器。步骤S732，将待重建人脸二维图像输入第二编码器输出第二特征图。步骤S734，度量第一特征图和第二特征图之间的损失，得到第二损失值。步骤S736，基于第一损失值和第二损失值进行反向传播，以迭代更新模型参数，直至模型收敛，得到人脸三维构建模型。模型于训练结束后，其神经渲染模块将学习到输入人脸图像中的隐式三维结构，将其学习到的隐式三维结构输出，即得到输入人脸图像对应的三维人脸结构。下面参照图8来描述根据本发明的这种实施方式的一种人脸三维构建模型的训练装置800。图8所示的人脸三维构建模型的训练装置800仅仅是一个示例，不应对本发明实施例的功能和使用范围带来任何限制。人脸三维构建模型的训练装置800以硬件模块的形式表现。人脸三维构建模型的训练装置800的组件可以包括但不限于：获取模块802，用于获取多项编码信息，多项编码信息包括基于图像采集设备获取到的光线的方向编码和采样编码，以及采集到的人脸形状编码和人脸外观编码；模型训练模块804，用于基于多项编码信息进行网络模型的模型训练，并使网络模型输出多角度人脸训练特征；计算模块806，用于基于多角度人脸训练特征和待重建人脸二维图像计算网络模型的模型损失；迭代更新模块808，用于将模型损失输入网络模型进行反向传播，以迭代更新网络模型的模型参数，直至网络模型收敛，得到人脸三维构建模型。在一个实施例中，获取模块802具体用于：获取图像采集设备的位姿信息；基于光线投射算法对位姿信息进行体绘制处理，生成图像采集设备基于位姿信息采集到的光线的方向编码和采样编码；基于对标准高斯分布进行随机采样获取人脸形状编码和人脸外观编码，以结合方向编码和采样编码得到多项编码信息。在一个实施例中，网络模型包括第一网络和第二网络，模型训练模块804具体用于：基于多项编码信息进行第一网络的训练，得到生成式神经特征场模块，生成式神经特征场模块用于基于多项编码信息生成场景图像，并输出场景图像的张量信息，张量信息包括体素密度张量和特征张量；基于张量信息进行第二网络的训练，得到神经渲染模块，神经渲染模块用于将体素密度张量和特征张量映射上采样到多角度人脸图像。在一个实施例中，计算模块806具体用于：将多角度人脸图像和待重建人脸二维图像输入鉴别器，以基于鉴别器对多角度人脸图像和待重建人脸二维图像进行判别，基于判别结果得到第一损失值；基于第一编码器对特征张量进行编码，生成第一特征图；基于第二编码器对待重建人脸二维图像进行特征提取，生成第二特征图，以基于第二特征图对待重建人脸二维图像的身份信息进行约束；度量第一特征图和第二特征图之间的损失，得到第二损失值；基于第一损失值和第二损失值得到网络模型的模型损失。在一个实施例中，还包括：重构模块810，用于将待重建人脸二维图像输入人脸三维构建模型，以由人脸三维构建模型中的神经渲染模块学习待重建人脸二维图像的隐式三维结构输出，并输出对应的三维人脸结构。如图9所示，电子设备900以通用计算设备的形式表现。电子设备900的组件可以包括但不限于：上述至少一个处理单元910、上述至少一个存储单元920、连接不同系统组件的总线930。其中，所述存储单元存储有程序代码，所述程序代码可以被所述处理单元910执行，使得所述处理单元910执行本说明书上述“示例性方法”部分中描述的根据本发明各种示例性实施方式的步骤。例如，所述处理单元910可以执行如图2中所示的步骤S202与步骤S208所描述的方案。存储单元920可以包括易失性存储单元形式的可读介质，例如随机存取存储单元9201和/或高速缓存存储单元9202，还可以进一步包括只读存储单元9203。存储单元920还可以包括具有一组程序模块9205的程序/实用工具9204，这样的程序模块9205包括但不限于：操作系统、一个或者多个应用程序、其它程序模块以及程序数据，这些示例中的每一个或某种组合中可能包括网络环境的实现。总线930可以为表示几类总线结构中的一种或多种，包括存储单元总线或者存储单元控制器、外围总线、图形加速端口、处理单元或者使用多种总线结构中的任意总线结构的局域总线。电子设备900也可以与一个或多个外部设备960通信，还可与一个或者多个使得用户能与该电子设备900交互的设备通信，和/或与使得该电子设备900能与一个或多个其它计算设备进行通信的任何设备通信。这种通信可以通过输入/输出接口940进行。并且，电子设备900还可以通过网络适配器950与一个或者多个网络，广域网和/或公共网络，例如因特网)通信。如图所示，网络适配器950通过总线930与电子设备900的其它模块通信。应当明白，尽管图中未示出，可以结合电子设备900使用其它硬件和/或软件模块，包括但不限于：微代码、设备驱动器、冗余处理单元、外部磁盘驱动阵列、RAID系统、磁带驱动器以及数据备份存储系统等。通过以上的实施方式的描述，本领域的技术人员易于理解，这里描述的示例实施方式可以通过软件实现，也可以通过软件结合必要的硬件的方式来实现。因此，根据本公开实施方式的技术方案可以以软件产品的形式体现出来，该软件产品可以存储在一个非易失性存储介质中或网络上，包括若干指令以使得一台计算设备执行根据本公开实施方式的方法。在本公开的示例性实施例中，还提供了一种计算机可读存储介质，其上存储有能够实现本说明书上述方法的程序产品。在一些可能的实施方式中，本发明的各个方面还可以实现为一种程序产品的形式，其包括程序代码，当所述程序产品在终端设备上运行时，所述程序代码用于使所述终端设备执行本说明书上述“示例性方法”部分中描述的根据本发明各种示例性实施方式的步骤。根据本发明的实施方式的用于实现上述方法的程序产品，其可以采用便携式紧凑盘只读存储器并包括程序代码，并可以在终端设备，例如个人电脑上运行。然而，本发明的程序产品不限于此，在本文件中，可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。所述程序产品可以采用一个或多个可读介质的任意组合。可读介质可以是可读信号介质或者可读存储介质。可读存储介质例如可以为但不限于电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。计算机可读信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了可读程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。可读信号介质还可以是可读存储介质以外的任何可读介质，该可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于无线、有线、光缆、RF等等，或者上述的任意合适的组合。可以以一种或多种程序设计语言的任意组合来编写用于执行本发明操作的程序代码，所述程序设计语言包括面向对象的程序设计语言—诸如Java、C++等，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、作为一个独立的软件包执行、部分在用户计算设备上部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。在涉及远程计算设备的情形中，远程计算设备可以通过任意种类的网络，包括局域网或广域网，连接到用户计算设备，或者，可以连接到外部计算设备。应当注意，尽管在上文详细描述中提及了用于动作执行的设备的若干模块或者单元，但是这种划分并非强制性的。实际上，根据本公开的实施方式，上文描述的两个或更多模块或者单元的特征和功能可以在一个模块或者单元中具体化。反之，上文描述的一个模块或者单元的特征和功能可以进一步划分为由多个模块或者单元来具体化。此外，尽管在附图中以特定顺序描述了本公开中方法的各个步骤，但是，这并非要求或者暗示必须按照该特定顺序来执行这些步骤，或是必须执行全部所示的步骤才能实现期望的结果。附加的或备选的，可以省略某些步骤，将多个步骤合并为一个步骤执行，以及/或者将一个步骤分解为多个步骤执行等。通过以上的实施方式的描述，本领域的技术人员易于理解，这里描述的示例实施方式可以通过软件实现，也可以通过软件结合必要的硬件的方式来实现。因此，根据本公开实施方式的技术方案可以以软件产品的形式体现出来，该软件产品可以存储在一个非易失性存储介质中或网络上，包括若干指令以使得一台计算设备执行根据本公开实施方式的方法。本领域技术人员在考虑说明书及实践这里公开的发明后，将容易想到本公开的其它实施方案。本申请旨在涵盖本公开的任何变型、用途或者适应性变化，这些变型、用途或者适应性变化遵循本公开的一般性原理并包括本公开未公开的本技术领域中的公知常识或惯用技术手段。说明书和实施例仅被视为示例性的，本公开的真正范围和精神由所附的权利要求指出。
