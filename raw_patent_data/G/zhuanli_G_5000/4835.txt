标题title
一种GNSS基带捕获方法
摘要abst
本申请涉及卫星导航技术领域，公开了一种GNSS基带捕获方法，包括：基于捕获引擎对基带信号进行初次捕获，获得第一捕获集合；基于捕获引擎在第一捕获集合限定的搜索区域内进行二次捕获，获得第二捕获集合；基于码相位计算方法计算第一捕获集合中各第一峰值在二次捕获时的码相位计算值，获得码相位结果集合；基于偏差计算方法计算码相位结果集合中的码相位值与第二捕获集合中的第二码相位搜索值的偏差值，获得偏差结果集合；若偏差结果集合中存在小于预设阈值的偏差值，则将偏差值对应的第一峰值作为捕获结果。本申请解决了在现有GNSS基带捕获方法在弱信号捕获过程中，存在捕获时间长、捕获效果差的问题。
权利要求书clms
1.一种GNSS基带捕获方法，其特征在于，包括：基于捕获引擎对基带信号进行初次捕获，获得第一捕获集合，所述第一捕获集合包括若干第一峰值，所述第一峰值包括对应的第一多普勒搜索值和第一码相位搜索值；基于捕获引擎在所述第一捕获集合限定的搜索区域内进行二次捕获，获得第二捕获集合，所述第二捕获集合包括若干第二峰值，所述第二峰值包括对应的第二多普勒搜索值和第二码相位搜索值；基于码相位计算方法计算所述第一捕获集合中各第一峰值在二次捕获时的码相位计算值，获得码相位结果集合；基于偏差计算方法计算所述码相位结果集合中的码相位值与所述第二捕获集合中的第二码相位搜索值的偏差值，获得偏差结果集合；若所述偏差结果集合中存在小于预设阈值的偏差值，则将所述偏差值对应的第一峰值作为捕获结果。2.根据权利要求1所述的一种GNSS基带捕获方法，其特征在于：若所述偏差结果集合中不存在小于预设阈值的偏差值，则再次转至基于捕获引擎在所述第一捕获集合限定的搜索区域内进行二次捕获的步骤。3.根据权利要求2所述的一种GNSS基带捕获方法，其特征在于：若再次进行二次捕获后，所述偏差结果集合中仍不存在小于预设阈值的偏差值，则对所述捕获引擎重置，并转至基于捕获引擎对基带信号进行初次捕获的步骤。4.根据权利要求1所述的一种GNSS基带捕获方法，其特征在于，所述码相位计算方法的具体公式为：其中，表示第i个峰值在第n次捕获时的码相位值，表示第i个峰值在第n - 1次捕获时的码相位值，mod表示获取A除以B的余数，表示第i个峰值在第n - 1次捕获时的多普勒值，表示信号载波频率，表示信号半码片速率，表示第n次捕获与第n - 1次捕获的间隔时间，CodePeriod表示信号扩频码长度。5.根据权利要求1所述的一种GNSS基带捕获方法，其特征在于，所述偏差计算方法的具体公式为：其中,de表示偏差值，abs表示获取a减去b的绝对值，codephase_search表示第j个峰值在第n次捕获时的码相位值，表示第i个峰值在第n次捕获时的码相位值。6.根据权利要求1所述的一种GNSS基带捕获方法，其特征在于，获得第一捕获集合之后，还包括：将所述第一捕获集合中的第一峰值按照峰值大小从大到小进行排序。7.根据权利要求5所述的一种GNSS基带捕获方法，其特征在于，在基于捕获引擎在所述第一捕获集合限定的搜索区域内进行二次捕获之前，还包括：筛选所述第一捕获集合中前N个第一峰值作为所述二次捕获的搜索区域。8.根据权利要求1所述的一种GNSS基带捕获方法，其特征在于：所述初次捕获与所述二次捕获基于预设门限进行峰值捕获判定。
说明书desc
技术领域本申请涉及卫星导航技术领域，具体是指一种GNSS基带捕获方法。背景技术GNSS指全球导航卫星系统，全球导航卫星系统是能在地球表面或近地空间的任何地点为用户提供全天候的3维坐标和速度以及时间信息的空基无线电导航定位系统。目前主要的全球导航卫星系统有GPS、GLONASS、GALILEO和我国的北斗卫星导航系统。在卫星导航技术领域，对于卫星信号的处理一般都是首先对信号结构进行分析、捕获并跟踪，最后得到导航电文。在弱信号捕获时，由于捕获门限难以设定，不合适的门限将导致发现概率大大降低。而且在捕获结果中，正确的搜索位置的峰值很有可能并不是最高的，比如可能是第10个峰值甚至第30个峰值。由此导致在现有的一种GNSS基带捕获方法在弱信号捕获过程中，存在捕获时间长、捕获效果差的问题。发明内容基于以上技术问题，本申请提供了一种GNSS基带捕获方法，解决了在现有GNSS基带捕获方法在弱信号捕获过程中，存在捕获时间长、捕获效果差的问题。为解决以上技术问题，本申请采用的技术方案如下：一种GNSS基带捕获方法，包括：基于捕获引擎对基带信号进行初次捕获，获得第一捕获集合，第一捕获集合包括若干第一峰值，第一峰值包括对应的第一多普勒搜索值和第一码相位搜索值；基于捕获引擎在第一捕获集合限定的搜索区域内进行二次捕获，获得第二捕获集合，第二捕获集合包括若干第二峰值，第二峰值包括对应的第二多普勒搜索值和第二码相位搜索值；基于码相位计算方法计算第一捕获集合中各第一峰值在二次捕获时的码相位计算值，获得码相位结果集合；基于偏差计算方法计算码相位结果集合中的码相位值与第二捕获集合中的第二码相位搜索值的偏差值，获得偏差结果集合；若偏差结果集合中存在小于预设阈值的偏差值，则将偏差值对应的第一峰值作为捕获结果。进一步的，若偏差结果集合中不存在小于预设阈值的偏差值，则再次转至基于捕获引擎在第一捕获集合限定的搜索区域内进行二次捕获的步骤。进一步的，若再次进行二次捕获后，偏差结果集合中仍不存在小于预设阈值的偏差值，则对捕获引擎重置，并转至基于捕获引擎对基带信号进行初次捕获的步骤。进一步的，码相位计算方法的具体公式为：其中，表示第i个峰值在第n次捕获时的码相位值，表示第i个峰值在第n - 1次捕获时的码相位值，mod表示获取A除以B的余数，表示第i个峰值在第n - 1次捕获时的多普勒值，表示信号载波频率，表示信号半码片速率，表示第n次捕获与第n - 1次捕获的间隔时间，CodePeriod表示信号扩频码长度。进一步的，偏差计算方法的具体公式为：其中，de表示偏差值，abs表示获取a减去b的绝对值，codephase_search表示第j个峰值在第n次捕获时的码相位值，表示第i个峰值在第n次捕获时的码相位值。进一步的，获得第一捕获集合之后，还包括将第一捕获集合中的第一峰值按照峰值大小从大到小进行排序。进一步的，在基于捕获引擎在第一捕获集合限定的搜索区域内进行二次捕获之前，还包括筛选第一捕获集合中前N个第一峰值作为二次捕获的搜索区域。进一步的，初次捕获与二次捕获基于预设门限进行峰值捕获判定。与现有技术相比，本申请的有益效果是：本申请克服了现有GNSS基带捕获过程中依靠门限判决存在的问题，当正确的捕获峰值藏匿于多个峰值之中时，仍能通过多轮捕获找出正确峰值，得到搜索卫星正确的多普勒和码相位。以此本申请通过对弱信号进行多轮捕获，可以提高弱信号的捕获发现概率，并有效缩短捕获时间。附图说明此处所说明的附图用来提供对本申请的进一步理解，构成本申请的一部分，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。其中：图1为GNSS基带捕获方法的流程示意图。具体实施方式为使本公开实施例的目的、技术方案和优点更加清楚，下面将结合本公开实施例的附图，对本公开实施例的技术方案进行清楚、完整地描述。显然，所描述的实施例是本公开的一部分实施例，而不是全部的实施例。基于所描述的本公开的实施例，本领域普通技术人员在无需创造性劳动的前提下所获得的所有其他实施例，都属于本公开保护的范围。应当理解，本说明书中所使用的“系统”、“装置”、“单元”和/或“模组”是用于区分不同级别的不同组件、元件、部件、部分或装配的一种方法。然而，如果其他词语可实现相同的目的，则可通过其他表达来替换所述词语。如本说明书和权利要求书中所示，除非上下文明确提示例外情形，“一”、“一个”、“一种”和/或“该”等词并非特指单数，也可包括复数。一般说来，术语“包括”与“包含”仅提示包括已明确标识的步骤和元素，而这些步骤和元素不构成一个排它性的罗列，方法或者设备也可能包含其它的步骤或元素。本说明书中使用了流程图用来说明根据本说明书的实施例的系统所执行的操作。应当理解的是，前面或后面操作不一定按照顺序来精确地执行。相反，可以按照倒序或同时处理各个步骤。同时，也可以将其他操作添加到这些过程中，或从这些过程移除某一步或数步操作。参阅图1，在一些实施例中，一种GNSS基带捕获方法，包括：S101，基于捕获引擎对基带信号进行初次捕获，获得第一捕获集合，第一捕获集合包括若干第一峰值，第一峰值包括对应的第一多普勒搜索值和第一码相位搜索值；优选的，获得第一捕获集合之后，还包括将第一捕获集合中的第一峰值按照峰值大小从大到小进行排序。其中，由于捕获时通过门限进行判定，峰值越大则越有可能为正确的捕获结果，因此，将其按峰值大小进行排序，可以更快地找出正确的峰值。具体的，初次捕获基于预设门限进行峰值捕获判定。其中，由于在弱信号时，正确码相位的峰值也很可能不是十分明显，甚至正确码相位的峰值还不一定是最高峰值，比如峰值按从高到底排序，第10个峰值是正确码相位，那这样只要确保第10个峰值超过门限就行了，所以门限的选择可以适当放宽，比如把第50个峰值作为门限，这样可以选入49个峰值最为第一捕获集合，这样门限就很容易确定了。具体的，本申请可以适用于多种捕获引擎，具体包括匹配滤波器方案、FFT方案、短时匹配滤波器加FFT等方案。具体的，本申请可以适用于多种基带信号，具体包括北斗B1I信号、GPS L1C/A信号等基带信号。S102，基于捕获引擎在第一捕获集合限定的搜索区域内进行二次捕获，获得第二捕获集合，第二捕获集合包括若干第二峰值，第二峰值包括对应的第二多普勒搜索值和第二码相位搜索值；优选的，在基于捕获引擎在第一捕获集合限定的搜索区域内进行二次捕获之前，还包括筛选第一捕获集合中前N个第一峰值作为二次捕获的搜索区域。其中，例如捕获引擎采用匹配滤波器，并以GPS L1C/A信号为例，假设能得到2046组捕获结果，如果搜索了200个频点，这样得到2046*200个捕获结果，如果初次捕获时还进行了比特对齐操作，那实际上捕获结果共计2046*200*20个。而把初次捕获的捕获结果从高到底排序后，设定N为30，即选取第一捕获集合中最大的30个峰值用作二次捕获。这样在二次捕获时，基于这30个峰值对应的多普勒频点进行第二次捕获，这样第二次捕获搜索频点就少了很多，可以大大节省了第二次捕获的时间。具体的，二次捕获基于预设门限进行峰值捕获判定。其中，初次捕获与二次捕获的预设门限是一致。S103，基于码相位计算方法计算第一捕获集合中各第一峰值在二次捕获时的码相位计算值，获得码相位结果集合；优选的，码相位计算方法的具体公式为：其中，表示第i个峰值在第n次捕获时的码相位值，表示第i个峰值在第n - 1次捕获时的码相位值，mod表示获取A除以B的余数，表示第i个峰值在第n - 1次捕获时的多普勒值，表示信号载波频率，表示信号半码片速率，表示第n次捕获与第n - 1次捕获的间隔时间，CodePeriod表示信号扩频码长度。具体的，，其中，表示第n次捕获开始的时刻，表示第n - 1次捕获开始的时刻。具体的，捕获开始时刻是指基带信号的第一个数据进入捕获引擎的时刻，其是由GNSS接收机射频ADC提供的采样时钟驱动并记录。具体的，对于信号扩频码长度，以GPS L1C/A信号为例，其扩频码码长为1023，如果捕获精度为半码片精度，则该值为2046。其中，由现有技术已知载波多普勒公式为，码多普勒公式为。其中，表示多普勒值，c表示光速，v表示接收机和卫星的相对速度，表示信号载波频率，表示扩频码频率。具体的，以BDS B1I信号为例，其，，半码片速率为。结合载波多普勒公式和码多普勒公式，则可以将码多普勒公式转换为：此外，已知，表示峰值在第n次捕获时的码相位值, mod表示获取A除以B的余数，表示峰值在第n - 1次捕获时的码相位值，表示第n次捕获与第n - 1次捕获的间隔时间。由于捕获的码相位范围一般在一个扩频码周期之内，以BDS B1I信号为例，扩频码周期为2046，若按照半码片精度进行捕获，扩频码周期为4092，可以将的获取公式转换为：具体的，捕获不同基带信号时，CodePeriod的可能取值参数参阅表1所示。具体的，下表为表1，表示在不同基带信号下， CodePeriod的取值参数。可以利用码相位计算公式进行捕获结果的判决，假设第一次捕获时取出的前N个峰值中，第i个峰值对应的捕获结果是正确的，那么根据两次捕获的时间差，可以计算出第二次捕获时正确的码相位值。为描述具体过程，将上述公式变更为针对第i个峰值的情况，即加上上标i表示第i个峰值对应的参数，为第i个峰值对应的多普勒值，具体为：即若第一次捕获时，第i个第一峰值位置是正确值时，由上述公式计算的码相位值则应该是第二次捕获的正确峰值的搜索结果。S104，基于偏差计算方法计算码相位结果集合中的码相位值与第二捕获集合中的第二码相位搜索值的偏差值，获得偏差结果集合；优选的，偏差计算方法的具体公式为：其中，de表示偏差值，abs表示获取a减去b的绝对值，codephase_search表示第j个峰值在第n次捕获时的码相位值，表示第i个峰值在第n次捕获时的码相位计算值。在第二次捕获时，针对第一次的第i个峰值的捕获结果，设定捕获引擎，捕获引擎的搜索频点跟保持一致，相干累加时间和非相干累加次数也跟第一次捕获保持一致。若此时捕获引擎给出的前P个峰值，每个峰值对应一个码相位结果，计为codephase_search，其中j的范围为1至P。S105，若偏差结果集合中存在小于预设阈值的偏差值，则将偏差值对应的第一峰值作为捕获结果。具体的，若存在de ＜ th，则认为找到正确的峰值。其中，th表示预设阈值，具体为多普勒不准确或采样率不准确导致的偏差阈值，一般取值不超过2。在本实施例中，基于实验可知，在GNSS基带捕获时，要么没有一个峰值满足条件，宣告捕获失败，要么一般只有一个峰值满足条件。因此，在峰值中只存在一个正确峰值或不存在正确峰值的情况下，本申请通过两次捕获的码相位偏差计算，筛选出正确的捕获结果。克服了门限判决存在的问题，当正确的捕获峰值藏匿于多个峰值之中时，仍能通过多轮捕获找出正确峰值，得到搜索卫星正确的多普勒和码相位。以此本申请通过对弱信号进行多轮捕获，可以提高捕获发现概率，并有效缩短捕获时间。当然，由于误捕情况和虚警情况的存在，当然也有会存在两三个峰值也满足条件的情况，这种情况属于是因为采样率偏差造成的，也就是误捕，但别的捕获方法一般来说也难以避免误捕。遇到误捕情况，可以重置捕获引擎，重新进行初次捕获。优选的，若偏差结果集合中不存在小于预设阈值的偏差值，则再次转至基于捕获引擎在第一捕获集合限定的搜索区域内进行二次捕获的步骤。其中，当信号很弱时，如果正确的峰值并未出现在第二次捕获出现的前P个峰值时，第二次捕获失败的概率非常高。此时需要再次开启二次捕获，即第三次捕获。第三次捕获与第二次相同，针对第一次捕获的N个第一峰值对应的多普勒搜索值和码相位搜索值，计算在第三次捕获可能出现峰值的位置，仅在这些区域进行搜索。当信号很弱时，发现概率很低，假设在某个信号强度下，发现概率只有20%，即每次捕获只有20%的可能性找到正确峰值，现在的方法是第二次、第三次捕获时只要有一次正确峰值能被选入前P个最大峰值序列中，就可以捕获成功，这样仅从发现概率上，可提高至。优选的，若再次进行二次捕获后，偏差结果集合中仍不存在小于预设阈值的偏差值，则对捕获引擎重置，并转至基于捕获引擎对基带信号进行初次捕获的步骤。其中，若再次进行二次捕获后还不能捕获到信号，则捕获引擎重置，重新开始进行捕获。以匹配滤波器为例，捕获时需要的搜索时间为，其中，表示相干累加时间，表示非相干累加次数，20为比特边沿的搜索次数。则三次捕获时间如表2所示。具体的，下表为表2，表示三次捕获中每次捕获需要花费的时间。因此，本实施例中的GNSS基带捕获方法一方面能缩短捕获时间，另一方面可提高捕获灵敏度。综合上述实施例，以匹配滤波器作为捕获引擎为例对本申请的GNSS基带捕获方法进行进一步说明，具体内容如下：首先，对于捕获引擎，由现有技术可知，其可以进行搜索频点、相干累加时间和非相干累加次数的配置，从而完成对应的相干累加和非相干累加，进行捕获判决。具体的，捕获引擎的输入信号是射频提供的数字中频。此外，捕获引擎设置相干累加时间时需要考虑电文的翻转问题。以GPS L1C/A信号为例，GPS L1C/A信号电文速率为50bps，即一个比特周期20ms，内含20组C/A码，匹配滤波器在进行相干累加的过程中还应进行比特边沿的搜索，以确保20ms相干累加是在一个比特周期内进行。捕获引擎搜索基带信号所有频点、码相位和比特边沿，实现对北斗B1I、GPS L1C/A等信号20ms相干累加、若干次非相干累加的捕获，并选出前N个峰值。其中，每个峰值会对应一个多普勒搜索值和一个码相位搜索值。以北斗B1I为例，为实现对弱信号的捕获，需要剥离NH码，实现相干时间为20ms的相干累加和若干次非相干累加，设需要搜索的多普勒频率为M次。具体的，表3举例说明M的取值方法，假设要搜索的多普勒频率范围为±5000Hz，相干累加20ms时覆盖的多普勒范围为25Hz，M取值为401。具体的，下表为表3，表示在不同条件下， 多普勒频率的搜索次数。在匹配滤波器的算法中，则需要的搜索时间为，其中，表示相干累加时间，表示非相干累加次数，20为比特边沿的搜索次数。在第一次捕获时，记录使用数据的时刻T1，这里的T1表示第一个数据进入匹配滤波器的时刻，该时刻由GNSS接收机射频ADC提供的采样时钟驱动并记录。GNSS接收机开机后，射频ADC采样时钟开始启动，在基带电路中设置一个时间计数器，由ADC采样时钟作为这个时间计数器的时钟驱动。时间计数器可以取48位，一般ADC采样时钟为16.368MHz，这样开机后时间计数器可以计数的范围为：天。当开始捕获时，第一个数据进入捕获引擎时，记录一下时间计数器的读数，计为T1。第二次捕获时，第一个数据进入捕获引擎时，记录一下时间计数器的读数，计为T2，以此类推。在此条件下，则在后续码相位计算公式中。第一次捕获时，在匹配滤波器的搜索结果中，找出前N个第一峰值，找的原则为根据峰值的大小进行排序，记录对应的多普勒搜索值和码相位搜索值，其分别用和表示，i表示第i个第一峰值对应的搜索结果。第二次捕获时，记录使用数据的时刻T2。针对这N个峰值对应的多普勒和码相位区域，计算在T2时刻捕获可能出现峰值的位置找到前P个第二峰值。然后利用码相位计算方法中的计算公式，计算在T2时刻时，第一峰值的第一码相位搜索值在此时的码相位值，在将计算获得的码相位值与二次捕获时第二峰值的第二码相位搜索值进行对比，获得两者之间的偏差值，并通过偏差值的大小判断是否是正确的捕获峰值。如上即为本申请的实施例。上述实施例以及实施例中的具体参数仅是为了清楚表述申请的验证过程，并非用以限制本申请的专利保护范围，本申请的专利保护范围仍然以其权利要求书为准，凡是运用本申请的说明书及附图内容所作的等同结构变化，同理均应包含在本申请的保护范围内。
