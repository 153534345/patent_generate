标题title
基于图传播的推荐模型训练方法及基于图传播的推荐方法
摘要abst
本发明提供了一种基于图传播的推荐模型训练方法及基于图传播的推荐方法，可以应用于计算机技术领域、图学习技术领域以及数据挖掘技术领域。该方法包括：获取用于表征用户与物品之间交互关系的二分图；对二分图进行图传播，得到传播矩阵；从传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，传播矩阵包括多个传播权重，传播权重表征用户与物品之间的交互频率；根据第一传播权重，确定第一正样本，其中，第一正样本包括与第一传播权重相对应的第一用户标识信息和第一物品标识信息；根据传播矩阵中小于第一预设阈值的第二传播权重，确定第一负样本；利用第一正样本和第一负样本训练深度学习模型，得到推荐模型。
权利要求书clms
1.一种基于图传播的推荐模型训练方法，包括：获取用于表征用户与物品之间交互关系的二分图；对所述二分图进行图传播，得到传播矩阵；从所述传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，所述传播矩阵包括多个传播权重，所述传播权重表征用户与物品之间的交互频率；根据所述第一传播权重，确定第一正样本，其中，所述第一正样本包括与所述第一传播权重相对应的第一用户标识信息和第一物品标识信息；根据所述传播矩阵中小于所述第一预设阈值的第二传播权重，确定第一负样本，其中，所述第一负样本包括与所述第二传播权重相对应的第二用户标识信息和第二物品标识信息；利用所述第一正样本和所述第一负样本训练深度学习模型，得到推荐模型。2.根据权利要求1所述的方法，其中，所述对所述二分图进行图传播，得到传播矩阵，包括：根据所述二分图，确定邻接矩阵；利用所述邻接矩阵的度对角矩阵，对所述邻接矩阵进行归一化处理，得到归一化邻接矩阵；利用单位矩阵对所述归一化邻接矩阵进行传播，得到中间传播矩阵，其中，所述单位矩阵为对角线上的元素均为1的矩阵；利用掩码矩阵将所述中间传播矩阵中小于或等于第二预设阈值的子传播权重置零，得到所述传播矩阵。3.根据权利要求2所述的方法，其中，所述利用所述第一正样本和所述第一负样本训练深度学习模型，得到推荐模型，包括：将所述第一正样本和所述第一负样本输入至损失函数中，得到第一损失值；基于所述邻接矩阵，确定第二正样本和第二负样本；将所述第二正样本和所述第二负样本输入至损失函数中，得到第二损失值；基于所述第一损失值和所述第二损失值，更新所述深度学习模型的参数，得到所述推荐模型。4.根据权利要求3所述的方法，其中，所述基于所述邻接矩阵，确定第二正样本和第二负样本，包括：根据所述邻接矩阵中大于或等于第三预设阈值的第一邻接权重，确定第二正样本，其中，所述第二正样本包括与所述第一邻接权重相对应的第三用户标识信息和第三物品标识信息；根据所述邻接矩阵中小于所述第三预设阈值的第二邻接权重，确定第二负样本，其中，所述第二负样本包括与所述第二邻接权重相对应的第四用户标识信息和第四物品标识信息。5.根据权利要求3所述的方法，其中，所述将所述第一正样本和所述第一负样本输入至损失函数中，得到第一损失值，包括：将所述第一用户标识信息、所述第一物品标识信息、所述第二用户标识信息和所述第二物品标识信息输入至所述深度学习模型中，分别输出第一用户标识向量、第一物品标识向量、第二用户标识向量和第二物品标识向量；利用交互打分函数分别计算所述第一用户标识向量和所述第一物品标识向量之间的第一余弦相似度值、所述第二用户标识向量和所述第二物品标识向量之间的第二余弦相似度值；基于所述第一余弦相似度值和所述第二余弦相似度值，确定所述第一损失值。6.根据权利要求4所述的方法，其中，所述将所述第二正样本和所述第二负样本输入至损失函数中，得到第二损失值，包括：将所述第三用户标识信息、所述第三物品标识信息、所述第四用户标识信息和所述第四物品标识信息输入至所述深度学习模型中，分别输出第三用户标识向量、第三物品标识向量、第四用户标识向量和第四物品标识向量；利用交互打分函数分别计算所述第三用户标识向量和所述第三物品标识向量之间的第三余弦相似度值、所述第四用户标识向量和所述第四物品标识向量之间的第四余弦相似度值；基于所述第三余弦相似度值和所述第四余弦相似度值，确定所述第二损失值。7.根据权利要求5所述的方法，其中，所述损失函数用以下公式表示：其中，表示所述第一损失值，B表示所述第一正样本的集合，|B|表示所述第一正样本的数量，u表示所述第一用户标识信息，i表示所述第一物品标识信息，r表示所述第一传播权重，N表示所述第一负样本的数量，un表示所述第二用户标识信息，ik表示N个所述第一负样本中第k个所述第一负样本的第二物品标识信息，k表示N个所述第一负样本中第k个所述第一负样本，为第一正样本的交互打分函数，为第一负样本中的交互打分函数， 表示设定参数，e为常数。8.一种基于图传播的推荐方法，包括：将目标用户的目标用户标识信息输入至如权利要求1至7中任一项中的基于图传播的推荐模型训练方法训练好的推荐模型中，输出与所述目标用户标识信息对应的目标用户标识向量；确定所述目标用户标识向量与多个待推荐物品向量各自之间的余弦相似度，得到多个余弦相似度，其中，所述待推荐物品向量是利用所述推荐模型处理多个待推荐物品各自的待推荐物品标识信息得到的；基于所述多个余弦相似度，从多个所述待推荐物品中确定目标推荐物品。9.一种基于图传播的推荐模型训练装置，包括：获取模块，用于获取用于表征用户与物品之间交互关系的二分图；第一得到模块，用于对所述二分图进行图传播，得到传播矩阵；第一确定模块，用于从所述传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，所述传播矩阵包括多个传播权重，所述传播权重表征用户与物品之间的交互频率；第二确定模块，用于根据所述第一传播权重，确定第一正样本，其中，所述第一正样本包括与所述第一传播权重相对应的第一用户标识信息和第一物品标识信息；第三确定模块，用于根据所述传播矩阵中小于所述第一预设阈值的第二传播权重，确定第一负样本，其中，所述第一负样本包括与所述第二传播权重相对应的所述第二用户标识信息和第二物品标识信息；第二得到模块，用于利用所述第一正样本和所述第一负样本训练深度学习模型，得到推荐模型。10.一种基于图传播的推荐装置，包括：输出模块，用于将目标用户的目标用户标识信息输入至如权利要求1至7中任一项中的基于图传播的推荐模型训练方法训练好的推荐模型中，输出与所述目标用户标识信息对应的目标用户标识向量；第四确定模块，用于确定所述目标用户标识向量与多个待推荐物品向量各自之间的余弦相似度，得到多个余弦相似度，其中，所述待推荐物品向量是利用所述推荐模型处理多个待推荐物品各自的待推荐物品标识信息得到的；第五确定模块，用于基于所述多个余弦相似度，从多个所述待推荐物品中确定目标推荐物品。
说明书desc
技术领域本发明涉及计算机技术领域、图学习技术领域以及数据挖掘技术领域，更具体地，涉及一种基于图传播的推荐模型训练方法、基于图传播的推荐方法、训练装置及推荐装置。背景技术随着图神经网络的不断研究以及在物品推荐任务中的优秀性能，其在多个领域的应用得到了研究人员的广泛关注。其中，协同过滤推荐系统得益于其的用户-物品交互图，在使用图神经网络进行用户与物品建模时具有天然优势。然而受限于协同过滤场景下物品和用户只存在交互信息而缺乏特征信息，直接将传统的图神经网络应用在推荐场景并不能取得最优效果。在实现本发明构思的过程中，发明人发现相关技术中至少存在如下问题：相关技术中，推荐模型的训练方法复杂，且效率较低。发明内容有鉴于此，本发明提供了一种基于图传播的推荐模型训练方法、基于图传播的推荐方法、训练装置及推荐装置。本发明的一个方面提供了一种基于图传播的推荐模型训练方法，包括：获取用于表征用户与物品之间交互关系的二分图；对二分图进行图传播，得到传播矩阵；从传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，传播矩阵包括多个传播权重，传播权重表征用户与物品之间的交互频率；根据第一传播权重，确定第一正样本，其中，第一正样本包括与第一传播权重相对应的第一用户标识信息和第一物品标识信息；根据传播矩阵中小于第一预设阈值的第二传播权重，确定第一负样本，其中，第一负样本包括与第二传播权重相对应的第二用户标识信息和第二物品标识信息；利用第一正样本和第一负样本训练深度学习模型，得到推荐模型。根据本发明的实施例，其中，对二分图进行图传播，得到传播矩阵，包括：根据二分图，确定邻接矩阵；利用邻接矩阵的度对角矩阵，对邻接矩阵进行归一化处理，得到归一化邻接矩阵；利用单位矩阵对归一化邻接矩阵进行传播，得到中间传播矩阵，其中，单位矩阵为对角线上的元素均为1的矩阵；利用掩码矩阵将中间传播矩阵中小于或等于第二预设阈值的子传播权重置零，得到传播矩阵。根据本发明的实施例，其中，利用第一正样本和第一负样本训练深度学习模型，得到推荐模型，包括：将第一正样本和第一负样本输入至损失函数中，得到第一损失值；基于邻接矩阵，确定第二正样本和第二负样本；将第二正样本和第二负样本输入至损失函数中，得到第二损失值；基于第一损失值和第二损失值，更新深度学习模型的参数，得到推荐模型。根据本发明的实施例，其中，基于邻接矩阵，确定第二正样本和第二负样本，包括：根据邻接矩阵中大于或等于第三预设阈值的第一邻接权重，确定第二正样本，其中，第二正样本包括与第一邻接权重相对应的第三用户标识信息和第三物品标识信息；根据邻接矩阵中小于第三预设阈值的第二邻接权重，确定第二负样本，其中，第二负样本包括与第二邻接权重相对应的第四用户标识信息和第四物品标识信息。根据本发明的实施例，其中，将第一正样本和第一负样本输入至损失函数中，得到第一损失值，包括：将第一用户标识信息、第一物品标识信息、第二用户标识信息和第二物品标识信息输入至深度学习模型中，分别输出第一用户标识向量、第一物品标识向量、第二用户标识向量和第二物品标识向量；利用交互打分函数分别计算第一用户标识向量和第一物品标识向量之间的第一余弦相似度值、第二用户标识向量和第二物品标识向量之间的第二余弦相似度值；基于第一余弦相似度值和第二余弦相似度值，确定第一损失值。根据本发明的实施例，其中，将第二正样本和第二负样本输入至损失函数中，得到第二损失值，包括：将第三用户标识信息、第三物品标识信息、第四用户标识信息和第四物品标识信息输入至深度学习模型中，分别输出第三用户标识向量、第三物品标识向量、第四用户标识向量和第四物品标识向量；利用交互打分函数分别计算第三用户标识向量和第三物品标识向量之间的第三余弦相似度值、第四用户标识向量和第四物品标识向量之间的第四余弦相似度值；基于第三余弦相似度值和第四余弦相似度值，确定第二损失值。根据本发明的实施例，其中，损失函数用以下公式表示：其中，表示第一损失值，B表示第一正样本的集合，|B|表示第一正样本的数量，u表示第一用户标识信息，i表示第一物品标识信息，r表示第一传播权重，N表示第一负样本的数量，un表示第二用户标识信息，ik表示N个第一负样本中第k个第一负样本的第二物品标识信息，k表示N个第一负样本中第k个第一负样本，为第一正样本的交互打分函数，为第一负样本中的交互打分函数， 表示设定参数，e为常数。本发明的另一个方面提供了一种基于图传播的推荐方法，包括：将目标用户的目标用户标识信息输入至上述基于图传播的推荐模型训练方法训练好的推荐模型中，输出与目标用户标识信息对应的目标用户标识向量；确定目标用户标识向量与多个待推荐物品向量各自之间的余弦相似度，得到多个余弦相似度，其中，待推荐物品向量是利用推荐模型处理多个待推荐物品各自的待推荐物品标识信息得到的；基于多个余弦相似度，从多个待推荐物品中确定目标推荐物品。本发明的另一个方面提供了一种基于图传播的推荐模型训练装置，包括：获取模块，用于获取用于表征用户与物品之间交互关系的二分图；第一得到模块，用于对二分图进行图传播，得到传播矩阵；第一确定模块，用于从传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，传播矩阵包括多个传播权重，传播权重表征用户与物品之间的交互频率；第二确定模块，用于根据第一传播权重，确定第一正样本，其中，第一正样本包括与第一传播权重相对应的第一用户标识信息和第一物品标识信息；第三确定模块，用于根据传播矩阵中小于第一预设阈值的第二传播权重，确定第一负样本，其中，第一负样本包括与第二传播权重相对应的第二用户标识信息和第二物品标识信息；第二得到模块，用于利用第一正样本和第一负样本训练深度学习模型，得到推荐模型。本发明的另一个方面提供了一种基于图传播的推荐装置，包括：输出模块，用于将目标用户的目标用户标识信息输入至如上述基于图传播的推荐模型训练方法训练好的推荐模型中，输出与目标用户标识信息对应的目标用户标识向量；第四确定模块，用于确定目标用户标识向量与多个待推荐物品向量各自之间的余弦相似度，得到多个余弦相似度，其中，待推荐物品向量是利用推荐模型处理多个待推荐物品各自的待推荐物品标识信息得到的；第五确定模块，用于基于多个余弦相似度，从多个待推荐物品中确定目标推荐物品。根据本发明的实施例，通过对用于表征用户与物品之间交互关系的二分图进行图传播得到传播矩阵；基于传播矩阵中的多个传播权重与第一预设阈值，确定第一正样本和第一负样本，利用第一正样本和第一负样本训练深度学习模型，得到推荐模型，避免了显式图卷积操作，降低了对深度学习模型的训练的复杂程度，提高了对深度学习模型的训练效率，并且二分图传播后的传播矩阵中包括了用户与物品之间潜在的交互关系，使得对深度学习模型的训练可以更好的利用二分图中的信息，进而提升推荐模型对物品推荐的的推荐能力。附图说明通过以下参照附图对本发明实施例的描述，本发明的上述以及其他目的、特征和优点将更为清楚，在附图中：图1示出了根据本发明实施例的基于图传播的推荐模型训练方法的流程图；图2示出了根据本发明实施例的具有8个用户以及5个物品的邻接矩阵的传播示意图；图3示出了根据本发明实施例的推荐模型的训练流程示意图；图4示出了根据本发明实施例的基于图传播的推荐方法的示意图；图5示出了根据本发明实施例的基于图传播的推荐模型训练装置的框图；图6示出了根据本发明实施例的基于图传播的推荐装置的框图。具体实施方式以下，将参照附图来描述本发明的实施例。但是应该理解，这些描述只是示例性的，而并非要限制本发明的范围。在下面的详细描述中，为便于解释，阐述了许多具体的细节以提供对本发明实施例的全面理解。然而，明显地，一个或多个实施例在没有这些具体细节的情况下也可以被实施。此外，在以下说明中，省略了对公知结构和技术的描述，以避免不必要地混淆本发明的概念。在此使用的术语仅仅是为了描述具体实施例，而并非意在限制本发明。在此使用的术语“包括”、“包含”等表明了所述特征、步骤、操作和/或部件的存在，但是并不排除存在或添加一个或多个其他特征、步骤、操作或部件。在此使用的所有术语具有本领域技术人员通常所理解的含义，除非另外定义。应注意，这里使用的术语应解释为具有与本说明书的上下文相一致的含义，而不应以理想化或过于刻板的方式来解释。在使用类似于“A、B和C等中至少一个”这样的表述的情况下，一般来说应该按照本领域技术人员通常理解该表述的含义来予以解释。在使用类似于“A、B或C等中至少一个”这样的表述的情况下，一般来说应该按照本领域技术人员通常理解该表述的含义来予以解释。在本发明的技术方案中，所涉及的用户个人信息的获取，存储和应用等，均符合相关法律法规的规定，采取了必要保密措施，且不违背公序良俗。在本发明的技术方案中，在获取或采集用户个人信息之前，均获取了用户的授权或同意。近些年来，随着图神经网络的不断研究以及在下游任务中的优秀性能，其在多个领域的应用得到了研究人员的广泛关注。其中，协同过滤推荐系统得益于其的用户与物品交互关系的二分图，在使用图神经网络进行用户与物品建模的情况下具有天然优势。然而受限于协同过滤场景下物品和用户只存在交互信息而缺乏特征信息，直接将传统的图神经网络应用在推荐场景并不能取得最优效果。部分研究尝试改进图神经网络中的结构，通过删除其中一些于推荐系统无益的冗余操作，使得改进后的结构能够更加适应推荐任务，从而取得更加高效快速的推荐效果。然而这种方法依然要求在每一轮训练中显式地进行全批量图卷积操作以得到每个节点在聚合邻居节点后的向量表示，因此在大规模交互数据上的效率还是难以得到保证。有鉴于此，本发明的实施例提供了一种基于图传播的推荐模型训练方法。该方法包括获取用于表征用户与物品之间交互关系的二分图；对二分图进行图传播，得到传播矩阵；从传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，传播矩阵包括多个传播权重，传播权重表征用户与物品之间的交互频率；根据第一传播权重，确定第一正样本，其中，第一正样本包括与第一传播权重相对应的第一用户标识信息和第一物品标识信息；根据传播矩阵中小于第一预设阈值的第二传播权重，确定第一负样本，其中，第一负样本包括与第二传播权重相对应的第二用户标识信息和第二物品标识信息；利用第一正样本和第一负样本训练深度学习模型，得到推荐模型。根据本发明的实施例，通过对用于表征用户与物品之间交互关系的二分图进行图传播得到传播矩阵；基于传播矩阵中的多个传播权重与第一预设阈值，确定第一正样本和第一负样本，利用第一正样本和第一负样本训练深度学习模型，得到推荐模型，避免了显式图卷积操作，降低了对深度学习模型的训练的复杂程度，提高了对深度学习模型的训练效率，并且二分图传播后的传播矩阵中包括了用户与物品之间潜在的交互关系，使得对深度学习模型的训练可以更好的利用二分图中的信息，进而提升推荐模型对物品推荐的的推荐能力。图1示意性示出了根据本发明实施例的基于图传播的推荐模型训练方法的流程图。如图1所示，该方法包括操作S101~S106。在操作S101，获取用于表征用户与物品之间交互关系的二分图。根据本发明的实施例，用户与物品之间交互关系的二分图可以包括用户与物品的节点以及表征用户与物品之间交互关系的边，其中，用户可以有多个，物品也可以有多个，每一条边只能连接用户与物品，用户与用户之间或者物品与物品之间没有边连接。根据本发明的实施例，用户与物品之间交互关系可以是多种场景下的交互关系，例如，在购物场景下，物品可以是购物平台的商品，用户与物品之间的交互关系可以是通过用户对物品的浏览次数、收藏与否、是否加入购物车以及是否购买确定的；在信息浏览场景下，物品可以是信息浏览平台中的文章、图片、视频等信息，用户与物品之间的交互关系可以是通过用户对物品的点击确定的；在一些，如电影推荐、电视剧推荐、图书推荐等的打分场景下，物品可以是经过用户打分的电影、电视剧、图书等等，用户与物品之间的交互关系可以是通过用户对物品的打分确定的。在操作S102，对二分图进行图传播，得到传播矩阵。根据本发明的实施例，对二分图进行图传播可以是将二分中，用户与物品的交互进行增强显示的操作，例如，二分图中的A用户与B物品原本没有交互关系，其他用户与B物品均有交互，因此，A用户与B物品之间可能会存在交互，因此，可以对二分图进行图传播，将A用户与B物品之间可能存在的交互显示在传播矩阵中。根据本发明的实施例，传播矩阵中的，包括8个用户和5个物品，在操作S103，从传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，传播矩阵包括多个传播权重，传播权重表征用户与物品之间的交互频率。根据本发明的实施例，传播矩阵中的每一个矩阵元素都可以是传播权重，每一行可以表示用户，每一列可以表示物品，每一个传播矩阵中的矩阵元素都可以表示该矩阵元素所在行的用户与所在列的物品之间的交互频率。根据本发明的实施例，传播权重越大，表示用户与物品之间的交互频率越高，可以设定第一预设阈值，从传播矩阵中确定大于或者等于第一预设阈值的第一传播权重。在操作S104，根据第一传播权重，确定第一正样本，其中，第一正样本包括与第一传播权重相对应的第一用户标识信息和第一物品标识信息。根据本发明的实施例，每一个传播权重对应的用户和物品都分别有用户标识信息和物品标识信息，用户标识信息可以是用户识别用户身份的信息，例如，可以是用户的用户名信息、注册号码信息等等，物品标识信息可以是用于识别物品的信息，例如可以是物品的名称信息、编码信息，在此仅为示意，并不构成对本发明的限制。根据本发明的实施例，可以根据第一传播权重在传播矩阵中的所在行和所在列分别确定对应的第一用户和第一物品，其中，第一用户的用户标识信息为第一用户标识信息，第一物品的物品标识信息为第一物品标识信息，由第一用户标识信息和第一物品标识信息确定第一正样本。在操作S105，根据传播矩阵中小于第一预设阈值的第二传播权重，确定第一负样本，其中，第一负样本包括与第二传播权重相对应的第二用户标识信息和第二物品标识信息。根据本发明的实施例，可以根据第二传播权重在传播矩阵中的所在行和所在列分别确定对应的第二用户和第二物品，其中，第二用户的用户标识信息为第二用户标识信息，第二物品的物品标识信息为第二物品标识信息，由第二用户标识信息和第二物品标识信息确定第一负样本。根据本发明的实施例，第一正样本的数量可以是M个，针对M个第一正样本中每一个第一正样本，确定N个第一负样本，因此，第一负样本的数量是M*N。根据本发明的实施例，第一用户和第二用户可以是相同的，也可以是不同的。在操作S106，利用第一正样本和第一负样本训练深度学习模型，得到推荐模型。根据本发明的实施例，深度学习模型可以是还没有训练好的模型，第一正样本和第一负样本是根据传播矩阵中的传播权重确定的，而传播矩阵中是根据二分图中的用户与物品的交互关系进行传播得到的，可以体现用户与物品之间潜在的交互关系，因此，利用第一正样本和第一负样本训练深度学习模型得到推荐模型可以使推荐模型更好的推荐物品。根据本发明的实施例，通过对用于表征用户与物品之间交互关系的二分图进行图传播得到传播矩阵；基于传播矩阵中的多个传播权重与第一预设阈值，确定第一正样本和第一负样本，利用第一正样本和第一负样本训练深度学习模型，得到推荐模型，避免了显式图卷积操作，降低了对深度学习模型的训练的复杂程度，提高了对深度学习模型的训练效率，并且二分图传播后的传播矩阵中包括了用户与物品之间潜在的交互关系，使得对深度学习模型的训练可以更好的利用二分图中的信息，进而提升推荐模型对物品推荐的的推荐能力。根据本发明的实施例，其中，对二分图进行图传播，得到传播矩阵，包括：根据二分图，确定邻接矩阵；利用邻接矩阵的度对角矩阵，对邻接矩阵进行归一化处理，得到归一化邻接矩阵；利用单位矩阵对归一化邻接矩阵进行传播，得到中间传播矩阵，其中，单位矩阵为对角线上的元素均为1的矩阵；利用掩码矩阵将中间传播矩阵中小于或等于第二预设阈值的子传播权重置零，得到传播矩阵。根据本发明的实施例，可以根据二分图中的每一个用户节点与物品节点之间的交互关系，确定邻接矩阵。根据本发明的实施例，对邻接矩阵进行归一化处理得到归一化邻接矩阵可以用以下公式表示： 其中，表示归一化邻接矩阵，A代表原始二分图的邻接矩阵，D代表原始邻接矩阵的度对角矩阵，p是归一化调整参数且，通过调整P的大小来确定用来调整归一化的方式。根据本发明的实施例，利用单位矩阵对归一化邻接矩阵进行传播，得到中间传播矩阵，可以得到用户对于物品潜在的兴趣，具体的可以用以下公式和表示：其中，表示邻接矩阵的初始状态，I表示单位矩阵，表示第l-1层输出的中间传播矩阵，表示第l层传播的中间传播矩阵。根据本发明的实施例，如果仅利用单位矩阵对归一化邻接矩阵进行传播，每一层传播之后的稠密度都会增加。因此，在每一层传播以后得到的中间传播矩阵，都使用一个掩码矩阵对传播后的中间权重矩阵进行掩码处理，从而使得中大于第二预设阈值的子传播权重保留下来，而将小于或等于第二预设阈值的子传播权重置零。根据本发明的实施例，利用掩码矩阵将中间传播矩阵中小于或等于第二预设阈值的子传播权重置零，得到传播矩阵可以用以下公式表示： 其中，表示第l层的掩码矩阵，表示掩码矩阵对中间传播矩阵的掩码。图2示意性示出了根据本发明实施例的具有8个用户以及5个物品的邻接矩阵的传播示意图。如图2所示，邻接矩阵中是从包括u1、u2、u3、u4、u5、u6、u7、u8等8个用户以及i1、i2、i3、i4、i5等5个物品的交互关系的二分图确定的，由邻接矩阵中可以看出用户u3与物品i4之间没有交互，经过传播之后得到的中间传播矩阵中，得到了用户u3与物品i4之间潜在的兴趣，但是同时也增加了中间传播矩阵的稠密度。因此，对于每一层的中间传播矩阵都进行自适应剪枝，例如，利用掩码矩阵将中间传播矩阵中小于或等于第二预设阈值的子传播权重置零，从而可以保留最有价值的中间传播权重，并且过滤掉绝大部分可能为噪音的中间传播权重。因此，利用掩码矩阵将中间传播矩阵中小于或等于第二预设阈值的子传播权重置零，得到传播矩阵的这一操作不仅能够提升模型的鲁棒性，而且能够保证每一层的邻接矩阵传播完以后的权重矩阵的稀疏程度都在可接受的范围内，从而达到降低运算的空间复杂度与实践复杂度的效果。根据本发明的实施例，其中，利用第一正样本和第一负样本训练深度学习模型，得到推荐模型，包括：将第一正样本和第一负样本输入至损失函数中，得到第一损失值；基于邻接矩阵，确定第二正样本和第二负样本；将第二正样本和第二负样本输入至损失函数中，得到第二损失值；基于第一损失值和第二损失值，更新深度学习模型的参数，得到推荐模型。根据本发明的实施例，将第一正样本和第一负样本输入至损失函数中，可以得到第一正样本和第一负样本之间的距离，即第一损失值。根据本发明的实施例，邻接矩阵中表征用户与物品的原始交互关系，也是较为重要的信息，因此从邻接矩阵中确定第二正样本和第二负样本，将第二正样本和第二负样本输入至损失函数中，可以得到第二正样本和第二负样本之间的距离，即第二损失值。根据本发明的实施例，基于第一损失值和第二损失值，更新深度学习模型的参数，直至深度学习模型收敛，得到训练好的推荐模型。根据本发明的实施例，利用邻接矩阵和传播矩阵确定的第一正样本、第一负样本、第二正样本和第二负样本训练深度学习模型，可以更好的利用用户与物品二分图中的信息，使得得到的推荐模型的推荐效果更好，能够更好的用于推荐物品。根据本发明的实施例，其中，基于邻接矩阵，确定第二正样本和第二负样本，包括：根据邻接矩阵中大于或等于第三预设阈值的第一邻接权重，确定第二正样本，其中，第二正样本包括与第一邻接权重相对应的第三用户标识信息和第三物品标识信息；根据邻接矩阵中小于第三预设阈值的第二邻接权重，确定第二负样本，其中，第二负样本包括与第二邻接权重相对应的第四用户标识信息和第四物品标识信息。根据本发明的实施例，第二正样本的和第二负样本的确定方法与第一正样本和第一负样本的确定方法相似，根据本发明的实施例，邻接矩阵中的每一个矩阵元素都可以是传播权重，每一行可以表示用户，每一列可以表示物品，每一个邻接矩阵中的矩阵元素都可以表示该矩阵元素所在行的用户与所在列的物品之间的交互频率。根据本发明的实施例，邻接权重越大，表示用户与物品之间的交互频率越高，可以设定第三预设阈值，从邻接矩阵中确定大于或者等于第三预设阈值的第一邻接权重。根据本发明的实施例，每一个邻接权重对应的用户和物品都分别有用户标识信息和物品标识信息，用户标识信息可以是用户识别用户身份的信息，例如，可以是用户的用户名信息、注册号码信息等等，物品标识信息可以是用于识别物品的信息，例如可以是物品的名称信息、编码信息，在此仅为示意，并不构成对本发明的限制。根据本发明的实施例，可以根据第一邻接权重在邻接矩阵中的所在行和所在列分别确定对应的第三用户和第三物品，其中，第三用户的用户标识信息为第三用户标识信息，第三物品的物品标识信息为第三物品标识信息，由第三用户标识信息和第三物品标识信息确定第二正样本。根据本发明的实施例，可以根据第二邻接权重在邻接矩阵中的所在行和所在列分别确定对应的第四用户和第四物品，其中，第四用户的用户标识信息为第四用户标识信息，第四物品的物品标识信息为第四物品标识信息，由第四用户标识信息和第四物品标识信息确定第二负样本。根据本发明的实施例，第二正样本的数量可以是X个，针对X个第二正样本中每一个第二正样本，确定Y个第二负样本，因此，第二负样本的数量是X*Y。根据本发明的实施例，第三用户和第四用户可以是相同的，也可以是不同的。根据本发明的实施例，其中，将第一正样本和第一负样本输入至损失函数中，得到第一损失值，包括：将第一用户标识信息、第一物品标识信息、第二用户标识信息和第二物品标识信息输入至深度学习模型中，分别输出第一用户标识向量、第一物品标识向量、第二用户标识向量和第二物品标识向量；利用交互打分函数分别计算第一用户标识向量和第一物品标识向量之间的第一余弦相似度值、第二用户标识向量和第二物品标识向量之间的第二余弦相似度值；基于第一余弦相似度值和第二余弦相似度值，确定第一损失值。根据本发明的实施例，深度学习模型可以是基于第一用户与第一物品之间的第一传播权重，输出与第一用户标识信息、第一物品标识信息、第二用户标识信息和第二物品标识信息分别对应的第一用户标识向量、第一物品标识向量、第二用户标识向量和第二物品标识向量。根据本发明的实施例，交互打分函数可以是softmax损失函数，交互打分函数可以计算用户标识向量与物品标识向量之间的余弦相似度，因此可以计算第一用户标识向量和第一物品标识向量之间的第一余弦相似度值、第二用户标识向量和第二物品标识向量之间的第二余弦相似度值。根据本发明的实施例，通过第一余弦相似度与第二余弦相似度可以确定第一损失值。根据本发明的实施例，其中，将第二正样本和第二负样本输入至损失函数中，得到第二损失值，包括：将第三用户标识信息、第三物品标识信息、第四用户标识信息和第四物品标识信息输入至深度学习模型中，分别输出第三用户标识向量、第三物品标识向量、第四用户标识向量和第四物品标识向量；利用交互打分函数分别计算第三用户标识向量和第三物品标识向量之间的第三余弦相似度值、第四用户标识向量和第四物品标识向量之间的第四余弦相似度值；基于第三余弦相似度值和第四余弦相似度值，确定第二损失值。根据本发明的实施例，深度学习模型可以是基于第二用户与第二物品之间的第二传播权重，输出与第三用户标识信息、第三物品标识信息、第四用户标识信息和第四物品标识信息分别对应的第三用户标识向量、第三物品标识向量、第四用户标识向量和第四物品标识向量。根据本发明的实施例，交互打分函数可以是softmax损失函数，交互打分函数可以计算用户标识向量与物品标识向量之间的余弦相似度，因此可以计算第三用户标识向量和第三物品标识向量之间的第三余弦相似度值、第四用户标识向量和第四物品标识向量之间的第三余弦相似度值。根据本发明的实施例，通过第三余弦相似度与第四余弦相似度可以确定第二损失值。根据本发明的实施例，利用交互打分函数得到用户与物品的余弦相似度，可以更好的体现用户与物品的交互关系。图3示意性示出了根据本发明实施例的推荐模型的训练流程示意图。如图3所示，根据传播矩阵中确定的第一正样本和第一负样本，将第一用户标识信息、第一物品标识信息、第二用户标识信息和第二物品标识信息输入至深度学习模型中，分别输出与第一用户标识信息、第一物品标识信息、第二用户标识信息和第二物品标识信息对应的第一用户标识向量、第一物品标识向量、第二用户标识向量和第二物品标识向量，根据交互打分函数计算出的第一余弦相似度值和第二余弦相似度值确定第一损失值。根据第一损失至更新深度学习模型的参数，直至深度学习模型收敛，得到训练好的深度学习模型，即推荐模型。根据本发明的实施例，其中，损失函数用以下公式表示： 其中，表示第一损失值，B表示第一正样本的集合，|B|表示第一正样本的数量，u表示第一用户标识信息，i表示第一物品标识信息，r表示第一传播权重，N表示第一负样本的数量，un表示第二用户标识信息，ik表示N个第一负样本中第k个第一负样本的第二物品标识信息，k表示N个第一负样本中第k个第一负样本，为第一正样本的交互打分函数，为第一负样本中的交互打分函数， 表示设定参数，e表示常数。根据本发明的实施例，第二损失值得计算公式与第一损失值的计算公式相同，区别仅在于样本不同，因此其中，L表示基于第一损失值和第二损失值计算出的总损失值，Loi表示第二损失值，LB表示第一损失值，表示第二损失值的调整参数。图4示意性示出了根据本发明实施例的基于图传播的推荐方法的示意图。如图4所示，该方法包括操作S401~操作S403。在操作S401，将目标用户的目标用户标识信息输入至上述基于图传播的推荐模型训练方法训练好的推荐模型中，输出与目标用户标识信息对应的目标用户标识向量；在操作S402，确定目标用户标识向量与多个待推荐物品向量各自之间的余弦相似度，得到多个余弦相似度，其中，待推荐物品向量是利用推荐模型处理多个待推荐物品各自的待推荐物品标识信息得到的；在操作S403，基于多个余弦相似度，从多个待推荐物品中确定目标推荐物品。为了验证本发明实施例中的推荐模型，以多个SOTA推荐模型，包括矩阵分解MF，变分编码器模型Mult-VAE，以及基于图神经网络的模型NGCF、 LightGCN、SGL、 UltraGCN、SimpleX作为对比模型，选取了四个不同类型的公开数据集Gowalla、Yelp2018、Home&amp;Kitchen以及Amazon-CDs进行实验。将整个数据集按照8:2的比例划分训练集以及测试集、分别统计不同的模型训练收敛后在测试集中的5次测试的平均性能，以Recall@20以及NDCG@20作为度量标准。实现结果如下表1不同推荐模型在4个数据集上的性能比较。表1 不同推荐模型在4个数据集上的性能比较从表1中，我们可以发现：在四种不同类型的数据集上，本发明实施例中的推荐模型大多数指标上都可以超过其他的对比模型，这说明本发明实施例中的推荐模型可以用更简单的训练方法却可以获得更优的推荐效果。在四种数据集上与SOTA模型的对比也可以证明本发明实施例中的推荐模型能够于不同的推荐场景具有自适应性，且预先捕捉的图结构信息能够比在推荐中直接应用图卷积进行训练更加有效。图5示意性示出了根据本发明实施例的基于图传播的推荐模型训练装置的框图。如图5所示，基于图传播的推荐模型训练装置500包括获取模块510、第一得到模块520、第一确定模块530、第二确定模块540、第三确定模块550和第二得到模块560。获取模块510，用于获取用于表征用户与物品之间交互关系的二分图；第一得到模块520，用于对二分图进行图传播，得到传播矩阵；第一确定模块530，用于从传播矩阵中确定大于或者等于第一预设阈值的第一传播权重，其中，传播矩阵包括多个传播权重，传播权重表征用户与物品之间的交互频率；第二确定模块540，用于根据第一传播权重，确定第一正样本，其中，第一正样本包括与第一传播权重相对应的第一用户标识信息和第一物品标识信息；第三确定模块550，用于根据传播矩阵中小于第一预设阈值的第二传播权重，确定第一负样本，其中，第一负样本包括与第二传播权重相对应的第二用户标识信息和第二物品标识信息；第二得到模块560，用于利用第一正样本和第一负样本训练深度学习模型，得到推荐模型。根据本发明的实施例，其中，用于对二分图进行图传播，得到传播矩阵的第一得到模块520包括：第一得到单元，用于根据二分图，确定邻接矩阵；第二得到单元，用于利用邻接矩阵的度对角矩阵，对邻接矩阵进行归一化处理，得到归一化邻接矩阵；第三得到单元，用于利用单位矩阵对归一化邻接矩阵进行传播，得到中间传播矩阵，其中，单位矩阵为对角线上的元素均为1的矩阵；第四得到单元，用于利用掩码矩阵将中间传播矩阵中小于或等于第二预设阈值的子传播权重置零，得到传播矩阵。根据本发明的实施例，其中，用于利用第一正样本和第一负样本训练深度学习模型，得到推荐模型的第二得到模块560包括：第五得到单元，用于将第一正样本和第一负样本输入至损失函数中，得到第一损失值；第六得到单元，用于基于邻接矩阵，确定第二正样本和第二负样本；第七得到单元，用于将第二正样本和第二负样本输入至损失函数中，得到第二损失值；第八得到单元，用于基于第一损失值和第二损失值，更新深度学习模型的参数，得到推荐模型。根据本发明的实施例，其中，用于基于邻接矩阵，确定第二正样本和第二负样本的第六得到单元包括：第一得到子单元，用于根据邻接矩阵中大于或等于第三预设阈值的第一邻接权重，确定第二正样本，其中，第二正样本包括与第一邻接权重相对应的第三用户标识信息和第三物品标识信息；第二得到子单元，用于根据邻接矩阵中小于第三预设阈值的第二邻接权重，确定第二负样本，其中，第二负样本包括与第二邻接权重相对应的第四用户标识信息和第四物品标识信息。根据本发明的实施例，其中，用于将第一正样本和第一负样本输入至损失函数中，得到第一损失值的第五得到单元包括：第三得到子单元，用于将第一用户标识信息、第一物品标识信息、第二用户标识信息和第二物品标识信息输入至深度学习模型中，分别输出第一用户标识向量、第一物品标识向量、第二用户标识向量和第二物品标识向量；第四得到子单元，用于利用交互打分函数分别计算第一用户标识向量和第一物品标识向量之间的第一余弦相似度值、第二用户标识向量和第二物品标识向量之间的第二余弦相似度值；第五得到子单元，用于基于第一余弦相似度值和第二余弦相似度值，确定第一损失值。根据本发明的实施例，其中，用于将第二正样本和第二负样本输入至损失函数中，得到第二损失值的第七得到单元包括：第六得到子单元，用于将第三用户标识信息、第三物品标识信息、第四用户标识信息和第四物品标识信息输入至深度学习模型中，分别输出第三用户标识向量、第三物品标识向量、第四用户标识向量和第四物品标识向量；第七得到子单元，用于利用交互打分函数分别计算第三用户标识向量和第三物品标识向量之间的第三余弦相似度值、第四用户标识向量和第四物品标识向量之间的第四余弦相似度值；第八得到子单元，用于基于第三余弦相似度值和第四余弦相似度值，确定第二损失值。根据本发明的实施例，其中，损失函数用以下公式表示：其中，表示第一损失值，B表示第一正样本的集合，|B|表示第一正样本的数量，u表示第一用户标识信息，i表示第一物品标识信息，r表示第一传播权重，N表示第一负样本的数量，un表示第二用户标识信息，ik表示N个第一负样本中第k个第一负样本的第二物品标识信息，k表示N个第一负样本中第k个第一负样本，为第一正样本的交互打分函数，为第一负样本中的交互打分函数， 表示设定参数，e为常数。图6示意性示出了根据本发明实施例的基于图传播的推荐装置的框图。如图6所示，基于图传播的推荐模型训练装置600包括输出模块610、第四确定模块620和第五确定模块630。输出模块610，用于将目标用户的目标用户标识信息输入至如上述基于图传播的推荐模型训练方法训练好的推荐模型中，输出与目标用户标识信息对应的目标用户标识向量；第四确定模块620，用于确定目标用户标识向量与多个待推荐物品向量各自之间的余弦相似度，得到多个余弦相似度，其中，待推荐物品向量是利用推荐模型处理多个待推荐物品各自的待推荐物品标识信息得到的；第五确定模块630，用于基于多个余弦相似度，从多个待推荐物品中确定目标推荐物品。根据本发明的实施例的模块、子模块、单元、子单元中的任意多个、或其中任意多个的至少部分功能可以在一个模块中实现。根据本发明实施例的模块、子模块、单元、子单元中的任意一个或多个可以被拆分成多个模块来实现。根据本发明实施例的模块、子模块、单元、子单元中的任意一个或多个可以至少被部分地实现为硬件电路，例如现场可编程门阵列、可编程逻辑阵列、片上系统、基板上的系统、封装上的系统、专用集成电路，或可以通过对电路进行集成或封装的任何其他的合理方式的硬件或固件来实现，或以软件、硬件以及固件三种实现方式中任意一种或以其中任意几种的适当组合来实现。或者，根据本发明实施例的模块、子模块、单元、子单元中的一个或多个可以至少被部分地实现为计算机程序模块，当该计算机程序模块被运行时，可以执行相应的功能。例如，获取模块510、第一得到模块520、第一确定模块530、第二确定模块540、第三确定模块550和第二得到模块560中的任意多个可以合并在一个模块/单元/子单元中实现，或者其中的任意一个模块/单元/子单元可以被拆分成多个模块/单元/子单元。或者，这些模块/单元/子单元中的一个或多个模块/单元/子单元的至少部分功能可以与其他模块/单元/子单元的至少部分功能相结合，并在一个模块/单元/子单元中实现。根据本发明的实施例，获取模块510、第一得到模块520、第一确定模块530、第二确定模块540、第三确定模块550和第二得到模块560中的至少一个可以至少被部分地实现为硬件电路，例如现场可编程门阵列、可编程逻辑阵列、片上系统、基板上的系统、封装上的系统、专用集成电路，或可以通过对电路进行集成或封装的任何其他的合理方式等硬件或固件来实现，或以软件、硬件以及固件三种实现方式中任意一种或以其中任意几种的适当组合来实现。或者，获取模块510、第一得到模块520、第一确定模块530、第二确定模块540、第三确定模块550和第二得到模块560中的至少一个可以至少被部分地实现为计算机程序模块，当该计算机程序模块被运行时，可以执行相应的功能。需要说明的是，本发明的实施例中基于图传播的推荐模型训练装置部分与本发明的实施例中基于图传播的推荐模型训练方法部分是相对应的，基于图传播的推荐模型训练装置部分的描述具体参考基于图传播的推荐模型训练方法部分，在此不再赘述。附图中的流程图和框图，图示了按照本发明各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。本领域技术人员可以理解，本发明的各个实施例和/或权利要求中记载的特征可以进行多种组合和/或结合，即使这样的组合或结合没有明确记载于本发明中。特别地，在不脱离本发明精神和教导的情况下，本发明的各个实施例和/或权利要求中记载的特征可以进行多种组合和/或结合。所有这些组合和/或结合均落入本发明的范围。以上对本发明的实施例进行了描述。但是，这些实施例仅仅是为了说明的目的，而并非为了限制本发明的范围。尽管在以上分别描述了各实施例，但是这并不意味着各个实施例中的措施不能有利地结合使用。本发明的范围由所附权利要求及其等同物限定。不脱离本发明的范围，本领域技术人员可以做出多种替代和修改，这些替代和修改都应落在本发明的范围之内。
