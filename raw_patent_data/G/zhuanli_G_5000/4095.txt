标题title
基于在线课程直播系统的直播内容传输方法
摘要abst
本发明公开了一种基于在线课程直播系统的直播内容传输方法，步骤如下：在教师用户终端和第一学生用户终端建立目标在线课程的视频会话后；若所述第一学生用户终端检测到目标学生用户的行为属于第一触发行为之一，向服务端上报携带所述第一学生用户终端对应的用户ID和第一时间戳的第一信息；服务端在接收到所述第一信息后，记录所述用户ID和第一时间戳的映射关系，停止向所述第一学生用户终端下发来自所述教师用户终端的直播源内容并向所述第一学生用户终端发送休眠指令；第一学生用户终端在接收到休眠指令后，进入休眠模式。本发明解决了课程直播过程中部分学生离开所带来的导致网络资源浪费问题，最大限度地保证整个课程的会话质量。
权利要求书clms
1.一种基于在线课程直播系统的直播内容传输方法，其特征在于，包括以下步骤：在教师用户终端和第一学生用户终端建立目标在线课程的视频会话后，所述第一学生用户终端利用自带摄像头检测目标学生用户的行为；若所述第一学生用户终端检测到目标学生用户的行为属于第一触发行为之一，向服务端上报携带所述第一学生用户终端对应的用户ID和第一时间戳的第一信息，所述第一触发行为包括目标学生用户的面部离开摄像头的视场超过设定时长；服务端在接收到所述第一信息后，记录所述用户ID和第一时间戳的映射关系，停止向所述第一学生用户终端下发来自所述教师用户终端的直播源内容并向所述第一学生用户终端发送休眠指令；第一学生用户终端在接收到休眠指令后，进入休眠模式并维持终端设备摄像头的用户行为检测功能；若所述第一学生用户终端检测到目标学生用户的行为属于第二触发行为之一，向服务端上报携带所述第一学生用户终端对应的用户ID和第二时间戳的第二信息，所述第二触发行为包括目标学生用户的面部恢复出现在摄像头的视场内并持续设定时长；服务端在接收到所述第二信息后，记录所述用户ID和第二时间戳的映射关系，并恢复向所述第一学生用户终端下发来自所述教师用户终端的直播源内容；第一学生用户终端停止休眠模式并播放所述直播源内容；服务端根据所述第一时间戳和所述第二时间戳，从所述教师用户终端的直播源内容截取视频内容，生成第一视频片段；将所述第一视频片段的观看链接与所述用户ID进行关联。2.根据权利要求1所述的一种基于在线课程直播系统的直播内容传输方法，其特征在于，所述步骤具体为：在教师用户终端和第一学生用户终端建立视频会话后，服务端查询具备行为检测权限的学生用户ID，所述行为检测权限是各个参与在线课程的学生用户预先设置的；在第一学生用户终端登录查询到的所述学生用户ID，服务端向该第一学生用户终端发送检测开启命令；用户端检测终端设备摄像头是否正常工作，若是，所述第一学生用户终端利用自带摄像头检测目标学生用户的行为。3.根据权利要求1所述的一种基于在线课程直播系统的直播内容传输方法，其特征在于，所述步骤还包括以下步骤：服务端确定与所述目标学生用户关联的监督家长用户；向所述监督家长用户的终端发送提醒信息，所述提醒信息表征所述目标学生用户缺席视频会话的时间段信息。4.根据权利要求1所述的一种基于在线课程直播系统的直播内容传输方法，其特征在于，所述步骤具体为：服务端查询与所述第一学生用户终端关联的第二学生用户终端；服务端向所述第二学生用户终端发送课程续上提醒信息；服务端若接收到来自所述第二学生用户终端的续上确认反馈信息，则向所述第二学生用户终端下发来自所述教师用户终端的直播源内容。5.根据权利要求1所述的一种基于在线课程直播系统的直播内容传输方法，其特征在于，所述步骤还包括以下步骤：服务端记录所述第二学生用户终端的续上时刻；服务端根据所述第一时间戳和所述续上时刻，从所述教师用户终端的直播源内容截取从第一时间戳到续上时刻的视频内容，生成第二视频片段；将所述第二视频片段的观看链接与所述用户ID进行关联。6.根据权利要求1所述的一种基于在线课程直播系统的直播内容传输方法，其特征在于，所述步骤具体为：服务端确定所述第一时间戳所属的第一片段，并获得该第一片段对应的起始时间戳；服务端确定所述第二时间戳所属的第二片段，并获得该第二片段对应的终止时间戳；服务端查询是否已存在从所述起始时间戳到所述终止时间戳的视频内容；若无，则服务端从所述教师用户终端的直播源内容截取从所述起始时间戳到所述终止时间戳的视频内容，以生成第一视频片段；若有，则服务端将已存在的视频内容确定为第一视频片段；其中，所述直播源内容划分为若干片段，每一片段对应一个起始时间戳和一个终止时间戳。7.一种计算机存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时实现如权利要求1-6中任一项所述的一种基于在线课程直播系统的直播内容传输方法。8.一种计算机设备，包括储存器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1-6中任一项所述的一种基于在线课程直播系统的直播内容传输方法。
说明书desc
技术领域本发明涉及在线教育，特别是一种基于在线课程直播系统的直播内容传输方法。背景技术疫情问题激发了各类在线教育课程的兴起。用户在参与在线课程时，难免有学生因个人因素需要离开其终端设备，但是在线课程一般参与用户较多，无法因为一个或几个学生的离开而中止，这就导致离开的学生错过课程的一部分内容未学习到。现有方案中，离开的学生只能通过课后观看此课程的完整录像进行补充学习，倒是这样的方式学习效率较低。此外，如果学生离开后，其终端设备还是在播放在线课程，这在一定程度上是对带宽的浪费，可能会导致直播课程的卡顿。发明内容发明目的：本发明的目的是提供一种基于在线课程直播系统的直播内容传输方法，从而节约网络资源的消耗，改善网络课程的直播效果，并提高用户的学习效率。技术方案：本发明所述的一种基于在线课程直播系统的直播内容传输方法，包括以下步骤：在教师用户终端和第一学生用户终端建立目标在线课程的视频会话后，所述第一学生用户终端利用自带摄像头检测目标学生用户的行为；若所述第一学生用户终端检测到目标学生用户的行为属于第一触发行为之一，向服务端上报携带所述第一学生用户终端对应的用户ID和第一时间戳的第一信息，所述第一触发行为包括目标学生用户的面部离开摄像头的视场超过设定时长；服务端在接收到所述第一信息后，记录所述用户ID和第一时间戳的映射关系，停止向所述第一学生用户终端下发来自所述教师用户终端的直播源内容并向所述第一学生用户终端发送休眠指令；第一学生用户终端在接收到休眠指令后，进入休眠模式并维持终端设备摄像头的用户行为检测功能；若所述第一学生用户终端检测到目标学生用户的行为属于第二触发行为之一，向服务端上报携带所述第一学生用户终端对应的用户ID和第二时间戳的第二信息，所述第二触发行为包括目标学生用户的面部恢复出现在摄像头的视场内并持续设定时长；服务端在接收到所述第二信息后，记录所述用户ID和第二时间戳的映射关系，并恢复向所述第一学生用户终端下发来自所述教师用户终端的直播源内容；第一学生用户终端停止休眠模式并播放所述直播源内容；服务端根据所述第一时间戳和所述第二时间戳，从所述教师用户终端的直播源内容截取视频内容，生成第一视频片段；将所述第一视频片段的观看链接与所述用户ID进行关联。所述步骤具体为：在教师用户终端和第一学生用户终端建立视频会话后，服务端查询具备行为检测权限的学生用户ID，所述行为检测权限是各个参与在线课程的学生用户预先设置的；在第一学生用户终端登录查询到的所述学生用户ID，服务端向该第一学生用户终端发送检测开启命令；用户端检测终端设备摄像头是否正常工作，若是，所述第一学生用户终端利用自带摄像头检测目标学生用户的行为。所述步骤还包括以下步骤：服务端确定与所述目标学生用户关联的监督家长用户；向所述监督家长用户的终端发送提醒信息，所述提醒信息表征所述目标学生用户缺席视频会话的时间段信息。所述步骤具体为：服务端查询与所述第一学生用户终端关联的第二学生用户终端；服务端向所述第二学生用户终端发送课程续上提醒信息；服务端若接收到来自所述第二学生用户终端的续上确认反馈信息，则向所述第二学生用户终端下发来自所述教师用户终端的直播源内容。所述步骤还包括以下步骤：服务端记录所述第二学生用户终端的续上时刻；服务端根据所述第一时间戳和所述续上时刻，从所述教师用户终端的直播源内容截取从第一时间戳到续上时刻的视频内容，生成第二视频片段；将所述第二视频片段的观看链接与所述用户ID进行关联。所述步骤具体为：服务端确定所述第一时间戳所属的第一片段，并获得该第一片段对应的起始时间戳；服务端确定所述第二时间戳所属的第二片段，并获得该第二片段对应的终止时间戳；服务端查询是否已存在从所述起始时间戳到所述终止时间戳的视频内容；若无，则服务端从所述教师用户终端的直播源内容截取从所述起始时间戳到所述终止时间戳的视频内容，以生成第一视频片段；若有，则服务端将已存在的视频内容确定为第一视频片段；其中，所述直播源内容划分为若干片段，每一片段对应一个起始时间戳和一个终止时间戳。一种计算机存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现上述的一种基于在线课程直播系统的直播内容传输方法。一种计算机设备，包括储存器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述的一种基于在线课程直播系统的直播内容传输方法。有益效果：与现有技术相比，本发明具有如下优点：1、本发明解决了课程直播过程中部分学生离开所带来的导致网络资源浪费问题，最大限度地保证整个课程的会话质量；2、本发明通过自动识别学生用户的离开和回来，并自动记录时刻，根据所记录的时间截取针对性的漏学课程内容，供学生用户课后学习。此方案不需要用户人为进行操作，极大地提高了学校效率和用户体验。附图说明图1为本发明所述方法的网络硬件架构示意图；图2为本发明所述方法的直播内容传输方法的流程；图3为本发明所述方法的应用场景示意图。具体实施方式下面结合附图对本发明的技术方案作进一步说明。图1示出了本发明所述方法的一个实施例的网络硬件架构示意图。其中，该系统用于提供在线课程直播服务，其中包括安装有服务端应用程序的服务器，安装有客户端应用程序的学生用户终端和教师用户终端。其中，用户终端包括不限于手机和电脑。接下来参照图1和图2来说明本申请实施例。在一实施例中，直播内容传输方法包括如下步骤S101～S115：S101：教师用户终端和第一学生用户终端建立目标在线课程的视频会话；其中，教师用户终端的使用者是教师B，第一学生用户终端的使用者是学生A。对于同一网络直播课程，参与该课程的学生和教师数量不限，通常会生成与指定课程对应的唯一入场识别码，并逐一发送给参与该课程的人员，这些人员在指定时间依据个人的用户ID、登录密码以及指定课程所对应的入场识别码验证进入直播课程会话。S102：第一学生用户终端利用自带摄像头检测目标学生用户A的行为。其中，步骤S102可以具体包括如下步骤S1021～S1023来实现：S1021：在教师用户终端和第一学生用户终端建立视频会话后，服务端查询具备行为检测权限的学生用户ID。具体的，所述行为检测权限是各个参与在线课程的学生用户预先设置的，由于不是所有学生用户都需要开启行为监控功能，例如，某些学生担心个人隐私被窥探，或者担心开启该功能会误操作导致摄像头被开启，进而将自己的视频内容共享给其他参与者。所以需要根据学生用户自身的需求来个性化设定。每个设定该行为检测功能的用户在完成设定后，都会有服务器来存储其设定内容，供后续查询。S1022：在第一学生用户终端登录查询到的所述学生用户ID，服务端向该第一学生用户终端发送检测开启命令。S1023：用户端检测终端设备摄像头是否正常工作，若是，所述第一学生用户终端利用自带摄像头检测目标学生用户的行为。若否，向用户报错。S103：第一学生用户终端检测到目标学生用户的行为属于第一触发行为之一。在一些实施例中，所述第一触发行为可以是目标学生用户的面部离开摄像头的视场超过设定时长。其中，服务端可以存储学生用户的真实面部特征与其ID的对应关系，这样，在学生进入会话后，首先就是获取摄像头前的用户面部特征信息，并上传到服务端进行面部特征比对，若比对成功，则对该学生的身份验证成功。并在验证成功后，持续利用摄像头监控该学生的面部特征，对于进入摄像头视场内的其他用户的面部特征，可以视为无效信息进行过滤，而只检测以上以验证成功的特定面部特征是否在摄像头的视场内。当然，在一些实施例中，也可以不设定特定的面容特征验证机制，可以是任意人的人脸特征信息，也就是说，只要摄像头能够检测到人脸，就认定屏幕前有用户正在听课。如果学生用户在听课过程中，因为突发状况需要离开显示器前，那么直播应用APP通过调用摄像头便可以发现视场内已无人脸特征，或者有人脸特征，但是不是预先身份验证成功的目标用户的脸部特征。此情况出现后，我们设定的机制是记录该人脸特征消失状态所持续的时长，并判断所记录的时长是否超过设定时长，若是，则证明学生用户确定是离开了当前显示屏前。否则，则证明学生用户只是短暂离开或者因为学生的头部姿态或身体坐姿不正所导致人脸未被捕捉到。对于这种学生用户长时间离开显示屏前的问题，如果服务端还是不断地向该用户端传输直播数据源，则会导致网络资源的浪费，因为当前用户并不能看到课程内容，其终端设备势必会挤占其他学生终端的网络带宽资源，当用户数很大时，这一问题尤为突出。另一方面，学生用户因为急事匆忙离开，势必会无法学习到本人离开这段时间内老师所讲的内容。并且，学生在离开时往往难以记住当前已经学到课程的哪一部分，即便后续无法通过观看录播视频的方式来回顾老师所讲的内容，只能从头开始观看，这样效率也极低，学生的学习效果会比较差。在一些实施例中，以上第一触发行为还可以包括但不限于一些用户主动触发的行为，例如：学生在摄像头前所做的特定手势，或者特定的面部表情。S104：第一学生用户终端向服务端上报携带第一学生用户终端对应的用户ID和第一时间戳的第一信息。当检测到第一触发行为后，第一学生用户终端可以向服务端上报携带所述第一学生用户终端对应的用户ID和第一时间戳的第一信息。该第一时间戳可以是与学生用户离开屏幕前时老师所讲到的课程内容的位置所对应的。例如，本次课程内容总共2小时，第一时间戳例如为26:44。S105：服务端在接收到上述第一信息后，记录用户ID和第一时间戳的映射关系。服务端需要维护每一用户的缺席课程时间段信息，以方便进行网络资源的分配及向缺席学生用户推荐各自适合的录播学习内容。S106：服务端停止向第一学生用户终端下发来自教师用户终端的直播源内容。因为第一学生用户终端的学生用户已经被确定为离开了学习环境，因此不需要消耗网络带宽，故服务器停止向该终端下发直播源内容，节约的带宽有利于保证其他用户的音视频传输稳定性。S107：服务端向所述第一学生用户终端发送休眠指令。如果不发送休眠指令，第一学生用户终端可能以为是网络连接问题所导致的暂时性的网络中断或者是直播数据的丢包，此时用户终端还会向服务端频繁发包请求恢复直播源的下发，并尝试建立视频会话，这显然会导致网络资源的消耗。发送休眠指令则可以解决这一问题。S108：第一学生用户终端在接收到休眠指令后，进入休眠模式并维持终端设备摄像头的用户行为检测功能。休眠模式中，第一学生用户终端所运行的直播应用APP会进行休眠，但是摄像头的用户行为检测功能扔需要开启，以用于检测学生用户随时回到屏幕前，从而能够及时地将课程画面展示给学生用户，第一时间继续参与课程学习。S109：第一学生用户终端检测到目标学生用户的行为属于第二触发行为之一，所述第二触发行为包括目标学生用户的面部恢复出现在摄像头的视场内并持续设定时长。S110：向服务端上报携带所述第一学生用户终端对应的用户ID和第二时间戳的第二信息。其中，第二时间戳可以是与学生用户再次出现在屏幕前时老师所讲到的课程内容的位置所对应的。例如，本次课程内容总共2小时，第二时间戳例如为36:40。S111：服务端在接收到所述第二信息后，记录所述用户ID和第二时间戳的映射关系。S112：服务端恢复向所述第一学生用户终端下发来自所述教师用户终端的直播源内容。S113：第一学生用户终端停止休眠模式并播放所述直播源内容。S114：服务端根据第一时间戳和第二时间戳，从所述教师用户终端的直播源内容截取从第一时间戳到第二时间戳的视频内容，生成第一视频片段。参照以上的例子，生成的第一视频片段是26:44～36:40这段时间对应的课程内容。S115：将第一视频片段的观看链接与所述用户ID进行关联。由于学生用户重新回到显示器前后，第一用户终端会自动切换到当前时刻网络直播课程老师所讲的内容，而对于他离开那段时间所讲的内容，一般无法现在进行学习，否则还会错过当前老师正在讲授的课程内容，所以，将上述生成的第一视频片段的观看链接与所述用户ID进行关联后，该学生用户便可以在本次直播课程结束后，点击以上链接进行补充学习。通过以上方案，解决了课程直播过程中部分学生离开所带来的导致网络资源浪费问题，最大限度地保证整个课程的会话质量；另一方面，通过自动识别学生用户的离开和回来，并自动记录时刻，根据所记录的时间截取针对性的漏学课程内容，供学生用户课后学习。此方案不需要用户人为进行操作，极大地提高了学校效率和用户体验。在一些实施例中，对于自我约束能力较差的学生人群，比如中小学学生，网络课程往往因为没有线下课程的监督力度，从而导致课程学习效果较差，当前加强监督力度的手段主要是由家长在家全程督促。但是对于家长不在孩子身边的情况，则完全依靠学生自身的自觉性。对于此，所述方法还可以包括如下步骤S201～S202：S201：服务端确定与所述目标学生用户关联的监督家长用户；S202：向所述监督家长用户的终端发送提醒信息，所述提醒信息表征所述目标学生用户缺席视频会话的时间段信息。其中，可以是通过短信或即时通信软件等方式向监督家长用户发送提醒信息。在一些实施例中，所述方法还可以包括如下步骤S301～S303：S301：服务端查询与所述第一学生用户终端关联的第二学生用户终端。S302：服务端向所述第二学生用户终端发送课程续上提醒信息。S303：服务端若接收到来自所述第二学生用户终端的续上确认反馈信息，则向所述第二学生用户终端下发来自所述教师用户终端的直播源内容。以下结合图3所示的场景来说明如下S301～S303所解决的问题。在家庭环境中，对于参与网络授课的用户来说，有时会因为急事被迫离开当前的屏幕前，但是所去往的另一环境可能又比较近，所以还有继续听课的需求。在该场景中，学生A正在房间1内的台式电脑10前参与网络课程的学习，该台式电脑10包括摄像头14，其屏幕上显示课程直播界面12。此时，学生A因此急事需要进入房间2，因此被迫需要离开该台式电脑10，但是学生A希望通过手机20继续参与网络课程的学习，此时学生A便携带手机20进入了房间2。在用户移动的这段时间内，首先，台式电脑10的摄像头会检测到用户面部的消失并超过设定时长，触发台式电脑10的课程直播画面的自动休眠。接下来，由于学生A预先已经将其个人使用的两台终端设备进行了关联，并将设备关联关系在服务器进行了存储。此后，服务端给手机20发送一则课程续上提醒信息，该信息可以是直播APP的通知消息，用户看到消息后，只需要通过手机20进行确认，表示同意继续参与网络课程的学习。此后，用户无需在手机20上输入入场验证码就可以继续参与课程的学习。并且，当用户从房间2回到房间1后，由于台式电脑10可以检测到用户回来了，台式电脑10的休眠状态自动解除，并恢复课程内容的直播，并且自动停止在手机20上进行课程直播。以上过程极大简化用户在不同终端上的操作步骤，省去了在不同设备上输入用户登录账号、输入进入会话的验证码等步骤，可以根据检测到的用户状态，在不同终端设备上进行课程直播内容的自动续播，用户的学习效率极高。在以上过程中，学生A从房间1移动到房间2，直至通过手机20续上直播画面，这个过程中可能会耗费较长时间，从而导致用户遗漏了老师所讲的重要内容。为此，在一实施例中，所述方法还可以包括如下步骤S401～403：S401：服务端记录所述第二学生用户终端的续上时刻。S402：服务端根据所述第一时间戳和所述续上时刻，从所述教师用户终端的直播源内容截取从第一时间戳到续上时刻的视频内容，生成第二视频片段；S403：将所述第二视频片段的观看链接与所述用户ID进行关联。虽然以上截取视频片段的方式是根据学生的离开和回来的时刻进行定制化的，在一定程度上切合了学生的实际需求，但是其还是存在一定的缺陷。其中，因为学生离开和回来的时刻通常是随机性的，如果学生回顾该课程的时间较为滞后，该学生很容易就忘记老师所讲课程的上下文，所以直接观看该段随机性的视频片段，可能会导致学生无法理解该片段中部分内容，课程的连续性较差，从而影响了学习效率和用户体验。因此，为了改善这一问题，以上步骤S114具体包括如下步骤S1141～S1143。其中，直播源内容划分为若干片段，每一片段对应一个起始时间戳和一个终止时间戳。优选的，服务端可以根据所述直播源内容的目录信息将所述直播源内容划分为多个片段。例如，假设当前课程预先分为了A、B、C、D四个大的章节，当然，老师可以根据需要，将每个大的章节又划分为对应的多个子章节，如此，最终每个大的章节或其下属的多个子章节均会对应一个起始时间戳和一个终止时间戳。S1141：服务端确定所述第一时间戳所属的第一片段，并获得该第一片段对应的起始时间戳。继续沿用以上例子，本次课程内容总共2小时，其中，预先分为了A、B、C55:29～78:11)、D四个大的章节。第一时间戳例如为26:44，则确定该第一时间戳所属的第一片段为B，则确定该第一片段B对应的起始时间戳25:38。S1142：服务端确定所述第二时间戳所属的第二片段，并获得该第二片段对应的终止时间戳。在以上例子中，如第二时间戳为36:40则。确定其所属的第二片段为B，则确定该第二片段B对应的终止时间戳为55:22。S1143：服务端从所述教师用户终端的直播源内容截取从所述起始时间戳到所述终止时间戳的视频内容，以生成第一视频片段；在以上例子中，所截取的第一视频片段为完整的章节B的内容。通过以上过程，可以保证缺席课程的学生始终可以学习到完整的章节内容，从而降低突兀感，提高用户体验和学习效果。在一实施例中，为了进一步降低服务端的资源消耗和存储资源的浪费，S1142和S1143之间还可以增加步骤S1144：服务端查询是否已存在从所述起始时间戳到所述终止时间戳的视频内容。若无，则服务端从所述教师用户终端的直播源内容截取从所述起始时间戳到所述终止时间戳的视频内容，以生成第一视频片段；若有，则服务端将已存在的视频内容确定为第一视频片段。因为参与同一在线课程的用户数很多，并且该课程可能是在不同时间段针对不同的学生人群进行播放，所以可能存在较多用户缺席了几乎相同的课程内容，此时，如果服务端针对每个缺席的学生，都截取一次视频，则势必会导致服务端的资源消耗压力较大。所以，服务端可以通过查询服务端已经存在的视频片段，并将已经存在的视频片段的链接分享给后续也缺陷了同样章节的学生，从而可以有效改善这一问题。
