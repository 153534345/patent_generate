标题title
适用于拍立方的自动拍照控制方法、系统及拍立方
摘要abst
本发明公开了一种适用于拍立方的自动拍照控制方法，包括：S1、基于YOLO的手势检测模型对摄像头获取的视频流的前N帧图像进行手势检测，得到手部区域；N≥3；S2、利用卡尔曼滤波对所述手部区域的目标运动状态建模，实时跟踪预测其在下一帧中的位置，得到待识别对象手势；S3、将所述待识别对象手势与预设的手势模板库中的参照手势进行比对以计算相似度；当计算得到的相似度大于设定阈值时，将所述待识别对象手势判定为拍照触发手势，并启动拍照倒计时；否则返回步骤S1；S4、在所述拍照倒计时结束时，控制所述相机进行拍照，得到原始图像；S5、利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。
权利要求书clms
1.一种适用于拍立方的自动拍照控制方法，其中，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，其特征在于，所述自动拍照控制方法包括：S1、基于YOLO的手势检测模型对摄像头获取的视频流的前N帧图像进行手势检测，得到手部区域；N≥3；S2、利用卡尔曼滤波对所述手部区域的目标运动状态建模，实时跟踪预测其在下一帧中的位置，得到待识别对象手势；S3、将所述待识别对象手势与预设的手势模板库中的参照手势进行比对以计算相似度；当计算得到的相似度大于设定阈值时，将所述待识别对象手势判定为拍照触发手势，并启动拍照倒计时；否则返回步骤S1；S4、在所述拍照倒计时结束时，控制所述相机进行拍照，得到原始图像；S5、利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。2.如权利要求1所述的适用于拍立方的自动拍照控制方法，其特征在于，在所述步骤S1中，所述手势检测模型包括输入单元、编码器和解码器，所述输入单元用于输入所述摄像头获取的视频流的前N帧图像，所述编码器用于对所述前N帧图像进行特征提取和特征融合，获得具有更加丰富信息的特征图；所述解码器将特征图解码为检测结果，从而获得手部区域；基于预设的手势检测训练数据集优化以下公式的损失函数L，通过梯度下降法不断迭代训练，得到最优的检测结果：其中，S2表示输出层特征图大小，即输入图像划分成网格的数量；B为每个网格Anchor的数量，表示第i个网格中的第j个Anchor是否负责这个对象预测，选择与真实框IoU最大的那个作为预测框；表示第i个网格中的第j个Anchor表示对这个物体预测不负责；xi,yi,wi,hi和分别表示每个真实标签和预测边框的中心坐标及宽和高，均在0到1之间，xi,yi,为相对单元格偏移量；Ci和分别表示真实框置信度和预测框置信度；pi和表示对应单元格真实物体类别概率和预测类别概率；classes表示物体类别数量；λcoord和λnoobj分别表示边界框坐标预测的损失权重和不包含物体的边界框的置信度预测损失权重。3.如权利要求1所述的适用于拍立方的自动拍照控制方法，其特征在于，在所述步骤S2中，卡尔曼滤波包括预测和更新过程，预测是根据前一时刻状态估计当前状态，而更新则是根据观测值修正预测信息，从而估计出最优状态；具体包括如下公式～公式：预测过程：更新过程：其中，表示由前一个状态得出的预测估计；表示对更新之后的最优估计；A表示状态转移矩阵；H表示观测矩阵；B表示输入控制矩阵；ut表示系统外部控制量；Q和R分别表示动态噪声协方差矩阵和测量噪声协方差矩阵；Kt表示t时刻的卡尔曼增益；表示预测误差协方差矩阵；Σt表示滤波误差协方差矩阵；根据上述过程，利用摄像头获取的视频流的前N帧图像检测得到的手部区域边界框进行跟踪器状态初始化，之后不断预测估计目标在下一帧中的位置，实现实时跟踪。4.根据权利要求1所述的适用于拍立方的自动拍照控制方法，其特征在于，在所述步骤S3中，首先将带有所述待识别对象手势的待识别图片与手势模板库中的参照手势图片缩放到相同大小，然后根据以下公式计算欧式距离，找出欧式距离最小的参照手势图片作为相似度最高的参照手势图片：其中，x表示为待识别图片，T表示手势模板库中的参照手势图片集合，t表示集合T中的元素，t*为欧式距离最小的元素；若找出的t*的欧式距离小于预设阈值，则判定t*与所述待识别对象手势的待识别图片的相似度大于设定阈值，从而所述待识别对象手势判定为拍照触发手势。5.根据权利要求1所述的适用于拍立方的自动拍照控制方法，其特征在于，在所述步骤S5中，所述生成式对抗网络包括生成器和判别器，所述生成器的实现过程如下公式所示，G＝F+X X为输入的原始图像，F为原始图像X经过特征学习模块F处理后得到的输出，所述特征学习模块F主要采用一种稀疏的连接的并行结构来提取特征，输入的原始图像X经卷积池化减少到原来的1/4的大小，之后在主干路径上保持分辨率不变，分支上分辨率为主支路的1/2，学习高级的语义特征，最后与拥有丰富结构信息的主支路混合并输出；所述判别器D的输入为X、G，经多层卷积提取特征之后，得到一个感受野比较大的分辨率比较小的特征图，并将其平均值后作为判别器得分。6.根据权利要求5所述的适用于拍立方的自动拍照控制方法，其特征在于，在整个模型训练过程中，D采用二元交叉熵作为损失函数；为了更好的生成所需的目标图像，生成器的损失目标在GANLoss基础上，加三个正则化项，计算数值距离的L1损失，计算多层级结构相似度感知损失和计算频域相似度的焦频损失，具体如下：条件GAN的目标损失函数可表示为如公式所示，LcGAN＝Ex,y+Ex 其中，G试图最小化这个目标，D试图最大化，即argminGmaxDLcGAN,x为输入的原始图像，y为目标图像；为了保证输入输出的一致性，引入L1损失进行约束如公式,LL1＝Ex,y为了使生成图像不丢失结构信息，引入结构相似度的度量如公式,LMS-SSIM＝1-MS_SSIM,y) 其中，MS_SSIM方法是以参考图像和原始图像信号为输入，依次应用低通滤波器对图像进行2倍的下采样；假设原始图像尺度为1，经过M-1次迭代得到最高的尺度为M；在第j个尺度上，通过如下公式和公式计算比较对比度和结构相似度，分别记为cj,y)和sj,y)：仅在尺度M处通过公式式计算亮度比较：其中，μG和μy分别表示生成图像和标签图像的均值，σG和σy表示方差；αM,βj,γj对应尺度上，亮度估计、对比度和结构相似度分量的重要性；为简化运算，令αj＝βj＝γj,C1、C2、C3皆为常数，避免不稳定,C1＝2,C2＝2,C3＝C2/2，取参数K1＝0.01,K2＝0.03,L是像素值的动态范围；为了进一步改善图像质量，引入频域之间的差距作为约束项，如下公式：其中，MxN表示图像大小，w频谱权值矩阵，为频域坐标，y,G对应的复频值；所以生成器总的优化目标如下公式：Ltotal＝LcGAN+αLL1+βLMS-SSIM+γLFFL其中，α、β和γ表示各损失值权重，根据实际训练的需要进行设置，越大说明对应的约束项权重，对总体目标损失影响越大；由此，通过梯度下降法，将不断迭代优化目标函数，得到最优解。7.一种适用于拍立方的自动拍照控制系统，其中，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，其特征在于，所述自动拍照控制系统包括：手势检测模块，基于YOLO的手势检测模型对摄像头获取的视频流的前N帧图像进行手势检测，得到手部区域；N≥3；手部跟踪模块，利用卡尔曼滤波对所述手部区域的目标运动状态建模，实时跟踪预测其在下一帧中的位置，得到待识别对象手势；手势识别模块，用于将所述待识别对象手势与预设的手势模板库中的参照手势进行比对以计算相似度；当计算得到的相似度大于设定阈值时，将所述待识别对象手势判定为拍照触发手势，并启动拍照倒计时；否则返回步骤S1；拍照控制模块，用于在所述拍照倒计时结束时，控制所述相机进行拍照，得到原始图像；图像美化处理模块，利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。8.根据权利要求7所述的适用于拍立方的自动拍照控制系统，其特征在于，在所述手势检测模块中，所述手势检测模型包括输入单元、编码器和解码器，所述输入单元用于输入所述摄像头获取的视频流的前N帧图像，所述编码器用于对所述前N帧图像进行特征提取和特征融合，获得具有更加丰富信息的特征图；所述解码器将特征图解码为检测结果，从而获得手部区域；基于预设的手势检测训练数据集优化以下公式的损失函数L，通过梯度下降法不断迭代训练，得到最优的检测结果：其中，S2表示输出层特征图大小，即输入图像划分成网格的数量；B为每个网格Anchor的数量，表示第i个网格中的第j个Anchor是否负责这个对象预测，选择与真实框IoU最大的那个作为预测框；表示第i个网格中的第j个Anchor表示对这个物体预测不负责；xi,yi,wi,hi和分别表示每个真实标签和预测边框的中心坐标及宽和高，均在0到1之间，xi,yi,为相对单元格偏移量；Ci和分别表示真实框置信度和预测框置信度；pi和表示对应单元格真实物体类别概率和预测类别概率；classes表示物体类别数量；λcoord和λnoobj分别表示边界框坐标预测的损失权重和不包含物体的边界框的置信度预测损失权重；在所述手部跟踪模块中，卡尔曼滤波包括预测和更新过程，预测是根据前一时刻状态估计当前状态，而更新则是根据观测值修正预测信息，从而估计出最优状态；具体包括如下公式～公式：预测过程：更新过程：其中，表示由前一个状态得出的预测估计；表示对更新之后的最优估计；A表示状态转移矩阵；H表示观测矩阵；B表示输入控制矩阵；ut表示系统外部控制量；Q和R分别表示动态噪声协方差矩阵和测量噪声协方差矩阵；Kt表示t时刻的卡尔曼增益；表示预测误差协方差矩阵；Σt表示滤波误差协方差矩阵；根据上述过程，利用摄像头获取的视频流的前N帧图像检测得到的手部区域边界框进行跟踪器状态初始化，之后不断预测估计目标在下一帧中的位置，实现实时跟踪；在所述手势识别模块中，首先将带有所述待识别对象手势的待识别图片与手势模板库中的参照手势图片缩放到相同大小，然后根据以下公式计算欧式距离，找出欧式距离最小的参照手势图片作为相似度最高的参照手势图片：其中，x表示为待识别图片，T表示手势模板库中的参照手势图片集合，t表示集合T中的元素，t*为欧式距离最小的元素；若找出的t*的欧式距离小于预设阈值，则判定t*与所述待识别对象手势的待识别图片的相似度大于设定阈值，从而所述待识别对象手势判定为拍照触发手势。9.根据权利要求7所述的适用于拍立方的自动拍照控制系统，其特征在于，在所述图像美化处理模块中，所述生成式对抗网络包括生成器和判别器，所述生成器的实现过程如下公式所示，G＝F+X X为输入的原始图像，F为原始图像X经过特征学习模块F处理后得到的输出，所述特征学习模块F主要采用一种稀疏的连接的并行结构来提取特征，输入的原始图像X经卷积池化减少到原来的1/4的大小，之后在主干路径上保持分辨率不变，分支上分辨率为主支路的1/2，学习高级的语义特征，最后与拥有丰富结构信息的主支路混合并输出；所述判别器D的输入为X、G，经多层卷积提取特征之后，得到一个感受野比较大的分辨率比较小的特征图，并将其平均值后作为判别器得分；在整个模型训练过程中，D采用二元交叉熵作为损失函数；为了更好的生成所需的目标图像，生成器的损失目标在GANLoss基础上，加三个正则化项，计算数值距离的L1损失，计算多层级结构相似度感知损失和计算频域相似度的焦频损失，具体如下：条件GAN的目标损失函数可表示为如公式所示，LcGAN＝Ex,y+Ex 其中，G试图最小化这个目标，D试图最大化，即argminGmaxDLcGAN,x为输入的原始图像，y为目标图像；为了保证输入输出的一致性，引入L1损失进行约束如公式,LL1＝Ex,y为了使生成图像不丢失结构信息，引入结构相似度的度量如公式,LMS-SSIM＝1-MS_SSIM,y) 其中，MS_SSIM方法是以参考图像和原始图像信号为输入，依次应用低通滤波器对图像进行2倍的下采样；假设原始图像尺度为1，经过M-1次迭代得到最高的尺度为M；在第j个尺度上，通过如下公式和公式计算比较对比度和结构相似度，分别记为cj,y)和sj,y)：仅在尺度M处通过公式式计算亮度比较：其中，μG和μy分别表示生成图像和标签图像的均值，σG和σy表示方差；αM,βj,γj对应尺度上，亮度估计、对比度和结构相似度分量的重要性；为简化运算，令αj＝βj＝γj,C1、C2、C3皆为常数，避免不稳定,C1＝2,C2＝2,C3＝C2/2，取参数K1＝0.01,K2＝0.03,L是像素值的动态范围；为了进一步改善图像质量，引入频域之间的差距作为约束项，如下公式：其中，MxN表示图像大小，w频谱权值矩阵，为频域坐标，y,G对应的复频值；所以生成器总的优化目标如下公式：Ltotal＝LcGAN+αLL1+βLMS-SSIM+γLFFL 其中，α、β和γ表示各损失值权重，根据实际训练的需要进行设置，越大说明对应的约束项权重，对总体目标损失影响越大；由此，通过梯度下降法，将不断迭代优化目标函数，得到最优解。10.一种拍立方，其特征在于，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，所述摄像头用于获取拍立方内待拍对象的视频流，并将所述视频流传输至所述控制处理器；所述控制处理器用于根据接收到的所述视频流控制所述相机进行拍照并对拍照得到的图像进行处理后输出；其中，所述控制处理器被设置为能够执行如权利要求1～6任一项所述的适用于拍立方的自动拍照控制方法。
说明书desc
技术领域本发明涉及自助拍照技术领域，尤其涉及一种适用于拍立方的自动拍照控制方法、系统及拍立方。背景技术拍立方，也称智能拍照盒子或智能拍照亭，是放置在街头、地铁站等人流量较大的公共场所，便于用户简单便捷的拍摄高清照片或者证件照等的自助拍照设备，非常受到人们追捧，遍布所有的商超百货、高校、旅游景点、车站、机场等公共场所。本发明人实施本发明的过程中发现，现有的拍立方在拍照控制方式和拍照图像质量方面还有可以进一步改善的空间，本发明着力于简化拍立方的自助拍照控制方式和提高拍照图像的质量。发明内容本发明的目的在于提供一种适用于拍立方的自动拍照控制方法、系统及拍立方，其能够有效解决现有技术中所存在的上述技术问题。为了实现上述目的，本发明的一实施例提供了一种适用于拍立方的自动拍照控制方法，其中，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，所述自动拍照控制方法包括：S1、基于YOLO的手势检测模型对摄像头获取的视频流的前N帧图像进行手势检测，得到手部区域；N≥3；S2、利用卡尔曼滤波对所述手部区域的目标运动状态建模，实时跟踪预测其在下一帧中的位置，得到待识别对象手势；S3、将所述待识别对象手势与预设的手势模板库中的参照手势进行比对以计算相似度；当计算得到的相似度大于设定阈值时，将所述待识别对象手势判定为拍照触发手势，并启动拍照倒计时；否则返回步骤S1；S4、在所述拍照倒计时结束时，控制所述相机进行拍照，得到原始图像；S5、利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。较佳地，在所述步骤S1中，所述手势检测模型包括输入单元、编码器和解码器，所述输入单元用于输入所述摄像头获取的视频流的前N帧图像，所述编码器用于对所述前N帧图像进行特征提取和特征融合，获得具有更加丰富信息的特征图；所述解码器将特征图解码为检测结果，从而获得手部区域；基于预设的手势检测训练数据集优化以下公式的损失函数L，通过梯度下降法不断迭代训练，得到最优的检测结果：其中，S2表示输出层特征图大小，即输入图像划分成网格的数量；B为每个网格Anchor的数量，表示第i个网格中的第j个Anchor是否负责这个对象预测，选择与真实框IoU最大的那个作为预测框；表示第i个网格中的第j个Anchor表示对这个物体预测不负责；xi,yi,wi,hi和分别表示每个真实标签和预测边框的中心坐标及宽和高，均在0到1之间，xi,yi,为相对单元格偏移量；Ci和分别表示真实框置信度和预测框置信度；pi和表示对应单元格真实物体类别概率和预测类别概率；classes表示物体类别数量；λcoord和λnoobj分别表示边界框坐标预测的损失权重和不包含物体的边界框的置信度预测损失权重。较佳地，在所述步骤S2中，卡尔曼滤波包括预测和更新过程，预测是根据前一时刻状态估计当前状态，而更新则是根据观测值修正预测信息，从而估计出最优状态；具体包括如下公式～公式：预测过程：更新过程：其中，表示由前一个状态得出的预测估计；表示对更新之后的最优估计；A表示状态转移矩阵；H表示观测矩阵；B表示输入控制矩阵；ut表示系统外部控制量；Q和R分别表示动态噪声协方差矩阵和测量噪声协方差矩阵；Kt表示t时刻的卡尔曼增益；表示预测误差协方差矩阵；Σt表示滤波误差协方差矩阵；根据上述过程，利用摄像头获取的视频流的前N帧图像检测得到的手部区域边界框进行跟踪器状态初始化，之后不断预测估计目标在下一帧中的位置，实现实时跟踪。较佳地，在所述步骤S3中，首先将带有所述待识别对象手势的待识别图片与手势模板库中的参照手势图片缩放到相同大小，然后根据以下公式计算欧式距离，找出欧式距离最小的参照手势图片作为相似度最高的参照手势图片：其中，x表示为待识别图片，T表示手势模板库中的参照手势图片集合，t表示集合T中的元素，t*为欧式距离最小的元素；若找出的t*的欧式距离小于预设阈值，则判定t*与所述待识别对象手势的待识别图片的相似度大于设定阈值，从而所述待识别对象手势判定为拍照触发手势。较佳地，在所述步骤S5中，所述生成式对抗网络包括生成器和判别器，所述生成器的实现过程如下公式所示，G＝F+X X为输入的原始图像，F为原始图像X经过特征学习模块F处理后得到的输出，所述特征学习模块F主要采用一种稀疏的连接的并行结构来提取特征，输入的原始图像X经卷积池化减少到原来的1/4的大小，之后在主干路径上保持分辨率不变，分支上分辨率为主支路的1/2，学习高级的语义特征，最后与拥有丰富结构信息的主支路混合并输出；所述判别器D的输入为X、G，经多层卷积提取特征之后，得到一个感受野比较大的分辨率比较小的特征图，并将其平均值后作为判别器得分。较佳地，在整个模型训练过程中，D采用二元交叉熵作为损失函数；为了更好的生成所需的目标图像，生成器的损失目标在GANLoss基础上，加三个正则化项，计算数值距离的L1损失，计算多层级结构相似度感知损失和计算频域相似度的焦频损失，具体如下：条件GAN的目标损失函数可表示为如公式所示，LcGAN＝Ex,y+Ex 其中，G试图最小化这个目标，D试图最大化，即argminGmaxDLcGAN,x为输入的原始图像，y为目标图像；为了保证输入输出的一致性，引入L1损失进行约束如公式,LL1＝Ex,y为了使生成图像不丢失结构信息，引入结构相似度的度量如公式,LMS-SSIM＝1-MS_SSIM,y) 其中，MS_SSIM方法是以参考图像和原始图像信号为输入，依次应用低通滤波器对图像进行2倍的下采样；假设原始图像尺度为1，经过M-1次迭代得到最高的尺度为M；在第j个尺度上，通过如下公式和公式计算比较对比度和结构相似度，分别记为cj,y)和sj,y)：仅在尺度M处通过公式式计算亮度比较：其中，μG和μy分别表示生成图像和标签图像的均值，σG和σy表示方差；αM,βj,γj对应尺度上，亮度估计、对比度和结构相似度分量的重要性；为简化运算，令αj＝βj＝γj,C1、C2、C3皆为常数，避免不稳定,C1＝2,C2＝2,C3＝C2/2，取参数K1＝0.01,K2＝0.03,L是像素值的动态范围；为了进一步改善图像质量，引入频域之间的差距作为约束项，如下公式：其中，MxN表示图像大小，w频谱权值矩阵，为频域坐标，y,G对应的复频值；所以生成器总的优化目标如下公式：Ltotal＝LcGAN+αLL1+βLMS-SSIM+γLFFL其中，α、β和γ表示各损失值权重，根据实际训练的需要进行设置，越大说明对应的约束项权重，对总体目标损失影响越大；由此，通过梯度下降法，将不断迭代优化目标函数，得到最优解。本发明实施例对应提供一种适用于拍立方的自动拍照控制系统，其中，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，所述自动拍照控制系统包括：手势检测模块，基于YOLO的手势检测模型对摄像头获取的视频流的前N帧图像进行手势检测，得到手部区域；N≥3；手部跟踪模块，利用卡尔曼滤波对所述手部区域的目标运动状态建模，实时跟踪预测其在下一帧中的位置，得到待识别对象手势；手势识别模块，用于将所述待识别对象手势与预设的手势模板库中的参照手势进行比对以计算相似度；当计算得到的相似度大于设定阈值时，将所述待识别对象手势判定为拍照触发手势，并启动拍照倒计时；否则返回步骤S1；拍照控制模块，用于在所述拍照倒计时结束时，控制所述相机进行拍照，得到原始图像；图像美化处理模块，利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。较佳地，在所述手势检测模块中，所述手势检测模型包括输入单元、编码器和解码器，所述输入单元用于输入所述摄像头获取的视频流的前N帧图像，所述编码器用于对所述前N帧图像进行特征提取和特征融合，获得具有更加丰富信息的特征图；所述解码器将特征图解码为检测结果，从而获得手部区域；基于预设的手势检测训练数据集优化以下公式的损失函数L，通过梯度下降法不断迭代训练，得到最优的检测结果：其中，S2表示输出层特征图大小，即输入图像划分成网格的数量；B为每个网格Anchor的数量，表示第i个网格中的第j个Anchor是否负责这个对象预测，选择与真实框IoU最大的那个作为预测框；表示第i个网格中的第j个Anchor表示对这个物体预测不负责；xi,yi,wi,hi和分别表示每个真实标签和预测边框的中心坐标及宽和高，均在0到1之间，xi,yi,为相对单元格偏移量；Ci和分别表示真实框置信度和预测框置信度；pi和表示对应单元格真实物体类别概率和预测类别概率；classes表示物体类别数量；λcoord和λnoobj分别表示边界框坐标预测的损失权重和不包含物体的边界框的置信度预测损失权重；在所述手部跟踪模块中，卡尔曼滤波包括预测和更新过程，预测是根据前一时刻状态估计当前状态，而更新则是根据观测值修正预测信息，从而估计出最优状态；具体包括如下公式～公式：预测过程：更新过程：其中，表示由前一个状态得出的预测估计；表示对更新之后的最优估计；A表示状态转移矩阵；H表示观测矩阵；B表示输入控制矩阵；ut表示系统外部控制量；Q和R分别表示动态噪声协方差矩阵和测量噪声协方差矩阵；Kt表示t时刻的卡尔曼增益；表示预测误差协方差矩阵；Σt表示滤波误差协方差矩阵；根据上述过程，利用摄像头获取的视频流的前N帧图像检测得到的手部区域边界框进行跟踪器状态初始化，之后不断预测估计目标在下一帧中的位置，实现实时跟踪；在所述手势识别模块中，首先将带有所述待识别对象手势的待识别图片与手势模板库中的参照手势图片缩放到相同大小，然后根据以下公式计算欧式距离，找出欧式距离最小的参照手势图片作为相似度最高的参照手势图片：其中，x表示为待识别图片，T表示手势模板库中的参照手势图片集合，t表示集合T中的元素，t*为欧式距离最小的元素；若找出的t*的欧式距离小于预设阈值，则判定t*与所述待识别对象手势的待识别图片的相似度大于设定阈值，从而所述待识别对象手势判定为拍照触发手势。较佳地，在所述图像美化处理模块中，所述生成式对抗网络包括生成器和判别器，所述生成器的实现过程如下公式所示，G＝F+X X为输入的原始图像，F为原始图像X经过特征学习模块F处理后得到的输出，所述特征学习模块F主要采用一种稀疏的连接的并行结构来提取特征，输入的原始图像X经卷积池化减少到原来的1/4的大小，之后在主干路径上保持分辨率不变，分支上分辨率为主支路的1/2，学习高级的语义特征，最后与拥有丰富结构信息的主支路混合并输出；所述判别器D的输入为X、G，经多层卷积提取特征之后，得到一个感受野比较大的分辨率比较小的特征图，并将其平均值后作为判别器得分；在整个模型训练过程中，D采用二元交叉熵作为损失函数；为了更好的生成所需的目标图像，生成器的损失目标在GANLoss基础上，加三个正则化项，计算数值距离的L1损失，计算多层级结构相似度感知损失和计算频域相似度的焦频损失，具体如下：条件GAN的目标损失函数可表示为如公式所示，LcGAN＝Ex,y+Ex 其中，G试图最小化这个目标，D试图最大化，即argminGmaxDLcGAN,x为输入的原始图像，y为目标图像；为了保证输入输出的一致性，引入L1损失进行约束如公式,LL1＝Ex,y为了使生成图像不丢失结构信息，引入结构相似度的度量如公式,LMS-SSIM＝1-MS_SSIM,y) 其中，MS_SSIM方法是以参考图像和原始图像信号为输入，依次应用低通滤波器对图像进行2倍的下采样；假设原始图像尺度为1，经过M-1次迭代得到最高的尺度为M；在第j个尺度上，通过如下公式和公式计算比较对比度和结构相似度，分别记为cj,y)和sj,y)：仅在尺度M处通过公式式计算亮度比较：其中，μG和μy分别表示生成图像和标签图像的均值，σG和σy表示方差；αM,βj,γj对应尺度上，亮度估计、对比度和结构相似度分量的重要性；为简化运算，令αj＝βj＝γj,C1、C2、C3皆为常数，避免不稳定,C1＝2,C2＝2,C3＝C2/2，取参数K1＝0.01,K2＝0.03,L是像素值的动态范围；为了进一步改善图像质量，引入频域之间的差距作为约束项，如下公式：其中，MxN表示图像大小，w频谱权值矩阵，为频域坐标，y,G对应的复频值；所以生成器总的优化目标如下公式：Ltotal＝LcGAN+αLL1+βLMS-SSIM+γLFFL 其中，α、β和γ表示各损失值权重，根据实际训练的需要进行设置，越大说明对应的约束项权重，对总体目标损失影响越大；由此，通过梯度下降法，将不断迭代优化目标函数，得到最优解。本发明实施例还提供一种拍立方，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，所述摄像头用于获取拍立方内待拍对象的视频流，并将所述视频流传输至所述控制处理器；所述控制处理器用于根据接收到的所述视频流控制所述相机进行拍照并对拍照得到的图像进行处理后输出；其中，所述控制处理器被设置为能够执行如上任一实施例所述的适用于拍立方的自动拍照控制方法。与现有技术先相比，本发明实施例提供的一种适用于拍立方的自动拍照控制方法、系统及拍立方，能够有效简化拍立方的自动拍照，拍照者无需触动任何物理按钮，通过手势便能自动触发相机完成拍照，而且，通过相机拍照得到的图像会经过人像脸部皮肤处理，让肤质看起来更有质感健康美观，从而提高拍照照片的图像质量，有效提高用户的使用体验。附图说明为了更清楚地说明本发明的技术方案，下面将对实施方式中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例提供的一种适用于拍立方的自动拍照控制方法的流程示意图。图2是本发明实施例提供的一种适用于拍立方的自动拍照控制方法中涉及的手势检测模型的结构示意图。图3是本发明实施例提供的一种适用于拍立方的自动拍照控制方法中涉及的生成式对抗网络的生成器的结构示意图。图4是本发明实施例提供的一种适用于拍立方的自动拍照控制方法中涉及的生成式对抗网络的特征学习模块的结构示意图。图5是本发明实施例提供的一种适用于拍立方的自动拍照控制方法中涉及的生成式对抗网络的判别器的结构示意图。图6是本发明实施例提供的一种适用于拍立方的自动拍照控制系统的结构示意图。图7是本发明实施例提供的一种拍立方的结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要理解的是，术语“中心”、“纵向”、“横向”、“长度”、“宽度”、“厚度”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”、“内”、“外”、“顺时针”、“逆时针”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二“仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本发明的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。在本发明中，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”、“固定”等术语应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或成一体；可以是机械连接，也可以是电连接或可以互相通讯；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通或两个元件的相互作用关系。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。参考图1，本发明实施例提供了一种适用于拍立方的自动拍照控制方法，其中，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，所述自动拍照控制方法包括：S1、基于YOLO的手势检测模型对摄像头获取的视频流的前N帧图像进行手势检测，得到手部区域；N≥3；S2、利用卡尔曼滤波对所述手部区域的目标运动状态建模，实时跟踪预测其在下一帧中的位置，得到待识别对象手势；S3、将所述待识别对象手势与预设的手势模板库中的参照手势进行比对以计算相似度；当计算得到的相似度大于设定阈值时，将所述待识别对象手势判定为拍照触发手势，并启动拍照倒计时；否则返回步骤S1；S4、在所述拍照倒计时结束时，控制所述相机进行拍照，得到原始图像；S5、利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。具体的，如图2所示，在所述步骤S1中，所述手势检测模型包括输入单元21、编码器22和解码器23，所述输入单元21用于输入所述摄像头获取的视频流的前N帧图像，所述编码器22用于对所述前N帧图像进行特征提取和特征融合，获得具有更加丰富信息的特征图；所述解码器23将特征图解码为检测结果，从而获得手部区域；这里，特征提取骨干网络三阶段一次由2x、4x、6x Mobilenetv2 block组成，特征融合采用FPN进行特征图融合，解码部分YOLO回归分类。具体的，基于预设的手势检测训练数据集优化以下公式的损失函数L，通过梯度下降法不断迭代训练，得到最优的检测结果：其中，S2表示输出层特征图大小，即输入图像划分成网格的数量；B为每个网格Anchor的数量，表示第i个网格中的第j个Anchor是否负责这个对象预测，选择与真实框IoU最大的那个作为预测框；表示第i个网格中的第j个Anchor表示对这个物体预测不负责；xi,yi,wi,hi和分别表示每个真实标签和预测边框的中心坐标及宽和高，均在0到1之间，xi,yi,为相对单元格偏移量；Ci和分别表示真实框置信度和预测框置信度；pi和表示对应单元格真实物体类别概率和预测类别概率；classes表示物体类别数量；λcoord和λnoobj分别表示边界框坐标预测的损失权重和不包含物体的边界框的置信度预测损失权重。可以理解的，预设的手势检测训练数据集约2万多张，类别包括手掌、拳头、大拇指、单手比心、剪刀手和其他。在此手势检测过程中，并不关心手势的类别，主要利用其定位的功能。在此数据集上优化上述目标函数，通过梯度下降法不断迭代训练，得到最优解。进一步的，在所述步骤S2中，卡尔曼滤波包括预测和更新过程，预测是根据前一时刻状态估计当前状态，而更新则是根据观测值修正预测信息，从而估计出最优状态；具体包括如下公式～公式：预测过程：更新过程：其中，表示由前一个状态得出的预测估计；表示对更新之后的最优估计；A表示状态转移矩阵；H表示观测矩阵；B表示输入控制矩阵；ut表示系统外部控制量；Q和R分别表示动态噪声协方差矩阵和测量噪声协方差矩阵；Kt表示t时刻的卡尔曼增益；表示预测误差协方差矩阵；Σt表示滤波误差协方差矩阵；根据上述过程，利用摄像头获取的视频流的前N帧图像检测得到的手部区域边界框进行跟踪器状态初始化，之后不断预测估计目标在下一帧中的位置，实现实时跟踪。进一步的，在所述步骤S3中，首先将带有所述待识别对象手势的待识别图片与手势模板库中的参照手势图片缩放到相同大小，然后根据以下公式计算欧式距离，找出欧式距离最小的参照手势图片作为相似度最高的参照手势图片：其中，x表示为待识别图片，T表示手势模板库中的参照手势图片集合，t表示集合T中的元素，t*为欧式距离最小的元素；若找出的t*的欧式距离小于预设阈值，则判定t*与所述待识别对象手势的待识别图片的相似度大于设定阈值，从而所述待识别对象手势判定为拍照触发手势。这里手势模板匹配的过程，可以描述为求解一个点到集合中各个元素点的距离，而最佳匹配就是找出该点到集合中元素距离最小的那个点，记t*。可见，首先通过建立模板库，收集一些从多个不同角度拍摄的各类手势图片，类别包括“手掌”、“拳头”、“大拇指”、“单手比心”、“剪刀手”、“其他”，共分6类。之后将待识别图片和模板图片缩放到相同大小，根据式对应像素计算欧式距离，找出相似度最高的模板图片，即距离最小的模板。如果其距离小于设定阈值，说明两张图片非常接近，从而判定t*类别即为待测图片识别结果。进一步的，参考图3～图5，在所述步骤S5中，利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。该人脸美化处理主要祛除脸部瑕疵及实现磨皮功能，让肤质看起来更有质感健康美观，从而提高拍照照片的图像质量。具体的，所述生成式对抗网络包括生成器和判别器，图4是图3中的F函数详细构图。考虑到输出图像G是输入图像X的纹理、色彩等特征的微小变化，为了保证生成图像质量，生成器采用残差结构，学习偏差F使得模型更容易学习收敛。所述生成器的实现过程如下公式所示，G＝F+X X为输入的原始图像，F为原始图像X经过特征学习模块F处理后得到的输出，所述特征学习模块F主要采用一种稀疏的连接的并行结构来提取特征，输入的原始图像X经卷积池化减少到原来的1/4的大小，之后在主干路径上保持分辨率不变，分支上分辨率为主支路的1/2，学习高级的语义特征，最后与拥有丰富结构信息的主支路混合并输出。所述判别器D的输入为X、G，经多层卷积提取特征之后，得到一个感受野比较大的分辨率比较小的特征图，并将其平均值后作为判别器得分。其中，在整个模型训练过程中，D采用二元交叉熵作为损失函数；为了更好的生成所需的目标图像，生成器的损失目标在GAN Loss基础上，加三个正则化项，计算数值距离的L1损失，计算多层级结构相似度感知损失和计算频域相似度的焦频损失，具体如下：条件GAN的目标损失函数可表示为如公式所示，LcGAN＝Ex,y+Ex其中，G试图最小化这个目标，D试图最大化，即argminGmaxDLcGAN,x为输入的原始图像，y为目标图像；为了保证输入输出的一致性，引入L1损失进行约束如公式,LL1＝Ex,y为了使生成图像不丢失结构信息，引入结构相似度的度量如公式,LMS-SSIM＝1-MS_SSIM,y) 其中，MS_SSIM方法是以参考图像和原始图像信号为输入，依次应用低通滤波器对图像进行2倍的下采样；假设原始图像尺度为1，经过M-1次迭代得到最高的尺度为M；在第j个尺度上，通过如下公式和公式计算比较对比度和结构相似度，分别记为cj,y)和sj,y)：仅在尺度M处通过公式式计算亮度比较：其中，μG和μy分别表示生成图像和标签图像的均值，σG和σy表示方差；αM,βj,γj对应尺度上，亮度估计、对比度和结构相似度分量的重要性；为简化运算，令αj＝βj＝γj,C1、C2、C3皆为常数，避免不稳定,C1＝2,C2＝2,C3＝C2/2，取参数K1＝0.01,K2＝0.03,L是像素值的动态范围；为了进一步改善图像质量，引入频域之间的差距作为约束项，如下公式：其中，MxN表示图像大小，w频谱权值矩阵，为频域坐标，y,G对应的复频值；所以生成器总的优化目标如下公式：Ltotal＝LcGAN+αLL1+βLMS-SSIM+γLFFL 其中，α、β和γ表示各损失值权重，根据实际训练的需要进行设置，越大说明对应的约束项权重，对总体目标损失影响越大；由此，通过梯度下降法，将不断迭代优化目标函数，得到最优解。参考图6，本发明实施例提供一种适用于拍立方的自动拍照控制系统，其中，所述拍立方包括控制处理器以及分别与所述控制处理器通信的摄像头和相机，所述自动拍照控制系统包括：手势检测模块61，基于YOLO的手势检测模型对摄像头获取的视频流的前N帧图像进行手势检测，得到手部区域；N≥3；手部跟踪模块62，利用卡尔曼滤波对所述手部区域的目标运动状态建模，实时跟踪预测其在下一帧中的位置，得到待识别对象手势；手势识别模块63，用于将所述待识别对象手势与预设的手势模板库中的参照手势进行比对以计算相似度；当计算得到的相似度大于设定阈值时，将所述待识别对象手势判定为拍照触发手势，并启动拍照倒计时；否则返回步骤S1；拍照控制模块64，用于在所述拍照倒计时结束时，控制所述相机进行拍照，得到原始图像；图像美化处理模块65，利用构建的生成式对抗网络对所述原始图像进行人脸美化处理，得到处理后的目标图像并输出。具体的，在所述手势检测模块61中，如图2所示，所述手势检测模型包括输入单元21、编码器22和解码器23，所述输入单元21用于输入所述摄像头获取的视频流的前N帧图像，所述编码器22用于对所述前N帧图像进行特征提取和特征融合，获得具有更加丰富信息的特征图；所述解码器23将特征图解码为检测结果，从而获得手部区域；基于预设的手势检测训练数据集优化以下公式的损失函数L，通过梯度下降法不断迭代训练，得到最优的检测结果：其中，S2表示输出层特征图大小，即输入图像划分成网格的数量；B为每个网格Anchor的数量，表示第i个网格中的第j个Anchor是否负责这个对象预测，选择与真实框IoU最大的那个作为预测框；表示第i个网格中的第j个Anchor表示对这个物体预测不负责；xi,yi,wi,hi和分别表示每个真实标签和预测边框的中心坐标及宽和高，均在0到1之间，xi,yi,为相对单元格偏移量；Ci和分别表示真实框置信度和预测框置信度；pi和表示对应单元格真实物体类别概率和预测类别概率；classes表示物体类别数量；λcoord和λnoobj分别表示边界框坐标预测的损失权重和不包含物体的边界框的置信度预测损失权重；具体的，在所述手部跟踪模块92中，卡尔曼滤波包括预测和更新过程，预测是根据前一时刻状态估计当前状态，而更新则是根据观测值修正预测信息，从而估计出最优状态；具体包括如下公式～公式：预测过程：更新过程：其中，表示由前一个状态得出的预测估计；表示对更新之后的最优估计；A表示状态转移矩阵；H表示观测矩阵；B表示输入控制矩阵；ut表示系统外部控制量；Q和R分别表示动态噪声协方差矩阵和测量噪声协方差矩阵；Kt表示t时刻的卡尔曼增益；表示预测误差协方差矩阵；Σt表示滤波误差协方差矩阵；根据上述过程，利用摄像头获取的视频流的前N帧图像检测得到的手部区域边界框进行跟踪器状态初始化，之后不断预测估计目标在下一帧中的位置，实现实时跟踪；进一步的，在所述手势识别模块63中，首先将带有所述待识别对象手势的待识别图片与手势模板库中的参照手势图片缩放到相同大小，然后根据以下公式计算欧式距离，找出欧式距离最小的参照手势图片作为相似度最高的参照手势图片：其中，x表示为待识别图片，T表示手势模板库中的参照手势图片集合，t表示集合T中的元素，t*为欧式距离最小的元素；若找出的t*的欧式距离小于预设阈值，则判定t*与所述待识别对象手势的待识别图片的相似度大于设定阈值，从而所述待识别对象手势判定为拍照触发手势。进一步的，在所述图像美化处理模块65中，所述生成式对抗网络包括生成器和判别器，所述生成器的实现过程如下公式所示，G＝F+X X为输入的原始图像，F为原始图像X经过特征学习模块F处理后得到的输出，所述特征学习模块F主要采用一种稀疏的连接的并行结构来提取特征，输入的原始图像X经卷积池化减少到原来的1/4的大小，之后在主干路径上保持分辨率不变，分支上分辨率为主支路的1/2，学习高级的语义特征，最后与拥有丰富结构信息的主支路混合并输出；所述判别器D的输入为X、G，经多层卷积提取特征之后，得到一个感受野比较大的分辨率比较小的特征图，并将其平均值后作为判别器得分；在整个模型训练过程中，D采用二元交叉熵作为损失函数；为了更好的生成所需的目标图像，生成器的损失目标在GANLoss基础上，加三个正则化项，计算数值距离的L1损失，计算多层级结构相似度感知损失和计算频域相似度的焦频损失，具体如下：条件GAN的目标损失函数可表示为如公式所示，LcGAN＝Ex,y+Ex 其中，G试图最小化这个目标，D试图最大化，即argminGmaxDLcGAN,x为输入的原始图像，y为目标图像；为了保证输入输出的一致性，引入L1损失进行约束如公式,LL1＝Ex,y为了使生成图像不丢失结构信息，引入结构相似度的度量如公式,LMS-SSIM＝1-MS_SSIM,y) 其中，MS_SSIM方法是以参考图像和原始图像信号为输入，依次应用低通滤波器对图像进行2倍的下采样；假设原始图像尺度为1，经过M-1次迭代得到最高的尺度为M；在第j个尺度上，通过如下公式和公式计算比较对比度和结构相似度，分别记为cj,y)和sj,y)：仅在尺度M处通过公式式计算亮度比较：其中，μG和μy分别表示生成图像和标签图像的均值，σG和σy表示方差；αM,βj,γj对应尺度上，亮度估计、对比度和结构相似度分量的重要性；为简化运算，令αj＝βj＝γj,C1、C2、C3皆为常数，避免不稳定,C1＝2,C2＝2,C3＝C2/2，取参数K1＝0.01,K2＝0.03,L是像素值的动态范围；为了进一步改善图像质量，引入频域之间的差距作为约束项，如下公式：其中，MxN表示图像大小，w频谱权值矩阵，为频域坐标，y,G对应的复频值；所以生成器总的优化目标如下公式：Ltotal＝LcGAN+αLL1+βLMS-SSIM+γLFFL其中，α、β和γ表示各损失值权重，根据实际训练的需要进行设置，越大说明对应的约束项权重，对总体目标损失影响越大；由此，通过梯度下降法，将不断迭代优化目标函数，得到最优解。参考图7，本本发明实施例提供一种拍立方，所述拍立方包括控制处理器1以及分别与所述控制处理器1通信的摄像头2和相机3，所述摄像头2用于获取拍立方内待拍对象的视频流，并将所述视频流传输至所述控制处理器1；所述控制处理器1用于根据接收到的所述视频流控制所述相机3进行拍照并对拍照得到的图像进行处理后输出；其中，所述控制处理器1被设置为能够执行如上任一实施例所述的适用于拍立方的自动拍照控制方法。综上，本发明实施例提供的一种适用于拍立方的自动拍照控制方法、系统及拍立方，能够有效简化拍立方的自动拍照，拍照者无需触动任何物理按钮，通过手势便能自动触发相机完成拍照，而且，通过相机拍照得到的图像会经过人像脸部皮肤处理，让肤质看起来更有质感健康美观，从而提高拍照照片的图像质量，有效提高用户的使用体验。以上所揭露的仅为本发明一些较佳实施例而已，当然不能以此来限定本发明之权利范围，本领域普通技术人员可以理解实现上述实施例的全部或部分流程，并依本发明权利要求所作的等同变化，仍属于发明所涵盖的范围。
