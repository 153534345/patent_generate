标题title
一种利用观测数据构建路网设施拓扑结构的方法
摘要abst
本发明涉及一种利用观测数据构建路网设施拓扑结构的方法，包括：以车辆为单位构建观测行程记录序列；基于观测行程记录序列提取涉及的设施点作为顶点，设施间拓扑关系作为候选边，并根据顶点出入流量将顶点属性划分为中间点、入口点和出口点；以拓扑中各中间节点的流入与流出净差值的总和作为模型目标函数，以最小化模型目标函数为目标，结合顶点和边的约束，建立拓扑模型；基于启发式算法求解所述拓扑模型，获得最优解。本发明利用路网路侧设备自身的观测数据实现路侧设备拓扑关系的动态构建，极大程度减少人工标注的工作，同时不依赖空间几何计算，在构建的过程中不依赖无需设备位置信息与路网地理信息数据。
权利要求书clms
1.一种利用观测数据构建路网设施拓扑结构的方法，其特征在于，包括：通过开窗或抽样从原始数据中获取车辆观测数据，并进行数据清理，之后以车辆为单位，按照数据的观测时间顺序排列，构建观测行程记录序列；基于观测行程记录序列提取涉及的设施点作为顶点，设施间拓扑关系作为候选边，并根据顶点出入流量将顶点属性划分为中间点、入口点和出口点；以拓扑中各中间节点的流入与流出净差值的总和作为模型目标函数，以最小化模型目标函数为目标，结合顶点和边的约束，建立拓扑模型；基于启发式算法求解所述拓扑模型，获得最优解，即构建的路网设施拓扑结构。2.根据权利要求1所述的方法，其特征在于，在构建观测行程记录序列之前，对行程记录数据进行筛选，包括基于行程记录的车辆信息和行程特性进行筛选；以及基于车辆信息筛选构建拓扑的行程记录，并利用行程特性剔除指标值离群的行程记录。3.根据权利要求1所述的方法，其特征在于，在数据开窗时，窗口大小的确定方式为：1）按照不同窗口大小对原始数据进行分组多批次采样；2）对样本数据进行预处理并建立观测行程记录序列；3）采用平均值或中位数对行程记录的设施数按窗口和抽样批次进行统计分析，找到窗口增大、获得设备数增加但边际收益增量下降的位置，即为最优窗口大小。4.根据权利要求1所述的方法，其特征在于，根据顶点出入流量计算流量平衡度，基于流量平衡度划分顶点属性，包括：对所有顶点，分别计算其流出量总和及流入量总和；定义流量平衡度为；根据实际建模时的平衡度分布直方图确定流量平衡度阈值上下限，将流量平衡度小于阈值下限的顶点划分为出口点，流量平衡度大于阈值下限的顶点划分为入口点，其余为中间点。5.根据权利要求1所述的方法，其特征在于，所述顶点和边约束包括：约束任意顶点的入度与出度上限；约束任意中间点的入度与出度下限；约束入口点仅存在连出边，出口点仅存在连入边；排除没有实际观测流量的边及自环边。6.根据权利要求1所述的方法，其特征在于，利用模拟退火算法求解所述拓扑模型。7.根据权利要求6所述的方法，其特征在于，拓扑模型求解时，迭代过程中拓扑结构的调整方式为：对顶点间的拓扑关系的布尔值进行调整，如果两顶点间存在拓扑关系，则布尔值为1，即增加连入边，否则为0，即断开连入边。8.根据权利要求7所述的方法，其特征在于，拓扑模型求解时，初始解的构建方式为以下任意一种：a. 随机构建初始拓扑：对任意顶点，如果该顶点为中间点且不存在连入边，则随机增加连入边，若不存在连出边，则随机增加连出边；如果该顶点为入口点且不存在连出边，则随机增加连出边；如果该顶点为出口点且不存在连入边，则随机增加连入边；b. 基于连接权重概率随机构建初始拓扑；计算各边在同一起点的所有边中的权重，及同一终点的所有边中的权重，在根据顶点按类型增加边时，根据边的权重进行随机抽取；c. 在根据顶点按类型增加边时，直接选取权重最高的边。9.根据权利要求7所述的方法，其特征在于，拓扑模型求解时，新解的产生方法为：在当前解中随机选择一个中间点顶点，基于当前解计算中间点顶点上流出量和流入量的差值；在满足约束的情况下对顶点进行随机增减边，产生新解，如果无法在满足约束的情况下产生新解，或当前差值已最小，则保持当前解进入下一迭代。10.根据权利要求1所述的方法，其特征在于，还包括，对构建的路网设施拓扑结构进行核查，基于地图可视化方式展示算法获得的拓扑关系，在GIS系统中通过抽检或巡检方式检查算法构建的拓扑关系是否存在错误或缺漏，并对错误/缺失的连接关系进行删除/增补处理。
说明书desc
技术领域本发明属于智慧交通信息化领域，涉及一种利用观测数据构建路网设施拓扑结构的方法。背景技术路侧设备拓扑是重要基础数据，是物理设备的虚拟实体规则模型的数据表现，在智能交通应用中不可或缺。在车辆计费与清分等传统业务中，ETC设备拓扑的正确与完备决定了车辆计费路径还原的准确性，影响到通行计费的精确与合理；在交通流指标分析、预测、决策分析、仿真等数据应用中，路网和设施拓扑是各类模型运行的基础，准确与否直接影响到分析结果的精度；动态拓扑分析可用于设备健康监控与维护；设备拓扑也是智慧交通系统的规划依据，可用于边缘计算的分层分片架构设计。随着公路基础建设的快速发展，高速公路的拓扑结构由线状向网状演化；另一方面，附着路网设施规模与日俱增，基于路网连通性的路侧设施拓扑关系日趋复杂与多变。这种拓扑关系可用有向图表示，其中设施是图的顶点，相邻设施间的连通关系是图的边。路侧设施拓扑是重要基础数据，在智慧交通信息化领域具有重要应用价值。建立路侧设备拓扑本质为图构建问题，以有向图的形式描述路侧设备基于路网的通信关系，其中，设备为图的顶点，可连通相邻设备的关系为图的边。传统地，此类问题可利用GIS直接或间接求解。直接的方式是通过在地图上标注设施点，人工逐一判读标记出设各施点的拓扑关系。作为辅助，也可叠加算法对关系进行识别，减轻人工标记的工作量。该类方法需要一定精度的路网地图和设备位置数据，并结合坐标投影、空间关联、路经规划等算法，对基础数据的要求和算法依赖高。在广域问题上效果受限，结果也易受地图数据精度影响。另外，从设备生命周期角度，路侧设施处于增设、撤销、在线、下线的变化过程中，其对应的拓扑是动态的，使用该类方法的工作量与难度成倍增加。因此，传统方法对于路网动态的、规模复杂设施拓扑构建能力有限。在工程化应用中，需要解决数据质量和问题规模两个挑战。首先，观测数据质量会直接影响拓扑建模结果。观测数据本质是对经过车辆的身份、时间、位置三类信息的识别与标定。高速公路场景下常用以下两类：1）设备基于射频或DSRC技术与经过车辆车载设备通讯获得的记录；2）通过视频抓拍和识别获得的记录。由于各种原因，两类数据实际都存在不同程度重复、错误、遗漏，后两者难于清洗且会将错误传导至结果。其次，由于路网结构复杂、设施数量庞大、用于精确计算拓扑结构的算法代价很高，精确求解为目标的建模在实际应用中并不可行。发明内容本发明的目的在于提供一种利用观测数据构建路网设施拓扑结构的方法与系统。为实现上述技术目的，本发明采用如下技术方案：一种利用观测数据构建路网设施拓扑结构的方法，包括：通过开窗或抽样从原始数据中获取车辆观测数据，并进行数据清理，之后以车辆为单位，按照数据的观测时间顺序排列，构建观测行程记录序列；基于观测行程记录序列提取涉及的设施点作为顶点，设施间拓扑关系作为候选边，并根据顶点出入流量将顶点属性划分为中间点、入口点和出口点；以拓扑中各中间节点的流入与流出净差值的总和作为模型目标函数，以最小化模型目标函数为目标，结合顶点和边的约束，建立拓扑模型；基于启发式算法求解所述拓扑模型，获得最优解，即构建的路网设施拓扑结构。作为一种优选的实施方式，在构建观测行程记录序列之前，对行程记录数据进行筛选，包括基于行程记录的车辆信息和行程特性进行筛选；以及基于车辆信息筛选构建拓扑的行程记录，并利用行程特性剔除指标值离群的行程记录。作为一种优选的实施方式，在数据开窗时，窗口大小的确定方式为：1）按照不同窗口大小对原始数据进行分组多批次采样；2）对样本数据进行预处理并建立观测行程记录序列；3）采用平均值或中位数对行程记录的设施数按窗口和抽样批次进行统计分析，找到窗口增大、获得设备数增加但边际收益增量下降的位置，即为最优窗口大小。通过寻找最优窗口大小来确定开窗数据的时间跨度，所述最优窗口大小既保证了选出数据足量，又能确保不过量，过量数据会导致引入更多脏数据增加精确求解难度，同时增加数据计算量。作为一种优选的实施方式，根据顶点出入流量计算流量平衡度，基于流量平衡度划分顶点属性，包括：对所有顶点，分别计算其流出量总和及流入量总和；定义流量平衡度为；根据实际建模时的平衡度分布直方图确定流量平衡度阈值上下限，将流量平衡度小于阈值下限的顶点划分为出口点，流量平衡度大于阈值下限的顶点划分为入口点，其余为中间点。作为一种优选的实施方式，所述顶点和边约束包括：约束任意顶点的入度与出度上限；约束任意中间点的入度与出度下限；约束入口点仅存在连出边，出口点仅存在连入边；排除没有实际观测流量的边及自环边。作为一种优选的实施方式，利用模拟退火算法求解所述拓扑模型。作为一种优选的实施方式，拓扑模型求解时，迭代过程中拓扑结构的调整方式为：对顶点间的拓扑关系的布尔值进行调整，如果两顶点间存在拓扑关系，则布尔值为1，即增加连入边，否则为0，即断开连入边。作为一种优选的实施方式，拓扑模型求解时，初始解的构建方式为以下任意一种：a. 随机构建初始拓扑：对任意顶点，如果该顶点为中间点且不存在连入边，则随机增加连入边，若不存在连出边，则随机增加连出边；如果该顶点为入口点且不存在连出边，则随机增加连出边；如果该顶点为出口点且不存在连入边，则随机增加连入边；b. 基于连接权重概率随机构建初始拓扑；计算各边在同一起点的所有边中的权重，及同一终点的所有边中的权重，在根据顶点按类型增加边时，根据边的权重进行随机抽取；c. 在根据顶点按类型增加边时，直接选取权重最高的边。作为一种优选的实施方式，拓扑模型求解时，新解的产生方法为：在当前解中随机选择一个中间点顶点，基于当前解计算中间点顶点上流出量和流入量的差值；在满足约束的情况下对顶点进行随机增减边，产生新解，如果无法在满足约束的情况下产生新解，或当前差值已最小，则保持当前解进入下一迭代。作为一种优选的实施方式，所述方法还包括，对构建的路网设施拓扑结构进行核查，基于地图可视化方式展示算法获得的拓扑关系，在GIS系统中通过抽检或巡检方式检查算法构建的拓扑关系是否存在错误或缺漏，并对错误/缺失的连接关系进行删除/增补处理。本发明具有如下有益效果：利用路网路侧设备自身的观测数据，基于观测车辆的记录必须服从路网拓扑与时间顺序这一时空特性，实现路侧设备拓扑关系的动态构建；克服了现有技术方案的不足，极大程度减少人工标注的工作，同时不依赖空间几何计算，在构建的过程中不依赖设备位置信息与路网地理信息数据。在计算数据量、脏数据的干扰和结果精度要求三者间寻求最优平衡。采用近似算法在有限资源条件，以全网流量失衡度最低为目标函数求解最优拓扑。这一方法对基础数据依赖程度低，在构建阶段无需路网数据与设备位置信息；且使用实际交通流定义设备拓扑，可利用时间切片计算拓扑动态变化。附图说明图1是本发明方法流程图。图2是本发明实施例步骤1选取最优窗口大小的结果对比图。图3是本发明实施例步骤4通过顶点平衡度直方图寻找失衡度阈值结果图。具体实施方式本案提出的技术路线分为4个过程实现：1）观测数据预处理、2）行程记录序列构建与建模数据准备、3）拓扑模型构建与启发式算法求解、4）结果检查评估与修正。过程1在于对原始观测数据进行获取与开窗、对观测记录三元组进行提取、清洗，从而保留正确有效的数据。过程2在于以车辆为维度，将过程1获得的观测数据组合为行程记录序列，通过多种方法进行筛选；基于筛选结果计算建模所需输入参数。过程3基于流量平衡构建设施拓扑关系优化模型，并使用启发式算法求解，获得最可信的拓扑图。过程4通过地图可视化、人工核检的方式对算法获得的拓扑进行评估与修正，输出最终结果。1 数据获取与开窗准备构建路网拓扑的原始数据集，通过时间窗口取出数据子集用于后续计算和建模。本案需要两类数据：1)观测数据与2)辅助数据：1)观测数据指待建立拓扑关系的时空域内所有设备对经过车辆的观测记录。每条观测记录应至少具备三类信息：a）设备的唯一身份识别信息，b）该观测设备所观测到的车辆信息，b）观测所发生的时间信息。不符合要求的数据在步骤2中清洗。2）辅助数据为观测数据以外可支撑建模的其他数据：a）车辆信息数据，用于筛选输入拓扑建模的行程数据；b）设备位置数据，用于拓扑构建后，在地图中进行结果可视化，以及对结果核查和评估。原始观测数据需先进行开窗，即选取一定时间跨度的数据子集，合适的窗口取值影响到拓扑建模效果。有效的窗口大小取决于问题本身，因此采用抽样统计观测法来确定。步骤如下：1）按照不同窗口大小对原始数据进行分组多批次采样；2）采用对样本数据进行预处理并建立行程观测记录；3）对行程记录的设备数按窗口和抽样批次进行统计分析。对结果进行观测，随着窗口增大，行程中观测设备数会相应增加，但受拓扑结构限制，该统计值会逐渐逼近某上限。找到窗口增大获得设备数增加边际效益增量下降的位置，即为最优窗口大小。以该窗口大小为参数在原始数据中进行开窗，获取子数据集用于进一步处理。2 数据预处理对车辆观测数据进行清洗，去除无效、重复的数据，减少对后期计算结果精度的影响。1）无效数据去除对待预处理数据，从时间、车辆信息、设备信息三个维度检查数据是否有效。检查项包括：a)是否可以解析，b)解析后格式是否正确，c)解析后内容是否合乎逻辑或对应的编码规则。对于不符合任意一项检查的数据予以剔除。2）重复数据去除对出现时间戳、车辆识别信息、观测设备识别信息三个维度信息同时重复的数据进行去重。3 观测行程记录序列构建与筛选基于步骤2清洗后的数据，以车辆为单位，按先后经过顺序还原记录顺序，即观测行程记录序列。进一步，基于车辆特征和行程属性对记录进行筛选，保留确信度更高的记录用于建模。1）行程记录序列构建对于过程2获得的离散数据，根据车辆信息进行分组，每组内的记录为抽取时间窗口内同一车辆在的不同设备位置的被观测记录。对各组内的记录按时间戳排序，获得观测行程记录序列。2）记录筛选对行程记录进一步筛选，优选用于计算拓扑建模参数的数据。目的在于尽可能选取观测完备且无错误的行程记录。通过以下方式进行优选：a）基于行程记录的车辆信息进行筛选，以通过特定车牌颜色和车型组合，保留更适宜构建拓扑的行程记录；例如通过车型、车牌颜色的组合选取特定车辆行程记子集，蓝牌小客车更容易获得准确的观测记录和行程序列，适宜构建拓扑，同理可基于车辆信息保留其他适宜构建拓扑的行程记录。b）基于行程的特性的筛选，如计算行程总时长、设施间平均时长、设施间平均时长标准差，对指标值离群的行程记录予以剔除。4 拓扑建模参数准备基于筛选的行程记录，计算用于构建拓扑模型的参数。包含三项工作：1）提取顶点的集合；2）提取边的集合，并计算各边出现的流量；3）识别顶点的属性。整理结果为集合、，矩阵，向量作为拓扑建模的输入参数。4-1 顶点提取 基于行程记录，提取构建拓扑模型的顶点与待选边。对于筛选所得的观测行程，提取出现的全部个设施点，顶点与其索引分别表示为集合：。4-2 边提取与属性计算 统计全部行程记录中两两相邻设施出现的次数，其中为起点索引，为终点索引，表示的出现次数。以矩阵表示全部顶点之间的关系，待选边集合表示为。4-3 顶点属性识别基于计算各顶点的累积流入流出量，以流量平衡度划分顶点属性。中间点表示该顶点同时存在连入和连出边，入口点表示该顶点仅存在连入路网的边，出口点则相反。对于所有，分别计算的流出和流入量总和：的流量平衡度可表示为:对于任意，若满足:则为中间点，全部中间点及其索引构成集合为；若满足：则为入口点，全部入口点及其索引构成集合；若满足：则为出口点，全部出口点及其索引构成集合；为失衡度阈值，用于判别顶点类型，实际应用时通过观察平衡度分布直方图获得。如图3所示，对全部顶点做直方图，在与之间分别通过观察寻找最小值处的取值，。对于顶点的类型属性，可用三组长度为的布尔值向量 表示：同一顶点有且只具备一种属性，因此：。5 拓扑构建的模型设施拓扑构建的关键在于基于集合确定真实存在的边，用矩阵表示，其中元素为布尔值变量。，表示存在拓扑关系；，其他。通过求解以下组合模型获得：模型中，式为模型目标函数，定义了一个拓扑中各中间节点的流入与流出净差值的总和，为非负整数。在理想情况下，该函数应为最优值。实际应用中，因观测数据存在错误，最优解的目标函数可能存在大于的残值。基于观测数据获得的参数并满足约束条件时的最小值时的为最可能的拓扑结构。约束条件式限定了任意顶点的入度与出度上限，以高速路网结构而言，取值默认为4，应用时可根据实际情况调整。约束条件式限定了任意中间点的入度与出度下限，即满足至少存在一进一出的连接关系。约束条件式限定了入口点仅存在连出边，限定出口点仅存在连入边。约束条件式限定了中不应存在没有实际观测流量的边。约束条件式限定了拓扑图不为伪图，不存在自环边。6 模型求解本案采用启发式算法求解步骤5构建的模型，启发式算法是一类针对特定问题在有限计算资源下获得可接受近似最优解的算法。元启发算法是这类算法泛化的统称，旨在为特定问题提供通用的求解器开发模式与策略。模拟退火是一种广泛使用的元启发算法，具有易实现，鲁棒性优的特点。该算法通过借鉴金属退火时内部晶体结构逐渐趋于势能最低的现象，采用随机算法通过大量迭代在解集中寻找全局最优解，迭代过程中能避免陷入局部最优。模拟退火算法求解设备拓扑模型的过程可以概括为以下4步：1）初始化：设定初始温度，构建一个可行的初始解；2）迭代：在当前温度下执行给定次数迭代，每次迭代产生一个邻域解并比较目标函数值，基于一定准则接受或拒绝新解；3）降温：根据降温方案进行降温，并重复2、3步至满足停止规则；4）停止：根据设定的停止规则终止计算。根据求解拓扑组合模型的特性，本案在上述范式基础上对模型求解各步骤进行细化定义，具体如下：6-1 构建初始解初始化一个可行解作为退火算法迭代的输入。初始解的构建以及迭代过程中向邻域解的调整，其实质内容是对图中顶点间进行边的连接或断开，表现为对矩阵中部分元素进行布尔值的调整。为了便于叙述，从顶点角度，调整可分为以下情况：首先，设全部元素为，按以下规则构建初始边并调整：1）任意入口点仅存在一条连出边；2）任意出口点存在一条连入边；3）任意中间点至少同时存在一条连出与连入边。基于这些基本原则，初始解的构建有以下几个变种可选：1）随机构建、2）基于连接权重随机构建、3）连接权重优先构建。方法1随机构建，即采用完全随机的方法构建初始拓扑。对于任意顶点，如果为中间点，若不存在连入边，则随机增加连入边，方法是在列向量构成的集合 中随机选出，需满足条件；若不存在连出边，则随机增加连出边，方法在行向量构成的集合 中随机选出，满足条件。对于任意顶点，如果为入口点，若不存在连出边，则随机增加连出边，方法同上。对于任意顶点，如果为出口点，若不存在连入边，则随机增加连入边，方法同上。全部顶点遍历后获得初始拓扑。方法2基于连接权重概率随机构建，本方法是方法1的变种，区别在于随机选择时基于权重，权重越高被随机选中的概率越大。首先，基于计算权重矩阵:其中，是边在所有以为起点的边中的权重，是边在所有以为终点的边中的权重。其次，按照方法1对全部顶点按类型增加边，在选取时基于的权重进行随机选取，在选取时基于的权重进行随机抽取。方法3连接权重优先构建该方法更为激进，即不采用随机而基于连接权重优先选取边。具体方法是，在分别对全部顶点按类型增加边时，将的随机选取，变更为选取中对应权重最高的边，将的随机选取，变更为选取中对应权重最高的边。前两种方法尝试从一个偏向随机的混沌解作为初始拓扑，而方法3在构建初始拓扑时尽可能将常识认知的可能边纳入初始拓扑中。此方法更倾向于在大规模问题上尝试使用较少的迭代逼近最优解。初始解构建完成后，基于式计算出该拓扑的初始目标函数值。6-2 迭代过程退火迭代过程是在同一温度下由当前解向邻域解调整的过程，逐渐向获得更优解逼近。其规则如下：1）初始化时，将预设的初始温度设为当前温度，初始解赋给当前解，当前目标函数值则为初始目标函数值：在温度下执行给定次寻找新解的迭代过程，每次迭代判断新解是否可被接受。迭代完成后执行降温，重复执行寻找新解迭代，指导满足停止条件。2）新解的产生方法是基于当前解，以流量平衡的思路随机优化一个节点连接方式，形成新解。首先，在当前解中随机选择一个中间点顶点 ，基于当前解 计算上的流量差：如果 ，则该顶点流出量大于流入量，如果则反之。若在满足约束条件的条件下对顶点进行随机增减边操作，增边时选择方法同构建初始解方法1，此产生新解 。增或减的选择，亦可通过随机方式获得。如果无法在满足约束条件下产生新解，或者当前顶点的流量差已最小(），则保持当前解进入下一迭代。3）新解产生后基于式计算新解的目标函数值，若满足  则接受新解替代当前解继续迭代；否则以一定概率接受新解，概率计算如下：在间生成均匀分布条件下的随机数，若，则接受新解替代当前解继续迭代，否则直接进入下一迭代。4）同一温度下执行给定次数的6-3 退火降温1）设置初始温度 ，最终停止温度。2）设置降温系数，用于控制降温速度。每次降温时，使用新温度 取代当前温度，其计算方式如下：其中，为之间的小数，如：、 等。越接近  退火速度越慢，求解所需时间更长，找到更好解的可能性越高。6-4 退火停止通过以下条件的组合设置停止迭代的规则：1）到达最低温度 ；2）同一温度下连续多次均无法接受新解；3）同一温度下迭代完成后，接受新解的次数小于设定值。当退火停止时，当前最优解为求解所得最优解，即最可能的路网设施拓扑结构。7 结果检查结果检查用于人工核查算法获取的设施拓扑关系是否存可用，其方法是基于地图可视化方式展示算法获得的拓扑关系，在GIS系统中通过抽检或巡检方式检查算法构建的拓扑关系是否存在错误或缺漏，删除错误的连接关系，增补缺失的连接关系。首先，基于获得设施连接关系集合，通过设施位置点坐标以linestring对象构建连接数据图层。其次，在GIS系统载入该图层，结合道路或遥感影像底图，判别已建立的linestring对象是否正确，并进行相关增删操作。
