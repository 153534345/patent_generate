标题title
一种荧光图筛选的方法、装置、设备以及存储介质
摘要abst
本发明公开了一种荧光图筛选的方法、装置、设备以及存储介质。该方法包括：根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组；根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。采用本发明的技术方案，可以过滤掉待筛选时序荧光图的序列中时序荧光图的质量出现变化对序列荧光图模板质量的影响，从而提升碱基序列的数据通量和比对率。
权利要求书clms
1.一种荧光图筛选的方法，其特征在于，所述方法包括：根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2；根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。2.根据权利要求1所述的方法，其特征在于，所述根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，包括：从N个待筛选时序荧光图的序列中获取P个第一时序荧光图组，单个第一时序荧光图组中包括M个第一时序荧光图，N≥M；根据第一时序荧光图的评估质量，得到各第一时序荧光图组的评估质量；并根据第一时序荧光图组的评估质量，从所述P个第一时序荧光图组中获取S个第二时序荧光图组，单个第二时序荧光图组中包括M个第二时序荧光图，P≥S。3.根据权利要求2所述的方法，其特征在于，所述根据第一时序荧光图组的评估质量，从所述P个第一时序荧光图组中获取S个第二时序荧光图组，包括：将所述第一时序荧光图组的评估质量降序排列，从所述P个第一时序荧光图组中获取前S个第二时序荧光图组。4.根据权利要求2或3所述的方法，其特征在于，所述N大于等于4，小于等于25；所述M大于等于4，小于等于9。5.根据权利要求1所述的方法，其特征在于，所述根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列，包括：根据所述第二时序荧光图在所述第二时序荧光图组中的频次，计算第二时序荧光图的频次以及评估质量的综合值；将第二时序荧光图的综合值降序排序，得到前M个第三时序荧光图。6.根据权利要求5所述的方法，其特征在于，所述根据所述第二时序荧光图在所述第二时序荧光图组中的频次，计算第二时序荧光图的频次以及评估质量的综合值，包括：将第二时序荧光图的频次乘以评估质量，得到综合值；或者，将第二时序荧光图的频次除以评估质量，得到综合值；或者，将所述第二时序荧光图按照频次降序排序得到第一排序值，将所述第二时序荧光图按照评估质量降序排序得到第二排序值，如果所述第一排序值等于所述第二排序值，则根据所述第一排序值或者所述第二排序值确定对应的综合值；如果所述第一排序值不等于所述第二排序值，则根据所述第一排序值确定对应的综合值。7.根据权利要求1所述的方法，其特征在于，在所述根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组之前，还包括：分别融合各第一时序荧光图组的荧光图，得到各第一时序荧光图组的组荧光图模板；根据所述组荧光图模板，得到各第一时序荧光图组中第一时序荧光图的子评估质量；计算所述第一时序荧光图组中相同第一时序荧光图的子评估质量的平均值，作为所述第一时序荧光图的评估质量。8.一种荧光图筛选的装置，其特征在于，所述装置包括：确定模块，用于根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2；融合模块，用于根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；分析模块，用于根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。9.一种电子设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器实现如权利要求1-7中任一项所述的方法。10.一种计算机可读存储介质，其中，所述计算机指令用于使所述计算机执行根据权利要求1-7中任一项所述的方法。
说明书desc
技术领域本发明涉及基因测序技术领域，尤其涉及一种荧光图筛选的方法、装置、设备以及存储介质。背景技术在基因测序领域，待测序核酸片段的识别方式有很多，主流的识别方案是通过CCD成像系统采集携带核酸的荧光信号，并采集一系列带有荧光信号的图像，分析少量不同时序下的荧光图像，通过碱基识别系统得到对应的碱基序列以及碱基序列的质量来评估数据，而少量不同时序下荧光图像对应评估质量数据决定了最终批量获取所有时序荧光图对应的核酸序列的质量，核酸的质量为开展下一步的基因组学的研究提供了研究基础，故不同时序下荧光图的质量评估显得尤为重要。目前，分析时序荧光图的方式可以为：从时序荧光图序列中融合部分连续的时序荧光图，得到荧光图模板；将所述荧光图模板匹配时序荧光图序列中的各时序荧光图，得到对应的碱基序列以及碱基序列的质量评估数据。在生成时序荧光图序列的过程中，可能会由于测序仪器精度误差，设备配套实际误差等因素，影响时序荧光图序列中时序荧光图的质量，如果得到荧光图模板的部分连续的时序荧光图质量被影响，将影响荧光图模板的质量，从而影响质量评估数据的准确性。发明内容本发明提供了一种荧光图筛选的方法、装置、设备以及存储介质，稳定碱基序列的数据通量和比对率。根据本发明的第一方面，提供了一种荧光图筛选的方法，该方法包括：根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2；根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。可选的，所述根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，包括：从N个待筛选时序荧光图的序列中获取P个第一时序荧光图组，单个第一时序荧光图组中包括M个第一时序荧光图，N≥M；根据第一时序荧光图的评估质量，得到各第一时序荧光图组的评估质量；并根据第一时序荧光图组的评估质量，从所述P个第一时序荧光图组中获取S个第二时序荧光图组，单个第二时序荧光图组中包括M个第二时序荧光图，P≥S。进一步的，所述根据第一时序荧光图组的评估质量，从所述P个第一时序荧光图组中获取S个第二时序荧光图组，包括：将所述第一时序荧光图组的评估质量降序排列，从所述P个第一时序荧光图组中获取前S个第二时序荧光图组。可选的，所述N大于等于4，小于等于25；所述M大于等于4，小于等于9。可选的，所述根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列，包括：根据所述第二时序荧光图在所述第二时序荧光图组中的频次，计算第二时序荧光图的频次以及评估质量的综合值；将第二时序荧光图的综合值降序排序，得到前M个第三时序荧光图。进一步的，所述根据所述第二时序荧光图在所述第二时序荧光图组中的频次，计算第二时序荧光图的频次以及评估质量的综合值，包括：将第二时序荧光图的频次乘以评估质量，得到综合值；或者，将第二时序荧光图的频次除以评估质量，得到综合值；或者，将所述第二时序荧光图按照频次降序排序得到第一排序值，将所述第二时序荧光图按照评估质量降序排序得到第二排序值，如果所述第一排序值等于所述第二排序值，则根据所述第一排序值或者所述第二排序值确定对应的综合值；如果所述第一排序值不等于所述第二排序值，则根据所述第一排序值确定对应的综合值。可选的，在所述根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组之前，还包括：分别融合各第一时序荧光图组的荧光图，得到各第一时序荧光图组的组荧光图模板；根据所述组荧光图模板，得到各第一时序荧光图组中第一时序荧光图的子评估质量；计算所述第一时序荧光图组中相同第一时序荧光图的子评估质量的平均值，作为所述第一时序荧光图的评估质量。根据本发明的第二方面，提供了一种荧光图筛选的装置，该装置包括：确定模块，用于根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2；融合模块，用于根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；分析模块，用于根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。根据本发明的第三方面，提供了一种电子设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器实现如本发明任一实施例所述的荧光图筛选的方法。根据本发明的第四方面，提供了一种计算机可读存储介质，所述计算机指令用于使所述计算机执行如本发明任一实施例所述荧光图筛选的方法。本发明公开了一种荧光图筛选的方法、装置、设备以及存储介质。该方法包括：根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组；根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。采用本发明的技术方案，通过随机选择第一时序荧光图，从而避免待筛选时序荧光图的序列中时序荧光图的质量出现变化而影响序列荧光图模板的质量的情况；以及，根据各第一时序荧光图的评估质量确定的第二时序荧光图组，以及根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列，可以进一步屏蔽待筛选时序荧光图的序列中时序荧光图的质量出现变化而影响序列荧光图模板的质量的情况；通过以上方式得到的序列荧光图模板，可以过滤掉待筛选时序荧光图的序列中时序荧光图的质量出现变化对序列荧光图模板质量的影响，从而提升碱基序列的数据通量和比对率。应当理解，本部分所描述的内容并非旨在标识本发明的实施例的关键或重要特征，也不用于限制本发明的范围。本发明的其它特征将通过以下的说明书而变得容易理解。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是根据本发明实施例提供的一种荧光图筛选的方法的流程示意图；图2a是正常荧光图的示意图；图2b是视场偏移，左侧偏离荧光区域的荧光图的示意图；图2c是含气泡的荧光图的示意图；图2d是左侧过亮，右侧过暗的荧光图的示意图；图2e是产生白色条带的荧光图的示意图；图2f是下方出现黑条带的荧光图的示意图；图3是根据本发明实施例提供的一种荧光图筛选的装置的结构示意图；图4是用来实现本发明实施例的一种荧光图筛选的方法的电子设备的框图。具体实施方式为了使本技术领域的人员更好地理解本申请方案，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分的实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本申请保护的范围。需要说明的是，本申请的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本申请的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。实施例一根据本申请实施例，提供了一种荧光图筛选的方法的流程示意图，需要说明的是，在附图的流程图示出的步骤可以在诸如一组计算机可执行指令的计算机系统中执行，并且，虽然在流程图中示出了逻辑顺序，但是在某些情况下，可以以不同于此处的顺序执行所示出或描述的步骤。例如，该荧光图筛选的方法可以应用于基因测序仪中，对基因测序过程中的时序荧光图进行筛选。如图1所示，该荧光图筛选的方法包括如下步骤：S110、S120和S130。S110、根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2。可选的，所述待筛选时序荧光图的序列来源可以是高通量基因测序仪、存储设备、内存以及网络传输等，存储设备可以是U盘、机械硬盘、固态硬盘、分布式存储、集中式存储等。所述待筛选时序荧光图可能会发生视场偏移、气泡、过度曝光/低亮度、对焦模糊、图像不均一等多种形态的非正常荧光图。如图2a-2f所示，提供了多种荧光图的示意图，图2a是正常荧光图的示意图；图2b是视场偏移，左侧偏离荧光区域的荧光图的示意图；图2c是含气泡的荧光图的示意图；图2d是左侧过亮，右侧过暗的荧光图的示意图；图2e是产生白色条带的荧光图的示意图；图2f是下方出现黑条带的荧光图的示意图。若待筛选时序荧光图的序列来源是高通量基因测序仪的情况下，由于高通量基因测序仪的读长表示了该高通量基因测序仪能够测到的基因序列的最大值，从而可以确定待筛选时序荧光图的序列中时序的最大值，即待筛选时序荧光图的序列中时序的最大值与读长相对应。以高通量测序领域为例，时序荧光图中的荧光图数量的具体值根据基因测序仪原理的不同而有所差别，对于待筛选时序荧光图的序列而言，单个时序荧光图中的荧光图数量可以为2张或者4张。碱基类型为4种，单个时序荧光图中的荧光图数量为2张的情况下，可以从每张荧光图中获取2种类型的碱基，从而从单个时序荧光图中获取这4种类型的碱基，有可能2张荧光图中出现了相同的碱基，导致无法从单个时序荧光图中获取这4种类型的碱基，则可以从其他时序荧光图中获取缺失的碱基；单个时序荧光图中的荧光图数量为4张的情况下，可以从每张荧光图中获取1种类型的碱基，从而从单个时序荧光图中获取这4种类型的碱基。所述评估质量包括但不限于碱基质量值的百分比、碱基轮廓系数、图像均一性和信噪比之一，除了碱基质量值的百分比和碱基轮廓系数，还可以用其他的与碱基相关的数值表示评估质量。其中，碱基质量值用于衡量基因测序的准确度，碱基质量值越高代表碱基的测序准确度越高，相应的，碱基质量值越高，碱基质量值的百分比也越高，则代表对应时序荧光图的评估质量越高；例如，碱基质量值为30，则碱基质量值的百分比为Q30,表示时序荧光图中的碱基被错误识别的概率为0.1％；若碱基质量值为20，则碱基质量值的百分比为Q20，表示时序荧光图中的碱基被错误识别的概率为1％。碱基轮廓系数越高代表对应时序荧光图的评估质量越高，通过聚类算法确定时序荧光图中的碱基对应的荧光信号到达聚类中心的距离，进一步计算出时序荧光图中的碱基轮廓系数。对时序荧光图进行图像计算，得到图像均一性以及信噪比。以评估质量为碱基轮廓系数为例，说明评估质量的计算方式。其中，4种类型的常见碱基分别为腺嘌呤脱氧核苷酸A、胸腺嘧啶脱氧核苷酸T、胞嘧啶脱氧核苷酸C和鸟嘌呤脱氧核苷酸G，通过聚类算法确定时序荧光图中的碱基对应的荧光信号分别到达A、T、C、G四个聚类中心的距离。轮廓系数计算方法：如下式所示，S表示单一碱基样本i的轮廓系数：其中，a表示i所属碱基类内其它样本的平均距离；若碱基类内仅i碱基一个样本，则令S＝0，i∈A；a＝average j∈A；j＝i).b表示i与其他碱基类的平均距离的最小值；i∈A，C≠A，dist＝average j∈C)，b＝min C≠A，dist如下式所示，S表示最终聚类总体的轮廓系数，即碱基样本轮廓系数的平均值为：可选的，在所述根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组之前，还包括：分别融合各第一时序荧光图组的荧光图，得到各第一时序荧光图组的组荧光图模板；根据所述组荧光图模板，得到各第一时序荧光图组中第一时序荧光图的子评估质量；计算所述第一时序荧光图组中相同第一时序荧光图的子评估质量的平均值，作为所述第一时序荧光图的评估质量。分别融合各第一时序荧光图组的荧光图，得到各第一时序荧光图组的组荧光图模板，包括：提取第一时序荧光图组中的荧光图中的碱基信息，对满足要求的碱基信息进行融合，得到所述组荧光图模板。融合方法包括但不限于基于变换域的小波变换法。由于不同的第一时序荧光图组中可能会包括相同的第一时序荧光图，该相同的第一时序荧光图在不同的第一时序荧光图组中得到的子评估质量不同，因此计算各相同第一时序荧光图的子评估质量的平均值，作为所述第一时序荧光图的评估质量。可选的，所述根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，包括：从N个待筛选时序荧光图的序列中获取P个第一时序荧光图组，单个第一时序荧光图组中包括M个第一时序荧光图，N≥M；根据第一时序荧光图的评估质量，得到各第一时序荧光图组的评估质量；并根据第一时序荧光图组的评估质量，从所述P个第一时序荧光图组中获取S个第二时序荧光图组，单个第二时序荧光图组中包括M个第二时序荧光图，P≥S。其中，P表示从所述N个待筛选时序荧光图的序列中选择M个第一时序荧光图的所有排列组合数。示例性的，若N＝25,M＝5，则根据排列组合的原理得到通过对每个第一时序荧光图组中的M个第一时序荧光图的评估质量求平均值得到各个第一时序荧光图组的评估质量；进一步的，所述根据第一时序荧光图组的评估质量，从所述P个第一时序荧光图组中获取S个第二时序荧光图组，包括：将所述第一时序荧光图组的评估质量降序排列，从所述P个第一时序荧光图组中获取前S个第二时序荧光图组。其中，N、M、S的具体数值预先设定，N过大的话，则本方案的运算速度过慢；N过小的话，则本方案难以得到序列荧光图模板；M、S与基因测序仪的性能以及基因测序工作的实验要求有关；对于相同的基因测序仪而言，在设定了N、M、S的具体数值之后，相同基因测序工作的实验要求下，基因测序工作过程中N、M、S不发生变化。可选的，所述N大于等于4，小于等于25；所述M大于等于4，小于等于9。示例性的，若N＝25,M＝5，则根据排列组合的原理得到若S的值预先设定为100，则所述第二时序荧光图组为在所述53130个第一时序荧光图组中，筛选经过所述第一时序荧光图组的评估质量由大到小排序，得到的居于前100名的第一时序荧光图组而构成的。S120、根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板。其中，所述融合所述第三时序荧光图序列中的荧光图的方法可以采用步骤S110中的融合方法，在此不再赘述。可选的，所述根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列，包括：根据所述第二时序荧光图在所述第二时序荧光图组中的频次，计算第二时序荧光图的频次以及评估质量的综合值；将第二时序荧光图的综合值降序排序，得到前M个第三时序荧光图。进一步的，所述根据所述第二时序荧光图在所述第二时序荧光图组中的频次，计算第二时序荧光图的频次以及评估质量的综合值，包括：将第二时序荧光图的频次乘以评估质量，得到综合值；或者，将第二时序荧光图的频次除以评估质量，得到综合值；或者，将所述第二时序荧光图按照频次降序排序得到第一排序值，将所述第二时序荧光图按照评估质量降序排序得到第二排序值，如果所述第一排序值等于所述第二排序值，则根据所述第一排序值或者所述第二排序值确定对应的综合值；如果所述第一排序值不等于所述第二排序值，则根据所述第一排序值确定对应的综合值。其中，当频次和评估质量的排序呈现出一致性，则在计算综合值时，频次和评估质量所占比例可以相同；当频次和评估质量的排序呈现出不一致性，例如，第二时序荧光图的频次和评估质量的排序编号不一致，则计算综合值时，频次所占比例高于评估质量所占比例。比如，某个第二时序荧光图的评估质量高，该第二时序荧光图在第二时序荧光图组中的出现频次却比较低，则将频次对应的比例调高，评估质量对应的比例调低，使得在两个因素中，频次所占的比例比评估质量所占的比例更高，从而得到综合值。示例性的，当N＝25，M＝5，S＝100时，计算所述第二时序荧光图在100个第二时序荧光图组中出现的频次，统计各个第二时序荧光图的评估质量，按照每个第二时序荧光图对应的频次和评估质量二者的乘积结果的数值进行倒序排名，选择排序编号前5个第二时序荧光图，组成所述第三时序荧光图的序列。S130、根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。在基因测序工作中，待筛选时序荧光图可能受不同干扰因素的影响使得质量参差不齐，采用本方案的荧光图筛选方法，可以通过随机选择第一时序荧光图，从而避免待筛选时序荧光图的序列中时序荧光图的质量出现变化而影响序列荧光图模板的质量的情况；以及，根据各第一时序荧光图的评估质量确定的第二时序荧光图组，以及根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列，可以进一步屏蔽待筛选时序荧光图的序列中时序荧光图的质量出现变化而影响序列荧光图模板的质量的情况；通过以上方式得到的序列荧光图模板，可以过滤掉待筛选时序荧光图的序列中时序荧光图的质量出现变化对序列荧光图模板质量的影响，从而提升碱基序列的数据通量和比对率，例如，在高通量基因测序实验中应用了本实施例提出的荧光图筛选的方法，碱基序列的数据通量提升了0.2％-2％；碱基序列的比对率提高了0.1％-2％.实施例二根据本发明实施例，提供了一种荧光图筛选的装置的结构示意图，该装置可以执行上述实施例一提供的荧光图筛选的方法。如图3所示，该装置包括：确定模块310、融合模块320和分析模块330。其中：确定模块310，用于根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2。融合模块320，用于根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板。分析模块330，用于根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。可选的，还包括评估质量模块，用于分别融合各第一时序荧光图组的荧光图，得到各第一时序荧光图组的组荧光图模板；根据所述组荧光图模板，得到各第一时序荧光图组中第一时序荧光图的子评估质量；计算所述第一时序荧光图组中相同第一时序荧光图的子评估质量的平均值，作为所述第一时序荧光图的评估质量。可选的，所述确定模块310，包括：第一确定单元，用于从N个待筛选时序荧光图的序列中获取P个第一时序荧光图组，单个第一时序荧光图组中包括M个第一时序荧光图，N≥M；第二确定单元，用于根据第一时序荧光图的评估质量，得到各第一时序荧光图组的评估质量；并根据第一时序荧光图组的评估质量，从所述P个第一时序荧光图组中获取S个第二时序荧光图组，单个第二时序荧光图组中包括M个第二时序荧光图，P≥S。进一步的，所述第二确定单元，还用于将所述第一时序荧光图组的评估质量降序排列，从所述P个第一时序荧光图组中获取前S个第二时序荧光图组。可选的，所述N大于等于4，小于等于25；所述M大于等于4，小于等于9。可选的，所述融合模块320，包括：计算单元，用于根据所述第二时序荧光图在所述第二时序荧光图组中的频次，计算第二时序荧光图的频次以及评估质量的综合值；排序单元，将第二时序荧光图的综合值降序排序，得到前M个第三时序荧光图。进一步的，所述计算单元，还用于将第二时序荧光图的频次乘以评估质量，得到综合值；或者，将第二时序荧光图的频次除以评估质量，得到综合值；或者，将所述第二时序荧光图按照频次降序排序得到第一排序值，将所述第二时序荧光图按照评估质量降序排序得到第二排序值，如果所述第一排序值等于所述第二排序值，则根据所述第一排序值或者所述第二排序值确定对应的综合值；如果所述第一排序值不等于所述第二排序值，则根据所述第一排序值确定对应的综合值。需要说明的是，本发明公开提供的荧光图筛选的装置中各模块以及单元的实现细节和技术效果可以参考本申请中其他实施例的说明，在此不再赘述。本发明公开了一种荧光图筛选的装置。该装置包括：确定模块，用于根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组；融合模块，用于根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；分析模块，用于根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。采用本发明的技术方案，通过随机选择第一时序荧光图，从而避免待筛选时序荧光图的序列中时序荧光图的质量出现变化而影响序列荧光图模板的质量的情况；以及，根据各第一时序荧光图的评估质量确定的第二时序荧光图组，以及根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列，可以进一步屏蔽待筛选时序荧光图的序列中时序荧光图的质量出现变化而影响序列荧光图模板的质量的情况；通过以上方式得到的序列荧光图模板，可以过滤掉待筛选时序荧光图的序列中时序荧光图的质量出现变化对序列荧光图模板质量的影响，从而提升碱基序列的数据通量和比对率。实施例三下面参考图4，其示出了适于用来实现本发明实施例的电子设备400的结构图。电子设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本发明的实现。如图4所示，电子设备400可以包括处理装置410，其可以根据存储在只读存储器420中的程序或者从存储装置480加载到随机访问存储器430中的程序而执行各种适当的动作和处理。处理装置410可以是各种具有处理和计算能力的通用和/或专用处理组件。处理装置410的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的计算单元、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。处理装置410执行上文所描述的各个方法和处理。在RAM 430中，还存储有电子设备400操作所需的各种程序和数据。处理装置410、ROM420以及RAM 430通过总线440彼此相连。输入/输出接口450也连接至总线440。通常，以下装置可以连接至I/O接口450：包括例如触摸屏、触摸板、键盘、鼠标、摄像头、麦克风、加速度计、陀螺仪等的输入装置460；包括例如液晶显示器、扬声器、振动器等的输出装置470；包括例如磁带、硬盘等的存储装置480；以及通信装置490。通信装置490可以允许电子设备400与其他设备进行无线或有线通信以交换数据。虽然图4示出了具有各种装置的电子设备400，但是应理解的是，并不要求实施或具备所有示出的装置。可以替代地实施或具备更多或更少的装置。特别地，根据本发明的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本发明的实施例包括一种计算机程序产品，其包括承载在非暂态计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信装置490从网络上被下载和安装，或者从存储装置480被安装，或者从ROM 420被安装。在该计算机程序被处理装置410执行时，执行本发明实施例的方法中限定的上述功能。备选地，在其他实施例中，处理装置410可以通过其他任何适当的方式而被配置为执行方法：根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2；根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。实施例四本发明上述的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本发明中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本发明中，计算机可读信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读信号介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：电线、光缆、RF等等，或者上述的任意合适的组合。在一些实施方式中，客户端、服务器可以利用诸如HTTP之类的任何当前已知或未来研发的网络协议进行通信，并且可以与任意形式或介质的数字数据通信互连。通信网络的示例包括局域网，广域网，网际网以及端对端网络，以及任何当前已知或未来研发的网络。上述计算机可读介质可以是上述电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被该电子设备执行时，使得该电子设备：根据第一时序荧光图组中各第一时序荧光图的评估质量，确定第二时序荧光图组，单个第一时序荧光图组包括待筛选时序荧光图的序列中的M个第一时序荧光图，M大于等于2；根据第二时序荧光图在所述第二时序荧光图组中的频次以及评估质量确定第三时序荧光图的序列；并融合所述第三时序荧光图的序列中的荧光图，得到序列荧光图模板；根据所述序列荧光图模板，得到所述待筛选时序荧光图的序列中各时序荧光图的碱基序列。可以以一种或多种程序设计语言或其组合来编写用于执行本发明的操作的计算机程序代码，上述程序设计语言包括但不限于面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，可以连接到外部计算机。附图中的流程图和框图，图示了按照本发明各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，该模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本发明实施例中所涉及到的模块可以通过软件的方式实现，也可以通过硬件的方式来实现。其中，模块的名称在某种情况下并不构成对该模块本身的限定。本文中以上描述的功能可以至少部分地由一个或多个硬件逻辑部件来执行。例如，非限制性地，可以使用的示范类型的硬件逻辑部件包括：数字电子电路系统、集成电路系统、现场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、复杂可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合等等。用于实施本发明的方法的程序代码可以采用一个或多个编程语言的任何组合来编写。这些程序代码可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器或控制器，使得程序代码当由处理器或控制器执行时使流程图和/或框图中所规定的功能/操作被实施。程序代码可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本发明的上下文中，机器可读介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的程序。机器可读介质可以是机器可读信号介质或机器可读储存介质。机器可读介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在计算机上实施此处描述的系统和技术，该计算机具有：用于向用户显示信息的显示装置或者LCD监视器)；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给计算机。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网区块链网络和互联网。计算机系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，又称为云计算服务器或云主机，是云计算服务体系中的一项主机产品，以解决了传统物理主机与VPS服务中，存在的管理难度大，业务扩展性弱的缺陷。服务器也可以为分布式系统的服务器，或者是结合了区块链的服务器。人工智能是研究使计算机来模拟人的某些思维过程和智能行为的学科，既有硬件层面的技术也有软件层面的技术。人工智能硬件技术一般包括如传感器、专用人工智能芯片、云计算、分布式存储、大数据处理等技术；人工智能软件技术主要包括计算机视觉技术、语音识别技术、自然语言处理技术及机器学习/深度学习技术、大数据处理技术、知识图谱技术等几大方向。云计算，指的是通过网络接入弹性可扩展的共享物理或虚拟资源池，资源可以包括服务器、操作系统、网络、软件、应用和存储设备等，并可以按需、自服务的方式对资源进行部署和管理的技术体系。通过云计算技术，可以为人工智能、区块链等技术应用、模型训练提供高效强大的数据处理能力。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发发明中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本发明提供的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
