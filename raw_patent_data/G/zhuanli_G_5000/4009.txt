标题title
脑电运动意图分类模型建立方法及其应用
摘要abst
本申请实施例公开了一种脑电运动意图分类模型建立方法及其应用，其中脑电运动意图分类模型建立方法包括：将未经过滤的脑电数据作为输入，对构建的卷积神经网络进行训练，得到输出的特征图和运动意图分类结果；根据特征图和运动意图分类结果，获取Grad‑CAM结果，判断出对正确的运动意图分类结果有利的有用数据和对正确的运动意图分类结果不利的无用数据；对脑电数据进行傅里叶变换，得到对应的频率，分别记录良好频率和不良频率；选择属于不良频率但不属于良好频率的频率作为过滤频率，过滤掉脑电数据中的过滤频率，将过滤后的脑电数据作为下一训练过程的输入对卷积神经网络继续进行训练，以得到目标脑电运动意图分类模型。
权利要求书clms
1.一种脑电运动意图分类模型建立方法，其特征在于，包括：将未经过滤的脑电数据作为输入，对构建的卷积神经网络进行训练，得到输出的特征图和运动意图分类结果；根据所述特征图和运动意图分类结果，获取Grad-CAM结果，根据所述Grad-CAM结果判断出所述脑电数据中对正确的所述运动意图分类结果有利的有用数据和对正确的所述运动意图分类结果不利的无用数据；对所述脑电数据进行傅里叶变换，得到对应的频率，所述有用数据中与正确的所述运动意图分类结果有关的频率为良好频率，所述无用数据中与正确的所述运动意图分类结果无关的频率为不良频率，分别记录所述良好频率和不良频率；选择属于所述不良频率但不属于所述良好频率的频率作为过滤频率，过滤掉所述脑电数据中的所述过滤频率，将过滤后的所述脑电数据作为下一训练过程的输入对所述卷积神经网络继续进行训练，以得到目标脑电运动意图分类模型。2.根据权利要求1所述的脑电运动意图分类模型建立方法，其特征在于，所述脑电运动意图分类模型的主干网络由三个具有不同感受野的所述卷积神经网络分支组成，包括小感受野网络、中等感受野网络和大感受野网络。3.根据权利要求2所述的脑电运动意图分类模型建立方法，其特征在于，所述得到输出的运动意图分类结果包括：所述卷积神经网络的输入是包含时间和空间信息的22个电极信号的串联，前向和反向传播同时在不同的网络分支中进行，并在每个分支的末尾设置一个soft-max激活，通过对分支各自的结果求和并将求和结果放入附加的soft-max激活中获得所述运动意图分类结果。4.根据权利要求1所述的脑电运动意图分类模型建立方法，其特征在于，所述根据所述Grad-CAM结果判断出所述脑电数据中对正确的所述运动意图分类结果有利的有用数据和对正确的所述运动意图分类结果不利的无用数据包括：判断出所述Grad-CAM结果中颜色亮的信号，对应的所述脑电数据作为所述有用数据；判断出所述Grad-CAM结果中颜色暗的信号，对应的所述脑电数据作为所述无用数据。5.根据权利要求1所述的脑电运动意图分类模型建立方法，其特征在于，所述分别记录所述良好频率和不良频率还包括：将所述无用数据和无用数据对应的频率中振幅最大的频率记录为所述不良频率。6.根据权利要求1所述的脑电运动意图分类模型建立方法，其特征在于，所述选择属于所述不良频率但不属于所述良好频率的频率作为过滤频率包括：将记录的所述不良频率和良好频率分别根据数量降序排序，选出至少部分排名靠前的所述不良频率和选择至少部分排名靠前的所述良好频率，从选出的频率中确定所述过滤频率。7.一种脑电运动意图分类方法，其特征在于，包括：将待进行脑电运动意图分类的脑电数据输入权利要求1至6任一项所述的脑电运动意图分类模型建立方法所建立的脑电运动意图分类模型，由所述脑电运动意图分类模型输出运动意图分类结果。8.一种计算机存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被机器执行时实现如权利要求1至6中任一项所述的方法的步骤。
说明书desc
技术领域本申请涉及医学图像处理技术领域，具体涉及一种脑电运动意图分类模型建立方法及其应用。背景技术脑卒中是最常见的疾病之一，语言和运动相关功能的障碍使脑卒中患者难以过上正常的生活。随着脑机接口的发展，可以识别中风患者的意图，脑机接口是基于脑电图中的事件相关同步或事件相关去同步现象。此方法使用运动想象分类，但是准确地对脑电信号进行分类仍然是一个巨大的挑战。为了提高MI分类的准确性，从而提高BCI的性能，目前被研究出大量的方法。MI分类方法通常可以分为两类：基于公共空间模式的方法，如滤波器组公共空间模式和公共空间光谱模式；基于深度学习的方法，如C2CM、紧凑型卷积神经网络和浅层ConvNet。无论采用何种方法进行MI分类，还需要进行适当的过滤，以抑制高振幅噪声和通道饱和。事实证明，各种配置同样有效，因为这些频率范围产生了稳定的频率响应。基于FBCSP的C2CM是传统方法与深度学习相结合的成功范例。该方法分别对时间特征和空间特征进行卷积，取得了较好的性能，但增加了较多的参数。在浅层ConvNet中，也采用了FBCSP进行数据处理。网络的前两层使用带通滤波和CSP空间滤波器。然后使用以下卷积层和池化层计算分类结果。它比FBCSP更合理，因为浅层ConvNet将所有计算过程嵌入到一个网络中，并且可以一起优化参数以获得更好的结果。这些方法获得了较高的MI分类精度，但没有对滤波的影响进行进一步研究。还有几种特殊的过滤方法。在Schrödinger过滤中，去除了梯度伪影尖峰并保留了EEG信号，并在该算法中使用了伪影或信号的模板或参考。同时，诱发活动在过滤过程中没有受到影响，证明了该方法的稳健性。这种方法是基于半经典信号分析的，需要积极研究以获得更好的性能。在Bayesian过滤是一种不同的过滤方法，从EEG中解码实时听觉注意力，与其他现有方法相比，减少了对大型训练数据集的需求。这种方法在应用上有一定的复杂性。在基于聚类的特征中，探索了脑电数据的底层结构，并使用基于聚类的多任务学习算法优化了数据特征，提高了分类的准确性。为了提高分类精度，提出了空间模式的多尺度优化,它通过CSP内的多视图学习优化滤波器带。该方法在过滤方法的MI相关EEG数据集中也取得了良好的效果。上面提到的所有方法都试图在MI分类之前对EEG信号进行滤波，这些方法通常将滤波过程分成几个步骤，这造成处理过程很复杂。发明内容本申请实施例的目的在于提供一种脑电运动意图分类模型建立方法及其应用，用以解决现有技术中的脑电运动意图分类模型建立方法都试图在MI分类之前对EEG信号进行滤波，这些方法通常将滤波过程分成几个步骤，从而造成处理过程很复杂的问题。为实现上述目的，本申请实施例提供一种脑电运动意图分类模型建立方法，包括：将未经过滤的脑电数据作为输入，对构建的卷积神经网络进行训练，得到输出的特征图和运动意图分类结果；根据所述特征图和运动意图分类结果，获取Grad-CAM结果，根据所述Grad-CAM结果判断出所述脑电数据中对正确的所述运动意图分类结果有利的有用数据和对正确的所述运动意图分类结果不利的无用数据；对所述脑电数据进行傅里叶变换，得到对应的频率，所述有用数据中与正确的所述运动意图分类结果有关的频率为良好频率，所述无用数据中与正确的所述运动意图分类结果无关的频率为不良频率，分别记录所述良好频率和不良频率；选择属于所述不良频率但不属于所述良好频率的频率作为过滤频率，过滤掉所述脑电数据中的所述过滤频率，将过滤后的所述脑电数据作为下一训练过程的输入对所述卷积神经网络继续进行训练，以得到目标脑电运动意图分类模型。可选地，所述脑电运动意图分类模型的主干网络由三个具有不同感受野的所述卷积神经网络分支组成，包括小感受野网络、中等感受野网络和大感受野网络。可选地，所述得到输出的运动意图分类结果包括：所述卷积神经网络的输入是包含时间和空间信息的22个电极信号的串联，前向和反向传播同时在不同的网络分支中进行，并在每个分支的末尾设置一个soft-max激活，通过对分支各自的结果求和并将求和结果放入附加的soft-max激活中获得所述运动意图分类结果。可选地，所述根据所述Grad-CAM结果判断出所述脑电数据中对正确的所述运动意图分类结果有利的有用数据和对正确的所述运动意图分类结果不利的无用数据包括：判断出所述Grad-CAM结果中颜色亮的信号，对应的所述脑电数据作为所述有用数据；判断出所述Grad-CAM结果中颜色暗的信号，对应的所述脑电数据作为所述无用数据。可选地，所述分别记录所述良好频率和不良频率还包括：将所述无用数据和无用数据对应的频率中振幅最大的频率记录为所述不良频率。可选地，所述选择属于所述不良频率但不属于所述良好频率的频率作为过滤频率包括：将记录的所述不良频率和良好频率分别根据数量降序排序，选出至少部分排名靠前的所述不良频率和选择至少部分排名靠前的所述良好频率，从选出的频率中确定所述过滤频率。为实现上述目的，本申请还提供一种脑电运动意图分类方法，包括：将待进行脑电运动意图分类的脑电数据输入如上所述的脑电运动意图分类模型建立方法所建立的脑电运动意图分类模型，由所述脑电运动意图分类模型输出运动意图分类结果。为实现上述目的，本申请还提供一种计算机存储介质，其上存储有计算机程序，其中所述计算机程序被机器执行时实现如上所述的方法的步骤。本申请实施例具有如下优点：本申请实施例提供一种脑电运动意图分类模型建立方法，包括：将未经过滤的脑电数据作为输入，对构建的卷积神经网络进行训练，得到输出的特征图和运动意图分类结果；根据所述特征图和运动意图分类结果，获取Grad-CAM结果，根据所述Grad-CAM结果判断出所述脑电数据中对正确的所述运动意图分类结果有利的有用数据和对正确的所述运动意图分类结果不利的无用数据；对所述脑电数据进行傅里叶变换，得到对应的频率，所述有用数据中与正确的所述运动意图分类结果有关的频率为良好频率，所述无用数据中与正确的所述运动意图分类结果无关的频率为不良频率，分别记录所述良好频率和不良频率；选择属于所述不良频率但不属于所述良好频率的频率作为过滤频率，过滤掉所述脑电数据中的所述过滤频率，将过滤后的所述脑电数据作为下一训练过程的输入对所述卷积神经网络继续进行训练，以得到目标脑电运动意图分类模型。通过上述建立模型的方法，对MI分类后的EEG信号进行过滤，减少过滤过程步骤，根据训练数据的特点改进分类结果，人工干预很少，以更高的平均值和更低的标准偏差值优于其他最先进的方法，本方法实际上是一个可迭代的过程，也就是说我们可以根据上次分类结果的Grad-CAM对上次训练过程后的数据进行过滤，解决了现有技术中的脑电运动意图分类模型建立方法都试图在MI分类之前对EEG信号进行滤波，这些方法通常将滤波过程分成几个步骤，从而造成处理过程很复杂的问题。附图说明为了更清楚地说明本申请的实施方式或现有技术中的技术方案，下面将对实施方式或现有技术描述中所需要使用的附图作简单地介绍。显而易见地，下面描述中的附图仅仅是示例性的，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图引申获得其它的实施附图。图1为本申请实施例提供的一种脑电运动意图分类模型建立方法的流程图；图2为本申请实施例提供的一种脑电运动意图分类模型建立方法的整体架构图；图3为本申请实施例提供的一种脑电运动意图分类模型建立方法的模型主干网络示意图；图4为本申请实施例提供的一种脑电运动意图分类模型建立方法的Grad-CAM结果示意图；图5为本申请实施例提供的一种脑电运动意图分类模型建立方法的良好频率和不良频率选择过程示意图；图6为本申请实施例提供的一种脑电运动意图分类模型建立方法的过滤频率选择示意图。具体实施方式以下由特定的具体实施例说明本申请的实施方式，熟悉此技术的人士可由本说明书所揭露的内容轻易地了解本申请的其他优点及功效，显然，所描述的实施例是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。此外，下面所描述的本申请不同实施方式中所涉及的技术特征只要彼此之间未构成冲突就可以相互结合。本申请一实施例提供一种脑电运动意图分类模型建立方法，参考图1，图1为本申请的一实施方式中提供的一种脑电运动意图分类模型建立方法的流程图，应当理解的是，该方法还可以包括未示出的附加框和/或可以省略所示出的框，本申请的范围在此方面不受限制。本方法基于梯度加权类激活映射提出了两阶段细化过滤方法。整体架构图参考图2，图2为两级细化过滤方法的整体架构，其中，第一阶段的卷积神经网络与第二阶段的相同。在步骤101处，将未经过滤的脑电数据作为输入，对构建的卷积神经网络进行训练，得到输出的特征图和运动意图分类结果。在步骤102处，根据所述特征图和运动意图分类结果，获取Grad-CAM结果，根据所述Grad-CAM结果判断出所述脑电数据中对正确的所述运动意图分类结果有利的有用数据和对正确的所述运动意图分类结果不利的无用数据。具体地，第一阶段，将未经过滤的脑电数据送入卷积神经网络完成第一次训练，并保存权重。根据得到的特征图和初始的运动意图分类结果获得Grad-CAM结果。可以计算出训练数据对正确的分类结果贡献的是正权重还是负权重，从而判断出有用数据和无用数据。在数据处理过程中，根据Grad-CAM结果确定有利于和不利于正确分类结果的脑电数据，从而得到要过滤的频率，具体频率选择原则在之后的步骤中说明。在一些实施例中，所述脑电运动意图分类模型的主干网络由三个具有不同感受野的所述卷积神经网络分支组成，包括小感受野网络、中等感受野网络和大感受野网络。具体地，参考图 3 所示，我们的主干网络由三个具有不同感受野的卷积神经网络 组成，分支分别称为小感受野网络、中等感受野网络和大感受野网络或广域网—连接到用户计算机，或者，可以连接到外部计算机。在一些实施例中，通过利用计算机可读程序指令的状态信息来个性化定制电子电路，例如可编程逻辑电路、现场可编程门阵列或可编程逻辑阵列，该电子电路可以执行计算机可读程序指令，从而实现本申请的各个方面。这里参照根据本申请实施例的方法、装置和计算机程序产品的流程图和/或框图描述了本申请的各个方面。应当理解，流程图和/或框图的每个方框以及流程图和/或框图中各方框的组合，都可以由计算机可读程序指令实现。这些计算机可读程序指令可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理单元，从而生产出一种机器，使得这些指令在通过计算机或其他可编程数据处理装置的处理单元执行时，产生了实现流程图和/或框图中的一个或多个方框中规定的功能/动作的装置。也可以把这些计算机可读程序指令存储在计算机可读存储介质中，这些指令使得计算机、可编程数据处理装置和/或其他设备以特定方式工作，从而，存储有指令的计算机可读介质则包括一个制造品，其包括实现流程图和/或框图中的一个或多个方框中规定的功能/动作的各个方面的指令。也可以把计算机可读程序指令加载到计算机、其他可编程数据处理装置、或其他设备上，使得在计算机、其他可编程数据处理装置或其他设备上执行一系列操作步骤，以产生计算机实现的过程，从而使得在计算机、其他可编程数据处理装置、或其他设备上执行的指令实现流程图和/或框图中的一个或多个方框中规定的功能/动作。附图中的流程图和框图显示了根据本申请的多个实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段或指令的一部分，所述模块、程序段或指令的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个连续的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或动作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。注意，除非另有直接说明，否则本说明书中所揭示的所有特征皆可由用于达到相同、等效或类似目的的可替代特征来替换。因此，除非另有明确说明，否则所公开的每一个特征仅是一组等效或类似特征的一个示例。在使用到的情况下，进一步地、较优地、更进一步地和更优地是在前述实施例基础上进行另一实施例阐述的简单起头，该进一步地、较优地、更进一步地或更优地后带的内容与前述实施例的结合作为另一实施例的完整构成。在同一实施例后带的若干个进一步地、较优地、更进一步地或更优地设置之间可任意组合的组成又一实施例。虽然，上文中已经用一般性说明及具体实施例对本申请作了详尽的描述，但在本申请基础上，可以对之作一些修改或改进，这对本领域技术人员而言是显而易见的。因此，在不偏离本申请精神的基础上所做的这些修改或改进，均属于本申请要求保护的范围。
