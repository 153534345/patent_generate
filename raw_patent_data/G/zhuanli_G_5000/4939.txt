标题title
基于边界保持的DnCNN混合震源地震数据分离方法和系统
摘要abst
本发明提供了一种基于边界保持的DnCNN混合震源地震数据分离方法和系统，涉及地震数据分离技术领域，包括：基于预设混合震源数据，获取混叠噪声数据；混叠噪声数据为预设混合震源数据在共检波点道集去掉有效信号所得到噪声数据；将预设混合震源数据和混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集；基于排列之后的数据集，获取共检波点道集标签数据对；利用共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型；利用训练之后的DnCNN模型对目标混合震源地震数据中的混叠噪声进行分离。本发明缓解了现有技术中存在的适应性差、计算效率低的技术问题，提高了边缘炮的分离信噪比。
权利要求书clms
1.一种基于边界保持的DnCNN混合震源地震数据分离方法，其特征在于，包括：基于预设混合震源数据，获取混叠噪声数据；所述混叠噪声数据为所述预设混合震源数据在共检波点道集去掉有效信号所得到噪声数据；将所述预设混合震源数据和所述混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集；基于所述排列之后的数据集，获取共检波点道集标签数据对；利用所述共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型；利用所述训练之后的DnCNN模型对目标混合震源地震数据中的混叠噪声进行分离。2.根据权利要求1所述的方法，其特征在于，将所述预设混合震源数据和所述混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集，包括：将所述预设混合震源数据和所述混叠噪声数据中，相邻两个共检波点道集的按不同的排列方式进行排列；所述排列方式包括以下任一种：按照炮点号顺序正序排列、按照炮点号顺序逆序排列。3.根据权利要求1所述的方法，其特征在于，利用所述共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型，包括：对所述共检波点道集标签数据对进行批标准化，然后对所述预设DnCNN模型进行训练，利用随机梯度下降法对目标损失函数进行优化。4.根据权利要求3所述的方法，其特征在于，所述目标损失函数的数学形式包括：其中，l表示所述目标损失函数，Θ表示所述DnCNN模型的网络参数，yi表示含噪声数据，xi表示对应的干净数据，N表示切分的数据块的数量，表示所述预设DnCNN模型的输出。5.一种基于边界保持的DnCNN混合震源地震数据分离系统，其特征在于，包括：第一获取模块，排列模块，第二获取模块，训练模块和分离模块；其中，所述第一获取模块，用于基于预设混合震源数据，获取混叠噪声数据；所述混叠噪声数据为所述预设混合震源数据在共检波点道集去掉有效信号所得到噪声数据；所述排列模块，用于将所述预设混合震源数据和所述混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集；所述第二获取模块，用于基于所述排列之后的数据集，获取共检波点道集标签数据对；所述训练模块，用于利用所述共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型；所述分离模块，用于利用所述训练之后的DnCNN模型对目标混合震源地震数据中的混叠噪声进行分离。6.根据权利要求5所述的系统，其特征在于，所述排列模块，还用于：将所述预设混合震源数据和所述混叠噪声数据中，相邻两个共检波点道集的按不同的排列方式进行排列；所述排列方式包括以下任一种：按照炮点号顺序正序排列、按照炮点号顺序逆序排列。7.根据权利要求5所述的系统，其特征在于，所述训练模块，还用于：对所述共检波点道集标签数据对进行批标准化，然后对所述预设DnCNN模型进行训练，利用随机梯度下降法对目标损失函数进行优化。8.根据权利要求7所述的系统，其特征在于，所述目标损失函数的数学形式包括：其中，l表示所述目标损失函数，Θ表示所述DnCNN模型的网络参数，yi表示含噪声数据，xi表示对应的干净数据，N表示切分的数据块的数量，表示所述预设DnCNN模型的输出。9.一种电子设备，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现上述权利要求1至4任一项所述的方法的步骤。10.一种具有处理器可执行的非易失的程序代码的计算机可读介质，其特征在于，所述程序代码使所述处理器执行所述权利要求1-4任一项所述方法。
说明书desc
技术领域本发明涉及地震数据分离技术领域，尤其是涉及一种基于边界保持的 DnCNN混合震源地震数据分离方法和系统。背景技术混合震源采集技术使得地震记录之间相互混叠，通过同时或者延时激发两个或两个以上不同位置的震源，可以提高采集效率，降低地震勘探成本。大量的例子表明，延时激发，即组成一个混合震源的不同单震源之间激发时间差以一个很小的抖动时间定义，更利于后续的处理。混合震源采集的数据需要分离成常规的单震源数据才能用于后续地震数据处理，因此混合震源数据分离是目前地震数据处理的一个重要研究内容。消除混合震源数据中每一个单震源的延时可将混合震源数据分离成常规单震源数据的形式，但是地震记录中有效信号之外其它相干震源的干扰依然存在，这个过程即我们常说的伪分离。有效信号之外其它相干震源的干扰即为混叠噪声。根据混叠噪声在非共炮点道集呈非相干形式分布这一特点，混合震源数据分离可以转化成一个随机噪声去除问题。不同于其他去噪问题，混叠噪声的特性与待恢复信号的特性非常相似。传统的混合震源数据分离方法主要分为两类：基于滤波方法和基于稀疏反演方法。现有基于滤波和稀疏反演混合震源分离方法是基于模型框架发展来的，这些方法都需要一定的先验信息并且适应性差、计算效率低，尤其是边缘炮集记录由于相干道数较少，往往分离信噪比较低。发明内容有鉴于此，本发明的目的在于提供一种基于边界保持的DnCNN混合震源地震数据分离方法和系统，以缓解现有技术中存在的适应性差、计算效率低的技术问题。第一方面，本发明实施例提供了一种基于边界保持的DnCNN混合震源地震数据分离方法，包括：基于预设混合震源数据，获取混叠噪声数据；所述混叠噪声数据为所述预设混合震源数据在共检波点道集去掉有效信号所得到噪声数据；将所述预设混合震源数据和所述混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集；基于所述排列之后的数据集，获取共检波点道集标签数据对；利用所述共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型；利用所述训练之后的DnCNN模型对目标混合震源地震数据中的混叠噪声进行分离。进一步地，将所述预设混合震源数据和所述混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集，包括：将所述预设混合震源数据和所述混叠噪声数据中，相邻两个共检波点道集的按不同的排列方式进行排列；所述排列方式包括以下任一种：按照炮点号顺序正序排列、按照炮点号顺序逆序排列。进一步地，利用所述共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型，包括：对所述共检波点道集标签数据对进行批标准化，然后对所述预设DnCNN模型进行训练，利用随机梯度下降法对目标损失函数进行优化。进一步地，所述目标损失函数的数学形式包括：其中，l表示所述目标损失函数，Θ表示所述DnCNN模型的网络参数，yi表示含噪声数据，xi表示对应的干净数据， N表示切分的数据块的数量，表示所述预设DnCNN模型的输出。第二方面，本发明实施例还提供了一种基于边界保持的DnCNN混合震源地震数据分离系统，包括：第一获取模块，排列模块，第二获取模块，训练模块和分离模块；其中，所述第一获取模块，用于基于预设混合震源数据，获取混叠噪声数据；所述混叠噪声数据为所述预设混合震源数据在共检波点道集去掉有效信号所得到噪声数据；所述排列模块，用于将所述预设混合震源数据和所述混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集；所述第二获取模块，用于基于所述排列之后的数据集，获取共检波点道集标签数据对；所述训练模块，用于利用所述共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型；所述分离模块，用于利用所述训练之后的DnCNN模型对目标混合震源地震数据中的混叠噪声进行分离。进一步地，所述排列模块，还用于：将所述预设混合震源数据和所述混叠噪声数据中，相邻两个共检波点道集的按不同的排列方式进行排列；所述排列方式包括以下任一种：按照炮点号顺序正序排列、按照炮点号顺序逆序排列。进一步地，所述训练模块，还用于：对所述共检波点道集标签数据对进行批标准化，然后对所述预设DnCNN模型进行训练，利用随机梯度下降法对目标损失函数进行优化。进一步地，所述目标损失函数的数学形式包括：其中，l表示所述目标损失函数，Θ表示所述DnCNN模型的网络参数，yi表示含噪声数据，xi表示对应的干净数据， N表示切分的数据块的数量，表示所述预设DnCNN模型的输出。第三方面，本发明实施例还提供了一种电子设备，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述第一方面所述的方法的步骤。第四方面，本发明实施例还提供了一种具有处理器可执行的非易失的程序代码的计算机可读介质，所述程序代码使所述处理器执行上述第一方面所述方法。本发明提供了一种基于边界保持的DnCNN混合震源地震数据分离方法和系统，采用边界保持策略对共检波点地震数据进行重排列，提高了边缘炮的分离信噪比，缓解了现有技术中存在的适应性差、计算效率低的技术问题。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的一种基于边界保持的DnCNN混合震源地震数据分离方法的流程图；图2为本发明实施例提供的一种DnCNN的网络结构示意图；图3为本发明实施例提供的一种伪分离后混叠噪声在共炮点道集和共检波点道集的分布形式示意图；图4为本发明实施例提供的一种训练数据损失曲线的示意图；图5为本发明实施例提供的一种验证数据损失曲线的示意图；图6为本发明实施例提供的一种单震源数据示意图；图7为本发明实施例提供的一种伪分离数据示意图；图8为本发明实施例提供的一种DnCNN的分离结果示意图；图9为本发明实施例提供的一种DnCNN预测的混叠噪声示意图；图10为本发明实施例提供的一种稀疏反演方法分离结果示意图；图11为本发明实施例提供的一种稀疏反演方法去除的混叠噪声示意图；图12为本发明实施例提供的一种传统排列方式排列共检波点道集数据示意图；图13为本发明实施例提供的一种边界保持的地震数据排列方式示意图；图14为本发明实施例提供的一种稀疏反演方法的分离结果示意图；图15为本发明实施例提供的一种DnCNN方法的分离结果示意图；图16为本发明实施例提供的边界保持的DnCNN方法的分离结果示意图；图17为本发明实施例提供的一种单道信噪比对比示意图；图18为本发明实施例提供的一种共炮点道集边缘炮的分离结果示意图；图19为本发明实施例提供的一种基于边界保持的DnCNN混合震源地震数据分离系统的示意图。具体实施方式下面将结合附图对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一：图1是根据本发明实施例提供的一种基于边界保持的DnCNN混合震源地震数据分离方法的流程图。如图1所示，该方法具体包括如下步骤：步骤S102，基于预设混合震源数据，获取混叠噪声数据；混叠噪声数据为预设混合震源数据在共检波点道集去掉有效信号所得到噪声数据。步骤S104，将预设混合震源数据和混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集。具体地，按照边界保持的方式进行排列，包括：将预设混合震源数据和混叠噪声数据中，相邻两个共检波点道集的按不同的排列方式进行排列；排列方式包括以下任一种：按照炮点号顺序正序排列、按照炮点号顺序逆序排列。例如，在第一个检波点的第1个检波器接收到第1炮的数据与第二个检波点的第2个检波器接收到第1炮的数据相邻，第2个检波器接收到第 N炮的数据与第3个检波器接收到第N炮的数据相邻，第3个检波器接收到第1炮的数据与第4个检波器接收到第1炮的数据相邻，以此类推。步骤S106，基于排列之后的数据集，获取共检波点道集标签数据对。其中，每个共检波点道集标签数据对包括一个预设混合震源数据和一个对应的混合叠噪声数据。步骤S108，利用共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型。具体地，对共检波点道集标签数据对进行批标准化，然后对预设 DnCNN模型进行训练，利用随机梯度下降法对目标损失函数进行优化。其中，目标损失函数的数学形式包括：其中，l表示目标损失函数，Θ表示DnCNN模型的网络参数，yi表示含噪声数据，xi表示对应的干净数据，N表示切分的数据块的数量，表示预设DnCNN模型的输出。步骤S110，利用训练之后的DnCNN模型对目标混合震源地震数据中的混叠噪声进行分离。本发明提供了一种基于边界保持的DnCNN混合震源地震数据分离方法和系统，采用边界保持策略对共检波点地震数据进行重排列，提高了边缘炮的分离信噪比，缓解了现有技术中存在的适应性差、计算效率低的技术问题。在本发明实施例中，混合震源数据可以写成常规震源记录的线性组合：Ubl＝ΓblU 其中Ubl表示混合震源记录，U表示待分离的单炮记录，Γbl表示混合震源算子。假设一条二维测线上共有m个单震源，n个检波器，m个单震源组合成g个混合震源，那么混合震源算子Γbl可以表示成下面的形式：其中Tjk表示第j个混合震源中参与混合的第k个单炮震源的延时。若第j个混合震源中不包含第k个单震源，则令ρjk＝0。一般在实际地震采集中，混合震源个数要小于单震源个数，即g＜m，因此Γbl是一个欠定矩阵，是不存在的，无法直接求取，但是可以通过式 构造其伪逆，公式为：其中H表示矩阵的共轭转置，可以得到混合震源数据伪分离记录＜U＞：伪分离数据中的混叠噪声在非共炮点道集呈非相干形式分布，此时，混合震源数据分离问题转化成为一个类似随机噪声压制问题。在本发明实施例中，DnCNN为去噪卷积神经网络。一个含噪声数据可以用下面线性方程来表示：y＝x+n其中，y表示含噪声数据，x表示干净数据，n表示噪声数据。通常的去噪模型是学习即输入含噪声数据输出干净数据。去噪卷积神经网络是学习残差数据映射，即输入含噪声数据，输出噪声数据，即那么因此，噪声数据与预测的噪声数据之间的均方误差作为损失函数来训练网络的参数Θ，损失函数方程为下式：其中，yi表示含噪声数据，xi表示对应的干净数据，N表示切分的数据块的数量。图2为根据本发明实施例提供的一种DnCNN的网络结构示意图。如图2所示，针对混合震源数据分离问题，网络输入为共检波点道集的混合震源数据，输出为对应的混叠噪声，网络的深度即网络的卷积层的个数为 17，DnCNN网络主要由3部分构成，第一层为卷积+ReLU激活函数，卷积核大小为3×3，此卷积层将输入数据映射为64个特征数据，然后ReLU激活函数用来激活网络的非线性能力；第2～16层为卷积+批标准化+ReLU激活函数，其中每个卷积层都包含64个3×3×64大小的滤波器；第17层为卷积层，包含一个3×3×64大小的滤波器，这一层将64个特征图重建为最后的残差图像。本发明实施例选用的ReLU激活函数具体形式如下：f＝max随机梯度下降法广泛应用于CNN的训练方法中，但是训练的性能却很大程度受内部协变量移位这一问题所影响。因为深层网络中，就单层而言，每一层的输入是前面所有层的输出，这个输出往往是不稳定的，它会随着前面层的参数的迭代更新而产生变化,这就需要小心选择参数的初始值，减小学习率，小的学习率又会使梯度下降训练过程的收敛速度变慢。批标准化能够使网络中的各层输入的方差为0，均值为1，进而使得每层的输入空间数据分布是一致的，进而提高了收敛速度。在本发明实施例中，批标准化具体操作如下：输入：小批量的x值：需要学习的参数：γ，β输出：{yi＝BNγ,β}本发明实施例选取某海域一套实测单震源数据对本发明实施例提供的方法进行验证。首先模拟混合震源数据，混合震源参数为：第1个单震源和第51个单震源组成第1个混合震源，第2个单震源和第52个单震源组成第2个混合震源，以此类推，第50个单震源和第100个单震源组成第50个混合震源，随机延时范围为2s。图3为伪分离后混叠噪声在共炮点道集和共检波点道集的分布形式示意图，如图3所示，混叠噪声在共检波点道集呈离散随机形式分布。首先制作标签数据集，在共检波点道集将有效信号减去得到混叠噪声数据。将共检波点道集混合震源数据和混叠噪声两两组合并切块，用8000 组数据块作为训练库，1000组数据块作为验证库，单个数据块大小为64× 64，共训练150个Epoch。图4为本发明实施例提供的一种训练数据损失曲线的示意图，图5为本发明实施例提供的一种验证数据损失曲线的示意图。如图4和图5所示，整体上损失函数值逐渐减小且趋于一个定值，说明本发明实施例提供的方法能稳定去除共检波点道集中的混叠噪声。图6～图11为共检波点道集DnCNN方法和稀疏反演方法分离结果对比。其中，图6为本发明实施例提供的一种单震源数据示意图，图7为本发明实施例提供的一种伪分离数据示意图，图8为本发明实施例提供的一种DnCNN的分离结果示意图，图9为本发明实施例提供的一种DnCNN预测的混叠噪声示意图，图10为本发明实施例提供的一种稀疏反演方法分离结果示意图，图11为本发明实施例提供的一种稀疏反演方法去除的混叠噪声示意图。如图6～图11所示，可以看到DnCNN方法的分离结果要明显优于基于稀疏反演方法的分离结果。基于深度学习分离方法整体上分离结果精度较高，但是其边界部分放大展示图依然可以看到残留有部分混叠噪声，原因是采用传统排列方式排列共检波点道集数据，相邻检波点连接处特征不明显，如图12黑框所示，图12为根据本发明实施例提供的一种传统排列方式排列共检波点道集数据示意图，模型训练过程中无法学习该处特征。图10中展示的传统基于模型驱动方法对该处处理效果更差。在本发明实施例中，以5个检波点，N个炮点为例，传统共检波点道集排列方式如图12所示，本发明实施例提供的边界保持的地震数据排列方式如图13所示，其连接方式为第1个检波器接收到第1炮的数据与第2个检波器接收到第1炮的数据相邻，第2个检波器接收到第N炮的数据与第 3个检波器接收到第N炮的数据相邻，第3个检波器接收到第1炮的数据与第4个检波器接收到第1炮的数据相邻，以此类推，这样相邻检波点连接处就会出现图13中黑框所示的特殊连接结构，基于深度学习方法可以训练模型学习其深层特征。这种排列方式不仅适用于本发明实施例中混合震源数据分离，也适用于地震数据重建和去噪。继续采用上述提供的数据，将共检波点道集标签数据对按照边界保持的方式排列，并重新训练相应的模型进行分离测试。图14为本发明实施例提供的一种稀疏反演方法的分离结果示意图，图15为本发明实施例提供的一种DnCNN方法的分离结果示意图，图16为本发明实施例提供的边界保持的DnCNN方法的分离结果示意图。如图16中所示，边界部分放大显示混叠噪声被完全压制掉。图17为本发明实施例提供的一种单道信噪比对比示意图。如图17所示，可以看到图16边界处单道信噪比明显提高。图18为本发明实施例提供的一种共炮点道集边缘炮的分离结果示意图。其中，图18左图为DnCNN 分离结果，右图为边界保持的DnCNN分离结果。如图18所示，证明边界保持的DnCNN的混合震源数据分离方法对边缘炮分离效果较好。表1列出图14、图15和图16两侧各三道数据的单道信噪比。表1三种方法分离结果边缘处信噪比由以上描述可知，本发明实施例提供了一种基于边界保持的DnCNN混合震源地震数据分离方法，首先，采用边界保持方法获取标签数据集对，伪分离数据作为DnNN的输入，对应的混叠噪声作为DnNN的输出；然后，设置相应的网络参数，训练网络模型；再通过训练好的网络模型预测伪分离数据中的混叠噪声；最后通过伪分离数据减去预测的混叠噪声得到分离结果。本发明实施例相比于现有技术，具有如下技术效果：基于边界保持的DnCNN的混合震源数据分离方法，采用残差学习策略预测共检波点道集数据中的混叠噪声，无需进行多次迭代，分离结果相对于稀疏反演方法分离信噪比更高；采用边界保持策略对共检波点地震数据进行重排列，提高了边缘炮的分离信噪比。实施例二：图19为根据本发明实施例提供的一种基于边界保持的DnCNN混合震源地震数据分离系统的示意图。如图19所示，该系统包括：第一获取模块 10，排列模块20，第二获取模块30，训练模块40和分离模块50。具体地，第一获取模块10，用于基于预设混合震源数据，获取混叠噪声数据；混叠噪声数据为预设混合震源数据在共检波点道集去掉有效信号所得到噪声数据。排列模块20，用于将预设混合震源数据和混叠噪声数据按照边界保持的方式进行排列，得到排列之后的数据集。可选地，排列模块20，还用于：将预设混合震源数据和混叠噪声数据中，相邻两个共检波点道集的按不同的排列方式进行排列；排列方式包括以下任一种：按照炮点号顺序正序排列、按照炮点号顺序逆序排列。第二获取模块30，用于基于排列之后的数据集，获取共检波点道集标签数据对。训练模块40，用于利用共检波点道集标签数据对对预设DnCNN模型进行训练，得到训练之后的DnCNN模型。可选地，训练模块40，还用于：对共检波点道集标签数据对进行批标准化，然后对预设DnCNN模型进行训练，利用随机梯度下降法对目标损失函数进行优化。其中，目标损失函数的数学形式包括：其中，l表示目标损失函数，Θ表示DnCNN模型的网络参数，yi表示含噪声数据，xi表示对应的干净数据，N表示切分的数据块的数量，表示预设DnCNN模型的输出。分离模块500，用于利用训练之后的DnCNN模型对目标混合震源地震数据中的混叠噪声进行分离。本发明提供了一种基于边界保持的DnCNN混合震源地震数据分离方法和系统，采用边界保持策略对共检波点地震数据进行重排列，提高了边缘炮的分离信噪比，缓解了现有技术中存在的适应性差、计算效率低的技术问题。本发明实施例还提供了一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，处理器执行计算机程序时实现上述实施例一中的方法的步骤。本发明实施例还提供了一种具有处理器可执行的非易失的程序代码的计算机可读介质，程序代码使处理器执行上述实施例一中的方法。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围。
