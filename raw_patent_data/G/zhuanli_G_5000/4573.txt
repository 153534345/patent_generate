标题title
一种车辆动力电池系统健康状态的评估方法
摘要abst
本发明涉及一种车辆动力电池系统健康状态的评估方法，通过对车辆历史行驶数据筛选得到第一数据片段，第二数据片段，并对第一数据片段整合得到第三数据片段；对第三数据中各充电片段中电池状态评估参数修正，同时计算其对应电压方差，形成修正电池状态评估参数与对应电压方差的关系序列；由修正后的关系序列并结合各充电数据及电池等效模型，计算各充电阶段各电池内阻值，计算相邻充电片段中电池荷电状态重叠区域对应的电压方差和的比值增益、相邻充电片段中各电池内阻偏差量，根据设定的电压方差比值增益风险阈值，电池内阻偏差量累计风险阈值，电池内阻偏差异常值筛选法完成动力电池系统安全性进行多维度评估。
权利要求书clms
1.一种车辆动力电池系统健康状态的评估方法，其特征在于：包括以下步骤：S100、获取车辆动力电池系统历史运行参数数据，从历史运行参数数据中提取第一数据片段和第二数据片段；其中，所述第一数据片段为满足一定充电跨度要求的所有停车充电数据片段，所述第二数据片段为所有满足车辆静置一定时间车辆再启动后数据片段；S101、确定电池状态评估参数，运用随机森林模型或皮尔逊相关系数法，从所述第一数据片段中提取电池状态评估参数及其相关性较高的参数数据，并进行拆解、合并，获得满足计算要求的第三数据片段；对所述第二数据片段进行过滤，去重，获得关系矩阵一；S102、对所述第三数据片段中电池状态评估参数做精度修正，并计算其对应电压方差；对所述关系矩阵一做插值处理，得到关系矩阵二；构建电池等效电路模型，结合电池状态评估参数精度修正后第三数据片段和关系矩阵二，完成各电池内阻估计；S103、用离散变量增量法计算电池状态评估参数精度修正后第三数据片段中所有前后相邻片段中电压方差增益、单体内阻增益，其结果结合建立的电压异常识别方法、内阻异常识别方法和内阻累积风险识别方法完成动力电池系统健康状态的评估。2.根据权利要求1所述的车辆动力电池系统健康状态的评估方法，其特征在于，S100中，所述历史运行参数数据包括各单体电池电压、各单体电池温度、总电流、电池荷电状态SOC和里程； S101中，所述电池状态评估参数为电池荷电状态SOC；所述相关性较高的参数数据为各单体电池电压、总电流；所述第三数据片段为所有满足电池荷电状态SOC跨度限定要求和里程间隔的充电片段集合；所述关系矩阵一为电池荷电状态SOC及对应的开路电压。3.根据权利要求2所述的车辆动力电池系统健康状态的评估方法，其特征在于，S101中所述第三数据片段获得方法是：设置充电起止电池荷电状态SOC限值，设置里程跨度间隔区间；对所述第一数据片段按所述充电起止电池荷电状态SOC限值及所述里程跨度间隔区间进行过滤；同时为确保每个里程跨度间隔内具备满足充电起止电池荷电状态SOC限值的一条充电片段，对所述第一数据片段中里程间隔范围内几个充电片段较短的数据进行合并，获得所述第三数据片段。4.根据权利要求2所述的车辆动力电池系统健康状态的评估方法，其特征在于，S101中所述关系矩阵一的构造方法为：在所述第二数据片段中，提取车辆所有启动数据片段中第一帧数据中的电池荷电状态SOC及对应固定单体电压值，所述对应固定单体电压即为开路电压，并对提取的电池荷电状态SOC做去重处理，仅保留第一次提取的电池荷电状态SOC及开路电压，最后按照电池荷电状态SOC升序，形成一组电池荷电状态SOC与电压对应序列。5.根据权利要求4所述的车辆动力电池系统健康状态的评估方法，其特征在于，S102中所述精度修正，为对所述第三数据片段中各充电片段内连续相同电池荷电状态SOC值做修正，且仅对相同电池荷电状态值的第2个值到最后1个值进行修正；所述精度修正公式为：其中，SOCi为需要修正的荷电状态SOC值，为当前需修正电池荷电状态SOC值在所属相同电池荷电状态SOC中的次序，为电池荷电状态SOC采样最小精度，为当前连续相同电池荷电状态SOC值总数，SOC当前显示值为当前未修正电池荷电状态SOC值，且2≤≤。6.根据权利要求1所述的车辆动力电池系统健康状态的评估方法，其特征在于，S102中所述关系矩阵二构造的步骤为：首先设定电池荷电状态SOC最小增量间距b%，对所述关系矩阵一中电池荷电状态SOC序列按设定电池荷电状态SOC最小增量间距进行等间距插值填补，对新插入的电池荷电状态SOC所对应的开路电压选用拉格朗日插值方法、逐次线性插值法或样条插值法中任意一种插值法进行填充，得到关系矩阵二。7.根据权利要求1所述的车辆动力电池系统健康状态的评估方法，其特征在于，S102中所述电池内阻估计方法为：提取所述电池状态评估参数精度修正后所述第三数据片段中各独立充电片段，循环遍历各独立充电片段中所述各电池荷电状态SOC，并从所述关系矩阵二中找到与之值最临近所述电池荷电状态SOC值所对应的开路电压，即为各充电片段中各电池荷电状态SOC对应的开路电压；建立电池等效模型，结合各独立充电片段中的各单体电压、总电流的时序数据，求得电池等效模型各参数，并由各参数进一步得到各独立充电片段状态下各单体内阻值。8.根据权利要求1所述的车辆动力电池系统健康状态的评估方法，其特征在于，所述S103的操作步骤为：所述离散变量增量法具体计算步骤为：从所述电池状态评估参数精度修正后的第三数据片段中，获取所有充电片段中充电跨度重叠区域，即电池荷电状态SOC重叠区域，在充电跨度重叠区域内，进一步提取所有前后相邻充电片段中相同电池荷电状态SOC所对应的单体电压方差值，然后分别将前后相邻充电片段中所述相同电池荷电状态SOC 对应的电压方差求和， 然后对所有前后相邻充电片段的这些电压方差求和做相除计算，组成一组电压方差和的比值序列；从所述电池状态评估参数精度修正后的第三数据片段中提取各充电片段中各单体内阻值，完成所有相邻充电片段中各单体的内阻偏差绝对值计算，并对各单体的内阻偏差绝对值进行累加，组成各单体内阻偏差绝对值矩阵和各单体内阻偏差累积值矩阵；用电压异常识别方法对所述电压方差和的比值序列值进行异常值识别，若有异常值则判定动力电池系统单体电压状态异常，反之则动力电池系统单体电压状态正常；用内阻异常识别方法对所述各单体内阻偏差绝对值矩阵进行异常值识别，进一步用内阻异常识别方法对各单体内阻偏差绝对值矩阵从上至下逐行或从左到右逐列进行异常值筛选；若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常；用内阻累积风险识别方法对各单体内阻偏差累积值矩阵进行异常值识别；用内阻累积风险识别方法从上之下逐行对各单体内阻偏差累积值矩阵进行识别，若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常。9.根据权利要求8所述的车辆动力电池系统健康状态的评估方法，其特征在于，所述电压异常识别方法、所述内阻异常识别方法及内阻累积风险识别方法为阈值法、箱型图、格拉布斯准则、基于密度的聚类方法中任意一种。
说明书desc
技术领域本发明涉及车辆动力电池系统安全监测技术领域，尤其涉及一种车辆动力电池系统健康状态的评估方法。背景技术电动汽车具有节能环保、低噪无污染、能源转化率高等优势，使得其未来发展前景被广泛看好。动力电池组系统作为电动汽车的三电系统之一，动力电池组的性能直接影响着整车的性能。电池荷电状态SOC是反映动力电池剩余容量和做功能力的一项重要指标，而动力电池组的不一致性是一个不断累积的进程，时间越长单体电池之间发生的差异越大；并且电池组还会受运用环境的影响，尤其新能源车辆上的动力电池组，受复杂运行工况以及外界环境、温度影响，单体电池的不一致性会被逐步加剧，随着某些单体电池加快衰减，最终导致整体动力电池组电池参数的不均衡型；目前，对新能源车辆电池荷电状态SOC状态的评估主要通过数据驱动的方式开展，其原理为通过机器学习、深度学习构建算法模型，通过车辆网数据平台中车辆离线数据不断训练提高模型精度，然后通过采集到实车数据进行预测，并不断的用新获取的数据来训练模型，调整参数来进一步提高模型预估精度，但是该方法需要大量训练样本，对训练样本的质量也要求严格，计算开销大，训练周期较长。发明内容本发明提出一种车辆动力电池系统健康状态的评估方法，通过获取车辆动力电池系统历史运行参数数据，结合电池物理化学特性，运用电池电压参数和内阻参数增益来评估电池健康状态，模型简单可靠，可对不同新能源车型的不同容量动力电池组、以及动力电池组中的单体电池的健康状态进行评估，也可对循环充放电试验的电池进行健康状态进行评估。为了解决上述背景技术中的问题，本发明是通过以下技术方案来实现的：一种车辆动力电池系统健康状态的评估方法，包括以下步骤：S100、获取车辆动力电池系统历史运行参数数据：从历史运行参数数据中提取第一数据片段和第二数据片段；其中，所述第一数据片段为满足一定充电跨度要求的所有停车充电数据片段，所述第二数据片段为所有满足车辆静置一定时间车辆再启动后数据片段；S101、确定电池状态评估参数，运用随机森林模型或皮尔逊相关系数法，从所述第一数据片段中提取电池状态评估参数及其相关性较高的参数数据，并进行拆解、合并，获得满足计算要求的第三数据片段；对所述第二数据片段进行过滤，去重，获得关系矩阵一；S102、对所述第三数据片段中电池状态评估参数做精度修正，并计算其对应电压方差；对所述关系矩阵一做插值处理，得到关系矩阵二；构建电池等效电路模型，结合电池状态评估参数精度修正后第三数据片段和关系矩阵二，完成各电池内阻估计；S103、用离散变量增量法计算电池状态评估参数精度修正后第三数据片段中所有前后相邻片段中电压方差增益、单体内阻增益，其结果结合建立的电压异常识别方法、内阻异常识别方法和内阻累积风险识别方法完成动力电池系统健康状态的评估。优选的，S100中，所述历史运行参数数据包括各单体电池电压、各单体电池温度、总电流、电池荷电状态SOC和里程；S101中，所述电池状态评估参数为电池荷电状态SOC；所述相关性较高的参数数据为各单体电池电压、总电流；所述第三数据片段为所有满足电池荷电状态SOC跨度限定要求和里程间隔的充电片段集合；所述关系矩阵一为电池荷电状态SOC及对应的开路电压。优选的，S101中所述第三数据片段获得方法是：设置充电起止电池荷电状态SOC限值，设置里程跨度间隔区间；对所述第一数据片段按所述充电起止电池荷电状态SOC限值及所述里程跨度间隔区间进行过滤；同时为确保每个里程跨度间隔内具备满足充电起止电池荷电状态SOC限值的一条充电片段，对所述第一数据片段中里程间隔范围内几个充电片段较短的数据进行合并，获得所述第三数据片段。优选的，S101中所述关系矩阵一的构造方法为：在所述第二数据片段中，提取车辆所有启动数据片段中第一帧数据中的电池荷电状态SOC及对应固定单体电压值，所述对应固定单体电压即为开路电压，并对提取的电池荷电状态SOC做去重处理，仅保留第一次提取的电池荷电状态SOC及开路电压，最后按照电池荷电状态SOC升序，形成一组电池荷电状态SOC与电压对应序列。优选的，S102中所述精度修正，为对所述第三数据片段中各充电片段内连续相同电池荷电状态SOC值做修正，且仅对相同电池荷电状态值的第2个值到最后1个值进行修正；所述精度修正公式为：SOCi为需要修正的荷电状态SOC值，为当前需修正电池荷电状态SOC值在所属相同电池荷电状态SOC中的次序，为电池荷电状态SOC采样最小精度，为当前连续相同电池荷电状态SOC值总数，SOC当前显示值为当前未修正电池荷电状态SOC值，且2≤≤。优选的，S102中所述关系矩阵二构造的步骤为：首先设定电池荷电状态最小增量间距b%，对所述关系矩阵一中电池荷电状态SOC序列按设定电池荷电状态SOC最小增量间距进行等间距插值填补，对新插入的电池荷电状态SOC所对应的开路电压选用拉格朗日插值方法、逐次线性插值法或样条插值法中任意一种插值法进行填充，得到二。优选的，S102中所述电池内阻估计方法为：提取所述电池状态评估参数精度修正后所述第三数据片段中各独立充电片段，循环遍历各独立充电片段中所述各电池荷电状态SOC，并从所述关系矩阵二中找到与之值最临近所述电池荷电状态SOC值所对应的开路电压，即为各充电片段中各电池荷电状态SOC对应的开路电压；建立电池等效模型，结合各独立充电片段中的各单体电压、总电流的时序数据，求得电池等效模型各参数，并由各参数进一步得到各独立充电片段状态下各单体内阻值。优选的，所述S103的操作步骤为：离散变量增量法具体计算步骤为：从所述电池状态评估参数精度修正后的第三数据片段中，获取所有充电片段中充电跨度重叠区域，即电池荷电状态SOC重叠区域，在充电跨度重叠区域内，进一步提取所有前后相邻充电片段中相同电池荷电状态SOC所对应的单体电压方差值，然后分别将前后相邻充电片段中所述相同电池荷电状态SOC 对应的电压方差求和， 然后对所有前后相邻充电片段的这些电压方差求和做相除计算，组成一组电压方差和的比值序列；从所述电池状态评估参数精度修正后的第三数据片段中提取各充电片段中各单体内阻值，完成所有相邻充电片段中各单体的内阻偏差绝对值计算，并对各单体的内阻偏差绝对值进行累加，组成各单体内阻偏差绝对值矩阵和各单体内阻偏差累积值矩阵；用电压异常识别方法对所述电压方差和的比值序列值进行异常值识别，若有异常值则判定动力电池系统单体电压状态异常，反之则动力电池系统单体电压状态正常；用内阻异常识别方法对所述各单体内阻偏差绝对值矩阵进行异常值识别，进一步用内阻异常识别方法对各单体内阻偏差绝对值矩阵从上至下逐行或从左到右逐列进行异常值筛选；若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常；用内阻累积风险识别方法对各单体内阻偏差累积值矩阵进行异常值识别；用内阻累积风险识别方法从上之下逐行对各单体内阻偏差累积值矩阵进行识别，若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常。优选的，所述电压异常识别方法、所述内阻异常识别方法及内阻累积风险识别方法为阈值法、箱型图、格拉布斯准则、基于密度的聚类方法中任意一种。与现有技术相比，本发明具有以下有益的技术效果：通过获取车辆动力电池系统历史运行参数数据，结合电池物理化学特性，运用电池电压参数和内阻参数增益来评估电池健康状态，模型简单可靠，可对不同新能源车型的不同容量动力电池组、以及动力电池组中的单体电池的健康状态进行评估，也可对循环充放电试验的电池进行健康状态进行评估。附图说明图1为本发明的流程示意图；图2为本发明实施例2中某车辆发生热失控前临近四条深度片段各电池荷电状态SOC计算得到对应的电压方差图；图3为本发明实施例3中某车辆发生热失控前相邻充电片段方差和比值增益图；图4为本发明实施例1中6σ准则示意图；图5为本发明实施例1中关系矩阵一示意图；图6为本发明实施例1中关系矩阵二示意图。具体实施方式实施例1如图1所示，一种车辆动力电池系统健康状态的评估方法，包括以下步骤：S100、获取车辆动力电池系统历史运行参数数据：从历史运行参数数据中提取第一数据片段和第二数据片段；其中，所述第一数据片段为满足一定充电跨度要求的所有停车充电数据片段，所述第二数据片段为所有满足车辆静置一定时间车辆再启动后数据片段；第一数据片段筛选原则：从上述车辆历史运行数据中，首先筛选出所有停车充电数据片段，其次按设定的停车充电电池荷电状态SOC跨度最小限值，对上述所有停车充电片段中在进一步筛选，并按照时序进行排列。其中满足电池荷电状态SOC跨度最小限值的各充电片段中电池荷电状态SOC变化求连续，在本实施例中以充电电池荷电状态SOC跨度最小为30%为限。本发明选用充电阶段数据做动力电池系统健康状态的评估，其主要原因在充电阶段，电池所有信号受外界干扰噪音较小，可以通过细微的数据分析，就能对电池状态进行诊断。第二数据片段筛选原则：从上述车辆历史运行数据中，筛选出所有停车时长超过最小限定后车辆再次启动后的数据片段，并将筛选出各片段按时间轴顺序依次排列。在本实施例中，设定停车放电最小限定时长为5小时，将停车放电超过5小时后车辆启动后的数据片段进行保留，为避免数据丢失引起的筛选错误，本发明中对时间间隔超过五小时前后，上一片段最后一帧数据和筛选出的数据片段第一帧数据的里程进行比较，若相同则判断为停车放电状态，而非数据丢失。S101、确定电池状态评估参数，运用随机森林模型或皮尔逊相关系数法，从所述第一数据片段中提取电池状态评估参数及其相关性较高的参数数据，并进行拆解、合并，获得满足计算要求的第三数据片段；对所述第二数据片段进行过滤，去重，获得关系矩阵一；本实施例选定SOC为电池状态评估参数，电池SOC即荷电状态，是用来反映电池的剩余容量，荷电状态SOC及相关性较强的特征参数也能对电池状态进行评估。选取荷电状态SOC对应相关性较强的特征参数的具体方法是：提取第一数据片段中某一充电片段数据，用随机森林模型确定其荷电状态SOC相关性较高的总电流和电池单体电压两个参数，从第一数据片段提取总电流、电池单体电压，荷电状态SOC三个参数数据，对提取到的数据再次过滤、整合，得到满足计算要求第三数据片段。其所述的第三数据片段是满足充电开始和结束时荷电状态SOC限定要求的充电片段集合，且各充电片段之间满足一定里程间隔。由于一些城市内运输工况，新能源轻卡在实际使用过程中，司机很少有将车辆电池从放空到再充满的习惯，这就导致在各停车充电片段，充电起始和充电截止荷电状态SOC不一致，充电跨度区间有长有短。为达到第三数据片段中各充电跨度充电起始和充电截止荷电状态SOC的要求以及里程间隔要求，就需要将临近的在一定里程范围内几个较短的几个充电片段数据通过一定策略进行整合。这里对在一定里程范围内的较短数据进行整合，其主要目的是，在一定里程范围内，电池的健康状态一般不会有较大的改变。在本实施例中，对第三数据片段中各相邻充电片段里程间隔设定小于500公里，若需对的几个较短充电片段数据进行整合，只需判断待整合的第一个充电片段和最后一个充电片段里程间隔在500公里内即可。在此需要说明，在对几个充电片段的数据进行合并时候，会出现充电跨度重合区域，对重合区域的数据合并策略，具体策略如下：首先，需合并的几条充电片段中数据采样间隔均相同，且荷电状态SOC最小变化精度均为固定值，对充电跨度重合区域的数据合并，仅保留对应各荷电状态SOC时，数据条数为众数的所对应的所有数据。若众数非唯一，则荷电状态SOC所对应的电流，单体电压、里程取均值，例如，本实施例中，需要对一段里程内三条较短充电片段数据进行合并，其共同充电跨度区间荷电状态SOC40%-荷电状态SOC60%，在实际充电过程中会出现不同充电片段，相同荷电状态SOC的情况下对应好几条采集充电数据，如，在荷电状态SOC=40%的情况下，第一个充电片段对应采样数据为5条；第二个充电片段对应采样数据为6条；第三个充电片段对应采样数据为5条。根据众数原则。仅保留荷电状态SOC=40%为5条的数据，其中荷电状态SOC=40%为5条的数据为第一个充电片段和第三个充电片段，其荷电状态SOC=40%对应的电流、各单体电压为第一个充电片段、第三个充电片段荷电状态SOC=40%对应各电流、电压值的均值，需要说明其里程值均为三条充电片段中对应里程的平均值，依次类推，可用上述方法对满足条件的临近较短充电片段的数据整合。S102：对所述第三数据片段中电池状态评估参数做精度修正，并计算其对应电压方差；对关系矩阵一做插值处理，得到关系矩阵二；构建电池等效电路模型，结合电池状态评估参数精度修正后第三数据片段和关系矩阵二，完成各电池内阻估计；S103：用离散变量增量法计算电池状态评估参数精度修正后第三数据片段中所有前后相邻片段中电压方差增益、单体内阻增益，其结果结合建立的电压异常识别方法、内阻异常识别方法和内阻累积风险识别方法完成动力电池系统健康状态的评估。离散变量增量法计算步骤为：在对电池荷电状态SOC精度经过修正后的第三数据片段中，获取所有充电片段中充电跨度重叠区域，计算所有前后充电片段中充电跨度重叠区域内相同SOC对应的单体电压方差，并将每个充电片段中计算得到电压方差值进行求和，然后依次对所有前后相邻充电片段电压方差值的和相除。并同时对每个充电片段中各电池单体内阻估算值，计算所有相邻前后充电片段中各单体内阻偏差，组成一组电压方差和的比值序列及单体内阻偏差矩阵。该方法通过在稳定工况下，计算临近充电片段中关键参数的增益变化，并进一步通过模型分析、评估电池健康状态，其方法具有明显的理论及物理意义。S100中，历史运行参数数据包括各单体电池电压、各单体电池温度、总电流、电池荷电状态SOC和里程；S101中，电池状态评估参数为电池荷电状态SOC；相关性较高的参数数据为各单体电池电压、总电流；第三数据片段为所有满足电池荷电状态SOC跨度限定要求和里程间隔的充电片段集合；关系矩阵一为电池荷电状态SOC及对应的开路电压。S101中第三数据片段获得方法是：设置充电起止电池荷电状态SOC限值，设置里程跨度间隔区间；对第一数据片段按充电起止电池荷电状态SOC限值及里程跨度间隔区间进行过滤；同时为确保每个里程跨度间隔内具备满足充电起止电池荷电状态SOC限值的一条充电片段，对第一数据片段中里程间隔范围内几个充电片段较短的数据进行合并，获得第三数据片段。S101中关系矩阵一的构造方法为：在第二数据片段中，提取车辆所有启动数据片段中第一帧数据中的电池荷电状态SOC及对应固定单体电压值，对应固定单体电压即为开路电压，并对提取的电池荷电状态SOC做去重处理，仅保留第一次提取的电池荷电状态SOC及开路电压，最后按照电池荷电状态SOC升序，形成一组电池荷电状态SOC与电压对应序列。S102中精度修正，为对第三数据片段中各充电片段内连续相同电池荷电状态SOC值做修正，且仅对相同电池荷电状态值的第2个值到最后1个值进行修正；精度修正公式为：SOC为需要修正的荷电状态SOC值，为当前需修正电池荷电状态SOC值在所属相同电池荷电状态SOC中的次序，为电池荷电状态SOC采样最小精度，为当前连续相同电池荷电状态SOC值总数，SOC当前显示值为当前未修正电池荷电状态SOC值，且2≤≤。在本实施例中，某一充电片段中，数据采样间隔均为10s，电池荷电状态SOC精度为1%。若在电池荷电状态SOC=30%充电到电池荷电状态SOC=31%的时候，一共有5条电池荷电状态SOC=30%的采样数据，根据实际电池荷电状态SOC值是一直变化增加的，主要是由于显示精度问题，所以要对相同的电池荷电状态SOC值进行修正，对电池荷电状态SOC的进一步修正也为后续电池内阻的预估精度带来提升，设置电池荷电状态SOC修正变化最小值间隔值为1%/5=0.02，第一个电池荷电状态SOC=30%无需修正，连续第二个原始值电池荷电状态SOC=30%修正为30.2%，连续第三个原始值电池荷电状态SOC=30%修正为30.4%，连续原始值第四个电池荷电状态SOC=30%修正为30.6%，连续原始值第五个电池荷电状态SOC=30%修正为30.8%。S102中关系矩阵二构造的步骤为：首先设定电池荷电状态SOC最小增量间距b%，对所述关系矩阵一中电池荷电状态序列按设定电池荷电状态最小增量间距进行等间距插值填补，对新插入的电池荷电状态所对应的开路电压选用拉格朗日插值方法、逐次线性插值法或样条插值法中任意一种插值法进行填充，得到关系矩阵二。S102中电池内阻估计方法为：提取电池状态评估参数精度修正后所述第三数据片段中各独立充电片段，循环遍历各独立充电片段中各电池荷电状态SOC，并从关系矩阵二中找到与之值最临近电池荷电状态SOC值所对应的开路电压，即为各充电片段中各电池荷电状态SOC对应的开路电压；建立电池等效模型，结合各独立充电片段中的各单体电压、总电流的时序数据，求得电池等效模型各参数，并由各参数进一步得到各独立充电片段状态下各单体内阻值。后续要估算每个充电片段中各单体内阻值，需要用到上述各充电片段的参数以及关系矩阵一，由于前述对各充电片段的电池荷电状态SOC值做了进一步修正，其电池荷电状态SOC精度有了提高，所以就需要对关系矩阵一做进一步修正，得到关系矩阵二，此举能进一步提高后续电池内阻估计精度。对关系矩阵一进一步修正方法是，结合本实施例，当前电池荷电状态SOC采样最小精度为1%，设定电池荷电状态SOC最小增量间距为1%/10=0.1%，对关系矩阵一中的电池荷电状态SOC序列值按设定最小增量间距进行等间距补充，得到更新后的电池荷电状态SOC序列，对插入后的电池荷电状态SOC所对应的开路电压的求解方法，本实施例采用三次样条插值法，得到更新后的电池荷电状态SOC序列对应的开路电压值，由等间距插值后的电池荷电状态SOC序列和插值后开路电压值序列即组成关系矩阵二。其进一步修正的目的是因为实际电池荷电状态SOC采集显示精度问题，如果不对提取的关系矩阵一做进一步修正，则所提供关系矩阵一为后续电池内阻预估的精度带来较大影响。根据关系矩阵二，结合修正后第三数据片段中各充电片段中电池参数数据，完成各充电片段下各单体电池内阻估计。在本实施例中，计算某一充电片段中各电池内阻估计方法为：提取该充电片段中各单体电压时序值、总电流时序值、对应电池荷电状态SOC时序值。循环遍历该充电片段中电池荷电状态SOC序列中每一个电池荷电状态SOC值，在关系矩阵一电池荷电状态SOC列中匹配与之最接近电池荷电状态SOC值所对应的开路电压。依次类推，得到该充电片段下，各电池荷电状态SOC与开路电压对应关系。其中，各单体电压时序值即为各单体端电压，总电流时序值即为端电流。建立二阶RC等效电路模型，对等效电路模型的表达式进行离散化处理，得到拉氏变化后的方程，采用双线性变换，得到等效电路模型系统输入与系统输出的差分方程，建立递推最小二乘法，由实际获得充电阶段电池各参数，进行模型参数辨识，由辨识的参数并结合等效电路模型，求得模型中各参数值，进而求得各单体内阻值。以此类推，得到修正后第三数据片段中各充电片段内各单体内阻值。S103的操作步骤为：离散变量增量法具体计算步骤为：从电池状态评估参数精度修正后的第三数据片段中，获取所有充电片段中充电跨度重叠区域，即电池荷电状态SOC重叠区域，在充电跨度重叠区域内，进一步提取所有前后相邻充电片段中相同电池荷电状态SOC所对应的单体电压方差值，然后分别将前后相邻充电片段中所述相同电池荷电状态SOC 对应的电压方差求和， 然后对所有前后相邻充电片段的这些电压方差求和做相除计算，组成一组电压方差和的比值序列；从电池状态评估参数精度修正后的第三数据片段中提取各充电片段中各单体内阻值，完成所有相邻充电片段中各单体的内阻偏差绝对值计算，并对各单体的内阻偏差绝对值进行累加，组成各单体内阻偏差绝对值矩阵和各单体内阻偏差累积值矩阵；用电压异常识别方法对电压方差和的比值序列值进行异常值识别，若有异常值则判定动力电池系统单体电压状态异常，反之则动力电池系统单体电压状态正常；用内阻异常识别方法对各单体内阻偏差绝对值矩阵进行异常值识别，进一步用内阻异常识别方法对各单体内阻偏差绝对值矩阵从上至下逐行或从左到右逐列进行异常值筛选；若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常；用内阻累积风险识别方法对各单体内阻偏差累积值矩阵进行异常值识别；用内阻累积风险识别方法从上之下逐行对各单体内阻偏差累积值矩阵进行识别，若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常。进一步，用电压异常识别方法对上述电压方差和的比值序列值进行异常值识别，若有异常值则判定其所对应临近前后两次充电片段中后一段的充电片段中存在动力电池系统单体电压状态异常，反之则动力电池系统单体电压状态正常；在本实施例中，是通过设置电压阈值来判断临近前后充电片段电压方差和比值增益是否为异常值。本实施例中，首先，挑选相同车型、同运行工况下，100辆正常车辆的历史充电片段，计算得到所有前后充电片段电压方差和比值增益，然后依据6σ准则确定电压方差和比值增益阈值范围，6σ范围如图4所示；根据6σ准则得到的电压方差和阈值为2×+6×标准差），最终得到电压方差和的比值增益正常的阈值范围为0.95-1.05，若比值增益超过这个区间范围则可判断出现电池电压异常。其依此方法，判断电池系统状态的其他参数相关特征参量阈值确定也可用。进一步的，用内阻异常识别方法对所述各单体内阻偏差绝对值矩阵进行异常值识别，对各单体内阻偏差绝对值矩阵从上至下逐行或从左到右逐列进行异常值筛选。若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常。在本实施例中，由第三数据片段，计算前后相邻充电片段相同单体内阻偏差绝对值并组成，其中表示电池单体序号； 表示对应充电片段序号；如图5所示关系矩阵一：m-1/m表示在第个电池在第-1充电片段下估算内阻与第充电片段下估算内阻偏差量的绝对值。本实施例中，用基于密度的DBSCAN聚类算法来逐行识别每一行的内阻偏差量异常值。进一步的，用内阻累积风险识别方法对各单体内阻偏差累积值矩阵进行异常值识别。具体方法为：用内阻累积风险识别方法从上之下逐行对各单体内阻偏差累积值矩阵进行识别，若有异常值则判定动力电池系统单体内阻状态异常，反之则动力电池系统单体内阻状态正常。本实施例，根据上述计算得到大小的内阻偏差量矩阵，对每一列内阻偏差绝对值并进行累加，当某单体电池内阻变化增量和超过预设阈值时，则判断该单体电池存在容量衰减异常风险。本实施例，选用斜率法评估每个单体电池内阻变化累计增量情况，即将上述大小内阻偏差量矩阵做如下调整，将某行某列的内阻偏差量加上当前列之前所有的偏差量形成新的当前行当前列的累积内阻偏差量，依次类推，组成如图6所示关系矩阵二；同时对每一列的值进行折线图绘制，若某列值的斜率大于预设警戒值，则判断当前列所对应的序号单体的内阻出现异常。电压异常识别方法、内阻异常识别方法及内阻累积风险识别方法为阈值法、箱型图、格拉布斯准则、基于密度的聚类方法中任意一种。实施例2如图2所示为某车辆发生热失控前临近四条深度片段各电池荷电状态SOC计算得到对应的电压方差图，其中线图2、线图3、线图4分别为热失控发生前倒数第二次、倒数第三次，倒数第四次深度充电片段中各电池荷电状态SOC对应电压方差曲线图，线图1为热失控发生前最后一次各深度充电片段中电池荷电状态SOC对应电压方差曲线图，运用上述方法，可以明显看出，线图2、线图3、线图4的深度充电片段在充电中期，其电压方差变化幅度基本保持一致，并且各电池荷电状态SOC对应的电压方差无明显差异，而线图1在在充电中期，其电压方差已明显偏离其他三个线图各电池荷电状态SOC对应的电压方差，为便于量化变化量，本实施例中，选取四条充电片段共同的充电区域，作为量值衡量设定区间，即对重叠区域电池荷电状态SOC1~电池荷电状态SOC2内四条充电片段内电压方差和进行计算，并进行前后值比较，其中，电池荷电状态SOC=40%，电池荷电状态SOC=60%。实施例3如图3所示为某车辆发生热失控前相邻充电片段方差和比值增益图，本实例选取热失控前八次充电片段各相邻充电电压方差和比值点图，横坐标8/7，...，2/1，分别表示热时控前倒数第八次充电片段与第七次充电片段电压方差和比值对应序号，...，热时控前倒数第2次充电片段与最后1次充电片段中电压方差和比值对应序号，其中，各充电片段已满足第三充电片段中对各充点片段要求，本实例中，预设正常增益区间范围为，a1=0.95，a2=1.05，可以看出在热时控发生前8/7，7/6，6/5，...，3/2各电池荷电状态SOC重叠区域对应电压方差和比值增益均在正常范围内，而2/1即倒数第2次充电片段与最后1次充电片段中电压方差和比值明显低于正常阈值下限值0.95，说明在最后一次充电过程中，电压出现明显波动，有上述方法即可判断在最后一次充电过程中，电池状态出现异常。
