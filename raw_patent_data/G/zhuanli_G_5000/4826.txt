标题title
一种用于提高临床严重度评分预测效能的方法
摘要abst
本发明公开了一种用于提高临床严重度评分预测效能的方法。本发明将患者的临床情况根据某种预测评分转化为多维向量，每个多维向量代表了患者不同的临床特征。然后创建一个虚拟的危重向量，危重向量的各项临床特征都是评分中最危重的临床情况。通过计算向量夹角余弦值的方式比较每一个患者与危重向量之间的相似度，利用相似度来计算预测临床结局的AUC值。本发明首先计算AUC值对于危重向量各维度分值的偏导数，然后通过偏导数的正负调整其所在维度分值的大小，进而调整危重向量的方向，找出最佳的危重向量和最大的AUC值。
权利要求书clms
1.一种用于提高临床严重度评分预测效能的方法，其特征在于，包括以下步骤：使用临床某种预测评分使用的评价指标i以及其评价指标阳性的赋分值ti，其中i为评价指标序号，共有n个评价指标，则i取值为1～n的整数；收集步骤中疾病类型的患者信息，并根据步骤评价指标以及各评价指标的赋分值对每个患者的每个评价指标进行赋分，若第i个评价指标阳性，则对该评价指标赋分ti；若第i个评价指标阴性，则对该评价指标赋分-ti，将每个患者的各个评价指标的赋分信息转化成一个对应的多维度向量，命名为患者向量Vp，患者向量Vp的维度为n，每个维度的取值为赋分的ti或-ti；设定一个所有评价指标均为阳性的危重向量Vm，危重向量Vm的维度为n，设定最初的危重向量为Vm0，Vm0每个维度的初值为评分的赋分值ti；计算每个患者的患者向量Vp与危重向量Vm之间夹角θ的余弦值，余弦值的取值范围在-1到1之间；然后将余弦值归一化，转化为0～1之间的数，称为相似度；利用相似度制作临床结局指标的ROC曲线和计算AUC值，然后求解AUC值相对于当前危重向量各维度分值ti的偏导数，根据每个维度偏导数的正负值调整该维度的分值，如果偏导数为正，ti加delta，如果偏导数为负，ti减delta；利用修正后的ti得到修正后的危重向量Vm1；重复步骤～，对危重向量Vm进行迭代修正，直到各偏导数为0，此时求出最佳危重向量Voptimality和AUC的最大值。2.根据权利要求1所述用于提高临床严重度评分预测效能的方法，其特征在于，所述疾病类型为社区获得性肺炎，评分方法为PSI评分、CURB-65评分、SMART-COP评分或A-DROP评分；所述疾病类型为重症和创伤系统，评分方法为Glasgow评分或APACHE评分；所述疾病类型为脑卒中，评分方法为ABCD2评分；所述疾病类型为肺栓塞，评分方法为Geneva评分。3.根据权利要求2所述用于提高临床严重度评分预测效能的方法，其特征在于，所述疾病类型为社区获得性肺炎，使用PSI评分方法，评价指标共19个，分别为：年龄，长期看护医院病史，肿瘤疾病史，慢性肝病史，充血性心衰病史，脑血管疾病史，慢性肾病史，意识状态改变，呼吸频率，收缩压，体温，脉搏，动脉血pH值，血尿素氮，血钠，血糖，血红蛋白比容，动脉氧分压，影像学胸膜浸润。4.根据权利要求3所述用于提高临床严重度评分预测效能的方法，其特征在于，其中，年龄作为评价指标时，根据年龄大小进行赋分，赋分值ti为：男性为实际年龄值，女性为实际年龄值减10；其余各评价指标阳性标准及赋分值ti分别为：5.根据权利要求2所述用于提高临床严重度评分预测效能的方法，其特征在于，所述疾病类型为社区获得性肺炎，使用CURB-65评分方法，评价指标共5个，分别为：年龄，意识状态，血尿素氮，呼吸频率，血压，各评价指标阳性标准及赋分值ti分别为：6.根据权利要求1所述用于提高临床严重度评分预测效能的方法，其特征在于，步骤中余弦值的计算方法：步骤中通过公式将余弦值归一化，得到相似度。7.根据权利要求1所述用于提高临床严重度评分预测效能的方法，其特征在于，步骤中用第i个评价指标的偏导数Pd的计算方法为：其中，Xi：第i个评价指标对应坐标维度的当前分值；d：X变化的步长；AUC：代表其他维度的赋分值不变，仅第i个评价指标对应坐标轴的分值X增加d后的AUC值；AUC：Xi未变化时的AUC值。8.根据权利要求7所述用于提高临床严重度评分预测效能的方法，其特征在于，第i个评价指标的偏导数计算时，d的大小为ti值的1/10到1之间；delta的取值与对应的评价指标在计算偏导数时候的步长d相同。9.一种用于提高临床评分预测效能的系统，其特征在于，包括样本信息模块和数据处理模块，所述样本信息模块用于输入权利要求1所述方法中的所述患者信息，并将患者信息输出给数据处理模块，所述数据处理模块用于按照权利要求1所述方法对患者信息进行处理，并处理得到最佳危重向量Voptimality和AUC的最大值。
说明书desc
技术领域本发明属于临床危险度分级和机器学习领域，具体涉及一种用于提高临床严重度评分预测效能的方法。背景技术利用临床评分来对患者进行危险度分级是目前一种广泛应用的方法。严重度评分中一般有多个评价指标，每一个评价指标都被赋予一个分值，将所有分值相加就是某个患者的严重度得分，然后根据得分的高低来评估患者的病情严重性。由于每一个危险因素对结局影响的权重不同，如果统一赋予相同的分值势必影响评分的预测效能；如果赋予了各项指标不同的分值，如何分配分值的大小又缺乏统一有效的方法。比如社区获得性肺炎中的CURB-65评分:377–82.)，每个预测指标都是1分。社区获得性肺炎中的PSI评分:243–50.)，每个指标分值在10-30不等。综上，急需一种科学高效的赋值方法，通过精确调整严重度评分中不同指标所对应的分值，来提高评分的预测效能。发明内容本发明针对现有技术中存在的上述不足，提供了一种用于提高临床严重度评分预测效能的方法。一种用于提高临床严重度评分预测效能的方法，包括以下步骤：使用临床某种预测评分使用的评价指标i以及其评价指标阳性的赋分值ti，其中i为评价指标序号，共有n个评价指标，则i取值为1～n的整数；收集步骤中疾病类型的患者信息，并根据步骤评价指标以及各评价指标的赋分值对每个患者的每个评价指标进行赋分，若第i个评价指标阳性，则对该评价指标赋分ti；若第i个评价指标阴性，则对该评价指标赋分-ti，将每个患者的各个评价指标的赋分信息转化成一个对应的多维度向量，命名为患者向量Vp，患者向量Vp的维度为n，每个维度的取值为赋分的ti或-ti；设定一个所有评价指标均为阳性的危重向量Vm，危重向量Vm的维度为n，设定最初的危重向量为Vm0，Vm0每个维度的初值为评分的赋分值ti；计算每个患者的患者向量Vp与危重向量Vm之间夹角θ的余弦值，余弦值的取值范围在-1到1之间；然后将余弦值归一化，转化为0～1之间的数，称为相似度；利用相似度制作临床结局指标的ROC曲线和计算AUC值，然后求解AUC值相对于当前危重向量各维度分值ti的偏导数，根据每个维度偏导数的正负值调整该维度的分值，如果偏导数为正，ti加delta，如果偏导数为负，ti减delta；利用修正后的ti得到修正后的危重向量Vm1；重复步骤～，对危重向量Vm进行迭代修正，直到各偏导数为0，此时求出最佳危重向量Voptimality和AUC的最大值。即利用步骤修正后的危重向量Vm1重新计算患者向量和Vm1的相似度，然后利用相似度再次计算AUC值和求解偏导数，然后再次利用偏导数的正负值对每个维度的分值ti进行修正，从而一步一步迭代，直到各偏导数为0时，得到最佳危重向量Voptimality和AUC的最大值，这个最佳危重向量Voptimality中对应各评价指标的分值即为优化之后在PSI评分方法中各评价指标的权重分值。本发明用于提高临床严重度评分预测效能的方法适用于任意在临床上采用评分方式进行的疾病类型。比如，所述疾病类型为社区获得性肺炎，评分方法为PSI评分、CURB-65评分、SMART-COP评分或A-DROP评分；所述疾病类型为重症和创伤系统，评分方法为Glasgow评分或APACHE评分；所述疾病类型为脑卒中，评分方法为ABCD2评分；所述疾病类型为肺栓塞，评分方法为Geneva评分。只要是临床上使用的采用多指标评分系统来预测评估临床严重度的，都能够使用本发明方法进行优化。对于社区获得性肺炎来说，使用PSI评分方法，评价指标共19个，分别为：年龄，长期看护医院病史，肿瘤疾病史，慢性肝病史，充血性心衰病史，脑血管疾病史，慢性肾病史，意识状态改变，呼吸频率，收缩压，体温，脉搏，动脉血pH值，血尿素氮，血钠，血糖，血红蛋白比容，动脉氧分压，影像学胸膜浸润。其中，年龄作为评价指标时，根据年龄大小进行赋分，赋分值ti为：男性为实际年龄值，女性为实际年龄值减10；其余各评价指标阳性标准及赋分值ti分别为：所述疾病类型为社区获得性肺炎，使用CURB-65评分方法，评价指标共5个，分别为：年龄，意识状态，血尿素氮，呼吸频率，血压，各评价指标阳性标准及赋分值ti分别为：本发明所述用于提高临床严重度评分预测效能的方法，步骤中余弦值的计算方法：步骤中通过公式将余弦值归一化，得到相似度。优选的，步骤中用第i个评价指标的偏导数Pd的计算方法为：其中，Xi：第i个评价指标对应坐标维度的当前分值；d：X变化的步长；AUC：代表其他维度的赋分值不变，仅第i个评价指标对应坐标轴的分值X增加d后的AUC值；AUC：Xi未变化时的AUC值。进一步优选的，第i个评价指标的偏导数计算时，d的大小为ti值的1/10到1之间；delta的取值与对应的评价指标在计算偏导数时候的步长d相同。本发明又提供了一种用于提高临床评分预测效能的系统，包括样本信息模块和数据处理模块，所述样本信息模块用于输入所述方法中的所述患者信息，并将患者信息输出给数据处理模块，所述数据处理模块用于按照所述方法对患者信息进行处理，并处理得到最佳危重向量Voptimality和AUC的最大值。有益效果：本发明将患者的临床情况根据某种预测评分转化为多维向量，每个多维向量代表了患者不同的临床特征。然后创建一个虚拟的危重向量，危重向量的各项临床特征都是评分中最危重的临床情况。通过计算向量夹角余弦值的方式比较每一个患者与危重向量之间的相似度，利用相似度来计算预测临床结局的AUC值。由于最初设定的危重向量各个维度的分值尚未优化，故此时危重向量所指的方向并非最佳，其计算出的相似度也不能最大化预测评分的性能。本发明首先计算AUC值对于危重向量各维度分值的偏导数，然后通过偏导数的正负调整其所在维度分值的大小，进而调整危重向量的方向，找出最佳的危重向量和最大的AUC值。与未优化前的评分相比，调整后的严重度评分其AUC值可以较前提升约5-10％。附图说明图1为实施例1中PSI评分权重优化过程中的AUC值变化结果图。图2为实施例1PSI评分权重优化过程中各项评价指标的分值变化结果图。图3为实施例2中CURB-65评分权重优化过程中的AUC值变化结果图。图4为实施例2CURB-65评分权重优化过程中各项评价指标的分值变化结果图。具体实施方式本发明一种用于提高临床严重度评分预测效能的方法，步骤如下：使用临床某种预测评分使用的评价指标i以及其评价指标阳性的赋分值ti，其中i为评价指标序号，共有n个评价指标，则i取值为1～n的整数。收集步骤中疾病类型的患者信息，并根据步骤评价指标以及各评价指标的赋分值对每个患者的每个评价指标进行赋分，若第i个评价指标阳性，则对该评价指标赋分ti；若第i个评价指标阴性，则对该评价指标赋分-ti，将每个患者的各个评价指标的赋分信息转化成一个对应的多维度向量，命名为患者向量Vp，患者向量Vp的维度为n，每个维度的取值为赋分的ti或-ti。设定一个所有评价指标均为阳性的危重向量Vm，危重向量Vm的维度为n，设定最初的危重向量为Vm0，Vm0每个维度的初值为评分的赋分值ti。计算每个患者的患者向量Vp与危重向量Vm之间夹角θ的余弦值，余弦值的计算方法：余弦值的取值范围在-1到1之间；然后将余弦值通过公式进行归一化，转化为0～1之间的数，称为相似度。利用相似度制作临床结局指标的ROC曲线和计算AUC值，然后求解AUC值相对于当前危重向量各维度分值ti的偏导数，用第i个评价指标的偏导数Pd的计算方法为：其中，Xi：第i个评价指标对应坐标维度的当前分值；d：X变化的步长，第i个评价指标的偏导数计算时，d的大小为ti值的1/10到1之间；AUC：代表其他维度的赋分值不变，仅第i个评价指标对应坐标轴的分值X增加d后的AUC值；AUC：Xi未变化时的AUC值。根据每个维度偏导数的正负值调整该维度的分值，如果偏导数为正，ti加delta，如果偏导数为负，ti减delta；利用修正后的ti得到修正后的危重向量Vm1；delta的取值与对应的评价指标在计算偏导数时候的步长d相同。重复步骤～，对危重向量Vm进行迭代修正，直到各偏导数为0，此时求出最佳危重向量Voptimality和AUC的最大值。实施例1从国内的三家医院回顾性选取了327例社区获得性肺炎的患者伦审研第号)，收集其入院治疗当天的临床特征并进行PSI评分，共有19个评价指标，分别为：年龄，长期看护医院病史，肿瘤疾病史，慢性肝病史，充血性心衰病史，脑血管疾病史，慢性肾病史，意识状态改变，呼吸频率，收缩压，体温，脉搏，动脉血PH值，血尿素氮，血钠，血糖，血红细胞比容，动脉氧分压，影像学胸膜浸润。根据PSI评分方法，每一个评价指标视为一个维度。将患者信息转化为患者向量。各评价指标阳性标准及阳性赋分值如表1所示。患者向量和危重向量中按表1中评价指标从上到下的先后顺序排列。表1年龄维度为患者的实际年龄，如果是女性患者则为年龄-10。例如，一个年龄89岁，有充血性心衰，意识状态不清，呼吸频率为35次/分，收缩压为80mm Hg，静脉血糖为20mmol/L，动脉血氧分压为55mmHg，肺部CT提示胸腔积液，其余指标皆为正常的女性患者，其转化后的患者向量为：。优化前的危重向量各项取值为评分的默认值，为，坐标轴排序与患者向量相同。利用PSI评分预测30天全因病死率的初始AUC值为0.651。利用本发明方法，通过约70次迭代调整危重向量的方向后，AUC值趋于稳定。为了防止过拟合，对结果进行了K折交叉验证。结果如图1和图2所示。优化后的危重向量为，预测30天全因病死率的AUC值为0.717，相比之前提升约10％，二者有统计学差异。实施例2利用实施例1中的327例病人，收集其入院治疗当天的临床特征并进行CURB-65评分，共有5个评价指标，分别为：年龄，意识状态，血尿素氮，呼吸频率，血压。根据CURB-65评分方法，每一个评价指标视为一个维度。将患者信息转化为患者向量。各评价指标阳性标准及阳性赋分值如表2所示。患者向量和危重向量中按表2中评价指标从上到下的先后顺序排列。表2例如，一个年龄89岁，有意识状态不清，呼吸频率为35次/分，收缩压为80mm Hg，舒张压50mmHg，其余指标皆为正常的女性患者，其转化后的患者向量为：。优化前的危重向量各项取值为评分的默认值，为，坐标轴排序与患者向量相同。利用CURB-65评分预测30天全因病死率的初始AUC值为0.620。利用本发明方法，通过约10次迭代调整危重向量的方向后，AUC值趋于稳定。为了防止过拟合，对结果进行了K折交叉验证。结果如图3和图4所示。优化后的危重向量为，预测30天全因病死率的AUC值为0.653，相比之前提升约5％。
