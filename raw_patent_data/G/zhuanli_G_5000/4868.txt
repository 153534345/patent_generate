标题title
物联网节点功耗监测电路
摘要abst
本发明物联网节点功耗监测电路，灵敏度调节电路采用检测的节点数据速率，在节点处于休眠/运行工作模式时，‑5V或‑5V与根据节点数据速率转换后电压耦合加到压控电阻RP2、RP4的控制端，调高、调低第一、第二放大器和的灵敏度，进入失调电压抵消电路，通过电阻R3和电容C3检测第一放大器同相输入端的失调电压，非零时，经积分器积分加到运算放大器AR2、运算放大器AR3组成的平衡对称差动输入电路，起到失调电压校正、抑制共模信号的作用，再进入乘法电路接，分别经低通/高通滤波后加到乘法器IC1，进行模拟相乘得出实时节点功耗信号，最后经均值滤波器均值滤波进一步抑制周期性干扰后得出节点功耗信号，能提高物联网节点功耗监测的精度。
权利要求书clms
1.物联网节点功耗监测电路，包括灵敏度调节电路、失调电压抵消电路、乘法电路，其特征在于，所述灵敏度调节电路采用检测的节点数据速率，在节点处于休眠工作模式时，-5V经开关JP1直接输出，在节点处于运行工作模式时，-5V与根据节点数据速率转换后电压耦合经开关JP1输出，开关JP1输出电压加到压控电阻RP2的控制端，调节阻值的大小，调高采用压控电阻RP2、运算放大器AR1、电阻R3、电容C2组成的第一放大器的灵敏度，调节对节点的测量电流放大的大小，规避电流转换损失，开关JP1输出电压加到压控电阻RP4的控制端，调节阻值的大小，相应的调低采用压控电阻RP4、运算放大器AR2、电阻R2组成的第二放大器的灵敏度，调节对节点的测量电压放大的大小，提高测量电压、测量电流乘积计算出的功耗的转换效率；所述失调电压抵消电路接收经采样、滤波、第二放大器放大的测量电压，接收经第一放大器放大、运算放大器AR3跟随后的测量电流，通过电阻R3和电容C3检测第一放大器同相输入端的失调电压，非零时，经积分器积分加到运算放大器AR2、运算放大器AR3组成的平衡对称差动输入电路，起到失调电压校正、抑制共模信号的作用；所述乘法电路接收第二放大器放大的测量电压，经低通滤波加到乘法器IC1的引脚6，接收运算放大器AR3跟随后的测量电流，经高通滤波加到乘法器IC1的引脚1，乘法器IC1进行模拟相乘得出实时节点功耗信号，最后经均值滤波后得出节点功耗信号。2.根据权利要求1所述的物联网节点功耗监测电路，其特征在于，所述灵敏度调节电路包括开关JP1，开关JP1的常闭触点的一端连接电源-5V，开关JP1的常闭触点的另一端分别连接场效应管M1的源极、二极管D1的负极、电阻R13的一端，二极管D1的正极、电阻R13的另一端连接地，场效应管M1的漏极连接电感L2的一端，电感L2的另一端和电容C7的一端连接电源-5V，电容C7的另一端连接地，场效应管M1的栅极连接电感L3的一端，电感L3的另一端分别连接电感L4的一端、电解电容E1的负极，电解电容E1的正极连接地，电感L4的另一端连接数据速率，开关JP1的公共端分别连接压控电阻RP2的控制端、压控电阻RP4的控制端。3.根据权利要求1或2所述的物联网节点功耗监测电路，其特征在于，所述压控电阻为场效应管或压控电阻电路。4.根据权利要求1所述的物联网节点功耗监测电路，其特征在于，所述失调电压抵消电路包括电阻R1、压控电阻RP2，电阻R1的一端连接测量电压，电阻R1的另一端连接电感L1的一端，电感L1的另一端分别连接接地电容C1的一端、电阻R2的一端，电阻R2的另一端分别连接运算放大器AR2的同相输入端、压控电阻RP4的一端，压控电阻RP4、RP2的控制端连接开关JP1的公共端，运算放大器AR2的输出端、压控电阻RP4的另一端连接电阻R7的一端，压控电阻RP2的一端连接测量电流，压控电阻RP2的另一端分别连接运算放大器AR1的反相输入端、电阻R3的一端、电容C2的一端，运算放大器AR1的同相输入端连接地、电阻R5的一端，运算放大器AR1的输出端分别连接电阻R3的另一端、电容C2的一端、电阻R4的一端，电阻R4的另一端、运算放大器AR3的输出端和反相输入端连接电容C4的一端，运算放大器AR3的同相输入端连接电位器RP1的下端，电位器RP1的上端连接运算放大器AR2的反相输入端，电位器RP1的可调端连接电阻R6的一端，电阻R6的另一端分别连接电解电容E2的正极、运算放大器AR4的输出端，运算放大器AR4的同相输入端连接地，运算放大器AR4的反相输入端分别连接电解电容E2的负极、电容C3的一端，电容C3的另一端连接电阻R5的另一端。5.根据权利要求1所述的物联网节点功耗监测电路，其特征在于，所述乘法电路包括电阻R7、电容C4，电阻R7的一端连接运算放大器AR2的输出端，电阻R7的另一端分别连接电容C6的一端、电阻R8的一端，电阻R8的另一端连接乘法器IC1的引脚6，电容C4的一端连接运算放大器AR3的输出端，电容C4的另一端分别连接电容C5的一端、电阻R9的一端，电容C5的另一端连接乘法器IC1的引脚1，电容C6的另一端、电阻R9的另一端连接地，乘法器IC1的引脚7、引脚8、引脚9、引脚10连接地，乘法器IC1的引脚2连接电源+15V，乘法器IC1的引脚5连接电源-15V，乘法器IC1的引脚4分别连接电阻R10的一端、电位器RP3的上端，电位器RP3的下端连接地，电位器RP3的可调端连接乘法器IC1的引脚3，电阻R10的另一端分别连接运算放大器AR5的反相输入端、电阻R12的一端、电解电容E3的正极，运算放大器AR5的同相输入端通过电阻R11连接地，运算放大器AR5的输出端和电阻R12的另一端、电解电容E3的负极输出节点功耗信号。
说明书desc
技术领域本发明属于功耗监测技术领域，尤其涉及物联网节点功耗监测电路。背景技术物联网技术是基于感知网络互联的一项重要技术，物联网技术通过将大量形态各异的传感器节点、控制节点等自组织连网，并接入到传统的互联网中， 构成物物相连的网络，以实现对环境的感知和控制。现有技术对节点功耗的监测，采用对物联网节点供电的电池剩余电量实时采样与监控，或是采用在供电线路上外界功耗分析仪来监控，前者在监测跟踪电池的电量变化时，在采集电压、电流检测电阻在检测电流进行转换时，存在转换误差，还需配合电池的温度、老化等因素进行修正才能得到较精确的电池电量，后者需专门的仪器，代价高昂。因此，需提供物联网节点功耗监测电路，解决现有技术物联网节点功耗监测的精度不够以及代价高昂的问题。发明内容针对上述情况，为克服现有技术之缺陷，本发明提供物联网节点功耗监测电路，结构简单、成本低，直接测量物联网节点供电线路的电压、电流，调节电压、电流信号转换的灵敏度、失调电压，再乘积运算计算出功耗，能提高物联网节点功耗监测的精度。其技术方案是，包括灵敏度调节电路、失调电压抵消电路、乘法电路，所述灵敏度调节电路采用检测的节点数据速率，在节点处于休眠工作模式时，-5V经开关JP1直接输出，在节点处于运行工作模式时，-5V与根据节点数据速率转换后电压耦合经开关JP1输出，开关JP1输出电压加到压控电阻RP2的控制端，调节阻值的大小，调高采用压控电阻RP2、运算放大器AR1、电阻R3、电容C2组成的第一放大器的灵敏度，调节对节点的测量电流放大的大小，规避电流转换损失，开关JP1输出电压加到压控电阻RP4的控制端，调节阻值的大小，相应的调低采用压控电阻RP4、运算放大器AR2、电阻R2组成的第二放大器的灵敏度，调节对节点的测量电压放大的大小，提高测量电压、测量电流乘积计算出的功耗的转换效率；所述失调电压抵消电路接收经采样、滤波、第二放大器放大的测量电压，接收经第一放大器放大、运算放大器AR3跟随后的测量电流，通过电阻R3和电容C3检测第一放大器同相输入端的失调电压，非零时，经积分器积分加到运算放大器AR2、运算放大器AR3组成的平衡对称差动输入电路，起到失调电压校正、抑制共模信号的作用；所述乘法电路接收第二放大器放大的测量电压，经低通滤波加到乘法器IC1的引脚6，接收运算放大器AR3跟随后的测量电流，经高通滤波加到乘法器IC1的引脚1，乘法器IC1进行模拟相乘得出实时节点功耗信号，最后经均值滤波后得出节点功耗信号。优选的，所述灵敏度调节电路包括开关JP1，开关JP1的常闭触点的一端连接电源-5V，开关JP1的常闭触点的另一端分别连接场效应管M1的源极、二极管D1的负极、电阻R13的一端，二极管D1的正极、电阻R13的另一端连接地，场效应管M1的漏极连接电感L2的一端，电感L2的另一端和电容C7的一端连接电源-5V，电容C7的另一端连接地，场效应管M1的栅极连接电感L3的一端，电感L3的另一端分别连接电感L4的一端、电解电容E1的负极，电解电容E1的正极连接地，电感L4的另一端连接数据速率，开关JP1的公共端分别连接压控电阻RP2的控制端、压控电阻RP4的控制端。本发明的有益效果：1，结构简单、成本低，采用检测的节点数据速率，判断网络节点的工作模式，在节点处于休眠/运行工作模式时，-5V或-5V与根据节点数据速率转换后电压耦合经开关JP1直接输出，加到压控电阻RP2、压控电阻RP4的控制端，调节阻值的大小，调高、调低第一、第二放大器和的灵敏度，调节直接测量物联网节点供电线路的电压、电流放大的大小，提高测量电压、测量电流乘积计算出的功耗的转换效率；2，通过电阻R5和电容C3检测第一放大器同相输入端的失调电压，非零时，经积分器积分加到运算放大器AR2、运算放大器AR3组成的平衡对称差动输入电路，起到失调电压校正、抑制共模信号的作用，降低元器件、外界干扰造成的误差，进一步提高测量信号的精度、转换效率，分别经低通滤波/高通滤波后加到乘法器IC1的引脚6、引脚1，乘法器IC1进行模拟相乘得出实时节点功耗信号，最后经均值滤波器均值滤波进一步抑制周期性干扰后得出节点功耗信号，直接测量物联网节点供电线路的电压、电流，调节电压、电流信号转换的灵敏度、失调电压，再乘积运算计算出功耗，最后均值滤波进一步抑制周期性干扰后，能提高物联网节点功耗监测的精度。附图说明图1是本发明电路原理图。具体实施方式以下将结合附图对本发明各实施例的技术方案进行清楚、完整的描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。以下结合说明书附图1，对本发明的具体实施方式做进一步详细说明。物联网节点功耗监测电路，包括灵敏度调节电路、失调电压抵消电路、乘法电路，所述灵敏度调节电路采用检测的节点数据速率，由于不同的节点数据速率，功耗差别大，在此采用检测传输通信的发送/接收数据速率，以判断网络节点的工作模式，在节点处于休眠工作模式时，-5V经开关JP1直接输出，在节点处于运行工作模式时，-5V与根据节点数据速率转换后电压耦合经开关JP1输出，具体的，节点数据速率经电感L4平滑滤波、电解电容E1反向加到场效应管M1的栅极，场效应管M1的漏源间阻值随节点数据速率的高低变化，输出与电阻R13分压后电压加到开关JP1常闭触点，开关JP1输出电压加到压控电阻RP2的控制端，调节阻值的大小，调高采用压控电阻RP2、运算放大器AR1、电阻R3、电容C2组成的第一放大器的灵敏度，调节对节点的测量电流放大的大小，规避电流转换损失，开关JP1输出电压加到压控电阻RP4的控制端，调节阻值的大小，等比例、相应的调低采用压控电阻RP4、运算放大器AR2、电阻R2组成的第二放大器的灵敏度，调节对节点的测量电压放大的大小，提高测量电压、测量电流乘积计算出的功耗的转换效率，其中，压控电阻RP2、RP4可以为场效应管或专利号为CN111625042A的压控电阻电路，将输入电压的变化转换为电阻的变化；所述失调电压抵消电路接收经采样，电感L1和电容C1滤波，第二放大器放大的测量电压，接收经第一放大器放大、运算放大器AR3跟随后的测量电流，通过电阻R5和电容C3检测第一放大器同相输入端的失调电压，非零时，经运算放大器AR4、电解电容E2组成的积分器积分加到运算放大器AR2、运算放大器AR3组成的平衡对称差动输入电路，起到失调电压校正、抑制共模信号的作用，降低元器件、外界干扰造成的误差，进一步提高测量信号的精度、转换效率；所述乘法电路接收第二放大器放大的测量电压，低通滤波后加到乘法器IC1的引脚6，接收运算放大器AR3跟随后的测量电流，高通滤波加到乘法器IC1的引脚1，乘法器IC1进行模拟相乘得出实时节点功耗信号，最后经均值滤波器均值滤波进一步抑制周期性干扰后得出节点功耗信号，直接测量物联网节点供电线路的电压、电流，调节电压、电流信号转换的灵敏度、失调电压，再乘积运算计算出功耗，最后均值滤波进一步抑制周期性干扰后，能提高物联网节点功耗监测的精度。在上述方案的基础上，所述灵敏度调节采用检测的节点数据速率，在节点处于休眠工作模式时，-5V经开关JP1直接输出，在节点处于运行工作模式时，-5V与根据节点数据速率转换后电压耦合经开关JP1输出，具体的，节点数据速率经电感L4平滑滤波、电解电容E1反向加到场效应管M1的栅极，场效应管M1的漏源间阻值随节点数据速率的高低变化，输出与电阻R13分压后电压加到开关JP1常闭触点，开关JP1输出电压加到压控电阻RP2的控制端，调节阻值的大小，调高采用压控电阻RP2、运算放大器AR1、电阻R3、电容C2组成的第一放大器的灵敏度，调节对节点的测量电流放大的大小，规避电流转换损失，开关JP1输出电压加到压控电阻RP4的控制端，调节阻值的大小，等比例、相应的调低采用压控电阻RP4、运算放大器AR2、电阻R2组成的第二放大器的灵敏度，调节对节点的测量电压放大的大小，提高测量电压、测量电流乘积计算出的功耗的转换效率，压控电阻RP2、RP4可以为场效应管或专利号为CN111625042A的压控电阻电路，包括开关JP1，开关JP1的常闭触点的一端连接电源-5V，开关JP1的常闭触点的另一端分别连接场效应管M1的源极、二极管D1的负极、电阻R13的一端，二极管D1的正极、电阻R13的另一端连接地，场效应管M1的漏极连接电感L2的一端，电感L2的另一端和电容C7的一端连接电源-5V，电容C7的另一端连接地，场效应管M1的栅极连接电感L3的一端，电感L3的另一端分别连接电感L4的一端、电解电容E1的负极，电解电容E1的正极连接地，电感L4的另一端连接数据速率，开关JP1的公共端分别连接压控电阻RP2的控制端、压控电阻RP4的控制端。在上述方案的基础上，所述失调电压抵消电路接收经采样，电感L1和电容C1滤波，第二放大器放大的测量电压，接收经第一放大器放大、运算放大器AR3跟随后的测量电流，通过电阻R5和电容C3检测第一放大器同相输入端的失调电压，非零时，经运算放大器AR4、电解电容E2组成的积分器积分加到运算放大器AR2、运算放大器AR3组成的平衡对称差动输入电路，起到失调电压校正、抑制共模信号的作用，降低元器件、外界干扰造成的误差，进一步提高测量信号的精度、转换效率，包括电阻R1、压控电阻RP2，电阻R1的一端连接测量电压，电阻R1的另一端连接电感L1的一端，电感L1的另一端分别连接接地电容C1的一端、电阻R2的一端，电阻R2的另一端分别连接运算放大器AR2的同相输入端、压控电阻RP4的一端，压控电阻RP4、RP2的控制端连接开关JP1的公共端，运算放大器AR2的输出端、压控电阻RP4的另一端连接电阻R7的一端，压控电阻RP2的一端连接测量电流，压控电阻RP2的另一端分别连接运算放大器AR1的反相输入端、电阻R3的一端、电容C2的一端，运算放大器AR1的同相输入端连接地、电阻R5的一端，运算放大器AR1的输出端分别连接电阻R3的另一端、电容C2的一端、电阻R4的一端，电阻R4的另一端、运算放大器AR3的输出端和反相输入端连接电容C4的一端，运算放大器AR3的同相输入端连接电位器RP1的下端，电位器RP1的上端连接运算放大器AR2的反相输入端，电位器RP1的可调端连接电阻R6的一端，电阻R6的另一端分别连接电解电容E2的正极、运算放大器AR4的输出端，运算放大器AR4的同相输入端连接地，运算放大器AR4的反相输入端分别连接电解电容E2的负极、电容C3的一端，电容C3的另一端连接电阻R5的另一端。在上述方案的基础上，所述乘法电路接收第二放大器放大的测量电压，由于供电电压基本不变或变化幅度在一定范围内，设置电阻R7、电阻R8、电容C1组成的经低通滤波电路，低通滤波后加到乘法器IC1的引脚6，接收运算放大器AR3跟随后的测量电流，由于电流随物联网节点工作模式也即节点数据速率变化，经电容C4、电容C5、电阻R9组成的高通滤波电路高通滤波加到乘法器IC1的引脚1，乘法器IC1进行模拟相乘得出实时节点功耗信号，最后经运算放大器AR5、电阻R10-电阻R12、电解电容E3组成的均值滤波器均值滤波进一步抑制周期性干扰后得出节点功耗信号，直接测量物联网节点供电线路的电压、电流，调节电压、电流信号转换的灵敏度、失调电压，再乘积运算计算出功耗，最后均值滤波进一步抑制周期性干扰后，能提高物联网节点功耗监测的精度，包括电阻R7、电容C4，电阻R7的一端连接运算放大器AR2的输出端，电阻R7的另一端分别连接电容C6的一端、电阻R8的一端，电阻R8的另一端连接乘法器IC1的引脚6，电容C4的一端连接运算放大器AR3的输出端，电容C4的另一端分别连接电容C5的一端、电阻R9的一端，电容C5的另一端连接乘法器IC1的引脚1，电容C6的另一端、电阻R9的另一端连接地，乘法器IC1的引脚7、引脚8、引脚9、引脚10连接地，乘法器IC1的引脚2连接电源+15V，乘法器IC1的引脚5连接电源-15V，乘法器IC1的引脚4分别连接电阻R10的一端、电位器RP3的上端，电位器RP3的下端连接地，电位器RP3的可调端连接乘法器IC1的引脚3，电阻R10的另一端分别连接运算放大器AR5的反相输入端、电阻R12的一端、电解电容E3的正极，运算放大器AR5的同相输入端通过电阻R11连接地，运算放大器AR5的输出端和电阻R12的另一端、电解电容E3的负极输出节点功耗信号。本发明具体使用时，灵敏度调节电路采用检测的节点数据速率，由于不同的节点数据速率，功耗差别大，在此采用检测传输通信的发送/接收数据速率，以判断网络节点的工作模式，在节点处于休眠工作模式时，-5V经开关JP1直接输出，在节点处于运行工作模式时，-5V与根据节点数据速率转换后电压耦合经开关JP1输出，开关JP1输出电压加到压控电阻RP2的控制端，调节阻值的大小，调高采用压控电阻RP2、运算放大器AR1、电阻R3、电容C2组成的第一放大器的灵敏度，调节对节点的测量电流放大的大小，规避电流转换损失，开关JP1输出电压加到压控电阻RP4的控制端，调节阻值的大小，等比例、相应的调低采用压控电阻RP4、运算放大器AR2、电阻R2组成的第二放大器的灵敏度，调节对节点的测量电压放大的大小，提高测量电压、测量电流乘积计算出的功耗的转换效率，进入失调电压抵消电路，通过电阻R5和电容C3检测第一放大器同相输入端的失调电压，非零时，经运算放大器AR4、电解电容E2组成的积分器积分加到运算放大器AR2、运算放大器AR3组成的平衡对称差动输入电路，起到失调电压校正、抑制共模信号的作用，降低元器件、外界干扰造成的误差，进一步提高测量信号的精度、转换效率，最后进入乘法电路，分别经低通滤波/高通滤波后加到乘法器IC1的引脚6、引脚1，乘法器IC1进行模拟相乘得出实时节点功耗信号，最后经均值滤波器均值滤波进一步抑制周期性干扰后得出节点功耗信号，直接测量物联网节点供电线路的电压、电流，调节电压、电流信号转换的灵敏度、失调电压，再乘积运算计算出功耗，最后均值滤波进一步抑制周期性干扰后，能提高物联网节点功耗监测的精度。
