标题title
一种基于阵列立柱的激光雷达二维定位方法
摘要abst
本发明公开了一种基于阵列立柱的激光雷达二维定位方法，首先确定各立柱的实际特征点并实测实际特征点的二维位置；然后激光雷达二维扫描立柱并处理得到与所述实际特征点相对应的扫描特征点以及激光雷达与扫描特征点之间的扫描距离和扫描方位角；然后根据上一时刻激光雷达的已知位姿和选定的实际特征点计算激光雷达的实际距离和实际方位角，再配合阈值选出扫描距离和扫描方位角，然后与选定的实际特征点确定激光雷达的位姿。该方法以立柱的特征点作为激光雷达的定位基点，定位精度高，所受干扰少，具有较强的鲁棒性。
权利要求书clms
1.一种基于阵列立柱的激光雷达二维定位方法，其特征在于包括如下步骤：步骤S1：确定各立柱的实际特征点并实测实际特征点的二维位置；步骤S2：激光雷达二维扫描立柱并处理得到与所述实际特征点相对应的扫描特征点以及激光雷达与扫描特征点之间的扫描距离和扫描方位角；步骤S3：根据上一时刻激光雷达的已知位姿和选定的实际特征点的实测位置计算激光雷达对所述选定的实际特征点的实际距离和实际方位角，根据所述的实际距离和实际方位角及阈值选出扫描距离和扫描方位角，然后根据选出的扫描距离和扫描方位角以及所述选定的实际特征点确定所述激光雷达在当前时刻的实际位置和实际方位角，并作为下一时刻激光雷达的已知位姿。2.如权利要求1所述的基于阵列立柱的激光雷达二维定位方法，其特征在于，所述步骤S1中，所述立柱为方形立柱，确定的所述实际特征点为方形立柱棱线的直角点，或者所述立柱为圆形立柱，确定的所述实际特征点为圆形立柱横截面的圆心。3.如权利要求1所述的基于阵列立柱的激光雷达二维定位方法，其特征在于，所述步骤S2中，所述激光雷达为单线激光雷达。4.如权利要求1所述的基于阵列立柱的激光雷达二维定位方法，其特征在于，所述步骤S3中，所述激光雷达的初始位置通过实际测量获取。5.如权利要求1所述的基于阵列立柱的激光雷达二维定位方法，其特征在于，所述步骤S3包括如下步骤：步骤S31：根据上一时刻激光雷达的已知位姿和选定的实际特征点的实测位置计算激光雷达对所述选定的实际特征点的实际距离和实际方位角；步骤S32：根据所述的实际距离和实际方位角及阈值从扫描得到的各个扫描距离和扫描方位角中选出符合阈值条件的扫描距离和扫描方位角作为所述选出的扫描距离和扫描方位角：，其中为当前时刻扫描得到的各个扫描距离和扫描方位角，为上一时刻的实际距离和实际方位角，为阈值，当前时刻选出的扫描距离和扫描方位角；步骤S33：根据当前时刻选出的扫描距离和扫描方位角以及所述选定的实际特征点确定所述激光雷达在当前时刻的实际位置和实际方位角，并作为下一时刻激光雷达的已知位姿。6.如权利要求5所述的基于阵列立柱的激光雷达二维定位方法，其特征在于，所述步骤S33中，根据当前时刻选出的扫描距离和扫描方位角以及所述选定的实际特征点确定所述激光雷达在当前时刻的实际位置和实际方位角时包括如下步骤：步骤S331：确定激光雷达在当前时刻的实际位置：确定至少两组当前时刻选出的扫描距离和扫描方位角，并以与选出的扫描距离和扫描方位角对应的扫描特征点为圆心、以相应的选出的扫描距离为半径做圆，得到的圆的交点中距离上一时刻激光雷达的已知位姿最近的点即为当前时刻激光雷达的实际位置；步骤S332：按下式确定激光雷达在当前时刻的实际方位角：其中表示在世界坐标系中实际特征点相对于激光雷达的方位角，表示激光雷达到实际特征点的向量，表示世界坐标系x轴的方向向量；表示扫描特征点在激光雷达坐标系中的方位角，表示激光雷达在世界坐标系中当前时刻的实际方位角。7.如权利要求5或6所述的基于阵列立柱的激光雷达二维定位方法，其特征在于，当激光雷达发生倾斜时，所述步骤S33还包括如下步骤：步骤S330：根据所述实际特征点的坐标按下式计算得到修正后的坐标：，其中，和为所述实际特征点的坐标，和为修正后的坐标，为激光雷达倾斜时绕Y轴旋转的俯仰角，为激光雷达倾斜时绕X轴旋转的翻滚角，为激光雷达绕Y轴旋转的旋转矩阵，为激光雷达绕X轴旋转的旋转矩阵，且：；以修正后的坐标对应的向量的长度和角度代替所述选出的扫描距离和扫描方位角。
说明书desc
技术领域本发明涉及激光雷达定位领域，具体涉及一种基于阵列立柱的激光雷达二维定位方法。背景技术飞行器、AGV小车等在执行任务的运动中需要进行实时定位，当它们穿行在多个立柱形成阵列的环境中，定位变得尤其复杂。例如，当采用二维激光雷达利用基于匹配的定位方法进行定位时，立柱形成的高重复度的环境很容易造成定位跳动或者不准确，同时在立柱环境中，激光雷达扫描到的特征数据较少，不利于匹配，这导致定位不确定因素多，鲁棒性不足。发明内容本发明的目的是提供一种基于阵列立柱的激光雷达二维定位方法，该方法以立柱的特征点作为激光雷达的定位基点，定位精度高，所受干扰少，具有较强的鲁棒性。为实现上述目的，本发明采取以下技术方案：一种基于阵列立柱的激光雷达二维定位方法，包括如下步骤：步骤S1：确定各立柱的实际特征点并实测实际特征点的二维位置；步骤S2：激光雷达二维扫描立柱并处理得到与所述实际特征点相对应的扫描特征点以及激光雷达与扫描特征点之间的扫描距离和扫描方位角；步骤S3：根据上一时刻激光雷达的已知位姿和选定的实际特征点的实测位置计算激光雷达对所述选定的实际特征点的实际距离和实际方位角，根据所述的实际距离和实际方位角及阈值选出扫描距离和扫描方位角，然后根据选出的扫描距离和扫描方位角以及所述选定的实际特征点确定所述激光雷达在当前时刻的实际位置和实际方位角，并作为下一时刻激光雷达的已知位姿。优选的，所述步骤S1中，所述立柱为方形立柱，确定的所述实际特征点为方形立柱棱线的直角点，或者所述立柱为圆形立柱，确定的所述实际特征点为圆形立柱横截面的圆心。优选的，所述步骤S2中，所述激光雷达为单线激光雷达。优选的，所述步骤S3中，所述激光雷达的初始位置通过实际测量获取。优选的，所述步骤S3包括如下步骤：步骤S31：根据上一时刻激光雷达的已知位姿和选定的实际特征点的实测位置计算激光雷达对所述选定的实际特征点的实际距离和实际方位角；步骤S32：根据所述的实际距离和实际方位角及阈值从扫描得到的各个扫描距离和扫描方位角中选出符合阈值条件的扫描距离和扫描方位角作为所述选出的扫描距离和扫描方位角：，其中为当前时刻扫描得到的各个扫描距离和扫描方位角，为上一时刻的实际距离和实际方位角，为阈值，当前时刻选出的扫描距离和扫描方位角；步骤S33：根据当前时刻选出的扫描距离和扫描方位角以及所述选定的实际特征点确定所述激光雷达在当前时刻的实际位置和实际方位角，并作为下一时刻激光雷达的已知位姿。优选的，所述步骤S33中，根据当前时刻选出的扫描距离和扫描方位角以及所述选定的实际特征点确定所述激光雷达在当前时刻的实际位置和实际方位角时包括如下步骤：步骤S331：确定激光雷达在当前时刻的实际位置：确定至少两组当前时刻选出的扫描距离和扫描方位角，并以与选出的扫描距离和扫描方位角对应的扫描特征点为圆心、以相应的选出的扫描距离为半径做圆，得到的圆的交点中距离上一时刻激光雷达的已知位姿最近的点即为当前时刻激光雷达的实际位置；步骤S332：按下式确定激光雷达在当前时刻的实际方位角：其中表示在世界坐标系中实际特征点相对于激光雷达的方位角，表示激光雷达到实际特征点的向量，表示世界坐标系x轴的方向向量；表示扫描特征点在激光雷达坐标系中的方位角， 表示激光雷达在世界坐标系中当前时刻的实际方位角。进一步的，当激光雷达发生倾斜时，所述步骤S33还包括如下步骤：步骤S330：根据所述实际特征点的坐标按下式计算得到修正后的坐标：，其中，和为所述实际特征点的坐标，和为修正后的坐标，为激光雷达倾斜时绕Y轴旋转的俯仰角，为激光雷达倾斜时绕X轴旋转的翻滚角，为激光雷达绕Y轴旋转的旋转矩阵，为激光雷达绕X轴旋转的旋转矩阵，且：；以修正后的坐标对应的向量的长度和角度代替所述选出的扫描距离和扫描方位角。上述技术方案中，将环境中的立柱作为定位参考物，选取的立柱实际特征点是能够被激光雷达扫描获取的点从而也是可以从激光雷达扫描数据提取出的点，如方形立柱的直角点、圆形立柱中的横截面圆形中心点等，这些实际特征点可通过测量确定在世界坐标系中的实际坐标，这样由实际坐标和激光雷达上一时刻已知的位姿可以计算出该上一时刻激光雷达和该实际坐标之间的实际距离，因为激光雷达在运动，由所述上一时刻运动了一个很短的时间到达当前时刻时，激光雷达即运动了一段距离，此时激光雷达扫描实际特征点并从激光雷达数据提取出了与实际特征点相对应的扫描特征点，这样用于计算所述实际距离的实际特征点与当前时刻的激光雷达之间的距离与上一时刻的实际距离会有一个差值，但是会在微小的阈值范围内，所以通过上一时刻的实际距离及阈值即可选出当前时刻激光雷达与计算用的实际特征点之间的扫描距离，然后由此扫描距离及相应实际特征点的坐标即可计算出激光雷达在当前时刻的位姿坐标，从而实现定位。利用该当前时刻的位姿坐标又可以与新选定的实际特征点计算出新的实际距离，并作为下一时刻选出扫描距离及计算下一时刻激光雷达位姿坐标的基础，从而连续实现激光雷达的实时定位。本方法通过激光雷达仅依据立柱即可以实现定位，将以往定位方法中干扰定位的立柱反变成定位依赖的参考物，提升了定位精准度和方法的可靠性。附图说明图1为本发明基于阵列立柱的激光雷达二维定位方法的定位逻辑流程图；图2为激光雷达旋转扫描一周后得到的扫描点及提取点的界面反馈图。具体实施方式一、飞行器上的激光雷达在阵列立柱环境中的定位激光雷达安装在飞行器上，所处环境存在多个方形立柱，如列车检测的地沟中的多排方形立柱，每个立柱之间相互间隔开一定的距离，该距离使激光雷达能够同时扫描至少两个立柱，比如0.5-12米，激光雷达为单线激光雷达，常见的扫描范围如0.5-12米，激光雷达可旋转对阵列立柱进行一周二维扫描，并相隔很短的时间进行循环扫描。本发明的定位逻辑如图1所示，该逻辑具体实现可采取如下步骤：步骤S1：以方形立柱的棱线上的直角点作为实际特征点，建立垂直于立柱的二维xy坐标系作为世界坐标系，如可将x轴方向设为与一排立柱延伸的方向相平行，y轴与x轴垂直，通过实际测量确定实际特征点在世界坐标系的二维坐标。步骤S2：激光雷达二维扫描各个立柱，将激光雷达扫描到的环境信息点进行聚类，聚类标准为如果相邻两个激光雷达扫描角度的环境信息点的距离大于一个阈值，则认为是一个新的聚类。而每个聚类的点集里都包含直角点，激光雷达的环境信息点数据是根据扫描角度的不断增长得到的，因此在每个聚类中，可知起始点和结束点，遍历除起始点和结束点以外的所有点，计算与起始点和结束点的连线的夹角，如果该角度满足阈值要求，则可确定为直角点。在一个优选的实施例中，由于激光雷达精度的原因，扫描到的点存在误差，为了提高鲁棒性和减小误差，利用前述方式计算的直角点将每个类分为两组点集，每组点集再进行直线拟合，得到两组直线的交点则为直角点，即扫描特征点。在得到扫描特征点后，可以得到激光雷达中心与扫描特征点的距离，即扫描距离，还可以得到扫描特征点相对于激光雷达的方位角，即当前时刻的扫描方位角。步骤S3：根据上一时刻激光雷达的已知位姿和选定的实际特征点的实测位置计算出激光雷达对所述选定的实际特征点的实际距离和实际方位角。然后根据此实际距离和实际方位角以及设定的可上下浮动的范围即阈值找到在阈值范围内的当前时刻的扫描距离和扫描方位角，该当前时刻的扫描距离和扫描方位角对应的扫描特征点即对应上述计算实际距离的立柱上的实际特征点，这样在多个扫描特征点中就可以锚定一个能知道与激光雷达之间的扫描距离和扫描方位角的实际特征点的坐标，进而根据坐标和相应的扫描距离和扫描方位角计算出当前时刻激光雷达在世界坐标系中的位置和方位角，即位姿坐标。具体来讲，初始时，预先在世界坐标系中测量确定实际特征点的坐标，给定激光雷达初始点位姿坐标，根据初始点与实际特征点坐标的相对位置关系，理论计算得到激光雷达在该初始点与实际特征点之间的实际距离和实际角度，并设置阈值，激光雷达会在运动中实时扫描环境得到环境信息点并提取出多个扫描特征点，同时得到当前时刻的激光雷达与扫描特征点的距离和相应的方位角，即扫描距离和扫描方位角，通过判断上一时刻的实际距离和实际方位角与当前时刻激光雷达测量得到的扫描距离和扫描方位角是否满足阈值，即可选出符合阈值条件的扫描距离和扫描方位角：， 然后根据选出的扫描距离和扫描方位角数据与对应的实际特征点的坐标，可计算出当前时刻激光雷达在世界坐标系中的二维位姿，从而实现激光雷达的定位。然后，基于该新得到的激光雷达的二维位姿，再次选取实际特征点并计算实际距离和实际方位角，并根据新算出的实际距离和实际方位角在下一时刻当激光雷达得到新的扫描距离和扫描方位角时筛选出符合阈值条件的扫描距离和扫描方位角，然后可实现下一时刻激光雷达的定位，如此进行下去，实现激光雷达连续的实时定位。在一个实施例中，根据前述选出的扫描距离和扫描方位角数据与对应的实际特征点的坐标，按如下方法计算当前时刻激光雷达在世界坐标系中的位置：首先计算激光雷达的位置：一般而言，至少要通过两个上一时刻的实际距离和实际方位角选出相应的至少两组当前时刻的扫描距离和扫描方位角，也就是说在世界坐标系中至少要有两个已知坐标的扫描特征点与激光雷达的扫描距离和扫描方位角对应，以该两个扫描特征点为圆心，对应的激光雷达的扫描距离为半径做圆，两个圆一般可以得到两个相交的点，而激光雷达的位置即与其中一个重合，之后通过筛选与上一个位姿坐标点的距离最近的一个点作为激光雷达的当前坐标点。然后计算激光雷达的方位角：在得到了当前时刻激光雷达的位置坐标后，由扫描特征点在激光雷达坐标系的极坐标参数可以计算激光雷达在世界坐标系中的方位角度：其中表示在世界坐标系中实际特征点相对于激光雷达的方位角，表示激光雷达到实际特征点的向量，表示世界坐标系x轴的方向向量；表示激光雷达在世界坐标系中的方位角，即。在一个实施例中，飞行器在运动过程中产生倾斜，这样激光雷达扫描线就偏离原来的平面，导致扫描距离和扫描方位角与倾斜前本应得到扫描距离和扫描方位角产生偏差。此时，倾斜角一般很小，因此由上一时刻的实际距离和实际角度及阈值仍可以选出扫描距离和扫描角度，并进而确定相应的实际特征点的坐标。然后，需要由倾斜后的扫描距离推算出倾斜前本应得到的扫描距离，按如下方法进行：设选出的实际特征点坐标为，倾斜后对应的倾斜角分别为绕Y轴旋转的俯仰角，绕X轴旋转的翻滚角。绕Y轴旋转的旋转矩阵，绕X轴旋转的旋转矩阵分别为：修正后的特征点坐标，由此得到的修正后的特征点的坐标对应的向径即为修正后的扫描距离。二、AGV小车上的激光雷达在阵列立柱环境中的定位本实施例中，激光雷达设置在AGV小车上，AGV小车运动所处的环境为具有多个圆形立柱的库房空间，此时扫描立柱得到的点相连得到弧线，根据弧形计算计算出平面圆形的中心作为扫描特征点，其他定位内容与上述飞行器的情况基本一致。本实施例只是对本发明构思和实现的说明，并非对其进行限制，在本发明构思下，未经实质变换的技术方案仍然在保护范围内。
