标题title
一种基于小数灰度校正的Mini-LED补偿方法、设备及介质
摘要abst
本发明公开了一种基于小数灰度校正的Mini‑LED补偿方法、设备及介质，属于LED显示技术领域。针对现有技术中存在的常规的整数灰度校正方式，在低灰度等级下，存在调节步长过大，无法精确校正灯珠间亮度差异的问题，本发明提供了一种基于小数灰度校正的Mini‑LED补偿方法、设备及介质，定义灰度等级的位数，包括整数部分的位数M和小数部分的位数N，选择合适的位数调整；获取测试面板上各个像素点的亮度，选择以屏幕上灯珠的最大亮度为校正目标，获取校正灰度值的整数部分，得到整数灰度校正值；获得小数灰度校正值；根据整数和小数校正值进行补偿。它可以实现提高低灰度显示下的校正精度，进而提高屏幕显示效果。
权利要求书clms
1.一种基于小数灰度校正的Mini-LED补偿方法，步骤如下，定义灰度等级的位数，包括整数部分的位数M和小数部分的位数N，选择合适的位数调整；获取测试面板上各个像素点的亮度，选择以屏幕上灯珠的最大亮度为校正目标，定义该最大亮度值为a，定义某个待校正的灯珠亮度值为b；获取校正灰度值的整数部分，得到整数灰度校正值；获取采用遍历法或二分法获得小数灰度校正值；根据整数和小数校正值进行补偿。2.根据权利要求1所述的一种基于小数灰度校正的Mini-LED补偿方法，其特征在于，整数部分的位数M与输入的显示数据位宽不同时，根据设定的γ曲线进行灰度映射，将输入的显示数据位宽扩展或缩减。3.根据权利要求1所述的一种基于小数灰度校正的Mini-LED补偿方法，其特征在于，获取校正灰度值的整数部分具体步骤为，整数灰度校正值Y采用如下公式获得，X为显示灰度。4.根据权利要求1或2或3所述的一种基于小数灰度校正的Mini-LED补偿方法，其特征在于，在方案中小数部分灰度等级位宽小于4时，遍历所有的小数取值，与已获得的整数部分灰度等级相加，依次进行亮度测试，选择其中最为接近目标值a的作为最终输出。5.根据权利要求1或2或3所述的一种基于小数灰度校正的Mini-LED补偿方法，其特征在于，小数部分灰度等级位宽大于等于4时，采用二分法、分块查找算法或斐波那契查找算法获取小数部分灰度等级。6.根根据权利要求5所述的一种基于小数灰度校正的Mini-LED补偿方法，其特征在于，二分法获取小数部分灰度等级步骤如下，定义小数的下限为α，上限为β，小数部分为y，迭代开始时，α赋值为0，β赋值为1，y为α与β的均值，以灰度值Y+y进行测试，显示亮度值为c，如果c大于目标值a，则下限α不变，上限β被赋值为y，y取新的α和β的均值；如果c小于目标值a，则下限α被赋值为y，上限β不变，y取新的α和β的均值，计算后如果y的分子部分为奇数，则不能再进行二分；y的分子部分为偶数，则继续进行二分，测试迭代过程中的每组灰度-亮度对应数据都保留，检测到y的分子部分为奇数n，结束二分法后，从历史测试数据中找到分子为n-1、n、n+1三个灰度等级对应的亮度测试数据，选取最为接近目标值a的结果，作为最终校正灰度等级的小数部分结果。7.一种电子设备，其特征在于，包括处理器、输入设备、输出设备和存储器，所述处理器、输入设备、输出设备和存储器依次连接，所述存储器用于存储计算机程序，所述计算机程序包括程序指令，所述处理器被配置用于调用所述程序指令，执行如权利要求1-6任一项所述的方法。8.一种可读存储介质，其特征在于，所述存储介质存储有计算机程序，所述计算机程序包括程序指令，所述程序指令当被处理器执行时使所述处理器执行如权利要求6-8任一项所述的方法。
说明书desc
技术领域本发明涉及LED显示技术领域，更具体地说，涉及一种基于小数灰度校正的Mini-LED补偿方法、设备及介质。背景技术随着现代化程度的不断提高，各种电子终端逐渐普及，对于电子屏幕显示技术提出了更高的要求。LED显示技术是现代显示技术的重要分支，为提高显示效果，需要提高显示屏中LED灯珠密度，进而需要更小尺寸的LED。更小的尺寸为LED生产和应用带来了更多挑战。Mini-LED为芯片尺寸介于50~200微米之间的LED器件，由Mini-LED像素阵列、驱动电路组成，像素中心间距为0.3-1.5毫米。由小尺寸LED组成的屏幕更容易出现各种非理想现象，各个灯珠的发光率难以做到完全相同，相邻灯珠亮度不一致会导致屏幕上出现色差，影响屏幕显示效果。为解决此问题，需要对Mini-LED屏幕进行校正，屏幕制造完成后，显示一定的测试图像，使用感光器件获取屏幕上各个像素点的亮度，得到各个灯珠发光率，再通过软件或硬件手段进行校正，从而提高各灯珠间发光率的一致性，进而提高Mini-LED屏幕的显示效果。灰度校正，通过修改灰度等级调节灯珠亮度进行校正。灰度，或者说灰阶或色阶，是指亮度的明暗程度，在LED发光的最亮与最暗之间划分一定的等级，用灰度等级来表示，灰度等级越高，LED越亮。灰度校正原理为对发光率低的LED增加一定的灰度等级，对发光率高的LED减小一定的灰度等级，尽量使各个LED实际亮度一致。在低灰度显示，即暗色显示情况下，灯珠之间的亮度偏差在总亮度中所占比例大，使得人眼在暗色情况下更容易观察到不均，造成低灰度显示效果较差。常规的整数灰度校正方式，在低灰度等级下，存在调节步长过大，无法精确校正灯珠间亮度差异的问题。发明内容1.要解决的技术问题针对现有技术中存在的常规的整数灰度校正方式，在低灰度等级下，存在调节步长过大，无法精确校正灯珠间亮度差异的问题，本发明提供了一种基于小数灰度校正的Mini-LED补偿方法、设备及介质，它可以实现提高低灰度显示下的校正精度，进而提高屏幕显示效果。2.技术方案本发明的目的通过以下技术方案实现。一种基于小数灰度校正的Mini-LED补偿方法，步骤如下，定义灰度等级的位数，包括整数部分的位数M和小数部分的位数N，选择合适的位数调整；获取测试面板上各个像素点的亮度，选择以屏幕上灯珠的最大亮度为校正目标，定义该最大亮度值为a，定义某个待校正的灯珠亮度值为b；获取校正灰度值的整数部分，得到整数灰度校正值；获取采用遍历法或二分法获得小数灰度校正值；根据整数和小数校正值进行补偿。更进一步的，整数部分的位数M与输入的显示数据位宽不同时，根据设定的γ曲线进行灰度映射，将输入的显示数据位宽扩展或缩减。更进一步的，获取校正灰度值的整数部分具体步骤为，整数灰度校正值Y采用如下公式获得，X为显示灰度。更进一步的，在方案中小数部分灰度等级位宽小于4时，遍历所有的小数取值，与已获得的整数部分灰度等级相加，依次进行亮度测试，选择其中最为接近目标值a的作为最终输出。更进一步的，小数部分灰度等级位宽大于等于4时，采用二分法、分块查找算法或斐波那契查找算法获取小数部分灰度等级。更进一步的，二分法获取小数部分灰度等级步骤如下，定义小数的下限为α，上限为β，小数部分为y，迭代开始时，α赋值为0，β赋值为1，y为α与β的均值，以灰度值Y+y进行测试，显示亮度值为c，如果c大于目标值a，则下限α不变，上限β被赋值为y，y取新的α和β的均值；如果c小于目标值a，则下限α被赋值为y，上限β不变，y取新的α和β的均值，计算后如果y的分子部分为奇数，则不能再进行二分；y的分子部分为偶数，则继续进行二分，测试迭代过程中的每组灰度-亮度对应数据都保留，检测到y的分子部分为奇数n，结束二分法后，从历史测试数据中找到分子为n-1、n、n+1三个灰度等级对应的亮度测试数据，选取最为接近目标值a的结果，作为最终校正灰度等级的小数部分结果。一种电子设备，包括处理器、输入设备、输出设备和存储器，所述处理器、输入设备、输出设备和存储器依次连接，所述存储器用于存储计算机程序，所述计算机程序包括程序指令，所述处理器被配置用于调用所述程序指令，执行如上述所述的方法。一种可读存储介质，所述存储介质存储有计算机程序，所述计算机程序包括程序指令，所述程序指令当被处理器执行时使所述处理器执行如上述所述的方法。3.有益效果相比于现有技术，本发明的优点在于：通过改进Mini-LED灰度校正方案，提出基于小数灰度校正技术的Mini-LED补偿方法，提高低灰度显示下的校正精度，减小Mini-LED屏幕在低灰度显示下的色差，提升屏幕显示效果。附图说明图1为本发明的Mini-LED小数灰度校正方案流程示意图；图2为输入信号灰度等级和校正后信号整数灰度等级之间映射关系的γ曲线；图3为使用二分法获取小数部分校正灰度等级流程图；图4为一种低灰度显示情况下传统灰度校正方案和小数灰度校正方案效果对比示意图；图5为LED的PWM亮度控制方式中两种校正方案对脉宽的调整示意图。具体实施方式下面结合说明书附图和具体的实施例，对本发明作详细描述。实施例1现有的基于整数灰度校正的Mini-LED补偿方案，在低灰度显示下，调节步长过大，难以应对低灰度下校正需要，故提出小数灰度等级校正方案。小尺寸的Mini-LED灯珠难以保证发光率一致性，需要引入额外的亮度校正流程，减小相邻灯珠间的亮度差，获得更好的显示效果。如图1所示，进行Mini-LED面板的校正之前，需要定义方案中灰度等级的位数，包括整数部分的位数M和小数部分的位数N。位数越大，可调节等级越多，图像显示效果越细腻，然而会消耗更多的成本，设计者需要自行在显示效果与成本开支间综合考虑，选择合适的位数。整数位宽M与输入的显示数据位宽不同时，可根据特定的γ曲线进行灰度映射，将输入的显示数据位宽扩展或缩减。γ曲线代表不同位宽的灰度等级之间的映射关系，如图2所示，坐标轴横轴代表输入信号的灰度等级，坐标轴纵轴代表经过校正的整数灰度等级，两个灰度等级的位宽不同。图2中包含γ曲线1和γ曲线2，γ曲线2更“凹陷”，输入灰度等级经过γ曲线2的映射，得到的整数灰度等级更低，即在低灰度下有更多细节。根据实际需要修改γ曲线的形状，可以调节高/低灰度的细节占比。使用感光器件获取测试面板上各个像素点的亮度，待测试Mini-LED面板以相同的灰度等级X显示测试图像，因为小尺寸下的工艺原因，各个灯珠的发光率不完全一致，即使各灯珠灰度等级相同，最终显示出的亮度也不同。校正的目的是通过适当修改灰度等级，尽可能使各个灯珠显示出的亮度一致。方案中选择以屏幕上灯珠的最大亮度为校正目标，定义该最大亮度值为a，定义某个待校正的灯珠亮度值为b，接下来将增加待校正灯珠的灰度等级，使其最终发光亮度接近于a。获取校正灰度值的整数部分。校正方案中整数校正类似于粗调，小数校正类似于精调，首先估计整数部分灰度的大概值，计算面板最大亮度值a与特定像素点亮度值b的比值，超过1的部分乘以显示灰度X，计算结果取整后加X，得到整数灰度值的预估值。公式为：取整后就是待校正灯珠应该增加的整数灰度等级的估计值。该估算方法假设了灰度等级与实际亮度间有良好的线性对应关系，而实际操作中可能会存在非线性影响因素，所以取估计值附近一定范围的灰度等级，逐一进行显示测试并记录其亮度，找到亮度值上下逼近目标亮度a的两个相邻整数灰度等级，取其中较小的灰度等级作为校正灰度等级的整数部分。只含整数部分，小数部分为零的灰度等级对应亮度应略小于目标值a，便于后续的小数校正操作。如图1中所示，在方案中小数部分灰度等级位宽小于4时，可以遍历所有的小数取值，与已获得的整数部分灰度等级相加，依次进行亮度测试，选择其中最为接近目标值a的作为最终输出；小数部分灰度等级位宽大于等于4时，可使用其它算法如二分法获取小数部分灰度等级，也可以为其他算法，如分块查找算法、斐波那契查找算法。图3为使用二分法获取小数部分灰度等级的流程图。定义小数的下限为α，上限为β，小数部分为y。迭代开始时，α赋值为0，β赋值为1，y为α与β的均值。以灰度值Y+y进行测试，显示亮度值为c，如果c大于目标值a，则下限α不变，上限β被赋值为y，y取新的α和β的均值；如果c小于目标值a，则下限α被赋值为y，上限β不变，y取新的α和β的均值。计算后如果y的分子部分为奇数，则不能再进行二分；y的分子部分为偶数，则继续进行二分，注意测试迭代过程中的每组灰度-亮度对应数据都应保留。Y的范围为，检测到y的分子部分为奇数n，结束二分法后，从历史测试数据中找到分子为n-1、n、n+1三个灰度等级对应的亮度测试数据，选取最为接近目标值a的，作为最终校正灰度等级的小数部分结果。为直观地显示出小数灰度校正方案相对于传统灰度校正方案的优势，如图4所示，在灰度等级X为6情况下，分别使用两种方案进行校正，估计校正效果并进行对比。简单起见，假设待校正面板为3乘3的像素阵列。图4中左侧的401、403、405阵列中数据为各个像素点LED对应的灰度等级，图4中右侧的402、404、406为各个像素点LED对应的亮度数据。如图401，3乘3阵列全部以灰度等级6进行测试；如图402，为灰度等级6下各LED灯珠的发光亮度，平均发光亮度为6，左上方区域亮度低，右下方区域亮度高，亮度范围为5.7~6.3，相比于高灰度，低灰度下的亮度差异更容易被人眼观察到。在低灰度下采用传统的整数灰度校正方案进行校正，如图403，根据图402中获取的亮度数据，将亮度小于6的LED对应灰度等级加1级，即左上部分区域灰度等级变为7；图404是对图403中校正后灰度等级的亮度估计，由结果知灰度等级为7的部分发光强度增幅过大，校正后仍存在较大的亮度偏差，可见传统的整数灰度校正方案，在低灰度等级下存在调节步长大，校正效果差的问题。图405为使用新提出的小数灰度校正方案进行校正后的灰度等级，选择小数部分位宽N为4，以最大的亮度值6.3为校正目标，亮度低的LED增加一定的小数灰度等级；图406为对图405中小数校正灰度等级的亮度估计，3乘3阵列的亮度范围为6.28~6.33，校正效果相比于传统方案有了很大提高。可见低灰度等级下，小数灰度校正方案对比传统方案效果更好。灰度等级对LED亮度的控制，可在硬件电路中使用PWM方式、电流控制方式或其它亮度控制方式实现。常见的LED亮度控制方式如PWM，在硬件上需要修改面板显示驱动芯片设计，根据小数灰度校正方案中小数部分位宽N，对PWM可调脉宽进行分割，使最小可调脉宽为原来的1/。本实施例中使用PWM方式控制LED灯珠亮度。图5为经原整数校正方案和改进的小数校正方案分别校正后PWM型面板显示驱动芯片中PWM脉宽的变化。测试中使用的灰度等级X为6，对应图501中PWM波形为6个单位脉宽。图502为整数校正后的PWM脉宽，脉宽从6个单位变化为7个单位。图503为小数校正后的PWM脉宽，校正后小数部分为10/16，相当于小数校正后脉宽展宽了10/16个单位。示例性计算机程序产品和计算机可读存储介质除了上述方法和设备以外，本申请的实施例还可以是计算机程序产品，其包括计算机程序指令，所述计算机程序指令在被处理器运行时使得所述处理器执行本说明书上述“示例性方法”部分中描述的根据本申请各种实施例的决策行为决策方法中的步骤。所述计算机程序产品可以以一种或多种程序设计语言的任意组合来编写用于执行本申请实施例操作的程序代码，所述程序设计语言包括面向对象的程序设计语言，诸如Java、C++等，还包括常规的过程式程序设计语言，诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、作为一个独立的软件包执行、部分在用户计算设备上部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。此外，本申请的实施例还可以是计算机可读存储介质，其上存储有计算机程序指令，所述计算机程序指令在被处理器运行时使得所述处理器执行本说明书上述“示例性方法”部分中描述的根据本申请各种实施例的决策行为决策方法中的步骤。所述计算机可读存储介质可以采用一个或多个可读介质的任意组合。可读介质可以是可读信号介质或者可读存储介质。可读存储介质例如可以包括但不限于电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。以上结合具体实施例描述了本申请的基本原理，但是，需要指出的是，在本申请中提及的优点、优势、效果等仅是示例而非限制，不能认为这些优点、优势、效果等是本申请的各个实施例必须具备的。另外，上述公开的具体细节仅是为了示例的作用和便于理解的作用，而非限制，上述细节并不限制本申请为必须采用上述具体的细节来实现。本申请中涉及的器件、装置、设备、系统的方框图仅作为例示性的例子并且不意图要求或暗示必须按照方框图示出的方式进行连接、布置、配置。如本领域技术人员将认识到的，可以按任意方式连接、布置、配置这些器件、装置、设备、系统。诸如“包括”、“包含”、“具有”等等的词语是开放性词汇，指“包括但不限于”，且可与其互换使用。这里所使用的词汇“或”和“和”指词汇“和/或”，且可与其互换使用，除非上下文明确指示不是如此。这里所使用的词汇“诸如”指词组“诸如但不限于”，且可与其互换使用。还需要指出的是，在本申请的装置、设备和方法中，各部件或各步骤是可以分解和/或重新组合的。这些分解和/或重新组合应视为本申请的等效方案。提供所公开的方面的以上描述以使本领域的任何技术人员能够做出或者使用本申请。对这些方面的各种修改对于本领域技术人员而言是非常显而易见的，并且在此定义的一般原理可以应用于其他方面而不脱离本申请的范围。因此，本申请不意图被限制到在此示出的方面，而是按照与在此公开的原理和新颖的特征一致的最宽范围。为了例示和描述的目的已经给出了以上描述。此外，此描述不意图将本申请的实施例限制到在此公开的形式。尽管以上已经讨论了多个示例方面和实施例，但是本领域技术人员将认识到其某些变型、修改、改变、添加和子组合。以上示意性地对本发明创造及其实施方式进行了描述，该描述没有限制性，在不背离本发明的精神或者基本特征的情况下，能够以其他的具体形式实现本发明。附图中所示的也只是本发明创造的实施方式之一，实际的结构并不局限于此，权利要求中的任何附图标记不应限制所涉及的权利要求。所以，如果本领域的普通技术人员受其启示，在不脱离本创造宗旨的情况下，不经创造性的设计出与该技术方案相似的结构方式及实施例，均应属于本专利的保护范围。此外，“包括”一词不排除其他元件或步骤，在元件前的“一个”一词不排除包括“多个”该元件。产品权利要求中陈述的多个元件也可以由一个元件通过软件或者硬件来实现。第一，第二等词语用来表示名称，而并不表示任何特定的顺序。
