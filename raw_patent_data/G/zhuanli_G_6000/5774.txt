标题title
一种基于区块链和数字指纹的隐匿数据确权方法
摘要abst
本发明提供一种基于区块链和数字指纹的隐匿数据确权方法，所述方法应用于区块链和数字指纹的隐匿数据确权系统，所述系统包括用户端和数据确权平台，所述用户端与数据确权平台数据连接，所述数据确权平台包括数据处理组件和区块链组件，本申请实现了原始数据不离开本地的同时完成数据确权的目的；并且在本申请中创新性的加入了TEE技术，将确权流程的关键步骤放入TEE内部执行，通过TEE的高安全能力，从而提高数据确权平台在确权过程中的自证能力。
权利要求书clms
1.一种基于区块链和数字指纹的隐匿数据确权方法，其特征在于，所述方法应用于区块链和数字指纹的隐匿数据确权系统，所述系统包括用户端和数据确权平台，所述用户端与数据确权平台数据连接，所述数据确权平台包括数据处理组件和区块链组件，所述方法包括以下步骤：S1、用户注册/登录数据确权平台：利用区块链组件的分布式身份，用户端在用户注册时为用户创建身份凭证，并将身份凭证签名保存，在用户登录时，通过用户端调用身份凭证，通过验证签名的正确性核实用户身份，若通过则登录成功，若失败则重新登录；S2、在用户成功登录数据确权平台进行原始数据传输时，数据确权平台提供隐匿性确权和托管性确权模式给用户选择；S3、数据确权平台通过用户选择的隐匿性确权和托管性确权模式，进行相对应的确权操作；S4、当数据确权平台确权成功之后向用户端的用户返回确权状态；S5、用户端的用户根据返回确权状态决定是否发起权益审核。2.根据权利要求1所述的一种基于区块链和数字指纹的隐匿数据确权方法，其特征在于，在步骤S2中，若用户选择隐匿性确权，则用户端利用预置的数字指纹生成算法模型，提取本地生成的数据指纹，提取原始数据的n段关键特性值，并将特性值的哈希一同打包准备传输，特性值提取包括以下步骤：S21、根据原始数据大小确定分段，具体公式为：其中bmin是最小分段单元，DS为原始数据总长度，b为分段个数；S22、根据原始数据分段内容利用Alder-32进行弱哈希，具体公式为：r＝F,其中r为第i个窗口的弱哈希值，l为固定长度的滑动窗口，C为分段内容，F为弱哈希函数。S23、根据S21步骤中的结果对C进行分段，当ckmodb＝b-1时，在ck处分段；S24、在对C分段完成后，对每段内容进行强哈希，并将每段内容的哈希结果进行截取,最后将每段截取内容进行拼接得到数据的特性值,具体公式为：H＝h1||h2||...||hn,其中H为特性值，hi表示在第1到第n段中的任一段，第i段强哈希的摘要。3.根据权利要求2所述的一种基于区块链和数字指纹的隐匿数据确权方法，其特征在于，在步骤S2中，若用户选择托管性确权，则利用加密密钥对原始数据进行加密，并与数据确权平台通过密码学中的哈希承诺算法及预付保证金的方式进行安全数据传输。4.根据权利要求3所述的一种基于区块链和数字指纹的隐匿数据确权方法，其特征在于，在步骤3中，数据确权平台对用户选择的隐匿性确权进行的对应操作具体为：若用户选择隐匿性确权，则用户将本地生成的数据指纹传输至数据确权平台的TEE内部，由TEE内部提供可信时间，同时将确权内容哈希值以及时间、身份信息的确权基础信息通过区块链组件进行交易打包并上链存储，并行的通过数据处理组件进行确权基础信息的数据状态校验，再利用n段数据特性值进行数据指纹的生成并查询当前平台内是否存在相似度大于阈值的指纹，若有则判定数据重复，再根据法规政策要求进行数据合规性校验，则将两个校验的状态合并生成数据确权状态进行上链存储，通过基础信息的上链和确权状态的上链相互结合，生成最终的确权凭证，来判定确权是否成功。5.根据权利要求4所述的一种基于区块链和数字指纹的隐匿数据确权方法，其特征在于，在步骤3中，数据确权平台对用户选择的托管性确权进行的对应操作具体为：若用户选择托管性确权，则数据确权平台将解密后的原始数据传输至TEE内部进行哈希，同时生成可信时间，再将确权人身份、时间、哈希的信息进行打包上链存储，利用数据确权平台加密密钥对原始数据加密再传输至TEE外部进行保存，并删除TEE内部原始数据，并且在原始数据传输至TEE外部时，将水印进行注入该原始数据中，并行的通过数据处理组件进行确权基础信息的数据状态校验，再利用n段数据特性值进行数据指纹的生成并查询当前平台内是否存在相似度大于阈值的指纹，若有则判定数据重复，再根据法规政策要求进行数据合规性校验，则将两个校验的状态合并生成数据确权状态进行上链存储，通过基础信息的上链和确权状态的上链相互结合，生成最终的确权凭证，来判定确权是否成功。6.根据权利要求5所述的一种基于区块链和数字指纹的隐匿数据确权方法，其特征在于，在步骤S5中，当用户选择隐匿性数据审核，则用户需调用用户端向数据确权平台提供侵权数据的基于特定数据指纹算法的n段数字特征值，数据确权平台接受到特征值时，利用对应的数据指纹算法生成相应的数据指纹，同时在数据确权平台中获取用户需要进行维权的数据，通过指纹比较确认数据是否重复，再通过提交时间，确认是否侵权。7.根据权利要求6所述的一种基于区块链和数字指纹的隐匿数据确权方法，其特征在于，在步骤S5中，当用户选择托管性数据审核，则用户调用用户端向数据确权平台提供侵权数据原文，数据确权平台首先检查是否存在水印，若有则判断数据归属方，若无则生成原文的数据指纹，利用数据指纹判断是否数据重复，若重复则通过可信时间判断数据权益归属及是否侵权，若不重复，则返回未侵权。8.一种基于区块链和数字指纹的隐匿数据确权系统，其特征在于，所述系统用于执行如权利要求1-7任一所述的方法，所述系统包括用户端和数据确权平台，所述用户端与数据确权平台数据连接，所述数据确权平台包括数据处理组件和区块链组件。
说明书desc
技术领域本发明涉及数据确权技术领域，尤其涉及一种基于区块链和数字指纹的隐匿数据确权方法。背景技术目前的数据确权平台的自证能力不足，无法为用户提供安全、可靠的确权证据，为提升数据确权平台的自证能力，本申请提出一种基于区块链和数字指纹的隐匿数据确权方法，并且创新性的加入了TEE技术，将确权流程的关键步骤放入TEE内部执行，通过TEE的高安全能力，提高数据确权平台在确权过程中的自证能力。与本专利最接近的一项现有专利为编号CN202010236534.X的中国发明专利，专利名称为基于区块链的数据安全确权方法与系统。该发明用于分布式计算环境下用户上传原始文件并进行数据确权与存储，利用区块链实现确权存证追溯的场景。用户上传原始数据全文，平台对数据进行分布式存储并将数据上传者身份及相应确权信息进行上链保存，最终通过区块链查询和本地数据库一一对比实现数据权益查询。但是为编号CN202010236534.X的中国发明专利存在着以下的问题数据隐私安全问题：该专利没有考虑用户数据无法离开本地数据库的场景，同时没有考虑数据在确权动作完成前的数据隐私安全问题。它需要用户上传原始数据文件后才能进行确权，但此专利的设计并没有保证数据在传输到平台至数据完成确权的过程中的数据安全以及数据被盗用的风险，同时，无法实现无法离开本地数据库的高敏感数据的确权需求。查重效率问题：在此专利中并没有考虑权益审查过程中的数据查重效率问题。通过专利中利用确权数据与数据库中已有的数据进行一一比对的方式进行数据查重的效率非常低。同时针对一些易修改的文档内容，通过数据一一比对的方式也很难实现精准查重。数据泄漏追溯问题：此专利没有考虑如何对泄漏者身份进行确认。通过加盖确权者身份的水印仅能够明确数据来源，但在一份数据权益转向多人的场景中无法确认数据非法转卖者的身份。平台安全性自证问题：此专利没有考虑数据确权平台的中心化平台地位带来的潜在侵权行为，无法对确权者进行安全性自证来保证平台不会在数据接收过程、确权过程盗用用户数据。综上所述，现有技术中缺少在数据确权平台上的自证能力，并且还存在着上述列举的问题。发明内容鉴以此，本发明的目的在于提供一种基于区块链和数字指纹的隐匿数据确权方法，以至少解决以上问题。为实现上述发明的目的，本发明第一方面提供一种基于区块链和数字指纹的隐匿数据确权方法，所述方法应用于区块链和数字指纹的隐匿数据确权系统，所述系统包括用户端和数据确权平台，所述用户端与数据确权平台数据连接，所述数据确权平台包括数据处理组件和区块链组件，所述方法包括以下步骤：S1、用户注册/登录数据确权平台：利用区块链组件的分布式身份，用户端在用户注册时为用户创建身份凭证，并将身份凭证签名保存，在用户登录时，通过用户端调用身份凭证，通过验证签名的正确性核实用户身份，若通过则登录成功，若失败则重新登录；S2、在用户成功登录数据确权平台进行原始数据传输时，数据确权平台提供隐匿性确权和托管性确权模式给用户选择；S3、数据确权平台通过用户选择的隐匿性确权和托管性确权模式，进行相对应的确权操作；S4、当数据确权平台确权成功之后向用户端的用户返回确权状态；S5、用户端的用户根据返回确权状态决定是否发起权益审核。进一步的，在步骤S2中，若用户选择隐匿性确权，则用户端利用预置的数字指纹生成算法模型，提取本地生成的数据指纹，提取原始数据的n段关键特性值，并将特性值的哈希一同打包准备传输，特性值提取包括以下步骤：S21、根据原始数据大小确定分段，具体公式为：b＝bmin×2k,其中bmin是最小分段单元，DS为原始数据总长度，b为分段个数；S22、根据原始数据分段内容利用Alder-32进行弱哈希，具体公式为：r＝F,其中r为第i个窗口的弱哈希值，l为固定长度的滑动窗口，C为分段内容，F为弱哈希函数。S23、根据S21步骤中的结果对C进行分段，当ckmodb＝b-1时，在ck处分段；S24、在对C分段完成后，对每段内容进行强哈希，并将每段内容的哈希结果进行截取,最后将每段截取内容进行拼接得到数据的特性值,具体公式为：H＝h1||h2||...||hn,其中H为特性值，hi表示在第1到第n段中的任一段，第i段强哈希的摘要。进一步的，在步骤S2中，若用户选择托管性确权，则利用加密密钥对原始数据进行加密，并与数据确权平台通过密码学中的哈希承诺算法及预付保证金的方式进行安全数据传输。进一步的，在步骤3中，数据确权平台对用户选择的隐匿性确权进行的对应操作具体为：若用户选择隐匿性确权，则用户将本地生成的数据指纹传输至数据确权平台的TEE内部，由TEE内部提供可信时间，同时将确权内容哈希值以及时间、身份信息的确权基础信息通过区块链组件进行交易打包并上链存储，并行的通过数据处理组件进行确权基础信息的数据状态校验，再利用n段数据特性值进行数据指纹的生成并查询当前平台内是否存在相似度大于阈值的指纹，若有则判定数据重复，再根据法规政策要求进行数据合规性校验，则将两个校验的状态合并生成数据确权状态进行上链存储，通过基础信息的上链和确权状态的上链相互结合，生成最终的确权凭证，来判定确权是否成功。进一步的，在步骤3中，数据确权平台对用户选择的托管性确权进行的对应操作具体为：若用户选择托管性确权，则数据确权平台将解密后的原始数据传输至TEE内部进行哈希，同时生成可信时间，再将确权人身份、时间、哈希的信息进行打包上链存储，利用数据确权平台加密密钥对原始数据加密再传输至TEE外部进行保存，并删除TEE内部原始数据，并且在原始数据传输至TEE外部时，将水印进行注入该原始数据中，并行的通过数据处理组件进行确权基础信息的数据状态校验，再利用n段数据特性值进行数据指纹的生成并查询当前平台内是否存在相似度大于阈值的指纹，若有则判定数据重复，再根据法规政策要求进行数据合规性校验，则将两个校验的状态合并生成数据确权状态进行上链存储，通过基础信息的上链和确权状态的上链相互结合，生成最终的确权凭证，来判定确权是否成功。进一步的，在步骤S5中，当用户选择隐匿性数据审核，则用户需调用用户端向数据确权平台提供侵权数据的基于特定数据指纹算法的n段数字特征值，数据确权平台接受到特征值时，利用对应的数据指纹算法生成相应的数据指纹，同时在数据确权平台中获取用户需要进行维权的数据，通过指纹比较确认数据是否重复，再通过提交时间，确认是否侵权。进一步的，在步骤S5中，当用户选择托管性数据审核，则用户调用用户端向数据确权平台提供侵权数据原文，数据确权平台首先检查是否存在水印，若有则判断数据归属方，若无则生成原文的数据指纹，利用数据指纹判断是否数据重复，若重复则通过可信时间判断数据权益归属及是否侵权，若不重复，则返回未侵权。本发明第二方面提供一种基于区块链和数字指纹的隐匿数据确权系统，所述系统用于执行第一方面所述的方法，所述系统包括用户端和数据确权平台，所述用户端与数据确权平台数据连接，所述数据确权平台包括数据处理组件和区块链组件。本发明采用的技术方案如下：一种基于区块链和数字指纹的隐匿数据确权方法，包括与现有技术相比，本发明的有益效果是：1、通过特定的数据指纹算法解决了用户在无法提供原始数据的前提下期望实现数据确权的场景，同时，由于算法相应的数据特征值提取无法逆推原始数据的特性，保证外部在获取数据特征值后无法恢复原始数据。2、通过TEE及流程上链的操作，实现了平台的安全性自证功能，保证平台在数据确权过程中不能非法获取用户数据。3、通过在将数据流转双方的水印加入到数据中，能够实现数据泄漏者的身份确定。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的优选实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例提供的一种基于区块链和数字指纹的隐匿数据确权方法整体结构流程示意图。具体实施方式以下结合附图对本发明的原理和特征进行描述，所列举实施例只用于解释本发明，并非用于限定本发明的范围。参照图1，本发明实施例提供一种基于区块链和数字指纹的隐匿数据确权方法，所述方法应用于区块链和数字指纹的隐匿数据确权系统，所述系统包括用户端和数据确权平台，所述用户端与数据确权平台数据连接，所述数据确权平台包括数据处理组件和区块链组件，所述方法包括以下步骤：S1、用户注册/登录数据确权平台：利用区块链组件的分布式身份，用户端在用户注册时为用户创建身份凭证，并将身份凭证签名保存，在用户登录时，通过用户端调用身份凭证，通过验证签名的正确性核实用户身份，若通过则登录成功，若失败则重新登录；S2、在用户成功登录数据确权平台进行原始数据传输时，数据确权平台提供隐匿性确权和托管性确权模式给用户选择；S3、数据确权平台通过用户选择的隐匿性确权和托管性确权模式，进行相对应的确权操作；S4、当数据确权平台确权成功之后向用户端的用户返回确权状态；S5、用户端的用户根据返回确权状态决定是否发起权益审核。特别的，数据处理组件具有对传输到数据确权平台上的原始数据进行TEE及对数据的传输确认、对数据的重复度、合规性检测以及水印添加/检查等数据处理的功能，区块链组件具有数据进行可信传输合约、确权标识及确权流程上链的功能。在步骤S2中，若用户选择隐匿性确权，则用户端利用预置的数字指纹生成算法模型，提取原始数据的n段关键特性值，并将特性值的哈希一同打包准备传输，特性值提取包括以下步骤：S21、根据原始数据大小确定分段，具体公式为：b＝bmin×2k,其中bmin是最小分段单元，DS为原始数据总长度，b为分段个数；S22、根据原始数据分段内容利用Alder-32进行弱哈希，具体公式为：r＝F,其中r为第i个窗口的弱哈希值，l为固定长度的滑动窗口，C为分段内容，F为弱哈希函数。S23、根据S21步骤中的结果对C进行分段，当ckmodb＝b-1时，在ck处分段；S24、在对C分段完成后，对每段内容进行强哈希，并将每段内容的哈希结果进行截取,最后将每段截取内容进行拼接得到数据的特性值,具体公式为：H＝h1||h2||...||hn,其中H为特性值，hi表示在第1到第n段中的任一段，第i段强哈希的摘要。在步骤S2中，若用户选择托管性确权，则利用加密密钥对原始数据进行加密，并与数据确权平台通过密码学中的哈希承诺算法及预付保证金的方式进行安全数据传输。在步骤3中，数据确权平台对用户选择的隐匿性确权进行的对应操作具体为：若用户选择隐匿性确权，则用户将本地生成的数据指纹传输至数据确权平台的TEE内部，由TEE内部提供可信时间，同时将确权内容哈希值以及时间、身份信息的确权基础信息通过区块链组件进行交易打包并上链存储，并行的通过数据处理组件进行确权基础信息的数据状态校验，再利用n段数据特性值进行数据指纹的生成并查询当前平台内是否存在相似度大于阈值的指纹，若有则判定数据重复，再根据法规政策要求进行数据合规性校验，则将两个校验的状态合并生成数据确权状态进行上链存储，通过基础信息的上链和确权状态的上链相互结合，生成最终的确权凭证，来判定确权是否成功，阈值指纹为相似度大于50％的指纹。在步骤3中，数据确权平台对用户选择的托管性确权进行的对应操作具体为：若用户选择托管性确权，则数据确权平台将解密后的原始数据传输至TEE内部进行哈希，同时生成可信时间，再将确权人身份、时间、哈希的信息进行打包上链存储，利用数据确权平台加密密钥对原始数据加密再传输至TEE外部进行保存，并删除TEE内部原始数据，并且在原始数据传输至TEE外部时，将水印进行注入该原始数据中，并行的通过数据处理组件进行确权基础信息的数据状态校验，再利用n段数据特性值进行数据指纹的生成并查询当前平台内是否存在相似度大于阈值的指纹，若有则判定数据重复，再根据法规政策要求进行数据合规性校验，则将两个校验的状态合并生成数据确权状态进行上链存储，通过基础信息的上链和确权状态的上链相互结合，生成最终的确权凭证，来判定确权是否成功。在步骤S5中，当用户选择隐匿性数据审核，则用户需调用用户端向数据确权平台提供侵权数据的基于特定数据指纹算法的n段数字特征值，数据确权平台接受到特征值时，利用对应的数据指纹算法生成相应的数据指纹，同时在数据确权平台中获取用户需要进行维权的数据，通过指纹比较确认数据是否重复，再通过提交时间，确认是否侵权。在步骤S5中，当用户选择托管性数据审核，则用户调用用户端向数据确权平台提供侵权数据原文，数据确权平台首先检查是否存在水印，若有则判断数据归属方，若无则生成原文的数据指纹，利用数据指纹判断是否数据重复，若重复则通过可信时间判断数据权益归属及是否侵权，若不重复，则返回未侵权。本发明的另一实施例还提供一种基于区块链和数字指纹的隐匿数据确权系统，所述系统用于执行前述方法实施例的方法，所述系统包括用户端和数据确权平台，所述用户端与数据确权平台数据连接，所述数据确权平台包括数据处理组件和区块链组件。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
