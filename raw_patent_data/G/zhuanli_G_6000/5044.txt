标题title
基于强化学习的蛋白质动态配体通道最优路径分析方法
摘要abst
本发明公开基于强化学习的蛋白质动态配体通道最优路径分析方法，包括如下步骤：获取所述蛋白质的静态配体通道信息和全原子动态信息，筛选组成通道的部分原子的动态性并引入三维空间下的栅格法和原子碰撞检测机制，构造仿真环境；构建强化学习模型，所述强化学习模型包括状态、智能体、动作和奖励；当配体分子走出三维空间栅格地图的边界则给当前状态一个负的反馈值并返回上一状态继续训练，直至到达通道终点或者达到单轮最大探索步数，则本轮训练结束，输出本轮训练结果；继续下一轮训练，直至所有训练轮次全部结束，输出蛋白质动态配体通道最优路径。本发明能够协助配体分子找到到达催化活性中心位置的最优路径，具备一定的工程应用参考价值。
权利要求书clms
1.基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，包括如下步骤：获取所述蛋白质的静态配体通道信息和全原子动态信息，筛选组成通道的部分原子的动态性，并引入三维空间下的栅格法和原子碰撞检测机制，构建仿真环境；构建强化学习模型，所述强化学习模型包括状态、智能体、动作和奖励，所述状态数据包括配体分子和组成通道的部分原子的位置信息；将上一状态数据输入强化学习模型中，所述强化学习模型确定所述上一状态数据对应的动作数据，所述智能体根据所述动作数据与仿真环境进行交互得到交互结果，所述交互结果为所述动作数据对应的下一状态数据以及所述动作数据下配体分子对应的奖励数据；当配体分子走出三维空间栅格地图的边界则给当前状态一个负的反馈值并返回上一状态继续训练，直至配体分子到达通道终点或者达到单轮最大探索步数，则本轮训练结束，输出本轮训练中配体分子从通道起点到达通道终点的路径步数和所取得总的回报值；继续下一轮训练，直至所有训练轮次全部结束，输出所有训练轮次中路径步数最少且回报值最高的路径即蛋白质动态配体通道最优路径。2.根据权利要求1所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，还包括如下步骤：从本地或在线的蛋白质结构数据库下载已通过实验手段获得的所述蛋白质和配体分子的三维结构数据。3.根据权利要求2所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，使用MOLE或Caver软件获取所述蛋白质的静态配体通道信息。4.根据权利要求2所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，使用简正模分析或分子动力学模拟方法获取蛋白质的全原子动态信息。5.根据权利要求1所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，所述引入三维空间下栅格法处理，具体包括如下步骤：构建三维空间栅格地图，所述三维空间栅格地图中栅格单元的大小取决于配体分子大小，所述三维空间栅格地图中栅格单元的数量取决于获得的静态配体通道周围原子所占的空间大小；将配体分子置于通道起点，所述三维空间栅格地图中每个栅格单元为配体分子的最小移动单位。6.根据权利要求5所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，所述原子碰撞检测机制之前，还包括如下步骤：判断配体分子的三维结构形状是否为规则球体，若是，则通过球体包裹配体分子采用球体包围盒，栅格单元为球体外接正方体；若否，则采用圆柱体包裹配体分子，采用三维AABB包围盒，栅格单元为包围盒正方体；将组成通道的部分原子抽象为球体，对三维空间栅格地图中配体分子与每个原子碰撞进行实时检测。7.根据权利要求5所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，所述动作数据为三维空间栅格地图中上下左右前后，所述状态数据为三维空间坐标值所对应的状态值。8.根据权利要求1所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，所述强化学习模型采用时序差分离线控制算法Q-learning。9.根据权利要求7所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，还包括如下步骤：引入指数衰减因子，使所述强化学习模型中探索率随时间的不断增加而逐渐减小。10.根据权利要求1所述的基于强化学习的蛋白质动态配体通道最优路径分析方法，其特征在于，所述配体分子对应的奖励数据是根据奖惩函数获得，所述奖惩函数描述如下：
说明书desc
技术领域本发明涉及强化学习技术领域，尤其涉及基于强化学习的蛋白质动态配体通道最优路径分析方法。背景技术蛋白质配体通道的主要研究方法有拉伸分子动力学、随机加速分子动力学、晶体热力学因子法、计算方法等。由于生物学实验成本问题，目前计算方法在配体通道识别领域发挥着关键作用。通道计算方法一般分为两类：1)将配体分子纳入通道识别过程的方法；2)仅基于蛋白质结构计算通道的方法，如下所示：将配体分子纳入通道识别过程的方法中，明确考虑了特定的配体分子，通过分子动力学模拟等技术，探测蛋白质结构中可能存在的通道。此方法需要大量的资源用于模拟，而且这些模拟并不总能找到成功的通道出口，而且可能会产生不现实的通道，所以并不常用。仅基于蛋白质结构计算通道的方法中，不提前考虑配体分子，将蛋白质结构转换为几何上可处理的问题，简化了通道识别的任务。该方法的优势在于计算时间和计算费用通常较小，而且可以生成通道尺寸和周围原子的详细信息。其中最具代表性的是M等在2006年提出的CAVER算法。CAVER通过利用Dijkstra算法探索网格节点来工作，Dijkstra 的算法被用来选择最短和最便宜的路径。CAVER主要用于分析蛋白质结构通道，为静态通道提供快速、准确和全自动的计算，CAVER的出现，对于药物设计和分子酶学的研究起了非常重要的作用，但是CAVER存在探索大通道时对处理器时间和内存要求非常高和系统持续误差的问题。M和其团队在2007年提出基于Voronoi 网格的MOLE算法。MOLE克服了CAVER的许多缺点和局限性。虽然MOLE算法核心也是Dijkstra路径搜索算法，但是作者将其应用于Voronoi图，并且对于多种生物分子系统的测试，包括钾通道、细胞色素P450配体通道，都已经证明该算法运行良好。2013 年，David等人对MOLE进行了算法升级，提出了MOLE2.0版本，新的版本可以识别出更多相关通道，经过与其他的工具基准测试表明，MOLE2.0更快、更健壮、更通用。2017 年，Berka K又推出了MOLE2.5版本，此版本不仅可以计算通道，还能检测孔隙。这也是目前MOLE的最新版本。随着近些年不断的更新迭代，MOLE已经逐渐成为快速检测生物大分子结构中通道的一个黄金标准。但是不管CAVER还是MOLE软件算出来的通道都是静态的，而由于蛋白质动态性的存在，实际组成这些通道的原子是处于不停的运动之中，因此通道实际位置也会发生对应的改变。目前通道计算方法均没有考虑到蛋白质的动态信息。发明内容为了解决上述技术问题，本发明提出基于强化学习的蛋白质动态配体通道最优路径分析方法。在静态通道的基础上考虑蛋白质配体通道的动态性问题，使配体通道问题更加的符合实际情况。蛋白质的动态性是指蛋白质空间构象可在一定的微环境中发生构象的改变，各种构象异构体可以调节蛋白质的折叠与功能。为了达到上述目的，本发明的技术方案如下：基于强化学习的蛋白质动态配体通道最优路径分析方法，包括如下步骤：获取所述蛋白质的静态配体通道信息和全原子动态信息，筛选组成通道的部分原子的动态性，并引入三维空间下的栅格法和原子碰撞检测机制，构建仿真环境；构建强化学习模型，所述强化学习模型包括状态、智能体、动作和奖励，所述状态数据包括配体分子和组成通道的部分原子的位置信息；将上一状态数据输入强化学习模型中，所述强化学习模型确定所述上一状态数据对应的动作数据，所述智能体根据所述动作数据与仿真环境进行交互得到交互结果，所述交互结果为所述动作数据对应的下一状态数据以及所述动作数据下配体分子对应的奖励数据；当配体分子走出三维空间栅格地图的边界则给当前状态一个负的反馈值并返回上一状态继续训练，直至配体分子到达通道终点或者达到单轮最大探索步数，则本轮训练结束，输出本轮训练中配体分子从通道起点到达通道终点的路径步数和所取得总的回报值；继续下一轮训练，直至所有训练轮次全部结束，输出所有训练轮次中路径步数最少且回报值最高的路径即蛋白质动态配体通道最优路径。优选地，还包括如下步骤：从本地或在线的蛋白质结构数据库下载已通过实验手段获得的所述蛋白质和配体分子的三维结构数据。优选地，使用MOLE或Caver软件获取所述蛋白质的静态配体通道信息。优选地，使用简正模分析或分子动力学模拟方法获取蛋白质的全原子动态信息。优选地，所述引入三维空间下栅格法处理，具体包括如下步骤：构建三维空间栅格地图，所述三维空间栅格地图中栅格单元的大小取决于配体分子大小，所述三维空间栅格地图中栅格单元的数量取决于获得的静态配体通道周围原子所占的空间大小；将配体分子置于通道起点，所述三维空间栅格地图中每个栅格单元为配体分子的最小移动单位。优选地，所述原子碰撞检测机制之前，还包括如下步骤：判断配体分子的三维结构形状是否为规则球体，若是，则通过球体包裹配体分子采用球体包围盒，栅格单元为球体外接正方体；若否，则采用圆柱体包裹配体分子，采用三维 AABB包围盒，栅格单元为包围盒正方体；将组成通道的部分原子抽象为球体，对三维空间栅格地图中配体分子与每个原子碰撞进行实时检测。优选地，所述动作数据为三维空间栅格地图中上下左右前后，所述状态数据为三维空间坐标值所对应的状态值。优选地，所述强化学习模型采用时序差分离线控制算法Q-learning。优选地，还包括如下步骤：引入指数衰减因子，使所述强化学习模型中探索率随时间的不断增加而逐渐减小。优选地，所述配体分子对应的奖励数据是根据奖惩函数获得，所述奖惩函数描述如下：基于上述技术方案，本发明的有益效果是：本发明基于MOLE出色的静态通道计算能力，使用简正模分析计算蛋白质的动态信息，结合得到蛋白质的动态通道信息，然后基于强化学习环境Gym，通过引入基于包围盒的碰撞检测算法对栅格法进行了改进，采用时序差分离线控制算法Q-Learning进行了学习，针对探索率引入了指数衰减因子，设计奖惩函数避开动态原子碰撞，实现最短步数内到达催化活性中心位置，具备一定的工程应用参考价值。附图说明图1是一个实施例中基于强化学习的蛋白质动态配体通道最优路径分析方法的结构示意图；图2是一个实施例中1bu7的所有通道图；图3是一个实施例中1bu7的所有通道周围原子图；图4是图3中1bu7的各个通道周围原子图；图5是一个实施例中ANM计算流程图；图6是一个实施例中1bu7蛋白质动态性展示；图7是一个实施例中1bu7通道一周围原子动态性展示；图8是一个实施例中三维环境栅格法示意图；图9是一个实施例中构造栅格单元流程图；图10是一个实施例中基于强化学习的蛋白质动态配体通道最优路径分析方法的结构示意图；图11是一个实施例中不同探索率的收敛图；图12是一个实施例中奖励值收敛对比图；图13是图4中1bu7不同通道对应的最优路径展示图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述。如图1所示，本实施例提供一种基于强化学习的蛋白质动态配体通道最优路径分析方法，包括如下步骤：步骤1:环境创建。根据MOLE软件算出来的静态配体通道信息和NMA计算的全原子动态信息，结合生成组成通道的原子的动态信息，即配体通道的动态信息。同时基于python脚本进行目标环境的栅格化处理和原子碰撞检测机制的引入。本实施例中，通过MOLE软件计算蛋白质静态配体通道。本地化部署MOLE的核心是配置XML文件进行计算，设置合适的直径用于通道过滤，设置通道终点坐标用于通道的路径计算。MOLE支持输出多格式的不同结果，系统中主要用得到是PDBProfile和 PDBStructure和PyMOL格式。其中，PDBProfile输出格式为PDB文件，保存通道中心坐标及通道半径等数据。PDBStructure输出格式为PDB文件，保存组成通道的周围原子信息。 PyMOL输出格式为Python文件，主要用来快速在PyMOL工具可视化通道。以1BU7为例，设置通道最小半径为1.2，通道起点为催化中心的Fe原子，配置input_1bu7.xml文件，Linux 和MacOS用户需要安装Mono才可以使用，命令为：mono mole2.exe../Test_data/1BU7/input_1BU7.xml，其静态通道计算结果可视化如图2、图3、图 4所示。本实施例中，使用简正模分析计算蛋白质全原子的动态信息。NMA大致可以分为两类：基于力场的方法和基于网络的方法。基于力场的方法利用详细的分子相互作用，通常比基于网络的方法产生更精确的模式。然而，传统基于力场的方法要求初始能力最小化，这会扭曲结构。基于网络的方法一般为弹性网络，则绕过了这一步骤。ENM是用生物物理的方法来处理分析蛋白质的有效手段，其本质为胡克弹性定律的一种变相拓展，从网络的高维度层面去表征蛋白质的内在动力学性质。本系统不仅需要考虑各个原子的运动幅度信息，还需要考虑它们的运动方向，选用各向异性网络模型计算。使用ANM进行计算，输入文件为蛋白质三维结构PDB文件，主要包含构成蛋白质的原子和残基的位置坐标等信息。ANM计算核心代流程如图5所示。通过NMA计算出来的新坐标称为简正坐标,一个NMC代表一个振动模式。假设原子A起始位置坐标为，通过NMA计算出来的 NMC为，那么原子A的运动范围为：x∈,y∈,z∈将问题一般化，设原子A坐标为，通过NMA计算出来的NMC为，那么原子A的运动范围为：x∈,y∈,z∈那么t时刻原子A坐标为：xt＝x0+αtmx,yt＝y0+αtmy,zt＝z0+αtmz其中，αt∈且为一位小数。设定一个随机数序列用于产生αi的值，代表不同时刻ti各个原子处于各自范围内的随机位置。那么t1时刻和t2时刻原子位置为：x1＝x0+α1mx；y1＝y0+α1my；z1＝z0+α1mzx2＝x0+α2mx；y2＝y0+α2my；z2＝z0+α2mz计算t1到t2时刻的位置变化量：则在t1到t2时刻，原子在x轴经过的距离为mx，极端情况下取边界值α2＝1，α1＝-1那么原子沿x轴经过的距离为2mx，最终位置为x1+2mx。代入公式具体计算：x1＝x0-mx而x2＝x1+2mx＝x0+mx。由于每次都是基于初始位置x0进行计算，这样处理的好处是不需要进行往返运动的边界值判断，直接确保了每一时刻的原子位置肯定在其运动范围内。下面具体举例进行说明，设当前系统产生的随机数序列为，原子和NMA 坐标信息如表1所示。表1原子运动信息分析表t1时刻到t2时刻，t2时刻到t3时刻x方向位移的变化量为：简谐运动的周期T指的是原子在起始位置开始，经过一个完整的来回，又回到该点所需的时间。原子在其周期划分中位置如表2所示。表2运动周期信息表在不同周期，原子所在位置相对于其初始位置的变化量如下：其中，以x轴方向的位置变化信息为例，t0到t1时刻，原子位移为0.1mx，t1到t2时刻，原子位移为0.7mx，相当于在t0时刻到t2一共位移0.8mx。而在t2到t3时时刻，计算出原子位移变化量为-1.2mx，可以分解为0.2mx+。在前面0.8mx的基础上，先经过0.2mx到达mx，即的位置，此时已经到达正向运动边界，需要反向进行位移。剩下的-1.4mx可以直接进行计算。也可以分解为-1.0mx+，前面的代表反向运动 mx距离，即到达位置，也是初始位置，然后继续反向运动0.4mx的位移。可以看出，虽然在计算上t3时刻只是按照α3＝-0.4，反向运动0.4mx，但包含了前一时刻位置到该时刻位置的变化信息。其计算结果可视化如下图6所示。本实施例中，通过python脚本筛选组成通道的部分原子的动态信息。基于存储于文件： tunnel1_structure.pdb中已经得到组成每个通道的原子信息，以及存储于文件：1bu7_anm_modes.nmd中计算出了蛋白质所有原子的运动信息，从tunnel1_structure.pdb文件中提取所有组成通道的原子编号，从1bu7_anm_modes.nmd文件中提取所有原子的坐标及其运动模式坐标，然后筛选组成通道的原子所对应的坐标及运动信息即可。1bu7的通道1周围原子动态性如图7所示。箭头方向代表运动方向，长度代表运动幅度。本实施例中，为了方便进行碰撞的检测，将配体分子和全原子抽象成球体，具体的如图8所示。采用三维空间下栅格法对目标问题进行环境建模，如图9所示。常规栅格法通过判断目标点周围栅格内有无障碍物存在来确定对应栅格是否可以移动，由于目标环境中的障碍物尺寸远小于栅格单元的尺寸，而且每一个小原子时刻都处于不停的运动状态，按照常规思路去判断其周围栅格是否可以进行移动就不合适，所以目标环境中每个栅格都只是作为一个最小移动单元供配体分子进行移动，而不考虑其移动路径上是否存在障碍物。即配体分子在每一步移动前也并不知道下一步位置会不会遇到障碍物，这样的环境也可以充分发挥通过强化学习让智能体感知未知环境的优势。当前时刻的位置是否允许移动则采用碰撞检测的方式进行实现，若是检测到发生碰撞，则证明当前位置是不可以移动的，反之则可以正常通行。由于大部分配体分子呈现不规则的三维结构，则需要先使用圆柱体对其进行包裹，然后再使用三空间的AABB包围盒对其进行包围。这个包围盒的大小即是一个栅格单元的大小，构建栅格，单元流程如图10所示。对目标环境中引入碰撞检测算法，将每个小球体都抽象为碰撞体。借助目前主流的开源检测库FCL实现对目标环境中每一时刻的原子碰撞进行实时检测。此时系统中只剩下大球体和小球体，只需要检测大球体和小球体是否会发生碰撞即可。步骤2:环境初始化。初始化强化学习的状态空间、动作空间和奖惩函数。本实施例中，采用三维空间下栅格法对目标问题进行环境建模，其状态空间S和动作空间A均为有限集合，而且经过栅格化处理后动作空间只有六种，状态空间也不大，因此选用Q-learning算法作为主体进行强化学习模型的构建。具体说明如下：状态空间：由于目标环境采用了栅格法进行构建，那么对栅格进行编码即可确定状态空间，栅格编号与状态编号一一对应，状态St表示配体分子在t时刻所在栅格位置编号，栅格采用从左到右，从上到下的方式进行编号。栅格单元的数量取决于配体分子本身的大小和通道周围原子所占的空间大小。栅格单元的数量越多，路径规划精度越高，但同时导致问题规模越大，算法收敛速度越慢。动作空间：由于在建模中采用了基于AABB包围盒的碰撞检测算法，而包围盒本身大小近似为栅格单元大小，所以目前不需要考虑配体分子的具体姿态问题和运动角度问题，每个三维栅格即为一个最小移动单元。配体分子每一步移动的长度x为包裹体的直径，也是正方体栅格的宽。采用栅格化的环境极大简化了移动体的移动方向，只需要考虑前后上下左右六种即可，坐标取值基于右手空间直角坐标系，那么动作空间信息如表3所示。表3动作空间信息表奖惩函数：首先目标是让配体分子成功到达通道终点处，所以需要给终点设置一个比较大的奖励。由于在栅格化构建地图时相当于增加了边界限制，配体分子在刚开始探索时有很大的几率会走出这个边界，那么其后面的探索是没有任何意义的，所以给越界状态一个较大的惩罚。如果配体分子和原子相撞说明此条路径存在障碍物阻拦其前进，那么这条路径已经探索失败了，同样给一个大的惩罚并同时直接终止此轮尝试，直接从头开始新的一轮探索。奖惩函数描述如下：状态转移：栅格法保证了状态空间编号和三维坐标值是唯一对应的，那么我们就可以通过当前时刻的坐标和采用的动作去计算下一时刻的位置坐标，然后根据此位置坐标找到对应的状态编号，也可以根据新位置和状态编号对应关系判断是否出了边界因为边界以外的坐标值不存在对应的状态空间编号。步骤3:超参数设置。学习率、奖励衰减因子、探索率等模型中的超参数。本实施例中，一般来说，时序差分离线控制算法Q-learning中前期需要较大的探索率∈去更快的更新价值函数，后期则需要减小探索率利用经验选择最优路径以保证结果的收敛性。而∈-贪婪法中探索率始终保持不变，这极大地影响了模型后期的收敛性。针对这个问题，在系统中针对探索率引入指数衰减因子，可以放心的在训练之初设置比较高的探索率，而随着训练的进行，探索率不断进行衰减，在后期探索率降得特别低，保证了模型的完全收敛，如图11所示。如果小分子与其他原子发现相撞，说明这条路径存在障碍物，本轮训练失败，其奖励值收敛图如图12所示。在训练的过程中发现：虽然本次探索过程中已经发生了碰撞，但是也可以让小分子继续进行探索，虽然原子在某个状态已经发生碰撞，但是其后续的探索仍然是有价值的，采用此做法可以极大地减少收敛所需的训练轮数。设置小分子与原子相撞后不停止继续探索，实验结果表明：该做法虽然在一开始训练速度较慢，但是可以更快找到一条稳定可达的路径，的确可以使模型更快的达到收敛，如图12所示。设置小分子与原子相撞后继续探索以后，虽然前期的单轮训练变慢，但是总的训练时间比起之前还是有所减少。模型最终的超参数设置如表4所示。表4模型超参数信息表步骤4:状态初始化。初始化配体分子和每个原子位置及状态-动作Q表格，开始训练。步骤5:动作选择。根据给定的策略在当前状态st选择配体分子的具体动作a，将该动作 a作用于环境得到相应的反馈r，同时记住新状态st+1。步骤6:Q表更新。根据Q-learning的更新公式对状态st采用动作a所在位置的Q值进行更新。步骤7:边界检测。如果配体分子st+1状态对应的位置已经出了环境的边界，那么认为此动作无效，重新回到st状态，即令st+1＝st。同时环境反馈一个惩罚值给配体分子，那么以后会避免在该状态选择该动作。步骤8:状态更新。环境由状态st进入新状态st+1。步骤9:碰撞检测。对新状态st+1配体分子所处位置和各个原子的位置进行更新，对系统进行碰撞检测。如果配体分子与Fe相撞，说明成功到达了终点，本轮训练结束，直接跳转到步骤4重新开始一轮新的训练。否则继续回到步骤5继续本次探索。步骤10:直到所有训练轮次全部结束，输出最优路径步数和所取得总的回报值及路径选择信息。经过上述操作，目前已经构造了蛋白质动态配体通道的仿真环境，同时设定了合理的强化学习算法流程进行目标问题的训练和学习。上述所有流程均已通过Python进行了编程实现，经过大量的实验表明，对于任何存在配体通道的蛋白质，本方法均可以在在很快时间内完成静态通道的计算、原子动态性的计算、动态配体通道的环境仿真和强化学习模型的训练，最终可以得到一条到达催化活性中心的动态配体通道最优路径，具有一定的工程参考价值。对1BU7的三个通道进行分析,结果如表5、图13所示。表5 1BU7通道分析对比表以上所述仅为本发明所公开的基于强化学习的蛋白质动态配体通道最优路径分析方法的优选实施方式，并非用于限定本说明书实施例的保护范围。凡在本说明书实施例的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本说明书实施例的保护范围之内。
