标题title
面向海量工控网络日志数据的异常事件挖掘方法及系统
摘要abst
本发明涉及面向海量工控网络日志数据的异常事件挖掘方法及系统，其特征在于，包括以下步骤：S1：根据历史日志信息，建立专业语料库；S2：构建异常事件挖掘模型，并将语料库输入所述异常事件挖掘模型训练；S3：将上文日志数据输入训练好的异常事件挖掘模型，并输出预测结果；S4：将所述预测结果与下文日志数据进行比较，得到异常事件挖掘结果。本发明所提供的面向海量工控网络日志数据的异常事件挖掘方法及系统，能够对工控网络的日志信息进行解析，从而建立一个专业语料库，并将该专业语料库作为训练集，训练一个基于长短期记忆神经网络的异常事件挖掘模型，进而能够根据该模型对日志序列进行预测，进而根据预测结果，来判断日志的异常事件。
权利要求书clms
1.面向海量工控网络日志数据的异常事件挖掘方法，其特征在于，包括以下步骤：S1：根据历史日志信息，建立专业语料库；S2：构建异常事件挖掘模型，并将语料库输入所述异常事件挖掘模型训练；S3：将上文日志数据输入训练好的异常事件挖掘模型，并输出预测结果；S4：将所述预测结果与下文日志数据进行比较，得到异常事件挖掘结果。2.根据权利要求1所述的面向海量工控网络日志数据的异常事件挖掘方法，其特征在于，所述S1包括：S11：提取部分正常历史日志信息；S12：对所述正常历史日志信息中的每一条日志数据进行状态编码；S13：将所述正常历史日志信息的状态编码结果生成专业语料库。3.根据权利要求2所述的面向海量工控网络日志数据的异常事件挖掘方法，其特征在于，所述S12包括：S121：读取所述正常历史日志信息，并将所述正常历史日志信息转化为状态序列；S122：逐一比较所述状态序列中每一条日志数据的最大公共部分，若所述最大公共部分长度大于所在日志数据长度的一半，将所述最大公共部分作为一类状态，并赋予状态编码；S123：利用状态编码，对所述状态序列中的每一条日志数据进行标记。4.根据权利要求3所述的面向海量工控网络日志数据的异常事件挖掘方法，其特征在于，所述异常事件挖掘模型为长短期记忆神经网络模型，包括多个LSTM单元，每个所述LSTM单元的输出门后均设置有全连接层，用于输出对应LSTM单元的时间步输出结果。5.根据权利要求4所述的面向海量工控网络日志数据的异常事件挖掘方法，其特征在于，所述S3包括：S31：对所述上文日志数据进行状态编码处理；S32：将状态编码处理后的上文日志数据输入所述异常事件挖掘模型，并通过所述异常事件挖掘模型的全连接层输出预测结果。6.根据权利要求5所述的面向海量工控网络日志数据的异常事件挖掘方法，其特征在于，所述S4中“将所述预测结果与下文日志数据进行比较”包括：S41：比较所述预测结果与所述下文日志数据的差异值，并比较差异值与预设阈值之间的大小关系。7.面向海量工控网络日志数据的异常事件挖掘系统，其特征在于，包括：语料库构建模块，用于配置安全策略并生成安全策略配置文件；异常事件挖掘模型训练模块，用于构建异常事件挖掘模型，并将语料库输入所述异常事件挖掘模型训练；异常预测模块，用于将上文日志数据输入训练好的异常事件挖掘模型，并输出预测结果；结果比较模块，用于将所述预测结果与下文日志数据进行比较，得到异常事件挖掘结果。8.根据权利要求7所述的面向海量工控网络日志数据的异常事件挖掘系统，其特征在于，所述语料库构建模块包括：历史日志信息提取子模块，用于提取部分正常历史日志信息；状态编码子模块，用于对所述正常历史日志信息中的每一条日志数据进行状态编码；语料库生成子模块，用于将所述正常历史日志信息的状态编码结果生成专业语料库。9.根据权利要求8所述的面向海量工控网络日志数据的异常事件挖掘系统，其特征在于，所述状态编码子模块包括：状态序列转化单元，用于读取所述正常历史日志信息，并将所述正常历史日志信息转化为状态序列；状态编码赋予单元，用于逐一比较所述状态序列中每一条日志数据的最大公共部分，若所述最大公共部分长度大于所在日志数据长度的一半，将所述最大公共部分作为一类状态，并赋予状态编码；日志数据标记单元，用于利用状态编码，对所述状态序列中的每一条日志数据进行标记。10.根据权利要求9所述的面向海量工控网络日志数据的异常事件挖掘系统，其特征在于，所述异常预测模块包括：数据预处理子模块，用于对所述上文日志数据进行状态编码处理；结果输出子模块，用于将状态编码处理后的上文日志数据输入所述异常事件挖掘模型，并通过所述异常事件挖掘模型的全连接层输出预测结果。
说明书desc
技术领域本发明涉及工业控制网络信息技术领域，具体涉及面向海量工控网络日志数据的异常事件挖掘方法及系统。背景技术工控网络是用于驱动和调控工业设施体系的信息化网络，用于在工业智能化生产中进行各类指令和数据的传输，同时当然也会伴随着产生海量的工控网络日志数据，而工控网络的日志数据记载了工业生产过程中系统中硬件、软件和系统问题的信息，同时还可以监视系统中发生的事件。用户可以通过它来检查错误发生的原因，或者寻找受到攻击时攻击者留下的痕迹。因此对于工控网络的日志数据的监管，对于企业的日常生产网络安全具有十分重要的意义。然而，现有工控网络中对于工控网络日志数据的管理审核仍旧非常繁琐，面对海量的日志数据缺乏有效的监控手段，若只是单纯采用将日志信息进行提取识，然后进行别人工审核，不仅产生大量的运算，还增加了管理人员的管理难度。发明内容本发明提供的面向海量工控网络日志数据的异常事件挖掘方法及系统，能够解决上述过程中的技术问题。本发明解决上述技术问题的技术方案如下：第一方面，本发明提供了面向海量工控网络日志数据的异常事件挖掘方法，包括以下步骤：S1：根据历史日志信息，建立专业语料库；S2：构建异常事件挖掘模型，并将语料库输入所述异常事件挖掘模型训练；S3：将上文日志数据输入训练好的异常事件挖掘模型，并输出预测结果；S4：将所述预测结果与下文日志数据进行比较，得到异常事件挖掘结果。在一些实施例中，所述S1包括：S11：提取部分正常历史日志信息；S12：对所述正常历史日志信息中的每一条日志数据进行状态编码；S13：将所述正常历史日志信息的状态编码结果生成专业语料库。在一些实施例中，所述S12包括：S121：读取所述正常历史日志信息，并将所述正常历史日志信息转化为状态序列；S122：逐一比较所述状态序列中每一条日志数据的最大公共部分，若所述最大公共部分长度大于所在日志数据长度的一半，将所述最大公共部分作为一类状态，并赋予状态编码；S123：利用状态编码，对所述状态序列中的每一条日志数据进行标记。在一些实施例中，所述异常事件挖掘模型为长短期记忆神经网络模型，包括多个LSTM单元，每个所述LSTM单元的输出门后均设置有全连接层，用于输出对应LSTM单元的时间步输出结果。在一些实施例中，所述S3包括：S31：对所述上文日志数据进行状态编码处理；S32：将状态编码处理后的上文日志数据输入所述异常事件挖掘模型，并通过所述异常事件挖掘模型的全连接层输出预测结果。在一些实施例中，所述S4中“将所述预测结果与下文日志数据进行比较”包括：S41：比较所述预测结果与所述下文日志数据的差异值，并比较差异值与预设阈值之间的大小关系。第二方面，本发明还提供了面向海量工控网络日志数据的异常事件挖掘系统，包括，语料库构建模块，用于配置安全策略并生成安全策略配置文件；异常事件挖掘模型训练模块，用于构建异常事件挖掘模型，并将语料库输入所述异常事件挖掘模型训练；异常预测模块，用于将上文日志数据输入训练好的异常事件挖掘模型，并输出预测结果；结果比较模块，用于将所述预测结果与下文日志数据进行比较，得到异常事件挖掘结果。在一些实施例中，所述语料库构建模块包括：历史日志信息提取子模块，用于提取部分正常历史日志信息；状态编码子模块，用于对所述正常历史日志信息中的每一条日志数据进行状态编码；语料库生成子模块，用于将所述正常历史日志信息的状态编码结果生成专业语料库。在一些实施例中，所述状态编码子模块包括：状态序列转化单元，用于读取所述正常历史日志信息，并将所述正常历史日志信息转化为状态序列；状态编码赋予单元，用于逐一比较所述状态序列中每一条日志数据的最大公共部分，若所述最大公共部分长度大于所在日志数据长度的一半，将所述最大公共部分作为一类状态，并赋予状态编码；日志数据标记单元，用于利用状态编码，对所述状态序列中的每一条日志数据进行标记。在一些实施例中，所述异常预测模块包括：数据预处理子模块，用于对所述上文日志数据进行状态编码处理；结果输出子模块，用于将状态编码处理后的上文日志数据输入所述异常事件挖掘模型，并通过所述异常事件挖掘模型的全连接层输出预测结果。本申请的有益效果是：本申请提供的面向海量工控网络日志数据的异常事件挖掘方法及系统，能够对工控网络的日志信息进行解析，从而建立一个专业语料库，并将该专业语料库作为训练集，训练一个基于长短期记忆神经网络的异常事件挖掘模型，进而能够根据该异常事件挖掘模型对日志序列进行预测，进而根据预测结果与预设阈值的比较，来判断日志的异常事件。通过本方法，能够利用少部分的正常历史日志信息数据，建立一个长短期记忆神经网络的异常事件挖掘模型，来对海量的工控网络日志数据异常事件进行挖掘，不仅计算效率高，其预测准确率也能够得到保障。附图说明图1为本申请的面向海量工控网络日志数据的异常事件挖掘方法流程图；图2为本申请步骤S1的子流程图；图3为本申请步骤S12的子流程图；图4为本申请步骤S3的子流程图；图5为本申请步骤S4的子流程图。具体实施方式以下结合附图对本发明的原理和特征进行描述，所举实例只用于解释本发明，并非用于限定本发明的范围。为了能够更清楚地理解本申请的上述目的、特征和优点，下面结合附图和实施例对本公开作进一步的详细说明。可以理解的是，所描述的实施例是本公开的一部分实施例，而不是全部的实施例。此处所描述的具体实施例仅仅用于解释本公开，而非对本申请的限定。基于所描述的本申请的实施例，本领域普通技术人员所获得的所有其他实施例，都属于本申请保护的范围。需要说明的是，在本文中，诸如“第一”和“第二”等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。图1为本申请的面向海量工控网络日志数据的异常事件挖掘方法流程图。面向海量工控网络日志数据的异常事件挖掘方法流程图，结合图1，包括以下步骤：S1：根据历史日志信息，建立专业语料库；在一些实施例中，结合图2，即本方案步骤S1的子流程图，所述步骤S1包括：S11：提取部分正常历史日志信息；S12：对所述正常历史日志信息中的每一条日志数据进行状态编码；S13：将所述正常历史日志信息的状态编码结果生成专业语料库。在一些实施例中，结合图3，基本方案步骤S12的子流程图，所述S12包括：S121：读取所述正常历史日志信息，并将所述正常历史日志信息转化为状态序列；S122：逐一比较所述状态序列中每一条日志数据的最大公共部分，若所述最大公共部分长度大于所在日志数据长度的一半，将所述最大公共部分作为一类状态，并赋予状态编码；S123：利用状态编码，对所述状态序列中的每一条日志数据进行标记。具体的，工控网络在生产过程中会产生海量的日志信息，对日志信息的监测对于工控网络的安全运行起到了至关重要的作用，然而对于海量的日志数据，若只是单纯采用将日志信息进行提取识别，将会产生大量的运算，因此本方案首先要根据历史日志信息，建立专业语料库，其作用在于给长短期记忆神经网络模型提供训练集，而专业语料库的建立是基于一小部分的正常历史日志信息；正常的日志信息包括了日志参数和日志键，而长短期记忆神经网络的输入需要的是结构化的数据，因此，还需要将这一部分正常历史日志信息进行状态编码是为了使建立的专业语料库具有结构化属性。而如何对历史日志信息进行状态编码，则首先需要将这一部分日志信息转化为基于时间序列的状态序列，然后逐一对状态序列中每一条日志数据的最大公共部分，若最大公共部分长度大于所在日志数据长度的一半，将所述最大公共部分作为一类状态，并赋予状态编码，此步骤是为了对该训练集中的每一条日志信息提取出其日志键，并将对应同一日志键的日志信息归为同一类状态，从而给每一条日志数据进行状态编码的标记，以便于生成结构化的日志信息，进而能够作为训练集输入长短期记忆神经网络模型。S2：构建异常事件挖掘模型，并将语料库输入所述异常事件挖掘模型训练；在一些实施例中，所述异常事件挖掘模型为长短期记忆神经网络模型，包括多个LSTM单元，每个所述LSTM单元的输出门后均设置有全连接层，用于输出对应LSTM单元的时间步输出结果。具体的，本方案中异常事件挖掘模型采用长短期记忆神经网络模型LSTM，而本方案采用的为单层LSTM模型，其包括了多个LSTM单元，每一个LSTM单元都对应了一个时间步的输出，而为了得到每一个时间步的输出结果，需要给每个所述LSTM单元的输出门后均设置一个全连接层。在输入训练集训练之后，即可将样本数据输入本模型，进行结果的预测，而预测数据则是日志信息的状态编码以及日志参数与时间序列相对应的概率函数。S3：将上文日志数据输入训练好的异常事件挖掘模型，并输出预测结果；在一些实施例中，结合图4，即本方案步骤S3的子流程图，所述步骤S3包括：S31：对所述上文日志数据进行状态编码处理；S32：将状态编码处理后的上文日志数据输入所述异常事件挖掘模型，并通过所述异常事件挖掘模型的全连接层输出预测结果。具体的，对于输入异常事件挖掘模型的数据，同样需要先将数据进行结构化处理，那么我们将上下文日志数据进行状态编码处理后作为样本集输入到异常事件挖掘模型，然后通过异常事件挖掘模型的全连接层输出预测结果。本方案中，在原始日志文件中，以选中的日志文件为参照，选中的日志文件之前若干条称作上文日志，之后若干条称作下文日志。因此，在本方案中，将上文日志数据当做异常事件挖掘模型的输入数据，然后将输出的预测结果与下文日志数据做比较即可得知实际的下文日志数据与预测数据的差异值，并通过差异值来判断下文数据中是否存在异常。S4：将所述预测结果与下文日志数据进行比较，得到异常事件挖掘结果；在一些实施例中，结合图5，即本方案步骤S4的子流程图，所述步骤S4包括：S41：比较所述预测结果与所述下文日志数据的差异值，并比较差异值与预设阈值之间的大小关系。具体的，对于输出的预测结果，其实际上包括了多个时间步后的日志信息预测，其中包含了多个时间步后的日志信息参数与日志键的概率分布，我们将这个预测结果与若干时间步后的下文日志信息进行比较，若结果出现差异，那么我们可以根据差异值的大小来做出判断，例如差异值大于20%的预设阈值，即可认定为异常事件。本发明第二方面还提供了面向海量工控网络日志数据的异常事件挖掘系统，包括：语料库构建模块，用于配置安全策略并生成安全策略配置文件；异常事件挖掘模型训练模块，用于构建异常事件挖掘模型，并将语料库输入所述异常事件挖掘模型训练；异常预测模块，用于将上文日志数据输入训练好的异常事件挖掘模型，并输出预测结果；结果比较模块，用于将所述预测结果与下文日志数据进行比较，得到异常事件挖掘结果。在一些实施例中，所述语料库构建模块包括：历史日志信息提取子模块，用于提取部分正常历史日志信息；状态编码子模块，用于对所述正常历史日志信息中的每一条日志数据进行状态编码；语料库生成子模块，用于将所述正常历史日志信息的状态编码结果生成专业语料库。在一些实施例中，所述状态编码子模块包括：状态序列转化单元，用于读取所述正常历史日志信息，并将所述正常历史日志信息转化为状态序列；状态编码赋予单元，用于逐一比较所述状态序列中每一条日志数据的最大公共部分，若所述最大公共部分长度大于所在日志数据长度的一半，将所述最大公共部分作为一类状态，并赋予状态编码；日志数据标记单元，用于利用状态编码，对所述状态序列中的每一条日志数据进行标记。在一些实施例中，所述异常预测模块包括：数据预处理子模块，用于对所述上文日志数据进行状态编码处理；结果输出子模块，用于将状态编码处理后的上文日志数据输入所述异常事件挖掘模型，并通过所述异常事件挖掘模型的全连接层输出预测结果。本领域的技术人员能够理解，尽管在此所述的一些实施例包括其它实施例中所包括的某些特征而不是其它特征，但是不同实施例的特征的组合意味着处于本申请的范围之内并且形成不同的实施例。本领域的技术人员能够理解，对各个实施例的描述都各有侧重，某个实施例中没有详述的部分，可以参见其他实施例的相关描述。虽然结合附图描述了本申请的实施方式，但是本领域技术人员可以在不脱离本申请的精神和范围的情况下做出各种修改和变型，这样的修改和变型均落入由所附权利要求所限定的范围之内以上，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到各种等效的修改或替换，这些修改或替换都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以权利要求的保护范围为准。以上，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到各种等效的修改或替换，这些修改或替换都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以权利要求的保护范围为准。
