标题title
水锤冲击压力信号的自适应滤波降噪方法
摘要abst
本发明公开了一种水锤冲击压力信号的自适应滤波降噪方法，包括获取水锤冲击压力信号，对其进行信号两端的扩展，得到扩展后压力信号构成的时间序列为x，对x进行经验模式分解，将其转化为一系列水锤信号IMF分量，剔除IMF分量中的一部分高阶分量，将剩余低阶分量进行暴露，并对其扩展部分进行截取，得到截取分量，组合全部截取分量得到重构信号，评估重构信号的最大幅值损失、能量损失和R2系数，判断滤波后信号是否符合要求，通过评估后，将重构信号作为滤波后信号，否则重新剔除高阶分量，重新进行评估。本发明在滤波过程中，无需设定滑动步长、滤波器参数等，极大地减少了人为因素的影响，具有很强的泛化能力和通用性。
权利要求书clms
1.水锤冲击压力信号的自适应滤波降噪方法，其特征在于，包括以下步骤：步骤1，获取待监测水管的水锤冲击压力信号构成的时间序列为x；步骤2，对x进行经验模式分解，确定极大值序列xmax和极小值序列xmin，根据xmax和xmin确定x的上下包络及两组包络的平均值序列m＝/2，将m从x中去掉，得到第一个筛分序列h1＝x-m；步骤3，将自身所包含极值点与过零点的总个数相等或相差1的信号定义为IMF分量，若h1满足IMF分量定义则将其视为第一个IMF分量c1，否则令x＝h1，重复步骤2，直至新的h1满足IMF分量定义；步骤4，用信号分解后的余项r1代替x，r1＝x-c1，重复步骤2～3，依次得到第n个IMF分量cn，n＝；步骤5，选择第n个IMF分量cn作为新的信号，对新的信号进行评估，评估最大幅值损失是否低于5％，能量损失是否小于5％，R2系数是否大于0.95，若是，则IMF分量为滤波降噪后信号，否则，将cn和将cn-1重新合成作为滤波后信号，重复评估最大幅值损失、能量损失和R2系数；若依然不符合要求，则从cn开始，反向追溯cn、cn-1和cn-2，并将其合成作为滤波后信号，重新评估，不断增加IMF分量的个数，并循环这一过程，直至获得的满足条件的合成信号，作为滤波后信号。2.根据权利要求1所述的水锤冲击压力信号的自适应滤波降噪方法，其特征在于，所述步骤2中，对x进行经验模式分解，寻找x中局部极大值与极小值点，依次组成极大值序列xmax和极小值序列xmin，以xmax与xmin为对象，分别对二个序列进行三次样条插值计算，通过插值结果建立压力信号的上包络与下包络序列。3.根据权利要求2所述的水锤冲击压力信号的自适应滤波降噪方法，其特征在于，所述步骤3中，当一直分解也无法得到IMF分量时，设置标准偏差系数SD：其中，T是信号的总时间长度，ε为设置的阈值，ε＝0.25，hi为筛分序列，i＝；若hi满足公式，则认为hi满足IMF分量定义，将hi作为IMF分量。4.根据权利要求3所述的水锤冲击压力信号的自适应滤波降噪方法，其特征在于，所述步骤4中，IMF分量cn为一系列调频调幅信号组合，如下式：uk＝Akcos) 其中，φk为非递减函数，φ′k≥0，包络Ak≥0，可将每个uk看作一个简谐波，其幅值为Ak且瞬时频率为φ′k。5.根据权利要求4所述的水锤冲击压力信号的自适应滤波降噪方法，其特征在于，所述步骤5中最大幅值损失为Aloss：Aloss＝|A-a|/A×100％其中，A为原始信号最大冲击幅值，a为重构信号最大冲击幅值。6.根据权利要求5所述的水锤冲击压力信号的自适应滤波降噪方法，其特征在于，所述步骤5中能量损失为Eloss：Eloss＝|E-e|/E×100％ 其中，E为原始信号能量，e为重构信号能量。7.根据权利要求6所述的水锤冲击压力信号的自适应滤波降噪方法，其特征在于，所述步骤5中R2系数的计算过程如下：其中，表示合成后的压力信号值，xi表示原始压力信号值，表示原始压力信号值的平均值。8.根据权利要求1所述的水锤冲击压力信号的自适应滤波降噪方法，其特征在于，所述步骤1中获取的时间序列x是对待分析信号两端进行扩展后的信号序列，在步骤5对新的信号进行评估前，将扩展的信号序列对应的IMF分量截掉。
说明书desc
技术领域本发明属于长距离输水系统的监测及安全管理技术领域，涉及一种水锤冲击压力信号的自适应滤波降噪方法。背景技术由于我国地域辽阔且地势复杂，导致地区间水资源分布情况差异巨大，随着大型输水工程的分阶段实施，我国已建成大批长距离有压输水管道。在密闭管路系统内，由于流体流量急剧变化而引起较大的压力波动并造成振动的现象称之为水锤效应，其瞬间压力可大大超过正常压力，并经常产生破坏性影响，水锤效应严重影响着水利设施的安全和质量，为了掌握水锤发生机理并对其开展抑制预防工作，国内外学者从产生机理、信号特征、模式识别等多个领域对其开展了研究分析，相关研究对于水利系统的安全运行有着重要意义。水锤冲击是一种具有较高能量的瞬时冲击，具有典型的简谐波特性，其压力信号具有其自身特殊性：一方面，水锤信号主要由低频成分组成，其能量大部分集中于低频成分，高频信息主要以噪声为主，这些噪声多是由于管路、电流、电路等因素导致，这区别于机械振动等高频信号；同时，水锤冲击信号从形态上具有缓变特性，由于其能量在流体中分布呈现明显的集中特性，其主成分的周期性非常明显，这区别于其它类别的压力信号。在实际测量中，通常通过测量管路内部压力获取水锤信号，这类信号数据是支撑各类研究和监测预警应用的基础，有效地获取水锤压力信号具有重要意义。压力信号是一类特殊的低频信号，由于压力信号有效地表征了设备内部的受力状态，在各种水力机械和输水设施中应用广泛，是水轮机、输水管道、泵站等设施的基本监测信号类型。实际中由于环境干扰、传感器误差、测试电流干扰、输水设施振动等因素，会导致水锤冲击信号中耦合大量噪声，因而需要对其进行有效地降噪滤波，但是在通过各类滤波器对信号进行降噪处理过程中，往往存在如下问题：首先，由于不同工况的压力信号存在很大差异，滤波器的参数难以确定，例如滤波步长、阶数、滤波器类型等；同时，常见滤波方法在很大程度上会造成能量的损失，导致信号幅值和能量的下降，例如滑移平均滤波、五点三次滤波、Savitzky-Golay滤波等方法，在水锤冲击工况中，这种损失可能会导致严重的偏差，埋下一定的安全隐患；此外，由于输水工程管线复杂、工况类型繁多，不同工况下相关工程参数完全不同，仅凭经验性难免耗时费力。发明内容本发明的目的是提供一种水锤冲击压力信号的自适应滤波降噪方法，解决了现有水锤冲击压力信号滤波降噪方法误差较大、能量损失较大的问题。本发明所采用的技术方案是，水锤冲击压力信号的自适应滤波降噪方法，包括以下步骤：步骤1，获取待监测水管的水锤冲击压力信号构成的时间序列为 x；步骤2，对x进行经验模式分解，确定极大值序列xmax和极小值序列xmin，根据xmax和xmin确定x的上下包络及两组包络的平均值序列m＝/2，将m从x中去掉，得到第一个筛分序列h1＝x-m；步骤3，将自身所包含极值点与过零点的总个数相等或相差1的信号定义为IMF分量，若h1满足IMF分量定义则将其视为第一个IMF分量c1，否则令x＝h1，重复步骤2，直至新的 h1满足IMF分量定义；步骤4，用信号分解后的余项r1代替x，r1＝x -c1，重复步骤2～3，依次得到第n个IMF分量cn，n＝；步骤5，选择第n个IMF分量cn作为新的信号，对新的信号进行评估，与原始信号进行比较，评估最大幅值损失是否小于5％，能量损失是否小于5％，R2系数是否大于0.95，若符合上述要求，则该IMF分量为滤波降噪后信号，否则，将cn和将cn-1重新合成作为滤波后信号，重复评估最大幅值损失、能量损失和R2系数；若依然不符合要求，则从cn开始，反向追溯cn、cn-1和 cn-2，并将其合成作为滤波后信号，重新评估，不断增加IMF分量的个数，并循环这一过程，直至获得的满足条件的合成信号，作为滤波后信号。步骤2中，对x进行经验模式分解，寻找x中局部极大值与极小值点，依次组成极大值序列xmax和极小值序列xmin，以xmax与xmin为对象，分别对二个序列进行三次样条插值计算，通过插值结果建立压力信号的上包络与下包络序列。步骤3中，当一直分解也无法得到IMF分量时，设置标准偏差系数SD：其中，T是信号的总时间长度，ε为设置的阈值，ε＝0.25，hi 为筛分序列，i＝；若hi满足公式，则认为hi满足IMF分量定义，将 hi作为IMF分量。步骤4中，IMF分量cn为一系列调频调幅信号组合，如下式：uk＝Akcos) 其中，φk为非递减函数，φ'k≥0，包络Ak≥0，可将每个uk 看作一个简谐波，其幅值为Ak且瞬时频率为φ'k。步骤5中最大幅值损失为Aloss：Aloss＝|A-a|/A×100％ 其中，A为原始信号最大冲击幅值，a为重构信号最大冲击幅值。步骤5中能量损失为Eloss：Eloss＝|E-e|/E×100％其中，E为原始信号能量，e为重构信号能量。步骤5中R2系数的计算过程如下：其中，表示合成后的压力信号值，xi表示原始压力信号值，表示原始压力信号值的平均值。步骤1中获取的时间序列x是对待分析信号两端进行扩展后的信号序列，在步骤5对新的信号进行评估前，将扩展的信号序列对应的IMF分量截掉。本发明的有益效果是：在滤波过程中，无需设定滑动步长、滤波器参数等，不需要人工经验知识，极大地减少了人为因素的影响，使得方法具有很强的泛化能力和通用性；充分考虑到压力信号管内的压力信号的主要以低频成分为主，噪声成分以高频为主，因此在选取分量时应当反向选取分量，这一特点明确了目标信号和噪声信号的分布范围，增强了去噪的针对性，增加了对原始信号的保留；EMD分解方法能较好的保留原信号的非平稳、非线性的特征，以准确地反映了压力信号的原始特点，防止信号产生过多的能量损失；采用了多重评价指标作为设计方案，提出了结合最大冲击幅值、能量损失、R2系数多因素评价，从多个角度衡量了信号的降噪效果，提升了实际应用中的安全性和可靠性；通过信号扩展的方法抑制了经验模式分解中的端点效应和模态混叠，进一步提升了分析结果的可靠性。附图说明图1是本发明一种水锤冲击压力信号的自适应滤波降噪方法的流程示意图；图2是本发明中扩展信号方法的示意图；图3是本发明实施例中经过滤波后剔除掉的IMF分量频率示意图；图4是本发明实施例中评估后用于重构信号的IMF分量频率示意图；图5是本发明实施例中原始水锤冲击压力信号图；图6是本发明实施例中对原始水锤冲击压力信号进行滤波后的信号图。具体实施方式下面结合附图和具体实施方式对本发明进行详细说明。本发明一种水锤冲击压力信号的自适应滤波降噪方法，参照图1，包括以下步骤：步骤1，以一段水锤冲击压力信号为例，流量40.74m3/h进行关阀并产生的水锤冲击，关阀时间1.5秒左右，实验采用DN100管道，采样频率为2048Hz，水泵功率7.5KW，通过压力传感器获取该水管的水锤冲击信号，为了有效抑制并消除信号在经验模式分解过程中存在的端点效应，对其进行信号两端的扩展，参照图2，即采取镜像拖延方法，将信号前N个点以第一个点为基准，进行镜像复制，将信号最后N个点以最后一个点为基准，进行镜像复制，得到扩展后的压力信号，这些压力信号构成的时间序列为x；该方法不受限于采样频率的制约，除了可以应用于水锤冲击压力信号外，同样适用于其他测量压力信号的流体机械、输水设施等领域；步骤2，寻找x中局部极大值与极小值点，依次组成极大值序列xmax和极小值序列xmin，以xmax与xmin为对象，分别对二个序列进行三次样条插值计算，通过插值结果建立压力信号的上包络与下包络序列，计算出两组包络的平均值序列m＝/2，将m从x中去掉，得到第一个筛分序列h1＝x-m；步骤3，将自身所包含极值点与过零点的总个数相等或相差1的信号定义为IMF分量，若h1满足IMF分量定义则将其视为第一个IMF分量c1，否则令x＝h1，重复步骤2，直至新的 h1满足IMF分量定义；当一直分解也无法得到IMF分量时，设置标准偏差系数SD：其中，T是信号的总时间长度，ε为设置的阈值，ε＝0.25，hi 为筛分序列，i＝；若hi满足公式，则认为hi满足IMF分量定义，将 hi作为IMF分量。对于整个的分解过程如何停止也要有一定的判断依据，通常采用的判断标准有两类：当最后一个本征模态函数或是余项的幅值小于预设值的时候，整个分解过程就停止；当余项变成单调函数或常数时，从中不能再筛分出本征模态函数时停止。步骤4，用信号分解后的余项r1代替x，r1＝x -c1，重复步骤2～3，依次得到第n个IMF分量cn，n＝；通常前几阶分量以高频信息为主，最后得到的分量频率成分整体呈下降趋势，参照图3和图4，可见高阶分量仅能够反映了高频噪声成分，而这一部分的能量很小，低阶IMF分量包含了主要能量成分。IMF分量cn可视为一系列调频调幅信号组合，如下式：uk＝Akcos) 其中，φk为非递减函数，φ'k≥0，包络Ak≥0，可将每个uk 看作一个简谐波，其幅值为Ak且瞬时频率为φ'k。步骤5，将扩展信号序列对应的IMF分量截掉，以保障每一个IMF 分量的起始点位置都与原水锤压力信号起始点位置保持一致，选择第 n个IMF分量cn作为新的信号，对新的信号进行评估：评估最大幅值损失Aloss是否低于5％，若是，则认为合成信号去噪效果良好且最大幅值计算未失真：Aloss＝/A×100％其中，A为原始信号最大冲击幅值，a为重构信号最大冲击幅值。评估能量损失Eloss是否小于5％，压力信号为非周期的确定性信号，为能量信号，若Eloss小于5％，则认为合成信号去噪效果良好且能量损失可接受，：Eloss＝/E×100％ 其中，E为原始信号能量，e为重构信号能量。评估R2系数是否大于0.95，R2系数反映了合成后的压力信号与原始压力信号的相似性，通常认为越接近于1效果越好，评估R2的目的是为了避免滤波信号发生严重失真等现象，R2系数的计算过程如下：其中，表示合成后的压力信号值，xi表示原始压力信号值，表示原始压力信号值的平均值。若新的信号符合以上三个条件，则完成压力信号的滤波降噪， IMF分量为滤波降噪后信号，得到的滤波降噪信号可用于相关监测预警、科学研究等。否则，将cn和将cn-1重新合成作为滤波后信号，重复评估最大幅值损失、能量损失和R2系数，从cn开始，反向追溯；若依然不符合要求，则从cn开始，反向追溯cn、 cn-1和cn-2，并将其合成作为滤波后信号，重新评估，不断增加IMF分量的个数并循环这一过程，直至获得的满足条件的合成信号，作为滤波后信号。不断增加IMF分量的个数，将满足全部条件的重新合成信号作为滤波信号结果。新的信号仅包含低频成分，对于水锤冲击而言，高频成分往往由噪声造成，因此重构信号就实现了滤波降噪；通常，将先获取的IMF 分量称为高阶分量，其中包含的信息成分以高频信息为主，即分量频率较高，获取顺序靠后的IMF分量中往往包含频率较低的成分；例如相对于水锤压力信号而言，在高速运转的机械振动信号中，前几阶分量通常包含了主要的能量和信息成分，相应的低阶分量则是以噪声信息为主，且低阶分量的能量较小；在水锤压力信号分析中，发现其主要能量集中在低频区域，其高频成分能量反而极低，因此在选取 IMF分量中，从最后一个IMF分量ck开始，反向追溯ck和将ck-1等；选取IMF分量合成时，也可以根据IMF图像的频率大致得出噪声部分和信号部分，以此确定初次用于合成信号的IMF 分量，后来对合成信号的IMF分量重新选择时，在此基础上逐量加减，找到满足多重评价指标的合成信号。经过反复评估，最终去除掉IMF1-IMF5，选取IMF6至IMF14 进行组合，得到滤波后信号，如图5和图6所示，计算结果中能量损失为3.437％，幅值损失为0.447％，小于5％，R2系数为0.9899，大于0.95；表明采用本发明方法能够很好地去除压力信号噪声，且信号能量幅值损失极小，形态相似度极高，达到了预期效果。
