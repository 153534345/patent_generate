标题title
一种LIBS定量分析方法、系统及电子设备
摘要abst
本发明公开了一种LIBS定量分析方法、系统及电子设备，其中分析方法包括步骤：利用LIBS获取多个样品的光谱数据；提取所述光谱数据的特征峰，得到所述光谱数据中各元素的特征峰集合；以样品中除待测元素以外的元素作为校正元素，将所述校正元素在不同波段的特征峰进行排列组合，并结合Lomakin‑Scherbe公式，建立待测元素与校正元素关联的多个回归方程；根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程，作为定量分析函数。本发明利用多元素谱线校正待测元素谱线的多元非线性模型，以提高定量分析的稳定性与准确性。
权利要求书clms
1.一种LIBS定量分析方法，其特征在于，包括以下步骤：利用LIBS获取多个样品的光谱数据；提取所述光谱数据的特征峰，得到所述光谱数据中各元素的特征峰集合；以样品中除待测元素以外的元素作为校正元素，将所述校正元素在不同波段的特征峰进行排列组合，并结合Lomakin-Scherbe公式，建立待测元素与校正元素关联的多个回归方程；根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程，作为定量分析函数。2.如权利要求1所述的LIBS定量分析方法，其特征在于，在所述的获取多个样品的光谱数据步骤之后，还包括以下步骤：对所述光谱数据进行扣除背底预处理。3.如权利要求1所述的LIBS定量分析方法，其特征在于，在所述的提取所述光谱数据的特征峰，得到所述光谱数据中各元素的特征峰集合步骤中，包括：利用寻峰算法提取所述光谱数据的所有特征峰；利用洛伦兹函数对所述特征峰进行拟合；提取特征峰拟合面积和特征峰中心波长；将所述特征峰拟合面积、所述特征峰中心波长与光谱数据库进行比对，确定特征峰对应的元素，得到所述光谱数据中各元素的特征峰集合。4.如权利要求1至3任一项所述的LIBS定量分析方法，其特征在于，在所述的建立待测元素与校正元素关联的回归方程的步骤中，包括：根据Lomakin-Scherbe公式忽略自吸收影响后，采用多元素谱线进行校正，得到以下公式：，式中，n为组成样品的元素数量，I为元素的光谱强度，a为Lomakin-Scherbe系数，C为元素占比，且；设定待测元素的占比为C1，则：，近似得到：，式中，Cj代表编号为j的元素占比，j是元素标号，Ii代表编号为i的元素光谱强度，k为元素的回归方程系数,kS为元素的回归方程拟合系数，IS代表编号为s的元素的光谱强度，s，i是编号，用于区分元素种类的。5.如权利要求1所述的LIBS定量分析方法，其特征在于，所述方法还包括以下步骤：将多个样品的光谱数据的特征峰集合划分成训练集、测试集和验证集。6.如权利要求5所述的LIBS定量分析方法，其特征在于，在所述的根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程的步骤中，包括：利用训练集的光谱数据对所述回归方程进行拟合；利用测试集的光谱数据筛选出最优组合的回归方程。7.如权利要求5所述的LIBS定量分析方法，其特征在于，所述方法还包括以下步骤：利用验证集的光谱数据对筛选出的最优组合的回归方程进行验证。8.一种LIBS定量分析系统，其特征在于，包括：数据获取模块：用于获取多个样品的光谱数据；特征峰提取模块：用于提取所述数据获取模块中光谱数据的特征峰，得到光谱数据中各元素的特征峰集合；定量分析函数确定模块：用于以样品中除待测元素以外的元素作为校正元素，将所述校正元素在不同波段的特征峰进行排列组合，并结合Lomakin-Scherbe公式，建立待测元素与校正元素关联的多个回归方程；还用于根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程作为定量分析函数。9.如权利要求8所述的LIBS定量分析系统，其特征在于，还包括：预处理模块，所述预处理模块用于对所述光谱数据进行扣除背底预处理。10.如权利要求8所述的LIBS定量分析系统，其特征在于，所述特征峰提取模块具体用于：利用寻峰算法提取所述光谱数据的所有特征峰；利用洛伦兹函数对所述特征峰进行拟合；提取特征峰拟合面积和特征峰中心波长；将所述特征峰拟合面积、所述特征峰中心波长与光谱数据库进行比对，确定特征峰对应的元素，得到所述光谱数据中各元素的特征峰集合。11.如权利要求8所述的LIBS定量分析系统，其特征在于，所述定量分析函数确定模块在建立待测元素与校正元素关联的回归方程时，具体为：根据Lomakin-Scherbe公式忽略自吸收影响后，采用多元素谱线进行校正，得到以下公式：，式中，n为组成样品的元素数量，I为元素的光谱强度，a为Lomakin-Scherbe系数，C为元素占比，且；设定待测元素的占比为C1，则：，近似得到：，式中，Cj代表编号为j的元素占比，j是元素标号，Ii代表编号为i的元素光谱强度，k为元素的回归方程系数,kS为元素的回归方程拟合系数，IS代表编号为s的元素的光谱强度，s，i是编号，用于区分元素种类的。12.一种电子设备，其特征在于，包括：存储器，存储有计算机可执行指令；处理器，配置为运行所述计算机可执行指令；其中，所述计算机可执行指令被所述处理器运行时实现权利要求1-7任一项所述的LIBS定量分析方法。
说明书desc
技术领域本发明属于光谱分析领域，特别涉及一种LIBS定量分析方法、系统及电子设备。背景技术激光诱导击穿光谱技术是采用一定功率密度的激光束通过各种透镜后聚焦到样品表面，样品表面就会蒸发、气化、电离，最终形成等离子体，并利用光谱仪收集等离子体的发射光谱，通过分析所采集的光谱数据进行定量和定性分析，由于LIBS几乎无须样品制备，可快速有效的直接原位分析样品，且可同时分析所有元素，并且可以分析各种基态样品被著名化学家James D. Winefordner喻为“未来检测之星”。在利用激光诱导击穿光谱技术定量分析的时候，受能量稳定性，基体体效应以及自吸收等因素干扰，导致LIBS的光谱稳定性较差，单纯通过一条谱线建立的回归方程其稳定性以及准确性都较差。发明内容针对上述问题，本发明采用的技术方案是：一种LIBS定量分析方法，包括以下步骤：利用LIBS获取多个样品的光谱数据；提取所述光谱数据的特征峰，得到所述光谱数据中各元素的特征峰集合；以样品中除待测元素以外的元素作为校正元素，将所述校正元素在不同波段的特征峰进行排列组合，并结合Lomakin-Scherbe公式，建立待测元素与校正元素关联的多个回归方程；根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程，作为定量分析函数。可选地，在所述的获取多个样品的光谱数据步骤之后，还包括以下步骤：对所述光谱数据进行扣除背底预处理。可选地，在所述的提取所述光谱数据的特征峰，得到所述光谱数据中各元素的特征峰集合步骤中，包括：利用寻峰算法提取所述光谱数据的所有特征峰；利用洛伦兹函数对所述特征峰进行拟合；提取特征峰拟合面积和特征峰中心波长；将所述特征峰拟合面积、所述特征峰中心波长与光谱数据库进行比对，确定特征峰对应的元素，得到所述光谱数据中各元素的特征峰集合。可选地，在所述的建立待测元素与校正元素关联的回归方程的步骤中，包括：根据Lomakin-Scherbe公式忽略自吸收影响后，采用多元素谱线进行校正，得到以下公式：，式中，n为组成样品的元素数量，I为元素的光谱强度，a为Lomakin-Scherbe系数，C为元素占比，且；设定待测元素的占比为C1，则：，近似得到：，式中，Cj代表编号为j的元素占比，j是元素标号，Ii代表编号为i的元素光谱强度，k为元素的回归方程系数,kS为元素的回归方程拟合系数，IS代表编号为s的元素的光谱强度，s，i是编号，用于区分元素种类的。可选地，所述方法还包括以下步骤：将多个样品的光谱数据的特征峰集合划分成训练集、测试集和验证集。可选地，在所述的根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程的步骤中，包括：利用训练集的光谱数据对所述回归方程进行拟合；利用测试集的光谱数据筛选出最优组合的回归方程。可选地，所述方法还包括以下步骤：利用验证集的光谱数据对筛选出的最优组合的回归方程进行验证。以及，一种LIBS定量分析系统，包括：数据获取模块：用于获取多个样品的光谱数据；特征峰提取模块：用于提取所述数据获取模块中光谱数据的特征峰，得到光谱数据中各元素的特征峰集合；定量分析函数确定模块：用于以样品中除待测元素以外的元素作为校正元素，将所述校正元素在不同波段的特征峰进行排列组合，并结合Lomakin-Scherbe公式，建立待测元素与校正元素关联的多个回归方程；还用于根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程作为定量分析函数。可选地，分析系统还包括：预处理模块，所述预处理模块用于对所述光谱数据进行扣除背底预处理。可选地，所述特征峰提取模块具体用于：利用寻峰算法提取所述光谱数据的所有特征峰；利用洛伦兹函数对所述特征峰进行拟合；提取特征峰拟合面积和特征峰中心波长；将所述特征峰拟合面积、所述特征峰中心波长与光谱数据库进行比对，确定特征峰对应的元素，得到所述光谱数据中各元素的特征峰集合。可选地，所述定量分析函数确定模块在建立待测元素与校正元素关联的回归方程时，具体为：根据Lomakin-Scherbe公式忽略自吸收影响后，采用多元素谱线进行校正，得到以下公式：，式中，n为组成样品的元素数量，I为元素的光谱强度，a为Lomakin-Scherbe系数，C为元素占比，且；设定待测元素的占比为C1，则：，近似得到：，式中，Cj代表编号为j的元素占比，j是元素标号，Ii代表编号为i的元素光谱强度，k为元素的回归方程系数,kS为元素的回归方程拟合系数，IS代表编号为s的元素的光谱强度，s，i是编号，用于区分元素种类的。以及，一种电子设备，包括：存储器，存储有计算机可执行指令；处理器，配置为运行所述计算机可执行指令；其中，所述计算机可执行指令被所述处理器运行时实现上述的LIBS定量分析方法。本发明由于采用上述技术方案，使其具有以下有益效果：利用多元素谱线校正待测元素谱线的多元非线性模型，以提高定量分析的稳定性与准确性。本发明的其它特征和优点将在随后的说明书中阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点可通过在说明书、权利要求书以及附图中所指出的结构来实现和获得。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1示出了根据现有内标法验证集验证最优模型的泛化能力结果示意图；图2示出了根据本发明实施例验证集验证最优模型的泛化能力结果示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地说明，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明实施例的LIBS定量分析方法，包括以下步骤：S1、利用LIBS设备获取多个样品的光谱数据，并将多个样品的光谱数据的特征峰集合划分成训练集、测试集和验证集；例如，选用135个铜炉渣样品，并将135个样品中的81个样品做为训练集，27个样品做为测试集，剩余的27个样品做为验证集，当前光谱数据的维度为M维。S2、对光谱数据进行预处理；在本实施例中，预处理包括对所述光谱数据进行扣除背底处理和剔除异常数据处理。其中，扣除背底处理为背景光扣除处理，由于光谱仪采集到的光谱是元素的光谱以及连续背景信号的叠加，需要扣除其中的连续背景信号，以得到元素的净光谱。连续背景信号并不是噪声，而是由于激光诱导等离子体中的黑体辐射、韧致辐射和复合辐射特性所导致的一种强度相对稳定的背景干扰，因此可通过数学方法进行处理，常用的方法为分段拟合法、小波变换法等。S3、提取所述光谱数据的特征峰，得到所述光谱数据中各元素的特征峰集合；具体如下：利用寻峰算法提取所述光谱数据的所有特征峰；利用洛伦兹函数对所述特征峰进行拟合；提取特征峰拟合面积和特征峰中心波长，将光谱数据的维度从M降维N维；将所述特征峰拟合面积、所述特征峰中心波长与光谱数据库进行比对，确定特征峰对应的元素，得到所述光谱数据中各元素的特征峰集合。S4、以样品中除待测元素以外的元素作为校正元素，将所述校正元素在不同波段的特征峰进行排列组合，并结合Lomakin-Scherbe公式，建立待测元素与校正元素关联的多个回归方程；具体如下：根据Lomakin-Scherbe公式忽略自吸收影响后，由于采用内标法在实际应用过程中可能不存在浓度变化较小的内标元素，因此采用多元素谱线进行校正，得到以下公式：，式中，n为组成样品的元素数量，I为元素的光谱强度，a为Lomakin-Scherbe系数，C为元素占比，且；设定待测元素的占比为C1，则：，近似可得：，式中，Cj代表编号为j的元素占比，j是元素标号，Ii代表编号为i的元素光谱强度，k为元素的回归方程系数,kS为元素的回归方程拟合系数，IS代表编号为s的元素的光谱强度，s，i是编号，用于区分元素种类的。S5、根据所述光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程，作为定量分析函数；具体如下：利用训练集对所述回归方程进行拟合，计算出各元素的回归方程拟合系数k；利用测试集筛选出最优组合的回归方程。其中，较佳的，还可结合评价系数R2进行筛选。S6：利用验证集对筛选出的最优组合的回归方程进行验证，即对最后得到的定量分析函数进行验证。本发明实施例还提供一种LIBS定量分析系统，包括：数据获取模块：用于获取多个样品的光谱数据。预处理模块，用于对所述光谱数据进行扣除背底处理和剔除异常数据处理。特征峰提取模块：用于提取所述数据获取模块中光谱数据的特征峰，得到光谱数据中各元素的特征峰集合；其中，特征峰提取模块在得到特征峰集合时，具体为：先利用寻峰算法提取所述光谱数据的所有特征峰，再利用洛伦兹函数对所述特征峰进行拟合，提取特征峰拟合面积和特征峰中心波长，最后将所述特征峰拟合面积、所述特征峰中心波长与光谱数据库进行比对，确定特征峰对应的元素，得到所述光谱数据中各元素的特征峰集合。定量分析函数确定模块：用于以样品中除待测元素以外的元素作为校正元素，将所述校正元素在不同波段的特征峰进行排列组合，并结合Lomakin-Scherbe公式，建立待测元素与校正元素关联的多个回归方程，根据光谱数据对所述回归方程进行拟合，并筛选出最优组合的回归方程作为定量分析函数。定量分析函数确定模块在得到定量分析函数时，具体实现步骤与上述本发明实施例的LIBS定量分析方法的步骤S4对应，因此不做赘述。在获取定量分析函数后，便可利用该函数对待测品的元素进行预测计算。通过本实施例计算得出的定量分析函数和现有技术内标法对待测元素进行预测时，如图1所示根据现有内标法验证集验证最优模型的泛化能力结果示意图，以及图2所示的根据本发明实施例验证集验证最优模型的泛化能力结果示意图。此外，通过评价系数对本发明实施例和现有技术内标法的评价系数结果如下表1所示：表1方法MAER2内标法0.0770.49多元素校正法0.0540.77 其中，平均绝对误差MAE用于衡量预测值与真实值之间的平均绝对误差，MAE越小表示模型越好；决定系数R2反映因变量的全部变异能通过回归关系被自变量解释的比例，R2越大表示模型越好；其定义如下：，；式中，i代表样本编号，m代表样本个数，yi代表第i个样本的标签值，fi代表第i个样本的预测值，代表n个样本标签值的均值。可见，通过多元素谱线校正待测元素，相对传统定标方法，提升了结果的稳定性以及准确性。本发明实施例还提供一种电子设备，包括：存储器，存储有计算机可执行指令；处理器，配置为运行所述计算机可执行指令。其中，所述计算机可执行指令被所述处理器运行时实现上述的LIBS定量分析方法。以上所述仅是本发明的较佳实施例而已，并非对本发明做任何形式上的限制，虽然本发明已以较佳实施例揭露如上，然而并非用以限定本发明，任何熟悉本专业的技术人员，在不脱离本发明技术方案的范围内，当可利用上述揭示的技术内容作出些许更动或修饰为等同变化的等效实施例，但凡是未脱离本发明技术方案的内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化与修饰，均仍属于本发明技术方案的范围内。
