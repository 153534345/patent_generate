标题title
面向低渗透率网联车轨迹数据的排队服务时间估计方法
摘要abst
本发明公开了面向低渗透率网联车轨迹数据的排队服务时间估计方法，该方法首先，根据车速信息判别车辆在路口的排队停车状态，识别标记排队停车车辆。然后，通过对车辆到达、驶离周期的一致性判别，识别标记过饱和车辆。接着，针对欠饱和、过饱和两种情况，将车辆停车状态进行转换，以此为输入构建基于Logistic回归的车辆排队服务时间概率模型。最后，采用拉普拉斯近似方法，基于贝叶斯先验‑后验滚动实现排队服务时间的动态估计。本发明适用于低渗透率数据环境，在网联车车辆轨迹样本有限的条件下，可以实现欠饱和、过饱和场景下的排队服务时间估计，能为基于网联车数据的信号控制优化提供支撑。
权利要求书clms
1.面向低渗透率网联车轨迹数据的排队服务时间估计方法，其特征在于，包括如下步骤：步骤1，获取交叉口的信号配时方案以及经过交叉口的网联车车辆轨迹数据；步骤2，从网联车车辆轨迹数据中提取车辆的速度信息，根据车辆的速度信息判断车辆通过交叉口时是否经过排队停车，即车辆是否存在停车等红灯状态，若车辆存在停车等红灯状态，则标记为停车车辆，否则不标记，从而得到车辆排队停车状态信息；步骤3，定义车辆到达周期和车辆驶离周期，确定车辆到达周期和驶离周期；步骤4，根据车辆到达周期将每辆车归入相应的周期；对于每个周期，若该周期中所有车辆的到达周期和驶离周期都相同，则该周期为欠饱和周期；若该周期中存在车辆到达周期和驶离周期不同，则判定到达周期和驶离周期不同的车辆为过饱和车辆，过饱和车辆所在的周期为过饱和周期；步骤5，建立基于Logistic回归的车辆排队服务时间概率模型，将车辆排队停车状态信息进行转换作为模型的输入，排队服务时间表现为对停车概率进行积分；步骤6，考虑相邻周期之间交通流运行状态的关联性，基于贝叶斯先验-后验滚动实现排队服务时间的动态估计，将相邻两周期中的前一周期得到的后验估计信息作为后一周期的先验估计信息，利用贝叶斯Logistic回归中的拉普拉斯近似方法实现先验-后验信息动态滚动，得到模型参数的分布，从而得到排队服务时间的分布，取其均值完成周期级排队服务时间的动态估计。2.根据权利要求1所述的面向低渗透率网联车轨迹数据的排队服务时间估计方法，其特征在于，所述步骤2中，设定车辆的速度小于3m/s时为低速行驶状态，判断车辆的速度是否出现小于3m/s的情况，当车辆的速度小于3m/s时，判断车辆是否连续5s以上处于低速行驶状态，若车辆连续5s以上处于低速行驶状态，则标记其为停车车辆。3.根据权利要求1所述的面向低渗透率网联车轨迹数据的排队服务时间估计方法，其特征在于，所述步骤3中，车辆到达周期定义为车辆在不受到信号控制和前车影响时的理想状态下，以自由流速度行驶驶离停止线的时间对应的周期；车辆驶离周期定义为车辆实际的停止线驶离时间对应的周期；1)根据车辆实际驶离停止线的时间确定车辆驶离周期，选取车辆轨迹数据中停止线前后最近的两个轨迹点，利用线性插值法确定车辆实际驶离停止线的时间：其中，lb、la分别表示车辆前进方向上停止线前、后两个连续轨迹点的位置，tb、ta分别表示车辆经过停止线前、后两个连续轨迹点的时间，lsb表示停止线的位置；通过匹配车辆实际驶离停止线时间与信号配时，从而得到车辆驶离周期；2)根据车辆轨迹数据，获取车辆瞬时速度，建立三元高斯混合模型，并利用最大期望算法对三元高斯混合模型的参数进行求解，基于求解的参数，将车辆瞬时速度作为三元高斯混合模型的输入，对车辆行驶状态进行划分，估计车辆运行的自由流速度，结合车辆轨迹数据确定车辆到达周期；车辆行驶状态分为排队停车及启动状态、减速状态和自由行驶状态，三种状态对应三个高斯分布，当瞬时速度x属于xk类的后验概率P＞0.6时，认为x属于xk类分布，k＝1,2,3。4.根据权利要求1所述的面向低渗透率网联车轨迹数据的排队服务时间估计方法，其特征在于，所述步骤5中，针对欠饱和周期和过饱和周期内的车辆，将车辆排队停车状态信息进行转换，具体为：在模型中分别用0和1表示停车车辆和未标记车辆，同时，分别用0和0表示过饱和周期的下一周期中的停车车辆和未标记车辆；根据Sigmoid函数公式，在t时刻车辆的停车概率p为：其中，α、β是Sigmoid函数的参数；对于欠饱和周期，该周期的排队服务时间QST为：其中，G为欠饱和周期的绿灯时间；对于过饱和周期，存在e周期到达、e+N周期离开的车辆，N为正整数，则e周期的排队服务时间为：其中，Gi为i周期的绿灯时间，表示从e周期到e+N-1周期的所有绿灯时间。
说明书desc
技术领域本发明涉及面向低渗透率网联车轨迹数据的排队服务时间估计方法，属于排队状态估计技术领域。背景技术城市交通系统低效运行区域主要集中在城市道路交叉口，因此对交叉口交通运行状态的研究显得尤为重要。排队状态动态信息作为交叉口运行状态的评价指标和信号控制优化的反馈信息，对于信号优化配时、协调控制都有着重要作用。对于排队状态的研究，传统方法多利用固定检测器数据如线圈检测器数据，然而固定检测器的高昂安装、维修费用使其覆盖率很低，难以有效支撑路网层级的交通管控应用。为了克服数据空间覆盖率的不足，国内外学者开始尝试利用浮动车数据、手机信令数据、卫星图像数据、无人机拍摄数据来进行研究。近年来由于无人驾驶技术和车路协同的发展，越来越多的车辆如网约车、网联车能够提供行车轨迹记录，基于网联车轨迹数据的排队状态估计问题成为当前研究的热点。目前对排队状态的研究多从车辆聚集的角度出发，将排队长度或排队车辆数作为估计对象，基于交通流理论或概率统计学进行估计。基于交通流理论的估计方法将排队长度估计作为一个确定性的过程，按照建模思路可以进一步分为基于冲击波理论方法和基于输入-输出方法。基于概率统计学的方法通常根据车辆的到达分布和周期内收集到的车辆轨迹数据，求得到达分布的参数，从而得到排队长度的概率分布，以其期望值作为排队长度的估计值。这些研究取得了一定的成果，但是所使用的方法大多存在对车辆到达模式的假设，如基于冲击波理论的排队长度估计方法为实现交通波拟合，两个冲击波之间的交点对估计值误差很敏感，排队长度估计在周期数据缺失的情况下较难实现。此外，该方法将排队形成波与消散波的交点至停车线的距离作为排队长度，存在较大误差，尤其是在到达模式不均匀以及低饱和度场景下。基于输入-输出的排队长度估计方法要求上下游同时布置检测器，且估计精度对检测器的测量误差高度敏感。基于概率统计学的排队长度估计方法未考虑车辆到达模式的不确定性，多采用线性或分段线性假设，没有考虑车队在上游受到干扰而产生的到达波动性。此外，该方法假设了一个给定的恒定渗透率，如果渗透率随时间显著变化，或难以准确估计，则排队长度估计结果也可能不准确。现有方法大多存在对车辆到达模式的假设，这种假设可能与实际交通流运行情况不符，估计准确性易受到车辆到达随机波动的影响，且方法的精准性和适用性会有所降低。另一方面受限于目前可观测车辆样本不足，多数方法在低渗透率下性能不佳。虽然智能网联技术正在迅猛发展，但是未来近十年内，网联车的普及率都会较低。网联车和传统车混行的状态是必经阶段，网联车的渗透率将会长期维持在一个较低的水平，而低渗透率数据环境会限制现有研究方法的估计效果。部分排队长度估计方法根据模型特性，结合发展迅速的车辆轨迹数据进行研究。这些方法需要的车辆轨迹数据的渗透率普遍较高，在低渗透率数据环境下方法性能不佳。为解决低渗透率数据环境下车辆轨迹信息不足的问题，一些方法采用历史数据或者对多个周期数据进行汇集，虽然能够提高估计精度，但无法保证实时性。还有一些方法在进行排队状态研究时需要保证车流中可观测车辆渗透率的稳定性，在车辆到达波动性较大时方法受限。发明内容本发明所要解决的技术问题是：提供面向低渗透率网联车轨迹数据的排队服务时间估计方法，从车辆消散的角度，提出以排队服务时间为表征的路口排队状态，避免了对车流到达模式的假设，并给出低渗透率条件下的估计方法。本发明为解决上述技术问题采用以下技术方案：面向低渗透率网联车轨迹数据的排队服务时间估计方法，包括如下步骤：步骤1，获取交叉口的信号配时方案以及经过交叉口的网联车车辆轨迹数据；步骤2，从网联车车辆轨迹数据中提取车辆的速度信息，根据车辆的速度信息判断车辆通过交叉口时是否经过排队停车，即车辆是否存在停车等红灯状态，若车辆存在停车等红灯状态，则标记为停车车辆，否则不标记，从而得到车辆排队停车状态信息；步骤3，定义车辆到达周期和车辆驶离周期，确定车辆到达周期和驶离周期；步骤4，根据车辆到达周期将每辆车归入相应的周期；对于每个周期，若该周期中所有车辆的到达周期和驶离周期都相同，则该周期为欠饱和周期；若该周期中存在车辆到达周期和驶离周期不同，则判定到达周期和驶离周期不同的车辆为过饱和车辆，过饱和车辆所在的周期为过饱和周期；步骤5，建立基于Logistic回归的车辆排队服务时间概率模型，将车辆排队停车状态信息进行转换作为模型的输入，排队服务时间表现为对停车概率进行积分；步骤6，考虑相邻周期之间交通流运行状态的关联性，基于贝叶斯先验-后验滚动实现排队服务时间的动态估计，将相邻两周期中的前一周期得到的后验估计信息作为后一周期的先验估计信息，利用贝叶斯Logistic回归中的拉普拉斯近似方法实现先验-后验信息动态滚动，得到模型参数的分布，从而得到排队服务时间的分布，取其均值完成周期级排队服务时间的动态估计。作为本发明的一种优选方案，所述步骤2中，设定车辆的速度小于3m/s时为低速行驶状态，判断车辆的速度是否出现小于3m/s的情况，当车辆的速度小于3m/s时，判断车辆是否连续5s以上处于低速行驶状态，若车辆连续5s以上处于低速行驶状态，则标记其为停车车辆。作为本发明的一种优选方案，所述步骤3中，车辆到达周期定义为车辆在不受到信号控制和前车影响时的理想状态下，以自由流速度行驶驶离停止线的时间对应的周期；车辆驶离周期定义为车辆实际的停止线驶离时间对应的周期；1)根据车辆实际驶离停止线的时间确定车辆驶离周期，选取车辆轨迹数据中停止线前后最近的两个轨迹点，利用线性插值法确定车辆实际驶离停止线的时间：其中，lb、la分别表示车辆前进方向上停止线前、后两个连续轨迹点的位置，tb、ta分别表示车辆经过停止线前、后两个连续轨迹点的时间，lsb表示停止线的位置；通过匹配车辆实际驶离停止线时间与信号配时，从而得到车辆驶离周期；2)根据车辆轨迹数据，获取车辆瞬时速度，建立三元高斯混合模型，并利用最大期望算法对三元高斯混合模型的参数进行求解，基于求解的参数，将车辆瞬时速度作为三元高斯混合模型的输入，对车辆行驶状态进行划分，估计车辆运行的自由流速度，结合车辆轨迹数据确定车辆到达周期；车辆行驶状态分为排队停车及启动状态、减速状态和自由行驶状态，三种状态对应三个高斯分布，当瞬时速度x属于xk类的后验概率P＞0.6时，认为x属于xk类分布，k＝1,2,3。作为本发明的一种优选方案，所述步骤5中，针对欠饱和周期和过饱和周期内的车辆，将车辆排队停车状态信息进行转换，具体为：在模型中分别用0和1表示停车车辆和未标记车辆，同时，分别用0和0表示过饱和周期的下一周期中的停车车辆和未标记车辆；根据Sigmoid函数公式，在t时刻车辆的停车概率p为：其中，α、β是Sigmoid函数的参数；对于欠饱和周期，该周期的排队服务时间QST为：其中，G为欠饱和周期的绿灯时间；对于过饱和周期，存在e周期到达、e+N周期离开的车辆，N为正整数，则e周期的排队服务时间为：其中，Gi为i周期的绿灯时间，表示从e周期到e+N-1周期的所有绿灯时间。本发明采用以上技术方案与现有技术相比，具有以下技术效果：1、本发明考虑车辆排队消散过程，选择排队服务时间作为排队状态表征指标，避免了对车辆到达模式的假设，克服了到达模型假设带来的不足和限制，更符合实际情况，方法普适性更好。2、本发明考虑交叉口排队状态在连续周期上的关联性，采用拉普拉斯近似方法，构建了一种基于贝叶斯的排队服务时间动态估计方法，实现了周期级的排队服务时间动态估计。3、本发明提出的基于贝叶斯Logistic方法的周期级排队服务时间动态估计方法，适用于当前网联车低渗透率的现实环境，也适用于欠饱和、过饱和两种场景，并且估计精度良好。附图说明图1是本发明面向低渗透率网联车轨迹数据的排队服务时间估计方法的流程图；图2是高斯分布拟合后的对数速度分布图；图3是贝叶斯Logistic回归方法在不同渗透率数据环境下的估计结果；其中，是6％渗透率，是10％渗透率，是20％渗透率，是30％渗透率。具体实施方式下面详细描述本发明的实施方式，所述实施方式的示例在附图中示出。下面通过参考附图描述的实施方式是示例性的，仅用于解释本发明，而不能解释为对本发明的限制。术语解释：网联车，融合V2X通信技术，通过车载传感系统和信息终端可实现与人、车、路、云端等的智能信息交换共享。低渗透率车辆轨迹数据，低渗透率是指渗透率低于30％，车辆轨迹数据是指车辆编号、轨迹点时间、车辆位置、车辆速度等信息。排队服务时间，是指绿灯时间内用于消散排队车辆的时间，定义为某周期的绿灯启亮时刻至该周期到达的最后一辆停车车辆驶离停止线时刻之间的绿灯时间。车辆到达周期，定义为车辆在不受到信号控制和前车影响时的理想状态下，以自由流速度行驶驶离停止线的周期。车辆驶离周期，定义为车辆实际的停止线驶离时间对应的周期。Logistic模型，用于对某一类别或事件存在的概率进行建模，也可以扩展到对几类事件进行建模。如图1所示，本发明从车辆消散的角度，提出以排队服务时间为表征的路口排队状态，避免了对车流到达模式的假设，并给出低渗透率条件下的估计方法，具体步骤如下：S1：获取路口网联车车辆轨迹数据以及信号配时方案等辅助信息。S2：提取车辆排队停车状态信息。通过车速信息判别车辆通过交叉口是否经过排队停车，本发明规定车辆车速小于3m/s为低速行驶状态，当车辆连续5s以上处于低速行驶状态时将其标记为停车车辆。S3：对车辆到达、驶离周期进行一致性判别，识别过饱和车辆。根据到达周期将每辆车归入某个周期。对于某一周期而言，若所有车辆的到达、驶离周期都相同，则该周期为欠饱和周期；若存在车辆到达、驶离周期不同，则判定车辆为过饱和车辆、周期为过饱和周期。S31：根据车辆驶离停止线时间确定驶离周期。选取车辆轨迹数据中停止线前后最近的两个轨迹点，利用线性插值法确定车辆驶离停止线的时间tp：其中，lb、la表示停止线前后两个连续轨迹点的位置，tb、ta表示这两个轨迹点的时间，lsb表示停止线的位置。通过匹配车辆驶离停止线时间与信号配时，可以得到驶离周期。S32：提取自由流速度，结合轨迹数据确定到达周期。以历史轨迹数据中车辆瞬时速度作为输入信息，建立高斯混合模型对车辆行驶状态进行划分，估计车辆运行的自由流速度，结合车辆轨迹数据确定车辆到达周期。该步骤的具体过程如下：假设车辆行驶状态主要分为排队停车及启动状态、减速状态、自由行驶状态，并且三种状态对应三个高斯分布，根据高斯分布的均值从小到大，依次对应排队停车及启动状态、减速状态、自由行驶状态。当数据xi属于xk类的后验概率P＞0.6时，认为xi属于该类分布。多元高斯混合可表示为：其中，X为样本集合，αk为第k个高斯分布的混合权重且为第k个高斯分布的概率密度函数。通过最大期望算法，分两步计算后验概率和最大似然估计得到新的参数，迭代计算直至似然收敛。S4：针对欠饱和、过饱和两种情况，将车辆排队停车状态信息进行转换作为模型的输入数据。对于过饱和周期，需要将下一周期车辆的停车状态均改为0。S5：建立基于Logistic回归的车辆排队服务时间概率模型，排队服务时间表现为对停车概率进行积分。根据Sigmoid函数公式，假设在t时刻车辆的停车概率为：其中，α、β是Sigmoid函数的参数，与Sigmoid函数曲线的陡峭程度和平移量有关。对于欠饱和周期，该周期的排队服务时间为：其中，G为该周期的绿灯时间。在过饱和情况下，对于e周期到达、e+N周期离开的车辆，e周期的排队服务时间估计值要到e+N周期才能获得，在这种情况下，e到e+N周期所有可观测车辆信息都可以作为e周期排队服务时间的估计信息，e周期排队服务时间为：其中，Gi为i周期的绿灯时间，等式右边的后半部分表示从e周期到e+N-1周期的所有绿灯时间。S6：基于贝叶斯先验-后验滚动实现排队服务时间的动态估计。考虑相邻周期之间交通流运行状态的关联性，将上一周期得到的后验估计信息作为本周期的先验估计信息，利用贝叶斯Logistic回归中的拉普拉斯近似方法实现先验-后验信息动态滚动，可以得到参数T＝θ的分布，从而得到排队服务时间的分布，取其均值完成周期级排队服务时间的动态估计。由贝叶斯公式可以得到参数的后验分布：式中θ为所求参数，x为M周期内所有观测车辆的信息对集合，P为参数后验分布，L为θ的似然函数，P为θ的先验分布，P为x的边际密度函数。通过拉普拉斯近似方法，将后验概率分布近似为高斯分布，求解与后验概率分布近似的高斯分布：其中，θ0是近似高斯分布的均值，后验概率函数在θ0处能取到局部最大值；A是近似高斯分布的方差的倒数，对于多维密度函数，A则为lnf在驻点θ0的黑塞矩阵。在每个周期得到参数的后验分布概率后，根据排队服务时间积分公式可以得到该周期的排队服务时间分布。将第m个周期的参数后验分布作为第m+1个周期的先验分布；对于第一个周期，需根据经验假设其先验概率分布。根据先验、后验概率的不断迭代，可以实现排队服务时间的动态估计。本发明采用NGSIM实测数据中的Lankershim-Boulevard数据集，从中随机采样不同渗透率的车辆轨迹数据代表网联车轨迹数据。配合Lankershim大道的实际道路信息、配时信号方案，对上述方法进行验证评估。关于自由流速度的提取，本发明将车辆状态分为三种，因此车速分布组数为3。通过三元高斯混合模型对提取的速度集进行拟合，以后验概率0.6为决策边界阈值对所有的车辆速度信息进行状态划分。以自然对数化后的速度为横坐标，以速度集中频率/组距为纵坐标，可以绘制如图2所示的三元高斯分布速度图。图2可以明显看出车辆根据车速大小依次被分为三种状态，速度均值分别为10.6、30.1、46.5，且每种状态的分布都近似为高斯分布。因此，可以得到该路段的自由流行驶速度为46.5km/h。根据全样本高精度轨迹数据和配时方案，可以得到排队服务时间真实值。将不同渗透率的车辆轨迹数据输入本方法得到排队服务时间估计值。为了反映估计结果的精准度，引入评价指标MAE和MAPE。为了比较本发明提出的贝叶斯Logistic回归方法在不同渗透率下的估计效果，选定渗透率分别为6％、10％、20％、30％的车辆轨迹数据进行试验。如图3的、、、所示，可以发现在渗透率从6％增长到30％的过程中，估计值的MAE和MAPE在逐渐减少，MAE分别为：6.1s、4.8s、3.4s、2.5s，MAPE分别为：25.5％、19.8％、14.6％、10.5％。这说明随着渗透率的不断增加，能够获得的信息逐渐增多，方法的准确性变高；同时也说明，本发明提出的估计方法在低渗透率数据环境下依然有良好的精度。以上实施例仅为说明本发明的技术思想，不能以此限定本发明的保护范围，凡是按照本发明提出的技术思想，在技术方案基础上所做的任何改动，均落入本发明保护范围之内。
