标题title
基于LoRaWAN网络的自触发模型预测方法及系统
摘要abst
本发明涉及一种基于LoRaWAN网络的自触发模型预测方法及系统，解决了无线网络控制系统预测控制算法计算负担较大的问题和无线通信网络通信能耗高的技术问题，通过求解具有约束的有限时域最优控制问题得到的最优控制输入序列，基于有限时域价值函数构建基于松弛动态规划条件最大限度的延长触发时刻，尽可能减少模型预测控制的更新次数；同时，结合LoRaWAN网络的通信协议特性，在自触发模型预测控制收敛范围内进一步调整触发间隔，使其与被控对象的信息接受窗口同步，一方面降低了通信能耗，另一方面保证了自触发模型预测控制的触发间隔的有效性，从而在保证模型预测控制准确度的同时，降低了计算量和通信负担。
权利要求书clms
1.一种基于LoRaWAN网络的自触发模型预测方法，其特征在于，包括：步骤1、根据被控对象在时间的状态输入、控制输入和输出构建控制系统线性模型；步骤2、基于控制系统线性模型构建具有约束的有限时域最优控制问题，求解有限时域最优控制问题得到从时间到时间的最优控制输入序列，表示时间的状态输入，表示预测步长；步骤3、构建求解有限时域最优控制问题的有限时域价值函数，并根据有限时域价值函数构建基于松弛动态规划条件来计算触发间隔，为触发时刻，为在触发时刻的状态，从而得到最优控制输入序列中满足控制系统线性模型约束的控制输入元素的个数；步骤4、基于计算的触发间隔计算得到下一触发时刻；步骤5、根据LoRaWAN协议判断下一触发时刻是否在被控对象的信息接受窗口内，若是，则进入步骤6；若否，进入步骤7；步骤6、将最优控制输入序列中从时间到下一触发时刻之间的控制输入元素发送给被控对象，并在下一触发时刻请求被控对象采集上报新的状态输入，，，并返回步骤2；步骤7、根据被控对象的信息接受窗口修改校正下一触发时刻，并将最优控制输入序列中从时间到下一触发时刻之间的控制输入元素发送给被控对象，并在下一触发时刻请求被控对象采集上报新状态输入，，并返回步骤2。2.根据权利要求1所述的基于LoRaWAN网络的自触发模型预测方法，其特征在于，所述步骤1中构建的控制系统线性模型表达式为：式中，表示时间的状态输入；表示时间的控制输入；表示时间的输出；表示控制系统线性模型的参数矩阵。3.根据权利要求2所述的基于LoRaWAN网络的自触发模型预测方法，其特征在于，所述步骤2中构建具有约束的有限时域最优控制问题的数学表达式为：s.t.；式中，表示预测步长；，表示状态输入的约束集，表示控制输入的约束集；是基于时间的状态输入和控制输入集构建的预测步长为N步的价值函数；从而得到从时间到时间的最优控制输入序列表达式为：。4.根据权利要求3所述的基于LoRaWAN网络的自触发模型预测方法，其特征在于，所述步骤3中构建的有限时域价值函数表达式为：；基于有限时域价值函数构建基于松弛动态规划条件的数学表达式为：式中，为触发时刻，满足；；式中，为给定标量：，，序列为误差项：；由于下一触发时刻的的值在上未知，为此，基于最优控制输入序列构建移位控制序列：；从而得到的估计值：；为移位控制序列应用到被控对象后的闭环输出；因此，基于松弛动态规划条件来计算触发间隔具体包括：；满足：对于，有。5.根据权利要求1至4任意一项所述的基于LoRaWAN网络的自触发模型预测方法，其特征在于，所述步骤4中下一触发时刻的计算公式为： 。6.根据权利要求5所述的基于LoRaWAN网络的自触发模型预测方法，其特征在于，所述步骤7中根据被控对象的信息接受窗口修改校正下一触发时刻为：，式中，函数为求余函数，为信息接受窗口周期时长。7.根据权利要求6所述的基于LoRaWAN网络的自触发模型预测方法，其特征在于，所述步骤7中根据被控对象的信息接受窗口修改校正下一触发时刻具体包括：判断是否大于等于，若是，则；否则，；式中，D2为Class B类型终端的信息接受窗口2的通信时刻，D1为Class B类型终端的信息接受窗口1的通信时刻。8.一种基于LoRaWAN网络的自触发模型预测系统，其特征在于，包括：远程控制终端，用于执行权利要求1-7任一项所述的基于LoRaWAN网络的自触发模型预测方法，所述远程控制终端包括用于构建控制系统线性模型的控制系统模块，基于被控系统线性模型执行自触发模型预测控制并求解得到触发间隔、下一触发时刻以及用于保证模型预测控制收敛的控制输入序列的计算单元，用于计算控制输入序列的边缘控制单元，所述边缘控制单元基于被控对象的信息接受窗口和下一触发时刻调整所述控制输入序列，以及用于通信的LoRaWAN网络通信单元；无线网络通信模块，用于存储LoRaWAN协议；至少1个被控对象，每个被控对象分别通过所述无线网络通信模块与所述远程控制终端通信，所述被控对象包括用于建立通信的LoRaWAN网络/总线、数据处理单元、执行器、被控设备和传感器单元，所述数据处理单元通过所述LoRaWAN网络/总线接收来自所述远程控制终端的控制输入序列，并依次将控制输入序列中的控制输入元素发送给所述执行器，所述执行器控制所述被控设备工作，所述传感器单元将采集的数据参数经过所述数据处理单元处理后，通过所述无线网络通信模块上报给所述远程控制终端作为新的状态输入，所述远程控制终端基于接收到的状态输入再次执行基于LoRaWAN网络的自触发模型预测方法。
说明书desc
技术领域本发明涉及模型预测控制技术领域，具体而言，涉及一种基于LoRaWAN网络的自触发模型预测方法及系统。背景技术模型预测控制是一种强大的约束系统最优控制技术，其基本原理是在每个采样时刻在线求取一个开环最优控制问题，得到一个最优控制序列，再将最优控制序列中的第一个控制输入元素应用到被控系统中，但是，传统的MPC在每个时刻都需要在线求解最优化问题，特别是当预测时域较大时，会造成巨大的计算负担，所以传统的模型预测控制方法需要很大的计算资源。LoRaWAN是一种基于LoRa远距离通信技术配套设计的一套通讯协议和系统架构。现有的MPC并没有考虑通信的限制分布量，当被控对象未处于信息接受窗口内时，导致MPC信息通信失败，而通信失败导致被控对象的控制输入超出MPC的控制边界，MPC过程无法收敛，模型预测控制准确度降低。发明内容本发明解决的问题是如何在保证模型预测控制的准确度的基础上，降低模型预测控制的计算量和通信负担。为解决上述问题，本发明提供一种基于LoRaWAN网络的自触发模型预测方法，包括：步骤1、根据被控对象在时间的状态输入、控制输入和输出构建控制系统线性模型；步骤2、基于控制系统线性模型构建具有约束的有限时域最优控制问题，求解有限时域最优控制问题得到从时间到时间的最优控制输入序列，表示时间的状态输入，表示预测步长；步骤3、构建求解有限时域最优控制问题的有限时域价值函数，并根据有限时域价值函数构建基于松弛动态规划条件来计算触发间隔，为触发时刻，为在触发时刻的状态，从而得到最优控制输入序列中满足控制系统线性模型约束的控制输入元素的个数；步骤4、基于计算的触发间隔计算得到下一触发时刻；步骤5、根据LoRaWAN协议判断下一触发时刻是否在被控对象的信息接受窗口内，若是，则进入步骤6；若否，进入步骤7；步骤6、将最优控制输入序列中从时间到下一触发时刻之间的控制输入元素发送给被控对象，并在下一触发时刻请求被控对象采集上报新的状态输入，，，并返回步骤2；步骤7、根据被控对象的信息接受窗口修改校正下一触发时刻，并将最优控制输入序列中从时间到下一触发时刻之间的控制输入元素发送给被控对象，并在下一触发时刻请求被控对象采集上报新的状态输入，，并返回步骤2。本发明的基于LoRaWAN网络的自触发模型预测方法的有益效果是：通过求解具有约束的有限时域最优控制问题得到的最优控制输入序列，基于有限时域价值函数构建基于松弛动态规划条件来尽可能多地使用最优控制输入序列中的控制输入元素，从而最大限度的延长触发时刻，尽可能减少模型预测控制的更新次数；同时，结合LoRaWAN网络的协议特性，在自触发模型预测控制收敛范围内进一步调整触发间隔，使自触发模型预测控制的下一触发时刻与被控对象的信息接受窗口匹配同步，一方面降低了通信能耗，另一方面保证了自触发模型预测控制的触发间隔的有效性，从而在保证模型预测控制准确度的同时，降低了计算量和通信负担。作为优选，所述步骤1中构建的控制系统线性模型表达式为：式中，表示时间的状态输入；表示时间的控制输入；表示时间的输出；表示控制系统线性模型的参数矩阵。作为优选，所述步骤2中构建具有约束的有限时域最优控制问题的数学表达式为：s.t.；式中，表示预测步长；，，表示状态输入的约束集，表示控制输入的约束集；是基于时间的状态输入和控制输入集构建的预测步长为N步的价值函数；从而得到从时间到时间的最优控制输入序列表达式为：。作为优选，所述步骤3中构建的有限时域价值函数表达式为：；基于有限时域价值函数构建基于松弛动态规划条件的数学表达式为：式中，为触发时刻，满足；；式中，为给定标量：，，序列为误差项：；由于下一触发时刻的的值在上未知，为此，基于最优控制输入序列构建移位控制序列：；从而得到的估计值：；为移位控制序列应用到被控对象后的闭环输出；因此，基于松弛动态规划条件来计算触发间隔具体包括：；满足：对于，有。作为优选，所述步骤4中下一触发时刻的计算公式为： 。作为优选，所述步骤7中根据被控对象的信息接受窗口修改校正下一触发时刻为：，式中，函数为求余函数，为信息接受窗口周期时长。作为优选，所述步骤7中根据被控对象的信息接受窗口修改校正下一触发时刻具体包括：判断是否大于等于，若是，则：；否则，；式中，D2为Class B类型终端的信息接受窗口2的通信时刻，D1为Class B类型终端的信息接受窗口1的通信时刻。基于LoRaWAN网络的自触发模型预测系统，包括：远程控制终端，用于执行基于LoRaWAN网络的自触发模型预测方法，所述远程控制终端包括用于构建控制系统线性模型的控制系统模块，基于被控系统线性模型执行自触发模型预测控制并求解得到触发间隔、下一触发时刻以及用于保证模型预测控制收敛的控制输入序列的计算单元，用于计算控制输入序列的边缘控制单元， 所述边缘控制单元基于被控对象的信息接受窗口和下一触发时刻调整所述控制输入序列，以及用于通信的LoRaWAN网络通信单元；无线网络通信模块，用于存储LoRaWAN协议；至少1个被控对象，每个被控对象分别通过所述无线网络通信模块与所述远程控制终端通信，所述被控对象包括用于建立通信的LoRaWAN网络/总线、数据处理单元、执行器、被控设备和传感器单元，所述数据处理单元通过所述LoRaWAN网络/总线接收来自所述远程控制终端的控制输入序列，并依次将控制输入序列中的控制输入元素发送给所述执行器，所述执行器控制所述被控设备工作，所述传感器单元将采集的数据参数经过所述数据处理单元处理后，通过所述无线网络通信模块上报给所述远程控制终端作为新的状态输入，所述远程控制终端基于接收到的状态输入再次执行基于LoRaWAN网络的自触发模型预测方法。本发明的基于LoRaWAN网络的自触发模型预测系统的有益效果是：通过远程控制终端求解有限时域最优控制问题得到最优控制输入序列，并通过有限时域价值函数构建基于松弛动态规划条件计算能够应用被控对象的控制输入序列，在保证模型预测控制在有效控制范围内的同时，尽可能多的使用最优控制输入序列中的控制输入元素，减少远程控制终端的计算负担，同时，远程控制终端通过LoRaWAN协议调整应用到被控对象的控制输入序列，使远程控制终端的下一触发时刻与被控对象的信息接受窗口匹配同步，一方面降低了通信能耗，另一方面保证了自触发模型预测控制的触发间隔的有效性，从而在保证模型预测控制准确度的同时，降低了计算量和通信负担。附图说明图1为本发明一实施例中Class A类型终端修正下一触发时刻示意图；图2为本发明另一实施例中Class B类型终端修正下一触发时刻示意图；图3为本发明另一实施例中Class B类型终端优选修正下一触发时刻示意图；图4为本发明具体实施例2的系统框架图。具体实施方式为使本发明的上述目的、特征和优点能够更为明显易懂，下面结合附图对本发明的具体实施例做详细的说明。根据本发明提供的另一实施方式，本具体实施例提供一种基于LoRaWAN网络的自触发模型预测方法，其应用于大规模的数据中心机房冷却场景中，该场景下，包括一个数据中心控制端、多地大型数据中心机房，每个大型数据中心机房包括至少600台服务器机柜和一个由至少10台精密空调组成的冷却系统，所述数据中心控制端通过LoRaWAN网络与冷却系统通信，通过采集冷却系统的状态，数据中心控制端进行自触发模型预测，随后将自触发模型预测的输出通过LoRaWAN网络传输给冷却系统进行控制；同时，LoRaWAN是远程广域网络协议，用于将多个被控对象以低速率与远距离外的数据中心控制端进行通信，所述自触发模型预测方法具体包括以下步骤：步骤1、根据被控对象在时间的状态输入、控制输入和输出构建控制系统线性模型；本具体实施例中，数据中心控制端根据被控对象在时间的状态输入，控制输入和输出构建被控系统线性模型，其中，被控对象为冷却系统，建立的控制系统线性线模型表达式为：式中，表示时间的状态输入，表示时间的控制输入，表示时间的输出；表示控制系统线性模型的参数矩阵，本具体实施例中，参数矩阵的具体矩阵参数通过现有技术中的热交换计算模型计算得到；上述状态输入包括每台服务器机柜的温度以及每台机柜能耗；上述控制输入包括冷却系统的温度设定值和/或设定供风量；上述输出包括冷却系统在时间的价值函数；步骤2、数据中心控制端基于控制系统线性模型构建具有约束的有限时域最优控制问题，本具体实施例中，在采样时间求解有限时域最优控制问题得到冷却系统输入序列，表示时间的状态输入，表示预测步长；最优控制输入序列中每个控制输入元素之间间隔时长30min，具体来说：构建具有约束的有限时域最优控制问题的数学表达式为：；式中，表示预测步长；，表示状态输入的约束集，表示控制输入的约束集；是基于时间的状态输入和控制输入集构建的预测步长为N步的价值函数；基于上述求解有限时域最优控制问题得到冷却系统从时间到时间的最优控制输入序列表达式为：；步骤3、数据中心控制端构建求解有限时域最优控制问题的有限时域价值函数，并根据有限时域价值函数构建基于松弛动态规划条件来计算触发间隔，为触发时刻，为在触发时刻的状态，从而得到最优控制输入序列中满足控制系统线性模型约束的控制输入元素的个数，从而尽可能多地使用最优控制输入序列中的控制输入元素；具体来说：构建的有限时域价值函数表达式为：；基于有限时域价值函数构建基于松弛动态规划条件的数学表达式为：式中，为触发时刻，即数据中心控制端求解有限时域最优控制问题的时间，满足；；式中，为给定标量：，，序列为误差项：；由于下一触发时刻的的值在上未知，为此，基于最优控制输入序列构建移位控制序列：；从而得到的估计值：；为移位控制序列应用到冷却系统后的闭环输出；因此，基于松弛动态规划条件来计算触发间隔具体包括：；满足：；对于，有；本具体实施例基于松弛动态规划条件来计算触发间隔为7个单位，定义当前触发时刻，即当前数据中心控制端求解有限时域最优控制问题得到能够直接应用到冷却系统的控制输入序列为：本具体实施例为了能够尽可能多的应用最优控制输入序列中的控制输入元素，通过有限时域价值函数构建松弛动态规划条件来计算触发间隔，从而尽可能多的使用最优控制输入序列中的控制输入元素，从而减少数据中心控制端模型预测控制的触发次数，减轻数据中心控制端的计算负担；步骤4、基于计算的触发间隔计算得到数据中心控制端下一次求解有限时域最优控制问题的时间，即下一触发时刻：；本具体实施例的；步骤5、为了保证通信可靠性，数据中心控制端根据LoRaWAN协议判断冷却系统与数据中心控制端通信的下一触发时刻是否在被控对象的信息接受窗口内，若是，则进入步骤6；若否，进入步骤7；步骤6、数据中心控制端将最优控制输入序列中从时间到下一触发时刻之间的控制输入元素发送给冷却系统，冷却系统根据时间到下一触发时刻之间的控制输入元素依次控制精密空调按照温度设定值和/或供风量给数据中心机房供冷，并在下一触发时刻请求被控对象采集上报新的状态输入参数，，，并返回步骤2；步骤7、根据被控对象的信息接受窗口修改校正下一触发时刻，本实施例中，被控对象采用LoRaWAN协议与数据中心控制端进行通信，被控对象作为LoRaWAN终端设备，可以为Class A类型终端或Class B类型终端，其中：在一实施例的场景中的冷却系统，通过LoRaWAN协议与数据中心控制端远程通信，该实施例中的冷却系统为Class A类型终端，如图1所示，在发送窗口之后间隔D1的时间开启信息接受窗口，允许从数据中心控制端接收数据信息；式中，函数为求余函数，为Class A类型终端的通信周期；采用Class A类型终端能够减少服务能耗，并且，本实施例中采用Class A类型终端使本实施例中关于下一触发时刻的计算时延较小；在另一实施例的场景中的冷却系统为Class B类型终端，如图2所示，在发送窗口之后间隔D1的时间开启信息接受窗口1，在发送窗口之后间隔D2的时间开启信息接受窗口2， 允许在两个信息接受窗口处从数据中心控制端接收数据信息；修改校正下一触发时刻如图2所示：，式中，为信息接受窗口周期时长；更优选地，当大于等于时，优选将下一触发时刻修正之信息接受窗口2的起始时刻，如图3所示：；式中，D2为信息接受窗口2的通信时刻，D1为信息接受窗口1的通信时刻；本实施例采用Class B类型终端，增加了信息接受窗口的个数，能够在自触发模型预测控制收敛的前提下，最大限度的将控制输入序列应用到被控对象，减少自触摸模型预测的次数；冷却系统根据从时间到下一触发时刻之间的控制输入元素依次控制精密空调按照温度设定值和/或供风量给数据中心机房供冷，并在下一触发时刻请求被控对象采集上报新的状态输入，， 并返回步骤2。同时，本实施例图1和图2中的发送窗口的工作内容具体包括：数据中心控制端向冷却系统发送请求通信，同时冷却系统将采集的状态输入发送给数据中心控制端进行计算；图1和图2中的信息接受窗口用于数据中心控制端将计算的控制输入元素传输给冷却系统。此外，本实施例步骤5中关于判断冷却系统与数据中心控制端通信的下一触发时刻是否在被控对象的信息接受窗口内的方法为判断是否等于0，若是，则下一触发时刻处于信息接受窗口内，否则，下一触发时刻不在信息接受窗口内；并且，为了保证通信和便于计算，本实施例中关于修正触发时刻均为计算信息接受窗口的起始时刻。本具体实施例结合LoRaWAN协议将数据中心控制端与冷却系统之间的通信进一步调整控制输入序列，使得数据中心控制端执行自触发模型预测控制始终收敛的同时，结合LoRaWAN网络的协议特性，在自触发模型预测控制收敛范围内依据Class A类型终端或Class B类型终端来修正下一触发时刻，使自触发模型预测控制的下一触发时刻与被控对象的信息接受窗口匹配同步，大大降低了通信能耗。根据本发明提供的另一实施方式，如图4所示，具体实施例2提供一种基于LoRaWAN网络的自触发模型预测系统，本具体实施例中，上述基于LoRaWAN网络的自触发模型预测系统应用于大规模的数据中心机房冷却场景中，该场景下，包括一个数据中心控制端、多地大型数据中心机房，每个大型数据中心机房包括至少600台服务器机柜和一个由至少10台精密空调组成的冷却系统；其中：远程控制终端，即本具体实施例的数据中心控制端，用于执行基于LoRaWAN网络的自触发模型预测方法，所述远程控制终端包括控制系统模块、计算单元、边缘控制单元和LoRaWAN网络通信单元；控制系统模块，用于构建控制系统线性模型的控制系统模块；本具体实施例中，控制系统模块根据数据中心机房中的冷却系统构建线性系统模型；计算单元，基于被控系统线性模型执行自触发模型预测控制并求解得到触发间隔和下一触发时刻；本具体实施例中，计算单元首先求解有限时域最优控制问题，得到最优控制输入序列；接着，构建有限时域价值函数，并基于有限时域价值函数构建基于松弛动态规划条件：；接着基于松弛动态规划条件来计算触发间隔：；通过触发间隔求解得到数据中心控制端下一次执行模型预测控制的时间，即下一触发时刻：；进而进一步得到能够使模型预测控制收敛的控制输入序列；边缘控制单元，LoRaWAN协议将能够使模型预测控制收敛的控制输入序列按照信息接受窗口进一步进行调整，使其与被控对象的信息接受窗口同步；一方面降低了通信能耗，另一方面保证了自触发模型预测控制的触发间隔的有效性，从而在保证模型预测控制准确度的同时，降低了计算量和通信负担；LoRaWAN网络通信单元，数据中心控制端通过LoRaWAN网络通信单元将调整后的控制输入序列通过无线网络通讯模块发送给冷却系统；无线网络通信模块，用于存储LoRaWAN协议；至少1个被控对象，即本具体实施例中数据中心机房中的冷却系统，每个冷却系统分别通过无线网络通信模块与数据中心控制端通信，所述冷却系统包括用于建立通信的LoRaWAN网络/总线、数据处理单元、执行器、被控设备和传感器单元；其中：所述数据处理单元通过LoRaWAN网络/总线接收来自远程控制终端的控制输入序列，并依次将控制输入序列中的控制输入元素发送给执行器；本具体实施例的控制输入元素包括精密空调的温度设定值和/或设定供风量，执行器根据控制输入元素控制精密空调工作供冷，直至最后一个控制输入元素发送完毕；执行器控制被控设备工作，本具体实施例中的被控设备为组成冷却系统的精密空调；传感器单元包括用于感应服务器机柜温度的温度传感器和用于计算服务器机柜能耗的电流互感器，所述传感器单元将采集的温度数据和电流能耗作为状态输入经过数据处理单元处理后，作为新的状态输入通过无线网络通信模块上报给远程控制终端的控制系统模块，远程控制终端基于接收到新的状态输入再次执行基于LoRaWAN网络的自触发模型预测方法。在每个触发时刻，传感器单元采集新的状态输入通过LoRaWAN网络通信单元上报给远程控制终端，远程控制终端求解有限时域最优控制问题得到最优控制输入序列，并通过有限时域价值函数构建基于松弛动态规划条件计算能够应用被控对象的控制输入序列，在保证模型预测控制在有效控制范围内的同时，尽可能多的使用最优控制输入序列中的控制输入元素，减少远程控制终端的计算负担，同时，远程控制终端通过被控对象的类型终端调整控制输入序列，并将调整后的控制输入序列下发给被控对象，使远程控制终端的下一触发时刻与被控对象的信息接受窗口匹配同步，一方面降低了通信能耗，另一方面保证了自触发模型预测控制的触发间隔的有效性，从而在保证模型预测控制准确度的同时，降低了计算量和通信负担。虽然本公开披露如上，但本公开的保护范围并非仅限于此。本领域技术人员，在不脱离本公开的精神和范围的前提下，可进行各种变更与修改，这些变更与修改均将落入本发明的保护范围。
