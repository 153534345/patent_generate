标题title
一种基于多源域适应的脑电信号跨用户警觉性监测方法
摘要abst
本发明公开了一种基于多源域适应的脑电信号跨用户警觉性监测方法，属于脑电信号识别技术领域。本发明采集多名用户的脑电信号进行预处理并作为多源源域。对于每一个源域数据，设置一个特征提取器实现对脑电信号的空间特征和时序特征的提取，设置两个任务分类器实现对特征的分类。采用对抗性域适应策略进行特征提取器和任务分类器的训练，以优化提取到的特征的分布，减少跨用户带来的特征决策边界处混淆的影响。在使用时，该系统利用可穿戴设备将脑电信号输入特征提取器和任务分类器中，通过投票的方式判定用户处于的警觉性状态。本发明实用性高，泛化性强，有效的提升了跨用户背景下用户的警觉性劳状态监测精度。
权利要求书clms
1.一种基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，包括以下步骤：步骤S1，基于可穿戴设备采集n位用户在不同的驾驶状态中激发的脑电信号数据，并对采集的各个用户的脑电信号数据进行数据预处理，得到每个用户的多个数据样本以及每个数据样本的警觉性状态标签，将同一用户的所有数据样本作为当前用户的训练集，得到n个训练集S1,S2,...,Sn，其中，n为大于1的整数；数据预处理为：截取驾驶过程中每次突发情况前M秒的脑电信号数据作为一个数据样本，并根据用户的反应时间设置每个数据样本的警觉性状态的真实分类标签，其中，M为预设值；步骤S2，基于训练集S1,S2,...,Sn对警觉性监测模型进行预训练；警觉性监测模型包括n个警觉性监测器，每一个训练集对应一个警觉性监测器，每个警觉性监测器包括一个特征提取器G和两个任务分类器F1，F2；对每个警觉性监测器，基于预设的批数据大小，从当前警觉性监测器对应的训练集中读取当前的输入数据并输入警觉性监测器；特征提取器G用于提取输入数据的空间特征和时序特征，并将提取出的时序特征和空间特征乘以各自的权重后进行拼接得到脑电信号的空间时序特征，再将脑电信号的空间时序特征分别输入任务分类器F1和F2中；任务分类器F1和F2用于输出警觉性状态的分类概率，将任务分类器F1和F2的分类概率相加得到警觉性监测器的分类概率，并基于警觉性监测器的分类概率中的最大概率值对应的警觉性状态得到警觉性监测器输出的预测分类标签；步骤S3，对待监测的目标用户，基于可穿戴设备采集目标用户在不同的驾驶状态中激发的脑电信号数据，并对采集的脑电信号数据进行数据切割，得到多个目标样本，目标样本的数据长度与步骤S1中的数据样本的相同；步骤S4，将训练集S1,S2,...,Sn分别作为源域数据，所有的目标样本作为目标域数据Xt，采用多源域适应策略对预训练后的警觉性监测模型进行对抗域适应训练；步骤S5，实时采集目标用户在行驶状态中激发的脑电信号数据并作为待监测数据，所述待监测数据的长度与目标样本相同；将当前采集的待监测数据同时输入到步骤S4训练后的n个警觉性检测器中，得到n个预测分类标签，采用投票方式判定目标用户的当前警觉性状态。2.如权利要求1所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，警觉性状态设置为三类：警觉性高、警觉性一般、警觉性差三类。3.如权利要求2所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，步骤S1中，每个数据样本的警觉性状态的真实分类标签的具体设置方式为：将突发情况分为两类，制动类突发情况和非制动类突发情况；对制动类突发情况，若当前数据样本满足1.2××Vi-BraSi＞0时，则真实分类标签设置为警觉性差；若当前数据样本满足1.2××Vi-BraSi≤0且1.6××Vi-BraSi＞0时，则真实分类标签设置为警觉性一般；若当前数据样本满足1.6××Vi-BraSi≤0时，则真实分类标签设置为警觉性高；对非制动类突发情况，若当前数据样本满足RenTi＞2.5×RenTT或RenTi＞3.3S时，则真实分类标签设置为警觉性差；若当前数据样本满足RenTi≤2.5×RenTT且RenTi＞1.8×RenTT时，则真实分类标签设置为警觉性一般；若当前数据样本满足RenTi≤1.8×RenTT且RenTi＞1.5×RenTT时，则真实分类标签设置为警觉性高；其中，RenTi表示第i次突发情况时，从突发情况出现到驾驶员做出相关动作的反应时间，RenTT表示第1次到第i次突发情况的反应时间中的上百分之十位数，Vi表示第i次突发情况的行驶速度，BraSi表示第i次突发情况时的制动距离。4.如权利要求3所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，步骤S1中，每个数据样本的警觉性状态的真实分类标签的具体设置方式还包括，统计用户在驾驶状态的闭眼现象，以及被驾驶对象的行驶轨迹偏离程度大于指定值的行驶状态；若当前数据样本的采样时间与闭眼现象和/或行驶轨迹偏离程度大于指定值的行驶状态的采样时间有交叉，则将当前数据样本的真实分类标签设置为警觉性差。5.如权利要求2所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，步骤S1中，每个数据样本的警觉性状态的真实分类标签的具体设置方式为：根据公式LRT=Act-Dep计算第t次遭遇突发情况时的局部反应时间LRT，其中，Act和Dep分别表示第t次突发情况发生时刻和用户开始作出反应的时刻；将第t次遭遇突发情况时的全局反应时间GRT设置为：第t次遭遇突发情况之前的指定驾驶时长内的所有局部反应时间的平均值；设置每个数据样本的警觉性状态的真实分类标签为：若LRT＞2.5×ART且GRT＞2.5×ART，则将第t个数据样本的真实分类标签设置为警觉性差；若1.5×ART≤LRT≤2.5×ART或者1.5×ART≤GRT≤2.5×ART，则将第t个数据样本的真实分类标签设置为警觉性一般；若LRT≤1.5×ART且GRT≤1.5×ART，则将第t个数据样本的真实分类标签设置为警觉性高；其中，ART表示警觉性高的代表性反应时间。6.如权利要求1所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，步骤S2中，特征提取器G包括基于卷积网络的脑电信号网络和基于循环网络的长短期记忆网络，其中，基于卷积网络的脑电信号网络用于提取输入数据的空间特征，其依次包括：一层卷积神经网络、一层深度卷积网络、一层可分离卷积网络和一个全连接层；基于循环网络的长短期记忆网络用于提取输入数据的时序特征，其依次包括：两个双向长短时记忆网络层和一个全连接层。7.如权利要求1所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，步骤S2中，任务分类器F1和F2的网络结构相同，依次包括第一全连接层、激活函数层和第二全连接层。8.如权利要求1至7任一项所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，步骤S2中，警觉性监测模型的各个疲劳监测器在预训练时，采用的损失函数为交叉熵损，将警觉性监测器的交叉熵损失反向传播以更新特征提取器G和任务分类器F1，F2的网络参数。9.如权利要求8所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，警觉性监测器的交叉熵损失为：其中，表示警觉性监测器的交叉熵损失，表示源域数据集，表示源域数据集的警觉性状态的标签集，表示数据样本，表示数据样本的真实分类标签，k表分类标签值，K表示警觉性状态的类别数，E表示数学期望，E的下标用于表征参与数学期望计算的对象及其数据范围，表示指示函数，若k=ys，则该指示函数的值取1，否则取0，p表示警觉性监测器对数据样本xs的分类概率，y表示预测分类标签；基于警觉性监测器的交叉熵损失将特征提取器G以及任务分类器F1和F2的网络参数更新为：其中，、、分别表示特征提取器G、任务分类器F1和F2的网络参数，上标i和i+1表示更新次数，表示特征提取器G的学习率，表示任务分类器F1和F2的学习率，符号“”表示偏导。10.如权利要求9所述的基于多源域适应的脑电信号跨用户警觉性监测方法，其特征在于，步骤S4中，采用多源域适应策略对预训练后的警觉性监测模型进行对抗域适应训练，具体为：步骤S401，固定特征提取器G的网络参数，更新任务分类器F1和F2的网络参数：基于训练集S1,S2,...,Sn的数据样本计算警觉性监测器的交叉熵损失；根据公式计算分类器差异损失，其中，和分表表示第一和第二分类器差异子损失，、分别表示和的权重；且第一分类器差异子损失和第二分类器差异子损失分别为：；；表示目标样本，、分别表示任务分类器F1和F2输出的分类概率，表示任务分类器F1和F2之间的分类差异，且，其中、分别表示任务分类器F1和F2输出的分类概率中对应分类标签值k的概率值，P1和P2分别表示任务分类器F1和F2输出的警觉性状态的分类概率分布，表示P1和P2组合起来的所有可能的联合分布集合，γ表示中的每一个联合分布，z1,z2表示从每个联合分布γ中采样的两个样本，表示样本距离，inf表示在所有可能的联合分布中取样本距离的最小值；基于交叉熵损失和分类器差异损失更新任务分类器F1和F2的网络参数：；；步骤S402，固定任务分类器F1和F2的网络参数，基于目标域数据Xt计算分类器差异损失更新特征提取器G的网络参数：；重复执行步骤S401和S402，直到满足预置的训练要求或者达到设置的最大训练次数。
说明书desc
技术领域本发明属于脑电信号识别技术领域，具体涉及一种基于多源域适应的脑电信号跨用户警觉性监测方法。背景技术在长时间的连续驾驶中，用户的警觉性会随着驾驶时长增加而逐渐下降，这带来了巨大的安全隐患。传统警觉性监测一般是基于主观量表、行为心理学测试或是面部活动等方法实现，但这些方法存在主观性大，容易伪装等缺点。基于生理信号的方法因其同时具备客观性、可连续监测性以及能够更早的发现警觉性下降的特点而成为了警觉性监测领域的研究和应用的热点方向。目前有许多基于视频信号的警觉性监测方法，例如虹膜监测、面部表情监测等，这些方法主要通过捕捉用户的动作信息或用户的反应时间来监测警觉性。用户因警觉性下降而产生的动作大同小异，反应时间的下降与个体差异关系不大，因此基于视频信号的监测方法在跨用户警觉性状态监测领域有着良好的表现。但生理信号相较于视频信号更容易受到个体差异性的影响。性别、年龄、性格、心情等因素都会影响生理信号的生成。因此，预训练过的模型可能在训练用户数据上表现很好，却在与训练用户差异较大的新用户上有很大误差，即监测模型的泛化性，鲁棒性较差。因此，设计一个基于生理信号的跨用户警觉性监测模型成为了一项富有意义和挑战性的任务。一些研究采取建立用户定制化模型的方法来解决生理信号的个体性差异问题，即通过采集大量用户的数据以支持用户定制化模型的建立。但是在实际应用中，由于隐私保护和用户驾驶数据收集困难等因素，为每个客户定制模型并不现实。个体差异性影响监测模型表现的根本原因是：个体差异性使得来自不同用户的数据不再符合传统机器学习中源域数据和目标域数据独立同分布的前提条件。域适应作为迁移学习技术的一种，其基本思想是：将源域和目标域数据都投影到某一个共同的空间上，使得在此空间上源域和目标域的数据差异尽可能的小，如此便保证了源域数据和目标域数据独立同分布的前提条件，也就使得模型的表现更加优秀。该方法仅需要少量新用户的无标签数据即可实现，相较于为客户定制模型的方法来说，该方法大大减少了制作数据集所耗费的人力物力资源。近年来，通过将域适应嵌入到深度学习中，深度学习模型对具有迁移能力的特征的分类效果有所提升。迁移成分分析，最大独立域适应作为迁移学习的传统方法，在一些问题上有着很优秀的表现。但是TCA和MIDA这些传统域适应方法都基于很强的数学假设，在实际应用中有着较大的局限性。基于归一化的域适应也受到了学者们的关注，然而，基于批归一化的域适应方法已被Burns等人证明只在有限的分布差异下才有效。最新的跨用户警觉性监测方法大多采用传统的基于对抗的单源域适应方法。这类方法将所有用户的数据视作一个源域，但实际上，脑电信号受个体差异性影响大，用户数据本身之间的差异信息对于警觉性的判断也至关重要，单源的方法不能充分利用这部分信息。更抽象的来说，单源的方法将所有用户的数据等效为一个中心，并尝试将这个中心与新用户的中心对齐，当新用户的中心与单源的中心差距较大时，域适应的效果就不太理想，因此，单源域适应是不稳定的。而多源域适应的方法就会考虑各个源域之间的差异信息，当不同新个体数据到来时，会给中心离新用户数据更近的源域分配更多的权重，因此稳定性相较单源域适应的方法有较大提升。同时，已有的方法中特征提取器只使用了卷积网络，因此只能提取到脑电信号的空间特征。但警觉性的下降是一个逐渐积累的过程，脑电信号的时序特征也十分重要，对于时序特征的学习可以更有效地实现警觉性的监测。发明内容本发明的发明目的在于：基于上述存在的问题，使用深度神经网络和对抗的多源域适应方法，从空间和时序两个维度提取脑电信号的特征，提出了一种基于多源域适应的脑电信号跨用户警觉性监测方法，以提升基于脑电信号跨用户警觉性监测的监测精度。本发明采用的技术方案如下：一种基于多源域适应的脑电信号跨用户警觉性监测方法，该方法包括以下步骤：步骤S1，基于可穿戴设备采集n位用户在不同的驾驶状态中激发的脑电信号数据，并对采集的各个用户的脑电信号数据进行数据预处理，得到每个用户的多个数据样本以及每个数据样本的警觉性状态标签，将同一用户的所有数据样本作为当前用户的训练集，得到n个训练集S1,S2,...,Sn，其中，n为大于1的整数；数据预处理为：截取驾驶过程中每次突发情况前M秒的脑电信号数据作为一个数据样本，并根据用户的反应时间设置每个数据样本的警觉性状态的真实分类标签，其中，M为预设值；步骤S2，基于训练集S1,S2,...,Sn对警觉性监测模型进行预训练；警觉性监测模型包括n个警觉性监测器，每一个训练集对应一个警觉性监测器，每个警觉性监测器包括一个特征提取器G和两个任务分类器F1,F2；对每个警觉性监测器，基于预设的批数据大小，从当前警觉性监测器对应的训练集中读取当前的输入数据并输入警觉性监测器；特征提取器G用于提取输入数据的空间特征和时序特征，并将提取出的时序特征和空间特征乘以各自的权重后进行拼接得到脑电信号的空间时序特征，再将脑电信号的空间时序特征分别输入任务分类器F1和F2中；任务分类器F1和F2用于输出警觉性状态的分类概率，将任务分类器F1和F2的分类概率相加得到警觉性监测器的分类概率，并基于警觉性监测器的分类概率中的最大概率值对应的警觉性状态得到警觉性监测器输出的预测分类标签；步骤S3，对待监测的目标用户，基于可穿戴设备采集目标用户在不同的驾驶状态中激发的脑电信号数据，并对采集的脑电信号数据进行数据切割，得到多个目标样本，目标样本的数据长度与步骤S1中的数据样本的相同；步骤S4，将训练集S1,S2,...,Sn分别作为源域数据，所有的目标样本作为目标域数据Xt，采用多源域适应策略对预训练后的警觉性监测模型进行对抗域适应训练；步骤S5，实时采集目标用户在行驶状态中激发的脑电信号数据并作为待监测数据，所述待监测数据的长度与目标样本相同；将当前采集的待监测数据同时输入到步骤S4训练后的n个警觉性检测器中，得到n个预测分类标签，采用投票方式判定目标用户的当前警觉性状态。进一步的，警觉性状态设置为三类：警觉性高、警觉性一般、警觉性差三类；进一步的，步骤S1中，每个数据样本的警觉性状态的真实分类标签的具体设置方式为：将突发情况分为两类，制动类突发情况和非制动类突发情况；对制动类突发情况，若当前数据样本满足1.2××Vi-BraSi＞0时，则真实分类标签设置为警觉性差；若当前数据样本满足1.2××Vi-BraSi≤0且1.6××Vi-BraSi＞0时，则真实分类标签设置为警觉性一般；若当前数据样本满足1.6××Vi-BraSi≤0时，则真实分类标签设置为警觉性高；对非制动类突发情况，若当前数据样本满足RenTi＞2.5×RenTT或RenTi＞3.3S时，则真实分类标签设置为警觉性差；若当前数据样本满足RenTi≤2.5×RenTT且RenTi＞1.8×RenTT时，则真实分类标签设置为警觉性一般；若当前数据样本满足RenTi≤1.8×RenTT且RenTi＞1.5×RenTT时，则真实分类标签设置为警觉性高；其中，RenTi表示第i次突发情况时，从突发情况出现到驾驶员做出相关动作的反应时间，RenTT表示第1次到第i次突发情况的反应时间中的上百分之十位数，Vi表示第i次突发情况的行驶速度，BraSi表示第i次突发情况时的制动距离。进一步的，每个数据样本的警觉性状态的真实分类标签的具体设置方式还包括，统计用户在驾驶状态的闭眼现象，以及被驾驶对象的行驶轨迹偏离程度大于指定值的行驶状态；若当前数据样本的采样时间与闭眼现象和/或行驶轨迹偏离程度大于指定值的行驶状态的采样时间有交叉，则将当前数据样本的真实分类标签设置为警觉性差。进一步的，步骤S1中，每个数据样本的警觉性状态的真实分类标签还可以采用下述方式为：根据公式LRT=Act-Dep计算第t次遭遇突发情况时的局部反应时间LRT，其中，Act和Dep分别表示第t次突发情况发生时刻和用户开始作出反应的时刻；将第t次遭遇突发情况时的全局反应时间GRT设置为：第t次遭遇突发情况之前的指定驾驶时长内的所有局部反应时间的平均值；设置每个数据样本的警觉性状态的真实分类标签为：若LRT＞2.5×ART且GRT＞2.5×ART，则将第t个数据样本的真实分类标签设置为警觉性差；若1.5×ART≤LRT≤2.5×ART或者1.5×ART≤GRT≤2.5×ART，则将第t个数据样本的真实分类标签设置为警觉性一般；若LRT≤1.5×ART且GRT≤1.5×ART，则将第t个数据样本的真实分类标签设置为警觉性高；其中，ART表示警觉性高的代表性反应时间，取值可以设置为所有局部时间的上百分之五位数。进一步的，步骤S2中，特征提取器G包括基于卷积网络的脑电信号网络和基于循环网络的长短期记忆网络，其中，基于卷积网络的脑电信号网络用于提取输入数据的空间特征，其依次包括：一层卷积神经网络、一层深度卷积网络、一层可分离卷积网络和一个全连接层；基于循环网络的长短期记忆网络用于提取输入数据的时序特征，其依次包括：两个双向长短时记忆网络层和一个全连接层。进一步的，步骤S2中，任务分类器F1和F2的网络结构相同，依次包括第一全连接层、激活函数层和第二全连接层。进一步的，步骤S5中，采用投票方式判定目标用户的当前警觉性状态，具体为：对n个预测分类标签，选择得票最多的警觉性状态类别作为判定结果。进一步的，步骤S2中，警觉性监测模型的各个疲劳监测器在预训练时，采用的损失函数为交叉熵损，将警觉性监测器的交叉熵损失反向传播以更新特征提取器G和任务分类器F1,F2的网络参数。进一步的，警觉性监测器的交叉熵损失为：其中，表示警觉性监测器的交叉熵损失，表示源域数据集，表示源域数据集的警觉性状态的标签集，表示数据样本，表示数据样本的真实分类标签，k表分类标签值，K表示警觉性状态的类别数，如对于包括警觉性高、警觉性一般和警觉性差三类的警觉性状态，取值为1表示警觉性高，取值为2表示警觉性一般，取值为3表示警觉性差，E表示数学期望，E的下标用于表征参与数学期望计算的对象及其数据范围，表示指示函数，若k=ys，则该指示函数的值取1，否则取0，p表示警觉性监测器对数据样本xs的分类概率，y表示预测分类标签；基于警觉性监测器的交叉熵损失将特征提取器G以及任务分类器F1和F2的网络参数更新为：其中，、、分别表示特征提取器G、任务分类器F1和F2的网络参数，上标i和i+1表示更新次数，表示特征提取器G的学习率，表示任务分类器F1和F2的学习率，符号“”表示偏导。进一步的，步骤S4中，采用多源域适应策略对预训练后的警觉性监测模型进行对抗域适应训练具体为：步骤S401，固定特征提取器G的网络参数，更新任务分类器F1和F2的网络参数：基于训练集S1,S2,...,Sn的数据样本计算警觉性监测器的交叉熵损失；根据公式计算分类器差异损失，其中，和分表表示第一和第二分类器差异子损失， 、分别表示和的权重；且第一分类器差异子损失和第二分类器差异子损失分别为：；；表示目标样本，、分别表示任务分类器F1和F2输出的分类概率，表示任务分类器F1和F2之间的分类差异，且，其中、分别表示任务分类器F1和F2输出的分类概率中对应分类标签值k的概率值，P1和P2分别表示任务分类器F1和F2输出的警觉性状态的分类概率分布，表示P1和P2组合起来的所有可能的联合分布集合，γ表示中的每一个联合分布，z1，z2表示从每个联合分布γ中采样的两个样本，表示样本距离，inf表示在所有可能的联合分布中取样本距离的最小值；基于交叉熵损失和分类器差异损失更新任务分类器F1和F2的网络参数：；；步骤S402，固定任务分类器F1和F2的网络参数，基于目标域数据Xt计算分类器差异损失更新特征提取器G的网络参数：；重复执行步骤S401和S402，直到满足预置的训练要求或者达到设置的最大训练次数。综上所述，由于采用了上述技术方案，本发明的有益效果是：本发明采用脑电信号作为警觉性监测的数据来源，相较于传统的量表等方法，本发明具有客观性、可连续监测性以及能够更早的发现警觉性下降等优点。同时，本发明采用对抗性域适应策略，在训练过程中削弱了特征边界处混淆和重叠处混淆的影响，增加了模型的泛化能力、鲁棒性。此外，本发明同时关注了脑电信号的时间和空间特点，相较于传统的特征提取方法和只关注脑电信号的空间特征的提取方法，本发明有着更为优异的特征提取效果。最后，相较于单源域适应的方法，本发明采用的多源域适应方法充分利用了个体间的差异信息，对于新个体的适应有着更高的稳定性和更好的效果。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1是本发明实施例提供的一种基于多源域适应的脑电信号跨用户警觉性监测方法的处理流程图；图2是本发明实施例中，采用的警觉性监测模型的结构示意图；图3是本发明实施例中，采用的特征提取器G的网络结构示意图；图4是本发明实施例中，采用的任务分类器的网络结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明实施方式作进一步地详细描述。本发明实施例提供了一种基于多源域适应的脑电信号跨用户警觉性监测方法，如图1所示，包括下列步骤：采集应试者的脑电信号数据，设置多源源域数据：包括对采集的脑电信号数据进行切割并形成数据样本，以及为每个数据样本设置真实分类标签；本发明实施例中，为了简化处理过程，对N位应试者基于可穿戴设备采集各应试者在不同的驾驶状态中激发的脑电信号数据，并将其中一名应试者的脑电信号数据作为目标域数据，用于后续步骤的处理，其余的N-1位应试者的脑电信号数据作为源域数据的获取基础，定义n=N-1，则针对n名应试者的多个样本数据，可以得到n个训练集，记为S1,S2...Sn。即，通过对n名用户的脑电信号数据的信号预处理，可以得到每个用户的训练集，以及各训练集的各个样本数据的真实分类标签；基于多源源域数据对警觉性监测模型进行预训练：其中，警觉性监测模型包括n个警觉性监测器，如图2所示，每个警觉性监测器依次包括一个特征提取器G，在特征提取器G的输出端分别连接两个任务分类器F1和F2，即任务分类器F1和F2的输入端分别与特征提取器G的输出端相连；每个任务分类器用于进行三分类输出，即每个任务分类器输出的警觉性状态的分类概率为三维分类概率，将两个任务分类器输出的分类概率相加，即可得到警觉性监测器的分类概率。每个警觉性监测器分别对应一个源域数据，即本发明实施例中，警觉性监测模型包括n个特征提取器G，依次命名为：G1,G2...Gn。各特征提取器G用于提取脑电信号的空间特征和时序特征，并将提取出的时序特征和空间特征乘以各自的权重后进行拼接。拼接完成后再将新的特征输入到任务分类器F1和F2中，从而可以基于每个警觉性监测器的分类概率中的最大概率值所对应的警觉性状态得到警觉性监测器输出的预测状态，以实现对输入数据的警觉性状态预测。作为一种可能的实现方式，本发明实施例中，所采用的特征提取器G由基于卷积网络的脑电信号网络和基于循环网络的长短期记忆网络组成。其中，EEGNet包括依次连接的一层卷积神经网络、一层深度卷积网络、一层可分离卷积网络和一个全连接层。LSTM包括依次连接的两个BiLSTM层和一个全连接层。所采用的任务分类器用于接收特征提取器提取到的特征并计算得到用户的精神状态，由依次连接的一个全连接层，激活函数和另一个全连接层组成。基于多源源域数据对警觉性监测模型进行预训练指：对每个警觉性监测器，基于预设的批数据大小，从当前警觉性监测器对应的训练集中读取当前的输入数据并输入警觉性监测器；以交叉熵损失作为预训练时的损失函数，对警觉性监测器的网络参数进行更新，当满足预训练要求或达到最大预训练次数时停止，从而得到预训练后的警觉性监测模型。本发明实施例中，训练警觉性监测器的目的是使得特征提取器G能够以提取输入信号具有时间稳定性和空间稳定性的可辨别性的特征，并使得任务分类器F1，F2能够将特征提取器G提取到的特征正确的划分警觉性等级。采集目标用户的目标域数据；即当新用户U加入时，采集该用户在不同的驾驶状态中激发的脑电信号数据，并命名为数据集T。本实施例中，为了简化处理过程，直接将应试者中的一名作为目标用户。采用多源域适应策略对预训练后的警觉性监测模型进行对抗域适应训练：本步骤中包括：固定特征提取器G的网络参数，并更新任务分类器F1和F2的网络参数：固定特征提取器G的网络参数，基于训练集的数据计算任务分类器F1和F2的损失并更新任务分类器F1和F2的网络参数，使得两个任务分类器都能够将特征提取器G提取到的特征正确的划分警觉性等级，并且使得两个任务分类器的差异尽可能的大；固定任务分类器F1和F2的网络参数，并更新特征提取器G的网络参数：固定任务分类器F1和F2的网络参数，训练特征提取器G以减少两个任务分类器间的差异，从而使特征提取器G将样本重新映射，逐渐靠近源域分布密集的区域；重复执行步骤和，直到满足对抗域适应训练要求或达到对抗域适应训练的最大训练次数。基于对抗域适应训练后的警觉性监测模型对目标用户进行实时监测：将实时采集得到目标用户的脑电信号输入到步骤训练后的警觉性监测模型中，基于n个警觉性监测器输出的预测分类标签确定目标用户的当前警觉性状态，即取有着最多票数的警觉性等级作为监测的结果。进一步的，若驾驶员已处于警觉性差的状态，则该系统调用显示模块在屏幕上显示提示，同时调用语音系统播报提醒，督促用户及时休息。同时，辅助驾驶系统更改驾驶系统和用户操作的权重，使得用户在辅助驾驶系统的强监督下行驶。本发明实施例提供的一种基于多源域适应的脑电信号跨用户警觉性监测方法可用于汽车的驾驶系统、飞行员驾驶舱系统等，以实现对驾驶员的警觉性状态识别，其实施便捷、实用性高、识别精度高、泛化性强，能够有效地识别未在数据库中的新用户的警觉性。作为一种可能的实现方式，让27位健康用户佩戴可穿戴设备在模拟驾驶软件上模拟真实驾驶。在每组90分钟的驾驶过程中，突发事件会随时出现，受试者需要尽快做出反应以保证驾驶安全。这个过程中，受试者的反应时间、脑电信号等数据被记录下来，其中，脑电信号数据的采样率为500HZ，通道数为30。本实施例中，具体的信号处理方式如下：将每次突发情况前三秒的脑电数据截取出来，并用受试者的反应时间来打标签。具体来说，首先计算第t次汽车偏移时的局部反应时间LRT和全局反应时间GRT：LRT=Act-Dep；GRT=agv{LRT|Dep-Dep≤Tim}；其中，Act和Dep分别表示第t次汽车偏移时刻和用户开始反向操纵方向盘的时刻，LRT和Dep表示第j次汽车偏移时刻和用户开始反向操纵方向盘的时刻，agv{ }表示对括号{ }中的元素取均值，Tim表示指定的驾驶时长，本实施例中，Tim=90。即第t次汽车偏移时的全局反应时间GRT为：第t次汽车偏移时刻之前90分钟内所有局部反应时间的平均值。对于所有组的数据，疲劳和非疲劳的分界线ART为所有局部时间的上百分之五位数，例如对于m个局部时间：LRT,LRT，…，LRT，需要从这m个局部时间中找到一个数值，使得至少有5%的数据比该数值小，有95%的数据比该数值大。然后根据此分界线设置每个数据样本的警觉性状态的真实分类标签：若LRT＞2.5×ART且GRT＞2.5×ART，则将第t个数据样本的真实分类标签设置为警觉性差；若1.5×ART≤LRT≤2.5×ART或者1.5×ART≤GRT≤2.5×ART，则将第t个数据样本的真实分类标签设置为警觉性一般；若LRT≤1.5×ART且GRT≤1.5×ART，则将第t个数据样本的真实分类标签设置为警觉性高。将处理好的一位用户数据作为目标域数据，其余26位用户数据依次编号为S1~S26并作为源域数据。此处源域数据应包含三种警觉性状态的数据。作为一种可能的实现方式，本发明实施例中，还可以采用下述方式完成对三种警觉性状态的标签设置。例如，在参与测试的驾驶员进行120分钟的模拟行驶的过程中，每隔RandT时间会随机出现急刹车、紧急变道、车辆偏转等突发情况，驾驶员需要尽可能快的做出反应。基于可穿戴设备和录制设备监测并记录驾驶员的脑电信号、反应时间、实时车速、制动距离、眼部状态等信息，并作为警觉性状态的判定依据。具体来说，其判断方式如下：若第i次给予的突发情况为刹车，且1.2××Vi-BraSi＞0时，则认为驾驶员警觉性差；当1.2××Vi-BraSi≤0且1.6××Vi-BraSi＞0时认为驾驶员警觉性一般；当1.6××Vi-BraSi≤0时认为驾驶员警觉性一般。若第i次给予的突发情况为紧急变道、车辆偏转等情况，且RenTi＞2.5×RenTT或RenTi＞3.3S时，则认为驾驶员警觉性差；若RenTi≤2.5×RenTT且RenTi＞1.8×RenTT，则认为驾驶员警觉性一般；若RenTi≤1.8×RenTT且RenTi＞1.5×RenTT，则认为驾驶员警觉性好，即警觉性高。其中，RenTi表示第i次实验中从突发情况出现到驾驶员做出相关动作的反应时间，RenTT表示第1次到第i次实验的反应时间中的上百分之十位数，Vi表示第i次实验的车速，BraSi表示第i次实验的制动距离。此外，如果在整个驾驶过程中，若驾驶员出现三秒以上的闭眼现象，或是出现超过半个车身偏离车道的现象，也认为为驾驶员已经处于警觉性差的状态。作为一种可能的实现方式，数据样本的真实分类标签设置方式还可以是用量表的方式去采集，或者是用实时连续的情感注释系统进行标注。具体来说，量表的方式为：每隔一段时间让受试者填一个量表，其中需要用户给自己目前的状态打等级，然后根据量表得分进行警觉性等级的划分。而实时连续情感注释是指，给用户一个可以实时标注的二维平面，横轴代表注意力集中程度，纵轴代表感受到疲劳的程度，然后根据用户的标注给脑电信号打标签。新用户脑电信号数据的采集为：当新用户U加入时，采集该用户在不同的驾驶状态中激发的脑电信号数据，并命名为数据集T。参见图2，图3和图4，本实施例中的警觉性监测模型包括n个疲劳监测器，分别命名为G1,G2...Gn。其中，每个警觉性监测器都由一个特征提取器G、两个任务分类器F1和F2组成。特征提取器G由基于卷积网络的EEGNet和基于循环网络的LSTM构成。其中EEGNet由依次连接的卷积神经网络、深度卷积网络、可分离卷积神经网络、和全连接层组成，LSTM由依次连接的两层BiLSTM和一层全连接层组成。 其中，Depthwise Conv1D分别对于输入信号的每个通道进行卷积，得到每个通道上的特征，Separable Conv1D由一层Depthwise Conv1D和一层Pointwise Conv1D组成，Depthwise Conv1D在上一层网络提取的基础上进一步提取每个通道上的特征，Pointwise Conv1D将提取出的各通道的特征在空间维度上进行加权组合，得到输入脑电信号的空间特征。特征提取器G把30通道的脑电信号输入EEGNet和LSTM中，形成1×32的空间特征和1×10的时序特征。由于时序和空间的特征可能对警觉性监测起到的作用并不是同等重要的，因此本实施例中引入了注意力机制，在时序特征和空间特征融合之前对二者的特征向量加以不同的权重。具体来说，在特征融合之前将时序特征fspq，空间特征ftem分别输入两个结构相同但是参数完全不同的全连接网络中，用于处理时序特征的全连接网络表示为，用于处理空间特征的全连接网络表示为，经过计算后得到两个权重值Wspa和Wtem，然后按照公式将时序特征和空间特征加权拼接即得到最后的空间时序特征fst，其中时序特征权重，空间特征权重。任务分类器F1，F2以特征提取器G输出的1×42的空间时序特征作为输入，经过依次连接的一个全连接层，激活函数和另一个全连接层后，得到1×3的警觉性的分类概率，将概率最大的状态作为该段脑电信号的输出标签，即输出警觉性高、警觉性一般或警觉性差。本实施例中，警觉性监测模型训练的流程分为：警觉性监测模型的预训练，以及对抗域适应训练。其中，预训练过程，即对上述n个警觉性监测器的训练。每个警觉性监测器的训练流程类似，以下所有步骤均以第j个警觉性监测器Dj的训练过程为例。本实施例中，警觉性监测模型的预训练过程主要是为了使得特征提取器G能够提取具有代表意义的特征，并且使得任务分类器F1,F2能够正确的将特征提取器G提取的特征分类，继而使得警觉性监测模型能够在源域数据集上正确的识别用户的警觉性状态。训练采用Adam优化器来更新模型的网络参数，优化器的两个超参数β1和β2分别设置为：β1=0.9，β2=0.999，特征提取器G的学习率γ1=0.005， 两个任务分类器F1，F2的学习率都设置为γ2=0.002，模型的预训练次数为100次，源域和目标域的批大小都为64。具体来说，警觉性监测模型在预训练时的目标函数可以表示为：其中，表示警觉性监测器的交叉熵损失，其表达式为：；其中，表示源域数据集，表示源域数据集的警觉性状态的标签集，表示数据样本，表示数据样本的真实分类标签，K表示警觉性状态的类别数，k表分类标签值，本发明实施例中，K的取值为3，k取值为1表示警觉性高，取值为2表示警觉性一般，取值为3表示警觉性差，即表示从有标签的源域数据抽取的样本,E表示数学期望，E的下标用于表征参与数学期望计算的对象及其数据范围，表示指示函数，若k=ys，则该指示函数的值取1，否则取0，p表示疲劳监测器对数据样本xs的分类概率，y表示预测分类标签进而根据计算得到的对特征提取器G的网络参数，任务分类器F1的网络参数和任务分类器F2的网络参数进行更新：网络参数、、的上标i和i+1用于表征更新次数，表示特征提取器G的学习率，表示任务分类器F1和F2的学习率，符号“”表示偏导。即预训练的过程是：计算并更新特征提取器G、任务分类器F1和F2的网络参数，循环进行该操作直到达到预设的最大预训练次数或者预置的预训练要求。本实施例中，在采用多源域适应策略对预训练后的警觉性监测模型进行对抗域适应训练时，固定特征提取器G的参数并更新任务分类器F1和F2的网络参数这一步骤主要是为了让两个任务分类器F1，F2能够更准确的识别特征提取器G提取的特征，同时让两个任务分类器F1和F2之间有着尽可能大的差异。最大化分类器差异的方法可以有效避免常用域适应方法带来的边界混淆问题。具体来说，对抗域适应训练时，固定特征提取器G的参数并更新任务分类器F1和F2的网络参数时的目标函数可以表示为：；其中，；；；其中，表示分类器差异损失， 和分表表示第一和第二分类器差异子损失，、分别表示和的权重，以区分两部分损失的重要程度，表示目标样本，、分别表示任务分类器F1和F2输出的分类概率，表示任务分类器F1和F2之间的分类差异，且，其中和分别表示任务分类器F1和F2输出的分类概率中对应分类标签值k的概率值，P1和P2分别表示任务分类器F1和F2输出的警觉性状态的分类概率分布，表示P1和P2组合起来的所有可能的联合分布集合，γ表示中的每一个联合分布，z1，z2表示从每个联合分布γ中采样的两个样本，表示样本距离，inf表示在所有可能的联合分布中取样本距离的最小值。本实施例中，引入了注意力机制来获取和的权重，即在两者求和之前对二者的特征向量加以不同的权重。具体来说，在直接相加前将和分别输入两个结构相同但是参数完全不同的全连接网络中，经过计算后得到两个权重值和。然后将两个损失分别乘上对应的权重并求和得到分类器差异损失。进而根据计算得到的和更新任务分类器F1和F2的网络参数：；；接着，再固定任务分类器F1和F2的网络参数并更新特征提取器G的网络参数，这一步骤主要是为了训练特征提取器G，使得特征提取器G提取的特征能够更好的落入分类器的分类边界内，进而使得从源域提取的特征和从目标域提取的特征有着更为相似的分布，从而提高模型的判断准确性。具体来说，固定任务分类器F1和F2的网络参数并更新特征提取器G的网络参数时的目标函数可以表示为：；进而根据计算得到的分类器差异损失更新特征提取器G的网络参数：；在对抗域适应训练时，应持续进行固定特征提取器G的网络参数并更新任务分类器F1，F2的网络参数，固定任务分类器F1，F2的网络参数并更新特征提取器G的参数的步骤直到达到设定的训练次数或训练要求。本实施例中，基于对抗域适应训练后的警觉性监测模型对目标用户进行实时监测具体为：将抗域适应训练好的警觉性监测模型部署，用于对新用户U的警觉性状态的监测。具体来说，其步骤是：将实时采集得到的脑电信号同时输入到训练好的n个警觉性检测器中，得到n个当前用户的警觉性状态，设有Pi个警觉性监测器判定用户的警觉性高，Pj个疲劳监测器判定用户的警觉性一般，Pk个疲劳监测器判定用户的警觉性差，取max对应的警觉性状态作为当前用户的警觉性状态。在部署了警觉性监测系统的辅助驾驶系统中，辅助驾驶系统可以根据警觉性监测系统的结果调整用户驾驶权重和系统驾驶权重。令用户的驾驶权限为Wusr，系统的控制权限为Wsys,则当用户警觉性高时，Wusr =90%，Wsys=10%；当用户警觉性一般时，Wusr=80%，Wsys=20%的；当用户警觉性差时，Wusr=40%，Wsys=60%。车辆的实际动作=用户动作×Wusr +危险系数×系统动作×Wsys。本发明实施例提供了一种基于多源域适应的脑电信号跨用户警觉性监测方法，通过采集多名用户的脑电信号进行预处理并作为多源源域。对于每一个源域数据，设置一个特征提取器实现对脑电信号的空间特征和时序特征的提取，设置两个任务分类器实现对特征的分类。采用对抗性域适应策略进行特征提取器和任务分类器的训练，以优化提取到的特征的分布，减少跨用户带来的特征决策边界处混淆的影响。在使用时，将脑电信号输入特征提取器和任务分类器中，通过投票的方式判定用户处于的警觉性状态。本发明实用性高，泛化性强，有效的提升了跨用户背景下用户的警觉性状态监测精度。基于本发明的检测可实现汽车、飞机等的智能驾驶，将抗域适应训练好的警觉性监测模型部署到汽车、飞机等的驾驶系统中，用于对新用户U的警觉性状态的监测、告警提示并协助辅助驾驶系统运行。即首先通过可穿戴设备将实时采集得到的脑电信号同时输入到该警觉性监测模型的n个警觉性检测器中，得到n个当前用户的警觉性状态，通过投票的方式判定用户的警觉性状态：警觉性高、警觉性一般或警觉性差。辅助驾驶系统根据警觉性监测系统的结果调整用户驾驶权重和系统驾驶权重，当判定为警觉性差时，系统可通过显示模块在屏幕上显示提示，同时通过语音播报提醒。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。以上所述的仅是本发明的一些实施方式。对于本领域的普通技术人员来说，在不脱离本发明创造构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。
