标题title
基于点云数据的地面点拟合、作物高度提取的方法及系统
摘要abst
本发明公开一种基于点云数据的地面点拟合、作物高度提取的方法及系统，首先获取带有种植物区域的三维点云数据；然后确定种植物冠层数据信息；再结合地面起伏信息确定地面点云数据；并拟合缺失高程数据的地面点，最后，根据冠层顶部点和拟合后的地面点，计算采样区域内的种植物高度。本发明提供的方法通过提取点云中实际存在的地面点，对点云各部分的有效程度进行了分析，通过基于高程和坡度来提取地面点，基于真实地面点对缺失地面点的高程进行拟合，消除地形起伏所产生的误差，适用性更高，进而从原始点云中滤出有效点云进行就可以进行作物高度的提取，同时排除无效点云干扰，降低后续处理的复杂程度，克服了地形起伏对提取作物高度带来的误差。
权利要求书clms
1.基于点云数据的地面点拟合方法，其特征在于：包括以下步骤：获取带有种植物区域的三维点云数据；根据点云数据确定种植物冠层数据信息；根据冠层数据信息和地面起伏信息确定地面点云数据；根据地面点云数据拟合缺失高程数据的地面点。2.如权利要求1所述的基于点云数据的地面点拟合方法，其特征在于：所述种植物冠层数据信息按照以下步骤确定：根据种植物间距将点云数据分区，建立包围盒并根据包围盒构建切片；对包围盒中各切片的点云数据进行密度聚类得到密度聚类中心；根据各切片的密度聚类中心之间的差异标记冠层顶部点、冠层中部点和地面附近点。3.如权利要求2所述的基于点云数据的地面点拟合方法，其特征在于：所述地面点数据按照以下步骤确定：根据地面起伏情况合并预设范围内的地面附近点；随机选取地面附近点中的N个样本点进行平面拟合，并根据地面起伏情况，设置容差范围，找出距离拟合平面在容差范围内的点，并统计内点个数δ；重复选取样本点进行内点数标记和统计，直到符合迭代结束条件，选取内点个数δ最大时的拟合平面作为提取结果，所述内点为是地面点云数据。4.如权利要求2所述的基于点云数据的地面点拟合方法，其特征在于：所述包围盒与切片的构建是按照以下步骤来进行的：根据子区域的点云分布建立包围盒，在z轴方向从下到上将点云分为多个厚度为H1的切片，另外再从上到下将点云分为多个厚度为H2的切片，两次切片厚度H1、H2分别根据地面起伏情况和冠层顶部点云厚度设置。5.如权利要求2所述的基于点云数据的地面点拟合方法，其特征在于：还包括以下步骤：根据包围盒中点云数据的高程信息进行密度聚类，如果得到两个聚类中心，再按照这两个聚类中心的高低标记冠层点与地面附近点；如果存在一个聚类中心，则根据临近包围盒内的聚类中心判断点云种类。6.如权利要求4所述的基于点云数据的地面点拟合方法，其特征在于：还包括以下步骤：比较包围盒下半部分和上半部分中每个切片内的点数与所有切片中点数平均值的大小，若某个切片内的点数小于平均值，则其中的内点被认为是无效的中部冠层点或离群点并被滤除。7.如权利要求3所述的基于点云数据的地面点拟合方法，其特征在于：所述拟合缺失高程数据的地面点是按照以下步骤进行的：合并所有地面点，构建KNN查找表，根据水平距离和所需样本数量查找任意冠层点下方的地面点云数据；根据地面点云数据与该冠层点云数据的水平距离分配权重；计算地面点云数据的加权平均高度，作为该冠层点正下方的地面高度；按照上述操作，遍历所有冠层点，得到种植物区域的拟合地面高度。8.根据权利要求1-7中任一项所述的方法来实现作物高度提取的方法，其特征在于：包括以下步骤：根据利用地面点云数据拟合的地面点以及带有种植物的三维点云数据得到种植物区域的地面点；根据带有种植物区域的三维点云数据得到的种植物的冠层顶部点；根据冠层顶部点和拟合后的地面点，计算采样区域内的种植物高度。9.基于无人机点云和拟合地面点的种植物高度提取系统，其特征在于：包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现权利要求8所述方法的步骤。10.基于无人机点云和拟合地面点的种植物高度提取系统，其特征在于：包括数据获取单元、冠层切片滤波器、真实地面点提取单元、拟合缺失地面点单元、作物高度估测单元；所述数据获取单元，用于获取农作物种植区域的无人机影像，通过SfM算法生成的三维点云；所述冠层切片滤波器，用于对原始点云进行预处理，根据实际作物种植间距将点云分区，构建包围盒与内部切片；对包围盒中的点云进行聚类，初步判断点云种类；根据各切片的密度差异标记冠层顶部点、冠层中部点和地面附近点；滤除无效的冠层中部点，保留有效的冠层顶部点和地面附近点；所述真实地面点提取单元，用于对地面附近点进行合并，应用随即一致性抽样算法提取地面点；所述拟合缺失地面点单元，用于根据所提取真实地面点，拟合部分冠层下的缺失地面点；所述作物高度估测单元，用于根据冠层顶部点和拟合地面点，计算采样点的种植物高度。
说明书desc
技术领域本发明涉及点云数据处理技术领域，特别是一种基于点云数据的地面点拟合、作物高度提取的方法及系统。背景技术农作物高度在准确监测作物生长状况、预测作物产量和优化农业生产管理方面发挥着重要作用，本发明中的农作物高度是指从顶部到地面的距离。传统的作物高度估算方法主要是逐层统计和大面积野外人工测量，但存在测量时间和人力资源的浪费，以及空间分布信息的缺乏等主要问题。过去随着遥感技术的快速发展，有很多基于卫星遥感影像的大面积植被研究。例如，通过计算不同的植被指数，提取作物信息来评价作物生长状况。然而，通过对单一遥感影像的解读来计算作物参数仍有很多局限性，如云雾的遮挡、影像拍摄的时间限制和植被冠层结构信息的缺乏等。近年来，利用LiDAR获取农作物信息的方法已经出现。作为一种主动式遥感技术，LiDAR通过对其获得的点云进行处理，可以有效地重建冠层结构，且不受时间限制，是一种准确提取作物参数的技术方法。随着计算机视觉的发展，通过SfM算法即可基于数字影像进行三维重建，进而生成正射影像、数字表面模型和三维点云等。SfM是一种计算机视觉技术，它结合了多视角立体图像来匹配特征，推导出三维结构，并估计相机的位置和方向。相比于在日常应用中价格昂贵的LiDAR设备，相反SfM使用移动的相机来确定静止目标的空间和几何关系，只需要一个普通的数码相机就可以准确地进行三维重建，生成与激光雷达数据相似的三维点云，同时成本较低，应用范围广。此外无人机有着结构简单、使用成本低且机动性高的优势，无人机遥感是当前研究的热点课题，现已逐步从研究开发发展到了实际应用阶段，成为未来的主要航空遥感技术之一。目前，基于数字影像或激光雷达生成三维点云的过程中，并没有区分和标记被测物的种类。因此在处理点云时需要先对地面点和目标物进行区分，或是对异常值进行滤波后才能获得有效信息，常见的有阈值滤波、移动长方体滤波、布料滤波，渐进三角网加密等方法。随着过滤方法和应用场景的多样化，阈值的选定也越来越复杂。尽管以上方法适用于了绝大多数的应用场景，但对于基于SfM生成的农作物的点云来说，作物之间的狭小间距导致不同株叶片之间存在着不同程度的遮挡现象，这使得部分作物下方的土壤无法被无人机影像采集。所以在这种地面点残缺的情况下，点云无法满足以上方法对样本的要求。当前虽然有很多基于无人机点云提取农作物参数的研究，其中大部分是以去除离群点为主要思路改善作物高度的提取精度，但是，实际上在更加广泛的作物区中，地形起伏往往会给作物高度的提取带来更加明显的误差，因而，通过去除离群点来提高提取作物高度的精度的方法是无法地形起伏带来的误差。发明内容有鉴于此，本发明的目的在于提供一种基于点云数据的地面点拟合、作物高度提取的方法及系统，该方法利用基于无人机采集的点云数据进行拟合地面点以及提取农作物高度。为达到上述目的，本发明提供如下技术方案：本发明提供的基于点云数据的地面点拟合方法，包括以下步骤：获取带有种植物区域的三维点云数据；根据点云数据确定种植物冠层数据信息；根据冠层数据信息和地面起伏信息确定地面点云数据；根据地面点云数据拟合缺失高程数据的地面点。进一步，所述种植物冠层数据信息按照以下步骤确定：根据种植物间距将点云数据分区，建立包围盒并根据包围盒构建切片；对包围盒中各切片的点云数据进行密度聚类得到密度聚类中心；根据各切片的密度聚类中心之间的差异标记冠层顶部点、冠层中部点和地面附近点。进一步，所述地面点数据按照以下步骤确定：根据地面起伏情况合并预设范围内的地面附近点；随机选取地面附近点中的N个样本点进行平面拟合，并根据地面起伏情况，设置容差范围，找出距离拟合平面在容差范围内的点，并统计内点个数δ；重复选取样本点进行内点数标记和统计，直到符合迭代结束条件，选取内点个数δ最大时的拟合平面作为提取结果，所述内点为是地面点云数据。进一步，所述包围盒与切片的构建是按照以下步骤来进行的：根据子区域的点云分布建立包围盒，在z轴方向从下到上将点云分为多个厚度为H1的切片，另外再从上到下将点云分为多个厚度为H2的切片，两次切片厚度H1、H2分别根据地面起伏情况和冠层顶部点云厚度设置。进一步，还包括以下步骤：根据包围盒中点云数据的高程信息进行密度聚类，如果得到两个聚类中心，再按照这两个聚类中心的高低标记冠层点与地面附近点；如果存在一个聚类中心，则根据临近包围盒内的聚类中心判断点云种类。进一步，还包括以下步骤：比较包围盒下半部分和上半部分中每个切片内的点数与所有切片中点数平均值的大小，若某个切片内的点数小于平均值，则其中的内点被认为是无效的中部冠层点或离群点并被滤除。进一步，所述拟合缺失高程数据的地面点是按照以下步骤进行的：合并所有地面点，构建KNN查找表，根据水平距离和所需样本数量查找任意冠层点下方的地面点云数据；根据地面点云数据与该冠层点云数据的水平距离分配权重；计算地面点云数据的加权平均高度，作为该冠层点正下方的地面高度；按照上述操作，遍历所有冠层点，得到种植物区域的拟合地面高度。本发明提供的根据权利要求1-7中任一项所述的方法来提取种植物高度的方法，包括以下步骤：根据利用地面点云数据拟合的地面点以及带有种植物的三维点云数据得到种植物区域的地面点；根据带有种植物区域的三维点云数据得到的种植物的冠层顶部点；根据冠层顶部点和拟合后的地面点，计算采样区域内的种植物高度。本发明提供的基于无人机点云和地面点拟合的农作物高度提取系统，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现权利要求8所述方法的步骤。本发明提供的基于无人机点云和地面点拟合的农作物高度提取系统，包括数据获取单元、冠层切片滤波器、真实地面点提取单元、拟合缺失地面点单元、作物高度估测单元；所述数据获取单元，用于获取农作物种植区域的无人机影像，通过SfM算法生成的三维点云；所述冠层切片滤波器，用于对原始点云进行预处理，根据实际作物种植间距将点云分区，构建包围盒与内部切片；对包围盒中的点云进行聚类，初步判断点云种类；根据各切片的密度差异标记冠层顶部点、冠层中部点和地面附近点；滤除无效的冠层中部点，保留有效的冠层顶部点和地面附近点；所述真实地面点提取单元，用于对地面附近点进行合并，应用随即一致性抽样算法提取地面点；所述拟合缺失地面点单元，用于根据所提取真实地面点，拟合部分冠层下的缺失地面点；所述作物高度估测单元，用于根据冠层顶部点和拟合地面点，计算采样点的农作物高度。本发明的有益效果在于：本发明提供的基于点云数据的地面点拟合、提取种植物高度的方法及系统，相比于激光雷达扫描生成作物点云，通过无人机搭载数字相机拍摄的影像也可以生成效果相似的点云，且耗费的成本低很多。本方法通过提取点云中实际存在的地面点，对点云各部分的有效程度进行了分析。针对作物高度，冠层顶部和地面附近的点云是有效部分，余下的部分为无效点云和离群点。通过基于高程和坡度来提取地面点，克服了地形起伏对提取作物高度带来的误差，该方法基于真实地面点对缺失地面点的高程进行拟合，消除地形起伏所产生的误差，适用性更高，进而从原始点云中滤出有效点云进行就可以进行作物高度的提取，同时排除无效点云的干扰，降低后续处理的复杂程度。本发明提出的冠层切片滤波方法可以根据点云中各部分的密度差异将冠层顶部与地面附近的点云分离出来，同时还滤除了冠层上方和地面下方的离群点，从而排除了地面点提取过程中的干扰项。本发明的其他优点、目标和特征在某种程度上将在随后的说明书中进行阐述，并且在某种程度上，基于对下文的考察研究对本领域技术人员而言将是显而易见的，或者可以从本发明的实践中得到教导。本发明的目标和其他优点可以通过下面的说明书来实现和获得。附图说明为了使本发明的目的、技术方案和有益效果更加清楚，本发明提供如下附图进行说明：图1为本发明的整体方法流程示意图。图2为本发明具体实施方案中冬小麦农田研究区示意图，所选研究区为加拿大安大略省东南部墨尔本附近的冬小麦种植区。图3为本发明具体实施方案中应用的冠层切片滤波器示意图。图4为本方面具体实施方案中提取地面点的过程示意图。图5为本方面具体实施方案中拟合缺失地面点的过程示意图。图6为本发明具体实施方案中获得的拟合地面点与冬小麦估测高度制图。图7为本发明具体实施方案中获得的冬小麦估测高度与实测高度的相关性散点图。具体实施方式下面结合附图和具体实施例对本发明作进一步说明，以使本领域的技术人员可以更好的理解本发明并能予以实施，但所举实施例不作为对本发明的限定。实施例1本实施例提供的基于点云数据的地面点拟合方法，包括以下步骤：首先，获取带有种植物区域的三维点云数据；然后，根据点云数据确定种植物冠层数据信息；所述种植物冠层数据信息按照以下步骤确定：根据种植物间距将点云数据分区，建立包围盒并根据包围盒构建切片；所述包围盒与切片的构建是按照以下步骤来进行的：根据子区域的点云分布建立包围盒，在z轴方向从下到上将点云分为多个厚度为H1的切片，另外再从上到下将点云分为多个厚度为H2的切片，两次切片厚度H1、H2分别根据地面起伏情况和冠层顶部点云厚度设置；对包围盒中各切片的点云数据进行密度聚类得到密度聚类中心；根据包围盒中点云数据的高程信息进行密度聚类，如果得到两个聚类中心，再按照这两个聚类中心的高低标记冠层点与地面附近点；如果存在一个聚类中心，则根据临近包围盒内的聚类中心判断点云种类。比较包围盒下半部分和上半部分中每个切片内的点数与所有切片中点数平均值的大小，若某个切片内的点数小于平均值，则其中的内点被认为是无效的中部冠层点或离群点并被滤除。根据各切片的密度聚类中心之间的差异标记冠层顶部点、冠层中部点和地面附近点。再次，根据冠层数据信息和地面起伏信息确定地面点云数据；所述地面点数据按照以下步骤确定：根据地面起伏情况合并预设范围内的地面附近点；随机选取地面附近点中的N个样本点进行平面拟合，并根据地面起伏情况，设置容差范围，找出距离拟合平面在容差范围内的点，并统计内点个数δ；重复选取样本点进行内点数标记和统计，直到符合迭代结束条件，选取内点个数δ最大时的拟合平面作为提取结果，所述内点为是地面点云数据。最后，根据地面点云数据拟合缺失高程数据的地面点，所述拟合缺失高程数据的地面点是按照以下步骤进行的：合并所有地面点，构建KNN查找表，根据水平距离和所需样本数量查找任意冠层点下方的地面点云数据；根据地面点云数据与该冠层点云数据的水平距离分配权重；计算地面点云数据的加权平均高度，作为该冠层点正下方的地面高度；按照上述操作，遍历所有冠层点，得到种植物区域的拟合地面高度。实施例2本实施例提供的基于无人机点云和地面点拟合的农作物高度提取方法，通过提取真实地面点并拟合缺失地面点的方式实现对地形起伏的真实还原，消除地形起伏对冬小麦高度提取的干扰。此外应用冠层切片滤波器优化地面点的提取过程，获取原始点云中的有效信息，包括以下步骤：步骤1.获取农作物种植区域的无人机影像，通过SfM算法生成的三维点云；步骤2.对原始点云进行预处理，包括数据裁剪和格式转换；步骤3.根据实际作物种植间距将点云分区，构建包围盒与内部切片；步骤4.对包围盒中的点云进行聚类，初步判断点云种类；步骤5.根据各切片的密度差异标记冠层顶部点、冠层中部点和地面附近点；步骤6.滤除无效的冠层中部点，保留有效的冠层顶部点和地面附近点；步骤7.对地面附近点进行合并，应用RANSAC提取地面点；步骤8.根据所提取真实地面点，拟合部分冠层下的缺失地面点；步骤9.根据冠层顶部点和拟合地面点，计算采样点的农作物高度。本实施例步骤3中所述包围盒与切片的构建是按照以下步骤来进行的：根据子区域的点云分布建立包围盒，在z轴方向从下到上将点云分为多个厚度为H1的切片，另外再从上到下将点云分为多个厚度为H2的切片，两次切片厚度H1、H2分别根据地面起伏情况和冠层顶部点云厚度设置。本实施例步骤4中点云种类的判断是按照以下步骤进行的：在作物的SfM点云中，中部冠层因受到顶部冠层的遮挡，点云分布相比冠层顶部点和地面附近点更稀疏。因此根据包围盒中点云数据的高程信息进行密度聚类，通常能够得到两个聚类中心，再按照这两个聚类中心的高低标记冠层点与地面附近点；若只存在一个聚类中心，则根据临近包围盒内的聚类中心判断点云种类。本实施例步骤5、6中根据密度差异过滤点云是按照以下步骤进行的：在第一次和第二次构建切片时，分别比较包围盒下半部分和上半部分中每个切片内的点数与所有切片中点数平均值的大小，若某个切片内的点数小于平均值，则其中的内点被认为是无效的中部冠层点或离群点并被滤除。本实施例步骤7中提取地面点是按照以下步骤进行的：根据地面起伏情况合并一定范围内的地面附近点，保证地面起伏的连续性；随机选取地面附近点中的N个样本点进行平面拟合，并根据地面起伏情况，设置容差范围，找出距离拟合平面在容差范围内的点，并统计内点个数δ；重复选取样本点进行内点数标记和统计，直到符合迭代结束条件，选取内点数δ最大时的拟合平面作为提取结果，其中内点被认为是地面点。本实施例步骤8中拟合缺失地面点是按照以下步骤进行的：合并所有地面点，构建KNN查找表，根据水平距离和所需样本数量查找任意冠层点下方的相关真实地面点；根据真实地面点与该冠层点的水平距离分配权重；计算这些地面点的加权平均高度，作为该冠层点正下方的地面高度；按照上述操作，遍历所有冠层点，得到种植区完整的拟合地面高度。本实施例步骤9中农作物高度即是冠层顶点与对应拟合地面点的高度差值。实施例3如图1和图2所示，图1为本发明的整体方法流程示意图，图2为本发明具体实施方案中冬小麦农田研究区示意图，所选研究区为加拿大安大略省东南部墨尔本附近的冬小麦种植区，并按照图2中采样点分布在不同观测日期对冬小麦高度进行实际测量。本实施例提供的基于无人机点云和地面点拟合的农作物高度提取方法，包括以下步骤：步骤1：在研究区内均匀设定32个采样点，测量冬小麦在生长周期内的高度变化情况。在此过程中，同步拍摄实验区的无人机数字影像，利用SfM算法基于无人机影像生成包含三维坐标的点云数据。步骤2：对原始无人机点云进行预处理，裁剪出150m×250m作物区点云，提取三维坐标。步骤3：对子区域建立包围盒，并在z轴方向从下到上将点云分为多个厚度为5cm的切片，如图3所示，图3为本发明具体实施方案中应用的冠层切片滤波器示意图；图3中表示某一子区域内原始点云的侧视图；表示根据子区域内原始点云构建的5cm切片滤波器，该区域内共分为10层切片，其中第1-5层切片为滤波器内部；表示根据子区域内原始点云构建的10cm切片滤波器，该区域内共分为5层切片，其中第1-3层切片为滤波器内部；表示某一子区域内只含有冠层点或只含有地面点的情况。计算子区域内所有切片内的点数平均值N5cm，并比较包围盒下半部分中每个切片内点数Nidown与平均值N5cm的大小；如果Nidown＜N5cm，则认为第i个切片内的点云为无效冠层点云；如果Nidown≥N5cm，则认为第i个切片内的点云为有效点云，即为地面点和少量冠层点云。同理在z轴方向将包围盒从上到下重新将点云分为多个厚度为10cm的切片，比较包围盒上半部分中每个切片内点数Niup与新的切片内点数平均值N10cm的大小，从而得到包围盒上半部分的有效点云，即为冠层顶部点，如图4所示；图4为本方面具体实施方案中提取地面点的过程示意图。图4中的表示在某一次迭代过程中，RANSAC模型选中的地面点示意图，显然地面点提取效果较差，在达到迭代终止条件前，继续迭代；表示在某一次迭代过程中，RANSAC模型选中的地面点示意图，地面点提取效果仍然较差，在达到迭代终止条件前，继续迭代；表示在某一次迭代过程中，RANSAC模型选中的地面点示意图，地面点提取效果相对其他迭代结果较好。在达到迭代终止条件后，应用本次迭代中RANSAC模型选中的地面点结果作为地面点提取结果；表示按照上述过程应用RANSAC模型的地面点提取结果。步骤4：但实际上并不是所有的子区域内都含有冠层顶部和地面附近两部分的有效点云，如图3所示。因此先对子区域内的点云高程进行聚类分析，当点云高程集中于两个不同值时，就认为存在两部分有效点云，并按照两个聚类中心的高低分为上聚类中心和下聚类中心，再进行上述操作；当点云高程集中于一个值时，就认为只存在一部分有效点云，并判断该值与相邻子区域的聚类中心中哪一个更接近，若更接近下聚类中心，就认为该部分中的有效点云为地面附近的点云，进行5cm切片滤波；若更接近上聚类中心，就认为该部分中的有效点云为冠层顶部的点云，进行10cm切片滤波。步骤5：对于下半部分的有效点云，首先按照10m×10m将子区域合并为新的子区域，从而保证地面点的连续性；随机选取3个样本点进行平面拟合，根据地面点的起伏情况，设置容差范围为5cm，找出距离拟合平面在容差范围内的点，并统计内点个数δ；重复上述操作，直到符合迭代结束条件；对比每一次拟合后平面的内点个数δ，选取δ最大时的平面作为最终的拟合结果，如图5所示；图5为本方面具体实施方案中拟合缺失地面点的过程示意图。图5中j表示任意一个冠层点；Hupj表示冠层点j的实际高度，也就是该处作物的上顶点高度；Hgroundj表示冠层点j正下方的地面拟合高度，也就是该处作物的下顶点高度；左上部分表示某一子区域内冠层点云的分布；右上部分表示该子区域内冠层点云的侧视图；左下部分表示该子区域内所提取地面点的分布。步骤6：首先任意选取冠层顶部点云，即上部有效点云中的一点j，寻找这一点在XY平面上20m范围内最近的50个地面点，如图5所示；按照所选地面点与这一点间的水平距离分配权重；Wx是第x个被选中的真实地面点的权重，Rx是冠层点j的水平距离；计算这些地面点的加权平均高程Hgroundj作为作物点j正下方的地面点高程；Hx是第x个被选中的真实地面点的高度；该处的作物高度Hj便是作物点j的高程Hupj与地面点高程Hgroundj的差值；Hj＝Hupj-Hgroundj按照上述操作遍历所有冠层顶部点，就拟合出了研究区内完整的地面点，并得到了各处的作物高度，如图6所示；图6为本发明具体实施方案中获得的拟合地面点与冬小麦估测高度制图；图6中的表示研究区域内缺失的地面点拟合结果；表示研究区域内各处的冬小麦高度估测结果。步骤7：计算采样期内冬小麦估测高度的均方根误差和平均绝对误差，其中以均方根误差来描述估测值与实际值之间的偏差，以平均绝对误差来描述估测值误差的实际情况，并以R方来描述在这六天内不同估测流程下线性拟合度的高低，如图7所示；图7为本发明具体实施方案中获得的冬小麦估测高度与实测高度的相关性散点图；图7中，R2表示回归直线对冬小麦高度估测值的拟合程度；RMSE表示均方根误差，用来衡量冬小麦高度估测值与实测值之间的偏差；MAE表示平均绝对误差，是绝对误差的平均值，能更好地反映冬小麦高度估测值误差的实际情况。实施例4本实施例提供的基于无人机点云和地面点拟合的农作物高度提取系统，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现权利要求8所述方法的步骤。实施例5本实施例提供的基于无人机点云和地面点拟合的农作物高度提取系统，包括数据获取单元、冠层切片滤波器、真实地面点提取单元、拟合缺失地面点单元、作物高度估测单元；所述数据获取单元，用于获取农作物种植区域的无人机影像，通过SfM算法生成的三维点云；所述冠层切片滤波器，用于对原始点云进行预处理，根据实际作物种植间距将点云分区，构建包围盒与内部切片；对包围盒中的点云进行聚类，初步判断点云种类；根据各切片的密度差异标记冠层顶部点、冠层中部点和地面附近点；滤除无效的冠层中部点，保留有效的冠层顶部点和地面附近点；所述真实地面点提取单元，用于对地面附近点进行合并，应用随即一致性抽样算法提取地面点；所述拟合缺失地面点单元，用于根据所提取真实地面点，拟合部分冠层下的缺失地面点；所述作物高度估测单元，用于根据冠层顶部点和拟合地面点，计算采样点的农作物高度。以上所述实施例仅是为充分说明本发明而所举的较佳的实施例，本发明的保护范围不限于此。本技术领域的技术人员在本发明基础上所作的等同替代或变换，均在本发明的保护范围之内。本发明的保护范围以权利要求书为准。
