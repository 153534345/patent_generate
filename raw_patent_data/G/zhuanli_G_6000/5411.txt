标题title
双天线航向角的安装误差估计方法和调整方法及相关设备
摘要abst
本发明涉及自动驾驶领域，公开了一种双天线航向角的安装误差估计方法和调整方法及相关设备。该安装误差估计方法包括：获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建安装误差变量与至少一个系统状态变量之间的状态关系；对各系统状态变量进行状态传播，并根据状态传播的结果和状态关系，对安装误差变量执行状态更新，得到误差更新结果；基于误差更新结果，确定安装误差变量对应的安装误差值。本发明实现了对双天线航线角的安装误差的估计并对双天线航向角进行调整。
权利要求书clms
1.一种双天线航向角的安装误差估计方法，其特征在于，所述安装误差估计方法包括：获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；对各所述系统状态变量进行状态传播，并根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果；基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。2.根据权利要求1所述的安装误差估计方法，其特征在于，所述根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果包括：根据状态传播的结果，确定各所述系统状态变量对应的状态值，并根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果；判断所述系统更新结果是否满足预置收敛条件；若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果。3.根据权利要求2所述的安装误差估计方法，其特征在于，所述构建所述安装误差变量与至少一个系统状态变量之间的状态关系包括：提取所述系统状态变量中的安装误差变量和系统航向角变量，并采用所述安装误差变量和所述系统航向角变量构建残差模型；计算所述残差模型相对于各所述系统状态变量的雅可比矩阵，并将所述残差模型和所述雅可比矩阵作为所述安装误差变量与所述系统状态变量之间的状态关系。4.根据权利要求3所述的安装误差估计方法，其特征在于，所述基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果包括：基于所述系统更新结果，确定所述安装误差变量当前的安装误差值、以及各所述系统状态变量对应的离散信息；根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数，并根据所述增益系数和所述残差模型，计算所述安装误差值对应的修正量；根据所述修正量对所述安装误差值进行调整，得到误差更新结果。5.根据权利要求4所述的安装误差估计方法，其特征在于，在所述根据所述修正量对所述安装误差值进行调整，得到误差更新结果之后，还包括：基于所述增益系数和所述雅可比矩阵，对所述离散信息进行更新，并根据更新后的离散信息，跳转执行所述根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数的步骤，直到最终调整的安装误差值满足预置退出条件时停止，得到最终的误差更新结果。6.根据权利要求2-5中任一项所述的安装误差估计方法，其特征在于，所述判断所述系统更新结果是否满足预置收敛条件包括：基于所述系统更新结果，确定各所述系统状态变量对应的离散信息和修正状态值，并判断所述离散信息是否满足预置离散条件；若所述离散信息不满足预置离散条件，则确定所述系统更新结果不满足预置收敛条件，否则判断所述修正状态值中的系统航向角是否满足预置偏差条件；若所述系统航向角满足预置偏差条件，则确定所述系统更新结果满足所述收敛条件，否则确定所述系统更新结果不满足所述收敛条件。7.一种双天线航向角的调整方法，其特征在于，所述双天线航向角的调整方法包括：获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；对各所述系统状态变量进行状态传播，并根据状态传播的结果，确定各所述系统状态变量对应的状态值；根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果，并判断所述系统更新结果是否满足预置收敛条件；若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果；基于所述误差更新结果，确定所述安装误差变量对应的安装误差值，并采用所述安装误差值对所述双天线航向角进行调整。8.一种双天线航向角的安装误差估计装置，其特征在于，所述安装误差估计装置包括：构建模块，用于获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；更新模块，用于对各所述系统状态变量进行状态传播，并根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果；确定模块，用于基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。9.一种双天线航向角的调整装置，其特征在于，所述调整装置包括：构建模块，用于获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；传播模块，用于对各所述系统状态变量进行状态传播，并根据状态传播的结果，确定各所述系统状态变量对应的状态值；系统更新模块，用于根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果，并判断所述系统更新结果是否满足预置收敛条件；误差更新模块，用于若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果；调整模块，用于基于所述误差更新结果，确定所述安装误差变量对应的安装误差值，并采用所述安装误差值对所述双天线航向角进行调整。10.一种计算机设备，其特征在于，所述计算机设备包括：存储器和至少一个处理器，所述存储器中存储有指令；所述至少一个处理器调用所述存储器中的所述指令，以使得所述计算机设备执行如权利要求1-6中任意一项所述的双天线航向角的安装误差估计方法的步骤；或者，所述至少一个处理器调用所述存储器中的所述指令，以使得所述计算机设备执行如权利要求7所述的双天线航向角的调整方法的步骤。11.一种计算机可读存储介质，所述计算机可读存储介质上存储有指令，其特征在于，所述指令被处理器执行时实现如权利要求1-6中任意一项所述双天线航向角的安装误差估计方法的步骤；或者，所述指令被处理器执行时实现如权利要求7中任意一项所述双天线航向角的调整方法的步骤。
说明书desc
技术领域本发明涉及自动驾驶领域，尤其涉及一种双天线航向角的安装误差估计方法和调整方法及相关设备。背景技术无人车定位技术主要基于融合IMU、轮速计、RTK、激光雷达和相机等传感器进行多源传感器融合定位，当视觉地图或激光点云地图有效时，融合定位模块的航向角主要基于视觉或激光点云地图匹配结果进行收敛。当地图无效时，融合定位模块的航向角主要由RTK和IMU进行间接观测航向角、或通过RTK双天线进行定姿。当地图和RTK都有效时，多源航向角观测共同参与航向角状态估计。现有融合定位中，RTK双天线安装轴与IMU航向方向安装重合，将RTK双天线观测航向角作为IMU航向观测直接用于EKF状态更新。当RTK双天线安装位置不足够精确，RTK双天线航向角只能代表RTK双天线轴的航向角，并不能表示IMU航向角。因此用其直接进行状态更新，会将RTK双天线安装的固定误差引入状态估计器中，从而带偏自动驾驶系统中定位模块的航向角。发明内容本发明的主要目的在于解决现有双天线航向角在用于系统航向角估计算时，存在因安装位置不够准确而存在误差的技术问题。本发明第一方面提供了一种双天线航向角的安装误差估计方法，包括：获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；对各所述系统状态变量进行状态传播，并根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果；基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。可选的，在本发明第一方面的第一种实现方式中，所述根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果包括：根据状态传播的结果，确定各所述系统状态变量对应的状态值，并根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果；判断所述系统更新结果是否满足预置收敛条件；若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果。可选的，在本发明第一方面的第二种实现方式中，所述构建所述安装误差变量与至少一个系统状态变量之间的状态关系包括：提取所述系统状态变量中的安装误差变量和系统航向角变量，并采用所述安装误差变量和所述系统航向角变量构建残差模型；计算所述残差模型相对于各所述系统状态变量的雅可比矩阵，并将所述残差模型和所述雅可比矩阵作为所述安装误差变量与所述系统状态变量之间的状态关系。可选的，在本发明第一方面的第三种实现方式中，所述基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果包括：基于所述系统更新结果，确定所述安装误差变量当前的安装误差值、以及各所述系统状态变量对应的离散信息；根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数，并根据所述增益系数和所述残差模型，计算所述安装误差值对应的修正量；根据所述修正量对所述安装误差值进行调整，得到误差更新结果。可选的，在本发明第一方面的第四种实现方式中，在所述根据所述修正量对所述安装误差值进行调整，得到误差更新结果之后，还包括：基于所述增益系数和所述雅可比矩阵，对所述离散信息进行更新，并根据更新后的离散信息，跳转执行所述根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数的步骤，直到最终调整的安装误差值满足预置退出条件时停止，得到最终的误差更新结果。可选的，在本发明第一方面的第五种实现方式中，所述判断所述系统更新结果是否满足预置收敛条件包括：基于所述系统更新结果，确定各所述系统状态变量对应的离散信息和修正状态值，并判断所述离散信息是否满足预置离散条件；若所述离散信息不满足预置离散条件，则确定所述系统更新结果不满足预置收敛条件，否则判断所述修正状态值中的系统航向角是否满足预置偏差条件；若所述系统航向角满足预置偏差条件，则确定所述系统更新结果满足所述收敛条件，否则确定所述系统更新结果不满足所述收敛条件。本发明第二方面提供了一种双天线航向角的调整方法，包括：获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；对各所述系统状态变量进行状态传播，并根据状态传播的结果，确定各所述系统状态变量对应的状态值；根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果，并判断所述系统更新结果是否满足预置收敛条件；若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果；基于所述误差更新结果，确定所述安装误差变量对应的安装误差值，并采用所述安装误差值对所述双天线航向角进行调整。本发明第三方面提供了一种双天线航向角的安装误差估计装置，包括：构建模块，用于获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；更新模块，用于对各所述系统状态变量进行状态传播，并根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果；确定模块，用于基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。可选的，在本发明第三方面的第一种实现方式中，所述更新模块包括：系统更新单元，用于根据状态传播的结果，确定各所述系统状态变量对应的状态值，并根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果；判别单元，用于判断所述系统更新结果是否满足预置收敛条件；误差更新单元，用于若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果。可选的，在本发明第三方面的第二种实现方式中，所述构建模块包括：构建单元，用于提取所述系统状态变量中的安装误差变量和系统航向角变量，并采用所述安装误差变量和所述系统航向角变量构建残差模型；计算单元，用于计算所述残差模型相对于各所述系统状态变量的雅可比矩阵，并将所述残差模型和所述雅可比矩阵作为所述安装误差变量与所述系统状态变量之间的状态关系。可选的，在本发明第三方面的第三种实现方式中，所述误差更新单元还用于：基于所述系统更新结果，确定所述安装误差变量当前的安装误差值、以及各所述系统状态变量对应的离散信息；根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数，并根据所述增益系数和所述残差模型，计算所述安装误差值对应的修正量；根据所述修正量对所述安装误差值进行调整，得到误差更新结果。可选的，在本发明第三方面的第四种实现方式中，所述更新模块包括循环单元，用于：基于所述增益系数和所述雅可比矩阵，对所述离散信息进行更新，并根据更新后的离散信息，跳转执行所述根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数的步骤，直到最终调整的安装误差值满足预置退出条件时停止，得到最终的误差更新结果。可选的，在本发明第三方面的第五种实现方式中，所述判别单元还用于：基于所述系统更新结果，确定各所述系统状态变量对应的离散信息和修正状态值，并判断所述离散信息是否满足预置离散条件；若所述离散信息不满足预置离散条件，则确定所述系统更新结果不满足预置收敛条件，否则判断所述修正状态值中的系统航向角是否满足预置偏差条件；若所述系统航向角满足预置偏差条件，则确定所述系统更新结果满足所述收敛条件，否则确定所述系统更新结果不满足所述收敛条件。本发明第四方面提供了一种双天线航向角的调整装置，包括：构建模块，用于获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；传播模块，用于对各所述系统状态变量进行状态传播，并根据状态传播的结果，确定各所述系统状态变量对应的状态值；系统更新模块，用于根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果，并判断所述系统更新结果是否满足预置收敛条件；误差更新模块，用于若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果；调整模块，用于基于所述误差更新结果，确定所述安装误差变量对应的安装误差值，并采用所述安装误差值对所述双天线航向角进行调整。本发明第五方面提供了一种计算机设备，包括：存储器和至少一个处理器，所述存储器中存储有指令；所述至少一个处理器调用所述存储器中的所述指令，以使得所述计算机设备执行上述的双天线航向角的安装误差估计方法或者上述的双天线航向角的调整方法。本发明的第六方面提供了一种计算机可读存储介质，所述计算机可读存储介质中存储有指令，当其在计算机上运行时，使得计算机执行上述的双天线航向角的安装误差估计方法或者上述的双天线航向角的调整方法。本发明提供的技术方案中，通过将双天线的安装误差作为待估计量添加到系统状态变量中作为安装误差变量，并构建安装误差变量和系统状态变量之间的状态关系，比如残差模型、雅可比矩阵，并采用状态关系和各个系统状态变量传播的结果对该安装误差变量进行状态更新，比如应用EKF模型，来计算和更新安装误差值，以用于后续的双天线航向角的调整，使得双天线航向角调整后再融合进状态估计框架中能正常收敛系统的航向角且不产生固定偏差，提升双天线航向角降低因安装问题而带来的安装误差。附图说明图1为本发明双天线航向角的安装误差估计方法的一个实施例示意图；图2为本发明双天线航向角的安装误差估计方法的另一个实施例示意图；图3为本发明实施例中双天线航向角的调整方法的一个实施例示意图；图4为本发明双天线航向角的安装误差估计装置的一个实施例示意图；图5为本发明双天线航向角的安装误差估计装置的另一个实施例示意图；图6为本发明双天线航向角的调整装置的一个实施例示意图；图7为本发明实施例中计算机设备的一个实施例示意图。具体实施方式本发明实施例提供了一种双天线航向角的安装误差估计方法和调整方法及相关设备，本发明涉及自动驾驶领域，公开了一种双天线航向角的安装误差估计方法和调整方法及相关设备。该安装误差估计方法包括：获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建安装误差变量与至少一个系统状态变量之间的状态关系；对各系统状态变量进行状态传播，并根据状态传播的结果和状态关系，对安装误差变量执行状态更新，得到误差更新结果；基于误差更新结果，确定安装误差变量对应的安装误差值。本发明实现了对双天线航线角的安装误差的估计并对双天线航向角进行调整。本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”、“第三”、“第四”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的实施例能够以除了在这里图示或描述的内容以外的顺序实施。此外，术语“包括”或“具有”及其任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。为便于理解，下面对本发明实施例的具体流程进行描述，请参阅图1，本发明实施例中双天线航向角的安装误差估计方法的第一个实施例包括：101、获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；可以理解的是，本发明的执行主体可以为双天线航向角的安装误差估计装置，还可以是终端或者服务器，具体此处不做限定。本发明实施例以服务器为执行主体为例进行说明。本实施例中，设置双天线航向角的安装误差变量α，然后添加到系统状态变量中，故此处直接可以获取得到包含有安装误差变量的系统状态变量，其中，系统状态变量可以由一个矩阵表示：，包括一个安装误差变量α和除了安装误差变量α之外的n自动驾驶系统的系统状态变量，比如系统状态变量依次为三维姿态、三维位移、三维速度、三维加速度计偏差、三维陀螺仪偏差以及安装误差变量α，共计16个系统状态变量，则n＝15。本实施例中，还可以通过预设算法来构建系统状态变量中安装误差变量和至少一个系统状态变量之间的状态关系，包括两种情况：第一种是安装误差变量与其他部分系统状态变量之间的相关性，第二种是安装误差变量与全部系统状态变量之间的相关性。具体的，针对前面提到的第一种情况，为了估计安装误差变量的值，可以构建关于安装误差变量的残差模型，具体还可以加入与航向角相关的系统状态变量，比如系统航向角、或者共同参与系统航向角观测的其他多源航向角；针对前面提到的第二种情况，还可以构建安装误差变量与每个系统状态变量之间的关系，具体可以以安装误差变量与各个系统状态变量求导，来表示安装误差变量与各个系统状态变量的状态关系。102、对各所述系统状态变量进行状态传播，并根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果；本实施例中，在自动驾驶系统中，可以通过常规的状态传播方法，来传播每个系统状态变量对应的参数值，并作为状态传播的结果，比如使用IMU进行状态传播，可以根据采集到的自动驾驶车辆的速度，来传播得到该自动驾驶车辆的加速度、位移、姿态等，此处不再赘述。本实施例中，对安装误差变量的状态更新过程，包括两部分：第一部分是对系统状态变量进行状态更新，第二部分是再根据系统状态变量的状态更新结果，来对安装误差变量进行状态更新；其中，两部分状态更新的主体流程相同，第二部分执行的判别标准是确定系统状态变量是否收敛到位，可以设置对应的收敛条件来确定；需注意的是，在对系统状态变量进行状态更新时，不对安装误差变量进行状态更新，换言之，在系统状态变量状态更新过程中，安装误差变量不会被更新。103、基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。本实施例中，误差更新结果至少包括安装误差变量对应的参数值，故得到误差更新结果后，即可从中提取得到对应的安装误差值。本发明实施例中，通过将双天线的安装误差作为待估计量添加到系统状态变量中作为安装误差变量，并构建安装误差变量和系统状态变量之间的状态关系，比如残差模型、雅可比矩阵，并采用状态关系和各个系统状态变量传播的结果对该安装误差变量进行状态更新，比如应用EKF模型，来计算和更新安装误差值，以用于后续的双天线航向角的调整，使得双天线航向角调整后再融合进状态估计框架中能正常收敛系统的航向角且不产生固定偏差，提升双天线航向角降低因安装问题而带来的安装误差。请参阅图2，本发明实施例中双天线航向角的安装误差估计方法的第二个实施例包括：201、获取包含双天线航向角的安装误差变量的多个系统状态变量，并提取所述系统状态变量中的安装误差变量和系统航向角变量，并采用所述安装误差变量和所述系统航向角变量构建残差模型；202、计算所述残差模型相对于各所述系统状态变量的雅可比矩阵，并将所述残差模型和所述雅可比矩阵作为所述安装误差变量与所述系统状态变量之间的状态关系；本实施例中，系统状态变量中还至少包括有一个系统航向角变量，通过提取安装误差变量和系统航向角变量，来构建残差模型，设置双天线航向角变量为x，系统航向角变量为y，r为残差值，则该残差模型为：r＝x+α-y，若各个系统状态变量以一个1*16的矩阵表示，则第1-16个元素表示顺序排列的16个系统状态变量，若第3个元素为系统航向角变量对应的雅可比矩阵子块，第16个元素为安装误差变量对应的雅可比矩阵子块，则根据该残差模型可以计算得到相对于系统状态变量的雅可比矩阵：H＝；最终通过一个残差模型和一个对应的雅可比矩阵来表示安装误差变量和系统状态变量之间的状态关系。其中，可以通过设置雅可比矩阵H中安装误差变量对应矩阵字块的值，来切换对安装误差变量的状态更新过程的两部分：将该安装误差变量对应矩阵字块的值将“-1”切换为“0”，则对系统状态变量进行状态更新，而不会对安装误差变量进行状态更新，将该安装误差变量对应矩阵字块的值设置不变为“-1”，则可以根据系统状态变量的状态更新结果，来对安装误差变量进行状态更新。203、对各所述系统状态变量进行状态传播，并根据状态传播的结果，确定各所述系统状态变量对应的状态值；204、根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果，并判断所述系统更新结果是否满足预置收敛条件；205、若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果；本实施例中，在对系统状态变量执行状态更新时，可以采用EKF算法来实现，通过状态传播的结果和状态关系，来计算系统状态变量的修正量，以对系统状态变量对应的参数值进行更新。另外，还可以通过设置收敛条件作为优化函数，判别系统状态变量的状态更新的结果是否达到预设的优化程度，以确定是否进行下一部分的对安装误差变量的状态更新。误差更新结果至少包括安装误差变量对应的参数值。其中，具体可以采用系统状态变量对应的协方差、修正状态值等来进行收敛条件的判别；协方差判别表示系统状态变量对应参数值的离散程度，确定各个系统状态变量当前的集中分布在一定范围内，异常值多表示状态更新的结果有误；修正状态值表示状态关系传播计算得到的系统状态变量和实际观测的系统状态变量之间的差别，确定两者之间的差别不能太大。具体收敛的判别过程如下所示：1)基于所述系统更新结果，确定各所述系统状态变量对应的离散信息和修正状态值，并判断所述离散信息是否满足预置离散条件；1)若所述离散信息不满足预置离散条件，则确定所述系统更新结果不满足预置收敛条件，否则判断所述修正状态值中的系统航向角是否满足预置偏差条件；1)若所述系统航向角满足预置偏差条件，则确定所述系统更新结果满足所述收敛条件，否则确定所述系统更新结果不满足所述收敛条件本实施例中，系统更新结果包含有系统状态变量对应的离散信息和修正状态值，而离散信息包括各个系统状态变量对应的协方差，可以以一个16*16的二维对角矩阵表示，其中，Pii为第i个系统状态变量的协方差，具体可以拆分计算得到对应的多个系统状态变量的协方差，包括俯仰角方差、横滚角方差、航向角方差、X方向位移方差、Y方向位移方差、Z方向位移方差、X方向速度方差、Y方向速度方差、Z方向速度方差、IMU加速度计X轴偏差的方差、IMU加速度计Y轴偏差的方差、IMU加速度计Z轴偏差的方差、IMU陀螺仪X轴偏差的方差、IMU陀螺仪Y轴偏差的方差、IMU陀螺仪Z轴偏差的方差、安装误差变量的方差。比如P11为俯仰角方差，P22为横滚角方差，以此类推。本实施例中，另外在对协方差进行开方，得到对应的标准差，可以先设定状态更新的收敛条件中的离散条件：设置标准差阈值Ci，则Pii＜Ci。然后设定状态更新的收敛条件中的偏差条件，可以包括以下几项：v1＜|y-ρ|＜v2；v3＜|y-x|＜v4，其中v3＜|vel|；其中，v1和v2分别是系统方向角和系统航向角偏差的阈值上下限，v3和v4是系统航向角和双天线航向角之差的阈值上下限，同时v3与当前车辆的速度|vel|相关，比如如果双天线航向角与系统航向角没有安装误差引起的偏差，则双天线航向角和系统航向角两者基本没有偏差，如果两者有安装误差引起的固定偏差，该固定偏差与汽车的速度相关，那么该固定偏差可以为一个固定值，如该固定值为18°，则v3和v4可以分别设置为17.5°和18.5°。ρ为通过GPS的速度方向读取值，可以确定汽车行进速度对应的方向，由于汽车只能前后运动，因此可以间接理解为ρ值接近于汽车航向角的值。若状态更新的结果满足上述的收敛条件，则可以进行安装误差变量的估计。当系统更新结果是否满足前述的收敛条件，则确定此时的修正状态值为准确度的，同时更新得到的系统状态状态变量对应的协方差是准确的，则可以进一步采用该系统更新结果来进行下一步对安装误差值的状态更新，具体如下所示：1)基于所述系统更新结果，确定所述安装误差变量当前的安装误差值、以及各所述系统状态变量对应的离散信息；1)根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数，并根据所述增益系数和所述残差模型，计算所述安装误差值对应的修正量；1)根据所述修正量对所述安装误差值进行调整，得到误差更新结果。本实施例中，系统更新结果中还包括安装误差变量当前的安装误差值，即为系统状态变量在完成状态更新后对应计算得到的安装误差值，此时则对该初步得到的安装误差值进行进一步的修正估计。本实施例中，通过执行EKF算法执行对安装误差变量的状态更新，其中，在计算安装误差变量对应的增益系数时，可以通过函数：K＝PHT-1来计算，其中，K为增益系数，即卡尔曼增益，P表示系统状态变量对应的协方差，H为前述的雅可比矩阵，n为观测噪音；因为雅可比矩阵中，安装误差变量对应的矩阵子块不为0，故K实际上仅与安装误差变量相关，进一步的，系统航向角变量对应的矩阵子块也可以不为0，即K也可以与系统航向角相关。然后通过增益系数和残差模型来计算修正量：△X＝K*r，此处K和r因为仅与系统状态变量中的安装误差变量和系统航向角相关，故此处修正量，仅针对安装误差变量和系统航向角进行不断的修正，其他系统状态变量则保持不变。对应的修正状态变量为其中，△X为修正量，r为前述的残差模型，X修正为修正状态变量，X系统为系统状态变量；接着通过增益系数和雅可比矩阵计算离散信息：P＝PT+KnKT，其中P为离散信息即系统状态变量的协方差，I为单位矩阵。其中，“⊕”表示广义的加法。在修正系统状态变量中的位移、速度、陀螺仪偏差、加速度计偏差时，可以将修正量直接与对应的系统状态变量相加从而修正对应的状态变量，即此处直接将安装误差值与修正量相加即可得到误差更新结果。206、基于所述增益系数和所述雅可比矩阵，对所述离散信息进行更新，并根据更新后的离散信息，跳转执行所述根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数的步骤，直到最终调整的安装误差值满足预置退出条件时停止，得到最终的误差更新结果；本实施例中，不断地对误差更新结果进行状态更新，然后通过与前面提到的收敛条件相同，结合更新次数，来设置退出条件，判断误差更新结果是否优化到位，在满足收敛条件之后，即可得到最终的安装误差值。207、基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。请参阅图3，本发明实施例中双天线航向角的调整方法的一个实施例包括：301、获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；302、对各所述系统状态变量进行状态传播，并根据状态传播的结果，确定各所述系统状态变量对应的状态值；303、根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果，并判断所述系统更新结果是否满足预置收敛条件；304、若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果；305、基于所述误差更新结果，确定所述安装误差变量对应的安装误差值，并采用所述安装误差值对所述双天线航向角进行调整。本实施例中，前面已经详细介绍了安装误差值的估计流程，此处不再赘述。根据计算得到的安装误差值α’，结合双天线观测得到的双天线航向角x’，则通过x’±α’即可对双天线航向角进行调整，得到校正后的双天线航向角。另外，由于双天线的安装误差变量只有1维，故双天线航向角的安装误差值主要视为水平面上，双天线轴与参考轴之间的夹角。在估计安装误差变量的安装误差值时，则以参考轴为基准计算安装误差值。其中，针对参考轴，若双天线安装在与IMU的X轴平行的位置，则参考轴为IMU的X轴所在的直线；如果双天线安装在与IMU的Y轴平行的位置，则参考轴为IMU的Y轴所在的直线。后续进行双天线航向角的调整时也是以该参考轴为基准进行调整。本发明实施例中，通过将双天线的安装误差作为待估计量添加到系统状态变量中作为安装误差变量，并构建安装误差变量和系统状态变量之间的状态关系，比如残差模型、雅可比矩阵，并采用状态关系和各个系统状态变量传播的结果对该安装误差变量进行状态更新，比如应用EKF模型，来计算和更新安装误差值，并通过更新后的安装误差值来对双天线航向角进行调整，使得双天线航向角调整后再融合进状态估计框架中能正常收敛系统的航向角且不产生固定偏差，提升双天线航向角降低因安装问题而带来的安装误差。上面对本发明实施例中双天线航向角的安装误差估计方法和调整方法进行了描述，下面先对本发明实施例中双天线航向角的安装误差估计装置进行描述，请参阅图4，本发明实施例中双天线航向角的安装误差估计装置一个实施例包括：构建模块401，用于获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；更新模块402，用于对各所述系统状态变量进行状态传播，并根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果；确定模块403，用于基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。本发明实施例中，通过将双天线的安装误差作为待估计量添加到系统状态变量中作为安装误差变量，并构建安装误差变量和系统状态变量之间的状态关系，比如残差模型、雅可比矩阵，并采用状态关系和各个系统状态变量传播的结果对该安装误差变量进行状态更新，比如应用EKF模型，来计算和更新安装误差值，以用于后续的双天线航向角的调整，使得双天线航向角调整后再融合进状态估计框架中能正常收敛系统的航向角且不产生固定偏差，提升双天线航向角降低因安装问题而带来的安装误差。请参阅图5，本发明实施例中双天线航向角的安装误差估计装置的另一个实施例包括：构建模块401，用于获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；更新模块402，用于对各所述系统状态变量进行状态传播，并根据状态传播的结果和所述状态关系，对所述安装误差变量执行状态更新，得到误差更新结果；确定模块403，用于基于所述误差更新结果，确定所述安装误差变量对应的安装误差值。具体的，所述更新模块402包括：系统更新单元4021，用于根据状态传播的结果，确定各所述系统状态变量对应的状态值，并根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果；判别单元4022，用于判断所述系统更新结果是否满足预置收敛条件；误差更新单元4023，用于若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果。具体的，所述构建模块401包括：构建单元4011，用于提取所述系统状态变量中的安装误差变量和系统航向角变量，并采用所述安装误差变量和所述系统航向角变量构建残差模型；计算单元4012，用于计算所述残差模型相对于各所述系统状态变量的雅可比矩阵，并将所述残差模型和所述雅可比矩阵作为所述安装误差变量与所述系统状态变量之间的状态关系。具体的，所述误差更新单元4023还用于：基于所述系统更新结果，确定所述安装误差变量当前的安装误差值、以及各所述系统状态变量对应的离散信息；根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数，并根据所述增益系数和所述残差模型，计算所述安装误差值对应的修正量；根据所述修正量对所述安装误差值进行调整，得到误差更新结果。具体的，所述更新模块402包括循环单元4024，用于：基于所述增益系数和所述雅可比矩阵，对所述离散信息进行更新，并根据更新后的离散信息，跳转执行所述根据所述离散信息和所述雅可比矩阵，计算所述安装误差变量对应的增益系数的步骤，直到最终调整的安装误差值满足预置退出条件时停止，得到最终的误差更新结果。具体的，所述判别单元4022还用于：基于所述系统更新结果，确定各所述系统状态变量对应的离散信息和修正状态值，并判断所述离散信息是否满足预置离散条件；若所述离散信息不满足预置离散条件，则确定所述系统更新结果不满足预置收敛条件，否则判断所述修正状态值中的系统航向角是否满足预置偏差条件；若所述系统航向角满足预置偏差条件，则确定所述系统更新结果满足所述收敛条件，否则确定所述系统更新结果不满足所述收敛条件。另外，还对本发明实施例中双天线航向角的调整装置进行描述，请参阅图6，本发明实施例中双天线航向角的调整装置的一个实施例包括：构建模块601，用于获取包含双天线航向角的安装误差变量的多个系统状态变量，并构建所述安装误差变量与至少一个系统状态变量之间的状态关系；传播模块602，用于对各所述系统状态变量进行状态传播，并根据状态传播的结果，确定各所述系统状态变量对应的状态值；系统更新模块603，用于根据所述状态值和所述状态关系，对各所述系统状态变量进行状态更新，得到系统更新结果，并判断所述系统更新结果是否满足预置收敛条件；误差更新模块604，用于若满足，则基于所述系统更新结果和所述状态关系，执行对所述安装误差变量的状态更新，得到误差更新结果；调整模块605，用于基于所述误差更新结果，确定所述安装误差变量对应的安装误差值，并采用所述安装误差值对所述双天线航向角进行调整。本发明实施例中，通过将双天线的安装误差作为待估计量添加到系统状态变量中作为安装误差变量，并构建安装误差变量和系统状态变量之间的状态关系，比如残差模型、雅可比矩阵，并采用状态关系和各个系统状态变量传播的结果对该安装误差变量进行状态更新，比如应用EKF模型，来计算和更新安装误差值，并通过更新后的安装误差值来对双天线航向角进行调整，使得双天线航向角调整后再融合进状态估计框架中能正常收敛系统的航向角且不产生固定偏差，提升双天线航向角降低因安装问题而带来的安装误差。上面图4和图5从模块化功能实体的角度对本发明实施例中的双天线航向角的安装误差估计装置进行详细描述，以及上面图6从模块化功能实体的角度对本发明实施例中的双天线航向角的调整装置进行详细描述，下面从硬件处理的角度对本发明实施例中计算机设备进行详细描述。图7是本发明实施例提供的一种计算机设备的结构示意图，该计算机设备700可因配置或性能不同而产生比较大的差异，可以包括一个或一个以上处理器710和存储器720，一个或一个以上存储应用程序733或数据732的存储介质730。其中，存储器720和存储介质730可以是短暂存储或持久存储。存储在存储介质730的程序可以包括一个或一个以上模块，每个模块可以包括对计算机设备700中的一系列指令操作。更进一步地，处理器710可以设置为与存储介质730通信，在计算机设备700上执行存储介质730中的一系列指令操作。计算机设备700还可以包括一个或一个以上电源740，一个或一个以上有线或无线网络接口750，一个或一个以上输入输出接口760，和/或，一个或一个以上操作系统731，例如Windows Serve，Mac OS X，Unix，Linux，FreeBSD等等。本领域技术人员可以理解，图7示出的计算机设备结构并不构成对计算机设备的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。本发明还提供一种计算机设备，所述计算机设备包括存储器和处理器，存储器中存储有计算机可读指令，计算机可读指令被处理器执行时，使得处理器执行上述各实施例中的所述双天线航向角的安装误差估计方法、或者所述双天线航向角的调整方法的步骤。本发明还提供一种计算机可读存储介质，该计算机可读存储介质可以为非易失性计算机可读存储介质，该计算机可读存储介质也可以为易失性计算机可读存储介质，所述计算机可读存储介质中存储有指令，当所述指令在计算机上运行时，使得计算机执行所述双天线航向角的安装误差估计方法、或者所述双天线航向角的调整方法的步骤。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的系统，装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。所述集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上所述，以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
