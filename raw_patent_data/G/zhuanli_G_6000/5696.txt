标题title
一种高精度MPPT控制方法
摘要abst
本发明公开了一种高精度MPPT控制方法，该方法通过记录A、B、C三个参考电压下一段时间T内的N个功率数据，并将每个参考电压下稳定后的M个数据进行横向对比，若参考电压越大的情况下，所对应的功率后M个数据中有不少于M/2个数据也随之更大，则认为需要继续增大参考电压进行追踪；若参考电压越小的情况下，所对应的功率后M个数据中有不少于M/2个数据随之更小，则认为需要减小参考电压进行追踪；若不满足以上情况，则认为已到达最大功率点附近。本发明能够以更快的速度实现MPPT，解决低功率或高PV电压无法精准追踪最大功率点的问题，有效提高了光伏发电系统的稳定性和发电效率。
权利要求书clms
1.一种高精度MPPT控制方法，其特征在于，包括以下步骤：S1、初始化MPPT控制器的参数，包括设置MPPT参考电压值Vref、初始扰动值V0、MPPT参考电压值Vref的上下限幅值以及扫描步长ΔV；S2、启动MPPT控制器，使MPPT参考电压值Vref每隔T时间按照设定步长ΔV减小，逐步达到初始扰动值V0，再采用三点法进行左右扫描；S3、按照步长ΔV间隔取A、B、C三点，A点处的参考电压VrefA＝Vref-ΔV，B点处的参考电压VrefB＝Vref，C点处的参考电压VrefC＝Vref+ΔV，并每隔T时间扫描一次，按照B、C、A的顺序扫描；S4、在B点时，记Vref＝VrefB，每隔T/N记录一次当前功率存入数组PB，T时间内记录N个，为PB～PB，N为正整数；S5、在C点时，记Vref＝VrefC，每隔T/N记录一次当前功率存入数组PC，T时间内记录N个，为PC～PC；S6、在A点时，记Vref＝VrefA，每隔T/N记录一次当前功率存入数组PA，T时间内记录N个，为PA～PA；S7、将C点功率数组和B点功率数组的后M个数据PC～PC和PB～PB一一对比，若有不少于半数的数据为PC＞PB，则认为从B点到C点功率增大，反之则认为从B点到C点功率减小，M为小于N的正整数；S8、将B点功率数组和A点功率数组的后M个数据PB～PB和PA～PA一一对比，若有不少于半数的数据为PB＞PA，则认为从A点到B点功率增大，反之则认为从A点到B点功率减小；S9、若同时满足从B点到C点功率增大，从A点到B点功率增大，则认为最大功率点在当前扫描点的右侧，更新MPPT参考电压为Vref＝VrefC；若同时满足从B点到C点功率减小，从A点到B点功率减小则认为最大功率点在当前扫描点的左侧，更新MPPT参考电压为Vref＝VrefA；若都不满足，则已实现最大功率点追踪，MPPT参考电压不变，为Vref＝VrefB；S9、若连续向左或向右扫描三次及以上，更新步长ΔV，重复步骤S3～S10，以获得实时最大功率点。2.根据权利要求1所述的高精度MPPT控制方法，其特征在于，所述步骤S1中还包括获取当前的PV电压采样值Vpv，设置MPPT参考电压值Vref＝Vpv，所述初始扰动值V0的具体为：判断PV电压采样值Vpv与母线电压Vbus的大小，若PV电压采样值Vpv小于母线电压Vbus则初始扰动值V0＝0.85*Vref，否则初始扰动值V0＝0.95*Vref。3.根据权利要求1所述的高精度MPPT控制方法，其特征在于，所述步骤S1中的扫描步长ΔV＝2V，所述步骤S9中的更新步长ΔV＝4V。4.根据权利要求1所述的高精度MPPT控制方法，其特征在于，所述步骤S4-S6中的功率为电压和电流的乘积，该电压为电压是一段时间内的PV电压平均值不经过滤波的结果Vavg，该电流为一段时间内电感电流有效值经过滤波后的值IrmsFilt。5.根据权利要求1所述的高精度MPPT控制方法，其特征在于，所述N为20，所述M为10。
说明书desc
技术领域本发明涉及光伏发电技术领域，更具体地说，特别涉及一种高精度MPPT控制方法。背景技术光伏发电技术因新能源的大力发展而被广泛而深入的研究。光伏阵列输出特性具有非线性特征，并且还会受太阳光照强度、环境温度和负载情况的影响。在一定的太阳光照强度和环境温度下，光伏阵列只有在某一特定输出电压时，其输出功率才能达到最大值。因此，为了最大限度地利用光伏电池的能量，需要最大功率跟踪技术使得光伏发电系统能实时跟踪光伏电池的最大功率点。目前常用的最大功率点跟踪方法主要有：恒压法、扰动观察法、电导增量法、模糊控制、人工神经网络等，以及以这些技术为基础的改进方法。其中，扰动观察法为最常用的MPPT控制方法，常与恒压法相结合，从一个接近最大功率点电压的初始值开始扰动PV电压值，测其功率变化，与扰动之前的功率值比较，如果功率值增加，则表示扰动方向正确，继续朝同一方向扰动，如果功率值减小，则朝相反的方向扰动，并采用三点法，计算三个点的功率综合比较。现有基于扰动观察法的MPPT算法中，在低功率的情况下，在接近MPP一定电压范围内的功率差距很小，几乎不能比较出大小；而在最大功率点电压很高的情况下，较小的采样偏差就能引起较大的功率波动，这些都会使最大功率点追踪不准确而影响光伏电池的发电效率。因为最大功率点电压一般在开路电压的85％处，现有的扰动观察法多与恒压控制法相结合，设置初始扰动点为PV输入电压的0.85倍，以提高追踪速度。而当开路电压大于母线电压时，PV输入电压将不再是开路电压，而是被钳位至母线电压，再做0.85倍处理后，将远小于Vmpp，难以再达到提高追踪速度的目的。发明内容本发明的目的在于提供一种高精度MPPT控制方法，以克服现有技术所存在的缺陷。为了达到上述目的，本发明采用的技术方案如下：一种高精度MPPT控制方法，包括以下步骤：S1、初始化MPPT控制器的参数，包括设置MPPT参考电压值Vref、初始扰动值V0、MPPT参考电压值Vref的上下限幅值以及扫描步长ΔV；S2、启动MPPT控制器，使MPPT参考电压值Vref每隔T时间按照设定步长ΔV减小，逐步达到初始扰动值V0，再采用三点法进行左右扫描；S3、按照步长ΔV间隔取A、B、C三点，A点处的参考电压VrefA＝Vref-ΔV，B点处的参考电压VrefB＝Vref，C点处的参考电压VrefC＝Vref+ΔV，并每隔T时间扫描一次，按照B、C、A的顺序扫描；S4、在B点时，记Vref＝VrefB，每隔T/N记录一次当前功率存入数组PB，T时间内记录N个，为PB～PB，N为正整数；S5、在C点时，记Vref＝VrefC，每隔T/N记录一次当前功率存入数组PC，T时间内记录N个，为PC～PC；S6、在A点时，记Vref＝VrefA，每隔T/N记录一次当前功率存入数组PA，T时间内记录N个，为PA～PA；S7、将C点功率数组和B点功率数组的后M个数据PC～PC和PB～PB一一对比，若有不少于半数的数据为PC＞PB，则认为从B点到C点功率增大，反之则认为从B点到C点功率减小，M为小于N的正整数；S8、将B点功率数组和A点功率数组的后M个数据PB～PB和PA～PA一一对比，若有不少于半数的数据为PB＞PA，则认为从A点到B点功率增大，反之则认为从A点到B点功率减小；S9、若同时满足从B点到C点功率增大，从A点到B点功率增大，则认为最大功率点在当前扫描点的右侧，更新MPPT参考电压为Vref＝VrefC；若同时满足从B点到C点功率减小，从A点到B点功率减小则认为最大功率点在当前扫描点的左侧，更新MPPT参考电压为Vref＝VrefA；若都不满足，则已实现最大功率点追踪，MPPT参考电压不变，为Vref＝VrefB；S9、若连续向左或向右扫描三次及以上，更新步长ΔV，重复步骤S3～S10，以获得实时最大功率点。进一步地，所述步骤S1中还包括获取当前的PV电压采样值Vpv，设置MPPT参考电压值Vref＝Vpv，所述初始扰动值V0的具体为：判断PV电压采样值Vpv与母线电压Vbus的大小，若PV电压采样值Vpv小于母线电压Vbus则初始扰动值V0＝0.85*Vref，否则初始扰动值V0＝0.95*Vref。进一步地，所述步骤S1中的扫描步长ΔV＝2V，所述步骤S9中的更新步长ΔV＝4V。进一步地，所述步骤S4-S6中的功率为电压和电流的乘积，该电压为电压是一段时间内的PV电压平均值不经过滤波的结果Vavg，该电流为一段时间内电感电流有效值经过滤波后的值IrmsFilt。进一步地，所述N为20，所述M为10。与现有技术相比，本发明的优点在于：本发明提供的一种高精度MPPT控制方法，通过记录MPPT参考电压下一组PV功率数据，采用三点法选择稳定后的多个功率值进行横向对比，判断扫描方向，所用功率值经过一定滤波手段，使得同组内的功率相差很小，而不同参考电压组间功率相差明显，多个数据能减小系统动态响应及采样误差带来的影响，从而提升低功率或高PV电压下的发电效率，与此同时优化初始扰动点的设置，提高追踪速度。本发明能够以更快的速度实现MPPT，解决低功率或高PV电压无法精准追踪最大功率点的问题，有效提高了光伏发电系统的稳定性和发电效率。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是光伏电池的P-V曲线图。图2是光伏电池通过BOOST升压电路连接到母线图。图3是PV输入电压跟随参考电压图。图4传统的三点法在太阳能电池P-V特性曲线顶点附近从左至右依次取A、B、C三点示意图。图5是本发明对控制器进行初始化流程图。图6本发明高精度MPPT控制方法流程图。图7是本发明的比较方式图。具体实施方式下面结合附图对本发明的优选实施例进行详细阐述，以使本发明的优点和特征能更易于被本领域技术人员理解，从而对本发明的保护范围做出更为清楚明确的界定。光伏电池的P-V曲线如图1所示，呈山峰状，在某一特定工作电压下，输出功率达到最大值。传统的扰动观察法，通过对光伏电池电压Vpv和电流IL的检测，得到电池当前的输出功率，与前一时刻记录的功率进行比较，从而确定给定参考电压的调整方向，若当前时刻的功率大于前一时刻的功率，说明参考电压调整方向正确；若当前时刻的功率小于前一时刻的功率说明参考电压调整方向错误，需要更改调整方向。光伏电池一般通过BOOST升压电路连接到母线如图2，扰动观察法按特定步长扰动电压外环给定参考电压Vref，调整BOOST电路的占空比，使PV输入电压跟随参考电压如图3，从而获得给定参考电压下的功率进行扰动前后比较。传统的三点法在太阳能电池P-V特性曲线顶点附近从左至右依次取A、B、C三点如图4，其中，VA、VB、VC分别代表A、B、C三点的电压，PA、PB、PC表示A、B、C三点所对应的功率。若PA＜PB且PB≤PC，则增大参考电压；若PA＜PB且PB＞PC，则参考电压不变；若PA≥PB且PB＞PC，则减小参考电压。本实施例在以上传统方法上进行改进以实现高精度MPPT控制方法，具体步骤如下：步骤S1、在MPPT控制器启动之前，初始化MPPT控制器的参数，如图5所示，包括设置MPPT参考电压值Vref、初始扰动值V0、MPPT参考电压值Vref的上下限幅值以及扫描步长ΔV。其中，获取当前的PV电压采样值Vpv，设置MPPT参考电压值Vref＝Vpv，所述初始扰动值V0的具体为：判断PV电压采样值Vpv与母线电压Vbus的大小，若PV电压采样值Vpv小于母线电压Vbus则初始扰动值V0＝0.85*Vref，否则初始扰动值V0＝0.95*Vref，使在PV电压被钳位至母线电压时能加快追踪速度。本实施例中，MPPT参考电压值Vref限制在150～850V之间，扫描步长ΔV＝2V。步骤S2、启动MPPT控制器，使MPPT参考电压值Vref每隔T时间按照设定步长ΔV减小，逐步达到初始扰动值V0，再采用三点法进行左右扫描。步骤S3、按照步长ΔV间隔取A、B、C三点，A点处的参考电压VrefA＝Vref-ΔV，B点处的参考电压VrefB＝Vref，C点处的参考电压VrefC＝Vref+ΔV，并每隔T时间扫描一次，按照B、C、A的顺序扫描。步骤S4、在B点时，记Vref＝VrefB，每隔T/20记录一次当前功率存入数组PB，T时间内记录20个，为PB～PB。步骤S5、在C点时，记Vref＝VrefC，每隔T/20记录一次当前功率存入数组PC，T时间内记录20个，为PC～PC。步骤S6、在A点时，记Vref＝VrefA，每隔T/20记录一次当前功率存入数组PA，T时间内记录20个，为PA～PA。步骤S7、将C点功率数组和B点功率数组的后10个数据PC～PC和PB～PB一一对比，若有不少于半数的数据为PC＞PB，则认为从B点到C点功率增大，反之则认为从B点到C点功率减小。步骤S8、将B点功率数组和A点功率数组的后10个数据PB～PB和PA～PA一一对比，若有不少于半数的数据为PB＞PA，则认为从A点到B点功率增大，反之则认为从A点到B点功率减小，比较方式如图7所示。步骤S9、若同时满足从B点到C点功率增大，从A点到B点功率增大，则认为最大功率点在当前扫描点的右侧，更新MPPT参考电压为Vref＝VrefC；若同时满足从B点到C点功率减小，从A点到B点功率减小则认为最大功率点在当前扫描点的左侧，更新MPPT参考电压为Vref＝VrefA；若都不满足，则认为最大功率点在当前扫描点的附近，则已实现最大功率点追踪，MPPT参考电压不变，为Vref＝VrefB。S9、若连续向左或向右扫描三次及以上，更新步长ΔV＝4V，重复步骤S3～S10，以获得实时最大功率点。本实施例中，为达到同组内的功率相差很小，而不同参考电压组间功率相差明显的目的，功率是电压和电流的乘积，电压是一段时间内的PV电压平均值不经过滤波的结果Vavg，防止因为滤波太过导致PA、PB、PC组间的功率值差异不明显；电流是一段时间内电感电流有效值经过滤波后的值IrmsFilt，防止因电流采样误差造成的组内功率偏差较大而影响功率大小的判断，即P＝Vavg*IrmsFilt。本发明将传统方法比较某一时刻的功率或功率滤波值来判断扫描方向，改进为如图7所示的比较方式：记录A、B、C三个参考电压下一段时间T内的20个功率数据，各自拿出稳定后的10个数据进行横向对比。若参考电压越大的情况下，所对应的功率后10个数据中有不少于5个数据也随之更大，则认为需要继续增大参考电压进行追踪；若参考电压越小的情况下，所对应的功率后10个数据中有不少于5个数据随之更小，则认为需要减小参考电压进行追踪；若不满足以上情况，则认为已到达最大功率点附近。通过本发明提出的改进MPPT控制方法，能够以更快的速度实现MPPT，解决低功率或高PV电压无法精准追踪最大功率点的问题，有效提高了光伏发电系统的稳定性和发电效率。虽然结合附图描述了本发明的实施方式，但是专利所有者可以在所附权利要求的范围之内做出各种变形或修改，只要不超过本发明的权利要求所描述的保护范围，都应当在本发明的保护范围之内。
