标题title
一种多阶段电压暂降状态估计方法
摘要abst
本发明公开了一种多阶段电压暂降状态估计方法，首先分析不同原因导致的多阶段电压暂降特征，提出利用暂降幅值跳变特征确定多阶段暂降幅值突变时刻成因的方法；然后提出继电保护动作矩阵和故障线路集的计算方法，实现利用继电保护装置的故障清除时间等特征初步划分故障线路集的目的，有效减少暂降状态估计的计算量；接着利用不同事件导致系统阻抗变化这一本质特征，提出多阶段电压暂降各阶段事件成因的推断方法，提高状态估计的准确性；最后基于事件成因推断结果，提出了多阶段电压暂降状态估计方法，解决了现有状态估计方法难以适用于多阶段暂降的问题。
权利要求书clms
1.一种多阶段电压暂降状态估计方法，其特征在于，包括以下步骤：步骤1：分析多阶段电压暂降的成因，确定不同成因下多阶段电压暂降特点，据此对不同突变点处电压暂降成因进行识别；步骤2：根据电网不同位置处整定的故障清除时间，构建继电保护装置动作矩阵；步骤3：求解出一条或多条可能的故障线路，构成故障线路集，从而减少多阶段电压暂降状态估计的计算量；步骤4：计算故障前后系统阻抗矩阵，以及故障线路单侧继电保护动作时的阻抗矩阵和分布式发电装置脱网时的阻抗矩阵；步骤5：利用优化模型从步骤3中求解得到的故障线路集中推断具体的故障线路，基于电压暂降类型推断出多阶段暂降各阶段具体事件；步骤6：基于电压暂降类型，通过各相邻电压暂降突变点之间的时间长度对暂降各阶段的持续时间进行估计，基于步骤5中的事件推断结果对暂降幅值进行估计。2.根据权利要求1所述的多阶段电压暂降状态估计方法，其特征在于，所述步骤1中，多阶段电压暂降的成因和特点为：成因Ⅰ：短路故障期间，电力系统中的一个或多个分布式发电装置跳闸，导致电网丢失电源；其特点为：电压暂降发生时刻对应的电压暂降突变点右侧电压幅值小于左侧；成因Ⅱ：短路故障期间，故障线路两侧的继电保护装置不同时跳闸，导致电网拓扑发生变化；其特点为：电压暂降发生时刻对应的电压暂降突变点右侧电压幅值大于左侧。3.根据权利要求2所述的多阶段电压暂降状态估计方法，其特征在于，所述对不同突变点处电压暂降成因进行识别的具体方法为：假设对一段包含电压暂降的波形使用波形点检测方法一共检测出s+1个电压暂降突变点，分别表示为MP0,MP1,...,MPx,...,MPs，且对应s+1个突变时刻t0,t1,...,tx,...,ts，这些电压暂降突变点将电压暂降部分的波形分为s段；不同段波形的电压分别表示为u1,u2,...,ux,...,us，且第m个电压um计算如下：其中，ff表示采样率，单位为个/秒；f表示工频电流频率，单位为Hz；xj是有效值序列中的第j个值；m∈；k为采样点总个数；根据上式形成二进制向量W：其中，向量W中的元素wx有0和1两种取值；当wx取值为0时表示tx-1时刻对应的MPx-1的右侧电压小于左侧，这意味着该时刻因为成因Ⅰ而形成了多阶段电压暂降，其中，x＞1；反之，当wx取值为1时，意味着tx-1时刻因为成因Ⅱ而形成了多阶段电压暂降，其中，x＞1。4.根据权利要求3所述的多阶段电压暂降状态估计方法，其特征在于，所述步骤2中构建继电保护装置动作矩阵具体包括：步骤2.1：构建基本动作矩阵，即描述继电保护装置排除故障行为的通用矩阵：其中，n表示系统中的母线条数，γij和γji分别表示线路lij上靠近i和j侧母线的保护的故障清除时间，i,j∈；i≠j；γij,γji＝0表示母线i和j之间物理上没有连接；步骤2.2：将所述通用矩阵改进并解耦为两个矩阵：上式中的上下三角矩阵分别表示线路两个端子母线上同一类型保护装置的故障清除时间；下三角矩阵中的下三角元素代表线路lij的i侧母线的保护装置故障清除时间，且γij＝0，i＞j，表示母线i和j之间物理上没有连接；上三角矩阵中的上三角元素代表线路另一侧的参数；为表示二段式保护，构造另外两个类似矩阵表示后备保护参数：步骤2.3：确定保护装置的配合关系对于二段式保护，线路中的主保护和后备保护的配合关系包括四种，将改进的保护动作矩阵表示为以下几种配合关系：其中，ΘⅠ表示故障线路两侧的主保护相互配合切除故障；ΘⅡ表示故障线路两侧的后备保护相互配合切除故障；ΘⅢ和ΘⅣ表示故障线路某侧的主保护与另一侧的后备保护相互配合切除故障；步骤2.4：修正动作矩阵中的故障清除时间将故障清除时间修正如下：其中，γij,set和λij,set分别表示主保护、后备保护的整定值；δ1,ij和δ2,ij分别表示实际的故障清除时间与整定值之间的偏差；偏差是内的随机数，其中δ表示同型号继电保护装置试验或历史运行过程中的最大误差值。5.根据权利要求4所述的多阶段电压暂降状态估计方法，其特征在于，所述步骤3具体包括：步骤3.1：基于步骤1的暂降原因识别，将电压暂降分为如下四种类型：类型Ⅰ：单阶段矩形暂降：类型Ⅱ：由成因Ⅰ导致的多阶段电压暂降；类型Ⅲ：由成因Ⅱ导致的多阶段电压暂降；类型Ⅳ：由成因Ⅰ和成因Ⅱ共同导致的多阶段电压暂降；步骤3.2：不同类型暂降下故障线路集求解类型Ⅰ和类型Ⅱ：假设步骤1中检测出电压暂降波形的第一个和最后一个电压暂降突变点时刻分别是t0和ts，则系统中故障发生到被切除的时间长度为ts-t0；若步骤2.3四个矩阵中某个矩阵主对角线对称位置的两个元素在误差阈值内等于ts-t0，则与这两个元素相对应的线路为可能的故障线路；因此故障线路集LF的求解模型如下：其中，θij是矩阵ΘⅠ～ΘⅣ中第i行中第j列的元素，LN表示监测装置母线处暂降域交集中的线路组成的集合；类型Ⅲ和类型Ⅳ：假设步骤1中检测出电压暂降波形的第一个电压暂降突变点为t0，两个对应继电保护动作的电压暂降突变点时刻分别是tx-1和ts；则故障线路两侧继电保护装置从故障发生到保护动作的时间长度分别为tx-1-t0和ts-t0；那么故障线路集的求解模型如下：6.根据权利要求5所述的多阶段电压暂降状态估计方法，其特征在于，所述步骤4具体包括：步骤4.1：计算故障前系统阻抗矩阵系统的导纳矩阵YSE表示为线路导纳矩阵和发电机导纳矩阵之和，如下所示：假设电力系统中有n条母线，根据线路拓扑关系和阻抗参数，计算出线路的导纳矩阵如下：式中，se＝1,2,0表示正序、负序和零序，αij表示节点i、j的互导纳，αii表示节点i的自导纳，i≠j；i,j∈；矩阵是对角线矩阵，对角线上的元素值等于相应发电机的自导纳，如下所示：式中，βii＝0表示母线处没有发电机；则计算系统的阻抗矩阵如下：步骤4.2：计算短路之后系统阻抗矩阵短路之后故障位置fl与待求节点m之间的互阻抗以及故障位置fl的自阻抗分别可以用下两式解得：式中，和是矩阵中的元素，是线路lij阻抗，进一步将阻抗表示为函数的形式gmf1和gff1，两个函数分别表示线路lij上距离i端p的位置fl发生短路故障时，故障位置与目标节点m的互阻抗以及故障位置的自阻抗；步骤4.3：计算故障线路单侧继电保护动作时的阻抗矩阵假设线路lij发生短路故障后，j侧保护装置动作将单侧线路切除，系统的阻抗计算如下：首先在原系统母线i、j之间追加一条阻抗为-zij的支路，此时系统的阻抗矩阵用下式修正：其中，ΔZ为过程量，使用下式计算：然后在母线i处连接一条阻抗为pzij的支路，此时系统阻抗矩阵进一步修正为如下式：与相比增加的一行一列代表故障位置fl与各目标母线m的互阻抗或故障位置的自阻抗进一步将阻抗表示为函数的形式gmf2和gff2，两个函数分别表示线路lij上距离i端p的位置fl发生短路故障后，由线路d侧保护装置动作切除部分线路，故障位置与目标节点m的互阻抗以及故障位置的自阻抗；如下两式所示：步骤4.4：计算分布式发电装置脱网时的阻抗矩阵假设母线集h中所有母线的分布式发电装置脱网，此时首先需要将对角线矩阵修正为下式：根据上式计算故障前系统的阻抗矩阵，最后计算短路情况下分布式发电装置脱网时的系统阻抗，并进一步将阻抗表示为函数的形式gmf3和gff3，两个函数分别表示线路lij上距离i端p的位置fl发生短路故障且母线集h内所有母线处的DG脱网时，故障位置与目标节点m的互阻抗以及故障位置的自阻抗；如下两式所示：7.根据权利要求6所述的多阶段电压暂降状态估计方法，其特征在于，所述步骤5中优化模型根据暂降类型分为如下四种：类型Ⅰ使用如下优化模型推断故障线路及其短路情况，即i,j,p；其中，f为短路计算的函数；类型Ⅱ使用如下优化模型推断故障线路及其短路情况、DG脱网时刻及脱网顺序，即i,j,p,hq；其中，s为多阶段电压暂降的阶段数；hq为第q阶段电压暂降期间，脱网DG组成的集合；类型Ⅲ使用如下优化模型推断故障线路及其短路情况、继电保护装置跳闸时刻及其跳闸顺序，即i,j,p,d；类型Ⅳ使用如下优化模型推断故障线路及其短路情况、继电保护装置跳闸时刻及其跳闸顺序、DG脱网时刻及其顺序，即i,j,p,d,hq；其中，o为故障线路某侧继电保护装置首先动作跳闸的时刻；uo+1为第o+1段电压暂降幅值。8.根据权利要求7所述的多阶段电压暂降状态估计方法，其特征在于，所述步骤6中电压暂降的状态估计根据暂降类型分为如下四种：1)对于类型Ⅰ，任何未监测母线m的暂降幅值根据下式进行估算：f,gff1)2)对于类型Ⅱ，任何未监测母线m的暂降幅值根据下式进行估算：3)对于类型Ⅲ，任何未监测母线m的暂降幅值根据下式进行估算：4)对于类型Ⅳ，任何未监测母线m的暂降幅值根据下式进行估算：其中，y和z分别为多阶段电压暂降的第y和z阶段。
说明书desc
技术领域本发明涉及电压暂降状态估计技术领域，具体为一种多阶段电压暂降状态估计方法。背景技术现有电压暂降状态估计方法主要针对由短路引起的单阶段矩形暂降，缺乏适用于多阶段电压暂降的状态估计方法。然而现有研究表明，多阶段电压暂降事件的发生频次逐渐上升，多阶段暂降问题不容忽视。例如：随着新型电力系统的发展，系统中接入的DG比例也越来越高。在短路故障发生期间，暂降可能导致单个DG跳闸或多个DG连锁跳闸，从而形成复杂的多阶段暂降。此外，电力系统中常用的阶段式保护，比如距离保护也可能因为其动作特性导致多阶段暂降。电压暂降状态估计需要利用短路计算公式来估计未监测母线的暂降幅值。短路计算方法为公知性方法，不同故障类型下短路计算方法如下。设m为待求母线，母线i、j之间的线路lij故障，f为故障点，p为点f到母线i的归一化距离。p取值为表示f从i到j，如下式所示：式中，Lif为母线i到故障点f的距离；Lij为线路lij的长度。①三相短路故障母线m发生三相故障导致的三相电压幅值为：其中Rf为故障电阻，和分别表示故障前母线m和故障点f的电压。母线暂降前电压可通过电力系统仿真工具进行潮流计算获得，而故障点的暂降前电压可表示为：②单相接地故障设A相发生单相接地故障，母线m各相电压幅值为：式中，α＝ej120°为旋转因子。③两相故障设B、C相发生两相故障，母线m各相电压幅值为：④两相接地故障设B、C相发生两相接地故障，母线m各相电压幅值为：暂降是对敏感设备影响最严重的扰动，且无法避免。要解决电压暂降问题，首先应该能够准确反映系统中不同位置的电压暂降水平，因此需要安装必要的监测装置用于监测暂降。由于电网庞大而复杂，出于监测成本和信息处理能力考虑，系统中通常只能在部分母线安装监测装置。如何利用有限监测装置的监测数据估计未监测母线的暂降水平是一个重要的研究任务，这一研究又称之为电压暂降状态估计。现有电压暂降状态估计方法，主要针对短路故障引起的单阶段暂降，难以适用于多阶段电压暂降的状态估计。随着多阶段电压暂降发生频率的逐渐增加，提出适用于多阶段电压暂降的状态估计方法具有重要意义。多阶段状态估计的难点主要有如下几个。1.形成多阶段暂降的原因主要是短路期间DG脱网或者线路两端的保护装置不同时跳闸，如何判断不同阶段的暂降是何种原因导致是第一个挑战。2.短路发生的位置是影响电压幅值的重要因素，如何初步划分可能的故障线路集，减小MVSSE的计算量是第二个挑战。3.短路期间，同一故障位置处的电压幅值还受DG的脱网个数、顺序以及故障线路上保护装置的跳闸情况等事件影响，如何推断出暂降事件不同阶段的具体成因，提高MVSSE的准确性是第三个挑战。术语解释：电压暂降：国际电气与电子工程师协会将电压暂降定义为供电电压有效值快速下降到0.1～0.9p.u.，持续时间为0.5个周波至1min的电能质量现象。电压暂降状态估计：一种通过有限监测装置的监测数据估计非监测母线电压暂降状态的方法。本发明中的电压暂降状态指单一暂降事件中的电压暂降幅值与电压暂降持续时间。电压暂降突变点：电压暂降有效值波形中电压幅值突然大幅变化的点。短路故障、短路后DG脱网、短路后故障线路单侧继电保护装置动作都会形成电压暂降突变点。电压暂降突变点可以通过波形点检测方法确定。发明内容针对上述问题，本发明的目的在于提供一种多阶段电压暂降状态估计方法，通过分析不同原因造成多阶段暂降的特点，考虑多阶段暂降监测数据中的各阶段突变时间与继电保护装置的故障清除时间，推断出多阶段暂降各个阶段可能发生的具体事件，最终得到符合工程需求的多阶段状态估计方法。技术方案如下：一种多阶段电压暂降状态估计方法，包括以下步骤：步骤1：分析多阶段电压暂降的成因，确定不同成因下多阶段电压暂降特点，据此对不同突变点处电压暂降成因进行识别；步骤2：根据电网不同位置处整定的故障清除时间，构建继电保护装置动作矩阵；步骤3：求解出一条或多条可能的故障线路，构成故障线路集，从而减少多阶段电压暂降状态估计的计算量；步骤4：计算故障前后系统阻抗矩阵，以及故障线路单侧继电保护动作时的阻抗矩阵和分布式发电装置脱网时的阻抗矩阵；步骤5：利用优化模型从步骤3中求解得到的故障线路集中推断具体的故障线路，基于电压暂降类型推断出多阶段暂降各阶段具体事件；步骤6：基于电压暂降类型，通过各相邻电压暂降突变点之间的时间长度对暂降各阶段的持续时间进行估计，基于步骤5中的事件推断结果对暂降幅值进行估计。进一步的，所述步骤1中，多阶段电压暂降的成因和特点为：成因Ⅰ：短路故障期间，电力系统中的一个或多个分布式发电装置跳闸，导致电网丢失电源；其特点为：电压暂降发生时刻对应的电压暂降突变点右侧电压幅值小于左侧；成因Ⅱ：短路故障期间，故障线路两侧的继电保护装置不同时跳闸，导致电网拓扑发生变化；其特点为：电压暂降发生时刻对应的电压暂降突变点右侧电压幅值大于左侧。更进一步的，所述对不同突变点处电压暂降成因进行识别的具体方法为：假设对一段包含电压暂降的波形使用波形点检测方法一共检测出s+1个电压暂降突变点，分别表示为MP0,MP1,...,MPx,…,MPs，且对应s+1个突变时刻t0,t1,…,tx,...,ts，这些电压暂降突变点将电压暂降部分的波形分为s段；不同段波形的电压分别表示为u1,u2,...,ux,...,us，且第m个电压um计算如下：其中，ff表示采样率，单位为个/秒；f表示工频电流频率，单位为Hz；xj是有效值序列中的第j个值；m∈；k为……；根据上式形成二进制向量W：其中，向量W中的元素wx有0和1两种取值；当wx取值为0时表示tx-1时刻对应的MPx-1的右侧电压小于左侧，这意味着该时刻因为成因Ⅰ而形成了多阶段电压暂降，其中，x＞1；反之，当wx取值为1时，意味着tx-1时刻因为成因Ⅱ而形成了多阶段电压暂降，其中，x＞1。更进一步的，所述步骤2中构建继电保护装置动作矩阵具体包括：步骤2.1：构建基本动作矩阵，即描述继电保护装置排除故障行为的通用矩阵：其中，n表示系统中的母线条数，γij和γji分别表示线路lij上靠近i和j侧母线的保护的故障清除时间，i,j∈；i≠j；γij,γji＝0表示母线i和j之间物理上没有连接；步骤2.2：将所述通用矩阵改进并解耦为两个矩阵：上式中的上下三角矩阵分别表示线路两个端子母线上同一类型保护装置的故障清除时间；下三角矩阵中的下三角元素代表线路lij的i侧母线的保护装置故障清除时间，且γij＝0，i＞j，表示母线i和j之间物理上没有连接；上三角矩阵中的上三角元素代表线路另一侧的参数；为表示二段式保护，构造另外两个类似矩阵表示后备保护参数：步骤2.3：确定保护装置的配合关系对于二段式保护，线路中的主保护和后备保护的配合关系包括四种，将改进的保护动作矩阵表示为以下几种配合关系：其中，ΘⅠ表示故障线路两侧的主保护相互配合切除故障；ΘⅡ表示故障线路两侧的后备保护相互配合切除故障；ΘⅢ和ΘⅣ表示故障线路某侧的主保护与另一侧的后备保护相互配合切除故障；步骤2.4：修正动作矩阵中的故障清除时间将故障清除时间修正如下：其中，γij,set和λij,set分别表示主保护、后备保护的整定值；δ1,ij和δ2,ij分别表示实际的故障清除时间与整定值之间的偏差；偏差是内的随机数，其中δ表示同型号继电保护装置试验或历史运行过程中的最大误差值。更进一步的，所述步骤3具体包括：步骤3.1：基于步骤1的暂降原因识别，将电压暂降分为如下四种类型：类型Ⅰ：单阶段矩形暂降：类型Ⅱ：由成因Ⅰ导致的多阶段电压暂降；类型Ⅲ：由成因Ⅱ导致的多阶段电压暂降；类型Ⅳ：由成因Ⅰ和成因Ⅱ共同导致的多阶段电压暂降；步骤3.2：不同类型暂降下故障线路集求解类型Ⅰ和类型Ⅱ：假设步骤1中检测出电压暂降波形的第一个和最后一个电压暂降突变点时刻分别是t0和ts，则系统中故障发生到被切除的时间长度为ts-t0；若步骤2.3四个矩阵中某个矩阵主对角线对称位置的两个元素在误差阈值内等于ts-t0，则与这两个元素相对应的线路为可能的故障线路；因此故障线路集LF的求解模型如下：其中，θij是矩阵ΘⅠ～ΘⅣ中第i行中第j列的元素，LN表示监测装置母线处暂降域交集中的线路组成的集合；类型Ⅲ和类型Ⅳ：假设步骤1中检测出电压暂降波形的第一个电压暂降突变点为t0，两个对应继电保护动作的电压暂降突变点时刻分别是tx-1和ts；则故障线路两侧继电保护装置从故障发生到保护动作的时间长度分别为tx-1-t0和ts-t0；那么故障线路集的求解模型如下：更进一步的，所述步骤4具体包括：步骤4.1：计算故障前系统阻抗矩阵系统的导纳矩阵YSE表示为线路导纳矩阵和发电机导纳矩阵之和，如下所示：假设电力系统中有n条母线，根据线路拓扑关系和阻抗参数，计算出线路的导纳矩阵如下：式中，se＝1,2,0表示正序、负序和零序，αij表示节点i、j的互导纳，αii表示节点i的自导纳，i≠j；i,j∈；矩阵是对角线矩阵，对角线上的元素值等于相应发电机的自导纳，如下所示：式中，βii＝0表示母线处没有发电机；则计算系统的阻抗矩阵如下：步骤4.2：计算短路之后系统阻抗矩阵短路之后故障位置fl与待求节点m之间的互阻抗以及故障位置fl的自阻抗分别可以用下两式解得：式中，和是矩阵中的元素，是线路lij阻抗，进一步将阻抗表示为函数的形式gmf1和gff1，两个函数分别表示线路lij上距离i端p的位置fl发生短路故障时，故障位置与目标节点m的互阻抗以及故障位置的自阻抗；步骤4.3：计算故障线路单侧继电保护动作时的阻抗矩阵假设线路lij发生短路故障后，j侧保护装置动作将单侧线路切除，系统的阻抗计算如下：首先在原系统母线i、j之间追加一条阻抗为-zij的支路，此时系统的阻抗矩阵用下式修正：其中，ΔZ表示过程量，使用下式计算：然后在母线i处连接一条阻抗为pzij的支路，此时系统阻抗矩阵进一步修正为如下式：与相比增加的一行一列代表故障位置fl与各目标母线m的互阻抗或故障位置的自阻抗进一步将阻抗表示为函数的形式gmf2和gff2，两个函数分别表示线路lij上距离i端p的位置fl发生短路故障后，由线路d侧保护装置动作切除部分线路，故障位置与目标节点m的互阻抗以及故障位置的自阻抗；如下两式所示：步骤4.4：计算分布式发电装置脱网时的阻抗矩阵假设母线集h中所有母线的分布式发电装置脱网，此时首先需要将对角线矩阵修正为下式：根据上式计算故障前系统的阻抗矩阵，最后计算短路情况下分布式发电装置脱网时的系统阻抗，并进一步将阻抗表示为函数的形式gmf3和gff3，两个函数分别表示线路lij上距离i端p的位置fl发生短路故障且母线集h内所有母线处的DG脱网时，故障位置与目标节点m的互阻抗以及故障位置的自阻抗；如下两式所示：更进一步的，所述步骤5中优化模型根据暂降类型分为如下四种：类型Ⅰ使用如下优化模型推断故障线路及其短路情况，即i,j,p；其中，f为短路计算的函数；类型Ⅱ使用如下优化模型推断故障线路及其短路情况、DG脱网时刻及脱网顺序，即i,j,p,hq；其中，s为多阶段电压暂降的阶段数；hq为第q阶段电压暂降期间，脱网DG组成的集合；类型Ⅲ使用如下优化模型推断故障线路及其短路情况、继电保护装置跳闸时刻及其跳闸顺序，即i,j,p,d；类型Ⅳ使用如下优化模型推断故障线路及其短路情况、继电保护装置跳闸时刻及其跳闸顺序、DG脱网时刻及其顺序，即i,j,p,d,hq；其中，o为故障线路某侧继电保护装置首先动作跳闸的时刻；uo+1为第o+1段电压暂降幅值。更进一步的，所述步骤6中电压暂降的状态估计根据暂降类型分为如下四种：1)对于类型Ⅰ，任何未监测母线m的暂降幅值根据下式进行估算：f,gff1)2)对于类型Ⅱ，任何未监测母线m的暂降幅值根据下式进行估算：3)对于类型Ⅲ，任何未监测母线m的暂降幅值根据下式进行估算：4)对于类型Ⅳ，任何未监测母线m的暂降幅值根据下式进行估算。其中，y和z分别为多阶段电压暂降的第y和z阶段。本发明的有益效果是：1)本发明分析不同原因导致的多阶段电压暂降特征，提出利用暂降幅值跳变特征确定多阶段暂降幅值突变时刻成因的方法。2)本发明提出继电保护动作矩阵和故障线路集的计算方法，实现利用继电保护装置的故障清除时间等特征初步划分故障线路集的目的，有效减少暂降状态估计的计算量。3)本发明利用不同事件导致系统阻抗变化这一本质特征，提出多阶段电压暂降各阶段事件成因的推断方法，提高状态估计的准确性。4)本发明基于事件成因推断结果，提出了多阶段电压暂降状态估计方法，解决了现有状态估计方法难以适用于多阶段暂降的问题。附图说明图1为电力系统的短路计算模型。图2为本发明故障线路被单侧切除后的电力系统短路计算模型。图3为本发明多阶段电压暂降状态估计模型构建流程。具体实施方式下面结合附图和具体实施例对本发明做进一步详细说明。本发明技术方案主要分为六个大步骤：多阶段电压暂降成因识别、继电保护动作矩阵构建、故障线路集求解、阻抗矩阵求解、推断多阶段暂降各阶段具体事件和多阶段电压暂降状态估计方法。其中每个大步骤及其小步骤的详细阐述如下：一、多阶段电压暂降成因识别①多阶段电压暂降的成因有两个：成因1是：短路故障期间，电力系统中的一个或多个DG跳闸，导致电网丢失电源。成因2是：短路故障期间，故障线路两侧的继电保护装置不同时跳闸，导致电网拓扑发生变化。②不同成因下多阶段电压暂降特点成因1意味着故障之后，系统进一步丢失电源，因此监测到的电压暂降幅值进一步降低。其特点是，成因1发生时刻对应的电压暂降突变点右侧电压幅值小于左侧。相反，成因2意味着故障发生之后，线路的单侧保护装置将故障与系统部分隔离，因此监测到的电压暂降幅值会有所上升。其特点是，成因2发生时刻对应的电压暂降突变点右侧电压幅值大于左侧。③不同突变点处电压暂降成因识别假设对一段包含电压暂降的波形使用波形点检测方法一共检测出s+1个电压暂降突变点，分别表示为MP0,MP1,…,MPx,…,MPs，且对应s+1个突变时刻t0,t1,…,tx,…,ts，这些电压暂降突变点将电压暂降部分的波形分为s段。不同段波形的电压可以分别表示为u1,u2,…,ux,…,us，且第m个电压um可以计算如下：其中ff表示采样率，单位为个/秒，f表示工频电流频率，单位为Hz，xj是有效值序列中的第j个值。根据式可以形成二进制向量W如式：向量W中的元素wx有0和1两种取值。当取值为0时表示tx-1时刻对应的MPx-1的右侧电压小于左侧，这意味着该时刻因为成因1而形成了多阶段电压暂降。反之，当取值为1时，意味着tx-1时刻因为成因2而形成了多阶段电压暂降.二、继电保护装置动作矩阵基于不同电压暂降突变点对应时刻的多阶段暂降成因，可以大致获取暂降事件中继电保护装置的实际跳闸时间。为了利用该信息，第二大步骤根据电网不同位置处整定的故障清除时间提出继电保护装置动作矩阵的构建方法。①基本动作矩阵继电保护有不同的类型，包括低压保护、过电流保护和距离保护等，每种类型都有其独有的触发规则与故障清除时间来清除故障。本发明提出了一种描述继电保护装置排除故障行为的通用矩阵，如下式所示。其中n表示系统中的母线条数，γij和γji分别表示线路lij上靠近i和j侧母线的保护的故障清除时间，单位是ms。γij,γji＝0表示母线i和j之间物理上没有连接。故障清除时间是配电自动化系统等电力企业的软件中记录的继电保护装置整定值。②改进动作矩阵在实际应用过程中，阶段式保护广泛用于配电系统，比如二段式保护。二段式保护是指在一条线路上配备两种类型的保护，一种作为主保护，另一种作为后备保护。两种保护的故障清除时间不同，主保护的故障清除时间更短。当发生短路故障时，主保护优先触发，后备保护则在主保护无法触发的情况下工作。一般情况下故障可以由主保护独立切除，有时也可以由后备保护独立切除或者由主保护与后备保护配合切除。本发明考虑到式中定义的基本动作矩阵难以呈现阶段式保护的配合关系，因此对其改进并解耦为两个矩阵，分别如式和所示。上式中的上下三角矩阵分别表示线路两个端子母线上同一类型保护装置的故障清除时间。下三角矩阵中的下三角元素代表线路lij的i侧母线的保护装置故障清除时间，且γij＝0表示母线i和j之间物理上没有连接。上三角矩阵中的上三角元素代表线路另一侧的参数，含义类似。设式和代表主保护参数，为了表示二段式保护，构造另外两个类似矩阵表示后备保护参数，分别如式和所示。③保护装置的配合关系对于广泛使用的二段式保护，线路中的主保护和后备保护可能有四种配合关系。改进的保护动作矩阵可以方便的表示这几种配合关系如下：关系1：如式所示，ΘⅠ表示故障线路两侧的主保护相互配合切除故障。关系2：如式所示，ΘⅡ表示故障线路两侧的后备保护相互配合切除故障。关系3/4：如式和所示，ΘⅢ和ΘⅣ表示故障线路某侧的主保护与另一侧的后备保护相互配合切除故障。④修正动作矩阵中的故障清除时间式～中使用到的故障清除时间是从电力公司获取到的整定值。理论上线路两端的主保护或后备保护各自的故障清除时间应该相同，且等于整定值。然而实际运行中，由于误差的存在，这些矩阵中的元素可能偏离整定值，因此需要做出必要修正如式所示。其中，γij,set和λij,set分别表示主保护、后备保护的整定值。δ1,ij和δ2,ij分别表示实际的故障清除时间与整定值之间的偏差。偏差是内的随机数，其中δ表示同型号继电保护装置试验或历史运行过程中的最大误差值。三、故障线路集求解基于第一步暂降原因识别和第二步保护动作矩阵的内容，可以求解出一条或多条可能的故障线路，从而减少多阶段电压暂降状态估计的计算量。①暂降类型基于第一步暂降原因识别的内容，将电压暂降分为如下四种类型：类型1：单阶段矩形暂降。类型2：由原因1导致的多阶段电压暂降。类型3：由原因2导致的多阶段电压暂降。类型4：由原因1和2共同导致的多阶段电压暂降。②不同类型暂降下故障线路集求解类型1/2：这两类电压暂降事件中，故障线路两侧继电保护装置在最后一个电压暂降突变时刻同时动作将故障切除。假设步骤一中检测出电压暂降波形的第一个和最后一个电压暂降突变点时刻分别是t0和ts，则系统中故障发生到被切除的时间长度为：ts-t0。如果式～中某个矩阵主对角线对称位置的两个元素在误差阈值内等于ts-t0，则与这两个元素相对应的线路就是可能的故障线路。因此故障线路集LF的求解模型如下：其中，θij是矩阵ΘⅠ～ΘⅣ中第i行中第j列的元素，LN表示监测装置母线处暂降域交集中的线路组成的集合。类型3/4：这两类电压暂降事件中，故障线路两侧继电保护装置不能同时动作将故障切除。假设步骤一中检测出电压暂降波形的第一个电压暂降突变点及两个对应继电保护动作的电压暂降突变点时刻分别是t0、tx-1和ts。则故障线路两侧继电保护装置从故障发生到保护动作的时间长度分别为tx-1-t0和ts-t0。那么故障线路集的求解模型如下：四、阻抗矩阵求解无论是成因1还是成因2造成的多阶段暂降，其本质都是故障过程中由事件引起的系统阻抗矩阵的变化。①故障前系统阻抗矩阵系统的导纳矩阵YSE可以表示为线路导纳矩阵和发电机导纳矩阵之和，如下所示。假设电力系统中有n条母线，根据线路拓扑关系和阻抗参数，可以计算出线路的导纳矩阵如下所示。式中，se＝1,2,0表示正序、负序和零序，αij表示节点i、j的互导纳，αii表示节点i的自导纳。矩阵是对角线矩阵，对角线上的元素值等于相应发电机的自导纳，如下所示。式中βii＝0表示母线处没有发电机。利用式可以计算系统的阻抗矩阵如下。②短路之后系统阻抗矩阵当系统发生短路故障时，系统的阻抗可以利用如图1所示复杂电力系统短路计算模型进行计算。短路之后故障位置fl与待求节点m之间的互阻抗以及故障位置fl的自阻抗分别可以用下两式解得：式中和是矩阵中的元素，是线路lij阻抗，进一步将阻抗表示为函数的形式gmf1和gff1，两个函数分别表示线路lij上距离i端p的位置fl发生短路故障时，故障位置与目标节点m的互阻抗以及故障位置的自阻抗。③故障线路单侧继电保护动作时的阻抗矩阵假设线路lij发生短路故障后，j侧保护装置动作将单侧线路切除，系统的阻抗可以通过图2所示模型计算。首先在原系统母线i、j之间追加一条阻抗为-zij的支路，此时系统的阻抗矩阵可以使用下式修正：其中ΔZ可以使用下式计算：然后在母线i处连接一条阻抗为pzij的支路，此时系统阻抗矩阵进一步修正为如下式：与相比增加的一行一列代表故障位置f与各目标母线m的互阻抗或故障位置的自阻抗进一步将阻抗表示为函数的形式gmf2和gff2，两个函数分别表示线路lij上距离i端p的位置f发生短路故障后，由线路d侧保护装置动作切除部分线路，故障位置与目标节点m的互阻抗以及故障位置的自阻抗。如下两式所示：④DG脱网时的阻抗矩阵当短路发生时，某些节点处的DG可能因为低压穿越能力不够而脱网。假设母线集h中所有母线的DG脱网，此时首先需要将式所示矩阵修正为下式。然后将上式带入式计算故障前系统的阻抗矩阵，最后利用式～计算短路情况下DG脱网时的系统阻抗，并进一步将阻抗表示为函数的形式gmf3和gff3，两个函数分别表示线路lij上距离i端p的位置f发生短路故障且母线集h内所有母线处的DG脱网时，故障位置与目标节点m的互阻抗以及故障位置的自阻抗。如下两式所示：五、推断多阶段暂降各阶段具体事件第四步求解出不同情况下系统阻抗矩阵之后，可以利用第五步中的优化模型从第三步中求解得到的故障线路集中推断具体的故障线路，并推断出多阶段暂降各阶段具体事件。推断模型同样根据暂降类型分为如下四种：①类型1对于这一类暂降，可以使用如下优化模型推断故障线路及其短路情况其中f为短路计算的函数，不同短路类型的计算公式见式～。②类型2对于这一类暂降，可以使用如下优化模型推断故障线路及其短路情况、DG脱网时刻及脱网顺序③类型3对于这一类暂降，可以使用如下优化模型推断故障线路及其短路情况、继电保护装置跳闸时刻及其跳闸顺序④类型4假设一段电压暂降波形中检测到的第o个电压暂降突变点对应于单侧保护跳闸。对于这一类暂降，可以使用如下优化模型推断故障线路及其短路情况、继电保护装置跳闸时刻及其跳闸顺序、DG脱网时刻及其顺序需要注意的是，式～是单台监测装置的优化模型，这些优化模型可以通过智能算法比如量子遗传算法求解。当有多个监测装置时，优化模型中的目标函数是监测装置各自目标函数的总和。六、多阶段电压暂降的状态估计方法电压暂降的状态估计包括未监测母线的暂降幅值和持续时间的估计。暂降各阶段的持续时间可以通过各相邻电压暂降突变点之间的时间长度进行估计。暂降幅值的估计则基于第五步中的事件推断结果。同样，根据电压暂降类型可以分为如下四种。①类型1对于这类暂降，任何未监测母线m的暂降幅值可以根据下式进行估算。f,gff1) ②类型2对于这类暂降，任何未监测母线m的暂降幅值可以根据下式进行估算。③类型3对于这类暂降，任何未监测母线m的暂降幅值可以根据下式进行估算。④类型4对于这类暂降，任何未监测母线m的暂降幅值可以根据下式进行估算。本发明的方法分析了不同原因造成多阶段暂降的特点，考虑了多阶段暂降监测数据中的各阶段突变时间与继电保护装置的故障清除时间，推断出多阶段暂降各个阶段可能发生的具体事件，最终得到符合工程需求的多阶段状态估计方法。
