标题title
一种基于AI视觉的货车超载超限预警方法和系统
摘要abst
本发明涉及交通工程与人工智能技术领域，公开了一种货车超载超限预警方法和系统。该方法是基于AI视觉技术识别货车及货物的类型和尺寸，进一步计算车重实现车流超载预警，其中运用计算机视觉技术结合深度学习框架提高货物类型识别精度。该系统包括：常见货物图像数据库、车流图像采集模块、车型分类及车牌号识别模块、货物特征提取模块、货物图像识别模块、车辆信息提取模块、车辆参数输出模块、货物体积计算模块、货物重量计算模块、超载超限对比模块、报警模块。其中车流图像采集模块通过多个摄像机实现，报警模块通过报警器和电子显示屏实现，其余模块置于中心处理器中并对车流图像进行识别、分类、计算、查询、对比、分析，将分析结果传入报警模块进行交通管制，最终实现智能化、实时化、低成本、高效率、低干扰的超载超限预警效果。所述预警方法通过所述系统实现。
权利要求书clms
1.一种基于AI视觉的货车超载超限预警方法和系统，其特征在于，所述基于AI视觉的货车超载超限预警方法和系统包括以下流程：步骤1，收集常见货车载货重物图像数据形成图像识别系统训练集，并对这些货物图像进行对应的名称和密度标签，根据训练集特征对其训练形成货物图像识别模型；步骤2，多个摄像机采集车流图像，对所述车流图像先进行车流车型分类，再对分类为货车的车厢进行识别，判断车厢是否封闭，车厢封闭货车根据电子显示屏提示进入指定称重区域检测，对车厢不封闭货车进行识别是否空载，若为空载将正常行驶，若为载货则进行车牌号识别，并将识别到的车牌号与车型信息库匹配；步骤3，将所述车厢内货物图像，输入到基于计算机视觉技术结合深度学习框架搭建好的高精度货物图像识别模型中，对车厢内货物图像进行识别，最后输出识别的结果包括货物名称和密度ρ；步骤4，将所述识别的车牌号与车型信息库匹配获取货车以下信息：货车超载限值、货车所载货物宽度限值、货车所载货物高度限值、货车自重、车厢实际宽度、车厢实际长度、车厢实际高度、对该提取货车超载限值标签为M、货物宽度限值标签为B、货物高度限值标签为H、货车自重标签为m1、车厢实际宽度标签为W、车厢实际长度标签为A；步骤5，将所述车厢实际宽度W和车厢实际长度A输入到货物特征提取模块，对所述车厢内货物图像基于多目视觉技术进行尺寸测量或数量统计，根据测量的货物尺寸或数量计算货物体积，并将货物体积标签为v，再输入到货物重量计算与输出模块；步骤6，所述货物重量计算与输出模块中的输出结果包括货物名称、密度和货物体积，通过计算可得到货物总重，并将货物总重标签为m输出；步骤7，将所述货物体积v、货物总重m、货车超载限值M、货物宽度限值B、货物高度限值H、货车自重m1输入到定义有该桥最大承载值Q的超载超限对比模块进行对比分析，并将分析结果输入到报警模块中，报警模块根据对比结果进行报警与结果显示。2.根据权利要求1所述的流程，其特征在于，所述的常见货车载货重物图像数据包括泥土、沙石、砖块、钢筋、混凝土预制块、钢材、水泥、煤炭、金属块等图像的名称和所对应的常用密度，形成货物图像识别模型训练集。3.根据权利要求1所述的流程，其特征在于，所述的车型分类包括：将车流中的车型分为货车和非货车，非货车正常行驶，再对货车图像进行识别车厢是否封闭，车厢封闭货车通过显示屏指示进入称重区域检测，车厢不封闭空载货车正常行驶，车厢不封闭载货货车进行识别预警流程。4.根据权利要求1所述的流程，其特征在于，所述计算货物体积v分为两类：第一类为货物具有规则形状如长方体、圆柱体、圆环体等，根据相应体积计算公式进行计算v长方体为例：v＝货物长度a×货物宽度b×货物高度h×货物数量n,若货物为流体n＝1，若货物为块体n＝货物数量；第二类为散装货物，货物体积按车厢尺寸计算体积：v＝车厢长度A×车厢宽度W×货物高度h；所述货物总重其中k是货物种类，n是货物种类总数，v是货物体积，ρ是货物密度。5.根据权利要求1所述的流程，其特征在于，所述货车超载限值M、货物宽度限值B、货物高度限值H、货车自重m1、车厢实际宽度W、车辆实际车厢长度A是通过车型信息库匹配而查询获得。6.根据权利要求1所述的流程，其特征在于，所述超载超限对比模块输出结果显示，若对比结果为货物总重m、货物宽度b和货物高度h都小于车辆超载超限标准值M、B、H，且车辆自重m1和货物总重m之和小于桥梁最大承载重量Q时，即,车辆正常行驶；若只是货物总重m或货物尺寸大于车辆超载超限标准值M、B、H，即时自动开启一级风险预警，报警器自动报警并在电子显示屏上面显示超载超限参数，若车辆自重m1和货物总重m之和大于桥梁最大承载重量Q，即时自动开启二级风险预警，报警器自动报警然后在电子显示屏上面显示超载超限参数并进行线路指导进入指定区域进行检测管制。
说明书desc
技术领域本发明涉及交通工程和人工智能技术领域。背景技术近年来城市道路高架桥货车超载超限引发的桥梁坍塌事故频频发生，造成了巨大的经济损失和人员伤亡，并且城市道路高架桥一旦坍塌很容易引起连锁反应，上面高架桥坍塌对周围的基础设施损坏较大，所以交管部门对城市道路高架桥上面行驶的货车超载超限行为高度重视，如果在城市道路高架桥前面安排交警检测货车超载超限行为，会严重阻碍交通并且所需人工成本巨大，检测效率低下。随着人工智能的快速发展，人工智能逐渐地运用到各个领域，运用人工智能检测车辆重量已经取得了较大成果，很多是基于机器视觉检测车辆轮胎的变形程度进而推算车辆重量，还有一些则是基于桥梁的静态或动态响应推算车辆重量，但是这些方法存在针对性不强，检测精度有待提高等缺点。为了杜绝或减少城市道路高架桥上面的货车超载超限行为，急需一种针对性强，检测效率高，工作量小，人工成本低的预警方法。发明内容本发明提供一种基于AI视觉的货车超载超限预警方法和系统，在城市道路高架桥两侧安装货车超载超限预警装置采集车流图像信息，通过AI视觉技术对车流图像进行分类，识别出车厢未封闭载货的货车，对该货车进行车型识别获取车辆信息，然后对车厢内常见重型货物进行识别获得名称与密度，再通过AI视觉技术测量货物尺寸得出货物体积，从而计算出货物重量，最后将货物重量和尺寸与查询到的车辆超载超限限值和桥梁最大承载值对比，对比结果输入报警模块实现预警效果，对判断为超载超限的货车进行管控，对判断为未超载超限的车辆进行正常行驶。实现了减少预警车辆数目，针对性强，效率高，人工成本低，交通影响较小等优点，保证了高架桥的正常营运，避免安全事故的发生。本发明的上述发明目的通过以下技术方案得以实现：一种基于AI视觉的货车超载超限预警方法和系统，包括以下流程：1、收集常见货车载货重物图像数据形成图像识别系统训练集，并对这些货物图像进行对应的名称和密度标签。根据训练集特征对其训练形成图像识别模型；2、多个摄像机采集车流图像，对所述车流图像先进行车流车型分类，再对分类为货车的车厢进行识别，判断车厢是否封闭，判断标准是，车厢封闭货车根据电子显示屏提示进入指定称重区域检测；对车厢不封闭货车进行识别是否空载，若为空载将正常行驶，若为载货则进行车牌号识别，并将识别到的车牌号进行储存并记录；3、将所述车厢内货物图像，输入到基于计算机视觉技术结合深度学习框架搭建好的高精度货物图像识别模型中，对车厢内货物图像进行识别，最后输出识别的结果包括货物名称和密度ρ；4、对所述车厢内货物图像基于多目视觉技术进行尺寸测量和数量统计，根据测量的货物尺寸或数量计算货物体积，并将货物体积标签为v输入到货物重量计算与输出模块；5、所述货物重量计算与输出模块中输出结果包括货物名称、密度ρ和货物体积v，通过计算可得到货物总重，并将货物总重标签为m输出；6、将所述识别的车牌号与车型信息库匹配并查询所对应货车信息，获得以下信息：货车超载限值、货物宽度限值、货物高度限值、货车自重、车厢实际宽度、车厢实际长度，对该提取货车超载限值标签为M、货物宽度限值标签为B、货物高度限值标签为H、货车自重标签为m1、车厢实际宽度标签为W、车厢实际长度标签为A；7、将所述货物体积v、货物总重m、货车超载限值M、货物宽度限值B、货物高度限值H、货车自重m1输入到超载超限对比模块，其中超载超限对比模块中根据该桥设计资料定义有该桥的最大允许荷载值Q，在超载超限对比模块中进行对比分析，并将分析结果输入到报警模块中，报警模块根据对比结果进行报警与结果显示；8、本发明进一步设置为：根据车流图像采集模块采集到的车流图像输入车型分类及车牌号识别模块，运用基于opencv的yo l o-4算法进行识别各种车型，对各种车型分类，将分类为车厢未封闭载货的货车进行车牌号识别，车牌号识别方法包括：标定车首和车尾车牌号位置、字符分割、字符识别、车首和车尾车牌号对比、车牌号输出，分类为客车和车厢未封闭空载的货车正常行驶，分类为车厢封闭的货车电子显示屏显示车牌号进行指导进入指定称重区域检测；9、常见货物图像数据库是从平时管控超载超限的车辆过程中进行拍照图片获取，载有这些货物的货车超载超限频率较高，统计常见的重型货物的名称和密度作为图像的标签；10、本发明进一步设置为：货物图像识别模块是基于深度卷积神经网络算法搭建的货物图像识别模型，对常见较重货物且形状规则的图像训练集进行训练而成的图像识别模型；11、本发明进一步设置为：货物特征提取模块是进行货物尺寸测量或统计数量，安装两排一定距离相向的摄像机阵列可以达到多目机器视觉效果，从而运用多目立体视觉方法测量货物尺寸，基本步骤包括：多目标定、立体校正、立体匹配、视差计算、深度计算，其中像素距离到实际距离的转换需要输入车厢实际宽度B或车辆实际车厢长度A。测量货物尺寸之后进行货物图片拼接，方法是基于opencv将车前摄像机采集的图片和车后摄像机采集的图片进行SIFT特征匹配拼接方法拼接成货物图片；12、本发明进一步设置为：车辆信息提取模块是将所述识别车牌号与车型信息库匹配再查询对应货车，获得以下信息：货车超载限值M、货物宽度限值B、货物高度限值H、货车自重m1、车厢实际宽度W,车辆实际车厢长度A、其中货车超载限值M、货物宽度限值B、货物高度限值H、货车自重m1输入到车辆参数输出模块进行处理，输出车厢实际宽度W、车辆实际车厢长度A，再将其输入到货物特征提取模块中进行货物尺寸测量；13、本发明进一步设置为：货物体积计算模块是运用中心处理器编程公式进行计算，其中编程公式包括常见形状规则体和散装货物的体积计算公式，比如长方体货物体积v＝货物长度a×货物宽度b×货物高度h×货物数量n，若货物为流体n＝1，若货物为块体n＝货物数量；散装货物，货物体积按车厢尺寸计算体积：v＝车厢长度A×车厢宽度W×货物高度h；14、本发明进一步设置为：货物参数输出模块是将所述拼接货物图片输入货物图像识别模块中进行识别，根据识别结果输出货物名称和密度ρ；15、本发明进一步设置为：货物重量计算模块是运用中心处理器编程公式进行计算，所述货物总重其中k是货物种类，n是货物种类总数，v是货物体积，ρ是货物密度；16、本发明进一步设置为：超载超限对比模块是将货物重量计算模块计算的结果、货物体积计算模块计算的结果和车辆参数输出模块输出的参数输入到超载超限对比模块进行对比分析，其中超载超限对比模块中根据桥梁设计资料定义了该桥的最大允许荷载值Q，将对比分析结果输入到报警模块；17、本发明进一步设置为：报警模块是超载超限对比模块输出结果显示，若对比结果为货物总重m、货物宽度b和货物高度h都小于车辆超载超限标准值M、B、H，且车辆自重m1和货物总重m之和小于桥梁最大承载重量Q时，即,车辆正常行驶；若只是货物总重m或货物宽度b或货物高度h大于车辆超载超限标准值M、B、H，即时自动开启一级风险预警，报警器自动报警并在电子显示屏上面显示超载超限参数，若车辆自重m1和货物总重m之和大于桥梁最大承载重量Q，即时自动开启二级风险预警，报警器自动报警然后在电子显示屏上面显示超载超限参数并进行线路指导进入指定区域检测管制；18、本申请的装置，在桥梁两端相隔一定距离的中央分隔带中安装两个相向分布的T型钢架置于每个车道上空，并在每个车道中心位置上空的钢架上安装两排相向的摄像机，中心处理器安装于距离桥端较近的T型钢架竖杆中间，中心处理器与多个摄像机有线连接，中心处理器与电子显示屏和报警器有线连接，中心处理器还具备远程无线发送和接收信息的功能，中心处理器接通道路设施供应电路对该装置各部分进行供电。附图说明图1是本发明实施例提供的一种基于AI视觉的货车超载超限预警系统流程示意图；图2是本发明实施例提供的一种基于AI视觉的货车超载超限预警系统装置示意图；图3是本发明实施例提供的一种基于AI视觉的货车超载超限预警系统实施例详细流程示意图；图4是本发明实施例提供的一种基于AI视觉的货车超载超限预警系统装置安装示意图。具体实施方式为了使本发明的目的、流程方案及优点更加清晰，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明。如图4所示，假如该城市道路中正有多辆汽车进入到本发明预警装置内，对这些汽车进行识别超载超限预警流程如下：根据交管部门统计的高频超载超限货车所载货物进行采集图像，将采集到的常见重型货物图像进行标签名称和对应的密度形成常见车载货物图像数据库，将该数据库作为货物图像识别模块的训练集。这些汽车进入本发明装置识别区域时，车头前方摄像机和车尾后方摄像机实时采集该车道的车流图像，运用基于opencv的yo l o-4算法进行识别各种车型，将这些车流进行车型分类识别出货车，再对识别为货车的车辆进行再次分类，将货车分为车厢封闭货车、车厢未封闭有载货车和车厢未封闭空载货车，然后将车厢未封闭有载货车进行车牌号和车厢及货物图像采集。将采集到的车牌号和车厢及货物图像输入到中心处理器，进行车牌号识别和货物图像识别，其中车牌号识别步骤为：标定车首和车尾车牌号位置、字符分割、字符识别、车首和车尾车牌号对比、车牌号输出；货物图像识别是将采集到的车厢及货物图像输入基于深度卷积神经网络算法搭建货物图像识别模型中进行识别，最终识别到货物名称和相应密度ρ，并输出到货物重量计算模块中。将识别到的车牌号与车型信息库匹配，进行车辆信息查询，得到以下信息：货车超载限值、货车所载货物体积限值、货车自重、车厢实际宽度、车厢实际长度，对该提取货车超载限值标签为M、货物宽度限值标签为B、货物高度限值标签为H、货车自重标签为m1、车厢实际宽度标签为W、车厢实际长度标签为A、其中超载限值M、货物宽度限值B、货物高度限值H、货车自重m1输入到超载超限对比模块中，车厢实际宽度W,车厢实际长度A输入到货物特征提取模块中。将提取的车厢实际宽度W和车厢实际长度A输入到货物特征提取模块进行货物尺寸测量或数量统计，货物尺寸测量方法为多目立体视觉方法，其基本步骤包括：多目标定、立体校正、立体匹配、视差计算、深度计算。将测量的货物尺寸和数量输出到货物体积计算模块中。货物计算模块输入货物尺寸时进行计算货物体积，其方法为运用中心处理器编程公式进行计算，其中编程公式包括常见形状规则体和散装货物的体积计算公式，比如长方体货物体积v＝货物长度a×货物宽度b×货物高度h×货物数量n,若货物为流体n＝1，若货物为块体n＝货物数量；散装货物，货物体积按车厢尺寸计算体积：v＝车厢长度A×车厢宽度W×货物高度h，将计算得到的货物体积v输出到货物重量计算模块中。货物重量计算模块接收到货物体积v和货物名称及对应的密度ρ时，运用中心处理器编程公式进行计算，货物总重其中k是货物种类，n是货物种类总数，v是货物体积，ρ是货物密度，将计算所得货物总重m和货物体积v输出到超载超限对比模块。超载超限对比模块首先根据该桥梁设计资料定义该桥最大允许荷载值Q，再将输入的超载限值M、货物宽度限值B、货物高度限值H、货车自重m1、货物总重m、货物宽度b和货物高度h进行对比分析，对比分析结果输出到报警模块中。报警模块收到超载超限对比模块输出结果时对该结果进行处理，处理如下：若对比结果为货物总重m、货物宽度b和货物高度h都小于车辆超载超限标准值M、B、H，且车辆自重m1和货物总重m之和小于桥梁最大承载重量Q时，即，车辆正常行驶；若只是货物总重m或货物宽度b或货物高度h大于车辆超载超限标准值M、B、H，即时自动开启一级风险预警，报警器自动报警并在电子显示屏上面显示超载超限参数，若车辆自重m1和货物总重m之和大于桥梁最大承载重量Q，即时自动开启二级风险预警，报警器自动报警然后在电子显示屏上面显示超载超限参数并进行线路指导进入指定区域进行检测管制。
