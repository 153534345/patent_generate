标题title
一种用于篡改检测和自恢复的量子图像水印方法
摘要abst
本发明公开了一种用于篡改检测和自恢复的量子图像水印方法，属于量子图像处理技术领域，将自恢复水印引入到量子水印中，并基于两级篡改检测完成量子图像的篡改定位与自恢复；具体包括如下步骤：量子图像制备；水印生成与嵌入；图像篡改检测，包括第一层篡改检测和第二层篡改检测；图像自恢复。本发明使用LSB替换方法并借助密钥图像将恢复位和认证位作为水印位嵌入到载体图像中；设计了一个两级篡改检测和定位方法，增加了篡改检测的准确性；根据篡改检测的结果，在图像自恢复阶段采用两种不同的恢复方法，增强了恢复图像的质量。
权利要求书clms
1.一种用于篡改检测和自恢复的量子图像水印方法，其特征在于，将自恢复水印引入到量子水印中，并基于两级篡改检测方法完成量子图像的篡改定位与自恢复；具体包括如下步骤：步骤1、量子图像制备，具体过程如下：步骤1.1、将灰度范围为的尺寸为2n×2n的灰度载体图像转换为基于NEQR的量子载体图像|C＞，表示形式如下：其中，q、n均表示量子位数；，|fYX＞代表量子载体图像|C＞像素的颜色信息，表示量子载体图像|C＞颜色信息的具体序列，且；|YX＞C表示量子载体图像|C＞像素的坐标位置，|Y＞表示像素在Y方向的坐标，|X＞表示像素在X方向的坐标；步骤1.2、准备尺寸为2n×2n的基于NEQR的空图像|T＞和两个空秘密图像|K＞和，表示如下： 其中，，|tYX＞代表空图像|T＞像素的颜色信息，表示空图像|T＞颜色信息的具体序列；|YX＞T表示空图像|T＞像素的坐标位置；|kYX＞、分别代表空秘密图像|K＞和像素的颜色信息；|YX＞K、分别表示空秘密图像|K＞和像素的坐标位置；；步骤2、水印生成与嵌入，具体过程如下：步骤2.1、基于恢复位生成量子电路进行恢复位的生成，并更新临时空图像|T＞和密钥图像|K ＞；步骤2.2、基于图像置乱量子电路对图像|T＞进行置乱；将图像|T＞分为4个尺寸相同的区域，交换对角线上的两个区域的像素值，当某个图像块被篡改时，它的恢复位从对角线区域的对应图像块中提取；步骤2.3、基于恢复位嵌入量子电路进行恢复位的嵌入；步骤2.4、基于认证位生成和嵌入量子电路进行认证位的生成与嵌入；步骤3、基于篡改检测与自恢复量子电路进行图像篡改检测，包括第一层篡改检测和第二层篡改检测，根据篡改检测的结果，进行图像自恢复；步骤4、图像自恢复，具体过程如下：步骤4.1、基于提取恢复位量子电路，从嵌入水印的图像中提取恢复位并存入到空图像|T＞中；步骤4.2、使用图像置乱量子电路逆置乱图像|T＞；步骤4.3、根据步骤3中篡改检测的结果，使用RY模块恢复被检测为篡改的图像块或使用RN模块恢复被检测为未被篡改的图像块。2.根据权利要求1所述用于篡改检测和自恢复的量子图像水印方法，其特征在于，所述步骤2.1中，恢复位生成量子电路包括两个8量子比特RPA模块和一个由2n-2位量子位控制的9比特量子位RPA模块、一个9量子比特D4模块、两个2n-2量子比特QE模块、六个由2位量子比特控制的CNOT门、三个CNOT门和三个由1位量子比特控制的QE模块；RPA模块包含一个RHA模块和n-1个RFA模块；RHA模块包括5个CNOT门，RFA模块包括9个CNOT模块；D4模块包括2n+1个swap门；QE模块包括2n个CNOT门和一个由n位量子比特控制的CNOT门；生成恢复位的具体过程如下：步骤2.1.1、采用量子图像分块方法将量子载体图像|C＞分为尺寸为2×2的不重叠图像块，图像块内的四个像素分别为|f＞，|f＞，|f＞和|f＞，计算图像块内4个像素的平均值并取前6位作为图像块的恢复位；在恢复位生成量子电路中，利用三个RPA模块得到块内像素值的和，将和通过D4模块，得到块内像素的平均值|s＞=| s7s6⋯s0＞，并取|s7＞,|s6＞,⋯,|s2＞作为恢复位；步骤2.1.2、将量子载体图像|C ＞的位置信息|Yn-1Yn-2⋯Y1＞C |Xn-1Xn-2⋯X1＞C与空图像|T＞的位置信息|Yn-1Yn-2⋯Y1 ＞T |Xn-1Xn-2⋯X1 ＞T通过QE模块；当QE模块输出|1＞时，载体图像块与空图像|T＞的图像块具有相同的位置；此时，通过CNOT门将载体图像块的6位恢复位|s7＞,|s6＞,⋯,|s2＞临时存储在图像|T＞的图像块内，图像块内的四个像素分别为|t＞，|t＞，|t＞和|t＞；存储规则为：‘|s2＞,|s3＞’-|t＞;‘|s4＞,|s5＞’-|t＞;‘|s6＞,|s7＞’-|t＞；步骤2.1.3、使用QE模块比较位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与|Yn-1Yn-2⋯Y1＞K |Xn-1Xn-2⋯X1＞K；当QE输出|1＞时，载体图像块与密钥图像块位置对应；此时利用三个QE模块分别比较恢复位|s2＞和|s3＞，|s4＞和|s5＞与|s6＞和|s7＞是否相等；若QE模块输出|0＞，则对应的两位恢复位不相等，此时通过CNOT门在密钥图像|K＞的对应像素|k＞，|k＞或|k＞中存入|1＞。3.根据权利要求2所述用于篡改检测和自恢复的量子图像水印方法，其特征在于，所述步骤2.2中，图像置乱量子电路包含两个NOT门；图像置乱的具体过程如下：利用两个NOT门分别作用在|T＞的|Xn-1＞T和|Yn-1＞T上，对图像|T＞实现置乱；得到的置乱的临时图像表示如下：其中，；表示临时图像像素的坐标位置。4.根据权利要求3所述用于篡改检测和自恢复的量子图像水印方法，其特征在于，所述步骤2.3中，恢复位嵌入量子电路包含一个2n-2量子比特QE模块，三个由1位量子比特控制的swap门；嵌入恢复位的具体过程如下：将载体图像|C＞的位置信息|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与置乱的临时恢复位图像的位置信息通过QE模块；当QE模块输出|1＞时，载体图像块与临时恢复位图像块位置对应；此时，利用swap门将载体图像|C＞中像素的3位LSB|f0＞、|f0＞和|f0＞与图像|T＞中像素对应的3位LSB、和交换，完成恢复位的嵌入。5.根据权利要求4所述用于篡改检测和自恢复的量子图像水印方法，其特征在于，所述步骤2.4中，认证位生成和嵌入量子电路包括三个NOT门、两个由2n-2位量子比特控制的RPA模块、一个2n-2量子比特QE模块、四个由1位量子比特控制的QE模块、15个CNOT模块、四个swap门和一个由1位量子比特控制的swap 门；认证位生成和嵌入的具体过程如下：步骤2.4.1、选择载体图像块中的三个像素|f＞、|f＞和|f＞，将像素|f＞的第七位|f7＞，像素|f＞的第五位|f5＞和像素|f＞的第六位|f6＞通过NOT门进行翻转后得到新像素；将新像素|f＞与|f＞通过RPA模块，输出|r＞；将新像素|f＞与|f＞通过RPA模块，输出；准备4个辅助位|0＞，将|r＞与的第3到6位分别通过CNOT门进行模加运算，将得到的模加值作为4位认证位赋值给4位辅助位|0＞；步骤2.4.2、将载体图像|C＞的位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与密钥图像的位置通过QE模块，当QE模块输出|1＞时，载体图像块与密钥图像块对应；此时分别将4位认证位与载体图像块中4个像素的倒数第二位LSB通QE模块进行比较；若QE模块输出|1＞，即认证位与对应载体像素位相等，则通过NOT门在对应的密钥位，，或中存入|1＞；若QE模块输出|0＞，则在对应的密钥位中存入|0＞；步骤2.4.3、载体图像块中四个像素的倒数第二位LSB分别通过swap门与4位认证位进行交换，以完成第一层认证位的嵌入；同时，利用CNOT门将密钥图像块内的，和的模加值作为一位认证位存入到辅助位|0＞中；当载体图像块的位置对应于密钥图像块的位置时，通过swap门将一位认证位嵌入到|f0＞中，实现第二层认证位的嵌入；在载体图像|C＞中嵌入水印后得到嵌入水印的图像|CW＞，其表示如下： 其中，|YX＞CW表示嵌入水印的图像|CW＞像素的坐标位置。6.根据权利要求5所述用于篡改检测和自恢复的量子图像水印方法，其特征在于，所述步骤3中，篡改检测与自恢复量子电路包括三个NOT门、两个由2n-2位量子比特控制的RPA模块、11个CNOT门、一个2n-2量子比特QE模块、一个4量子比特QE模块、一个由1位量子比特控制的QE模块、一个由3位量子比特控制的RN模块和两个由1位量子比特控制的RY模块；图像篡改检测的具体过程如下：步骤3.1、将嵌入水印的载体图像分为尺寸为2×2的不重叠图像块；将块内像素的|f7＞，|f5＞和|f6＞位通过NOT门进行翻转后得到新像素；将新像素|f＞与|f＞通过RPA模块，输出|r'＞，将新像素|f＞与|f＞通过RPA模块，输出；将|r'＞与的第3到6位分别通过CNOT门进行模加运算；得到重新计算的4位认证位并赋值给辅助位|0＞；步骤3.2、通过QE模块比较在步骤3.1中得到的4位新认证位与|f1＞，|f1＞，|f1＞和|f1＞，此为第一层篡改检测；将载体图像|C＞的位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与密钥图像的位置通过QE模块；当QE模块输出|1＞时，载体图像块与密钥图像块的位置相对应；此时通过计算，和的模加值得到1位新的认证位；将重新计算得到的认证位与提取出的1位认证位|f0＞通过QE模块进行比较，此为第二层篡改检测；步骤3.3、当用于篡改检测的两个QE模块中至少1个输出|0＞时，此时判断图像块被篡改，使用RY模块进行图像块恢复；当两个QE模块都输出|1＞时，判断图像块未被篡改，此时使用RN模块对图像块进行恢复。7.根据权利要求6所述用于篡改检测和自恢复的量子图像水印方法，其特征在于，所述步骤4.1中，恢复位提取量子电路包含两个2n-2量子比特QE模块、六个由2位量子比特控制的CNOT门和3个由2位量子比特控制的NOT门；恢复位提取的具体过程如下：将图像|CW＞的位置|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与空图像|T＞的位置|Yn-1Yn-2⋯Y1＞T|Xn-1Xn-2⋯X1＞T通过QE比较模块；当QE输出|1＞时，在嵌入水印的载体图像块中提取出3位水印位|f1＞CW，|f1＞CW和|f1＞CW并存入到|T＞对应像素的LSB|t0＞，|t0＞和|t0＞中；将|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与|Yn-1Yn-2⋯Y1＞K|Xn-1Xn-2⋯X1＞K通过QE比较模块，当QE输出|1＞时，根据密钥|K＞的值，提取出另3位水印位并存入到|T＞对应像素的第二位LSB|t1＞，|t1＞，|t1＞中；使用CNOT门将|t0＞，|t0＞，|t0＞的值赋值给|t1＞，|t1＞，|t1＞；当|K＞=|1＞时，使用NOT门翻转|t1＞，|t1＞或|t1＞。8.根据权利要求1所述用于篡改检测和自恢复的量子图像水印方法，其特征在于，所述步骤4.3的具体过程如下：步骤4.3.1、当图像块被检测为被篡改时，使用RY模块进行图像块恢复；RY模块包括一个2n-2量子比特QE模块和四个由1位量子比特控制的QA模块；其中一个n量子比特QA模块包含n个CNOT门和n个交换门；RY模块恢复过程如下：将图像|CW＞的位置|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与逆置乱图像|T＞的位置|Yn-1Yn-2⋯Y1＞T|Xn-1Xn-2⋯X1＞T通过QE模块；当QE模块输出|1＞时，将|T＞的图像块中存储的6位恢复位和两位辅助位|0＞作为被篡改图像块的恢复值；使用QA模块将8位恢复序列赋值给图像|CW＞中对应像素块的4个像素|f ＞，|f ＞，|f ＞和|f ＞；步骤4.3.2、当图像块被检测为未被篡改时，使用RN模块恢复图像块；RN模块包括一个2n-2量子比特QE模块和四个由2位量子比特控制的NOT门；RN模块恢复过程如下：将|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与通过QE模块；当QE模块输出|1＞时，|C＞与图像块的位置相对应；在图像块的4个像素中，以位置为例，当，则嵌入的水印位与原载体位不相等，此时使用NOT门翻转图像|CW＞中的对应像素位|f1＞CW。
说明书desc
技术领域本发明属于量子图像处理技术领域，具体涉及一种用于篡改检测和自恢复的量子图像水印方法。背景技术量子计算与量子信息处理是当下的热门领域，受到了大量学者的关注。量子信息处理将量子力学与经典计算机体系相结合形成了量子计算体系。由于利用量子的叠加性、纠缠性等特殊性质，量子计算体系具有较传统计算体系更快的处理速度，并且能够处理部分传统计算领域不能解决的问题。近二十年来随着量子信息处理领域的迅速发展，量子计算与传统图像处理结合形成的交叉学科量子图像处理也被大量研究者涉足。大量QIMP相关的研究成果被提出。数字水印是将特定的信息嵌入到数字载体中以保护数字产品版权、完整性或安全性的技术。近几十年计算机技术得到了快速发展，信息的获取、拷贝、处理变得越来越容易。因此，数字水印技术受到了相关科研工作者的重视。量子水印将数字水印扩展到量子计算系统中。当下对量子水印的研究分为将传统数字水印方法转换成量子水印方法及利用量子的特性提出新的量子水印方法。大量量子水印方法已经被提出。现存的量子水印方法已经具备图像版权认证的功能，但是还缺乏用于保护图像完整性的量子水印方案的研究。因此，需要继续探索和发展具有篡改定位和恢复篡改信息功能的量子水印方法。发明内容为了解决上述问题，本发明提出了一种用于篡改检测和自恢复的量子图像水印方法，设计了专用量子电路，在篡改检测中使用了两级篡改检测方法，增加了篡改检测的准确性；在图像自恢复阶段采用两种不同的恢复方法，增强了恢复图像的质量。本发明的技术方案如下：一种用于篡改检测和自恢复的量子图像水印方法，将自恢复水印引入到量子水印中，并基于两级篡改检测方法完成量子图像的篡改定位与自恢复；具体包括如下步骤：步骤1、量子图像制备，具体过程如下：步骤1.1、将灰度范围为的尺寸为2n×2n的灰度载体图像转换为基于NEQR的量子载体图像|C＞，表示形式如下：其中，q、n均表示量子位数；，|fYX＞代表量子载体图像|C＞像素的颜色信息，表示量子载体图像|C＞颜色信息的具体序列，且；|YX＞C表示量子载体图像|C＞像素的坐标位置，|Y＞表示像素在Y方向的坐标，|X＞表示像素在X方向的坐标；步骤1.2、准备尺寸为2n×2n的基于NEQR的空图像|T＞和两个空秘密图像|K＞和，表示如下： 其中，，|tYX＞代表空图像|T＞像素的颜色信息，表示空图像|T＞颜色信息的具体序列；|YX＞T表示空图像|T＞像素的坐标位置；|kYX＞、分别代表空秘密图像|K＞和像素的颜色信息；|YX＞K、分别表示空秘密图像|K＞和像素的坐标位置；；步骤2、水印生成与嵌入，具体过程如下：步骤2.1、基于恢复位生成量子电路进行恢复位的生成，并更新临时空图像|T＞和密钥图像|K ＞；步骤2.2、基于图像置乱量子电路对图像|T＞进行置乱；将图像|T＞分为4个尺寸相同的区域，交换对角线上的两个区域的像素值，当某个图像块被篡改时，它的恢复位从对角线区域的对应图像块中提取；步骤2.3、基于恢复位嵌入量子电路进行恢复位的嵌入；步骤2.4、基于认证位生成和嵌入量子电路进行认证位的生成与嵌入；步骤3、基于篡改检测与自恢复量子电路进行图像篡改检测，包括第一层篡改检测和第二层篡改检测，根据篡改检测的结果，进行图像自恢复；步骤4、图像自恢复，具体过程如下：步骤4.1、基于提取恢复位量子电路，从嵌入水印的图像中提取恢复位并存入到空图像|T＞中；步骤4.2、使用图像置乱量子电路逆置乱图像|T＞；步骤4.3、根据步骤3中篡改检测的结果，使用RY模块恢复被检测为篡改的图像块或使用RN模块恢复被检测为未被篡改的图像块。进一步地，步骤2.1中，恢复位生成量子电路包括两个8量子比特RPA模块和一个由2n-2位量子位控制的9比特量子位RPA模块、一个9量子比特D4模块、两个2n-2量子比特QE模块、六个由2位量子比特控制的CNOT门、三个CNOT门和三个由1位量子比特控制的QE模块；RPA模块包含一个RHA模块和n-1个RFA模块；RHA模块包括5个CNOT门，RFA模块包括9个CNOT模块；D4模块包括2n+1个swap门；QE模块包括2n个CNOT门和一个由n位量子比特控制的CNOT门；生成恢复位的具体过程如下：步骤2.1.1、采用量子图像分块方法将量子载体图像|C＞分为尺寸为2×2的不重叠图像块，图像块内的四个像素分别为|f＞，|f＞，|f＞和|f＞，计算图像块内4个像素的平均值并取前6位作为图像块的恢复位；在恢复位生成量子电路中，利用三个RPA模块得到块内像素值的和，将和通过D4模块，得到块内像素的平均值|s＞=| s7s6⋯s0＞，并取|s7＞,|s6＞,⋯,|s2＞作为恢复位；步骤2.1.2、将量子载体图像|C ＞的位置信息|Yn-1Yn-2⋯Y1＞C |Xn-1Xn-2⋯X1＞C与空图像|T＞的位置信息|Yn-1Yn-2⋯Y1 ＞T |Xn-1Xn-2⋯X1 ＞T通过QE模块；当QE模块输出|1＞时，载体图像块与空图像|T＞的图像块具有相同的位置；此时，通过CNOT门将载体图像块的6位恢复位|s7＞,|s6＞,⋯,|s2＞临时存储在图像|T＞的图像块内，图像块内的四个像素分别为|t＞，|t＞，|t＞和|t＞；存储规则为：‘|s2＞,|s3＞’-|t＞;‘|s4＞,|s5＞’-|t＞;‘|s6＞,|s7＞’-|t＞；步骤2.1.3、使用QE模块比较位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与|Yn-1Yn-2⋯Y1＞K |Xn-1Xn-2⋯X1＞K；当QE输出|1＞时，载体图像块与密钥图像块位置对应；此时利用三个QE模块分别比较恢复位|s2＞和|s3＞，|s4＞和|s5＞与|s6＞和|s7＞是否相等；若QE模块输出|0＞，则对应的两位恢复位不相等，此时通过CNOT门在密钥图像|K＞的对应像素|k＞，|k＞或|k＞中存入|1＞。进一步地，步骤2.2中，图像置乱量子电路包含两个NOT门；图像置乱的具体过程如下：利用两个NOT门分别作用在|T＞的|Xn-1＞T和|Yn-1＞T上，对图像|T＞实现置乱；得到的置乱的临时图像表示如下：其中，；表示临时图像像素的坐标位置。进一步地，步骤2.3中，恢复位嵌入量子电路包含一个2n-2量子比特QE模块，三个由1位量子比特控制的swap门；嵌入恢复位的具体过程如下：将载体图像|C＞的位置信息|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与置乱的临时恢复位图像的位置信息通过QE模块；当QE模块输出|1＞时，载体图像块与临时恢复位图像块位置对应；此时，利用swap门将载体图像|C＞中像素的3位LSB|f0＞、|f0＞和|f0＞与图像|T＞中像素对应的3位LSB、和交换，完成恢复位的嵌入。进一步地，步骤2.4中，认证位生成和嵌入量子电路包括三个NOT门、两个由2n-2位量子比特控制的RPA模块、一个2n-2量子比特QE模块、四个由1位量子比特控制的QE模块、15个CNOT模块、四个swap门和一个由1位量子比特控制的swap 门；认证位生成和嵌入的具体过程如下：步骤2.4.1、选择载体图像块中的三个像素|f＞、|f＞和|f＞，将像素|f＞的第七位|f7＞，像素|f＞的第五位|f5＞和像素|f＞的第六位|f6＞通过NOT门进行翻转后得到新像素；将新像素|f＞与|f＞通过RPA模块，输出|r＞；将新像素|f＞与|f＞通过RPA模块，输出；准备4个辅助位|0＞，将|r＞与的第3到6位分别通过CNOT门进行模加运算，将得到的模加值作为4位认证位赋值给4位辅助位|0＞；步骤2.4.2、将载体图像|C＞的位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与密钥图像的位置通过QE模块，当QE模块输出|1＞时，载体图像块与密钥图像块对应；此时分别将4位认证位与载体图像块中4个像素的倒数第二位LSB通QE模块进行比较；若QE模块输出|1＞，即认证位与对应载体像素位相等，则通过NOT门在对应的密钥位，，或中存入|1＞；若QE模块输出|0＞，则在对应的密钥位中存入|0＞；步骤2.4.3、载体图像块中四个像素的倒数第二位LSB分别通过swap门与4位认证位进行交换，以完成第一层认证位的嵌入；同时，利用CNOT门将密钥图像块内的，和的模加值作为一位认证位存入到辅助位|0＞中；当载体图像块的位置对应于密钥图像块的位置时，通过swap门将一位认证位嵌入到|f0＞中，实现第二层认证位的嵌入；在载体图像|C＞中嵌入水印后得到嵌入水印的图像|CW＞，其表示如下： 其中，|YX＞CW表示嵌入水印的图像|CW＞像素的坐标位置。进一步地，步骤3中，篡改检测与自恢复量子电路包括三个NOT门、两个由2n-2位量子比特控制的RPA模块、11个CNOT门、一个2n-2量子比特QE模块、一个4量子比特QE模块、一个由1位量子比特控制的QE模块、一个由3位量子比特控制的RN模块和两个由1位量子比特控制的RY模块；图像篡改检测的具体过程如下：步骤3.1、将嵌入水印的载体图像分为尺寸为2×2的不重叠图像块；将块内像素的|f7＞，|f5＞和|f6＞位通过NOT门进行翻转后得到新像素；将新像素|f＞与|f＞通过RPA模块，输出|r'＞，将新像素|f＞与|f＞通过RPA模块，输出；将|r'＞与的第3到6位分别通过CNOT门进行模加运算；得到重新计算的4位认证位并赋值给辅助位|0＞；步骤3.2、通过QE模块比较在步骤3.1中得到的4位新认证位与|f1＞，|f1＞，|f1＞和|f1＞，此为第一层篡改检测；将载体图像|C＞的位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与密钥图像的位置通过QE模块；当QE模块输出|1＞时，载体图像块与密钥图像块的位置相对应；此时通过计算，和的模加值得到1位新的认证位；将重新计算得到的认证位与提取出的1位认证位|f0＞通过QE模块进行比较，此为第二层篡改检测；步骤3.3、当用于篡改检测的两个QE模块中至少1个输出|0＞时，此时判断图像块被篡改，使用RY模块进行图像块恢复；当两个QE模块都输出|1＞时，判断图像块未被篡改，此时使用RN模块对图像块进行恢复。进一步地，步骤4.1中，恢复位提取量子电路包含两个2n-2量子比特QE模块、六个由2位量子比特控制的CNOT门和3个由2位量子比特控制的NOT门；恢复位提取的具体过程如下：将图像|CW＞的位置|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与空图像|T＞的位置|Yn-1Yn-2⋯Y1＞T|Xn-1Xn-2⋯X1＞T通过QE比较模块；当QE输出|1＞时，在嵌入水印的载体图像块中提取出3位水印位|f1＞CW，|f1＞CW和|f1＞CW并存入到|T＞对应像素的LSB|t0＞，|t0＞和|t0＞中；将|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与|Yn-1Yn-2⋯Y1＞K|Xn-1Xn-2⋯X1＞K通过QE比较模块，当QE输出|1＞时，根据密钥|K＞的值，提取出另3位水印位并存入到|T＞对应像素的第二位LSB|t1＞，|t1＞，|t1＞中；使用CNOT门将|t0＞，|t0＞，|t0＞的值赋值给|t1＞，|t1＞，|t1＞；当|K＞=|1＞时，使用NOT门翻转|t1＞，|t1＞或|t1＞。进一步地，步骤4.3的具体过程如下：步骤4.3.1、当图像块被检测为被篡改时，使用RY模块进行图像块恢复；RY模块包括一个2n-2量子比特QE模块和四个由1位量子比特控制的QA模块；其中一个n量子比特QA模块包含n个CNOT门和n个交换门；RY模块恢复过程如下：将图像|CW＞的位置|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与逆置乱图像|T＞的位置|Yn-1Yn-2⋯Y1＞T|Xn-1Xn-2⋯X1＞T通过QE模块；当QE模块输出|1＞时，将|T＞的图像块中存储的6位恢复位和两位辅助位|0＞作为被篡改图像块的恢复值；使用QA模块将8位恢复序列赋值给图像|CW＞中对应像素块的4个像素|f ＞，|f ＞，|f ＞和|f ＞；步骤4.3.2、当图像块被检测为未被篡改时，使用RN模块恢复图像块；RN模块包括一个2n-2量子比特QE模块和四个由2位量子比特控制的NOT门；RN模块恢复过程如下：将|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与通过QE模块；当QE模块输出|1＞时，|C＞与图像块的位置相对应；在图像块的4个像素中，以位置为例，当，则嵌入的水印位与原载体位不相等，此时使用NOT门翻转图像|CW＞中的对应像素位|f1＞CW。本发明所带来的有益技术效果：本发明将图像自恢复水印引入到量子水印中，提出了一个新颖的量子图像自恢复水印方案，并设计了专用量子电路；使用LSB替换方法并借助密钥图像将恢复位和认证位作为水印位嵌入到载体图像中，嵌入水印的图像的PSNR达到44dB；设计了一个两级篡改检测和定位方法，增加了篡改检测的准确性；根据篡改检测的结果，在图像自恢复阶段采用两种不同的恢复方法，增强了恢复图像的质量；本发明方法对常见的恶意攻击具有良好的篡改检测和自恢复能力，且平衡了嵌入水印图像的视觉效果和恢复图像的质量。附图说明图1为本发明方法的整体流程图；图2为现有技术RHA模块的量子电路和简化示意图；图3为现有技术RFA模块的量子电路和简化示意图；图4为现有技术RPA模块的量子电路和简化示意图；图5为本发明D4模块的量子电路和简化示意图；图6为现有技术QE模块的量子电路和简化示意图；图7为本发明QA模块的量子电路和简化示意图；图8为本发明水印生成与嵌入流程图；图9为本发明恢复位生成的量子电路图；图10为本发明图像置乱的量子电路图；图11为本发明恢复位嵌入的量子电路图；图12为本发明认证位生成与嵌入的量子电路图；图13为本发明图像篡改检测和自恢复流程图；图14为本发明图像篡改检测与自恢复的量子电路图；图15为本发明恢复位提取的量子电路图；图16为本发明RY模块的量子电路图；图17为本发明RN模块的量子电路图。具体实施方式下面结合附图以及具体实施方式对本发明作进一步详细说明：自恢复水印方法将图像自身信息及认证信息作为水印嵌入到载体图像中，使图像具有篡改检测及自恢复的能力。本文首次将自恢复水印引入到量子水印中，并设计了基于两级篡改检测的量子图像篡改定位与自恢复方案。如图1所示，本发明主要流程为：图像预处理、水印生成与嵌入、图像篡改检测与自恢复。下面详细介绍本发明的技术方案，包括用到的几个关键技术。一、NEQR新型增强量子图像表示模型是目前最常被采用的量子图像表示模型之一。对于一个尺寸为2n×2n灰度范围为的灰度图像，NEQR模型用2n位量子基本态序列表示像素的位置，用q位量子基本态序列表示像素的颜色，并利用量子的纠缠特性，将像素的位置与颜色形成归一化的量子态。因此，基于NEQR表示一个尺寸为2n×2n灰度范围为的灰度图像只需要2n+q个量子位。NEQR图像的表达形式如下： 其中，|YX＞=|Y＞|X＞=|Yn-1Yn-2⋯Y0＞|Xn-1Xn-2⋯X0＞，|YX＞表示像素的坐标位置，|Y＞表示像素在Y方向的坐标，|Yn-1Yn-2⋯Y0＞表示Y方向坐标的具体序列，|X＞表示像素在X方向的坐标，|Xn-1Xn-2⋯X0＞表示X方向坐标的具体序列；，|fYX＞代表像素的颜色信息，表示颜色信息的具体序列，且。二、LSB替换方法LSB是二进制序列的最低有效位。LSB替换方法是将像素的LSB替换成秘密信息，以实现秘密信息嵌入的方法。由于人眼对像素值的微小变化不敏感，因此LSB替换法具有良好的视觉效果，并得到了广泛的应用。比如以一个值为252的二进制序列为例，此时，二进制序列的LSB为0，将秘密消息1嵌入到二进制序列中，二进制序列的值从252变为253。三、量子电路1、可逆并行加法器可逆并行加法器是用于对两个量子序列进行加法运算的现有技术。RPA模块包含图2所示的可逆半加器和图3所示的可逆全加器。用于计算两个n位量子位序列|A＞=|an-1an-2⋯a0＞和|B＞=|bn-1bn-2⋯b0＞之和的RPA模块的量子电路如图4所示。输出的量子态|A+B＞=|rnrn-1rn-2⋯r0＞为A与B的和，rk∈{0,1}，k=0,…,n。2、除4模块D4模块用于计算量子序列除以4后的值。如图5所示，输入n位量子位序列|A＞=|an-1an-2⋯a0＞和两个辅助量子位|0＞，通过2n+1个交换门输出|A＞除以4得到的值。3、量子等价模块量子等价模块是用于比较两个量子序列的现有模块。如图6所示，输入两个n位量子序列|P＞=|pn-1pn-2⋯p0＞和|Q＞=|qn-1qn-2⋯q0＞，且pi,qi∈{0,1}，i=0,…,n-1。比较结果由输出量子位|c＞决定。如果|c＞=|0＞，则|P＞≠|Q＞。如果|c＞=|1＞，则|P＞=|Q＞。4、量子赋值模块量子赋值模块用于将n位量子序列|A＞=|an-1an-2⋯a0＞分配给另一个n位量子序列|B＞=|bn-1bn-2⋯b0＞。如图7所示，二进制序列|A＞=|an-1an-2⋯a0＞通过n个受控非门被存储在n个辅助量子位|0＞中。然后，通过n个swap门交换二进制序列|B＞=|bn-1bn-2⋯b0＞与n位辅助位的值，且QA模块输出二进制序列|B'＞=|b'n-1,b'n-2,⋯b'0＞=|A＞，b'i∈{0,1}，i=0,…,n-1。四、本发明技术方案详细内容本发明首先将图像分为尺寸为2×2的不重叠图像块，并以2×2的图像块为单位实现方法的各个步骤，即水印生成、水印嵌入、水印提取、图像篡改检测与自恢复。在本发明中，对块内像素进行特定计算生成水印位，一个图像块的水印位包含6位恢复位与5位认证位。认证位用于检测图像块是否被篡改，恢复位用于恢复被篡改的信息。将生成的水印位嵌入到载体像素的2位LSB中。在上述过程中生成密钥|K＞和。并且设计了一种两级篡改检测方法对图像块进行篡改检测。如果检测到图像块被篡改，则使用设计的RY模块恢复图像块；如果检测到图像块未被篡改，则使用设计的RN模块恢复图像块。具体步骤如下：步骤1、量子图像制备，具体过程如下：步骤1.1、将灰度范围为的尺寸为2n×2n的灰度载体图像转换为基于NEQR的量子载体图像|C＞，表示形式如下：其中，，|fYX＞代表量子载体图像|C＞像素的颜色信息，表示量子载体图像|C＞颜色信息的具体序列，且；|YX＞C表示量子载体图像|C＞像素的坐标位置；步骤1.2、准备尺寸为2n×2n的基于NEQR的空图像|T＞和两个空秘密图像|K＞和，表示如下： 其中，，|tYX＞代表空图像|T＞像素的颜色信息，表示空图像|T＞颜色信息的具体序列；|YX＞T表示空图像|T＞像素的坐标位置；|kYX＞、分别代表空秘密图像|K＞和像素的颜色信息；|YX＞K、分别表示空秘密图像|K＞和像素的坐标位置；。步骤2、水印生成与嵌入，水印生成与嵌入的整体流程如图8所示，具体过程如下：步骤2.1、基于恢复位生成量子电路进行恢复位的生成，并更新临时空图像|T＞和密钥图像|K ＞；生成恢复位的量子电路如图9所示，量子电路的具体描述及恢复位生成的具体过程如下：步骤2.1.1、采用量子图像分块方法将量子载体图像|C＞分为尺寸为2×2的不重叠图像块，图像块内的四个像素分别为|f＞，|f＞，|f＞和|f＞，计算图像块内4个像素的平均值并取前6位作为图像块的恢复位；在图9中，利用三个RPA模块得到块内像素值的和，将和通过D4模块，得到块内像素的平均值|s＞=| s7s6⋯s0＞，并取|s7＞,|s6＞,⋯,|s2＞作为恢复位。步骤2.1.2、将量子载体图像|C ＞的位置信息|Yn-1Yn-2⋯Y1＞C |Xn-1Xn-2⋯X1＞C与空图像|T＞的位置信息|Yn-1Yn-2⋯Y1 ＞T |Xn-1Xn-2⋯X1 ＞T通过QE模块。当QE模块输出|1＞时，载体图像块与空图像|T＞的图像块具有相同的位置。此时，通过CNOT门将载体图像块的6位恢复位|s7＞,|s6＞,⋯,|s2＞临时存储在图像|T＞的图像块内，图像块内的四个像素分别为|t＞，|t＞，|t＞和|t＞。存储规则为：‘|s2＞,|s3＞’-|t＞;‘|s4＞,|s5＞’-|t＞;‘|s6＞,|s7＞’-|t＞。步骤2.1.3、使用QE模块比较位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与|Yn-1Yn-2⋯Y1＞K |Xn-1Xn-2⋯X1＞K。当QE输出|1＞时，载体图像块与密钥图像块位置对应。此时利用三个QE模块分别比较恢复位|s2＞和|s3＞，|s4＞和|s5＞与|s6＞和|s7＞是否相等。若QE模块输出|0＞，则对应的两位恢复位不相等，此时通过CNOT门在密钥图像|K＞的对应像素|k＞，|k＞或|k＞中存入|1＞。步骤2.2、基于图像置乱量子电路进行图像的置乱；若将一个载体图像块的恢复位嵌入到该图像块本身，则当图像块被篡改时，该图像块的恢复位大概率也会被篡改。为了避免上述问题，在本方法中，将图像|T＞分为4个尺寸相同的区域，交换对角线上的两个区域的像素值。当某个图像块被篡改时，它的恢复位可以从对角线区域的对应图像块中提取。实现图像置乱的量子电路如图10所示。利用两个非门分别作用在|T＞的|Xn-1＞T和|Yn-1＞T上，对图像|T＞实现上述置乱。得到的置乱的临时图像表示如下：其中，；表示临时图像像素的坐标位置。步骤2.3、基于恢复位嵌入量子电路进行恢复位的嵌入；图11显示了在载体图像|C＞中嵌入恢复位的量子电路，以下为量子电路及恢复位嵌入过程的具体描述：将载体图像|C＞的位置信息|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与置乱的临时恢复位图像的位置信息通过QE模块。当QE模块输出|1＞时，载体图像块与临时恢复位图像块位置对应。此时，利用swap门将载体图像|C＞中像素的3位LSB|f0＞、|f0＞和|f0＞与图像|T＞中像素对应的3位LSB 、和交换，完成恢复信息的嵌入。步骤2.4、基于认证位生成和嵌入量子电路进行认证位的生成与嵌入；本发明方法在载体像素的2位LSB中嵌入水印位。为了保证水印位的嵌入不影响认证位的计算，所以设计认证位根据载体像素的前6位计算生成。图12显示了认证位生成并嵌入到载体图像中的量子电路。量子电路及步骤的具体描述如下：步骤2.4.1、选择载体图像块中的三个像素|f＞、|f＞和|f＞，将像素|f＞的第七位|f7＞，像素|f＞的第五位|f5＞和像素|f＞的第六位|f6＞通过NOT门进行翻转后得到新像素。将新像素|f＞与|f＞通过RPA模块，输出|r＞。将新像素|f＞与|f＞通过RPA模块，输出。准备4个辅助位|0＞，将|r＞与的第3到6位分别通过CNOT门进行模加运算，将得到的模加值作为4位认证位赋值给4位辅助位|0＞。步骤2.4.2、将载体图像|C＞的位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与密钥图像的位置通过QE模块，当QE模块输出|1＞时，载体图像块与密钥图像块对应。此时分别将4位认证位与载体图像块中4个像素的倒数第二位LSB通QE模块进行比较。若QE模块输出|1＞，即认证位与对应载体像素位相等，则通过NOT门在对应的密钥位，，或中存入|1＞。若QE模块输出|0＞，则在对应的密钥位中存入|0＞。步骤2.4.3、载体图像块中四个像素的倒数第二位LSB分别通过swap门与4位认证位进行交换，以完成第一层认证位的嵌入。同时，利用CNOT门将密钥图像块内的，和的模加值作为一位认证位存入到辅助位|0＞中。当载体图像块的位置对应于密钥图像块的位置时，通过swap门将一位认证位嵌入到|f0＞中，实现第二层认证位的嵌入。在载体图像|C＞中嵌入水印后得到嵌入水印的图像|CW＞，其表示如下： 其中，|YX＞CW表示嵌入水印的图像|CW＞像素的坐标位置。步骤3、图像篡改检测；图像篡改检测过程通过对比从图像|CW＞的图像块中提取出的认证位与重新计算得到的认证位是否相等来判断图像块是否被篡改。图13为图像篡改检测和自恢复的整体流程。图14展示了篡改检测与自恢复的量子电路。下面给出图像篡改检测的详细步骤与量子电路的具体描述。步骤3.1、将嵌入水印的载体图像分为尺寸为2×2的不重叠图像块。将块内像素的|f7＞，|f5＞和|f6＞位通过NOT门进行翻转后得到新像素。将新像素|f＞与|f＞通过RPA模块，输出|r'＞，将新像素|f＞与|f＞通过RPA模块，输出。将|r'＞与的第3到6位分别通过CNOT门进行模加运算。得到重新计算的4位认证位并赋值给辅助位|0＞。步骤3.2、通过QE模块比较在步骤3.1中得到的4位新认证位与|f1＞，|f1＞，|f1＞和|f1＞，此为第一层篡改检测。将载体图像|C＞的位置|Yn-1Yn-2⋯Y1＞C|Xn-1Xn-2⋯X1＞C与密钥图像的位置通过QE模块。当QE模块输出|1＞时，载体图像块与密钥图像块的位置相对应。此时通过计算，和的模加值得到1位新的认证位。将重新计算得到的1位认证位与提取出的1位认证位|f0＞通过QE模块进行比较，此为第二层篡改检测。步骤3.3、当用于篡改检测的两个QE模块中至少1个输出|0＞时，即重新计算的认证位与提取的认证位不相等。此时判断图像块被篡改，使用RY模块进行图像块恢复；当两个QE模块都输出|1＞时，判断图像块未被篡改，此时使用RN模块对图像块进行恢复。步骤4、图像自恢复步骤4.1、基于恢复位提取量子电路，从嵌入水印的图像|CW＞中提取恢复位并存入到空图像|T＞中，图15展示了提取恢复位的量子电路，电路的详细描述如下：将图像|CW＞的位置|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与空图像|T＞的位置|Yn-1Yn-2⋯Y1＞T|Xn-1Xn-2⋯X1＞T通过QE比较模块。当QE输出|1＞时，在嵌入水印的载体图像块中提取出3位水印位|f1＞CW，|f1＞CW和|f1＞CW并存入到|T＞对应像素的LSB|t0＞，|t0＞和|t0＞中。将|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与|Yn-1Yn-2⋯Y1＞K|Xn-1Xn-2⋯X1＞K通过QE比较模块，当QE输出|1＞时，根据密钥|K＞的值，提取出另3位水印位并存入到|T＞对应像素的第二位LSB|t1＞，|t1＞，|t1＞中。以位置为例，当|k＞=|1＞，|t1＞=|t0＞；当|K＞=|0＞，|t1＞=|mod0+1，2)＞。使用CNOT门将|t0＞，|t0＞，|t0＞的值赋值给|t1＞，|t1＞，|t1＞。当|K＞=|1＞时，使用NOT门翻转|t1＞，|t1＞或|t1＞。步骤4.2、使用图10所示量子图像置乱电路逆置乱图像|T＞。步骤4.3、根据步骤3中篡改检测的结果，使用RY模块恢复被篡改的图像块或使用RN模块恢复未被篡改的图像块。步骤4.3.1、当图像块被检测为被篡改时，使用如图16所示的RY模块进行图像块恢复，电路的具体描述如下：将图像|CW＞的位置|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与逆置乱后的图像|T＞的位置|Yn-1Yn-2⋯Y1＞T|Xn-1Xn-2⋯X1＞T通过QE模块。当QE模块输出|1＞时，将|T＞的图像块中存储的6位恢复位和两位辅助位|0＞作为被篡改图像块的恢复值。使用QA模块将8位恢复序列赋值给图像|CW＞中对应像素块的4个像素|f ＞，|f ＞，|f ＞和|f ＞。步骤4.3.2、当图像块被检测为未被篡改时，使用如图17所示的RN模块恢复图像块，电路的详细描述如下：将|Yn-1Yn-2⋯Y1＞CW|Xn-1Xn-2⋯X1＞CW与通过QE模块。当QE模块输出|1＞时，|C＞与图像块的位置相对应。在图像块的4个像素中，以位置为例，当，则嵌入的水印位与原载体位不相等，此时使用NOT门翻转图像|CW＞中的对应像素位|f1＞CW。五、电路复杂度下面介绍本发明的电路复杂度，电路复杂度由量子电路中基本门的数量决定。在本发明中，水印的生成与嵌入过程包括恢复位生成、图像置乱、恢复位嵌入以及认证位生成与嵌入。实现上述过程的量子电路的复杂度如下所示。图9所示的恢复位生成量子电路包括两个8量子比特RPA模块和一个由2n-2位量子位控制的9比特量子位RPA模块、一个9量子比特D4模块、两个2n-2量子比特QE模块、六个由2位量子比特控制的CNOT门、三个CNOT门和三个由1位量子比特控制的QE模块。图10中设计的图像置乱量子电路包含两个NOT门。图11中给出的用于恢复位嵌入的量子电路包含一个2n-2量子比特QE模块，三个由1位量子比特控制的swap门。图4所示的n量子比特RPA模块包含一个RHA模块和n-1个RFA模块。RHA模块包括5个CNOT门，RFA模块包括9个CNOT模块。图5给出的n量子比特D4模块包括2n+1个swap门。图6中给出的QE模块包括2n个CNOT门和一个由n位量子比特控制的CNOT门。图12中设计的用于认证位生成和嵌入的量子电路包括三个NOT门、两个由2n-2位量子比特控制的RPA模块、一个2n-2量子比特QE模块、四个由1位量子比特控制的QE模块、15个CNOT模块、四个swap门和一个由1位量子比特控制的swap门。因此，用于水印生成和嵌入的量子电路的复杂度为：2××+×+×+3×=O图像篡改检测和自恢复过程包括水印提取、图像逆置乱、图像篡改检测与自恢复。实现上述过程的量子电路的复杂度分析如下。图15所示的水印提取量子电路包含两个2n-2量子比特QE模块、六个由2位量子比特控制的CNOT门和3个由2位量子比特控制的NOT门。图14所示的用于图像篡改检测和自恢复的量子电路包含三个NOT门、两个由2n-2位量子比特控制的RPA模块、11个CNOT门、一个2n-2量子比特QE模块、一个4量子比特QE模块、一个由1位量子比特控制的QE模块、一个由3位量子比特控制的RN模块和两个由1位量子比特控制的RY模块。RY模块包括一个2n-2量子比特QE模块和四个由1位量子比特控制的QA模块。图7中给出的n量子比特QA模块包含n个CNOT门和n个交换门。图17中设计的RN模块包括一个2n-2量子比特QE模块和四个由2位量子比特控制的NOT门。因此，用于篡改检测和自恢复过程的量子电路的复杂度为：2××+3×+×+14×-11+2×=O 综上所诉，实现本发明的专用量子电路的复杂度为O。六、实验内容为了分析本发明方法的性能，在经典计算机的Matlab R2020a环境下进行了仿真实验。仿真实验和分析包括嵌入水印图像的视觉效果和图像篡改检测与自恢复的性能。实验中使用8幅尺寸为512×512的灰度图像Lena、Woman、Jetplane、Pepper、House、Livingroom、Baboon和Darkhair。利用本发明方法得到嵌入水印的图像W-Lena、W-Woman、W-Jetplane、W-Pepper、W-House、W-Livingroom、W-Baboon和W-Darkhair。从人眼视觉的角度来看，原始载体图像和嵌入水印的图像之间的差异基本无法辨别。下面通过计算原载体图像与嵌入水印的图像的峰值信噪比来评估本发明方法的视觉质量。PSNR是最常用的视觉评估方法之一，它通过计算两个图像I和的方差和来评估两幅图像的相似性。PSNR越高，说明图像的相似性越大。PSNR的计算式如下：其中，为图像中像素的坐标。表1展示了本发明方法中嵌入水印的载体图像的PSNR，可见嵌入水印的图像的PSNR可以达到44dB以上。实验结果证明了本发明方法具有良好的视觉效果。表1嵌入水印的图像的PSNR为了评估提出的量子图像自恢复水印方案的篡改检测与自恢复的性能。使用不同的方式对嵌入水印的载体图像进行攻击，使用的攻击方法包括剪切攻击、文字攻击、拼贴攻击和椒盐噪声攻击。下面分别对不同攻击下的嵌入水印图像进行篡改检测和定位，并给出图像自恢复的效果。实验1：剪切攻击对图像进行剪切攻击是去除图像中任意尺寸区域的信息，并将去除的信息用黑色进行填充。本实验分别对载体图像进行如下操作并得到相应的图像：嵌入水印、不同尺寸的剪切攻击、篡改检测与定位、图像自恢复。表2展示了对嵌入水印的载体图像进行不同尺寸的剪切攻击后，使用本发明方法得到的恢复图像的PSNR。表2中的数据显示，对大小为10%、20%和30%的区域进行剪切攻击后获得的恢复图像的PSNR分别高于40 dB、36 dB和34 dB。表2在不同尺寸的剪切攻击下的恢复图像的PSNR由实验图像和实验数据可以看出本发明方法对剪切攻击具有良好的篡改检测与自恢复能力。实验2：文字攻击文字攻击是在图像的任意区域添加任意文字。本实验分别对载体图像进行如下操作并得到相应的图像：嵌入水印、对图像加入文字‘TEXT’或‘LIVE’、篡改检测与定位、图像自恢复。表3展示了对不同图像进行文字攻击后恢复图像的PSNR，可见恢复图像的PSNR平均值达到45dB。表3文字攻击下的恢复图像的PSNR通过实验分析可以得出本发明方法能较准确地检测出攻击图像的文字，并且具有良好的恢复效果。实验3：拼贴攻击拼贴攻击是将图像中某一区域的信息替换成该图像任意其他区域的信息。本实验分别对载体图像进行如下操作并得到相应的图像：嵌入水印、将W-Lena，W-Plane，W-House和W-Baboon的重要区域替换成图像其他区域的信息、篡改检测与定位、图像自恢复。表4给出了在不同尺寸的拼贴攻击下恢复图像的PSNR。表4中的数据显示，在尺寸为5%、10%和15%的拼贴攻击下，恢复图像的PSNR分别可以达到39 dB、36 dB和32 dB。表4拼贴攻击下的恢复图像的PSNR实验结果表明本发明方法基本可以检测到拼贴攻击的位置，并且能够恢复出人眼可识别的信息。实验4：椒盐噪声攻击椒盐噪声攻击是将图像中任意像素变为黑色或白色，被修改的像素占图像总像素的百分比称为噪声强度。本实验对图像进行强度为0.01，0.02，0.03，0.05的椒盐噪声攻击，然后利用本发明方法得到恢复图像。表5展示了不同强度的椒盐噪声攻击下恢复图像的PSNR。表5不同强度的椒盐噪声攻击下的恢复图像的PSNR实验证明本发明方法可以有效降低椒盐噪声对图像的影响。量子的叠加和纠缠特性使得量子计算具有并行计算的能力，与传统图像处理相比，量子图像处理显示出更高的效率。本发明提出了一种新颖的用于篡改定位和自恢复的量子图像水印方案。该方案使用LSB替换方法将恢复位和认证位作为水印位嵌入到载体图像中，嵌入水印的图像的PSNR达到44dB。在本发明方法中，设计了两级篡改检测方法和两种图像恢复模块，以提高篡改检测的准确率和恢复图像的视觉质量。实验结果表明，该方法对常见的恶意攻击具有良好的篡改检测和自恢复能力，且平衡了嵌入水印图像的视觉效果和恢复图像的质量。当然，上述说明并非是对本发明的限制，本发明也并不仅限于上述举例，本技术领域的技术人员在本发明的实质范围内所做出的变化、改型、添加或替换，也应属于本发明的保护范围。
