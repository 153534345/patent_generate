标题title
基于地基红外遥感的晴空大气温湿度廓线快速反演方法
摘要abst
本发明提供一种基于地基红外遥感的晴空大气温湿度廓线快速反演方法，通过插值的方法快速计算透过率，极大地提高了连续反演温湿度廓线的速度；同时采用了覆盖面更广的先验信息资料，不需要进行长期大量的探空测量，拓展了温湿度廓线反演的应用范围；同时基于经验选择L‑M参数也会提高反演的速度。
权利要求书clms
1.基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，包括如下步骤：步骤1)加载气体吸收系数数据库，数据库文件包括特定压力、特定温度下的气体吸收系数；加载先验数据资料；步骤2)构建简化的辐射传输模型，辐射传输模型中只包含六种气体的吸收和发射，不考虑折射和散射；步骤3)计算温度/湿度反演波段基于传输模型仿真的光谱与实测光谱的系统误差，根据公开获取的监测站点观测数据进行计算；根据数据库中的吸收系数，通过插值的方法快速计算透过率，进而计算仿真光谱；步骤4)根据先验信息和实测光谱计算初始输入参数，包括廓线均值，先验协方差，观测协方差，雅克比矩阵；先验信息由公开的观测资料获取；步骤5)根据初始输入参数和迭代反演算法进行迭代计算，采用最大概率目标函数和牛顿迭代，并引入利文伯格-马夸尔特参数对海森矩阵进行修正，L-M参数是基于经验选择的，当迭代结果满足条件时，迭代终止，输出结果。2.根据权利要求1所述的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，步骤1)中吸收系数数据库包含六种气体在50种压力和241种温度条件下的吸收系数；六种气体分别为H2O、O3、CO2、N2O、CH4、CO。3.根据权利要求2所述的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，所述步骤2)中，辐射传输模型计算公式为：其中v表示波数，μ＝cosθ，θ为天顶角，N为大气分层数；Bν,i表示第i层大气温度条件下该波数对应的黑体辐射强度；Tν,-μ,i表示该波数处沿观测方向第i层大气的透过率，并记Tν,-μ,0＝1；/＞表示该波数处沿观测方向第i层以下大气的总透过率。4.根据权利要求3所述的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，所述步骤3)中，系统误差的计算方法步骤如下：A1、获取国际上监测站点的地基红外遥感观测数据和温湿度廓线反演数据；B1、选择30条温湿度廓线作为温度和湿度输入参数，O3先验资料数据的平均值，其他四种气体的体积混合比视为固定的，具体来说：CO2为410ppmv、CH4为1.793ppmv、CO为0.189ppmv、N2O为0.31ppmv；C1、根据输入参数和传输模型计算30条温度/湿度反演波段仿真光谱，并与对应的实测光谱进行对比，差异的平均值视为系统偏差。5.根据权利要求4所述的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，所述步骤3)中，计算高分辨率仿真光谱的步骤如下：A2、对大气进行分层；B2、计算单层大气单一气体的透过率：a、根据先验资料的高度信息计算该层大气厚度；b、以温度廓线以及气体混合比廓线中对应压力层的温度和混合比作为输入参数；c、提取数据库中该气体该层压力下，与输入温度最接近的两个温度对应的吸收系数；d、根据提取的两个吸收系数，利用线性插值的方法快速近似计算当前环境条件下该气体的吸收系数；e、根据插值计算的吸收系数，结合朗伯比尔定律计算该层大气某单一气体的透过率；C2、按照步骤B2计算六种气体的透过率，相乘得到单层大气总透过率；D2、根据步骤C2计算各层大气的总透过率Tν,-μ,i，并根据计算各压力层下方大气的总透过率；E2、根据传输模型计算高分辨率仿真光谱，步长0.1cm-1。6.根据权利要求5所述的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，所述步骤3)还包括降低仿真光谱分辨率的步骤，包括：A3、根据实测光谱的干涉图采样间隔Δx计算最大波数vmax，B3、与高分辨率仿真光谱分辨率最接近的是0.25cm-1，对应的干涉图最大光程差为4cm，计算令Δx×2n最接近4cm的n值；C3、将波数区间0～vmax分割成2n等分，将波数范围为v1～v2的高分辨率仿真光谱插值到新划分的波数网格中，得到步长为波数范围为v1'～v'2的仿真光谱1，v1'～v'2为新的波数网格中包含v1～v2的最小区间；D3、对仿真光谱1的0～v1'和v'2～vmax波段进行补零，然后做对称变换得到一条轴对称的第二光谱，对第二光谱进行傅里叶逆变换得到第一干涉图，第一干涉图调整为“十字形”；E3、根据实测干涉图的最大光程差对第一干涉图进行切趾得到第二干涉图；F3、将第二干涉图进行傅里叶变换得到与实测光谱分辨率一致的光谱。7.根据权利要求6所述的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，所述步骤4)的计算方式为：KT,i＝F-F，i表示层数，Ti表示第i层的温度，F表示温度廓线的第i层温度变化±0.5K时，根据传输模型计算获得的辐亮度；水汽及其他气体的雅克比定义为qi表示第i层吸收分子M的含量，F表示气体廓线的第i层浓度变化±5％时，根据传输模型计算获得的辐亮度。8.根据权利要求7所述的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，其特征在于，所述步骤5)的迭代计算具体步骤为：A4、步骤4中计算的廓线均值，先验协方差，观测协方差，雅克比矩阵以及扣除系统误差后的实测光谱作为初始参数输入传输模型和迭代公式，得到新的廓线输出结果；B4、对新的廓线结果进行合理性判断，对于温度廓线，若其中某些层的温度低于200K，则替换成200.5K，若大于320K，则替换成319.5K，对于湿度廓线，某些层的湿度小于0，则替换成0.1；C4、根据新的廓线，计算雅克比矩阵，更新L-M参数u，并将u、新廓线和新雅克比矩阵作为输入量，其他输入参数不变，进入下一次迭代；D4、当xi+1-xi2≤1或者迭代次数大于10次，迭代终止，输出廓线结果。
说明书desc
技术领域本发明涉及温湿度廓线测量领域，具体涉及基于地基红外遥感的晴空大气温湿度廓线快速反演方法。背景技术许多大气科学领域如气象预报、气象模型评价等领域都需要高时间分辨率的大气温湿度垂直廓线；同时温度和湿度廓线两个基本气象量也是描述大气稳定性的关键要素。无线电探空仪能够获取高垂直分辨率的温湿度廓线，但是对于大多数的气象应用，其时间分辨率往往满足不了要求；无线电探空仪上升过程中会随风漂移产生明显的水平位移，进而导致采样误差。红外遥感方法在获取温湿度廓线方面具有高时间分辨率的优点。目前的地基反演方法如AERIoe算法，下行辐射光谱的仿真大多基于逐线积分模型计算得到。虽然逐线积分模型具有很高的计算精度，但是计算速度较慢，在某些场景下可能无法满足要求。同时先验信息依赖于无线电探空测量，世界范围内，长期连续的无线电探空测量只在一些固定的监测站点进行，限制了地基红外遥感反演大气温湿度廓线的应用场景。发明内容为解决上述技术问题，本发明提供一种基于地基红外遥感的晴空大气温湿度廓线快速反演方法，通过插值的方法快速计算透过率，极大地提高了连续反演温湿度廓线的速度；同时采用了覆盖面更广的先验信息资料，不需要进行长期大量的探空测量，拓展了温湿度廓线反演的应用范围；同时基于经验选择L-M参数也会提高反演的速度。为了实现上述目的，本发明采取以下技术方案：基于地基红外遥感的晴空大气温湿度廓线快速反演方法，包括如下步骤：步骤1)加载气体吸收系数数据库，数据库文件包括特定压力、特定温度下的气体吸收系数；加载先验数据资料；步骤2)构建简化的辐射传输模型，辐射传输模型中只包含六种气体的吸收和发射，不考虑折射和散射；步骤3)计算温度/湿度反演波段基于传输模型仿真的光谱与实测光谱的系统误差，根据公开获取的监测站点观测数据进行计算；根据数据库中的吸收系数，通过插值的方法快速计算透过率，进而计算仿真光谱；步骤4)根据先验信息和实测光谱计算初始输入参数，包括廓线均值，先验协方差，观测协方差，雅克比矩阵；先验信息由公开的观测资料获取；步骤5)根据初始输入参数和迭代反演算法进行迭代计算，采用最大概率目标函数和牛顿迭代，并引入利文伯格-马夸尔特参数对海森矩阵进行修正，L-M参数是基于经验选择的，当迭代结果满足条件时，迭代终止，输出结果。进一步地，步骤1)中吸收系数数据库包含六种气体在50种压力和241种温度条件下的吸收系数；六种气体分别为H2O、O3、CO2、N2O、CH4、CO。进一步地，所述步骤2)中，辐射传输模型计算公式为：其中v表示波数，μ＝cosθ，θ为天顶角，N为大气分层数；Bν,i表示第i层大气温度条件下该波数对应的黑体辐射强度；Tν,-μ,i表示该波数处沿观测方向第i层大气的透过率，并记Tν,-μ,0＝1；/＞表示该波数处沿观测方向第i层以下大气的总透过率。进一步地，所述步骤3)中，系统误差的计算方法步骤如下：A1、获取国际上监测站点的地基红外遥感观测数据和温湿度廓线反演数据；B1、选择30条温湿度廓线作为温度和湿度输入参数，O3先验资料数据的平均值，其他四种气体的体积混合比视为固定的，具体来说：CO2为410ppmv、CH4为1.793ppmv、CO为0.189ppmv、N2O为0.31ppmv；C1、根据输入参数和传输模型计算30条温度/湿度反演波段仿真光谱，并与对应的实测光谱进行对比，差异的平均值视为系统偏差。进一步地，所述步骤3)中，计算高分辨率仿真光谱的步骤如下：A2、对大气进行分层；B2、计算单层大气单一气体的透过率：a、根据先验资料的高度信息计算该层大气厚度；b、以温度廓线以及气体混合比廓线中对应压力层的温度和混合比作为输入参数；c、提取数据库中该气体该层压力下，与输入温度最接近的两个温度对应的吸收系数；d、根据提取的两个吸收系数，利用线性插值的方法快速近似计算当前环境条件下该气体的吸收系数；e、根据插值计算的吸收系数，结合朗伯比尔定律计算该层大气某单一气体的透过率。C2、按照步骤B2计算六种气体的透过率，相乘得到单层大气总透过率；D2、根据步骤C2计算各层大气的总透过率Tν,-μ,i，并根据计算各压力层下方大气的总透过率；E2、根据传输模型计算高分辨率仿真光谱，步长0.1cm-1。进一步地，所述步骤3)还包括降低仿真光谱分辨率的步骤，包括：A3、根据实测光谱的干涉图采样间隔Δx计算最大波数vmax，B3、与高分辨率仿真光谱分辨率最接近的是0.25cm-1，对应的干涉图最大光程差为4cm，计算令Δx×2n最接近4cm的n值；C3、将波数区间0～vmax分割成2n等分，将波数范围为v1～v2的高分辨率仿真光谱插值到新划分的波数网格中，得到步长为波数范围为v'1～v'2的仿真光谱1，v'1～v'2为新的波数网格中包含v1～v2的最小区间；D3、对仿真光谱1的0～v'1和v'2～vmax波段进行补零，然后做对称变换得到一条轴对称的光谱2，对光谱2进行傅里叶逆变换得到第一干涉图，需要注意的是第一干涉图要调整为“十字形”；E3、根据实测干涉图的最大光程差对第一干涉图进行切趾得到第二干涉图；F3、将第二干涉图进行傅里叶变换得到与实测光谱分辨率一致的光谱。进一步地，所述步骤4)的计算方式为：KT,i＝F-F，i表示层数，Ti表示第i层的温度，F表示温度廓线的第i层温度变化±0.5K时，根据传输模型计算获得的辐亮度；水汽及其他气体的雅克比定义为qi表示第i层吸收分子M的含量，F表示气体廓线的第i层浓度变化±5％时，根据传输模型计算获得的辐亮度。进一步地，所述步骤5)的迭代计算具体步骤为：A4、步骤4中计算的廓线均值，先验协方差，观测协方差，雅克比矩阵以及扣除系统误差后的实测光谱作为初始参数输入传输模型和迭代公式，得到新的廓线输出结果；B4、对新的廓线结果进行合理性判断，对于温度廓线，若其中某些层的温度低于200K，则替换成200.5K，若大于320K，则替换成319.5K，对于湿度廓线，某些层的湿度小于0，则替换成0.1；C4、根据新的廓线，计算雅克比矩阵，更新L-M参数u，并将u、新廓线和新雅克比矩阵作为输入量，其他输入参数不变，进入下一次迭代；D4、当||xi+1-xi||2≤1或者迭代次数大于10次，迭代终止，输出廓线结果。上述技术方案中，通过插值的方法快速计算透过率，极大地提高了连续反演温湿度廓线的速度；同时采用了覆盖面更广的先验信息资料，不需要进行长期大量的探空测量，拓展了温湿度廓线反演的应用范围；同时基于经验选择L-M参数也会提高反演的速度。附图说明图1为快速廓线反演方法的基本流程图；图2为根据传输模型和吸收系数计算仿真光谱的流程图；图3为实测光谱图、仿真光谱图以及系统偏差图；图4为实施例一的温湿度廓线反演结果以及对比图。具体实施方式结合具体实施例和附图对本发明做出进一步的说明。如图1所示，本发明的基于地基红外遥感的晴空大气温湿度廓线快速反演方法，包括如下步骤：步骤1)加载气体吸收系数数据库，数据库文件包括特定压力、特定温度下的气体吸收系数；加载先验数据资料，先验信息可由公开的观测资料获取。步骤2)根据简化的辐射传输模型构建辐射传输方程，传输模型中只包含六种气体的吸收和发射，不考虑折射和散射。步骤3)加载站点观测数据，选取多条站点廓线数据作为传输方程输入参数计算仿真光谱，降低仿真光谱的分辨率，使其和实测光谱分辨率一致，对比仿真光谱与对应的站点实测光谱之间的平均差异，用作系统误差；步骤4)采集红外光谱图，根据先验信息和实测光谱计算初始输入参数，包括待反演实测光谱、观测协方差矩阵、先验协方差矩阵、初始廓线、初始雅克比矩阵以及初始仿真光谱。步骤5)根据初始输入参数和迭代反演算法进行迭代计算，采用最大概率目标函数和牛顿迭代，并引入利文伯格-马夸尔特参数对海森矩阵进行修正，L-M参数是基于经验选择的，判断迭代结果是否出现不合理值，并替换不合理值；根据新的廓线结果计算新的雅克比矩阵以及仿真光谱，并作为输入量进入下一次迭代过程；当迭代结果满足条件时，迭代终止，输出结果。具体的方案如下：步骤1)中吸收数据库包含六种气体在50种压力和241种温度条件下的吸收系数；六种气体分别为H2O、O3、CO2、N2O、CH4、CO，压力条件如表1所示，温度条件设置为200-320K，间隔0.5K；利用HAPI程序计算六种气体对应条件下的逐线积分吸收系数并储存在相应文件中，积分步长设置为0.1cm-1,吸收线型选择Voigt线型；先验数据资料选择的是欧洲中尺度天气预报中心的再分析资料，包含压力、高度、温度、湿度等信息，它是一个覆盖全球的数据集，水平空间分辨率可以达到0.25°×0.25°。步骤2)中辐射传输模型是在高仰角观测条件下，并在两个假设的基础上建立的：假定大气处于热力学平衡状态，因此对于源函数根据基尔霍夫定律可用普朗克强度；假定大气是平面平行的结构，意味着辐亮度只在垂直方向上发生变化。同时高仰角观测时绝大多数微量气体的吸收很弱，因此只考虑步骤1)提到的六种气体的吸收和发射，不考虑折射和散射。传输模型计算公式为：其中v表示波数，μ＝cosθ，θ为天顶角，N为大气分层数；Bν,i表示第i层大气温度条件下该波数对应的黑体辐射强度；Tν,-μ,i表示该波数处沿观测方向第i层大气的透过率，并记Tν,-μ,0＝1；/＞表示该波数处沿观测方向第i层以下大气的总透过率。步骤3)中系统误差的计算方法步骤如下：A1、获取国际上监测站点的地基红外遥感观测数据和温湿度廓线反演数据；B1、选择30条温湿度廓线作为温度和湿度输入参数，O3先验资料数据的平均值，其他四种气体的体积混合比视为固定的，具体来说：CO2为410ppmv、CH4为1.793ppmv、CO为0.189ppmv、N2O为0.31ppmv；C1、根据输入参数和传输模型计算30条温度/湿度反演波段仿真光谱，并与对应的实测光谱进行对比，差异的平均值视为系统偏差。步骤3)中计算仿真光谱的步骤如下：A2、按照表1中的压力对大气进行分层，最多50层，实际应用时根据地面压力而定，例如地面实际气压为992hPa，则对大气分层时最低一层压力设置为990hPa，若地面实际气压为982hPa，则最低一层压力设置为980hPa，以此类推。B2、计算单层大气单一气体的透过率：a、根据先验资料的高度信息计算该层大气厚度；b、以温度廓线以及气体混合比廓线中对应压力层的温度和混合比作为输入参数；c、提取数据库中该气体该层压力下，与输入温度最接近的两个温度对应的吸收系数，例如，输入温度为273.6K，则提取273.5K和274K温度条件下的吸收系数；d、根据提取的两个吸收系数，利用线性插值的方法快速近似计算当前环境条件下该气体的吸收系数；e、根据插值计算的吸收系数，结合朗伯比尔定律计算该层大气某单一气体的透过率。C2、按照步骤B2计算六种气体的透过率，相乘得到单层大气总透过率；D2、根据步骤C2计算各层大气的总透过率Tν,-μ,i，并根据计算各压力层下方大气的总透过率。E2、根据传输模型计算高分辨率仿真光谱，步长0.1cm-1。F2、降低仿真光谱分辨率与实测光谱一致。计算仿真光谱的一般步骤如图2所示步骤3)中降低仿真光谱分辨率的步骤如下：A3、根据实测光谱的干涉图采样间隔Δx计算最大波数vmax，B3、与高分辨率仿真光谱分辨率最接近的是0.25cm-1，对应的干涉图最大光程差为4cm，计算令Δx×2n最接近4cm的n值；C3、将波数区间0～vmax分割成2n等分，将波数范围为v1～v2的高分辨率仿真光谱插值到新划分的波数网格中，得到步长为波数范围为v1'～v'2的仿真光谱1，v1'～v'2为新的波数网格中包含v1～v2的最小区间；D3、对仿真光谱1的0～v1'和v'2～vmax波段进行补零，然后做对称变换得到一条轴对称的第二光谱，对第二光谱进行傅里叶逆变换得到第一干涉图，需要注意的是第一干涉图要调整为“十字形”；E3、根据实测干涉图的最大光程差对第一干涉图进行切趾得到第二干涉图；F3、将第二干涉图进行傅里叶变换得到与实测光谱分辨率一致的光谱。步骤4)中廓线均值采用先验数据的平均值，温度或者湿度的先验协方差是指先验资料中多次测量的温度或湿度结果之间的协方差，是一个方阵；观测协方差则是一个对角矩阵，对角线上的值即为对应波数下的实测光谱噪声值的平方；雅克比矩阵表示的是传输模型对真实廓线状态的灵敏性，通过有限差分的方法计算而来。具体的计算方式为：KT,i＝F-F，i表示层数，Ti表示第i层的温度，F表示温度廓线的第i层温度变化±0.5K时，根据传输模型计算获得的辐亮度。水汽及其他气体的雅克比定义为qi表示第i层吸收分子M的含量，F表示气体廓线的第i层浓度变化±5％时，根据传输模型计算获得的辐亮度。步骤5)中迭代计算具体步骤为：A4、步骤4中计算的廓线均值，先验协方差，观测协方差，雅克比矩阵以及扣除系统误差后的实测光谱作为初始参数输入传输模型和迭代公式，得到新的廓线输出结果；B4、对新的廓线结果进行合理性判断，对于温度廓线，若其中某些层的温度低于200K，则替换成200.5K，若大于320K，则替换成319.5K，对于湿度廓线，某些层的湿度小于0，则替换成0.1；C4、根据新的廓线，计算雅克比矩阵，更新L-M参数u，并将u、新廓线和新雅克比矩阵作为输入量，其他输入参数不变，进入下一次迭代；D4、当||xi+1-xi||2≤1或者迭代次数大于10次，迭代终止，输出廓线结果。附：反演过程中涉及到的单位换算公式具体如下：相对湿度转换成体积混合比先根据Goff-Gratch公式计算当前温度下的饱和水汽压E；当温度t＜273.15K时，其中,k1＝-9.09718；k2＝-3.56654；k3＝0.876793；k4＝6.1071；当温度t＞273.15K时，其中，k5＝-7.90298；k6＝5.02808；k7＝-1.3816×10-7；k8＝8.1328×10-3；k9＝11.344；k10＝-3.49149；k11＝1013.246；通过饱和蒸气压计算体积混合比，公式如下：Cppmv＝1×105×RH×E/PairCppmv为体积混合比，RH为相对湿度，单位％，E为饱和水汽压，Pair为大气压，hPa。体积混合比转换成绝对浓度C＝/，M为相对分子量，Tair为气温。以下为本发明方法的两个具体实施例：实施例1、选择美国大气辐射测量项目南部大平原站点的aerich1nf1turnC1数据集中2021年12月2日0004UTC时的一条实测红外辐亮度谱，分辨率为1cm-1，对应干涉图采样间隔为0.6329μm；、选择欧洲中尺度天气预报中心再分析资料集中36.6°～36.8°N、97.6°～97.4°W空间范围内对应的2017-2021年12月0点，8点，16点三个时间段的自1000hPa至1hPa共37层的数据，并根据表1中的压力进行了插值处理得到50层的数据；、选择美国大气辐射测量项目南部大平原站点的aerich1nf1turnC1数据集中2021年12月2日0007-0011UTC时的30条实测红外辐亮度谱，以及对应时段aerioe1turnC1数据集中的30条温湿度廓线，按照步骤3)的方法计算系统误差；图3为实施例1中的实测光谱、降低分辨率后的仿真光谱以及两者之间的系统误差。、温度反演波段设置为675-712cm-1，噪声为0.3mW/，湿度反演波段设置为1250-1350cm-1，噪声为0.25mW/，根据先验信息计算平均廓线作为初始迭代廓线，根据噪声水平计算观测协方差矩阵，根据平均廓线计算初始雅克比矩阵，并将实测光谱扣除系统误差；、将初始输入参数包括初始利文伯格-马夸尔特参数u0、初始迭代廓线先验协方差Sa、观测协方差Sε、扣除系统误差后的实测光谱/＞以及初始雅可比矩阵K0代入迭代公式中，迭代公式如下，I为单位矩阵：、根据上一步迭代结果，计算Ki，并更新L-M参数，温湿度反演中u分别为和；当达到终止条件||xi+1-xi||2≤1或者迭代次数大于10次，迭代终止，输出xi+1，即为廓线反演结果，图4为实施例1的计算结果与AERIoe算法计算结果以及欧洲中尺度天气预报中心再分析资料之间的对比情况，反演结果与其他资料对比结果较好。实施例二参照实施例一，根据60条实测光谱进行了60次温湿度廓线反演，总共用时不超过4小时，平均反演一条温度廓线和湿度廓线用时不超过4分钟，对于连续长期观测来说这样的计算速度是非常有意义的。表1廓线反演中使用的垂直压力网格，单位hPa本领域的技术人员容易理解，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
