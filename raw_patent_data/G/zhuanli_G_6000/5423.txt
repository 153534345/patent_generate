标题title
一种基于差分隐私的模式保护动态可搜索加密方法
摘要abst
本发明提供了一种基于差分隐私的模式保护动态可搜索加密方法。该方法包括如下步骤：首先生成加密索引；然后根据待查询关键字，利用差分隐私技术模糊关键字，为每个关键字文档独立生成查询令牌；再通过Bid Compress压缩结构标记每个令牌；云服务器通过查询匹配文档将对应的匹配结果返回给客户端。本发明使用差分隐私算法中的假阳性和假阴性模糊关键字对应的文档数据集，保护数据集的访问模式。为每个关键字所对应的文档分别生成令牌，并使用Bid Compress压缩结构存储令牌标记，使对手无法获取关键字的个数和访问频率，实现搜索模式保护。有效防止泄露关键字文档及频率等信息，支持更新，进一步提升了SSE方案的安全性。
权利要求书clms
1.一种基于差分隐私的模式保护动态可搜索加密方法，其特征是，包括如下步骤：a、生成加密索引：对每个关键字文档设计一个标记结构Tagi，每个标记结构Tagi包含Tagi,1和Tagi，2两部分，Tagi,1为令牌标记，用来标记文档生成的查询令牌，Tagi，2为文档标记，用来标记关键字文档；采用标记对称加密算法对文档标记Tagi，2进行加密，生成与文档对应的密文，即为加密索引；所生成的加密索引由客户端发送至云服务器；b、对于待查询关键字，模糊关键字，生成查询令牌；具体是：对于待查询关键字，通过差分隐私模糊技术生成假阴性令牌和假阳性令牌，将假阴性令牌、假阳性令牌和正确令牌相加，获得与关键字文档对应的查询令牌；c、对查询令牌进行标记、压缩；具体是：采用令牌标记Tagi,1对每个生成的查询令牌进行标记，再将其压缩存储到Bid Compress压缩结构中；Bid Compress压缩结构为每个关键字设置了一个数组，对每个关键字数组，若存在查询令牌，则将数组中与令牌标记对应位设置为1，其余位均设置为0；d、客户端将查询令牌连同Bid Compress压缩结构一同发送到云服务器；云服务器根据接收到的查询令牌，对加密索引执行搜索操作，将与令牌匹配的索引返回给客户端。2.根据权利要求1所述的基于差分隐私的模式保护动态可搜索加密方法，其特征是，步骤c中，各个关键字数组的位数均相同，等于最大关键字数组的位数。3.根据权利要求1所述的基于差分隐私的模式保护动态可搜索加密方法，其特征是，步骤c中，在Bid Compress压缩结构中还加入了填充关键字的数组，填充关键字数组的各位均设置为0。4.根据权利要求1所述的基于差分隐私的模式保护动态可搜索加密方法，其特征是，步骤b中，正确令牌的生成方式为：对于每一个文档，通过对应的文档表达式生成正确的令牌；wi为待查询关键字，Tagi，1为文档对应的令牌标记，ctr为文档中包含该关键字wi的计数值。5.根据权利要求1所述的基于差分隐私的模式保护动态可搜索加密方法，其特征是，步骤b中，假阴性令牌的生成方式为：通过忽略令牌标记或关键字计数器值来生成假阴性令牌。6.根据权利要求1所述的基于差分隐私的模式保护动态可搜索加密方法，其特征是，步骤b中，假阳性令牌的生成方式为：选取不属于规定范围内的关键字作为填充关键字，根据填充关键字对应的文档表达式强制生成假阳性令牌。7.根据权利要求6所述的基于差分隐私的模式保护动态可搜索加密方法，其特征是，填充关键字对应的文档表达式中，令牌标记以及关键字计数器值可任意设置。
说明书desc
技术领域本发明涉及可搜索加密技术领域，具体地说是一种云环境下基于差分隐私的模式保护动态可搜索加密方法。背景技术为降低本地开销和使用户便利，将数据外包给云服务器的趋势越来越明显，这也引发了云数据的隐私泄露问题。可搜索加密技术可以解决这一忧虑，给云数据提供一种隐私保护。其中对称可搜索加密允许用户在不想服务器泄露文档内容的情况下，根据查询关键字对加密数据执行搜索操作得到匹配的文档，并在本地对其进行解密。然而，可搜索加密技术并不能完全保证云数据的安全，还有可能会泄露加密文档的隐私信息。在客户端执行搜索操作时，云服务器能观察到哪些文档在加密数据库中被访问并返回给客户端，这种泄露被称为访问模式泄露。另外，云服务器通常也能观察到这些文档被访问了多少次，这种泄露被称作搜索模式泄露。云服务器通过事先了解外包数据库或者搜索习惯恢复出查询关键字，从而泄露用户隐私。而已有的一些方案，以泄露这两种模式隐私为代价来提高方案效率和实用性。发明内容本发明的目的就是提供一种基于差分隐私的模式保护动态可搜索加密方法，该方法能同时保护访问模式和搜索模式，并适用于动态可搜索加密，可以有效防止模式泄露，提升可搜索加密方案的安全性。本发明是这样实现的：一种基于差分隐私的模式保护动态可搜索加密方法，包括如下步骤：a、生成加密索引：对每个关键字文档设计一个标记结构Tagi，每个标记结构Tagi包含Tagi,1和Tagi，2两部分，Tagi,1为令牌标记，用来标记文档生成的查询令牌，Tagi，2为文档标记，用来标记关键字文档；采用标记对称加密算法对文档标记Tagi，2进行加密，生成与文档对应的密文，即为加密索引；所生成的加密索引由客户端发送至云服务器；b、对于待查询关键字，模糊关键字，生成查询令牌；具体是：对于待查询关键字，通过差分隐私模糊技术生成假阴性令牌和假阳性令牌，将假阴性令牌、假阳性令牌和正确令牌相加，获得与关键字文档对应的查询令牌；c、对查询令牌进行标记、压缩；具体是：采用令牌标记Tagi,1对每个生成的查询令牌进行标记，再将其压缩存储到Bid Compress压缩结构中；Bid Compress压缩结构为每个关键字设置了一个数组，对每个关键字数组，若存在查询令牌，则将数组中与令牌标记对应位设置为1，其余位均设置为0；d、客户端将查询令牌连同Bid Compress压缩结构一同发送到云服务器；云服务器根据接收到的查询令牌，对加密索引执行搜索操作，将与令牌匹配的索引返回给客户端。上述方案中，步骤c中，各个关键字数组的位数均相同，等于最大关键字数组的位数。上述方案中，步骤c中，在Bid Compress压缩结构中还加入了填充关键字的数组，填充关键字数组的各位均设置为0。上述方案中，步骤b中，正确令牌的生成方式为：对于每一个文档，通过对应的文档表达式生成正确的令牌；wi为待查询关键字，Tagi，1为文档对应的令牌标记，ctr为文档中包含该关键字wi的计数值。上述方案中，步骤b中，假阴性令牌的生成方式为：通过忽略令牌标记或关键字计数器值来生成假阴性令牌。上述方案中，步骤b中，假阳性令牌的生成方式为：选取不属于规定范围内的关键字作为填充关键字，根据填充关键字对应的文档表达式强制生成假阳性令牌。填充关键字对应的文档表达式中，令牌标记以及关键字计数器值可任意设置。本发明引入差分隐私技术设计了一种能同时保护访问模式和搜索模式的动态可搜索加密方法。使用差分隐私算法中的假阳性和假阴性模糊关键字对应的文档数据集，保护数据集的访问模式。为每个关键字所对应的文档分别生成令牌，并使用Bid Compress压缩结构存储令牌标记，使对手无法获取关键字的个数和访问频率，实现搜索模式保护。有效防止泄露关键字文档及频率等信息，支持更新，进一步提升了SSE方案的安全性。本发明具有如下有益效果：本发明使用标记对称加密算法，在TSE加密算法中设计了一种标记结构Tagi，一个Tagi包含Tagi,1和Tagi，2两部分，Tagi,1用来标记关键字文档生成的查询令牌，Tagi，2用来标记关键字文档，然后经加密生成加密索引。另外，在执行搜索操作时，只需遍历标记结构Tagi，查找与查询令牌相匹配的加密索引即可。不需要繁重的计算过程，因而降低了计算复杂度和通信开销。在独立访问每个关键字所对应的文档时，引入Bid Compress压缩结构，双向访问，令牌标记Tagi,1以数字1的形式压缩存储在Bid Compress中，降低存储开销。同时向BidCompress填充多个0位，以与其他关键字数组位数相同，实现模糊关键字频率的目标。经过安全性和仿真实验表明，本发明中的方法安全可行，与现有方案相比更新效率提高了10～100倍，查询效率提高了1～10倍，并且对加密数据提供了更强的保护。附图说明图1是本发明的方法流程图。图2是本发明中客户端和云服务器之间的关系图。图3是本发明中令牌的生成过程图。具体实施方式本发明提出了一个能同时防止访问模式泄露和搜索模式泄露的动态可搜索加密方法。该方法通过借用差分隐私算法模糊访问模式，使用差分隐私模糊文档数据时通常计算开销和通讯开销偏大，本发明使用了一种标记对称加密来降低方案开销和计算复杂度。另外，独立访问每个关键字所对应的文档，以避免对手通过观察相同的访问模式计算关键字的频率，并引入Bid Compress压缩结构模糊令牌标记，从而实现对搜索模式的保护。结合图1，本发明所提供的基于差分隐私的模式保护动态可搜索加密方法包括如下步骤：首先生成加密索引；然后根据待查询关键字w，利用差分隐私技术模糊关键字w，为每个关键字文档独立生成查询令牌；再通过Bid Compress压缩结构标记每个令牌，以混淆关键字频率；客户端将令牌发送到云服务器后，云服务器通过查询匹配文档将对应的匹配结果返回给客户端。各步骤具体如下：a、生成加密索引。利用差分隐私技术的可搜索加密通常会使用繁重复杂的加密算法，产生较大的计算开销和通信开销。为此，本发明使用了标记对称加密算法，标记对称加密算法是密钥空间为K的标准SE方案，消息空间为M，密文空间为C。算法中设计了一个标记结构Tagi，只需要利用简便的加密算法将同一文档对应的令牌和索引分别存储在标记结构的Tagi,1和Tagi，2中，在执行搜索操作时，只需要遍历标记结构，判定数据库中哪一个索引与查询令牌同属于一个Tagi，因而更新复杂度和查询复杂度低，分别为O和O，其中，N为关键字文档条目，nw代表对于一个关键字w的搜索结果大小。本步骤生成加密索引具体是：对原始数据集进行处理从中提取关键字以及包含此关键字的文档，通过使用标记结构Tagi中的Tagi,2对关键字所对应的每个文档进行标记。标记结构是为每个关键字文档专门设计的一种数据结构，对从原始数据集中提取出来的包含关键字w的每个文档ID，均有一个对应的标记结构Tagi。每个文档对应的标记结构Tagi包含Tagi,1和Tagi，2两部分结构，其中Tagi,1用来标记文档生成的查询令牌，Tagi，2用来标记关键字文档。然后调用TSE加密算法对此文档标记Tagi，2进行加密，生成与文档相对应的密文c，即为加密索引，将所有文档对应的加密索引均发送至云服务器，并存入加密数据库EDB中，见图2中①所在箭头所示。b、对于待查询关键字，模糊关键字，生成查询令牌。对于一个包含M个关键字的文档ID＝{w1,w2,w3,...,wM}，通过具有某关键字wi、令牌标记Tagi，1和文档ID中包含该关键字wi的计数器ctr的文档表达式生成令牌来查找正确的匹配。结合图3，假设客户端待查询的关键字为w1，而包含该关键字w1的文档有n个，分别为ID、ID、……、ID。若想正确获得这n个文档，对于每一个文档，可通过对应的文档表达式生成正确的令牌。但本发明中通过差分隐私模糊技术来模糊该关键字w1，具体是：对于每一个文档，除了通过对应的文档表达式生成正确的令牌外，还通过差分隐私模糊技术生成假阴性令牌和假阳性令牌，将假阴性令牌、假阳性令牌和正确的令牌相加，最终获得一个查询令牌。假阳性是服务器返回一些与查询不匹配的文档，假阴性是服务器不会返回一些与查询匹配的文档。本发明使用这两个属性对每个关键字所对应的文档分别进行处理，通过假阳性使服务器返回与查询不匹配的文档，并通过假阴性使服务器不返回与查询相匹配的文档，以此来模糊搜索结果，使对手无法获取正确的查询结果。在生成假阴性令牌时，客户端通过在对每个文档生成令牌时跳过令牌标记Tagi，1或关键字计数器值ctr，略过真正应匹配的文档来生成假阴性令牌，从而不返回与查询相匹配的文档以隐藏真正匹配的文档。在生成假阳性令牌时，选取不属于规定范围内的关键字w-1，仅用于填充，不被查询。根据填充关键字w-1对应的文档表达式强制生成假阳性令牌，返回与查询不匹配文档。独立为每个文档执行上述假阳性和假阴性的模糊处理过程并生成相应查询令牌。以假阴性和假阳性这两种属性的模糊处理操作来混淆每次查询内容，使得对手无法获取查询文档内容以及关键字频率。c、Bid Compress标记查询令牌。结合图2和图3，针对每个关键字文档ID经过差分隐私模糊处理后，独立生成查询令牌Tokeni，然后使用Tagi中的元素Tagi,1对每个生成的查询令牌Tokeni进行标记，再将其压缩存储到Bid Compress中，以此来模糊关键字频率。Bid Compress压缩结构是基于BitMap而设计的，为每个关键字设置一个数组，为防止对手识别关键字的个数，加入一些填充关键字的数组。各个关键字数组的位数均相同，为最大关键字数组位数的长度。对每个关键字数组，若存在文档查询令牌，则将数组中与令牌标记对应位设置为1，其余位均设置为0，以此混淆包含该关键字对应文档的个数，通过遍历该数组就可以查询该关键字所对应的所有令牌。使用差分隐私算法主要是利用其中的假阳性和假阴性两个属性来实现模糊访问模式和搜索模式目标的，假阳性是服务器返回一些与查询不匹配的文档，假阴性是服务器不会返回一些与查询匹配的文档。在模糊访问模式时，使用这两个属性对每个关键字所对应的文档进行处理，通过假阳性使服务器返回与查询不匹配的文档，并通过假阴性使服务器不返回与查询相匹配的文档，以此来模糊搜索结果，使对手无法获取正确的查询结果。为保护搜索模式，对每个关键字对应的所有文档分别生成一个查询令牌，并使用BidCompress对令牌进行标记，使对手无法获得标记的数量，进而无法推断关键字的频率。结合图2，本发明主要包括客户端和云服务器两个实体。客户端从原始数据集中提取关键字，使用Tagi中的Tagi，2对关键字文档进行标记生成索引，然后使用TSE加密算法对索引进行加密，并将其上传至云服务器，如箭头①所示。客户端利用差分隐私技术模糊关键字，为每个关键字所对应的文档独立地生成相应的查询令牌，使用Tagi中的Tagi,1对查询令牌进行标记，并压缩存储在Bid Compress结构中，将令牌连同Bid Compress发送到云服务器中，如箭头②所示。查询时，云服务器根据接收到的查询令牌，对加密索引执行搜索操作，将与查询令牌匹配的索引返回给客户端，如箭头③所示。本发明利用安全索引提供可搜索加密服务的过程中，进行一次更新操作并不会改变关键字与索引的对应位置。进行一次搜索操作，要求用户生成一个查询令牌，云服务器可以通过一次查询找到索引项。所以，搜索操作的计算复杂度为O。执行一次搜索操作要求用户生成一个搜索令牌并将其发送到云服务器，最后将所有的搜索结果一同返回，搜索操作的通信复杂度为O，nw为一个关键字w的搜索结果大小。更新过程中，用户首先根据关键字文档对生成更新令牌。云服务器将N个关键字文档条目转换成更新令牌，此时更新操作的复杂度为O。在更新包含关键字w的文档时，用户需要上传文档相对应的更新令牌，更新操作的通信开销为O。本说明书未详细描述的内容属于本专业技术人员公知的现有技术。以上结合附图和技术方案对本发明的具体实施方式作了说明，上述实施例仅是为充分说明本发明而所举的较佳的实施例，本发明的保护范围不限于此，本技术领域的技术人员在本发明基础上所作的等同替代或变换，均在本发明的保护范围之内。本发明的保护范围以权利要求书为准。
