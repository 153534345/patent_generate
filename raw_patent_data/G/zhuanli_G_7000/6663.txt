标题title
目标检测网络的训练方法、目标检测方法及装置
摘要abst
本公开提供了一种目标检测网络的训练方法、目标检测方法及装置，所述目标检测网络的训练方法，包括：基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络；基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练；基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。
权利要求书clms
1.一种目标检测网络的训练方法，其特征在于，包括：基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络；基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练；基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。2.根据权利要求1所述的方法，其特征在于，基于初始检测网络确定第一检测网络和第二检测网络，包括：通过对所述初始检测网络进行规模调整，或者通过对所述初始检测网络进行规模调整和网络结构调整，确定所述第一检测网络和所述第二检测网络；所述规模调整包括对所述初始检测网络的网络宽度按照第一预设比例进行调整和/或对所述初始检测网络的网络深度按照第二预设比例进行调整。3.根据权利要求1或2所述的方法，其特征在于，所述基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练，包括：基于第一样本数据集对所述第一检测网络进行预训练，基于第二样本数据集对预训练后的第一检测网络进行微调训练；以及，基于所述第二样本数据集对所述第二检测网络进行训练；其中，所述第一样本数据集的样本数量多于所述第二样本数据集；所述第二样本数据集与所述目标检测网络的测试集之间的相似度，高于所述第一数据集与所述测试集之间的相似度。4.根据权利要求1～3任一所述的方法，其特征在于，所述基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，包括：基于所述第一检测网络的第一融合模块的输出值和所述第二检测网络的第二融合模块的输出值，确定损失值，其中，所述损失值表征所述第一融合模块的输出值和所述第二融合模块的输出值之间的差异；基于所述损失值和所述第二检测网络对所述第一检测网络进行蒸馏训练。5.根据权利要求1～4任一所述的方法，其特征在于，所述对所述第一检测网络进行蒸馏训练之后，所述方法还包括：对蒸馏训练后的所述第一检测网络进行模型量化处理。6.一种目标检测方法，其特征在于，包括：读取测试图像；基于权利要求1～5任一所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果。7.根据权利要求6所述的方法，其特征在于，所述基于权利要求1～5任一所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果，包括：基于所述目标检测网络对所述测试图像进行目标检测，确定所述测试图像包含的物体属于各个类别的置信度信息，以及各个物体对应的前景置信度信息，其中，所述前景置信度信息用于表示各个物体为前景的概率；基于所述前景置信度信息，筛选出前景物体；基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果。8.根据权利要求7所述的方法，其特征在于，所述目标检测网络对所述测试图像进行目标检测后，检测结果还包括各个物体对应的位置信息；所述基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果，包括：基于所述前景物体的置信度信息中的最高置信度和所述位置信息，确定所述测试图像对应的目标检测结果。9.一种目标检测网络的训练装置，其特征在于，包括：确定模块，用于基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络；第一训练模块，用于基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练；第二训练模块，用于基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。10.一种目标检测装置，其特征在于，包括：读取模块，用于读取测试图像；检测模块，用于基于权利要求1～5任一所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果。11.一种计算机设备，其特征在于，包括：处理器、存储器和总线，所述存储器存储有所述处理器可执行的机器可读指令，当计算机设备运行时，所述处理器与所述存储器之间通过总线通信，所述机器可读指令被所述处理器执行时执行如权利要求1至5任一所述的目标检测网络的训练方法的步骤，或者执行如权利要求6～8任一所述的目标检测方法的步骤。12.一种计算机可读存储介质，其特征在于，该计算机可读存储介质上存储有计算机程序，该计算机程序被处理器运行时执行如权利要求1至5任意一项所述的目标检测网络的训练方法的步骤，或者执行如权利要求6～8任一所述的目标检测方法的步骤。
说明书desc
技术领域本公开涉及神经网络技术领域，具体而言，涉及一种目标检测网络的训练方法、目标检测方法及装置。背景技术目标检测是计算机视觉领域的重要问题。现有的目标检测方法常常借助于深度学习技术，可以运用在缺陷检测、工业检测、智慧城市等诸多领域。现有的目标检测模型，检测精度较高的模型，模型规模较大，难以应用在低算力的设备上；而模型规模较小的目标检测模型，检测精度又比较低，因此如何均衡检测精度和模型规模成为亟待解决的问题。发明内容本公开实施例至少提供一种目标检测网络的训练方法、目标检测方法及装置。第一方面，本公开实施例提供了一种目标检测网络的训练方法，包括：基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络；基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练；基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。上述方法中，在基于初始检测网络确定第一检测网络和第二检测网络，并训练完成之后，可以基于检测精度较高的第二检测网络对第一检测网络进行蒸馏训练，进而提升第一检测网络的检测精度；这样就可以得到检测精度较高的小规模的目标检测网络。一种可能的实施方式中，所述基于初始检测网络确定第一检测网络和第二检测网络，包括：通过对所述初始检测网络进行规模调整，或者通过对所述初始检测网络进行规模调整和网络结构调整，确定所述第一检测网络和所述第二检测网络；所述规模调整包括对所述初始检测网络的网络宽度按照第一预设比例进行调整和/或对所述初始检测网络的网络深度按照第二预设比例进行调整。一种可能的实施方式中，所述基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练，包括：基于第一样本数据集对所述第一检测网络进行预训练，基于第二样本数据集对预训练后的第一检测网络进行微调训练；以及，基于所述第二样本数据集对所述第二检测网络进行训练；其中，所述第一样本数据集的样本数量多于所述第二样本数据集；所述第二样本数据集与所述目标检测网络的测试集之间的相似度，高于所述第一数据集与所述测试集之间的相似度。通过第一样本数据集对第一检测网络进行预训练，可以提高第一检测网络的泛化能力，通过第二样本数据集对第一检测网络进行微调训练，可以提高第一检测网络的精度；一种可能的实施方式中，所述基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，包括：基于所述第一检测网络的第一融合模块的输出值和所述第二检测网络的第二融合模块的输出值，确定损失值，其中，所述损失值用于表征所述第一融合模块的输出值和所述第二融合模块的输出值之间的差异；基于所述损失值和所述第二检测网络对所述第一检测网络进行蒸馏训练。通过对第一检测网络进行蒸馏训练，可以使得第一检测网络学习到第二检测网络的能力，进而可以提升第一检测网络的检测精度。一种可能的实施方式中，所述第二检测网络为所述初始检测网络。一种可能的实施方式中，所述对所述第一检测网络进行蒸馏训练之后，所述方法还包括：对蒸馏训练后的所述第一检测网络进行模型量化处理。通过对第一检测进行量化处理，可以进一步减小第一检测网络的规模，降低第一检测网络的计算量。第二方面，本公开实施例还提供了一种目标检测方法，包括：读取测试图像；基于第一方面或第一方面任一种可能的实施方式所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果。一种可能的实施方式中，所述基于第一方面或第一方面任一种可能的实施方式所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果，包括：基于所述目标检测网络对所述测试图像进行目标检测，确定所述测试图像包含的物体属于各个类别的置信度信息，以及各个物体对应的前景置信度信息，其中，所述前景置信度信息用于表示各个物体为前景的概率；基于所述前景置信度信息，筛选出前景物体；基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果。通过这种方法，可以进一步的减少目标检测网络在检测过程中的计算量，提升了计算速度，使得该目标检测网络可以部署在算力较小的设备上。一种可能的实施方式中，所述目标检测网络对所述测试图像进行目标检测后，检测结果还包括各个物体对应的位置信息；所述基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果，包括：基于所述前景物体的置信度信息中的最高置信度和所述位置信息，确定所述测试图像对应的目标检测结果。第三方面，本公开实施例还提供一种目标检测网络的训练装置，包括：确定模块，用于基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络；第一训练模块，用于基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练；第二训练模块，用于基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。一种可能的实施方式中，所述确定模块，在基于初始检测网络确定第一检测网络和第二检测网络时，用于：通过对所述初始检测网络进行规模调整，或者通过对所述初始检测网络进行规模调整和网络结构调整，确定所述第一检测网络和所述第二检测网络；所述规模调整包括对所述初始检测网络的网络宽度按照第一预设比例进行调整和/或对所述初始检测网络的网络深度按照第二预设比例进行调整。一种可能的实施方式中，所述第一训练模块，在基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练时，用于：基于第一样本数据集对所述第一检测网络进行预训练，基于第二样本数据集对预训练后的第一检测网络进行微调训练；以及，基于所述第二样本数据集对所述第二检测网络进行训练；其中，所述第一样本数据集的样本数量多于所述第二样本数据集；所述第二样本数据集与所述目标检测网络的测试集之间的相似度，高于所述第一数据集与所述测试集之间的相似度。一种可能的实施方式中，所述第二训练模块，在基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练时，用于：基于所述第一检测网络的第一融合模块的输出值和所述第二检测网络的第二融合模块的输出值，确定损失值，其中，所述损失值用于表征所述第一融合模块的输出值和所述第二融合模块的输出值之间的差异；基于所述损失值和所述第二检测网络对所述第一检测网络进行蒸馏训练。一种可能的实施方式中，所述第二检测网络为所述初始检测网络。一种可能的实施方式中，所述第二训练模块，在对所述第一检测网络进行蒸馏训练之后，还用于：对蒸馏训练后的所述第一检测网络进行模型量化处理。第四方面，本公开实施例还提供一种目标检测装置，包括：读取模块，用于读取测试图像；检测模块，用于基于第一方面或第一方面任一种可能的实施方式所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果。一种可能的实施方式中，所述检测模块，在基于第一方面或第一方面任一种可能的实施方式所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果时，用于：基于所述目标检测网络对所述测试图像进行目标检测，确定所述测试图像包含的物体属于各个类别的置信度信息，以及各个物体对应的前景置信度信息，其中，所述前景置信度信息用于表示各个物体为前景的概率；基于所述前景置信度信息，筛选出前景物体；基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果。一种可能的实施方式中，所述目标检测网络对所述测试图像进行目标检测后，检测结果还包括各个物体对应的位置信息；所述检测模块，在基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果时，用于：基于所述前景物体的置信度信息中的最高置信度和所述位置信息，确定所述测试图像对应的目标检测结果。第五方面，本公开实施例还提供一种计算机设备，包括：处理器、存储器和总线，所述存储器存储有所述处理器可执行的机器可读指令，当计算机设备运行时，所述处理器与所述存储器之间通过总线通信，所述机器可读指令被所述处理器执行时执行上述第一方面，或第一方面中任一种可能的实施方式中的步骤；或执行上述第二方面，或第二方面种任一种可能的是实施方式中的步骤。第六方面，本公开实施例还提供一种计算机可读存储介质，该计算机可读存储介质上存储有计算机程序，该计算机程序被处理器运行时执行上述第一方面，或第一方面中任一种可能的实施方式中的步骤；或执行上述第二方面，或第二方面种任一种可能的是实施方式中的步骤。关于上述目标检测网络的训练装置、目标检测装置、计算机设备、及计算机可读存储介质的效果描述参见上述目标检测网络的训练方法和目标检测方法的说明，这里不再赘述。为使本公开的上述目的、特征和优点能更明显易懂，下文特举较佳实施例，并配合所附附图，作详细说明如下。附图说明为了更清楚地说明本公开实施例的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，此处的附图被并入说明书中并构成本说明书中的一部分，这些附图示出了符合本公开的实施例，并与说明书一起用于说明本公开的技术方案。应当理解，以下附图仅示出了本公开的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1示出了本公开实施例所提供的一种目标检测网络的训练方法的流程图；图2示出了本公开实施例所提供的一种目标检测方法的流程图；图3示出了本公开实施例所提供的目标检测方法中，确定目标检测结果的具体方法的流程图；图4示出了本公开实施例所提供的一种目标检测网络的训练装置的示意图；图5示出了本公开实施例所提供的一种目标检测装置的示意图；图6示出了本公开实施例所提供的一种计算机设备的示意图。具体实施方式为使本公开实施例的目的、技术方案和优点更加清楚，下面将结合本公开实施例中附图，对本公开实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本公开一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本公开实施例的组件可以以各种不同的配置来布置和设计。因此，以下对在附图中提供的本公开的实施例的详细描述并非旨在限制要求保护的本公开的范围，而是仅仅表示本公开的选定实施例。基于本公开的实施例，本领域技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本公开保护的范围。经研究发现，现有的目标检测模型，检测精度较高的模型，模型规模较大，难以应用在低算力的设备上；而模型规模较小的目标检测模型，检测精度又比较低，因此如何均衡检测精度和模型规模成为亟待解决的问题。基于上述研究，本公开提供了一种目标检测网络的训练方法、目标检测方法及装置，在基于初始检测网络确定第一检测网络和第二检测网络，并训练完成之后，可以基于检测精度较高的第二检测网络对第一检测网络进行蒸馏训练，进而提升第一检测网络的检测精度；这样就可以得到检测精度较高的小规模的目标检测网络。针对以上方案所存在的缺陷，均是发明人在经过实践并仔细研究后得出的结果，因此，上述问题的发现过程以及下文中本公开针对上述问题所提出的解决方案，都应该是发明人在本公开过程中对本公开做出的贡献。下面将结合本公开中附图，对本公开中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本公开一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本公开的组件可以以各种不同的配置来布置和设计。因此，以下对在附图中提供的本公开的实施例的详细描述并非旨在限制要求保护的本公开的范围，而是仅仅表示本公开的选定实施例。基于本公开的实施例，本领域技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本公开保护的范围。应注意到：相似的标号和字母在下面的附图中表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中不需要对其进行进一步定义和解释。为便于对本实施例进行理解，首先对本公开实施例所公开的一种目标检测网络的训练方法进行详细介绍，本公开实施例所提供的目标检测网络的训练方法的执行主体一般为具有一定计算能力的计算机设备，该计算机设备例如包括：终端设备或服务器或其它处理设备，终端设备可以为用户设备、移动设备、用户终端、终端、蜂窝电话、无绳电话、个人数字处理、手持设备、计算设备、车载设备、可穿戴设备等。在一些可能的实现方式中，该目标检测网络的训练方法可以通过处理器调用存储器中存储的计算机可读指令的方式来实现。参见图1所示，为本公开实施例提供的一种目标检测网络的训练方法的流程图，所述方法包括步骤101～步骤103，其中：步骤101、基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络。步骤102、基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练。步骤103、基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。上述方法中，在基于初始检测网络确定第一检测网络和第二检测网络，并训练完成之后，可以基于检测精度较高的第二检测网络对第一检测网络进行蒸馏训练，进而提升第一检测网络的检测精度；这样就可以得到检测精度较高的小规模的目标检测网络。以下是对上述步骤的详细介绍。针对步骤101、在一种可能的实施方式中，所述初始检测网络可以是规模较大、检测精度较高的神经网络；示例性的，所述初始检测网络可以是yolox网络。在一种可能的实施方式中，所述基于初始检测网络确定第一检测网络和第二检测网络，可以通过对所述初始检测网络进行规模调整，或者通过对所述初始检测网络进行规模调整和网络结构调整，确定所述第一检测网络和所述第二检测网络。其中，所述对初始检测网络进行规模调整可以包括对网络宽度按照第一预设比例进行调整和/或对网络深度按照第二预设比例进行调整。这里，所述对网络宽度进行调整，可以理解为对网络通道的数量进行调整；所述对网络深度进行调整可以理解为网络的层数进行调整。这里，所述对初始检测网络进行结构调整，包括对初始检测网络中的激活函数、池化层等结构的调整，具体的其他调整本公开也并不限制，可以根据实际情况来设置。需要说明的是，第一检测网络和第二检测网络的网络规模不同，即在对初始神经网络进行规模调整得到第一检测网络时，调整的比例与对初始神经网络进行规模调整得到第二检测网络时调整的比例不同。示例性的，可以将初始检测网络的网络宽度调整至0.375倍，将网络深度调整至0.33倍，得到第一检测网络；将初始检测网络的网络宽度调整至0.75倍，将网络深度调整至0.67倍，得到第二检测网络。实际应用中，第一预设比例和第二预设比例可以根据实际情况进行设置，本公开对此并不限制。实际应用中，还可以根据部署网络的设备的计算特性，对所述初始检测网络进行网络结构调整。示例性的，可以用激活函数relu替换所述初始检测网络中的激活函数silu；或者若所述初始神经网络为yolox网络，则可以将初始检测网络中的空间金字塔池化层中，采用不同感受野的空洞卷积替换不同下采样比例的最大池化层等。实际应用中，可以根据具体的设备特性和任务需要，调整所述初始检测网络的网络结构。在一种可能的实施方式中，在对所述初始检测网络进行规模调整之后，再进行网络结构调整，得到所述第一检测网络和所述第二检测网络；或者，对所述初始检测网络进行规模调整之后再进行网络结构调整得到第一检测网络，对所述初始检测网络进行规模调整之后得到第二检测网络；或者，对所述初始检测网络进行规模调整之后得到第一检测网络和第二检测网络。需要说明的是，第一检测网络和第二检测网络在进行规模调整时，规模调整的力度可以不同，具体采用何种实施方式可以根据实际场景来选择，本公开并不限制。通过对初始检测网络进行规模调整，可以得到更小的第一检测网络和第二检测网络，由此可以实现对于检测网络的模型规模的调整。由于后续还需要对第一检测网络和第二检测网络进行训练，因此所述初始检测网络可以训练好的，或者可以是未训练的。在一种可能的实施方式中，由于第二检测网络的作用是提高第一检测网络的检测精度，通过规模调整后的网络的检测精度可能会受到影响，因此为了进一步提高第一检测网络的检测精度，所述第二检测网络可以为所述初始检测网络。针对步骤102、在一种可能的实施方式中，在基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练时，可以基于第一样本数据集对所述第一检测网络进行预训练，基于第二样本数据集对预训练后的第一检测网络进行微调训练；以及，基于所述第二样本数据集对所述第二检测网络进行训练；其中，所述第一样本数据集的样本数量多于所述第二样本数据集；所述第二样本数据集与所述目标检测网络的测试集之间的相似度，高于所述第一数据集与所述测试集之间的相似度。示例性的，所述第一样本数据集可以是Objects365数据集，所述第二样本数据集可以是MS COCO数据集中的训练集，所述测试集可以是MS COCO数据集中的测试集。由于Objects365数据集中所包含的物体类别较多，MS COCO数据集所包含的物体类别较少，而目标检测网络的网络任务是检测MS COCO数据集所包含的物体类别；因此对于Objects365数据集中所包含的，MS COCO数据集中并不包含的物体类别，对于目标检测网络的检测来说是无意义的，因此，可以先从Objects365数据集中筛选出与MS COCO数据集中相同类别的样本数据。示例性的，若MS COCO数据集中包含80个类别的物体，则可以在Objects365数据集中筛选出这80个类别的物体对应的样本数据，筛选出的样本数据构成的数据集即为第一样本数据集。这里，第一样本数据集与第二样本数据集所包含的物体类别相同，但是第一样本数据集和第二样本数据集中所包含的样本数据并不相同。不直接使用第二样本数据集训练第一检测网络的原因在于，若直接使用第二样本数据集训练第一检测网络，测试集与第二样本数据集之间的相似度较高，这样训练出的网络泛化能力较差，当使用其他测试集的数据对训练出的网络进行测试时，测试效果可能较差。而第一样本数据集和第二样本数据集所包含的物体类别相同，这样基于第一样本数据集和第二样本数据集训练出的第一检测网络的网络精度较高。另外，由于第一样本数据集中的样本数量更多，因此通过样本数量更多的第一样本数据集预训练第一检测网络，可以提高模型的泛化能力。基于第一样本数据集对所述第一检测网络进行预训练，预训练后的第一检测网络检测精度较低，因此可以通过第二样本数据集对预训练后的第一检测网络进行微调训练，微调训练后的第一检测网络相比较微调训练前的第一检测网络，检测精度更高。具体的，所述基于第二样本数据集对预训练后的第一检测网络进行微调训练，可以是基于第二样本数据集对预训练后的第一检测网络进行再训练。直接用第二样本数据集对第二检测网络进行训练的原因在于，提高第二检测网络的训练速度。由于第二检测网络的网络规模较大，检测精度本身就比较高，且第二检测网络无需很强大的泛化能力，因此，可以直接使用第二样本数据集进行训练。在另外一种可能的实施方式中，还可以先基于第一样本数据集对第二检测网络进行预训练，然后基于第二样本数据集对预训练后的第二检测网络进行微调训练。针对步骤103、在一种可能的实施方式中，在基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练时，可以基于所述第一检测网络的第一融合模块的输出值和所述第二检测网络的第二融合模块的输出值，确定损失值，其中，所述损失值用于表征所述第一融合模块的输出值和所述第二融合模块的输出值之间的差异；然后基于所述损失值和所述第二检测网络对所述第一检测网络进行蒸馏训练。由于第二检测网络的网络规模较大，因此训练后的第二检测网络的检测精度较高；而第一检测网络的网络规模较小，训练后的第一检测网络的检测精度较低。这里，进行蒸馏训练的目的在于，通过对第一融合模块的输出值和第二融合模块的输出值进行拟合，使得第一融合模块的输出值更接近第二融合模块的输出值，也即提高第一融合模块的输出值的精度。在基于所述第一融合模块的输出值和所述第二融合模块的输出值确定损失值时，示例性的，可以计算注意力转移损失、平均绝对误差等。通过对第一检测网络进行蒸馏训练，可以使得第一检测网络学习到第二检测网络的检测能力，进一步的可以提升第一检测网络的检测精度。在对第一检测网络进行蒸馏训练后，蒸馏训练完成的第一检测网络即为所述训练好的目标检测网络。在一种可能的实施方式中，为进一步减小第一检测网络的规模，降低第一检测网络的计算量，可以在对第一检测网络进行蒸馏训练之后，对蒸馏训练后的所述第一检测网络进行模型量化处理。示例性的，可以将第一检测网络中fp32的参数量化为int8，通过这种方法，可以进一步提升第一检测网络的计算速度。在一种可能的实施方式中，为提高第一检测网络和第二检测网络的训练速度，第一样本数据集和第二样本数据集中所包含的样本图像可以均为灰度图像。基于相同的构思，本公开实施例还提供了一种目标检测方法，参见图2所示为本公开实施例提供的一种目标检测方法的流程示意图，包括：步骤201、读取测试图像。步骤202、基于上述实施例所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果。这里，步骤201中读取的测试图像，可以即为测试集中的图像，所述测试集与所述第二样本数据集可以来源于同一数据集，例如可以来源于MS COCO数据集。实际应用中，所述测试集中的图像可以为彩色图像，在读取之后可以进行灰度处理，得到测试图像。在一种可能的实施方式中，在读取测试图像之后，可以先对测试图像进行预处理，示例性的可以包括对图像进行尺寸缩放、对图像进行翻转处理、对图像进行降噪处理等。在一种可能的实施方式中，在基于所述目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果时，示例性的可以通过如图3所示的方法，包括以下几个步骤：步骤301、基于所述目标检测网络对所述测试图像进行目标检测，确定所述测试图像包含的物体属于各个类别的置信度信息，以及各个物体对应的前景置信度信息，其中，所述前景置信度信息用于表示各个物体为前景的概率。步骤302、基于所述前景置信度信息，筛选出前景物体。步骤303、基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果。具体的，在将测试图像输入至目标检测网络之后，所述目标检测网络的输出可以包括：各个物体属于各个类别的置信度、各个物体为前景的概率。示例性的，若检测任务包括80个类别的物体的检测，则目标检测网络的输出中，包括每个物体对应的一个80维的向量，向量中每个值表示该物体属于对应的类别的概率，以及还包括该物体为前景的概率。在确定置信度信息之后，基于置信度信息确定目标检测结果仍需进行进一步的指数级别的计算。而背景物体是无需参与目标检测的，因此背景物体后续计算是无意义的，因此可以基于前景置信度信息，先将背景物体剔除，筛选出前景物体，然后基于前景物体的置信度进行指数级别的计算，确定目标检测结果，由此可以降低计算量。在一种可能的实施方式中，所述目标检测网络对预处理后的测试图像进行目标检测后，检测结果还包括各个物体对应的位置信息。在基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果时，可以基于所述前景物体的置信度信息中的最高置信度和所述位置信息，确定所述测试图像对应的目标检测结果。通过这种方法，可以进一步的减少目标检测网络在检测过程中的计算量，提升了计算速度，使得该目标检测网络可以部署在算力较小的设备上。本领域技术人员可以理解，在具体实施方式的上述方法中，各步骤的撰写顺序并不意味着严格的执行顺序而对实施过程构成任何限定，各步骤的具体执行顺序应当以其功能和可能的内在逻辑确定。基于同一发明构思，本公开实施例中还提供了与目标检测网络的训练方法对应的目标检测网络的训练装置，由于本公开实施例中的装置解决问题的原理与本公开实施例上述目标检测网络的训练方法相似，因此装置的实施可以参见方法的实施，重复之处不再赘述。参照图4所示，为本公开实施例提供的一种目标检测网络的训练装置的示意图，所述装置包括：确定模块401、第一训练模块402、第二训练模块403；其中，确定模块401，用于基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络；第一训练模块402，用于基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练；第二训练模块403，用于基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。一种可能的实施方式中，所述确定模块401，在基于初始检测网络确定第一检测网络和第二检测网络时，用于：通过对所述初始检测网络进行规模调整，或者通过对所述初始检测网络进行规模调整和网络结构调整，确定所述第一检测网络和所述第二检测网络；所述规模调整包括对所述初始检测网络的网络宽度按照第一预设比例进行调整和/或对所述初始检测网络的网络深度按照第二预设比例进行调整。一种可能的实施方式中，所述第一训练模块402，在基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练时，用于：基于第一样本数据集对所述第一检测网络进行预训练，基于第二样本数据集对预训练后的第一检测网络进行微调训练；以及，基于所述第二样本数据集对所述第二检测网络进行训练；其中，所述第一样本数据集的样本数量多于所述第二样本数据集；所述第二样本数据集与所述目标检测网络的测试集之间的相似度，高于所述第一数据集与所述测试集之间的相似度。一种可能的实施方式中，所述第二训练模块403，在基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练时，用于：基于所述第一检测网络的第一融合模块的输出值和所述第二检测网络的第二融合模块的输出值，确定损失值，其中，所述损失值用于表征所述第一融合模块的输出值和所述第二融合模块的输出值之间的差异；基于所述损失值和所述第二检测网络对所述第一检测网络进行蒸馏训练。一种可能的实施方式中，所述第二检测网络为所述初始检测网络。一种可能的实施方式中，所述第二训练模块403，在对所述第一检测网络进行蒸馏训练之后，还用于：对蒸馏训练后的所述第一检测网络进行模型量化处理。基于同一发明构思，本公开实施例中还提供了与目标检测方法对应的目标检测装置，由于本公开实施例中的装置解决问题的原理与本公开实施例上述目标检测方法相似，因此装置的实施可以参见方法的实施，重复之处不再赘述。参照图5所示，为本公开实施例提供的一种目标检测装置的示意图，所述装置包括：读取模块501、检测模块502；其中，读取模块501，用于读取测试图像；检测模块502，用于基于第一方面或第一方面任一种可能的实施方式所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果。一种可能的实施方式中，所述检测模块502，在基于第一方面或第一方面任一种可能的实施方式所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果时，用于：基于所述目标检测网络对所述测试图像进行目标检测，确定所述测试图像包含的物体属于各个类别的置信度信息，以及各个物体对应的前景置信度信息，其中，所述前景置信度信息用于表示各个物体为前景的概率；基于所述前景置信度信息，筛选出前景物体；基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果。一种可能的实施方式中，所述目标检测网络对所述测试图像进行目标检测后，检测结果还包括各个物体对应的位置信息；所述检测模块502，在基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果时，用于：基于所述前景物体的置信度信息中的最高置信度和所述位置信息，确定所述测试图像对应的目标检测结果。关于装置中的各模块的处理流程、以及各模块之间的交互流程的描述可以参照上述方法实施例中的相关说明，这里不再详述。基于同一技术构思，本申请实施例还提供了一种计算机设备。参照图6所示，为本申请实施例提供的计算机设备600的结构示意图，包括处理器601、存储器602、和总线603。其中，存储器602用于存储执行指令，包括内存6021和外部存储器6022；这里的内存6021也称内存储器，用于暂时存放处理器601中的运算数据，以及与硬盘等外部存储器6022交换的数据，处理器601通过内存6021与外部存储器6022进行数据交换，当计算机设备600运行时，处理器601与存储器602之间通过总线603通信，使得处理器601在执行以下指令：基于初始检测网络确定第一检测网络和第二检测网络，其中，所述第二检测网络的网络规模高于所述第一检测网络；基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练；基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，得到目标检测网络。一种可能的实施方式中，处理器601执行的指令中，基于初始检测网络确定第一检测网络和第二检测网络，包括：通过对所述初始检测网络进行规模调整，或者通过对所述初始检测网络进行规模调整和网络结构调整，确定所述第一检测网络和所述第二检测网络；所述规模调整包括对所述初始检测网络的网络宽度按照第一预设比例进行调整和/或对所述初始检测网络的网络深度按照第二预设比例进行调整。一种可能的实施方式中，处理器601执行的指令中，所述基于样本数据分别对所述第一检测网络和所述第二检测网络进行训练，包括：基于第一样本数据集对所述第一检测网络进行预训练，基于第二样本数据集对预训练后的第一检测网络进行微调训练；以及，基于所述第二样本数据集对所述第二检测网络进行训练；其中，所述第一样本数据集的样本数量多于所述第二样本数据集；所述第二样本数据集与所述目标检测网络的测试集之间的相似度，高于所述第一数据集与所述测试集之间的相似度。一种可能的实施方式中，处理器601执行的指令中，所述基于训练好的所述第一检测网络的输出值，和训练好的所述第二检测网络的输出值，对所述第一检测网络进行蒸馏训练，包括：基于所述第一检测网络的第一融合模块的输出值和所述第二检测网络的第二融合模块的输出值，确定损失值，其中，所述损失值用于表征所述第一融合模块的输出值和所述第二融合模块的输出值之间的差异；基于所述损失值和所述第二检测网络对所述第一检测网络进行蒸馏训练。一种可能的实施方式中，处理器601执行的指令中，所述第二检测网络为所述初始检测网络。一种可能的实施方式中，处理器601执行的指令中，所述对所述第一检测网络进行蒸馏训练之后，还包括：对蒸馏训练后的所述第一检测网络进行模型量化处理。或者，处理器601可以执行如下指令：读取测试图像；基于上述实施例所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果。一种可能的实施方式中，处理器601执行的指令中，所述基于上述实施例所述的目标检测网络的训练方法训练得到的目标检测网络对所述测试图像进行目标检测，确定所述测试图像对应的目标检测结果，包括：基于所述目标检测网络对所述测试图像进行目标检测，确定所述测试图像包含的物体属于各个类别的置信度信息，以及各个物体对应的前景置信度信息，其中，所述前景置信度信息用于表示各个物体为前景的概率；基于所述前景置信度信息，筛选出前景物体；基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果。一种可能的实施方式中，处理器601执行的指令中，所述目标检测网络对所述测试图像进行目标检测后，检测结果还包括各个物体对应的位置信息；所述基于所述前景物体的置信度信息，确定所述测试图像对应的目标检测结果，包括：基于所述前景物体的置信度信息中的最高置信度和所述位置信息，确定所述测试图像对应的目标检测结果。本公开实施例还提供一种计算机可读存储介质，该计算机可读存储介质上存储有计算机程序，该计算机程序被处理器运行时执行上述方法实施例中所述的目标检测网络的训练方法或目标检测方法的步骤。其中，该存储介质可以是易失性或非易失的计算机可读取存储介质。本公开实施例所提供的目标检测网络的训练方法、目标检测方法的计算机程序产品，包括存储了程序代码的计算机可读存储介质，所述程序代码包括的指令可用于执行上述方法实施例中所述的目标检测网络的训练方法或目标检测方法的步骤，具体可参见上述方法实施例，在此不再赘述。本公开实施例还提供一种计算机程序，该计算机程序被处理器执行时实现前述实施例的任意一种方法。该计算机程序产品可以具体通过硬件、软件或其结合的方式实现。在一个可选实施例中，所述计算机程序产品具体体现为计算机存储介质，在另一个可选实施例中，计算机程序产品具体体现为软件产品，例如软件开发包等等。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的系统和装置的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在本公开所提供的几个实施例中，应该理解到，所揭露的系统、装置和方法，可以通过其它的方式实现。以上所描述的装置实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，又例如，多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些通信接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本公开各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。所述功能如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个处理器可执行的非易失的计算机可读取存储介质中。基于这样的理解，本公开的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本公开各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。最后应说明的是：以上所述实施例，仅为本公开的具体实施方式，用以说明本公开的技术方案，而非对其限制，本公开的保护范围并不局限于此，尽管参照前述实施例对本公开进行了详细的说明，本领域的普通技术人员应当理解：任何熟悉本技术领域的技术人员在本公开揭露的技术范围内，其依然可以对前述实施例所记载的技术方案进行修改或可轻易想到变化，或者对其中部分技术特征进行等同替换；而这些修改、变化或者替换，并不使相应技术方案的本质脱离本公开实施例技术方案的精神和范围，都应涵盖在本公开的保护范围之内。因此，本公开的保护范围应所述以权利要求的保护范围为准。
