标题title
一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法
摘要abst
本发明提供一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，取原始彩色图像RGB中的最大值作为对应灰度图项的像素值，用分数阶积分对灰度图像进行二次处理得到平滑后的图像，对图像进行动态的大津阀值分割，获得二值裂隙图像，对二值岩石节理裂隙图进行标号，基于泉眼充水漫流来进行骨架提取，得到骨架二值图像，标号所有的裂隙，根据小溪水位漫流来检测裂隙的端点和交叉点，对骨架图像进行端点和交叉点的检测和去噪，然后重新对图像中的所有节理裂隙进行标号，对每幅图像中裂隙整体进行分形测量以确定整个图像裂隙的复杂程度，本发明提供了一种可对节理裂隙骨架自动去噪和修补的基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法。
权利要求书clms
1.一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于，包括如下步骤：取原始彩色图像RGB中的最大值或最小值作为对应灰度图项的像素值；用分数阶积分对灰度图像进行二次处理得到平滑后的图像；对图像进行动态的大津阀值分割，获得二值裂隙图像；对二值岩石节理裂隙图进行标号，然后基于泉眼充水漫流来进行骨架提取，得到骨架二值图像；标号所有的裂隙，根据小溪水位漫流来检测裂隙的端点和交叉点；根据水涨原理，对骨架图像进行端点和交叉点的检测和去噪，然后重新对图像中的所有节理裂隙进行标号；对每幅图像中裂隙整体进行分形测量以确定整个图像裂隙的复杂程度。2.根据权利要求1所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于：步骤中若图像中裂隙颜色比背景颜色暗，则对每个像素取RGB的最小值，反之取最大值。3.根据权利要求1所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于：步骤中反复两次使用分数阶积分对灰度图像进行平滑。4.根据权利要求1所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于：步骤中分数阶积分算子模板系数的和为M＝/12+2，并且对每个像素操作累加结果应该被M除。。5.根据权利要求4所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于：分别选取v＝0.4和v＝0.6进行检测点的计算，再取平均值作为监测点的值。6.根据权利要求1所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于：步骤中骨架提取方式为以某点作为泉眼，充水向外漫流，如果该漫流区域不被其它的漫流区域包含，则此点作为骨架点。7.根据权利要求1所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于，步骤中端点和分支点的检测方式为：在一单像素骨架中，对每一骨架点，该点8邻域范围内的像素的连接性与其它点不一定相同，定义骨架点的基本原则是若8邻域水的漫流区域内仅存在一个骨架点的像素,则该点是端点；若8邻域漫流区域内存在两个以上的骨架点的像素为节点的点,则其为骨架点；若8邻域漫流内存在三个或更多骨架点的像素为分支点的点,取其为骨架点。8.根据权利要求1所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于，步骤中的去噪方式为找到端点和分支点并去除长度较短的线段，将每一个线段看作是一条小溪，首先将小溪交叉点去除，若小溪太弯曲或太短，可以将此线段作为噪声去除。9.根据权利要求8所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于，步骤中具体的去噪方法为首先设短溪流的长度阈值为T，通过水涨水落检测整个骨架提取后的二值图像，检测出所有溪流端点fdn＝255及交叉点fjm＝255，设为N个端点和M个交叉点；然后分别以每个端点为检测点，在该点的八邻域漫流内找其连接点，若只找到一个连接点，置该点f＝100，进行下一个点的判断，否则删除其连接的溪流，将值为100的点置0；再以f为端点重复上面的操作，如此循环T次，这一判断过程可以删除端点到交叉点或端点至端点的小于T的溪流，在二值图像中，线段往往是不连续的，溪流也是一样，中间往往有石头或土包产生间隙，关于连接这些断点或间隙，采取一种集溪流间隙长度和方向来决定是否连接，具体步骤如下:设置一个与图像f,i＝1,...,I；j＝1,...,J相对应的数组g，该数组将存储每个端点的角度，取值在-PI到PI，为该数组的每个元素赋初值为0；找出f图像的所有端点，并计算每个端点的角度存入对应的二位数组g元素中，角度计算过程：假设当前端点的坐标，回溯n个像素点，其中n由操作者设置，统计出这n个点的x坐标平均值和y坐标平均值然后计算出的角度，存入g二维数组中，此过程中如果发现该端点是一个孤立的点，则直接赋角度0，如果在回溯过程中遇到了另一个端点，即这是一条短线段，则利用该短线段的所有像素来计算两个端点的角度；对每个端点搜索它周围是否有其它端点，这里的周围是这样表示的：假设当前端点d的坐标为，则搜索的范围为横坐标x1-cl:x1+cl，纵坐标y1-cl:y1+cl，这里的cl表示缝隙长度阀值，若周围有端点，则计算所有端点到本端点的距离和角度，在距离和角度符合缝隙阀值和角度差阀值情况下，求得其中距离最短的端点p，然后在d，p之间画一条直线。10.根据权利要求1所述的一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，其特征在于，步骤中的分形操作为：首先确定一个步长si，用si测量曲线的长度从一端量向另一端，记录该曲线上步长的数目Ni，从而得到曲线长度Li＝Ni*si+wi，这里wi为曲线上小于si的最后一段的长度，以这种方法取不同的步长s测量该曲线，得到不同的曲线长度值，最后以曲线长L为纵坐标，步长s为横坐标画出它们之间的曲线关系图来描述该曲线的长度和复杂度，从而确定曲线的维数，因为log和log呈线性关系：所欲log＝k*log+b得到的k和b可以简单地用来描述曲线的复杂度及维数。
说明书desc
技术领域本发明涉及岩土研究技术领域，具体为一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法。背景技术在岩石工程中，节理裂隙特征是一项非常重要的岩石物理性质，它包括方位、形态、规模、间距、裂隙宽度、粗糙度、壁面强度等。从裸露的岩石表面的裂隙节理可以推断出岩石内部的结构特点：如岩石内部的断层节理。从而对岩石的强度、稳定性以及水力学性质等研究提供第一手的资料。另一种方法是对地下岩体钻孔取得岩芯,通过岩芯的切片图像的分析获取岩体内部结构。传统的获取岩石节理裂隙数据的方法是人工实地测量，通常是用手持仪器如曲线板等。需要工作人员攀上裸露的岩体上进行测量,但很大一部分岩体的表面是人们不能到达的。因此人工实地测量是一种耗时而又危险的工作，同时测量精度并不高。并且由于没有将岩石表面细节详细记录在案，影响进一步的力学分析。获得精确有效的岩石裂隙节理的几何信息，对于岩石工程项目的成败，山体灾害的精确预测起着至关重要的作用。为了避免人工实地测量的弊端，可以用图像分析法来代替实地测量：将岩石节理裂隙面用不同的传感器获取，然后用图像分析技术对此数字化图像进行自动分析处理，从而获得岩石表面及内部的裂隙节理信息。岩石节理裂隙测量的应用非常广泛，除了对公路边坡及隧道安全预警外，对山体灾害、桥梁、水库大坝的检测及稳定性评价有着重要的意义，除此之外，通常还应用到公路和铁路设计、采矿中的爆破设计及边坡维护、油气及矿物勘测及核废料安全处理等民用工程中。综上所述，加强对崩滑体等地质灾害的治理的重要基础工作即是岩石节理裂隙的测量及其特征的定量描述。岩石节理裂隙图像分割后的主要目标物体骨架上多少总会出现一些毛刺和噪声,这是相关应用领域中的一个不可忽略的问题。如何去除骨架中毛刺及噪声的问题有许多相关研究报告。目前许多滤除毛刺及噪声方法的研究均与具体的应用有关:要结合实际应用设计了不同的模板来滤除骨架上的毛刺，在一些特殊的应用领域,这些模板可以滤除长度比较短的毛刺和分支，但并不通用。有些研究者主要针对形态学细线化后得到的两个像素以上的宽度骨架图像，进行了多级滤除式方法来提取单项素骨架，该方法可以达到较好的效果，但在分级问题上仍存在一些不确定的问题。由于在实际应用中，二值图像里除了噪声遗留下的细小线段外,主要目标物体骨架上的毛刺一般是由于图像分割方法不当或者噪声等干扰引起，虽然相对骨架长度来讲毛刺的长度要小得多，但到底多长的线段为毛刺是很难确定的，这就导致模板方法难以适用，基于上述问题，本案由此而生。发明内容解决的技术问题针对现有技术的不足，本发明提供了一种可对节理裂隙骨架自动进行去噪和修补的基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，解决了上述背景技术中提出的问题。技术方案为实现以上目的，本发明通过以下技术方案予以实现：一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，包括如下步骤：取原始彩色图像RGB中的最大值或最小值作为对应灰度图项的像素值；用分数阶积分对灰度图像进行二次处理得到平滑后的图像；对图像进行动态的大津阀值分割，获得二值裂隙图像；对二值岩石节理裂隙图进行标号，然后基于泉眼充水漫流来进行骨架提取，得到骨架二值图像；标号所有的裂隙，根据小溪水位漫流来检测裂隙的端点和交叉点；根据水涨原理，对骨架图像进行端点和交叉点的检测和去噪，然后重新对图像中的所有节理裂隙进行标号；对每幅图像中裂隙整体进行分形测量以确定整个图像裂隙的复杂程度。进一步的，步骤中若图像中裂隙颜色比背景颜色暗，则对每个像素取RGB的最小值，反之取最大值。进一步的，步骤中反复两次使用分数阶积分对灰度图像进行平滑。进一步的，步骤中分数阶积分算子模板系数的和为M＝/12+2，并且对每个像素操作累加结果应该被M除。进一步的，分别选取v＝0.4和v＝0.6进行检测点的计算，再取平均值作为监测点的值。进一步的，步骤中骨架提取方式为以某点作为泉眼，充水向外漫流，如果该漫流区域不被其它的漫流区域包含，则此点作为骨架点。进一步的，步骤中端点和分支点的检测方式为：在一单像素骨架中，对每一骨架点，该点8邻域范围内的像素的连接性与其它点不一定相同，定义骨架点的基本原则是若8邻域水的漫流区域内仅存在一个骨架点的像素,则该点是端点；若8邻域漫流区域内存在两个以上的骨架点的像素为节点的点,则其为骨架点；若8邻域漫流内存在三个或更多骨架点的像素为分支点的点,取其为骨架点。进一步的，步骤中的去噪方式为找到端点和分支点并去除长度较短的线段，将每一个线段看作是一条小溪，首先将小溪交叉点去除，若小溪太弯曲或太短，可以将此线段作为噪声去除。进一步的，步骤中具体的去噪方法为首先设短溪流的长度阈值为T，通过水涨水落检测整个骨架提取后的二值图像，检测出所有溪流端点fdn＝255及交叉点fjm＝255，设为N个端点和M个交叉点；然后分别以每个端点为检测点，在该点的八邻域漫流内找其连接点，若只找到一个连接点，置该点f＝100，进行下一个点的判断，否则删除其连接的溪流，将值为100的点置0；再以f为端点重复上面的操作，如此循环T次，这一判断过程可以删除端点到交叉点或端点至端点的小于T的溪流，在二值图像中，线段往往是不连续的，溪流也是一样，中间往往有石头或土包产生间隙，关于连接这些断点或间隙，采取一种集溪流间隙长度和方向来决定是否连接，具体步骤如下:设置一个与图像f,i＝1,...,I；j＝1,...,J相对应的数组g，该数组将存储每个端点的角度，取值在-PI到PI，为该数组的每个元素赋初值为0；找出f图像的所有端点，并计算每个端点的角度存入对应的二位数组g元素中，角度计算过程：假设当前端点的坐标，回溯n个像素点，其中n由操作者设置，统计出这n个点的x坐标平均值和y坐标平均值然后计算出的角度，存入g二维数组中，此过程中如果发现该端点是一个孤立的点，则直接赋角度0，如果在回溯过程中遇到了另一个端点，即这是一条短线段，则利用该短线段的所有像素来计算两个端点的角度；对每个端点搜索它周围是否有其它端点，这里的周围是这样表示的：假设当前端点d的坐标为，则搜索的范围为横坐标x1-cl:x1+cl，纵坐标y1-cl:y1+cl，这里的cl表示缝隙长度阀值，若周围有端点，则计算所有端点到本端点的距离和角度，在距离和角度符合缝隙阀值和角度差阀值情况下，求得其中距离最短的端点p，然后在d，p之间画一条直线。进一步的，步骤中的分形操作为：首先确定一个步长si，用si测量曲线的长度从一端量向另一端，记录该曲线上步长的数目Ni，从而得到曲线长度Li＝Ni*si+wi，这里wi为曲线上小于si的最后一段的长度，以这种方法取不同的步长s测量该曲线，得到不同的曲线长度值，最后以曲线长L为纵坐标，步长s为横坐标画出它们之间的曲线关系图来描述该曲线的长度和复杂度，从而确定曲线的维数，因为log和log呈线性关系：所欲log＝k*log+b得到的k和b可以简单地用来描述曲线的复杂度及维数。有益效果本发明提供了一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法。具备以下有益效果：1、采用水涨水落原理可对提取的节理裂隙骨架自动进行去噪和修补。2、利用分形学理论不是对单一的节理裂隙进行复杂度分析描述，而且可对复杂多条节理裂隙进行整体的复杂度分析描述。附图说明图1发明的工作流程图；图2为本发明的分数阶积分模板图；图3为一幅岩石节理裂隙图像处理的例子；图4为对图3中的每条节理裂隙进行分形学的描述。具体实施方式参照图1至图4对本发明一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法的实施例作进一步说明。一种基于改进的分形学的岩石节理裂隙整体复杂度测量分析方法，具体如下：取原始彩色图像RGB中的最大值或最小值作为对应灰度图项的像素值，其中若图像中裂隙颜色比背景颜色暗，则对每个像素取RGB的最小值，反之取最大值，为了消除岩石表面的噪声，但又尽可能保留节理裂隙信息，反复两次使用改进的分数阶积分对灰度图像进行平滑，再用动态的大津阈值化得到二值图像，本发明中我们采用5X5模板具体如图2所示，改进的这种模板与传统的分数阶积分算子模板完全不同，在图2的模板中，每个像素的系数都不为0，模板系数的和为M＝/12+2，最后对每个像素操作累加结果应该被M除，在这里，为了避免单一分数阶阶数会产生计算值的不稳定性，我们分别选取v＝0.4和v＝0.6进行检测点的计算，再取平均值作为监测点的值，接着对每一个标号目标，以某点为泉眼作，充水向外漫流，如果该漫流区域不被其他的漫流区域包含，则此点作为骨架点。在这种算法中，最大漫流区域记录了图形内每个点到漫流边界的最短距离，以任一点为中心的距离变换值为以该点为漫流区域的最大区域，根据水涨原理，对骨架图像进行端点和分支点的检测和去噪，然后重新对图像中的所有节理裂隙进行标号：其中端点和分支点的检测方法为：在一单像素骨架中，对每一骨架点，该点8邻域范围内的像素的连接性与其它点不一定相同。定义骨架点的基本原则：若8邻域水的漫流区域内仅存在一个骨架点的像素,则该点是端点，若8邻域漫流区域内存在两个以上的骨架点的像素为节点的点,则其为骨架点，若8邻域漫流内存在三个或更多骨架点的像素为分支点的点,取其为骨架点。其中去除毛刺的任务就是找到端点和分支点并去除长度较短的线段：将每一个线段看作是一条小溪，首先将小溪交叉点去除，若小溪太弯曲或太短，可以将此线段作为噪声去除。具体做法是：首先设短溪流的长度阈值为T，通过水涨水落检测整个骨架提取后的二值图像，检测出所有溪流端点fdn＝255及交叉点fjm＝255，设为N个端点和M个交叉点；然后分别以每个端点为检测点，在该点的八邻域漫流内找其连接点，若只找到一个连接点，置该点f＝100，进行下一个点的判断，否则删除其连接的溪流；再以f为端点重复上面的操作，如此循环T次。这一判断过程可以删除端点到交叉点或端点至端点的小于T的溪流。在二值图像中，线段往往是不连续的，溪流也是一样，中间往往有石头或土包，关于连接这些断点或间隙，采取一种集溪流间隙长度和方向来决定是否连接，具体步骤如下:设置一个与图像f,i＝1,...,I；j＝1,...,J相对应的数组g，该数组将存储每个端点的角度，取值在-PI到PI。为该数组的每个元素赋初值为0；找出f图像的所有端点，并计算每个端点的角度存入对应的二位数组g元素中，角度计算过程：假设当前端点的坐标，回溯n个像素点，统计出这n个点的x坐标平均值和y坐标平均值然后计算出)的角度，存入g二维数组中。此过程中如果发现该端点是一个孤立的点，则直接赋角度0，如果在回溯过程中遇到了另一个端点，则利用该短线段的所有像素来计算两个端点的角度；对每个端点搜索它周围是否有其它端点，这里的周围是这样表示的：假设当前端点d的坐标，则搜索的范围为横坐标x1-cl:x1+cl，纵坐标y1-cl:y1+cl，这里的cl表示缝隙长度阀值。若周围有端点，则计算所有端点到本端点的距离和角度，在距离和角度符合缝隙阀值和角度差阀值情况下，求得其中距离最短的端点p，然后在d，p之间画一条直线。最后对每幅图像中裂隙整体进行分形测量以确定整个图像裂隙的复杂程度具体的分形操作是：和传统的方法不同，因为一幅图像中可能有多条裂隙，我们不一定只是感兴趣一条裂隙，而是整幅图像的裂隙模式及复杂程度，故此，假象整幅图像中的多条裂隙组成了一条长裂隙，其交叉及结构的不同页就显示了其复杂度的不同。具体做法是：首先确定一个步长si，用si测量曲线的长度从一端量向另一端，记录该曲线上步长的数目Ni，从而得到曲线长度Li＝Ni*si+wi，这里wi为曲线上小于si的最后一段的长度。以这种方法取不同的步长s测量该曲线，得到不同的曲线长度值。最后以曲线长L为纵坐标，步长s为横坐标画出它们之间的曲线关系图来描述该曲线的长度和复杂度，从而确定曲线的维数。因为log和log呈线性关系：所欲log＝k*log+b得到的k和b可以简单地用来描述曲线的复杂度及维数。如图3和图4所示在岩石工程中，节理裂隙分类一直是一个难题。图2是一个实际的应用例子，原始图像是一幅微裂隙图像，由于岩体表面粗糙及裂隙窄使图像获取困难，采取在岩体中钻一孔，用一定压力注入液体环氧树脂，时隔一个月后，进入到微裂隙中的荧光液体已经干燥，再用紫外线光源照射岩体表面获取较为清晰的图像，所以绿色的线条为开启的岩石节理裂隙。为了有效地提取岩体中的节理裂隙，取彩色图像的RGB中最大值并转为灰度图，然后用动态大津法自动阈值化，在该二值图象中还存在着许多不规则的目标物体-非节理裂隙，为此，分析每一个黑色目标并测量其形状，由于岩石裂隙皆为长条形，如果其长宽比小于一定的阈值，且前景像素占形状外接矩形总像素70％以上，则将目标去除。然后对所有检测到的线性目标物体进行骨架提取得到图3。为了避免一些重要的短线段被当成毛刺去除，首先按节3方法连接短间隙，然后再去除毛刺和噪声，如此反复地间隙缝合及毛刺去除，可以得到图3的结果，最后为了分形的描述便利，将每条裂隙平滑，平滑是根据B-Spline方法进行，可以得到图4，为了更加详细地进行分形学分析，对图3的不同曲线进行标号，根据标号计算不同目标的分形参数，并统计其整体分形参数，按测量长度对数为纵坐标、步长对数为横坐标在X-Y平面上绘制散点图，然后利用最小二乘法直线拟合这些散点，求得曲线分形复杂度k和b。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。
