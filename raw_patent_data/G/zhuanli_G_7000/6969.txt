标题title
大规模细粒度图像检索中的属性感知哈希编码学习方法
摘要abst
本发明公开了一种大规模细粒度图像检索中的属性感知哈希编码学习方法，包括以下步骤：通过卷积神经网络提取图像中的全局特征与局部特征信息；构建哈希学习模块，将高维度的图像特征信息提取到低维度的哈希空间并构建哈希特征解码器，通过无监督的方式引导哈希学习过程中的属性特征提取方式；增强哈希模块学习得到的每个维度属性的鉴别能力，去除每个维度属性特征之间的冗余相关性，使得每个维度的属性特征都有自己独特且完整的表达含义。本发明通过卷积神经网络与注意力机制提取图像中的局部与全局特征，通过建立属性特征解码器并使特征向量拥有自正交特性，引导哈希学习保留相对完整且重要的整体图像特征信息，可以获得更高的图像检索准确率。
权利要求书clms
1.一种大规模细粒度图像检索中的属性感知哈希编码学习方法，包括以下步骤：步骤1，通过卷积神经网络提取图像中的全局特征与局部特征信息；步骤2，构建哈希学习模块，将高维度的图像特征信息提取到低维度的哈希空间并构建哈希特征解码器，通过无监督的方式引导哈希学习过程中的属性特征提取方式；步骤3，增强步骤2中哈希模块学习得到的每个维度属性的鉴别能力，去除每个维度属性特征之间的冗余相关性。2.根据权利要求1所述的大规模细粒度图像检索中的属性感知哈希编码学习方法，其特征在于，步骤1通过在卷积神经网络中引入注意力机制，来获取图像的全局与局部特征以表达每一幅图像的显著特征；首先通过卷积神经网络提取输入图像的深度特征：其中代表一个定制的卷积神经网络，C、H与W分别代表深度特征的通道数、特征长度及特征宽度；在公式中得到的深度特征的基础上，引入C个局部注意力引导模块，记这些引导模块为，再引入一个全局注意力引导模块，记为，图像局部特征输出为：图像的全局特征输出为：通过对这些特征输出进行全局平均池化后得到图像的全局特征向量与局部深度特征向量，依次拼接后得到图像的整体特征向量记作。3.根据权利要求1所述的大规模细粒度图像检索中的属性感知哈希编码学习方法，其特征在于，构建哈希学习模块，通过一个变换矩阵将步骤1中得到的深度特征向量映射到k维的哈希空间中，记作；图像的二进制哈希编码由通过两次激活得到：其中是k维的近似二进制编码，它是通过变换矩阵得到的高度浓缩的图像特征表达向量，则是最终得到的图像的二进制编码，即通过k位的比特信息表达整张图像的信息；第一次激活tanh用以约束的数值空间并使梯度可进行反向传播，第二次激活则将特征向量约束为汉明编码；在计算哈希损失时，假设有n个查询点以及m个数据库点，遵循公式，查询点与数据库点的哈希编码分别可以记为：其中是通过查询点激活得到的哈希编码，是通过数据库点激活得到的哈希编码；则哈希编码的损失可记为：其中，；特征解码器通过重构经过tanh激活后的哈希空间特征，将属性特征复原并约束特征损失，记作：其中，，d表示每一个特征向量的维度；代表重构矩阵，为哈希变换矩阵的转置；为损失优化过程中引入的超参数，，。4.根据权利要求3所述的大规模细粒度图像检索中的属性感知哈希编码学习方法，其特征在于，增强步骤2中哈希模块学习得到的每个维度属性的鉴别能力，对步骤2中经过哈希变换矩阵并经过tanh激活得到的特征向量构建自正交损失，记为：其中为单位矩阵，这样能够消除每个维度空间学习到的属性特征的冗余相关性，每一个哈希维度均可表示一种深度的属性特征信息；整体的约束损失可记为： 其中与为引入的超参数，用于对齐量纲；输入图像的二进制哈希编码输出记为：式中GAP代表全局平均池化，其作用是将特征图进行降维并形成一个特征点。5.一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1~4中任一项所述大规模细粒度图像检索中的属性感知哈希编码学习方法的步骤。6.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1~4中任一项所述大规模细粒度图像检索中的属性感知哈希编码学习方法的步骤。
说明书desc
技术领域本发明属于计算机视觉领域，具体涉及一种大规模细粒度图像检索中的属性感知哈希编码学习方法。背景技术细粒度图像检索作为细粒度图像分析的重要组成部分，近年来得到了越来越多的关注。细粒度图像识别是计算机视觉和模式识别领域的基础研究课题，旨在研究对某一传统语义类别下细粒度级别的不同子类类别进行视觉识别任务，如不同子类的狗、不同子类的鸟、不同车型的汽车等……细粒度图像识别被计算机视觉国际权威学者、ICCVHelmholtz奖及Marr奖获得Serge Belongie教授称为“视觉感知嵌入的基石性工作”。由于细粒度图像中的物体对象在类间差异中只有细微的视觉差异，缺又在姿态、规模等类内差异上有较大的变化，因此有较大的检索难度。哈希学习是通过机器学习的方法，将数据映射成二进制串的形式，能显著减少数据的存储和通信开销，从而有效提高学习系统的效率。哈希学习的目的是学到数据的二进制哈希码表示，使得哈希码尽可能地保留原空间中的近邻关系，即保相似性。具体来说，每个数据点会被一个紧凑的二进制串编码，在原空间中相似的两个点应当被映射到哈希码空间中相似的两个点。哈希方法大致分为两类，即数据无关方法和数据依赖方法。在数据无关的哈希方法中，模型中的哈希函数通常随机生成，且独立于任何训练数据，但检索性能的提高需要用哈希码的长度换取。数据依赖的哈希方法试图从一些训练数据中学习哈希函数，称为学习哈希算法。与数据无关的方法相比，学习哈希算法可以用更短的哈希码实现更高的准确性。因此，在实际应用中学习哈希算法比数据无关方法更流行。随着深度学习的兴起，一些学习哈希方法将深度特征学习集成到哈希框架中，获得了很好的性能。在以往的工作中，针对大规模图像检索，已经提出了许多深度哈希方法。与深度无监督哈希方法相比，深度监督哈希方法能够充分挖掘语义信息，获得更高的检索精度。虽然现在的深度学习哈希算法已经有了很好的检索效果，但是都仅限于粗粒度的数据检索。在很多情况下，以狗的图片搜索为例，人们不仅仅希望搜索的得到的图片是狗而不是其他动物，还希望这是什么品种的狗，比如是柯基还是萨摩耶。在这样的情况下，目前已有的学习哈希方法的检索准确率非常低。另一方面，现有的学习哈希方法得到的二进制编码没有任何实际意义，这样图片的存储与检索结果将不会具有任何可解释性。因此需要提出一种新的，可以在细粒度检索环境中得到具有高准确率响应结果的有实际含义的学习哈希方法。发明内容本发明的目的在于提供一种大规模细粒度图像检索中的属性感知哈希编码学习方法。实现本发明目的的技术方案为：一种大规模细粒度图像检索中的属性感知哈希编码学习方法，包括以下步骤：步骤1，通过卷积神经网络提取图像中的全局特征与局部特征信息；步骤2，构建哈希学习模块，将高维度的图像特征信息提取到低维度的哈希空间并构建哈希特征解码器，通过无监督的方式引导哈希学习过程中的属性特征提取方式；步骤3，增强步骤2中哈希模块学习得到的每个维度属性的鉴别能力，去除每个维度属性特征之间的冗余相关性。一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述大规模细粒度图像检索中的属性感知哈希编码学习方法的步骤。一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述大规模细粒度图像检索中的属性感知哈希编码学习方法的步骤。本发明与现有技术相比，其显著优点为：本发明不仅在粗粒度的图像检索中具有比肩传统哈希学习方法的表现结果，而且在细粒度图像的检索中拥有远超传统哈希学习方法的检索准确率；建立属性特征解码器，引导哈希学习保留相对完整且重要的整体图像特征信息，使得每一维哈希空间中的信息特征进行重组后可以更全面的表达原图像中蕴含的信息；通过构建属性自正交的方式，消除每个维度空间学习到的属性特征的冗余相关性，使得每个维度的属性特征都有自己独特且完整的表达含义，即每一个哈希维度都可以表示一种深度的属性特征信息。该发明赋予了哈希空间中的每一维信息以属性含义，这是其他哈希学习的方法不具备的。附图说明图1为本发明一种大规模细粒度图像检索中的属性感知哈希编码学习方法示意图。具体实施方式结合图1，一种大规模细粒度图像检索中的属性感知哈希编码学习方法，具体包括以下步骤：步骤1，通过卷积神经网络提取图像中的全局特征与局部特征信息；注意力在人类的感知中起着非常重要的作用，它让我们着重关注一样事物或是场景的显著特征，因此我们在卷积神经网络中引入注意力机制，来获取图像的全局与局部特征以更好的表达每一幅图像的显著特征。具体而言，首先需要通过卷积神经网络提取输入图像的深度特征：其中代表一个定制的卷积神经网络，C、H与W分别代表深度特征的通道数、特征长度及特征宽度；在公式中得到的深度特征的基础上，引入C个局部注意力引导模块，此处的C个局部注意力引导模块与深度特征的通道数C相对应，记为，再引入一个全局注意力引导模块，记为，图像局部特征输出为：图像的全局特征输出为：通过对这些特征输出进行全局平均池化后得到图像的全局特征向量与局部深度特征向量，依次拼接后得到图像的整体特征向量记作。步骤2，构建哈希学习模块，将高维度的图像特征信息提取到低维度的哈希空间并构建哈希特征解码器，通过无监督的方式引导哈希学习过程中的属性特征提取方式；哈希学习模块通过一个变换矩阵将步骤1中得到的深度特征向量映射到k维的哈希空间中，记作。图像的二进制哈希编码由通过两次激活得到：其中是k维的近似二进制编码，它是通过变换矩阵得到的高度浓缩的图像特征表达向量，则是最终得到的图像的二进制编码，即可以通过k位的比特信息表达整张图像的信息，大大压缩的检索空间。第一次激活tanh用以约束的数值空间并使梯度可进行反向传播，第二次激活则将特征向量约束为汉明编码加快图像检索速度。在计算哈希损失时，假设有n个查询点以及m个数据库点，遵循公式，查询点与数据库点的哈希编码分别可以记为：其中是通过查询点激活得到的哈希编码，是通过数据库点激活得到的哈希编码。则哈希编码的损失可记为：其中，。特征解码器通过重构经过tanh激活后的哈希空间特征，将属性特征复原并约束特征损失，记作：其中，，d表示每一个特征向量的维度；代表重构矩阵，为哈希变换矩阵的转置；，为损失优化过程中引入的超参数，，通过无监督的编码重构，可以引导哈希学习保留相对完整且重要的整体图像特征信息，使得每一维哈希空间中的信息特征进行重组后可以更全面的表达原图像中蕴含的信息。步骤3，增强步骤2中哈希模块学习得到的每个维度属性的鉴别能力，去除每个维度属性特征之间的冗余相关性。对步骤2中经过哈希变换矩阵并经过tanh激活得到的特征向量构建自正交损失，记为：其中为单位矩阵，这样可以消除每个维度空间学习到的属性特征的冗余相关性，使得每个维度的属性特征都有自己独特且完整的表达含义，即每一个哈希维度都可以表示一种深度的属性特征信息。整体的约束损失可以记为： 其中与为引入的超参数，用于对齐量纲。输入图像的二进制哈希编码输出可以记为：式中GAP代表全局平均池化。以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
