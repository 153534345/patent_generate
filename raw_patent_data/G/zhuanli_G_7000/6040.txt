标题title
基于结构差异感知的类别级六自由度物体位姿估计方法
摘要abst
本发明涉及一种基于结构差异感知的类别级六自由度物体位姿估计方法，包括：将深度图输入至目标检测分割网络进行识别，并根据识别结果得到物体实例的观测点云，并基于物体实例的观测点云选择目标物体对应的类别先验；提取观测点云和类别先验的特征，得到实例几何特征和类别几何特征；将实例几何特征和类别几何特征输入信息交互增强模块，得到增强的实例几何特征和类别几何特征；再通过所述语义动态融合模块进行语义和几何信息的融合，得到实例融合特征和类别融合特征；基于类别融合特征得到实例NOCS模型；通过匹配网络将实例NOCS模型和观测点云进行匹配，并根据相似性计算得到目标物体的6D位姿和大小。本发明能够提高6D位姿估计的准确性。
权利要求书clms
1.一种基于结构差异感知的类别级六自由度物体位姿估计方法，其特征在于，包括以下步骤：将深度图输入至目标检测分割网络，得到目标物体的图像块以及目标物体的分割掩码；根据目标物体的分割掩码和所述深度图得到物体实例的观测点云，并基于物体实例的观测点云选择目标物体对应的类别先验；提取观测点云和类别先验的特征，得到实例几何特征和类别几何特征；将所述实例几何特征和类别几何特征输入信息交互增强模块，通过所述信息交互增强模块去隐式建模所述实例几何特征和类别几何特征之间的几何差异，并对实例几何特征和类别几何特征进行补充，得到增强的实例几何特征和类别几何特征；将所述实例几何特征和类别几何特征之间的几何差异、增强的实例几何特征和类别几何特征输入至语义动态融合模块，通过所述语义动态融合模块进行语义和几何信息的融合，得到实例融合特征和类别融合特征；将所述类别融合特征送入到变形网络得到变形场，利用所述变形场对类别先验变形得到实例NOCS模型；通过匹配网络将所述实例NOCS模型和观测点云进行匹配，并根据相似性计算得到目标物体的6D位姿和大小。2.根据权利要求1所述的基于结构差异感知的类别级六自由度物体位姿估计方法，其特征在于，所述目标检测分割网络采用Mask-RCNN网络。3.根据权利要求1所述的基于结构差异感知的类别级六自由度物体位姿估计方法，其特征在于，所述提取观测点云和类别先验的特征时采用卷积神经网络和PointNet++网络实现。4.根据权利要求1所述的基于结构差异感知的类别级六自由度物体位姿估计方法，其特征在于，所述信息交互增强模块包括：全连接层，用于分别将所述实例几何特征和类别几何特征映射到相同的特征子空间；矩阵乘单元，用于将映射到相同的特征子空间的实例几何特征和类别几何特征进行矩阵乘操作，得到实例几何特征和类别几何特征之间的结构关系矩阵；归一化单元，用于将所述结构关系矩阵归一化为权重系数；加权求和单元，用于采用所述权重系数对所述结构关系矩阵中的几何投影特征进行加权求和，得到实例几何特征和类别几何特征之间的；多层感知器，用于将几何差异分别与所述实例几何特征和类别几何特征进行融合，得到增强的实例几何特征和类别几何特征。5.根据权利要求1所述的基于结构差异感知的类别级六自由度物体位姿估计方法，其特征在于，所述语义动态融合模块对于增强的实例几何特征采用像素级融合策略实现对应点融合模块来探索数据源之间的内在映射，得到实例融合特征，对于不同个体的增强的类别几何特征和实例几何特征，采用实例几何特征和类别几何特征之间的几何差异动态调整所述增强的实例几何特征，将调整后的增强的实例几何特征与增强的类别几何特征进行融合，得到类别融合特征。
说明书desc
技术领域本发明涉及计算机视觉技术领域，特别是涉及一种基于结构差异感知的类别级六自由度物体位姿估计方法。背景技术从图片中估计现实物体的六自由度位姿是一个十分关键的任务，即估计物体在相机坐标系下的位置和朝向，由一个三维的旋转矩阵和一个三维的平移矢量组成。物体6D位姿估计任务被广泛应用在很多现实场景中，如3D场景理解、机器人抓取、虚拟现实和增强现实等领域。6D位姿估计任务按照被估计物体的级别可分为两类：1.针对特定物体的实例级6D位姿估计；2.针对同一类物体的类别级6D位姿估计。实例级6D位姿估计任务在计算物体位姿时，需要事先知道自己在世界坐标系下的位置，一般世界坐标系的中心落在物体的中心处，也即它的CAD模型。对于现实场景中没有定义CAD模型的新物体，实例级6D位姿估计算法就没办法去估计出物体的位姿，这严重的限制了实例级6D位姿估计算法在现实场景中的应用。因此，为了打破实例级6D位姿估计方法的限制，类别级6D位姿估计任务被提出，它能够估计同一类别下不同物体实例的6D位姿，即使一些物体实例没有CAD模型。Wang等人首先提出类别级物体6D位姿估计任务的概念，为了解决在估计物体的6D位姿时缺乏CAD模型的问题，他们引入了一个归一化物体坐标空间——一个类别下所有可能的对象实例的共享规范表示，通过首先在NOCS中重建物体实例，然后计算物体实例从NOCS空间到相机坐标系的位姿变换关系，也即物体的6D位姿。由于相同类别下的不同物体实例可能具有很大的结构差异，因此，重建它们的NOCS模型是一个十分困难的任务，这是类别级物体6D位姿估计任务的难点。针对这个问题，SPD提出为每个类别学习一个类别先验，之后根据不同的物体实例对类别先验进行变形，重建出物体实例的NOCS模型，进一步增加了位姿估计的精度，但是类别先验信息模糊导致重建的NOCS模型不够精确。发明内容本发明所要解决的技术问题是提供一种基于结构差异感知的类别级六自由度物体位姿估计方法，能够提高6D位姿估计的准确性。本发明解决其技术问题所采用的技术方案是：提供一种基于结构差异感知的类别级六自由度物体位姿估计方法，包括以下步骤：将深度图输入至目标检测分割网络，得到目标物体的图像块以及目标物体的分割掩码；根据目标物体的分割掩码和所述深度图得到物体实例的观测点云，并基于物体实例的观测点云选择目标物体对应的类别先验；提取观测点云和类别先验的特征，得到实例几何特征和类别几何特征；将所述实例几何特征和类别几何特征输入信息交互增强模块，通过所述信息交互增强模块去隐式建模所述实例几何特征和类别几何特征之间的几何差异，并对实例几何特征和类别几何特征进行补充，得到增强的实例几何特征和类别几何特征；将所述实例几何特征和类别几何特征之间的几何差异、增强的实例几何特征和类别几何特征输入至语义动态融合模块，通过所述语义动态融合模块进行语义和几何信息的融合，得到实例融合特征和类别融合特征；将所述类别融合特征送入到变形网络得到变形场，利用所述变形场对类别先验变形得到实例NOCS模型；通过匹配网络将所述实例NOCS模型和观测点云进行匹配，并根据相似性计算得到目标物体的6D位姿和大小。所述目标检测分割网络采用Mask-RCNN网络。所述提取观测点云和类别先验的特征时采用卷积神经网络和PointNet++网络实现。所述信息交互增强模块包括：全连接层，用于分别将所述实例几何特征和类别几何特征映射到相同的特征子空间；矩阵乘单元，用于将映射到相同的特征子空间的实例几何特征和类别几何特征进行矩阵乘操作，得到实例几何特征和类别几何特征之间的结构关系矩阵；归一化单元，用于将所述结构关系矩阵归一化为权重系数；加权求和单元，用于采用所述权重系数对所述结构关系矩阵中的几何投影特征进行加权求和，得到实例几何特征和类别几何特征之间的；多层感知器，用于将几何差异分别与所述实例几何特征和类别几何特征进行融合，得到增强的实例几何特征和类别几何特征。所述语义动态融合模块对于增强的实例几何特征采用像素级融合策略实现对应点融合模块来探索数据源之间的内在映射，得到实例融合特征，对于不同个体的增强的类别几何特征和实例几何特征，采用实例几何特征和类别几何特征之间的几何差异动态调整所述增强的实例几何特征，将调整后的增强的实例几何特征与增强的类别几何特征进行融合，得到类别融合特征。有益效果由于采用了上述的技术方案，本发明与现有技术相比，具有以下的优点和积极效果：本发明利用物体实例和类别先验之间的结构差异去增强类内形状信息的学习，进一步通过语义动态融合模块根据物体实例和类别先验的几何关系动态调整语义信息，之后和增强的类别先验融合去动态补充几何信息的缺失，以提高对噪声的鲁棒性。附图说明图1是本发明实施方式基于结构差异感知的类别级六自由度物体位姿估计方法的流程图；图2是本发明实施方式中信息交互增强模块的示意图；图3是本发明实施方式中语义动态融合模块的示意图；图4是不同物体实例的观测点云的示意图；图5是本发明实施方式与SPD方法的结果对比。具体实施方式下面结合具体实施例，进一步阐述本发明。应理解，这些实施例仅用于说明本发明而不用于限制本发明的范围。此外应理解，在阅读了本发明讲授的内容之后，本领域技术人员可以对本发明作各种改动或修改，这些等价形式同样落于本申请所附权利要求书所限定的范围。本发明的实施方式涉及一种基于结构差异感知的类别级六自由度物体位姿估计方法，该方法利用物体实例和类别先验之间的结构差异去增强类内形状信息的学习，并通过语义动态融合模块，根据物体实例和类别先验的几何关系动态调整语义信息，之后和增强的类别先验融合去动态补充几何信息的缺失。如图1所示，包括以下步骤：步骤1，将深度图输入至目标检测分割网络，得到目标物体的图像块以及目标物体的分割掩码。本步骤中可以采用现有的目标检测分割网络得到目标物体的图像块以及它的分割掩码，例如可以采用Mask-RCNN网络。步骤2，根据目标物体的分割掩码和所述深度图得到物体实例的观测点云，并基于物体实例的观测点云选择目标物体对应的类别先验。步骤3，提取观测点云和类别先验的特征，得到实例几何特征和类别几何特征。本步骤中可以分别使用卷积神经网络和PointNet++去提取图片语义特征和点云几何特征，从而得到实例几何特征和类别几何特征。步骤4，将所述实例几何特征和类别几何特征输入信息交互增强模块，通过所述信息交互增强模块去隐式建模所述实例几何特征和类别几何特征之间的几何差异，并对实例几何特征和类别几何特征进行补充，得到增强的实例几何特征和类别几何特征。本步骤中的信息交互增强模块旨在学习实例点云与类别先验之间的结构关系，以帮助在特征层次上构建它们的结构差异信息。它利用结构差异的特征来补充原始的几何特征，使增强的几何特征包括实例结构的独特个体性和类别先验的一般共性。一方面，由于实例结构特性的补充性，增强的类别几何特征可以重建一个更精确的实例NOCS模型。另一方面，实例几何特征增加了类别形状的共性，从而使重建的对应矩阵更好地将观察到的点云与NOCS模型关联起来。此外，由于类别先验和同一类下的不同实例之间的几何差异是不同的，采用信息交互增强模块能够适应以前未见过的各种形状的实例，极大地增加了本实施方式的泛化。信息交互增强模块的结构如图2所示，包括：全连接层，用于分别将所述实例几何特征和类别几何特征映射到相同的特征子空间；矩阵乘单元，用于将映射到相同的特征子空间的实例几何特征和类别几何特征进行矩阵乘操作，得到实例几何特征和类别几何特征之间的结构关系矩阵；归一化单元，用于将所述结构关系矩阵归一化为权重系数；加权求和单元，用于采用所述权重系数对所述结构关系矩阵中的几何投影特征进行加权求和，得到实例几何特征和类别几何特征之间的；多层感知器，用于将几何差异分别与所述实例几何特征和类别几何特征进行融合，得到增强的实例几何特征和类别几何特征。如此对于实例几何特征和类别几何特征，可以使用全连接网络层把它们映射到相同的特征子空间，然后通过矩阵乘操作获得它们的结构关系矩阵。然后把结构关系矩阵归一化为权重系数，对几何投影特征进行加权求和获得结构差异特征。最终，利用多层感知器将原始几何特征与结构差异特征融合得到增强的几何特征。步骤5，将所述实例几何特征和类别几何特征之间的几何差异、增强的实例几何特征和类别几何特征输入至语义动态融合模块，通过所述语义动态融合模块进行语义和几何信息的融合，得到实例融合特征和类别融合特征。如图4所示，经过目标检测和分割模型获得的物体实例点云，有可能包含一定的噪声点。当这些噪声点的影响传递到类别先验时，理论上会对NOCS模型的重建精度产生负面影响，导致物体实例点云和它的NOCS模型的对应关系出现偏差。为了解决这个问题，本实施方式设计了一个语义动态融合模块，通过充分的融合几何和语义信息，提高网络对噪声点的鲁棒性。图3展示了语义动态融合模块，该语义动态融合模块对于增强的实例几何特征采用像素级融合策略实现对应点融合模块来探索数据源之间的内在映射，得到实例融合特征，对于不同个体的增强的类别几何特征和实例几何特征，采用实例几何特征和类别几何特征之间的几何差异动态调整所述增强的实例几何特征，将调整后的增强的实例几何特征与增强的类别几何特征进行融合，得到类别融合特征。也就是说，本实施方式借鉴了DenseFusion中的方法，采用一个像素级融合策略实现了对应点融合模块来探索数据源之间的内在映射。对于来自不同个体的类别几何特征和实例语义特征，由于它们不存在像素级的对应关系，因此像素级融合策略不能被直接使用，于是本实施方式采用两种不同的融合策略。第一种是特征融合的一般思想，将两者拼接起来然后通过MLP函数进行融合，这种方式称它为直接融合。虽然直接融合策略可以通过吸收语义信息提高性能，但对于跨个体问题仍然考虑不足。为此，本实施方式还设计了语义融合策略，根据实例和类别的结构关系矩阵动态调整实例语义特征，然后和类别几何特征进行融合。步骤6，将所述类别融合特征送入到变形网络得到变形场，利用所述变形场对类别先验变形得到实例NOCS模型。步骤7，通过匹配网络将所述实例NOCS模型和观测点云进行匹配，并根据相似性计算得到目标物体的6D位姿和大小。如图5所示，其中目标物体外的两组框线一组为真值，另一组为预测结果。与SPD方法相比，可以看出本实施方式的方法估计的位姿更加的准确，特别是相机这种形状变化比较大的类别，本实施方式的方法的估计结果要比SPD方法的估计结果好很多，这也证明了本实施方式的方法能够很好的处理类内形状变化问题。不难发现，本发明利用物体实例和类别先验之间的结构差异去增强类内形状信息的学习，进一步通过语义动态融合模块根据物体实例和类别先验的几何关系动态调整语义信息，之后和增强的类别先验融合去动态补充几何信息的缺失，以提高对噪声的鲁棒性。
