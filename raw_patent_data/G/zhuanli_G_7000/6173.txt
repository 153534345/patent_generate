标题title
一种基于模态分解的重叠峰提取的方法及装置
摘要abst
本发明公开一种基于模态分解的重叠峰提取的方法及装置，其包括：根据类间方差函数表示得到求峰值的问题公式，使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题；将无约束极值问题进行二次优化，转化为最小化问题公式；根据最小化问题公式，设置收敛条件，对其中的3个变量进行更新，直到满足预设的收敛条件时，停止迭代；停止迭代时，最终的计算结果即为两个光谱轴向响应信号的峰值。本发明采用上述方案，可以在多个峰值具有重叠区域时分离它们，准确的提取出峰值波长，从而解决测量透明薄板中，重叠峰难以提取的问题。
权利要求书clms
1.一种基于模态分解的重叠峰提取的方法，用于在测量玻璃基板的厚度过程中提取两个光谱轴向响应信号sARS的峰值，其特征在于：包括：根据类间方差函数表示得到求峰值的问题公式，该问题公式含有2个变量和1个约束条件；使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题；将无约束极值问题进行二次优化，转化为等效最小化问题，该最小化问题公式含有3个变量；根据最小化问题公式，设置收敛条件，对其中的3个变量进行更新，直到满足预设的收敛条件时，停止迭代；停止迭代时，最终的计算结果即为两个光谱轴向响应信号的峰值。2.根据权利要求1所述的基于模态分解的重叠峰提取的方法，其特征在于：该基于模态分解的重叠峰提取的方法具体包括：步骤1：根据类间方差函数表示法，将求峰值的问题表示为：其中为两个模态，/＞光强序列中的波长，/＞为去噪后的光强序列，/＞为峰值波长，/＞和分别是光谱仪的最小和最大检测波长；约束条件表示为：步骤2：使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题：其中，为半峰全宽，/＞为拉格朗日乘子；步骤3：为了避免函数的严格凸假设，增加迭代过程的鲁棒性，将步骤2的无约束极值问题进行二次优化，转化为如下等效的最小化问题：其中，为迭代的次数；步骤4：步骤3的最小化问题的解为：步骤5：使用质心算法更新峰值波长：步骤6：拉格朗日乘子根据以下公式更新：其中，为噪声容量参数，根据数据包含的噪声多少来确定大小；步骤7：设置收敛条件：其中为给定的误差，给定允许误差优选为10e-4；步骤8：重复步骤步骤4、步骤5和步骤6从而更新模态、中心波长/＞和拉格朗日乘数/＞，直到满足步骤7中的收敛条件时，停止迭代；停止迭代时，最终的/＞和/＞的计算结果即为两个光谱轴向响应信号的峰值。3.根据权利要求2所述的基于模态分解的重叠峰提取的方法，其特征在于：所述步骤1在根据类间方差函数表示得到求峰值的问题之前，还包括如下过程：采集光谱共焦位移传感器的光谱共焦信号，执行扣除暗电流处理，再将光强做归一化处理，获得点波长序列对应光强序列。4.根据权利要求1所述的基于模态分解的重叠峰提取的方法，其特征在于：所述步骤1在根据类间方差函数表示得到求峰值的问题之前，还包括如下过程：用最小二乘法对原始光强序列进行滑动拟合，并求出卷积系数；用卷积系数对原始光强序列 进行卷积计算，完成sg滤波，得到去噪后的光强序列/＞。5.一种基于模态分解的重叠峰提取的装置，其特征在于：执行权利要求1-4任一所述的基于模态分解的重叠峰提取的方法，该装置包括：求峰值问题公式获得模块，用于根据类间方差函数表示得到求峰值的问题公式，该问题公式含有2个变量和1个约束条件；无约束极值问题公式获得模块，用于使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题；最小化问题公式获得模块，用于将无约束极值问题进行二次优化，转化为等效最小化问题公式，该最小化问题公式含有3个变量；计算模块，用于根据最小化问题公式，设置收敛条件，对其中的3个变量进行更新，直到满足预设的收敛条件时，停止迭代；停止迭代时，最终的计算结果即为两个光谱轴向响应信号的峰值。
说明书desc
技术领域本发明涉及光学测量技术领域，具体是一种基于模态分解的重叠峰提取的方法及装置。背景技术光谱共焦位移传感器是通过彩色激光光源发射出一束高密度宽光谱光，通过色散镜头后，在量程范围内形成不同波长的白光，每个波长对应一个距离值，测量光射到物体表面反射回来，只有满足共聚焦条件的光，可以通过小孔被光谱仪感测到。通过计算被感测到光的焦点的波长，换算获的距离值。由于其具有的高精度与非接触性，被广泛的应用于测量玻璃基板的厚度。在测量玻璃基板的厚度过程中准确的提取光谱轴向响应信号的峰值起着至关重要的作用。目前有多种针对sARS的峰值位置定位技术，如经典的质心法和基于模型的拟合算法：高斯拟合算法、二项式拟合算法。然而，这些技术都是对一个单独的光谱轴向响应信号进行提取峰值。当被测物体为玻璃基板时，白光在玻璃上表面反射回来一次，在玻璃下表面再反射回来一次，将得到两个光谱轴向响应信号。当玻璃基板较厚时，两个光谱轴向响应信号将会是相互独立分布，如图1所示为归一化后的玻璃基板原始光强。此时使用上述技术，分别对两个光谱轴向响应信号进行峰值提取，还是可以较为准确的得到两个峰值。而当玻璃基板较薄时，两个光谱轴向响应信号会相互干扰，形成重叠区域，如图2所示为滤波后的玻璃基板光强。此时，没有波双边数据点的支持，上述技术提取的重叠峰值将会产生极大的误差。发明内容在下文中给出了关于本发明实施例的简要概述，以便提供关于本发明的某些方面的基本理解。应当理解，以下概述并不是关于本发明的穷举性概述。它并不是意图确定本发明的关键或重要部分，也不是意图限定本发明的范围。其目的仅仅是以简化的形式给出某些概念，以此作为稍后论述的更详细描述的前序。为解决上述技术问题，本发明提供一种基于模态分解的重叠峰提取的方法，使用模态分解技术，将两个光谱轴向响应信号从原始光强中分解出来，迭代求解出两个光谱轴向响应信号的峰值，提高寻峰准确性。具体的，根据本申请的一方面，提供一种基于模态分解的重叠峰提取的方法，用于在测量玻璃基板的厚度过程中提取两个光谱轴向响应信号sARS的峰值，包括：根据类间方差函数表示得到求峰值的问题公式，该问题公式含有2个变量和1个约束条件；使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题公式；将无约束极值问题进行二次优化，转化为等效最小化问题公式，该最小化问题公式含有3个变量；根据最小化问题公式，设置收敛条件，对其中的3个变量进行更新，直到满足预设的收敛条件时，停止迭代；停止迭代时，最终的计算结果即为两个光谱轴向响应信号的峰值。进一步的，该基于模态分解的重叠峰提取的方法具体包括：步骤1：根据类间方差函数表示法，将求峰值的问题表示为：其中为两个模态，/＞光强序列中的波长，/＞为峰值波长，/＞和/＞分别是光谱仪的最小和最大检测波长；约束条件表示为：步骤2：使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题：其中，为半峰全宽，/＞为拉格朗日乘子；步骤3：为了避免函数的严格凸假设，增加迭代过程的鲁棒性，将步骤2的无约束极值问题进行二次优化，转化为如下等效的最小化问题：其中，为迭代的次数；步骤4：步骤3的最小化问题的解为：步骤5：使用质心算法更新峰值波长：步骤6：拉格朗日乘子根据以下公式更新：其中，为噪声容量参数，根据数据包含的噪声多少来确定大小；步骤7：设置收敛条件：其中为给定的误差，给定允许误差优选为10e-4；步骤8：公式4为寻峰方程，公式5、6、7分别为变量、/＞和/＞的更新公式，公式8为收敛条件，重复步骤步骤4、步骤5和步骤6从而更新模态/＞、中心波长/＞和拉格朗日乘数/＞，直到满足步骤7中的收敛条件时，停止迭代；停止迭代时，最终的/＞和/＞的计算结果即为两个光谱轴向响应信号的峰值。为提高寻峰准确性，本发明创新的将图像处理领域的“类间方差函数”用于表示求峰值，并在求峰值的过程中，同时使用二次惩罚项和拉格朗日乘子，以使问题不受约束。其中，二次惩罚项是鼓励重建保真度的经典方法，拉格朗日乘子是严格执行约束的常用方法，在有限权重下二次惩罚有良好收敛，拉格朗日乘数会对约束做严格执行，因此步骤2中采用二次惩罚项和拉格朗日乘子这两个项的组合会取得更好的效果。此外，在实际求解时，步骤3的最小化问题的解是比较困难的，本发明人致力于研究该最小化问题的算法，才最终得到步骤4的解。优选的，所述步骤1在根据类间方差函数表示得到求峰值的问题之前，还包括如下过程：采集光谱共焦位移传感器的光谱共焦信号，执行扣除暗电流处理，再将光强做归一化处理，获得点波长序列对应光强序列。进一步的，所述步骤1在根据类间方差函数表示得到求峰值的问题之前，还包括如下过程：用最小二乘法对原始光强序列进行滑动拟合，并求出卷积系数。用卷积系数对原始光强序列进行卷积计算，完成sg滤波，得到去噪后的光强序列/＞。根据本申请的另一方面，还提供一种基于模态分解的重叠峰提取的装置，其执行上述基于模态分解的重叠峰提取的方法，该装置包括：求峰值问题公式获得模块，用于根据类间方差函数表示得到求峰值的问题公式，该问题公式含有2个变量和1个约束条件；无约束极值问题公式获得模块，用于使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题；最小化问题公式获得模块，用于将无约束极值问题进行二次优化，转化为等效最小化问题公式，该最小化问题公式含有3个变量；计算模块，用于根据最小化问题公式，设置收敛条件，对其中的3个变量进行更新，直到满足预设的收敛条件时，停止迭代；停止迭代时，最终的计算结果即为两个光谱轴向响应信号的峰值。针对现有技术的以上缺陷或改进需求，本发明提出了一种自适应模态分解方法，可以在多个峰值具有重叠区域时分离它们，准确的提取出峰值波长，从而解决测量透明薄板中，重叠峰难以提取的问题。在图像处理领域，最大类间方差法可以很好的对直方图为双峰的图片进行阈值分割，其中类间方差表征的正是阈值两侧的数据的离散程度，类间方差越大，说明前景和背景相差越大，二值化效果越佳，因此本发明引入最大类间方差法来寻找重叠区域的峰值。此外，通过模态分解、迭代求解峰值，可以更精准得提取出测量薄玻璃时的两个峰值波长，因此，本发明的模态分解方法显示了准确性的优势，特别是当多个峰具有重叠区域时，拥有更强的寻峰准确性。附图说明本发明可以通过参考下文中结合附图所给出的描述而得到更好的理解，其中在所有附图中使用了相同或相似的附图标记来表示相同或者相似的部件。所述附图连同下面的详细说明一起包含在本说明书中并且形成本说明书的一部分，而且用来进一步举例说明本发明的优选实施例和解释本发明的原理和优点。在附图中：图1为归一化后的未滤波的玻璃基板原始光强；图2为滤波后的玻璃基板光强；图3为本发明实施例的重叠峰提取的方法的迭代过程示意图；图4为本发明实施例的重叠峰提取的方法的实验结果示意图。具体实施方式下面将参照附图来说明本发明的实施例。在本发明的一个附图或一种实施方式中描述的元素和特征可以与一个或更多个其它附图或实施方式中示出的元素和特征相结合。应当注意，为了清楚的目的，附图和说明中省略了与本发明无关的、本领域普通技术人员已知的部件和处理的表示和描述。现技术方案多为：使用线性拟合算法或非线性拟合算法分别提取重叠峰的两个峰值。当透明薄板比较薄时，两个亚反射强度分布不再相互独立分布，使用单独的寻峰算法，无法避免两个亚反射强度相互干扰，使得寻峰准确性较差。本发明使用模态分解技术，将两个光谱轴向响应信号从原始光强中分解出来，迭代求解出两个光谱轴向响应信号的峰值，提高寻峰准确性。本发明的基于模态分解的重叠峰提取的方法，可以在多个峰值具有重叠区域时分离它们，准确的提取出峰值波长。解决测量透明薄板中，重叠峰难以提取的问题。该方法显示了准确性的优势，尤其适用于多个峰具有重叠区域时。具体的，参见图3的流程图，本发明的基于模态分解的重叠峰提取的方法包括以下步骤：STEP1：采集光谱共焦位移传感器的光谱共焦信号，执行扣除暗电流处理，再将光强做归一化处理，获得点波长序列对应光强序列;STEP2：用最小二乘法对原始光强序列进行滑动拟合，并求出卷积系数。用卷积系数对原始光强序列进行卷积计算，完成sg滤波，得到去噪后的光强序列/＞。此步骤目的在于：消除数据中的噪声。滤波操作非本发明的重点，也可以使用其他滤波器去噪，如中值滤波等。STEP3：在图像处理领域，最大类间方差法可以很好的对直方图为双峰的图片进行阈值分割，其中类间方差表征的正是阈值两侧的数据的离散程度，类间方差越大，说明前景和背景相差越大，二值化效果越佳。本发明引入最大类间方差法，来寻找重叠区域的峰值。根据类间方差函数表示法，将求峰值的问题表示为：；其中为两个模态，/＞光强序列中的波长，/＞为峰值波长，/＞和/＞分别是光谱仪的最小和最大检测波长。约束条件可以表示为：；STEP4：此时，方程转换成了有约束的优化问题。使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题：其中，为半峰全宽，/＞为拉格朗日乘子。STEP5：为了避免函数的严格凸假设，增加迭代过程的鲁棒性，转化为如下等效的最小化问题：；其中，为迭代的次数。STEP6：这个二次优化问题的解为：；STEP7：使用质心算法更新峰值波长，当然也可以使用其他非线性算法来更新峰值波长/＞：；STEP8：拉格朗日乘子根据以下公式更新：；其中，为噪声容量参数，可以根据数据包含的噪声多少，适当选择大小。STEP9：设置收敛条件：；其中为给定的误差，给定允许误差优选为10e-4，由于无法避免噪声的干扰，所以误差不能设为0，而再小于上述给定误差时，在迭代计算中，噪声将融入波长计算中，对数据准确性造成影响。STEP10：至此在步骤STEP5中得到寻峰方程，在骤STEP6、STEP7和STEP8中得到了三个变量更新的公式，在STEP9中得到了收敛条件。重复步骤STEP6、STEP7和STEP8，更新模态、中心波长/＞和拉格朗日乘数/＞，当满足STEP9中的收敛条件时，停止迭代。停止迭代时，最终的/＞和/＞计算结果即为两个光谱轴向响应信号的峰值。上述过程中，还可分别对两个光谱轴向响应信号的峰值使用质心法或高斯拟合法寻找波峰。本发明通过上述方案，其在STEP3中使用最大类间方差函数，表示求解峰值的表示公式，在STEP4中使用增广拉格朗日乘数法求解峰值的表示公式；并分别在STEP6、STEP7和STEP8设计了三个参数的更新公式，结合STEP9中的收敛条件的设定公式，最终获得两个光谱轴向响应信号的峰值。如图4所示，在仿真实验中：使用高斯拟合直接计算两个光谱轴向响应信号的峰值，与真实的峰值偏差较大，而本发明提出的模态分解方法更接近真实值，拥有更强的寻峰准确性。本发明实施例还提供一种基于模态分解的重叠峰提取的装置，其执行上述基于模态分解的重叠峰提取的方法，该装置包括：求峰值问题公式获得模块，用于根据类间方差函数表示得到求峰值的问题公式，该问题公式含有2个变量和1个约束条件；无约束极值问题公式获得模块，用于使用增广拉格朗日乘数法，给函数加上惩罚项和拉格朗日乘子，将含有2个变量和1个约束条件的最优化问题转化为一个含有3个变量的无约束极值问题；最小化问题公式获得模块，用于将无约束极值问题进行二次优化，转化为等效最小化问题公式，该最小化问题公式含有3个变量；计算模块，用于根据最小化问题公式，设置收敛条件，对其中的3个变量进行更新，直到满足预设的收敛条件时，停止迭代；停止迭代时，最终的计算结果即为两个光谱轴向响应信号的峰值。此外，本发明的方法不限于按照说明书中描述的时间顺序来执行，也可以按照其他的时间顺序地、并行地或独立地执行。因此，本说明书中描述的方法的执行顺序不对本发明的技术范围构成限制。尽管上面已经通过对本发明的具体实施例的描述对本发明进行了披露，但是，应该理解，上述的所有实施例和示例均是示例性的，而非限制性的。本领域的技术人员可在所附权利要求的精神和范围内设计对本发明的各种修改、改进或者等同物。这些修改、改进或者等同物也应当被认为包括在本发明的保护范围内。
