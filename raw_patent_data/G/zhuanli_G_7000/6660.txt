标题title
一种转码服务的检测方法、装置、电子设备及存储介质
摘要abst
本公开提供一种转码服务的检测方法、装置、电子设备及存储介质，所述方法包括：响应于转码服务检测操作，对原始视频进行分析，获取原始视频的媒资信息；从媒体库中获取转码后视频的媒资信息；对比原始视频和转码后视频的媒资信息得到对比结果，对比结果一致时，从云存储服务器中读取原始视频和转码后视频；确定原始视频和转码后视频的相似度，根据相似度确定转码服务是否正常。利用本公开提供的方法，能够在转码服务完成转码操作后，通过拉取原始视频及转码后视频对媒资信息及视频帧中图像特征进行分析，能够判断所述转码后视频的转码正确性，通过转码正确性确定转码服务是否正常，把转码服务的问题暴露前置，避免视频在点播时出现播放问题。
权利要求书clms
1.一种转码服务的检测方法，其特征在于，所述方法包括：响应于转码服务检测操作，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息；从媒体库中获取转码后视频的媒资信息，所述转码后视频是通过所述转码服务对所述原始视频转码后得到的视频；对比所述原始视频和所述转码后视频的媒资信息得到对比结果，确定所述对比结果一致时，从所述云存储服务器中读取所述原始视频和所述转码后视频；确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常。2.根据权利要求1所述的方法，其特征在于，所述响应于转码服务检测操作，包括：每间隔预定时间，对所述转码服务进行检测；或响应于所述转码服务完成所述原始视频转码操作的通知，对所述转码服务进行检测。3.根据权利要求1所述的方法，其特征在于，所述确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常，包括：从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧；获取所述视频帧中的图像特征，根据所述图像特征确定所述原始视频和所述转码后视频的相似度，并根据所述相似度确定所述转码后视频是否转码成功；根据所述转码后视频是否转码成功确定所述转码服务是否正常。4.根据权利要求1所述的方法，其特征在于，从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧步骤之前，还包括执行如下至少一个步骤：从所述转码后视频中抽取N个视频帧，所述N个视频帧中内容相同的视频帧数量与N的比值大于设定阈值时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述N为大于1的正整数；从所述转码后视频中抽取M个视频帧，检测指定颜色的像素点在各视频帧中的占比是否大于像素比例阈值，若检测到大于所述像素比例阈值的视频帧时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述M为大于等于1的正整数。5.根据权利要求4所述的方法，其特征在于，从所述转码后视频中抽取N个视频帧，包括：随机从所述转码后视频中抽取时间间隔大于第一时间阈值的N个视频帧；或从所述转码后视频中抽取时间间隔小于第二时间阈值的N个关键帧所述第一时间阈值大于所述第二时间阈值。6.根据权利要求3所述的方法，其特征在于，所述根据所述图像特征确定所述原始视频和所述转码后视频的相似度，包括：对所述相同时间位置的视频帧的图像特征，计算所述原始视频和所述转码后视频的相似度参数，确定所述原始视频和所述转码后视频的相似度，所述相似度参数包括直方图参数、汉明距离参数、余弦距离参数以及图像接轨度量参数中的至少一种；或者将所述相同时间位置的视频帧输入到相似度确定模型中，确定所述原始视频和所述转码后视频的相似度。7.根据权利要求6所述的方法，其特征在于，所述将所述相同时间位置的视频帧输入到所述相似度确定模型之前，还包括：获取多个训练样本，所述训练样本包括原始参考视频、转码后参考视频及视频相似度，所述转码后参考视频是通过所述转码服务对所述原始参考视频转码后得到的视频；将训练样本中的所述原始参考视频、所述转码后参考视频作为输入特征输入到训练模型，将所述训练模型得到的所述原始参考视频和所述转码后参考视频的相似度和所述训练样本中的所述视频相似度进行比对，根据比对结果调整所述训练模型的模型参数，得到所述相似度确定模型。8.一种转码服务的检测装置，其特征在于，所述装置包括如下模块：原始视频媒资信息获取模块，用于响应于转码服务检测操作，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息；转码后视频媒资信息获取模块，用于从媒体库中获取转码后视频的媒资信息，所述转码后视频是通过所述转码服务对所述原始视频转码后得到的视频；媒资信息对比模块，用于对比所述原始视频和所述转码后视频的媒资信息得到对比结果，确定所述对比结果一致时，从所述云存储服务器中读取所述原始视频和所述转码后视频；转码服务检测模块，用于确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常。9.一种转码服务的检测电子设备，其特征在于，包括：存储器和处理器；其中，所述存储器用于存储计算机程序；所述处理器用于执行所述存储器中的程序，实现如权利要求1～7任一所述的方法。10.一种计算机存储介质，其特征在于，其上存储有计算机程序，该程序被处理器执行时实现如权利要求1～7任一所述的方法。
说明书desc
技术领域本公开涉及视频转码检测领域，特别涉及一种转码服务的检测方法、装置、电子设备及存储介质。背景技术在互联网发展的现代，短视频平台的应用越来越广泛，短视频平台系统主要提供视频的上传、转码、存储、分发，实现通过网络面向不同的客户端提供相应的短视频服务，在向不同的客户端提供相应的短视频服务时，由于不同客户端的播放能力不同，同时为了节省网络带宽，因此在客户端上传视频后，需要对上传的视频进行转码，以满足不同播放能力的客户端需求。目前转码的趋势是将原始视频文件由H.264视频编码标准逐渐向H.265视频转码标准进行转换，由于视频转码的标准升级，对于原始视频的转码过程也变得复杂，并且在转码时所产生的播放问题也逐渐增多，目前转码后的视频文件时常存在着视频转码异常、转码后视频无法正常播放以及产生转码后视频存在花屏等情况。目前对于上述情况，仅在客户端下载文件后播放时，在无法播放时确定转码出现问题，服务端转码完毕后并不能确定是否出现转码问题，进而确定转码服务是否存在问题，而当在客户端在播放视频时出现转码问题时，会影响客户端的正常视频播放，降低了视频观看体验，因此，转码服务是否正常需要在服务端进行预先检测，以避免客户端获取的转码后视频产生上述播放问题。发明内容本公开提供一种转码服务的检测方法、装置、电子设备及存储介质，用于解决原始视频在进行转码得到转码后视频的过程中，不能及时检测发现转码服务是否正常的问题。本公开的第一方面提供一种转码服务的检测方法，所述方法包括：响应于转码服务检测操作，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息；从媒体库中获取转码后视频的媒资信息，所述转码后视频是通过所述转码服务对所述原始视频转码后得到的视频；对比所述原始视频和所述转码后视频的媒资信息得到对比结果，确定所述对比结果一致时，从所述云存储服务器中读取所述原始视频和所述转码后视频；确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常。可选地，所述响应于转码服务检测操作，包括：每间隔预定时间，对所述转码服务进行检测；或响应于所述转码服务完成所述原始视频转码操作的通知，对所述转码服务进行检测。可选地，所述确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常，包括：从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧；获取所述视频帧中的图像特征，根据所述图像特征确定所述原始视频和所述转码后视频的相似度，并根据所述相似度确定所述转码后视频是否转码成功；根据所述转码后视频是否转码成功确定所述转码服务是否正常。可选地，从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧步骤之前，还包括执行如下至少一个步骤：从所述转码后视频中抽取N个视频帧，所述N个视频帧中内容相同的视频帧数量与N的比值大于设定阈值时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述N为大于1的正整数；从所述转码后视频中抽取M个视频帧，检测指定颜色的像素点在各视频帧中的占比是否大于像素比例阈值，若检测到大于所述像素比例阈值的视频帧时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述M为大于等于1的正整数。可选地，从所述转码后视频中抽取N个视频帧，包括：随机从所述转码后视频中抽取时间间隔大于第一时间阈值的N个视频帧；或从所述转码后视频中抽取时间间隔小于第二时间阈值的N个关键帧所述第一时间阈值大于所述第二时间阈值。可选地，所述根据所述图像特征确定所述原始视频和所述转码后视频的相似度，包括：对所述相同时间位置的视频帧的图像特征，计算所述原始视频和所述转码后视频的相似度参数，确定所述原始视频和所述转码后视频的相似度，所述相似度参数包括直方图参数、汉明距离参数、余弦距离参数以及图像接轨度量参数中的至少一种；或者将所述相同时间位置的视频帧输入到相似度确定模型中，确定所述原始视频和所述转码后视频的相似度。可选地，所述将所述相同时间位置的视频帧输入到所述相似度确定模型之前，还包括：获取多个训练样本，所述训练样本包括原始参考视频、转码后参考视频及视频相似度，所述转码后参考视频是通过所述转码服务对所述原始参考视频转码后得到的视频；将训练样本中的所述原始参考视频、所述转码后参考视频作为输入特征输入到训练模型，将所述训练模型得到的所述原始参考视频、所述转码后参考视频的相似度和所述训练样本中的所述视频相似度进行比对，根据比对结果调整所述训练模型的模型参数，得到所述相似度确定模型。可选地，所述媒资信息包括如下至少一种信息：视频文件唯一标识、视频文件大小、视频分辨率、视频码率、视频帧率以及视频内音频码率。可选地，所述从所述云存储服务器中读取所述原始视频和所述转码后视频步骤之前，还包括：获取所述原始视频的视频统一资源定位符及所述转码后视频的视频统一资源定位符。可选地，所述从所述云存储服务器中读取所述原始视频和所述转码后视频，包括：根据所述原始视频的视频统一资源定位符，通过云存储服务调用点播云API从所述云存储服务器中读取所述原始视频；根据所述转码后视频的视频统一资源定位符，通过所述云存储服务调用所述点播云API从所述云存储服务器中下载到内容分发网络，从所述内容分发网络读取所述转码后视频。本公开的第二方面提供了一种转码服务的检测装置，所述装置包括如下模块：原始视频媒资信息获取模块，用于响应于转码服务检测操作，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息；转码后视频媒资信息获取模块，用于从媒体库中获取转码后视频的媒资信息，所述转码后视频是通过所述转码服务对所述原始视频转码后得到的视频；媒资信息对比模块，用于对比所述原始视频和所述转码后视频的媒资信息得到对比结果，确定所述对比结果一致时，从所述云存储服务器中读取所述原始视频和所述转码后视频；转码服务检测模块，用于确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常。可选地，原始视频媒资信息获取模块用于响应于转码服务检测操作，包括：每间隔预定时间，对所述转码服务进行检测；或响应于所述转码服务完成所述原始视频转码操作的通知，对所述转码服务进行检测。可选地，转码服务检测模块用于确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常，包括：从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧；获取所述视频帧中的图像特征，根据所述图像特征确定所述原始视频和所述转码后视频的相似度，并根据所述相似度确定所述转码后视频是否转码成功；根据所述转码后视频是否转码成功确定所述转码服务是否正常。可选地，转码服务检测模块用于从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧步骤之前，还包括执行如下至少一个步骤：从所述转码后视频中抽取N个视频帧，所述N个视频帧中内容相同的视频帧数量与N的比值大于设定阈值时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述N为大于1的正整数；从所述转码后视频中抽取M个视频帧，检测指定颜色的像素点在各视频帧中的占比是否大于像素比例阈值，若检测到大于所述像素比例阈值的视频帧时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述M为大于等于1的正整数。可选地，转码服务检测模块用于从所述转码后视频中抽取N个视频帧，包括：随机从所述转码后视频中抽取时间间隔大于第一时间阈值的N个视频帧；或从所述转码后视频中抽取时间间隔小于第二时间阈值的N个关键帧所述所第一时间阈值大于所述第二时间阈值。可选地，转码服务检测模块用于根据所述图像特征确定所述原始视频和所述转码后视频的相似度，包括：对所述相同时间位置的视频帧的图像特征，计算所述原始视频和所述转码后视频的相似度参数，确定所述原始视频和所述转码后视频的相似度，所述相似度参数包括直方图参数、汉明距离参数、余弦距离参数以及图像接轨度量参数中的至少一种；或者将所述相同时间位置的视频帧输入到相似度确定模型中，确定所述原始视频和所述转码后视频的相似度。可选地，转码服务检测模块用于将所述相同时间位置的视频帧输入到所述相似度确定模型之前，还包括：获取多个训练样本，所述训练样本包括原始参考视频、转码后参考视频及视频相似度，所述转码后参考视频是通过所述转码服务对所述原始参考视频转码后得到的视频；将训练样本中的所述原始参考视频、所述转码后参考视频作为输入特征输入到训练模型，将所述训练模型得到的所述原始参考视频和所述转码后参考视频的相似度和所述训练样本中的所述视频相似度进行比对，根据比对结果调整所述训练模型的模型参数，得到所述相似度确定模型。可选地，所述媒资信息包括如下至少一种信息：视频文件唯一标识、视频文件大小、视频分辨率、视频码率、视频帧率以及视频内音频码率。可选地，媒资信息对比模块从所述云存储服务器中读取所述原始视频和所述转码后视频步骤之前，还包括：获取所述原始视频的视频统一资源定位符及所述转码后视频的视频统一资源定位符。可选地，媒资信息对比模块从所述云存储服务器中读取所述原始视频和所述转码后视频，包括：根据所述原始视频的视频统一资源定位符，通过云存储服务调用点播云API从所述云存储服务器中读取所述原始视频；根据所述转码后视频的视频统一资源定位符，通过所述云存储服务调用所述点播云API从所述云存储服务器中下载到内容分发网络，从所述内容分发网络读取所述转码后视频。本公开的第三方面提供了一种转码服务的检测电子设备，所述电子设备包括处理器和存储器，所述存储器中存储有计算机程序，所述处理器用于执行所述存储器中的计算机程序，用于执行本公开第一方面所述的一种转码服务的检测方法。本公开的第四方面提供了一种计算机程序介质，所述计算机可读存储介质存储有计算机指令，所述计算机指令被处理器执行时实现本公开第一方面所述的一种转码服务的检测方法。利用本公开提供的一种转码服务的检测方法、装置、电子设备及存储介质，具有以下有益效果：在转码服务完成转码操作后，通过拉取转码后视频及原始视频对所述转码后视频及所述原始视频的媒资信息及视频帧中图像特征进行分析，能够判断所述转码后视频的转码正确性，通过所述转码后视频的转码正确性确定转码服务是否正常，把转码服务的问题暴露前置，避免转码后视频在播放时出现播放问题。附图说明为了更清楚地说明本公开实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本公开实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图获得其他的附图。图1为一种视频上传、转码、预热、点播系统示意图；图2为一种视频上传、转码、预热、点播系统交互流程示意图；图3为一种转码服务的检测方法的流程图；图4为一种转码服务的检测方法的完整流程图；图5为一种转码服务的检测装置的模块示意图；图6为一种转码服务的检测电子设备的示意图。具体实施方式为使本公开实施例的目的、技术方案和优点更加清楚，为使本公开实施例的目的、技术方案和优点更加清楚，下面将结合本公开实施例中的附图，对本公开实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本公开一部分实施例，而不是全部的实施例。基于本公开中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本公开保护的范围。下面结合说明书附图对本公开实施例作进一步详细描述。应当理解，此处所描述的实施例仅用于说明和解释本公开，并不用于限定本公开。为了方便理解，下面对本公开实施例中涉及的名词进行解释：1)机器学习是一门多领域交叉学科，涉及概率论、统计学、逼近论、凸分析、算法复杂度理论等多门学科；专门研究计算机怎样模拟或实现人类的学习行为，以获取新的知识或技能，重新组织已有的知识结构使之不断改善自身的性能；机器学习是人工智能的核心，是使计算机具有智能的根本途径，其应用遍及人工智能的各个领域；机器学习通常包括人工神经网络、置信网络、强化学习、迁移学习、归纳学习、示教学习等技术。2)视频编码，视频编码是根据一个或多个视频编码标准来执行的，又称视频转码。例如，视频编码标准包括多功能视频编码、联合勘探测试模型、高效率视频编码、高级视频编码、运动图像专家组编码等。视频编码通常利用视频图像或视频序列中存在冗余的预测方法，例如，帧间预测、帧内预测等。视频编码技术的一个重要目标是将视频数据压缩为使用较低比特率的形式，同时避免或最小化对视频质量的下降。3)SDK，是一些被软件工程师用于为特定的软件包、软件框架、硬件平台、操作系统等创建应用软件的开发工具的集合，一般而言SDK即开发Windows平台下的应用程序所使用的SDK。它可以简单的为某个程序设计语言提供应用程序接口API的一些文件，但也可能包括能与某种嵌入式系统通讯的复杂的硬件。一般的工具包括用于调试和其他用途的实用工具。SDK还经常包括示例代码、支持性的技术注解或者其他的为基本参考资料澄清疑点的支持文档。参见图1，图1为一种视频上传、转码、预热、点播系统示意图，如图所示该系统包括：视频上传终端101、分发网关102、业务服务器103、点播云转码服务器104、CDN分发服务器105，视频点播终端106。其中，在点播云转码服务器104侧，点播云转码服务器104接收由分发网关102发送的原始视频，点播云转码服务器104中的MediaLiray媒体库服务用于存储原始视频，并由点播云转码服务器104中的转码服务将原始视频进行转码，通过转码服务在得到转码后视频后，把转码后视频发送到CDN分发服务器105中。在CDN分发服务器105侧，CDN分发服务器105接收由点播云中的转码服务器104发送的转码后视频，并将转码后视频发送到一组Blobstore前端的服务器中，前端服务器解析后会给该视频一个特定的写入地址，接下来将其转发到具体的服务器进行实际的数据存储。可以把这些存储服务器称之为存储节点，把原始视频和转码后视频媒资信息存储到一个磁盘上，然后通知数据存储；当CDN分发服务器105接收到由视频点播终端106发送的视频预热/点播指令时，CDN分发服务器105根据对应转码后视频的存储地址，在数据存储库中进行检索，将转码后视频发送到视频点播终端106用于终端的缓存和播放。具体的，在视频上传、转码、预热、点播的各部分，又包括如下交互步骤：在原始视频上传、转码、预热、点播的流程步骤，如图2所示：原始视频上传部分：步骤S201，视频上传终端101通知业务服务器103发送原始视频通知；步骤S202，业务服务器103调用证书服务，生成本次上传的证书，并将证书返回分发网关102的IP/PORT列表；步骤S203，视频上传终端101通过软件开发工具包SDK，将原始视频发送到分发网关102中；步骤S204，分发网关102接收原始视频，并通过证书服务比对本次上传的证书，以确定原始视频的合法性；步骤S205，分发网关102携带本次上传的证书和原始视频，向点播云转码服务器104上传原始视频；步骤S206，通过本次上传的证书中的描述文件确定原始视频的存储位置。调用API接口，将原始视频写入点播云转码服务器104，步骤S207，分发网关102接收到原始视频上传完成的消息，将上传完成的消息发送到业务服务器103，业务服务器103获取原始视频的下载地址；原始视频转码部分：步骤S208，业务服务器103根据转码队列将转码任务提交给点播云转码服务器104；步骤S209，点播云转码服务器104根据转码成功/失败的消息发送到业务服务器103；转码后视频预热播放部分：步骤S210，将预热请求发送到预热队列，业务服务器103读取预热队列执行预热任务，所述预热为针对域名对应的文件和目录，进行刷新和预热操作，主动把转码后视频内容缓存到播放节点，以获得更好的播放体验；步骤S211，通过调用媒体库MediaLiray，对转码后视频进行预热，媒体库MediaLiray通过API接口通知预热内容分发网络；步骤S212，CDN分发服务器105中的内容分发网络调用API获取文件的媒资信息，并将转码后视频缓存到视频点播终端106；转码后视频播放部分：步骤S213，视频点播终端106向业务服务器103发送播放请求，获取转码后视频对应的播放串；步骤S214，业务服务器103从媒体库中获取转码后视频的媒资信息以及内容分发网络的对应地址，以确定转码后视频的统一资源定位符URL，将统一资源定位符URL发送到视频点播终端106；步骤S215，视频点播终端106根据统一资源定位符URL，从CDN分发服务器105对转码后视频进行播放或下载。上述各服务器将原始视频上传完成、原始视频转码完成及播放请求发送到业务服务器103，可以通过kafka消息队列向业务服务器103发送各类消息，kafka是一种高吞吐量的分布式发布订阅消息系统，它可以处理消费者在网站中的所有动作流数据，这些数据通常是由于吞吐量的要求而通过处理日志和日志聚合来解决，对于像Hadoop一样的日志数据和离线分析系统，但又要求实时处理的限制，kafka消息队列是一个可行的解决方案，其目的是通过Hadoop的并行加载机制来统一线上和离线的消息处理，也为了通过集群来提供实时的消息。本公开实施例涉及的终端可以是蜂窝电话、无绳电话、会话启动协议电话、无线本地环路站、个人数字处理、具有无线通信功能的手持设备、计算设备或连接到无线调制解调器的其它处理设备、车载设备、可穿戴设备以及5G网络中的移动台或者未来演进的公共陆地移动网络中的订阅设备，智能手机、平板电脑、各类可穿戴设备、车载设备等。其中接收的上传的原始视频的来源可以为，通过获取终端本地的视频或由终端内部的摄像设备、与终端连接的摄像设备或独立连接服务器的摄像设备，在线录制的视频，发送到点播云转码服务器中，所述视频的格式可以为如下任一种，包括：rm、rmvb、mtv、dat、wmv、avi、3gp、amv、dmv、flv。其中所述视频上传、转码、预热、点播的方式不限于上述的方法，在上述的视频转码过程中会出现视频转码失败且不能及时发现的问题，为了解决该问题，本公开提供一种转码服务的检测方法，能够在转码服务完成转码操作后，通过拉取转码后视频及原始视频对所述转码后视频及所述原始视频的媒资信息及视频帧中图像特征进行分析，能够判断所述转码后视频的转码正确性，通过所述转码后视频的转码正确性确定转码服务是否正常，把转码服务的问题暴露前置，避免视频在播放时出现播放问题。实施例1本公开提供一种转码服务的检测方法，所述方法应用于服务器侧，用于检测转码服务是否正常，如图3所示，本方法包括如下步骤：步骤S301，响应于转码服务检测操作，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息；从点播云转码服务器104的媒体库中获取原始视频的媒资信息，当媒体库接收到媒资信息获取指令时，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息，其中，媒资信息可以为视频文件唯一标识、视频文件大小、视频分辨率、视频码率、视频帧率以及视频内音频码率等，其中媒资信息不限于本实施例提供的上述类型信息，还应包括其他能表示视频具体内容的类型信息，本领域技术人员应当知晓，这里不再赘述。当在媒体库的ffmpeg组件中接收到ffprobe指令时，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息，所述ffprobe是ffmpeg的一个重要模块，可以用来查看文视频的各种媒资信息，ffprobe的英文含义为Simple multimedia streamsanalyzer。步骤S302，从媒体库中获取转码后视频的媒资信息，所述转码后视频是通过所述转码服务对所述原始视频转码后得到的视频；根据原始视频的媒资信息以及转码后视频的媒资信息进行比对，根据媒资信息的内容确定转码后视频是否转码成功，如，通过比对原始视频的媒资信息中的视频文件唯一标识与转码后视频的媒资信息中的视频唯一标识确定转码是否成功，以确定转码服务是否正常。步骤S303，对比所述原始视频和所述转码后视频的媒资信息得到对比结果，确定所述对比结果一致时，从所述云存储服务器中读取所述原始视频和所述转码后视频；当确定原始视频的媒资信息和转码后视频的媒资信息比对一致时，从所述云存储服务器中读取所述原始视频和所述转码后视频以确定所述原始视频和所述转码后视频的相似度。步骤S304，确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常。具体的，确定所述原始视频和所述转码后视频的相似度的方式包括：从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧；获取所述视频帧中的图像特征，根据所述图像特征确定所述原始视频和所述转码后视频的相似度，并根据所述相似度确定所述转码后视频是否转码成功；作为一种较优的实施方式，从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧之前，还包括：在需要所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧之前，对转码后视频进行预检测，检测项目包括：转码后视频是否存在无法播放的情况、转码后视频是否存在播放卡顿的情况、转码后视频是否存在花屏情况；预检测的步骤包括：从所述转码后视频中抽取N个视频帧，所述N个视频帧中内容相同的视频帧数量与N的比值大于设定阈值时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述N为大于1的正整数；作为一种可选的实施方式，从所述转码后视频中抽取N个视频帧，包括：随机从所述转码后视频中抽取时间间隔大于第一时间阈值的N个视频帧；或从所述转码后视频中抽取时间间隔小于第二时间阈值的N个关键帧所述第一时间阈值大于所述第二时间阈值。在需要判断转码后视频是否存在无法播放的情况，或大部分损坏的情况时，在转码后视频中随机抽取时间间隔大于第一时间阈值的N个视频帧，例如，在转码后视频中抽取5s、20s、40s…的视频帧，通过判断所述N个视频帧中内容相同的视频帧数量与N的比值大于设定阈值时，确定转码后视频转码失败；在需要判断转码后视频是否存在播放卡顿的情况，需要对视频中连续的小部分视频帧的相似占比进行检测，其中从转码后视频中抽取时间间隔小于第二时间阈值的N个关键帧，关键帧也叫作I帧，它是帧间压缩编码的最重要帧。视频的转码是按照“组”来进行的，每一个组叫作GOP。组之间是没有联系的，编码关系只在GOP之间产生。每一个GOP都是由关键帧开始的，关键帧是一幅完整的画面，GOP中间的帧都是不完整的，需要由关键帧、前面帧以及后面帧等一起运算得到。关键帧的间隔调节会影响GOP的长度，进而影响到读取GOP的速度，例如抽取第1s、第2s以及第3s…的关键帧，所述N个视频帧中内容相同的视频帧数量与的N比值大于设定阈值时大于设定阈值时，确定转码后视频转码失败。具体的，当需要检测转码后视频是否存在花屏情况时，从所述转码后视频中抽取M个视频帧，检测指定颜色的像素点在各视频帧中的占比是否大于像素比例阈值，若检测到大于所述像素比例阈值的视频帧时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述M为大于等于1的正整数，检测指定颜色的像素点在各视频帧中的占比是否大于像素比例阈值，至少包括如下步骤：检测白色像素点在视频帧中的占比大于像素比例阈值，所述白色像素点对应的RPG颜色通道分别为；检测黑色像素点在视频帧中的占比大于像素比例阈值，所述白色像素点对应的RPG颜色通道分别为；检测绿色像素点在视频帧中的占比大于像素比例阈值，所述白色像素点对应的RPG颜色通道分别为；当上述至少一种指定颜色的像素点在视频帧中的占比大于像素比例阈值时，确定转码后视频存在花屏情况，则确定转码后视频转码失败。其中上述指定像素点的颜色可以为上述R、G、B的任一组合方式，这里不做具体限定。具体的，确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常，包括：对原始视频和转码后视频的相似度进行加权求和，得到相同时间位置的视频帧的帧间相似度，具体的，对根据直方图参数计算的视频相似度、汉明距离参数计算的视频相似度、余弦距离参数计算的视频相似度以及图像接轨度量参数计算的视频相似度共同进行加权处理，根据各视频相似度对应的权重值，确定相同时间位置的视频帧的帧间相似度，根据帧间相似度确定原始视频和转码后视频的相似度，并根据所述相似度确定转码后视频是否转码成功；设定一视频的相似度阈值，当转码后视频的相似度大于阈值时，确定转码后视频转码成功，否则确定转码后视频转码失败；其中作为一种可选的实施方式，所述根据利用相似度算法计算的相似度参数，确定原始视频和转码后视频的相似度，包括：根据利用相似度算法计算的相似度参数，确定相同时间位置的视频帧的帧间相似度；在得到多个帧间相似度时，当各帧间相似度进行归一化处理，得到原始视频和转码后视频的相似度。具体的，对各帧间相似度进行归一化处理，得到原始视频和转码后视频的相似度，包括以下几种可选的实施方式：方式一、对各帧间相似度取平均值，进行归一化处理，得到原始视频和转码后视频的相似度，当转码后视频的相似度大于阈值时，确定转码后视频转码成功，否则确定转码后视频转码失败。方式二、将各帧间相似度与其对应的相似度阈值进行比较，当检测到由某帧间相似度小于阈值时，确定转码后视频转码失败，仅当所有帧间相似度都大于相似度阈值时，确定转码后视频转码成功。方式三、以分布图的形式确定原始视频和转码后视频的相似度，其中分布图的横坐标为不同时间位置对应的视频帧标识，分布图的纵坐标为帧间相似度，根据不同时间位置的帧间相似度与各帧间相似度的值建立帧间相似度曲线，当该曲线中绝大多数的视频帧标识点都大于帧间相似度阈值时，确定转码后视频转码成功，否则确定转码后视频转码失败。具体的，获取所述视频帧中的图像特征，计算所述原始视频和所述转码后视频的相似度参数，确定所述原始视频和所述转码后视频的相似度，所述相似度参数包括直方图参数、汉明距离参数、余弦距离参数以及图像接轨度量参数中的至少一种；其中，当获取的相似度参数为直方图参数时，根据该视频帧中的各像素点中像素的分布情况确定原始视频和转码后视频的相似度参数，本公开的直方图采用RGB颜色表示方式，红、绿、蓝表示三个颜色，而直方图参数又分别存在对应三种原色的直方图子参数，其中直方图的x轴是视频帧的某原色0～255之间的像素颜色，直方图的y轴指的是在0～255的各像素所占总像素数量的比例，根据原始视频和转码后视频中视频帧的直方图重合度，确定三种原色的直方图子参数，根据三种原色的直方图子参数确定直方图参数，通过直方图参数计算公式确定原始视频与转码后视频相似度。当获取的相似度参数为汉明距离参数时，通过图像哈希计算算法确定原始视频的视频帧的哈希值，以及转码后视频的视频帧的哈希值，通过汉明距离计算公式计算原始视频的视频帧的哈希值和转码后视频的视频帧的哈希值之间的汉明距离参数，当计算出来的汉明距离参数越大，视频帧的相似度越小，汉明距离参数越小，视频帧的相似度越大。当获取的相似度参数为余弦距离参数时，首先将原始视频的视频帧以及转码后视频的视频帧转化为向量形式，通过计算原始视频的视频帧的向量与转码后视频的视频帧的向量之间的余弦距离，确定余弦距离参数，当计算出来的余弦距参数越大，视频帧的相似度越大，余弦距越小，视频帧的相似度越小。当获取的相似度参数为图像接轨度量参数时，基于亮度、对比度、结构三个方面计算图像接轨度量参数，图像接轨度量参数称作SSIM，SSIM，结构相似性，是一种衡量两幅图像相似度的指标，SSIM使用的两张图像中，一张为未经压缩的原始视频帧x，另一张为转码后的视频帧y，SSIM＝α*β*γ，其中μx，μy为视频帧所有像素；δx,δy为视频帧像素值的标准差；δxy为x与y的协方差，用均值作为亮度的估计，标准差作为对比度的估计，协方差作为结构相似程度的度量，实际应用中α＝β＝γ＝1、C3＝0.5C2，当两张图像一模一样时，SSIM参数的值等于1，根据图像接轨度量参数确定视频帧的相似度。或者，确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常，还包括：将所述相同时间位置的视频帧输入到相似度确定模型中，确定所述原始视频和所述转码后视频的相似度。在转码侧服务器中存在相似度确定模型，用于确定转码后视频是否转码成功，将视频帧中的图像特征输入相似度确定模型，由相似度确定模型输出视频相似度，当视频相似度大于相似度阈值时，确定转码后视频是否转码成功。其中，所述将所述相同时间位置的视频帧输入到所述相似度确定模型之前，还包括：获取多个训练样本，所述训练样本包括原始参考视频、转码后参考视频及视频相似度，所述转码后参考视频是通过所述转码服务对所述原始参考视频转码后得到的视频；将训练样本中的所述原始参考视频、所述转码后参考视频作为输入特征输入到训练模型，将所述训练模型得到的所述原始参考视频和所述转码后参考视频的相似度和所述训练样本中的所述视频相似度进行比对，根据比对结果调整所述训练模型的模型参数，得到所述相似度确定模型。具体的，将训练样本中的原始参考视频、所述转码后参考视频作为输入特征输入到训练模型，将所述相似度确定模型得到的所述原始参考视频、所述转码后参考视频的相似度和所述训练样本中的所述视频相似度进行比对，当比对不一致时，根据比对结果通过机器学习训练对相似度对训练模型的模型参数进行调整，直到视频相似度确定训练模型输出的视频相似度和训练样本中的视频相似度相同时，得到所述相似度确定模型，具体的训练调整方式，本领域技术人员应当知晓，这里不再赘述。作为一种可选的实施方式，所述响应于转码服务检测操作，包括：每间隔预定时间，对所述转码服务进行检测，通过定时分析转码服务的方式，确定转码服务是否正常。或者，响应于所述转码服务完成所述原始视频转码操作的通知，对所述转码服务进行检测，通过分析每个通过转码服务转码的原始视频和转码后视频，确定转码服务的转码质量，以确定转码服务是否正常。作为一种可选的实施方式，所述从所述云存储服务器中读取所述原始视频和所述转码后视频步骤之前，还包括：获取所述原始视频的视频统一资源定位符及所述转码后视频的视频统一资源定位符。其中，统一资源定位符，是对可以从互联网上得到的资源位置和访问方法的一种简洁表示，是互联网上标准资源的地址，互联网上的每个文件都有一个唯一的URL，它包含的信息指出文件的位置以及浏览器应该怎么处理它，具体的，URL类别又分为绝对URL和相对URL。作为一种可选的实施方式，所述从所述云存储服务器中读取所述原始视频和所述转码后视频，包括：根据所述原始视频的视频统一资源定位符，通过云存储服务调用点播云API从所述云存储服务器中读取所述原始视频；根据所述转码后视频的视频统一资源定位符，通过所述云存储服务调用所述点播云API从所述云存储服务器中下载到内容分发网络，从所述内容分发网络读取所述转码后视频。利用本发明提供的转码服务的检测方法，可以针对每天批量的原始视频上传与转码任务，通过机器学习算法实时训练以确定相似度确定模型中的模型参数，能够进一步的提高检测转码服务是否正常的准确度，并将转码服务的问题提前暴露并及时纠正，在转码服务器侧的日常运行中，提高转码服务的可用性和稳定性，提高检测转码服务的效率，并通过相似度确定模型自动发现视频问题，以确定转码服务是否正常，从而节省人力。如图4所示，为一种视频检测方法的完整步骤：步骤S401，响应于转码服务检测操作，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息；步骤S402，从媒体库中获取转码后视频的媒资信息，所述转码后视频是通过所述转码服务对所述原始视频转码后得到的视频；步骤S403，对比所述原始视频和所述转码后视频的媒资信息得到对比结果，确定媒资信息是否一致，比对不一致时执行步骤S404，否则执行步骤S405；步骤S404，确定转码服务不能正常使用，对转码服务进行修复；步骤S405，对转码后视频进行预检测，确定原始视频是否转码成功，若不成功则执行步骤S404，否则，执行步骤S406；步骤S406，确定所述原始视频和所述转码后视频的相似度，判断所述相似度是否大于相似度阈值，若大于相似度阈值，执行步骤S407，否则，执行步骤S404；步骤S407，确定转码服务能正常使用。实施例4参见图5，本公开实施例提供了一种转码服务的检测装置，所述装置包括如下模块：原始视频媒资信息获取模块501，用于响应于转码服务检测操作，对云存储服务器中原始视频进行分析，获取所述原始视频的媒资信息；转码后视频媒资信息获取模块502，用于从媒体库中获取转码后视频的媒资信息，所述转码后视频是通过所述转码服务对所述原始视频转码后得到的视频；媒资信息对比模块503，用于对比所述原始视频和所述转码后视频的媒资信息得到对比结果，确定所述对比结果一致时，从所述云存储服务器中读取所述原始视频和所述转码后视频；转码服务检测模块504，用于确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常。可选地，原始视频媒资信息获取模块用于响应于转码服务检测操作，包括：每间隔预定时间，对所述转码服务进行检测；或响应于所述转码服务完成所述原始视频转码操作的通知，对所述转码服务进行检测。可选地，转码服务检测模块504用于确定所述原始视频和所述转码后视频的相似度，根据所述相似度确定所述转码服务是否正常，包括：从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧；获取所述视频帧中的图像特征，根据所述图像特征确定所述原始视频和所述转码后视频的相似度，并根据所述相似度确定所述转码后视频是否转码成功；根据所述转码后视频是否转码成功确定所述转码服务是否正常。可选地，转码服务检测模块504用于从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧步骤之前，还包括执行如下至少一个步骤：从所述转码后视频中抽取N个视频帧，所述N个视频帧中内容相同的视频帧数量与N的比值大于设定阈值时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述N为大于1的正整数；从所述转码后视频中抽取M个视频帧，检测指定颜色的像素点在各视频帧中的占比是否大于像素比例阈值，若检测到大于所述像素比例阈值的视频帧时，确定所述原始视频转码失败，否则，触发执行从所述原始视频和所述转码后视频中分别抽取相同时间位置的视频帧，所述M为大于等于1的正整数。可选地，转码服务检测模块504用于从所述转码后视频中抽取N个视频帧，包括：随机从所述转码后视频中抽取时间间隔大于第一时间阈值的N个视频帧；或从所述转码后视频中抽取时间间隔小于第二时间阈值的N个关键帧所述所第一时间阈值大于所述第二时间阈值。可选地，转码服务检测模块504用于根据所述图像特征确定所述原始视频和所述转码后视频的相似度，包括：对所述相同时间位置的视频帧的图像特征，计算所述原始视频和所述转码后视频的相似度参数，确定所述原始视频和所述转码后视频的相似度，所述相似度参数包括直方图参数、汉明距离参数、余弦距离参数以及图像接轨度量参数中的至少一种；或者将所述相同时间位置的视频帧输入到相似度确定模型中，确定所述原始视频和所述转码后视频的相似度。可选地，转码服务检测模块504用于将所述相同时间位置的视频帧输入到所述相似度确定模型之前，还包括：获取多个训练样本，所述训练样本包括原始参考视频、转码后参考视频及视频相似度，所述转码后参考视频是通过所述转码服务对所述原始参考视频转码后得到的视频；将训练样本中的所述原始参考视频、所述转码后参考视频作为输入特征输入到训练模型，将所述训练模型得到的所述原始参考视频和所述转码后参考视频的相似度和所述训练样本中的所述视频相似度进行比对，根据比对结果调整所述训练模型的模型参数，得到所述相似度确定模型。可选地，所述媒资信息包括如下至少一种信息：视频文件唯一标识、视频文件大小、视频分辨率、视频码率、视频帧率以及视频内音频码率。可选地，媒资信息对比模块503从所述云存储服务器中读取所述原始视频和所述转码后视频步骤之前，还包括：获取所述原始视频的视频统一资源定位符及所述转码后视频的视频统一资源定位符。可选地，媒资信息对比模块503从所述云存储服务器中读取所述原始视频和所述转码后视频，包括：根据所述原始视频的视频统一资源定位符，通过云存储服务调用点播云API从所述云存储服务器中读取所述原始视频；根据所述转码后视频的视频统一资源定位符，通过所述云存储服务调用所述点播云API从所述云存储服务器中下载到内容分发网络，从所述内容分发网络读取所述转码后视频。参见图6，提供了一种转码服务的检测电子设备，所述电子设备包括处理器和存储器，所述存储器中存储有计算机程序，所述处理器用于执行所述存储器中的计算机程序，用于执行上述实施例提供的一种转码服务的检测方法。其中电子设备600可因配置或性能不同而产生比较大的差异，可以包括一个或一个以上中央处理器601和存储器602，一个或一个以上存储应用程序604或数据605的存储介质603。其中，存储器602和存储介质603可以是短暂存储或持久存储。存储在存储介质603的程序可以包括一个或一个以上模块，每个模块可以包括对信息处理装置中的一系列指令操作。更进一步地，中央处理器601可以设置为与存储介质603通信，在电子设备600上执行存储介质603中的一系列指令操作。电子设备600还可以包括一个或一个以上电源606，一个或一个以上有线或无线网络接口607，一个或一个以上输入输出接口608，和/或，一个或一个以上操作系统609，例如Windows Server，Mac OS X，Unix，Linux，FreeBSD等。本公开实施例提供一种计算机程序介质，所述计算机可读存储介质存储有计算机指令，所述计算机指令被处理器执行时实现上述实施例提供的一种转码服务的检测方法。本领域内的技术人员应明白，本公开的实施例可提供为方法、系统、或计算机程序产品。因此，本公开可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本公开可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本公开是参照根据本公开的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。显然，本领域的技术人员可以对本公开进行各种改动和变型而不脱离本公开的精神和范围。这样，倘若本公开的这些修改和变型属于本公开权利要求及其等同技术的范围之内，则本公开也意图包含这些改动和变型在内。
