标题title
一种基于多标签的RFID识别方法
摘要abst
本发明公开了一种多标签的RFID识别方法，用户申请n个RFID标签，每个RFID标签都与数据库之间共享有各自不同的对称密钥；用户识别身份时随机取出k个RFID标签，按随机的顺序通过移动有源模块依次读取各RFID标签的ID后，生成对应的虚拟ID并通过远距离通信发送至阅读器。数据库存有用户的n个RFID标签的ID及所有ID排列及对应的虚拟ID。阅读器收到虚拟ID后，数据库验证若虚拟ID存在于数据库中则进行后续的双向认证过程。双向认证过程中，阅读器和各RFID标签分别使用对称密钥对验证用随机数进行加密和解密。本发明使用多个RFID标签的随机排列实现了多重身份的效果，从而提高了RFID识别的安全性。
权利要求书clms
1.一种基于多标签的RFID识别方法，其特征在于，用户申请n个RFID标签，每个RFID标签都与数据库之间共享有各自不同的对称密钥；开始用户识别身份时，随机从中取出k个RFID标签，并按随机的顺序通过移动有源模块依次读取各RFID标签的ID，所述移动有源模块获取ID排列后，计算ID集合的哈希值作为所述ID排列对应的虚拟ID，所述虚拟ID通过远距离通信发送至阅读器；所述阅读器所连接的数据库存有用户的n个RFID标签的ID，并且生成所有ID排列及对应的虚拟ID；所述阅读器收到所述移动有源模块发送的虚拟ID后，数据库验证若所述虚拟ID存在于数据库中则进行后续的双向认证过程。2.根据权利要求1所述的基于多标签的RFID识别方法，其特征在于，所述双向认证过程中，所述阅读器和各RFID标签分别使用所述对称密钥对验证用随机数进行加密和解密；其中，所述移动有源模块用于所述阅读器和各RFID标签之间是数据传输，并在对所述阅读器发出的加密数据进行解析得到按ID排列顺序的加密子数据后，根据所述ID排列顺序将各加密子数据发送到对应的RFID标签。3.根据权利要求1所述的基于多标签的RFID识别方法，其特征在于，所述双向认证过程具体包括如下步骤：步骤2.1：阅读器向移动有源模块发起认证指令；步骤2.2：移动有源模块收到认证指令后，生成随机数RB并发送至阅读器；步骤2.3：阅读器收到随机数RB后，数据库生成随机数RA，并根据所述虚拟ID找到对应的ID排列以及所述ID排列对应的k个对称密钥，k个对称密钥按ID排列顺序记为Ki；按ID排列顺序依次使用各对称密钥对RA和RB进行加密得到TOKENAi＝{RA||RB}Ki，形成集合TOKENA＝{TOKENAi,i∈}，将TOKENA发送至移动有源模块；步骤2.4：移动有源模块收到TOKENA后，解析得到按ID排列顺序的TOKENAi；根据ID排列顺序，将相对应的TOKENAi连同随机数RB一起分别发给对应的RFID标签；步骤2.5：各RFID标签分别使用与数据库之间的对称密钥Ki对各自收到的{RA||RB}Ki，进行解密得到RA||RB，验证收到的RB与解密得到的RB是否一致，若校验正确，各RFID标签再分别使用与数据库之间的对称密钥Ki对RA进行加密得到TOKENB1＝{RA}Ki，并将TOKENBi分别发送至移动有源模块；步骤2.6：移动有源模块收到所有的TOKENBi后，按所述ID排列顺得到集合TOKENB＝{TOKENBi,i∈}，将TOKENB发送至阅读器；步骤2.7：阅读器收到TOKENB后，数据库使用对称密钥Ki依次解密TOKENBi，验证每一个解密得到的RA与发出的RA是否一致，若校验正确，则完成所述双向认证。4.根据权利要求3所述的基于多标签的RFID识别方法，其特征在于，所述随机数RB由移动有源模块带有的物理随机数发生器生成。
说明书desc
技术领域本发明涉及一种RFID识别方法。背景技术随着RFID技术的快速发展和RFID电子标签的生产成本不断降低，RFID标签防伪技术的应用也得到了极大的普及，逐步出现在各行各业当中，如交通出行、票务安全、商品防伪等领域。射频识别技术的基本组成有读写器、天线、RFID标签，读写器也称阅读器，是对RFID标签进行读/写操作的设备，主要包括天线、射频前端和读写控制单元三部分。天线是RFID标签和读写器之间实现射频信号空间传播和建立无线通讯连接的设备。RFID标签俗称电子标签，根据工作方式可分为主动式和被动式两大类。无源的RFID标签内部封装一个芯片+天线，当标签天线接收到来自外部读写器发送的RFID无线射频信号，当达到一定的程度，其芯片内部电路中的电容会提供电路所需要的能力，从而激活芯片内部电路开始工作。存在的缺陷：1.现有RFID识别方法中，用户与其RFID存在一一对应的身份绑定关系，敌方可以根据RFID推测出用户身份和用户行为；2.现有RFID识别方法中，若用户长期使用同一个RFID，则该RFID安全性不断降低，即RFID密钥被破解的可能性不断增加，需要用户进行更换，导致用户使用不便；3.现有RFID识别方法中，若用户丢失RFID标签，则面临被破解的风险，一旦发生这种情况，用户使用RFID密钥加密的历史信息也可能会被非法破解；4.现有RFID产生的认证用随机数一般为伪随机数，可能导致RFID被破解。发明内容发明目的：针对上述现有技术，提出一种基于多标签的RFID识别方法，提高RFID识别的安全性。技术方案：一种基于多标签的RFID识别方法，用户申请n个RFID标签，每个RFID标签都与数据库之间共享有各自不同的对称密钥；开始用户识别身份时，随机从中取出k个RFID标签，并按随机的顺序通过移动有源模块依次读取各RFID标签的ID，所述移动有源模块获取ID排列后，计算ID集合的哈希值作为所述ID排列对应的虚拟ID，所述虚拟ID通过远距离通信发送至阅读器；所述阅读器所连接的数据库存有用户的n个RFID标签的ID，并且生成所有ID排列及对应的虚拟ID；所述阅读器收到所述移动有源模块发送的虚拟ID后，数据库验证若所述虚拟ID存在于数据库中则进行后续的双向认证过程。进一步的，所述双向认证过程中，所述阅读器和各RFID标签分别使用所述对称密钥对验证用随机数进行加密和解密；其中，所述移动有源模块用于所述阅读器和各RFID标签之间是数据传输，并在对所述阅读器发出的加密数据进行解析得到按ID排列顺序的加密子数据后，根据所述ID排列顺序将各加密子数据发送到对应的RFID标签。进一步的，所述双向认证过程具体包括如下步骤：步骤2.1：阅读器向移动有源模块发起认证指令；步骤2.2：移动有源模块收到认证指令后，生成随机数RB并发送至阅读器；步骤2.3：阅读器收到随机数RB后，数据库生成随机数RA，并根据所述虚拟ID找到对应的ID排列以及所述ID排列对应的k个对称密钥，k个对称密钥按ID排列顺序记为Ki；按ID排列顺序依次使用各对称密钥对RA和RB进行加密得到TOKENAi＝{RA||RB}Ki，形成集合TOKENA＝{TOKENAi，i∈}，将TOKENA发送至移动有源模块；步骤2.4：移动有源模块收到TOKENA后，解析得到按ID排列顺序的TOKENAi；根据ID排列顺序，将相对应的TOKENAi连同随机数RB一起分别发给对应的RFID标签；步骤2.5：各RFID标签分别使用与数据库之间的对称密钥Ki对各自收到的{RA||RB}Ki，进行解密得到RA||RB，验证收到的RB与解密得到的RB是否一致，若校验正确，各RFID标签再分别使用与数据库之间的对称密钥Ki对RA进行加密得到TOKENB1＝{RA}Ki，并将TOKENBi分别发送至移动有源模块；步骤2.6：移动有源模块收到所有的TOKENBi后，按所述ID排列顺得到集合TOKENB＝{TOKENBi，i∈}，将TOKENB发送至阅读器；步骤2.7：阅读器收到TOKENB后，数据库使用对称密钥Ki依次解密TOKENBi，验证每一个解密得到的RA与发出的RA是否一致，若校验正确，则完成所述双向认证。进一步的，所述随机数RB由移动有源模块带有的物理随机数发生器生成。有益效果：本发明中，用户申请n个RFID标签，每个RFID标签都与数据库之间共享有各自不同的对称密钥；用户识别身份时，随机从中取出k个RFID标签，并按随机的顺序靠近或直接插接到移动有源模块。根据排列公式对取出的k个RFID标签进行排列可得到种ID排列，每种ID排列的哈希值均唯一，即得到种虚拟ID。通过使用对多个RFID标签进行排列的技术，可达到使用少量实体RFID标签实现多重身份的效果。假设用户拥有10个RFID标签，对应RFID的个数为即用户在数据库中体现为9864100个身份。而现有技术中，假设用户拥有10个RFID标签，对应10个RFID，则用户在数据库中仅体现为10个身份。本发明相比于现有技术，具体具有如下优点：1.本发明中，用户除与其实体RFID标签存在一一对应的身份绑定关系，还与更多的虚拟RFID标签存在身份绑定关系，敌方推测用户身份的难度大大增加，敌方只有在记录了所有身份绑定关系的情况下才能完整地推测出用户身份，因此本发明使用少量实体RFID标签实现了多重身份的效果。2.本发明中，用户对RFID标签通过各类组合可以形成新的虚拟RFID，不需要经常去进行更换，一定程度上避免了用户使用不便的问题。3.本发明中，即使用户的个别RFID标签被窃取或丢失，只要其他RFID标签没有被窃取或丢失，用户使用RFID密钥加密的历史信息也不会被全部非法破解。4.本发明中，认证用随机数由移动有源模块内的真随机数发生器产生，随机数质量高，解决了因使用伪随机数而可能导致的RFID被破解的问题。附图说明图1为本发明方法实施的系统结构图；图2为本发明方法的流程图。具体实施方式下面结合附图对本发明做更进一步的解释。一种基于多标签的RFID识别方法，如图1所示，实施在RFID标签、移动有源模块和阅读器，阅读器与数据库之间通过安全信道相连。移动有源模块是一种RFID阅读器，除具备普通RFID阅读器的功能外，还具备移动电源，以方便用户携带；其能同时读取n个或n个以上RFID；具备与阅读器进行通信的能力，尤其可以具备远程通信的能力；移动有源模块为用户所控制的可靠的设备，不会泄露RFID的实际ID。用户申请n个RFID标签，每个RFID标签都与数据库之间共享有各自不同的对称密钥。步骤1：阅读器激活。开始用户识别身份时，用户随机从中取出k个RFID标签，并按随机的顺序靠近或直接插接到移动有源模块，移动有源模块为RFID标签上电后，RFID标签通过NFC或其他近距离通信方式，向移动有源模块安全发送本标签的ID；由于该过程为近距离通信，且移动有源模块为可靠的设备，因此本步骤的实际ID不会被泄露。移动有源模块获取ID排列后，计算ID集合的哈希值作为该ID排列对应的虚拟ID，虚拟ID通过远距离通信发送至阅读器。阅读器所连接的数据库存有用户的n个RFID标签的ID，并且生成所有ID排列及对应的虚拟ID。阅读器收到移动有源模块发送的虚拟ID后，数据库验证若该虚拟ID存在于数据库中则进行后续的双向认证过程。步骤2：双向认证，如图2所示。步骤2.1：阅读器向移动有源模块发起认证指令。步骤2.2：移动有源模块收到认证指令后，生成随机数RB并发送至阅读器；该随机数RB由移动有源模块带有的物理随机数发生器生成。步骤2.3：阅读器收到随机数RB后，数据库生成随机数RA，并根据虚拟ID找到对应的ID排列以及该ID排列对应的k个对称密钥，k个对称密钥按ID排列顺序记为Ki。按ID排列顺序依次使用各对称密钥对RA和RB进行加密得到TOKENAi＝{RA||RB}Ki，如使用K1对RA和RB进行加密得到TOKENA1＝{RA||RB}K1，使用K2对RA和RB进行加密得到TOKENA2＝{RA||RB}K2，……，使用Kk对RA和RB进行加密得到TOKENAk＝{RA||RB}Kk，形成集合TOKENA＝{TOKENAi，i∈}，再将TOKENA发送至移动有源模块。步骤2.4：移动有源模块收到TOKENA后，解析得到按ID排列顺序的TOKENAi。根据ID排列顺序，将相对应的TOKENAi连同随机数RB一起分别发给对应的RFID标签。步骤2.5：各RFID标签分别使用与数据库之间的对称密钥Ki对各自收到的{RA||RB}Ki，进行解密得到RA||RB，验证收到的RB与解密得到的RB是否一致，若校验正确，各RFID标签再分别使用与数据库之间的对称密钥Ki对RA进行加密得到TOKENB1＝{RA}Ki，并将TOKENBi分别发送至移动有源模块。具体的，RFID标签按ID排列顺序：第1个RFID标签收到TOKENA1后，使用与数据库之间的对称密钥K1对{RA||RB}K1进行解密得到RA||RB，验证收到的RB与解密得到的RB是否一致。若校验正确，则使用K1对RA进行加密得到TOKENB1＝{RA}K1，将TOKENB1发送至移动有源模块；第2个RFID标签收到TOKENA2后，使用与数据库之间的对称密钥K2对{RA||RB}K2进行解密得到RA||RB，验证收到的RB与解密得到的RB是否一致。若校验正确，则使用K2对RA进行加密得到TOKENB2＝{RA}K2，将TOKENB2发送至移动有源模块；……；第k个RFID标签收到TOKENAk后，使用与数据库之间的对称密钥Kk对{RA||RB}Kk进行解密得到RA||RB，验证收到的RB与解密得到的RB是否一致。若校验正确，则使用Kk对RA进行加密得到TOKENBk＝{RA}Kk，将TOKENBk发送至移动有源模块。步骤2.6：移动有源模块收到所有的TOKENBi后，按ID排列顺得到集合TOKENB＝{TOKENBi，i∈}，并将TOKENB发送至阅读器。步骤2.7：阅读器收到TOKENB后，数据库使用对称密钥Ki依次解密TOKENBi，验证每一个解密得到的RA与发出的RA是否一致，若校验正确，则完成双向认证。以上所述仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干改进和润饰，这些改进和润饰也应视为本发明的保护范围。
