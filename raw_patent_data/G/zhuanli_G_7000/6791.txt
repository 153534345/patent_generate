标题title
角度编码器的编码和解码方法、编码和解码装置、编码器
摘要abst
本申请涉及一种角度编码器的编码和解码方法、编码和解码装置、编码器。所述编码方法包括：获取传感器信号和中心阈值，根据所述传感器信号和中心阈值将所述传感器信号划分为多个连续的区段；针对每个区段，根据发生翻转的传感器编号确定所述区段所对应的变化位；获取所述区段内各个传感器数值，将所述各个传感器数值与所述变化位对应的传感器数值依次比较得到关系码；根据所述变化位和所述关系码得到所述区段对应的编码。采用本方法能够提高编码器的测量精度和运算速度。
权利要求书clms
1.一种角度编码器编码方法，其特征在于，所述方法包括以下步骤：获取传感器信号和中心阈值，根据所述传感器信号和中心阈值将所述传感器信号划分为多个连续的区段；针对每个区段，根据发生翻转的传感器编号确定所述区段所对应的变化位；获取所述区段内各个传感器数值，将所述各个传感器数值与所述变化位对应的传感器数值依次比较得到关系码；根据所述变化位和所述关系码得到所述区段对应的编码。2.根据权利要求1所述的编码方法，其特征在于，所述根据所述传感器信号和中心阈值将所述传感器信号划分为多个连续的区段，包括：将所述传感器信号与中心阈值进行比较；当在连续段内存在同一传感器数值离所述中心阈值的距离均最小时，则确定所述连续段为一个区段。3.根据权利要求1所述的编码方法，其特征在于，所述针对每个区段，根据发生翻转的传感器编号确定所述区段所对应的变化位，包括：针对每个区段，查找所述区段内传感器数值穿过中心阈值的传感器编号，将所述传感器编号作为所述区段所对应的变化位。4.根据权利要求1所述的编码方法，其特征在于，所述将所述各个传感器数值与所述变化位对应的传感器数值依次比较得到关系码，包括：将所述各个传感器数值与所述变化位对应的传感器数值依次比较；若所述变化位对应的传感器数值大，则得到第一标记值；若所述变化位对应的传感器数值小，则得到第二标记值，所述第一标记值与所述第二标记值不同；根据所述第一标记值和所述第二标记值组合形成关系码。5.根据权利要求1所述的编码方法，其特征在于，所述方法还包括：获取传感器数值与角度的对应关系；获取每个区段的变化位对应的传感器数值；根据所述变化位对应的传感器数值，从所述传感器数值与角度的对应关系中，得到所述变化位的传感器数值所对应的角度；根据所述变化位对应的传感器数值及角度构建每个区段对应的角度与传感器数值的关系函数。6.一种角度编码器的解码方法，其特征在于，包括：获取上一次采样所获得的第一区段号，以及与所述第一区段号相邻的第二区段号；获取所述第一区段号和所述第二区段号分别对应的候选变化位，并获取所述候选变化位对应的传感器数值，其中，所述变化位用于表征发生翻转的传感器；将所述候选变化位对应的传感器数值与中心阈值对应的传感器数值进行比较，得到距所述中心阈值最近的传感器数值，并获取所述最近的传感器数值对应的目标变化位；将所述目标变化位对应的区段号作为目标区段号；获取所述目标区段号对应的角度与传感器数值的关系函数，将所述目标变化位对应的传感器数值带入所述关系函数，得到对应的目标角度。7.根据权利要求6所述的解码方法，其特征在于，所述方法还包括：获取各个传感器初始化得到的传感器信号；将所述初始化得到的传感器信号与中心阈值进行比较，得到初始变化位；将其他传感器数值与所述初始变化位所对应的传感器数值依次比较，得到初始关系码；根据所述初始变化位和所述初始关系码，获取对应的初始区段号，将所述初始区段号作为下次采样的第一区段号。8.根据权利要求6所述的解码方法，其特征在于，所述方法还包括：获取所述第一区段号和所述第二区段号分别对应的角度与传感器数值的关系函数；将所述第一区段号对应的变化位的传感器数值带入所述第一区段号对应的角度与传感器数值的关系函数，得到第一角度；将所述第二区段号对应的变化位的传感器数值带入所述第二区段号对应的角度与传感器数值的关系函数，得到第二角度；对所述第一角度和第二角度加权平均，得到目标角度。9.一种编码装置，其特征在于，包括：第一获取模块，用于获取传感器信号和中心阈值，根据所述传感器信号和中心阈值将所述传感器信号划分为多个连续的区段；变化位确定模块，用于针对每个区段，根据发生翻转的传感器编号确定所述区段所对应的变化位；第一比较模块，用于获取所述区段内各个传感器数值，将所述各个传感器数值与所述变化位对应的传感器数值依次比较得到关系码；编码确定模块，用于根据所述变化位和所述关系码得到所述区段对应的编码。10.一种编码器的解码装置，其特征在于，包括：第二获取模块，用于获取上一次采样所获得的第一区段号，以及与所述第一区段号相邻的第二区段号；第三获取模块，用于获取所述第一区段号和所述第二区段号分别对应的候选变化位，并所述候选变化位对应的传感器数值，其中，所述变化位用于表征发生翻转的传感器；第二比较模块，用于将所述候选变化位对应的传感器数值与中心阈值对应的传感器数值进行比较，得到距所述中心阈值最近的传感器数值，并获取所述最近的传感器数值对应的目标变化位；区段号确定模块，用于将所述目标变化位对应的区段号作为目标区段号；角度确定模块，用于获取所述目标区段号对应的角度与传感器数值的关系函数，将所述目标变化位对应的传感器数值带入所述关系函数，得到对应的目标角度。11.一种编码器，包括脉冲盘和电路模块，所述电路模块包括多个传感器、模/数转换器、处理器和存储器；所述传感器与模/数转换器电连接，所述处理器分别与所述模/数转换器和存储器电连接；所述多个传感器分布于所述脉冲盘的同一圆周上，所述脉冲盘与所述多个传感器能相对转动，其特征在于，所述多个传感器用于采集模拟信号；所述模/数转换器，用于将模拟信号采样并转换为数字信号，传输所述数字信号给所述处理器；所述处理器用于实现如权利要求1-5任一所述的角度编码器编码方法，和/或用于实现如权利要求6-8中任一项所述的编码器解码方法。12.根据权利要求11所述的编码器，其特征在于，所述脉冲盘设有两种条纹，所述条纹的长度大于两个所述区段的长度。13.根据权利要求11所述的编码器，其特征在于，所述模/数转换器的采样频率大于转速与区段数的乘积。14.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时以实现如权利要求1-8中任一项所述的方法。
说明书desc
技术领域本发明涉及高精度角度测量技术，具体涉及一种角度编码器的编码和解码方法、编码和解码装置、编码器。背景技术编码器是将信号或数据进行编制、转换为可用以通讯、传输和存储的信号形式的设备。编码器把角位移或直线位移转换成电信号的位移传感器，按照工作原理编码器可分为增量式和绝对式两类。增量式编码器是将位移转换成周期性的电信号，再把这个电信号转变成计数脉冲，用脉冲的个数表示位移的大小。绝对式编码器就是对应一圈，每个基准的角度发出一个唯一与该角度对应二进制的数值，通过外部记圈器件可以进行多个位置的记录和测量，因此它的示值只与测量的起始和终止位置有关，而与测量的中间过程无关。相关技术中，编码器大多通过增加传感器的数量来提高相应的测量精度，然而在传感器增多的情况下，很难保证每个传感器都在同一时间采样。这使得编码器在高速运转时，编码器的测量精度误差较大。发明内容基于此，有必要针对上述技术问题，提供一种角度编码器编码和解码方法、编码和解码装置、编码器，能够提高编码器的测量精度。第一方面，提供了一种角度编码器编码方法，所述方法包括以下步骤：获取传感器信号和中心阈值，根据所述传感器信号和中心阈值将所述传感器信号划分为多个连续的区段；针对每个区段，根据发生翻转的传感器编号确定所述区段所对应的变化位；获取所述区段内各个传感器数值，将所述各个传感器数值与所述变化位对应的传感器数值依次比较得到关系码；根据所述变化位和所述关系码得到所述区段对应的编码。在本申请的一个实施例中，根据所述传感器信号和中心阈值将所述传感器信号划分为多个连续的区段，包括：将所述传感器信号与中心阈值进行比较；当在连续段内存在同一传感器数值离所述中心阈值的距离均最小时，则确定所述连续段为一个区段。在本申请的一个实施例中，针对每个区段，根据发生翻转的传感器编号确定所述区段所对应的变化位，包括：针对每个区段，查找所述区段内传感器数值穿过中心阈值的传感器编号，将所述传感器编号作为所述区段所对应的变化位。在本申请的一个实施例中，将所述各个传感器数值与所述变化位对应的传感器数值依次比较得到关系码，包括：将所述各个传感器数值与所述变化位对应的传感器数值依次比较；若所述变化位对应的传感器数值大，则得到第一标记值；若所述变化位对应的传感器数值小，则得到第二标记值，所述第一标记值与所述第二标记值不同；根据所述第一标记值和所述第二标记值组合形成关系码。在本申请的一个实施例中，编码方法还包括：获取传感器数值与角度的对应关系；获取每个区段的变化位对应的传感器数值；根据所述变化位对应的传感器数值，从所述传感器数值与角度的对应关系中，得到所述变化位的传感器数值所对应的角度；根据所述变化位对应的传感器数值及角度构建每个区段对应的角度与传感器数值的关系函数。第二方面，提供了一种角度编码器的解码方法，包括以下步骤：获取上一次采样所获得的第一区段号，以及与所述第一区段号相邻的第二区段号；获取所述第一区段号和所述第二区段号分别对应的候选变化位，并获取所述候选变化位对应的传感器数值，其中，所述变化位用于表征发生翻转的传感器；将所述候选变化位对应的传感器数值与中心阈值对应的传感器数值进行比较，得到距所述中心阈值最近的传感器数值，并获取所述最近的传感器数值对应的目标变化位；将所述目标变化位对应的区段号作为目标区段号；获取所述目标区段号对应的角度与传感器数值的关系函数，将所述目标变化位对应的传感器数值带入所述关系函数，得到对应的目标角度。在本申请的一个实施例中，所述解码方法还包括：获取各个传感器初始化得到的传感器信号；将所述初始化得到的传感器信号与中心阈值进行比较，得到初始变化位；将其他传感器数值与所述初始变化位所对应的传感器数值依次比较，得到初始关系码；根据所述初始变化位和所述初始关系码，获取对应的初始区段号，将所述初始区段号作为下次采样的第一区段号。在本申请的一个实施例中，所述解码方法还包括：获取所述第一区段号和所述第二区段号分别对应的角度与传感器数值的关系函数；将所述第一区段号对应的变化位的传感器数值带入所述第一区段号对应的角度与传感器数值的关系函数，得到第一角度；将所述第二区段号对应的变化位的传感器数值带入所述第二区段号对应的角度与传感器数值的关系函数，得到第二角度；对所述第一角度和第二角度加权平均，得到目标角度。第三方面，提供了一种编码器的编码装置，包括：第一获取模块，用于获取传感器信号和中心阈值，根据所述传感器信号和中心阈值将所述传感器信号划分为多个连续的区段；变化位确定模块，用于针对每个区段，根据发生翻转的传感器编号确定所述区段所对应的变化位；第一比较模块，用于获取所述区段内各个传感器数值，将所述各个传感器数值与所述变化位对应的传感器数值依次比较得到关系码；编码确定模块，用于根据所述变化位和所述关系码得到所述区段对应的编码。第四方面，提供了一种编码器的解码装置，包括：第二获取模块，用于获取上一次采样所获得的第一区段号，以及与所述第一区段号相邻的第二区段号；第三获取模块，用于获取所述第一区段号和所述第二区段号分别对应的候选变化位，并获取所述候选变化位对应的传感器数值，其中，所述变化位用于表征发生翻转的传感器；第二比较模块，用于将所述候选变化位对应的传感器数值与中心阈值对应的传感器数值进行比较，得到距所述中心阈值最近的传感器数值，并获取所述最近的传感器数值对应的目标变化位；区段号确定模块，用于将所述目标变化位对应的区段号作为目标区段号；角度确定模块，用于获取所述目标区段号对应的角度与传感器数值的关系函数，将所述目标变化位对应的传感器数值带入所述关系函数，得到对应的目标角度。第五方面，提供了一种编码器，包括脉冲盘和电路模块，所述电路模块包括多个传感器、模/数转换器、处理器和存储器；所述传感器与模/数转换器电连接，所述处理器分别与所述模/数转换器和存储器电连接；所述多个传感器分布于所述脉冲盘的同一圆周上，所述脉冲盘与所述多个传感器能相对转动；所述多个传感器用于采集模拟信号；所述模/数转换器，用于将模拟信号采样并转换为数字信号，传输所述数字信号给所述处理器；所述处理器用于实现所述的角度编码器编码方法，和/或用于实现所述的编码器解码方法。在本申请的一个实施例中，脉冲盘设有两种条纹，所述条纹的长度大于两个所述区段的长度。在本申请的一个实施例中，模/数转换器的采样频率大于转速与区段数的乘积。第六方面，提供了一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述编码方法或解码方法的步骤。本申请提供的编码方法，根据发生翻转的传感器编号确定所述区段对应的变化位，再根据各个传感器数值与变化位对应的传感器数值之间的关系得到关系码，最终由变化位和关系码确定各区段对应的编码，使得区段与编码之间具有唯一的对应关系，具备绝对编码器性质，可在传感器数量不变的前提下提高编码器测量精度。本申请提供的解码方法，初始化运行后，下一次运行所处的区段均为上一次运行区段的相邻区段，在实际运行时，无论传感器数量多少，只需要在初始运行时采样并转换所有传感器信号，以后的运行就只需转换三个区段内三个传感器信号，大大减少了计算复杂度和运算时间，从而既提高了测量精度，又节省了运算时间，提高了处理效率。附图说明图1为一个实施例中角度编码器的应用环境图；图2为一个实施例中编码方法流程示意图；图3为图2实施例中步骤S202的流程示意图；图4为图2实施例中步骤S206的流程示意图；图5为一个实施例中构建角度与传感器数值间关系函数的流程示意图；图6为一个实施例中传感器信号编码示意图；图7为一个实施例中解码方法示意图；图8为一个实施例中解码方法示意图；图9为一个实施例中解码方法示意图；图10为一个实施例中解码方法示意图；图11为一个实施例中编码装置的结构框图；图12为一个实施例中解码装置的结构框图；图13为一个实施例中编码器电路模块系统框图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。本申请实施例提供的角度编码器的编码和解码方法可以应用于如图1所示的应用环境中。在该应用环境中，包括编码器102和电机104。其中，通过连接器将编码器102和电机104的转动轴相连，电机转动时带动编码器的轴同速转动。编码器102内部设有多个传感器，编码器102的轴转动一周，编码器102的输出线上就产生固定数的脉冲输出，这样就可以根据脉冲数知道电机转动的圈数和位置。另外，编码器还可以与踏板、方向盘、齿轮条、螺丝杆等相连，对应测量发生旋转运动或者水平运动的机械设备的移动方向、移动量及角度等。以下实施例以该编码器为执行主体进行详细说明。请参见图2，本申请一个实施例提供了一种编码方法，该方法包括以下步骤：S202：获取传感器信号和中心阈值，根据传感器信号和中心阈值将传感器信号划分为多个连续的区段。其中，传感器信号指运行过程中传感器采集到的模拟信号转换为的数字信号，模拟信号可以是电压信号、光强度、磁场强度、电场强度等信号中的任一种，模拟信号经过模数转换器转换为数字信号。中心阈值是介于所有传感器数值范围内的某一个数值，例如可以是传感器数值中的最大值与最小值的平均值，或者是传感器数值中的中位数，以及所有传感器数值的平均值。在本实施例中，根据获取的全部传感器信号分布特点与中心阈值之间的关系，将传感器信号划分为多个连续的区段，可以为每个区段分配唯一的区段号。S204：针对每个区段，根据发生翻转的传感器编号确定区段所对应的变化位。其中，翻转指的是在同一区段内，如果某一传感器信号从较大值/较小值穿过中心阈值得到较小值/较大值，则称某一传感器发生了翻转。在本实施例中，同一区段只可能会有一个传感器发生翻转，则发生翻转的传感器编号对应相应的变化位，传感器编号可以用阿拉伯数字、罗马数字、汉字数字、英文字母、阿拉伯数字序号等来表示，传感器编号用于表征不同位置的传感器。本实施例中，通过获取所有传感器数值，将每个传感器数值依此与中心阈值进行比较，如果同一传感器数值中同时存在比中心阈值小的数值和比中心阈值大的值，说明这个传感器的数值还具有与中心阈值相同的数值，此传感器发生了翻转。S206：获取区段内各个传感器数值，将各个传感器数值与变化位对应的传感器数值依次比较得到关系码。在同一区段内，将各个传感器数值与中心阈值进行比较，比较的结果可定义二进制、四进制、六进制、十进制、十六进制或者一串0、1组成的数字串来进行表征，也可以根据自定义的传感器数值与中心阈值间的其他关系来进行表征，关系码用于表征各个传感器数值与中心阈值的比较结果。同一个编码器中，其他区段对应的关系码根据同样的方法得到。S208：根据变化位和关系码得到区段对应的编码。具体的，通过变化位与关系码共同得到对应的编码，可由变化位与关系码组成的数对、数字串或者其他形式表征编码。一个区段唯一对应一个编码。上述实施例中编码器的编码方法，根据发生翻转的传感器编号确定区段对应的变化位，再根据各个传感器数值与变化位对应的传感器数值之间的关系得到关系码，最终由变化位和关系码确定各区段对应的编码，使得区段与编码之间具有唯一的对应关系，具备绝对编码器性质，同时减少了编码数量，在传感器数量不变的前提下提高了编码器测量精度。在一个实施例中，如图3所示，根据传感器信号和中心阈值将传感器信号划分为多个连续区段的步骤S202包括：S302：将传感器信号与中心阈值进行比较。在一个可能的实施方式中，中心阈值为所有传感器数值中最大值与最小值的平均值。具体地，将获取的各个传感器数值依次与中心阈值进行大小比较，并记录下各个传感器多个数值与中心阈值的距离。S304：当在连续段内存在同一传感器数值离中心阈值的距离均最小时，则确定连续段为一个区段。本实施例中，在某一连续的段内，出现同一传感器数值离阈值的距离均比其他传感器数值离阈值的距离小，则从这一传感器数值离阈值距离最小时开始，到这一传感器数值离阈值的距离不再是最小时为止，则称这一连续段为一个区段。在同一区段内，变化位对应的传感器数值离中心阈值的距离小于其他传感器数值到中心阈值的距离。本实施例中，根据所有传感器信号与中心阈值间的关系划分区段，使得区段划分与传感器信号特性更加相符，实现编码具有绝对编码的性质。在一个实施例中，针对每个区段，根据发生翻转的传感器编号确定区段对应的变化位，具体地，通过查找区段内传感器数值穿过中心阈值的传感器编号，将传感器编号作为区段对应的变化位。本实施例中，所有传感器编号不重复，以保证在同一区段内，只有一个传感器发生翻转。在一个实施例中，如图4所示，将各个传感器数值与变化位对应的传感器数值依次比较得到关系码的步骤S206包括：S402：将各个传感器数值与变化位对应的传感器数值依次比较。S404：若变化位对应的传感器数值大，则得到第一标记值。S406：若变化位对应的传感器数值小，则得到第二标记值，第一标记值与第二标记值不同。在一个可能的实施方式中，将每个区段中各个传感器数值与变化位对应的传感器数值相比较，如果变化位对应的传感器数值大，则记第一标记值为“1”，如果变化位对应的传感器数值小，则记第二标记值为“0”；或者，如果变化位对应的传感器数值大，则记第一标记值为“0”，如果变化位对应的传感器数值小，则记第二标记值为“1”。在一个可能的实施方式中，将每个区段中各个传感器数值与变化位对应的传感器数值相比较，如果变化位对应的传感器数值大，则记第一标记值为“A”，如果变化位对应的传感器数值小，则记第二标记值为“a”；或者，如果变化位对应的传感器数值大，则记第一标记值为“a”，如果变化位对应的传感器数值小，则记第二标记值为“A”。S408：根据第一标记值和第二标记值组合形成关系码。在获得第一标记值和第二标记值后，按照一定的顺序，将比较的结果组合形成关系码。具体地，可将变化位对应的传感器数值与其他任一传感器数值比较的结果获得的第一标记值或第二标记值得到关系码的第一位，根据传感器编号的顺序，按照正向顺序或者反向顺序进行比较依次得到关系码的第二位、第三位，直至最后一位，所有位组合在一起形成关系码，其中，变化位对应的传感器数值可根据需要选择是否与自身进行比较。每个区段对应的关系码中的每一位均按照同样的顺序比较得到第一标记值或第二标记值。上述实施例中，由变化位和关系码组合形成各区段对应的编码，增加了区段与编码之间的唯一性，使得编具备绝对编码器性质，提高了编码器测量精度。同时，每个区段对应的关系码的位数保持不变，可通过设置关系码位数纠错机制，运算时就不容易发生错误，进一步提高了编码器的测量精度。在一个实施例中，编码器的编码方法具体包括：定义一组周期为P的传感器信号码字系列为{W0,…,Wp-1}，即一个周期分为p个连续的区段，其中，码字Wi表示区段内各个传感器数值与中心阈值比较的结果。对于任意属于0到p-1之间的i，Wi与Wmod以及Wmod均只有1位上的数字有区别，即只有一个传感器数值发生了翻转。这里mod为取余运算，mod即为x除以y的余数。令Bi为Wi与Wmod所不同的那一位的位号，称作在序列号i上的变化位，可得一组{B0,…,Bp-1}变化位序列，在0到p-1区段，{Bi,Bmod,Bmod}中均没有重复的传感器编号。删除Bi所对应的那一位，依次获取区段内其他传感器与变化位传感器数值之间的大小关系得到关系码Ci，对每一个0到p-1之间的i均进行同样的操作，可得到另一个码字序列{{B0,C0}…,{Bp-1,Cp-1}}，即可得到区段对应的编码。在一个实施例中，如图5所示，角度编码器的编码方法还包括以下步骤：S502：获取传感器数值与角度的对应关系。在一个可能的实施方式中，使用另外一高精度基准编码器与待标定的编码器中的传感器相连，获取每个传感器数值对应的角度，建立传感器数值与对应角度间的关系。具体地，通过步进电机驱动待标定的角度编码器以指定角度逐步旋转完成不少于360°的转动，通过与步进电机输出轴相连的高精度基准编码器获取待标定的角度编码器在每一个指定角度的位置的多个传感器数值，从而得到传感器数值与角度间的对应关系。S504：获取每个区段变化位对应的传感器数值。针对每个区段，根据传感器数值是否发生翻转，找到相应变化位对应的传感器数值。S506：根据变化位对应的传感器数值，从传感器数值与角度的对应关系中，得到变化位的传感器数值所对应的角度。找到相应的变化位传感器数值后，再获取相应传感器数值对应的角度值。S508：根据变化位对应的传感器数值与角度构建每个区段对应的角度与传感器数值的关系函数。具体地，在每个区段中，变化位所对应的传感器数值与角度呈现连续单调平滑的关系，因此可以通过多个数值确定变化位对应传感器数值与角度间的关系函数，关系函数可以是一次函数、二次函数、多次函数、正比例函数、反比例函数、三角函数、指数函数、对数函数、幂函数、分段函数、查表函数中的至少一种。每个区段都有相应的变化位传感器数值与角度之间的关系函数，即可建立周期内编码序列{{B0,C0},{B1,C1},…,{Bp-1,Cp-1}}与关系函数组{F0,F1,…,Fp-1}之间的对应关系，其中，p用于表征区段数，B用于表征变化位，C用于表征关系码。在一个实施例中，如图6所示，角度编码器的编码步骤具体包括：根据传感器获取的信号分布情况，设定中心阈值T0为一周内传感器数值的最大值与最小值的平均值；其中sensors#0、sensors#1、sensors#2为相应传感器的编号，即只使用了三个传感器。进行区段划分，根据传感器信号分布趋势，0-60°区间，sensors#2的传感器数值离中心阈值T0的距离均比sensors#0和sensors#1离中心阈值T0的距离都小，因此选择0-60°为第①区段；类似地，60-120°区间，sensors#1的传感器数值离中心阈值T0的距离最小，则选择60-120°为第②区段；以此类推，一个周期内共分为6个区段。每个区段对应一个编码，保证区段与编码的一一对应关系，本实施例中的编码设置为变化位和关系码为数对的形式，即{B,C}，变化位B为此区段内离中心阈值T0的距离最小的传感器数值对应的传感器编号，关系码为此区段内其他传感器数值与B对应的传感器数值依次进行比较得到的关系码C。例如，针对第①个区段，离中心阈值T0的距离最小的是传感器编号为sensors#2对应的数值，则关系码为对应的传感器编号2；传感器sensors#0对应的数值比传感器sensors#2对应数值大，则定义“右一关系码”为1，传感器sensors#1对应的数值比传感器sensors#2对应数值小，则定义“右二关系码”为0，定义传感器sensors#2对应数值不与自身作比较，结果使用二进制来表示，则得到二进制01，转换为十进制为1，因此第二位编码为1，获得第①个区段的编码为{2,1}。再如，针对第⑤个区段，离中心阈值T0的距离最小的是传感器编号为sensors#1对应的数值，则此区段中变化位为对应的传感器编号1；传感器sensors#0对应的数值比传感器sensors#1对应数值小，则定义“右一关系码”为0，传感器sensors#2对应的数值比传感器sensors#1对应数值大，则定义“右二关系码”为1，定义传感器sensors#1对应数值不与自身作比较，结果同样使用二进制表示，则得到二进制010，转换为十进制为2，因此第二位编码为2，获得第⑤个区段的编码为{1，2}。由上述步骤可得到区段号与编码之间的对应关系，如表1所示。表1区段号角度范围编码传感器数值与角度关系①0～60{2,1}F1②60～120{1,1}F2③120～180{0,1}F3④180～240{2,2}F4⑤240～300{1,2}F5⑥300～360{0,2}F6进一步地，由于每个区段中，变化位所对应的传感器数值与角度呈现单调连续且平滑的关系，因此可以找出每个区段中变化位对应传感器数值与相应的角度之间的关系函数，得到各个区段内的关系函数组{F1,……,F5}，见表1。以上主要描述了编码器的编码方法，得到了各个区段对应的编码以及各个区段内传感器数值与角度之间的关系函数，方便后续解码时使用。因此，本申请实施例还提供了一种编码器的解码方法。如图7所示，本申请一个实施例提供了编码器解码方法，具体步骤包括：S702：获取上一次采样所获得的第一区段号，以及与第一区段号相邻的第二区段号。编码器在测量角度的过程中，传感器采集一次信号，即获得一个对应的角度。为了加快编码器运行速度，可以充分利用上一次运行的结果作为本次运行和计算的依据，并把上一次运行获得的区段号称为第一区段号，其相邻区段号称为第二区段号，第二区段号包含两个区段。例如，上次采样获得的区段号为i，本次运行时获取其相邻区段号i+1和i-1。特别地，当上一次运行的第一区段号为最后一个区段时，其相邻区段为倒数第二个区段和第一个区段。S704：获取第一区段号和第二区段号分别对应的候选变化位，并获取候选变化位对应的传感器数值，其中，变化位用于表征发生翻转的传感器。通过上一步骤获取得到第一区段号和第二区段号后，在三个区段中，分别找到相应传感器数值从较大值/较小值穿过中心阈值得到较小值/较大值的相应传感器编号，也就是发生翻转的传感器编号，即可得到三个相应的候选变化位，同时获取本区段中对应候选变化位的传感器数值。S706：将候选变化位对应的传感器数值与中心阈值对应的传感器数值进行比较，得到距离中心阈值最近的传感器数值，并获取最近的传感器数值对应的目标变化位。本实施例中，候选变化位对应的传感器数值即对应有三个传感器对应的传感器数值，通过将三个传感器的传感器数值分别与中心阈值比较，获得距离中心阈值最近的传感器数值，进一步的，获得距离中心阈值最近的传感器数值对应的传感器编号，也就是相应变化位，即可获得目标变化位。S708：将目标变化位对应的区段号作为目标区段号。确定目标变化位所在的区段，即获得目标区段号。S710：获取目标区段号对应的角度与传感器数值的关系函数，将目标变化位对应的传感器数值带入关系函数，得到对应的目标角度。根据上一步骤获得目标区段号后，确定本区段中根据前述实施例中建立的关系函数，输入目标变化位对应的传感器数值，即可得到对应的目标角度。本实施例通过获取上一次运行的区段号及其相邻区段号，只需对三个区段号中的传感器数值进行比较，挑选出离中心阈值最近的传感器数值及相应变化位，进而得出本次运行的区段号，加快了运算速度，提高了测量效率。在一个实施例中，如图8所示，编码器的解码方法还包括以下步骤：S802：获取各个传感器初始化得到的传感器信号。编码器在首次运行时，需要获取所有传感器的数值。S804：将初始化得到的传感器信号与中心阈值进行比较，得到初始变化位。将上一步骤获取的所有传感器数值依次与中心阈值进行比较，获取离中心阈值距离最小的传感器数值，进一步地，获取离中心阈值距离最小的传感器数值对应的传感器编号，得到初始变化位。S806：将其他传感器数值与初始变化位对应的传感器数值依次比较，得到初始关系码。S808：根据初始变化位和初始关系码，获取对应的区段号，将所述区段号作为下次采样的第一区段号。获取初始变化位和初始关系码后，即可确定相应的初始编码，根据系统中编码和区段号的一一对应关系，即可获取相应的初始区段号。初始区段号可作为下一次采样的第一区段号。在一个实施例中，获取第一区段号的具体步骤包括：初始运行时，通过获取各个传感器初始化得到的传感器信号，将得到的传感器信号与中心阈值进行比较，获取离中心阈值距离最小的传感器数值，进而得到对应的传感器编号，得到初始变化位B0；将其他传感器数值与初始变化位对应的传感器数值依次进行比较，得到初始关系码C0，由初始变化位和初始关系码得到初始编码{B0,C0}，根据区段号与编码之间的对应关系，获取初始区段号i，那么，初始区段号i作为下一次采样的第一区段号。非初始运行时，由于模数转换器的采样转换频率大于编码器转速与区段数量的乘积，则下一次采样时所对应的区段只可能是上一次采样获取区段j以及j的相邻区段mod、mod；又因为每个区段只有一个变化位，因此，本时刻的目标变化位Bi，只可能是{Bj,Bmod,Bmod}中的一个。所以，获取三个相邻变化位对应的传感器数值，找到距离阈值最近的传感器数值对应的传感器编号，即可确定目标变化位Bi，因为{Bj,Bmod,Bmod}三个变化位对应的传感器编号均不相同，根据目标变化位Bi所处的区段确定目标区段号i。此目标区段号i可作为下一次采样的第一区段号，具体见式。在一个实施例中，如图9所示，编码器的解码方法还包括以下步骤：S902：获取第一区段号和第二区段号分别对应的角度和传感器数值的关系函数。区段号是用于唯一标识一个区段的。传感器信号按照360°为一个周期划分为多个区段，并为每个区段标记有对应的区段号，每个区段有两个相邻的区段。获取上一次运行获取的第一区段号，以及第一区段号相邻的第二区段号，从系统中获取三个区段分别对应的角度和传感器数值的关系函数。S904：将第一区段号对应的变化位的传感器数值带入第一区段号对应的角度与传感器数值的关系函数，得到第一角度。S906：将第二区段号对应的变化位的传感器数值带入第二区段号对应的角度与传感器数值的关系函数，得到第二角度。S908：对第一角度和第二角度加权平均，得到目标角度。将根据上述步骤得到的第一角度和第二角度，即三个角度值进行加权平均，得到目标角度。其中，加权平均的权值可以是固定值，也可以是关于传感器数值的相关函数或者自定义数值。本实施例通过获取三个相邻区段的区段号，进一步获取对应的关系函数，输入传感器数值得到三个对应角度值，将三个角度值进行数据处理，比如加权平均，以进一步提高编码器测量精度。在一个实施例中，如图10所示，提供了编码器的解码方法，该方法具体包括以下步骤：S1002：开始运行。S1004：获取所有的初始化传感器信号。获取各个传感器初始化得到的传感器信号。S1006：温度矫正。对获取的所有初始化传感器信号进行温度矫正，以保证传感器测量结果的准确性。S1008：获取初始变化位及初始关系码。将初始化得到的传感器信号与中心阈值进行比较，得到初始变化位，再将其他传感器数值与初始变化位所对应的传感器数值依次比较，得到初始关系码，根据初始变化位和初始关系码得到初始编码。S1010：获取初始区段号。根据区段号与编码之间的对应关系，通过初始编码获取初始区段号。初始区段号作为下一次运行的第一区段号。S1012：获取上一次获取的第一区段号及与第一区段号相邻区段号对应的候选变化位对应传感器数值。获取第一区段号和与第一区段号相邻的区段号，进一步获取各区段号对应的候选变化位，获取各候选变化位对应的传感器数值。特别地，当编码器第2次运行时，获取初始区段号及相邻区段号对应的候选变化位，进一步获取各候选变化位对应的传感器数值。S1014：进行温度矫正。对候选变化位对应的传感器数值进行温度矫正。S1016：获取候选变化位传感器数值中离中心阈值最近的传感器数值对应的目标变化位。将候选变化位对应的传感器数值与中心阈值进行比较，获取距离中心阈值最近的传感器数值对应的其中一个候选变化位，即得到目标变化位。S1018：确定目标区段号。目标区段号为第一区段号和与第一区段号相邻区段号中的一个，获取目标变化位所在的区段号，即为目标区段号。当次运行获取的目标区段号为下一次运行的第一区段号。S1020：获取目标区段号对应的角度与传感器数值间的关系函数，获取目标角度。获取目标区段号对应的角度与传感器数值间的关系函数，带入变化位对应的传感器数值，即可获取目标角度。本实施例中，还可以通过获取在步骤S1012中获取的第一区段号及与第一区段号相邻的区段号，进一步获取各个区段号中角度与传感器数值对应的关系函数，带入相应区段中候选变化位对应的传感器数值，即可得到三个相应的角度值，将这三个角度值进行加权平均，得到本次运行的目标角度。设备正常运行时，重复上述步骤S1012～S1020，逐次运行获取相应的角度值，直至设备停止运行，进入步骤S1022。S1022：结束。应该理解的是，虽然图2、图3、图4、图5、图7、图8、图9、图10的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，图2、图3、图4、图5、图7、图8、图9、图10中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些子步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。在一个实施例中，如图11所示，提供了一种编码装置，该装置可以采用软件模块或硬件模块，或者是二者的结合成为编码器设备的一部分，该装置具体包括：第一获取模块1102、变化位确定模块1104、第一比较模块1106、编码确定模块1108，其中：第一获取模块1102，用于获取传感器信号和中心阈值，根据传感器信号和中心阈值将所述传感器信号划分为多个连续的区段。变化位确定模块1104，用于针对每个区段，根据发生翻转的传感器编号确定区段所对应的变化位；第一比较模块1106，用于获取区段内各个传感器数值，将各个传感器数值与变化位对应的传感器数值依次比较得到关系码；编码确定模块1108，用于根据变化位和关系码得到区段对应的编码。在一个实施例中，第一获取模块1102还用于将传感器信号与中心阈值进行比较；当在连续段内存在同一传感器数值离中心阈值的距离均最小时，则确定连续段为一个区段。在一个实施例中，变化位确定模块1104还用于针对每个区段，查找区段内传感器数值穿过中心阈值的传感器编号，将传感器编号作为区段所对应的变化位。在一个实施例中，第一比较模块1106还用于将各个传感器数值与变化位对应的传感器数值依次比较；若变化位对应的传感器数值大，则得到第一标记值；若变化位对应的传感器数值小，则得到第二标记值，其中，第一标记值与第二标记值不同；根据第一标记值和第二标记值组合形成关系码。在一个实施例中，编码装置还包括：关系获取模块、传感器数值获取模块、角度确定模块和关系函数构建模块。关系获取模块，用于获取传感器数值与角度的对应关系；传感器数值获取模块，用于获取每个区段的变化位对应的传感器数值；角度获取模块，用于根据所述变化位对应的传感器数值，从所述传感器数值与角度的对应关系中，得到所述变化位的传感器数值所对应的角度；关系函数构建模块，用于根据所述变化位对应的传感器数值及角度构建每个区段对应的角度与传感器数值的关系函数。在一个实施例中，如图12所示，提供了一种编码器解码装置，该装置可以采用软件模块或硬件模块，或者二者结合成为编码器设备的一部分，该装置具体包括：第二获取模块1202、第三获取模块1204、第二比较模块1206、区段号确定模块1208、角度确定模块1210，其中：第二获取模块1202，用于获取上一次采样所获得的第一区段号，以及与第一区段号相邻的第二区段号；第三获取模块1204，用于获取第一区段号和所述第二区段号分别对应的候选变化位，并获取候选变化位对应的传感器数值，其中，变化位用于表征发生翻转的传感器；第二比较模块1206，用于将候选变化位对应的传感器数值与中心阈值对应的传感器数值进行比较，得到距中心阈值最近的传感器数值，并获取最近的传感器数值对应的目标变化位；区段号确定模块1208，用于将目标变化位对应的区段号作为目标区段号；角度确定模块1210，用于获取目标区段号对应的角度与传感器数值的关系函数，将目标变化位对应的传感器数值带入所述关系函数，得到对应的目标角度。在一个实施例中，该编码器解码装置还包括初始化处理模块，该模块用于：获取各个传感器初始化得到的传感器信号；将初始化得到的传感器信号与中心阈值进行比较，得到初始变化位；将其他传感器数值与初始变化位所对应的传感器数值依次比较，得到初始关系码；根据初始变化位和所述初始关系码，获取对应的初始区段号，将初始区段号作为下次采样的第一区段号。在一个实施例中，该编码器解码装置还包括角度处理模块，该模块用于：获取第一区段号和第二区段号分别对应的角度与传感器数值的关系函数；将第一区段号对应的变化位的传感器数值带入第一区段号对应的角度与传感器数值的关系函数，得到第一角度；将第二区段号对应的变化位的传感器数值带入第二区段号对应的角度与传感器数值的关系函数，得到第二角度；对第一角度和第二角度加权平均，得到目标角度。在一个实施例中，如图13所示，提供了一种编码器，包括脉冲盘和电路模块，电路模块包括多个传感器、模/数转换器、处理器和存储器；传感器与模/数转换器电连接，处理器分别与模/数转换器和存储器电连接；多个传感器分布于脉冲盘的同一圆周上，脉冲盘与多个传感器能相对转动，多个传感器用于采集模拟信号；模/数转换器，用于将模拟信号采样并转换为数字信号，传输数字信号给处理器；处理器用于执行实现上述各实施例的角度编码器编码方法，和/或用于实现上述实施例的编码器解码方法的指令，存储器用于存储实现上述实施例中角度编码器编码方法，和/或编码器解码方法的程序。编码器中脉冲盘包含有两种条纹，正向条纹和负向条纹，条纹分布具备特定的规律；电路模块上的多个传感器分布于同一圆周上，其间距可均等也可不均等；脉冲盘与传感器组由被测物发生转动而产生相对转动，在相对转动的过程中，脉冲盘上的正负条纹可令电路模块上的传感器产生正向和负向的模拟信号。传感器与模/数转换器相连，模/数转换器与处理器相连，处理器与存储器相连。传感器采集到模拟信号后传输至模/数转换器，模/数转换器将模拟信号转换为数字信号，并传送给处理器按照上述实施例中的编码和/或解码方法进行处理其中，上述实施例中的编码和/或解码方法可存储在存储器中。本实施例中，传感器类型可为压力传感器、电压信号传感器、光场强度传感器、电场强度传感器、磁场强度传感器中的任一种。在一个实施例中，脉冲盘有两种条纹，并且设置为条纹的长度大于两个区段对应的长度，使得同一个传感器发生翻转的位置间隔至少两个区段，也就是说，相邻的三个区段中没有相同的发生翻转的传感器编号。在一个实施例中，电路模块中的模/数转换器的采样频率大于转速与区段的乘积。例如，当最高转速为30000rpm，区段数量为56，则需要保证模/数转换器的频率大于28khz，以保证在初始化运行后，模/数转换器本次采样对应的区段为上一次采样获取区段的相邻区段。上述实施例中，编码器通过脉冲盘条纹长度和模/数转换器采样频率的设置，同一传感器发生翻转的位置至少相隔两个区段以上，则相邻三个区段中，不会出现重复的变化位，进一步地，编码器在初始运行后，只需要转换和采样三个传感器数值即可得出本次运行的角度，并不需要转换所有传感器数值，加快了运算速度，提高了测量效率。在一个实施例中，提供了一种计算机可读存储介质，其上存储有计算机程序，计算机程序被处理器执行时实现上述实施例中的编码和/或解码方法。本申请所使用的对存储器、存储、数据库或其它介质的任何引用可包括非易失性和/或易失性存储器。非易失性存储器可包括ROM、PROM、EPROM、EEPROM或闪存。易失性存储器可包括RAM，它用作外部高速缓冲存储器。作为说明而非局限，RAM以多种形式可得，诸如SRAM、DRAM、SDRAM、双数据率DDRSDRAM、ESDRAM、SLDRAM、RDRAM、DRDRAM。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
