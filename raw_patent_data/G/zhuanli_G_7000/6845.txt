标题title
一种基于模板匹配的自适应运动想象脑机接口方法与系统
摘要abst
本发明公开一种基于模板匹配的自适应运动想象脑机接口方法与系统，包括以下步骤：先基于运动想象的脑电信号预处理与特征提取及优化，再基于自适应规则的模板匹配分类模型设计；本发明在采集到脑电信号后，先对脑电信号进行预处理，再对脑电信号进行特征提取和优化，接下来利用训练数据，以及外界辅助信息，并融合自适应规则，获得不同运动想象信号的模板信息，进而建立基于模板匹配的脑电信号分类模型，识别运动想象意图，通过基于模板匹配的自适应规则建立运动想象脑电信号识别模型，从而使得运动想象脑机接口在长期使用中都能稳定识别运动想象意图，同时为上肢运动解码的研究提供了新的思路，为人机协同交互的进一步研究提供了基础。
权利要求书clms
1.一种基于模板匹配的自适应运动想象脑机接口方法，其特征在于：包括以下步骤：步骤一：基于运动想象的脑电信号预处理与特征提取及优化先采集人脑指定电极位置的脑电信号，再将采集的脑电信号进行预处理，接着从预处理后的脑电信号中提取脑电信号特征信息，然后将提取的脑电信号特征信息进行优化；步骤二：基于自适应规则的模板匹配分类模型设计先获取外界辅助信息和识别模型识别结果，再根据优化后的脑电信号特征信息及外界辅助信息，自适应更新运动想象信号模板信息，然后根据模板信息建立基于模板匹配的运动想象信号分类模型。2.根据权利要求1所述的一种基于模板匹配的自适应运动想象脑机接口方法，其特征在于：所述步骤一中，所述预处理包括共空间模式滤波、基线修正、共平均参考和独立成分分析。3.根据权利要求1所述的一种基于模板匹配的自适应运动想象脑机接口方法，其特征在于：所述步骤一中，所述特征提取方法包括傅里叶变换和功率谱分析。4.根据权利要求1所述的一种基于模板匹配的自适应运动想象脑机接口方法，其特征在于：所述步骤一中，所述特征优化方法包括主成分分析和浮动前向搜索算法。5.根据权利要求1所述的一种基于模板匹配的自适应运动想象脑机接口方法，其特征在于：所述步骤二中，所述外界辅助信息包括环境反馈信息和任务完成信息。6.根据权利要求1所述的一种基于模板匹配的自适应运动想象脑机接口方法，其特征在于：所述步骤二中，所述分类模型建立方法采用模板匹配方法。7.一种基于模板匹配的自适应运动想象脑机接口系统，其特征在于，包括：提取模块，用于从运动想象任务过程中的神经信号中提取脑电信号特征信息；解码模块，用于利用提取的脑电信号特征信息对运动想象类别进行识别；自适应模块，用于实时更新识别模块中的模板信息，维持系统性能鲁棒。8.根据权利要求7所述的一种基于模板匹配的自适应运动想象脑机接口系统，其特征在于：所述提取模块包括采集单元、预处理单元和提取单元，所述采集单元用于采集人脑指定电极位置的脑电信号，所述预处理单元用于将采集的脑电信号进行预处理，所述提取单元用于从脑电信号中提取脑电信号特征信息。9.根据权利要求7所述的一种基于模板匹配的自适应运动想象脑机接口系统，其特征在于：所述解码模块包括构建模块和识别模块，所述构建模块用于利用提取的脑电信号特征信息建立运动想象脑电信号识别模型，所述识别模块用于根据运动想象脑电信号信号识别模型识别上肢运动方向。10.根据权利要求7所述的一种基于模板匹配的自适应运动想象脑机接口系统，其特征在于：所述自适应模块包括标定模块和自适应规则，所述标定模块用于根据外界辅助信息和识别模型识别结果，对脑电信号特征信息进行标定，所述自适应规则用于根据标定的脑电信号特征信息对运动想象脑电信号信号识别模型参数进行实时更新。
说明书desc
技术领域本发明涉及神经科学技术领域，尤其涉及一种基于模板匹配的自适应运动想象脑机接口方法与系统。背景技术运动意图解析是人机协同领域的一个重要研究内容，其中基于运动想象的脑机接口技术相较于其他方法，不需要外界的干扰刺激，能够更加自然的实现对人的运动意图解析，由于运动想象信号不依赖于实际的运动产生，基于运动想象的脑机接口技术能够更好的辅助无法运动的残障人士，同时由于大脑是人体的高级神经中枢，也是人体产生运动意图的起点，基于脑电皮层信号解析人的运动意图具有速度快、可靠性高的优点，同时，通过EEG信号解析运动方向意图，有助于对大脑神经科学的进一步探索，帮助认识大脑活动与实际运动的神经联系。目前，有很多基于EEG信号的运动想象解码的研究，2015年，Edelman和Baxter基于运动想象的BCI技术实现了对真实和虚拟设备的三维控制，2017年，Irimia和Cho研发了一套结合运动想象BCI技术、功能性电刺激和视觉反馈技术的感觉运动闭环治疗系统，用于中风后的康复训练，2019年，Korik等人通过解码运动想象EEG信号来在线控制两个3D虚拟手臂在空间中朝目标移动，取得了不错的分类效果。然而在目前的运动意图解码的研究中，由于脑电信号的非稳态特性，基于运动想象的脑机接口在长期使用中，性能会产生明显的下降，在实际的人机交互系统中，使用者需要长期使用脑机接口系统，而在每次使用前对脑机接口系统进行训练会极大的增加设备的使用成本，所以，需要寻找一种能够自主适应人体脑电信号变化，维持脑机接口性能稳定的方法，因此，本发明提出一种基于模板匹配的自适应运动想象脑机接口方法与系统以解决现有技术中存在的问题。发明内容针对上述问题，本发明的目的在于提出一种基于模板匹配的自适应运动想象脑机接口方法与系统，该方法在采集到脑电信号后，先对脑电信号进行预处理，再对脑电信号进行特征提取和优化，接下来利用训练数据，以及外界辅助信息，并融合自适应规则，获得不同运动想象信号的模板信息，进而建立基于模板匹配的脑电信号分类模型，识别运动想象意图，通过基于模板匹配的自适应规则建立运动想象脑电信号识别模型，从而使得运动想象脑机接口在长期使用中都能稳定识别运动想象意图。为了实现本发明的目的，本发明通过以下技术方案实现：一种基于模板匹配的自适应运动想象脑机接口方法与系统，包括以下步骤：步骤一：基于运动想象的脑电信号预处理与特征提取及优化先采集人脑指定电极位置的脑电信号，再将采集的脑电信号进行预处理，接着从预处理后的脑电信号中提取脑电信号特征信息，然后将提取的脑电信号特征信息进行优化；步骤二：基于自适应规则的模板匹配分类模型设计先获取外界辅助信息和识别模型识别结果，再根据优化后的脑电信号特征信息及外界辅助信息，自适应更新运动想象信号模板信息，然后根据模板信息建立基于模板匹配的运动想象信号分类模型。进一步改进在于：所述步骤一中，所述预处理包括共空间模式滤波、基线修正、共平均参考和独立成分分析。进一步改进在于：所述步骤一中，所述特征提取方法包括傅里叶变换和功率谱分析。进一步改进在于：所述步骤一中，所述特征优化方法包括主成分分析和浮动前向搜索算法。进一步改进在于：所述步骤二中，所述外界辅助信息包括环境反馈信息和任务完成信息。进一步改进在于：所述步骤二中，所述分类模型建立方法采用模板匹配方法。一种基于模板匹配的自适应运动想象脑机接口系统，包括：提取模块，用于从运动想象任务过程中的神经信号中提取脑电信号特征信息；解码模块，用于利用提取的脑电信号特征信息对运动想象类别进行识别；自适应模块，用于实时更新识别模块中的模板信息，维持系统性能鲁棒。进一步改进在于：所述提取模块包括采集单元、预处理单元和提取单元，所述采集单元用于采集人脑指定电极位置的脑电信号，所述预处理单元用于将采集的脑电信号进行预处理，所述提取单元用于从脑电信号中提取脑电信号特征信息。进一步改进在于：所述解码模块包括构建模块和识别模块，所述构建模块用于利用提取的脑电信号特征信息建立运动想象脑电信号识别模型，所述识别模块用于根据运动想象脑电信号信号识别模型识别上肢运动方向。进一步改进在于：所述自适应模块包括标定模块和自适应规则，所述标定模块用于根据外界辅助信息和识别模型识别结果，对脑电信号特征信息进行标定，所述自适应规则用于根据标定的脑电信号特征信息对运动想象脑电信号信号识别模型参数进行实时更新。本发明的有益效果为：本发明在采集到脑电信号后，先对脑电信号进行预处理，再对脑电信号进行特征提取和优化，接下来利用训练数据，以及外界辅助信息，并融合自适应规则，获得不同运动想象信号的模板信息，进而建立基于模板匹配的脑电信号分类模型，识别运动想象意图，通过基于模板匹配的自适应规则建立运动想象脑电信号识别模型，从而使得运动想象脑机接口在长期使用中都能稳定识别运动想象意图，这对构建一个可靠的BCI系统十分必要且关键，同时为上肢运动解码的研究提供了新的思路，为人机协同交互的进一步研究提供了基础。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1是本发明基于模板匹配的自适应运动想象脑机接口方法流程图；图2是本发明基于模板匹配的自适应运动想象脑机接口系统结构图；图3是本发明实施例中的试验范式流程图；图4是本发明实施例中受试者脑头皮指定电极位置图；图5是本发明实施例中试验的性能示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要说明的是，术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”、“第三”、“第四”等仅用于描述目的，而不能理解为指示或暗示相对重要性。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。参见图1，本实施例提供了一种基于模板匹配的自适应运动想象脑机接口方法，包括以下步骤：步骤一：基于运动想象的脑电信号预处理与特征提取及优化S1、数据采集：采集人脑指定电极位置的脑电信号作为原始脑电信号，脑电采集子系统实时采集的EEG信号表达为：Y＝T式中，yL表示第L个电极采集的EEG数据，t为采样时间点；S2、预处理：首先将原始脑电信号进行预处理，主要包括共空间模式滤波、基线修正和共平均参考；共空间模式滤波用于扩大两类信号差异，具体步骤如下：a1、整理EEG数据将所得的脑电信号标准化：式中，xi为随机样本变量，为样本均值，Si为样本标准差；a2、计算两类样本的协方差矩阵矩阵两类样本的协方差矩阵矩阵R1，R2由下式计算：a3、混合协方差矩阵矩阵式中，和分别为两类协方差矩阵的均值；a4、白化特征值矩阵P对混合协方差矩阵R进行特征值分解R＝UλUT式中，U是特征向量矩阵，λ是特征值构成的对角阵；将特征值降序排列，白化值矩阵为：a5、空间滤波器W对R1和R2做变换：S1＝PR1PT,S2＝PR2PT对S1和S2做主分量分解：S1＝B1λ1B1T,S2＝B2λ2B2T通过上式证明矩阵S1和S2的特征向量矩阵是相等的：B1＝B2＝V同时，两个特征值的对角阵λ1和λ2之和为单位矩阵，即：λ1+λ2＝I所以当S1特征值最大时S2最小，反之亦然。所得空间滤波器为：W＝BTP共平均参考用于滤除各个通道的共同噪音，其具体公式如下：基线修正用于去除零点漂移，其具体公式如下：S3、提取脑电信号特征：首先采用离散傅里叶变换将脑电信号的时域信息转换为频域信息，假设有一段长度为N的脑电信号x,则其离散傅里叶变换定义为：相应的，IDFT定义为：对于某一段信号进行傅里叶变换后，得到的数据是一个含有m个数据的一维向量，若采样频率为f，则傅里叶变换后第i个点的频率F为：将傅里叶变换后获得的频域信息按照8Hz-10Hz，10Hz-12Hz，12Hz-14Hz，14Hz-16Hz，16Hz-18Hz，18Hz-20Hz，20Hz-22Hz，22Hz-24Hz，24Hz-26Hz，26Hz-28Hz，28Hz-30Hz总共11个频带进行求和，每个通道获得11维的特征，总共34各通道，获得374维度的特征；S4、优化脑电信号特征：上述脑电信号特征维度过大，容易造成计算冗余，采用主成分分析的方法降低维度；主成分分析方法的具体计算步骤如下：A.计算相关系数矩阵R：式中，rij为变量指标xi与xj的相关系数，其计算公式为:式中，xki为第k个样本的第i个变量值，xkj为第k个样本的第j个变量值，为第i个变量在所有样本上的均值，为第i个变量在所有样本上的均值，n为样本个数，由于R是实对称矩阵，故只需计算其上三角元素即可；B.计算特征值与特征向量:先求解特征方程：|λI-R|＝0式中，I为单位矩阵，R为上述得到的相关系数矩阵，求得一系列特征值λi，并将特征值由大至小排列，即λ1≥λ2≥…≥λp≥0，然后求出每个特征值的特征向量ei；C.求出每个主成分的贡献率与累计贡献率，主成分Zi贡献率：式中，λi为第i个特征值，为前k个主成分的特征值之和，累计贡献率：式中，为前m个主成分的特征值之和，通常选择累计贡献率达85-95％的特征值λ1，λ2，…，λm对应的第1，第2，……，第m个主成分，通过计算各主成分的累计贡献率，选择累计贡献率达95％的主成分作为样本的特征；步骤二：基于自适应规则的模板匹配分类模型设计在步骤一中已经获得运动想象脑电信号的优化特征，接下来利用上述特征设计模板匹配分类器和对应的自适应规则，其中模板匹配分类器具体步骤为：b1.对每类运动想象脑电信号建立一个模板；b2.计算新输入样本与不同类别的脑电信号的模板的差值；b3.比较不同类别的差值大小，将新输入的样本标定差值最小的类别，并输出结果；其中自适应规则具体步骤下：c1.从每类运动想象脑电信号的特征中选取49个具有代表性的特征，建立每类信号的模板库，表达为7*7的类别特征矩阵，矩阵的每一个元素为一个特征向量；c2.根据辅助信息和分类器输出结果对输入样本标定；c3.在与标定对应的类别特征矩阵中寻找与输入样本的最佳匹配单元；c4.根据指定的规则修正类别特征矩阵：x＝x+αed-x)2+2≤5c5.更新分类器模板。参见图2，本实施例还提供了一种基于模板匹配的自适应运动想象脑机接口系统，包括：提取模块，用于从运动想象任务过程中的神经信号中提取脑电信号特征信息，提取模块包括采集单元、预处理单元和提取单元，采集单元用于采集人脑指定电极位置的脑电信号，预处理单元用于将采集的脑电信号进行预处理，提取单元用于从脑电信号中提取脑电信号特征信息；解码模块，用于利用提取的脑电信号特征信息对运动想象类别进行识别，解码模块包括构建模块和识别模块，构建模块用于利用提取的脑电信号特征信息建立运动想象脑电信号识别模型，识别模块用于根据运动想象脑电信号信号识别模型识别上肢运动方向；自适应模块，用于实时更新识别模块中的模板信息，维持系统性能鲁棒，自适应模块包括标定模块和自适应规则，标定模块用于根据外界辅助信息和识别模型识别结果，对脑电信号特征信息进行标定，自适应规则用于根据标定的脑电信号特征信息对运动想象脑电信号信号识别模型参数进行实时更新。为了验证实验效果，本发明采取了多次长时间实验的方式，对实验效果进行了证实，具体实验内容如下：在实验过程中，受试者被要求始终紧盯屏幕，以避免眼球运动，实验共分为四次，实验范式参照图3所示，每次实验中，实验者被随机要求执行左手的运动想象任务或者右手的运动想象任务，经过8秒的运动想象任务后，进行5秒的休息，然后执行下一轮实验，每次实验采集80轮数据，四次实验分别在不同的时间进行。通过脑电采集系统采集受试者脑头皮指定电极位置的脑电信号，并通过脑电放大器放大并输出所采集到的受试者原始脑电信号。脑电采集仪用于实时采集脑电信号并且进行放大和模数转换，通过数据线与处理器进行数据传输，其中，考虑到大脑运动想象任务，主要涉及运动和认知相关皮层，因此本实施例根据“10-20国际标准导联”，将脑电采集电极放置在使用者头部的Cz、C1、C2、C3、C4、C5、C6、T7、T8、Fz、F1、F2、F3、F4、F5、F6、F7、F8、FCz、FC3、FC4、CP3、CP4、Oz、O1、O2、POz、Pz、P3、P4、P5、P6、P7、P8位置，将参考电极放置在CPz位置，接地电极放置在AFz位置，各电极位置参照图4所示。本发明研究了一种基于模板匹配的自适应运动想象脑机接口方法与系统，提出了一种能够在长时间使用中能够维持系统性能鲁棒的脑机接口，在长期使用中，该脑机接口系统的性能能为维持在较好的水平，不会出现明显的性能下降，如图5所示。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
