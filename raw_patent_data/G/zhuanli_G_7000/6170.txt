标题title
一种动态图链接生成方法
摘要abst
本发明公开了一种动态图链接生成方法，所述方法包括：获取不同时刻的快照图；将所述不同时刻的快照图，输入至预设的生成对抗图胶囊网络模型中，得到下一时刻快照图之间的链接；其中，所述生成对抗图胶囊网络模型基于生成对抗网络进行双重训练得到的，所述生成对抗图胶囊网络模型采用样本集进行训练，所述样本集是基于每个动态离散快照图对应生成的拓扑结构得到的；所述生成对抗网络包括生成器和鉴别器，所述鉴别器用于对真实数据和生成的数据进行鉴别判断；所述生成器用于生成下一时刻快照图的拓扑结构。
权利要求书clms
1.一种动态图链接生成方法，其特征在于，所述方法包括：获取不同时刻的快照图；将所述不同时刻的快照图，输入至预设的生成对抗图胶囊网络模型中，得到下一时刻快照图之间的链接；其中，所述生成对抗图胶囊网络模型是基于生成对抗网络进行双重训练得到的，所述生成对抗图胶囊网络模型采用样本集进行训练，所述样本集是基于每个动态离散快照图对应生成的拓扑结构得到的；所述生成对抗网络包括生成器和鉴别器，所述鉴别器用于对真实数据和生成的数据进行鉴别判断；所述生成器用于生成下一时刻快照图的拓扑结构。2.根据权利要求1所述的动态图链接生成方法，其特征在于，所述生成器包括结构化编码器和时序编码器，所述结构化编码器通过连续的时间步长在节点间传播时间信息，所述时序编码器用于增强所有节点表示在连续时间步长中的非线性依赖性。3.根据权利要求1所述的动态图链接生成方法，其特征在于，生成对抗图胶囊网络模型的训练方法包括：构建初始生成对抗图胶囊网络模型；基于所述初始生成对抗图胶囊网络模型，对所述样本集中的动态离散快照图进行编码，生成样本集的下一时刻快照图的拓扑结构；基于所述下一时刻快照图的拓扑结构，采用双重训练方式对初始生成对抗图胶囊网络模型进行训练，得到所述生成对抗图胶囊网络模型。4.根据权利要求1所述的动态图链接生成方法，其特征在于，拓扑结构的生成方法包括：编码不同时刻快照图的结构信息，以生成消息传递之后的快照图表示；对结构编码之后的快照图表示进行时序编码，利用时序信息生成下一时刻快照图的拓扑结构。5.根据权利要求4所述的动态图链接生成方法，其特征在于，所述编码不同时刻快照图的结构信息包括：输入预处理的不同时刻的快照图；不同快照图节点时序信息传递；对时序信息传递之后的快照图进行结构化编码。6.根据权利要求5所述的动态图链接生成方法，其特征在于，所述不同快照图节点时序信息传递包括：采用门控循环单元递归神经网络，通过连续时间步长在节点间传播时间信息，使得当前时间步长中的节点保存前一时间步长中的节点信息，增强节点前后之间的关联和特征信息，具体公式如下所示：；其中，是增强之后在/＞时刻的节点表示；/＞和/＞表示在/＞时刻和/＞时刻的节点初始表示；/＞表示GRU在/＞时刻输出的隐藏状态向量；/＞是一个超参数，用于加权和。7.根据权利要求5所述的动态图链接生成方法，其特征在于，所述对时序信息传递之后的快照图进行结构化编码包括：使用图卷积神经网络对动态图中每张快照图的局部拓扑进行结构编码，具体公式如下所示：；其中,表示结构化编码后在/＞时刻的节点表示；/＞表示邻接矩阵，/＞是/＞的归一化表示；/＞是增强之后在/＞时刻的节点表示；/＞表示权重矩阵；/＞表示激活函数。8.根据权利要求4所述的动态图链接生成方法，其特征在于，对结构编码之后的快照图表示进行时序编码，利用时序信息生成下一时刻快照图的拓扑结构包括：编码不同时刻快照图的时序信息；解码时序信息生成下一时刻的拓扑结构。9.根据权利要求8所述的动态图链接生成方法，其特征在于，所述编码不同时刻快照图的时序信息包括：将结构化编码后的不同时刻的快照图表示作为输入，使用长短期记忆递归神经网络捕获动态图在潜在空间的演化模式；最后通过长短期记忆递归神经网络学习到长期依赖关系，生成下一时刻的快照图表示，具体公式如下所示：；其中,和/＞表示在/＞时刻和/＞时刻LSTM的隐藏状态的向量表示，/＞表示结构化编码后在/＞时刻的节点表示。10.根据权利要求9所述的动态图链接生成方法，其特征在于，所述解码时序信息生成下一时刻的拓扑结构包括：利用长短期记忆递归神经网络的每个隐藏状态来预测下一个时间的二值邻接矩阵，具体公式如下：；其中，表示两个具有相同结构的FC；/＞表示两个FC的权重；/＞表示两个FC的输出，/＞是/＞时刻LSTM的隐藏状态的向量表示，/＞表示激活函数，/＞表示在/＞时刻预测的快照图拓扑表示，符号/＞表示矩阵的转置；使用二元交叉熵函数作为损失函数来训练长短期记忆递归神经网络，损失函数如下所示：；其中，表示时间步长数，/＞表示每个快照图的节点个数，/＞表示对应/＞时刻的时间戳，/＞表示行，/＞表示列，/＞表示在/＞时刻真实数据的邻接矩阵在第/＞行第/＞列的元素，/＞表示在/＞时刻生成数据的邻接矩阵在第/＞行第/＞列的元素。
说明书desc
技术领域本发明涉及一种动态图链接生成方法，属于动态图链接预测技术领域。背景技术现实世界中，描述图的节点间关系的数据应用非常广泛，例如在推荐系统中，通过分析用户和物品之间的关系变化，可以为用户提供更准确的推荐；在社交网络关系预测中，考虑用户之间的通信历史、生活状态和环境等因素，能更好地预测未来关系的变化。许多情况下，图是动态变化的，节点和链接会随时间出现或消失。因此，动态图表示学习的研究在分析复杂的网络起着至关重要作用。其中，动态图链接预测是动态图表示学习中的一个重要任务，其目的是根据历史拓扑结构预测未来特定时间步骤中可能的联系；针对该任务，现有方法主要有基于矩阵分解和基于深度学习两种方法。首先，基于矩阵分解的动态图链接预测具有计算效率高的优势。然而，这些方法依赖于繁琐且容易出错的手工特征，这导致它们无法从动态网络中自动提取动态的特征。此外，以往的许多方法都是基于典型的线性模型，无法处理动态网络的非线性和复杂性。其次，基于深度学习的模型通过自动探索动态图的复杂非线性特征，对动态图链接预测的性能有了明显的改善。这些方法通过探索每个时间戳的静态网络的空间特征，并通过循环神经网络模拟整个时变动态网络的网络演变模式。然而，这只是捕获动态图中的短期依赖关系。在现实世界中，动态图中通常包含复杂而独特的空间关联性。发明内容本发明的目的在于提供一种动态图链接生成方法，以解决如何在静态图链接预测任务中引入时序信息并捕获其动态行为。本发明公开了一种动态图链接生成方法，所述方法包括：获取不同时刻的快照图；将所述不同时刻的快照图，输入至预设的生成对抗图胶囊网络模型中，得到下一时刻快照图之间的链接；其中，所述生成对抗图胶囊网络模型是基于生成对抗网络进行双重训练得到的，所述生成对抗图胶囊网络模型采用样本集进行训练，所述样本集是基于每个动态离散快照图对应生成的拓扑结构得到的；所述生成对抗网络包括生成器和鉴别器，所述鉴别器用于对真实数据和生成的数据进行鉴别判断；所述生成器用于生成下一时刻快照图的拓扑结构。进一步地，所述生成器包括结构化编码器和时序编码器，所述结构化编码器通过连续的时间步长在节点间传播时间信息，所述时序编码器用于增强所有节点表示在连续时间步长中的非线性依赖性。进一步地，生成对抗图胶囊网络模型的训练方法包括：构建初始生成对抗图胶囊网络模型；基于所述初始生成对抗图胶囊网络模型，对所述样本集中的动态离散快照图进行编码，生成样本集的下一时刻快照图的拓扑结构；基于所述下一时刻快照图的拓扑结构，采用双重训练方式对初始生成对抗图胶囊网络模型进行训练，得到所述生成对抗图胶囊网络模型。进一步地，拓扑结构的生成方法包括：编码不同时刻快照图的结构信息，以生成消息传递之后的快照图表示；对结构编码之后的快照图表示进行时序编码，利用时序信息生成下一时刻快照图的拓扑结构。进一步地，所述编码不同时刻快照图的结构信息包括：输入预处理的不同时刻的快照图；不同快照图节点时序信息传递；对时序信息传递之后的快照图进行结构化编码。进一步地，所述不同快照图节点时序信息传递包括：采用门控循环单元递归神经网络，通过连续时间步长在节点间传播时间信息，使得当前时间步长中的节点保存前一时间步长中的节点信息，增强节点前后之间的关联和特征信息，具体公式如下所示：；其中，是增强之后在/＞时刻的节点表示；/＞和/＞表示在/＞时刻和/＞时刻的节点初始表示；/＞表示GRU在/＞时刻输出的隐藏状态向量；/＞是一个超参数，用于加权和。进一步地，所述对时序信息传递之后的快照图进行结构化编码包括：使用图卷积神经网络对动态图中每张快照图的局部拓扑进行结构编码，具体公式如下所示：；其中,表示结构化编码后在/＞时刻的节点表示；/＞表示邻接矩阵，/＞是/＞的归一化表示；/＞是增强之后在/＞时刻的节点表示；/＞表示权重矩阵；/＞表示激活函数。进一步地，对结构编码之后的快照图表示进行时序编码，利用时序信息生成下一时刻快照图的拓扑结构包括：编码不同时刻快照图的时序信息；解码时序信息生成下一时刻的拓扑结构。进一步地，所述编码不同时刻快照图的时序信息包括：将结构化编码后的不同时刻的快照图表示作为输入，使用长短期记忆递归神经网络捕获动态图在潜在空间的演化模式；最后通过长短期记忆递归神经网络学习到长期依赖关系，生成下一时刻的快照图表示，具体公式如下所示：；其中,和/＞表示在/＞时刻和/＞时刻LSTM的隐藏状态的向量表示，/＞表示结构化编码后在/＞时刻的节点表示。进一步地，所述解码时序信息生成下一时刻的拓扑结构包括：利用长短期记忆递归神经网络的每个隐藏状态来预测下一个时间的二值邻接矩阵，具体公式如下：；其中，表示两个具有相同结构的FC；/＞表示两个FC的权重；/＞表示两个FC的输出，/＞是/＞时刻LSTM的隐藏状态的向量表示，/＞表示激活函数，/＞表示在/＞时刻预测的快照图拓扑表示，符号/＞表示矩阵的转置；使用二元交叉熵函数作为损失函数来训练长短期记忆递归神经网络，损失函数如下所示：；其中，表示时间步长数，/＞表示每个快照图的节点个数，/＞表示对应/＞时刻的时间戳，/＞表示行，/＞表示列，/＞表示在/＞时刻真实数据的邻接矩阵在第/＞行第/＞列的元素，/＞表示在/＞时刻生成数据的邻接矩阵在第/＞行第/＞列的元素。与现有技术相比，本发明所达到的有益效果：本发明针对输入的不同时刻的快照图，不仅可以有效地捕获到动态图中的时序信息，同时还对动态图中的非线性和复杂性进行了建模，生成了用于动态图链接预测的高质量动态图拓扑表示；本方法最终会通过生成对抗网络的方式来预测该网络在下一时刻的拓扑结构。附图说明图1是本发明的整体流程图；图2是本发明具体的工作流程图；图3是本发明基于生成对抗图胶囊网络的框图。具体实施方式为使本发明实现的技术手段、创作特征、达成目的与功效易于明白了解，下面结合具体实施方式，进一步阐述本发明。如图1所示，公开了一种动态图链接生成方法，所述方法包括：获取不同时刻的快照图；将所述不同时刻的快照图，输入预设的生成对抗图胶囊网络模型中，得到下一时刻快照图之间的链接；不同时刻的快照图输入到生成对抗图胶囊网络模型中的具体处理方法包括：S1、将每一时刻的快照图拓扑特征和节点特征作为输入，编码不同时刻快照图的结构信息，以生成消息传递之后的快照图表示；S2、对结构编码之后的快照图表示进行时序编码，利用时序信息生成下一时刻快照图的拓扑结构；S3、将生成的下一时刻的快照图拓扑与真实值进行对抗训练，优化预测值和真实值之间的损失，最终生成准确的下一时刻的快照图的之间的链接；S4、在数据集USCB和SYN上进行实验分析。方法流程图如图2所示。下面对每个步骤进行详细的介绍：S1、结构化编码生成消息传递之后的快照图表示S11、输入预处理的不同时刻的快照图如图3所示，本发明的模型的输入是在时刻上的快照图，其中主要包含两个部分：一方面是/＞时刻快照图的拓扑结构信息/＞；另一方面是/＞时刻快照图节点的特征信息/＞。在本发明中将/＞设为生成网络的噪声输入，其数值分布是符合均匀分布的。S12、不同快照图节点时序信息的传递如果忽略动态网络中信息丰富的时间路径特征，设计的模型可能会失去重要的方面，例如信息通过时间相关路径从一个节点传播到另一个节点的可能性。此外，先前的研究讨论了链接形成中依赖关系的重要性，并表明节点链接的趋势不能独立于先前连接的节点进行建模。时间路径生成不能仅由GCN解决，因为消息传播过程在每个时间步单独存在，并且跨顺序时间步长的节点之间可能没有连接。为了解决不同时刻节点之间的动态连接性，该发明采用的方法不仅在每个时间步长中在图的拓扑中传播消息，而且还在图演化的一个时间窗口传播消息。为此使用循环神经网络在模型中添加了一个节点时间消息传播模块。引入，通过连续时间步长在节点间传播时间信息。在每个时间步长节点输入到GCN前，使用前一个时间步长的节点的初始状态与当前时间步长的节点初始化状态进行一个加权，使得当前时间步长中的节点保存前一时间步长中的节点信息，增强节点前后之间的关联，丰富节点的特征信息。具体表达式如下所示：；其中，是增强之后在/＞时刻的节点表示；/＞和/＞表示在/＞时刻和/＞时刻的节点初始表示；/＞表示GRU在/＞时刻输出的隐藏状态向量；/＞是一个超参数，用于加权和。S13、结构化编码该发明利用GCN对动态网络中每张图快照的局部拓扑结构进行建模。其中，GCN由多层图卷积组成，它类似于感知器，但它还有一个由谱卷积驱动的邻域聚集功能。在时刻，以邻接矩阵/＞和节点表示矩阵/＞作为输入，使用权重矩阵/＞将节点表示矩阵更新为/＞作为输出。具体表达式如下所示：；其中，表示结构化编码后在/＞时刻快照图的节点表示；/＞表示邻接矩阵，/＞是/＞的归一化表示，即/＞；/＞是增强之后在/＞时刻的节点表示；/＞表示权重矩阵；/＞表示激活函数。S2、时序编码生成下一时刻快照图的拓扑结构时间信息对于动态图表示也是必不可少的。通常，时间信息由时间平滑假设保存。它假设网络随时间平稳发展，而不是在每个时间步随机重建。通常没有对潜在空间中节点位置的演化施加严格的限制，因为某些节点的结构可能会急剧演化。该发明将S1生成的快照图表示馈送到LSTM层并且要求LSTM隐藏状态具有逐步预测的能力。具体由以下两个步骤组成：S21、编码不同时刻快照图的时序信息该发明的时序编码的输入是包含个时间步长的快照图表示。LSTM被用于拟合潜在空间并且汇总时间网络的演化。如S1所述，观察到的网络快照图已经被GCN编码到潜在空间中，然后每个节点表示矩阵将被重塑为行向量，因为后续模块的输入数据通常是向量形式。接下来，将向量序列输入 LSTM 网络以学习网络演化模式。对于每个，每个LSTM单元将/＞的隐藏状态和节点嵌入向量/＞作为输入，然后输出/＞的隐藏状态。最后通过LSTM学习到长期依赖关系，生成下一时刻的快照图表示。具体公式如下所示：；其中，和/＞表示在/＞时刻和/＞时刻LSTM的隐藏状态的向量表示，/＞表示结构化编码后在/＞时刻的节点表示。S22、解码时序信息生成下一时刻的拓扑结构在每个时间步长中，为了预测下一个网络快照，解码器应输出下一时刻动态图的拓扑结构。一种直接的方法是通过神经网络预测/＞。然而，在如此高维空间中操作会导致不必要的开销，同时不能够有效的建模动态图的复杂性。为了解决这个问题，隐藏状态，隐藏维度为 /＞，然后被送入两个独立的全连接层。这些FC的输出将被重新整形为大小为 /＞ 的矩阵，其中 /＞ 是嵌入维度。然后该模型使用两个矩阵之间的内积来预测下一个网络快照。形式上，这样的过程可以描述如下：；其中，表示两个具有相同结构的FC；/＞表示两个FC的权重；/＞表示这两个FC的输出。/＞是/＞时刻LSTM的隐藏状态的向量表示，/＞表示激活函数，/＞表示在/＞时刻预测的快照图拓扑表示，符号/＞表示矩阵的转置。将动态图链接预测任务看作是二分类问题，然后使用二元交叉熵函数作为损失函数来训练LSTM。损失函数如下所示：；其中，表示时间步长数，/＞表示每个快照图的节点个数，/＞表示对应/＞时刻的时间戳，/＞表示行，/＞表示列，/＞表示在/＞时刻真实数据的邻接矩阵在第/＞行第/＞列的元素，/＞表示在/＞时刻生成数据的邻接矩阵在第/＞行第/＞列的元素。S3、使用胶囊网络优化真实值和预测值之间的损失与标准GAN框架一样，该发明也优化了两个神经网络，并采用极小极大互相博弈。在模型中，D试图将训练数据中的实图快照与G生成的快照区分开来，而G最大限度地提高了D出错的概率。希望这个对抗过程最终能够调整G，以产生可信的、高质量的拓扑结构表示。步骤S3具体由以下三个步骤组成：S31、使用胶囊网络作为鉴别器本发明采用胶囊网络作为鉴别器，其能够从不同的视角来鉴别真实值和预测值之间的差异。在训练过程中，D交替使用G的预测值或真实值作为输入。然后本发明使用两个类胶囊作为输出来描述是真实值还是预测值。最后使用边缘损失函数来优化胶囊网络。具体公式如下：；；其中，为真实值或预测值；/＞为最终输出的类胶囊；/＞为目标值；/＞；/＞；/＞是一个用于防止初始学习在最后一层收缩类胶囊长度的降权因子。S32、将S1和S2中的模块看作是生成器如图3所示，生成器由GCN层、LSTM层和时序解码层组成。GCN层以快照图拓扑结构以及噪声/＞作为输入，输出使用来表示，并将其馈入LSTM层。其中，每个邻接矩阵/＞在被馈送到GCN层之前，都需要归一化为/＞范围。LSTM层以GCN层给出的快照图表示/＞为输入，输出隐藏状态/＞。最后，将隐藏状态/＞馈入时序解码层，生成下一时刻的图形快照图拓扑表示/＞。本实施例中，如图3所示，生成对抗图胶囊网络模型基于生成对抗网络进行双重训练得到的，训练方法如下：构建初始生成对抗图胶囊网络模型；基于所述初始生成对抗图胶囊网络模型，对所述样本集中的动态离散快照图进行编码，生成样本集的下一时刻快照图的拓扑结构；基于所述下一时刻快照图的拓扑结构，采用双重训练方式对初始生成对抗图胶囊网络模型进行训练，得到所述生成对抗图胶囊网络模型；采用生成对抗网络训练的方式进行训练。本发明采用生成对抗网络的训练方式进行双重训练，首先利用梯度下降法更新鉴别器的参数，通过以下损失函数固定生成器的参数：；更新鉴别器的参数之后，固定鉴别器的参数。然后，更新生成器的参数。为了使得预测结果尽可能接近真实值，在生成器的损失函数加入步骤S22中的二元交叉熵损失函数。具体公式如下：。S4、在数据集USCB和SYN上进行实验分析S41、数据集USCB和SYN的概述USCB是用于测量无线网状网络中链接质量的数据集。其中的节点代表电脑主机，链接的权重表示两个主机之间在某个时间段内的流量或者链接质量。为了生成一个无权无向图，该发明设定了一个质量阈值，当链接的权重大于阈值时设为1，否则设为0。SYN是使用随机区块模型生成的合成动态图。动态图的第一个快照被生成为有两个大小相等的社区，块内概率为0.2，跨块概率为0.01。为了生成后续的图，该发明在每个时间步骤中随机挑选节点并将它们移到另一个社区。本发明将USCB和SYN每个数据集划分为两个部分：90%作为训练集，10%作为测试集。同时，再划分的过程中测试集的时间是在训练集时间之后的。S42、实验评价指标本发明采用MSE和AUC两个标准来评价模型的性能。MSE是最常见的评价指标之一，它通过逐点比较预测值和真实值的距离得到模型性能的量化结果，MSE值越小表示预测值和真实值越接近。AUC是ROC曲线下的面积，而ROC曲线的横纵坐标是由真阳性率和伪阳性率构成。AUC值越大表示当前的分类器越有可能将正样本排在负样本的前面，从而说明模型的分类效果更好。S43、和现有的模型进行对比和分析为了验证该发明的泛化能力，该发明与下面四个模型进行比较，即GCN-GRU、EnvolveGCN、GCN-GAN、LPMDG。实验结果AUC和MSE的值如表1所示：表1通过对比可以发现，本发明的效果在USCB和SYN数据集上优于上述四种模型，这是因为本发明不仅在结构化编码时捕获每个时刻节点的时序信息，还在时序编码时捕获每个时刻链接的时序信息，从而有效地建模了动态图中的非线性和复杂性。反观其他模型，它们只考虑了消息传递之后节点的时序信息，忽略了节点的动态连接性和链接的时序性。本发明采用实例证明所预测的动态图链接是有效的。总共选择了两个基准数据集，包括无线网状网络数据集USCB和模拟社区演化图SYN。对于每个数据集中的动态图数据，本发明的方法都可以正确的预测下一时刻的快照图中节点之间的链接。这证明本发明锁生成的动态图拓扑结构表示是准确且有意义的。以上所述仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明技术原理的前提下，还可以做出若干改进和变形，这些改进和变形也应视为本发明的保护范围。
