标题title
手持式摄像镜数据处理方法及装置
摘要abst
本发明提供一种手持式摄像镜数据处理方法及装置，包括：预先配置至少两个模糊核，其中每个模糊核具有不同的模糊权重；获取当前时刻手持式摄像镜中的模糊图像，对模糊图像以RGB值的形式显示；基于模糊图像确定手持式摄像镜所处的环境信息，根据环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围；基于适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像。通过设置多个具有不同模糊权重的模糊核对不同场景下的模糊图像进行处理，使得到的复原图像更加的准确，与实际场景更加接近。并且能够根据不同的环境确定适配模糊核的范围，达到对模糊图像进行分情况、分区域处理的目的，提高了复原图像的复原匹配度。
权利要求书clms
1.一种手持式摄像镜数据处理方法，其特征在于，包括：预先配置至少两个模糊核，其中每个模糊核具有不同的模糊权重；获取当前时刻手持式摄像镜中的模糊图像，对所述模糊图像以RGB值的形式显示；基于所述模糊图像确定手持式摄像镜所处的环境信息，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围；基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像。2.根据权利要求1所述的手持式摄像镜数据处理方法，其特征在于，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围包括：判断所述环境信息为第一形式则选择第一形式对应的适配模糊核；将所述模糊图像划分为多个区域，统计每个区域内所有像素点的区域RGB值；若存在任意两个区域RGB值的比对结果大于区域预设值，则所述适配模糊核的范围为第一范围；若任意两个区域RGB值的比对结果小于区域预设值，则所述适配模糊核的范围为第二范围。3.根据权利要求2所述的手持式摄像镜数据处理方法，其特征在于，所述第一范围小于所述第二范围。4.根据权利要求2所述的手持式摄像镜数据处理方法，其特征在于，基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像包括：选定模糊图像中的任意一个像素点作为待处理像素点，以所述待处理像素点为中心确定适配模糊核的范围内所有像素点的中心平均RGB值；将所述中心平均RGB值作为所述待处理像素点的新的RGB值以得到复原图像。5.根据权利要求4所述的手持式摄像镜数据处理方法，其特征在于，以所述待处理像素点为中心确定适配模糊核的范围内所有像素点的中心平均RGB值包括：通过以下公式计算所述中心平均RGB值，其中，Mp为适配模糊核的范围内重第p个点的RGB值，q为适配模糊核的范围内像素点的数量，R1为拍摄时刻的瞬时加速度，R2为预设加速度，A为放大系数，L为调整系数，为模糊权重。6.根据权利要求5所述的手持式摄像镜数据处理方法，其特征在于，基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像包括：对所述调整系数L进行预设次数的调整生成集合I＝，基于所述集合I生成多个复原图像；获取用户选定的复原图像对应的调整系数lm，在下次生成复原图像时以所述lm为中心得到新的集合I新，基于所述集合I新生成多个复原图像。7.根据权利要求6所述的手持式摄像镜数据处理方法，其特征在于，任意两个相邻的调整系数之间相差预设值差值。8.根据权利要求1所述的手持式摄像镜数据处理方法，其特征在于，基于所述模糊图像确定手持式摄像镜所处的环境信息包括：通过以下公式计算模糊图像的总平均RGB值，其中，Y为模糊图像中的像素点数量，Xi为第i个像素点的RGB值，S为模糊图像的总平均RGB值；判断所述S大于平均预设值，则所述环境信息为第一形式；判断所述S小于平均预设值，则所述环境信息为第二形式。9.一种手持式摄像镜数据处理装置，其特征在于，包括：配置模块，用于预先配置至少两个模糊核，其中每个模糊核具有不同的模糊权重；显示模块，用于获取当前时刻手持式摄像镜中的模糊图像，对所述模糊图像以RGB值的形式显示；选择模块，用于基于所述模糊图像确定手持式摄像镜所处的环境信息，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围；复原模块，用于基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像。10.一种可读存储介质，其特征在于，所述可读存储介质中存储有计算机程序，所述计算机程序被处理器执行时用于实现权利要求1至8任一所述的方法。
说明书desc
技术领域本发明涉及手持式摄像镜、数据处理技术领域，尤其涉及一种手持式摄像镜数据处理方法及装置。背景技术随机时代的发展、科技的进步，越来越多的智能设备、工具被研发、开发。手持式摄像镜、摄像机就是其中一个智能设备。由于手持式摄像镜方便把持、携带，使用者可以不受环境限制使用该手持式摄像镜。但是在手持式摄像镜的使用过程中，拍摄人员可能会出现手抖的情况，会导致手持式摄像镜的图像出现模糊的情况。发明内容本发明实施例提供一种手持式摄像镜数据处理方法及装置，能够对手持式摄像镜拍摄的模糊图像进行处理，对模糊图像完成复原，提高了手持式摄像镜的使用效果。本发明实施例的第一方面，提供一种手持式摄像镜数据处理方法，包括：预先配置至少两个模糊核，其中每个模糊核具有不同的模糊权重；获取当前时刻手持式摄像镜中的模糊图像，对所述模糊图像以RGB值的形式显示；基于所述模糊图像确定手持式摄像镜所处的环境信息，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围；基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像。可选地，在第一方面的一种可能实现方式中，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围包括：判断所述环境信息为第一形式则选择第一形式对应的适配模糊核；将所述模糊图像划分为多个区域，统计每个区域内所有像素点的区域RGB值；若存在任意两个区域RGB值的比对结果大于区域预设值，则所述适配模糊核的范围为第一范围；若任意两个区域RGB值的比对结果小于区域预设值，则所述适配模糊核的范围为第二范围。可选地，在第一方面的一种可能实现方式中，所述第一范围小于所述第二范围。可选地，在第一方面的一种可能实现方式中，基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像包括：选定模糊图像中的任意一个像素点作为待处理像素点，以所述待处理像素点为中心确定适配模糊核的范围内所有像素点的中心平均RGB值；将所述中心平均RGB值作为所述待处理像素点的新的RGB值以得到复原图像。可选地，在第一方面的一种可能实现方式中，以所述待处理像素点为中心确定适配模糊核的范围内所有像素点的中心平均RGB值包括：通过以下公式计算所述中心平均RGB值，其中，Mp为适配模糊核的范围内重第p个点的RGB值，q为适配模糊核的范围内像素点的数量，R1为拍摄时刻的瞬时加速度，R2为预设加速度，A为放大系数，L为调整系数，为模糊权重。可选地，在第一方面的一种可能实现方式中，基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像包括：对所述调整系数L进行预设次数的调整生成集合I＝，基于所述集合I生成多个复原图像；获取用户选定的复原图像对应的调整系数lm，在下次生成复原图像时以所述lm为中心得到新的集合I新，基于所述集合I新生成多个复原图像。可选地，在第一方面的一种可能实现方式中，任意两个相邻的调整系数之间相差预设值差值。可选地，在第一方面的一种可能实现方式中，基于所述模糊图像确定手持式摄像镜所处的环境信息包括：通过以下公式计算模糊图像的总平均RGB值，其中，Y为模糊图像中的像素点数量，Xi为第i个像素点的RGB值，S为模糊图像的总平均RGB值；判断所述S大于平均预设值，则所述环境信息为第一形式；判断所述S小于平均预设值，则所述环境信息为第二形式。本发明实施例的第二方面，提供一种手持式摄像镜数据处理装置，包括：配置模块，用于预先配置至少两个模糊核，其中每个模糊核具有不同的模糊权重；显示模块，用于获取当前时刻手持式摄像镜中的模糊图像，对所述模糊图像以RGB值的形式显示；选择模块，用于基于所述模糊图像确定手持式摄像镜所处的环境信息，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围；复原模块，用于基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像。本发明实施例的第三方面，提供一种可读存储介质，所述可读存储介质中存储有计算机程序，所述计算机程序被处理器执行时用于实现本发明第一方面及第一方面各种可能设计的所述方法。本发明提供的一种手持式摄像镜数据处理方法及装置，通过设置多个具有不同模糊权重的模糊核对不同场景下的模糊图像进行处理，使得到的复原图像更加的准确，与实际场景更加接近。并且能够根据不同的环境确定适配模糊核的范围，达到对模糊图像进行分情况、分区域处理的目的，使得复原图像中各个像素点的RGB值更加符合现实场景，提高了复原图像的复原匹配度。本发明会根据模糊图像的像素值判断手持式摄像镜所处环境的环境信息，根据换寂静信息确定适配模糊核的范围，使得在不同环境下，复原图像中每个像素点的复原路径、复原比例都是不同的，保障复原图像实际场景更加的接近，保障复原图像的平滑性。本发明在得到复原图像的过程中，不仅考虑手持式摄像镜当前所处的环境，还会综合考虑手抖的幅度、手持式摄像镜的放大倍数等等，根据手抖的幅度、手持式摄像镜的放大倍数对像素点的RGB值的变化趋势进行指导，保障了复原图像更加的真实。本发明采用深度学习技术，可以根据用户反馈，对模糊权重进行调整。并且在生成复原图像时会生成多个复原图像，用户根据会根据实际场景选择最近接的复原图像，将用户选择的复原图像所对应的调整系数作为中心得到新的集合，以此达到对模糊权重进行更新、训练的目的。进而保障本发明提供的方法能够进行反馈进行主动调整，提高复原图像的复原精度。附图说明图1为手持式摄像镜数据处理方法的流程图；图2为模糊图像的分区域示意图；图3为手持式摄像镜数据处理装置的结构图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”、“第三”“第四”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。应当理解，在本发明的各种实施例中，各过程的序号的大小并不意味着执行顺序的先后，各过程的执行顺序应以其功能和内在逻辑确定，而不应对本发明实施例的实施过程构成任何限定。应当理解，在本发明中，“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。应当理解，在本发明中，“多个”是指两个或两个以上。“和/或”仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。字符“/”一般表示前后关联对象是一种“或”的关系。“包含A、B和C”、“包含A、B、C”是指A、B、C三者都包含，“包含A、B或C”是指包含A、B、C三者之一，“包含A、B和/或C”是指包含A、B、C三者中任1个或任2个或3个。应当理解，在本发明中，“与A对应的B”、“与A相对应的B”、“A与B相对应”或者“B与A相对应”，表示B与A相关联，根据A可以确定B。根据A确定B并不意味着仅仅根据A确定B，还可以根据A和/或其他信息确定B。A与B的匹配，是A与B的相似度大于或等于预设的阈值。取决于语境，如在此所使用的“若”可以被解释成为“在……时”或“当……时”或“响应于确定”或“响应于检测”。下面以具体地实施例对本发明的技术方案进行详细说明。下面这几个具体的实施例可以相互结合，对于相同或相似的概念或过程可能在某些实施例不再赘述。本发明提供一种手持式摄像镜数据处理方法，如图1所示其流程图，包括：步骤S110、预先配置至少两个模糊核，其中每个模糊核具有不同的模糊权重。可以根据不同的应用场景配置不同的模糊核。本发明中模糊核可以是两个，其中两个模糊核用于对不同场景下拍摄的模糊图像进行复原处理。例如说一个是白天、一个是夜晚，两个场景中的模糊图像都是不同的。白天中的模糊图像中各个像素点的亮度都偏亮，RGB值则偏大，夜晚中的模糊图像中各个像素点的亮度都偏暗，RGB值则偏小。传统的图像复原都是通过模糊核进行求均值来调整像素点的RGB值，使得所有场景下的像素点的调整都是相同的。本发明会根据不同的场景进行模糊核的模糊权重采取不同的配置，当模糊图像的整体RGB值较低时，会选择值较高的模糊权重，当模糊图像的整体RGB值较高时则会选择值较低的模糊权重。通过以上方式，可以使偏暗的图像的像素点在更改后可以具有调明的趋势，使偏亮的图像的像素点在更改后可以具有调暗的趋势，尽量保障复原图像中像素点的RGB值平滑变化的同时使得复原图像的质感格更好。不会使较暗的模糊图像在复原后在视觉感官上更暗、较亮的模糊图像在复原后在视觉感官上更亮。提高了复原图像的观看效果。步骤S120、获取当前时刻手持式摄像镜中的模糊图像，对所述模糊图像以RGB值的形式显示。本发明会在获得模糊图像后首先对模糊图像进行处理，使得述模糊图像以RGB值的形式显示，方便CPU、GPU获取模糊图像中每个像素点的RGB值。步骤S130、基于所述模糊图像确定手持式摄像镜所处的环境信息，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围。本发明在选择适配模糊核时会充分考虑手持式摄像镜所处的环境信息，该环境信息可以是根据模糊图像得到，也可以是根据其他采集设备、智能设备得到，例如说光线传感器等等。步骤S140、基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像。本发明在对模糊图像进行处理前，会首先选择相应的适配模糊核以及该适配模糊核对应的范围，根据适配模糊核以及该适配模糊核对应的范围对模糊图像进行处理，更改模糊图像中各个像素点的RGB值得到修改后的复原图像，此时该复原图像中的部分像素点的RGB值已经进行了修正。通过上述的技术方案，使得本发明通过设置多个具有不同模糊权重的模糊核对不同场景下的模糊图像进行处理，使得到的复原图像更加的准确，与实际场景更加接近。并且能够根据不同的环境确定适配模糊核的范围，达到对模糊图像进行分情况、分区域处理的目的，使得复原图像中各个像素点的RGB值更加符合现实场景，提高了复原图像的复原匹配度。在一个可能的实施方式中，步骤S130包括：判断所述环境信息为第一形式则选择第一形式对应的适配模糊核。本发明会对多个模糊核进行存储，每个模糊核具有唯一对应的一种形式，例如说判断环境信息为白天，则获得白天对应的适配模糊核，对于模糊核的类型、数量本发明不作任何限定。将所述模糊图像划分为多个区域，统计每个区域内所有像素点的区域RGB值。本发明在得到模糊图像后，会将模糊图像分为多个区域，基于多个尺寸相同的正方形组成的多个区域对模糊图像进行分割，如图2所示包括有6个区域，每个区域内会存在相同的像素点数量。若存在任意两个区域RGB值的比对结果大于区域预设值，则所述适配模糊核的范围为第一范围。本发明会将任意两个区域的RGB值进行比对。例如说图2中的区域1和区域2比对，区域1和区域3比对等等。在实际的拍摄场景中，例如说白天的场景下，使用者可能会对一个黑色车辆进行拍照，此时模糊图像中会出现黑色车辆和明亮的其他场景，此时黑色车辆在模糊图像中所处的区域的所有像素点的RGB值会低于其他的明亮场景在模糊图像中所处的区域的所有像素点的RGB值，并且两个区域的所有像素点的RGB值的差会较大，所以此时判断用户在白天进行的摄影。并且，不同区域的所有像素点的RGB值的差大于区域预设值，则证明此时不同区域内像素点的RGB值普遍差异较大，所以此时会缩小模糊核的范围，使得每个被修正的像素点的RGB值的幅度与近距离的像素点关联性较强，在对模糊图像进行复原的同时保障了模糊图像的对比度较高。若任意两个区域RGB值的比对结果小于区域预设值，则所述适配模糊核的范围为第二范围。本发明中采用第一范围和第二范围只是为了区分存在不同的范围，其中区域预设值可以为多个，在不同的区域则可能会对应不同的范围。在一种可能的实施方式中，第一范围小于所述第二范围。在一种可能的实施方式中，步骤S140包括：选定模糊图像中的任意一个像素点作为待处理像素点，以所述待处理像素点为中心确定适配模糊核的范围内所有像素点的中心平均RGB值。本发明在对模糊图像进行复原的过程中，会对多个相似点依次复原。在复原时，先在模糊图像中选定一个待处理像素点，以待处理像素点为中心确定适配模糊核的范围，此时根据适配模糊核的范围确定待处理像素点的范围，在实际处理过程中，模糊图像中靠近边缘的像素点作为中心时相应的范围可能会不具有像素点，则此时只对范围内具有的像素点的像素值进行计算得到所有像素点的范围总RGB值，基于像素点的数量得到所有像素点的中心平均RGB值。将所述中心平均RGB值作为所述待处理像素点的新的RGB值以得到复原图像。以此实现对模糊图像中每个像素点进行处理的目的，使得复原图像相较于模糊图像更加的符合真实场景。在一个可能的实施方式中，以所述待处理像素点为中心确定适配模糊核的范围内所有像素点的中心平均RGB值包括：通过以下公式计算所述中心平均RGB值，其中，Mp为适配模糊核的范围内重第p个点的RGB值，q为适配模糊核的范围内像素点的数量，R1为拍摄时刻的瞬时加速度，R2为预设加速度，A为放大系数，L为调整系数，为模糊权重。本发明在得到中心平均RGB值时，会综合考虑手抖的幅度、手持式摄像镜的放大倍数等等，根据手抖的幅度、手持式摄像镜的放大倍数对像素点的RGB值的变化趋势进行指导，保障了复原图像更加的真实。并且，在手抖幅度越大或者是放大系数越大，则模糊图像中的模糊范围可能就会越高，所以此时会根据拍摄时的瞬时加速度以及放大系数对中心平均RGB值进行线性调整，使得中心平均RGB值根据拍摄时人为情况进行调整。通过以上的技术方案，使得本发明在对模糊图像进行复原处理时，不仅会充分参考手持式摄像镜所处的环境信息，而且会参考用户对手持式摄像经的使用状态，根据环境信息和使用状态对模糊图像进行复原处理，使得复原后的图像更加的贴近真实场景。在一个可能的实施方式中，步骤S140包括：对所述调整系数L进行预设次数的调整生成集合I＝，基于所述集合I生成多个复原图像。其中，任意两个相邻的调整系数之间相差预设值差值。由于每个模糊图像的情况都是不同的，所以本发明会生成多个复原图像，使用户可以根据多个复原图像分别进行挑选，确定最适宜的复原图像。并且在生成多个复原图像时会根据调整系数L生成。获取用户选定的复原图像对应的调整系数lm，在下次生成复原图像时以所述lm为中心得到新的集合I新，基于所述集合I新生成多个复原图像。当得到用户选择的复原图像后，会根据其选择的复原图像所对应的调整系数生成新的集合I新，在下次会模糊图像进行复原处理时以集合I新生成多个复原图像。在实际场景中，每个人的操作习惯、手法都是不同的，所以本发明会根据每个人的操作习惯、手法进行主动学习，根据用户上一次所选择的复原图像指导下次多个复原图像的生成。提高了本发明在图像复原过程中的准确性。本发明采用深度学习技术，可以根据用户反馈，对模糊权重进行调整。并且在生成复原图像时会生成多个复原图像，用户根据会根据实际场景选择最近接的复原图像，将用户选择的复原图像所对应的调整系数作为中心得到新的集合，以此达到对模糊权重进行更新、训练的目的。进而保障本发明提供的方法能够进行反馈进行主动调整，提高复原图像的复原精度。在一个可能的实施方式中，基于所述模糊图像确定手持式摄像镜所处的环境信息包括：通过以下公式计算模糊图像的总平均RGB值，其中，Y为模糊图像中的像素点数量，Xi为第i个像素点的RGB值，S为模糊图像的总平均RGB值；判断所述S大于平均预设值，则所述环境信息为第一形式；判断所述S小于平均预设值，则所述环境信息为第二形式。通过上述的技术方案，本发明会根据模糊图像的总体的RGB值判断相应的形式，形式可以对应环境信息。例如说整体的RGB值大于S，则整体的RGB值可能较高，则此时环境信息为第一形式，即为白天。例如说整体的RGB值小于S，则整体的RGB值可能较低，则此时环境信息为第而形式，即为黑夜。本发明提供一种手持式摄像镜数据处理装置，如图2所示其结构图，包括：配置模块，用于预先配置至少两个模糊核，其中每个模糊核具有不同的模糊权重；显示模块，用于获取当前时刻手持式摄像镜中的模糊图像，对所述模糊图像以RGB值的形式显示；选择模块，用于基于所述模糊图像确定手持式摄像镜所处的环境信息，根据所述环境信息在多个模糊核中选择对应的适配模糊核和该适配模糊核的范围；复原模块，用于基于所述适配模糊核和该适配模糊核的范围对所述模糊图像进行复原处理以得到复原图像。其中，可读存储介质可以是计算机存储介质，也可以是通信介质。通信介质包括便于从一个地方向另一个地方传送计算机程序的任何介质。计算机存储介质可以是通用或专用计算机能够存取的任何可用介质。例如，可读存储介质耦合至处理器，从而使处理器能够从该可读存储介质读取信息，且可向该可读存储介质写入信息。当然，可读存储介质也可以是处理器的组成部分。处理器和可读存储介质可以位于专用集成电路中。另外，该ASIC可以位于用户设备中。当然，处理器和可读存储介质也可以作为分立组件存在于通信设备中。可读存储介质可以是只读存储器、随机存取存储器、CD-ROM、磁带、软盘和光数据存储设备等。本发明还提供一种程序产品，该程序产品包括执行指令，该执行指令存储在可读存储介质中。设备的至少一个处理器可以从可读存储介质读取该执行指令，至少一个处理器执行该执行指令使得设备实施上述的各种实施方式提供的方法。在上述终端或者服务器的实施例中，应理解，处理器可以是中央处理单元，还可以是其他通用处理器、数字信号处理器、专用集成电路等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。结合本发明所公开的方法的步骤可以直接体现为硬件处理器执行完成，或者用处理器中的硬件及软件模块组合执行完成。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围。
