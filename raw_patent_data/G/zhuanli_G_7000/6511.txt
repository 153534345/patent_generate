标题title
一种计及风机状态的风电功率超短期预测的方法
摘要abst
本发明公开了一种计及风机状态的风电功率超短期预测的方法，包括：采集原始风机运行数据，并对风机运行数据进行缺失数据处理，得到风机运行数据；利用灰色关联度分析对风机运行数据进行关联度分析，并选取关联度较强的参量作为评估风机状态的数据源；对风电场状态进行评估，得到风电场状态，然后将风电场状态对处理后的风电场运行数据进行重组，得到风电场的重组实验数据；利用重组实验数据对XGBoost模型进行训练，并对模型参数进行优化，得到风电功率预测结果。评估模型避免了过多的人为主观因素，使得评估结果能准确地反映风机真实出力状态；将评估结果引入功率预测模型，使其能够在任何风况下保持较高的预测精度。
权利要求书clms
1.一种计及风机状态的风电功率超短期预测的方法，其特征在于，包括以下步骤：步骤1、采集原始风机运行数据，并对所述风机运行数据进行缺失数据处理，得到风机运行数据；步骤2、利用灰色关联度分析对风机运行数据进行关联度分析，并选取关联度较强的参量作为评估风机状态的数据源；步骤3、利用BP-AHP法对风电场状态进行评估，得到风电场状态，然后将所述风电场状态对步骤1处理后的风电场运行数据进行重组，得到风电场的重组实验数据；步骤4、利用所述重组实验数据对XGBoost模型进行训练，并对模型参数进行优化，得到风电功率预测结果。2.根据权利要求1所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤1具体包括以下步骤：步骤1.1、利用pandas工具将每台风机的原始风机运行数据依次导入python，对所述原始风机运行数据的“时间”列进行差分，通过差分值大小判定缺失值位置，将每台风机原始风机运行数据的缺失位置形成统计表；步骤1.2、对所述统计表取并集作为公共缺失位置，依次删除每台风机的原始风机运行数据中公共缺失位置处所对应的数据，保证各风机数据量相等以及时间点一一对应，得到每台风机的风机运行数据。3.根据权利要求1所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤2具体包括以下步骤：步骤2.1、以功率列为参考序列，以运行参数作为比较序列；步骤2.2、对比较序列、参考序列进行无量纲化处理；步骤2.3、计算风机运行数据与功率之间的关联系数：步骤2.4、计算比较序列与参考序列的关联度；步骤2.5、按照大小对关联度进行排序，选取与功率关联度大于预设值的风机运行数据作为评估风机状态的数据源。4.根据权利要求3所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤2具体包括以下步骤：步骤2.1、以功率列为参考序列，设参考序列为Y＝{Y|k＝1,2,n}，以运行参数作为比较序列，比较数列Xi＝{Xi|k＝1,2,n}；步骤2.2、按照公式、分别对比较序列、参考序列进行无量纲化处理：上式中，Xi为第i个比较序列中的第k个值，为第i个比较序列的均值；Y为参考序列中的第k个值，为参考序列均值，xi、y分别代表无量纲的比较序列与参考序列；步骤2.3、根据下式计算风机运行数据与功率之间的关联系数：上式中，ζi为比较数列xi对参考数列y在第k个值处的关联系数，ρ∈为分辨系数，minimink|y-xi|、maximaxk|y-xi|分别为两级最小差、两级最大差；步骤2.4、将关联系数的平均值作为比较序列与参考序列间关联度，关联度ri公式如下：步骤2.5、按照大小对关联度进行排序，选取与功率关联度大于预设值的风机运行数据作为评估风机状态的数据源。5.根据权利要求1所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤3具体包括以下步骤：步骤3.1、利用AHP算法计算中间层对最高层、中间两层之间的相对权重；步骤3.2利用BP算法计算最低层对中间层的相对权重；步骤3.3、将所述最低层对中间层的相对权重与中间层对最高层、中间两层之间的相对权重递阶相乘得到最低层对最高层的权重向量；步骤3.4、利用最低层对最高层的权重向量对单台风机状态进行量化评估；步骤3.5、根据步骤3.1-3.4，借助python批量数据处理平台依次对每台风机进行状态评估，将全部风机状态的均值作为风电场状态；步骤3.6、将步骤3.5中所得风电场状态加入步骤1处理后的风电场运行数据作为风电场状态数据，以t+1时刻气象信息、t时刻风电场状态数据、t时刻风电场功率作为输入，以t+1时刻风电场功率作为输出，得到风电场的重组实验数据。6.根据权利要求5所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤3.1具体包括以下步骤：步骤3.1.1、根据AHP算法中间两层、最高层中每个元素的相对重要程度，建立判断矩阵，并对判断矩阵进行完整性检验：WA、WB、WC是由中间两层的主因素及其子因素分别构成的三个判断矩阵；其中，WA中的a,b分别代表外界因素和风机性能，WB中的x,y分别代表环境因素和电网因素，WC中的c,m,d,n依次代表机舱、齿轮箱、发电机、偏航系统；每个判断矩阵中的元素wij表示i因素对于j因素的重要程度；根据公式对判断矩阵进行完整性检验：步骤3.1.2、对每个判断矩阵按列向量进行归一化得到归一化矩阵，然后对所述归一化矩阵求行和并归一化得权重向量wm，根据Awm＝λwm式求得最大特征值的近似值λmax，其中A为判断矩阵；根据公式计算一致性指标CR上式中，RI表示平均随机一致性指标；当CR＜0.1时，判断矩具有满意的一致性，则归一化后的权重向量wm为各元素的权重系数；否则对判断矩阵进行调整，直至满足一致性检验。7.根据权利要求6所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤3.2具体包括以下步骤：步骤3.2.1、利用BP算法构建风机运行数据与功率之间的映射关系：上式中，xi为第i个输入参量，wi为该输入参量对应的权重，y为风机功率，f为激活函数；步骤3.2.2、利用风机运行数据训练BP网络，从最优的模型中导出每个风机运行数据对应的权重wi，再根据公式对每个权重进行归一化得到权重向量wl：8.根据权利要求5所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤3.4根据公式对单台风机状态进行量化评估：上式中，xnT为风机在T时刻的第n个运行参量，T为时间点，n为参量个数，v为风机状态。9.根据权利要求1所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，步骤4中利用网格搜索法对模型参数进行优化，具体过程为：选取优化参数并设置取值范围；设定优化参数的初始值，并设定寻优步长；利用网格搜索算法寻找最优参数组合。10.根据权利要求1所述的一种计及风机状态的风电功率超短期预测的方法，其特征在于，还包括，步骤5、采用平均绝对误差eMAE、均方根误差eRMSE、平均绝对百分比误差eMAPE与确定系数R2进行预测结果进行评估：上式中，n为样本数量，与yi分别是样本i的预测值与真实值。
说明书desc
技术领域本发明属于风电功率预测方法技术领域，涉及一种计及风机状态的风电功率超短期预测的方法。背景技术风电功率预测技术是依据风电场历史运行数据和气象数据来预测未来某时刻风电场输出功率的一种技术。现阶段的预测方法往往只考虑气象因素，单纯地构建风况信息与功率之间的非线性关系，由于此类模型不计及风机状态，不能准确地反映风电场真实的出力状态，存在预测精度不足的问题。发明内容本发明的目的是提供一种计及风机状态的风电功率超短期预测方法，解决了现有技术中存在的预测精度不足的的问题。本发明所采用的技术方案是，一种计及风机状态的风电功率超短期预测的方法，包括以下步骤：步骤1、采集原始风机运行数据，并对风机运行数据进行缺失数据处理，得到风机运行数据；步骤2、利用灰色关联度分析对风机运行数据进行关联度分析，并选取关联度较强的参量作为评估风机状态的数据源；步骤3、利用BP-AHP法对风电场状态进行评估，得到风电场状态，然后将风电场状态对步骤1处理后的风电场运行数据进行重组，得到风电场的重组实验数据；步骤4、利用重组实验数据对XGBoost模型进行训练，并对模型参数进行优化，得到风电功率预测结果。本发明的特点还在于：步骤1具体包括以下步骤：步骤1.1、利用pandas工具将每台风机的原始风机运行数据依次导入python，对原始风机运行数据的“时间”列进行差分，通过差分值大小判定缺失值位置，将每台风机原始风机运行数据的缺失位置形成统计表；步骤1.2、对统计表取并集作为公共缺失位置，依次删除每台风机的原始风机运行数据中公共缺失位置处所对应的数据，保证各风机数据量相等以及时间点一一对应，得到每台风机的风机运行数据。步骤2具体包括以下步骤：步骤2.1、以功率列为参考序列，以运行参数作为比较序列；步骤2.2、对比较序列、参考序列进行无量纲化处理；步骤2.3、计算风机运行数据与功率之间的关联系数：步骤2.4、计算比较序列与参考序列的关联度；步骤2.5、按照大小对关联度进行排序，选取与功率关联度大于预设值的风机运行数据作为评估风机状态的数据源。步骤2具体包括以下步骤：步骤2.1、以功率列为参考序列，设参考序列为Y＝{Y|k＝1,2,n}，以运行参数作为比较序列，比较数列Xi＝{Xi|k＝1,2,n}；步骤2.2、按照公式、分别对比较序列、参考序列进行无量纲化处理：上式中，Xi为第i个比较序列中的第k个值，为第i个比较序列的均值；Y为参考序列中的第k个值，为参考序列均值，xi、y分别代表无量纲的比较序列与参考序列；步骤2.3、根据下式计算风机运行数据与功率之间的关联系数：上式中，ζi为比较数列xi对参考数列y在第k个值处的关联系数，ρ∈为分辨系数，minimink|y-xi|、maximaxk|y-xi|分别为两级最小差、两级最大差；步骤2.4、将关联系数的平均值作为比较序列与参考序列间关联度，关联度ri公式如下：步骤2.5、按照大小对关联度进行排序，选取与功率关联度大于预设值的风机运行数据作为评估风机状态的数据源。步骤3具体包括以下步骤：步骤3.1、利用AHP算法计算中间层对最高层、中间两层之间的相对权重；步骤3.2利用BP算法计算最低层对中间层的相对权重；步骤3.3、将最低层对中间层的相对权重与中间层对最高层、中间两层之间的相对权重递阶相乘得到最低层对最高层的权重向量；步骤3.4、利用最低层对最高层的权重向量对单台风机状态进行量化评估；步骤3.5、根据步骤3.1-3.4，借助python批量数据处理平台依次对每台风机进行状态评估，将全部风机状态的均值作为风电场状态；步骤3.6、将步骤3.5中所得风电场状态加入步骤1处理后的风电场运行数据作为风电场状态数据，以t+1时刻气象信息、t时刻风电场状态数据、t时刻风电场功率作为输入，以t+1时刻风电场功率作为输出，得到风电场的重组实验数据。步骤3.1具体包括以下步骤：步骤3.1.1、根据AHP算法中间两层、最高层中每个元素的相对重要程度，建立判断矩阵，并对判断矩阵进行完整性检验：WA、WB、WC是由中间两层的主因素及其子因素分别构成的三个判断矩阵；其中，WA中的a,b分别代表外界因素和风机性能，WB中的x,y分别代表环境因素和电网因素，WC中的c,m,d,n依次代表机舱、齿轮箱、发电机、偏航系统；每个判断矩阵中的元素wij表示i因素对于j因素的重要程度；根据公式对判断矩阵进行完整性检验：步骤3.1.2、对每个判断矩阵按列向量进行归一化得到归一化矩阵，然后对归一化矩阵求行和并归一化得权重向量wm，根据Awm＝λwm式求得最大特征值的近似值λmax，其中A为判断矩阵；根据公式计算一致性指标CR上式中，RI表示平均随机一致性指标；当CR＜0.1时，判断矩具有满意的一致性，则归一化后的权重向量wm为各元素的权重系数；否则对判断矩阵进行调整，直至满足一致性检验。步骤3.2具体包括以下步骤：步骤3.2.1、利用BP算法构建风机运行数据与功率之间的映射关系：上式中，xi为第i个输入参量，wi为该输入参量对应的权重，y为风机功率，f为激活函数；步骤3.2.2、利用风机运行数据训练BP网络，从最优的模型中导出每个风机运行数据对应的权重wi，再根据公式对每个权重进行归一化得到权重向量wl：步骤3.4根据公式对单台风机状态进行量化评估：上式中，xnT为风机在T时刻的第n个运行参量，T为时间点，n为参量个数，v为风机状态。步骤4中利用网格搜索法对模型参数进行优化，具体过程为：选取优化参数并设置取值范围；设定优化参数的初始值，并设定寻优步长；利用网格搜索算法寻找最优参数组合。还包括，步骤5、采用平均绝对误差eMAE、均方根误差eRMSE、平均绝对百分比误差eMAPE与确定系数R2进行预测结果进行评估：上式中，n为样本数量，与yi分别是样本i的预测值与真实值。本发明的有益效果是：本发明一种计及风机状态的风电功率超短期预测方法，综合BP算法和层次分析法构建风机状态评估模型，提出BP-AHP评估方法，评估结果能准确地反映风机真实出力状态，避免了过多的人为主观因素，该评估模型更为准确合理；将评估出的风机状态引入风电功率预测模型构建动态预测模型，较传统的静态预测模型有更强的适应性，能够在任何风况下保持较高的预测精度，将预测误差控制在合理范围内。预测模型效果卓越，预测风电输出功率稳定准确，在风电功率超短期预测方面有较高的应用价值，也可应用于电力系统调度领域。附图说明图1是本发明一种计及风机状态的风电功率超短期预测方法的总体流程图；图2是本发明一种计及风机状态的风电功率超短期预测方法的风机运行参数与功率的相关性图；图3是本发明一种计及风机状态的风电功率超短期预测方法的风机状态评估结构模型图；图4是本发明一种计及风机状态的风电功率超短期预测方法的不同评估方法对比图；图5是本发明一种计及风机状态的风电功率超短期预测方法中风电场状态与功率曲线图；图6是本发明一种计及风机状态的风电功率超短期预测方法的风电场功率预测流程图；图7是本发明一种计及风机状态的风电功率超短期预测方法中模型预测值与真实值曲线图。具体实施方式下面结合附图和具体实施方式对本发明进行详细说明。一种计及风机状态的风电功率超短期预测的方法，如图1所示，包括以下步骤：步骤1、采集原始风机运行数据，并对风机运行数据进行缺失数据处理，得到风机运行数据；由于某种原因各风机在数据采集过程中不可避免的出现数据缺失，数据缺失亦有可能在不同时间点出现，针对于此类缺失数据采用如下处理方法：步骤1.1、利用pandas工具将每台风机的原始风机运行数据依次导入python，对原始风机运行数据的“时间”列进行差分，通过差分值大小判定缺失值位置，将每台风机原始风机运行数据的缺失位置形成统计表；步骤1.2、对统计表取并集作为公共缺失位置，依次删除每台风机的原始风机运行数据中公共缺失位置处所对应的数据，保证各风机数据量相等以及时间点一一对应，得到每台风机的风机运行数据。步骤2、利用灰色关联度分析对风机运行数据进行关联度分析，并选取关联度较强的参量作为评估风机状态的数据源；步骤2.1、确定参考序列和比较序列；以功率列为参考序列，设参考序列为Y＝{Y|k＝1,2,n}，以运行参数作为比较序列，比较数列Xi＝{Xi|k＝1,2,n}；本实施例以功率列为参考序列，以风速、风向、发电机转速等运行参数作为比较序列。步骤2.2、按照公式、分别对比较序列、参考序列进行无量纲化处理：上式中，Xi为第i个比较序列中的第k个值，为第i个比较序列的均值；Y为参考序列中的第k个值，为参考序列均值，xi、y分别代表无量纲的比较序列与参考序列；步骤2.3、根据下式计算风机运行数据与功率之间的关联系数，如图2所示：上式中，ζi为比较数列xi中第i个风机运行数据对功率y在第k个值处的关联系数，ρ∈为分辨系数，minimink|y-xi|、maximaxk|y-xi|分别为两级最小差、两级最大差；步骤2.4、因为关联系数是比较序列与参考序列在各个时刻的关联程度值，所以该数不止一个，而信息过于分散不便于进行整体性比较。因此有必要将各时刻的关联系数集中为一个值。所以将关联系数的平均值作为比较序列与参考序列间关联度，关联度ri公式如下：步骤2.5、按照大小对关联度进行排序，若r1＞r2，则第一个参数较第二个参数对功率的影响更高；选取与功率关联度大于预设值的风机运行数据作为评估风机状态的数据源，本实施例中预设值为0.35.步骤3、利用BP-AHP法对风电场状态进行评估，得到风电场状态，然后将风电场状态对步骤1处理后的风电场运行数据进行重组，得到风电场的重组实验数据。单纯的AHP，用判断矩阵计算各层之间的相对权重，最后递阶相乘得到最低层对最高层的相对权重。由于最低层指标比较多，不好确定他们的重要程度，所以本发明在计算最低层相对中间层的权重向量时运用了BP算法得到最低层对中间层的相对权重，然后与判断矩阵算出的中间层对最高层及中间两层之间的权重向量递阶相乘得到最低层对最高层的权重向量。具体如下：步骤3.1、利用AHP算法计算如图3所示的中间层对最高层、中间两层之间的相对权重；步骤3.1.1、根据AHP算法中间两层、最高层中每个元素的相对重要程度，建立判断矩阵，并对判断矩阵进行完整性检验：WA、WB、WC是由中间两层的主因素及其子因素分别构成的三个判断矩阵；其中，WA中的a,b分别代表外界因素和风机性能，WB中的x,y分别代表环境因素和电网因素，WC中的c,m,d,n依次代表机舱、齿轮箱、发电机、偏航系统；每个判断矩阵中的元素wij表示i因素对于j因素的重要程度；根据公式对判断矩阵进行完整性检验：步骤3.1.2、对每个判断矩阵按列向量进行归一化得到归一化矩阵；a.将WC阵按列向量归一化得到其中，wij为WC中的每一元素，n为WC阵的阶数；b.对矩阵求行和并归一化得权重向量wm；c.根据Awm＝λwm式求得最大特征值的近似值λmax，其中A为判断矩阵；d.根据公式计算一致性指标CR上式中，RI表示平均随机一致性指标，依照随机一致性指标表取RI的值；当CR＜0.1时，判断矩阵A具有满意的一致性，则归一化后的权重向量wm为各元素的权重系数；否则对判断矩阵进行调整，直至满足一致性检验。步骤3.2利用BP算法计算最低层对中间层的相对权重；步骤3.2.1、针对于递阶层次模型最低层对于中间层的相对权重，采用BP算法建立最低层各指标与总目标之间的关系。由于总目标风机状态待求，因此此处利用风机状态的相关量功率作为目标。构建风机运行数据与功率之间的映射关系：上式中，该模型只含输入层和输出层，xi为第i个输入参量，wi为该输入参量对应的权重，y为风机功率，f为激活函数；步骤3.2.2、利用风机运行数据训练BP网络，从最优的模型中导出每个风机运行数据对应的权重wi，再根据公式对每个权重进行归一化得到权重向量wl：步骤3.3、将最低层对中间层的相对权重与中间层对最高层、中间两层之间的相对权重递阶相乘得到最低层对最高层的权重向量；步骤3.4、利用最低层对最高层的权重向量，根据公式对单台风机状态进行量化评估，单台风机状态评估对比如图4所示；上式中，xnT为风机在T时刻的第n个运行参量，T为时间点，n为参量个数，v为风机状态。步骤3.5、根据步骤3.1-3.4，借助python批量数据处理平台依次对每台风机进行状态评估，将全部风机状态的均值作为风电场状态，如图5所示；步骤3.6、将步骤3.5中所得风电场状态加入步骤1处理后的风电场运行数据作为风电场状态数据，以t+1时刻气象信息、t时刻风电场状态数据、t时刻风电场功率作为输入，以t+1时刻风电场功率作为输出，得到风电场的重组实验数据。步骤4、利用重组实验数据对XGBoost模型进行训练，如图6所示，并利用网格搜索法对模型参数进行优化，即选取优化参数并设置取值范围，设定优化参数的初始值，并设定寻优步长，利用网格搜索算法寻找最优参数组合，利用最优参数组合重新训练XGBoost模型，并得到风电功率预测结果；具体的优化步骤如下：a.选取优化参数并设置取值范围：由于XGBoost模型参数较多，全部进行优化会给计算机的内存增加挑战，大大增加寻优时间，最终选取如下四个主要参数进行优化：1)树的数目n_estimate参数越大越好，但占用的内存和训练时间也会相应增加，本文寻优范围取50-150；2)树的最大深度max_depth参数用于防止过拟合，取值范围5-10；3)学习率learning_rate取值范围0.05-0.3；4)最小叶子节点样本权重min_child_weight亦用于防止过拟合，取值范围1-9；b.参数初始值及寻优步长设定：上述四个参数初始值分别设置为100、5、0.1、1，寻优步长分别为5,1,0.05,1。c.利用网格搜索算法寻找最优参数组合d.利用最优参数组合重新训练XGBoost模型，并得到风电预测结果，如图7是不同评估方法预测结果对比图，从图中可看出：在同时利用XGBoost算法的情况下，BP-AHP评估方法预测精度最高。证明了本发明提出的评估方法所评估的风电场状态能较好的反映风电场真实出力，有助于预测精度的提升。步骤5、采用平均绝对误差eMAE、均方根误差eRMSE、平均绝对百分比误差eMAPE与确定系数进行预测结果进行评估：上式中，n为样本数量，与yi分别是样本i的预测值与真实值。通过以上方式，本发明一种计及风机状态的风电功率超短期预测方法，对风机以及风电场数据预处理后，保证了所有风机数据与风电场数据的同步性；采用GRA算法确定评估风机状态的数据源，并将与功率相关性较强的数据作为评估风机状态的指标；融合BP算法基于数据自学习的特点和AHP的评估结构模型提出了BP-AHP评估方法，该评估方法能更准确地评估风电场状态，相较于单独的AHP法和RMT方法可以更好地反映风电场真实出力状态，将该评估结果引入功率预测中能进一步提升预测精度。实施例表1表1是采用西北某地风电场3个月的数据进行预测分析，重组之后的样本共10716组数据，前8000组数据做训练集，2000组数据做验证集，剩余部分做测试集，预测目标是未来15分钟的风电场发电功率，与使用不同评估方法的模型以及不计及状态的模型进行对比，通过应用平均绝对误差eMAE与均方根误差eRMSE进行预测结果进行评估，从表1中可以看出采用BP-AHP评估风机状态并将其结果引入预测模型时，平均绝对误差为1.09MW，平均方根误差为1.33MW，均低于使用不同评估方法的模型以及不计及状态的模型，可以看出BP-AHP评估较其他评估方法更能准确地反映风机真实出力，将评估出的风机状态引入风电功率预测进一步提高了预测精度。
