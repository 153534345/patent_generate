标题title
基于密度融合的水下试验环境反演方法及系统
摘要abst
基于密度融合的水下试验环境反演方法及系统，属于水声技术领域。本发明为了解决现有的匹配场反演比较复杂的问题以及声速剖面往往不能直接求解得到唯一解的问题。本发明首先将将环境特征输入OneHot和Embedding网络得到高维特征向量，然后根据环境特征和深度信息得到融合特征矩阵，将融合特征矩阵输入残差网络模型得到对应的环境剖面信息数据，从而实现试验环境反演。主要用于水下试验环境的反演。
权利要求书clms
1.基于密度融合的水下试验环境反演方法，其特征在于，针对于待反演水域，根据环境特征和深度信息得到融合特征矩阵，将融合特征矩阵输入最优残差网络模型得到对应的环境剖面信息数据，从而实现试验环境反演；所述的最优残差网络模型的确定过程包括以下步骤：S1.对不同环境水域的环境剖面信息数据进行采集，获取不同环境水域的不同深度的环境剖面信息数据,并记录剖面信息对应的环境特征，环境特征可以是在数据采集过程中指定的环境标量信息；然后将环境特征、深度信息与对应的剖面信息作为一组数据，对数据集进行划分，划分训练集、测试集和验证集；S2.将环境特征转换为融合前高维特征向量；S3.首先将融合前高维特征向量和深度信息进行融合，得到包含环境特征信息和深度信息的融合特征矩阵；然后利用残差网络模型进行反演，所述的残差网络模型根据融合特征矩阵预测得到相应的环境剖面信息数据，进而得到不同环境下的不同深度的环境剖面信息；具体处理过程包括以下步骤：融合特征矩阵作为残差网络模型的输入，将环境特征和深度信息对应的环境剖面信息数据作为残差网络模型的标签输出数据；融合特征矩阵输入给残差网络，残差网络包括多个残差子网络，每个残差子网络的输出信息除了会继续向下传递，同时也会提取出来并分别通过上采样进行维度统一，然后将每个残差子网络对应的维度统一后的输出在通道维度进行密度融合；最后经过密度融合后的特征矩阵再通过全局均值池化和全连接层，得到反演的环境剖面信息数据；S4.设置多个用于反演的残差网络模型，每个残差网络模型对应残差子网络中的残差块数量不等，将残差子网络中的残差块数量不等的多个残差网络模型称为不同参数网络模型；将训练集数据分别输入到不同参数模型进行训练，得到的多个训练好的残差网络模型；然后分别利用测试集进行测试，选取多个不同参数的模型中测试集效果最好的模型作为最优残差网络模型。2.根据权利要求1所述的基于密度融合的水下试验环境反演方法，其特征在于，针对于待反演水域，根据环在对不同环境水域的环境剖面信息数据进行采集之后，需要对剖面信息数据集进行预处理，预处理过程包括无效、错误的数据的剔除处理。3.根据权利要求1或2所述的基于密度融合的水下试验环境反演方法，其特征在于，S2所述的将环境特征转换为融合前高维特征向量的具体转换过程如下：将环境特征输入OneHot和Embedding网络得到高维特征向量。4.根据权利要求3所述的基于密度融合的水下试验环境反演方法，其特征在于，S3所述的将融合前高维特征向量和深度信息进行融合的过程如下：在通道维度，将融合前高维特征向量和深度信息进拼接。5.根据权利要求4所述的基于密度融合的水下试验环境反演方法，其特征在于，所述的残差网络包括4个残差子网络；每个残差子网络的残差处理路径包括多个残差块，每个残差块包括两个卷积单元，每个卷积单元依次设置为BN层、ReLU层、Conv层。6.根据权利要求5所述的基于密度融合的水下试验环境反演方法，其特征在于，所述的残差网络为一维残差网络。7.一种密度融合的水下试验环境反演系统，其特征在于，包括：数据预处理单元：将环境特征信息编码为高维向量，再和深度信息进行拼接，得到融合特征矩阵；密度融合单元：利用残差网络模型对融合特征矩阵进行预测得到对应的环境剖面信息数据，进而实现试验环境反演；所述残差网络包括多个残差子网络，每个残差子网络的输出信息除了会继续向下传递，同时也会提取出来并分别通过上采样进行维度统一，然后将每个残差子网络对应的维度统一后的输出在通道维度进行密度融合；最后经过密度融合后的特征矩阵再通过全局均值池化和全连接层，得到环境剖面信息数据。8.根据权利要求7所述的一种密度融合的水下试验环境反演系统，其特征在于，所述数据预处理单元将环境特征信息编码为高维向量的过程是利用OneHot和Embedding实现的。9.根据权利要求8所述的一种密度融合的水下试验环境反演系统，其特征在于，所述的残差网络包括4个残差子网络；每个残差子网络的残差处理路径包括多个残差块，每个残差块包括两个卷积单元，每个卷积单元依次设置为BN层、ReLU层、Conv层。10.根据权利要求9所述的一种密度融合的水下试验环境反演系统，其特征在于，所述的残差网络为一维残差网络。
说明书desc
技术领域本发明涉及水下试验环境反演方法，属于水声技术领域。背景技术水下环境剖面在水下环境的反演中具有极其重要的意义，获知声速、温度剖面等水声环境剖面信息，对水下目标探测、定位与跟踪等应用的进行，有着重要的贡献。但是由于待反演的参数较多且待反演参数与声场之间呈现非线性关系，这些使得环境剖面反演比较复杂，环境剖面往往不能直接求解得到唯一解，而只能通过优化算法在一定的参数空间范围内对代价函数寻优来获得声速剖面的最优解。同时，对于不同的水环境，基于对声信号的不同定义，水声传播模型也不同，基于不同的水声传播模型，代价函数和优化算法也有不同，这些都给这样的匹配场反演方法的应用带来一些限制。同时，对于水下环境除了声速之外的环境信息，比如温度，传统的声速剖面反演方法想要得到这样的结果，也需要进行一些调整，使得原本的反演方法更加复杂，且反演结果的准确率也有待于提高。目前，传统的基于匹配场反演的方法，需要首先建立合适的声场计算模型，声场计算模型的选取直接关系到反演计算的精度和速度。目前，常用的声场建模理论有：射线理论、简正波理论、快速场理论、抛物方程方法等，较为依赖先验理论和假设，并没有一个较为通用方法，可以较好的解决环境反演问题。同时在反演的计算过程中，会因代价函数存在大量的局部最优、众多的反演参数和较宽的搜索范围而难以求解，针对反演问题的优化算法，主要分为四类：1)网格搜索方法；2)全局优化算法；3)局部优化算法；4)结合不同优化算法的混合算法。这些方法在搜索反演参数的最优解的过程中，会难以快速搜索到最优解，导致结果难以求解。发明内容本发明为了解决现有的匹配场反演比较复杂的问题以及声速剖面往往不能直接求解得到唯一解的问题。基于密度融合的水下试验环境反演方法，针对于待反演水域，根据环境特征和深度信息得到融合特征矩阵，将融合特征矩阵输入最优残差网络模型得到对应的环境剖面信息数据，从而实现试验环境反演；所述的最优残差网络模型的确定过程包括以下步骤：S1.对不同环境水域的环境剖面信息数据进行采集，获取不同环境水域的不同深度的环境剖面信息数据,并记录剖面信息对应的环境特征，环境特征可以是在数据采集过程中指定的环境标量信息；然后将环境特征、深度信息与对应的剖面信息作为一组数据，对数据集进行划分，划分训练集、测试集和验证集；S2.将环境特征转换为融合前高维特征向量；S3.首先将融合前高维特征向量和深度信息进行融合，得到包含环境特征信息和深度信息的融合特征矩阵；然后利用残差网络模型进行反演，所述的残差网络模型根据融合特征矩阵预测得到相应的环境剖面信息数据，进而得到不同环境下的不同深度的环境剖面信息；具体处理过程包括以下步骤：融合特征矩阵作为残差网络模型的输入，将环境特征和深度信息对应的环境剖面信息数据作为残差网络模型的标签输出数据；融合特征矩阵输入给残差网络，残差网络包括多个残差子网络，每个残差子网络的输出信息除了会继续向下传递，同时也会提取出来并分别通过上采样进行维度统一，然后将每个残差子网络对应的维度统一后的输出在通道维度进行密度融合；最后经过密度融合后的特征矩阵再通过全局均值池化和全连接层，得到反演的环境剖面信息数据；S4.设置多个用于反演的残差网络模型，每个残差网络模型对应残差子网络中的残差块数量不等，将残差子网络中的残差块数量不等的多个残差网络模型称为不同参数网络模型；将训练集数据分别输入到不同参数模型进行训练，得到的多个训练好的残差网络模型；然后分别利用测试集进行测试，选取多个不同参数的模型中测试集效果最好的模型作为最优残差网络模型。进一步地，针对于待反演水域，根据环在对不同环境水域的环境剖面信息数据进行采集之后，需要对剖面信息数据集进行预处理，预处理过程包括无效、错误的数据的剔除处理。进一步地，S2所述的将环境特征转换为融合前高维特征向量的具体转换过程如下：将环境特征输入OneHot和Embedding网络得到高维特征向量。进一步地，S3所述的将融合前高维特征向量和深度信息进行融合的过程如下：在通道维度，将融合前高维特征向量和深度信息进拼接。进一步地，所述的残差网络包括4个残差子网络；每个残差子网络的残差处理路径包括多个残差块，每个残差块包括两个卷积单元，每个卷积单元依次设置为BN层、ReLU层、Conv层。进一步地，所述的残差网络为一维残差网络。一种密度融合的水下试验环境反演系统，包括：数据预处理单元：将环境特征信息编码为高维向量，再和深度信息进行拼接，得到融合特征矩阵；密度融合单元：利用残差网络模型对融合特征矩阵进行预测得到对应的环境剖面信息数据，进而实现试验环境反演；所述残差网络包括多个残差子网络，每个残差子网络的输出信息除了会继续向下传递，同时也会提取出来并分别通过上采样进行维度统一，然后将每个残差子网络对应的维度统一后的输出在通道维度进行密度融合；最后经过密度融合后的特征矩阵再通过全局均值池化和全连接层，得到环境剖面信息数据。进一步地，所述数据预处理单元将环境特征信息编码为高维向量的过程是利用OneHot和Embedding实现的。进一步地，所述的残差网络包括4个残差子网络；每个残差子网络的残差处理路径包括多个残差块，每个残差块包括两个卷积单元，每个卷积单元依次设置为BN层、ReLU层、Conv层。进一步地，所述的残差网络为一维残差网络。有益效果：本方法将在面向水下试验环境反演的特征提取方法的基础上，也就是基于多尺度网络的环境提取模型得到的环境特征，进一步作为输入，以及指定的需要的深度信息，作为共同的输入信息，来反演声速剖面以及其他剖面。相较于上面提到的传统的反演环境信息方法的局限性，本发明利用神经网络的拟合能力，通过定义好的网络模型，来学习提取水下环境的信息，对于指定深度的各种信息，都可以学习反演，应用起来相较于传统方法也更简便，效果更好，同时拓展性也更强，避免了传统方法，需要针对不同水体环境和基于不同的声信号的定义，从多种水声模型、代价函数和优化算法中进行选择的困恼。相较于传统的反演方法，本发明提出的方法，在模型经过训练以后，可以直接根据输入的环境特征和深度信息，预测得到指定环境和深度的诸如深度和温度等信息，可扩展性也较强，如果给定更多的训练目标数据，也可以较为便利的拓展到对更广范围的环境信息的预测。附图说明图1为本发明网络结构模型；图2为本发明环境特征和深度信息融合示意图；图3为本发明流程示意图；图4为声速剖面预测和真实值对比图；图5为温度剖面预测和真实值对比图。具体实施方式具体实施方式一：结合图1至图3说明本实施方式，本实施方式为基于密度融合的水下试验环境反演方法，所述方法基于密度融合的网络模型来实现环境的反演，具体包括以下步骤：S1.对不同环境水域的环境剖面信息数据进行采集，获取不同环境水域的不同深度的环境剖面信息数据；所述不同环境水域是指不同的水域，由于不同的水域环境不同，因此称为不同环境的水域；对不同环境水域的环境剖面信息数据进行采集：针对每个环境水域，使用CTD仪采集不同深度的环境剖面信息，并记录剖面信息对应的环境特征，环境特征可以是在数据采集过程中指定的环境标量信息，例如水域ID号等；所述的环境剖面信息包括声速和温度的信息；对剖面信息数据集进行预处理，预处理过程包括无效、错误的数据的剔除处理；CTD采集的数据中，少部分数据可能会因为测量误差，出现和实际不相符合的误差，需要对这些数据进行甄别剔除，以提高模型训练数据的准确度，并提高模型的训练精度。然后将环境特征、深度信息与对应的剖面信息作为一组数据，对数据集进行划分，划分训练集、测试集和验证集；S2.将环境特征转换为融合前高维特征向量；具体转换过程为将环境特征输入OneHot和Embedding网络得到高维特征向量；融合前高维特征向量也可以是一些预测模型输出的高维特征向量，这些预测模型的输入为环境特征对应水域的剖面信息，实际上就是将环境特征对应水域的剖面信息输入预测网络得到对应可以表示环境特征的高维特征向量；S3.首先将融合前高维特征向量和深度信息进行融合，得到包含环境特征信息和深度信息的融合特征矩阵；所述的将融合前高维特征向量和深度信息进行融合的过程如下：在通道维度，将融合前高维特征向量和深度信息进拼接，即得到包含环境特征信息和深度信息的融合特征矩阵；然后利用残差网络模型进行反演，所述的残差网络模型根据融合特征矩阵预测得到相应的环境剖面信息数据，包括声速和温度信息，并进而可以得到不同环境下的不同深度的环境剖面信息；具体处理过程包括以下步骤：融合特征矩阵作为残差网络模型的输入，将环境特征和深度信息对应的环境剖面信息数据作为残差网络模型的标签输出数据；融合特征矩阵输入给残差网络，残差网络为一维残差网络，残差网络包括多个残差子网络，每个残差子网络的输出信息除了会继续向下传递，同时也会提取出来并分别通过上采样进行维度统一，然后将每个残差子网络对应的维度统一后的输出在通道维度进行密度融合；每一个残差子网络，都会输出一个高维特征矩阵，其通道厚度，可以看做为该特征矩阵的密度，在通道维度对不同大小的残差子网络的输出进行连接，也就拓展了高维特征矩阵的密度，丰富了对不同大小的残差子网络输出的信息的感知。最后经过密度融合后的特征矩阵再通过全局均值池化和全连接层，得到反演的环境剖面信息数据。本实施方式中，残差网络包括4个残差子网络；每个残差子网络的残差处理路径包括多个残差块，残差块的数量根据训练数据的不同，进行优化调整；每个残差块包括两个卷积单元，每个卷积单元依次设置为BN层、ReLU层、Conv层；S4.设置多个用于反演的残差网络模型，每个残差网络模型对应残差子网络中的残差块数量不等，即残差网络模型的残差子网络的深度不同，这样对输入信息的提取整合能力也有不同；将残差子网络中的残差块数量不等的多个残差网络模型称为不同参数网络模型；将训练集数据分别输入到不同参数模型进行训练，得到的多个训练好的残差网络模型；然后分别利用测试集进行测试，选取多个不同参数的模型中测试集效果最好的模型作为最优残差网络模型；S5.在进行实际反演时，根据环境特征和深度信息得到融合特征矩阵，将融合特征矩阵输入最优残差网络模型得到对应的环境剖面信息数据，从而实现试验环境反演。具体实施方式二：本实施方式为一种密度融合的水下试验环境反演系统，包括：数据预处理单元：对提取或输入的环境特征进行预处理，即利用OneHot和Embedding将环境特征信息编码为高维向量，再和深度信息进行拼接，得到融合特征矩阵；密度融合单元：利用残差网络模型对融合特征矩阵进行预测得到对应的环境剖面信息数据，进而实现试验环境反演；所述的残差网络为一维残差网络，残差网络包括多个残差子网络，每个残差子网络的输出信息除了会继续向下传递，同时也会提取出来并分别通过上采样进行维度统一，然后将每个残差子网络对应的维度统一后的输出在通道维度进行密度融合；每一个残差子网络，都会输出一个高维特征矩阵，其通道厚度，可以看做为该特征矩阵的密度，在通道维度对不同大小的残差子网络的输出进行连接，也就拓展了高维特征矩阵的密度，丰富了对不同大小的残差子网络输出的信息的感知；最后经过密度融合后的特征矩阵再通过全局均值池化和全连接层，得到环境剖面信息数据。实施例利用具体实施方式一的方案对水下试验环境进行反演，基于多尺度网络的环境特征提取模型得到的环境特征，进一步作为输入，同时将深度信息作为共同的输入信息，来反演声速剖面和温度剖面。相较于传统的反演环境信息方法的局限性，本发明提出的方法，利用神经网络的拟合能力，通过定义好的网络模型，来学习提取水下环境的信息，对于指定深度的各种信息，都可以学习反演，应用起来相较于传统方法也更简便，同时拓展性也更强，避免了传统方法，需要针对不同水体环境和基于不同的声信号的定义，从多种水声模型、代价函数和优化算法中进行选择的困恼。其中输入数据为环境特征信息和深度信息，环境特征信息会经过OneHot之后，采用Embedding进行编码，然后和深度信息进行组合，得到包含环境特征信息和深度信息的特征矩阵，然后输入给一维残差网络，残差网络由多个残差子网络构成，每个残差网络的输出信息除了会继续向下传递，也会提取出来，通过上采样进行维度统一，然后在通道维度进行密度融合，最后经过全局均值池化和全连接层，得到反演的环境信息。声速剖面和温度剖面的对比图，如图4和图5所示：声速剖面和温度剖面的相对误差和绝对误差如下表所示：表1本发明还可有其它多种实施例，在不背离本发明精神及其实质的情况下，本领域技术人员当可根据本发明作出各种相应的改变和变形，但这些相应的改变和变形都应属于本发明所附的权利要求的保护范围。
