标题title
一种基于Labview与Matlab的油气输运管线危害流型预报及控制方法
摘要abst
本发明公开了一种基于Labview与Matlab的油气输运管线危害流型预报及控制方法，属于石油工程多相流动监测技术领域。首先利用Labview实时采集油气输运管线内部流动稳定时的工况信号，并对采集到的工况信号进行预处理后同步显示；然后将预处理后的工况信号在线传递至Matlab中，通过训练好的流型识别程序进行识别，并将识别结果传回Labview并显示；当识别结果为危害流型时，通过Matlab计算得到油气输运管线立管出口端设置的控制阀开度的上限和下限，并传回Labview，通过控制阀的自动调节消除危害流型。本发明结合了Labview的实时数据采样功能和Matlab精准数据处理能力，实现对于多种管线系统的流型在线准确识别，可拓展性和现场适应性较强。
权利要求书clms
1.一种基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，包括：S1：利用Labview实时采集油气输运管线内部流动稳定时的工况信号，并对采集到的工况信号进行预处理后同步显示；S2：将预处理后的工况信号在线传递至Matlab中，通过训练好的流型识别程序进行识别，并将识别结果传回Labview并显示；S3：当识别结果为危害流型时，通过Matlab计算得到油气输运管线立管出口端设置的控制阀开度的上限和下限，并传回Labview，通过控制阀的自动调节消除危害流型。2.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，S1中，工况信号包括温度信号、压力信号、压差信号和相含率信号，各信号的采集装置分别连接有信号隔离器。3.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，S1中，预处理包括数模转换和降噪滤波。4.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，S1中，Labview采集工况信号的程序基于生产者-消费者模型编写，根据需求进行间断或连续采样，不影响油气输运管线内部的流动状态。5.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，S2中，预处理后的工况信号通过Active X在线传递至Matlab中。6.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，S2中，流型识别程序的建立包括：对已有的流动信号数据进行特征提取，采用BP神经网络对获取的特征值及其相应流型进行训练，得到基于BP神经网络的识别程序。7.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，S2中，通过训练好的流型识别程序对预处理后的工况信号进行识别时，首先使用Matlab的相关函数进行滤波处理和特征提取，然后将特征值输入识别程序，最终得到识别结果。8.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，S3中，基于工况信号中的流量信号、适用手动消除危害流型所需的出口压力经验值和维持稳压的控制阀上下限开度经验值，耦合得到流量信号、压力值和上下限开度的经验关联式；自动控制开启后，固定时间段的流量信号均值导入Matlab中，计算得出控制输入量传回labview，自动计算控制阀开度后，将其换算成模拟电流信号值输出。9.根据权利要求8所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，控制阀采用耐压气动控制阀，自动控制采用二级控制或四级控制模式；采用二级控制模式时，设定上限压力为所述出口压力经验值的102％～105％，下限压力为所述出口压力经验值的95％～98％；当实际压力＞上限压力时，控制阀开度为上限开度；当上限压力＞实际压力＞下限压力时，控制阀开度为上限开度与下限开度之和的1/2；当实际压力＜下限压力时，控制阀开度为下限开度；采用四级控制模式时，设定上限压力为所述出口压力经验值的102％～105％，下限压力为所述出口压力经验值的95％～98％，中间压力为所述出口压力经验值的99％～101％；当实际压力＞上限压力时，控制阀开度为上限开度；当上限压力＞实际压力＞中间压力时，控制阀开度为中上开度；当中间压力＞实际压力＞下限压力时，控制阀开度为中下开度；当实际压力＜下限压力时，控制阀开度为下限开度；中上开度＝60％×+下限开度；中下开度＝40％×+下限开度。10.根据权利要求1所述的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，其特征在于，Labview将采集的工况信号及其识别结果储存至TDMs文件中。
说明书desc
技术领域本发明属于石油工程多相流动监测技术领域，具体涉及一种基于Labview与Matlab的油气输运管线危害流型预报及控制方法。背景技术随着陆地及近海油气资源短缺问题的日益严重，向深海进军成为了能源发展的必然趋势。然而受海洋油气开发技术的制约，海洋能源战略面临着难以打破深水技术装备壁垒的困境，严重影响了深海油田的建设与发展。海洋油田的混输管线形式已不再如陆地油田中简单的水平管或竖直管，而是多种管型相互结合、相互影响的复杂混输管线。总体上，可将海洋油气输运管线视作集输-立管的形式：集输管主要沿海底地形延伸，将油气资源从海底输送至海洋平台下方，其结构主要包括水平管和倾斜管；立管是连接集输管末端与海上采油平台的混输管道，常见形式包括垂直立管、悬链管和S型立管等。集输立管系统中，一条海底管线向下倾斜并以垂直立管连接到平台上时，或者当管道铺设在丘陵地带时，在一定条件下，管道的下部会积聚液体并阻塞气体通道。这样会造成上游的气体被压缩，直到气体压力克服了液体的重力，气体膨胀将长液塞推出。在这种条件下的循环剧烈流动状况称为严重段塞流。严重段塞流被认为是一种不稳定的流动状态，因为它会引起管道压力以及出口气液流量的急剧波动。严重段塞流的主要特征是在垂直立管底部产生极长的液体段塞，这种现象主要发生于低气液流速和管道负倾角的情况下。典型严重段塞流形成过程可分为以下四个阶段主要包括：液塞生长阶段，液塞流出阶段，气泡进入上升管阶段和气液喷出阶段。严重段塞流的典型特征包括长液塞、长周期、气液交替流出、压力大幅波动、存在气液剧烈喷发阶段。在海洋油气集输立管系统中，以严重段塞流为代表的不稳定流型对生产带来诸多危害：井口平均背压高，造成巨大的生产损失；瞬时流量大，导致分离器液控系统不稳定，最终停机；储层流动振荡。由于这些问题，预测和避免在勘探设施项目中出现严重段塞流成为了一项必不可少的任务，从而确保项目的持续生产达到预期水平，提高项目的盈利能力。因此，开发长距离管线的在线流型识别与监控技术，是保障深海油气开发系统安全、稳定、高效生产的迫切需求。之前的研究者主要使用了流型图的方式来判别集输-立管系统的整体流型，但由于构建这些流型图费时费力，同时受流动参数、管道结构等影响较大，当流型图应用于油田实际开发过程中，准确度较低。近年来利用不断成熟的计算机技术，开发的基于神经网络、支持向量机等方法压力压差信号流型识别技术，越来越得到了广泛的应用。但是上述结合计算机技术的方法多使用离线流动特征信号进行分析处理，无法实时对危险流型进行预测和控制。发明内容为了解决上述问题，本发明提供了一种基于Labview与Matlab的油气输运管线危害流型预报及控制方法，结合了Labview的实时数据采样功能和Matlab精准数据处理能力，实现对于多种管线系统的流型在线准确识别，可拓展性和现场适应性较强。本发明是通过以下技术方案来实现：本发明公开了一种基于Labview与Matlab的油气输运管线危害流型预报及控制方法，包括：S1：利用Labview实时采集油气输运管线内部流动稳定时的工况信号，并对采集到的工况信号进行预处理后同步显示；S2：将预处理后的工况信号在线传递至Matlab中，通过训练好的流型识别程序进行识别，并将识别结果传回Labview并显示；S3：当识别结果为危害流型时，通过Matlab计算得到油气输运管线立管出口端设置的控制阀开度的上限和下限，并传回Labview，通过控制阀的自动调节消除危害流型。优选地，S1中，工况信号包括温度信号、压力信号、压差信号和相含率信号，各信号的采集装置分别连接有信号隔离器。优选地，S1中，预处理包括数模转换和降噪滤波。优选地，S1中，Labview采集工况信号的程序基于生产者-消费者模型编写，根据需求进行间断或连续采样，不影响油气输运管线内部的流动状态。优选地，S2中，预处理后的工况信号通过Active X在线传递至Matlab中。优选地，S2中，流型识别程序的建立包括：对已有的流动信号数据进行特征提取，采用BP神经网络对获取的特征值及其相应流型进行训练，得到基于BP神经网络的识别程序。优选地，S2中，通过训练好的流型识别程序对预处理后的工况信号进行识别时，首先使用Matlab的相关函数进行滤波处理和特征提取，然后将特征值输入识别程序，最终得到识别结果。优选地，S3中，基于工况信号中的流量信号、适用手动消除危害流型所需的出口压力经验值和维持稳压的控制阀上下限开度经验值，耦合得到流量信号、压力值和上下限开度的经验关联式；自动控制开启后，固定时间段的流量信号均值导入Matlab中，计算得出控制输入量传回labview，自动计算控制阀开度后，将其换算成模拟电流信号值输出。进一步优选地，控制阀采用耐压气动控制阀，自动控制采用二级控制或四级控制模式；采用二级控制模式时，设定上限压力为所述出口压力经验值的102％～105％，下限压力为所述出口压力经验值的95％～98％；当实际压力＞上限压力时，控制阀开度为上限开度；当上限压力＞实际压力＞下限压力时，控制阀开度为上限开度与下限开度之和的1/2；当实际压力＜下限压力时，控制阀开度为下限开度；采用四级控制模式时，设定上限压力为所述出口压力经验值的102％～105％，下限压力为所述出口压力经验值的95％～98％，中间压力为所述出口压力经验值的99％～101％；当实际压力＞上限压力时，控制阀开度为上限开度；当上限压力＞实际压力＞中间压力时，控制阀开度为中上开度；当中间压力＞实际压力＞下限压力时，控制阀开度为中下开度；当实际压力＜下限压力时，控制阀开度为下限开度；中上开度＝60％×+下限开度；中下开度＝40％×+下限开度。优选地，Labview将采集的工况信号及其识别结果储存至TDMs文件中。与现有技术相比，本发明具有以下有益的技术效果：本发明公开的基于Labview与Matlab的油气输运管线危害流型预报及控制方法，首先Labview软件通过生产者-消费者的模式编程，实现了信号实时监控和间断或持续采集在线样本的功能；其次通过软件间Active X技术将Labview与Matlab耦合连接以实现数据互通，从而确保油气输运管线的在线流型快速精准识别及控制；最后使用Labview实现对采集数据的实时记录，便于后续分析。其中Labview程序保证数据流的实时性与准确性，Matlab程序具备流型识别计算的快速性和精准性。二者之间的耦合，使得油气输运管线在线识别系统响应快且识别结果准。并且针对出现的危害流型，计算得出相应的自动控制阀上下限值，以稳定压力波动，消除危害流型。本发明使得油气输运管线流动数据分析工作更加方便快捷，同时具备很强的可拓展性，可为其它数据采集系统的优化和扩展提供指导和建议。附图说明图1为本发明的方法原理示意图；图2为油气输运管线监控示意图；图3为基于“生产者-消费者”模式的Labview数据采样程序简图；图4为基于Active X技术的Labview与Matlab耦合程序简图；图5为危害流型控制方法流程简图；图6为所采用二级控制的程序简图；图7为所采用四级控制的程序简图。具体实施方式下面结合附图对本发明做进一步详细描述，其内容是对本发明的解释而不是限定：如图1，本发明的系统主要包括用于压力、压差、温度及相含率传感器信号的数据采样下位机，用于数据通讯来完成各项数据显示、处理和储存的上位机，以及实现自动控制的控制模块。上位机位于实验系统的控制台中，通过网络线缆与其它装置实现信号传递。本发明的一种基于Labview与Matlab的油气输运管线危害流型预报及控制方法，包括：S1：利用Labview实时采集油气输运管线内部流动稳定时的工况信号，并对采集到的工况信号进行预处理后同步显示。工况信号包括温度信号、压力信号、压差信号和相含率信号，各信号的采集装置分别连接有信号隔离器。预处理包括数模转换和降噪滤波。Labview采集工况信号的程序基于生产者-消费者模型编写，数据源作为“生产者”，采样提取模块则作为“消费者”，“消费者”则可以根据需求自由选择截取数据样本，而不影响“生产者”的活动。从而实现了持续监测流动信号的同时，获取任意时间段的在线样本。采集样本功能可提供两种模式主要包括：1、任意时间段间断采样，需通过采样按钮控制；2、固定时间段连续循环采样，开机后自动运行。采样过程中，采样点数据实时显示，可通过与监控实时信号对比，以确保其实时性与准确性。S2：将预处理后的工况信号在线传递至Matlab中，通过训练好的流型识别程序进行识别，并将识别结果传回Labview并显示。预处理后的工况信号通过Active X在线传递至Matlab中。流型识别程序的建立包括：对已有的流动信号数据进行特征提取，采用BP神经网络对获取的特征值及其相应流型进行训练，得到基于BP神经网络的识别程序。通过训练好的流型识别程序对预处理后的工况信号进行识别时，首先使用Matlab的相关函数进行滤波处理和特征提取，然后将特征值输入识别程序，最终得到识别结果。S3：当识别结果为危害流型时，通过Matlab计算得到油气输运管线立管出口端设置的控制阀开度的上限和下限，并传回Labview，通过控制阀的自动调节消除危害流型。基于工况信号中的流量信号、适用手动消除危害流型所需的出口压力经验值和维持稳压的控制阀上下限开度经验值，耦合得到流量信号、压力值和上下限开度的经验关联式；自动控制开启后，固定时间段的流量信号均值导入Matlab中，计算得出控制输入量传回Labview，自动计算控制阀开度后，将其换算成模拟电流信号值输出。控制阀采用耐压气动控制阀，自动控制采用二级控制或四级控制模式；采用二级控制模式时，设定上限压力为所述出口压力经验值的102％～105％，下限压力为所述出口压力经验值的95％～98％；当实际压力＞上限压力时，控制阀开度为上限开度；当上限压力＞实际压力＞下限压力时，控制阀开度为上限开度与下限开度之和的1/2；当实际压力＜下限压力时，控制阀开度为下限开度；采用四级控制模式时，设定上限压力为所述出口压力经验值的102％～105％，下限压力为所述出口压力经验值的95％～98％，中间压力为所述出口压力经验值的99％～101％；当实际压力＞上限压力时，控制阀开度为上限开度；当上限压力＞实际压力＞中间压力时，控制阀开度为中上开度；当中间压力＞实际压力＞下限压力时，控制阀开度为中下开度；当实际压力＜下限压力时，控制阀开度为下限开度；中上开度＝60％×+下限开度；中下开度＝40％×+下限开度。Labview将采集的工况信号及其识别结果储存至TDMs文件中。下面以一个具体实施例来对本发明进行进一步的解释说明：本实施例中，信号隔离器和信号采集模块位于上位机的前端，上位机位于实验系统的控制台中，通过网络线缆与上述装置实现信号传递，所述自动控制模块位于油气输运管线中立管出口端。以上部件及部件的组合可以实现集输立管流型识别及控制。信号隔离器设备采用SWP7035，在为各传感器供电的同时，克服变频器噪声及各种高低频脉动干扰，适应于工业生产中信号的采集与监控。信号采集模块由采集机箱NI-9189以及NI-9253采集卡组成，NI-9189为小型便携式数据采集机箱，可使用以太网连接计算机，提供高频率的沿程流动信号，NI-9253采用差分式信号接入方式，以更好的克服信号干扰。自动控制模块由自动控制阀和信号输出卡组成。自动控制阀采用气动的驱动方式，其响应时间短，便于输出信号的快速控制。信号输出卡采用NI-9266，需与数据采集机箱配套使用，可输出4-20mA的电流信号用以控制阀门开度。油气输运管线上安装的温度、压力、压差、相含率等传感器，每一个传感器由相应的信号隔离器来供电并传递信号，后将信号接入数据采集模块，以实现从物理信号至电信号，再转换至模拟信号的数据采集过程。图2为油气输运管线监控示意图。通过将输入的端口与传感器相关联，而后在程序中以数组索引的方式引出不同信号，以曲线形式显示。同时通过编程将每一传感器曲线的可见与不可见属性与相应开关和按钮关联起来，以实现流动信号曲线的便捷显示与隐藏。图3为基于“生产者-消费者”模式的Labview数据采样程序简图。首先通过使用通知器实现对于实时监测信号的二次传输，使得子循环中的采集模式的改变不影响主循环中的信号监测。其次，采样信号实时显示的实现，采样信号的时间长度作为输入量，采样样本长度N即为时间长度×采样频率，通过预先设置一个一维长度为N的0向量，同时该一维0向量实时显示在前面板中。当采样开始时样本点开始不断替换0值，从而达到对于采集样本点实时显示。采样程序中使用按钮判断语句控制内循环的真假，数据采集按钮设置在假分支之中，用以控制假分支中循环的运行与否，并同步赋予其属性真或假于储存数据3按钮。运行后逻辑关系为：单击数据采集按钮，即属性为真，储存数据3按钮属性同步赋予为真，采样循环开启，样本数据点进入数组。同时在真假条件分支循环之前，加入一个自动恢复默认值假的数据采集按钮属性写入。实现了单次点击数据采集按钮后，按钮属性回复默认值。经多次不同采样按钮布置位置尝试后，发现这样的布置方式，使得单次数据采样系统更为稳定。如需切换为连续数据采样，只需将循环内数据采集按钮的恢复默认值属性写入项禁用即可。该程序可以实现任意时间的间断采集样本和固定时间的连续采集样本功能。图4为基于Active X技术的Labview与Matlab耦合程序简图。本发明中使用双流动信号采样的模式，首先打开Matlab程序调用，将采集好的两个流动信号样本以数组形式X和Y导入Matlab工作区中，其中X为样本信号1，Y为样本信号2。其次导入包含特征提取和流型识别的程序，该程序可在Labview程序前面板写入。采用BP神经网络对获取的特征值及相应流型进行训练，得到基于BP神经网络的识别程序；通过将样本数据作为输入量，首先使用相关Matlab函数进行滤波处理，特征提取，后将特征值输入识别程序，最终得到识别结果。待流型识别程序运行结束后，程序将自动导出滤波后的数组i1，i2，a，b和y，其中i1为滤波后样本信号1，i2为滤波后样本信号2，a为样本信号1的特征值，b为样本信号2的特征值，y为识别为三种流型的占比。执行完毕之后，自动关闭Matlab程序，以节约计算内存。图5为危害流型控制方法流程简图。通过Matlab程序计算所得的流型识别结果主要有以下3种：严重段塞流-0、过渡流型-1、稳定流型-2。根据条件语句进行判定。如图5所示，当其阀值小于等于1时，即严重段塞流和过渡流型均为危害流型，程序自动开启自动控制。为防止误识别引起的自动控制，导致阀门憋压、流动受阻等现象，在间断采样流型在线识别模式中，默认为手动开启控制。同时在连续流型在线识别模式下，当连续识别出三个及以上危害流型结果，自动开启控制。基于流动信号中的流量信号与适用手动消除危害流型所需的出口压力值与维持稳压的阀门上下限开度经验数据，耦合得到了流量信号与压力值以及上下限开度的经验关联式。自动控制开启后，其固定时间段流量信号均值导入Matlab程序中计算得出三个控制输入量至Lbview程序中，其耦合技术参考流型识别中的数据交互模式。最后，自动控制系统执行，自动计算阀门开度，并将其换算成模拟电流信号值输出。使用NI-9266作为输出卡，将模拟信号转换为电流信号，实时传送至气动控制阀门，以实现对危害流型的自动控制。如图6所示为自动控制方法中的二级控制的程序框图。运行二级控制的系统参数输入量有三个分别为：压力值、上限开度和下限开度。其中上限压力为压力值加上10，下限压力为压力值减去10。图6中展示了实际压力＞上限压力上限压力＞实际压力＞下限压力实际压力＜下限压力等3种可能操作情况下的阀门输出。如图7所示为自动控制方法中的四级控制的程序框图。运行四级控制的系统参数输入量有四个分别为：压力值、上限开度、中上开度、中下开度和下限开度。其中上限压力为压力值加上10，中间压力为压力值减去2，下限压力为压力值减去10。图7中展示了实际压力＞上限压力上限压力＞实际压力＞中间压力中间压力＞实际压力＞下限压力实际压力＜下限压力等4种可能操作情况下的阀门输出。四级控制相对于二级控制压力更为稳定，消除效果好，但二级控制响应迅速，消除所用时间短。以上所述，仅为本发明实施方式中的部分，本发明中虽然使用了部分术语，但并不排除使用其它术语的可能性。使用这些术语仅仅是为了方便的描述和解释本发明的本质，把它们解释成任何一种附加的限制都是与本发明精神相违背的。以上所述仅以实施例来进一步说明本发明的内容，以便于更容易理解，但不代表本发明的实施方式仅限于此，任何依本发明所做的技术延伸或再创造，均受本发明的保护。
