标题title
一种基于密母神经架构搜索的软件定义网络性能预测方法
摘要abst
本发明涉及软件定义网络性能预测技术领域，具体的说是一种基于密母神经架构搜索的软件定义网络性能预测方法，包括收集训练数据、确定编码方式及搜索空间、初始化种群、计算种群的适应度值、选择父代个体、执行交叉、变异算子、执行局部搜索算子、合并父代和子代种群、精英选择出下一代种群、确定最优的个体以及执行推理过程进行SDN网络性能预测的步骤；本发明将神经架构搜索技术用于设计SDN网络性能预测器的探索，为提升SDN网络性能预测器的泛化能力做出了巨大贡献,借助时兴的神经架构搜索技术，可对任意路由协议/路由策略的通信网络自动化地设计出有效的神经网络结构，极大地缓解了SDN网络性能评估算法设计时巨大的调参压力。
权利要求书clms
1.一种基于密母神经架构搜索的软件定义网络性能预测方法，其特征在于，包括以下步骤：A：收集训练数据；B：确定编码方式及搜索空间，采用可变长度编码作为编码方式以创建更灵活的搜索方式；C：初始化种群，根据步骤B的编码方式，随机初始化m个个体作为初始种群；D：计算种群的适应度值，将步骤C得到的个体转化为对应的BP神经网络，然后训练该神经网络并将其在测试集上对SDN网络性能预测的精度作为该个体的适应度值，用于后续密母算法搜索时判断个体优劣的依据；E：选择父代个体，在计算完每个个体适应度值后，从种群中根据适应度值选出优良的个体，使他们有机会作为父代繁殖后代，采用二进制锦标赛选择的方式从初始化种群/上一代种群中选择个个体作为父代种群；F：执行交叉、变异算子，对父代种群而言，其中的每两个个体进行执行交叉、变异操作生成子代个体并计算其适应度值；G：执行局部搜索算子并计算新生成个体的适应度值；H：合并父代和子代种群，将初始化种群/上一代种群和步骤F、G得到的子代个体进行合并得到合并种群；I：精英选择出下一代种群，对步骤H得到的合并种群的适应度值进行排序，并将适应度值最大的前m个个体作为精英个体进入下一代；J：确定最优的个体，不断重复步骤E至步骤I直至重复200次，即密母算法执行了200代之后，将最后一代种群中适应度值最大的个体作为该种网络配置下的最优个体，它代表的BP网络也就是最后搜索到的最优SDN网络性能预测器；K：执行推理过程进行SDN网络性能预测，将步骤J得到的最优个体，也即训练好的BP网络，仅在测试集上执行一次前馈推理过程得到预测精度，即该种SDN网络配置下SDN网络性能的预测精度。2.根据权利要求1所述的一种基于密母神经架构搜索的软件定义网络性能预测方法，其特征在于，在步骤A中，具体操作方法为：以SDN网络的状态数据为输入样本，以SDN网络中各链路的状态数据为标签，组成一系列样本数据，接下来再将这些样本数据按60％/30％10％的比例划分为训练集/测试集/验证集。3.根据权利要求1所述的一种基于密母神经架构搜索的软件定义网络性能预测方法，其特征在于，进一步的，在步骤B中，具体操作方法为，将密母算法的一个个体表示为，指该个体在种群中的编号，是该个体表示的BP网络的每个隐藏层中神经元的个数，是该个体表示的BP网络的每个隐藏层中的激活函数类型，这里指隐藏层的个数，其值不固定，由密母算法搜索得出。4.根据权利要求1所述的一种基于密母神经架构搜索的软件定义网络性能预测方法，其特征在于，在步骤D中，训练过程具体步骤如下：网络初始化，根据该个体所设定的隐藏层个数、各隐藏层神经元数和激活函数类型搭建对应的BP神经网络，设置BP网络训练的Epoch为300，学习率为0.01，优化器为Adam，并使用Xavier进行网络权重初始化；前馈过程计算，将训练集中的SDN状态数据输入到搭建好的BP神经网络中，根据当前BP网络权值计算各个隐藏层的输出和最后输出层的输出值；误差计算，计算BP网络预测输出和期望输出之间的误差，这里使用均方误差MSE值来衡量；权值更新，根据预测误差更新BP网络中的连接权值，即进行反向传播过程；是否满足终止条件，不断重复以上步骤，直至所有训练数据经历以上前馈和反向传播过程达到300次，即Epoch达到300时训练结束。5.根据权利要求1所述的一种基于密母神经架构搜索的软件定义网络性能预测方法，其特征在于，在步骤E中，每次执行二进制锦标赛选择时，先从种群中任选2个个体，然后将这两个个体中适应度值高的个体作为父代种群中的一员。6.根据权利要求1所述的一种基于密母神经架构搜索的软件定义网络性能预测方法，其特征在于，在步骤F中，具体地，以X0＝{N0,A0}和X1＝{N1,A1}为例，其中N0＝{2,3,2}，A0＝{Sigmoid,Sigmoid,Tanh}，N1＝{3,4}，A1＝{ELU,Tanh}，先以0.8的概率执行单点交叉操作，其中交叉点随机生成，得到X0'＝{N0',A0'}和X1'＝{N1',A1'}两个个体，N0'＝{2,3,4}，A0'＝{Sigmoid,ELU,Tanh}，N1'＝{3,2}，A1'＝{Tanh,ELU,Tanh}；再执行逐基因位变异操作，即对每个基因位以0.2的概率判断是否执行变异操作，得到X0”＝{N0”,A0”}和X1”＝{N1”,A1”}两个个体，N0”＝{2,6,4}，A0”＝{Sigmoid,Tanh,Tanh}，N1”＝{3,2}，A1”＝{Tanh,ELU,Tanh}，通过该交叉、变异操作可得到m个子代个体，然后对这m个子代个体重复步骤D以计算其适应度值。7.根据权利要求1所述的一种基于密母神经架构搜索的软件定义网络性能预测方法，其特征在于，在步骤G中，具体地，对步骤F得到的m个子代个体的适应度值进行排序，将适应度值最大的前5％的个体作为精英个体进行局部扰动，以X1＝{N1,A1}为例，N1＝{3,4}，A1＝{ELU,Tanh}，对N1的每个位置都在原值的基础上分别加减1，A1的每个位置替换为该变量取值范围内的任意其他值，即得到子代个体X1-1＝{N1-1,A1-1}，N1-1＝{2,4}，A1-1＝{Sigmoid,ELU}；X1-2＝{N1-2,A1-2}，N1-2＝{4,4}，A1-2＝{ReLU,Sigmoid}；X1-3＝{N1-3,A1-3}，N1-3＝{3,3}，A1-3＝{Sigmoid,Sigmoid}；X1-4＝{N1-4,A1-4}，N1-4＝{3,5}，A1-2＝{ReLU,ELU}，经过局部搜索得到的子代个体也需要重复步骤D以计算其适应度值。
说明书desc
技术领域本发明涉及一种基于密母神经架构搜索的软件定义网络性能预测方法，属于软件定义网络性能预测技术领域。背景技术软件定义网络将数据平面与控制平面相分离，使得SDN控制器能够在控制平面全局掌控数据层面各设备及链路信息。但如何将网络中物理链路信息与路由策略路径的通信性能相联系却是一个非常复杂的问题，其中SDN网络性能预测已经发展为深度分析SDN网络的必备任务之一。通过对SDN网络性能进行精准预测可以有效获取网络链路的运行状态，有效避免网络突发状况的发生。传统的SDN网络性能预测方法通常基于排队论等方法对网络链路信息和路由策略等进行建模，在建模过程中对网络做出许多前提假设并进行求解，但这些假设往往与真实场景的数据特点相悖，是限制网络性能预测精度提升的关键瓶颈。近年来，越来越多的机器学习模型被用于预测SDN网络性能。尽管这些模型极大程度地提升了预测的精度，但这些模型的组成结构复杂且具有大量的超参数，算法设计师们在设计机器学习模型时需要消耗大量的时间和精力进行试错，以找到最优的机器学习模型结构和参数设置。进一步，已有研究表明，不同路由配置、全连通动态时分协议和多跳自组织时分多址协议等)下的流量传输具有不同的潜在特点，统一的机器学习模型并不能在所有情况下都能实现最优的性能预测结果。因此，如何研究出一种节约试错成本且泛化能力高的SDN网络性能预测器是当前亟待解决的问题。本发明借助时兴的神经架构搜索技术，通过启发式地探索深度网络结构，以最小化网络性能预测误差为目标，自动化地找到不同路由配置下最优的SDN网络性能预测器。有鉴于此特提出本发明。发明内容本发明的目的就在于为了解决上述问题而提供一种基于密母神经架构搜索的软件定义网络性能预测方法，将神经架构搜索技术用于设计SDN网络性能预测器的探索，为提升SDN网络性能预测器的泛化能力做出了巨大贡献,借助时兴的神经架构搜索技术，可对任意路由协议/路由策略的通信网络自动化地设计出有效地神经网络结构，极大地缓解了SDN网络性能评估算法设计时巨大的调参压力。本发明通过以下技术方案来实现上述目的，一种基于密母神经架构搜索的软件定义网络性能预测方法，包括以下步骤：A：收集训练数据；B：确定编码方式及搜索空间，采用可变长度编码作为编码方式以创建更灵活的搜索方式；C：初始化种群，根据步骤B的编码方式，随机初始化m个个体Xi＝{Ni,Ai},i＝1,2,…,m作为初始种群；D：计算种群的适应度值，将步骤C得到的m个个体转化为对应的BP神经网络，然后训练该神经网络并将其在测试集上对SDN网络性能预测的精度作为该个体的适应度值，用于后续密母算法搜索时判断个体优劣的依据；E：选择父代个体，在计算完每个个体适应度值后，从种群中根据适应度值选出优良的个体，使他们有机会作为父代繁殖后代，采用二进制锦标赛选择的方式从初始化种群/上一代种群中选择个个体作为父代种群；F：执行交叉、变异算子，对父代种群而言，其中的每两个个体进行执行交叉、变异操作生成子代个体并计算其适应度值；G：执行局部搜索算子并计算新生成个体的适应度值；H：合并父代和子代种群，将初始化种群/上一代种群和步骤F、G得到的子代个体进行合并得到合并种群；I：精英选择出下一代种群，对步骤H得到的合并种群的适应度值进行排序，并将适应度值最大的前m个个体作为精英个体进入下一代；J：确定最优的个体，不断重复步骤E至步骤I直至重复200次，即密母算法执行了200代之后，将最后一代种群中适应度值最大的个体作为该种网络配置下的最优个体，它代表的BP网络也就是最后搜索到的最优SDN网络性能预测器；K：执行推理过程进行SDN网络性能预测，将步骤J得到的最优个体，也即训练好的BP网络，仅在测试集上执行一次前馈推理过程得到预测精度，即该种SDN网络配置下SDN网络性能的预测精度。进一步的，在步骤A中，具体操作方法为：以SDN网络的状态数据为输入样本，以SDN网络中各链路的状态数据为标签，组成一系列样本数据，接下来再将这些样本数据按60％/30％10％的比例划分为训练集/测试集/验证集。进一步的，在步骤B中，具体操作方法为，将密母算法的一个个体表示为，指该个体在种群中的编号，是该个体表示的BP网络的每个隐藏层中神经元的个数，是该个体表示的BP网络的每个隐藏层中的激活函数类型，这里指隐藏层的个数，其值不固定，由密母算法搜索得出。进一步的，在步骤D中，训练过程具体步骤如下：网络初始化，根据该个体所设定的隐藏层个数、各隐藏层神经元数和激活函数类型搭建对应的BP神经网络，设置BP网络训练的Epoch为300，学习率为0.01，优化器为Adam，并使用Xavier进行网络权重初始化；前馈过程计算，将训练集中的SDN状态数据输入到搭建好的BP神经网络中，根据当前BP网络权值计算各个隐藏层的输出和最后输出层的输出值；误差计算，计算BP网络预测输出和期望输出之间的误差，这里使用均方误差MSE值来衡量；权值更新，根据预测误差更新BP网络中的连接权值，即进行反向传播过程；是否满足终止条件，不断重复以上步骤，直至所有训练数据经历以上前馈和反向传播过程达到300次，即Epoch达到300时训练结束。进一步的，在步骤E中，每次执行二进制锦标赛选择时，先从种群中任选2个个体，然后将这两个个体中适应度值高的个体作为父代种群中的一员。进一步的，在步骤F中，具体地，以X0＝{N0,A0}和X1＝{N1,A1}为例，其中N0＝{2,3,2}，A0＝{Sigmoid,Sigmoid,Tanh}，N1＝{3,4}，A1＝{ELU,Tanh}，先以0.8的概率执行单点交叉操作，其中交叉点随机生成，得到X0'＝{N0',A0'}和X1'＝{N1',A1'}两个个体，N0'＝{2,3,4}，A0'＝{Sigmoid,ELU,Tanh}，N1'＝{3,2}，A1'＝{Tanh,ELU,Tanh}；再执行逐基因位变异操作，即对每个基因位以0.2的概率判断是否执行变异操作，得到X0”＝{N0”,A0”}和X1”＝{N1”,A1”}两个个体，N0”＝{2,6,4}，A0”＝{Sigmoid,Tanh,Tanh}，N1”＝{3,2}，A1”＝{Tanh,ELU,Tanh}。通过该交叉、变异操作可得到m个子代个体，然后对这m个子代个体重复步骤D以计算其适应度值。进一步的，在步骤G中，具体地，对步骤F得到的m个子代个体的适应度值进行排序，将适应度值最大的前5％的个体作为精英个体进行局部扰动，以X1＝{N1,A1}为例，N1＝{3,4}，A1＝{ELU,Tanh}，对N1的每个位置都在原值的基础上分别加减1，A1的每个位置替换为该变量取值范围内的任意其他值，即得到子代个体X1-1＝{N1-1,A1-1}，N1-1＝{2,4}，A1-1＝{Sigmoid,ELU}；X1-2＝{N1-2,A1-2}，N1-2＝{4,4}，A1-2＝{ReLU,Sigmoid}；X1-3＝{N1-3,A1-3}，N1-3＝{3,3}，A1-3＝{Sigmoid,Sigmoid}；X1-4＝{N1-4,A1-4}，N1-4＝{3,5}，A1-2＝{ReLU,ELU}，经过局部搜索得到的子代个体也需要重复步骤D以计算其适应度值。本发明的技术效果和优点：本发明针对SDN网络性能预测器泛化能力差的问题，设计了一种密母神经架构搜索算法自动化地搜索每种SND网络配置下最优的BP网络结构用于高精度地预测SDN网络性能。本发明设计了一种可变长度的BP网络编码方式，可以方便灵活地考虑具有不同隐藏层个数，隐藏层神经单元数和隐藏层激活函数类型的BP神经网络搜索。本发明设计了一种基于精英个体的局部扰动算子进行局部搜索，以进一步提升密母神经架构搜索的搜索效率。附图说明图1为本发明的流程总框架图；图2为本发明中具有3个隐藏层的BP神经网络示例。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。请参阅图1-2所示。一种基于密母神经架构搜索的软件定义网络性能预测方法，包括以下步骤：A：收集训练数据。以SDN网络的状态数据为输入样本，以SDN网络中各链路的状态数据为标签，组成一系列样本数据。接下来，将这些样本数据按60％/30％10％的比例划分为训练集/测试集/验证集；B：确定编码方式及搜索空间。由于BP神经网络的隐藏层个数尚未确定，这里采用可变长度编码作为编码方式以创建更灵活的搜索方式。具体地，可将密母算法的一个个体表示为Xi＝{Ni,Ai}，i指该个体在种群中的编号，是该个体表示的BP网络的每个隐藏层中神经元的个数，/＞是该个体表示的BP网络的每个隐藏层中的激活函数类型，这里h指隐藏层的个数，其值不固定，由密母算法搜索得出。图2中展示了一个具有3个隐藏层的BP神经网络示例，记为X0，其每个隐藏层神经元个数N0＝{6,8,6}，每个隐藏层的激活函数A0＝{ReLU,Tanh,ELU}。为了尽可能扩大搜索空间，为密母算法提供更多潜在的优秀BP网络设置用于提升预测精度，表2中列举出了BP网络中可搜索设置的范围，即密母算法的搜索空间；C：初始化种群。根据步骤B的编码方式，随机初始化m个个体Xi＝{Ni,Ai},i＝1,2,…,m作为初始种群，其中每个个体所代表BP神经网络的隐藏层个数、每个隐藏层神经元个数和激活函数类型均在下表展示的搜索空间中随机生成；BP网络中可搜索变量的范围D：计算种群的适应度值。将步骤C得到的m个个体转化为对应的BP神经网络，然后训练该神经网络并将其在测试集上对SDN网络性能预测的精度作为该个体的适应度值，用于后续密母算法搜索时判断个体优劣的依据。这里，BP神经网络作为一种多层前馈神经网络，通过每次前馈过程的预测误差来调整网络权值和阈值，使得BP网络预测输出不断接近期望输出，其训练过程具体步骤如下：网络初始化。根据该个体所设定的隐藏层个数、各隐藏层神经元数和激活函数类型搭建对应的BP神经网络，设置BP网络训练的Epoch为300，学习率为0.01，优化器为Adam，并使用Xavi er进行网络权重初始化；前馈过程计算。将训练集中的SDN状态数据输入到搭建好的BP神经网络中，根据当前BP网络权值计算h个隐藏层的输出和最后输出层的输出值；误差计算。计算BP网络预测输出和期望输出之间的误差E，这里E使用均方误差MSE值来衡量；权值更新。根据预测误差E更新BP网络中的连接权值，即进行反向传播过程；是否满足终止条件。不断重复以上步骤，直至所有训练数据经历以上前馈和反向传播过程达到300次，即Epoch达到300时训练结束；E：选择父代个体。在计算完每个个体适应度值后，从种群中根据适应度值选出优良的个体，使他们有机会作为父代繁殖后代。本发明采用二进制锦标赛选择的方式从初始化种群/上一代种群中选择个个体作为父代种群。具体地，每次执行二进制锦标赛选择时，先从种群中任选2个个体，然后将这两个个体中适应度值高的个体作为父代种群中的一员；F：执行交叉、变异算子。对父代种群而言，其中的每两个个体进行执行交叉、变异操作生成子代个体。具体地，以X0＝{N0,A0}和X1＝{N1,A1}为例，其中N0＝{2,3,2}，A0＝{Sigmoid,Sigmoid,Tanh}，N1＝{3,4}，A1＝{ELU,Tanh}，先以0.8的概率执行单点交叉操作，其中交叉点随机生成，得到X0'＝{N0',A0'}和X1'＝{N1',A1'}两个个体，N0'＝{2,3,4}，A0'＝{Sigmoid,ELU,Tanh}，N1'＝{3,2}，A1'＝{Tanh,ELU,Tanh}；再执行逐基因位变异操作，即对每个基因位以0.2的概率判断是否执行变异操作，得到X0”＝{N0”,A0”}和X1”＝{N1”,A1”}两个个体，N0”＝{2,6,4}，A0”＝{Sigmoid,Tanh,Tanh}，N1”＝{3,2}，A1”＝{Tanh,ELU,Tanh}。通过该交叉、变异操作可得到m个子代个体，然后对这m个子代个体重复步骤D以计算其适应度值；G：执行局部搜索算子。局部搜索算子在全局搜索的基础上对解的邻近区域进行进一步地探索，以增强算法的收敛速度。密母算法中常见的局部搜索算子包括爬山法、模拟退火法、禁忌搜索等，考虑到本发明中个体编码形式的特殊性，本发明设计了一种基于精英个体的局部扰动算子对优秀的个体进行局部搜索。具体地，对步骤F得到的m个子代个体的适应度值进行排序，将适应度值最大的前5％的个体作为精英个体进行局部扰动。以X1＝{N1,A1}为例，N1＝{3,4}，A1＝{ELU,Tanh}，对N1的每个位置都在原值的基础上分别加减1，A1的每个位置替换为该变量取值范围内的任意其他值，即得到子代个体X1-1＝{N1-1,A1-1}，N1-1＝{2,4}，A1-1＝{Sigmoid,ELU}；X1-2＝{N1-2,A1-2}，N1-2＝{4,4}，A1-2＝{ReLU,Sigmoid}；X1-3＝{N1-3,A1-3}，N1-3＝{3,3}，A1-3＝{Sigmoid,Sigmoid}；X1-4＝{N1-4,A1-4}，N1-4＝{3,5}，A1-2＝{ReLU,ELU}。经过局部搜索得到的子代个体也需要重复步骤D以计算其适应度值；H：合并父代和子代种群。将初始化种群/上一代种群和步骤F、G得到的子代个体进行合并得到合并种群；I：精英选择出下一代种群。选择操作的目的是使种群优胜劣汰，不断进化，并提升种群收敛速度和搜索效率，因此，本发明对步骤H得到的合并种群的适应度值进行排序，并将适应度值最大的前m个个体作为精英个体进入下一代；J：确定最优的个体。不断重复步骤E至步骤I直至重复200次，即密母算法执行了200代之后，将最后一代种群中适应度值最大的个体作为该种网络配置下的最优个体，它代表的BP网络也就是最后搜索到的最优SDN网络性能预测器；K：执行推理过程进行SDN网络性能预测。最后，将步骤J得到的最优个体，也就是训练好的BP网络，仅在测试集上执行一次前馈推理过程得到预测精度，即该种SDN网络配置下SDN网络性能的预测精度。神经架构搜索旨在解决深度学习模型中的结构设计和调参问题，是结合了优化算法和机器学习的交叉研究领域。在深度学习涌现之前由于传统的机器学习模型结构相对简单，算法工程师可将模型结构和超参数手动修改以试探出满意的结果。但随着计算机技术的迅猛发展，SDN网络规模和神经网络结构也逐渐复杂，其超参数的数量呈指数级增长，这给算法工程师设计合适的SDN网络性能预测器带来了更大的挑战。当前强化学习和进化计算是神经架构搜索的两大主流优化策略。与基于强化学习的搜索机制相比，以进化算法为优化策略的编码方式更加灵活，理论研究基础更加深厚，深受人工智能领域专家的青睐。因此，本发明设计了一种基于密母算法的神经架构搜索技术来自动化地探索最优的SDN网络性能预测器，以提升在各个路由配置下的SDN性能预测精度，其中密母算法是一种基于种群的全局搜索和基于个体的局部启发式搜索的结合体，属于进化算法的一个分支。为了便于理解和表述本发明的具体内容，下表中列出了进化算法、神经架构搜索和SDN网络中的术语对应关系。本发明中所用进化算法、神经架构搜索和SDN网络中的术语对应关系解释对于本领域技术人员而言，显然本发明不限于上述示范性实施例的细节，而且在不背离本发明的精神或基本特征的情况下，能够以其他的具体形式实现本发明。因此，无论从哪一点来看，均应将实施例看作是示范性的，而且是非限制性的，本发明的范围由所附权利要求而不是上述说明限定，因此旨在将落在权利要求的等同要件的含义和范围内的所有变化囊括在本发明内。不应将权利要求中的任何附图标记视为限制所涉及的权利要求。此外，应当理解，虽然本说明书按照实施方式加以描述，但并非每个实施方式仅包含一个独立的技术方案，说明书的这种叙述方式仅仅是为清楚起见，本领域技术人员应当将说明书作为一个整体，各实施例中的技术方案也可以经适当组合，形成本领域技术人员可以理解的其他实施方式。
