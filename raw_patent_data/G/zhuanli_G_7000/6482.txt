标题title
一种电子地图绘制的方法及装置
摘要abst
本说明书公开了一种电子地图绘制的方法及装置，获取采集设备上图像采集器采集到的图像序列，针对图像序列中的每帧图像，确定图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿，以通过采集设备上设置的定位传感器得到的定位数据，以及定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿，基于各帧图像的优化后位姿，构建图像序列对应的地理区域的点云空间，根据点云空间，以及各帧图像中交通元素的图像范围，确定各帧图像中交通元素的实际位置，并根据各帧图像中交通元素的实际位置，绘制电子地图中的交通元素，不但能够节省成本，还保证对交通元素进行定位的准确性。
权利要求书clms
1.一种电子地图绘制的方法，其特征在于，包括：获取采集设备上图像采集器采集到的图像序列；针对所述图像序列中的每帧图像，根据该帧图像的图像特征点，确定所述图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿；以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿；基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，其中，每帧图像中的一个图像特征点，在所述点云空间中对应一个点云点；根据所述点云空间，以及所述各帧图像中交通元素的图像范围，确定所述各帧图像中交通元素的实际位置，并根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。2.如权利要求1所述的方法，其特征在于，以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿，具体包括：判断该帧图像是否为关键帧；若该帧图像为关键帧，以通过所述定位传感器得到的定位数据，和所述定位传感器对应的标准坐标系为约束，以及以最小化该帧图像对应的原始误差为约束，对该帧图像对应的位姿进行优化。3.如权利要求2所述的方法，其特征在于，所述方法还包括：若该帧图像不为关键帧，以最小化该帧图像对应的原始误差为约束，对该帧图像对应的位姿进行优化。4.如权利要求2或3所述的方法，其特征在于，以最小化该帧图像对应的原始误差，对该帧图像进行优化之前，所述方法还包括：针对所述图像序列中的每两帧图像，根据该两帧图像对应的位姿，将该两帧图像中相匹配的图像特征点投射到三维空间中，得到该两帧图像对应的三维特征点，其中，三维特征点用于表示图像特征点所对应的事物在真实世界中的位置；以最小化该帧图像对应的原始误差，对该帧图像进行优化，具体包括：根据该帧图像对应的位姿，将该帧图像对应的三维特征点重新投影到该帧图像中，得到投影点；确定所述投影点与该帧图像的三维特征点对应的图像特征点之间的位置差，作为所述原始误差，并以最小化所述原始误差为目标，对该帧图像进行优化。5.如权利要求1或2所述的方法，其特征在于，以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿，具体包括：根据相似变换矩阵，确定该帧图像对应的位姿与采集该帧图像时所述定位传感器确定出的位姿之间的误差，所述相似变换矩阵用于表示所述标准坐标系与所述图像采集器对应的定位坐标系之间的相似变换关系；以最小化所述误差为目标，对所述图像序列中该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿。6.如权利要求2所述的方法，其特征在于，判断该帧图像是否为关键帧，具体包括：若确定该帧图像与上一关键帧的采集位置之间的距离不小于设定距离，确定该帧图像为关键帧；和/或若确定该帧图像对应的图像特征与上一关键帧对应的图像特征之间的差异度不小于设定差异度，确定该帧图像为关键帧。7.如权利要求4所述的方法，其特征在于，基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，具体包括：根据各帧图像的优化后位姿，对投射得到的每个三维特征点进行调整，得到调整后的各三维特征点；根据调整后的各三维特征点，构建所述点云空间。8.如权利要求5所述的方法，其特征在于，基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，具体包括：根据所述相似变换矩阵中包含的尺度参数，对各帧图像的优化后位姿进行尺度恢复，得到各帧图像的更新后的位姿，所述尺度参数用于表示所述定位坐标系与所述标准坐标系之间的尺度关系；根据各帧图像的更新后的位姿，构建所述图像序列对应的地理区域的点云空间。9.如权利要求1所述的方法，其特征在于，根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素，具体包括：根据所述每帧图像中交通元素的实际位置，确定所述每帧图像中不同图像中相同的交通元素，并将相同的交通元素进行整合，得到所述图像序列对应的地理区域内的各交通元素的实际位置；根据所述图像序列对应的地理范围内的各交通元素的实际位置，绘制所述地理区域内的电子地图中的交通元素。10.一种电子地图绘制的装置，其特征在于，包括：获取模块，用于获取采集设备上图像采集器采集到的图像序列；确定模块，用于针对所述图像序列中的每帧图像，根据该帧图像的图像特征点，确定所述图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿；优化模块，用于以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿；构建模块，用于基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，其中，每帧图像中的一个图像特征点，在所述点云空间中对应一个点云点；绘制模块，用于根据所述点云空间，以及所述各帧图像中交通元素的图像范围，确定所述各帧图像中交通元素的实际位置，并根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。11.一种计算机可读存储介质，其特征在于，所述存储介质存储有计算机程序，所述计算机程序被处理器执行时实现上述权利要求1~9任一项所述的方法。12.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现上述权利要求1~9任一项所述的方法。
说明书desc
技术领域本说明书涉及无人驾驶领域，尤其涉及一种电子地图绘制的方法及装置。背景技术在无人驾驶领域中，高精地图是一个极为重要的组成部分，在高精地图中需要记录各交通元素的位置，从而保证无人驾驶设备能够在到达存在交通元素的位置时，及时注意到交通元素，并及时确定出相应的控制策略。在现有技术中，在绘制高精地图中定位交通元素的方式有多种，例如，可以通过设有激光雷达以及相机的地图采集车来对交通元素进行定位，从而根据定位结果在高精地图中绘制出交通元素。但是这一方式成本较高。再例如，还可以通过双目相机来对交通元素进行定位，从而在高精地图中绘制出交通元素，而通过双目相机进行定位的方式需要预先标定出双目相机间的外参，那么定位过程中双目相机中任一个相机的松动容易导致定位结果的不准确。所以，如何降低成本并保证对交通元素进行定位的准确性，则是一个亟待解决的问题。发明内容本说明书提供一种电子地图绘制的方法及装置，以部分的解决现有技术存在的上述问题。本说明书采用下述技术方案：本说明书提供了一种电子地图绘制的方法，包括：获取采集设备上图像采集器采集到的图像序列；针对所述图像序列中的每帧图像，根据该帧图像的图像特征点，确定所述图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿；以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿；基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，其中，每帧图像中的一个图像特征点，在所述点云空间中对应一个点云点；根据所述点云空间，以及所述各帧图像中交通元素的图像范围，确定所述各帧图像中交通元素的实际位置，并根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。可选地，以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿，具体包括：判断该帧图像是否为关键帧；若该帧图像为关键帧，以通过所述定位传感器得到的定位数据，和所述定位传感器对应的标准坐标系为约束，以及以最小化该帧图像对应的原始误差为约束，对该帧图像对应的位姿进行优化。可选地，所述方法还包括：若该帧图像不为关键帧，以最小化该帧图像对应的原始误差为约束，对该帧图像对应的位姿进行优化。可选地，以最小化该帧图像对应的原始误差，对该帧图像进行优化之前，所述方法还包括：针对所述图像序列中的每两帧图像，根据该两帧图像对应的位姿，将该两帧图像中相匹配的图像特征点投射到三维空间中，得到该两帧图像对应的三维特征点，其中，三维特征点用于表示图像特征点所对应的事物在真实世界中的位置；以最小化该帧图像对应的原始误差，对该帧图像进行优化，具体包括：根据该帧图像对应的位姿，将该帧图像对应的三维特征点重新投影到该帧图像中，得到投影点；确定所述投影点与该帧图像的三维特征点对应的图像特征点之间的位置差，作为所述原始误差，并以最小化所述原始误差为目标，对该帧图像进行优化。可选地，以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿，具体包括：根据相似变换矩阵，确定该帧图像对应的位姿与采集该帧图像时所述定位传感器确定出的位姿之间的误差，所述相似变换矩阵用于表示所述标准坐标系与所述图像采集器对应的定位坐标系之间的相似变换关系；以最小化所述误差为目标，对所述图像序列中该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿。可选地，判断该帧图像是否为关键帧，具体包括：若确定该帧图像与上一关键帧的采集位置之间的距离不小于设定距离，确定该帧图像为关键帧；和/或若确定该帧图像对应的图像特征与上一关键帧对应的图像特征之间的差异度不小于设定差异度，确定该帧图像为关键帧。可选地，基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，具体包括：根据各帧图像的优化后位姿，对投射得到的每个三维特征点进行调整，得到调整后的各三维特征点；根据调整后的各三维特征点，构建所述点云空间。可选地，基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，具体包括：根据所述相似变换矩阵中包含的尺度参数，对各帧图像的优化后位姿进行尺度恢复，得到各帧图像的更新后的位姿，所述尺度参数用于表示所述定位坐标系与所述标准坐标系之间的尺度关系；根据各帧图像的更新后的位姿，构建所述图像序列对应的地理区域的点云空间。可选地，根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素，具体包括：根据所述每帧图像中交通元素的实际位置，确定所述每帧图像中不同图像中相同的交通元素，并将相同的交通元素进行整合，得到所述图像序列对应的地理区域内的各交通元素的实际位置；根据所述图像序列对应的地理范围内的各交通元素的实际位置，绘制所述地理区域内的电子地图中的交通元素。本说明书提供了一种电子地图绘制的装置，包括：获取模块，用于获取采集设备上图像采集器采集到的图像序列；确定模块，用于针对所述图像序列中的每帧图像，根据该帧图像的图像特征点，确定所述图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿；优化模块，用于以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿；构建模块，用于基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，其中，每帧图像中的一个图像特征点，在所述点云空间中对应一个点云点；绘制模块，用于根据所述点云空间，以及所述各帧图像中交通元素的图像范围，确定所述各帧图像中交通元素的实际位置，并根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。本说明书提供了一种计算机可读存储介质，所述存储介质存储有计算机程序，所述计算机程序被处理器执行时实现上述电子地图绘制的方法。本说明书提供了一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现上述电子地图绘制的方法。本说明书采用的上述至少一个技术方案能够达到以下有益效果：在本说明书提供的电子地图绘制的方法中，获取采集设备上图像采集器采集到的图像序列，针对图像序列中的每帧图像，根据该帧图像的图像特征点，确定图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿，以通过采集设备上设置的定位传感器得到的定位数据，以及定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿，基于各帧图像的优化后位姿，构建图像序列对应的地理区域的点云空间，根据点云空间，以及各帧图像中交通元素的图像范围，确定各帧图像中交通元素的实际位置，并根据各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。从上述方法中可以看出，本方法只需要通过一个图像采集器采集的图像序列，即可对图像序列中的交通元素进行定位，并且，本方法通过引入定位传感器的定位数据，对仅通过图像采集器确定出的位姿进行优化，从而能够得到准确的位姿，因此可以通过准确的位姿，确定出准确的交通元素的实际位置，以准确对电子地图中的交通元素进行绘制，相比于现有技术不但能够节省成本，还能够保证对交通元素进行定位的准确性。附图说明此处所说明的附图用来提供对本说明书的进一步理解，构成本说明书的一部分，本说明书的示意性实施例及其说明用于解释本说明书，并不构成对本说明书的不当限定。在附图中：图1为本说明书中一种电子地图绘制的方法的流程示意图；图2为本说明书提供的一种进行位姿优化的流程示意图；图3为本说明书提供的一种电子地图绘制的装置的示意图；图4为本说明书提供的一种对应于图1的电子设备的示意图。具体实施方式为使本说明书的目的、技术方案和优点更加清楚，下面将结合本说明书具体实施例及相应的附图对本说明书技术方案进行清楚、完整地描述。显然，所描述的实施例仅是本说明书一部分实施例，而不是全部的实施例。基于本说明书中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本说明书保护的范围。以下结合附图，详细说明本说明书各实施例提供的技术方案。图1为本说明书中一种电子地图绘制的方法的流程示意图，包括以下步骤：S101：获取采集设备上图像采集器采集到的图像序列。S102：针对所述图像序列中的每帧图像，根据该帧图像的图像特征点，确定所述图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿。在实际应用中，运营无人驾驶设备的业务平台需要构建高精地图，而在高精地图中，交通元素是较为重要的信息，因此，业务平台需要对高精地图中的交通元素进行绘制。基于此，业务平台可以获取采集设备上图像采集器采集到的图像序列，该采集设备上设有定位传感器，而后可以针对该图像序列中的每帧图像，根据该帧图像的图像特征点，确定该图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿。这里提到的定位传感器可以是指全球定位系统传感器、惯性测量单元等较为常规的定位传感器。其中，确定该帧图像对应的位姿可以通过多种方式进行确定，例如，业务平台可以从图像序列中确定出基准图像，并以该基准图像对应的位姿作为对图像采集器采集该帧图像时进行定位的定位坐标系，也就是说，该帧图像对应的位姿可以是指该图像采集器采集该帧图像时相对于采集该基准图像时的位姿。根据该帧图像与基准图像之间相匹配的图像特征点，确定出的该帧图像对应的位姿。其中，可以有多种方式选取该基准图像，例如，可以选取出图像序列中首帧图像，作为该基准图像；再例如，也可以将图像序列中与其他帧图像相匹配的图像特征点最多的图像，作为该基准图像。两帧图像之间相匹配的图像特征点可以是指两帧图像之间对应相同图像像素的图像特征点，例如，对于两帧图像来说，这两帧图像中采集到了一栋楼中的一个窗户，这个窗户分别在两帧图像中对应一块像素，则这两帧图像中对应这个窗户的这块像素的图像特征点为相匹配的图像特征点。确定一帧图像中的图像特征点的方式也可以有多种，例如，可以通过sift描述子的方式确定出一帧图像中包含的图像特征点；再例如，可以通过深度学习的方式确定出一帧图像中包含的图像特征点。一帧图像中包含的图像特征点可以表示出这一帧图像中每个能够代表这一图像的关键部分。当然，该图像特征点也可以是指像素点。上述提到的图像采集器可以是指相机、摄像头等常规的图像采集装置，并且，该图像采集器可以是单目相机、单目摄像头，图像序列可以包括一个图像采集器在一段时间内采集到的一连串图像，该图像序列可以为视频。S103：以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿。业务平台确定出该帧图像对应的位姿后，可以将通过采集设备上设置的定位传感器得到的定位数据，以及该定位传感器对应的标准坐标系作为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿。也就是说，仅通过该图像采集器所采集到的图像来确定出的位姿，存在一定的误差，那么对该位姿进行误差优化的方式，可以通过其他传感器所确定出的位姿来进行优化，而通过图像采集器进行定位的定位坐标系与定位传感器进行定位的标准坐标系之间存在一定区别，例如，定位传感器对应的标准坐标系存在尺度信息，而图像采集器对应的定位坐标系不存在尺度信息，因此，可以以定位传感器的定位数据以及定位传感器的标准坐标系为约束，对该帧图像的位姿进行定位。具体在对一帧图像对应的位姿进行优化时，可以根据相似变换矩阵，确定该帧图像对应的位姿与采集该帧图像时定位传感器确定出的位姿之间的误差，并以最小化该误差为目标，对该图像序列中该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿。其中，可以通过该相似变换矩阵将该帧图像对应的位姿转换到标准坐标系下，得到标准坐标系下该帧图像对应的位姿，并确定出标准坐标系下该帧图像对应的位姿与该帧图像对应的采集时间下定位传感器采集的位姿之间的误差，从而最小化该误差，得到优化后的位姿。其中，上述相似变换矩阵可以表示出通过该图像采集器进行定位的定位坐标系与通过定位传感器进行定位的标准坐标系之间的相似变换关系，该相似变换矩阵中可以包括旋转矩阵、平移矩阵以及尺度参数，尺度参数可以表示该定位坐标系与该标准坐标系之间的尺度关系。也就是说，通过该相似变换矩阵可以将定位坐标系下的位姿转换为标准坐标系下的位姿。由于仅通过该图像采集器进行定位得到的各位姿不存在真实的尺度，仅存在距离间的相对比例关系，因此，通过图像采集器定位得到的各位姿间的位移大小仅存在一定比例关系，但是不能确定每个位移是多少米，而通过定位传感器则可以获取到真实的尺度，即，通过定位传感器测量出的位姿存在真实的尺度，从而使得转换到标砖坐标系下的位姿之间的位移也存在真实的尺度。需要说明的是，为了节省计算资源，业务平台可以仅对该图像序列中的部分图像通过相似变换矩阵的方式进行位姿优化，但是其他帧图像也需要进行位姿优化，以保证确定出的位姿的准确性，从而保证确定出的图像中交通元素的位姿的准确性。基于此，业务平台可以判断该帧图像是否为关键帧，若该帧图像为关键帧，则可以，以通过定位传感器得到的定位数据，和定位传感器对应的标准坐标系为约束以及该帧图像对应的原始误差，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿，若该帧图像不为关键帧，则可以根据该帧图像对应的原始误差，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿。也就是说，对于关键帧来说，可以通过相似变换矩阵以及重投影误差，共同对该帧图像对应的位姿进行优化，而对于非关键帧来说，则可以仅通过原始误差来进行优化，通过第一种方式对图像的位姿进行优化，是使得仅通过图像采集器所采集到图像来确定出的图像对应的位姿，能够贴合定位传感器所测量到的位姿，使得通过图像确定出的位姿更加准确，而通过原始误差来对图像的位姿进行优化，也能够在一定程度上消除由图像本身的噪声所带来的确定出的位姿的误差。具体的优化函数可以是以下公式：其中，为在图像为关键帧的情况下所使用的优化函数，为在图像不为关键帧时所使用的优化函数，为原始误差，为相似变换矩阵，为一帧图像对应的位姿，为定位传感器所测量出的位姿，也就是说，为定位传感器所对应的误差函数，为该误差函数对应的权重，该权重可以被预先设定出，不管是该帧图像为关键帧还是非关键帧，可以通过最小化该帧图像对应的误差函数，来优化该帧图像对应的位姿。在确定出上述原始误差时，需要确定出每帧图像中的图像特征点在真实世界中的位置，再将真实世界中的位置重新投影回图像中来进行计算该原始误差，因此，在确定原始误差前，可以针对该图像序列中的每两帧图像，根据该两帧图像对应的位姿，将该两帧图像中相匹配的图像特征点投射到三维空间中，得到该两帧图像对应的三维特征点，三维特征点能够表示出图像特征点在真实世界中的位置，也就是说，这是通过两帧图像之间位姿的关系，确定出两帧图像中每个特征点的实际位置。而后，在确定每帧图像的原始误差时，可以根据该帧图像对应的位姿，将该帧图像对应的三维特征点重新投影到该帧图像中，得到投影点，并确定出投影点与该帧图像对应的三维特征点的图像特征点之间的位置差，作为该原始误差，并以最小化该原始误差为优化目标，对该帧图像对应的位姿进行优化，也就是说，原始误差可以用于表示根据该帧图像对应的三维特征点以及该帧图像对应的位姿重新投影到该帧图像中得到的投影点，与该帧图像中原有的图像特征点之间的误差。需要说明的是，关键帧可以是指图像序列中重复率较低的图像，判断该帧图像是否为关键帧的方式可以有多种，例如，业务平台若确定上一关键帧的采集位置之间的距离不小于设定距离，可以确定该帧图像为关键帧，其中，当采集设备为匀速前行，图像采集器采集图像的间隔时间也是一致的时候，可以通过这一方式来判断图像是否为关键帧；再例如，若业务平台可以确定该帧图像对应的图像特征与上一关键帧对应的图像特征之间的差异度不小于设定差异度，则可以确定该帧图像为关键帧，其中，当采集设备并未均速前进进行图像的采集时，那么可以通过这一方式进行关键帧的判断。S104：基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，其中，每帧图像中的一个图像特征点，在所述点云空间中对应一个点云点。S105：根据所述点云空间，以及所述各帧图像中交通元素的图像范围，确定所述各帧图像中交通元素的实际位置，并根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。业务平台对各帧图像对应的位姿进行优化后，可以基于各帧图像的优化后位姿，构建图像序列对应的地理区域的点云空间，其中，每帧图像中的一个图像特征点，在该点云空间中对应一个点云点，而后，业务平台可以根据该点云空间，以及各帧图像中交通元素的图像范围，确定各帧图像中交通元素的实际位置，并根据各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。上述点云空间可以是指包含有通过各帧图像的优化后位姿，确定出的能够表示出图像序列中各个事物的实际位置的三维点云，这样一来，可以通过该点云空间确定出各交通元素的实际位置，从而在电子地图中绘制交通元素。其中，通过上述图像特征点进行匹配，得到三维特征点的方式，可以构建出该三维点云，构建出的为稀疏点云。需要说明的是，在上述对位姿进行优化的过程中，求解出的是依然可以是定位坐标系下的位姿，因此，还需要对位姿进行尺度恢复，具体的，业务平台可以根据相似变换矩阵中包含的尺度参数，对各帧图像的优化后位姿进行尺度恢复，得到各帧图像的更新后的位姿，根据各帧图像的更新后的位姿，构建该图像序列对应的地理区域的点云空间，这样一来，通过该尺度参数，可以使得位姿存在真实尺度。业务平台可以根据每帧图像中交通元素的实际位置，确定出不同图像中相同的交通元素，从而将相同交通元素进行整合，得到图像序列对应的地理范围内的各交通元素的实际位置，进而根据该图像序列对应的地理范围内的各交通元素的实际位置，绘制该地理范围内的电子地图中的交通元素。这里提到的将相同的交通元素进行整合可以是指：对于一个交通元素来说，通过该交通元素在不同图像中的图像范围，确定出的该交通元素的位置可以存在一定差异，因此，可以将通过不同图像确定出的该交通元素的位置取平均，或是进行加权平均，得到该交通元素的实际位置。也就是说，业务平台可以确定出图像序列中所采集到的不同交通元素，并按照确定出的这些交通元素的实际位置，将这些交通元素绘制到电子地图中，这里提到的电子地图可以是指高精地图，也可以是指其他需要绘制交通元素的常规电子地图，如导航地图。当然，若是需要绘制不同种电子地图中的交通元素，则具体方式则可能会有所不同，例如，对于导航地图来说，可以仅将交通元素的平面位置记录在导航地图中，而通过构建出的点云空间得到的交通元素的实际位置可以是三维位置，因此，可以通过该三维位置确定出该交通元素的平面位置，再将该交通元素绘制在导航地图中。再例如，对于高精地图来说，交通元素可以是以三维的形式绘制在高精地图中的，因此，可以根据通过构建出的点云空间得到的交通元素的三维位置，来绘制出高精地图中的交通元素。在上述内容中提到了，在优化位姿时，需要通过两帧图像的位姿以及相匹配的图像特征点，投射出三维特征点，那么在位姿优化后，可以根据各帧图像的优化后位姿，对投射得到的每个三维特征点进行调整，得到调整后的各三维特征点，并根据调整后的各三维特征点，构建点云空间，也就是说，该点云空间中包含的点云由调整后的各三维特征点组成。需要说明的是，上述提到的相似变换矩阵为在对图像对应的位姿进行优化的过程中，通过每帧图像对应的位姿以及通过定位传感器所采集的位姿，确定出该相似变换矩阵，具体可以通过每帧图像对应的位姿以及通过定位传感器所采集的位姿，构建将每帧图像对应的位姿投影到定位传感器的标准坐标系下的方程，该方程中未知参数包括相似变换矩阵中包含的旋转矩阵、平移矩阵以及尺度参数，而后通过最小二乘法求解出该相似变化矩阵即可。上述提到的无人驾驶设备可以是指无人车、无人机、自动配送设备等能够实现自动驾驶的设备。基于此，通过本说明书提供的电子地图绘制的方法可以用于高精地图中的交通元素的绘制，该无人驾驶设备具体可应用于通过无人驾驶设备进行配送的领域，如，使用无人驾驶设备进行快递、物流、外卖等配送的业务场景。在本说明书中，确定图像对应的三维特征点以及进行位姿优化的顺序，可以根据每一帧图像与其他帧图像之间相匹配的图像特征点的数量来确定，如图2所示。图2为本说明书提供的一种进行位姿优化的流程示意图。如图2所示，可以从图像序列中先选取出基准图像，该基准图像可以是指与其他帧图像具备最多相匹配的图像特征点的图像，而后可以选取出新的一帧图像，其中，可以选取出与之前选取出的所有图像相匹配的图像特征点一致的图像。根据这一帧图像与前一帧图像之间相匹配的特征点，确定出这一帧图像对应的三维特征点，并针对这一帧图像进行位姿优化。若这一帧图像为关键帧，则可以通过最小化这一优化函数对该帧图像对应的位姿进行优化，若这一帧图像不为关键帧，则可以通过最小化这一优化函数对该帧图像对应的位姿进行优化，直到将图像序列中所有图像对应的位姿优化完毕，从而通过优化后的位姿准确确定出图像序列中每个图像特征点的实际位置，以准确确定出交通元素的位置。从上述方法可以看出，本方法只需要通过一个图像采集器采集的图像序列，即可对图像序列中的交通元素进行定位，并且，本方法通过引入实时确定出的相似变换矩阵，可以对仅通过图像采集器确定出的位姿进行优化，从而能够得到准确的位姿，因此可以通过准确的位姿，确定出准确的交通元素的实际位置，从而准确对电子地图中的交通元素进行绘制。不但如此，通过区分关键帧和非关键帧，能够在位姿优化的过程中节省计算资源，并且通过该相似变换矩阵中包含的尺度参数，能够使得通过图像采集器确定出的位姿拥有真实的尺度，从而能够实现仅通过一个图像采集器来定位交通元素的方式，相比于现有技术不但能够节省计算资源，还能够保证对交通元素进行定位的准确性。以上为本说明书的一个或多个实施例提供的电子地图绘制的方法，基于同样的思路，本说明书还提供了相应的电子地图绘制的装置，如图3所示。图3为本说明书提供的一种电子地图绘制的装置示意图，包括：获取模块301，用于获取采集设备上图像采集器采集到的图像序列；确定模块302，用于针对所述图像序列中的每帧图像，根据该帧图像的图像特征点，确定所述图像采集器采集该帧图像时的位姿，作为该帧图像对应的位姿；优化模块303，用于以通过所述采集设备上设置的定位传感器得到的定位数据，以及所述定位传感器对应的标准坐标系为约束，对该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿；构建模块304，用于基于各帧图像的优化后位姿，构建所述图像序列对应的地理区域的点云空间，其中，每帧图像中的一个图像特征点，在所述点云空间中对应一个点云点；绘制模块305，用于根据所述点云空间，以及所述各帧图像中交通元素的图像范围，确定所述各帧图像中交通元素的实际位置，并根据所述各帧图像中交通元素的实际位置，绘制电子地图中的交通元素。可选地，所述优化模块303用于，判断该帧图像是否为关键帧；若该帧图像为关键帧，以通过所述定位传感器得到的定位数据，和所述定位传感器对应的标准坐标系为约束，以及以最小化该帧图像对应的原始误差为约束，对该帧图像对应的位姿进行优化。可选地，所述优化模块303还用于，若该帧图像不为关键帧，以最小化该帧图像对应的原始误差为约束，对该帧图像对应的位姿进行优化。可选地，以最小化该帧图像对应的原始误差，对该帧图像进行优化之前，所述优化模块303还用于，针对所述图像序列中的每两帧图像，根据该两帧图像对应的位姿，将该两帧图像中相匹配的图像特征点投射到三维空间中，得到该两帧图像对应的三维特征点，其中，三维特征点用于表示图像特征点所对应的事物在真实世界中的位置；所述优化模块303具体用于，根据该帧图像对应的位姿，将该帧图像对应的三维特征点重新投影到该帧图像中，得到投影点；确定所述投影点与该帧图像的三维特征点对应的图像特征点之间的位置差，作为所述原始误差，并以最小化所述原始误差为目标，对该帧图像进行优化。所述优化模块303还用于，根据相似变换矩阵，确定该帧图像对应的位姿与采集该帧图像时所述定位传感器确定出的位姿之间的误差，所述相似变换矩阵用于表示所述标准坐标系与所述图像采集器对应的定位坐标系之间的相似变换关系；以最小化所述误差为目标，对所述图像序列中该帧图像对应的位姿进行优化，得到该帧图像的优化后位姿。所述优化模块303还用于，若确定该帧图像与上一关键帧的采集位置之间的距离不小于设定距离，确定该帧图像为关键帧；和/或若确定该帧图像对应的图像特征与上一关键帧对应的图像特征之间的差异度不小于设定差异度，确定该帧图像为关键帧。可选地，所述构建模块304具体用于，根据各帧图像的优化后位姿，对投射得到的每个三维特征点进行调整，得到调整后的各三维特征点；根据调整后的各三维特征点，构建所述点云空间。可选地，所述构建模块304具体用于，根据所述相似变换矩阵中包含的尺度参数，对各帧图像的优化后位姿进行尺度恢复，得到各帧图像的更新后的位姿，所述尺度参数用于表示所述定位坐标系与所述标准坐标系之间的尺度关系；根据各帧图像的更新后的位姿，构建所述图像序列对应的地理区域的点云空间。可选地，所述绘制模块305具体用于，根据所述每帧图像中交通元素的实际位置，确定所述每帧图像中不同图像中相同的交通元素，并将相同的交通元素进行整合，得到所述图像序列对应的地理区域内的各交通元素的实际位置；根据所述图像序列对应的地理范围内的各交通元素的实际位置，绘制所述地理区域内的电子地图中的交通元素。本说明书还提供了一种计算机可读存储介质，该存储介质存储有计算机程序，计算机程序可用于执行上述图1提供的一种电子地图绘制的方法。本说明书还提供了图4所示的一种对应于图1的电子设备的示意结构图。如图4所述，在硬件层面，该电子设备包括处理器、内部总线、网络接口、内存以及非易失性存储器，当然还可能包括其他业务所需要的硬件。处理器从非易失性存储器中读取对应的计算机程序到内存中然后运行，以实现上述图1所述的电子地图绘制的方法。当然，除了软件实现方式之外，本说明书并不排除其他实现方式，比如逻辑器件抑或软硬件结合的方式等等，也就是说以下处理流程的执行主体并不限定于各个逻辑单元，也可以是硬件或逻辑器件。在20世纪90年代，对于一个技术的改进可以很明显地区分是硬件上的改进还是软件上的改进。然而，随着技术的发展，当今的很多方法流程的改进已经可以视为硬件电路结构的直接改进。设计人员几乎都通过将改进的方法流程编程到硬件电路中来得到相应的硬件电路结构。因此，不能说一个方法流程的改进就不能用硬件实体模块来实现。例如，可编程逻辑器件）就是这样一种集成电路，其逻辑功能由用户对器件编程来确定。由设计人员自行编程来把一个数字系统“集成”在一片PLD上，而不需要请芯片制造厂商来设计和制作专用的集成电路芯片。而且，如今，取代手工地制作集成电路芯片，这种编程也多半改用“逻辑编译器”软件来实现，它与程序开发撰写时所用的软件编译器相类似，而要编译之前的原始代码也得用特定的编程语言来撰写，此称之为硬件描述语言，而HDL也并非仅有一种，而是有许多种，如ABEL、AHDL、Confluence、CUPL、HDCal、JHDL、Lava、Lola、MyHDL、PALASM、RHDL等，目前最普遍使用的是VHDL与Verilog。本领域技术人员也应该清楚，只需要将方法流程用上述几种硬件描述语言稍作逻辑编程并编程到集成电路中，就可以很容易得到实现该逻辑方法流程的硬件电路。控制器可以按任何适当的方式实现，例如，控制器可以采取例如微处理器或处理器以及存储可由该处理器执行的计算机可读程序代码的计算机可读介质、逻辑门、开关、专用集成电路、可编程逻辑控制器和嵌入微控制器的形式，控制器的例子包括但不限于以下微控制器：ARC 625D、Atmel AT91SAM、Microchip PIC18F26K20 以及Silicone Labs C8051F320，存储器控制器还可以被实现为存储器的控制逻辑的一部分。本领域技术人员也知道，除了以纯计算机可读程序代码方式实现控制器以外，完全可以通过将方法步骤进行逻辑编程来使得控制器以逻辑门、开关、专用集成电路、可编程逻辑控制器和嵌入微控制器等的形式来实现相同功能。因此这种控制器可以被认为是一种硬件部件，而对其内包括的用于实现各种功能的装置也可以视为硬件部件内的结构。或者甚至，可以将用于实现各种功能的装置视为既可以是实现方法的软件模块又可以是硬件部件内的结构。上述实施例阐明的系统、装置、模块或单元，具体可以由计算机芯片或实体实现，或者由具有某种功能的产品来实现。一种典型的实现设备为计算机。具体的，计算机例如可以为个人计算机、膝上型计算机、蜂窝电话、相机电话、智能电话、个人数字助理、媒体播放器、导航设备、电子邮件设备、游戏控制台、平板计算机、可穿戴设备或者这些设备中的任何设备的组合。为了描述的方便，描述以上装置时以功能分为各种单元分别描述。当然，在实施本说明书时可以把各单元的功能在同一个或多个软件和/或硬件中实现。本领域内的技术人员应明白，本说明书的实施例可提供为方法、系统、或计算机程序产品。因此，本说明书可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本说明书可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本说明书是参照根据本说明书实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。在一个典型的配置中，计算设备包括一个或多个处理器、输入/输出接口、网络接口和内存。内存可能包括计算机可读介质中的非永久性存储器，随机存取存储器和/或非易失性内存等形式，如只读存储器或闪存。内存是计算机可读介质的示例。计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存、静态随机存取存储器、动态随机存取存储器、其他类型的随机存取存储器、只读存储器、电可擦除可编程只读存储器、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体，如调制的数据信号和载波。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。本领域技术人员应明白，本说明书的实施例可提供为方法、系统或计算机程序产品。因此，本说明书可采用完全硬件实施例、完全软件实施例或结合软件和硬件方面的实施例的形式。而且，本说明书可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本说明书可以在由计算机执行的计算机可执行指令的一般上下文中描述，例如程序模块。一般地，程序模块包括执行特定任务或实现特定抽象数据类型的例程、程序、对象、组件、数据结构等等。也可以在分布式计算环境中实践本说明书，在这些分布式计算环境中，由通过通信网络而被连接的远程处理设备来执行任务。在分布式计算环境中，程序模块可以位于包括存储设备在内的本地和远程计算机存储介质中。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于系统实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。以上所述仅为本说明书的实施例而已，并不用于限制本说明书。对于本领域技术人员来说，本说明书可以有各种更改和变化。凡在本说明书的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本说明书的权利要求范围之内。
