标题title
一种适用于2D地层模型的随钻电磁波测井跨维模拟方法
摘要abst
本发明公开一种适用于2D模型的随钻电磁波测井跨维模拟方法，包括以下步骤：s1.输入仪器参数、地层模型等信息：s2.确定随钻电磁波测井正演模拟计算域；s3.对模型进行变尺度滑动开窗处理；s4.计算模型复杂度因子；s5.判断模型复杂度因子是否大于阈值，如果是，则执行步骤s6，否则，执行步骤s9；s6.对模拟结果进行降维合理性分析，计算模型质量控制因子；s7.判断模型质量控制因子是否大于阈值，如果是，则执行步骤s8，否则，执行步骤s9；s8.采用2.5D算法计算原始的2D地层模型响应；s9.采用解析解法求解简化的1D地层模型响应，获得模拟结果。本发明可根据地层模型自适应选择最佳算法实现2D地层模型随钻电磁波测井快速精确地正演模拟。
权利要求书clms
1.一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，其特征在于包括以下步骤：s1.获取仪器参数：仪器频率和源距信息；获取地层模型：地层界面坐标、各层电阻率信息；获取仪器与地层相对位置关系、深度记录点信息；s2.根据步骤s1所获取仪器参数与地层模型确定随钻电磁波测井正演模拟计算域；s3.对地层模型进行变尺度滑动开窗处理，将正演模拟计算域内地层模型转化为一系列简化的模型；s4.提取各简化的模型的界面位置信息，对简化的模型进行模型复杂度分析，计算模型复杂度因子；s5.判断模型复杂度因子是否大于复杂度因子的阈值，如果是，则执行步骤s6，否则，执行步骤s9；s6.模拟随钻电磁波测井在各简化模型中的响应，对模拟结果进行降维合理性分析，计算模型质量控制因子；s7.判断模型质量控制因子是否大于质量控制因子的阈值，如果是，则执行步骤s8，否则，执行步骤s9；s8.采用2.5D算法计算原始的2D地层模型响应，获得模拟计算结果；s9.采用解析解法求解简化的1D地层模型响应，获得模拟计算结果。2.根据权利要求1所述的一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，其特征在于，所述步骤s2具体包括以下步骤：s2.1根据仪器频率和地层电阻率，计算电磁波在地层中的趋肤深度；s2.2计算地层的平均趋肤深度，记为δ；s2.3随钻电磁波测井的正演模拟计算域为以仪器发射线圈为中心、长和宽均为6倍趋肤深度6·δ的矩形区域。3.根据权利要求1所述的一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，其特征在于，所述步骤s3中，变尺度滑动开窗处理步骤为：在正演模拟计算域范围内以深度记录点为中心，选取一组不同宽度的滑动窗口，将高维地层模型简化为一系列相互平行的1D多层介质模型。4.根据权利要求3所述的一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，其特征在于，具体步骤如下：在记录点计算域内，首先利用变尺度滑动窗口法选取一系列窗口宽度，提取地层界面位置及相应斜率，采用以直代曲的方式即利用界面坐标和斜率作直线并沿长简化地层，形成无弯曲界面的简化模型；其次，分别提取各窗口内地层界面位置及斜率，作为模型简化参数；最后，针对任意一个窗口，将某一界面斜率应用于所有界面，得到一系列1D简化模型。5.根据权利要求1所述的一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，其特征在于，所述步骤s4具体包括以下步骤：s4.1提取基于变尺度滑动窗口内简化模型的地层界面位置；s4.2对比实际地层界面位置和仪器位置，定义模型复杂度因子Fmc为：公式中，n为变尺度滑动开窗方法得到的1D模型个数，Zi为第i个滑动窗口中简化模型离散的地层界面位置向量；ZM为滑动窗口中真实模型离散的地层界面位置向量；ZT为滑动窗口内仪器位置向量；||Zi-ZM||2为第i个滑动窗口简化模型地层界面向量与实际地层界面向量之差的L2范数，表示简化模型与原始模型的差异；||ZM-ZT||2表示滑动窗口内仪器距地层界面的差异；s4.3计算模型复杂度因子。6.根据权利要求1所述的一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，其特征在于，所述步骤s6具体包括以下步骤：s6.1分别基于变尺度滑动开窗法和传统滑动开窗法简化的1D模型，采用解析解法计算每个窗口的相位差与幅度比响应；s6.2定义模型质量控制因子：公式中，n为滑动窗口个数，m为窗口内界面数，APN0为参考模型无量纲化后的响应，ωi为第i个界面模型的权重，DT为仪器与界面的距离；s6.3计算模型质量控制因子。
说明书desc
技术领域本发明涉及石油勘探开发领域，具体涉及电测井方法，更为具体地说是涉及一种适用于2D地层模型的随钻电磁波测井跨维模拟方法。背景技术随钻电磁波测井因其探测深度大、对地层电阻率敏感，在大斜度井/水平井钻井实时地质导向以及储层精细评价中得以广泛应用。但是受围岩、井斜等因素影响，随钻电磁波测井响应复杂，因而，随钻电磁波测井的钻前正演、实时反演及钻后评价均需要一套快速的正演模拟方法。目前，为了满足随钻电磁波测井实时资料处理的需要，业内主要采用针对1D模型的解析方法和针对2D模型的2.5D算法，前者模拟速度快，后者则适用于更加复杂的2D地层模型。然而，目前为止，随钻电磁波测井模拟的速度和模型复杂度之间仍然是一对矛盾体，具体说来：将地层模型简化为1D，采用解析法求解，其模拟速度快，但是地层结构复杂时，模拟精度低；采用2D地层模型时，可以很好地模拟地层结构，得到精确的响应，但其模拟速度慢，难以满足实时数据处理的需要。发明内容基于上述技术问题，本发明提出一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，该方法可为复杂地质构造中随钻电磁波测井实时地质导向和储层评价提供一套快速、精确的正演方法。本发明所采用的技术解决方案是：一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，包括以下步骤：s1.获取仪器参数：仪器频率和源距信息；获取地层模型：地层界面坐标、各层电阻率信息；获取仪器与地层相对位置关系、深度记录点信息；s2.根据步骤s1所获取仪器参数与地层模型确定随钻电磁波测井正演模拟计算域；s3.对地层模型进行变尺度滑动开窗处理，将正演模拟计算域内地层模型转化为一系列简化的模型；s4.提取各简化的模型的界面位置信息，对简化的模型进行模型复杂度分析，计算模型复杂度因子；s5.判断模型复杂度因子是否大于复杂度因子的阈值，如果是，则执行步骤s6，否则，执行步骤s9；s6.模拟随钻电磁波测井在各简化模型中的响应，对模拟结果进行降维合理性分析，计算模型质量控制因子；s7.判断模型质量控制因子是否大于质量控制因子的阈值，如果是，则执行步骤s8，否则，执行步骤s9；s8.采用2.5D算法计算原始的2D地层模型响应，获得模拟计算结果；s9.采用解析解法求解简化的1D地层模型响应，获得模拟计算结果。优选的，所述步骤s2具体包括以下步骤：s2.1根据仪器频率和地层电阻率，计算电磁波在地层中的趋肤深度；s2.2计算地层的平均趋肤深度，记为δ；s2.3随钻电磁波测井的正演模拟计算域为以仪器发射线圈为中心、长和宽均为6倍趋肤深度6·δ的矩形区域。优选的，所述步骤s3中，变尺度滑动开窗处理步骤为：在正演模拟计算域范围内以深度记录点为中心，选取一组不同宽度的滑动窗口，将高维地层模型简化为一系列相互平行的1D多层介质模型。更加优选，具体步骤如下：在记录点计算域内，首先利用变尺度滑动窗口法选取一系列窗口宽度，提取地层界面位置及相应斜率，采用以直代曲的方式即利用界面坐标和斜率作直线并沿长简化地层，形成无弯曲界面的简化模型；其次，分别提取各窗口内地层界面位置及斜率，作为模型简化参数；最后，针对任意一个窗口，将某一界面斜率应用于所有界面，得到一系列1D简化模型。优选的，所述步骤s4具体包括以下步骤：s4.1提取基于变尺度滑动窗口内简化模型的地层界面位置；s4.2对比实际地层界面位置和仪器位置，定义模型复杂度因子Fmc为：公式中，n为变尺度滑动开窗方法得到的1D模型个数，Zi为第i个滑动窗口中简化模型离散的地层界面位置向量；ZM为滑动窗口中真实模型离散的地层界面位置向量；ZT为滑动窗口内仪器位置向量；||Zi-ZM||2为第i个滑动窗口简化模型地层界面向量与实际地层界面向量之差的L2范数，表示简化模型与原始模型的差异；||ZM-ZT||2表示滑动窗口内仪器距地层界面的差异；s4.3计算模型复杂度因子。优选的，所述步骤s6具体包括以下步骤：s6.1分别基于变尺度滑动开窗法和传统滑动开窗法简化的1D模型，采用解析解法计算每个窗口的相位差与幅度比响应；s6.2定义模型质量控制因子：公式中，n为滑动窗口个数，m为窗口内界面数，APN0为参考模型无量纲化后的响应，ωi为第i个界面模型的权重，DT为仪器与界面的距离；s6.3计算模型质量控制因子。上述模型复杂度因子阈值和质量控制因子阈值均可根据数值实验或经验确定。本发明的有益技术效果是：本发明提供了一种适用于2D地层模型的随钻电磁波测井快速精确的跨维模拟方法，该方法通过对计算域内2D地层模型进行模型复杂度分析与降维合理性分析，实现根据地层条件跨维匹配最优正演模拟算法，从而极大提高了2D地层模型随钻电磁波测井模拟的速度和精度。本发明采用变尺度滑动开窗方法，通过对比各简化窗口与实际模型的差异，并充分考虑仪器距界面距离的影响，对计算域内的地层模型复杂度进行初步判断，对符合简化条件的地层直接采用1D解析解求取仪器响应；对复杂地层通过降维分析评价模型简化的合理性，判断是否采用2.5D正演算法。模型分析过程计算成本可忽略不计，而降维分析过程只需n+1次1D快速正演模拟，有效提高了2D地层模型随钻电磁波测井正演模拟的计算效率，为随钻电磁波测井实时反演及钻后评价提供可靠支持。附图说明图1为本发明中随钻电磁波测井跨维模拟方法的流程图；图2为本发明中变尺度滑动窗口以直代曲示意图；图3为滑动窗口内1D模型生成示意图；图4为本发明中2D断层模型随钻电磁波测井1D模拟结果；图5为本发明中2D断层模型随钻电磁波测井跨维因子；图6为本发明中2D断层模型随钻电磁波测井跨维模拟结果。具体实施方式本发明公开了一种适用于2D模型的随钻电磁波测井跨维模拟方法，其包括步骤：s1.获取仪器参数、地层模型以及仪器与地层相对位置关系、深度记录点等信息：s2.确定随钻电磁波测井正演模拟计算域；s3.对模型进行变尺度滑动开窗处理，将原始计算域内地层模型转化为一系列简化的地层模型；s4.对简化的模型进行模型复杂度分析，计算模型复杂度因子；s5.判断模型复杂度因子是否大于阈值，如果是，则执行步骤s6，否则，执行步骤s9；s6.模拟随钻电磁波测井在各简化模型中的响应，对模拟结果进行降维合理性分析，计算模型质量控制因子；s7.判断模型质量控制因子是否大于阈值，如果是，则执行步骤s8，否则，执行步骤s9；s8.采用2.5D算法计算原始的2D地层模型响应，计算获得模拟结果；s9.采用解析解法求解简化的1D地层模型响应，计算获得模拟结果。本发明可根据地层模型自适应选择最佳算法实现2D地层模型随钻电磁波测井快速精确地正演模拟。下面结合附图以及具体实施方式对本发明作进一步详细说明：如图1所示，一种适用于2D地层模型的随钻电磁波测井跨维模拟方法，包括如下步骤：s1.获取仪器参数：仪器频率和源距等信息；地层模型：地层界面坐标、各层电阻率等信息；并获取仪器与地层相对位置关系、深度记录点等信息。s2.确定随钻电磁波测井正演模拟计算域，具体方法如下：根据仪器频率和地层电阻率，计算电磁波在地层中的趋肤深度；计算地层的平均趋肤深度记为δ；地层的正演模拟计算域为以仪器发射线圈为中心、长和宽均为6倍趋肤深度的矩形区域。s3.对模型进行变尺度滑动开窗处理，将原始计算域内地层模型转化为一系列简化的地层模型。如图2和图3所示，在记录点计算域内，首先利用变尺度滑动窗口法选取一系列窗口宽度，提取地层界面位置及相应斜率，采用以直代曲的方式即利用界面坐标和斜率作直线并延长简化地层，形成无弯曲界面的简化模型；其次，分别提取各窗口内地层界面位置及斜率，作为模型简化参数；最后，针对任意一个窗口，将某一界面斜率应用于所有界面，得到一系列1D简化模型。s4.提取各简化模型的界面位置信息，对简化的模型进行模型复杂度分析，计算模型复杂度因子。具体步骤如下：s4.1提取基于变尺度滑动窗口内简化模型的地层界面位置。s4.2对比实际地层界面位置和仪器位置，定义模型复杂度因子Fmc为：公式中，n为变尺度滑动开窗方法得到的1D模型个数，Zi为第i个滑动窗口中简化模型离散的地层界面位置向量；ZM为滑动窗口中真实模型离散的地层界面位置向量；ZT为滑动窗口内仪器位置向量；||Zi-ZM||2为第i个滑动窗口简化模型地层界面向量与实际地层界面向量之差的L2范数，表示简化模型与原始模型的差异；||ZM-ZT||2表示滑动窗口内仪器距地层界面的差异。s4.3计算模型复杂度因子，根据数值实验确定模型复杂度因子Fmc的阈值。s5.判断模型复杂度因子是否大于阈值，如果是，则执行步骤s6，否则，执行步骤s9。s6.模拟随钻电磁波测井在各简化模型中的响应，对模拟结果进行降维合理性分析，计算模型质量控制因子。具体步骤如下：s6.1分别基于变尺度滑动开窗法和传统滑动开窗法简化的1D模型，采用解析解法计算每个窗口的相位差与幅度比响应；s6.2定义模型质量控制因子：公式中，n为滑动窗口个数，m为窗口内界面数，APN0为参考模型无量纲化后的响应，ωi为第i个界面模型的权重，DT为仪器与界面的距离。s6.3根据数值实验确定模型质量控制因子阈值。s7.判断模型质量控制因子是否大于模型质量控制因子阈值，如果是，则执行步骤s8，否则，执行步骤s9。s8.采用2.5D算法计算原始的2D地层模型响应，计算获得模拟结果。s9.采用解析解法求解简化的1D地层模型响应，计算获得模拟结果。下面以断层模型为例阐述适用于2D地层模型的随钻电磁波测井跨维模拟方法，以验证本发明方法的有效性。如图4，断层下盘为电阻率为1Ω·m的低阻地层，上盘的上层为电阻率2Ω·m的低阻盖层，下层为电阻率20Ω·m的高阻储层，断层面与水平面夹角为30°。一水平井沿储层上界面自左向右钻穿断层面，井眼与地层界面距离为0.5m。图4上部为2MHz-28in.仪器视电阻率曲线，其中实线为2D模型模拟结果，三角形和五角星为简化1D模型结果。可以看出，仪器远离断层面时，采用简化1D模型得到的结果与原2D模型结果基本重合，表明模型简化合理，而当仪器在断层面附近时，采用1D简化模型将产生较大误差。如图5为沿井轨迹的模型控制因子和跨维控制因子，控制因子在断层面附近迅速增大，并随着仪器远离断层面不断减小，表明其可较好地反映模型降维的合理性。如图6为2D断层模型随钻电磁波测井跨维模拟结果，可以看出，本发明方法可自动选取模型维数，并得到准确结果。当然，以上说明仅仅为本发明的较佳实施例，本发明并不限于列举上述实施例，应当说明的是，任何熟悉本领域的技术人员在本说明书的教导下，所做出的所有等同替代、明显变形形式，均落在本说明书的实质范围之内，理应受到本发明的保护。
