标题title
一种基于堆栈式自动编码的力触觉信号处理方法
摘要abst
本发明提供一种基于堆栈式自动编码的力触觉信号处理方法，属于数字信号处理领域。应用堆栈式自动编码的编码部分将从物理表面获取到的体现其形状和纹理的关键信息的力触觉数据进行实时压缩，从原始力触觉信号中提取出维度远小于其自身的特征，考虑到特征在传输过程中会混入的噪声，在接收端采用长短时记忆网络作为滤波器对带噪特征进行滤波，滤波后的特征利用堆栈式自动编码的解码部分将其重构到与原始数据相同的维度，实现了信号的压缩和恢复。优点是可以通过毫秒级的执行时间在线实现，提高了力触觉信号的压缩比，能够在一定程度上去除数据在信道传输过程中带来的噪声，保证较低的重构误差。
权利要求书clms
1.一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于，包括下列步骤：应用矩形权重矩阵和偏置向量对原始触觉信号进行降维，得到触觉信号的特征；应用矩形权重矩阵和偏置向量将特征重构，恢复到输入信号相同的维度，得到触觉信号的重构；计算原始触觉信号与重构的触觉信号间的平均相对误差对误差进行求导沿着导数下降的方向更新权重和偏置得到编码器和解码器向通过模型得到压缩数据的特征混入高斯白噪声；用长短时记忆神经网络作为滤波器对含噪特征进行滤波计算原始特征和滤波后的特征间的平均绝对误差，沿着梯度下降的方向更新长短时记忆网络中各个门的参数，直到设定的更新次数为止，保存误差最小的模型作为滤波器；将滤波后的特征作为输入送入解码器，得到重构的力触觉信号。2.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤得到触觉信号特征的具体途径是：长度为N的原始力触觉信号s经过第一层编码器，通过第一组权重矩阵与偏置向量得到初步特征：f＝σs+b)其中是提取到的初步特征，M＜N代表初步特征的长度，是用来提取初步特征的权重矩阵，是与与其对应的偏置向量，σ为激活函数，可以选用ReLU和Sigmoid等，其形式如下：Re LU:Sigmoid:其中x为任意随机变量，将得到的初步特征进一步压缩，得到最终特征：f＝σf+b)其中l∈{2,…,L}为提取特征所用到的神经网络的层数，f代表第l-1层提取出的特征，M＜M为第l层的维度，特别地，令M＝M，f＝f为力触觉信号的特征。3.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤中重构触觉信号得具体途径是：其中为解码器中重构所需的权重矩阵，为重构中的偏置向量，为利用确定性映射得到的重构数据，在解码器的最后一层，我们得到了原始信号的重构：其中与原始数据具有相同的维度。4.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤得到原始触觉信号与重构的触觉信号间的平均相对误差的具体途径是：每一次的压缩与重构形成一组权重与偏置参数：它确定了原始数据与其重构之间的误差由，误差的表达式为：其中J代表参与训练的力触觉信号的数目，|·|表示逐元素进行的绝对值运算，除法也是逐元素进行。5.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤，对误差进行求导沿着导数下降的方向更新权重和偏置得到编码器和解码器，具体方法是：Θ的最终取值Θ*通过下式确定：t∈{0,…,T}表示第t次更新，对误差求导：更新沿着L)导数下降的方向更新，直到t＝T更新结束，并保留误差最小时的权重和偏置作为其最终取值。6.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤中在特征信号中混入高斯白噪声，由如下途径实现：首先计算要被混入噪声的触觉信号特征的功率,fi表示f的第i个元素：然后随机生与触觉信号特征维度维度相同的高白噪声n并计算其功率：为了使将高斯白噪声与特征保持一定信噪比，噪声中每个数据点都需要乘以系数：其中SNR代表所设定的信噪比，将噪声与特征相加得到混入噪声的特征7.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤中通过长短时记忆神经网络作为滤波器对含噪特征进行滤波的具体途径是：将带有噪声的触觉信号特征送入长短时记忆网络，设定其目标输出为原始特征，通过网络中的细胞来进行滤波，其中每个细胞含有三个门，控制前一个内存是否被遗忘的遗忘门Ft：决定候选状态影响当前状态Ct的程度的输入门It：控制当前时刻可以输出多少隐藏的状态的输出门Ot：它们共同组成一个长短时记忆网络中的细胞，其计算如下：其中δ代表sigmoid函数，⊙表示逐元素相乘，由于为向量，表示其中的第t个元素，t∈{1,…,M}，权重矩阵偏置向量隐藏状态H与触觉特征维度相同，经过一个细胞后通过下式可以得到滤波后的特征和新的隐藏状态：Ht＝Ot⊙tanhtanh:其中是长度为N的矢量，为实数，由于长短时记忆网络的输出不仅依赖于当前的输入，还依赖于之前的状态，这使它可以利用元素之间的潜在关系来获得更好的过滤结果。8.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤得到滤波器的误差由下式确定：其中Γ为长短时记忆网络中的所有参数，其取值方式：对滤波器的误差求导：沿着L导数下降的方向更新参数，直到t＝T更新结束，并保留误差最小时的权重和偏置作为滤波器最终的参数。9.根据权利要求1所述的一种基于堆栈式自动编码的力触觉信号处理方法，其特征在于：所述步骤得到重构的力触觉信号的具体途径是：重构上一步骤所得到的滤波后力触觉信号的特征：其中为解码器中重构所需的权重矩阵，为重构中的偏置向量，均为步骤中的参数，为利用确定性映射得到的重构数据，在解码器的最后一层，得到：与原始数据具有相同的维度，为滤波后的特征重构的力触觉信号。
说明书desc
技术领域本发明属于数字信号处理领域，涉及力触觉信号的压缩、重构和滤波方法，具体涉及一种基于堆栈式自动编码的力触觉信号处理方法，可实现力触觉信号的高效压缩，同时保证较低的重构误差，并具有滤波功能，能够更好的应用于触觉数据压缩，触觉远程呈现等领域。背景技术随着触觉再现技术和互联网的发展，互联网用户对沉浸式远程操作和与物理世界进行交互的需求也越来越多。触觉互联网在双边远程操作和线上购物等中具有巨大的潜在应用，为了实现具有令人有沉浸感的触觉体验，触觉互联网产生了额外的需求，包括触觉数据的采集、压缩、传输、重建和显示。力触觉信号可以通过先进的表面触觉设备展示出物体的形状和纹理，这使得触觉互联网能够改善与真实或虚拟环境的交互沉浸感。随着力传感器获取的力触觉信号的时变，如何实现可靠的在线压缩和重构成为触觉互联网面临的挑战。2010年，Okamoto等人研究了人类对可振动材料纹理的感知特性，关注重点是亚阈值振动振幅和振幅变化对感知的影响，期望通过感知特性对触觉数据进行压缩，采用有损数据压缩方式。数据压缩在保持主观质量的同时，同时处理多个变量，对木板和砂纸的表面纹理应用了三种有损数据压缩方法：频率空间中振幅的线性和对数量化，以及位移检测阈值曲线下的数据截断。实验参与者对这些压缩纹理与未压缩原始纹理的主观相似性进行评分。在没有观察到评级的显著差异，对木材和砂纸的主观感受在保证质量时，达到的压缩比接近4:1，这表示材料纹理的数据大小可以减少约75％。然而在数据维度较大时，这样的压缩比所带来的数据压缩效果是非常有限的，且只能对有振动特性的材料产生的触觉数据进行压缩，缺少普适性。2012年，Chaudhari等人受振动旋转纹理信号和语音信号之间相似性的启发提出了一种基于源滤波器模型的触觉遥操作中振动旋转纹理压缩方法，采用语音编码技术。通过恒定的输出比特率形成确定的分组速率，一定程度上简化了音视频触觉多路复用器的设计，通过逐帧处理自由实时自然扫描纹理表面。最终纹理编解码器在保留保留了原始信号的频谱特征，和其时间特征的前提下达到了8:1的压缩比。但是一旦需要被压缩的触觉信号没有和语音信号相似的特性，这种方式将不再适用。现有的对触觉数据的主要压缩方式有两类，一类是通过心理物理学中人类具有最小感知差异的原理将小于感知阈值的数据直接抛弃来进行压缩，这种方式所能达到的压缩比非常有限，而且最小感知阈值对于不同用户而言具有较大差异，难以形成准确且具体的标准来对信号进行压缩。另外一类是对利用某些触觉信号所具有的与声音信号等相似的幅频特性通过语音信号处理的方式来对其进行压缩，当触觉信号不具备这种特性时它将不再适用，大多数触觉信号恰恰不具备这种特性，与前一种方法类似，基于信号幅频特性的压缩所达到的压缩也比较低。且具有局限性。发明内容本发明提供一种基于堆栈式自动编码的力触觉信号处理方法，以解决现有触觉信号压缩只能对具有某些特性的信号进行压缩且最终取得压缩比不理想等问题。本发明采取的技术方案是，包括下列步骤：应用矩形权重矩阵和偏置向量对原始触觉信号进行降维，得到触觉信号的特征；应用矩形权重矩阵和偏置向量将特征重构，恢复到输入信号相同的维度，得到触觉信号的重构；计算原始触觉信号与重构的触觉信号间的平均相对误差对误差进行求导沿着导数下降的方向更新权重和偏置得到编码器和解码器向通过模型得到压缩数据的特征混入高斯白噪声；用长短时记忆神经网络作为滤波器对含噪特征进行滤波计算原始特征和滤波后的特征间的平均绝对误差，沿着梯度下降的方向更新长短时记忆网络中各个门的参数，直到设定的更新次数为止，保存误差最小的模型作为滤波器；将滤波后的特征作为输入送入解码器，得到重构的力触觉信号。本发明所述步骤得到触觉信号特征的具体途径是：长度为N的原始力触觉信号s经过第一层编码器，通过第一组权重矩阵与偏置向量得到初步特征：f＝σs+b)其中是提取到的初步特征，M＜N代表初步特征的长度，是用来提取初步特征的权重矩阵，是与与其对应的偏置向量，σ为激活函数，可以选用ReLU和Sigmoid等，其形式如下：其中x为任意随机变量，将得到的初步特征进一步压缩，得到最终特征其中l∈{2,…,L}为提取特征所用到的神经网络的层数，f代表第l-1层提取出的特征，M＜M为第l层的维度，特别地，我们令M＝M，f＝f为力触觉信号的特征。本发明所述步骤中重构触觉信号得具体途径是：其中为解码器中重构所需的权重矩阵，为重构中的偏置向量，为利用确定性映射得到的重构数据，在解码器的最后一层，我们得到了原始信号的重构：其中与原始数据具有相同的维度。本发明所述步骤得到原始触觉信号与重构的触觉信号间的平均相对误差的具体途径是：每一次的压缩与重构形成一组权重与偏置参数：它确定了原始数据与其重构之间的误差由，误差的表达式为：其中J代表参与训练的力触觉信号的数目，|·|表示逐元素进行的绝对值运算，除法也是逐元素进行。本发明所述步骤，对误差进行求导沿着导数下降的方向更新权重和偏置得到编码器和解码器，具体方法是：Θ的最终取值Θ*通过下式确定：t∈{0,…,T}表示第t次更新，对误差求导：更新沿着L)导数下降的方向更新，直到t＝T更新结束，并保留误差最小时的权重和偏置作为其最终取值。本发明所述步骤中在特征信号中混入高斯白噪声，由如下途径实现：首先计算要被混入噪声的触觉信号特征的功率,fi表示f的第i个元素：然后随机生与触觉信号特征维度维度相同的高白噪声n并计算其功率：为了使将高斯白噪声与特征保持一定信噪比，噪声中每个数据点都需要乘以系数：其中SNR代表我们所设定的信噪比，将噪声与特征相加得到混入噪声的特征本发明所述步骤中通过长短时记忆神经网络作为滤波器对含噪特征进行滤波的具体途径是：将带有噪声的触觉信号特征送入长短时记忆网络，设定其目标输出为原始特征，通过网络中的细胞来进行滤波，其中每个细胞含有三个门，控制前一个内存是否被遗忘的遗忘门Ft：决定候选状态影响当前状态Ct的程度的输入门It：控制当前时刻可以输出多少隐藏的状态的输出门Ot：它们共同组成一个长短时记忆网络中的细胞，其计算如下：其中δ代表sigmoid函数，⊙表示逐元素相乘，由于为向量，表示其中的第t个元素，t∈{1,…,M}，权重矩阵偏置向量隐藏状态H与触觉特征维度相同，经过一个细胞后通过下式可以得到滤波后的特征和新的隐藏状态：Ht＝Ot⊙tanh其中是长度为N的矢量，为实数。由于长短时记忆网络的输出不仅依赖于当前的输入，还依赖于之前的状态，这使他可以利用元素之间的潜在关系来获得更好的过滤结果。滤波器的误差由下式确定：其中Γ为长短时记忆网络中的所有参数，其取值方式：对滤波器的误差求导：沿着L导数下降的方向更新参数，直到t＝T更新结束，并保留误差最小时的权重和偏置作为滤波器最终的参数。本发明所述步骤得到重构的力触觉信号的具体途径是：重构上一步骤所得到的滤波后力触觉信号的特征：其中为解码器中重构所需的权重矩阵，为重构中的偏置向量，均为步骤中的参数。为利用确定性映射得到的重构数据，在解码器的最后一层，我们得到：与原始数据具有相同的维度，为滤波后的特征重构的力触觉信号。本发明提出的方法通过堆栈式自动编码和长短时记忆网络实现了力触觉信号的压缩，滤波和重构，其主要优点体现在：能到达100:1以上的压缩比，且对信号的频谱特性没有要求，提高了压缩方法的适用性；应用长短时记忆网络对传输过程中混入的噪声进行滤波，使得整个系统具有一定的抗噪性；没有混入噪声的特征重构后与原始信号间的平均相对误差能达到5％以下，混入噪声的特征经过滤波后重构的信号与原始信号间也具有较低平均相对误差。附图说明图1是本发明中基于堆栈式自动编码的编解码器模型生成和基于长短时记忆网络的滤波器模型生成的结构图；图2是本发明的数据流程图；图3是本发明所提出的力触觉信号的平均相对重构误差与压缩比变化的关系图；图4是混入了高斯白噪声的特征重构后与原始信号间的平均相对误差随信噪比变化的关系图。具体实施方式包括下列步骤：：应用矩形权重矩阵和偏置向量对原始触觉信号进行降维，得到触觉信号的特征，具体途径是：长度为N的原始力触觉信号s经过第一层编码器，通过第一组权重矩阵与偏置向量得到初步特征：f＝σs+b)其中是提取到的初步特征，M＜N代表初步特征的长度，是用来提取初步特征的权重矩阵，是与与其对应的偏置向量，σ为激活函数，可以选用ReLU和Sigmoid等，其形式如下：其中x为任意随机变量，将得到的初步特征进一步压缩，得到最终特征：f＝σf+b)其中l∈{2,…,L}为提取特征所用到的神经网络的层数，f代表第l-1层提取出的特征，M＜M为第l层的维度，特别地，我们令M＝M，f＝f为力触觉信号的特征；、应用矩形权重矩阵和偏置向量将特征重构，恢复到输入信号相同的维度，得到触觉信号的重构，具体途径是：其中为解码器中重构所需的权重矩阵，为重构中的偏置向量，为利用确定性映射得到的重构数据，在解码器的最后一层，得到了原始信号的重构：其中与原始数据具有相同的维度；计算原始触觉信号与重构的触觉信号间的平均相对误差：每一次的压缩与重构形成一组权重与偏置参数：它确定了原始数据与其重构之间的误差由，误差的表达式为：其中J代表参与训练的力触觉信号的数目，|·|表示逐元素进行的绝对值运算，除法也是逐元素进行。对误差进行求导沿着导数下降的方向更新权重和偏置得到编码器和解码器：Θ的最终取值Θ*通过下式确定：t∈{0,…,T}表示第t次更新，对误差求导：更新沿着L)导数下降的方向更新，直到t＝T更新结束，并保留误差最小时的权重和偏置作为其最终取值；通过模型得到压缩数据的特征，向其混入高斯白噪声：首先计算要被混入噪声的触觉信号特征的功率：然后随机生与触觉信号特征维度维度相同的高白噪声ni并计算其功率：为了使将高斯白噪声与特征保持一定信噪比，噪声中每个数据点都需要乘以系数：其中SNR代表我们所设定的信噪比，将噪声与特征相加得到混入噪声的特征用长短时记忆神经网络作为滤波器对含噪特征进行滤波：将带有噪声的触觉信号特征送入长短时记忆网络，设定其目标输出为原始特征，通过网络中的细胞来进行滤波，其中每个细胞含有三个门，控制前一个内存是否被遗忘的遗忘门Ft：决定候选状态影响当前状态Ct的程度的输入门It：控制当前时刻可以输出多少隐藏的状态的输出门Ot：它们共同组成一个长短时记忆网络中的细胞，其计算如下：其中δ代表sigmoid函数，⊙表示逐元素相乘，由于为向量，表示其中的第t个元素，t∈{1,…,M}，权重矩阵偏置向量隐藏状态H与触觉特征维度相同，经过一个细胞后通过下式可以得到滤波后的特征和新的隐藏状态：Ht＝Ot⊙tanh其中是长度为N的矢量，为实数。由于长短时记忆网络的输出不仅依赖于当前的输入，还依赖于之前的状态，这使他可以利用元素之间的潜在关系来获得更好的过滤结果；、计算原始特征和滤波后的特征间的平均绝对误差，沿着梯度下降的方向更新长短时记忆网络中各个门的参数，直到设定的更新次数为止，保存误差最小的模型作为滤波器，滤波器的误差由下式确定：其中Γ为长短时记忆网络中的所有参数，其取值方式：对滤波器的误差求导：沿着L导数下降的方向更新，直到t＝T更新结束，并保留误差最小时的权重和偏置作为滤波器最终的参数；、将滤波后的特征作为输入送入解码器，得到重构的力触觉信号：重构上一步骤所得到的滤波后力触觉信号的特征：其中为解码器中重构所需的权重矩阵，为重构中的偏置向量，均为步骤中的参数，为利用确定性映射得到的重构数据，在解码器的最后一层，得到：与原始数据具有相同的维度，为滤波后的特征重构的力触觉信号。下面通过仿真实验数据分析本发明所提出的一种基于堆栈式自动编码以及长短时记忆网络的力触觉信号的力触觉信号处理方法对力触觉信号的适用性，仿真实验中采用的软件为PyCharm软件，Keras框架。仿真实验：利用HapTex数据库对基于SAE的力触觉信号压缩、滤波和重构方法进行了评估。这个数据库包含了一个裸露的手指滑过120织物表面时的力触觉信号，每种面料重复测量4次。采用了其中的法向力和侧向摩擦力信号。采用十折交叉验证将数据库分为训练集和测试集。在每个折叠中，训练集包含432组数据，而测试集包含数据库的其余部分。训练集用于训练堆栈式自动编解码器和基于长短时记忆网络的滤波器的参数，测试集用于评估所的性能。图3展示了本发明所提出的力触觉信号的平均相对重构误差随压缩比从32.5到260的变化关系图。图4是特征中混入信噪比为0到20dB高斯白噪声后以及引入滤波器后重构信号与原始信号间的误差。分析实验结果可知，本发明所提出的方法能到达100:1以上的压缩比，能够对噪声进行有效滤波，使得整个系统具有抗噪性；没有混入噪声的特征重构后与原始信号间的平均相对误差能达到5％以下，混入噪声的特征经过滤波后重构的信号与原始信号间也具有较低平均相对误差。对信号的频谱特性没有要求，提高了压缩方法的适用性，提升了压缩比并具有较小重构误差。
