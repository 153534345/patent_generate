标题title
车道线生成方法和装置
摘要abst
本发明公开了一种车道线生成方法和装置，涉及计算机技术领域。该方法的一具体实施方式包括：获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧；从所述激光点云滑窗中确定出多个车道线的点云数据；将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中；根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线。该实施方式能够准确地检测出道路中的车道线。
权利要求书clms
1.一种车道线生成方法，其特征在于，包括：获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧；从所述激光点云滑窗中确定出多个车道线的点云数据；将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中；根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线。2.根据权利要求1所述的方法，其特征在于，所述从所述激光点云滑窗中确定出多个车道线的点云数据，包括：根据第一反射率范围及感兴趣区域，从所述激光点云滑窗中，确定出车道线点云集合，所述车道线点云集合中包括多个点云数据，所述感兴趣区域为距离车体位置在预设范围内的区域；针对所述车道线点云集合中的每个点云数据，在确定当前点云数据为非车道线的点云数据的情况下，从所述车道线点云集合中剔除所述当前点云数据。3.根据权利要求2所述的方法，其特征在于，所述根据第一反射率范围及感兴趣区域，从所述激光点云滑窗中，确定出车道线点云集合，包括：获取车体位置，并以所述车体位置为参考位置，确定车体对应的感兴趣区域；在确定所述激光点云滑窗中各点云数据对应的反射率处于所述第一反射率范围之内、且所述点云数据位于所述感兴趣区域内的情况下，将所述点云数据加入所述车道线点云集合中。4.根据权利要求2所述的方法，其特征在于，所述将所述点云数据加入所述车道线点云集合中之前，还包括：确定所述当前点云数据对应的当前激光点云帧，所述当前激光点云帧为多条激光线束照射所述目标道路生成的；针对每条所述激光线束：在所述激光线束上存在连续的第一数目个激光线段的情况下，确定所述当前激光点云帧中的点云数据均为斑马线的点云数据；其中，所述激光线段包括连续的第二数目个在第二反射范围内的点云数据。5.根据权利要求1所述的方法，其特征在于，所述将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中，包括：从所述多个车道线的点云数据中获取当前点云数据；获取所述目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用所述前一左车道线方程，确定所述当前点云数据与左车道之间的第一距离；利用所述右一左车道线方程，确定所述当前点云数据与右车道之间的第二距离；在确定所述第一距离小于所述第二距离的情况下，将所述当前点云数据划分至所述左车道线数据集合中；在确定所述第一距离不小于所述第二距离的情况下，将所述当前点云数据划分至所述右车道线数据集合中。6.根据权利要求1所述的方法，其特征在于，所述根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线之前，还包括：确定所述左车道线数据集合中的第一点云数目；确定所述右车道线数据集合中的第二点云数目；所述根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线，包括：在所述第一点云数目及所述第二点云数目均大于点云数目阈值的情况下，选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线；选取直线方程，拟合所述右车道线数据集合中的点云数据，生成所述目标道路的右车道线；在存在所述第一点云数目或所述第二点云数目不大于点云数目阈值的情况下，选取曲线方程进行拟合，生成所述目标道路的车道线。7.根据权利要求6所述的方法，其特征在于，所述选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线之前，还包括：确定所述左车道线数据集合中各点云数据所属的左激光线束，并确定所述左激光线束的数目；确定所述右车道线数据集合中各点云数据所属的右激光线束，并确定所述右激光线束的数目；在所述左激光线束的数目及所述右激光线束的数目均大于线束数目阈值的情况下，执行所述选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线的步骤。8.根据权利要求6所述的方法，其特征在于，所述选取曲线方程进行拟合，生成所述目标道路的车道线，包括：获取所述目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用所述前一左车道线方程，确定距离左车道在第一范围内的多个左车道点云数据；利用所述右一左车道线方程，确定距离右车道在第二范围内的多个右车道点云数据；选取曲线方程，拟合所述多个左车道点云数据，生成所述目标道路的左车道线；选取曲线方程，拟合所述多个右车道点云数据，生成所述目标道路的右车道线。9.根据权利要求1所述的方法，其特征在于，所述从所述激光点云滑窗中确定出多个车道线的点云数据之后，还包括：获取所述目标道路在电子地图中的车道线信息；根据所述车道线的点云数据及所述电子地图中的车道线信息，确定车辆的优化位姿信息。10.一种车道线生成装置，其特征在于，包括：滑窗获取模块，用于获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧；数据确定模块，用于从所述激光点云滑窗中确定出多个车道线的点云数据；划分模块，用于将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中；生成模块，用于根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线。11.一种电子设备，其特征在于，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如权利要求1-9中任一所述的方法。12.一种计算机可读介质，其上存储有计算机程序，其特征在于，所述程序被处理器执行时实现如权利要求1-9中任一所述的方法。
说明书desc
技术领域本发明涉及计算机技术领域，尤其涉及一种车道线生成方法和装置。背景技术自动驾驶是计算机视觉和机器人学领域的研究热点。自动驾驶过程中，车辆需要通过实时关注周围的车道线，来制定行驶策略，使车辆保持在车道线内行驶，以遵守交通法规及减少驾驶风险。但现有的车道线检测方法往往无法准确地检测出道路中的车道线。发明内容有鉴于此，本发明实施例提供一种车道线生成方法和装置，能够准确地检测出道路中的车道线。第一方面，本发明实施例提供了一种车道线生成方法，包括：获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧；从所述激光点云滑窗中确定出多个车道线的点云数据；将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中；根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线。可选地，所述从所述激光点云滑窗中确定出多个车道线的点云数据，包括：根据第一反射率范围及感兴趣区域，从所述激光点云滑窗中，确定出车道线点云集合，所述车道线点云集合中包括多个点云数据，所述感兴趣区域为距离车体位置在预设范围内的区域；针对所述车道线点云集合中的每个点云数据：在当前点云数据为非车道线的点云数据的情况下，从所述车道线点云集合中剔除所述当前点云数据。可选地，所述根据第一反射率范围及感兴趣区域，从所述激光点云滑窗中，确定出车道线点云集合，包括：获取车体位置，并以所述车体位置为参考位置，确定车体对应的感兴趣区域；在所述激光点云滑窗中各点云数据对应的反射率处于所述第一反射率范围之内、且所述激光点云帧为位于所述感兴趣区域内的情况下，将所述点云数据加入所述车道线点云集合中。可选地，所述将所述点云数据加入所述车道线点云集合中之前，还包括：获取当前激光点云帧，所述当前激光点云帧为多条激光线束照射所述目标道路生成的；针对每条所述激光线束：在所述激光线束上是否存在连续的第一数目个激光线段的情况下，确定所述当前激光点云帧中的点云数据均为斑马线的点云数据；其中，所述激光线段包括连续的第二数目个在第二反射范围内的点云数据。可选地，所述将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中，包括：从所述车道线的点云数据中获取当前点云数据；获取所述目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用所述前一左车道线方程，确定所述当前点云数据与左车道之间的第一距离；利用所述右一左车道线方程，确定所述当前点云数据与右车道之间的第二距离；在所述第一距离小于所述第二距离的情况下，将所述当前点云数据划分至所述左车道线数据集合中；在所述第一距离不小于所述第二距离的情况下将所述当前点云数据划分至所述右车道线数据集合中。可选地，所述根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线之前，还包括：确定所述左车道线数据集合中的第一点云数目；确定所述右车道线数据集合中的第二点云数目；所述根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线，包括：在确定所述第一点云数目及所述第二点云数目均大于点云数目阈值的情况下，选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线；选取直线方程，拟合所述右车道线数据集合中的点云数据，生成所述目标道路的右车道线；在确定所述第一点云数目或所述第二点云数目不大于点云数目阈值的情况下选取曲线方程进行拟合，生成所述目标道路的车道线。可选地，所述选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线之前，还包括：确定所述左车道线数据集合中各点云数据所属的左激光线束，并确定所述左激光线束的数目；确定所述右车道线数据集合中各点云数据所属的右激光线束，并确定所述右激光线束的数目；在所述左激光线束的数目及所述右激光线束的数目均大于线束数目阈值的情况下，执行所述选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线的步骤。可选地，所述选取曲线方程进行拟合，生成所述目标道路的车道线，包括：获取所述目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用所述前一左车道线方程，确定距离左车道在第一范围内的多个左车道点云数据；利用所述右一左车道线方程，确定距离右车道在第二范围内的多个右车道点云数据；选取曲线方程，拟合所述多个左车道点云数据，生成所述目标道路的左车道线；选取曲线方程，拟合所述多个右车道点云数据，生成所述目标道路的右车道线。可选地，所述从所述激光点云滑窗中确定出多个车道线的点云数据之后，还包括：获取所述目标道路在电子地图中的车道线信息；根据所述车道线的点云数据及所述电子地图中的车道线信息，确定车辆的优化位姿信息。第二方面，本发明实施例提供了一种车道线生成装置，包括：滑窗获取模块，用于获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧；数据确定模块，用于从所述激光点云滑窗中确定出多个车道线的点云数据；划分模块，用于将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中；生成模块，用于根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线。第三方面，本发明实施例提供了一种电子设备，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现上述任一实施例所述的方法。第四方面，本发明实施例提供了一种计算机可读介质，其上存储有计算机程序，所述程序被处理器执行时实现上述任一实施例所述的方法。上述发明中的一个实施例具有如下优点或有益效果：获取目标道路对应的激光点云滑窗，从激光点云滑窗中确定出车道线的点云数据，并将各车道线的点云数据划分至左车道线数据集合或右车道线数据集合中，利用左车道线数据集合及右车道线数据集合中的点云数据，生成目标道路的车道线。利用激光点云帧中大量密集的点云数据，可准确地检测出目标道路中的车道线。上述的非惯用的可选方式所具有的进一步效果将在下文中结合具体实施方式加以说明。附图说明附图用于更好地理解本发明，不构成对本发明的不当限定。其中：图1是本发明的一个实施例提供的一种车道线生成方法的流程的示意图；图2是本发明的一个实施例提供的另一种车道线生成方法的流程的示意图；图3是本发明的一个实施例提供的一种感兴趣区域的结构示意图；图4是本发明的一个实施例提供的又一种车道线生成方法的流程的示意图；图5是本发明的一个实施例提供的再一种车道线生成方法的流程的示意图；图6是本发明的一个实施例提供的一种车道线生成装置的结构示意图；图7是适于用来实现本发明实施例的终端设备或服务器的计算机系统的结构示意图。具体实施方式以下结合附图对本发明的示范性实施例做出说明，其中包括本发明实施例的各种细节以助于理解，应当将它们认为仅仅是示范性的。因此，本领域普通技术人员应当认识到，可以对这里描述的实施例做出各种改变和修改，而不会背离本发明的范围和精神。同样，为了清楚和简明，以下的描述中省略了对公知功能和结构的描述。本发明实施例的方案的目的主要为车道线会作为自动驾驶下路径规划的一个重要依据。路径规划需要首先已知环境中的道路通行区域然后再设计路径规划的方案。此外，车辆在行驶时，通过车道线与车辆的相对关系能判断出车辆是否在交通规则内行驶。图1是本发明的一个实施例提供的一种车道线生成方法的流程的示意图。如图1所示，该方法包括：步骤101：获取目标道路对应的激光点云滑窗，激光点云滑窗包括多个激光点云帧。可在行驶的车辆上设置激光雷达设备，如Velodyne 16线激光雷达、Velodyne 32线激光雷达等。通过激光雷达设备获取到目标道路的激光点云帧。当行驶车辆在高速公路行驶时，车道两边的特征会很稀疏，很难识别出车道线。因此，本发明实施例的方法利用激光点云滑窗将多个激光点云帧组合到一个坐标系下，激光点云滑窗内激光点云帧的数量N是固定不变的。当新的激光点云帧输入时，激光点云滑窗自动删除最旧的一帧点云数据，始终保持滑窗内只有N个激光点云帧。N的取值可根据具体需求进行确定，如7、8、9等。步骤102：从激光点云滑窗中确定出多个车道线的点云数据。一个激光点云滑窗包括多个激光点云帧。每个激光点云帧中包括多个点云数据。激光雷达设备采集的点云数据以一帧一帧区分，每秒采集10帧点云，即0.1秒采集一个激光点云帧。例如，Velodyne16线激光雷达每秒30万个点云数据，约10hz。一个激光点云帧对应于有大概3万个点云数据，一个激光点云帧的一条激光线束上大约有1800个点云数据。每个激光点云帧中的点云数据部分照射在目标路面上，部分被照射在空中或其它物体上。目标路面上存在着不同的路面对象，如车道线、斑马线、转弯标志等。其中，车道线的点云数据为照射在目标路面的车道线上的点云数据。步骤103：将各车道线的点云数据划分至左车道线数据集合或右车道线数据集合中。以行驶车辆的车体位置为参考位置，在车辆行驶过程中，位于驾驶员左侧最近的一条车道线为左车道线，位于驾驶员右侧最近的一条车道线为右车道线。左车道线数据集合中的点云数据可用于生成左车道线。右车道线数据集合中的点云数据可用于生成右车道线。步骤104：根据左车道线数据集合及右车道线数据集合中的点云数据，生成目标道路的车道线。在本发明实施例中，获取目标道路对应的激光点云滑窗，从激光点云滑窗中确定出车道线的点云数据，并将各车道线的点云数据划分至左车道线数据集合或右车道线数据集合中，利用左车道线数据集合及右车道线数据集合中的点云数据，生成目标道路的车道线。利用激光点云帧中大量密集的点云数据，可准确地检测出目标道路中的车道线。在本发明的一个实施例中，将各车道线的点云数据划分至左车道线数据集合或右车道线数据集合中，包括：从多个车道线的点云数据中获取当前点云数据；获取目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用前一左车道线方程，确定当前点云数据与左车道之间的第一距离；利用右一左车道线方程，确定当前点云数据与右车道之间的第二距离；确定第一距离是否小于第二距离；若是，则将当前点云数据划分至左车道线数据集合中；若否，则将当前点云数据划分至右车道线数据集合中。将当前点云数据划分到距离当前点云数据最近的数据集合中。在初始阶段，可根据目标道路情况，假设初始的左车道线方程和右车道线方程。例如，可设定初始左车道线在车体左侧2米处，初始右车道线在车体右侧0.8米处。图2是本发明的一个实施例提供的一种车道线生成方法的流程的示意图。如图2所示，该方法包括：步骤201：获取目标道路对应的激光点云滑窗，激光点云滑窗包括多个激光点云帧。步骤202：获取车体位置，并以车体位置为参考位置，确定车体对应的感兴趣区域。感兴趣区域可根据具体需求进行设定。例如，感兴趣区域可以为以车体位置为圆心的一个圆形。感兴趣区域还可以为车体位置前方的一个矩形区域等。图3是本发明的一个实施例提供的一种感兴趣区域的结构示意图。如图3所示，感兴趣区域取车辆左右，车辆前方内范围。步骤203：确定激光点云滑窗中各点云数据对应的反射率是否处于第一反射率范围之内。车道线的材质与路面的材质不同，因此，车道线的反射率与路面的反射率不同。通过车道线的反射率与周围地面反射率的差别作为突破口，车道线的反射率较高，然后对反射率高的点进行车道线拟合。第一反射率范围可根据车道线的材质与路面的材质等来确定。例如，第一反射率范围可以设置为20％-60％等。如果点云数据对应的反射率处于第一反射率范围之内，则该点云数据可能为车道线的点云数据，执行步骤204。如果点云数据对应的反射率没有处于第一反射率范围之内，则该点云数据不为车道线的点云数据，不予考虑。步骤204：确定点云数据是否位于感兴趣区域内。如果点云数据处于步骤202中确定的感兴趣区域内，则执行步骤205。如果点云数据未处于步骤202中确定的感兴趣区域内则该点云数据对应的位置距离当前车体过远，不予考虑。步骤205：将点云数据加入车道线点云集合中。步骤206：确定车道线点云集合中的各点云数据是否为非车道线的点云数据。实际路面场景复杂，除了车道线外，路面上还存在斑马线，转弯标志和马路牙等，这些在激光点云下的反射率都比普通路面强，如果这些均被识别为车道线，则会影响车道线检测的精度。路面上的白色/黄色车道线、白色路面标志和人行横道的材料与路面不同，均为特性图层介质。所以这些标志在激光点云下的反射率都在一个范围内，通过激光点云反射率这个单一标准不能完全区分车道线与其他交通标志，造成最终车道线检测的精度降低。非车道线的点云数据可包括：斑马线的点云数据、转弯标志的点云数据、马路牙的点云数据等。确定车道线点云集合中的各点云数据是否为非车道线的点云数据。如果车道线点云集合中的某个点云数据不是非车道线的点云数据，则执行步骤207，从车道线点云集合中剔除非车道线的点云数据。确定车道线点云集合中的各点云数据是否为非车道线的点云数据的方式有很多种。利用各点云数据绘制道路图像，并利用图像识别技术，确定出道路图像中属于非车道线的点，并在车道线点云集合中删除这些点。又如，获取上一时刻的左车道线方程和右车道线方式，利用两车道线方程，确定各点云数据距离左车道线的距离和右车道线的距离。如果距离左车道线的距离和右车道线的距离都大于距离阈值，则将该点云数据确定为非车道线距离。步骤207：从车道线点云集合中剔除非车道线的点云数据。步骤208：将车道线点云集合中的各点云数据划分至左车道线数据集合或右车道线数据集合中。步骤209：根据左车道线数据集合及右车道线数据集合中的点云数据，生成目标道路的车道线。在本发明实施例中，先确定车道线点云集合，再从车道线点云集合中去除非车道线的点云数据。由于实际路面上还存在斑马线，转弯标志和马路牙等，这些标志会被误识别车道线，从而影响车道线检测的精度。本申请实施例从车道线点云集合中去除非车道线的点云数据，利用车道线点云集合中的剩余点云数据生成车道线，可提升车道线识别的精度。在本发明的一个实施例中，确定车道线点云集合中的当前点云数据是否为非车道线的点云数据，包括：获取当前点云数据对应的当前激光点云帧，当前激光点云帧为多条激光线束照射目标道路生成的；针对每条所述激光线束：确定所述激光线束上是否存在连续的第一数目个激光线段；若是，则确定所述当前激光点云帧中的点云数据均为斑马线的点云数据；其中，所述激光线段包括连续的第二数目个在第二反射范围内的点云数据。路面上除了车道线之外，还有很多其他标志在激光点云内的反射率类似于车道线的反射率，所以对该强度范围内的点筛选是很重要的任务。首先因为各地方的斑马线的形状基本类似，都是多个实心矩形组成的，所以容易对其进行筛选。在本发明实施例中，一帧激光点云中会有多条激光线会打到地面上，每一条线在车周围形成一个圆形。本发明实施例的算法筛选斑马线的过程为：判断激光线束上是否有连续的第一数目激光线段，第一数目的取值可根据具体需要进行设定，如4、5、6等。如果某一帧激光线束内有大于第一数目个激光线段，则将该帧在车辆前方范围内的所有激光点全部设置为斑马线，不作为后续车道线拟合的候选点。激光线段的定义是：一条激光线束上连续的第二数目个反射率在第二反射范围内的激光点云。其中，第二数目可根据具体需求进行设定，如：4-6、5-7等。第二反射率范围可根据车道线的材质与路面的材质等来确定。例如，第二反射率范围可以设置为20％-60％等。这种筛选操作成立需要一个条件，假设人行横道与车道线两者不会大范围的重合，以及人行横道的宽度和长度都满足设立的阈值。恰好在实际路面情况中均满足这两种假设。以Velodyne16线激光为例，激光点云帧为Velodyne16线激光发出的5-6条激光线束照射目标道路生成的。Velodyne16线激光每秒30万个点，约10hz。大约一帧激光雷达数据的一条线上有1800个点左右。通过连续的4-6个激光点云数据所确定的人行横道的宽度，会大于车道边线的宽度小于人行横道一条线的宽度，大约为10-20cm。图4是本发明的一个实施例提供的一种车道线生成方法的流程的示意图。如图4所示，该方法包括：步骤401：获取目标道路对应的激光点云滑窗，激光点云滑窗包括多个激光点云帧。步骤402：从激光点云滑窗中确定出多个车道线的点云数据。步骤403：将各车道线的点云数据划分至左车道线数据集合或右车道线数据集合中。步骤404：确定左车道线数据集合中的第一点云数目；确定右车道线数据集合中的第二点云数目。步骤405：确定第一点云数目及第二点云数目是否均大于点云数目阈值。点云数目阈值可根据具体需求进行设定，如20、30、50等。第一点云数目及第二点云数目越多，生成的车道线越准确。本发明实施例的方法保证单条车道线上的待拟合的车道线点的数量需要足够多，如果数量少，可能存在选取的点中大部分都是错误的，导致拟合效果很差，或者实际环境中根本没有车道线，选取的车道线的点云数据均为噪点。还有可能出现通过路口车辆转弯等情况。如果第一点云数目及第二点云数目均大于点云数目阈值，则执行步骤406。否则，则执行步骤408。步骤406：选取直线方程，拟合左车道线数据集合中的点云数据，生成目标道路的左车道线。步骤407：选取直线方程，拟合右车道线数据集合中的点云数据，生成目标道路的右车道线。因为车辆在直行时，车道线通常为直线，因此，在车道线拟合时选取的是直线方程ax+by+c＝0，并可采用SVD分解的方式求取最小二乘法求解，得到目标道路的车道线。步骤408：若否，则选取曲线方程进行拟合，生成目标道路的车道线。车辆在实际场景中经常会出现通过路口转弯等情况，因此，本发明实施例还设计了一种针对车辆转弯或掉头情况的实时车道线检测算法。在拟合时选取的是曲线方程ax2+bx+cy2+dy+e＝0，并采用SVD分解求解曲线方程，得到目标道路的车道线。在本发明实施例中，根据第一点云数目及第二点云数目确定选取直线方程或曲线方程进行拟合，来生成目标道路的车道线。如果第一点云数目及第二点云数目较多，则车辆可能正处于直行中，可通过直线方程拟合生成车道线。如果第一点云数目及第二点云数目较少，则车辆可能正处于路口转弯中，可通过曲线方程拟合生成车道线。在本发明的一个实施例中，所述选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线之前，还包括：确定所述左车道线数据集合中各点云数据所属的左激光线束，并确定所述左激光线束的数目；确定所述右车道线数据集合中各点云数据所属的右激光线束，并确定所述右激光线束的数目；确定所述左激光线束的数目及所述右激光线束的数目是否均大于线束数目阈值；若是，则执行所述选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线的步骤。线束数目阈值可根据具体需求进行设定，如6、7、8等。通过线束数目阈值保证单条车道线上的点云数据来自于不同的多条激光线束。在车辆运动的过程中，不同的激光线束照射到的环境是不同的。如果车辆是沿着车道线的方向直向运动的话，那么单条车道线应该对应若干条激光线束。通过左激光线束的数目和右激光线束的数目，保证选取的车道线上的点均匀分布在沿车辆运动方向，而不是垂直于车辆运动方向。这样拟合出来的车道线才更接近于真实场景中的情况。在本发明的一个实施例中，所述选取曲线方程进行拟合，生成所述目标道路的车道线，包括：获取所述目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用所述前一左车道线方程，确定距离左车道在第一范围内的多个左车道点云数据；利用所述右一左车道线方程，确定距离右车道在第二范围内的多个右车道点云数据；选取曲线方程，拟合所述多个左车道点云数据，生成所述目标道路的左车道线；选取曲线方程，拟合所述多个右车道点云数据，生成所述目标道路的右车道线。当左车道线数据集合或右车道线数据集合中的点云数目较少时，可能遇到实际环境中没有真实的车道线情况，或者车辆正在转弯的情况。所以如果仍然计算候选点到上一时刻的两条车道线的距离的话，距离值则会很大，很难选择车道线候选点。因此，这种情况需要开启新的策略，利用前一时刻的前一左车道线方程和前一右车道线方程，在左车道线附近或右车道线附近搜索反射率在20％-60％范围间的点云数据，然后对搜索到的点云数据进行最小二乘拟合。搜索时，距离的阈值可以适当的增大一些。此时空间中的车道线大概率是曲线，因此在拟合时选取的是曲线方程ax2+bx+cy2+dy+e＝0，来生成目标道路的车道线。在本发明的一个实施例中，从激光点云滑窗中确定出多个车道线的点云数据之后，还包括：获取目标道路在电子地图中的车道线信息；根据车道线的点云数据及电子地图中的车道线信息，确定车辆的优化位姿信息。当自动驾驶车辆在高速公路行驶时，车道两边的特征会很稀疏，这会对激光点云与高精地图的匹配特别不利，容易导致定位模块的精度降低。所以需要加入车辆感知的车道线与地图中的车道线匹配，对车辆的定位模块增加横向的约束关系，提升定位精度。自动驾驶车辆在行驶时，会参考采集完成的高精度的点云地图。高精点云地图在处理时会标注出地面中的矢量信息，例如车道线，马路牙，人行横道等等信息。本发明实施例的方案根据行驶车辆上设置的激光传感器实时检测的车道线信息与地图中的车道线进行匹配，并采用LM优化的方式估计车辆在Y轴上的位置和姿态。下述式表示的是第k个激光点云帧中实时提取到的车道线上的点云数据，经过坐标变换后，到达电子地图中的车道线上的距离公式。其中，Xk代表第k帧激光点云中的第i个点，Xmap，Xmap分别表示电子地图里车道线上的第j，k个点，这两个点代表的是将Xk经过坐标变换后，距离该点最近的两个车道线上的点。代表从第k帧到地图的位姿。dε表示距离。目标函数如下述式所示。其中，表示的是的李代数形式。式的含义为将第k帧检测出的车道线上的点带入到式中，然后进行求和，最终优化得到最优的位姿。优化得到的位姿取Y轴方向的位置和旋转角传递到定位系统中，更新系统输出的位姿。因为在高速环境下，环境中的特征不是很明显，而且相似度很高，所以对SLAM算法估计车体的位置和姿态的很有挑战性。因此本文引入车道线一种高级特征，通过车辆实时检测的车道线与地图中的车道线进行匹配，约束Y方向的位姿和姿态。通过优化实时检测的车道线上的点到地图中的车道线的距离值，估计车辆Y轴方向的位置和姿态。进而提升系统的定位精度。为使本发明实施例的方法更加便于理解，以下通过一个具体实施例的实现方法进行讲解。在自动驾驶车辆的上方安装一个Velodyne 16线激光雷达感知车辆周围的环境信息。激光能够感知到周围地面和非地面信息。图5是本发明的一个实施例提供的再一种车道线生成方法的流程的示意图。如图5所示，该方法包括：首先获取当前时刻的激光点云帧，然后根据车辆的姿态，将之前n个时刻下的激光点云帧投影到当前激光坐标系下，此时这7个激光点云帧组成一个滑窗。这样做的原因是根据实验发现单个激光点云帧中只有5条线束在地面上，所以单个激光点云帧很稀疏，同理车道线点云数据也很稀疏，因此很难识别出车道线。所以采用滑动窗口的方式，每次处理7个激光点云帧，当新时刻的一帧点云采集到时，就将滑窗中最旧时刻的帧丢弃并添加最新时刻的帧，始终保持滑窗内只有7帧点云数据。管理完滑动窗口之后，再对滑窗内的帧提取反射率在20％-60％范围内的点，并对点进行甄别，如果不是车道线上的点，比如是在人行横道上的点就会被剔除。最后将点分类到左车道线和右车道线上，分别对左、右车道线上的点进行拟合。本发明实施例首先利用滑动窗口将多帧的激光点云组合到一个坐标系下，滑动窗口内激光点云帧的数量N是固定不变的，这里设置N＝7，当新的一帧点云输入时，滑窗自动删除最旧的一帧点云数据。然后，在初始化阶段设定当前坐标系下车辆周围两条车道线的初始方程，当新的一帧点云输入时，滑动窗口更新，同时基于当前车体位置，设置一个矩形感兴趣区域并检测滑窗中反射率在20％-60％范围内的点是否为斑马线上的点，然后判断在感兴趣区域内，反射率在20％-60％的点属于左车道或右车道，并计算点与其相应车道的距离，假如距离小于一定的范围，则将点加入到对应车道的候选点集合中。最后将两组车道候选点集合中拟合成左右车道线。本发明实施例中车道线方程设置成ax2+bx+cy2+dy+e＝0的形式和ax+by+c＝0形式，这样做的好处是可以既可以表征直线形式的车道线也可以表征路口内弯曲的车道线。本发明实施例在初始化阶段设置的初始车道线分别距离车辆左右两侧1.8米，车道线的方向与车辆朝向一致。本发明实施例的方案首先假设初始的车道线分别距离车辆左右两侧1.8米，因此得到初始的车道线方程，之后的每个时刻都维护滑动窗口，滑动窗口由若干个激光点云帧组成。通过反射率信息，筛选出在滑动窗口中的车道线点云数据，然后通过计算逐个点云坐标与上一时刻左右车道线方程的距离，设x1,x2。设定距离两条车道线距离最短的车道线投票为该点所在的车道线，将该点云数据加入到对应的车道线集合中。因此每个车道线集合都拥有若干个车道线点。然后判断每个车道线集合中的点云数目，以及每个车道线集合中的点云所属的激光线束数目。激光线束的含义是一帧激光点云在地面上预计有5-6条激光线束，因为激光是360度扫描周围环境，因此每条激光线束是360度的。最后，根据每个车道线集合中的点云数目及点云所属的激光线束数目，选取直线方程或曲线方程进行拟合，生成目标道路的车道线。本发明实施例的方案基于车辆上的激光雷达设备可以实时检测道路上的车道线。在拟合车道线时考虑到了将人行横道和路面转弯标志进行剔除，提升了车道线拟合的精度。在车道线拟合时区分直线和曲线，达到更好的拟合效果。根据上一时刻检测的车道线作为初值，将当前环境中车道线点云分类到左右两条车道线上。然后拟合新选取的车道线上的点，检测出新时刻的车道线。此外，本发明实施例的方法还通过自主研发的车道线检测算法估计Y轴方向的位置和姿态的算法。因为在高速环境下，环境中的特征不是很明显，而且相似度很高，所以对SLAM算法估计车体的位置和姿态的很有挑战性。因此本文引入车道线一种高级特征，通过车辆实时检测的车道线与地图中的车道线进行匹配，约束Y方向的位姿和姿态。通过优化实时检测的车道线上的点到地图中的车道线的距离值，估计车辆Y轴方向的位置和姿态，进而提升系统的定位精度。图6是本发明的一个实施例提供的一种车道线生成装置的结构示意图。如图6所示，该装置包括：滑窗获取模块601，用于获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧；数据确定模块602，用于从所述激光点云滑窗中确定出多个车道线的点云数据；划分模块603，用于将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中；生成模块604，用于根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线。可选地，数据确定模块602具体用于：根据第一反射率范围及感兴趣区域，从所述激光点云滑窗中，确定出车道线点云集合，所述车道线点云集合中包括多个点云数据；针对所述车道线点云集合中的每个点云数据：确定当前点云数据是否为非车道线的点云数据；若是，则从所述车道线点云集合中剔除所述当前点云数据。可选地，数据确定模块602具体用于：获取车体位置，并以所述车体位置为参考位置，确定车体对应的感兴趣区域；确定所述激光点云滑窗中各点云数据对应的反射率是否处于所述第一反射率范围之内；若是，则确定所述激光点云帧为位于所述感兴趣区域内；若是，则将所述点云数据加入所述车道线点云集合中。可选地，数据确定模块602还用于：获取当前激光点云帧，所述当前激光点云帧为多条激光线束照射所述目标道路生成的；针对每条所述激光线束：确定所述激光线束上是否存在连续的第一数目个激光线段；若是，则确定所述当前激光点云帧中的点云数据均为斑马线的点云数据；其中，所述激光线段包括连续的第二数目个在第二反射范围内的点云数据。可选地，划分模块603具体用于：从所述车道线的点云数据中获取当前点云数据；获取所述目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用所述前一左车道线方程，确定所述当前点云数据与左车道之间的第一距离；利用所述右一左车道线方程，确定所述当前点云数据与右车道之间的第二距离；确定所述第一距离是否小于所述第二距离；若是，则将所述当前点云数据划分至所述左车道线数据集合中；若否，则将所述当前点云数据划分至所述右车道线数据集合中。可选地，该装置还包括：判断模块605，用于确定所述左车道线数据集合中的第一点云数目；确定所述右车道线数据集合中的第二点云数目；生成模块604具体用于：确定所述第一点云数目及所述第二点云数目是否均大于点云数目阈值；若是，则选取直线方程，拟合所述左车道线数据集合中的点云数据，生成所述目标道路的左车道线；选取直线方程，拟合所述右车道线数据集合中的点云数据，生成所述目标道路的右车道线；若否，则选取曲线方程进行拟合，生成所述目标道路的车道线。可选地，判断模块605还用于：确定所述左车道线数据集合中各点云数据所属的左激光线束，并确定所述左激光线束的数目；确定所述右车道线数据集合中各点云数据所属的右激光线束，并确定所述右激光线束的数目；确定所述左激光线束的数目及所述右激光线束的数目是否均大于线束数目阈值。可选地，生成模块604还用于：获取所述目标道路在前一时刻的前一左车道线方程和前一右车道线方程；利用所述前一左车道线方程，确定距离左车道在第一范围内的多个左车道点云数据；利用所述右一左车道线方程，确定距离右车道在第二范围内的多个右车道点云数据；选取曲线方程，拟合所述多个左车道点云数据，生成所述目标道路的左车道线；选取曲线方程，拟合所述多个右车道点云数据，生成所述目标道路的右车道线。可选地，该装置还包括：位姿确定模块606，用于获取所述目标道路在电子地图中的车道线信息；根据所述车道线的点云数据及所述电子地图中的车道线信息，确定车辆的优化位姿信息。本发明实施例提供了一种电子设备，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当一个或多个程序被一个或多个处理器执行，使得一个或多个处理器实现上述任一实施例的方法。下面参考图7，其示出了适于用来实现本发明实施例的终端设备的计算机系统700的结构示意图。图7示出的终端设备仅仅是一个示例，不应对本发明实施例的功能和使用范围带来任何限制。如图7所示，计算机系统700包括中央处理单元701，其可以根据存储在只读存储器702中的程序或者从存储部分708加载到随机访问存储器703中的程序而执行各种适当的动作和处理。在RAM 703中，还存储有系统700操作所需的各种程序和数据。CPU 701、ROM 702以及RAM 703通过总线704彼此相连。输入/输出接口705也连接至总线704。以下部件连接至I/O接口705：包括键盘、鼠标等的输入部分706；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分707；包括硬盘等的存储部分708；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分709。通信部分709经由诸如因特网的网络执行通信处理。驱动器710也根据需要连接至I/O接口705。可拆卸介质711，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器710上，以便于从其上读出的计算机程序根据需要被安装入存储部分708。特别地，根据本发明公开的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本发明公开的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分709从网络上被下载和安装，和/或从可拆卸介质711被安装。在该计算机程序被中央处理单元701执行时，执行本发明的系统中限定的上述功能。需要说明的是，本发明所示的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本发明中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本发明中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、电线、光缆、RF等等，或者上述的任意合适的组合。附图中的流程图和框图，图示了按照本发明各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本发明实施例中所涉及到的模块可以通过软件的方式实现，也可以通过硬件的方式来实现。所描述的模块也可以设置在处理器中，例如，可以描述为：滑窗获取模块、数据确定模块、划分模块及生成模块。其中，这些模块的名称在某种情况下并不构成对该模块本身的限定，例如，滑窗获取模块还可以被描述为“获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧的模块”。作为另一方面，本发明还提供了一种计算机可读介质，该计算机可读介质可以是上述实施例中描述的设备中所包含的；也可以是单独存在，而未装配入该设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被一个该设备执行时，使得该设备包括：获取目标道路对应的激光点云滑窗，所述激光点云滑窗包括多个激光点云帧；从所述激光点云滑窗中确定出多个车道线的点云数据；将各所述车道线的点云数据划分至左车道线数据集合或右车道线数据集合中；根据所述左车道线数据集合及所述右车道线数据集合中的点云数据，生成所述目标道路的车道线。根据本发明实施例的技术方案，获取目标道路对应的激光点云滑窗，从激光点云滑窗中确定出车道线的点云数据，并将各车道线的点云数据划分至左车道线数据集合或右车道线数据集合中，利用左车道线数据集合及右车道线数据集合中的点云数据，生成目标道路的车道线。利用激光点云帧中大量密集的点云数据，可准确地检测出目标道路中的车道线。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，取决于设计要求和其他因素，可以发生各种各样的修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
