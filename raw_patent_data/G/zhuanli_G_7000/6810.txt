标题title
基于群签名的可监管区块链交易隐私保护方法及系统
摘要abst
本发明公开了基于群签名的可监管区块链交易隐私保护方法及系统，包括：交易节点，每个交易节点均有CA颁发的证书；发起交易的节点向匿名群申请群签名证书，群管理员在与节点进行认证后生成群签名证书和加密公钥；交易节点使用群签名证书对交易进行签名并广播出去；矿工验证其广播内容的完整性后，完成上链；审计节点广播待追踪的交易信息；继而接收来自其它审计节点的解密密钥，并运行协商解密算法对加密的监管信公钥进行解密并验证；最后，根据解密获得的公钥向用户身份列表追踪公钥代表的身份。通过CA证书与群签名监管结构，结合我们设计的密钥生成和协商解密算法，对交易发起方在实现匿名的基础上实现了分布监管，预防了监管权力的滥用。
权利要求书clms
1.基于群签名的可监管区块链交易隐私保护方法，其特征是，包括：每个交易节点，均将自身信息发送到公证机构节点，公证机构节点验证后，生成每个交易节点的认证证书；其中，交易节点，包括：交易发起节点和交易接收节点；交易发起节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；验证身份之后，交易节点和群管理员节点进行交互，生成交易的群签名；交易发起节点在接收到群签名之后向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证，最终交易结束。2.如权利要求1所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，所述每个交易节点，均将自身信息发送到公证机构节点，公证机构节点验证后，生成每个交易节点的认证证书；步骤之前，还包括：审计节点初始化生成监管密钥SPK；所述审计节点初始化生成监管密钥SPK；具体包括：假设实施过程中审计机构存在三个互不相属的审计节点A、B、C；进行密钥的生成，各个审计节点分别选择一个随机数作为其自身的密钥keyA,keyB，keyC；选择一个随机混淆值ri，0，i∈作为协商过程的计数器，在进行公钥协商的过程中利用随机混淆值ri，0，i∈来对审计节点的密钥进行混淆；同时，使用选择的椭圆曲线的基点G与本次协商的参与协商值进行运算，生成参与监管公钥协商过程的密钥Ki＝×G；通过协商生成一个必须由所有审计节点共同参与才能够进行解密的监管公钥SPK；如公式所示，来自于不同审计节点经过混淆的协商信息，经过密钥协商器的协商，最终产生了需要所有审计节点共同参与才能解密的监管公钥SPK；协商完成后，将元组)公布给所有群的群管理员；Ki为协商过程中第i个节点i∈发来的协商信息，G为选取的椭圆曲线的基点。3.如权利要求1所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，交易发起节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；具体包括：交易发起节点向群管理员节点发送入群申请；群管理员节点收到入群申请后，将生成第一随机数，并将生成的第一随机数发送给申请入群的交易发起节点；申请入群的交易发起节点收到第一随机数后，将第一随机数利用自身私钥进行加密得到第一密文；将第一密文、申请入群交易发起节点的自身公钥以及认证证书组成三元组信息s1，将三元组信息s1发送给群管理员节点；群管理员节点接收到三元组信息s1后，将三元组信息s1中的申请入群交易发起节点的自身公钥以及认证证书组成二元组信息，将二元组信息发送给公证机构节点来验证申请入群的交易节点的合法性；如果合法，则群管理员节点将利用申请入群的交易发起节点的公钥，对第一密文进行解密，得到解密结果，解密结果与第一随机数进行比对，如果二者相等，则申请入群的交易节点的身份验证通过，群管理员节点将申请入群的交易发起节点作为本群的群成员；之后群内将根据交易发起节点发来的内容，生成交易发起节点的群签名证书信息元组；其中，群签名证书信息元组，包括：群签名证书，群编号，加密公钥SPK，以及对前三者的签名。4.如权利要求1所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，所述生成交易的群签名步骤之后，所述交易发起节点向交易接收节点发送交易请求步骤之前，还包括：群管理员节点使用监管公钥SPK对交易发起节点的公钥pk进行加密；所述群管理员节点使用监管公钥SPK对交易发起节点的公钥pk进行加密；具体包括：对交易发起节点公钥pk进行加密的过程，群管理员节点直接使用监管公钥SPK对pk进行加密，获得密文SPK，其由CM和Cm组成；CM＝pk+r×SPKCm＝r×GSPK＝同时，通过hash算法生成明文pk的hash值H，用来检验解密之后的信息是否未被篡改，r为加密时选取的混淆盐值。5.如权利要求1所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，交易发起节点在接收到群签名之后向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证；具体包括：交易发起节点向区块链广播交易，广播的内容包括，GSK,群签名，群序号))，交易内容，时间戳，接收方地址)；其中，GSK表示群管理员节点对加密公钥的hash进行签名，用来验证接收到的加密公钥未被篡改；区块链的所有节点使用群公钥对交易进行验证，多笔交易组成一个区块，矿工将新的区块加入到区块链中，交易即完成。6.如权利要求1所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，所述方法，还包括：审计节点针对交易过程中提取出的加密公钥SPK，通过协商解密获取交易发起节点的真实公钥，在获得真实公钥后，审计节点向公证机构节点提交申请，以获得交易发起节点的身份。7.如权利要求6所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，审计节点针对交易过程中提取出的加密公钥SPK，通过协商解密获取交易发起节点的真实公钥，在获得真实公钥后，审计节点向公证机构节点提交申请，以获得交易发起节点的身份；具体包括：协商解密过程：在解密过程中，解密器将用于聚合来自不同审计节点的解密信息K′i；解密信息由解密节点在本地生成：K′i＝Cm×，其中，Cm来自于交易链当中，属于SPK的一部分；如公式所示，解密发起节点在获得其他解密节点的解密信息后，将采用解密协商协议对密文进行解密，最终获得交易发起节点的真实公钥pk；其中，CM和Cm是需要解密的密文的两部分；G为选取的椭圆曲线的基点；K′i是来自于不同审计节点的解密信息。8.如权利要求1所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，所述方法，还包括：身份识别步骤；所述身份识别步骤，具体包括：对解密得到pk进行验证；利用hash算法对解密得到的pk进行运算，得到H′；使用该hash值与交易链当中携带的hash值进行比较，若H′＝H，则证明解密得到的公钥是正确的。9.如权利要求1所述的基于群签名的可监管区块链交易隐私保护方法，其特征是，审计节点解密获取发送者的公钥信息的过程，某一个审计节点向所有的审计节点广播解密请求；其它审计节点在接收到请求后，首先验证发起解密请求者的身份，其次从审计节点网络当中验证签名的存在与合法性，最后根据本次解密请求生成解密密钥，并响应给解密请求者；当解密请求者接收到所有审计节点的响应之后，将对密文进行解密，获取到交易发起节点的公钥。10.基于群签名的可监管区块链交易隐私保护系统，其特征是，包括：若干个交易节点，和区块链，所述区块链上设有公证机构节点、群管理员节点和多个审计节点组成的审计节点网络；每个交易节点，均将自身信息发送到公证机构节点，由公证机构节点验证后，生成每个交易发起节点和交易接收节点的认证证书；其中，交易节点，包括：交易发起节点和交易接收节点；交易节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；验证身份之后，交易节点和群管理员节点进行交互，生成交易的群签名；交易发起节点在接收到群签名之后向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证，最终交易结束。
说明书desc
技术领域本发明涉及区块链技术领域，具体为基于群签名的可监管区块链交易隐私保护方法及系统。背景技术本部分的陈述仅仅是提到了与本发明相关的背景技术，并不必然构成现有技术。区块链是一种基于点对点网络的分布式账本，其具有匿名性、不可篡改性在许多不同的领域都具有广阔的应用前景。随着人们对于隐私保护的重视，许多区块链应用链引入了如群签名、环签名、零知识证明等密码学原语以实现对区块链交易用户身份和交易内容的隐私保护。随着隐私保护技术的不断发展，区块链匿名性不断增强。强匿名性在保护用户身份、交易隐私的同时，也给区块链交易的身份追踪、行为监管带来了极大的挑战。发明内容为了实现对区块链交易的监管，本发明公开了一种基于群签名的可监管区块链交易隐私保护方法及系统，通过群签名技术和本发明当中设计的监管结构和监管密钥生成、协商解密算法，实现了对交易中发起者的身份隐私保护和分布式监管，有效地在实现身份追踪方面监管的同时解决了当前监管过程中常见的监管节点权力过大、容易出现内部腐败的问题。第一方面，本发明提供了基于群签名的可监管区块链交易隐私保护方法；基于群签名的可监管区块链交易隐私保护方法，包括：每个交易节点，均将自身信息发送到公证机构节点，公证机构节点验证后，生成每个交易节点的认证证书；其中，交易节点，包括：交易发起节点和交易接收节点；交易发起节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；验证身份之后，交易节点和群管理员节点进行交互，生成交易的群签名；交易发起节点在接收到群签名之后向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证，最终交易结束。进一步地，所述方法，还包括：审计节点网络获取调查交易节点身份的请求，公证机构节点完成待调查交易发起节点的身份合法性验证。所述审计节点网络，包括：公证机构节点、群管理员节点和多个审计节点。进一步地，所述方法，还包括：审计节点针对交易过程中提取出的群签名，从联盟链中检索当前群签名的来源，并获得当前群签名的内容以及交易发起节点被加密的公钥，在解密获得公钥后，审计节点向公证机构节点提交申请，以获得交易发起节点的身份。所述联盟链，包括：公证机构节点、群管理员节点、多个审计节点和交易节点。第二方面，本发明提供了基于群签名的可监管区块链交易隐私保护系统；基于群签名的可监管区块链交易隐私保护系统，包括：若干个交易节点，和区块链，所述区块链上设有公证机构节点、群管理员节点和多个审计节点组成的审计节点网络；每个交易节点，均将自身信息发送到公证机构节点，由公证机构节点验证后，生成每个交易节点的认证证书；其中，交易节点，包括：交易发起节点和交易接收节点；交易发起节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；验证身份之后，交易节点和群管理员节点进行交互，生成交易的群签名；交易发起节点在接收到群签名之后向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证，最终交易结束。进一步地，审计节点网络获取调查交易节点身份的请求，公证机构节点完成待调查交易节点发起的身份合法性验证。进一步地，审计节点针对交易过程中提取出的群签名，从联盟链中检索当前群签名的来源，并获得当前群签名的内容以及交易发起节点被加密的公钥，在解密获得公钥后，审计节点向公证机构节点提交申请，以获得交易发起节点的身份。进一步地，审计节点解密获取发送者的公钥信息的过程，某一个审计节点向所有的审计节点广播解密请求；其它审计节点在接收到请求后，首先验证发起解密请求者的身份，其次从联盟链当中验证签名的存在与合法性，最后根据本次解密请求生成解密密钥，并响应给解密请求者。当解密请求者接收到所有审计节点的响应之后，将对密文进行解密，获取到交易发起节点的公钥。与现有技术相比，本发明的有益效果是：通过CA真实身份认证与群签名可监管映射对区块链交易当中的交易发出方在进行隐私保护的基础上实现可监管性。本发明在用户和审计节点网络之间的权限问题在不同层次上进行了标识，结合博弈论原理对其监管权进行了分布部署；通过设计审计密钥生成和协商解密的密码学算法，实现了多个节点共同审计才能获取原始用户信息的过程；通过可信任的公证机构和可靠的群管理员使用监管公钥对追踪信息进行加密，保证了在进行监管的同时的信息安全性，在对于不同等级的联盟链在隐私保护的基础上进行可行性审计节点网络面具有相当的普适性，允许在当前的各种区块链的应用系统当中进行修改，实施对于系统用户的精确监管。本发明附加方面的优点将在下面的描述中部分给出，或通过本发明的实践了解到。附图说明构成本发明的一部分的说明书附图用来提供对本发明的理解，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。图1为本发明第一个实施例的框架示意图；图2为本发明第一个实施例中CA认证用户身份的示意图；图3为本发明第一个实施例中用户在群签名模型中的示意图；图4为本发明第一个实施例在基于用户身份追踪交易当中的流程示意图；图5为本发明第一个实施例监管公钥SPK的生成过程；图6为本发明第一个实施例协商解密过程。具体实施方式应该指出，以下详细说明都是示例性的，旨在对本发明提供的说明。除非另有指明，本文使用的所有技术和科学术语具有与本发明所属技术领域的普通技术人员通常理解的相同含义。实施例一本实施例提供了基于群签名的可监管区块链交易隐私保护方法；基于群签名的可监管区块链交易隐私保护方法，包括：S101：每个交易节点，均将自身信息发送到公证机构节点，由公证机构节点验证后，生成每个交易节点的认证证书；其中，交易节点，包括：交易发起节点和交易接收节点；S102：交易发起节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；验证身份之后，交易发起节点和群管理员节点进行交互，生成交易的群签名；S103：在接收到群签名之后，交易发起节点向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证，最终交易结束。本发明中的“节点”可以理解为终端或服务器。本发明具有对交易发起节点真实身份追踪、保护交易发起节点身份隐私的功能。进一步地，所述S101：每个交易节点，将自己的真实身份信息和自身生成的公钥通过可信任的传输介质，发送给可信任的公证机构节点,公证机构节点运用其自身的私钥对于交易节点的公钥进行数字签名，以备在接下来的流程中验证公钥的合法性。首先，交易发起节点在加入到区块链交易时会在本地生成属于自身的密钥对。其次，公证机构节点生成自己的密钥对。交易节点对公证机构节点发出注册申请，并提交公证机构节点要求的相关身份信息，当公证机构节点对交易发起节点身份进行检验合格后，将生成公钥pk的公钥证书，即:SK。最后，将签名SK，发送给交易发起节点，同时将公钥pk，以及其真实身份保存编号ID，以列表的形式保存在公证机构节点和审计机构组成的具有公证性的联盟链当中，即交易发起节点身份列表。注：ID代表着交易发起节点真实身份被保存在交易发起节点身份列表的链接编号。对于每个交易发起节点都将由公证机构节点对其进行密钥对验证和交易发起节点真实身份验证，并基于其真实身份的公钥生成一个公钥证书，同时将交易发起节点提交的信息、公证机构节点CA对交易发起节点身份进行查验的过程，对交易发起节点生成的公钥以及其数字证书将保存在公证机构节点CA服务器当中，同时将公证机构节点CA服务器状态生成不同时间节点的hash发送到有审计节点参与组成的交易发起节点真实身份链当中。证书颁发机构通过对交易发起节点真实身份进行验证后将对收到的交易发起节点提交的请求、证书颁发机构自身对于发来请求交易发起节点的真实身份审核过程以及最终生成的交易发起节点公钥证书都将在加密后存储在由证书颁发机构和审计机构作为节点组成的安全交易发起节点真实信息身份链当中，以备查询追踪。进一步地，所述S101步骤之前，还包括：S100：审计节点初始化生成监管密钥SPK。进一步地，S100：审计节点初始化生成监管密钥SPK；具体包括：假设实施过程中审计机构存在三个互不相属的审计节点A、B、C；S1001：进行密钥的生成，各个审计节点分别选择一个随机数作为其自身的密钥keyA,keyB，keyC。S1002：选择一个随机混淆值ri，0，i∈作为协商过程的计数器，在进行公钥协商的过程中利用随机混淆值ri，0，i∈来对审计节点的密钥进行混淆。同时，使用选择的椭圆曲线的基点G与本次协商的参与协商值进行运算，生成参与监管公钥协商过程的密钥Ki＝×G。S1003：如图5，生成公钥：通过协商生成一个必须由所有审计节点共同参与才可以进行解密的监管公钥SPK。如公式所示，来自于不同审计节点经过混淆的协商信息，经过密钥协商器的协商，最终产生了需要所有审计节点共同参与才能解密的监管公钥SPK。协商完成后，将元组)公布给所有群的群管理员。Ki为协商过程中第i个节点i∈发来的协商信息，G为选取的椭圆曲线的基点。进一步地，所述S102：交易发起节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；具体包括：交易发起节点向群管理员节点发送入群申请；群管理员节点收到入群申请后，将生成第一随机数，并将生成的第一随机数发送给申请入群的交易发起节点；申请入群的交易发起节点收到第一随机数后，将第一随机数利用自身私钥进行加密得到第一密文；将第一密文、申请入群交易发起节点的自身公钥以及认证证书组成三元组信息s1，将三元组信息s1发送给群管理员节点；群管理员节点接收到三元组信息s1后，将三元组信息s1中的申请入群交易发起节点的自身公钥以及认证证书组成二元组信息，将二元组信息发送给公证机构节点来验证申请入群的交易节点的合法性；如果合法，则群管理员节点将利用申请入群的交易发起节点的公钥，对第一密文进行解密，得到解密结果，解密结果与第一随机数进行比对，如果二者相等，则申请入群的交易节点的身份验证通过，群管理员节点将申请入群的交易发起节点作为本群的群成员；之后群内将根据交易发起节点发来的内容，生成交易发起节点的群签名证书信息元组；其中，群签名证书信息元组，包括：群签名证书，群编号，加密公钥SPK，以及对前三者的签名。进一步地，所述生成交易的群签名步骤之后，所述在接收到群签名之后，交易发起节点向交易接收节点发送交易请求步骤之前，还包括：S1023：群管理员节点使用监管公钥SPK对交易发起节点的公钥pk进行加密。S1023：群管理员节点使用监管公钥SPK对交易发起节点的公钥pk进行加密；具体包括：对交易发起节点公钥pk进行加密的过程，群管理员节点直接使用监管公钥SPK对pk进行加密，获得密文SPK，其由CM和Cm组成。CM＝pk+r×SRKCm＝r×GSRK＝同时，通过hash算法生成明文pk的hash值H,用来检验解密之后的信息是否未被篡改，r为加密时选取的混淆盐值。示例性地，交易节点首先向群管理员节点提交申请进入群的申请，群管理员节点在接收到入群申请后，将生成一个随机数r，并将其发送给当前交易节点。交易节点收到随机数后，将随机数利用自己的私钥进行加密得到密文c＝sk，并将得到的密文c，自身公钥pk以及来自于公证机构节点的公钥证书组成一个三元组)，并将其再次提交给群管理员节点。群管理员节点将接收到的三元组当中的交易发起节点公钥和公钥证书组成二元组)使用公证机构的公钥来检验该交易发起节点的合法性，若交易发起节点合法则群管理员节点将利用收到的交易发起节点公钥来解密密文c得到r′。如果r′＝r，则交易发起节点身份验证通过，群管理员节点将允许该交易发起节点成为本群的群成员。之后，群内将根据交易发起节点发来的公钥与随机选择的其它公钥生成群成员的群证书。群成员利用获得的群证书对交易进行签名，并将交易广播出去。群管理员节点通过与CA交互对交易发起节点身份进行合法性验证之后，将允许交易发起节点加入到自己所在的群当中，生成该成员的群证书。在群管理员节点对交易发起节点真实身份通过与证书颁发机构进行验证后，群管理员节点将会将交易发起节点的真实公钥添加到群签名生成库中，并根据其发来的交易内容对其执行聚合算法最终将生成本次交易的群证书。交易发起节点所在的群允许交易发起节点申请退出群，即交易发起节点可以在一次交易进行完成后便退出本次的生成群，这使得每次交易交易发起节点的群签名将各不相同极大程度上提高了其隐私安全性。进一步地，所述S103：在接收到群签名之后，交易发起节点向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证；具体包括：交易发起节点向区块链广播交易，广播的内容包括，GSK,群签名，群序号))，交易内容，时间戳，接收方地址)。区块链的所有节点使用群公钥对交易进行验证，多笔交易组成一个区块，矿工将新的区块加入到区块链中，交易即完成。示例性地，在达成共识的各节点交易验证时，验证节点首先根据群序号获取到该群所对应的群公钥，接下来，使用群公钥对交易的群签名进行验证。由于群签名的基本密码学特性，验证者利用群公钥仅可以验证所得群签名的正确性，但不能确定群中的正式签署者。若验证结果为“正确”，则证明该交易是一笔正常的交易，符合上链的规则。进一步地，所述方法，还包括：S104：审计节点针对交易过程中提取出的加密公钥SPK，通过协商解密获取交易发起节点的真实公钥，在获得真实公钥后，审计节点向公证机构节点提交申请，以获得交易发起节点的身份。进一步地，所述S104具体包括：如图6，协商解密过程：在解密过程中，解密器将用于聚合来自不同审计节点的解密信息K′i。解密信息由解密节点在本地生成：K′i＝Cm×，其中，Cm来自于交易链当中，属于SPK的一部分。如公式所示，解密发起节点在获得其他解密节点的解密信息后，将采用解密协商协议对密文进行解密，最终获得交易发起节点的真实公钥pk。其中，CM和Cm是需要解密的密文的两部分；G为选取的椭圆曲线的基点；K′i是来自于不同审计节点的解密信息。基于接收方或者交易来追踪交易发起节点的真实身份，在这当中，审计节点将从交易当中获取交易发起方的加密公钥SPK，并对其进行解密获取到原始公钥，进而向公证机构节点申请查验该公钥对应的真实身份，来追踪该交易发起节点。示例性地，这一过程是基于审计节点已经通过交易获取到通过群签名方案生成的交易群签名之后，需要对交易的上游进行溯源；在这一过程当中，审计节点首先需要针对交易当中提取出的加密交易发起节点公钥SPK和群签名、群序号以及GSK,群签名,群序号))；接下来，审计节点验证以上内容的合法性和未被篡改；若未被篡改，则运行协商解密算法解密获得交易发起者的公钥pk。在获得公钥后将向公证机构节点提交申请，以获得交易发起节点的真实身份，来补全证据链，并且深挖犯罪线索链。基于接收方或者交易来追踪交易发起节点的真实身份，在这当中，审计部门将从交易链当中提取解密出该交易发起节点的加密公钥SPK，进而向交易发起节点身份列表申请查验该公钥对应的真实身份，来追踪该交易发起节点。必要情况下，可以申请从交易发起节点身份列表中获取详细的全流程的交易发起节点注册过程。进一步地，所述方法，还包括：S105：身份识别步骤；所述身份识别步骤，具体包括：对解密得到pk进行验证；利用hash算法对解密得到的pk进行运算，得到H′。使用该hash值与交易链当中携带的hash值进行比较，若H′＝H，则证明解密得到的公钥是正确的。在验证公钥pk是正确的之后，审计节点将向交易发起节点身份列表申请获得交易发起节点在真实生活当中的身份信息。本发明是基于区块链交易之间的交易发起节点与公钥之间的一对多的映射关系来设计的，通过引入公证机构节点可信用户身份列表以及群签名监管节点、监管可信验证链，通过密码学算法，以加密结构监管交易主链以达到可信监管，提高监管的可信性、真实性。使之对基于公证机构节点和群签名的区块链交易链可以实现普遍可用的监管。如图1所示，为保护交易发起节点自身私钥的安全性，交易发起节点可以根据区块链提供的密钥生成器，随机选择随机数产生自身的公私钥对，这样只要交易发起节点在密钥保管过程中不出现问题，就可以保证私钥的安全性。密钥对生成后将生成的公钥向公证机构节点，也就是证书颁发机构进行备案，获取合法的公钥证书来获得进行交易的许可权。其获得交易权的过程，如图2所示：交易发起节点需要对公证机构节点进行基于非对称密码原语的请求验证，以此来检验公证机构节点的真实性、合法性，以防止遭受到伪装攻击。验证公证机构节点合法性后，将自身的公钥以及真实身份信息发送给公证机构节点，用作公证机构节点进行真实身份验证的存储备案。公证机构节点对交易发起节点身份进行检验后，对符合条件的交易发起节点颁发基于非对称密码原语的公钥证书，来使得交易发起节点该公钥具有合法的上链权限。接下来，在公证机构节点当中将对存储信息保存在用户身份列表当中。注意，用户身份列表的节点主要由众多具有合法监管权限的部门服务器组成，同时为了防止由于保存造成信息泄露以及减少用户身份列表对存储资源的浪费，列表上的数据将以公证机构节点数据库存储的交易发起节点真实身份—公钥—公钥证书—生成时间的信息元组映射为主。接下来，将对取得合法证书的交易发起节点公钥进行群签名匿名化操作，其主要目的是，为了防止区块链当中的交易分析攻击。其主要过程如图3所示：交易发起节点将基于非对称密码原语来验证群管理员节点的合法性。在确定群管理员节点可信后，交易发起节点将自身的公钥以及公钥证书发送给群管理员节点。群管理员节点首先基于CA的公钥验证交易发起节点的公钥证书以此来确定该交易发起节点的合法性。交易发起节点匿名方法则基于聚合算法：来实现对于来自于不同交易发起节点的公钥hash进行聚合生成群签名证书；在生成群签名证书之后，群管理员节点将利用非对称密码原语对交易发起节点群签名证书和加密的交易发起节点公钥SPK进行自身的身份签名，并将对自签名与生成的交易发起节点群签名证书以及群编号和加密公钥发送回交易发起节点。交易发起节点收到管理员的群签名证书信息元组)后，将利用群管理员节点的公钥验证群管理员节点的合法性，验证成功后则证明生成的群签名证书是合法可以参与到区块链的交易当中的。交易发起节点验证证书合法性之后，将要发送的交易使用接收到的群签名证书信息元组进行签名，之后将其广播到区块链网络当中。以上则是本发明当中交易的前置流程的具体实施方案，接下来则将就本发明当中的监管过程的具体实施进行介绍：首先，需要明确的是，本发明当中设计的审计节点网络案主要有：审计节点网络仅仅只是知道经过两次匿名后交易发起节点参与交易的群签名而需要追踪交易发起节点的真实身份的监管追踪，即自下而上进行追踪。自下而上的其主要流程如图4所示：审计节点网络从交易当中提取该群签名所对应的信息元组。审计节点网络根据获取到的信息元组，获得加密后的公钥SPK，并结合群签名、群序号以及GSK,群签名,群序号)使用GPK检验其真实性。若检验结果为真，则表示获得的信息元组是真实可信未经过篡改的。审计节点网络内部将进行协商解密，经由所有的审计节点同意后，审计节点A将获得交易发起节点原始公钥pk，并向交易发起节点身份列表当中申请交易发起节点身份。获取到交易发起节点身份列表当中的交易发起节点身份元组后，审计节点网络利用hash算法生成与之对应的hash值，并向自身所在的用户身份列表进行检索验证。检索成功，则审计节点网络自交易发起节点身份列表当中获取到的目标身份未被篡改，是可靠的。基于椭圆曲线的密钥生成和与之相对应的协商解密算法，包括：一个公钥生成器，多个审计节点，和一个协商解密器；在算法层次上主要包括：公钥生成算法和协商解密算法。我们的算法实现了只有所有审计节点共同参与的情况下，监管公钥SPK加密的密文才能被解密。防止了单独一个审计方所会出现的监管滥用问题。在公钥生成的过程中，各个审计节点首先在本地生成自身密钥key1,key2,…,keyn,；接下来，审计节点分别将自身密钥发送到公钥生成器中运行公钥生成算法，生成监管公钥SPK。之后将其广播到网络当中，群管理员节点使用其对交易发起节点公钥进行加密。在协商解密的过程中，各个审计节点首先需要到交易链上对解密信息进行验证；之后，将利用被解密的信息结合自身独有的密钥生成本次解密的密钥；接下来，审计方将解密密钥通过可信通道发送到解密申请方；解密申请方将运行协商解密器当中的协商解密算法，对加密信息进行解密，最终获得交易发起节点公钥。通过密钥生成算法和与之相对应的协商解密算法，限制了审计方监管权力过大的问题。综上所述，本发明是基于区块链当中以链制链的思想，利用区块链当中不可篡改、不可伪造的基本特性，对通过两次匿名参与到交易当中的区块链系统进行可信的监管，在保证其可信监管的同时并未对其隐私保护性产生较大的影响。实施例二本实施例提供了基于群签名的可监管区块链交易隐私保护系统；基于群签名的可监管区块链交易隐私保护系统，包括：若干个交易节点，和区块链，所述区块链上设有公证机构节点、群管理员节点和多个审计节点；其中，公证机构节点、群管理员节点和多个审计节点共同组成审计节点网络；每个交易节点，均将自身信息发送到公证机构节点，由公证机构节点验证后，生成每个交易发起节点和交易接收节点的认证证书；其中，交易节点，包括：交易发起节点和交易接收节点；交易节点向群管理员节点发送入群申请，群管理员节点与公证机构节点交互，来完成申请入群的交易节点的身份合法性验证；验证身份之后，交易节点和群管理员节点进行交互，生成交易的群签名；交易发起节点在获得群签名之后向交易接收节点发送交易请求，交易发起节点将群签名和交易信息发送给交易接收节点，交易接收节点获取公布出来的群公钥，来完成交易发起节点的合法性验证，最终交易结束。进一步地，审计节点网络获取调查交易节点身份的请求，根据公证机构节点颁布的证书完成待调查交易发起的身份合法性验证。进一步地，审计机构节点针对交易过程，从中提取出加密的公钥进行协商解密，在获得公钥后，审计机构节点向公证机构节点组成的用户身份列表提交申请，以获得交易发起节点的身份。进一步地，审计节点解密获取发送者的公钥信息的过程，某一个审计节点向所有的审计节点广播解密请求；其它审计节点在接收到请求后，首先验证发起解密请求者的身份，其次从审计节点网络当中验证签名的存在与合法性，最后根据本次解密请求生成解密密钥，并响应给解密请求者。当解密请求者接收到所有审计节点的响应之后，将对密文进行解密，获取到交易发起节点的公钥。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
