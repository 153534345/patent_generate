标题title
一种不同温度下的锂电池SOC在线预估方法
摘要abst
本发明公开了一种不同温度下的锂电池SOC在线预估方法，基于不同温度下对电路模型中各参数进行在线辨识，并把温度作为输入，通过差分选择算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动做出调整，使用这个不断变化的方差代入到原扩展卡尔曼滤波算法中，完成循环工况下SOC的在线预估。本发明通过加入不同温度作为输入条件，使锂电池SOC偏差更小，同时消除了传统卡尔曼滤波算法没有考虑温度和噪声方差的误差，提高了SOC的估计精度。
权利要求书clms
1.一种不同温度下的锂电池SOC在线预估方法，其特征在于，包括以下步骤：建立锂电池等效电路模型和动态系统方程，获取开路电压、内阻R0、极化电阻、极化电容与SOC和温度的函数关系式；进行不同温度下锂电池的OCV测试，测量不同SOC和温度下的锂电池开路电压值，得到开路电压与SOC和温度的对应关系曲线；在不同温度下记录锂电池在UDDS工况下数据，通过扩展卡尔曼滤波算法对锂电池各参数进行在线辨识；所述参数包括内阻R0、极化电阻和极化电容；根据锂电池等效电路模型建立EKF离散非线性系统方程，通过扩展卡尔曼滤波建立带有温度校正的锂电池的状态方程和观测方程，并利用差分进化算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动调整，通过将不断变化的噪声方差代入到原扩展卡尔曼滤波算法中，完成循环工况下SOC的在线预估。2.根据权利要求1所述不同温度下的锂电池SOC在线预估方法，其特征在于，在步骤中，所述锂电池等效电路模型为二阶RC电路模型，所述二阶RC电路模型包括电化学极化内阻R1、电化学极化电容C1、浓差极化电阻R2和浓差极化电容C2。3.根据权利要求2所述不同温度下的锂电池SOC在线预估方法，其特征在于，在步骤中，所述动态系统方程如下：U0＝Uoc-R0·I-U1-U2其中，U0表示电池工作状态下的端电压，Uoc是与SOC和温度有关的开路电压表达式，R0是与SOC和温度T有关的欧姆内阻表达式，I表示放电电流大小，U1和U2分别表示为两组RC环路端电压，t为时间；建立四个极化参数R1，R2，C1，C2与SOC和温度相关的非线性函数表达式：R1，C1，R2，C2。4.根据权利要求3所述不同温度下的锂电池SOC在线预估方法，其特征在于，在步骤中，使用相同性能参数的锂电池，分别在-30℃、-25℃、-20℃、-15℃、-10℃、-5℃、0℃、5℃、10℃、15℃、20℃环境温度下做OCV测试，将测试数据拟合得到开路电压与SOC和温度的对应关系曲线。5.根据权利要求4所述不同温度下的锂电池SOC在线预估方法，其特征在于，步骤的具体过程如下：分别在-30℃、-25℃、-20℃、-15℃、-10℃、-5℃、0℃、5℃、10℃、15℃、20℃环境温度下完成锂电池的UDDS工况测试，并记录每个不同温度下的电压、电流和SOC真值；存放中间过程估值；初始化参数并把参数的估计值转换为R0，R1，R2，C1，C2；更新下一时刻值；计算卡尔曼滤波增益矩阵，采集下一时刻的电压、电流数据；重复步骤-，对锂电池模型参数在线辨识。6.根据权利要求5所述不同温度下的锂电池SOC在线预估方法，其特征在于，步骤的具体过程如下：建立EKF离散非线性系统方程：χk+1＝f+wkyk＝g+vk其中，χk+1为输入，yk为输出，wk和vk是系统的噪声，且服从正态分布，与f，g相互独立，f和g为非线性函数；通过扩展卡尔曼滤波算法建立锂电池的状态方程与观测方程：Uk＝Uoc-ikR0-U1k-U2k其中，τd和τe为两个不同的时间常数，Uoc为开路电压，sk为k时刻的SOC的估计值，ik为k时刻的电流，Cn为电池的额定容量，ηt为充放电效率，Uk为k时刻的极化总电压估计值，U1k为k时刻R1上的极化电压估计值，U2k为k时刻R2上的极化电压估计值；根据采集锂电池充放电过程中的端电压与电流数据，对离散化后的状态方程和观测方程进行EKF递推计算，并使用差分进化算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动调整，使用不断变化的噪声方差代入到原扩展卡尔曼滤波算法中，完成循环工况下SOC的在线预估。7.根据权利要求6所述不同温度下的锂电池SOC在线预估方法，其特征在于，所述差分进化算法的过程如下：种群初始化；变异操作；交叉操作，采用二项交叉方式；选择操作，采用贪婪选择方式。
说明书desc
技术领域本发明属于电动汽车电池管理领域，特别涉及了一种锂电池SOC在线预估方法。背景技术随着汽车行业的不断发展，传统燃油汽车所带来的能源消耗、环境污染等矛盾渐渐凸现，成了社会进步中必须考虑的因素。所以加大电动汽车的发展力度，降低电动汽车的使用成本，实施低碳可持续发展的策略，能够缓解当下人们对于能源与环境问题的担忧。作为电动汽车电池管理系统的重要组成部分，锂电池荷电状态估计已成为目前电动汽车中的研究热点。电池荷电状态估计既是整个能量管理系统的重点，也是难点。因此提炼出准确且有效的参数辨识算法和SOC估算算法，准确地在线估计电池荷电状态对电池乃至于整车的性能提升都有着非常重要的意义。目前，常用的估计方法主要有开路电压法、安时积分法、神经网络法和卡尔曼滤波法等。开路电压法需先根据实验值确定电池开路电压和SOC的关系，然后通过测量开路电压实现电池SOC的估算，开路电压法简单易行，其缺点就是在电池断电时才能使用，需要对电池进行长时间的静置，不能实现实时在线测量。安时积分方法的基本原理是电池在充放电过程中,通过电流对时间积分,可以计算出电池充入或放出的电量,将此电量除以电池当前状态可用容量,再与电池初始进行相应的加减运算即可得出当前状态值，但由于电流采样和充放电效率误差引起的累积误差随积分过程逐渐增大，从而导致SOC估计误差增大。由大量神经元通过广泛连接构成的复杂非线性系统即称为神经网络。根据采集到的数据，神经网络可以自动归纳、学习和整理。但是此方法需要大量的数据进行训练，训练数据和训练方法对估计精度的影响较大。扩展卡尔曼滤波法是在卡尔曼滤波法基础上衍生出来的一种算法，相比于卡尔曼滤波法对系统的高度线性化要求，扩展卡尔曼滤波法可在非线性系统中得到应用，由于电池在工作过程中表现出较强的非线性，其属于非线性系统，因此采用扩展卡尔曼滤波法进行在线辨识可以获取较高的辨识准确度，在扩展卡尔曼滤波方程中，过程噪声以及过程噪声方差阵是一组固定的值，但噪声不可测量且过程噪声也在随着环境的变化而不断变化，固定取值明显是不合适的。发明内容为了解决上述背景技术提到的技术问题，本发明提出了一种不同温度下的锂电池SOC在线预估方法。为了实现上述技术目的，本发明的技术方案为：一种不同温度下的锂电池SOC在线预估方法，包括以下步骤：建立锂电池等效电路模型和动态系统方程，获取开路电压、内阻R0、极化电阻、极化电容与SOC和温度的函数关系式；进行不同温度下锂电池的OCV测试，测量不同SOC和温度下的锂电池开路电压值，得到开路电压与SOC和温度的对应关系曲线；在不同温度下记录锂电池在UDDS工况下数据，通过扩展卡尔曼滤波算法对锂电池各参数进行在线辨识；所述参数包括内阻R0、极化电阻和极化电容；根据锂电池等效电路模型建立EKF离散非线性系统方程，通过扩展卡尔曼滤波建立带有温度校正的锂电池的状态方程和观测方程，并利用差分进化算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动调整，通过将不断变化的噪声方差代入到原扩展卡尔曼滤波算法中，完成循环工况下SOC的在线预估。进一步地，在步骤中，所述锂电池等效电路模型为二阶RC电路模型，所述二阶RC电路模型包括电化学极化内阻R1、电化学极化电容C1、浓差极化电阻R2和浓差极化电容C2。进一步地，在步骤中，所述动态系统方程如下：U0＝Uoc-R0·I-U1-U2其中，U0表示电池工作状态下的端电压，Uoc是与SOC和温度有关的开路电压表达式，R0是与SOC和温度T有关的欧姆内阻表达式，I表示放电电流大小，U1和U2分别表示为两组RC环路端电压，t为时间；建立四个极化参数R1，R2，C1，C2与SOC和温度相关的非线性函数表达式：R1，C1，R2，C2。进一步地，在步骤中，使用相同性能参数的锂电池，分别在-30℃、-25℃、-20℃、-15℃、-10℃、-5℃、0℃、5℃、10℃、15℃、20℃环境温度下做OCV测试，将测试数据拟合得到开路电压与SOC和温度的对应关系曲线。进一步地，步骤的具体过程如下：分别在-30℃、-25℃、-20℃、-15℃、-10℃、-5℃、0℃、5℃、10℃、15℃、20℃环境温度下完成锂电池的UDDS工况测试，并记录每个不同温度下的电压、电流和SOC真值；存放中间过程估值；初始化参数并把参数的估计值转换为R0，R1，R2，C1，C2；更新下一时刻值；计算卡尔曼滤波增益矩阵，采集下一时刻的电压、电流数据；重复步骤-，对锂电池模型参数在线辨识。进一步地，步骤的具体过程如下：建立EKF离散非线性系统方程：χk+1＝f+wkyk＝g+vk其中，χk+1为输入，yk为输出，wk和vk是系统的噪声，且服从正态分布，与f，g相互独立，f和g为非线性函数；通过扩展卡尔曼滤波算法建立锂电池的状态方程与观测方程：Uk＝Uoc-ikR0-U1k-U2k其中，τd和τe为两个不同的时间常数，Uoc为开路电压，sk为k时刻的SOC的估计值，ik为k时刻的电流，Cn为电池的额定容量，ηt为充放电效率，Uk为k时刻的极化总电压估计值，U1k为k时刻R1上的极化电压估计值，U2k为k时刻R2上的极化电压估计值；根据采集锂电池充放电过程中的端电压与电流数据，对离散化后的状态方程和观测方程进行EKF递推计算，并使用差分进化算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动调整，使用不断变化的噪声方差代入到原扩展卡尔曼滤波算法中，完成循环工况下SOC的在线预估。进一步地，所述差分进化算法的过程如下：种群初始化；变异操作；交叉操作，采用二项交叉方式；选择操作，采用贪婪选择方式。采用上述技术方案带来的有益效果：本发明在现有技术的内阻与电压估计模型中加入温度参数，充分考虑温度对锂电池SOC的影响，并且运用差分进化算法对原来扩展卡尔曼算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动做出调整，使用这个不断变化的最优方差代入到原EKF算法中，大大提高了估计模型的准确。基于本发明，可以有效地提高电池能量的利用率，延长电池寿命。附图说明图1为本发明的方法流程图；图2为本发明中锂电池等效电路模型示意图；图3为实施例中锂电池OCV-SOC标定曲线图；图4为实施例中锂电池SOC-OCV-T的关系曲线图；图5为实施例中在相同温度下改进EKF与原EKF的SOC预估对比图；图6为实施例中锂电池SOC-T在线估计算法对比图。具体实施方式以下将结合附图，对本发明的技术方案进行详细说明。本发明设计了一种不同温度下的锂电池SOC在线预估方法，如图1所示，步骤如下：步骤1、建立锂电池等效电路模型和动态系统方程，获取开路电压、内阻R0、极化电阻、极化电容与SOC和温度的函数关系式；步骤2、进行不同温度下锂电池的OCV测试，测量不同SOC和温度下的锂电池开路电压值，得到开路电压与SOC和温度的对应关系曲线；步骤3、在不同温度下记录锂电池在UDDS工况下数据，通过扩展卡尔曼滤波算法对锂电池各参数进行在线辨识；所述参数包括内阻R0、极化电阻和极化电容；步骤4、根据锂电池等效电路模型建立EKF离散非线性系统方程，通过扩展卡尔曼滤波建立带有温度校正的锂电池的状态方程和观测方程，并利用差分进化算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动调整，通过将不断变化的噪声方差代入到原扩展卡尔曼滤波算法中，完成循环工况下SOC的在线预估。在本实施例中，具体地，上述步骤1中，所述锂电池等效电路模型采用二阶RC电路模型，如图2所示，Uoc表示电池未工作状态下的开路电压，其数值会随着温度和SOC变化而变化，因此开路电压与温度和SOC间存在一定的函数关系式；Uo表示电池工作状态下的端电压，其数值受电流大小影响较大；I表示放电电流大小，方向如图2中所示，充电时方向相反；R0表示电池内部欧姆内阻，受温度和SOC影响较大；R1，R2，C1，C2为两组极化参数，分别表示为电化学极化内阻、浓差极化内阻、电化学极化电容、浓差极化电容，两组参数可分别用来表征电池内部反应过程中的快速和慢速响应特性，与温度和SOC存在一定函数关系；U1和U2分别表示为两组RC环路端电压，其数值和为电池极化总电压。在本实施例中，具体地，上述步骤1中，若要建立电池的动态系统方程，需要以电流I和温度T作为模型外部输入量，端电压U0作为模型输出量，且SOC变化以安时积分法为参考进行计数，相应的电池二阶模型状态方程可描述为：其中，SOC为初始状态电池SOC值，SOC为任意时刻电池SOC值；为特定温度和放电倍率下的电池容量；η为电池库仑系数；I为t时刻的电流；U1，U2为t时刻的两个RC组合的端电压；R1，C1，R2，C2四个极化参数是与SOC和温度相关的非线性函数表达式。电池动态系统方程可描述为：U0＝Uoc-R0·I-U1-U2其中，Uoc是与SOC和温度有关的开路电压表达式，R0是与SOC和温度有关的欧姆内阻表达式。在本实施例中，具体地，上述步骤2中，使用相同性能参数的锂电池，分别在-30℃、-25℃、-20℃、-15℃、-10℃、-5℃、0℃、5℃、10℃、15℃、20℃环境温度下做OCV测试，将测试数据拟合得到开路电压与SOC和温度的对应关系曲线。具体过程如下：2a、首先把温控箱温度调到-30℃，将锂电池放入温控箱充分静置，再以0.3A电流进行恒流放电。放至截止电压，认为此时SOC为0，充分静置2小时后，再以0.3A电流，截止电流0.03A恒流恒压充电，到截止电压后，直至充电电流小于或等于0.03A时认为此时SOC＝100％，静置2h。然后开始进行OCV测试，首先静置10s，紧接着恒流放电2h，然后静置2h，此时认为电池SOC降为90％，循环十次，直到电池SOC为0，完成OCV测试。2b、分别把温控箱温度调到-25℃、-20℃、-15℃、-10℃、-5℃、0℃、5℃、10℃、15℃、20℃环境温度，用相同性能的锂电池重复步骤2a进行OCV测试。首先拟合出常温下的SOC-OCV曲线图，如图3所示。2c、对其SOC值从100％到10％时刻对应的开路电压值进行曲线拟合，把环境温度数值加入进去，得到关于开路电压，SOC与各个温度T的关系曲线图，如图4所示。在本实施例中，具体地，上述步骤3的具体过程如下：3a、将锂电池视为一个系统，系统中的状态方程可表示为：xk+1＝f+wk yk＝g+vk式中，xk为状态变量；uk为系统的激励；wk，vk为系统噪声；yk为系统的输出量；f，g为非线性函数。3b、将等效电路状态方程变形为：UO＝UOC-U1-U2-R0I3c、若在很短时间内电池开路电压相对变化为零，则用电池输出电压对时间求导可得：其中，Uo为端电压值，t为时间，R1和C1，R2和C2为两组电化学极化内阻和浓差极化电容，R0为内阻，U1为一组极化内阻和浓差极化电容上的电压，I为电流值，Uoc为开路电压。3d、将上式转化成状态方程，则该电池等效电路的系统状态变量为：x＝其中，电池输入为：uk＝I，其中uk为k时刻的电池端电压。3e、按锂电池输入电流和输出电压响应量曲线对应关系，利用上式可得到电池系统的状态变量与系统中未知参数的关系求得不同SOC下各参数。3f、在不同温度下通过UDDS动态工况辨识的开路电压、欧姆内阻、极化电阻和极化电容的变化过程。3g、把不同温度汇总并和开路电压，欧姆内阻，极化电阻，极化电容的变化过程相结合，得到含有温度影响的参数在线辨识，再在不同温度下从SOC＝1开始，分别进行10次循环，得到参数在线辨识结果。在本实施例中，具体地，上述步骤4的具体过程如下：4a、建立EKF离散非线性系统方程：χk+1＝f+wkyk＝g+vk其中，χk+1为输入，yk为输出，wk和vk是系统的噪声，且服从正态分布，与f，g相互独立，f和g为非线性函数。4b、通过扩展卡尔曼滤波算法建立锂电池的状态方程与观测方程：Uk＝Uoc-ikR0-U1k-U2k其中，τd和τe为两个不同的时间常数，Uoc为开路电压，sk为k时刻的SOC的估计值，ik为k时刻的电流，Cn为电池的额定容量，ηt为充放电效率，Uk为k时刻的极化总电压估计值，U1k为k时刻R1上的极化电压估计值，U2k为k时刻R2上的极化电压估计值。4c、根据采集锂电池充放电过程中的端电压与电流数据，对离散化后的状态方程和观测方程进行EKF递推计算，并使用差分进化算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化，使噪声方差根据环境的变化而自动调整，使用不断变化的噪声方差代入到原扩展卡尔曼滤波算法中，完成循环工况下SOC的在线预估。使用差分进化算法对原扩展卡尔曼滤波算法中固定的过程噪声方差进行优化的方法如下：系统初始化：P0/0＝E{]-Et}把当前时刻电流值I，当前时刻的SOC值，当前时刻的端电压值U0以及温度作为输入列到扩展卡尔曼滤波算法中，输入电池额定容量Cn；输入采样时间T和总步长N。计算误差协方差矩阵：此时Qk-1为K-1时刻噪声方差，假设过程噪声不固定，随着滤波变化而不断变化，于是提出使用差分进化算法根据不同时刻的过程噪声求出其噪声方差，在Q0，Q1，....，Qk中选择最优解，假设F＝0.5，cr＝0.9，Np＝10，G＝100，以迭代次数为终止条件。种群初始化：xi，k＝lk+rand*，k＝1，2，....，d，i＝1，2，...，N式中提出，rand为0～1之间均匀分布的随机数；uk和lk为搜索的上下界，在扩展卡尔曼滤波中则以方差Qk和Q0分别为上下界带入到算法中。变异操作：假设变异机制为Xi＝xr1+F*式中，Xi为变异的个体；F为压缩比列因子，取值范围为0～1；xr1，xr2，xr3为三个父代。交叉操作：交叉操作保留较优良的变量，采用二项交叉方式。二项交叉方式的执行方式为：式中，r为每个变量生成的一个0～1之间均匀分布的随机数；cr为变量的交叉概率；rnd为1～d之间均匀分布的整数。如果r＜cr则接受目标个体对应的分量，否则保留当前个体对应的分量。选择操作：标准的差分进化算法采用贪婪选择的方式，操作如下：把最优解赋值给Qi，运用到下一次滤波中，贪婪选择方式使种群性能提高，逐步达到最优解。紧接着用系数矩阵A，系数矩阵B，系数矩阵C去计算状态预测：系数矩阵A，B，C就是上述状态观测方程中的3个矩阵。R0区分充放电拟合，此时R0已经是含有温度因素的参数值，也是关于SOC的函数，充电时R0三阶拟合，放电时R0六阶拟合。更新卡尔曼滤波增益：修正状态预测值：和协方差矩阵：Pk/k＝Pk/k-1此时得到含有温度参数的下一时刻的电流值、电压值，对SOC进行在线预估。在相同温度下，如图5所示，使用以上改进EKF算法后的SOC在线预估值与原EKF预估值对比可得，改进后的SOC在线预估值精度更高。以5℃为例，用以下优化噪声方差的算法得出有无加入温度校正的参数对于锂电池SOC误差的影响效果，如图6所示。当锂电池在5℃的温度下进行测试时，利用此优化后的算法得出不加温度校正的SOC误差曲线图和加入温度校正的SOC误差曲线图，由图6可知温度因子对于锂电池SOC影响是显而易见的。实施例仅为说明本发明的技术思想，不能以此限定本发明的保护范围，凡是按照本发明提出的技术思想，在技术方案基础上所做的任何改动，均落入本发明保护范围之内。
