标题title
基于星载多通道辐射成像仪的多层云云顶高度反演方法
摘要abst
本发明公开了基于星载多通道辐射成像仪的多层云云顶高度反演方法，基于多层云检测及云相态检测结果，将有云像元分类为单层冰云，单层水云和多层云；搜索目标多层云像元一定范围内的相邻单层云；根据目标多层云像元原始的云顶高度和云光学厚度反演结果，估计其实际云顶高度的最大值和最小值；分别搜索满足云顶高度规范的单层冰云和单层水云；计算所有筛选的单层冰云的平均云顶高度，得到目标多层云上层冰云的云顶高度反演结果；计算所有筛选的单层水云的平均云顶高度，得到目标多层云下层水云的云顶高度反演结果。本发明利用外推方法快速有效的反演多层云云顶高度，同时反演上层冰云和下层水云的云顶高度；对计算资源的要求低。
权利要求书clms
1.基于星载多通道辐射成像仪的多层云云顶高度反演方法，其特征在于，包括以下步骤：步骤1：基于多层云检测及云相态检测结果，将有云像元分类为单层冰云，单层水云和多层云；步骤2：搜索目标多层云像元预设范围内的相邻单层云；步骤3： 根据目标多层云像元原始的云顶高度和云光学厚度反演结果，估计其实际云顶高度的最大值和最小值；步骤4：分别搜索满足云顶高度规范的单层冰云和单层水云；步骤5：计算所有筛选的单层冰云的平均云顶高度，得到目标多层云上层冰云的云顶高度反演结果；计算所有筛选的单层水云的平均云顶高度，得到目标多层云下层水云的云顶高度反演结果。2.根据权利要求1所述的基于星载多通道辐射成像仪的多层云云顶高度反演方法，其特征在于：步骤1中所述多层云检测利用机器学习模型区分单层云与多层云；云相态检测结果利用FY-4A卫星云相态进行检测。3.根据权利要求1所述的基于星载多通道辐射成像仪的多层云云顶高度反演方法，其特征在于：步骤2所述的预设范围为以目标多层云像元为中心，半径为200 km的区域；相邻单层云指该区域内与任意多层云相邻的单层云像元。4.根据权利要求1所述的基于星载多通道辐射成像仪的多层云云顶高度反演方法，其特征在于：在步骤3中，利用多层云的云光学厚度COT与云顶高度原始反演结果CTHo，分别估计其上层冰云和下层水云实际云顶高度的最大值CTHmax和最小值CTHmin，计算方式如下：CTHmin = CTHo+α×CTHDmin；CTHmax =CTHo+β×CTHDmax；其中，CTHDmin和CTHDmax根据相邻单层云的CTHs和COTs确定，结果如下：α和β为权重系数，计算方法如下：λi为第i个单层云的光学厚度COTs，n为单层云数量，hi为第i个单层云的云顶高度CTHs。5.根据权利要求1所述的基于星载多通道辐射成像仪的多层云云顶高度反演方法，其特征在于：在步骤4中，筛选满足步骤3设定的冰云云顶高度范围的给定区域内的相邻单层冰云；筛选满足步骤3设定的水云云顶高度范围的给定区域内的相邻单层水云。6.根据权利要求1所述的基于星载多通道辐射成像仪的多层云云顶高度反演方法，其特征在于：在步骤5中，计算所有筛选的满足云顶高度规范的相邻单层冰云的平均云顶高度，得到目标多层云像元的上层冰云云顶高度；计算所有筛选的满足云顶高度规范的相邻单层水云的平均云顶高度，得到目标多层云像元的下层水云云顶高度。
说明书desc
技术领域本发明属于大气探测与遥感技术领域，尤其涉及基于星载多通道辐射成像仪的多层云云顶高度反演方法。背景技术云顶高度是主要的云物理参数，不仅是地球系统模式的重要参数，还被广泛用于气候变化研究和航天气象保障。气象卫星遥感是获取准确的全球云顶高度信息主要途径。目前绝大多数星载多通道辐射成像仪的云顶高度产品由于星载多通道光谱辐射成像仪的自身局限，难以探测云的垂直结构，因而在反演云顶高度时通常将假设所有云都是水平均匀的单层云，而实际大气中存在大量的多层云，这些多层云不可避免地会使云顶高度的反演产生误差。利用准确的雷达探测结果验证发现，目前的风云卫星云顶高度产品中单层云的反演结果较好，但对于多层云存在较大的误差。风云卫星的高质量的气象产品对于保障社会生产生活具有重要意义。针对多层云云顶高度反演的难题，已经有一些基于多光谱辐射模拟的方法，但这些方法需要对下层云信息进行先验假设，在实际应用中存在较大的不确定性，验证也发现这些多光谱方法对于上层冰云较厚的情况效果较差。另外，由于多层云模型相比传统的单层云模型需要进行更多的辐射传输计算，其计算效率相对较低，难以被用于星载多通道辐射成像仪的业务算法中。因而，设计针对多层云的云顶高度反演方法具有迫切的实际需求。气象卫星具有强大的气象海洋环境观测能力，其高质量的大气海洋产品有助于更好地进行天气预报、防灾减灾和气候变化研究。目前国际上绝大多数基于星载多通道辐射成像仪的云顶高度产品在多层云存在时都会有较大的反演偏差，为了进一步提升基于星载多通道辐射成像仪的云顶高度产品质量，急需新的算法解决多层云云顶高度反演问题。发明内容有鉴于此，本发明提出了基于星载多通道辐射成像仪的多层云云顶高度反演方法，包括以下步骤：步骤1：基于多层云检测及云相态检测结果，将有云像元分类为单层冰云，单层水云和多层云；步骤2：搜索目标多层云像元预设范围内的相邻单层云；步骤3： 根据目标多层云像元原始的云顶高度和云光学厚度反演结果，估计其实际云顶高度的最大值和最小值；步骤4：分别搜索满足云顶高度规范的单层冰云和单层水云；步骤5：计算所有筛选的单层冰云的平均云顶高度，得到目标多层云上层冰云的云顶高度反演结果；计算所有筛选的单层水云的平均云顶高度，得到目标多层云下层水云的云顶高度反演结果。进一步的，步骤1中所述多层云检测利用机器学习模型区分单层云与多层云；云相态检测结果利用FY-4A卫星云相态进行检测。进一步的，步骤2所述的预设范围为以目标多层云像元为中心，半径为200 km的区域；相邻单层云指该区域内与任意多层云相邻的单层云像元。进一步的，在步骤3中，利用多层云的云光学厚度COT与云顶高度原始反演结果CTHo，分别估计其上层冰云和下层水云实际云顶高度的最大值CTHmax和最小值CTHmin，计算方式如下：CTHmin = CTHo+α×CTHDmin；CTHmax =CTHo+β×CTHDmax；其中，CTHDmin和CTHDmax根据相邻单层云的CTHs和COTs确定，结果如下：α和β为权重系数，计算方法如下：λi为第i个单层云的光学厚度COTs，n为单层云数量，hi为第i个单层云的云顶高度CTHs。进一步的，在步骤4中，筛选满足步骤3设定的冰云云顶高度范围的给定区域内的相邻单层冰云；筛选满足步骤3设定的水云云顶高度范围的给定区域内的相邻单层水云。这里的单层云云顶高度为FY-4A卫星业务产品。进一步的，在步骤5中，计算所有筛选的满足云顶高度规范的相邻单层冰云的平均云顶高度，得到目标多层云像元的上层冰云云顶高度；计算所有筛选的满足云顶高度规范的相邻单层水云的平均云顶高度，得到目标多层云像元的下层水云云顶高度。本发明与现有技术相比，具有以下显著优点：利用外推方法快速有效的反演多层云云顶高度，传统的基于单层的反演算法只能提供最上层云的反演结果，且通常会存在较大误差，而本算法可以同时反演上层冰云和下层水云的云顶高度，对于航空气象保障具有重要意义；仅使用星载多通道辐射成像仪自身的云特性反演产品作为输入，且不需要进行辐射传输模拟，对计算资源的要求较低，且结果明显优于现有的基于单层假设的业务产品，可为国产风云气象卫星未来业务应用提供更加准确高效的多层云云顶高度反演结果。附图说明图1本发明的流程图；图2是本发明的实验结果。具体实施方式下面结合附图对本发明作进一步的说明，但不以任何方式对本发明加以限制，基于本发明教导所作的任何变换或替换，均属于本发明的保护范围。本发明充分考虑目前基于星载多通道辐射成像仪云顶高度产品的技术特征，以外推理论为基础，旨在开发快速、有效的多层云云顶高度反演算法，以提供更准确的多层云云顶高度反演结果，可用于提升国产风云气象卫星精细化保障水平。本发明提出了基于星载多通道辐射成像仪的多层云云顶高度反演方法，包括以下步骤：步骤1：基于多层云检测及云相态检测结果，将有云像元分类为单层冰云，单层水云和多层云。其中，多层云检测利用机器学习模型区分单层云与多层云；云相态检测结果利用FY-4A卫星云相态进行检测。步骤2：搜索目标多层云像元一定范围内的相邻单层云；一定范围为以目标多层云像元为中心，半径为200 km的区域；相邻单层云指该区域内与任意多层云相邻的单层云像元。步骤3： 根据目标多层云像元原始的云顶高度和云光学厚度反演结果，估计其实际云顶高度的最大值和最小值。其中，FY-4A卫星辐射计对光学厚度较小的多层云产生更大的云顶高度反演误差；利用多层云的云光学厚度与云顶高度原始反演结果，分别估计其上层冰云和下层水云实际云顶高度的最大值和最小值。具体的，在步骤3中，利用多层云的云光学厚度COT与云顶高度原始反演结果CTHo，分别估计其上层冰云和下层水云实际云顶高度的最大值CTHmax和最小值CTHmin，计算方式如下：CTHmin = CTHo+α×CTHDmin；CTHmax =CTHo+β×CTHDmax；其中，CTHDmin和CTHDmax根据相邻单层云的CTHs和COTs确定，结果如下：α和β为权重系数，计算方法如下：λi为第i个单层云的光学厚度COTs，n为单层云数量，hi为第i个单层云的云顶高度CTHs。步骤4：分别搜索满足云顶高度规范的单层冰云和单层水云。其中，筛选满足步骤3设定的冰云云顶高度范围的给定区域内的相邻单层冰云；筛选满足步骤3设定的水云云顶高度范围的给定区域内的相邻单层水云。这里的单层云云顶高度由FY-4A卫星业务产品计算得到。步骤5：计算所有筛选的单层冰云的平均云顶高度，得到目标多层云上层冰云的云顶高度反演结果；计算所有筛选的单层水云的平均云顶高度，得到目标多层云下层水云的云顶高度反演结果。其中，计算所有筛选的满足云顶高度规范的相邻单层冰云的平均云顶高度，得到目标多层云像元的上层冰云云顶高度；计算所有筛选的满足云顶高度规范的相邻单层水云的平均云顶高度，得到目标多层云像元的下层水云云顶高度。实施例本发明的具体实施方式如下：构建用于星载多通道辐射成像仪的多层云探测模型，将观测像元分为晴空、单层云和多层云三种类别。结合风云四号卫星多通道辐射成像仪AGRI现有的云顶相态产品，进一步将单层云分类为单层水云和单层冰云。针对反演目标，即一个多层云像元，以该像元为中心，200 km为半径建立搜索区域，寻找区域内的所有相邻单层云。本发明中相邻单层云的判定方式为，对于一个单层云像元，如果以它为中心的3×3框内有任意单层云，则这个单层云像元为相邻单层云。验证结果和理论分析表明，光学厚度越小的多层云越有可能产生更大的云顶高度反演误差，从而可以得到多层云云光学厚度与其云顶高度反演误差的关系，进而能估计出其实际云顶高度的范围，即最大值和最小值。本发明利用星载雷达CPR和CALIOP的联合探测结果定量分析星载多通道辐射成像仪云顶高度产品的误差，建立多层云条件下云光学厚度与云顶高度的公式。基于此公式，可以根据现有的多层云云顶高度和云光学厚度反演结果估计其实际的云顶高度范围，以最优化外推过程。具体的，在步骤3中，利用多层云的云光学厚度COT与云顶高度原始反演结果CTHo，分别估计其上层冰云和下层水云实际云顶高度的最大值CTHmax和最小值CTHmin，计算方式如下：CTHmin = CTHo+α×CTHDmin；CTHmax =CTHo+β×CTHDmax；其中，CTHDmin和CTHDmax根据相邻单层云的CTHs和COTs确定，结果如下：α和β为权重系数，计算方法如下：λi为第i个单层云的光学厚度COTs，n为单层云数量，hi为第i个单层云的云顶高度CTHs。多层云一般为上层冰云与下层水云在垂直空间重叠形成。实际观测和理论分析发现，形成于相似大气条件的云通常具有相似的宏观特性。因此，多层云的上层冰云与相邻的单层冰云往往具有相似的云顶高度，而其下层水云的云顶高度与周围的单层水云相似。本发明利用区域内的符合云顶高度规范的相邻单层冰云的云顶高度反演结果推断多层云上层冰云的云顶高度，同时利用符合云顶高度规范的相邻单层水云的云顶高度反演结果推断多层云下层水云的云顶高度。经过层层筛选，得到最接近多层云实际高度的单层云像元。计算所有筛选的符合云顶高度规范的相邻单层冰云云顶高度反演结果的平均值，作为多层云上层冰云的反演结果；计算所有筛选的符合云顶高度规范的相邻单层水云云顶高度反演结果的平均值，作为多层云下层水云的反演结果。经过区域平滑、筛除异常值等质量控制程序后，得到本发明最终的多层云云顶高度反演结果。附图2所示为本发明用于国产FY-4A卫星的结果，可以看到，目前FY-4A卫星的云顶高度产品与实际情况存在较大的偏差，而本发明的结果显著减小了反演误差，且能否同时提供上层冰云和下层水云的云顶高度反演。本发明充分考虑了目前星载多通道辐射成像仪业务云顶高度产品对多层云存在较大反演误差的技术难点，以外推技术为理论基础，充分考虑多层云系统的物理特征，首次提出利用邻近的单层冰云来反演多层云上层冰云的云顶高度，同时利用邻近的单层水云信息来反演多层云下层水云的云顶高度。通过合理的物理约束，最大限度减少了外推过程的不确定性，最终实现了星载多通道辐射成像仪对多层云云顶高度快速、有效的反演。相比传统的基于单层云的算法，本算法可以同时反演上层冰云高度和下层水云高度，且反演结果与CPR,CALIOP星载雷达探测结果更加一致。本发明针对星载多通道辐射成像仪反演多层云云顶高度的难题，提出了新颖且快速有效的反演算法，可为未来国产风云系列卫星的业务应用提供更加准确的云顶高度反演产品。本发明与现有技术相比，具有以下显著优点：利用外推方法快速有效的反演多层云云顶高度，传统的基于单层的反演算法只能提供最上层云的反演结果，且通常会存在较大误差，而本算法可以同时反演上层冰云和下层水云的云顶高度，对于航空气象保障具有重要意义；仅使用星载多通道辐射成像仪自身的云特性反演产品作为输入，且不需要进行辐射传输模拟，对计算资源的要求较低，且结果明显优于现有的基于单层假设的业务产品，可为国产风云气象卫星未来业务应用提供更加准确高效的多层云云顶高度反演结果。本文所使用的词语“优选的”意指用作实例、示例或例证。本文描述为“优选的”任意方面或设计不必被解释为比其他方面或设计更有利。相反，词语“优选的”的使用旨在以具体方式提出概念。如本申请中所使用的术语“或”旨在意指包含的“或”而非排除的“或”。即，除非另外指定或从上下文中清楚，“X使用A或B”意指自然包括排列的任意一个。即，如果X使用A；X使用B；或X使用A和B二者，则“X使用A或B”在前述任一示例中得到满足。而且，尽管已经相对于一个或实现方式示出并描述了本公开，但是本领域技术人员基于对本说明书和附图的阅读和理解将会想到等价变型和修改。本公开包括所有这样的修改和变型，并且仅由所附权利要求的范围限制。特别地关于由上述组件执行的各种功能，用于描述这样的组件的术语旨在对应于执行所述组件的指定功能的任意组件，即使在结构上与执行本文所示的本公开的示范性实现方式中的功能的公开结构不等同。此外，尽管本公开的特定特征已经相对于若干实现方式中的仅一个被公开，但是这种特征可以与如可以对给定或特定应用而言是期望和有利的其他实现方式的一个或其他特征组合。而且，就术语“包括”、“具有”、“含有”或其变形被用在具体实施方式或权利要求中而言，这样的术语旨在以与术语“包含”相似的方式包括。本发明实施例中的各功能单元可以集成在一个处理模块中，也可以是各个单元单独物理存在，也可以多个或多个以上单元集成在一个模块中。上述集成的模块既可以采用硬件的形式实现，也可以采用软件功能模块的形式实现。所述集成的模块如果以软件功能模块的形式实现并作为独立的产品销售或使用时，也可以存储在一个计算机可读取存储介质中。上述提到的存储介质可以是只读存储器，磁盘或光盘等。上述的各装置或系统，可以执行相应方法实施例中的存储方法。综上所述，上述实施例为本发明的一种实施方式，但本发明的实施方式并不受所述实施例的限制，其他的任何背离本发明的精神实质与原理下所做的改变、修饰、代替、组合、简化，均应为等效的置换方式，都包含在本发明的保护范围之内。
