标题title
基于区块链和IPFS技术的物联网智能终端信息安全交互方法
摘要abst
本发明公开了一种基于区块链和IPFS技术的物联网智能终端信息安全交互方法，主要解决现有技术中存在物联网终端信息传输安全、跨设备交互繁琐、设备信息存储压力大的问题。通过在物联网跨终端设备交互协同中引入区块链技术，让不同构造的智能终端成为平等、独立的区块链节点，主动的参与到信息的交互、维护中，解决异构设备信息交互对中心化服务器的高度依赖性。在去中心化应用中发起请求，触发智能合约后，满足条件区块链网络相关节点响应请求，发送所需信息。改善了集中式处理交互频繁导致低效高耗、数据传输风险大的问题。同时利用区块链技术可追溯特点，将节点之间交互操作信息上链保存，当出现恶意节点篡改共享数据时能够溯源追责。
权利要求书clms
1.一种基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述智能终端的信息交互系统包括：智能终端节点：收集原始数据或者根据物联网业务进行计算，产生计算结果数据；IPFS网络：用于存储智能终端设备采集到的大量原始数据，并生成存储地址hash值；区块链网络：由智能终端节点产生的数据区块构成的区块链网络，每个区块账本中记录有节点间的交互记录、智能终端设备产生的计算结果数据、原始采集数据的IPFS哈希地址；去中心化应用DApp：部署在智能终端节点的应用平台，作为终端设备之间交互的中介，触发智能合约条件，执行交互；所述信息安全交互方法包括如下步骤：步骤S1：智能终端收集一线原始数据，智能终端节点；进行初步数据分析、挖掘，获取到加工后的计算结果数据；步骤S2：依据部署在终端节点上的DApp将原始数据在IPFS网络上切片存储，IPFS返回数据存储的地址链接，将IPFS地址链接和结果数据一起存储在区块账本里；步骤S3：采用特定的共识算法将IPFS地址哈希、计算结果数据哈希通过每个节点的认可后上链，构成以太坊区块链；步骤S4：智能终端节点上传的数据后，以太坊区块链中的每个参与节点通过DApp中的交互页面进行操作；步骤S5：智能合约中定义终端设备交互的业务逻辑，使用web.js访问区块链，根据智能合约地址及应用程序二进制接口对区块链发起远程过程调用；步骤S6：区块链中和请求有关的节点响应请求，返回响应结果，并将请求-响应的过程记录在区块数据层的交互默克尔树中；步骤S7：交互平台获取区块数据后，依据其中包括的原始数据地址，在IPFS网络中找到存储有特定数据的节点，将原始数据和计算结果数据传输给发起请求的智能终端设备，完成物联网终端设备间的交互操作。2.根据权利要求1所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述智能终端节点产生的区块包括区块头、区块体；所述区块头包括前区块Hash、随机数Nonce、时间戳、区块序号、资源Merkle树根节点Hash、交互Merkle数根节点Hash；所述区块体包括原始数据存储地址hash值、计算结果数据hash值、请求类型、响应情况、区块链地址、设备ID。3.根据权利要求2所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述资源Merkle树根节点负责汇总设备产生的数据，所述交互Merkle树根节点负责汇总终端节点交互数据。4.根据权利要求3所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述原始数据存储地址hash值是由原始数据切片后分布存储的节点地址组合而成的哈希值。5.根据权利要求4所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述智能终端设备包括数据收集模块和中央处理模块；数据采集模块用于实现对原始数据的采集，在中央处理模块中产生计算结果数据，实现物联网设备边缘计算。6.根据权利要求5所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述数据采集模块的原始数据包括家用设备采集到的用水量、用电量、用气量、燃油量；计算结果数据则是根据物联网业务需求在边缘设备对原始数据分析、挖掘后所得到的信息。7.根据权利要求6所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述去中心化应用DApp包括参与者交互的web页面、与区块链交互的代码库及实现业务逻辑的智能合约代码，实现设备去区块链交互的中介。8.根据权利要求7所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述智能合约部署在区块链上，包括节点交互的业务逻辑，由节点触发后能自动执行的程序代码，节点间通过DApp页面发起操作触发智能合约，合约自动执行完成交互操作。9.根据权利要求8所述的基于区块链和IPFS技术的物联网智能终端信息安全交互方法，其特征在于，所述的节点交互的操作包括：终端节点之间数据共享、资源查看、权限配置。
说明书desc
技术领域本发明属于物联网区块链技术领域，具体地讲，是涉及一种基于区块链和IPFS技术的物联网智能终端信息安全交互方法。背景技术当前智慧城市建设中，物联网技术已经被广泛地使用，例如常见的公共交通、下水道井盖、城市街道照明、智能水表/电表/燃气表等设备，都是通过传感器连接和监控来收集和传输数据，而未来会有更多个人、公共设施设备的数据会被自动采集，并被广泛使用。物联网智慧城市建设涉及到跨层级、跨部门、跨设备的数据互联互通，将会面临设备多样、数据碎片化、数据海量、中心化系统交互频繁、信息交互安全性低等问题，因此传统物联网技术不利于智慧城市建设的延伸和施展，不能满足安全性、低能耗、高效率的要求。基于区块链技术的物联网业务平台，具备传统物联网实现实物信息化互联的特点，同时还结合了区块链不可篡改、可追溯、分布式的优势，能有效规避物联网智能终端设备数据传输过程中被篡改的风险。在存储问题上，星际文件系统技术整合已有的BitTorrent、DHT、Git、SFS等分布式存储网络优势，采用分布式点对点传输存储，优化数据存储，能有效缓解大数据上链存储或者在终端设备存储的压力。基于区块链和IPFS的物联网终端信息交互方法能减少跨设备交互信息过程中对中心化服务器的依赖，实现信息和价值的高效流通和痕迹式管理。发明内容本发明的目的在于提供一种基于区块链和IPFS技术的物联网智能终端信息安全交互方法，主要解决现有技术中存在物联网终端信息传输安全、跨设备交互繁琐、设备信息存储压力大的问题。为实现上述目的，本发明采用的技术方案如下：一种基于区块链和IPFS技术的物联网智能终端信息安全交互方法，所述智能终端的信息交互系统包括：智能终端节点：收集原始数据或者根据物联网业务进行计算，产生计算结果数据；IPFS网络：用于存储智能终端设备采集到的大量原始数据，并生成存储地址hash值；区块链网络：由智能终端节点产生的数据区块构成的区块链网络，每个区块账本中记录有节点间的交互记录、智能终端设备产生的计算结果数据、原始采集数据的IPFS哈希地址；去中心化应用DApp：部署在智能终端节点的应用平台，作为终端设备之间交互的中介，触发智能合约条件，执行交互；所述信息安全交互方法包括如下步骤：步骤S1：智能终端收集一线原始数据，智能终端节点进行初步数据分析、挖掘，获取到加工后的计算结果数据；步骤S2：依据部署在终端节点上的DApp将原始数据在IPFS网络上切片存储，IPFS返回数据存储的地址链接，将IPFS地址链接和结果数据一起存储在区块账本里；步骤S3：采用特定的共识算法将IPFS地址哈希、计算结果数据哈希通过每个节点的认可后上链，构成以太坊区块链；步骤S4：智能终端节点上传的数据后，以太坊区块链中的每个参与节点通过DApp中的交互页面进行操作；步骤S5：智能合约中定义终端设备交互的业务逻辑，使用web.js访问区块链，根据智能合约地址及应用程序二进制接口对区块链发起远程过程调用；步骤S6：区块链中和请求有关的节点响应请求，返回响应结果，并将请求-响应的过程记录在区块数据层的交互默克尔树中；步骤S7：交互平台获取区块数据后，依据其中包括的原始数据地址，在IPFS网络中找到存储有特定数据的节点，将原始数据和计算结果数据传输给发起请求的智能终端设备，完成物联网终端设备间的交互操作。进一步地，在本发明中，所述智能终端节点产生的区块包括区块头、区块体；所述区块头包括前区块Hash、随机数Nonce、时间戳、区块序号、资源Merkle树根节点Hash、交互Merkle数根节点Hash；所述区块体包括原始数据存储地址hash值、计算结果数据hash值、设备唯一物理地址、区块链地址、调用记录、权限认证、访问记录。进一步地，在本发明中，所述资源Merkle树根节点负责汇总设备产生的数据，所述交互Merkle树根节点负责汇总终端节点交互数据。进一步地，在本发明中，所述原始数据存储地址hash值是由原始数据切片后分布存储的节点地址组合而成的哈希值。进一步地，在本发明中，所述智能终端设备包括数据收集模块和中央处理模块；数据采集模块用于实现对原始数据的采集，在中央处理模块中产生计算结果数据，实现物联网设备边缘计算。进一步地，在本发明中，所述数据采集模块的原始数据包括家用设备采集到的用水量、用电量、用气量、燃油量；计算结果数据则是根据物联网业务需求在边缘设备对原始数据分析、挖掘后所得到的信息。进一步地，在本发明中，所述去中心化应用DApp包括参与者交互的web页面、与区块链交互的代码库及实现业务逻辑的智能合约代码，实现设备与区块链交互的中介。进一步地，在本发明中，所述智能合约部署在区块链上，包括节点交互的业务逻辑，由节点触发后能自动执行的程序代码，节点间通过DApp页面发起操作触发智能合约，合约自动执行完成交互操作。进一步地，在本发明中，所述的节点交互的操作包括：终端节点之间数据共享、资源查看、权限配置。与现有技术相比，本发明具有以下有益效果：本发明在物联网跨终端设备交互协同中引入区块链技术，让不同构造的智能终端成为平等、独立的区块链节点，主动的参与到信息的交互、维护中，解决异构设备信息交互对中心化服务器的高度依赖性。利用区块链透明、P2P、去中心化、安全的优势，让区块链每个物联网终端节点直接参与交互：在去中心化应用中发起请求，触发智能合约后，满足条件区块链网络相关节点响应请求，发送所需信息。改善了集中式处理交互频繁导致低效高耗、数据传输风险大的问题。同时利用区块链技术可追溯特点，将节点之间交互操作信息上链保存，当出现恶意节点篡改共享数据时能够溯源追责。本发明在终端设备存储问题上采用了IPFS技术，“熟数据”上链，“生数据”在IPFS网络节点中切片存储，分层级存储数据，实现数据的多方协同保护，同时减轻边缘计算设备的存储压力。在数据安全方面也表现优越，参与节点经过交互操作获取对方数据后，除了在传统的加密、解密操作外，可以通过链下智能终端具备的计算能力，验证计算结果数据是否和对应的原始数据匹配，进一步验证传输数据过程中是否被恶意篡改。本发明区块结构上，在数据层加入两个默克尔数根节点，一个默克尔树用于记录节点上传的基本数据：原始数据存储地址hash值、计算结果数据hash值；另一个默克尔树用于记录终端节点交互数据：访问、调用、认证的请求-响应信息。满足区块链技术实现数据信息交互的需求的同时，还实现操作过程的可追溯，利于监管部门对有些非法操作的定位，实现痕迹式管理。附图说明图1为本发明的总流程图。图2为本发明的总体方案框架设计图。图3为本发明的DApp架构设计图。图4为本发明的区块的数据结构示意图。图5为本发明的IPFS数据存储结构示意图。具体实施方式下面结合附图说明和实施例对本发明作进一步说明，本发明的方式包括但不仅限于以下实施例。实施例本发明公开了一种基于区块链和IPFS技术的物联网智能终端信息安全交互方法，如图1、2所示，该方法基于的信息交互系统包括：智能终端节点：收集原始数据或者根据物联网业务进行计算，产生计算结果数据；IPFS网络：用于存储智能终端设备采集到的大量原始数据，并生成存储地址hash值；区块链网络：由智能终端节点产生的数据区块构成的区块链网络，每个区块账本中记录有节点间的交互记录、智能终端设备产生的计算结果数据、原始采集数据的IPFS哈希地址；去中心化应用DApp：包括参与者交互的web页面、与区块链交互的代码库及实现业务逻辑的智能合约代码，实现设备去区块链交互的中介，部署在智能终端节点的应用平台，触发智能合约条件，执行交互。其中，所述智能合约部署在区块链上，包括节点交互的业务逻辑，由节点触发后能自动执行的程序代码，节点间通过DApp页面发起操作触发智能合约，合约自动执行完成交互操作。所述的节点交互的操作包括终端节点之间数据共享、资源查看、权限配置。在物联网交互系统中，每个物联网智能终端设备作为参与节点均部署有DApp，收集过程中屏蔽不同传感器设备底层硬件、通信协议、数据结构等异构性，统一为设备服务类型和记录数值。交互过程：智能终端设备采集到原始数据，利用中央处理模块对数据分析、挖掘后得到计算结果数据；原始数据在IPFS网络各节点切片存储，IPFS返回节点地址；将计算结果数据和原始数据hash地址通过DApp上传到区块链网络；在DApp上发起请求，请求类型分为数据共享、资源查看、权限认证，触发智能合约，满足合约条件后，区块链网络相关节点响应请求，发送所需信息至程序接口，由DApp以web界面形式返回给智能终端。具体来说，整个交互流程如下：步骤S1：智能终端收集一线原始数据，智能终端节点进行初步数据分析、挖掘，获取到加工后的计算结果数据；步骤S2：依据部署在终端节点上的DApp将原始数据在IPFS网络上切片存储，IPFS返回数据存储的地址链接，将IPFS地址链接和结果数据一起存储在区块账本里；步骤S3：采用特定的共识算法将IPFS地址哈希、计算结果数据哈希通过每个节点的认可后上链，构成以太坊区块链；步骤S4：智能终端节点上传的数据后，以太坊区块链中的每个参与节点通过DApp中的交互页面进行操作；步骤S5：智能合约中定义终端设备交互的业务逻辑，使用web.js访问区块链，根据智能合约地址及应用程序二进制接口对区块链发起远程过程调用；步骤S6：区块链中和请求有关的节点响应请求，返回响应结果，并将请求-响应的过程记录在区块数据层的交互默克尔树中；步骤S7：交互平台获取区块数据后，依据其中包括的原始数据地址，在IPFS网络中找到存储有特定数据的节点，将原始数据和计算结果数据传输给发起请求的智能终端设备，完成物联网终端设备间的交互操作。图3是根据本发明的DApp框架设计图，完整的DApp需要包含参与者交互的web页面、与区块链交互的代码库及实现业务逻辑的智能合约代码。编写智能合约的SOL文件后，通过Truffle的编译器，将SOL文件编译成JSON文件。Truffle将这些文件迁移部署到区块链上。Web3.js代码库加载Truffle编译生成的JSON文件，生成Javascrip版本的智能合约对象；Javascrip版本的智能合约对象被交互界面中的页面引用；另外Web3.js通过JSON PRC与区块链模拟器Ganache进行通信，实现区块链逻辑的读写访问。交互界面中使用钱包插件MetaMask，用于和区块链模拟器通信并调用Web3.js库中的API，最后浏览器通过包含有JS代码的页面脚本渲染后，将交互信息展示给终端设备。图4中每个区块中包含区块头：前区块Hash、随机数Nonce、时间戳Timestamp、区块序号、资源Merkle树根节点hash、交互Merkle数根节点hash。所述资源Merkle树根节点负责汇总设备产生的数据，交互Merkle树根节点负责汇总终端节点交互数据。Merkle树是一种二叉树结构，Merkle树叶子节点通常为数据的hash值。区块体：在本发明中，区块体数据包含有Merkle树叶子节点，其中资源Merkle树叶子节点为终端设备计算数据hash值和对应原始数据的IPFS地址链接hash值；交互Merkle数叶子节点Wie终端通过DApp与区块链交互产生的记录，具体包括：请求类型，响应情况、区块链地址、设备ID。图5是IPFS网络中数据存储的结构图，原数据在IPFS网络中被分为数个大小均等的数据片，分布存储在IPFS网络中的各个节点，按照MerkleDAG结构把文件数据片组织起来。通过节点地址可以查询到每个存储的数据片，获得每个节点地址即可将数据拼接起来获得完整原始数据。原始数据地址则由存储有数据片的节点的地址组合而成。在本实施例中，所述智能终端设备包括数据收集模块和中央处理模块；数据采集模块用于实现对原始数据的采集，在中央处理模块中产生计算结果数据，实现物联网设备边缘计算。所述数据采集模块的原始数据包括家用设备采集到的用水量、用电量、用气量、燃油量；计算结果数据则是根据物联网业务需求在边缘设备对原始数据分析、挖掘后所得到的信息。就本发明信息交互的安全而言，具有以下几个特征：基于区块链和IPFS技术的物联网智能终端设备的数据都是以Hash加密的形式进行传输。除了加密传输，还加入原始数据和计算结果数据公开验证机制，进一步来说，上链数据包括加密后的原始数据地址和计算结果数据，每当终端节点发起数据共享请求，请求被响应后，获得所需上链数据。可以利用自己边缘计算的能力，依据获取的原始数据进行计算，验证接受的计算数据是否和对应的原始数据匹配。每个传输后的数据都是可公开验证的，确保了数据传输过程的安全性。交互数据Hash添加到区块链中，是通过每个参与节点的共识认证，打破信息孤岛，让交互记录在可信、可溯源的环境下产生。原始数据在IPFS网络中被分成大小相同的若干数据块，按一定算法规则分布到IPFS网络各个节点上存储，增加了篡改数据的难度。通过上述设计，本发明解决了异构设备信息交互对中心化服务器的高度依赖性，改善了集中式处理交互频繁导致低效高耗、数据传输风险大的问题。同时利用区块链技术可追溯特点，将节点之间交互操作信息上链保存，当出现恶意节点篡改共享数据时能够溯源追责。因此，与现有技术相比，本发明具有实质性的特点和进步。上述实施例仅为本发明的优选实施方式之一，不应当用于限制本发明的保护范围，但凡在本发明的主体设计思想和精神上作出的毫无实质意义的改动或润色，其所解决的技术问题仍然与本发明一致的，均应当包含在本发明的保护范围之内。
