标题title
基于SegNet-RS网络的大障碍物轮廓分割方法
摘要abst
本发明公开了一种基于SegNet‑RS网络的大障碍物轮廓分割方法，该方法利用上下文信息和池化操作特性改进SegNet网络，然后修改卷积核的尺寸，最后采用PReLU函数代替ReLU函数，充分利用池化与上采样操作的特性，最大程度的还原了图像特征，提高语义分割在轮廓分割任务上的准确率。此外在网络的训练策略上也做了对应的优化设计。该方法实现了大障碍物检测的高完整轮廓分割，轮廓分割的平均准确率较SegNet网络提高了7％、平均交并比提升了9％、实时性与SegNet网络基本一致，具有优异的准确率和鲁棒性，特别适合于智能驾驶中的的大障碍物识别。
权利要求书clms
1.一种基于SegNet-RS网络的大障碍物轮廓分割方法，其特征在于，针对采集的含大障碍物轮廓的图像，该方法在原SegNet网络上进行如下～方面的改进：SegNet-RS网络基本结构框架的构建；将解码过程中的1/8尺寸特征图同编码过程中1/8尺寸特征图进行迭代融合得到新的1/8尺寸的特征图，将其进行反卷积4和上采样3操作获得解码过程中1/4尺寸特征图；然后将解码和编码过程中的1/4尺寸特征图进行迭代融合获得新的1/4尺寸特征图，将其通过反卷积3和上采样2操作获得解码过程中1/2尺寸特征图；最后将解码与编码过程中的1/2尺寸的特征图进行迭代融合获得新的1/2尺寸的特征图，将其通过反卷积2、上采样1、反卷积1与Softmax函数四个操作获得与原图尺寸一样的语义分割图。池化层的选择；SegNet-RS网络的池化层选用2×2池化核的平均池化操作，以将特征图的特征值乘以4后平均分布至新的被放大的特征矩阵中去；激活函数的选择；选择参数化修正线性单元PreLU作为激活函数；卷积操作的尺寸选择；采用2个含3×3的卷积核的卷积操作的复合卷积操作；卷积1和反卷积1采用通道数为64的卷积，其它卷积操作均采用128作为其卷积操作的通道数。2.根据权利要求1所述的基于SegNet-RS网络的大障碍物轮廓分割方法，其特征在于，所述PReLU函数的公式为：式中，ai为很小的固定值。3.根据权利要求1所述的基于SegNet-RS网络的大障碍物轮廓分割方法，其特征在于，在训练策略上，SegNet-RS网络使用全局对比度归一化算法消除图像对比度差异，并选用带重启的随机梯度算法优化学习率提高网络的收敛速度，最后选用多类标签分类损失函数和中值类平衡算法优化损失率。4.根据权利要求1所述的基于SegNet-RS网络的大障碍物轮廓分割方法，其特征在于，所述大障碍物轮廓分割方法应用于智能驾驶的实时图像处理工作中。5.一种基于SegNet-RS网络的大障碍物轮廓分割系统，其特征在于，包括：至少一个处理器；以及与所述处理器通信连接的至少一个存储器，其中：所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令能够执行如权利要求1至4任一项所述的基于SegNet-RS网络的大障碍物轮廓分割方法。6.一种非暂态计算机可读存储介质，其特征在于，所述非暂态计算机可读存储介质存储计算机指令，所述计算机指令使所述计算机执行如权利要求1至4任一项所述的基于SegNet-RS网络的大障碍物轮廓分割方法。
说明书desc
技术领域本发明属于自动驾驶的图像处理领域，更具体地说，涉及一种基于SegNet-RS网络的大障碍物轮廓分割方法。背景技术在针对自动驾驶图像处理的常规性语义分割网络技术中，FCN网络、U-Net网络、SegNet网络和DeepLabv3+网络等研究比较热门，FCN网络对大类别物体的区分明显，但是轮廓形状不太标准，同时复杂环境下的物体出现糅杂，细小物体无法识别，DeepLabv3+网络虽然在平均准确率和平均交并比性能比较优异，但是检测速度过慢不适合对实时性有较高要求的智能驾驶系统，SegNet网络和U-Net网络的性能相差不大，但是SegNet网络的准确率更好，而速度相差不大，因此SegNet网络的综合表现性能最好。现有技术中的SegNet网络是一种非常经典的语义分割网络，也是目前使用最多的分割网络之一，通过修改VGG-16网络而得到，在自动驾驶领域有十分广泛的应用。其结构如图1所示，左半部分是编码层，右半边部分是解码层，由中间的池化与上采样操作作为分割线的对称结构，共34层。左半边网络使用的是做了少许修改的VGG-16的前13层网络，用于提取图像特征并且保存池化索引；右边是反卷积与上采样的操作过程，利用反卷积操作使图像分类后复原图像特征，上采用操作还原至图像原始尺寸。最后的softmax函数则用来计算出不同分类的最大概率得到语义分割图。SegNet网络的卷积层将卷积、批标准化和激活函数结合成一个。卷积操作用于提取特征，卷积操作使用卷积核去计算卷积操作中输入特征图与卷积核相同大小的感受野，得出一个数值。当卷积核以滑动窗口形式遍历完整个图像时，将得到的数值重新组合成一个特征图的矩阵。然而，现有的SegNet网络虽然能识别各类物体，但是分割结果不够精细，轮廓出现不完整车辆的轮廓，以致出现了空洞，容易被误判成前方有其它障碍物或两辆车，故其无法直接用于自动驾驶图像中的大障碍物轮廓的实时分析。基于此，亟需设计一种图像处理速度快，准确率高且能识别大障碍物轮廓分割方法。发明内容技术问题基于上述的技术缺陷，本发明提供了一种基于SegNet-RS网络的大障碍物轮廓分割方法，该方法的实时性较好、准确率高，且能够有效识别和分割大障碍物的轮廓，特别适于智能驾驶系统中的图像处理。技术方案本发明提供了一种基于SegNet-RS网络的大障碍物轮廓分割方法，针对采集的含大障碍物轮廓的图像，该方法在原SegNet网络上进行如下～方面的改进：SegNet-RS网络基本结构框架的构建；将解码过程中的1/8尺寸特征图同编码过程中1/8尺寸特征图进行迭代融合得到新的1/8尺寸的特征图，将其进行反卷积4和上采样3操作获得解码过程中1/4尺寸特征图；然后将解码和编码过程中的1/4尺寸特征图进行迭代融合获得新的1/4尺寸特征图，将其通过反卷积3和上采样2操作获得解码过程中1/2尺寸特征图；最后将解码与编码过程中的1/2尺寸的特征图进行迭代融合获得新的1/2尺寸的特征图，将其通过反卷积2、上采样1、反卷积1与Softmax函数四个操作获得与原图尺寸一样的语义分割图；池化层的选择；SegNet-RS网络的池化层选用2×2池化核的平均池化操作，以将特征图的特征值乘以4后平均分布至新的被放大的特征矩阵中去；激活函数的选择；选择参数化修正线性单元PreLU作为激活函数；卷积操作的尺寸选择；采用2个含3×3的卷积核的卷积操作的复合卷积操作；卷积1和反卷积1采用通道数为64的卷积，其它卷积操作均采用128作为其卷积操作的通道数。优选地，所述PReLU函数的公式为：式中，ai为很小的固定值。优选地，在训练策略上，SegNet-RS网络使用全局对比度归一化算法消除图像对比度差异，并选用带重启的随机梯度算法优化学习率提高网络的收敛速度，最后选用多类标签分类损失函数和中值类平衡算法优化损失率。优选地，所述大障碍物轮廓分割方法应用于智能驾驶的实时图像处理工作中。在另外一个方面，本发明还公开了一种基于SegNet-RS网络的大障碍物轮廓分割系统，包括：至少一个处理器；以及与所述处理器通信连接的至少一个存储器，其中：所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令能够执行如上述任一项所述的基于SegNet-RS网络的大障碍物轮廓分割方法。在另外一个方面，本发明还公开了一种非暂态计算机可读存储介质，所述非暂态计算机可读存储介质存储计算机指令，所述计算机指令使所述计算机执行如上述任一项所述的基于SegNet-RS网络的大障碍物轮廓分割方法。有益效果相对于现有技术，基于SegNet-RS网络的大障碍物轮廓分割方法具备如下优势：利用上下文信息来改进SegNet网络，提高网络对上下文信息的提取能力，从而提高网络对轮廓的分割能力；修改卷积操作的尺寸，然后采用PReLU函数取代ReLU函数，提高网络鲁棒性。故本发明的SegNet-RS网络充分考虑输入像素间的上下文关系和平均池化操作的特性，实现了大障碍物检测的高完整轮廓分割，轮廓分割的平均准确率较SegNet网络提高了7％、平均交并比提升了9％、实时性与SegNet网络基本一致，具有优异的准确率和鲁棒性。此外，在训练方面，还利用全局对比度归一化算法、带重启的随机梯度下降算法、多类标签分类损失函数和类平衡算法和多类别优化网络训练过程，进一步的提高了网络的鲁棒性和收敛速度。附图说明图1是现有技术中的SegNet网络结构图。图2是本发明中SegNet-RS网络整体结构示意图。图3是本发明中SegNet-RS网络平均池化的计算过程示意图。图4是本发明中SegNet-RS网络卷积层结构示意图。图5是FCN网络、SegNet网络与SegNet-RS网络的实验结果对比图，其中为输入图像；为FCN网络实验结果；为SegNet网络实验结果；为SegNet-RS网络实验结果。具体实施方式下面结合附图和实施例，对本发明的具体实施方式作进一步详细描述。以下实施例用于说明本发明，但不用来限制本发明的范围。本发明最终选择以准确度和实时性都较高的SegNet网络平台进行障碍物检测算法的研究改进，而针对轮廓完整分割问题，发明人发现采用SegNet网络进行语义分割时需要考虑两个问题：1)卷积通道数尺寸。卷积通道数越多，特征图像所包含的特征量越多，语义分割的准确率相对也越高，轮廓所包含的像素信息也就越多。2)上下文信息。SegNet神经网络在池化和上采样操作中丢失了很多像素信息。故合理的利用这些信息对SegNet网络进行优化改进得到新的SegNet-RS网络，从而提高智能驾驶系统采集的图像中大障碍物轮廓分割的完整性。基于以上分析思路，本发明新设计了一种基于SegNet-RS网络的大障碍物轮廓分割方法，相对于SegNet网络，本发明SegNet-RS网络构建包括如下-方面的改进：基本结构框架：SegNet网络的原始模型采用最大池化操作，每次运算中舍去除最大权重外的其他权值，并保存最大权值的索引位置。尽管上采样操作会根据池化指数将特征信息还原到相对位置上，但是对其他位置采用了补0操作，导致很多细节信息丢失。为了最大程度的还原图像特征提高神经网络的分割准确率，SegNet-RS网络利用上下文信息对SegNet网络进行了改进。如图2所示，为了利用上下文信息来尽量保存提取像素信息且不增加运算量，SegNet-RS网络选择将池化1、池化2、池化3输出的特征图分别对应与上采样2、上采样3、上采样4输出的特征图进行迭代融合输出，以最终提高网络对目标的特征提取能力。如图2所示，通过解码过程，分别获得原图像1/2、1/4、1/8和1/16尺寸的特征图，称为解码过程中的特征图。编码过程中1/16尺寸的特征图经过上采样4获得解码过程中的1/8尺寸特征图。首先将解码过程中的1/8尺寸特征图同编码过程中1/8尺寸特征图进行迭代融合得到新的1/8尺寸的特征图，将其进行反卷积4和上采样3操作获得解码过程中1/4尺寸特征图。然后将解码和编码过程中的1/4尺寸特征图进行迭代融合获得新的1/4尺寸特征图，将其通过反卷积3和上采样2操作获得解码过程中1/2尺寸特征图。最后将解码与编码过程中的1/2尺寸的特征图进行迭代融合获得新的1/2尺寸的特征图，将其通过反卷积2、上采样1、反卷积1与Softmax函数四个操作获得与原图尺寸一样的语义分割图，如此就能尽量在池化和上采样操作中保存更多的像素信息来进行大障碍的轮廓分割。池化层的选择SegNet原始网络采用最大池化操作作为池化层，目的是为了更好的提取检测物的纹理特征，提高网络的分类准确性，但是容易造成像素间的糅杂。本发明提出的SegNet-RS网络主要用于保存大障碍物的轮廓信息，致力于更好的区分物体的轮廓，因此SegNet-RS网络的池化层选用2×2池化核的平均池化操作，每次池化操作后图像尺寸缩小一半。图3为平均池化的计算过程，即池化核在原图像像素矩阵上滑动，每次移动2位，将原图上与池化核大小一样的2×2矩阵里的四个值求平均传输至下一层。SegNet-RS网络的上采样操作和SegNet网络的上采样操作仍然将图像放大2倍。不同的是，SegNet原始网络利用池化索引来还原图像特征，而SegNet-RS网络是将特征图的特征值乘以4后平均分布至新的被放大的特征矩阵中去，尽可能的保留检测物的轮廓背景信息。PReLU激活函数的采用原始SegNet中Rule函数具有计算速度快、正向饱和等优势，因此SegNet网络在批标准化后使用Rule函数作为激活函数，但是当输入出现负数时，ReLU函数在正向传播阶段无法激活，还具有敏感和不敏感区域；反向传播阶段梯度会变为0。为解决这一问题，本发明选择参数化修正线性单元PReLU函数作为SegNet-RS网络卷积层的激活函数，PReLU函数是ReLU函数的变体，在参数固定时称为带泄漏的修正线性单元，其主要在ReLU函数的负数区域引入了泄漏值。在输入小于0的时候具有很小的斜率，可以避免Rule函数在反向传播阶段出现梯度为0的情况，同时保证正向传播阶段激活函数完全激活，其PReLU函数的公式为：式中，ai为很小的固定值。卷积操作的尺寸卷积操作的效果以及计算量的大小由卷积核尺寸和卷积通道数尺寸。卷积核的选取有以下几个规则：1)卷积核必须要有中心才能有半径，因此卷积核的大小应该是奇数，例如3×3，5×5或者7×7。2)为了保证卷积操作后不改变特征值，卷积核矩阵里的所有元素之和应该要等于1。通常卷积核的尺寸有3×3，5×5，7×7和9×9，但是复数个3×3卷积核的卷积操作与一个大卷积核的卷积操作可以达到同样的效果，同时能减少卷积操作的计算量。例如，一个7×7的卷积核和3个采用3×3的卷积核的卷积操作可以达到同样的效果。但是一个7×7的卷积核需要49个变量，一个3×3的卷积核的卷积操作仅需要27个变量。原始的SegNet网络采用一个7×7的卷积核的卷积操作，为了减少计算量提高网络运行速度，本发明的SegNet-RS网络选择采用2个含3×3的卷积核的卷积操作的复合卷积操作。卷积层的结构如图4所示。池化操作和上采样操作的计算方式与卷积操作类似，但是考虑到SegNet原始网络需要的缩小和放大功能，SegNet-RS网络池化操作的池化核选用2×2、上采样操的上采样核选用2×2。另外，通道数是卷积操作里除了卷积核以外的另一个重要参数。通道数一方面是指图像组成的颜色数，如RGB模式的图像其通道数是3，灰度图像的通道数是1。另一层含义是指卷积输出的空间维度，即代表这个卷积中有多少个卷积核。通道数的大小对卷积操作的效果也有很大影响，通道数越大所包含的特征量越多，网络效果更好，但是相应的权值参数也会增加。由于本发明研究的障碍物检测需要综合考虑网络的准确率和实时性，所以网络的卷积1和反卷积1采用通道数为64的卷积，其他卷积操作均采用128作为其卷积操作的通道数，即SegNet-RS网络的最大通道数设置为128。由图2可知，以上-方面的改进是相互联系支撑的，本发明的SegNet-RS网络利用上下文信息来改进SegNet网络，提高网络对上下文信息的提取能力，从而提高网络对轮廓的分割能力，还改卷积操作的尺寸，然后采用PReLU函数取代ReLU函数，提高网络鲁棒性。另外在训练策略上，本发明在SegNet-RS网络也做了适应性的改进，首先使用全局对比度归一化算法消除图像对比度差异，然后选用带重启的随机梯度算法优化学习率提高网络的收敛速度，最后选用多类标签分类损失函数和中值类平衡算法优化损失率，进一步提高了神经网络鲁棒性，最终实现车辆、房屋等多类障碍物的高完整的轮廓分割。最后，为了验证本发明所提出的SegNet-RS网络的性能，本发明中分别针对SegNet-RS网络、原始SegNet网络和传统的语义分割算法FCN网络三种网络进行轮廓分割对比试验，如图5所示，FCN网络对大类别物体的区分明显，但是轮廓形状不太标准，同时复杂环境下的物体出现糅杂，细小物体无法识别。SegNet网络能识别各类物体，但是分割结果不够精细，轮廓出现不完整车辆的轮廓且出现了空洞，容易被误判成前方有其它障碍物或两辆车；SegNet-RS网络完整识别出车辆的轮廓，且车辆轮廓形状更标准了。主要原因在于：原始SegNet网络模型使用最大池化操作，只记录了图像每个领域的最大特征值和相对位置，其他像素值丢弃，而上采样操作对这些丢失的数据进行了补0，导致很多特征信息的丢失，从而使得分割结果不够准确。利用上下文信息，最大程度还原由于池化和上采样操作丢失的特征信息，提高网路对细节信息的特征提取和特征选择能力。同时平均池化用于提取背景信息，使得检测物的几何轮廓更加完整。综合分析，SegNet-RS网络充分考虑输入像素间的上下文关系和平均池化操作的特性，实现了大障碍物检测的高完整轮廓分割，轮廓分割的平均准确率较SegNet网络提高了7％、平均交并比提升了9％、实时性与SegNet网络基本一致，具有优异的准确率和鲁棒性。值得一提的是，上述本发明基于SegNet-RS网络的图像分割方法方法可以转换为软件程序指令，既可以使用包括处理器和存储器的软件分析系统来运行实现，或者也可以通过非暂态计算机可读存储介质中存储的计算机指令来实现。最后，本发明的方法仅为较佳的实施方案，并非用于限定本发明的保护范围。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
