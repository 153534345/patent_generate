标题title
基于电梯图片数据的多标签多属性分类模型建立方法
摘要abst
本发明涉及一种基于电梯图片数据的多标签多属性分类模型建立方法，包括以下步骤：a、采集电梯轿厢内的图片并上传至云端；b、对所述图片进行预处理，分割出对象；c、利用分割出的对象训练所述分类模型的主干网络；d、基于所述主干网络完成所述分类模型的分支网络的训练。本发明可以降低标注的工作量，并能在保证模型准确率的情况下降低参数量。
权利要求书clms
1.一种基于电梯图片数据的多标签多属性分类模型建立方法，包括以下步骤：a、采集电梯轿厢内的图片并上传至云端；b、对所述图片进行预处理，分割出对象；c、利用分割出的对象训练所述分类模型的主干网络；d、基于所述主干网络完成所述分类模型的分支网络的训练。2.根据权利要求1所述的方法，其特征在于，在所述步骤中，当电梯开始运行、开关门时采集所述图片。3.根据权利要求1所述的方法，其特征在于，在所述步骤中，采用YOLACT的实例分隔方法将对象从所述图片中单独分割出来。4.根据权利要求1所述的方法，其特征在于，所述步骤中分割出的对象为人体。5.根据权利要求1所述的方法，其特征在于，在所述步骤中，所述分类模型采用嫁接网络，所用标签为多个二分类，将训练数据集分为多个子数据集，每个子数据集上具有对应的标签，且具有一个独有的取值为0,1，……T的索引；所述分类模型的主干网络采用Inception V3模型，每个子数据集都用Inception V3作为共有的主干网络，同时每个子数据集对应不同的全连接层；每一轮训练时，随机选取一个子数据集的图片送入Inception V3模型中提取特征，然后将提取的特征送入该数据集对应的全连接层预测分类,训练的损失函数Loss为：其中，t表示所述子数据集的索引；T为所有属性类别；εt∈{0,1}表示输入数据是否属于该属性数据的子集；Lt表示属性t的损失；w0表示Inception V3主干网络的参数，wt表示子数据集对应全连接层的参数，Gw0,wt表示特定属性的网络预测结果，yt表示子数据集的标签；训练完成后，只保留Inception主干网络的训练结果，将全连接层的训练结果舍弃。6.根据权利要求5所述的方法，其特征在于，Inception V3网络结构包含11个模块，每个模块都包括卷积层、激活层。7.根据权利要求1所述的方法，其特征在于，在所述步骤中，在训练所述分支网络时，固定主干网络的前八个模块，所有的子数据集分支网络共用前八个模块以提取低层共有的特征，所述前八个模块的输出作为每个分支网络的输入。8.根据权利要求7所述的方法，其特征在于，每个子数据集对应的分支网络采用神经网络结构搜索寻找最优网络结构来训练；所述分支网络的神经网络结构搜索的搜索空间包括每一层神经网络的结构从3*3卷积核、5*5卷积核、平均池化层、全局池化层和激活层中做选择以及对这些不同层之间的连接关系做选择。9.根据权利要求8所述的方法，其特征在于，采用长短期记忆网络作为控制网络来构建和训练神经网络的采样器和训练器，训练长短期记忆网络控制器的参数和共用参数的子模型，且每一轮交替训练；根据在测试集的准确率，从搜索空间中寻找到最佳的网络结构，并根据最佳的网络结构构建和训练自身的分支网络，最终构建完成分支网络的结构。
说明书desc
技术领域本发明涉及一种基于电梯图片数据的多标签多属性分类模型建立方法。背景技术深度卷积神经网络已成为大规模图像分类的主流结构，卷积神经网络在单一标签的图片分类中已经证明了可以达到很好的效果，对于多标签的分类，往往会采取迁移学习的方式，即对所有的标签用共同的模型提取特征，然后基于这些共同提取的特征，每个标签训练自身的分支结构，整体网络结构类似树状。但是树状网络结构是为静态数据集设计的，静态数据即数据集标签数量不会发生改变，如果数据集标签数量增加，不仅需要为新的标签采集数据，还需要对原来的数据集全部重新标注，以判断原来的图片是否属于新的标签。如果不断有新的标签加入，标注的工作量将是巨大的，从而耗费大量的时间成本。同时，样本的不平衡也是机器学习中的一个重要问题，模型倾向于将样本识别为数量更多的那一类，导致预测效果变差。因为这些问题的存在，使得在标签动态变化的数据上应用迁移学习成本巨大。发明内容本发明的目的在于提供一种基于电梯图片数据的多标签多属性分类模型建立方法。为实现上述发明目的，本发明提供一种基于电梯图片数据的多标签多属性分类模型建立方法，包括以下步骤：a、采集电梯轿厢内的图片并上传至云端；b、对所述图片进行预处理，分割出对象；c、利用分割出的对象训练所述分类模型的主干网络；d、基于所述主干网络完成所述分类模型的分支网络的训练。根据本发明的一个方面，在所述步骤中，当电梯开始运行、开关门时采集所述图片。根据本发明的一个方面，在所述步骤中，采用YOLACT的实例分隔方法将对象从所述图片中单独分割出来。根据本发明的一个方面，所述步骤中分割出的对象为人体。根据本发明的一个方面，在所述步骤中，所述分类模型采用嫁接网络，所用标签为多个二分类，将训练数据集分为多个子数据集，每个子数据集上具有对应的标签，且具有一个独有的取值为0,1，……T的索引；所述分类模型的主干网络采用Inception V3模型，每个子数据集都用InceptionV3作为共有的主干网络，同时每个子数据集对应不同的全连接层；每一轮训练时，随机选取一个子数据集的图片送入Inception V3模型中提取特征，然后将提取的特征送入该数据集对应的全连接层预测分类,训练的损失函数Loss为：其中，t表示所述子数据集的索引；T为所有属性类别；εt∈{0,1}表示输入数据是否属于该属性数据的子集；Lt表示属性t的损失；w0表示Inception V3主干网络的参数，wt表示子数据集对应全连接层的参数，Gw0,wt表示特定属性的网络预测结果，yt表示子数据集的标签；训练完成后，只保留Inception主干网络的训练结果，将全连接层的训练结果舍弃。根据本发明的一个方面，Inception V3网络结构包含11个模块，每个模块都包括卷积层、激活层。根据本发明的一个方面，在所述步骤中，在训练所述分支网络时，固定主干网络的前八个模块，所有的子数据集分支网络共用前八个模块以提取低层共有的特征，所述前八个模块的输出作为每个分支网络的输入。根据本发明的一个方面，每个子数据集对应的分支网络采用神经结构搜索寻找最优网络结构来训练；所述分支网络的神经网络结构搜索的搜索空间包括每一层神经网络的结构从3*3卷积核、5*5卷积核、平均池化层、全局池化层和激活层中做选择以及对这些不同层之间的连接关系做选择。根据本发明的一个方面，采用长短期记忆网络作为控制网络来构建和训练神经网络的采样器和训练器，训练长短期记忆网络控制器的参数和共用参数的子模型，且每一轮交替训练；根据在测试集的准确率，从搜索空间中寻找到最佳的网络结构，并根据最佳的网络结构构建和训练自身的分支网络，最终构建完成分支网络的结构。根据本发明的一个方案，通过使用嫁接网络这种网络结构来检测电梯图片中的任务属性，从而可以降低标注的工作量，以解决标签数量动态变化时数据量标注成本太高的问题。根据本发明的一个方案，采用高效的神经结构搜索寻找最优网络结构来训练分支结构，ENAS在保证模型准确率的情况下，能够大大降低参数量，从而减少训练成本。附图说明图1示意性表示本发明的一种实施方式的用于人体属性检测的嫁接网络的网络结构图；图2示意性表示本发明的一种实施方式的采用ENAS搜索出的最优分支结构图；图3示意性表示本发明的一种实施方式的嫁接网络推理图片的流程图；图4示意性表示本发明的一种实施方式的嫁接网络在各个分支的ROC曲线图。具体实施方式为了更清楚地说明本发明实施方式或现有技术中的技术方案，下面将对实施方式中所需要使用的附图作简单地介绍。显而易见地，下面描述中的附图仅仅是本发明的一些实施方式，对于本领域普通技术人员而言，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。下面结合附图和具体实施方式对本发明作详细地描述，实施方式不能在此一一赘述，但本发明的实施方式并不因此限定于以下实施方式。本发明基于电梯图片数据的多标签多属性分类模型建立方法，首先，采集电梯轿厢内的图片并上传至云端，对图片进行预处理，分割出对象，利用分割出的对象训练分类模型的主干网络，基于主干网络完成分类模型的分支网络的训练。本发明中，当电梯开始运行、开关门时采集摄像头拍摄的图片。本发明的分类模型主要用于识别电梯乘客属性，因此，图片中除了人体以外的其他部分是计算机视觉模型不需要用到的，而且若保留这些无用部分有可能给模型带来干扰。因此，本发明设置了预处理步骤，从而在检测人体属性的模型中采用YOLACT的实例分隔方法将人体单独分割出来。由此，预处理的步骤也可以理解为特征提取，即将电梯中的人体提取出来。这样，预处理所分割出的人体即可用来训练分类模型来检测电梯中乘客的相关属性，比如年龄段、性别、穿衣风格等。参见图1，根据上述可知，本发明的分类模型主要用于人体属性检测，其采用嫁接网络，针对于电梯人体属性而言，电梯人体属性的标签是多个二分类，包括是否是小孩、是否是老年人、男女性别和是否是运动风格的穿衣。如此，将训练数据集分为多个子数据集，每个子数据集上只具有自身对应的标签。同时，本发明赋予每个子数据集一个独有的索引，索引取值为0,1，……T。分类模型的主干网络采用Inception V3模型，每个子数据集都用Inception V3作为共有的主干网络，同时每个子数据集对应不同的全连接层。每一轮训练时，将随机选取一个子数据集的图片送入Inception V3模型中提取特征，然后将提取的特征送入该数据集对应的全连接层预测分类。训练的损失函数Loss如下：其中，t表示所述子数据集的索引；T为所有属性类别；εt∈{0,1}表示输入数据是否属于该属性数据的子集；Lt表示属性t的损失；w0表示Inception V3主干网络的参数，wt表示子数据集对应全连接层的参数，Gw0,wt表示特定属性的网络预测结果，yt表示子数据集的标签。训练完成后，只保留Inception主干网络的训练结果，将全连接层的训练结果舍弃。随后即可基于主干网络，训练每个子数据集的分支网络。Inception V3网络结构包含11个模块，每个模块都包括若干卷积层、激活层等。在训练每个子数据集的分支网络时，固定主干网络的前八个模块，即所有的子数据集分支网络共用前八个模块以提取低层共有的一些特征，例如形状、纹理等，这前八个模块的输出作为每个分支网络的输入。每个子数据集对应的分支网络采用高效的神经结构搜索寻找最优网络结构来训练。本发明中，首先定义ENAS的搜索空间，具体的，分支网络的神经网络结构搜索的搜索空间包括每一层神经网络的结构从3*3卷积核、5*5卷积核、平均池化层、全局池化层和激活层等中做选择以及对这些不同层之间的连接关系做选择。本发明采用长短期记忆网络作为控制网络来构建和训练神经网络的采样器和训练器。如此，需要训练两部分参数，即训练长短期记忆网络控制器的参数和共用参数的子模型，每一轮交替训练这两组参数。最终根据在测试集的准确率，从搜索空间中寻找到最佳的网络结构，如图2所示。最后，在寻找到最佳的网络结构后，根据最佳的网络结构构建和训练自身的分支网络，最终构建完成分支网络的结构。当嫁接网络训练完成后，先将图片中的人像分割出来，然后再送入嫁接网络中判断图片类型，具体可参见图3示出的图片在嫁接网络中推断过程。如图4所示的嫁接网络在测试集上测试的结果可知，嫁接网络对于每个分类的预测都达到了较高的准确率。综上所述，本发明通过使用嫁接网络这种网络结构可以解决标签数量动态变化时数据量标注成本太高的问题，同时采用了神经结构搜索，从而在保证准确性的前提下降低了参数量，以减少训练成本。以上所述仅为本发明的一个实施方式而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包括在本发明的保护范围之内。
