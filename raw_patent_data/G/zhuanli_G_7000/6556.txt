标题title
无人机影像铁路钢轨顶面中心线自动匹配方法
摘要abst
本发明属于铁路既有线测绘技术领域，涉及一种无人机影像铁路钢轨顶面中心线自动匹配方法，具体包括影像直线段提取、基于角度距离的影像直线段粗筛选以及基于物方拟合距离的轨顶边缘直线段精匹配等步骤，采用像物方测度结合的方法得到影像钢轨顶面中线的匹配关系，可以达到较高的匹配精度，可以满足后续基于无人机影像的既有线测绘精度要求,实现了与既有线的自动匹配，方便快捷。
权利要求书clms
1.一种无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，包括以下步骤：S1、获取无人机影像及钢轨顶面中心线的三维坐标初始值；S2、从无人机影像中提取直线段，并对提取的直线段进行筛选；S3、按照预设的段长度值对获取的钢轨顶面中心线进行分段，并将拆分的多段直线段反投影到无人机影像上，基于影像欧式距离进行筛选，得到一组候选影像线；利用反投影线与影像提取线的角度约束，对候选影像线进行再次筛选；S4、将候选影像线投影到物方高程面上，得到一组物方投影直线段，利用物方投影直线段端点进行最小二乘直线拟合，并以两次拟合残差中误差的平均值作为目标函数，将直线段两端点高程值作为待优化变量；求取目标函数的极值，得到各钢轨影像直线段的精确匹配关系；S5、根据各钢轨影像直线段的精确匹配关系，计算钢轨影像顶面中线，将计算得出钢轨影像顶面中线与获取的钢轨顶面中心线，进行同名对应，完成匹配。2.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，在S2中，从无人机影像中提取直线段，并对提取的直线段进行筛选，包括以下步骤：S201、采用LSD算法从影像上提取直线段；S202、按照预设阈值，对提取的直线段进行筛选，将大于预设阈值的直线段。3.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，在S3中，所述按照预设的段长度值对获取的钢轨顶面中心线进行分段时，包括对获取的钢轨顶面中心线的直线部分进行分段时，段长度值为10~15m，对钢轨顶面中心线的曲线部分进行分段时，段长度值为5~10m。4.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，在S3中，所述基于影像欧式距离进行筛选，得到一组候选影像线时，包括以下步骤：对于某段钢轨线R，利用POS辅助平差后的影像外方位元素和相机内参数将其反投影到无人机影像上，得到反投影直线段r；以反投影直线段r为中心线，搜索周围从影像上提取的直线段，将所有与其相交的影像线作为候选直线段，形成一组候选影像线。5.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，在S3中，所述利用反投影线与影像提取线的角度约束，对候选影像线进行再次筛选，包括以下步骤：设定角度阈值，计算影像提取线与反投影线的夹角，将夹角小于或等于角度阈值的影像线保留，超过角度阈值的影像线删除。6.根据权利要求5所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，所述角度阈值设置为10°~15°。7.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，在S4中，利用物方投影直线段端点进行最小二乘直线拟合；包括以下步骤：根据投影直线段端点的高程值和高程精度，设定搜索范围；搜索所有投影线端点；选取两端点采用RANSAC最小二乘法进行直线拟合，得到拟合残差中误差；利用剩余点再次进行拟合，得到拟合残差中误差,计算两残差中误差的平均值作为目标函数。8.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，所述RANSAC最小二乘法中，残差阈值设为0.02m，内点率阈值为0.4。9.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，所述求取目标函数的极值时，采用Powell算法迭代求取目标函数的极值。10.根据权利要求1所述的无人机影像铁路钢轨顶面中心线自动匹配方法，其特征在于，在S5中，根据各钢轨影像直线段的精确匹配关系，计算钢轨影像顶面中线，包括以下步骤：将影像两直线段距离相近的两端点作为对应点，计算两端点的中点作为钢轨顶面中线的端点；将计算得到的中线的端点两两相连，得到钢轨顶面中线。
说明书desc
技术领域本发明涉及无人机测绘技术领域，尤其涉及无人机影像铁路钢轨顶面中心线自动匹配方法。背景技术既有铁路测绘的核心工作之一是获取轨道中线的高精度三维坐标。随着计算机视觉与摄影测量技术的发展，基于多视图几何原理的非接触式对地定位方法已在基础测绘、工程勘察设计等领域得到了广泛的应用。与此同时，得益于软硬件设备的飞速发展，无人机已成为一种不可或缺的测绘地理信息数据采集平台，具有成本低、机动灵活、影像地面分辨率高的优势。通过无人机倾斜摄影方式，可以有效增大影像基高比和交会角，提升多视图几何在高程方向上的定位精度，从而为解决传统航摄立体采集既有线高程精度不足的问题提供了新思路。但是，实现基于无人机影像的既有线高精度测绘工作的前提是获得影像钢轨线的同名映射关系，即实现无人机影像钢轨顶面中线的匹配。传统方法需要人工判读影像钢轨同名直线段，工作强度大，工作效率低。为了进一步提高生产效率，需要研究影像钢轨线的自动匹配问题。然而由于钢轨为一类弱纹理低矮线状地物，其在影像上的特征不显著，如何实现影像钢轨线的自动匹配仍是一个难点。发明内容因此，本发明的目的在于提供一种无人机影像铁路钢轨顶面中心线自动匹配方法，采用像物方测度结合的方法得到影像钢轨顶面中线的匹配关系，可以达到较高的匹配精度，可以满足后续基于无人机影像的既有线测绘精度要求。为了实现上述目的，本发明的一种无人机影像铁路钢轨顶面中心线自动匹配方法，包括以下步骤：S1、获取无人机影像及钢轨顶面中心线的三维坐标初始值；S2、从无人机影像中提取直线段，并对提取的直线段进行筛选；S3、按照预设的段长度值对获取的钢轨顶面中心线进行分段，并将拆分的多段直线段反投影到无人机影像上，基于影像欧式距离进行筛选，得到一组候选影像线；利用反投影线与影像提取线的角度约束，对候选影像线进行再次筛选；S4、将候选影像线投影到物方高程面上，得到一组物方投影直线段，利用物方投影直线段端点进行最小二乘直线拟合，并以两次拟合残差中误差的平均值作为目标函数，将直线段两端点高程值作为待优化变量；求取目标函数的极值，得到各钢轨影像直线段的精确匹配关系。S5、根据各钢轨影像直线段的精确匹配关系，计算钢轨影像顶面中线，将计算得出钢轨影像顶面中线与获取的钢轨顶面中心线，进行同名对应，完成匹配。进一步优选的，在S2中，从无人机影像中提取直线段，并对提取的直线段进行筛选，包括以下步骤：S201、采用LSD算法从影像上提取直线段；S202、按照预设阈值，对提取的直线段进行筛选，将大于预设阈值的直线段。进一步优选的，在S3中，所述按照预设的段长度值对获取的钢轨顶面中心线进行分段时，包括对获取的钢轨顶面中心线的直线部分进行分段时，段长度值为10～15m，对钢轨顶面中心线的曲线部分进行分段时，段长度值为5～10m。进一步优选的，在S3中，所述基于影像欧式距离进行筛选，得到一组候选影像线时，包括以下步骤：对于某段钢轨线R，利用POS辅助平差后的影像外方位元素和相机内参数将其反投影到无人机影像上，得到反投影直线段r；以反投影直线段r为中心线，搜索周围从影像上提取的直线段，将所有与其相交的影像线作为候选直线段，形成一组候选影像线。进一步优选的，在S3中，所述利用反投影线与影像提取线的角度约束，对候选影像线进行再次筛选，包括以下步骤：设定角度阈值，计算影像提取线与反投影线的夹角，将夹角小于或等于角度阈值的影像线保留，超过角度阈值的影像线删除。进一步优选的，所述角度阈值设置为10°～15°。进一步优选的，在S4中，利用物方投影直线段端点进行最小二乘直线拟合；包括以下步骤：根据投影直线段端点的高程值和高程精度，设定搜索范围；搜索所有投影线端点；选取两端点采用RANSAC最小二乘法进行直线拟合，得到拟合残差中误差Res1；利用剩余点再次进行拟合，得到拟合残差中误差Res2，计算两残差中误差的平均值RES＝/2作为目标函数。进一步优选的，所述RANSAC最小二乘法中，残差阈值设为0.02m，内点率阈值为0.4。进一步优选的，所述求取目标函数的极值时，采用Powell算法迭代求取目标函数的极值。进一步优选的，在S5中，根据各钢轨影像直线段的精确匹配关系，计算钢轨影像顶面中线，包括以下步骤：将影像两直线段距离相近的两端点作为对应点，计算两端点的中点作为钢轨顶面中线的端点；将计算得到的中线的端点两两相连，得到钢轨顶面中线。本申请公开的无人机影像铁路钢轨顶面中心线自动匹配方法，相比于现有技术至少具有以下优点：1、本发明提供的无人机影像铁路钢轨顶面中心线自动匹配方法，利用无人机影像多视图几何关系，首先从影像上提取直线段，然后采用像物方测度结合的方法得到影像钢轨顶面中线的匹配关系，可以达到较高的匹配精度，可以满足后续基于无人机影像的既有线测绘精度要求；实现了影像钢轨顶面中心线的自动匹配，无需人工判读，有效提高了作业效率，具有较强的实用和推广价值。2、本发明提供的无人机影像铁路钢轨顶面中心线自动匹配方法，可以应用于影像线特征匹配优化处理。相较于单独基于像方的匹配方法，本发明充分利用了物方几何约束条件，并将数学局部优化算法应用于图像匹配，对于某些仅能提取钢轨单侧边缘的情况也能成功匹配，极大地提高了匹配正确率和鲁棒性，在实际应用过程中优势明显。附图说明图1为本发明的流程框图。图2为基于像方距离的影像线粗筛选示意图。图3为基于像方角度的影像线粗筛选示意图。图4为影像线投影示意图。图5为影像钢轨顶面中心线计算示意图。具体实施方式以下通过附图和具体实施方式对本发明作进一步的详细说明。如图1所示，本发明的一种无人机影像铁路钢轨顶面中心线自动匹配方法，包括以下步骤：S1、获取无人机影像及钢轨顶面中心线的三维坐标初始值；其中，获取需要的数据，包括获取无人机影像，还包括准确的相机内参数和影像外方位元素；以及钢轨顶面中线三维坐标初始值；S2、从无人机影像中提取直线段，并对提取的直线段进行筛选；在S2中，其中，从无人机影像中提取直线段，并对提取的直线段进行筛选，包括以下步骤：S201、采用LSD算法从影像上提取直线段；S202、按照预设阈值，对提取的直线段进行筛选，将大于预设阈值的直线段。LSD是一种直线检测分割算法，主要是通过求导得到灰度的梯度，因为灰度梯度的方向的垂直方向就是线条的方向，将有相同方向的向量用矩形圈起来，再将矩形精细化即可得到影像直线段。该算法能在线性的时间内得出亚像素级精度的检测结果，其在任何数字图像上都无需参数调节。S3、按照预设的段长度值对获取的钢轨顶面中心线进行分段，并将拆分的多段直线段反投影到无人机影像上，基于影像欧式距离进行筛选，得到一组候选影像线；利用反投影线与影像提取线的角度约束，对候选影像线进行再次筛选；S4、将候选影像线投影到物方高程面上，得到一组物方投影直线段，利用物方投影直线段端点进行最小二乘直线拟合，并以两次拟合残差中误差的平均值作为目标函数，将直线段两端点高程值作为待优化变量；求取目标函数的极值，得到各钢轨影像直线段的精确匹配关系。S5、根据各钢轨影像直线段的精确匹配关系，计算钢轨影像顶面中线，将计算得出钢轨影像顶面中线与获取的钢轨顶面中心线，进行同名对应，完成匹配。在S3中，所述按照预设的段长度值对获取的钢轨顶面中心线进行分段时，包括对获取的钢轨顶面中心线的直线部分进行分段时，段长度值为10～15m，对钢轨顶面中心线的曲线部分进行分段时，段长度值为5～10m。进一步，所述基于影像欧式距离进行筛选，得到一组候选影像线时，包括以下步骤：对于某段钢轨线R，利用POS辅助平差后的影像外方位元素和相机内参数将其反投影到无人机影像上，得到反投影直线段r；以反投影直线段r为中心线，搜索周围从影像上提取的直线段，将所有与其相交的影像线作为候选直线段，形成一组候选影像线。如图2所示，R为某钢轨直线段，r为其在影像上的反投影直线段，以r为中心线搜索周围从影像上提取的直线段，将所有与其相交的影像线作为候选直线段，记为图中黑线为轨道线的反投影线，灰色线和白色线为影像上提取得到的直线段，最终保留虚线范围的影像线。本步骤可以排除掉绝大部分的非同名直线段，将影像线的匹配范围大幅度缩小。在进一步，所述利用反投影线与影像提取线的角度约束，对候选影像线进行再次筛选，包括以下步骤：设定角度阈值，计算影像提取线与反投影线的夹角，将夹角小于或等于角度阈值的影像线保留，超过角度阈值的影像线删除。所述角度阈值设置为10°～15°。如图3所示，黑线为初始轨道直线段的反投影线，白线为距离筛选后保留的错误影像线。由于白线与轨道线方向差异较大，因此通过此步骤可被剔除。进一步优选的，在S4中，利用物方投影直线段端点进行最小二乘直线拟合；包括以下步骤：S401、根据投影直线段端点的高程值和高程精度，设定搜索范围；搜索所有投影线端点；若某钢轨直线段R的两端点坐标初始值分别为T和T，候选影像线为将候选影像线两端点投影到和高程面Z1和Z2上，则可得到一组物方投影线，记为Li。若钢轨直线段端点的精确高程值分别为ZR1和ZR2，此高程组合记为PR。如图4所示，黑线和灰线分别为钢轨两侧边缘，当两端点投影高程值误差较大时，投影线Li在投影面上呈现为散乱直线段，如PH和PL；而当两端点投影高程接近真实高程值时，投影线趋近于形成两簇线)，此时可以得到准确的影像钢轨线同名映射关系。S402、选取两端点采用RANSAC最小二乘法进行直线拟合，得到拟合残差中误差Res1；利用剩余点再次进行拟合，得到拟合残差中误差Res2，计算两残差中误差的平均值RES＝/2作为目标函数。所述RANSAC最小二乘法中，残差阈值设为0.02m，内点率阈值为0.4。若初始钢轨线两端点高程值分别为Z1和Z2，高程精度为σ，则两端点高程值的搜索范围分别为和。S403、所述求取目标函数的极值时，采用Powell算法迭代求取目标函数的极值。需要说明的是，候选影像线中包含少量非轨顶边缘线，此步骤可对其进行剔除。进一步优选的，在S5中，根据各钢轨影像直线段的精确匹配关系，计算钢轨影像顶面中线，包括以下步骤：将影像两直线段距离相近的两端点作为对应点，计算两端点的中点作为钢轨顶面中线的端点；将计算得到的中线的端点两两相连，得到钢轨顶面中线。步骤5，钢轨边缘直线段的同名映射关系，得到钢轨顶面中心线及其匹配关系。具体步骤如下：步骤501、计算影像钢轨顶面左右两侧直线段的中线。以影像两直线段距离较近的两端点作为对应点，计算对应点的中点作为钢轨顶面中线的端点，将计算得到的两段点相连即得到钢轨顶面中线。如图5所示，AB和CD分别为钢轨两侧提取得到的边缘直线段，E为A和C的中线，F为B和D的中点，则该钢轨的顶面中线直线段为EF。步骤502、根据步骤4得到的钢轨边缘直线段的同名对应关系，得到钢轨顶面中心线的同名对应关系。显然，上述实施例仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引伸出的显而易见的变化或变动仍处于本发明创造的保护范围之中。
