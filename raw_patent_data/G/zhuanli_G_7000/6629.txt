标题title
基于图像处理的纱线牵伸质量监测方法
摘要abst
本发明公开了一种基于图像处理的纱线牵伸质量监测方法。方法包括：获取牵伸后纱线的灰度图像作为原图，将原图作为待处理图像进行纤维分析，根据纤维分析过程中的自适应腐蚀图像、膨胀图像、置信度二值图和原图进行融合得到新的灰度图；将纤维分析得到的新的灰度图作为待处理图像进行纤维分析，不断迭代，直至纤维分析得到的新的灰度图稳定，将稳定的新的灰度图作为纤维分布图；根据纤维分布图获得纹理影像图，对纱线质量进行判断。相较现有技术，本发明通过使用基于混合模型的边缘自适应腐蚀方法根据边缘分布场来迭代优化纤维边缘特征，使得交织折叠的纤维边缘能够被清晰地区分出来，使得对纱线牵伸质量监测的结果更准确。
权利要求书clms
1.一种基于图像处理的纱线牵伸质量监测方法，该方法包括：获取牵伸后纱线的灰度图像作为原图，将原图作为待处理图像进行纤维分析；所述纤维分析包括：分别获取待处理图像的去噪图像和每个像素点的分布向量；选取窗口对去噪图像进行滑窗，对窗口内所有像素进行坐标中心化，将坐标中心化后的像素点投影到分布向量的法向量上，得到像素点在法向量方向上的位置；根据窗口内所有像素点灰度值与其在法向量方向上位置的映射关系，得到该映射关系下的极大值点；根据窗口内像素灰度值构建混合高斯模型，混合高斯模型中单高斯模型数量与极大值点个数相同；根据均值最接近零的单高斯模型自变量取零的输出确定窗口中心位置的新像素值；利用滑窗遍历去噪图像得到所有像素点的新像素值构成自适应腐蚀图像；获取原图的膨胀图像，根据自适应腐蚀图像和膨胀图像得到置信度二值图；利用置信度二值图将原图、自适应腐蚀图像与膨胀图像进行融合得到新的灰度图；将纤维分析得到的新的灰度图作为待处理图像进行纤维分析，不断迭代，直至纤维分析得到的新的灰度图稳定，将稳定的新的灰度图作为纤维分布图；根据纤维分布图获得纹理影像图，对纱线质量进行判断。2.根据权利要求1所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述坐标中心化具体为：获取滑窗窗口中心的像素坐标，使窗口内所有像素点坐标与中心坐标做差，实现坐标中心化。3.根据权利要求1所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述根据纤维分布图获得纹理影像图，对纱线质量进行判断具体为：根据纤维分布图获得纹理影像图，计算纹理影像图中所有像素点位置的纤维伸直程度；设定程度阈值，根据纤维伸直程度与程度阈值的关系将纹理影像图二值化，得到二值化图像，计算二值化图像的连通域面积；设定面积阈值，若连通域面积大于面积阈值，则判定纱线存在质量问题；否则，纱线质量合格。4.根据权利要求1所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述窗口中心位置的新像素值的获取方法为：获取均值为正且最接近零的单高斯模型、均值为负且最接近零的单高斯模型，若仅获取到一个单高斯模型，则根据所获取的单高斯模型自变量取零的输出确定窗口中心位置的像素灰度值；若获取到两个单高斯模型，则对于均值最接近零的两个单高斯模型，使用第一融合权重对方差较大的单高斯模型自变量取零的输出值进行修正，得到第一修正值；使用第二融合权重对方差较小的单高斯模型自变量取零的输出值进行修正，得到第二修正值；根据第一修正值与第二修正值得到窗口中心位置的新像素值。5.根据权利要求4所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述第一融合权重为：其中，为第一融合权重，为较小方差，为方差较小的单高斯模型的均值，为较大方差，为方差较大的单高斯模型的均值。6.根据权利要求4所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述第二融合权重为：其中，为第二融合权重，为第一融合权重。7.根据权利要求1所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述根据自适应腐蚀图像和膨胀图像得到置信度二值图的方法为：根据自适应腐蚀图像和膨胀图像的每个像素位置的灰度值差异得到置信度分布图，设定置信度阈值，将置信度分布图中大于置信度阈值的像素点灰度值设置为第一设定值，其余像素点灰度值为第二设定值，得到置信度二值图。8.根据权利要求1所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述利用置信度二值图将原图、自适应腐蚀图像与膨胀图像进行融合得到新的灰度图的方法为：其中，为新的灰度图，为原图的像素点灰度矩阵，为置信度二值图的像素点灰度矩阵，为膨胀图像的像素点灰度矩阵，为自适应腐蚀图像的像素点灰度矩阵，表示与的哈达玛积，表示与的哈达玛积。9.根据权利要求3所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述纤维伸直程度由纹理影像图中的像素点灰度值确定。10.根据权利要求3所述的一种基于图像处理的纱线牵伸质量监测方法，其特征在于，所述根据纤维伸直程度将纹理影像图二值化，得到二值化图像的方法为：设定程度阈值，将纹理影像图中的纤维伸直程度大于程度阈值的像素点灰度值设置为第一设定值，其余像素点灰度值为第二设定值，得到二值化图像。
说明书desc
技术领域本发明涉及数字图像处理、识别以及纺织领域，具体涉及一种基于图像处理的纱线牵伸质量监测方法。背景技术在纺纱过程中，需要通过对棉条进行并和、牵伸、混合、加捻等工艺流程来制取纱线，不仅使纱线具有一定的捻度和强度，还能够让纱线上的纤维尽可能伸直保持平行；最终的纱线的质量与这些流程相关。在这个过程中，设备的缺陷与损坏、设备控制参数不合理都会影响纱线的质量好坏，所以，在一些纺纱和织造过程中需要严格地把控纱线在各个工艺环节中的质量，及时发现生产过程中的问题，例如设备问题和控制参数问题等。其中，在纱线生产工艺中，牵伸后的纤维伸长程度就是评估和把控纱线质量的重要环节。发明内容为了解决上述技术问题，本发明的目的在于提供一种基于图像处理的纱线牵伸质量监测方法，获取纱线上纤维的伸直程度，检测伸展程度低的有质量问题纱线，及时进行生产参数的调整或者设备的检修。所采用的技术方案具体如下：本发明提供了一种基于图像处理的纱线牵伸质量监测方法。获取牵伸后纱线的灰度图像作为原图，将原图作为待处理图像进行纤维分析；所述纤维分析包括：分别获取待处理图像的去噪图像和每个像素点的分布向量；选取窗口对去噪图像进行滑窗，对窗口内所有像素进行坐标中心化，将坐标中心化后的像素点投影到分布向量的法向量上，得到像素点在法向量方向上的位置；根据窗口内所有像素点灰度值与其在法向量方向上位置的映射关系，得到该映射关系下的极大值点；根据窗口内像素灰度值构建混合高斯模型，混合高斯模型中单高斯模型数量与极大值点个数相同；根据均值最接近零的单高斯模型自变量取零的输出确定窗口中心位置的新像素值；利用滑窗遍历去噪图像得到所有像素点的新像素值构成自适应腐蚀图像；获取原图的膨胀图像，根据自适应腐蚀图像和膨胀图像得到置信度二值图；利用置信度二值图将原图、自适应腐蚀图像与膨胀图像进行融合得到新的灰度图；将纤维分析得到的新的灰度图作为待处理图像进行纤维分析，不断迭代，直至纤维分析得到的新的灰度图稳定，将稳定的新的灰度图作为纤维分布图；根据纤维分布图获得纹理影像图，对纱线质量进行判断。优选的，所述坐标中心化具体为：获取滑窗窗口中心的像素坐标，使窗口内所有像素点坐标与中心坐标做差，实现坐标中心化。优选的，所述根据纤维分布图获得纹理影像图，对纱线质量进行判断具体为：根据纤维分布图获得纹理影像图，计算纹理影像图中所有像素点位置的纤维伸直程度；设定程度阈值，根据纤维伸直程度与程度阈值的关系将纹理影像图二值化，得到二值化图像，计算二值化图像的连通域面积；设定面积阈值，若连通域面积大于面积阈值，则判定纱线存在质量问题；否则，纱线质量合格。优选的，所述窗口中心位置的新像素值的获取方法为：获取均值为正且最接近零的单高斯模型、均值为负且最接近零的单高斯模型，若仅获取到一个单高斯模型，则根据所获取的单高斯模型自变量取零的输出确定窗口中心位置的像素灰度值；若获取到两个单高斯模型，则对于均值最接近零的两个单高斯模型，使用第一融合权重对方差较大的单高斯模型自变量取零的输出值进行修正，得到第一修正值；使用第二融合权重对方差较小的单高斯模型自变量取零的输出值进行修正，得到第二修正值；根据第一修正值与第二修正值得到窗口中心位置的新像素值。优选的，所述第一融合权重为：其中，为第一融合权重，为较小方差，为方差较小的单高斯模型的均值，为较大方差，为方差较大的单高斯模型的均值。优选的，所述第二融合权重为：其中，为第二融合权重，为第一融合权重。优选的，所述根据自适应腐蚀图像和膨胀图像得到置信度二值图的方法为：根据自适应腐蚀图像和膨胀图像的每个像素位置的灰度值差异得到置信度分布图，设定置信度阈值，将置信度分布图中大于置信度阈值的像素点灰度值设置为第一设定值，其余像素点灰度值为第二设定值，得到置信度二值图。优选的，所述利用置信度二值图将原图、自适应腐蚀图像与膨胀图像进行融合得到新的灰度图的方法为：其中，为新的灰度图，为原图的像素点灰度矩阵，为置信度二值图的像素点灰度矩阵，为膨胀图像的像素点灰度矩阵，为自适应腐蚀图像的像素点灰度矩阵，表示与的哈达玛积，表示与的哈达玛积。优选的，所述纤维伸直程度由纹理影像图中的像素点灰度值确定。优选的，所述根据纤维伸直程度将纹理影像图二值化，得到二值化图像的方法为：设定程度阈值，将纹理影像图中的纤维伸直程度大于程度阈值的像素点灰度值设置为第一设定值，其余像素点灰度值为第二设定值，得到二值化图像。本发明实施例至少具有如下有益效果：本发明通过采集纱线的图像数据，提取纱线上纤维的分布信息，获取纱线的纤维伸直分布图，进而准确地评估纱线的质量。在这个过程中，本发明通过使用基于混合模型的边缘自适应腐蚀方法和膨胀算法根据边缘分布场来迭代优化纤维边缘特征，使得交织折叠的纤维边缘能够被清晰的区分出来，使得后续的纤维伸直分布图更准确。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明的一个实施例所提供的一种基于图像处理的纱线牵伸质量监测方法流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种基于图像处理的纱线牵伸质量监测方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构、或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。本发明的目的在于提供一种基于图像处理的纱线牵伸质量监测方法，获取纱线上纤维的伸直程度，检测伸展程度低的有质量问题纱线，及时进行生产参数的调整或者设备的检修。本发明针对的具体场景为：在牵伸后的纱线上方安装高清高帧率的相机，相机俯视纱线，并且利用平行的白光竖直向下照射纱线，相机随机采集一张图像，采集的每帧图像都是灰度图。图像中包含一根纱线，纱线上有多根纤维组成，期望的是每根纤维互相平行、完全伸直，但是实际生产中这是无法做到的，只能让不同纤维之间尽量伸直且平行，但是由于设备或控制的原因，往往纱线上有些纤维聚成一团，纤维没有拉直，这样会影响纱线的质量，本发明就是需要检测出纱线上有没有存在纤维聚成一团、没有拉长伸直而和其他纤维不平行的纤维存在。下面结合附图具体的说明本发明所提供的一种基于图像处理的纱线牵伸质量监测方法的具体方案。具体实施例：请参阅图1，其示出了本发明一个实施例提供的一种基于图像处理的纱线牵伸质量监测方法的步骤流程图，该方法包括以下步骤：获取牵伸后纱线的灰度图像作为原图，将原图作为待处理图像进行纤维分析；所述纤维分析包括：分别获取待处理图像的去噪图像和每个像素点的分布向量；选取窗口对去噪图像进行滑窗，对窗口内所有像素进行坐标中心化，将坐标中心化后的像素点投影到分布向量的法向量上，得到像素点在法向量方向上的位置；根据窗口内所有像素点灰度值与其在法向量方向上位置的映射关系，得到该映射关系下的极大值点；根据窗口内像素灰度值构建混合高斯模型，混合高斯模型中单高斯模型数量与极大值点个数相同；根据均值最接近零的单高斯模型自变量取零的输出确定窗口中心位置的新像素值；利用滑窗遍历去噪图像得到所有像素点的新像素值构成自适应腐蚀图像；获取原图的膨胀图像，根据自适应腐蚀图像和膨胀图像得到置信度二值图；利用置信度二值图将原图、自适应腐蚀图像与膨胀图像进行融合得到新的灰度图；将纤维分析得到的新的灰度图作为待处理图像进行纤维分析，不断迭代，直至纤维分析得到的新的灰度图稳定，将稳定的新的灰度图作为纤维分布图；根据纤维分布图获得纹理影像图，对纱线质量进行判断。具体实施步骤如下：首先，获取牵伸后纱线的灰度图像作为原图，将原图作为待处理图像。具体地，在牵伸后的纱线上方安装高清高帧率的相机，相机俯视纱线，并且利用平行的白光竖直向下照射纱线，相机随机采集一张图像，采集的每帧图像都是灰度图像，这样的灰度图像称为原图，将原图作为待处理图像。至此，获取到待处理图像。其次，对待处理图像进行纤维分析，得到新的灰度图。分别获取待处理图像的去噪图像和每个像素点的分布向量；选取窗口对去噪图像进行滑窗，对窗口内所有像素进行坐标中心化，将坐标中心化后的像素点投影到分布向量的法向量上，得到像素点在法向量方向上的位置；根据窗口内所有像素点灰度值与其在法向量方向上位置的映射关系，得到该映射关系下的极大值点；根据窗口内像素灰度值构建混合高斯模型，混合高斯模型中单高斯模型数量与极大值点个数相同；根据均值最接近零的单高斯模型自变量取零的输出确定窗口中心位置的新像素值；利用滑窗遍历去噪图像得到所有像素点的新像素值构成自适应腐蚀图像；获取原图的膨胀图像，根据自适应腐蚀图像和膨胀图像得到置信度二值图；利用置信度二值图将原图、自适应腐蚀图像与膨胀图像进行融合得到新的灰度图。具体地，对待处理图像进行纤维分析，得到新的灰度图的具体方法为：获取待处理图像每个像素点的分布向量。首先，对待处理图像利用反锐化掩膜算法进行高频特征的增强。所述的高频特征包括图像上的边缘特征，也包括噪声特征。进行图像增强的目的是：由于纱线上纤维交错遮盖，纤维结构细小，而且纱线在生产中是运动的，因此纤维结构可能存在模糊，细节不清晰，无法直接获取到纱线上准确的纤维信息，因此，本发明需要利用反锐化掩膜方法对待处理图像的细节和高频特征进行增强，突出纤维的边缘信息。其次，利用Canny算子提取特征增强后的图像上的边缘，获得边缘二值图，这些边缘表示的就是纤维的分布。但是由于原图的噪声也被增强，再加上纱线上纤维交错遮盖，噪声本来就多，获得的边缘二值图上的边缘可能是断断续续或者粘连覆盖在一起的，在图像上纤维之间不易区分，无法区分一整条纤维在纱线上的伸展情况，导致无法获取纤维的伸直程度，因此，需要后续处理：获取边缘二值图上任意一个灰度值为1的像素，获取该像素位置的海森矩阵，然后计算该海森矩阵的两个特征值和两个对应的特征向量，本发明保留特征值最小的特征向量。该特征向量是一个二维单位向量，该向量表示边缘在该位置的分布方向，即边缘上在该位置的像素坐标是大致沿着这个特征向量方向分布的，本发明将该特征向量称为该位置的分布向量；最后，获取边缘二值图上所有灰度值为1的像素的分布向量，利用二维空间的线性插值算法根据已知位置的分布向量差值出未知位置的分布向量。至此，获得了所有位置的分布向量，用于表示每个位置边缘的走向。将所有位置的分布常量视为一个边缘分布场。获取待处理图像的去噪图像，选取窗口对去噪图像进行滑窗，对窗口内所有像素进行坐标中心化，将坐标中心化后的像素点投影到窗口中心像素点分布向量的法向量上，得到像素点在法向量方向上的位置。具体地，首先，对待处理图像利用3×3的高斯模糊核进行模糊处理，目的是去除原图中大量的噪声。其次，对模糊后的原图进行滑窗，即每个位置对应一个矩形窗口的中心，优选的，窗口宽度为5，高度为11，窗口沿宽度方向的轴线与每个位置的分布向量平行。再次，获取处于窗口内的所有像素，对这些像素的像素点坐标中心化，具体方法为：获取窗口中心的像素坐标，窗口内所有像素坐标与中心坐标做差。中心化之后，使用窗口内所有像素点的坐标依次与窗口中心像素对应的分布向量的法向量求内积。该步骤目的是将窗口内所有像素点的坐标降为一维，即将所有像素点投影到分布向量的法向量上。由于分布向量表示窗口中心位置的边缘走向，那么分布向量的法向量表示的是垂直边缘走向，每个投影后的像素点视为法向量所在的数轴上的一个位置x，对应一个灰度值y，所有的x和y用于反映在边缘垂直方向上灰度的分布信息。根据窗口内所有像素点灰度值与其在法向量方向上位置的映射关系，得到该映射关系下的极大值点。具体地，以所有位置的灰度值为数据集，利用最小二乘法拟合一条5次多项式曲线，用于大致描述位置x与灰度值y的映射关系；获取该曲线极大值点的个数，该数值就是K。根据窗口内像素灰度值构建混合高斯模型，混合高斯模型中单高斯模型数量与极大值点个数相同；根据均值最接近零的单高斯模型自变量取零的输出确定窗口中心位置的新像素值；利用滑窗遍历去噪图像得到所有像素点的新像素值构成自适应腐蚀图像。具体地，获取自适应腐蚀图像的过程为：首先，本发明建立一个混合高斯模型，即高斯混合模型G由K个单高斯模型叠加而成，特别地，所述K值即为曲线的极大值个数。本发明利用多项式曲线大致评估混合高斯模型由多少个单高斯模型叠加而成。其中，表示高斯混合模型中第k个单高斯模型的均值、方差和像素点投影在窗口中心像素点法向量所在的数轴上的位置x。以所有位置的灰度值为数据集，以窗口内像素位置x为自变量，以像素灰度值为因变量，利用EM算法求解出混合高斯模型中所有的参数。本发明认为混合高斯模型中，每个单高斯模型代表一个可能的边缘，均值代表边缘的位置，方差代表边缘的粗细。其次，根据均值最接近零的单高斯模型自变量取零的输出确定窗口中心位置的新像素值。所述窗口中心位置的新像素值的获取方法为：获取均值为正且最接近零的单高斯模型、均值为负且最接近零的单高斯模型，若仅获取到一个单高斯模型，则根据所获取的单高斯模型自变量取零的输出确定窗口中心位置的像素灰度值；若获取到两个单高斯模型，则对于均值最接近零的两个单高斯模型，使用第一融合权重对方差较大的单高斯模型自变量取零的输出值进行修正，得到第一修正值；使用第二融合权重对方差较小的单高斯模型自变量取零的输出值进行修正，得到第二修正值；根据第一修正值与第二修正值得到窗口中心位置的新像素值。具体地，假设和为两个最趋近于0的参数，一个符号为正，另一个符号为负。如果和只存在其中一个，假设存在的是参数，那么构造单高斯模型，则本发明认为窗口中心位置的新像素就是处于对应的边缘上，于是将窗口中心位置的新像素的灰度值设置为，其中，为单高斯模型在自变量x为0时的输出值。如果同时存在和，那么本发明认为窗口中心位置的像素处于对应的边缘上，又处于对应的边缘上；但是本发明期望窗口中心位置的像素处于一个确定的边缘上，简单的做法是获取与中绝对值最小的参数，假设绝对值最小的参数为，那么将窗口中心位置的新像素值设置为，其中，为单高斯模型在自变量为0时的输出值。这种简单的情况在与的绝对值均较大的时候是可以采用的，但是如果与的绝对值较小，即两个单高斯模型对应的边缘几乎重合的时候，是无法简单的利用上述方法确定窗口中心的像素属于哪个边缘的，即无法确定窗口中心的新像素值。本发明提出一种新方法，用来确定窗口中心位置的新像素值：假设，那么让窗口中心位置像素的新像素值设置为。其中，为单高斯模型在自变量为0时的输出值，为单高斯模型在自变量为0时的输出值；即窗口中心位置像素的新像素值是与的加权融合。其中，为第一融合权重，为第二融合权重，为第一修正值，为第二修正值，具体地，、分别为：其中，表示两个高斯模型的均值绝对值的差异，越大，说明窗口中心位置的像素距离高斯模型的均值就越近，那么窗口中心位置像素的新像素值就更加关注；越小，表示窗口中心位置的像素距离高斯模型的均值就越近，那么窗口中心位置像素的新像素值就更加关注。越大，说明两个单高斯模型代表的边缘距离越远，此时不太关注的大小；越小，说明两个高斯模型代表的边缘距离越近，此时越需要依赖来决定窗口中心位置像素的新像素值更趋近哪个单高斯模型对应的边缘。给定，越小，即比越大，表示两个单高斯模型对应的边缘粗细差别越大，那么就越小，那么窗口中心位置像素的新像素值就更加关注，即更加关注细的边缘，这有利于增强细的边缘的结构。需要说明的是，如果不存在，就将和分别视为一个负无穷和正无穷的参数，即高斯模型是在无穷远处的方差无限的单高斯模型，此时，说明该方法具有普遍适用性。至此，得到滑窗中心像素的新像素值。最后，利用滑窗遍历去噪图像得到所有像素点的新像素值构成自适应腐蚀图像。至此，得到自适应腐蚀图像。综上所述，利用该方法得到的窗口中心位置的新像素值能够满足以下条件：其一，距离窗口中心位置近的单高斯模型更能决定该像素的灰度值；其二，如果两个单高斯模型方差不一致，也就是两个边缘粗细不一致时，窗口中心位置的像素的灰度值优先取决于细的边缘对应的单高斯模型的取值。这样的有益效果是能够估计处于窗口中心位置的像素属于哪个边缘，同时将窗口中心位置的像素的灰度值重置后使得重叠在一起的边缘区分开来，避免淹没细小的边缘结构。本发明利用上述方法，原图上每个像素点对应一个窗口，利用窗口内的像素的灰度值的分布特征为窗口中心的像素重现分配一个灰度值，重新分配的灰度值比初始的灰度值小，相当于对窗口中心的像素进行了腐蚀滤波操作。因此，本发明将为窗口中心的像素重新分配一个灰度值的这一过程称为基于混合模型的边缘自适应腐蚀过程，简称边缘自适应腐蚀。需要补充说明的是，实际中不是以高斯分布处理垂直边缘走向的像素灰度值分布，但是本发明将其拟合为高斯分布，同样可以表示边缘信息，同时本发明采用高斯滤波来去除噪声，因此使用混合高斯模型还能够准确还原出一大部分图像细节。因此本发明用高斯模型描述一个边缘走向的垂直方向的灰度分布是合理准确的。获取原图的膨胀图像，根据自适应腐蚀图像和膨胀图像得到置信度二值图。根据自适应腐蚀图像和膨胀图像的每个像素位置的灰度值差异得到置信度分布图，设定置信度阈值，将置信度分布图中大于置信度阈值的像素点灰度值设置为第一设定值，其余像素点灰度值为第二设定值，得到置信度二值图。具体地，首先，获取待处理图像的膨胀图像：对模糊后的待处理图像进行滑窗，即每个位置对应一个矩形窗口的中心，优选的，窗口宽度为11，高度为3。窗口沿宽度方向的轴线与每个位置的分布向量平行，利用该窗口对窗口中心的像素点进行膨胀操作，具体方法为：获取窗口内所有像素的灰度值，选取出最大的灰度值，将其作为窗口中心像素点的新的灰度值，这个过程就是膨胀操作。膨胀操作能够使断开的细节结构连接起来，恢复一些图像的细节结构。对模糊后的待处理图像的所有像素点都进行膨胀操作，获得膨胀图像。因此，原图上每个像素对一个腐蚀结果，也对应一个膨胀结果。其次，获取待处理图像的置信度分布图。如果一个位置的膨胀和腐蚀结果相差不大，那么此处的结果是准确的，如果差别非常大，那么说明腐蚀和膨胀结果有异议。同一个位置的膨胀结果与腐蚀结果相减记为a，本发明将exp作为该位置的一个置信度，用于表征对原图进行腐蚀膨胀处理后该位置的腐蚀膨胀结果的准确性；所有位置的置信度构成一张置信度分布图。最后，获取置信度二值图。对该置信度分布图利用3×3的窗口进行均值滤波，获得滤波结果图；对该滤波结果图进行阈值处理，具体方法为：将灰度值大于第一阈值的像素的灰度值设置为第一设定值，优选的，第一设定值为1，其余的像素点的灰度值设置为第二设定值，优选的，第二设定值为0；获得一个二值图，即为置信度二值图。该置信度二值图上灰度值为1的像素位置获得的腐蚀结果和膨胀结果一致，可信度高；灰度值为0的像素位置获得的腐蚀结果和膨胀结果不一致，可信度低。利用置信度二值图将原图、自适应腐蚀图像与膨胀图像进行融合得到新的灰度图。设置信度二值图为I1，膨胀图像为I2，自适应腐蚀图像为I3，原图为I0，这些图都视为等大小的二维矩阵，那么，新的灰度图矩阵为：其中，为新的灰度图，为原图的像素点灰度矩阵，为置信度二值图的像素点灰度矩阵，为膨胀图像的像素点灰度矩阵，为自适应腐蚀图像的像素点灰度矩阵，表示对膨胀图像和自适应腐蚀图像取均值，表示与的哈达玛积，表示与的哈达玛积。任意两个矩阵的哈达玛积为两个矩阵对应元素的乘积构成的矩阵，任意两个矩阵的哈达玛积依旧是一个矩阵。表示只关注腐蚀结果和膨胀结果一致的位置的均值，而腐蚀结果和膨胀结果不一致的位置的结果为0；表示腐蚀结果和膨胀结果不一致的位置的结果为，而腐蚀结果和膨胀结果一致的位置的结果为0。因此，对于上每个位置的灰度值，如果该位置的腐蚀结果和膨胀结果一致，那么这个位置的灰度值由腐蚀结果和膨胀结果的均值决定，否则由原图决定。至此，完成对待处理图像的纤维分析过程，得到新的灰度图。再次，将纤维分析得到的新的灰度图作为待处理图像进行纤维分析，不断迭代，直至纤维分析得到的新的灰度图稳定，将稳定的新的灰度图作为纤维分布图。具体地，将视为待处理图像，重新执行本发明对原图的处理过程。不断迭代，优选的，循环本发明上述部分四次或者循环多次，使得获得的不再发生变化时，获得最后的，即为稳定的新的灰度图，将稳定的新的灰度图作为纤维分布图。在这个反复迭代中，不断地更新上的边缘信息，以及不断地更新边缘分布场，使得腐蚀结果图和膨胀结果图区域一致，最终获得的稳定的新的灰度图就表示纱线上的纤维分布图，能够消除因纤维的交织遮盖和噪声与模糊导致的纤维区分不开、纤维断断续续的问题，使得纤维分布情况清晰完整且容易区分。至此，根据新的灰度图得到纤维分布图。最后，根据纤维分布图获得纹理影像图，对纱线质量进行判断。优选的，所述根据纤维分布图获得纹理影像图，对纱线质量进行判断具体为：根据纤维分布图获得纹理影像图，计算纹理影像图中所有像素点位置的纤维伸直程度；设定程度阈值，根据纤维伸直程度与程度阈值的关系将纹理影像图二值化，得到二值化图像，计算二值化图像的连通域面积；设定面积阈值，若连通域面积大于面积阈值，则判定纱线存在质量问题；否则，纱线质量合格。优选的，根据纤维伸直程度将纹理影像图二值化，得到二值化图像的方法为：设定程度阈值，将纹理影像图中的纤维伸直程度大于程度阈值的像素点灰度值设置为第一设定值，其余像素点灰度值为第二设定值，得到二值化图像。纤维伸直程度由纹理影像图中的像素点灰度值确定。具体地，首先，根据纤维分布图计算其纹理影像图。具体方法为：设定一个17×17的窗口，上每一个小窗口内的所有像素都形成一个子影像，计算小窗口影像灰度共生矩阵和灰度共生矩阵的熵值，然后将熵值赋值给窗口的中心点，这就完成了第一小窗口的纹理特征计算，然后窗口被移动一个像素形成另外一个小的窗口影像，再重复计算新的共生矩阵和熵值。依次类推，根据纤维分布图逐步生成纹理特征影像图，该纹理特征影像图与原图大小相同，该纹理影像图的每个像素表示纹理的复杂或混乱程度，值越大表示纹理分布越复杂，说明该位置的纤维分布越杂乱不顺畅，伸直程度越低。其次，获取纤维伸直分布图。纹理影像图上任意一个位置的像素为p，那么该位置的纤维的伸直程度为，至此获得每个位置的伸直程度，所有位置的伸直程度构成纤维伸直分布图。再次，将纤维伸直分布图进行阈值化处理。具体方法为：灰度值小于第二阈值的像素的灰度值置为第一设定值，其余像素的灰度值置为第二设定值，获得一个二值化图像。优选的，第二阈值为0.2，第一设定值为1，第二设定值为0。最后，对纱线牵伸质量进行监测，判断纱线质量。计算该二值化图像的连通域的面积，如果该面积大于纱线ROI区域面积的面积阈值，那么说明纱线的质量有问题，优选的，面积阈值为纱线ROI区域面积的十分之一。如果通过本发明连续三次采集的图像获得的纱线都有质量问题，说明生产设备或者生产参数有问题，需要及时调整。至此，完成对纱线牵伸质量的监测。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。且上述对本说明书特定实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
