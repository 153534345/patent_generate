标题title
一种电能质量扰动信号分类方法和系统
摘要abst
本发明公开了一种电能质量扰动信号分类方法和系统，将一维的扰动信号进行扩维，构建二维数据样本，能够反应扰动信号的更多细节特征，提高了抗噪性，利用一维数据和二维数据分别训练VGGNet模型、GoogLeNet模型和ResNet模型，从不同维度提取扰动信号特征，保证了扰动信号特征提取的准确性，最后利用特征融合模块对多个扰动信号特征进行融合，提升了电能质量扰动信号分类的鲁棒性，解决了现有的电能质量分类方法不能兼顾准确性和抗干扰性，可靠性较低的技术问题。
权利要求书clms
1.一种电能质量扰动信号分类方法，其特征在于，包括：根据电力系统节点处的历史电能质量扰动信号数据构建电能质量扰动信号样本数据矩阵；根据电能质量扰动信号样本数据矩阵构建具有时频特征的二维数据集；根据电能质量扰动信号样本数据矩阵和二维数据集构建训练集和测试集，其中，电能质量扰动信号样本数据和二维数据集划分的训练集分别包括第一训练集和第二训练集；构建第一扰动信号分类网络模型，扰动信号分类网络模型包括VGGNet模型、GoogLeNet模型和ResNet模型；使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型，使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型，得到训练好的VGGNet模型、GoogLeNet模型和ResNet模型；将训练好的VGGNet模型、GoogLeNet模型和ResNet模型的全连接层和Softmax函数去除，在训练好的VGGNet模型、GoogLeNet模型和ResNet模型的末端池化层接入特征融合模块和全连接层分类模块，得到第二扰动信号分类网络模型；使用电能质量扰动信号样本数据对应的第二训练集和二维数据集对应的第二训练集训练第二扰动信号分类网络模型，得到训练好的第二扰动信号分类网络模型；将待分类的电能质量扰动信号预处理为具有时频特征的二维数据，将待分类的电能质量扰动信号和预处理后的具有时频特征的二维数据输入训练好的第二扰动信号分类网络模型，得到电能质量扰动信号的分类结果。2.根据权利要求1所述的电能质量扰动信号分类方法，其特征在于，使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型，使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型时，使用动量分数阶梯度下降优化器更新模型的网络参数。3.根据权利要求1所述的电能质量扰动信号分类方法，其特征在于，第一训练集、第二训练集和测试集的比例为3:3:1或7:7:3。4.根据权利要求1所述的电能质量扰动信号分类方法，其特征在于，扰动信号分类网络模型中的VGGNet模型为改进的VGGNet模型，改进的VGGNet模型的网络结构为：以VGGNet的VGG-16网络为主架构，第一个卷积核的长度为32，且VGG-16网络的后三个顺序连接的连续卷积层替换为由两个并行卷积层组成的复合卷积层，复合卷积层的卷积核大小均为3×1，VGG-16网络的最后三个全连接层缩减为两个全连接层，每个卷积层的输出连接BN层，在每一个BN层后面加入Relu层进行激活。5.根据权利要求1所述的电能质量扰动信号分类方法，其特征在于，扰动信号分类网络模型中的GoogLeNet模型为改进的GoogLeNet模型，改进的GoogLeNet模型的网络结构为：在GoogLeNet模型的基础上对Inception模块增加一个7×7的卷积层，并添加与7×7卷积层对应的用于降采样的1×1卷积层，将GoogLeNet模型的最后一个全连接层去除，替换为一个全局池化层。6.根据权利要求1所述的电能质量扰动信号分类方法，其特征在于，扰动信号分类网络模型中的ResNet模型为改进的ResNet模型，改进的ResNet模型的网络结构为：以ResNet-50网络作为主架构，在ResNet-50网络中的每一个残差单元的每一个卷积层前加入BN层，并在每一个BN层后面加入Relu层进行激活，使用金字塔池化层替换ResNet-50网络的最后一个平均池化层。7.根据权利要求1所述的电能质量扰动信号分类方法，其特征在于，根据电能质量扰动信号样本数据矩阵构建具有时频特征的二维数据集，包括：构建多分辨率小波分解模型；确定频带划分数目和小波基函数；将电能质量扰动信号样本数据矩阵中的样本数据连续化，得到对应于不同种类扰动信号的信号波形数据集；根据频带划分数目和小波基函数，使用多分辨率小波分解模型对信号波形数据集中的样本进行多分辨率小波分解，将分解得到的不同尺度下的时频信号转化为二维时频图，构成具有时频特征的二维数据集。8.一种电能质量扰动信号分类系统，其特征在于，包括：一维数据样本构建模块，用于根据电力系统节点处的历史电能质量扰动信号数据构建电能质量扰动信号样本数据矩阵；二维数据样本构建模块，用于根据电能质量扰动信号样本数据矩阵构建具有时频特征的二维数据集；样本划分模块，用于根据电能质量扰动信号样本数据矩阵和二维数据集构建训练集和测试集，其中，电能质量扰动信号样本数据和二维数据集划分的训练集分别包括第一训练集和第二训练集；第一模型构建模块，用于构建第一扰动信号分类网络模型，扰动信号分类网络模型包括VGGNet模型、GoogLeNet模型和ResNet模型；第一训练模块，用于使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型，使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型，得到训练好的VGGNet模型、GoogLeNet模型和ResNet模型；第二模型构建模块，用于将训练好的VGGNet模型、GoogLeNet模型和ResNet模型的全连接层和Softmax函数去除，在训练好的VGGNet模型、GoogLeNet模型和ResNet模型的末端池化层接入特征融合模块和全连接层分类模块，得到第二扰动信号分类网络模型；第二训练模块，用于使用电能质量扰动信号样本数据对应的第二训练集和二维数据集对应的第二训练集训练第二扰动信号分类网络模型，得到训练好的第二扰动信号分类网络模型；扰动信号识别模块，用于将待分类的电能质量扰动信号预处理为具有时频特征的二维数据，将待分类的电能质量扰动信号和预处理后的具有时频特征的二维数据输入训练好的第二扰动信号分类网络模型，得到电能质量扰动信号的分类结果。9.根据权利要求8所述的电能质量扰动信号分类系统，其特征在于，二维数据样本构建模块具体用于：构建多分辨率小波分解模型；确定频带划分数目和小波基函数；将电能质量扰动信号样本数据矩阵中的样本数据连续化，得到对应于不同种类扰动信号的信号波形数据集；根据频带划分数目和小波基函数，使用多分辨率小波分解模型对信号波形数据集中的样本进行多分辨率小波分解，将分解得到的不同尺度下的时频信号转化为二维时频图，构成具有时频特征的二维数据集。10.根据权利要求1所述的电能质量扰动信号分类方法，其特征在于，第一训练模块具体用于：使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型，使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型，得到训练好的VGGNet模型、GoogLeNet模型和ResNet模型使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型，在使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型时，使用动量分数阶梯度下降优化器更新模型的网络参数。
说明书desc
技术领域本发明涉及电能质量分析技术领域，尤其涉及一种电能质量扰动信号分 类方法和系统。背景技术分布式能源的并网以及电力系统中大量新型电力电子设备和其他非线性 负载的接入，导致电网中的电能质量问题日益严重，威胁着电力系统的运行 安全。电力系统中的电能质量扰动通常表现为电压和电流的幅值、频率和相 位的突然变动，根据变动的类型以及变动幅度的不同，这些扰动通常可分为 电压暂降、电压中断、电压波动与闪变、电压偏差、频率偏差、电压三相不 平衡以及谐波等几种不同的类型，这些扰动会对电力系统造成一系列的影响， 如线路损耗的增加、能耗的增加、损坏敏感性设备、干扰正常通信，甚至造成主要电气设施的异常运行及损坏，严重危害到电网的运行安全，造成大规 模停电事件，为工业生产及日常生活带来巨大经济损失和后果。有效的安全 评估以及合理的电力资源分配是应对上述电能质量问题所带来的危害的有效 措施，因此，对各种扰动进行检测以及准确分类对分析和排除电能质量问题 进而制定相应对策具有十分重要的意义。目前的电能质量分类方法主要由扰动特征提取和扰动识别分类两部分组 成，扰动特征的提取主要对电能质量扰动事件序列进行变换或对其波形进行 重构，随后从中提取出电能质量扰动信号的特征量，常用的扰动特征提取方 法有傅里叶变换、S变换、小波变换、希尔伯特-黄变换等。扰动信号的识别 分类是将检测到的具有各自特征的扰动信号送入相应的分类器进行识别分 类，常用的扰动信号分类方法有支持向量机法、决策树法、人工神经网络法 等。但是目前的电能质量分类方法无法兼顾准确性和抗干扰性，不能在保证分类准确度的同时拥有良好的抗噪性能，可靠性较低。发明内容本发明提供了一种电能质量扰动信号分类方法和系统，用于解决现有的 电能质量分类方法不能兼顾准确性和抗干扰性，可靠性较低的技术问题。有鉴于此，本发明第一方面提供了一种电能质量扰动信号分类方法，包 括：根据电力系统节点处的历史电能质量扰动信号数据构建电能质量扰动信 号样本数据矩阵；根据电能质量扰动信号样本数据矩阵构建具有时频特征的二维数据集；根据电能质量扰动信号样本数据矩阵和二维数据集构建训练集和测试 集，其中，电能质量扰动信号样本数据和二维数据集划分的训练集分别包括 第一训练集和第二训练集；构建第一扰动信号分类网络模型，扰动信号分类网络模型包括VGGNet 模型、GoogLeNet模型和ResNet模型；使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型， 使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型， 得到训练好的VGGNet模型、GoogLeNet模型和ResNet模型；将训练好的VGGNet模型、GoogLeNet模型和ResNet模型的全连接层和 Softmax函数去除，在训练好的VGGNet模型、GoogLeNet模型和ResNet模 型的末端池化层接入特征融合模块和全连接层分类模块，得到第二扰动信号 分类网络模型；使用电能质量扰动信号样本数据对应的第二训练集和二维数据集对应的 第二训练集训练第二扰动信号分类网络模型，得到训练好的第二扰动信号分 类网络模型；将待分类的电能质量扰动信号预处理为具有时频特征的二维数据，将待 分类的电能质量扰动信号和预处理后的具有时频特征的二维数据输入训练好 的第二扰动信号分类网络模型，得到电能质量扰动信号的分类结果。可选地，使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet 模型，使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet 模型时，使用动量分数阶梯度下降优化器更新模型的网络参数。可选地，第一训练集、第二训练集和测试集的比例为3:3:1或7:7:3。可选地，扰动信号分类网络模型中的VGGNet模型为改进的VGGNet模 型，改进的VGGNet模型的网络结构为：以VGGNet的VGG-16网络为主架构，第一个卷积核的长度为32，且 VGG-16网络的后三个顺序连接的连续卷积层替换为由两个并行卷积层组成 的复合卷积层，复合卷积层的卷积核大小均为3×1，VGG-16网络的最后三个 全连接层缩减为两个全连接层，每个卷积层的输出连接BN层，在每一个BN 层后面加入Relu层进行激活。可选地，扰动信号分类网络模型中的GoogLeNet模型为改进的GoogLeNet 模型，改进的GoogLeNet模型的网络结构为：在GoogLeNet模型的基础上对Inception模块增加一个7×7的卷积层，并 添加与7×7卷积层对应的用于降采样的1×1卷积层，将GoogLeNet模型的最 后一个全连接层去除，替换为一个全局池化层。可选地，扰动信号分类网络模型中的ResNet模型为改进的ResNet模型， 改进的ResNet模型的网络结构为：以ResNet-50网络作为主架构，在ResNet-50网络中的每一个残差单元的 每一个卷积层前加入BN层，并在每一个BN层后面加入Relu层进行激活， 使用金字塔池化层替换ResNet-50网络的最后一个平均池化层。可选地，根据电能质量扰动信号样本数据矩阵构建具有时频特征的二维 数据集，包括：构建多分辨率小波分解模型；确定频带划分数目和小波基函数；将电能质量扰动信号样本数据矩阵中的样本数据连续化，得到对应于不 同种类扰动信号的信号波形数据集；根据频带划分数目和小波基函数，使用多分辨率小波分解模型对信号波 形数据集中的样本进行多分辨率小波分解，将分解得到的不同尺度下的时频 信号转化为二维时频图，构成具有时频特征的二维数据集。本发明第二方面提供了一种电能质量扰动信号分类系统，包括：一维数据样本构建模块，用于根据电力系统节点处的历史电能质量扰动 信号数据构建电能质量扰动信号样本数据矩阵；二维数据样本构建模块，用于根据电能质量扰动信号样本数据矩阵构建 具有时频特征的二维数据集；样本划分模块，用于根据电能质量扰动信号样本数据矩阵和二维数据集 构建训练集和测试集，其中，电能质量扰动信号样本数据和二维数据集划分 的训练集分别包括第一训练集和第二训练集；第一模型构建模块，用于构建第一扰动信号分类网络模型，扰动信号分 类网络模型包括VGGNet模型、GoogLeNet模型和ResNet模型；第一训练模块，用于使用电能质量扰动信号样本数据对应的第一训练集 训练VGGNet模型，使用二维数据集对应的第二训练集分别训练GoogLeNet 模型和ResNet模型，得到训练好的VGGNet模型、GoogLeNet模型和ResNet 模型；第二模型构建模块，用于将训练好的VGGNet模型、GoogLeNet模型和 ResNet模型的全连接层和Softmax函数去除，在训练好的VGGNet模型、 GoogLeNet模型和ResNet模型的末端池化层接入特征融合模块和全连接层分 类模块，得到第二扰动信号分类网络模型；第二训练模块，用于使用电能质量扰动信号样本数据对应的第二训练集 和二维数据集对应的第二训练集训练第二扰动信号分类网络模型，得到训练 好的第二扰动信号分类网络模型；扰动信号识别模块，用于将待分类的电能质量扰动信号预处理为具有时 频特征的二维数据，将待分类的电能质量扰动信号和预处理后的具有时频特 征的二维数据输入训练好的第二扰动信号分类网络模型，得到电能质量扰动 信号的分类结果。可选地，二维数据样本构建模块具体用于：构建多分辨率小波分解模型；确定频带划分数目和小波基函数；将电能质量扰动信号样本数据矩阵中的样本数据连续化，得到对应于不 同种类扰动信号的信号波形数据集；根据频带划分数目和小波基函数，使用多分辨率小波分解模型对信号波 形数据集中的样本进行多分辨率小波分解，将分解得到的不同尺度下的时频 信号转化为二维时频图，构成具有时频特征的二维数据集。可选地，第一训练模块具体用于：使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型， 使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型， 得到训练好的VGGNet模型、GoogLeNet模型和ResNet模型使用电能质量扰 动信号样本数据对应的第一训练集训练VGGNet模型，在使用二维数据集对 应的第二训练集分别训练GoogLeNet模型和ResNet模型时，使用动量分数阶 梯度下降优化器更新模型的网络参数。从以上技术方案可以看出，本发明实施例具有以下优点：本发明提供了一种电能质量扰动信号分类方法，将一维的扰动信号进行 扩维，构建二维数据样本，能够反应扰动信号的更多细节特征，提高了抗噪 性，利用一维数据和二维数据分别训练VGGNet模型、GoogLeNet模型和 ResNet模型，从不同维度提取扰动信号特征，保证了扰动信号特征提取的准 确性，最后利用特征融合模块对多个扰动信号特征进行融合，提升了电能质 量扰动信号分类的鲁棒性，解决了现有的电能质量分类方法不能兼顾准确性 和抗干扰性，可靠性较低的技术问题。附图说明为了更清楚的说明本发明实施例或现有技术中的技术方案，下面将对实 施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面 描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲， 在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1为本发明实施例中提供的一种电能质量扰动信号分类方法的一个流 程示意图；图2为本发明实施例中提供的一种电能质量扰动信号分类方法的另一个 流程示意图；图3为本发明实施例中提供的第二扰动信号分类网络模型的结构示意图；图4为本发明实施例中提供的改进的VGGNet模型VGGNet-C的结构示 意图；图5为本发明实施例中提供的改进的GoogLeNet模型GoogLeNet-C的结 构示意图；图6为本发明实施例中提供的改进的Inception模块Inception-C的结构示 意图；图7为本发明实施例中提供的改进的ResNet模型ResNet-C的结构示意 图；图8为本发明实施例中提供的改进的ResNet模型ResNet-C的残差单元 Convk_x-C的结构示意图；图9为本发明实施例中提供的一种电能质量扰动信号分类系统的结构示 意图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实 施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然， 所描述的实施例仅是本发明一部分实施例，而不是全部的实施例。基于本发 明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的 所有其他实施例，都属于本发明保护的范围。为了便于理解，请参阅图1，本发明中提供了一种电能质量扰动信号分类 方法的实施例，包括：步骤101、根据电力系统节点处的历史电能质量扰动信号数据构建电能质 量扰动信号样本数据矩阵。从历史和实时监测数据中获取电力系统中不同节点处各类型电能质量扰 动信号的数据样本集。选定好采样频率，以一个周波的扰动信号数据为一个 样本，将各扰动信号的数据集分为N个样本，经预处理后构成电能质量扰动信号样本数据矩阵：其中，xi1～xij分别为电力系统中采样节点的不同类型的电能质量扰动信号 数据，j为扰动信号的类型，n为各扰动信号的采样数据集总数。在工频50Hz 下，设采样频率为fs，则每一种类型的电能质量扰动信号的样本数量 N＝50n/fs。步骤102、根据电能质量扰动信号样本数据矩阵构建具有时频特征的二维 数据集。为了发挥深度卷积网络模型在二维图像处理上的优势，获取电能质量扰 动信号更多细节上的特征，本发明中将原始扰动信号数据集分解构成具有时 频特征的二维数据集Jp，作为多通道特征提取模块的部分通道的输入。步骤103、根据电能质量扰动信号样本数据矩阵和二维数据集构建训练集 和测试集，其中，电能质量扰动信号样本数据和二维数据集划分的训练集分 别包括第一训练集和第二训练集。将原始扰动信号样本数据集X以及对应的类别标签作为一维卷积神经网 络模型的输入，将具有时频特征的二维数据集Jp以及对应的类别标签作为二 维卷积神经网络模型的输入，按3:3:1或7:7:3的比例将数据集X和Jp划分为 第一训练集、第二训练集以及测试集，用于各卷积神经网络模型以及全连接 层分类器的模型训练和模型测试。可以设定电能质量扰动信号的类别标签数 据为0,1,2，...，j，每一个数字对应一种电能质量扰动信号，j为总的电能质量 扰动信号的类别数，具体的对应关系可根据实际情况设定。步骤104、构建第一扰动信号分类网络模型，扰动信号分类网络模型包括 VGGNet模型、GoogLeNet模型和ResNet模型。步骤105、使用电能质量扰动信号样本数据对应的第一训练集训练 VGGNet模型，使用二维数据集对应的第二训练集分别训练GoogLeNet模型 和ResNet模型，得到训练好的VGGNet模型、GoogLeNet模型和ResNet模 型。将第一训练集中的一维扰动数据与以 及各自对应的标签数据送入VGGNet模型进行训练，将二维扰动数据分别送入GoogLeNet模型和ResNet模型，对 GoogLeNet模型和ResNet模型进行训练，得到训练好的VGGNet模型、 GoogLeNet模型和ResNet模型。类别标签的编码方式选用One-hot编码。步骤106、将训练好的VGGNet模型、GoogLeNet模型和ResNet模型的 全连接层和Softmax函数去除，在训练好的VGGNet模型、GoogLeNet模型 和ResNet模型的末端池化层接入特征融合模块和全连接层分类模块，得到第 二扰动信号分类网络模型。将训练好的VGGNet模型、GoogLeNet模型和ResNet模型的输出部分， 即全连接层和Softmax函数部分去除，在训练好的VGGNet模型、GoogLeNet 模型和ResNet模型的各自最后的池化层的输出接入特征融合模块和全连接层 分类模块。特征融合模块由一个融合层构成，用于将二维特征图展平成一维特征向 量，并将多个一维特征向量进行首尾拼接构成融合特征向量，作为全连接层 分类模块的输入。全连接层分类模块用于最后的特征识别分类，由两层全连接层以及一个 输出函数构成，输出函数选用Softmax函数，输出通道数为j，j为电能质量 扰动信号的类别数。目标函数选用交叉熵损失函数。步骤107、使用电能质量扰动信号样本数据对应的第二训练集和二维数据 集对应的第二训练集训练第二扰动信号分类网络模型，得到训练好的第二扰 动信号分类网络模型。利用第二训练集对全连接层分类模块进行训练，从而完成了整个扰动信 号分类网络模型的训练，即得到第二扰动信号分类网络模型。最后还可以利 用测试集对第二扰动信号分类网络模型进行测试，验证网络模型的可行性。步骤108、将待分类的电能质量扰动信号预处理为具有时频特征的二维数 据，将待分类的电能质量扰动信号和预处理后的具有时频特征的二维数据输 入训练好的第二扰动信号分类网络模型，得到电能质量扰动信号的分类结果。将待分类的电能质量扰动信号按照步骤101和步骤102分别处理成一维 数据和二维数据的形式，输入第二扰动信号分类网络模型，获得第二扰动信 号分类网络模型的输出序列：P＝，其中，p1～pj为网络预测的 输入的扰动信号属于某一类电能质量扰动信号类别的概率，j为总的扰动信号 的类别数。找到p1～pj中最大的那一个元素，输出此元素在序列P中对应的索 引值，此索引值为一位于之间的整数值，将其与之前设定的扰动信 号对应的标签值比较，取与索引值相等的标签值对应的扰动信号类别作为最 终的识别结果。本发明实施例提供的一种电能质量扰动信号分类方法，将一维的扰动信 号进行扩维，构建二维数据样本，能够反应扰动信号的更多细节特征，提高 了抗噪性，利用一维数据和二维数据分别训练VGGNet模型、GoogLeNet模 型和ResNet模型，从不同维度提取扰动信号特征，保证了扰动信号特征提取 的准确性，最后利用特征融合模块对多个扰动信号特征进行融合，提升了电 能质量扰动信号分类的鲁棒性，解决了现有的电能质量分类方法不能兼顾准 确性和抗干扰性，可靠性较低的技术问题。为了便于理解，请参阅图2和图3，本发明实施例中提供了一种电能质量 扰动信号分类方法的另一个实施例，包括：步骤201、根据电力系统节点处的历史电能质量扰动信号数据构建电能质 量扰动信号样本数据矩阵。本发明中，步骤201与前述实施例中的步骤101一致，在此不再进行赘 述。步骤202、根据电能质量扰动信号样本数据矩阵构建具有时频特征的二维 数据集。为了发挥深度卷积网络模型在二维图像处理上的优势，获取电能质量扰 动信号更多细节上的特征，本发明实施例中采用多分辨率小波分析的方法， 将原始扰动信号数据集分解构成具有时频特征的二维数据集，作为多通道特 征提取模块的部分通道的输入。具体包括：构建多分辨率小波分解模型根据函数空间理论，当待分析的信号的采样频率满足采样定理时，原始 信号序列x可以分别用理想的低通滤波器以及高通滤波器分解为低频部分 以及高频部分两部分。定义原始序列x所占频带为空间V0，则上述低频部分 所对应的子空间为V1，高频部分对应的子空间为W1。因此，经一次分解，原 始序列x对应的频带空间V0被分解为两个子空间：V1和W1。而这一分解过程 可以持续下去，即低频部分又可以被进一步分解为新的低频部分以及高频部 分，对应的子空间V1也被进一步分解为V2和W2两个子空间。往下逐级分解，对应的子空间分解过程为：式中，Wj是反映同级低频子空间Vj中信号细节的高频子空间，Vj则是反 映上一级低频子空间Vj-1的空间概貌的子空间。Vj与Wj分别称为在分解尺度j 下的尺度空间以及小波空间。据此，对样本数据集进行多尺度分解，基于Mallat 算法，多分辨率分解公式为：式中，f∈L2表示任意类型的扰动信号波形。上式的右边第一部分表 示扰动信号f在尺度空间Vj上的投影，表示扰动信号的平滑近似逼近。上式 右边的第二部分表示扰动信号f在小波空间Wj上的投影，反映了相邻的两个 尺度空间对应的平滑近似逼近的细节差异，也即对扰动信号所做的细节补充。 φj,k与分别称为尺度函数和小波函数，分别为尺度空间Vj以及小波空间 Wj的标准正交基，由分解过程中所用滤波器组直接获得。Cj和dj为多分 辨率小波分解的两个分解系数，分别称为离散平滑近似逼近以及小波变换系 数。Cj与dj的递推公式为：Cj+1＝∑hCjdj+1＝∑gCj式中，h与g分别表示分解所用低通滤波器的单位采样响应以及高通 滤波器的单位采样响应。确定频带划分数目依据多分辨率分解理论，扰动信号可按采样频率无线划分为多个部分， 对应的频带子空间也可无限划分。为了限制基频分量对其它的子频带分量的 影响，设扰动信号的采样频率为fs'，扰动信号的基频为fb，以使扰动信号的 基频fb处于最低的子频带中心为原则，确定理论的频带划分数目为：式中，Y表示理论的频带划分数目，对其取整获得实际的频带划分数目。确定小波基函数考虑时域以及频域两域的紧支撑性和对不规则信号部分的灵敏度，选取Daubechies系列小波作为选取小波基的小波类。比较该系列几种小波，综合 考虑正交性、高正规性、泛化性等特点，选取具有最短时窗以及优秀的时间 分辨率的db4小波作为多分辨率小波分析的基小波。将电能质量扰动信号样本数据矩阵中的样本数据连续化，得到对应 于不同种类扰动信号的信号波形数据集。选取每一类型的电能质量扰动信号的N个样本数据，将总共N×j个样本 数据连续化，获得对应于不同种类扰动信号的信号波形数据集。根据频带划分数目和小波基函数，使用多分辨率小波分解模型对信 号波形数据集中的样本进行多分辨率小波分解，将分解得到的不同尺度下的 时频信号转化为二维时频图，获得j种扰动信号共N×j张时频图，将图片调 整成224×224的大小，构成具有时频特征的二维数据集Jp。步骤203、根据电能质量扰动信号样本数据矩阵和二维数据集构建训练集 和测试集，其中，电能质量扰动信号样本数据和二维数据集划分的训练集分 别包括第一训练集和第二训练集。本发明实施例中的步骤203与前述实施例中的步骤103一致，在此不再 进行赘述。步骤204、构建第一扰动信号分类网络模型，扰动信号分类网络模型包括 改进的VGGNet模型、改进的GoogLeNet模型和改进的ResNet模型。选用VGGNet作为一维特征提取通道的深度卷积神经网络类别，考虑网 络的深度以及预测模型的准确度，选取VGGNet中的VGG-16网络作为模型 的主架构。考虑序列数据的长度、模型训练时间以及特征提取准确度，对 VGG-16网络进行改进，搭建新的VGGNet模型，如图4所示。为了加快训练 速度，VGGNet模型的第一个卷积核的长度设为32。为了进一步加快训练速 度并提取序列数据的细节特征，将VGG-16模型的三个顺次连接的连续卷积 层替换为三个由两个并行卷积层组成的复合卷积层，卷积核的大小皆设为 3×1。为了进一步减少参数量，将VGG-16中最后三个全连接层缩减为两个。 池化层的窗口大小皆设为2×1，考虑收敛速度以及梯度弥散效应，选用Relu 函数作为激活函数。Relu函数的公式为：式中，表示第l层第k个神经元的激活值，为第l层第k个神经元的 输入值。为了加快学习速率，提升网络的泛化能力，在网络结构中每个卷积层的 输出连接BN层，在每一个BN层后面加入Relu层进行激活，BN层的计算公 式为：式中，为当前BN层的输出，其中，E为期望， 为方差，为第l层第k个神经元的缩放系数，为当前BN层的偏置值， ε为常数项。模型的输出层采用Softmax激活函数，函数的计算公式为：式中，m＝1，2，...，M，表示模型最终的输出类别为M，pm表示第m类的概 率，也即实际的标签值，am表示输出层中待激活的神经元。目标函数选用交叉熵损失函数，函数计算公式为：式中，ym表示期望标签值。改进后的VGGNet模型记为VGGNet-C，如图4所示。选用GoogLeNet作为第一个二维特征提取通道的深度卷积神经网络主模 型架构。考虑特征提取准确度、训练时间以及电能质量扰动信号特性，对 GoogLeNet模型进行改进，搭建新的GoogLeNet模型，如图5所示。考虑到电能质量扰动信号的样本数量限制，并且为了提取扰动信号更多 的潜在特征，对原始GoogLeNet中的Inception模块进行改进：在原始Inception 模块的基础上增加一个7×7的卷积层，并添加与之对应的用于降采样的1×1 的卷积层。为了有效减少训练参数、防止过拟合，并且增强扰动信号特征的映射与 相应类别的对应关系，将原模型中最后一个全连接层去除，替换为一个全局 池化层，即对经最后一个Inception模块输出的每个特征图做全局池化处理。 考虑到模型输入的是扰动信号的基于多尺度的时频图，为了弱化时频图像的 局部干扰，并考虑时频图的各尺度的信息，故选用全局平均池化来做池化处 理，全局平均池化的公式为：式中，表示经最后一个Inception模块输出的第l个特征图上的值，m×n 为特征图的尺寸，y表示第l个特征图经全局平均池化处理后得到的特征值。原模型中的两个辅助分类器不做输出与处理，仅用于反向传播梯度信号 以及一定程度的正则化。激活函数选用Relu函数，在网络结构中加入BN层 用以提升训练速度和训练精度，输出层的激活函数选用Softmax函数，目标函 数选用交叉熵损失函数。改进后的GoogLeNet模型记为GoogLeNet-C， GoogLeNet-C的结构如图5所示，改进的Inception模块结构如图6所示。选用ResNet作为第二个二维特征提取通道的深度卷积神经网络模型类 型。考虑泛用性、训练参数量以及训练精度，选用ResNet-50作为主模型架构， 对ResNet-50进行改进，搭建新的ResNet模型，如图7所示。考虑到网路的收敛稳定性、收敛速度，并为了防止过拟合，在ResNet-50 中的每一个残差单元的每一个卷积层前加入BN层，并在每一个BN层后面加 入Relu层进行激活。考虑从不同尺度提取扰动信号的特征，使用金字塔池化 层替换ResNet-50网络的最后一个平均池化层，即将从ResNet-50中最后一个 Conv5_x残差单元输出的特征图经过三个窗口大小以及步长都不同的平均池 化层的处理后输出。根据从Conv5_x单元输出的特征图大小，设定三个池化 层的池化窗口大小分别为4、7、13，对应的步长分别为3、6、13。激活函数选用Relu函数，输出层的激活函数选用Softmax函数，目标函 数选用交叉熵损失函数。改进后的ResNet模型以及残差单元记为ResNet-C 和Convk_x-C，其中，x＝1,2,3,4,5,分别表示不同的残差单元，ResNet-C如图7 所示，Convk_x-C如图8所示。步骤205、使用电能质量扰动信号样本数据对应的第一训练集训练改进的 VGGNet模型，使用二维数据集对应的第二训练集分别训练改进的GoogLeNet 模型和改进的ResNet模型，得到训练好的改进的VGGNet模型、改进的GoogLeNet模型和改进的ResNet模型。将第一训练集中的一维扰动数据与以 及各自对应的标签数据送入改进的VGGNet模型VGGNet-C中进行训练，将 二维扰动数据分别送入改进的GoogLeNet 模型GoogLeNet-C和改进的ResNet模型ResNet-C，对GoogLeNet-C模型和 ResNet-C模型进行训练，得到训练好的VGGNet-C模型、GoogLeNet-C模型 和ResNet-C模型。类别标签的编码方式选用One-hot编码。本发明实施例中，将动量思想添加到分数阶梯度下降算法当中构成基于 动量思想的分数阶梯度下降优化器，用于扰动信号分类网络的参数更新。基 于此优化器的参数更新公式为：式中，与分别表示卷积神经网络中第j层第i个神经元的第 k个连接在下一时刻以及当前时刻的权重值，与分别表示卷积神经 网络中第j层第i个神经元在下一时刻以及当前时刻的偏置值，v与u 分别为下一时刻的权重动量项以及偏置动量项，二者用于反映过去时刻的分 数阶梯度的信息以及当前时刻的分数阶梯度的信息v与u的更新计 算公式为：式中，Loss是损失函数，是权重w以及偏置b的函数，与分别为网络前一时刻的权重值以及偏置值，β为动量项系数，0＜β＜1，其值 决定前一时刻的梯度更新方向对当前时刻的参数更新方向的影响程度，ρ为网 络的学习率，0＜ρ≤1，δ为一极小的正数，α表示分数阶的阶次，0＜α＜2。本发明实施例用动量分数阶梯度下降优化器优化神经网络，在提升训练 速度的同时保证了分类的准确性。步骤206、将训练好的VGGNet模型、GoogLeNet模型和ResNet模型的 全连接层和Softmax函数去除，在训练好的VGGNet模型、GoogLeNet模型 和ResNet模型的末端池化层接入特征融合模块和全连接层分类模块，得到第 二扰动信号分类网络模型。将训练好的VGGNet模型、GoogLeNet模型和ResNet模型的输出部分， 即全连接层和Softmax函数部分去除，在训练好的VGGNet模型、GoogLeNet 模型和ResNet模型的各自最后的池化层的输出接入特征融合模块和全连接层 分类模块。特征融合模块由一个融合层构成，用于将二维特征图展平成一维特征向 量，并将多个一维特征向量进行首尾拼接构成融合特征向量，作为全连接层 分类模块的输入。全连接层分类模块用于最后的特征识别分类，由两层全连接层以及一个 输出函数构成，输出函数选用Softmax函数，输出通道数为j，j为电能质量 扰动信号的类别数。目标函数选用交叉熵损失函数。步骤207、使用电能质量扰动信号样本数据对应的第二训练集和二维数据 集对应的第二训练集训练第二扰动信号分类网络模型，得到训练好的第二扰 动信号分类网络模型。步骤208、将待分类的电能质量扰动信号预处理为具有时频特征的二维数 据，将待分类的电能质量扰动信号和预处理后的具有时频特征的二维数据输 入训练好的第二扰动信号分类网络模型，得到电能质量扰动信号的分类结果。本发明实施例中的步骤207和步骤208与前述实施例中的步骤107和步 骤108一致，在此不再进行赘述。本发明实施例采用原始数据作为一维数据集，利用小波分析构建扰动信 号二维数据集，采用深度卷积神经网络方法，搭建适用于不同维度的卷积神 经网络模型并对其进行结构优化改进，采用深度卷积神经网络的方法，利用 不同的改进后卷积神经网络模型通过训练不同维度的扰动信号数据集来进行 扰动信号特征提取，获得多组扰动信号特征向量，搭建动量分数阶梯度下降 优化器模型，利用优化器优化各卷积神经网络的权重值和偏置值，利用经不 同卷积神经网络模型训练得到的扰动信号特征向量，将各向量进行拼接，得 到融合特征向量，采用卷积神经网络的方法，搭建全连接层分类器，利用融 合特征向量训练全连接层分类器，获得用于电能质量扰动信号识别分类的神 经网络分类器，利用训练好的适用于不同维度的卷积神经网络模型、动量分 数阶梯度下降优化器以及全连接层分类器对电能质量扰动信号进行分类。本 发明实施例中提供的电能质量扰动信号分类方法，从不同尺度、不同维度对 扰动信号的细节特征进行提取，在保证准确性的同时，对扰动信号进行了快 速辨识，为电力系统的故障排除、补偿措施的制定、稳定运行提供了必要的 技术支撑。相比于现有技术，本发明实施例中提供的电能质量扰动信号分类方法， 具有以下优点：目前将扰动信号的特征提取与扰动分类识别拆分开来分别进行的分 类方法往往需要设计构造两部分的内容，过程繁琐，耗时过长，本发明实施 例利用卷积神经网络可以实现扰动信号的特征提取与扰动的分类识别同时进 行，提高分类效率。单个卷积神经网络在对多特征的电能质量扰动信号进行分类时的准 确性、快速性以及鲁棒性往往存在着不足。本发明实施例通过拆分卷积神经 网络的分类过程，搭建适用于不同维度信号的卷积神经网络特征提取融合模 块以及卷积神经网络分类器，提出基于改进的多通道卷积神经网络实现对电 能质量扰动的高效、准确、稳定的分类。电能质量扰动信号的复杂性、无规律性、特征混叠的可能性以及一 维信号的局限性不利于卷积神经网络的特征识别与扰动分类。本发明实施例 利用小波分析对原始扰动信号进行变换，获得能够反映电能质量扰动信号更 多特征的二维扰动信号数据集作为卷积神经网络的输入，提高卷积神经网络 分类的可靠性。深度卷积神经网络网络层数的增加以及各改进网络模型模型复杂程 度的增加往往会导致网络的收敛速度过慢，本发明实施例通过搭建动量分数 阶梯度下降优化器模型对各卷积神经网络模型的训练过程进行优化，提升扰 动分类速度，同时保证分类的准确性。为了便于理解，请参阅图9，本发明中提供了一种电能质量扰动信号分类 系统的实施例，包括：一维数据样本构建模块901，用于根据电力系统节点处的历史电能质量扰 动信号数据构建电能质量扰动信号样本数据矩阵；二维数据样本构建模块902，用于根据电能质量扰动信号样本数据矩阵构 建具有时频特征的二维数据集；样本划分模块903，用于根据电能质量扰动信号样本数据矩阵和二维数据 集构建训练集和测试集，其中，电能质量扰动信号样本数据和二维数据集划 分的训练集分别包括第一训练集和第二训练集；第一模型构建模块904，用于构建第一扰动信号分类网络模型，扰动信号 分类网络模型包括VGGNet模型、GoogLeNet模型和ResNet模型；第一训练模块905，用于使用电能质量扰动信号样本数据对应的第一训练 集训练VGGNet模型，使用二维数据集对应的第二训练集分别训练GoogLeNet 模型和ResNet模型，得到训练好的VGGNet模型、GoogLeNet模型和ResNet 模型；第二模型构建模块906，用于将训练好的VGGNet模型、GoogLeNet模型 和ResNet模型的全连接层和Softmax函数去除，在训练好的VGGNet模型、 GoogLeNet模型和ResNet模型的末端池化层接入特征融合模块和全连接层分 类模块，得到第二扰动信号分类网络模型；第二训练模块907，用于使用电能质量扰动信号样本数据对应的第二训练 集和二维数据集对应的第二训练集训练第二扰动信号分类网络模型，得到训 练好的第二扰动信号分类网络模型；扰动信号识别模块908，用于将待分类的电能质量扰动信号预处理为具有 时频特征的二维数据，将待分类的电能质量扰动信号和预处理后的具有时频 特征的二维数据输入训练好的第二扰动信号分类网络模型，得到电能质量扰 动信号的分类结果。二维数据样本构建模块902具体用于：构建多分辨率小波分解模型；确定频带划分数目和小波基函数；将电能质量扰动信号样本数据矩阵中的样本数据连续化，得到对应于不 同种类扰动信号的信号波形数据集；根据频带划分数目和小波基函数，使用多分辨率小波分解模型对信号波 形数据集中的样本进行多分辨率小波分解，将分解得到的不同尺度下的时频 信号转化为二维时频图，构成具有时频特征的二维数据集.第一训练模块905具体用于：使用电能质量扰动信号样本数据对应的第一训练集训练VGGNet模型， 使用二维数据集对应的第二训练集分别训练GoogLeNet模型和ResNet模型， 得到训练好的VGGNet模型、GoogLeNet模型和ResNet模型使用电能质量扰 动信号样本数据对应的第一训练集训练VGGNet模型，在使用二维数据集对 应的第二训练集分别训练GoogLeNet模型和ResNet模型时，使用动量分数阶 梯度下降优化器更新模型的网络参数。本发明实施例提供的一种电能质量扰动信号分类系统，将一维的扰动信 号进行扩维，构建二维数据样本，能够反应扰动信号的更多细节特征，提高 了抗噪性，利用一维数据和二维数据分别训练VGGNet模型、GoogLeNet模 型和ResNet模型，从不同维度提取扰动信号特征，保证了扰动信号特征提取 的准确性，最后利用特征融合模块对多个扰动信号特征进行融合，提升了电 能质量扰动信号分类的鲁棒性，解决了现有的电能质量分类方法不能兼顾准 确性和抗干扰性，可靠性较低的技术问题。本发明实施例提供的一种电能质量扰动信号分类系统，用于执行前述电 能质量扰动信号分类方法实施例中的任一种电能质量扰动信号分类方法，可 取得与前述电能质量扰动信号分类方法实施例中的电能质量扰动信号分类方 法相同的技术效果，在此不再进行赘述。以上所述，以上实施例仅用以说明本发明的技术方案，而非对其限制； 尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应 当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其 中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案 的本质脱离本发明各实施例技术方案的精神和范围。
