标题title
一种适应现货市场交易的风储微电网分布式交易方法
摘要abst
一种适应现货市场交易的风储微电网分布式交易方法，包括以下步骤：建立配电网多时段动态重构模型；在考虑风电不确定性的基础上，建立多微网P2P能源交易模型；基于增广拉格朗日罚函数法分别松弛多微网之间的耦合约束以及多微网与配电网之间的耦合约束，将原始双层优化问题分解为多个子问题，得到双层优化模型，以实现上层配电网重构和下层多微网P2P能源交易决策一致性；在ADMM算法的基础上，引入并行求解机制，得到嵌入式并行ADMM算法，在保护个体隐私的情况下以最小信息开销迭代求解配电网最优重构方案及多微网最优交易策略。本发明不仅提高了交易方案的可实施性，而且增强了微网的自主性和交互性。
权利要求书clms
1.一种适应现货市场交易的风储微电网分布式交易方法，其特征在于，该方法包括以下步骤：S1、建立配电网多时段动态重构模型，该模型以最小化网络损耗成本、支路开关动作成本和最大化过网费收益为配电网目标函数，以Distflow潮流约束、配电网辐射结构约束、开关动作次数约束、安全运行约束、系统运行约束为配电网约束条件；S2、在考虑风电不确定性的基础上，建立多微网P2P能源交易模型，该模型以微型燃气轮机运行成本、储能设施折旧成本、与相邻微网P2P能源交易成本、与配电网功率交互成本之和期望最小为微网目标函数，以微型燃气轮机运行约束、储能设施运行约束、风电出力约束、能源交易约束、功率平衡约束为微网约束条件；S3、基于增广拉格朗日罚函数法分别松弛多微网之间的耦合约束以及多微网与配电网之间的耦合约束，将原始双层优化问题分解为多个子问题，得到双层优化模型，以实现上层配电网重构和下层多微网P2P能源交易决策一致性；S4、在ADMM算法的基础上，引入并行求解机制，得到嵌入式并行ADMM算法；基于嵌入式并行ADMM算法，在保护个体隐私的情况下以最小信息开销迭代求解配电网最优重构方案及多微网最优交易策略。2.根据权利要求1所述的一种适应现货市场交易的风储微电网分布式交易方法，其特征在于：步骤S1中，所述配电网目标函数为：式中，为配电网网络损耗成本，为支路开关动作成本，为配电系统运营商向微网收取的过网费；式中，为配电网节点和节点之间的支路，为配电网支路集合，为配电网节点集合，为时刻集合，为与配电网节点相连的微网，为与配电网节点相连的微网集合，为配电网网络损耗成本系数，为支路的电阻，为时刻流经支路的电流，为支路开关动作一次的成本系数，为时刻相对上一时刻支路开关动作次数，为过网费单位价格，为配电网与微网通过节点在时刻的总交互功率。3.根据权利要求2所述的一种适应现货市场交易的风储微电网分布式交易方法，其特征在于：步骤S1中，Distflow潮流约束为：式中，为节点的子节点，为节点的子节点集合，和分别为时刻支路发送端有功功率和无功功率，和分别为时刻支路发送端有功功率和无功功率，和分别为时刻节点注入的有功功率和无功功率，为支路的电抗；为布尔变量，表示时刻支路的开关状态，表示时刻支路开关闭合，表示时刻支路开关打开；为辅助变量，为足够大的正数，和分别为时刻节点与节点的电压幅值；配电网辐射结构约束为：式中，为布尔变量，表示时刻支路的开关状态，表示时刻支路开关闭合，表示时刻支路开关打开；为配电网中的根节点数；开关动作次数约束为：式中，为单个优化周期内支路开关动作总次数上限；安全运行约束为：式中，和分别为节点电压下限和上限；为支路允许通过的最大电流；和分别为支路有功功率下限和上限；和分别为支路无功功率下限和上限；系统运行约束为：式中，和分别为节点在时刻从主网吸收的有功功率和无功功率；和分别为节点在时刻的有功负载和无功负载；为公共耦合节点PCC有功功率传输上限。4.根据权利要求3所述的一种适应现货市场交易的风储微电网分布式交易方法，其特征在于：步骤S2中，所述微网目标函数为：式中，为风电出力场景，为微网内部风电出力场景集合，为场景对应的概率，为微网内微型燃气轮机发电成本，为微网内储能设施发电折旧成本，为微网与相邻微网P2P交易成本，为微网从配电网购电成本或向配电网售电所得收益，为微网传递能源交易所需过网费；式中，为微网内部微型燃气轮机发电系数，为微网内部微型燃气轮机在场景下时刻的发电功率，为微网内部储能设施充放电损耗成本系数，和分别为微网内部储能设施在场景下时刻的充电功率和放电功率，为微网和微网之间P2P能源交易价格；为微网和微网在时刻的P2P能源交易量，表示微网在时刻从微网购电，表示微网在时刻向微网售电；和分别为微网从配电网购电价格和向配电网售电价格，和分别为微网在时刻从配电网购电量和向配电网售电量，为微网在时刻总功率交易量。5.根据权利要求4所述的一种适应现货市场交易的风储微电网分布式交易方法，其特征在于：步骤S2中，微型燃气轮机运行约束为：式中，和分别为微网内部微型燃气轮机出力上限和下限，为微网内部微型燃气轮机的爬坡上限；储能设施运行约束为：式中，为微网内部储能设施在场景下时刻的储能等级，和分别为微网内部储能设施充电效率和放电效率，为时间间隔，和分别为微网内部储能设施充电功率和放电功率的最大值，和分别为微网内部储能设施容量的下限和上限；风电出力约束为：式中，和分别为微网内部风机在场景下时刻风电的实际出力和风电预测值；能源交易约束为：式中，为微网和微网在时刻的P2P能源交易量，为微网和微网之间P2P交易的最大值，和分别为微网从配电网购电和向配电网售电的最大值；功率平衡约束为：式中，为微网在时刻的功率负载。6.根据权利要求5所述的一种适应现货市场交易的风储微电网分布式交易方法，其特征在于：步骤S3中，双层优化模型中，配电网目标函数为：微网目标函数为：式中，为内循环ADMM迭代次数，即多微网之间ADMM迭代次数；为外循环迭代次数，即多微网与配电网之间ADMM迭代次数；和分别为内循环ADMM第次迭代时微网和微网在时刻的功率交互，和分别为内循环和外循环的拉格朗日乘子，和分别为内循环和外循环的二次项罚函数，为外循环ADMM第次迭代时配电网在时刻的节点流出功率，为外循环ADMM第次迭代时微网在时刻的总交互功率，为二范数的平方。7.根据权利要求6所述的一种适应现货市场交易的风储微电网分布式交易方法，其特征在于：步骤S4中，引入中间变量彻底分离配电网和多微网间的一致性约束：式中，为外循环ADMM第次迭代时配电网在时刻的节点流出功率，为外循环ADMM第次迭代时微网在时刻的总交互功率，和分别为针对上层配电网和下层多微网的中间变量；扩展对偶变量，将增广拉格朗日函数线性项和二次项以下述形式组合在一起：式中，和分别为对于配电网和微网的扩展对偶变量；则配电网目标函数变换为：微网目标函数变换为：。8.根据权利要求7所述的一种适应现货市场交易的风储微电网分布式交易方法，其特征在于：步骤S4中，基于嵌入式并行ADMM算法求解双层优化问题，判断是否满足收敛条件，具体流程如下：a、数据下载：读入配电网节点负载、网络拓扑；多微网内部分布式发电机组参数、负载需求以及风力预测数据；b、初始化：设定内循环和外循环增广拉格朗日乘子分别为和；设定内循环和外循环二次项罚函数分别为和；设定内循环和外循环收敛精度分别为和；设定内循环和外循环迭代指数分别为和；c、外循环优化问题求解：接收到中间变量后，配电系统运营商求解上层优化问题；d、内循环优化问题求解：接收到中间变量后，微网求解下层优化问题；e、内循环判敛：多微网相互传递期望交易功率，若收敛条件满足下式，则内循环停止迭代，否则，继续执行步骤f；f、内循环信息更新：令，根据下式更新内循环增广拉格朗日乘子以及二次项罚函数，返回步骤d；式中，为罚函数更新步长；g、外循环判敛：若收敛条件满足下式，则外循环停止迭代，否则，继续执行步骤h；h、外循环信息更新：令，根据下式更新对偶扩展变量，返回步骤b，直到满足外循环收敛条件；。
说明书desc
技术领域本发明涉及电力系统优化调度领域，尤其涉及一种适应现货市场交易的风储微电网分布式交易方法。背景技术微网传统的单一运行模式忽略了微网间的互联互济，无法为上级电网安全稳定运行提供支撑。因此，将局部区域内邻近微网组成互联多微网系统，一方面能够提高电力系统运行稳定性和可靠性，另一方面可以缓解分布式发电与需求不匹配等问题，实现发电资源优势互补，降低互联系统总运营成本。可再生能源的随机性使得多微网运营和交易过程大大复杂化。此外，随着微网在配网侧的接入，如何在满足配电网潮流约束的基础上响应多微网短期交易诉求成为关键问题。然而，多微网P2P能源交易会对配电网运行造成影响，这反过来不可避免会影响多微网能源交易过程。因此，为了降低优化过程的复杂性，现有的多微网P2P交易优化方法大多假设可再生能源出力是固定的，同时将配电网模型进行简化，忽略配电网潮流约束，这无疑会降低求解方案的可实施性。此外，常规验证性潮流模型中固定的网络拓扑导致多微网交易方案受到配电网调度需求影响，降低了微网的自主性和交互性。发明内容本发明的目的是克服现有技术中存在的可实施性差、微网的自主性和交互性差的缺陷与问题，提供一种可实施性好、微网的自主性和交互性好的适应现货市场交易的风储微电网分布式交易方法。为实现以上目的，本发明的技术解决方案是：一种适应现货市场交易的风储微电网分布式交易方法，该方法包括以下步骤：S1、建立配电网多时段动态重构模型，该模型以最小化网络损耗成本、支路开关动作成本和最大化过网费收益为配电网目标函数，以Distflow潮流约束、配电网辐射结构约束、开关动作次数约束、安全运行约束、系统运行约束为配电网约束条件；S2、在考虑风电不确定性的基础上，建立多微网P2P能源交易模型，该模型以微型燃气轮机运行成本、储能设施折旧成本、与相邻微网P2P能源交易成本、与配电网功率交互成本之和期望最小为微网目标函数，以微型燃气轮机运行约束、储能设施运行约束、风电出力约束、能源交易约束、功率平衡约束为微网约束条件；S3、基于增广拉格朗日罚函数法分别松弛多微网之间的耦合约束以及多微网与配电网之间的耦合约束，将原始双层优化问题分解为多个子问题，得到双层优化模型，以实现上层配电网重构和下层多微网P2P能源交易决策一致性；S4、在ADMM算法的基础上，引入并行求解机制，得到嵌入式并行ADMM算法；基于嵌入式并行ADMM算法，在保护个体隐私的情况下以最小信息开销迭代求解配电网最优重构方案及多微网最优交易策略。步骤S1中，所述配电网目标函数为：式中，为配电网网络损耗成本，为支路开关动作成本，为配电系统运营商向微网收取的过网费；式中，为配电网节点和节点之间的支路，为配电网支路集合，为配电网节点集合，为时刻集合，为与配电网节点相连的微网，为与配电网节点相连的微网集合，为配电网网络损耗成本系数，为支路的电阻，为时刻流经支路的电流，为支路开关动作一次的成本系数，为时刻相对上一时刻支路开关动作次数，为过网费单位价格，为配电网与微网通过节点在时刻的总交互功率。步骤S1中，Distflow潮流约束为：式中，为节点的子节点，为节点的子节点集合，和分别为时刻支路发送端有功功率和无功功率，和分别为时刻支路发送端有功功率和无功功率，和分别为时刻节点注入的有功功率和无功功率，为支路的电抗；为布尔变量，表示时刻支路的开关状态，表示时刻支路开关闭合，表示时刻支路开关打开；为辅助变量，为足够大的正数，和分别为时刻节点与节点的电压幅值；配电网辐射结构约束为：式中，为布尔变量，表示时刻支路的开关状态，表示时刻支路开关闭合，表示时刻支路开关打开；为配电网中的根节点数；开关动作次数约束为：式中，为单个优化周期内支路开关动作总次数上限；安全运行约束为：式中，和分别为节点电压下限和上限；为支路允许通过的最大电流；和分别为支路有功功率下限和上限；和分别为支路无功功率下限和上限；系统运行约束为：式中，和分别为节点在时刻从主网吸收的有功功率和无功功率；和分别为节点在时刻的有功负载和无功负载；为公共耦合节点PCC有功功率传输上限。步骤S2中，所述微网目标函数为：式中，为风电出力场景，为微网内部风电出力场景集合，为场景对应的概率，为微网内微型燃气轮机发电成本，为微网内储能设施发电折旧成本，为微网与相邻微网P2P交易成本，为微网从配电网购电成本或向配电网售电所得收益，为微网传递能源交易所需过网费；式中，为微网内部微型燃气轮机发电系数，为微网内部微型燃气轮机在场景下时刻的发电功率，为微网内部储能设施充放电损耗成本系数，和分别为微网内部储能设施在场景下时刻的充电功率和放电功率，为微网和微网之间P2P能源交易价格；为微网和微网在时刻的P2P能源交易量，表示微网在时刻从微网购电，表示微网在时刻向微网售电；和分别为微网从配电网购电价格和向配电网售电价格，和分别为微网在时刻从配电网购电量和向配电网售电量，为微网在时刻总功率交易量。步骤S2中，微型燃气轮机运行约束为：式中，和分别为微网内部微型燃气轮机出力上限和下限，为微网内部微型燃气轮机的爬坡上限；储能设施运行约束为：式中，为微网内部储能设施在场景下时刻的储能等级，和分别为微网内部储能设施充电效率和放电效率，为时间间隔，和分别为微网内部储能设施充电功率和放电功率的最大值，和分别为微网内部储能设施容量的下限和上限；风电出力约束为：式中，和分别为微网内部风机在场景下时刻风电的实际出力和风电预测值；能源交易约束为：式中，为微网和微网在时刻的P2P能源交易量，为微网和微网之间P2P交易的最大值，和分别为微网从配电网购电和向配电网售电的最大值；功率平衡约束为：式中，为微网在时刻的功率负载。步骤S3中，双层优化模型中，配电网目标函数为：微网目标函数为：式中，为内循环ADMM迭代次数，即多微网之间ADMM迭代次数；为外循环迭代次数，即多微网与配电网之间ADMM迭代次数；和分别为内循环ADMM第次迭代时微网和微网在时刻的功率交互，和分别为内循环和外循环的拉格朗日乘子，和分别为内循环和外循环的二次项罚函数，为外循环ADMM第次迭代时配电网在时刻的节点流出功率，为外循环ADMM第次迭代时微网在时刻的总交互功率，为二范数的平方。步骤S4中，引入中间变量彻底分离配电网和多微网间的一致性约束：式中，为外循环ADMM第次迭代时配电网在时刻的节点流出功率，为外循环ADMM第次迭代时微网在时刻的总交互功率，和分别为针对上层配电网和下层多微网的中间变量；扩展对偶变量，将增广拉格朗日函数线性项和二次项以下述形式组合在一起：式中，和分别为对于配电网和微网的扩展对偶变量；则配电网目标函数变换为：微网目标函数变换为：。步骤S4中，基于嵌入式并行ADMM算法求解双层优化问题，判断是否满足收敛条件，具体流程如下：a、数据下载：读入配电网节点负载、网络拓扑；多微网内部分布式发电机组参数、负载需求以及风力预测数据；b、初始化：设定内循环和外循环增广拉格朗日乘子分别为和；设定内循环和外循环二次项罚函数分别为和；设定内循环和外循环收敛精度分别为和；设定内循环和外循环迭代指数分别为和；c、外循环优化问题求解：接收到中间变量后，配电系统运营商求解上层优化问题；d、内循环优化问题求解：接收到中间变量后，微网求解下层优化问题；e、内循环判敛：多微网相互传递期望交易功率，若收敛条件满足下式，则内循环停止迭代，否则，继续执行步骤f；f、内循环信息更新：令，根据下式更新内循环增广拉格朗日乘子以及二次项罚函数，返回步骤d；式中，为罚函数更新步长；g、外循环判敛：若收敛条件满足下式，则外循环停止迭代，否则，继续执行步骤h；h、外循环信息更新：令，根据下式更新对偶扩展变量，返回步骤b，直到满足外循环收敛条件；。与现有技术相比，本发明的有益效果为：本发明一种适应现货市场交易的风储微电网分布式交易方法中，首先，提出了一种双层分布式交易架构，上层实现了配电网最优拓扑规划，下层降低了不确定性对多微网交易的影响；其次，提出的交易模型能够保证多微网与配电网之间的买卖电，多微网之间P2P的能源交易全部通过配电网传输并且满足交流潮流约束，符合实际场景；再次，通过嵌入式并行ADMM算法，即多微网与配电网之间分布式交易以及多微网之间的分布式交易，增强了微网的自主性以及微网之间的交互性；最后，这种双层分布式交易框架能够在上层保证配电系统安全运行、最小化网损，下层考虑风电不确定性的情况下给出多微网之间准确的能源交易量，增强交易模型与实际应用的契合度，从而提高所得交易方案的可实施性。附图说明图1是本发明一种适应现货市场交易的风储微电网分布式交易方法的流程图。图2是本发明中嵌入式并行ADMM算法的流程图。图3是本发明的实施例中带有三微网的IEEE33节点配电网网络结构拓扑图。图4是本发明的实施例中各微网负载曲线图。图5是本发明的实施例中微网1风电随机场景曲线图。图6是本发明的实施例中微网2风电随机场景曲线图。图7是本发明的实施例中微网3风电随机场景曲线图。图8是本发明的实施例中各微网P2P能源交易曲线图。图9是本发明的实施例中配电网支路开关动态变化图。图10是本发明的实施例中内循环误差演变图。图11是本发明的实施例中外循环误差演变图。具体实施方式以下结合附图说明和具体实施方式对本发明作进一步详细的说明。参见图1、图3，一种适应现货市场交易的风储微电网分布式交易方法，该方法包括以下步骤：S1、建立配电网多时段动态重构模型，该模型以最小化网络损耗成本、支路开关动作成本和最大化过网费收益为配电网目标函数，以Distflow潮流约束、配电网辐射结构约束、开关动作次数约束、安全运行约束、系统运行约束为配电网约束条件；所述配电网目标函数为：式中，为配电网网络损耗成本，为支路开关动作成本，为配电系统运营商向微网收取的过网费；式中，为配电网节点和节点之间的支路，为配电网支路集合，为配电网节点集合，为时刻集合，为与配电网节点相连的微网，为与配电网节点相连的微网集合，为配电网网络损耗成本系数，为支路的电阻，为时刻流经支路的电流，为支路开关动作一次的成本系数，为时刻相对上一时刻支路开关动作次数，为过网费单位价格，为配电网与微网通过节点在时刻的总交互功率；Distflow潮流约束为：式中，为节点的子节点，为节点的子节点集合，和分别为时刻支路发送端有功功率和无功功率，和分别为时刻支路发送端有功功率和无功功率，和分别为时刻节点注入的有功功率和无功功率，为支路的电抗；为布尔变量，表示时刻支路的开关状态，表示时刻支路开关闭合，表示时刻支路开关打开；为辅助变量，为足够大的正数，和分别为时刻节点与节点的电压幅值；配电网辐射结构约束为：式中，为布尔变量，表示时刻支路的开关状态，表示时刻支路开关闭合，表示时刻支路开关打开；为配电网中的根节点数；开关动作次数约束为：式中，为单个优化周期内支路开关动作总次数上限；配电网支路开关动态变化如图9所示；安全运行约束为：式中，和分别为节点电压下限和上限；为支路允许通过的最大电流；和分别为支路有功功率下限和上限；和分别为支路无功功率下限和上限；系统运行约束为：式中，和分别为节点在时刻从主网吸收的有功功率和无功功率；和分别为节点在时刻的有功负载和无功负载；为公共耦合节点PCC有功功率传输上限；S2、在考虑风电不确定性的基础上，建立多微网P2P能源交易模型，该模型以微型燃气轮机运行成本、储能设施折旧成本、与相邻微网P2P能源交易成本、与配电网功率交互成本之和期望最小为微网目标函数，以微型燃气轮机运行约束、储能设施运行约束、风电出力约束、能源交易约束、功率平衡约束为微网约束条件；所述微网目标函数为：式中，为风电出力场景，为微网内部风电出力场景集合，为场景对应的概率，为微网内微型燃气轮机发电成本，为微网内储能设施发电折旧成本，为微网与相邻微网P2P交易成本，为微网从配电网购电成本或向配电网售电所得收益，为微网传递能源交易所需过网费；式中，为微网内部微型燃气轮机发电系数，；为微网内部微型燃气轮机在场景下时刻的发电功率；为微网内部储能设施充放电损耗成本系数，；和分别为微网内部储能设施在场景下时刻的充电功率和放电功率，为微网和微网之间P2P能源交易价格；为微网和微网在时刻的P2P能源交易量，表示微网在时刻从微网购电，表示微网在时刻向微网售电；和分别为微网从配电网购电价格和向配电网售电价格，和分别为微网在时刻从配电网购电量和向配电网售电量，为微网在时刻总功率交易量；微型燃气轮机运行约束为：式中，和分别为微网内部微型燃气轮机出力上限和下限，，；为微网内部微型燃气轮机的爬坡上限，；储能设施运行约束为：式中，为微网内部储能设施在场景下时刻的储能等级；和分别为微网内部储能设施充电效率和放电效率，，；为时间间隔；和分别为微网内部储能设施充电功率和放电功率的最大值，，；和分别为微网内部储能设施容量的下限和上限，，；风电出力约束为：式中，和分别为微网内部风机在场景下时刻风电的实际出力和风电预测值，各微网风电随机场景曲线如图5、图6、图7所示；能源交易约束为：式中，为微网和微网在时刻的P2P能源交易量；为微网和微网之间P2P交易的最大值，；和分别为微网从配电网购电和向配电网售电的最大值，，；各微网P2P能源交易曲线如图8所示；功率平衡约束为：式中，为微网在时刻的功率负载，各微网负载曲线如图4所示；S3、基于增广拉格朗日罚函数法分别松弛多微网之间的耦合约束以及多微网与配电网之间的耦合约束，将原始双层优化问题分解为多个规模较小变量较少的子问题，得到双层优化模型，以实现上层配电网重构和下层多微网P2P能源交易决策一致性；双层优化模型中，配电网目标函数为：微网目标函数为：式中，为内循环ADMM迭代次数，即多微网之间ADMM迭代次数；为外循环迭代次数，即多微网与配电网之间ADMM迭代次数；和分别为内循环ADMM第次迭代时微网和微网在时刻的功率交互，和分别为内循环和外循环的拉格朗日乘子，和分别为内循环和外循环的二次项罚函数，为外循环ADMM第次迭代时配电网在时刻的节点流出功率，为外循环ADMM第次迭代时微网在时刻的总交互功率，为二范数的平方；S4、在ADMM算法的基础上，引入并行求解机制，得到嵌入式并行ADMM算法，以实现上下层高效并行求解；基于嵌入式并行ADMM算法，在保护个体隐私的情况下以最小信息开销迭代求解配电网最优重构方案及多微网最优交易策略；引入中间变量彻底分离配电网和多微网间的一致性约束：式中，为外循环ADMM第次迭代时配电网在时刻的节点流出功率，为外循环ADMM第次迭代时微网在时刻的总交互功率，和分别为针对上层配电网和下层多微网的中间变量；扩展对偶变量，将增广拉格朗日函数线性项和二次项以下述形式组合在一起：式中，和分别为对于配电网和微网的扩展对偶变量；则配电网目标函数变换为：微网目标函数变换为：参见图2，基于嵌入式并行ADMM算法求解双层优化问题，判断是否满足收敛条件，具体流程如下：a、数据下载：读入配电网节点负载、网络拓扑；多微网内部分布式发电机组参数、负载需求以及风力预测数据；b、初始化：设定内循环和外循环增广拉格朗日乘子分别为和；设定内循环和外循环二次项罚函数分别为和；设定内循环和外循环收敛精度分别为和；设定内循环和外循环迭代指数分别为和；c、外循环优化问题求解：接收到中间变量后，配电系统运营商求解上层优化问题；d、内循环优化问题求解：接收到中间变量后，微网求解下层优化问题；e、内循环判敛：多微网相互传递期望交易功率，若收敛条件满足下式，则内循环停止迭代，否则，继续执行步骤f；f、内循环信息更新：令，根据下式更新内循环增广拉格朗日乘子以及二次项罚函数，返回步骤d；式中，为罚函数更新步长；g、外循环判敛：若收敛条件满足下式，则外循环停止迭代，否则，继续执行步骤h；h、外循环信息更新：令，根据下式更新对偶扩展变量，返回步骤b，直到满足外循环收敛条件；。内循环误差演变如图10所示，外循环误差演变如图11所示。根据配电网与多微网交互关系，搭建双层能源交易模型；在上层，将传统配电网验证性最优潮流模型转化为以用户为中心和以交易为导向的动态网络重构模型；在下层，风力发电的不确定性被整合到微网运行模型中，并通过随机规划方法解决；基于增广拉格朗日罚函数法分别松弛多微网之间以及多维网与配电网之间的耦合变量，建立所有实体之间的全局分布式交易机制，实现上层配电网重构和下层多微网P2P交易决策一致性；利用并行ADMM算法，在保护个体隐私的情况下以最小信息开销迭代求解配电网最优重构方案及多微网最优交易策略。在多微网运营交易研究中增强交易模型与实际应用的契合程度，充分考虑可再生能源的随机性及多微网与配电网之间的相互作用，对于电力系统建设具有重要意义。此外，在确保多微网自主性和隐私性的前提下，求解能够满足配电网潮流约束并免疫可再生能源的不确定性的多微网最优交易方案，具有重要的现实意义。
