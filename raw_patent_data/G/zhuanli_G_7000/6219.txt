标题title
物联网智能感知终端系统
摘要abst
一种物联网智能感知终端系统，包括：智能感知层、计算融合交互层、通讯层、云端应用层，其中：智能感知层采集外界信息并输出至计算融合交互层；计算融合交互层对输入信号进行计算分析并做出决策，当单一终端能够完成数据处理时交由该终端的计算融合交互层继续进行处理，通讯层将处理结果输出至终端的对外通信接口用于与云端应用层通信；当单一终端不能完成数据处理时，由计算融合交互层将大任务分配至各个终端以协同处理任务，进行任务分配的终端再采集各个协同处理任务的处理结果，通过通讯层将计算结果输出至云端应用层。本发明突破物联网原有三层架构，通过增强终端的计算能力来提高端处理和端与端协同能力，构建本地感知、计算融合协同、传输和应用一体化的四层架构。
权利要求书clms
1.一种物联网智能感知终端系统，其特征在于，包括：智能感知层、计算融合交互层、通讯层、云端应用层，其中：智能感知层采集外界信息并输出至计算融合交互层；计算融合交互层对输入信号进行计算分析并做出决策，当单一终端能够完成数据处理时交由该终端的计算融合交互层继续进行处理，通讯层将处理结果输出至终端的对外通信接口用于与云端应用层通信；当单一终端不能完成数据处理时，由计算融合交互层将大任务分配至各个终端以协同处理任务，进行任务分配的终端再采集各个协同处理任务的处理结果，通过通讯层将计算结果输出至云端应用层；所述的智能感知层包括：智能传感单元、可重构的接口单元和FPGA局部自主重构单元；所述的智能传感单元包括：环境传感器、能源传感器、交通传感器和安防传感器；所述的接口单元包括：模拟信号接口、I/O接口、UART接口、SPI接口、I2C接口、RS485接口、DCMI接口、RS232接口、CAN接口；所述的通信层包括：终端与云端应用层通信的接口；所述的云端应用层包括：云计算平台和满足不同应用场景下的各种功能部件，如实时监控部件、能源调节部件、检测预警部件。2.根据权利要求1所述的物联网智能感知终端系统，其特征是，所述的FPGA局部自主重构单元包括：SoC板卡、内存、电源、ICAP、SD卡、I/O接口、PCIe高速收发器以及局部自主重构FPGA，其中：I/O接口为动态可重构接口，外部设备与对应的I/O接口按需接入，SoC板卡根据接入I/O接口的信息对I/O接口逻辑区域进行重构，之后智能感知终端便通过SoC的控制与外部设备进行通信；动态区域的功能应用局部可重构技术，计算任务功能和与接入设备匹配的I/O接口逻辑按需进行重配置，可提高FPGA的资源利用率。3.根据权利要求1所述的物联网智能感知终端系统，其特征是，所述的局部自主重构FPGA为基于FPGA的OPC，包括：一个片上微处理器MicroBlaze，所需IP核以外设形式挂接在PLB总线上，LMB总线连接MicroBlaze与FPGA片内BRAM；MicroBlaze作为系统的自重构控制器，在CF控制器System ACE和重构控制器HWICAP的配合下完成自重构或局部重构。4.根据权利要求3所述的物联网智能感知终端系统，其特征是，所述的自重构是指：将生成的合并软件和硬件信息的全局初始化配置文件由bit格式转换成ace格式，然后将此ace文件和部分配置位流文件存储于CF存储卡中；开发板上电后，System ACE控制器通过JTAG端口读取CF存储卡上的ace文件，全局初始化FPGA配置；当需改变系统部分功能，MicroBlaze发送重构命令给HWICAP，System ACE从外部CF存储卡读取相应部分配置位流并由HWICAP将其配置到FPGA相应可重构分区，完成FPGA重构；UART连接云端应用层，观察系统输出并根据输出内容调试系统。5.根据权利要求3所述的物联网智能感知终端系统，其特征是，所述的局部重构是指：系统运行过程中保持部分资源不变，只对待重构部分进行部分硬件逻辑功能的修改，具体通过预先对整个系统进行划分，将反复切换使用的硬件任务作为动态部分可重构模块，其他部分作为静态模块，并在可编程逻辑器件上划分出要经常被修改的区域；由于动态部分可重构系统只修改系统中部分动态可重构模块，未修改部分保持正常运行，在满足终端系统不同功能需求的同时，减少重构数据配置量、缩小重构范围，提高配置速度的同时缩短系统重构时间。6.根据权利要求1所述的物联网智能感知终端系统，其特征是，所述的计算融合交互层包括：SoC资源池单元、SoC板卡资源池单元、计算加速板卡资源单元，其中：SoC资源池单元接收智能感知层传递来的信息后，进行基本的计算处理，并将初步计算结果传递至SoC板卡资源池单元中，由SoC板卡资源池单元中的分布式自主协同单元根据初步计算结果判断该数据处理任务的处理机制；当单终端完成数据处理，则初步处理结果由该终端内的SoC资源池单元和计算加速板卡资源单元共同完成数据处理；当需要多终端协同完成数据处理，分布式自主协同单元则将数据处理任务分散到各个终端，由各个终端内部的SoC资源池单元和计算加速板卡资源单元协同完成数据处理后，再将处理结果送回源终端；所述的计算加速板卡资源单元由多个SoC板卡资源池组成，为加快终端内数据处理的速度提供支持。7.根据权利要求1所述的物联网智能感知终端系统，其特征是，所述的智能感知层和计算融合交互层中均设有SoC芯片，该SoC芯片采用开源RISC-V架构设计SoC芯片，满足开源需求，具备低功耗运行特性。8.根据权利要求1所述的物联网智能感知终端系统，其特征是，所述的SoC资源池包括：RV321、RV32D、RV32F、RV32P指令集，以电能参数计算为例，主要负责完成具有电压和电流的有效值、均值、峰值、有功功率、无功功率、视在功率、频率、谐波有效值、相角及含有率、总谐波失真以及三相总电能和功率因数电能和电能质量参数计算初步数据和计算功能。9.根据权利要求1所述的物联网智能感知终端系统，其特征是，所述的SoC板卡资源池包括：SoC芯片和分布式自主协同单元，其中：分布式自主协同单元首先通过资源分析算法汇总出目前闲置的资源；其次需求分析算法将对新加入的任务进行模块分解、资源核算；最后，配对分析算法将闲置的硬件与新任务优先配对，进一步再考虑操作系统的支持完成配对。10.根据权利要求1所述的物联网智能感知终端系统，其特征是，当有多个终端满足新任务要求，则继续核算功耗、实时性指标；如果没有终端满足新任务的加入，则考虑降低新任务的计算频率，重新进行上述核算，或将新任务转移到下一个邻近子区域进行上述核算；在新任务和某一终端完成配对后，物联网架构将进行重构，新任务在新的终端执行，原终端故障退出或执行其他任务；终端上将执行新任务载入，对通讯接口、存储空间、计算部件、SoC占用将进行一次重新重构；操作系统也将针对新任务进行重新重构。
说明书desc
技术领域本发明涉及的是一种物联网领域的技术，具体是一种物联网智能感知终端系统。背景技术目前基于云的集中式大数据处理方式，无法满足万物互联条件下的实时性、隐私保护和低能耗需求，进而会出现数据堵塞、维数灾难、云端的通讯处理能力达到瓶颈多种问题，无法适应具有海量多源异构数据的智慧城市应用场景，无法满足物联网发展需求。现有感知终端功能都被定义为收集原始数据，接收控制信息以及通过物联网网关发送数据，并不具备运算、决策功能，碎片化严重，不具备增减特性和可替换特性，仅有的三层架构对解决终端软硬件碎片化难题的支撑作用不足。发明内容本发明针对现有智能感知终端从功能和形态到基础软硬件碎片化的问题，提出一种物联网智能感知终端系统，采用平台化设计的RISC-V SoC系列芯片满足开源指标，通过不同的总线连接方式接入存储器、高速和低速外设、扩展板卡，实现可裁剪和可重构的功能，支持超过15种传感器的接入，采用标准化和模块化设计方法，突破物联网原有三层架构，通过增强终端的计算能力来提高端处理和端与端协同能力，构建本地感知、计算融合协同、传输和应用一体化的四层架构。本发明是通过以下技术方案实现的：本发明包括：智能感知层、计算融合交互层、通讯层、云端应用层，其中：智能感知层采集外界信息并输出至计算融合交互层；计算融合交互层对输入信号进行计算分析并做出决策，当单一终端能够完成数据处理时交由该终端的计算融合交互层继续进行处理，通讯层将处理结果输出至终端的对外通信接口用于与云端应用层通信；当单一终端不能完成数据处理时，由计算融合交互层将大任务分配至各个终端以协同处理任务，进行任务分配的终端再采集各个协同处理任务的处理结果，通过通讯层将计算结果输出至云端应用层。技术效果本发明整体解决现有物联网感知终端的主要功能都被定义为收集原始数据、接收控制信息、基于通过物联网网关发送数据，并不具备运算、决策功能的缺陷。与现有技术相比，本发明采用标准化和模块化设计方法，突破物联网原有三层架构，通过增强终端的计算能力提高端处理和端与端协同能力，构建本地感知、计算融合协同、传输与应用一体化的四层架构。附图说明图1为物联网智能感知终端系统图；图2为物联网智能感知终端系统运行流程图；图3为基于FPGA局部自主重构单元框架图；图4为FPGA自主重构原理图；图5为FPGA的局部重构运行流程图；图6为SoC芯片整体框图；图7为分布式自主协同单元基本运行流程图。具体实施方式如图1和图2所示，为本实施例涉及的一种物联网智能感知终端系统，包括：智能感知层、计算融合交互层、通讯层和云端应用层，其中：智能感知层中的智能传感单元采集外部环境信息，将被测物理量转换为电信号，FPGA局部自主重构单元对智能传感器接口进行重构后，电信号通过接口单元输出至计算融合交互层；计算融合交互层中的SoC资源池单元对传感器输入信号作初步的计算处理，将计算结果输出至SoC板卡资源池单元中，由SoC板卡资源池单元中的分布式自主协同单元根据初步计算结果判断该数据处理任务的处理机制；当单终端可以完成数据处理，则初步处理结果由该终端内的SoC资源池单元和计算加速板卡资源单元共同完成数据处理；当需要多终端协同完成数据处理，分布式自主协同单元则将数据处理任务分散到各个终端，由各个终端内部的SoC资源池单元和计算加速板卡资源单元协同完成数据处理后，再将处理结果送回源终端。所述的智能感知层包括：智能传感单元、可重构的接口单元和FPGA局部自主重构单元。所述的智能传感单元包括：环境传感器、能源传感器、交通传感器和安防传感器。所述的接口单元包括：模拟信号接口、I/O接口、UART接口、SPI接口、I2C接口、RS485接口、DCMI接口、RS232接口、CAN接口，可通过FPGA可重构技术满足实际情况下所需要的传感器接口需求。如图2所示，所述的FPGA局部自主重构单元包括：SoC板卡、内存、电源、ICAP、SD卡、I/O接口、PCIe高速收发器以及局部自主重构FPGA，其中：I/O接口为动态可重构接口，外部设备与对应的I/O接口按需接入，SoC板卡根据接入I/O接口的信息对I/O接口逻辑区域进行重构，之后智能感知终端便可以通过SoC的控制与外部设备进行通信。计算任务的硬件实现能够辅助SoC进行任务处理，提供计算资源。动态区域的功能应用局部可重构技术，计算任务功能和与接入设备匹配的I/O接口逻辑按需进行重配置，可提高FPGA的资源利用率。如图3所示，所述的局部自主重构FPGA为基于FPGA的OPC，包括：一个片上微处理器MicroBlaze，所需IP核以外设形式挂接在PLB总线上，LMB总线连接MicroBlaze与FPGA片内BRAM。MicroBlaze作为系统的自重构控制器，在CF控制器System ACE和重构控制器HWICAP的配合下完成自重构或局部重构。所述的自重构是指：将生成的合并软件和硬件信息的全局初始化配置文件由bit格式转换成ace格式，然后将此ace文件和部分配置位流文件存储于CF存储卡中。开发板上电后，System ACE控制器通过JTAG端口读取CF存储卡上的ace文件，全局初始化FPGA配置；当需改变系统部分功能，MicroBlaze发送重构命令给HWICAP，System ACE从外部CF存储卡读取相应部分配置位流并由HWICAP将其配置到FPGA相应可重构分区，完成FPGA重构。UART连接云端应用层，观察系统输出并根据输出内容调试系统。涉及的重构功能完全在FPGA芯片上实现，无需外界干预，实现FPGA的自重构。如图4所示，所述的局部重构是指：系统运行过程中保持部分资源不变，只对待重构部分进行部分硬件逻辑功能的修改。需要在系统设计初期对整个系统进行划分，将反复切换使用的硬件任务作为动态部分可重构模块，系统的其他部分作为静态模块，并在可编程逻辑器件上划分出要经常被修改的区域。由于动态部分可重构系统只修改系统中部分动态可重构模块，未修改部分保持正常运行，在满足终端系统不同功能需求的同时，减少重构数据配置量、缩小重构范围，提高配置速度的同时缩短系统重构时间。所述的计算融合交互层包括：SoC资源池单元、SoC板卡资源池单元、计算加速板卡资源单元，其中：SoC资源池单元接收智能感知层传递来的信息后，进行基本的计算处理，并将初步计算结果传递至SoC板卡资源池单元中，由SoC板卡资源池单元中的分布式自主协同单元根据初步计算结果判断该数据处理任务的处理机制；当单终端可以完成数据处理，则初步处理结果由该终端内的SoC资源池单元和计算加速板卡资源单元共同完成数据处理；当需要多终端协同完成数据处理，分布式自主协同单元则将数据处理任务分散到各个终端，由各个终端内部的SoC资源池单元和计算加速板卡资源单元协同完成数据处理后，再将处理结果送回源终端。所述的智能感知层和计算融合交互层中均设有如图5所示的SoC芯片，该SoC芯片采用开源RISC-V架构设计SoC芯片，满足开源需求，具备低功耗运行特性。所述的开源RISC-V架构根据各个功能单元工作时不同时钟频率要求，包括：常开域、主域、调试域三部分平台功能区。不同平台化功能区布置有各类功能单元，一般常开域布置RTC、WatchDog、PMU功能单元。主域为芯片的主体，布置处理器核、协处理器、片上总线控制器以及通过片上协议总线连接的ROM、RAM存储单元以及GPIO、UART、SPI接口单元。这些功能单元可以调整、扩展与去除。再次处理器核也完成指令集调整、扩展与精简、多核扩展平台化设计。在电源管理方面，可以对同一时钟域划分为不同的供电域，或简化功耗管理将不同的时钟域合并为同一个供电域。以基于开源RISC-V指令集的处理器核和总线为核心，搭载存储空间和外设接口，并配备电源管理和调试接口。配置10种以上数据接口，如GPIO、UART、SPI、I2C，ADC、CAN、USB2.0、DMA、EXMC、Ethernet。所述的SoC资源池包括：RV321、RV32D、RV32F、RV32P指令集，以电能参数计算为例，主要负责完成具有电压和电流的有效值、均值、峰值、有功功率、无功功率、视在功率、频率、谐波有效值、相角及含有率、总谐波失真以及三相总电能和功率因数电能和电能质量参数计算初步数据和计算功能。如图6所示，所述的SoC板卡资源池包括：SoC芯片和分布式自主协同单元，其中：分布式自主协同单元首先通过资源分析算法汇总出目前闲置的资源；其次需求分析算法将对新加入的任务进行模块分解、资源核算；最后，配对分析算法将闲置的硬件与新任务优先配对，进一步再考虑操作系统的支持完成配对。当有多个终端满足新任务要求，则继续核算功耗、实时性指标；如果没有终端满足新任务的加入，则考虑降低新任务的计算频率，重新进行上述核算，或将新任务转移到下一个邻近子区域进行上述核算。在新任务和某一终端完成配对后，物联网架构将进行重组，新任务在新的终端执行，原终端故障退出或执行其他任务；终端上将执行新任务载入，对通讯接口、存储空间、计算部件、SoC占用将进行一次重新分配；操作系统也将针对新任务进行重新规划。所述的计算加速板卡资源池由多个SoC板卡资源池组成，为加快终端内数据处理的速度提供支持。所述的通信层包括：终端与云端应用层通信的接口。所述的云端应用层包括：云计算平台和满足不同应用场景下的各种功能部件，如实时监控部件、能源调节部件、检测预警部件。经过具体实际试验，在能源类计算的具体环境设置下，以谐波参数计算为例，三相电压、电流的谐波需要计算6次FFT。当所有数据在云端计算，则通信的压力较大，需要传输三相、电压、电流的波形数据，且不能保证数据的连续。当采用单一终端计算，150MHz主频的DSP完成6次一周期的256点FFT计算需要约10毫秒，在FFT计算点数增加的情况下，耗时成倍增加。当采用本发明的多终端协同计算，进行任务分配，如共有6个终端参与计算，则上述计算时间缩短为不到2毫秒，即使点数增多，也在可控时间内。而且，计算后的数据量相比波形数据减少很多，可以降低通信网络的压力。与现有技术相比，本系统突破物联网原有三层架构，构建本地感知、计算融合协同、传输与应用一体化的四层架构。上述具体实施可由本领域技术人员在不背离本发明原理和宗旨的前提下以不同的方式对其进行局部调整，本发明的保护范围以权利要求书为准且不由上述具体实施所限，在其范围内的各个实现方案均受本发明之约束。
