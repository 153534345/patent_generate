标题title
一种基于深度学习的多震源地震数据分离方法
摘要abst
本发明公开了一种基于深度学习的多震源地震数据分离方法，属于地震数据处理技术领域；分为CNN深度学习和多震源混合数据分离两个主要步骤；将卷积神经网络深度学习技术引入到多震源地震数据的随机混叠去噪中，通过卷积神经网络提取地震数据中更复杂的数据特征，对主震源的地震信号损伤较小，去噪过程智能实现；根据多震源混合数据中随机混叠噪声的特点，采用将原始混合数据所有地震道进行随机时间编码，构建含有随机噪声分布的训练样本的输入，该训练样本来源于地震数据本身，包含了实际地震数据的波场特征，解决了深度学习在实际多震源分离应用中缺少训练样本的难题。
权利要求书clms
1.一种基于深度学习的多震源地震数据分离方法，其特征在于，包括以下步骤：S1：CNN深度学习1.1将共炮点多震源混合数据进行地震道随机时间延迟编码，并与相加得到带有随机噪音的共炮点记录，作为神经网络训练的输入Pinput；1.2将共炮点多震源混合数据作为训练标签，即神经网络训练的输出组成相应的网络训练样本对；1.3将步骤1.1和1.2得到的输入和输出的整个地震数据均分割成小数据集，作为CNN的输入层和输出层；1.4设计卷积拓扑结构的深度学习卷积神经网络：所述卷积拓扑结构分为三部分，第一部分为C1，只有一个卷积层，该卷积层经过卷积得到多个特征映射，卷积后的输出与输入的数据大小一致；第二部分为C2，有多个卷积层；第三部分为C3，只包含一个卷积层，经过卷积操作得到1个特征映射，即为网络的输出；将步骤1.3得到的输入层和输出层代入设计的卷积神经网络，训练得到训练模型Φ；S2：多震源混合地震数据分离2.1将共炮点域上的多震源混合数据按照混合超级炮中各个震源的延迟激发时间算子进行时间上的校正，得到共炮点域上的伪分离数据P′csp；2.2将共炮点域上的伪分离数据P′csp重现编排到共炮点域外的其他域中，此时主震源为连续信号，次震源为随机信号；2.3在共检波点道集P′crp中，采用训练模型Φ进行去噪，得到去噪结果Pcrp如式Pcrp＝Fpredict2.4将去噪后的共检波点域Pcrp道集重新编排到共炮点道集Pcsp，完成分离。2.根据权利要求1所述的一种基于深度学习的多震源地震数据分离方法，其特征在于，步骤1.1中，神经网络训练的输入Pinput如式：其中N为该混合炮中总的接收道数，为该混合炮的第j道，Γ'j表示第j道的随机时间编码算子，该随机延迟时间不等于实际混合采集的激发延迟算子；其中，随机时间编码算子在频域的表达式为：Γ'＝，ω为角频率，δt'j为各道的随机编码时间。3.根据权利要求1所述的一种基于深度学习的多震源地震数据分离方法，其特征在于，步骤1.3中，整个地震数据分割为大小为40×40像素的小数据集，作为CNN的输入层和输出层；为了保证分割图像的连续性，相邻的数据集之间具有30个像素的重合。4.根据权利要求1所述的一种基于深度学习的多震源地震数据分离方法，其特征在于，步骤1.4中，第一部分C1卷积层采用64个大小为3×3的卷积核，经过卷积得到64个特征映射；第二部分为C2，一共有15个卷积层，每个卷积层均由64个大小为3×3的卷积核组成；第三部分为C3，该卷积层采用1个大小为3×3的卷积核。5.根据权利要求4所述的一种基于深度学习的多震源地震数据分离方法，其特征在于，对于第一部分C1，在进行卷积运算前，对每个数据扩展边界，直接补零至与输入数据相同大小；然后将特征数据输入到激活层的激活函数ReLU，用于去除地震数据中的冗余。6.根据权利要求4所述的一种基于深度学习的多震源地震数据分离方法，其特征在于，对于第二部分C2，在卷积层和激活层之间添加了一个批归一化层，用于加快并稳定训练过程。7.根据权利要求4所述的一种基于深度学习的多震源地震数据分离方法，其特征在于，步骤2.1中，共炮点域上的伪分离数据P′csp如式：其中，表示震源i的时间延迟逆算子，在频域的表达式为：Γ-1＝，K为多震源采集的混合度，ω为角频率，δti为第i震源的延迟激发时间。
说明书desc
技术领域本发明属于地震数据处理技术领域，具体涉及一种基于卷积神经网络深度学习的多震源地震混合数据分离方法。背景技术多震源采集方式是当前地震数据采集的重大变革。目前在油气地震勘探中，多震源采集与高密度、宽方位采集方法相结合，在保证采集数据质量的同时有效提高了采集效率。但与传统单震源激发采集到的地震数据不同，多震源采集的混合记录中除了主震源记录外，还存在次级震源带来的干扰，给后续的处理和解释带来了影响。由于目前成熟的地震成像反演法等均以单震源数据体为基础，因此如何得到高精度的分离数据成为了多震源采集的关键技术之一。多震源混合数据的分离主要基于“域变换”思想，即采用随机时间延迟激发方式采集的混合数据，在去除主震源的延迟时间后，主、次级震源的同相轴在共炮点道集中均表现为相关性，而在共炮域以外的其他道集中主震源波场仍表现为相关性，而次级震源波场表现为非相关性，呈现随机分布。混合数据的分离正是利用了这一区别。目前分离方法主要有两种，基于滤波去噪分离法和基于稀疏反演分离法。这些方法往往需要人为给定一些参数。不同工区的地震数据具有不同的特点，因此对应的参数也需要根据实际工区地震数据的特点来给出，分离后的地震信号保真度受这些人为参数的影响。基于滤波去噪分离法主要是设计合适的滤波器去除随机分布的混叠噪音。目前基于滤波去噪进行多震源数据分离主要有中值滤波和曲波变换滤波相结合、多级中值滤波、多方向矢量中值滤波和S变换自适应滤波；基于稀疏反演理论的分离方法将混合数据的分离当作反问题进行求解。由于该反问题是明显的欠定问题，因此在求解过程中需加入相应的正则化约束条件，例如基于Seislet稀疏变换、低秩约束、L1范数模约束等。目前的两种多震源分离方法中，无论是基于滤波去噪法还是基于稀疏反演法，实现过程中均需要人为给定一些参数。如基于滤波去噪的方法中，不同的滤波方法需要给出相应的滤波参数：中值滤波需要给定滤波器的长度；矢量中值滤波除了要给定滤波器长度，还需要给定滤波器的方向数；曲波变换滤波需要给定稀疏域的阈值大小。同样基于反演理论的分离方法中，正则化约束条件的实现也需要给定参数：在各种稀疏变换域中实现约束，要给定阈值变换的规律、最大阈值和最小阈值，低秩约束条件中需要给定保留最大矩阵秩的阈值。这些参数均需要人为给定，一般需要根据不同的地震数据进行多次试验，选取最合适的参数。这些参数的选择直接影响着混叠噪音的去除和主震源地震信号的保真度。由于两种方法的本质都是去除由次震源带来的随机混叠噪音，因此任何去除噪音的方法都可以来进行多震源的分离。深度学习在信号去噪方面具有明显的优势，可智能化的进行去噪，可将深度学习技术应用到地震多震源的分离中，通过训练网络进行人工智能去噪。目前深度学习技术在理论合成数据的去噪中较成熟，主要原因是训练样本很容易构建。但在实际地震数据的去噪中，深度学习的训练样本尤其是标签数据很难获取，当前训练样本的获取往往通过不同主频、不同视速度同相轴的理论合成数据来构建，构建的训练样本很难包含实际混合地震数据的所有波场特征，影响了该方法的有效性。发明内容本发明克服了现有技术的不足，提出一种基于深度学习的多震源地震数据分离方法。可用来对含有混叠噪音的混合数据进行智能去噪，避免了人工参数选择对分离结果的影响，且分离后的地震数据能保留绝大部分有效信号；在构建深度学习训练样本时，采用混合数据地震道随机编码技术直接构建训练数据集的标签，解决了CNN中标签数据难获取的问题。为了达到上述目的，本发明是通过如下技术方案实现的：一种基于深度学习的多震源地震数据分离方法，包括以下步骤：S1：CNN深度学习1.1将共炮点多震源混合数据进行地震道随机时间延迟编码，并与相加得到带有随机噪音的共炮点记录，作为神经网络训练的输入Pinput。1.2将共炮点多震源混合数据作为训练标签，即神经网络训练的输出组成相应的网络训练样本对。1.3将步骤1.1和1.2得到的输入和输出的整个地震数据均分割成小数据集，作为CNN的输入层和输出层。1.4设计卷积拓扑结构的深度学习卷积神经网络：所述卷积拓扑结构分为三部分，第一部分为C1，只有一个卷积层，该卷积层经过卷积得到多个特征映射，卷积后的输出与输入的数据大小一致；第二部分为C2，有多个卷积层；第三部分为C3，只包含一个卷积层，经过卷积操作得到1个特征映射，即为网络的输出；将步骤1.3得到的输入层和输出层代入设计的卷积神经网络，训练得到训练模型Φ。S2：多震源混合地震数据分离2.1将共炮点域上的多震源混合数据按照混合超级炮中各个震源的延迟激发时间算子进行时间上的校正，得到共炮点域上的伪分离数据P’csp。2.2将共炮点域上的伪分离数据P’csp重现编排到共炮点域外的其他域中，比如共接收点域中P’crp，此时主震源为连续信号，次震源为随机信号。2.3在共检波点道集P’crp中，采用训练模型Φ进行去噪，得到去噪结果Pcrp如式Pcrp＝Fpredict 2.4将去噪后的共检波点域Pcrp道集重新编排到共炮点道集Pcsp，完成分离。进一步的，步骤1.1中，神经网络训练的输入Pinput如式：其中N为该混合炮中总的接收道数，为该混合炮的第j道，Γ’j表示第j道的随机时间编码算子，该随机延迟时间不等于实际混合采集的激发延迟算子；其中，随机时间编码算子在频域的表达式为：Γ’＝，ω为角频率，δt’j为各道的随机编码时间。进一步的，步骤1.3中，整个地震数据分割为大小为40×40像素的小数据集，作为CNN的输入层和输出层；为了保证分割图像的连续性，相邻的数据集之间具有30个像素的重合。进一步的，步骤1.4中，第一部分C1卷积层采用64个大小为3×3的卷积核，经过卷积得到64个特征映射；第二部分为C2，一共有15个卷积层，每个卷积层均由64个大小为3×3的卷积核组成；第三部分为C3，该卷积层采用1个大小为3×3的卷积核，经过卷积操作得到1个特征映射，即为网络的输出。更进一步，对于第一部分C1，为了保证卷积后的输出与输入的数据大小一致，在进行卷积运算前，对每个数据扩展边界，直接补零至与输入数据相同大小；然后将特征数据输入到激活层的激活函数ReLU，用于去除地震数据中的冗余，尽可能保留数据特征。更进一步，对于第二部分C2，在卷积层和激活层之间添加了一个批归一化层batchnormalization，用于加快并稳定训练过程。进一步的，步骤2.1中，共炮点域上的伪分离数据P’csp如式：其中，表示震源i的时间延迟逆算子，在频域的表达式为：Γ-1＝，K为多震源采集的混合度，ω为角频率，δti为第i震源的延迟激发时间。本发明相对于现有技术所产生的有益效果为：1、本发明将卷积神经网络深度学习技术引入到多震源地震数据的随机混叠去噪中，通过卷积神经网络提取地震数据中更复杂的数据特征，对主震源的地震信号损伤较小，主震源的地震信号保真度高，去噪过程智能实现，经训练好的网络可用来对含有混叠噪音的混合数据进行智能去噪，避免了人工参数选择对分离结果的影响，且分离后的地震数据能保留绝大部分有效信号。2、多震源混合数据分离中的随机噪音与常规随机噪音不同，其本身来源于次震源的地震信号。为了能够使深度学习能够应用在实际多地震混合数据的分离中，根据多震源混合数据中随机混叠噪声的特点，采用将原始混合数据所有地震道进行随机时间编码，构建含有随机噪声分布的训练样本的输入，此时混合数据本身自然成为了对应的网络输出。解决了CNN中标签数据难获取的问题，且其训练样本来自于数据本身而不是理论合成数据，可最大程度的包含混合数据的所有波场特征，因此可提高CNN深度学习在实际多震源混合数据分离中的应用性。附图说明图1是本发明所采用的多震源混合数据分离的流程图。图2是本发明所设计的卷积神经网络结构及输入输出层小数据分割示意图，该卷积神经网络结构分为三部分。第一部分为C1，只有一个卷积层，该卷积层采用64个大小为3×3的卷积核，经过卷积得到64个特征映射，然后将特征数据输入到激活层的激活函数ReLU，用于去除地震数据中的冗余，尽可能保留数据特征；第二部分为C2，一共有15个卷积层，每个卷积层均由64个大小为3×3的卷积核组成，并在卷积层和激活层之间添加了一个批归一化层batch normalization，用于加快并稳定训练过程；第三部分为C3，只包含一个卷积层，该卷积层采用1个大小为3×3的卷积核，经过卷积操作得到1个特征映射，即为网络的输出。CNN输入层和输出层均为将原始数据分割为40×40像素的小数据体集合，如图2中小框所示，且相邻小框之间有30个像素的重合。图3中a为实施例中获取合成地震记录的地质地震模型，b为实施例中混合度为2的多震源随机激发时间，c为实施例中多震源采集观测系统。图4为传统单震源激发和多震源激发的共炮点地震记录图。其中，a为第13个震源1单独激发的地震记录，b为第13个震源2单独激发的地震记录，c为第13个多震源混合激发的地震记录。图5为实施例中采用共炮点混合记录构建的其中四对训练样本输入和输出。其中为输入层数据，为对应的输出层数据。图6为实施例中某一个共炮点混合记录按照随机混合时间进行时间校正后得到的共炮点域的伪分离记录。第13个混合震源伪分离后的第一震源船第13个共炮点记录伪分离后的第二震源船第13个共炮点记录。图7为第二震源船伪分离数据从共炮点域分选到共检波点域示意图。图8为实施例中将共炮点域的伪分离地震数据分选到共检波点域的地震记录、共检波域地震记录去噪结果以及误差精度分析。第60个共检波域地震数据CNN去噪结果去除的噪音传统单震源激发的共检波域数据去噪结果b和传统单震源激发的共检波域数据d的误差误差e和数据d的局部相似性分析。图9为实施例中采用本发明得到的共炮点域的多震源分离结果。混合数据分离后的第一震源船数据分离后的第二震源船数据。具体实施方式为了使本发明所要解决的技术问题、技术方案及有益效果更加清楚明白，结合实施例和附图，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。下面结合实施例及附图详细说明本发明的技术方案，但保护范围不被此限制。通过上文对本发明内容所做的描述及下面实施例的进一步说明，采用本技术发明可以实现多震源混合数据的分离。本次实施例中，我们首先采用正演模拟方法模拟得到传统单震源激发下的地震记录，正演模拟采用模型见图3中的a所示。首先采用单震源依次激发，炮间距为20m，一共激发201炮。所有炮均由在地表固定位置的201道检波器接收地震记录，检波器道间距为20m。正演模拟得到的地震记录时间长度为3s，时间步长为0.002s。将这201个单震源地震记录当作第一震源船的地震记录。然后保持地表201个检波点位置不变，将上述的201炮的炮点位置均向右移动5m，重新正演得到另外201炮单震源地震记录，当作第二个震源船的地震记录。对两个震源船上对应的201震源进行随机时间混合，得到了混合度为2的多震源混合地震记录，一共得到201个混合记录。其中随机混合时间见图3中的b，混合方式见图3中的c。第一个震源船的激发时间全设置为0ms，第二个震源船的随机延迟时间范围设置为。图4分别为混合前的第一震源船和第二震源船的第13个单震源记录，以及混合后的第13个混合炮记录。根据本发明所述的步骤S1深度学习中的1.1，我们对每一个共炮点域混合记录中的每道记录进行随机时间延迟，再与共炮点域混合记录相加得到含有随机噪音的地震数据，一共会得到201个带有随机噪音的共炮点域记录，可作为神经网络训练的输入样本。根据本发明所述的步骤S1中的1.2，原始的共炮点域混合记录对应就成了神经网络训练的输出样本，故一共可得到201个训练样本的输入输出对。附图5为其中的第1对、第50对、第100对和第150对的网络输入和输出。根据本发明所述的步骤S1中的1.3，将201个训练样本的输入输出对分割成40×40像素的数据块，且相邻块之间具有30个像素的重复。每个地震记录的道数为201，每道的时间采样点为1501，故分割后的块数量一共有201×/10×/10＝502299个。根据本发明所述的步骤S1中的1.4，我们采用Keras深度学习框架来进行神经网络训练，设定初始学习率为1×10-3，使用Adam算法优化学习目标。批大小设置为128次，训练次数epoch设置为50。训练过程使用图形处理单元提高训练速度，GPU型号为GeForce RTX2080Ti，训练时间为38448秒。最终得到训练网络模型Φ。根据本发明所述的步骤S2中的2.1，对201个共炮点域混合记录进行伪分离。每一个混合记录按照混合源中的随机激发时间进行时间上的校正，得到2个伪分离记录。第一个对应的为第一震源船的单源记录，第二个对应的为第二震源船的单源记录。因为第一震源船的随机激发时间均为0，所以混合记录按照第一震源船的激发时间做时间上的校正后，与混合记录无任何变化；混合记录按照第二震源船的激发时间做时间上的较正后，混合记录中属于第二震源船的信号已经校正到无时间延迟，同时也将属于第一震源船的信号也校正了，整体往上移动。根据本发明所述的步骤S2中2.2，将伪分离记录从共炮点域分选到共检波点域，一共得到201个共检波点域地震记录。分选的本质就是把地震数据按照不同的空间位置进行排列。附图7为本实施例中伪分离后的第二震源船的前100个炮点域地震数据的分选示意图，每一炮201个地震道数据，每道数据1501个点。可以看到在共检波点域，主震源信号连续，次震源带来的混叠噪音呈现随机分布。根据本发明所述的步骤S2中2.3，采用步骤S1得到的深度学习网络模型Φ每一个对共检波点域的地震记录进行去噪。为了分析多震源分离的精度，我们与传统单震源激发下的共检波点域地震数据进行对比，进一步将误差和理论数据进行相似性分析，可以看到误差信号中只有很少一部分与理论数据具有较高的相似性，说明采用本发明技术方法进行去噪，保留了大部分有效信号，对连续信号的损伤较小。对201个共检波点域地震数据去噪后，根据本发明所述的步骤S2中2.4，将去噪后的共检波点域地震数据重新排列到共炮点域中，完成了多震源分离。以上内容是结合具体的优选实施方式对本发明所做的进一步详细说明，不能认定本发明的具体实施方式仅限于此，对于本发明所属技术领域的普通技术人员来说，在不脱离本发明的前提下，还可以做出若干简单的推演或替换，都应当视为属于本发明由所提交的权利要求书确定专利保护范围。
