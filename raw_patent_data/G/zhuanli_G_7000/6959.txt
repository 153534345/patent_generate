标题title
一种基于防伪图片置乱解密的商品防伪码识别方法
摘要abst
本发明公开了一种基于防伪图片置乱解密的商品防伪码识别方法，包括：将商品彩色防伪图片分解的三基色矩阵分别进行二进制转换和拼接，得到组合三维二进制矩阵并将商品彩色商标图片、商品标识码进行转换处理；混沌系统迭代得到混沌序列Y1、Y2以及矩阵行移位和列移位的参数；根据混沌序列Y1和Y2的排序置乱规则，以及矩阵行移位和列移位的参数，对矩阵依次进行置乱拼接、列移位、回填反置乱，再置乱拼接、行移位和回填反置乱操作，进而生成彩色图片CC，判断彩色图片CC与商品彩色商标图片是否一致以识别商品真伪。本发明所提的基于防伪图片置乱解密的商品防伪码识别方法简单可行、不易破解，商品防伪码的识别具有“安全性和可识别性”。
权利要求书clms
1.一种基于防伪图片置乱解密的商品防伪码识别方法，其特征在于，包括如下几个步骤：转码首先，将商品防伪二维码进行解析，得到表征某件商品唯一身份信息的商品彩色商标图片和商品标识码，以及表征商品防伪信息的彩色防伪图片，然后，将商品彩色商标图片分解出红、绿、蓝三基色，分别表示为矩阵R、G和B，并将矩阵R、G和B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和接着，将商品标识码，表示为字符串A1A2,...,AL-1AL，逐个字符转换为数值型数据，得到数值序列再将数值序列P中元素逐个转换成8位二进制，得到二进制序列最后，将彩色防伪图片分解出红、绿、蓝三基色，分别表示为矩阵C_R、C_G和C_B，并将矩阵C_R、C_G和C_B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和并将三维二进制矩阵和依次上下拼接，得到组合三维二进制矩阵其中商品彩色商标图片的大小为M×N，矩阵R、G和B的大小均为M×N，三维二进制矩阵和的行数为M、列数为N、层数为8，商品标识码来自于GBK编码的字符，商品标识码的长度为L，数值序列P的长度为二进制序列PB的长度为且彩色防伪图片的大小为M×N，矩阵C_R、C_G和C_B的大小均为M×N，三维二进制矩阵和的行数为M、列数为N、层数为8，组合三维二进制矩阵的行数为3M、列数为N、层数为8；产生混沌序列首先利用外部解密密钥，按照如下-公式分别计算得到混沌系统的初值x1、参数λ、抽取开始位置δ1和δ2，令则可得，x1＝mod+0.001，λ＝2+mod，其中，α∈，β∈，0表示统计二进制序列{PB8i-7,PB8i-6,...,PB8i-1,PB8i}中存在二进制‘0’的个数，和分别表示统计三维二进制矩阵的第i行、第j列、第1～8层中存在二进制‘1’的个数，然后由初值x1、参数λ，对如下公式所示的Chebyshev混沌系统进行迭代，k表示迭代次数，xk+1表示第k次迭代得到的混沌信号，其中k＝1,2,…，从而得到混沌序列X，xk+1＝cos) 接着从混沌序列X中抽取第δ1个元素，按照如下公式分别计算得到矩阵行移位的行数H_number以及重置抽取开始位置δ1，从混沌序列X中抽取第δ1个元素，按照如下公式分别计算得到矩阵行移位的方向H_direction、重置抽取开始位置δ1，以及行移位矩阵的层面参数H_CM，从混沌序列X中第δ1+2个元素开始连续抽取8个，得到长度为8的混沌序列最后从混沌序列X中抽取第δ2个元素，按照如下公式分别计算得到矩阵列移位的列数L_number以及重置抽取开始位置δ2，从混沌序列X中抽取第δ2个元素，按照如下公式分别计算得到矩阵列移位的方向L_direction、重置抽取开始位置δ2，以及列移位矩阵的层面参数L_CM，从混沌序列X中第δ2+2个元素开始连续抽取8个，得到长度为8的混沌序列列移位的置乱解密首先，将混沌序列Y2按降序排序，根据序列Y2排序前、后的位置变化置乱规则，对组合三维二进制矩阵元素按层进行置乱，得到置乱后的三维二进制矩阵根据列移位矩阵的层面参数L_CM，进行如下拼接操作，如果L_CM＝0，则将置乱后的三维二进制矩阵中元素逐层左右拼接，得到待列移位矩阵LRGB，表示为如果L_CM＝1，则将置乱后的三维二进制矩阵中元素逐列左右拼接，得到列移位矩阵LRGB，表示为其中待列移位矩阵LRGB的大小为3M×8N，然后，根据矩阵列移位的列数L_number以及方向L_direction，进行如下整列移位操作，如果L_direction＝0，则将待列移位矩阵LRGB整列循环右移L_number行，得到列移位后的矩阵如果L_direction＝1，则将待列移位矩阵LRGB整列循环左移L_number行，得到列移位后的矩阵最后，根据列移位矩阵的层面参数L_CM，进行如下回填操作，如果L_CM＝1，则将列移位后的矩阵中元素逐层回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到列移位后的三维二进制矩阵BL，表示为如果L_CM＝0，则将列移位后的矩阵中元素逐列回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到列移位后的三维二进制矩阵BL，表示为将混沌序列Y2按升序排序，根据序列Y2排序前、后的位置变化置乱规则，对列移位后的三维二进制矩阵BL中元素按层进行反置乱，得到反置乱后的列移位三维二进制矩阵行移位的置乱解密首先，将混沌序列Y1按降序排序，根据序列Y1排序前、后的位置变化置乱规则，对列移位三维二进制矩阵中元素按层进行置乱，得到置乱后的列移位三维二进制矩阵根据行移位矩阵的层面参数H_CM，进行如下拼接操作，如果H_CM＝0，则将列移位三维二进制矩阵中元素逐层上下拼接，得到待行移位矩阵HRGB，表示为如果H_CM＝1，则将列移位三维二进制矩阵中元素逐行上下拼接，得到待行移位矩阵HRGB，表示为其中待行移位矩阵HRGB的大小为24M×N，然后，根据矩阵行移位的行数H_number以及方向H_direction，进行如下整行移位操作，如果H_direction＝0，则将待行移位矩阵HRGB整行循环下移H_number行，得到行移位后矩阵如果H_direction＝1，则将待行移位矩阵HRGB整行循环上移H_number行，得到行移位后矩阵最后，根据行移位矩阵的层面参数H_CM，进行如下回填操作，如果H_CM＝1，则将行移位后的矩阵中元素逐层回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到行列移位三维二进制矩阵BHL，表示为如果H_CM＝0，则将行移位后的矩阵中元素逐行回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到行列移位三维二进制矩阵BHL，表示为将混沌序列Y1按升序排序，根据序列Y1排序前、后的位置变化置乱规则，对行列移位三维二进制矩阵BHL元素按层进行反置乱，得到反置乱后的行列移位三维二进制矩阵商品防伪二维码的生成由反置乱后的行列移位三维二进制矩阵分别得到数值矩阵从而生成彩色图片CC，其中矩阵的大小均为M×N，彩色图片CC的大小为M×N，再比较彩色图片CC与商品二维码解析而得的商品彩色商标图片是否一致，如一致，则商品识别为真品；如不一致，则商品识别为赝品。2.根据权利要求1所述的一种基于防伪图片置乱解密的商品防伪码识别方法，其特征在于，步骤中所述的将矩阵R、G和B中元素分别逐个转换成8位二进制，是指将矩阵R中元素逐个采用运算得到三维二进制矩阵将矩阵G中元素逐个采用运算得到三维二进制矩阵将矩阵B中元素逐个采用运算得到三维二进制矩阵3.根据权利要求1所述的一种基于防伪图片置乱解密的商品防伪码识别方法，其特征在于，步骤中所述的将商品标识码，表示为字符串A1A2,...,AL-1AL，逐个字符转换为数值型数据，是指将商品标识码中字符逐个采用unicode2native函数转换为数值型数据，即对于双字节字符的转换表示为对于单字节字符的转换表示为从而得到数值序列4.根据权利要求1所述的一种基于防伪图片置乱解密的商品防伪码识别方法，其特征在于，步骤中所述的将数值序列P中元素逐个转换成8位二进制，是指将数值序列P中元素逐个采用PB＝dec2bin运算，得到二进制序列5.根据权利要求1所述的一种基于防伪图片置乱解密的商品防伪码识别方法，其特征在于，步骤中所述的将矩阵C_R、C_G和C_B中元素分别逐个转换成8位二进制，是指将矩阵C_R中元素逐个采用运算得到三维二进制矩阵将矩阵C_G中元素逐个采用运算得到三维二进制矩阵将矩阵C_B中元素逐个采用运算得到三维二进制矩阵6.根据权利要求1所述的一种基于防伪图片置乱解密的商品防伪码识别方法，其特征在于，步骤中所述的由反置乱后的行列移位三维二进制矩阵分别得到数值矩阵从而生成彩色图片CC，表示如下步骤：步骤①将三维二进制矩阵中第1～M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤②将三维二进制矩阵中第M+1～2M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤③将三维二进制矩阵中第2M+1～3M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤④将数值矩阵分别表征彩色图片的红、绿、蓝三基色，利用函数将矩阵转换为彩色图片，从而生成彩色图片CC，其中彩色图片CC的大小为M×N。
说明书desc
技术领域本发明属于数码防伪技术领域，特别涉及一种基于防伪图片置乱解密的商品防伪码识别方法。背景技术目前市场上常用的防伪技术主要有纸纹防伪技术、激光全息防伪技术、化学油墨防伪技术、核径迹防伪技术、电码防伪技术，以及数码防伪技术等等。传统的防伪技术由于其制作工艺复杂、防伪标签鉴别不便等局限性，难以广泛应用于所有商品的真伪识别，仅局限于高端产品的真伪鉴别。由于传统防伪技术的种种缺点，数码防伪技术应运而生，已经成为了防伪行业中运用最为广泛的技术之一，在防伪领域起着举足轻重的作用。数码防伪技术包括制码和识别两部分，现今数码识别方式有多种，如一维码、二维码、RFID识别等。传统的一维码存在譬如可靠性不好、信息存储量不足、改正能力低等缺点，二维码的出现可以有效地解决上述问题，在众多领域得到应用。同时混沌信号作为一种天然的密码，引入到商品防伪码的制码和数码识别过程中，具有更高的安全性。发明内容本发明的目的是为了解决现有技术中的不足，提供一种基于防伪图片置乱解密的商品防伪码识别方法，利用混沌映射产生混沌信号序列以及矩阵行移位和列移位的参数，根据混沌序列的排序置乱规则以及矩阵行移位和列移位的参数，对商品彩色防伪图片转换并拼接而得的组合三维二进制矩阵依次进行置乱拼接、列移位、回填反置乱，再置乱拼接、行移位和回填再反置乱操作，进而生成彩色图片CC，判断彩色图片CC与商品彩色商标图片是否一致以识别商品真伪，以此保证所提的商品防伪码识别方法简单可行、不易破解，商品防伪码的识别具有“安全性和可识别性”。本发明提供了一种基于防伪图片置乱解密的商品防伪码识别方法，包括如下几个步骤：转码首先，将商品防伪二维码进行解析，得到表征某件商品唯一身份信息的商品彩色商标图片和商品标识码，以及表征商品防伪信息的彩色防伪图片，然后，将商品彩色商标图片分解出红、绿、蓝三基色，分别表示为矩阵R、G和B，并将矩阵R、G和B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和接着，将商品标识码，表示为字符串A1A2,...,AL-1AL，逐个字符转换为数值型数据，得到数值序列再将数值序列P中元素逐个转换成8位二进制，得到二进制序列最后，将彩色防伪图片分解出红、绿、蓝三基色，分别表示为矩阵C_R、C_G和C_B，并将矩阵C_R、C_G和C_B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和并将三维二进制矩阵和依次上下拼接，得到组合三维二进制矩阵其中商品彩色商标图片的大小为M×N，矩阵R、G和B的大小均为M×N，三维二进制矩阵和的行数为M、列数为N、层数为8，商品标识码来自于GBK编码的字符，商品标识码的长度为L，数值序列P的长度为二进制序列PB的长度为且彩色防伪图片的大小为M×N，矩阵C_R、C_G和C_B的大小均为M×N，三维二进制矩阵和的行数为M、列数为N、层数为8，组合三维二进制矩阵的行数为3M、列数为N、层数为8；产生混沌序列首先利用外部解密密钥，按照如下-公式分别计算得到混沌系统的初值x1、参数λ、抽取开始位置δ1和δ2，令则可得，x1＝mod+0.001， λ＝2+mod， 其中，α∈，β∈，0表示统计二进制序列{PB8i-7,PB8i-6,...,PB8i-1,PB8i}中存在二进制‘0’的个数，和分别表示统计三维二进制矩阵的第i行、第j列、第1～8层中存在二进制‘1’的个数，然后由初值x1、参数λ，对如下公式所示的Chebyshev混沌系统进行迭代，k表示迭代次数，xk+1表示第k次迭代得到的混沌信号，其中k＝1,2,…，从而得到混沌序列X，xk+1＝cos) 接着从混沌序列X中抽取第δ1个元素，按照如下公式分别计算得到矩阵行移位的行数H_number以及重置抽取开始位置δ1，从混沌序列X中抽取第δ1个元素，按照如下公式分别计算得到矩阵行移位的方向H_direction、重置抽取开始位置δ1，以及行移位矩阵的层面参数H_CM，从混沌序列X中第δ1+2个元素开始连续抽取8个，得到长度为8的混沌序列最后从混沌序列X中抽取第δ2个元素，按照如下公式分别计算得到矩阵列移位的列数L_number以及重置抽取开始位置δ2，从混沌序列X中抽取第δ2个元素，按照如下公式分别计算得到矩阵列移位的方向L_direction、重置抽取开始位置δ2，以及列移位矩阵的层面参数L_CM，从混沌序列X中第δ2+2个元素开始连续抽取8个，得到长度为8的混沌序列列移位的置乱解密首先，将混沌序列Y2按降序排序，根据序列Y2排序前、后的位置变化置乱规则，对组合三维二进制矩阵元素按层进行置乱，得到置乱后的三维二进制矩阵根据列移位矩阵的层面参数L_CM，进行如下拼接操作，如果L_CM＝0，则将置乱后的三维二进制矩阵中元素逐层左右拼接，得到待列移位矩阵LRGB，表示为如果L_CM＝1，则将置乱后的三维二进制矩阵中元素逐列左右拼接，得到列移位矩阵LRGB，表示为其中待列移位矩阵LRGB的大小为3M×8N，然后，根据矩阵列移位的列数L_number以及方向L_direction，进行如下整列移位操作，如果L_direction＝0，则将待列移位矩阵LRGB整列循环右移L_number行，得到列移位后的矩阵如果L_direction＝1，则将待列移位矩阵LRGB整列循环左移L_number行，得到列移位后的矩阵最后，根据列移位矩阵的层面参数L_CM，进行如下回填操作，如果L_CM＝1，则将列移位后的矩阵中元素逐层回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到列移位后的三维二进制矩阵BL，表示为如果L_CM＝0，则将列移位后的矩阵中元素逐列回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到列移位后的三维二进制矩阵BL，表示为将混沌序列Y2按升序排序，根据序列Y2排序前、后的位置变化置乱规则，对列移位后的三维二进制矩阵BL中元素按层进行反置乱，得到反置乱后的列移位三维二进制矩阵行移位的置乱解密首先，将混沌序列Y1按降序排序，根据序列Y1排序前、后的位置变化置乱规则，对列移位三维二进制矩阵中元素按层进行置乱，得到置乱后的列移位三维二进制矩阵根据行移位矩阵的层面参数H_CM，进行如下拼接操作，如果H_CM＝0，则将列移位三维二进制矩阵中元素逐层上下拼接，得到待行移位矩阵HRGB，表示为如果H_CM＝1，则将列移位三维二进制矩阵中元素逐行上下拼接，得到待行移位矩阵HRGB，表示为其中待行移位矩阵HRGB的大小为24M×N，然后，根据矩阵行移位的行数H_number以及方向H_direction，进行如下整行移位操作，如果H_direction＝0，则将待行移位矩阵HRGB整行循环下移H_number行，得到行移位后矩阵如果H_direction＝1，则将待行移位矩阵HRGB整行循环上移H_number行，得到行移位后矩阵最后，根据行移位矩阵的层面参数H_CM，进行如下回填操作，如果H_CM＝1，则将行移位后的矩阵中元素逐层回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到行列移位三维二进制矩阵BHL，表示为如果H_CM＝0，则将行移位后的矩阵中元素逐行回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到行列移位三维二进制矩阵BHL，表示为将混沌序列Y1按升序排序，根据序列Y1排序前、后的位置变化置乱规则，对行列移位三维二进制矩阵BHL元素按层进行反置乱，得到反置乱后的行列移位三维二进制矩阵商品防伪二维码的生成由反置乱后的行列移位三维二进制矩阵分别得到数值矩阵从而生成彩色图片CC，其中矩阵的大小均为M×N，彩色图片CC的大小为M×N，再比较彩色图片CC与商品二维码解析而得的商品彩色商标图片是否一致，如一致，则商品识别为真品；如不一致，则商品识别为赝品。进一步地，一种基于防伪图片置乱解密的商品防伪码识别方法里步骤中所述的将矩阵R、G和B中元素分别逐个转换成8位二进制，是指将矩阵R中元素逐个采用运算得到三维二进制矩阵将矩阵G中元素逐个采用运算得到三维二进制矩阵将矩阵B中元素逐个采用运算得到三维二进制矩阵进一步地，一种基于防伪图片置乱解密的商品防伪码识别方法里步骤中所述的将商品标识码，表示为字符串A1A2,...,AL-1AL，逐个字符转换为数值型数据，是指将商品标识码中字符逐个采用unicode2native函数转换为数值型数据，即对于双字节字符的转换表示为对于单字节字符的转换表示为从而得到数值序列进一步地，一种基于防伪图片置乱解密的商品防伪码识别方法里步骤中所述的将数值序列P中元素逐个转换成8位二进制，是指将数值序列P中元素逐个采用PB＝dec2bin运算，得到二进制序列进一步地，一种基于防伪图片置乱解密的商品防伪码识别方法里步骤中所述的将矩阵C_R、C_G和C_B中元素分别逐个转换成8位二进制，是指将矩阵C_R中元素逐个采用运算得到三维二进制矩阵将矩阵C_G中元素逐个采用运算得到三维二进制矩阵将矩阵C_B中元素逐个采用运算得到三维二进制矩阵进一步地，一种基于防伪图片置乱解密的商品防伪码识别方法里步骤中所述的由反置乱后的行列移位三维二进制矩阵分别得到数值矩阵从而生成彩色图片CC，表示如下步骤：步骤①将三维二进制矩阵中第1～M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤②将三维二进制矩阵中第M+1～2M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤③将三维二进制矩阵中第2M+1～3M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤④将数值矩阵分别表征彩色图片的红、绿、蓝三基色，利用函数将矩阵转换为彩色图片，从而生成彩色图片CC，其中彩色图片CC的大小为M×N。有益效果：本发明中将商品防伪二维码进行解析，得到表征某件商品唯一身份信息的商品彩色商标图片和商品标识码，以及表征商品防伪信息的彩色防伪图片，根据混沌序列的排序置乱规则以及矩阵行移位和列移位的参数，对商品彩色防伪图片转换并拼接而得的组合三维二进制矩阵依次进行置乱拼接、列移位、回填反置乱，再置乱拼接、行移位和回填再反置乱操作，进而生成彩色图片CC，判断彩色图片CC与商品彩色商标图片是否一致以识别商品真伪，以此保证所提的商品防伪码识别方法简单可行、不易破解，商品防伪码的识别具有“安全性和可识别性”。附图说明图1为本发明的一种基于防伪图片置乱解密的商品防伪码识别流程示意图；图2本发明实施例1中商品彩色商标图片的红、绿、蓝三基色图片；图3本发明实施例1中商品彩色防伪图片的红、绿、蓝三基色图片；图4本发明提供的基于防伪图片置乱解密的商品防伪码识别方法在实施例1中得到的彩色图片CC的红、绿、蓝三基色图片。具体实施方式为了使本领域的人员更好地理解本发明方案，下面结合附图和具体实施方式对本发明作进一步的详细说明。显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。如图1所示，本发明实施例提供了一种基于防伪图片置乱解密的商品防伪码识别方法，包括如下几个步骤：转码首先，将商品防伪二维码进行解析，得到表征某件商品唯一身份信息的商品彩色商标图片和商品标识码，以及表征商品防伪信息的彩色防伪图片，然后，将商品彩色商标图片分解出红、绿、蓝三基色，分别表示为矩阵R、G和B，并利用dec2bin函数将矩阵R、G和B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和接着，将商品标识码，表示为字符串A1A2,...,AL-1AL，逐个字符采用unicode2native函数转换为数值型数据，即对于双字节字符的转换表示为对于单字节字符的转换表示为得到数值序列再将数值序列P中元素逐个逐个采用PB＝dec2bin运算，得到二进制序列最后，将彩色防伪图片分解出红、绿、蓝三基色，分别表示为矩阵C_R、C_G和C_B，并利用dec2bin函数将矩阵C_R、C_G和C_B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和并将三维二进制矩阵和依次上下拼接，得到组合三维二进制矩阵其中商品彩色商标图片的大小为M×N，矩阵R、G和B的大小均为M×N，三维二进制矩阵和的行数为M、列数为N、层数为8，商品标识码来自于GBK编码的字符，商品标识码的长度为L，数值序列P的长度为二进制序列PB的长度为且彩色防伪图片的大小为M×N，矩阵C_R、C_G和C_B的大小均为M×N，三维二进制矩阵和的行数为M、列数为N、层数为8，组合三维二进制矩阵的行数为3M、列数为N、层数为8；产生混沌序列首先利用外部解密密钥，按照如下所示公式分别计算得到混沌系统的初值x1、参数λ、抽取开始位置δ1和δ2，令则可得，x1＝mod+0.001，λ＝2+mod，其中，α∈，β∈，0表示统计二进制序列{PB8i-7,PB8i-6,...,PB8i-1,PB8i}中存在二进制‘0’的个数，和分别表示统计三维二进制矩阵的第i行、第j列、第1～8层中存在二进制‘1’的个数，然后由初值x1、参数λ，对如下公式所示的Chebyshev混沌系统进行迭代，k表示迭代次数，xk+1表示第k次迭代得到的混沌信号，其中k＝1,2,…，从而得到混沌序列X，xk+1＝cos)接着从混沌序列X中抽取第δ1个元素，按照如下公式分别计算得到矩阵行移位的行数H_number以及重置抽取开始位置δ1，从混沌序列X中抽取第δ1个元素，按照如下公式分别计算得到矩阵行移位的方向H_direction、重置抽取开始位置δ1，以及行移位矩阵的层面参数H_CM，从混沌序列X中第δ1+2个元素开始连续抽取8个，得到长度为8的混沌序列最后从混沌序列X中抽取第δ2个元素，按照如下公式分别计算得到矩阵列移位的列数L_number以及重置抽取开始位置δ2，从混沌序列X中抽取第δ2个元素，按照如下公式分别计算得到矩阵列移位的方向L_direction、重置抽取开始位置δ2，以及列移位矩阵的层面参数L_CM，从混沌序列X中第δ2+2个元素开始连续抽取8个，得到长度为8的混沌序列列移位的置乱解密首先，将混沌序列Y2按降序排序，根据序列Y2排序前、后的位置变化置乱规则，对组合三维二进制矩阵元素按层进行置乱，得到置乱后的三维二进制矩阵根据列移位矩阵的层面参数L_CM，进行如下拼接操作，如果L_CM＝0，则将置乱后的三维二进制矩阵中元素逐层左右拼接，得到待列移位矩阵LRGB，表示为如果L_CM＝1，则将置乱后的三维二进制矩阵中元素逐列左右拼接，得到列移位矩阵LRGB，表示为其中待列移位矩阵LRGB的大小为3M×8N，然后，根据矩阵列移位的列数L_number以及方向L_direction，进行如下整列移位操作，如果L_direction＝0，则将待列移位矩阵LRGB整列循环右移L_number行，得到列移位后的矩阵如果L_direction＝1，则将待列移位矩阵LRGB整列循环左移L_number行，得到列移位后的矩阵最后，根据列移位矩阵的层面参数L_CM，进行如下回填操作，如果L_CM＝1，则将列移位后的矩阵中元素逐层回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到列移位后的三维二进制矩阵BL，表示为如果L_CM＝0，则将列移位后的矩阵中元素逐列回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到列移位后的三维二进制矩阵BL，表示为将混沌序列Y2按升序排序，根据序列Y2排序前、后的位置变化置乱规则，对列移位后的三维二进制矩阵BL中元素按层进行反置乱，得到反置乱后的列移位三维二进制矩阵行移位的置乱解密首先，将混沌序列Y1按降序排序，根据序列Y1排序前、后的位置变化置乱规则，对列移位三维二进制矩阵中元素按层进行置乱，得到置乱后的列移位三维二进制矩阵根据行移位矩阵的层面参数H_CM，进行如下拼接操作，如果H_CM＝0，则将列移位三维二进制矩阵中元素逐层上下拼接，得到待行移位矩阵HRGB，表示为如果H_CM＝1，则将列移位三维二进制矩阵中元素逐行上下拼接，得到待行移位矩阵HRGB，表示为其中待行移位矩阵HRGB的大小为24M×N，然后，根据矩阵行移位的行数H_number以及方向H_direction，进行如下整行移位操作，如果H_direction＝0，则将待行移位矩阵HRGB整行循环下移H_number行，得到行移位后矩阵如果H_direction＝1，则将待行移位矩阵HRGB整行循环上移H_number行，得到行移位后矩阵最后，根据行移位矩阵的层面参数H_CM，进行如下回填操作，如果H_CM＝1，则将行移位后的矩阵中元素逐层回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到行列移位三维二进制矩阵BHL，表示为如果H_CM＝0，则将行移位后的矩阵中元素逐行回填至一个行数为3M、列数为N、层数为8的三维二进制矩阵中，得到行列移位三维二进制矩阵BHL，表示为将混沌序列Y1按升序排序，根据序列Y1排序前、后的位置变化置乱规则，对行列移位三维二进制矩阵BHL元素按层进行反置乱，得到反置乱后的行列移位三维二进制矩阵商品防伪二维码的生成由反置乱后的行列移位三维二进制矩阵分别得到数值矩阵从而生成彩色图片CC，表示如下步骤，步骤①将三维二进制矩阵中第1～M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤②将三维二进制矩阵中第M+1～2M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤③将三维二进制矩阵中第2M+1～3M行、第1～N列、第1～8层二进制元素，以某行某列1～8层的二进制元素为单位分别采用运算转换为某个数值型数据并填入矩阵中，其中i＝1,2,...,M，j＝1,2,...,N，继而可得数值矩阵表示如下，步骤④将数值矩阵分别表征彩色图片的红、绿、蓝三基色，利用函数将矩阵转换为彩色图片，从而生成彩色图片CC，其中彩色图片CC的大小为M×N，再比较彩色图片CC与商品二维码解析而得的商品彩色商标图片是否一致，如一致，则商品识别为真品；如不一致，则商品识别为赝品。下面结合具体的实施例对本发明作进一步说明：实施例1按照上述一种基于防伪图片置乱解密的商品防伪码识别方法，步骤如下：首先，将商品防伪二维码进行解析，得到表征某件商品唯一身份信息的商品彩色商标和商品标识码‘123-123456-2021年08月11日-12345678’，以及表征商品防伪信息的彩色防伪图片，然后，将商品彩色商标图片分解出红、绿、蓝三基色，分别表示为矩阵R、G和B，并将矩阵R、G和B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和接着，将表征某件商品基本信息的商品标识码，即字符串‘123-123456-2021年08月11日-12345678’，逐个字符转换为数值型数据，得到数值序列P＝{49,50,51,45,49,50,51,52,53,54,45,50,48,50,49,196,234,48,56,212,194,49,49,200,213,45,49,50,51,52,53,54,55,56}，再将数值序列P中元素逐个转换成8位二进制，得到二进制序列PB＝{0,0,1,1,0,0,0,1,0,0,1,1,0,0,1,0,0,0,1,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,0,1,0,0,1,1,0,0,1,0,0,0,1,1,0,0,1,1,0,0,1,1,0,1,0,0,0,0,1,1,0,1,0,1,0,0,1,1,0,1,1,0,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,1,1,0,0,0,1,1,1,0,0,0,1,0,0,1,1,1,0,1,0,1,0,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,1,0,1,0,1,0,0,1,1,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,1,1,0,0,0,1,1,1,0,0,1,0,0,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,0,1,0,0,1,1,0,0,1,0,0,0,1,1,0,0,1,1,0,0,1,1,0,1,0,0,0,0,1,1,0,1,0,1,0,0,1,1,0,1,1,0,0,0,1,1,0,1,1,1,0,0,1,1,1,0,0,0}，最后，将彩色防伪图片分解出红、绿、蓝三基色，分别表示为矩阵C_R、C_G和C_B，并将矩阵C_R、C_G和C_B中元素分别逐个转换成8位二进制，得到三维二进制矩阵和并将三维二进制矩阵和依次上下拼接，得到组合三维二进制矩阵其中商品彩色商标图片的大小为76×76，矩阵R、G和B的大小均为76×76，三维二进制矩阵和的行数为76、列数为76、层数为8，商品标识码来自于GBK编码的字符，商品标识码的长度为L＝31，数值序列P的长度为二进制序列PB的长度为8×34＝272，彩色防伪图片的大小为76×76，矩阵C_R、C_G和C_B的大小均为76×76，三维二进制矩阵和的行数为76、列数为76、层数为8，组合三维二进制矩阵的行数为228、列数为76、层数为8；首先利用外部加密密钥，按照如下公式分别计算得到混沌系统的初值x1、参数λ、抽取开始位置δ1和δ2，令则可得，x1＝mod+0.001＝0.937444100521666，λ＝2+mod＝8.482315899478333，δ1＝mod+1＝89，δ2＝mod+1＝49,然后由初值x1、参数λ，对Chebyshev混沌系统进行迭代，得到混沌序列X,接着从混沌序列X中抽取第89个元素，计算得到矩阵行移位的行数H_number＝mod＝1509以及重置抽取开始位置δ1＝89+mod＝122，从混沌序列X中抽取第122个元素，计算得到矩阵行移位的方向H_direction＝1、重置抽取开始位置δ1＝122+59＝181，以及行移位矩阵的层面参数H_CM＝0，从混沌序列X中第183个元素开始连续抽取8个，得到长度为8的混沌序列Y1＝{0.640718053979319,0.415847546804130,-0.966038615644033,0.763729419664320,0.945741379717408,-0.944554589219226,0.245645345982807,0.221380205639024}，最后从混沌序列X中抽取第49个元素，计算得到矩阵列移位的列数L_number＝mod＝414以及重置抽取开始位置δ2＝49+mod＝94，从混沌序列X中抽取第94个元素，计算得到矩阵列移位的方向L_direction＝0、重置抽取开始位置δ2＝94+53＝147，以及列移位矩阵的层面参数L_CM＝1，从混沌序列X中第149个元素开始连续抽取8个，得到长度为8的混沌序列Y2＝{-0.726970140964423,0.191422875691690,0.640096385770775,0.409593790562923,-0.949360784579567,0.366344995675700,-0.753331087148370,-0.139552787306207}；首先，将混沌序列Y2按降序排序，根据序列Y2排序前、后的位置变化置乱规则{3,4,6,2,8,1,7,5}，对组合三维二进制矩阵元素按层进行置乱，得到置乱后的三维二进制矩阵则将置乱后的三维二进制矩阵中元素逐层左右拼接，得到待列移位矩阵LRGB，表示为然后，将待列移位矩阵LRGB整列循环右移414行，得到列移位后的矩阵最后，将列移位后的矩阵中元素逐列回填至一个行数为228、列数为76、层数为8的三维二进制矩阵中，得到列移位后的三维二进制矩阵BL，表示为将混沌序列Y2按升序排序，根据序列Y2排序前、后的位置变化置乱规则{5,7,1,8,2,6,4,3}，对列移位后的三维二进制矩阵BL中元素按层进行反置乱，得到反置乱后的列移位三维二进制矩阵将混沌序列Y1按降序排序，根据序列Y1排序前、后的位置变化置乱规则{5,4,1,2,7,8,6,3}，对列移位三维二进制矩阵中元素按层进行置乱，得到置乱后的列移位三维二进制矩阵将列移位三维二进制矩阵中元素逐行上下拼接，得到待行移位矩阵HRGB，表示为其中待行移位矩阵HRGB的大小为1824×76，然后，将待行移位矩阵HRGB整行循环上移1509行，得到行移位后矩阵最后，将行移位后的矩阵中元素逐层回填至一个行数为228、列数为76、层数为8的三维二进制矩阵中，得到行列移位三维二进制矩阵BHL，表示为将混沌序列Y1按升序排序，根据序列Y1排序前、后的位置变化置乱规则{3,6,8,7,2,1,4,5}，对行列移位三维二进制矩阵BHL元素按层进行反置乱，得到反置乱后的行列移位三维二进制矩阵由反置乱后的行列移位三维二进制矩阵分别得到数值矩阵从而生成彩色图片CC，其中矩阵的大小均为76×76，彩色图片CC的大小为76×76，再比较彩色图片CC与商品二维码解析而得的商品彩色商标图片，发现两者是一致的，则商品识别为真品。实施例2按照上述基于防伪图片置乱解密的商品防伪码识别方法，某件商品的商品防伪二维码及其商品防伪码识别步骤与具体实施例1相似，仅某个外部解密密钥发生细微变化：α＝0.12345000000001；或β＝6.54321000000001，商品防伪码的识别结果如表1所示。由下表可见：一旦外部解密密钥即使发生细微变化，商品防伪码的识别结果会发生极大的变化，由此可见本专利所提一种基于防伪图片置乱解密的商品防伪码识别方法具有密钥敏感性。表1外部解密密钥发生微变时，商品防伪码的识别结果实施例3按照上述基于防伪图片置乱解密的商品防伪码识别方法，某件商品的商品防伪二维码解析可得的商品彩色商标图片和彩色防伪图片、外部解密密钥及其商品防伪码识别步骤与具体实施例1相似，仅商品防伪二维码解析可得的商品标识码发生微变：‘723-123456-2021年08月11日-12345678’；或者‘123-123456-2021年03月11日-12345678’；或者‘123-123456-2021年08月11日-12345876’，商品防伪码的识别结果如表2所示。由下表可见：一旦商品标识码即使发生细微变化，商品防伪码的识别结果会发生极大的变化，由此可见本专利所提一种基于防伪图片置乱解密的商品防伪码识别方法对于商品标识码具有敏感性。表2商品标识码发生微变时，商品防伪码的识别结果实施例4按照上述基于防伪图片置乱解密的商品防伪码识别方法，某件商品的商品防伪二维码解析可得的商品标识码和彩色防伪图片、外部解密密钥及其商品防伪码识别步骤与具体实施例1相似，仅商品防伪二维码解析可得的商品彩色商标图片发生微变：商品彩色商标图片中红基色某点像素发生微变，如R＝mod+1,256)；或者商品彩色商标图片中绿基色某点像素发生微变，如G＝mod-1,256)；或者商品彩色商标图片中蓝基色某点像素发生微变，如B＝mod+1,256)，商品防伪码的识别结果如表3所示。由下表可见：一旦商品彩色商标图片即使发生细微变化，商品防伪码的识别结果会发生极大的变化，由此可见本专利所提一种基于防伪图片置乱解密的商品防伪码识别方法对于商品彩色商标图片具有敏感性。表3商品彩色商标图片发生微变时，商品防伪码的识别结果实施例5按照上述基于防伪图片置乱解密的商品防伪码识别方法，某件商品的商品防伪二维码解析可得的商品标识码和彩色商标图片、外部解密密钥及其商品防伪码识别步骤与具体实施例1相似，仅商品防伪二维码解析可得的商品彩色防伪图片发生微变：商品彩色防伪图片中各点像素发生微变，如C-R＝mod+1,256),C-G＝mod+1,256),C-B＝mod+1,256)；或如C-R＝mod-1,256),C-G＝mod-1,256),C-B＝mod-1,256)；或如C-R＝mod+55,256),C-G＝mod+55,256),C-B＝mod+55,256)，商品防伪码的识别结果如表4所示。由下表可见：一旦商品彩色防伪图片即使发生细微变化，商品防伪码的识别结果会发生极大的变化，由此可见本专利所提一种基于防伪图片置乱解密的商品防伪码识别方法对于商品彩色防伪图片具有敏感性。表4商品彩色防伪图片发生微变时，商品防伪码的生成结果由上述具体实施例2～5分析可知，本专利所提一种基于防伪图片置乱解密的商品防伪码识别方法所识别的商品真伪不仅与外部解密密钥、商品唯一身份信息密切相关，而且依赖于表征商品防伪信息的彩色防伪图片，因此本专利所提的一种基于防伪图片置乱解密的商品防伪码识别方法具有很强的安全性，可以较好地抵抗唯密文攻击，不易破解。以上所述，仅是本发明的较佳实施例而已，并非对本发明作任何形式上的限制，虽然本发明已以较佳实施例揭露如上，然而并非用以限定本发明，任何熟悉本专业的技术人员，在不脱离本发明技术方案范围内，当可利用上述揭示的技术内容作出些许更动或修饰为等同变化的等效实施例，但凡是未脱离本发明技术方案的内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化与修饰，均仍属于本发明技术方案的范围内。
