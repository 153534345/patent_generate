标题title
一种融合多模态数据基于注意力感知的个性化服装推荐方法及系统
摘要abst
本发明公开一种融合多模态数据基于注意力感知的个性化服装推荐方法及系统，使用用户的评分数据指导用户评论特征的生成，经过注意力机制处理过的评论特征包含了与用户更相关的评论信息；再根据处理后的评论特征指导服装图像细粒度特征向量的生成，从而得到用户所关注的服装关键图像特征，经过了两次注意力处理，得到了更准确的、更符合用户个性化偏好的服装特征向量。本发明利用注意力机制过滤了用户评论和服装图像数据中的噪音数据，从而得到了与用户更相关的评论与服装图像的多维度特征，更准确地体现了用户的个性化偏好，解决了用户兴趣挖掘不充分、推荐精度不够等问题。
权利要求书clms
1.一种融合多模态数据基于注意力感知的个性化服装推荐方法，其特征在于，包括：步骤1：利用LFM从用户评分数据中提取用户的隐因子向量矩阵；步骤2：使用BiGRU和注意力机制挖掘用户评论的特征信息，包括使用用户的隐因子向量矩阵指导用户评论生成单词级的注意力向量；步骤3：在单词级的注意力向量上应用BiGRU拼接前向和后向两个方向上的隐藏状态，得到情境化的用户评论特征向量，然后基于情境化的用户评论特征向量得到用户评论偏好特征向量；步骤4：将用户最后一次购买的服装图像划分为m个区域并提取每个区域的服装图像特征向量，使用情境化的用户评论向量对服装图像特征进行注意力指导，得到用户评论指导生成的服装图像特征向量；步骤5：将得到的用户评论偏好特征向量和用户评论指导生成的服装图像特征向量进行拼接生成用户偏好特征向量，作为编码器部分输出；步骤6：将用户偏好特征向量输入到解码器部分，计算候选服装项目集的概率分布，选择概率最大的服装项目作为下一项推荐。2.根据权利要求1所述的一种融合多模态数据基于注意力感知的个性化服装推荐方法，其特征在于，所述步骤1包括：以用户为矩阵的行，服装项目为矩阵的列构建用户-服装项目的评分矩阵：其中ru,i为用户u对服装项目i的评分；pu,k表示用户u的k维隐因子向量；qi,k表示服装项目i的k维隐因子向量；F表示向量的维度；pu表示用户的隐因子向量矩阵。3.根据权利要求1所述的一种融合多模态数据基于注意力感知的个性化服装推荐方法，其特征在于，所述步骤2包括：将用户的历史评论集S＝{S1，S2，…，Sn，…，SN}中的每条评论表示为单词的组合t1,t2,…，t|S|；使用预训练的BERT进行向量的嵌入表示，使用BiGRU处理每条评论的词向量序列；将每个单词在前向和后向两个方向上的隐藏状态拼接得到上下文词向量，从而得到单词序列ht；使用评分中得到的用户隐因子向量指导评论生成单词级的注意力向量；将用户隐因子向量矩阵pu和单词序列ht作为输入，进行注意力处理，计算公式为：其中，表示用户u对单词t的注意力程度；W1,W2,W3是要学习的权重；ak表示执行归一化操作得到的第k个单词的注意力权重；a为单词级的注意力向量，是评论S的总结。4.根据权利要求1所述的一种融合多模态数据基于注意力感知的个性化服装推荐方法，其特征在于，所述步骤3包括：采用注意力处理情境化的用户评论特征向量，生成用户评论偏好特征向量Su，注意力计算的公式为：βn＝W5 tanh+b2其中βn表示使用单层神经网络得到的第n条评论的注意力程度；cn为情境化的用户评论特征向量；W4，W5为权重矩阵；b1，b2为偏置向量；gn表示归一化操作后得到的第n条评论的权重。5.根据权利要求1所述的一种融合多模态数据基于注意力感知的个性化服装推荐方法，其特征在于，所述步骤4包括：将用户最后一次购买的服装图像划分为m个区域；使用VGG网络对每个区域进行特征提取，得到原始的服装图像特征向量；再将从用户评论中得到的情境化的用户评论特征向量使用平均池化汇总为单个向量cs；对原始的服装图像特征向量进行注意力处理，过滤噪音，得到用户评论指导生成的服装图像特征向量，注意力计算公式为：δI＝tanh其中δI表示cs对vI的注意力程度，vI＝{vi|vi∈Rd，i＝1，…，m}，vI∈Rd×m，为原始的服装图像特征向量；cs∈Rd；W6，W7为权重矩阵；⊙表示向量的连接；pI∈Rm，表示m个区域的向量，对应于每个区域的注意力概率，pi表示pI中对应第i个区域的向量；VL为用户评论指导生成的服装图像特征向量。6.一种融合多模态数据基于注意力感知的个性化服装推荐系统，其特征在于，包括：隐因子向量提取模块，用于利用LFM从用户评分数据中提取用户的隐因子向量矩阵；用户评论特征提取模块，用于使用BiGRU和注意力机制挖掘用户评论的特征信息，包括使用用户的隐因子向量矩阵指导用户评论生成单词级的注意力向量；用户评论偏好特征向量得出模块，用于在单词级的注意力向量上应用BiGRU拼接前向和后向两个方向上的隐藏状态，得到情境化的用户评论特征向量，然后基于情境化的用户评论特征向量得到用户评论偏好特征向量；用户评论指导模块，用于将用户最后一次购买的服装图像划分为m个区域并提取每个区域的服装图像特征向量，使用情境化的用户评论向量对服装图像特征进行注意力指导，得到用户评论指导生成的服装图像特征向量；用户偏好特征向量得出模块，用于将得到的用户评论偏好特征向量和用户评论指导生成的服装图像特征向量进行拼接生成用户偏好特征向量，作为编码器部分输出；推荐模块，用于将用户偏好特征向量输入到解码器部分，计算候选服装项目集的概率分布，选择概率最大的服装项目作为下一项推荐。
说明书desc
技术领域本发明属于智能推荐技术领域，尤其涉及一种融合多模态数据基于注意力感知的个性化服装推荐方法及系统。背景技术随着科技的快速发展及电子商务的广泛应用，各大电商平台纷纷崛起。然而信息数据不断增多，互联网数据呈爆发式增长。推荐系统作为解决“信息过载”的有效方法得到广泛的应用，其个性化服务已经渗透到人们的生活中，并发挥着越来越重要的作用。推荐系统旨在根据用户历史行为信息对用户的特征、兴趣等因素进行深入分析挖掘，然后从海量的信息中匹配用户可能感兴趣的信息或服务。它最重要的特点在于能够充分适应用户需求不明确的问题，并且能够利用用户的历史数据，构建模型以捕获用户的兴趣。个性化推荐就是根据不同的个性化的需求为目标用户推荐相对更为感兴趣的特定的商品。服装个性化推荐技术中使用最为广泛的一种推荐算法是基于协同过滤的推荐，其根据用户不同用户跟商品的历史交互记录和相似用户等信息中挖掘出用户与物品之间的偏好函数关系，预测用户对没有产生过交互的商品的偏好，进而根据预测结果为不同的用户推荐其可能感兴趣的商品。但是协同过滤算法可能存在数据稀疏性、不能充分挖掘用户潜在兴趣等问题，其次，基于用户的协同过滤算法只利用了用户和商品的交互信息，忽略了服装产品本身的特征，如服装的视觉特征。最终导致推荐结果不精，用户体验度不高。综上，目前，现有的服装推荐方法主要分为两类：1)基于协同过滤方法的服装推荐技术，该方法虽然己经能够产生较好的推荐效果，但是协同过滤方法主要有以下缺陷：仅利用较为稀疏的评分数据进行服装推荐，导致数据稀疏性、用户潜在兴趣挖掘不充分等问题；忽略了服装产品本身的相关信息，例如：服装的图像特征。从而导致推荐系统精度不高。2)基于服装图像特征的推荐系统，该方法主要有以下缺陷：以服装图像全局特征作为图像的特征表示，缺乏细粒度的服装特征表示；忽略了不同用户所关注服装的不同特征的用户个性化偏好，导致推荐结果的用户的个性化体验度不好。发明内容本发明针对现有的服装推荐结果不精，用户体验度不高的问题，提出一种融合多模态数据基于注意力感知的个性化服装推荐方法及系统。为了实现上述目的，本发明采用以下技术方案：本发明一方面提出一种融合多模态数据基于注意力感知的个性化服装推荐方法，包括：步骤1：利用LFM从用户评分数据中提取用户的隐因子向量矩阵；步骤2：使用BiGRU和注意力机制挖掘用户评论的特征信息，包括使用用户的隐因子向量矩阵指导用户评论生成单词级的注意力向量；步骤3：在单词级的注意力向量上应用BiGRU拼接前向和后向两个方向上的隐藏状态，得到情境化的用户评论特征向量，然后基于情境化的用户评论特征向量得到用户评论偏好特征向量；步骤4：将用户最后一次购买的服装图像划分为m个区域并提取每个区域的服装图像特征向量，使用情境化的用户评论向量对服装图像特征进行注意力指导，得到用户评论指导生成的服装图像特征向量；步骤5：将得到的用户评论偏好特征向量和用户评论指导生成的服装图像特征向量进行拼接生成用户偏好特征向量，作为编码器部分输出；步骤6：将用户偏好特征向量输入到解码器部分，计算候选服装项目集的概率分布，选择概率最大的服装项目作为下一项推荐。进一步地，所述步骤1包括：以用户为矩阵的行，服装项目为矩阵的列构建用户-服装项目的评分矩阵：其中ru,i为用户u对服装项目i的评分；pu,k表示用户u的k维隐因子向量；qi,k表示服装项目i的k维隐因子向量；F表示向量的维度；pu表示用户的隐因子向量矩阵。进一步地，所述步骤2包括：将用户的历史评论集S＝{S1，S2，…，Sn，…，SN}中的每条评论表示为单词的组合t1,t2,…，t|S|；使用预训练的BERT进行向量的嵌入表示，使用BiGRU处理每条评论的词向量序列；将每个单词在前向和后向两个方向上的隐藏状态拼接得到上下文词向量，从而得到单词序列ht；使用评分中得到的用户隐因子向量指导评论生成单词级的注意力向量；将用户隐因子向量矩阵pu和单词序列ht作为输入，进行注意力处理，计算公式为：其中，表示用户u对单词t的注意力程度；W1,W2,W3是要学习的权重；ak表示执行归一化操作得到的第k个单词的注意力权重；a为单词级的注意力向量，是评论S的总结。进一步地，所述步骤3包括：采用注意力处理情境化的用户评论特征向量，生成用户评论偏好特征向量 Su，注意力计算的公式为：βn＝W5 tanh+b2其中βn表示使用单层神经网络得到的第n条评论的注意力程度；cn为情境化的用户评论特征向量；W4，W5为权重矩阵；b1，b2为偏置向量；gn表示归一化操作后得到的第n条评论的权重。进一步地，所述步骤4包括：将用户最后一次购买的服装图像划分为m个区域；使用VGG网络对每个区域进行特征提取，得到原始的服装图像特征向量；再将从用户评论中得到的情境化的用户评论特征向量使用平均池化汇总为单个向量cs；对原始的服装图像特征向量进行注意力处理，过滤噪音，得到用户评论指导生成的服装图像特征向量，注意力计算公式为：δI＝tanh其中δI表示cs对vI的注意力程度，vI＝{vi|vi∈Rd，i＝1，…，m}，vI∈Rd×m，为原始的服装图像特征向量；cs∈Rd；W6，W7为权重矩阵；⊙表示向量的连接； pI∈Rm，表示m个区域的向量，对应于每个区域的注意力概率，pi表示pI中对应第i个区域的向量；VL为用户评论指导生成的服装图像特征向量。本发明另一方面提出一种融合多模态数据基于注意力感知的个性化服装推荐系统，包括：隐因子向量提取模块，用于利用LFM从用户评分数据中提取用户的隐因子向量矩阵；用户评论特征提取模块，用于使用BiGRU和注意力机制挖掘用户评论的特征信息，包括使用用户的隐因子向量矩阵指导用户评论生成单词级的注意力向量；用户评论偏好特征向量得出模块，用于在单词级的注意力向量上应用 BiGRU拼接前向和后向两个方向上的隐藏状态，得到情境化的用户评论特征向量，然后基于情境化的用户评论特征向量得到用户评论偏好特征向量；用户评论指导模块，用于将用户最后一次购买的服装图像划分为m个区域并提取每个区域的服装图像特征向量，使用情境化的用户评论向量对服装图像特征进行注意力指导，得到用户评论指导生成的服装图像特征向量；用户偏好特征向量得出模块，用于将得到的用户评论偏好特征向量和用户评论指导生成的服装图像特征向量进行拼接生成用户偏好特征向量，作为编码器部分输出；推荐模块，用于将用户偏好特征向量输入到解码器部分，计算候选服装项目集的概率分布，选择概率最大的服装项目作为下一项推荐。进一步地，所述隐因子向量提取模块具体用于：以用户为矩阵的行，服装项目为矩阵的列构建用户-服装项目的评分矩阵：其中ru,i为用户u对服装项目i的评分；pu,k表示用户u的k维隐因子向量；qi,k表示服装项目i的k维隐因子向量；F表示向量的维度；pu表示用户的隐因子向量矩阵。进一步地，所述用户评论特征提取模块具体用于：将用户的历史评论集S＝{S1，S2，…，Sn，…，SN}中的每条评论表示为单词的组合t1,t2,…，t|S|；使用预训练的BERT进行向量的嵌入表示，使用BiGRU处理每条评论的词向量序列；将每个单词在前向和后向两个方向上的隐藏状态拼接得到上下文词向量，从而得到单词序列ht；使用评分中得到的用户隐因子向量指导评论生成单词级的注意力向量；将用户隐因子向量矩阵pu和单词序列ht作为输入，进行注意力处理，计算公式为：其中，表示用户u对单词t的注意力程度；W1,W2,W3是要学习的权重；ak表示执行归一化操作得到的第k个单词的注意力权重；a为单词级的注意力向量，是评论S的总结。进一步地，所述用户评论偏好特征向量得出模块具体用于：采用注意力处理情境化的用户评论特征向量，生成用户评论偏好特征向量 Su，注意力计算的公式为：βn＝W5 tanh+b2其中βn表示使用单层神经网络得到的第n条评论的注意力程度；cn为情境化的用户评论特征向量；W4，W5为权重矩阵；b1，b2为偏置向量；gn表示归一化操作后得到的第n条评论的权重。进一步地，所述用户评论指导模块具体用于：将用户最后一次购买的服装图像划分为m个区域；使用VGG网络对每个区域进行特征提取，得到原始的服装图像特征向量；再将从用户评论中得到的情境化的用户评论特征向量使用平均池化汇总为单个向量cs；对原始的服装图像特征向量进行注意力处理，过滤噪音，得到用户评论指导生成的服装图像特征向量，注意力计算公式为：δI＝tanh其中δI表示cs对vI的注意力程度，vI＝{vi|vi∈Rd，i＝1，…，m}，vI∈Rd×m，为原始的服装图像特征向量；cs∈Rd；W6，W7为权重矩阵；⊙表示向量的连接； pI∈Rm，表示m个区域的向量，对应于每个区域的注意力概率，pi表示pI中对应第i个区域的向量；VL为用户评论指导生成的服装图像特征向量。与现有技术相比，本发明具有的有益效果：本发明相对于先前的推荐系统/方法，融合多模态数据进行推荐，具体使用用户评分、用户评论和服装图像作为模型的输入，使用用户评分数据对用户评论进行注意力处理，得到更精确的用户评论特征。对服装图像分割后再提取特征，这样能更加细粒度表示图像不同部分的特征，得到了更精确的、更细粒度的特征向量。这样融合了多源数据从而进行推荐，缓解了服装推荐系统中的数据稀疏性问题。相对于现有的推荐系统/方法中多模态数据之间只是简单的进行向量拼接操作或者使用全连接层简单的进行融合，本发明对多模态数据之间进行相互指导的注意力处理，使用用户评分指导用户评论进行注意力处理，再使用用户评论指导服装图像进行注意力处理。本发明利用注意力机制过滤了用户评论和服装图像数据中的噪音数据，从而得到了与用户更相关的评论与服装图像的多维度特征，更准确地体现了用户的个性化偏好，解决了用户兴趣挖掘不充分、推荐精度不够等问题。附图说明图1为本发明实施例一种融合多模态数据基于注意力感知的个性化服装推荐方法的基本流程图；图2为本发明实施例一种融合多模态数据基于注意力感知的个性化服装推荐系统架构示意图。具体实施方式下面结合附图和具体的实施例对本发明做进一步的解释说明：如图1所示，一种融合多模态数据基于注意力感知的个性化服装推荐方法，包括：步骤1：利用LFM从用户评分数据中提取用户的隐因子向量矩阵；具体地，首先利用LFM从用户评分数据中提取用户隐因子向量和服装隐因子向量，其反应了用户的兴趣。设用户集为U＝{u1，u2，…，um}，服装项目集为I＝{i1，i2，…，in}，以用户为矩阵的行，服装项目为矩阵的列构建用户-服装项目的评分矩阵R，其中ru,i为用户u对服装项目i的评分，公式为：其中，pu,k表示用户u的k维隐因子向量，qi,k表示服装项目i的k维隐因子向量，F表示向量的维度。最终，得到表示用户偏好的用户的隐因子向量矩阵 pu。步骤2：使用BiGRU和注意力机制挖掘用户评论的特征信息，包括使用用户的隐因子向量矩阵指导用户评论生成单词级的注意力向量；具体地，使用BiGRU和注意力机制深层挖掘用户评论的特征信息，用户的评论文本包含重要的偏好信息以及服装相关的特定详细信息。从评论中提取信息时，重要的是区分相关评论和噪音评论，要在每条评论中确定重要的部分，将用户的历史评论集S＝{S1，S2，…，Sn，…，SN}中的每条评论表示为单词的组合t1,t2,…， t|S|。先使用预训练的BERT进行向量的嵌入表示，为了捕获上下文信息，使用 BiGRU处理每条评论的词向量序列。将每个单词在前向和后向两个方向上的隐藏状态拼接得到上下文词向量，从而得到单词序列ht。由于文本的词序列较长，实际应用中BiGRU模型得到的最终特征向量会偏向文本序列的最后几个词。为了解决这个问题，采用一种注意力机制使用评分中得到的用户隐因子向量指导评论生成单词级的注意力向量，可以充分利用用户的偏好来调整词向量的权重，以获得更紧凑、更准确的评论内容特征表示。将用户隐因子向量矩阵pu和单词序列ht作为输入，进行注意力处理，计算公式为：其中，表示使用w1和w2对pu和ht进行线性转换，然后使用非线性激活函数提取非线性语义信息，最后使用线性转换得到的用户u对单词t的注意力程度；W1,W2,W3是要学习的权重；ak表示执行归一化操作得到的第k个单词的注意力权重；a为单词级的注意力向量，是评论S的总结。对于每个评论S1，…， SN重复计算得到a1，…，aN。步骤3：在单词级的注意力向量上应用BiGRU拼接前向和后向两个方向上的隐藏状态，得到情境化的用户评论特征向量，然后基于情境化的用户评论特征向量得到用户评论偏好特征向量；具体地，为了捕获用户评论中的全局上下文信息，在单词级的注意力向量上应用BiGRU，拼接前向和后向两个方向上的隐藏状态得到情境化的用户评论向量c1，…，cn，…，cN。采用注意力处理关注重要的评论信息，生成最终的用户评论偏好特征向量Su，注意力计算的公式为：βn＝W5 tanh+b2其中，βn表示使用单层神经网络得到的第n条评论的注意力程度；W4，W5为权重矩阵；b1，b2为偏置向量；gn表示归一化操作后得到的第n条评论的权重。步骤4：将用户最后一次购买的服装图像划分为m个区域并提取每个区域的服装图像特征向量，使用情境化的用户评论向量对服装图像特征进行注意力指导，得到用户评论指导生成的服装图像特征向量；具体地，处理服装图像时，一般来说，用户的关注点可能仅与输入的服装图像的特定区域相关。因此，不使用全局向量作为图像特征，而是将图像划分为m 个区域并提取每个区域的特征向量。然后使用评分指导的用户评论特征对服装图像特征进行注意力指导，过滤噪音并找到与用户偏好更相关的区域。首先，将服装图像尺寸缩放为224*224，划分为m＝N*N个区域，使用预处理的19层VGG 网络对每个区域进行特征提取。得到原始的服装图像特征向量vI＝{vi|vi∈Rd， i＝1，…，m}。再将从用户评论中得到的情境化的用户评论向量c1，…，cn，…， cN使用平均池化汇总为单个向量。其中cs表示使用c1，…，cn，…，cN平均池化汇总后的单个向量。对原始的服装图像特征向量进行注意力处理，过滤噪音得到突出服装图像重点区域的特征，为了方便计算，使用一个全连接层将每个图像特征向量转化为维度与评论向量相等的图像特征向量。注意力计算公式为：δI＝tanh其中，δI表示cs对vI的注意力程度，vI∈Rd×m，cs∈Rd；W6，W7为权重矩阵；⊙表示向量的连接；pI∈Rm，表示m个区域的向量，对应于每个区域的注意力概率，pi表示pI中对应第i个区域的向量；VL为用户评论指导生成的服装图像特征向量。步骤5：将得到的用户评论偏好特征向量和用户评论指导生成的服装图像特征向量进行拼接生成用户偏好特征向量，作为编码器部分输出；将得到的用户评论特征和用户评论指导生成的服装图像特征进行拼接生成用户偏好特征向量，作为网络的Encoder部分输出。步骤6：将用户偏好特征向量输入到解码器部分，计算候选服装项目集的概率分布，选择概率最大的服装项目作为下一项推荐。Decoder部分主要是GRU网络，训练时，使用用户偏好特征向量和服装项目序列进行训练，将服装项目映射为固定长度的特征作为GRU输入。xt＝W8It,t∈{1,…,n}ht+1＝GRU,t∈{1,…,n}其中，I＝是服装项目序列，每个项目表示为one-hot向量Ht，W8是权重向量，xt是t时刻的服装项目嵌入特征；ht+1表示训练过程中，t+1时刻的 GRU模型输出的隐藏状态。预测时，给定前一个输出ht-1，经过GRU生成下一个输出ht。在每个时间步，采用单层全连接网络和softmax函数生成t时刻的每个服装项目的概率分布，最终选择概率最大的项目作为下一项推荐。Pt＝softmax其中，Pt为t时刻生成的每个服装项目的概率分布，hs∈{h1，…，hn}为输入，Wi为权重参数。模型训练的目标函数为：其中，Ht是t时刻的真实标签，H0是Encoder部分的输出值，H{1:t-1}是先前的项目序列，θ表示模型的所有参数，λ为正则化参数。采用随机梯度下降优化目标函数，每次随机选取训练实例，让模型参数朝着负梯度方向更新。在上述实施例的基础上，如图2所示，本发明还提出一种融合多模态数据基于注意力感知的个性化服装推荐系统，包括：隐因子向量提取模块，用于利用LFM从用户评分数据中提取用户的隐因子向量矩阵；用户评论特征提取模块，用于使用BiGRU和注意力机制挖掘用户评论的特征信息，包括使用用户的隐因子向量矩阵指导用户评论生成单词级的注意力向量；用户评论偏好特征向量得出模块，用于在单词级的注意力向量上应用BiGRU拼接前向和后向两个方向上的隐藏状态，得到情境化的用户评论特征向量，然后基于情境化的用户评论特征向量得到用户评论偏好特征向量；用户评论指导模块，用于将用户最后一次购买的服装图像划分为m个区域并提取每个区域的服装图像特征向量，使用情境化的用户评论向量对服装图像特征进行注意力指导，得到用户评论指导生成的服装图像特征向量；用户偏好特征向量得出模块，用于将得到的用户评论偏好特征向量和用户评论指导生成的服装图像特征向量进行拼接生成用户偏好特征向量，作为编码器部分输出；推荐模块，用于将用户偏好特征向量输入到解码器部分，计算候选服装项目集的概率分布，选择概率最大的服装项目作为下一项推荐。进一步地，所述隐因子向量提取模块具体用于：以用户为矩阵的行，服装项目为矩阵的列构建用户-服装项目的评分矩阵：其中ru,i为用户u对服装项目i的评分；pu,k表示用户u的k维隐因子向量；qi,k表示服装项目i的k维隐因子向量；F表示向量的维度；pu表示用户的隐因子向量矩阵。进一步地，所述用户评论特征提取模块具体用于：将用户的历史评论集S＝{S1，S2，…，Sn，…，SN}中的每条评论表示为单词的组合t1,t2,…，t|S|；使用预训练的BERT进行向量的嵌入表示，使用BiGRU处理每条评论的词向量序列；将每个单词在前向和后向两个方向上的隐藏状态拼接得到上下文词向量，从而得到单词序列ht；使用评分中得到的用户隐因子向量指导评论生成单词级的注意力向量；将用户隐因子向量矩阵pu和单词序列ht作为输入，进行注意力处理，计算公式为：其中，表示用户u对单词t的注意力程度；W1,W2,W3是要学习的权重；ak表示执行归一化操作得到的第k个单词的注意力权重；a为单词级的注意力向量，是评论S的总结。进一步地，所述用户评论偏好特征向量得出模块具体用于：采用注意力处理情境化的用户评论特征向量，生成用户评论偏好特征向量 Su，注意力计算的公式为：βn＝W5 tanh+b2其中βn表示使用单层神经网络得到的第n条评论的注意力程度；cn为情境化的用户评论特征向量；W4，W5为权重矩阵；b1，b2为偏置向量；gn表示归一化操作后得到的第n条评论的权重。进一步地，所述用户评论指导模块具体用于：将用户最后一次购买的服装图像划分为m个区域；使用VGG网络对每个区域进行特征提取，得到原始的服装图像特征向量；再将从用户评论中得到的情境化的用户评论特征向量使用平均池化汇总为单个向量cs；对原始的服装图像特征向量进行注意力处理，过滤噪音，得到用户评论指导生成的服装图像特征向量，注意力计算公式为：δI＝tanh其中δI表示cs对vI的注意力程度，vI＝{vi|vi∈Rd，i＝1，…，m}，vI∈Rd×m，为原始的服装图像特征向量；cs∈Rd；W6，W7为权重矩阵；⊙表示向量的连接； pI∈Rm，表示m个区域的向量，对应于每个区域的注意力概率，pi表示pI中对应第i个区域的向量；VL为用户评论指导生成的服装图像特征向量。综上，首先，针对基于矩阵分解的协同过滤算法中存在的数据稀疏性，导致推荐系统精度不高的问题，本发明联合使用用户评分数据和评论信息，以增加更多数据的方式来指导模型学习出更为合理的用户特征，进而提高模型预测精度。相比于单一的评分数据，用户生成的文本评论信息是用户偏好特征的重要来源，而且包含有关用户偏好的较为具体和细微的特征。因此，融合评论数据可以有效提高推荐系统的精度。其次，细粒度的服装图像特征作为一种服装类商品语义信息的表示，能够对用户购买意向产生更加精准的影响，代替使用整个服装图像作为图像特征表示的方法，本发明构建了服装图像不同区域的空间特征，将服装图像划分为m个不同区域，使用预处理的19层VGG网络对每个区域进行处理，可以得到更细粒度的服装图像特征，其包含了更多细粒度服装图像的具体信息。最后，对于用户评论信息以及服装图像而言，如果直接使用双向GRU模型提取的评论文本或使用VGG模型捕获服装图像的整体向量特征进行服装的推荐，最终的推荐结果可能会受到其中噪音数据的影响。本发明引入了注意力机制，注意机制允许模型更专注与用户特征相关的信息。首先使用用户的评分数据指导用户评论特征的生成，用户评分显式的表达了用户的偏好，可以充分利用用户的偏好来调整每条评论中词向量的权重，以获得更准确的评论特征表示。因为用户评论中可能包含直观的能表达用户偏好的单词，其表示用户更关注服装图像上的某个局部区域的信息，所以使用注意力机制处理过的评论特征指导服装图像特征的生成，得到用户偏好更相关的服装向量特征。因此，可以从用户评论、服装图像中分别得到更准确的符合用户个性化偏好的用户评论、服装图像向量特征。得到用户评论特征向量和服装图像特征向量后，对二者进行拼接使用GRU模型进行序列化推荐，从而对用户进行下一项个性化推荐。本发明相对于先前的推荐系统方法，融合多模态数据进行推荐，具体使用用户评分、用户评论和服装图像作为模型的输入，使用用户评分数据对用户评论进行注意力处理，得到更精确的用户评论特征。对服装图像分割后再提取特征，这样能更加细粒度表示图像不同部分的特征，得到了更精确的、更细粒度的特征向量。这样融合了多源数据从而进行推荐，缓解了服装推荐系统中的数据稀疏性问题。相对于现有的推荐系统和方法中多模态数据之间只是简单的进行向量拼接操作或者使用全连接层简单的进行融合，本发明对多模态数据之间进行相互指导的注意力处理，使用用户评分指导用户评论进行注意力处理，再使用用户评论指导服装图像进行注意力处理。本发明利用注意力机制过滤了用户评论和服装图像数据中的噪音数据，从而得到了与用户更相关的评论与服装图像的多维度特征，更准确地体现了用户的个性化偏好，解决了用户兴趣挖掘不充分、推荐精度不够等问题。以上所示仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干改进和润饰，这些改进和润饰也应视为本发明的保护范围。
