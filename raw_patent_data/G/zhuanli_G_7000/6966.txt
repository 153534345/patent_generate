标题title
复杂工况故障诊断方法、设备、存储介质及装置
摘要abst
本发明公开了一种复杂工况故障诊断方法、设备、存储介质及装置，本发明通过预设最优性能子模型和预设分类模型对应用设备的制造数据进行诊断，以获得诊断结果；根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息对应的故障路径。本发明通过预设最优性能子模型和预设分类模型对制造数据进行诊断，根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息对应的故障路径，本发明相对于现有技术中依靠操作者的经验进行诊断，导致诊断结果不准确，本发明实现了可通过训练好的模型对复杂工况的工序进行问题溯源诊断，更加准确地定位制造过程中产生的问题，达到诊断的目的，提升诊断速率，更精准定位制造过程产生问题的故障路径。
权利要求书clms
1.一种复杂工况故障诊断方法，其特征在于，所述复杂工况故障诊断方法包括以下步骤：获取应用设备的制造数据；根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果；根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径。2.如权利要求1所述的复杂工况故障诊断方法，其特征在于，所述根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果的步骤，包括：根据预设最优性能子模型对所述制造数据对应的原始工序进行划分，以获得原始工序中问题工序的占比；根据所述占比确定诊断优先级；根据预设分类模型和所述诊断优先级对所述制造数据进行诊断，以获得诊断结果。3.如权利要求2所述的复杂工况故障诊断方法，其特征在于，所述根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径的步骤，包括：根据预设关联算法和所述诊断结果确定所述制造数据中问题工序对应的频繁项集；根据所述频繁项集确定问题工序对应的故障路径。4.如权利要求1所述的复杂工况故障诊断方法，其特征在于，所述获取应用设备的制造数据的步骤之前，包括：获取历史工序制造数据；对所述历史工序制造数据对应的工序进行异常标注，以获得标注后的异常工序及异常工序数据；根据所述标注后的异常工序及异常工序数据构建问题工序数据集；根据所述问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型；根据所述问题工序数据集对所述初始分类模型进行训练，以获得预设分类模型；根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型；根据所述历史工序制造数据对所述初始最优性能子模型进行训练，以获得预设最优性能子模型。5.如权利要求4所述的复杂工况故障诊断方法，其特征在于，所述基于LightGBM算法的模型包括基于单边采样算法的模型和基于互斥特征算法的模型；所述根据所述问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型的步骤，包括：根据所述问题工序数据集对所述基于单边采样算法的模型进行训练，以获得初始学习器；对初始学习器进行迭代训练，以获得预设学习器；根据所述问题工序数据集对所述基于互斥特征算法的模型进行训练，以获得特征捆绑模型；根据所述预设学习器和所述特征捆绑模型构建初始分类模型。6.如权利要求4所述的复杂工况故障诊断方法，其特征在于，所述根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型的步骤，包括：根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得不同的层次子模型；对各个层次子模型进行评估，以获得最优排序子模型；对各最优排序子模型进行训练，以获得各最优排序子模型的出现频次；根据所述出现频次从各最优排序子模型中选取最优性能子模型，并将所述最优性能子模型作为初始最优性能子模型。7.如权利要求6所述的复杂工况故障诊断方法，其特征在于，所述对各个层次子模型进行评估，以获得最优排序子模型的步骤，包括：根据所述历史工序制造数据确定含有问题工序的工序群个数、含有问题工序的单个工序群中工序个数及含有问题工序的单个工序群中问题工序个数；根据所述含有问题工序的工序群个数、所述含有问题工序的单个工序群中工序个数及所述含有问题工序的单个工序群中问题工序个数对各个层次子模型进行评估，以获得最优排序子模型。8.一种复杂工况故障诊断设备，其特征在于，所述复杂工况故障诊断设备包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的复杂工况故障诊断程序，所述复杂工况故障诊断程序被所述处理器执行时实现如权利要求1至7中任一项所述的复杂工况故障诊断方法的步骤。9.一种存储介质，其特征在于，所述存储介质上存储有复杂工况故障诊断程序，所述复杂工况故障诊断程序被处理器执行时实现如权利要求1至7中任一项所述的复杂工况故障诊断方法的步骤。10.一种复杂工况故障诊断装置，其特征在于，所述复杂工况故障诊断装置包括：数据获取模块，用于获取应用设备的制造数据；数据诊断模块，用于根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果；路径确定模块，用于根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径。
说明书desc
技术领域本发明涉及故障诊断领域，尤其涉及一种复杂工况故障诊断方法、设备、存储介质及装置。背景技术目前，在产品生产加工的过程中，产品的尺寸等规格由于某些原因会发生一定的波动，这种波动对产品的质量影响很大，但是完全可以通过采取措施来避免和消除这种波动所造成的影响，这种措施就是过程控制。在传统的统计过程控制方法上，制造过程中的质量诊断多需依靠操作者的经验，对于诊断人员的专业水平与从业年限有一定要求，诊断准确率因人而异，从而导致诊断结果不准确。上述内容仅用于辅助理解本发明的技术方案，并不代表承认上述内容是现有技术。发明内容本发明的主要目的在于提供一种复杂工况故障诊断方法、设备、存储介质及装置，旨在解决现有技术中依靠操作者的经验进行诊断，导致诊断结果不准确的技术问题。为实现上述目的，本发明提供一种复杂工况故障诊断方法，所述复杂工况故障诊断方法包括以下步骤：获取应用设备的制造数据；根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果；根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径。优选地，所述根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果的步骤，包括：根据预设最优性能子模型对所述制造数据对应的原始工序进行划分，以获得原始工序中问题工序的占比；根据所述占比确定诊断优先级；根据预设分类模型和所述诊断优先级对所述制造数据进行诊断，以获得诊断结果。优选地，所述根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径的步骤，包括：根据预设关联算法和所述诊断结果确定所述制造数据中问题工序对应的频繁项集；根据所述频繁项集确定问题工序对应的故障路径。优选地，所述获取应用设备的制造数据的步骤之前，包括：获取历史工序制造数据；对所述历史工序制造数据对应的工序进行异常标注，以获得标注后的异常工序及异常工序数据；根据所述标注后的异常工序及异常工序数据构建问题工序数据集；根据所述问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型；根据所述问题工序数据集对所述初始分类模型进行训练，以获得预设分类模型；根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型；根据所述历史工序制造数据对所述初始最优性能子模型进行训练，以获得预设最优性能子模型。优选地，所述基于LightGBM算法的模型包括基于单边采样算法的模型和基于互斥特征算法的模型；所述根据所述问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型的步骤，包括：根据所述问题工序数据集对所述基于单边采样算法的模型进行训练，以获得初始学习器；对初始学习器进行迭代训练，以获得预设学习器；根据所述问题工序数据集对所述基于互斥特征算法的模型进行训练，以获得特征捆绑模型；根据所述预设学习器和所述特征捆绑模型构建初始分类模型。优选地，所述根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型的步骤，包括：根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得不同的层次子模型；对各个层次子模型进行评估，以获得最优排序子模型；对各最优排序子模型进行训练，以获得各最优排序子模型的出现频次；根据所述出现频次从各最优排序子模型中选取最优性能子模型，并将所述最优性能子模型作为初始最优性能子模型。优选地，所述对各个层次子模型进行评估，以获得最优排序子模型的步骤，包括：根据所述历史工序制造数据确定含有问题工序的工序群个数、含有问题工序的单个工序群中工序个数及含有问题工序的单个工序群中问题工序个数；根据所述含有问题工序的工序群个数、所述含有问题工序的单个工序群中工序个数及所述含有问题工序的单个工序群中问题工序个数对各个层次子模型进行评估，以获得最优排序子模型。此外，为实现上述目的，本发明还提出一种复杂工况故障诊断设备，所述复杂工况故障诊断设备包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的复杂工况故障诊断程序，所述复杂工况故障诊断程序配置为实现如上文所述的复杂工况故障诊断方法的步骤。此外，为实现上述目的，本发明还提出一种存储介质，所述存储介质上存储有复杂工况故障诊断程序，所述复杂工况故障诊断程序被处理器执行时实现如上文所述的复杂工况故障诊断方法的步骤。此外，为实现上述目的，本发明还提出一种复杂工况故障诊断装置，所述复杂工况故障诊断装置包括：数据获取模块，用于获取应用设备的制造数据；数据诊断模块，用于根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果；路径确定模块，用于根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径。本发明通过获取应用设备的制造数据；根据预设最优性能子模型和预设分类模型对制造数据进行诊断，以获得诊断结果；根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径。由于本发明通过预设最优性能子模型和预设分类模型对制造数据进行诊断，根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径，本发明相对于现有技术中依靠操作者的经验，诊断准确率因人而异，导致诊断结果不准确，本发明实现了可通过训练好的模型对复杂工况的工序进行问题溯源诊断，更加准确地定位制造过程中产生的问题，达到诊断的目的，提升诊断速率，更精准定位制造过程产生问题的故障路径。附图说明图1是本发明实施例方案涉及的硬件运行环境的复杂工况故障诊断设备的结构示意图；图2为本发明复杂工况故障诊断方法第一实施例的流程示意图；图3为本发明复杂工况故障诊断方法第二实施例的流程示意图；图4为本发明复杂工况故障诊断方法第三实施例的流程示意图；图5为本发明复杂工况故障诊断方法第三实施例的工序拓扑划分示意图；图6为本发明复杂工况故障诊断装置第一实施例的结构框图。本发明目的的实现、功能特点及优点将结合实施例，参照附图做进一步说明。具体实施方式应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。参照图1，图1为本发明实施例方案涉及的硬件运行环境的复杂工况故障诊断设备结构示意图。如图1所示，该复杂工况故障诊断设备可以包括：处理器1001，例如中央处理器，通信总线1002、用户接口1003，网络接口1004，存储器1005。其中，通信总线1002用于实现这些组件之间的连接通信。用户接口1003可以包括显示屏，可选用户接口1003还可以包括标准的有线接口、无线接口，对于用户接口1003的有线接口在本发明中可为USB接口。网络接口1004可选的可以包括标准的有线接口、无线接口接口)。存储器1005可以是高速的随机存取存储器，也可以是稳定的存储器，例如磁盘存储器。存储器1005可选的还可以是独立于前述处理器1001的存储装置。本领域技术人员可以理解，图1中示出的结构并不构成对复杂工况故障诊断设备的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。如图1所示，认定为一种计算机存储介质的存储器1005中可以包括操作系统、网络通信模块、用户接口模块以及复杂工况故障诊断程序。在图1所示的复杂工况故障诊断设备中，网络接口1004主要用于连接后台服务器，与所述后台服务器进行数据通信；用户接口1003主要用于连接用户设备；所述复杂工况故障诊断设备通过处理器1001调用存储器1005中存储的复杂工况故障诊断程序，并执行本发明实施例提供的复杂工况故障诊断方法。基于上述硬件结构，提出本发明复杂工况故障诊断方法的实施例。参照图2，图2为本发明复杂工况故障诊断方法第一实施例的流程示意图，提出本发明复杂工况故障诊断方法第一实施例。在本实施例中，所述复杂工况故障诊断方法包括以下步骤：步骤S10：获取应用设备的制造数据。需说明的是，本实施例执行主体可以是复杂工况故障诊断系统，也可以是包含复杂工况故障诊断功能的设备。该设备可以是计算机、笔记本、电脑、手机、电视机等，本实施例对此不加以限制。本实施例以复杂工况故障诊断系统为执行主体进行说明。应理解的是，应用设备可以是在生产制造过程中运用本方案中复杂工况故障诊断系统的设备，应用设备可以是对产品生产加工的设备。可理解的是，制造数据可以是指应用设备在对产品生产加工时产生的数据，制造数据可以是应用设备上各传感器采集的数据，也可以是产品对应的制造数据。针对不同的产品生产加工对应的制造数据不同。具体实现中，复杂工况故障诊断系统可以根据应用设备上安装的各传感器采集制造数据，也可以从预设数据库中提取产品生产加工对应的制造数据。步骤S20：根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果。需说明的是，预设最优性能子模型可以是预先训练好的最优性能子模型，最优性能子模型可以是针对产品对应的生产工序进行最优划分的模型。工序可以是指制造、生产某种东西或达到一特定结果的特定步骤，也可以是组成整个生产过程的各段加工的先后次序。可理解的是，预设分类模型可以是预先训练好的分类模型，分类模型可以是对产品生产工序进行诊断的模型。应理解的是，诊断结果可以是针对制造数据中原始工序中得问题工序及问题工序对应的数据。具体实现中，复杂工况故障诊断系统可以根据预设分类模型对制造数据进行分类以获得问题工序集，对问题工序集中的问题工序进行逐个诊断，若单个问题工序的传感器数据在标准误差范围内，则判定该工序设备无故障，若单个问题工序的传感器数据不在标准误差范围内，则判定该工序设备有故障，将问题工序中判定工序设备无故障的问题工序剔除，保留问题工序中判定为设备故障的问题工序为更新的问题工序集，从而剔除因前序工序故障导致而问题工序诊断，得到真正导致产品质量问题的问题工序，并根据预设最优性能子模型对更新的问题工序集进行诊断，以获得制造数据中原始工序中得问题工序及问题工序对应的数据。步骤S30：根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径。需说明的是，预设关联算法可以是用于查找问题工序之间的潜在联系，可以通过运用Apriori关联算法推导问题工序之间的关联关系与关联规则。可理解的是，问题工序信息可以是包含问题工序所在工序群的工序信息、也可以包含问题工序对应的数据。具体实现中，预设关联算法可以采用Apriori算法，以最优性能子模型的粒度划分应用诊断模型，以块诊断，若整块没问题，对下一块进行诊断，若该块有问题，再对块中单个工序诊断。诊断完成得到问题工序，应用关联规则算法得到故障溯源链。本实施例通过获取应用设备的制造数据；根据预设最优性能子模型和预设分类模型对制造数据进行诊断，以获得诊断结果；根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径。由于本实施例通过预设最优性能子模型和预设分类模型对制造数据进行诊断，根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径，本实施例相对于现有技术中依靠操作者的经验，诊断准确率因人而异，导致诊断结果不准确，本实施例实现了可通过训练好的模型对复杂工况的工序进行问题溯源诊断，更加准确地定位制造过程中产生的问题，达到诊断的目的，提升诊断速率，更精准定位制造过程产生问题的故障路径。参照图3，图3为本发明复杂工况故障诊断方法第二实施例的流程示意图，基于上述图2所示的第一实施例，提出本发明复杂工况故障诊断方法的第二实施例。在本实施例中，所述步骤S20，包括：步骤S201：根据预设最优性能子模型对所述制造数据对应的原始工序进行划分，以获得原始工序中问题工序的占比。需说明的是，原始工序可以是指生产加工产品是完整的加工工序，例如：参考图5的L1-1的生产加工得到产品Q的工序可以是1：ABCDMOQ；2：EFGHMOQ，即ABCDMOQ或EFGHMOQ是生产加工产品Q是完整的两条加工工序。阴影标注的工序是问题工序。而LI-1中工序群的划分为{ABCD}、{M}、{EFGH}、{OQ}。可理解的是，原始工序中问题工序的占比可以，根据原始工序中问题工序的个数和原始工序个数计算得到，例如：{ABCD}中的问题工序个数为2，原始工序个数为4，问题工序在{ABCD}工序群中的占比为1/2；而{EFGH}中问题工序格式为1，原始工序个数为4，问题工序在{EFGH}工序群中的占比为1/4；{OQ}中问题工序格式为1，原始工序个数为2，即问题工序在{OQ}工序群中的占比为1/2。具体实现中，复杂工况故障诊断系统可以根据预设最优性能子模型对制造数据对应的完整加工工序进行划分成工序群，以获得工序群中问题工序的占比。步骤S202：根据所述占比确定诊断优先级。需说明的是，诊断优先级可以根据问题工序在工序群的原始工序中占比确定对工序群进行诊断的优先级顺序。即根据问题工序占比高低作为工序群优先级评判标准。问题工序在划分工序群中占比越高，则诊断优先级越高，在诊断中优先诊断；问题工序在划分工序群中占比越低，则诊断优先级越低，在诊断中滞后诊断，对高优先级工序群反向调优工序设备，以逐步降低问题工序占比。具体实现中，复杂工况故障诊断系统根据各工序群中问题工序的占比确定对各工序群诊断的优先级，问题工序在划分工序群中占比越高，则诊断优先级越高，在诊断中优先诊断；问题工序在划分工序群中占比越低，则诊断优先级越低，在诊断中滞后诊断，对高优先级工序群反向调优工序设备，以逐步降低问题工序占比。步骤S203：根据预设分类模型和所述诊断优先级对所述制造数据进行诊断，以获得诊断结果。需说明的是，诊断结果可以是针对制造数据中原始工序中得问题工序及问题工序对应的数据。具体实现中，复杂工况故障诊断系统可以根据问题工序在划分工序群中的占比确定诊断优先级，预设分类模型根据诊断优先级对制造数据进行工序分类，即获得制造数据中原始工序中得问题工序及问题工序对应的数据。在本实施例中，所述步骤S30，包括：根据预设关联算法和所述诊断结果确定所述制造数据中问题工序对应的频繁项集；根据所述频繁项集确定问题工序对应的故障路径。需说明的是，频繁项集可以是针对问题工序对应的数据找出的一条或多条问题链路构成的项集。具体实现中，复杂工况故障诊断系统先搜索问题工序数据中支持度最高的，其次是去掉问题工序数据中支持度相对较低的，从而确定频繁项集，最后连接形成频繁项集。根据关联算法得到问题工序对应的频繁项集为最大故障路径，并将最大故障路径与诊断出的问题工序进行比对得到当前故障路径。本实施例通过获取应用设备的制造数据；根据预设最优性能子模型对所述制造数据对应的原始工序进行划分，以获得原始工序中问题工序的占比；根据占比确定诊断优先级；根据预设分类模型和诊断优先级对制造数据进行诊断，以获得诊断结果。根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径。由于本实施例通过根据预设最优性能子模型对制造数据对应的原始工序进行划分，以获得原始工序中问题工序的占比；根据占比确定诊断优先级；根据预设分类模型和诊断优先级对制造数据进行诊断，以获得诊断结果，根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径，本实施例相对于现有技术中依靠操作者的经验，诊断准确率因人而异，导致诊断结果不准确，本实施例实现了可通过训练好的模型对复杂工况的工序进行问题溯源诊断，根据问题工序占比高低作为工序群优先级评判标准。问题工序在划分工序群中占比越高，则诊断优先级越高，在诊断中优先诊断；问题工序在划分工序群中占比越低，则诊断优先级越低，在诊断中滞后诊断，对高优先级工序群反向调优工序设备，以逐步降低问题工序占比，更加准确地定位制造过程中产生的问题，达到诊断的目的，提升诊断速率，更精准定位制造过程产生问题的故障路径。参照图4，图4为本发明复杂工况故障诊断方法第三实施例的流程示意图，基于上述图2所示的第一实施例，提出本发明复杂工况故障诊断方法的第三实施例。在本实施例中，所述步骤S10之前，还包括：步骤S01：获取历史工序制造数据。需说明的是，历史工序制造数据可以是指产品生产加工时正常工序和异常工序对应的生产制造数据，所述生产制造数据可以包含生产加工时各工序对应的正常生产指标对应的制造数据。可理解的是，历史工序制造数据可以是针对不同产品在生产加工时正常工序和异常工序对应的制造数据。具体实现中，历史工序制造数据可以存储在预设数据库中，复杂工况故障诊断系统可以从预设数据库中获取历史工序制造数据，预设数据库可以根据历史工序制造数据分为数据指标及数据进行分类存储，不同的数据存储在不同的区域，以便于后期数据提取。例如：数据指标区和数据更新区，数据指标区可以用于存储正常工序下应用设备在生产制造过程中各工序对应的指标数据，所述指标数据可以用于衡量制造过程中各工序对应产生的数据是否异常，所述数据更新区可以用于存储应用设备各工序对应产生的数据并对历史数据进行更新，数据更新区可以存储异常工序产生的数据和正常工序产生的数据。步骤S02：对所述历史工序制造数据对应的工序进行异常标注，以获得标注后的异常工序及异常工序数据。需说明的是，异常标注可以根据正常工序对应的数据指标对异常工序进行标注的过程。具体实现中，通过对历史工序制造数据指标进行建模，从而判断历史工序制造数据中各工序的数据指标是否异常，对异常工序进行分类，基于异常工序对应的制造数据进行标注，以获得标注后的异常工序即异常工序数据。步骤S03：根据所述标注后的异常工序及异常工序数据构建问题工序数据集。需说明的是，问题工序数据集可以是根据标注的异常数据与问题工序之间的关联规则生成结构化的历史工序制造数据与问题工序对应的数据集。可理解的是，问题工序数据集可以分为三个部分，一部分为训练数据，一部分为调优数据，另一部分为测试数据，并对数据进行归一化处理，以便于后期模型训练。步骤S04：根据所述问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型。需说明的是，LightGBM是一个实现GBDT算法的框架，支持高效率的并行训练，不仅具有更快的训练速度，还拥有更低的内存消耗以及更好的准确率，支持分布式可以快速处理海量数据等优点。它主要包含两个算法：基于梯度的单边采样与互斥特征捆绑。基于LightGBM算法的模型的可以是基于LightGBM算法框架构建的模型。GBDT是机器学习中的一个模型，其主要利用弱学习器迭代训练以得到最优模型，该模型具有训练效果好、不易过拟合等优点。在大样本和高维度的环境下，传统的boosting算法对每一个特征都要扫描所有的样本点来选择最好的切分点非常耗时，为了解决耗时的问题，LightGBM使用了如下两种解决办法：一是基于GOSS算法对样本进行采样来计算梯度；二是基于EFB算法将某些特征进行捆绑在一起来降低特征的维度，使寻找最佳切分点的消耗减少。可理解的是，基于梯度的单边采样算法是一种在减少数据量和保证精度上平衡的算法。该算法通过区分不同梯度的实例，保留较大梯度实例同时对较小梯度随机采样的方式减少计算量，从而达到提升效率的目的。互斥特征捆绑算法是通过特征捆绑的方式减少特征维度的方式，来提升计算效率。通常被捆绑的特征都是互斥的，这样两个特征捆绑起来才不会丢失信息。如果两个特征并不是完全互斥，可以用一个指标对特征不互斥程度进行衡量，称之为冲突比率，当这个值较小时，我们可以选择把不完全互斥的两个特征捆绑，而不影响最后的精度。应理解的是，初始分类模型可以是基于LightGBM算法框架构建的模型，即初始分类模型可以是基于GOSS算法和EFB算法构建的模型，初始分类模型可以是用于对问题工序的分类及问题工序诊断的模型。具体实现中，复杂工况故障诊断系统可以根据问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型。复杂工况故障诊断系统可以通过对问题工序集中的数据进行特征化，并对数据进行采样，然后进行特征捆绑从而获得初始分类模型，复杂工况故障诊断系统可以通过输入训练集，设定迭代步数d，大梯度数据的采样率a，小梯度数据的采样率b，损失函数和弱学习器的类型本实施例中迭代步数d，大梯度数据的采样率a，小梯度数据的采样率b，损失函数和弱学习器的类型可以在训练数据前进行更换，不做具体限制。可以通过如下步骤进行训练：根据样本点的梯度的绝对值对它们进行降序排序；对排序后的结果选取前a*100％的样本生成一个大梯度样本点的子集；对剩下的样本集合100％的样本，随机的选取b*100％个样本点，生成一个小梯度样本点的集合；将大梯度样本和采样的小梯度样本合并；将小梯度样本乘上一个权重系数；使用上述的采样的样本，学习一个新的弱学习器；不断地重复～步骤直到达到规定的迭代次数或者收敛为止，最后输出训练好的强学习器。通过上面的步骤可以在不改变数据分布的前提下不损失学习器精度的同时大大的减少模型学习的速率。当a＝0时，GOSS算法退化为随机采样算法；当a＝1时，GOSS算法变为采取整个样本的算法。在许多情况下，GOSS算法训练出的模型精确度要高于随机采样算法。另一方面，采样可以增加弱学习器的多样性，从而潜在的提升了训练出的模型泛化能力。在模型训练过程中高维数据通常是稀疏的，在稀疏特征空间中，许多特征是互斥的，即它们从不同时取非零值，可以把互斥的特征捆绑成一个特征，从而降低特征维数，即步骤如下，可以先将特征按照非零值的个数进行排序，之后计算不同特征之间的冲突比率，最后遍历每个特征并尝试合并特征，使冲突比率最小化，从而提升模型训练速度。步骤S05：根据所述问题工序数据集对所述初始分类模型进行训练，以获得预设分类模型。需说明的是，预设分类模型是根据问题工序数据集对初始分类模型多次训练得到的模型。步骤S06：根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型。需说明的是，预设粒度可调层次模型可以是为简化并缩减多工序复杂工况作业中的每一道工序数据进行基于LightGBM算法的模型诊断所带来的大计算量问题，粒度可调层次模型为工序进行工序拓扑图重划分。粒度可调层次模型进行工序拓扑图重划分过程可以参考图5的工序拓扑划分示意图，可理解的是，根据历史工序制造数据对粒度可调层次模型进行训练时可分为三步，首先使用有向无环图对工序之间的先导关系做拓扑排序，如图5的工序拓扑划分示意图中L4-1所示，每一道工序视为一个独立单元，以此为粒度可调初始基准，对工序拓扑排序中入度为1的工序群由细到粗划分构成粒度可调层次模型。粒度可调层次模型中包含各个工序群对应的层次子模型。应理解的是，初始最优性能子模型可以是从各个工序群对应的层次子模型选取的模型，初始最优性能子模型可以用于优化模型性能，从而降低模型计算量。初始最优性能子模型可以有多个。具体实现中，复杂工况故障诊断系统可以根据历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型。步骤S07：根据所述历史工序制造数据对所述初始最优性能子模型进行训练，以获得预设最优性能子模型。需说明的是，预设最优性能子模型是根据历史工序制造数据对初始最优性能子模型多次训练得到的模型。具体实现中，复杂工况故障诊断系统可以根据历史工序制造数据对初始最优性能子模型进行多轮训练，从多个初始最优性能子模型中选取一个最优的性能子模型作为预设最优性能子模型。进一步地，所述基于LightGBM算法的模型包括基于单边采样算法的模型和基于互斥特征算法的模型；所述步骤S04，包括：根据所述问题工序数据集对所述基于单边采样算法的模型进行训练，以获得初始学习器；对初始学习器进行迭代训练，以获得预设学习器；根据所述问题工序数据集对所述互斥特征算法的模型进行训练，以获得特征捆绑模型；根据所述预设学习器和所述特征捆绑模型构建初始分类模型。需说明的是，基于单边采样算法的模型可以是指基于梯度的单边采样算法的模型，该模型可以通过在不改变数据分布的前提下不损失学习器精度的同时大大的减少模型学习的速率。可理解的是，初始学习器可以是可以是使用采样的样本，通过弱学习器学习的一个新的弱学习器，预设学习器可以是指对弱学习器进行不停学习得到训练好的强学习器。应理解的是，基于互斥特征算法的模型可以是指基于EFB算法的模型，该模型可以将某些特征进行捆绑在一起降低特征的维度，从而使得寻找最佳切分点的消耗减少。特征捆绑模型可以是指根据问题工序数据集中各工序对应的特征进行捆绑的模型。特征捆绑模型可以对问题工序数据集中特征进行捆绑，从而提升计算效率，例如：特征捆绑模型可以先将问题工序数据集中的特征按照非零值的个数进行排序，然后计算不同特征之间的冲突比率，最后遍历每个特征并尝试合并帖子，使得冲突比率最小化。特征捆绑模型可以是对各工序对应的数据特征进行捆绑，以获得特征捆绑集合的模型。具体实现中，复杂工况故障系统可以根据问题工序数据集对基于单边采样算法的模型进行训练，以获得初始学习器；对初始学习器进行迭代训练，以获得预设学习器；根据问题工序数据集对互斥特征算法的模型进行训练，以获得特征捆绑模型；根据所述预设学习器和所述特征捆绑模型构建初始分类模型。进一步地，所述步骤S06，包括：根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得不同的层次子模型；对各个层次子模型进行评估，以获得最优排序子模型；对各最优排序子模型进行训练，以获得各最优排序子模型的出现频次；根据所述出现频次从各最优排序子模型中选取最优性能子模型，并将所述最优性能子模型作为初始最优性能子模型。需说明的是，层次子模型可以是每个工序群对应的层次子模型，参考图5的工序拓扑划分示意图，如：L1-1、L2-1、L2-2、L2-3、L2-4、L3-1、L3-2、L3-3、L3-4、L4-1分别对应一个层次子模型，每一个层次子模型的工序划分不同，即各工序群包含的工序不同。可理解的是，最优排序子模型可以是从各个层次子模型中选取的模型，并根据对各层次子模型进行评估选出性能最优的层次子模型作为最优排序子模型，即根据选出的层次子模型的工序划分作为最优排序子模型的工序划分。应理解的是，出现频次可以是各最优排序子模型出现的次数，并选出出现频次高的最优排序子模型作为初始最优性能子模型。进一步地，所述对各个层次子模型进行评估，以获得最优排序子模型的步骤，包括：根据所述历史工序制造数据确定含有问题工序的工序群个数、含有问题工序的单个工序群中工序个数及含有问题工序的单个工序群中问题工序个数；根据所述含有问题工序的工序群个数、所述含有问题工序的单个工序群中工序个数及所述含有问题工序的单个工序群中问题工序个数对各个层次子模型进行评估，以获得最优排序子模型。需说明的是，为了进一步说明可以参考图5的工序拓扑划分示意图，例如：参考L2-2这个层次子模型对应的工序群，每个工序用A、B、C、D、E、F、G、H、M、O、Q来表征，当生产加工得到Q时其中具体细节工序路径可以划分为{A}、{B、C、D}、{M}、{O、Q}和{E、F、G}、{H}、{M}、{O、Q}，部分阴影标出的是问题工序：B、D、G、Q，即含有问题的工序群为{B、C、D}、{E、F、G}、{O、Q}；含有问题工序的单个工序群中工序为：A、B、C、D、E、F、G、H、M、A、O、Q；含有问题工序的单个工序群中问题工序为：B、D、G、Q。可理解的是，最优排序子模型可以是指对工序进行检测最优的划分子模型。参考图5的工序拓扑划分示意图中有粗到细的粒度划分，对每一个层次子模型对应的工序划分顺序进行评估，以获得最优排序子模型。具体实现中，最优排序子模型可以是根据评估公式：k表示含有问题工序的工序群个数，m表示含有问题工序的单个工序群中工序的个数，n为含有问题工序的单个工序群中问题工序的个数，η表示权重值。具体应用中，权重值可以是预先设置的值，可以前期进行调整，评估结果分值越高则模型性能越优。将性能最优的子模型作为最优排序子模型。本实施例中通过获取历史工序制造数据；对历史工序制造数据对应的工序进行异常标注，以获得标注后的异常工序及异常工序数据；根据标注后的异常工序及异常工序数据构建问题工序数据集；根据问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型；根据问题工序数据集对初始分类模型进行训练，以获得预设分类模型；根据历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型；根据历史工序制造数据对初始最优性能子模型进行训练，以获得预设最优性能子模型。获取应用设备的制造数据；根据预设最优性能子模型和预设分类模型对制造数据进行诊断，以获得诊断结果；根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径。由于本实施例通过预设最优性能子模型和预设分类模型对制造数据进行诊断，根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径，本实施例相对于现有技术中依靠操作者的经验，诊断准确率因人而异，导致诊断结果不准确，本实施例实现了可通过训练好的模型对复杂工况的工序进行问题溯源诊断，更加准确地定位制造过程中产生的问题，达到诊断的目的，提升诊断速率，更精准定位制造过程产生问题的故障路径。此外，本发明实施例还提出一种存储介质，所述存储介质上存储有复杂工况故障诊断程序，所述复杂工况故障诊断程序被处理器执行时实现如上文所述的复杂工况故障诊断方法的步骤。参照图6，图6为本发明复杂工况故障诊断装置第一实施例的结构框图。如图6所示，本发明实施例提出的复杂工况故障诊断装置包括：数据获取模块10，用于获取应用设备的制造数据；数据诊断模块20，用于根据预设最优性能子模型和预设分类模型对所述制造数据进行诊断，以获得诊断结果；路径确定模块30，用于根据预设关联算法和所述诊断结果确定所述制造数据中包含的问题工序信息，并根据所述问题工序信息确定对应的故障路径。本实施例通过获取应用设备的制造数据；根据预设最优性能子模型和预设分类模型对制造数据进行诊断，以获得诊断结果；根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径。由于本实施例通过预设最优性能子模型和预设分类模型对制造数据进行诊断，根据预设关联算法和诊断结果确定制造数据中包含的问题工序信息，并根据问题工序信息确定对应的故障路径，本实施例相对于现有技术中依靠操作者的经验，诊断准确率因人而异，导致诊断结果不准确，本实施例实现了可通过训练好的模型对复杂工况的工序进行问题溯源诊断，更加准确地定位制造过程中产生的问题，达到诊断的目的，提升诊断速率，更精准定位制造过程产生问题的故障路径。进一步地，所述数据诊断模块20还用于根据预设最优性能子模型对所述制造数据对应的原始工序进行划分，以获得原始工序中问题工序的占比；根据所述占比确定诊断优先级；根据预设分类模型和所述诊断优先级对所述制造数据进行诊断，以获得诊断结果。进一步地，所述路径确定模块30还用于根据预设关联算法和所述诊断结果确定所述制造数据中问题工序对应的频繁项集；根据所述频繁项集确定问题工序对应的故障路径。进一步地，所述复杂工况故障诊断装置还包括：模型构建模块，所述模型构建模块用于获取历史工序制造数据；对所述历史工序制造数据对应的工序进行异常标注，以获得标注后的异常工序及异常工序数据；根据所述标注后的异常工序及异常工序数据构建问题工序数据集；根据所述问题工序数据集对基于LightGBM算法的模型进行训练，以获得初始分类模型；根据所述问题工序数据集对所述初始分类模型进行训练，以获得预设分类模型；根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得初始最优性能子模型；根据所述历史工序制造数据对所述初始最优性能子模型进行训练，以获得预设最优性能子模型。进一步地，所述模型构建模块还用于根据所述问题工序数据集对所述基于单边采样算法的模型进行训练，以获得初始学习器；对初始学习器进行迭代训练，以获得预设学习器；根据所述问题工序数据集对所述基于互斥特征算法的模型进行训练，以获得特征捆绑模型；根据所述预设学习器和所述特征捆绑模型构建初始分类模型。进一步地，所述模型构建模块还用于根据所述历史工序制造数据对预设粒度可调层次模型进行训练，以获得不同的层次子模型；对各个层次子模型进行评估，以获得最优排序子模型；对各最优排序子模型进行训练，以获得各最优排序子模型的出现频次；根据所述出现频次从各最优排序子模型中选取最优性能子模型，并将所述最优性能子模型作为初始最优性能子模型。进一步地，所述模型构建模块还用于根据所述历史工序制造数据确定含有问题工序的工序群个数、含有问题工序的单个工序群中工序个数及含有问题工序的单个工序群中问题工序个数；根据所述含有问题工序的工序群个数、所述含有问题工序的单个工序群中工序个数及所述含有问题工序的单个工序群中问题工序个数对各个层次子模型进行评估，以获得最优排序子模型。本发明复杂工况故障诊断装置的其他实施例或具体实现方式可参照上述各方法实施例，此处不再赘述。此外，本发明实施例还提出一种存储介质，所述存储介质上存储有复杂工况故障诊断程序，所述复杂工况故障诊断程序被处理器执行时实现如上文所述的复杂工况故障诊断方法的步骤。应当理解的是，以上仅为举例说明，对本发明的技术方案并不构成任何限定，在具体应用中，本领域的技术人员可以根据需要进行设置，本发明对此不做限制。需要说明的是，以上所描述的工作流程仅仅是示意性的，并不对本发明的保护范围构成限定，在实际应用中，本领域的技术人员可以根据实际的需要选择其中的部分或者全部来实现本实施例方案的目的，此处不做限制。另外，未在本实施例中详尽描述的技术细节，可参见本发明任意实施例所提供的复杂工况故障诊断方法，此处不再赘述。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者系统不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者系统所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者系统中还存在另外的相同要素。上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。在列举了若干装置的单元权利要求中，这些装置中的若干个可以是通过同一个硬件项来具体体现。词语第一、第二、以及第三等的使用不表示任何顺序，可将这些词语解释为名称。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质/随机存取存储器、磁碟、光盘)中，包括若干指令用以使得一台终端设备执行本发明各个实施例所述的方法。以上仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
