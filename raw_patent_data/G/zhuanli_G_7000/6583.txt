标题title
跨场景的VOCs气体泄漏检测方法、系统及存储介质
摘要abst
本发明的一种跨场景的VOCs气体泄漏检测方法、系统及存储介质，包括以下步骤，获取存在VOCs泄漏和无泄漏的红外视频数据并对其进行数据预处理；采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域；对目标检测模型Faster RCNN神经网络模型进行预训练；通过已训练好的Faster RCNN神经网络模型，构造迁移学习中的源域特征数据集和目标域特征数据集；运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。本发明能够克服现有方法的不足，充分利用红外视频中VOCs气体区域的领域知识对视频帧中的可疑烟雾区域分割，随后再使用Faster RCNN神经网络模型，运用迁移学习的方式对VOCs泄漏区域进行检测识别，从而降低计算性能需求和标记所带来的时间耗费。
权利要求书clms
1.一种跨场景的VOCs气体泄漏检测方法，其特征在于，包括以下步骤，S1：获取存在VOCs泄漏和无泄漏的红外视频数据并对其进行数据预处理；S2：采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域；S3：对目标检测模型Faster RCNN神经网络模型进行预训练；S4：通过已训练好的Faster RCNN神经网络模型，构造迁移学习中的源域特征数据集和目标域特征数据集；S5：运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。2.根据权利要求1所述的跨场景的VOCs气体泄漏检测方法，其特征在于：所述步骤S1具体包括如下细分步骤S11至S13：S11：准备VOCs泄漏红外视频，每个视频均超过30秒且为“avi”格式，而视频像素可以不相等；S12：从红外视频数据中截取出VOCs泄漏图像创建数据集，并对相应帧做好标注；S13：对红外VOCs泄漏图像数据进行随机旋转、帧尺寸归一化这些预处理操作。3.根据权利要求2所述的跨场景的VOCs气体泄漏检测方法，其特征在于：所述上述步骤S2具体包括如下细分步骤S21至S25：S21：GMM表示为其中G,μj,σj)是像素值的概率密度分布，θ是GMM的一组参数，θ＝G,μj,σj)，μj和σj是模型的平均值和标准差，I是处像素值；S22：初始化背景模型，初始化均值μ0、标准差σ0和微分阈值T；为了初始化GMM，前50帧用于初始化混合模型中的三个高斯模型，初始I是50帧中处的50个像素的平均值，如等式所示：μ＝Iσ＝TS23：验证处的像素是前景还是背景，公式如下，λ为阈值参数，判断的基本规则是均值μ的指定范围：在算法中，如果像素I属于背景，就会被替换为0，否则就会被替换为相关的非零值；S24：更新参数和背景，α为学习率，数值越大，背景更新越快，这里α＝0.02；μ＝*μ+α*Iσ＝√*σ2+α*-μ))2S25：重复S23和S24，直到视频停止，即可提取出红外图像中疑似VOCs泄漏区域。4.根据权利要求3所述的跨场景的VOCs气体泄漏检测方法，其特征在于：所述步骤S3具体包括如下细分步骤S31至S32：S31：采用公共数据集对Faster RCNN神经网络模型进行训练；S32：将S1中部分VOCs泄漏图像和标记数据输入到Faster RCNN神经网络模型中进行预训练，使模型结构调整到更适应VOCs泄漏检测的参数。5.根据权利要求4所述的跨场景的VOCs气体泄漏检测方法，其特征在于：所述步骤S4具体包括如下细分步骤S41至S42：S41：将S1中剩余部分VOCs泄漏图像作为源域DS，将GMM提取出的疑似VOCs泄漏区域图像作为目标域DT；S42：将DS和DT输入到S32训练好的Faster RCNN神经网络模型中，首先通过卷积层得到特征图，再经过RPN区域建议网络生成候选框，将候选框与特征图结合即得到源域特征数据集和目标域特征数据集。6.根据权利要求5所述的跨场景的VOCs气体泄漏检测方法，其特征在于：所述步骤S5具体包括如下细分步骤S51至S54：S51：候选框中的特征向量表示为xi＝∈Rd，其标记为yi＝表示是否有VOCs泄漏；将源域特征数据集及其标记及作为目标域特征数据记为xt，无目标域标记；通过特征迁移的方式，将源域数据和目标域数据映射到共享的特征空间X和标记空间Y，即xs,xt∈X，ys,yt∈Y；S52：通过数据转换函数将数据和目标域数据转换到共享的特征空间和标记空间中；转换函数设计为f＝hω，其中ω为权重矩阵,h为随机映射后的实例，表示为其中αi∈Rd，bi∈R表示随机生成的权重和偏置；i＝1,…,l表示前馈神经网络的节点数；为非线性的激活函数；S53：寻找最优的数据转换函数，构建目标函数如下其中φ为正则化项；HS和HT是随机映射实列矩阵；Z是目标域中实列信息的保留项；而PMMD则是投影最大平均偏差，用来测量HS和HT之间的差距，表示为其中，Tr为矩阵的迹；表示边缘PMMD矩阵，计算方式为由此公式估计出边缘分布的差异；考虑到目标域是没有进行标记的，需要估计条件分布的差异，因此对伪标签进行PMMD的扩展，其表示为其中，和分别为真实标签和伪标签；ns和分别表示为源域中c类数量和目标域中c类数量，表示条件PMMD矩阵，计算方式为因此，目标函数重新定义为其中，S54：通过映射函数f将数据转换到高维空间，使得源域特征和目标特征具有相同的分布；使转换后的源域特征作为训练集，通过分类器进行分类，使目标特征作为测试集，进行测试和标记是VOCs泄漏区域和非VOCs泄漏区域；计算标记的置信度，采用非极大值抑制算法，选出得分较高的候选框，最终得到目标候选框，最后通过Faster RCNN神经网络模型中的回归部分对目标候选框进行回归。7.一种跨场景的VOCs气体泄漏检测系统，其特征在于，包括以下单元，数据获取单元，用于获取存在VOCs泄漏和无泄漏的红外视频数据并对其进行数据预处理；数据提取单元，用于采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域；模型训练单元，用于对目标检测模型Faster RCNN神经网络模型进行预训练；数据集构建单元，用于通过已训练好的Faster RCNN神经网络模型，构造迁移学习中的源域特征数据集和目标域特征数据集；识别单元，用于运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。8.根据权利要求7所述的跨场景的VOCs气体泄漏检测系统，其特征在于：所述数据提取单元，具体处理步骤包括如下细分步骤S21至S25：S21：GMM表示为其中G,μj,σj)是像素值的概率密度分布，θ是GMM的一组参数，θ＝G,μj,σj)，μj和σj是模型的平均值和标准差，I是处像素值；S22：初始化背景模型，初始化均值μ0、标准差σ0和微分阈值T；为了初始化GMM，前50帧用于初始化混合模型中的三个高斯模型，初始I是50帧中处的50个像素的平均值，如等式所示：μ＝Iσ＝TS23：验证处的像素是前景还是背景，公式如下，λ为阈值参数，判断的基本规则是均值μ的指定范围：在算法中，如果像素I属于背景，就会被替换为0，否则就会被替换为相关的非零值；S24：更新参数和背景，α为学习率，数值越大，背景更新越快，这里α＝0.02；μ＝*μ+α*Iσ＝√*σ2+α*-μ))2S25：重复S23和S24，直到视频停止，即可提取出红外图像中疑似VOCs泄漏区域。9.根据权利要求7所述的跨场景的VOCs气体泄漏检测系统，其特征在于：所述识别单元，具体处理步骤包括如下细分步骤S51至S54：S51：候选框中的特征向量表示为xi＝∈Rd，其标记为yi＝表示是否有VOCs泄漏；将源域特征数据集及其标记及作为目标域特征数据记为xt，无目标域标记；通过特征迁移的方式，将源域数据和目标域数据映射到共享的特征空间X和标记空间Y，即xs,xt∈X，ys,yt∈Y；S52：通过数据转换函数将数据和目标域数据转换到共享的特征空间和标记空间中；转换函数设计为f＝hω，其中ω为权重矩阵,h为随机映射后的实例，表示为其中αi∈Rd，bi∈R表示随机生成的权重和偏置；i＝1,…,l表示前馈神经网络的节点数；为非线性的激活函数；S53：寻找最优的数据转换函数，构建目标函数如下其中φ为正则化项；HS和HT是随机映射实列矩阵；Z是目标域中实列信息的保留项；而PMMD则是投影最大平均偏差，用来测量HS和HT之间的差距，表示为其中，Tr为矩阵的迹；表示边缘PMMD矩阵，计算方式为由此公式估计出边缘分布的差异；考虑到目标域是没有进行标记的，需要估计条件分布的差异，因此对伪标签进行PMMD的扩展，其表示为其中，和分别为真实标签和伪标签；ns和分别表示为源域中c类数量和目标域中c类数量，表示条件PMMD矩阵，计算方式为因此，目标函数重新定义为其中，S54：通过映射函数f将数据转换到高维空间，使得源域特征和目标特征具有相同的分布；使转换后的源域特征作为训练集，通过分类器进行分类，使目标特征作为测试集，进行测试和标记是VOCs泄漏区域和非VOCs泄漏区域；计算标记的置信度，采用非极大值抑制算法，选出得分较高的候选框，最终得到目标候选框，最后通过Faster RCNN神经网络模型中的回归部分对目标候选框进行回归。10.一种计算机可读存储介质，存储有计算机程序，所述计算机程序被处理器执行时，使得所述处理器执行如权利要求1-6中任一项所述方法的步骤。
说明书desc
技术领域本发明涉及环境检测领域中VOCs气体泄漏检测技术领域，具体涉及一种跨场景的VOCs气体泄漏检测方法、系统及存储介质。背景技术近年来，随着石油化工行业的迅速发展，生产安全问题也越来越重要。如挥发性有机化合物的泄露会导致癌症、出生缺陷和生殖影响等人类健康问题。VOCs还有导致了臭氧的形成，臭氧是烟雾的主要来源，也是城市地区和炼油厂和化工厂附近地区呼吸系统疾病的主要原因之一，因此，对VOCs的检测与治理已成为当前空气处理问题的一个焦点。考虑到VOCs的领域知识，VOCs具有湍流现象，即VOCs图像是一系列连续运动区域。如果去除大的静态背景，VOCs检测的计算量将大大减少。以及考虑到数据量过大，往往标记数据需要花费大量的时间。发明内容本发明提出的一种跨场景的VOCs气体泄漏检测方法、系统及存储介质，可以实现快速可靠地进行VOCs泄漏检测，并可以嵌入到现有的安全监控系统中，而不是安装另一个检测系统，这可以有效降低设备更换和新系统安装的成本。为实现上述目的，本发明采用了以下技术方案：一种跨场景的VOCs气体泄漏检测方法，包括以下步骤，S1：获取存在VOCs泄漏和无泄漏的红外视频数据并对其进行数据预处理；S2：采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域；S3：对目标检测模型Faster RCNN神经网络模型进行预训练；S4：通过已训练好的Faster RCNN神经网络模型，构造迁移学习中的源域特征数据集和目标域特征数据集；S5：运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。进一步地，所述步骤S1具体包括如下细分步骤S11至S13：S11：准备VOCs泄漏红外视频，每个视频均超过30秒且为“avi”格式，而视频像素可以不相等；S12：从红外视频数据中截取出VOCs泄漏图像创建数据集，并对相应帧做好标注；S13：对红外VOCs泄漏图像数据进行随机旋转、帧尺寸归一化这些预处理操作。进一步的，所述上述步骤S2具体包括如下细分步骤S21至S25：S21：GMM表示为其中G,μj,σj)是像素值的概率密度分布，θ是GMM的一组参数，θ＝G,μj,σj)，μj和σj是模型的平均值和标准差，I是处像素值；S22：初始化背景模型，初始化均值μ0、标准差σ0和微分阈值T；为了初始化GMM，前50帧用于初始化混合模型中的三个高斯模型，初始I是50帧中处的50个像素的平均值，如等式所示：μ＝Iσ＝TS23：验证处的像素是前景还是背景，公式如下，λ为阈值参数，判断的基本规则是均值μ的指定范围：在算法中，如果像素I属于背景，就会被替换为0，否则就会被替换为相关的非零值；S24：更新参数和背景，α为学习率，数值越大，背景更新越快，这里α＝0.02；μ＝*μ+α*IS25：重复S23和S24，直到视频停止，即可提取出红外图像中疑似VOCs泄漏区域。进一步的，所述步骤S3具体包括如下细分步骤S31至S32：S31：采用公共数据集对Faster RCNN神经网络模型进行训练；S32：将S1中部分VOCs泄漏图像和标记数据输入到Faster RCNN神经网络模型中进行预训练，使模型结构调整到更适应VOCs泄漏检测的参数。进一步的，所述步骤S4具体包括如下细分步骤S41至S42：S41：将S1中剩余部分VOCs泄漏图像作为源域DS，将GMM提取出的疑似VOCs泄漏区域图像作为目标域DT；S42：将DS和DT输入到S32训练好的Faster RCNN神经网络模型中，首先通过卷积层得到特征图，再经过RPN区域建议网络生成候选框，将候选框与特征图结合即得到源域特征数据集和目标域特征数据集。进一步的，所述步骤S5具体包括如下细分步骤S51至S54：S51：候选框中的特征向量表示为xi＝∈Rd，其标记为yi＝表示是否有VOCs泄漏；将源域特征数据集及其标记及作为目标域特征数据记为xt，无目标域标记；通过特征迁移的方式，将源域数据和目标域数据映射到共享的特征空间X和标记空间Y，即xs,xt∈X，ys,yt∈Y；S52：通过数据转换函数将数据和目标域数据转换到共享的特征空间和标记空间中；转换函数设计为f＝hω，其中ω为权重矩阵,h为随机映射后的实例，表示为其中αi∈Rd，bi∈R表示随机生成的权重和偏置；i＝1,…,l表示前馈神经网络的节点数；为非线性的激活函数；S53：寻找最优的数据转换函数，构建目标函数如下其中φ为正则化项；HS和HT是随机映射实列矩阵；Z是目标域中实列信息的保留项；而PMMD则是投影最大平均偏差，用来测量HS和HT之间的差距，表示为其中，Tr为矩阵的迹；表示边缘PMMD矩阵，计算方式为由此公式估计出边缘分布的差异；考虑到目标域是没有进行标记的，需要估计条件分布的差异，因此对伪标签进行PMMD的扩展，其表示为其中，和分别为真实标签和伪标签；ns和分别表示为源域中c类数量和目标域中c类数量，表示条件PMMD矩阵，计算方式为因此，目标函数重新定义为其中，S54：通过映射函数f将数据转换到高维空间，使得源域特征和目标特征具有相同的分布；使转换后的源域特征作为训练集，通过分类器进行分类，使目标特征作为测试集，进行测试和标记是VOCs泄漏区域和非VOCs泄漏区域；计算标记的置信度，采用非极大值抑制算法，选出得分较高的候选框，最终得到目标候选框，最后通过Faster RCNN神经网络模型中的回归部分对目标候选框进行回归。另一方面，本发明还公开一种跨场景的VOCs气体泄漏检测系统，包括以下单元，数据获取单元，用于获取存在VOCs泄漏和无泄漏的红外视频数据并对其进行数据预处理；数据提取单元，用于采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域；模型训练单元，用于对目标检测模型Faster RCNN神经网络模型进行预训练；数据集构建单元，用于通过已训练好的Faster RCNN神经网络模型，构造迁移学习中的源域特征数据集和目标域特征数据集；识别单元，用于运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。进一步的，所述数据提取单元，具体处理步骤包括如下细分步骤S21至S25：S21：GMM表示为其中G，μj，σj)是像素值的概率密度分布，θ是GMM的一组参数，θ＝G，μj，σj)，μj和σj是模型的平均值和标准差，I是处像素值；S22：初始化背景模型，初始化均值μ0、标准差σ0和微分阈值T；为了初始化GMM，前50帧用于初始化混合模型中的三个高斯模型，初始I是50帧中处的50个像素的平均值，如等式所示：μ＝Iσ＝TS23：验证处的像素是前景还是背景，公式如下，λ为阈值参数，判断的基本规则是均值μ的指定范围：在算法中，如果像素I属于背景，就会被替换为0，否则就会被替换为相关的非零值；S24：更新参数和背景，α为学习率，数值越大，背景更新越快，这里α＝0.02；μ＝*μ+α*IS25：重复S23和S24，直到视频停止，即可提取出红外图像中疑似VOCs泄漏区域。进一步的，所述识别单元，具体处理步骤包括如下细分步骤S51至S54：S51：候选框中的特征向量表示为xi＝∈Rd，其标记为yi＝表示是否有VOCs泄漏；将源域特征数据集及其标记及作为目标域特征数据记为xt，无目标域标记；通过特征迁移的方式，将源域数据和目标域数据映射到共享的特征空间X和标记空间Y，即xs,xt∈X，ys,yt∈Y；S52：通过数据转换函数将数据和目标域数据转换到共享的特征空间和标记空间中；转换函数设计为f＝hω，其中ω为权重矩阵,h为随机映射后的实例，表示为其中αi∈Rd，bi∈R表示随机生成的权重和偏置；i＝1,…,l表示前馈神经网络的节点数；为非线性的激活函数；S53：寻找最优的数据转换函数，构建目标函数如下其中φ为正则化项；HS和HT是随机映射实列矩阵；Z是目标域中实列信息的保留项；而PMMD则是投影最大平均偏差，用来测量HS和HT之间的差距，表示为其中，Tr为矩阵的迹；表示边缘PMMD矩阵，计算方式为由此公式估计出边缘分布的差异；考虑到目标域是没有进行标记的，需要估计条件分布的差异，因此对伪标签进行PMMD的扩展，其表示为其中，和分别为真实标签和伪标签；ns和分别表示为源域中c类数量和目标域中c类数量，表示条件PMMD矩阵，计算方式为因此，目标函数重新定义为其中，S54：通过映射函数f将数据转换到高维空间，使得源域特征和目标特征具有相同的分布；使转换后的源域特征作为训练集，通过分类器进行分类，使目标特征作为测试集，进行测试和标记是VOCs泄漏区域和非VOCs泄漏区域；计算标记的置信度，采用非极大值抑制算法，选出得分较高的候选框，最终得到目标候选框，最后通过Faster RCNN神经网络模型中的回归部分对目标候选框进行回归。又一方面，本发明还公开一种计算机可读存储介质，存储有计算机程序，所述计算机程序被处理器执行时，使得所述处理器执行如上述方法的步骤。由上述技术方案可知，本发明提出了一种跨场景的VOCs气体泄漏检测方法及系统，首先利用红外视频中VOCs的领域知识分割视频帧中的可疑VOCs泄漏区域，旨在实现快速检测的同时降低计算量。再使用现有深度神经网络，运用迁移学习方式对VOCs进行识别，将VOCs区域与所有疑似区域区分开来。本发明的跨场景的VOCs气体泄漏检测方法，能够克服现有方法的不足，充分利用红外视频中VOCs气体区域的领域知识对视频帧中的可疑烟雾区域分割，随后再使用FasterRCNN神经网络模型，运用迁移学习的方式对VOCs泄漏区域进行检测识别，从而显低计算性能需求和标记所带来的时间耗费。附图说明图1为本发明方法总体网络模型示意图；图2为Faster RCNN神经网络模型结构流程图；图3为本发明实验结果。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。如图1所示，本实施例所述的跨场景的VOCs气体泄漏检测方法，包括以下步骤：步骤1：获取存在VOCs泄漏和无泄漏的红外视频数据并对其进行数据预处理。步骤2：采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域。步骤3：对目标检测模型Faster RCNN神经网络模型进行预训练。步骤4：通过已训练好的Faster RCNN神经网络模型，构造迁移学习中的源域特征数据集和目标域特征数据集。步骤5：运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。需要说明的是，本实例为一个二阶段检测方案，初始阶段中利用VOCs的领域知识来消除帧中的静态干扰。第二阶段用训练好的Faster RCNN网络识别VOCs区域。最后，在框架上标记矩形框来指示烟雾区域。从而提高了VOCs区域识别的速度和有效性。以下具体说明：进一步地，上述步骤S1：获取存在VOCs泄漏和无泄漏的红外视频数据并对进行数据预处理。具体包括如下细分步骤S11至S13：S11：准备VOCs泄漏红外视频，每个视频均超过30秒且为“avi”格式，而视频像素可以不相等。S12：从红外视频数据中截取出VOCs泄漏图像创建数据集，并对相应帧做好标注。S13：对红外VOCs泄漏图像数据进行随机旋转、帧尺寸归一化等预处理操作。进一步地，上述步骤S2：采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域。具体包括如下细分步骤S21至S25：S21：GMM表示为其中G，μj，σj)是像素值的概率密度分布。θ是GMM的一组参数，θ＝G,μj,σj)。μj和σj是模型的平均值和标准差。I是处像素值。S22：初始化背景模型，初始化均值μ0、标准差σ0和微分阈值T。为了初始化GMM，前50帧用于初始化混合模型中的三个高斯模型。初始I是50帧中处的50个像素的平均值，如等式所示。μ＝Iσ＝TS23：验证处的像素是前景还是背景。公式如下，λ为阈值参数，判断的基本规则是均值μ的一定范围。这是基于域的运动检测的重要步骤。在算法中，如果像素I属于背景，就会被替换为0，否则就会被替换为相关的非零值。S24：更新参数和背景。α为学习率，数值越大，背景更新越快。这里α＝0.02。μ＝*μ+α*IS25：重复S23和S24，直到视频停止，即可提取出红外图像中疑似VOCs泄漏区域。进一步地，上述步骤S3：对目标检测模型Faster RCNN神经网络模型进行预训练。具体包括如下细分步骤S31至S32：S31：采用公共数据集对Faster RCNN神经网络模型进行训练。S32：为使模型更好的适应VOCs泄漏检测，将S1中部分VOCs泄漏图像和标记数据输入到Faster RCNN神经网络模型中进行预训练，使模型结构调整到更适应VOCs泄漏检测的参数。进一步地，上述步骤S4：通过已训练好的Faster RCNN神经网络模型，构造源域特征数据集和目标域特征数据集。具体包括如下细分步骤S41至S42：S41：将S1中剩余部分VOCs泄漏图像作为源域DS，将GMM提取出的疑似VOCs泄漏区域图像作为目标域DT。S42：将DS和DT输入到S32训练好的Faster RCNN神经网络模型中。首先通过卷积层得到特征图，再经过RPN区域建议网络生成候选框，将候选框与特征图结合即得到源域特征数据集和目标域特征数据集。进一步地，上述步骤S5：运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。具体包括如下细分步骤S51至S54：S51：候选框中的特征向量表示为xi＝∈Rd，其标记为yi＝表示是否有VOCs泄漏。将源域特征数据集及其标记及作为目标域特征数据记为xt，无目标域标记。通过特征迁移的方式，将源域数据和目标域数据映射到共享的特征空间X和标记空间Y，即xs,xt∈X，ys,yt∈Y。S52：通过数据转换函数将数据和目标域数据转换到共享的特征空间和标记空间中。转换函数设计为f＝hω，其中ω为权重矩阵,h为随机映射后的实例，可表示为其中αi∈Rd，bi∈R表示随机生成的权重和偏置；i＝1,…,l表示前馈神经网络的节点数；为非线性的激活函数。S53：寻找最优的数据转换函数，构建目标函数如下其中φ为正则化项；HS和HT是随机映射实列矩阵；Z是目标域中实列信息的保留项。而PMMD则是投影最大平均偏差，用来测量HS和HT之间的差距，可以表示为其中，Tr为矩阵的迹；表示边缘PMMD矩阵，计算方式为由此公式可以估计出边缘分布的差异。考虑到目标域是没有进行标记的，需要估计条件分布的差异，因此对伪标签进行PMMD的扩展，其表示为其中，和分别为真实标签和伪标签；ns和分别表示为源域中c类数量和目标域中c类数量。表示条件PMMD矩阵，计算方式为因此，目标函数可以重新定义为其中，S54：通过映射函数f将数据转换到高维空间，使得源域特征和目标特征具有相同的分布。使转换后的源域特征作为训练集，通过分类器进行分类，使目标特征作为测试集，进行测试和标记是VOCs泄漏区域和非VOCs泄漏区域。计算标记的置信度，采用非极大值抑制算法，选出得分较高的候选框，最终得到目标候选框。最后通过Faster RCNN神经网络模型中的回归部分对目标候选框进行回归。图3是本发明的实验结果，第一组图为化工生产设备VOCs泄漏场景源域数据集在Faster RCNN上检测结果，第二组图为另一场景红外视频中VOCs泄漏的连续帧目标域检测结果。图中蓝色框线部分为检测目标，标注为VOCs气体。可以看出通过迁移学习的方法可以很好的提升模型的泛化能力，自适应不同场景，为模型训练和数据标记节省时间。并且在第二组图中给出的预测值为右下角的0.965，代表该帧所处目标场景存在VOCs气体泄漏的概率为96.5％。从中可以看出我们基于GMM静态背景去除和迁移学习的方法，可以高效的检测出VOCs气体泄漏的情况。综上所述，本发明的一种跨场景的VOCs气体泄漏检测方法考虑到VOCs的领域知识，VOCs具有湍流现象，即VOCs图像是一系列连续运动区域。通过GMM去除静态背景，VOCs检测的计算量大大减少。需要说明的是GMM是一种快速简单的运动检测方法，可以快速的提取出疑似VOCs泄漏区域，因此所检测的疑似VOC泄漏区域是离散。而在这个框架中，我们关心的是快速找到运动区域，所以离散的烟雾区域在初始阶段是可以接受的。再使用已经训练好的Faster RCNN神经网络，减少了训练时间和计算性能的要求。使用迁移学习方，减少了对数据进行标记的时间，提升了整体模型效率另一方面，本发明还公开一种跨场景的VOCs气体泄漏检测系统，包括以下单元，数据获取单元，用于获取存在VOCs泄漏和无泄漏的红外视频数据并对其进行数据预处理；数据提取单元，用于采用GMM去除红外视频静态背景，提取出红外图像中疑似VOCs泄漏区域；模型训练单元，用于对目标检测模型Faster RCNN神经网络模型进行预训练；数据集构建单元，用于通过已训练好的Faster RCNN神经网络模型，构造迁移学习中的源域特征数据集和目标域特征数据集；识别单元，用于运用域自适应的迁移学习方法对GMM提取出的红外疑似VOCs泄漏区域进行识别。进一步的，所述数据提取单元，具体处理步骤包括如下细分步骤S21至S25：S21：GMM表示为其中G,μj,σj)是像素值的概率密度分布，θ是GMM的一组参数，θ＝G,μj,σj)，μj和σj是模型的平均值和标准差，I是处像素值；S22：初始化背景模型，初始化均值μ0、标准差σ0和微分阈值T；为了初始化GMM，前50帧用于初始化混合模型中的三个高斯模型，初始I是50帧中处的50个像素的平均值，如等式所示：μ＝Iσ＝TS23：验证处的像素是前景还是背景，公式如下，λ为阈值参数，判断的基本规则是均值μ的指定范围：在算法中，如果像素I属于背景，就会被替换为0，否则就会被替换为相关的非零值；S24：更新参数和背景，α为学习率，数值越大，背景更新越快，这里α＝0.02；μ＝*μ+α*IS25：重复S23和S24，直到视频停止，即可提取出红外图像中疑似VOCs泄漏区域。进一步的，所述识别单元，具体处理步骤包括如下细分步骤S51至S54：S51：候选框中的特征向量表示为xi＝∈Rd，其标记为yi＝表示是否有VOCs泄漏；将源域特征数据集及其标记及作为目标域特征数据记为xt，无目标域标记；通过特征迁移的方式，将源域数据和目标域数据映射到共享的特征空间X和标记空间Y，即xs,xt∈X，ys,yt∈Y；S52：通过数据转换函数将数据和目标域数据转换到共享的特征空间和标记空间中；转换函数设计为f＝hω，其中ω为权重矩阵,h为随机映射后的实例，表示为其中αi∈Rd，bi∈R表示随机生成的权重和偏置；i＝1,…,l表示前馈神经网络的节点数；为非线性的激活函数；S53：寻找最优的数据转换函数，构建目标函数如下其中φ为正则化项；HS和HT是随机映射实列矩阵；Z是目标域中实列信息的保留项；而PMMD则是投影最大平均偏差，用来测量HS和HT之间的差距，表示为其中，Tr为矩阵的迹；表示边缘PMMD矩阵，计算方式为由此公式估计出边缘分布的差异；考虑到目标域是没有进行标记的，需要估计条件分布的差异，因此对伪标签进行PMMD的扩展，其表示为其中，和分别为真实标签和伪标签；ns和分别表示为源域中c类数量和目标域中c类数量，表示条件PMMD矩阵，计算方式为因此，目标函数重新定义为其中，S54：通过映射函数f将数据转换到高维空间，使得源域特征和目标特征具有相同的分布；使转换后的源域特征作为训练集，通过分类器进行分类，使目标特征作为测试集，进行测试和标记是VOCs泄漏区域和非VOCs泄漏区域；计算标记的置信度，采用非极大值抑制算法，选出得分较高的候选框，最终得到目标候选框，最后通过Faster RCNN神经网络模型中的回归部分对目标候选框进行回归。图3中的第一组图为化工生产设备VOCs泄漏场景源域数据集在Faster RCNN上检测结果，第二组图为另一场景红外视频中VOCs泄漏的连续帧目标域检测结果。图中灰色框线部分为检测目标，标注为VOCs气体。可以看出通过迁移学习的方法可以很好的提升模型的泛化能力，自适应不同场景，为模型训练和数据标记节省时间。并且在第二组图中给出的预测值为右下角的0.965，代表该帧所处目标场景存在VOCs气体泄漏的概率为96.5％。从中可以看出我们基于GMM静态背景去除和迁移学习的方法，可以高效的检测出VOCs气体泄漏的情况。总而言之，本发明的一种基于领域知识迁移的跨场景的VOCs气体泄漏检测方法的优点在于：考虑到VOCs的领域知识，VOCs具有湍流现象，即VOCs图像是一系列连续运动区域。通过GMM去除静态背景，VOCs检测的计算量大大减少。需要说明的是GMM是一种快速简单的运动检测方法，可以快速的提取出疑似VOCs泄漏区域，因此所检测的疑似VOC泄漏区域是离散。而在这个框架中，我们关心的是快速找到运动区域，所以离散的烟雾区域在初始阶段是可以接受的。再使用已经训练好的Faster RCNN神经网络，减少了训练时间和计算性能的要求。使用迁移学习方，减少了对数据进行标记的时间，提升了整体模型效率。又一方面，本发明还公开一种计算机可读存储介质，存储有计算机程序，所述计算机程序被处理器执行时，使得所述处理器执行如上述方法的步骤。可理解的是，本发明实施例提供的系统与本发明实施例提供的方法相对应，相关内容的解释、举例和有益效果可以参考上述方法中的相应部分。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
