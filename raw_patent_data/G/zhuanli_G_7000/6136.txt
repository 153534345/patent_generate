标题title
一种车载式道路标志标线巡检系统
摘要abst
本发明涉及一种车载式道路标志标线巡检系统，属于机器视觉技术领域，它包括WEB服务器、PC智能视觉模块和手机APP；所述WEB服务器用于对交通标志和交通标线的台账数据进行维护，并对PC智能视觉模块和手机APP上传的数据进行汇总以及综合检测结果的展示与导出；PC智能视觉模块用于标志标线的快速采集、实时分析并实时将检测结果通过4G网络上传到WEB服务器；所述手机APP用于交通标志信息的录入并上传到WEB服务器后以台账的形式下发到PC智能视觉模块。本发明综合成本降低50%，漏检率降低30%；数据实时性，安全性，可靠性高，在整个数据链条中，极大降低了由人员不规范操作导致数据异常的概率。
权利要求书clms
1.一种车载式道路标志标线巡检系统，其特征在于：它包括WEB服务器、PC智能视觉模块和手机APP；所述WEB服务器用于对交通标志和交通标线的台账数据进行维护，并对PC智能视觉模块和手机APP上传的数据进行汇总以及综合检测结果的展示与导出；所述PC智能视觉模块包括传感器端和IPC端，IPC端从传感器端获取传感器数据，并对传感器端中的相机进行控制，所述IPC端包括数据采集控制与显示端和视觉分析与计算端；所述数据采集控制与显示端用于采集传感器端传输的GPS、距离、速度和图像数据，根据图像的亮度通过PID算法对相机曝光度进行调节，根据曝光度进行符合图像拖影限制的车辆行驶速度计算，并将交通标志标线相机数据实时打包发送到视觉分析与计算端，并根据视觉分析与计算端的结果进行检测结果显示；所述视觉分析与计算端用于交通标线检测识别、定位与分析，以及交通标志检测识别、跟踪、择优和匹配分析；所述手机APP用于交通标志信息的录入并上传到WEB服务器后以台账的形式下发到PC智能视觉模块。2.根据权利要求1所述的一种车载式道路标志标线巡检系统，其特征在于：所述视觉分析与计算端对交通标线检测识别具体包括通过相机采集交通标线的图像，对图像进行去水雾、去逆光和图像亮度调整的预处理，通过深度学习网络对交通标线进行识别和定位，以及现交通标线完整程度分割检测，最后通过opencv视觉算法在深度学习的基础上完成对单位距离内交通标线上标线部分面积、裂纹和脏污面积的计算。3.根据权利要求1所述的一种车载式道路标志标线巡检系统，其特征在于：所述视觉分析与计算端对交通标志的检测识别具体包括以下内容：对相机采集的交通标志图像进行图像长宽调整、图像暗通道去雾、图像亮度调整、图像归一化和图像通道调整的预处理，并将指路和组合交通标志划分为第一类交通标志，将禁令、警告和指示交通标志划分为第二类交通标志；将经过预处理后的第一类交通标志图像输入到A网络模型进行推理检测，并对检测结果进行非极大抑制处理，同时剔除位于图像边缘的检测结果；计算A网络模型检测结果之间的交并比，对一个标志牌出现在另一个标志牌内部的情况进行抑制，得到处理后的指路交通标志的检测结果BIG和组合交通标志的检测结果BIG_C；将经过预处理后的第二类交通标志图像输入到B网络模型进行推理检测，并对检测结果进行非极大抑制处理，同时剔除位于图像边缘的检测结果，得到处理后的检测结果SMALL；计算B网络模型的检测结果SMALL与A网络模型检测结果BIG和BIG_C之间的交并比，过滤掉检测结果BIG和BIG_C中出现检测结果SMALL的情况；对检测结果SMALL进行截图，并将截图后的图像经过图像长宽调整、图像归一化和图像通道调整的预处理后输入到C网络模型进行推理检测，对检测结果进行非极大抑制处理，得到处理后的警告标志的检测结果WARNING、禁令标志的检测结果BAN和指示标志的检测结果TNDICATE；输出最后的检测结果BIG、BIG_C、WARNING、BAN和INDICATE。4.根据权利要求3所述的一种车载式道路标志标线巡检系统，其特征在于：所述视觉分析与计算端对交通标志的择优具体包括以下内容：检测结果BIG与BIG_C类别出现在道路上方，在图像采集过程中，标志牌从图像下半部分进入视野，消失在图像上半部分，将检测结果BIG与BIG_C择优分为3个优先级，图像高度为H，图像宽度为W，第1优先级为图像中间高度范围部分，该部分按时间顺序有M张图像出现则选择出第M/2张图像作为择优图；第2优先级为图像下端高度部分，按时间顺序进入该部分的第一张为择优图；第3优先级为图像中上端高端部分，按时间顺序进入该部分的最后一张图为择优图；检测结果WARNING、BAN和INDICATE出现在道路上方与侧方的概率相等，则通过长宽比和尺寸择优，选择长宽比在1-1.4之间，且面积最大的图像作为择优图。5.根据权利要求4所述的一种车载式道路标志标线巡检系统，其特征在于：所述视觉分析与计算端对交通标志的匹配分析具体包括以下内容：GPS坐标匹配：将择优后的标志牌图像中带有的检测到其时刻的GPS坐标gps_s，台账数据中每一条台账带有GPS坐标gps_l，与系统中处于激活状态的台账进行GPS坐标匹配，计算gps_s与gps_l之间的距离dis_ls，如果dis_ls不大于预设距离，则该标志牌视为gps_l对应台账的候选标志牌，进入台账的数据缓冲区；文字语义匹配：对台账数据缓冲区中的每个图像进行OCR提取和识别，得到文字特征识别结果为chars_img，比较台账中的文字char_ledger与每个图像得到的chars_img的相似度chars_score，如果第N个chars_img对应的相似度chars_score大于或等于第N-1个chars_img对应的相似度chars_score，则第N个chars_img对应的图像为文字语义匹配结果，相似度标记为chars_score_max，如果chars_score_max大于等于0.5，则表示文字语义匹配成功，进入异常判定程序，否则匹配失败，生成检测视频并上传。6.根据权利要求5所述的一种车载式道路标志标线巡检系统，其特征在于：如果台账中没有提取到文字特征就进行图像语义匹配，图像语义匹配包括BIG_C图像语义匹配、WARNING图像语义匹配、BAN图像语义匹配、INDICATE图像语义匹配，线性诱导标志牌I_2图像语义匹配和标记行车标志牌BJCD图像语义匹配，如果匹配成功则进入异常判定程序，否则生成检测视频并上传。7.根据权利要求6所述的一种车载式道路标志标线巡检系统，其特征在于：所述BIG_C图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过B网络模型进行SMALL标志牌检测；如果检测的图像缓冲区中SMALL标志牌的数量与台账中SMALL标志牌数量一致且图像数量为1，则将该图像作为匹配图像，进入异常判定程序，并执行后续步骤，同时将图像标记为SMALL_C，如果图像数量为0，则视为图像语义匹配失败，生成检测视频并上传；对SMALL_C进行图像特征提取，并通过C网络进行SMALL标志牌分类，分类结果标记为SMALL_C_BWI；选择图像缓冲区中SMALL_C_BWI特征与台账的SMALL_C_BWI特征一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传。8.根据权利要求6所述的一种车载式道路标志标线巡检系统，其特征在于：所述线性诱导标志牌I_2图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通以EfficientNet为主干的网络模型C_I_2对图像进行识别判定其是否符合线性诱导标志牌I_2类别的特征；选择图像缓冲区中符合线性诱导标志牌I_2类别特征且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则是让图像语义匹配失败，生成检测视频并上传；所述标记行车标志牌BJCD图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BJCD对图像进行识别判定其是否符合标记行车标志牌BJCD类别的特征；选择图像缓冲区中符合标记行车标志牌BJCD类别特征且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传。9.根据权利要求6所述的一种车载式道路标志标线巡检系统，其特征在于：所述BAN图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BAN对图像进行识别，得到18种识别结果，如果台账中有标志牌特征存在数字，则通过OCR网络模型提取数字，如果不存在数字则标记为-1，最后得到结果标记为CF_BAN；选择图像缓冲区中CF_BAN特征与台账中的CF_BAN特征一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传；所述WARNING图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BAN对图像进行识别，得到35种识别结果，如果台账中有标志牌特征存在数字，则通过OCR网络模型提取数字，如果不存在数字则标记为-1，最后得到结果标记为CF_WARNING；选择图像缓冲区中CF_WARNING特征与台账中的CF_WARNING信息一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传；所述INDICATE图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BAN对图像进行识别，得到10种识别结果，如果台账中有标志牌特征存在数字，则通过OCR网络模型提取数字，如果不存在数字则标记为-1，最后得到结果标记为CF_INDICATE；选择图像缓冲区中CF_INDICATE特征与台账中的CF_INDICATE特征一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传。
说明书desc
技术领域本发明涉及机器视觉技术领域，尤其涉及一种车载式道路标志标线巡检系统。背景技术现阶段我国对道路上的交通标志和交通标线进行日常巡检主要是通过人工的方式进行，由工作人员按照交通标志的卫星定位坐标进行导航，通过汽车等交通工具到达交通标志牌处对交通标志牌的正常与否状态进行判定，并在行进过程中对道路交通标线的正常与否状态进行判定，并通过手机应用程序将巡检结果上传到服务器。但是现有的人工巡检方式主要存在以下几个问题：1、效率低、成本高、漏检率高，一组工作人员每天的巡检里程仅能达到100km，对于大城市而言，完成每月的道路巡检任务需要设置多个巡检小组，由于巡检的辖区范围太大，巡检人员如果对巡检路线不熟悉，容易造成交通标志漏检；2、存在交通安全风险，工作人员需要下车进行交通标志标线的检查，该操作存在出现交通事故的风险；3、巡检数据实时性、安全性和可靠性差，由于巡检由人工完成，故而巡检在上传服务器这一过程中需要人工参与，容易造成巡检人员上传的数据有误，同时系统后台无法有效的记录巡检人员的巡检里程和实时动态。需要说明的是，在上述背景技术部分公开的信息只用于加强对本公开的背景的理解，因此可以包括不构成对本领域普通技术人员已知的现有技术的信息。发明内容本发明的目的在于克服现有技术的缺点，提供了一种车载式道路标志标线巡检系统，解决了现有巡检方式存在的不足。本发明的目的通过以下技术方案来实现：一种车载式道路标志标线巡检系统，它包括WEB服务器、PC智能视觉模块和手机APP；所述WEB服务器用于对交通标志和交通标线的台账数据进行维护，并对PC智能视觉模块和手机APP上传的数据进行汇总以及综合检测结果的展示与导出；所述PC智能视觉模块包括传感器端和IPC端，IPC端从传感器端获取传感器数据，并对传感器端中的相机进行控制，所述IPC端包括数据采集控制与显示端和视觉分析与计算端；所述数据采集控制与显示端用于采集传感器端传输的GPS、距离、速度和图像数据，根据图像的亮度通过PID算法对相机曝光度进行调节，根据曝光度进行符合图像拖影限制的车辆行驶速度计算，并将交通标志标线相机数据实时打包发送到视觉分析与计算端，并根据视觉分析与计算端的结果进行检测结果显示；所述视觉分析与计算端用于交通标线检测识别、定位与分析，以及交通标志检测识别、跟踪、择优和匹配分析；所述手机APP用于交通标志信息的录入并上传到WEB服务器后以台账的形式下发到PC智能视觉模块。所述视觉分析与计算端对交通标线检测识别具体包括通过相机采集交通标线的图像，对图像进行去水雾、去逆光和图像亮度调整的预处理，通过深度学习网络对交通标线进行识别和定位，以及现交通标线完整程度分割检测，最后通过opencv视觉算法在深度学习的基础上完成对单位距离内交通标线上标线部分面积、裂纹和脏污面积的计算。所述视觉分析与计算端对交通标志的检测识别具体包括以下内容：对相机采集的交通标志图像进行图像长宽调整、图像暗通道去雾、图像亮度调整、图像归一化和图像通道调整的预处理，并将指路和组合交通标志划分为第一类交通标志，将禁令、警告和指示交通标志划分为第二类交通标志；将经过预处理后的第一类交通标志图像输入到A网络模型进行推理检测，并对检测结果进行非极大抑制处理，同时剔除位于图像边缘的检测结果；计算A网络模型检测结果之间的交并比，对一个标志牌出现在另一个标志牌内部的情况进行抑制，得到处理后的指路交通标志的检测结果BIG和组合交通标志的检测结果BIG_C；将经过预处理后的第二类交通标志图像输入到B网络模型进行推理检测，并对检测结果进行非极大抑制处理，同时剔除位于图像边缘的检测结果，得到处理后的检测结果SMALL；计算B网络模型的检测结果SMALL与A网络模型检测结果BIG和BIG_C之间的交并比，过滤掉检测结果BIG和BIG_C中出现检测结果SMALL的情况；对检测结果SMALL进行截图，并将截图后的图像经过图像长宽调整、图像归一化和图像通道调整的预处理后输入到C网络模型进行推理检测，对检测结果进行非极大抑制处理，得到处理后的警告标志的检测结果WARNING、禁令标志的检测结果BAN和指示标志的检测结果TNDICATE；输出最后的检测结果BIG、BIG_C、WARNING、BAN和INDICATE。所述视觉分析与计算端对交通标志的择优具体包括以下内容：检测结果BIG与BIG_C类别出现在道路上方，在图像采集过程中，标志牌从图像下半部分进入视野，消失在图像上半部分，将检测结果BIG与BIG_C择优分为3个优先级，图像高度为H，图像宽度为W，第1优先级为图像中间高度范围部分，该部分按时间顺序有M张图像出现则选择出第M/2张图像作为择优图；第2优先级为图像下端高度部分，按时间顺序进入该部分的第一张为择优图；第3优先级为图像中上端高端部分，按时间顺序进入该部分的最后一张图为择优图；检测结果WARNING、BAN和INDICATE出现在道路上方与侧方的概率相等，则通过长宽比和尺寸择优，选择长宽比在1-1.4之间，且面积最大的图像作为择优图。所述视觉分析与计算端对交通标志的匹配分析具体包括以下内容：GPS坐标匹配：将择优后的标志牌图像中带有的检测到其时刻的GPS坐标gps_s，台账数据中每一条台账带有GPS坐标gps_l，与系统中处于激活状态的台账进行GPS坐标匹配，计算gps_s与gps_l之间的距离dis_ls，如果dis_ls不大于预设距离，则该标志牌视为gps_l对应台账的候选标志牌，进入台账的数据缓冲区；文字语义匹配：对台账数据缓冲区中的每个图像进行OCR提取和识别，得到文字特征识别结果为chars_img，比较台账中的文字char_ledger与每个图像得到的chars_img的相似度chars_score，如果第N个chars_img对应的相似度chars_score大于或等于第N-1个chars_img对应的相似度chars_score，则第N个chars_img对应的图像为文字语义匹配结果，相似度标记为chars_score_max，如果chars_score_max大于等于0.5，则表示文字语义匹配成功，进入异常判定程序，否则匹配失败，生成检测视频并上传。如果台账中没有提取到文字特征就进行图像语义匹配，图像语义匹配包括BIG_C图像语义匹配、WARNING图像语义匹配、BAN图像语义匹配、INDICATE图像语义匹配，线性诱导标志牌I_2图像语义匹配和标记行车标志牌BJCD图像语义匹配，如果匹配成功则进入异常判定程序，否则生成检测视频并上传。所述BIG_C图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过B网络模型进行SMALL标志牌检测；如果检测的图像缓冲区中SMALL标志牌的数量与台账中SMALL标志牌数量一致且图像数量为1，则将该图像作为匹配图像，进入异常判定程序，并执行后续步骤，同时将图像标记为SMALL_C，如果图像数量为0，则视为图像语义匹配失败，生成检测视频并上传；对SMALL_C进行图像特征提取，并通过C网络进行SMALL标志牌分类，分类结果标记为SMALL_C_BWI；选择图像缓冲区中SMALL_C_BWI特征与台账中的SMALL_C_BWI特征一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传。所述线性诱导标志牌I_2图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通以EfficientNet为主干的网络模型C_I_2对图像进行识别判定其是否符合线性诱导标志牌I_2类别的特征；选择图像缓冲区中符合线性诱导标志牌I_2类别特征且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则是让图像语义匹配失败，生成检测视频并上传；所述标记行车标志牌BJCD图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BJCD对图像进行识别判定其是否符合标记行车标志牌BJCD类别的特征；选择图像缓冲区中符合标记行车标志牌BJCD类别特征且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传。所述BAN图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BAN对图像进行识别，得到18种识别结果，如果台账中有标志牌特征存在数字，则通过OCR网络模型提取数字，如果不存在数字则标记为-1，最后得到结果标记为CF_BAN；选择图像缓冲区中CF_BAN特征与台账中的CF_BAN特征一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传；所述WARNING图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BAN对图像进行识别，得到35种识别结果，如果台账中有标志牌特征存在数字，则通过OCR网络模型提取数字，如果不存在数字则标记为-1，最后得到结果标记为CF_WARNING；选择图像缓冲区中CF_WARNING特征与台账中的CF_WARNING特征一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传；所述INDICATE图像语义匹配具体包括以下内容：对台账数据缓冲区的每个图像进行图像语义特征提取，通过以ResNet为主干的网络模型C_BAN对图像进行识别，得到10种识别结果，如果台账中有标志牌特征存在数字，则通过OCR网络模型提取数字，如果不存在数字则标记为-1，最后得到结果标记为CF_INDICATE；选择图像缓冲区中CF_INDICATE特征与台账一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，生成检测视频并上传。本发明具有以下优点：一种车载式道路标志标线巡检系统，效率高，成本低，漏检率低，据统计这种车载式智能巡检方案能将效率提高200%，综合成本降低50%，漏检率降低30%；安全风险低。操作人员无需下车面对复杂的交通状况；数据实时性，安全性，可靠性高。在整个数据链条中，没有人工参与，极大降低了由人员不规范操作导致数据异常的概率。附图说明图1为本发明的结构示意图；图2为PC智能视觉模块的结构示意图；图3为相机移动方向与相机中心线垂直的示意图；图4为相机移动方向与中心线成一定夹角的示意图；图5为图4中速度的分解示意图；图6为交通标线检测流程图；图7为交通标志检测流程示意图；图8为图像语义匹配流程示意图。具体实施方式为使本申请实施例的目的、技术方案和优点更加清楚，下面将结合本申请实施例中附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本申请实施例的组件可以以各种不同的配置来布置和设计。因此，以下结合附图中提供的本申请的实施例的详细描述并非旨在限制要求保护的本申请的保护范围，而是仅仅表示本申请的选定实施例。基于本申请的实施例，本领域技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本申请保护的范围。下面结合附图对本发明做进一步的描述。如图1所示，本发明WEB服务器，PC智能视觉模块和手机APP组成，WEB服务器负责对交通标志标线的台账数据进行维护、对PC智能视觉模块和手机APP上传的数据进行汇总以及综合检测结果的展示与导出。PC智能视觉模块由SUV、边缘计算工控机、相机、GPS、距离编码器以及4G路由器等组成，可完成标志标线的快速采集、实时分析并实时将检测结果通过4G网络上传到WEB服务器，便于后台人员实时掌控巡检进度和状况，便于人员和资源的调配。手机APP一方面负责交通标志信息的录入，录入的信息上传到WEB服务器后将以台账的形式下发到PC智能视觉模块，由于台账的存在，使用智能视觉巡检的人员在进行道路巡查时只需要在选择好巡检道路后一键启动系统，便可开始巡检工作，巡检过程中无需再对系统进行人为干预；另一方面则是针对遗漏的交通标志牌进行人工巡检查漏，经调查研究发现，人工查漏比例不足0.5%，主要出现的场景有：GPS信号弱，封路，交通事故。如图2所示，PC智能视觉模块由传感器端与IPC端两个组成，IPC端部署数据采集、控制与显示端以及视觉分析与计算端，IPC端包括数据采集控制与显示端和视觉分析与计算端；所述数据采集控制与显示端用于采集传感器端传输的GPS、距离、速度和图像数据，根据图像的亮度通过PID算法对相机曝光度进行调节，根据曝光度进行符合图像拖影限制的车辆行驶速度计算，并将交通标志标线相机数据实时打包发送到视觉分析与计算端，并根据视觉分析与计算端的结果进行检测结果显示；所述视觉分析与计算端用于交通标线检测识别、定位与分析，以及交通标志检测识别、跟踪、择优和匹配分析；系统运行时GPS、距离、速度和图像数据通过以太网从传感器发送到IPC端，通过对图像数据的亮度性能分析后通过以太网控制相机曝光时间，通过对图像的内容进行分析后进行检测结果展示。进一步地，PID算法包括：相机成像的亮度与曝光时间在工程上近似认为如公式，其中y表示图像亮度，x表示曝光时间，a3、a2、a1和a0表示第一种待定系数，因此其传递函数G表示为：其中，s表示复参数，b3、b2、b1和b0表示第二种待定系数，然后通过simulink构建PID控制系统，通过simulink进行调参。进一步地，限制车速计算包括：由于在整个系统的运行过程中PID控制器实时调节相机的曝光时间，且曝光时间越大车辆在允许拖影范围内的速度上限越小，为了抑制拖影需要计算限制车速。限制车速的计算分为两种情况，第一种情况如图3所示，相机移动方向与相机中心线垂直，第二种情况如图4所示，相机移动方向与中心线成一定夹角。对于第一种情况，通过将公式带入到公式/＞中即可计算出速度上限，其中，R表示每个像素代表的物理尺寸，单位:m/pixel；size表示相机单个像元的尺寸，单位:um；w表示相机水平方向的像元数量；dis表示检测目标与相机的距离，单位:m；f:表示相机镜头的焦距，单位:mm；et表示相机曝光时间，单位:us；Smear表示允许的拖影像素数量。对于第二种情况，由于速度v与相机中心线不再垂直，而是成α角度，故而需要对速度v按图5所示进行分解，分解为垂直与相机中心线的速度v2与平行于相机中心线的速度v1。通过第一种情况计算出速度v2后，通过三角函数计算可得速度，其中，v表示相机运动速度，v2表示相机垂直于中心线方向的速度，α表示相机速度方向与中心线的夹角。如图6所示，交通标线的检测由深度学习视觉与传统视觉共同完成，深度学习部分完成交通标线的识别与定位，传统视觉部分则完成预处理和统计。深度学习部分的特征网络为ResNet50,分类网络为全连接网络。数据集由CULane数据集与当地采集的数据集共同组成，为了充分利用CULane数据集的优点，同时又保证训练后的网络模型对当地的道路检测具有较好的可靠性，数据集总量为10000，当地数据集占比30%，且当地采集到的数据通过图像预处理转成CULane数据集的形态。经过大量研究发现，可以通过计算交通标线上的裂纹、脏污与底色部分的占比来对交通标线的质量进行日常评估。在交通标线的分析部分，通过opencv视觉算法在深度学习的基础上完成对单位距离内交通标线的上标线部分面积，裂纹与脏污面积的计算。由于整个系统工作中户外场景，因此采集到的图像数据无法避免的会有逆光、水雾、亮度不一致。经研究发现逆光与水雾可以通过暗通道的方式进行抑制，亮度则可以通过HSV色度空间进行调节。如图7所示，整个交通标志的检测中需要向“数据采集控制与显示端”传入目标检测结果与分析结果，分析结果又分为检测视频与标准化检测结果。检测视频仅当台账GPS匹配识别、文字匹配失败与图像语义匹配失败时上传，整个检测流程均走完的台账则上传标准化检测结果。整个检测流程的基本单位为台账，每一条台账代表一个标志牌，台账中有标志牌GPS信息、道路信息、文本信息、图像语义信息、空间分布信息等。在系统运行时，每个台账对象中均开辟一个数据缓冲区用于存储需要用来匹配和分析的图片。通过一一比对台账和巡检过程中的每个标志牌对象实现每条台账数据有且仅有一个最优的标志牌检测结果。系统运行时，首先从传感器中获取GPS数据和图像数据，在经过去水雾、去逆光和调整亮度后，进入交通标志目标检测网络，该网络以YOLOV5为基本框架，对指路、组合、禁令、警告和指示交通标志进行检测，检测结果通过HTTP请求。进一步地，在交通标志牌检测过程中使用了三个网络模型，在这里分别称之为A网络模型、B网络模型、C网络模型。A网络模型检测指路和组合交通标志，这两类交通标志的尺寸较大对其检测可以使用YOLOV5的浅层网络进行检测，同时使用TensorRT的8位推理引擎；B网络模型将禁令、警告和指示交通标志视为一种标志进行检测，将其视为一种标志检测是由于这三种交通标志种类太多若在目标检测的同时进行分类则对数据集的要求非常高，将检测与分类分成两步有利于工程实施，同时由于这三类的尺寸较小则需要YOLOV5的深层网络进行检测，同时使用TensorRT的16位以上推理引擎；C网络模型将B网络模型的检测结果分类成禁令、警告和指示三类交通标志。进一步地，对交通标志牌的检测步骤如下：1.图像预处理。2.图像从内存拷贝到显存进行A网络模型推理，并对检测结果进行非极大抑制处理,同时剔除位于图像边缘的检测结果。3.计算A网络模型检测结果之间的交并比，主要抑制一个标志牌出现在另一个标志牌内部的情况，这是由于每一个交通标志牌都是一个独立的个体，其内部的标志牌不能视为一个独立的标志牌，该步骤处理后的检测结果标记为BIG和BIG_C。4.图像从内存拷贝到显存进行B网络模型推理，并对检测结果进行非极大抑制处理，同时剔除位于图像边缘的检测结果，该步骤处理后的检测结果标记为SMALL。5. 计算B网络模型检测结果与BIG和BIG_C的交并比，主要是过滤掉出现在BIG和BIG_C中的SMALL。6.对SMALL的检测结果进行截取，截取后的图像经过图像预处理后从内存拷贝到显存进行C网络模型推理，并对检测结果进行非极大抑制处理，该步骤处理后的检测结果标记为WARNING、BAN、INDICATE。7.输出检测结果BIG、BIG_C、WARNING、BAN、INDICATE。发送到“数据采集控制与显示端”。在完成目标检测后，通过多目标跟踪算法对交通标志进行目标跟踪。由于在不同位置出现的交通标志牌其光影性能和检测；多目标跟踪的步骤如下：1.交通标志牌目标检测。2.交通标志牌图像截取，计算标志牌图像的灰度均方差用于衡量图像的清晰度，滤除不清晰的检测结果。3.标志牌的检测结果通过ByteTrack目标跟踪算法完成目标跟踪。交通标志牌的检测结果分为BIG、BIG_C、WARNING、BAN、INDICATE，在经过多目标跟踪后同一个交通标志能够有20-150张图像，图像的数量取决交通标志出现在相机视野的时间。因此需要结合统计结果对检测过程中出现在视野的同一个交通标志牌进行择优选择，择优则是从这些图像中选择出尺寸相对大、遮挡相对小的图像；具体包括以下内容：1.BIG与BIG_C类别由于大多出现在道路上方，在图像采集过程中，标志牌从图像下半部分进入视野，消失在图像上半部分，经统计分析后发现BIG与BIG_C择优分为3个优先级。图像高度为H，图像宽度为W。第1优先级为图像中0.25H-0.65H部分，该部分按时间顺序有M张图像出现则选择出第M/2张图像作为择优图；第2优先级为图像中0-0.25H部分，按时间顺序进入该部分的第一张为择优图；第3优先级为图像中0.65H-H部分，按时间顺序进入该部分的最后一张图为择优图；2. WARNING、BAN、INDICATE则由于出现在道路上方与侧方的概率近似相等，其尺寸大多为正多边形或圆形，则通过长宽比和尺寸择优。长宽比为长/宽与宽/长中大于1的值，在满足长宽比小于1.4的条件下，面积最大的图像为择优图。进一步，择优后的标志牌需要与系统中处于激活状态的台账进行GPS坐标匹配，包括：每个择优的标志牌均带有检测到其时刻的GPS坐标gps_s，台账数据中每一条台账也带有GPS坐标gps_l，计算gps_s与gps_l之间的距离dis_ls，若dis_ls不大于200m则该标志牌视作gps_l对应的台账的候选标志牌，进入台账的数据缓冲区。与台账的物理距离不超过200m时，交通标志牌进入台账的数据缓冲区。台账的状态分为激活与未激活，激活状态则需要进行匹配分析，未激活状态则属于已经完成匹配分析的情况，当台账有驶出记录时，激活转为未激活，同时对该条台账进行处理，若该条台账的数据缓冲区没有数据则生成检测系统通过该条台账GPS点的视频数据并上传。若该条台账的数据缓冲区有数据则进入语义匹配程序。进一步地，语义匹配包括文字语义匹配和图像语义匹配，其中文字语义匹配包括以下内容：1.对台账数据缓冲区的每个图像进行OCR提取：图像预处理。文字目标检测网络进行文字目标检测，并对检测结果进行非极大抑制处理。通过文字识别网络对检测到的文字目标进行识别，识别结果标记为chars_img。2.比较台账中的文字char_ledger与每个图像得到的chars_img的相似度chars_score，若第N个chars_img对应的chars_score大于或等于第N-1个的chars_score则第N个chars_img对应的图像为匹配结果，相似度标记为chars_score_max。3.若chars_score_max＞=0.5则代表此次文字语义匹配成功，并进入分析程序，否则视为文字语义匹配失败，进入检测视频输出程序。有文字特征则首先是OCR网络模型进行文字检测，若检测结果与台账的文字特征匹配成功则进入异常判定程序，否则生成检测视频并上传。若台账中没有文字特征则进入图像语义匹配程序，通过多个图像语义网络对标志牌的图像语义特征进行提取，并与台账进行匹配，若匹配成功则进入异常判定程序，否则生成检测视频并上传。进一步地，如图8所示，台账中的图像语义匹配包括BIG_C、WARNING、BAN、INDICATE，I_2，BJCD共7个类别。其中，I_2图像语义匹配包括：1.对台账数据缓冲区的每个图像进行图像语义特征提取：图像预处理；图像从内存拷贝到显存通过以EfficientNet为主干的网络模型C_I_2对图像进行识别判定其是否符合I_2类别的特征。2.选择图像缓冲区中符合I_2类别特征且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，进入检测视频输出程序。BJCD图像语义匹配包括：1.对台账数据缓冲区的每个图像进行图像语义特征提取：图像预处理；图像从内存拷贝到显存通过以ResNet为主干的网络模型C_BJCD对图像进行识别判定其是否符合BJCD类别的特征。2.选择图像缓冲区中符合BJCD类别特征且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，进入检测视频输出程序。BIG_C图像语义匹配包括：1.对台账数据缓冲区的每个图像进行图像语义特征提取：图像预处理；图像从内存拷贝到显存通过以B网络模型进行SMALL标志牌检测；2.若选择图像缓冲区中SMALL标志牌的数量与台账中SMALL标志牌数量一致的且图像数量为1则该图像作为匹配图像，并进入异常判定程序；若数量为0则视为图像语义匹配失败，进入检测视频输出程序；若数量大于1则进入步骤3，同时标记这些图像为SMALL_C。3.SMALL_C进行图像特征提取：图像预处理；图像从内存拷贝到显存通过以C网络模型进行SMALL标志牌分类，分类结果标记为SMALL_C_BWI。4.选择图像缓冲区中其SMALL_C_BWI特征与台账一致的最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，进入检测视频输出程序。BAN图像语义匹配包括：1.对台账数据缓冲区的每个图像进行图像语义特征提取：图像预处理。图像从内存拷贝到显存通过以ResNet为主干的网络模型C_BAN对图像进行识别，识别结果有18种分别为b0、b1、b2、b3、b4、b5、b6、b7、b8、b9、b10、b11、b12、b13、b14、b15、b16、b17。若台账中有标志牌特征有数字则通过OCR网络提取数字，若没有则数字信息标记为-1。将步骤与的结果标记为CF_BAN。2.选择图像缓冲区中CF_BAN特征与台账一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，进入检测视频输出程序。WARNING图像语义匹配包括：1.对台账数据缓冲区的每个图像进行图像语义特征提取：图像预处理。图像从内存拷贝到显存通过以ResNet为主干的网络模型C_BAN对图像进行识别，识别结果有35种分别为w0、w1、w2、w3、w4、w5、w6、w7、w8、w9、w10、w11、w12、w13、w14、w15、w16、w17、w18、w19、w20、w21、w22、w23、w24、w25、w26、w27、w28、w29、w30、w31、w32、w33、w34。若台账中有标志牌特征有数字则通过OCR网络提取数字，若没有则数字信息标记为-1。将步骤与的结果标记为CF_WARNING。2.选择图像缓冲区中CF_WARNING特征与台账一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，进入检测视频输出程序。INDICATE图像语义匹配包括：1.对台账数据缓冲区的每个图像进行图像语义特征提取：图像预处理。图像从内存拷贝到显存通过以ResNet为主干的网络模型C_BAN对图像进行识别，识别结果有10种分别为i0、i1、i2、i3、i4、i5、i6、i7、i8、i9。若台账中有标志牌特征有数字则通过OCR网络提取数字，若没有则数字信息标记为-1。将步骤与的结果标记为CF_INDICATE。2.选择图像缓冲区中CF_INDICATE特征与台账一致且最后进入图像缓冲区的图像作为匹配图像，并进入异常判定程序，否则视为图像语义匹配失败，进入检测视频输出程序。进一步地，进入异常判定程序后，根据标志牌的指路、组合、禁令、警告和指示五类，不同的交通标志牌进入不同的特征提取网络，特征提取网络以EfficientNet为主干网络，通过将提取到的特征序列与异常样本进行比对得到异常判定结果。最终的检测结果在经过标准化处理后通过HTTP请求发送到“数据采集控制与显示端”，整个检测流程结束以上所述仅是本发明的优选实施方式，应当理解本发明并非局限于本文所披露的形式，不应看作是对其他实施例的排除，而可用于各种其他组合、修改和环境，并能够在本文所述构想范围内，通过上述教导或相关领域的技术或知识进行改动。而本领域人员所进行的改动和变化不脱离本发明的精神和范围，则都应在本发明所附权利要求的保护范围内。
