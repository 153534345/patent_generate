标题title
基于单后视相机及多雷达的自动泊车方法
摘要abst
本发明公开了一种基于单后视相机及多雷达的自动泊车方法，本发明的设计构思在于，通过车侧多个雷达对疑似车位空间的探测以及单个后视相机对疑似车位划线的图像捕获，将二者检测到的结果进行配合考量以得到目标车位，具体地，不仅可以对检测到的唯一待定车位结果进行视觉验证，还可以对二者在同一区域位置检出的两个待定车位结果进行融合，并且在后续泊入目标车位的过程中，利用后视相机持续采集的图像对车辆进行实时定位及泊车路线规划，从而实现对车位的准确匹配及精准泊车操作。本发明基于单后视相机及多个雷达实现了车辆自动泊车功能，可以达到与现有的4路环视相机及12颗超声波雷达等同的泊车效果，因而显著减少了的车辆成本。
权利要求书clms
1.一种基于单后视相机及多雷达的自动泊车方法，其特征在于，包括：在自动泊车功能激活后，当车辆前行并查找两侧车位时，由安装于车辆两侧的雷达对车位空间进行实时探测，同时由安装于车辆后部的单个后视相机对划线车位进行实时捕获；如果在同一区域，仅探测到待定车位空间，或者仅捕获到待定划线车位，则触发后视相机对待定车位空间或待定划线车位的所在环境进行障碍物检测；若未检测到所述环境存在障碍物，则将待定车位空间或待定划线车位确定为目标车位；如果在同一区域，既探测到待定车位空间又捕获到待定划线车位，则将待定车位空间与待定划线车位的二者位置信息进行融合，得到目标车位；控制车辆驶入所述目标车位，且在泊车过程中，利用后视相机捕获的图像对车辆进行实时定位，并基于所述实时定位动态规划泊车路径。2.根据权利要求1所述的基于单后视相机及多雷达的自动泊车方法，其特征在于，所述由安装于车辆两侧的雷达对车位空间进行实时探测包括：将车辆的后轴中心点作为原点建立全局坐标系；将安装于车辆同一侧面的两个雷达分别探测到的两个障碍物信息，转换至所述全局坐标系，并在所述全局坐标系下得到各障碍物的轮廓信息；基于所述轮廓信息，计算在车辆行驶方向上的两个障碍物的间距；当所述间距大于预设的车位长度值时，则得到待定车位空间。3.根据权利要求2所述的基于单后视相机及多雷达的自动泊车方法，其特征在于，所述得到待定车位空间包括：根据所述轮廓信息，得到待定水平车位或待定垂直车位。4.根据权利要求3所述的基于单后视相机及多雷达的自动泊车方法，其特征在于，所述得到待定水平车位或待定垂直车位包括：当连续既定数量的障碍物的长度均大于预设的车位宽度值时，则将所述待定车位空间确定为待定水平车位；当连续既定数量的障碍物的长度均小于预设的车位宽度值时，则将所述待定车位空间确定为待定垂直车位。5.根据权利要求2所述的基于单后视相机及多雷达的自动泊车方法，其特征在于，所述将车辆的后轴中心点作为原点建立全局坐标系包括：在自动泊车激活且车辆启动后，将车辆启动时的后轴中心点作为原点建立全局坐标系；若车辆行驶一段预设距离后，仍未得到待定车位空间或待定划线车位，则将所述全局坐标系的原点变更为车辆处于当前位置时的后轴中心点，并重新建立新的全局坐标系。6.根据权利要求2所述的基于单后视相机及多雷达的自动泊车方法，其特征在于，所述在所述全局坐标系下得到各障碍物的轮廓信息包括：基于连续多帧的障碍物回波信息，利用最小二乘法进行直线拟合；根据拟合出的若干直线线段，计算出各线段的起点和终点坐标；当第N段线段的终点坐标与第N+1段的坐标信息均不重合时，确定出障碍物的端点位置；根据所述端点位置，并结合样条曲线计算出障碍物的初始轮廓函数；利用所述初始轮廓函数拟合得到位于车辆侧方的障碍物的最终轮廓函数。7.根据权利要求2所述的基于单后视相机及多雷达的自动泊车方法，其特征在于，所述将待定车位空间与待定划线车位的二者位置信息进行融合包括：基于所述全局坐标系以及预设的权重系数，将待定车位空间与待定划线车位，二者的角点坐标进行融合，得到目标车位的坐标。8.根据权利要求1～7任一项所述的基于单后视相机及多雷达的自动泊车方法，其特征在于，所述利用后视相机捕获的图像对车辆进行实时定位包括：将车位查找及泊车过程中，由后视相机实时采集的图像进行拼接，生成图像地图；根据车辆泊车时的行驶位移得到当前位置信息；基于后视相机采集的环境信息以及所述当前位置信息，确定出车辆在所述图像地图中的实时位置。
说明书desc
技术领域本发明涉及智能驾驶技术领域，尤其涉及一种基于单后视相机及多雷达的自动泊车方法。背景技术随着汽车智能化的到来，越来越多的智能化产品应用于车辆，如紧急自动系统、车道保持系统、自动泊车系统等，汽车智能化的到来，给人类出行带来了便利，同时提高了车辆的安全性，但是车辆智能化功能实现的前提是基于车载传感器获取车辆周边信息，使得智能化越高的车辆所需的传感器数量就越多，导致车辆在提升智能化的同时也增加了单车成本，如自动泊车系统是基于四个环视相机和12个超声波雷达来实现车辆周围障碍物的检测和车位的搜索，以便根据空车位的位置及车辆周围环境控制车辆完成自主泊车功能。现有全自动泊车和半自动泊车系统均是基于前述的车载4个环视相机及12个超声波雷达实现车辆周围的障碍物检测及车位的搜索，其中环视相机主要用于包含划线或非划线的真实空车位检测，而超声波雷达则只能用于可能是车位的空间检测。其中对于环视相机，两个侧边相机用于检测车位线及侧边障碍物信息，前视相机用于检测车辆前方道路信息，后视相机用于检测车辆后方道路信息，这对于只有单个倒车后视的车辆则无法采用自动泊车功能，而对于具有自动泊车功能的车辆而言，4路环视相机又会额外增加不必要的成本。发明内容鉴于上述，本发明旨在提供一种基于单后视相机及多雷达的自动泊车方法，以解决前述自动泊车功能与低成本无法兼顾的问题。本发明采用的技术方案如下：一种基于单后视相机及多雷达的自动泊车方法，其中包括：在自动泊车功能激活后，当车辆前行并查找两侧车位时，由安装于车辆两侧的雷达对车位空间进行实时探测，同时由安装于车辆后部的单个后视相机对划线车位进行实时捕获；如果在同一区域，仅探测到待定车位空间，或者仅捕获到待定划线车位，则触发后视相机对待定车位空间或待定划线车位的所在环境进行障碍物检测；若未检测到所述环境存在障碍物，则将待定车位空间或待定划线车位确定为目标车位；如果在同一区域，既探测到待定车位空间又捕获到待定划线车位，则将待定车位空间与待定划线车位的二者位置信息进行融合，得到目标车位；控制车辆驶入所述目标车位，且在泊车过程中，利用后视相机捕获的图像对车辆进行实时定位，并基于所述实时定位动态规划泊车路径。在其中至少一种可能的实现方式中，所述由安装于车辆两侧的雷达对车位空间进行实时探测包括：将车辆的后轴中心点作为原点建立全局坐标系；将安装于车辆同一侧面的两个雷达分别探测到的两个障碍物信息，转换至所述全局坐标系，并在所述全局坐标系下得到各障碍物的轮廓信息；基于所述轮廓信息，计算在车辆行驶方向上的两个障碍物的间距；当所述间距大于预设的车位长度值时，则得到待定车位空间。在其中至少一种可能的实现方式中，所述得到待定车位空间包括：根据所述轮廓信息，得到待定水平车位或待定垂直车位。在其中至少一种可能的实现方式中，所述得到待定水平车位或待定垂直车位包括：当连续既定数量的障碍物的长度均大于预设的车位宽度值时，则将所述待定车位空间确定为待定水平车位；当连续既定数量的障碍物的长度均小于预设的车位宽度值时，则将所述待定车位空间确定为待定垂直车位。在其中至少一种可能的实现方式中，所述将车辆的后轴中心点作为原点建立全局坐标系包括：在自动泊车激活且车辆启动后，将车辆启动时的后轴中心点作为原点建立全局坐标系；若车辆行驶一段预设距离后，仍未得到待定车位空间或待定划线车位，则将所述全局坐标系的原点变更为车辆处于当前位置时的后轴中心点，并重新建立新的全局坐标系。在其中至少一种可能的实现方式中，所述在所述全局坐标系下得到各障碍物的轮廓信息包括：基于连续多帧的障碍物回波信息，利用最小二乘法进行直线拟合；根据拟合出的若干直线线段，计算出各线段的起点和终点坐标；当第N段线段的终点坐标与第N+1段的坐标信息均不重合时，确定出障碍物的端点位置；根据所述端点位置，并结合样条曲线计算出障碍物的初始轮廓函数；利用所述初始轮廓函数拟合得到位于车辆侧方的障碍物的最终轮廓函数。在其中至少一种可能的实现方式中，所述将待定车位空间与待定划线车位的二者位置信息进行融合包括：基于所述全局坐标系以及预设的权重系数，将待定车位空间与待定划线车位，二者的角点坐标进行融合，得到目标车位的坐标。在其中至少一种可能的实现方式中，所述利用后视相机捕获的图像对车辆进行实时定位包括：将车位查找及泊车过程中，由后视相机实时采集的图像进行拼接，生成图像地图；根据车辆泊车时的行驶位移得到当前位置信息；基于后视相机采集的环境信息以及所述当前位置信息，确定出车辆在所述图像地图中的实时位置。本发明的设计构思在于，通过车侧多个雷达对疑似车位空间的探测以及单个后视相机对疑似车位划线的图像捕获，将二者检测到的结果进行配合考量以得到目标车位，具体地，不仅可以对仅由雷达或后视相机检测到的唯一待定车位结果进行二次视觉验证，还可以对雷达和后视相机在同一区域位置分别检出的两个待定车位结果进行融合；并且在后续泊入目标车位的过程中，利用后视相机持续采集的图像对车辆进行实时定位及泊车路线规划，从而实现了对车位的准确匹配及精准泊车操作。本发明基于单后视相机及多个雷达实现了车辆自动泊车功能，可以达到与现有的4路环视相机及12颗超声波雷达等同的泊车效果，因而在满足自动泊车需求的同时，显著减少了的车辆成本。附图说明为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步描述，其中：图1为本发明实施例提供的基于单后视相机及多雷达的自动泊车方法的流程图。具体实施方式下面详细描述本发明的实施例，实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，仅用于解释本发明，而不能解释为对本发明的限制。本发明提出了一种基于单后视相机及多雷达的自动泊车方法的实施例，具体来说，如图1所示，可以包括如下：步骤S1、在自动泊车功能激活后，当车辆前行并查找两侧车位时，由安装于车辆两侧的雷达对车位空间进行实时探测，同时由安装于车辆后部的单个后视相机对划线车位进行实时捕获；步骤S21、如果在同一区域，仅探测到待定车位空间，或者仅捕获到待定划线车位，则触发后视相机对待定车位空间或待定划线车位的所在环境进行障碍物检测；若未检测到所述环境存在障碍物，则将待定车位空间或待定划线车位确定为目标车位；步骤S22、如果在同一区域，既探测到待定车位空间又捕获到待定划线车位，则将待定车位空间与待定划线车位的二者位置信息进行融合，得到目标车位；步骤S3、控制车辆驶入所述目标车位，且在泊车过程中，利用后视相机捕获的图像对车辆进行实时定位，并基于所述实时定位动态规划泊车路径。进一步地，所述由安装于车辆两侧的雷达对车位空间进行实时探测包括：将车辆的后轴中心点作为原点建立全局坐标系；将安装于车辆同一侧面的两个雷达分别探测到的两个障碍物信息，转换至所述全局坐标系，并在所述全局坐标系下得到各障碍物的轮廓信息；基于所述轮廓信息，计算在车辆行驶方向上的两个障碍物的间距；当所述间距大于预设的车位长度值时，则得到待定车位空间。进一步地，所述得到待定车位空间包括：根据所述轮廓信息，得到待定水平车位或待定垂直车位。进一步地，所述得到待定水平车位或待定垂直车位包括：当连续既定数量的障碍物的长度均大于预设的车位宽度值时，则将所述待定车位空间确定为待定水平车位；当连续既定数量的障碍物的长度均小于预设的车位宽度值时，则将所述待定车位空间确定为待定垂直车位。进一步地，所述将车辆的后轴中心点作为原点建立全局坐标系包括：在自动泊车激活且车辆启动后，将车辆启动时的后轴中心点作为原点建立全局坐标系；若车辆行驶一段预设距离后，仍未得到待定车位空间或待定划线车位，则将所述全局坐标系的原点变更为车辆处于当前位置时的后轴中心点，并重新建立新的全局坐标系。进一步地，所述在所述全局坐标系下得到各障碍物的轮廓信息包括：基于连续多帧的障碍物回波信息，利用最小二乘法进行直线拟合；根据拟合出的若干直线线段，计算出各线段的起点和终点坐标；当第N段线段的终点坐标与第N+1段的坐标信息均不重合时，确定出障碍物的端点位置；根据所述端点位置，并结合样条曲线计算出障碍物的初始轮廓函数；利用所述初始轮廓函数拟合得到位于车辆侧方的障碍物的最终轮廓函数。进一步地，所述将待定车位空间与待定划线车位的二者位置信息进行融合包括：基于所述全局坐标系以及预设的权重系数，将待定车位空间与待定划线车位，二者的角点坐标进行融合，得到目标车位的坐标。进一步地，所述利用后视相机捕获的图像对车辆进行实时定位包括：将车位查找及泊车过程中，由后视相机实时采集的图像进行拼接，生成图像地图；根据车辆泊车时的行驶位移得到当前位置信息；基于后视相机采集的环境信息以及所述当前位置信息，确定出车辆在所述图像地图中的实时位置。举例来说，本发明所用到的传感器可以主要包括单个倒车后视相机和4颗超声波雷达。在实际操作中，后视相机可以安装于车辆尾门或者车辆后保险杠位置，在不影响车辆美观的前提下，车辆相机应尽量突出，以便使用车辆后视相机观测车辆侧边的环境信息，当然，为了更好地检测到车位线，后视相机在选型时，应考虑具有尽量大的水平视角和尽量高的像素；4颗超声波雷达则可以分别布置于车辆前后保险杠及车辆侧边，例如，车辆两侧靠近前后保险杠处共布置4颗超声波雷达，用于检测车辆侧边的障碍物及侧边无障碍物的空间。当然，本发明排除在前后保险杠再布置额外8颗超声波雷达，用于泊车时前后障碍物距离的确认及障碍物预警。具体地，当车辆在车库中前行并查找两侧车位时，由安装于车辆两侧的超声波雷达对车位空间进行实时探测，同时由安装于车辆后部的单个后视相机对划线车位进行实时捕获。如果在车辆通过某个疑似车位后，在同一区域仅探测到了待定车位空间，或者仅捕获到了待定划线车位，则触发后视相机对待定车位空间或待定划线车位的区域进行障碍物检测，如果未检测到所述区域存在障碍物，则将待定车位空间或待定划线车位确定为目标车位。如果在车辆通过某个车位后，在该区域既通过雷达探测到了待定车位空间又通过后视相机捕获到了待定划线车位，则将待定车位空间与待定划线车位的二者位置信息进行融合，得到目标车位。关于由安装于车辆两侧的超声波雷达对车位空间进行实时探测，可以参考如下：将车辆启动时的后轴中心点作为原点建立全局坐标系，还可以说明的是，在车辆向前行驶并搜索车位的过程中，如车辆行驶一段预设距离后，未检测到任何待定车位，则将所述全局坐标系的原点改为当前时刻车辆的后轴中心点，并重新建立新的全局坐标系。接续前文，将查找车位过程中由车辆同一侧面的前侧超声波雷达及后侧超声波雷达分别检测到的两个障碍物信息，转换至所述全局坐标系，并分别在所述全局坐标系下得到各障碍物的轮廓信息。基于所述轮廓信息，计算在车辆行驶方向上的两个障碍物的间距；当所述间距离大于预设的最小车位的长度时，则得到待定车位空间。关于由安装于车辆后部的单个后视相机对划线车位进行实时捕获，可以是指利用单后视相机实时捕获到待定划线车位的影像，具体来说，即是根据地面的线条判定此区域是否为待定划线车位。可以理解的是，前述超声波雷达的空间探测和后视相机的影像捕获可以是同步进行的，而在一些其他实施例中，后视相机则可以基于超声波雷达的探测结果进行补充检测，例如当左侧的超声波雷达检测到待定车位空间后，可以控制后视相机在一定程度上向左侧偏转，以便“查看”左侧的待定车位空间的区域是否画有车位线，从而输出待定划线车位，当然，也可以理解此是一种二者融合的方式。在控制车辆泊入目标车位时，在前述全局坐标系下，基于单后视相机所采集的多帧图像，对车辆的位置进行实时定位。具体来说，将在前述查找车位及泊车时后视相机实时采集的图像进行拼接，形成一幅完整的图像地图；并且，结合轮速脉冲信号计算车辆的行驶位移得到当前所处位置；根据从后视相机实时采集图像中可获取到的诸如障碍物的类型、障碍物的形状，障碍物的位置、路牙石的位置、护栏的位置、车辆的位置等环境信息、车辆当前所处位置，确定出车辆在所述图像地图中的位置，并基于此进行实时泊车路线规划。综上所述，本发明的设计构思在于，通过车侧多个雷达对疑似车位空间的探测以及单个后视相机对疑似车位划线的图像捕获，将二者检测到的结果进行配合考量以得到目标车位，具体地，不仅可以对仅由雷达或后视相机检测到的唯一待定车位结果进行二次视觉验证，还可以对雷达和后视相机在同一区域位置分别检出的两个待定车位结果进行融合；并且在后续泊入目标车位的过程中，利用后视相机持续采集的图像对车辆进行实时定位及泊车路线规划，从而实现了对车位的准确匹配及精准泊车操作。本发明基于单后视相机及多个雷达实现了车辆自动泊车功能，可以达到与现有的4路环视相机及12颗超声波雷达等同的泊车效果，因而在满足自动泊车需求的同时，显著减少了的车辆成本。本发明实施例中，“至少一个”是指一个或者多个，“多个”是指两个或两个以上。“和/或”，描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示单独存在A、同时存在A和B、单独存在B的情况。其中A，B可以是单数或者复数。字符“/”一般表示前后关联对象是一种“或”的关系。“以下至少一项”及其类似表达，是指的这些项中的任意组合，包括单项或复数项的任意组合。例如，a，b和c中的至少一项可以表示：a，b，c，a和b，a和c，b和c或a和b和c，其中a，b，c可以是单个，也可以是多个。以上依据图式所示的实施例详细说明了本发明的构造、特征及作用效果，但以上仅为本发明的较佳实施例，需要言明的是，上述实施例及其优选方式所涉及的技术特征，本领域技术人员可以在不脱离、不改变本发明的设计思路以及技术效果的前提下，合理地组合搭配成多种等效方案；因此，本发明不以图面所示限定实施范围，凡是依照本发明的构想所作的改变，或修改为等同变化的等效实施例，仍未超出说明书与图示所涵盖的精神时，均应在本发明的保护范围内。
