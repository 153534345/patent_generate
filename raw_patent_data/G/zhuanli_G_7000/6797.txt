标题title
一种波长偏移下的线型展宽消除方法
摘要abst
本发明公开了一种波长偏移下的线型展宽消除方法，是基于一次谐波信号进行处理，包括：1去除背景噪声后再进行滤波处理，2标准一次谐波拟合，通过引入置信度并结合标准差对拟合的无吸收区域作为标准一次谐波自适应拟合是否结束的评判标准，得到标准一次谐波拟合信号，为线型展宽的消除提供了基础，3两次信号调整，先进行粗调，并对局部信号拟合，插值进行微调，消除展宽。本发明能在不增加硬件结构的基础上，通过一种波长偏移下的线型展宽消除方法，从而解决波长偏移下的线型展宽问题，并提高测量的准确性。
权利要求书clms
1.一种波长偏移下的线型展宽消除方法，是应用于由激光器、控制器、函数发生器、校准通路、探测通路、采集处理器依次连接所构成的线型展宽消除气体检测系统中，其特征是，所述线型展宽消除方法是按如下步骤进行：步骤1.所述采集处理器获取当前周期下所述校准通路的信号序列{C|m＝1，2，…，N}与所述探测通路的信号序列{Y|m＝1，2，…，N}，其中，C为所述校准通路在当前周期下第m位置上的校准电压信号；Y为所述探测通路在当前周期下第m位置上的探测电压信号；步骤2.分别对信号序列{C|m＝1，2，…，N}和{Y|m＝1，2，…，N}去除背景噪声后再进行滤波处理，得到滤波后的信号序列{C′|m＝1，2，…，N}和{Y′|m＝1，2，…，N}；其中，C′为所述校准通路在当前周期下第m位置上滤波后的校准电压信号；Y′为所述探测通路在当前周期下第m位置上滤波后的探测电压信号；步骤3.选用洛伦兹展宽主导线型，分别对滤波后的信号序列{C′i|m＝1，2，…，N}和{Yi′|m＝1，2，…，N}进行标准谐波拟合后相应得到标准一次谐波信号序列{XC1f|m＝1，2，…，N}与{XY1f|m＝1，2，…，N}；其中，XC1f为所述校准通路在当前周期下第m位置上标准一次谐波拟合后的校准信号；XY1f为所述探测通路在当前周期下第m位置上标准一次谐波拟合后的探测信号；步骤4.对标准一次谐波信号序列{XY1f|m＝1，2，…，N}求取极大值位置的信号XY1f与极小值位置的信号XY1f；对标准一次谐波信号序列{XC1f|m＝1，2，…，N}求取极大值位置的信号XC1f与极小值位置的信号XC1f；利用式得到极大值点的偏移量Δmax与极小值点的偏移量Δmin：式中，m0和m2分别表示标准一次谐波信号序列{XY1f|m＝1，2，…，N}的极大值和极小值的位置；m1和m3分别表示标准一次谐波信号序列{XC1f|m＝1，2，…，N}的极大值和极小值的位置；利用式所得到的偏移量Δ，对标准一次谐波信号序列{XY1f|m＝1，2，…，N}进行粗调，从而得到粗调后的标准一次谐波信号序列{XY1f|m′＝1，2，…，N′}，其中，XY1f表示对第m位置上探测信号XY1f进行粗调后的信号，且m′＝m±Δ：步骤5.以极大值的位置m0为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对粗调后的信号XY1f进行二次低阶拟合，得到局部峰值信号式中，b0、b1、b2表示三个拟合系数，k表示步进值，且m0-3Δ≤k≤m0+3Δ；以极大值的位置m1为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对校准信号XC1f进行二次低阶拟合，得到局部校准峰值信号式中，a0、a1、a2表示三个拟合系数，k表示步进值，且m1-3Δ≤k≤m1+3Δ；利用插值法对局部峰值信号求取极大值位置的信号利用插值法对局部校准峰值信号求取极大值位置的信号利用式得到极大值点微调偏移量ΔL：式中，表示信号的极大值位置，表示信号的极大值位置；步骤6.以极小值的位置m2为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对粗调后的信号XY1f进行二次低阶拟合，得到局部谷值信号式中，c0、c1、c2表示三个拟合系数，k表示步进值，且m2-3Δ≤k≤m2+3Δ；以极小值的位置m3为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对校准信号XC1f进行二次低阶拟合，得到局部校准谷值信号式中，a0、a1、a2表示三个拟合系数，k表示步进值，且m3-3Δ≤k≤m3+3Δ；利用插值法对局部谷值信号求取极大值位置的信号利用插值法对局部校准谷值信号求取极大值位置的信号利用式得到极小值点微调偏移量ΔM：式中，表示信号的极大值位置，表示信号的极大值位置；根据所述的极大值点微调偏移量ΔL与极小值点微调偏移量ΔM计算均值求得微调偏移量ΔA，用于对粗调后的信号XY1f进行微调，得到展宽消除后的信号XY1f；步骤7.对展宽消除后的信号XY1f与信号XC1f进行反演，并得到所述探测通路中的气体浓度。2.根据权利要求1所述的一种波长偏移下的线型展宽消除方法，其特征是，所述步骤3中的标准谐波拟合是判断滤波后的信号序列中的每个电压信号到零线的距离是否处于所设置的置信度阈值范围内，若是，在保持相应的电压信号，否则，相应的电压信号设为零，从而得到相应的一次谐波信号的临时序列；再利用最小二乘拟合法对临时序列进行处理，并在信号序列及其对应的临时序列之间的标准差之和最小时，得到最终的标准一次谐波信号序列。
说明书desc
技术领域本发明涉及环境光学领域，具体的说是针对波长偏移所导致线型展宽影响，提出一种消除波长偏移所导致线型展宽的方法。背景技术在利用激光光谱技术进行气体检测时，温度变化，电流扫描信号直流电平漂移，驱动电流与温度的漂移，热敏电阻、激光器芯片的非完全耦合，光路、电路老化等会造成激光器波长偏移，导致线型展宽，影响气体浓度测量的准确性。因此有效的消除线型展宽问题，提高测量的长期稳定性与准确性有重要研究意义。现有的研究主要从改造硬件系统例如控温、锁相等减少漂移问题，很少讨论如何消除波长偏移导致的线型展宽的影响。B.Tuzson等人指出抑制波长漂移引起的谱线展宽是保证QCL系统长期稳定的基础。陈等人设计了一种高精度温度控制系统，以消除背景信号漂移的影响，增强测量系统的稳定性。现有的技术虽然在一定程度上解决波长偏移的问题，但在实际的测量过程中，引起线型展宽复杂多样，仅通过单一的改变硬件结构的角度，并不能从根本上解决。发明内容鉴于现有技术方法存在的不足，本发明提出一种波长偏移下的线型展宽消除方法，以期能在不增加硬件结构的基础上，解决波长偏移下的线型展宽问题，并提高测量的准确性。本发明解决上述问题的技术方案如下：本发明一种波长偏移下的线型展宽消除方法，是应用于由激光器、控制器、函数发生器、校准通路、探测通路、采集处理器依次连接所构成的线型展宽消除气体检测系统中，其特点是，所述线型展宽消除方法是按如下步骤进行：步骤1.所述采集处理器获取当前周期下所述校准通路的信号序列{C|m＝1,2,…,N}与所述探测通路的信号序列{Y|m＝1,2,…,N}，其中，C为所述校准通路在当前周期下第m位置上的校准电压信号；Y为所述探测通路在当前周期下第m位置上的探测电压信号；步骤2.分别对信号序列{C|m＝1,2,…,N}和{Y|m＝1,2,…,N}去除背景噪声后再进行滤波处理，得到滤波后的信号序列{C′|m＝1,2,…,N}和{Y′|m＝1,2,…,N}；其中，C′为所述校准通路在当前周期下第m位置上滤波后的校准电压信号；Y′为所述探测通路在当前周期下第m位置上滤波后的探测电压信号；步骤3.选用洛伦兹展宽主导线型，分别对滤波后的信号序列{C′i|m＝1,2,…,N}和{Y′i|m＝1,2,…,N}进行标准谐波拟合后相应得到标准一次谐波信号序列{XC1f|m＝1,2,…,N}与{XY1f|m＝1,2,…,N}；其中，XC1f为所述校准通路在当前周期下第m位置上标准一次谐波拟合后的校准信号；XY1f为所述探测通路在当前周期下第m位置上标准一次谐波拟合后的探测信号；步骤4.对标准一次谐波信号序列{XY1f|m＝1,2,…,N}求取极大值位置的信号XY1f与极小值位置的信号XY1f；对标准一次谐波信号序列{XC1f|m＝1,2,…,N}求取极大值位置的信号XC1f与极小值位置的信号XC1f；利用式得到极大值点的偏移量Δmax与极小值点的偏移量Δmin：式中，m0和m2分别表示标准一次谐波信号序列{XY1f|m＝1,2,…,N}的极大值和极小值的位置；m1和m3分别表示标准一次谐波信号序列{XC1f|m＝1,2,…,N}的极大值和极小值的位置；利用式所得到的偏移量Δ，对标准一次谐波信号序列{XY1f|m＝1,2,…,N}进行粗调，从而得到粗调后的标准一次谐波信号序列{XY1f|m′＝1,2,…,N′}，其中，XY1f表示对第m位置上探测信号XY1f进行粗调后的信号，且m′＝m±Δ：步骤5.以极大值的位置m0为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对粗调后的信号XY1f进行二次低阶拟合，得到局部峰值信号式中，b0、b1、b2表示三个拟合系数，k表示步进值，且m0-3Δ≤k≤m0+3Δ；以极大值的位置m1为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对校准信号XC1f进行二次低阶拟合，得到局部校准峰值信号式中，a0、a1、a2表示三个拟合系数，k表示步进值，且m1-3Δ≤k≤m1+3Δ；利用插值法对局部峰值信号求取极大值位置的信号利用插值法对局部校准峰值信号求取极大值位置的信号利用式得到极大值点微调偏移量ΔL：式中，表示信号的极大值位置，表示信号的极大值位置；步骤6.以极小值的位置m2为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对粗调后的信号XY1f进行二次低阶拟合，得到局部谷值信号式中，c0、c1、c2表示三个拟合系数，k表示步进值，且m2-3Δ≤k≤m2+3Δ；以极小值的位置m3为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对校准信号XC1f进行二次低阶拟合，得到局部校准谷值信号式中，a0、a1、a2表示三个拟合系数，k表示步进值，且m3-3Δ≤k≤m3+3Δ；利用插值法对局部谷值信号求取极大值位置的信号利用插值法对局部校准谷值信号求取极大值位置的信号利用式得到极小值点微调偏移量ΔM：式中，表示信号的极大值位置，表示信号的极大值位置；根据所述的极大值点微调偏移量ΔL与极小值点微调偏移量ΔM计算均值求得微调偏移量ΔA，用于对粗调后的信号XY1f进行微调，得到展宽消除后的信号XY1f；步骤7.对展宽消除后的信号XY1f与信号XC1f进行反演，并得到所述探测通路中的气体浓度。本发明所述的一种波长偏移下的线型展宽消除方法的特点也在于，所述步骤3中的标准谐波拟合是判断滤波后的信号序列中的每个电压信号到零线的距离是否处于所设置的置信度阈值范围内，若是，在保持相应的电压信号，否则，相应的电压信号设为零，从而得到相应的一次谐波信号的临时序列；再利用最小二乘拟合法对临时序列进行处理，并在信号序列及其对应的临时序列之间的标准差之和最小时，得到最终的标准一次谐波信号序列。与现有的技术相比较，本发明的有益效果体现在：1.本发明中在不增加硬件结构的基础上，通过对一次谐波信号标准拟合，先进行粗调，并对局部信号拟合，插值进行微调，通过两次信号调整，从而消除了展宽，提高了测量准确性，解决了信号的波长偏移引起的线型展宽，影响测量准确性的问题。2.本发明中通过引入置信度结合标准差对拟合的无吸收区域作为标准一次谐波自适应拟合是否结束的评判标准，得到标准一次谐波拟合信号，为线型展宽的消除提供了基础。附图说明图1为本发明实施案例中的线型展宽消除气体检测系统的示意图；图2本发明的一种波长偏移下的线型展宽消除方法的流程图；图3为本发明的展宽消除前后图；图4为本发明实施案例中的浓度修正前后图。具体实施方式本实施例中，参见图1，一种线型展宽消除气体检测系统，包括：激光器3、控制器2、函数发生器1、校准通路、探测通路、采集处理器。其中，校准通路由准直器4、标准参考池5、光电探测器6组成；探测通路由准直器7、多次反射池8、光电探测器9组成；激光器1作为检测光源进行测量，通过控制器2进行温度控制和电流控制，从而改变激光器1的输出波长；函数发生器1向控制器2的电流驱动器提供扫描信号和调制信号，共同作用于激光器3,调谐激光稳定输出；激光分路后分别经过校准通路和探测通路，其中校准通路的激光光束经准直器5准直后，通过标准参考池5后，由光电探测器6接收；探测通路的激光光束经准直器7后，进入多次反射池8后，汇聚到光电探测器9；两种信号都由采集处理器完成信号采集与处理。参见图2，本实施例中，一种基于线型展宽消除气体检测系统波长偏移下的线型展宽消除方法是按如下步骤进行：步骤1.采集处理器获取当前周期下校准通路的信号序列{C|m＝1,2,…,N}与探测通路的信号序列{Y|m＝1,2,…,N}，其中，C为校准通路在当前周期下第m位置上的校准电压信号；Y为探测通路在当前周期下第m位置上的探测电压信号；步骤2.分别对信号序列{C|m＝1,2,…,N}和{Y|m＝1,2,…,N}去除背景噪声后再进行滤波处理，得到滤波后的信号序列{C′|m＝1,2,…,N}和{Y′|m＝1,2,…,N}；其中，C′为校准通路在当前周期下第m位置上滤波后的校准电压信号；Y′为探测通路在当前周期下第m位置上滤波后的探测电压信号；步骤3.选用洛伦兹展宽主导线型，分别对滤波后的信号序列{C′i|m＝1,2,…,N}和{Y′i|m＝1,2,…,N}进行标准谐波拟合后相应得到标准一次谐波信号序列{XC1f|m＝1,2,…,N}与{XY1f|m＝1,2,…,N}；其中，XC1f为校准通路在当前周期下第m位置上标准一次谐波拟合后的校准信号；XY1f为探测通路在当前周期下第m位置上标准一次谐波拟合后的探测信号；具体实施中，标准谐波拟合是判断滤波后的信号序列中的每个电压信号到零线的距离是否处于所设置的置信度阈值范围内，若是，在保持相应的电压信号，否则，相应的电压信号设为零，从而得到相应的一次谐波信号的临时序列；再利用最小二乘拟合法对临时序列进行处理，并在信号序列及其对应的临时序列之间的标准差之和最小时，得到最终的标准一次谐波信号序列。步骤4.对标准一次谐波信号序列{XY1f|m＝1,2,…,N}求取极大值位置的信号XY1f与极小值位置的信号XY1f；对标准一次谐波信号序列{XC1f|m＝1,2,…,N}求取极大值位置的信号XC1f与极小值位置的信号XC1f；利用式得到极大值点的偏移量Δmax与极小值点的偏移量Δmin：式中，m0和m2分别表示标准一次谐波信号序列{XY1f|m＝1,2,…,N}的极大值和极小值的位置；m1和m3分别表示标准一次谐波信号序列{XC1f|m＝1,2,…,N}的极大值和极小值的位置；利用式所得到的偏移量Δ，对标准一次谐波信号序列{XY1f|m＝1,2,…,N}进行粗调，从而得到粗调后的标准一次谐波信号序列{XY1f|m′＝1,2,…,N′}，其中，XY1f表示对第m位置上探测信号XY1f进行粗调后的信号，且m′＝m±Δ：步骤5.以极大值的位置m0为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对粗调后的信号XY1f进行二次低阶拟合，得到局部峰值信号式中，b0、b1、b2表示三个拟合系数，k表示步进值，且m0-3Δ≤k≤m0+3Δ；以极大值的位置m1为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对校准信号XC1f进行二次低阶拟合，得到局部校准峰值信号式中，a0、a1、a2表示三个拟合系数，k表示步进值，且m1-3Δ≤k≤m1+3Δ；利用插值法对局部峰值信号求取极大值位置的信号利用插值法对局部校准峰值信号求取极大值位置的信号利用式得到极大值点微调偏移量ΔL：式中，表示信号的极大值位置，表示信号的极大值位置；步骤6.以极小值的位置m2为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对粗调后的信号XY1f进行二次低阶拟合，得到局部谷值信号式中，c0、c1、c2表示三个拟合系数，k表示步进值，且m2-3Δ≤k≤m2+3Δ；以极小值的位置m3为中心，取±3Δ范围内粗调后的信号作为待拟合区，利用式对校准信号XC1f进行二次低阶拟合，得到局部校准谷值信号式中，a0、a1、a2表示三个拟合系数，k表示步进值，且m3-3Δ≤k≤m3+3Δ；利用插值法对局部谷值信号求取极大值位置的信号利用插值法对局部校准谷值信号求取极大值位置的信号利用式得到极小值点微调偏移量ΔM：式中，表示信号的极大值位置，表示信号的极大值位置；根据的极大值点微调偏移量ΔL与极小值点微调偏移量ΔM计算均值求得微调偏移量ΔA，用于对粗调后的信号XY1f进行微调，得到展宽消除后的信号XY1f；步骤7.对展宽消除后的信号XY1f与信号XC1f进行反演，并得到探测通路中的气体浓度。为了验证本发明方法的效果，本例利用所建立的线型展宽消除气体检测系统进行实验，本发明的设置扫描频率为100Hz，调制频率为50kHz，采样速度为200kHz的采集卡，探测通路路采用20m的多次反射池，在反射池内密封浓度约为40ppm的甲烷进行测量。利用本发明方法修正前后结果图如图3所示，修正后波长偏移下的线型展宽得到了抑制。进一步验证本发明方法对浓度反演计算中的准确性影响，对固定浓度30ppm的甲烷进行测量。测量结果如图4示，展宽修正后标准差为0.047，未考虑展宽影响的标准差为0.203，实验结果证明了本发明提供的方法能在波长发生展宽时有效提高气体浓度测量的准确性。
