标题title
星地联合的线阵成像遥感卫星全自主几何定标方法及系统
摘要abst
本发明借助高分辨率线阵成像卫星的敏捷机动特性，提供了一种星地联合的线阵成像遥感卫星全自主几何定标方法及系统。实现从数据获取到内外定标解算的全链路处理。本发明基于卫星的超高姿态稳定度和敏捷机动能力，在同一圈的太阳阴影区和阳照区通过多次机动获取对天和对地观测数据，通过阴影区的恒星观测数据完成卫星的外定标，通阳照区获取的地面重叠影像，在地形辅助下完成载荷的内定标，进而完全摆脱对地面定标场参考数据的依赖，不但可降低定标成本，且几乎可随时随地定标，保证定标的时效性和精度。
权利要求书clms
1.星地联合的线阵成像遥感卫星全自主几何定标方法，其特征在于，包括如下步骤：步骤1，当卫星运行到太阳阴影区时，利用卫星的敏捷机动能力，对合适的天区进行拍摄，获取恒星星图数据，并在导航星表的辅助下，提取恒星作为外定标观测值；步骤2，基于恒星观测向量和卫星载荷视向量的共线关系建立线阵相机对天观测的几何成像模型，通过在模型中引入广义的相机安装角建立外定标模型；步骤3，基于序列恒星观测值，采用最小二乘方法迭代解算外定标参数；步骤4，在卫星运行到同一圈的太阳阳照面时，利用卫星的机动能力在短时间内获取待标定相机拍摄的同一地区两次覆盖的影像，并从影像的重叠区域匹配密集的同名点，作为内定标解算的观测值；步骤5，基于像点、物点和投影中心三点共线关系，建立线阵相机对地观测的几何成像模型，通过在模型中引入多项式拟合的指向角模型建立内定标模型；步骤6，在外定标解算参数的基础上，基于同名像点的共面约束条件，在参考DSM的约束下，采用多片CCD高阶模型参数分片估计和常数项整体估计的方法解算内定标参数；步骤7，在内定标解算参数的基础上，重复步骤2-3，重新进行外定标解算，进而得到内外定标结果。2.如权利要求1所述的星地联合的线阵成像遥感卫星全自主几何定标方法，其特征在于：步骤1的具体实现方式如下；当卫星运动到太阳阴影区时，通过敏捷机动，执行地相机的对天观测，由于不同的天区包含的星数以及恒星星分布情况均有所不同，在进行对天观测时需要考虑天区内恒星的观测情况，对全天区依据相机视场角划分网格，根据相机的成像敏感度选择天区内恒星成像情况和分布情况均合适的天区作为观测天区，调整卫星姿态，对该天区成像，获取序列观星影像数据；在导航星表的辅助下，通过影像去噪、二值化、边缘提取与质心拟合图像处理方法提取精确的恒星观测值，得到每个恒星点的赤经α和赤纬δ。3.如权利要求1所述的星地联合的线阵成像遥感卫星全自主几何定标方法，其特征在于：步骤2的具体实现方式如下；恒星观测值在天球坐标系下的观测向量为vstar＝T，进而基于恒星观测向量和相机视向量的共线关系，建立线阵光学卫星影像对天成像的严格几何成像模型，如下式：其中，α和δ为恒星点的赤经和赤纬，和为像点在垂直CCD和沿CCD两个方向的指向角，μ为缩放系数；为J2000坐标系到卫星本体坐标系的旋转矩阵，由星敏和陀螺通过组合定姿得到；RAber为光行差改正矩阵，该矩阵可根据光行差θ和旋转向量n计算的变换四元数P＝确定：其中，θ＝v·sinβ/c，v为卫星运行速度，c为光速，β为恒星方向向量vstar与卫星运行方向向量vsat的夹角；构建的外定标模型如公式所示，为从卫星本体坐标系到相机坐标系的广义旋转矩阵，将所有的外方位元素误差统一纳入到该矩阵中进行补偿，该矩阵由三个相机安装角确定，具体如下式：4.如权利要求3所述的星地联合的线阵成像遥感卫星全自主几何定标方法，其特征在于：步骤3的具体实现过程如下；31)构建外定标平差模型采用最小二乘平差方法解算外定标参数，首先基于外定标模型建立用于参数解算的平差模型，令式中：构建用于最小二乘平差解算的平差方程：32)外定标参数解算针对每个恒星观测值，根据其成像时间、姿态和轨道建立用于外参数解算的平差方程，并在此基础上，通过模型线性化得到误差方程：其中，为三个外参数的改正向量；Ai是个恒星控制点的误差方程系数矩阵；Li为恒星控制点误差方程的常数向量，等于该点对应的平差方程的当前值，具体如下：利用最小二乘平差计算x，如式；其中，m为恒星点数量，根据解算的改正值更新外参数的当前值，当两次平差解算的结果小于限差时，迭代结束。5.如权利要求1所述的星地联合的线阵成像遥感卫星全自主几何定标方法，其特征在于：步骤4中通过“前扫成像”、“机动阶段”和“回扫成像”三个阶段获取两景重叠影像；卫星载荷通常是由多片CCD组成，且各CCD的畸变情况不尽相同，在内定标中需要各片CCD具有不同的待定标参数，在自主定标中也需要对各片CCD分开处理，因此，每片CCD获取的影像需要具有一定的重叠度TCCD，TCCD在45％到75％之间，由此可得到整景影像间的重叠度T与各片CCD影像间重叠度的关系：n为CCD数量；然后，在两景影像的重叠区域匹配同名点数据。6.如权利要求4所述的星地联合的线阵成像遥感卫星全自主几何定标方法，其特征在于：步骤5的具体实现方式如下；51)线阵光学卫星对地成像模型构建根据像点行号获取影像的成像时间，进而通过插值得到该行的姿轨参数，然后基于像点、物点和投影中心三点共线的几何关系建立线阵光学卫星影像的严格几何成像模型，如下式：其中：仍为卫星本体坐标系到相机坐标系的旋转矩阵，由外定标确定，为WGS84坐标系到J2000坐标系的旋转矩阵，由成像时刻的星历参数确定，其他矩阵与对天成像模型相同，表示GPS天线相位中心在WGS84坐标系下的坐标，由卫星上搭载的GPS获取；表示像点对应的物方点在WGS84坐标系下的直角坐标，与地理坐标，即之间的变换关系如下：其中，N是地球卯酉圈的曲率半径，e是地球椭球体的第一个偏心率；52)基于探元指向角的内定标模型对于线阵相机的每个CCD探元的指向，利用其在相机坐标系下的指向角精确表示，但计算所有探元的指向角是不现实的，根据光学卫星相机的畸变特性，利用两个一元三次多项式对其各探元的指向角进行拟合，进而得到基于一元三次多项式拟合指向角的内定标模型：其中，s为探元号，为三次多项式系数，即为在轨几何内定标参数；将构建的各片CCD的内定标模型引入到严格几何成像模型中，可得到其在轨几何定标模型，其中每片CCD均具有与其对应的一套待解算的内定标模型参数。7.如权利要求6所述的星地联合的线阵成像遥感卫星全自主几何定标方法，其特征在于：步骤6的具体实现方法如下；在解算的外定标参数基础上，在内定标中将上述解算的外定标参数视为真值，进行内定标参数解算；61)构建自主内定标平差模型采用最小二乘平差方法解算内定标参数，因此首先基于几何定标模型建立用于参数解算的平差模型，令式中：构建用于最小二乘平差解算的平差方程：其中，不同片CCD的模型由平差模型中各自的指向角模型决定；62)逐CCD分片定标参数解算对于每片CCD，分别利用其获取的重叠影像对上的密集同名像点解算其定标参数，由于指向角模型常数项独立于影像间的共面约束条件，无法在内定标中精确解算，而该参数又与外定标参数完全相关；因此，在进行逐CCD内定标解算时直接忽略常数项，只计算其他高次项参数；鉴于每片CCD高阶内定标参数的解算过程相同，仅对一片的参数解算进行叙述，具体如下：根据构建的平差模型，通过模型线性化处理，对每对同名像点可构建误差方程，如式所示：其中，和分别为左右影像上像点对应的改正数向量，y＝T为相机内定标参数改正向量；表示各同名像点物方平面坐标改正向量，物方坐标的高程直接从影像覆盖区域的DSM中插值得到，而不在内定标中解算；矩阵和分别为左右像点误差方程中定标参数对应的偏导数系数矩阵；矩阵和分别为左右像点误差方程中物方坐标对应的偏导数系数矩阵，是根据各自的影像建立的平差方程通过线性化得到的，和分别为左右像点误差方程中常数向量；以左影像上像点为例，其误差方程中各矩阵具体形式如下：最后，利用最小二乘平差计算y，如式所示：其中，k代表该CCD对应的重叠影像上同名点的数量；同样地，基于最小二乘的内定标解算也为迭代计算，根据每次迭代解算的结果更新当前的内定标参数，当连续两次计算的内定标参数改正数小于阈值时，停止迭代解算；63)常数项整体解算为了确保各片CCD间的拼接精度，需要根据相邻CCD重叠影像间的同名像点解算各片CCD的常数项，这里选择某一片CCD为基准片，基准片的常数项仍不计算，采用其初值,，以基准片为参考，计算所有非基准片的常数项；基于上述构建的平差方程对同名点分别构建误差方程，方程的具体形式与类似，不同之处在于这里的待解算参数为所有非基准CCD指向角模型的常数项，具体如下式：其中，z＝T为所有非基准CCD的常数项改正数，其中dzi＝i，n为非基准CCD个数；ti仍为各同名像点物方平面坐标改正向量，矩阵和分别为左右像点误差方程中常数项定标参数对应的偏导数系数矩阵；矩阵和分别为左右像点误差方程中物方坐标对应的偏导数系数矩阵，同样是根据各自的影像建立的平差方程通过线性化得到的，和分别为左右像点误差方程中常数向量；最后，利用最小二乘平差计算z，如式所示：其中，λ代表用于计算的同名点数量；同样地，该解算为迭代计算，根据每次迭代解算的结果更新当前的内定标常数项参数，当连续两次计算的内定标参数改正数小于阈值时，停止迭代解算。8.星地联合的线阵成像遥感卫星全自主几何定标系统，其特征在于，包括如下模块：外定标观测值提取模块，用于当卫星运行到太阳阴影区时，利用卫星的敏捷机动能力，对合适的天区进行拍摄，获取恒星星图数据，并在导航星表的辅助下，提取恒星作为外定标观测值；外定标模型构建模块，用于基于恒星观测向量和卫星载荷视向量的共线关系建立线阵相机对天观测的几何成像模型，通过在模型中引入广义的相机安装角建立外定标模型；外定标参数解算模块，用于基于序列恒星观测值，采用最小二乘方法迭代解算外定标参数；内定标观测值提取模块，用于在卫星运行到同一圈的太阳阳照面时，利用卫星的机动能力在短时间内获取待标定相机拍摄的同一地区两次覆盖的影像，并从影像的重叠区域匹配密集的同名点，作为内定标解算的观测值；内定标模型构建模块，用于基于像点、物点和投影中心三点共线关系，建立线阵相机对地观测的几何成像模型，通过在模型中引入多项式拟合的指向角模型建立内定标模型；内定标参数计算模块，用于在外定标解算参数的基础上，基于同名像点的共面约束条件，在参考DSM的约束下，采用多片CCD高阶模型参数分片估计和常数项整体估计的方法解算内定标参数；定标结果获取模块，用于在内定标解算参数的基础上，重复外定标模型构建模块和外定标参数解算模块，重新进行外定标解算，进而得到内外定标结果。
说明书desc
技术领域本发明属于光学卫星遥感影像几何处理领域，涉及一种星地联合的线阵成像遥感卫星全自主几何定标方法及系统。背景技术几何定标是改正光学遥感卫星成像模型中系统性几何误差的必要手段，虽然卫星载荷在发射前已经进行了严格的实验室标定，但由于卫星发射过程中成像环境变化以及相机调焦等因素，载荷的真实成像参数势必发生改变，需要在轨重新进行几何定标才能保证其影像的几何精度。传统在轨几何定标方法利用地面控制场的高精度参考影像来补偿载荷几何成像模型中的系统误差，但随着卫星影像分辨率的不断提高，以及各行业对卫星影像处理的精度和时效性要求日益提高，这种方法在实际处理中的弊端日益凸显：1)定标场昂贵的建设和维护成本和较短的有效周期提高了在轨几何定标的代价；2)卫星较长的重访周期严重限制其在轨获取定标数据的时间窗口，且过境定标影像的采集受天气影响较大，造成传统定标处理所需时间过长，甚至影响卫星的业务化使用。3)采用航空摄影测量的方式生产的定标场数据，已越来越无法满足超高分辨率光学遥感卫星在轨几何定标的分辨率和精度需求。发明内容本发明要解决的问题是高分辨率线阵光学卫星遥感影像高精度定位的关键问题。本发明借助高分辨率线阵成像卫星的敏捷机动特性，提出一种星地联合的线阵成像遥感卫星全自主几何定标方法及系统，实现从数据获取到内外定标解算的全链路处理。本发明基于卫星的超高姿态稳定度和敏捷机动能力，在同一圈的太阳阴影区和阳照区通过多次机动获取对天和对地观测数据，通过阴影区的恒星观测数据完成卫星的外定标，通阳照区获取的地面重叠影像，在地形辅助下完成载荷的内定标，进而完全摆脱对地面定标场参考数据的依赖，不但可降低定标成本，且几乎可随时随地定标，保证定标的时效性和精度。本发明的技术方案为一种星地联合的线阵成像遥感卫星全自主几何定标方法，包含以下步骤：步骤1，当卫星运行到太阳阴影区时，利用卫星的敏捷机动能力，对合适的天区进行拍摄，获取恒星星图数据，并在导航星表的辅助下，提取恒星作为外定标观测值；步骤2，基于恒星观测向量和卫星载荷视向量的共线关系建立线阵相机对天观测的几何成像模型，通过在模型中引入广义的相机安装角建立外定标模型；步骤3，基于序列恒星观测值，采用最小二乘方法迭代解算外定标参数；步骤4，在卫星运行到同一圈的太阳阳照面时，利用卫星的机动能力在短时间内获取待标定相机拍摄的同一地区两次覆盖的影像，并从影像的重叠区域匹配密集的同名点，作为内定标解算的观测值；步骤5，基于像点、物点和投影中心三点共线关系，建立线阵相机对地观测的几何成像模型，通过在模型中引入多项式拟合的指向角模型建立内定标模型；步骤6，在外定标解算参数的基础上，基于同名像点的共面约束条件，在参考DSM的约束下，采用多片CCD高阶模型参数分片估计和常数项整体估计的方法解算内定标参数；步骤7，在内定标解算参数的基础上，重复步骤2-3，重新进行外定标解算，进而得到内外定标结果。进一步的，步骤1的具体实现方式如下；当卫星运动到太阳阴影区时，通过敏捷机动，执行地相机的对天观测，由于不同的天区包含的星数以及恒星星分布情况均有所不同，在进行对天观测时需要考虑天区内恒星的观测情况，对全天区依据相机视场角划分网格，根据相机的成像敏感度选择天区内恒星成像情况和分布情况均合适的天区作为观测天区，调整卫星姿态，对该天区成像，获取序列观星影像数据；在导航星表的辅助下，通过影像去噪、二值化、边缘提取与质心拟合图像处理方法提取精确的恒星观测值，得到每个恒星点的赤经α和赤纬δ。进一步的，步骤2的具体实现方式如下；恒星观测值在天球坐标系下的观测向量为vstar＝T，进而基于恒星观测向量和相机视向量的共线关系，建立线阵光学卫星影像对天成像的严格几何成像模型，如下式：其中，α和δ为恒星点的赤经和赤纬，和为像点在垂直CCD和沿CCD两个方向的指向角，μ为缩放系数；为J2000坐标系到卫星本体坐标系的旋转矩阵，由星敏和陀螺通过组合定姿得到；RAber为光行差改正矩阵，该矩阵可根据光行差θ和旋转向量n计算的变换四元数P＝确定：其中，θ＝v·sinβ/c，v为卫星运行速度，c为光速，β为恒星方向向量vstar与卫星运行方向向量vsat的夹角；构建的外定标模型如公式所示，为从卫星本体坐标系到相机坐标系的广义旋转矩阵，将所有的外方位元素误差统一纳入到该矩阵中进行补偿，该矩阵由三个相机安装角确定，具体如下式：进一步的，步骤3的具体实现过程如下；31)构建外定标平差模型采用最小二乘平差方法解算外定标参数，首先基于外定标模型建立用于参数解算的平差模型，令式中：构建用于最小二乘平差解算的平差方程：32)外定标参数解算针对每个恒星观测值，根据其成像时间、姿态和轨道建立用于外参数解算的平差方程，并在此基础上，通过模型线性化得到误差方程：其中，为三个外参数的改正向量；Ai是个恒星控制点的误差方程系数矩阵；Li为恒星控制点误差方程的常数向量，等于该点对应的平差方程的当前值，具体如下：利用最小二乘平差计算x，如式；其中，m为恒星点数量，根据解算的改正值更新外参数的当前值，当两次平差解算的结果小于限差时，迭代结束。进一步的，步骤4中通过“前扫成像”、“机动阶段”和“回扫成像”三个阶段获取两景重叠影像；卫星载荷通常是由多片CCD组成，且各CCD的畸变情况不尽相同，在内定标中需要各片CCD具有不同的待定标参数，在自主定标中也需要对各片CCD分开处理，因此，每片CCD获取的影像需要具有一定的重叠度TCCD，TCCD在45％到75％之间，由此可得到整景影像间的重叠度T与各片CCD影像间重叠度的关系：n为CCD数量； 然后，在两景影像的重叠区域匹配同名点数据。进一步的，步骤5的具体实现方式如下；51)线阵光学卫星对地成像模型构建根据像点行号获取影像的成像时间，进而通过插值得到该行的姿轨参数，然后基于像点、物点和投影中心三点共线的几何关系建立线阵光学卫星影像的严格几何成像模型，如下式：其中：仍为卫星本体坐标系到相机坐标系的旋转矩阵，由外定标确定，为WGS84坐标系到J2000坐标系的旋转矩阵，由成像时刻的星历参数确定，其他矩阵与对天成像模型相同，表示GPS天线相位中心在WGS84坐标系下的坐标，由卫星上搭载的GPS获取；表示像点对应的物方点在WGS84坐标系下的直角坐标，与地理坐标，即之间的变换关系如下：其中，N是地球卯酉圈的曲率半径，e是地球椭球体的第一个偏心率；52)基于探元指向角的内定标模型对于线阵相机的每个CCD探元的指向，利用其在相机坐标系下的指向角精确表示，但计算所有探元的指向角是不现实的，根据光学卫星相机的畸变特性，利用两个一元三次多项式对其各探元的指向角进行拟合，进而得到基于一元三次多项式拟合指向角的内定标模型：其中，s为探元号，为三次多项式系数，即为在轨几何内定标参数；将构建的各片CCD的内定标模型引入到严格几何成像模型中，可得到其在轨几何定标模型，其中每片CCD均具有与其对应的一套待解算的内定标模型参数。进一步的，步骤6的具体实现方法如下；在解算的外定标参数基础上，在内定标中将上述解算的外定标参数视为真值，进行内定标参数解算；61)构建自主内定标平差模型采用最小二乘平差方法解算内定标参数，因此首先基于几何定标模型建立用于参数解算的平差模型，令式中：构建用于最小二乘平差解算的平差方程：其中，不同片CCD的模型由平差模型中各自的指向角模型决定；62)逐CCD分片定标参数解算对于每片CCD，分别利用其获取的重叠影像对上的密集同名像点解算其定标参数，由于指向角模型常数项独立于影像间的共面约束条件，无法在内定标中精确解算，而该参数又与外定标参数完全相关；因此，在进行逐CCD内定标解算时直接忽略常数项，只计算其他高次项参数；鉴于每片CCD高阶内定标参数的解算过程相同，仅对一片的参数解算进行叙述，具体如下：根据构建的平差模型，通过模型线性化处理，对每对同名像点可构建误差方程，如式所示：其中，和分别为左右影像上像点对应的改正数向量，y＝T为相机内定标参数改正向量；表示各同名像点物方平面坐标改正向量，物方坐标的高程直接从影像覆盖区域的DSM中插值得到，而不在内定标中解算；矩阵和分别为左右像点误差方程中定标参数对应的偏导数系数矩阵；矩阵和分别为左右像点误差方程中物方坐标对应的偏导数系数矩阵，是根据各自的影像建立的平差方程通过线性化得到的，和分别为左右像点误差方程中常数向量；以左影像上像点为例，其误差方程中各矩阵具体形式如下：最后，利用最小二乘平差计算y，如式所示：其中，k代表该CCD对应的重叠影像上同名点的数量；同样地，基于最小二乘的内定标解算也为迭代计算，根据每次迭代解算的结果更新当前的内定标参数，当连续两次计算的内定标参数改正数小于阈值时，停止迭代解算；63)常数项整体解算为了确保各片CCD间的拼接精度，需要根据相邻CCD重叠影像间的同名像点解算各片CCD的常数项，这里选择某一片CCD为基准片，基准片的常数项仍不计算，采用其初值,，以基准片为参考，计算所有非基准片的常数项；基于上述构建的平差方程对同名点分别构建误差方程，方程的具体形式与类似，不同之处在于这里的待解算参数为所有非基准CCD指向角模型的常数项，具体如下式：其中，z＝T为所有非基准CCD的常数项改正数，其中dzi＝i，n为非基准CCD个数；ti仍为各同名像点物方平面坐标改正向量，矩阵和分别为左右像点误差方程中常数项定标参数对应的偏导数系数矩阵；矩阵和分别为左右像点误差方程中物方坐标对应的偏导数系数矩阵，同样是根据各自的影像建立的平差方程通过线性化得到的，和分别为左右像点误差方程中常数向量；最后，利用最小二乘平差计算z，如式所示：其中，λ代表用于计算的同名点数量；同样地，该解算为迭代计算，根据每次迭代解算的结果更新当前的内定标常数项参数，当连续两次计算的内定标参数改正数小于阈值时，停止迭代解算。本发明还提供一种星地联合的线阵成像遥感卫星全自主几何定标系统，包括如下模块：外定标观测值提取模块，用于当卫星运行到太阳阴影区时，利用卫星的敏捷机动能力，对合适的天区进行拍摄，获取恒星星图数据，并在导航星表的辅助下，提取恒星作为外定标观测值；外定标模型构建模块，用于基于恒星观测向量和卫星载荷视向量的共线关系建立线阵相机对天观测的几何成像模型，通过在模型中引入广义的相机安装角建立外定标模型；外定标参数解算模块，用于基于序列恒星观测值，采用最小二乘方法迭代解算外定标参数；内定标观测值提取模块，用于在卫星运行到同一圈的太阳阳照面时，利用卫星的机动能力在短时间内获取待标定相机拍摄的同一地区两次覆盖的影像，并从影像的重叠区域匹配密集的同名点，作为内定标解算的观测值；内定标模型构建模块，用于基于像点、物点和投影中心三点共线关系，建立线阵相机对地观测的几何成像模型，通过在模型中引入多项式拟合的指向角模型建立内定标模型；内定标参数计算模块，用于在外定标解算参数的基础上，基于同名像点的共面约束条件，在参考DSM的约束下，采用多片CCD高阶模型参数分片估计和常数项整体估计的方法解算内定标参数；定标结果获取模块，用于在内定标解算参数的基础上，重复外定标模型构建模块和外定标参数解算模块，重新进行外定标解算，进而得到内外定标结果。本发明的优点在于：通过基于卫星平台敏捷机动能力的星地联合处理模式，在完全无需地面控制点数据的条件下即可实现线阵高分辨率光学遥感卫星的全自主在轨几何定标，完全摆脱传统方法对地面定标场的依赖，该在轨几何定标方法成本低、时效性高、精度高。附图说明图1为本发明实施例的流程示意图；图2为本发明中利用卫星机动能力的对天观测示意图；图3为本发明中利用卫星机动能力的对地观测获取重叠影像示意图；图4为本发明中地面重叠影像及其同名像点分布图。具体实施方式以下结合附图和实施例详细说明本发明具体实施方式。本发明基于卫星的机动能力，通过基于恒星的外定标与基于地面重叠影像自约束的内定标相结合的星地联合方法，实现成像链路内外部系统性几何误差的补偿。参见图1，本发明的实施流程可以分为如下7个步骤：步骤1，当卫星运行到太阳阴影区时，利用卫星的敏捷机动能力，对合适的天区进行拍摄，获取恒星星图数据，并在导航星表的辅助下，提取恒星作为外定标观测值；步骤2，基于恒星观测向量和卫星载荷视向量的共线关系建立线阵相机对天观测的几何成像模型，通过在模型中引入广义的相机安装角建立外定标模型；步骤3，基于序列恒星观测值，采用最小二乘方法迭代解算外定标参数；步骤4，在卫星运行到同一圈的太阳阳照面时，利用卫星的机动能力在短时间内获取待标定相机拍摄的同一地区两次覆盖的影像，并从影像的重叠区域匹配密集的同名点，作为内定标解算的观测值；步骤5，基于像点、物点和投影中心三点共线关系，建立线阵相机对地观测的几何成像模型，通过在模型中引入多项式拟合的指向角模型建立内定标模型；步骤6，在外定标解算参数的基础上，基于同名像点的共面约束条件，在参考DSM的约束下，采用多片CCD高阶模型参数分片估计和常数项整体估计的方法解算内定标参数；步骤7，在内定标解算参数的基础上，重复步骤2-3，重新进行外定标解算，进而得到内外定标结果。具体的，每个步骤的具体方法、公式以及流程如下：步骤1，基于卫星敏捷机动的太阳阴影区恒星观测与恒星提取当卫星运动到太阳阴影区时，通过敏捷机动，执行地相机的对天观测。由于不同的天区包含的星数以及恒星星等分布情况均有所不同，在进行对天观测时需要考虑天区内恒星的观测情况。对全天区依据相机视场角划分网格，根据相机的成像敏感度选择天区内恒星成像情况和分布情况均合适的天区作为观测天区。调整卫星姿态，对该天区成像，获取序列观星影像数据。在导航星表的辅助下，通过影像去噪、二值化、边缘提取与质心拟合等图像处理方法提取精确的恒星观测值，得到每个恒星点的赤经α和赤纬δ。步骤2，构建基于广义安装角的在轨几何外定标模型21)线阵光学卫星对天成像模型构建恒星观测值在天球坐标系下的观测向量为vstar＝T，进而基于恒星观测向量和相机视向量的共线关系，建立线阵光学卫星影像对天成像的严格几何成像模型，如下式：其中，#和#为像点在垂直CCD和沿CCD两个方向的指向角，μ为缩放系数；为J2000坐标系到卫星本体坐标系的旋转矩阵，由星敏和陀螺通过组合定姿得到；RAber#为光行差改正矩阵，该矩阵可根据光行差θ和旋转向量n计算的变换四元数P＝确定：其中，θ＝v·sinβ/c，v为卫星运行速度，c为光速，β为恒星方向向量vstar与卫星运行方向向量vsat的夹角。22)外定标模型本发明构建的外定标模型如公式所示，为从卫星本体坐标系到相机坐标系的广义旋转矩阵，本发明将所有的外方位元素误差统一纳入到该矩阵中进行补偿，该矩阵由三个相机安装角确定，具体如下式：步骤3，基于序列恒星观测值的外定标参数解算31)构建外定标平差模型采用最小二乘平差方法解算外定标参数，首先基于几何外定标模型建立用于参数解算的平差模型，令式中：构建用于最小二乘平差解算的平差方程：32)外定标参数解算针对每个恒星观测值，根据其成像时间、姿态和轨道建立用于外参数解算的平差方程，并在此基础上，通过模型线性化得到误差方程：其中，为三个外参数的改正向量；Ai是个恒星控制点的误差方程系数矩阵；Li为恒星控制点误差方程的常数向量，等于该点对应的平差方程的当前值，具体如下：利用最小二乘平差计算x，如式；其中，m为恒星点数量，根据解算的改正值更新外参数的当前值，当两次平差解算的结果小于限差时，迭代结束。步骤4，基于卫星敏捷机动的太阳阳照区地面重叠影像获取与同名点匹配在卫星运行到同一圈的太阳阳照面时，利用卫星的机动能力在短时间内获取待标定相机拍摄的同一地区两次覆盖的卫星影像，如附图3，这里通过“前扫成像”、“机动阶段”和“回扫成像”三个阶段获取两景重叠影像，得到重叠影像如附图4所示。由于卫星载荷通常是由多片CCD组成，且各CCD的畸变情况不尽相同，在内定标中需要各片CCD具有不同的待定标参数，在自主定标中也需要对各片CCD分开处理，因此，每片CCD获取的影像需要具有一定的重叠度TCCD，本发明要求TCCD在45％到75％之间，最佳为65％，由此可得到整景影像间的重叠度T#与各片CCD影像间重叠度的关系： 然后，在两景影像的重叠区域匹配同名点数据，为了限制姿态拟合误差的随机抖动会给内定标结果带来非线性误差的影响，本发明在同名点匹配时仅在重叠影像对的行方向上较短的一段区域内匹配同名点。步骤5，基于重叠影像共面约束的在轨几何内定标模型构建51)线阵光学卫星对地成像模型构建根据像点行号获取影像的成像时间，进而通过插值得到该行的姿轨参数，然后基于像点、物点和投影中心三点共线的几何关系建立线阵光学卫星影像的严格几何成像模型，如下式：其中：仍为卫星本体坐标系到相机坐标系的旋转矩阵，由上述外定标确定，为WGS84坐标系到J2000坐标系的旋转矩阵，由成像时刻的星历参数确定，其他矩阵与上述对天成像模型相同，表示GPS天线相位中心在WGS84坐标系下的坐标，由卫星上搭载的GPS获取；表示像点对应的物方点在WGS84坐标系下的直角坐标，与地理坐标之间的变换关系如下：其中，N是地球卯酉圈的曲率半径，e是地球椭球体的第一个偏心率。52)基于探元指向角的内定标模型对于线阵相机的每个CCD探元的指向，可利用其在相机坐标系下的指向角精确表示，但计算所有探元的指向角是不现实的，根据光学卫星相机的畸变特性，通常利用两个一元三次多项式对其各探元的指向角进行拟合，进而得到基于一元三次多项式拟合指向角的内定标模型：其中，s为探元号，为三次多项式系数，即为在轨几何内定标参数。将构建的各片CCD的内定标模型引入到严格几何成像模型中，可得到其在轨几何定标模型，其中每片CCD均具有与其对应的一套待解算的内定标模型参数。,步骤6，基于重叠影像共面约束的内定标参数解算在解算的外定标参数基础上，在内定标中将上述解算的外定标参数视为真值，进行内定标参数解算。61)构建自主内定标平差模型采用最小二乘平差方法解算内定标参数，因此首先基于几何定标模型建立用于参数解算的平差模型，令式中：构建用于最小二乘平差解算的平差方程：其中，不同片CCD的模型由平差模型中各自的指向角模型决定。62)逐CCD分片定标参数解算对于每片CCD，分别利用其获取的重叠影像对上的密集同名像点解算其定标参数，由于指向角模型常数项独立于影像间的共面约束条件，无法在内定标中精确解算，而该参数又与外定标参数完全相关。因此，在进行逐CCD内定标解算时可直接忽略常数项，只计算其他高次项参数。鉴于每片CCD高阶内定标参数的解算过程相同，仅对一片的参数解算进行叙述，具体如下：根据构建的平差模型，通过模型线性化处理，对每对同名像点可构建误差方程，如式所示：其中，和分别为左右影像上像点对应的改正数向量，y＝T为相机内定标参数改正向量；表示各同名像点物方平面坐标改正向量，物方坐标的高程直接从影像覆盖区域的DSM中插值得到，而不在内定标中解算；矩阵和分别为左右像点误差方程中定标参数对应的偏导数系数矩阵；矩阵和分别为左右像点误差方程中物方坐标对应的偏导数系数矩阵，是根据各自的影像建立的平差方程通过线性化得到的，和分别为左右像点误差方程中常数向量。以左影像上像点为例，其误差方程中各矩阵具体形式如下：最后，利用最小二乘平差计算y，如式所示：其中，k代表该CCD对应的重叠影像上同名点的数量。同样地，基于最小二乘的内定标解算也为迭代计算，根据每次迭代解算的结果更新当前的内定标参数，当连续两次计算的内定标参数改正数小于阈值时，停止迭代解算。每片CCD解算过程相同，这里不再赘述。63)常数项整体解算为了确保各片CCD间的拼接精度，需要根据相邻CCD重叠影像间的同名像点解算各片CCD的常数项，这里选择某一片CCD为基准片，基准片的常数项仍不计算，以基准片为参考，计算所有非基准片的常数项。基于上述构建的平差方程对同名点分别构建误差方程，方程的具体形式与类似，不同之处在于这里的待解算参数为所有非基准CCD指向角模型的常数项，具体如下式：其中，z＝T为所有非基准CCD的常数项改正数，其中dzi＝i，n为非基准CCD个数；ti仍为各同名像点物方平面坐标改正向量，矩阵和分别为左右像点误差方程中常数项定标参数对应的偏导数系数矩阵；矩阵和分别为左右像点误差方程中物方坐标对应的偏导数系数矩阵，同样是根据各自的影像建立的平差方程通过线性化得到的，和分别为左右像点误差方程中常数向量。最后，利用最小二乘平差计算z，如式所示：其中，λ代表用于计算的同名点数量。同样地，该解算为迭代计算，根据每次迭代解算的结果更新当前的内定标常数项参数，当连续两次计算的内定标参数改正数小于阈值时，停止迭代解算。步骤7，在解算的内定标参数基础上，重复步骤2-3，重新进行外定标参数解算，得到新的外定标结果，即完成所有的外定标和内定标解算。本发明实施例还提供一种星地联合的线阵成像遥感卫星全自主几何定标系统，包括如下模块：外定标观测值提取模块，用于当卫星运行到太阳阴影区时，利用卫星的敏捷机动能力，对合适的天区进行拍摄，获取恒星星图数据，并在导航星表的辅助下，提取恒星作为外定标观测值；外定标模型构建模块，用于基于恒星观测向量和卫星载荷视向量的共线关系建立线阵相机对天观测的几何成像模型，通过在模型中引入广义的相机安装角建立外定标模型；外定标参数解算模块，用于基于序列恒星观测值，采用最小二乘方法迭代解算外定标参数；内定标观测值提取模块，用于在卫星运行到同一圈的太阳阳照面时，利用卫星的机动能力在短时间内获取待标定相机拍摄的同一地区两次覆盖的影像，并从影像的重叠区域匹配密集的同名点，作为内定标解算的观测值；内定标模型构建模块，用于基于像点、物点和投影中心三点共线关系，建立线阵相机对地观测的几何成像模型，通过在模型中引入多项式拟合的指向角模型建立内定标模型；内定标参数计算模块，用于在外定标解算参数的基础上，基于同名像点的共面约束条件，在参考DSM的约束下，采用多片CCD高阶模型参数分片估计和常数项整体估计的方法解算内定标参数；定标结果获取模块，用于在内定标解算参数的基础上，重复外定标模型构建模块和外定标参数解算模块，重新进行外定标解算，进而得到内外定标结果。各模块的具体实现方式和各步骤相应，本发明不予撰述。本文中所描述的具体实施例仅仅是对本发明精神作举例说明。本发明所属技术领域的技术人员可以对所描述的具体实施例做各种各样的修改或补充或采用类似的方式替代，但并不会偏离本发明的精神或者超越所附权利要求书所定义的范围。
