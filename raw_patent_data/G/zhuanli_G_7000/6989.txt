标题title
一种基于全解耦高阶动态模态分解的工业故障检测和变量隔离方法
摘要abst
本发明公开了一种基于全解耦高阶动态模态分解的工业故障检测和变量隔离方法。首先，该方法通过全解耦高阶动态模态分解分离出标准化数据的高阶自相关性和互相关性。针对高阶自相关性，设计时序预测和自相关特征统计量来分别指示过程的时序变化和自相关波动情况。针对互相关性，设计主成分和残差统计量指示互相关性是否正常。基于这四个统计量，分别设计不同的故障变量隔离策略，找出引起该故障的主导变量。通过本发明的技术方案，可解耦变量间的互相关性和高阶自相关性，从两个角度为工业过程提供全面的故障检测，具有更高的准确性。在检测到故障后，该方法可以进一步分别识别引起不同类故障的主要因素，为故障诊断提供依据，具有更强的解释性。
权利要求书clms
1.一种基于全解耦高阶动态模态分解的工业故障检测方法，其特征在于，包括以下步骤：步骤1：采集工业正常运行过程中不同时刻的过程变量进行标准化后组成正常样本数据矩阵n表示样本数，m表示过程变量数；步骤2：使用全解耦高阶动态模态分解将过程数据特性划分为高阶自相关性和互相关性：2.1考虑一个高阶自相关系统xk+d＝A1xk+…+Adxk+d-1＝AHOT，xk表示第k个样本，AHO＝表示原始变量时序结构，d表示自相关的阶次。通过奇异值分解近似为X≈UΣV*，其中和分别表示左奇异矩阵，对角阵和右奇异矩阵；*表示共轭转置；r表示近似阶次；依据高阶自相关系统构造矩阵块Yj：2.2依据矩阵块计算原始变量高阶自相关性的时序结构其中表示Moore-Penrose伪逆；2.3依据高阶自相关系统，计算只保留高阶自相关特性的潜变量和潜变量的预测值其中表示第k个潜变量，表示潜变量的时序结构；互相关性保留在潜变量的重构残差中：步骤3：依据潜变量及其预测值设计自相关特征统计量和时序预测统计量其中表示第k+d个潜变量；||*||2表示L2范数；并利用核密度估计确定自相关特征统计量和时序预测统计量的控制限。步骤4：对重构残差数据矩阵进行主成分分析，构建主成分统计量和残差统计量并通过核密度估计确定控制限。步骤5：实时采集工业运行过程的过程变量标准化后组成当前样本xt，计算当前样本的自相关特征统计量时序预测统计量主成分统计量和残差统计量对工业故障进行监测，若任意一个统计量超过控制限，表明工业过程发生故障。2.根据权利要求1所述的故障检测方法，其特征在于，工业运行过程为火电厂、化工厂、风电厂、高炉炼铁厂等具有高阶自相关特性的多变量工业运行过程。3.根据权利要求1所述的故障检测方法，其特征在于，所述通过如下方法计算获得：4.一种基于全解耦高阶动态模态分解的工业故障变量隔离方法，其特征在于：基于权利要求1所述故障检测方法计算获得的统计量设计每个变量的贡献度计算方法，通过任意一种贡献度计算方法实现故障样本的变量隔离，贡献度计算方法包括：故障样本第q个过程变量对于自相关特征统计量的贡献度计算方法为其中，uj,t是U中第j行第t列的元素，将故障样本记作xa，xq,a是xa的第q个变量，abs表示对元素取绝对值；故障样本第q个过程变量对于时序预测统计量的贡献度的计算方法如下：对潜变量高阶自相关性时序结构进行奇异值分解其中和分别表示的左奇异矩阵，对角阵和右奇异矩阵且满足Ir×r表示r阶单位矩阵；则对原始变量高阶自相关性时序结构AHO的r阶奇异值分解可以表示为其中，是AHO的左奇异矩阵，可以计算为UHO_A＝UUHOΣHO_A是AHO的对角阵，可以计算为ΣHO_A＝ΣHO是AHO的右奇异矩阵，可以计算为将高阶自相关系统转换为如下形式：其中λ表示特征值；ΣHO表示不同模态的变化规律。所有模态的预测误差矩阵eHO_mode,k+d可表示为：eHO_mode,k+d＝ηk+d-ΣHOκk+d-1 其中，则所有模态的相对预测误差可表示为其中ΨHO＝diag表示不同模态的预测误差的标准差对角阵；根据所有模态的相对预测误差矩阵判断出现问题的模态f，根据模态f的特征值λf，则第q个过程变量对于时序预测统计量的贡献度其中，xq,a是故障样本xa的第q个变量，abs表示对元素取绝对值，uHO_A,f,q是uHO_A,f的第q个元素，uHO_A,f是矩阵UHO_A的第f列，λf是模态f的特征值，是矩阵的第f行，运算符表示两个向量的元素对应相乘。第q个过程变量对于主成分统计量的贡献度计算方法为：其中第q个过程变量对于残差统计量的贡献度计算为其中
说明书desc
技术领域本发明属于工业故障监测和变量隔离领域，特别是涉及一种工业过程中互相关性和高阶自相关性耦合的情况，通过所提的全解耦高阶动态模态分解方法，将两者完全解耦，提供全面的故障检测结果，并识别关键故障变量。背景技术近年来，工业过程设备越来越一体化、复杂化。设备之间的关系连接紧密，往往牵一发而动全身。当事故发生时，不仅会造成大量的经济损失，甚至可能带来人员伤亡。因此，及时准确地检测出工业过程发生的故障，并在成百上千个变量中识别出故障主导变量至关重要。随着物联网技术和人工智能技术的发展，基于数据驱动的故障检测和变量隔离方法在学术界和工业界都受到了广泛关注。在工业过程中，自相关性和互相关性往往相互耦合，同时存在。但是，许多传统的建模方法，如主成分分析，支持向量机等，往往只关注变量间的互相关性而忽略了自相关性。受到闭环反馈等的影响，工业过程常呈现出典型的动态特性，即不同时刻的变量是有时序关系的。忽略变量间的时序关系容易导致故障误报、漏报等情况。现有的一些方法虽然考虑了变量间的自相关性，但是没有考虑互相关性的存在对自相关性提取的影响。动态模态分解是一种可以挖掘变量间自相关性的方法。此外，在分析自相关性之前，动态模态分解先提取了变量间的互相关性，避免了互相关性对自相关分析的影响。但是动态模态分解只能提取出一阶的自相关性。为了对其进行改进，高阶动态模态分解被提了出来。然而，传统的高阶动态模态分解是基于时序拓展的方法，依旧会造成变量间自相关和互相关的耦合。此外，传统的高阶动态模态分解无法提供清晰的时序变化结构，难以分析变量间的时序关系。发明内容本发明的目的在于针对传统高阶动态模态分解方法的不足，提出一种全解耦高阶动态模态分解方法，将变量间的高阶自相关和互相关完全解耦，提供清晰的时序变化规律，并将其应用于工业故障检测和变量隔离。本发明的目的是通过以下技术方案来实现的：一种基于全解耦高阶动态模态分解的工业故障检测方法，包括以下步骤：步骤1：采集工业正常运行过程中不同时刻的过程变量进行标准化后组成正常样本数据矩阵n表示样本数，m表示过程变量数；步骤2：使用全解耦高阶动态模态分解将过程数据特性划分为高阶自相关性和互相关性：2.1考虑一个高阶自相关系统xk+d＝A1xk+…+Adxk+d-1＝AHOT，xk表示第k个样本，AHO＝表示原始变量时序结构，d表示自相关的阶次。通过奇异值分解近似为X≈UΣV*，其中和分别表示左奇异矩阵，对角阵和右奇异矩阵；*表示共轭转置；r表示近似阶次；依据高阶自相关系统构造矩阵块Yj：2.2依据矩阵块计算原始变量高阶自相关性的时序结构其中表示Moore-Penrose伪逆；2.3依据高阶自相关系统，计算只保留高阶自相关特性的潜变量和潜变量的预测值其中表示第k个潜变量，表示潜变量的时序结构；潜变量中已经分离出变量的互相关性，只保留高阶自相关特性，即将互相关性和高阶自相关性完全解耦。互相关性保留在潜变量的重构残差中：步骤3：设计时序预测统计量和自相关特征统计量对高阶自相关性进行描述，具体为：依据潜变量及其预测值设计自相关特征统计量和时序预测统计量其中表示k+d个潜变量；||*||2表示L2范数；并利用核密度估计确定自相关特征统计量和时序预测统计量的控制限。步骤4：设计主成分统计量和残差统计量对互相关性进行描述，具体为：对重构残差数据矩阵进行主成分分析，构建主成分统计量和残差统计量并通过核密度估计确定控制限。步骤5：实时采集工业运行过程的过程变量标准化后组成当前样本xt，计算当前样本的自相关特征统计量时序预测统计量主成分统计量和残差统计量对工业故障进行监测，若任意一个统计量超过控制限，表明工业过程发生故障。进一步地，其特征在于，工业运行过程为火电厂、化工厂、风电厂、高炉炼铁厂等具有高阶自相关特性的多变量工业运行过程。进一步地，所述通过如下方法计算获得：本发明还提供了一种基于全解耦高阶动态模态分解的工业故障变量隔离方法，基于上述故障检测方法计算获得的统计量设计每个变量的贡献度计算方法，通过任意一种贡献度计算方法实现故障样本的变量隔离，贡献度计算方法包括：基于自相关特征统计量的自相关故障变量隔离策略，则故障样本第q个过程变量对于自相关特征统计量的贡献度计算方法为其中，uj,t是U中第j行第t列的元素，将故障样本记作xa，xq,a是xa的第q个变量，abs表示对元素取绝对值；基于时序预测统计量的自相关故障变量隔离策略，则故障样本第q个过程变量对于时序预测统计量的贡献度的计算方法如下：对潜变量高阶自相关性时序结构进行奇异值分解其中和分别表示的左奇异矩阵，对角阵和右奇异矩阵且满足Ir×r表示r阶单位矩阵；则对原始变量高阶自相关性时序结构AHO的r阶奇异值分解可以表示为其中，是AHO的左奇异矩阵，可以计算为UHO_A＝UUHOΣHO_A是AHO的对角阵，可以计算为ΣHO_A＝ΣHO 是AHO的右奇异矩阵，可以计算为将高阶自相关系统转换为如下形式：其中λ表示特征值；ΣHO表示不同模态的变化规律。所有模态的预测误差矩阵eHO_mode,k+d可表示为：eHO_mode,k+d＝ηk+d-ΣHOκk+d-1 其中，则所有模态的相对预测误差可表示为其中ΨHO＝diag表示不同模态的预测误差的标准差对角阵；根据所有模态的相对预测误差矩阵判断出现问题的模态f，根据模态f的特征值λf，则第q个过程变量对于时序预测统计量的贡献度其中，xq,a是故障样本xa的第q个变量，abs表示对元素取绝对值，uHO_A,f,q是uHO_A,f的第q个元素，uHO_A,f是矩阵UHO_A的第f列，λf是模态f的特征值，是矩阵的第f行，运算符表示两个向量的元素对应相乘。第q个过程变量对于主成分统计量的贡献度计算方法为：其中第q个过程变量对于残差统计量的贡献度计算为其中本发明的有益效果是：本发明中提出的方法主要面向高阶自相关和互相关耦合的工业过程，提出了全解耦高阶动态模态分解将变量间的高阶自相关和互相关解耦并分解建模。针对高阶自相关性，本方法设计了时序预测统计量来表征过程的运行时序关系是否变化，设计了自相关特征统计量来表征过程的自相关特征是否在正常范围内波动。一旦检测到高阶自相关性出现异常，通过设计的故障变量隔离策略，识别出主导高阶自相关故障的关键变量。针对互相关性，本方法设计了主成分统计量来表征互相关信息的主成分特征是否在正常范围内波动，设计了残差统计量来表征变量的相关关系是否发生变化。一旦检测到互相关性出现异常，通过设计的故障变量隔离策略，识别出主导互相关故障的关键变量。相比于传统的自相关建模分析方法，本方法能对工业过程中的自相关性和互相关性完全解耦，考虑了互相关对自相关提取的影响。相比于动态模态分解方法，本方法充分考虑了更高阶次的自相关性。本方法可以对工业过程特性进行全面描述，具有更灵敏的检测精度，且根据不同的故障类型设计不同的变量隔离策略，具有更好的可解释性。附图说明下面结合附图和实施对发明进一步说明：图1为本发明所提方法故障检测结果图，其中虚线为控制限，实线为测试集样本的统计量计算结果；图2为主成分分析故障检测结果图，其中虚线为控制限，实线为测试集样本的统计量计算结果；图3为慢特征分析故障检测结果图，其中虚线为控制限，实线为测试集样本的统计量计算结果；图4为本发明所提方法的高阶自相关故障变量隔离结果图；图5为本发明所提方法的互相关故障变量隔离结果图；图6为主成分分析基于主成分统计量的故障变量隔离结果图；图7为主成分分析基于残差统计量的故障变量隔离结果图；图8为慢特征分析基于慢特征统计量的故障变量隔离结果图；图9为慢特征分析基于快特征统计量的故障变量隔离结果图；具体实施方式本实施例以火电厂数据为例进行验证本方法的有效性，但不限于此，任何存在变量互相关性和高阶自相关性耦合的工业工程均可利用本发明方法进行工业故障检测和变量隔离。下面结合附图和具体实施例，对本发明作进一步详细说明。在火电厂中，一般先把煤炭燃料送入锅炉中，在锅炉系统中产生水蒸气，由生成的水蒸气驱动汽轮机系统，带动汽轮转动，从而产生电能。其过程变量包括：凝汽器补给水流量，凝汽器水位，凝汽器循环水出水温度，凝汽器循环水进口温度，凝汽器甲侧循环水进口温度，凝汽器外置式疏水扩容器集管温度，循环水泵电机电流，循环水泵出口母管压力，凝结水流量，给水泵汽机轴承回油温度，汽动给水泵前轴承温度，汽动给水泵推力轴承外侧温度，高加进汽压力，低加进汽压力，高加进汽温度，低加进汽温度，除氧器进口凝结水流量，循环泵出口压力，闭式循环冷却水泵出口母管温度等。本发明的一种基于动态模态分解的工业动态过程异常监测与故障变量隔离方法包括采集正常样本建立模型和实时采集火电厂的运行数据进行异常监测与故障变量隔离两大步，在本实施例中，收集了2880个正常样本作为训练集建立模型，收集了1000个样本作为测试集进行异常监测与故障变量隔离测试，每个样本包含的过程变量为154个，样本的采样间隔为60秒。测试集中的故障是循环水泵出口压力偏差大预警，该故障从第501个样本开始出现，故障变量是第152个变量。其中建立模型包括以下步骤：步骤1：数据标准化针对数据标准化的计算公式为其中，n表示样本数，m表示变量数，xij表示数据矩阵X中第i行、第j列的元素即采集的第j个样本中的第i个过程变量的值，xij是标准化后的值，是所有样本中第i个过程变量的均值，si表示所有样本中第i个过程变量的标准差；对数据X进行标准化后可得数据矩阵步骤2：使用全解耦高阶动态模态分解将过程数据特性划分为高阶自相关性和互相关性；全解耦高阶动态模态分解具体为:2.1考虑一个高阶自相关系统其中，1≤k≤，xk表示第k个样本，AHO＝表示原始变量高阶自相关性的时序结构，d表示自相关的阶次，一般取值为2～5的正整数，本实施例中取值为3；数据矩阵X可以通过奇异值分解近似为X≈UΣV*其中和分别表示左奇异矩阵，对角阵和右奇异矩阵，且满足U*U＝I，V*V＝I，I表示单位矩阵；*表示共轭转置；r表示矩阵的近似阶次；构造矩阵块Yj如下：2.2计算原始变量高阶自相关性的时序结构AHO如下：其中表示Moore-Penrose伪逆；2.3通过下式计算潜变量潜变量中已经分离出变量的互相关性，只保留高阶自相关特性，即将互相关性和高阶自相关性完全解耦。潜变量的高阶时序关系预测值表示为其中表示第k个潜变量，表示潜变量高阶自相关性的时序结构；可通过式计算：2.4对潜变量高阶自相关性时序结构进行奇异值分解其中和分别表示的左奇异矩阵，对角阵和右奇异矩阵且满足Ir×r表示r阶单位矩阵；2.5原始变量高阶自相关性时序结构AHO的r阶奇异值分解可以表示为其中，是AHO的左奇异矩阵，可以计算为UHO_A＝UUHO ΣHO_A是AHO的对角阵，可以计算为ΣHO_A＝ΣHO是AHO的右奇异矩阵，可以计算为步骤3：设计时序预测统计量和自相关特征统计量对高阶自相关性进行描述；自相关特征统计量设计如下：其中表示第k+d个潜变量；时序预测统计量设计如下：其中||*||2表示L2范数；两者统计量的控制限由核密度估计确定。步骤4：分别基于时序预测统计量和/或自相关特征统计量设计自相关故障变量隔离策略，识别引起高阶自相关性异常的主导变量；4.1基于自相关特征统计量的自相关故障变量隔离策略第q个过程变量对于自相关特征统计量的贡献度可计算为其中，uj,t是U中第j行第t列的元素，将故障样本记作xa，xq,a是xa的第q个变量，abs表示对元素取绝对值；4.2基于时序预测统计量的自相关故障变量隔离策略将高阶自相关系统转换为如下形式：其中λ表示特征值ΣHO表示不同模态的变化规律。所有模态的预测误差矩阵eHO_mode,k+d可表示为：eHO_mode,k+d＝ηk+d-ΣHOκk+d-1 其中，则所有模态的相对预测误差可表示为其中ΨHO＝diag表示不同模态的预测误差的标准差对角阵；根据所有模态的相对预测误差矩阵判断出现问题的模态f，根据模态f的特征值λf，则第q个过程变量对于时序预测统计量的贡献度可计算为其中，xq,a是故障样本xa的第q个变量，abs表示对元素取绝对值，uHO_A,f,q是uHO_A,f的第q个元素，uHO_A,f是矩阵UHO_A的第f列，λf是模态f的特征值，是矩阵的第f行，同理，运算符表示两个向量的元素对应相乘。步骤5：设计主成分统计量和残差统计量对互相关性进行描述；分离出过程特性的高阶自相关性后，其互相关性包含在潜变量的重构残差中，可计算为：由此得重构残差数据矩阵为使用主成分分析对进行分解，可表示为：其中，P＝主成分统计量可计算为：其中为对角阵，λstatic,i为矩阵XXT的前θ个特征值；残差统计量可计算为：两者统计量的控制限由核密度估计确定。步骤6：分别基于主成分统计量和/或残差统计量设计互相关故障变量隔离策略，识别引起互相关性异常的主导变量；6.1基于主成分统计量的互相关故障变量隔离策略第q个过程变量对于主成分统计量的贡献度可计算为：其中6.2基于残差统计量的互相关故障变量隔离策略第q个过程变量对于残差统计量的贡献度可计算为其中至此，获得4个统计量和4个贡献度模型，将实时采集的样本输入至4个统计量模型之一中即可实现故障监测，将故障样本输入4个贡献度模型之一即可实现变量隔离，下面利用测试集样本根据故障检测和变量隔离两方面分别进行分析，说明本发明的效果。在故障检测方面，使用漏报率和误报率来评价该方法对故障检测的有效性。本发明针对案例1的故障检测结果如图1所示。可以发现，本方法设计的四个统计量都可以及时灵敏地检测到故障的发生。该故障的发生不仅影响了过程的高阶自相关性，也影响了互相关性，因此所设计的统计量都超过了控制限。此处选取了主成分分析PCA和C.Shang等人提出的慢特征分析SFA进行比较，其故障检测效果分别如图2和图3所示。可以发现，这些方法在故障发生前就发生了报警，可以看出变量间的互相关性和自相关性是相互影响的，当两者耦合在一起的时候，设计的统计量无法很好地描述正常的波动范围，因此会发生误报。为了更直观地进行比较，表1列出了不同方法的误报率和漏报率，可以发现，所有的方法都不存在漏报的现象，即故障都可以被很好地检测出来，但是本发明所提方法的误报率是最低的，不会在正常运行阶段发生报警，具有较高的精度。表1不同方法误报率和漏报率的比较在故障变量隔离方面，故障变量为第152个变量，本方法基于时序预测统计量和残差统计量，分别对引起高阶自相关和互相关故障的主导变量进行识别。常用的两个贡献度变量识别的结果展示在图4和图5。可以发现，本发明所提的两种故障隔离方法都可以清晰地识别出故障变量，且给故障变量分配了很高的贡献度，具有明显的指示效果。此处选取了基于主成分分析PCA和慢特征分析SFA的故障变量隔离策略进行比较。在主成分分析中，可以基于主成分统计量和残差统计量进行故障隔离，其效果展示在图6和图7。可以发现，虽然基于残差统计量的隔离策略可以正确识别出故障变量，但是基于主成分统计量的隔离策略却错误地将第150个变量也当作故障变量。在慢特征分析中，可以基于慢特征统计量和快特征统计量进行故障隔离，其效果展示在图8和图9。可以发现，无论是基于慢特征统计量还是快特征统计量的隔离策略均无法正确识别出故障变量。相比之下，本发明所提的方法具有更准确的效果。显然，上述实施例仅仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其他不同形式的变化或变动。这里无需也无法把所有的实施方式予以穷举。而由此所引申出的显而易见的变化或变动仍处于本发明的保护范围。
