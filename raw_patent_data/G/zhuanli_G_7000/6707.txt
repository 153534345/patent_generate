标题title
一种机载/弹载合成孔径雷达图像快速优化方法
摘要abst
本发明涉及一种机载/弹载合成孔径雷达图像快速优化方法，包含步骤：S1、将全景SAR回波数据进行距离向和方位向交叠分块，生成多个回波子阵；S2、基于各回波子阵，进行运动补偿及成像处理，生成对应的散焦子图像；S3、基于各散焦子图像，消除RD域残余孔径误差，生成对应的重聚焦子图像；S4、基于各重聚焦子图像，拼接SAR全景图。本发明实现了高精度残余空变运动误差补偿，并且原理简单，计算量少，运行速度快，具有较高的准确性和较强的鲁棒性，适用于实际处理，实用性较强。
权利要求书clms
1.一种机载/弹载合成孔径雷达图像快速优化方法，其特征在于，包含步骤：S1、将全景SAR回波数据进行距离向和方位向交叠分块，生成多个回波子阵；S2、基于各所述回波子阵，进行运动补偿及成像处理，生成对应的散焦子图像；S3、基于各所述散焦子图像，消除RD域残余孔径误差，生成对应的重聚焦子图像；S4、基于各所述重聚焦子图像，拼接SAR全景图。2.如权利要求1所述的机载/弹载合成孔径雷达图像快速优化方法，其特征在于，步骤S1中：对于分块的要求为：分块时相邻子块的交叠区域在距离向和方位向上的重叠点数，分别大于等于所述全景SAR回波数据的距离向弃置区长度Nr和方位向弃置区长度Na，Nr、Na的计算公式为：其中，Ta为合成孔径时间；PRF为重频；Tp为脉冲宽度；Fs为距离向采样率。3.如权利要求2所述的机载/弹载合成孔径雷达图像快速优化方法，其特征在于，步骤S2是通过TSMC算法和Chirp Scaling算法实现的，包含步骤：S21、对所述回波子阵进行一次处理生成一次处理回波子阵；S22、对所述一次处理回波子阵进行二次处理，生成散焦子图像。4.如权利要求3所述的机载/弹载合成孔径雷达图像快速优化方法，其特征在于，步骤S21包含：S211、基于TSMC算法对所述回波子阵进行一阶补偿，即距离向非空变误差补偿，生成一阶补偿回波子阵：用ss表示回波子阵，其中，k为慢时间采样索引，r′为距离向空域坐标，子阵大小为N0×N1，其表达式为：其中，exp为自然指数运算；j为虚数单位；λ为发射信号波长；K0＝4πkr/c2，其中，kr是距离向发射信号调频斜率，c是光速，ra为实际弹道轨迹下弹目斜距，r是目标零多普勒面距离；ra包含理想直线轨迹下弹目斜距rn，以及由运动误差引起斜距误差为Δr，其中，θk为随方位变化的瞬时斜视角，即Δr具有孔径空变性；TSMC算法中忽略θk，并将Δr分解为空变斜距误差量Δrv和非空变斜距误差量Δr0，其中，r0是参考距离；则ra可以变换如下：ra＝rn+Δr≈rn+Δr＝rn+Δrv+Δr0；Δr0可以理解为瞬时斜距误差在零多普勒面上的投影分量，计算公式为：其中，Δx为横向运动误差；Δz为垂直向运动误差；H为对地高度；基于Δr0，构造波数域内距离向非空变补偿函数HR，即：其中，Kr为距离波数；再基于HR，进行距离向非空变距离补偿，计算公式为：sS1＝sS·HR；其中，sS为对ss进行空域傅里叶变换后得到的回波子阵；sS1即为生成的所述一阶补偿回波子阵；S212、对所述一阶补偿回波子阵进行距离向脉冲压缩：构造空域匹配滤波器Hrmf：基于Hrmf对sS1进行距离向脉冲压缩，得到sS2，计算公式为：sS2＝sS1·Hrmf；然后，对sS2进行空域逆傅里叶变换，得到ss2，计算公式为：其中，sinc为归一化sinc函数运算，表达式为：sinc＝sin/πx；ss2即为经过距离向脉冲压缩后的所述一阶补偿回波子阵；S213、对经过距离向脉冲压缩后的所述一阶补偿回波子阵进行距离单元徙动校正，生成一次处理回波子阵：按照经典的插值距离徙动校正方法对ss2进行徙动校正，计算公式为：由于Δrv一般远小于距离分辨单元，可对ss3进行如下近似：ss3即为生成的所述一次处理回波子阵。5.如权利要求4所述的机载/弹载合成孔径雷达图像快速优化方法，其特征在于，步骤S22包含：S221、基于TSMC算法对所述一次处理回波子阵进行二阶补偿，即距离向空变误差补偿，生成二阶补偿回波子阵：由ss3表达式可知，所述回波子阵的距离徙动曲线已被完全校正，但是方位向上依然存在空变相位误差，故构造距离向空变相位补偿函数Hv：在方位时域距离空域内进行距离向空变误差补偿，计算公式为：ss4即为生成的所述二阶补偿回波子阵；S222、对所述二阶补偿回波子阵进行方位向脉冲压缩，生成散焦子图像：ss4中第一个指数项表示理想的方位向调制信号，在多普勒域构造匹配滤波器Hamf：其中，v为等效对地速度，fa为方位傅里叶频点；基于滤波器Hamf，在RD域内完成方位向脉冲压缩；然后，将经过方位向脉冲压缩的回波进行逆傅里叶变换，生成散焦子图像ss5，计算公式为：其中，Ba为多普勒带宽，k0为目标方位向坐标索引值，“*”为卷积运算符号；由ss5计算公式可知，残余的孔径空变相位误差等效为一个模糊滤波器，造成ss5在方位向出现散焦，ss5即为生成的所述散焦子图像。6.如权利要求5所述的机载/弹载合成孔径雷达图像快速优化方法，其特征在于，步骤S3是通过NuPTA算法实现的，包含步骤：S31、基于各散焦子图像，计算残余孔径误差、理想直线轨迹下雷达与目标瞬时斜距，计算公式为：其中，δr为残余孔径空变误差；rn为理想直线轨迹下雷达与目标瞬时斜距；S32、基于各散焦子图像和δr、rn，利用频率等于相位的一阶导数，计算残余孔径误差下的散焦子图像各个脉冲对应的多普勒频率，计算公式为：其中，f为散焦子图像第k个脉冲对应的真实多普勒频率；S33、基于δr和f，通过sinc插值算法，计算方位傅里叶频点对应的残余孔径补偿函数，计算公式为：S34、基于HNuPTA，在散焦子图像RD域完成残余孔径误差补偿：对散焦子图像ss5进行方位向傅里叶变换生成Ss5，再通过下式完成残余孔径空变相位误差补偿：Ss6＝Ss5·HNuPTA；再对Ss6进行方位向逆傅里叶变换，得到无残余相位误差的重聚焦子图像ss6。7.如权利要求5所述的机载/弹载合成孔径雷达图像快速优化方法，其特征在于，步骤S3是通过PTA算法实现的，包含步骤：S31、利用理想的方位频率-瞬时斜视角之间的关系，计算各散焦子图像的残余孔径误差补偿函数HPTA，计算公式为：S32、基于HPTA，在散焦子图像RD域完成残余孔径误差补偿：对散焦子图像ss5进行方位向傅里叶变换生成Ss5，再通过下式完成残余孔径空变相位误差补偿：Ss6＝Ss5·HPTA；再对Ss6进行方位向逆傅里叶变换，得到无残余相位误差的重聚焦子图像ss6。8.如权利要求6或7所述的机载/弹载合成孔径雷达图像快速优化方法，其特征在于，步骤S4包含：S41、判断是否已完成全部的所述回波子阵处理：否，则返回S2处理下一个所述回波子阵；是，则转入S42；S42、将处理后的各所述重聚焦子图像拼接成全景图：将各重聚焦子图像ss6进行四周裁剪处理，丢弃重叠部分，生成无重叠子图像ss7，表达式为：再将全部所述无重叠子图像ss7按裁剪前顺序直接拼接，获得最终处理后的SAR全景图。
说明书desc
技术领域本发明涉及合成孔径雷达运动误差补偿领域，具体涉及一种机载/弹载合成孔径雷达图像快速优化方法。背景技术SAR是一种高分辨率成像雷达，作为一种主动式微波遥感设备，SAR依靠本身的微波辐射工作，不受战场恶劣条件的影响，具有全天时全天候工作的优势，其装载在巡航导弹上能够克服传统的地形匹配系统和数字景象匹配导航模式易受恶劣气候、黑夜、烟雨和尘土等影响的缺陷，能够获得高分辨率和高成像精度的雷达图像，是提高精确制导武器打击精度的有效途径。但是，SAR在实际应用中，也存在一些难点问题，特别是机载/弹载SAR，在其对目标照射过程中，由于气流及自身轨迹的不稳定，会产生运动误差，造成目标在距离向发生位移，在方位向产生散焦，恶化图像质量。运动误差引起的雷达-目标瞬时斜距变化具有距离空变性、方位空变性以及孔径空变性。基于此，诸多研究人员从回波、图像等不同角度出发，在不同程度上解决这三个问题。比如，在国外，有研究团队对回波数据采用先距离粗补偿再精细补偿的策略，解决了中低分辨下运动误差距离空变和方位空变的问题，但是在高分辨和超高分辨系统下补偿性能下降严重；有研究团队从时域子孔径出发，根据时间中心处运动误差一致补偿整个子孔径的策略，一定程度上解决了孔径空变的问题，但是在复杂快变轨迹下补偿性能下降；也有研究团队从图像自聚焦出发，通过估计相位误差反向估计运动误差，解决方位空变和孔径空变问题，但是在复杂轨迹下，图像严重散焦，自聚焦精度下降，进而估计误差急剧变大；另外，在国内，有研究团队从回波频域出发，通过分段补偿子频带对应的运动误差，解决孔径空变和方位空变问题，但是该策略需要精确的子频带划分，易出现成对回波；也有研究团队从回波斜距误差解析式出发，通过逐脉冲逐采样点校正距离脉压后包络，解决距离空变和方位空变性，但是该算法运算量较大且在超高分辨下校准后易出现包络误差。专利CN102288962A提供了一种超宽带合成孔径雷达实时运动补偿方法，其特征在于，使用单点GPS输出的运动参数进行UWB SAR成像的实时运动补偿。该方法主要通过将视线方向运动误差分为距离空不变和距离空变两部分，分别在距离向脉冲压缩前和距离徙动校正后完成，解决了距离空变性和方位空变性，但是它忽略了距离空不变误差补偿后残余孔径空变分量对多普勒频谱的影响，导致SAR图像在复杂轨迹下补偿精度下降。专利CN107037430A介绍了用于飞行机载SAR运动补偿的估计方法，采用能量均衡法估计基带内多普勒中心和模糊数，计算得到绝对多普勒中心，利用估计出的多普勒中心在二维频域进行距离徙动校正；最后通过估计多普勒调频，完成方位向脉冲压缩，形成SAR成像。该方法根据线性运动误差会改变多普勒中心的原理，通过补偿多普勒中心完成线性运动补偿；另外通过估计方位向多普勒调频斜率，一定程度上降低由残余运动误差引起的方位向目标展宽。总体来说，该方法未考虑二次及更高阶运动误差对于频谱、距离位移的影响，只适合线性运动误差情况，最后虽然通过数据而非理论估算调频斜率，但是效果提升有限。专利CN103235306A，公开了一种适用于高速机动飞行器载SAR成像的运动补偿方法。首先根据高速机动飞行器载SAR成像的特点，采用二阶泰勒展开，近似获得运动误差下雷达-目标斜距模型，并以该模型为基础，在完成距离向处理和初步的方位Deramp处理之后，利用惯导信息并结合多普勒调频率估计获得了回波的残余多普勒调频率信息，并以此构造相应的补偿函数对误差相位进行合理补偿，改善高速机动飞行器载SAR图像的聚焦质量。该方法从回波解析式角度进行补偿函数表达式推理，具备在假定的斜距模型下精确解决运动误差能力。但是在复杂轨迹下，需要对斜距采用更高阶的泰勒展开，造成多普勒频谱理论表达式求解困难，难以继续。因此，该方法仅适用于补偿缓变运动误差情况。专利CN104181514A介绍了一种合成孔径雷达高精度运动补偿方法，它是首先用雷达平台匀速直线运动轨迹进行BP成像，获得粗聚焦的图像，然后以图像强度作为目标函数，以图像强度最优为准则迭代调整天线相位中心误差，结束后获得天线相位中心误差估计、天线相位中心位置误差，最后将估计出的位置误差加到匀速直线运动轨迹上，获得绝对位置，并用算法进行最终的高精度成像。该方法需要两轮BP成像，对于N×N回波数据，单次BP成像具有O的时间复杂度，因而它虽完全解决了运动误差的空变性问题，但运算量巨大。其次，基于最大图像强度准则的残余运动误差估计，对于均匀场景存在较大的估计误差，图像重聚焦效果提升有限。2017年IEEE Radar Conf.中J.M.Kantor公开的文献《Minimum entropy autofocus correction of residual range cell migration》改进了传统一维自聚焦只进行相位误差校正的情况，引入最小熵准则的二维自聚焦方法，将相位误差和距离向位移误差校正结合起来，降低了目标在距离向的能量泄漏。但是该方法的二维补偿精度取决于方位向自聚焦相位估计性能，在均匀场景或者图像恶化研制情况下，补偿性能急剧下降；除此之外，该方法认为距离徙动校正不改变运动误差引起的距离位移和相位误差之间对应关系，这个假设在大残余运动误差下并不成立，亦会造成补偿性能下降。2017年第11期《IEEE Transactions on Geoscience and Remote Sensing》中Chen J.公开的文献《A2-DSpace-Variant MotionEstimation and Compensation Method for Ultrahigh-Resolution Airborne Stepped-Frequency SAR With Long Integration Time》，提出采用参数化自聚焦方式估计方位相位误差，并根据相位与运动误差之间的数学关系，采用最小二乘估计运动误差。在此基础上对斜距误差在参考距离处泰勒展开至一次项，通过chirp-z进行距离空变补偿。该方法虽然从回波数据出发，不依赖GPS/INS，但是自聚焦估计精度受环境、飞行姿态影响较大，易因方位向相位误差传递而增大运动误差估计值方差；其次chirp-z只能补偿目标在距离向线性偏移，在复杂轨迹下存在补偿不充分的情况。2018年第6期《IEEE J.Sel.Topics Appl.Earth Observ.Remote Sens.》中Yang M.公开的文献《Efficient space-variant motion compensation approach for ultra-high-resolution SAR based onsubswath processing》提出采用基于距离插值的目标距离向包络校正技术，该方法根据目标在运动误差下距离向真实的采样位置插值出理论位置，通过逐点处理解决运动误差距离空变性；同时对所有的方位向脉冲采用对应处理，解决方位向空变性。但是，该方法未能解决宽波束-复杂运动误差下孔径空变误差对多普勒频谱的影响；其次复杂运动误差下由于斜距模型近似会产生严重的距离包络变形，降低图像质量；并且，对于宽幅照射下，距离向逐点插值处理需要较大的计算量，时效性较差。发明内容本发明的目的在于提供一种机载/弹载合成孔径雷达图像快速优化方法，采用数值计算方式精确获取任意轨迹下多普勒频率对应的残余运动误差量，提高相位误差补偿精度。为实现上述目的，本发明通过以下技术方案实现：一种机载/弹载合成孔径雷达图像快速优化方法，包含步骤：S1、将全景SAR回波数据进行距离向和方位向交叠分块，生成多个回波子阵；S2、基于各所述回波子阵，进行运动补偿及成像处理，生成对应的散焦子图像；S3、基于各所述散焦子图像，消除RD域残余孔径误差，生成对应的重聚焦子图像；S4、基于各所述重聚焦子图像，拼接SAR全景图。优选地，步骤S1中：对于分块的要求为：分块时相邻子块的交叠区域在距离向和方位向上的重叠点数，分别大于等于所述全景SAR回波数据的距离向弃置区长度Nr和方位向弃置区长度Na，Nr、Na的计算公式为：其中，Ta为合成孔径时间；PRF为重频；Tp为脉冲宽度；Fs为距离向采样率。优选地，步骤S2是通过TSMC算法和Chirp Scaling算法实现的，包含步骤：S21、对所述回波子阵进行一次处理生成一次处理回波子阵；S22、对所述一次处理回波子阵进行二次处理，生成散焦子图像。优选地，步骤S21包含：S211、基于TSMC算法对所述回波子阵进行一阶补偿，即距离向非空变误差补偿，生成一阶补偿回波子阵：用ss表示回波子阵，其中，k为慢时间采样索引，r′为距离向空域坐标，子阵大小为N0×N1，其表达式为：其中，exp为自然指数运算；j为虚数单位；λ为发射信号波长；K0＝4πkr/c2，其中，kr是距离向发射信号调频斜率，c是光速，ra为实际弹道轨迹下弹目斜距，r是目标零多普勒面距离；ra包含理想直线轨迹下弹目斜距rn，以及由运动误差引起斜距误差为Δr，其中，θk为随方位变化的瞬时斜视角，即Δr具有孔径空变性；TSMC算法中忽略θk，并将Δr分解为空变斜距误差量Δrv和非空变斜距误差量Δr0，其中，r0是参考距离；则ra可以变换如下：ra＝rn+Δr ≈rn+Δr ＝rn+Δrv+Δr0；Δr0可以理解为瞬时斜距误差在零多普勒面上的投影分量，计算公式为：其中，Δx为横向运动误差；Δz为垂直向运动误差；H为对地高度；基于Δr0，构造波数域内距离向非空变补偿函数HR，即：其中，Kr为距离波数；再基于HR，进行距离向非空变距离补偿，计算公式为：sS1＝sS·HR；其中，sS为对ss进行空域傅里叶变换后得到的回波子阵；sS1即为生成的所述一阶补偿回波子阵；S212、对所述一阶补偿回波子阵进行距离向脉冲压缩：构造空域匹配滤波器Hrmf：基于Hrmf对sS1进行距离向脉冲压缩，得到sS2，计算公式为：sS2＝sS1·Hrmf；然后，对sS2进行空域逆傅里叶变换，得到ss2，计算公式为：其中，sinc为归一化sinc函数运算，表达式为：sinc＝sin/πx；ss2即为经过距离向脉冲压缩后的所述一阶补偿回波子阵；S213、对经过距离向脉冲压缩后的所述一阶补偿回波子阵进行距离单元徙动校正，生成一次处理回波子阵：按照经典的插值距离徙动校正方法对ss2进行徙动校正，计算公式为：由于Δrv一般远小于距离分辨单元，可对ss3进行如下近似：ss3即为生成的所述一次处理回波子阵。优选地，步骤S22包含：S221、基于TSMC算法对所述一次处理回波子阵进行二阶补偿，即距离向空变误差补偿，生成二阶补偿回波子阵：由ss3表达式可知，所述回波子阵的距离徙动曲线已被完全校正，但是方位向上依然存在空变相位误差，故构造距离向空变相位补偿函数Hv：在方位时域距离空域内进行距离向空变误差补偿，计算公式为：ss4即为生成的所述二阶补偿回波子阵；S222、对所述二阶补偿回波子阵进行方位向脉冲压缩，生成散焦子图像：ss4中第一个指数项表示理想的方位向调制信号，在多普勒域构造匹配滤波器Hamf：其中，v为等效对地速度，fa为方位傅里叶频点；基于滤波器Hamf，在RD域内完成方位向脉冲压缩；然后，将经过方位向脉冲压缩的回波进行逆傅里叶变换，生成散焦子图像ss5，计算公式为：其中，Ba为多普勒带宽，k0为目标方位向坐标索引值，“*”为卷积运算符号；由ss5计算公式可知，残余的孔径空变相位误差等效为一个模糊滤波器，造成ss5在方位向出现散焦，ss5即为生成的所述散焦子图像。优选地，步骤S3是通过NuPTA算法实现的，包含步骤：S31、基于各散焦子图像，计算残余孔径误差、理想直线轨迹下雷达与目标瞬时斜距，计算公式为：其中，δr为残余孔径空变误差；rn为理想直线轨迹下雷达与目标瞬时斜距；S32、基于各散焦子图像和δr、rn，利用频率等于相位的一阶导数，计算残余孔径误差下的散焦子图像各个脉冲对应的多普勒频率，计算公式为：其中，f为散焦子图像第k个脉冲对应的真实多普勒频率；S33、基于δr和f，通过sinc插值算法，计算方位傅里叶频点对应的残余孔径补偿函数，计算公式为：S34、基于HNuPTA，在散焦子图像RD域完成残余孔径误差补偿：对散焦子图像ss5进行方位向傅里叶变换生成Ss5，再通过下式完成残余孔径空变相位误差补偿：Ss6＝Ss5·HNuPTA；再对Ss6进行方位向逆傅里叶变换，得到无残余相位误差的重聚焦子图像ss6。优选地，步骤S3是通过PTA算法实现的，包含步骤：S31、利用理想的方位频率-瞬时斜视角之间的关系，计算各散焦子图像的残余孔径误差补偿函数HPTA，计算公式为：S32、基于HPTA，在散焦子图像RD域完成残余孔径误差补偿：对散焦子图像ss5进行方位向傅里叶变换生成Ss5，再通过下式完成残余孔径空变相位误差补偿：Ss6＝Ss5·HPTA；再对Ss6进行方位向逆傅里叶变换，得到无残余相位误差的重聚焦子图像ss6。优选地，步骤S4包含：S41、判断是否已完成全部的所述回波子阵处理：否，则返回S2处理下一个所述回波子阵；是，则转入S42；S42、将处理后的各所述重聚焦子图像拼接成全景图：将各重聚焦子图像ss6进行四周裁剪处理，丢弃重叠部分，生成无重叠子图像ss7，表达式为：ss7＝ss6,再将全部所述无重叠子图像ss7按裁剪前顺序直接拼接，获得最终处理后的SAR全景图。综上所述，与现有技术相比，本发明提供的一种机载/弹载合成孔径雷达图像快速优化方法，具有如下有益效果：1、本发明不需要计算傅里叶变换时驻定相位点，对残余运动误差不作任何近似，具有更好地鲁棒性和更高的图像重聚焦质量；2、本发明计算简单，只需对子块数据进行一次的方位向傅里叶变换、一次复数据相乘和一次方位向逆傅里叶变换即完成残余孔径空变误差补偿，时间复杂度低。附图说明图1为本发明的基于NuPTA算法实现的机载/弹载合成孔径雷达图像快速优化方法流程图；图2为本发明的仿真场景设置示意图；图3为本发明的回波采集过程中运动误差数据图；图4为本发明的采用PTA算法和NuPTA算法与真实的残余孔径空变误差拟合情况对比图；图5a为本发明的通过PTA算法处理生成的全景图像；图5b为本发明的通过NuPTA算法处理生成的全景图像；图6a为本发明的场景中目标1在PTA算法和NuPTA算法补偿后的方位向点目标扩散函数对比图；图6b为本发明的场景中目标5在PTA算法和NuPTA算法补偿后的方位向点目标扩散函数对比图；图6c为本发明的场景中目标10在PTA算法和NuPTA算法补偿后的方位向点目标扩散函数对比图；图7a为本发明的实测数据下采用PTA算法的最终图像聚焦效果图；图7b为本发明的实测数据下采用NuPTA算法的最终图像聚焦效果图。具体实施方式以下结合附图和具体实施方式对本发明提出的一种机载/弹载合成孔径雷达图像快速优化方法作进一步详细说明。根据下面说明，本发明的优点和特征将更清楚。需要说明的是，附图采用非常简化的形式且均使用非精准的比例，仅用以方便、明晰地辅助说明本发明实施方式的目的，并非用以限定本发明实施的限定条件，故不具技术上的实质意义，任何结构的修饰、比例关系的改变或大小的调整，在不影响本发明所能产生的功效及所能达成的目的下，均应仍落在本发明所揭示的技术内容能涵盖的范围内。需要说明的是，在本发明中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括明确列出的要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。本发明的技术思路为：步骤1：将全景SAR回波数据进行距离向和方位向交叠分块，生成多个回波子阵；步骤2：基于各回波子阵，进行运动补偿及成像处理，生成对应的散焦子图像；步骤3：基于各散焦子图像，消除RD域残余孔径误差，生成对应的重聚焦子图像；步骤4：基于各重聚焦子图像，拼接SAR全景图。其中，本实施例采用如下具体算法实现：步骤2是通过TSMC算法和Chirp Scaling算法实现；步骤3有两种技术方案：通过传统的PTA算法实现；通过本发明提出的NuPTA算法实现。结合附图1～7所示，本实施例的具体实现步骤如下：如附图1所示，本实施例提供一种机载/弹载合成孔径雷达图像快速优化方法，包含步骤：S1、将整景的SAR回波数据，进行距离向和方位向交叠分块，生成多个回波子阵；对于分块的要求为：分块时相邻子块的交叠区域在距离向和方位向上的重叠点数，分别大于等于全景SAR回波数据的距离向弃置区长度Nr和方位向弃置区长度Na，Nr、Na的计算公式为：其中，Ta为合成孔径时间；PRF为重频；Tp为脉冲宽度；Fs为距离向采样率。S2、基于各回波子阵，通过TSMC算法和Chirp Scaling算法进行两次运动补偿及成像处理，生成多个对应的散焦子图像，其中，对于每个回波子阵生成对应的散焦子图像，包含步骤：S21、对回波子阵进行一次处理生成一次处理回波子阵，包含步骤：S211、基于TSMC算法对回波子阵进行一阶补偿，即距离向非空变误差补偿，生成一阶补偿回波子阵：用ss表示回波子阵，其中，k为慢时间采样索引，r′为距离空域坐标，子阵大小为N0×N1，其表达式为：其中，exp为自然指数运算；j为虚数单位；λ为发射信号波长；K0＝4πkr/c2，其中，kr是距离向发射信号调频斜率，c是光速，ra为实际弹道轨迹下弹目斜距，r是目标零多普勒面距离；ra包含理想直线轨迹下弹目斜距rn，以及由运动误差引起斜距误差为Δr，其中，θk为随方位变化的瞬时斜视角，即Δr具有孔径空变性。TSMC算法中忽略θk，并将Δr分解为空变斜距误差量Δrv和非空变斜距误差量Δr0，其中，r0是参考距离；则ra可以变换如下：ra＝rn+Δr ≈rn+Δr ＝rn+Δrv+Δr0；Δr0可以理解为瞬时斜距误差在零多普勒面上的投影分量，计算公式为：其中，Δx为横向运动误差；Δz为垂直向运动误差；H为对地高度；基于Δr0，构造波数域内距离向非空变补偿函数HR，即：其中，Kr为距离波数。再基于HR，进行距离向非空变距离补偿，计算公式为：sS1＝sS·HR；其中，sS为对ss进行空域傅里叶变换后得到的回波子阵；sS1即为生成的一阶补偿回波子阵。S212、对一阶补偿回波子阵进行距离向脉冲压缩：构造空域匹配滤波器Hrmf：基于Hrmf对sS1进行距离向脉冲压缩，得到sS2，计算公式为：sS2＝sS1·Hrmf；然后，对sS2进行空域逆傅里叶变换，得到ss2，计算公式为：其中，sinc为归一化sinc函数运算，表达式为：sinc＝sin/πx；ss2即为经过距离向脉冲压缩后的一阶补偿回波子阵。S213、对经过距离向脉冲压缩后的一阶补偿回波子阵进行距离单元徙动校正，生成一次处理回波子阵：按照经典的插值距离徙动校正方法对ss2进行徙动校正，计算公式为：由于Δrv一般远小于距离分辨单元，可对ss3进行如下近似：ss3即为生成的一次处理回波子阵。S22、对一次处理回波子阵进行二次处理，生成散焦子图像，包含步骤：S221、基于TSMC算法对一次处理回波子阵进行二阶补偿，即距离向空变误差补偿，生成二阶补偿回波子阵：由ss3表达式可知，回波子阵的距离徙动曲线已被完全校正，但是方位向上依然存在空变相位误差，故构造距离空变相位补偿函数Hv：在方位时域距离空域内进行距离向空变误差补偿，计算公式为：ss4即为生成的二阶补偿回波子阵。S222、对二阶补偿回波子阵进行方位向脉冲压缩，生成散焦子图像：ss4中第一个指数项表示理想的方位向调制信号，在多普勒域构造匹配滤波器Hamf：其中，v为等效对地速度，fa为方位傅里叶频点；基于滤波器Hamf，在RD域内完成方位向脉冲压缩；然后，将经过方位向脉冲压缩的回波进行逆傅里叶变换，生成散焦子图像ss5，计算公式为：其中，Ba为多普勒带宽，k0为目标方位向坐标索引值，“*”为卷积运算符号；由ss5计算公式可知，残余的孔径空变相位误差等效为一个模糊滤波器，造成ss5在方位向出现散焦，ss5即为生成的散焦子图像。S3、基于各散焦子图像，通过NuPTA算法消除RD域残余孔径误差，生成多个对应的重聚焦子图像，其中，对于每个散焦子图像生成对应的重聚焦子图像包含步骤：S31、基于各散焦子图像，计算残余孔径误差、理想直线轨迹下雷达与目标瞬时斜距，计算公式为：其中，δr为残余孔径空变误差；rn为理想直线轨迹下雷达与目标瞬时斜距。S32、基于各散焦子图像和δr、rn，利用频率等于相位的一阶导数，计算残余孔径误差下的散焦子图像各个脉冲对应的多普勒频率，计算公式为：其中，f为散焦子图像第k个脉冲对应的真实多普勒频率。S33、基于δr和f，通过sinc插值算法，计算方位傅里叶频点对应的残余孔径补偿函数，计算公式为：S34、基于HNuPTA，在散焦子图像RD域完成残余孔径误差补偿：对散焦子图像ss5进行方位向傅里叶变换生成Ss5，再通过下式完成残余孔径空变相位误差补偿：Ss6＝Ss5·HNuPTA；再对Ss6进行方位向逆傅里叶变换，得到无残余相位误差的重聚焦子图像ss6。S4、基于各重聚焦子图像，拼接SAR全景图，包含步骤：S41、判断是否已完成全部的回波子阵处理：否，则返回S2处理下一个回波子阵；是，则转入S42。S42、将处理后的各重聚焦子图像拼接成全景图：将各重聚焦子图像ss6进行四周裁剪处理，丢弃重叠部分，生成无重叠子图像ss7，表达式为：ss7＝ss6,再将全部无重叠子图像ss7按裁剪前顺序直接拼接，获得最终处理后的SAR全景图。以上方案是本实施例提供的基于NuPTA算法实现的机载/弹载合成孔径雷达图像优化方法，同时，本实施例还提供一种基于传统的PTA算法实现的机载/弹载合成孔径雷达图像快速优化方法，其步骤S1、S2、S4与基于NuPTA算法的步骤S1、S2、S4完全相同，仅将步骤S3替换为以下步骤S3'：S3'、基于各散焦子图像，通过传统的PTA算法消除RD域残余孔径误差，生成重聚焦子图像，包含步骤：S31'、利用理想的方位频率-瞬时斜视角之间的关系，计算各散焦子图像的残余孔径误差补偿函数HPTA，计算公式为：S32'、基于HPTA，在散焦子图像RD域完成残余孔径误差补偿：对散焦子图像ss5进行方位向傅里叶变换生成Ss5，再通过下式完成残余孔径空变相位误差补偿：Ss6＝Ss5·HPTA；再对Ss6进行方位向逆傅里叶变换，得到无残余相位误差的重聚焦子图像ss6。为了进一步说明采用本发明的NuPTA算法对比传统的PTA算法所优化的技术效果，如附图2～7所示，本实施例提供以下仿真试验：仿真条件如附图2所示，成像场景设置为17个目标组成的“十”字场景，其中目标1～17在附图2中以数字1～17表示，各相邻目标的距离和方位间隔分别设置为5米和1.6米，场景距离中心设置为750米，方位中心设置为3000米。回波数据采集过程中发生的垂直向和横向运动误差如附图3所示，雷达系统仿真参数如表1所示。表1系统仿真参数仿真内容和结果分析仿真1：步骤1、根据表1中的参数，计算得Nr＝90、Na＝421，因此，将相邻子块回波交叠部分在距离向设置为100点，在方位向设置为433点；按此参数，对整景的SAR回波数据进行距离向和方位向交叠分块，生成多个回波子阵。步骤2、基于TSMC算法和Chirp Scaling成像算法，对每一个子块进行运动补偿和图像处理，生成散焦子图像。步骤3、对每一幅散焦子图像分别通过PTA算法和NuPTA算法，生成无残余相位误差的重聚焦子图像，如附图4所示，对比于真值，可知采用NuPTA算法比采用PTA算法具有更高的精度，这也解释了NuPTA算法重聚焦能力优于PTA算法的根本原因。步骤4、如附图5a所示，将每一幅PTA算法补偿后的子图像进行剪除重叠部分后直接拼接，形成PTA算法补偿后整景图像；如附图5b所示，按照同样的处理流程，对NuPTA算法补偿后子图像进行拼接，形成NuPTA算法补偿后整景图像。为了进一步分析NuPTA算法相对于PTA算法补偿性能的提升，附图6a、附图6b、附图6c分别展示了场景中目标1、目标5和目标10在PTA算法和NuPTA算法处理后的点扩散函数对比。众所周知，在未加窗情况下，线性调频信号脉冲压缩后理想PSLR为-13.6dB，由附图5a、附图5b可知，PTA算法处理后的三个目标PSLR分别为-3.2dB，-11dB以及-3dB，而NuPTA算法处理后三个目标的PSLR分别为-13.7dB，-13.9dB以及-12.8dB，显示了NuPTA算法具有更加优越的残余孔径空变误差补偿性能。仿真2：用本实施例提供的方法对实测数据进行处理，实测数据来源于C波段，脉冲宽度为10.4微秒，脉冲重复频率为1673Hz，距离向采样率为240MHz，合成孔径时间为4.07秒，垂直向运动误差平均值为28.2米，横向平均运动误差为11.8米。采用NuPTA算法和PTA算法对回波数据补偿后的结果如附图7a、附图7b所示，通过对比强目标的聚焦效果，NuPTA算法再次显示了优于PTA算法的补偿性能。综上所述，本发明提供一种机载/弹载合成孔径雷达图像快速优化方法，通过采用数值计算方式精确获取任意轨迹下多普勒频率对应的残余运动误差量，提高子块相位误差补偿精度；通过分块策略完成整景图像相位误差补偿。本发明实现了高精度残余空变运动误差补偿，并且原理简单，计算量少，具有较高的准确性和较强的鲁棒性，运行速度快，适用于实际处理。尽管本发明的内容已经通过上述优选实施例作了详细介绍，但应当认识到上述的描述不应被认为是对本发明的限制。在本领域技术人员阅读了上述内容后，对于本发明的多种修改和替代都将是显而易见的。因此，本发明的保护范围应由所附的权利要求来限定。
