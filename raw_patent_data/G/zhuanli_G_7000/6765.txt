标题title
基于SMOTE和并行随机森林的物联网设备准入检测方法和系统
摘要abst
本发明公开了一种基于SMOTE和并行随机森林的物联网设备准入检测方法，包括：获取物联网设备的多个设备指纹信息，对每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的所有设备指纹信息对应的特征属性值构建特征矩阵；将特征矩阵输入训练好的设备识别分类器中，以得到输出结果，根据输出结果在本地漏洞库中查询对应的漏洞及其类型，并根据该类型判断查询到的漏洞是否为中高危漏洞，如果是则禁止该物联网设备接入，否则允许该物联网设备接入。本发明能够解决现有基于机器学习或者深度学习的物联网设备接入检测方法由于物联网设备品种多样且差异性大，导致对不常见的物联网设备的检测准确率偏低的技术问题。
权利要求书clms
1.一种基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，包括以下步骤：获取物联网设备的多个设备指纹信息，对每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的所有设备指纹信息对应的特征属性值构建特征矩阵Feature；将步骤构建的特征矩阵Feature输入训练好的设备识别分类器中，以得到输出结果，包括物联网设备的名称、设备类型、设备制造商、以及固件版本。根据步骤得到的输出结果在本地漏洞库中查询对应的漏洞及其类型，并根据该类型判断查询到的漏洞是否为中高危漏洞，如果是则禁止该物联网设备接入，过程结束，否则允许该物联网设备接入，过程结束。2.根据权利要求1所述的基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，物联网设备的特征属性包括：数据链路层协议，其包括ARP协议和Ethernet协议；网络层协议，其包括IP协议、ICMP协议、ICMPv6协议、EAPoL协议、以及IGMP协议；传输层协议，其包括TCP协议和UDP协议；应用层协议，其包括HTTP协议、HTTPS协议、BOOTP协议、SSDP协议、DNS协议、MDNS协议、NTP协议、SMB协议、SSH协议、以及MQTT协议；包长度；通信源端口；通信目的端口；以及物联网设备在配置阶段的上下文数据包个数。3.根据权利要求1或2所述的基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，设备识别分类器采用的是随机森林模型。4.根据权利要求1至3中任意一项所述的基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，设备识别分类器是通过以下步骤训练得到的：获取多个物联网设备的设备指纹信息{Info1，Info2，…，Infom}，对每个物联网设备的每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的该物联网设备的所有设备指纹信息对应的特征属性值构建特征矩阵，并将所有物联网设备对应的特征矩阵进行合并，以得到合并后的特征矩阵，其中m表示物联网设备的总数，Infonum表示第num个物联网设备的设备指纹信息，且有num∈；利用SMOTE技术对步骤得到的特征矩阵进行数据增强处理，以得到处理后的特征矩阵；将步骤处理后的特征矩阵按照行数8:2的比例划分为训练集和测试集，并将训练集输入设备识别分类器；使用分类回归树算法对设备识别分类器中的权重参数和偏置参数进行更新和优化，以得到更新后的设备识别分类器；对步骤更新后的设备识别分类器进行迭代训练，直到该设备识别分类器的损失函数达到最小为止，从而得到初步训练好的设备识别分类器；使用步骤得到的验证集对初步训练好的设备识别分类器进行迭代验证，直到得到的分类精度达到最优为止，从而得到训练好的设备识别分类器。5.根据权利要求4所述的基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，步骤包括以下子步骤：设置计数器cnt2＝0；判断cnt2是否大于特征矩阵总行数对应的少数样本数据集的行数f，如果是则过程结束，否则进入步骤；针对少数样本数据集中的第i个少数样本而言，计算该第i行到该少数样本数据集中剩余少数样本中每一个少数样本之间的距离；针对少数样本数据集中的第i个少数样本而言，将步骤计算得到的多个距离进行升序排列，使用SMOTE算法对排列前k个对应的少数样本进行扩充处理，以得到扩充处理后的少数样本，其中k等于f的1/20到1/10之间，扩充倍率等于m/f；将扩充处理后的k个少数样本加入步骤合并后的特征矩阵中，并设置计数器cnt2＝cnt2+1，并返回步骤。6.根据权利要求5所述的基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，步骤中，少数样本数据集的建立过程是，首先，确定其全部设备指纹信息对应的总行数小于该特征矩阵总行数的1/T的第一个物联网设备，然后，确定该第一个物联网设备在合并后的特征矩阵中对应的所有行作为第一少数样本；随后，确定其全部设备指纹信息对应的总行数小于该特征矩阵总行数的1/T的第二个物联网设备，然后确定该第二个物联网设备在合并后的特征矩阵中对应的所有行作为第二少数样本；…；以此类推，所有少数样本的集合构成了少数样本数据集，其中T为自然数。7.根据权利要求4所述的基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，损失函数使用的是CART回归的损失函数，其具体为：其中p表示步骤中物联网设备的特征属性总数量，features-z表示物联网设备的第z个特征属性值，且有z∈，xfeatures-z表示步骤合并后的特征矩阵中第z个特征属性值对应的行的总数。8.根据权利要求1所述的基于SMOTE和并行随机森林的物联网设备准入检测方法，其特征在于，输出结果包括物联网设备的名称、设备类型、设备制造商、以及固件版本。9.一种基于SMOTE和并行随机森林的物联网设备准入检测系统，其特征在于，包括：第一模块，用于获取物联网设备的多个设备指纹信息，对每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的所有设备指纹信息对应的特征属性值构建特征矩阵Feature；第二模块，用于将第一模块构建的特征矩阵Feature输入训练好的设备识别分类器中，以得到输出结果；第三模块，用于根据第二模块得到的输出结果在本地漏洞库中查询对应的漏洞及其类型，并根据该类型判断查询到的漏洞是否为中高危漏洞，如果是则禁止该物联网设备接入，过程结束，否则允许该物联网设备接入，过程结束。
说明书desc
技术领域本发明属于机器学习技术领域，更具体地，涉及一种基于SMOTE和并行随机森林的物联网设备接入安全检测的方法和系统。背景技术近年来，随着物联网技术的快速发展，物联网设备已经得到了日益广泛的使用。与之对应地，物联网设备的安全性问题也显得日益突出，并且物联网设备接入检测也已经成为物联网安全领域的重要研究方向。现有的物联网设备接入检测是基于机器学习或者深度学习的方式对设备进行识别。然而，上述现有的物联网设备接入检测方法存在一些不可忽略的缺陷：第第一，由于物联网设备品种多样，且差异性大，现有基于机器学习的接入检测方法会导致现有方法对常见的物联网设备的检测率高，但对不常见的物联网设备的检测准确率偏低；第二，现有方法在使用海量样本数据进行模型训练时，需要耗费过长时间发明内容针对现有技术的以上缺陷或改进需求，本发明提供了一种基于SMOTE和并行随机森林的物联网设备接入安全检测的方法和系统，其目的在于，解决现有基于机器学习或者深度学习的物联网设备接入检测方法由于物联网设备品种多样且差异性大，导致对不常见的物联网设备的检测准确率偏低的技术问题，以及在使用海量样本数据进行模型训练时，需要耗费过长时间的技术问题。为实现上述目的，按照本发明的一个方面，提供了一种基于SMOTE和并行随机森林的物联网设备准入检测方法，包括以下步骤：获取物联网设备的多个设备指纹信息，对每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的所有设备指纹信息对应的特征属性值构建特征矩阵Feature；将步骤构建的特征矩阵Feature输入训练好的设备识别分类器中，以得到输出结果，包括物联网设备的名称、设备类型、设备制造商、以及固件版本。根据步骤得到的输出结果在本地漏洞库中查询对应的漏洞及其类型，并根据该类型判断查询到的漏洞是否为中高危漏洞，如果是则禁止该物联网设备接入，过程结束，否则允许该物联网设备接入，过程结束。优选地，物联网设备的特征属性包括：数据链路层协议，其包括ARP协议和Ethernet协议；网络层协议，其包括IP协议、ICMP协议、ICMPv6协议、EAPoL协议、以及IGMP协议；传输层协议，其包括TCP协议和UDP协议；应用层协议，其包括HTTP协议、HTTPS协议、BOOTP协议、SSDP协议、DNS协议、MDNS协议、NTP协议、SMB协议、SSH协议、以及MQTT协议；包长度；通信源端口；通信目的端口；以及物联网设备在配置阶段的上下文数据包个数。优选地，设备识别分类器采用的是随机森林模型；优选地，设备识别分类器是通过以下步骤训练得到的：获取多个物联网设备的设备指纹信息{Info1，Info2，…，Infom}，对每个物联网设备的每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的该物联网设备的所有设备指纹信息对应的特征属性值构建特征矩阵，并将所有物联网设备对应的特征矩阵进行合并，以得到合并后的特征矩阵，其中m表示物联网设备的总数，Infonum表示第num个物联网设备的设备指纹信息，且有num∈；利用SMOTE技术对步骤得到的特征矩阵进行数据增强处理，以得到处理后的特征矩阵；将步骤处理后的特征矩阵按照行数8:2的比例划分为训练集和测试集，并将训练集输入设备识别分类器；使用分类回归树算法对设备识别分类器中的权重参数和偏置参数进行更新和优化，以得到更新后的设备识别分类器；对步骤更新后的设备识别分类器进行迭代训练，直到该设备识别分类器的损失函数达到最小为止，从而得到初步训练好的设备识别分类器；使用步骤得到的验证集对初步训练好的设备识别分类器进行迭代验证，直到得到的分类精度达到最优为止，从而得到训练好的设备识别分类器。优选地，步骤包括以下子步骤：设置计数器cnt2＝0；判断cnt2是否大于特征矩阵总行数对应的少数样本数据集的行数f，如果是则过程结束，否则进入步骤；针对少数样本数据集中的第i个少数样本而言，计算该第i行到该少数样本数据集中剩余少数样本中每一个少数样本之间的距离；针对少数样本数据集中的第i个少数样本而言，将步骤计算得到的多个距离进行升序排列，使用SMOTE算法对排列前k个对应的少数样本进行扩充处理，以得到扩充处理后的少数样本，其中k等于f的1/20到1/10之间，扩充倍率等于m/f；将扩充处理后的k个少数样本加入步骤合并后的特征矩阵中，并设置计数器cnt2＝cnt2+1，并返回步骤；优选地，步骤中，少数样本数据集的建立过程是，首先，确定其全部设备指纹信息对应的总行数小于该特征矩阵总行数的1/T的第一个物联网设备，然后，确定该第一个物联网设备在合并后的特征矩阵中对应的所有行作为第一少数样本；随后，确定其全部设备指纹信息对应的总行数小于该特征矩阵总行数的1/T的第二个物联网设备，然后确定该第二个物联网设备在合并后的特征矩阵中对应的所有行作为第二少数样本；…；以此类推，所有少数样本的集合构成了少数样本数据集，其中T为自然数。优选地，损失函数使用的是CART回归的损失函数，其具体为：其中p表示步骤中物联网设备的特征属性总数量，features-z表示物联网设备的第z个特征属性值，且有z∈，xfeatures-z表示步骤合并后的特征矩阵中第z个特征属性值对应的行的总数。优选地，输出结果包括物联网设备的名称、设备类型、设备制造商、以及固件版本。按照本发明的另一方面，提供了一种基于SMOTE和并行随机森林的物联网设备准入检测系统，包括：第一模块，用于获取物联网设备的多个设备指纹信息，对每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的所有设备指纹信息对应的特征属性值构建特征矩阵Feature；第二模块，用于将第一模块构建的特征矩阵Feature输入训练好的设备识别分类器中，以得到输出结果；第三模块，用于根据第二模块得到的输出结果在本地漏洞库中查询对应的漏洞及其类型，并根据该类型判断查询到的漏洞是否为中高危漏洞，如果是则禁止该物联网设备接入，过程结束，否则允许该物联网设备接入，过程结束。总体而言，通过本发明所构思的以上技术方案与现有技术相比，能够取得下列有益效果：由于本发明采用了步骤和步骤，其通过已有物联网设备指纹信息，构造设备指纹特征向量，并SMOTE算法进行数据增强，因此能够解决现有接入检测方法对常见的物联网设备的检测率高，但对不常见的物联网设备的检测准确率偏低的技术问题；由于本发明采用了步骤至，其采用并行的随机森林算法训练设备识别分类器，因此能够解决现有接入检测方法在使用海量样本数据进行模型训练时，需要耗费过长时间的技术问题。附图说明图1是本发明基于SMOTE和并行随机森林的物联网设备准入检测方法的流程图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。此外，下面所描述的本发明各个实施方式中所涉及到的技术特征只要彼此之间未构成冲突就可以相互组合。本发明的基本思路在于，提供一种基于SMOTE和并行随机森林的物联网设备准入检测方法，其首先根据物联网设备接入配置阶段的数据流，提取设备指纹特征信息。根据设备指纹特征信息，构造特征矩阵。考虑到现有方法对不常见的物联网设备识别准确率过低，采用SMOTE算法进行数据增强，解决不平衡样本训练集下少数类样本识别精度低的问题。然后基于并行化的随机森林算法，快速进行模型训练，得到设备识别分类器。最后，将待接入物联网设备指纹特征向量矩阵输入分类器，得到设备的指纹信息：设备名称、设备类型、设备制造商、固件版本。根据设备的指纹信息，依次匹配本地漏洞库，精准进行设备安全漏洞评估。本发明的物联网设备安全信息检测方法具有良好的适用性以及精确的识别度。如图1所示，本发明提供了一种基于SMOTE和并行随机森林的物联网设备准入检测方法，包括以下步骤：获取物联网设备的多个设备指纹信息，对每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的所有设备指纹信息对应的特征属性值构建特征矩阵Feature；具体而言，物联网设备的特征属性包括但不局限于：数据链路层协议和Ethernet，例如，如果该物联网设备的数据链路层协议是ARP，则其特征属性值为1，否则为0)、网络层协议、ICMPv6、可扩展认证协议、以及Internet组管理协议，例如，如果该设备的网络层协议是IP，则其特征属性值为1，否则为0)、传输层协议、应用层协议、包长度、通信源端口、通信目的端口、以及物联网设备在配置阶段的上下文数据包个数。举例而言，通过本步骤所构建的特征矩阵Feature如下：在该矩阵中，第一行表示第一个设备指纹信息对应的特征属性值，其中该行的第一个元素0，表示该物联网设备的数据链路层协议不是ARP，第二个元素1，表示该物联网设备的数据链路层协议是Ethernet，第三个元素1，表示该物联网设备的网络层协议是IP协议，第四个元素是0，表示该物联网设备的网络层协议不是ICMP协议，第五个元素是0，表示该物联网设备的网络层协议不是ICMPv6协议，…，以此类推，最后一个元素是5，表示该物联网设备在配置阶段的上下文数据包个数是5。上述步骤的优点在于，精准提取设备指纹特征并构建特征矩阵，提高了设备识别分类器的准确率。将步骤构建的特征矩阵Feature输入训练好的设备识别分类器中，以得到输出结果，包括物联网设备的名称、设备类型、设备制造商、以及固件版本；本发明中的设备识别分类器采用的是随机森林模型。具体而言，本发明的设备识别分类器是通过以下步骤训练得到的：获取多个物联网设备的设备指纹信息{Info1，Info2，…，Infom}，对每个物联网设备的每个设备指纹信息进行解析，以获取该设备指纹信息对应的特征属性值，并根据获取的该物联网设备的所有设备指纹信息对应的特征属性值构建特征矩阵，并将所有物联网设备对应的特征矩阵进行合并，以得到合并后的特征矩阵，其中m表示物联网设备的总数，Infonum表示第num个物联网设备的设备指纹信息，且有num∈；本步骤中的过程和上述步骤中的完全相同，在此不再赘述。利用合成少数类过采样技术对步骤得到的特征矩阵进行数据增强处理，以得到处理后的特征矩阵；具体而言，本步骤包括以下子步骤：设置计数器cnt2＝0；判断cnt2是否大于特征矩阵总行数对应的少数样本数据集的行数f，如果是则过程结束，否则进入步骤；具体而言，少数样本数据集的建立过程是，首先，确定其全部设备指纹信息对应的总行数小于该特征矩阵总行数的1/T的第一个物联网设备，然后，确定该第一个物联网设备在合并后的特征矩阵中对应的所有行作为第一少数样本；随后，确定其全部设备指纹信息对应的总行数小于该特征矩阵总行数的1/T的第二个物联网设备，然后确定该第二个物联网设备在合并后的特征矩阵中对应的所有行作为第二少数样本；…；以此类推，所有少数样本的集合构成了少数样本数据集。针对少数样本数据集中的第i个少数样本而言，计算该第i行到该少数样本数据集中剩余少数样本中每一个少数样本之间的距离，计算公式如下，其中i∈，j∈且有j≠i：针对少数样本数据集中的第i个少数样本而言，将步骤计算得到的多个距离进行升序排列，使用SMOTE算法对排列前k个对应的少数样本进行扩充处理，以得到扩充处理后的少数样本；将扩充处理后的k个少数样本加入步骤合并后的特征矩阵中，并设置计数器cnt2＝cnt2+1，并返回步骤；上述步骤到的优点在于，针对不均衡的样本集，使用SMOTE算法进行数据增强，因此能够解决现有接入检测方法对常见的物联网设备的检测率高，但对不常见的物联网设备的检测准确率偏低的技术问题。将步骤处理后的特征矩阵按照行数8:2的比例划分为训练集和测试集，并将训练集输入设备识别分类器；使用分类回归树算法对设备识别分类器中的权重参数和偏置参数进行更新和优化，以得到更新后的设备识别分类器；本步骤的优点在于，采用并行的随机森林算法训练设备识别分类器，因此能够解决现有接入检测方法在使用海量样本数据进行模型训练时，需要耗费过长时间的技术问题。对步骤更新后的设备识别分类器进行迭代训练，直到该设备识别分类器的损失函数达到最小为止，从而得到初步训练好的设备识别分类器；具体而言，本发明中使用的损失函数使用的是CART回归的损失函数，其具体为：其中p表示步骤中物联网设备的特征属性总数量，features-z表示物联网设备的第z个特征属性值，且有z∈，xfeatures-z表示步骤合并后的特征矩阵中第z个特征属性值对应的行的总数。使用步骤得到的验证集对初步训练好的设备识别分类器进行迭代验证，直到得到的分类精度达到最优为止，从而得到训练好的设备识别分类器。根据步骤得到的输出结果在本地漏洞库中查询对应的漏洞及其类型，并根据该类型判断查询到的漏洞是否为中高危漏洞，如果是则禁止该物联网设备接入，过程结束，否则允许该物联网设备接入，过程结束。具体而言，本步骤中使用的本地漏洞库是从诸如网址http://cve.mitre.org这样的漏洞数据库获取到的，该本地漏洞库中记载了所有漏洞的编号、以及各个漏洞的类型。本领域的技术人员容易理解，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
