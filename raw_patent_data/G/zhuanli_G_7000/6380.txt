标题title
一种抗观测数据干扰的多车协同状态估计方法
摘要abst
本发明公开了一种抗观测数据干扰的多车协同状态估计方法，主车、协同车分别对目标车进行感知，获得含有异常噪声的目标车状态观测数据。主车作为信息融合中心，对收集到的观测数据进行预处理，得到组合观测数据。基于学生t分布模拟重尾、非高斯的观测噪声可有效抑制异常噪声的影响；初始化状态变量、观测噪声协方差的先验超参数和调节参数；利用变分推断，计算第t次迭代后目标车状态的变分后验分布和观测噪声的变分后验分布；判断目标车状态是否收敛，直至收敛后输出当前时刻k估计的目标车状态；跟踪结束后，输出本次跟踪位置和速度的均方根误差图。本发明的多车协同状态估计方法，通过融入更多观测信息，能有效提高目标车状态估计的精度。
权利要求书clms
1.一种抗观测数据干扰的多车协同状态估计方法，其特征在于，包括如下步骤：步骤1：主车、协同车按照各自频率分别对目标车进行感知，继而分别获得含有噪声的目标车状态观测数据；同时，协同车将协同车的自车状态以及协同车所感知的目标车状态观测数据发送给主车；步骤2：主车作为信息融合中心，将主车收集到的目标车状态观测数据以及协同车发送的目标车状态观测数据进行时间同步和坐标转换处理，得到经过预处理后的组合观测数据；为抑制异常噪声对观测数据的影响，基于学生t分布模拟重尾、非高斯的观测噪声；步骤3：在k＝0时刻，初始化状态变量表示x0服从均值m0和协方差P0的高斯分布；初始化观测噪声协方差-1的先验超参数其中，u0，Λ0分别为初始自举变量值、初始精确度值，均为初始先验超参数；步骤4：利用扩展卡尔曼滤波器，预测k时刻的目标车状态分布表示xk|k-1服从均值协方差的高斯分布；预测k时刻观测噪声协方差-1的先验超参数和k≥1；步骤5：变分内循环：利用变分贝叶斯推断理论，计算第t次迭代后的目标后验状态，经过变分推断的均值和协方差为和计算第t次迭代后的观测噪声参数的后验分布，经过变分推断得到精确度、自举变量和自由度分别为和并计算期望＜-1＞t；步骤6：判断目标车状态是否收敛，如果收敛则进行下一步骤，否则，令迭代次数t←t+1，返回步骤5继续迭代，直至收敛；收敛的判断标准为：如果两次迭代状态的相对变化量ε小于阈值G，则终止迭代；步骤7：输出每个时刻估计的目标车状态步骤8：选择是否继续跟踪，是则返回步骤1继续跟踪，否则结束跟踪；跟踪结束后，输出本次跟踪位置和速度的均方根误差图。2.根据权利要求1所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，所述步骤2中基于学生t分布模拟重尾、非高斯的观测噪声的方法为：S1、分别构造主车对协同车和目标车的观测方程和协同车对目标车的观测方程S2、通过组合主车对协同车和目标车的观测结果和协同车对目标车的观测结果得到增广观测向量进而获得增广观测噪声和增广观测噪声H、Jhk分别是主车传感器的观测矩阵和协同车传感器的雅可比观测矩阵，分别是主车传感器的观测噪声和协同车传感器的观测噪声；S3、以学生t分布模拟观测噪声vk，概率密度函数表示为：其中，S表示学生t分布，d为状态变量维度，v为d维随机向量，且服从学生t分布，μ为均值，Λ为精确度，λ为自由度；将学生t分布看作多个高斯分布的组合，表示为：其中，表示高斯分布，Gamma表示伽马分布，u为自举变量；最终协同跟踪的增广观测模型可以表示为：协同跟踪的增广观测噪声可以表示为：vk～S；其中，μk，Λk，λk分别为k时刻的均值，k时刻的精确度和k时刻的自由度。3.根据权利要求1所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，步骤4中计算均值和协方差的方法为：设置多车协同状态方程xk＝Fxk-1+wk和具体相关参数，F是状态转移矩阵，wk是过程噪声，xk是系统状态向量；基于多车协同状态方程得预测状态和协方差，表示为：其中，分别为状态一步预测和上一时刻更新后的目标状态，分别为协方差矩阵一步预测和上一时刻更新后的协方差矩阵；Q是过程噪声协方差。4.根据权利要求1所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，步骤4中计算先验超参数和的方法为：引入调节因子ρ∈反映噪声统计特性的波动特性，设置观测噪声协方差分布超参数的先验分布为：其中，和均为上一时刻更新后的先验参数。5.根据权利要求4所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，所述步骤5包括如下步骤：步骤5.1更新k时刻第t次变分迭代的状态和协方差：其中，雅可比观测矩阵表示为：θ为协同车相对于主车坐标系的航向角；步骤5.2更新k时刻第t次变分循环内超参数：其中，分别是更新后的先验分布超参数。6.根据权利要求4所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，协同车通过V2V通信技术将自车状态以及协同车所感知的目标车状态观测数据发送给主车。7.根据权利要求4所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，所述步骤2中对主车收集到的目标车状态观测数据以及协同车发送的目标车状态观测数据进行时间同步和坐标转换处理的方法为：时间同步：将主车以及协同车所采集的目标车状态观测数据的采集时间点分别与融合中心调用的时间点对齐；利用调用时间与传感器信息接收时间的时间差进行目标状态线性插值；分别获得主车对目标车的观测位置主车对协同车的观测位置和协同车对目标车的观测位置8.根据权利要求7所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，坐标转换：基于协同车相对于主车坐标系的航向角θk，协同车对目标车的观测位置涉及到的坐标转换，表示为：其中，分别表示在主车坐标系下，目标车和协同车的真实位置。9.根据权利要求1所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，两次迭代状态的相对变化量ε表示为：其中，分别为状态一步预测和上一时刻更新后的目标状态，||*||2表示向量的L2范数。10.根据权利要求1所述的一种抗观测数据干扰的多车协同状态估计方法，其特征在于，两次迭代状态的相对变化量的阈值取G＝5×10-6。
说明书desc
技术领域本发明属于智能车辆技术领域，涉及车联网的多车协同目标车跟踪方法，尤其是一种抗观测数据干扰的多车协同目标车跟踪方法。背景技术周边车辆运动状态的准确估计是汽车辅助驾驶系统研究领域的关键技术之一，其关键在于如何有效地从观测数据中过滤噪声以提取目标车的真实运动状态。随着传感器技术与通信技术的发展，多传感器被引进到辅助驾驶系统中进行环境感知。多源信息融合技术不仅能够解决不同传感器所获得的信息融合问题，还能改善状态估计性能。目前，主要利用GPS/导航、摄像头和雷达等多种传感设备来估计道路车辆的运动状态。非线性最优滤波被广泛应用于多源信息融合，可以由递推贝叶斯方法统一描述。核心思想是基于获得的观测值计算非线性系统状态向量的后验概率密度函数。对于线性系统来说，最优贝叶斯滤波的闭合解由卡尔曼滤波方程描述；对于非线性系统，由于需要处理复杂的积分问题，想要获得精准的最优滤波闭合解非常困难。随着车联网及通信技术的快速发展，基于车-车或车-基础设施通信的网联式协同感知引起广泛关注。我国主推的C-V2X成为全球范围内车联网行业的事实标准，其低延迟、高带宽等优点能够满足多车协同感知的可靠性要求。实际道路交通环境下，单车跟踪易受感知信息不完整、目标车遮挡以及环境噪声的影响，导致目标车状态估计的误差较大。发明内容为了解决传统目标跟踪只依赖单个车载传感器观测数据难以准确估计车辆状态的问题，本发明提出了一种抗观测数据干扰的多车协同状态估计方法。利用学生t分布对观测噪声建模，以缓解异常数据对目标状态估计的影响，并结合多车对同一目标车的观测数据，基于变分贝叶斯推断的方法，估计观测噪声参数和超参数，同时结合扩展卡尔曼滤波估计出目标车状态。为了实现上述技术问题，本发明所采用的技术方案如下：一种抗观测数据干扰的多车协同状态估计方法，包括如下步骤：步骤1：主车、协同车按照各自频率分别对目标车进行感知，继而分别获得含有噪声的目标车状态观测数据；同时，协同车将协同车的自车状态以及协同车所感知的目标车状态观测数据发送给主车；步骤2：主车作为信息融合中心，将主车收集到的目标车状态观测数据以及协同车发送的目标车状态观测数据进行时间同步和坐标转换处理，得到经过预处理后的组合观测数据；为抑制异常噪声对观测数据的影响，基于学生t分布模拟重尾、非高斯的观测噪声；步骤3：在k＝0时刻，初始化状态变量表示x0服从均值m0和协方差P0的高斯分布；初始化观测噪声协方差-1的先验超参数其中，u0，Λ0分别为初始自举变量值、初始精确度值，均为初始先验超参数；步骤4：利用扩展卡尔曼滤波器，预测k时刻的目标车状态分布表示xk|k-1服从均值协方差的高斯分布；预测k时刻观测噪声协方差-1的先验超参数和步骤5：变分内循环：利用变分贝叶斯推断理论，计算第t次迭代后的目标后验状态，经过变分推断的均值和协方差为和计算第t次迭代后的观测噪声参数的后验分布，经过变分推断得到精确度、自举变量和自由度分别为和并计算期望＜-1＞t；步骤6：判断目标车状态是否收敛，如果收敛则进行下一步骤，否则，令迭代次数t←t+1,返回步骤5继续迭代，直至收敛；收敛的判断标准为：如果两次迭代状态的相对变化量ε小于阈值G，则终止迭代；步骤7：输出每个时刻估计的目标车状态步骤8：选择是否继续跟踪，是则返回步骤1继续跟踪，否则结束跟踪；跟踪结束后，输出本次跟踪位置和速度的均方根误差图。进一步，所述步骤2中基于学生t分布模拟重尾、非高斯的观测噪声的方法为：S1、分别构造主车对协同车和目标车的观测方程和协同车对目标车的观测方程S2、通过组合主车对协同车和目标车的观测结果和协同车对目标车的观测结果得到增广观测向量进而获得增广观测噪声和增广观测噪声H、Jhk分别是主车传感器的观测矩阵和协同车传感器的雅可比观测矩阵，分别是主车传感器的观测噪声和协同车传感器的观测噪声；S3、以学生t分布模拟观测噪声vk，概率密度函数表示为：其中，S表示学生t分布，d为状态变量维度，v为d维随机向量，且服从学生t分布，μ为均值，Λ为精确度，λ为自由度；将学生t分布看作多个高斯分布的组合，表示为：其中，表示高斯分布，Gamma表示伽马分布，u为自举变量；最终协同跟踪的增广观测模型可以表示为：协同跟踪的增广观测噪声可以表示为：vk～S；其中，μk，Λk，λk分别为k时刻的均值，k时刻的精确度和k时刻的自由度；进一步，步骤4中计算均值和协方差的方法为：设置多车协同状态方程xk＝Fxk-1+wk和具体相关参数，F是状态转移矩阵，wk是过程噪声，xk是系统状态向量；基于多车协同状态方程得预测状态和协方差，表示为：其中，mk-1分别为状态一步预测和上一时刻更新后的目标状态，Pk-1分别为协方差矩阵一步预测和上一时刻更新后的协方差矩阵；Q是过程噪声协方差。进一步，步骤4中计算先验超参数和的方法为：引入调节因子ρ∈反映噪声统计特性的波动特性，设置观测噪声协方差分布超参数的先验分布为：其中，和均为上一时刻更新后的先验参数。进一步，所述步骤5包括如下步骤：步骤5.1更新k时刻第t次变分迭代的状态和协方差：其中，雅可比观测矩阵表示为：θ为协同车相对于主车坐标系的航向角；步骤5.2更新k时刻第t次变分循环内超参数：其中，分别是更新后的先验分布超参数。进一步，协同车通过V2V通信技术将自车状态以及协同车所感知的目标车状态观测数据发送给主车。进一步，所述步骤2中对主车收集到的目标车状态观测数据以及协同车发送的目标车状态观测数据进行时间同步和坐标转换处理的方法为：时间同步：将主车以及协同车所采集的目标车状态观测数据的采集时间点分别与融合中心调用的时间点对齐；利用调用时间与传感器信息接收时间的时间差进行目标状态线性插值；分别获得主车对目标车的观测位置主车对协同车的观测位置和协同车对目标车的观测位置进一步，坐标转换：基于协同车相对于主车坐标系的航向角θk，协同车对目标车的观测位置涉及到的坐标转换，表示为：其中，分别表示在主车坐标系下，目标车和协同车的真实位置。进一步，两次迭代状态的相对变化量ε表示为：其中，mk-1分别为状态一步预测和上一时刻更新后的目标状态，||*||2表示向量的L2范数。进一步，两次迭代状态的相对变化量的阈值取G＝5×10-6。本发明的有益效果：本发明所提出一种抗观测噪声干扰的多车协同目标车状态估计方法，利用主车和协同车同时对目标车进行观测，协同车利用V2V通信技术将自车状态以及对目标车的观测数据发送给主车，主车作为信息融合中心将接收的数据与局部感知数据进行融合，以提高目标车运动状态的估计性能，具有重要的应用前景。本方法考虑到真实驾驶场景的非线性、非高斯和高度不确定性，为克服单个车载传感器感知信息不准确，造成的目标车状态估计误差较大的问题，本发明提出多车协同状态估计方法，通过融入更多观测信息，可以有效提高目标车状态估计的精度。附图说明图1为本发明的流程图；图2为本发明模型的层次贝叶斯结构示意图；图3中，3a为本发明场景图和位置、3b速度的均方根误差图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅用于解释本发明，并不用于限定本发明。如图1所示本申请公开了一种抗观测数据干扰的多车协同状态估计方法，包括如下步骤：步骤1：主车、协同车按照各自频率分别对目标车进行感知，继而分别获得含有噪声的目标车状态观测数据；同时，协同车通过V2V通信技术将协同车的自车状态以及协同车所感知的目标车状态观测数据发送给主车。步骤2：主车作为信息融合中心，将主车收集到的目标车状态观测数据以及协同车发送的目标车状态观测数据进行时间同步和坐标转换处理，得到经过预处理后的组合观测数据。为抑制异常噪声对观测数据的影响，基于学生t分布模拟重尾、非高斯的观测噪声。具体实施步骤如下：步骤2.1：时间同步：由于主车和协同车车载传感器采集信息频率不一致，导致时间不同步，且V2V通信可能会存在延迟，所以需要对多源观测数据实现时间同步。将多传感器的目标车状态观测数据采集时间点与融合中心调用的时间点对齐。利用调用时间与传感器信息接收时间的时间差进行目标状态线性插值。线性插值是针对一维数据的插值方法，根据一维数据序列中需要插值的点的左右临近两个数据来进行数值估计。以主车车载传感器观测数据为例，平台调用时刻k，其左右临近时刻的数据为分别表示车载传感器设备在时刻k0、k1采集到的在x，y方向上的目标车观测位置。插值公式如下：其中，表示经过插值处理后，在平台调用时刻k，主车对目标车的观测位置。协同车通过V2V向主车传递的观测数据的处理同上，即可获得在平台调用时刻k，主车对协同车的观测位置和协同车对目标车的观测位置步骤2.2：坐标转换：经过时间配准后，由于是基于协同车自车坐标系下，对目标车的观测，与融合中心的坐标系不一致，因此协同车对目标车的观测位置涉及到坐标转换，表述如下：其中，θk表示协同车相对于主车坐标系的航向角，分别表示在主车坐标系下，目标车和协同车的真实位置。步骤2.3：基于上述思想，建立对应的非线性、动态的离散系统。该系统包含两个方程：状态方程和观测方程。多车协同状态方程：xk＝Fxk-1+wk其中，为状态转移矩阵，为系统噪声，服从均值为零、协方差为Q的高斯分布，为系统状态向量。本实施例中，n＝10，为协同车在主车坐标系下的运动状态，分别为位置和速度在x，y方向上的分量；为目标车在主车坐标系下的运动状态，分别为位置和速度在x，y方向上的分量；表示协同车相对于主车坐标系的航向角和角速度，两者线性关系为θk＝θk-1+ωkT，T为传感器的采样时间间隔。主车对协同车和目标车的观测方程：其中，为主车传感器在时间k对协同车和目标车的观测值，H为观测矩阵，为主车传感器的观测噪声。协同车对目标车的观测方程：其中，为协同车传感器在时间k对目标车的观测值，为观测函数，为协同车传感器的观测噪声。由于是非线性观测系统，使用一阶泰勒公式展开式对非线性观测函数进行线性化处理，求偏导得到雅可比观测矩阵Jhk。通过组合上述观测结果，可得增广观测向量同理，可得增广观测噪声增广观测噪声如图2以学生t分布模拟观测噪声vk，使用变分贝叶斯框架和扩展卡尔曼滤波算法解决状态估计问题。相较于高斯分布，学生t分布具有重尾、非高斯的特性，对异常值的抗干扰能力较强，其概率密度函数为：其中，S表示学生t分布，d为状态变量维度，v为d维随机向量，且服从学生t分布，μ为均值，Λ为精确度，λ为自由度。学生t分布尾的厚度由λ决定。λ→∞时，收敛到高斯分布。由于学生t分布的最大似然估计很难得到闭式解，通常将学生t分布看作多个高斯分布的组合：其中，表示高斯分布，Gamma表示伽马分布，u为自举变量。最终协同跟踪的增广观测模型可以表示为：协同跟踪的增广观测噪声可以表示为：vk～S其中，μk，Λk，λk分别为k时刻的均值，精确度和自由度本实施例中，其中,和分别表示协同车在主车坐标系下的位置、主车对目标车的观测位置和协同车对目标车的观测位置。使用学生t分布来模拟重尾、非高斯的测量噪声分布，则模型中未知参数的似然函数可表示为：根据公式，引入自举变量u，公式可以拆分为：其中，学生t分布中精确度、自由度两参数分别服从不同超参数的伽马先验分布：其中d表示传感器的观测维度，为模型超参数。步骤3：在k＝0时刻，初始化状态变量表示x0服从均值m0，协方差P0的高斯分布；初始化观测噪声协方差-1的先验超参数本实施例中，m0＝T，P0＝diag；d＝6，超参数分别为步骤4：时间外循环：利用扩展卡尔曼滤波器，预测k时刻的目标车状态分布表示xk|k-1服从均值协方差的高斯分布；预测k时刻观测噪声协方差-1的先验超参数和实验仿真分析，设置多目标场景系统状态方程和相关参数。具体步骤如下：状态方程xk＝Fxk-1+wk：其中，在本实施例中，T＝0.1s。过程噪声其中U1＝10-4×I8×8，U2＝10-4×I2×2，所以Q2＝L2×U2×L2T，符号表示克罗内克积。观测方程雅可比观测矩阵Jhk：其中，根据公式，可得预测状态和协方差。其中，mk-1分别为状态一步预测和上一时刻更新后的目标状态，Pk-1分别为协方差矩阵一步预测和上一时刻更新后的协方差矩阵。考虑未知观测噪声参数时变性，引入调节因子ρ∈反映噪声统计特性的波动特性。ρ越趋近于0表示噪声的不稳定性越明显，在本实例中ρ＝0.9。设置观测噪声协方差分布超参数的先验分布为：步骤5：变分内循环：利用变分贝叶斯推断理论，计算第t次迭代后的目标后验状态，经过变分推断的均值和协方差为和计算第t次迭代后的观测噪声参数的后验分布，经过变分推断得到精确度、自举变量和自由度为和并计算期望＜-1＞t。变分贝叶斯推断理论具体步骤如下：贝叶斯框架下，由观测数据推理隐变量的后验分布公式为：其中，未知参数为Φk＝{xk，uk，Λk，λk}。因为超参数Δk是Λk，λk的先验，于是后验分布可被改写为：采用变分推断思想，利用变分分布q近似复杂的后验p。为简单计算，将边缘似然函数先对数化：等式两边以分布q求取期望得到下式：其中，KL散度是一种量化两种概率分布q和p之间差异的方式。因为KL散度非负，当KL散度达到最小值0时，q等于真实后验分布p，自由能量F)达到最大值。假设q＝q＝qqqq其中，噪声参数分布先验为：每一个状态参数彼此独立。对F)进行求导，并且令导数为零，得到通解为：其中，符号表示联合概率密度关于除了之外的所有参数期望。模型的联合概率分布为：依据扩展卡尔曼滤波，更新k时刻第t次变分迭代的状态和协方差：根据公式，参数Λk的后验分布为：结合公式，更新k时刻第t次变分循环内超参数：所以，根据公式，参数uk的后验分布为：结合公式，更新k时刻第t次变分循环内超参数：所以，根据公式，参数λk的后验分布为：结合公式，更新k时刻第t次变分循环内超参数：所以，步骤6：判断目标车状态是否收敛，如果收敛则进行下一步骤，否则，令t←t+1,返回步骤5继续迭代，直至收敛。收敛的判断标准为：如果两次迭代状态的相对变化量ε小于阈值G，则终止迭代。其中，||*||2表示向量的L2范数，本实施例中，G＝5×10-6。步骤7：输出每个时刻估计的目标车状态步骤8：选择是否继续跟踪，是则返回步骤1继续跟踪，否则结束跟踪。跟踪结束后，输出本次跟踪位置和速度的均方根误差图，如图3a和3b所示。以上实施例仅用于说明本发明的设计思想和特点，其目的在于使本领域内的技术人员能够了解本发明的内容并据以实施，本发明的保护范围不限于上述实施例。所以，凡依据本发明所揭示的原理、设计思路所作的等同变化或修饰，均在本发明的保护范围之内。
