标题title
一种供水管网漏损检测方法及系统
摘要abst
本发明提供一种供水管网漏损检测方法及系统，该方法包括：获取供水管网中压力传感器位置，采集一段时间的供水压力数据；建立双向长短记忆网络模型，并对双向长短记忆网络进行训练；计算每个监测点与所有压力监测点的通道距离得到距离矩阵，进行取负和归一化处理得到距离权重矩阵；基于长短记忆网络得到监测点的压力预测值，计算每个监测点的真实值和预测值的残差，得到残差矩阵，对残差矩阵归一化，构造基于距离权重的误差矩阵；通过箱线图方式查找异常点，基于预先设定的漏损判定时间阈值和异常监测点个数阈值，对供水管网进行漏损判断。通过该方案可以实现供水管网压力状态的实时监控，提高漏损检测判断准确率和及时性。
权利要求书clms
1.一种供水管网漏损检测方法，其特征在于，包括：获取供水管网中压力传感器的布设位置，采集一定时间段内所有压力传感器的供水压力数据；根据供水管网中所有压力监测点的压力时序数据建立双向长短记忆网络模型，基于所述供水压力数据对双向长短记忆网络进行训练；计算每个压力监测点与所有压力监测点的通道距离得到距离矩阵，进行取负和归一化处理得到距离权重矩阵；将采集得到的压力数据输入到训练好的长短记忆网络模型中，得到监测点对应的压力预测值，计算每个监测点的真实值和模型压力预测值的残差，得到残差矩阵，对残差矩阵归一化，构造基于距离权重的误差矩阵；根据每个监测点的基于距离权重的误差序列，通过箱线图方式查找异常点；基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对供水管网进行漏损判断。2.根据权利要求1所述的方法，其特征在于，所述采集一定时间段内所有压力传感器的供水压力数据还包括：根据供水压力数据采集时间的先后，将预定比例的时间靠前的供水压力数据作为训练样本，将时间靠后的剩余供水压力数据作为验证样本和测试样本。3.根据权利要求1所述的方法，其特征在于，所述双向长短记忆网络模型中包括输入层、时序特征抽取层和输出层，将长短记忆网络作为细胞核，将输入的时间序列在时间维度上的变化趋势以隐藏状态不断进行传递和更新，并将时序供水压力数据的历史特征保存至记忆单元，保存前向和后向的预测信息，最后连接三层全连接层作为输出层。4.根据权利要求1所述的方法，其特征在于，所述基于距离权重的误差矩阵为距离权重矩阵和归一化后残差矩阵的乘积。5.根据权利要求1所述的方法，其特征在于，所述基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对采集的压力监测数据进行漏损判断包括：对压力异常监测点数据进行统计，当异常供水压力数据持续时间大于漏损判定时间阈值，且异常供水压力监测点个数大于监测点个数阈值，则判定为漏损事件，并进行预警提示。6.一种供水管网漏损检测系统，其特征在于，包括：采集模块，用于获取供水管网中压力传感器的布设位置，采集一定时间段内所有压力传感器的供水压力数据；模型训练模块，用于根据供水管网中所有压力监测点的压力时序数据建立双向长短记忆网络模型，基于所述供水压力数据对双向长短记忆网络进行训练；第一计算模块，用于计算每个压力监测点与所有压力监测点的通道距离得到距离矩阵，进行取负和归一化处理得到距离权重矩阵；第二计算模块，用于将采集得到的压力数据输入到训练好的长短记忆网络模型中，得到监测点对应的压力预测值，计算每个监测点的真实值和模型压力预测值的残差，得到残差矩阵，对残差矩阵归一化，构造基于距离权重的误差矩阵；异常点查找模块，用于根据每个监测点的基于距离权重的误差序列，通过箱线图方式查找异常点；漏损判断模块，用于基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对供水管网进行漏损判断。7.根据权利要求6所述的系统，其特征在于，所述采集模块还包括：数据划分模块，用于根据供水压力数据采集时间的先后，将预定比例的时间靠前的供水压力数据作为训练样本，将时间靠后的剩余供水压力数据作为验证样本和测试样本。8.根据权利要求6所述的系统，其特征在于，所述基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对供水管网进行漏损判断包括：对压力异常监测点数据进行统计，当异常供水压力数据持续时间大于漏损判定时间阈值，且异常供水压力监测点个数大于监测点个数阈值，则判定为漏损事件，并进行预警提示。9.一种电子设备，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1至5中任一项所述供水管网漏损检测方法的步骤。10.一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1至5任一项所述供水管网漏损检测方法的步骤。
说明书desc
技术领域本发明涉及城镇供水管网领域，尤其涉及一种供水管网漏损检测方法及系统。背景技术对于城镇供水管网，常会因为管道老化、腐蚀等导致管网漏损现象的发生，这不仅对人们的生产生活造成严重影响，还会造成大量的水资源浪费和水质污染等次生灾害。因此，对于管网的实时监测和漏损的及时发现具有十分重要的现实意义。对于漏损管控，通过监测夜间最小流量，并根据区域内夜间最小流量的变化来判定漏损发生，该方法检测效率低、检测周期长。另外，可通过对流量进行监测和分析判断漏损的发生，但是常规的基于流量异常的漏损判定方法容易出现漏损错误判定的情况，而目前已公开的基于循环神经网络的区域管网漏损检测方法中，通过对区域流量监测，并结合循环神经网络预测耗水量，从而根据真实耗水量与预测耗水量的差距判定是否漏损，然而该方法根据流量变化判定漏损，实际中仍难以消除用户异常用水量影响，其漏损判断准确率仍不高。发明内容有鉴于此，本发明实施例提供了一种供水管网漏损检测方法及系统，以解决现有漏损判断准确率不高、漏损发现不及时的问题。在本发明实施例的第一方面，提供了一种供水管网漏损检测方法，包括：获取供水管网中压力传感器的布设位置，采集一定时间段内所有压力传感器的供水压力数据；根据供水管网中所有压力监测点的压力时序数据建立双向长短记忆网络模型，基于所述供水压力数据对双向长短记忆网络进行训练；计算每个压力监测点与所有压力监测点的通道距离得到距离矩阵，进行取负和归一化处理得到距离权重矩阵；将采集得到的压力数据输入到训练好的长短记忆网络模型中，得到监测点对应的压力预测值，计算每个监测点的真实值和模型压力预测值的残差，得到残差矩阵，对残差矩阵归一化，构造基于距离权重的误差矩阵；根据每个监测点的基于距离权重的误差序列，通过箱线图方式查找异常点；基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对供水管网进行漏损判断。在本发明实施例的第二方面，提供了一种供水管网漏损检测系统，包括：采集模块，用于获取供水管网中压力传感器的布设位置，采集一定时间段内所有压力传感器的供水压力数据；模型训练模块，用于根据供水管网中所有压力监测点的压力时序数据建立双向长短记忆网络模型，基于所述供水压力数据对双向长短记忆网络进行训练；第一计算模块，用于计算每个压力监测点与所有压力监测点的通道距离得到距离矩阵，进行取负和归一化处理得到距离权重矩阵；第二计算模块，用于将采集得到的压力数据输入到训练好的长短记忆网络模型中，得到监测点对应的压力预测值，计算每个监测点的真实值和模型压力预测值的残差，得到残差矩阵，对残差矩阵归一化，构造基于距离权重的误差矩阵；异常点查找模块，用于根据每个监测点的基于距离权重的误差序列，通过箱线图方式查找异常点；漏损判断模块，用于基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对供水管网进行漏损判断。在本发明实施例的第三方面，提供了一种电子设备，包括存储器、处理器以及存储在所述存储器中并可在所述处理器运行的计算机程序，所述处理器执行所述计算机程序时实现如本发明实施例第一方面所述方法的步骤。在本发明实施例的第四方面，提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现本发明实施例第一方面提供的所述方法的步骤。本发明实施例中，基于压力传感器采集的压力数据，通过双向长短记忆网络预测压力数据，并计算与真实数据的残差矩阵，并构造基于距离权重的误差矩阵，通过箱线图确定异常点，根据异常持续时间和异常点个数判断漏损事件，从而可以显著提高漏损判断准确率，实现对水管压力状态实时监测，提升漏损检测效率和现势性。同时，在漏损发生时，可以根据压力异常传感器位置对漏损点进行快速定位，方便水管检修。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单介绍，显而易见地，下面描述的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获取其他附图。图1为本发明的一个实施例提供的一种供水管网漏损检测方法的流程示意图；图2为本发明的一个实施例提供的基于箱线图确定异常点的示意图；图3为本发明的一个实施例提供的双向长短记忆网络的结构示意图；图4为本发明的一个实施例提供的一种供水管网漏损检测系统的结构示意图。具体实施方式为使得本发明的发明目的、特征、优点能够更加的明显和易懂，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，下面所描述的实施例仅仅是本发明一部分实施例，而非全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围以下结合附图对本发明的原理和特征进行描述，所举实例只用于解释本发明，并非用于限定本发明的范围。本发明的说明书或权利要求书及上述附图中的术语“包括”以及其他相近意思表述，意指覆盖不排他的包含，如包含一系列步骤或单元的过程、方法或系统、设备没有限定于已列出的步骤或单元。请参阅图1，图1为本发明实施例提供的一种供水管网漏损检测方法的流程示意图，包括：S101、获取供水管网中压力传感器的布设位置，采集一定时间段内所有压力传感器的供水压力数据；所述压力传感器安装于供水管上，用于检测水管内侧水流对管壁的压力。所述压力传感器为具有无线通信功能的传感器，可以将采集的压力数据发送至对应的终端设备。可选的，所述压力传感器还具有自动休眠和自动唤醒功能，可以定时对水管压力数据进行监测，将监测数据发送出去后，进入休眠状态，还可以根据终端设备发送的指令，唤醒进行数据监测。采集一段时间内供水压力数据，检查数据完整性，对缺失的压力数据进行填充，得到所有监测完整的压力数据。其中，根据供水压力数据采集时间的先后，将预定比例的时间靠前的供水压力数据作为训练样本，将时间靠后的剩余供水压力数据作为验证样本和测试样本。示例性的，将压力数据根据时间先后进行划分，前70％的压力监测数据作为训练样本Ptrain，后10％和20％的压力监测数据作为验证样本Pvalidation和测试样本Ptest。S102、根据供水管网中所有压力监测点的压力时序数据建立双向长短记忆网络模型，基于所述供水压力数据对双向长短记忆网络进行训练；所述双向长短记忆网络是一种时间循环神经网络，可以解决一般循环神经网络存在的长期依赖问题，其由前向和后向的长短记忆网络组成，能够基于记忆的数据信息进行预测。其中，双向长短记忆网络时间序列模型中包括输入层、时序特征抽取层和输出层，将长短记忆网络作为细胞核，将输入的时间序列在时间维度上的变化趋势以隐藏状态不断进行传递和更新，并将时序供水压力数据的历史特征保存至记忆单元，保存前向和后向的预测消息，最后连接三层全连接层作为输出层。将采集的供水压力数据划分为训练集、验证集和测试集，通过训练集和验证集对网络模型进行训练、调参，直至双向长短记忆网络模型达到收敛，最后利用测试集对训练好的模型进行测试其模型效果。S103、计算每个压力监测点与所有压力监测点的通道距离得到距离矩阵，进行取负和归一化处理得到距离权重矩阵；所述距离矩阵Dn×n可以表示为：对距离矩阵的每个元素去重后，进行取负和归一化得到距离权重矩阵，所述距离权重矩阵Wn×n表示为：其中，dik表示压力监测点i与压力监测点k之间的通道距离，dii＝0，i、k＝1，2，…，n，n表示供水管网所有监测点数量。S104、将采集得到的压力数据输入到训练好的长短记忆网络模型中，得到监测点对应的压力预测值，计算每个监测点的真实值和模型压力预测值的残差，得到残差矩阵，对残差矩阵归一化，构造基于距离权重的误差矩阵；计算每个监测点的真实值和模型预测值的残差，得到0－t时刻的残差矩阵：对残差矩阵进行归一化操作，得到归一化计算公式为：构造基于距离权重的误差矩阵：当发生漏损事件时，邻近的关联压力监测点都可以监测到异常，通过所述基于距离权重的误差矩阵，可以根据邻近监测点对漏损进行判定，消除无关监测点的影响，提升漏损判定的准确性。同时能方便漏损位置的确定。S105、根据每个监测点的基于距离权重的误差序列，通过箱线图方式查找异常点；所述箱线图可以显示数据的离散分布情况，并能直观识别数据中的异常值，通过箱线图可以快速发现监测点数据中的异常值，以便根据异常点进行漏损判断。具体的，如图2所示，Q1表示第一四分位数，M表示中位数，Q3表示第三四分位数，IQR表示四分位距，上线和下限分别设置为距离Q1和Q3均为1.5倍四分位距，超过上下限的数据视为异常值，利用该方法检测基于距离权重的误差矩阵，得到所有的压力异常点。S106、基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对供水管网进行漏损判断。预先设定漏损判定时间阈值T和压力异常监测点个数阈值P，采集各监测点的供水压力数据，对压力异常监测点数据进行统计，当异常供水压力数据持续时间大于漏损判定时间阈值T，且异常供水压力监测点个数大于监测点个数阈值P，则判定为漏损事件，并进行预警提示，否则，判定为计量异常事件或人为操作。结合异常持续时间和异常点个数的判定，可以大大提升漏损判断准确度。同时，基于预测模型的持续学习，异常点判断准确度的提高，阈值可以动态调整，进一步保障漏损判定的准确性。需要说明的是，在LSTM网络模型中，模型学习过程包括：计算遗忘门，对上一节点输入进行选择性遗忘：ft＝σ；ft，Wf，bf分别为遗忘门的输出、权重和偏置项，ht-1和xt分别为前一时刻的隐层状态和当前时刻的输入。计算输入门，对输入值有选择地进行记忆：it＝σ；it表示输入门的输出，Wi，bi分别为输入门的权重和偏置项。用tanh激活函数进行缩放，产生临时细胞状态C％t：C％t＝tanh；WC，bC分别为临时细胞状态的权重和偏置项。计算当前时刻细胞状态Ct：Ct＝ft*Ct-1+it*C％t；计算输出门，利用sigmoid函数激活xt，得到时间特征序列：ot＝σ；xt为当前时刻输入，ot，Wo，bo分别为输出门的输出、权重和偏置项。计算当前时刻输出：ht＝ot*tanh。如图3所示，该双向长短记忆网络包括：输入层：X0，X1，…，Xt为网络的输入序列，这里表示n个监测点、0－t时刻的压力矩阵。BiLSTM层：包括两个正向和反向的LSTM网络，分别按照序列的正向演进方向和反向演进方向进行递归训练。输出层：Yt+1为网络的输出，这里表示n个监测点的第t+1时刻的压力预测值。本实施例提供的方法，可以解决传统方法中存在漏损发现不及时、漏损判断准确性不高等问题，基于供水管的压力异常监测，可以实现供水管网压力状态的实时监控，提高漏损判断准确性，保证漏损发现的现势性，并方便准确确认漏损发生位置。应理解，上述实施例中各步骤的序号大小并不意味着执行顺序的先后，各过程的执行顺序应以其功能和内在逻辑确定，而不应对本发明实施例的实施过程构成任何限定。图4为本发明实施例提供的一种供水管网漏损检测系统的结构示意图，该系统包括：采集模块410，用于获取供水管网中压力传感器的布设位置，采集一定时间段内所有压力传感器的供水压力数据；可选的，所述采集模块410还包括：数据划分模块，用于根据供水压力数据采集时间的先后，将预定比例的时间靠前的供水压力数据作为训练样本，将时间靠后的剩余供水压力数据作为验证样本和测试样本。模型训练模块420，用于根据供水管网中所有压力监测点的压力时序数据建立双向长短记忆网络模型，基于所述供水压力数据对双向长短记忆网络进行训练；其中，所述双向长短记忆网络模型中包括输入层、时序特征抽取层和输出层，将长短记忆网络作为细胞核，将输入的时间序列在时间维度上的变化趋势以隐藏状态不断进行传递和更新，并将时序供水压力数据的历史特征保存至记忆单元，保存前向和后向的预测消息，最后连接三层全连接层作为输出层。第一计算模块430，用于计算每个压力监测点与所有压力监测点的通道距离得到距离矩阵，进行取负和归一化处理得到距离权重矩阵；第二计算模块440，用于将采集得到的压力数据输入到训练好的长短记忆网络模型中，得到监测点对应的压力预测值，计算每个监测点的真实值和模型压力预测值的残差，得到残差矩阵，对残差矩阵归一化，构造基于距离权重的误差矩阵；其中，所述基于距离权重的误差矩阵为距离权重矩阵和归一化后残差矩阵的乘积。异常点查找模块450，用于根据每个监测点的基于距离权重的误差序列，通过箱线图方式查找异常点；漏损判断模块460，用于基于预先设定的漏损判定时间阈值和压力异常监测点个数阈值，对采集的压力监测数据进行漏损判断。具体的，对压力异常监测点数据进行统计，当异常供水压力数据持续时间大于漏损判定时间阈值，且异常供水压力监测点个数大于监测点个数阈值，则判定为漏损事件，并进行预警提示。可以理解的是，在一个实施例中，所述电子设备包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现步骤S101至S106以实现供水管网漏损检测判断。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分步骤是可以通过程序来指令相关的硬件来完成，所述的程序可以存储于一计算机可读取存储介质中，该程序在执行时，包括步骤S101至S106，所述的存储介质包括如：ROM/RAM、磁碟、光盘等。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述或记载的部分，可以参见其它实施例的相关描述。以上所述，以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
