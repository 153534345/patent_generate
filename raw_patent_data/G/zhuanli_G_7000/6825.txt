标题title
分数阶虚拟惯量预测控制电池测试直流微网电压稳定方法
摘要abst
分数阶虚拟惯量预测控制电池测试直流微网电压稳定方法。本发明为了克服由动力电池测试系统构成的直流微电网情况下的电池充放电导致直流母线电压波动问题，采用分数阶模型预测虚拟惯性控制策略的双向变换器，使得电网能够为直流微网提供惯性支持，抑制直流母线电压波动。FO‑MPC‑VIC控制中包含了分数阶虚拟惯性控制和分数阶模型预测控制器，其中FO‑VIC为系统提供惯性支持，它是将虚拟惯性控制中一阶惯性环节用分数阶惯性环节替换，相比于传统VIC的一阶惯性环节，分数阶系统不仅在伯德图5中有更大的稳定裕度，提高了系统的稳定性；而且提供了额外的分数阶阶次的自由度，可以通过调节分数阶阶次来满足不同情况的工作需求。FO‑MPC通过建立分数阶模型预测控制器，提高FO‑VIC的动态响应，在瞬态提供虚拟参考电流增量，然后叠加到FO‑VIC的参考电流指令值中，进一步提高直流母线电压的动态性能。
权利要求书clms
1.基于电池测试系统的直流微电网电压稳定控制的分数阶模型预测虚拟惯性控制方法。其特征在于，所述方法包括：由动力电池测试系统构成的直流微网，由于直流电容容量有限，呈现低惯性，蓄电池的充放电测试容易引起直流母线电压波动，危及系统的稳定性。为了提高系统的惯性，同时获得良好稳定性，提出一种分数阶模型预测的虚拟惯性控制策略；首先，为获得足够的惯性支持，采用虚拟电容来增加惯性，模拟同步发电机特性，提出虚拟惯性控制；然后用分数阶虚拟惯性环节代替传统一阶惯性环节，大大提高了系统的稳定性；通过分数阶模型预测控制器，提出虚拟直流电流补偿方法，实现在直流母线电压波动的情况下实时改变虚拟惯性控制中的虚拟参考电流，进一步增大系统惯性，达到抑制直流母线电压波动的目的。2.根据权利要求1所述的方法，其特征在于，电池测试直流微网系统电压波动调节能力提高的FO-MPC-VIC方法包括：采用分数阶的虚拟惯性控制作为最基本的控制策略。在直流母线电压波动情况下，直流电容能够提供的惯性有限，引入虚拟电容，推导出虚拟电容的虚拟惯性控制策略。有研究表明分数阶是描述复杂动力系统的重要工具。相比于分数阶VIC控制，一阶惯性环节的VIC控制具有较低的相位裕度和幅值裕度，较低的稳定性在干扰情况下不利于系统正常运行。分数阶VIC能够增强系统稳定性，同时增加了一个分数阶阶次的自由度，通过调节阶次满足系统不同情况下的工作需求。3.根据权利要求1所述的方法，其特征在于，分数阶模型预测控制器的调整过程：采用Grünwald-Letnikov的分数阶定义，在有限的历史步长内，建立了分数阶虚拟惯性方程的状态空间表达式，同时根据最小的直流母线电压波动和模型预测控制器的出力建立目标方程。当电压出现波动时，分数阶模型预测控制器通过计算出最优的补偿增量，叠加到虚拟参考电流上，实现实时改变虚拟电流参考指令值，进一步增大系统抑制电压波动的能力。
说明书desc
技术领域本发明属于由动力电池测试系统构成的微电网领域，具体涉及一种电池充放电测试双向DC-DC变换器和一种适用于L型双向DC-AC变换器的分数阶模型预测虚拟惯性控制方法。背景技术蓄电池组测试系统已被广泛用于评估动力电池组的性能和可靠性，在电动汽车中发挥着重要作用。然而，如果没有节能技术，大部分的测试能量将被浪费掉。为了避免不必要的能量浪费，提出了基于能量回收蓄电池测试系统的直流微网，如图1所示。它包括电池测试单元及其控制系统、双向并网变流器和通信总线。在提出的直流微电网中，电池的充放电测试可以通过双向DC-DC转换器来实现。BGCC用于从交流电网中回收或吸收能量，以便将直流母线电压保持在预定值内。与传统的基于蓄电池测试系统的交流微电网不同。所提出的直流微电网不需要每个测试单元都要一个DC-AC转换器，这大大减少了转换器数量，更节省了成本、提高了转换效率。在提出的电池测试直流微网中，直流母线电压用于评估系统稳定性。然而，电池的频繁充放电容易引起直流母线电压的功率波动，威胁系统的稳定性。因此，稳定直流微电网的直流母线电压尤为重要。与交流微电网类似，基于电力电子的直流微电网具有非常小的惯性。目前关于基于蓄电池测试系统的直流微电网稳定性的文献不多，其分析方法可参考交流微电网。作为最流行的功率波动平滑方法之一，惯性控制得到了广泛的应用，通常包括储能系统和应用虚拟惯性控制的功率变换器。由于ESS体积大、成本高，因此不能适用于电池测试微网领域，因此采用并网型电池测试微网系统是最优方案。发明内容本发明目的在于优化由蓄电池测试系统构成的直流微电网中的直流母线电压，提供一种根据微电网电压波动的瞬态来实时补偿VIC中的虚拟参考电流指令值，从而达到直流母线电压波动的抑制。为了实现上述的目的，本发明采用如下技术方案。图2为蓄电池测试系统的直流微电网简化框图，由多个电池测试单元、双向DC-DC变换器、直流母线电容、双向DC-AC并网变换器和L型滤波器组成。提出的基于蓄电池测试系统的直流微电网不需要额外的储能系统来提供惯性支持，其惯性支持来自VIC和交流电网。系统的稳定运行需要BGCC的支持。当DC-MG由于蓄电池充放电测试而出现功率波动时，BGCC可以通过虚拟惯性控制策略从电网吸收或释放功率，以保持直流母线电压稳定。外环控制采用虚拟惯性控制策略，内环为电流控制。虚拟惯性控制是通过引入虚拟电容器来模拟了同步发电机的P-f下垂控制，这里是电压和电流的I-U下垂；用虚拟电容模拟了同步发电机的惯性系数J，这里用Cvir表示；同时模拟同步发电机的阻尼特性，这里用电流阻尼系数kD表示。因此虚拟惯性控制可以表示为其中kd表示下垂系数，且u0表示额定电压，udc直流母线电压，i0表示直流母线电流，表示虚拟电压参考。图2中dq坐标系中双向变换器BGGC的数学模型可以表示为其中id和iq、ed和eq表示dq坐标系中的电感电流和端电压。ud和uq表dq坐标中的电网电压。电流内环的方程表示为其中G1＝kp1+ki1/s是内环中的PI电流控制器。和分别是id和iq的参考电流。忽略功率晶体管的功率损耗，可以获得BGCC输入和输出的功率平衡。为了推导出BGCC的小信号模型，将状态变量重写为具有小扰动的稳态变量之和，即i0＝I0+Δi0，ud＝Ud+Δud，udc＝Udc+Δudc。假设BGCC以单位功率因数运行，即iq＝0,uq＝0。进行式一到式四的小信号线性化，得到VIC的小信号模型为：基于上述的模型，得到如图3所示的VIC的小信号模型。同时根据图3求出Δudc到-Δi0的闭环传递函数Tc其中Gv＝1/andGc＝G2Ga)/+Ls+r)根据式六画出极点分布图，其结果展现在图4中。当Cvir从0到1不断变化时，一共有五个极点，其中三个偏离虚轴太远图中没有显示。可以看出，随着虚拟电容的增加，最右边的极点逐渐远离虚轴，这个变化的极点远离其他极点，且靠近虚轴，因此它是主导极点。这种情况下可以用一阶惯性环节来描述这个高阶系统，因此Tc可以近似为传统的一阶惯性环节相比于分数阶惯性环节有较低的相位裕度和幅值裕度，较低的稳定性不利于系统在频繁的干扰条件下运行；并且由于分数阶惯性环节中引入分数阶阶次的自由度，使得系统更加灵活。因此，为改善系统动态性能，提出分数阶描述惯性环节；式七可以表示为其中λ代表了分数阶阶次，图5展现了式八的分数阶系统伯德图，可以看到当λ＝1时为式七中的一阶惯性环节。当λ＜1时，分数阶对应的幅频特性曲线斜率小于一阶惯性环节，说明分数阶环节有更好的稳定性和响应速度，同时有更大的相位裕度。在直流微电网中，不同的λ最终反映在直流母线电压波动中。因此，为了选择合适的λ，进行了MATLAB/Simulink验证测试。假设初始状态定义为电流为0.16s时的放电测试，参数规格见表I和表II。在FO-VIC控制下选择不同的分数阶数，结果如图6所示。当λ＝0.6时，系统直流母线电压波动较小，并作为FO-VIC控制器的分数阶阶次。图7展示了本发明的总体控制策略，除了上述描述的VIC控制，图中还增加了分数阶的模型预测控制器。由于传统的VIC控制中虚拟参考电流恒定，当出现直流母线电压波动时无法调动储能系统的最大功率补偿能力，因此加入了分数阶模型预测控制，它可以根据直流母线电压和电流的变化，实时调节虚拟电流参考指令值，实现直流母线电压的动态优化。分数阶模型预测控制器的具体设计过程如下首先，式一可以被重写为式九可以被改写成离散的状态空间模型其中τ，根据Grünwald–Letnikov的分数阶定义式，Δnx的表达式为其中n表示推导顺序，n∈R,Ts是采样时间，k∈N是一个整数，j是计算推导得样本数，可以表示为式十一可以表示为Δ1u＝u-u式十三其中Δ1u表示u的一阶差分，因此u＝Δ1u+u式十四将式十三代入式十中可得原则上，这条推理可以推广到任何分数阶的差分，因此同样的式十六可以根据式十一推导为式十六和式十七两边同时乘Tsn可得根据式十八和十九可得令式二十可以写成化简式二十一，u可以推导为其中A0＝-c1I)，Aj＝-cj+1I，式二十二可以改写为矩阵形式其中为了消除积分项引入的静态误差，将式二十三转换为增量形式其中系统的一个预测模型可以表示为为了稳定直流母线电压，代价函数可以设计为其中λ1和λ2分别代表直流链路电压和直流链路电流变化的权重系数。Δu和分别表示k时刻的电压和直流链路电流误差。在式二十六中，第一项确保直流母线电压的快速恢复，而后一项用于最小化VIC的输出成本。直流母线电压的变化应限制在一定范围内。因此，优化问题可以描述为式二十七。代价函数可以重写为其中Γy和Γi表示电压和电流变化的权重系数，R是k+1时刻参考输出，且表示为为了便于解决式二十七中的优化问题，定义了辅助变量重写目标方程为把预测方程二十五代入到二十九中可得其中因此，优化问题式六可表示为求ρTρ的一阶导数并使其等于0，极值解为z*＝-1ATb式三十五因为对式三十四继续求导其结果大于0，所以式三十五是最小解。将式三十一代入式三十五，得到式二十七的解，即k时刻的最优序列为上述最优序列就是分数阶MPC控制器求解的结果，将式三十六代入到虚拟惯性控制中，实现对参考电流的实时调整，以增强直流母线电压波动抑制的能力。由于上述技术方案的运用，因此，本发明具有如下特点：1、本发明采用分数阶虚拟惯性控制，根据稳定性分析，相比传统的一阶惯性环节有更好的稳定裕度和快速调整性；2、本发明通过分数阶虚拟惯性方程，推导出分数阶模型预测的状态空间表达式，并通过目标方程转化为优化问题，最后求解。实现进一步增大控制策略对直流母线电压波动抑制的效果；3、本发明不需要额外的储能环节，通过对双向变换器实施FO-MPC-VIC控制，以及电网对直流母线的惯性支持，大大节省了成本。附图说明图1：本发明中基于电池测试系统的直流微网的配置；图2：本发明中的简化的直流微网的电路；图3：本发明中VIC控制的小信号模型；图4：本发明中的VIC控制的闭环传递函数的极点分布图；图5：本发明的分数阶等效传递函数的伯德图。图6：本发明中不同分数阶阶次作用下直流母线电压波动对比图。图7：本发明中总体控制框图。图8：本发明中加入的充电干扰电池各参数变化的结果。图9：本发明中加入充电电池测试干扰的各种控制方法对比图。图10：本发明中加入的放电干扰电池各参数变化结果。图11：本发明中加入放电电池测试干扰的各种控制方法对比图。图12：本发明中电网电压波动时的各种控制方法对比图。图13：本发明中加入直流母线负载干扰的各种控制方法对比图。具体实施方式以下将结合本发明的优选实例和附图对技术方案进行清楚、完整地描述。应当理解，优选实例仅仅为了说明本发明，而不是为了限制本发明的保护范围。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下，所获得的其它所有实施例，都属于本发明保护范围。本发明提供了一种适用于直流微电网的惯性增强方法，用来增强系统的稳定性，并抑制直流母线电压的波动。首先采用虚拟惯性控制策略，弥补由于直流电容惯性不足，其次通过引入分数阶虚拟惯性控制，进一步提高系统的稳定性。通过分数阶虚拟惯性方程推导出分数阶模型预测控制的状态空间表达式，根据设计的目标方程建立优化问题，这个优化问题的最优解就是分数阶模型预测控制的最优解，然后补偿到虚拟参考电流，进一步增大对直流母线电压波动的抑制。一种实施例的控制结构示意图如图7所示，本实施例的主要内容包括：采样的直流母线电压和电流同时送入分数阶虚拟惯性控制和分数阶模型预测控制器，分数阶虚拟惯性控制作为外环控制，内环采用电流控制。系统稳定情况下FO-MPC补偿电流为0，在直流母线电压波动情况下，FO-MPC开始计算最优的电流补偿增量，然后实时修改分数阶虚拟惯性控制的虚拟参考电流指令值，实现对直流母线电压波动的抑制。以一台采用图2控制方案的双向变换器为例，分析微电网的直流母线电压波动抑制效果。电池参数以特斯拉公司的Model-S 85动力电池信息为例。表I和表II分别显示了电池和FO-MPC-VIC控制器的参数规格。表1是动力电池的参数表2是FO-MPC-VIC控制的参数系统的运行实现过程如下：步骤S110：系统工作在稳定运行情况下，采样直流母线电压和电流，同时送入到虚拟惯性控制和FO-MPC中。步骤S120：一方面虚拟惯性控制根据采样进来的直流参数计算出虚拟参考电压uvir，另一方面，FO-MPC根据设定好的代价函数和初始变量，在电压波动情况下计算出最优的补偿虚拟电流Δidc。步骤S130：此时虚拟惯性控制的虚拟参考电流然后重新更新虚拟参考电压，最后经过电流闭环控制和PWM模块得到开关的驱动信号。然后重新采样直流母线的电压和电流，重复步骤S110。按照图7在MATLAB/Simulink中搭建仿真模块，按照上表1和表2设置控制器参数，对比在不同控制下的直流母线电压动态响应。其中VIC表示采用所提出的虚拟惯性控制，NO-VIC表示传统的双环控制，FO-MPC-VIC表示采用所提出的分数阶模型预测的虚拟惯性控制。初始状态设定为存在一个以50A恒流放电测试的电池，并且系统工作在稳定的情况下，下面的四个案例均在这个条件下进行。在这个初始状态下，通过加入充电电流干扰和放电电流干扰，以及交流电网波动情况和直流母线负载波动时候的各种方法的对比，其结果如下：在t＝0.16s时加入充电电流干扰测试，来模拟直流母线电压波动情况，其结果显示在图8和图9中。图8显示了干扰电池的充电过程曲线，可以看到电池SOC从50％逐渐增大，充电电流恒定在10A，端电压大约维持在383V。在图9中，由于直流母线上功率需求增大，电压瞬间下降。在没有虚拟惯性控制的NO-VIC中，电压跌落幅值较大，恢复过程中出现过冲，在加入虚拟惯性控制的VIC中，由于惯性支持，大大减小了电压的波动。当采用的FO-MPC控制时，VIC控制得到更多的虚拟参考电流补偿，因此进一步减小了直流母线电压的波动。放电电流干扰测试结果如图10、11所示，图10显示了电池放电过程的SOC，放电电流和端电压情况。在图11中，当t＝0.16s时进行电池放电测试，直流母线输入功率增加，直流母线电压瞬间增大。在没有惯性控制的NO-VIC中，仅通过直流母线电容来提供惯性支持是不够的，因此电压增加幅值过大。在随后加入的VIC控制和FO-MPC-VIC中，直流母线电压波动明显减小，而且可以看到，所提出的策略在直流母线电压波动抑制降到最低。直流母线电压在电网电压变化的情况下不同方法的对比。为了评估电网电压变化对系统的影响，电网电压在0.14s时增加了20％。图12表明，当电网电压变化时，直流母线电压也随之变化。虽然幅度变化很小，但电压波动在NO-VIC控制下约为5.5V，在VIC控制下约为3V，在FO-MPC-VIC控制下约为2.5V。所提出的方案最大限度地减少了直流母线电压波动。DC-MG上的负载切换也可能影响直流母线电压的稳定性。初始状态下，10KW阻性负载在0.14s时接入，0.2s时移除。图13显示了直流母线电压的波动。当负载增加时，所需的直流母线功率相应增加，直流母线电压瞬间下降，电网电流减小。当负载移除时，直流母线电压瞬间升高，电网电流增加。在比较图中的直流母线电压波动时，所提出的FO-MPC-VIC与NO-VIC相比减少了43.2％的电压波动，与传统VIC控制相比减少了26.2％。上述实施例只为说明本发明的技术构思及特点，其目的在于让熟悉此项技术的人能够了解本发明的内容并据以实施，并不能以此限制本发明的保护范围，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所展示的实施例，而是要符合于本文所公开的原理和新颖特点相一致的最宽的范围，凡根据本发明精神实质所作的等效变化或修饰，都应涵盖在本发明的保护范围之内。
