标题title
基于多分量Morlet小波的高频振荡相量测量方法及装置
摘要abst
本发明提供一种基于多分量Morlet小波的高频振荡相量测量方法及装置，其中方法包括：步骤一，采集电网电压电流信号并对所述电网电压电流信号进行采样；步骤二，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；步骤三，基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；步骤四，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤一重新采样电网电压电流信号。本发明实现了基波分量的有效抑制，从而大大提高了高频振荡相量测量的准确度。
权利要求书clms
1.一种基于多分量Morlet小波的高频振荡相量测量方法，其特征在于，包括：步骤一，采集电网电压电流信号并对所述电网电压电流信号进行采样；步骤二，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；步骤三，基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；步骤四，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤一重新采样电网电压电流信号。2.根据权利要求1所述的基于多分量Morlet小波的高频振荡相量测量方法，其特征在于，所述步骤四中基于所述高频振荡相量计算出待测量的高频振荡频率和幅值，包括：基于多分量Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率；基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度。3.根据权利要求2所述的基于多分量Morlet小波的高频振荡相量测量方法，其特征在于，所述基于多分量Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率，其公式如下：其中，∠表示取相量的角度，p和p为第一和第二分量Morlet小波的高频振荡相量测量值，fs为采样频率。4.根据权利要求2所述的基于多分量Morlet小波的高频振荡相量测量方法，其特征在于，所述基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度，其公式如下：其中，p为第一分量Morlet小波的高频振荡相量测量值，为待测量的高频振荡频率的频谱响应。5.根据权利要求4所述的基于多分量Morlet小波的高频振荡相量测量方法，其特征在于，所述第一分量Morlet小波的高频振荡相量测量值的计算公式如下：其中，2N+1为时间窗长度，Ts为采样时间间隔，s为采样后的电压电流信号，ψmt为多分量Morlet小波的高频振荡相量，a为小波尺度因子。6.根据权利要求1或5所述的基于多分量Morlet小波的高频振荡相量测量方法，其特征在于，所述步骤二中不同中心频率处的多分量Morlet小波高频振荡相量，其计算公式如下：其中，为各Morlet小波分量的权重因子，k为各Morlet小波分量的编号，Δf为单位频率偏移量，fc为中心频率，a为小波尺度因子。7.根据权利要求1所述的基于多分量Morlet小波的高频振荡相量测量方法，其特征在于，所述采样后电网电压电流信号包括高频分量和基波分量，表示为：其中，f0和fih分别代表额定频率和高频振荡频率，a0和θ0分别代表基波有效值和相位，aih和θih分别代表高频振荡分量有效值和相位。8.一种基于多分量Morlet小波的高频振荡相量测量装置，其特征在于，包括：采样模块，用于采集电网电压电流信号并对所述电网电压电流信号进行采样；高频振荡相量模块，用于基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；最大模值模块，用于基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；阈值判断模块，用于将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，重回采样模块采样电网电压电流信号。9.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至7任一项所述的基于多分量Morlet小波的高频振荡相量测量方法的步骤。10.一种非暂态计算机可读存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时实现如权利要求1至7任一项所述的基于多分量Morlet小波的高频振荡相量测量方法的步骤。
说明书desc
技术领域本发明涉及网络化控制技术领域，尤其涉及一种基于多分量 Morlet小波的高频振荡相量测量方法及装置。背景技术近年来，国内柔性直流输电系统中发生了多起高频振荡事件。例如，2017年，当其中一条输电线路因检修而断开时，广西鲁西背靠背直流出现了频率近为1272Hz的高频振荡现象。这给电力系统安全稳定运行带来了巨大威胁。因此，非常有必要实时测量高频振荡相量，从而为高频振荡早期预期和自适应抑制提供必要的信息。由于高频振荡发展较快，因此要求高频振荡相量测量速度也较快，也即要求高频振荡相量测量的时间窗不能过长。目前已有方法多采用插值离散傅里叶变换实现高频振荡相量测量。但这种方法在时间窗较短时，高频振荡频率附近的频谱受基波的频谱泄露影响严重，导致高频振荡相量测量误差较大。发明内容本发明实施例提供一种基于多分量Morlet小波的高频振荡相量测量方法及装置，用以解决目前实现高频振荡相量测量的方法在时间窗较短时存在测量误差较大的问题。第一方面，本发明实施例提供一种基于多分量Morlet小波的高频振荡相量测量方法，包括：步骤一，采集电网电压电流信号并对所述电网电压电流信号进行采样；步骤二，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；步骤三，基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；步骤四，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤一重新采样电网电压电流信号。进一步地，所述步骤四中基于所述高频振荡相量计算出待测量的高频振荡频率和幅值，包括：基于多分量Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率；基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度。进一步地，所述基于多分量Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率，其公式如下：其中，∠表示取相量的角度，p和p为第一和第二分量Morlet 小波的高频振荡相量测量值，fs为采样频率。进一步地，所述基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度，其公式如下：其中，p为第一分量Morlet小波的高频振荡相量测量值，为待测量的高频振荡频率的频谱响应。进一步地，所述第一分量Morlet小波的高频振荡相量测量值的计算公式如下：其中，2N+1为时间窗长度，Ts为采样时间间隔，s为采样后的电压电流信号，ψmt为多分量Morlet小波的高频振荡相量，a为小波尺度因子。进一步地，所述步骤二中不同中心频率处的多分量Morlet小波高频振荡相量，其计算公式如下：其中，为各Morlet小波分量的权重因子，k为各 Morlet小波分量的编号，Δf为单位频率偏移量，fc为中心频率，a为小波尺度因子。进一步地，所述采样后电网电压电流信号包括高频分量和基波分量，表示为：其中，f0和fih分别代表额定频率和高频振荡频率，a0和θ0分别代表基波有效值和相位，aih和θih分别代表高频振荡分量有效值和相位。第二方面，本发明实施例提供一种基于多分量Morlet小波的高频振荡相量测量装置，包括：采样模块，用于采集电网电压电流信号并对所述电网电压电流信号进行采样；高频振荡相量模块，用于基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；最大模值模块，用于基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；阈值判断模块，用于将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，重回采样模块采样电网电压电流信号。第三方面，本发明实施例提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如上述第一方面所提供的任一项所述基于多分量Morlet小波的高频振荡相量测量方法的步骤。第四方面，本发明实施例提供一种非暂态计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如上述第一方面所提供的任一项所述基于多分量Morlet小波的高频振荡相量测量方法的步骤。本发明实施例提供的一种基于多分量Morlet小波的高频振荡相量测量方法及装置，通过采集电网电压电流信号并对所述电网电压电流信号进行采样，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量，并基于所述不同中心频率处的高频振荡相量的模值得到最大的模值，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤一重新采样电网电压电流信号。本发明实现了基波分量的有效抑制，从而大大提高了高频振荡相量测量的准确度。附图说明为了更清楚地说明本发明或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明提供的基于多分量Morlet小波的高频振荡相量测量方法的流程示意图；图2是本发明提供的基于多分量Morlet小波的高频振荡相量测量的用例示意图；图3是本发明提供的基于多分量Morlet小波的高频振荡相量测量装置的结构示意图；图4是本发明提供的电子设备的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明针对现已有的插值离散傅里叶变换方法不能有效基波分量干扰，存在高频振荡相量测量误差较大的问题，设计一种多分量 Morlet小波，可实现基波分量的有效抑制，从而大大提高了高频振荡相量测量的准确度。下面结合图1-图4描述本发明提供的一种基于多分量Morlet小波的高频振荡相量测量方法及装置。本发明实施例提供了一种基于多分量Morlet小波的高频振荡相量测量方法。图1为本发明实施例提供的基于多分量Morlet小波的高频振荡相量测量方法的流程示意图，如图1所示，该方法包括：步骤110，采集电网电压电流信号并对所述电网电压电流信号进行采样；步骤120，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；步骤130，基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；步骤140，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤110重新采样电网电压电流信号。与现有技术相比，本发明提供的方法，通过对多个分量小波进行加权叠加，有效提高基波所在的阻带的衰减能力，从而实现了高频振荡相量测量的高准确度。基于上述任一实施例，所述步骤四中基于所述高频振荡相量计算出待测量的高频振荡频率和幅值，包括：基于多分量Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率；基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度。基于上述任一实施例，所述基于多分量Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率，其公式如下：其中，∠表示取相量的角度，p和p为第一和第二分量Morlet 小波的高频振荡相量测量值，fs为采样频率。基于上述任一实施例，所述基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度，其公式如下：其中，p为第一分量Morlet小波的高频振荡相量测量值，为待测量的高频振荡频率的频谱响应。基于上述任一实施例，所述第一分量Morlet小波的高频振荡相量测量值的计算公式如下：其中，2N+1为时间窗长度，Ts为采样时间间隔，s为采样后的电压电流信号，ψmt为多分量Morlet小波的高频振荡相量，a为小波尺度因子。具体地，基于多分量Morlet小波的高频振荡相量测量方法即为：高频振荡频率可以用以下方法估计：其中，∠表示取相量的角度。高频振荡的幅度可以用下式估计：基于上述任一实施例，所述步骤二中不同中心频率处的多分量 Morlet小波高频振荡相量，其计算公式如下：其中，为各Morlet小波分量的权重因子，k为各 Morlet小波分量的编号，Δf为单位频率偏移量，fc为中心频率，a为小波尺度因子。具体地，离散时间形式的传统Morlet小波可以表现成下式：其中，fc为中心频率，a为小波尺度因子，fs是采样频率；2N+1为时间窗长度。为了进一步提高基波分量的抑制效果，本发明设计一种多分量Morlet小波来实现高频振荡相量测量。其中，为各Morlet小波分量的权重因子，k为各 Morlet小波分量的编号，Δf为单位频率偏移量。所增加的Morlet小波分量的个数为2K个。在中心频率附近，上述小波的频谱响应可表示为：基于上述任一实施例，所述采样后电网电压电流信号包括高频分量和基波分量，表示为：其中，f0和fih分别代表额定频率和高频振荡频率，a0和θ0分别代表基波有效值和相位，aih和θih分别代表高频振荡分量有效值和相位。具体地，对一个含有高频分量和基波分量的采样后的电压电流信号，可表示为：其中，f0和fih分别代表额定频率和高频振荡频率；a0和θ0分别代表基波有效值和相位；aih和θih分别代表高频振荡分量有效值和相位。为高频振荡相量，即为待测量的相量值。具体实际测量中，取时间窗长度为一个基波周期。中心频率fc取值为600,650,700,…,2000Hz。多分量Morlet小波各参量的取值如下：a＝4*10-5；K＝1；Δf＝16Hz。采用上述小波进行高频振荡的步骤如图2所示，具体来说：第一步：对电网电压电流信号进行采样，并输入到测量装置中；第二步：在不同中心频率处，采用式 计算高频振荡相量；第三步：计算各相量的模值，并取最大的模值；第四步：将最大的模值与一个阈值进行比较。若大于这一阈值，则表明信号中含有的高频振荡分量较大，需要进行下一步测量计算高频振荡频率，用式 补偿计算高频振荡幅值)。若否，则返回到第一步，重新输入采样信号。下面对本发明提供的一种基于多分量Morlet小波的高频振荡相量测量装置进行描述，下文描述的与上文描述的一种基于多分量 Morlet小波的高频振荡相量测量方法可相互对应参照。图3为本发明实施例提供的一种基于多分量Morlet小波的高频振荡相量测量装置的结构示意图，如图3所示，该装置包括采样模块 310、高频振荡相量模块320、最大模值模块330和阈值判断模块340；采样模块310，用于采集电网电压电流信号并对所述电网电压电流信号进行采样；高频振荡相量模块320，用于基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；最大模值模块330，用于基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；阈值判断模块340，用于将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，重回采样模块310采样电网电压电流信号。与现有技术相比，本发明提供的装置，通过对多个分量小波进行加权叠加，有效提高基波所在的阻带的衰减能力，从而实现了高频振荡相量测量的高准确度。基于上述任一实施例，所述阈值判断模块包括阈值比较模块和待测量模块；所述待测量模块包括待测频率模块和待测幅度模块；所述待测频率模块，用于基于多分量Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率；所述待测幅度模块，用于基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度。基于上述任一实施例，所述待测频率模块，用于基于多分量 Morlet小波的高频振荡相量测量及采样频率估出待测量的高频振荡频率，其公式如下：其中，∠表示取相量的角度，p和p为第一和第二分量Morlet 小波的高频振荡相量测量值，fs为采样频率。基于上述任一实施例，所述待测幅度模块，用于基于多分量Morlet小波的高频振荡相量测量及所述待测量的高频振荡频率的频谱响应估出待测量的高频振荡幅度，其公式如下：其中，p为第一分量Morlet小波的高频振荡相量测量值，为待测量的高频振荡频率的频谱响应。基于上述任一实施例，所述第一分量Morlet小波的高频振荡相量测量值的计算公式如下：其中，2N+1为时间窗长度，Ts为采样时间间隔，s为采样后的电压电流信号，ψmt为多分量Morlet小波的高频振荡相量，a为小波尺度因子。基于上述任一实施例，所述高频振荡相量模块，用于基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量，其计算公式如下：其中，为各Morlet小波分量的权重因子，k为各 Morlet小波分量的编号，Δf为单位频率偏移量，fc为中心频率，a为小波尺度因子。基于上述任一实施例，所述采样后电网电压电流信号包括高频分量和基波分量，表示为：其中，f0和fih分别代表额定频率和高频振荡频率，a0和θ0分别代表基波有效值和相位，aih和θih分别代表高频振荡分量有效值和相位。图4为本发明实施例提供的电子设备的结构示意图，如图4所示，该电子设备可以包括：处理器410、通信接口420、存储器430和通信总线440，其中，处理器410，通信接口420，存储器430通过通信总线440完成相互间的通信。处理器410可以调用存储器430中的逻辑指令，以执行基于多分量Morlet小波的高频振荡相量测量方法，该方法包括：步骤一，采集电网电压电流信号并对所述电网电压电流信号进行采样；步骤二，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；步骤三，基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；步骤四，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤一重新采样电网电压电流信号。此外，上述的存储器430中的逻辑指令可以通过软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。另一方面，本发明实施例还提供一种计算机程序产品，所述计算机程序产品包括存储在非暂态计算机可读存储介质上的计算机程序，所述计算机程序包括程序指令，当所述程序指令被计算机执行时，计算机能够执行上述各方法所提供的基于多分量Morlet小波的高频振荡相量测量方法，该方法包括：步骤一，采集电网电压电流信号并对所述电网电压电流信号进行采样；步骤二，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；步骤三，基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；步骤四，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤一重新采样电网电压电流信号。又一方面，本发明实施例还提供一种非暂态计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现以执行上述各提供的基于多分量Morlet小波的高频振荡相量测量方法，该方法包括：步骤一，采集电网电压电流信号并对所述电网电压电流信号进行采样；步骤二，基于采样后的电网电压电流信号得到不同中心频率处的高频振荡相量；步骤三，基于所述不同中心频率处的高频振荡相量的模值得到最大的模值；步骤四，将所述最大的模值与预设阈值进行比较：若所述最大的模值大于预设阈值，则基于所述高频振荡相量计算出待测量的高频振荡频率和幅值；否则，返回步骤一重新采样电网电压电流信号。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到各实施方式可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在计算机可读存储介质中，如ROM/RAM、磁碟、光盘等，包括若干指令用以使得一台计算机设备执行各个实施例或者实施例的某些部分所述的方法。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
