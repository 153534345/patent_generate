标题title
基于计算机视觉的光伏板蜗牛纹缺陷检测方法
摘要abst
本发明涉及图像处理领域，具体涉及一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，获取电池板表面灰度图像中每行、列像素点的灰度值累加值拟合曲线，根据拟合曲线中波峰和波谷个数得到拟合曲线的波动比率，根据拟合曲线中每个波峰和下个相邻波谷处灰度值得到拟合曲线的平均灰度差异，根据波动比率和平均灰度差异计算拟合曲线的波动程度，根据波动程度判断拟合曲线是顺向还是垂向，根据顺向拟合曲线上波峰个数和波峰幅值得到蜗牛纹尺寸异常程度，根据垂向拟合曲线上每个波谷和该波谷端点处灰度值得到波谷异常程度，根据蜗牛纹尺寸异常程度和波谷异常程度得到蜗牛纹异常程度，判断蜗牛纹是否会影响使用，方法简单、智能、精准、高效。
权利要求书clms
1.一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，包括：获取光伏电池板表面灰度图像；获取电池板表面灰度图像中每行、列像素点的灰度值累加值，根据每行、列像素点灰度值的累加值得到行、列累加值拟合曲线；根据行、列累加值拟合曲线中的波峰和波谷个数得到行、列累加值拟合曲线的波动比率；根据行、列累加值拟合曲线中每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值得到行、列累加值拟合曲线的平均灰度差异；根据行、列累加值拟合曲线的波动比率和平均灰度差异得到行、列累加值拟合曲线的波动程度；根据行、列累加值拟合曲线的波动程度判定行、列累加值拟合曲线是属于顺向拟合曲线还是属于垂向拟合曲线；根据判定属于顺向拟合曲线上的波峰个数和波峰幅值得到蜗牛纹尺寸异常程度，根据判定属于垂向拟合曲线上的每个波谷处灰度值和该波谷端点处灰度值得到每个波谷的异常程度；根据蜗牛纹尺寸异常程度和每个波谷的异常程度得到蜗牛纹的异常程度，根据异常程度判断蜗牛纹是否会影响使用。2.根据权利要求1所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述行、列累加值拟合曲线的波动比率的获取方法为：获取行累加值拟合曲线的波峰个数，波谷个数，列累加值拟合曲线的波峰个数，波谷个数；行累加值拟合曲线的波动比率计算方法为：式中，为行累加值拟合曲线的波动比率，为光伏电池板表面灰度图像像素点的行数；列累加值拟合曲线的波动比率计算方法为：式中，为列累加值拟合曲线的波动比率，为光伏电池板表面灰度图像像素点的列数。3.根据权利要求2所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述行、列累加值拟合曲线的平均灰度差异的获取方法为：计算行累加值拟合曲线上每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值，将所有差值累加得到；计算列累加值拟合曲线上每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值，将所有累加得到；行累加值拟合曲线的平均灰度差值计算方法为：式中，为行累加值拟合曲线的平均灰度差值；列累加值拟合曲线的平均灰度差值计算方法为：式中，为行累加值拟合曲线的平均灰度差值。4.根据权利要求3所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述行、列累加值拟合曲线的波动程度的获取方法为：行累加值拟合曲线的波动程度计算方法为：式中，为行累加值拟合曲线的波动程度；列累加值拟合曲线的波动程度计算方法为：式中，为列累加值拟合曲线的波动程度。5.根据权利要求4所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述根据行、列累加值拟合曲线的波动程度判断行、列累加值拟合曲线是属于顺向拟合曲线还是属于垂向拟合曲线的方法为：若行累加值拟合曲线的波动程度的值大于列累加值拟合曲线的波动程度，则行累加值拟合曲线为顺向拟合曲线，列累加值拟合曲线为垂向拟合曲线；若列累加值拟合曲线的波动程度的值大于行累加值拟合曲线的波动程度，则列累加值拟合曲线为顺向拟合曲线，行累加值拟合曲线为垂向拟合曲线。6.根据权利要求5所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述蜗牛纹尺寸异常程度的获取方法为：获取顺向拟合曲线上的波峰个数和每个波峰的幅值；计算顺向拟合曲线上所有波峰幅值的均值；计算每个波峰幅值与所有波峰幅值的均值的差值；则蜗牛纹尺寸异常程度的计算方法为：式中，为蜗牛纹尺寸异常程度，为顺向拟合曲线上的波峰个数，为第个波峰，为第个波峰的幅值，为顺向拟合曲线上所有波峰幅值的均值，为每个波峰幅值与所有波峰幅值的均值的差值大于0的波峰个数。7.根据权利要求6所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述每个波谷的异常程度的获取方法为：获取垂向拟合曲线上的波谷个数和每个波谷从左端点到右端点占据的列数；获取每个波谷所在列的灰度值累加值与两个端点所在列的灰度值累加值中较大的累加值的差值；则每个波谷的异常程度的计算方法为：式中，为垂向拟合曲线上第个波谷的异常程度，为第个波谷从左端点到右端点占据的列数，为第个波谷所占总差值的权重，计算方法为：式中，为第个波谷处像素点所在列像素点灰度值累加值与左端点、右端点所在列像素点灰度值累加值中较大累加值的差值。8.根据权利要求7所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述蜗牛纹的异常程度的计算方法为：式中，为蜗牛纹的异常程度。9.根据权利要求8所述的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，其特征在于，所述根据异常程度判断蜗牛纹是否会影响使用的方法为：若异常程度的值大于0，则蜗牛纹会影响光伏电池板使用，及时更换。
说明书desc
技术领域本申请涉及图像处理领域，具体涉及一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法。背景技术随着科技的发展，光伏发电技术已经愈发成熟，而这也意味着光伏电池板的使用范围也愈加广泛，需求量激增，在这种背景环境下，光伏电池板的质量问题成了重中之重。在光伏电池板的使用过程中，在高温、高湿、光照等环境中，光伏电池板表面的EVA中的氧化剂与银栅线发生氧化反应，导致白色银栅线变成暗灰色的现象，称为蜗牛纹，在蜗牛纹存在的地方，约90%以上有电池板隐裂的存在，降低了组件的发电效率，降低了组件的可靠性能，更严重的是会导致组件提前失效或烧掉。因此，需要在使用过程中检测光伏电池板是否含有蜗牛纹，以便将存在蜗牛纹的光伏电池板及时进行更换，目前，常见的检测方法为人工检测，费时费力且效率较低。发明内容本发明提供一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法，解决蜗牛纹检测费时费力且效率低的问题，采用如下技术方案：获取光伏电池板表面灰度图像；获取电池板表面灰度图像中每行、列像素点的灰度值累加值，根据每行、列像素点灰度值的累加值得到行、列累加值拟合曲线；根据行、列累加值拟合曲线中的波峰和波谷个数得到行、列累加值拟合曲线的波动比率；根据行、列累加值拟合曲线中每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值得到行、列累加值拟合曲线的平均灰度差异；根据行、列累加值拟合曲线的波动比率和平均灰度差异得到行、列累加值拟合曲线的波动程度；根据行、列累加值拟合曲线的波动程度判断行、列累加值拟合曲线是属于顺向拟合曲线还是属于垂向拟合曲线；根据判定属于顺向拟合曲线上的波峰个数和波峰幅值得到蜗牛纹尺寸异常程度，根据判定属于垂向拟合曲线上的每个波谷处灰度值和该波谷端点处灰度值得到每个波谷的异常程度；根据蜗牛纹尺寸异常程度和每个波谷的异常程度得到蜗牛纹的异常程度，根据异常程度判断蜗牛纹是否会影响使用。所述行、列累加值拟合曲线的波动比率的获取方法为：获取行累加值拟合曲线的波峰个数，波谷个数，列累加值拟合曲线的波峰个数，波谷个数；行累加值拟合曲线的波动比率计算方法为：式中，为行累加值拟合曲线的波动比率，为光伏电池板表面灰度图像像素点的行数；列累加值拟合曲线的波动比率计算方法为：式中，为列累加值拟合曲线的波动比率，为光伏电池板表面灰度图像像素点的列数。所述行、列累加值拟合曲线的平均灰度差异的获取方法为：计算行累加值拟合曲线上每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值，将所有差值累加得到；计算列累加值拟合曲线上每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值，将所有累加得到；行累加值拟合曲线的平均灰度差值计算方法为：式中，为行累加值拟合曲线的平均灰度差值；列累加值拟合曲线的平均灰度差值计算方法为：式中，为行累加值拟合曲线的平均灰度差值。所述行、列累加值拟合曲线的波动程度的获取方法为：行累加值拟合曲线的波动程度计算方法为：式中，为行累加值拟合曲线的波动程度；列累加值拟合曲线的波动程度计算方法为：式中，为列累加值拟合曲线的波动程度。所述根据行、列累加值拟合曲线的波动程度判断行、列累加值拟合曲线是属于顺向拟合曲线还是属于垂向拟合曲线的方法为：若的值大于，则行累加值拟合曲线为顺向拟合曲线，列累加值拟合曲线为垂向拟合曲线；若的值大于，则列累加值拟合曲线为顺向拟合曲线，行累加值拟合曲线为垂向拟合曲线。所述蜗牛纹尺寸异常程度的获取方法为：获取顺向拟合曲线上的波峰个数和每个波峰的幅值；计算顺向拟合曲线上所有波峰幅值的均值；计算每个波峰幅值与所有波峰幅值的均值的差值；则蜗牛纹尺寸异常程度的计算方法为：式中，为蜗牛纹尺寸异常程度，为顺向拟合曲线上的波峰个数，为第个波峰，为第个波峰的幅值，为顺向拟合曲线上所有波峰幅值的均值，为每个波峰幅值与所有波峰幅值的均值的差值大于0的波峰个数。所述每个波谷的异常程度的获取方法为：获取垂向拟合曲线上的波谷个数和每个波谷从左端点到右端点占据的列数；获取每个波谷所在列的灰度值累加值与两个端点所在列的灰度值累加值中较大的累加值的差值；则每个波谷的异常程度的计算方法为：式中，为垂向拟合曲线上第个波谷的异常程度，为第个波谷从左端点到右端点占据的列数，为第个波谷所占总差值的权重，计算方法为：式中，为第个波谷处像素点所在列像素点灰度值累加值与左端点、右端点所在列像素点灰度值累加值中较大累加值的差值。所述蜗牛纹的异常程度的计算方法为：式中，为蜗牛纹的异常程度。所述根据异常程度判断蜗牛纹是否会影响使用的方法为：若异常程度的值大于0，则蜗牛纹会影响光伏电池板使用。本发明的有益效果是：基于图像处理，获取电池板表面灰度图像中每行、列像素点的灰度值累加值的拟合曲线，根据拟合曲线中的波峰和波谷个数得到拟合曲线的波动比率，根据拟合曲线中每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值得到拟合曲线的平均灰度差异，根据波动比率和平均灰度差异计算拟合曲线的波动程度，根据波动程度判断拟合曲线是顺向还是垂向，根据顺向拟合曲线上的波峰个数和波峰幅值得到蜗牛纹尺寸异常程度，根据垂向拟合曲线上的每个波谷处灰度值和该波谷端点处灰度值得到每个波谷的异常程度，根据蜗牛纹尺寸异常程度和每个波谷的异常程度得到蜗牛纹的异常程度，根据异常程度判断蜗牛纹是否会影响使用，方法简单、智能、精准、高效。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1是本发明的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法流程示意图；图2是本发明的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法中的光伏电池板蜗牛纹示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的一种基于计算机视觉的光伏板蜗牛纹缺陷检测方法的实施例，如图1所示，包括：步骤一：获取光伏电池板表面灰度图像；获取电池板表面灰度图像中每行、列像素点的灰度值累加值，根据每行、列像素点灰度值的累加值得到行、列累加值拟合曲线；该步骤的目的是采集光伏电池板表面灰度图像，作为数据基础，便于后续分析。本实施例首先利用清洁机器人对光伏电池板表面进行清洁，由于光伏电池板表面可能会存在灰尘或者落叶、鸟粪等，若不进行清洁，直接采集图像，会对后续分析产生影响，造成判断结果不够精准，因此，需要先对光伏电池板表面进行清洁，排除其他因素干扰，然后使用无人机拍摄光伏电池板表面图像，并对其进行灰度化处理，得到其灰度图像，然后分别计算灰度图上每一行像素点灰度值的累加值，每一列像素点灰度值的累加值，将每一行像素点灰度值的累加值进行拟合，得到行累加值拟合曲线，拟合曲线横坐标为行数，纵坐标为每一行的灰度值累加值，将每一列像素点灰度值的累加值进行拟合，得到列累加值拟合曲线，该拟合曲线的横坐标为列数，纵坐标为每一列灰度值的累加值。需要说明的是，光伏电池板表面上分布有相互平行且长度相等的一条条栅线，且经过灰度化处理后应是白色高亮，灰度值较大的部分，若该光伏电池板表面存在蜗牛纹缺陷，如图2所示，手指宽的暗色粗线条为蜗牛纹，蜗牛问经过灰度化处理后为灰度值较小的部分。正常的光伏板表面图像经过灰度化处理后得到灰度图像对应的行累加值拟合曲线会周期性的产生波峰，因为存在灰度值高亮的栅线，当某些行像素点为栅线像素点时，该行像素点灰度值累加值就会增大，由于栅线是平行且等距分布，所以行累加值拟合曲线中会产生周期性的波峰；但是，列累加值拟合曲线则是平缓的，近似的一条直线，因为每一列像素点灰度值累加值几乎相等，在每一列中，栅线的像素点分布是相同的，因此列累加值拟合曲线近似直线。步骤二：根据行、列累加值拟合曲线中的波峰和波谷个数得到行、列累加值拟合曲线的波动比率；根据行、列累加值拟合曲线中每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值得到行、列累加值拟合曲线的平均灰度差异；该步骤的目的是，分析行累加值拟合曲线的波动情况和列累加值拟合曲线的波动情况，根据波动情况和波峰、波谷的灰度差异得到拟合曲线的平均灰度差异。其中，行、列累加值拟合曲线的波动比率的获取方法为：获取行累加值拟合曲线的波峰个数，波谷个数，列累加值拟合曲线的波峰个数，波谷个数；行累加值拟合曲线的波动比率计算方法为：式中，为行累加值拟合曲线的波动比率，为光伏电池板表面灰度图像像素点的行数；列累加值拟合曲线的波动比率计算方法为：式中，为列累加值拟合曲线的波动比率，为光伏电池板表面灰度图像像素点的列数。其中，行、列累加值拟合曲线的平均灰度差异的获取方法为：计算行累加值拟合曲线上每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值，将所有差值累加得到；则行累加值拟合曲线的平均灰度差值计算方法为：式中，为行累加值拟合曲线的平均灰度差值；计算列累加值拟合曲线上每个波峰处灰度值和与该波峰的下个相邻波谷处灰度值的差值，将所有累加得到；则列累加值拟合曲线的平均灰度差值计算方法为：式中，为行累加值拟合曲线的平均灰度差值。步骤三：根据行、列累加值拟合曲线的波动比率和平均灰度差异得到行、列累加值拟合曲线的波动程度；根据行、列累加值拟合曲线的波动程度判断行、列累加值拟合曲线是属于顺向拟合曲线还是属于垂向拟合曲线；该步骤的目的是，通过分析行累加值拟合曲线的波动程度和列累加值拟合曲线的波动程度，判断行累加值拟合曲线和列累加值拟合曲线是与栅线分布方向的顺向累加值拟合曲线还是与栅线分布方向的垂向累加值拟合曲线。其中，行、列累加值拟合曲线的波动程度的获取方法为：行累加值拟合曲线的波动程度计算方法为：式中，为行累加值拟合曲线的波动程度；列累加值拟合曲线的波动程度计算方法为式中，为列累加值拟合曲线的波动程度。其中，根据行、列累加值拟合曲线的波动程度判断行、列累加值拟合曲线是属于顺向拟合曲线还是属于垂向拟合曲线的方法为：若的值大于，则行累加值拟合曲线为顺向拟合曲线，列累加值拟合曲线为垂向拟合曲线；若的值大于，则列累加值拟合曲线为顺向拟合曲线，行累加值拟合曲线为垂向拟合曲线。需要说明的是，由于栅线沿固定方向分布，则沿该方向的累加值拟合曲线会出现较大波动；相应的，与栅线分布方向垂直或角度较大的方向的灰度累加和拟合曲线则会较为平缓，不会出现剧烈的波峰波谷差值波动。步骤四：根据判定属于顺向拟合曲线上的波峰个数和波峰幅值得到蜗牛纹尺寸异常程度，根据判定属于垂向拟合曲线上的每个波谷处灰度值和该波谷端点处灰度值得到每个波谷的异常程度；该步骤的目的是，分析顺向累加值拟合曲线上波峰的个数和幅值判断是否存在异常的波峰，得到关于蜗牛纹长度、宽度的影响参数，同时，分析垂向拟合曲线中每个波谷处像素点所在列灰度值累加值和端点处像素点所在列灰度累加值计算出每个波谷的缺陷程度。其中，蜗牛纹尺寸异常程度的获取方法为：获取顺向拟合曲线上的波峰数量，设第个波峰的幅值为；求顺向拟合曲线上所有波峰幅值的平均值：分别计算每个波峰幅值与均值间的差值如下：其中，大于0的波峰共有个。根据幅值差及可能的异常波峰数，得到一个关于蜗牛纹尺寸的异常程度如下：其中，表示光伏板表面上蜗牛纹尺寸的异常程度，越大则表示光伏板表面上蜗牛纹整体长度或宽度越大，如果光伏电池板表面上没有出现蜗牛纹缺陷异常，则各条栅线都应是完整的，则反映到顺向分布累加曲线中，每条栅线对应的波峰幅值都应相当；如果出现蜗牛纹缺陷，蜗牛纹会覆盖数条栅线上的部分，则这些栅线对应的顺向分布累加曲线中的波峰幅值则会低于正常栅线对应的波峰幅值。不过也有可能出现特殊情况，即蜗牛纹缺陷刚好覆盖了所有栅线，且缺陷宽度恒定，则所有栅线对应的波峰幅值仍会相当，不会有较大差异的部分出现，此种情况则需根据垂向分布累加曲线来界定判断。其中，每个波谷的异常程度的获取方法为：获取垂向拟合曲线上的波谷个数和每个波谷从左端点到右端点占据的列数；获取每个波谷所在列的灰度值累加值与两个端点所在列的灰度值累加值中较大的累加值的差值；则每个波谷的异常程度的计算方法为：式中，为垂向拟合曲线上第个波谷的异常程度，为第个波谷从左端点到右端点占据的列数，为第个波谷所占总差值的权重，计算方法为：式中，为第个波谷处像素点所在列像素点灰度值累加值与左端点、右端点所在列像素点灰度值累加值中较大累加值的差值。需要说明的是，在垂向分布曲线中，如果光伏电池板表面正常，即栅线状况正常，则既不会有明显的波峰也不会有波谷出现，因为每一列中包含的栅线上的像素点的数量都是相当的；但如果有蜗牛纹缺陷出现，则会覆盖部分栅线，反映到垂向分布曲线中则会出现波谷，波谷所在列即包含了被覆盖的栅线上的像素点。步骤五：根据蜗牛纹尺寸异常程度和每个波谷的异常程度得到蜗牛纹的异常程度，根据异常程度判断蜗牛纹是否会影响使用。该步骤的目的是综合分析蜗牛纹长度宽度的异常程度和每个波谷的异常程度得到蜗牛纹的异常程度，并根据异常程度判断是否存在蜗牛纹。由上步判断得到的垂向分布曲线上每个波谷的缺陷影响程度，可以得到蜗牛纹的整体异常影响程度，并以此评判光伏电池板是否异常影响过大从而影响继续使用。其中，蜗牛纹的异常程度的计算方法为：公式中，为异常影响程度，综合评判结果为蜗牛纹的整体长宽参数与每个缺陷影响累加值的乘积，故值越大，表明缺陷整体影响越大，则越有可能影响后续光伏电池板的使用。其中，根据异常程度判断蜗牛纹是否会影响使用的方法为：＞0时会存在蜗牛纹影响光伏板后续使用，及时更换该光伏电池板。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
