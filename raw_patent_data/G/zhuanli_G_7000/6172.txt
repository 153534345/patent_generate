标题title
一种基于机器视觉的电子元器件计数系统
摘要abst
本发明属于机器视觉领域，公开了一种基于机器视觉的电子元器件计数系统，包括第一摄像头、第二摄像头、料盘和计数模块；第一摄像头的主光轴与料盘所处的平面平行，第二摄像头的主光轴与料盘所处的平面垂直；第一摄像头用于沿着主光轴的方向对料盘进行拍摄，获得包含电子元器件的第一图像；计数模块用于根据第一图像判断是否出现重叠情况；第二摄像头用于在没有出现重叠情况时，沿着主光轴的方向对料盘进行拍摄，获得包含电子元器件的第二图像；计数模块用于对第二图像进行图像识别，获取电子元器件的数量。本发明有效地提高了对电子元器件进行计数的效率。
权利要求书clms
1.一种基于机器视觉的电子元器件计数系统，其特征在于，包括第一摄像头、第二摄像头、料盘和计数模块；第一摄像头的主光轴与料盘所处的平面平行，第二摄像头的主光轴与料盘所处的平面垂直；第一摄像头用于沿着主光轴的方向对料盘进行拍摄，获得包含电子元器件的第一图像；计数模块用于根据第一图像判断是否出现重叠情况，包括：根据预设的行数获取第一图像中的重叠识别行；对重叠识别行中的像素点进行重叠系数的计算：其中，ovrfac表示重叠系数，μ表示权重，maval和mival分别表示重叠识别行中的像素点的像素值的最大值和最小值，ofset表示重叠识别行中除了最后一个像素点之外的其余的像素点的集合，gradi和gradi,rgt分别表示ofset中的像素点i和像素点i的右边的像素点的像素值，nof表示ofset中的像素点的数量，migrad表示重叠识别行中相邻的两个像素点的像素值的差值的最大值；判断重叠系数是否大于设定的系数阈值，若是，则表示出现重叠情况，若否，则表示没有出现重叠情况；第二摄像头用于在没有出现重叠情况时，沿着主光轴的方向对料盘进行拍摄，获得包含电子元器件的第二图像；计数模块用于对第二图像进行图像识别，获取电子元器件的数量。2.根据权利要求1所述的一种基于机器视觉的电子元器件计数系统，其特征在于，料盘用于存放待进行计数的电子元器件。3.根据权利要求1所述的一种基于机器视觉的电子元器件计数系统，其特征在于，第一摄像头在垂直方向上的投影与料盘在垂直方向上的投影不重叠，第一摄像头的主光轴与料盘的中心的垂线相交。4.根据权利要求1所述的一种基于机器视觉的电子元器件计数系统，其特征在于，第二摄像头的主光轴垂直穿过料盘的中心。5.根据权利要求1所述的一种基于机器视觉的电子元器件计数系统，其特征在于，对重叠识别行中的像素点进行重叠系数的计算，包括：在RGB颜色空间或Lab颜色空间中对重叠识别行中的像素点进行重叠系数的计算。6.根据权利要求1所述的一种基于机器视觉的电子元器件计数系统，其特征在于，计数模块包括重叠判断单元和计数单元；重叠判断单元用于根据第一图像判断是否出现重叠情况；计数单元用于对第二图像进行图像识别，获取电子元器件的数量。7.根据权利要求1所述的一种基于机器视觉的电子元器件计数系统，其特征在于，还包括振动装置；料盘与振动装置的上方连接；在将电子元器件放入到料盘中之后，对料盘进行振动。8.根据权利要求7所述的一种基于机器视觉的电子元器件计数系统，其特征在于，振动装置还用于在出现重叠情况时，对料盘进行振动。
说明书desc
技术领域本发明涉及机器视觉领域，尤其涉及一种基于机器视觉的电子元器件计数系统。背景技术随着电子元器件的需求日益增加，电子元器件的筛选量也随之增加，但是微小电子元器件的散料计数能力还处于一般水平；市面上也有各种过数机，主要集中于编带过数、还有一些适用于大体积器件，对于微小器件和轻型器件的过数方式是有待改进的。人工过数，通过人工计数确认数量，效率低且人工成本较高；称重计数方式对于微小元器件不适用；专用编带式半自动过数机，只局限于编带器件，对于散料不适用。随着图像识别技术的进步，出现了利用机器视觉来对电子元器件进行计数的技术。主要是将需要进行计数的电子元器件放在料盘上，然后对料盘进行拍摄，接着对获得的图像进行图像识别，从而得到出电子元器件的数量。但是现有的基于机器视觉进行电子元器件计数的方式，由于存放在料盘中的电子元器件可能出现重叠的情况，在计数的过程中依然需要人工确定是否出现重叠的电子元器件，因为重叠的电子元器件会导致计数不准确。这就导致计数效率比较低。发明内容本发明的目的在于公开一种基于机器视觉的电子元器件计数系统，解决现有的通过机器视觉进行电子元器件的计算过程中存在的依靠人工进行重叠判断，技术效率比较低的问题。为了达到上述目的，本发明采用如下技术方案：一种基于机器视觉的电子元器件计数系统，包括第一摄像头、第二摄像头、料盘和计数模块；第一摄像头的主光轴与料盘所处的平面平行，第二摄像头的主光轴与料盘所处的平面垂直；第一摄像头用于沿着主光轴的方向对料盘进行拍摄，获得包含电子元器件的第一图像；计数模块用于根据第一图像判断是否出现重叠情况，包括：根据预设的行数获取第一图像中的重叠识别行；对重叠识别行中的像素点进行重叠系数的计算：其中，ovrfac表示重叠系数，μ表示权重，maval和mival分别表示重叠识别行中的像素点的像素值的最大值和最小值，ofset表示重叠识别行中除了最后一个像素点之外的其余的像素点的集合，gradi和gradi,rgt分别表示ofset中的像素点i和像素点i的右边的像素点的像素值，nof表示ofset中的像素点的数量，migrad表示重叠识别行中相邻的两个像素点的像素值的差值的最大值；判断重叠系数是否大于设定的系数阈值，若是，则表示出现重叠情况，若否，则表示没有出现重叠情况；第二摄像头用于在没有出现重叠情况时，沿着主光轴的方向对料盘进行拍摄，获得包含电子元器件的第二图像；计数模块用于对第二图像进行图像识别，获取电子元器件的数量。可选的，料盘用于存放待进行计数的电子元器件。可选的，第一摄像头在垂直方向上的投影与料盘在垂直方向上的投影不重叠，第一摄像头的主光轴与料盘的中心的垂线相交。可选的，第二摄像头的主光轴垂直穿过料盘的中心。可选的，对重叠识别行中的像素点进行重叠系数的计算，包括：在RGB颜色空间或Lab颜色空间中对重叠识别行中的像素点进行重叠系数的计算。可选的，计数模块包括重叠判断单元和计数单元；重叠判断单元用于根据第一图像判断是否出现重叠情况；计数单元用于对第二图像进行图像识别，获取电子元器件的数量。可选的，基于机器视觉的电子元器件计数系统还包括振动装置；料盘与振动装置的上方连接；在将电子元器件放入到料盘中之后，对料盘进行振动。可选的，振动装置还用于在出现重叠情况时，对料盘进行振动。本发明通过设置的主光轴与料盘所处的平面平行的第一摄像头来拍摄用于重叠判断的第一图像，并对第一图像进行识别，实现了对电子元器件是否重叠的判断，本发明不需要人工判断是否重叠，有效地提高了对电子元器件进行计数的效率。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一种基于机器视觉的电子元器件计数系统的一种示意图。图2为本发明计数模块的一种示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。如图1所示的一种实施例，本发明提供了一种基于机器视觉的电子元器件计数系统，包括第一摄像头101、第二摄像头201、料盘301和计数模块401；第一摄像头101的主光轴与料盘301所处的平面平行，第二摄像头201的主光轴501与料盘301所处的平面垂直；第一摄像头101用于沿着主光轴的方向对料盘301进行拍摄，获得包含电子元器件的第一图像；计数模块401用于根据第一图像判断是否出现重叠情况，包括：根据预设的行数获取第一图像中的重叠识别行；对重叠识别行中的像素点进行重叠系数的计算：其中，ovrfac表示重叠系数，μ表示权重，maval和mival分别表示重叠识别行中的像素点的像素值的最大值和最小值，ofset表示重叠识别行中除了最后一个像素点之外的其余的像素点的集合，gradi和gradi,rgt分别表示ofset中的像素点i和像素点i的右边的像素点的像素值，nof表示ofset中的像素点的数量，migrad表示重叠识别行中相邻的两个像素点的像素值的差值的最大值；判断重叠系数是否大于设定的系数阈值，若是，则表示出现重叠情况，若否，则表示没有出现重叠情况；第二摄像头201用于在没有出现重叠情况时，沿着主光轴的方向对料盘301进行拍摄，获得包含电子元器件的第二图像；计数模块401用于对第二图像进行图像识别，获取电子元器件的数量。在本发明中，预设的行数根据电子元器件的高度进行确定。第一摄像头101用于的主光轴与料盘301所处的平面之间的距离大于等于电子元器件的高度。以从下往上的方向数行数，当电子元器件的高度越高时，则预设的行数的数值越大。当电子元器件中不存在重叠的情况时，预设的行数中的像素点均为不包含电子元器件的的像素点，像素值之间的差异非常小，计算重叠系数的函数的加号左侧部分会非常小，加号的右侧部分也会非常小。反之，若包含的电子元器件的像素点越多，则计算重叠系数的函数的加号左侧部分越大，加号的右侧部分也越大，重叠系数越大。因此，通过重叠系数来进行计算，能够准确且快速地判断是否出现重叠情况，提高计数效率。在一种实施例中，第一摄像头101和第二摄像头201采用CMOS传感器或CCD传感器。可选的，料盘301用于存放待进行计数的电子元器件。在一种实施例中，料盘301的边缘的高度大于电子元器件的高度，料盘301的边缘设置有孔洞，第一摄像头101能够穿过所述孔洞对料盘301的内部进行拍摄。在另一种实施例中，料盘301的边缘的高度小于电子元器件的高度，使得第一摄像头101能够直接对料盘301的内部进行拍摄。在一种实施例中，料盘301为经过定制的防静电磨砂盘，可以最大可能防止电子元器件之间的静电吸附。可选的，第一摄像头101在垂直方向上的投影与料盘301在垂直方向上的投影不重叠，第一摄像头101的主光轴与料盘301的中心的垂线相交。不重叠能够第一摄像头101影响料盘301发生位移。第一摄像头101是朝着料盘301的中心进行拍摄的。在一种实施例中，当料盘301为矩形时，第一摄像头101位于矩形的任意一条边之外。在另一种实施例中，当料盘301为圆形时，第一摄像头101与料盘301的圆心之间的距离大于料盘301的半径。可选的，第二摄像头201的主光轴501垂直穿过料盘301的中心。具体的，第二摄像头201设置在料盘301的中心的正上方，第二摄像头201的主光轴501与料盘301的中心的垂线重合。设置在正上方，能够最大限度地降低镜头畸变对计数的准确率产生的影响，能够提高计数的准确率。可选的，对重叠识别行中的像素点进行重叠系数的计算，包括：在RGB颜色空间或Lab颜色空间中对重叠识别行中的像素点进行重叠系数的计算。具体的，可以在RGB颜色空间中的任一个基本色图像中对重叠识别行中的像素点进行重叠系数的计算，也可以在Lab颜色空间的亮度分量的图像中进行重叠系数的计算。可选的，如图2所示，计数模块401包括包括重叠判断单元601和计数单元701；包括重叠判断单元601用于根据第一图像判断是否出现重叠情况；计数单元701用于对第二图像进行图像识别，获取电子元器件的数量。在一种实施例中，计数模块401还包括显示单元，显示单元用于显示计算单元得到的电子元器件的数量。在一种实施例中，对第二图像进行图像识别，获取电子元器件的数量，包括：对第二图像进行滤波，得到第一运算图像；对第一运算图像进行二值化处理，获得第二运算图像；将第二运算图像输入到预先训练好的神经网络模型中进行计算，得到电子元器件的数量。具体的，滤波处理能够降低第一运算图像中的噪声水平，从而提高二值化处理结果的准确率。在一种实施例中，对第二图像进行滤波，得到第一运算图像，包括：将第二图像分成多个面积相同的子图像；使用自适应小波降噪算法分别对每个子图像进行滤波，得到第一运算图像。在本发明中，滤波处理时是通过分成不同的子图像进行的，因为不同的区域中的噪声和信息量并不一致，若直接使用小波降噪算法对整个第二图像进行滤波，则使得小波分解的次数很难适用于所有的区域。因此本发明能够针对不同的子图像采用不同的滤波方案，提高滤波效果。在一种实施例中，使用自适应小波降噪算法分别对每个子图像进行滤波，得到第一运算图像，包括：计算需要进行滤波的子图像的小波参数；基于小波参数对子图像进行小波分解，得到高频小波图像和低频小波图像；对高频小波图像进行软阈值运算，得到经过运算的高频小波图像；将低频小波图像和经过运算的高频小波图像进行重构，得到经过滤波子图像；所有经过滤波的子图像组成第一运算图像。具体的，不同子图像的小波参数不同，因此，通过小波参数来进行小波分解，能有效提高了小波分解结果的准确率。在一种实施例中，计算需要进行滤波的子图像的小波参数，包括：小波参数的计算函数为：函数中，wavpar为小波参数，α和β分别为第一辅助参数和第二辅助参数，α+β＝1，magy和migy分别为需要进行滤波的子图像中的像素值的最大值和最小值，numj为需要进行滤波的子图像中的像素值为j的像素点的数量，N为需要进行滤波的子图像中的像素点的总数，sngst为设定的第一比较系数，nisidx为需要进行滤波的子图像的噪声方差，stnis为设定的第二比较系数。在上述实施例中，小波参数是从不同的像素值的像素点的出现次数以及子图像中的噪声方差两个方面综合计算得到，不同像素值的像素点出现次数之间差异越大，噪声方差越大，则小波参数越大，使得小波参数能够有效地表示子图像中的像素点之间的差别以及噪声的水平。有利于后续计算出更为准确的小波分解次数。在一种实施例中，基于小波参数对子图像进行小波分解，得到高频小波图像和低频小波图像，包括：基于小波参数计算小波分解次数：其中，fltnum为小波分解次数，stwav为设置的小波参数上限值，bsnum表示分解次数的基础值；对子图像进行fltnum次小波分解，得到多个高频小波图像和多个低频小波图像。在一种实施例中，对第一运算图像进行二值化处理，获得第二运算图像，包括：对第一运算图像进行灰度化运算，得到灰度图像；获取灰度图像的分割区间；使用大津法在分割区间内对灰度图像进行图像分割处理，得到分割阈值；基于分割阈值对灰度图像进行二值化处理，得到第二运算图像。现有技术在采用大津法进行二值化计算时，一般需要从0计算到255，分别计算不同的分割阈值所得到的类间方差的值，然后将最大的类间方差对应的像素值作为分割阈值，但是，大津法在每次计算的过程中均需要计算方差，而方差的计算涉及到多个乘法结果的累加，因此较为耗时，不利于快速得到电子元器件的计数结果。因此，本发明通过获取分割区间，让大津法在分割区间中运行，有效地减少了大津法所需要计算的次数，从而提高了二值化的效率。在一种实施例中，获取灰度图像的分割区间，包括：分割区间的下限值采用如下方式确定：在的范围内，按照从小到大的顺序依次计算每个灰度值的分割系数：其中，ctidxd表示灰度值d的分割系数，magrvld和migrvld分别表示的范围内的像素点的灰度值的最大值和最小值，midgrvld表示的范围内的像素点的灰度值的中间值，若|ctidxd-ctidxd-1|≥smthr，则将d作为分割区间的下限值；smthr为设定的分割系数阈值；分割区间的上限值采用如下方式确定：在的范围内，按照从大到小的顺序依次计算每个灰度值的分割系数：其中，ctidxh表示灰度值h的分割系数，magrvlh和midgrvlh分别表示的范围内的像素点的灰度值的最大值和最小值，midgrvlh表示的范围内的像素点的灰度值的中间值，若|ctidxh-1-ctidxh|≥smthr，则将h作为分割区间的上限值；则分割区间为。在分割区间的过程中，本发明从灰度值的两端同时进行计算，有利于提高分割区间的获取速度。具体的，在的范围内，仅获取范围内的像素点的灰度值的最大值、最小值和中间值，并不涉及多个乘法结果的累加，因此，单次计算分割系数所需要的时间远远小于大津法基于单个阈值运算一次所需要的时间，从而避免由于计算分割系数所消耗的时间过多，影响整体的二值化效率。一般背景像素点与作为计数目标的前景像素点之间的差异会比较大，而在本发明中，料盘301作为背景，料盘301区域的像素点的灰度值基本一致，因此，通过分割系数便能够有效地获得使得相邻两个分割系数数值突变的灰度值。例如，当背景的灰度值均小于Q时，而电子元器件的灰度值均大于Q时，则之间的分割系数不会发生突变，而如果采用大津法对的阈值进行计算，则会浪费时间。同时，当电子元器件的像素值均小于R时，则之间的分割系数不会发生突变，而如果采用大津法对的阈值进行计算，则会浪费时间。因此，分割区间的获取有效地提高了本发明二值化的效率。可选的，基于机器视觉的电子元器件计数系统还包括振动装置；料盘301与振动装置的上方连接；在将电子元器件放入到料盘301中之后，对料盘301进行振动。具体的，在电子元器件刚放入到料盘301中的时候，会存在互相重叠的情况，此时对料盘301进行振动能够有效地降低发生重叠的电子元器件的数量。但是由于不能够保证振动之后不存在重叠的情况，因此，后续便通过获取第一图像来判断是否依然存在重叠。传统的方式为通过人眼来判断，在电子元器件数量较多且体积较小的情况下，人眼识别的速度过慢。可选的，振动装置还用于在出现重叠情况时，对料盘301进行振动。具体的，在振动之后，重新获取第一图像，继续判断是否出现重叠，直至到重叠系数小于等于设定的系数阈值。本发明通过设置的主光轴与料盘301所处的平面平行的第一摄像头101来拍摄用于重叠判断的第一图像，并对第一图像进行识别，实现了对电子元器件是否重叠的判断，本发明不需要人工判断是否重叠，有效地提高了对电子元器件进行计数的效率。以上所举实施例，对本发明的目的、技术方案和优点进行了进一步的详细说明，所应理解的是，以上所举实施例仅为本发明的优选实施方式而已，并不用以限制本发明，凡在本发明的精神和原则之内对本发明所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
