标题title
星载激光测高数据与遥感立体影像的联合区域网平差方法
摘要abst
本发明属于遥感测绘技术领域，具体涉及一种星载激光测高数据与遥感立体影像的联合区域网平差方法。该方法首先生成测区的DSM，并将其与星载激光测高数据进行轨迹匹配；然后将DSM上的匹配轨迹点依据平差后的影像RPC参数进行反投影得到对应的像点坐标；之后采用多种约束条件对星载激光测高点进行筛选得到可靠的激光测高点数据；最终利用筛选后的激光测高点数据和卫星遥感立体影像数据进行顾及激光测高点平面坐标误差的光束法联合区域网平差。本发明利用自由区域网平差后测区内立体影像内符合精度高的优势，减轻影像RPC参数误差的影响，得到激光测高点对应的准确像点坐标，保证了物像一致性，有效提高了平差精度和无控条件下的遥感立体影像定位精度。
权利要求书clms
1.一种星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，包括如下步骤：1)对测区的遥感立体影像进行自由区域网平差，得到改正后的遥感立体影像RPC参数；2)依据改正后的遥感立体影像RPC参数，对遥感立体影像进行密集匹配得到测区的DSM；3)对测区内的每一轨星载激光测高点与DSM进行轨迹匹配，得到每轨星载激光测高点在DSM上的对应轨迹；4)根据每轨星载激光测高点在DSM上对应轨迹点的空间坐标，利用所述改正后的遥感立体影像RPC参数对轨迹点进行反投影，求得轨迹点对应影像上的像点坐标，并作为星载激光测高点在遥感立体影像上对应的像点坐标；5)筛选若干激光测高点作为控制点，与遥感立体影像联立进行联合区域网平差，得到平差结果。2.根据权利要求1所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，步骤3)中得到每轨星载激光测高点在DSM上的对应轨迹所采用的方法包括：3.1)根据单轨激光测高点的平面坐标在DSM上插值生成一条相对应的地面曲线；3.2)按照设定步长在搜索区域内平行移动所述地面曲线，得到匹配曲线，并计算匹配曲线与所述地面曲线之间的高程相关性；所述搜索区域为地面曲线周围设定区间范围内划定的区域；3.3)选取高程相关性最强的匹配曲线作为最终的匹配结果，以得到所述单轨激光测高点在DSM上的对应轨迹。3.根据权利要求2所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，步骤3.2)中，所述搜索区域的形状为平行四边形，且搜索区域的大小为5R*5R，R为设定精度要求。4.根据权利要求2所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，步骤3.2)中，所述高程相关性为高程相关系数，且采用下式计算所述高程相关系数：式中，N是单轨激光测高点包含的单轨激光地面点数量；Ai是第i个单轨激光地面点的高程值；μA和σA分别是单轨激光地面点曲线高程值的均值和标准差；Cij是第j条匹配曲线上第i个单轨激光地面点的高程值；μCj和σCj分别是第j条匹配曲线高程值的均值和标准差。5.根据权利要求2所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，在步骤3.3)后，还包括步骤3.4)：控制减小设定步长和/或搜索区域，重复步骤3.2)～步骤3.3)，将最新得到的匹配结果作为所述单轨激光测高点在DSM数据上的对应轨迹。6.根据权利要求2所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，步骤3.1)之前，还包括将单轨激光测高点进行粗差剔除的步骤：采用线性插值算法替换超过三倍中位数绝对偏差的激光点。7.根据权利要求4所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，采用双三次卷积内插方法计算得到匹配曲线上单轨激光地面点的高程值。8.根据权利要求1所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，步骤5)中进行联合区域网平差的方法包括：5.1)对遥感立体影像进行特征点提取与影像匹配，得到若干连接点，并依据遥感立体影像的原始RPC参数通过空间前方交会得到连接点的初始空间坐标；5.2)星载激光测高点反投影到多景遥感立体影像上得到多个对应像点，从中选择确定所述星载激光测高点对应的基准像点和同名像点坐标；5.3)确定连接点的误差方程、以及激光测高点的误差方程和考虑平面坐标存在误差的附加方程；5.4)对步骤5.3)列出的激光测高点的误差方程和附加方程、以及连接点的误差方程进行法化答解，得到新的RPC参数、连接点空间坐标和激光测高点平面坐标的改正值；并判断是否满足阈值条件，若不满足阈值条件，则重新执行步骤5.2)～步骤5.4)，直至满足阈值条件，则输出最终得到的RPC参数、连接点空间坐标和激光测高点平面坐标的改正值。9.根据权利要求8所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，步骤5.2)中，选择侧视角最小的下视影像上的像点作为所述基准像点，相应匹配修正其它影像上对应的同名像点坐标。10.根据权利要求8所述的星载激光测高数据与遥感立体影像的联合区域网平差方法，其特征在于，所述激光测高点的误差方程和考虑平面坐标存在误差的附加方程为：式中，i为点的序号，j为遥感立体影像的序号；Δj和Δi分别为遥感立体影像RPC参数的仿射变换系数与激光测高点平面坐标的改正数；Aij和Bij分别为遥感立体影像RPC参数的仿射变换系数与激光测高点平面坐标的改正数的系数矩阵；Lij是常数项；Xi和Yi为激光测高点平面坐标的计算值，X′i和Yi′为激光测高点平面坐标的观测值；Pij、pxi、pyi为相应权矩阵和权值。
说明书desc
技术领域本发明属于遥感测绘技术领域，具体涉及一种星载激光测高数据与遥感立体影像的联合区域网平差方法。背景技术星载激光测高是一种主动遥感探测技术，具有精度高、速度快、大范围获取探测目标高程数据及其三维空间信息的优点，是对地球和行星探测不可或缺的手段。ICESat-2搭载名为ATLAS的微脉冲光子计数激光雷达于2018年9月成功发射，并于2019年4月陆续发布分级数据，可提供全球陆地表面的高精度激光脚点。因为星载激光测高的各项特点，其在全球高程测量、极地冰层测量和植被及生物量测量方面充分展现了尺度和精度上的优势，也因此引得了国内外学者的广泛关注与研究。利用卫星立体遥感影像对地面目标进行定位是目前全球测绘的主要手段，但传统定位方法需要实测地面控制点数据来保证其精度，而在某些不容易获得地面控制点的特殊区域，激光测高数据可作为控制条件有效提高影像，且已有学者开展了相关的研究。ATLAS获得了目前精度最高的激光测高点，有助于进一步提升卫星立体遥感影像的定位精度，但仍存在一些问题：由于星载激光测高仪与遥感立体测绘相机并不是搭载在同一颗卫星上，使得星载激光测高仪获取的激光点并没有对应的影像像点坐标，只能依据遥感立体影像的RPC参数计算得到。但由于遥感立体影像的RPC参数精度低于星载激光测高仪的测量精度，再加上激光点的平面坐标本身也存在一定的误差，造成直接反投影计算得到的激光点对应的影像像点坐标存在明显的误差，使得在将激光点作为控制条件使用时存在物像不一致的问题，这将会显著影响联合区域网平差的效果。也即：ATLAS没有足印相机，激光测高点平面位置无法精确确定；由于卫星立体遥感影像定向参数存在误差，影像定位精度不足，造成激光测高点的物像不一致；激光点反投影的像点坐标存有误差，导致同名像点不一致。目前的高分辨率立体遥感影像的定向参数都以有理函数模型参数的形式提供，基于RFM的区域网平差是进行目标定位的一项重要步骤。有理函数模型是多种传感器几何模型更广义的一种表达。从数学角度，可将RFM理解为直接建立起像点坐标和地面点间关系的表达式，如式、所示。式中，为影像的像方坐标归一化后的物方点坐标；pi为一般多项式；LINE_SCALE、LINE_OFF、SAMP_SCALE、SAMPLE_OFF为影像归一化参数。相较于一般的平差方法，基于有理函数模型的区域网平差直接作用于像方，不需要求解新的有理函数模型参数，而是通过将有理函数模型代入仿射变换公式，并将有理函数模型数学表达式中的归一化坐标转换为实际像方坐标，即可列出误差方程如式、所示。式中，为像点量测坐标；a0、aS、aL、b0、bS和bL为仿射变换系数；εL、εS为随机非观测误差；p、r为有理函数模型计算的像方坐标。将误差方程线性化处理后，利用最小二乘原理进行迭代计算，直至满足收敛条件。但是上述基于有理函数模型的区域网平差方法无法解决星载激光测高数据辅助立体遥感影像测量存在的物像不一致、同名点不匹配等问题。发明内容本发明提供了一种星载激光测高数据与遥感立体影像的联合区域网平差方法，用以解决平差时星载激光测高数据存在的物像不一致、同名点不匹配的问题。为解决上述技术问题，本发明所包括的技术方案以及技术方案对应的有益效果如下：本发明提供了一种星载激光测高数据与遥感立体影像的联合区域网平差方法，包括如下步骤：1)对测区的遥感立体影像进行自由区域网平差，得到改正后的遥感立体影像RPC参数；2)依据改正后的遥感立体影像RPC参数，对遥感立体影像进行密集匹配得到测区的遥感立体影像的DSM；3)对测区内的每一轨星载激光测高点与DSM进行轨迹匹配，得到每轨星载激光测高点在DSM上的对应轨迹；4)根据每轨星载激光测高点在DSM上对应轨迹点的空间坐标，利用所述改正后的遥感立体影像RPC参数对轨迹点进行反投影，求得轨迹点对应影像上的像点坐标，并作为星载激光测高点在遥感立体影像上对应的像点坐标；5)筛选若干激光测高点作为控制点，与遥感立体影像联立进行联合区域网平差，得到平差结果。上述技术方案的有益效果为：本发明将遥感立体影像与激光测高数据进行联合平差，利用轨迹匹配技术，将激光测高点与DSM进行三维匹配，并利用自由区域网平差后测区内遥感立体影像内符合精度高的优势，可以显著减轻影像RPC参数误差的影响，得到激光测高点对应的准确像点坐标，保证了物像一致性。从而有效解决了物像不一致和同名点不匹配等问题，有效提高了平差精度，有效提升了无控条件下的遥感立体影像定位精度。进一步的，步骤3)中得到每轨星载激光测高点在DSM上的对应轨迹所采用的方法包括：3.1)根据单轨激光测高点的平面坐标在DSM上差值生成一条相对应的地面曲线；3.2)按照设定步长在搜索区域内平行移动所述地面曲线，得到匹配曲线，并计算匹配曲线与所述地面曲线之间的高程相关性；所述搜索区域为地面曲线周围设定区间范围内划定的区域；3.3)选取高程相关性最强的匹配曲线作为最终的匹配结果，以得到所述单轨激光测高点在DSM上的对应轨迹。进一步的，步骤3.2)中，所述搜索区域的形状为平行四边形，且搜索区域的大小为5R*5R，R为设定精度要求。进一步的，步骤3.2)中，所述高程相关性为高程相关系数，且采用下式计算所述高程相关系数：式中，N是单轨激光测高点包含的单轨激光地面点数量；Ai是第i个单轨激光地面点的高程值；μA和σA分别是单轨激光地面点曲线高程值的均值和标准差；Cij是第j条匹配曲线上第i个单轨激光地面点的高程值；μCj和σCj分别是第j条匹配曲线高程值的均值和标准差。进一步的，为了提高匹配精度以进一步保证物像一致型和同名点匹配性，在步骤3.3)后，还包括步骤3.4)：控制减小设定步长和/或搜索区域，重复步骤3.2)～步骤3.3)，将最新得到的匹配结果作为所述单轨激光测高点在DSM数据上的对应轨迹。进一步的，步骤3.1)之前，还包括将单轨激光测高点进行粗差剔除的步骤：采用线性插值算法替换超过三倍中位数绝对偏差的激光点。进一步的，采用双三次卷积内插方法计算得到匹配曲线上单轨激光地面点的高程值。进一步的，为了消除影像RPC参数的误差和激光测高点的平面坐标误差以得到更精确的RPC参数和激光测高点平面坐标的改正值，步骤5)中进行联合区域网平差的方法包括：5.1)对遥感立体影像进行特征点提取与影像匹配，得到若干连接点，并依据遥感立体影像的原始RPC参数通过空间前方交会得到连接点的初始空间坐标；5.2)星载激光测高点反投影到多景遥感立体影像上得到多个对应像点，从中选择确定所述星载激光测高点对应的基准像点和同名像点坐标；5.3)确定连接点的误差方程、以及激光测高点的误差方程和考虑平面坐标存在误差的附加方程；5.4)对步骤5.3)列出的激光测高点的误差方程和附加方程、以及连接点的误差方程进行法化答解，得到新的RPC参数、连接点空间坐标和激光测高点平面坐标的改正值；并判断是否满足阈值条件，若不满足阈值条件，则重新执行步骤5.2)～步骤5.4)，直至满足阈值条件，则输出最终得到的RPC参数、连接点空间坐标和激光测高点平面坐标的改正值。进一步的，步骤5.2)中，选择侧视角最小的下视影像上的像点作为所述基准像点，相应匹配修正其它影像上对应的同名像点坐标。进一步的，所述激光测高点的误差方程和考虑平面坐标存在误差的附加方程为：式中，i为点的序号，j为遥感立体影像的序号；Δj和Δi分别为遥感立体影像RPC参数的仿射变换系数与激光测高点平面坐标的改正数；Aij和Bij分别为遥感立体影像RPC参数的仿射变换系数与激光测高点平面坐标的改正数的系数矩阵；Lij是常数项；Xi和Yi为激光测高点平面坐标的计算值，X′i和Y′i为激光测高点平面坐标的观测值；Pij、pxi、pyi为相应权矩阵和权值。附图说明图1是本发明的星载激光测高数据与遥感立体影像的联合区域网平差方法的流程图；图2是本发明的匹配搜索区域的俯视图；图2是本发明的匹配搜索区域的立体图；图3是本发明的轨迹匹配方法的流程图；图4是本发明的顾及激光测高点坐标误差的迭代求解方法流程图。具体实施方式本发明提出了将星载激光测高数据与遥感立体影像联合平差的新方法。具体改进点包括：首先，为了解决星载激光测高数据的物像不一致的问题，以显著提高平差结果的精度，本发明提出了一种轨迹匹配方法，具体为：将单轨激光测高点与影像自由区域网平差后密集匹配生成的DSM进行匹配，得到每个激光测高点在DSM上的对应位置，然后按照DSM上的点坐标依据自由网平差后的影像定向参数计算激光测高点对应的像点坐标。该方法通过激光测高轨迹和DSM的三维匹配，并利用自由区域网平差后测区内遥感立体影像内符合精度高的优势，可以显著减轻影像RPC参数误差的影像，得到激光测高点对应的准确像点坐标，保证了物像一致性。其次，尽管通过轨迹匹配方法已经减轻了激光测高点物像不一致问题的影响，但影像RPC参数的误差和激光测高点的平面坐标误差仍未完全消除，因此本发明在区域网联合平差解算中采用一种顾及激光测高点坐标误差的迭代求解方法，可以得到更精确的影像PRC参数和激光测高点平面坐标的改正数。基于上述两点改进可实现本发明的一种星载激光测高数据与遥感立体影像的联合区域网平差方法。下面结合附图及实施例，对该方法进行详细说明。方法实施例：本发明的一种星载激光测高数据与遥感立体影像的联合区域网平差方法实施例，其整体流程如图1所示。步骤一，对测区的遥感立体影像数据进行自由网平差，得到改正后的遥感立体影像RPC参数。步骤二，依据改正后的遥感立体影像RPC参数，对遥感立体影像进行密集匹配，得到测区的DSM。步骤三，对测区内每一轨星载激光测高点与DSM进行轨迹匹配，得到每轨星载激光测高点在DSM上的对应轨迹。其中，单轨星载激光测高点与高精度参考DSM数据进行匹配的思路是：首先根据单轨激光点的平面坐标在自由区域网平差后生成的DSM内插生成一条相对应的地面曲线，以该地面点曲线为中心，在经纬度方向分别设定一定的位移区间以形成一个如图2所示的平行四边形搜索区域，其中m、n分别表示在维度、经度方向的移动次数，△b、△l分别表示在纬度、经度方向的移动步长；然后按照一定的步长在搜索区域内平行移动与单轨激光点大小一致的匹配曲线并计算其与单轨激光点之间的高程相关系统所示)，选取其中相关系数最大的曲线作为匹配结果，得到每轨激光测高点在DSM上的对应轨迹，即得到每一个激光点在DSM上的对应坐标。进行轨迹匹配的具体流程如图3所示：1)选择2-3km长度的单轨激光测高点，进行粗差剔除，采用线性插值算法替换超过三倍中位数绝对偏差的激光点。2)由激光测高点初始平面坐标内插得到对应DSM的高程坐标。3)根据精度要求确定一定大小的平行四边形搜索区域，设精度要求为R，则搜索区域大小一般为5R*5R。4)以激光测高点的原始平面坐标为初值，在搜索区域内按照一定的步长移动对应的地面曲线，移动后的地面曲线称为匹配曲线。5)利用双三次卷积内插方法，计算得到匹配曲线点对应的高程值。6)利用式计算移匹配曲线与地面曲线之间的高程相关系数：式中，N是单轨激光测高点包含的单轨激光地面点数量；Ai是第i个单轨激光地面点的高程值；μA和σA分别是单轨激光地面点曲线高程值的均值和标准差；Cij是第j条匹配曲线上第i个单轨激光地面点的高程值；μCj和σCj分别是第j条匹配曲线高程值的均值和标准差。7)遍历搜索区域，确定相关系数最大的匹配曲线。8)如果需要进一步提升精度，则可以减小R和移动步长，重复3)～步骤7)，直至满足精度要求。9)得到该轨激光测高点在自由区域网DSM上的对应轨迹。步骤四，根据每轨星载激光测高点在DSM上对应轨迹的空间坐标，利用改正后的遥感立体影像RPC参数对其进行反投影，求得其对应影像上的像点坐标。步骤五，依据测高点的类别、类别置信度、局部地形坡度等约束条件，对全部星载激光测高数据进行筛选，保留置信度高且局部地形平坦的地面激光测高点作为控制点。步骤六，将筛选后的激光测高点作为控制条件，与遥感立体影像联立进行顾及激光测高点平面坐标误差的光束法联合区域网平差，得到精度更高的遥感立体影像RPC参数、连接点空间坐标和激光测高点平面坐标的改正值。其中，顾及激光测高点平面坐标误差的光束法联合区域网平差的过程如图4所示：1)输入数据，即遥感立体影像、星载激光测高点三维坐标及其对应的像点坐标。2)利用SIFT等点特征提取算子和相关系数灰度、最小二乘匹配算法进行影像匹配得到大量连接点。3)依据影像RPC参数通过前方交会得到连接点的初始空间坐标。4)考虑到星载激光测高点可能会反投影到多景立体影像上，此时在多景影像中选择侧视角最小的下视影像上的像点作为基准像点，利用最小二乘匹配算法得到其它景影像上的同名像点坐标。5)分别对激光测高点和立体影像连接点组建误差方程。对于激光测高点，按式列出误差方程和考虑平面坐标存在误差的附加方程：式中，i为点的序号，j为遥感立体影像的序号；Δj和Δi分别为遥感立体影像RPC参数的仿射变换系数与激光测高点平面坐标的改正数，Aij和Bij分别为遥感立体影像RPC参数的仿射变换系数与激光测高点平面坐标的改正数的系数矩阵，Lij是常数项；Xi和Yi为激光测高点平面坐标的计算值，X′i和Y′i为激光测高点平面坐标的观测值；Pij、pxi、Pyi为相应权矩阵和权值。对于遥感立体影像连接点，按照式列出误差方程：Vkj＝AkjΔj+BkjΔk-Lkj Pkj 式中，k为点的序号，j为遥感立体影像的序号；Δj和Δk分别为遥感立体影像RPC参数的仿射变换系数与连接点平面坐标的改正数；Akj和Bkj分别为遥感立体影像RPC参数的仿射变换系数与连接点平面坐标的改正数的系数矩阵；Lkj是常数项；Pkj为相应权矩阵。6)对公式的误差方程和附加方程、以及公式的误差方程进行法化答解，得到RPC参数、连接点空间坐标和激光测高点平面坐标的改正数。7)根据设定阈值对RPC参数、连接点空间坐标和激光测高点平面坐标的改正数计算结果进行判断，若不满足阈值条件，则计算新的RPC参数、连接点空间坐标和激光测高点平面坐标，重复步骤3～步骤7)。8)若满足阈值条件，则计算新的RPC参数、连接点空间坐标和激光测高点平面坐标，输出平差结果。综上，该方法通过单轨星载激光测高点与立体遥感影像自由网平差生成的DSM进行轨迹匹配，以及反投影算法得到激光测高点对应的像点坐标，然后采用顾及激光测高点平面坐标误差的光束法联合区域网平差方案，得到了更高精度的遥感立体影像定向参数。综合考虑星载激光测高点与卫星遥感立体影像的物方与像方坐标误差，利用轨迹匹配与联合区域网平差等关键技术，重点解决了物像不一致和同名点不匹配等问题，可以有效提高平差精度，有效提升遥感立体影像的无控定位精度。
