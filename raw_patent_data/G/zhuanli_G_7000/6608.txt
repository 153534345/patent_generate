标题title
一种人机协作方法及系统
摘要abst
本发明提供了一种人机协作方法及系统，一方面，所述方法包括：S1，通过第一相机获取协作场景图像；S2，基于协作场景图像判断协作场景类型；S3，通过第二相机获取人体动作图像；S4，基于所述人体动作图像获取人体手部的起始位置；S5，基于所述协作场景类型获取人体手部的终点位置；S6，基于所述起始位置和所述终点位置对人体手部的移动轨迹进行预测，获得预测轨迹；S7，基于所述预测轨迹获取机器人的规划路径。另一方面，本发明还提供了相应的系统用于实现所述方法。本发明使机器人的路径规划系统能够感知协作场景和操作者的任务意图，并基于这些预测执行相应的预期运动，实现机器人与机器人使用者之间的流畅、高效的协作。
权利要求书clms
1.一种人机协作方法，其特征在于，包括：S1，通过第一相机获取协作场景图像；S2，基于所述协作场景图像判断协作场景类型；S3，通过第二相机获取人体动作图像；S4，基于所述人体动作图像获取人体手部的起始位置；S5，基于所述协作场景类型获取人体手部的终点位置；S6，基于所述人体手部的起始位置和所述人体手部的终点位置对人体手部的移动轨迹进行预测，获得预测轨迹；S7，基于所述预测轨迹获取机器人的规划路径。2.根据权利要求1所述的一种人机协作方法，其特征在于，所述基于所述协作场景图像判断协作场景类型，包括：获取所述协作场景图像的特征信息；将所述特征信息与场景数据库中预存的场景类型特征信息进行匹配，获取协作场景图像的特征信息对应的场景类型。3.根据权利要求1所述的一种人机协作方法，其特征在于，所述第二相机包括双目RGB相机或TOF相机或结构光相机。4.根据权利要求1所述的一种人机协作方法，其特征在于，所述基于所述人体动作图像获取人体手部的起始位置，包括：对所述人体动作图像进行图像识别处理，获取所述人体动作图像中的手部区域的像素点；基于人体动作图像中包含的深度信息获取所述手部区域的像素点在全局坐标系中的三维空间坐标；计算所有属于手部区域的像素点的平均三维空间坐标，将所述平均三维空间坐标作为人体手部的起始位置。5.根据权利要求2所述的一种人机协作方法，其特征在于，所述获取所述协作场景图像的特征信息，包括：将所述协作场景图像转换为灰度图像；对所述灰度图像进行亮度调节处理，获得调节图像；对所述调节图像进行降噪处理，获得降噪图像；对所述降噪图像进行图像分割处理，获得前景图像；使用预设的特征获取算法获取所述前景图像中包含的特征信息。6.一种人机协作系统，其特征在于，包括第一相机模块、第一图像处理模块、第二相机模块、第二图像处理模块、终点获取模块、轨迹预测模块和路径规划模块；所述第一相机模块用于通过第一相机获取协作场景图像；所述第一图像处理模块用于基于协作场景图像判断协作场景类型；所述第二相机模块用于通过第二相机获取人体动作图像；所述第二图像处理模块用于基于所述人体动作图像获取人体手部的起始位置；所述终点获取模块用于基于所述协作场景类型获取人体手部的终点位置；所述轨迹预测模块用于基于人体手部的起始位置和所述人体手部的终点位置对人体手部的移动轨迹进行预测，获得预测轨迹；所述路径规划模块用于基于所述预测轨迹获取机器人的规划路径。
说明书desc
技术领域本发明涉及人机协作领域，尤其涉及一种人机协作方法及系统。背景技术协作机器人就是在机器人与人可以在生产线上协同作战，充分发挥机器人的效率及人类的智能。这种机器人不仅性价比高，而且安全方便，能够极大地促进制造企业的发展。现有技术中，对于人机协作场景，一般需要手动选择场景类型，然后协作机器人根据预先设定的场景运动策略来进行运动。这使得协作机器人无法适应场景的快速转换，例如当需要在两种场景中来回切换时，手动选择场景显然效率不够高。使得协作机器人和机器人使用者之间的协作不够高效。发明内容鉴于上述问题，本发明的目的在于提供一种人机协作方法及系统。一方面本发明提供了一种人机协作方法，包括：S1，通过第一相机获取协作场景图像；S2，基于协作场景图像判断协作场景类型；S3，通过第二相机获取人体动作图像；S4，基于所述人体动作图像获取人体手部的起始位置；S5，基于所述协作场景类型获取人体手部的终点位置；S6，基于所述人体手部的起始位置和所述人体手部的终点位置对人体手部的移动轨迹进行预测，获得预测轨迹；S7，基于所述预测轨迹获取机器人的规划路径。优选地，所述基于所述协作场景图像判断协作场景类型，包括：获取所述协作场景图像的特征信息；将所述特征信息与场景数据库中预存的场景类型特征信息进行匹配，获取协作场景图像的特征信息对应的场景类型。优选地，所述第二相机包括双目RGB相机或TOF相机或结构光相机。优选地，所述基于所述人体动作图像获取人体手部的起始位置，包括：对所述人体动作图像进行图像识别处理，获取所述人体动作图像中的手部区域的像素点；基于人体动作图像中包含的深度信息获取所述手部区域的像素点在全局坐标系中的三维空间坐标；计算所有属于手部区域的像素点的平均三维空间坐标，将所述平均三维空间坐标作为人体手部的起始位置。优选地，所述获取所述协作场景图像的特征信息，包括：将所述协作场景图像转换为灰度图像；对所述灰度图像进行亮度调节处理，获得调节图像；对所述调节图像进行降噪处理，获得降噪图像；对所述降噪图像进行图像分割处理，获得前景图像；使用预设的特征获取算法获取所述前景图像中包含的特征信息。另一方面，本发明还提供了一种人机协作系统，包括第一相机模块、第一图像处理模块、第二相机模块、第二图像处理模块、终点获取模块、轨迹预测模块和路径规划模块；所述第一相机模块用于通过第一相机获取协作场景图像；所述第一图像处理模块用于基于协作场景图像判断协作场景类型；所述第二相机模块用于通过第二相机获取人体动作图像；所述第二图像处理模块用于基于所述人体动作图像获取人体手部的起始位置；所述终点获取模块用于基于所述协作场景类型获取人体手部的终点位置；所述轨迹预测模块用于基于人体手部的起始位置和所述人体手部的终点位置对人体手部的移动轨迹进行预测，获得预测轨迹；所述路径规划模块用于基于所述预测轨迹获取机器人的规划路径。本发明使机器人的路径规划系统能够感知协作场景和操作者的任务意图，并基于这些预测执行相应的预期运动，实现机器人与机器人使用者之间的流畅、高效的协作。附图说明利用附图对本发明作进一步说明，但附图中的实施例不构成对本发明的任何限制，对于本领域的普通技术人员，在不付出创造性劳动的前提下，还可以根据以下附图获得其它的附图。图1为本发明一种人机协作方法的一种示例性实施例图。具体实施方式下面详细描述本发明的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，仅用于解释本发明，而不能理解为对本发明的限制。本发明提供了一种人机协作方法及系统。如图1所示的一种实施例，一方面本发明提供了一种人机协作方法，包括：S1，通过第一相机获取协作场景图像；S2，基于协作场景图像判断协作场景类型；S3，通过第二相机获取人体动作图像；S4，基于所述人体动作图像获取人体手部的起始位置；S5，基于所述协作场景类型获取人体手部的终点位置；S6，基于所述人体手部的起始位置和所述人体手部的终点位置对人体手部的移动轨迹进行预测，获得预测轨迹；S7，基于所述预测轨迹获取机器人的规划路径。本发明使机器人的路径规划系统能够感知协作场景和操作者的任务意图，并基于这些预测执行相应的预期运动，实现机器人与机器人使用者之间的流畅、高效的协作。本发明提供了一种人机协作方法，先通过第一相机俯视人机协作场景，感知场景要素，判断人机协作场景的类型；然后通过双目RGB相机分析获取人体在全局坐标系下的位姿，并对动作轨迹进行检测和识别；接着对机器人使用者的终点位置和使用者的起始位置之间的相关性进行建模，基于预先训练完毕的神经网络的轨迹预测系统估计出人的预测轨迹；最后利用提供的预测值使用轨迹预测神经网络对机器人的运动路径进行规划。在人机协作场景中，本发明使得协作机器人能够感知场景与协作机器人使用者预测任务意图，并基于这些预测执行相应的预期运动，实现机器人与机器人使用者之间的流畅、高效的协作。优选地，所述基于协作场景图像判断协作场景类型，包括：获取所述协作场景图像的特征信息；将所述特征信息与场景数据库中预存的场景类型特征信息进行匹配，获取协作场景图像的特征信息对应的场景类型。具体的，场景数据库中预存了不同的场景类型的场景图像的特征信息，通过特征信息的匹配过程，将场景数据库中相似度最大的特征信息对应的场景类型作为步骤S1获得的协作图像对应的场景类型。优选地，所述基于所述协作场景类型获取人体手部的终点位置，包括：不同场景类型下人体手部的终点位置已经事先进行存储，当需要使用时，直接根据场景类型进行调用即可。优选地，所述基于所述预测轨迹获取机器人的规划路径，包括：根据机器人移动的起点和终点进行路径的规划，机器人的规划路径应该避免与人体手部的预测轨迹相碰撞。优选地，所述第二相机包括双目RGB相机或TOF相机或结构光相机。具体的，第二相机可以是各种能够获取深度信息的相机，通过深度信息来获取手部的坐标。优选地，所述基于所述人体动作图像获取人体手部的起始位置，包括：对所述人体动作图像进行图像识别处理，获取所述人体动作图像中的手部区域的像素点；基于人体动作图像中包含的深度信息获取所述手部区域的像素点在全局坐标系中的三维空间坐标；计算所有属于手部区域的像素点的平均三维空间坐标，将所述平均三维空间坐标作为人体手部的起始位置。具体的，平均三维空间坐标的计算方式与在二维空间中计算平均坐标的方法一致。优选地，所述获取所述协作场景图像的特征信息，包括：将所述协作场景图像转换为灰度图像；对所述灰度图像进行亮度调节处理，获得调节图像；对所述调节图像进行降噪处理，获得降噪图像；对所述降噪图像进行图像分割处理，获得前景图像；使用预设的特征获取算法获取所述前景图像中包含的特征信息。在一种实施例中，所述将所述协作场景图像转换为灰度图像，包括：通过如下函数对转换过程进行建模：上述函数中，表示转换过程建模函数，、、表示预设的权重系数，，grayu表示灰度图像中的所有像素点组成的集合，表示grayu中包含的像素点s的像素值，即为待求解的像素值，表示grayu中包含的像素点s在红色分量图像中对应的像素点的像素值，红色分量图像为协作场景图像在RGB颜色空间的红色分量的图像，ghu表示像素点s的预设大小的邻域中的像素点的集合；表示ghu中的像素点在红色分量图像中对应的像素点的像素值，和分别表示像素点s和像素点t在分量对应的图像中的像素值；获取使得最小时的值，将的值作为像素点s的灰度值。在上述实施例中，通过对灰度化过程进行建模，使得最终获得的灰度图像中，像素点之间的对比度与原来的协作场景图像中的像素点之间的对比度的相似度最大，从而有效地降低了灰度化过程中边界信息的丢失程度，保留了更多的细节信息。优选地，所述预设大小的邻域为以像素点s为中心的的窗口，其中Y表示像素点的数量。在另一种实施例中，所述将所述协作场景图像转换为灰度图像，包括：使用加权平均值法将所述协作场景图像转换为灰度图像。在一种实施例中，所述对所述灰度图像进行亮度调节处理，获得调节图像，包括：采用以下函数对灰度图像进行亮度调节处理：以上函数中，表示像素点v在亮度调节处理后的像素值，表示像素点v在灰度图像中的像素值，表示自适应比例系数，若，则通过如下函数计算：若，则通过如下函数计算：以上函数中，表示预设的判断阈值，表示预设的计算系数，表示预设的第一计算参数，，表示预设的第二计算参数，，表示预设的第三计算参数，，和分别表示灰度图像中的灰度值的最大值和最小值。本发明上述实施例，在亮度调节的过程中，自适应地为不同情况的像素点选取不同的自适应比例系数进行调节处理，有利于提高调节处理后获得的图像中的像素点的灰度值之间的差异程度减小，对暗部进行调亮，对高光进行压制，从而突出了边界像素点，有利于为提高调节图像中的边界信息量。在一种实施例中，所述对所述调节图像进行降噪处理，获得降噪图像，包括：对所述调节图像进行噪点检测，获取所述调节图像中包含的噪声像素点；采用预设的降噪算法对所有噪声像素点进行降噪处理，获得降噪图像。在一种实施例中，所述对所述调节图像进行噪点检测，获取所述调节图像中包含的噪声像素点，包括：步骤1：将调节图像中所有的像素点存入待检测集合中；对于中的计算像素点，使用基于PCA分析的高斯噪声检测算法对进行噪点检测，判断是否为噪声像素点，若是，则将加入到噪声像素点集合中，并将从中删除；步骤2：使用如下方式对计算像素点进行噪声点追踪计算：分别计算与其8邻域中的像素点之间的相似系数：其中，表示ipx与其8邻域中的像素点i之间的相似系数，和分别表示像素点ipx和像素点i的灰度值，和分别表示计算像素点ipx和像素点i的梯度幅值、、表示预设的比例系数，表示计算像素点ipx的邻域系数，表示像素点i的邻域系数，，表示以ipx为中心的大小的窗口中的像素点的集合，和分别表示和的像素值，表示和的直线连线经过的像素点的总数，和的计算方式相同，这里不再赘述；步骤3：获取的8邻域中与ipx之间的相似系数的最大值，判断所述最大值是否大于预设的相似系数阈值，若是，则将所述相似系数的最大值对应的像素点存入噪声像素点集合中，并将所述像素点从中删除，进入步骤4；若否，则进入步骤1；步骤4：将作为计算像素点，进入步骤2；当为空集时，噪声像素点集合中包含的像素点作为噪声像素点。在本发明上述实施例中，在对计算像素点进行噪声检测时，若检测到计算像素点为噪声像素点，便对计算像素点进行噪声点追踪计算，这种设置方式，能够有效地加快噪声点检测的效率。通过计算8邻域中的像素点与计算像素点之间的相似系数来判断8邻域中像素点是否为噪声像素点，从而避免了需要分别对每个像素点进行噪声检测的过程，有效地缩短了获得协作场景类型的时间，从而提高本发明的人机协作过程的流畅性，以及机器人响应的及时性。另一方面，本发明还提供了一种人机协作系统，包括第一相机模块、第一图像处理模块、第二相机模块、第二图像处理模块、终点获取模块、轨迹预测模块和路径规划模块；所述第一相机模块用于通过第一相机获取协作场景图像；所述第一图像处理模块用于基于协作场景图像判断协作场景类型；所述第二相机模块用于通过第二相机获取人体动作图像；所述第二图像处理模块用于基于所述人体动作图像获取人体手部的起始位置；所述终点获取模块用于基于所述协作场景类型获取人体手部的终点位置；所述轨迹预测模块用于基于所述人体手部的起始位置和所述人体手部的终点位置对人体手部的移动轨迹进行预测，获得预测轨迹；所述路径规划模块用于基于所述预测轨迹获取机器人的规划路径。尽管已经示出和描述了本发明的实施例，本领域技术人员可以理解：在不脱离本发明的原理和宗旨的情况下可以对这些实施例进行多种变化、修改、替换和变形，本发明的范围由权利要求及其等同物限定。
