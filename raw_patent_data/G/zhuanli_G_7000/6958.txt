标题title
一种基于注意力机制的目标轨迹预测方法
摘要abst
本发明公开了一种基于注意力机制的轨迹预测方法，属于计算机视觉技术领域。本发明首先提取目标的位置序列；然后对每个目标利用长短期记忆网络编码获取目标轨迹特征表达，之后采用图注意力网络对目标轨迹之间的交互特征进行融合处理，并基于注意力机制得到目标轨迹各历史时刻之间的时序特征，最后将融合了交互特征与时序特征的目标轨迹特征作为长短期记忆网络的输入，解码并计算得到目标的预测位置。本发明基于对目标关系进行推理并通过注意力机制引入时序特征提高轨迹预测的准确率。
权利要求书clms
1.一种基于注意力机制的目标轨迹预测方法，其特征在于，包括以下步骤：步骤1.采集视频数据集中各目标的历史轨迹，得到各目标的历史轨迹数据集；步骤2.基于目标的历史轨迹数据集，利用长短期记忆网络LSTM，提取各目标在历史时刻t处的第一隐藏状态；具体步骤包括：计算目标i在每个历史时刻与上一个历史时刻的历史相对位置，将历史相对位置通过嵌入函数，计算得到目标i在历史时刻t的位置向量再将输入长短期记忆网络LSTM中，得到目标i在历史时刻t处长短期记忆网络LSTM输出的第一隐藏状态其中i∈；步骤3.建立目标间的初始关联关系，将各目标的第一隐藏状态作为图注意力网络中对应节点的输入；然后通过该图注意力网络对目标i融合与相邻目标的轨迹交互特征；再基于注意力机制对目标i融合各历史时刻，得到目标i在最后一个历史时刻Tobs的联合隐藏状态步骤4.将目标i在最后一个历史时刻Tobs的联合隐藏状态输入长短期记忆网络D-LSTM进行解码，得到目标i在第一预测时刻Tobs+1的预测相对位置；再将该预测相对位置作为下一预测时刻的历史相对位置，然后返回步骤2，计算更新后的下一预测时刻的预测相对位置，依次迭代，得到所有后续预测时刻的预测相对位置，最终得到目标i的轨迹预测结果。2.如权利要求1所述的一种基于注意力机制的目标轨迹预测方法，其特征在于，步骤3包括以下步骤：3-1.建立目标间的初始关联关系；3-2.对于目标i，基于图注意力网络融合与相邻目标的轨迹交互特征，得到第二隐藏状态3-3.将目标i在各历史时刻的第二隐藏状态输入另一图注意力网络，引入注意力机制，计算第二隐藏状态在最后一个历史时刻Tobs与之前的各历史时刻t之间的相关性再计算目标i在最后一个历史时刻Tobs处长短期记忆网络LSTM输出的联合隐藏状态
说明书desc
技术领域本发明涉及计算机视觉技术领域，具体涉及一种基于注意力机制的目标轨 迹预测方法。背景技术随着科学技术的发展，各种各样的定位设备不断涌现，使得获取物体轨迹 数据的难度大大降低，获取到的轨迹数据数量与种类迅速增长，其中许多轨迹 数据有着巨大的研究价值。对获取的轨迹数据进行储存并分析，在目标行为识 别、交通规划、城市安全与防控等方面都可以发挥重要作用。轨迹预测的主要任务是根据目标的历史轨迹数据预测目标未来的轨迹点， 预测目标的轨迹如何发展以及在具体某时刻的位置对于研究挖掘目标的行为模 式和详细信息有着重要意义。轨迹预测的理解推理能力，可以推进对人类行为 动作的分析与预测研究，将人工智能在视觉、语音领域的成功进一步扩大，推 广到获取更高级的认知、分析、推理能力。因此，对目标轨迹进行有效的分析， 是实现人工智能落地到人类生活的关键环节。轨迹预测的关键挑战在于预测目标行为的复杂性和外界因素的多样性。运 动行为会受到自身的目标意图、周围目标的存在和行为、目标之间的关联关系 和社会规则约束等因素的影响。根据轨迹预测方法中使用技术的不同可以分为 两类，一类是基于传统的数学统计模型进行建模预测，一类是通过神经网络模 型进行建模预测。基于传统的数学统计模型方法在输入的轨迹数据呈线性化时 处理效果更好。而基于神经网络模型的方法更适用于在处理非线性数据，但对 与网络的输入数据信息要求较高。由于循环神经网络在处理时序信息方面的优势，基于深度学习的轨迹方法 基本上都在网络结构中使用该网络提取序列特征。同时轨迹预测任务除了目标 轨迹序列作为模型输入外，也可以输入图像辅助提升预测效果。除此之外，还 有一些方法通过利用时空信息特征提升预测效果。但针对单一特征的方法难以 捕捉目标之间的关联关系，并且在预测过程由于较长时间间隔的预测所引发的 误差增大问题仍难以解决。发明内容为了解决现有轨迹预测方法难以有效处理目标交互建模，预测误差不断增 大的问题，本发明提出了一种基于注意力机制的目标轨迹预测方法，该方法融 合多种特征进行轨迹预测，能够更充分的利用目标间的关联关系，并通过注意 力机制引入时空特征，从而提高预测准确率。为了达到上述目的，本发明采用的技术方案如下：一种基于注意力机制的目标轨迹预测方法，包括以下步骤：步骤1.采集视频数据集中各目标的历史轨迹，得到各目标的历史轨迹数据 集；步骤2.基于目标的历史轨迹数据集，利用长短期记忆网络LSTM，提取各目 标在历史时刻t处的第一隐藏状态；具体步骤包括：计算目标i在每个历史时刻与上一个历史时刻的历史相对位 置，将历史相对位置通过嵌入函数，计算得到目标i在历史时刻t的位置向量再将输入长短期记忆网络LSTM中，得到目标i在历史时刻t处长短期记忆网络 LSTM输出的第一隐藏状态其中i∈；步骤3.建立目标间的初始关联关系，将各目标的第一隐藏状态作为图注 意力网络中对应节点的输入；然后通过该图注意力网络对目标i融合与相邻目标 的轨迹交互特征；再基于注意力机制对目标i融合各历史时刻，得到目标i在历史 时刻Tobs的联合隐藏状态；具体步骤包括：3-1.建立目标间的初始关联关系；3-2.对于目标i，基于图注意力网络融合与相邻目标的轨迹交互特征，得到 第二隐藏状态3-3.将目标i在各历史时刻的第二隐藏状态输入另一图注意力网络，引入 注意力机制，计算第二隐藏状态在最后一个历史时刻Tobs与之前的各历史时刻t 之间的相关性再计算目标i在最后一个历史时刻Tobs处长短期记忆网络 LSTM输出的联合隐藏状态步骤4.将目标i在历史时刻Tobs的联合隐藏状态输入长短期记忆网络 D-LSTM进行解码，得到目标i在第一预测时刻Tobs+1的预测相对位置；再将该预 测相对位置作为下一预测时刻的历史相对位置，然后返回步骤2，计算更新后的 下一预测时刻的预测相对位置，依次迭代，得到所有后续预测时刻的预测相对 位置，最终得到目标i的轨迹预测结果。本发明的一种基于注意力机制的目标轨迹预测方法，解决了现有轨迹预测 方法难以有效分析目标间的关联关系，预测准确率不高的问题。其核心思想是 提取目标的位置序列；然后对每个目标利用长短期记忆网络编码获取目标轨迹 特征表达，之后采用图注意力网络对目标轨迹之间的交互特征进行融合处理， 并基于注意力机制得到目标轨迹各历史时刻之间的时序特征。最后，将融合了 交互特征与时序特征的目标轨迹特征作为长短期记忆网络的输入，解码并计算 得到目标的预测位置。本发明正是基于对目标关系进行推理并通过注意力机制 引入时序特征提高轨迹预测的准确率。与现有技术相比，本发明将自然语言处理中的注意力机制方法应用到目标 轨迹预测中，缓解了轨迹预测方法中预测结果误差随预测间隔增大的现象，从 输入特征的角度处理，使得结果和模型计算更具有说服力。附图说明图1为本发明的总体流程图。具体实施方式下面结合附图对本发明做进一步说明：如图1所示，本发明中的基于注意力机制的轨迹预测方法包括以下步骤：步骤1.采集视频数据集中各目标的历史轨迹，得到各目标的历史轨迹数据 集；步骤2.基于目标的历史轨迹数据集，利用长短期记忆网络LSTM，提取各目 标在历史时刻t处的隐藏状态；具体步骤如下：2-1.假设共有N个目标，目标i在历史时刻t的位置坐标为i∈ ，t∈{1,…,Tobs}，在预测时刻tq的预测位置坐标为tq∈ {Tobs+1,Tobs+2,…,Tpred}。2-2.计算目标i在每个历史时刻与上一个历史时刻的历史相对位置2-3.将历史相对位置通过嵌入函数F，计算得到目标i在历史时刻t的位置向 量再将输入长短期记忆网络LSTM中，得到目标i在历史时刻t处长短期记 忆网络LSTM输出的第一隐藏状态其中，F为嵌入函数，Wl是长短期记忆网络单元的权重。步骤3.建立目标间的初始关联关系，将各目标的第一隐藏状态作为图注 意力网络中对应节点的输入；然后通过该图注意力网络对目标i融合与相邻目标 的轨迹交互特征；再基于注意力机制对目标i融合各历史时刻间注意力相关性， 得到目标i在历史时刻Tobs的联合隐藏状态；具体步骤如下：3-1.建立目标间的初始关联关系：默认设定场景下目标之间相互关联，基 于目标数量，建立目标之间全连接的关系图。3-2.对于目标i，基于图注意力网络融合与相邻目标的轨迹交互特征。3-2-1.将各目标的第一隐藏状态作为图注意力网络中对应节点的输入，计 算在各历史时刻t下，不同目标节点对{|j∈Ni}之间的注意力系数：其中，||表示连接操作，表示在历史时刻t时目标j对目标i的注意力系数， Ni表示关系图中目标i的相邻目标集，j表示目标i的相邻目标的序号，表示目标 j在历史时刻t处长短期记忆网络LSTM输出的第一隐藏状态，表示目标i的任一 相邻目标k在历史时刻t处长短期记忆网络LSTM输出的第一隐藏状态， W、a均是可学习变量，无具体含义。3-2-2.计算得到各目标节点对{|j∈Ni}在历史时刻t的注意力系数后， 再通过该图注意力网络计算目标i在历史时刻t时，融合了与相邻目标的轨迹交互 特征后长短期记忆网络LSTM输出的第二隐藏状态其中，σ表示非线性函数。3-3.将目标i在各历史时刻的第二隐藏状态输入另一图注意力网络，即引 入注意力机制，计算在历史时刻Tobs的第二隐藏状态与各历史时刻 t的第二隐藏状态之间的相关性其中＜.,.＞是内积运算符，为计算过程中间变量，无具体含义，表 示目标i在历史时刻Tobs处融合了与相邻目标的轨迹交互特征后的第二隐藏状态。计算目标i在历史时刻Tobs处长短期记忆网络LSTM输出的联合隐藏状态 步骤4.将目标i在历史时刻Tobs的联合隐藏状态输入长短期记忆网络 D-LSTM进行解码，得到目标的轨迹预测结果。具体步骤如下：4-1.将目标i在历史时刻Tobs的联合隐藏状态加入噪音向量，然后输入 长短期记忆网络D-LSTM进行解码，得到目标i在预测时刻Tobs+1的预测相对位置具体计算过程如下：其中Z代表噪音向量，表示融合了噪音向量后目标i在历史时刻Tobs处的 中间状态，该中间状态作为D-LSTM网络的初始输入，表示目标i在预测时 刻Tobs+1经D-LSTM网络输出的隐藏状态，δ3表示线性层，表示目标i在历 史时刻Tobs的位置向量，WD是可学习训练参数。4-2.在获得目标i在预测时刻Tobs+1的预测相对位置之后，将该预测相对位 置作为下一预测时刻的历史相对位置，即对于预测时刻Tobs+2，其历史时刻更新 为{1,2,…,Tobs,Tobs+1}，然后返回步骤2，计算下一预测时刻的预测相对位置， 依次迭代，得到所有后续预测时刻的预测相对位置。4-3.根据目标i在每个预测时刻的预测相对位置，得到目标i的轨迹预测结 果。本发明先通过长短期记忆网络提取目标的历史轨迹特征，之后设定目标间 的关联关系，并通过图注意力网络融合目标轨迹特征，模拟目标交互，再通过 注意力机制为每个目标融合不同时刻的轨迹特征，得到最终用于预测的目标轨 迹特征，最后通过长短期记忆网络解码得到最终的轨迹预测结果。本发明将自然语言处理中的注意力机制方法应用到目标轨迹预测中，缓解 轨迹预测方法中预测结果误差随预测间隔增大的现象，在人力、时间成本上大 大减少，从而使得结果更加的准确，有效。以上所述，仅为本发明的具体实施 方式，但本发明的保护范围并不局限于此，任何属于本技术领域的技术人员在 本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保 护范围之内。
