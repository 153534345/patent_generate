标题title
设备监测信息的管理方法及系统
摘要abst
本发明公开了设备监测信息的管理方法及系统，涉及设备管理技术领域。该方法包括：将获取的设备状态信息拆分为N个监测点信息并解析；如果设备状态管理表中不存在第i个监测点，则将第i个监测点加入设备状态管理表中；如果存在，则判断第i个监测点是否出现故障；如果出现故障，则判断设备状态管理表中第i个监测点的状态是否为正常；如果正常，则将设备状态管理表中第i个监测点的故障计数器加1；判断第i个监测点的故障计数器是否大于预设的故障门限，如果第i个监测点的故障计数器大于故障门限，则将第i个监测点置为故障。本发明适用于设备监测信息的管理，能够有效消除虚警，并方便扩展监测点。
权利要求书clms
1.一种设备监测信息的管理方法，其特征在于，包括：获取设备状态信息，将所述设备状态信息拆分为N个监测点信息；对所述N个监测点信息进行解析，得到每个监测点的监测点ID和监测点状态；根据第i个监测点的监测点ID在预设的设备状态管理表中查找是否存在所述第i个监测点；如果所述设备状态管理表中不存在所述第i个监测点，则以监测点ID为键值，将所述第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在所述设备状态管理表中，并设置本次接收到的状态为初始状态；如果所述设备状态管理表中存在所述第i个监测点，则根据所述监测点状态判断所述第i个监测点是否出现故障；如果所述第i个监测点出现故障，则判断所述设备状态管理表中所述第i个监测点的状态是否为正常；如果所述设备状态管理表中所述第i个监测点的状态为正常，则将所述设备状态管理表中所述第i个监测点的故障计数器加1；判断所述第i个监测点的故障计数器是否大于预设的故障门限，如果所述第i个监测点的故障计数器大于所述故障门限，则将所述第i个监测点置为故障；其中，i＝1,2,…,N，N为监测点的数量。2.根据权利要求1所述的设备监测信息的管理方法，其特征在于，所述管理方法还包括：如果所述第i个监测点的故障计数器不大于所述故障门限，则仅更新所述设备状态管理表中所述第i个监测点的更新时间，不改变所述第i个监测点监测点状态。3.根据权利要求1所述的设备监测信息的管理方法，其特征在于，对所述N个监测点信息进行解析，还包括：得到每个监测点的监测点文本；所述管理方法还包括：如果所述设备状态管理表中所述第i个监测点的状态为故障，则更新所述设备状态管理表中所述第i个监测点的监测点文本和更新时间。4.根据权利要求3所述的设备监测信息的管理方法，其特征在于，所述管理方法还包括：如果所述第i个监测点未出现故障，则更新所述设备状态管理表中所述第i个监测点的监测点文本和更新时间，并将故障计数器置0。5.根据权利要求3所述的设备监测信息的管理方法，其特征在于，对所述N个监测点信息进行解析，还包括：得到每个监测点的监测点类型；所述管理方法还包括：还包括：如果所述设备状态管理表中不存在所述第i个监测点，则以所述监测点ID为键值，将所述第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在所述设备状态管理表中，并记录更新时间。6.根据权利要求1至5中任一项所述的设备监测信息的管理方法，其特征在于，所述管理方法还包括：获取查询ID，根据所述查询ID对所述设备状态管理表中的监测点信息进行查询；其中，所述查询ID由监测点ID与掩码进行按位与操作形成，所述掩码为与监测点ID长度相同的无符号整数。7.根据权利要求6所述的设备监测信息的管理方法，其特征在于，根据所述查询ID对所述设备状态管理表中的监测点信息进行查询，具体包括：判断所述查询ID在所述设备状态管理表中是否存在，如果所述查询ID在所述设备状态管理表中存在，则返回对应监测点的监测点信息；如果所述查询ID在所述设备状态管理表中不存在，则表示所述查询ID对应一个上级监测点，对所述上级监测点的全部所属下级监测点的监测点信息进行汇总，并返回汇总后的监测点信息。8.根据权利要求7所述的设备监测信息的管理方法，其特征在于，对所述上级监测点的全部所属下级监测点的监测点信息进行汇总，具体包括：遍历所述设备状态管理表，将其中的每个监测点ID与所述掩码进行按位与操作，得到处理结果；如果存在处理结果与所述查询ID相同的目标监测点，则确定所述目标监测点为所述上级监测点的下级监测点，并将所述目标监测点加入到所述上级监测点的队列中；设置离线计数器、故障计数器、降级计数器和正常计数器，分别对所述上级监测点的队列中的每个下级监测点的监测点状态进行统计，得到离线计数器的值Co、故障计数器的值Cf、降级计数器的值Cd和正常计数器的值Cn；如果Cf＞0，则置所述上级监测点的状态为故障；如果Cf＝0，Cd＞0，则置所述上级监测点的状态为降级；如果Cf＝0，Cd＝0，Co＞0，则置所述上级监测点的状态为离线；如果Cf＝0，Cd＝0，Co＝0，Cn＞0，则置所述上级监测点的状态为正常；如果Cf＝0，Cd＝0，Co＝0，Cn＝0，则置所述上级监测点的状态为未知。9.根据权利要求1所述的设备监测信息的管理方法，其特征在于，所述管理方法还包括：设置超时门限，根据所述超时门限检查所有的监测点，如果存在更新时间大于所述超时门限的超时监测点，则将所述超时监测点的状态更新为离线。10.一种设备监测信息的管理系统，其特征在于，包括：接收控制器，用于获取设备状态信息，将所述设备状态信息拆分为N个监测点信息；解析控制器，用于对所述N个监测点信息进行解析，得到每个监测点的监测点ID和监测点状态；根据第i个监测点的监测点ID在预设的设备状态管理表中查找是否存在所述第i个监测点；如果所述设备状态管理表中不存在所述第i个监测点，则以监测点ID为键值，将所述第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在所述设备状态管理表中，并设置本次接收到的状态为初始状态；如果所述设备状态管理表中存在所述第i个监测点，则根据所述监测点状态判断所述第i个监测点是否出现故障；如果所述第i个监测点出现故障，则判断所述设备状态管理表中所述第i个监测点的状态是否为正常；如果所述设备状态管理表中所述第i个监测点的状态为正常，则将所述设备状态管理表中所述第i个监测点的故障计数器加1；判断所述第i个监测点的故障计数器是否大于预设的故障门限，如果所述第i个监测点的故障计数器大于所述故障门限，则将所述第i个监测点置为故障；其中，i＝1,2,…,N，N为监测点的数量。
说明书desc
技术领域本发明涉及设备管理技术领域，尤其涉及一种设备监测信息的管理方法及系统。背景技术在基于以太网的设备系统中，一般被监测设备将自身状态通过网络接口发送给监测系统。被监测设备状态信息是在设计时约定好的监测点信息的组合，比如被监测设备的总状态、电流值、电压值、风扇转速、通信链路和软件工作状态等。传统的设备监测方式是监测系统直接解析状态信息，如果有故障则给出提示，如果设备状态信息出现了虚警，也就是某个监测点偶发性变为故障，随后恢复正常，那么监测系统也会给出提示，这种故障和真正的故障本质是不一样的，需要人去区分，导致虚警问题难以解决。发明内容本发明所要解决的技术问题是针对现有技术的不足，提供一种设备监测信息的管理方法及系统。本发明解决上述技术问题的技术方案如下：一种设备监测信息的管理方法，包括：获取设备状态信息，将所述设备状态信息拆分为N个监测点信息；对所述N个监测点信息进行解析，得到每个监测点的监测点ID和监测点状态；根据第i个监测点的监测点ID在预设的设备状态管理表中查找是否存在所述第i个监测点；如果所述设备状态管理表中不存在所述第i个监测点，则以监测点ID为键值，将所述第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在所述设备状态管理表中，并设置本次接收到的状态为初始状态；如果所述设备状态管理表中存在所述第i个监测点，则根据所述监测点状态判断所述第i个监测点是否出现故障；如果所述第i个监测点出现故障，则判断所述设备状态管理表中所述第i个监测点的状态是否为正常；如果所述设备状态管理表中所述第i个监测点的状态为正常，则将所述设备状态管理表中所述第i个监测点的故障计数器加1；判断所述第i个监测点的故障计数器是否大于预设的故障门限，如果所述第i个监测点的故障计数器大于所述故障门限，则将所述第i个监测点置为故障；其中，i＝1,2,…,N，N为监测点的数量。本发明解决上述技术问题的另一种技术方案如下：一种设备监测信息的管理系统，包括：接收控制器，用于获取设备状态信息，将所述设备状态信息拆分为N个监测点信息；解析控制器，用于对所述N个监测点信息进行解析，得到每个监测点的监测点ID和监测点状态；根据第i个监测点的监测点ID在预设的设备状态管理表中查找是否存在所述第i个监测点；如果所述设备状态管理表中不存在所述第i个监测点，则以监测点ID为键值，将所述第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在所述设备状态管理表中，并设置本次接收到的状态为初始状态；如果所述设备状态管理表中存在所述第i个监测点，则根据所述监测点状态判断所述第i个监测点是否出现故障；如果所述第i个监测点出现故障，则判断所述设备状态管理表中所述第i个监测点的状态是否为正常；如果所述设备状态管理表中所述第i个监测点的状态为正常，则将所述设备状态管理表中所述第i个监测点的故障计数器加1；判断所述第i个监测点的故障计数器是否大于预设的故障门限，如果所述第i个监测点的故障计数器大于所述故障门限，则将所述第i个监测点置为故障；其中，i＝1,2,…,N，N为监测点的数量。本发明的有益效果是：本发明提供的管理方法及系统，适用于设备监测信息的管理，通过对设备状态信息进行拆分，使用故障计数器对每个监测点的故障状态进行计数，将大于预设的故障门限的故障计数器对应的监测点的状态置为故障，能够有效消除虚警，并方便扩展监测点。本发明附加的方面的优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明实践了解到。附图说明图1为本发明管理方法的实施例提供的监测点信息存储流程示意图；图2为本发明管理系统的实施例提供的结构框架示意图。具体实施方式以下结合附图对本发明的原理和特征进行描述，所举实施例只用于解释本发明，并非用于限定本发明的范围。如图1所示，为本发明管理方法的实施例提供的监测点信息存储流程示意图，该管理方法用于设备监测信息的管理，包括：S10，获取设备状态信息，将设备状态信息拆分为N个监测点信息；需要说明的是，设备状态信息由一系列监测点信息组成，监测点信息可以根据实际需求预先设置，例如，可以包括设备监测点ID、监测点类型、监测点状态、监测点文本、监测点故障门限、监测点故障计数器和监测点更新时间。监测点ID用于识别不同的监测点，监测点ID是全局唯一的。下面给出一种示例性的监测点ID组成规则：监测点ID可以设置为32位无符号整数，用D0表示最低位，D31表示最高位，D0-D7表示监测点，D8-D15表示监测点所属板卡，D16-D23表示监测点所属组合，D24-D31位表示监测点所属系统。监测点类型可以包括枚举类型和文本类型，对于枚举类型的监测点，其状态值仅取决于监测点状态，监测点文本是无效的；对于文本类型的监测点，其状态值取决于监测点状态和监测点文本两个值。监测点状态可以分为离线、故障、降级和正常。监测点文本用于记录监测的数据或者需要描述的文本，如电压值或工作过程关键动作等。监测点故障门限表示一个正常状态监测点连续出现预设次数的故障时，则认为该故障点真正故障，可以根据实际需求设置。监测点故障计数器用于记录该监测点连续出现故障的次数；监测点更新时间用于更新该监测点信息的时间。应理解，在设置完监测点信息后，可以根据监测点信息为监测点分配编号及其所属系统、组合及板卡的编号。例如，假定有两个系统，编号为1和2；系统1有2个组合，编号分别为1、2；组合1有4个板卡，编号分别为1、2、3、4；板卡1有5个监测点，编号分别为1、2、3、4、5。则按照上述约定，系统1组合1板卡1监测点1对应的监测点ID的16进制编码为0x01010101。同理，系统1组合1板卡1监测点2对应的监测点ID的16进制编码为0x01010102。其他监测点ID编码以此类推，不再赘述。S20，对N个监测点信息进行解析，得到每个监测点的监测点ID和监测点状态；可选地，在一些可能的实施方式中，对N个监测点信息进行解析，还可以得到每个监测点的监测点类型和监测点文本。S30，根据第i个监测点的监测点ID在预设的设备状态管理表中查找是否存在第i个监测点；应理解，可以将设备状态信息拆分为多个监测点信息存储与设备状态管理表中。设备状态管理表可以使用以监测点ID为主键的二叉树来管理设备监测点信息。S31，如果设备状态管理表中存在第i个监测点，则根据监测点状态判断第i个监测点是否出现故障；例如，假设按照设计约定解析信息，如果解析出了系统1组合1板卡1监测点1的状态，则监测点为0x01010101。如果存在监测点0x01010101信息，表明该节点已经存在于设备状态管理表中，则按照存储过程进行判定，继续判断是否出现故障。可选地，在一些可能的实施方式中，还包括：S32，如果设备状态管理表中不存在第i个监测点，则以监测点ID为键值，将第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在设备状态管理表中，并设置本次接收到的状态为初始状态。应理解，新存的监测点其他的如监测点故障门限和监测点故障计数器等信息可以沿用预先的设置。S41，如果第i个监测点出现故障，则判断设备状态管理表中第i个监测点的状态是否为正常；可选地，在一些可能的实施方式中，还包括：S42，如果第i个监测点未出现故障，则更新设备状态管理表中第i个监测点的监测点文本和更新时间，并将故障计数器置0。S51，如果设备状态管理表中第i个监测点的状态为正常，则将设备状态管理表中第i个监测点的故障计数器加1；可选地，在一些可能的实施方式中，还包括：S52，如果设备状态管理表中第i个监测点的状态为故障，则更新设备状态管理表中第i个监测点的监测点文本和更新时间。S61，判断第i个监测点的故障计数器是否大于预设的故障门限；S62，如果第i个监测点的故障计数器大于故障门限，则将第i个监测点置为故障；S63，如果第i个监测点的故障计数器不大于故障门限，则仅更新设备状态管理表中第i个监测点的更新时间，不改变第i个监测点监测点状态。应理解，故障门限可以根据实际需求设置，例如，可以为5，即故障计数器的故障状态次数计到6次时，才认为该监测点发生了故障。其中，i＝1,2,…,N，N为监测点的数量。本实施例提供的管理方法，适用于设备监测信息的管理，通过对设备状态信息进行拆分，使用故障计数器对每个监测点的故障状态进行计数，将大于预设的故障门限的故障计数器对应的监测点的状态置为故障，能够有效消除虚警，并方便扩展监测点。本发明管理方法还提供对监测点信息的查询，下面对监测点信息查询流程进行说明。可选地，在一些可能的实施方式中，管理方法还包括：获取查询ID，根据查询ID对设备状态管理表中的监测点信息进行查询；其中，查询ID由监测点ID与掩码进行按位与操作形成，掩码为与监测点ID长度相同的无符号整数。需要说明的是，查询ID可以由用户的终端发出，查询得到监测点信息后，可以返回给发出查询请求的终端。可选地，在一些可能的实施方式中，根据查询ID对设备状态管理表中的监测点信息进行查询，具体包括：判断查询ID在设备状态管理表中是否存在，如果查询ID在设备状态管理表中存在，则返回对应监测点的监测点信息；如果查询ID在设备状态管理表中不存在，则表示查询ID对应一个上级监测点，对上级监测点的全部所属下级监测点的监测点信息进行汇总，并返回汇总后的监测点信息。通过监测点ID和掩码结合的方式对下级监测点的监测点信息进行查询和汇总，能够实现对指定范围内的监测点信息进行统一查询，可以提高查询效率。可选地，在一些可能的实施方式中，对上级监测点的全部所属下级监测点的监测点信息进行汇总，具体包括：遍历设备状态管理表，将其中的每个监测点ID与掩码进行按位与操作，得到处理结果；如果存在处理结果与查询ID相同的目标监测点，则确定目标监测点为上级监测点的下级监测点，并将目标监测点加入到上级监测点的队列中；设置离线计数器、故障计数器、降级计数器和正常计数器，分别对上级监测点的队列中的每个下级监测点的监测点状态进行统计，得到离线计数器的值Co、故障计数器的值Cf、降级计数器的值Cd和正常计数器的值Cn；如果Cf＞0，则置上级监测点的状态为故障；如果Cf＝0，Cd＞0，则置上级监测点的状态为降级；如果Cf＝0，Cd＝0，Co＞0，则置上级监测点的状态为离线；如果Cf＝0，Cd＝0，Co＝0，Cn＞0，则置上级监测点的状态为正常；如果Cf＝0，Cd＝0，Co＝0，Cn＝0，则置上级监测点的状态为未知。例如，要获取系统1组合1板卡1的状态，则查询ID为0x01010100，掩码为0xffffff00，监测点ID为0x01010101，该ID不在设备状态管理表中，则进行状态汇总过程。假定板卡1的五个监测点状态分别为正常、离线、离线、降级、故障。则汇总时，正常计数器为1，离线计数器为2，降级计数器为1，故障计数器为1，则汇总状态为故障。要获取系统1组合1板卡1监测点1的状态，则查询ID为0x01010101，掩码为0xffffffff，监测点ID为0x01010101，该ID在设备状态管理表中，直接返回监测点0x01010101的状态。可选地，在一些可能的实施方式中，管理方法还包括：设置超时门限，根据超时门限检查所有的监测点，如果存在更新时间大于超时门限的超时监测点，则将超时监测点的状态更新为离线。需要说明的是，超时门限可以根据实际需求设置，例如，假定超时门限为2秒，在时间11:35:45更新系统1组合1板卡1监测点1的状态，之后没有再更新，监测系统在11:35:49秒监测到该节点超时，自动置该节点为离线。可以理解，在一些实施例中，可以包含如上述各实施方式中的部分或全部。如图2所示，为本发明管理系统的实施例提供的结构框架示意图，该管理系统用于设备监测信息的管理，包括：接收控制器10，用于获取设备状态信息，将设备状态信息拆分为N个监测点信息；接收控制器20，用于对N个监测点信息进行解析，得到每个监测点的监测点ID和监测点状态；可选地，在一些可能的实施方式中，对N个监测点信息进行解析，还可以得到每个监测点的监测点类型和监测点文本。根据第i个监测点的监测点ID在预设的设备状态管理表30中查找是否存在第i个监测点；如果设备状态管理表30中不存在第i个监测点，则以监测点ID为键值，将第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在设备状态管理表30中，并设置本次接收到的状态为初始状态；如果设备状态管理表30中存在第i个监测点，则根据监测点状态判断第i个监测点是否出现故障；可选地，在一些可能的实施方式中，接收控制器20还用于如果设备状态管理表30中不存在第i个监测点，则以监测点ID为键值，将第i个监测点的监测点ID、监测点状态、监测点文本和监测点类型存储在设备状态管理表30中，并记录更新时间。如果第i个监测点出现故障，则判断设备状态管理表30中第i个监测点的状态是否为正常；可选地，在一些可能的实施方式中，接收控制器20还用于如果第i个监测点未出现故障，则更新设备状态管理表30中第i个监测点的监测点文本和更新时间，并将故障计数器置0。如果设备状态管理表30中第i个监测点的状态为正常，则将设备状态管理表30中第i个监测点的故障计数器加1；可选地，在一些可能的实施方式中，接收控制器20还用于如果设备状态管理表30中第i个监测点的状态为故障，则更新设备状态管理表30中第i个监测点的监测点文本和更新时间。判断第i个监测点的故障计数器是否大于预设的故障门限，如果第i个监测点的故障计数器大于故障门限，则将第i个监测点置为故障；可选地，在一些可能的实施方式中，接收控制器20还用于如果第i个监测点的故障计数器不大于故障门限，则仅更新设备状态管理表30中第i个监测点的更新时间，不改变第i个监测点监测点状态。其中，i＝1,2,…,N，N为监测点的数量。本实施例提供的管理系统，适用于设备监测信息的管理，通过对设备状态信息进行拆分，使用故障计数器对每个监测点的故障状态进行计数，将大于预设的故障门限的故障计数器对应的监测点的状态置为故障，能够有效消除虚警，并方便扩展监测点。本发明管理系统还提供对监测点信息的查询，下面对监测点信息查询结构进行说明。可选地，在一些可能的实施方式中，管理系统还包括：故障汇总控制器40，用于获取查询ID，根据查询ID对设备状态管理表30中的监测点信息进行查询；其中，查询ID由监测点ID与掩码进行按位与操作形成，掩码为与监测点ID长度相同的无符号整数。可选地，在一些可能的实施方式中，故障汇总控制器40具体用于判断查询ID在设备状态管理表30中是否存在，如果查询ID在设备状态管理表30中存在，则返回对应监测点的监测点信息；如果查询ID在设备状态管理表30中不存在，则表示查询ID对应一个上级监测点，对上级监测点的全部所属下级监测点的监测点信息进行汇总，并返回汇总后的监测点信息。可选地，在一些可能的实施方式中，故障汇总控制器40具体用于遍历设备状态管理表30，将其中的每个监测点ID与掩码进行按位与操作，得到处理结果；如果存在处理结果与查询ID相同的目标监测点，则确定目标监测点为上级监测点的下级监测点，并将目标监测点加入到上级监测点的队列中；设置离线计数器、故障计数器、降级计数器和正常计数器，分别对上级监测点的队列中的每个下级监测点的监测点状态进行统计，得到离线计数器的值Co、故障计数器的值Cf、降级计数器的值Cd和正常计数器的值Cn；如果Cf＞0，则置上级监测点的状态为故障；如果Cf＝0，Cd＞0，则置上级监测点的状态为降级；如果Cf＝0，Cd＝0，Co＞0，则置上级监测点的状态为离线；如果Cf＝0，Cd＝0，Co＝0，Cn＞0，则置上级监测点的状态为正常；如果Cf＝0，Cd＝0，Co＝0，Cn＝0，则置上级监测点的状态为未知。可选地，在一些可能的实施方式中，还包括：离线判定控制器50，用于设置超时门限，根据超时门限检查所有的监测点，如果存在更新时间大于超时门限的超时监测点，则将超时监测点的状态更新为离线。可以理解，在一些实施例中，可以包含如上述各实施方式中的部分或全部。需要说明的是，上述各实施方式是与在先方法实施例对应的产品实施例，对于产品实施方式的说明可以参考上述各方法实施方式中的对应说明，在此不再赘述。读者应理解，在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。在本申请所提供的几个实施例中，应该理解到，所揭露的装置和方法，可以通过其它的方式实现。例如，以上所描述的方法实施例仅仅是示意性的，例如，步骤的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个步骤可以结合或者可以集成到另一个步骤，或一些特征可以忽略，或不执行。上述方法如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分，或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到各种等效的修改或替换，这些修改或替换都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以权利要求的保护范围为准。
