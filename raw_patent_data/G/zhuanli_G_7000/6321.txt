标题title
一种彩色图像局部多重水印方法
摘要abst
本发明公开了一种彩色图像局部多重水印方法，包括：对彩色的原始载体图像生成旋转不变区域；对生成的原始载体图像的旋转不变区域和水印图像进行RGB通道分离，再进行Anrold置乱；对Anrold置乱后的旋转不变区域分块奇异值分解，选取最大奇异值组成特征矩阵并将特征矩阵与Anrold置乱后的水印图像进行异或操作，得到各通道的具有版权信息的零水印图像；将得到的三个通道的零水印图像进行RGB通道合并，生成彩色零水印图像；对原始载体图像生成密钥，基于生成的密钥利用DWT_SVD方法将水印图像嵌入至原始载体图像；并且，对嵌入水印后的原始载体图像进行嵌入式水印的提取。本发明能更好的抵抗旋转攻击，平衡了局部区域构建尺度与算法性能问题，提高了算法鲁棒性。
权利要求书clms
1.一种彩色图像局部多重水印方法，其特征在于，包括以下步骤：步骤1、对彩色的原始载体图像生成旋转不变区域；步骤2、对生成的原始载体图像的旋转不变区域和水印图像分别进行RGB通道分离，再对得到的各通道的旋转不变区域和水印图像进行Anrold置乱；对Anrold置乱后的旋转不变区域分块奇异值分解，选取最大奇异值组成特征矩阵并将特征矩阵与Anrold置乱后的水印图像进行异或操作，得到各通道的具有版权信息的零水印图像；将得到的三个通道的零水印图像进行RGB通道合并，生成彩色零水印图像；步骤3、对原始载体图像生成密钥，基于生成的密钥利用DWT_SVD方法将水印图像嵌入至原始载体图像；并且，对嵌入水印后的原始载体图像进行嵌入式水印的提取，得到原水印图像。2.根据权利要求1所述的彩色图像局部多重水印方法，其特征在于，所述步骤1中选取原始载体图像内接圆的内接正方形区域作为旋转不变区域。3.根据权利要求1所述的彩色图像局部多重水印方法，其特征在于，所述步骤2中还包括将置乱参数a和b及置乱次数t作为用于彩色零水印图像认证的密钥key1进行存储。4.根据权利要求2所述的彩色图像局部多重水印方法，其特征在于，所述步骤2还包括对彩色零水印图像认证：将得到的特征矩阵与各通道的零水印图像进行异或操作，得到各通道的置乱后的水印图像；将各通道的置乱后的水印图像利用密钥key1进行逆Arnold变换，得到三通道水印图像并进行RGB通道合并，生成彩色水印图像。5.根据权利要求1所述的彩色图像局部多重水印方法，其特征在于，所述步骤3中对原始载体图像生成密钥，包括以下步骤：对原始载体图像进行RGB通道分离，得到三个通道图像；对三个通道图像分别进行SIFT运算得到各图像的特征点信息，去除旋转不变区域以外的特征点，并将余下特征点的像素值组成特征矩阵A，将特征矩阵A作为密钥key2存储。6.根据权利要求5所述的彩色图像局部多重水印方法，其特征在于，所述步骤3中基于生成的密钥利用DWT_SVD方法将水印图像嵌入至原始载体图像，包括以下步骤：提取密钥key2的特征点坐标，选取周边2*2区域并根据该区域内特征点的像素值组成64*64的局部特征矩阵B；对局部特征矩阵B及水印图像分别进行离散小波变换，得到各自的频率带，并各自选取除低频带外的其他频率带作为密钥key3保存；将各自的频率带中低频带分别进行奇异值分解，选取各自奇异值分解得到的若干矩阵作为密钥key4保存，再将水印图像得到的奇异值利用加性嵌入到水印嵌入区域奇异值；然后，对水印嵌入区域奇异值进行逆奇异值分解和逆小波变换，得到含有水印信息的特征矩阵C，最后将含有水印信息的特征矩阵C的像素值替换原始载体图像上原位置的像素值实现水印嵌入。7.根据权利要求6所述的彩色图像局部多重水印方法，其特征在于，所述步骤3中对嵌入水印后的原始载体图像进行嵌入式水印的提取，包括以下步骤：根据密钥key2提取出特征点所在位置；将特征点及周围2*2区域内特征点的像素值提取出来，构成64*64的局部特征矩阵B’；对构成的局部特征矩阵B’和原始载体图像的局部特征矩阵B分别进行离散小波变换得到各自的低频带；对各自得到的低频带进行奇异值分解后，利用逆向加性法则得到水印图像的奇异值矩阵；对水印图像的奇异值矩阵结合密钥key4进行逆奇异值分解得到水印图像小波变换后的低频带；对得到的水印图像小波变换后的低频带结合密钥key3进行逆小波变换，得到原水印图像。
说明书desc
技术领域本发明涉及一种彩色图像局部多重水印方法，属于信息安全的技术领域。背景技术随着互联网的飞速发展，数字作品广泛地传播于网络，人们可以轻易地从网络上获取作品信息。但在提高作品流传度的同时，也使得盗版现象愈发严重，严重损害作者所有权。数字水印是当前保障作品安全性和作者版权的有效手段之一，具有良好的不可见性，鲁棒性水印和多版权认证水印更是水印领域研究的目标。数字水印是将水印的数字信息直接嵌入到数字化的如图像、音视频文件等的数字载体当中，或者是修改宿主的特征信息抑或信息结构，依然具有较高的实用性，即不容易被检测出也不会被篡改，而且能够被原产权方提取识别出来。1993年，Tirkel发表的“Electronic watermark”一文中第一次出现了水印，他将其称作电子水印，也就是现在的数字水印。此后，数字水印技术在国内外迅速发展。从实现层面上讲，数字水印技术可以分为基于空域实现和基于变换域实现。早期的水 印算法是基于空域实现的，1994年，Schyndel和Tirkel提出最低有效位算法。该算法将载 体图像和水印图像像素值分解为8个比特位，利用水印最高比特位替换载体图象的最低比 特位实现水印的嵌入。后来经研究发现，基于空域的算法不可见性和鲁棒性都较差，因此 人们利用图像频域实现水印嵌入获得了高不可见性和强鲁棒性。频域水印使用的变换算法 主要有离散傅里叶变换DFT，离散余弦变换DCT和离散小波变换DWT。由于DFT变换仅 能反映信号的全局信息，并且无法处理突变信号及不平稳信号，因此相关算法较少。DCT 变换的优点在于可以将图像的能量集中，并且计算相对简单。1995年，Koch提出基于分块 DCT的数字水印算法。1996年，Cox等人提出将水印嵌入到原始图像的低频区，从而实现 更强鲁棒性的DCT水印算法。DWT变换最大的特点在于它既能对时域进行分析又可以对 频域分析。2011年，袁修贵等人提出一种基于DCT_DWT_SVD的鲁棒性水印算法，该算法将DCT变换，DWT变换以及SVD分解取长补短，实现了安全性更高的水印算法。2014 年，熊祥光等人提出了一种改进的DWT_SVD的方案，该算法对图像进行多级小波分解后 再进行奇异值分解，解决了虚警率过高问题。从水印嵌入区域上可以将水印算法分为两类，一类是全局水印，另外一类则是局部水印。局部水印根据图像局部特征构造局部区域以实现嵌入水印。图像的局部特征检测可以分为角点型和区域型两类。角点型的检测算子主要有1977年提出的Moravec算，SUSAN算子和1988年提出的基于Moravec算法改进的Harris算子等。区域型的检测算子有高斯拉普拉斯LoG检测算子，海森行列式DoH检测算子，最大稳定极值区域MSER检测算子等等。但是，以上检测算子都不能解决图像尺度问题。在同一副图像的不同尺度下，运用以上算子检测出来的特征点或特征区域可能完全不同。于是，1999年Lowe提出了尺度不变特征转换SIFT算法，并在2004年发表论文全面阐述。该算法在多尺度空间中寻找极值点，有效解决了尺度与特征问题。2006，年Bay等人改进SIFT算法，提出加速稳健特征SURF算法，提高特征点的稳健性的同时大大减少了运算时间。按水印嵌入个数可以将水印算法分为单值水印和多重水印。多重水印最早由Cox应用于视频领域，他将视频分解为帧，将不同的水印嵌入到视频的不同帧上。后来多重水印技术发展到图像上，2004年马义德等人提出了一种将DCT系数与Hadamard变换相结合的多重水印算法，拉开了国内多重水印的序幕。2007年，任馨等人提出了一种混合了鲁棒性和脆弱水印的双重水印算法，该算法水印的提取不需要原始图像。2008年，陈建东等人提出一种基于DWT变换的多重水印算法，该算法利用DWT多频率区实现了多版权保护。2010 年，张金燕基于小波包及DCT变换将灰度水印嵌入图像低频域，将彩色水印嵌入图像高频域，实现了双重水印。2011年，马睿和石云利用Hadamard变换，小波变换及奇异值分解技术实现了将空域和频域结合嵌入多重水印的算法。2020年于立军基于YIQ彩色空间利用 Zigzag-Logistic双重迭代置乱设计一种多重数字水印算法，该算法提取图像YIQ颜色空间的Y分量图像进行三级小波分解,在低频和高低频嵌入两个鲁棒水印。发明内容针对目前全局水印算法不可见性和鲁棒性之间的矛盾，抗旋转攻击差，无法解决多著作权以及局部水印算法局部区域构建大小与水印容量相互矛盾的问题，本发明提供一种彩色图像局部多重水印方法，将零水印构建特征矩阵思想应用于局部特征区域，在旋转不变区域的基础上混合嵌入式水印和零水印的局部多重水印，使数字水印解决以上问题，并能够经受多种图像攻击后提取出有效的数字水印，更好的保护数字图像版权。本发明具体采用以下技术方案解决上述技术问题：一种彩色图像局部多重水印方法，包括以下步骤：步骤1、对彩色的原始载体图像生成旋转不变区域；步骤2、对生成的原始载体图像的旋转不变区域和水印图像进行RGB通道分离，再对各通道的旋转不变区域和水印图像进行Anrold置乱；对Anrold置乱后的旋转不变区域分块奇异值分解，选取最大奇异值组成特征矩阵并将特征矩阵与Anrold置乱后的水印图像进行异或操作，得到各通道的具有版权信息的零水印图像；将得到的三个通道的零水印图像进行RGB通道合并，生成彩色零水印图像；步骤3、对原始载体图像生成密钥，基于生成的密钥利用DWT_SVD方法将水印图像嵌入至原始载体图像；并且，对嵌入水印后的原始载体图像进行嵌入式水印的提取，得到原水印图像。进一步地，作为本发明的一种优选技术方案，所述步骤1中选取原始载体图像内接圆的内接正方形区域作为旋转不变区域。进一步地，作为本发明的一种优选技术方案，所述步骤2中还包括将置乱参数a和b及置乱次数t作为用于彩色零水印图像认证的密钥key1进行存储。进一步地，作为本发明的一种优选技术方案，所述步骤2还包括对彩色零水印图像认证：将得到的特征矩阵与各通道的零水印图像进行异或操作，得到各通道的置乱后的水印图像；将各通道的置乱后的水印图像利用密钥key1进行逆Arnold变换，得到三通道水印图像并进行RGB通道合并，生成彩色水印图像。进一步地，作为本发明的一种优选技术方案，所述步骤3中对原始载体图像生成密钥，包括以下步骤：对原始载体图像进行RGB通道分离，得到三个通道图像；对三个通道图像分别进行SIFT运算得到各图像的特征点信息，去除旋转不变区域以外的特征点，并将余下特征点的像素值组成特征矩阵A，将特征矩阵A作为密钥key2存储。进一步地，作为本发明的一种优选技术方案，所述步骤3中基于生成的密钥利用DWT_SVD方法将水印图像嵌入至原始载体图像，包括以下步骤：提取密钥key2的特征点坐标，选取周边2*2区域并根据该区域内特征点的像素值组成 64*64的局部特征矩阵B；对局部特征矩阵B及水印图像分别进行离散小波变换，得到各自的频率带，并各自选取除低频带外的其他频率带作为密钥key3保存；将各自的频率带中低频带分别进行奇异值分解，选取各自奇异值分解得到的若干矩阵作为密钥key4保存，再将水印图像得到的奇异值利用加性嵌入到水印嵌入区域奇异值；然后，对水印嵌入区域奇异值进行逆奇异值分解和逆小波变换，得到含有水印信息的特征矩阵C，最后将含有水印信息的特征矩阵C的像素值替换原始载体图像上原位置的像素值实现水印嵌入。进一步地，作为本发明的一种优选技术方案，所述步骤3中对嵌入水印后的原始载体图像进行嵌入式水印的提取，包括以下步骤：根据密钥key2提取出特征点所在位置；将特征点及周围2*2区域内特征点的像素值提取出来，构成64*64的局部特征矩阵B’；对构成的局部特征矩阵B’和原始载体图像的局部特征矩阵B分别进行离散小波变换得到各自的低频带；对各自得到的低频带进行奇异值分解后，利用逆向加性法则得到水印图像的奇异值矩阵；对水印图像的奇异值矩阵结合密钥key4进行逆奇异值分解得到水印图像小波变换后的低频带；对得到的水印图像小波变换后的低频带结合密钥key3进行逆小波变换，得到原水印图像。本发明采用上述技术方案，能产生如下技术效果：本发明的方法，主要分为三个部分：旋转不变区域的生成、基于Arnold置乱和分块奇异值的零水印算法实现、基于SIFT特征点矩阵及DWT_SVD水印方法实现。本发明主要解决了现有水印算法存在的问题，为应对几何攻击中较难处理的旋转攻击，裁剪出旋转不变区域，在此区域再生成具有旋转不变性的SIFT特征点嵌入区域，能更好的抵抗旋转攻击；利用可以得到更多特征点的SIFT算法寻找特征点，为构建大容量局部特征区域做准备，针对局部区域构建尺度问题，将零水印中构建特征矩阵的思想应用于嵌入式水印中，较好地平衡了局部区域构建尺度与算法性能问题；利用DWT_SVD算法进行多重水印嵌入，实现嵌入与嵌入区域一样大小的水印图像，并且提高了算法鲁棒性；思考多重认证的解决方案，将嵌入式水印和零水印相结合的实现了多重水印方式，平衡不可见性及鲁棒性的矛盾并提高了算法性能。因此，本发明方法利用旋转不变区域及SIFT局部特征，混合DWT_SVD嵌入式水印和分块SVD零水印进行多重水印嵌入，实现数字水印不可见性与鲁棒性之间的平衡，局部区域构建大小与水印容量的平衡，抗旋转攻击以及多重认证；同时也可以通过逆过程提取出有效水印，实现本专利彩色图像的数字水印嵌入与提取，同时具备抗旋转性及多版权认证，可以更好地保护数字图像版权。附图说明图1为本发明实施例中受旋转攻击后的Lena图像。图2为本发明实施例中Lena标记图。图3为本发明实施例中受旋转攻击后的Lena标记图。图4为本发明实施例中Lena原图及狭义Arnold置乱67次后的图像。图5为本发明实施例中版权零水印的生成原理图。图6为本发明实施例中版权零水印的认证原理图。图7为本发明实施例中高斯差分金字塔的建立原理图。图8为本发明实施例中极值点检测的原理图。图9为本发明实施例中二维离散小波分解与重构的原理图。图10为本发明实施例中密钥生成的原理图。图11为本发明实施例中局部水印嵌入的原理图。图12为本发明实施例中局部水印提取的原理图。图13为本发明实施例中实验的原始载体图像。图14为本发明实施例中实验的水印图像。图15为本发明实施例中嵌入水印后的载体图像。图16为本发明实施例中受各种攻击后的载体图像。图17为本发明实施例中提取出来的水印图像。图18为本发明实施例中受攻击载体图像PSNR值。图19为本发明实施例中受攻击后水印提取NC值。具体实施方式下面结合说明书附图对本发明的实施方式进行描述。本发明涉及一种彩色图像局部多重水印方法，该方法主要包括以下步骤：步骤1、对彩色的原始载体图像生成旋转不变区域，具体如下：对于常见的水印算法，抗旋转攻击的方法主要有两种：一是利用SIFT，SURF这样具有旋转不变性算法的特征点构造局部区域，在此区域嵌入的水印可有效抵抗旋转攻击；二是通过对旋转后的图像再进行旋转矫正，更正像素位置。受旋转攻击后的图像如图1中的-所示，Lena图像在经历15度，30度，45度的旋转过程中，会有边角像素损失，并且其损失面积为四个黑色区域面积和。图1中的-为经过旋转校正后的载体图像，但也无法弥补缺失的像素。旋转攻击的厉害之处不仅在于会损失图像的像素值，并且还会改变原位置像素值，造成图像缺失，因此才难以处理。由图1可知，在旋转度数不为90度的整倍数时，图像或多或少会损失一些像素，并且经过后续旋转角度的增加发现图像旋转度数与像素损失区域有着周期性的规律，即旋转度数x损失像素值的区域与旋转角度为x mod 45相同。为了不必要的像素损失，本发明需构建一块具有相对旋转不变的区域来进行水印嵌入。从数学的角度出发，图像在进行旋转时，其内接圆区域始终保持不变。于是为了构建方形嵌入区域，本发明将Lena图像内接圆区域与内接圆的内接正方形两者之间的区域标记为白色，如图2标记图所示。由图3标记区域的旋转动态演变中不难发现，白色标记区域没有出现黑边情况。因此，本发明验证了在图像受到旋转攻击时及旋转矫正后，图像的内接圆区域不会发生像素值丢失。所以，本发明所确定的旋转不变区域便是该图像的内接圆区域，并且由于本发明采用的方形水印而选取其内接圆的内接正方形作为水印嵌入区域。因此，由旋转不变区域可知，本发明需要裁取的旋转不变区域为载体图像内接圆的内接正方形区域，根据勾股定理计算出其边长为为了更好地构建嵌入区域以进行运算，再将其缩小至边长为M/2的正方形区域，将这片区域裁剪下来，单独作为一张图像保存，并在此图像基础上生成具有版权标识的零水印。步骤2、对原始载体图像生成彩色零水印图像。本实施例对于大小为M*M的原始载体图像，n*n的水印图像，其彩色零水印图像的生成过程如图5所示，其步骤具体如下：通道分离。将步骤1生成的原始载体图像的旋转不变区域和水印图像分别进行R、 G、B通道分离，得到各通道下的原始载体图像的旋转不变区域和水印图像。进行Anrold置乱。对各通道下的原始载体图像旋转不变区域和水印图像分别进行 Anrold置乱，得到各通道Anrold置乱后的旋转不变区域和Anrold置乱后的水印图像，其中置乱参数a和b及置乱次数t作为密钥key1存储，用于后续的彩色零水印图像认证过程。分块奇异值。对各通道Anrold置乱后的旋转不变区域分块求奇异值，块的大小为M/2n，选取最大奇异值组成特征矩阵。异或生成灰度零水印图像。将Anrold置乱得到的特征矩阵与置乱后的水印图像进行异或操作，得到各通道的具有版权信息的灰度零水印图像。零水印通道合并。将得到的三个通道的零水印图像进行R、G、B通道合并，生成彩色零水印图像。上传至版权中心。将生成的彩色零水印图像上传至相应的版权中心，为之后版权认证提供凭证。水印存在的目的就是为了保护版权，零水印经过认证后才可得到水印信息从而实现版权保护。本发明中所采用的Arnold置乱变换，由俄国数学家弗拉基米尔·阿诺德提出，该算法又被称作猫脸变换。作为图像上的坐标，则广义的Arnold置乱变换为式所示：其中为点经过Arnold变换后的位置，a，b为任意正整数值，可以作为Arnold 置乱算法密钥保存，mod是求余操作，N为图像长和宽，因为Arnold置乱算法是建立在图像长宽相等的情况下实现的。特别地，当a＝b＝1时，被称为狭义的Arnold置乱。Arnold置乱变换具有周期性，其周期是由矩阵长宽N来确定。随着图像置乱次数的增多，图像由清晰到模糊，又由模糊到清晰，最终在置乱次数达到周期值时复原成原图像。图4中的为本发明实施例中Lena原图及为狭义Arnold置乱67次后的图像。相应的，Arnold算法的解密即为加密的逆运算，求逆矩阵对其进行变换，如式所示：对图4中的进行67次狭义Arnold逆变换即得到图4中的Lena原图。本发明中所采用的奇异值分解SVD，是指任一矩阵均可被分解成具有唯一形式的正交矩阵相乘的形式。对任一大小为m*n的矩阵A均可以表示成m*m的正交矩阵U、对角线元素非负的m*n的对角矩阵S和n*n正交矩阵V的转置的乘积形式。矩阵A的奇异值分解表示如式：A＝USVT其中，S的表示形式如式4。矩阵仅仅只在对角线上有非负值，其他项均为0，并且其值的关系为σ1≥σ2…≥σm≥0。由于σi是在该分解式中唯一能确认的数值，所以被称为奇异值。奇异值具有稳定性，尺度不变性，旋转不变性等多种优点。因此，将奇异值分解技术应用于数字水印上可以提高水印算法的稳健性及鲁棒性。因此，本发明通过上述步骤，利用Arnold置乱变换以及奇异值分解实现彩色零水印图像的生成，使水印算法具有更强的不可见性，稳健性及鲁棒性。并且，如图6所示，本步骤还包括对彩色零水印图像认证过程，认证过程即为生成过程的逆过程，仅需将彩色零水印图像代替水印图像与最大奇异值矩阵进行异或，最后进行逆Arnold置乱即可得到彩色水印图像，即：将得到的特征矩阵与各通道的零水印图像进行异或操作，得到各通道的置乱后的水印图像；将各通道的置乱后的水印图像利用密钥key1 进行逆Arnold变换，得到三通道水印图像并进行RGB通道合并，生成彩色水印图像，其步骤具体如下：通道分离。利用原始载体图像生成的旋转不变区域，将得到的载体旋转不变区域和彩色零水印图像进行R、G、B通道分离，得到各通道的原始载体图像旋转不变区域和零水印图像；进行Anrold置乱。利用密钥key1对各通道下原始载体图像的旋转不变区域进行置乱，得到置乱后的各通道下原始载体图像的旋转不变区域；分块奇异值。对置乱后的各通道下原始载体图像的旋转不变区域分块求奇异值，选取最大奇异值组成特征矩阵；异或生成置乱水印。将得到的各通道选取最大奇异值组成的特征矩阵与通道分离后的各通道下的零水印图像进行异或操作，得到置乱后的水印图像；将得到置乱后的水印图像利用密钥key1进行逆Arnold变换，得到三通道的水印图像；水印通道合并。将得到的三个通道的水印图像进行R、G、B通道合并，生成彩色水印图像。步骤3、对原始载体图像生成密钥，基于生成的密钥利用DWT_SVD方法将水印图像嵌入至原始载体图像；并且，对嵌入水印后的原始载体图像进行嵌入式水印的提取，得到原水印图像，具体如下：首先，对原始载体图像生成密钥，如图10所示，其生成步骤为：对彩色的原始载体图像进行R、G、B通道分离，得到三个通道图像。由于三个通道均采用相同的做法，故统称为通道图像进行说明；对三个通道图像分别进行SIFT运算得到各图像的特征点信息；以各通道图像的旋转不变区域即内接圆为界，去除在旋转不变区域外的特征点，从余下的特征点中选取1024个特征点。若特征点个数多于1024个则取前1024个特征点；若特征点个数不足1024个则对其进行补零。构建大小为32*32的特征矩阵A，将选取的1024个特征点对应的像素值保存在特征矩阵A中，该特征矩阵A作为密钥key2存储。本发明中，局部特征区域的鲁棒性由局部特征点的鲁棒性左右，具有良好尺度不变性、抗攻击性的SIFT算法是构造强鲁棒性区域的关键。本发明中所采用的尺度不变特征转换SIFT算法，由 David Lowe于1999年所发表，2004年进行补充完善。SIFT算法提取的特征点具有尺度不变性，旋转不变性，以及抗噪能力强，抗几何攻击能力强等优点，因此SIFT算法发展到局部水印领域上可大大增强算法鲁棒性。SIFT算法的实现过程可以分为四步：建立高斯差分金字塔，对关键点定位，确定关键点方向和对关键点进行描述。算法第一步对图像进行平滑处理，平滑处理后的图像再利用二维高斯函数G对图像I进行卷积运算，构建尺度空间L。具体运算如式：L＝G·I构建的尺度空间便是构建高斯金字塔，其中包含组数O，如下述式，层数S如下述式，及倍数k如下述式。其中，M、N为图像长和宽，n为要提取特征的图像个数。O＝log2-3) S＝n+3 高斯金字塔的由来是因为每组图像大小递减，因此仅从形状上来看就如同金字塔般上小下大，构建完成的高斯金字塔如图7左所示。在高斯金字塔中，第一组第一层的图像是经过平滑处理的载体图像，其尺度σ＝1.6，第n层的尺度为kn-1σ。对于同一组来说，每一层的区别在于尺度σ的不同，上层是下层尺度的k倍，而对于上下两组，则是将上一组的倒数第三层图像降采样作为下一组的第一层的图像，这样的目的是为了使下一组的第一层的尺度为knσ。将高斯金字塔同组上下两层相减便得到高斯差分金字塔，如图7右所示。算法第二步是对高斯差分金字塔同一组上中下三层进行极值点检测，如图8所示。中间的叉号点需比较同层的8个像素，以及上下层的18个像素，只有当其值最大或最小，才将该点作为极值点并存储起来供后续计算使用。由于检测到的极值点是离散的，无法与相邻坐标点关联，因此为加强特征点的尺度不变性利用Talor展开检测连续空间中的极值点。对于尺度空间函数为D在点的Taylor展开公式为式：其中，X为该点距精确极值点偏移量。对上式进行求导，令结果为0，则精确极值点位置偏移量为式：对应极值点方程为式：如果x’的三个分量都小于0.5，则说明精确极值点距当前点位移量已经很小了，则可以认为他已经收敛于这个点了，这个点就把它当做精确极值点。若其中任意一个分量大于0.5，则对该点进行迭代，迭代次数不超过五次，如果仍然不收敛则舍去这个点。另外，在得到的极值点里，还需舍去低对比度的点。若abs)＜T/n，则该点对比度过低，在受到噪声干扰时会变得不稳定，因此将其舍去。然后，根据密钥key2实现DWT_SVD的水印嵌入，如图11所示，具体步骤为：根据密钥key2提取特征点坐标，选取包含特征点在内周围2*2的区域，将选取区域内特征点的像素值组成大小为64*64的局部特征矩阵，记为局部特征矩阵B；对局部特征矩阵B和水印图像分别进行离散小波变换，得到各自的频率带，一共得到八个频率带LL,LH,HL,HH,ll,lh,hl,hh，选取各自频率带中除低频带外的其他频率带作为密钥key3保存下来，即选取低频带外的lh，hl，hh频率带作为密钥key3保存；所选取的频率带lh，hl，hh作为密钥，是因为在水印嵌入中为实现更强鲁棒性仅对其低频带ll进行嵌入，这三个分量并未对其进行操作。并且该三个频率带和图像整体息息相关，即嵌入水印后的图像再次进行离散小波变换所生成的这三个分量会与原图分量大为不同，故将其作为密钥保存。对各自的低频带LL和ll分别进行奇异值分解，并将低频带ll进行奇异值分解得到的矩阵u，v作为密钥key4保存，利用加性嵌入将ll的奇异值矩阵s嵌入到LL的奇异值 S中，得到了含有水印奇异值信息的水印嵌入区域奇异值S’。对U，S’，V进行逆奇异值分解得到频率带LL’；对LL’,LH,HL,HH四个频率带进行逆小波变换，得到含有水印信息的特征矩阵C；将含有水印信息的特征矩阵C的像素值替换掉原始载体图像上原位置的像素值，至此实现水印的嵌入。对于图像的二维离散小波变换，最常用的方法是将二维尺度函数分离，分别对其进行一维离散小波变换，即：φ＝φφ如图9所示，为本发明实施例的图像的二维离散小波变换过程，首先对图像的每一行进行一维的离散小波变换，获得原始图像在水平方向上的低频分量L和高频分量H，然后对变换所得数据的每一列进行一维离散小波变换，获得原始图像在水平和垂直方向上的低频分量LL、水平方向上的低频和垂直方向上的高频LH、水平方向上的高频和垂直方向上的低频HL以及水平和垂直方向上的的高频分量HH。此外，在不同分量上嵌入水印也各具特点，如在低频分量LL上嵌入水印可增强水印鲁棒性，但却由于人眼视觉系统对低频分量更敏感，故其不可见性及不可感知性较差，相反，将水印嵌入高频分量不可见性强，鲁棒性差。本发明的不可见性已达到极佳，故将水印嵌入低频分量以增强算法的鲁棒性。后续还可以继续对分量LL继续进行小波分解，以得到更具鲁棒性的低频分量。最后，对嵌入水印后的原始载体图像，对其进行嵌入式水印的提取，如图12所示，其具体步骤为：根据密钥key2，提取出特征点所在位置；将特征点及周围2*2区域内特征点的像素值提取出来，构成64*64的局部特征矩阵，记作局部特征矩阵B’；对局部特征矩阵B’和原始载体图像的局部特征矩阵B进行离散小波变换得到各自的低频带LL’，LL；对各自的低频带LL’，LL进行奇异值分解，利用逆向加性法则得到水印图像的奇异值矩阵s；对提取出的水印图像的奇异值矩阵s结合密钥key4进行逆奇异值分解得到水印图像小波变换后的低频带ll；对得到的水印图像小波变换后的低频带ll结合密钥key3进行逆小波变换，得到原来的水印图像。为了验证本发明方法能够利用旋转不变区域，嵌入式水印与零水印相结合及将零水印构建特征矩阵应用于嵌入式水印，满足水印算法不可见性和鲁棒性之间的平衡，特列举一个实验例进行说明。本发明实验的彩色原始载体图像及水印图像如图13、14所示，嵌入水印后的效果如图 15所示，受各种攻击及水印提取如图16、17所示。表1本发明与现有算法对比颜色空间嵌入区域水印类型水印容量水印个数提取方式本发明方法RGB局部彩色图像64*64多个非盲提取DCTRGB全局二值图像64*64一个盲提取DWT_SVDRGB全局彩色图像64*64一个非盲提取多级DWTRGB全局彩色图像64*64多个非盲提取DWT最优RGB全局彩色图像64*64一个非盲提取局部SURFYCbCr局部文本信息1*32多个非盲提取 表2受攻击后载体图像PSNR值PSNRLenaBaboonPepperPlaneSailboatTiffany本发明方法40.239240.315840.053340.284340.483641.7297DCT36.415636.568436.319236.562336.675236.8267DWT_SVD35.119335.122335.123635.134535.136735.1349多级DWT38.416538.425938.349238.615638.321438.5826DWT最优35.798135.802535.819335.834235.832835.8672局部SURF45.328740.234642.351641.145642.385142.3564 表3受攻击后水印提取NC值与目前先进算法的对比，其基本信息对比如表1。不可见性方面，从表2，图18可以看出本发明方法PSNR值在40db以上，并且整体曲线较为平稳，没有太大起伏。对比其他算法，局部SURF算法虽高于本发明方法，但整体曲线较为曲折，稳定性不足；另外四种算法虽整体曲线平稳但却低于本发明方法。因此，本发明方法既保持较高PSNR值，又保证了水印嵌入后不可见性的平稳。对于局部SURF算法甚至达到45的PSNR值，其原因在于嵌入水印的容量极小，仅为本发明方法水印容量的1/128。因此可以说本发明方法较现有算法具备更强不可见性。对于鲁棒性方面，从表3，图19可以看出在在噪声，锐化，压缩，平移，剪切等攻击下本发明方法提取水印的NC值均在0.99以上，而对比算法中最高NC值仍比本发明方法低0.02左右；在旋转攻击下本发明方法提取的NC值保持在0.985左右，从折线图上看是在所有攻击下高低落差最大的。从整体折线图来看，本发明方法在所有攻击下其NC值均高于对比算法，并且其曲线除缩小攻击外较为平整。据此可以说本文算法较现有算法具有更强鲁棒性。综上，本发明方法解决了现有水印算法存在的问题，为应对几何攻击中较难处理的旋转攻击，裁剪出旋转不变区域，在此区域再生成具有旋转不变性的SIFT特征点嵌入区域，能更好的抵抗旋转攻击；利用可以得到更多特征点的SIFT算法寻找特征点，为构建大容量局部特征区域做准备，针对局部区域构建尺度问题，将零水印中构建特征矩阵的思想应用于嵌入式水印中，较好地平衡了局部区域构建尺度与算法性能问题；利用DWT_SVD算法进行水印嵌入，实现嵌入与嵌入区域一样大小的水印图像，并且提高了算法鲁棒性；思考多重认证的解决方案，将嵌入式水印和零水印相结合的实现了多重水印方式，平衡不可见性及鲁棒性的矛盾并提高了算法性能。上面结合附图对本发明的实施方式作了详细说明，但是本发明并不限于上述实施方式，在本领域普通技术人员所具备的知识范围内，还可以在不脱离本发明宗旨的前提下做出各种变化。
