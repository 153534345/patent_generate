标题title
针对核反应堆临界设计的基于神经网络的中子输运方法
摘要abst
本发明公开了一种针对核反应堆临界设计的基于神经网络的中子输运方法，通过构建全连接神经网络预测各能群中子角通量密度和各能群共轭中子角通量密度，使用加扰低差异序列在基于符号距离函数表示的几何空间位置和飞行方向上采样形成相应配点数据集，然后对全连接神经网络进行混合分步式训练充分降低有效增殖系数损失函数和边界平均损失函数，使全连接神经网络可以准确预测核反应堆内任意空间位置和飞行方向的各能群中子角通量密度并计算得到有效增殖系数。本发明方法相比传统方法，具有不依赖网格、复杂几何适应性强、实现简单等优点，计算结果硬件存储占用小且计算较稳定，可拓展应用于反应堆精细化临界计算、智能优化设计及可视化等场景。
权利要求书clms
1.一种针对核反应堆临界设计的基于神经网络的中子输运方法，其特征在于：包括如下步骤：步骤1：构建两个结构完全相同的具有输入层、输出层和多层隐藏层的全连接神经网络分别预测核反应堆中各能群中子角通量密度和各能群共轭中子角通量密度并采用Xavier初始化方法初始化这两个全连接神经网络所有层的权重和偏置；步骤2：读取所要模拟的核反应堆的几何信息和材料信息：几何信息包括描述核反应堆的最终几何体的几何参数和边界参数、基本几何体的几何参数和边界参数以及基本几何体的组合方式；材料信息包括核反应堆材料的空间分布、各个能群下相应空间位置材料的总截面、散射截面和裂变产生截面以及裂变材料对应的多群瞬发裂变中子能谱；步骤3：根据步骤2读取的几何信息，使用低差异序列在最终几何体的内部空间位置与中子飞行方向上随机均匀采样NΓ个内部配点，在最终几何体的边界空间位置与中子飞行方向上随机均匀采样NB个边界配点，再结合步骤2读取的材料信息，根据每个内部配点对应的中子空间位置和中子飞行方向，判断并存储NΓ个内部配点对应的材料信息，由此生成内部配点数据集SΓ；根据每个边界配点对应的中子空间位置，判断并存储NB个边界配点对应的边界外法向量信息和边界条件信息，由此生成边界配点数据集步骤4：将步骤3获得的内部配点数据集SΓ中每个内部配点对应的中子空间位置和中子飞行方向输入到步骤1构建的两个全连接神经网络中，分别输出得到核反应堆内每个内部配点对应的各能群中子角通量密度和各能群共轭中子角通量密度；然后计算得到核反应堆的有效增殖系数损失函数losskeff：消失算子L和产生算子F作用在φg上的具体形式分别定义为式和式，共轭消失算子和共轭产生算子/＞作用在/＞上的具体形式分别定义为式和式：式中等号右边从左至右，三个物理项依次为泄漏项、移出项和散射项；式中等号右边从左至右三个物理项依次为输运过程中子价值泄漏项、输运过程中子价值损失项和散射过程中子价值转移项；式和式等号右边分别为裂变产生项和裂变过程中子价值产生项；r—中子空间位置；ri—内部配点数据集SΓ中第i个内部配点对应的中子空间位置；Ω—中子飞行方向；Ωi—内部配点数据集SΓ中第i个内部配点对应的中子飞行方向；Ω′—物理过程使中子状态发生变化前的中子飞行方向；g—中子能群编号；g′—物理过程使中子状态发生变化前的中子能群编号；φg—中子空间位置r处沿Ω方向飞行的第g能群中子角通量密度；φg′—物理过程使中子状态发生变化前的中子空间位置r处沿Ω′方向飞行的第g′能群中子角通量密度；φg—内部配点数据集SΓ中第i个内部配点对应的中子空间位置ri处沿Ωi方向飞行的第g能群中子角通量密度；—中子空间位置r处沿Ω方向飞行的第g能群共轭中子角通量密度；—物理过程使中子价值发生变化前的中子空间位置r处沿Ω′方向飞行的第g′能群共轭中子角通量密度；—内部配点数据集SΓ中第i个内部配点对应的中子空间位置ri处沿Ωi方向飞行的第g能群共轭中子角通量密度；G—中子能群的总数；Σt,g—中子空间位置r处材料的第g能群的总截面；Σs,g′→g—中子空间位置r处材料使沿Ω′方向飞行的第g′能群中子散射至飞行方向为Ω、能量处于第g能群的状态的散射截面；Σs,g→g′—在散射过程中发生中子价值转移时，中子空间位置r处材料使沿Ω方向飞行的第g能群中子散射至飞行方向为Ω′、能量处于第g′能群的状态的散射截面；χg—第g能群的多群瞬发裂变中子能谱；χg′—第g′能群的多群瞬发裂变中子能谱；vΣf,g—中子空间位置r处材料的第g能群的裂变产生截面；vΣf,g′—中子空间位置r处材料的第g′能群的裂变产生截面。步骤5：将步骤3获得的边界配点数据集中每个边界配点对应的中子空间位置和中子飞行方向信息输入到步骤1构建的两个全连接神经网络中，分别输出得到核反应堆边界上每个边界配点对应的各能群中子角通量密度和各能群共轭中子角通量密度；并根据每个边界配点对应的边界外法向量信息和边界条件信息，计算得到核反应堆的边界平均损失函数lossB；步骤6：固定步骤1构建的两个全连接神经网络中输入层和多层隐藏层的权重和偏置不变，使用最小二乘法获得使步骤5构建的边界平均损失函数lossB的值最小时两个全连接神经网络输出层的权重和偏置大小，并对原输出层的权重和偏置进行相应更新；步骤7：固定步骤6基于最小二乘法获得并更新后的两个全连接神经网络输出层的权重和偏置大小不变，采用优化算法更新调整两个全连接神经网络的输入层和多层隐藏层的权重和偏置，使得步骤4构建的有效增殖系数损失函数losskeff与步骤5构建的边界平均损失函数lossB之和最小化；步骤8：在进行基于神经网络的中子输运计算时，先执行步骤3之后重复执行Ngrad次步骤4至步骤7为输运计算的一大步，反复执行若干次大步输运计算，直至相邻输运计算大步的两个全连接神经网络在内部配点数据集和边界配点数据集上，以每个配点对应的中子空间位置和中子飞行方向作为输入，分别输出得到的各能群中子角通量密度和各能群共轭中子角通量密度的L2范数相对误差的最大值小于10-3，有效增殖系数损失函数的相对变化小于10-4，则两个全连接神经网络训练完成且整个基于神经网络的中子输运计算结束；此时将核反应堆内任意中子空间位置和中子飞行方向输入到训练好的用于预测各能群中子角通量密度的全连接神经网络中，即可输出得到对应的各能群中子角通量密度；此时，此核反应堆的有效增殖系数keff为：2.根据权利要求1所述的一种针对核反应堆临界设计的基于神经网络的中子输运方法，其特征在于：所述步骤1中的两个全连接神经网络输入层的神经元个数均为6个，前3个神经元对应中子空间位置r，即三维直角坐标系下x、y、z坐标，后3个神经元对应中子飞行方向Ω，即Ω沿三维直角坐标系的三个轴XYZ的投影Ωx、Ωy、Ωz：Ωz＝cosθ θ—中子飞行方向Ω与Z轴的夹角；—中子飞行方向Ω在XY平面上的投影与X轴的夹角；式中θ∈本发明属于核反应堆工程技术领域，具体涉及一种针对核反应堆临界设计的基于神经网络的中子输运方法。背景技术核反应堆设计的一大重要任务是确定堆芯燃料组件几何尺寸以及组件在核反应堆的空间布置，为此需要进行核反应堆临界计算，以获得核反应堆内各能群中子角通量密度的分布以及有效增殖系数大小。且随着核反应堆设计的小型化、智能化、精准化发展以及可视化的需要，必须进行高精度中子输运计算。针对核反应堆临界设计的中子输运计算，目前经典方法可分为概率论方法和确定论方法两类。概率论方法，即蒙特卡罗方法，不需要对变量进行离散且复杂几何适应性强，理论上能够精确求解连续能量中子输运方程，但为了获得更精确更精细的计算结果，需要划分精细的统计区域，进而需要投入更多的粒子来降低统计方差。确定论方法，常对能量、角度以及空间变量进行离散近似，其求解速度虽然比概率论方法快，但是复杂几何适应性差且高度依赖网格。其中，在空间变量离散时常采用差商近似微分的数值梯度形式，导致求解时还有一定的精度损失。近几年发展起来的基于物理先验信息的神经网络的方法有望缓解上述存在的网格依赖性高、复杂几何适应性差等问题，国内外已有研究人员尝试应用于中子扩散计算，但是基本集中于简单几何的单能问题且仅限于扩散模型，复杂几何应用较困难。在扩散临界问题中，他们采用有效增殖系数并行搜索或者将有效增殖系数设置为学习参数的方法进行计算。但由于临界问题本质上是一个特征值问题且可能存在多个特征值及对应的中子角通量密度分布，因此这些方法在求解过程中容易出现反复振荡的现象，而且还需要引入额外的超参数，这为问题的计算增添了额外负担。发明内容为解决上述问题，本发明提供了一种针对核反应堆临界设计的基于神经网络的中子输运方法，此方法通过构建全连接神经网络预测核反应堆内各位置处的各能群中子角通量密度和各能群共轭中子角通量密度，接着使用符号距离函数表示基本几何体并通过布尔运算构造复杂几何，然后在空间位置以及飞行方向上使用加扰低差异序列进行配点采样，结合最小二乘法和优化算法对全连接神经网络进行训练，最小化基于变分构造的有效增殖系数损失函数和基于物理信息的边界平均损失函数，使训练完成后的全连接神经网络能够准确预测核反应堆内任意空间位置和飞行方向上各能群中子角通量密度并获得此反应堆的有效增殖系数。整个方法不依赖于网格，复杂几何适应性强，而且采用基于链式法则原理的反向自动微分可精确计算梯度，最后计算结果的硬件存储占用也仅与全连接神经网络规模相关，实现了计算结果的压缩表示。其中，基于变分方法构造有效增殖系数损失函数并使其最小化以获得核反应堆的有效增殖系数的方法流程与神经网络的训练流程及目标一致，无需额外引入多余的设置，减小了参数设置负担。为了实现上述目的，本发明采用了以下技术方案予以实施：一种针对核反应堆临界设计的基于神经网络的中子输运方法，包括如下步骤：步骤1：构建两个结构完全相同的具有输入层、输出层和多层隐藏层的全连接神经网络分别预测核反应堆中各能群中子角通量密度和各能群共轭中子角通量密度并采用Xavier初始化方法初始化这两个全连接神经网络所有层的权重和偏置；步骤2：读取所要模拟的核反应堆的几何信息和材料信息：几何信息包括描述核反应堆的最终几何体的几何参数和边界参数、基本几何体的几何参数和边界参数以及基本几何体的组合方式；材料信息包括核反应堆材料的空间分布、各个能群下相应空间位置材料的总截面、散射截面和裂变产生截面以及裂变材料对应的多群瞬发裂变中子能谱；步骤3：根据步骤2读取的几何信息，使用低差异序列在最终几何体的内部空间位置与中子飞行方向上随机均匀采样NΓ个内部配点，在最终几何体的边界空间位置与中子飞行方向上随机均匀采样NB个边界配点，再结合步骤2读取的材料信息，根据每个内部配点对应的中子空间位置和中子飞行方向，判断并存储NΓ个内部配点对应的材料信息，由此生成内部配点数据集SΓ；根据每个边界配点对应的中子空间位置，判断并存储NB个边界配点对应的边界外法向量信息和边界条件信息，由此生成边界配点数据集步骤4：将步骤3获得的内部配点数据集SΓ中每个内部配点对应的中子空间位置和中子飞行方向输入到步骤1构建的两个全连接神经网络中，分别输出得到核反应堆内每个内部配点对应的各能群中子角通量密度和各能群共轭中子角通量密度；然后计算得到核反应堆的有效增殖系数损失函数losskeff：消失算子L和产生算子F作用在φg上的具体形式分别定义为式和式，共轭消失算子和共轭产生算子/＞作用在/＞上的具体形式分别定义为式和式：/＞式中等号右边从左至右，三个物理项依次为泄漏项、移出项和散射项；式中等号右边从左至右三个物理项依次为输运过程中子价值泄漏项、输运过程中子价值损失项和散射过程中子价值转移项；式和式等号右边分别为裂变产生项和裂变过程中子价值产生项；r—中子空间位置；ri—内部配点数据集SΓ中第i个内部配点对应的中子空间位置；Ω—中子飞行方向；Ωi—内部配点数据集SΓ中第i个内部配点对应的中子飞行方向；Ω′—物理过程使中子状态发生变化前的中子飞行方向；g—中子能群编号；g′—物理过程使中子状态发生变化前的中子能群编号；φg—中子空间位置r处沿Ω方向飞行的第g能群中子角通量密度；φg′—物理过程使中子状态发生变化前的中子空间位置r处沿Ω′方向飞行的第g′能群中子角通量密度；φg—内部配点数据集SΓ中第i个内部配点对应的中子空间位置ri处沿Ωi方向飞行的第g能群中子角通量密度；—中子空间位置r处沿Ω方向飞行的第g能群共轭中子角通量密度；—物理过程使中子价值发生变化前的中子空间位置r处沿Ω′方向飞行的第g′能群共轭中子角通量密度；—内部配点数据集SΓ中第i个内部配点对应的中子空间位置ri处沿Ωi方向飞行的第g能群共轭中子角通量密度；G—中子能群的总数；Σt,g—中子空间位置r处材料的第g能群的总截面；Σs,g′→g—中子空间位置r处材料使沿Ω′方向飞行的第g′能群中子散射至飞行方向为Ω、能量处于第g能群的状态的散射截面；Σs,g→g′—在散射过程中发生中子价值转移时，中子空间位置r处材料使沿Ω方向飞行的第g能群中子散射至飞行方向为Ω′、能量处于第g′能群的状态的散射截面；χg—第g能群的多群瞬发裂变中子能谱；χg′—第g′能群的多群瞬发裂变中子能谱；vΣf,g—中子空间位置r处材料的第g能群的裂变产生截面；vΣf,g′—中子空间位置r处材料的第g′能群的裂变产生截面。步骤5：将步骤3获得的边界配点数据集中每个边界配点对应的中子空间位置和中子飞行方向信息输入到步骤1构建的两个全连接神经网络中，分别输出得到核反应堆边界上每个边界配点对应的各能群中子角通量密度和各能群共轭中子角通量密度；并根据每个边界配点对应的边界外法向量信息和边界条件信息，计算得到核反应堆的边界平均损失函数lossB；步骤6：固定步骤1构建的两个全连接神经网络中输入层和多层隐藏层的权重和偏置不变，使用最小二乘法获得使步骤5构建的边界平均损失函数lossB的值最小时两个全连接神经网络输出层的权重和偏置大小，并对原输出层的权重和偏置进行相应更新；步骤7：固定步骤6基于最小二乘法获得并更新后的两个全连接神经网络输出层的权重和偏置大小不变，采用优化算法更新调整两个全连接神经网络的输入层和多层隐藏层的权重和偏置，使得步骤4构建的有效增殖系数损失函数losskeff与步骤5构建的边界平均损失函数lossB之和最小化；步骤8：在进行基于神经网络的中子输运计算时，先执行步骤3之后重复执行Ngrad次步骤4至步骤7为输运计算的一大步，反复执行若干次大步输运计算，直至相邻输运计算大步的两个全连接神经网络在内部配点数据集和边界配点数据集上，以每个配点对应的中子空间位置和中子飞行方向作为输入，分别输出得到的各能群中子角通量密度和各能群共轭中子角通量密度的L2范数相对误差的最大值小于10-3，有效增殖系数损失函数的相对变化小于10-4，则两个全连接神经网络训练完成且整个基于神经网络的中子输运计算结束；此时将核反应堆内任意中子空间位置和中子飞行方向输入到训练好的用于预测各能群中子角通量密度的全连接神经网络中，即可输出得到对应的各能群中子角通量密度；此时，此核反应堆的有效增殖系数keff为：所述步骤1中的两个全连接神经网络输入层的神经元个数均为6个，前3个神经元对应中子空间位置r，即三维直角坐标系下x、y、z坐标，后3个神经元对应中子飞行方向Ω，即Ω沿三维直角坐标系的三个轴XYZ的投影Ωx、Ωy、Ωz：θ—中子飞行方向Ω与Z轴的夹角；—中子飞行方向Ω在XY平面上的投影与X轴的夹角；式中θ∈两个全连接神经网络的输出层的神经元个数均为G个，其中预测各能群中子角通量密度的全连接神经网络的每个神经元对应某一能群的中子角通量密度，预测各能群共轭中子角通量密度的全连接神经网络的每个神经元对应某一能群的共轭中子角通量密度；这两个全连接神经网络的输出层的激活函数均为平方函数或以自然常数e为底的指数函数以保证输出值为正值；中间的多层隐藏层层数若干且根据计算精度需要自行调整，激活函数为可微函数tanh函数或者Swish函数。所述步骤2中基本几何体包括球体、圆柱体、长方体、椭球体、椎体；所述最终几何体和基本几何体的几何参数为符号距离函数，边界参数为边界外法向量信息和边界条件信息；所述基本几何体的组合方式为交、并、补三种布尔运算，最终几何体由基本几何体通过布尔运算中的一种或多种组合得到。所述步骤3中采用的低差异序列为加扰Halton序列或者加扰Sobol序列；所述内部配点数据集SΓ内容具体包括内部配点中子相空间坐标、内部配点对应的中子空间位置ri处各能群总截面、散射截面和裂变产生截面以及裂变材料对应的多群瞬发裂变中子能谱，i＝1,…,NΓ；所述边界配点数据集内容具体包括边界配点中子相空间坐标、边界配点对应中子空间位置rj处的边界外法向量nj和边界条件类型，j＝1,…,NB。内部配点对应的中子空间位置的采样范围为最终几何体的内部空间，边界配点对应的中子空间位置的采样范围为最终几何体的边界空间；对于内部配点对应的中子飞行方向和边界配点对应的中子飞行方向均包含的θ和θ和/＞的采样范围分别为所述边界条件类型为真空边界条件或者全反射边界条件。若边界条件类型为真空边界条件，则核反应堆的边界平均损失函数lossB的具体形式为：若边界条件为全反射边界条件，则核反应堆的边界平均损失函数lossB的具体形式为：rj—边界配点数据集中第j个边界配点对应的中子空间位置；Ωj—边界配点数据集中第j个边界配点对应的中子飞行方向；Ω′j—边界配点数据集中第j个边界配点对应的中子沿Ωj方向入射，在边界外法向量为nj的中子空间位置rj处发生反射后的中子飞行方向；φg—边界配点数据集中第j个边界配点对应的中子空间位置rj处沿Ωj方向飞行的第g能群中子角通量密度；φg—边界配点数据集中第j个边界配点对应的中子空间位置rj处发生反射后沿Ω′j方向飞行的第g能群中子角通量密度；—边界配点数据集/＞中第j个边界配点对应的中子空间位置rj处沿Ωj方向飞行的第g能群共轭中子角通量密度；—边界配点数据集/＞中第j个边界配点对应的中子空间位置rj处发生反射后沿Ω′j方向飞行的第g能群共轭中子角通量密度；NB′—边界配点数据集中满足Ωj·nj＜0的边界配点数目；—边界配点数据集/＞中满足Ωj·nj＞0的边界配点数目；其中，Ω′j＝Ωj-2nj。所述步骤4式中的泄漏项里各能群中子角通量密度的梯度以及式中输运过程中子价值泄漏项里各能群共轭中子角通量密度的梯度使用深度学习框架PyTorch或TensorFlow中的反向自动微分计算获得；式的散射项、式裂变产生项、式散射过程中子价值转移项以及式裂变过程中子价值产生项中针对物理过程使中子状态发生变化前的中子飞行方向的积分使用全对称求积组进行计算，全对称求积组阶数N为偶数且8≤N≤20；所述有效增殖系数损失函数中产生算子F和共轭产生算子均为非零算子。所述步骤7中的优化算法为一阶梯度下降优化算法Adam算法或者拟牛顿法L-BFGS算法。与现有针对核反应堆临界设计的中子输运计算方法相比，本发明有如下突出优点：1、本发明进行中子输运计算时不需要剖分网格，不存在复杂几何中网格剖分困难、网格映射复杂等问题，仅基于加扰低差异序列在空间位置以及飞行方向上进行随机均匀采样即可获取计算用的配点数据集，而且最终结果以训练好的全连接神经网络表示，可以预测输出核反应堆内任意空间位置和飞行方向下高精度各能群中子角通量密度且预测过程相互独立，可实现硬件高并行度，而且其计算机硬件存储占用大小仅与神经网络的结构规模大小相关，可拓展应用于未来精细化临界设计计算、堆芯智能优化设计及数据可视化等场景；2、在本发明方法求解过程中，描述核反应堆的最终几何体由基于符号距离函数表示的基本几何体通过布尔运算获得，具有较好的复杂几何适应性，而且判断配点的位置易于硬件并行执行，可有效提升计算效率。此外，在求解过程中还采用了现有深度学习框架中基于求导链式法则的反向自动微分计算梯度，实现方便且相比于传统确定论求解方法采用差商近似微分的数值梯度形式精度可以得到提高；3、本发明通过变分方法构造有效增殖系数损失函数，在求解过程中通过优化减小损失函数值，并在最终收敛时对有效增殖系数损失函数取倒数并乘以2即可得到核反应堆的有效增殖系数keff，其流程与神经网络训练优化流程和目标一致，无需设置多余的超参数和引入额外的求解搜索方法，构造形式简便且计算流程较为稳定；4、本发明在训练全连接神经网络时采用混合分步式训练模式，即对边界平均损失函数采用最小二乘法，对边界平均损失函数与有效增殖系数损失函数之和采用优化算法，通过先后固定全连接神经网络其他层及输出层的权重和偏置分别进行参数计算更新，能够避免不同损失函数项在训练过程中出现的刚性问题，减缓优化难度，提高优化效率及进一步降低优化误差和预测误差。附图说明图1是本发明方法整体流程图。图2是分别预测各能群中子角通量密度和各能群共轭中子角通量密度的两个全连接神经网络示意图。图3是单次混合分步式训练模式流程示意图。具体实施方式下面结合附图和具体实施方式对本发明做进一步详细说明。为便于以下具体实施方式的描述，中子空间位置r由三维直角坐标系下x、y、z坐标表示，中子飞行方向Ω由Ω沿三维直角坐标系的三个轴XYZ的投影Ωx、Ωy、Ωz表示，Ωx、Ωy、Ωz的具体形式为：θ—中子飞行方向Ω与Z轴的夹角；—中子飞行方向Ω在XY平面上的投影与X轴的夹角；/＞且θ∈中子相空间坐标表示为：＝本发明一种针对核反应堆临界设计的基于神经网络的中子输运方法，方法整体流程如图1所示，具体步骤如下：步骤1：构建两个结构完全相同的具有输入层、输出层和多层隐藏层的全连接神经网络分别预测核反应堆中各能群中子角通量密度和各能群共轭中子角通量密度，这两个网络的网络结构及输入输出参数如图2所示，其中“+1”神经元与其他神经元连线上的学习参数为偏置，其余神经元连线上的学习参数为权重，输入层框选范围内的权重和偏置为输入层的权重和偏置，多层隐藏层和输出层的权重和偏置定义同理，σ表示隐藏层的激活函数。这两个神经网络均采用Xavier初始化方法初始化所有层的权重和偏置，以保证每一层输出的方差尽量相等。两个全连接神经网络输入层的神经元个数均为6个，前3个神经元对应中子空间位置r，即x、y、z，后3个神经元对应中子飞行方向Ω，即Ωx、Ωy、Ωz。两个全连接神经网络的输出层的神经元个数均为G个，其中预测各能群中子角通量密度的全连接神经网络的每个神经元对应某一能群的中子角通量密度，预测各能群共轭中子角通量密度的全连接神经网络的每个神经元对应某一能群的共轭中子角通量密度。这两个全连接神经网络的输出层的激活函数σout为平方函数或以自然常数e为底的指数函数以保证输出值为正值；中间的多层隐藏层层数若干且可根据计算精度需要自行调整，激活函数为可微函数tanh函数或者Swish函数以满足一般物理场分布是连续的情形和提高神经网络非线性表达能力。步骤2：读取所要模拟的核反应堆的几何信息和材料信息：几何信息包括描述核反应堆的最终几何体的几何参数和边界参数、基本几何体的几何参数和边界参数以及基本几何体的组合方式；材料信息包括核反应堆材料的空间分布、各个能群下相应空间位置材料的总截面、散射截面和裂变产生截面以及裂变材料对应的多群瞬发裂变中子能谱。其中，基本几何体包括球体、圆柱体、长方体、椭球体、椎体；所述最终几何体和基本几何体的几何参数为符号距离函数，采用符号距离函数描述几何便于后续采样过程在计算机硬件上并行执行；边界参数为边界外法向量信息和边界条件信息；所述基本几何体的组合方式为交、并、补三种布尔运算，最终几何体由基本几何体通过布尔运算中的一种或多种组合得到。步骤3：根据步骤2读取的几何信息，使用低差异序列在最终几何体的内部空间位置与中子飞行方向上随机均匀采样NΓ个内部配点，在最终几何体的边界空间位置与中子飞行方向上随机均匀采样NB个边界配点，再结合步骤2读取的材料信息，根据每个内部配点对应的中子空间位置和中子飞行方向，判断并存储NΓ个内部配点对应的材料信息，由此生成内部配点数据集SΓ，其内容具体包括内部配点中子相空间坐标、内部配点对应的中子空间位置ri处各能群总截面、散射截面和裂变产生截面以及裂变材料对应的多群瞬发裂变中子能谱，i＝1,…,NΓ；根据每个边界配点对应的中子空间位置，判断并存储NB个边界配点对应的边界外法向量信息和边界条件信息，由此生成边界配点数据集其内容具体包括边界配点中子相空间坐标、边界配点对应中子空间位置rj处的边界外法向量nj和边界条件类型，j＝1,…,NB。其中，边界条件类型为真空边界条件或者全反射边界条件。为使此方法在理论上具有较高的收敛效率，采样过程需要较好的随机均匀分布特性，因此低差异序列优选为加扰Halton序列或者加扰Sobol序列。在进行采样时，内部配点对应的中子空间位置的采样范围为最终几何体的内部空间，边界配点对应的中子空间位置的采样范围为最终几何体的边界空间；对于内部配点对应的中子飞行方向和边界配点对应的中子飞行方向均包含的θ和θ和/＞的采样范围分别为步骤4：将步骤3获得的内部配点数据集SΓ中每个内部配点对应的中子空间位置和中子飞行方向输入到步骤1构建的两个全连接神经网络中，分别输出得到核反应堆内每个内部配点对应的各能群中子角通量密度和各能群共轭中子角通量密度；然后计算得到核反应堆的有效增殖系数损失函数losskeff：消失算子L和产生算子F作用在φg上的具体形式分别定义为式和式，共轭消失算子和共轭产生算子/＞作用在/＞上的具体形式分别定义为式和式：式中等号右边从左至右，三个物理项依次为泄漏项、移出项和散射项；式中等号右边从左至右三个物理项依次为输运过程中子价值泄漏项、输运过程中子价值损失项和散射过程中子价值转移项；式和式等号右边分别为裂变产生项和裂变过程中子价值产生项；r—中子空间位置；ri—内部配点数据集SΓ中第i个内部配点对应的中子空间位置；Ω—中子飞行方向；Ωi—内部配点数据集SΓ中第i个内部配点对应的中子飞行方向；Ω′—物理过程使中子状态发生变化前的中子飞行方向；g—中子能群编号；g′—物理过程使中子状态发生变化前的中子能群编号；φg—中子空间位置r处沿Ω方向飞行的第g能群中子角通量密度；φg′—物理过程使中子状态发生变化前的中子空间位置r处沿Ω′方向飞行的第g′能群中子角通量密度；φg—内部配点数据集SΓ中第i个内部配点对应的中子空间位置ri处沿Ωi方向飞行的第g能群中子角通量密度；—中子空间位置r处沿Ω方向飞行的第g能群共轭中子角通量密度；—物理过程使中子价值发生变化前的中子空间位置r处沿Ω′方向飞行的第g′能群共轭中子角通量密度；—内部配点数据集SΓ中第i个内部配点对应的中子空间位置ri处沿Ωi方向飞行的第g能群共轭中子角通量密度；G—中子能群的总数；Σt,g—中子空间位置r处材料的第g能群的总截面；Σs,g′→g—中子空间位置r处材料使沿Ω′方向飞行的第g′能群中子散射至飞行方向为Ω、能量处于第g能群的状态的散射截面；Σs,g→g′—在散射过程中发生中子价值转移时，中子空间位置r处材料使沿Ω方向飞行的第g能群中子散射至飞行方向为Ω′、能量处于第g′能群的状态的散射截面；χg—第g能群的多群瞬发裂变中子能谱；χg′—第g′能群的多群瞬发裂变中子能谱；vΣf,g—中子空间位置r处材料的第g能群的裂变产生截面；vΣf,g′—中子空间位置r处材料的第g′能群的裂变产生截面。其中，为提高方法硬件并行执行效率以及高精度的梯度估计值，式中的泄漏项里各能群中子角通量密度的梯度以及式中输运过程中子价值泄漏项里各能群共轭中子角通量密度的梯度使用现有深度学习框架如PyTorch或TensorFlow中的反向自动微分计算获得；为保证核反应堆临界设计的中子输运计算结果与角度坐标轴的取向无关，式的散射项、式裂变产生项、式散射过程中子价值转移项以及式裂变过程中子价值产生项中针对物理过程使中子状态发生变化前的中子飞行方向的积分使用全对称求积组进行计算，全对称求积组阶数N为偶数且8≤N≤20。此外，有效增殖系数损失函数中产生算子F和共轭产生算子均为非零算子。步骤5：将步骤3获得的边界配点数据集中每个边界配点对应的中子空间位置和中子飞行方向信息输入到步骤1构建的两个全连接神经网络中，分别输出得到核反应堆边界上每个边界配点对应的各能群中子角通量密度和各能群共轭中子角通量密度。并根据每个边界配点对应的边界外法向量信息和边界条件信息，计算得到核反应堆的边界平均损失函数lossB。边界平均损失函数lossB的具体形式根据边界条件的类型不同而不同。若边界条件类型为真空边界条件，则lossB的具体形式为：若边界条件为全反射边界条件，则lossB的具体形式为：rj—边界配点数据集中第j个边界配点对应的中子空间位置；Ωj—边界配点数据集中第j个边界配点对应的中子飞行方向；Ω′j—边界配点数据集中第j个边界配点对应的中子沿Ωj方向入射，在边界外法向量为nj的中子空间位置rj处发生反射后的中子飞行方向；φg—边界配点数据集中第j个边界配点对应的中子空间位置rj处沿Ωj方向飞行的第g能群中子角通量密度；φg—边界配点数据集中第j个边界配点对应的中子空间位置rj处发生反射后沿Ω′j方向飞行的第g能群中子角通量密度；—边界配点数据集/＞中第j个边界配点对应的中子空间位置rj处沿Ωj方向飞行的第g能群共轭中子角通量密度；—边界配点数据集/＞中第j个边界配点对应的中子空间位置rj处发生反射后沿Ω′j方向飞行的第g能群共轭中子角通量密度；NB′—边界配点数据集中满足Ωj·nj＜0的边界配点数目；—边界配点数据集/＞中满足Ωj·nj＞0的边界配点数目；其中，Ω′j＝Ωj-2nj。考虑到深度学习常见的神经网络训练方式存在优化困难、损失函数不同项之间容易出现刚性问题等情况，因此基于最小二乘法和优化算法的混合分步式训练模式对全连接神经网络的权重和偏置进行优化更新，单次此训练模式流程如图3所示，其中θ和θ*分别为更新前和更新后的除输出层之外的两个全连接神经网络的所有权重和偏置，ξ和ξ*分别为更新前和更新后的两个全连接神经网络的输出层的权重和偏置。步骤6：固定步骤1构建的两个全连接神经网络中输入层和多层隐藏层的权重和偏置θ不变，使用最小二乘法求解使步骤5构建的边界平均损失函数lossB的值最小时两个全连接神经网络输出层的权重和偏置ξ大小，并对原输出层的权重和偏置进行相应更新得到ξ*。步骤7：固定步骤6基于最小二乘法获得并更新后的两个全连接神经网络输出层的权重和偏置ξ*大小不变，采用优化算法更新调整两个全连接神经网络的输入层和多层隐藏层的权重和偏置θ，使得步骤4构建的有效增殖系数损失函数losskeff与步骤5构建的边界平均损失函数lossB之和最小化。更新后的两个全连接神经网络的输入层和多层隐藏层的权重和偏置为θ*。其中，优化算法优选为鲁棒性好、收敛速率较快的一阶梯度下降优化算法Adam算法或者拟牛顿法L-BFGS算法。步骤8：在进行基于神经网络的中子输运计算时，先执行步骤3之后重复执行Ngrad次步骤4至步骤7为输运计算的一大步，反复执行若干次大步输运计算，直至相邻输运计算大步的两个全连接神经网络在内部配点数据集和边界配点数据集上，以每个配点对应的中子空间位置和中子飞行方向作为输入，分别输出得到的各能群中子角通量密度和各能群共轭中子角通量密度的L2范数相对误差和/＞的最大值小于10-3，有效增殖系数损失函数的相对变化errkeff小于10-4，则两个全连接神经网络训练完成且整个基于神经网络的中子输运计算结束；此时将核反应堆内任意中子空间位置和中子飞行方向输入到训练好的用于预测各能群中子角通量密度的全连接神经网络中，即可输出得到对应的各能群中子角通量密度。用于判断收敛用的L2范数相对误差和有效增殖系数损失函数的相对变化具体形式为：其中，和/＞分别表示在第k个和第k+1个输运计算大步完成后，将内部配点对应的中子空间位置ri和中子飞行方向Ωi输入到步骤1构建的用于预测各能群中子角通量密度的全连接神经网络后，预测输出的第g能群的中子角通量密度；/＞和/＞分别表示在第k个和第k+1个输运计算大步完成后，将边界配点对应的中子空间位置rj和中子飞行方向Ωj输入到步骤1构建的用于预测各能群中子角通量密度的全连接神经网络后，预测输出的第g能群的中子角通量密度；/＞和/＞分别表示在第k个和第k+1个输运计算大步完成后，将内部配点对应的中子空间位置ri和中子飞行方向Ωi输入到步骤1构建的用于预测各能群共轭中子角通量密度的全连接神经网络后，预测输出的第g能群的共轭中子角通量密度；/＞和/＞分别表示在第k个和第k+1个输运计算大步完成后，将边界配点对应的中子空间位置rj和中子飞行方向Ωj输入到步骤1构建的用于预测各能群共轭中子角通量密度的全连接神经网络后，预测输出的第g能群的共轭中子角通量密度；/＞和/＞分别表示为在第k个和第k+1个输运计算大步中执行步骤4计算得到的有效增殖系数损失函数的值。两个全连接神经网络训练完成且整个基于神经网络的中子输运计算结束后，此时此核反应堆的有效增殖系数keff为：其中，在若干次大步输运计算中步骤3被重复执行以消除“射线效应”问题，提高求解准确度。最后应当说明的是，尽管已经描述示意了本发明的具体实施方式，本领域的普通技术人员可以理解：在不脱离本发明的目的和宗旨的情况下可以对这些实施方式进行多种修改和变型，例如真空和反射边界条件的组合、修改，基本几何体参数的修改及组合等，本发明的范围由权利要求及其等同物限定。
