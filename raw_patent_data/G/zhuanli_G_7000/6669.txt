标题title
基于深度学习的高层建筑风致响应预测、训练方法及装置
摘要abst
本发明涉及一种基于深度学习的高层建筑风致响应预测模型训练方法，属于高层建筑风致响应预测技术领域，所述预测模型训练方法包括：将待测高层建筑的历史顶部位移数据通过经验模态分解算法分解为多个本征模态函数分量，并输入BiLSTM‑ATTE模型进行训练，直至BiLSTM‑ATTE模型的损失函数收敛为一个固定值，结束训练，得到EMD‑BiLSTM‑ATTE模型。本发明中，采用BiLSTM‑ATTE模型做为基础模型对高层建筑的风致响应进行预测，完成位移响应预测所需要的时间很短；将EMD与BiLSTM‑ATTE模型结合得到EMD‑BiLSTM‑ATTE模型，能够达到很高的预测精度。
权利要求书clms
1.一种基于深度学习的高层建筑风致响应预测模型训练方法，其特征在于，包括以下步骤：步骤S1、获取待测高层建筑的历史顶部位移数据作为模型训练的样本，并通过经验模态分解算法将待测高层建筑的历史顶部位移数据分解为多个本征模态函数分量；步骤S2、定义BiLSTM-ATTE模型的损失函数，并将分解得到的各本征模态函数分量作为BiLSTM-ATTE模型的输入特征对其进行训练；步骤S3、当BiLSTM-ATTE模型的损失函数的值收敛为一个固定值保持不变时，结束训练，得到EMD-BiLSTM-ATTE模型。2.根据权利要求1所述的基于深度学习的高层建筑风致响应预测模型训练方法，其特征在于，本征模态函数分量满足以下条件：函数在整个时间范围内，极值点个数与过零点个数相等或相差1；在任意时刻点，上包络线和下包络线的均值均为0。3.根据权利要求2所述的基于深度学习的高层建筑风致响应预测模型训练方法，其特征在于，经验模态分解算法通过以下步骤实现：步骤S11、根据待测高层建筑的历史顶部位移数据得到原始信号x，t表示时间；步骤S12、对原始信号x进行筛分；具体为：找出原始信号x所有的极大值点，拟合成原始信号的上包络线；找出原始信号x所有的极小值点，拟合成原始信号的下包络线；计算上包络线和下包络线的均值得到原始信号x的平均包络线m1；将原始信号x减去m1后即可得到一个新的信号d1,1；步骤S13、判断d1,1是否满足本征模态函数分量的条件，如果不满足，则以d1,1代替原始信号x，继续按步骤S12对d1,1进行筛分，经过K次筛分后的信号记为d1,k，直到d1,k满足本征模态函数分量的条件时，记为原始信号x的第一个IMF分量IMF1；步骤S14、从原始信号x中减去第一个IMF分量IMF1，得到剩余分量r1，对r1继续按步骤S12和步骤S13进行分解；经过n次分解后，求得残余信号rn；当rn为单调函数时，停止分解，将剩余分量函数rn作为残余量RES。4.根据权利要求1所述的基于深度学习的高层建筑风致响应预测模型训练方法，其特征在于，BiLSTM-ATTE模型的损失函数l定义为：其中，N表示样本的个数，xi表示第i个样本的实际值，yi表示第i个样本的预测值。5.根据权利要求1所述的基于深度学习的高层建筑风致响应预测模型训练方法，其特征在于，所述BiLSTM-ATTE模型在任一时刻的输入特征为各本征模态函数分量在该时刻的值组成一个向量。6.一种基于深度学习的高层建筑风致响应预测方法，其特征在于，包括：采用权利要求1～5任一项所述的高层建筑风致响应预测模型训练方法训练出EMD-BiLSTM-ATTE模型；实时获取待测高层建筑的顶部位移数据，并将顶部位移数据输入EMD-BiLSTM-ATTE模型，通过EMD-BiLSTM-ATTE模型计算出待测高层建筑顶部位移的预测数据和变化趋势。7.一种基于深度学习的高层建筑风致响应预测装置，其特征在于，包括：位移数据采集模块，用于实时采集待测高层建筑的顶部位移数据并传输到分析模块；分析模块，用于对位移数据采集模块送来的顶部位移数据进行分析，并对待测高层建筑的顶部位移变换趋势进行预测，得到预测的顶部位移数据；以及预测数据输出模块，用于输出待测高层建筑的历史顶部位移数据及所述分析模块预测的顶部位移数据。8.根据权利要求7所述的基于深度学习的高层建筑风致响应预测装置，其特征在于，还包括：预警模块，用于将所述分析模块预测的顶部位移数据与预设的位移阈值进行比较，当预测的顶部位移数据大于或等于位移阈值时，发出预警信号。9.根据权利要求7所述的基于深度学习的高层建筑风致响应预测装置，其特征在于，所述分析模块包括数据读取单元、EMD-BiLSTM-ATTE模型和输出单元；所述数据读取单元用于读取位移数据采集模块采集的待测高层建筑的顶部位移数据；所述EMD-BiLSTM-ATTE模型包括经验模态分解模块和BiLSTM-ATTE模型，所述经验模态分解模块用于通过经验模态分解算法将待测高层建筑的顶部位移数据分解为多个本征模态函数分量，并将各本征模态函数分量形成的向量作为BiLSTM-ATTE模型的输入特征；所述BiLSTM-ATTE模型用于根据输入特征预测出待测高层建筑的顶部位移数据；所述输出单元用于将预测的顶部位移数据发送给预测数据输出模块和预警模块。10.根据权利要求9所述的基于深度学习的高层建筑风致响应预测装置，其特征在于，所述BiLSTM-ATTE模型包括前向的LSTM网络、后向的LSTM网络和Attention层，所述BiLSTM-ATTE模型先计算前向LSTM网络和后向LSTM网络中每个时序的权重，然后将所有时序的向量进行加权后作为特征向量，并输入到注意力模型学习到每一个权重的重要程度；最后，采用全连接层输出风致响应的预测结果。
说明书desc
技术领域本发明属于高层建筑风致响应预测技术领域，涉及一种基于深度学习的高层建筑风致响应预测、训练方法及装置。背景技术基于人工智能方法对高层建筑风致响应预测方法主要分为两种。一种是“浅层”机器学习方法如随机森林，支持向量机，决策树等，由于高层建筑风致响应具有高度非线性和非平稳性，“浅层”模型不能有效提取高度非线性数据的特征信息导致高层建筑风致响应预测的精度较低。另一种方法是主流的深度神经网络模型，如卷积神经网络，深度神经网络，门口循环单元，长短记忆网络等，具有普遍性、效率高等特点，但准确性有待进一步的提高。发明内容有鉴于此，本发明的目的在于提供一种基于EMD-BiLSTM-ATTE模型深度学习的高层建筑风致响应预测、训练方法及装置。为达到上述目的，本发明提供如下技术方案：一种基于深度学习的高层建筑风致响应预测模型训练方法，包括以下步骤：步骤S1、获取待测高层建筑的历史顶部位移数据作为模型训练的样本，并通过经验模态分解算法将待测高层建筑的历史顶部位移数据分解为多个本征模态函数分量；步骤S2、定义BiLSTM-ATTE模型的损失函数，并将分解得到的各本征模态函数分量作为BiLSTM-ATTE模型的输入特征对其进行训练；步骤S3、当BiLSTM-ATTE模型的损失函数的值收敛为一个固定值保持不变时，结束训练，得到EMD-BiLSTM-ATTE模型。进一步的，本征模态函数分量满足以下条件：函数在整个时间范围内，极值点个数与过零点个数相等或相差1；在任意时刻点，上包络线和下包络线的均值均为0。进一步的，经验模态分解算法通过以下步骤实现：步骤S11、根据待测高层建筑的历史顶部位移数据得到原始信号x，t表示时间；步骤S12、对原始信号x进行筛分；具体为：找出原始信号x所有的极大值点，拟合成原始信号的上包络线；找出原始信号x所有的极小值点，拟合成原始信号的下包络线；计算上包络线和下包络线的均值得到原始信号x的平均包络线m1；将原始信号x减去m1后即可得到一个新的信号d1,1；步骤S13、判断d1,1是否满足本征模态函数分量的条件，如果不满足，则以d1,1代替原始信号x，继续按步骤S12对d1,1进行筛分，经过K次筛分后的信号记为d1,k，直到d1,k满足本征模态函数分量的条件时，记为原始信号x的第一个IMF分量IMF1；步骤S14、从原始信号x中减去第一个IMF分量IMF1，得到剩余分量r1，对r1继续按步骤S12和步骤S13进行分解；经过n次分解后，求得残余信号rn；当rn为单调函数时，停止分解，将剩余分量函数rn作为残余量RES。进一步的，BiLSTM-ATTE模型的损失函数l定义为：其中，N表示样本的个数，xi表示第i个样本的实际值，yi表示第i个样本的预测值。进一步的，所述BiLSTM-ATTE模型在任一时刻的输入特征为各本征模态函数分量在该时刻的值组成一个向量。一种基于深度学习的高层建筑风致响应预测方法，包括：采用高层建筑风致响应预测模型训练方法训练出EMD-BiLSTM-ATTE模型；实时获取待测高层建筑的顶部位移数据，并将顶部位移数据输入EMD-BiLSTM-ATTE模型，通过EMD-BiLSTM-ATTE模型计算出待测高层建筑顶部位移的预测数据和变化趋势。一种基于深度学习的高层建筑风致响应预测装置，包括：位移数据采集模块，用于实时采集待测高层建筑的顶部位移数据并传输到分析模块；分析模块，用于对位移数据采集模块送来的顶部位移数据进行分析，并对待测高层建筑的顶部位移变换趋势进行预测，得到预测的顶部位移数据；以及预测数据输出模块，用于输出待测高层建筑的历史顶部位移数据及所述分析模块预测的顶部位移数据。进一步的，还包括：预警模块，用于将所述分析模块预测的顶部位移数据与预设的位移阈值进行比较，当预测的顶部位移数据大于或等于位移阈值时，发出预警信号。进一步的，所述分析模块包括数据读取单元、EMD-BiLSTM-ATTE模型和输出单元；所述数据读取单元用于读取位移数据采集模块采集的待测高层建筑的顶部位移数据；所述EMD-BiLSTM-ATTE模型包括经验模态分解模块和BiLSTM-ATTE模型，所述经验模态分解模块用于通过经验模态分解算法将待测高层建筑的顶部位移数据分解为多个本征模态函数分量，并将各本征模态函数分量形成的向量作为BiLSTM-ATTE模型的输入特征；所述BiLSTM-ATTE模型用于根据输入特征预测出待测高层建筑的顶部位移数据；所述输出单元用于将预测的顶部位移数据发送给预测数据输出模块和预警模块。进一步的，所述BiLSTM-ATTE模型包括前向的LSTM网络、后向的LSTM网络和Attention层，所述BiLSTM-ATTE模型先计算前向LSTM网络和后向LSTM网络中每个时序的权重，然后将所有时序的向量进行加权后作为特征向量，并输入到注意力模型学习到每一个权重的重要程度；最后，采用全连接层输出风致响应的预测结果。本发明中，将EMD与BiLSTM-ATTE模型结合得到EMD-BiLSTM-ATTE模型对高层建筑的风致响应进行预测，由于BiLSTM-ATTE模型能够充分挖掘变量之间的非线性关系，自适应地感知上下时间序列特性信息，因此不需要对风速进行测量，仅通过前面的时刻特征的相关性即可预测下一个时刻的特征，完成位移响应预测所需要的时间很短。而且，由于通过EMD分解出来的各IMF分量包含了原信号的不同时间尺度的局部特征信号，因此，将EMD与BiLSTM-ATTE模型结合得到的EMD-BiLSTM-ATTE模型能够达到很高的预测精度。另外，EMD算法与BiLSTM-ATTE模型对硬件的要求不高，实现成本低。附图说明为了使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作优选的详细描述，其中：图1为本发明基于深度学习的高层建筑风致响应预测模型训练方法的一个优选实施例的流程图；图2为通过EMD算法对数据进行分解的示意图；图3为LSTM的单个神经元体系的结构示意图；图4为将EMD分解后的各IMF分量作为BiLSTM-ATTE的输入特征的示意图；图5为BiLSTM-ATTE模型的结构示意图；图6为本发明基于深度学习的高层建筑风致响应预测装置的一个优选实施例的结构框图。具体实施方式以下通过特定的具体实例说明本发明的实施方式，本领域技术人员可由本说明书所揭露的内容轻易地了解本发明的其他优点与功效。本发明还可以通过另外不同的具体实施方式加以实施或应用，本说明书中的各项细节也可以基于不同观点与应用，在没有背离本发明的精神下进行各种修饰或改变。需要说明的是，以下实施例中所提供的图示仅以示意方式说明本发明的基本构想，在不冲突的情况下，以下实施例及实施例中的特征可以相互组合。本发明提供一种高层建筑风致响应预测模型训练方法，如图1所示，本发明高层建筑风致响应预测模型训练方法的一个优选实施例包括以下步骤：步骤S1、获取待测高层建筑的历史顶部位移数据，并通过EMD算法，将待测高层建筑的历史顶部位移数据分解为多个IMF分量。IMF分量满足以下两个条件：函数在整个时间范围内，极值点个数与过零点个数相等或相差1；在任意时刻点，上包络线和下包络线的均值均为0。EMD算法是通过筛分的过程来实现的；通过EMD算法能够将非线性数据分解为有限个频率由高到低的IMF分量的线性组合，并且所分解出来的各IMF分量包含了原信号的不同时间尺度的局部特征信号。EMD算法具体包括：步骤S11、根据待测高层建筑的历史顶部位移数据得到原始信号x，t表示时间；原始信号x为时间t的函数。步骤S12、对原始信号x进行筛分。筛分的过程就是从信号中分解出减去它的平均包络线函数，得到一个新的函数；具体为：找出原始信号x所有的极大值点，用三次样条函数拟合成原始信号x的上包络线；找出原始信号x所有的极小值点，用三次样条函数拟合成原始信号x的下包络线；计算上包络线和下包络线的均值得到第一个平均包络线函数m1；将原始信号x减去第一个平均包络线函数m1，得到第一个中间分量函数d1,1。步骤S13、判断中间分量函数d1,1是否满足IMF分量的两个条件，如果满足则将d1,1记为原始信号的第一个IMF分量IMF1；如果不满足则继续按步骤S12对d1,1进行筛分，直至中间分量函数满足IMF分量的条件。假设K次筛分后得到的中间分量函数d1,k满足IMF分量的条件，则将d1,k记为原始信号的第一个IMF分量IMF1。步骤S14、从原始信号x中减去第一个IMF分量IMF1，得到第一个剩余分量函数r1；将第一个剩余分量函数r1继续按步骤S12和步骤S13进行分解，得到第二个IMF分量IMF2；使用第一个剩余分量函数r1减去第二个IMF分量IMF2，得到第二个剩余分量函数r2。继续按步骤S12和步骤S13对第二个剩余分量函数r2进行分解；假设经过n次分解后，得到的第n个剩余分量函数rn为单调函数，则停止分解，将剩余分量函数rn作为残余量RES。如图2所示，此时，将原始信号x分解成了n个IMF分量和一个残余量RES；原始信号可表示为：从EMD的分解过程中可以看出，与傅里叶变换和小波分解相比较，EMD不需要设定基函数，具有自适应性，因此适用范围更广泛。将原始信号x分解后，第一个IMF分量包含原始信号x中的时间尺度最小的成分，随着IMF分量阶数的增加，其对应的频率成分逐渐降低，rn的频率成分最低。根据EMD分解的收敛条件，分解得到的残余量rn为单调函数时，其时间周期将大于信号的记录长度，因此可以将残余量rn作为原始信号x的趋势项。步骤S2、定义BiLSTM-ATTE模型的损失函数，并将分解得到的各IMF分量作为BiLSTM-ATTE模型的输入特征对其进行训练。其中，BiLSTM-ATTE模型的损失函数l可定义为：其中，N表示样本的个数，xi表示第i个样本的实际值，yi表示第i个样本的预测值。所述BiLSTM-ATTE模型在任一时刻的输入特征为各IMF分量在该时刻的值组成一个向量。BiLSTM-ATTE模型能够充分挖掘变量之间的非线性关系，自适应地感知上下时间序列特性信息，非常适合处理复杂的长期时序动态信息。在处理序列数据时，每个时间步对应一个LSTM单元。每个LSTM单元通过考虑前一个LSTM单元的输出和记忆以及当前输入特征来作出决定，产生一个新的输出并改变它的记忆。如图3所示，LSTM的单个神经单元的体系结构包括输入门、遗忘门、输出门以及记忆单元，用于实现信息的输入和输出，其运算过程如下：Γi＝σΓf＝σΓo＝σht＝Γo*tanh其中，Wi,x、Wi,h、Wf,x、Wf,h、Wo,x、Wo,h、Wc,x、Wc,h表示权重矩阵；bi、bf、bc、bo表示偏置矩阵；xt表示时间t时刻的输入特征，即各IMF分量在t时刻的值形成的向量。如图4所示，以原始信号x共分解为四个IMF分量为例，则在t0时刻，表示为向量；在t1时刻，表示为向量；……，在ti时刻，表示为向量。ct-1表示更新前的神经元；ct表示更新后的神经元；ht-1表示时刻的输出特征；ht表示t时刻的输出特征；Γi表示输入门；Γf表示遗忘门；Γo表示输出门；为候选神经元；σ为Sigmoid函数；tanh为双曲正切函数。LSTM神经网络的训练算法的具体为：首先，前向计算每个LSTM单元的输出值；然后，反向计算每个LSTM单元的误差项，利用相应的误差项计算每个权重的梯度；最后，权重通过梯度下降算法更新。如图5所示，BiLSTM-ATTE模型包括BiLSTM模型和Attention层，BiLSTM即双向LSTM，由两个单独的两个LSTM组合而成，具有能够捕获前后信息特征的作用；BiLSTM模型是提取EMD分解的IMF分量的时序信息，并将提取的时序特征输入到注意力模型学习到每一个权重的重要程度；最后，采用全连接层输出风致响应的预测结果。BiLSTM-ATTE模型加入了Attention层，先计算每个时序的权重，然后将所有时序的向量进行加权后作为特征向量进行风致响应的预测。其计算公式如下所示：et＝tanh其中，xt表示t时刻的输入特征；w1、w2、w3、w4、w5、w6表示权重；表示t时刻的向后传播隐层状态；表示时刻的向后传播隐层状态；表示时刻的向前传播隐层状态；表示t时刻的向前传播隐层状态；Ot表示t时刻的隐层状态；Y表示最终输出的状态向量；et表示状态向量；wt表示权重系数矩阵；bt表示偏置矩阵。最后，通过全连接层输出预测结果。步骤S3、在BiLSTM-ATTE模型的训练过程中，当损失函数的值收敛为一个固定值保持不变时，认为此时BiLSTM-ATTE模型的参数为最优的模型参数，停止模型训练。本实施例中，采用BiLSTM-ATTE模型做为基础模型对高层建筑的风致响应进行预测，由于BiLSTM-ATTE模型能够充分挖掘变量之间的非线性关系，自适应地感知上下时间序列特性信息，因此不需要对风速进行测量，仅通过前面的时刻特征的相关性即可预测下一个时刻的特征，完成位移响应预测所需要的时间很短。而且，由于通过EMD分解出来的各IMF分量包含了原信号的不同时间尺度的局部特征信号，因此，将EMD与BiLSTM-ATTE模型结合得到EMD-BiLSTM-ATTE模型后，能够达到很高的预测精度。本发明还提供一种高层建筑风致响应预测方法，包括：采用高层建筑风致响应预测模型训练方法进行训练，得到优化后的EMD-BiLSTM-ATTE模型；实时获取待测高层建筑的顶部位移数据，并将顶部位移数据输入EMD-BiLSTM-ATTE模型，由EMD-BiLSTM-ATTE模型计算出待测高层建筑顶部位移的预测数据和变化趋势。本发明还提供一种高层建筑风致响应预测装置，如附图6所示，本发明高层建筑风致响应预测装置的一个优选实施例包括位移数据采集模块、分析模块、预测数据输出模块和预警模块。所述位移数据采集模块用于实时采集待测高层建筑的顶部位移数据并传输到分析模块；优选为采用包括GPS数据采集单元和/或北斗定位数据采集单元的模块。所述分析模块用于对位移数据采集模块送来的顶部位移数据进行分析，并对待测高层建筑的顶部位移变换趋势进行预测，得到预测的顶部位移数据。所述分析模块包括数据读取单元、EMD-BiLSTM-ATTE模型和输出单元；所述数据读取单元用于读取位移数据采集模块采集的待测高层建筑的顶部位移数据；所述EMD-BiLSTM-ATTE模型包括经验模态分解模块和BiLSTM-ATTE模型，所述经验模态分解模块用于通过经验模态分解算法将待测高层建筑的顶部位移数据分解为多个IMF分量，并将各IMF分量形成的向量作为BiLSTM-ATTE模型的输入特征；所述BiLSTM-ATTE模型用于根据输入特征预测出待测高层建筑的顶部位移数据。所述BiLSTM-ATTE模型包括前向的LSTM网络、后向的LSTM网络和Attention层，所述BiLSTM-ATTE模型先计算前向LSTM网络和后向LSTM网络中每个时序的权重，然后将所有时序的向量进行加权后作为特征向量，并输入到注意力模型学习到每一个权重的重要程度；最后，采用全连接层输出风致响应的预测结果。所述输出单元用于将预测的顶部位移数据发送给预测数据输出模块和预警模块。所述预测数据输出模块用于输出待测高层建筑的历史顶部位移数据及所述分析模块预测的顶部位移数据。所述预测数据输出模块优选为采用可视化模块，例如显示器，以可视的方式输出历史数据和预测数据。所述预警模块用于将分析模块预测的顶部位移数据与预设的位移阈值进行比较，当预测的顶部位移数据大于或等于位移阈值时，发出预警信号。本实施例中，分析模块采用EMD算法与BiLSTM-ATTE模型，对计算和存储能力要求不高，对硬件的要求不高，实现成本低。最后说明的是，以上实施例仅用以说明本发明的技术方案而非限制，尽管参照较佳实施例对本发明进行了详细说明，本领域的普通技术人员应当理解，可以对本发明的技术方案进行修改或者等同替换，而不脱离本技术方案的宗旨和范围，其均应涵盖在本发明的权利要求范围当中。
