标题title
一种超声波水表时间测量误差的降低方法及其系统
摘要abst
本发明公开一种超声波水表时间测量误差的降低方法及其系统，其中，所述超声波水表时间测量误差的降低方法，包括以下步骤：S1、以设定间隔时间为一个测量周期，并且以所述测量周期向第一驱动换能器发送第一激励信号；S2、启动计时模块进行计时，确定并标记正相信号停止时刻；S3、启动第二驱动换能器，使得所述第二换能器进入接收状态；S4、采集并保存所述第二驱动换能器所接收的声波波动状态时刻；S5、获取声波波动在预设确认条件所对应的采样时刻；S6、比对所述采样时刻与所述正相信号停止时刻之间的时差值，确定为测量时间值。本发明的技术方案可以使得检测结果更加稳定可靠，消除了时间周期误差的偏移和跳变。
权利要求书clms
1.一种超声波水表时间测量误差的降低方法，其特征在于，包括以下步骤：S1、以设定间隔时间为一个测量周期，并且以所述测量周期向第一驱动换能器发送第一激励信号；S2、启动计时模块进行计时，确定并标记正相信号停止时刻；S3、启动第二驱动换能器，使得所述第二换能器进入接收状态；S4、采集并保存所述第二驱动换能器所接收的声波波动状态时刻；S5、获取声波波动在预设确认条件所对应的采样时刻；S6、比对所述采样时刻与所述正相信号停止时刻之间的时差值，确定为测量时间值。2.根据权利要求1所述的一种超声波水表时间测量误差的降低方法，其特征在于，在所述S2中，在启动计时模块进行计时，所述第一驱动换能器延迟预设倍数的所述测量周期后，再驱动所述第一驱动换能器发送第一预设次数所述测量周期的声波，以实现发送反相声波信号，从而获取正相信号停止时刻。3.根据权利要求2所述的一种超声波水表时间测量误差的降低方法，其特征在于，所述第一预设次数为2－6次。4.根据权利要求2所述的一种超声波水表时间测量误差的降低方法，其特征在于，所述预设倍数选用二分之一。5.根据权利要求3所述的一种超声波水表时间测量误差的降低方法，其特征在于，在所述S3中，通过迟滞比较器采集并处理所述第二驱动换能器所接收到的声波信号。6.根据权利要求5所述的一种超声波水表时间测量误差的降低方法，其特征在于，在所述S4中，所述声波波动状态时刻包括第二驱动换能器接收到声波信号时，采集并保存在所述迟滞比较器输出正负翻转的状态时刻。7.根据权利要求6所述的一种超声波水表时间测量误差的降低方法，其特征在于，在所述S5中，所述预设确认条件为所述迟滞比较器在最后一次输出下降时状态。8.根据权利要求1所述的一种超声波水表时间测量误差的降低方法，其特征在于，在所述比对所述采样时刻与所述正相信号停止时刻之间的时差值，确定为测量时间值后，S7中，获取声波在流体中的声速，再获取流体的流量。9.一种超声波水表系统，其特征在于，运用上述权利要求1－8所述超声波水表时间测量误差的降低方法，所述超声波水表系统包括：流道体，所述流道体内设有流道，所述流道用于输送流体；第一驱动换能器和第二驱动换能器，所述第一驱动换能器和第二驱动换能器连接在所述流道体的外端并且所述第一驱动换能器和第二驱动换能器均可延伸至所述流道内，所述第一驱动换能器可发射声波经过所述流道输送至所述第二驱动换能器；控制组件，所述控制组件包括计算模块、存储模块、计时模块和声波速度感应模块，所述存储模块、计时模块和声波速度感应模块分别与所述计算模块电连接；所述存储模块用于存储理论声波沿着测量管道方向的声路长度、正相信号停止时刻、声波波动状态时刻和测量时间值；所述计时模块用于记录正相信号停止时刻、声波波动状态时刻和测量时间值；所述声波速度感应模块用于测量声波在水中声速；所述计算模块用于计算所述流体的流量。10.根据权利要求9所述的一种超声波水表系统，其特征在于，所述存储模块内设有迟滞比较器，所述迟滞比较器用于采集并处理所述第二驱动换能器所接收到的声波信号。
说明书desc
技术领域本发明涉及超声波水表技术领域，具体涉及一种超声波水表时间测量误差的降低方法及其系统。背景技术超声波水表是通过检测超声波声束在水中顺流逆流传播时因速度发生变化而产生的时差，分析处理得出水的流速从而进一步计算出水的流量的一种新式水表。内部无活动部件无阻流元件，不受水中杂质的影响，使用寿命长。输出通讯功能齐全，满足各类通讯和无线组网要求。在现有的超声水表方案中，受限于换能器固有的运动惯性，收发换能器在输入信号的作用下，需要一段时间才能达到最大振幅，导致收发信号的起始几个周期幅度过低被噪声淹没无法准确识别；为了降低噪声的影响，衍生出了“第一波检测模式”等方法避开起初的低信噪比阶段；但是，该方式干扰了测量结果的稳定性和有效性。发明内容本发明的主要目的是提出一种超声波水表时间测量误差的降低方法，旨在使得检测结果更加稳定可靠，消除时间周期误差的偏移和跳变。本发明所要解决的上述问题通过以下技术方案以实现：一种超声波水表时间测量误差的降低方法，包括以下步骤：S1、以设定间隔时间为一个测量周期，并且以所述测量周期向第一驱动换能器发送第一激励信号；S2、启动计时模块进行计时，确定并标记正相信号停止时刻；S3、启动第二驱动换能器，使得所述第二换能器进入接收状态；S4、采集并保存所述第二驱动换能器所接收的声波波动状态时刻；S5、获取声波波动在预设确认条件所对应的采样时刻；S6、比对所述采样时刻与所述正相信号停止时刻之间的时差值，确定为测量时间值。优选的，在所述S2中，在启动计时模块进行计时，所述第一驱动换能器延迟预设倍数的所述测量周期后，再驱动所述第一驱动换能器发送第一预设次数所述测量周期的声波，以实现发送反相声波信号，从而获取正相信号停止时刻。优选的，所述第一预设次数为2－6次。优选的，所述预设倍数选用二分之一。优选的，在所述S3中，通过迟滞比较器采集并处理所述第二驱动换能器所接收到的声波信号。优选的，在所述S4中，所述声波波动状态时刻包括第二驱动换能器接收到声波信号时，采集并保存在所述迟滞比较器输出正负翻转的状态时刻。优选的，在所述S5中，所述预设确认条件为所述迟滞比较器在最后一次输出下降时状态。优选的，在所述比对所述采样时刻与所述正相信号停止时刻之间的时差值，确定为测量时间值后，S7中，获取声波在流体中的声速，再获取流体的流量。优选的，一种超声波水表系统，运用上述所述超声波水表时间测量误差的降低方法，所述超声波水表系统包括：流道体，所述流道体内设有流道，所述流道用于输送流体；第一驱动换能器和第二驱动换能器，所述第一驱动换能器和第二驱动换能器连接在所述流道体的外端并且所述第一驱动换能器和第二驱动换能器均可延伸至所述流道内，所述第一驱动换能器可发射声波经过所述流道输送至所述第二驱动换能器；控制组件，所述控制组件包括计算模块、存储模块、计时模块和声波速度感应模块，所述存储模块、计时模块和声波速度感应模块分别与所述计算模块电连接；所述存储模块用于存储理论声波沿着测量管道方向的声路长度、正相信号停止时刻、声波波动状态时刻和测量时间值；所述计时模块用于记录正相信号停止时刻、声波波动状态时刻和测量时间值；所述声波速度感应模块用于测量声波在水中声速；所述计算模块用于计算所述流体的流量。优选的，所述存储模块内设有迟滞比较器，所述迟滞比较器用于采集并处理所述第二驱动换能器所接收到的声波信号。有益效果：本发明的技术方案通过采用以设定间隔时间为一个测量周期，并且向第一驱动换能器发送第一激励信号；然后启动计时模块进行计时，确定并标记正相信号停止时刻；紧接着，启动第二驱动换能器，使得所述第二换能器进入接收状态；使得第二驱动换能器接收第一驱动换能器的声波信号；再通过采集并保存第二驱动换能器所接收的声波波动状态时刻，从而获取声波波动在预设确认条件所对应的采样时刻；然后比对采样时刻与正相信号停止时刻之间的时差值，确定为测量时间值；进而可以通过对信号的停止时刻进行测量，降低了相位噪声对声波信号的干扰，从而提高了被测信号的信噪比；同时结合获取声波波动在预设确认条件所对应的采样时刻，实现对换能器在信号停止后自由震荡的有效抑制，使信号停止时刻振幅衰减更加明显，使得检测结果更加稳定可靠，消除了现有方案中不确定周期误差的偏移和跳变。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图示出的结构获得其他的附图。图1是本发明所述的一种超声波水表时间测量误差的降低方法一实施例的流程图。图2是本发明所述的一种超声波水表时间测量误差的降低方法一实施例的流程图。图3是本发明所述的一种超声波水表时间测量误差的降低方法一实施例的波形时序图。图4是本发明所述的一种超声波水表系统一实施例的结构示意图。图5是本发明所述的一种超声波水表系统一实施例的模块框架图。附图标号说明：1-控制组件；11-计算模块；12-计时模块；13-声波速度感应模块；2-流道体；21-流道；3-第一驱动换能器；4-第二驱动换能器。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明，若本发明实施例中有涉及方向性指示，则该方向性指示仅用于解释在某一特定姿态下各部件之间的相对位置关系、运动情况等，如果该特定姿态发生改变时，则该方向性指示也相应地随之改变。另外，若本发明实施例中有涉及“第一”、“第二”等的描述，则该“第一”、“第二”等的描述仅用于描述目的，而不能理解为指示或暗示其相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。另外，若全文中出现的“和/或”或者“及/或”，其含义包括三个并列的方案，以“A和/或B”为例，包括A方案、或B方案、或A和B同时满足的方案。另外，各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当认为这种技术方案的结合不存在，也不在本发明要求的保护范围之内。本发明提出一种超声波水表时间测量误差的降低方法。一般而言，现有的超声水表方案中，受限于换能器固有的运动惯性，收发换能器在输入信号的作用下，需要一段时间才能达到最大振幅，导致收发信号的起始几个周期幅度过低被噪声淹没无法准确识别；为了降低噪声的影响，衍生出了“第一波检测模式”等方法避开起初的低信噪比阶段，对信号起始阶段以后几个信噪比较高的周期进行过零时刻检测，从而将信号起始的前几个周期错误计入飞行时间，同时由于信号幅度受介质温度和密度等方面的影响，被计入飞行时间的周期数随环境变化，导致测量结果中包含有一个不确定的周期偏移误差。在噪声和幅度偏移的叠加作用下，还会在两次连续测量中出现正负一个信号周期的误差跳变，严重干扰了测量结果的稳定性和有效性。如图1所示，在本发明一实施例中，该超声波水表时间测量误差的降低方法；包括以下步骤：S1、以设定间隔时间为一个测量周期，并且以所述测量周期向第一驱动换能器发送第一激励信号；S2、启动计时模块进行计时，确定并标记正相信号停止时刻；S3、启动第二驱动换能器，使得所述第二换能器进入接收状态；S4、采集并保存第二驱动换能器所接收的声波波动状态时刻；S5、获取声波波动在预设确认条件所对应的采样时刻；S6、比对采样时刻与正相信号停止时刻之间的时差值，确定为测量时间值。本发明的技术方案通过采用以设定间隔时间为一个测量周期，并且向第一驱动换能器发送第一激励信号；然后启动计时模块进行计时，确定并标记正相信号停止时刻；紧接着，启动第二驱动换能器，使得所述第二换能器进入接收状态；使得第二驱动换能器接收第一驱动换能器的声波信号；再通过采集并保存第二驱动换能器所接收的声波波动状态时刻，从而获取声波波动在预设确认条件所对应的采样时刻；然后比对采样时刻与正相信号停止时刻之间的时差值，确定为测量时间值；进而可以通过对信号的停止时刻进行测量，降低了相位噪声对声波信号的干扰，从而提高了被测信号的信噪比；同时结合获取声波波动在预设确认条件所对应的采样时刻，实现对换能器在信号停止后自由震荡的有效抑制，使信号停止时刻振幅衰减更加明显，使得检测结果更加稳定可靠，消除了现有方案中不确定周期误差的偏移和跳变。其中，在本实施方式中，所述设定间隔时间的测量周期中的设定间隔的时长可选用相同的时长，也可以选用不同时长；也就是说，各个测量周期的时长可以相同也可以是随机时长。其中，在本实施方式中，所述第二激励信号为启动所述第二驱动换能器的激励信号，以使得第二驱动换能器能够实现接收信号的功能。其中，信噪比，又称为讯噪比。是指一个电子设备或者电子系统中信号与噪声的比例。这里面的信号指的是来自设备外部需要通过这台设备进行处理的电子信号或者声波信号，噪声是指经过该设备后产生的原信号中并不存在的无规则的额外信号，并且该种信号并不随原信号的变化而变化。信噪比的计量单位是dB，其计算方法是10lg，其中Ps和Pn分别代表信号和噪声的有效功率，也可以换算成电压幅值的比率关系:20Lg，Vs和Vn分别代表信号和噪声电压的"有效值"。其中，第一驱动换能器可选用方波驱动大功率换能器，方波驱动大功率换能器电路中CPU芯片输出简单的一路方波信号，通过反相器输出四路驱动信号驱动四路三极管组成的全桥电路，通过变压器驱动大功率IGBT，从而驱动换能器工作。其中，在所述S2中，在发送第一激励信号时便可启动计时模块；或者，在发送所述第一激励信号的正相信号停止时刻时，启动计时模块。由于激励信号频率很高，留给计时模块启动的时间很少，第一激励信号持续时间很短，需要在发送第一激励信号时候就要启动计时模块的，或者在发送第一激励信号的停止时刻启动计时模块。具体地，在上述S2中，在启动计时模块进行计时，所述第一驱动换能器延迟预设倍数的所述测量周期后，再驱动第一驱动换能器发送第一预设次数所述测量周期的声波，以实现发送反相声波信号，从而获取正相信号停止时刻。其中，在本实施方式中，第一预设次数可选用2-6次。具体地，在本实施方式中，上述预设倍数可选用二分之一倍。其中，其中，计时模块选用计时器，是利用特定的原理来测量时间的装置。其操作界面简便易用，提供了基本的计时控制功能，包括:开始计时、停止计时、继续计时、操作界面简便易用复零、调整计时。在发送声波过程中，所选用方波驱动换能器作为第一驱动换能器，使得方波驱动换能器连续发送第一预设次数的测量周期后，启动计时模块时，第一驱动换能器延长二分之一倍数的测量周期后，再继续发送第一预设次数测量周期的方波，从而获取正相信号向反向信号实现相位变化的时刻；其中，相位发生变化的时刻即为正相信号停止时刻；通过延迟半个周期达到相位反相的目的，实现180°的相位调制。具体地，在所述S3中，通过迟滞比较器采集并处理所述第二驱动换能器所接收到的声波信号。具体地，在上述S4中，上述声波波动状态时刻包括第二驱动换能器接收到声波信号时，采集并保存在所述迟滞比较器输出正负翻转的状态时刻。具体地，在上述S5中，预设确认条件为所述迟滞比较器在最后一次输出下降时状态。其中，迟滞比较器是一个具有迟滞回环传输特性的比较器。在反相输入单门限电压比较器的基础上引入正反馈网络就组成了具有双门限值的反相输入迟滞比较器。由于反馈的作用这种比较器的门限电压是随输出电压的变化而变化的。其中，迟滞比较器的正负门限电压是以零和略低于信号最大峰值的非零电压。如图3所示，在第二驱动换能器接收端收到信号时，在比较器输出正负翻转时刻进行计时器时间采样和保存，最后一次比较器输出下降沿所对应的时间采样值与发射信号停止时刻之间的时差，即为测量结果。具体地，如图2所示，在本实施方式中，在所述比对所述采样时刻与所述正相信号停止时刻之间的时差值，确定为测量时间值后，S7中，获取声波在流体中的声速，再获取流体的流量。如图4和5所示，一种超声波水表系统，运用上述所述超声波水表时间测量误差的降低方法，包括：流道体2，所述流道体2内设有流道21，所述流道21用于输送流体；第一驱动换能器3和第二驱动换能器4，所述第一驱动换能器3和第二驱动换能器4连接在所述流道体2的外端并且所述第一驱动换能器3和第二驱动换能器4均可延伸至所述流道21内，所述第一驱动换能器3可发射声波经过所述流道21输送至所述第二驱动换能器4；控制组件1，所述控制组件1包括计算模块11、存储模块、计时模块12和声波速度感应模块13，所述存储模块、计时模块12和声波速度感应模块13分别与所述计算模块11电连接；所述存储模块用于存储理论声波沿着测量管道方向的声路长度、正相信号停止时刻、声波波动状态时刻和测量时间值；所述计时模块12用于记录正相信号停止时刻、声波波动状态时刻和测量时间值；所述声波速度感应模块13用于测量声波在水中声速；所述计算模块11用于计算所述流体的流量。其中，计时模块12选用计时器，是利用特定的原理来测量时间的装置。其操作界面简便易用，提供了基本的计时控制功能，包括:开始计时、停止计时、继续计时、操作界面简便易用复零、调整计时。其中，所述存储模块内设有迟滞比较器，所述迟滞比较器用于采集并处理所述第二驱动换能器所接收到的声波信号。其中，迟滞比较器是一个具有迟滞回环传输特性的比较器。在反相输入单门限电压比较器的基础上引入正反馈网络就组成了具有双门限值的反相输入迟滞比较器。由于反馈的作用这种比较器的门限电压是随输出电压的变化而变化的。以上所述仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是在本发明的发明构思下，利用本发明说明书及附图内容所作的等效结构变换，或直接/间接运用在其他相关的技术领域均包括在本发明的专利保护范围内。
