标题title
支持远程授权的IC卡自助发卡方法及系统
摘要abst
本发明涉及自助发卡机领域，具体的说是一种支持远程授权的IC卡自助发卡方法及系统，包括用于输入个体信息并执行缴费操作的移动客户端、用于存储并核验个体信息的云平台、与云平台具有数据沟通的自助发卡机，与现有技术相比，提高了信息核对以及缴费操作的可靠性和便捷性，通过将信息核对、缴费操作与发卡取卡分开操作，简化取卡流程，有效提高集中取卡时的工作效率。
权利要求书clms
1.一种支持远程授权的IC卡自助发卡方法，包括用于输入个体信息并执行缴费操作的移动客户端、用于存储并核验个体信息的云平台、与云平台具有数据沟通的自助发卡机，其特征在于，具体包括以下步骤：步骤1：导入学生信息，建立信息档案，移动客户端在导入数据时，帧头增加开始字段，帧尾增加结束字段及校验，发卡云平台接收到数据后，按照数据格式校验帧头、帧尾及校验校验，校验合格后，发卡云平台备份导入数据，同时，发卡云平台将备份数据回传给移动客户端，移动客户端将接收的数据与上传数据进行校验确认，校验正确客户端提示上传成功，当比对失败，移动客户端会再次上传，连续3次上传失败，移动客户端则提示上传失败；步骤2：学生家长通过移动客户端提交IC卡发卡申请，申请信息必须包括 “学校所在省份”、“学校名称”、“学生姓名”、“学生班级”、“学生学号”，为了防止家长录入信息的错误导致信息校验失败，发卡云平台根据导入学生信息，按照省份、学校、班级建档，并同步至移动客户端，家长在客户端录入申请信息时，客户端根据发卡云平台同步的信息，选择省份、学校名称、班级信息，而非手动录入，防止手动录入错误而反复录入，发卡云平台收到客户端提交的申请信息后，与发卡云平台中的学生信息进行比对核验，当学生信息核验成功时，发卡云平台反馈给客户端学生信息审核通过，当学生信息核验失败时，发卡云平台反馈给客户端学生信息审核失败，并提示不一致信息，家长根据提示完善学生信息直到信息核验通过；步骤3：在线缴费，发卡云平台核验成功后，将核验结果反馈给客户端，移动客户端收到学生信息审核通过的信息后，将进入IC卡发卡缴费界面，移动客户端可支持微信或者支付宝在线支付，移动客户端完成卡费支付后，将支付数据发送至发卡云平台；步骤4：生成取卡注册码，发卡云平台收到移动客户端发来的IC卡缴费支付成功的信息后，发卡云平台根据学生学号、申请时间、当日申请排序生成唯一的取卡注册码，取卡注册码采用MD5加密，发卡云平台根据学生申请信息，从数据库中检索该学校区域下全部自助发卡机终端的SN串码，发卡云平台向对应SN串码的自助发卡机终端下发加密后的取卡注册码，并同步以短信的形式发送至家长手机号，发卡云平台完成对自助发卡机终端的远程发卡授权；步骤5：自助取卡，自助发卡机接收来自发卡云平台的学生信息及取卡注册码，并保存本地，当学生在所在学校的自助发卡机终端输入取卡注册码时，自助发卡机终端将取卡注册码与本地数据进行比对校验，校验合格，自助发卡机终端将检验结果发送至发卡云平台，发卡云平台核验其它自助发卡机终端是否已发卡，若没有发卡记录，发卡云平台给该自助发卡机终端发送发卡授权的指令，同步将该取卡注册码修改为已发卡的状态，若已发卡，发卡云平台优先给该自助发卡机终端发送无效取卡注册码的指令，自助发卡机终端收到发卡云平台发卡授权指令后，执行发卡，自助发卡机终端收到发卡云平台无效取卡注册码的指令后，自助发卡机终端弹出“IC卡已完成发卡”，取卡注册码本地校验不合格，自助发卡机终端弹出“取卡注册码无效”，自助发卡机终端执行IC卡发卡后，将已发IC卡的卡号及写入IC卡的学生信息发送至发卡云平台；步骤6：IC卡信息同步，发卡云平台收到自助发卡机终端的发来的IC卡号及学生信息，发卡云平台首先将该学生的信息备份，然后更新发卡云平台的学生IC卡信息，发卡云平台将更新的IC卡学生信息通过客户端推送给学校老师及学生家长，提醒学校老师及学生家长学生IC卡信息变更。2.根据权利要求1所述的一种支持远程授权的IC卡自助发卡方法，其特征在于，步骤2中，发卡云平台收到客户端提交的申请信息后，与发卡云平台中的学生信息进行比对核验，先核验学校所在省份，其次核验学校名称，再其次核验学生班级，再其次核验学生姓名，最后核验学生学号，全部核验一致则认为核验成功。3.一种用于实现如权利要求1或2中任意一项支持远程授权的IC卡自助发卡方法的系统，其特征在于，移动端输入的个体信息发送至云平台，云平台将接收到的个体信息与存储信息进行核对，核对一致后，云平台向移动端发送缴费信息以及取卡注册码，移动客户端缴费后，自助发卡机接收取卡注册码后，自助发卡机与发卡云平台进行取卡注册码信息确认，确认准确无误后自助发卡机终端执行IC卡发卡，自助发卡机获取该IC卡卡号信息并上传发卡云平台，云平台实现学生信息与IC卡的自动绑定。4.根据权利要求3所述的一种支持远程授权的IC卡自助发卡方法的系统，其特征在于，所述自助发卡机终端包括：主控模块、IC卡发卡器、显示模块、信息输入模块以及IC卡读写机构，在发卡的过程中自助发卡机中的卡片读写机构将读取IC卡卡号，同时写入学生信息完成发卡，其中所述主控模块与IC卡发卡器使用RS232接口电连接，主控模块通过RS232接口为IC卡发卡器下发发卡指令，IC卡发卡器通过RS232接口为主控模块提供IC卡卡号信息，所述主控模块与显示模块使用VGA接口电连接，显示模块展示IC卡取卡注册码的输入界面，所述主控模块与输入模块使用USB接口电连接，输入模块采用多点电容触摸屏的方式实现。5.根据权利要求3所述的一种支持远程授权的IC卡自助发卡方法的系统，其特征在于，所述发卡云平台接受来自客户端的申请信息，发卡云平台对申请信息进行解析核验，所述发卡云平台与自助发卡机终端保持长连接状态，发卡云平台与客户端保持长连接状态，发卡云平台备份学生班级、学号、IC卡号信息，当学生信息发生变更或者新增学生信息时，可通过客户端更新或者新增发卡云平台的学生信息，其中所述发卡云平台具备学生信息批量检索、导入功能。6.根据权利要求3所述的一种支持远程授权的IC卡自助发卡方法的系统，其特征在于，移动客户端是学校老师、学生家长进行学生信息管理及发卡申请的入口，部署在手机、PAD及电脑端，手机、PAD端需安装自助发卡APP客户端，电脑客户端采用web页形式的客户端。
说明书desc
技术领域本发明涉及自助发卡机领域，具体的说是一种支持远程授权的IC卡自助发卡方法及系统。背景技术随着学校信息化技术的不断发展，人们对于智能便捷的电子产品的需求意向愈来愈高，校园考勤、消费一卡通系统已经被广泛的应用，为了能够方便学生携带及管理，学生基本上一张IC卡片即可完成学校的考勤打卡、食堂消费、图书馆借阅等功能。一卡通系统极大的方便了学校管理及学生的在校生活。现在越来越多的学校使用自助发卡机，自助发卡机是一种通过用户自助操作来实现发卡的自助设备，自助发卡机主要利用现代的网络技术、计算机控制技术及人机交互技术，将传统的柜台发卡服务转移到自助设备上完成。传统的自助发卡机，需要学生在自助发卡机终端输入自己的相关信息、还要自主交费才能领取卡片。一方面学生输入信息的时间比较长，特别是开学季，办卡量比较大，需要排很长的队伍；另一方面，学生一般不会随身携带零钱，有的时候因为没有零钱导致办卡失败，效率较低。发明内容本发明针对现有技术中存在的缺点和不足，提出了一种能够有效简化取卡流程、保证信息验证准确性的支持远程授权的IC卡自助发卡方法及系统。本发明通过以下措施达到：一种支持远程授权的IC卡自助发卡方法，包括用于输入个体信息并执行缴费操作的移动客户端、用于存储并核验个体信息的云平台、与云平台具有数据沟通的自助发卡机，其特征在于，具体包括以下步骤：步骤1：导入学生信息，建立信息档案，移动客户端在导入数据时，帧头增加开始字段，帧尾增加结束字段及校验，发卡云平台接收到数据后按照数据格式校验帧头、帧尾及校验校验，校验合格后发卡云平台备份导入数据，同时，发卡云平台将备份数据回传给移动客户端，移动客户端将接收的数据与上传数据进行校验确认，校验正确客户端提示上传成功，当比对失败移动客户端会再次上传，连续3次上传失败，移动客户端则提示上传失败；步骤2：学生家长通过移动客户端提交IC卡发卡申请，申请信息必须包括 “学校所在省份”、“学校名称”、“学生姓名”、“学生班级”、“学生学号”，为了防止家长录入信息的错误导致信息校验失败，发卡云平台根据导入学生信息，按照省份、学校、班级建档，并同步至移动客户端，家长在客户端录入申请信息时，客户端根据发卡云平台同步的信息，选择省份、学校名称、班级信息，而非手动录入，防止手动录入错误而反复录入，发卡云平台收到客户端提交的申请信息后，与发卡云平台中的学生信息进行比对核验，当学生信息核验成功时，发卡云平台反馈给客户端学生信息审核通过，当学生信息核验失败时，发卡云平台反馈给客户端学生信息审核失败，并提示不一致信息，家长根据提示完善学生信息直到信息核验通过；步骤3：在线缴费，发卡云平台核验成功后，将核验结果反馈给客户端，移动客户端收到学生信息审核通过的信息后，将进入IC卡发卡缴费界面，移动客户端可支持微信或者支付宝在线支付，移动客户端完成卡费支付后，将支付数据发送至发卡云平台；步骤4：生成取卡注册码，发卡云平台收到移动客户端发来的IC卡缴费支付成功的信息后，发卡云平台根据学生学号、申请时间、当日申请排序生成唯一的取卡注册码，取卡注册码采用MD5加密，发卡云平台根据学生申请信息，从数据库中检索该学校区域下全部自助发卡机终端的SN串码，发卡云平台向对应SN串码的自助发卡机终端下发加密后的取卡注册码，并同步以短信的形式发送至家长手机号，发卡云平台完成对自助发卡机终端的远程发卡授权；步骤5：自助取卡，自助发卡机接收来自发卡云平台的学生信息及取卡注册码，并保存本地，当学生在所在学校的自助发卡机终端输入取卡注册码时，自助发卡机终端将取卡注册码与本地数据进行比对校验，校验合格，自助发卡机终端将检验结果发送至发卡云平台，发卡云平台核验其它自助发卡机终端是否已发卡，若没有发卡记录，发卡云平台给该自助发卡机终端发送发卡授权的指令，同步将该取卡注册码修改为已发卡的状态，若已发卡，发卡云平台优先给该自助发卡机终端发送无效取卡注册码的指令，自助发卡机终端收到发卡云平台发卡授权指令后，执行发卡，自助发卡机终端收到发卡云平台无效取卡注册码的指令后，自助发卡机终端弹出“IC卡已完成发卡”，取卡注册码本地校验不合格，自助发卡机终端弹出“取卡注册码无效”，自助发卡机终端执行IC卡发卡后，将已发IC卡的卡号及写入IC卡的学生信息发送至发卡云平台；步骤6：IC卡信息同步，发卡云平台收到自助发卡机终端的发来的IC卡号及学生信息，发卡云平台首先将该学生的信息备份，然后更新发卡云平台的学生IC卡信息，发卡云平台将更新的IC卡学生信息通过客户端推送给学校老师及学生家长，提醒学校老师及学生家长学生IC卡信息变更。本发明步骤2中，发卡云平台收到客户端提交的申请信息后，与发卡云平台中的学生信息进行比对核验，先核验学校所在省份，其次核验学校名称，再其次核验学生班级，再其次核验学生姓名，最后核验学生学号，全部核验一致则认为核验成功。本发明还提出了一种支持远程授权的IC卡自助发卡系统，其中移动端输入的个体信息发送至云平台，云平台将接收到的个体信息与存储信息进行核对，核对一致后，云平台向移动端发送缴费信息以及取卡注册码，移动客户端缴费后，自助发卡机接收取卡注册码后，自助发卡机与发卡云平台进行取卡注册码信息确认，确认准确无误后自助发卡机终端执行IC卡发卡，自助发卡机获取该IC卡卡号信息并上传发卡云平台，云平台实现学生信息与IC卡的自动绑定。本发明所述自助发卡机终端包括：主控模块、IC卡发卡器、显示模块、信息输入模块，用于实现取卡注册码的输入及IC卡的发卡，其中所述主控模块与IC卡发卡器使用RS232接口电连接，主控模块通过RS232接口为IC卡发卡器下发发卡指令，IC卡发卡器通过RS232接口为主控模块提供IC卡卡号信息，所述主控模块与显示模块使用VGA接口电连接，显示模块展示IC卡取卡注册码的输入界面，所述主控模块与输入模块使用USB接口电连接，输入模块采用多点电容触摸屏的方式实现。本发明所述发卡云平台接受来自客户端的申请信息，发卡云平台对申请信息进行解析核验，所述发卡云平台与自助发卡机终端保持长连接状态，发卡云平台与客户端保持长连接状态，发卡云平台备份学生班级、学号、IC卡号等信息，当学生信息发生变更或者新增学生信息时，可通过客户端更新或者新增发卡云平台的学生信息，其中所述发卡云平台具备学生信息批量检索、导入功能。老师可通过客户端导入Excel表，批量修改或者新增学生信息，学生家长家长通过客户端申请IC卡时，发卡云平台接收来自客户端的申请信息，发卡云平台调出数据库的学生信息进行核验，申请信息与数据库信息一致核验通过，信息核验结果反馈给移动客户端。本发明移动客户端是学校老师、学生家长进行学生信息管理及发卡申请的入口，可以部署在手机、PAD及电脑端，手机、PAD端需安装自助发卡APP客户端，电脑客户端采用web页形式的客户端。本发明与现有技术相比，提高了信息核对以及缴费操作的可靠性和便捷性，通过将信息核对、缴费操作与发卡取卡分开操作，简化取卡流程，有效提高集中取卡时的工作效率。附图说明附图1是本发明的系统框图。附图2是本发明中自助发卡机内部系统图。附图3是本发明的流程图。附图4是本发明的批量导入学生信息的一种固定格式示意图。附图标记：自助发卡机1、发卡云平台2、移动客户端3、主控模块4、输入模块5、显示模块6、IC发卡器7。具体实施方式：下面结合附图和实施例，对本发明做进一步的说明。如附图1及附图2所示，本例提供了一种支持远程授权的IC卡发卡系统，包括自助发卡机、发卡云平台、移动客户端；其中自助发卡机由主控模块、输入模块、显示模块、IC卡发卡器构成，学生通过自助发卡机终端输入模块手动输入取卡注册码，自助发卡机终端将取卡注册码发送至发卡云平台核验，核验结果反馈给自助发卡机终端，发卡云平台授权通过，自助发卡机终端执行发卡；发卡云平台存储学生信息，学生信息通过客户端批量或者单个导入。当家长通过客户端申请IC卡时，申请信息发送至发卡云平台，发卡云平台将对申请信息与存储学生信息进行核验，核验结果反馈给客户端，客户端根据核验结果确定是修改学生信息或者在线支付IC卡卡费；老师可通过客户端导入学生信息及查询学生信息，支持批量导入、单个导入，老师可通过客户端查询学生信息，核对发卡云平台信息与学生真实信息是否一致，家长可通过客户端申请IC卡获得取卡授权。一种支持远程授权的IC卡发卡系统具体工作流程如图3所示，下面将详细说明其工作流程。第一步：导入学生信息，建立信息档案，老师通过客户端导入学生信息，建立学生信息档案，发卡云平台将导入的学生信息备份，导入学生信息的格式如图4所示。导入文件格式为Excel，首行内容为 “序号”、“学校所在省份”、“学校名称”、“学生姓名”、“学生班级”、“学生学号”、“IC卡号”，从第二行开始依次往下为学生的具体信息。特别的为了信息导入的高可靠性，客户端与发卡云平台采用一种双重握手确认技术。客户端在导入数据时，帧头增加开始字段，帧尾增加结束字段及校验，发卡云平台接收到数据后按照数据格式校验帧头、帧尾及校验校验，校验合格后发卡云平台备份导入数据。同时，发卡云平台将备份数据回传给客户端，客户端将接收的数据与上传数据进行校验确认，校验正确客户端提示上传成功。当比对失败客户端会再次上传，连续3次上传失败，客户端则提示上传失败。第二步：IC卡申请，学生家长通过客户端提交IC卡发卡申请，申请信息必须包括 “学校所在省份”、“学校名称”、“学生姓名”、“学生班级”、“学生学号”，特别的为了防止家长录入信息的错误导致信息校验失败，本发明提出了一种基于从发卡云平台获取已导入学生信息的方案，发卡云平台根据导入学生信息，按照省份、学校、班级建档，并同步至客户端。家长在客户端录入申请信息时，客户端根据发卡云平台同步的信息，选择省份、学校名称、班级等信息，而非手动录入，可防止手动录入错误而反复录入。发卡云平台收到客户端提交的申请信息后，与发卡云平台中的学生信息进行比对核验，其核验过程优先核验学校所在省份，其次核验学校名称，再其次核验学生班级，再其次核验学生姓名，最后核验学生学号，全部核验一致则认为核验成功。当学生信息核验成功时，发卡云平台反馈给客户端学生信息审核通过，当学生信息核验失败时，发卡云平台反馈给客户端学生信息审核失败，并提示不一致信息，家长可根据提示完善学生信息直到信息核验通过。第三步：在线缴费，发卡云平台核验成功后，将核验结果反馈给客户端，客户端收到学生信息审核通过的信息后，将进入IC卡发卡缴费界面，客户端可支持微信或者支付宝在线支付。客户端完成卡费支付后，将支付数据发送至发卡云平台；第四步：生成取卡注册码，发卡云平台收到客户端发来的IC卡缴费支付成功的信息后，发卡云平台根据学生学号、申请时间、当日申请排序生成唯一的取卡注册码，取卡注册码采用MD5加密。发卡云平台根据学生申请信息，从数据库中检索该学校区域下全部自助发卡机终端的SN串码。发卡云平台向对应SN串码的自助发卡机终端下发加密后的取卡注册码。并同步以短信的形式发送至家长手机号。该步骤发卡云平台完成对自助发卡机终端的远程发卡授权。第五步：自助取卡，本例提出一种本地取卡注册码校验的方案，自助发卡机接收来自发卡云平台的学生信息及取卡注册码，并保存本地，当学生在所在学校的自助发卡机终端输入取卡注册码时，自助发卡机终端将取卡注册码与本地数据进行比对校验，校验合格，自助发卡机终端将检验结果发送至发卡云平台，发卡云平台核验其它自助发卡机终端是否已发卡，若没有发卡记录，发卡云平台给该自助发卡机终端发送发卡授权的指令，同步将该取卡注册码修改为已发卡的状态，若已发卡，发卡云平台优先给该自助发卡机终端发送无效取卡注册码的指令，自助发卡机终端收到发卡云平台发卡授权指令后，执行发卡，特别的自助发卡机终端装有IC卡读写装置，IC卡在发卡的过程中读写装置将读取IC卡卡号，同时写入学生信息完成发卡。自助发卡机终端收到发卡云平台无效取卡注册码的指令后，自助发卡机终端弹出“IC卡已完成发卡”，取卡注册码本地校验不合格，自助发卡机终端弹出“取卡注册码无效”，自助发卡机终端执行IC卡发卡后，将已发IC卡的卡号及写入IC卡的学生信息发送至发卡云平台。第六步：IC卡信息同步，发卡云平台收到自助发卡机终端发来的IC卡号及学生信息，发卡云平台首先将该学生的信息备份，然后更新发卡云平台的学生IC卡信息。发卡云平台将更新的IC卡学生信息通过客户端推送给学校老师及学生家长，提醒学校老师及学生家长学生IC卡信息变更。本发明通过设置移动客户端、自助发卡机以及云平台，三部分协同完成IC卡片的申请、信息核验、缴费、发卡授权、卡片领取，显著的降低了自助发卡机的设备成本，并减少了自助发卡机的操作流程，避免在特定时间大量集中取卡时发生的信息输入错误、发卡取卡时间长的问题，此外通过三方信息的交互核验，能够有效提高信息录入可靠性和授权准确性，特别适用于现阶段学校场景下推广应用。
