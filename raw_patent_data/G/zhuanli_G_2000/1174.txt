标题title
基于医疗物联网时序数据和深度学习算法的休克实时风险预警监测方法及系统
摘要abst
本发明涉及一种基于医疗物联网时序数据和深度学习算法的休克实时风险预警监测方法及系统。目前的医疗应用场景的需要同时结合来自医疗物联网的时序数据和医院信息系统采集获取的医疗信息，在传统诊疗过程中融入物理联网技术、智能感知设备、人工智能平台等技术，从而满足特殊医疗情景如突发的高发危重症疾病救治以及管理协同需求。这对医疗领域中的生理监测等时序数据的处理提出诸多挑战，因为这类动态监测的时序数据具有高维度、复杂动态和非线性特征，挖掘医疗时序数据的深度信息能辅助做出更准确的早期临床预测，对于医院尤其是方舱医院的早期休克的预警与救治具有重要意义。
权利要求书clms
1.一种基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述方法的步骤包括：获取时序数据集，所述时序数据集的每个样本包括患者的临床时序数据及标签；对所述时序数据集进行数据预处理得到预处理后的数据，所述数据预处理包括数据增强，所述数据增强的步骤包括：第1步，将所述时序数据集进行稀疏表示得到所述时序数据集的稀疏表示，第2步，评估所述稀疏表示的不确定性得到数据不确定性，第3步，根据所述数据不确定性计算压缩感知算法的参数，第4步，采用所述参数更新压缩感知算法的参数，对所述稀疏表示进行数据重建得到增强数据；将所述预处理后的数据输入机器学习模型中，得到预测的分类结果，将所述预测的分类结果与所述数据集中的标签进行对比，根据对比结果优化所述机器学习模型，得到疾病实时风险预警监测模型。2.根据权利要求1所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述数据增强技术的步骤还包括对所述增强数据进行质量评估得到质量评估指标，所述质量评估指标由所述增强数据与所述时序数据集之间的相似性决定，根据所述质量评估指标进行判断，如果所述质量评估指标未达到设定的阈值，则根据所述质量评估指标更新所述压缩感知算法参数，所述压缩感知算法采用所述参数对所述稀疏表示进行数据重建得到迭代后的增强数据，重复上述步骤直至所述迭代后的增强数据的质量评估指标达到设定的阈值后输出迭代后的增强数据。3.根据权利要求1所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述数据预处理还包括信号处理，所述信号处理包括下列方法中的一种或几种：滤波、去噪、采样与重构、时频转换、标准化、相位调整、去趋势、数字信号处理、谱分析。4.根据权利要求1所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述稀疏表示根据所述时序数据集的特性动态选择变换域进行稀疏表示得到数据的最优稀疏表示，所述最优稀疏表示在各变换域中信号的非零成分最少。5.根据权利要求1所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，使用信息熵评估得到所述稀疏表示的所述数据不确定性，所述信息熵的计算公式为其中，S是稀疏表示，H是所述稀疏表示信息熵。6.根据权利要求1所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，先使用贝叶斯公式得到给定所述时序数据集D条件下的稀疏表示S的后验概率p，计算公式如下：然后，根据所述稀疏表示S的后验概率p使用信息熵评估得到所述稀疏表示的数据不确定性，计算公式如下：其中，表示在给定的所述时序数据集D条件下稀疏表示S的不确定性。7.根据权利要求2所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述质量评估方法包括下列方法中的一种或几种：均方根误差、峰值信噪比、结构相似性指数、峭度和偏度、频谱分析。8.根据权利要求1所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述预处理后的数据进行特征提取后输入所述机器学习模型，所述特征提取的方法包括下列方法的一种或几种：傅里叶变换、小波变换、卷积神经网络、循环神经网络、自编码器、主成分分析、独立成分分析、局部感知字段、注意力机制、特征提取神经网络。9.根据权利要求8所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述特征提取神经网络包括输入层、双向长短时记忆网络层、全连接层、卷积层、注意力增强层和输出层，所述预处理后的数据经过双向长短时记忆网络层提取数据的时域相关性，所述双向长短时记忆网络的输出传入全连接层后进行时频变换得到数据的时频矩阵，所述时频矩阵经过卷积层后提取得到数据的深度时频特征，所述深度时频特征经过注意力增强层后输出提取特征。10.根据权利要求9所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述注意力增强层的步骤包括：第1步，将所述深度时频特征转换为一维向量；第2步，计算所述一维向量的注意力评分；第3步，转换所述注意力评分得到转换后的评分向量；第4步，对所述评分向量进行缩放得到缩放注意力评分；第5步，将所述缩放注意力评分和所述一维向量结合，输出注意力增强的特征。11.根据权利要求1-10任意一项所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述机器学习模型包括下列模型中的一种或几种：线性回归、逻辑回归、决策树、支持向量机、支持向量回归、k近邻算法、随机森林、梯度提升、多层感知机、卷积神经网络、循环神经网络、反馈型神经网络、自注意力模型、生成对抗网络、自编码器、深度强化学习模型、预训练模型、联邦学习。12.根据权利要求11所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述反馈型神经网络包括下列模型中的一种或几种：简单循环神经网络、长短时记忆网络、门控循环单元、Echo State Network、Hopfield网络、双向循环神经网络。13.根据权利要求12所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述Hopfield网络模型的构建方法包括：第1步：根据所述预处理后的数据或所述提取特征初始化所述Hopfield网络的参数得到初始化的Hopfield网络，其中，所述Hopfield网络的参数包括初始权重和高阶相互作用项，其中，所述预处理后的数据或所述提取特征来自训练集；第2步：将所述训练集输入所述初始化的Hopfield网络，得到预测的分类结果，将所述预测的分类结果与所述训练集中的标签进行对比，根据对比结果优化所述Hopfield网络的权重、高阶相互作用项和学习率，直至达到停止条件得到训练好的第一Hopfield网络。14.根据权利要求13所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述Hopfield网络模型的构建步骤还包括：第1步，所述预处理后的数据或所述提取特征还包括测试集，使用所述训练好的第一Hopfield网络对所述测试集进行分类得到分类结果；第2步，根据所述分类结果计算所述训练好的第一Hopfield网络的决策置信度，若所述置信度未达到预设的阈值，则根据所述置信度更新训练好的第一Hopfield网络的权重、高阶相互作用项和学习率后继续训练，重复上述步、第1步至第2步直至所述置信度达到预设的阈值输出构建好的训练好的第二Hopfield网络模型。15.根据权利要求1所述的基于时序数据的疾病实时风险预警监测模型的构建方法，其特征在于，所述疾病包括下列疾病中的一种或几种：低血容量性休克、分布性休克、梗阻性休克和心源性休克。16.一种基于时序数据的疾病实时风险预警监测方法，其特征在于，所述方法包括：获取被试的时序数据；将所述被试的时序数据输入训练好的机器学习模型输出预测分类，如果所述预测分类显示存在疾病风险则进行疾病实时风险预警监测，所述训练好的机器学习模型根据权利要求1-15的构建方法得到。17.一种基于时序数据的疾病实时风险预警监测设备，其特征在于，包括：存储器和处理器；所述存储器用于存储程序指令；所述处理器用于调用程序指令，当程序指令被执行时实现权利要求1-15任意一项所述的基于时序数据的疾病实时风险预警监测模型的构建方法的任一步骤或实现权利要求16所述的基于时序数据的疾病实时风险预警监测方法。18.一种基于时序数据的疾病实时风险预警监测系统，其特征在于，所述系统包括计算机程序，所述计算机程序被处理器执行时实现权利要求1-15任意一项所述的基于时序数据的疾病实时风险预警监测模型的构建方法或实现权利要求16所述的基于时序数据的疾病实时风险预警监测方法。19.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1-15任意一项所述的基于时序数据的疾病实时风险预警监测模型的构建方法的任一步骤或实现权利要求16所述的基于时序数据的疾病实时风险预警监测方法。
说明书desc
技术领域本发明涉及智能医疗技术领域，更具体地，涉及一种基于医疗物联网时序数据和深度学习算法的疾病实时风险预警监测模型的构建方法和疾病实时风险预警监测方法、系统、设备及计算机可读存储介质。背景技术方舱医院：旨在快速开展医疗应急救治业务，需要实现资源快速协同，包括物联网、远程医疗、人工智能、多源异构数据融合，从而实现线上诊疗、机器人查房、智能配送、智能辅助诊疗业务的融合，满足突发的高发危重症疾病救治以及管理协同需求。这对医疗领域中的生理监测等时序数据的处理提出诸多挑战，因为这类动态监测的时序数据具有高维度、复杂动态和非线性特征，传统的数据处理方法往往不能充分挖掘利用这些时序数据中的信息，现有的机器学习模型在考虑时序数据的演变趋势、周期性和长程依赖性时表现不佳，无法全面捕捉数据中的关键时域特征，这种不足在医疗领域中尤为显著，挖掘医疗时序数据的深度信息能辅助做出更准确的预警监测，对于医院尤其是方舱医院患者早期休克的预警与救治具有重要意义。发明内容鉴于上述问题，本发明提供一种基于时序数据的疾病实时风险预警监测模型的构建方法，利用数据处理和特征提取捕捉时序数据中的信息，并对疾病预测模型的参数提出改进，并进行有效优化，从而构建形成适用于临床的疾病实时风险预警监测模型。一种基于时序数据的疾病实时风险预警监测模型的构建方法，包括：获取时序数据集，所述时序数据集的每个样本包括患者的临床时序数据及标签；对所述时序数据集进行数据预处理得到预处理后的数据，所述数据预处理包括数据增强，所述数据增强的步骤包括：第1步，将所述时序数据集进行稀疏表示得到所述时序数据集的稀疏表示，第2步，评估所述稀疏表示的不确定性得到数据不确定性，第3步，根据所述数据不确定性计算压缩感知算法的参数，第4步，采用所述参数更新压缩感知算法的参数，对所述稀疏表示进行数据重建得到增强数据；将所述预处理后的数据输入机器学习模型中，得到预测的分类结果，将所述预测的分类结果与所述数据集中的标签进行对比，根据对比结果优化所述机器学习模型，得到疾病实时风险预警监测模型。进一步，所述数据增强技术的步骤还包括对所述增强数据进行质量评估得到质量评估指标，所述质量评估指标由所述增强数据与所述时序数据集之间的相似性决定，根据所述质量评估指标进行判断，如果所述质量评估指标未达到设定的阈值，则根据所述质量评估指标更新所述压缩感知算法参数，所述压缩感知算法采用所述参数对所述稀疏表示进行数据重建得到迭代后的增强数据，重复上述步骤直至所述迭代后的增强数据的质量评估指标达到设定的阈值后输出迭代后的增强数据。进一步，所述数据预处理还包括信号处理，所述信号处理包括下列方法中的一种或几种：滤波、去噪、采样与重构、时频转换、标准化、相位调整、去趋势、数字信号处理、谱分析。进一步，所述稀疏表示根据所述时序数据集的特性动态选择变换域进行稀疏表示得到数据的最优稀疏表示，所述最优稀疏表示在各变换域中信号的非零成分最少。进一步，使用信息熵评估得到所述稀疏表示的所述数据不确定性，所述信息熵的计算公式为其中，S是稀疏表示，H是所述稀疏表示信息熵。进一步，先使用贝叶斯公式得到给定所述时序数据集D条件下的稀疏表示S的后验概率p，计算公式如下：然后，根据所述稀疏表示S的后验概率p使用信息熵评估得到所述稀疏表示的数据不确定性，计算公式如下：其中，表示在给定的所述时序数据集D条件下稀疏表示S的不确定性。进一步，所述质量评估方法包括下列方法中的一种或几种：均方根误差、峰值信噪比、结构相似性指数、峭度和偏度、频谱分析。进一步，所述预处理后的数据进行特征提取后输入所述机器学习模型，所述特征提取的方法包括下列方法的一种或几种：傅里叶变换、小波变换、卷积神经网络、循环神经网络、自编码器、主成分分析、独立成分分析、局部感知字段、注意力机制、特征提取神经网络。进一步，所述特征提取神经网络包括输入层、双向长短时记忆网络层、全连接层、卷积层、注意力增强层和输出层，所述预处理后的数据经过双向长短时记忆网络层提取数据的时域相关性，所述双向长短时记忆网络的输出传入全连接层后进行时频变换得到数据的时频矩阵，所述时频矩阵经过卷积层后提取得到数据的深度时频特征，所述深度时频特征经过注意力增强层后输出提取特征。进一步，所述注意力增强层的步骤包括：第1步，将所述深度时频特征转换为一维向量；第2步，计算所述一维向量的注意力评分；第3步，转换所述注意力评分得到转换后的评分向量；第4步，对所述评分向量进行缩放得到缩放注意力评分；第5步，将所述缩放注意力评分和所述一维向量结合，输出注意力增强的特征。进一步，所述机器学习模型包括下列模型中的一种或几种：线性回归、逻辑回归、决策树、支持向量机、支持向量回归、k近邻算法、随机森林、梯度提升、多层感知机、卷积神经网络、循环神经网络、反馈型神经网络、自注意力模型、生成对抗网络、自编码器、深度强化学习模型、预训练模型、联邦学习。进一步，所述反馈型神经网络包括下列模型中的一种或几种：简单循环神经网络、长短时记忆网络、门控循环单元、Echo State Network、Hopfield网络、双向循环神经网络。进一步，所述Hopfield网络模型的构建方法包括：第1步：根据所述预处理后的数据或所述提取特征初始化所述Hopfield网络的参数得到初始化的Hopfield网络，其中，所述Hopfield网络的参数包括初始权重和高阶相互作用项，其中，所述预处理后的数据或所述提取特征来自训练集；第2步：将所述训练集输入所述初始化的Hopfield网络，得到预测的分类结果，将所述预测的分类结果与所述训练集中的标签进行对比，根据对比结果优化所述Hopfield网络的权重、高阶相互作用项和学习率，直至达到停止条件得到训练好的第一Hopfield网络。进一步，所述Hopfield网络模型的构建步骤还包括：第1步，所述预处理后的数据或所述提取特征还包括测试集，使用所述训练好的第一Hopfield网络对所述测试集进行分类得到分类结果；第2步，根据所述分类结果计算所述训练好的第一Hopfield网络的决策置信度，若所述置信度未达到预设的阈值，则根据所述置信度更新训练好的第一Hopfield网络的权重、高阶相互作用项和学习率后继续训练，重复上述步、第1步至第2步直至所述置信度达到预设的阈值输出构建好的训练好的第二Hopfield网络模型。进一步，所述疾病包括下列疾病中的一种或几种：低血容量性休克、分布性休克、梗阻性休克和心源性休克。一种基于时序数据的疾病实时风险预警监测方法，所述方法包括：获取被试的时序数据；将所述被试的时序数据输入训练好的机器学习模型输出预测分类，如果所述预测分类显示存在疾病风险则进行疾病实时风险预警监测，所述训练好的机器学习模型采用上述的基于时序数据的疾病实时风险预警监测方法训练完成。一种基于时序数据的疾病实时风险预警监测设备，包括：存储器和处理器；所述存储器用于存储程序指令；所述处理器用于调用程序指令，当程序指令被执行时实现上述的基于时序数据的疾病实时风险预警监测模型的构建方法的步骤或实现上述的基于时序数据的疾病实时风险预警监测方法。一种基于时序数据的疾病实时风险预警监测系统，所述系统包括计算机程序，所述计算机程序被处理器执行时实现上述的基于时序数据的疾病实时风险预警监测模型的构建方法的步骤或实现上述的基于时序数据的疾病实时风险预警监测方法。一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述的基于时序数据的疾病实时风险预警监测模型的构建方法的步骤或实现上述的基于时序数据的疾病实时风险预警监测方法。本申请的优势：1、本申请在传统信号处理的基础上进行创新，引入数据增强，并通过评估数据不确定性来增强数据，使得预处理后的数据能够更准确地捕捉和增强临床时序数据中的关键信息；2、本申请在特征提取过程中引入了双向长短时记忆网络和注意力增强层，不仅提高了时序数据特征的捕获能力，还能增强机器学习模型对重要特征的关注度，从而提升预测准确性；3、在分类阶段，本发明在Hopfield网络中引入高阶相互作用项来捕获数据中的更复杂模式，提高了模型分类的能力。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获取其他的附图。图1是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测模型的构建方法的示意流程图；图2是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测方法的示意流程图；图3是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测模型的构建系统的示意流程图；图4是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测系统的示意流程图；图5是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测设备的示意框图；图6是本发明实施例提供的特征提取网络模型的示意流程图；图7是本发明实施例提供的双向长短时记忆网络的示意图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述。在本发明的说明书和权利要求书及上述附图中的描述的一些流程中，包含了按照特定顺序出现的多个操作，但是应该清楚了解，这些操作可以不按照其在本文中出现的顺序来执行或并行执行，操作的序号如S101、S102等，仅仅是用于区分开各个不同的操作，序号本身不代表任何的执行顺序。另外，这些流程可以包括更多或更少的操作，并且这些操作可以按顺序执行或并行执行。需要说明的是，本文中的“第一”、“第二”等描述，是用于区分不同的消息、设备、模块等，不代表先后顺序，也不限定“第一”和“第二”是不同的类型。下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域技术人员在没有作出创造性劳动前提下所获取的所有其他实施例，都属于本发明保护的范围。图1是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测模型的构建方法的示意流程图，具体地，所述方法包括如下步骤：S101：获取时序数据集，所述时序数据集的每个样本包括患者的临床时序数据及标签；在一个具体实施例中，所使用的数据为心电数字信号数据，采集自心率传感器。具体的，心电数字信号数据可以表示为一系列的时间序列，其特点是随时间变化而产生不同的心率指标测量值，在一个实施例中，可以表示为：其中，表示在时间的心电图数据，表示在时间点的测量值，为数据序列的长度。在一个具体实施例中，通过心率传感器在某一时刻采集到的心率信号为，这个时序数据代表了心脏在时间的电活动。然后对时序数据进行标注，在一个具体实施例中，采用二元分类方法来标记数据，以区分正常心电信号与异常心电信号，其中，异常心电信号预示休克风险。在一个具体实施例中，标注表示为：其中，表示心电信号的标签，其中表示正常心电信号，表示存在休克风险的心电信号。所述时序数据基于物联网采集获得，所述物联网是指通过各种感知设备、传感器和嵌入式计算设备将现实世界中的物体连接到互联网或局域网的网络中，所述现实世界中的物体包括心率监测器、血压计、呼吸率监测器、体温计、健康监测设置、智能手表和健康手环、智能体重秤、远程医疗设备、远程心电图仪、远程X射线设备、远程医疗机器人、智能药盒、可穿戴药物传输设备、康复设备、环境监测设备、空气质量监测器、感染控制设备。S102：对所述时序数据集进行数据预处理得到预处理后的数据，所述数据预处理包括数据增强，所述数据增强的步骤包括：第1步，将所述时序数据集进行稀疏表示得到所述时序数据集的稀疏表示，第2步，评估所述稀疏表示的不确定性得到数据不确定性，第3步，根据所述数据不确定性计算压缩感知算法的参数，第4步，采用所述参数更新压缩感知算法的参数，对所述稀疏表示进行数据重建得到增强数据；将时序数据转换为适合深度学习算法处理的格式。在一个具体实施例中，首先进行去噪处理，即处理信号中的随机噪声，以提高信号的质量。设原始心率信号为，去噪后的信号表示为。在一个具体实施例中采用高斯滤波器进行去噪处理，可以表示为：其中，表示高斯滤波函数，为高斯分布的标准差，用于控制滤波程度。在一个具体实施例中，为了减少来自物联网的不同心率传感器之间的数据差异，对信号进行标准化处理。在一个具体实施例中，设和分别为的均值和标准差，则标准化后的信号可以表示为：然后，进行数据增强处理。在一个具体实施例中，采用压缩感知算法进行数据增强，具体的，首先根据心率信号的特性，动态选择合适的变换域进行稀疏表示，将心率信号表示为稀疏形式。具体的，首先选择变换域，在一个具体实施例中采用小波变换，可以表示为。则，稀疏表示的方式可以表示为：其中，表示范数，用于衡量向量中非零元素的个数。且小波变换通过选择适合心率信号特性的基函数来进行，以确保在变换后的域中，信号表示最为稀疏。为最优稀疏表示，使得在所选变换域中，信号的非零成分最少。在一个具体实施例中，利用贝叶斯方法和信息熵来评估数据的不确定性，并据此调整压缩感知算法的关键参数，包括重建算法的稀疏度水平和正则化参数。具体的，设表示给定数据下稀疏表示的后验概率，利用贝叶斯方法进行评估的方式可以表示为：在一个具体实施例中，利用信息熵来评估的方法可以表示为：其中，为信息熵，用于评估的不确定性。则，压缩感知算法的关键参数的调整策略可以表示为：其中，是学习率，控制参数更新的速度。通过评估的不确定性，动态调整压缩感知参数。在一个具体实施例中，应用改进的压缩感知算法进行数据重建，重建并增强心率信号，压缩感知重建问题可以表示为：且，使得。其中，是范数，用于促进解的稀疏性。在一个具体实施例中，重建误差可以表示为：其中，表示范数。重建误差衡量重建质量，目标是最小化该误差。在一个具体实施例中，对增强后的数据进行质量评估，如通过比较原始数据与重建数据的差异来检验重建效果。根据这一评估，进行反馈调整，优化数据增强过程。具体的，质量评估指标的计算方式可以表示为：其中，衡量重建数据与原始数据的相似度，越接近1表示质量越高。若质量评估指标达到预设的阈值，则数据增强完成，否则进行反馈调整，反馈调整策略可以表示为：其中，是优化学习率，控制反馈调整的速度。通过数据增强后的数据设为数组，将该数组输入到特征提取网络模型中进行特征提取。特征提取神经网络模型包含输入层、双向长短时记忆网络层、全连接层、卷积层、注意力增强层和输出层。在一个具体实施例中，用特征提取该网络模型进行心率电数字信号的特征提取过程如附图6所示：特征提取神经网络包括输入层、双向长短时记忆网络层、全连接层、卷积层、注意力增强层和输出层，输入心率电数字信号数据集，输入的数据集通过双向长短时记忆网络进行双向传播对输入的心率电数字信号的时序特征进行选择性筛选得到筛选后的特征，筛选后的特征传入全连接层后进行时频变换得到数据的时频矩阵，时频矩阵经过卷积层后提取得到数据的深度时频特征，深度时频特征经过注意力增强层后输出提取特征。其中，双向长短时记忆网络的工作机制如附图7所示：该网络具有前向传播和后向传播的结构特性，时序数据输入BiLTSM，所述时序数据按照时间顺序传递给正向的长短时记忆网络，在每个时间步，LSTM单元计算新的隐藏状态和输出，并将其传递到下一个时间步；同时所述时序数据按照时间逆序传递给逆向的LSTM网络，逆向LSTM也在每个时间步计算新的隐藏状态和输出，并将其传递到前一个时间步；在每个时间步，BiLSTM将正向和逆向LSTM的隐藏状态连接在一起，形成一个更全面的隐藏状态表示，这样，每个时间步的输出包含了整个序列的信息，包括过去和未来的上下文。这样BiLTSM在双向结构处理时序心率电数字信号的基础上提高了网络的稳定性。双向长短时记忆网络主要提取的是心率电数字信号中的时域相关性，其核心是利用记忆块对输入的心率电数字信号脉冲进行长期或短期的记忆，通过门机制进行管理实现一种多层次的特征选。具体的，双向长短时记忆网络层以c为长记忆时间轴，h为短记忆时间轴，通过长短时记忆功能将时序心率电数字信号脉冲信息进行选择性的遗忘，从而保留有效特征，剔除无效或重复信息。如果在时刻双向长短时记忆网络前向传播输出的隐藏状态为，而反向的输出隐藏状态为，则双向长短时记忆网络输出的是前向网络与后向网络在每个时刻的综合输出，总输出的隐藏状态可以表示为：其中，为全连接操作；是在时间点的总输出隐藏状态，表示在该时刻网络对输入信号的编码；是在相同时间点的前向长短时记忆网络的隐藏状态输出；是在时间点的后向长短时记忆网络的隐藏状态输出。在一个具体实施例中，双向长短时记忆网络的输出传入全连接层后利用时频变换获得一个新的心率电数字信号时频矩阵，当时频矩阵经过由多个卷积层与最大池化层交替堆叠组成的卷积层后，对心率电数字信号进行深度特征提取。在卷积层提取心率电数字信号的时频特征时，通过连续小波变换获得心率电数字信号时频特征矩阵，其中包含具有时频特征的心率电数字信号数组和每组所对应的特征标签，心率电数字信号数组由个心率电数字信号脉冲元素组成，可以表示为，此过程的目标是找到模型参数，使得在给定心率电数字信号数据 X 的情况下，模型能够最大化正确预测标签 Y 的概率，目标函数可以表示为：当单通道心率电数字信号时频矩阵作为输入时，具有时频特征的心率电数字信号数组里元素向量为，且，其中是心率电数字信号元素数量，是矢量维度。通过设置的过滤器提取输入心率电数字信号的时频特征，可以表示为：其中，是卷积核，是卷积核的大小，是由到个心率电数字信号脉冲元素组成的数组向量，是偏差项。在经过卷积层处理后，特征矩阵可以表示为：在一个具体实施例中，将特征矩阵通过池化层对心率电数字信号的局部特征矩阵进行下采样处理，生成局部值的最佳解。此处使用最大池化的方法，可以表示为：进而，经过池化操作后，每个卷积核提取的特征向量在一定程度上有所减少，但仍保留了心率电数字信号核心的时频特征相关信息。在一个具体实施例中，将得到多组时频特征向量输入到注意力增强层进行注意力增强操作。由于特征提取神经网络从心率电数字信号时频矩阵中获取时频特征时，卷积层的输出结果易出现过拟合，在卷积层后增加注意力增强，能够忽略少部分的非重要特征，增强重要特征的相互作用，使得特征提取神经网络不会形成依赖的状况，提高网络模型的泛化能力。注意力增强层首先将多组时频特征向量进行级联，表示为一个一维向量，对于该向量，计算一个初始的注意力评分，计算方式通过向量与其自身的转置的非线性映射来实现，具体的，使用一个参数化的小型神经网络函数进行计算，可以表示为：其中，是参数矩阵，在该参数化的小型神经网络训练过程中学习。在一个具体实施例中，对注意力评分进行非线性转换。采用ReLU激活函数和参数矩阵进行非线性变换，可以表示为：其中，每个是一个参数矩阵，是一个非线性函数，是转换的层数，是变换后的注意力评分。下一步，对评分向量进行自适应缩放，以便更好捕获向量中的相对重要性。设置参数，是通过一个sigmoid函数控制的，对评分向量进行自适应缩放，自适应缩放的方式可以表示为：其中，是一个参数向量。下一步，将缩放的注意力评分与原始向量结合，以产生最终的注意力增强向量，可以表示为：其中，表示向量的元素乘积。S103：将所述预处理后的数据输入机器学习模型中，得到预测的分类结果，将所述预测的分类结果与所述数据集中的标签进行对比，根据对比结果优化所述机器学习模型，得到疾病实时风险预警监测模型。在一个具体实施例中，将特征提取后的数据输入到改进的Hopfield网络中进行分类。本发明的改进的Hopfield网络包含高阶相互作用项，允许网络捕捉数据中的更复杂模式，特别是心电数字信号数据中的非线性特征。具体的，在改进的Hopfield网络的训练过程中，首先根据特征提取后的特性初始化改进的Hopfield网络，包括设置高阶相互作用项和初始权重。设特征提取后的数据样本为，则网络权重初始化的方式可以表示为：其中，表示二阶相互作用，即Hopfield网络中的权重。表示神经元索引，表示特征索引。在一个具体实施例中，引入高阶项，用于表示三个神经元之间的相互作用，初始化为：其中，为新引入的高阶项，捕获样本间更复杂的相互关系。在一个具体实施例中，在训练过程中，根据分类错误率和置信度评估结果动态调整学习率和网络权重。设分类错误率为，初始学习率为，则学习率调整策略可以表示：其中，是调整因子。在一个具体实施例中，权重和高阶项的更新方式可以表示为：。其中，和为基于梯度下降的权重更新项。在一个具体实施例中，利用训练好的改进的Hopfield网络对新的心率信号样本进行分类，可以表示为：其中，为第个神经元的输出。同时，计算每个决策的置信度，计算方式可以表示为：其中，表示置信度，用于评估分类决策的可靠性。为基于置信度的权重更新率。在一个具体实施例中，根据分类决策的置信度评估结果，进一步优化网络的权重和参数，以提高未来分类的准确性。具体的，若置信度未达到预设的阈值，则更新权重，更新的方式可以表示为：若置信度达到预设的阈值，则表示网络训练完成。机器学习模型可以使用联邦学习训练，所述联邦学习新联步骤包括：第一步，在中央服务器上初始化一个全局模型；第二步，将所述全局模型发送到多个用户端，所述用户端在本地设备上使用本地数据对模型进行训练；第三步，将本地设备训练后的模型参数发送回中央服务器；第四步，中央服务器聚合所有本地设备的模型参数，更新全局模型；重复上述步骤，直至损失函数收敛或训练轮数达到模型预设轮数。图2本发明实施例提供的一种基于时序数据的疾病实时风险预警监测方法的示意流程图。S201：获取被试的时序数据；S202：将所述被试的时序数据输入训练好的机器学习模型输出预测分类，如果所述预测分类显示存在疾病风险则进行疾病实时风险预警监测，所述训练好的机器学习模型根据上述基于时序数据的预警模型的构建方法得到。在一个具体实施例中，在进行休克实时风险预警时，分类结果包括0和1，可以表示为：其中，表示心电信号的标签，其中表示正常心电信号，表示存在休克风险的心电信号。异常心电信号预示休克风险。在一个具体实施例中，通过物联网设备持续监测并传输患者的心率信号，实时应用基于时序数据的疾病实时风险预警监测方法进行分类。一旦模型识别出表示休克风险的心率信号，并且置信度高于设定阈值，预警机制将被触发。预警机制包括自动通知医疗专业人员、激活紧急响应系统等。图3是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测模型的构建系统的示意流程图。一种基于时序数据的疾病实时风险预警监测的构建系统，包括：获取模块301：用于获取时序数据集；数据处理模块302：用于对所述时序数据集进行数据预处理得到预处理后的数据；机器学习训练模块303：将所述预处理后的数据输入机器学习模型中，得到预测的分类结果，将所述预测的分类结果与所述数据集中的标签进行对比，根据对比结果优化所述机器学习模型，得到所述训练好的机器学习模型。图4是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测系统的示意流程图。一种基于时序数据的疾病实时风险预警监测系统，包括：实时信号采集模块401：用于实时采集被试的时序数据；预测模块402：用于将所述被试的时序数据输入训练好的机器学习模型输出预测分类，如果所述预测分类显示存在疾病风险则进行疾病实时风险预警监测，所述训练好的机器学习模型是采用上述的基于时序数据的疾病实时风险预警监测模型的构建方法训练完成。图5是本发明实施例提供的一种基于时序数据的疾病实时风险预警监测设备的示意框图。一种基于时序数据的疾病实时风险预警监测设备，包括：存储器和处理器；所述存储器用于存储程序指令；所述处理器用于调用程序指令，当程序指令被执行时实现上述的基于时序数据的疾病实时风险预警监测方法的步骤。所述患病风险的分类结果包括但不限于：是否患病的二分类结果、多种疾病的多分类结果、疾病风险的高低概率、疾病的分期、疾病的分型等等。一种计算机可读存储介质，所述计算机可读取存储介质存储有计算机程序，所述计算机程序被处理器执行时实现上述的疾病风险预测方法步骤。本验证实施例的验证结果表明，为适应症分配固有权重相对于默认设置来说可以适度改善本方法的性能。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的系统，装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在本申请所提供的几个实施例中，应该理解到，所揭露的系统，装置和方法，可以通过其它的方式实现。例如，以上所描述的装置实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。本领域普通技术人员可以理解上述实施例的各种方法中的全部或部分步骤是可以通过程序来指令相关的硬件来完成，该程序可以存储于一计算机可读存储介质中，存储介质可以包括：只读存储器、随机存取存储器、磁盘或光盘等。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分步骤是可以通过程序来指令相关的硬件完成，所述的程序可以存储于一种计算机可读存储介质中，上述提到的存储介质可以是只读存储器，磁盘或光盘等。以上对本发明所提供的一种计算机设备进行了详细介绍，对于本领域的一般技术人员，依据本发明实施例的思想，在具体实施方式及应用范围上均会有改变之处，综上所述，本说明书内容不应理解为对本发明的限制。
