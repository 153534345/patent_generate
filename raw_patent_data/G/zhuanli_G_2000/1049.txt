标题title
流量录制方法、装置、存储介质及计算机设备
摘要abst
本申请提供的流量录制方法、装置、存储介质及计算机设备，方法包括：接收预设时间周期内每个应用端发起的业务请求，获取每个业务请求的请求接口及请求参数，获取特征表，特征表包括多个请求接口及对应的特征字段；特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在且对应的值均相等的参数；对于任意一个业务请求，根据特征表，若该业务请求对应的请求接口满足预设条件，则获取录制数据表，若该业务请求对应的请求接口不存在于录制数据表，则对该业务请求进行录制，将录制的数据写入录制数据表。通过有选择地录制请求数据，即对于每个请求接口的请求数据而言，可用于测试多个应用端发往该请求接口的请求，提高录制数据的通用性。
权利要求书clms
1.一种流量录制方法，其特征在于，所述方法应用于服务端，包括：响应于对目标应用的流量录制指令，接收预设时间周期内所述目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数；获取特征表；其中，所述特征表包括多个请求接口及每个请求接口对应的特征字段；所述特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数；对于每个业务请求中的任意一个业务请求，根据所述特征表，判断该业务请求对应的请求接口是否满足预设条件；若该业务请求对应的请求接口满足所述预设条件，则获取录制数据表，并判断该业务请求对应的请求接口是否存在于所述录制数据表中；若该业务请求对应的请求接口不存在于所述录制数据表中，则对该业务请求进行录制，并将录制的数据写入所述录制数据表中。2.根据权利要求1所述的流量录制方法，其特征在于，所述方法还包括：定时获取目标请求数据，并确定预设的临时表；其中，所述目标请求数据包括当前所述服务端的日志中所有数据记录，所述服务端的日志中的每条数据记录包括请求接口、请求参数及返回数据；对于每次获取的目标请求数据，根据所述目标请求数据中各条数据记录的请求接口，将所述目标请求数据划分为多个请求数据组；其中，任意一个请求数据组中的各条数据记录对应的请求接口均相同；对各个所述请求数据组进行特征清洗，并根据特征清洗的结果判断各个所述请求数据组是否存在与其对应的特征字段；对于各个所述请求数据组中的任意一个请求数据组，若该请求数据组存在与其对应的特征字段，则将该请求数据组对应的请求接口及特征字段写入所述临时表中；根据所述临时表，更新所述服务端的日志数据；根据所述临时表，更新所述特征表。3.根据权利要求2所述的流量录制方法，其特征在于，所述对各个所述请求数据组进行特征清洗，包括：对于各个所述请求数据组中的任意一个请求数据组，获取该请求数据组中的各条数据记录对应的请求参数及返回数据；若该请求数据组中各条数据记录中存在相同的请求参数且该请求参数在该请求数据组的各条数据记录对应的返回数据中对应的值均相同，则将该请求参数确定为该请求数据组对应的特征字段。4.根据权利要求2所述的流量录制方法，其特征在于，所述根据所述临时表，更新所述服务端的日志数据，包括：获取第一请求接口；其中，所述第一请求接口为所述服务端的日志数据中任意一条数据记录的请求接口；若所述第一请求接口不存在于所述临时表中，则在所述服务端的日志数据中删除与所述第一请求接口对应的数据记录，以完成对所述服务端的日志数据的更新。5.根据权利要求2所述的流量录制方法，其特征在于，所述根据所述临时表，更新所述特征表，包括：获取第二请求接口；其中，所述第二请求接口为所述特征表中任意一条数据记录的请求接口；若所述第二请求接口存在于所述临时表中，则将所述特征表中与所述第二请求接口对应的特征字段更新为所述临时表中与所述第二请求接口对应的特征字段。6.根据权利要求1所述的流量录制方法，其特征在于，所述根据所述特征表，判断该业务请求对应的请求接口是否满足预设条件，包括：判断该业务请求对应的请求接口是否存在于所述特征表中；若该业务请求对应的请求接口存在于所述特征表中，则确定目标数据记录；其中，所述目标数据记录为在所述特征表中与该业务请求对应的请求接口对应的数据记录；判断该业务请求的请求参数中是否存在与所述目标数据记录对应的特征字段相同的请求参数；若存在，则该业务请求对应的请求接口满足所述预设条件；若不存在，则该业务请求对应的请求接口不满足所述预设条件。7.根据权利要求1至6任一项所述的流量录制方法，其特征在于，所述方法还包括：当所述预设时间周期结束时，获取所述录制数据表中的所有数据，所述录制数据表中的所有数据用于对各个应用端的接口进行回放测试。8.一种流量录制装置，其特征在于，所述装置应用于服务端，包括：请求接收模块，用于响应于对目标应用的流量录制指令，接收预设时间周期内所述目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数；第一获取模块，用于获取特征表；其中，所述特征表包括多个请求接口及每个请求接口对应的特征字段；所述特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数；判断模块，用于对于每个业务请求中的任意一个业务请求，根据所述特征表，判断该业务请求对应的请求接口是否满足预设条件；第二获取模块，用于若该业务请求对应的请求接口满足所述预设条件，则获取录制数据表，并判断该业务请求对应的请求接口是否存在于所述录制数据表中；请求录制模块，用于若该业务请求对应的请求接口不存在于所述录制数据表中，则对该业务请求进行录制，并将录制的数据写入所述录制数据表中。9.一种存储介质，其特征在于：所述存储介质中存储有计算机可读指令，所述计算机可读指令被一个或多个处理器执行时，使得一个或多个处理器执行如权利要求1至7中任一项所述流量录制方法的步骤。10.一种计算机设备，其特征在于，包括：一个或多个处理器，以及存储器；所述存储器中存储有计算机可读指令，所述计算机可读指令被所述一个或多个处理器执行时，执行如权利要求1至7中任一项所述流量录制方法的步骤。
说明书desc
技术领域本申请涉及自动化测试技术领域，尤其涉及一种流量录制方法、装置、存储介质及计算机设备。背景技术流量录制和回放是测试应用接口的方式之一，是指在不影响用户正常使用的前提下，获取线上用户的真实请求和服务响应结果，将其保存作为测试用例；与传统接口自动化测试相比，流量录制的最大优势是降低了构造测试数据和用例编写的成本。利用流量即用例的思想，可以直接将线上流量转化成接口测试用例，从而避免了繁琐的测试数据准备和脚本编写工作。目前，流量录制过程中保存的流量请求具备较强的针对性，一般是根据目标应用的其中一个应用端的请求结构来配置流量录制的规则，对于同一个请求接口而言，难以将根据该应用端录制的流量数据在目标应用的其他应用端中进行流量回放，降低了流量录制数据的通用性，进而影响测试的效率。发明内容本申请的目的旨在至少能解决上述的技术缺陷之一，特别是现有技术中对于同一个请求接口而言，难以将根据该应用端录制的流量数据在目标应用的其他应用端中进行流量回放，降低了流量录制数据的通用性，进而影响测试的效率的技术缺陷。第一方面，本申请提供了一种流量录制方法，所述方法应用于服务端，包括：响应于对目标应用的流量录制指令，接收预设时间周期内所述目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数；获取特征表；其中，所述特征表包括多个请求接口及每个请求接口对应的特征字段；所述特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数；对于每个业务请求中的任意一个业务请求，根据所述特征表，判断该业务请求对应的请求接口是否满足预设条件；若该业务请求对应的请求接口满足所述预设条件，则获取录制数据表，并判断该业务请求对应的请求接口是否存在于所述录制数据表中；若该业务请求对应的请求接口不存在于所述录制数据表中，则对该业务请求进行录制，并将录制的数据写入所述录制数据表中。在其中一个实施例中，所述方法还包括：定时获取目标请求数据，并确定预设的临时表；其中，所述目标请求数据包括当前所述服务端的日志中所有数据记录，所述服务端的日志中的每条数据记录包括请求接口、请求参数及返回数据；对于每次获取的目标请求数据，根据所述目标请求数据中各条数据记录的请求接口，将所述目标请求数据划分为多个请求数据组；其中，任意一个请求数据组中的各条数据记录对应的请求接口均相同；对各个所述请求数据组进行特征清洗，并根据特征清洗的结果判断各个所述请求数据组是否存在与其对应的特征字段；对于各个所述请求数据组中的任意一个请求数据组，若该请求数据组存在与其对应的特征字段，则将该请求数据组对应的请求接口及特征字段写入所述临时表中；根据所述临时表，更新所述服务端的日志数据；根据所述临时表，更新所述特征表。在其中一个实施例中，所述对各个所述请求数据组进行特征清洗，包括：对于各个所述请求数据组中的任意一个请求数据组，获取该请求数据组中的各条数据记录对应的请求参数及返回数据；若该请求数据组中各条数据记录中存在相同的请求参数且该请求参数在该请求数据组的各条数据记录对应的返回数据中对应的值均相同，则将该请求参数确定为该请求数据组对应的特征字段。在其中一个实施例中，所述根据所述临时表，更新所述服务端的日志数据，包括：获取第一请求接口；其中，所述第一请求接口为所述服务端的日志数据中任意一条数据记录的请求接口；若所述第一请求接口不存在于所述临时表中，则在所述服务端的日志数据中删除与所述第一请求接口对应的数据记录，以完成对所述服务端的日志数据的更新。在其中一个实施例中，所述根据所述临时表，更新所述特征表，包括：获取第二请求接口；其中，所述第二请求接口为所述特征表中任意一条数据记录的请求接口；若所述第二请求接口存在于所述临时表中，则将所述特征表中与所述第二请求接口对应的特征字段更新为所述临时表中与所述第二请求接口对应的特征字段。在其中一个实施例中，所述根据所述特征表，判断该业务请求对应的请求接口是否满足预设条件，包括：判断该业务请求对应的请求接口是否存在于所述特征表中；若该业务请求对应的请求接口存在于所述特征表中，则确定目标数据记录；其中，所述目标数据记录为在所述特征表中与该业务请求对应的请求接口对应的数据记录；判断该业务请求的请求参数中是否存在与所述目标数据记录对应的特征字段相同的请求参数；若存在，则该业务请求对应的请求接口满足所述预设条件；若不存在，则该业务请求对应的请求接口不满足所述预设条件。在其中一个实施例中，所述方法还包括：当所述预设时间周期结束时，获取所述录制数据表中的所有数据，所述录制数据表中的所有数据用于对各个应用端的接口进行回放测试。第二方面，本申请提供了一种流量录制装置，所述装置应用于服务端，包括：请求接收模块，用于响应于对目标应用的流量录制指令，接收预设时间周期内所述目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数；第一获取模块，用于获取特征表；其中，所述特征表包括多个请求接口及每个请求接口对应的特征字段；所述特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数；判断模块，用于对于每个业务请求中的任意一个业务请求，根据所述特征表，判断该业务请求对应的请求接口是否满足预设条件；第二获取模块，用于若该业务请求对应的请求接口满足所述预设条件，则获取录制数据表，并判断该业务请求对应的请求接口是否存在于所述录制数据表中；请求录制模块，用于若该业务请求对应的请求接口不存在于所述录制数据表中，则对该业务请求进行录制，并将录制的数据写入所述录制数据表中。第三方面，本申请提供了一种存储介质，所述存储介质中存储有计算机可读指令，所述计算机可读指令被一个或多个处理器执行时，使得一个或多个处理器执行如上述任一项实施例所述流量录制方法的步骤。第四方面，本申请提供了一种计算机设备，包括：一个或多个处理器，以及存储器；所述存储器中存储有计算机可读指令，所述一个或多个处理器执行时所述计算机可读指令时，执行如上述任一项实施例所述流量录制方法的步骤。从以上技术方案可以看出，本申请实施例具有以下优点：本申请提供的流量录制方法，响应于对目标应用的流量录制指令，接收预设时间周期内目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数，获取特征表，其中，特征表包括多个请求接口及每个请求接口对应的特征字段，特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数，对于每个业务请求中的任意一个业务请求，根据特征表，从而判断该业务请求对应的请求接口是否满足预设条件，若该业务请求对应的请求接口满足预设条件，则获取录制数据表，并判断该业务请求对应的请求接口是否存在于录制数据表中，若该业务请求对应的请求接口不存在于录制数据表中，则对该业务请求进行录制，并将录制的数据写入录制数据表中。通过记录目标应用的不同应用端发往同一请求接口的请求中均存在且对应的值相等的参数，即特征字段，从而根据请求接口及其对应的特征字段有选择地录制请求数据，通过判断请求接口是否存在于录制数据表中，使得录制的数据中请求接口不重复，即对于每个请求接口而言，只录制一份对应的请求数据，在回放测试时，可以将录制得到的数据与各个应用端发起的请求进行匹配，以完成接口测试，即每个请求接口对应的请求数据可以用于测试多个应用端发往该请求接口的请求，从而提高流量录制数据的通用性和应用接口测试的效率。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其它的附图。图1为本申请实施例提供的一种流量录制方法的流程示意图；图2为本申请实施例提供的定时更新服务端的日志数据和特征表的步骤的流程示意图；图3为本申请实施例提供的对各个请求数据组进行特征清洗的步骤的流程示意图；图4为本申请实施例提供的更新服务端的日志数据的步骤的流程示意图；图5为本申请实施例提供的更新特征表的步骤的流程示意图；图6为本申请实施例提供的判断请求接口是否满足预设条件的步骤的流程示意图；图7为本申请实施例提供的一种流量录制装置的结构示意图；图8为本申请实施例提供的一种计算机设备的内部结构图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。在其中一个实施例中，本申请提供了一种流量录制方法，下述实施例以该方法应用于服务器进行说明。可以理解，执行流量录制方法可以是单个服务器，也可以是由多个服务器组成的服务器集群，本申请对此不作具体限制。如图1所示，本申请提供了一种流量录制方法，所述方法应用于服务端，包括：步骤S101：响应于对目标应用的流量录制指令，接收预设时间周期内目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数。其中，预设时间周期可以由测试人员根据测试任务及测试需求进行设置，也可以是服务端默认的时间周期，本申请对此不作具体限制。目标应用的应用端包括但不限于安卓端、iOS端；业务请求可以理解为HTTP/HTTPS请求，由请求行、请求头部、空行和请求体四个部分组成，请求行包括但不限于请求方式、URL、协议版本等等信息。具体而言，业务请求的请求接口可以从请求行的URL中获取，请求参数可以从业务请求中的请求体中获取，也可以从业务请求中的URL中获取。在本步骤中，当服务端接收到流量录制请求时，确定该流量录制请求的录制对象，即目标应用。在预设时间周期内，接收目标应用的每个应用端发起的业务请求，以获得每个业务请求对应的请求接口和请求参数。具体而言，接收预设时间周期内发往服务端的请求，发起端为目标应用的各个应用端中的任意一个应用端，此时为线上环境，接收的请求为线上用户的真实请求。步骤S102：获取特征表。其中，特征表包括多个请求接口及每个请求接口对应的特征字段；特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数。在本步骤中，当获取到预设时间周期内接收到的业务请求的请求接口和请求参数时，将会获取特征表，以便根据特征表，对所接受到的业务请求是否需要录制进行判断。步骤S103：对于每个业务请求中的任意一个业务请求，根据特征表，判断该业务请求对应的请求接口是否满足预设条件。可以理解的是，特征表中包括了多个请求接口及每个请求接口对应的特征字段，将该请求接口与特征表中的数据进行比对，以判断是否满足预设条件。步骤S104：若该业务请求对应的请求接口满足预设条件，则获取录制数据表。其中，录制数据表为预先创建的，录制数据表在创建时，录制数据表为空表，当经步骤S106写入数据后，获取到的录制数据表为写入数据后的录制数据表。换言之，获取的录制数据表为当前获取时刻最新的录制数据表。步骤S105：判断该业务请求对应的请求接口是否存在于录制数据表中。通过对业务请求对应的请求接口是否存在于录制数据表以判断该请求接口是否已有目标应用的其他应用端请求过了，若录制数据表中存在与该请求接口对应的数据，则无需对该业务请求进行录制。若录制数据表中不存在与该请求接口对应的数据，则需要对该业务请求进行录制。步骤S106：若该业务请求对应的请求接口不存在于录制数据表中，则对该业务请求进行录制，并将录制的数据写入录制数据表中。其中，录制数据表包括多个请求接口及每个请求接口对应的返回数据，且多个请求接口中不存在重复的请求接口；录制的数据包括但不限于该业务请求的请求接口、请求参数和返回数据。示例性地，获取录制数据表A，此时，录制数据表A为空表，当接收到业务请求B时，判断业务请求B的请求接口a是否存在于录制数据表A中，请求接口a不存在于录制数据表A中，因此，对业务请求B进行录制，并将录制的数据写入录制数据表A中，当接收到业务请求C时，判断业务请求C的请求接口b是否存在于录制数据表A中，请求接口b不存在于录制数据表A中，因此，对业务请求C进行录制，并将录制的数据写入录制数据表A中，判断业务请求C的请求接口b是否存在于录制数据表A中，请求接口b不存在于录制数据表A中，因此，对业务请求C进行录制，并将录制的数据写入录制数据表A中，当接收到业务请求D时，判断业务请求D的请求接口b是否存在于录制数据表A中，请求接口b已存在于录制数据表A中，因此，不对业务请求D进行录制。步骤S107：若该业务请求对应的请求接口存在于录制数据表中，则不对该业务请求进行录制。具体而言，当该业务请求对应的请求接口存在于录制数据表中时，即对于该业务请求对应的请求接口而言，已经录制了一份与该请求接口对应的请求数据，因此，不需要再对当前业务请求进行录制。步骤S108：若该业务请求对应的请求接口不满足预设条件，则不对该业务请求进行录制。将该业务请求对应的请求接口与特征表中的数据进行比对，当该业务请求的请求接口不满足预设条件时，则忽略该业务请求，不对该业务请求进行录制。本申请提供的流量录制方法，响应于对目标应用的流量录制指令，接收预设时间周期内目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数，获取特征表，其中，特征表包括多个请求接口及每个请求接口对应的特征字段，特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数，对于每个业务请求中的任意一个业务请求，根据特征表，从而判断该业务请求对应的请求接口是否满足预设条件，若该业务请求对应的请求接口满足预设条件，则获取录制数据表，并判断该业务请求对应的请求接口是否存在于录制数据表中，若该业务请求对应的请求接口不存在于录制数据表中，则对该业务请求进行录制，并将录制的数据写入录制数据表中。通过记录目标应用的不同应用端发往同一请求接口的请求中均存在且对应的值相等的参数，即特征字段，从而根据请求接口及其对应的特征字段有选择地录制请求数据，通过判断请求接口是否存在于录制数据表中，使得录制的数据中请求接口不重复，即对于每个请求接口而言，只录制一份对应的请求数据，在回放测试时，可以将录制得到的数据与各个应用端发起的请求进行匹配，以完成接口测试，即每个请求接口对应的请求数据可以用于测试多个应用端发往该请求接口的请求，从而提高流量录制数据的通用性和应用接口测试的效率。如图2所示，在其中一个实施例中，所述方法还包括：步骤S201：定时获取目标请求数据，并确定预设的临时表。其中，目标请求数据包括当前服务端的日志中所有数据记录，服务端的日志中的每条数据记录包括请求接口、请求参数及返回数据，返回数据即对对应的请求接口发起请求时，该请求接口返回给发起端的数据。在本步骤中，预设的临时表为空表。步骤S202：对于每次获取的目标请求数据，根据目标请求数据中各条数据记录的请求接口，将目标请求数据划分为多个请求数据组。其中，任意一个请求数据组中的各条数据记录对应的请求接口均相同。具体而言，根据目标请求数据中各条数据记录的请求接口，可以将请求接口相同的数据记录分在同一个请求数据组，因此，根据目标请求数据中各条数据记录的请求接口可以将目标请求数据划分为多个请求数据组。示例性地，假设目标请求数据中包括数据记录A、数据记录B和数据记录C，各条数据记录对应的请求接口分别为a、b和a，根据目标请求数据中各条数据记录的请求接口划分目标请求数据，此时，数据记录A和数据记录C的请求接口相同，因此，将数据记录A和数据记录C划分为一个请求数据组，数据记录B为另一个请求数据组。步骤S203：对各个请求数据组进行特征清洗，并根据特征清洗的结果判断各个请求数据组是否存在与其对应的特征字段。其中，对于各个请求数据组的任意一个请求数据组，特征清洗是指对该请求数据组中的各条数据记录进行遍历，并查找是否存在与特征字段的定义相匹配的请求参数。步骤S204：对于各个请求数据组中的任意一个请求数据组，若该请求数据组存在与其对应的特征字段，则将该请求数据组对应的请求接口及特征字段写入临时表中。步骤S205：根据临时表，更新服务端的日志数据。其中，服务端的日志数据是指服务端的日志中的所有数据。步骤S206：根据临时表，更新特征表。可以理解的是，当服务端第一次响应目标应用的流量录制指令时，特征表可以根据预设规则预先生成。通过定时任务获取服务端的日志中的数据，并对获取的数据进行处理，得到临时表用以更新服务端的日志数据和特征表，能够使得特征表的数据得到及时地更新，避免因更新不及时，导致流量录制得到的数据用于回放测试时，测试成功率降低。如图3所示，在其中一个实施例中，对各个请求数据组进行特征清洗，包括：步骤S301：对于各个请求数据组中的任意一个请求数据组，获取该请求数据组中的各条数据记录对应的请求参数及返回数据。步骤S302：若该请求数据组中各条数据记录中存在相同的请求参数且该请求参数在该请求数据组的各条数据记录对应的返回数据中对应的值均相同，则将该请求参数确定为该请求数据组对应的特征字段。示例性地，假设有一请求数据组Q包括数据记录A和数据记录B，数据记录A对应的请求参数为brandid，androidRom，osVerison，androidToken，数据记录B对应的请求参数为brandid，iosPhone，osVersion，iosToken，其中，数据记录A的请求参数brandid和数据记录B的请求参数brandid的值相等，数据记录A的请求参数osVerison和数据记录B的请求参数osVerison不相等，因此，将请求参数brandid作为请求数据组Q的特征字段。如图4所示，在其中一个实施例中，根据临时表，更新服务端的日志数据，包括：步骤S401：获取第一请求接口。其中，第一请求接口为服务端的日志数据中任意一条数据记录的请求接口。步骤S402：若第一请求接口不存在于临时表中，则在服务端的日志数据中删除与第一请求接口对应的数据记录，以完成对服务端的日志数据的更新。可以理解的是，由于服务端的日志数据会随着接收请求的数量的增加而增加，因此，定时对服务端的日志数据进行更新，以免日志数据占用过多的存储空间和系统资源。如图5所示，在其中一个实施例中，根据临时表，更新特征表，包括：步骤S501：获取第二请求接口。其中，第二请求接口为特征表中任意一条数据记录的请求接口。步骤S502：若第二请求接口存在于临时表中，则将特征表中与第二请求接口对应的特征字段更新为临时表中与第二请求接口对应的特征字段。由于目标应用的开发过程中，存在版本迭代，当目标应用的版本迭代之后，同一个请求接口对应的特征字段有可能会产生变化，因此，需要定时对特征表中的请求接口和其对应的特征字段进行更新，以保证每个请求接口对应的请求数据可以用于测试多个应用端发往该请求接口的请求，提高流量录制数据的通用性和应用接口测试的效率。如图6所示，在其中一个实施例中，根据特征表，判断该业务请求对应的请求接口是否满足预设条件，包括：步骤S601：判断该业务请求对应的请求接口是否存在于特征表中。通过判断该请求接口是否存在于特征表中，以确定该业务请求是否为需要进行流量录制的请求，若该业务请求对应的请求接口不存在于特征表中，则表示不需要对该业务请求进行流量录制，以达到选择性录制的目的。步骤S602：若该业务请求对应的请求接口存在于特征表中，则确定目标数据记录。其中，目标数据记录为在特征表中与该业务请求对应的请求接口对应的数据记录。步骤S603：判断该业务请求的请求参数中是否存在与目标数据记录对应的特征字段相同的请求参数。通过将该请求接口与特征表中的数据进行比对，进而再将该业务请求的请求参数与目标数据记录的特征字段进行比对，两者比对通过后，即该请求接口满足预设条件，步骤S604：若存在，则该业务请求对应的请求接口满足预设条件。步骤S605：若不存在，则该业务请求对应的请求接口不满足预设条件。可以理解的是，通过判断请求接口是否满足预设条件，进而对是否录制该业务请求进行判断，能够实现流量录制的初步筛选，提高流量录制数据的通用性。在其中一个实施例中，所述方法还包括：当预设时间周期结束时，获取录制数据表中的所有数据，录制数据表中的所有数据用于对各个应用端的接口进行回放测试。在测试环境中，可以获取录制数据表中的所有数据，用于对各个应用端的接口进行测试，将线上录制的真实请求在测试环境中进行回放，一方面，可以提高用例的真实性和可靠性，另一方面，对于每个请求接口而言，只录制一份对应的请求数据，在回放测试时，可以将录制得到的数据与各个应用端发起的请求进行匹配，以完成接口测试，即每个请求接口对应的请求数据可以用于测试多个应用端发往该请求接口的请求，从而可以提高流量录制数据的通用性和应用接口测试的效率。应该理解的是，虽然如上所述的各实施例所涉及的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，如上所述的各实施例所涉及的流程图中的至少一部分步骤可以包括多个步骤或者多个阶段，这些步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤中的步骤或者阶段的至少一部分轮流或者交替地执行。下面对本申请实施例提供的流量录制装置进行描述，下文描述的流量录制装置与上文描述的流量录制方法可相互对应参照。如图7所示，本申请提供了一种流量录制装置700，所述装置应用于服务端，包括：请求接收模块701，用于响应于对目标应用的流量录制指令，接收预设时间周期内目标应用的每个应用端发起的业务请求，并获取每个业务请求对应的请求接口及请求参数；第一获取模块702，用于获取特征表；其中，特征表包括多个请求接口及每个请求接口对应的特征字段；特征字段为在各个应用端发往其对应的请求接口的各个业务请求中均存在的、且对应的值均相等的参数；判断模块703，用于对于每个业务请求中的任意一个业务请求，根据特征表，判断该业务请求对应的请求接口是否满足预设条件；第二获取模块704，用于若该业务请求对应的请求接口满足预设条件，则获取录制数据表，并判断该业务请求对应的请求接口是否存在于录制数据表中；请求录制模块705，用于若该业务请求对应的请求接口不存在于录制数据表中，则对该业务请求进行录制，并将录制的数据写入录制数据表中。在其中一个实施例中，所述装置还包括：第三获取模块，用于定时获取目标请求数据，并确定预设的临时表；其中，目标请求数据包括当前服务端的日志中所有数据记录，服务端的日志中的每条数据记录包括请求接口、请求参数及返回数据；数据组划分模块，用于对于每次获取的目标请求数据，根据目标请求数据中各条数据记录的请求接口，将目标请求数据划分为多个请求数据组；其中，任意一个请求数据组中的各条数据记录对应的请求接口均相同；特征清洗模块，用于对各个请求数据组进行特征清洗，并根据特征清洗的结果判断各个请求数据组是否存在与其对应的特征字段；数据写入模块，用于对于各个请求数据组中的任意一个请求数据组，若该请求数据组存在与其对应的特征字段，则将该请求数据组对应的请求接口及特征字段写入临时表中；第一更新模块，用于根据临时表，更新服务端的日志数据；第二更新模块，用于根据临时表，更新特征表。在其中一个实施例中，所述特征清洗模块包括：第一获取子模块，用于对于各个请求数据组中的任意一个请求数据组，获取该请求数据组中的各条数据记录对应的请求参数及返回数据；第一确定子模块，用于若该请求数据组中各条数据记录中存在相同的请求参数且该请求参数在该请求数据组的各条数据记录对应的返回数据中对应的值均相同，则将该请求参数确定为该请求数据组对应的特征字段。在其中一个实施例中，所述第一更新模块包括：第二获取子模块，用于获取第一请求接口；其中，第一请求接口为服务端的日志数据中任意一条数据记录的请求接口；第一更新子模块，用于若第一请求接口不存在于临时表中，则在服务端的日志数据中删除与第一请求接口对应的数据记录，以完成对服务端的日志数据的更新。在其中一个实施例中，所述第二更新模块包括：第三获取子模块，用于获取第二请求接口；其中，第二请求接口为特征表中任意一条数据记录的请求接口；第二更新子模块，用于若第二请求接口存在于临时表中，则将特征表中与第二请求接口对应的特征字段更新为临时表中与第二请求接口对应的特征字段。在其中一个实施例中，所述判断模块703包括：第一判断子模块，用于判断该业务请求对应的请求接口是否存在于特征表中；第二确定子模块，用于若该业务请求对应的请求接口存在于特征表中，则确定目标数据记录；其中，目标数据记录为在特征表中与该请求接口对应的数据记录；第一判断子模块，用于判断该业务请求的请求参数中是否存在与目标数据记录对应的特征字段相同的请求参数；第一结果判定子模块，用于若存在，则该业务请求对应的请求接口满足预设条件；第二结果判定子模块，用于若不存在，则该业务请求对应的请求接口不满足预设条件。在其中一个实施例中，所述装置还包括：回放测试模块，用于当预设时间周期结束时，获取录制数据表中的所有数据，录制数据表中的所有数据用于对各个应用端的接口进行回放测试。上述流量录制装置中各个模块的划分仅仅用于举例说明，在其他实施例中，可将流量录制装置按照需要划分为不同的模块，以完成上述流量录制装置的全部或部分功能。上述流量录制装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。在一个实施例中，本申请还提供了一种存储介质，所述存储介质中存储有计算机可读指令，所述计算机可读指令被一个或多个处理器执行时，使得一个或多个处理器执行如上述实施例中任一项所述流量录制方法的步骤。在一个实施例中，本申请还提供了一种计算机设备，所述计算机设备中存储有计算机可读指令，所述计算机可读指令被一个或多个处理器执行时，使得一个或多个处理器执行如上述实施例中任一项所述流量录制方法的步骤。示意性地，如图8所示，图8为本申请实施例提供的一种计算机设备的内部结构示意图，该计算机设备800可以被提供为一服务器。参照图8，计算机设备800包括处理组件802，其进一步包括一个或多个处理器，以及由存储器801所代表的存储器资源，用于存储可由处理组件802的执行的指令，例如应用程序。存储器801中存储的应用程序可以包括一个或一个以上的每一个对应于一组指令的模块。此外，处理组件802被配置为执行指令，以执行上述任意实施例的流量录制方法。计算机设备800还可以包括一个电源组件803被配置为执行计算机设备800的电源管理，一个有线或无线网络接口804被配置为将计算机设备800连接到网络，和一个输入输出接口805。计算机设备800可以操作基于存储在存储器801的操作系统，例如WindowsServer TM、Mac OS XTM、Unix TM、Linux TM、Free BSDTM或类似。本领域技术人员可以理解，图8中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备的限定，具体的计算机设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。最后，还需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。本文中，单数形式的“一”、“一个”和“所述/该”也可以包括复数形式，除非上下文清楚指出另外的方式。还应当理解的是，术语“包括/包含”或“具有”等指定所陈述的特征、整体、步骤、操作、组件、部分或它们的组合的存在，但是不排除存在或添加一个或更多个其他特征、整体、步骤、操作、组件、部分或它们的组合的可能性。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间可以根据需要进行组合，且相同相似部分互相参见即可。对所公开的实施例的上述说明，使本领域专业技术人员能够实现或使用本申请。对这些实施例的多种修改对本领域的专业技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本申请的精神或范围的情况下，在其它实施例中实现。因此，本申请将不会被限制于本文所示的这些实施例，而是要符合与本文所公开的原理和新颖特点相一致的最宽的范围。
