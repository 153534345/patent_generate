标题title
基于自动微分加速发动机燃烧室设计的仿真模拟方法
摘要abst
本发明公开了一种基于自动微分加速发动机燃烧室设计的仿真模拟方法，其包括S1、获取发动机燃烧室的控制方程，并对其进行离散处理，得到离散方程；S2、采用前向自动微分方法求解雅克比矩阵、和，并根据离散方程和求解的雅克比矩阵，计算推进增量△U；S3、判断推进增量△U是否小于预设值，若是，输出当前的守恒量，否则进入步骤S4；S4、根据推进增量△U，采用松弛因子更新守恒量Un+1，之后返回步骤S2。
权利要求书clms
1.基于自动微分加速发动机燃烧室设计的仿真模拟方法，其特征在于，包括步骤：S1、获取发动机燃烧室的控制方程，并对其进行离散处理，得到离散方程：其中，vol为燃烧室的离散单元体积；δt为推进时间步长；Res为当前时间内的残差；Fboundary和Finternal分别为发动机燃烧室离散后的边界面元流通量和网格单元之间间隔产生的流通量；U为守恒量；Schem为化学反应源项；△U为推进增量；n为发动机燃烧室控制方程迭代更新次数；I为单位矩阵；S2、采用前向自动微分方法求解雅克比矩阵、/＞和/＞，并根据离散方程和求解的雅克比矩阵，计算推进增量△U；S3、判断推进增量△U是否小于预设值，若是，输出当前的守恒量，否则进入步骤S4；S4、根据推进增量△U，采用松弛因子更新守恒量Un+1，之后返回步骤S2，守恒量Un+1的计算公式为：其中，Un+1和Un分别为发动机燃烧室控制方程在第n+1和n次迭代更新时的守恒量；α为松弛因子。2.根据权利要求1所述的基于自动微分加速发动机燃烧室设计的仿真模拟方法，其特征在于，流通量Finternal的获取方法包括：其中，，/＞分别为使用左右不同守恒量计算的空间通量，F为空间通量；Aroe为Roe近似矩阵；Ur和Ul分别为网格单元左侧和右侧的流通量；/＞为绝对值符号；其中，Roe近似矩阵Aroe需要满足以下条件：Aroe为线性矩阵，且Aroe的特征矢量是相互线性独立的；当，/＞，其中/＞，A为空间通量F相对守恒量U的雅可比空间，Uc为Ur和Ul相等时的守恒量；对于任意，/＞；F的表达式为：其中，ρ为燃烧室内气体的总密度；为速度矢量；/＞为流过面元法向的速度；/＞为内部面元/边界面元的法向；为压力/＞在面元法向的三个分量；/＞为燃烧室中气体的总比焓，/＞为燃烧室中的压力，E为总比内能。3.根据权利要求1所述的基于自动微分加速发动机燃烧室设计的仿真模拟方法，其特征在于，流通量Fboundary的获取方法包括：采用无反射边条的总温总压声速入口作为边界条件，对于入口，有vn+c特征线的信息从流场内部向外流出，特征线vn+c的黎曼不变量为：其中，so和sb分别为边界相邻单元内部和边界处的熵的一种测度；和/＞分别为边界相邻单元内部和边界处的压力；ρo和ρb分别为边界相邻单元内部和边界处的密度；/＞和分别边界相邻单元内部和边界处的黎曼不变量；vno和vnb分别为边界相邻单元内部速度和边界处速度在边界方向上的速度分量；γ为比热比；co和cb分别为边界相邻单元内部和边界处的声速；假设流动是绝热等熵流动，总焓保持不变，则总焓为：其中，Hto和Htb分别为边界相邻单元内部和边界处的总焓；选择和/＞及Hto和Htb作为边界守恒量，构建关于边界处声速cb的一元二次方程：其中，Ht为总焓值；为黎曼不变量；根据物理条件cb＞0，挑选边界处声速cb的解：其中，和 /＞分别为边界处声速cb所有解中的最大值和最小值；max为最大值函数；根据边界处声速cb，计算壁面的速度vnb和马赫数：其中，c为速度；采用总压总温计算边界处的静压静温Pb和Tb：其中，T为温度；根据壁面处的压力、温度、马赫数，计算流通量Fboundary：其中，ub为边界x方向速度分量；为边界x方向压力分量；vb为边界y方向速度分量；为边界y方向压力分量；wb为边界z方向速度分量；/＞为边界z方向压力分量；Hb为边界总比焓。4.根据权利要求2所述的基于自动微分加速发动机燃烧室设计的仿真模拟方法，其特征在于，当燃烧室内流通的气体为空气时，所述守恒量为：所述化学反应源项Schem=0，雅克比矩阵。5.根据权利要求2所述的基于自动微分加速发动机燃烧室设计的仿真模拟方法，其特征在于，当燃烧室内流通的气体包括ns种组分时，所述守恒量，化学反应源项Schem为：其中，分别为第1…ns种组分的化学反应速率；ρ1…ρns为第1…ns种组分的密度，组分密度和总密度关系为：其中，ρi为第i种组分的密度；ρ为燃烧室内气体的总密度；Yi为第i种组分的质量分数；第i种组分的化学反应速率的计算公式为：其中，和/＞分别为第i种组分在第r个反应中的正向和逆向化学计量系数；/＞为第i种组分在第r个反应中的化学反应速率；nr为燃烧室内反应的总个数；/＞和/＞分别为第r个反应的正向和逆向化学反应速率常数；/＞为第i种组分的摩尔浓度，Mi为第i种组分的摩尔质量；/＞为/＞的/＞次方；/＞为/＞的/＞次方。6.根据权利要求5所述的基于自动微分加速发动机燃烧室设计的仿真模拟方法，其特征在于，采用前向自动微分方法求解雅克比矩阵、/＞和/＞的方法包括：将流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U计算过程中的每个子函数作为自动微分的节点；在前向计算时，采用自动微分获取每个节点的局部导数，并基于局部导数得到流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U的导数；根据流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U的导数，得到、/＞和/＞。7.根据权利要求1所述的基于自动微分加速发动机燃烧室设计的仿真模拟方法，其特征在于，所述发动机燃烧室的控制方程为：其中，F为空间通量；t为时间变量；x为空间变量。
说明书desc
技术领域本发明涉及燃烧室设计技术，具体涉及一种基于自动微分加速发动机燃烧室设计的仿真模拟方法。背景技术在燃烧室设计当中，使用仿真模拟CFD等数值工具进行快速迭代是实现燃烧室高效设计的重要方案之一。因此更加高效和鲁棒的CFD工具在设计过程中扮演着重要角色。隐式求解是加速CFD的重要手段，能够加速流场的仿真模拟计算的收敛速度，而隐式求解的核心之一就是雅可比矩阵的精度。因此提高CFD隐式计算中的雅可比矩阵的精度是加速燃烧室设计迭代的重要手段。CFD可压缩流体模拟中，对于耦合可压缩NS控制方程，其离散后的通量计算都有了成熟的方案，但是流程都相对复杂。这就导致在隐式求解过程中，这种复杂通量的雅可比矩阵的计算难以推导和编写。传统方案中，往往忽略复杂通量的构造，假设一种简单通量的雅克比矩阵。例如谱半径近似和Van Leer FVS近似，这些方法虽然增加了编程的便利性，但是牺牲燃烧室设计的效率和鲁棒性。发明内容针对现有技术中的上述不足，本发明提供的自动微分加速发动机燃烧室设计的仿真模拟方法解决了现有技术在燃烧室设计时效率低的问题。为了达到上述发明目的，本发明采用的技术方案为：提供一种基于自动微分加速发动机燃烧室设计的仿真模拟方法，其包括步骤：S1、获取发动机燃烧室的控制方程，并对其进行离散处理，得到离散方程：其中，vol为燃烧室的离散单元体积；δt为推进时间步长；Res为当前时间内的残差；Fboundary和Finternal分别为发动机燃烧室离散后的边界面元流通量和网格单元之间间隔产生的流通量；U为守恒量；Schem为化学反应源项；△U为推进增量；n为发动机燃烧室控制方程迭代更新次数；I为单位矩阵；S2、采用前向自动微分方法求解雅克比矩阵、/＞和/＞，并根据离散方程和求解的雅克比矩阵，计算推进增量△U；S3、判断推进增量△U是否小于预设值，若是，输出当前的守恒量，否则进入步骤S4；S4、根据推进增量△U，采用松弛因子更新守恒量Un+1，之后返回步骤S2，守恒量Un+1的计算公式为：其中，Un+1和Un分别为发动机燃烧室控制方程在第n+1和n次迭代更新时的守恒量；α为松弛因子。进一步地，流通量Finternal的获取方法包括：其中，，/＞分别为使用左右不同守恒量计算的空间通量，F为空间通量；Aroe为Roe近似矩阵；Ur和Ul分别为网格单元左侧和右侧的流通量；/＞为绝对值符号；其中，Roe近似矩阵Aroe需要满足以下条件：Aroe为线性矩阵，且Aroe的特征矢量是相互线性独立的；当，/＞，其中/＞，A为空间通量F相对守恒量U的雅可比空间，Uc为Ur和Ul相等时的守恒量；对于任意，/＞；F的表达式为：其中，ρ为燃烧室内气体的总密度；为速度矢量；/＞为流过面元法向的速度；/＞为内部面元/边界面元的法向；为压力/＞在面元法向的三个分量；/＞为燃烧室中气体的总比焓，/＞为燃烧室中的压力，E为总比内能。上述技术方案的有益效果为：假设每一个边界面元都是一个小间断，求解方程的弱解，使用Roe通量格式计算间断的黎曼问题保证了在较小的耗散条件下，准确快速地描述耦合守恒方程在间断处的特征波发展情况，为迭代守恒量提供了准确高效的通量计算。进一步地，流通量Fboundary的获取方法包括：采用无反射边条的总温总压声速入口作为边界条件，对于入口，有vn+c特征线的信息从流场内部向外流出，特征线vn+c的黎曼不变量为：其中，so和sb分别为边界相邻单元内部和边界处的熵的一种测度；和/＞分别为边界相邻单元内部和边界处的压力；ρo和ρb分别为边界相邻单元内部和边界处的密度；和/＞分别边界相邻单元内部和边界处的黎曼不变量；vno和vnb分别为边界相邻单元内部速度和边界处速度在边界方向上的速度分量；γ为比热比；co和cb分别为边界相邻单元内部和边界处的声速；假设流动是绝热等熵流动，总焓保持不变，则总焓为：其中，Hto和Htb分别为边界相邻单元内部和边界处的总焓；选择和/＞及Hto和Htb作为边界守恒量，构建关于边界处声速cb的一元二次方程：其中，Ht为总焓值；为黎曼不变量；根据物理条件cb＞0，挑选边界处声速cb的解：其中，和/＞分别为边界处声速cb所有解中的最大值和最小值；max为最大值函数；根据边界处声速cb，计算壁面的速度vnb和马赫数：其中，c为速度；采用总压总温计算边界处的静压静温Pb和Tb：其中，T为温度；根据壁面处的压力、温度、马赫数，计算流通量Fboundary：其中，ub为边界x方向速度分量；为边界x方向压力分量；vb为边界y方向速度分量；/＞为边界y方向压力分量；wb为边界z方向速度分量；/＞为边界z方向压力分量；Hb为边界总比焓。上述技术方案的有益效果为：使用黎曼特不变量描述边界上不变的特征流动过程，为稳态计算提供无反射边条，能够保证求解的离散方程存在唯一稳定解。进一步地，当燃烧室内流通的气体为空气时，所述守恒量为：所述化学反应源项Schem=0，雅克比矩阵。进一步地，当燃烧室内流通的气体包括ns种组分时，所述守恒量，化学反应源项Schem为：其中，分别为第1…ns种组分的化学反应速率；ρ1…ρns为第1…ns种组分的密度，组分密度和总密度关系为：其中，ρi为第i种组分的密度；ρ为燃烧室内气体的总密度；Yi为第i种组分的质量分数；第i种组分的化学反应速率的计算公式为：其中，和/＞分别为第i种组分在第r个反应中的正向和逆向化学计量系数；为第i种组分在第r个反应中的化学反应速率；nr为燃烧室内反应的总个数；/＞和/＞分别为第r个反应的正向和逆向化学反应速率常数；/＞为第i种组分的摩尔浓度，Mi为第i种组分的摩尔质量；/＞为/＞的/＞次方；/＞为/＞的/＞次方。上述技术方案的有益效果为：使用单元反应模型为守恒量提供在化学反应条件下的变化速率，增加计算方法对发动机燃烧过程的模拟能力。进一步地，采用前向自动微分方法求解雅克比矩阵、/＞和/＞的方法包括：将流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U计算过程中的每个子函数作为自动微分的节点；在前向计算时，采用自动微分获取每个节点的局部导数，并基于局部导数得到流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U的导数；根据流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U的导数，得到、/＞和/＞。上述技术方案的有益效果为：隐式求解过程中，准确的雅可比计算是迭代技术的关键，能够有效增加收敛速度和稳定性，进而加速模拟算法对发动机设计的迭代速度。进一步地，所述发动机燃烧室的控制方程为：其中，F为空间通量；t为时间变量；x为空间变量。与现有技术相比，本发明的有益效果是：本方案采用自动微分能够精确求得发动机内部控制方程离散后的雅可比矩阵，加速收敛迭代，以此快速得到收敛的守恒量，由于守恒量包括与燃烧室相关的参数，从而达到快速设计燃烧室的目的。本方案在进行燃烧室设计时，由于其普适性，能够对任意新增的流通量进行燃烧室快速设计，以提供一体式解决方案，使得本方案的燃烧室设计方案具有可扩展性。本方案通过自动微分进行雅克比矩阵求解，可以提高雅克比矩阵的求解精度，进一步可以提高计算得到的守恒量的计算精度，以最终保证发动机内部结构的预测精度。附图说明图1为自动微分加速发动机燃烧室设计的仿真模拟方法的流程图。图2为发动机燃烧室中的计算区域离散后的面元和单元示意图。其中，1、网格单元；2、内部面元；3、边界面元。具体实施方式下面对本发明的具体实施方式进行描述，以便于本技术领域的技术人员理解本发明，但应该清楚，本发明不限于具体实施方式的范围，对本技术领域的普通技术人员来讲，只要各种变化在所附的权利要求限定和确定的本发明的精神和范围内，这些变化是显而易见的，一切利用本发明构思的发明创造均在保护之列。参考图1，图1示出了自动微分加速发动机燃烧室设计的仿真模拟方法；如图1所示，该方法包括步骤S1~步骤S4。在步骤S1中、获取发动机燃烧室的控制方程：其中，F为空间通量；t为时间变量；x为空间变量；之后，对控制方程进行离散处理，得到离散方程：其中，vol为燃烧室的离散单元体积；δt为推进时间步长；Res为当前时间内的残差；Fboundary和Finternal分别为发动机燃烧室离散后的边界面元流通量和网格单元之间间隔产生的流通量；U为守恒量；Schem为化学反应源项；△U为推进增量；n为发动机燃烧室控制方程迭代更新次数；I为单位矩阵。为了便于对后面的流通量Fboundary和Finternal中的部分术语进行理解，本方案的图2示出了发动机燃烧室中的计算区域离散后的面元和单元示意图，在该图展示了发动机燃烧室内部的网格单元1、内部面元2和边界面元3。在本发明的一个实施例中，流通量Finternal的获取方法包括：其中，，/＞分别为使用左右不同守恒量计算的空间通量，F为空间通量；Aroe为Roe近似矩阵；Ur和Ul分别为网格单元左侧和右侧的流通量；/＞为绝对值符号；其中，Roe近似矩阵Aroe需要满足以下条件：Aroe为线性矩阵，且Aroe的特征矢量是相互线性独立的；当，/＞，其中/＞，A为空间通量F相对守恒量U的雅可比空间，Uc为Ur和Ul相等时的守恒量；对于任意，/＞；F的表达式为：其中，ρ为燃烧室内气体的总密度；为速度矢量；/＞为流过面元法向的速度；/＞为内部面元/边界面元的法向；/＞为压力/＞在面元法向的三个分量；/＞为燃烧室中气体的总比焓，/＞为燃烧室中的压力，E为总比内能。实施时，本方案优选流通量Fboundary的获取方法包括：采用无反射边条的总温总压声速入口作为边界条件，对于入口，有vn+c特征线的信息从流场内部向外流出，特征线vn+c的黎曼不变量为：其中，so和sb分别为边界相邻单元内部和边界处的熵的一种测度；和/＞分别为边界相邻单元内部和边界处的压力；ρo和ρb分别为边界相邻单元内部和边界处的密度；和/＞分别边界相邻单元内部和边界处的黎曼不变量；vno和vnb分别为边界相邻单元内部速度和边界处速度在边界方向上的速度分量；γ为比热比；co和cb分别为边界相邻单元内部和边界处的声速；假设流动是绝热等熵流动，总焓保持不变，则总焓为：其中，Hto和Htb分别为边界相邻单元内部和边界处的总焓；选择和/＞及Hto和Htb作为边界守恒量，构建关于边界处声速cb的一元二次方程：其中，Ht为总焓值；为黎曼不变量；根据物理条件cb＞0，挑选边界处声速cb的解：其中，和/＞分别为边界处声速cb所有解中的最大值和最小值；max为最大值函数；根据边界处声速cb，计算壁面的速度vnb和马赫数：其中，c为速度；采用总压总温计算边界处的静压静温Pb和Tb：其中，T为温度；根据壁面处的压力、温度、马赫数，计算流通量Fboundary：其中，ub为边界x方向速度分量；为边界x方向压力分量；vb为边界y方向速度分量；/＞为边界y方向压力分量；wb为边界z方向速度分量；/＞为边界z方向压力分量；Hb为边界总比焓。在本方案中，当燃烧室内流通的气体为空气时，所述守恒量为：所述化学反应源项Schem=0，雅克比矩阵。当燃烧室内流通的气体包括ns种组分时，所述守恒量，化学反应源项Schem为：其中，分别为第1…ns种组分的化学反应速率；ρ1…ρns为第1…ns种组分的密度，组分密度和总密度关系为：其中，ρi为第i种组分的密度；ρ为燃烧室内气体的总密度；Yi为第i种组分的质量分数；第i种组分的化学反应速率的计算公式为：其中，和/＞分别为第i种组分在第r个反应中的正向和逆向化学计量系数；为第i种组分在第r个反应中的化学反应速率；nr为燃烧室内反应的总个数；/＞和分别为第r个反应的正向和逆向化学反应速率常数；/＞为第i种组分的摩尔浓度，Mi为第i种组分的摩尔质量；/＞为/＞的/＞次方；/＞为/＞的/＞次方。在步骤S2中，采用前向自动微分方法求解雅克比矩阵、/＞和/＞，并根据离散方程和求解的雅克比矩阵，计算推进增量△U；实施时，本方案优选采用前向自动微分方法求解雅克比矩阵、/＞和的方法包括：将流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U计算过程中的每个子函数作为自动微分的节点；在前向计算时，采用自动微分获取每个节点的局部导数，并基于局部导数得到流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U的导数；根据流通量Fboundary、流通量Finternal、化学反应源项Schem和守恒量U的导数，得到、/＞和/＞。S3、判断推进增量△U是否小于预设值，若是，输出当前的守恒量，否则进入步骤S4；S4、根据推进增量△U，采用松弛因子更新守恒量Un+1，之后返回步骤S2，守恒量Un+1的计算公式为：其中，Un+1和Un分别为发动机燃烧室控制方程在第n+1和n次迭代更新时的守恒量；α为松弛因子。综上所述，本方案能够精准的获得雅克比矩阵，通过提高恒通量的精度以提高燃烧室的设计精度，自动微分可以加快燃烧室设计过程的收敛迭代，从而加快燃烧室的设计速度。
