标题title
一种基于车速预测的燃料电池公交车能量管理方法
摘要abst
本发明公开了一种基于车速预测的燃料电池公交车能量管理方法，该方法为：选择实车工况数据作为训练和测试工况数据，利用径向基神经网络对车速进行预测，得到误差较小且足够精度的车速预测结果；其次，将该车速预测方法与模型预测控制相结合，建立燃料电池公交车能量管理控制策略模型。本发明所提基于车速预测的燃料电池公交车能量管理方法能很好的适应实车工况，且在实车工况条件下车速预测具有较高精度。且相比于实车能量管理方法，本发明基于车速预测的能量管理方法等效氢耗更低，具有良好工程应用前景。
权利要求书clms
1.一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：该方法包括以下步骤：步骤一、历史车速数据获取与预处理：获取燃料电池公交车在某个地区的实际行驶数据，数据采样时间间隔为1s，并整理为该燃料电池公交车的车速-时间工况数据表，并对该数据表进行工况数据预处理，将获得的预处理数据整理为历史车速工况表；步骤二、选择燃料电池公交车动力系统构型：燃料电池公交车混合动力系统采用氢燃料电池和磷酸铁锂蓄电池结合，形成气-电混合驱动系统；步骤三、建立电机功率及需求功率模型：根据车辆运行过程中的纵向动力学平衡关系，建立满足车辆速度需求相对应的驱动电机输出功率及需求功率模型；步骤四、建立锂电池模型：建立锂电池模型，电池的充放电状态由电池功率的正负进行判断，电池模型能够根据车辆制动产生的制动力进行制动能量回收；步骤五、建立燃料电池模型：燃料电池系统选用质子交换膜电池系统，建立质子交换膜燃料电池系统的氢气消耗模型；步骤六、构建车速预测模型：根据步骤一获取的历史车速数据，选择同车不同时间段的历史车速作为训练样本和测试样本，构建基于径向基神经网络的车速预测模型，该车速预测模型输出设定预测时域内对应于测试样本的预测车速；步骤七、建立基于模型预测控制的能量管理方法：模型预测控制通过在有限时域内求解出一个最优控制策略，将决策过程的当前状态作为最优控制的初始状态，得到的最优控制序列作用于下一阶段，结合车速预测模型，建立基于车速预测的模型预测控制能量管理模型。2.根据权利要求1所述的一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：步骤一中的车速数据预处理包括；剔除燃料电池公交车除车速-时间数据及行驶里程数据以外的数据；将燃料电池公交车熄火状态数据视为无效数据并从整理后的历史车速工况表中去除。3.根据权利要求2所述的一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：步骤三中驱动电机输出功率Pm以及需求功率Preq分别由式和式计算得到：其中：m表示公交车整备质量，g表示重力加速度，f表示滚动阻力系数，α表示坡度角，CD表示空气阻力系数，A表示迎风面积，u表示公交车速度，δ表示质量转换系数，表示公交车加速度，η表示公交车机械传动效率。4.根据权利要求3所述的一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：步骤四中构建的锂电池模型中的电池功率、电池电流和电池SOC分别由公式、和计算：其中：Pb表示电池功率，UOC表示电池开路电压，I表示电池电流，R表示电池内阻；电池电流由下式计算：电池SOC由下式计算：其中，Qb表示电池容量，SOC0表示电池荷电状态初始值。5.根据权利要求4所述的一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：步骤五中质子交换膜燃料电池系统的氢耗率由下式计算：其中：LH表示氢气低热值，Pf表示燃料电池系统输出功率，ηf表示燃料电池系统输出效率。6.根据权利要求5所述的一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：步骤六中构建车速预测模型内容如下：车速预测模型的输入变量为公交车历史车速Vin＝，输出变量为预测车速Vout＝，h为预测时域；车速预测模型根据车辆历史运行数据预测车辆未来某一时间段内的车速，通过训练样本插值找到一个非线性映射函数F，使其满足下式插值条件：F＝Vout其中，F为非线性映射函数；利用径向基函数进行插值，选择k个基函数训练数据：其中：基函数为非线性函数，V为训练数据的中心，Vk为输入数据点，||Vk-V||为/＞的自变量，径向基函数的插值函数为基函数/＞的线性组合：式中，ωk为未知系数，将式代入式，得到k个关于未知系数ωk的线性方程组：上述方程组改写为下式：使用车速预测平均绝对误差百分比和均方根误差作为指标，其定义如式和所示：其中：n表示测试样本数量，vi表示实际车速，vi,p表示预测车速。7.根据权利要求6所述的一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：步骤七中模型预测控制能量管理方法为：根据历史车速预测未来某段时间内的车速，将得到的预测车速根据公式和计算燃料电池公交车动力系统需求功率，通过模型预测控制优化求解模型得到最优控制序列，并反馈到动力系统中进行各动力部件功率分配；以质子交换膜燃料电池系统氢耗量与磷酸铁锂蓄电池和辅助系统等效氢耗量之和最小为优化目标，其目标函数与约束条件分别为公式和：其中：Paux表示辅助系统功率，ηDC表示变换器效率，Pf,min表示燃料电池最小输出功率，Pf,max表示燃料电池最大输出功率，Pm,min表示驱动电机最小输出功率，Pm,max表示驱动电机最大输出功率，Pb,min表示锂电池最小输出功率，Pb,max表示锂电池最大输出功率，SOCmin表示锂电池SOC下限，SOCmax表示锂电池SOC上限。8.根据权利要求1所述的一种基于车速预测的燃料电池公交车能量管理方法，其特征在于：还包括步骤八，验证基于车速预测的燃料电池公交车能量管理：基于车速预测燃料电池公交车能量管理验证需进行两部分的验证；验证一、需验证车速预测模型的准确度，该部分验证以车速预测平均绝对误差百分比和均方根误差作为指标，量化车速预测的准确性；验证二、验证所提燃料电池公交车能量管理方法经济性。
说明书desc
技术领域本发明属于交通运输技术领域，涉及一种基于车速预测的燃料电池公交车能量管理方法。背景技术新能源汽车是减少化石能源消耗和减轻环境污染的有效途径之一，燃料电池公交车属于新能源汽车中的一类，具有更加环保和节能的优点。在燃料电池公交车中，整车经济性及燃料电池、蓄电池耐久性在很大程度上依赖于动力系统能量管理策略方法的优劣。而当前燃料电池公交车的实车能量管理策略方法依赖于工程师的工程经验与各动力部件稳态特性，难以发挥燃料电池公交车的节能潜力。目前燃料电池公交车动力系统能量管理控制策略方法主要分为两类：基于规则的控制策略方法和基于优化的控制策略方法。基于规则的控制策略方法就是根据电池荷电状态和需求功率，判断燃料电池和蓄电池的工作情况。基于规则的控制策略方法常用的有消耗-维持控制策略、模糊规则控制策略等。基于优化的控制策略方法根据设定的优化目标和动力系统约束，通过优化算法对目标函数进行优化。常见的基于优化的控制策略优化方法有模型预测控制控制策略、庞特里亚金最小值原理控制策略、等效燃料消耗最小策略控制策略和全局优化控制策略等。当前，基于规则的控制策略方法设计和控制简单，但依赖于先验知识且很难提高燃料电池公交车整车能量利用率；传统基于优化的控制策略方法受外界因素或自身计算的影响，存在进一步提高模型性能和和优化效果的空间。在燃料电池公交车能量管理控制策略方法中，MPC能够很好地适应系统不确定性和复杂的动态变化，具有较强的稳定性，一般MPC可由三部分组成；预测模型、滚动优化和反馈响应。传统MPC能量管理受外界扰动的影响，容易导致预测模型响应不准确，进而影响能量管理效果，存在进一步优化的空间和潜力。发明内容本发明要解决的技术问题是：提供一种基于车速预测的燃料电池公交车能量管理方法，利用该方法合理的分配燃料电池公交车在运行过程中燃料电池和蓄电池功率的大小和流向，使得燃料电池公交车能量利用更加节能高效。本发明采用的技术方案为：一种基于车速预测的燃料电池公交车能量管理方法，具体包括以下步骤：步骤一、历史车速数据获取与预处理：获取燃料电池公交车在某个地区的实际行驶数据，数据采样时间间隔为1s，并整理为该燃料电池公交车的车速-时间工况数据表格，并对该数据表进行工况数据预处理，将获得的预处理数据整理为历史车速工况表；步骤二、选择燃料电池公交车动力系统构型：燃料电池公交车混合动力系统采用氢燃料电池和磷酸铁锂蓄电池结合，形成气-电混合驱动系统，该动力系统由氢燃料电池发动机、单向DC/DC变换器、高压配电器、电机控制器、磷酸铁锂蓄电池、双向DC/AC变换器、永磁同步电机、变速器和差速器等部分组成；步骤三、建立电机功率及需求功率模型：根据车辆运行过程中的纵向动力学平衡关系，建立满足车辆速度需求相对应的电机功率及需求功率模型；步骤四、建立锂电池模型：建立锂电池模型，以便准确描述和反映出锂电池工作状态，电池的充放电状态可由电池功率的正负进行判断，该电池模型并可根据车辆制动产生的制动力进行制动能量回收；步骤五、建立燃料电池模型：燃料电池系统选用质子交换膜电池系统，该燃料电池系统是一种将化学能转化为电能的装置，广泛应用于汽车混合动力系统结构中，建立能够准确描述质子交换膜燃料电池系统的氢气消耗模型；步骤六、构建车速预测模型：根据步骤一获取的历史车速数据，选择同车不同时间段的历史车速作为训练样本和测试样本，构建基于径向基神经网络的车速预测模型，该车速预测模型输出设定预测时域内对应于测试样本的预测车速，从而达到更好地预测和掌握车速扰动的变化的目的；步骤七、建立基于模型预测控制的能量管理方法：模型预测控制通过在有限时域内求解出一个最优控制策略，将决策过程的当前状态作为最优控制的初始状态，得到的最优控制序列作用于下一阶段，结合车速预测模型，建立基于车速预测的模型预测控制能量管理模型。进一步的，上述步骤三中驱动电机输出功率Pm以及需求功率Preq分别由式和式计算得到:其中，m表示公交车整备质量，g表示重力加速度，f表示滚动阻力系数，α表示坡度角，CD表示空气阻力系数，A表示迎风面积，u表示公交车速度，δ表示质量转换系数，表示公交车加速度，η表示公交车机械传动效率。进一步地，上述步骤四中构建的锂电池模型中的电池功率、电池电流和电池SOC分别由公式、和计算：其中：Pb表示电池功率，UOC表示电池开路电压，I表示电池电流，R表示电池内阻。电池电流由下式计算：电池SOC由下式计算：其中：Qb表示电池容量，SOC0表示电池荷电状态初始值。进一步地，上述步骤五中质子交换膜燃料电池系统的氢耗率由下式计算：其中：LH表示氢气低热值，Pf表示燃料电池系统输出功率，ηf表示燃料电池系统输出效率。进一步地，上述步骤六中构建车速预测模型内容如下：车速预测模型的输入变量为公交车历史车速Vin＝，输出变量为预测车速Vout＝，h为预测时域。车速预测模型的目的是根据车辆历史运行数据预测车辆未来某一时间段内的车速，通过训练样本插值找到一个非线性映射函数F，使其满足下式插值条件：F＝VoutF为非线性映射函数；利用径向基函数进行插值，选择k个基函数训练数据：其中：基函数为非线性函数，V为训练数据的中心，Vk为输入数据点，||Vk-V||为/＞的自变量。径向基函数的插值函数为基函数/＞的线性组合：将式代入式，得到k个关于未知系数ωk的线性方程组：上述方程组改写为下式：使用车速预测平均绝对误差百分比和均方根误差作为指标，量化车速预测的准确性，其定义如式和所示：其中：n表示测试样本数量，vi表示实际车速，vi,p表示预测车速。进一步地，上述步骤七中模型预测控制能量管理：根据历史车速预测未来某段时间内的车速，将得到的预测车速根据公式和计算燃料电池公交车动力系统需求功率，通过MPC优化求解模型得到最优控制序列，并反馈到动力系统中进行各动力部件功率分配。以质子交换膜燃料电池系统氢耗量与磷酸铁锂蓄电池和辅助系统等效氢耗量之和最小为优化目标，其目标函数与约束条件分别为公式和：其中：Paux表示辅助系统功率，ηDC表示变换器效率，Pf,min表示燃料电池最小输出功率，Pf,max表示燃料电池最大输出功率，Pm,min表示驱动电机最小输出功率，Pm,max表示驱动电机最大输出功率，Pb,min表示锂电池最小输出功率，Pb,max表示锂电池最大输出功率，SOCmin表示锂电池SOC下限，SOCmax表示锂电池SOC上限。进一步地，上述能量管理方法还包括步骤八、验证基于车速预测的燃料电池公交车能量管理：基于车速预测燃料电池公交车能量管理验证需进行两部分的验证；验证一、需验证车速预测模型的准确度，该部分验证以车速预测平均绝对误差百分比和均方根误差作为指标，量化车速预测的准确性；验证二、验证所提燃料电池公交车能量管理方法的经济性。车速作为车辆行驶状态的体现，是影响燃料电池公交车动力系统能量分配的核心参数。将车速作为预测模型的输入变量，根据历史车速信息进行燃料电池公交车车速预测，并将该车速预测模型与MPC结合，提出基于径向基神经网络车速预测的燃料电池公交车MPC能量管理策略方法。本技术方案工作原理是：该能量管理方法主要是以实车采集得到的历史数据为基础，输入足够的历史车速数据进入径向基神经网络车速预测模型，通过径向基神经网络预测设定时域范围内的车速，达到准确掌握车速变化的目的；将得到的预测车速Vout通过公式和公式计算驱动电机输出功率Pm以及需求功率Preq，并将获得的功率数据输入到模型预测控制能量管理模型中，通过模型预测控制进行实时优化，合理的将功率分配给燃料电池和蓄电池，最终达到降低整车能耗的目的。本发明的有益效果：与现有实车能量管理方法相比，本发明的效果如下：1)本发明使用的训练数据和测试数据更加方便充足，使用某公交车公司搭建的车联网平台，在全国多个地区拥有的燃料电池公交车历史行驶数据，数据获取便捷且具有多样性，可使车速预测模型得到充足多样的训练数据，提高车速预测模型预测精度；2)本发明提出的基于历史车速的车速预测模型更加快速高效，整理得到的车速信息工况表结构简单，将其输入到径向基神经网络车速预测模型中训练模型，能快速预测出未来某段时间内的车速大小；3)本发明提出的基于车速预测的燃料电池公交车能量管理方法，能以高精度预测未来某一时域内燃料电池公交车车速变化，并且能实时优化燃料电池公交车动力系统功率分配，提高燃料电池公交车能量利用率。附图说明图1为燃料电池公交车动力系统结构连接示意图；图2为基于车速预测的燃料电池公交车能量管理方法流程图；图3为车速预测模型预测结果和效果图：图中，为车速预测结果图，为车速预测效果图，为车速预测相对误差图；图4为基于车速预测的燃料电池公交车能量管理方法的动力系统功率分配结果图；具体实施方式下面结合具体的实施例对本发明进行进一步介绍。实施例1：如图1-4所示，一种基于车速预测的燃料电池公交车能力管理方法，具体包括以下步骤：步骤一、历史车速数据获取与预处理：获取燃料电池公交车在某个地区的实际行驶数据，数据采样时间间隔为1s，并整理为该燃料电池公交车的车速-时间工况数据表格，并对该数据表进行工况数据预处理，将获得的预处理数据整理为历史车速工况表；步骤二、选择燃料电池公交车动力系统构型：燃料电池公交车混合动力系统采用氢燃料电池和磷酸铁锂蓄电池结合，形成气-电混合驱动系统，其动力系统结构如图1所示，为现有的动力系统，该动力系统由氢燃料电池发动机、单向DC/DC变换器、高压配电器、电机控制器、磷酸铁锂蓄电池、双向DC/AC变换器、永磁同步电机、变速器和差速器等部分组成；该系统结构可在氢燃料电池模式、磷酸铁锂蓄电池模式、行驶充电、混合驱动和制动能量回收五种模式下运行，该动力系统构型可弥补氢燃料电池动态响应慢和磷酸铁锂蓄电池充电时间较长等问题；步骤三、建立电机功率及需求功率模型：根据车辆运行过程中的纵向动力学平衡关系，建立满足车辆速度需求相对应的电机功率及需求功率模型；驱动电机输出功率Pm以及需求功率Preq分别由式和式计算得到:其中，m表示公交车整备质量，g表示重力加速度，f表示滚动阻力系数，α表示坡度角，CD表示空气阻力系数，A表示迎风面积，u表示公交车速度，δ表示质量转换系数，表示公交车加速度，η表示公交车机械传动效率；步骤四、建立锂电池模型：建立锂电池模型，以便准确描述和反映出锂电池工作状态，电池的充放电状态可由电池功率的正负进行判断，该电池模型并可根据车辆制动产生的制动力进行制动能量回收；构建的锂电池模型中的电池功率、电池电流和电池SOC分别由公式、和计算：其中：Pb表示电池功率，UOC表示电池开路电压，I表示电池电流，R表示电池内阻；电池电流由下式计算：电池SOC由下式计算：其中：Qb表示电池容量，SOC0表示电池荷电状态初始值。步骤五、建立燃料电池模型：燃料电池系统选用质子交换膜电池系统，该燃料电池系统是一种将化学能转化为电能的装置，广泛应用于汽车混合动力系统结构中，建立能够准确描述质子交换膜燃料电池系统的氢气消耗模型，质子交换膜燃料电池系统的氢耗率由下式计算：其中：LH表示氢气低热值，Pf表示燃料电池系统输出功率，ηf表示燃料电池系统输出效率；步骤六、构建车速预测模型：根据步骤一获取的历史车速数据，选择同车不同时间段的历史车速作为训练样本和测试样本，构建基于径向基神经网络的车速预测模型，该车速预测模型输出一定预测时域内对应于测试样本的预测车速，从而达到更好地预测和掌握车速扰动的变化的目的，车速预测模型的输入变量为公交车历史车速Vin＝，输出变量为预测车速Vout＝，h为预测时域。车速预测模型的目的是根据车辆历史运行数据预测车辆未来某一时间段内的车速，通过训练样本插值找到一个非线性映射函数F，使其满足下式插值条件：F＝Vout利用径向基函数进行插值，选择k个基函数训练数据：其中：基函数为非线性函数，V为训练数据的中心，Vk为输入数据点，||Vk-V||为/＞的自变量。径向基函数的插值函数为基函数/＞的线性组合：将式代入式，得到k个关于未知系数ωk的线性方程组：上述方程组改写为下式：使用车速预测平均绝对误差百分比和均方根误差作为指标，量化车速预测的准确性，其定义如式和所示:其中：n表示测试样本数量，vi表示实际车速，vi,p表示预测车速。步骤七、建立基于模型预测控制的能量管理方法：模型预测控制通过在有限时域内求解出一个最优控制策略，将决策过程的当前状态作为最优控制的初始状态，得到的最优控制序列作用于下一阶段。结合车速预测模型，建立基于车速预测的模型预测控制能量管理模型；根据历史车速预测未来某段时间内的车速，将得到的预测车速根据公式和计算燃料电池公交车动力系统需求功率，通过MPC优化求解模型得到最优控制序列，并反馈到动力系统中进行各动力部件功率分配；以质子交换膜燃料电池系统氢耗量与磷酸铁锂蓄电池和辅助系统等效氢耗量之和最小为优化目标，其目标函数与约束条件分别为公式和：其中：Paux表示辅助系统功率，ηDC表示变换器效率，Pf,min表示燃料电池最小输出功率，Pf,max表示燃料电池最大输出功率，Pm,min表示驱动电机最小输出功率，Pm,max表示驱动电机最大输出功率，Pb,min表示锂电池最小输出功率，Pb,max表示锂电池最大输出功率，SOCmin表示锂电池SOC下限，SOCmax表示锂电池SOC上限。步骤八、验证基于车速预测的燃料电池公交车能量管理：基于车速预测燃料电池公交车能量管理验证需进行两部分的验证；验证一、需验证车速预测模型的准确度，该部分验证以车速预测平均绝对误差百分比和均方根误差作为指标，量化车速预测的准确性；验证二、验证所提燃料电池公交车能量管理方法比实车能量管理方法更加经济。本技术方案工作原理是：该能量管理方法主要是以实车采集得到的历史数据为基础，输入足够的历史车速数据进入径向基神经网络车速预测模型，通过径向基神经网络预测一定时域范围内的车速，达到准确掌握车速变化的目的；将得到的预测车速Vout通过公式和公式计算驱动电机输出功率Pm以及需求功率Preq，并将获得的功率数据输入到模型预测控制能量管理模型中，通过模型预测控制进行实时优化，合理的将功率分配给燃料电池和蓄电池，最终达到降低整车能耗的目的。为了说明本发明能够实施及其效果，进行如下验证：采用贵阳市某燃料电池公交车路试车辆采集的运行数据作为训练和测试样本，样本采样时间间隔为1s。车辆从郊区驶向市区，且郊区路段占比大于市区路段，平均车速为37km/h，全段工况车速小于燃料电池公交车最高车速69km/h。该测试工况条件下，设定车速预测时域为5s，得到测试工况相对应的车速预测结果。利用燃料电池公交车百公里等效氢耗评价各控制策略的运行经济性，如式所示：式中；meq表示燃料电池公交车百公里等效氢耗，C表示工况里程长度。实施例燃料电池公交车部分参数如表1所示。表1实施例燃料电池公交车部分参数使用本发明的车速预测结果及能量管理结果为：车速预测模型车速预测结果：预测效果及相对误差如图3所示，从图3、可以看出预测车速曲线具有很好的跟随性，预测车速结果良好；从图3可以看出，车速预测模型只在公交车加速启动、减速停止部分存在较大误差，其余正常行驶部分相对误差靠近零上下波动。预测得到车速平均绝对误差百分比为0.0283，预测均方根误差为0.8162且小于1，该车速预测模型在实车工况条件下具有较高精度。能量管理结果为：在实施例实车测试工况条件下，基于车速预测的燃料电池公交车能量管理动力系统功率分配结果如图4所示，该能量管理方法能合理的分配功率系统功率大小和流向，实车能量管理方法等效氢耗为658.39g，基于车速预测的能量管理方法等效氢耗为566.32g。且相比于实车能量管理方法，基于车速预测的能量管理方法等效氢耗更低，具有良好工程应用前景。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本发明的保护范围之内，因此，本发明的保护范围应以所述权利要求的保护范围为准。
