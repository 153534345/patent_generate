标题title
一种实时在线的污水厂溶解氧仪表异常检测的方法
摘要abst
本发明公开了一种实时在线的污水厂溶解氧仪表异常检测的方法，针对污水处理过程中影响溶解氧仪表监测结果的相关数据包括鼓风机曝气量、好氧池中溶解氧浓度、活性污泥浓度、氨氮浓度和进水流量进行在线监测，随后针对在线监测数据具有相关性的特点，利用交叉验证结合多元高斯分布模型更可靠的发现异常数据，进而高效地识别污水厂溶解氧仪表异常时间点，及时发现和解决问题，确保污水处理过程的安全、高效运行。在多元高斯分布模型基础上引入交叉验证方法，可以更好地模拟异常检测模型在未知数据上的泛化能力，从而提供对模型真实性能更可靠。
权利要求书clms
1.一种实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，包括：S1：获取数据选取实时在线目标时间段，获取影响溶解氧仪表监测结果的相关在线监测数据，组成溶解氧仪表异常检测的数据集；S2：数据粗筛对获得的影响溶解氧仪表监测结果的相关在线监测数据进行处理缺失值、平滑数据、去除离群值，获取异常值；S3：标准化处理通过聚类算法将经过粗筛的数据集根据实际场景聚类成多个簇，使每个簇内的数据集中各维影响溶解氧仪表监测结果的相关在线监测数据分别呈正态分布，随后分别对每个簇内的各维数据进行标准化预处理，将其转化为均值为0，方差为1的标准正态分布；S4：异常检测使用交叉验证的方法，将各个簇整合后划分为多个互斥的子集，选取某一个子集作为测试集，剩余的子集分别作为训练集；对上述各个训练集，分别建立多元高斯分布模型，根据业务场景设置阈值，计算测试集数据的概率密度，将计算得到的概率密度与设置的阈值比较，如果概率密度小于设置的阈值，则判断结果为异常，获取异常值，最后对各个测试集的异常值作去重处理；S5：异常点输出整合步骤S2和步骤S4中的异常值，作为目标时间段内数据集最终的异常值集合输出。2.根据权利要求1所述的实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，所述影响溶解氧仪表监测结果的相关在线监测数据包括鼓风机曝气量、好氧池中溶解氧浓度、活性污泥浓度、氨氮浓度和进水流量。3.根据权利要求1所述的实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，所述实时在线目标时间段为包括当前时刻前不少于1个小时的连续时间段。4.根据权利要求1所述的实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，全部数据集表示为：，n为全部数据集的数据维度，，表示n个影响溶解氧仪表监测结果的相关在线监测数据；每个维度数据集中的数据表示为：，m为每个维度数据集中数据的数量。5.根据权利要求1所述的实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，所述处理缺失值的具体方法为：使用缺失值前后的数据点之间的单线性插值来填充缺失值；所述单线性插值计算公式如下：式中：为缺失值，和分别为与缺失值相邻的前后值，为缺失值对应时间点，和分别为与缺失值相邻前后值对应的时间点。6.根据权利要求1所述的实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，所述平滑数据的具体方法为：设置滑动窗口的尺寸为s，前s-1个数据用原数据填充，此后每个时刻的数值为窗口包含当前时刻及其前s-1个时刻数据的均值。7.根据权利要求1所述的实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，所述去除离群值的具体方法为：分别计算各维度数据的标准分数，再分别对应设定各维度数据异常值的阈值，最后将标准分数超出阈值的数值所在的数据集作为明显异常值去除；所述各维度数据的标准分数计算公式如下：式中：为全部数据集X对应位置的标准分数；为全部数据集X对应位置的原始数值。8.根据权利要求1所述的实时在线污水厂溶解氧仪表异常检测的方法，其特征在于，所述聚类算法为K-means算法，其具体操作步骤包括：随机选择K个对象作为初始聚类中心；根据每个数据与聚类中心的距离，将每个数据分配给离它最近的聚类中心，形成初始的K个簇；对于每个簇，计算簇内所有数据的平均值，得到新的聚类中心；将每个数据点重新分配给最近新的聚类中心，形成更新后的K个簇；重复步骤和步骤，直到聚类中心不再改变或达到最大迭代次数；算法收敛后，每个数据点被分配到一个最终的簇中。9.根据权利要求1所述的实时在线的污水厂溶解氧仪表异常检测的方法，其特征在于，所述交叉验证方法的具体操作步骤：确定数据集的总样本数量m；将其随机划分成Z等份，每份形成一个折，计算每个折的样本数量approx_fold_size = m // Z；初始化一个空列表folds，用于存储划分后的折；对数据集进行随机化操作，确保每次划分折后的样本顺序都是随机的；循环遍历 Z 次a. 计算当前折的开始索引 start_index = i * approx_fold_size；b. 计算当前折的结束索引 end_index =  * approx_fold_size；c. 对于最后一个折，将结束索引设置为数据集的最后一个样本的索引；d. 从标准化数据集中提取当前折的样本，将其存储在folds列表中；返回folds列表，其中包含划分后的Z个折。
说明书desc
技术领域本发明属于污水数据处理技术领域，具体涉及一种实时在线的污水厂溶解氧仪表异常检测的方法。背景技术随着工业化和城市化的不断发展，污水处理成为了保护环境和人类健康的重要任务。污水处理厂是处理和净化废水的关键设施，其中溶解氧仪表在监测和控制污水处理过程中起着至关重要的作用。溶解氧浓度是衡量水体中活性生物体氧化能力的重要指标，对于污水处理过程的有效运行至关重要。然而，由于现实中存在多种因素的干扰，溶解氧仪表在实时在线监测中常常会出现异常情况。这些异常可能包括仪表的故障、传感器的变性、供氧系统的问题等等。如果不及时检测和解决这些异常，将会导致污水处理过程的质量下降，甚至可能引发设备故障和环境污染。现有的异常检测技术包括：1.基于统计方法：包括均值-方差方法、基于概率分布的方法、基于离群因子的方法等；2.基于距离或相似度：包括离群点相似度、基于聚类的异常检测方法等，这类方法通常使用样本之间的距离或相似度来衡量异常程度；3.基于机器学习：包括基于监督学习的方法和基于无监督学习的方法；4.基于深度学习：近年来，深度学习在异常检测中得到广泛应用，如自编码器、变分自编码器、生成对抗网络等；5.基于规则或模型：这类方法基于预定义的规则或模型，如知识库、专家系统等。溶解氧仪表异常检测方法在保障污水处理厂运行稳定、提高处理效率、保护环境和公众健康等方面具有重要的意义。由于人工智能理论和统计学理论的发展，可以将异常检测技术应用于污水处理厂的仪表监控系统中。发明内容本发明的目的在于提供一种实时在线的污水厂溶解氧仪表异常检测的方法，可以高效地识别污水厂溶解氧仪表异常时间点，实现对仪表状态的实时监测和异常诊断，及时发现和解决问题，确保污水处理过程的安全、高效运行。为达到上述目的，本发明采用的技术方案如下：一种实时在线的污水厂溶解氧仪表异常检测的方法，包括：S1：获取数据选取实时在线目标时间段，获取影响溶解氧仪表监测结果的相关在线监测数据，组成溶解氧仪表异常检测的数据集；S2：数据粗筛对获得的影响溶解氧仪表监测结果的相关在线监测数据进行处理缺失值、平滑数据、去除离群值，获取异常值；S3：标准化处理通过聚类算法将经过粗筛的数据集根据实际场景聚类成多个簇，使每个簇内的数据集中各维影响溶解氧仪表监测结果的相关在线监测数据分别呈正态分布，随后分别对每个簇内的各维数据进行标准化预处理，将其转化为均值为0，方差为1的标准正态分布；S4：异常检测使用交叉验证的方法，将各个簇整合后划分为多个互斥的子集，选取某一个子集作为测试集，剩余的子集分别作为训练集；对上述各个训练集，分别建立多元高斯分布模型，根据业务场景设置阈值，计算测试集数据的概率密度，将计算得到的概率密度与设置的阈值比较，如果概率密度小于设置的阈值，则判断结果为异常，作为异常值，最后对各个测试集的异常值作去重处理；S5：异常点输出，整合步骤S2和步骤S4中的异常值，作为目标时间段内数据集最终的异常值集合输出。进一步，所述影响溶解氧仪表监测结果的相关在线监测数据包括鼓风机曝气量、好氧池中溶解氧浓度、活性污泥浓度、氨氮浓度和进水流量。优选的，所述实时在线目标时间段为包括当前时刻前不少于1个小时的连续时间段。优选的，全部数据集表示为：，n为全部数据集的数据维度，表示n个影响溶解氧仪表监测结果的相关在线监测数据，每一个数据集中的数据表示为：，m为数据集的数量。进一步，所述处理缺失值的具体方法为：使用缺失值前后的数据点之间的单线性插值来填充缺失值；所述单线性插值计算公式如下：.式中：为缺失值，和分别为与缺失值相邻的前后值，为缺失值对应时间点，和分别为与缺失值相邻前后值对应的时间点。进一步，所述平滑数据的具体方法为：设置滑动窗口的尺寸为s，前s-1个数据用原数据填充，此后每个时刻的数值为窗口包含当前时刻及其前s-1个时刻的数据的均值。进一步，所述去除离群值的具体方法为：分别计算各维度数据的标准分数，再分别对应设定各维度数据异常值的阈值，最后将标准分数超出阈值的数值所在的数据集作为明显异常值去除；所述各维度数据的标准分数计算公式如下：式中：为全部数据集X对应位置的标准分数；为全部数据集X对应位置的原始数值。.进一步，所述聚类算法为K-means算法，其具体操作步骤：随机选择K个对象作为初始聚类中心；根据每个数据与聚类中心的距离，将每个数据分配给离它最近的聚类中心，形成初始的K个簇；对于每个簇，计算簇内所有数据的平均值，得到新的聚类中心；将每个数据点重新分配给最近新的聚类中心，形成更新后的K个簇；重复步骤和步骤，直到聚类中心不再改变或达到最大迭代次数；算法收敛后，每个数据点被分配到一个最终的簇中；进一步，所述交叉验证方法的具体操作步骤：确定数据集的总样本数量m；计算每个折的样本数量，将其设为approx_fold_size = m // Z；初始化一个空列表folds，用于存储划分后的折；对整合后的标准化数据集进行随机化操作，确保每次划分折后的样本顺序都是随机的；循环遍历Z次a. 计算当前折的开始索引start_index = i * approx_fold_size；b. 计算当前折的结束索引end_index =  * approx_fold_size；c. 对于最后一个折，将结束索引设置为数据集的最后一个样本的索引；d. 从标准化数据集中提取当前折的样本，将其存储在folds列表中；返回folds列表，其中包含划分后的Z个折。本发明的技术方案中：针对影响溶解氧仪表监测结果的相关在线监测数据具有时间连续性、相关性和无监督的特点。利用数据粗筛分别对获得的数据集中明显异常点进行识别并去除，增强监测数据的趋势性，有利于后续异常检测的准确性。粗筛后的数据通过聚类算法进行标准化处理，因为后续需要结合多元高斯分布模型进行处理，而多元高斯分布模型是基于正态分布假设的，因此输入数据应该呈现出正态分布的形状，针对在线监测数据复杂多变，为此采用聚类方法结合标准化处理将原始数据转化成符合正态分布的数据集，用于后续异常检测。然后，针对在线监测数据具有相关性的特点，基于多元高斯分布模型对各数据集进行异常检测，又在线监测数据具有无监督的特点，即数据集状态无标签，需根据业务经验设定异常点阈值，同时，为避免异常检测模型过拟合和欠拟合，在多元高斯分布模型基础上引入交叉验证方法，可以更好地模拟异常检测模型在未知数据上的泛化能力，从而提供对模型真实性能的更可靠估计。最后，整合粗筛异常点和深度异常点，作为目标时间段内数据集最终的异常点集合。与现有技术相比，本发明的有益效果：本发明针对污水处理过程中影响溶解氧仪表监测结果的相关数据包括鼓风机曝气量、好氧池中溶解氧浓度、活性污泥浓度、氨氮浓度和进水流量进行在线监测，随后针对在线监测数据具有相关性的特点，利用交叉验证结合多元高斯分布模型更可靠的发现异常数据，进而高效地识别污水厂溶解氧仪表异常时间点，及时发现和解决问题，确保污水处理过程的安全、高效运行。而现有的针对溶解氧仪表设备异常检测，更多依赖于有标签的历史数据，但由于设置标签需要投入大量人力，且容易出错，实际生产数据往往是无标签的，所以很难及时、准确发现数据的异常，导致污水处理过程的质量下降。本发明针对影响溶解氧仪表监测结果的相关在线监测数据具有时间连续性、相关性和无监督的特点，为避免异常检测模型过拟合和欠拟合，在多元高斯分布模型基础上引入交叉验证方法，可以更好地模拟异常检测模型在未知数据上的泛化能力，从而提供对模型真实性能的更可靠估计，高效地识别污水厂溶解氧仪表异常时间点，为系统运行状况诊断提供数据支撑。附图说明图1是本发明实施例所述方法的流程示意图；图2是本发明实施例数据预处理前后各影响因素概率密度函数对比图；图3是本发明实施例粗筛异常点和深度异常点图。具体实施方式下面结合实施例和附图对本发明做进一步说明。以某污水厂为试点，如图1所示，本发明所述的一种实时在线的污水厂溶解氧仪表异常检测的方法，包括以下步骤：步骤1：获取数据：获取影响溶解氧仪表监测结果的相关在线监测数据，选取目标时间段：5个小时共计3600个数据集，组成溶解氧仪表异常检测的全部数据集；步骤2：数据粗筛：分别对各个影响溶解氧仪表监测结果的相关在线监测数据进行数据粗筛，去除明显异常值，获取异常值；步骤3：标准化处理：通过聚类算法将经过粗筛的数据集聚类成5个簇，使每个簇内的数据集中各维影响溶解氧仪表监测结果的相关在线监测数据呈正态分布；分别对每个簇内的数据集中各维影响溶解氧仪表监测结果的相关在线监测数据进行适当的标准化预处理，将其转化为均值为0，方差为1的标准正态分布；步骤4：异常检测：使用交叉验证的方法，将经预处理的各个簇数据集整合后划分为5个互斥的子集，选取某一个作为测试集，剩余的子集分别作为训练集；对上述各个训练集，分别建立多元高斯分布模型，根据业务场景设置合适的阈值，计算测试集数据的概率密度，将计算得到的概率密度与设置的阈值比较，如果概率密度小于设置的阈值，则判断结果为异常，获取异常值，最后对各个测试集的异常值作去重处理；步骤5：异常点输出：整合经过数据粗筛的异常点和使用交叉验证的方法基于多元高斯分布模型检测出的异常点，作为目标数据集最终的异常点。本发明实施例中，步骤1所述影响溶解氧仪表监测结果的相关在线监测数据包括鼓风机曝气量、好氧池中溶解氧浓度、活性污泥浓度、氨氮浓度和进水流量；所述鼓风机曝气量、好氧池中溶解氧浓度、活性污泥浓度、氨氮浓度和进水流量的在线监测数据具有一定的相关性；所述实时在线目标时间段为选取包括当前时刻前5个小时的连续实时在线监测数据；所述全部数据集表示为：，n为全部数据集的数据维度，表示n个影响溶解氧仪表监测结果的相关在线监测数据，每一个数据集中的数据表示为：，m为数据集的数量。本发明依赖以下原理：原理1：相同运行工况下的影响溶解氧仪表监测结果的相关在线监测数据符合多元高斯分布。即对于污水厂实际影响溶解氧仪表监测结果的相关在线监测数据，受设备精度，环境等影响，根据中心极限定理，数据误差在统计学上符合高斯分布。高斯分布概率密度函数：其中x为观察变量，,分别为x数学期望以及方差。多元高斯分布假设n个变量，则X的概率密度函数为：其中，，∑为变量X的协方差矩阵。步骤1所述处理缺失值的方法为：使用缺失值前后的数据点之间的单线性插值来填充缺失值；所述单线性插值计算公式如下：；其中，为缺失值，和分别为缺失值的相邻前后值，为缺失值对应时间点，和分别为缺失值的相邻前后值对应时间点；步骤2所述平滑数据的方法为：设置滑动窗口的尺寸为12，前11个数据用原数据填充，此后每个时刻的数值为窗口包含当前时刻及其前11个时刻的数据的均值；步骤3所述去除离群值的方法为：首先计算各维度数据的标准分数，再统一设定各维度数据异常值的阈值，最后将标准分数超出阈值的数值所在的数据集作为明显异常值去除；所述各维度数据的标准分数计算公式如下：其中，为全部数据集X对应位置的标准分数。本发明依赖的原理2：对于相同运行工况下的影响溶解氧仪表监测结果的相关在线监测数据发生不在原理1中的模型正常参数范围。这是因为对于实际生产数据，异常的发生通常概率极低。异常数据的指标往往会偏离正常数值，如偏离期望3倍标准差。如果数值仍在正常范围内，则溶解氧仪表监测结果不会有问题。对于由于突变的运行工况造成时间序列上的在线监测数据分布不符合高斯分布的情形，通过聚类分析将不同工况下的数据进行聚类分割以满足后续异常检测的数据特性要求。为此，步骤3采用K-means聚类算法对数据集进行聚类分割，其思路可以概括为以下步骤：本实施例随机选择5个初始聚类中心点；根据每个数据点与聚类中心的距离，将每个数据点分配给离它最近的聚类中心，形成初始的5个簇；对于每个簇，计算所有数据点的平均值，得到新的聚类中心；将每个数据点重新分配到最近的新聚类中心，形成更新后的5个簇；重复步骤3和步骤4，直到达到最大迭代次数100；算法收敛后，每个数据点被分配到一个最终的簇中；K-means算法的目标是最小化簇内误差平方和，即最小化每个数据点与其所属簇的聚类中心的距离之和，通过迭代更新聚类中心，K-means算法将数据点划分为不同的簇，使得簇内的数据点相似度较高，而不同簇之间的相似度较低；所述簇内误差平方和计算公式如下：；其中，K为聚类簇数，为第i个簇内数据集，p为内的各个数据点，为第i个簇内中心点；为消除不同簇内相同维度数据集数量级差异，采用步骤3所述标准化预处理，计算公式如下：其中，为每个簇内数据集X对应位置的标准值，为第k个簇内数据集的数量。步骤4所述交叉验证的方法，本实例将整合后的数据集划分为5个近似大小的折，其思路可以概括为以下步骤：确定数据集的总样本数量m为5个小时连续实时在线监测数据；计算每个折的样本数量，将其设为 approx_fold_size = m // 5；初始化一个空列表 folds，用于存储划分后的折；对整合后的标准化数据集进行随机化操作，确保每次划分折后的样本顺序都是随机的；循环遍历5次：a. 计算当前折的开始索引 start_index = i * approx_fold_size；b. 计算当前折的结束索引 end_index =  * approx_fold_size；c. 对于最后一个折，将结束索引设置为数据集的最后一个样本的索引；d. 从标准化数据集中提取当前折的样本，将其存储在folds列表中；返回folds列表，其中包含划分后的5个折；交叉验证可以更好地模拟异常检测模型在未知数据上的泛化能力，从而提供对模型真实性能的更可靠估计。通过交叉验证，可以更好地避免异常检测模型过拟合和欠拟合；所述多元高斯分布模型，其思路可以概括为以下步骤：将不同折的训练集数据作为输入，分别计算溶解氧仪表监测结果影响因素变量对应的期望以及协方差∑；将计算得到的，∑代入多元高斯分布函数，得到溶解氧仪表监测结果的多元高斯分布模型f；其中，；为变量与变量的协方差，为中的任一值；所述分别对对应的测试集进行异常检测的方法为：对于不同折的测试集数据，根据步骤4）得到的多元高斯分布模型，计算测试集数据的概率密度，将计算得到的概率密度与异常检测阈值比较，如果概率密度小于异常检测阈值，则判断结果为异常。高斯分布下，数据偏离均值的概率随着偏离增大而显著下降，例如，设置阈值为0.001，在一维高斯分布中即认为异常数据在统计上以0.1%的概率出现，则结合步骤c对于步骤4）得到的多元高斯分布模型，正常数据不会偏离均值的三倍标准差。理论上的多元高斯分布模型一般直接选择阈值，通过该阈值进行异常数据的判定，即对于输入数据，在模型中出现概率低于阈值时，判定为异常。本发明采用交叉验证的方法，不需要提前进行溶解氧仪表监测结果标注异常与否，因此需要预先设定异常发生的比例，本实例比例为0.5%。图2是本发明实施例数据预处理前后鼓风机曝气量、好氧池中溶解氧浓度、活性污泥浓度、氨氮浓度和进水流量概率密度函数对比图，由图可见，实施例数据经聚类标准化预处理后，全部数据集中各维影响溶解氧仪表监测结果的相关在线监测数据分别呈正态分布。图3是本发明实施例粗筛异常点和深度异常点图，粗筛异常点分别在影响溶解氧仪表监测结果的各因素曲线上标记，深度异常点在目标数据时间轴上进行异常点时间轴标记，由图可见，从各维监测数据分别看，活性污泥浓度和溶解氧浓度存在若干粗筛异常点，从各数据集综合看，存在若干深度异常点，粗筛异常点和深度异常点综合即为溶解氧仪表异常检测点。本发明申请人结合说明书附图对本发明的实施示例做了详细的说明与描述，但是本领域技术人员应该理解，以上实施示例仅为本发明的优选实施方案，详尽的说明只是为了帮助读者更好地理解本发明精神，而并非对本发明保护范围的限制，相反，任何基于本发明的发明精神所作的任何改进或修饰都应当落在本发明的保护范围之内。
