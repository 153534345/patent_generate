标题title
一种基于音频转换与时间图神经网络的叫声分类方法
摘要abst
本发明公开了一种基于音频转换与时间图神经网络的叫声分类方法，属于声音识别技术领域，将海洋哺乳动物原始叫声音频数据转化为音频图，提取步骤1音频图每个节点Log‑Mel频谱特征，设计时间注意力图神经网络，将步骤2音频图每个节点Log‑Mel频谱特征输入时间注意力图神经网络进行学习，在时间注意力图神经网络的输出层上构建全连接神经网络分类器，将音频数据分类为所需的类别，设计损失函数，使用已标记的海洋哺乳动物叫声音频数据对时间注意力神经网络进行训练，通过反向传播和梯度下降优化算法来优化时间注意力图神经网络的参数，最小化分类误差。在复杂海洋环境下，能够快速准确分类海洋哺乳动物叫声，准确率达到98%以上。
权利要求书clms
1.一种基于音频转换与时间图神经网络的叫声分类方法，其特征在于，包括以下步骤：S1、将海洋哺乳动物原始叫声音频数据转化为音频图，S2、提取步骤1所述音频图每个节点Log-Mel频谱特征，S3、设计时间注意力图神经网络，将步骤2所述音频图每个节点Log-Mel频谱特征输入时间注意力图神经网络进行学习，S4、在时间注意力图神经网络的输出层上构建全连接神经网络分类器，将音频数据分类为所需的类别，S5、设计损失函数，使用已标记的海洋哺乳动物叫声音频数据对时间注意力图神经网络进行训练，通过反向传播和梯度下降优化算法来优化时间注意力图神经网络的参数，最小化分类误差。2.如权利要求1所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，将所述海洋哺乳动物原始叫声音频数据转化为音频图的方法为：将海洋哺乳动物原始叫声音频数据按时间窗口进行不重叠分割，每个时间窗口被看作是音频图的一个节点；然后构建音频图的边，定义节点之间的连接关系，音频数据通过分割转化为节点之后，边根据时间顺序建立，所述每个时间窗口与其相邻的时间窗口之间存在边，从而形成无向图G=，即音频图，其中V表示节点集合，E表示边的集合。3.如权利要求1所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，提取所述音频图每个节点Log-Mel频谱特征的方法为：S2-1：将音频图节点通过高通滤波器进行预加重处理，对预加重处理后的叫声数据进行分帧、汉明窗加窗；S2-2：对步骤2-1处理后的每一帧叫声数据进行离散傅里叶变换后得到各帧的频谱，并对各帧的频谱取模平方得到对应的功率谱；S2-3：将功率谱输入到Mel滤波器组中，对于每个Mel滤波器，计算其与功率谱的加权和，以得到该Mel滤波器的能量值，然后，对每个Mel滤波器的能量值进行对数变换，以模拟人耳对声音强度的感知方式，并产生Log-Mel频率能量/＞，将每帧的Mel滤波器能量值串联在一起组成序列，构成Log-Mel频谱特征图。4.如权利要求1所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，所述时间注意力图神经网络包括输入层、图注意力层以及输出层。5.如权利要求4所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，将所述音频图每个节点Log-Mel频谱特征输入时间注意力图神经网络进行学习的方法为：S3-1：将音频图作为时间序列数据集输入输入层，随后通过图注意力层进行节点特征更新、注意力权重计算与信息聚合；S3-2：节点特征更新：对于每个节点，首先计算其邻居节点/＞的特征信息，其中/＞是的直接邻居节点，公式如下：其中，表示节点/＞在上一时间步t-1的特征，/＞是一个权重矩阵，用于线性变换；S3-3：对于节点，逐个计算它的邻居节点/＞和节点/＞之间的相似系数，公式如下：其中，共享参数的线性映射对节点的特征进行增维，/＞对于节点i、j的变换后的特征进行拼接，最后/＞把拼接后的高维特征映射到一个实数上，/＞表示节点/＞的邻居节点集合；S3-4：计算注意力权重：为每对节点和其邻居节点/＞计算一个注意力权重/＞，表示节点i应该关注邻居节点j的程度，通过以下公式计算，其中，表示一个可学习的注意力权重参数，/＞为激活函数，/＞表示每个节点/＞与其邻居节点/＞通过计算被赋予的特征；S3-5：将边的权重通过softmax函数归一化，以得到每个节点对其邻居节点的注意力分布：其中，表示节点/＞的邻居节点集合，/＞表示当前节点与其相邻节点的相似系数，/＞表示节点k与其相邻节点的相似系数；S3-6：信息聚合：对节点i的特征进行加权聚合，以得到更新后的节点表示：其中，表示激活函数LeakyReLU，/＞表示节点/＞在时间步t的特征，根据需要堆叠多个时间步来处理整个时序音频图数据。6.如权利要求1所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，所述分类器包括输入层、一层隐藏层以及输出层。7.如权利要求6所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，使用所述分类器将音频数据分类为所需的类别的方法为：S4-1：音频图在时间注意力图神经网络输出后，每个节点都有一个表示其特征的向量，其中t表示时间步数；S4-2：在构建分类器之前，对所有节点的特征进行注意力池化，是一种全局的特征汇总操作：其中，为全局特征，维度为/＞用作分类器的输入，/＞表示每个节点对其邻居节点的注意力分布，/＞表示节点在时间步t的特征，将全局特征输入到分类器的输入层进行音频数据分类；S4-3：所述分类器拥有一个隐藏层包含个神经元，隐藏层的输出为：其中，是权重矩阵，维度为/＞，/＞是偏差向量，维度为/＞，/＞为激活函数LeakyReLU；S4-4：分类器输出层设计，输出层包含个神经元，每个神经元对应一个类别，输出层的输入为：其中，为输出层的最后一层，/＞是权重矩阵，维度为/＞，/＞为偏差向量，维度为/＞；S4-5：使用softmax函数将所述输出层的输入转换为类别概率分布：其中，表示样本属于类别/＞的概率，/＞表示输出层中与类别/＞对应的神经元输入，/＞表示输出层中与类别i对应的神经元输入。8.如权利要求1所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，所述损失函数采用交叉熵损失函数：其中，是样本数量，/＞是第i个样本是否属于类别/＞的二进制标签，/＞是算法预测样本i属于类别/＞的概率。9.如权利要求8所述的基于音频转换与时间图神经网络的叫声分类方法，其特征在于，所述通过反向传播和梯度下降优化算法来优化时间注意力图神经网络的参数的方法为：S5-1：通过反向传播误差计算梯度，从输出层开始，计算损失函数对输出层的参数的梯度，将输出层的梯度传播到前一层，以计算前一层的参数的梯度，重复上述过程，递归应用这个过程，一直传播梯度到输入层，计算每一层的参数梯度；S5-2：按照梯度下降的规则，更新时间注意力图神经网络的权重和偏置：其中，是参数，/＞是学习率，/＞是损失函数，/＞是梯度，重复上述步骤，直到满足达到一定的训练轮数、损失函数收敛到最小为止。
说明书desc
技术领域本发明属于声音识别技术领域，具体地说，涉及一种基于音频转换与时间图神经网络的海洋哺乳动物叫声分类方法。背景技术研究海洋哺乳动物的数量分布和迁徙行为，对维护生物多样性和生态平衡具有重要意义。要保护海洋哺乳动物，首先要识别它们的叫声，作为海洋中最重要的物种之一，海洋哺乳动物对其生活环境的变化高度敏感，因此经常被视为最适合评估生态环境质量的研究对象。海洋中充满了来自自然、生物或人为来源的各种声音。通过分类海洋哺乳动物的声音，科学家可以检测、识别和定位不同的海洋物种，进一步保护海洋生态环境，保护海洋生物物种多样性。当前国内提出了很多关于海洋哺乳动物叫声分类的研究方法。2022年，中国海洋大学信息科学与工程学院徐铭等人设计了一套基于现场可编程门阵列的鲸豚声信号实时数据采集与分析系统，在采集存储水族馆内声信号的同时，应用改进的希尔伯特黄变换算法处理鲸豚叫声中的点击信号，实现实时的甄别瓶鼻海豚和白鲸功能。结果表明，分类的准确率达到了86.7%以上，通过对该系统进一步完善可将其布放到远洋货轮及远洋科考船上，从而随船实时识别大型水下哺乳动物，为海洋生态环保提供了技术支持。在2022年，吕连港等人开发了一种基于卷积神经网络的新方法来精确分类宽吻海豚、儒艮和中华白海豚的叫声，可以自动学习不同海洋哺乳动物叫声的特征，并在声谱图中用边界框定位目标叫声。实验结果表明，该方法对测试数据的准确率大于91%。因为海洋中特殊信道环境，以上方法均存在识别准确率低，可识别种类较少的问题，在稍微复杂的环境之下，分类海洋哺乳动物叫声的准确率就大大降低。发明内容本发明的目的是提出一种基于音频转换与时间图神经网络的叫声分类方法，以弥补现有技术的不足。为实现上述发明目的，本发明采用下述技术方案予以实现：一种基于音频转换与时间图神经网络的叫声分类方法，依次包括以下步骤：S1、将海洋哺乳动物原始叫声音频数据转化为音频图，S2、提取步骤1所述音频图每个节点Log-Mel频谱特征，S3、设计时间注意力图神经网络，将步骤2所述音频图每个节点Log-Mel频谱特征输入时间注意力图神经网络进行学习，S4、在时间注意力图神经网络的输出层上构建全连接神经网络分类器，将音频数据分类为所需的类别，S5、设计损失函数，使用已标记的海洋哺乳动物叫声音频数据对时间注意力图神经网络进行训练，通过反向传播和梯度下降优化算法来优化时间注意力神经网络的参数，最小化分类误差。进一步的，将所述海洋哺乳动物原始叫声音频数据转化为音频图的方法为：将海洋哺乳动物原始叫声音频数据按时间窗口进行不重叠分割，每个时间窗口被看作是音频图的一个节点；然后构建音频图的边，定义节点之间的连接关系，音频数据通过分割转化为节点之后，边根据时间顺序建立，所述每个时间窗口与其相邻的时间窗口之间存在边，从而形成无向图G=，即音频图，其中表示节点集合，/＞表示边的集合。进一步的，提取所述音频图每个节点Log-Mel频谱特征的方法为：S2-1：将音频图节点通过高通滤波器进行预加重处理，对预加重处理后的叫声数据进行分帧、汉明窗加窗；S2-2：对每一帧叫声数据进行离散傅里叶变换后得到各帧的频谱，并对各帧的频谱取模平方得到对应的功率谱；S2-3：将功率谱输入到Mel滤波器组中，对于每个Mel滤波器，计算其与功率谱的加权和，以得到该Mel滤波器的能量值，然后，对每个Mel滤波器的能量值进行对数变换，以模拟人耳对声音强度的感知方式，并产生Log-Mel频率能量/＞，将每帧的Mel滤波器能量值串联在一起组成序列，构成Log-Mel频谱特征图。优选的，所述时间注意力图神经网络包括输入层、图注意力层以及输出层。进一步的，将所述音频图每个节点Log-Mel频谱特征输入时间注意力图神经网络进行学习的方法为：S3-1：将音频图作为时间序列数据集输入输入层，随后通过图注意力层进行节点特征更新、注意力权重计算与信息聚合；S3-2：节点特征更新：对于每个节点，首先计算其邻居节点/＞的特征信息，其中是/＞的直接邻居节点，公式如下：其中，表示节点/＞在上一时间步t-1的特征，/＞是一个权重矩阵，用于线性变换；S3-3：对于节点，逐个计算它的邻居节点/＞和节点/＞之间的相似系数，公式如下：其中，共享参数的线性映射对节点的特征进行增维，/＞对于节点i、j的变换后的特征进行拼接，最后/＞把拼接后的高维特征映射到一个实数上，表示节点/＞的邻居节点集合；S3-4：计算注意力权重：为每对节点和其邻居节点/＞计算一个注意力权重/＞，表示节点i应该关注邻居节点j的程度，通过以下公式计算，其中，表示一个可学习的注意力权重参数，/＞为激活函数，表示每个节点/＞与其邻居节点/＞通过计算被赋予的特征；S3-5：将边的权重通过softmax函数归一化，以得到每个节点对其邻居节点的注意力分布：其中，表示节点/＞的邻居节点集合，/＞表示当前节点与其相邻节点的相似系数，/＞表示节点k与其相邻节点的相似系数；S3-6：信息聚合：对节点i的特征进行加权聚合，以得到更新后的节点表示：其中，表示激活函数LeakyReLU，/＞表示节点/＞在时间步t的特征，根据需要堆叠多个时间步来处理整个时序音频图数据。优选的，所述分类器包括输入层、一层隐藏层以及输出层。进一步的，使用所述分类器将音频数据分类为所需的类别的方法为：S4-1：音频图在时间注意力图神经网络输出后，每个节点都有一个表示其特征的向量/＞，其中t表示时间步数；S4-2：在构建分类器之前，对所有节点的特征进行注意力池化，是一种全局的特征汇总操作：其中，为全局特征，维度为/＞用作分类器的输入，/＞表示每个节点对其邻居节点的注意力分布，/＞表示节点在时间步t的特征，将全局特征输入到分类器的输入层进行音频数据分类；S4-3：所述分类器拥有一个隐藏层包含个神经元，隐藏层的输出为：其中，是权重矩阵，维度为/＞，/＞是偏差向量，维度为/＞，/＞为激活函数LeakyReLU；S4-4：分类器输出层设计，输出层包含个神经元，每个神经元对应一个类别，输出层的输入为：其中，为输出层的最后一层，/＞是权重矩阵，维度为/＞，/＞为偏差向量，维度为/＞；S4-5：使用softmax函数将所述输出层的输入转换为类别概率分布：其中，表示样本属于类别/＞的概率，/＞表示输出层中与类别/＞对应的神经元输入，/＞表示输出层中与类别i对应的神经元输入。优选的，所述损失函数采用交叉熵损失函数：其中，是样本数量，/＞是第i个样本是否属于类别/＞的二进制标签，/＞是算法预测样本i属于类别/＞的概率。进一步的，所述通过反向传播和梯度下降优化算法来优化时间注意力图神经网络的参数的方法为：S5-1：通过反向传播误差计算梯度，从输出层开始，计算损失函数对输出层的参数的梯度，将输出层的梯度传播到前一层，以计算前一层的参数的梯度，重复上述过程，递归应用这个过程，一直传播梯度到输入层，计算每一层的参数梯度；S5-2：按照梯度下降的规则，更新时间注意力图神经网络的权重和偏置：其中，是参数，/＞是学习率，/＞是损失函数，/＞是梯度，重复上述步骤，直到满足达到一定的训练轮数、损失函数收敛到最小为止。本发明的优点和技术效果如下：设计基于音频转换与时间注意力图神经网络的海洋哺乳动物叫声分类网络模型，首先将原始海洋哺乳动物叫声音频转化为图，通过将音频分割为不重叠的时间窗口，每个时间窗口对应一个节点，同时按照时间顺序构建节点的边，形成无边图拓扑结构；然后提取节点的Mel谱图特征，通过时间注意力图神经网络学习信息、传递和节点的关系，接着在T-GAT的输出层上构建全连接神经网络分类器用于音频分类任务；最后，通过训练和优化，使用标记的音频数据来调整T-GAT的参数，以最小化分类误差；通过时间注意力图神经网络的处理，得到海洋哺乳动物叫声的特征更加明了，通过将音频转化为图的方法，从而构建图神经网络模型的输入，有助于捕获多个数据源中的相关信息，提供更全面的海洋哺乳动物叫声中的隐藏信息，从而提高了模型的判别能力，准确率达到98%以上。附图说明图1是本发明的的海洋哺乳动物叫声分类方法整体流程图；图2是本发明的音频数据转换为音频图方法的流程图；图3是本发明的节点Log-Mel频谱特征提取的流程图；图4是本发明的时间注意力图神经网络结构图；图5是本发明的分类器的结构图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下将结合附图和实施例，对本发明作进一步详细说明。实施例：现有海洋哺乳动物叫声分类方法，吕连港等人开发的一种基于卷积神经网络的新方法来分类宽吻海豚、儒艮和中华白海豚的叫声，可以自动学习不同海洋哺乳动物叫声的特征，并在声谱图中用边界框定位目标叫声。实验结果表明，该方法对测试数据的准确率大于91%。由于海洋环境充满了各种各样的噪声和干扰，如海水流动声、其他动物的声音和人类活动产生的声音，这些噪声和干扰可能对叫声分类造成困扰，导致误分类。海洋哺乳动物的声音具有多样性和复杂性，不同种类之间的声音可能在频谱、时域和时长等方面差异巨大，因此，现有海洋哺乳动物叫声分类方法准确率普遍较低。本实施例提出了一种基于音频转换与时间图神经网络的海洋哺乳动物叫声分类方法，其整体流程如图1所示，方法包括以下步骤：S1、将海洋哺乳动物原始叫声音频数据转化为音频图，S2、提取步骤1所述音频图每个节点Log-Mel频谱特征，S3、设计时间注意力图神经网络，将步骤2所述音频图每个节点Log-Mel频谱特征输入时间注意力图神经网络进行学习，S4、在时间注意力图神经网络的输出层上构建全连接神经网络分类器，将音频数据分类为所需的类别，S5、设计损失函数，使用已标记的海洋哺乳动物叫声音频数据对时间注意力图神经网络进行训练，通过反向传播和梯度下降优化算法来优化时间注意力神经网络的参数，最小化分类误差。具体的，将所述海洋哺乳动物原始叫声音频数据转化为音频图的方法为：将海洋哺乳动物原始叫声音频数据按时间窗口大小为0.1秒进行不重叠分割，每个时间窗口被看作是音频图的一个节点，从而构成音频图结构中的节点，公式如下：其中，i表示第i个时间窗口，i=0，1，2……，音频信号为，时间窗口的长度为/＞，那么时间窗口之间不重叠，分割后得到的时间窗口序列仍然为W，每个时间窗口/＞由音频数据的样本点组成。如图2所示，构建音频图的边，定义节点之间的连接关系，以构建音频图的拓扑结构，音频数据通过分割转化为节点之后，边根据时间顺序建立，其中每个时间窗口与其相邻的时间窗口之间存在边，形成一个无向图，即音频图，其中/＞表示节点集合，i=0，1，2……，/＞表示边的集合，每一个/＞表示一个时序样本数据的特征表示。具体的，提取步骤1所述音频图每个节点Log-Mel频谱特征，这些特征作为时间注意力图神经网络的输入，如图3所示，具体步骤如下：S2-1：将音频图节点通过高通滤波器进行预加重处理，对预加重处理后的叫声数据进行分帧、汉明窗加窗。所述高通滤波器表示为，其中，的取值范围为0.9到1，用于控制高通滤波器的增益，z为节点中切割后的叫声音频。S2-2：对每个窗口帧执行离散傅里叶变换，将时域音频转换为频域表示，DFT会生成每个帧的频谱信息，然后，将频谱的每个复数分量取模的平方，以获得对应帧的功率谱，功率谱表示音频在频域上的能量分布。S2-3：将功率谱输入到Mel滤波器组中，Mel滤波器组是一组三角形滤波器，设计成与人耳的感知频率响应相匹配，对于每个Mel滤波器，计算其与功率谱的加权和，以得到该Mel滤波器的能量值，然后，对每个Mel滤波器的能量值进行对数变换，以模拟人耳对声音强度的感知方式，并产生Log-Mel频率能量/＞，将每帧的Mel滤波器能量值串联在一起组成序列，构成Log-Mel频谱特征图。具体的，设计时间注意力图神经网络，所述时间注意力图神经网络包括输入层、图注意力层以及输出层，学习音频在图上传播信息和捕捉图中的关系。在T-GAT中执行消息传递和图卷积操作。如图4所示，每个节点将从其相邻节点接收信息，并通过聚合函数来更新自身的表示，具体步骤如下：S3-1：将音频图作为时间序列数据集输入输入层，随后通过图注意力层进行节点特征更新、注意力权重计算与信息聚合；S3-2：节点特征更新：对于每个节点，首先计算其邻居节点/＞的特征信息，其中是/＞的直接邻居节点，公式如下：其中，表示节点/＞在上一时间步t-1的特征，/＞是一个权重矩阵，用于线性变换；S3-3：对于节点，逐个计算它的邻居节点/＞和节点/＞之间的相似系数，公式如下：其中，共享参数的线性映射对节点的特征进行增维，/＞对于节点i、j的变换后的特征进行拼接，最后/＞把拼接后的高维特征映射到一个实数上，表示节点/＞的邻居节点集合；S3-4：计算注意力权重：为每对节点和其邻居节点/＞计算一个注意力权重/＞，表示节点i应该关注邻居节点j的程度，通过以下公式计算，其中，表示一个可学习的注意力权重参数，/＞为激活函数，表示每个节点/＞与其邻居节点/＞通过计算被赋予的特征；S3-5：将边的权重通过softmax函数归一化，以得到每个节点对其邻居节点的注意力分布：其中，表示节点/＞的邻居节点集合，/＞表示当前节点与其相邻节点的相似系数，/＞表示节点k与其相邻节点的相似系数；S3-6：信息聚合：对节点i的特征进行加权聚合，以得到更新后的节点表示：其中，表示激活函数LeakyReLU，/＞表示节点/＞在时间步t的特征，根据需要堆叠多个时间步来处理整个时序音频图数据。具体的，在时间注意力图神经网络的输出层上构建全连接神经网络分类器，所述分类器包含输入层、一层隐藏层以及输出层。将音频数据分类为所需的类别，如图5所示，具体步骤如下：S4-1：音频图在时间注意力图神经网络输出后，每个节点都有一个表示其特征的向量/＞，其中t表示时间步数，这些特征向量包含了来自整个图的信息，已经捕捉到了音频数据的时序和关系信息；S4-2：在构建分类器之前，对所有节点的特征进行注意力池化，是一种全局的特征汇总操作：其中，为全局特征，维度为/＞用作分类器的输入，/＞表示每个节点对其邻居节点的注意力分布，/＞表示节点在时间步t的特征，将全局特征输入到分类器的输入层进行音频数据分类；S4-3：所述分类器拥有一个隐藏层包含个神经元，隐藏层的输出为：其中，是权重矩阵，维度为/＞，/＞是偏差向量，维度为/＞，/＞为激活函数LeakyReLU；S4-4：分类器输出层设计，输出层包含个神经元，每个神经元对应一个类别，输出层的输入为：其中，为输出层的最后一层，/＞是权重矩阵，维度为/＞，/＞为偏差向量，维度为/＞；S4-5：使用softmax函数将所述输出层的输入转换为类别概率分布：其中，表示样本属于类别/＞的概率，/＞表示输出层中与类别/＞对应的神经元输入，/＞表示输出层中与类别i对应的神经元输入。具体的，设计损失函数，使用已标记的海洋哺乳动物叫声音频数据对时间注意力图神经网络进行训练，通过反向传播和梯度下降优化算法来优化时间注意力图神经网络的参数，最小化分类误差，具体步骤如下：S5-1：所述损失函数采用交叉熵损失函数：其中，是样本数量，/＞是第i个样本是否属于类别/＞的二进制标签，/＞是算法预测样本i属于类别/＞的概率；S5-2：通过反向传播误差计算梯度，从输出层开始，计算损失函数对输出层的参数的梯度，将输出层的梯度传播到前一层，以计算前一层的参数的梯度，重复上述过程，递归应用这个过程，一直传播梯度到输入层，计算每一层的参数梯度；S5-3：计算得到的梯度，按照梯度下降的规则，更新神经网络的权重和偏置：其中，是参数，/＞是学习率，/＞是损失函数，/＞是梯度。重复上述步骤，直到满足达到一定的训练轮数、损失函数收敛到最小为止。本实施例使用训练数据和梯度下降优化算法来最小化损失函数，更新模型的权重参数和偏差参数，以便更好地适应训练数据，提高分类准确率。通过时间注意力图神经网络对音频图特征进行自适应加权，并对节点的Log-Mel频谱特征图进行特征分析，大幅提高模型的性能，提高准确率。以上所述之实施例子只为本发明之较佳实施例，并非以此限制本发明的实施范围，故凡依本发明之形状、原理所作的变化，均应涵盖在本发明的保护范围内。
