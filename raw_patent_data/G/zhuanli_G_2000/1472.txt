标题title
一种单次曝光的彩色无透镜成像方法及系统
摘要abst
本发明公开了一种单次曝光的彩色无透镜成像方法及系统，属于彩色无透镜成像领域，单次曝光的彩色无透镜成像方法能够从单张多波长混叠的衍射图像中重建样品的彩色聚焦图像，利用光场衍射的角谱传递函数的波长差异从单次曝光的多波长混叠的衍射图像中重建待测样品的彩色聚焦图；本系统包括多波长照明光模块，用于产生彩色的激光照明；单色相机，用于记录多波长照明的样品衍射图像。本发明可以在单色相机单次曝光的情况下实现彩色无透镜成像，无需透镜成像，无需彩色相机；能够提供高通量、高速率和低成本的成像技术。
权利要求书clms
1.一种单次曝光的彩色无透镜成像方法，其特征在于，包括以下步骤：S101，通过多波长照明光模块中单色激光发射器发射出不同中心波长的激光光束，照射在分束棱镜上，通过分束棱镜将激光光束合束，形成方向相同，路径重合的平行光；S102，通过分束棱镜将激光光束合束的平行光照射在扩束透镜后，形成多波长照明平面波，照射在样品上，并利用单色相机对样品进行拍摄记录；S103，样品被多波长照明平面波照明后衍射至相机面后的光场表示为：式中F与F-1分别为傅里叶变换和傅里叶逆变换，d为衍射距离，λn表示第n个波长，u表示样品的透射率，T表示第n个波长λn的光场衍射d距离的菲涅尔传递函数；S104，将式进行换算，得到多波长衍射图像的表达式，基于多波长衍射图像的表达式，利用压缩感知重建将多波长衍射图像中不同波长的聚焦图像分离；S105，聚焦图像分离后，根据样品复透射率函数合成一张彩色的样品聚焦图像。2.根据权利要求1所述的一种单次曝光的彩色无透镜成像方法，其特征在于，在所述S104步骤中，通过对式进行换算，得到多波长衍射图像表达式的过程如下：对于波长λn有式中，j表示虚数单位，表示空间频谱的坐标位置；波长为λn、衍射距离为d的菲涅尔传递函数T等价于波长为λ1、衍射距离为的菲涅尔传递函数/＞由于相机仅能获取强度信息，最终的多波长衍射图像的表达式表示为：3.根据权利要求1所述的一种单次曝光的彩色无透镜成像方法，其特征在于，在所述S104步骤中，基于多波长衍射图像的表达式，利用压缩感知重建将多波长衍射图像中不同波长的聚焦图像分离过程如下：利用向量化表示分离后的聚焦图像，表达式为：y＝S|FTTFu|2其中，u＝T，T＝diag，F和FT表示傅里叶变换与逆傅里叶变换矩阵，S表示求和矩阵，即将多个波长的衍射图像进行求和，u表示样品面的多波长光场复振幅向量，uλ1 uλ2 uλ3表示样品面单波长的光场复振幅向量，T表示向量或矩阵的转置运算，T表示系数；将式转化得到：其中TV表示全变分范数，τ表示正则化系数；对于表达式，设多波长样品复透射率的函数为全1，使用梯度下降方法求得中间变量z，利用中间变量z，得到u'表示迭代更新的复透射率函数，并对u'按照一定循环次数进行迭代后，将样品面的多波长广场复振幅向量的u＝T，输出结果为uλ1,uλ2,uλ3的样品面的单波长复振幅。4.根据权利要求3所述的一种单次曝光的彩色无透镜成像方法，其特征在于，在所述S105步骤中，根据样品复透射率函数合成一张彩色的样品聚焦图像的过程为：根据循环迭代后输出的样品面单波长复振幅uλ1,uλ2,uλ3，取样品面单波长的光场复振幅的振幅|uλ1|,|uλ2|,|uλ3|的灰度图作为图像的R、G、B三通道，合成样品振幅的彩色图像。5.根据权利要求3所述的一种单次曝光的彩色无透镜成像方法，其特征在于，在所述S105步骤中，根据样品复透射率函数合成一张彩色的样品聚焦图像的过程为：根据循环迭代后输出的样品面单波长复振幅uλ1,uλ2,uλ3，取单波长复振幅的相位∠uλ1,∠uλ2,∠uλ3的灰度作为图像的RGB三通道，合成样品相位的彩色图像。6.根据权利要求1所述的一种单次曝光的彩色无透镜成像方法，其特征在于，在所述S101步骤中，多波长照明光模块中单色激光发射器发射出不同中心波长的激光光束照射在分束棱镜上的具体过程如下：多波长照明光模块中的单色激光发射器包括第一单色激光器、第二单色激光器和第三单色激光器，分束棱镜包括第一分束棱镜和第二分束棱镜，第一单色激光器和第二单色激光器照射在第一分束棱镜上，第三单色激光器照射在第二分束棱镜上，第一分束棱镜和第二分束棱镜将第一单色激光器、第二单色激光器和第三单色激光器所发射的激光光束进行合束，形成方向相同，路径重合的平行光。7.根据权利要求1所述的一种单次曝光的彩色无透镜成像方法，其特征在于，在所述S102步骤中，通过分束棱镜将激光光束合束的平行光照射在扩束透镜后，形成多波长照明平面波照射在样品上，其中扩束透镜包括第一扩束透镜和第二扩束透镜，第一扩束透镜和第二扩束透镜位于同一直线方向，平行光穿过第一扩束透镜和第二扩束透镜后形成多波长照明平面波，并照射在样品上。8.一种应用于权利要求1-7任意一项所述的单次曝光的彩色无透镜成像方法的系统，其特征在于，所述系统包括用于产生多波长激光照明的多波长照明光模块，以及用于记录多波长照明的样品衍射图像的单色相机，所述多波长照明光模块包括激光发射器、分束棱镜和扩束镜，所述激光发射器、分束棱镜和扩束镜设置于同一水平直线方向上，在扩束镜的一端依次设置样品和单色相机。9.根据权利要求8所述的单次曝光的彩色无透镜成像方法的系统，其特征在于，所述激光发射器包括第一单色激光器、第二单色激光器、第三单色激光器，所述分束棱镜包括第一分束棱镜和第二分束棱镜；所述第一单色激光器、第一分束棱镜和第二分束棱镜依次设置在同一直线方向，所述第二单色激光器和第三单色激光器分别位于所述第一分束棱镜和第二分束棱镜的正上方。10.根据权利要求9所述的单次曝光的彩色无透镜成像方法的系统，其特征在于，所述扩束镜包括第一扩束透镜和第二扩束透镜，所述第一单色激光器、第一分束棱镜、第二分束棱镜、第一扩束透镜、第二扩束透镜和单色相机位于同一直线方向，在第二扩束透镜和单色相机之间设置所述样品，且样品和第二扩束透镜以及单色相机位于同一直线方向。
说明书desc
技术领域本发明涉及彩色无透镜成像技术领域，尤其涉及一种单次曝光的彩色无透镜成像方法及系统。背景技术实现无透镜的光学成像一直是光学成像领域研究的重要方向。衍射成像是一种无透镜的光学成像技术，其通过获取样品被相干光照明衍射后的衍射图像并进行重建最终获得样品的聚焦图像。一方面传统衍射成像使用单色相干光源作为照明，仅能获得样品的单色图像，另一方面传统的彩色照明需要切换照明光源的波长，并顺序采集图像，最后合成单张彩色图，这种方法采集速度慢，单次成像的通量小。为此，我们设计出了一种单次曝光的彩色无透镜成像方法及系统来解决以上问题。发明内容本发明的目的是为了解决现有技术中存在的使用单色相干光源作为照明，仅能获得样品的单色图像，合成单张彩色图时采集速度慢，单次成像的通量小等缺点，而提出的一种单次曝光的彩色无透镜成像方法及系统，其目的是可以在单色相机单次曝光的情况下实现彩色无透镜成像。为了实现上述目的，本发明采用了如下技术方案：一种单次曝光的彩色无透镜成像方法，包括以下步骤：S101，通过多波长照明光模块中单色激光发射器发射出不同中心波长的激光光束，照射在分束棱镜上，通过分束棱镜将激光光束合束，形成方向相同，路径重合的平行光；S102，通过分束棱镜将激光光束合束的平行光照射在扩束透镜后，形成多波长照明平面波，照射在样品上，并利用单色相机对样品进行拍摄记录；S103，样品被多波长照明平面波照明后衍射至相机面后的光场表示为：式中F与F-1分别为傅里叶变换和傅里叶逆变换，d为衍射距离，λn表示第n个波长，u表示样品的透射率，T表示第n个波长λn的光场衍射d距离的菲涅尔传递函数；S104，将式进行换算，得到多波长衍射图像的表达式，基于多波长衍射图像的表达式，利用压缩感知重建将多波长衍射图像中不同波长的聚焦图像分离；S105，聚焦图像分离后，根据样品复透射率函数合成一张彩色的样品聚焦图像。进一步的，在所述S104步骤中，通过对式进行换算，得到多波长衍射图像表达式的过程如下：对于波长λn有式中，j表示虚数单位，表示空间频谱的坐标位置；波长为λn、衍射距离为d的菲涅尔传递函数T等价于波长为λ1、衍射距离为的菲涅尔传递函数/＞由于相机仅能获取强度信息，最终的多波长衍射图像的表达式表示为：/＞进一步的，在所述S104步骤中，基于多波长衍射图像的表达式，利用压缩感知重建将多波长衍射图像中不同波长的聚焦图像分离过程如下：利用向量化表示分离后的聚焦图像，表达式为：y＝S|FTTFu|2其中，u＝T，T＝diag，F和FT表示傅里叶变换与逆傅里叶变换矩阵，S表示求和矩阵，即将多个波长的衍射图像进行求和，u表示样品面的多波长光场复振幅向量，uλ1uλ2 uλ3表示样品面单波长的光场复振幅向量，T表示向量或矩阵的转置运算，T表示系数；将式转化得到：其中TV表示全变分范数，τ表示正则化系数；对于表达式，设多波长样品复透射率的函数为全1，使用梯度下降方法求得：利用中间变量z，得到u'表示迭代更新的复透射率函数，并对u'按照一定循环次数进行迭代后，将样品面的多波长广场复振幅向量的u＝T，输出结果为uλ1,uλ2,uλ3的样品面的单波长复振幅。进一步的，在所述S105步骤中，根据样品复透射率函数合成一张彩色的样品聚焦图像的过程为：根据循环迭代后输出的样品面单波长复振幅uλ1,uλ2,uλ3，取样品面单波长的光场复振幅的振幅|uλ1|,|uλ2|,|uλ3|的灰度图作为图像的R、G、B三通道，合成样品振幅的彩色图像。进一步的，在所述S105步骤中，根据样品复透射率函数合成一张彩色的样品聚焦图像的过程为：根据循环迭代后输出的样品面单波长复振幅uλ1,uλ2,uλ3，取单波长复振幅的相位∠uλ1,∠uλ2,∠uλ3的灰度作为图像的RGB三通道，合成样品相位的彩色图像。进一步的，在所述S101步骤中，多波长照明光模块中单色激光发射器发射出不同中心波长的激光光束照射在分束棱镜上的具体过程如下：多波长照明光模块中的单色激光发射器包括第一单色激光器、第二单色激光器和第三单色激光器，分束棱镜包括第一分束棱镜和第二分束棱镜，第一单色激光器和第二单色激光器照射在第一分束棱镜上，第三单色激光器照射在第二分束棱镜上，第一分束棱镜和第二分束棱镜将第一单色激光器、第二单色激光器和第三单色激光器所发射的激光光束进行合束，形成方向相同，路径重合的平行光。进一步的，在所述S102步骤中，通过分束棱镜将激光光束合束的平行光照射在扩束透镜后，形成多波长照明平面波照射在样品上，其中扩束透镜包括第一扩束透镜和第二扩束透镜，第一扩束透镜和第二扩束透镜位于同一直线方向，平行光穿过第一扩束透镜和第二扩束透镜后形成多波长照明平面波，并照射在样品上。一种应用于单次曝光的彩色无透镜成像方法的系统，所述系统包括用于产生多波长激光照明的多波长照明光模块，以及用于记录多波长照明的样品衍射图像的单色相机，所述多波长照明光模块包括激光发射器、分束棱镜和扩束镜，所述激光发射器、分束棱镜和扩束镜设置于同一水平直线方向上，在扩束镜的一端依次设置样品和单色相机。进一步的，所述激光发射器包括第一单色激光器、第二单色激光器、第三单色激光器，所述分束棱镜包括第一分束棱镜和第二分束棱镜；所述第一单色激光器、第一分束棱镜和第二分束棱镜依次设置在同一直线方向，所述第二单色激光器和第三单色激光器分别位于所述第一分束棱镜和第二分束棱镜的正上方。进一步的，所扩束镜包括第一扩束透镜和第二扩束透镜，所述第一单色激光器、第一分束棱镜、第二分束棱镜、第一扩束透镜、第二扩束透镜和单色相机位于同一直线方向，在第二扩束透镜和单色相机之间设置所述样品，且样品和第二扩束透镜以及单色相机位于同一直线方向。与现有技术相比，本发明的有益效果是：本发明能够从单张多波长混叠的衍射图像中重建样品的彩色聚焦图像，利用光场衍射的角谱传递函数的波长差异，从单次曝光的多波长混叠的衍射图像中重建待测样品的彩色聚焦图，有效解决了现有技术中存在的使用单色相干光源作为照明，仅能获得样品的单色图像，合成单张彩色图时采集速度慢，单次成像的通量小的缺陷，本发明无需透镜成像，无需彩色相机，能够提供高通量、高速率和低成本的成像技术。附图说明图1为本发明提出的一种单次曝光的彩色无透镜成像的系统结构示意图；图2为本实施例中一张典型的多波长混叠衍射图像；图3为本实施例中压缩感知重建算法的求解流程示意图；图4为本实施例中从图2衍射图像中求解的三个波长的聚焦相位图像。图中各标号：1、第一单色激光器；2、第二单色激光器；3、第三单色激光器；4、第一分束棱镜；5、第二分束棱镜；6、第一扩束透镜；7、第二扩束透镜；8、样品；9、单色相机。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。实施例一：一种单次曝光的彩色无透镜成像方法，包括以下步骤：S101，通过多波长照明光模块中单色激光发射器发射出不同中心波长的激光光束，照射在分束棱镜上，通过分束棱镜将激光光束合束，形成方向相同，路径重合的平行光。多波长照明光模块中单色激光发射器发射出不同中心波长的激光光束照射在分束棱镜上的具体过程如下：多波长照明光模块中的单色激光发射器包括第一单色激光器1、第二单色激光器2和第三单色激光器3，分束棱镜包括第一分束棱镜4和第二分束棱镜5，第一单色激光器1和第二单色激光器2照射在第一分束棱镜4上，第三单色激光器3照射在第二分束棱镜5上，第一分束棱镜4和第二分束棱镜5将第一单色激光器1、第二单色激光器2和第三单色激光器3所发射的激光光束进行合束，形成方向相同，路径重合的平行光。S102，通过分束棱镜将激光光束合束的平行光照射在扩束透镜后，形成多波长照明平面波，照射在样品8上，并利用单色相机9对样品8进行拍摄记录。通过分束棱镜将激光光束合束的平行光照射在扩束透镜后，形成多波长照明平面波照射在样品8上，具体操作如下：扩束透镜包括第一扩束透镜6和第二扩束透镜7，第一扩束透镜6和第二扩束透镜7位于同一直线方向，平行光穿过第一扩束透镜6和第二扩束透镜7后形成多波长照明平面波，并照射在样品8上。S103，样品8被多波长照明平面波照明后衍射至相机面后的光场表示为：式中F与F-1分别为傅里叶变换和傅里叶逆变换，d为衍射距离，λn表示第n个波长，u表示样品的透射率，T表示第n个波长λn的光场衍射d距离的菲涅尔传递函数。S104，将式进行换算，得到多波长衍射图像的表达式，基于多波长衍射图像的表达式，利用压缩感知重建将多波长衍射图像中不同波长的聚焦图像分离。具体的，通过对式进行换算，得到多波长衍射图像表达式的过程如下：对于波长λn有式中，j表示虚数单位，表示空间频谱的坐标位置；波长为λn、衍射距离为d的菲涅尔传递函数T等价于波长为λ1、衍射距离为的菲涅尔传递函数/＞由于相机仅能获取强度信息，最终的多波长衍射图像的表达式表示为：基于多波长衍射图像的表达式，利用压缩感知重建将多波长衍射图像中不同波长的聚焦图像分离过程如下：利用向量化表示分离后的聚焦图像，表达式为：y＝S|FTTFu|2其中，u＝T，T＝diag，F和FT表示傅里叶变换与逆傅里叶变换矩阵，S表示求和矩阵，即将多个波长的衍射图像进行求和，u表示样品面的多波长光场复振幅向量，uλ1uλ2 uλ3表示样品面单波长的光场复振幅向量，T表示向量或矩阵的转置运算，T表示系数；将式转化得到：其中TV表示全变分范数，τ表示正则化系数；对于表达式，设多波长样品复透射率的函数为全1，使用梯度下降方法求得：利用中间变量z，得到u'表示迭代更新的复透射率函数，并对u'按照一定循环次数进行迭代后，将样品面的多波长广场复振幅向量的u＝T，输出结果为uλ1,uλ2,uλ3的样品面的单波长复振幅。S105，聚焦图像分离后，根据样品复透射率函数合成一张彩色的样品聚焦图像。根据样品复透射率函数合成一张彩色的样品聚焦图像的过程为：根据循环迭代后输出的样品面单波长复振幅uλ1,uλ2,uλ3，取样品面单波长的光场复振幅的振幅|uλ1|,|uλ2|,|uλ3|的灰度图作为图像的R、G、B三通道，合成样品振幅的彩色图像。根据样品复透射率函数合成一张彩色的样品聚焦图像的过程为：根据循环迭代后输出的样品面单波长复振幅uλ1,uλ2,uλ3，取单波长复振幅的相位∠uλ1,∠uλ2,∠uλ3的灰度作为图像的RGB三通道，合成样品相位的彩色图像。实施例二、本实施例在实施例一的基础上，结合具体数值介绍单次曝光的彩色无透镜成像方法的应用原理。多波长照明光模块中的单色激光发射器包括第一单色激光器1、第二单色激光器2和第三单色激光器3，其中第一单色激光器1、第二单色激光器2和第三单色激光器3发出的光束的中心波长分别为430nm、515nm和660nm，第一单色激光器1和第二单色激光器2照射在分束棱镜的第一分束棱镜4上，第三单色激光器3照射在分束棱镜的第二分束棱镜5上，第一分束棱镜4和第二分束棱镜5将第一单色激光器1、第二单色激光器2和第三单色激光器3发出的激光光束进行合束，形成方向相同、路径重合的平行光束。该平行光包含了三种波长成分，平行光先后照射在第一扩束透镜6和第二扩束透镜7后，被扩束成为多波长照明平面波，平面波照射在样品8上。单色相机9在样品8的一侧，与样品8之间的距离为100mm，对于第n个波长λn，样品8的透射率为u，样品8被多波长照明平面波照明后衍射至相机面后的光场可以表示为其中F与F-1分别为傅里叶变换和傅里叶逆变换，d为衍射距离，T表示第n个波长λn的光场衍射d距离的菲涅尔传递函数。对于波长λn有：T表示空间频谱的坐标位置；即波长为λn，、衍射距离为d的菲涅尔传递函数T等价于波长为λ1，衍射距离为的菲涅尔传递函数/＞于是，以430nm为λ1，d＝100mm，515nm,660nm的等效衍射距离为83mm和65mm，由于单色相机9仅能获取强度信息，最终的多波长衍射图像表示为：如图2所示的多波长混叠衍射图像。多波长衍射图像的差异可以看作是衍射距离的差异，即不同波长的清晰图像聚焦在不同的轴向位置，由此可以利用压缩感知重建算法将衍射图像中不同波长的聚焦图像分离。压缩感知重建算法如下：利用向量化表示的多波长衍射图像可以表示为y＝S|FTTFu|2，其中u＝T，T＝diag，S表示求和矩阵，即将多个波长的衍射图进行求和，u表示样品面的多波长光场复振幅向量，uλ1 uλ2 uλ3表示样品面单波长的光场复振幅向量，T表示向量或矩阵的转置运算，T表示系数。压缩感知重建算法求解的优化问题表示为：其中，TV表示全变分范数，约束u变量的梯度域稀疏，τ表示正则化系数。如图3所示，其求解算法流程如下：1)设置多波长样品复透射率函数的初始猜想，本实施例可以设置为全1；2)使用梯度下降方法求解子问题1：获得中间变量z；3)迭代循环求解子问题2：u'表示迭代更新的复透射率函数，并对u'按照一定循环次数进行迭代后，将样品面的多波长广场复振幅向量的u＝T，输出结果为uλ1,uλ2,uλ3的样品面的单波长复振幅；4)对子问题1和子问题2的求解过程设置迭代循环次数上限，本实施例迭代循环次数上限设置为100次，若达到100次后，停止迭代循环，输出结果，若未达到迭代循环次数上限，则返回第2)步；使用上述算法从图2衍射图像中求解的三个波长的聚焦相位图像如图4所示；具体的，使用三个波长的样品复透射率函数合成通过第4)步输出的样品面单波长复振幅uλ1uλ2uλ3，取单波长复振幅的振幅|uλ1|,|uλ2|,|uλ3|的灰度图作为图像的R、G、B三通道，合成样品振幅的彩色图像；或取单波长复振幅的相位∠uλ1,∠uλ2,∠uλ3的灰度图作为图像的R、G、B三通道，合成样品相位的彩色图像，∠表示取相位角。实施例三、如图1所示，本实施例提出一种应用于单次曝光的彩色无透镜成像方法的系统，该系统包括用于产生多波长激光照明的多波长照明光模块，以及用于记录多波长照明的样品衍射图像的单色相机9，多波长照明光模块包括激光发射器、分束棱镜和扩束镜，激光发射器、分束棱镜和扩束镜设置于同一水平直线方向上，在扩束镜的一端依次设置样品8和单色相机9。激光发射器包括第一单色激光器1、第二单色激光器2、第三单色激光器3，分束棱镜包括第一分束棱镜4和第二分束棱镜5；第一单色激光器1、第一分束棱镜4和第二分束棱镜5依次设置在同一直线方向，第二单色激光器2和第三单色激光器3分别位于第一分束棱镜4和第二分束棱镜5的正上方。扩束镜包括第一扩束透镜6和第二扩束透镜7，第一单色激光器1、第一分束棱镜4、第二分束棱镜5、第一扩束透镜6、第二扩束透镜7和单色相机9位于同一直线方向，在第二扩束透镜7和单色相机9之间设置所述样品8，且样品8和第二扩束透镜7以及单色相机9位于同一直线方向。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，根据本发明的技术方案及其发明构思加以等同替换或改变，都应涵盖在本发明的保护范围之内。
