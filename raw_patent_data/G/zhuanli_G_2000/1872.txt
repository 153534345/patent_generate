标题title
基于自注意力的红外图像超分辨率方法、装置及可读介质
摘要abst
本发明公开了一种基于自注意力的红外图像超分辨率方法、装置及可读介质，涉及图像处理领域，包括：构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型；将待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，该模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过轻量级Transformer与CNN骨干和高效细节自注意力模块，且高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将第一特征和第二特征进行残差连接后输入图像重建模块，输出高分辨率红外图像，解决参数量冗余、性能差等问题。
权利要求书clms
1.一种基于自注意力的红外图像超分辨率方法，其特征在于，包括以下步骤：获取待重建的低分辨率红外图像；构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型；将所述待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，所述经训练的轻量级红外图像超分辨率模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，其中，所述轻量级Transformer与CNN骨干包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块，具体操作如下：；；其中，和/＞分别表示所述混合Transformer残差模块与高效残差自注意力模块对应的函数；/＞、/＞和/＞分别表示第一特征、第6个高效残差自注意力模块的输出与所述轻量级Transformer与CNN骨干的输出；所述待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过所述轻量级Transformer与CNN骨干和高效细节自注意力模块，且所述高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将所述第一特征和第二特征进行残差连接后输入所述图像重建模块，输出高分辨率红外图像。2.根据权利要求1所述的基于自注意力的红外图像超分辨率方法，其特征在于，所述高效残差自注意力模块包括1个层归一化、4个1×1深度可分离卷积层和3个3×3深度可分离卷积层，具体过程如下：输入特征先通过层归一化，并分别经过3组深度可分离卷积模块，生成查询Q、键K和值V，其中，所述深度可分离卷积模块包括1个1×1深度可分离卷积层和1个3×3深度可分离卷积层，将所述查询Q、键K和值V输入转型函数生成Q^、K^和V^，根据Q^、K^获得当前层的未经过激活函数的自注意力图，并通过残差连接与上一层高效残差自注意力模块输出的未经过激活函数的自注意力图按像素点相加再经过ELU激活函数，得到当前层的经过激活函数的自注意力图，公式如下：；；其中，、/＞和/＞分别为当前层的未经过激活函数的自注意力图、上一层的未经过激活函数的自注意力图以及当前层的经过激活函数的自注意力图；/＞、/＞是可学习的参数；/＞代表ELU激活函数，根据值V^和自注意力图/＞生成自注意力图加权特征/＞，所述自注意力图加权特征/＞在经过1个1 × 1深度可分离卷积层后，将与高效残差自注意力模块的输入特征/＞按像素点相加，以生成高效残差自注意力模块的输出特征/＞。3.根据权利要求1所述的基于自注意力的红外图像超分辨率方法，其特征在于，所述混合Transformer残差模块包括2个高效残差自注意力模块、2个3×3深度可分离卷积层和2个1×1的卷积层，具体操作如下：；；其中，、/＞、/＞和/＞分别表示第1个1×1卷积层、第1个高效残差自注意力模块、第1个1×1深度可分离卷积层、第2个高效残差自注意力模块对应的函数，/＞、和/＞分别表示所述混合Transformer残差模块的输入、第1个1×1卷积层的输出以及所述混合Transformer残差模块的输出，/＞表示/＞操作。4.根据权利要求1所述的基于自注意力的红外图像超分辨率方法，其特征在于，所述高效细节自注意力模块包括2个多头自注意力模块、2个前馈神经模块和1个1×1卷积层，2个多头自注意力模块中分别通过2组具有非对称核的全连接层展开得到的向量来生成查询Qi、键Ki和值Vi，其中，Qi,Ki,Vi，将2组内的查询Q交换，并利用Q1K2T与Q2K1T生成两组自注意力图Ai/＞ ，/＞，进而分别与值V2与V1进行矩阵相乘运算以生成两个聚合特征Fi/＞，分别将两个聚合特征分别输入2个前馈神经模块，得到2个前馈神经模块的输出，并对2个前馈神经模块的输出经过特征折叠后进行/＞操作，得到拼接特征，将所述拼接特征输入1×1卷积层，得到第二特征Foutput/＞，公式如下：；；；；；其中，和/＞分别代表经典Transformer中的多头自注意力模块和前馈神经模块对应的模块；/＞、/＞、/＞、/＞和/＞分别表示第一个多头自注意力模块的输出、第二个多头自注意力模块的输出、第一个前馈神经模块的输出、第二个前馈神经模块的输出和第二特征；/＞是一个可学习的参数；/＞表示1×1 卷积层对应的函数；/＞代表Softmax激活函数。5.根据权利要求1所述的基于自注意力的红外图像超分辨率方法，其特征在于，所述图像重建模块采用亚像素卷积来进行上采样。6.根据权利要求1所述的基于自注意力的红外图像超分辨率方法，其特征在于，所述轻量级红外图像超分辨率模型的操作如下：；；；；其中，表示3×3 卷积层对应的函数，/＞是3×3 卷积层的输出特征，/＞表示所述轻量级Transformer与CNN骨干对应的函数，/＞是所述轻量级Transformer与CNN骨干的输出特征，/＞表示所述高效细节自注意力模块对应的函数，其中n代表所述高效细节自注意力模块以共享参数的方式循环n次，/＞是高效细节自注意力模块的输出特征，表示所述图像重建模块对应的函数，/＞和/＞分别表示输入的低分辨率图像和输出的高分辨率图像。7.一种基于自注意力的红外图像超分辨率装置，其特征在于，包括：数据获取模块，被配置为获取待重建的低分辨率红外图像；模型构建模块，被配置为构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型；执行模块，被配置为将所述待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，所述经训练的轻量级红外图像超分辨率模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，其中，所述轻量级Transformer与CNN骨干包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块，具体操作如下：；；其中，和/＞分别表示所述混合Transformer残差模块与高效残差自注意力模块对应的函数；/＞、/＞和/＞分别表示第一特征、第6个高效残差自注意力模块的输出与所述轻量级Transformer与CNN骨干的输出；所述待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过所述轻量级Transformer与CNN骨干和高效细节自注意力模块，且所述高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将所述第一特征和第二特征进行残差连接后输入所述图像重建模块，输出高分辨率红外图像。8.一种电子设备，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如权利要求1-6中任一所述的方法。9.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现如权利要求1-6中任一所述的方法。
说明书desc
技术领域本发明涉及图像处理领域，具体涉及一种基于自注意力的红外图像超分辨率方法、装置及可读介质。背景技术红外图像广泛应用于遥感、工业、医学、安防、交通等领域。然而，由于红外成像设备的硬件限制，捕获到的红外图像通常分辨率较低，妨碍了重要细节的获取。图像超分辨率可以从现有的低分辨率图像来重建更多细节的高分辨率图像。由于无需升级成像设备，SR在提升图像质量方面是一种经济而有效的技术。近年来，由于卷积神经网络的强大特征表达能力，基于CNN的SR方法吸引了越来越多的关注。SRCNN首次构建了一个包含三个卷积层的端到端网络来学习LR与HR图像块之间的映射关系。VDSR将残差学习引入SR网络，显著加快了网络收敛速度。进一步的，EDSR与RCAN分别构建了参数量为43 M与16 M的深层网络，并取得了显著的SR性能。然而，与自然图像相比，红外图像存在信息量少的特点，具体表现为分辨率低、对比度低、信噪比低、细节模糊等。因此，在深度学习的应用中，红外图像在一定程度上缺乏可学习的关键特征。重量级的SR方法，例如EDSR与RCAN，在红外数据集上训练时易出现参数量冗余问题，因此难以通过充分训练来重建令人满意的红外图像。随着CNN的快速发展，涌现了大量轻量级的SR方法，其参数量通常介于300K与1M之间。但是由于卷积的固有特性，只能提取局部特征，而忽略了特征之间的长距离依赖。这不可避免地影响到全局轮廓结构的复原，导致重建图像轮廓不清甚至线条扭曲。更重要的是，由于红外图像相较于自然图像在局部图像块上缺少可学习的细节特征，适用于自然图像的超分辨率方法应用于红外图像时性能会退化。尽管如此，由于在实际应用中计算资源相对有限，近年来大多数红外SR方法均采用计算复杂度低、收敛速度快的轻量级网络。最近，Transformer在自然语言处理领域展现出优异的性能，很多学者开始探索Transformer在计算机视觉领域中的应用。传统的基于CNN的模型通过堆叠大量的卷积层，只能在深层网络中获得大的感受野，相比之下，基于Transformer的模型通过有效探索长距离依赖，在浅层网络中就能获得全局感受野，有效提高了全局特征表示能力。因此，近期基于Transformer的SR方法无论是性能还是效率上都优于基于CNN的SR方法。然而，大多数基于Transformer的SR方法仍然存在两个问题。第一，由于不完美的特征表示或者存在分散注意力的图像块，在深层网络可能产生次优的自注意力图，从而引入错误的特征依赖，导致SR性能退化。第二，基于对称窗口的自注意力模块忽略了窗口内小尺度图像块之间的特征依赖，这不利于细粒度特征的提取，阻碍了SR性能。发明内容针对上述提到的技术问题。本申请的实施例的目的在于提出了一种基于自注意力的红外图像超分辨率方法、装置及可读介质，来解决以上背景技术部分提到的技术问题。第一方面，本发明提供了一种基于自注意力的红外图像超分辨率方法，包括以下步骤：获取待重建的低分辨率红外图像；构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型；将待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，经训练的轻量级红外图像超分辨率模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，其中，轻量级Transformer与CNN骨干包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块，具体操作如下：；；其中，和/＞分别表示混合Transformer残差模块与高效残差自注意力模块对应的函数；/＞、/＞和/＞分别表示第一特征、第6个高效残差自注意力模块的输出与轻量级Transformer与CNN骨干的输出；待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过轻量级Transformer与CNN骨干和高效细节自注意力模块，且高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将第一特征和第二特征进行残差连接后输入图像重建模块，输出高分辨率红外图像。作为优选，高效残差自注意力模块包括1个层归一化、4个1×1深度可分离卷积层和3个3×3深度可分离卷积层，具体过程如下：输入特征先通过层归一化，并分别经过3组深度可分离卷积模块，生成查询Q、键K和值V，其中，深度可分离卷积模块包括1个1×1深度可分离卷积层和1个3×3深度可分离卷积层，将查询Q、键K和值V输入转型函数生成Q^、K^和V^，根据Q^、K^获得当前层的未经过激活函数的自注意力图，并通过残差连接与上一层高效残差自注意力模块输出的未经过激活函数的自注意力图按像素点相加再经过ELU激活函数，得到当前层的经过激活函数的自注意力图，公式如下：；；其中，、/＞和/＞分别为当前层的未经过激活函数的自注意力图、上一层的未经过激活函数的自注意力图以及当前层的经过激活函数的自注意力图；/＞、/＞是可学习的参数；/＞代表ELU激活函数，根据值V^和自注意力图/＞生成自注意力图加权特征/＞，自注意力图加权特征/＞在经过1个1 × 1深度可分离卷积层后，将与高效残差自注意力模块的输入特征/＞按像素点相加，以生成高效残差自注意力模块的输出特征/＞。作为优选，混合Transformer残差模块包括2个高效残差自注意力模块、2个3×3深度可分离卷积层和2个1×1的卷积层，具体操作如下：；；其中，、/＞、/＞和/＞分别表示第1个1×1卷积层、第1个高效残差自注意力模块、第1个1×1深度可分离卷积层、第2个高效残差自注意力模块对应的函数，/＞、/＞和/＞分别表示混合Transformer残差模块的输入、第1个1×1卷积层的输出以及混合Transformer残差模块的输出，/＞表示/＞操作。作为优选，高效细节自注意力模块包括2个多头自注意力模块、2个前馈神经模块和1个1×1卷积层，2个多头自注意力模块中分别通过2组具有非对称核的全连接层展开得到的向量来生成查询Qi、键Ki和值Vi，其中，，将2组内的查询Q交换，并利用Q1K2T与Q2K1T生成两组自注意力图/＞，/＞，进而分别与值V2与V1进行矩阵相乘运算以生成两个聚合特征/＞，分别将两个聚合特征分别输入2个前馈神经模块，得到2个前馈神经模块的输出，并对2个前馈神经模块的输出经过特征折叠后进行/＞操作，得到拼接特征，将拼接特征输入1×1卷积层，得到第二特征/＞，公式如下：；；；；；其中，和/＞分别代表经典Transformer中的多头自注意力模块和前馈神经模块对应的模块；/＞分别表示第一个多头自注意力模块的输出、第二个多头自注意力模块的输出、第一个前馈神经模块的输出、第二个前馈神经模块的输出和第二特征；/＞是一个可学习的参数；/＞表示1×1 卷积层对应的函数；/＞代表Softmax激活函数。作为优选，图像重建模块采用亚像素卷积来进行上采样。作为优选，轻量级红外图像超分辨率模型的操作如下：；；；；其中，表示3×3 卷积层对应的函数，/＞是3×3 卷积层的输出特征，表示轻量级Transformer与CNN骨干对应的函数，/＞是轻量级Transformer与CNN骨干的输出特征，/＞表示高效细节自注意力模块对应的函数，其中n代表高效细节自注意力模块以共享参数的方式循环n次，/＞是高效细节自注意力模块的输出特征，/＞表示图像重建模块对应的函数，/＞和/＞分别表示输入的低分辨率图像和输出的高分辨率图像。第二方面，本发明提供了一种基于自注意力的红外图像超分辨率装置，包括：数据获取模块，被配置为获取待重建的低分辨率红外图像；模型构建模块，被配置为构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型；执行模块，被配置为将待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，经训练的轻量级红外图像超分辨率模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，其中，轻量级Transformer与CNN骨干包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块，具体操作如下：；；其中，和/＞分别表示混合Transformer残差模块与高效残差自注意力模块对应的函数；/＞、/＞和/＞分别表示第一特征、第6个高效残差自注意力模块的输出与轻量级Transformer与CNN骨干的输出；待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过轻量级Transformer与CNN骨干和高效细节自注意力模块，且高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将第一特征和第二特征进行残差连接后输入图像重建模块，输出高分辨率红外图像。第三方面，本发明提供了一种电子设备，包括一个或多个处理器；存储装置，用于存储一个或多个程序，当一个或多个程序被一个或多个处理器执行，使得一个或多个处理器实现如第一方面中任一实现方式描述的方法。第四方面，本发明提供了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如第一方面中任一实现方式描述的方法。相比于现有技术，本发明具有以下有益效果：本发明提出的基于自注意力的红外图像超分辨率方法在使用较少参数量的同时，在主观视觉效果和客观评价指标上与现有的红外图像超分辨率方法相比都取得了更优的结果。本发明提出的基于自注意力的红外图像超分辨率方法中的高效残差自注意力模块通过残差连接来指导头自注意力模块的特征加权，避免多头自注意力模块生成次优自注意力图，从而提取更有价值的全局特征，进而助力生成高质量红外图像。本发明提出的基于自注意力的红外图像超分辨率方法中的高效细节自注意力模块利用基于非对称窗口的自注意力来提取像素级粒度的全局特征，以增强重建红外图像的细节。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简要介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域的普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本申请的一个实施例可以应用于其中的示例性装置架构图；图2为本申请的实施例的基于自注意力的红外图像超分辨率方法的流程示意图；图3为本申请的实施例的基于自注意力的红外图像超分辨率方法的双实体模型计算的流程示意图；图4为本申请的实施例的基于自注意力的红外图像超分辨率方法的高效残差自注意力模块的示意图；图5为本申请的实施例的基于自注意力的红外图像超分辨率方法的混合Transformer残差模块的示意图；图6为本申请的实施例的基于自注意力的红外图像超分辨率方法的轻量级Transformer与CNN骨干的示意图；图7为本申请的实施例的基于自注意力的红外图像超分辨率方法的高效细节自注意力模块的示意图；图8为本申请的实施例的基于自注意力的红外图像超分辨率方法与其它红外图像超分辨率方法的SR图像对比图；图9为本申请的实施例的基于自注意力的红外图像超分辨率装置的示意图；图10是适于用来实现本申请实施例的电子设备的计算机装置的结构示意图。具体实施方式为了使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步地详细描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。图1示出了可以应用本申请实施例的基于自注意力的红外图像超分辨率方法或基于自注意力的红外图像超分辨率装置的示例性装置架构100。如图1所示，装置架构100可以包括终端设备一101、终端设备二102、终端设备三103，网络104和服务器105。网络104用以在终端设备一101、终端设备二102、终端设备三103和服务器105之间提供通信链路的介质。网络104可以包括各种连接类型，例如有线、无线通信链路或者光纤电缆等等。用户可以使用终端设备一101、终端设备二102、终端设备三103通过网络104与服务器105交互，以接收或发送消息等。终端设备一101、终端设备二102、终端设备三103上可以安装有各种应用，例如数据处理类应用、文件处理类应用等。终端设备一101、终端设备二102、终端设备三103可以是硬件，也可以是软件。当终端设备一101、终端设备二102、终端设备三103为硬件时，可以是各种电子设备，包括但不限于智能手机、平板电脑、膝上型便携计算机和台式计算机等等。当终端设备一101、终端设备二102、终端设备三103为软件时，可以安装在上述所列举的电子设备中。其可以实现成多个软件或软件模块，也可以实现成单个软件或软件模块。在此不做具体限定。服务器105可以是提供各种服务的服务器，例如对终端设备一101、终端设备二102、终端设备三103上传的文件或数据进行处理的后台数据处理服务器。后台数据处理服务器可以对获取的文件或数据进行处理，生成处理结果。需要说明的是，本申请实施例所提供的基于自注意力的红外图像超分辨率方法可以由服务器105执行，也可以由终端设备一101、终端设备二102、终端设备三103执行，相应地，基于自注意力的红外图像超分辨率装置可以设置于服务器105中，也可以设置于终端设备一101、终端设备二102、终端设备三103中。应该理解，图1中的终端设备、网络和服务器的数目仅仅是示意性的。根据实现需要，可以具有任意数目的终端设备、网络和服务器。在所处理的数据不需要从远程获取的情况下，上述装置架构可以不包括网络，而只需服务器或终端设备。图2示出了本申请的实施例提供的一种基于自注意力的红外图像超分辨率方法，包括以下步骤：S1，获取待重建的低分辨率红外图像。具体的，可将待重建的低分辨率红外图像作为轻量级红外图像超分辨率模型的输入。S2，构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型。在具体的实施例中，轻量级红外图像超分辨率模型的操作如下：；；；；其中，表示3×3 卷积层对应的函数，/＞是3×3 卷积层的输出特征，表示轻量级Transformer与CNN骨干对应的函数，/＞是轻量级Transformer与CNN骨干的输出特征，/＞表示高效细节自注意力模块对应的函数，其中n代表高效细节自注意力模块以共享参数的方式循环n次，/＞是高效细节自注意力模块的输出特征，/＞表示图像重建模块对应的函数，/＞和/＞分别表示输入的低分辨率图像和输出的高分辨率图像。具体的，参考图3，该轻量级红外图像超分辨率模型的框架中涉及1个3×3 卷积层、1个轻量级Transformer与CNN骨干、1个高效细节自注意力模块和1个图像重建模块。下面将具体介绍每个部分的内容。S3，将待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，经训练的轻量级红外图像超分辨率模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，其中，轻量级Transformer与CNN骨干包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块，具体操作如下：；；其中，和/＞分别表示混合Transformer残差模块与高效残差自注意力模块对应的函数；/＞、/＞和/＞分别表示第一特征、第6个高效残差自注意力模块的输出与轻量级Transformer与CNN骨干的输出；待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过轻量级Transformer与CNN骨干和高效细节自注意力模块，且高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将第一特征和第二特征进行残差连接后输入图像重建模块，输出高分辨率红外图像。在具体的实施例中，高效残差自注意力模块包括1个层归一化、4个1×1深度可分离卷积层和3个3×3深度可分离卷积层，具体过程如下：高效残差自注意力模块接收的特征先通过层归一化，并分别经过3组深度可分离卷积模块，生成查询Q、键K和值V，其中，深度可分离卷积模块包括1个1×1深度可分离卷积层和1个3×3深度可分离卷积层，将查询Q、键K和值V输入转型函数生成Q^、K^和V^，根据Q^、K^获得当前层的未经过激活函数的自注意力图，并通过残差连接与上一层高效残差自注意力模块输出的未经过激活函数的自注意力图按像素点相加再经过ELU激活函数，得到当前层的经过激活函数的自注意力图，公式如下：；；其中，、/＞和/＞分别为当前层的未经过激活函数的自注意力图、上一层的未经过激活函数的自注意力图以及当前层的经过激活函数的自注意力图；/＞、/＞是可学习的参数；/＞代表ELU激活函数，根据值V^和自注意力图/＞生成自注意力图加权特征/＞，自注意力图加权特征/＞在经过1个1 × 1深度可分离卷积层后，将与高效残差自注意力模块的输入特征/＞按像素点相加，以生成高效残差自注意力模块的输出特征/＞。具体的，参考图4，首先构建高效残差自注意力模块，该高效残差自注意力模块的输入除了特征，还包括来及上一层高效残差自注意力模块的未经过激活函数的自注意力图，实现源自上一层高效残差自注意力模块的残差连接。当高效残差自注意力模块接收到特征/＞，依次使特征/＞通过层归一化、1 × 1深度可分离卷积层与3 × 3深度可分离卷积层来生成查询Q、键K和值V/＞。接着，使用转型函数来生成Q^、K^和V^/＞。其中，转型函数是指将二维特征图展开为1维向量的操作。然后，通过利用Q^、K^来获得当前层的未经过激活函数的自注意力图，并通过残差连接与前一层的未经过激活函数的自注意力图按像素点相加再经过ELU激活函数，最终得到当前层经过激活函数的注意力图。在具体的实施例中，混合Transformer残差模块包括2个高效残差自注意力模块、2个3×3深度可分离卷积层和2个1×1的卷积层，具体操作如下：；；其中，、/＞、/＞和/＞分别表示第1个1×1卷积层、第1个高效残差自注意力模块、第1个1×1深度可分离卷积层、第2个高效残差自注意力模块对应的函数，/＞、/＞和/＞分别表示混合Transformer残差模块的输入、第1个1×1卷积层的输出以及混合Transformer残差模块的输出，/＞表示/＞操作。具体的，进一步构建混合Transformer残差模块，参考图5，虚线代表通过残差连接来实现的自注意力图流动。轻量级Transformer与CNN骨干中，将上一个混合Transformer残差模块的输出作为当前混合Transformer残差模块的输入，该输入依次经过第一个3×3卷积层、和第一个高效残差自注意力模块，第一个高效残差自注意力模块的输出与该输入残差连接后输入第一个1×1卷积层，并依次经过第二个3×3卷积层和第二个高效残差自注意力模块，第二个高效残差自注意力模块的输出与该输入和第一个高效残差自注意力模块的输出残差连接后输入第二个1×1卷积层，得到当前混合Transformer残差模块的输出。具体的，参考图6，采用混合Transformer残差模块和高效残差自注意力模块进一步构建轻量级Transformer与CNN骨干，具体包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块。在具体的实施例中，高效细节自注意力模块包括2个多头自注意力模块、2个前馈神经模块和1个1×1卷积层，2个多头自注意力模块中分别通过2组具有非对称核的全连接层展开得到的向量来生成查询Qi、键Ki和值Vi，其中，，/＞，将2组内的查询Q交换，并利用Q1K2T与Q2K1T生成两组自注意力图/＞，/＞，进而分别与值V2与V1进行矩阵相乘运算以生成两个聚合特征/＞，分别将两个聚合特征分别输入2个前馈神经模块，得到2个前馈神经模块的输出，并对2个前馈神经模块的输出经过特征折叠后进行/＞操作，得到拼接特征，将拼接特征输入1×1卷积层，得到第二特征/＞，公式如下：；；；；；其中，和/＞分别代表经典Transformer中的多头自注意力模块和前馈神经模块对应的模块；/＞分别表示第一个多头自注意力模块的输出、第二个多头自注意力模块的输出、第一个前馈神经模块的输出、第二个前馈神经模块的输出和第二特征；/＞是一个可学习的参数；/＞表示1×1 卷积层对应的函数；/＞代表Softmax激活函数。具体的，参考图7，高效细节自注意力模块由2个多头自注意力模块和2个前馈神经模块组成。首先通过2组非对称核展开得到的向量来生成查询Qi、键Ki和值Vi。然后，将2组内的查询Q交换，从而利用Q1K2T与Q2K1T生成两组自注意力图/＞，/＞，进而分别与值V2与V1进行矩阵相乘运算以生成聚合特征/＞。然后这两组特征将被分别输入至两个前馈神经模块。此后，两个前馈神经模块的两个输出将按照与上述展开操作相反的折叠操作来使特征图的形状恢复至输入特征的形状，并通过/＞操作在通道上聚合，最后通过1 × 1卷积恢复至原始通道数，得到第二特征/＞。在具体的实施例中，图像重建模块采用亚像素卷积来进行上采样。具体的，将低分辨率红外图像作为经训练的轻量级红外图像超分辨率模型的输入，得到的输出是一幅/＞维度的高分辨率红外图像，其中，scale为需求的放大倍数。以上步骤S1-S3并不仅仅代表步骤之间的顺序，而是步骤符号表示。下面对本发明实施例进行消融实验A。其中，在消融实验中，在测试一个模块性能时总是保证同组实验内不同实验项目使用的基本模块与网络结构相同，以稳定非实验变量。实验选择的图像重建倍数为4倍。消融实验A，高效残差自注意力模块与高效细节自注意力模块的消融实验。当两个模块均没有使用时，使用基本残差块来进行替代。实验结果如表1所示，可以得出，在使用高效残差自注意力模块、高效细节自注意力模块后，平均峰值信噪比最高，说明模型学习到更有助于图像重建的混合特征，显著增强了超分辨率重建效果。表1将本实施例与其它先进轻量级红外图像SR方法作比较，比较结果如表2所示，在性能与效率的权衡中，本实施例使用较少的参数，却在所有放大因子的SR任务中都获得了最优的峰值信噪比与结构相似度。表2参见图8所示，为本申请的实施例与其它红外图像SR方法的SR图像对比图。由于fusion-A为公开红外图像数据集，因此本申请的实施例在fusion-A上进行主观视觉对比。在“Fused1”的重建图像中，所有重建图像都不同程度的出现了线条扭曲、局部模糊的情况。但是，本申请的实施例很明显较为完整的还原了图像块的整体轮廓与线条走向，这一点优于其他先进方法。进一步的，在“Fused4”的重建图像中，相比其他先进方法的重建图像，本申请的实施例的重建图像拥有更加精准的轮廓以及更少模糊。可见，本申请的实施例提出的一种基于自注意力的红外图像超分辨率方法能够显著减少模型参数量，同时还能获得最优的峰值信噪比与结构相似度，维持一个较高的超分辨率重建效果。进一步参考图9，作为对上述各图所示方法的实现，本申请提供了一种基于自注意力的红外图像超分辨率装置的一个实施例，该装置实施例与图2所示的方法实施例相对应，该装置具体可以应用于各种电子设备中。本申请实施例提供了一种基于自注意力的红外图像超分辨率装置，包括：数据获取模块1，被配置为获取待重建的低分辨率红外图像；模型构建模块2，被配置为构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型；执行模块3，被配置为将待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，经训练的轻量级红外图像超分辨率模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，其中，轻量级Transformer与CNN骨干包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块，具体操作如下：；；其中，和/＞分别表示混合Transformer残差模块与高效残差自注意力模块对应的函数；/＞、/＞和/＞分别表示第一特征、第6个高效残差自注意力模块的输出与轻量级Transformer与CNN骨干的输出；待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过轻量级Transformer与CNN骨干和高效细节自注意力模块，且高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将第一特征和第二特征进行残差连接后输入图像重建模块，输出高分辨率红外图像。下面参考图10，其示出了适于用来实现本申请实施例的电子设备的计算机装置1000的结构示意图。图10示出的电子设备仅仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图10所示，计算机装置1000包括中央处理单元1001和图形处理器1002，其可以根据存储在只读存储器1003中的程序或者从存储部分1009加载到随机访问存储器1004中的程序而执行各种适当的动作和处理。在RAM 1004中，还存储有装置1000操作所需的各种程序和数据。CPU 1001、GPU1002、ROM 1003以及RAM 1004通过总线1005彼此相连。输入/输出接口1006也连接至总线1005。以下部件连接至I/O接口1006：包括键盘、鼠标等的输入部分1007；包括诸如、液晶显示器等以及扬声器等的输出部分1008；包括硬盘等的存储部分1009；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分1010。通信部分1010经由诸如因特网的网络执行通信处理。驱动器1011也可以根据需要连接至I/O接口1006。可拆卸介质1012，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器1011上，以便于从其上读出的计算机程序根据需要被安装入存储部分1009。特别地，根据本公开的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本公开的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分1010从网络上被下载和安装，和/或从可拆卸介质1012被安装。在该计算机程序被中央处理单元1001和图形处理器1002执行时，执行本申请的方法中限定的上述功能。需要说明的是，本申请所述的计算机可读介质可以是计算机可读信号介质或者计算机可读介质或者是上述两者的任意组合。计算机可读介质例如可以是——但不限于——电、磁、光、电磁、红外线或半导体的装置、装置或器件，或者任意以上的组合。计算机可读介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件或者上述的任意合适的组合。在本申请中，计算机可读介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行装置、装置或者器件使用或者与其结合使用。而在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行装置、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、电线、光缆、RF等等，或者上述的任意合适的组合。可以以一种或多种程序设计语言或其组合来编写用于执行本申请的操作的计算机程序代码，所述程序设计语言包括面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，也可以连接到外部计算机。附图中的流程图和框图，图示了按照本申请各种实施例的装置、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段或代码的一部分，该模块、程序段或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的装置来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本申请实施例中所涉及到的模块可以通过软件的方式实现，也可以通过硬件的方式来实现。所描述的模块也可以设置在处理器中。作为另一方面，本申请还提供了一种计算机可读介质，该计算机可读介质可以是上述实施例中描述的电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被该电子设备执行时，使得该电子设备：获取待重建的低分辨率红外图像；构建基于自注意力的轻量级红外图像超分辨率模型并训练，得到经训练的轻量级红外图像超分辨率模型；将待重建的低分辨率红外图像输入经训练的轻量级红外图像超分辨率模型，经训练的轻量级红外图像超分辨率模型包括3×3卷积层、轻量级Transformer与CNN骨干、高效细节自注意力模块和图像重建模块，其中，轻量级Transformer与CNN骨干包括依次连接的6个混合Transformer残差模块和2个高效残差自注意力模块，具体操作如下：；；其中，和/＞分别表示混合Transformer残差模块与高效残差自注意力模块对应的函数；/＞、/＞和/＞分别表示第一特征、第6个高效残差自注意力模块的输出与轻量级Transformer与CNN骨干的输出；待重建的低分辨率红外图像输入3×3卷积层，得到第一特征，再依次经过轻量级Transformer与CNN骨干和高效细节自注意力模块，且高效细节自注意力模块以共享参数的方式循环n次，得到第二特征，将第一特征和第二特征进行残差连接后输入图像重建模块，输出高分辨率红外图像。以上描述仅为本申请的较佳实施例以及对所运用技术原理的说明。本领域技术人员应当理解，本申请中所涉及的发明范围，并不限于上述技术特征的特定组合而成的技术方案，同时也应涵盖在不脱离上述发明构思的情况下，由上述技术特征或其等同特征进行任意组合而形成的其它技术方案。例如上述特征与本申请中公开的具有类似功能的技术特征进行互相替换而形成的技术方案。
