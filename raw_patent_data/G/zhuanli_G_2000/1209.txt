标题title
一种基于水下光强梯度的自主定向方法
摘要abst
本发明涉及一种基于水下光强梯度的自主定向方法，属于水下自主导航领域，首先利用水下图像传感器获取水下光强图像，并结合水平姿态角确定斯涅尔窗口内成像像素；随后利用水平姿态、相机模型及折射定律求解像素对应空间观测矢量及光强梯度矢量；利用观测矢量与光强梯度矢量确定太阳矢量与观测矢量所在平面法线，进而根据几何正交关系求解优化方程，得到太阳矢量估计；最后根据天文年历解算太阳矢量与估计太阳矢量关系，得到载体航向信息。本发明考虑了水下光强场蕴含的空间运动信息，通过光强梯度进行太阳跟踪，为水下航行器的可靠自主导航提供新的解决方案。
权利要求书clms
1.一种基于水下光强梯度的自主定向方法，其特征在于，包括如下步骤：步骤1）、根据水下相机采集得到水下光强图像，并采用高斯滤波器平滑水下光强图像/＞；步骤2）、反演有效的观测矢量：由重力矢量解算载体由载体系/＞到水平坐标系/＞的方向余弦矩阵/＞，确定水下光强图像/＞中位于斯涅尔窗口范围内的像素区域/＞，根据方向余弦矩阵/＞与相机镜头模型/＞，确定像素/＞对应水平坐标系/＞下的观测矢量，并进行折射效应补偿，得到对应的大气中的观测矢量/＞；坐标为/＞的像素表示为像素/＞；步骤3）、反演光强梯度矢量：对步骤1）中的水下光强图像进行折射光强补偿校正，并计算步骤2）中像素/＞处的空间离散梯度/＞，根据像素/＞的坐标到观测矢量/＞的笛卡尔坐标/＞之间的映射关系，计算得到雅克比矩阵/＞，结合载体系/＞到水平坐标系/＞下的方向余弦矩阵/＞，反演步骤2）中的观测矢量/＞对应的大气光强梯度/＞；步骤4）、计算太阳矢量，进行载体定向：根据步骤2）、步骤3），计算多个像素区域/＞中有效像素在大气中对应的观测矢量/＞与大气光强梯度/＞，进一步解算大气光强梯度/＞与观测矢量/＞确定平面的法向量/＞，构成一组法向量量测矩阵/＞；根据太阳矢量/＞与法向量/＞的正交关系，求解矩阵/＞的最小特征值/＞对应的特征向量，得到太阳矢量/＞，上标T表示矩阵的转置；结合天文年历获得导航系/＞下的太阳矢量，求解方向余弦矩阵/＞，获取水下精确航向/＞。2.根据权利要求1所述的一种基于水下光强梯度的自主定向方法，其特征在于，所述步骤2）包括：根据折射定律，确定步骤1）中的水下光强图像中属于斯涅尔窗口的像素区域/＞，任意像素区域/＞内的像素/＞，其对应的水平坐标系/＞下的观测矢量/＞由导航系统的载体系/＞到水平坐标系/＞的方向余弦矩阵/＞与相机镜头模型/＞确定，根据水平坐标系/＞下的观测矢量/＞求解像素/＞对应折射角/＞；对于任意水下光强图像有效的像素，其对应水平坐标系/＞下的观测矢量进行气水界面折射效应补偿，补偿后，大气中对应的观测矢量/＞为：，其中，，/＞为空气折射率，/＞为海水折射率，/＞表示矢量与矢量/＞点积。3.根据权利要求2所述的一种基于水下光强梯度的自主定向方法，其特征在于，所述步骤3）包括：对水下光强图像采用折射定律进行补偿后，计算水下光强图像/＞的空间离散数值梯度/＞；将水下光强图像的空间离散数值梯度/＞映射回水平坐标系/＞中，得到对应观测矢量的光强梯度/＞，满足：，其中，分别为水平坐标系/＞的三个标准正交基，/＞为雅克比矩阵，由相机镜头模型/＞对应的像素/＞到水平坐标系/＞下的观测矢量/＞对应笛卡尔坐标/＞的映射关系计算得到，满足：。4.根据权利要求3所述的一种基于水下光强梯度的自主定向方法，其特征在于，所述步骤4）包括：利用步骤2）解算的观测矢量与步骤3解算的大气光强梯度/＞，构建垂直于太阳矢量/＞、观测矢量/＞及大气光强梯度/＞所在大圆面的法向量/＞，对于一组有效像素，对应法向量表示为矩阵/＞：，其中，为可用像素的数量，太阳矢量/＞为矩阵/＞的最小特征值/＞对应的特征向量；建立水平坐标系下的太阳矢量/＞与天文年历解算导航系/＞下太阳矢量/＞转换关系，得到水下载体精确航向/＞，表示为：，其中，为向量/＞的第/＞个分量，满足/＞，表示/＞的第/＞个分量。
说明书desc
技术领域本发明属于水下自主导航领域，具体涉及一种基于水下光强梯度的自主定向方法。背景技术自主水下航行器在海洋环境监测、资源勘探等方面具有广阔的应用前景。其中，导航系统是保障水下航行器执行任务的关键部件。目前，惯性导航系统已成为水下航行器不可或缺的导航手段，但由于其误差随着时间的推移而积累，需要辅助导航手段来进行纠正。虽然全球导航卫星系统广泛用于与惯性测量单元集成，进行组合导航，但水对卫星信号的屏蔽作用使其无法在水下环境中使用。另一方面，水声定位系统依赖于应答器布放，也限制了其应用范围。地球物理场依赖于现有数据库，对于未知海域和非结构化水下环境可能无法使用。因此，不依赖先验知识的自主导航方法是水下环境的重大挑战。生物能够感知包含强度信息和偏振信息的自然光场进行导航定向。水下仿生偏振导航具有自主性、无误差积累、先验知识独立等优点，可用于水下定向或在水下环境中辅助惯导。水下偏振光场被折射产生的斯涅尔窗分成两部分。论文《Bioinspired polarizationvision enables underwater geolocalization》提出一种基于斯涅尔窗外偏振信息的导航定位方法，通过转动偏振相机采集窗外水平各方向偏振方位角数据，求解载体位置。但斯涅尔窗外的光照较弱，降低了偏振感知精度，从而降低了太阳跟踪性能，而斯涅尔窗内光照充足，常被用于水下太阳跟踪。现有方案中，折射被视为影响水下偏振光场分布的主导因素，而浅水下的散射效应可以忽略不计。然而，随着水深的增加多重散射加剧，打破了理想瑞利散射偏振分布对称性，导致太阳位置估计出现偏差。经水面折射后，大气散射光主要压缩于锥形斯涅尔窗口内，目前水下光场导航应用主要依赖水下斯涅尔窗内偏振信息求解太阳位置与载体姿态。中国专利申请“一种基于天顶点实时跟踪的水下偏振自主航向计算方法”，通过跟踪斯涅尔窗内天顶点处的偏振信息解算载体航向角；中国专利申请“基于水下下行辐射光强和偏振光场的三维航姿确定方法”，通过图像式偏振传感器采集水下斯涅尔窗内观测方向的偏振信息求解航向角。上述方法主要应用于浅水环境，将折射视为主要因素，但随着深度增加，散射效应增强导致偏振分布模式受到影响，与太阳位置关系难以明晰。水下光强场是一种更为直观的光学信息，但目前很少被利用。光强场是一个标量场，其包含的空间信息比偏振场少。但光强场也由太阳光散射形成，可作为太阳跟踪的替代信息源。在天半球面上，光强随着散射角的增大而减小，光强变化最大的方向朝向太阳。因此，如何利用水下光强场的梯度分布，提高太阳位置估计的鲁棒性，为水下航行器的可靠定向提供新的解决方案，是水下航行器自主导航领域的关键问题。发明内容为了解决上述技术问题，本发明提出了一种基于水下光强梯度的自主定向方法，根据载体水平姿态确定斯涅尔窗口成像范围，考虑水下折射效应补偿后，将有效成像范围内的水下光强梯度及观测像素，通过相机模型、载体水平姿态反演至大气环境中。基于天空光强分布与太阳矢量、观测矢量关系，解算得到太阳矢量。利用水下光强的鲁棒性用于提高太阳跟踪精度，进而修正惯导累积误差，提供水下精确航向。为达到上述目的，本发明采用如下技术方案：一种基于水下光强梯度的自主定向方法，包括如下步骤：步骤1）、根据水下相机采集得到水下光强图像，并采用高斯滤波器平滑水下光强图像/＞；步骤2）、反演有效的观测矢量：由重力矢量解算载体由载体系/＞到水平坐标系的方向余弦矩阵/＞，确定水下光强图像/＞中位于斯涅尔窗口范围内的像素区域/＞，根据方向余弦矩阵/＞与相机镜头模型/＞，确定像素/＞对应水平坐标系/＞下的观测矢量/＞，并进行折射效应补偿，得到对应的大气中的观测矢量/＞；坐标为/＞的像素表示为像素/＞；步骤3）、反演光强梯度矢量：对步骤1）中的水下光强图像进行折射光强补偿校正，并计算步骤2）中像素/＞处的空间离散梯度/＞，根据像素的坐标到观测矢量/＞的笛卡尔坐标/＞之间的映射关系，计算得到雅克比矩阵/＞，结合载体系/＞到水平坐标系/＞下的方向余弦矩阵/＞，反演步骤2）中的观测矢量/＞对应的大气光强梯度/＞；步骤4）、计算太阳矢量，进行载体定向：根据步骤2）、步骤3），计算多个像素区域/＞中有效像素在大气中对应的观测矢量/＞与大气光强梯度/＞，进一步解算大气光强梯度/＞与观测矢量/＞确定平面的法向量/＞，构成一组法向量量测矩阵；根据太阳矢量/＞与法向量/＞的正交关系，求解矩阵/＞的最小特征值对应的特征向量，得到太阳矢量/＞，上标T表示矩阵的转置；结合天文年历获得导航系/＞下的太阳矢量，求解方向余弦矩阵/＞，获取水下精确航向/＞。进一步地，所述步骤2）包括：根据折射定律，确定步骤1）中的水下光强图像中属于斯涅尔窗口的像素区域，任意像素区域/＞内的像素/＞，其对应的水平坐标系/＞下的观测矢量/＞由导航系统载体系到水平坐标系的方向余弦矩阵/＞与相机镜头模型确定，根据水平坐标系下的观测矢量/＞求解像素/＞对应折射角/＞；对于任意水下光强图像有效的像素，其对应水平坐标系/＞下的观测矢量/＞进行气水界面折射效应补偿，补偿后，大气中对应的观测矢量/＞为：，其中，，/＞为空气折射率，/＞为海水折射率，/＞表示矢量/＞与矢量/＞点积。进一步地，所述步骤3）包括：对水下光强图像采用折射定律进行补偿后，计算水下光强图像/＞的空间离散数值梯度/＞；将水下光强图像的空间离散数值梯度/＞映射回水平坐标系/＞中，得到对应观测矢量的光强梯度/＞，满足：，其中，分别为水平坐标系/＞的三个标准正交基，/＞为雅克比矩阵，由相机镜头模型/＞对应的像素/＞到水平坐标系/＞下的观测矢量/＞对应笛卡尔坐标/＞的映射关系计算得到，满足：，进一步地，所述步骤4）包括：利用步骤2）解算的大气中的观测矢量与步骤3解算的大气光强梯度，构建垂直于太阳矢量/＞、大气中的观测矢量/＞及大气光强梯度/＞所在大圆面的法向量/＞，对于一组有效像素，对应法向量表示为矩阵/＞：，其中，为可用像素的数量，太阳矢量/＞为矩阵/＞的最小特征值对应的特征向量；建立水平坐标系下的太阳矢量/＞与天文年历解算导航系/＞下太阳矢量/＞转换关系，得到水下载体精确航向/＞，表示为：，其中，为向量/＞的第/＞个分量，满足/＞，表示/＞的第/＞个分量。与现有技术相比，本发明具有以下的有益效果：本发明通过计算梯度将光强标量场转换为矢量场，从而利用光强场中包含的空间信息，具有自主性、无误差积累等优点。通过水下光强梯度方法，避免了水的多次散射对偏振信息求解太阳位置的影响，从而消除了基于偏振信息的太阳跟踪的恒定偏差，提高了太阳动态跟踪的精度和鲁棒性。附图说明图1为一种基于水下光强梯度的自主定向方法的流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整的描述，显然，所描述的实施例仅为本发明的一部分实施例，而不是全部的实施例，基于本发明中的实施例，本领域的普通技术人员在不付出创造性劳动的前提下所获得的所有其他实施例，都属于本发明的保护范围。根据本发明的一个实施例，如图1所示，本发明的一种基于水下光强梯度的自主定向方法，具体实现步骤为：步骤1、根据水下相机采集得到水下光强图像，并采用高斯滤波器平滑图像。步骤2、根据折射定律，确定步骤1中的水下光强图像中属于斯涅尔窗口的像素范围/＞，满足：，其中，为水下光强图像的像素/＞对应观测矢量折射角，为空气折射率，/＞为海水折射率；水下光强图像的像素对应水平坐标系下观测矢量/＞，由导航系统载体系/＞系到水平坐标系/＞系的方向余弦矩阵/＞与相机镜头模型/＞确定，满足：，其中为像素/＞由相机镜头模型/＞反演的观测方向，方向余弦矩阵/＞为：，其中，上标T表示矩阵的转置；对应横滚角/＞，俯仰角/＞，由重力矢量解算得到，满足：，其中，系下重力矢量为/＞，/＞系下重力矢量为/＞，由加速度计比力测量/＞近似得到。像素对应折射角/＞为：，其中，表示/＞的第/＞个分量。进一步，对于任意水下光强图像有效像素，其对应水平坐标系下观测矢量/＞进行气水界面折射效应补偿，补偿后观测矢量/＞为：，其中，，/＞为空气折射率，/＞为海水折射率，/＞表示矢量/＞与矢量/＞点积。步骤3、对水下光强图像采用折射定律进行补偿后，计算水下光强图像/＞的空间离散数值梯度/＞：，其中， 为偏导数算子。进一步，将水下光强图像的空间离散数值梯度映射回水平坐标系系中，得到对应观测矢量的光强梯度/＞，满足：，其中，分别为水平坐标系/＞系的三个标准正交基，/＞为雅克比矩阵，由相机镜头模型/＞对应的像素/＞到水平坐标系下观测矢量/＞对应笛卡尔坐标/＞的映射关系计算得到，满足：，步骤4、利用步骤2解算的任意水下光强图像有效像素对应折射补偿后的观测矢量/＞与步骤3解算的对应观测矢量的大气光强梯度/＞，可构建垂直于太阳矢量/＞、观测矢量/＞及光强梯度/＞所在大圆面的法向量/＞，对于一组有效像素，对应法向量表示为矩阵/＞：，其中，为可用像素的数量，/＞系中太阳矢量/＞可以通过最小化偏差进行最优估计：，其中，为关于太阳矢量与拉格朗日乘子的优化函数，/＞为拉格朗日乘子，/＞为/＞的范数，/＞可得：，太阳矢量为矩阵/＞的最小特征值/＞对应的特征向量。建立系下太阳矢量/＞与天文年历，解算/＞系下太阳矢量/＞的转换关系：，其中，为导航系/＞系到水平坐标系/＞系的方向余弦矩阵，表示如下：，根据上述关系，最终可得水下载体精确航向，表示为：，其中，为向量/＞的第/＞个分量，满足/＞，表示/＞的第/＞个分量。尽管上面对本发明说明性的具体实施方式进行了描述，以便于本技术领域的技术人员理解本发明，且应该清楚，本发明不限于具体实施方式的范围，对本技术领域的普通技术人员来讲，只要各种变化在所附的权利要求限定和确定的本发明的精神和范围内，这些变化是显而易见的，一切利用本发明构思的发明创造均在保护之列。
