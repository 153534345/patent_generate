标题title
一种隐私保护的税务和电力数据联合分析系统
摘要abst
本发明提出一种隐私保护的税务和电力数据联合分析系统，属于数据分析技术领域。包括：税务数据持有模块、电力数据持有模块、数据ID匹配模块和税点指标计算模块；所述税务数据持有模块和所述电力数据持有模块分别与数据ID匹配模块连接，所述数据ID匹配模块与税点指标计算模块连接；税务数据持有模块用于发起税电指标计算的请求；电力数据持有模块发起税电指标计算的请求；数据ID匹配模块用于将税务数据ID与电力数据ID进行匹配；税点指标计算模块用于计算税点指标。解决联合分析场景中隐私数据泄露的问题；本发明在双方原始数据均不出本地的前提下，仅通过交换加密后的数据，完成税务电力数据联合分析，得到税电指标公式的计算结果。
权利要求书clms
1.一种隐私保护的税务和电力数据联合分析系统，其特征在于，包括税务数据持有模块、电力数据持有模块、数据ID匹配模块和税点指标计算模块；所述税务数据持有模块和所述电力数据持有模块分别与数据ID匹配模块连接，所述数据ID匹配模块与税点指标计算模块连接；所述税务数据持有模块用于发起税电指标计算的请求；所述电力数据持有模块发起税电指标计算的请求；所述数据ID匹配模块用于将税务数据ID与电力数据ID进行匹配；所述税点指标计算模块用于计算税点指标。2.一种隐私保护的税务和电力数据联合分析方法，其特征在于，包括以下步骤：S1.税务数据持有方A和电力数据持有方B发起税电指标计算的请求；S2.利用隐私集合求交操作将税务数据ID与电力数据ID进行匹配；S3.利用同态加密方式或秘密分享方式计算税电指标；S4.输出税电指标计算结果。3.根据权利要求2所述的一种隐私保护的税务和电力数据联合分析方法，其特征在于，同态加密方式计算税电指标：税务数据持有方A初始化密钥：税务数据持有方A和电力数据持有方B是项目中的数据交互参与方，双方在税电指标计算前，由税务数据持有方A初始化公钥和私钥，并将公钥分发给电力数据持有方B；税务数据持有方A计算加密中间结果，传输给电力数据持有方B：税务数据持有方A根据税电指标的计算公式，使用自身数据计算指标所需的中间结果，并使用公钥进行加密，将所需指标的计算公式、加密的中间结果以及需要参与计算的电力数据持有方B数据目录传输至电力数据持有方B；税电指标的计算公式：；；式中，a为本月增值税收入；b为上月增值税收入；c为本月供电局电力消费量；d为上月供电局电力消费量；e为企业税收；f为企业实际用电量；g为企业污染当量；电力数据持有方B通过授权审核机制，确定授权数据：电力数据持有方B根据税务数据持有方A传输的需要参与计算的电力数据持有方B数据目录，通过授权审核机制，审核并授权数据目录中的数据用于税电指标的计算；电力数据持有方B执行税电指标计算，传输给税务数据持有方A：完成授权后，电力数据持有方B使用授权数据，根据税务数据持有方A传输的税电指标计算公式以及加密中间结果，在本地执行税电指标计算，得到加密的税电指标计算结果，并传回税务数据持有方A；税务数据持有方A解密加密结果：税务数据持有方A获取加密的税电指标计算结果后，使用私钥进行解密后，得到税电指标数值。4.根据权利要求3所述的一种隐私保护的税务和电力数据联合分析方法，其特征在于，秘密分享方式计算税电指标：税务数据持有方A和电力数据持有方B是项目中的数据交互参与方，双方在税电指标计算前，双方根据数据ID取出参与税电指标运算数据，并将数据按照既定算法分割为若干分片，并分发给参与方；电力数据持有方B通过授权审核机制，确定授权数据：电力数据持有方B根据税务数据持有方A传输的需要参与计算的电力数据持有方B数据目录，通过授权审核机制，审核并授权数据目录中的数据用于税电指标的计算；电力数据持有方B执行税电指标公式计算，最终结果将传输给税务数据持有方A。5.根据权利要求2所述的一种隐私保护的税务和电力数据联合分析方法，其特征在于，输出税电指标计算结果的方法是：税务数据持有方A获取加密的税电指标计算结果后，使用私钥进行解密或者恢复税电指标计算结果后，得到税电指标数值。6.一种电子设备，其特征在于，包括存储器和处理器，存储器存储有计算机程序，所述的处理器执行所述计算机程序时实现权利要求2-5任一项所述的一种隐私保护的税务和电力数据联合分析方法的步骤。7.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求2-5任一项所述的一种隐私保护的税务和电力数据联合分析方法。
说明书desc
技术领域本发明涉及税务和电力数据联合分析系统，尤其涉及一种隐私保护的税务和电力数据联合分析系统，属于数据分析技术领域。背景技术税收数据和电力数据在宏观上能有效反映经济运行现状及变动趋势，在微观上能够反映社会主体经营状况，在服务经济分析、精准施政等方面，具备覆盖面广、数据质量好、采集频率高、颗粒度细等特点。税务和电力两类数据在行业分类与国民经济统计标准方面一致性较高，具备较好的数据融合条件。可以更准确、更全面的反映宏观经济运行态势和市场主体生产经营状况。传统模式下的数据共享联合分析，往往采用数据拷贝、明文信息交换、调用API接口、数据脱敏建模或直接调用税电指标等方式来实现，这必然存在个人隐私泄露、数据失真、数据不合规使用等问题，这会直接导致数据无法获取，项目无法实施。在传统的数据共享联合分析中，为确保数据安全，会对数据进行脱敏处理再用于数据分析，而数据脱敏本身就是对某些敏感信息按照脱敏规则实现的数据修改和变形，这样会降低数据的整体价值。往往脱敏后的数据亦不能支撑新的分析场景，没有被再次利用的价值。而对于区间数据和结果数据共享方式也存在类似问题，因为数据的价值与数据维度有着密切的关系，数据维度越多价值越高，同理数据维度减少数据的价值也会随之降低。区间共享和结果共享均会不同程度的降低数据维度，损失数据的整体价值。税务与电力的联合分析场景中，数据分别分布于不同的部门/公司中，税务部门和电力公司都持有各自的数据，处于各项因素考虑，双方都不愿意将持有的数据分享给另一方进行业务指标的计算。为解决上述技术问题，有研究人员提出了一种税电指标计算方法及装置，公开号为CN114331658A，该方法基于税电指标计算公式，确定计算目标税电指标所需的目标税务方数据，并基于目标税务方数据计算出计算目标税电指标所需的中间结果，以及对中间结果进行加密处理；将税电指标计算公式，加密后的中间结果和计算目标税电指标所需的电力方数据目录发送给电力方，以使得电力方基于电力方数据目录确定计算目标税电指标所需的目标电力方数据，并基于税电指标计算公式，加密后的中间结果和目标电力方数据计算出目标税电指标，以及对目标税电指标进行加密处理；接收电力方发送的加密后的目标税电指标，并进行解密处理，得到目标税电指标。该方案中仅使用同态加密技术方案，在面临大量数据，例如：10万条以上级别的时候，其计算的内存消耗很可能超出实际系统的可成熟范围，同时计算时间将大大增加，从而导致系统在实际中不可用。该方案中涉及到税电指标ID的选取流程，未使用任何隐私保护方案，可能会导致潜在的隐私泄漏风险。发明内容在下文中给出了关于本发明的简要概述，以便提供关于本发明的某些方面的基本理解。应当理解，这个概述并不是关于本发明的穷举性概述。它并不是意图确定本发明的关键或重要部分，也不是意图限定本发明的范围。其目的仅仅是以简化的形式给出某些概念，以此作为稍后论述的更详细描述的前序。鉴于此，为解决现有技术中存在联合分析场景中隐私数据泄露的技术问题，本发明提供一种隐私保护的税务和电力数据联合分析系统。方案一、一种隐私保护的税务和电力数据联合分析系统，包括税务数据持有模块、电力数据持有模块、数据ID匹配模块和税点指标计算模块；所述税务数据持有模块和所述电力数据持有模块分别与数据ID匹配模块连接，所述数据ID匹配模块与税点指标计算模块连接；所述税务数据持有模块用于发起税电指标计算的请求；所述电力数据持有模块发起税电指标计算的请求；所述数据ID匹配模块用于将税务数据ID与电力数据ID进行匹配；所述税点指标计算模块用于计算税点指标。方案二、一种隐私保护的税务和电力数据联合分析方法，包括以下步骤：S1.税务数据持有方A和电力数据持有方B发起税电指标计算的请求；S2.利用隐私集合求交操作将税务数据ID与电力数据ID进行匹配；S3.利用同态加密方式或秘密分享方式计算税电指标；S4.输出税电指标计算结果。优选的，同态加密方式计算税电指标：税务数据持有方A初始化密钥：税务数据持有方A和电力数据持有方B是项目中的数据交互参与方，双方在税电指标计算前，由税务数据持有方A初始化公钥和私钥，并将公钥分发给电力数据持有方B；税务数据持有方A计算加密中间结果，传输给电力数据持有方B：税务数据持有方A根据税电指标的计算公式，使用自身数据计算指标所需的中间结果，并使用公钥进行加密，将所需指标的计算公式、加密的中间结果以及需要参与计算的电力数据持有方B数据目录传输至电力数据持有方B；税电指标的计算公式：；；式中，a为本月增值税收入；b为上月增值税收入；c为本月供电局电力消费量；d为上月供电局电力消费量；e为企业税收；f为企业实际用电量；g为企业污染当量；电力数据持有方B通过授权审核机制，确定授权数据：电力数据持有方B根据税务数据持有方A传输的需要参与计算的电力数据持有方B数据目录，通过授权审核机制，审核并授权数据目录中的数据用于税电指标的计算；电力数据持有方B执行税电指标计算，传输给税务数据持有方A：完成授权后，电力数据持有方B使用授权数据，根据税务数据持有方A传输的税电指标计算公式以及加密中间结果，在本地执行税电指标计算，得到加密的税电指标计算结果，并传回税务数据持有方A；税务数据持有方A解密加密结果：税务数据持有方A获取加密的税电指标计算结果后，使用私钥进行解密后，得到税电指标数值。优选的，秘密分享方式计算税电指标：税务数据持有方A和电力数据持有方B是项目中的数据交互参与方，双方在税电指标计算前，双方根据数据ID取出参与税电指标运算数据，并将数据按照既定算法分割为若干分片，并分发给参与方；电力数据持有方B通过授权审核机制，确定授权数据：电力数据持有方B根据税务数据持有方A传输的需要参与计算的电力数据持有方B数据目录，通过授权审核机制，审核并授权数据目录中的数据用于税电指标的计算；电力数据持有方B执行税电指标公式计算，最终结果将传输给税务数据持有方A。优选的，输出税电指标计算结果的方法是：税务数据持有方A获取加密的税电指标计算结果后，使用私钥进行解密或者恢复税电指标计算结果后，得到税电指标数值。方案三、一种电子设备，包括存储器和处理器，存储器存储有计算机程序，所述的处理器执行所述计算机程序时实现方案一所述的一种隐私保护的税务和电力数据联合分析方法的步骤。方案四、一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现方案一所述的一种隐私保护的税务和电力数据联合分析方法。本发明的有益效果如下：本发明应用于税务与电力的联合分析流程支持两个参与方进行运算，两个参与方分别为税务数据持有方和电力数据持有方，税务数据持有方同时作为数据持有方和结果需求方，电力数据持有方作为数据持有方，由于税电指标的计算结果为税务数据持有方业务所需，所以电力数据持有方只需要配合税电指标的运算，而不需要得知具体的计算结果。每个参与方都需要税电指标联合分析系统，可以在双方原始数据均不出本地的前提下，仅通过交换加密后的数据，完成税务电力数据联合分析，得到税电指标公式的计算结果。附图说明此处所说明的附图用来提供对本发明的进一步理解，构成本发明的一部分，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。在附图中：图1为一种隐私保护的税务和电力数据联合分析系统结构示意图；图2为一种隐私保护的税务和电力数据联合分析方法流程示意图；图3为税务数据持有方A向电力数据持有方B传输中间结果和指标计算信息的流程示意图；图4为电力数据持有方B通过授权审核机制，确定授权数据的流程示意图；图5为电力数据持有方B计算加密指标结果，回传税务数据持有方A的流程示意图；图6为税务数据持有方A解密加密结果的流程示意图。具体实施方式为了使本发明实施例中的技术方案及优点更加清楚明白，以下结合附图对本发明的示例性实施例进行进一步详细的说明，显然，所描述的实施例仅是本发明的一部分实施例，而不是所有实施例的穷举。需要说明的是，在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。实施例1：参照图1说明本实施方式，一种隐私保护的税务和电力数据联合分析系统，包括税务数据持有模块、电力数据持有模块、数据ID匹配模块和税点指标计算模块；所述税务数据持有模块和所述电力数据持有模块分别与数据ID匹配模块连接，所述数据ID匹配模块与税点指标计算模块连接；所述税务数据持有模块用于发起税电指标计算的请求；所述电力数据持有模块发起税电指标计算的请求；所述数据ID匹配模块用于将税务数据ID与电力数据ID进行匹配；所述税点指标计算模块用于计算税点指标。实施例2：参照图2-图6说明本实施方式，一种隐私保护的税务和电力数据联合分析方法，包括以下步骤：S1.税务数据持有方A和电力数据持有方B发起税电指标计算的请求；具体的，税务数据持有方同时作为数据持有方和结果需求方，电力数据持有方作为数据持有方，由于税电指标的计算结果为税务数据持有方业务所需，所以电力数据持有方只需要配合税电指标的运算，而不需要得知具体的计算结果。S2.利用隐私集合求交操作将税务数据ID与电力数据ID进行匹配；对税务、电力双方持有的有重合的数据集合，以公钥密码算法或OT等技术构建双方数据ID交集计算的安全协议，计算数据ID交集；协议完成后，任何一方除共有数据ID交集外，不能获取任何其他信息；尤其包含双方位于数据ID交集外的任何其他数据ID信息；具体步骤为：S21.税务、电力双方各初始化一个密钥用于公钥加密；S22.税务、电力使用各自持有的密钥加密自己持有的数据ID列表；S23.税务、电力交换各自加密过后的数据ID列表；S24.税务、电力再使用自己持有的密钥再次加密交换后的数据ID列表；S3.利用同态加密方式或秘密分享方式计算税电指标；同态加密方式计算税电指标：税务数据持有方A初始化密钥：税务数据持有方A和电力数据持有方B是项目中的数据交互参与方，双方在税电指标计算前，由税务数据持有方A初始化公钥和私钥，并将公钥分发给电力数据持有方B；税务数据持有方A计算加密中间结果，传输给电力数据持有方B：税务数据持有方A根据税电指标的计算公式，使用自身数据计算指标所需的中间结果，并使用公钥进行加密，将所需指标的计算公式、加密的中间结果以及需要参与计算的电力数据持有方B数据目录传输至电力数据持有方B；具体的，参与方仅共享各自数据资源目录，即原数据，而不共享具体的数据本身，不会导致数据隐私泄漏；税电指标的计算公式：；；式中，a为本月增值税收入；b为上月增值税收入；c为本月供电局电力消费量；d为上月供电局电力消费量；e为企业税收；f为企业实际用电量；g为企业污染当量；税务数据持有方A持有e，税务数据持有方A持有f、g，首先计算e/f 以及 e/g，在计算机运算中除法运算会转换为乘法运算，即乘分母的倒数，也就是e乘1/f 以及 e乘1/g；S31.税务数据持有方A将同态加密的公钥、经过同态加密的e发送给电力方；S32.电力数据持有方B使用同态加密乘法计算e乘1/f 以及 e乘1/g，结果是密文，对电力方不可见；S33.电力数据持有方B使用S32的计算结果，使用同态加密乘法计算e乘1/f 乘0.5以及 e乘1/g 乘0.5，结果是密文，对电力方不可见；S34.使用S33计算结果，使用同态加密加法计算 ，结果是密文，对电力方不可见；S35.电力数据持有方B将计算结果，传送至税务数据持有方A；S36.税务数据持有方A使用私钥对结果进行解密，得到最终指标的明文结果；电力数据持有方B通过授权审核机制，确定授权数据：电力数据持有方B根据税务数据持有方A传输的需要参与计算的电力数据持有方B数据目录，通过授权审核机制，审核并授权数据目录中的数据用于税电指标的计算；具体的，参与方确定指标审核的通用规则，即以规则的方式明确哪种税电指标是可以通过审核调用数据运算的；具体的，授权审核机制为：发起方将税电指标计算公式中字母代表的数据字段传送至电力方界面；电力方管理员判断指标的计算公式以及参与计算的数据字段是否存在数据泄露的风险、是否符合业务实际需求，若符合则审核通过；若不符合审核不通过；电力数据持有方B执行税电指标计算，传输给税务数据持有方A：完成授权后，电力数据持有方B使用授权数据，根据税务数据持有方A传输的税电指标计算公式以及加密中间结果，在本地执行税电指标计算，得到加密的税电指标计算结果，并传回税务数据持有方A；税务数据持有方A解密加密结果：税务数据持有方A获取加密的税电指标计算结果后，使用私钥进行解密后，得到税电指标数值。秘密分享方式计算税电指标：税务数据持有方A和电力数据持有方B是项目中的数据交互参与方，双方在税电指标计算前，双方根据数据ID取出参与税电指标运算数据，并将数据按照既定算法分割为若干分片，并分发给参与方；秘密分享方式主要思想将一个数随机的分裂为两个或多个数，分裂后的数分属不同的计算方，各计算方即可根据这些分享的数据展开隐私保护下的算术计算；加法运算：假定税务、电力方各有数x和y，其中将x和y进行分解，x = x1 + x2、y = y1 + y2；双方各自分享x2和y1，税务方将x2分享给电力方，电力方将y1分享给税务方，则税务方计算z1 = x1+ y1，电力方计算z2 = x2 + y2；电力将z2共享给税务方，显然有：z = x + y = z1 + z2 = x1 + x2 + y1 + y2，税务方可以计算出z，也就是x、y之和；乘法运算：税务方和电力方分别持有x和y，他们得到了一对随机乘法三元组的分片；其中a = 1 + 2、b = 1 + 2、ab = a*b = 1 + 2；采用如下方法计算x、y的乘积：税务方和电力方各自将己方数据分享一个分片给对方，交换2和1；税务方和电力方各自通过加法分享并还原，分别得到x的盲化d = x - a ，y的盲化 e = y - b，并把d和e公开给对方；在此过程中, x, y, a, b均没有泄露；此时，x*y=*=de+d+e+，处于分享态的三元组放在了中括号内，可以看出问题已被转化为加法问题。由电力方计算对应部分之后将结果发送给税务方，税务方代入本步骤x*y公式后，即可得到乘法结果。电力数据持有方B通过授权审核机制，确定授权数据：电力数据持有方B根据税务数据持有方A传输的需要参与计算的电力数据持有方B数据目录，通过授权审核机制，审核并授权数据目录中的数据用于税电指标的计算；电力数据持有方B执行税电指标公式计算，最终结果将传输给税务数据持有方A。S4.输出税电指标计算结果；税务数据持有方A获取加密的税电指标计算结果后，使用私钥进行解密或者恢复税电指标计算结果后，得到税电指标数值。本发明提到的术语定义：税电指标：税电指标是将企业税收、销售数据和用电数据结合起来，经过指标测算得出；税电联合分析：税电联合分析是创新运用税收和电力大数据构建的一种经济运行分析，通过对企业在购买、生产及销售环节活动中微观数据的整合加工，形成一系列穿透性强、覆盖面广的微观观和宏观指标；本发明适用于隐私保护的税务与电力联合分析这一典型场景，所有参与方所拥有的数据将不会传输出本地，但是参与方可以根据税电指标计算公式计算出最终的结果，该计算结果对于税务数据持有方可见，而指标的计算逻辑和计算公式对所有参与方可见，并且需要经过电力数据持有方的审核同意之后，才可进行计算；本发明电力数据持有方和税务数据持有方在进行税电指标的计算之前，还需要使用隐私集合求交技术筛选出参与本次税电指标计算的数据，相比于现有其他方法，该技术的引入可以令本发明在筛选数据的时候保护未参与指标计算的数据ID不泄漏；本发明方案提供同态加密和秘密分享两种技术路线完成税电指标的计算，无论何种技术路线，都可以保证参与方的隐私数据不泄漏。同态加密技术路线提供更强的计算安全性和更简单的计算流程，而秘密分享技术路线可以提供对更多参与方的兼容能力和更快的计算速度。本发明指标的计算逻辑和计算公式对所有参与方可见，并且需要经过电力数据持有方的审核同意之后，才可进行计算，这样保证了计算指标的安全性是收到参与方认可的。实施例3：本发明的计算机装置可以是包括有处理器以及存储器等装置，例如包含中央处理器的单片机等。并且，处理器用于执行存储器中存储的计算机程序时实现上述的一种隐私保护的税务和电力数据联合分析方法的步骤。所称处理器可以是中央处理单元，还可以是其他通用处理器、数字信号处理器 、专用集成电路、现成可编程门阵列  或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。所述存储器可主要包括存储程序区和存储数据区，其中，存储程序区可存储操作系统、至少一个功能所需的应用程序等；存储数据区可存储根据手机的使用所创建的数据等。此外，存储器可以包括高速随机存取存储器，还可以包括非易失性存储器，例如硬盘、内存、插接式硬盘，智能存储卡，安全数字卡，闪存卡、至少一个磁盘存储器件、闪存器件、或其他易失性固态存储器件。实施例4：计算机可读存储介质实施例。本发明的计算机可读存储介质可以是被计算机装置的处理器所读取的任何形式的存储介质，包括但不限于非易失性存储器、易失性存储器、铁电存储器等，计算机可读存储介质上存储有计算机程序，当计算机装置的处理器读取并执行存储器中所存储的计算机程序时，可以实现上述的一种隐私保护的税务和电力数据联合分析方法的步骤。所述计算机程序包括计算机程序代码，所述计算机程序代码可以为源代码形式、对象代码形式、可执行文件或某些中间形式等。所述计算机可读介质可以包括：能够携带所述计算机程序代码的任何实体或装置、记录介质、U盘、移动硬盘、磁碟、光盘、计算机存储器、只读存储器、随机存取存储器、电载波信号、电信信号以及软件分发介质等。需要说明的是，所述计算机可读介质包含的内容可以根据司法管辖区内立法和专利实践的要求进行适当的增减，例如在某些司法管辖区，根据立法和专利实践，计算机可读介质不包括电载波信号和电信信号。尽管根据有限数量的实施例描述了本发明，但是受益于上面的描述，本技术领域内的技术人员明白，在由此描述的本发明的范围内，可以设想其它实施例。此外，应当注意，本说明书中使用的语言主要是为了可读性和教导的目的而选择的，而不是为了解释或者限定本发明的主题而选择的。因此，在不偏离所附权利要求书的范围和精神的情况下，对于本技术领域的普通技术人员来说许多修改和变更都是显而易见的。对于本发明的范围，对本发明所做的公开是说明性的，而非限制性的，本发明的范围由所附权利要求书限定。
