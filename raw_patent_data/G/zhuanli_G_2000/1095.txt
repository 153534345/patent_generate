标题title
大场景三维模型数据的高效、批量属性挂接方法及系统
摘要abst
发明公开了一种大场景三维模型数据的高效、批量属性挂接方法，S1获取二维和各三维模型的基础数据；S2将各所述三维模型数据与对应所述二维的GeoJSON数据进行比对、统一；S3将所述二维的GeoJSON数据作为所述三维模型的基准数据，采用特征点匹配法进行多源三维数据空间配准；S4将步骤S3中空间配准后的数据加载到可视化前端,获取可视化前端的目标点P坐标及高程值；S5将所述步骤S4中的目标点P坐标及高程值带入二维GeoJSON筛选经纬度所处面，查找符合的高程匹配对象，若符合，得到目标点P的三维模型批量属性，否则重新获取目标点P坐标及高程值，重复步骤S5。本发明实现了大场景下，海量、多源、异构的三维数据的属性挂接。
权利要求书clms
1.一种大场景三维模型数据的高效、批量属性挂接方法，其特征在于：包括如下步骤：步骤S1：获取二维和三维模型的基础数据；步骤S2：将各所述三维模型数据与对应所述二维的GeoJSON数据进行比对、统一；步骤S3：将所述二维的GeoJSON数据作为所述三维模型的基准数据，采用特征点匹配法进行多源三维数据空间配准；步骤S4:将步骤S3中空间配准后的数据加载到可视化前端,获取可视化前端的目标点P坐标及高程值；步骤S5:将所述步骤S4中的目标点P坐标及高程值带入二维GeoJSON筛选经纬度所处面，查找符合的高程匹配对象，若符合，得到目标点P的三维模型批量属性，否则重新获取目标点P坐标及高程值，重复步骤S5。2.根据权利权利1所述的大场景三维模型数据的批量属性挂接方法，其特征在于，还包括：步骤S6：通过可视化前端视角中心点Q、目标点P创建唯一射线X，通过射线X与三维模型的空间位置关系，对所述目标点P所在三维空间位置的属性挂接进行空间位置校验，若相交，返回属性数据；否，则不返回属性数据。3.根据权利权利2所述的大场景三维模型数据的批量属性挂接方法，其特征在于，所述步骤S6：对所述目标点P所在三维空间位置的属性挂接进行空间位置校验，具体方法如下：S6001：目标点P确定后，获取当前可视化前端视觉相机范围，并计算相机中心点Q；S6002：连接目标点P与所述相机中心点Q点，创建唯一射线X，并以PQ方向为射线方向，无限延伸；S6003：通过获取到唯一GeoJSON面，以各顶点为节点；以每个节点属性altitude为高度；拉高GeoJSON面，模拟出三维模型体；并以当前DEM高程值，赋予三维模型体高程；S6004：通过射线X与所述S6003拉伸的模型体进行空间位置判断，若相交，则返回客户端的GeoJSON面正确；反之，则返回面数据不正确或误差较大，需要调整相机视角，重新获取目标点P。4.根据权利要求1所述的大场景三维模型数据的高效、批量属性挂接方法，其特征在于：所述步骤S2，具体包括：S2001：对二维的GeoJSON数据与三维模型数据的空间位置比对，若各类数据坐标系不统一，通过坐标系转换，统一坐标系；S2002：检查各三维模型完整性、三维模型比例，若各三维模型比例不一致，对三维模型进行调整；S2003：检查各三维模型数据的数据格式，确保各类三维模型数据能在同一场景下加载；S2004：检查各三维模型的数据精度；S2005：检查二维的GeoJSON数据属性字段，若二维数据的空间位置或属性字段有误，需立即调整数据的空间位置及二维数据的相关属性字段。5.根据权利要求1或4所述的大场景三维模型数据的高效、批量属性挂接方法，其特征在于：步骤S2：将各所述三维模型数据与对应的所述二维的GeoJSON数据进行比对、统一，还包括：对所述三维模型数据的数据精度进行限制。6.根据权利要求1所述的大场景三维模型数据的高效、批量属性挂接方法，其特征在于：步骤S3：将所述二维的GeoJSON数据作为所述三维模型的基准数据，采用特征点匹配法进行多源三维数据空间配准，具体包括：S3001：计算出GeoJSON数据的最大外接矩形，其中，基准数据范围表示一个矩形范围，包括四个值，分别为最小x值xmin、最小y值ymin、最大x值xmax，最大y值ymax，确保模型配准过程在此范围中进行；S3002：选取各三维模型上的同名控制点作为第一特征点；采用以下二次曲面拟合方程和特征点曲率方程，从三维模型的多个瓦片中提取出特征点突出、模型纹理特征强的中心点，作为各三维模型的第二特征点；N＝a1x2+a2y2+a3z2+a3xy+a4xz+a5yz+a6x+a7y+a8z+a9式中a1，a2，a3，a4，a5，a6、a7、a8、a9是曲面拟合参数，通常采用最小二乘法来求解参数，x、y、z分别为三维模型上某点在空间中的经纬度坐标及高程；该特征点曲率方程，通过曲率M的值来选择具有强特征的瓦片中心点；S3003：先对所述三维模型的第一特征点和所述三维模型的第二特征点进行两次特征点匹配，第一次匹配，根据所述GeoJSON数据的最大外接矩形剔除三维模型与地形环境以及其他模型中多余的瓦片数据或采集质量不高的数据以及控制范围外的瓦片数据，然后将第一特征点进行同名点匹配；第二次匹配，将三维模型的第二特征点与地形环境和高精度影像进行对应；最后，基于这种对应关系，对三维模型和地形环境进行空间配准，获得三维模型和地形环境的配准参数；S3004：根据每个三维模型获得的配准参数，调整三维模型安置的配置文件，保证三维模型在大场景加载下，与原有地理环境和地形位置方位协调，最大程度的还原真实场景。7.根据权利要求1所述的大场景三维模型数据的高效、批量属性挂接方法，其特征在于：所述步骤S4：将步骤S3中空间配准后的数据加载到可视化前端,获取可视化前端的目标点P坐标及高程值，包括：S4001：将空间配准后的DEM数据、卫星影像数据、GeoJSON矢量数据、三维模型数据依次加载到可视化前端；S4002：加载之后，可视化前端随机获取目标点P坐标及高程值，高程值点将作为属性挂接的目标点进行三维模型的空间位置属性实时挂接。8.根据权利要求7所述的大场景三维模型数据的高效、批量属性挂接方法，其特征在于：所述S4001：将空间配准后的DEM数据、卫星影像数据、GeoJSON矢量数据、三维模型数据依次加载到可视化前端，还包括：GeoJSON矢量数据加载完成之后，可将GeoJSON的数据样式调整成透明。9.根据权利要求1所述的大场景三维模型数据的高效、批量属性挂接方法，其特征在于：所述步骤S5，具体包括：S5001：经纬度筛选，将所述步骤S4中目标点P直接投影到地面，通过空间叠加分析，筛选出包含此坐标点的GeoJSON面数据，若只有一个GeoJSON面，将唯一GeoJSON面数据返回可视化前端；若有多个GeoJSON面，通过数组的形式返回可视化前端，再进行以下高程匹配；S5002：高程匹配，将所述步骤S4中高程值减去目标点P点所处的地形高度，得到目标高程值H；H＝Pz-DH其中PZ表示目标点P的高程值，DH表示目标点P的地形高度；将获取的目标高程值H与所述S5001中GeoJSON面数据集合进行altitude属性匹配，将符合目标高程值H属性区间的唯一GeoJSON面数据返回可视化前端。10.一种大场景三维模型数据的高效、批量属性挂接系统，其特征在于：包括数据采集模块和数据处理分析模块，所述数据采集模块与所述数据处理分析模块相连，所述所述数据采集模块，用于获取二维和各三维模型的基础数据；所述数据处理分析模块，用于执行所述权利要求1至9任一所述大场景三维模型数据的高效、批量属性挂接方法。
说明书desc
技术领域本发明涉及三维模型数据处理技术领域，具体涉及一种大场景三维模型数据的高效、批量属性挂接方法及系统。背景技术随着实景三维建设的大力推进，实景三维的建设受到前所未有的重视和发展。实景三维作为新型测绘，是对一定空间范围内的人类生产、生活和生态空间进行真实、立体、时序化表达的数字空间。相较于传统的二维地理信息产品，实景三维能真实的展示现实世界中各地理实体的空间位置。在完整的三维GIS系统研究和应用方面，三维数据表达越来越丰富，数据格式，数据种类也越来越多，例如倾斜数据、点云数据、以及传统人工建模数据。虽然三维对象表达具有较强的能力，但现有三维数据的属性信息管理和分析能力较弱。目前，基于webGL的广泛应用，以及前端技术的不断发展。部分模型数据在进行轻量化处理时，可将简单、易读的属性信息直接挂接到三维模型瓦片上。前端可通过点击获取模型瓦片上的属性信息。但是通过将模型的属性信息直接写入瓦片的方式可解决部分应用场景。例如数据量不大，数据格式单一，业务逻辑简单的小场景应用系统。但随着三维场景不断的深入应用，以及三维场景业务逻辑的复杂性不断增强。将属性信息直接写入模型数据的方式，依然无法满足大场景三维模型的应用，同时也会带来其他的系统风险。其中主要风险有以下几点：1.瓦片数据的属性挂接不适用于所有的三维模型数据，具有数据局限性；2.三维数据挂接模型数据会直接增加瓦片加载负担，降低前端渲染效率；3.多源三维数据叠加时，各类属性数据无法统一，高效的管理以及分析；因此，在同一场景下如何批量，高效的挂接其属性信息，是本领域技术人员亟待解决的问题。发明内容针对现有技术的不足，本发明的目的是提供一种大场景三维模型数据的高效、批量属性挂接方法及系统。能满足在大场景下，海量、多源、异构的三维数据的属性挂接，既可以充分满足模型信息三维展示能力，也可对其属性信息进行有效的管理，从而更好的支撑各类应用研究。为达到上述目的，本发明目的之一采用的技术方案如下：一种大场景三维模型数据的高效、批量属性挂接方法，包括如下步骤：步骤S1：获取二维和三维模型的基础数据；步骤S2：将各所述三维模型数据与对应所述二维的GeoJSON数据进行比对、统一；步骤S3：将所述二维的GeoJSON数据作为所述三维模型的基准数据，采用特征点匹配法进行多源三维数据空间配准；步骤S4:将步骤S3中空间配准后的数据加载到可视化前端,获取可视化前端的目标点P坐标及高程值；步骤S5:将所述步骤S4中的目标点P坐标及高程值带入二维GeoJSON筛选经纬度所处面，查找符合的高程匹配对象，若符合，得到目标点P的三维模型批量属性，否则重新获取目标点P坐标及高程值，重复步骤S5。进一步地，还包括：步骤S6：通过可视化前端视角中心点Q、目标点P创建唯一射线X，通过射线X与三维模型的空间位置关系，对所述目标点P所在三维空间位置的属性挂接进行空间位置校验，若相交，返回属性数据；否，则不返回属性数据。进一步地，所述步骤S6：对所述目标点P所在三维空间位置的属性挂接进行空间位置校验，具体方法如下：S6001：目标点P确定后，获取当前可视化前端视觉相机范围，并计算相机中心点Q；S6002：连接目标点P与所述相机中心点Q点，创建唯一射线X，并以PQ方向为射线方向，无限延伸；S6003：通过获取到唯一GeoJSON面，以各顶点为节点；以每个节点属性altitude为高度；拉高GeoJSON面，模拟出三维模型体；并以当前DEM高程值，赋予三维模型体高程；S6004：通过射线X与所述S6003拉伸的模型体进行空间位置判断，若相交，则返回客户端的GeoJSON面正确；反之，则返回面数据不正确或误差较大，需要调整相机视角，重新获取目标点P。进一步地，所述步骤S2，具体包括：S2001：对二维的GeoJSON数据与三维模型数据的空间位置比对，若各类数据坐标系不统一，通过坐标系转换，统一坐标系；S2002：检查各三维模型完整性、三维模型比例，若各三维模型比例不一致，对三维模型进行调整；S2003：检查各三维模型数据的数据格式，确保各类三维模型数据能在同一场景下加载；S2004：检查各三维模型的数据精度；S2005：检查二维的GeoJSON数据属性字段，若二维数据的空间位置或属性字段有误，需立即调整数据的空间位置及二维数据的相关属性字段。进一步地，步骤S2：将各所述三维模型数据与对应的所述二维的GeoJSON数据进行比对、统一，还包括：对所述三维模型数据的数据精度进行限制。进一步地，步骤S3：将所述二维的GeoJSON数据作为所述三维模型的基准数据，采用特征点匹配法进行多源三维数据空间配准，具体包括：S3001：计算出GeoJSON数据的最大外接矩形，其中，基准数据范围表示一个矩形范围，包括四个值，分别为最小x值xmin、最小y值ymin、最大x值xmax，最大y值ymax，确保模型配准过程在此范围中进行；S3002：选取各三维模型上的同名控制点作为第一特征点；采用以下二次曲面拟合方程和特征点曲率方程，从三维模型的多个瓦片中提取出特征点突出、模型纹理特征强的中心点，作为各三维模型的第二特征点；N＝a1x2+a2y2+a3z2+a3xy+a4xz+a5yz+a6x+a7y+a8z+a9式中a1，a2，a3，a4，a5，a6、a7、a8、a9是曲面拟合参数，通常采用最小二乘法来求解参数，x、y、z分别为三维模型上某点在空间中的经纬度坐标及高程；该特征点曲率方程，通过曲率M的值来选择具有强特征的瓦片中心点；S3003：先对所述三维模型的第一特征点和所述三维模型的第二特征点进行两次特征点匹配，第一次匹配，根据所述GeoJSON数据的最大外接矩形剔除三维模型与地形环境以及其他模型中多余的瓦片数据或采集质量不高的数据以及控制范围外的瓦片数据，然后将第一特征点进行同名点匹配；第二次匹配，将三维模型的第二特征点与地形环境和高精度影像进行对应；最后，基于这种对应关系，对三维模型和地形环境进行空间配准，获得三维模型和地形环境的配准参数；S3004：根据每个三维模型获得的配准参数，调整三维模型安置的配置文件，保证三维模型在大场景加载下，与原有地理环境和地形位置方位协调，最大程度的还原真实场景。进一步地，所述步骤S4：将步骤S3中空间配准后的数据加载到可视化前端，获取可视化前端的目标点P坐标及高程值，包括：S4001：将空间配准后的DEM数据、卫星影像数据、GeoJSON矢量数据、三维模型数据依次加载到可视化前端；S4002：加载之后，可视化前端随机获取目标点P坐标及高程值，高程值点将作为属性挂接的目标点进行三维模型的空间位置属性实时挂接。进一步地，所述S4001：将空间配准后的DEM数据、卫星影像数据、GeoJSON矢量数据、三维模型数据依次加载到可视化前端，还包括：GeoJSON矢量数据加载完成之后，可将GeoJSON的数据样式调整成透明。进一步地，所述步骤S5，具体包括：S5001：经纬度筛选，将所述步骤S4中目标点P直接投影到地面，通过空间叠加分析，筛选出包含此坐标点的GeoJSON面数据，若只有一个GeoJSON面，将唯一GeoJSON面数据返回可视化前端；若有多个GeoJSON面，通过数组的形式返回可视化前端，再进行以下高程匹配；S5002：高程匹配，将所述步骤S4中高程值减去目标点P点所处的地形高度，得到目标高程值H；H＝Pz-DH其中Pz表示目标点P的高程值，DH表示目标点P的地形高度；将获取的目标高程值H与所述S5001中GeoJSON面数据集合进行altitude属性匹配，将符合目标高程值H属性区间的唯一GeoJSON面数据返回可视化前端。本发明的目的之二采用如下技术方案实现：一种大场景三维模型数据的高效、批量属性挂接系统，包括数据采集模块和数据处理分析模块，所述数据采集模块与所述数据处理分析模块相连，所述所述数据采集模块，用于获取二维和各三维模型的基础数据；所述数据处理分析模块，用于执行上述大场景三维模型数据的高效、批量属性挂接方法。本发明的显著效果是：本发明方法通过三维模型的空间位置、所处地形精度，以及模型的离地高度等综合研判，若符合条件，将geojson面数据所携带的属性信息，自动、高效的挂接到对应的三维模型上。具有以下几点好处：本方法具有较好的兼容性，本方法不限制三维数据的众多格式，通过非传统的属性挂接方式，可兼容多源、异构的三维数据在同一大场景下进行属性挂接。而且，本方法不受应用软件、不受开发环境、不受客户端等限制。本方法具有较低的系统维护成本。与传统的三维模型的属性挂接相比，本方法通过将二维属性数据、三维模型的实体数据进行分类管理，再利用空间位置进行挂接。无论是三维数据的调整或是二维数据的更新，系统操作都相对独立和简单。系统数据在日常维护上，成本相对较低，操作相对简单。本方法具有较好的应用性，本方法采用了二、三维空间位置结合的方式进行属性挂接。在实际的业务应用过程中，可在城市级、地形级等大场景下进行应用。在应用过程中，二维数据和三维数据相对独立，相比传统瓦片写入属性的方式，对应用客户端的内存消耗，将会更小。本方法通过实时计算获取的空间点位置，实时判断空间点位置与模型的空间位置关系，实时返回空间点位置的属性信息。使客户端在保证返回数据的准确性的前提下，还最大限度的还原三维数据的真实空间位置。附图说明图1是具体实施例1的流程图；图2是具体实施例1的二维、三维数据比对调整示意图；图3是具体实施例1某建筑三维图；图4是具体实施例3的原理框图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。具体实施例1如图1所示，一种大场景三维模型数据的高效、批量属性挂接方法，包括如下步骤：步骤S1：获取二维和三维模型的基础数据；采用的数据来源主要有主流三维模型数据以及相对应的二维geojson面数据。步骤S2：将各所述三维模型数据与对应所述二维的GeoJSON数据进行比对、统一；由于三维数据制作方法多样，各类数据质量生产参差不齐。所以，在进行二三维数据融合加载前，应对二三维数据进行坐标系、模型完整性、模型大小比例，模型数据的数据格式等主要的数据属性进行比对。比对方法主要采用通过主流GIS软件平台，进行数据检查。检查内容主要包括数据坐标系统一成国家2000地理坐标系，三维模型模型的完整性，数据格式，数据精度，二维数据的属性字段。若在数据比对过程中，发现数据存在问题时，应及时对数据进行整改。如图2所示，具体包括：S2001：对二维的GeoJSON数据与三维模型数据的空间位置比对，若各类数据坐标系不统一，通过坐标系转换，统一坐标系；国内数据通常采用CGCS2000地理坐标系；S2002：检查各三维模型完整性、三维模型比例，若各三维模型比例不一致，对三维模型进行调整；S2003：检查各三维模型数据的数据格式，确保各类三维模型数据能在同一场景下加载；本专利以Cesium.js进行最终数据加载，确保需要加载的三维数据能全部转换成3Dtiles数据；S2004：检查各三维模型的数据精度；此项可根据用户需要，进行精度检查，各三维模型的精度越高，最终属性挂接的效果越好；S2005：检查二维的GeoJSON数据属性字段中altitude字段和其它相关必要字段，若二维数据的空间位置或属性字段有误，需立即调整数据的空间位置及二维数据的相关属性字段。可能地：还包括：对所述三维模型数据的数据精度进行限制。比对完成之后，为提高最终模型呈现效果，还可对三维数据的数据精度进行限制，例如，地形数据要求在2.5m的精度以下，倾斜数据在0.5m的精度以下。步骤S3：将所述二维的GeoJSON数据作为所述三维模型的基准数据，采用特征点匹配法进行多源三维数据空间配准；即将geojson二维面数据作为整个加载场景的基准数据，再采用特征点匹配法进行模型与模型之间，模型与地理环境之间的位置配准。具体包括：S3001：计算出GeoJSON数据的最大外接矩形，其中，基准数据范围表示一个矩形范围，包括四个值，分别为最小x值xmin、最小y值ymin、最大x值xmax，最大y值ymax，确保模型配准过程在此范围中进行；S3002：选取各三维模型上的同名控制点作为第一特征点，例如特色建筑物标志。采用ContextCapture软件或Open3D提取各三维模型的第二特征点，所述三维模型第二特征点：对于三维模型中的任一个模型瓦片中心点,提取以所述任一个瓦片中心点为多个邻域模型瓦片的中心点，基于所述任一个瓦片中心点和多个邻域瓦片中心点进行局部二次曲面拟合；基于拟合的所述局部二次曲面,计算所述任一个瓦片中心点的曲率；根据模型的每一个瓦片中心点的曲率，基于棱线约束条件，从三维模型的多个瓦片中提取出特征点突出、模型纹理特征强的中心点，作为从三维模型提取的第二特征点；N＝a1x2+a2y2+a3z2+a3xy+a4xz+a5yz+a6x+a7y+a8z+a9式中a1，a2，a3，a4，a5，a6、a7、a8、a9是曲面拟合参数，通常采用最小二乘法来求解参数，x、y、z分别为三维模型上某点在空间中的经纬度坐标及高程；该特征点曲率方程，通过曲率M的值来选择具有强特征的瓦片中心点。S3003：先对所述三维模型的第一特征点和所述三维模型的第二特征点进行两次特征点匹配，第一次匹配，根据所述GeoJSON数据的最大外接矩形剔除三维模型与地形环境以及其他模型中多余的瓦片数据或采集质量不高的数据以及控制范围外的瓦片数据，然后将第一特征点进行同名点匹配；第二次匹配，将三维模型的第二特征点与地形环境和高精度影像进行对应；最后，基于这种对应关系，对三维模型和地形环境进行空间配准，获得三维模型和地形环境的配准参数。S3004：根据每个三维模型获得的配准参数，调整三维模型安置的配置文件，保证三维模型在大场景加载下，与原有地理环境和地形位置方位协调，最大程度的还原真实场景，确保二维、三维的空间位置和相对位置。步骤S4：将步骤S3中空间配准后的数据加载到可视化前端，获取可视化前端的目标点P坐标及高程值；数据比对和多源三维模型配准完成之后，各类三维数据可依次加载。数据加载可通过相关SDK加载到可视化前端，本专利以Cesium.js为例。S4001：将空间配准后的DEM数据、卫星影像数据、GeoJSON矢量数据、三维模型数据依次加载到可视化前端；S4002：加载之后，通过客户端可根据业务需要，通过客户端鼠标点击，可视化前端随机获取目标点P坐标及高程值，该高程值点将作为属性挂接的目标点进行三维模型的空间位置属性实时挂接。可能地，还包括：GeoJSON矢量数据加载完成之后，可将GeoJSON的数据样式调整成透明，即将一个二维面数据的渲染颜色调整成透明，可使属性挂接体验更佳。步骤S5:将所述步骤S4中的目标点P坐标及高程值带入二维GeoJSON筛选经纬度所处面，查找符合的高程匹配对象，若符合，得到目标点P的三维模型批量属性，否则调整目标点P经纬度平差，重新获取目标点P坐标及高程值，重复步骤S5。通过将已获取到的经纬度和高程值代入二维GeoJSON面中进行计算。计算可细分为两步：S5001：第一步经纬度筛选，将所述步骤S4中目标点P直接投影到地面，通过空间叠加分析，筛选出包含此坐标点的GeoJSON面数据，若只有一个GeoJSON面，将唯一GeoJSON面数据返回可视化前端；若有多个GeoJSON面，通过数组的形式返回可视化前端，再进行以下高程匹配；S5002：第二步高程匹配，由于步骤S2中对三维模型进行了空间位置配准，获取的高程值包含了地形高度，目标高程值H进行匹配时，需目标点P的高程值减去目标点P点所处的地形高度。即将所述步骤S4中高程值减去目标点P点所处的地形高度，得到目标高程值H；H＝Pz-DH其中PZ表示目标点P的高程值，DH表示目标点P的地形高度；将获取的目标高程值H与所述S5001中GeoJSON面数据集合进行altitude属性匹配，将符合目标高程值H属性区间的唯一GeoJSON面数据返回可视化前端。具体步骤如下：S50021：将获取到的GeoJSON面中的altitude属性分成不同的高程范围，以目标点P地形高度为起点，GeoJSON面数据集合中altitude最小值为终点，作为第一个高程范围；再以第一个GeoJSON面数据中的altitude的值作为起点，以第二个GeoJSON面数据的altitude属性值作为终点，作为第二个高程范围；若有多个GeoJSON面数据集合，以此类推；S50022：通过将获取到的目标高程值H，轮巡所述S50021得到的集合面中的所有高程范围,找到符合目标高程值H的高度区间面，并将此唯一GeoJSON面数据返回给可视化前端。以图3所示，某建筑为例，其从地面计算，50米以下为商业裙楼，50米以上为商业住宅，两种不同性质的建筑物在平面投影下具有较大面积重叠。通过目标点经纬度能返回两个或以上建筑物面数据，再通过GeoJSON属性面数据中altitude的数值结合地形高度通过上述S5002计算方法，计算该目标点的的所处的实际空间位置。最后，将二维geojson中唯一面数据返回给可视化前端，进行下一步操作。具体实施例2本实施例的特征是：还包括步骤S6：通过可视化前端视角中心点Q，目标点P，创建唯一射线X，通过射线与三维模型的空间位置关系，对所述目标点P所在三维空间位置的属性挂接进行空间位置校验，若相交，返回属性数据；否，则不返回属性数据。由于城市建筑空间位置错综复杂，建筑物形状各异。如当系统获取点P，处于特殊建筑屋上的特殊空间位置上，例如、斜顶建筑物、U形建筑物等，获取点的模型属性挂接可能会出现挂接错误。为提高属性挂接的准确性，我们将对P点所在的三维空间位置的属性挂接进行空间位置校验，确保同一空间相交关系。校验方式，通过可视化前端视角中心点Q，目标点P。以Q点作为起点，向P点连接，并无限延伸，创建唯一射线X。通过射线与模型的空间位置关系，判断上一步骤返回的Geojson数据是否正确。具体步骤如下：S6001：目标点P确定后，获取当前客户端视觉相机范围，并计算相机中心点Q；S6002：连接目标点P与所述相机中心点Q点，创建唯一射线X，并以PQ方向为射线方向，无限延伸；S6003：通过获取到唯一GeoJSON面，以各顶点为节点；以每个节点属性altitude为高度；拉高GeoJSON面，模拟出三维模型体；并以当前DEM高程值，赋予三维模型体高程；S6004：通过射线X与所述S6003拉伸的模型体进行空间位置判断，若相交，则返回客户端的GeoJSON面正确；反之，则返回面数据不正确或误差较大，需要调整相机视角，重新获取目标点P。其它特征与具体实施例1相同，故本具体实施在此省略。具体实施例3参见图4所示，一种大场景三维模型数据的高效、批量属性挂接系统，包括数据采集模块1和数据处理分析模块2，所述数据采集模块1与所述数据处理分析模块2相连，所述所述数据采集模块1，用于获取二维和各三维模型的基础数据；所述数据处理分析模块2，用于执行具体实施例1或者具体实施例2任一所述大场景三维模型数据的高效、批量属性挂接方法。故本具体实施例在此省略。以上对本发明所提供的技术方案进行了详细介绍。本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想。应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以对本发明进行若干改进和修饰，这些改进和修饰也落入本发明权利要求的保护范围内。
