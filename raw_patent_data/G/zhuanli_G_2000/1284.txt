标题title
高光谱图像获取中消除光场非均匀分布的校正系统及方法
摘要abst
高光谱图像获取中消除光场非均匀分布的校正系统及方法，涉及高光谱图像处理技术领域，有效消除由于卤素灯光源照射下光场非均匀分布对高光谱图像信息采集所造成的影响。校正方法包括获取卤素灯光源照射下两不同反射率的标准白板所对应的高光谱图像A；获取同一光源照射下的茶叶样品对应的高光谱图像B；基于高光谱图像A得到光场的空间分布特性；对高光谱图像A和B中的像素点进行空间匹配；对高光谱图像B中同一位置样品的像素点进行光场校正；对样品光场校正后的结果进行反射率校正。本发明可以有效消除由于卤素灯光源照射下光场非均匀分布对高光谱图像所造成的影响，并能对高光谱数据进行反射率校正。
权利要求书clms
1.高光谱图像获取中消除光场非均匀分布的校正系统，其特征在于，包括CCD相机、成像光谱仪、光源、镜头、第一标准白板、第二标准白板和暗室，所述CCD相机位于暗室的上部，所述成像光谱仪位于CCD相机的下方且成像光谱仪顶部与CCD相机衔接，所述镜头位于成像光谱仪的底部，所述光源位于镜头的左右两侧，所述第二标准白板位于镜头的下方，所述第一标准白板放置于第二标准白板上。2.根据权利要求1所述的高光谱图像获取中消除光场非均匀分布的校正系统，其特征在于，所述第一标准白板的反射率为20%，所述第二标准白板的反射率为60%。3.根据权利要求1至2任一项所述的高光谱图像获取中消除光场非均匀分布的校正系统的校正方法，其特征在于，包括以下步骤：S1：获取卤素灯光源照射下第一标准白板和第二标准白板所对应的高光谱图像A；S2：获取同一光源照射下样品所对应的高光谱图像B；S3：基于高光谱图像A得到光场的空间分布特性；S4：对高光谱图像A和高光谱图像B中的像素点进行空间匹配；S5：对高光谱图像B中同一位置样品的像素点进行光场校正；S6：对样品光场校正后的结果进行反射率校正。4.根据权利要求3所述的高光谱图像获取中消除光场非均匀分布的校正方法，其特征在于，S3的具体步骤为：S3.1将高光谱图像A中第一标准白板的中心位置记为；S3.2利用公式对高光谱图像A中的像素点/＞进行光场分布量化，得到光场的空间分布特性；式中，，/＞为像素点/＞的光谱，/＞为样品检测区域的尺寸；S3.3记录像素点与第一标准白板中心的相对位置/＞，其中/＞为像素点/＞的位置。5.根据权利要求4所述的高光谱图像获取中消除光场非均匀分布的校正方法，其特征在于，S4的具体步骤为：S4.1将高光谱图像B中第一标准白板的中心位置记为；S4.2记录高光谱图像B中样品的像素点与第一标准白板中心的相对位置，其中/＞为像素点/＞的位置，，/＞为样品检测区域的尺寸；当时，认为像素点/＞与像素点为同一位置。6.根据权利要求5所述的高光谱图像获取中消除光场非均匀分布的校正方法，其特征在于，S5的具体步骤为：当像素点与像素点/＞被认定为同一位置时，利用公式/＞对高光谱图像B中样品的像素点/＞进行光场校正；式中，为样品像素点/＞的光谱。7.根据权利要求6所述的高光谱图像获取中消除光场非均匀分布的校正方法，其特征在于，S6的具体步骤为：S6.1取高光谱图像B中第一标准白板的平均光谱，取第一标准白板周围第二标准白板的平均光谱/＞；S6.2利用点和/＞进行拟合，得到线性拟合公式/＞，其中/＞t为波段数；/＞为当波段为/＞时，/＞的DN值，X为反射率，es和fs为系数；S6.3将像素点光场校正结果/＞代入公式/＞，得到点/＞反射率校正结果，其中/＞为当波段为/＞时，像素点/＞光场校正的结果。
说明书desc
技术领域本发明涉及高光谱图像处理技术领域，具体为一种高光谱图像获取中消除光场非均匀分布的校正系统及方法。背景技术高光谱图像具有丰富的光谱和空间信息，能够直接反映出物质的组成成分和结构差异，目前已被广泛应用。卤素灯价格便宜、输出功率高且稳定性好，但光照均匀性较差，使用卤素灯作为光源获取高光谱图像时，会导致样品扫描区域光照不均匀，无法体现样品的空间分布特征。发明内容本发明的目的在于提供一种高光谱图像获取中消除光场非均匀分布的校正系统及方法，通过对光场和叶片反射率进行校正，有效消除由于卤素灯光源照射下光场非均匀分布对高光谱图像信息采集所造成的影响，并能够对高光谱数据进行反射率校正。本发明解决技术问题所采取的技术方案是：高光谱图像获取中消除光场非均匀分布的校正系统，包括CCD相机、成像光谱仪、光源、镜头、第一标准白板、第二标准白板和暗室，所述CCD相机位于暗室的上部，所述成像光谱仪位于CCD相机的下方且成像光谱仪顶部与CCD相机衔接，所述镜头位于成像光谱仪的底部，所述光源位于镜头的左右两侧，所述第二标准白板位于镜头的下方，所述第一标准白板放置于第二标准白板上。进一步地，所述第一标准白板的反射率为20%，所述第二标准白板的反射率为60%。本发明还提供一种高光谱图像获取中消除光场非均匀分布的校正系统的校正方法，包括以下步骤：S1：获取卤素灯光源照射下第一标准白板和第二标准白板所对应的高光谱图像A；S2：获取同一光源照射下样品所对应的高光谱图像B；S3：基于高光谱图像A得到光场的空间分布特性；S4：对高光谱图像A和高光谱图像B中的像素点进行空间匹配；S5：对高光谱图像B中同一位置样品的像素点进行光场校正；S6：对样品光场校正后的结果进行反射率校正。进一步地，S3的具体步骤为：S3.1将高光谱图像A中第一标准白板的中心位置记为；S3.2利用公式对高光谱图像A中的像素点进行光场分布量化，得到光场的空间分布特性；式中，，为像素点的光谱，为样品检测区域的尺寸；S3.3记录像素点与第一标准白板中心的相对位置，其中为像素点的位置。进一步地，S4的具体步骤为：S4.1将高光谱图像B中第一标准白板的中心位置记为；S4.2记录高光谱图像B中样品的像素点与第一标准白板中心的相对位置，其中为像素点的位置，，为样品检测区域的尺寸；当时，认为像素点与像素点为同一位置。进一步地，S5的具体步骤为：S5.1当像素点与像素点被认定为同一位置时，利用公式对高光谱图像B中样品的像素点进行光场校正；式中，为像素点的光谱。进一步地，S6的具体步骤为：S6.1取高光谱图像B中第一标准白板的平均光谱，取第一标准白板周围第二标准白板的平均光谱；S6.2利用点和进行拟合，得到线性拟合公式，其中t为波段数；为当波段为时，的DN值，es和fs为系数，X为反射率；S6.3将像素点光场校正结果代入公式，得到点反射率校正结果，其中为当波段为时，像素点光场校正的结果。本发明的有益效果是：通过获取卤素灯光源照射下反射率为20%和60%的标准白板及样品所对应的高光谱图像，基于光场的空间分布特性，对同一位置样品的像素点进行光场校正，并对两块标准白板的平均光谱进行拟合，将样品光场校正后的结果进行反射率校正，有效消除由于卤素灯光源照射下光场非均匀分布对高光谱图像信息采集所造成的影响，并能够对高光谱数据进行反射率校正。附图说明图1为本发明校正系统的结构图；图2为本发明校正方法流程图；图3为本发明高光谱图像A中样品检测区域的图像；图4为本发明高光谱图像B中样品检测区域的图像；图5为本发明样品光场校正后的图像；图6 a为550nm处样品的原始光谱DN值以及光场校正后的DN值对比示意图；图6 b为680nm处样品的原始光谱DN值以及光场校正后的DN值对比示意图；图6 c为750nm处样品的原始光谱DN值以及光场校正后的DN值对比示意图；图7 a为550nm处的拟合示意图；图7 b为680nm处的拟合示意图；图7 c为750nm处的拟合示意图；图8 a为550nm处单一校正的反射率及拟合校正的反射率对比示意图；图8 b为680nm处单一校正的反射率及拟合校正的反射率对比示意图；图8 c为750nm处单一校正的反射率及拟合校正的反射率对比示意图；图9为550nm处样品的原始谱线DN值以及经过光场校正后DN值的统计分析图；图10为680nm处样品的原始谱线DN值以及经过光场校正后DN值的统计分析图；图11为750nm处样品的原始谱线DN值以及经过光场校正后DN值的统计分析图；图12为550nm处样品通过单一校正的反射率以及通过拟合校正的反射率结果的统计分析图；图13为680nm处样品通过单一校正的反射率以及通过拟合校正的反射率结果的统计分析图；图14为750nm处样品通过单一校正的反射率以及通过拟合校正的反射率结果的统计分析图。图中：1暗室，2第一标准白板，3样品检测区域，4第二标准白板，5镜头，6光源，7成像光谱仪，8CCD相机。具体实施方式如图1所示，本发明的一种高光谱图像获取中消除光场非均匀分布的校正系统包括CCD相机8、成像光谱仪7、光源6、镜头5、第一标准白板2、第二标准白板4和暗室1，在暗室1的上部设置有CCD相机8，CCD相机8的下方设有成像光谱仪7，成像光谱仪7的顶部与CCD相机8衔接，成像光谱仪7的底部具有镜头5，镜头5为高光谱镜头，镜头5的左右两侧具有光源6，光源6为卤素灯光源。镜头5的下方设置有第二标准白板4，第二标准白板4上放置有第一标准白板2，第一标准白板2是反射率为20%的标准白板，第二标准白板4是反射率为60%的标准白板。在第二标准白板4的中心位置划分有样品检测区域3，使用时，将样品放置于样品检测区域3。本发明的目的是对光场和叶片反射率进行校正，有效消除由于卤素灯光源照射下光场非均匀分布对高光谱图像信息采集所造成的影响，并能够对高光谱数据进行反射率校正。为使本发明实现上述目的，下面结合附图对本发明的校正方法进行详细描述。如图2所示，一种高光谱图像获取中消除光场非均匀分布的校正方法，包括以下步骤：步骤S1：获取卤素灯光源6照射下的第一标准白板2和第二标准白板4所对应的高光谱图像A，并划分样品检测区域3。获取高光谱图像前，将第二标准白板4置于距镜头5以下60cm处，将第一标准白板2置于第二标准白板4上并固定；在第二标准白板4中心位置划分出样品检测区域3。为了获得清晰无失真的图像，将成像光谱仪7的移动速度调整为26mm/s、曝光时间调整为40ms。获取的卤素灯光源照射下的高光谱图像A如图3所示，由于卤素灯光源光照均匀性较差，高光谱图像A中的样品检测区域光照分布不均，图中框出的部分存在过亮或过暗现象。步骤S2：获取同一光源照射下的茶叶样品所对应的高光谱图像B，如图4所示。步骤S3：基于高光谱图像A得到光场的空间分布特性。具体为：S3.1选取高光谱图像A对应的633nm下的高光谱图像，并对图像进行适当裁剪，找到第一标准白板2对应的位置，构建第一标准白板2对应的掩膜图像。利用上述掩膜图像对高光谱图像A对应的633nm下的高光谱图像进行二值化图像分割，获得第一标准白板2对应的分割区域。S3.2采用数字形态学中的膨胀和腐蚀操作对第一标准白板2对应的分割区域分别进行膨胀和腐蚀处理，获得第一标准白板2对应的区域。S3.3采用二值图像分析中的连通域标记方法对膨胀、腐蚀后的图像进行连通域提取，第一标准白板2所在的连通域长宽介于100-300间；通过筛选，获得高光谱图像A中第一标准白板2的中心位置。S3.4提取高光谱图像A对应的样品检测区域3中像素点的光谱，利用公式对高光谱图像A中的像素点进行光场分布量化，得到光场的空间分布特性；式中，为样品检测区域3的尺寸。S3.5记录像素点与第一标准白板2中心的相对位置，其中为像素点的位置。步骤S4：对高光谱图像A和高光谱图像B中的像素点进行空间匹配。S4.1使用与步骤S3中相同的方法获取高光谱图像B中第一标准白板2的中心位置。选取高光谱图像B对应的733nm下的高光谱图像，构建样品检测区域3中样品对应的掩膜图像；利用该掩膜图像对高光谱图像B对应的733nm下的高光谱图像进行二值化图像分割，获得样品对应的分割区域。S4.2提取高光谱图像B对应的样品检测区域3中样品像素点的光谱；记录高光谱图像B中样品的像素点与第一标准白板2中心的相对位置，其中为像素点的位置，为样品检测区域3的尺寸；当时，认为高光谱图像A中的像素点与高光谱图像B中的像素点为同一位置。步骤S5：对高光谱图像B中同一位置样品的像素点进行光场校正。当像素点与像素点被认定为同一位置时，利用公式对高光谱图像B中样品的像素点进行光场校正，得到样品光场校正结果，如图5所示，由图可知，样品检测区域3中过亮和过暗的部分被校正。通过观察茶叶样品的原始光谱图以及样品光场校正光谱图，选择三个波段，分别是550nm、680nm和750nm，将这三个波段样品的原始光谱DN值以及经过光场校正后的DN值进行对比，如图6a、图6b和图6c所示。三个波段样品的原始谱线DN值以及经过光场校正后的DN值，其统计分析如图9、图10和图11所示。通过对比光场校正前后的结果可知，校正前数据分布为偏态分布，校正后数据分布为正态分布，且变异系数均由大变小，说明本发明提供的光场校正方法可以有效消除由于卤素灯光源照射下光场非均匀分布对高光谱图像信息采集所造成的影响。步骤S6：对样品光场校正后的结果进行反射率校正。S6.1取高光谱图像B中第一标准白板2的平均光谱，取第一标准白板2周围第二标准白板4的平均光谱，对应20%的反射率，对应60%的反射率。S6.2利用点和进行拟合，得到线性拟合公式其中，t为波段数；为当波段为时的DN值；为当波段为时，的DN值，x是反射率，和是系数。S6.3将像素点光场校正结果代入公式，得到点反射率拟合校正结果其中，为当波段为时，像素点光场校正的结果。S6.4当高光谱图像A中像素点与高光谱图像B中像素点被认定为同一位置时，利用公式对高光谱图像B中样品的像素点进行反射率校正，得到样品反射率单一校正结果。R是高光谱图像B中样品的像素点的光谱，是高光谱图像A对应的样品检测区域3中像素点的光谱。由于在高光谱图像A中对应的样品检测区域3未放置样品，这时扫描的样品检测区域3内对应第二标准白板4，第二标准白板4的反射率为60%。故，想要得到样品反射率校正的结果需要使用公式，上式为高光谱反射率校正的通用公式。一般扫描高光谱利用反射率为100%的标准白板，而我们采用反射率为60%的白板，故上式中需要除以0.6。选择三个波段，分别是550nm、680nm和750nm，将这三个波段样品通过单一校正的反射率以及通过拟合校正的反射率进行对比，对比结果如图6a、图6b、图6c、图7a、图7b、图7c、图8a、图8b和图8c所示。图7a为通过线性拟合公式Re=0.03X+17.97对550nm处拟合校正的反射率，图7b为通过线性拟合公式Re=0.02X+18.30对680nm处拟合校正的反射率，图7c为通过线性拟合公式Re=0.05X+17.54对750nm处拟合校正的反射率。三个波段样品通过单一校正的反射率以及通过拟合校正的反射率结果，其统计分析如图12、图13和图14所示。通过两种不同的反射率校正方法的结果可知，使用单一反射率为60%的第二标准白板4校正后的结果为偏态分布，使用反射率为20%的第一标准白板2和反射率为60%的第二标准白板4拟合后的结果为正态分布，且变异系数均由大变小，说明本发明提供的反射率校正方法能够在光场非均匀分布的情况下更好地对反射率进行校正。从实施例证明，可以通过本发明提出的这种光场和反射率校正方法，达到有效消除由于卤素灯光源照射下光场非均匀分布对高光谱图像信息采集所造成的影响，并能够对高光谱数据进行反射率校正的目的。
