标题title
一种弱口令检测方法以及装置
摘要abst
本申请实施例提供了一种弱口令检测方法以及装置，属于网络安全技术领域，方法包括：通过部署在目标系统上的代理程序，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息；根据密码数据库文件的位置信息以及存储密码的算法信息，从密码数据库文件中提取哈希密码；根据基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对目标服务的弱口令，并构建针对目标服务的弱口令字典；根据弱口令字典中的各个弱口令，检测哈希密码中是否含有弱口令。本发明可以构建针对目标服务的高质量弱口令字典，提升弱口令检测的准确性。
权利要求书clms
1.一种弱口令检测方法，其特征在于，包括：通过部署在目标系统上的代理程序，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息；根据所述密码数据库文件的位置信息以及存储密码的算法信息，从所述密码数据库文件中提取哈希密码；根据所述基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对所述目标服务的弱口令，并构建针对所述目标服务的弱口令字典；根据所述弱口令字典中的各个弱口令，检测所述哈希密码中是否含有所述弱口令。2.根据权利要求1所述的弱口令检测方法，其特征在于，所述提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息，具体包括：查找目标资产的安装目录；通过所述目标资产的安装目录，读取所述目标资产的配置文件和配置数据库；从所述配置文件和所述配置数据库中，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息。3.根据权利要求2所述的弱口令检测方法，其特征在于，所述查找目标资产的安装目录，具体包括：通过查找操作系统安装程序目录或常用安装目录或目标资产常用和默认的安装目录，确定目标资产的安装目录；和/或通过查找系统进程是否存在目标资产的相关进程，若是，通过进程确定目标资产的安装目录。4.根据权利要求1所述的弱口令检测方法，其特征在于，所述从所述密码数据库文件中提取哈希密码，具体包括：当提取哈希密码的操作复杂度小于预设复杂度时，在本地读取并解析所述密码数据库文件，从所述密码数据库文件中提取哈希密码；当提取哈希密码的操作复杂度大于所述预设复杂度且所述密码数据库文件的文件大小小于预设数值时，上传所述密码数据库文件至服务端，在服务端读取并解析所述密码数据库文件，从所述密码数据库文件中提取哈希密码。5.根据权利要求1所述的弱口令检测方法，其特征在于，通过口令变异生成多个针对所述目标服务的弱口令，具体包括：根据所述基础业务信息，获取所述目标服务的基础口令，所述基础口令包括已知弱口令、常用弱口令、基础业务名称和名称缩写；对所述基础口令进行大小写转换、特殊字符替换、添加数字、添加特殊字符、同义词转换、反义词转换和/或错别字转换，生成多个弱口令。6.根据权利要求1所述的弱口令检测方法，其特征在于，通过预渲染生成多个针对所述目标服务的弱口令，具体包括：构建无字典参数的弱口令字典；根据所述基础业务信息，填充渲染字典参数；通过填充渲染后的弱口令字典，生成多个弱口令。7.根据权利要求1所述的弱口令检测方法，其特征在于，通过机器学习生成多个针对所述目标服务的弱口令，具体包括：根据所述基础业务信息，获取所述目标服务的基础口令，所述基础口令包括已知弱口令、常用弱口令、基础业务名称和名称缩写；通过支持向量机识别所述已知弱口令的口令变异规则；根据识别出的口令变异规则，对所述基础口令进行口令变异，生成多个弱口令。8.根据权利要求7所述的弱口令检测方法，其特征在于，所述通过支持向量机识别所述已知弱口令的口令变异规则，具体包括：在支持向量机中构建径向基核函数，向支持向量机输入目标已知弱口令的词向量以及除所述目标已知弱口令以外的弱口令的词向量，比较所述目标已知弱口令与所述目标已知弱口令以外的弱口令之间的相似度，判断所述目标已知弱口令是否由所述目标已知弱口令以外的弱口令变形得到，若是，进入下一步；在支持向量机中构建多项式核函数，输入多个由所述目标已知弱口令以外的弱口令变形得到的所述目标已知弱口令的词向量，识别所述已知弱口令的口令变异规则。9.根据权利要求8所述的弱口令检测方法，其特征在于，所述支持向量机的训练方法为：获取多个常用弱口令；通过词嵌入模型将每个常用弱口令转化为词向量；计算各个词向量之间的相似度、字符比例和字符重合度；将相似度、字符比例和字符重合度组合为常用弱口令的特征向量；通过常用弱口令的特征向量对所述支持向量机进行训练。10.一种弱口令检测装置，其特征在于，包括：信息提取模块，用于通过部署在目标系统上的代理程序，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息；密码提取模块，用于根据所述密码数据库文件的位置信息以及存储密码的算法信息，从所述密码数据库文件中提取哈希密码；构建模块，用于根据所述基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对所述目标服务的弱口令，并构建针对所述目标服务的弱口令字典；检测模块，用于根据所述弱口令字典中的各个弱口令，检测所述哈希密码中是否含有所述弱口令。
说明书desc
技术领域本申请各实施例属于网络安全技术领域，具体涉及一种弱口令检测方法以及装置。背景技术对口令通过字典攻击进行检测，是弱口令检测的一种有效方法，但其有效性和效率严重受限于所使用的弱口令字典的质量。传统的字典构建方法使用常见弱密码、历史泄露密码以及常见字符组合等元素进行构建，主要针对于一些通用场景，这也导致弱口令字典的质量较差，难以胜任对于某个具体场景的弱口令检测，对于弱口令的检测效果差。发明内容为了解决现有技术存在的对于弱口令的检测效果差的技术问题，本发明提供了一种弱口令检测方法及装置。第一方面，本发明提供了一种弱口令检测方法，包括：通过部署在目标系统上的代理程序，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息；根据所述密码数据库文件的位置信息以及存储密码的算法信息，从所述密码数据库文件中提取哈希密码；根据所述基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对所述目标服务的弱口令，并构建针对所述目标服务的弱口令字典；根据所述弱口令字典中的各个弱口令，检测所述哈希密码中是否含有所述弱口令。第二方面，本发明提供了一种弱口令检测装置，包括：信息提取模块，用于通过部署在目标系统上的代理程序，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息；密码提取模块，用于根据所述密码数据库文件的位置信息以及存储密码的算法信息，从所述密码数据库文件中提取哈希密码；构建模块，用于根据所述基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对所述目标服务的弱口令，并构建针对所述目标服务的弱口令字典；检测模块，用于根据所述弱口令字典中的各个弱口令，检测所述哈希密码中是否含有所述弱口令。与现有技术相比，本发明至少具有以下有益效果：在本发明中，根据某个具体的场景的基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对目标服务的弱口令，并构建针对目标服务的高质量弱口令字典，提升弱口令检测的准确性，提升对于弱口令的检测效果。附图说明图1是本发明提供的一种弱口令检测方法的流程示意图；图2是本发明提供的一种弱口令检测方法的结构示意图；图3是本发明提供的一种弱口令检测装置的结构示意图；此处所说明的附图用来提供对本申请的进一步理解，构成本申请的一部分，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。后文将参照附图以示例性而非限制性的方式详细描述本申请的一些具体实施例。具体实施方式为了使本技术领域的人员更好地理解本申请方案，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述。显然，所描述的实施例仅仅是本申请一部分的实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获取的所有其他实施例，都应当属于本申请保护的范围。第一方面，参照图1，示出了本发明实施例提供的一种弱口令检测方法的流程示意图。参照图2，示出了本发明实施例提供的一种弱口令检测方法的结构示意图。本发明提供了一种弱口令检测方法，包括：S101：通过部署在目标系统上的代理程序，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息。其中，代理程序是一种位于目标系统上的软件程序，其主要作用是在目标系统和外部环境之间进行中间通信和数据交换。代理程序通常充当了一个桥梁的角色，将来自外部的请求转发给目标系统，并将目标系统返回的响应传递给外部请求者。在本文中，代理程序的作用是协助提取目标服务的相关信息。其中，目标服务是指需要进行弱口令检测的目标系统中的特定服务或应用程序。在实际应用过程中，目标服务可能是一个Web应用、数据库服务、FTP服务器等等。该服务通常需要访问用户账户和密码，因此对其弱口令的检测尤为重要。其中，基础业务信息不仅包含部署信息，还包含业务本身的信息，例如数据库字段名称、URL路由、登录用户名、主机名称、服务名称等。其中，密码数据库是目标服务用于存储用户密码的文件，其位置信息指的是密码数据库在目标系统中存放的路径或位置。了解密码数据库文件的位置对于后续从中提取哈希密码信息至关重要。其中，目标服务通常采用特定的算法对用户密码进行哈希或加密存储，存储密码的算法信息用于存储目标服务所采用特定的算法。了解存储密码的算法信息对于后续从密码数据库中提取哈希密码并进行弱口令检测至关重要。在一种可能的实施方式中，S101具体包括子步骤S1011至S1013：S1011：查找目标资产的安装目录。在一种可能的实施方式中，S1011具体包括：通过查找操作系统安装程序目录或常用安装目录或目标资产常用和默认的安装目录，确定目标资产的安装目录。和/或通过查找系统进程是否存在目标资产的相关进程，若是，通过进程确定目标资产的安装目录。在本发明中，通过多种方式来查找目标资产的安装目录，有助于确保找到目标资产的位置，提高了弱口令检测方法的可靠性和适用性，使得本发明提供的弱口令检测方法能够适应不同场景的部署，并增加了目标资产定位的准确性和成功率。S1012：通过目标资产的安装目录，读取目标资产的配置文件和配置数据库。S1013：从配置文件和配置数据库中，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息。在本发明中，获得了目标服务的配置信息、基础业务信息以及密码数据库信息，这些信息在后续的弱口令检测中将被用来生成多个针对目标服务的弱口令，构建高质量的弱口令字典，有助于提高弱口令检测的准确性，减少误报和漏报的情况，确保系统的安全性。S102：根据密码数据库文件的位置信息以及存储密码的算法信息，从密码数据库文件中提取哈希密码。在一种可能的实施方式中，S102具体包括子步骤S1021和S1022：S1021：当提取哈希密码的操作复杂度小于预设复杂度时，在本地读取并解析密码数据库文件，从密码数据库文件中提取哈希密码。其中，操作复杂度可以通过计算处理时长以及内存的使用率等进行量化。其中，本领域技术人员可以根据实际情况设置预设复杂度的大小，本发明不做限定。需要说明的是，当提取哈希密码的操作复杂度小于预设复杂度时，选择在本地处理密码数据库文件可以提高操作效率。本地处理通常更快速，因为不涉及与远程服务器的通信和上传下载文件。S1022：当提取哈希密码的操作复杂度大于所述预设复杂度且密码数据库文件的文件大小小于预设数值时，上传密码数据库文件至服务端，在服务端读取并解析密码数据库文件，从密码数据库文件中提取哈希密码。其中，本领域技术人员可以根据实际情况设置预设数值的大小，本发明不做限定。需要说明的是，当提取哈希密码的操作复杂度较高时，可能需要更多的计算资源来执行这些操作。如果本地计算资源不足以有效地处理密码数据库文件，将文件上传到服务端可以利用服务器上更强大的计算资源来执行复杂的操作，从而提高性能和效率。在本发明中，根据提取哈希密码的操作复杂度以及密码数据库文件大小选择不同的处理方式，可以提高系统的效率，节省网络资源，具有更好的可扩展性，并降低本地系统的压力，是一种优化弱口令检测方法的有效策略。S103：根据基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对目标服务的弱口令，并构建针对目标服务的弱口令字典。其中，口令变异是一种通过对基础口令进行一系列变换操作来生成多个可能的弱口令的技术。其中，预渲染是一种生成针对目标服务的弱口令的技术。它通常涉及构建一个不包含具体口令的弱口令字典，该字典中的口令参数以占位符或特定标记表示。然后根据基础业务信息填充这些占位符或标记，生成具体的弱口令。其中，机器学习技术可以通过对已知弱口令样本的特征进行分析，识别出口令变异规则，然后根据这些规则对基础口令进行口令变异来生成更多的弱口令。这使得机器学习方法能够根据特定场景的基础业务信息，生成针对目标服务的定制化弱口令列表。在一种可能的实施方式中，通过口令变异生成多个针对目标服务的弱口令，具体包括：根据基础业务信息，获取目标服务的基础口令，基础口令包括已知弱口令、常用弱口令、基础业务名称和名称缩写。对基础口令进行大小写转换、特殊字符替换、添加数字、添加特殊字符、同义词转换、反义词转换和/或错别字转换，生成多个弱口令。在本发明中，通过口令变异技术，可以生成多个不同形式的弱口令，从而增加了对目标服务可能使用的弱口令的覆盖率，提高弱口令检测的准确性和有效性，为系统的密码安全性提供更好的保障。在一种可能的实施方式中，通过预渲染生成多个针对目标服务的弱口令，具体包括：构建无字典参数的弱口令字典。根据基础业务信息，填充渲染字典参数。通过填充渲染后的弱口令字典，生成多个弱口令。在本发明中，构建无字典参数的弱口令字典，因为不需要事先包含所有可能的密码组合，使得弱口令字典的大小相对较小。无字典参数的弱口令字典构建速度更快，减少了字典构建的时间和资源占用。进一步地，通过填充渲染后的弱口令字典，可以生成多样性的弱口令，使得在弱口令检测时能够更全面地覆盖不同类型的弱口令，提高了弱口令检测的准确性。在一种可能的实施方式中，通过机器学习生成多个针对目标服务的弱口令，具体包括：根据基础业务信息，获取目标服务的基础口令，基础口令包括已知弱口令、常用弱口令、基础业务名称和名称缩写。通过支持向量机识别已知弱口令的口令变异规则。根据识别出的口令变异规则，对基础口令进行口令变异，生成多个弱口令。在本发明中，通过支持向量机识别已知弱口令的口令变异规则，之后再根据识别出的口令变异规则，对基础口令进行口令变异，生成多个弱口令，使得生成的弱口令更具有针对性，更贴近实际可能被用户使用的弱口令，从而提高了弱口令检测的准确性。在一种可能的实施方式中，通过支持向量机识别已知弱口令的口令变异规则，具体包括：在支持向量机中构建径向基核函数，向支持向量机输入目标已知弱口令的词向量以及除目标已知弱口令以外的弱口令的词向量，比较目标已知弱口令与目标已知弱口令以外的弱口令之间的相似度，判断目标已知弱口令是否由目标已知弱口令以外的弱口令变形得到，若是，进入下一步。需要说明的是，通过将目标已知弱口令与其他基础口令进行比较，检查是否可以通过一定的规则或变换得到目标已知弱口令，有助于确定目标已知弱口令是否属于基础口令的变形。只有目标已知弱口令可以由目标已知弱口令以外的弱口令变形得到，才能进一步地去识别口令变异规则。在支持向量机中构建多项式核函数，输入多个由目标已知弱口令以外的弱口令变形而来的目标已知弱口令的词向量，识别已知弱口令的口令变异规则。具体而言，最终确定变异规则是通过搜索相似的基础口令的变异规则解空间并检查是否可以得到与已知弱口令一致的结果来完成的。进一步地，支持向量机输出是否存在类似模式的分类结果；若识别到存在类似的模式，则进一步提取弱口令词库中的部分，通过遍历口令变异规则找到对应的变异模式。在本发明中，通过支持向量机识别已知弱口令的口令变异规则，之后再根据识别出的口令变异规则，对基础口令进行口令变异，生成多个弱口令，使得生成的弱口令更具有针对性，更贴近实际可能被用户使用的弱口令，从而提高了弱口令检测的准确性。在一种可能的实施方式中，支持向量机的训练方法为：获取多个常用弱口令。通过词嵌入模型将每个常用弱口令转化为词向量。其中，词嵌入模型可以是Word2Vec、GloVe、FastText等。计算各个词向量之间的相似度、字符比例和字符重合度。其中，相似度通常通过计算两个词向量之间的距离或相似性来衡量。可以通过计算欧式距离或者余弦相似度来计算词向量之间的相似度。其中，字符比例可以用于比较两个字符串之间字符的相似程度。计算字符比例可以简单地统计两个字符串中相同字符的数量，然后除以较长字符串的长度。字符比例的值范围在之间，值越大表示两个字符串中的字符越相似。其中，字符重合度用于度量两个字符串之间字符重复的情况。计算字符重合度可以先将两个字符串中的字符去重，然后计算重复字符的数量，最后除以去重后的字符数量。字符重合度的值范围在之间，值越大表示两个字符串中的字符重复越多。将相似度、字符比例和字符重合度组合为常用弱口令的特征向量。通过常用弱口令的特征向量对支持向量机进行训练。在本发明中，通过支持向量机的训练方法，将常用弱口令转化为特征向量并进行分类，可以实现自动化特征提取、综合多个特征信息、提高分类效果和可扩展性，从而有效地构建弱口令检测模型，提高弱口令检测的准确性和效率。S104：根据弱口令字典中的各个弱口令，检测哈希密码中是否含有弱口令。具体而言，对于目标服务的哈希密码，将其与弱口令字典中生成的哈希值进行比对。如果目标服务的哈希密码与弱口令字典中的某个哈希值匹配，说明目标服务使用了弱口令。与现有技术相比，本发明至少具有以下有益效果：在本发明中，根据某个具体的场景的基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对目标服务的弱口令，并构建针对目标服务的高质量弱口令字典，提升弱口令检测的准确性，提升对于弱口令的检测效果。第二方面，参照图3，示出了本发明实施例提供的一种弱口令检测装置的结构示意图。本发明提供了一种弱口令检测装置30，包括：信息提取模块301，用于通过部署在目标系统上的代理程序，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息；密码提取模块302，用于根据所述密码数据库文件的位置信息以及存储密码的算法信息，从所述密码数据库文件中提取哈希密码；构建模块303，用于根据所述基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对所述目标服务的弱口令，并构建针对所述目标服务的弱口令字典；检测模块304，用于根据所述弱口令字典中的各个弱口令，检测所述哈希密码中是否含有所述弱口令。在一种可能的实施方式中，信息提取模块301具体用于：查找目标资产的安装目录；通过所述目标资产的安装目录，读取所述目标资产的配置文件和配置数据库；从所述配置文件和所述配置数据库中，提取目标服务的基础业务信息、密码数据库文件的位置信息和存储密码的算法信息。在一种可能的实施方式中，信息提取模块301具体用于：通过查找操作系统安装程序目录或常用安装目录或目标资产常用和默认的安装目录，确定目标资产的安装目录；和/或通过查找系统进程是否存在目标资产的相关进程，若是，通过进程确定目标资产的安装目录。在一种可能的实施方式中，密码提取模块302具体用于：当提取哈希密码的操作复杂度小于预设复杂度时，在本地读取并解析所述密码数据库文件，从所述密码数据库文件中提取哈希密码；当提取哈希密码的操作复杂度大于所述预设复杂度且所述密码数据库文件的文件大小小于预设数值时，上传所述密码数据库文件至服务端，在服务端读取并解析所述密码数据库文件，从所述密码数据库文件中提取哈希密码。在一种可能的实施方式中，构建模块303具体用于：根据所述基础业务信息，获取所述目标服务的基础口令，所述基础口令包括已知弱口令、常用弱口令、基础业务名称和名称缩写；对所述基础口令进行大小写转换、特殊字符替换、添加数字、添加特殊字符、同义词转换、反义词转换和/或错别字转换，生成多个弱口令。在一种可能的实施方式中，构建模块303具体用于：构建无字典参数的弱口令字典；根据所述基础业务信息，填充渲染所述字典参数；通过填充渲染后的弱口令字典，生成多个弱口令。在一种可能的实施方式中，构建模块303具体用于：根据所述基础业务信息，获取所述目标服务的基础口令，所述基础口令包括已知弱口令、常用弱口令、基础业务名称和名称缩写；通过支持向量机识别所述已知弱口令的口令变异规则；根据识别出的口令变异规则，对所述基础口令进行口令变异，生成多个弱口令。在一种可能的实施方式中，构建模块303具体用于：在支持向量机中构建径向基核函数，向支持向量机输入目标已知弱口令的词向量以及除所述目标已知弱口令以外的弱口令的词向量，比较所述目标已知弱口令与所述目标已知弱口令以外的弱口令之间的相似度，判断所述目标已知弱口令是否由所述目标已知弱口令以外的弱口令变形而来，若是，进入下一步；在支持向量机中构建多项式核函数，输入多个由所述目标已知弱口令以外的弱口令变形而来的所述目标已知弱口令的词向量，识别所述已知弱口令的口令变异规则。在一种可能的实施方式中，所述支持向量机的训练方法为：获取多个常用弱口令；通过词嵌入模型将每个常用弱口令转化为词向量；计算各个词向量之间的相似度、字符比例和字符重合度；将相似度、字符比例和字符重合度组合为常用弱口令的特征向量；通过常用弱口令的特征向量对所述支持向量机进行训练。本发明提供的弱口令检测装置30能够实现上述方法实施例中实现的各个过程，为避免重复，这里不再赘述。本发明提供的虚拟装置可以是装置，也可以是终端中的部件、集成电路、或芯片。与现有技术相比，本发明至少具有以下有益效果：在本发明中，根据某个具体的场景的基础业务信息，通过口令变异、预渲染和/或机器学习，生成多个针对目标服务的弱口令，并构建针对目标服务的高质量弱口令字典，提升弱口令检测的准确性，提升对于弱口令的检测效果。最后应说明的是：以上各实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述各实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围。
