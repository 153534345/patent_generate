标题title
基于数据子集的纵向联邦学习异常数据调试方法及系统
摘要abst
本发明公开了一种基于数据子集的纵向联邦学习异常数据调试方法及系统，包括：发起方基于纵向联邦学习建模并进行联邦模型训练；利用训练后的联邦模型获取数据集中的问题数据子集，问题数据子集在联邦模型中的预测准确率低于其他数据子集在联邦模型中的预测准确率；对问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；发起方或参与方基于带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练联邦模型。本发明为隐私保护的联邦数据子集评估技术，在保证数据隐私下对联邦数据子集评估指标进行正确计算，形成基于数据子集的联邦学习调试方法，自动化定位异常数据，解决联邦学习模型表现异常的问题。
权利要求书clms
1.一种基于数据子集的纵向联邦学习异常数据调试方法，其特征在于，所述方法包括：发起方基于纵向联邦学习建模并进行联邦模型训练；利用训练后的所述联邦模型获取数据集中的问题数据子集，所述问题数据子集在所述联邦模型中的预测准确率低于其他数据子集在所述联邦模型中的预测准确率；对所述问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；发起方或参与方基于所述带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练所述联邦模型。2.根据权利要求1所述的基于数据子集的纵向联邦学习异常数据调试方法，其特征在于，对所述问题数据子集进行基于特征描述组合的筛选前，先对离散特征按照离散数据的类别进行分类，对连续特征进行数据区间切分。3.根据权利要求1所述的基于数据子集的纵向联邦学习异常数据调试方法，其特征在于，所述基于特征描述组合的筛选采用多方安全计算方法保护数据ID，以及通过将数据ID进行区间合并形成数据异常描述。4.根据权利要求1所述的基于数据子集的纵向联邦学习异常数据调试方法，其特征在于，所述纵向联邦学习异常数据调试方法还包括基于遮罩向量的联邦数据子集隐私保护方法，具体包括：在基于纵向联邦学习建模前对数据ID进行ID对齐；所述遮罩向量为一个全量交集数据的数组，各数据子集中一个特征对应的ID集合对应一个单独遮罩向量，所述单独遮罩向量仅存在于对应特征所属的数据集，当数据子集中含有多个特征时，需要各特征拥有者持有的遮罩向量并使用多方安全计算方法进行对位相乘，确定当前数据子集真正的遮罩向量；根据所述真正的遮罩向量计算当前数据子集的评估指标。5.根据权利要求1所述的基于数据子集的纵向联邦学习异常数据调试方法，其特征在于，所述基于特征描述组合的筛选还包括对用于问题数据子集筛选的机器学习模型进行训练，所述机器学习模型训练过程中，使用多个公共数据集，随机生成规则挑选数据子集进行标签破坏，将真正存在问题的数据子集标为模型训练的正样本标签，其余为负样本标签，通过数据子集发现技术采集不同数据子集的特征数据，形成用于机器学习模型的数据集；将所述问题数据子集输入训练完成后的所述机器学习模型，得到带有异常描述的问题数据子集。6.根据权利要求3或权利要求4所述的基于数据子集的纵向联邦学习异常数据调试方法，其特征在于，所述多方安全计算方法利用秘密分享技术作为底层技术实现，所述秘密分享技术包括：将一个数随机的分裂为两个数或多个数，分裂后的数分属不同的计算方，各计算方即根据分属的数据展开隐私保护下的算术计算。7.一种基于数据子集的纵向联邦学习异常数据调试系统，其特征在于，所述系统包括：联邦模型训练单元，用于发起方基于纵向联邦学习建模并进行联邦模型训练；问题数据子集获取单元，用于利用训练后的所述联邦模型获取数据集中的问题数据子集，所述问题数据子集在所述联邦模型中的预测准确率低于其他数据子集在所述联邦模型中的预测准确率；问题数据子集筛选单元，用于对所述问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；问题数据子集纠正单元，用于发起方或参与方基于所述带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练所述联邦模型。8.根据权利要求7所述的基于数据子集的纵向联邦学习异常数据调试系统，其特征在于，所述问题数据子集筛选单元中所述基于特征描述组合的筛选还包括对用于问题数据子集筛选的机器学习模型进行训练，所述机器学习模型训练过程中，使用多个公共数据集，随机生成规则挑选数据子集进行标签破坏，将真正存在问题的数据子集标为模型训练的正样本标签，其余为负样本标签，通过数据子集发现技术采集不同数据子集的特征数据，形成用于机器学习模型的数据集；将所述问题数据子集输入训练完成后的所述机器学习模型，得到带有异常描述的问题数据子集。9.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至6任一项所述基于数据子集的纵向联邦学习异常数据调试方法。10.一种非临时计算机可读存储介质，所述存储介质上存储有计算机指令，其特征在于，所述指令被处理器执行时实现如权利要求1至6任一项所述基于数据子集的纵向联邦学习异常数据调试方法。
说明书desc
技术领域本发明属于计算机技术领域，具体涉及一种基于数据子集的纵向联邦学习异常数据调试方法及系统。背景技术涉及到多个数据持有方的联邦学习技术目前在金融风控、智能医疗等领域，得到了越来越广泛的应用。然而，目前针对联邦学习模型的调试技术仍然处于空白领域，造成这一现象的主要原因有以下几点：1）隐私保护原因：由于训练联邦学习模型所需的数据来自两个或更多个参与方，出于隐私保护原因，模型训练的发起方难以访问其他数据提供方的数据、特征信息，从而使得数据问题难以确定，调试难以进行；2）调试技术原因：现有的联邦调试技术主要针对的是集中式的训练场景，即模型训练的发起方可以访问所有数据，根据数据情况进行调试，此类调试技术的执行流程难以适配联邦学习中的数据分布状况；3）参与方配合原因：在联邦学习模型面临问题时候，通常需要发起方与数据提供方人工寻找问题，此类过程本不仅费时费力的，而且过多的人工参与还可能进一步引发隐私泄漏问题。纵向联邦学习针对的是纵向的数据分布情况，数据的纵向分布也称为样本对齐的数据分布，在该场景中，数据分布在多个参与方的数据库中，各参与方拥有高度重叠的数据ID，但拥有数据的特征无重叠或重叠极少，当进行数据分析业务时，多个数据方首先需要对各自持有的数据ID求得交集，并取出各方数据中数据ID相同的那部分数据进行后续的数据的分析查询任务，数据的纵向分布主要应用在各方数据集用户重叠较多而特征维度重叠较少的情况。多方数据纵向分布多见于跨行业场景，例如：在金融风控场景中，银行作为数据持有方，持有一部分客户的贷款前信息，银行可以利用这些信息训练贷前风控模型，而在联邦建模这一典型应用场景中，银行引入了运营商数据作为贷款前风控的数据补充，在这种情况下只有既是银行的客户，又是运营商用于的客户数据能够参与到联邦建模中。在此场景中，银行和运营商所持有的数据即为多方纵向分布的，参与联邦建模，其数据ID同时位于银行和运营商的数据中，而此类数据的分布就属于多方数据的纵向分布。在纵向联邦学习过程中，多个参与方使用各自所拥有数据训练联邦学习模型。当各方持有的数据都属于正常数据且不存在数据错误的时候，联邦学习模型的性能表现通常会满足业务需求。然而，在很多情况下，由于某个参与方所拥有数据中存在数据错误或缺失，会导致模型表现不佳，不能满足业务要求。例如：在一个保险公司与医疗机构的纵向联邦学习场景中，医疗机构由于工作人员疏忽，在操作数据库时候，误将年龄为30 – 40岁患者的某项医学指标检测结果都设置为了阳性，在联邦模型中，这样的数据错误就可能对模型的性能产生影响。而保险公司的工作人员很难在在此类情况下在不看医疗机构数据的前提下，定位这一问题。而在已有的解决方案中，均不能保证在成功调试的前提下保证参与方所持有的数据不出本地，也很难保证在没有人工检视数据的前提下完成调试。而以上两种方式都会造成严重的数据泄漏风险。联邦学习的模型由两个或多个参与方训练，参加模型训练的数据需要在模型训练前准备好，例如两个参与方中，拥有标签的参与方被称作发起方，通常发起方也是有实际业务需求的一方，没有标签的参与方被称为协作方，通常协作方拥有大量数据特征并期望通过提供数据服务赚取利润。但是在业务场景中，由于隐私和法律的多种原因，发起方只能够对自己掌握的数据拥有查询、检视、修改、增加的权利，而不能够跨越参与方对协作方的数据进行这类操作。所以在该场景中，既不能够允许操作联邦学习的相关人员看到非本参与方的数据，也不能够允许任何参与联邦学习的数据离开本地发送至其他参与方。在联邦学习场景中，数据异常会导致联邦模型对部分测试数据的预测错误率陡增，导致模型异常。而现有研究工作存在难以定位联邦学习下的数据异常问题或难以直接应用于联邦学习场景的问题。发明内容本发明针对上述问题，提供了一种基于数据子集的纵向联邦学习异常数据调试方法及系统，通过设计隐私保护的联邦数据子集评估技术，在保证数据隐私前提下对联邦数据子集的相关评估指标进行正确计算，形成基于联邦数据子集的联邦学习调试框架，自动化定位异常数据，解决联邦学习模型表现异常的问题。根据本公开实施例的第一方面，提供一种基于数据子集的纵向联邦学习异常数据调试方法，所述方法包括：发起方基于纵向联邦学习建模并进行联邦模型训练；利用训练后的所述联邦模型获取数据集中的问题数据子集，所述问题数据子集在所述联邦模型中的预测准确率低于其他数据子集在所述联邦模型中的预测准确率；对所述问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；发起方基于所述带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练所述联邦模型。在一实施例中，对所述问题数据子集进行基于特征描述组合的筛选前，先对离散特征按照离散数据的类别进行分类，对连续特征进行数据区间切分。在一实施例中，所述基于特征描述组合的筛选采用多方安全计算方法保护数据ID，以及通过将数据ID进行区间合并形成数据异常描述。在一实施例中，所述纵向联邦学习异常数据调试方法还包括基于遮罩向量的联邦数据子集隐私保护方法，具体包括：在基于纵向联邦学习建模前对数据ID进行ID对齐；所述遮罩向量为一个全量交集数据的数组，各数据子集中一个特征对应的ID集合对应一个单独遮罩向量，所述单独遮罩向量仅存在于对应特征所属的数据集，当数据子集中含有多个特征时，需要各特征拥有者持有的遮罩向量并使用多方安全计算方法进行对位相乘，确定当前数据子集真正的遮罩向量；根据所述真正的遮罩向量计算当前数据子集的评估指标。在一实施例中，所述基于特征描述组合的筛选还包括对用于问题数据子集筛选的机器学习模型进行训练，所述机器学习模型训练过程中，使用多个公共数据集，随机生成规则挑选数据子集进行标签破坏，将真正存在问题的数据子集标为模型训练的正样本标签，其余为负样本标签，通过数据子集发现技术采集不同数据子集的特征数据，形成用于机器学习模型的数据集；使用该数据集进行训练之后，机器学习模型拥有精细分辨问题数据子集的能力；将所述问题数据子集输入训练完成后的所述机器学习模型，得到带有异常描述的问题数据子集。在一实施例中，所述多方安全计算方法利用秘密分享技术作为底层技术实现，所述秘密分享技术包括：将一个数随机的分裂为两个数或多个数，分裂后的数分属不同的计算方，各计算方即根据分属的数据展开隐私保护下的算术计算。根据本公开实施例的第二方面，提供一种基于数据子集的纵向联邦学习异常数据调试系统，所述系统包括：联邦模型训练单元，用于发起方基于纵向联邦学习建模并进行联邦模型训练；问题数据子集获取单元，用于利用训练后的所述联邦模型获取数据集中的问题数据子集，所述问题数据子集在所述联邦模型中的预测准确率低于其他数据子集在所述联邦模型中的预测准确率；问题数据子集筛选单元，用于对所述问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；问题数据子集纠正单元，用于发起方基于所述带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练所述联邦模型。在一实施例中，所述问题数据子集筛选单元中所述基于特征描述组合的筛选还包括对用于问题数据子集筛选的机器学习模型进行训练，所述机器学习模型训练过程中，使用多个公共数据集，随机生成规则挑选数据子集进行标签破坏，将真正存在问题的数据子集标为模型训练的正样本标签，其余为负样本标签，通过数据子集发现技术采集不同数据子集的特征数据，形成用于机器学习模型的数据集；使用该数据集进行训练之后，机器学习模型拥有精细分辨问题数据子集的能力；将所述问题数据子集输入训练完成后的所述机器学习模型，得到带有异常描述的问题数据子集。根据本公开实施例的第三方面，提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现上述基于数据子集的纵向联邦学习异常数据调试方法。根据本公开实施例的第四方面，提供一种非临时计算机可读存储介质，所述存储介质上存储有计算机指令，所述指令被处理器执行时实现上述基于数据子集的纵向联邦学习异常数据调试方法。本公开实施例提供的一种基于数据子集的纵向联邦学习异常数据调试方法及系统，面向隐私保护的自动化联邦调试应用场景，通过设计隐私保护的联邦数据子集评估技术，在保证数据隐私前提下对联邦数据子集的相关评估指标进行正确计算，形成基于联邦数据子集的联邦学习调试框架，自动化定位异常数据，从而帮助人员解决联邦学习模型表现异常的问题。既不需要发起方在调试过程中参与调试人员接触其他参与方的数据、特征等关键隐私信息，也不需要联邦学习的参与方互相泄漏或发送参与方所持有的数据、特征等信息，其有益效果包括：当由于数据错误问题，导致联邦模型表现不佳的情况下，执行联邦模型的调试流程，可以在参与方数据不出本地的前提下，自动寻找存在错误的数据，删除错误数据之后训练的联邦模型可以拥有正常的性能表现；使用隐私保护的问题数据子集查找技术，在没有人工参与、各个参与方所持有数据不出本地的前提下，借助安全多方计算技术，找出全局数据集中的问题子集，对于该问题子集而言，联邦模型在该数据子集上的预测准确率，远低于模型在该数据集上除问题子集的其他数据集上的预测准确率，该技术找到的问题数据子集可以由便于人类理解的可解释性条件进行描述；引入针对问题数据子集进行筛选方法，筛选的机器学习模型在完成了对问题数据子集的筛选之后，使用错误数据的溯源技术，找到数据集中导致联邦模型存在标签错误的数据；最终，通过剔除溯源到的错误数据，重新训练的联邦模型，完成调试；使用基于机器学习的问题子集过滤技术，该技术针对已经找到的诸多问题数据子集进行筛选，将不满足实际要求的问题数据子集剔除，并留下实际上对联邦模型的性能存在负面影响的问题数据子集。该技术中使用的机器学习模型利用已有的多个问题数据子集的大小、效应量等信息提取特征和标签，然后作为训练数据集训练机器学习模型，训练之后的机器学习模型拥有精细分辨问题数据子集的能力。使用错误数据的溯源技术。该技术使用已经经过筛选的问题数据子集，执行区间合并操作之后，形成描述问题数据子集。该技术借助多方安全计算底层技术，在整个执行流程中，参与方的数据不出本地，同时不需要人工查看数据，确保参与方数据和敏感信息的安全。应当理解的是，以上的一般描述和后文的细节描述仅是示例性和解释性的，并不能限制本公开。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本发明的实施例，并与说明书一起用于解释本发明的原理图1是本发明实施例中基于数据子集的纵向联邦学习异常数据调试方法流程示意图；图2是本发明实施例中基于数据子集的纵向联邦学习异常数据调试方法逻辑框图；图3是本发明实施例中数据子集定义示意图；图4是本发明实施例中数据子集的筛选流程示意图；图5是本发明实施例中基于遮罩向量的联邦数据子集隐私保护方法流程图；图6是本发明实施例中联邦数据子集的错误率计算示意图；图7是本发明实施例中基于机器学习的问题子集筛选方法流程示意图；图8是本发明实施例中基于数据子集的纵向联邦学习异常数据调试系统结构示意图；图9是本发明实施例中一种电子设备示意图。实施方式下面结合附图和实施例对本发明作进一步的详细说明。可以理解的是，此处所描述的具体实施例仅用于解释本发明，而非对本发明的限定。另外还需要说明的是，为了便于描述，附图中仅出示了与本发明相关的部分而非全部结构。在更加详细地讨论示例性实施例之前应当提到的是，一些示例性实施例被描述成作为流程图描绘的处理或方法。虽然流程图将各步骤描述成顺序的处理，但是其中的许多步骤可以被并行地、并发地或者同时实施。此外，各步骤的顺序可以被重新安排。当其操作完成时所述处理可以被终止，但是还可以具有未包括在附图中的附加步骤。所述处理可以对应于方法、函数、规程、子例程、子程序等等。本发明实施例针对一种基于数据子集的纵向联邦学习异常数据调试方法及系统，提供了如下实施例：实施例1用于说明基于数据子集的纵向联邦学习异常数据调试方法，参见图1，为基于数据子集的纵向联邦学习异常数据调试方法流程图，具体步骤包括：S1、发起方基于纵向联邦学习建模并进行联邦模型训练；S2、利用训练后的所述联邦模型获取数据集中的问题数据子集，所述问题数据子集在所述联邦模型中的预测准确率低于其他数据子集在所述联邦模型中的预测准确率；S3、对所述问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；S4、发起方或参与方基于所述带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练所述联邦模型。具体实施过程中，见图2，为实施例调试方法的整体框架示意图，在不影响已有联邦学习模型训练的基础上，使用已有训练模型，通过测试数据进行数据调试，调试流程的具体步骤如下：步骤一：参与方A与参与方B使用各自持有的数据集进行联邦模型训练，该训练流程中包含数据预处理、联邦特征工程、联邦学习训练等步骤，在基于联邦数据子集的联邦学习调试框架中，步骤一的内容与原有联邦学习的训练流程相同，不需要对原有的框架、代码等内容进行修改；步骤二：参与方A和参与方B将模型投入实际业务使用，使用测试数据作为输入，得到联邦学习模型的预测结果，并在实际业务使用中对联邦学习模型的预测结果进行验证，如发现联邦模型的预测结果并无异常，则不需要后续的联邦调试框架介入；若发现联邦学习模型的预测结果存在异常，则进入联邦调试环节；步骤三：参与方A发起联邦调试环节，参与方B按照联邦调试的步骤配合联邦调试流程的进行，双方在联邦调试流程中不会交换原始数据，联邦调试环节结束后，参与方A可以获得联邦调试环节的输出；步骤四：参与方A通过联邦调试的输出结果，与参与方B沟通解决数据问题，由于数据的异常的情况复杂，纠正数据异常问题仍需数据的持有方借助异常数据信息介入调整，而不需要其他数据持有方介入或者观察数据调整，从而保持隐私保护的能力，在解决异常数据问题之后，重新训练联邦学习模型。隐私保护的联邦学习自动化调试方法支持多个参与方参加运算，其中一个参与方作为联邦学习流程的发起方，其他作为联邦学习流程的协作方。隐私保护的联邦学习自动化调试的具体技术流程如下：1）在调试之前，首先进行联邦模型训练，该模型训练需要由发起方进行，使用纵向联邦学习技术进行建模，实施例以逻辑回归作为例子；2）在完成联邦模型的训练之后，计算整个数据集中的问题数据子集，这些问题数据子集，对于问题子集而言，联邦模型在该数据子集上的预测准确率，远低于模型在该数据集上除问题子集的其他数据集上的预测准确率，训练完成后的联邦模型在这个问题数据子集上并不如全局效果好；3）由于技术特性，在2）中找到的问题子集并不一定是由于真正的问题数据造成的，进一步使用了基于机器学习的问题子集过滤技术。该技术针对已经找到的诸多问题数据子集进行筛选，将不满足实际要求的问题数据子集剔除，并留下实际上对联邦模型的性能存在负面影响的问题数据子集，并且针对数据子集形成异常描述；4）在完成错误数据的溯源操作之后，需要参与方A通过联邦调试的输出结果，与参与方B沟通解决数据问题，由于数据的异常的情况复杂，纠正数据异常问题仍需数据的持有方借助问题数据信息介入调整，不需要其他数据持有方介入或者观察数据调整，从而保持隐私保护的能力，在解决异常数据问题之后，重新训练联邦学习模型。至此，整个隐私保护的联邦学习自动化调试流程结束。需要说明的是，联邦数据子集的定义。如图3所示，隐私保护的联邦数据子集是跨数据参与方的联邦数据子集，该联邦数据子集需要通过对分布在不同参与方特征的描述共同组成，例如：性别为男，年龄介于35到40岁之间，其中性别特征位于参与方A，年龄特征位于参与方B。联邦数据子集通过数据样本的ID确定具体属于联邦数据子集的样本条目，也就是说每个联邦数据子集都需要维护一个数据ID列表，该列表中存储了符合联邦特征描述的数据ID，这些数据ID对应的数据组成了联邦数据子集。对于一个给定的数据子集，已经训练好的联邦模型在这个数据子集上的模型性能，优选实施例中使用准确率Accuracy定义表现，低于联邦模型在整个数据集中除该数据子集的另一部分数据上的性能表现的时候，将此类数据子集称为问题数据子集。值得注意的是，由于问题数据子集在大小、性能指标的差距上没有严格的限制，所以并不是所有的问题数据子集都是可以揭示问题数据特征的，还需要在下一步骤利用其他指标进一步筛选过滤，实施例中进一步使用了基于机器学习的问题子集过滤技术进行筛选过滤。对所述问题数据子集进行基于特征描述组合的筛选前，先对离散特征按照离散数据的类别进行分类，对连续特征进行数据区间切分。具体地，如图4所示，对问题数据子集的筛选步骤共分为4步：1）针对离散特征进行分类：对于离散特征而言，将各个参与方所持有的离散特征按照离散数据的类别进行分类；2）针对连续特征切分：将各个参与方所持有的连续特征进行分箱操作，并将分箱后的数据区间作作为切分结果；3）基于特征描述组合的问题数据子集筛选；4）问题子集输出。针对离散和连续特征的分类方式，由于离散特征，如：性别、工作种类、是否有房等，通常只拥有较少的数据类型，实施例中，离散特征的描述可以单独进行分类，作为数据子集的描述条件。而对于连续特征而言，例如：年龄、存款、年收入、社保缴纳金额等，由于其涉及数值的数量和跨度通常大大多于离散型特征，需要首先使用分箱方式，将单个连续性特征通过分箱分为若干个数据段，将这些数据段作为数据子集的描述条件。在完成对所有特征的分类之后，本发明提出了隐私保护的数据子集指标计算方案。以纵向分布为例子来表明该场景下，可能存在的数据泄漏风险：假设A、B是两个参与方，分别持有10个特征，其中A的第1个特征称为FA1， B的第10个特征可以称为FB10，以此类推，表述如下：发起方A持有的特征被称为：FA1 ~ FA10协作方B 持有的特征被称为：FB1 ~FB10，其中有一个是性别特征。当一个数据子集的描述为 sex = male 的时候，如果发起方A知道哪些特征属ID于这个数据子集，那么属于这个数据子集的这些ID的 sex 属性的数据就遭到了准确的泄漏！即发起方A可以通过查看数据ID获取参与方B的信息。为了避免这一数据泄漏风险的发生，本发明在问题数据子集的筛选阶段使用了多方计算技术保护数据ID，以及在问题数据筛选环节，将找到的数据ID进行区间合并，形成数据错误描述。隐私保护是联邦数据子集的一个重要要求，其原因在于对一个参与方而言，联邦数据子集中的特征描述中含有了其他参与方所持有特征在数值上的描述，而这类联邦特征描述如果和数据ID对应，那么则会造成一定程度上的数据泄露风险。实施例中的数据特征，性别为男，年龄介于35到40岁之间，其中性别特征位于参与方A，年龄特征位于参与方B，如果数据ID列表对参与方A和参与方B公开，那么参与方A可以知晓数据ID列表对应数据的年龄位于30-40岁之间，增大了隐私信息的泄漏风险，参与方B则可以知晓数据ID列表对应数据的性别信息，属于直接的数据泄漏。综上所述，联邦数据子集的数据列表是需要对参与方不可见，从而解决避免出现直接或间接的隐私泄露问题。为了解决隐私泄漏问题，本发明提出基于遮罩向量的联邦数据子集隐私保护方法。面向纵向联邦学习应用场景，在纵向联邦学习建模之前，需要对数据ID进行ID对齐操作，实施例中默认数据集的数据ID是经过ID对齐操作之后的。遮罩向量被定义为一个长度为全量交集数据的数组，元素由1或者0构成。对于一个联邦数据子集而言，属于这个联邦数据子集的ID，在遮罩向量的相应位置的元素为1，否则为0，同时，这个遮罩向量的内容是需要保护的，除了持有联邦数据子集中该特征的参与方，其他参与方都不应该知道这个遮罩向量中每个元素的具体数值。与特征的对应关系如图5所示。每个数据子集的每一个特征对应的ID集合都对应一个单独的遮罩向量，这个遮罩向量仅存在于该特征所属的数据集，当数据子集中含有多个特征的时候，则首先需要各个特征拥有者持有的遮罩向量使用多方安全计算技术进行对位相乘，从而确定当前数据子集真正的遮罩向量，此时该遮罩向量的相乘结果仍然属于加密状态。在获得加密的遮罩向量之后，后续和数据子集相关的指标计算都需要使用遮罩向量参与计算，即可根据所述真正的遮罩向量计算当前数据子集的评估指标。以10条样本的数据子集准确率计算为例子，假设一个10条样本的数据子集预测的是否正确使用一个向量表示为，而遮罩向量则是一个加密的  的向量，那么这个数据子集的准确率为5 / 7 * 100% = 71.4286%，其中7是数据子集的样本数量，5是预测正确的样本数量，请注意这个运算中的所有运算均使用安全的多方计算技术实现，不存在数据泄漏的风险。同理，利用遮罩向量以及安全多方计算技术，可以将计算方法扩展至其他评估指标的计算中。在获得加密的遮罩向量之后，后续和联邦数据子集相关的错误率、评估指标的计算需要使用遮罩向量进行计算，并采用隐私计算技术进行隐私保护，下面以联邦数据子集的错误率的计算为例进行讲解。只有参与方A 拥有标签Y，无论联邦模型如何训练，一个数据集的预测值也由参与方A获取的。由此，发起方可以得到模型每个样本的预测是否正确的结论，并形成一个向量，该向量由0或者1 组成。如图6所示，以10条样本的数据子集准确率计算为例子，假设一个10条样本的数据子集预测的是否正确使用一个向量表示为，而遮罩向量则是一个加密的  的向量，该数据子集的准确率为 5 / 7 * 100% = 71.4286%，其中7是数据子集的样本数量，5是预测正确的样本数量。基于特征描述组合的筛选还包括对用于问题数据子集筛选的机器学习模型进行训练，所述机器学习模型训练过程中，使用多个公共数据集，随机生成规则挑选数据子集进行标签破坏，将真正存在问题的数据子集标为模型训练的正样本标签，其余为负样本标签，通过数据子集发现技术采集不同数据子集的特征数据，形成用于机器学习模型的数据集；将所述问题数据子集输入训练完成后的所述机器学习模型，得到带有异常描述的问题数据子集。具体地，如图7所示，基于机器学习的问题子集过滤技术，由于数据集中已经查找到的问题数据子集数量通常较为庞大，并且不是所有的问题数据子集都是由于真正的问题数据造成的，很多数据子集由于数据量过大、数据量过小、性能差别与全局数据基本相似等原因，既不能够全面地反应问题数据的情况，也不能够对定位问题数据有所帮助，所以此类数据子集是需要在后续流程中进行剔除、过滤的。综上，本发明提出了基于机器学习的问题子集过滤技术。机器学习输入的特征包括打不限于数据子集的评估指标、全集除数据子集之外数据的评估指标、数据子集的数据条数、数据子集的数据条数百分比、数据子集和全集除数据子集之外数据的评估指标之比值等特征，其中评估指标包括但不限于准确率、精确率、F-Score、效应量等不同指标。在模型训练阶段，使用多个公共数据集，并依据随机生成的规则挑选数据子集进行标签破坏，并对真正存在问题数据的数据子集进行标作为模型训练的正样本标签，其余为负样本标签，然后通过数据子集发现技术采集不同数据子集的特征数据，以此形成了用于训练数据子集筛选的机器学习模型模型的数据集。当完成数据子集的筛选之后，被机器学习模型判定为正样本标签的数据子集将被作为下一技术环节的输入。多方安全计算方法利用秘密分享技术作为底层技术实现，所述秘密分享技术包括：将一个数随机的分裂为两个数或多个数，分裂后的数分属不同的计算方，各计算方即根据分属的数据展开隐私保护下的算术计算。具体地，安全可控的多方安全计算技术用于实现整个联邦调试流程中所涉及到的问题数据子集查找以及问题数据溯源流程，从而保证结果获取方可以正确获取最终的分析结果，但不可以获取除分析结果之外的敏感信息，包括但不限于：其他参与方的隐私数据、其他参与方的数据ID等；数据提供方除了提供了数据用于计算之外，不能从执行的中间结果中查看或推知其他参与方拥有的敏感信息，优选实施例例中使用的具体技术描述如下。多方安全计算操作使用秘密分享技术作为底层技术实现，秘密分享是指将秘密以适当的方式拆分，拆分后的每一个份额由不同的参与者管理，每个参与者持有其中的一份，协作完成计算任务。单个参与者无法恢复秘密信息，只有若于个参与者一同协作才能恢复秘密消息。每个参与者可以独立的基于分片的数据进行加法和乘法计算，各个参与者将计算的分片结果发送给结果方进行汇总还原出计算结果。整个过程中各个参与者不能获得任何秘密信息，结果方只能获取结果信息，因而有效地保护原始数据不泄漏，并计算出预期的结果。在秘密共享系统中，攻击者必须同时获得一定数量的秘密碎片才能获得密钥，系统的安全性得以保障。另一方面，当某些秘密碎片丢失或被毁时，利用其它的秘密份额仍能够获得秘密信息，系统的可靠性得以保障。秘密共享方案由秘密分割算法和秘密重组算法构成。由于计算问题，总是可以表示成由加法门和乘法门组成的算术电路，所以如果秘密共享方案能够计算加法和乘法，那么理论上就可以计算任何复杂的问题。多方计算服务节点支持各个参与方在不能获取其他任意一方原始数据的情况下，实现多方数据协同计算，得到模型预测结果，同时保护算法参数、模型参数及最终结果。支持多种安全多方计算算子，包括但不限于四则运算、比较运算、逻辑运算、统计运算、函数运算，示例如下：四则运算比较运算逻辑运算统计运算秘密分享的主要思想是将一个数随机的分裂为两个或多个数，分裂后的数分属不同的计算方，各计算方即可根据这些分享的数据展开隐私保护下的算术计算。加法运算：假定参与方A、参与方B各有数x和y，其中将x和y进行分解，x = x1 + x2、y = y1 +y2双方各自分享x2和y1，参与方A将x2分享给参与方B，参与方B将y1分享给参与方A，则参与方A计算z1 = x1+ y1，参与方B计算z2 = x2 + y2；将z2共享给参与方A，显然有：z = x + y = z1 + z2 = x1 + x2 + y1 + y2，参与方A可以计算出z，也就是x、y之和。乘法运算：参与方A和参与方B分别持有x和y，得到了一对随机乘法三元组的分片。其中a =1 + 2、b = 1 + 2、ab = a*b = 1 + 2。采用如下方法计算x、y的乘积:参与方A和参与方B各自将己方数据分享一个分片给对方，交换2和1。参与方A和参与方B各自通过加法分享并还原，分别得到x的盲化d = x - a ，y的盲化 e = y - b，并把d和e公开给对方。在此过程中, x, y, a, b均没有泄露。此时x*y=*=de+d+e+，处于分享态的三元组放在了中括号内，可以看出问题已被转化为加法问题。由参与方B计算对应部分之后将结果发送给参与方A，参与方A代入本步骤x*y公式后，即可得到乘法结果。问题数据子集的溯源，实施例中使用错误数据的溯源技术，该技术使用已经经过筛选的问题数据子集，执行区间合并操作之后，形成描述问题数据子集。该技术借助多方安全计算底层技术，在整个执行流程中，参与方的数据不出本地，同时不需要人工查看数据，确保参与方数据和敏感信息的安全。另一实施例用于说明基于数据子集的纵向联邦学习异常数据调试系统，参见图8，所述系统800包括：联邦模型训练单元810，用于发起方基于纵向联邦学习建模并进行联邦模型训练；问题数据子集获取单元820，用于利用训练后的所述联邦模型获取数据集中的问题数据子集，所述问题数据子集在所述联邦模型中的预测准确率低于其他数据子集在所述联邦模型中的预测准确率；问题数据子集筛选单元830，用于对所述问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；问题数据子集纠正单元840，用于发起方基于所述带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练所述联邦模型。问题数据子集筛选单元830中所述基于特征描述组合的筛选还包括对用于问题数据子集筛选的机器学习模型进行训练，所述机器学习模型训练过程中，使用多个公共数据集，随机生成规则挑选数据子集进行标签破坏，将真正存在问题的数据子集标为模型训练的正样本标签，其余为负样本标签，通过数据子集发现技术采集不同数据子集的特征数据，形成用于机器学习模型的数据集；将所述问题数据子集输入训练完成后的所述机器学习模型，得到带有异常描述的问题数据子集。除了上模块以外，系统800还可以包括其他部件，然而，由于这些部件与本公开实施例的内容无关，因此在这里省略其图示和描述。基于数据子集的纵向联邦学习异常数据调试系统800的其他具体工作过程参照上述基基于数据子集的纵向联邦学习异常数据调试方法实施例的描述，不再赘述。另一实施例用于说明本发明系统也可以借助于图9所示的计算设备的架构来实现。图9示出了该计算设备的架构。如图9所示，计算机系统910、系统总线930、一个或多个CPU 940、输入/输出920、存储器950等。存储器950可以存储计算机处理和/或通信使用的各种数据或文件以及CPU所执行包括实施例基于数据子集的纵向联邦学习异常数据调试方法的程序指令。图9所示的架构只是示例性的，在实现不同的设备时，根据实际需要调整图9中的一个或多个组件。存储器950作为一种计算机可读存储介质，可用于存储软件程序、计算机可执行程序以及模块，如本发明实施例中的基于数据子集的纵向联邦学习异常数据调试方法对应的程序指令/模块。一个或多个CPU 940通过运行存储在存储器950中的软件程序、指令以及模块，从而执行本发明系统的各种功能应用以及数据处理，即实现上述的基于数据子集的纵向联邦学习异常数据调试方法，该方法包括：发起方基于纵向联邦学习建模并进行联邦模型训练；利用训练后的所述联邦模型获取数据集中的问题数据子集，所述问题数据子集在所述联邦模型中的预测准确率低于其他数据子集在所述联邦模型中的预测准确率；对所述问题数据子集进行基于特征描述组合的筛选，获取带有异常描述的问题数据子集；发起方基于所述带有异常描述的问题数据子集进行数据溯源和纠正，并在纠正后重新训练所述联邦模型。当然，本发明实施例所提供的服务器，其处理器不限于执行如上所述的方法操作，还可以执行本发明任意实施例所提供的基于数据子集的纵向联邦学习异常数据调试方法中的相关操作。存储器950可主要包括存储程序区和存储数据区，其中，存储程序区可存储操作系统、至少一个功能所需的应用程序；存储数据区可存储根据终端的使用所创建的数据等。此外，存储器950可以包括高速随机存取存储器，还可以包括非易失性存储器，例如至少一个磁盘存储器件、闪存器件、或其他非易失性固态存储器件。在一些实例中，存储器950可进一步包括相对于一个或多个CPU 940远程设置的存储器，这些远程存储器可以通过网络连接至装置。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。输入/输出920可用于接收输入的数字或字符信息，以及产生与装置的用户设置以及功能控制有关的键信号输入。输入/输出920还可包括显示屏等显示设备。本发明实施例还提供了一种非临时计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现上述实施例中所述的基于数据子集的纵向联邦学习异常数据调试方法，本发明实施例的计算机可读存储介质，可以采用一个或多个计算机可读的介质的任意组合。计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本文件中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。存储介质上包含的程序代码可以用任何适当的介质传输，包括——但不限于无线、电线、光缆、RF等等，或者上述的任意合适的组合。此外，一种非临时计算机可读存储介质的其他具体工作过程参照上述基于数据子集的纵向联邦学习异常数据调试方法实施例的描述，不再赘述。综合上述各实施例提供的技术方案，一种基于数据子集的纵向联邦学习异常数据调试方法及系统，面向隐私保护的自动化联邦调试应用场景，通过设计隐私保护的联邦数据子集评估技术，在保证数据隐私前提下对联邦数据子集的相关评估指标进行正确计算，形成基于联邦数据子集的联邦学习调试框架，自动化定位异常数据，从而帮助人员解决联邦学习模型表现异常的问题。既不需要发起方在调试过程中参与调试人员接触其他参与方的数据、特征等关键隐私信息，也不需要联邦学习的参与方互相泄漏或发送参与方所持有的数据、特征等信息，其有益效果包括：当由于数据错误问题，导致联邦模型表现不佳的情况下，执行联邦模型的调试流程，可以在参与方数据不出本地的前提下，自动寻找存在错误的数据，删除错误数据之后训练的联邦模型可以拥有正常的性能表现；使用隐私保护的问题数据子集查找技术，在没有人工参与、各个参与方所持有数据不出本地的前提下，借助安全多方计算技术，找出全局数据集中的问题子集，对于该问题子集而言，联邦模型在该数据子集上的预测准确率，远低于模型在该数据集上除问题子集的其他数据集上的预测准确率，该技术找到的问题数据子集可以由便于人类理解的可解释性条件进行描述；引入针对问题数据子集进行筛选方法，筛选的机器学习模型在完成了对问题数据子集的筛选之后，使用错误数据的溯源技术，找到数据集中导致联邦模型存在标签错误的数据；最终，通过剔除溯源到的错误数据，重新训练的联邦模型，完成调试；使用基于机器学习的问题子集过滤技术，该技术针对已经找到的诸多问题数据子集进行筛选，将不满足实际要求的问题数据子集剔除，并留下实际上对联邦模型的性能存在负面影响的问题数据子集。该技术中使用的机器学习模型利用已有的多个问题数据子集的大小、效应量等信息提取特征和标签，然后作为训练数据集训练机器学习模型。使用错误数据的溯源技术。该技术使用已经经过筛选的问题数据子集，执行区间合并操作之后，形成描述问题数据子集。该技术借助多方安全计算底层技术，在整个执行流程中，参与方的数据不出本地，同时不需要人工查看数据，确保参与方数据和敏感信息的安全。在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的步骤、方法不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种步骤、方法所固有的要素。以上内容是结合具体的优选实施方式对本发明所作的进一步详细说明，不能认定本发明的具体实施只局限于这些说明。对于本发明所属技术领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干简单推演或替换，都应当视为属于本发明的保护范围。
