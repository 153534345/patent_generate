标题title
一种基于张量-矩阵耦合的地铁客流量预测方法
摘要abst
本发明公开了一种基于张量‑矩阵耦合的地铁客流量预测方法，属于交通预测领域，包括如下步骤：步骤1、获取地铁客流量数据、兴趣点数据、天气状况数据；步骤2、构建基于张量‑矩阵耦合分解的地铁客流量预测模型；步骤3、采用交替方向乘子法求解最优化模型，获得未来某个时间间隔内的地铁客流量预测值。本发明通过引入时间维度将地铁客流量矩阵数据扩展成三阶地铁客流量张量，将天气特征矩阵和兴趣点矩阵作为辅助信息，降低了预测模型的计算复杂度，提高了地铁客流量预测结果的准确性。
权利要求书clms
1.一种基于张量-矩阵耦合的地铁客流量预测方法，其特征在于，包括如下步骤：步骤1、获取地铁客流量数据、兴趣点数据、天气状况数据；步骤2、构建基于张量-矩阵耦合分解的地铁客流量预测模型；步骤3、采用交替方向乘子法求解最优化模型，获得未来某个时间间隔内的地铁客流量预测值。2.根据权利要求1所述基于张量-矩阵耦合的地铁客流量预测方法，其特征在于，所述步骤1中，根据地铁刷卡数据中包含的乘客票卡号、交易时间、交易站点、交易类型信息提取不同地铁站点之间的客流量数据，将获取的地铁客流量数据定义为地铁客流量矩阵序列，其中/＞是时间间隔，/＞为地铁站的数量；/＞中的元素/＞表示第/＞个时间间隔从第/＞个地铁站到第/＞个地铁站的客流量；将地铁客流量矩阵的对角线元素设为0；使用网络爬虫技术从高德地图APP中抓取地铁站点一公里范围内的不同兴趣点的数据，将获取的兴趣点数据定义为兴趣点矩阵，其中/＞为兴趣点的种类个数；/＞中的元素/＞表示第/＞个地铁站周围第/＞种兴趣点的个数；兴趣点包含学校、医院、商场、办公楼、住宅区；使用网络爬虫技术抓取天气网站上的天气状况数据，将天气状况数据定义为天气特征矩阵，其中/＞为时间维度，/＞为天气状况种类的个数；/＞为一个二元指示矩阵，其中元素如下式所示： ；其中，表示第/＞个时间间隔的第/＞种天气情况。3.根据权利要求2所述基于张量-矩阵耦合的地铁客流量预测方法，其特征在于，所述步骤1中，将地铁客流量矩阵序列引入时间维度/＞并扩展为三阶地铁客流量张量/＞，其中/＞，/＞为天数。4.根据权利要求3所述基于张量-矩阵耦合的地铁客流量预测方法，其特征在于，所述步骤2构建基于张量-矩阵耦合分解的地铁客流量预测模型的具体过程为：步骤2.1、将三阶地铁客流量张量使用张量分解算法分解为三个秩一张量和的形式，表示为/＞，其中/＞、/＞、/＞均为/＞的因子矩阵，/＞是张量分解算法分解的秩，/＞表示外积运算；将张量/＞沿第一模展开的矩阵为，此时张量分解算法分解的表达式简化为/＞，其中符号/＞为Khatri-Rao积，/＞为转置符号；步骤2.2、将兴趣点矩阵使用矩阵分解算法分解为两个小维度的矩阵，表示为/＞，其中/＞、/＞均为/＞的因子矩阵；步骤2.3、将天气特征矩阵使用矩阵分解算法分解为/＞，其中、/＞均为/＞的因子矩阵；步骤2.4、将兴趣点矩阵、天气特征矩阵与地铁客流量张量分别在地铁站点维度和时间维度上进行耦合，分解时共用相应的因子矩阵，即、/＞，以下均用/＞、/＞表示；因此，基于张量-矩阵耦合分解的地铁客流量预测模型的目标函数表示为： ；其中，表示初始地铁客流量张量与张量分解算法分解得到的重构张量之间的平方误差；/＞表示初始兴趣点矩阵与张量分解算法分解得到的重构矩阵之间的平方误差；/＞表示初始天气特征矩阵与张量分解算法分解得到的重构矩阵之间的平方误差；步骤2.5、在目标函数中加入正则化项，基于张量-矩阵耦合分解的地铁客流量预测模型优化为： ；其中，表示因子矩阵集合；/＞、/＞、/＞均是正则化参数。5.根据权利要求4所述基于张量-矩阵耦合的地铁客流量预测方法，其特征在于，所述步骤3的具体过程为：根据公式-公式对、/＞、/＞、/＞、/＞五个因子矩阵进行更新迭代，直到达到设定的最大迭代次数停止，得到因子矩阵/＞、/＞、/＞ 的最优解；最后通过计算公式得到补全缺失数据后的张量，即得到未来某个时间间隔/＞内的地铁客流量的预测值； ； ； ； ； ；其中，为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；为单位矩阵；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为张量/＞沿第二模展开的矩阵；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为张量/＞沿第三模展开的矩阵。
说明书desc
技术领域本发明属于交通预测领域，具体涉及一种基于张量-矩阵耦合的地铁客流量预测方法。背景技术随着城市的快速建设与发展，城市交通出行受到越来越多的关注。地铁是城市轨道交通的重要组成部分，也是一种绿色出行工具。从地铁IC卡数据中可以提取OD对数据，OD对数据即地铁任意两个站点之间的客流量，这为地铁双向客流量预测提供了数据基础。地铁任意两个站点之间的客流量同步预测是一项具有挑战性的工作，现有的研究主要应用矩阵分解和神经网络模型相结合的方法基于客流量矩阵进行预测。时间序列数据之间的线性关系可以采用基于矩阵分解的高阶加权动态模态分解等方法挖掘；地铁客流量矩阵数据之间的时空相关性可以采用将地铁系统建模成有向图合并到图卷积门控循环单元中等方法挖掘。但是现有的地铁客流量预测方法存在以下问题：地铁流量数据之间的时空特征及其关联性挖掘并不充分；天气特征、城市功能区分布等对地铁客流量有显著影响的多源影响因素信息利用不足；基于神经网络的组合预测模型计算复杂度高。发明内容为了解决当前预测方法存在对地铁流量数据之间的时空特征挖掘不充分、多源影响因素信息利用不足以及模型计算复杂度高的问题，本发明提出了一种基于张量-矩阵耦合的地铁客流量预测方法，通过引入时间维度将地铁客流量矩阵数据扩展成三阶地铁客流量张量，将天气特征矩阵和兴趣点矩阵作为辅助信息，降低了预测模型的计算复杂度，提高了地铁客流量预测结果的准确性。本发明的技术方案如下：一种基于张量-矩阵耦合的地铁客流量预测方法，包括如下步骤：步骤1、获取地铁客流量数据、兴趣点数据、天气状况数据；步骤2、构建基于张量-矩阵耦合分解的地铁客流量预测模型；步骤3、采用交替方向乘子法求解最优化模型，获得未来某个时间间隔内的地铁客流量预测值。进一步地，所述步骤1中，根据地铁刷卡数据中包含的乘客票卡号、交易时间、交易站点、交易类型信息提取不同地铁站点之间的客流量数据，将获取的地铁客流量数据定义为地铁客流量矩阵序列，其中/＞是时间间隔，/＞为地铁站的数量；/＞中的元素表示第/＞个时间间隔从第/＞个地铁站到第/＞个地铁站的客流量；将地铁客流量矩阵的对角线元素设为0；使用网络爬虫技术从高德地图APP中抓取地铁站点一公里范围内的不同兴趣点的数据，将获取的兴趣点数据定义为兴趣点矩阵，其中/＞为兴趣点的种类个数；/＞中的元素/＞表示第/＞个地铁站周围第/＞种兴趣点的个数；兴趣点包含学校、医院、商场、办公楼、住宅区；使用网络爬虫技术抓取天气网站上的天气状况数据，将天气状况数据定义为天气特征矩阵，其中/＞为时间维度，/＞为天气状况种类的个数；/＞为一个二元指示矩阵，其中元素如下式所示： ；其中，表示第/＞个时间间隔的第/＞种天气情况。进一步地，所述步骤1中，将地铁客流量矩阵序列引入时间维度/＞并扩展为三阶地铁客流量张量/＞，其中/＞，/＞为天数。进一步地，所述步骤2构建基于张量-矩阵耦合分解的地铁客流量预测模型的具体过程为：步骤2.1、将三阶地铁客流量张量使用张量分解算法分解为三个秩一张量和的形式，表示为/＞，其中/＞、/＞、/＞均为的因子矩阵，/＞是张量分解算法分解的秩，/＞表示外积运算；将张量/＞沿第一模展开的矩阵为/＞，此时张量分解算法分解的表达式简化为/＞，其中符号/＞为Khatri-Rao积，/＞为转置符号；步骤2.2、将兴趣点矩阵使用矩阵分解算法分解为两个小维度的矩阵，表示为/＞，其中/＞、/＞均为/＞的因子矩阵；步骤2.3、将天气特征矩阵使用矩阵分解算法分解为/＞，其中/＞、/＞均为/＞的因子矩阵；步骤2.4、将兴趣点矩阵、天气特征矩阵与地铁客流量张量分别在地铁站点维度和时间维度上进行耦合，分解时共用相应的因子矩阵，即、/＞，以下均用/＞、/＞表示；因此，基于张量-矩阵耦合分解的地铁客流量预测模型的目标函数表示为： ；其中，表示初始地铁客流量张量与张量分解算法分解得到的重构张量之间的平方误差；/＞表示初始兴趣点矩阵与张量分解算法分解得到的重构矩阵之间的平方误差；/＞表示初始天气特征矩阵与张量分解算法分解得到的重构矩阵之间的平方误差；步骤2.5、在目标函数中加入正则化项，基于张量-矩阵耦合分解的地铁客流量预测模型优化为： ；其中，表示因子矩阵集合；/＞、/＞、/＞均是正则化参数。进一步地，所述步骤3的具体过程为：根据公式-公式对、/＞、/＞、/＞、/＞五个因子矩阵进行更新迭代，直到达到设定的最大迭代次数停止，得到因子矩阵/＞、/＞、/＞ 的最优解；最后通过计算公式/＞得到补全缺失数据后的张量，即得到未来某个时间间隔/＞内的地铁客流量的预测值； ； ； ； ； ；其中，为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为单位矩阵；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；为因子矩阵/＞第/＞次迭代后的值；/＞为张量/＞沿第二模展开的矩阵；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为张量/＞沿第三模展开的矩阵。本发明所带来的有益技术效果如下：针对当前预测方法对地铁客流量数据之间的时空特征及其关联性挖掘不充分的问题，提出通过引入时间维度将地铁客流量矩阵数据扩展成三阶地铁客流量张量，采用张量分解方法挖掘数据间的时空特征及其关联性；针对当前预测方法对影响因素信息利用不足的问题，采用数据挖掘方法生成天气特征矩阵和兴趣点矩阵优化预测模型；针对现有的基于神经网络的组合预测模型计算复杂度高的问题，提出将天气特征矩阵、兴趣点矩阵与地铁客流量张量分别在时间维度和地铁站点维度上进行耦合，在模型分解过程中共用相同的因子矩阵，减少对因子矩阵的计算，降低模型的计算复杂度。附图说明图1为本发明基于张量-矩阵耦合的地铁客流量预测方法。具体实施方式下面结合附图以及具体实施方式对本发明作进一步详细说明：本发明地铁客流量数据在时间维度上具有很强的日相似性和周相似性，在空间维度上与地铁站点的空间位置具有强相关性，且具有强时空关联性。张量方法在保存数据多维性质的同时，可以表达张量分解后每个模的潜在信息，挖掘数据间的时空特征及其关联性。天气因素、地铁站点周围的地理环境和城市功能区域分布与地铁站的客流模式有密切的关系。基于这个观点，采用晴朗、雨雪、多云等天气状况生成天气特征矩阵，基于学校、医院、办公楼、住宅区等城市兴趣点类型构造兴趣点矩阵作为辅助信息。本发明在张量分解和矩阵分解的基础上，将地铁客流量张量、天气特征矩阵、兴趣点矩阵在对应维度上共用相同的因子矩阵进行耦合，减少对因子矩阵的计算，降低模型计算的复杂度；如图1所示，一种基于张量-矩阵耦合的地铁客流量预测方法包括如下步骤：步骤1、获取地铁客流量数据、兴趣点数据、天气状况数据。根据地铁刷卡数据中包含的乘客票卡号、交易时间、交易站点、交易类型等信息提取不同地铁站点之间的客流量数据，将获取的地铁客流量数据定义为地铁客流量矩阵序列，其中/＞是时间间隔，/＞为地铁站的数量；/＞中的元素/＞表示第/＞个时间间隔从第/＞个地铁站到第/＞个地铁站的客流量；将地铁客流量矩阵的对角线元素设为0。将地铁客流量矩阵序列引入时间维度并扩展为三阶地铁客流量张量，其中/＞，/＞为天数。由于只有当时间间隔/＞内的所有乘客都到达目的地后才能得到这个时间间隔内的真实客流量矩阵，此处采用历史平均客流量矩阵来代替不完整的地铁客流量矩阵。使用网络爬虫技术从高德地图APP中抓取地铁站点一公里范围内的不同兴趣点的数据，将获取的兴趣点数据定义为兴趣点矩阵，其中/＞为兴趣点的种类个数，兴趣点包含学校、医院、商场、办公楼、住宅区等。/＞中的元素/＞表示第/＞个地铁站周围第/＞种兴趣点的个数。使用网络爬虫技术抓取天气网站上的天气状况数据，将天气状况数据定义为天气特征矩阵，其中/＞为天气状况种类的个数，包括晴朗、雨雪、多云等天气状况。矩阵/＞为一个二元指示矩阵，其中元素如下式所示： ；其中，表示第/＞个时间间隔的第/＞种天气情况。步骤2、构建基于张量-矩阵耦合分解的地铁客流量预测模型。模型构建的基本原理：主体信息张量与辅助信息矩阵在相同的维度耦合，共用相应的因子矩阵，在充分利用辅助信息的同时降低模型计算复杂度，提高了模型的预测精度。地铁客流量数据预测模型通过将预测值设置为缺失值，将张量和矩阵分解成多个因子矩阵并进行更新，利用更新后得到的最优因子矩阵做内积重构张量，用以补全原始张量中的缺失数据，即完成地铁客流量预测。将三阶地铁客流量张量使用张量分解算法分解为三个秩一张量和的形式，表示为/＞，其中/＞、/＞、/＞均为/＞的因子矩阵，/＞是张量分解算法分解的秩，/＞表示外积运算。将张量/＞沿第一模展开的矩阵为/＞，此时张量分解算法分解的表达式简化为/＞，其中符号/＞为Khatri-Rao积。将兴趣点矩阵使用矩阵分解算法分解为两个维度更小的矩阵，表示为，其中/＞、/＞均为/＞的因子矩阵；将天气特征矩阵使用矩阵分解算法分解为/＞，其中、/＞均为/＞的因子矩阵。将兴趣点矩阵、天气特征矩阵与地铁客流量张量分别在地铁站点维度和时间维度上进行耦合，分解时共用相应的因子矩阵，即、/＞，以下均用/＞、/＞表示。因此，基于张量-矩阵耦合分解的地铁客流量预测模型的目标函数可以表示为： ；其中，表示初始地铁客流量张量与张量分解算法分解得到的重构张量之间的平方误差；/＞表示初始兴趣点矩阵与张量分解算法分解得到的重构矩阵之间的平方误差；/＞表示初始天气特征矩阵与张量分解算法分解得到的重构矩阵之间的平方误差。当目标函数表示的误差之和越小时，表示原始张量中缺失数据的补全效果越好。为了防止过拟合，对目标函数加入正则化项。因此，基于张量-矩阵耦合分解的地铁客流量预测模型可以优化为： ；其中，表示因子矩阵集合；/＞、/＞、/＞均是正则化参数。该模型将地铁客流量预测问题转换为求目标函数的最优化问题。步骤3、采用交替方向乘子法求解最优化模型，获得未来某个时间间隔内的地铁客流量预测值。目前研究中最常用最小二乘法和梯度下降法来求解最优化问题，但是矩阵分解和张量分解是非凸问题，这些常用的方法不能得到目标函数的全局最优解。因此，本发明拟采用交替方向乘子法ADMM来求解最优化模型。该方法结合对偶分解和拉格朗日乘子法的优点，把大的全局问题分解成许多更小、更简单的局部子问题分别求解，从而得到全局最优解。交替方向乘子法求解最优化模型的具体过程为：根据公式-公式对、/＞、/＞、/＞、/＞五个因子矩阵进行更新迭代，直到达到设定的最大迭代次数停止，得到因子矩阵/＞、/＞、/＞ 的最优解；最后通过计算公式得到补全缺失数据后的张量，即得到未来某个时间间隔/＞内的地铁客流量的预测值； ； ； ； ； ；其中，为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为大小为/＞的单位矩阵；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为张量/＞沿第二模展开的矩阵；/＞为因子矩阵/＞第/＞次迭代后的值；/＞为张量/＞沿第三模展开的矩阵。为了证明本发明的可行性，给出部分数据展示：步骤1中获取的地铁客流量矩阵如表1所示：表1 地铁客流量矩阵。步骤1中获取的兴趣点矩阵如表2所示：表2 兴趣点矩阵。步骤1中获取的天气特征矩阵如表3所示：表3 兴趣点数据矩阵。通过本发明步骤2构建的张量-矩阵耦合分解的地铁客流量预测模型和步骤3的求解最优过程，获得未来某个时间间隔内的地铁客流量预测值如表4所示：表4 地铁客流量预测值矩阵。通过表4中的预测值与表1中的真实值作对比，本发明提出的预测方法能捕捉各个地铁站点之间的客流量规律并且有较高的准确性。当然，上述说明并非是对本发明的限制，本发明也并不仅限于上述举例，本技术领域的技术人员在本发明的实质范围内所做出的变化、改型、添加或替换，也应属于本发明的保护范围。
