标题title
一种自动化的卡证结构化信息抽取技术方法及系统
摘要abst
本发明提供一种自动化的卡证结构化信息抽取技术方法及系统，本发明提供的卡证结构化信息抽取技术方法，将卡证图片输入抽取模型中，根据输入的提示词得到卡证结构化信息卡证结构化信息抽取模型的训练方法包括如下步骤：S1、定义不同的卡证图片结构、定义输入提示词；S2、根据定义的卡证图片结构及输入提示词定义输出形式；S3、根据获取的卡证图片对卡证图片中每个词语的位置进行坐标的标注，并计算得到该词语中字符的坐标位置，得到卡证结构化信息抽取模型；S4、对卡证结构化信息抽取模型进行训练，得到最终卡证结构化信息抽取模型。本发明提出了图片的结构形式以及提示词来进行有监督的学习，直接实现端到端的结构化信息提取。
权利要求书clms
1.一种自动化的卡证结构化信息抽取技术方法，其特征在于，将卡证图片输入卡证结构化信息抽取模型中，根据输入的提示词得到卡证相关信息，所述卡证结构化信息抽取模型的训练方法包括如下步骤：S1、定义不同的卡证图片结构、定义输入提示词；S2、根据定义的卡证图片结构及输入提示词定义输出形式；S3、根据获取的卡证图片对卡证图片中每个词语的位置进行坐标的标注，根据词语的位置得到该词语中字符的坐标位置，得到待训练卡证结构化信息抽取模型；S4、对待训练卡证结构化信息抽取模型进行训练，得到最终卡证结构化信息抽取模型。2.如权利要求1所述的一种自动化的卡证结构化信息抽取技术方法，其特征在于，所述步骤S3中根据词语的位置得到该词语中字符的位置具体为，该词语中字符的位置根据如下公式计算得到：,,其中，设某词语的位置为，x1，y1代表左上角的坐标，x2，y2为右下角的坐标，n为组成该词语的字符数，k为该词语中的第k个字符，根据如上公式计算得到该词语中第k个字符的位置。3.如权利要求2所述的一种自动化的卡证结构化信息抽取技术方法，其特征在于，对kx1、ky1、kx2和ky2的任一项坐标值增加噪声因子得到最终第k个字符位置为、、或，α为噪声因子。4.如权利要求3所述的自动化的卡证结构化信息抽取技术方法，其特征在于，当对kx1或kx2增加噪声因子时，噪声因子满足如下条件：α＜1/6·。5. 如权利要求3所述的自动化的卡证结构化信息抽取技术方法，其特征在于，当对ky1或 ky2增加噪声因子时，噪声因子满足如下条件：α＜1/6·。6.如权利要求1所述的自动化的卡证结构化信息抽取技术方法，其特征在于，所述步骤S4中对卡证结构化信息抽取模型进行训练包括将训练图片输入模型，根据提示词来输出结果，所述训练图片包括卡证的原图以及卡证字符被遮挡后的图片。7.如权利要求6所述的自动化的卡证结构化信息抽取技术方法，其特征在于，当训练图片为卡证字符被遮挡后的图片，训练时将被遮挡的字符替换成自定义字符，其他标注的标签不变，根据提示词得到输出结果。8.如权利要求1所述的自动化的卡证结构化信息抽取技术方法，其特征在于，所述卡证图片结构包括文本的行数、每行的词语数及每个词语的字符数，所述卡证图片结构为xml结构形式，采用xml的形式表示；所述输出形式包括输出对应字符位置信息、输出对应词语位置信息、输出识别得到的字符信息、识别得到的词语信息、输出提取的结构化信息、输出图像结构或输出提示词不存在。9.如权利要求1所述的自动化的卡证结构化信息抽取技术方法，其特征在于，所述卡证结构化信息抽取模型包括编码器和解码器，构建卡证结构化信息抽取模型时，将编码器结果以及提示词输入解码器中，训练时解码器根据提示词输出相应的结果。10.一种自动化的卡证结构化信息抽取技术系统，其特征在于，包括卡证结构化信息抽取模型，所述卡证结构化信息抽取模型用于根据输入的卡证图片及提示词得到输出形式，所述卡证结构化信息抽取模型的训练方法包括如下步骤：S1、定义不同的卡证图片结构、定义输入提示词；S2、根据定义的卡证图片结构及输入提示词定义输出形式；S3、根据获取的卡证图片对卡证图片中每个词语的位置进行标注，根据词语的位置得到该词语中字符的位置，得到待训练卡证结构化信息抽取模型；S4、对待训练卡证结构化信息抽取模型进行训练，得到最终卡证结构化信息抽取模型。
说明书desc
技术领域本发明涉及卡证信息抽取技术领域，尤其涉及一种自动化的卡证结构化信息抽取技术方法及系统。背景技术卡证的结构化信息抽取广泛应用于各行各业，如业务系统在接收用户的卡证后，需要将卡证中的信息抽取为机构化形式，存储到系统数据库。结构化形式多以卡证中字段名、内容组成，如＜姓名，张三＞，＜身份证号码，1234＞，＜发票号码，ad56＞。其中每种卡证都有其不同的字段名；以及不同的形式，字段名与内容同行横向排列，或字段名与内容同列纵向排列。目前，最普遍的卡证类的结构化信息抽取分为多步骤。首先，针对全图进行文字检测，输出文字所在的位置，该位置为＜文字条左上坐标，文字条右上坐标＞，注意文字条是只包含一行文字的图像。其次，根据获取的位置，剪裁出文字条。接着，用文字识别模型识别上述剪裁的文字条。最后根据输出的文字信息，结合每种卡证的情况做正则等复杂规则，输出卡证图像的结构化信息。因而，一个卡证结构化信息抽取的系统往往需要融合文字检测，文字识别，以及针对每种卡证的定制化规则。在上述流程下，很多方案会针对文字检测，以及文字识别进行优化，力图从这两方面提升结构化信息提取的准确率。但是忽视了最后一步复杂而繁琐结构化信息提取的步骤，而这些精心设计的规则很难适用不同的卡证，不同的卡证还需维护各自的提取规则。目前卡证的结构化信息提取技术目前仍较为繁琐，单一的模型也需进一步提升效果。当前的针对卡证结构化信息抽取技术，既要训练文字检测模型，也要训练文字识别模型，还要针对不同的卡证设计特有的规则提取结构化信息。更有甚者，针对不同的卡证训练不同的文字检测模型和文字识别模型。整个流程非常复杂繁琐。另外，由于有多个环节组成，误差会累积，文字检测的错误会累积到文字识别的错误，再传导到用规则提取结构化信息的环节。因此，当输入的图片质量稍差，有一定角度的倾斜时，会导致文字检测识别准确率降低，最终传到下去，整体准确率进一步下降，因而，系统的鲁棒性也有待提升。另外，采用单一模型输入，不依赖于文字检测和文字识别，直接训练一个模型，输入图片，输出结构化信息，该方法比较简洁，但是由于丢失了中间文字信息的监督，准确率也很难达到上述环环相扣的复杂系统的准去率。因此设计一个简洁鲁棒且高效的卡证结构化信息提取技术很有必要。发明内容本发明提供一种加强模型识别鲁棒性的自动化的卡证结构化信息抽取技术方法及系统。本发明一种自动化的卡证结构化信息抽取技术方法，将卡证图片输入卡证结构化信息抽取模型中，根据输入的提示词得到卡证结构化信息，所述卡证结构化信息抽取模型的训练方法包括如下步骤：S1、定义不同的卡证图片结构、定义输入提示词；S2、根据定义的卡证图片结构及输入提示词定义输出形式；S3、根据获取的卡证图片对卡证图片中每个词语的位置进行坐标的标注，根据词语的位置得到该词语中字符的坐标位置，得到待训练卡证结构化信息抽取模型；S4、对待训练卡证结构化信息抽取模型进行训练，得到最终卡证结构化信息抽取模型。优选地，所述步骤S3中根据词语的位置得到该词语中字符的位置具体为，该词语中字符的位置根据如下公式计算得到：,,其中，设某词语的位置为，x1，y1代表左上角的坐标，x2，y2为右下角的坐标，n为组成该词语的字符数，k为该词语中的第k个字符，根据如上公式计算得到该词语中第k个字符的位置。优选地，对kx1、ky1、kx2和ky2的任一项坐标值增加噪声因子得到最终第k个字符位置为、、或，α为噪声因子。优选地，当对kx1或kx2增加噪声因子时，噪声因子满足如下条件：α＜1/6·。优选地，当对ky1或 ky2增加噪声因子时，噪声因子满足如下条件：α＜1/6·。优选地，所述步骤S4中对卡证结构化信息抽取模型进行训练包括将训练图片输入模型，根据提示词来输出结果，所述训练图片包括卡证的原图以及卡证字符被遮挡后的图片。优选地，当训练图片为卡证字符被遮挡后的图片，训练时将被遮挡的字符替换成自定义字符，其他标注的标签不变，根据提示词得到输出结果。优选地，所述卡证图片结构包括文本的行数、每行的词语数及每个词语的字符数，所述卡证图片结构为xml结构形式，采用xml的形式表示；所述输出形式包括输出对应字符位置信息、输出对应词语位置信息、输出识别得到的字符信息、识别得到的词语信息、输出提取的结构化信息、输出图像结构或输出提示词不存在。优选地，所述卡证结构化信息抽取模型包括编码器和解码器，构建卡证结构化信息抽取模型时，将编码器结果以及提示词输入解码器中，训练时解码器根据提示词输出相应的结果。本发明还提供一种自动化的卡证结构化信息抽取技术系统，包括卡证结构化信息抽取模型，所述卡证结构化信息抽取模型用于根据输入的卡证图片及提示词得到输出形式，所述卡证结构化信息抽取模型的训练方法包括如下步骤：S1、定义不同的卡证图片结构、定义输入提示词；S2、根据定义的卡证图片结构及输入提示词定义输出形式；S3、根据获取的卡证图片对卡证图片中每个词语的位置进行标注，根据词语的位置得到该词语中字符的位置，得到待训练卡证结构化信息抽取模型；S4、对待训练卡证结构化信息抽取模型进行训练，得到最终卡证结构化信息抽取模型。本发明提供的自动化的卡证结构化信息抽取技术方法及系统具备如下有益效果：与传统的单一模型相比，本发明通过标注词语的位置可增加系统的鲁棒性，提升输出的准确性，通过注词语的位置来得到该词语中字符的位置，可实现少量额外标注量获取更多维的标注信息，提升识别准确性。与传统的通过文字检测，文字识别再提取结构化信息的方法相比，本发明通过注词语的位置 来得到该词语中字符的位置，可实现少量额外标注量获取更多维的标注信息，所需标注工作量相差不大。并且本发明为单一模型方式，更加简单高效。本发明通过定义不同的卡证图片结构、定义输入提示词，根据输入卡证图片和提示词得到卡证结构化信息，直接实现端到端的卡证结构化信息提取，简洁高效；同时借助其他文本位置的监督信息辅助模型提取图片的多维信息，提升模型识别的准确率。本发明在简化卡证结构化信息提取的同时，增加多维度的字符级别以及词级别，再到图片级别的结构信息，提升识别效果。同时增加鲁棒的标签制作方式和训练方式，加强模型识别的鲁棒性。通过定义不同的卡证图片结构来区别不同的卡证结构，可实现一个模型适用多卡证结构。将卡证图片输入模型预测结果，可直接获取卡证结构化信息，同时也可获取其他额外的字符，词的位置，字符，词的内容以及图片结构，获取信息更加多样化。本发明的关键在于提出了图片的结构形式以及提示词来进行有监督的学习，直接实现端到端的结构化信息提取。附图说明通过附图中所示的本发明优选实施例更具体说明，本发明上述及其它目的、特征和优势将变得更加清晰。图1是本发明卡证结构化信息抽取模型的训练方法流程图；图2是本发明标注标签实例图；图3是本发明卡证结构化信息抽取模型训练流程图。具体实施方式下面结合附图和具体实施例对本发明技术方案作进一步的详细描述，以使本领域的技术人员可以更好的理解本发明并能予以实施，但所举实施例不作为对本发明的限定。本发明提供一种自动化的卡证结构化信息抽取技术方法，将卡证图片输入卡证结构化信息抽取模型中，根据输入的提示词得到卡证结构化信息，参见图1-3，卡证结构化信息抽取模型的训练方法包括如下步骤：S1、定义不同的卡证图片结构、定义输入提示词；卡证图片结构包括文本的行数、每行的词语数及每个词语的字符数，卡证图片结构为xml结构形式，采用xml的形式表示。本实施例定义卡证的图片形式有行，词语,字符。采用xml的形式表示，其中＜＞表示结构的开始，＜/＞表示结构的结束，＜ln＞表示第n行文字的开始，＜/ln＞表示第n行文字的结束，＜wn＞表示第n个词语的开始，＜cn＞表示第n个字符的开始。如：“＜l1＞＜w1＞＜c1＞＜/c1＞＜c2＞＜/c2＞＜/w1＞＜w2＞＜c1＞＜/c1＞＜c2＞＜/c2＞＜/w2＞＜/l1＞＜l2＞＜w1＞＜c1＞＜/c1＞＜c2＞＜/c2＞＜/w1＞＜w2＞＜c1＞＜/c1＞＜c2＞＜/c2＞＜/w2＞＜/l2＞”可以看出来其具有＜l1＞表示第1行开始，＜/l1＞表示第1行结束；＜l2＞表示第2行开始，＜/l2＞表示第2行结束。因此，此结构表示该图有两行文字。在＜l1＞和＜/l1＞之间为第1行，第1行中＜w1＞表示第1个词语开始，＜/w1＞表示第1个词语结束，同理，＜w2＞和＜/w2＞表示第2个词语，因此第1行中有2个词语。在＜l1＞＜w1＞和＜/w1＞＜/l1＞之间为第1行的第1个词语，第1行的第1个词语中＜c1＞表示第1个字符开始，＜/c1＞第1个字符结束，同理，＜c2＞＜/c2＞表示第2字符，因此第1行的第1个词语有2个字符。同理可以知道，第2行有2个词，每个词有2个字符。以该种形式表示图片结构可以表示任意一种卡证形式。本实施例中所指的提示词包括字符的位置、词语的位置、字符的识别结果、词语的识别结果、图像结构和提取的结构化信息。本发明定义了六类提示词：字符的位置，词语的位置，字符的识别结果,词语的识别结果,图像结构，提取的结构化信息。例如：当输入“position character ”表示提示模型输出第l行第w词第c字符的位置，其中l,w,c表示数字；“position word ”表示提示模型输出第l行第w词的位置；“recognize character ”表示提示模型输出第l行第w词第c字符的识别结果；“recognize word ”表示提示模型输出第l行第w词的识别结果；“structment”表示提示模型输出图像结构，“parsing”表示提示模型输出提取的结构化信息。S2、根据定义的卡证图片结构及卡输入提示词定义输出形式。输出形式包括输出对应字符位置信息、输出对应词语位置信息、输出识别得到的字符信息、识别得到的词语信息、输出xml结构形式、输出图像结构或输出提示词不存在。在此进行举例说明，当提示词为“字符的位置”，则输出对应字符位置信息，字符位置信息包括第l行，第w词、第c字符、左上角的坐标和右下角的坐标，其中l、w和c均为数字。如提示词为“position character”，则输出第2行第1个词的第4个字的位置，输出形式为“＜l2＞＜w1＞＜c4＞x1, y1, x2,y2＜c4＞＜w1＞＜l2＞”，其中x1,y1为左上角的坐标，x2和y2为右下角的坐标。当提示词为“词语的位置”，则输出对应词语位置信息，对应词语位置信息包括第l行、第w词、左上角的坐标和右下角的坐标。如提示词为“position word ”，则输出第2行第3个词的位置，输出形式为“＜l2＞＜w3＞x1, y1, x2,y2＜w3＞＜l2＞”，其中x1,y1为左上角的坐标，x2和y2为右下角的坐标。当提示词为“字符的识别结果”，则输出识别得到的字符信息。如提示词为“recognize character ”，则输出第2行第1个词的第四个字的字符，输出形式为“＜l2＞＜w1＞＜c4＞我＜c4＞＜w1＞＜l2＞ ”，其中示例“我”就是该位置下识别的字符。当提示词为“词语的识别结果” ，则输出识别得到的词语信息。如提示词为“recognize word ”，则输出第2行第3个词的字符，输出形式为“＜l2＞＜w3＞身份证号码＜w3＞＜l2＞”，其中示例”身份证号码”就是该位置下识别的词。当提示词为“提取的结构化信息”，则输出提取的结构化信息。如提示词为“parsing”，则输出类似“姓名:韦小宝,性别:男”。提示词为“图像结构”则输出定义的xml结构形式。如提示词为“structment”，则输出定义的xml结构形式，如＜l1＞…＜/l1＞＜l2＞…＜/l2＞，表示卡证有几行、每行有几个词，每个词有几个字符。若提示词中或者不存在，则输出形式“＜l2＞＜w3＞-999＜w3＞＜l2＞”，这里以-999表示不存在的提示词。S3、根据获取的卡证图片对卡证图片中每个词语的坐标的位置进行标注，根据词语的位置得到该词语中字符的坐标位置，得到待训练卡证结构化信息抽取模型。参见图2，本发明举一个身份证图片形式的例子，对身份证中每个词语的位置进行标注，没有对身份证中每个字符的位置进行标注。由于本方案定义了6种提示词，即模型需要根据提示词输出相应的结果。首先，只需要标注图片中每个词的位置，以及对应文本即可，如标注身份证＜x1,y1,x2,y2,身份证号码＞，＜x1,y1,x2,y2,5678910＞等等，其中x1,y1为左上角的坐标，x2和y2为右下角的坐标，标注的该词为身份证号码。接着，本方案提出无需标注的字符位置及文本标签获取，并增加鲁棒噪声提升样本的多样性。即标注主要集中在词的位置标注和词的文本标注。其中图片的结构标注，由于每种卡证的图片结构固定，只需要标注不同种类的卡证图片结构即可。针对结构化信息只需组合标注的文本即可，如{身份证号码：5678910}。根据标注后的词语坐标计算得到某个字符的位置。如果某个词由n个字符组成，其位置为，其中x1,y1为左上角的坐标，x2和y2为右下角的坐标。设某词语的位置为，x1，y1代表左上角的坐标，x2，y2为右下角的坐标，n为组成该词语的字符数，k为该词语中的第k个字符。该词语中字符的位置根据如下公式计算得到：,,根据如上公式计算得到该词语中第k个字符的位置。实现少量额外标注量获取更多维的标注信息，标注词可增加鲁棒性，若又要标注字，又要标注词工作量大。仅标注词就能得到字符的位置信息可 可增加鲁棒性。进一步，可以每次只选取其中一个增加噪声，α为噪声因子，每次随机值不超过限定的大小即可。若对kx1增加噪声因子，则得到最终第k个字符位置为；若对ky1增加噪声因子，则得到最终第k个字符位置为，若对kx2增加噪声因子，增加噪声因子，若对ky2增加噪声因子，则得到最终第k个字符位置为。当对kx1或kx2增加噪声因子时，噪声因子应满足如下条件：α＜1/6·。当对ky1或 ky2增加噪声因子时，噪声因子应满足如下条件：α＜1/6·。S4、对待训练卡证结构化信息抽取模型进行训练，得到最终卡证结构化信息抽取模型。参考图3，本实施例中构件的卡证结构化信息抽取模型包括编码器和解码器，构建卡证结构化信息抽取模型时，将编码器结果以及提示词输入解码器中，训练时解码器根据提示词输出相应的结果。图3把各个种类的提示词以及对应的回答都举例了，实际训练是根据不同的提示词分别进行训练。本实施例的卡证结构化信息抽取模型中图像的处理方法为：将图片分成固定大小的多块图片，经过线性变换再加上图像的位置编码，作为编码器模块的输入，编码器处理后输出处理后的图片。具体方法为：将图片分成固定大小的m*m的n块，经过线性变换，再加上图像的位置编码，作为编码器模块的输入。本方案中m为16，即以512*512的图片输入为例，我们一共可以得到16*16大小的1024块，其中，图片有3通道，因而每个图像块可以变为16*16*3=768的维度，最后图片可以转换为1024*768的大小，经过线性变换将维度转换为128维，即1024*128，再加上位置编码输入编码器，输入经过编码器r输出图片的特征。另外，图片特征输入到解码器内部，作为Multi-Head Attention的key和value进行运算。在优选实施例中，对卡证结构化信息抽取模型进行训练包括将训练图片输入模型，根据提示词来输出形式，针对每个卡证图，有6种提示词，以及该提示词下的标签，训练图片包括卡证的原图以及卡证字符被遮挡后的图片。其中，当训练图片为卡证字符被遮挡后的图片，训练时将被遮挡的字符替换成自定义字符，其他标注的标签不变，根据提示词得到输出形式。本发明提出了character mask prediction，我们对原图中每个词的随机某个字符进行遮挡，除了将被遮挡的字符替换为mask，其他标签不变，使得在有遮挡情况下的提示词为“position word”和“recognize word”两种情况下，输出仍然完整，即训练时输入有随机字符遮挡的图片，以及对应各提示词的标签进行训练。其中在整个数据集中，选取10%的图片进行遮挡，进行character mask prediction。本发明还提供一种自动化的卡证结构化信息抽取技术系统，包括卡证结构化信息抽取模型，卡证结构化信息抽取模型用于根据输入的卡证图片及提示词得到输出形式，卡证结构化信息抽取模型的训练方法包括如下步骤：S1、定义不同的卡证图片结构、定义输入提示词；S2、根据定义的卡证图片结构及输入提示词定义输出形式；S3、根据获取的卡证图片对卡证图片中每个词语的位置进行标注，根据词语的位置得到该词语中字符的位置，得到待训练卡证结构化信息抽取模型；S4、对待训练卡证结构化信息抽取模型进行训练，得到最终卡证结构化信息抽取模型。卡证结构化信息抽取模型的训练方法还包括上述任一项实施例提到的训练方法。模型框架除了transformer采用其他encoder-decoder形式的框架也可以实现该方案。以上仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
