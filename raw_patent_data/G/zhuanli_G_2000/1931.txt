标题title
不依靠仪器间接测量DTC步进的方法、系统、设备及介质
摘要abst
本发明公开了一种不依靠仪器间接测量DTC步进的方法、系统、设备及介质，其中方法包括：频率调整：通过频率控制字调整数字时间转换器DTC输出的频率为预设频率值；开环控制：当数字时间转换器DTC所在的锁相环电路锁定到预设频率值之后，将锁相环电路开环并停止更新；数据采集：当采集到某段数据中同时存在时间数字转换器TDC和数字时间转换器DTC的码值变化且变化均连续时，记录码值变化值；步进计算：基于时间数字转换器TDC的码值变化所对应的时间变化等于数字时间转换器DTC的真实步进值与设置步进值的差值带来的时间变化，计算数字时间转换器DTC真实步进值。本发明可在没有仪器的情况下较为准确地测量到DTC真实步进值。
权利要求书clms
1.一种不依靠仪器间接测量DTC步进的方法，其特征在于，包括：频率调整：通过频率控制字调整数字时间转换器DTC输出的频率为预设频率值；开环控制：当数字时间转换器DTC所在的锁相环电路锁定到预设频率值之后，将锁相环电路开环并停止更新；数据采集：通过数字时间转换器DTC延迟参考时钟，再通过时间数字转换器TDC测量参考时钟与数控振荡器的输出时钟的上升沿之间的延迟值；当采集到某段数据中既存在时间数字转换器TDC的码值变化，又存在数字时间转换器DTC的码值变化，且两个码值的变化均连续时，记录码值变化值；步进计算：由于数字时间转换器DTC的真实步进值与设置步进值存在差异，并导致时间数字转换器TDC的码值变化，故时间数字转换器TDC的码值变化所对应的时间变化等于数字时间转换器DTC的真实步进值与设置步进值的差值带来的时间变化，从而计算出数字时间转换器DTC的真实步进值。2.根据权利要求1所述的不依靠仪器间接测量DTC步进的方法，其特征在于，所述预设频率值为小数部分接近但不等于零的数值。3.根据权利要求1所述的不依靠仪器间接测量DTC步进的方法，其特征在于，所述数据采集中，记录的码值变化值包括同样起始和结束位置的数字时间转换器DTC和时间数字转换器TDC的码值。4.根据权利要求1所述的不依靠仪器间接测量DTC步进的方法，其特征在于，所述步进计算中，数字时间转换器DTC带来的延迟δT_tdc与时间数字转换器TDC测量的延迟δT_dtc存在数值相等且符号相反的关系，即：-δT_tdc=δT_dtc式中：δT_tdc=TDC_step*δT_dtc=*其中，TDC_step为时间数字转换器TDC的真实步进值，TDC_code_start和TDC_code_stop分别为同样起始和结束位置的时间数字转换器TDC的码值；DTC_step和kdtc_step分别为数字时间转换器DTC的真实步进值和设置步进值，DTC_code_start和DTC_code_stop分别为同样起始和结束位置的数字时间转换器DTC的码值；从而推导出数字时间转换器DTC的真实步进值：DTC_step=kdtc_step-/)*TDC_step。5.一种不依靠仪器间接测量DTC步进的系统，其特征在于，包括：频率调整模块，被配置为通过频率控制字调整数字时间转换器DTC输出的频率为预设频率值；开环控制模块，被配置为在数字时间转换器DTC所在的锁相环电路锁定到预设频率值之后，将锁相环电路开环并停止更新；数据采集模块，被配置为通过数字时间转换器DTC延迟参考时钟，再通过时间数字转换器TDC测量参考时钟与数控振荡器的输出时钟的上升沿之间的延迟值；当采集到某段数据中既存在时间数字转换器TDC的码值变化，又存在数字时间转换器DTC的码值变化，且两个码值的变化均连续时，记录码值变化值；步进计算模块，被配置为基于时间数字转换器TDC的码值变化所对应的时间变化等于数字时间转换器DTC的真实步进值与设置步进值的差值带来的时间变化，计算出数字时间转换器DTC的真实步进值。6.根据权利要求5所述的不依靠仪器间接测量DTC步进的系统，其特征在于，所述预设频率值为小数部分接近但不等于零的数值。7.根据权利要求5所述的不依靠仪器间接测量DTC步进的系统，其特征在于，所述数据采集模块中，记录的码值变化值包括同样起始和结束位置的数字时间转换器DTC和时间数字转换器TDC的码值。8.根据权利要求5所述的不依靠仪器间接测量DTC步进的系统，其特征在于，所述步进计算模块中，数字时间转换器DTC带来的延迟δT_tdc与时间数字转换器TDC测量的延迟δT_dtc存在数值相等且符号相反的关系，即：-δT_tdc=δT_dtc式中：δT_tdc=TDC_step*δT_dtc=*其中，TDC_step为时间数字转换器TDC的真实步进值，TDC_code_start和TDC_code_stop分别为同样起始和结束位置的时间数字转换器TDC的码值；DTC_step和kdtc_step分别为数字时间转换器DTC的真实步进值和设置步进值，DTC_code_start和DTC_code_stop分别为同样起始和结束位置的数字时间转换器DTC的码值；从而推导出数字时间转换器DTC的真实步进值：DTC_step=kdtc_step-/)*TDC_step。9.一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1-4任一项所述的不依靠仪器间接测量DTC步进的方法。10.一种计算机可读存储介质，存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1-4任一项所述的不依靠仪器间接测量DTC步进的方法。
说明书desc
技术领域本发明涉及电数字数据处理技术领域，尤其涉及一种不依靠仪器间接测量DTC步进的方法、系统、设备及介质。背景技术ADPLL电路中，会采用TDC测量相位差，而为了优化ADPLL的功耗，则会采用DTC+TDC的方法来降低功耗和提高性能，通过DTC延迟参考时钟以后，再用TDC测量参考时钟与DCO输出时钟的上升沿之间的延迟差来计算两个时钟之间的相位差。由于DTC的DTC_step难以测量，当其与设计的目标值相差较大时，难以定位芯片问题。一般会使用示波器观测DTC延迟之后的参考时钟的上升沿变化来测量DTC_step，而当缺少示波器等仪器时，DTC_step基本无法测量，影响芯片的问题定位。发明内容为了解决上述问题，本发明提出一种不依靠仪器间接测量DTC步进的方法、系统、设备及介质，通过设计用例和数据采集的方式计算出步进DTC_step的大小。本发明采用的技术方案如下：一种不依靠仪器间接测量DTC步进的方法，包括：频率调整：通过频率控制字调整数字时间转换器DTC输出的频率为预设频率值；开环控制：当数字时间转换器DTC所在的锁相环电路锁定到预设频率值之后，将锁相环电路开环并停止更新；数据采集：通过数字时间转换器DTC延迟参考时钟，再通过时间数字转换器TDC测量参考时钟与数控振荡器的输出时钟的上升沿之间的延迟值；当采集到某段数据中既存在时间数字转换器TDC的码值变化，又存在数字时间转换器DTC的码值变化，且两个码值的变化均连续时，记录码值变化值；步进计算：由于数字时间转换器DTC的真实步进值与设置步进值存在差异，并导致时间数字转换器TDC的码值变化，故时间数字转换器TDC的码值变化所对应的时间变化等于数字时间转换器DTC的真实步进值与设置步进值的差值带来的时间变化，从而计算出数字时间转换器DTC的真实步进值。进一步地，所述预设频率值为小数部分接近但不等于零的数值。进一步地，所述数据采集中，记录的码值变化值包括同样起始和结束位置的数字时间转换器DTC和时间数字转换器TDC的码值。进一步地，所述步进计算中，数字时间转换器DTC带来的延迟δT_tdc与时间数字转换器TDC测量的延迟δT_dtc存在数值相等且符号相反的关系，即：-δT_tdc=δT_dtc式中：δT_tdc=TDC_step*δT_dtc=*其中，TDC_step为时间数字转换器TDC的真实步进值，TDC_code_start和TDC_code_stop分别为同样起始和结束位置的时间数字转换器TDC的码值；DTC_step和kdtc_step分别为数字时间转换器DTC的真实步进值和设置步进值，DTC_code_start和DTC_code_stop分别为同样起始和结束位置的数字时间转换器DTC的码值；从而推导出数字时间转换器DTC的真实步进值：DTC_step=kdtc_step-/)*TDC_step。一种不依靠仪器间接测量DTC步进的系统，包括：频率调整模块，被配置为通过频率控制字调整数字时间转换器DTC输出的频率为预设频率值；开环控制模块，被配置为在数字时间转换器DTC所在的锁相环电路锁定到预设频率值之后，将锁相环电路开环并停止更新；数据采集模块，被配置为通过数字时间转换器DTC延迟参考时钟，再通过时间数字转换器TDC测量参考时钟与数控振荡器的输出时钟的上升沿之间的延迟值；当采集到某段数据中既存在时间数字转换器TDC的码值变化，又存在数字时间转换器DTC的码值变化，且两个码值的变化均连续时，记录码值变化值；步进计算模块，被配置为基于时间数字转换器TDC的码值变化所对应的时间变化等于数字时间转换器DTC的真实步进值与设置步进值的差值带来的时间变化，计算出数字时间转换器DTC的真实步进值。进一步地，所述预设频率值为小数部分接近但不等于零的数值。进一步地，所述数据采集模块中，记录的码值变化值包括同样起始和结束位置的数字时间转换器DTC和时间数字转换器TDC的码值。进一步地，所述步进计算模块中，数字时间转换器DTC带来的延迟δT_tdc与时间数字转换器TDC测量的延迟δT_dtc存在数值相等且符号相反的关系，即：-δT_tdc=δT_dtc式中：δT_tdc=TDC_step*δT_dtc=*其中，TDC_step为时间数字转换器TDC的真实步进值，TDC_code_start和TDC_code_stop分别为同样起始和结束位置的时间数字转换器TDC的码值；DTC_step和kdtc_step分别为数字时间转换器DTC的真实步进值和设置步进值，DTC_code_start和DTC_code_stop分别为同样起始和结束位置的数字时间转换器DTC的码值；从而推导出数字时间转换器DTC的真实步进值：DTC_step=kdtc_step-/)*TDC_step。一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，其特征在于，所述处理器执行所述计算机程序时实现上述不依靠仪器间接测量DTC步进的方法。一种计算机可读存储介质，存储有计算机程序，所述计算机程序被处理器执行时实现上述不依靠仪器间接测量DTC步进的方法。本发明的有益效果在于：本发明可以在没有仪器的情况下较为准确地测量到数字时间转换器DTC的真实步进值DTC_step，受到噪声影响较小，多次测量取均值更为精确。本发明实现过程中的依赖条件少，不需要额外的资源/功耗/设备等，测量方法简单可靠。附图说明图1是本发明实施例1的不依靠仪器间接测量DTC步进的方法流程图。具体实施方式为了对本发明的技术特征、目的和效果有更加清楚的理解，现说明本发明的具体实施方式。应当理解，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明，即所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明的实施例，本领域技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例1如图1所示，本实施例提供了一种不依靠仪器间接测量DTC步进的方法，包括：频率调整：通过FCW调整DTC输出的频率为预设频率值。开环控制：当数字时间转换器DTC所在的锁相环电路锁定到预设频率值之后，将锁相环电路开环并停止更新，此时整个环路处于开环状态且输出频率较准确。数据采集：通过数字时间转换器DTC延迟参考时钟，再通过TDC测量参考时钟与数控振荡器的输出时钟的上升沿之间的延迟值；当采集到某段数据中既存在时间数字转换器TDC的码值变化，又存在数字时间转换器DTC的码值变化，且两个码值的变化均连续时，记录码值变化值。步进计算：由于数字时间转换器DTC的真实步进值与设置步进值存在差异，并导致时间数字转换器TDC的码值变化，故时间数字转换器TDC的码值变化所对应的时间变化等于数字时间转换器DTC的真实步进值与设置步进值的差值带来的时间变化，从而计算出数字时间转换器DTC的真实步进值。优选地，该预设频率值为小数部分接近但不等于零的数值，其目的是让数字时间转换DTC输出的值变化较小。优选地，该数据采集中，记录的码值变化值包括同样起始和结束位置的数字时间转换器DTC和时间数字转换器TDC的码值。这里取一段数据的均值是为了降低噪声带来的变化，让计算结果更精确。优选地，该步进计算中，数字时间转换器DTC带来的延迟δT_tdc与时间数字转换器TDC测量的延迟δT_dtc存在数值相等且符号相反的关系，即：-δT_tdc=δT_dtc式中：δT_tdc=TDC_step*δT_dtc=*其中，TDC_step为时间数字转换器TDC的真实步进值，TDC_code_start和TDC_code_stop分别为同样起始和结束位置的时间数字转换器TDC的码值；DTC_step和kdtc_step分别为数字时间转换器DTC的真实步进值和设置步进值，DTC_code_start和DTC_code_stop分别为同样起始和结束位置的数字时间转换器DTC的码值；从而推导出数字时间转换器DTC的真实步进值：DTC_step=kdtc_step-/)*TDC_step。本测量方法不依靠仪器，可以在没有仪器的情况下较为准确地测量到真实的DTC_step值，受到噪声影响较小，多次测量取均值更为精确。实施例2本实施例在实施例1的基础上：本实施例提供了一种不依靠仪器间接测量DTC步进的方法，包括以下步骤：首先将FCW设置为100.01这种小数值比较接近整数的数字，设置这种FCW的目的是让数字时间转换器DTC输出的值变化较小。其次将ADPLL锁定到对应频率之后，将环路开环，让环路不更新，整个环路处于开环状态且输出频率较准确。此时进行数据采集，当采集到的某一段数据，既有TDC码值的变化，又有DTC码值的变化，且两个码值的变化均连续时，将同样起始和结束位置的DTC码值和TDC码值分别记录为：DTC_code_start/DTC_code_stop/TDC_code_start/TDC_code_stop环路中设置的DTC延迟值记为kdtc_step，TDC每个code的延迟值记为TDC_step，DTC每个code的真实延迟值记为DTC_step。由于通过DTC code值带来的变化值会被TDC测量出来，因此在时间上两者是相等的关系，但是由于DTCcode带来的延迟会是TDCcode上的提前，因此两者符号相反，有：-δT_tdc=δT_dtc其中：δT_tdc=*TDC_stepδT_dtc=DTC的真实相位差-kdtc_step带来的相位差=DTC_step*-kdtc_step*。所以有：-*TDC_step=DTC_step*-kdtc_step*=*。最后得到真实延迟值：DTC_step=kdtc_step-/)*TDC_step。当环路锁定后且没有频偏时，TDC的码值应该保持不变，该TDC码值不变的前提是DTC通过DTC的码值延迟参考时钟之后，参考时钟和DCO输出时钟的上升沿对齐。但是由于设置的kdtc_step与真实的DTC_step有差异，因此这个差异会导致TDC码值变化，所以TDC测量到的码值变化所对应的时间变化即为设置的kdtc_step与真实的DTC_step的差值在这一段的DTC码值的差值上带来的时间变化。这里取一段数据的均值是为了降低噪声带来的变化，让计算结果更精确。实施例3本实施例提供了一种不依靠仪器间接测量DTC步进的系统，包括频率调整模块、开环控制模块、数据采集模块和步进计算模块，其中：频率调整模块被配置为通过频率控制字调整数字时间转换器DTC输出的频率为预设频率值。开环控制模块被配置为在数字时间转换器DTC所在的锁相环电路锁定到预设频率值之后，将锁相环电路开环并停止更新，此时整个环路处于开环状态且输出频率较准确。数据采集模块被配置为通过数字时间转换器DTC延迟参考时钟，再通过时间数字转换器TDC测量参考时钟与数控振荡器的输出时钟的上升沿之间的延迟值；当采集到某段数据中既存在时间数字转换器TDC的码值变化，又存在数字时间转换器DTC的码值变化，且两个码值的变化均连续时，记录码值变化值。步进计算模块被配置为基于时间数字转换器TDC的码值变化所对应的时间变化等于数字时间转换器DTC的真实步进值与设置步进值的差值带来的时间变化，计算出数字时间转换器DTC的真实步进值。优选地，该预设频率值为小数部分接近但不等于零的数值，其目的是让数字时间转换DTC输出的值变化较小。优选地，该数据采集模块中，记录的码值变化值包括同样起始和结束位置的数字时间转换器DTC和时间数字转换器TDC的码值。这里取一段数据的均值是为了降低噪声带来的变化，让计算结果更精确。优选地，该步进计算模块中，数字时间转换器DTC带来的延迟δT_tdc与时间数字转换器TDC测量的延迟δT_dtc存在数值相等且符号相反的关系，即：-δT_tdc=δT_dtc式中：δT_tdc=TDC_step*δT_dtc=*其中，TDC_step为时间数字转换器TDC的真实步进值，TDC_code_start和TDC_code_stop分别为同样起始和结束位置的时间数字转换器TDC的码值；DTC_step和kdtc_step分别为数字时间转换器DTC的真实步进值和设置步进值，DTC_code_start和DTC_code_stop分别为同样起始和结束位置的数字时间转换器DTC的码值；从而推导出数字时间转换器DTC的真实步进值：DTC_step=kdtc_step-/)*TDC_step。实施例4本实施例在实施例1的基础上：本实施例提供了一种计算机设备，包括存储器和处理器，该存储器存储有计算机程序，该处理器执行该计算机程序时实现实施例1的不依靠仪器间接测量DTC步进的方法。其中，计算机程序可以为源代码形式、对象代码形式、可执行文件或者某些中间形式等。实施例5本实施例在实施例1的基础上：本实施例提供了一种计算机可读存储介质，存储有计算机程序，该计算机程序被处理器执行时实现实施例1的不依靠仪器间接测量DTC步进的方法。其中，计算机程序可以为源代码形式、对象代码形式、可执行文件或者某些中间形式等。存储介质包括：能够携带计算机程序代码的任何实体或装置、记录介质、计算机存储器、只读存储器、随机存取存储器、电载波信号、电信信号以及软件分发介质等。需要说明的是，存储介质包含的内容可以根据司法管辖区内立法和专利实践的要求进行适当的增减，例如在某些司法管辖区，根据立法和专利实践，存储介质不包括电载波信号和电信信号。需要说明的是，对于前述的方法实施例，为了简便描述，故将其表述为一系列的动作组合，但是本领域技术人员应该知悉，本申请并不受所描述的动作顺序的限制，因为依据本申请，某些步骤可以采用其他顺序或者同时进行。其次，本领域技术人员也应该知悉，说明书中所描述的实施例均属于优选实施例，所涉及的动作和模块并不一定是本申请所必须的。
