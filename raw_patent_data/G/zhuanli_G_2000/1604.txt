标题title
一种基于ST-Transformer模型的短期负荷预测方法及系统
摘要abst
本发明公开了一种基于ST‑Transformer模型的短期负荷预测方法及系统，方法包括：将第一训练数据组和第二训练数据组输入至预设的ST‑Transformer模型中，并分别经过编码和解码输出当前的预测值；基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新ST‑Transformer模型的超参数以得到预测值和真实值的最小误差；将与最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST‑Transformer模型；将待预测区域的实时目标数据输入至目标ST‑Transformer模型中，得到目标ST‑Transformer模型输出的短期负荷预测值。能够更好地捕捉时序数据中的长距离时间依赖关系，从而得到更准确的负荷预测结果。
权利要求书clms
1.一种基于ST-Transformer模型的短期负荷预测方法，其特征在于，包括：获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集；将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络；基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差；将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型；将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。2.根据权利要求1所述的一种基于ST-Transformer模型的短期负荷预测方法，其特征在于，所述获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集包括：获取待预测区域的历史时期n个时间节点的电力负荷数据和与所述电力负荷数据相对应的相关数据，所述相关数据包括对n个时间节点的电力负荷数据造成影响的气象数据、时间日期属性数据和行业负荷数据；将每个时点的电力负荷数据和与所述电力负荷数据相对应的相关数据合并构成一组数据向量，/＞为第/＞组数据向量，/＞为每小时最大电力负荷，/＞为相关数据；将各组数据向量构造为样本数据集。3.根据权利要求1所述的一种基于ST-Transformer模型的短期负荷预测方法，其特征在于，所述将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值包括：将所述训练数据集划分为第一训练数据组和第二训练数据组；将所述第一训练数据组输入至预设的ST-Transformer模型中，通过长期空间卷积网络将所述第一训练数据组中的各组数据向量进行特征融合，通过赋权多层神经网络得到新的隐藏层，将提取的隐藏特征H1输入长期时间位置编码模块，根据时间的周期性和连续性进行相似性比较，并进行分组融合得到分组后的时间位置分组特征向量J1以及与时间位置分组特征向量J1对应的自注意力权重W1，并将隐藏特征H1、时间位置分组特征向量J1以及自注意力权重W1输入长期时空融合网络，采用GCN算法融合得到长期记忆层 L；将所述第二训练数据组输入至预设的ST-Transformer模型中，通过短期空间卷积网络将所述第二训练数据组中的各组数据向量进行特征融合，通过赋权多层神经网络得到新的隐藏层，将提取的隐藏特征H2输入短期时间位置编码模块，根据时间的周期性和连续性进行相似性比较，并进行分组融合得到分组后的时间位置分组特征向量J2以及与时间位置分组特征向量J2对应的自注意力权重W2；并将隐藏特征H2、时间位置分组特征向量J2、自注意力权重W2以及长期记忆层 L输入短期时空融合网络，短期时空融合网络输出得到当前的预测值。4.根据权利要求1所述的一种基于ST-Transformer模型的短期负荷预测方法，其特征在于，在将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型之后，所述方法还包括：将所述测试数据集中的各个测试数据输入至所述目标ST-Transformer模型中，得到测试结果。5.一种基于ST-Transformer模型的短期负荷预测系统，其特征在于，包括：获取模块，配置为获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集；第一输出模块，配置为将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络；更新模块，配置为基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差；确定模块，配置为将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型；第二输出模块，将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。6.一种电子设备，其特征在于，包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1至4任一项所述的方法。7.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述程序被处理器执行时实现权利要求1至4任一项所述的方法。
说明书desc
技术领域本发明属于短期电力负荷预测技术领域，尤其涉及一种基于ST-Transformer模型的短期负荷预测方法及系统。背景技术随终端消费电气化水平逐步提升，部分地区电力供需形势日趋紧张，在此情形下，根据电力负荷预测对未来电力供应形势进行分析预判，及时采用临时购电、需求响应等保供措施成为保障电网高效、安全、稳定运行以及民生用电需求的关键，因此对负荷预测的精度也提出更高要求，需同时考虑节假日、不同时期的气象等多时间尺度，以及各地区生产总值、人口数量、地域面积等多空间维度的影响因素。目前人工智能算法由于本身具有较强非线性数据的拟合能力，随机森林RF、BP神经网络、长短时记忆神经网络、支持向量机，最小二乘支持向量机等预测算法逐步得到应用，但以上算法模型对于数据中的长期依赖特征无法很好地提取，在处理较长周期负荷影响时，其性能表现仍有进一步的提升空间，同时并行计算能力较弱，但是无法进行长时间维度的特征提取。发明内容本发明提供一种基于ST-Transformer模型的短期负荷预测方法、系统及可读存储介质，用于解决无法进行长时间维度的特征提取的技术问题。第一方面，本发明提供一种基于ST-Transformer模型的短期负荷预测方法，包括：获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集；将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络；基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差；将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型；将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。第二方面，本发明提供一种基于ST-Transformer模型的短期负荷预测系统，包括：获取模块，配置为获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集；第一输出模块，配置为将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络；更新模块，配置为基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差；确定模块，配置为将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型；第二输出模块，将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。第三方面，提供一种电子设备，其包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行本发明任一实施例的基于ST-Transformer模型的短期负荷预测方法的步骤。第四方面，本发明还提供一种计算机可读存储介质，其上存储有计算机程序，所述程序指令被处理器执行时，使所述处理器执行本发明任一实施例的基于ST-Transformer模型的短期负荷预测方法的步骤。本申请的基于ST-Transformer模型的短期负荷预测方法及系统，具有以下有益效果：考虑历史负荷时间特性以及空间特性，通过空间卷积网络对负荷空间分布进行特征提取，通过时间分组自注意力融合模块计算注意力权重，在每个时间步骤上自适应地对负荷时间特征进行分组赋权，从而更好地捕捉时序数据中的长距离时间依赖关系，从而得到更准确的负荷预测结果。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例描述中所需要使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一实施例提供的一种基于ST-Transformer模型的短期负荷预测方法的流程图；图2为本发明一实施例提供一个具体实施例的基于ST-Transformer模型的短期负荷预测结果示意图；图3为本发明一实施例提供的一种基于ST-Transformer模型的短期负荷预测系统的结构框图；图4是本发明一实施例提供的电子设备的结构示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。请参阅图1，其示出了本申请的一种基于ST-Transformer模型的短期负荷预测方法的流程图。如图1所示，基于ST-Transformer模型的短期负荷预测方法具体包括以下步骤：步骤S101，获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集。在本步骤中，获取待预测区域的历史时期n个时间节点的电力负荷数据和与电力负荷数据相对应的相关数据，相关数据包括对n个时间节点的电力负荷数据造成影响的气象数据、时间日期属性数据和行业负荷数据；将每个时点的电力负荷数据和与电力负荷数据相对应的相关数据合并构成一组数据向量，/＞为第/＞组数据向量，/＞为每小时最大电力负荷，/＞为相关数据；将各组数据向量构造为样本数据集。需要说明的是，将样本数据集划分为训练数据集和测试数据集。其中样本数据集前90%的数据作为训练数据集，后10%的数据作为测试数据集。步骤S102，将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络。在本步骤中，将训练数据集划分为第一训练数据组和第二训练数据组；将第一训练数据组输入至预设的ST-Transformer模型中，通过长期空间卷积网络将第一训练数据组中的各组数据向量进行特征融合，通过赋权多层神经网络得到新的隐藏层，将提取的隐藏特征H1输入长期时间位置编码模块，根据时间的周期性和连续性进行相似性比较，并进行分组融合得到分组后的时间位置分组特征向量J1以及与时间位置分组特征向量J1对应的自注意力权重W1，并将隐藏特征H1、时间位置分组特征向量J1以及自注意力权重W1输入长期时空融合网络，采用GCN算法融合得到长期记忆层 L；将第二训练数据组输入至预设的ST-Transformer模型中，通过短期空间卷积网络将第二训练数据组中的各组数据向量进行特征融合，通过赋权多层神经网络得到新的隐藏层，将提取的隐藏特征H2输入短期时间位置编码模块，根据时间的周期性和连续性进行相似性比较，并进行分组融合得到分组后的时间位置分组特征向量J2以及与时间位置分组特征向量J2对应的自注意力权重W2；并将隐藏特征H2、时间位置分组特征向量J2、自注意力权重W2以及长期记忆层 L输入短期时空融合网络，短期时空融合网络输出得到当前的预测值。步骤S103，基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差。步骤S104，将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型。在本步骤中，需确定的超参数包括：历史样本数量n，编码器和解码器的层数和节点数，长期时间分组自注意力融合模块的聚合类数。需要说明的是，历史样本数量n实际实验中可选用预测日前3天、7天以及10天每天24小时的数据。编码器和解码器的层数和节点数可选用1层64节点、2层64-32节点以及3层64-32-8进行效果比对。采用平均绝对误差和平均绝对误差百分比评价选择超参数，确定具体过程如下：输入历史序列数据包含数量n。测试前3天、7天以及10天每天24小时的数据。采用平均绝对误差和平均绝对误差百分比评价模型性能，根据实验结果，选择7天、前168个小时的历史数据作为模型输入最佳。计算MAE和MAPE的结果如表1。，编码器和解码器的层数和节点数选用1层64节点、2层64-32节点以及3层64-32-8进行实验对比。其中2层，64和32 个节点作为空间卷积网络效果最佳。，针对长期时间分组自注意力融合模块聚合类别，分别实验了16，8和4类三种情况，根据仿真结果，如表3，选择8类效果最佳。，选完超参数后，固定超参数，得到最终的训练模型。在测试数据集上得到测试结果。在同样的设置下对比了随机森林 RF，RNN，LSTM 模型。从图2中可以看到，基于ST-Transformer模型的短期负荷预测方法输出结果与实际数据具有较高吻合度。从平均绝对误差和平均绝对误差百分比看，考虑时段划分的多组PSO-LSSVM模型短期电力负荷预测方法在平均绝对误差和平均绝对误差百分比结果上都优于对照组随机森林 RF，RNN， LSTM 模型。步骤S105，将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。综上，本申请的方法，考虑历史负荷时间特性以及空间特性，通过空间卷积网络对负荷空间分布进行特征提取，通过时间分组自注意力融合模块计算注意力权重，在每个时间步骤上自适应地对负荷时间特征进行分组赋权，从而更好地捕捉时序数据中的长距离时间依赖关系，从而得到更准确的负荷预测结果。请参阅图3，其示出了本申请的一种基于ST-Transformer模型的短期负荷预测系统的结构框图。如图3所示，短期负荷预测系统200，包括获取模块210、第一输出模块220、更新模块230、确定模块240以及第二输出模块250。其中，获取模块210，配置为获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集；第一输出模块220，配置为将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络；更新模块230，配置为基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差；确定模块240，配置为将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型；第二输出模块250，将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。应当理解，图3中记载的诸模块与参考图1中描述的方法中的各个步骤相对应。由此，上文针对方法描述的操作和特征以及相应的技术效果同样适用于图3中的诸模块，在此不再赘述。在另一些实施例中，本发明实施例还提供了一种计算机可读存储介质，其上存储有计算机程序，所述程序指令被处理器执行时，使所述处理器执行上述任意方法实施例中的基于ST-Transformer模型的短期负荷预测方法；作为一种实施方式，本发明的计算机可读存储介质存储有计算机可执行指令，计算机可执行指令设置为：获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集；将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络；基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差；将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型；将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。计算机可读存储介质可以包括存储程序区和存储数据区，其中，存储程序区可存储操作系统、至少一个功能所需要的应用程序；存储数据区可存储根据基于ST-Transformer模型的短期负荷预测系统的使用所创建的数据等。此外，计算机可读存储介质可以包括高速随机存取存储器，还可以包括存储器，例如至少一个磁盘存储器件、闪存器件、或其他非易失性固态存储器件。在一些实施例中，计算机可读存储介质可选包括相对于处理器远程设置的存储器，这些远程存储器可以通过网络连接至基于ST-Transformer模型的短期负荷预测系统。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。图4是本发明实施例提供的电子设备的结构示意图，如图4所示，该设备包括：一个处理器310以及存储器320。电子设备还可以包括：输入装置330和输出装置340。处理器310、存储器320、输入装置330和输出装置340可以通过总线或者其他方式连接，图4中以通过总线连接为例。存储器320为上述的计算机可读存储介质。处理器310通过运行存储在存储器320中的非易失性软件程序、指令以及模块，从而执行服务器的各种功能应用以及数据处理，即实现上述方法实施例基于ST-Transformer模型的短期负荷预测方法。输入装置330可接收输入的数字或字符信息，以及产生与基于ST-Transformer模型的短期负荷预测系统的用户设置以及功能控制有关的键信号输入。输出装置340可包括显示屏等显示设备。上述电子设备可执行本发明实施例所提供的方法，具备执行方法相应的功能模块和有益效果。未在本实施例中详尽描述的技术细节，可参见本发明实施例所提供的方法。作为一种实施方式，上述电子设备应用于基于ST-Transformer模型的短期负荷预测系统中，用于客户端，包括：至少一个处理器；以及，与至少一个处理器通信连接的存储器；其中，存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够：获取待预测区域不同历史时刻的目标数据，并根据所述目标数据构造样本数据集，所述样本数据集中包含训练数据集和测试数据集；将所述训练数据集划分为第一训练数据组和第二训练数据组，并将所述第一训练数据组和所述第二训练数据组输入至预设的ST-Transformer模型中，并分别经过编码和解码输出当前的预测值，其中，所述ST-Transformer模型中包含编码器和解码器，所述编码器中包含长期空间卷积网络、长期时间分组自注意力融合模块以及长期时空融合网络，所述解码器中包含短期空间网络、短期时间分组自注意力融合模块以及短期时空融合网络；基于预设的损失函数计算当前的预测值和真实值的误差，并基于自适应动量随机优化方法更新所述ST-Transformer模型的超参数以得到预测值和真实值的最小误差；将与所述最小误差对应的超参数作为最优超参数，并得到最优超参数下的目标ST-Transformer模型；将待预测区域的实时目标数据输入至所述目标ST-Transformer模型中，得到所述目标ST-Transformer模型输出的短期负荷预测值。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到各实施方式可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在计算机可读存储介质中，如ROM/RAM、磁碟、光盘等，包括若干指令用以使得一台计算机设备执行各个实施例或者实施例的某些部分的方法。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
