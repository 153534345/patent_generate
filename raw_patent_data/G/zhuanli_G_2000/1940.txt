标题title
一种适应高海况的北斗三号捕获跟踪方法
摘要abst
本发明涉及电变量的测量技术领域，尤其涉及一种适应高海况的北斗三号捕获跟踪方法，包括如下步骤：获得卫星信号入射到天线口面的俯仰角和方位角信息，再以惯导提供的航向角、俯仰角和横滚角作为天线姿态约束条件，计算卫星相对于天线口面的俯仰角和方位角，并建立导向矢量；基于线性约束最小方差准则计算自适应滤波权值矢量；根据自适应滤波权值矢量切换调整波束形成的权值，实现波束指向的自适应调整，让波束重新对准目标卫星；采用二阶FLL锁频辅助三阶PLL锁相信号进行快速的频率锁定及稳定的相位跟踪。本发明提供的方法可以实现高海况下船用北斗三号接收机稳定工作，保证高海况北斗三号信号的稳定跟踪。
权利要求书clms
1.一种适应高海况的北斗三号捕获跟踪方法，其特征在于，包括如下步骤：S1：通过卫导接收机解算卫星来向信息，获得卫星信号入射到天线口面的俯仰角和方位角，并以惯导系统提供的航向角、俯仰角和横滚角信息作为天线姿态约束条件，计算卫星相对于天线口面的俯仰角和方位角，并建立导向矢量；S2：基于线性约束最小方差准则计算自适应滤波权值矢量；S3：根据计算出的自适应滤波权值矢量，切换调整波束形成的权值，实现波束指向的自适应调整，让波束重新对准目标卫星；S4：采用二阶FLL锁频辅助三阶PLL锁相信号进行快速的频率锁定及稳定的相位跟踪。2.根据权利要求1所述的一种适应高海况的北斗三号捕获跟踪方法，其特征在于，步骤S1中计算卫星相对于天线口面的俯仰角和方位角，并建立导向矢量包括如下步骤：S11：先根据式计算ECEF地心坐标系下天线到卫星的方向余弦矢量：；其中：为通过卫导接收机解算提供的卫星来向信息获得的卫星信号入射到天线口面的俯仰角，/＞为通过卫导接收机解算提供的卫星来向信息获得的卫星信号入射到天线口面的方位角；S12：根据式将ECEF地心坐标系下天线到卫星的方向余弦矢量转换到NEU站点坐标系中得到NEU站点坐标系下天线到卫星的方向余弦矢量/＞：；其中：R为ECEF地心坐标系到NEU站点坐标系的旋转矩阵；S13：根据式计算得到从NEU站点坐标系到载体坐标系的旋转矩阵；；其中为惯导输出的俯仰角，/＞为惯导输出的方位角，/＞为惯导输出的横滚角；S14：根据式计算导向矢量：；其中：表示导向矢量在东向的分量，/＞表示导向矢量在北向的分量，/＞表示导向矢量在天向的分量。3.根据权利要求1所述的一种适应高海况的北斗三号捕获跟踪方法，其特征在于，步骤S2中基于线性约束最小方差准则计算自适应滤波权值矢量包括如下步骤：S21.将下变频信号分割为多个子频带，对多个子频带按照式进行功率统计：；其中：为采样点数，N为统计点数，/＞为统计周期内第/＞个采样点的输入信号值，/＞为每个子频带的平均功率；S22.根据式进行计算，在期望信号方向增益为固定值前提下使阵列输出信号功率最低：；其中：表示阵列输出的功率，/＞表示形成波束的频域数据，/＞是待求的权矢量，H表示矩阵的共轭转置，/＞表示待求的权矢量的共轭转置，/＞表示输出功率最小时待求的权矢量，/＞是期望信号的空域导向矢量；S23.对式构造拉格朗日函数为式，并对式求导得到式，根据式得到自适应滤波权值矢量：；；其中：为拉格朗日系数，/＞表示线性约束的代价，/＞表示输入信号协方差矩阵，，/＞为自适应滤波权值矢量，/＞表示采样时刻，/＞表示快拍数。4.根据权利要求1所述的一种适应高海况的北斗三号捕获跟踪方法，其特征在于，步骤S3中采用联合通道载噪比自适应姿态切换技术来调整波束形成的权值，具体包括如下步骤：S31：根据式计算主路波束指向信号：；其中：为波束合成方向矢量，/＞表示波束合成方向矢量的共轭转置，/＞为信道均衡后的数字基带信号，/＞,/＞表示同相支路的信号分量，/＞表示正交支路的信号分量；S32：通过式计算从路信号：；其中：为从路信号，/＞为阻塞矩阵；S33：主路波束指向信号和从路信号/＞构成自适应姿态切换抗干扰输入数据，接收机计算信号载噪比，反馈至抗干扰算法模块，对阵列天线波束快速调整，让波束对准目标卫星，维持卫星信号的稳定跟踪。5.根据权利要求1所述的一种适应高海况的北斗三号捕获跟踪方法，其特征在于，步骤S4采用二阶FLL锁频辅助三阶PLL锁相信号进行快速的频率锁定及稳定的相位跟踪时步骤如下：S41：锁频环路FLL中鉴频器测量载波相位在固定时间间隔内的变化量，经环路滤波器滤波后，通过式进行鉴频计算，得到锁频环路的输出，进行快速的频率锁定：；其中：T为锁频环相干积分时间，表示包含相邻两时cross刻载波相位差变化量信息的点积，/＞,/＞表示包含相邻两时刻载波相位差变化量信息的叉积，/＞,/＞表示同相支路相关器的输出，/＞表示正交支路相关器的输出；S42：输入信号与载波数字振荡器输出的两路正交信号进行数字混频，经低通滤波后送入鉴相器，提取相位误差信息，经环路滤波后作为数字振荡器的控制输入，按照式计算出锁相环的输出，进行快速的相位锁定：。
说明书desc
技术领域本发明涉及电变量的测量技术领域，尤其涉及一种适应高海况的北斗三号捕获跟踪方法。背景技术由于海洋受潮汐、风浪等因素影响，海面环境复杂多变，且海水对电磁波信号有很强的反射能力。在海洋这种特殊的环境下，船用北斗三号接收机接收到的卫星信号多径效应相比于陆地、航空等应用将更为复杂和恶劣，将会导致更大的伪距和载波相位误差。在五级、六级高海况条件下，大中型船舶在航行过程中，由海浪剧烈变化引起的船舶纵摇角度可达到15°、横摇角度可达到20°，在此情况下卫星信号的自适应稳定跟踪也是本方案需要考虑的另一个关键点，因此，为了保证高海况下船用北斗三号接收机稳定工作，需要进行适应高海况的北斗三号捕获跟踪技术研究。发明内容本发明所要解决的技术问题是提供一种适应高海况的北斗三号捕获跟踪方法，可以实现高海况下船用北斗三号接收机稳定工作，保证高海况北斗三号信号的稳定跟踪。本发明是通过以下技术方案予以实现：一种适应高海况的北斗三号捕获跟踪方法，其包括如下步骤：S1：通过卫导接收机解算卫星来向信息，获得卫星信号入射到天线口面的俯仰角和方位角，并以惯导系统提供的航向角、俯仰角和横滚角信息作为天线姿态约束条件，计算卫星相对于天线口面的俯仰角和方位角，并建立导向矢量；S2：基于线性约束最小方差准则计算自适应滤波权值矢量；S3：根据计算出的自适应滤波权值矢量，切换调整波束形成的权值，实现波束指向的自适应调整，让波束重新对准目标卫星；S4：采用二阶FLL锁频辅助三阶PLL锁相信号进行快速的频率锁定及稳定的相位跟踪。进一步，步骤S1中计算卫星相对于天线口面的俯仰角和方位角，并建立导向矢量包括如下步骤：S11：先根据式计算ECEF地心坐标系下天线到卫星的方向余弦矢量：；其中：为通过卫导接收机解算提供的卫星来向信息获得的卫星信号入射到天线口面的俯仰角，/＞为通过卫导接收机解算提供的卫星来向信息获得的卫星信号入射到天线口面的方位角；S12：根据式将ECEF地心坐标系下天线到卫星的方向余弦矢量转换到NEU站点坐标系中得到NEU站点坐标系下天线到卫星的方向余弦矢量/＞：；其中：R为ECEF地心坐标系到NEU站点坐标系的旋转矩阵；S13：根据式计算得到从NEU站点坐标系到载体坐标系的旋转矩阵；；其中为惯导输出的俯仰角，/＞为惯导输出的方位角，/＞为惯导输出的横滚角；S14：根据式计算导向矢量：；其中：表示导向矢量在东向的分量，/＞表示导向矢量在北向的分量，/＞表示导向矢量在天向的分量。进一步，步骤S2中基于线性约束最小方差准则计算自适应滤波权值矢量包括如下步骤：S21.将下变频信号分割为多个子频带，对多个子频带按照式进行功率统计：；其中：为采样点数，N为统计点数，/＞为统计周期内第/＞个采样点的输入信号值，/＞为每个子频带的平均功率；S22.根据式进行计算，在期望信号方向增益为固定值前提下使阵列输出信号功率最低：；其中：表示阵列输出的功率，/＞表示形成波束的频域数据，/＞是待求的权矢量，H表示矩阵的共轭转置，/＞表示待求的权矢量的共轭转置，/＞表示输出功率最小时待求的权矢量，/＞是期望信号的空域导向矢量；S23.对式构造拉格朗日函数为式，并对式求导得到式，根据式得到自适应滤波权值矢量：；；其中：为拉格朗日系数，/＞表示线性约束的代价，/＞表示输入信号协方差矩阵，/＞，/＞为自适应滤波权值矢量，/＞表示采样时刻，/＞表示快拍数。进一步，步骤S3中采用联合通道载噪比自适应姿态切换技术来调整波束形成的权值，具体包括如下步骤：S31：根据式计算主路波束指向信号：；其中：为波束合成方向矢量，/＞表示波束合成方向矢量的共轭转置，/＞为信道均衡后的数字基带信号,/＞,/＞表示同相支路的信号分量，表示正交支路的信号分量；S32：通过式计算从路信号：；其中：为从路信号，/＞为阻塞矩阵；S33：主路波束指向信号和从路信号/＞构成自适应姿态切换抗干扰输入数据，接收机计算信号载噪比，反馈至抗干扰算法模块，对阵列天线波束快速调整，让波束对准目标卫星，维持卫星信号的稳定跟踪。进一步，步骤S4采用二阶FLL锁频辅助三阶PLL锁相信号进行快速的频率锁定及稳定的相位跟踪时步骤如下：S41：锁频环路FLL中鉴频器测量载波相位在固定时间间隔内的变化量，经环路滤波器滤波后，通过式进行鉴频计算，得到锁频环路的输出，进行快速的频率锁定：；其中：T为锁频环相干积分时间，表示包含相邻两时cross刻载波相位差变化量信息的点积，/＞,/＞表示包含相邻两时刻载波相位差变化量信息的叉积，/＞,/＞表示同相支路相关器的输出，/＞表示正交支路相关器的输出；S42：输入信号与载波数字振荡器输出的两路正交信号进行数字混频，经低通滤波后送入鉴相器，提取相位误差信息，经环路滤波后作为数字振荡器的控制输入，按照式计算出锁相环的输出，进行快速的相位锁定：。发明的有益效果：本发明针对高海况条件下的船用北斗三号接收机应用需求，通过计算卫星相对于天线口面的俯仰角和方位角，并建立导向矢量，然后再基于线性约束最小方差准则计算自适应滤波权值矢量，再根据计算出的自适应滤波权值矢量，切换调整波束形成的权值，实现波束指向的自适应调整，让波束始终对准目标卫星，然后再对频率和相位进行快速锁定，从而实现高海况下船用北斗三号接收机稳定工作，保证高海况北斗三号信号的稳定跟踪。附图说明图1是本发明流程示意图。图2是本发明导向矢量示意图。具体实施方式一种适应高海况的北斗三号捕获跟踪方法，其流程图如图1所示，包括如下步骤：S1：通过卫导接收机解算卫星来向信息，获得卫星信号入射到天线口面的俯仰角和方位角，并以惯导系统提供的航向角、俯仰角和横滚角信息作为天线姿态约束条件，计算卫星相对于天线口面的俯仰角和方位角，并建立导向矢量；具体计算过程包括如下步骤：S11：先根据式计算ECEF地心坐标系下天线到卫星的方向余弦矢量：；其中：为通过卫导接收机解算提供的卫星来向信息获得的卫星信号入射到天线口面的俯仰角，/＞为通过卫导接收机解算提供的卫星来向信息获得的卫星信号入射到天线口面的方位角；由于天线是均匀圆形阵列，因此导向矢量以阵列几何中心为原点建立平面直角坐标系，约定第一个阵元在Y轴上，任意方向信号来向可以由卫星相对于天线口面的方位角与俯仰角/＞确定，可以限定方位角/＞的范围在/＞，俯仰角/＞的范围在/＞，导向矢量示意图如图2所示。S12：根据式将ECEF地心坐标系下天线到卫星的方向余弦矢量转换到NEU站点坐标系中得到NEU站点坐标系下天线到卫星的方向余弦矢量/＞：；其中：R为ECEF地心坐标系到NEU站点坐标系的旋转矩阵；S13：根据式计算得到从NEU站点坐标系到载体坐标系的旋转矩阵；；其中为惯导输出的俯仰角，/＞为惯导输出的方位角，/＞为惯导输出的横滚角；S14：根据式计算导向矢量：；其中：表示导向矢量在东向的分量，/＞表示导向矢量在北向的分量，/＞表示导向矢量在天向的分量。S2：基于线性约束最小方差准则计算自适应滤波权值矢量，具体包括如下步骤：S21.将下变频信号分割为多个子频带，对多个子频带按照式进行功率统计：；其中：为采样点数，N为统计点数，/＞为统计周期内第/＞个采样点的输入信号值，/＞为每个子频带的平均功率；S22.根据式进行计算，在期望信号方向增益为固定值前提下使阵列输出信号功率最低：；其中：表示阵列输出的功率，/＞表示形成波束的频域数据，/＞是待求的权矢量，H表示矩阵的共轭转置，/＞表示待求的权矢量的共轭转置，/＞表示输出功率最小时待求的权矢量，/＞是期望信号的空域导向矢量，即约束为固定增益的方向，LCMV准则在期望信号方向增益为固定值前提下可以使阵列输出信号功率最低；S23.对式构造拉格朗日函数为式，并对式求导，得到式，根据式得到自适应滤波权值矢量：；；其中：为拉格朗日系数，/＞表示线性约束的代价，/＞表示输入信号协方差矩阵，/＞，/＞为自适应滤波权值矢量，/＞表示采样时刻，/＞表示快拍数。线性约束最小方差准则是使系统输出的总功率最小且不为零，一般用于输入信号中有用信号的功率较小，而干扰信号功率较大的情况，这样会在干扰方向形成零陷，从而使得输出信噪比最大。通过权值的计算，可以实现波束指向的自适应调整，使有用的信号增强。S3：根据计算出的自适应滤波权值矢量，切换调整波束形成的权值，实现波束指向的自适应调整，让波束重新对准目标卫星，具体包括如下步骤：S31：根据式计算主路波束指向信号：；其中：为波束合成方向矢量，/＞表示波束合成方向矢量的共轭转置，/＞为信道均衡后的数字基带信号，/＞,/＞表示同相支路的信号分量，表示正交支路的信号分量；S32：通过式计算从路信号：；其中：为从路信号，/＞为阻塞矩阵；S33：主路波束指向信号和从路信号/＞构成自适应姿态切换抗干扰输入数据，接收机计算信号载噪比，反馈至抗干扰算法模块，对阵列天线波束快速调整，让波束对准目标卫星，维持卫星信号的稳定跟踪。由于船舶在高海况航行过程中的姿态快速变化，会引起阵列天线姿态的改变，使得形成的波束不再对准目标卫星。因此本方案根据计算出的自适应滤波权值矢量，切换调整波束形成的权值，实现波束指向的自适应调整，可以让波束重新对准目标卫星，确保高海况下的北斗三号信号稳定捕获跟踪。在五级/六级高海况时，大中型船舶由海浪剧烈变化引起的纵摇角度可达到15°，横摇角度可达到20°，而抗干扰阵列天线形成稳定波束增益所要求的姿态精度为2°。因此可以对已知卫星位置的仰角2°和方位角4°范围内进行搜索，每次搜索计算出相应的载噪比，根据接收机在不同方位波束下载噪比的大小来判断真实的卫星方位，载噪比最大的那个，即是形成的波束对准了卫星的真实方位。粗略载噪比计算采用接收机1ms相干积分结果实现，由于每次计算载噪比需要20ms，结合二分象限搜索方法，完成整个搜索需要耗时20×15×1/2 = 150ms，即自适应切换频率为6.67Hz，而一般海浪频率为2～5Hz，因此该方法能够满足高海况下的应用需求。S4：采用二阶FLL锁频辅助三阶PLL锁相信号进行快速的频率锁定及稳定的相位跟踪，具体步骤如下：S41：锁频环路FLL中鉴频器测量载波相位在固定时间间隔内的变化量，经环路滤波器滤波后，通过式进行鉴频计算，得到锁频环路的输出，进行快速的频率锁定：；其中：T为锁频环相干积分时间，表示包含相邻两时cross刻载波相位差变化量信息的点积，/＞,/＞表示包含相邻两时刻载波相位差变化量信息的叉积，/＞,/＞表示同相支路相关器的输出，/＞表示正交支路相关器的输出；S42：输入信号与载波数字振荡器输出的两路正交信号进行数字混频，经低通滤波后送入鉴相器，提取相位误差信息，经环路滤波后作为数字振荡器的控制输入，按照式计算出锁相环的输出，进行快速的相位锁定：。为了应对海面多径信号导致的载波频率误差问题，载波跟踪采用二阶FLL锁频辅助三阶PLL锁相信号快速频率锁定技术，锁频环FLL可以实现信号载波频率的快速搜索和粗跟踪，锁相环PLL在此基础上通过三阶环路可以实现载波相位的稳定跟踪。其中锁频环FLL可以选用四象限反正切鉴频器，其特点是低信噪比时表现佳，频率牵引范围大，输出与信号幅度无关，锁相环PLL可以采用数字COSTAS环，COSTAS环是二相或四相移相键控信号解调专用环路，输入信号与载波NCO输出的两路正交信号进行数字混频，经两路低通滤波后送入鉴相器，提取相位误差信息，经环路滤波，作为NCO的控制输入，NCO的输出即为信号的载波。PLL可以选用二象限反正切鉴相器，其特点是精度高，输出与信号强弱无关。通过上述方法，一方面通过自适应波束形成，实现对低仰角卫星多径信号的高效抑制，另一方面波束形成根据先验的卫星位置信息及惯导提供的姿态信息辅助，采用自适应调整滤波器的滤波系数，并根据计算出的自适应滤波权值矢量，切换调整波束形成的权值，实现波束指向的自适应调整，实现了卫星信号的自适应对准和低仰角多径信号抑制，通过方向矢量加权使得阵列天线的方向图改变，而使波束始终对准目标卫星方向，达到提高目标方向上的增益，同时对其他来波方向信号进行抑制的效果；最后采用二阶FLL锁频辅助三阶PLL锁相进行快速的频率锁定及稳定的相位跟踪，可以实现信号载波频率的快速捕获和稳定跟踪，从而实现高海况下船用北斗三号接收机稳定工作，保证高海况北斗三号信号的稳定跟踪。在具体的信号处理过程中，采用FLL与PLL组合牵引频率跟踪，可以先尝试跟踪一定的时间，并由时间段最后的数据决定是否跟踪载波和C/A码，将频差从几百赫兹的范围缩小到十几赫兹的范围，使得频差落入跟踪环路带宽内，以便进行正常的跟踪，同时实现位同步。如果在规定的信号牵引周期内未进入跟踪状态，则回到捕获状态重新进行捕获后再进行跟踪。综上所述，本发明提供一种适应高海况的北斗三号捕获跟踪方法，可以实现高海况下船用北斗三号接收机稳定工作，保证高海况北斗三号信号的稳定跟踪。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
