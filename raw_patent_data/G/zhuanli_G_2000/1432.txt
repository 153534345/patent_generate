标题title
基于数字孪生的自动装配混流生产线布局优化方法及装置
摘要abst
本发明公开一种基于数字孪生的自动装配混流生产线布局优化方法及装置，该方法步骤包括：构建数字孪生系统，系统中包括混流生产系统物理域模型、孪生域模型以及孪生数据平台；以生产线效率最大、产量最大以及投入成本最小作为多级优化目标，将各级优化目标加权构建目标优化模型；根据孪生数据平台中数据配置目标优化模型中各级优化目标的权重系数，确定得到生产线布局方案，不断从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照确定得到的生产线布局方案输入至神经网络模型中进行迭代求解，直至得到满足预设性能要求的最优生产线布局方案。本发明具有实现方法简单、智能化程度与效率高、稳定可靠等优点。
权利要求书clms
1.一种基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，步骤包括：步骤1：构建自动装配混流生产线资源配置优化的数字孪生系统，系统中包括混流生产系统物理域模型、孪生域模型、孪生数据平台，所述孪生域模型包括虚拟生产线孪生体以实现与混流生产系统物理域模型的数据映射，所述孪生数据平台用于收集所述混流生产系统物理域模型的历史运行数据、实时运行数据以及提供实时运行数据给所述孪生域模型；步骤2：以生产线效率最大、产量最大以及投入成本最小作为多级优化目标，将各级优化目标加权构建形成自动装配混流生产线资源配置的目标优化模型；步骤3：根据孪生数据平台中数据配置所述目标优化模型中各级优化目标的权重系数，确定得到生产线布局方案，不断从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照确定得到的生产线布局方案输入至神经网络模型中进行迭代求解，直至得到满足预设性能要求的最优生产线布局方案，在迭代求解过程中根据迭代求解结果更新所述孪生域模型以及孪生数据平台中数据。2.根据权利要求1所述的基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，所述自动装配混流生产线资源配置的目标优化模型中使用最小生产节拍按照构建生产线效率最大/＞的计算模型，即/＞，K为比例系数常数，所述最小生产节拍/＞根据各个工序设备的运行时间、各加工工序加工台加工时间和机器手对物料抓取时间、传送带相邻两个工序从分流到合流的运动时间以及各个加工工序关系复杂度计算得到。3.根据权利要求2所述的基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，所述最小生产节拍按下式计算得到：其中，JT代表生产线的生产节拍；为生产线中第i个工序设备运行时间，/＞、/＞分别代表生产线中第i个工序加工台加工时间和机器手对物料抓取时间，每一道工序抓和放时间一致；/＞代表传送带相邻两个工序从分流到合流的运动时间，/＞为第i个加工工序关系复杂度的权重因子，wi为第i个加工工序的关系复杂度熵值，/＞为第i个加工工序的关系复杂度，ZA,ZB,ZC分别表示加工台加工状态中的工作前工序的数量、正在工作工序的数量以及工作后的工序数量，/＞表示生产线的第i个加工工序的工序数量，N表示加工工序数量。4.根据权利要求1所述的基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，所述自动装配混流生产线资源配置的目标优化模型中，使用传送带缓存容量、设备运转消耗的能量、产线设备成本和皮带工件缓存量、构建生产成本投入最小的计算模型：其中，B代表产线装配生产的成本，θi为生产线中第i个工序设备利用率，Ti为生产线中第i个工序设备运行时间，为第i个工序设备运转能源消耗总成本，空转设备能源消耗是工作状态能源消耗的1/2；Bb代表生产线单个工序传送带的成本；/＞代表评判生产线中第i个加工工序与下一个工序之间是否需要合流或分流的0~1变量，N表示工序数量，G*表示各工序传送带最优缓存容量，Gb为传送带缓存容量，且1≤a≤Gb≤b，b表示传送带缓存容量下限，a表示传送带缓存容量上限，/＞表示生产线产量。5.根据权利要求1所述的基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，所述自动装配混流生产线资源配置的目标优化模型为：其中，A表示生产线生成效率，表示生产线产量，B表示生产线投入成本，/＞=α1、α2、α3分别表示对/＞、/＞、/＞的权重系数。6.根据权利要求1~5中任意一项所述的基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，步骤3包括：步骤3.1.根据孪生数据平台中历史数据配置所述目标优化模型中各级优化目标的初始权重系数，确定得到初始生产线布局方案；步骤3.2. 从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照当前生产线布局方案输入至神经网络模型中进行迭代求解，输出当前生产线布局方案下得到的下一时刻的控制变量数据，并更新孪生域模型以及孪生数据平台中数据；步骤3.3.判断损失函数是否收敛，如果是得到训练后的神经网络模型以及最优生产线布局方案输出，如果为否则返回步骤3.2；步骤3.4.将孪生数据平台中获取各级优化目标所对应的控制变量实时数据以及最优生产线布局方案输入至孪生域模型中，并根据生产线的平衡损失率对资源配置的结果进行评估以验证资源配置的效果。7.根据权利要求6所述的基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，所述步骤3.3中按照下式计算损失函数：其中，S为当前状态，即输入的控制变量数据；Z为输出的执行动作，所述执行动作包括各个工序设备或长度的增减; 为网络参数，即均方误差损失；其中，为奖励值；/＞为学习衰减率，S'为下一时刻状态，Z’为下一时刻要执行动作；步骤3.4中平衡损失率的计算表达式为：其中，为平衡损失率，/＞代表工序设备的最高利用率，N表示工序数量，/＞代表第N个工序设备的利用率。8.根据权利要求1~5中任意一项所述的基于数字孪生的自动装配混流生产线布局优化方法，其特征在于，所述神经网络模型的输入参数中对应生产线产量优化目标的控制变量包括各类工序设备的数量、皮带长度，对应生产线成本优化目标的控制变量包括出料间隔以及出料数量，对应生产线产量优化目标的控制变量包括设备利用率，神经网络的输出参数包括下一时刻的工序设备的利用率、工件缓存量、出料数量以及出料间隔中任意一种或多种。9.一种基于数字孪生的自动装配混流生产线布局优化装置，其特征在于，包括：自动装配混流生产线资源配置优化的数字孪生系统，系统中包括混流生产系统物理域模型、孪生域模型、孪生数据平台，所述孪生域模型包括虚拟生产线孪生体以实现与混流生产系统物理域模型的数据映射，所述孪生数据平台用于收集所述混流生产系统物理域模型的历史运行数据、实时运行数据以及提供实时运行数据给所述孪生域模型；优化模型构建模块，用于以生产线效率最大、产量最大以及投入成本最小作为多级优化目标，将各级优化目标加权构建形成自动装配混流生产线资源配置的目标优化模型；布局优化模块，用于根据孪生数据平台中数据配置所述目标优化模型中各级优化目标的权重系数，确定得到生产线布局方案，不断从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照确定得到的生产线布局方案输入至神经网络模型中进行迭代求解，直至得到满足预设性能要求的最优生产线布局方案，在迭代求解过程中根据迭代求解结果更新所述孪生域模型以及孪生数据平台中数据。10.一种计算机装置，包括处理器以及存储器，所述存储器用于存储计算机程序，其特征在于，所述处理器用于执行所述计算机程序以执行如权利要求1～8中任意一项所述方法。
说明书desc
技术领域本发明涉及自动装配生产系统技术领域，尤其涉及一种基于数字孪生的自动装配混流生产线布局优化方法及装置。背景技术自动装配生产线即是利用机器手、传输皮带、控制进料、出料等实现产品的自动装配。自动装配混流生产线即为可以使用不同产品工艺流程的生产线，各产品的工艺流程、物料需求、各工站设备、操作人员数量等需求可能不完全相同。同时，上述资源的状态信息也可能会随加工进度的变化而变化，这些变化会使得加工过程的动态优化和反馈控制变得复杂。例如资源配置不足会影响正常生产进度，而资源配置过量则会造成浪费，因此进行自动装配混流生产线资源配置优化是自动装配生产系统实现智能加工的关键。对于自动装配的自动装配混流生产线的生产线布局方案，现有技术中通常是人工依据经验进行配置。但是，一方面多工序生产系统的生产线布局中会涉及多重资源的资源配置，例如物资设备、能源等，传统依据人工经验的布局方式难以将多重资源配置进行耦合，导致不能实时监控各资源的状态，也难以及时动态地对存在问题的资源配置进行优化；另一方面，生产线布局仅依靠人工经验，效率以及可靠性低，在布局中需要考虑各功能段之间的关联方式、各段内子线之间的关联方式、各子线内部的工位排布方式等，布局配置的难度大，易造成布局混乱，无法及时发现布局的潜在问题，致使后期优化成本高。尤其是产线规模越大，建设调试周期越长，后期优化成本也会越高。同时随着生产线的运行各类需求也是不断变化的，依靠人工经验就难以依据生产线的实时状态动态确定出最优的布局方案。发明内容本发明要解决的技术问题就在于：针对现有技术存在的技术问题，本发明提供一种实现方法简单、智能化程度与效率高、稳定可靠的基于数字孪生的自动装配生产线布局优化方法及装置，能够动态实现自动装配混流生产线的最优布局优化，提高生产线的稳定性以及生产效率，同时降低能源消耗率。为解决上述技术问题，本发明提出的技术方案为：一种基于数字孪生的自动装配混流生产线布局优化方法，步骤包括：步骤1：构建自动装配混流生产线资源配置优化的数字孪生系统，系统中包括混流生产系统物理域模型、孪生域模型、孪生数据平台，所述孪生域模型包括虚拟生产线孪生体以实现与混流生产系统物理域模型的数据映射，所述孪生数据平台用于收集所述混流生产系统物理域模型的历史运行数据、实时运行数据以及提供实时运行数据给所述孪生域模型；步骤2：以生产线效率最大、产量最大以及投入成本最小作为多级优化目标，将各级优化目标加权构建形成自动装配混流生产线资源配置的目标优化模型；步骤3：根据孪生数据平台中数据配置所述目标优化模型中各级优化目标的权重系数，确定得到生产线布局方案，不断从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照确定得到的生产线布局方案输入至神经网络模型中进行迭代求解，直至得到满足预设性能要求的最优生产线布局方案，在迭代求解过程中根据迭代求解结果更新所述孪生域模型以及孪生数据平台中数据。进一步的，所述自动装配混流生产线资源配置的目标优化模型中使用最小生产节拍按照/＞构建生产线效率最大/＞的计算模型，即/＞，K为比例系数常数，所述最小生产节拍/＞根据各个工序设备的运行时间、各加工工序加工台加工时间和机器手对物料抓取时间、传送带相邻两个工序从分流到合流的运动时间以及各个加工工序关系复杂度计算得到。进一步的，所述最小生产节拍按下式计算得到：其中，JT代表生产线的生产节拍；为生产线中第i个工序设备运行时间，/＞、/＞分别代表生产线中第i个工序加工台加工时间和机器手对物料抓取时间，每一道工序抓和放时间一致；/＞代表传送带相邻两个工序从分流到合流的运动时间，/＞为第i个加工工序关系复杂度的权重因子，wi为第i个加工工序关系复杂度熵值，/＞为第i个加工工序的关系复杂度，ZA,ZB,ZC分别表示加工台加工状态中的工作前工序的数量、正在工作工序的数量以及工作后的工序数量，/＞表示生产线的第i个加工工序的工序数量，N表示加工工序数量。进一步的，所述自动装配混流生产线资源配置的目标优化模型中，使用传送带缓存容量、设备运转消耗的能量、产线设备成本和皮带工件缓存量、构建生产成本投入最小的计算模型：其中，B代表产线装配生产的成本，θi为生产线中第i个工序设备利用率，Ti为生产线中第i个工序设备运行时间，为第i个工序设备运转能源消耗总成本，空转设备能源消耗是工作状态能源消耗的1/2；Bb代表生产线单个工序传送带的成本；/＞代表评判生产线中第i个加工工序与下一个工序之间是否需要合流或分流的0~1变量，N表示工序数量，G*表示各工序传送带最优缓存容量，Gb为传送带缓存容量，且1≤a≤Gb≤b，b表示传送带缓存容量下限，a表示传送带缓存容量上限，/＞表示生产线产量。进一步的，所述自动装配混流生产线资源配置的目标优化模型为：其中，A表示生产线生成效率，表示生产线产量，B表示生产线投入成本，/＞=α1、α2、α3分别表示对/＞、/＞、/＞的权重系数。进一步的，步骤3包括：步骤3.1.根据孪生数据平台中历史数据配置所述目标优化模型中各级优化目标的初始权重系数，确定得到初始生产线布局方案；步骤3.2. 从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照当前生产线布局方案输入至神经网络模型中进行迭代求解，输出当前生产线布局方案下得到的下一时刻的控制变量数据，并更新孪生域模型以及孪生数据平台中数据；步骤3.3.判断损失函数是否收敛，如果是得到训练后的神经网络模型以及最优生产线布局方案输出，如果为否则返回步骤3.2；步骤3.4.将孪生数据平台中获取各级优化目标所对应的控制变量实时数据以及最优生产线布局方案输入至孪生域模型中，并根据生产线的平衡损失率对资源配置的结果进行评估以验证资源配置的效果。进一步的，所述步骤3.3中按照下式计算损失函数：其中，S为当前状态，即输入的控制变量数据；Z为输出的执行动作，所述执行动作包括各个工序设备或长度的增减;为网络参数，即均方误差损失；其中，S'为下一时刻状态，即下一时刻的控制变量数据；为下一时刻要执行动作；/＞为奖励值；/＞为学习衰减率。步骤3.4中平衡损失率的计算表达式为：其中，为平衡损失率，/＞代表工序设备的最高利用率，N表示工序数量，/＞代表工第N个工序设备的利用率。进一步的，所述神经网络模型的输入参数中对应生产线产量优化目标的控制变量包括各类工序设备的数量、皮带长度，对应生产线成本优化目标的控制变量包括出料间隔以及出料数量，对应生产线产量优化目标的控制变量包括设备利用率，神经网络的输出参数包括下一时刻的工序设备的利用率、工件缓存量、出料数量以及出料间隔中任意一种或多种。一种基于数字孪生的自动装配混流生产线布局优化装置，包括：自动装配混流生产线资源配置优化的数字孪生系统，系统中包括混流生产系统物理域模型、孪生域模型、孪生数据平台，所述孪生域模型包括虚拟生产线孪生体以实现与混流生产系统物理域模型的数据映射，所述孪生数据平台用于收集所述自动装配混流生产线物理域模型的历史运行数据、实时运行数据以及提供实时运行数据给所述孪生域模型；优化模型构建模块，用于以生产线效率最大、产量最大以及投入成本最小作为多级优化目标，将各级优化目标加权构建形成自动装配混流生产线资源配置的目标优化模型；布局优化模块，用于根据孪生数据平台中数据配置所述目标优化模型中各级优化目标的权重系数，确定得到生产线布局方案，不断从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照确定得到的生产线布局方案输入至神经网络模型中进行迭代求解，直至得到满足预设性能要求的最优生产线布局方案，在迭代求解过程中根据迭代求解结果更新所述孪生域模型以及孪生数据平台中数据。一种计算机装置，包括处理器以及存储器，所述存储器用于存储计算机程序，所述处理器用于执行所述计算机程序以执行如上述方法。与现有技术相比，本发明的优点在于：本发明通过首先构建自动装配混流生产线资源配置优化的数字孪生总架构模型，包括物理域、孪生域以及孪生数字平台，以及构建自动装配混流生产线资源配置多级目标优化模型，利用深度强化学习与数字孪生系统的交互实现对最优资源配置方案的迭代求解，通过对孪生域中孪生体运行仿真获得深度强化学习网络输入数据，经过不断迭代求解得到优化策略以对资源配置方案进行调整，能够结合数字孪生技术以及深度学习方式实现高效的自动装配混流生产线布局的智能在线优化方法，不仅能够实现实时检测，有效增强产线稳定性，还能够提高车间生产效率，同时降低能源消耗率。附图说明图1是本实施例基于数字孪生的自动装配混流生产线布局优化方法的实现流程示意图。图2是本实施例构建的自动装配混流生产线资源配置优化的数字孪生模型的原理示意图。图3是本实施例中构建的混流生产系统物理域的原理示意图。图4是本实施例中基于神经网络的预测模型进行预测的原理示意图。图5是本实施例中基于数字孪生数据DRL资源配置优化的实现流程示意图。具体实施方式以下结合说明书附图和具体优选的实施例对本发明作进一步描述，但并不因此而限制本发明的保护范围。数字孪生系统是通过数字化的方式建立能真实反映物理实体的虚拟生产线模型，促进物理空间和虚拟空间信息的交互融合。本发明通过引入数字孪生系统，构建自动装配混流生产线实体与虚拟生产线孪生体之间的映射，同时针对于基于数字孪生系统得到的布局配置方案，结合深度学习模型对不同布局配置下的生产线性能状态进行预测，依据预测结果调整生产线的布局配置方案，使得可以充分结合数字孪生系统与深度学习模型之间的交互确保自动装配混流生产线布局配置达到最优，从而大大提高生产线布局优化方案配置的效率、可靠性，降低混流生产线布局优化方案配置复杂度以及能源消耗率，利用优化结果还可以实现从物料配送、产线监视到作业指导，全方位管控生产活动中的不确定性因素、监控其生产流程，从而为调整生产计划提供参考。如图1所示，本实施例基于数字孪生的自动装配混流生产线布局优化方法的步骤包括：步骤1：构建自动装配混流生产线资源配置优化的数字孪生系统，如图2所示，系统中包括混流生产系统物理域模型、孪生域模型以及孪生数据平台，孪生域模型包括虚拟生产线孪生体以实现与混流生产系统物理域模型的数据映射，孪生数据平台用于收集混流生产系统物理域模型的历史运行数据、实时运行数据以及提供实时运行数据给孪生域模型。如图2所示，本实施例中物理域模型包括生产线生产任务、设备模型、人员以及物料等，孪生域包括几何模型以及场景搭建，几何模型包括设备模型、行为模型、物理模型以及运动规则模型，场景搭建包括车间模型、模型材质、产线布局以及场景渲染等的构建，孪生数据平台中包括系统历史运行数据、实时运行数据以及知识库。孪生域与物理域模型之间进行交互、数据映射，进而不断的迭代优化，由孪生数据平台为孪生域提供实时数据驱动、为优化评估模型提供数据以进行迭代优化。步骤1.1：自动装配混流生产系统物理车间构建如图3所示，智能生产线物理装配车间需求定义为系统各方面需求之间的关系，主要包括功能需求和性能需求。根据功能需求主要考虑产量最大、最低投入成本、最低能耗等方面，其中性能需求方面包括工业机器手模块、传送带模块、装配台模块等三大部分。其中，为了满足工况条件下生产系统的最高效率下的最低成本和能耗，对于传送带模型系统，本实施例考虑传送带的传送距离、传送速度、有效负载和使用寿命等参数；对于工业机器手模快，考虑其运动精度、自由度、驱动方式和抓取定位精度等参数；对于装配台子系统，主要考虑到装配精度、承载重量、台面的尺寸等参数。步骤1.2：孪生数据平台的构建。孪生数据平台用于存储系统所需的各类相关数据，以满足每个功能模块运行时对数据的需求，其中包括物理域资源数据、孪生域数据、生产计划系统相关的服务数据和优化过程中相关的知识库数据。资源数据具体包括人员、设备、物料、优化等协同完成混流装配线装配任务的过程数据；虚拟装配车间孪生数据具体包括模型数据、仿真数据以及评估、优化等数据；知识库具体可以由专家数据提供并从数据中提取相关规则，使得可以有效地组织管理系统获取的数据，为装配资源配置优化提供数据支持，如历史资源配置平均标准。孪生数据平台可实现对数据的融合处理，为整个数字孪生系统运行提供准确、实时、可靠的数据保障。步骤1.3：虚拟产线孪生体构建。为了实现虚拟产线的高度映射，通过对物理车间进行数据采集，本实施例具体借助MIoT.VC数字建模平台构建虚拟生产线孪生体，实现数据映射。MIoT.VC数字建模平台通过利用虚拟仿真技术，对生产线布局、设备配置等进行预规划，通过虚拟产线运行分析、评估、验证，发现系统运行中存在的问题，以及时进行调整与优化，尤其适用于复杂生产线系统。在具体应用实施例中，每个模型采用“父子”节点的建模方式，并采用solid works建模软件对车间几何模型进行三维构建并导入MIoT.VC。在MIoT.VC中完成对几何模型的物理属性、材质、碰撞体和灯光的添加，使生产线虚拟场景高度还原物理车间的环境，构建形成虚拟产线孪生体。本实施例对上述混流生产系统物理车间、孪生数据平台以及虚拟产线孪生体的构建顺序不做限制，具体可以根据实际需求配置。步骤2：以生产线效率A最大、产量Y最大以及投入成本B最小作为多级优化目标，即，将各级优化目标加权构建形成自动装配混流生产线资源配置的目标优化模型。通过以生产线效率A最大、产量Y最大以及投入成本B最小多个目标作为优化目标构建自动装配混流生产线资源配置多级目标优化模型，使得可以从生产线效率、产量以及投入成本三方面表征生产线的资源配置状态，通过求解该多级目标优化模型，可以使得最终生产线布局资源配置能够趋向于同时满足生产线效率A最大、产量Y最大以及投入成本B，实现资源配置最优。产线合理的节拍是作为生产质量和效率保障的前提，工序间的不平衡、人为操作、变动的生产需求等会导致节拍设计的难度大。合理的产线节拍设计能够确保生产过程中各个工序能够有序协调，直接关系到生产线的产能。传统生产线平衡规划方法通常是采用精确优化方法和启发式优化方法两种，精确优化方法使用数学规划求解，虽然能够得到最优解，但是计算时间慢，启发式方法计算时间快，但不能保证得到最优解。同时由于生产要素会随时间发生变化，会给生产带来不确定性。生产线平衡节拍情况决定了生产线的生产效率，如果不能实时监控生产要素变化，确定有效的节拍将会大大影响实际的生产效率。因此，对产线进行布局和节拍设计优化是保障生产效率的高效的关键。本实施例中，自动装配混流生产线资源配置多级目标优化模型中具体使用最小生产节拍按照/＞构建生产线效率最大/＞的计算模型，即/＞，K为比例系数常数，最小生产节拍/＞根据各个工序设备的运行时间、各加工工序加工台加工时间和机器手对物料抓取时间、传送带相邻两个工序从分流到合流的运动时间以及各个加工工序关系复杂度计算得到，使得可以通过确定最小节拍最终有效确保生产效率最高。假设产线组装的工序元素集合为：其中：D代表装配线的各项工序；N代表工序数量。各个加工台的对应位置属性集合为:其中，ZA，ZB, ZC分别表示加工台加工状态中的工作前工序的数量、正在工作工序的数量以及工作后的工序数量。本实施例中，加工工序关系复杂度的计算表达式为：其中，为第i个加工工序的关系复杂度，/＞表示生产线的第i个加工工序的工序数量。各加工工序关系复杂度的权重因子按下式计算得到：其中，为第i个加工工序关系复杂度的权重因子，wi为第i个加工工序的关系复杂度熵值。生产线平衡节拍决定生产线的生产效率，而生产节拍是根据工序数量、工序复杂度变化而变化的，生产线的节拍实际上是根据工序作业的时间决定的，工序数量越多，工序复杂度越高、工序设备作业时间越长。生产线平衡节拍除了与生产节拍有关以外，还与生产总时间有关，例如繁忙的设备利用率总是能产生更好的产量，生产线的生产效率也会相应的提高，即生产线平衡节拍与工序的复杂度和设备的利用率有、密切相关。考虑到各个工序的复杂度不同，本实施例使用各个工序的权重因子表述各个工序的复杂度，使用设备的利用效率来表征其生产线生产效率，即最小生产节拍为：其中，JT代表生产线的生产节拍；为生产线中第i个工序设备运行时间，/＞、/＞分别代表生产线中第i个工序加工台加工时间和机器手对物料抓取时间，本实施例中假设每一道工序抓和放时间一致；/＞代表传送带相邻两个工序从分流到合流的运动时间，/＞为第i个加工工序关系复杂度的权重因子。生产效率最大的表达式具体按下式计算得到，即生产节拍与生产效率的关系成反比：其中，K为比例系数常数。本实施例中，自动装配混流生产线资源配置多级目标优化模型中，具体使用传送带缓存容量、设备运转消耗的能量、产线设备成本和皮带工件缓存量、构建生产成本投入最小的计算模型：进一步可转换得到下式：其中，B代表产线装配生产的成本；代表生产线中第i个工序设备工作所需的单元成本；/＞代表生产线中第i个工序设备空转所需的单元成本；θi为生产线中第i个工序设备利用率，Ti为生产线中第i个工序设备运行时间，/＞为第i个工序设备运转能源消耗总成本，空转设备能源消耗是工作状态能源消耗的1/2；Bb代表生产线单个工序传送带的成本；代表评判生产线中第i个加工工序与下一个工序之间是否需要合流或分流的0~1变量，N表示工序数量，Gb为传送带缓存容量，且1≤a≤Gb≤b，b表示传送带缓存容量下限，a表示传送带缓存容量上限，传送带缓存容量不小于一个工件数量。本实施例通过基于数字孪生技术使得生产线生产最小生产成本可以追踪到设备利用率、皮带长度、皮带最小容量等参数，由于系统中设备运转消耗的能量成本随时间改变，上式中各项是叠加得到，因此设备利用率、皮带长度、皮带最小容量可以趋向性判别成本的高低，即可以综合设备利用率、皮带长度、皮带最小容量确定出最低成本。本实施例中根据生产线传送一批工件的平均滞留时间，计算生产线传送带最优缓存总容量，计算表达式为：其中，G*表示各工序传送带最优缓存容量，表示生产线产量。通过上述步骤构建形成自动装配混流生产线资源配置多级目标优化模型，即为：进一步采用线性加权系数法将上述各级目标优化模型进行线性加权，构建得到最终的目标优化函数：其中，A表示生产线生成效率，表示生产线产量，B表示生产线投入成本，/＞=α1、α2、α3分别表示对/＞、/＞、/＞的权重系数。按照上式，可以将多级目标函数求取最优解问题转化为单目标函数求取最值，该优化函数分为 3个目标函数，依据不同目标函数的不同权重，线性加权得到单目标函数。按照多级目标优化模型，以生产效率最大化为第一目标、最大产能为第二目标、生产成本最小化为第三目标，各个目标函数权重范围为1＞α1＞α2＞α3＞0。步骤3：根据孪生数据平台中数据配置目标优化模型中各级优化目标的权重系数，确定得到生产线布局方案，不断从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照确定得到的生产线布局方案输入至神经网络模型中进行迭代求解，直至得到满足预设性能要求的最优生产线布局方案，在迭代求解过程中根据迭代求解结果更新孪生域模型以及孪生数据平台中数据。由于各个目标函数通过对模型的构建，分别可以追踪到工序的数量、工序的工作效率等，如出料间隔以及出料数量，是工序工作效率的直接表现，出料间隔及出料数量越多，在产线不堵塞的情况下，其产线整体的工作效率越高；再如工序设备数量越多、皮带长度越长，其成本越高，但是皮带越长势必影响整体的产线效率。如图4所示，本实施例中神经网络模型的输入参数中对应生产线产量优化目标的控制变量具体包括各类工序设备的数量、皮带长度等，对应生产线成本优化目标的控制变量具体包括出料间隔以及出料数量等，对应生产线产量优化目标的控制变量具体包括设备利用率等，即将各级优化目标的权重对应配置为影响各级优化目标对应的各类控制变量数据的权重。神经网络的输出参数包括下一时刻的工序设备的利用率、工件缓存量、出料数量以及出料间隔等。进一步对神经网络的输入参数中，可以对输入的上述各类工序设备的数量、皮带长度、出料间隔以及出料数量等参数按照所对应的各级优化目标的权重进行相应的权重设计，可以通过孪生历史数据平台分析得出各个目标函数之间的权重的初始值，例如如果比例为5：3：2，可以配置为α1=0.5，α2=0.3，α3=0.2；再通过深度学习模型不断进行迭代和优化，以不断调整多目标函数中α1、α2、α3获取各输入参数的变化趋势，进而根据各输入参数的变化趋势确定出各个输入参数的权重值，直至得到最优产线配置方案，更新各个权重的比例，并更新对应的混流生产系统物理域模型、孪生域模型。如图5所示，本实施例采用深度强化学习网络进行资源优化迭代求解，步骤包括：步骤3.1.根据孪生数据平台中历史数据配置目标优化模型中各级优化目标的初始权重系数，确定得到初始生产线布局方案。神经网络模型具体采用深度强化学习网络，也可以采用其他深度学习模型。搭建DRL神经网络后，将输入的各类工序设备的数量、皮带长度、出料间隔、出料数量以及工序设备的利用率进行相应的权重设计，由孪生数据平台中历史数据确定出权重因子α1、α2、α3的初始值，其中权重因子α3对应各类工序设备的数量、皮带长度，权重因子α2对应出料间隔以及出料数量，α1对应工序设备的利用率。步骤3.2. 从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照当前生产线布局方案输入至神经网络模型中进行迭代求解，输出当前生产线布局方案下得到的下一时刻的控制变量数据，并更新孪生域模型以及孪生数据平台中数据。步骤3.3.判断损失函数是否收敛，如果是得到训练后的神经网络模型以及最优生产线布局方案输出，如果为否则返回步骤3.2。为目标和预测值之间的方差，本实施例DRL在Q_Leraning的基础上采用函数拟合更新Q值，通过更新参数使Q函数逼近最优Q值，损失函数的计算表达式如下所示：其中，S为当前状态，即输入的控制变量数据；Z为输出的执行动作，包括各个工序设备、长度的增减;为网络参数，即均方误差损失；其中，S'为下一时刻状态，即下一时刻的控制变量数据；为下一时刻要执行动作；/＞为奖励值；/＞为学习衰减率，越接近1代表将后续状态的价值考虑程度越高。步骤3.4.将孪生数据平台中获取各级优化目标所对应的控制变量实时数据以及最优生产线布局方案输入至孪生域模型中，并根据生产线的平衡损失率对资源配置的结果进行评估以验证资源配置的效果。生产线的生产效率由瓶颈工序时间所决定，瓶颈工序时间越长效率则越低，生产线的平衡损失率相应的越高。本实施例使用生产线的平衡损失率对资源配置的结果进行评估以验证资源配置的效果。平衡损失率的计算表达式具体为：/＞其中，为平衡损失率，/＞代表工序设备的最高利用率，N表示工序数量，/＞代表工第N个工序设备的利用率。从虚拟生产线孪生体中获取实时运行数据后，提取出上述各类工序设备的数量、皮带长度、出料间隔以及出料数量等参数输入至训练后的神经网络模型中，输出利用率、产量、工件缓存量以及线平衡损失率等参数预测结果。由预测结果判断是否达到预设资源配置性能，如果是则得到最终的资源配置布局方案，如果为否则可以根据预测结果进一步调整产线布局。例如若预测得到机器手利用率较低，则可以减少机器手的数量。本实施例通过引入基于数字孪生技术的深度强化学习方式，对自动装配混流生产线进行资源配置优化，以在提高整体性能的前提下，以低投入成本进一步提高生产系统生产效率。相对于传统基于神经网络或深度学习等的故障预测方法，由于数据来源于自动装配混流生产线虚拟实体数据中心为数据依据，任何资源配置的生产线运行状态的仿真可以灵活控制，且能够真实反馈出任何资源配置物理实体的运行状况，基于此数据可以实现对任意生产状况进行精确预测。以下以PCB的工艺流程为例对本发明上述方法进行进一步说明。PCB的工艺流程包括：前处理①→印刷阻焊油②→曝光、显影③→后烘烤④→阻焊印刷⑤→字符印刷⑥→镀金⑦→热风平整成形⑧→测试⑨→分类识别、出货⑩等10个工序。且具有三条完全相同的产线，每条产线根据工艺有10个工站，工人上班时间为8 h，三班制。步骤1、 数字孪生模型构建使用MIoT.VC平台对生产线进行孪生体建模。首先，将产线各个零件三维模型由Solid Works软件进行建模，包括各个工序的三维模型、材料的选取。然后，导入到MIoT.VC平台，设置约束条件；最后，选择适当的光源及相应的布景，设定每个零件的材料属性，将零件染上不同的颜色，对模型进行渲染，以及把视角调整为等距视图。步骤2、初始资源配置方案配置与验证根据混流装配线布局、装配工艺、各工站资源配置等实时信息，对建立的虚拟产线三维模型进行仿真，并对初始资源配置方案进行验证。仿真结果显示各工站设备利用率差异较大，各个工作站作业时间差异较大，工序①②③⑤⑥⑦机器空转时间太长，工序④为干燥工艺， A产线设备利用率达到95%，但是C产线只有24.70%，可以进一步提升，同时工序⑤⑥工作时间短，工序⑧⑨⑩设备利用率达到92%，为瓶颈工序。由于有些工序设备利用率太高，导致物料堆积，出料时间过长，工人空闲时间过多，而有些工序设备利用率太低、设备空转、能量耗费、增加成本等问题，这些显现都使得生产线生产能力不足，生产成本增加，即需要进行产线优化。步骤3、资源配置优化步骤3.1、首先分析输入参数：1）设备数量由于①②③⑤⑥⑦利用率低，可以将各个工序有原先的三条产线合并到两条或者1条，工序⑧⑨⑩为瓶颈工序，可以将原先的一条产线分开至2条及3条，不同产线数对应不同设备的数量，以提高各个设备的利用率，缓解瓶颈工序，减少设备空转时间，减少能源的浪费。设备数量包括各个工序机器手的数量，初始量为25；工序②显影机数量，初始量为3；工序④烘干机数量，初始量为3；工序⑧平整机数量，初始量为1；工序⑨测试机数量，初始量为1。2）各个工序之间的皮带长度各个工序之间的皮带长度会直接影响其成本和工件的最小缓存量，在瓶颈工序可以适当加长皮带长度，在利用率低的工序之间适当减小皮带的长度。3）加工工件的出量间隔和出料数量加工工件的出量间隔和出料数量会直接影响产量，本实施例具体配置初始间隔时间为240s，工料数量为5：3：2。经过上述分析，确定设备数量、各个工序之间的皮带长度以及加工工件的出量间隔和出料数量作为预测模型的输入参数。步骤3.2、确定各个因素初始权重根据产线功能需求主要考虑效率最高、最大产量、和最低投入成本三个目标，且以生产效率最大化为第一目标，以最大产能为第二目标，生产成本最小化为第三目标。采用线性加权系数法，将多目标函数求取最优解问题转化为单目标函数求取最值，该优化函数分为 3个目标函数，依据不同目标函数的不同权重，分别乘以一组权重系数，彼此相加得到单目标函数，如上述式所示，通过调整α1、α2、α3对设备效率、皮带长度、缓存量等进行趋向性优化设计，其中1＞α1＞α2＞α3＞0。各个因素之间的权重可以通过层次分析法，得出比例具体为5：3：2。步骤3.3、基于生产线资源配置DRL算法网络结构设计step①: 搭建DRL神经网络，将输入的各类工序设备的数量、皮带长度、出料间隔以及出料数量，按照多目标函数权重因子α1、α2、α3的初始值确定初始权重，将模型当前时刻出料间隔和出料数量上一时刻的控制变量值作为输入，将下一时刻的控制变量值作为输出，并多次运行仿真模型，共计运行200余次，得到200组观测控制变量值和输出值，得到充足的样本数据。step②：利用step ①的样本数据作为初始训练数据进行迭代训练学习，直到损失函数收敛于平稳状态，网络训练成熟，损失函数计算如式、所示，得到最优资源配置方案，迭代训练过程中通过孪生域中孪生体运行仿真获得DRL神经网络输入数据，使用DRL神经网络得到的下一时刻的输出数据更新孪生域模型以及孪生数据平台中数据。step④: 将训练成熟的网络与PCB数字孪生资源配置系统联接，实时获取控制变量数据输入至训练后的DRL神经网络中，每次输出之后，将这些实时数据与最优调度策略输入到数字孪生域模型中，运行孪生仿真模型，判断系统线平衡损失率，以验证最优PCB产线系统线平衡损失率，确定多级目标优化模型中最终的最优权重系数，即得到最终的最优配置方案，并更新对应的混流生产系统物理域模型、孪生数据平台。本实施例通过输出结果可知，输入的工序①③④由原来的三个设备，改为2个设备；输入的⑧⑨工序设备由原来的一条变为两条，数量由原来的1个设备，分别增添至2个，皮带的总长度由原来的36.15变为25.17；输出的平均机器手利用率为94.15%，再通过线平衡损失率公式进行计算，得到原先的62.59%提高至44.61%，同时各工站装配人员的等待时间减少。即本发明可以有效提高生产线资源配置的有效性，提高生产线的稳定性以及生产效率，同时降低能源消耗率。最后，通过生产计划系统将最优布局方案以管控指令的形式下发至物理装配线，以指导对装配资源的实际调整。本发明通过首先构建自动装配混流生产线资源配置优化的数字孪生总架构模型，包括物理域、孪生域以及孪生数字平台，以及构建自动装配混流生产线资源配置多级目标优化模型，利用深度强化学习与数字孪生系统的交互实现对最优资源配置方案的迭代求解，通过对孪生域中孪生体运行仿真获得深度强化学习网络输入数据，经过不断迭代求解得到优化策略以对资源配置方案进行调整，能够结合数字孪生技术以及深度学习方式实现高效的自动装配混流生产线布局的智能在线优化方法，不仅能够实现实时检测，有效增强产线稳定性，还能够提高车间生产效率，同时降低能源消耗率。本实施例还提供基于数字孪生的自动装配混流生产线布局优化装置包括：自动装配混流生产线资源配置优化的数字孪生系统，系统中包括混流生产系统物理域模型、孪生域模型、孪生数据平台，孪生域模型包括虚拟生产线孪生体以实现与混流生产系统物理域模型的数据映射，孪生数据平台用于收集混流生产系统物理域模型的历史运行数据、实时运行数据以及提供实时运行数据给孪生域模型；优化模型构建模块，用于以生产线效率最大、产量最大以及投入成本最小作为多级优化目标，将各级优化目标加权构建形成自动装配混流生产线资源配置的目标优化模型；布局优化模块，用于根据孪生数据平台中数据配置目标优化模型中各级优化目标的权重系数，确定得到生产线布局方案，不断从孪生数据平台中获取各级优化目标所对应的控制变量数据，按照确定得到的生产线布局方案输入至神经网络模型中进行迭代求解，直至得到满足预设性能要求的最优生产线布局方案，在迭代求解过程中根据迭代求解结果更新孪生域模型以及孪生数据平台中数据。本实施例中，优化模型构建模块与布局优化模块具体通过一个产线优化及评估模块实现，由该产线优化及评估模块进行初始产线布局配置以及最优生产线布局方案的迭代求解以及评估，最终得到最优产线配置方案。本实施例基于数字孪生的自动装配混流生产线布局优化系统与上述基于数字孪生的自动装配混流生产线布局优化方法对应，在此不再一一赘述。本实施例还提供一种计算机装置，包括处理器以及存储器，存储器用于存储计算机程序，处理器用于执行计算机程序以执行如上述方法。可以理解的是，本实施例上述方法可以由单个设备执行，例如一台计算机或服务器等，也可以应用于分布式场景下由多台设备相互配合来完成，在分布式场景的情况下，多台设备中的一台设备可以只执行本实施例上述方法中的某一个或多个步骤，多台设备之间进行交互以完成上述方法。处理器可以采用通用的CPU、微处理器、应用专用集成电路、或者一个或多个集成电路等方式实现，用于执行相关程序，以实现本实施例上述方法。存储器可以采用只读存储器ROM、随机存取存储器RAM、静态存储设备以及动态存储设备等形式实现。存储器可以存储操作系统和其他应用程序，在通过软件或者固件来实现本实施例上述方法时，相关的程序代码保存在存储器中，并由处理器来调用执行。上述只是本发明的较佳实施例，并非对本发明作任何形式上的限制。虽然本发明已以较佳实施例揭露如上，然而并非用以限定本发明。因此，凡是未脱离本发明技术方案的内容，依据本发明技术实质对以上实施例所做的任何简单修改、等同变化及修饰，均应落在本发明技术方案保护的范围内。
