标题title
一种分布式光伏有功的多系统数据融合方法
摘要abst
本发明公开了一种分布式光伏有功的多系统数据融合方法，该方法利用新能源云P云、配电平台P配、功率预测P测、用采系统P用、融合终端P端、源网荷储P源，通过归一化出力，过滤质量差的数据，通过一致性校验后，根据贝叶斯估计，利用输入输出特性，构建似然模型，形成基于概率判定的多源回归方程；当模型完成训练后，通过马尔科夫蒙特卡罗模拟，完成数据校验，生成多源融合后的数据。该方法可以在不进行设备改造升级和增加成本的情况下，通过对预测系统、用采系统、配电自动化系统、分布式新能源云主站等不同数据源、不同时间尺度的数据进行深度挖掘、训练、整合，实现对分布式光伏出力的清楚预知。
权利要求书clms
1.一种分布式光伏有功的多系统数据融合方法，其特征在于，具体包括以下步骤：步骤1，当一个采集周期到来时，通过通讯接口分别获取新能源云P云、配电平台P配、功率预测P测、用采系统P用、融合终端P端、源网荷储P源，功率分别为P1；步骤2，对当前功率单位量纲统一，然后进行数据归一化处理，分布式光伏容量为C1，通过利用出力/容量的公式，得到归一化后的数值；步骤3，区分无效值及缺失值出力；数值归一化后，出力区间在【0,1】内，当出现大于1或小于0的数后则认为是坏量测，进行删除；步骤4，两个周期之间的时间窗内，定义当前采集周期时间为t1，上一个采集周期时间为t0，则时间窗为tt0，获取多个量测P1，P2...Pn，则 步骤5，一致性校验，针对完成归一化后的数值，若在同一个时间窗内，则认为数据有效；若时间窗内均无效，则以两个时间窗为计数单位寻找有效数据；当超过三个时间窗还未产生有效数据，则取最近时刻量测且不做时标判定；步骤6，利用观测积累历史数据，构建分布式光伏多源融合特征矩阵Ym，为先验结果数据集，并构建系统的多元线性关系方程；若要得到多源融合数据，则将分布式光伏多源融合特征矩阵的求解，变为B和σ2求解；步骤7，利用输出量测系统的贝叶斯估计框架的似然函数求解，似然函数如下： ； 式中n代表先验数据集总数，在贝叶斯参数估计的框架中需要识别的参数为；步骤8，求解B和σ2步骤9，此时后验分布函数的求解即成为历史积累数据的选择，通过Ym、X’的选择，使其曲线收敛，则完成对此后验分布函数求解，同理可求得不同概率下的B1、B2、B3、B4、B5、B6、σ2；步骤10，当关注量为不确定参数的最大后验估计值时，可以通过对马尔可夫链样本进行概率分布拟合的方式得到后验分布/＞的函数表达，进一步采用下式计算最大后验估计值MAP，MaximumAposterioriEstimation： ；步骤11，通过步骤6、7、8、9、10，求解得到基于马尔科夫蒙特卡洛方法下贝叶斯估计模型的分布式光伏多源融合方程：；步骤12，融合数据校验方法，若出现＞1,或/＞＜0的情况，则需要做以下处理：P拟＜0时，P融=0；0＜P拟＜1时，P融=P拟；P拟＞1时，P融=1；此时需要查看B1、B2、B3、B4、B5、B6、σ2，对Ym、X’的样本进行扩充，增强筛选条件；步骤13，根据12步获取P融得到分布式光伏出力：P=P融*P额 ；式中P额为分布式光伏额定出力。2.根据权利要求1所述的一种分布式光伏有功的多系统数据融合方法，其特征在于：所述步骤6进行时，需先验输入值X’中x1，x2，x3，x4，x5，x6的统计分布信息的条件下，对系统参数向量B进行反演推导；观测值与真实值之间的差异为高斯噪声，假设高斯噪声为独立分布的观测误差，其中Σ6为6*6的协方差矩阵；此时系统的多元线性关系方程表达为：； 其中：。3.根据权利要求1所述的一种分布式光伏有功的多系统数据融合方法，其特征在于：所述步骤8进行时，B中的参数和σ2认定为其准确度受各自系统的采集、传输、存储方式影响，彼此相互独立，因此分布式光伏数据融合联合先验表达式表示如下：；通过式4得到各个参数互相之间的关系是独立的，因此式4可表达为： ；其中，由于对待求参数B,σ2没有任何先验知识，故人工选择将待求参数Bi的先验分布设置为区间【0,100】上的均匀分布作为无信息先验： 式中，Bi服从均值为0，方差为100的正态分布，这样可以保证分布式光伏融合的参数范围足够大，用以有效表达实际真实值；对于独立分布的观测误差σ2的先验分布，则认为是服从于逆Gamma分布的共轭分布，设其形状参数为0.1，尺度参数为0.001： ；根据贝叶斯定理，为了获得后验分布，对参数θ求积分的方式得到观测值ψ的边缘分布P，而将观测值ψ和参数θ分离，得ψ到下式：；综上将式3、5代入贝叶斯公式8得到后验分布概率函数： ； 利用3式得到对θ的求解，即对B和σ2的求解。4.根据权利要求1所述的一种分布式光伏有功的多系统数据融合方法，其特征在于：所述步骤9中的B1、B2、B3、B4、B5、B6、σ2采用马尔科夫蒙特卡洛方法计算，方法如下：A1：确定一组初始化样本作为马尔科夫链样本的初始状态；A2：从T=0,1,2……N-1，执行如下循坏，直至马尔科夫链样本收敛：；式中表示Ym、X’的历史量测数据，/＞代表专家经验选取的先验模型；为了减少估计的初始样本对马尔科夫链状态的影响，去除前k次处于过渡段的马尔科夫样本，即可得到概率分布函数趋近于的马尔可夫链样本/＞，其中/＞，此时B求解完成；A3：求解σ2； Ê为后验分布下的B关注量Q的期望值。
说明书desc
技术领域本发明涉及供配电系统融合技术领域，具体为一种分布式光伏有功的多系统数据融合方法。背景技术随着分布式新能源广泛建设，大量分布式光伏接入配电网，潮流单向流动改变为潮流多向流动，传统的配电网变为有源配电网，在特殊天气或运行方式下将产生局部过电压、欠电压、重过载等问题，严重影响配电网的运行安全。分布式新能源呈现点多、面广、量大的问题，采用传统光纤接入方案，将产生巨大成本，采用无线接入，又存在时效性差、可靠性低等问题；因此无法准确知道分布式光伏实时出力信息，将存在以下若干问题：1、在有源配电网环境下，检修场景下，若不知道分布式光伏出力情况，无法准确判断分布式光伏是否离网，造成检修人员带电作业，产生人身事故；2、在有源配电网环境下，调控场景下，若不知道分布式光伏出力情况，无法准确判定分布式光伏发电趋势，不能够精准调控，从而造成严重的经济损失；3、在有源配电网环境下，设备风险场景下，分布式光伏出力的未知，无法判定风险严重等级，无法运用精准的平抑手段，轻则造成设备寿命的降低，重则产生设备损毁事故；4、在有源配电网环境下，无功调控场景下，分布式光伏出力的未知，有功的频繁变化，导致上一级的无功设备频繁投切，造成设备寿命的降低；综上可知，随着分布式光伏的规模化快速发展，如何排除干扰，实现对分布式光伏出力和出力趋势进行清晰的感知，已成为本领域人员亟待解决的技术问题。发明内容本发明的目的在于克服现有技术的不足之处，提供一种分布式光伏有功的多系统数据融合方法，该方法可以在不进行设备改造升级和增加成本的情况下，通过对预测系统、用采系统、配电自动化系统、分布式新能源云主站等不同数据源、不同时间尺度的数据进行深度挖掘、训练、整合，实现对分布式光伏出力的清楚预知。本发明公开了一种分布式光伏有功的多系统数据融合方法，具体包括以下步骤：步骤1，当一个采集周期到来时，通过通讯接口分别获取新能源云P云、配电平台P配、功率预测P测、用采系统P用、融合终端P端、源网荷储P源，功率分别为P1；步骤2，对当前功率单位量纲统一，然后进行数据归一化处理，分布式光伏容量为C1，通过利用出力/容量的公式，得到归一化后的数值；步骤3，区分无效值及缺失值出力；数值归一化后，出力区间在【0,1】内，当出现大于1或小于0的数后则认为是坏量测，进行删除；步骤4，两个周期之间的时间窗内，定义当前采集周期时间为t1，上一个采集周期时间为t0，则时间窗为tt0，获取多个量测P1，P2...Pn，则 步骤5，一致性校验，针对完成归一化后的数值，若在同一个时间窗内，则认为数据有效；若时间窗内均无效，则以两个时间窗为计数单位寻找有效数据；当超过三个时间窗还未产生有效数据，则取最近时刻量测且不做时标判定；步骤6，利用观测积累历史数据，构建分布式光伏多源融合特征矩阵Ym，为先验结果数据集，并构建系统的多元线性关系方程；若要得到多源融合数据，则将分布式光伏多源融合特征矩阵的求解，变为B和σ2求解；步骤7，利用输出量测系统的贝叶斯估计框架的似然函数求解，似然函数如下： ； 式中n代表先验数据集总数，在贝叶斯参数估计的框架中需要识别的参数为；步骤8，求解B和σ2步骤9，此时后验分布函数的求解即成为历史积累数据的选择，通过Ym、X’的选择，使其曲线收敛，则完成对此后验分布函数求解，同理可求得不同概率下的B1、B2、B3、B4、B5、B6、σ2；步骤10，当关注量为不确定参数B的最大后验估计值时，可以通过对马尔可夫链样本进行概率分布拟合的方式得到后验分布/＞的函数表达，进一步采用下式计算最大后验估计值MAP，MaximumAposterioriEstimation： ；步骤11，通过步骤6、7、8、9、10，求解得到基于马尔科夫蒙特卡洛方法下贝叶斯估计模型的分布式光伏多源融合方程：；步骤12，融合数据校验方法，若出现P拟＞1,或P拟＜0的情况，则需要做以下处理：P拟＜0时，P融=0；0＜P拟＜1时，P融=P拟；P拟＞1时，P融=1；此时需要查看B1、B2、B3、B4、B5、B6、σ2，对Ym、X’的样本进行扩充，增强筛选条件；步骤13，根据12步获取P融得到分布式光伏出力：P=P融*P额 ；式中P额为分布式光伏额定出力。优选的，步骤6进行时，需先验输入值X’中x1，x2，x3，x4，x5，x6的统计分布信息的条件下，对系统参数向量B进行反演推导；观测值与真实值之间的差异为高斯噪声，假设高斯噪声为独立分布的观测误差，其中Σ6为6*6的协方差矩阵；此时系统的多元线性关系方程表达为：； 其中：。优选的，步骤8进行时，B中的参数和σ2认定为其准确度受各自系统的采集、传输、存储方式影响，彼此相互独立，因此分布式光伏数据融合联合先验表达式表示如下：；通过式4得到各个参数互相之间的关系是独立的，因此式4可表达为： ；其中，由于对待求参数B,σ2没有任何先验知识，故人工选择将待求参数Bi的先验分布设置为区间【0,100】上的均匀分布作为无信息先验： 式中，Bi服从均值为0，方差为100的正态分布，这样可以保证分布式光伏融合的参数范围足够大，用以有效表达实际真实值；对于独立分布的观测误差σ2的先验分布，则认为是服从于逆Gamma分布的共轭分布，设其形状参数为0.1，尺度参数为0.001： ；根据贝叶斯定理，为了获得后验分布，对参数θ求积分的方式得到观测值ψ的边缘分布P，而将观测值ψ和参数θ分离，得ψ到下式：；综上将式3、5代入贝叶斯公式8得到后验分布概率函数： ； 利用3式得到对θ的求解，即对B和σ2的求解。优选的，步骤9中的B1、B2、B3、B4、B5、B6、σ2采用马尔科夫蒙特卡洛方法计算，方法如下：A1：确定一组初始化样本作为马尔科夫链样本的初始状态；A2：从T=0,1,2……N-1，执行如下循坏，直至马尔科夫链样本收敛：；式中表示Ym、X’的历史量测数据，/＞代表专家经验选取的先验模型；为了减少估计的初始样本对马尔科夫链状态的影响，去除前k次处于过渡段的马尔科夫样本，即可得到概率分布函数趋近于的马尔可夫链样本/＞，其中/＞，此时B求解完成；A3：求解σ2； Ê为后验分布下的B关注量Q的期望值。本发明的优点和技术效果是：本发明的一种分布式光伏有功的多系统数据融合方法，利用新能源云P云、配电平台P配、功率预测P测、用采系统P用、融合终端P端、源网荷储P源，通过归一化出力，过滤质量差的数据，通过一致性校验后，根据贝叶斯估计，利用输入输出特性，构建似然模型，形成基于概率判定的多源回归方程；当模型完成训练后，通过马尔科夫蒙特卡罗模拟，完成数据校验，生成多源融合后的数据。本发明根据目前分布式新能源点多、面广、量大的现状和特点，设计了从新能源云、配电平台、功率预测、用采系统、融合终端、源网荷储等多个系统获取分布式新能源有功出力P，在不增加硬件的基础上达到能精准预估分布式新能源出力。本发明利用传统的贝叶斯估计模型和马尔科夫蒙特卡洛方法进行样本选择，在大数据挖掘的前提下，利用多种传统方法进行融合，对构建数字化配电网、以新能源为主体的新型电力系统，起到了关键性助力。本发明结合目前电力数据接入现状，存在同源异构，多系统数据贯通，数据无法结合使用，高效利用现状；开展了积极有效探索，可为大数据样本海量挖掘起到引领示范作用。最后，本发明不仅适用于分布式光伏，其余分布式新能源、配电网负荷，存在多个系统接入均可使用，具有广泛推广性；附图说明图1为本发明的方法流程图；图2为本发明中融合有功和实际有功对比曲线图；图3为本发明中融合有功的数据偏差百分比曲线图。具体实施方式为能进一步了解本发明的内容、特点及功效，兹例举以下实施例，并配合附图详细说明如下。需要说明的是，本实施例是描述性的，不是限定性的，不能由此限定本发明的保护范围。本发明的一种分布式光伏有功的多系统数据融合方法，同样也是一种针对分布式光伏多源信息的数据融合方法，主要利用新能源云P云、配电平台P配、功率预测P测、用采系统P用、融合终端P端、源网荷储P源，通过归一化出力，过滤质量差的数据，通过一致性校验后，根据贝叶斯估计，利用输入输出特性，构建似然模型，形成基于概率判定的多源回归方程；当模型完成训练后，通过马尔科夫蒙特卡罗模拟，完成数据校验，生成多源融合后的数据，具体方法如下：1、当一个采集周期到来时，通过通讯接口分别获取新能源云P云、配电平台P配、功率预测P测、用采系统P用、融合终端P端、源网荷储P源，功率分别为P1；2、对当前功率单位量纲统一，然后进行数据归一化处理，分布式光伏容量为C1，通过利用出力/容量的公式，得到归一化后的数值；3、无效值及缺失值出力；数值归一化后，出力区间在【0,1】内，当出现大于1或小于0的数后则认为是坏量测，进行删除；4、两个周期之间的时间窗内，比如当前采集周期时间为t1，上一个采集周期时间为t0，则时间窗为tt0，获取多个量测P1，P2...Pn，则 5、一致性校验，针对完成归一化后的数值，若在同一个时间窗内，则认为数据有效；若时间窗内均无效，则以两个时间窗为计数单位寻找有效数据；当超过三个时间窗还未产生有效数据，则取最近时刻量测且不做时标判定；6、利用观测积累历史数据，构建分布式光伏多源融合特征矩阵Ym，为先验结果数据集，先验输入值X’中x1，x2，x3，x4，x5，x6,的统计分布信息的条件下，对系统参数向量B进行反演推导；观测值与真实值之间的差异为高斯噪声，假设高斯噪声为独立分布的观测误差/＞，其中Σ6为6*6的协方差矩阵；此时系统的多元线性关系方程表达为：； 其中：；若要得到多源融合数据，则将分布式光伏多源融合特征矩阵的求解，变为B和σ2求解；利用输出量测系统的贝叶斯估计框架的似然函数求解，似然函数如下： ； 式中n代表先验数据集总数，在贝叶斯参数估计的框架中需要识别的参数为；6、B和σ2的求解，B中的参数和σ2认定为其准确度受各自系统的采集、传输、存储方式影响，彼此相互独立，因此分布式光伏数据融合联合先验表达式表示如下：；通过式4得到各个参数互相之间的关系是独立的，因此式4可表达为： ；其中，由于对待求参数B,σ2没有任何先验知识，故人工选择将待求参数Bi的先验分布设置为区间【0,100】上的均匀分布作为无信息先验： 式中，Bi服从均值为0，方差为100的正态分布，这样可以保证分布式光伏融合的参数范围足够大，用以有效表达实际真实值；对于独立分布的观测误差σ2的先验分布，则认为是服从于逆Gamma分布的共轭分布，设其形状参数为0.1，尺度参数为0.001： 7、根据贝叶斯定理，为了获得后验分布，对参数θ求积分的方式得到观测值ψ的边缘分布P，而将观测值ψ和参数θ分离，得ψ到下式：8、综上将式3、5代入贝叶斯公式8得到后验分布概率函数利用3式得到对θ的求解，即对B和σ2的求解；9、此时后验分布函数的求解即成为历史积累数据的选择，通过Ym、X’的选择，使其曲线收敛，则完成对此后验分布函数求解，同理可求得不同概率下的B1、B2、B3、B4、B5、B6、σ2；B1、B2、B3、B4、B5、B6、σ2采用马尔科夫蒙特卡洛方法计算，方法如下：A1：确定一组初始化样本作为马尔科夫链样本的初始状态;A2：从T=0,1,2……N-1，执行如下循坏，直至马尔科夫链样本收敛：;式中表示Ym、X’的历史量测数据，/＞代表专家经验选取的先验模型；为了减少估计的初始样本对马尔科夫链状态的影响，去除前k次处于过渡段的马尔科夫样本，即可得到概率分布函数趋近于的马尔可夫链样本/＞，其中/＞，此时B求解完成；A3：求解σ2; Ê为后验分布下的B关注量Q的期望值；10、当关注量为不确定参数B的最大后验估计值时，可以通过对马尔可夫链样本进行概率分布拟合的方式得到后验分布/＞的函数表达，进一步采用下式计算最大后验估计值MAP，MaximumAposterioriEstimation： ;10、通过6、7、8、9、10共5步，求解得到基于马尔科夫蒙特卡洛方法下贝叶斯估计模型的分布式光伏多源融合方程： ; 11、融合数据校验方法，同步骤2，若出现＞1,或＜0的情况，则需要做以下处理：P拟＜0时，P融=0；0＜P拟＜1时，P融=P拟；P拟＞1时，P融=1；此时需要查看B1、B2、B3、B4、B5、B6、σ2，对Ym、X’的样本进行扩充，增强筛选条件；12、根据12步获取P融得到分布式光伏出力：P=P融*P额式中P额为分布式光伏额定出力。最后，本发明的未述之处均采用现有技术中的成熟产品及成熟技术手段。应当理解的是，对本领域普通技术人员来说，可以根据上述说明加以改进或变换，而所有这些改进和变换都应属于本发明所附权利要求的保护范围。
