标题title
一种基于深度学习的髋臼杯角度自适应确定方法及装置
摘要abst
本申请提供了一种基于深度学习的髋臼杯角度自适应确定方法及装置，所述方法包括：基于股骨柄内植入的传感器，获取单个对象的传感器数据；基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；确定筛选后的每组规律数据对应的髋臼杯轴线；基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。本申请中，通过设置在股骨柄假体内的传感器采集单个对象的假体运动数据，并基于该假体运动数据确定该对象的最佳髋臼杯角度，从而大大增加单个患者与髋臼杯角度的适应性。
权利要求书clms
1.一种基于深度学习的髋臼杯角度自适应确定方法，其特征在于，包括：基于股骨柄内植入的传感器，获取单个对象的传感器数据，所述传感器数据包括轴向数据和定位数据；基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；确定筛选后的每组规律数据对应的髋臼杯轴线；基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。2.根据权利要求1所述的髋臼杯角度自适应确定方法，其特征在于，所述基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型，包括：从所述单个对象的传感器数据中随机选取多组训练数据，所述训练数据包括预设数量的传感器数据，且最后一个所述传感器数据为标注数据；将多组训练数据输入第一支路的多个第一Transformer Block模块，得到第一编码数据；将多组训练数据输入第二支路的多个第一Transformer Block模块，得到第二编码数据；将所述第一编码数据和第二编码数据相加后输入多个第二Transformer Block模块，得到预测传感器数据；基于所述标注数据和所述预测传感器数据，计算每组训练数据的预测损失，并筛除预测损失大于预设阈值的组；基于保留的训练数据计算整体预测损失，基于所述第一编码数据和第二编码数据，计算整体相似损失，并通过所述整体相似损失和所述整体预测损失，计算所述位置预测模型的整体损失；基于所述整体损失迭代所述位置预测模型，直至损失收敛为止。3.根据权利要求2所述的髋臼杯角度自适应确定方法，其特征在于，所述整体预测损失的计算公式为：其中，n为筛选后的训练数据的组数，i为组序号，为第i组训练数据的预测传感器数据，为第i组训练数据的标注数据，α、β为权重系数。4.根据权利要求1-3中任一项所述的髋臼杯角度自适应确定方法，其特征在于，所述基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度之前，还包括：对确定后的多个所述髋臼杯轴线进行二次筛选，得到筛选后的所述髋臼杯轴线。5.根据权利要求4所述的髋臼杯角度自适应确定方法，其特征在于，所述对确定后的多个所述髋臼杯轴线进行二次筛选，得到筛选后的所述髋臼杯轴线，包括：获取髋臼杯的允许偏折角；将所述对象的每组规律数据映射为股骨头运动参数；基于所述允许偏折角和多个所述髋臼杯轴线，判断对应组所述股骨头运动参数是否均处于该组所述髋臼杯的允许偏折角内；在所述股骨头运动参数均处于所述髋臼杯的允许偏折角内的情况下，保留该髋臼杯对应的髋臼杯轴线。6.根据权利要求1-3中任一项所述的髋臼杯角度自适应确定方法，其特征在于，所述确定筛选后的每组规律数据对应的髋臼杯轴线，包括：构建传感器数据与股骨头运动参数的映射关系，所述股骨头运动参数包括定位参数和方向参数；基于所述映射关系将所述规律数据映射为所述股骨头运动参数；基于所述股骨头运动参数计算所述股骨头运动参数对应的直线两两之间的交点；基于所述股骨头运动参数对应的多个交点确定每组股骨头运动参数对应的髋臼旋转中心；基于所述方向参数确定每组股骨头运动参数对应的轴线方向；根据所述髋臼旋转中心和所述轴线方向，确定每组股骨头运动参数对应的髋臼杯轴线。7.根据权利要求1-3中任一项所述的髋臼杯角度自适应确定方法，其特征在于，所述传感器通过体外无线充电方式进行供电。8.一种基于深度学习的髋臼杯角度自适应确定装置，其特征在于，包括：数据获取模块，其用于基于股骨柄内植入的传感器，获取单个对象的传感器数据，所述传感器数据包括轴向数据和定位数据；模型训练模块，其用于基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；数据筛选模块，其用于基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；轴线确定模块，其用于确定筛选后的每组规律数据对应的髋臼杯轴线；角度确定模块，其用于基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。9.一种电子设备，其特征在于，包括：存储器和处理器；所述存储器，其用于存储程序；所述处理器，耦合至所述存储器，用于执行所述程序，以用于：基于股骨柄内植入的传感器，获取单个对象的传感器数据，所述传感器数据包括轴向数据和定位数据；基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；确定筛选后的每组规律数据对应的髋臼杯轴线；基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述程序被处理器执行实现权利要求1-7任一项所述的基于深度学习的髋臼杯角度自适应确定方法。
说明书desc
技术领域本申请涉及数据处理技术领域，具体而言，涉及一种基于深度学习的髋臼杯角度自适应确定方法及装置。背景技术髋关节置换手术，也称为髋关节置换术或人工髋关节置换手术，是一种常见的外科手术，用于治疗髋关节严重损伤或疾病导致的疼痛和功能障碍。这种手术旨在恢复患者的髋关节功能，并显著减轻髋部疼痛，从而提高患者的生活质量。髋关节置换手术的核心之一是确定患者正确的髋臼杯角度，从而准确地置换髋关节，减少置换关节对患者日常生活的负面影响。当前一般通过患者的医学图像结合髋臼杯理论角度等确定患者的髋臼杯角度，这种确定方式获取的髋臼杯角度虽然对所有患者均有一定普适性，但是对于单个患者而言效果较差。发明内容本申请解决的问题是当前髋臼杯角度的确定对单个患者效果较差。为解决上述问题，本申请第一方面提供了一种基于深度学习的髋臼杯角度自适应确定方法，包括：基于股骨柄内植入的传感器，获取单个对象的传感器数据，所述传感器数据包括轴向数据和定位数据；基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；确定筛选后的每组规律数据对应的髋臼杯轴线；基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。本申请第二方面提供了一种基于深度学习的髋臼杯角度自适应确定装置，其包括：数据获取模块，其用于基于股骨柄内植入的传感器，获取单个对象的传感器数据，所述传感器数据包括轴向数据和定位数据；模型训练模块，其用于基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；数据筛选模块，其用于基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；轴线确定模块，其用于确定筛选后的每组规律数据对应的髋臼杯轴线；角度确定模块，其用于基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。本申请第三方面提供了一种电子设备，其包括：存储器和处理器；所述存储器，其用于存储程序；所述处理器，耦合至所述存储器，用于执行所述程序，以用于：基于股骨柄内植入的传感器，获取单个对象的传感器数据，所述传感器数据包括轴向数据和定位数据；基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；确定筛选后的每组规律数据对应的髋臼杯轴线；基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。本申请第四方面提供了一种计算机可读存储介质，其上存储有计算机程序，所述程序被处理器执行实现上述所述的基于深度学习的髋臼杯角度自适应确定方法。本申请中，通过设置在股骨柄假体内的传感器采集单个对象的假体运动数据，并基于该假体运动数据确定该对象的最佳髋臼杯角度，从而通过单个对象的实际数据获取单个患者的最佳髋臼杯角度，该获取的最佳髋臼杯角度与患者的实际运动情况对应，从而大大增加单个患者与髋臼杯角度的适应性。本申请中，通过设置在股骨柄假体内的传感器采集单个对象的假体运动数据，为患者的动态数据，该数据可以准确反映患者的实际状态；且通过单个对象的假体运动数据确定该对象的最佳髋臼杯角度，从而可以建立髋臼杯角度与所述对象的肌肉发力、运动情况的严格对应关系，从而可以高度适配置换后的髋关节假体，避免髋关节假体置换后的重新适应。附图说明图1为根据本申请实施例的髋臼杯角度自适应确定方法的流程图；图2为根据本申请实施例的假体中传感器植入位置的示意图；图3为根据本申请实施例的髋臼杯角度自适应确定方法模型训练的流程图；图4为根据本申请实施例的髋臼杯角度自适应确定方法位置预测模型的原理图；图5为根据本申请实施例的髋臼杯角度自适应确定方法位置预测模型的架构图；图6为根据本申请实施例的髋臼杯角度自适应确定方法轴线确定的流程图；图7为根据本申请实施例的髋臼杯角度自适应确定方法二次筛选的流程图；图8为根据本申请实施例的髋臼杯角度自适应确定装置的结构框图；图9为根据本申请实施例的电子设备的结构框图。具体实施方式为使本申请的上述目的、特征和优点能够更为明显易懂，下面结合附图对本申请的具体实施例做详细的说明。虽然附图中显示了本申请的示例性实施方式，然而应当理解，可以以各种形式实现本申请而不应被这里阐述的实施方式所限制。相反，提供这些实施方式是为了能够更透彻地理解本申请，并且能够将本申请的范围完整的传达给本领域的技术人员。需要注意的是，除非另有说明，本申请使用的技术术语或者科学术语应当为本申请所属领域技术人员所理解的通常意义。当前一般通过患者的医学图像结合髋臼杯理论角度等确定患者的髋臼杯角度，这种确定方式获取的髋臼杯角度虽然对所有患者均有一定普适性。但是一方面患者的医学图像是静态图像，其所反映的髋臼杯角度与患者的实际状态具有一定的出入性；另一方面髋臼杯理论角度是通过对所有人类骨骼模型及运动状态总结确定的，针对的是普适性，但是这种普适性并不会针对不同个体的特殊情况进行调整。所以基于医学图像结合髋臼杯理论角度等确定的患者的髋臼杯角度，虽然具有普适性，但是对于具体的患者个体而言，其肌肉发力及运动情况适用的是置换前的髋关节，与置换后的髋关节假体适配性较低，需要在髋关节假体置换后进行重新适应。针对上述问题，本申请提供一种新的基于深度学习的髋臼杯角度自适应确定方案，能够通过残差注意力机制进行医学图像的去噪学习，解决当前医学图像处理中缺乏医学去噪的方式的问题。为了便于理解，在此对下述可能使用的术语进行解释：无线充电：也称作称无线供电WPT，是以耦合的电磁场为媒介实现电能传递。本申请实施例提供了一种基于深度学习的髋臼杯角度自适应确定方法，该方法的具体方案由图1-图5所示，该方法可以由基于深度学习的髋臼杯角度自适应确定装置来执行，该基于深度学习的髋臼杯角度自适应确定装置可以集成在电脑、服务器、计算机、服务器集群、数据中心等电子设备中。结合图1、图2所示，其为根据本申请一个实施例的基于深度学习的髋臼杯角度自适应确定方法的流程图；其中，所述基于深度学习的髋臼杯角度自适应确定方法，包括：S100，基于股骨柄内植入的传感器，获取单个对象的传感器数据，所述传感器数据包括轴向数据和定位数据；本申请中，植入所述股骨柄内的传感器可以为加速度传感器、方向传感器、陀螺仪传感器、重力传感器等的一个或多个的复合，从而可以输出/测量传感器本身的轴向数据和定位数据。结合图2所示，其为传感器在股骨柄内的植入位置，需要说明的是，该植入位置为推荐植入位置，但传感器也可以以其他位置进行植入，具体植入以实际需求为准。本申请中，植入所述股骨柄内的传感器与所述股骨柄为一体化或固定结构，从而可以将传感器本身的轴向数据和定位数据近似认定为股骨柄的轴向数据和定位数据。需要说明的是，将传感器本身的轴向数据和定位数据近似认定为股骨柄的轴向数据和定位数据，是基于传感器在股骨柄内的具体位置将将传感器本身的轴向数据和定位数据映射为股骨柄的轴向数据和定位数据；本申请中，可以通过基于多次实验等的方式将传感器植入股骨柄内的特定位置，从而将传感器本身的轴向数据和定位数据直接作为股骨柄的轴向数据和定位数据。需要说明的是，本申请中，先将传感器本身的轴向数据和定位数据映射为股骨柄的轴向数据和定位数据，再将股骨柄的轴向数据和定位数据映射为所述股骨头运动参数；因此股骨柄的轴向数据和定位数据实质上为映射的中间数据，在两个映射规则确定的情况下，也可以直接对传感器本身的轴向数据和定位数据进行下述的数据处理，并在需要时直接映射为所述股骨头运动参数，从而省略映射的中间数据，节约映射次数和计算量。在一种实施方式中，所述传感器通过体外无线充电方式进行供电。本申请中，通过将传感器设置为体外供电，从而可以无需在传感器内设置供电或蓄电设备，避免供电或蓄电设备对人体的污染与伤害。需要说明的是，现有的传感器无法直接用于体内，主要原因是需要设置供电或蓄电设备，而这些设备具有高污染性，植入人体会造成极大的潜在伤害。需要说明的是，无线充电是以耦合的电磁场为媒介实现电能传递，在使用无线充电的情况下，传感器应当为不使用磁场进行测量的传感器。S200，基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型；本申请中，不同对象的运动习惯不同，且髋臼杯角度不同，为了达到更准确的训练和预测，使用单个对象的传感器数据进行训练，以排除不同对象的运动习惯的干扰。S300，基于训练完成的位置预测模型，从所述单个对象的传感器数据中筛选出多组规律数据；本申请中，传感器数据大致由单一对象的身体运动轨迹以及髋关节相对于身体的运动信息组成，其中身体运动轨迹关联所述对象的运动意图，无法进行预测；通过筛选出规律数据，从而可以避开单一对象的无规则运动，从而减小甚至消除身体运动轨迹对传感器数据的影响。本申请中，可以通过位置预测模型确定规律数据，具体可以为：输入连续的N-1个传感器数据，预测第N个传感器数据；若预测的传感器数据与实际的传感器数据的差值小于预设的阈值，则该N个传感器数据均为规律数据。本申请中，通过位置预测模型可以对单一对象的传感器数据进行筛选，确定其中的规律数据；基于每组规律数据的预设数量，可以通过随机的方式确定多组规律数据。需要说明的是，每组规律数据为连续数据，具体获取时在筛选出的规律数据中，首先选取连续的数量超出所述预设数量的连续规律数据的序列，然后在此序列中随机选取预设数量的连续数据作为一组规律数据。S400，确定筛选后的每组规律数据对应的髋臼杯轴线；本步骤中，确认每组规律数据对应的髋臼杯轴线，也即是根据规律数据计算/确定对应的髋臼杯轴线。本申请中，所述髋臼杯轴线，是与股骨头对应的髋臼杯的中心轴线，该中心轴线并非实际安装中的髋臼杯假体的中心轴线，而是依据股骨头/股骨运动数据推测出的髋臼杯的中心轴线；S500，基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。本步骤中，对于同一个髋臼杯而言，其髋臼杯轴线与髋臼杯角度具有映射关系，基于该映射关系可以确定最佳髋臼杯轴线对应的最佳髋臼杯角度。本申请中，通过设置在股骨柄假体内的传感器采集单个对象的假体运动数据，并基于该假体运动数据确定该对象的最佳髋臼杯角度，从而通过单个对象的实际数据获取单个患者的最佳髋臼杯角度，该获取的最佳髋臼杯角度与患者的实际运动情况对应，从而大大增加单个患者与髋臼杯角度的适应性。本申请中，通过设置在股骨柄假体内的传感器采集单个对象的假体运动数据，为患者的动态数据，该数据可以准确反映患者的实际状态；且通过单个对象的假体运动数据确定该对象的最佳髋臼杯角度，从而可以建立髋臼杯角度与所述对象的肌肉发力、运动情况的严格对应关系，从而可以高度适配置换后的髋关节假体，避免髋关节假体置换后的重新适应。本申请中，单个对象的传感器持续获取测量数据，可以通过设置采样周期对测量数据进行采样，作为传感器数据。本申请中，所述传感器数据具有时序关系，在对预测模型进行训练时，可以将固定数量的传感器数据作为一组传感器数据进行训练，该组传感器数据的最后一个数据作为标注数据，前N个数据为训练数据；从而可以直接提取传感器数据进行训练，无需额外标注。本申请中，多组传感器数据之间的数据可以叠加；也即是说对于N+6个数据而言，其中1～作为一组传感器数据，2～作为另一组传感器数据。通过多组传感器数据之间的叠加，可以在传感器数据较少时，生成极大量组训练数据，以提高训练效果。本申请中，多组传感器数据为随机选取，以排除规律选取所遵循的规律在训练过程中的干扰。在一种实施方式中，结合图3所示，在一种实施方式中，所述S200，基于所述单个对象的传感器数据对位置预测模型进行训练，得到训练完成的位置预测模型，包括：S201，从所述单个对象的传感器数据中随机选取多组训练数据，所述训练数据包括预设数量的传感器数据，且最后一个所述传感器数据为标注数据；本申请中，传感器数据为时序数据，选取连续的N个传感器数据即可以作为一组训练数据，该组训练数据的最后一个传感器数据作为标注数据；当然，也可以将N-1个传感器数据作为一组训练数据，第N个传感器数据作为标注数据。对此，仅是说法不同，但具体数据相同。本申请中，通过随机选取的方式，从而可以提高训练模型后的鲁棒性。本申请中，通过将每组的最后一个传感器数据作为标注数据，从而无需进行人工标注，节省了标注所占用的资源。S202，将多组训练数据输入第一支路的多个第一Transformer Block模块，得到第一编码数据；本申请中，将多组训练数据输入预设的模块，在将每组训练数据输入时，仅输入用于训练的训练数据，不输入标注数据。S203，将多组训练数据输入第二支路的多个第一Transformer Block模块，得到第二编码数据；本申请中，第一支路和第二支路的架构相同，从而通过相同的架构对训练数据进行处理，提高第一支路和第二支路的输出的同源性。本申请中，第一支路和第二支路的架构相同，是指其均包含相同数量的第一Transformer Block模块，且多个第一Transformer Block模块的处理过程相同；但第一支路和第二支路的处理参数不同。S204，将所述第一编码数据和第二编码数据相加后输入多个第二TransformerBlock模块，得到预测传感器数据；本申请中，所述第一编码数据和第二编码数据相加为按元素相加，且相加后维度不变。本申请中，通过相加计算可以维持梯度的大小，可以提高网络的深度。结合图4所示，其为位置预测模型的原理图，可以看出，第一支路、第二支路为编码支路，相加后输入解码单元进行解码，得到预测传感器数据。需要说明的是，图4中的第一支路、第二支路的Transformer Block模块与后续的解码单元的Transformer Block模块的结构不同；但第一支路、第二支路的TransformerBlock模块结构相同。结合图5所示，其为位置预测模型的架构示意图，本申请中所述的第一支路、第二支路的Transformer Block模块、解码单元的Transformer Block模块均为常规的Transformer Block模型，不同之处在于，本申请中设置了两个支路，并将两个支路的输出相加后输入后续的Transformer Block模块。对于图5中的位置预测模型架构的细节内容，可以参照现有Transformer Block模型，本申请中不再赘述。S205，基于所述标注数据和所述预测传感器数据，计算每组训练数据的预测损失，并筛除预测损失大于预设阈值的组；本申请中，所述传感器数据实质上为人体运动路线数据以及植入的股骨柄相对于人体重心的运动数据复合得到的；在人体进行运动时，股骨柄相对于人体重心的运动数据可以进行相应预测，但人体运动路线数据受到人体本身的思维控制，基本无法预测。本申请中，所述位置预测模型并非用于所有传感器数据的预测，而是用于对人体规律运动情况下的传感器数据；因此需要再进行损失函数计算时通过预设阈值排除明显不属于可预测部分的训练数据。本申请中，通过设置预设阈值，从而可以在训练过程中直接排除不可预测的训练数据，从而避免不可预测数据对模型训练的干扰，保证模型训练的收敛。S206，基于保留的训练数据计算整体预测损失，基于所述第一编码数据和第二编码数据，计算整体相似损失，并通过所述整体相似损失和所述整体预测损失，计算所述位置预测模型的整体损失；本申请中，通过第一支路的输出和第二支路的输出计算相似损失，从而降低提取的编码数据与位置、空间等的关联性，提高提取特征的鲁棒性。本申请中，第一支路和第二支路的架构相同，仅参数不同；这样通过第一支路和第二支路提取的特征如果相似度高，表明提取的特征为训练数据的最佳特征；如果相似度低，则表明提取的特征中包含的用于表述位置等的特征较多。S207，基于所述整体损失迭代所述位置预测模型，直至损失收敛为止。本申请中，通过设置第一支路和第二支路，从而对第一支路和第二支路提取的特征进行限定，降低了特征提取过程中的位置和空间干扰。本申请中，通过对预测损失的筛选，避免不可预测部分的训练数据对训练的干扰，载保证模型训练的收敛的前提下，大大提高训练速度。在一种实施方式中，所述整体相似损失的计算公式为：其中，LossC为整体相似损失，m为第一编码数据的数量，A为第一编码数据，B为第二编码数据，||为求模运算，·为求内积运算。式中，|A|为向量A的模/范数，|B|为向量B的模/范数，A·B为向量A与向量B的内积/点积。在一种实施方式中，所述整体预测损失的计算公式为：其中，n为筛选后的训练数据的组数，i为组序号，为第i组训练数据的预测传感器数据，为第i组训练数据的标注数据，α、β为权重系数。本申请中，已知训练数据的预测损失的情况下，直接统计计算整体预测损失即可。需要说明的是，本申请中需要计算每组训练数据的预测损失，其具体计算公式为：其中，i为组序号，LossPi为第i组训练数据的预测损失，为第i组训练数据的预测传感器数据，为第i组训练数据的标注数据，α、β为权重系数。在得到每组训练数据的预测损失后，通过预设阈值进行判断，在预测损失大于所述预设阈值的情况下，删除该组数据的预测损失；在预测损失小于或等于所述预设阈值的情况下，保留该组训练数据的预测损失；最后，根据保留的预测损失计算整体预测损失，其具体计算公式为：其中，LossP为整体预测损失，i为组序号；LossPi为第i组训练数据的预测损失；n为筛选后的训练数据的组数。本申请中，通过先计算每组训练数据的预测损失的方式，筛除不规则的训练数据，从而通过自适应的方式排除不规则训练数据，得到规则的训练数据的整体预测损失。在一种实施方式中，所述整体损失的计算公式为：Loss＝γLossP+LossC其中，Loss为整体损失，LossC为整体相似损失，LossP为整体预测损失，γ为整体预测损失的权重系数。在一种实施方式中，筛选出多组规律数据后，对规律数据进行拆分，得到拆分后的规律数据。在此之后，确定筛选后的每组规律数据对应的髋臼杯轴线。本申请中，所述传感器数据实质上为人体运动路线数据以及植入的股骨柄相对于人体重心的运动数据复合得到的；在人体进行运动时，股骨柄相对于人体重心的运动数据可以进行相应预测，但人体运动路线数据受到人体本身的思维控制，基本无法预测。本申请中，所述对规律数据进行拆分，即是将规律数据中植入的股骨柄相对于人体重心的运动数据拆分出来。其中，对于传感器数据中的定位数据与轴向数据，所述轴向数据均为股骨柄相对于人体重心的运动数据，所述定位数据中包含人体运动路线数据，拆分时直接从所述定位数据中拆分出股骨柄相对于人体重心的定位数据即可。本申请中，通过规律数据中的人体运动路线数据的规律，对规律数据进行拆分。需要说明的是，规律数据中的规律可能包含多种规律，例如人体匀速直线运动时的数据为规律数据；人体静坐时的运动数据也为规律数据等。本申请中，可以通过深度学习的方式将规律数据进行拆分，得到拆分后的规律数据；或者通过人为总结规律的方式进行拆分；或者其他方式进行拆分。在此需要说明的是，本申请中，优选采用计算公式的方式对匀速直线规律进行拆分，从而可以直接由计算机进行拆分；且与后续二次筛选相互结合，可以筛除非匀速直线规律的其他组规律数据，从而在整个髋臼杯角度自适应确定过程中，无需人为参与，直接由计算机完成。本申请中，所述对匀速直线规律进行拆分，在规律数据较为密集的情况下，可以是当前的定位数据直接减去前一定位数据与后一定位数据的平均值的方式进行拆分。也可以为其他计算公式。具体拆分过程，本申请中不再赘述。本申请中，在无额外限定的情况下，下述所述的规律数据，即为拆分后的规律数据。在一种实施方式中，结合图6所示，所述S400，确定筛选后的每组规律数据对应的髋臼杯轴线，包括：S401，构建传感器数据与股骨头运动参数的映射关系，所述股骨头运动参数包括定位参数和方向参数；本申请中，传感器固定设置在股骨假体内，则传感器数据与股骨/股骨头运动参数具有固定的映射关系；具体映射关系可以通过多次试验或空间位置转换进行确定，对于映射关系的具体确定方式，本申请中不作限制。所述传感器数据包括轴向数据和定位数据，所述股骨头运动参数包括定位参数和方向参数；具体映射时，所述轴向数据与所述方向参数具有映射关系，所述定位数据与所述定位参数具有映射关系。S402，基于所述映射关系将所述规律数据映射为所述股骨头运动参数；所述规律数据为传感器数据，基于对应的映射关系，可以将规律数据一一映射为股骨头运动参数。S403，基于所述股骨头运动参数计算所述股骨头运动参数对应的直线两两之间的交点；所述股骨头运动参数包含定位参数和方向参数，基于定位参数可以确定空间中的一个具体点，基于方向参数可以确定空间中的一个具体方向，穿过该具体点并沿着该具体方向可以确定一条直线，该直线即为与股骨头运动参数对应的直线。本申请中，计算所述股骨头运动参数对应的直线两两之间的交点，也即是将股骨头运动参数进行任意两两配对，计算配对的直线之间的交点。需要说明的是，对所有的股骨头运动参数进行任意两两配对，对于多个股骨头运动参数而言，会产生极大量的交点及对应的计算量。在一种实施方式中，设置每个股骨头运动参数用于配对的次数为预设次数。通过限制股骨头运动参数的配对次数，从而大幅度降低最终的配对数量，大幅度降低计算量。具体地，以设置预设次数为3次为例，对股骨头运动参数进行两两配对时，若参与配对某个股骨头运动参数已配对3次，则删除该股骨头运动参数；若参与配对的某个股骨头运动参数小于3次，则进行配对并将股骨头运动参数的配对次数+1。在一种实施方式中，将预设数量的股骨头运动参数划分为一组，对每组的股骨头运动参数进行两两配对，从而大幅度降低最终的配对数量，大幅度降低计算量。若某组的两两配对之间存在不具有交点的情况，则删除该组对应的股骨头运动参数，从而通过交点情况排除误差较大的数据。在一种实施方式中，若两两配对的直线之间不具有交点，则删除该交点及该配对。S404，基于所述股骨头运动参数对应的多个交点确定每组股骨头运动参数对应的髋臼旋转中心；本步骤中，所述股骨头运动参数对应的多个交点即为所述股骨头运动参数对应的直线两两之间的交点。本申请中，理想情况下，任意两个股骨头运动参数对应的直线之间的交点，均是髋臼旋转中心，也即是所有的股骨头运动参数对应的直线均会穿过髋臼旋转中心。但由于误差的存在，上述步骤会获取多个交点。本申请中，通过多个交点确定髋臼旋转中心，可以通过聚类的方法对多个交点进行聚类，聚类后的聚类中心即为所述髋臼旋转中心。S405，基于所述方向参数确定每组股骨头运动参数对应的轴线方向；本申请中，可以通过聚类算法对所述方向参数进行聚类，聚类后的聚类中心为所述轴线方向。S406，根据所述髋臼旋转中心和所述轴线方向，确定每组股骨头运动参数对应的髋臼杯轴线。本申请中，沿所述轴向方向且经过所述髋臼旋转中心的直线为所述髋臼杯轴线。基于此，已知所述髋臼旋转中心和所述轴线方向的情况下，可以确定对应的髋臼杯轴线。在一种实施方式中，所述S400，确定筛选后的每组规律数据对应的髋臼杯轴线，包括：构建传感器数据与股骨头运动参数的映射关系，所述股骨头运动参数包括定位参数和方向参数；基于每组规律数据计算所述规律数据对应的直线两两之间的交点；基于所述规律数据对应的多个交点确定每组规律数据对应的第一中心；基于所述轴向数据确定每组规律数据对应的轴线方向；根据所第一中心和所述轴线方向，确定每组规律数据对应的中心轴线；基于传感器数据与股骨头运动参数的映射关系将所述中心轴线映射为髋臼杯轴线。本申请中，上述流程与前述步骤S401-S406类似，不同之处在于直接对规律数据进行中心轴线计算，并将计算结果映射为髋臼杯轴线。通过直接计算后映射的方式，避免了将规律数据映射为股骨头运动参数的大量映射计算，从而大大降低了计算量，提高了计算速度。在一种实施方式中，所述基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度之前，还包括：对确定后的多个所述髋臼杯轴线进行二次筛选，得到筛选后的所述髋臼杯轴线。本申请中，通过二次筛选，筛除与实际运动情况不符的髋臼杯轴线，从而进一步提高确定的最佳髋臼杯角度的准确性。本申请中，通过二次筛选，还可以筛选出不符合设定运动规律的髋臼杯轴线，规律数据不符合对应的设定运动规律，则拆分后的规律数据无法聚集，从而得到的髋臼杯轴线不准确，无法通过二次筛选。本申请中，通过二次筛选进行不规律数据的筛选，从而降低前述规律数据拆分的复杂度，使得前述仅需要进行简单拆分即可。在一种实施方式中，结合图7所示，所述对确定后的多个所述髋臼杯轴线进行二次筛选，得到筛选后的所述髋臼杯轴线，包括：S601，获取髋臼杯的允许偏折角；本申请中，所述髋臼杯的允许偏折角，即是髋臼杯假体与适配的股骨头假体在正确安装的情况下，可以允许的股骨头假体的中心轴线与髋臼杯假体的髋臼杯轴线的最大角度。该允许偏折角反映了股骨头可以运动的最大极限。由于髋臼杯假体与股骨头假体适配，因此髋臼杯假体的髋臼杯轴线与股骨头假体的中心轴线相交，基于髋臼杯假体的预设尺寸，可以计算出对应的允许偏折角。本申请中，不同尺寸的髋臼杯假体和股骨头假体对应不同的允许偏折角，在髋臼杯假体和股骨头假体已确定的情况下，其对应的允许偏折角也确定。本申请中，所述允许偏折角可以通过标注的方式获取，也可以通过已安装的假体尺寸进行计算得到，具体获取方式本申请中不再赘述。S602，将所述对象的每组规律数据映射为股骨头运动参数；本申请中，规律数据/传感器数据与股骨头运动参数具有映射关系，基于该映射关系，可以将规律数据一一映射为股骨头运动参数。需要说明的是，所述规律数据为拆分后的规律数据；传感器数据拆分后，其与股骨头运动参数的映射关系依然保持不变，不同之处在于，传感器数据映射的股骨头运动参数包含人体重心的移动数据，拆分后的规律数据映射的股骨头运动参数不包含人体重心的移动数据。S603，基于所述允许偏折角和多个所述髋臼杯轴线，判断对应组所述股骨头运动参数是否均处于该组所述髋臼杯的允许偏折角内；本步骤中，对于每组而言，髋臼杯轴线与允许偏折角构成圆锥体，若该组的股骨头运动参数落入该圆锥体外侧，则该股骨头运动参数不处于所述髋臼杯的允许偏折角内；若该组的股骨头运动参数落入该圆锥体内侧，则该股骨头运动参数处于所述髋臼杯的允许偏折角内。本申请中，可以通过股骨头运动参数中的定位参数直接判断与圆锥体的关系，无需使用方向参数，从而节省计算数据量。本申请中，通过圆锥体化髋臼杯轴线，从而可以大幅度提高股骨头运动参数判断的速度和直观性。S604，在所述股骨头运动参数均处于所述髋臼杯的允许偏折角内的情况下，保留该髋臼杯对应的髋臼杯轴线。本申请中，髋臼杯轴线与允许偏折角构成圆锥体，若该组所有股骨头运动参数均落入该圆锥体内，则该组的髋臼杯轴线可保留。本申请中，所述股骨头运动参数均处于所述髋臼杯的允许偏折角内，是指单一对象的传感器采集的一组规律数据映射的参数均处于该组的所述偏折角内。本申请中，通过髋臼杯的允许偏折角对髋臼杯轴线进行筛选，从而筛除误差较大的髋臼杯轴线，进一步提高最佳髋臼角度的准确性。在一种实施方式中，所述对确定后的多个所述髋臼杯轴线进行二次筛选，得到筛选后的所述髋臼杯轴线，包括：获取髋臼杯的允许偏折角；基于规律数据与股骨头运动参数的映射关系，将所述髋臼杯轴线映射为对应的中心轴线；基于所述允许偏折角和多个所述中心轴线，判断所述规律数据是否均处于所述中心轴线的允许偏折角内；在所述规律数据均处于所述中心轴线的允许偏折角内的情况下，保留该中心轴线对应的髋臼杯轴线。需要说明的是，若已知所述中心轴线映射为髋臼杯轴线的情况下，可以直接获取髋臼杯轴线对应的中心轴线，无需反向映射的计算。本申请中，上述流程与前述步骤S601-S604类似，不同之处在于直接将髋臼杯轴线映射为中心轴线进行筛选。通过直接计算后筛选的方式，避免了将规律数据映射为股骨头运动参数的大量映射计算，从而大大降低了计算量，提高了计算速度。本申请实施例提供了一种基于深度学习的髋臼杯角度自适应确定装置，用于执行本申请上述内容所述的基于深度学习的髋臼杯角度自适应确定方法，以下对所述基于深度学习的髋臼杯角度自适应确定装置进行详细描述。如图8所示，所述基于深度学习的髋臼杯角度自适应确定装置，包括：数据获取模块101，其用于基于股骨柄内植入的传感器，获取单个对象的规律数据，所述规律数据包括轴向数据和定位数据；模型训练模块102，其用于基于所述单个对象的规律数据对位置预测模型进行训练，得到训练完成的位置预测模型；数据筛选模块103，其用于基于训练完成的位置预测模型，从所述单个对象的规律数据中筛选出多组规律数据；轴线确定模块104，其用于确定筛选后的每组规律数据对应的髋臼杯轴线；角度确定模块105，其用于基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。在一种实施方式中，模型训练模块102还用于：从所述单个对象的规律数据中随机选取多组训练数据，所述训练数据包括预设数量的规律数据，且最后一个所述规律数据为标注数据；将多组训练数据输入第一支路的多个第一Transformer Block模块，得到第一编码数据；将多组训练数据输入第二支路的多个第一Transformer Block模块，得到第二编码数据；将所述第一编码数据和第二编码数据相加后输入多个第二Transformer Block模块，得到预测规律数据；基于所述标注数据和所述预测规律数据，计算每组训练数据的预测损失，并筛除预测损失大于预设阈值的组；基于保留的训练数据计算整体预测损失，基于所述第一编码数据和第二编码数据，计算整体相似损失，并通过所述整体相似损失和所述整体预测损失，计算所述位置预测模型的整体损失；基于所述整体损失迭代所述位置预测模型，直至损失收敛为止。在一种实施方式中，所述整体预测损失的计算公式为：其中，n为筛选后的训练数据的组数，i为组序号，为第i组训练数据的预测规律数据，为第i组训练数据的标注数据，α、β为权重系数。在一种实施方式中，所述装置还包括二次筛选模块，其用于对确定后的多个所述髋臼杯轴线进行二次筛选，得到筛选后的所述髋臼杯轴线。在一种实施方式中，所述二次筛选模块还用于：获取髋臼杯的允许偏折角；将所述对象的每组规律数据映射为股骨头运动参数；基于所述允许偏折角和多个所述髋臼杯轴线，判断对应组所述股骨头运动参数是否均处于该组所述髋臼杯的允许偏折角内；在所述股骨头运动参数均处于所述髋臼杯的允许偏折角内的情况下，保留该髋臼杯对应的髋臼杯轴线。在一种实施方式中，所述数据筛选模块还用于：构建规律数据与股骨头运动参数的映射关系，所述股骨头运动参数包括定位参数和方向参数；基于所述映射关系将所述规律数据映射为所述股骨头运动参数；基于所述股骨头运动参数计算所述股骨头运动参数对应的直线两两之间的交点；基于所述股骨头运动参数对应的多个交点确定每组股骨头运动参数对应的髋臼旋转中心；基于所述方向参数确定每组股骨头运动参数对应的轴线方向；根据所述髋臼旋转中心和所述轴线方向，确定每组股骨头运动参数对应的髋臼杯轴线。在一种实施方式中，所述传感器通过体外无线充电方式进行供电。本申请的上述实施例提供的基于深度学习的髋臼杯角度自适应确定装置与本申请实施例提供的基于深度学习的髋臼杯角度自适应确定方法具有对应关系，因此该装置中的具体内容与髋臼杯角度自适应确定方法具有对应关系，具体内容可以参照髋臼杯角度自适应确定方法中的记录，本申请中对此不再赘述。本申请的上述实施例提供的基于深度学习的髋臼杯角度自适应确定装置与本申请实施例提供的基于深度学习的髋臼杯角度自适应确定方法出于相同的发明构思，具有与其存储的应用程序所采用、运行或实现的方法相同的有益效果。以上描述了基于深度学习的髋臼杯角度自适应确定装置的内部功能和结构，如图9所示，实际中，该基于深度学习的髋臼杯角度自适应确定装置可实现为电子设备，包括：存储器301及处理器303。存储器301，可被配置为存储程序。另外，存储器301，还可被配置为存储其它各种数据以支持在电子设备上的操作。这些数据的示例包括用于在电子设备上操作的任何应用程序或方法的指令，联系人数据，电话簿数据，消息，图片，视频等。存储器301可以由任何类型的易失性或非易失性存储设备或者它们的组合实现，如静态随机存取存储器，电可擦除可编程只读存储器，可擦除可编程只读存储器，可编程只读存储器，只读存储器，磁存储器，快闪存储器，磁盘或光盘。处理器303，耦合至存储器301，用于执行存储器301中的程序，以用于：基于股骨柄内植入的传感器，获取单个对象的规律数据，所述规律数据包括轴向数据和定位数据；基于所述单个对象的规律数据对位置预测模型进行训练，得到训练完成的位置预测模型；基于训练完成的位置预测模型，从所述单个对象的规律数据中筛选出多组规律数据；确定筛选后的每组规律数据对应的髋臼杯轴线；基于筛选后的所述髋臼杯轴线，确定最佳髋臼杯轴线及对应的最佳髋臼杯角度。在一种实施方式中，处理器303还用于：从所述单个对象的规律数据中随机选取多组训练数据，所述训练数据包括预设数量的规律数据，且最后一个所述规律数据为标注数据；将多组训练数据输入第一支路的多个第一Transformer Block模块，得到第一编码数据；将多组训练数据输入第二支路的多个第一Transformer Block模块，得到第二编码数据；将所述第一编码数据和第二编码数据相加后输入多个第二Transformer Block模块，得到预测规律数据；基于所述标注数据和所述预测规律数据，计算每组训练数据的预测损失，并筛除预测损失大于预设阈值的组；基于保留的训练数据计算整体预测损失，基于所述第一编码数据和第二编码数据，计算整体相似损失，并通过所述整体相似损失和所述整体预测损失，计算所述位置预测模型的整体损失；基于所述整体损失迭代所述位置预测模型，直至损失收敛为止。在一种实施方式中，所述整体预测损失的计算公式为：其中，n为筛选后的训练数据的组数，i为组序号，为第i组训练数据的预测规律数据，为第i组训练数据的标注数据，α、β为权重系数。在一种实施方式中，所述装置还包括二次筛选模块，其用于对确定后的多个所述髋臼杯轴线进行二次筛选，得到筛选后的所述髋臼杯轴线。在一种实施方式中，处理器303还用于：获取髋臼杯的允许偏折角；将所述对象的每组规律数据映射为股骨头运动参数；基于所述允许偏折角和多个所述髋臼杯轴线，判断对应组所述股骨头运动参数是否均处于该组所述髋臼杯的允许偏折角内；在所述股骨头运动参数均处于所述髋臼杯的允许偏折角内的情况下，保留该髋臼杯对应的髋臼杯轴线。在一种实施方式中，处理器303还用于：构建规律数据与股骨头运动参数的映射关系，所述股骨头运动参数包括定位参数和方向参数；基于所述映射关系将所述规律数据映射为所述股骨头运动参数；基于所述股骨头运动参数计算所述股骨头运动参数对应的直线两两之间的交点；基于所述股骨头运动参数对应的多个交点确定每组股骨头运动参数对应的髋臼旋转中心；基于所述方向参数确定每组股骨头运动参数对应的轴线方向；根据所述髋臼旋转中心和所述轴线方向，确定每组股骨头运动参数对应的髋臼杯轴线。在一种实施方式中，所述传感器通过体外无线充电方式进行供电。本申请中，处理器还具体用于执行上述基于深度学习的髋臼杯角度自适应确定方法的所有流程及步骤，具体内容可参照髋臼杯角度自适应确定方法中的记录，本申请中对此不再赘述。本申请中，图9中仅示意性给出部分组件，并不意味着电子设备只包括图9所示组件。本实施例提供的电子设备，与本申请实施例提供的基于深度学习的髋臼杯角度自适应确定方法出于相同的发明构思，具有与其存储的应用程序所采用、运行或实现的方法相同的有益效果。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可读存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。在一个典型的配置中，计算设备包括一个或多个处理器、输入/输出接口、网络接口和内存。内存可能包括计算机可读介质中的非永久性存储器，随机存取存储器和/或非易失性内存等形式，如只读存储器或闪存。内存是计算机可读介质的示例。本申请还提供一种与前述实施方式所提供的基于深度学习的髋臼杯角度自适应确定方法对应的计算机可读存储介质，其上存储有计算机程序，所述计算机程序在被处理器运行时，会执行前述任意实施方式所提供的基于深度学习的髋臼杯角度自适应确定方法。计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存、静态随机存取存储器、动态随机存取存储器、其他类型的随机存取存储器、只读存储器、电可擦除可编程只读存储器、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体，如调制的数据信号和载波。本申请的上述实施例提供的计算机可读存储介质与本申请实施例提供的基于深度学习的髋臼杯角度自适应确定方法出于相同的发明构思，具有与其存储的应用程序所采用、运行或实现的方法相同的有益效果。需要说明的是，在此处所提供的说明书中，说明了大量具体细节。然而，能够理解，本申请的实施例可以在没有这些具体细节的情况下实践。在一些实例中，并未详细示出公知的结构和技术，以便不模糊对本说明书的理解。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。以上所述仅为本申请的实施例而已，并不用于限制本申请。对于本领域技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本申请的权利要求范围之内。
