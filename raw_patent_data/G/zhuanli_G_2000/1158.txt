标题title
一种基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法
摘要abst
本发明公开了一种基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法，将群体高深度测序数据挂载到线性泛基因组上；根据群体中每个样品的二代测序序列覆盖情况，检测每个窗口被测序序列完全覆盖的情况，记录窗口位置信息和完全覆盖该窗口的reads数量；构建人工智能模型，通过模拟数据训练模型使其能判定连续窗口覆盖区域是否包含倒位或转座子端点；利用模型扫描一条染色体上的所有区域，得到其上的所有倒位或转座子端点信息，依次扫描多条染色体，汇总成一个样品所有染色体上的倒位或转座子端点信息；基于不同样品，整理并筛选群体水平的倒位或转座子端点基因型矩阵。本发明实现了利用二代测序数据检测转座子和倒位端点基因型。
权利要求书clms
1.一种基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法，其特征在于，包括以下步骤：步骤一：使用比对软件将群体高深度测序数据挂载到线性泛基因组上；步骤二：根据群体中每个样品的二代测序序列覆盖情况，利用划窗口的方式检测每个窗口被测序序列完全覆盖的情况，记录窗口位置信息和完全覆盖该窗口的reads数量，生成数据框文件；步骤三：构建出一个人工智能模型，通过模拟数据训练该模型使其能根据步骤二得到的固定数量、连续的窗口位置和序列数量信息判定连续窗口覆盖区域是否包含倒位或转座子端点；步骤四：利用步骤三的模型扫描一条染色体上的所有区域，得到该染色体上的所有倒位或转座子端点位置信息，依次扫描多条染色体，汇总成一个样品所有染色体上的倒位或转座子端点信息；步骤五：基于不同样品的倒位或转座子端点信息，整理并筛选群体水平的倒位或转座子端点基因型矩阵。2.根据权利要求1所述的方法，其特征在于：所述步骤一中，群体高深度测序数据的测序深度大于20×。3.根据权利要求1所述的方法，其特征在于：所述步骤二中的所述窗口指基因组上的一段39bp的区域，该窗口的位置命名以所在染色体和窗口中间位置组合命名；划窗口的步长为20bp。4.根据权利要求3所述的方法，其特征在于：所述步骤二中的所述完全覆盖是指测序序列的最左边在窗口的左边，并且测序序列左边位置加上序列匹配到泛基因组上的碱基数与检测到的缺失碱基数之和大于窗口的右边位置。5.根据权利要求4所述的方法，其特征在于：所述步骤二中记录窗口位置信息和完全覆盖该窗口的reads数量，用于得到一个包含两列数据的数据框，该数据框第一列为窗口位置，第二列为完全覆盖该窗口的序列数量，以csv文件保存。6.根据权利要求5所述的方法，其特征在于：所述步骤三中的所述人工智能模型为人工神经网络模型，是一个包含4层全连接层网络，最后一层激活函数为sigmoid函数，其它激活函数为ReLU函数；模型的输入为一列长度为25的数组，来源于步骤二的数据框csv文件；对csv文件内的第二列数进行划窗口操作，窗口大小为25，步长为22，每个窗口对应基因组序列长度为39bp+*20＝519bp；模型的输出为一个值，用于判定该519bp区域是否包含倒位或转座子端点。7.根据权利要求6所述的方法，其特征在于：步骤二的数据框csv文件在输入到模型之前要进行预处理，将csv文件中第二列小于或等于3的数定义为0，表示无序列完全覆盖；大于3的数定义为1，表示有序列完全覆盖。8.根据权利要求6所述的方法，其特征在于：所述步骤三中的通过模拟数据训练模型：其中，所述模拟数据由人为模拟生成，包含明显存在倒位或转座子端点的情况和明显不存在倒位或转座子端点的情况，制作成特征值与标签对应的数据集用于模型训练。9.根据权利要求1所述的方法，其特征在于：所述步骤四中，对染色体分别处理和对样品分别处理，采用相互独立并行运算的方式。
说明书desc
技术领域本发明涉及自然群体基因型检测技术领域，更具体地说是涉及一种基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法。背景技术在群体遗传研究领域，群体基因型的获取是群体研究的基石。传统的群体基因型分析包括单核苷酸多态性分析和插入缺失分析，有研究表明，大部分表型变异是由于结构变异引起的，近年来结构变异分析也取得了一定进展。结构变异包括倒位、易位、重复、大片段插入或缺失。目前三代测序价格仍然较高，这极大的限制了结构变异的挖掘。二代测序价格不断降低，但是二代测序的读长较短，给结构变异的分析带来很大困难，尤其是倒位和转座子跳跃引起的易位及重复。当基因型某段序列发生倒位后，基因组内仍然包含该段序列，因此使用二代测序技术，将短序列挂载到参考基因组的方法较难检测出倒位的存在。目前构建倒位图谱主要使用多个已经组装好的高质量基因组进行基因组之间的比对，从而找出倒位位置，但获得高质量基因组需要巨大成本，因此检测出的倒位图谱也局限于某些热门研究物种和有限个体。转座子能在基因组内活跃跳动，可能包含多处重复，因此转座子内的二代测序短序列可能被同时挂载到多处，但某样品中可能只包含一个重复。目前许多物种已经有海量的公开测序数据，但是受限于二代测序读长短的缺点，群体转座子和倒位的研究进展较缓。因此，如何提供一种检测群体转座子和倒位的方法，进而分析出基因型用于后续研究，是本领域技术人员亟需解决的问题。发明内容有鉴于此，本发明提供了一种基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法，以解决上述背景技术中的问题，实现了利用二代测序数据检测转座子和倒位端点基因型。为了实现上述目的，本发明采用如下技术方案：本发明提供一种基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法，包括下述步骤：步骤一：使用比对软件将群体高深度测序数据挂载到线性泛基因组上；步骤二：根据群体中每个样品的二代测序序列覆盖情况，利用划窗口的方式检测每个窗口被测序序列完全覆盖的情况，记录窗口位置信息和完全覆盖该窗口的reads数量，生成数据框文件；步骤三：构建出一个人工智能模型，通过模拟数据训练该模型使其能根据步骤二得到的固定数量、连续的窗口位置和序列数量信息判定该区域是否包含倒位或转座子端点；步骤四：利用步骤三的模型扫描一条染色体上的所有区域，得到该染色体上的所有倒位或转座子端点位置信息，依次扫描多条染色体，汇总成一个样品所有染色体上的倒位或转座子端点信息；步骤五：基于不同样品的倒位或转座子端点信息，整合出群体水平的倒位或转座子端点基因型矩阵。作为上述技术方案优选的技术方案，步骤一中，群体高深度测序数据的测序深度应大于20×。作为上述技术方案优选的技术方案，步骤二中，利用划窗口的方式检测每个窗口被测序序列完全覆盖的情况，窗口指基因组上的一段39bp的区域，该窗口的位置命名以所在染色体和窗口中间位置组合命名，划窗口的步长为20bp。作为上述技术方案优选的技术方案，步骤二中，被完全覆盖是指测序序列的最左边应在窗口的左边，并且测序序列左边位置加上序列匹配到泛基因组上的碱基数与检测到的缺失碱基数之和应大于窗口的右边位置。作为上述技术方案优选的技术方案，步骤二中，记录窗口位置信息和完全覆盖该窗口的测序序列数量，可以得到一个包含两列数据的数据框，该数据框第一列为窗口位置，第二列为完全覆盖该窗口的序列数量，以csv文件保存；由于所有样品比对到同一个线性泛基因组，划窗口基于线性泛基因组，划窗口的大小和步长一致，因此所有样品的数据框csv文件行数一致，且第一列信息完全一样，第二列序列数量信息不同。作为上述技术方案优选的技术方案，步骤三中的人工神经网络模型为4层全连接层网络，最后一层激活函数为sigmoid函数，其它激活函数为ReLU函数；模型的输入为一列长度为25的数组，来源于步骤二的数据框csv文件，对csv文件内的第二列数进行划窗口操作，窗口大小为25，步长为22，每个窗口对应基因组序列长度为39bp+*20＝519bp；模型的输出为一个值，用于判定该519bp区域是否包含倒位或转座子端点。作为上述技术方案优选的技术方案，步骤二中的数据框csv文件在输入到模型之前要进行预处理，将csv文件中第二列小于或等于3的数定义为0，表示无序列完全覆盖，大于3的数定义为1，表示有序列完全覆盖。作为上述技术方案优选的技术方案，步骤三中的通过模拟数据训练模型，模拟数据由人为模拟生成，包含明显存在倒位或转座子端点的情况和明显不存在倒位或转座子端点的情况，制作成特征值与标签对应的数据集用于模型训练。作为上述技术方案优选的技术方案，步骤四中，对染色体分别处理和对样品分别处理，因数据的计算相互独立可以并行运算；经由上述的技术方案可知，与现有技术相比，达到的技术效果是：1)本发明创新性地提出了使用完全覆盖某段区域的测序序列数量鉴定度盖度，以往鉴定一段区域的覆盖度，是先计算单碱基位点被reads覆盖的数量，再通过将多个单碱基覆盖reads数量求平均值。以往的方法是无法检测到倒位或转座子端点的，因为倒位或转座子端点实际是一个位点，将测序数据挂载到参考基因组后，由于比对软件的必须包含容错参数，因此挂载的序列会跨过倒位或转座子端点1-10bp，端点及附近的碱基位置都会被多条reads覆盖，对包含端点的一段区域求覆盖度平均值也是非0的，与其它连续覆盖、不包含端点区域的覆盖度平均值结果相似，因此以往的方法无法检测出端点。本发明提出完全覆盖39bp的reads数，利用步长为20进行划窗口，剔除了挂载序列错误匹配的因素，若存在端点，能检测到包含端点的39bp区域完全覆盖reads数量为0。2)本发明创新性地从群体水平研究倒位或转座子，利用二代测序数据结合线性泛基因组寻找倒位或转座子端点，能获得更丰富的端点位置信息，以往是通过三代测序组装基因组，用高质量基因组之间比较，获得倒位或转座子位置，成本巨大，因高质量基因组数量有限，获得的倒位或转座子数量有限。本发明可利用已公开的海量二代测序数据，具有明显优势。3)本发明创新性地应用了人工智能模型鉴定倒位或转座子端点，人工智能模型能提取抽象特征，处理复杂情况，准确识别端点。将包含端点的材料测序数据挂载到线性泛基因组上，比对结果具有明显特点：端点不被reads完全覆盖，端点左右两边均能被多条reads完全覆盖。传统的方法较容易对某个位点或某个区域进行判断，端点的判定需要结合多个数值，且数值排列顺序对判定结果有影响，传统方法较难处理。人工智能模型擅长处理此类非线性、特征提取的问题。4)本发明的窗口内的计算彼此独立，可以使用多线程并行加速运算，减少程序运行时间。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图获得其他的附图。图1为本发明的基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法的流程示意图；图2为本发明的reads完全覆盖某段区域示意图；图3为本发明的划窗口方法检测基因组水平覆盖度示意图；图4为本发明的训练数据集生成和人工智能模型结构图；图5为本发明的划窗口方法转换数据结构用于人工智能模型的示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例1请参阅图1-4，本实施例提供了一种基于线性泛基因组和人工智能模型检测群体倒位或转座子端点基因型的方法，包括：A.二代测序数据在基因组水平覆盖情况统计A1.提取群体样品的DNA。A2.将DNA利用超声波随机打断后建库，然后利用第二代DNA测序技术进行高深度测序。目前二代测序数据的读长为150bp。A3.使用比对软件将所有样品的高深度测序分别比对到线性泛基因组上。该对比软件可为BWA或Samtools为软件，均无中文名称，在行业内直接用英文表达，用于提取目标序列。A4.以39bp为一个窗口，统计该窗口被完全覆盖的reads数。其中，reads指二代测序过程中产生的测序序列，是一段150bp的碱基序列，在行业内可直接用英文表达。如图2展示，如果一条read的最左端在窗口的左边，read最右端在窗口右边，表明该read完全覆盖该窗口，该窗口被完全覆盖的reads数+1。在实际的操作过程中，read最右端应为最左端加上匹配到线性泛基因组上的碱基数量，再加上检测到的缺失碱基数之和。A5.利用划窗口的方法在线性泛基因组上进行划窗操作，窗口大小为39bp，步长为20bp，分析每一个窗口39bp是否被reads完全覆盖。将窗口的位置信息和完全覆盖reads数合并成2列对应的数据框。为降低后续的运算成本，将完全覆盖reads数与一个阈值做比较，如果大于3，用1表示该39bp窗口被reads完全覆盖；如果小于等于3，用0表示该窗口没有被完全覆盖。将窗口位置信息和表示覆盖情况的0、1数合并，形成包含两列数的数据框。B.识别倒位或转座子端点的人工智能模型训练B1.创建训练集。倒位或转座子端点处的测序reads覆盖情况具有明显特征：断点前面区域有大量reads完全覆盖，断点后面区域也有大量reads完全覆盖，然而包含断点的39bp窗口却不能被reads完全覆盖。因此A5产生的数据框中，一段区域如果出现连续多个的1后，只出现一个0，接着又是多个1，表明该段区域存在断点。通过实际基因组三代测序数据可视化发现，断点大部分是1个碱基位置，但也有可能是好几个连续碱基或一段小序列。因此连续出现多个1后，有可能出现1-10个0，接着后面全是1，也说明该区域包含断点。使用划窗口的方法，中间的0可能出现在窗口的不同位置，因此情况复杂，传统的算法难以判断。创建所有包含断点的数据集：窗口数量设定为25，特征值为包含25个数的数组。模拟存在1个0的情况，0可能出现在数组的任何位置；模拟存在2个0的情况，0可能出现在数组中间的任何位置……。再创建所有不包含断点的数据集，当一个0或多个0出现在数组的最左端或最右端，说明该窗口是大片段插入缺失的边界；如果数组中0超过10个，说明该窗口包含一个插入缺失。将25个连续的0或1的数据设定为特征值，是否存在断点设定为标签值，将特征值和标签值对应起来形成数据集。B2.创建人工智能模型，构建一个包含3个隐藏层，1个输出层的人工神经网络模型，隐藏层的接点数分别为64、16、4，激活函数为ReLU，输出层使用sigmoid函数输出一个值。模型输入为包含25个特征值的数组，与训练集相匹配。B3.利用训练集对人工智能模型进行训练，将数据集输入到人工智能模型，特征值与模型参数进行运算，经过多层网络输出结果，将输出结果与真实标签值进行比较，经梯度下降算法改良模型参数，不断缩小输出结果和真实标签值之间的差距。输入多组数据，循环4000次训练从而使人工智能模型能较准确地识别断点的存在。C.利用人工智能模型识别群体倒位或转座子端点C1.对于每个样品，A5步骤后产生一个代表全基因组覆盖度的数据矩阵。利用划窗口的方法对该数据矩阵进行划窗操作，以25个值为一个窗口，以22为步长。该数据矩阵被转换成包含25个特征值的矩阵。其中，在划窗口时，先确定每25个小窗口在同一条染色体上，如果一条染色体上最后一个窗口无法满足包含25个小窗口，舍去该窗口。C2.数据矩阵的每行25个数，输入人工智能模型，输出该区域是否包含断点。C3.将人工智能输出结果进行整理，让位置信息与断点信息对应输出，将结果按照染色体整理，输出到一个文件中，每一个样品输出一个文件结果。D.断点数据的合并与筛选D1.由于所有样品以同一个线性泛基因组为参考基因组，因此A5步骤输出结果文件的第一列完全一样，包含的是窗口在染色体的位置信息。经过C1划窗口方法后，每个样品的输出结果文件依然行数一致，每行的行名一致。D2.将所有样品的断点文件进行纵向合并。D3.合并后的文件包含一个矩阵，行名为断点在染色体的位置信息，列为每个样品名。该矩阵为初步的断点基因型。对样品的每一行进行筛选，根据最小等位基因频率进行筛选，去除MAF小于0.05的行。得到筛选后的断点基因型，输出至一个文件。下面结合附图对本发明的应用原理作详细的描述：实施例2基于高深度测序获取单个样品测序reads基因组水平覆盖情况利用化学去污方法提取水稻群体材料叶片的DNA，使用IlluminaNovaSeq6000测序平台完成DNA的高深度测序，每个样本约产生20Gb的数据。水稻基因组大小为400Mb，样品深度为50X。本实例以IRRI2K_91为例，IRRI2K_91测序数据经过压缩后双端测序文件为6.8Gb和7.0Gb大小。利用BWA软件将样品双端测序数据比对到水稻线性参考基因组上，获得bam格式的比对文件，利用picard软件对bam文件进行排序、标记重复位置和建立引索操作，此时bam大小约为8.1Gb。运行自编程序a0_read_one_bam_absolute_depth1.09.py，设定完全覆盖的窗口大小参数，本实例设定为39bp，设定步长参数为20bp。该程序以bam文件为输入文件，输出一个csv文件，csv文件包含两列数据，以逗号隔开，第一列记录每个窗口在染色体上的位置，第二列记录第一列窗口位置对应的完全覆盖read数，输出文件IRRI2K_91absolute_depth1.09.csv大小为347M，共21,771,459行。实施例3训练人工智能模型判别倒位或转座子端点运行自编程序a1_create_training_data.py，设定窗口数量参数为25，设定断点最大包含10个连续的0，程序运行过程会产生训练集，包含多行特征值和对应标签值，以csv文件输出。自编程序会利用python调用tensorflow模块，设定人工智能模型的网络结构，包含3个隐藏层，的接点数分别为64、16、4，激活函数为ReLU，输出层使用sigmoid函数输出一个值。模型输入为包含25个特征值的数组，与程序生成的训练集相匹配。自编程序将训练集输入模型用于训练模型，设定循环次数，训练4000次后，模型对于训练集断点的预测准确性达到99.9％以上，保存训练好的模型。实施例4人工智能模型检测倒位或转座子端点利用自编程序a2_depth_shape_cast.py将IRRI2K_91absolute_depth1.09.csv文件进行处理，设定最小覆盖阈值为3，IRRI2K_91absolute_depth1.09.csv的第二列中如果小于等于3，转换成0，如果大于3转换成1。程定窗口大小参数为25，该自编程序会使用划窗口的方法，以两列数据为基础，转换成包含25个特征值的矩阵数据，输出至文件IRRI2K_91absolute_depth_shape25.csv使用自编程序a3_detecting_breakpoint.py加载训练好的模型，对IRRI2K_91absolute_depth_shape25.csv文件中的每一行进行断点的检测，位置信息和预测结果一一对应，输出至一个IRRI2K_91_breakpoint.csv文件中。对群体中多个样品依次执行相同步骤，得到多个样品的IRRI2K_**_breakpoint.csv。由于不同样品的执行不依赖其它样品，因此该步骤可以利用多进程并行运算，加速分析过程；由于多个样品都是基于同一个线性泛基因组做参考基因组，因此最后IRRI2K_**_breakpoint.csv文件内的位置信息一致。利用python中的pandas模块，读取所有IRRI2K_**_breakpoint.csv并合并成一个基因型矩阵，该矩阵行为位置信息，列为每个样品名，输出至一个文件。利用自编程序a4_filter_population_breakpoint.py对基因型矩阵进行最小等位基因频率的筛选，得到筛选后的群体倒位或转座子端点基因型。在筛选后的基因型中随机挑选检测到断点的位置30个，利用IGV可视化软件，对这30个区域进行人工观察检测，经检测，这30个位置完全符合倒位或转座子端点的特征，使用本发明能代替人工观察检测断点。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似部分互相参见即可。对于实施例公开的装置而言，由于其与实施例公开的方法相对应，所以描述的比较简单，相关之处参见方法部分说明即可。对所公开的实施例的上述说明，使本领域专业技术人员能够实现或使用本发明。对这些实施例的多种修改对本领域的专业技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所示的这些实施例，而是要符合与本文所公开的原理和新颖特点相一致的最宽的范围。
