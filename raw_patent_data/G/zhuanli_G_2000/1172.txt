标题title
一种基于机器视觉的压铸件毛刺检测系统及方法
摘要abst
本发明公开了一种基于机器视觉的压铸件毛刺检测系统及方法，属于毛刺检测技术领域。本发明系统包括数据获取模块、毛刺识别与特征提取模块、光滑指标计算模块、毛刺检测模块以及毛刺特征更新模块；所述数据获取模块用于采集压铸件的历史数据和实时数据；所述毛刺识别与特征提取模块用于将对比图像与模板图像进行比对，识别毛刺并在对比图像上进行标记，以及提取毛刺特征构成毛刺特征集合；所述光滑指标计算模块用于计算模板图像和待检测图像的光滑指标，并将模板图像的光滑指标作为阈值进行后续的毛刺检测；所述毛刺检测模块用于对待检测图像进行毛刺检测；所述毛刺特征更新模块根据新检测到的毛刺特征，更新毛刺特征集合和去毛刺解决办法。
权利要求书clms
1.一种基于机器视觉的压铸件毛刺检测方法，其特征在于：所述方法包括以下步骤：S100.获取历史数据中去毛刺后压铸件各个表面图像，获取历史数据中去毛刺前压铸件各个表面图像，将所述去毛刺前压铸件各个表面图像作为对比图像进行存储；将所述去毛刺后压铸件各个表面图像作为模板图像进行存储；S200.将对比图像与模板图像进行比对，识别毛刺并在对比图像上对毛刺进行标记，提取毛刺特征构成毛刺特征集合；毛刺特征包括毛刺的分布位置、形状以及大小,且每一个毛刺特征对应一种去毛刺的操作步骤；S300.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再进行去毛刺操作；计算模板图像的光滑指标，并将模板图像的光滑指标作为阈值，计算经过去毛刺操作的待检测图像的光滑指标；S400.经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的阈值，对经过去毛刺操作的待检测图像进行步骤S200中对比图像的操作，将发现新的毛刺对毛刺特征集合和对应去毛刺的解决办法进行更新；否则直接进行下一轮压铸件的毛刺检测。2.根据权利要求1所述的一种基于机器视觉的压铸件毛刺检测方法，其特征在于：所述步骤S100包括：获取历史数据中的压铸件图像数据并进行图像预处理，所述图像预处理包括灰度化、滤波以及边缘检测；根据去毛刺操作的前后，将历史数据中的压铸件图像数据分为对比图像和模板图像，并将相同压铸件相对应的对比图像和模板图像进行关联。3.根据权利要求2所述的一种基于机器视觉的压铸件毛刺检测方法，其特征在于：所述步骤S200包括：S201.获取模板图像的压铸件各个表面图像的表面积S,以及相对应的对比图像的压铸件各个表面图像的表面积S’；S202.若，则对对比图像进行毛刺识别，对毛刺进行标记；S203.对标记的毛刺进行特征提取构成毛刺特征集合M={m1,m2,...,mn},其中m1代表第1个毛刺特征，m2代表第2个毛刺特征，以此类推mn代表第n个毛刺特征，n为数据编号，取正整数；且一个毛刺特征包括一个毛刺的分布位置、形状以及大小，每一个毛刺特征对应一种去毛刺的操作步骤。4.根据权利要求3所述的一种基于机器视觉的压铸件毛刺检测方法，其特征在于：所述步骤S300包括：S301.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再根据对应毛刺特征的去毛刺的操作步骤进行操作；S302.将模板图像划分成若干相等面积的m个局部区域，且m≥2；对每个局部区域计算梯度，得到梯度向量为V=（gx,gy)，其中gx表示局部区域内在x方向上的梯度，gy表示局部区域内在y方向上的梯度；计算局部区域i和局部区域j之间的欧式距离dij和相似度sij,根据以下公式：；；其中i，j为局部区域编号，取正整数，gᵢx和gᵢy分别是第i个局部区域在x和y方向上的梯度值，gⱼx和gⱼy分别是第j个局部区域在x和y方向上的梯度值；通过上述计算，得到每个局部区域与其他m-1个局部区域的相似度，计算平均值得到局部区域自身的相似度，即 ，且j≠i；综合所有局部区域的相似度，得到整体的光滑度指标，根据以下公式：；其中wi是局部区域的权重；将模板图像的光滑指标作为阈值；S303.根据步骤S302中模板图像的光滑指标计算公式，计算经过去毛刺操作的待检测图像的光滑指标。5.根据权利要求4所述的一种基于机器视觉的压铸件毛刺检测方法，其特征在于：所述步骤S400包括：S401.获取经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标；将经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；S402.若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的光滑指标，则将经过去毛刺操作且光滑指标大于对应模板图像阈值的待检测图像并标记为毛刺更新图像；将毛刺更新图像进行步骤S200中对比图像的操作，对毛刺进行标记并提取毛刺特征，构成毛刺更新图像的毛刺特征集合A={a1,a2,...,at},其中a1代表毛刺更新图像的第1个毛刺特征，a2代表毛刺更新图像的第2个毛刺特征，以此类推at代表待毛刺更新图像的第t个毛刺特征，t为数据编号，取正整数；将集合A的毛刺特征反馈给操作人员，由操作人员进行去毛刺操作并记录去毛刺的操作步骤；将集合A与集合M取并集，并将集合A中的毛刺特征的去毛刺的操作步骤与集合A中的毛刺特征进行对应；最终将更新的结果代替毛刺特征集合M进行存储；S403.若经过去毛刺操作的待检测图像的光滑指标小于等于对应模板图像的光滑指标，则进行下一轮压铸件的毛刺检测。6.一种基于机器视觉的压铸件毛刺检测系统，其特征在于：所述系统包括数据获取模块、毛刺识别与特征提取模块、光滑指标计算模块、毛刺检测模块以及毛刺特征更新模块；所述数据获取模块用于采集压铸件的历史数据和实时数据，所述历史数据包括压铸件模板图像和对比图像，所述实时数据包括压铸件的待检测图像；所述毛刺识别与特征提取模块用于将对比图像与模板图像进行比对，识别毛刺并在对比图像上进行标记，以及提取毛刺特征构成毛刺特征集合；所述光滑指标计算模块用于计算模板图像和待检测图像的光滑指标，并将模板图像的光滑指标作为阈值进行后续的毛刺检测；所述毛刺检测模块用于对待检测图像进行毛刺检测，并在图像上进行标记；所述毛刺特征更新模块根据新检测到的毛刺特征，更新毛刺特征集合；所述数据获取模块的输出端与所述毛刺识别与特征提取模块的输入端相连接；所述毛刺识别与特征提取模块的输出端与所述光滑指标计算模块的输入端相连接；所述光滑指标计算模块的输出端与所述毛刺检测模块的输入端相连接；所述毛刺检测模块的输出端与所述毛刺特征更新模块的输入端相连接。7.根据权利要求6所述的一种基于机器视觉的压铸件毛刺检测系统，其特征在于：所述数据获取模块包括历史数据单元与实时数据单元；所述历史数据单元用于获取压铸件模板图像和对比图像；所述实时数据单元用于获取待检测图像；所述历史数据单元的输出端与所述实时数据单元的输入端相连接。8.根据权利要求6所述的一种基于机器视觉的压铸件毛刺检测系统，其特征在于：所述毛刺识别与特征提取模块包括图像比对单元以及特征提取单元；所述图像比对单元用于将对比图像与模板图像进行比对或将待检测图像与模板图像进行比对，识别毛刺并在对比图像或待检测图像上进行标记；所述特征提取单元用于从对比图像或待检测图像中提取毛刺特征构成毛刺集合；所述图像比对单元的输出端与所述实时数据单元的输入端相连接。9.根据权利要求6所述的一种基于机器视觉的压铸件毛刺检测系统，其特征在于：所述光滑指标计算模块包括：计算模板图像和待检测图像的光滑指标，并将每个模板图像的光滑指标作为阈值，计算模板图像相对应的待检测图像的光滑指标；所述毛刺检测模块包括：根据光滑指标计算模块的计算结果，比较经过去毛刺操作的待检测图像的光滑指标与相对应阈值的大小，当待检测图像的光滑指标大于对应模板图像的阈值时，传入毛刺特征更新模块，否则进行新一轮的毛刺检测。10.根据权利要求6所述的一种基于机器视觉的压铸件毛刺检测系统，其特征在于：所述毛刺特征更新模块包括：获取经过去毛刺操作且光滑指标大于对应模板图像的阈值的待检测图像，通过毛刺识别与特征提取模块提取新的毛刺特征并购成毛刺更新图像的毛刺特征集合，再将毛刺更新图像的毛刺特征集合与毛刺特征集合取并集，从而进行毛刺特征的更新；将新的毛刺特征反馈给操作人员，对去毛刺的解决办法进行更新。
说明书desc
技术领域本发明涉及毛刺检测技术领域，具体为一种基于机器视觉的压铸件毛刺检测系统及方法。背景技术压铸件是一种常见的金属铸件，通过压力将熔融金属注入到金属模具中，经过冷却凝固后得到具有特定形状的零件或产品。压铸件通常由铝合金、锌合金、镁合金等金属材料制成，不可避免会有毛刺的产生，因此需要对压铸件的毛刺进行识别。目前，已有一些方法用于检测毛刺，但这些方法存在以下问题：在传统方法中，对于去毛刺操作的判断缺乏统一的标准和指导，不同的操作人员可能会根据个人经验或主观判断来选择去毛刺的方式，导致处理结果差异较大；传统的毛刺检测方法往往只关注检测结果，而忽视了对毛刺特征数据的积累和更新，这导致无法从历史数据中获取更多的毛刺特征信息，限制了毛刺识别的准确性和高效性。发明内容本发明的目的在于提供一种基于机器视觉的压铸件毛刺检测系统及方法，以解决上述背景技术中提出的问题。为了解决上述技术问题，本发明提供如下技术方案：一种基于机器视觉的压铸件毛刺检测方法，方法包括以下步骤：S100.获取历史数据中去毛刺后压铸件各个表面图像，获取历史数据中去毛刺前压铸件各个表面图像，将所述去毛刺前压铸件各个表面图像作为对比图像进行存储；将所述去毛刺后压铸件各个表面图像作为模板图像进行存储；S200.将对比图像与模板图像进行比对，识别毛刺并在对比图像上对毛刺进行标记，提取毛刺特征构成毛刺特征集合；毛刺特征包括毛刺的分布位置、形状以及大小,且每一个毛刺特征对应一种去毛刺的操作步骤；S300.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再进行去毛刺操作；计算模板图像的光滑指标，并将模板图像的光滑指标作为阈值，计算经过去毛刺操作的待检测图像的光滑指标；S400.经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的阈值，对经过去毛刺操作的待检测图像进行步骤S200中对比图像的操作，将发现新的毛刺对毛刺特征集合和对应去毛刺的解决办法进行更新；否则直接进行下一轮压铸件的毛刺检测。进一步的，步骤S100包括：获取历史数据中的压铸件图像数据并进行图像预处理，所述图像预处理包括灰度化、滤波以及边缘检测；根据去毛刺操作的前后，将历史数据中的压铸件图像数据分为对比图像和模板图像，并将相同压铸件相对应的对比图像和模板图像进行关联。进一步的，步骤S200包括：S201.获取模板图像的压铸件各个表面图像的表面积S,以及相对应的对比图像的压铸件各个表面图像的表面积S’；S202.若，则对对比图像进行毛刺识别，对毛刺进行标记；S203.对标记的毛刺进行特征提取构成毛刺特征集合M={m1,m2,...,mn},其中m1代表第1个毛刺特征，m2代表第2个毛刺特征，以此类推mn代表第n个毛刺特征，n为数据编号，取正整数；且一个毛刺特征包括一个毛刺的分布位置、形状以及大小，每一个毛刺特征对应一种去毛刺的操作步骤。进一步的，步骤S300包括：S301.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再根据对应毛刺特征的去毛刺的操作步骤进行操作；S302.将模板图像划分成若干相等面积的m个局部区域，且m≥2；对每个局部区域计算梯度，得到梯度向量为V=（gx,gy)，其中gx表示局部区域内在x方向上的梯度，gy表示局部区域内在y方向上的梯度；计算局部区域i和局部区域j之间的欧式距离dij和相似度sij,根据以下公式：；；其中i，j为局部区域编号，取正整数，gᵢx和gᵢy分别是第i个局部区域在x和y方向上的梯度值，gⱼx和gⱼy分别是第j个局部区域在x和y方向上的梯度值；通过上述计算，得到每个局部区域与其他m-1个局部区域的相似度，计算平均值得到局部区域自身的相似度，即 ，且j≠i；综合所有局部区域的相似度，得到整体的光滑度指标，根据以下公式：；其中wi是局部区域的权重；将模板图像的光滑指标作为阈值；S303.根据步骤S302中模板图像的光滑指标计算公式，计算经过去毛刺操作的待检测图像的光滑指标。进一步的，步骤S400包括：S401.获取经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标；将经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；S402.若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的光滑指标，则将经过去毛刺操作且光滑指标大于对应模板图像阈值的待检测图像并标记为毛刺更新图像；将毛刺更新图像进行步骤S200中对比图像的操作，对毛刺进行标记并提取毛刺特征，构成毛刺更新图像的毛刺特征集合A={a1,a2,...,at},其中a1代表毛刺更新图像的第1个毛刺特征，a2代表毛刺更新图像的第2个毛刺特征，以此类推at代表待毛刺更新图像的第t个毛刺特征，t为数据编号，取正整数；将集合A的毛刺特征反馈给操作人员，由操作人员进行去毛刺操作并记录去毛刺的操作步骤；将集合A与集合M取并集，并将集合A中的毛刺特征的去毛刺的操作步骤与集合A中的毛刺特征进行对应；最终将更新的结果代替毛刺特征集合M进行存储；S403.若经过去毛刺操作的待检测图像的光滑指标小于等于对应模板图像的光滑指标，则进行下一轮压铸件的毛刺检测。一种基于机器视觉的压铸件毛刺检测系统，系统包括数据获取模块、毛刺识别与特征提取模块、光滑指标计算模块、毛刺检测模块以及毛刺特征更新模块；数据获取模块用于采集压铸件的历史数据和实时数据，历史数据包括压铸件模板图像和对比图像，实时数据包括压铸件的待检测图像；毛刺识别与特征提取模块用于将对比图像与模板图像进行比对，识别毛刺并在对比图像上进行标记，以及提取毛刺特征构成毛刺特征集合；光滑指标计算模块用于计算模板图像和待检测图像的光滑指标，并将模板图像的光滑指标作为阈值进行后续的毛刺检测；毛刺检测模块用于对待检测图像进行毛刺检测，并在图像上进行标记；毛刺特征更新模块根据新检测到的毛刺特征，更新毛刺特征集合；数据获取模块的输出端与毛刺识别与特征提取模块的输入端相连接；毛刺识别与特征提取模块的输出端与光滑指标计算模块的输入端相连接；光滑指标计算模块的输出端与毛刺检测模块的输入端相连接；毛刺检测模块的输出端与毛刺特征更新模块的输入端相连接。进一步的，数据获取模块包括历史数据单元与实时数据单元；历史数据单元用于获取压铸件模板图像和对比图像；实时数据单元用于获取待检测图像；历史数据单元的输出端与实时数据单元的输入端相连接。进一步的，毛刺识别与特征提取模块包括图像比对单元以及特征提取单元；图像比对单元用于将对比图像与模板图像进行比对或将待检测图像与模板图像进行比对，识别毛刺并在对比图像或待检测图像上进行标记；特征提取单元用于从对比图像或待检测图像中提取毛刺特征构成毛刺集合；图像比对单元的输出端与实时数据单元的输入端相连接。进一步的，光滑指标计算模块包括：计算模板图像和待检测图像的光滑指标，并将每个模板图像的光滑指标作为阈值，计算模板图像相对应的待检测图像的光滑指标；毛刺检测模块包括：根据光滑指标计算模块的计算结果，比较经过去毛刺操作的待检测图像的光滑指标与相对应阈值的大小，当待检测图像的光滑指标大于对应模板图像的阈值时，传入毛刺特征更新模块，否则进行新一轮的毛刺检测。进一步的，毛刺特征更新模块包括：获取经过去毛刺操作且光滑指标大于对应模板图像的阈值的待检测图像，通过毛刺识别与特征提取模块提取新的毛刺特征并购成毛刺更新图像的毛刺特征集合，再将毛刺更新图像的毛刺特征集合与毛刺特征集合取并集，从而进行毛刺特征的更新；将新的毛刺特征反馈给操作人员，对去毛刺的解决办法进行更新。与现有技术相比，本发明所达到的有益效果是：通过对毛刺的分布位置、形状和大小等特征进行提取和记录，形成毛刺特征集合，每个毛刺特征对应一种去毛刺的操作步骤，为后续处理提供了可靠的依据；通过将模板图像划分为局部区域，并计算每个局部区域之间的相似度，从而得到整体的光滑度指标，该指标用于评估经过去毛刺操作的待检测图像的光滑程度，帮助判断是否需要进行进一步的毛刺更新操作；当经过去毛刺操作的待检测图像的光滑指标大于阈值时，将其视为毛刺更新图像，并进行相关的标记和特征提取，这些更新的结果可用于反馈给操作人员，指导其进行去毛刺操作并记录操作步骤，通过不断更新毛刺特征集合，提高了检测和处理的准确性和高效性。附图说明附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。在附图中：图1是本发明一种基于机器视觉的压铸件毛刺检测系统的模块示意图；图2是本发明一种基于机器视觉的压铸件毛刺检测方法的步骤示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。请参阅图1-图2，本发明提供技术方案：一种基于机器视觉的压铸件毛刺检测方法，方法包括以下步骤：S100.获取历史数据中去毛刺后压铸件各个表面图像，获取历史数据中去毛刺前压铸件各个表面图像，将所述去毛刺前压铸件各个表面图像作为对比图像进行存储；将所述去毛刺后压铸件各个表面图像作为模板图像进行存储；S200.将对比图像与模板图像进行比对，识别毛刺并在对比图像上对毛刺进行标记，提取毛刺特征构成毛刺特征集合；毛刺特征包括毛刺的分布位置、形状以及大小,且每一个毛刺特征对应一种去毛刺的操作步骤；S300.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再进行去毛刺操作；计算模板图像的光滑指标，并将模板图像的光滑指标作为阈值，计算经过去毛刺操作的待检测图像的光滑指标；S400.经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的阈值，对经过去毛刺操作的待检测图像进行步骤S200中对比图像的操作，将发现新的毛刺对毛刺特征集合和对应去毛刺的解决办法进行更新；否则直接进行下一轮压铸件的毛刺检测。步骤S100包括：获取历史数据中的压铸件图像数据并进行图像预处理，所述图像预处理包括灰度化、滤波以及边缘检测；根据去毛刺操作的前后，将历史数据中的压铸件图像数据分为对比图像和模板图像，并将相同压铸件相对应的对比图像和模板图像进行关联。步骤S200包括：S201.获取模板图像的压铸件各个表面图像的表面积S,以及相对应的对比图像的压铸件各个表面图像的表面积S’；S202.若，则对对比图像进行毛刺识别，对毛刺进行标记；S203.对标记的毛刺进行特征提取构成毛刺特征集合M={m1,m2,...,mn},其中m1代表第1个毛刺特征，m2代表第2个毛刺特征，以此类推mn代表第n个毛刺特征，n为数据编号，取正整数；且一个毛刺特征包括一个毛刺的分布位置、形状以及大小，每一个毛刺特征对应一种去毛刺的操作步骤。步骤S300包括：S301.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再根据对应毛刺特征的去毛刺的操作步骤进行操作；S302.将模板图像划分成若干相等面积的m个局部区域，且m≥2；对每个局部区域计算梯度，得到梯度向量为V=（gx,gy)，其中gx表示局部区域内在x方向上的梯度，gy表示局部区域内在y方向上的梯度；计算局部区域i和局部区域j之间的欧式距离dij和相似度sij,根据以下公式：；；其中i，j为局部区域编号，取正整数，gᵢx和gᵢy分别是第i个局部区域在x和y方向上的梯度值，gⱼx和gⱼy分别是第j个局部区域在x和y方向上的梯度值；通过上述计算，得到每个局部区域与其他m-1个局部区域的相似度，计算平均值得到局部区域自身的相似度，即 ，且j≠i；综合所有局部区域的相似度，得到整体的光滑度指标，根据以下公式：；其中wi是局部区域的权重；将模板图像的光滑指标作为阈值；S303.根据步骤S302中模板图像的光滑指标计算公式，计算经过去毛刺操作的待检测图像的光滑指标。步骤S400包括：S401.获取经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标；将经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；S402.若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的光滑指标，则将经过去毛刺操作且光滑指标大于对应模板图像阈值的待检测图像并标记为毛刺更新图像；将毛刺更新图像进行步骤S200中对比图像的操作，对毛刺进行标记并提取毛刺特征，构成毛刺更新图像的毛刺特征集合A={a1,a2,...,at},其中a1代表毛刺更新图像的第1个毛刺特征，a2代表毛刺更新图像的第2个毛刺特征，以此类推at代表待毛刺更新图像的第t个毛刺特征，t为数据编号，取正整数；将集合A的毛刺特征反馈给操作人员，由操作人员进行去毛刺操作并记录去毛刺的操作步骤；将集合A与集合M取并集，并将集合A中的毛刺特征的去毛刺的操作步骤与集合A中的毛刺特征进行对应；最终将更新的结果代替毛刺特征集合M进行存储；S403.若经过去毛刺操作的待检测图像的光滑指标小于等于对应模板图像的光滑指标，则进行下一轮压铸件的毛刺检测。一种基于机器视觉的压铸件毛刺检测系统，系统包括数据获取模块、毛刺识别与特征提取模块、光滑指标计算模块、毛刺检测模块以及毛刺特征更新模块；数据获取模块用于采集压铸件的历史数据和实时数据，历史数据包括压铸件模板图像和对比图像，实时数据包括压铸件的待检测图像；毛刺识别与特征提取模块用于将对比图像与模板图像进行比对，识别毛刺并在对比图像上进行标记，以及提取毛刺特征构成毛刺特征集合；光滑指标计算模块用于计算模板图像和待检测图像的光滑指标，并将模板图像的光滑指标作为阈值进行后续的毛刺检测；毛刺检测模块用于对待检测图像进行毛刺检测，并在图像上进行标记；毛刺特征更新模块根据新检测到的毛刺特征，更新毛刺特征集合；数据获取模块的输出端与毛刺识别与特征提取模块的输入端相连接；毛刺识别与特征提取模块的输出端与光滑指标计算模块的输入端相连接；光滑指标计算模块的输出端与毛刺检测模块的输入端相连接；毛刺检测模块的输出端与毛刺特征更新模块的输入端相连接。数据获取模块包括历史数据单元与实时数据单元；历史数据单元用于获取压铸件模板图像和对比图像；实时数据单元用于获取待检测图像；历史数据单元的输出端与实时数据单元的输入端相连接。毛刺识别与特征提取模块包括图像比对单元以及特征提取单元；图像比对单元用于将对比图像与模板图像进行比对或将待检测图像与模板图像进行比对，识别毛刺并在对比图像或待检测图像上进行标记；特征提取单元用于从对比图像或待检测图像中提取毛刺特征构成毛刺集合；图像比对单元的输出端与实时数据单元的输入端相连接。光滑指标计算模块包括：计算模板图像和待检测图像的光滑指标，并将每个模板图像的光滑指标作为阈值，计算模板图像相对应的待检测图像的光滑指标；毛刺检测模块包括：根据光滑指标计算模块的计算结果，比较经过去毛刺操作的待检测图像的光滑指标与相对应阈值的大小，当待检测图像的光滑指标大于对应模板图像的阈值时，传入毛刺特征更新模块，否则进行新一轮的毛刺检测。毛刺特征更新模块包括：获取经过去毛刺操作且光滑指标大于对应模板图像的阈值的待检测图像，通过毛刺识别与特征提取模块提取新的毛刺特征并购成毛刺更新图像的毛刺特征集合，再将毛刺更新图像的毛刺特征集合与毛刺特征集合取并集，从而进行毛刺特征的更新；将新的毛刺特征反馈给操作人员，对去毛刺的解决办法进行更新。在本实施例中，假设要对一批相同的压铸件进行毛刺检测，根据以下步骤：S100.获取历史数据中去毛刺后压铸件各个表面图像，获取历史数据中去毛刺前压铸件各个表面图像，将所述去毛刺前压铸件各个表面图像作为对比图像进行存储；将所述去毛刺后压铸件各个表面图像作为模板图像进行存储；S200.将对比图像与模板图像进行比对，识别毛刺并在对比图像上对毛刺进行标记，提取毛刺特征构成毛刺特征集合；毛刺特征包括毛刺的分布位置、形状以及大小,且每一个毛刺特征对应一种去毛刺的操作步骤；假设对于一个毛刺特征包含的毛刺分布位置可以是在对比图像上的毛刺中心坐标，以（a,b)的形式进行表示，毛刺的形状是将对比图像上的毛刺轮廓的图像，毛刺的大小则是关于毛刺的长度和宽度的数值。S201.获取模板图像的压铸件各个表面图像的表面积S,以及相对应的对比图像的压铸件各个表面图像的表面积S’；S202.若，则对对比图像进行毛刺识别，对毛刺进行标记；S203.对标记的毛刺进行特征提取构成毛刺特征集合M={m1,m2,...,mn},其中m1代表第1个毛刺特征，m2代表第2个毛刺特征，以此类推mn代表第n个毛刺特征，n为数据编号，取正整数；且一个毛刺特征包括一个毛刺的分布位置、形状以及大小，每一个毛刺特征对应一种去毛刺的操作步骤。假设模板图像的压铸件一个表面图像的表面积为S1,以及相对应的对比图像的压铸件的表面图像的表面积S1’；若，说明对比图像存在毛刺，则对对比图像进行毛刺识别，对毛刺进行标记；假设标记有三个毛刺，则获得毛刺特征集合M={m1,m1,m3}，且每个毛刺特征对应一种去毛刺的操作步骤，具体包括使用的设备和工具以及完整的操作流程。S300.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再进行去毛刺操作；计算模板图像的光滑指标，并将模板图像的光滑指标作为阈值，计算经过去毛刺操作的待检测图像的光滑指标；S301.将实时数据中的的待检测压铸件各个表面图像作为待检测图像进行存储，根据毛刺特征集合进行毛刺识别并在待检测图像上对毛刺进行标记，再根据对应毛刺特征的去毛刺的操作步骤进行操作；S302.将模板图像划分成若干相等面积的m个局部区域，且m≥2；对每个局部区域计算梯度，得到梯度向量为V=（gx,gy)，其中gx表示局部区域内在x方向上的梯度，gy表示局部区域内在y方向上的梯度；计算局部区域i和局部区域j之间的欧式距离dij和相似度sij,根据以下公式：；；其中i，j为局部区域编号，取正整数，gᵢx和gᵢy分别是第i个局部区域在x和y方向上的梯度值，gⱼx和gⱼy分别是第j个局部区域在x和y方向上的梯度值；通过上述计算，得到每个局部区域与其他m-1个局部区域的相似度，计算平均值得到局部区域自身的相似度，即 ，且j≠i；综合所有局部区域的相似度，得到整体的光滑度指标，根据以下公式：；其中wi是局部区域的权重；将模板图像的光滑指标作为阈值；S303.根据步骤S302中模板图像的光滑指标计算公式，计算经过去毛刺操作的待检测图像的光滑指标。S400.经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的阈值，对经过去毛刺操作的待检测图像进行步骤S200中对比图像的操作，将发现新的毛刺对毛刺特征集合和对应去毛刺的解决办法进行更新；否则直接进行下一轮压铸件的毛刺检测。S401.获取经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标；将经过去毛刺操作的待检测图像的光滑指标与对应模板图像的光滑指标进行比较；S402.若经过去毛刺操作的待检测图像的光滑指标大于对应模板图像的光滑指标，则将经过去毛刺操作且光滑指标大于对应模板图像阈值的待检测图像并标记为毛刺更新图像；将毛刺更新图像进行步骤S200中对比图像的操作，对毛刺进行标记并提取毛刺特征，构成毛刺更新图像的毛刺特征集合A={a1,a2,...,at},其中a1代表毛刺更新图像的第1个毛刺特征，a2代表毛刺更新图像的第2个毛刺特征，以此类推at代表待毛刺更新图像的第t个毛刺特征，t为数据编号，取正整数；将集合A的毛刺特征反馈给操作人员，由操作人员进行去毛刺操作并记录去毛刺的操作步骤；将集合A与集合M取并集，并将集合A中的毛刺特征的去毛刺的操作步骤与集合A中的毛刺特征进行对应；最终将更新的结果代替毛刺特征集合M进行存储；假设经过将毛刺更新图像进行步骤S200中对比图像的操作，对毛刺进行标记并提取毛刺特征，构成毛刺更新图像的毛刺特征集合A={a1,a2}，将集合A中的毛刺特征反馈给操作人员，由操作人员使用具体的去毛刺设备和工具进行取去毛刺操作，记录去毛刺的操作步骤，并将去毛刺的操作具体步骤与集合A中的毛刺特征进行对应，最后的更新结果为A∪M={m1,m1,m3,a1,a2}，取代集合M进行存储。S403.若经过去毛刺操作的待检测图像的光滑指标小于等于对应模板图像的光滑指标，则进行下一轮压铸件的毛刺检测。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。最后应说明的是：以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
