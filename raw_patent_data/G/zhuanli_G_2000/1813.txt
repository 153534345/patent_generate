标题title
一种用于提高AXI总线读效率的装置及方法
摘要abst
本发明提供了一种用于提高AXI总线读效率的装置及方法，通过对主控设备发出的读命令的地址以及下一条读命令的地址来判断跳转方向，在读命令的地址命中预取装置的地址缓存列表时，直接读取，没有命中时，将没命中的地址也进行保存，然后将下一条读命令的地址保存在地址跳转记录表中，这样不管第一条读命令是否命中，记住第一条读命令跳转的下一条读命令，增加命中概率的预取地址，然后再根据第一条读命令和第二条读命令地址的差值，来判断下跳转模式，再根据跳转模式来给出第三条读地址的预测值，通过本发明的方法，增加了预取地址的命中概率，从而提高了AXI总线的读速度，进而提高了AXI总线的传输效率。
权利要求书clms
1.一种用于提高AXI总线读效率的装置，其特征在于，包括AXI总线，预取装置，主控设备和受控设备，所述AXI总线包括用于对主控设备发出的读地址以及接收的读数据发送到主控设备进行仲裁的仲裁装置，所述预取装置中设置有地址缓存列表，将地址缓存列表中的预取地址对应的数据预先读取出来缓存到缓冲中，还包括自适应装置，用于根据当前读命令地址和下一条读命令地址对再下一条读命令地址进行预测，并向受控设备发送预测的读地址命令，将读命令读到的数据预先读取出来缓存到缓冲中，同时将预测的读地址增加到预取装置中的地址缓存列表中，所述自适应装置位于预取装置之后，受控设备之前，预取装置、自适应装置与受控设备一一对应。2.根据权利要求1所述的装置，其特征在于，所述自适应装置包括没命中地址缓存列表、地址跳转记录表，所述地址跳转记录表中记录读命令地址跳转的下一条读命令的地址；当AXI总线发出第一条读命令后，如果读命令地址命中预取装置中地址缓存列表中的地址，则将缓冲中的读数据发送给主控设备；如果读命令地址没有命中地址缓存列表中的地址，则将该读命令地址发送给受控设备返回读数据给主控设备，同时将该读命令地址记录在没命中地址缓存列表中；AXI总线发出第二条读命令地址，判断读地址的跳转模式，同时将第二条读命令地址和跳转模式记录在地址跳转记录表中，所述跳转模式包括顺序跳转和非顺序跳转；所述地址跳转记录表中的记录分别与预取装置中的地址缓存列表或自适应装置中的没命中地址缓存列表一一对应，为地址缓存列表或没命中地址缓存列表中各读命令地址后的下一条跳转命令地址。3.根据权利要求2所述的装置，其特征在于，根据AXI总线发出的下一条读命令地址，判断读地址的跳转模式的方法是：计算第二条读命令地址和第一条读命令地址的地址差值，如果地址差值为AXI总线接口的数据宽度乘读数据长度，则地址跳转模式为顺序跳转模式，将顺序跳转模式记录在地址跳转记录表中与第二条读命令地址对应的记录上；如果地址差值不是AXI总线接口的数据宽度乘数据长度，则地址跳转模式为非顺序跳转，将非顺序跳转模式记录在地址跳转记录表中与第二条读命令地址对应的记录上。4.根据权利要求3所述的装置，其特征在于，如果读命令地址没命中地址缓存列表中的地址，则将该读命令地址在没命中地址缓存列表中进行检索，如果该读命令地址在没命中地址缓存列表中有记录，则从地址跳转记录表中找出与该读命令地址对应的下一条读取命令的地址，将这下一条读取命令的地址作为预测的读地址命令发送给受控设备进行数据读取，并将读取的数据缓存到缓冲区，同时将这下一条读取命令的地址写入预取装置的地址缓存列表中；如果读命令地址命中地址缓存列表中的地址，则从地址跳转记录表中找出该读命令地址对应的下一条读取命令的地址，将跳转记录表中的这下一条读取命令的地址作为预测的读地址命令发送给受控设备进行数据读取，并将读取的数据缓存到缓冲区，同时将这下一条读取命令的地址写入预取装置的地址缓存列表中。5.根据权利要求4所述的装置，其特征在于，所述自适应装置还包括顺序跳转记录表和跳转链表，所述顺序跳转记录表记录顺序跳转模式的读数据长度，根据地址跳转记录表中的下一条读命令的地址，则预测的读地址为地址跳转记录表中的下一条读命令的地址加上读数据长度乘AXI总线接口的数据宽度的值；所述跳转链表中记录的是非顺序跳转模式下，地址跳转记录表中与下一条读命令地址相对应的AXI总线发出的再下一条读命令地址和读数据长度，则预测的读地址为跳转链表中再下一条读命令地址加上读数据长度乘AXI总线接口的数据宽度的值；根据预测的读地址向受控设备发出读命令，将该预测的读地址对应的数据保存到缓冲中，同时将该预测的读地址保存在预取装置的地址缓存列表中。6.根据权利要求5所述的装置，其特征在于，预取装置的地址缓存列表中还设置地址有效位，当地址对应的读数据已经写入缓冲区，则将地址有效位设为有效，否则设为无效，主控设备发出的读地址在命中地址缓存列表中的地址时，若读地址对应的地址有效位为无效，则发送该读地址的命令到受控设备。7.根据权利要求6所述的装置，其特征在于，所述地址缓存列表中使用标签tag作为每一条记录的关键字，记录条目从0-n依次递增，地址跳转记录表中使用与地址缓存列表中相同的标签tag，来表示地址缓存列表中的读地址对应的下一条读地址命令记录在地址跳转记录表中相同标签的记录中；没命中地址缓存列表中的标签从0-n递增，在地址跳转记录表中记录与没命中地址缓存列表中读地址相对应的下一条读命令地址时，地址跳转记录表中的标签条目为n加上没命中地址缓存列表中的标签；跳转列表和顺序跳转记录中的标签与地址跳转记录表中的标签相对应，相同标签的记录表示这条记录为地址跳转记录表中的地址对应的下一条读命令地址。8.一种用于提高AXI总线读效率的方法，使用权利要求1至6任一项所述的一种用于提高AXI总线读效率的装置，其特征在于，包括以下步骤：步骤1：获取主控设备发送的读地址命令；步骤2：根据读地址在预取装置的地址缓存列表中进行查找，如果命中，在读地址对应的有效位有效时，从缓冲中读取读数据并发送给主控设备，如果读地址对应的有效位为无效，则发送读命令；如果没有命中，则将该读地址命令发送到受控单元，同时在自适应装置的没命中缓冲地址列表中保存该命令地址；步骤3：获取主控设备发送的下一条读地址命令，将这下一条读地址存入自适应装置的地址跳转记录表；步骤4：计算下一条读命令地址与前一条读命令地址的差值，如果差值等于AXI总线接口的数据宽度乘数据长度，则记录跳转模式为顺序跳转模式，并将顺序跳转模式记录在地址跳转记录表中与下一条读命令地址对应的跳转模式中；如果差值不等于数据宽度乘数据长度，则记录跳转模式为非顺序跳转模式，将非顺序跳转模式记录在地址跳转记录表中与下一条读命令地址对应的跳转模式中；步骤5：当跳转模式为顺序跳转模式时，在顺序跳转记录表中记录读数据长度；当跳转模式为非顺序跳转模式时，获取主控设备发送的再下一条读地址命令及读数据长度，在跳转链表中记录地址跳转记录表中与下一条读命令地址相对应的再下一条读命令地址及读数据长度；步骤6：如果读地址命令命中预取装置中地址缓存列表中的地址，从自适应装置的地址跳转列表中找与该读命令地址对应的下一条读命令地址，如果读地址没有命中地址缓存列表中的地址，从没命中地址缓存列表中进行查找，如果有，则从自适应装置的地址跳转列表中找到与该读地址对应的下一条读命令的地址，步骤7：将这下一条读命令地址作为第一个预测的读地址发送给受控设备，将读到的数据存入缓冲区，并将第一个预测的读地址加入地址缓存列表，使地址缓存列表中对应地址的有效位设为有效；步骤8：计算下一条读命令地址与当前读地址的差值，当跳转模式为顺序跳转时，则第二个预测的读地址为地址跳转记录表中的下一条读地址加上顺序跳转记录表中与下一条读地址相对应的读数据长度乘AXI总线接口的数据宽度的值；当跳转模式为非顺序跳转时，则第二个预测的读地址为跳转链表中的再下一条读命令地址加上读数据长度乘AXI总线接口的数据宽度的值；将第二个预测的读地址发送给受控设备，并将读到的数据存入缓冲区，将第二个预测的读地址加入地址缓存列表，使地址缓存列表中对应地址的有效位设为有效。
说明书desc
技术领域本发明属于总线控制领域，尤其是涉及一种用于提高AXI总线读效率的装置及方法。背景技术AXI是ARM公司提出的AMBA4.0协议中最重要的部分，是一种高性能、高带宽、低延迟的片内总线。AXI协议的地址/控制和数据是分离的通道，支持不对齐的数据传输，同时在突发传输中，只需要首地址，传输长度最高可达4KB。AXI协议支持分离的读写数据通道、支持Outstanding传输访问和乱序访问。AXI高性能总线系统主要由主控设备、受控设备、基础架构三部分构成。整个AXI总线上的读写传输申请都是由主控设备发出，由受控设备负责回应。该AXI总线具有读写传输性能高、时序收敛的特点。AXI协议丰富了AMBA标准内容，满足超高性能和复杂的片上系统设计的需求。AXI系统总线是AXI总线系统中的核心控制器，将M个主控设备和N个受控设备进行互联通信，实现多个不同独立地址分配的数据传输。AXI系统总线的工作模式为多个主控设备发起读写命令传输申请，经过地址仲裁器决定该申请发送到某个受控设备，从设备接收到读写命令申请后，完成数据传输。目前针对AXI系统总线读性能的优化为增加预取装置，当接收到读地址后，预取与该读地址信号相关的地址，将返回的读数据缓存在预取装置中。这种预取方式只预取与之前的读地址相关的地址，不能自动调节预取读地址的范围，因此存在命中率低，性格提高不显著，读数据需要缓存在预取装置中存在浪费面积的问题。发明内容本发明所要解决的技术问题是怎样提高AXI总线读取数据命中的概率，加快读取速度，提升AXI总线的读性能，提出了一种用于提高AXI总线读效率的装置及方法。为解决上述技术问题，本发明所采用的技术方案是：一种用于提高AXI总线读效率的装置，包括AXI总线，预取装置，主控设备和受控设备，所述AXI总线包括用于对主控设备发出的读地址以及接收的读数据发送到主控设备进行仲裁的仲裁装置，所述预取装置中设置有地址缓存列表，将地址缓存列表中的预取地址对应的数据预先读取出来缓存到缓冲中，还包括自适应装置，用于根据当前读命令地址和下一条读命令地址对再下一条读命令地址进行预测，并向受控设备发送预测的读地址命令，将读命令读到的数据预先读取出来缓存到缓冲中，同时将预测的读地址增加到预取装置中的地址缓存列表中，所述自适应装置位于预取装置之后，受控设备之前，预取装置、自适应装置与受控设备一一对应。进一步地，所述自适应装置包括没命中地址缓存列表、地址跳转记录表，所述地址跳转记录表中记录读命令地址跳转的下一条读命令的地址；当AXI总线发出第一条读命令后，如果读命令地址命中预取装置中地址缓存列表中的地址，则将缓冲中的读数据发送给主控设备；如果读命令地址没有命中地址缓存列表中的地址，则将该读命令地址发送给受控设备返回读数据给主控设备，同时将该读命令地址记录在没命中地址缓存列表中；AXI总线发出第二条读命令地址，判断读地址的跳转模式，同时将第二条读命令地址和跳转模式记录在地址跳转记录表中，所述跳转模式包括顺序跳转和非顺序跳转；所述地址跳转记录表中的记录分别与预取装置中的地址缓存列表或自适应装置中的没命中地址缓存列表一一对应，为地址缓存列表或没命中地址缓存列表中各读命令地址后的下一条跳转命令地址。进一步地，根据AXI总线发出的下一条读命令地址，判断读地址的跳转模式的方法是：计算第二条读命令地址和第一条读命令地址的地址差值，如果地址差值为AXI总线接口的数据宽度乘读数据长度，则地址跳转模式为顺序跳转模式，将顺序跳转模式记录在地址跳转记录表中与第二条读命令地址对应的记录上；如果地址差值不是AXI总线接口的数据宽度乘数据长度，则地址跳转模式为非顺序跳转，将非顺序跳转模式记录在地址跳转记录表中与第二条读命令地址对应的记录上。进一步地，如果读命令地址没命中地址缓存列表中的地址，则将该读命令地址在没命中地址缓存列表中进行检索，如果该读命令地址在没命中地址缓存列表中有记录，则从地址跳转记录表中找出与该读命令地址对应的下一条读取命令的地址，将这下一条读取命令的地址作为预测的读地址命令发送给受控设备进行数据读取，并将读取的数据缓存到缓冲区，同时将这下一条读取命令的地址写入预取装置的地址缓存列表中；如果读命令地址命中地址缓存列表中的地址，则从地址跳转记录表中找出该读命令地址对应的下一条读取命令的地址，将跳转记录表中的这下一条读取命令的地址作为预测的读地址命令发送给受控设备进行数据读取，并将读取的数据缓存到缓冲区，同时将这下一条读取命令的地址写入预取装置的地址缓存列表中。进一步地，所述自适应装置还包括顺序跳转记录表和跳转链表，所述顺序跳转记录表记录顺序跳转模式的读数据长度，根据地址跳转记录表中的下一条读命令的地址，则预测的读地址为地址跳转记录表中的下一条读命令的地址加上读数据长度乘AXI总线接口的数据宽度的值；所述跳转链表中记录的是非顺序跳转模式下，地址跳转记录表中与下一条读命令地址相对应的AXI总线发出的再下一条读命令地址和读数据长度，则预测的读地址为跳转链表中再下一条读命令地址加上读数据长度乘AXI总线接口的数据宽度的值；根据预测的读地址向受控设备发出读命令，将该预测的读地址对应的数据保存到缓冲中，同时将该预测的读地址保存在预取装置的地址缓存列表中。进一步地，预取装置的地址缓存列表中还设置地址有效位，当地址对应的读数据已经写入缓冲区，则将地址有效位设为有效，否则设为无效，主控设备发出的读地址在命中地址缓存列表中的地址时，若读地址对应的地址有效位为无效，则发送该读地址的命令到受控设备。进一步地，所述地址缓存列表中使用标签tag作为每一条记录的关键字，记录条目从0-n依次递增，地址跳转记录表中使用与地址缓存列表中相同的标签tag，来表示地址缓存列表中的读地址对应的下一条读地址命令记录在地址跳转记录表中相同标签的记录中；没命中地址缓存列表中的标签从0-n递增，在地址跳转记录表中记录与没命中地址缓存列表中读地址相对应的下一条读命令地址时，地址跳转记录表中的标签条目为n加上没命中地址缓存列表中的标签；跳转列表和顺序跳转记录中的标签与地址跳转记录表中的标签相对应，相同标签的记录表示这条记录为地址跳转记录表中的地址对应的下一条读命令地址。本发明还提供了一种用于提高AXI总线读效率的方法，使用前面所述的一种用于提高AXI总线读效率的装置，包括以下步骤：步骤1：获取主控设备发送的读地址命令；步骤2：根据读地址在预取装置的地址缓存列表中进行查找，如果命中，在读地址对应的有效位有效时，从缓冲中读取读数据并发送给主控设备，如果读地址对应的有效位为无效，则发送读命令；如果没有命中，则将该读地址命令发送到受控单元，同时在自适应装置的没命中缓冲地址列表中保存该命令地址；步骤3：获取主控设备发送的下一条读地址命令，将这下一条读地址存入自适应装置的地址跳转记录表；步骤4：计算下一条读命令地址与前一条读命令地址的差值，如果差值等于AXI总线接口的数据宽度乘数据长度，则记录跳转模式为顺序跳转模式，并将顺序跳转模式记录在地址跳转记录表中与下一条读命令地址对应的跳转模式中；如果差值不等于数据宽度乘数据长度，则记录跳转模式为非顺序跳转模式，将非顺序跳转模式记录在地址跳转记录表中与下一条读命令地址对应的跳转模式中；步骤5：当跳转模式为顺序跳转模式时，在顺序跳转记录表中记录读数据长度；当跳转模式为非顺序跳转模式时，获取主控设备发送的再下一条读地址命令及读数据长度，在跳转链表中记录地址跳转记录表中与下一条读命令地址相对应的再下一条读命令地址及读数据长度；步骤6：如果读地址命令命中预取装置中地址缓存列表中的地址，从自适应装置的地址跳转列表中找与该读命令地址对应的下一条读命令地址，如果读地址没有命中地址缓存列表中的地址，从没命中地址缓存列表中进行查找，如果有，则从自适应装置的地址跳转列表中找到与该读地址对应的下一条读命令的地址，步骤7：将这下一条读命令地址作为第一个预测的读地址发送给受控设备，将读到的数据存入缓冲区，并将第一个预测的读地址加入地址缓存列表，使地址缓存列表中对应地址的有效位设为有效；步骤8：计算下一条读命令地址与当前读地址的差值，当跳转模式为顺序跳转时，则第二个预测的读地址为地址跳转记录表中的下一条读地址加上顺序跳转记录表中与下一条读地址相对应的读数据长度乘AXI总线接口的数据宽度的值；当跳转模式为非顺序跳转时，则第二个预测的读地址为跳转链表中的再下一条读命令地址加上读数据长度乘AXI总线接口的数据宽度的值；将第二个预测的读地址发送给受控设备，并将读到的数据存入缓冲区，将第二个预测的读地址加入地址缓存列表，使地址缓存列表中对应地址的有效位设为有效。采用上述技术方案，本发明具有如下有益效果：本发明提供的一种用于提高AXI总线读效率的装置及方法，通过对主控设备发出的读命令的地址以及下一条读命令的地址来判断跳转方向，在读命令的地址命中预取装置的地址缓存列表时，直接读取，没有命中时，将没命中的地址也进行保存，然后将下一条读命令的地址保存在地址跳转记录表中，这样不管第一条读命令是否命中，记住第一条读命令跳转的下一条读命令作为预测读命令地址，增加预取地址的命中概率，然后再根据第一条读命令和第二条读命令地址的差值，来判断下一条读命令的跳转模式，再根据跳转模式来给出第三条读地址的预测值，通过本发明的方法，增加了预取地址的命中概率，从而提高了AXI总线的读速度，进而提高了AXI总线的传输效率。附图说明图1为本发明带有预取装置和自适应装置的AXI总线系统架构；图2为预取装置中命中缓冲结构框图；图3为预取没命中地址框图；图4为根据跳转模式计算预测地址示意图。具体实施方式下面将结合附图对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。图1至图4示出了本发明一种用于提高AXI总线读效率的装置的具体实施例，包括AXI总线，预取装置，主控设备和受控设备，所述AXI总线包括用于对主控设备发出的读地址以及接收的读数据发送到主控设备进行仲裁的仲裁装置，所述预取装置中设置有地址缓存列表，将地址缓存列表中的预取地址对应的数据预先读取出来缓存到缓冲中，还包括自适应装置，用于根据当前读命令地址和下一条读命令地址对再下一条读命令地址进行预测，并向受控设备发送预测的读地址命令，将读命令读到的数据预先读取出来缓存到缓冲中，同时将预测的读地址增加到预取装置中的地址缓存列表中，所述自适应装置位于预取装置之后，受控设备之前，预取装置、自适应装置与受控设备一一对应。如图1所示，主控设备0、主控设备1...主控设备n分别是n个主控设备，受控设备0、受控设备1、...受控设备n分别是n个受控设备，在AXI总线中，设置有AXI总线的仲裁装置，预取装置0、预取装置1...预取装置n分别是原有的n个预取装置，每个受控设备分别对应一个预取装置，在原有的预取装置后，每个受控设备前，增加对预取地址的自适应装置，如图1中的自适应装置0、自适应装置1...自适应装置n分别是n个自适应装置，与预取装置和受控设备一一对应。本实施例中，如图2和图3所示，所述自适应装置包括没命中地址缓存列表、地址跳转记录表，所述地址跳转记录表中记录读命令地址跳转的下一条读命令的地址；当AXI总线发出读命令后，如果读命令地址命中图2预取装置中地址缓存列表中的地址，则将地址缓存列表中与该读命令地址相对应的缓冲地址中的读数据发送给主控设备；如果读命令地址没有命中地址缓存列表中的地址，则将该读命令地址发送给受控设备返回读数据给主控设备，同时将该读命令地址记录在图3的没命中地址缓存列表中；AXI总线发出下一条读命令地址，判断读地址的跳转模式，将下一条读命令地址和跳转模式记录在地址跳转记录表中，所述跳转模式包括顺序跳转和非顺序跳转；所述地址跳转记录表与预取装置中的地址缓存列表和自适应装置中的没命中地址缓存列表一一对应。图2中，地址缓存列表包括标签Tag，预取地址Address，地址有效位valid，读数据缓冲地址DRAM Address，图2中还有地址缓存列表中每一个命中地址对应的AXI总线发出的下一个跳转命令所对应的读地址，如读命令命中了地址缓存列表中标签为T1的这一条记录，其下一条读命令在地址跳转记录表中进行了记录，同样在地址跳转记录表中使用标签为T1的这一行，记录了下一条命令中跳转的地址B1和跳转模式M1。本实施例中，所述地址缓存列表中使用标签tag作为每一条记录的关键字，记录条目从0-n依次递增，地址跳转记录表中使用与地址缓存列表中相同的标签tag，来表示地址缓存列表中标签的记录中；表格使用相同标签这样的记录方式，而不是在地址跳转记录表中使用地址缓存列表中的读地址作为关键词，如图2中，标签T1对应的这条记录，A1为主控设备发出的读地址，那么主控设备发出的下一条读地址B1在地址跳转记录表中只记录与地址缓存列表相同的标签T1，来表示地址跳转记录表中的T1记录的是A1后的下一条读命令地址，因为保存成标签T1，在表中进行索引时，标签的比较相对于地址的比较节省了比较面积，时序收敛，如果比较地址，逻辑面积会增大。图3中，将没命中的地址也进行了保存，并对这个没命中地址的下一条地址跳转记录即下一条命令的地址进行保存，这样在第一条读命令没命中的情况下，记录这个没命中的读地址的下一条读命令，从而使这下一条读命令的地址作为预取地址进行读数据缓冲，增加命中概率。因此，本实施例增加了没命中地址缓存列表，在读地址没命中时，则从没命中地址缓存列表中找到记录，进而找到当时与这条没命中地址相应的下一条读命令的地址进行读取缓冲，那么命中的概率会大大提高。本实施例中，没命中地址缓存列表包括标签Tag和没命中的读地址，地址跳转记录表包括标签Tag，下一条读命令的读地址，跳转类型Model。没命中地址缓存列表中的标签从0-n递增，在地址跳转记录表中记录与没命中地址缓存列表中读地址相对应的下一条读命令地址时，因为地址跳转记录表即需要记录地址缓存列表中读地址对应的下一条读命令地址，也需要记录没命中地址缓存列表中读地址对应的下一条读命令地址，所以地址跳转记录表中对应于没命中地址缓存列表中的标签条目为n加上没命中地址缓存列表中的标签，地址跳转记录表Tn+1到Tn+n记录的是与没命中地址缓存列表对应的条目，n为地址缓存列中的条目记录总数。本实施例中，根据AXI总线发出的下一条读命令地址，判断读地址的跳转模式的方法是：计算第二条读命令地址和第一条读命令地址的地址差值，如果地址差值为AXI总线接口的数据宽度乘读数据长度，则地址跳转模式为顺序跳转模式，将顺序跳转模式记录在地址跳转记录表中与第二条读命令地址对应的记录上；如果地址差值不是AXI总线接口的数据宽度乘数据长度，则地址跳转模式为非顺序跳转，将非顺序跳转模式记录在地址跳转记录表中与第二条读命令地址对应的记录上。本实施例中通过计算第二条读命令地址和上一条读命令地址的差值来判断是否是顺序跳转，从而根据跳转模式来计算再下一条读命令地址。本实施例中，如果读命令地址没命中地址缓存列表中的地址，则将该读命令地址在没命中地址缓存列表中进行检索，如果该读命令地址在没命中地址缓存列表中有记录，则从地址跳转记录表中找出与该读命令地址对应的下一条读取命令的地址，将这下一条读取命令的地址作为预测的读地址命令发送给受控设备进行数据读取，并将读取的数据缓存到缓冲区，同时将这下一条读取命令的地址写入预取装置的地址缓存列表中；如果读命令地址命中地址缓存列表中的地址，则从地址跳转记录表中找出该读命令地址对应的下一条读取命令的地址，将跳转记录表中的这下一条读取命令的地址作为预测的读地址命令发送给受控设备进行数据读取，并将读取的数据缓存到缓冲区，同时将这下一条读取命令的地址写入预取装置的地址缓存列表中。通过对读命令地址命中和没命中的都进行记录，命中的直接将读数据返回，但是通过对当前命中地址的下一条读命令进行记录保存，从而对其下一个命令的走向进行关注，对下一个命令地址进行预读取，提高命中概率。同样，虽然当前读命令地址没有命中，但是也关注其下一条命令的走向，将其在地址跳转记录表中进行记录，并对下一条命令地址进行预读取，增加命中概率，然后根据两次读命令地址的差值，判断其第三条读命令地址的走向，对第三次读命令地址进行预测，通过这种对前几次读地址下一次的走向的记录，进行有针对性的预测，增加了预取地址命中的概率。本实施例中，如图4所示，所述自适应装置还包括顺序跳转记录表和跳转链表，所述顺序跳转记录表记录顺序跳转模式的读数据长度Ln，根据地址跳转记录表中的下一条读命令的地址Bn，则预测的读地址为地址跳转记录表中的下一条读命令的地址加上读数据长度乘AXI总线接口的数据宽度的值Bn+Ln*size；所述跳转链表中记录的是非顺序跳转模式下，地址跳转记录表中与下一条读命令地址相对应的AXI总线发出的再下一条读命令地址Bxn和读数据长度Ln，则预测的读地址为跳转链表中再下一条读命令地址加上读数据长度乘AXI总线接口的数据宽度的值Bxn+Ln*size；根据预测的读地址向受控设备发出读命令，将该预测的读地址对应的数据保存到缓冲中，同时将该预测的读地址保存在预取装置的地址缓存列表中。本实施例中，跳转列表和顺序跳转记录中的标签与地址跳转记录表中的标签相对应，相同标签的记录表示这条记录为地址跳转记录表中的地址对应的下一条读命令地址。如图4所示，跳转链表和顺序跳转记录表中的标签与地址跳转记录表中的标签对应。通过地址跳转记录表中下一条读命令地址对预取地址进行了预测，但同时根据下一条读命令与当前读命令的差值对跳转方向进行了一个预测，预测出接下来的第三条读命令地址，通过这种地址预测，增加了预取地址命中的概率，从而提高了AXI总线的读速度，进而提高了AXI总线的传输效率。本实施例中，预取装置的地址缓存列表中还设置地址有效位，当地址对应的读数据已经写入缓冲区，则将地址有效位设为有效，否则设为无效，主控设备发出的读地址在命中地址缓存列表中的地址时，若读地址对应的地址有效位为无效，则发送该读地址的命令到受控设备。通过有效位的设置保证读数据已经全部写入缓冲中，如果读数据还没有全部写完，这时候主控设备发出的读命令中的读地址正好命中，从缓冲中读取的数据不能保证全部正确。而有效位的设置是在读数据全部写入的情况下，才将有效位设置为有效，避免了因数据没写完造成失误。图2中的有效位valid设置为1表示有效，设置为0表示无效。本发明还提供了一种用于提高AXI总线读效率的方法，使用前面所述的一种用于提高AXI总线读效率的装置，包括以下步骤：步骤1：获取主控设备发送的读地址命令；步骤2：根据读地址在预取装置的地址缓存列表中进行查找，如果命中，在读地址对应的有效位有效时，从缓冲中读取读数据并发送给主控设备，如果读地址对应的有效位为无效，则发送读命令；如果没有命中，则将该读地址命令发送到受控单元，同时在自适应装置的没命中缓冲地址列表中保存该命令地址；步骤3：获取主控设备发送的下一条读地址命令，将这下一条读地址存入自适应装置的地址跳转记录表；步骤4：计算下一条读命令地址与前一条读命令地址的差值，如果差值等于AXI总线接口的数据宽度乘数据长度，则记录跳转模式为顺序跳转模式，并将顺序跳转模式记录在地址跳转记录表中与下一条读命令地址对应的跳转模式中；如果差值不等于数据宽度乘数据长度，则记录跳转模式为非顺序跳转模式，将非顺序跳转模式记录在地址跳转记录表中与下一条读命令地址对应的跳转模式中；步骤5：当跳转模式为顺序跳转模式时，在顺序跳转记录表中记录读数据长度；当跳转模式为非顺序跳转模式时，获取主控设备发送的再下一条读地址命令及读数据长度，在跳转链表中记录地址跳转记录表中与下一条读命令地址相对应的再下一条读命令地址及读数据长度；步骤6：如果读地址命令命中预取装置中地址缓存列表中的地址，从自适应装置的地址跳转列表中找与该读命令地址对应的下一条读命令地址，如果读地址没有命中地址缓存列表中的地址，从没命中地址缓存列表中进行查找，如果有，则从自适应装置的地址跳转列表中找到与该读地址对应的下一条读命令的地址，步骤7：将这下一条读命令地址作为第一个预测的读地址发送给受控设备，将读到的数据存入缓冲区，并将第一个预测的读地址加入地址缓存列表，使地址缓存列表中对应地址的有效位设为有效；步骤8：计算下一条读命令地址与当前读地址的差值，当跳转模式为顺序跳转时，则第二个预测的读地址为地址跳转记录表中的下一条读地址加上顺序跳转记录表中与下一条读地址相对应的读数据长度乘AXI总线接口的数据宽度的值；当跳转模式为非顺序跳转时，则第二个预测的读地址为跳转链表中的再下一条读命令地址加上读数据长度乘AXI总线接口的数据宽度的值；将第二个预测的读地址发送给受控设备，并将读到的数据存入缓冲区，将第二个预测的读地址加入地址缓存列表，使地址缓存列表中对应地址的有效位设为有效。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围。
