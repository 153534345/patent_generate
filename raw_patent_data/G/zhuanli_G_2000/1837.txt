标题title
一种基于增量学习的太阳能电池缺陷检测持续优化方法
摘要abst
本发明涉及计算机视觉技术领域，具体公开了一种基于增量学习的太阳能电池缺陷检测持续优化方法，其构建缺陷检测模型，对缺陷检测模型持续优化更新，具体是：持续输入缺陷数据，更新特征提取器、辅助分类器、特征融合器和分类器，利用梯度下降法进行增量训练，构建未知缺陷类别范例集并调整已知缺陷类别范例集，基于特征提取器的几何中心对特征提取器进行剪枝，实现大幅减轻灾难性遗忘、新旧任务检测持续优化兼顾的缺陷检测。优点是，少量类别数据集即可启动缺陷检测过程，并只需在各阶段存储旧数据集极小规模范例集和输入训练集，保证对缺陷检测模型持续优化更新，同时降低了存储与计算负荷。
权利要求书clms
1.一种基于增量学习的太阳能电池缺陷检测持续优化方法，其特征在于，包括如下步骤：步骤S1，缺陷数据持续输入：输入范例集和缺陷数据，所述范例集为旧数据集的子集，所述缺陷数据包括未知类别数据和含有新特征值的已知类别数据，范例集和缺陷数据的并集为训练集；步骤S2，特征提取器扩展：构建一个新特征提取器，并使用旧模型中特征提取器的参数对新特征提取器进行初始化，得到新增特征提取器；步骤S3，辅助分类器构建：构建辅助分类器，将所有已知类别数据作为一个类别进行处理，计算有关新特征的辅助损失；步骤S4，特征融合器构建：通过新增特征提取器从多个尺度提取太阳能电池图像的特征，将提取的所有特征连接起来，得到中间特征图，基于通道与空间注意力机制精炼中间特征图，输入中间特征图，依次推断一维注意力图和二维注意力图，通过特征融合器得到精炼特征图；步骤S5，分类器更新：从旧模型分类器中复制用于旧特征的参数构建当前阶段分类器，并按照当前阶段未知缺陷类别数量增加相应的全连接层节点，新增参数随机初始化，将精炼特征图发送到当前阶段分类器中得到预测概率，计算交叉熵损失；步骤S6，利用随机梯度下降法进行增量训练：基于训练集对旧模型进行增量训练，根据包含分类损失与辅助损失的全局损失，利用随机梯度下降法，学习到未知类别样本和含有新特征值的已知类别样本，将所述未知类别样本转换为已知类别样本，得到更新后的新模型；步骤S7，未知缺陷类别范例集构建与已知缺陷类别范例集调整：基于新模型训练未知缺陷类别数据和已知缺陷类别数据，分别训练得到未知类别范例集和具有新特征的已知类别范例集，所述未知类别范例集、已知类别范例集和步骤S1中的范例集合并形成新范例集，用于下一阶段增量训练；步骤S8，特征提取器剪枝：计算新模型中的新增特征提取器各层的几何中心，基于所述几何中心剪枝该层的卷积核；步骤S9，实现缺陷检测模型持续优化更新：不断输入未知类别缺陷数据和已知类别缺陷数据，重复步骤S1到S8，持续更新旧模型，得到一个对当前未知类别、已知类别全局统一的缺陷检测网络，实现缺陷检测持续优化。2.根据权利要求1所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S1中，对于持续输入的缺陷数据进行优化检测，其中/＞，当/＞时，待更新模型为基础神经网络模型/＞，/＞由基础类别训练集/＞进行训练得到。3.根据权利要求2所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S2中，特征提取器基于多尺度残差网络构建。4.根据权利要求3所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S3中，所述辅助分类器以概率进行预测分类，表达式如下：；其中，表示/＞函数；/＞表示辅助分类器，其标签空间为，/＞表示未知类别的标签集合；/＞表示新特征；有关新特征的辅助损失的表达式如下：；其中，表示训练集；/＞表示图像；/＞表示对应类别标签。5.根据权利要求4所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S4中，通道与空间注意力机制具体是通道注意力子网络和空间注意力子网络，通过特征融合器得到精炼特征图的具体过程如下：通道注意力子网络通过和/＞压缩中间特征图/＞的空间维度，/＞的空间维度为/＞，生成两个特征向量/＞和/＞，其维度均为/＞，连接两个特征向量得到/＞，采用两个全卷积层对/＞进行处理，表达式如下：；；其中，表示每个通道的权重；/＞表示激活函数；第一个全卷积层的输出通道数为/＞，/＞表示缩减比率；第二个全卷积层/＞的卷积核大小为/＞，输出通道数为/＞；/＞表示通道特征；空间注意力子网络将通道特征作为输入，将沿通道轴的平均和最大操作应用于生成两个特征图，表达式如下：；；其中，和/＞分别表示通道轴中的元素平均和最大值操作；基于和/＞获得维度为/＞的空间注意力图/＞，表达式如下：；将空间注意力图和通道特征相乘得到精炼特征图，表达式如下：；其中，表示空间细化特征，即精炼特征图/＞。6.根据权利要求5所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S5中，预测概率的表达式如下：；其中，表示分类器；交叉熵损失的表达式如下：；其中，表示训练集；/＞表示图像；/＞表示对应类别标签。7.根据权利要求6所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S6中，全局损失的表达式如下：；其中，表示控制辅助分类器效果的超参数，对于初始模型，即/＞的时候，。8.根据权利要求7所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S7中，范例集更新方式具体如下：构建未知类别范例集，对未知类别数据集/＞随机采样得到初始的未知类别范例集/＞，使用模型/＞初始化中间模型/＞，并在/＞上训练/＞，通过随机梯度下降进行若干次迭代得到/＞，迭代过程如下：；其中，表示微调/＞的学习率，/＞表示交叉熵损失，/＞表示/＞的梯度；计算上的/＞的损失，并反向传播该验证损失以优化/＞，得到最终的未知类别样本范例集/＞，传播过程如下：；其中，表示未知类别范例集传播过程的学习速率，/＞表示交叉熵损失，/＞表示/＞的梯度；调整已知类别范例集，对已知类别数据集/＞随机采样得到/＞；其次，使用/＞初始化中间模型/＞，并在/＞上训练/＞，通过随机梯度下降进行若干次迭代得到/＞，迭代过程如下：；计算上的/＞的损失，并反向传播该验证损失以优化/＞，得到最终的具有新特征值的已知类别范例集/＞，传播过程如下：；其中，表示已知样本范例集传播过程的学习速率。9.根据权利要求8所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S8中，所述几何中心的表示如下：；；其中，表示/＞第/＞个卷积层的第/＞个卷积核，其维度为/＞，/＞和/＞分别表示第/＞个卷积层的输入通道数和输出通道数；当第/＞个卷积层的几何中心/＞位于第/＞个卷积层的卷积核中，满足下式：；其中，表示第/＞个卷积层中具有该层中几何中心/＞相同值的卷积核，即需要剪枝的卷积核，/＞表示/＞和/＞之差的二范数；通过公式计算得到第个卷积层中需要剪枝的卷积核，从而实现模型剪枝，表达式如下：；其中，表示第/＞个卷积层中具有该层中几何中心/＞相同或相似值的卷积核，即需要剪枝的卷积核，/＞表示/＞和/＞之差的二范数。10.根据权利要求9所述的太阳能电池缺陷检测持续优化方法，其特征在于，在步骤S9中，不断输入未知、已知类别缺陷数据，基于旧模型，依次施行特征提取器扩展、辅助分类器构建、特征融合器构建、分类器更新、利用随机梯度下降法进行增量训练、未知缺陷类别范例集构建与已知缺陷类别范例集调整、特征提取器剪枝步骤，得到一个对当前未知、已知类别全局统一的缺陷检测网络，实现缺陷检测持续优化；具体的检测过程如下：基于缺陷检测网络，对所有接收到的待检测太阳能电池图像/＞进行缺陷检测；首先，基于特征提取器/＞，将其提取的特征通过连接获得中间特征图/＞，；然后，按照步骤S3，经过特征融合器，将中间特征图变换为精炼特征图/＞，；；将精炼特征图发送到分类器/＞中预测得到该太阳能电池所属缺陷类别标签/＞，并根据此得到其所属缺陷类别，表达式如下：；。
说明书desc
技术领域本发明涉及计算机视觉技术领域，具体涉及一种基于增量学习的太阳能电池缺陷检测持续优化方法。背景技术在新能源和节能政策推动下，太阳能电池得到了大规模应用和生产。但制造工艺发生故障时将导致所生产电池具有一定缺陷，对生产过程中出现的缺陷进行检测分析并及时调整对应故障工艺可以减少损失，因此实现实时精准地检测发现电池片缺陷类别从而调整对应故障工艺是非常有必要的。批量生产太阳能电池的过程中，采集其缺陷数据，会发现缺陷数据呈长尾分布，部分类别的类别数较少但每个类别的样本量较多，尾部缺陷类则相反，从而导致包含所有缺陷类别的均衡数据集较难一次性获得，只能获得少量的缺陷类别数据集，其余缺陷类别暂时无法一次性学习到；受实际生产因素影响，缺陷表现形式可能发生变化，导致模型学习过的已知缺陷类别具有新特征值；制造工艺的调整也有可能导致新的缺陷类别产生。因此可以将少量的缺陷类别数据集作为基础类别训练集，训练一个基础神经网络模型，在保留旧知识的基础上，不断且分阶段地训练学习持续到来的未知缺陷类别数据以及含有新特征值的已知缺陷类别，以持续优化检测能力。当前太阳能电池的智能缺陷检测仍然采用传统的离线学习方式，其在训练阶段必须依赖于完整的数据集，且只能从无到有地训练一个模型，训练耗时长。离线学习方式在学习连续到来的新数据并进行模型持续优化时无法及时适应数据变化，因此运用于当前大规模、高维度、不断变化的数据集学习场景时，面临更新滞后和计算资源消耗大等问题。综上所述，为解决目前离线学习方法进行模型持续优化时计算资源消耗大和更新滞后的问题，急需一种基于增量学习的太阳能电池缺陷检测持续优化方法。发明内容本发明目的在于提供一种基于增量学习的太阳能电池缺陷检测持续优化方法，具体技术方案如下：一种基于增量学习的太阳能电池缺陷检测持续优化方法，包括如下步骤：步骤S1，缺陷数据持续输入：输入范例集和缺陷数据，所述范例集为旧数据集的子集，所述缺陷数据包括未知类别数据和含有新特征值的已知类别数据，范例集和缺陷数据的并集为训练集；步骤S2，特征提取器扩展：构建一个新特征提取器，并使用旧模型中特征提取器的参数对新特征提取器进行初始化，得到新增特征提取器；步骤S3，辅助分类器构建：构建辅助分类器，将所有已知类别数据作为一个类别进行处理，计算有关新特征的辅助损失；步骤S4，特征融合器构建：通过新增特征提取器从多个尺度提取太阳能电池图像的特征，将提取的所有特征连接起来，得到中间特征图，基于通道与空间注意力机制精炼中间特征图，输入中间特征图，依次推断一维注意力图和二维注意力图，通过特征融合器得到精炼特征图；步骤S5，分类器更新：从旧模型分类器中复制用于旧特征的参数构建当前阶段分类器，并按照当前阶段未知缺陷类别数量增加相应的全连接层节点，新增参数随机初始化，将精炼特征图发送到当前阶段分类器中得到预测概率，计算交叉熵损失；步骤S6，利用随机梯度下降法进行增量训练：基于训练集对旧模型进行增量训练，根据包含分类损失与辅助损失的全局损失，利用随机梯度下降法，学习到未知类别样本和含有新特征值的已知类别样本，将所述未知类别样本转换为已知类别样本，得到更新后的新模型；步骤S7，未知缺陷类别范例集构建与已知缺陷类别范例集调整：基于新模型训练未知缺陷类别数据和已知缺陷类别数据，分别训练得到未知类别范例集和具有新特征的已知类别范例集，所述未知类别范例集、已知类别范例集和步骤S1中的范例集合并形成新范例集，用于下一阶段增量训练；步骤S8，特征提取器剪枝：计算新模型中的新增特征提取器各层的几何中心，基于所述几何中心剪枝该层的卷积核；步骤S9，实现缺陷检测模型持续优化更新：不断输入未知类别缺陷数据和已知类别缺陷数据，重复步骤S1到S8，持续更新旧模型，得到一个对当前未知类别、已知类别全局统一的缺陷检测网络，实现缺陷检测持续优化。优选的，在步骤S1中，对于持续输入的缺陷数据进行优化检测，其中/＞，当时，待更新模型为基础神经网络模型/＞，/＞由基础类别训练集/＞进行训练得到。优选的，在步骤S2中，特征提取器基于多尺度残差网络构建。优选的，在步骤S3中，所述辅助分类器以概率进行预测分类，表达式如下：；其中，表示/＞函数；/＞表示辅助分类器，其标签空间为，/＞表示未知类别的标签集合；/＞表示新特征；有关新特征的辅助损失的表达式如下：；其中，表示训练集；/＞表示图像；/＞表示对应类别标签。优选的，在步骤S4中，通道与空间注意力机制具体是通道注意力子网络和空间注意力子网络，通过特征融合器得到精炼特征图的具体过程如下：通道注意力子网络通过和/＞压缩中间特征图/＞的空间维度，/＞的空间维度为/＞，生成两个特征向量/＞和/＞，其维度均为/＞，连接两个特征向量得到/＞，采用两个全卷积层对/＞进行处理，表达式如下：；；其中，表示每个通道的权重；/＞表示激活函数；第一个全卷积层的输出通道数为/＞，/＞表示缩减比率；第二个全卷积层/＞的卷积核大小为/＞，输出通道数为/＞；/＞表示通道特征；空间注意力子网络将通道特征作为输入，将沿通道轴的平均和最大操作应用于生成两个特征图，表达式如下：；；其中，和/＞分别表示通道轴中的元素平均和最大值操作；基于和/＞获得维度为/＞的空间注意力图/＞，表达式如下：；将空间注意力图和通道特征相乘得到精炼特征图，表达式如下：；其中，表示空间细化特征，即精炼特征图/＞。优选的，在步骤S5中，预测概率的表达式如下：；其中，表示分类器；交叉熵损失的表达式如下：；其中，表示训练集；/＞表示图像；/＞表示对应类别标签。优选的，在步骤S6中，全局损失的表达式如下：；其中，表示控制辅助分类器效果的超参数，对于初始模型，即/＞的时候，。优选的，在步骤S7中，范例集更新方式具体如下：构建未知类别范例集，对未知类别数据集/＞随机采样得到初始的未知类别范例集/＞，使用模型/＞初始化中间模型/＞，并在/＞上训练，通过随机梯度下降进行若干次迭代得到/＞，迭代过程如下：；其中，表示微调/＞的学习率，/＞表示交叉熵损失，/＞表示/＞的梯度；计算上的/＞的损失，并反向传播该验证损失以优化/＞，得到最终的未知类别样本范例集/＞，传播过程如下：；其中，表示未知类别范例集传播过程的学习速率，/＞表示交叉熵损失，/＞表示/＞的梯度；调整已知类别范例集，对已知类别数据集/＞随机采样得到/＞；其次，使用/＞初始化中间模型/＞，并在/＞上训练/＞，通过随机梯度下降进行若干次迭代得到/＞，迭代过程如下：；计算上的/＞的损失，并反向传播该验证损失以优化/＞，得到最终的具有新特征值的已知类别范例集/＞，传播过程如下：；其中，表示已知样本范例集传播过程的学习速率。优选的，在步骤S8中，所述几何中心的表示如下：；；其中，表示/＞第/＞个卷积层的第/＞个卷积核，其维度为/＞，/＞和/＞分别表示第/＞个卷积层的输入通道数和输出通道数；当第/＞个卷积层的几何中心/＞位于第/＞个卷积层的卷积核中，满足下式：；其中，表示第/＞个卷积层中具有该层中几何中心/＞相同值的卷积核，即需要剪枝的卷积核，/＞表示/＞和/＞之差的二范数；通过公式计算得到第个卷积层中需要剪枝的卷积核，从而实现模型剪枝，表达式如下：；其中，表示第/＞个卷积层中具有该层中几何中心/＞相同或相似值的卷积核，即需要剪枝的卷积核，/＞表示/＞和/＞之差的二范数。优选的，在步骤S9中，不断输入未知、已知类别缺陷数据，基于旧模型，依次施行特征提取器扩展、辅助分类器构建、特征融合器构建、分类器更新、利用随机梯度下降法进行增量训练、未知缺陷类别范例集构建与已知缺陷类别范例集调整、特征提取器剪枝步骤，得到一个对当前未知、已知类别全局统一的缺陷检测网络，实现缺陷检测持续优化；具体的检测过程如下：基于缺陷检测网络，对所有接收到的待检测太阳能电池图像/＞进行缺陷检测；首先，基于特征提取器/＞，将其提取的特征通过连接获得中间特征图/＞，；然后，按照步骤S3，经过特征融合器，将中间特征图变换为精炼特征图/＞，；；将精炼特征图发送到分类器/＞中预测得到该太阳能电池所属缺陷类别标签/＞，并根据此得到其所属缺陷类别，表达式如下：；。应用本发明的技术方案，具有以下有益效果：本发明公开的基于增量学习的太阳能电池缺陷检测持续优化方法，采用初始数据集即可启动网络学习过程，并只需在各阶段存储旧数据集极小规模范例集和输入训练集，有效地降低了存储与计算负荷。网络学习过程中，持续学习未知类别样本，实现了对所有缺陷类别的精准检测。在学习未知缺陷类别时，有效减轻了网络对已知缺陷类别的灾难性遗忘。并且针对已知缺陷类别可能出现的新的表现形式，实现了已知缺陷类别检测所需的更新。本发明中的动态特征提取器扩展、辅助分类器构建和特征融合器构建，针对未知类别的出现，为了实现模型稳定性与可塑性之间的平衡，在未知类别出现时，创建新的特征提取器，并使用旧的特征提取器的参数进行初始化，保留了已知类别的知识，同时也能有效地学习未知类别的特性。辅助分类器构建则用于训练新构建的特征提取器。特征融合器则有效地解决了增量学习中已知类别和未知类别之间可能产生的混淆问题。另外，本发明不仅针对未知类别的出现进行范例集构建，还考虑了具有新特征值的已知类别，在未知类别的出现和已知类别的变化时，动态地构建未知类别范例集和调整已知类别范例集。本发明还提出了特征提取器剪枝，在尽可能保持模型性能的同时实现大幅度的参数削减，降低了模型的存储和计算需求，提高了模型的实用性。除了上面所描述的目的、特征和优点之外，本发明还有其它的目的、特征和优点。下面将参照图，对本发明作进一步详细的说明。附图说明为了更清楚的说明本发明实施例或现有技术的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明优选实施例中太阳能电池缺陷检测持续优化方法的步骤流程图；图2是本发明优选实施例中未知类别范例集和已知类别范例集的更新流程图。具体实施方式本发明的核心是提供一种基于增量学习的太阳能电池缺陷检测持续优化方法。在现有技术中，太阳能电池的智能缺陷检测仍然采用传统的离线学习方式，其在训练阶段必须依赖于完整的数据集，且只能从无到有地训练一个模型，训练耗时长。从而离线学习方式在学习连续到来的新数据并进行模型持续优化时无法及时适应数据变化，因此运用于当前大规模、高维度、不断变化的数据集处理场景时，面临更新滞后和计算资源消耗大等问题。本发明公开的基于增量学习的太阳能电池缺陷检测持续优化方法，采用初始数据集即可启动网络学习过程，并只需在各阶段存储旧数据集极小规模范例集和输入训练集，有效地降低了存储与计算负荷。网络学习过程中，持续学习未知类别样本，实现了对所有缺陷类别的精准检测。在学习未知缺陷类别时，有效减轻了网络对已知缺陷类别的灾难性遗忘。并且针对已知缺陷类别可能出现的新的表现形式，实现了已知缺陷类别检测所需的更新。为了使本技术领域的人员更好地理解本发明方案，下面结合附图和具体实施方式对本发明作进一步的详细说明。显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例：请参考图1，图1为本发明优选实施例中太阳能电池缺陷检测持续优化方法的步骤流程图，其中步骤S1-S8为基于旧模型中的特征和已知类别数据更新模型，步骤S9为持续更新旧模型，从而实现一个模型持续优化更新的太阳能电池缺陷检测网络。参见图1，在本发明实施例中，太阳能电池缺陷检测持续优化方法包括如下步骤：步骤S1，缺陷数据持续输入：输入太阳能电池数据的范例集和缺陷数据，所述范例集为旧数据集的子集，所述缺陷数据包括未知类别数据和含有新特征值的已知类别数据，范例集和缺陷数据的并集为训练集；对于持续输入的缺陷数据进行分阶段的优化检测，其中/＞，当/＞时，待更新模型为基础神经网络模型/＞，/＞由基础类别训练集/＞进行训练得到。步骤S2，特征提取器扩展：构建一个新特征提取器，并使用所有的已有特征提取器的参数对新特征提取器进行初始化，得到新增特征提取器；特征提取器基于多尺度残差网络构建。在本实施例中，为了避免旧知识的灾难性遗忘并保持之前已经学习的知识，冻结当前所有特征提取器的参数。然后，为了更有效地适应未知类别的特征分布从而对未知缺陷类别进行更准确的检测，构建一个新的特征提取器/＞，并复制/＞的参数以初始化/＞。步骤S3，辅助分类器构建：构建辅助分类器，将所有已知类别数据作为一个类别进行处理，计算有关新特征的辅助损失；所述辅助分类器以概率进行预测分类，表达式如下：；其中，表示/＞函数；/＞表示辅助分类器，其标签空间为，/＞表示未知类别的标签集合；/＞表示新特征；有关新特征的辅助损失的表达式如下：；其中，表示训练集；/＞表示图像；/＞表示对应类别标签。步骤S4，特征融合器构建：通过新增特征提取器从多个尺度提取太阳能电池图像的特征，将提取的所有特征连接起来，得到中间特征图，基于通道与空间注意力机制输入中间特征图，特征融合器依次推断一维注意力图和二维注意力图，通过特征融合器得到精炼特征图；在本实施例中，通道与空间注意力机制具体是通道注意力子网络和空间注意力子网络，通过特征融合器得到精炼特征图的具体过程如下：通道注意力子网络通过和/＞压缩中间特征图/＞的空间维度，/＞的空间维度为/＞，生成两个特征向量/＞和/＞，其维度均为，连接两个特征向量得到/＞，采用两个全卷积层对/＞进行处理，表达式如下：；；其中，表示每个通道的权重；/＞表示激活函数；第一个全卷积层的输出通道数为/＞，/＞表示缩减比率；第二个全卷积层/＞的卷积核大小为/＞，输出通道数为/＞；/＞表示通道特征；空间注意力子网络将通道特征作为输入，将沿通道轴的平均和最大操作应用于生成两个特征图，表达式如下：；；其中，和/＞分别表示通道轴中的元素平均和最大值操作；基于和/＞获得维度为/＞的空间注意力图/＞，表达式如下：；将空间注意力图和通道特征相乘得到精炼特征图，表达式如下：；其中，表示空间细化特征，即精炼特征图/＞。步骤S5，分类器更新：从旧模型分类器中复制用于旧特征的参数构建新模型的分类器，并按照旧模型中的未知缺陷类别数量增加相应的全连接层节点，新增参数随机初始化，将精炼特征图发送到分类器中得到预测概率，计算交叉熵损失；具体的，预测概率的表达式如下：；其中，表示分类器；交叉熵损失的表达式如下：。步骤S6，利用随机梯度下降法进行增量训练：基于训练集对旧模型进行增量训练，根据包含分类损失与辅助损失的全局损失，利用随机梯度下降法，学习到未知类别样本和含有新特征值的已知类别样本，将所述未知类别样本转换为已知类别样本，得到更新后的新模型；具体的，在步骤S6中，全局损失的表达式如下：；其中，表示控制辅助分类器效果的超参数，对于初始模型，即/＞的时候，。步骤S7，未知缺陷类别范例集构建与已知缺陷类别范例集调整：基于新模型训练未知缺陷类别数据和已知缺陷类别数据，分别训练得到未知类别范例集和具有新特征的已知类别范例集，所述未知类别范例集、已知类别范例集和步骤S1中的范例集合并形成新范例集，用于新模型的增量训练；具体的，如图2所示，范例集更新方式具体如下：构建未知类别范例集，对未知类别数据集/＞随机采样得到未知类别范例集/＞，使用模型/＞初始化中间模型/＞，并在/＞上训练/＞，通过随机梯度下降进行若干次迭代得到/＞，迭代过程如下：；其中，表示微调/＞的学习率；计算上的/＞的损失，并反向传播上述验证损失以优化/＞，得到最终的未知类别样本范例集/＞，传播过程如下：；其中，表示未知类别范例集传播过程的学习速率；调整已知类别范例集，对新模型的已知类别数据集/＞随机采样得到/＞。其次，使用/＞初始化，得到中间模型/＞，并在/＞上训练/＞，通过随机梯度下降进行若干次迭代得到/＞，迭代过程如下：；计算上的/＞的损失，并反向传播该验证损失以优化/＞，得到最终的具有新特征值的已知类别范例集/＞，传播过程如下：；其中，表示已知样本范例集传播过程的学习速率。步骤S8，特征提取器剪枝：计算新模型中的新增特征提取器各层的几何中心，基于所述几何中心剪枝该层的卷积核；具体的，所述几何中心的表示如下：；；其中，表示/＞第/＞个卷积层的第/＞个卷积核，其维度为/＞，/＞和/＞分别表示第/＞个卷积层的输入通道数和输出通道数；当第/＞个卷积层的几何中心/＞位于第/＞个卷积层的卷积核中，满足下式：；其中，表示第/＞个卷积层中具有该层中几何中心/＞相同值的卷积核，即需要剪枝的卷积核，/＞表示/＞和/＞之差的二范数；通过公式计算得到第个卷积层中需要剪枝的卷积核，从而实现模型剪枝，表达式如下：；其中，表示第/＞个卷积层中具有该层中几何中心/＞相同或相似值的卷积核，即需要剪枝的卷积核，/＞表示/＞和/＞之差的二范数。需要说明的是，如果在同一层中，某些卷积核的值与该层的几何中心接近或相等，那么这些卷积核可以由该层的其他卷积核表示，剪枝这些卷积核对网络性能的影响很小，通过剪枝这些卷积核实现保持网络性能的同时，优化模型的存储需求并加速训练与预测。步骤S9，实现缺陷检测模型持续优化更新：不断输入未知类别缺陷数据和已知类别缺陷数据，重复步骤S1到S8，持续更新网络，得到一个对当前未知类别、已知类别全局统一的缺陷检测网络，实现缺陷检测持续优化。具体的，不断输入未知、已知类别缺陷数据，基于旧模型，依次施行特征提取器扩展、辅助分类器构建、特征融合器构建、分类器更新、利用随机梯度下降法进行增量训练、未知缺陷类别范例集构建与已知缺陷类别范例集调整、特征提取器剪枝步骤，得到一个对当前未知、已知类别全局统一的缺陷检测网络，从而实现缺陷检测持续优化；具体的检测过程如下：基于缺陷检测网络，对所有接收到的待检测太阳能电池图像/＞进行缺陷检测。首先，基于特征提取器/＞，将其提取的特征通过连接获得中间特征图/＞，；然后，按照步骤S3，经过特征融合器，将中间特征图变换为精炼特征图/＞，；；将精炼特征图发送到分类器/＞中预测得到该太阳能电池所属缺陷类别标签/＞，并根据此得到其所属缺陷类别，表达式如下：；。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
