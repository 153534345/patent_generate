标题title
一种邻近构造三维实体合并方法
摘要abst
本发明公开了一种邻近构造三维实体合并方法，所述方法包括：获取第一三维实体模型和第二三维实体模型，并进行分解，得到第一多边形集和第二多边形集，并根据第一多边形集中任一第一多边形在第二多边形集中进行相邻查找，得到与第一多边形相邻的相邻第二多边形；若第一多边形与第二三维实体模型非完全相交，则将第一多边形进行延伸处理，得到延伸多边形；将延伸多边形进行延伸处理得到延伸第一三维实体模型，并将延伸第一三维实体模型与第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型。本发明通过对不相交的柱状构件三维实体模型进行延伸合并，保证了当柱状构件三维实体模型之间存在不相交情况时三维实体模型的有效构建。
权利要求书clms
1.一种邻近构造三维实体合并方法，其特征在于，所述邻近构造三维实体合并方法包括：获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型和所述第二三维实体模型进行分解，得到第一多边形集和第二多边形集，并根据所述第一多边形集中任一第一多边形在所述第二多边形集中进行相邻查找，得到与所述第一多边形相邻的相邻第二多边形；若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形；根据所述延伸多边形对所述第一三维实体模型进行延伸处理，得到延伸第一三维实体模型，并将所述延伸第一三维实体模型与所述第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型。2.根据权利要求1所述的邻近构造三维实体合并方法，其特征在于，所述获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型和所述第二三维实体模型进行分解，得到第一多边形集和第二多边形集，并根据所述第一多边形集中任一第一多边形在所述第二多边形集中进行相邻查找，得到与所述第一多边形相邻的相邻第二多边形，具体包括：获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型进行分解，得到第一多边形集，并将所述第二三维实体模型进行分解，得到第二多边形集；获取所述第一多边形集中任一第一多边形以及获取所述第二多边形集中任一第二多边形，并根据所述第一多边形和所述第二多边形进行相邻计算，得到与所述第一多边形相邻的相邻第二多边形。3.根据权利要求2所述的邻近构造三维实体合并方法，其特征在于，所述根据所述第一多边形和所述第二多边形进行相邻计算，得到与所述第一多边形相邻的相邻第二多边形，具体包括：计算所述第一多边形与所述第二多边形之间的夹角和第一距离；当所述夹角小于预设夹角且所述第一距离小于预设距离时，获取所述第一多边形在所述第二多边形的平面上的投影多边形；当所述投影多边形与所述第二多边形相交时，判定所述第二多边形为所述第一多边形的相邻多边形，得到与所述第一多边形相邻的相邻第二多边形。4.根据权利要求3所述的邻近构造三维实体合并方法，其特征在于，所述当所述投影多边形与所述第二多边形相交时，判定所述第二多边形为所述第一多边形的相邻多边形，得到与所述第一多边形相邻的相邻第二多边形，之前还包括：对所述投影多边形和所述第二多边形进行相交判断，当所述投影多边形的任意一边与所述第二多边形相交时，则判定所述投影多边形与所述第二多边形相交；或当所述投影多边形的任意顶点处于所述第二多边形的范围内时，则判定所述投影多边形与所述第二多边形相交。5.根据权利要求3所述的邻近构造三维实体合并方法，其特征在于，所述当所述投影多边形与所述第二多边形相交时，判定所述第二多边形为所述第一多边形的相邻多边形，得到与所述第一多边形相邻的相邻第二多边形，之后还包括：当所述第一多边形对应存在多个所述相邻多边形时，计算所述第一多边形与多个所述相邻多边形之间的多个第二距离；获取多个所述第二距离中距离最小值对应的所述相邻多边形，并将距离最小值对应的所述相邻多边形作为所述第一多边形的相邻第二多边形。6.根据权利要求1所述的邻近构造三维实体合并方法，其特征在于，所述若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形，之前还包括：获取所述第一多边形的法线，并将所述第一多边形中的每个顶点沿所述法线生成射线；判断所述射线是否与所述相邻第二多边形的平面存在交点，若是，则判定所述第一多边形与所述第二三维实体模型非完全相交。7.根据权利要求6所述的邻近构造三维实体合并方法，其特征在于，所述若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形，具体包括：若所述第一多边形与所述第二三维实体模型非完全相交，则计算所述交点与多个所述顶点之间的多个第三距离，将所有第三距离生成距离集；获取所述距离集中的最大距离，并控制所述第一多边形中的每个顶点沿所述法线的方向延伸所述最大距离，得到所述第一多边形延伸后的所述延伸多边形。8.根据权利要求6所述的邻近构造三维实体合并方法，其特征在于，所述判断所述射线是否与所述相邻第二多边形的平面存在交点，之后还包括：若所述射线与所述相邻第二多边形的平面不存在交点，则判定所述第一多边形与所述第二三维实体模型完全相交。9.根据权利要求1所述的邻近构造三维实体合并方法，其特征在于，所述根据所述延伸多边形对所述第一三维实体模型进行延伸处理，得到延伸第一三维实体模型，并将所述延伸第一三维实体模型与所述第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型，具体包括：根据所述延伸多边形对应的坐标值对所述第一三维实体模型进行更新，得到所述第一三维实体模型延伸后的延伸第一三维实体模型；根据构造实体几何方法将所述第二三维实体模型与所述延伸第一三维实体模型进行合并，得到三维实体模型；对所述三维实体模型进行增量合并处理，得到三维实体建筑结构模型。10.根据权利要求9所述的邻近构造三维实体合并方法，其特征在于，所述对所述三维实体模型进行增量合并处理，得到三维实体建筑结构模型，具体包括：将所述三维实体模型与第一预设构件三维实体模型进行合并，得到增量三维实体模型；将所述增量三维实体模型与第二预设构件三维实体模型进行合并，得到所述三维实体建筑结构模型。
说明书desc
技术领域本发明涉及数据处理技术领域，尤其涉及一种邻近构造三维实体合并方法。背景技术随着“数字城市”、“数字建筑”等概念的提出，在虚拟空间内快速建立贴近真实城市建筑模型的需求越来越多。然而，要想快速建立实景三维数字城市模型，关键在于通过地籍测绘成果来获取城市内各个建筑的真实轮廓数据。地籍测绘成果中包含大量的二维矢量建筑物轮廓线数据，建筑物轮廓线通常可以表示建筑物的不同层数、不同结构性质以及主要房屋和附加房屋之间分割。现有技术中一般是通过绘制轮廓线进行拉伸后得到简单的柱状三维实体构件，并通过构造实体几何方法对多个柱状三维实体构件进行布尔合并构建复杂三维实体建筑结构。但是在实践过程发现由于存在测图误差，三维实体构件间可能存在间隙，三维实体构件间不一定相交的情况。当存在间隙时则无法进行有效的布尔相交合并，从而导致三维实体建筑结构无法进行构建。因此，现有技术还有待于改进和发展。发明内容本发明的主要目的在于提供一种邻近构造三维实体合并方法，旨在解决现有技术中当三维实体构件间存在间隙时无法进行有效的布尔相交合并，从而导致三维实体建筑结构无法进行构建。为实现上述目的，本发明提供一种邻近构造三维实体合并方法，所述邻近构造三维实体合并方法包括如下步骤：获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型和所述第二三维实体模型进行分解，得到第一多边形集和第二多边形集，并根据所述第一多边形集中任一第一多边形在所述第二多边形集中进行相邻查找，得到与所述第一多边形相邻的相邻第二多边形；若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形；根据所述延伸多边形对所述第一三维实体模型进行延伸处理，得到延伸第一三维实体模型，并将所述延伸第一三维实体模型与所述第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型。可选地，所述的邻近构造三维实体合并方法，其中，所述获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型和所述第二三维实体模型进行分解，得到第一多边形集和第二多边形集，并根据所述第一多边形集中任一第一多边形在所述第二多边形集中进行相邻查找，得到与所述第一多边形相邻的相邻第二多边形，具体包括：获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型进行分解，得到第一多边形集，并将所述第二三维实体模型进行分解，得到第二多边形集；获取所述第一多边形集中任一第一多边形以及获取所述第二多边形集中任一第二多边形，并根据所述第一多边形和所述第二多边形进行相邻计算，得到与所述第一多边形相邻的相邻第二多边形。可选地，所述的邻近构造三维实体合并方法，其中，所述根据所述第一多边形和所述第二多边形进行相邻计算，得到与所述第一多边形相邻的相邻第二多边形，具体包括：计算所述第一多边形与所述第二多边形之间的夹角和第一距离；当所述夹角小于预设夹角且所述第一距离小于预设距离时，获取所述第一多边形在所述第二多边形的平面上的投影多边形；当所述投影多边形与所述第二多边形相交时，判定所述第二多边形为所述第一多边形的相邻多边形，得到与所述第一多边形相邻的相邻第二多边形。可选地，所述的邻近构造三维实体合并方法，其中，所述当所述投影多边形与所述第二多边形相交时，判定所述第二多边形为所述第一多边形的相邻多边形，得到与所述第一多边形相邻的相邻第二多边形，之前还包括：对所述投影多边形和所述第二多边形进行相交判断，当所述投影多边形的任意一边与所述第二多边形相交时，则判定所述投影多边形与所述第二多边形相交；或当所述投影多边形的任意顶点处于所述第二多边形的范围内时，则判定所述投影多边形与所述第二多边形相交。可选地，所述的邻近构造三维实体合并方法，其中，所述当所述投影多边形与所述第二多边形相交时，判定所述第二多边形为所述第一多边形的相邻多边形，得到与所述第一多边形相邻的相邻第二多边形，之后还包括：当所述第一多边形对应存在多个所述相邻多边形时，计算所述第一多边形与多个所述相邻多边形之间的多个第二距离；获取多个所述第二距离中距离最小值对应的所述相邻多边形，并将距离最小值对应的所述相邻多边形作为所述第一多边形的相邻第二多边形。可选地，所述的邻近构造三维实体合并方法，其中，所述若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形，之前还包括：获取所述第一多边形的法线，并将所述第一多边形中的每个顶点沿所述法线生成射线；判断所述射线是否与所述相邻第二多边形的平面存在交点，若是，则判定所述第一多边形与所述第二三维实体模型非完全相交。可选地，所述的邻近构造三维实体合并方法，其中，所述若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形，具体包括：若所述第一多边形与所述第二三维实体模型非完全相交，则计算所述交点与多个所述顶点之间的多个第三距离，将所有第三距离生成距离集；获取所述距离集中的最大距离，并控制所述第一多边形中的每个顶点沿所述法线的方向延伸所述最大距离，得到所述第一多边形延伸后的所述延伸多边形。可选地，所述的邻近构造三维实体合并方法，其中，所述判断所述射线是否与所述相邻第二多边形的平面存在交点，之后还包括：若所述射线与所述相邻第二多边形的平面不存在交点，则判定所述第一多边形与所述第二三维实体模型完全相交。可选地，所述的邻近构造三维实体合并方法，其中，所述根据所述延伸多边形对所述第一三维实体模型进行延伸处理，得到延伸第一三维实体模型，并将所述延伸第一三维实体模型与所述第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型，具体包括：根据所述延伸多边形对应的坐标值对所述第一三维实体模型进行更新，得到所述第一三维实体模型延伸后的延伸第一三维实体模型；根据构造实体几何方法将所述第二三维实体模型与所述延伸第一三维实体模型进行合并，得到三维实体模型；对所述三维实体模型进行增量合并处理，得到三维实体建筑结构模型。可选地，所述的邻近构造三维实体合并方法，其中，所述对所述三维实体模型进行增量合并处理，得到三维实体建筑结构模型，具体包括：将所述三维实体模型与第一预设构件三维实体模型进行合并，得到增量三维实体模型；将所述增量三维实体模型与第二预设构件三维实体模型进行合并，得到所述三维实体建筑结构模型。本发明中，获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型和所述第二三维实体模型进行分解，得到第一多边形集和第二多边形集，并根据所述第一多边形集中任一第一多边形在所述第二多边形集中进行相邻查找，得到与所述第一多边形相邻的相邻第二多边形；若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形；根据所述延伸多边形对所述第一三维实体模型进行延伸处理，得到延伸第一三维实体模型，并将所述延伸第一三维实体模型与所述第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型。本发明通过将柱状构件三维实体模型进行分解，得到多个多边形集，并对多个多边形集进行邻近查找，得到相邻多边形；根据相邻多边形判断柱状构件三维实体模型之间是否存在不相交的情况，若是，则对柱状构件三维实体模型进行延伸处理以达到相交，并通过相交的柱状构件三维实体模型进行构件合并，得到合并三维实体模型，能够保证不相交柱状构件三维实体模型之间的构件合并，有利于三维实体模型的构建。附图说明图1是本发明邻近构造三维实体合并方法的较佳实施例的流程图；图2是本发明邻近构造三维实体合并方法的较佳实施例的整体流程示意图；图3是本发明邻近构造三维实体合并方法的较佳实施例的三维实体构件的示意图；图4是本发明邻近构造三维实体的合并系统的较佳实施例的三维实体建筑的示意图。具体实施方式为使本发明的目的、技术方案及优点更加清楚、明确，以下参照附图并举实施例对本发明进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。随着“数字城市”、“数字建筑”等概念的提出，在虚拟空间内快速建立贴近真实城市建筑模型的需求越来越多。然而，要想快速建立实景三维数字城市模型，关键在于通过地籍测绘成果来获取城市内各个建筑的真实轮廓数据。地籍测绘成果中包含大量的二维矢量建筑物轮廓线数据，建筑物轮廓线通常可以表示建筑物的不同层数、不同结构性质以及主要房屋和附加房屋之间分割。现有技术中一般是通过绘制轮廓线进行拉伸后得到简单的柱状三维实体构件，并通过构造实体几何方法对多个柱状三维实体构件进行布尔合并构建复杂三维实体建筑结构。但是在实践过程发现由于存在测图误差，三维实体构件间可能存在间隙，三维实体构件间不一定相交的情况。当存在间隙时则无法进行有效的布尔相交合并，从而导致三维实体建筑结构无法进行构建。本发明实现了一种三维实体构件邻近延伸相交方法，以延伸相交布尔合并的方式建模复杂的三维实体建筑结构。本发明较佳实施例所述的邻近构造三维实体合并方法，如图1和图2所示，所述邻近构造三维实体合并方法包括以下步骤：步骤S10、获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型和所述第二三维实体模型进行分解，得到第一多边形集和第二多边形集，并根据所述第一多边形集中任一第一多边形在所述第二多边形集中进行相邻查找，得到与所述第一多边形相邻的相邻第二多边形。具体地，获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型进行分解，得到第一多边形集，并将所述第二三维实体模型进行分解，得到第二多边形集。如图3所示，基础模型为S，S可以是单个柱状三维实体构件或经过多次布尔合并后得到的合并三维实体模型；构件模型为V，V是一个柱状三维实体构件，目标是将V合并到S得到结构化三维实体模型。首先将构件模型V分解为多边形集，基础模型S分解为多边形集/＞。获取所述第一多边形集中任一第一多边形以及获取所述第二多边形集中任一第二多边形，并计算所述第一多边形与所述第二多边形之间的夹角和第一距离；当所述夹角小于预设夹角且所述第一距离小于预设距离时，获取所述第一多边形在所述第二多边形的平面上的投影多边形。对所述投影多边形和所述第二多边形进行相交判断，当所述投影多边形的任意一边与所述第二多边形相交时，则判定所述投影多边形与所述第二多边形相交；或当所述投影多边形的任意顶点处于所述第二多边形的范围内时，则判定所述投影多边形与所述第二多边形相交。当所述投影多边形与所述第二多边形相交时，判定所述第二多边形为所述第一多边形的相邻多边形，得到与所述第一多边形相邻的相邻第二多边形。其中，所述第一多边形与所述相邻第二多边形为所述第一多边形集与所述第二多边形集中存在相邻关系的多边形；所述第一多边形属于所述第一多边形集，所述相邻第二多边形属于所述第二多边形集中与所述第一多边形存在相邻关系的多边形。计算构件模型V每个多边形的中心/＞、平面/＞、法线/＞，计算基础模型S每个多边形/＞的平面/＞、法线/＞。当多边形与/＞夹角小于5度与距离小于0.2米时，并且/＞在平面/＞上的投影与/＞相交时，判定/＞与/＞为相邻多边形。当所述第一多边形对应存在多个所述相邻多边形时，计算所述第一多边形与多个所述相邻多边形之间的多个第二距离；获取多个所述第二距离中距离最小值对应的所述相邻多边形，并将距离最小值对应的所述相邻多边形作为所述第一多边形的相邻第二多边形。当存在多个相邻/＞时只取距离最近的一个/＞。其中多边形夹角是指法线/＞与的夹角，其中，/＞是指多边形/＞的法线取反，/＞取反是因为相邻面法线相反。其中，/＞与/＞的距离是指/＞中心/＞到平面/＞的距离，用多边形中心到平面的距离近似表示两个平面距离。步骤S20、若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形。具体地，获取所述第一多边形的法线，并将所述第一多边形中的每个顶点沿所述法线生成射线；判断所述射线是否与所述相邻第二多边形的平面存在交点，若是，则判定所述第一多边形与所述第二三维实体模型非完全相交。若所述射线与所述相邻第二多边形的平面不存在交点，则判定所述第一多边形与所述第二三维实体模型完全相交。若所述第一多边形与所述第二三维实体模型非完全相交，则计算所述交点与多个所述顶点之间的多个第三距离，将所有第三距离生成距离集；获取所述距离集中的最大距离，并控制所述第一多边形中的每个顶点沿所述法线的方向延伸所述最大距离，得到所述第一多边形延伸后的所述延伸多边形。在确定与/＞为相邻多边形后，从/＞每个顶点沿法线/＞方向生成射线，求射线与相交交点，当不存在交点时说明已是完全相交，不需要进行延伸相交处理。当部分或全部存在交点时，求每个交点到射线起点的距离的集合/＞，求取集合/＞的最大值D，D即为延伸距离。将每个顶点沿/＞方向移动距离D，得到延伸后的多边形/＞。步骤S30、根据所述延伸多边形对所述第一三维实体模型进行延伸处理，得到延伸第一三维实体模型，并将所述延伸第一三维实体模型与所述第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型。具体地，根据所述延伸多边形对应的坐标值对所述第一三维实体模型进行更新，得到所述第一三维实体模型延伸后的延伸第一三维实体模型；根据构造实体几何方法将所述第二三维实体模型与所述延伸第一三维实体模型进行合并，得到三维实体模型；将所述三维实体模型与第一预设构件三维实体模型进行合并，得到增量三维实体模型；将所述增量三维实体模型与第二预设构件三维实体模型进行合并，得到所述三维实体建筑结构模型。如图4所示，将基础模型S与延伸处理后的构件模型通过构造实体几何方法进行合并提供布尔运算模块完成）得到合并的三维实体模型，并通过该方法对多个构件增量合并方式来建模复杂三维实体建筑结构，其中构造实体几何是指允许建模者通过使用布尔运算符组合更简单的对象来创建复杂的表面或对象，通过组合一些原始对象可能生成视觉上复杂的对象。常见的布尔运算有交集、并集和差集。交集是指两个几何对象重叠的部分，而并集是指两个几何对象合并的结果，差集则是指一个几何对象减去另一个几何对象后的剩余部分。除此之外，本发明中还可以设置内凹构件模型之间的合并建筑结构中还存在内凹构件，比如建筑结构中的内凹窗户，内凹构件不相交，也会存在布尔相交合并问题。内凹构件延伸合并方法与本发明外凸构件延伸合并不同地方有两点，一是在计算多边形夹角是指与/＞的夹角，不需要进行法线取反操作，二是在构建三维实体模型时是通过构造实体几何方法进行布尔相减。综上所述，本发明提供邻近构造三维实体合并方法，所述方法包括：获取第一三维实体模型和第二三维实体模型，将所述第一三维实体模型和所述第二三维实体模型进行分解，得到第一多边形集和第二多边形集，并根据所述第一多边形集中任一第一多边形在所述第二多边形集中进行相邻查找，得到与所述第一多边形相邻的相邻第二多边形；若所述第一多边形与所述第二三维实体模型非完全相交，则将所述第一多边形进行延伸处理，得到延伸多边形；根据所述延伸多边形对所述第一三维实体模型进行延伸处理，得到延伸第一三维实体模型，并将所述延伸第一三维实体模型与所述第二三维实体模型进行增量合并处理，得到三维实体建筑结构模型。本发明通过将柱状构件三维实体模型进行分解，得到多个多边形集，并对多个多边形集进行邻近查找，得到相邻多边形；根据相邻多边形判断柱状构件三维实体模型之间是否存在不相交的情况，若是，则对柱状构件三维实体模型进行延伸处理以达到相交，并通过相交的柱状构件三维实体模型进行构件合并，得到合并三维实体模型，能够保证不相交柱状构件三维实体模型之间的构件合并，有利于三维实体模型的构建。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者终端不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者终端所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者终端中还存在另外的相同要素。当然，本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关硬件来完成，所述的程序可存储于一计算机可读取的计算机可读存储介质中，所述程序在执行时可包括如上述各方法实施例的流程。其中所述的计算机可读存储介质可为存储器、磁碟、光盘等。应当理解的是，本发明的应用不限于上述的举例，对本领域普通技术人员来说，可以根据上述说明加以改进或变换，所有这些改进和变换都应属于本发明所附权利要求的保护范围。
