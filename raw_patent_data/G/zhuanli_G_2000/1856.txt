标题title
一种基于事件驱动的时限质控系统及方法
摘要abst
本申请提供了一种基于事件驱动的时限质控系统及方法，基于事件驱动架构，将时限质控涉及的临床业务定义为事件，该事件由业务代码在完成相应操作的同时触发消息中心以完成时限质控任务的生成和关闭，仅需要订阅消息中心对应消息主题，实现了低耦合、高内聚的模块化设计。同时，基于Quartz实现定时器的生成与关闭，简化了定时器的管理和调度，允许用户定义不同类型的时限质控任务，并在指定的时间点或间隔触发任务的执行；并且在增加其他业务场景下的时限质控任务规则时，无需修改任何时限质控模块代码，仅需修改业务系统的临床业务事件触发的埋点，订阅消息主题，并针对任务的基本属性进行配置，做到灵活便捷的扩展，让时限质控任务与业务系统解耦。
权利要求书clms
1.一种基于事件驱动的时限质控系统，其特征在于，包括消息中心、时限质控模块；所述消息中心模块包括生产者模块和消费者模块，所述生产者模块用于根据触发的临床业务事件构建对应的消息，并通过指定的事件编号作为消息主题将所述消息发送至Kafka集群，所述消息的入参包括与临床业务事件对应的事件名称、病历类型和临床业务属性；所述消费者模块用于根据订阅的消息主题从所述Kafka集群中获取消息，响应于获取到对应消息主题的消息后，启动新的工作线程以调用时限质控模块完成与所述临床业务事件对应的时限质控任务的生成或关闭；所述时限质控模块包括任务生成模块、任务关闭模块和 任务中心模块，所述任务生成模块用于对所述消息的入参进行合法性校验，并提取包括临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据所述时限质控任务规则构建任务主表，所述时限质控任务规则包括接收人配置、单次/连续配置、超时配置、关闭配置、提醒配置和触发配置；获取所述任务主表的接收人配置，基于所述消息的入参中临床业务属性包括的患者和医护人员信息进行动态替换，获取实际接收人列表，基于Quartz构建用于生成时限质控任务的相应定时器，当所述定时器符合对应触发条件时，调用任务中心，所述任务关闭模块用于对所述消息的入参进行合法性校验，并提取包括病历类型和临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据病历类型和所述临床业务属性包括的患者信息判断任务是否达到完成标准；响应于所述任务符合完成标准，对任务进行关闭操作，并根据完成的时间和情况对任务的状态进行更新，基于Quartz构建用于关闭时限质控任务的相应定时器，当所述定时器符合对应触发条件时，调用任务中心，所述任务中心用于控制时限质控任务的生成和关闭，响应于所述任务生成模块构建的定时器达到触发条件时，根据预设的任务生成配置模板和消息的入参，生成对应的时限质控任务，并且基于所述时限质控任务构建时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面；响应于所述任务关闭模块的定时器达到触发条件时，将根据患者信息预设的任务关闭配置模板获取符合条件的待关闭任务列表，并更新时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面。2.根据权利要求1所述的一种基于事件驱动的时限质控系统，其特征在于，所述生产者模块包括医院的HIS和EMR系统。3.根据权利要求1所述的一种基于事件驱动的时限质控系统，其特征在于，所述任务生成模块对所述消息的入参进行合法性校验包括基于XSD进行格式校验、根据消息包括的事件编号进行消息的查重校验和事件有效性的验证。4.根据权利要求3所述的一种基于事件驱动的时限质控系统，其特征在于，所述系统还包括实时推送模块，所述实时推送模块用于当所述任务生成模块生成对应任务后，将所述任务发送到用户界面并可视化展示；当所述任务关闭模块关闭对应任务后，将对应任务进行删除。5.根据权利要求3所述的一种基于事件驱动的时限质控系统，其特征在于，所述系统还包括任务看板模块，所述任务看板模块用于设置在用户界面，基于ifram嵌套的html页面进行所述时限质控任务细表的展示。6.根据权利要求3所述的一种基于事件驱动的时限质控系统，其特征在于，所述系统还包括质控统计模块，所述质控统计模块用于基于所述时限质控任务的处理情况进行报表的输出。7.根据权利要求3所述的一种基于事件驱动的时限质控系统，其特征在于，所述系统还包括评分判定模块，所述评分判定模块用于将用户预设的评分规则与所述时限质控任务规则进行绑定以对医护人员超时完成/超时未完成的时限质控任务规则进行评分。8.根据权利要求3所述的一种基于事件驱动的时限质控系统，其特征在于，所述系统还包括数据修正与定时补推模块，所述数据修正与定时补推模块用于当所述时限质控任务生成异常或关闭异常时，根据预设的异常处理规则，对所述时限质控任务进行重新生成操作或关闭，并且定时判断是否存在应生成但是没生成的，以进行对应时限质控任务的生成；定时判断是否存在应关闭但是没关闭的，以进行对应时限质控任务的关闭。9.根据权利要求3所述的一种基于事件驱动的时限质控系统，其特征在于，所述系统还包括定时规则配置模块，所述定时规则配置模块用于配置时限质控任务对应定时器的单次指定时间、连续固定时间和连续不规则频率的规则；针对时限质控任务的关闭配置包括对应临床业务事件根据组合Key互斥关闭。10.一种基于事件驱动的时限质控方法，其特征在于，包括：S1、基于触发的临床业务事件构建对应的消息，并通过指定的事件编号作为消息主题将所述消息发送至Kafka集群，所述消息的入参包括与临床业务事件对应的事件名称、病历类型和临床业务属性；S2、响应于获取到订阅的消息主题的消息后，启动新的工作线程以调用时限质控模块完成与所述临床业务事件对应的时限质控任务的生成或关闭；S3、响应于执行时限质控任务的生成，对所述消息的入参进行合法性校验，并提取包括临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据所述时限质控任务规则构建任务主表，所述时限质控任务规则包括接收人配置、单次/连续配置、超时配置、关闭配置、提醒配置和触发配置；获取所述任务主表的接收人配置，基于所述消息的入参中临床业务属性包括的患者和医护人员信息进行动态替换，获取实际接收人列表，基于Quartz构建用于生成时限质控任务的相应定时器；以及，响应于执行时限质控任务的关闭，对所述消息的入参进行合法性校验，并提取包括病历类型和临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据病历类型和所述临床业务属性包括的患者信息判断任务是否达到完成标准；响应于所述任务符合完成标准，对任务进行关闭操作，并根据完成的时间和情况对任务的状态进行更新，基于Quartz构建用于关闭时限质控任务的相应定时器；S4、响应于所述任务生成模块构建的定时器达到触发条件时，根据预设的任务生成配置模板和消息的入参，生成对应的时限质控任务，并且基于所述时限质控任务构建时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面；以及，响应于所述任务关闭模块的定时器达到触发条件时，将根据患者信息预设的任务关闭配置模板获取符合条件的待关闭任务列表，并更新时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面。
说明书desc
技术领域本申请涉及医疗服务技术领域，尤其是涉及一种基于事件驱动的时限质控系统及方法。背景技术现有的医院质控信息系统，要求医护人员在日常工作中，需按时完成相应的病历书写任务，同时必须遵循时效性上的要求，该任务的完成情况，通常也会被加入绩效考核评估结果。针对上述工作要求，从而衍生的功能模块也称为时限质控模块。时限质控主要是对针对入科、取消入科、转科、取消转科、出院、取消出院、病情变化、完成病历书写等业务场景，根据对应的病历类型是否完成书写任务，以及是否满足时效性要求，进行提醒、统计和评分。通过时限质控提醒，医护人员可以更直观的接收到病历的书写的时限，并在时限内完成病历，医务部则可以通过有无超时书写病历来进行质控评分。而传统的时限质控系统，通常采用“程序定时器轮询”或“数据库触发器”实现，两者在实现时限质控功能的同时，也都存在若干缺陷。其中，程序定时器轮询方式，通过定时服务不断轮询关键业务数据表，当查询到符合要求的数据则触发时限质控，该方式无论从配置和实现上看都不灵活，同时耗费服务资源，效率较低。数据库触发器方式，主要通过监听程序执行的DML语句以做出相应操作，但触发执行的逻辑功能比较单一，只适合于简单的场景，无法运行复杂程序。发明内容为了解决上述技术问题，本申请提供一种基于事件驱动的时限质控系统，包括消息中心、时限质控模块；所述消息中心模块包括生产者模块和消费者模块，所述生产者模块用于根据触发的临床业务事件构建对应的消息，并通过指定的事件编号作为消息主题将所述消息发送至Kafka集群，所述消息的入参包括与临床业务事件对应的事件名称、病历类型和临床业务属性；所述消费者模块用于根据订阅的消息主题从所述Kafka集群中获取消息，响应于获取到对应消息主题的消息后，启动新的工作线程以调用时限质控模块完成与所述临床业务事件对应的时限质控任务的生成或关闭；所述时限质控模块包括任务生成模块、任务关闭模块和 任务中心模块，所述任务生成模块用于对所述消息的入参进行合法性校验，并提取包括临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据所述时限质控任务规则构建任务主表，所述时限质控任务规则包括接收人配置、单次/连续配置、超时配置、关闭配置、提醒配置和触发配置；获取所述任务主表的接收人配置，基于所述消息的入参中临床业务属性包括的患者和医护人员信息进行动态替换，获取实际接收人列表，基于Quartz构建用于生成时限质控任务的相应定时器，当所述定时器符合对应触发条件时，调用任务中心，所述任务关闭模块用于对所述消息的入参进行合法性校验，并提取包括病历类型和临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据病历类型和所述临床业务属性包括的患者信息判断任务是否达到完成标准；响应于所述任务符合完成标准，对任务进行关闭操作，并根据完成的时间和情况对任务的状态进行更新，基于Quartz构建用于关闭时限质控任务的相应定时器，当所述定时器符合对应触发条件时，调用任务中心，所述任务中心用于控制时限质控任务的生成和关闭，响应于所述任务生成模块构建的定时器达到触发条件时，根据预设的任务生成配置模板和消息的入参，生成对应的时限质控任务，并且基于所述时限质控任务构建时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面；响应于所述任务关闭模块的定时器达到触发条件时，将根据患者信息预设的任务关闭配置模板获取符合条件的待关闭任务列表，并更新时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面。在一些具体的实施例中，生产者模块包括医院的HIS和EMR系统。在一些具体的实施例中，任务生成模块对所述消息的入参进行合法性校验包括基于XSD进行格式校验、根据消息包括的事件编号进行消息的查重校验和事件有效性的验证。在一些具体的实施例中，系统还包括实时推送模块，所述实时推送模块用于当所述任务生成模块生成对应任务后，将所述任务发送到用户界面并可视化展示；当所述任务关闭模块关闭对应任务后，将对应任务进行删除。在一些具体的实施例中，系统还包括任务看板模块，所述任务看板模块用于设置在用户界面，基于ifram嵌套的html页面进行所述时限质控任务细表的展示。该模块可以用于展示该用户未完成的时限任务。在一些具体的实施例中，系统还包括质控统计模块，所述质控统计模块用于基于所述时限质控任务的处理情况进行报表的输出。在一些具体的实施例中，系统还包括评分判定模块，所述评分判定模块用于将用户预设的评分规则与所述时限质控任务规则进行绑定以对医护人员超时完成/超时未完成的时限质控任务规则进行评分。时限质控的最终目的是为了规范医护人员的日常行为，引导其满足及时性要求，因此，通过通过评分判定模块对医护人员的绩效进行评分。在一些具体的实施例中，系统还包括数据修正与定时补推模块，所述数据修正与定时补推模块用于当所述时限质控任务生成异常或关闭异常时，根据预设的异常处理规则，对所述时限质控任务进行重新生成操作或关闭，并且定时判断是否存在应生成但是没生成的，以进行对应时限质控任务的生成；定时判断是否存在应关闭但是没关闭的，以进行对应时限质控任务的关闭。保障了当有配置错误或程序问题导致的任务提醒或关闭异常时进行修复。在一些具体的实施例中，系统还包括定时规则配置模块，所述定时规则配置模块用于配置时限质控任务对应定时器的单次指定时间、连续固定时间和连续不规则频率的规则；针对时限质控任务的关闭配置包括对应临床业务事件根据组合Key互斥关闭。根据本发明的第二方面，提出了一种基于事件驱动的时限质控方法，包括：S1、基于触发的临床业务事件构建对应的消息，并通过指定的事件编号作为消息主题将所述消息发送至Kafka集群，所述消息的入参包括与临床业务事件对应的事件名称、病历类型和临床业务属性；S2、响应于获取到订阅的消息主题的消息后，启动新的工作线程以调用时限质控模块完成与所述临床业务事件对应的时限质控任务的生成或关闭；S3、响应于执行时限质控任务的生成，对所述消息的入参进行合法性校验，并提取包括临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据所述时限质控任务规则构建任务主表，所述时限质控任务规则包括接收人配置、单次/连续配置、超时配置、关闭配置、提醒配置和触发配置；获取所述任务主表的接收人配置，基于所述消息的入参中临床业务属性包括的患者和医护人员信息进行动态替换，获取实际接收人列表，基于Quartz构建用于生成时限质控任务的相应定时器；以及，响应于执行时限质控任务的关闭，对所述消息的入参进行合法性校验，并提取包括病历类型和临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据病历类型和所述临床业务属性包括的患者信息判断任务是否达到完成标准；响应于所述任务符合完成标准，对任务进行关闭操作，并根据完成的时间和情况对任务的状态进行更新，基于Quartz构建用于关闭时限质控任务的相应定时器；S4、响应于所述任务生成模块构建的定时器达到触发条件时，根据预设的任务生成配置模板和消息的入参，生成对应的时限质控任务，并且基于所述时限质控任务构建时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面；以及，响应于所述任务关闭模块的定时器达到触发条件时，将根据患者信息预设的任务关闭配置模板获取符合条件的待关闭任务列表，并更新时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面。本发明提出了一种基于事件驱动的时限质控系统及方法，其技术效果在于：本申请基于事件驱动架构，将时限质控涉及的临床业务定义为事件，该事件由业务代码在完成相应操作的同时触发消息中心以完成时限质控任务的生成和关闭，仅需要订阅消息中心对应消息主题，实现了低耦合、高内聚的模块化设计。同时，基于Quartz实现定时器的生成与关闭，简化了定时器的管理和调度，允许用户定义不同类型的时限质控任务，并在指定的时间点或间隔触发任务的执行；并且在增加其他业务场景下的时限质控任务规则时，无需修改任何时限质控模块代码，仅需修改业务系统的临床业务事件触发的埋点，订阅消息主题，并针对任务的基本属性进行配置，做到灵活便捷的扩展，让时限质控任务与业务系统解耦。附图说明包括附图以提供对实施例的进一步理解并且附图被并入本说明书中并且构成本说明书的一部分。附图图示了实施例并且与描述一起用于解释本申请的原理。将容易认识到其它实施例和实施例的很多预期优点，因为通过引用以下详细描述，它们变得被更好地理解。附图的元件不一定是相互按照比例的。同样的附图标记指代对应的类似部件。图1是本申请的一个实施例的基于事件驱动的时限质控系统的框架图；图2是本申请的一个具体的实施例的时限质控任务生成的流程图；图3是本申请的一个具体的实施例的时限质控任务关闭的流程图；图4是本申请的一个实施例的基于事件驱动的时限质控方法的流程图。具体实施方式下面结合附图和实施例对本申请作进一步的详细说明。可以理解的是，此处所描述的具体实施例仅仅用于解释相关发明，而非对该发明的限定。另外还需要说明的是，为了便于描述，附图中仅示出了与有关发明相关的部分。需要说明的是，在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。下面将参考附图并结合实施例来详细说明本申请。图1是本申请的一个实施例的基于事件驱动的时限质控系统的框架图。参考图1，该系统包括消息中心、时限质控模块；所述消息中心模块包括生产者模块和消费者模块，所述生产者模块用于根据触发的临床业务事件构建对应的消息，并通过指定的事件编号作为消息主题将所述消息发送至Kafka集群，所述消息的入参包括与临床业务事件对应的事件名称、病历类型和临床业务属性；其中，基于Kafka + Zookeeper集群作为核心中间件，时限质控涉及的相关临床业务事件作为消息主题，生产者模块包括医院的HIS和EMR系统，消费者模块用于调用时限质控模块，整体采用Kafka的发布订阅模式。所述消费者模块用于根据订阅的消息主题从所述Kafka集群中获取消息，响应于获取到对应消息主题的消息后，启动新的工作线程以调用时限质控模块完成与所述临床业务事件对应的时限质控任务的生成或关闭；所述时限质控模块包括任务生成模块、任务关闭模块和 任务中心模块，所述任务生成模块用于对所述消息的入参进行合法性校验，并提取包括临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据所述时限质控任务规则构建任务主表，所述时限质控任务规则包括接收人配置、单次/连续配置、超时配置、关闭配置、提醒配置和触发配置；获取所述任务主表的接收人配置，基于所述消息的入参中临床业务属性包括的患者和医护人员信息进行动态替换，获取实际接收人列表，基于Quartz构建用于生成时限质控任务的相应定时器，当所述定时器符合对应触发条件时，调用任务中心，其中，任务生成模块对所述消息的入参进行合法性校验包括基于XSD进行格式校验、根据消息包括的事件编号进行消息的查重校验和事件有效性的验证。所述任务关闭模块用于对所述消息的入参进行合法性校验，并提取包括病历类型和临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据病历类型和所述临床业务属性包括的患者信息判断任务是否达到完成标准；响应于所述任务符合完成标准，对任务进行关闭操作，并根据完成的时间和情况对任务的状态进行更新，基于Quartz构建用于关闭时限质控任务的相应定时器，当所述定时器符合对应触发条件时，调用任务中心，所述任务中心用于控制时限质控任务的生成和关闭，响应于所述任务生成模块构建的定时器达到触发条件时，根据预设的任务生成配置模板和消息的入参，生成对应的时限质控任务，并且基于所述时限质控任务构建时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面；响应于所述任务关闭模块的定时器达到触发条件时，将根据患者信息预设的任务关闭配置模板获取符合条件的待关闭任务列表，并更新时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面。在一些具体的实施例中，所述系统还包括实时推送模块，所述实时推送模块用于当所述任务生成模块生成对应任务后，将所述任务发送到用户界面并可视化展示；当所述任务关闭模块关闭对应任务后，将对应任务进行删除。可以采用诸如WebSocket等的长连接推送模式，在浏览器和服务器完成一个握手的动作，在建立连接之后，服务器可以主动传送数据给客户端，客户端也可以随时向服务器发送数据。使用WebSocket等推送模式，要考虑其高可用性，建立完善的功能机制，包含但不限于如下：心跳机制、断网自动重连、消息补发机制、离线消息处理、历史消息查询、消息的压缩机制等。在一些具体的实施例中，所述系统还包括任务看板模块，所述任务看板模块用于设置在用户界面，基于ifram嵌套的html页面进行所述时限质控任务细表的展示。该模块可以用于展示该用户未完成的时限任务，例如：如XX患者，首次病程需在入院后8小时内完成，用户点击该任务，即可跳转到该病人的病历书写界面，进行病历的创建。当任务关闭的时候，前台界面收到推送消息，也可以在该组件针对该任务做出响应，例如：添加删除线效果。在一些具体的实施例中，所述系统还包括质控统计模块，所述质控统计模块用于基于所述时限质控任务的处理情况进行报表的输出。质控系统的时限质控统计模块，应该包含但不限于如下功能：按不同维度查询各类数据、导出各类报表、生成统计图表，针对质控情况进行评分，质控任务的闭环信息查看，以及对后续情况进行预测分析。统计页面的关键信息包含但不限于：时限任务的基本规则属性、参与人员、开始时间、完成的时间、超时完成/超时未完成的时间、任务完成状态等，方便质控员清晰地看出病历的整体书写情况。在一些具体的实施例中，所述系统还包括评分判定模块，所述评分判定模块用于将用户预设的评分规则与所述时限质控任务规则进行绑定以对医护人员超时完成/超时未完成的时限质控任务规则进行评分。时限质控的最终目的是为了规范医护人员的日常行为，引导其满足及时性要求，因此，通过通过评分判定模块对医护人员的绩效进行评分。在一些具体的实施例中，所述系统还包括数据修正与定时补推模块，所述数据修正与定时补推模块用于当所述时限质控任务生成异常或关闭异常时，根据预设的异常处理规则，对所述时限质控任务进行重新生成操作或关闭，并且定时判断是否存在应生成但是没生成的，以进行对应时限质控任务的生成；定时判断是否存在应关闭但是没关闭的，以进行对应时限质控任务的关闭。保障了当有配置错误或程序问题导致的任务提醒或关闭异常时进行修复。在一些具体的实施例中，系统还包括定时规则配置模块，所述定时规则配置模块用于配置时限质控任务对应定时器的单次指定时间、连续固定时间和连续不规则频率的规则；针对时限质控任务的关闭配置包括对应临床业务事件根据组合Key互斥关闭。作为示例，图2是本申请的一个具体的实施例的时限质控任务生成的流程图，图3是本申请的一个具体的实施例的时限质控任务关闭的流程图，参考图2和图3，关于“首次病程记录在入院8小时内完成”场景下的时限质控流程如下：1）护士为患者办理“入院登记”，该业务的后端接口，将在完成相应入院业务逻辑后，触发消息中心的“入院”事件；2）由于该“入院”事件，订阅了“时限质控任务生成”，当该事件对应消息主题，有消息产生时，消息中心的消费者模块将拉取相应消息，触发该时限质控模块对应的任务生成模块进行处理；3）该“时限质控任务生成”，会产生相应的病历文书的时限质控书写任务，其中包含“首次病程记录在入院8小时内完成”，同时利用消息的入参信息，查询到该患者的主管医生，通过WebSocket等实时推送机制，将产生的时限质控任务详情推送给指定医生前端系统，进而在该医生的工作桌面上，将接收到这一推送消息，在任务看板模块中，生成“首次病程记录在入院8小时内完成”任务；4）当该主管医生完成了该患者的首次病程记录的书写，在点击“确认完成”按钮的同时，将在完成相应书写任务完成的逻辑后，还将触发消息中心的“完成病历书写”事件；5）由于该“完成病历书写”事件，订阅了“时限质控任务关闭”，同样的，在该事件对应消息主题，有消息产生时，消息中心消费者将拉取相应消息，触发该时限质控模块对应的任务关闭模块进行处理；6）该“时限质控任务关闭”，将从消息的入参中，提取该份病历的患者基本信息、病历类型等元素，进而判断是否关闭已产生的病历书写任务，若符合关闭要求，则根据完成时间针对已产生任务做出时效性评价，同时，通过WebSocket等推送机制，将关闭任务的信息推送至指定医生的前端系统，做出相应处理，例如自动关闭该任务。在一个具体的实施例中，以下将对本申请的一种基于事件驱动的时限质控方法进行具体描述：本申请基于事件驱动架构，将时限质控涉及的临床业务定义为事件，该事件由业务代码在完成相应操作的同时触发消息中心以完成时限质控任务的生成和关闭，仅需要订阅消息中心对应消息主题，实现了低耦合、高内聚的模块化设计。同时，基于Quartz实现定时器的生成与关闭，简化了定时器的管理和调度，允许用户定义不同类型的时限质控任务，并在指定的时间点或间隔触发任务的执行；并且在增加其他业务场景下的时限质控任务规则时，无需修改任何时限质控模块代码，仅需修改业务系统的临床业务事件触发的埋点，订阅消息主题，并针对任务的基本属性进行配置，做到灵活便捷的扩展，让时限质控任务与业务系统解耦。图4是本申请的一个实施例的基于事件驱动的时限质控方法的流程图，参考图4，该实施例中公开的一种基于事件驱动的时限质控方法具体包括以下步骤：S1、基于触发的临床业务事件构建对应的消息，并通过指定的事件编号作为消息主题将所述消息发送至Kafka集群，所述消息的入参包括与临床业务事件对应的事件名称、病历类型和临床业务属性；S2、响应于获取到订阅的消息主题的消息后，启动新的工作线程以调用时限质控模块完成与所述临床业务事件对应的时限质控任务的生成或关闭；S3、响应于执行时限质控任务的生成，对所述消息的入参进行合法性校验，并提取包括临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据所述时限质控任务规则构建任务主表，所述时限质控任务规则包括接收人配置、单次/连续配置、超时配置、关闭配置、提醒配置和触发配置；获取所述任务主表的接收人配置，基于所述消息的入参中临床业务属性包括的患者和医护人员信息进行动态替换，获取实际接收人列表，基于Quartz构建用于生成时限质控任务的相应定时器；以及，响应于执行时限质控任务的关闭，对所述消息的入参进行合法性校验，并提取包括病历类型和临床业务属性的关键信息，根据所述订阅的消息主题获取对应时限质控任务规则，根据病历类型和所述临床业务属性包括的患者信息判断任务是否达到完成标准；响应于所述任务符合完成标准，对任务进行关闭操作，并根据完成的时间和情况对任务的状态进行更新，基于Quartz构建用于关闭时限质控任务的相应定时器；S4、响应于所述任务生成模块构建的定时器达到触发条件时，根据预设的任务生成配置模板和消息的入参，生成对应的时限质控任务，并且基于所述时限质控任务构建时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面；以及，响应于所述任务关闭模块的定时器达到触发条件时，将根据患者信息预设的任务关闭配置模板获取符合条件的待关闭任务列表，并更新时限质控任务细表数据，通过WebSocket将所述时限质控任务细表数据推送至用户界面。以上描述仅为本申请的较佳实施例以及对所运用技术原理的说明。本领域技术人员应当理解，本申请中所涉及的发明范围，并不限于上述技术特征的特定组合而成的技术方案，同时也应涵盖在不脱离上述发明构思的情况下，由上述技术特征或其等同特征进行任意组合而形成的其它技术方案。例如上述特征与本申请中公开的具有类似功能的技术特征进行互相替换而形成的技术方案。
