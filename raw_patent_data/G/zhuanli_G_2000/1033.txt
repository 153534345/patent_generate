标题title
可信分散控制系统上位机多节点数据在线同步方法及系统
摘要abst
本发明涉及工业自动化技术领域，公开了一种可信分散控制系统上位机多节点数据在线同步方法及系统，读取当前节点配置文件，获取当前节点配置文件的目录信息，同时获取系统内其他节点信息；根据目录信息初始化文件信息项列表；根据其他节点信息生成其他节点列表；创建文件同步线程和心跳线程，分别用于与其他节点列表中的节点进行定期文件同步及节点通讯连接心跳判断，开启以上线程，完成周期性数据同步及文件信息同步。本发明能够高效的完成周期性数据同步与更新。
权利要求书clms
1.可信分散控制系统上位机多节点数据在线同步方法，其特征在于，包括以下步骤：S1：读取当前节点配置文件，获取当前节点配置文件的目录信息，同时获取系统内其他节点信息；S2：根据S1中目录信息初始化文件信息项列表；根据其他节点信息生成其他节点列表；S3：创建文件同步线程和心跳线程，分别用于与S2中其他节点列表中的节点进行定期文件同步及节点通讯连接心跳判断，开启文件同步线程和心跳线程，完成周期性数据同步及文件信息同步。2.根据权利要求1所述的可信分散控制系统上位机多节点数据在线同步方法，其特征在于，所述S1中目录信息包括目录最大文件数、目录最大容量、容量超限百分比以及文件索引结构。3.根据权利要求1所述的可信分散控制系统上位机多节点数据在线同步方法，其特征在于，所述S2中文件信息项列表中的每一项称为文件信息项，每一项对应当前节点目录信息中一项文件；所述文件信息项用于存储文件在当前节点中的状态信息以及该文件在其他节点中的状态信息，所述状态信息包括：文件名、文件修改时间、文件大小、是否目录标志位、是否已删除标志位、他方修改时间列表、其他节点该文件大小列表、其他节点该文件是否已删除列表以及md5码；其中，他方修改时间列表存储其他节点列表中的每一个节点对该文件的最后修改时间；其他节点该文件大小列表、其他节点该文件是否已删除列表存储其他节点列表中每一个节点该文件的文件大小、是否已删除标志。4.根据权利要求3所述的可信分散控制系统上位机多节点数据在线同步方法，其特征在于，所述S3中心跳线程用于维护当前节点与其他节点通讯连接，进行节点间通讯链路中断时的重连及通讯链路连接状态判断，另外，心跳线程负责当前节点与可信安全服务器周期性身份认证及可信监控；所述当前节点与可信安全服务器周期性身份认证及可信监控具体为：可信安全服务器对当前节点进行身份鉴定及权限鉴定，并对其进行可信度量检查，以判断节点是否被篡改或破坏，若可信度量检查通过且身份鉴定及权限鉴定通过，则通讯继续，否则，发送可信报告并中断通信。5.根据权利要求3所述的可信分散控制系统上位机多节点数据在线同步方法，其特征在于，所述S3中文件同步线程进行定期文件同步，在定期文件同步过程中，发出同步请求的节点称为同步请求节点，接收请求的节点称为请求接收节点，具体包含以下步骤：S31：同步请求节点生成文件同步请求报文，并使用TPM进行加密，遍历其他节点列表，将文件同步请求报文逐一发送至其他节点；S32：请求接收节点接收并解密S31中的文件同步请求报文，遍历文件信息项列表，对文件信息项进行如下操作：若文件信息项中的文件修改时间晚于他方修改时间列表中对应的同步请求节点的修改时间，则表明请求接收节点中该文件为最新修改，则执行和；若文件信息项中是否已删除标志位为1则将该文件信息项加入已删除文件列表；若文件信息项中是否已删除标志位为0则将该文件信息项加入需更新文件列表；S33：请求接收节点将S32中已删除文件列表及需更新文件列表生成应答报文，经TPM加密后发送至同步请求节点；S34：同步请求节点接收S33中的请求接收节点发送的应答报文，经TPM解密，获取已删除文件列表及需更新文件列表；S35：同步请求节点遍历S34中的需更新文件列表，对于需更新文件列表中的每一个文件信息项进行如下操作：对于是否目录标志位为1的文件信息项：表示该文件信息项对应请求接收节点中的一项目录，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，表示该目录存在于请求接收节点，但同步请求节点缺少该目录，则以此文件信息项中的文件名在同步请求节点新建该目录，并生成对应的文件信息项加入同步请求节点的文件信息项列表；否则，根据需更新文件列表中文件信息项的信息更新同步请求节点的中对应的文件信息项，并更新同步请求节点中该目录；对于是否目录标志位为0的文件信息项：表示该文件信息项对应请求接收节点中的一项文件，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，或者同步请求节点的文件信息项中文件修改时间早于此文件信息项的文件修改时间，则通过ftp连接从请求接收节点拷贝文件信息项对应的文件至同步请求节点；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息；S36：同步请求节点遍历S34中的已删除文件列表，对于已删除文件列表中的每一个文件信息项进行如下操作：若该文件信息项的文件修改时间晚于同步请求节点的文件信息项的修改时间，则删除同步请求节点中文件并更新同步请求节点的文件信息项的信息；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息。6.可信分散控制系统上位机多节点数据在线同步系统，其特征在于，包括：信息获取模块：用于读取当前节点配置文件，获取当前节点配置文件的目录信息，同时获取系统内其他节点信息；列表生成模块：用于根据目录信息初始化文件信息项列表；根据其他节点信息生成其他节点列表；同步模块：用于创建文件同步线程和心跳线程，分别用于与列表生成模块中其他节点列表中的节点进行定期文件同步及节点通讯连接心跳判断，开启文件同步线程和心跳线程，完成周期性数据同步及文件信息同步。7.根据权利要求6所述的可信分散控制系统上位机多节点数据在线同步系统，其特征在于，所述信息获取模块中，目录信息包括目录最大文件数、目录最大容量、容量超限百分比以及文件索引结构。8.根据权利要求6所述的可信分散控制系统上位机多节点数据在线同步系统，其特征在于，所述列表生成模块中，文件信息项列表中的每一项称为文件信息项，每一项对应当前节点目录信息中一项文件；所述文件信息项用于存储文件在当前节点中的状态信息以及该文件在其他节点中的状态信息，所述状态信息包括：文件名、文件修改时间、文件大小、是否目录标志位、是否已删除标志位、他方修改时间列表、其他节点该文件大小列表、其他节点该文件是否已删除列表以及md5码；其中，他方修改时间列表存储其他节点列表中的每一个节点对该文件的最后修改时间；其他节点该文件大小列表、其他节点该文件是否已删除列表存储其他节点列表中每一个节点该文件的文件大小、是否已删除标志。9.根据权利要求8所述的可信分散控制系统上位机多节点数据在线同步系统，其特征在于，所述同步模块中心跳线程用于维护当前节点与其他节点通讯连接，进行节点间通讯链路中断时的重连及通讯链路连接状态判断，另外，心跳线程负责当前节点与可信安全服务器周期性身份认证及可信监控；所述当前节点与可信安全服务器周期性身份认证及可信监控具体为：可信安全服务器对当前节点进行身份鉴定及权限鉴定，并对其进行可信度量检查，以判断节点是否被篡改或破坏，若可信度量检查通过且身份鉴定及权限鉴定通过，则通讯继续，否则，发送可信报告并中断通信。10.根据权利要求8所述的可信分散控制系统上位机多节点数据在线同步系统，其特征在于，所述同步模块中，文件同步线程进行定期文件同步，在定期文件同步过程中，发出同步请求的节点称为同步请求节点，接收请求的节点称为请求接收节点，具体包含以下步骤：S31：同步请求节点生成文件同步请求报文，并使用TPM进行加密，遍历其他节点列表，将文件同步请求报文逐一发送至其他节点；S32：请求接收节点接收并解密S31中的文件同步请求报文，遍历文件信息项列表，对文件信息项进行如下操作：若文件信息项中的文件修改时间晚于他方修改时间列表中对应的同步请求节点的修改时间，则表明请求接收节点中该文件为最新修改，则执行和；若文件信息项中是否已删除标志位为1则将该文件信息项加入已删除文件列表；若文件信息项中是否已删除标志位为0则将该文件信息项加入需更新文件列表；S33：请求接收节点将S32中已删除文件列表及需更新文件列表生成应答报文，经TPM加密后发送至同步请求节点；S34：同步请求节点接收S33中的请求接收节点发送的应答报文，经TPM解密，获取已删除文件列表及需更新文件列表；S35：同步请求节点遍历S34中的需更新文件列表，对于需更新文件列表中的每一个文件信息项进行如下操作：对于是否目录标志位为1的文件信息项：表示该文件信息项对应请求接收节点中的一项目录，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，表示该目录存在于请求接收节点，但同步请求节点缺少该目录，则以此文件信息项中的文件名在同步请求节点新建该目录，并生成对应的文件信息项加入同步请求节点的文件信息项列表；否则，根据需更新文件列表中文件信息项的信息更新同步请求节点的中对应的文件信息项，并更新同步请求节点中该目录；对于是否目录标志位为0的文件信息项：表示该文件信息项对应请求接收节点中的一项文件，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，或者同步请求节点的文件信息项中文件修改时间早于此文件信息项的文件修改时间，则通过ftp连接从请求接收节点拷贝文件信息项对应的文件至同步请求节点；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息；S36：同步请求节点遍历S34中的已删除文件列表，对于已删除文件列表中的每一个文件信息项进行如下操作：若该文件信息项的文件修改时间晚于同步请求节点的文件信息项的修改时间，则删除同步请求节点中文件并更新同步请求节点的文件信息项的信息；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息。
说明书desc
技术领域本发明涉及工业自动化技术领域，具体涉及一种可信分散控制系统上位机多节点数据在线同步方法及系统。背景技术分散控制系统上位机具备多个控制节点，运行期间，多节点并行控制是极为常见的现象，因此保证各节点运行数据同步是控制命令正确下发的重要前提。现有分散控制系统上位机多采用主从结构，由一到两台节点担任主节点，只完成主节点间的文件同步，从节点可从主节点下载文件，文件同步机制较为简单，无法保证主从节点间的文件同步，可能导致从节点文件丢失或主从节点文件修改时间不一致等问题，影响运行人员画面监视质量及效果。发明内容本发明的目的在于提供一种可信分散控制系统上位机多节点数据在线同步方法及系统，以克服现有技术存在的缺陷，本发明能够高效的完成周期性数据同步与更新。为达到上述目的，本发明采用如下技术方案：可信分散控制系统上位机多节点数据在线同步方法，包括以下步骤：S1：读取当前节点配置文件，获取当前节点配置文件的目录信息，同时获取系统内其他节点信息；S2：根据S1中目录信息初始化文件信息项列表；根据其他节点信息生成其他节点列表；S3：创建文件同步线程和心跳线程，分别用于与S2中其他节点列表中的节点进行定期文件同步及节点通讯连接心跳判断，开启文件同步线程和心跳线程，完成周期性数据同步及文件信息同步。进一步地，所述S1中目录信息包括目录最大文件数、目录最大容量、容量超限百分比以及文件索引结构。进一步地，所述S2中文件信息项列表中的每一项称为文件信息项，每一项对应当前节点目录信息中一项文件；所述文件信息项用于存储文件在当前节点中的状态信息以及该文件在其他节点中的状态信息，所述状态信息包括：文件名、文件修改时间、文件大小、是否目录标志位、是否已删除标志位、他方修改时间列表、其他节点该文件大小列表、其他节点该文件是否已删除列表以及md5码；其中，他方修改时间列表存储其他节点列表中的每一个节点对该文件的最后修改时间；其他节点该文件大小列表、其他节点该文件是否已删除列表存储其他节点列表中每一个节点该文件的文件大小、是否已删除标志。进一步地，所述S3中心跳线程用于维护当前节点与其他节点通讯连接，进行节点间通讯链路中断时的重连及通讯链路连接状态判断，另外，心跳线程负责当前节点与可信安全服务器周期性身份认证及可信监控；所述当前节点与可信安全服务器周期性身份认证及可信监控具体为：可信安全服务器对当前节点进行身份鉴定及权限鉴定，并对其进行可信度量检查，以判断节点是否被篡改或破坏，若可信度量检查通过且身份鉴定及权限鉴定通过，则通讯继续，否则，发送可信报告并中断通信。进一步地，所述S3中文件同步线程进行定期文件同步，在定期文件同步过程中，发出同步请求的节点称为同步请求节点，接收请求的节点称为请求接收节点，具体包含以下步骤：S31：同步请求节点生成文件同步请求报文，并使用TPM进行加密，遍历其他节点列表，将文件同步请求报文逐一发送至其他节点；S32：请求接收节点接收并解密S31中的文件同步请求报文，遍历文件信息项列表，对文件信息项进行如下操作：若文件信息项中的文件修改时间晚于他方修改时间列表中对应的同步请求节点的修改时间，则表明请求接收节点中该文件为最新修改，则执行和；若文件信息项中是否已删除标志位为1则将该文件信息项加入已删除文件列表；若文件信息项中是否已删除标志位为0则将该文件信息项加入需更新文件列表；S33：请求接收节点将S32中已删除文件列表及需更新文件列表生成应答报文，经TPM加密后发送至同步请求节点；S34：同步请求节点接收S33中的请求接收节点发送的应答报文，经TPM解密，获取已删除文件列表及需更新文件列表；S35：同步请求节点遍历S34中的需更新文件列表，对于需更新文件列表中的每一个文件信息项进行如下操作：对于是否目录标志位为1的文件信息项：表示该文件信息项对应请求接收节点中的一项目录，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，表示该目录存在于请求接收节点，但同步请求节点缺少该目录，则以此文件信息项中的文件名在同步请求节点新建该目录，并生成对应的文件信息项加入同步请求节点的文件信息项列表；否则，根据需更新文件列表中文件信息项的信息更新同步请求节点的中对应的文件信息项，并更新同步请求节点中该目录；对于是否目录标志位为0的文件信息项：表示该文件信息项对应请求接收节点中的一项文件，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，或者同步请求节点的文件信息项中文件修改时间早于此文件信息项的文件修改时间，则通过ftp连接从请求接收节点拷贝文件信息项对应的文件至同步请求节点；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息；S36：同步请求节点遍历S34中的已删除文件列表，对于已删除文件列表中的每一个文件信息项进行如下操作：若该文件信息项的文件修改时间晚于同步请求节点的文件信息项的修改时间，则删除同步请求节点中文件并更新同步请求节点的文件信息项的信息；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息。可信分散控制系统上位机多节点数据在线同步系统，包括：信息获取模块：用于读取当前节点配置文件，获取当前节点配置文件的目录信息，同时获取系统内其他节点信息；列表生成模块：用于根据目录信息初始化文件信息项列表；根据其他节点信息生成其他节点列表；同步模块：用于创建文件同步线程和心跳线程，分别用于与列表生成模块中其他节点列表中的节点进行定期文件同步及节点通讯连接心跳判断，开启文件同步线程和心跳线程，完成周期性数据同步及文件信息同步。进一步地，所述信息获取模块中，目录信息包括目录最大文件数、目录最大容量、容量超限百分比以及文件索引结构。进一步地，所述列表生成模块中，文件信息项列表中的每一项称为文件信息项，每一项对应当前节点目录信息中一项文件；所述文件信息项用于存储文件在当前节点中的状态信息以及该文件在其他节点中的状态信息，所述状态信息包括：文件名、文件修改时间、文件大小、是否目录标志位、是否已删除标志位、他方修改时间列表、其他节点该文件大小列表、其他节点该文件是否已删除列表以及md5码；其中，他方修改时间列表存储其他节点列表中的每一个节点对该文件的最后修改时间；其他节点该文件大小列表、其他节点该文件是否已删除列表存储其他节点列表中每一个节点该文件的文件大小、是否已删除标志。进一步地，所述同步模块中心跳线程用于维护当前节点与其他节点通讯连接，进行节点间通讯链路中断时的重连及通讯链路连接状态判断，另外，心跳线程负责当前节点与可信安全服务器周期性身份认证及可信监控；所述当前节点与可信安全服务器周期性身份认证及可信监控具体为：可信安全服务器对当前节点进行身份鉴定及权限鉴定，并对其进行可信度量检查，以判断节点是否被篡改或破坏，若可信度量检查通过且身份鉴定及权限鉴定通过，则通讯继续，否则，发送可信报告并中断通信。进一步地，所述同步模块中，文件同步线程进行定期文件同步，在定期文件同步过程中，发出同步请求的节点称为同步请求节点，接收请求的节点称为请求接收节点，具体包含以下步骤：S31：同步请求节点生成文件同步请求报文，并使用TPM进行加密，遍历其他节点列表，将文件同步请求报文逐一发送至其他节点；S32：请求接收节点接收并解密S31中的文件同步请求报文，遍历文件信息项列表，对文件信息项进行如下操作：若文件信息项中的文件修改时间晚于他方修改时间列表中对应的同步请求节点的修改时间，则表明请求接收节点中该文件为最新修改，则执行和；若文件信息项中是否已删除标志位为1则将该文件信息项加入已删除文件列表；若文件信息项中是否已删除标志位为0则将该文件信息项加入需更新文件列表；S33：请求接收节点将S32中已删除文件列表及需更新文件列表生成应答报文，经TPM加密后发送至同步请求节点；S34：同步请求节点接收S33中的请求接收节点发送的应答报文，经TPM解密，获取已删除文件列表及需更新文件列表；S35：同步请求节点遍历S34中的需更新文件列表，对于需更新文件列表中的每一个文件信息项进行如下操作：对于是否目录标志位为1的文件信息项：表示该文件信息项对应请求接收节点中的一项目录，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，表示该目录存在于请求接收节点，但同步请求节点缺少该目录，则以此文件信息项中的文件名在同步请求节点新建该目录，并生成对应的文件信息项加入同步请求节点的文件信息项列表；否则，根据需更新文件列表中文件信息项的信息更新同步请求节点的中对应的文件信息项，并更新同步请求节点中该目录；对于是否目录标志位为0的文件信息项：表示该文件信息项对应请求接收节点中的一项文件，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，或者同步请求节点的文件信息项中文件修改时间早于此文件信息项的文件修改时间，则通过ftp连接从请求接收节点拷贝文件信息项对应的文件至同步请求节点；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息；S36：同步请求节点遍历S34中的已删除文件列表，对于已删除文件列表中的每一个文件信息项进行如下操作：若该文件信息项的文件修改时间晚于同步请求节点的文件信息项的修改时间，则删除同步请求节点中文件并更新同步请求节点的文件信息项的信息；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息。与现有技术相比，本发明具有以下有益的技术效果：本发明使用文件信息项列表及其他节点列表进行文件信息的快速索引以及其他节点中文件信息的对比更新，避免频繁访问文件的操作，提升文件信息对比及更新效率，降低内存资源消耗，实现高效的多节点数据在线同步。进一步地，通过配置可信安全服务器及可信计算模块，实现周期性可信验证，并提供可信通信链路，保证系统资源未被篡改、破坏及系统通信机密性，提升分散控制系统上位机安全防护能力。附图说明说明书附图用来提供对本发明的进一步理解，构成本发明的一部分，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。图1为本发明实施例一中分散控制系统上位机多节点数据在线同步方法的流程图；图2为本发明实施例二中分散控制系统上位机多节点数据在线同步系统的结构图。具体实施方式以下结合附图及具体实施例对本发明进行进一步详细说明。为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分的实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本发明保护的范围。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。实施例一参见图1，本发明提供一种可信分散控制系统上位机多节点数据在线同步方法，包括以下步骤：S1：读取当前节点配置文件，获取当前节点配置文件的目录信息，同时获取系统内其他节点信息；其中，目录信息包括目录最大文件数、目录最大容量、容量超限百分比以及文件索引结构。S2：根据S1中目录信息初始化文件信息项列表；根据其他节点信息生成其他节点列表；所述文件信息项列表中的每一项称为文件信息项，每一项对应当前节点目录信息中一项文件；所述文件信息项用于存储该文件在当前节点中的状态信息以及该文件在其他节点中的状态信息，所述状态信息包括：文件名、文件修改时间、文件大小、是否目录标志位、是否已删除标志位、他方修改时间列表、其他节点该文件大小列表、其他节点该文件是否已删除列表以及md5码；其中，他方修改时间列表存储其他节点列表中的每一个节点对该文件的最后修改时间；其他节点该文件大小列表、其他节点该文件是否已删除列表存储其他节点列表中每一个节点该文件的文件大小、是否已删除标志。S3：创建文件同步线程和心跳线程，分别用于与S2中其他节点列表中的节点进行定期文件同步及节点通讯连接心跳判断，开启文件同步线程和心跳线程，完成周期性数据同步及文件信息同步；所述心跳线程用于维护当前节点与其他节点通讯连接，进行节点间通讯链路中断时的重连及通讯链路连接状态判断，另外，心跳线程负责当前节点与可信安全服务器周期性身份认证及可信监控；所述当前节点与可信安全服务器周期性身份认证及可信监控具体为：可信安全服务器对当前节点进行身份鉴定及权限鉴定，并对其进行可信度量检查，以判断节点是否被篡改或破坏，若可信度量检查通过且身份鉴定及权限鉴定通过，则通讯继续，否则，发送可信报告并中断通信；所述文件同步线程进行定期文件同步，在定期文件同步过程中，发出同步请求的节点称为同步请求节点，接收请求的节点称为请求接收节点，具体包含以下步骤：S31：同步请求节点生成文件同步请求报文，并使用TPM进行加密，遍历其他节点列表，将文件同步请求报文逐一发送至其他节点；其中，TPM表示可信平台模块。S32：请求接收节点接收并解密S31中的文件同步请求报文，遍历文件信息项列表，对文件信息项进行如下操作：若文件信息项中的文件修改时间晚于他方修改时间列表中对应的同步请求节点的修改时间，则表明请求接收节点中该文件为最新修改，则执行和；若文件信息项中是否已删除标志位为1则将该文件信息项加入已删除文件列表；若文件信息项中是否已删除标志位为0则将该文件信息项加入需更新文件列表；S33：请求接收节点将S32中已删除文件列表及需更新文件列表生成应答报文，经TPM加密后发送至同步请求节点；S34：同步请求节点接收S33中的请求接收节点发送的应答报文，经TPM解密，获取已删除文件列表及需更新文件列表；S35：同步请求节点遍历S34中的需更新文件列表，对于需更新文件列表中的每一个文件信息项进行如下操作：对于是否目录标志位为1的文件信息项：表示该文件信息项对应请求接收节点中的一项目录，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，表示该目录存在于请求接收节点，但同步请求节点缺少该目录，则以此文件信息项中的文件名在同步请求节点新建该目录，并生成对应的文件信息项加入同步请求节点的文件信息项列表；否则，根据需更新文件列表中文件信息项的信息更新同步请求节点的中对应的文件信息项，并更新同步请求节点中该目录；对于是否目录标志位为0的文件信息项：表示该文件信息项对应请求接收节点中的一项文件，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，或者同步请求节点的文件信息项中文件修改时间早于此文件信息项的文件修改时间，则通过ftp连接从请求接收节点拷贝文件信息项对应的文件至同步请求节点；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息；S36：同步请求节点遍历S34中的已删除文件列表，对于已删除文件列表中的每一个文件信息项进行如下操作：若该文件信息项的文件修改时间晚于同步请求节点的文件信息项的修改时间，则删除同步请求节点中文件并更新同步请求节点的文件信息项的信息；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息。实施例二参见图2，本发明还提供一种可信分散控制系统上位机多节点数据在线同步系统，包括：信息获取模块：用于读取当前节点配置文件，获取当前节点配置文件的目录信息，同时获取系统内其他节点信息；所述目录信息包括目录最大文件数、目录最大容量、容量超限百分比以及文件索引结构。列表生成模块：用于根据目录信息初始化文件信息项列表；根据其他节点信息生成其他节点列表；所述文件信息项列表中的每一项称为文件信息项，每一项对应当前节点目录信息中一项文件；所述文件信息项用于存储该文件在当前节点中的状态信息以及该文件在其他节点中的状态信息，所述状态信息包括：文件名、文件修改时间、文件大小、是否目录标志位、是否已删除标志位、他方修改时间列表、其他节点该文件大小列表、其他节点该文件是否已删除列表以及md5码；其中，他方修改时间列表存储其他节点列表中的每一个节点对该文件的最后修改时间；其他节点该文件大小列表、其他节点该文件是否已删除列表存储其他节点列表中每一个节点该文件的文件大小、是否已删除标志。同步模块：用于创建文件同步线程和心跳线程，分别用于与列表生成模块中其他节点列表中的节点进行定期文件同步及节点通讯连接心跳判断，开启文件同步线程和心跳线程，完成周期性数据同步及文件信息同步。所述心跳线程用于维护当前节点与其他节点通讯连接，进行节点间通讯链路中断时的重连及通讯链路连接状态判断，另外，心跳线程负责当前节点与可信安全服务器周期性身份认证及可信监控；所述当前节点与可信安全服务器周期性身份认证及可信监控具体为：可信安全服务器对当前节点进行身份鉴定及权限鉴定，并对其进行可信度量检查，以判断节点是否被篡改或破坏，若可信度量检查通过且身份鉴定及权限鉴定通过，则通讯继续，否则，发送可信报告并中断通信；所述文件同步线程进行定期文件同步，在定期文件同步过程中，发出同步请求的节点称为同步请求节点，接收请求的节点称为请求接收节点，具体包含以下步骤：S31：同步请求节点生成文件同步请求报文，并使用TPM进行加密，遍历其他节点列表，将文件同步请求报文逐一发送至其他节点；S32：请求接收节点接收并解密S31中的文件同步请求报文，遍历文件信息项列表，对文件信息项进行如下操作：若文件信息项中的文件修改时间晚于他方修改时间列表中对应的同步请求节点的修改时间，则表明请求接收节点中该文件为最新修改，则执行和；若文件信息项中是否已删除标志位为1则将该文件信息项加入已删除文件列表；若文件信息项中是否已删除标志位为0则将该文件信息项加入需更新文件列表；S33：请求接收节点将S32中已删除文件列表及需更新文件列表生成应答报文，经TPM加密后发送至同步请求节点；S34：同步请求节点接收S33中的请求接收节点发送的应答报文，经TPM解密，获取已删除文件列表及需更新文件列表；S35：同步请求节点遍历S34中的需更新文件列表，对于需更新文件列表中的每一个文件信息项进行如下操作：对于是否目录标志位为1的文件信息项：表示该文件信息项对应请求接收节点中的一项目录，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，表示该目录存在于请求接收节点，但同步请求节点缺少该目录，则以此文件信息项中的文件名在同步请求节点新建该目录，并生成对应的文件信息项加入同步请求节点的文件信息项列表；否则，根据需更新文件列表中文件信息项的信息更新同步请求节点的中对应的文件信息项，并更新同步请求节点中该目录；对于是否目录标志位为0的文件信息项：表示该文件信息项对应请求接收节点中的一项文件，若同步请求节点的文件信息项列表未出现此文件信息项的文件名，或者同步请求节点的文件信息项中文件修改时间早于此文件信息项的文件修改时间，则通过ftp连接从请求接收节点拷贝文件信息项对应的文件至同步请求节点；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息；S36：同步请求节点遍历S34中的已删除文件列表，对于已删除文件列表中的每一个文件信息项进行如下操作：若该文件信息项的文件修改时间晚于同步请求节点的文件信息项的修改时间，则删除同步请求节点中文件并更新同步请求节点的文件信息项的信息；否则，同步请求节点生成文件信息同步报文发送至其他节点以同步最新文件信息。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明是参照根据本发明实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。最后应当说明的是：以上实施例仅用于说明本发明的技术方案而非对其保护范围的限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：本领域技术人员阅读本发明后依然可对发明的具体实施方式进行种种变更、修改或者等同替换，但这些变更、修改或者等同替换，均在发明待批的权利要求保护范围之内。
