标题title
一种用于可视对讲机的图像质量增强方法
摘要abst
本发明涉及图像数据处理技术领域，具体涉及一种用于可视对讲机的图像质量增强方法，包括：通过分析各灰度值在人脸图像中的数量占比以及对应像素点之间的距离关系获得灰度值对应的评判系数，根据评判系数的大小获得人脸图像的大气光值，将大气光值结合反映了人脸图像中细节部分的像素点在横向和纵向上的偏导结果，获得了像素点的保留参数，依据保留参数并结合暗通道先验去雾算法对人脸图像进行增强处理。本发明通过保留参数对暗通道先验去雾算法的透射率进行优化调节，在保留一定程度的雾气效果的情况下，大大提高了对人脸图像的图像增强效果，进一步增强了可视对讲机对大气光照环境的适应能力。
权利要求书clms
1.一种用于可视对讲机的图像质量增强方法，其特征在于，该方法包括以下步骤：利用可视对讲机获取人脸图像；根据人脸图像对应暗通道图像中部分灰度值最大的像素点获得灰度系数；根据人脸图像中任意灰度值对应像素点的数量获得灰度值的灰度占比参数，利用灰度占比参数以及灰度系数对任意灰度值进行调节获得灰度值的灰度参数；获取人脸图像中任意灰度值对应像素点之间的距离记为距离因子，利用灰度占比参数对距离因子的均值进行调节获得灰度值的距离参数；将距离参数和灰度参数的融合结果记为灰度值的评判系数，将最大评判系数对应的灰度值作为人脸图像的大气光值；获取人脸图像中任意像素点的一阶偏导和二阶偏导，将一阶偏导和二阶偏导的不同融合结果分别记为第一因子和第二因子，将第一因子和第二因子的差异记为像素点的曲率差分值，将曲率差分值和大气光值的融合结果记为像素点的保留参数；利用保留参数对透射率进行优化，并对人脸图像进行增强处理获得人脸图像对应的增强图像，完成可视对讲机的图像质量增强。2.根据权利要求1所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述根据人脸图像对应暗通道图像中部分灰度值最大的像素点获得灰度系数，包括的具体步骤如下：将人脸图像中所有像素点的数量记为第二数量，利用暗通道先验去雾算法获取人脸图像对应的暗通道图像，根据暗通道图像中的像素点获得像素点序列，获取像素点序列中前个第一像素点记为第二像素点，根据第二像素点在暗通道图像中的位置，获取同位置下第二像素点对应在人脸图像中的灰度值均值记为灰度系数，其中/＞表示预设的超参数，表示第二数量。3.根据权利要求2所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述像素点序列的获取方法如下：获取人脸图像对应暗通道图像中所有像素点记为第一像素点，按照灰度值从大到小的顺序将第一像素点进行排序获得像素点序列。4.根据权利要求2所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述根据人脸图像中任意灰度值对应像素点的数量获得灰度值的灰度占比参数，包括的具体步骤如下：获取任意灰度值在人脸图像中对应像素点的数量记为第一数量，将第一数量与第二数量的比值记为对应灰度值的灰度占比参数。5.根据权利要求1所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述利用灰度占比参数以及灰度系数对任意灰度值进行调节获得灰度值的灰度参数，包括的具体步骤如下：将任意灰度值作为以灰度系数为底数的对数函数的输入，将对数函数的输出记为第一输出，将灰度占比参数和第一输出的乘积结果记为灰度值的灰度参数。6.根据权利要求1所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述获取人脸图像中任意灰度值对应像素点之间的距离记为距离因子，利用灰度占比参数对距离因子的均值进行调节获得灰度值的距离参数，包括的具体步骤如下：首先，将人脸图像中任意灰度值对应所有像素点两两之间的欧氏距离记为灰度值的距离因子，并获取任意灰度值的所有像素点之间距离因子的均值；然后，将任意灰度值的灰度占比参数作为以自然常数为底数的指数函数的输入，将指数函数的输出记为第二输出，将第二输出与任意灰度值的所有像素点之间距离因子的均值的乘积结果记为灰度值的距离参数。7.根据权利要求1所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述将距离参数和灰度参数的融合结果记为灰度值的评判系数，包括的具体步骤如下：其中，表示人脸图像中灰度值/＞的评判系数；/＞表示人脸图像中灰度值为/＞的像素点之间的距离参数；/＞表示人脸图像中灰度值/＞的灰度参数；/＞表示以自然常数为底数的指数函数。8.根据权利要求1所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述获取人脸图像中任意像素点的一阶偏导和二阶偏导，将一阶偏导和二阶偏导的不同融合结果分别记为第一因子和第二因子，包括的具体步骤如下：首先，分别利用Sobel算子和拉普拉斯算子获取人脸图像中任意像素点在横向和纵向上的一阶偏导和二阶偏导；然后，第一因子和第二因子的具体计算方法为：其中，表示人脸图像中第/＞个像素点的第一因子；/＞表示人脸图像中第/＞个像素点的第二因子；/＞表示人脸图像中第/＞个像素点的横向一阶偏导；/＞表示人脸图像中第/＞个像素点的横向二阶偏导；/＞表示人脸图像中第/＞个像素点的纵向一阶偏导；/＞表示人脸图像中第/＞个像素点的纵向二阶偏导；/＞表示人脸图像中第/＞个像素点的交叉二阶偏导。9.根据权利要求7所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述将第一因子和第二因子的差异记为像素点的曲率差分值，将曲率差分值和大气光值的融合结果记为像素点的保留参数，包括的具体步骤如下：首先，将第一因子的绝对值与第二因子的绝对值之间的差值绝对值记为像素点的曲率差分值；然后，保留参数的具体计算方法为：其中，表示人脸图像中第/＞个像素点的保留参数；/＞表示人脸图像中第/＞个像素点的曲率差分值；/＞表示人脸图像的大气光值；/＞表示预设的超参数。10.根据权利要求1所述一种用于可视对讲机的图像质量增强方法，其特征在于，所述利用保留参数对透射率进行优化，并对人脸图像进行增强处理获得人脸图像对应的增强图像，完成可视对讲机的图像质量增强，包括的具体步骤如下：首先，将保留参数作为暗通道先验去雾算法的透射率中控制亮度增强的调整参数，获得优化后暗通道先验去雾算法；然后，利用优化后暗通道先验去雾算法对人脸图像进行增强获得增强图像，并将增强图像在可视对讲机的显示屏中进行可视化。
说明书desc
技术领域本发明涉及图像数据处理技术领域，具体涉及一种用于可视对讲机的图像质量增强方法。背景技术可视对讲机主要用于在公寓门口与室内进行交流，以便确认访客身份以控制进出，因此可视对讲机获得的人脸图像的图像质量对访客识别至关重要，随着数字技术的发展，数字化的可视对讲机的出现使得人脸图像的图像质量有了很大的提升，但是由于在室外复杂的大气环境下，使得光照发生难以预料的变化，进而导致可视对讲机的拍摄条件不够理想，当空气中雾气过大或强光照等情况下，导致可视对讲机获取的人脸图像质量差，从而影响户主对访客身份的确认。为了解决图像质量易受环境变化影响的问题，现有技术中通常采用暗通道先验去雾算法对可视对讲机拍摄的人脸图像直接进行去雾增强，但是实际应用过程中，一定浓度的雾气可以体现出人脸图像中的景深信息，因此需要通过参数调节的方法对人脸图像中的雾气进行一定程度的保留，以获得更好的视觉效果。发明内容本发明提供一种用于可视对讲机的图像质量增强方法，以解决现有的问题。本发明的一种用于可视对讲机的图像质量增强方法采用如下技术方案：本发明提供了一种用于可视对讲机的图像质量增强方法，该方法包括以下步骤：利用可视对讲机获取人脸图像；根据人脸图像对应暗通道图像中部分灰度值最大的像素点获得灰度系数；根据人脸图像中任意灰度值对应像素点的数量获得灰度值的灰度占比参数，利用灰度占比参数以及灰度系数对任意灰度值进行调节获得灰度值的灰度参数；获取人脸图像中任意灰度值对应像素点之间的距离记为距离因子，利用灰度占比参数对距离因子的均值进行调节获得灰度值的距离参数；将距离参数和灰度参数的融合结果记为灰度值的评判系数，将最大评判系数对应的灰度值作为人脸图像的大气光值；获取人脸图像中任意像素点的一阶偏导和二阶偏导，将一阶偏导和二阶偏导的不同融合结果分别记为第一因子和第二因子，将第一因子和第二因子的差异记为像素点的曲率差分值，将曲率差分值和大气光值的融合结果记为像素点的保留参数；利用保留参数对透射率进行优化，并对人脸图像进行增强处理获得人脸图像对应的增强图像，完成可视对讲机的图像质量增强。进一步的，所述根据人脸图像对应暗通道图像中部分灰度值最大的像素点获得灰度系数，包括的具体步骤如下：将人脸图像中所有像素点的数量记为第二数量，利用暗通道先验去雾算法获取人脸图像对应的暗通道图像，根据暗通道图像中的像素点获得像素点序列，获取像素点序列中前个第一像素点记为第二像素点，根据第二像素点在暗通道图像中的位置，获取同位置下第二像素点对应在人脸图像中的灰度值均值记为灰度系数，其中表示预设的超参数，表示第二数量。进一步的，所述像素点序列的获取方法如下：获取人脸图像对应暗通道图像中所有像素点记为第一像素点，按照灰度值从大到小的顺序将第一像素点进行排序获得像素点序列。进一步的，所述根据人脸图像中任意灰度值对应像素点的数量获得灰度值的灰度占比参数，包括的具体步骤如下：获取任意灰度值在人脸图像中对应像素点的数量记为第一数量，将第一数量与第二数量的比值记为对应灰度值的灰度占比参数。进一步的，所述利用灰度占比参数以及灰度系数对任意灰度值进行调节获得灰度值的灰度参数，包括的具体步骤如下：将任意灰度值作为以灰度系数为底数的对数函数的输入，将对数函数的输出记为第一输出，将灰度占比参数和第一输出的乘积结果记为灰度值的灰度参数。进一步的，所述获取人脸图像中任意灰度值对应像素点之间的距离记为距离因子，利用灰度占比参数对距离因子的均值进行调节获得灰度值的距离参数，包括的具体步骤如下：首先，将人脸图像中任意灰度值对应所有像素点两两之间的欧氏距离记为灰度值的距离因子，并获取任意灰度值的所有像素点之间距离因子的均值；然后，将任意灰度值的灰度占比参数作为以自然常数为底数的指数函数的输入，将指数函数的输出记为第二输出，将第二输出与任意灰度值的所有像素点之间距离因子的均值的乘积结果记为灰度值的距离参数。进一步的，所述将距离参数和灰度参数的融合结果记为灰度值的评判系数，包括的具体步骤如下：其中，表示人脸图像中灰度值的评判系数；表示人脸图像中灰度值为的像素点之间的距离参数；表示人脸图像中灰度值的灰度参数；表示以自然常数为底数的指数函数。进一步的，所述获取人脸图像中任意像素点的一阶偏导和二阶偏导，将一阶偏导和二阶偏导的不同融合结果分别记为第一因子和第二因子，包括的具体步骤如下：首先，分别利用Sobel算子和拉普拉斯算子获取人脸图像中任意像素点在横向和纵向上的一阶偏导和二阶偏导；然后，第一因子和第二因子的具体计算方法为：其中，表示人脸图像中第个像素点的第一因子；表示人脸图像中第个像素点的第二因子；表示人脸图像中第个像素点的横向一阶偏导；表示人脸图像中第个像素点的横向二阶偏导；表示人脸图像中第个像素点的纵向一阶偏导；表示人脸图像中第个像素点的纵向二阶偏导；表示人脸图像中第个像素点的交叉二阶偏导。进一步的，所述将第一因子和第二因子的差异记为像素点的曲率差分值，将曲率差分值和大气光值的融合结果记为像素点的保留参数，包括的具体步骤如下：首先，将第一因子的绝对值与第二因子的绝对值之间的差值绝对值记为像素点的曲率差分值；然后，保留参数的具体计算方法为：其中，表示人脸图像中第个像素点的保留参数；表示人脸图像中第个像素点的曲率差分值；表示人脸图像的大气光值；表示预设的超参数。进一步的，所述利用保留参数对透射率进行优化，并对人脸图像进行增强处理获得人脸图像对应的增强图像，完成可视对讲机的图像质量增强，包括的具体步骤如下：首先，将保留参数作为暗通道先验去雾算法的透射率中控制亮度增强的调整参数，获得优化后暗通道先验去雾算法；然后，利用优化后暗通道先验去雾算法对人脸图像进行增强获得增强图像，并将增强图像在可视对讲机的显示屏中进行可视化。本发明的技术方案的有益效果是：通过分析各灰度值在人脸图像中的数量占比以及对应像素点之间的距离关系获得灰度值对应的评判系数，根据评判系数的大小获得人脸图像的大气光值，将大气光值结合反映了人脸图像中细节部分的像素点在横向和纵向上的偏导结果，获得了像素点的保留参数，通过保留参数对暗通道先验去雾算法的透射率进行优化调节，在保留一定程度的雾气效果的情况下，大大提高了对人脸图像的图像增强效果，进一步增强了可视对讲机对大气光照环境的适应能力。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一种用于可视对讲机的图像质量增强方法的步骤流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种用于可视对讲机的图像质量增强方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种用于可视对讲机的图像质量增强方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种用于可视对讲机的图像质量增强方法的步骤流程图，该方法包括以下步骤：步骤S001，利用可视对讲机获取人脸图像并进行预处理。首先，通过可视化对讲机拍摄对讲人的图像，记为第一图像；在拍摄过程过难免会存在噪声影响导致图像质量降低，使得后续对第一图像的各种参数进行分析时出现误差，因此为了减少噪声对第一图像的影响，需要进行去噪处理；然后，利用高斯滤波算法对采集到的第一图像进行去噪处理，获得第二图像；最后，为了便于后续对第二图像进行分析，需要对第二图像进行灰度化处理，获得灰度化后的第二图像，记为人脸图像。至此，获得人脸图像。步骤S002，根据人脸图像中不同灰度级对应像素点数量以及像素点之间的距离获得评判系数，根据评判系数的大小获得人脸图像的大气光值。暗通道先验去雾算法是以大气散射模型为基础推理计算的，因此如果想要获得无雾图像就必须估算出暗通道先验去雾算法的大气光值A。在图像中雾浓度越低，对应的暗通道图像越暗，雾浓度越高对应的暗通道图像越亮，像素点值越大，因此暗通道图可以较好的反映雾浓度信息。对于对讲机捕捉到的人脸图像来进行分析，人脸图像中的主要部分是对讲人的人脸部分，只有除人脸之外的背景区域才可以捕捉到大气光值，但是因为背景部分可能会出现复杂的光线干扰，因此仅仅依靠灰度值来获取大气光值A容易出现误差，对于人脸图像中的部分白色区域，人脸图像中的最亮区域可能不是天空所对应的区域而是所述的白色区域，而该白色区域有可能是因为过度曝光引起的，容易导致大气光值A的估算错误。由于天空区域或者雾气区域是连续的，并且在人脸图像中也会占用较大的区域，为了能够更加准确的预测出大气光值，可以通过结合亮度以及与之相对应区域的面积来进行综合评判。当人脸图像中存在部分区域的亮度高、区域相对大且分布离散时，可以判定所述区域为天空区域或雾气区域，并将所述区域的整体灰度作为暗通道先验去雾算法的大气光值A。首先，获取任意灰度值在人脸图像中对应像素点的数量记为第一数量，将人脸图像中所有像素点的数量记为第二数量，将第一数量与第二数量的比值记为对应灰度值的灰度占比参数；将人脸图像中任意灰度值对应所有像素点两两之间的欧氏距离记为灰度值的距离因子，获取任意灰度值的所有距离因子的均值；然后，利用暗通道先验去雾算法获取人脸图像对应的暗通道图像，获取人脸图像对应暗通道图像中所有像素点记为第一像素点，第一像素点的数量与第二数量相同；按照灰度值从大到小的顺序将第一像素点进行排序获得像素点序列，获取前个第一像素点记为第二像素点，根据第二像素点在暗通道图像中的位置，获取同位置下第二像素点对应在人脸图像中的灰度值均值记为灰度系数，其中表示预设的超参数，表示第二数量；需要说明的是，根据经验预设超参数为0.1%，可根据实际情况进行调整，本实施例不作具体限定。其次，根据灰度系数、灰度占比参数、距离因子的均值获取灰度值的评判系数，具体计算方法为：其中，表示灰度值的评判系数；表示灰度值为的像素点之间的距离参数；表示灰度值的灰度参数；表示以自然常数为底数的指数函数；表示灰度值的灰度占比参数；表示灰度值；表示灰度系数；表示灰度值的所有距离因子的均值；因为进行计算的可视对讲机拍摄图像区域是已经通过暗通道图像筛选出来的高亮度区域灰度值都很高，因此灰度值的高低在评判系数中反而变得不太重要，因此通过对数函数来进行抑制，同时以灰度值的平均值为底进一步抑制了灰度值相对比较低的点。通过灰度值的数量与之相乘，可以进一步筛选出比例大并且灰度值相对较高的点。并且大气光值的像素点分布是比较均匀的，因此需要计算每个灰度级像素点之间的位置关系是否离散，通过两两计算像素点之间的距离，得到该灰度级像素点之间的平均距离，并且每个灰度级数量的不同，也会影响最后离散程度的结果，如果某个灰度级的像素点数量很少，那么只有保持更大的平均距离才能说明像素点之间足够离散，因此在相同的平均距离下，所占数量比例越少的灰度级距离参数越小。但是无论是距离参数还是灰度参数都应保持在一定的范围内才会有更好的效果，如果距离参数过近，说明像素点过于集中，那么就有可能是局部曝光所带来的，会降低相应的评判系数，如果距离参数过远，说明像素点过于分散联系性过于弱，也会降低相应的评判系数，因此评判系数的分布应该符合高斯分布；最后，根据人脸图像中所有像素点的灰度参数和距离参数获得所有灰度值对应的评判系数，将最大评判系数对应的灰度值作为人脸图像的大气光值A。至此，获得人脸图像的大气光值。步骤S003，根据人脸图像中像素点的偏导获得第一因子和第二因子，根据第一因子和第二因子对应的曲率差分结合大气光值获得保留参数。由于空气中存在粉尘杂质，因此人眼视觉中通常会存在一层淡淡的薄雾，为了符合人眼通常的视觉效果，使强化后的人脸图像更加的真实，故本实施例通过添加保留常数因子来将图像中的雾气保留一部分。另外，由于可视对讲机是实时获取人脸图像的，因此人脸图像所对应的大气光值会发生变化，因此不能设置固定的参数来对人脸图像中的雾气进行保留。当人脸图像中的大气光值大时，此时人脸图像较明亮，可视效果也比较好，因此可以保留更多的雾气，相反，如果人脸图像中的大气光值低时，则人脸图像的亮度比较暗，需要保留部分反映亮度的大气光值来保证图像的可视性。利用现有的差分曲率算法来计算人脸图像中的细节，细节越多说明雾气浓度不高，因此需要多保留一些雾气，反之则需要少保留雾气。为了自适应调节对人脸图像中亮度和细节的保留程度，本实施例根据人脸图像中像素点的偏导获得像素点的保留参数，具体获取方法为：首先，分别利用Sobel算子和拉普拉斯算子获取人脸图像中任意像素点在横向和纵向上的一阶偏导和二阶偏导；根据像素点的一阶偏导和二阶偏导分别获得第一因子和第二因子，具体计算方法为：其中，表示人脸图像中第个像素点的第一因子；表示人脸图像中第个像素点的第二因子；表示人脸图像中第个像素点的横向一阶偏导；表示人脸图像中第个像素点的横向二阶偏导；表示人脸图像中第个像素点的纵向一阶偏导；表示人脸图像中第个像素点的纵向二阶偏导；表示人脸图像中第个像素点的交叉二阶偏导；需要说明的是，Sobel算子和拉普拉斯算子为现有的图像处理算子，因此本实施例不过多赘述，另外Sobel算子的中文名称为索贝尔算子。然后，将第一因子的绝对值与第二因子的绝对值之间的差值绝对值记为像素点的曲率差分值；根据大气光值和曲率差分值获得像素点的保留参数，具体计算方法为：其中，表示人脸图像中第个像素点的保留参数；表示人脸图像中第个像素点的曲率差分值；表示人脸图像的大气光值；表示预设的超参数；表示以自然常数为底数的指数函数。需要说明的是，根据经验预设超参数为0.9，可根据实际情况进行调整，本实施例不作具体限定。曲率差分的结果反映人脸图像中像素点的细节信息，曲率差分值越大细节越丰富。保留参数受大气光值和曲率差分值的影响，大气光值越大，人脸图像的亮度越高；亮度越高，保留参数就越小，人脸图像中的细节越丰富则保留的雾就越多，而保留参数越大，保留的雾越少，由于雾的浓度可以体现出景深，因此需要保留一定程度的雾，因此保留参数不能太小，本实施例通过预设超参数，控制保留参数的取值范围在内。至此，获得像素点的保留参数。步骤S004，利用保留参数对暗通道先验去雾算法进行优化，并对人脸图像进行增强，获得增强图像。首先，将保留参数作为暗通道先验去雾算法的透射率中控制亮度增强的调整参数，实现根据人脸图像中的相关特征对暗通道先验去雾算法进行优化，获得优化后暗通道先验去雾算法；然后，利用优化后暗通道先验去雾算法对人脸图像进行增强，获得增强图像，并将增强图像在可视对讲机的显示屏中进行可视化。需要说明的是，本实施例中所用的模型仅用于表示负相关关系和约束模型输出的结果处于区间内，具体实施时，可替换成具有同样目的的其他模型，本实施例只是以模型为例进行叙述，不对其做具体限定，其中是指该模型的输入。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
