标题title
一种顾及NWP的海上区域CORS增强PPP方法
摘要abst
本发明属于海上定位技术领域，公开了一种顾及NWP的海上区域CORS增强PPP方法，其包括如下步骤：获取NWP再分析资料，使用分层积分法反演ZTD；进行虚拟参考站选址；使用多因子约束下的NWP反演ZTD的残差改正方法，计算NWP反演的虚拟参考站的ZTD与区域CORS的ZTD之间存在的系统误差，将该系统误差与NWP反演的虚拟参考站ZTD相加，得到改正后的虚拟参考站的ZTD；利用改正后的虚拟参考站的ZTD和区域CORS提供的ZTD进行内插得到流动站ZTD，并代入增强PPP数学模型中进行求解，得到定位结果。本发明利于缩短PPP的收敛时间，提高其定位精度。
权利要求书clms
1.一种顾及NWP的海上区域CORS增强PPP方法，其特征在于，包括如下步骤：步骤1. 获取NWP再分析资料；步骤2. 利用NWP再分析资料使用分层积分法反演ZTD；步骤3. 虚拟参考站选址；步骤4. 使用多因子约束下的NWP反演ZTD的残差改正方法，计算NWP反演的ZTD与区域CORS的ZTD之间存在的系统误差；将系统误差与NWP反演的ZTD相加，得到改正后的NWP虚拟参考站的ZTD；步骤5. 依据空间回归模型，利用改正后的NWP虚拟参考站的ZTD和区域CORS提供的ZTD进行内插，得到流动站ZTD；步骤6. 将流动站的ZTD代入增强PPP数学模型中进行求解，得到定位结果。2.根据权利要求1所述的顾及NWP的海上区域CORS增强PPP方法，其特征在于，所述步骤2中，反演ZTD的公式如下：；式中，ZTD、ZHD、ZWD分别表示天顶对流层总延迟、天顶干延迟和天顶湿延迟；a为测站高度处最底层等压面，b为测站高度处最顶层等压面，i∈；ΔNi为第i与i+1层间的大气折射率，ΔNdry,i为第i与i+1层间的干延迟对应的大气折射率，ΔNwet,i为第i与i+1层间的湿延迟对应的大气折射率，ΔSi为第i与i+1层之间的距离差。3.根据权利要求2所述的顾及NWP的海上区域CORS增强PPP方法，其特征在于，所述步骤2中，ΔNi采用线性模型计算，其计算公式为：ΔNi=/2；式中，Ni和Ni+1分别为第i层和第i+1层的大气折射率。4.根据权利要求1所述的顾及NWP的海上区域CORS增强PPP方法，其特征在于，所述步骤3中，从内插模型出发设计几何精度因子法，即N-GDOP法选取最优NWP虚拟参考站，选取N-GDOP值最小且与区域CORS参考站对称的NWP虚拟参考站组合。5.根据权利要求4所述的顾及NWP的海上区域CORS增强PPP方法，其特征在于，所述步骤3中，N-GDOP计算公式如下所示：N-GDOP=SQRT)；其中，Tr表示协因数阵的迹，SQRT)表示协因数阵的迹的平方根；Q为协因数阵，其表达式为：Q=-1；式中，M=；以流动站为中心建立局部坐标系，分别表示参考站的大地坐标，B为大地纬度，L为大地经度，H为大地高。6.根据权利要求1所述的顾及NWP的海上区域CORS增强PPP方法，其特征在于，所述步骤5中，采用先验方差对改正后的NWP虚拟参考站的ZTD和CORS参考站提供的ZTD进行定权，定权模型如下式所示：；Pz=Q-1z；式中，Qz和Pz分别为协因数阵和权阵；、…、/＞表示为不同CORS站估计的非差ZTD的先验方差；C1、…、Ck均表示CORS站，k表示区域CORS站的数量；、…、/＞表示NWP资料反演的ZTD的先验方差；N1、…、Nj均表示NWP虚拟参考站，j表示NWP虚拟参考站的个数。7.根据权利要求1所述的顾及NWP的海上区域CORS增强PPP方法，其特征在于，所述步骤5中，空间回归模型如下：；式中，α０、α1、α２、α３表示回归系数；下标n表示CORS站和NWP虚拟参考站的总数量，ZTDv表示CORS站和NWP虚拟参考站中第v个站的ZTD，v∈；Bv为CORS站和NWP虚拟参考站中第v个站的大地纬度，Lv为CORS站和NWP虚拟参考站中第v个站的大地经度，Hv为CORS站和NWP虚拟参考站中第v个站的大地高；则空间回归模型的向量形式为：ZTD＝Mα；其中， ；/＞；流动站处的ZTDｕ表示为：ZTDｕ＝Muα；ZTDｕ表示流动站u处的对流层延迟，Mu=，以流动站为中心建立局部坐标系，Ｂｕ、Ｌｕ、Ｈｕ分别表示流动站处的大地纬度、大地经度、大地高。8.根据权利要求1所述的顾及NWP的海上区域CORS增强PPP方法，其特征在于，所述步骤6中，顾及NWP的区域CORS增强PPP模型如下：；式中，和/＞分别为伪距和相位无电离层组合观测值，r代表接收机，s代表卫星，c代表真空中的光速，/＞为卫地距，/＞和/＞分别为接收机钟差和卫星钟差；ZTDinter是步骤5中得到的流动站的ZTD；ZWDu为流动站处的天顶湿延迟；ZHD表示天顶干延迟，已由Saastamoinen模型改正；为湿延迟的残差；Mdry表示干延迟映射函数，Mwet为湿延迟的映射函数，为与其他频率无关的误差，和/＞分别表示伪距和相位的多路径效应及其它未模型化的误差。
说明书desc
技术领域本发明属于海上定位技术领域，涉及一种顾及NWP的海上区域CORS增强PPP方法。背景技术全球导航卫星系统，能够为海上船只定位、海上平台变形监测以及海洋资源开发等提供高精度的导航与位置服务。就高精度定位而言，精密单点定位和网络RTK是最具代表性的前沿技术。在近海领域，主流的高精度定位手段仍是RTK定位，但目前RTK定位受距离限制较大，在中长距离下对流层延迟相关性大大降低，定位精度下降。在远海领域，由于面临着许多问题，例如海上基站架设困难，数据传输存在一定障碍等，RTK已无法满足定位需求，因此需要采用区域CORS增强PPP的方法。CORS即Continuously Operating Reference Stations的英文缩写，即连续运行参考站。区域CORS增强PPP是利用区域CORS网络参考站数据计算参考站大气延迟，对区域CORS网络参考站端的天顶对流层延迟参数采用合适的数学模型内插出流动用户的ZTD，传至流动站用户，从而增强流动站PPP定位，加快PPP模糊度固定，缩短定位时间。但是当流动站的位置处于CORS网一侧、CORS站观测数据缺失、海上缺乏参考站时会导致海上参考站网络几何构型不佳，造成海上区域CORS生成的对流层延迟产品精度低。而数值气象预报模型再分析资料可提供全球气象参数格网数据且具有较高的精度，可以利用NWP模型计算全球任意位置、任意时刻的高精度对流层延迟。发明内容本发明的目的在于提出一种顾及NWP的海上区域CORS增强PPP方法，该方法结合NWP反演的ZTD和区域CORS提供的ZTD信息，在流动站内插出高精度ZTD，从而建立增强的PPP模型，以缩短PPP的收敛时间，提高其定位精度。本发明为了实现上述目的，采用如下技术方案：一种顾及NWP的海上区域CORS增强PPP方法，包括如下步骤：步骤1. 获取NWP再分析资料；步骤2. 利用NWP再分析资料使用分层积分法反演ZTD；步骤3. 虚拟参考站选址；步骤4. 使用多因子约束下的NWP反演ZTD的残差改正方法，计算NWP反演的ZTD与区域CORS的ZTD之间存在的系统误差；将系统误差与NWP反演的ZTD相加，得到改正后的NWP虚拟参考站的ZTD；步骤5. 依据空间回归模型，利用改正后的NWP虚拟参考站的ZTD和区域CORS提供的ZTD进行内插，得到流动站ZTD；步骤6. 将流动站的ZTD代入增强PPP数学模型中进行求解，得到定位结果。本发明具有如下优点：如上所述，本发明述及了一种顾及NWP的海上区域CORS增强PPP方法，该方法提出的N-GDOP法结合参考站对称原则选取的NWP虚拟参考站组合组成的虚拟参考站网，与原参考站网几何构型相比，N-GDOP值大幅度减小；NWP虚拟参考站组合估计的区域CORS对流层延迟增强信息的精度优于单虚拟参考站。此外，本发明结合改正后的NWP虚拟参考站的ZTD和区域CORS提供的ZTD信息，在流动站插值出高精度的流动站ZTD，从而建立增强的PPP模型，有效地缩短了PPP的收敛时间，提高了PPP的定位精度。附图说明图1是本发明实施例中顾及NWP的海上区域CORS增强PPP方法的流程图。图2为本发明实施例中NWP虚拟参考站分布图。图3为本发明实施例中NWP单个最优虚拟参考站和虚拟参考站组合ZTD的误差图。图4为本发明实施例中海上实验方法2的测站分布图。图5为本发明实施例中海上实验方法3的测站分布图。图6为无电离层PPP模型、区域增强PPP及本发明方法在海上实验的ZWD误差示意图。图7为无电离层PPP模型、区域增强PPP及本发明方法在海上实验的定位误差示意图。具体实施方式下面结合附图以及具体实施方式对本发明作进一步详细说明：如图1所示，一种顾及NWP的海上区域CORS增强PPP方法，包括如下步骤：步骤1. 获取ECMWF提供的NWP再分析资料。步骤2. 利用NWP再分析资料使用分层积分法反演ZTD。由于NWP模型再分析资料提供的是分层气象资料，故其反演ZTD的公式如下：。式中，ZTD、ZHD、ZWD分别表示天顶对流层总延迟、天顶干延迟和天顶湿延迟；a为测站高度处最底层等压面，b为测站高度处最顶层等压面，i∈。ΔNi为第i与i+1层间的大气折射率，ΔNdry,i为第i与i+1层间的干延迟对应的大气折射率，ΔNwet,i为第i与i+1层间的湿延迟对应的大气折射率，ΔSi为第i与i+1层之间的距离差。ΔNi采用线性模型计算，其公式为：ΔNi=/2。式中，Ni和Ni+1分别为第i层和第i+1层的大气折射率。步骤3. 虚拟参考站选址。由于流动站附近有许多NWP格网点，因此需要在ZTD内插之前选择合适的格网点作为虚拟参考站。本发明从内插模型出发设计几何精度因子法，即N-GDOP法选取最优NWP虚拟参考站，选取N-GDOP值最小且与区域CORS参考站对称的NWP格网点作为虚拟参考站组合。N-GDOP计算公式如下所示：N-GDOP=SQRT)。其中，Tr表示协因数阵的迹，SQRT)表示协因数阵的迹的平方根。Q为协因数阵，其表达式为：Q=-1。式中，M=；以流动站为中心建立局部坐标系，分别表示参考站的大地坐标，B为大地纬度，L为大地经度，H为大地高。步骤4. 使用多因子约束下的NWP反演ZTD的残差改正方法，计算NWP反演的ZTD与区域CORS的ZTD之间存在的系统误差。多因子约束下的NWP反演ZTD的残差改正模型如下：。式中，代表拟合的ZTD残差。RH代表相对湿度，T0代表温度。P00、P10、P01、P20、P11、P02、P30、P21、P12、P03、P31、P22、P13、P04是多项式的系数。将系统误差与NWP反演的ZTD相加，得到改正后的虚拟参考站的ZTD。步骤5. 依据空间回归模型，利用改正后的虚拟参考站的ZTD和区域CORS提供的ZTD进行内插，得到流动站ZTD。区域CORS估计的ZTD与改正后的虚拟参考站的ZTD精度不同，在内插融合前，本实施例采用先验方差对改正后的虚拟参考站的ZTD和CORS参考站提供的ZTD定权。定权模型如下式所示：。Pz=Q-1z。式中，Qz和Pz分别为协因数阵和权阵。、…、表示为不同CORS站估计的非差ZTD的先验方差。C1、…、Ck均表示CORS站，k表示区域CORS站的数量。、…、表示NWP资料反演的ZTD的先验方差。N1、…、Nj表示NWP虚拟参考站，j表示NWP虚拟参考站的个数。空间回归模型如下：。式中，α０、α１、α２、α３表示回归系数；下标n表示CORS站和NWP虚拟参考站的总数量，ZTDv表示CORS站和NWP虚拟参考站中第v个站的对流层延迟，v∈。Bv为CORS站和NWP虚拟参考站中第v个站的大地纬度，Lv为CORS站和NWP虚拟参考站中第v个站的大地经度，Hv为CORS站和NWP虚拟参考站中第v个站的大地高。以流动站为中心建立局部坐标系，分别表示参考站的大地坐标，B为大地纬度，L为大地经度，H为大地高。则空间回归模型的向量形式为：ZTD＝Mα。其中， ；。流动站处的ZTDｕ表示为：ZTDｕ＝Muα。ZTDｕ表示流动站u处的对流层延迟；Mu=；以流动站为中心建立局部坐标系，Ｂｕ、Ｌｕ、Ｈｕ分别表示流动站处的大地纬度、大地经度、大地高。步骤6. 将流动站的ZTD代入增强PPP数学模型中进行求解，得到定位结果。顾及NWP的区域CORS增强PPP模型如下：。式中，和分别为伪距和相位无电离层组合观测值，r代表接收机，s代表卫星，c代表真空中的光速，为卫地距，和分别为接收机钟差和卫星钟差。ZTDinter是步骤5中得到的流动站的ZTD，ZWDu为流动站处的天顶湿延迟，ZHD表示干延迟，已由Saastamoinen模型改正，为湿延迟的残差。Mdry表示干延迟映射函数，Mwet为湿延迟的映射函数，为与其他频率无关的误差，和为伪距和相位的多路径效应及其它未模型化的误差。本发明对流层干延迟由Saastamoinen模型改正，对流层湿延迟通过附加NWP和区域CORS参考站的对流层湿延迟信息改正，对流层湿延迟的残差作为未知数求解。下面结合具体实例对本发明方法进行分析，以说明本发明方法的有效性。为评估N-GDOP法选择最优虚拟参考站的有效性，选取了欧洲4个海岸参考站和1个海上流动站的2020年1月3日至9日的GPS观测数据和NWP再分析数据，参考站距流动站最小距离约为167Km。采用N-GDOP法分别选取了N-GDOP值最小的单个最优虚拟参考站和与区域CORS参考站对称且N-GDOP值最小的NWP虚拟参考站组合，如图2所示。利用两种方案估计的区域CORS对流层延迟增强信息的误差如图3所示。其中，单虚拟参考站的偏差为5.2，均方根为6.6，虚拟参考站组合的偏差为4.9，均方根为6.4。实验表明最优NWP格网点组合估计的对流层延迟精度优于单个NWP最优虚拟参考站。为了评估本发明顾及NWP的海上区域CORS增强PPP算法的有效性，同样选取了欧洲4个海岸参考站，分别位于和1个海上流动站的2020年1月3日至9日的GPS观测数据和NWP再分析数据，采用了以下3种方法进行PPP数据处理。方法1：传统无电离层PPP模型。方法2：区域增强PPP，如图4，参考站位于流动站一侧，流动站位于参考站网外部。方法3：本发明顾及NWP的海上区域CORS增强PPP方法，如图5所示。其中NWP1、NWP2、NWP3、NWP4为实验所选择的虚拟参考站，参考站位于流动站一侧，在另一侧采用NWP最优格网点组合，使流动站位于参考站网内部。以后处理的连续7天的静态PPP定位结果为参考值。经三种方法处理后的PPP定位结果RMS值以及平均收敛时间如表1所示，ZWD误差和定位误差分别如图6所示和图7所示。表 1 三种方法处理后的PPP定位结果RMS值以及平均收敛时间经计算得到的ZTD误差：方法1的偏差为3.6，均方根为6.6，方法2的偏差为74.0，均方根为81.5，方法3的偏差为4.9，均方根为6.4。由表1以及图6和图7看出，本发明顾及NWP的海上区域CORS增强PPP的ZTD和定位误差与传统PPP相当，但其在E、N、U三个方向的收敛时间比传统PPP快16.3%、29.5%、12.0%，RMS分别减小4.9%、7.3%、9.0%，从而证明了本发明方法的有效性。本发明方法基于区域CORS和NWP模型进行融合，能够为海上用户提供更可靠的对流层延迟改正参数，缩短了GNSS用户的PPP收敛时间，很好的解决了目前海上缺少GNSS连续运行参考站导致的海上区域CORS对流层延迟增强产品精度低的问题。当然，以上说明仅仅为本发明的较佳实施例，本发明并不限于列举上述实施例，应当说明的是，任何熟悉本领域的技术人员在本说明书的教导下，所做出的所有等同替代、明显变形形式，均落在本说明书的实质范围之内，理应受到本发明的保护。
