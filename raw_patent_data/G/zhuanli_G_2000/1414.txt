标题title
一种基于rPPG信号的远程心率检测方法
摘要abst
一种基于rPPG信号的远程心率检测方法，涉及非接触式信号检测领域，在ROI定义阶段，对人脸区域进行定位与跟踪，利用先验知识，直接选择人脸中包含rPPG信号最丰富的区域作为ROI，忽略复杂环境噪声信息和与rPPG信号不相关信息的影响，利用通道、空间宽度和空间高度三个维度的注意力权重对特征图进行更新，有效滤除由于运动和光照变化产生的噪声的干扰，使模型在复杂环境中仍能准确提取有效rPPG信号信息。使用Transformer编码器学习各帧之间的特征关系，使模型充分注意人脸视频各帧间的时空特征关系和rPPG信号全局时空特征相关性，从而预测出人脸视频中微弱的rPPG信号，进一步提高了预测的准确性和鲁棒性。
权利要求书clms
1.一种基于rPPG信号的远程心率检测方法，其特征在于，包括如下步骤：a)获取n个含有真实rPPG信号信息的人脸视频；b)对n个含有真实rPPG信号信息的人脸视频进行预处理操作，得到含有标签信息的e个新的视频样本数据集V＝{V1,V2,...,Vi,...,Ve}，其中Vi为第i个预处理后的视频，i∈{1,2,...,e}，Vi＝{Fi1,Fi2,...,Fit,...,FiT}，Fit为第i个预处理后的视频Vi的第t帧图片，t∈{1,2,...,T}，T为第i个预处理后的视频Vi中帧数，第i个预处理后的视频Vi的标签信息为与其帧数长度一致的rPPG信号Yi＝{Yi1,Yi2,...,Yit,...,YiT}，Yit为第t帧图片Fit的rPPG信号值；c)选定一矩形区域作为ROI区域，使用ROI区域对第t帧图片Fit进行剪裁；d)对剪裁后的第t帧图片Fit进行数据压缩操作，T个压缩后的图片构成剪裁后的第i个视频Vi，Vi∈RC×T×H×W；e)构建神经网络模型CS_TrNet，神经网络模型CS_TrNet由特征提取模块、Transformer模型的编码模块、rPPG信号聚合模块构成；f)将剪裁后的第t帧图片Fit输入到神经网络模型CS_TrNet的特征提取模块中，输出得到特征向量Pit_69；g)将剪裁后的第i个视频Vi所有T帧的特征向量依次排列成矩阵Pi，Pi＝Γ，Γ为矩阵转置；h)将特征向量Pit_69输入到Transformer模型的编码模块中，输出得到融合了各帧不同权重向量表示的全局时空特征向量Pit_69′，得到全局时空特征向量矩阵Pi′＝Γ；i)将全局时空特征向量Pit_69′输入到rPPG信号聚合模块中，输出得到第t帧图像的rPPG信号值Yit_pre，所有T帧的rPPG信号值构成长度为T的rPPG信号Yi_pre，Yi_pre＝{Yi1_pre,Yi2_pre,...,Yii_pre,...,YiT_pre}；j)使用Adam优化器利用损失函数Loss训练神经网络模型CS_TrNet，得到优化后的神经网络模型CS_TrNet；k)将剪裁后的第t帧图片Fit输入到优化后的神经网络模型CS_TrNet中，重复步骤f)至步骤i)，得到rPPG信号Yi_pre′；l)对rPPG信号Yi_pre′使用AMPD自动多尺度峰值查找算法进行峰值点检测，得到rPPG信号Yi_pre′中的若干峰值点，通过公式计算得到每分钟的心率值Y，式中X为i个预处理后的视频Vi的每秒帧数，每两个相邻的峰值点之间的帧数为两个相邻峰值的距离，s为各个相邻峰值距离的平均值。2.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于：步骤a)中从UBFC-rPPG数据集中获取n个含有真实rPPG信号信息的人脸视频。3.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于，步骤b)中预处理操作的方法为：对n个含有真实rPPG信号信息的人脸视频进行数据增广操作，得到含有标签信息的e个新的视频样本数据集V＝{V1,V2,...,Vi,...,Ve}，数据增广时使用长度为60帧，步长为30帧的滑动窗口对n个含有真实rPPG信号信息的人脸视频进行重叠切割。4.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于，步骤c)包括如下步骤：c-1)使用基于Python的landmark算法对第t帧图片Fit进行人脸跟踪，得到68个人脸特征点的人脸地标位置；c-2)以第t帧图片Fit左上角作为原点，从原点水平向右作为X轴，从原点竖直向下作为Y轴，通过公式XLT＝Xp3计算得到矩形区域左上角横坐标XLT，式中Xp3为第3个人脸特征点p3的X轴坐标，通过公式YLT＝MAX计算得到矩形区域左上角纵坐标YLT，式中Yp40为第40个人脸特征点p40的Y轴坐标，Yp41为第41个人脸特征点p41的Y轴坐标，Yp46为第46个人脸特征点p46的Y轴坐标，Yp47为第47个人脸特征点p47的Y轴坐标，MAX为选取最大值操作，通过公式WROI＝Xp13-Xp3计算得到矩形区域的宽度值，式中Xp13为第13个人脸特征点p13的X轴坐标，通过公式HROI＝YB-YLT计算得到矩形区域的高度值，式中YB＝MIN，Yp3为第3个人脸特征点p3的Y轴坐标，Yp50为第50个人脸特征点p50的Y轴坐标，Yp52为第52个人脸特征点p52的Y轴坐标，Yp13为第13个人脸特征点p13的Y轴坐标，MIN为选取最小值操作；c-3)将矩形区域作为ROI区域，使用ROI区域对第t帧图片Fit进行剪裁。5.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于，步骤d)包括如下步骤：d-1)将使用ROI区域进行剪裁后的第t帧图片Fit进行下采样操作，下采样到图像大小为64×128；d-2)将下采样后的第t帧图片Fit使用最大最小归一化操作，将图像数据压缩到之间，得到数据压缩后的第t帧图片Fit。6.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于，步骤f)包括如下步骤：f-1)神经网络模型CS_TrNet的特征提取模块由第一卷积块、第一N_CSAM块、第二卷积块、第二N_CSAM块、第三卷积块、第三N_CSAM块、第四卷积块、第四N_CSAM块、全局平均池化层构成，第一卷积块、第二卷积块、第三卷积块、第四卷积块均依次由二维卷积Conv2d层、最大池化层、批处理归一化BN层、Relu激活函数层构成，第一N_CSAM块、第二N_CSAM块、第三N_CSAM块、第四N_CSAM块均由通道注意力层N_CAM和空间注意力层N_SAM构成，通道注意力层N_CAM均由全局空间池化层、1D卷积层、Sigmoid激活函数层构成，全局空间池化层由全局平均池化层、全局最大池化层构成，空间注意力层N_SAM均由全局通道池化层、第一中心差分卷积层、第二中心差分卷积层、Sigmoid激活函数层构成，全局通道池化层由全局平均池化层、全局最大池化层构成；f-2)将剪裁后的第t帧图片Fit输入到第一卷积块中，输出得到压缩特征图Conv1_fit_1；f-3)将压缩特征图Conv1_fit_1输入到第一N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图C_AP_fit_2，将压缩特征图Conv1_fit_1输入到第一N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图C_MP_fit_3，将特征图C_AP_fit_2与可训练参数α相乘得到不同权重表示的特征图C_AP_fit_4，将特征图C_MP_fit_3与可训练参数β相乘得到不同权重表示的特征图C_MP_fit_5，将特征图C_AP_fit_2与特征图C_AP_fit_3逐元素相加后与超参数θ相乘得到特征图C_AM_fit_6，将特征图C_AP_fit_4、特征图C_MP_fit_5、特征图C_AM_fit_6逐元素相加操作，得到融合全局空间池化的特征图C_AM_fit_7，将特征图C_AM_fit_7依次输入到第一N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图C_M_fit_8，将注意力权重系数图C_M_fit_8与压缩特征图Conv1_fit_1进行逐元素相乘操作后，得到通道注意力特征图C_fit_9，通道注意力特征图C_fit_9输入到第一N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图S_AP_fit_10，将通道注意力特征图C_fit_9输入到第一N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图S_MP_fit_11，将特征图S_AP_fit_10输入到第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_AP_fit_12，将特征图S_MP_fit_11输入到第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_MP_fit_13，将特征图S_AP_fit_12和特征图S_MP_fit_13逐元素相加，得到特征图S_AM_fit_14，将特征图S_AM_fit_14输入到第一N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图S_AM_fit_15，将特征图S_AM_fit_15输入到第一N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图S_M_fit_16，将注意力权重系数图S_M_fit_16与通道注意力特征图C_fit_9进行逐元素相乘后得到空间注意力特征图S_fit_17；f-4)将空间注意力特征图S_fit_17输入到第二卷积块中，输出得到压缩特征图Conv2_fit_18；f-5)将压缩特征图Conv2_fit_18输入到第二N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图C_AP_fit_19，将压缩特征图Conv2_fit_18输入到第二N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图C_MP_fit_20，将特征图C_AP_fit_19与可训练参数α相乘得到不同权重表示的特征图C_AP_fit_21，将特征图C_MP_fit_20与可训练参数β相乘得到不同权重表示的特征图C_MP_fit_22，将特征图C_AP_fit_19与特征图C_MP_fit_20逐元素相加后与超参数θ相乘得到特征图C_AM_fit_23，将特征图C_AP_fit_21、特征图C_MP_fit_22、特征图C_AM_fit_23逐元素相加操作，得到融合全局空间池化的特征图C_AM_fit_24，将特征图C_AM_fit_24依次输入到第二N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图C_M_fit_25，将注意力权重系数图C_M_fit_25与压缩特征图Conv2_fit_18进行逐元素相乘操作后，得到通道注意力特征图C_fit_26，通道注意力特征图C_fit_26输入到第二N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图S_AP_fit_27，将通道注意力特征图C_fit_26输入到第二N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图S_MP_fit_28，将特征图S_AP_fit_27输入到第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_AP_fit_29，将特征图S_MP_fit_28输入到第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_MP_fit_30，将特征图S_AP_fit_29和特征图S_MP_fit_30逐元素相加，得到特征图S_AM_fit_31，将特征图S_AM_fit_31输入到第二N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图S_AM_fit_32，将特征图S_AM_fit_32输入到第二N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图S_M_fit_33，将注意力权重系数图S_M_fit_33与通道注意力特征图C_fit_26进行逐元素相乘后得到空间注意力特征图S_fit_34；f-6)将空间注意力特征图S_fit_34输入到第三卷积块中，输出得到压缩特征图Conv3_fit_35；f-7)将压缩特征图Conv3_fit_35输入到第三N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图C_AP_fit_36，将压缩特征图Conv3_fit_35输入到第三N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图C_MP_fit_37，将特征图C_AP_fit_36与可训练参数α相乘得到不同权重表示的特征图C_AP_fit_38，将特征图C_MP_fit_37与可训练参数β相乘得到不同权重表示的特征图C_MP_fit_39，将特征图C_AP_fit_36与特征图C_MP_fit_37逐元素相加后与超参数θ相乘得到特征图C_AM_fit_40，将特征图C_AP_fit_38、特征图C_MP_fit_39、特征图C_AM_fit_40逐元素相加操作，得到融合全局空间池化的特征图C_AM_fit_41，将特征图C_AM_fit_41依次输入到第三N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图C_M_fit_42，将注意力权重系数图C_M_fit_42与压缩特征图Conv3_fit_35进行逐元素相乘操作后，得到通道注意力特征图C_fit_43，通道注意力特征图C_fit_43输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图S_AP_fit_44，将通道注意力特征图C_fit_43输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图S_MP_fit_45，将特征图S_AP_fit_44输入到第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_AP_fit_46，将特征图S_MP_fit_45输入到第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_MP_fit_47，将特征图S_AP_fit_46和特征图S_MP_fit_47逐元素相加，得到特征图S_AM_fit_48，将特征图S_AM_fit_48输入到第三N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图S_AM_fit_49，将特征图S_AM_fit_49输入到第三N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图S_M_fit_50，将注意力权重系数图S_M_fit_50与通道注意力特征图C_fit_43进行逐元素相乘后得到空间注意力特征图S_fit_51；f-8)将空间注意力特征图S_fit_51输入到第四卷积块中，输出得到压缩特征图Conv4_fit_52；f-9)将压缩特征图Conv4_fit_52输入到第四N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图C_AP_fit_53，将压缩特征图Conv4_fit_52输入到第四N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图C_MP_fit_54，将特征图C_AP_fit_53与可训练参数α相乘得到不同权重表示的特征图C_AP_fit_55，将特征图C_MP_fit_54与可训练参数β相乘得到不同权重表示的特征图C_MP_fit_56，将特征图C_AP_fit_53与特征图C_MP_fit_54逐元素相加后与超参数θ相乘得到特征图C_AM_fit_57，将特征图C_AP_fit_55、特征图C_MP_fit_56、特征图C_AM_fit_57逐元素相加操作，得到融合全局空间池化的特征图C_AM_fit_58，将特征图C_AM_fit_58依次输入到第四N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图C_M_fit_59，将注意力权重系数图C_M_fit_59与压缩特征图Conv4_fit_52进行逐元素相乘操作后，得到通道注意力特征图C_fit_60，通道注意力特征图C_fit_60输入到第四N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图S_AP_fit_61，将通道注意力特征图C_fit_60输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图S_MP_fit_62，将特征图S_AP_fit_61输入到第四N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_AP_fit_63，将特征图S_MP_fit_62输入到第四N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图S_MP_fit_64，将特征图S_AP_fit_63和特征图S_MP_fit_64逐元素相加，得到特征图S_AM_fit_65，将特征图S_AM_fit_65输入到第四N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图S_AM_fit_66，将特征图S_AM_fit_66输入到第四N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图S_M_fit_67，将注意力权重系数图S_M_fit_67与通道注意力特征图C_fit_60进行逐元素相乘后得到空间注意力特征图S_fit_68；f-10)将空间注意力特征图S_fit_68输入到特征提取模块的全局平均池化层中，输出一条长度为空间注意力特征图S_fit_68通道数量的特征向量Pit_69。7.根据权利要求6所述的基于rPPG信号的远程心率检测方法，其特征在于：步骤f-2)中第一卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为16、步长为1×2，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-3)中第一N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为16、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；步骤f-4)中第二卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为32、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-5)中第二N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为32、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；骤f-6)中第三卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为64、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-7)中第三N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为64、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；骤f-8)中第四卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为128、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-9)中第四N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为5、步长为1、填充为2，超参数θ设置为0.5，第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为128、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3。8.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于：步骤i)中rPPG信号聚合模块由一维卷积Conv1D层构成。9.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于：步骤j)中通过公式计算得到损失函数Loss，式中Yit为第t帧图像的真实rPPG信号值。10.根据权利要求1所述的基于rPPG信号的远程心率检测方法，其特征在于：步骤j)中使用Adam优化器利用损失函数Loss训练神经网络模型CS_TrNet时设置学习率为0.001，视频批量batchsize大小为64，训练500个epoch，当连续10个epoch的损失函数值不再下降时，保存得到优化后的神经网络模型CS_TrNet。
说明书desc
技术领域本发明涉及非接触式信号检测领域，具体涉及一种基于rPPG信号的远程心率检测方法。背景技术心率是能够反映人体身体状况或精神状态的一项重要指标。根据调查数据显示，近年来，我国心血管病患病率持续上升，在所有慢性疾病中，心血管病是死亡率最高的一种疾病。传统的心率检测方法主要是基于心电图和接触式光电容积脉搏波，这些方法测量结果准确，社会认可度高。然而这些方法需要在受试者身体上佩戴特定的传感器来收集数据，一些特殊患者并不能使用，如皮肤过敏或皮肤有损伤的患者、刚出生的婴幼儿、烧伤病人等群体。因此，近些年来研究者提出远程电描记术，这是一种使用面部视频测量人体心率的非接触式方法，当光线照射到皮肤上时，一部分光在人体皮肤表面镜面反射的作用下，被直接反射到外界，这部分光不包含脉搏信号信息，另一部分光照穿透皮肤照射到血管上，被毛细血管中的血红蛋白吸收，血液中的血红蛋白对不同波长的光具有不同的吸收特性，尤其是在红外光谱范围内。心脏的跳动会导致血管中血容量呈周期性变化，当血液流过皮肤下的微小血管时，血液中的血红蛋白的吸收特性会随着心跳和呼吸而发生微弱的周期性变化，从而引起皮肤表面的光学信号变化。现有的远程测量心率方法主要分为传统方法和基于深度学习的方法，传统方法主要包括盲源分离、最小均方、自适应矩阵补全、基于色度的CHROM、与肤色正交的投影平面等方法，这些方法需要复杂的先验知识来进行ROI选择、皮肤像素检测以及手工制作的信号处理步骤，这些步骤很难部署并且不一定能很好地推广到新数据。近些年，研究者通常会使用深度学习的方法来进行远程心率的测量，niu等人为CNN构建了一个时空特征图来测量平均HR，Radim等人提出了HRCNN，利用对齐后的人脸图像来预测HR，Chen和McDuff利用CNN的归一化帧差来预测脉冲信号。这些深度学习方法通常将HR估计任务视为一个单回归问题，仅有一个简单的平均HR值输出，无法实时的检测短时间内被测者心率变化。此外，他们基本都是基于二维CNN，缺乏学习面部序列的时间上下文特征的能力，而这对于rPPG信号的测量是必不可少的。且大多数研究都是基于环境光照稳定的条件下进行，但是在实际情况下，在视频采集过程中，环境光的变化、受试者面部运动所引入的运动伪迹干扰、相机的量化噪声等都会严重影响采集信号的质量，给测量带来极大干扰。发明内容本发明为了克服以上技术的不足，提供了一种提高在复杂场景变化下测量心率的鲁棒性和准确性的基于rPPG信号的远程心率检测方法。本发明克服其技术问题所采用的技术方案是：一种基于rPPG信号的远程心率检测方法，包括如下步骤：a)获取n个含有真实rPPG信号信息的人脸视频；b)对n个含有真实rPPG信号信息的人脸视频进行预处理操作，得到含有标签信息的e个新的视频样本数据集V＝{V1,V2,...,Vi,...,Ve}，其中Vi为第i个预处理后的视频，i∈{1,2,...,e}，为第i个预处理后的视频Vi的第t帧图片，t∈{1,2,...,T}，T为第i个预处理后的视频Vi中帧数，第i个预处理后的视频Vi的标签信息为与其帧数长度一致的rPPG信号/＞为第t帧图片/＞的rPPG信号值；c)选定一矩形区域作为ROI区域，使用ROI区域对第t帧图片进行剪裁；d)对剪裁后的第t帧图片进行数据压缩操作，T个压缩后的图片构成剪裁后的第i个视频Vi，Vi∈RC×T×H×W；e)构建神经网络模型CS_TrNet，神经网络模型CS_TrNet由特征提取模块、Transformer模型的编码模块、rPPG信号聚合模块构成；f)将剪裁后的第t帧图片输入到神经网络模型CS_TrNet的特征提取模块中，输出得到特征向量/＞g)将剪裁后的第i个视频Vi所有T帧的特征向量依次排列成矩阵Pi，Γ为矩阵转置；h)将特征向量Pit_69输入到Transformer模型的编码模块中，输出得到融合了各帧不同权重向量表示的全局时空特征向量Pit_69′，得到全局时空特征向量矩阵Pi′＝Γ；i)将全局时空特征向量输入到rPPG信号聚合模块中，输出得到第t帧图像的rPPG信号值/＞所有T帧的rPPG信号值构成长度为T的rPPG信号j)使用Adam优化器利用损失函数Loss训练神经网络模型CS_TrNet，得到优化后的神经网络模型CS_TrNet；k)将剪裁后的第t帧图片输入到优化后的神经网络模型CS_TrNet中，重复步骤f)至步骤i)，得到rPPG信号Yi_pre′；l)对rPPG信号Yi_pre′使用AMPD自动多尺度峰值查找算法进行峰值点检测，得到rPPG信号Yi_pre′中的若干峰值点，通过公式计算得到每分钟的心率值Y，式中X为i个预处理后的视频Vi的每秒帧数，每两个相邻的峰值点之间的帧数为两个相邻峰值的距离，s为各个相邻峰值距离的平均值。进一步的，步骤a)中从UBFC-rPPG数据集中获取n个含有真实rPPG信号信息的人脸视频。进一步的，步骤b)中预处理操作的方法为：对n个含有真实rPPG信号信息的人脸视频进行数据增广操作，得到含有标签信息的e个新的视频样本数据集V＝{V1,V2,...,Vi,...,Ve}，数据增广时使用长度为60帧，步长为30帧的滑动窗口对n个含有真实rPPG信号信息的人脸视频进行重叠切割。进一步的，步骤c)包括如下步骤：c-1)使用基于Python的landmark算法对第t帧图片进行人脸跟踪，得到68个人脸特征点的人脸地标位置；c-2)以第t帧图片左上角作为原点，从原点水平向右作为X轴，从原点竖直向下作为Y轴，通过公式XLT＝Xp3计算得到矩形区域左上角横坐标XLT，式中Xp3为第3个人脸特征点p3的X轴坐标，通过公式YLT＝MAX计算得到矩形区域左上角纵坐标YLT，式中Yp40为第40个人脸特征点p40的Y轴坐标，Yp41为第41个人脸特征点p41的Y轴坐标，Yp46为第46个人脸特征点p46的Y轴坐标，Yp47为第47个人脸特征点p47的Y轴坐标，MAX为选取最大值操作，通过公式WROI＝Xp13-Xp3计算得到矩形区域的宽度值，式中Xp13为第13个人脸特征点p13的X轴坐标，通过公式HROI＝YB-YLT计算得到矩形区域的高度值，式中YB＝MIN，Yp3为第3个人脸特征点p3的Y轴坐标，Yp50为第50个人脸特征点p50的Y轴坐标，Yp52为第52个人脸特征点p52的Y轴坐标，Yp13为第13个人脸特征点p13的Y轴坐标，MIN为选取最小值操作；c-3)将矩形区域作为ROI区域，使用ROI区域对第t帧图片进行剪裁。进一步的，步骤d)包括如下步骤：d-1)将使用ROI区域进行剪裁后的第t帧图片进行下采样操作，下采样到图像大小为64×128；d-2)将下采样后的第t帧图片使用最大最小归一化操作，将图像数据压缩到之间，得到数据压缩后的第t帧图片/＞进一步的，步骤f)包括如下步骤：f-1)神经网络模型CS_TrNet的特征提取模块由第一卷积块、第一N_CSAM块、第二卷积块、第二N_CSAM块、第三卷积块、第三N_CSAM块、第四卷积块、第四N_CSAM块、全局平均池化层构成，第一卷积块、第二卷积块、第三卷积块、第四卷积块均依次由二维卷积Conv2d层、最大池化层、批处理归一化BN层、Relu激活函数层构成，第一N_CSAM块、第二N_CSAM块、第三N_CSAM块、第四N_CSAM块均由通道注意力层N_CAM和空间注意力层N_SAM构成，通道注意力层N_CAM均由全局空间池化层、1D卷积层、Sigmoid激活函数层构成，全局空间池化层由全局平均池化层、全局最大池化层构成，空间注意力层N_SAM均由全局通道池化层、第一中心差分卷积层、第二中心差分卷积层、Sigmoid激活函数层构成，全局通道池化层由全局平均池化层、全局最大池化层构成；f-2)将剪裁后的第t帧图片输入到第一卷积块中，输出得到压缩特征图f-3)将压缩特征图输入到第一N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图/＞将压缩特征图输入到第一N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图/＞将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图/＞特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图依次输入到第一N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图/＞与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图/＞将通道注意力特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图将特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图和特征图/＞逐元素相加，得到特征图将特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图输入到第一N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-4)将空间注意力特征图/＞输入到第二卷积块中，输出得到压缩特征图/＞f-5)将压缩特征图/＞输入到第二N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图将压缩特征图/＞输入到第二N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图依次输入到第二N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图/＞与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图将通道注意力特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图将特征图/＞和特征图/＞逐元素相加，得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图/＞与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-6)将空间注意力特征图/＞输入到第三卷积块中，输出得到压缩特征图/＞f-7)将压缩特征图/＞输入到第三N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图将压缩特征图/＞输入到第三N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图/＞依次输入到第三N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图/＞将通道注意力特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图输入到第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图/＞和特征图/＞逐元素相加，得到特征图将特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图输入到第三N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-8)将空间注意力特征图/＞输入到第四卷积块中，输出得到压缩特征图/＞f-9)将压缩特征图/＞输入到第四N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图将压缩特征图/＞输入到第四N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图依次输入到第四N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图/＞与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图将通道注意力特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图将特征图/＞和特征图/＞逐元素相加，得到特征图/＞将特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图/＞与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-10)将空间注意力特征图/＞输入到特征提取模块的全局平均池化层中，输出一条长度为空间注意力特征图/＞通道数量的特征向量优选的，步骤f-2)中第一卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为16、步长为1×2，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-3)中第一N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为16、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；步骤f-4)中第二卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为32、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-5)中第二N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为32、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；骤f-6)中第三卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为64、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-7)中第三N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为64、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；骤f-8)中第四卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为128、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-9)中第四N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为5、步长为1、填充为2，超参数θ设置为0.5，第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为128、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3。进一步的，步骤i)中rPPG信号聚合模块由一维卷积Conv1D层构成。进一步的，步骤j)中通过公式计算得到损失函数Loss，式中Yit为第t帧图像的真实rPPG信号值。优选的，步骤j)中使用Adam优化器利用损失函数Loss训练神经网络模型CS_TrNet时设置学习率为0.001，视频批量batchsize大小为64，训练500个epoch，当连续10个epoch的损失函数值不再下降时，保存得到优化后的神经网络模型CS_TrNet。本发明的有益效果是：在ROI定义阶段，对人脸区域进行定位与跟踪，利用先验知识，直接选择人脸中包含rPPG信号最丰富的区域作为ROI，忽略复杂环境噪声信息和与rPPG信号不相关信息的影响；经过预处理后每个视频仅有60帧，因此可实时检测被测者在短时间内的心率变化，更适应在实际情况下的心率检测需求。利用通道、空间宽度和空间高度三个维度的注意力权重对特征图进行更新，在空间注意力层中，基于中心差分卷积CDC对特征图进行特征转换，使模型更好的关注提取的特征中rPPG信号更强烈的区域，有效滤除由于运动和光照变化产生的噪声的干扰，使模型在复杂环境中仍能准确提取有效rPPG信号信息。使用Transformer编码器学习各帧之间的特征关系，使模型充分注意人脸视频各帧间的时空特征关系和rPPG信号全局时空特征相关性，从而预测出人脸视频中微弱的rPPG信号，进一步提高了预测的准确性和鲁棒性。附图说明图1为本发明的预处理的方法流程图；图2为本发明选取的ROI；图3为本发明的神经网络模型CS_TrNet的结构图；图4为本发明的特征提取模块的结构图；图5为本发明的N_CSAM块的结构图。具体实施方式下面结合附图1至附图5对本发明做进一步说明。一种基于rPPG信号的远程心率检测方法，包括如下步骤：a)获取n个含有真实rPPG信号信息的人脸视频。b)对n个含有真实rPPG信号信息的人脸视频进行预处理操作，得到含有标签信息的e个新的视频样本数据集V＝{V1,V2,...,Vi,...,Ve}，其中Vi为第i个预处理后的视频，i∈{1,2,...,e}，为第i个预处理后的视频Vi的第t帧图片，t∈{1,2,...,T}，T为第i个预处理后的视频Vi中帧数，第i个预处理后的视频Vi的标签信息为与其帧数长度一致的rPPG信号/＞为第t帧图片/＞的rPPG信号值。优选的T的取值为60。c)选定一矩形区域作为ROI区域，使用ROI区域对第t帧图片进行剪裁。d)对剪裁后的第t帧图片进行数据压缩操作，T个压缩后的图片构成剪裁后的第i个视频Vi，Vi∈RC×T×H×W，C取值为3，H取值为64，W取值为128。e)构建神经网络模型CS_TrNet，神经网络模型CS_TrNet由特征提取模块、Transformer模型的编码模块、rPPG信号聚合模块构成。f)将剪裁后的第t帧图片输入到神经网络模型CS_TrNet的特征提取模块中，输出得到特征向量/＞g)将剪裁后的第i个视频Vi所有T帧的特征向量依次排列成矩阵Pi，Γ为矩阵转置。h)将特征向量Pit_69输入到Transformer模型的编码模块中，输出得到融合了各帧不同权重向量表示的全局时空特征向量Pit_69′，得到全局时空特征向量矩阵i)将全局时空特征向量输入到rPPG信号聚合模块中，输出得到第t帧图像的rPPG信号值/＞所有T帧的rPPG信号值构成长度为T的rPPG信号j)使用Adam优化器利用损失函数Loss训练神经网络模型CS_TrNet，得到优化后的神经网络模型CS_TrNet。k)将剪裁后的第t帧图片输入到优化后的神经网络模型CS_TrNet中，重复步骤f)至步骤i)，得到rPPG信号Yi_pre′。l)对rPPG信号Yi_pre′使用AMPD自动多尺度峰值查找算法进行峰值点检测，得到rPPG信号Yi_pre′中的若干峰值点，通过公式计算得到每分钟的心率值Y，式中X为i个预处理后的视频Vi的每秒帧数，每两个相邻的峰值点之间的帧数为两个相邻峰值的距离，s为各个相邻峰值距离的平均值。建了一种基于N_CSAM通道空间注意力机制和Transformer编码器的神经网络模型CS_TrNet，旨在提高在复杂场景变化下测量心率的鲁棒性和准确性。实施例1：步骤a)中从UBFC-rPPG数据集中获取n个含有真实rPPG信号信息的人脸视频。实施例2：步骤b)中预处理操作的方法为：对n个含有真实rPPG信号信息的人脸视频进行数据增广操作，得到含有标签信息的e个新的视频样本数据集V＝{V1,V2,...,Vi,...,Ve}，数据增广时使用长度为60帧，步长为30帧的滑动窗口对n个含有真实rPPG信号信息的人脸视频进行重叠切割。即对标签rPPG信号数据使用同样滑动窗口进行切割并与切割后的视频对应。实施例3：由于人脸中鼻子和脸颊部分含有丰富rPPG信息，因此选择此区域作为此例的感兴趣区域。使用基于Python的68点人脸特征点检测算法对视频V_i的第t帧图像F_i^t进行人脸跟踪，以精准定位人脸地标位置，方便对ROI位置进行准确剪裁，避免因视频中人脸运动造成ROI定位不准确，导致预测结果与实际结果有较大偏差。在68个人脸特征点中选择其中8个点来精准定义选定的ROI，并对8个点构成的矩形区域进行剪裁，矩形区域即为选定的ROI区域。具体的，步骤c)包括如下步骤：c-1)使用基于Python的landmark算法对第t帧图片进行人脸跟踪，得到68个人脸特征点的人脸地标位置。c-2)以第t帧图片左上角作为原点，从原点水平向右作为X轴，从原点竖直向下作为Y轴，通过公式XLT＝Xp3计算得到矩形区域左上角横坐标XLT，式中Xp3为第3个人脸特征点p3的X轴坐标，通过公式/＞计算得到矩形区域左上角纵坐标YLT，式中Yp40为第40个人脸特征点p40的Y轴坐标，Yp41为第41个人脸特征点p41的Y轴坐标，Yp46为第46个人脸特征点p46的Y轴坐标，Yp47为第47个人脸特征点p47的Y轴坐标，MAX为选取最大值操作，通过公式WROI＝Xp13-Xp3计算得到矩形区域的宽度值，式中Xp13为第13个人脸特征点p13的X轴坐标，通过公式HROI＝YB-YLT计算得到矩形区域的高度值，式中YB＝MIN，Yp3为第3个人脸特征点p3的Y轴坐标，Yp50为第50个人脸特征点p50的Y轴坐标，Yp52为第52个人脸特征点p52的Y轴坐标，Yp13为第13个人脸特征点p13的Y轴坐标，MIN为选取最小值操作。c-3)将矩形区域作为ROI区域，使用ROI区域对第t帧图片进行剪裁。通过此方法定义的ROI，可以尽可能的削弱背景、非皮肤区域以及眨眼和面部运动的影响，以提高最终测量结果的准确性和鲁棒性。实施例4：步骤d)包括如下步骤：d-1)为了减少计算量，将使用ROI区域进行剪裁后的第t帧图片进行下采样操作，下采样到图像大小为64×128。d-2)将下采样后的第t帧图片使用最大最小归一化操作，将图像数据压缩到之间，得到数据压缩后的第t帧图片/＞实施例5：步骤f)包括如下步骤：f-1)神经网络模型CS_TrNet的特征提取模块由第一卷积块、第一N_CSAM块、第二卷积块、第二N_CSAM块、第三卷积块、第三N_CSAM块、第四卷积块、第四N_CSAM块、全局平均池化层构成，第一卷积块、第二卷积块、第三卷积块、第四卷积块均依次由二维卷积Conv2d层、最大池化层、批处理归一化BN层、Relu激活函数层构成，第一N_CSAM块、第二N_CSAM块、第三N_CSAM块、第四N_CSAM块均由通道注意力层N_CAM和空间注意力层N_SAM构成，通道注意力层N_CAM均由全局空间池化层、1D卷积层、Sigmoid激活函数层构成，全局空间池化层由全局平均池化层、全局最大池化层构成，空间注意力层N_SAM均由全局通道池化层、第一中心差分卷积层、第二中心差分卷积层、Sigmoid激活函数层构成，全局通道池化层由全局平均池化层、全局最大池化层构成。f-2)将剪裁后的第t帧图片输入到第一卷积块中，输出得到压缩特征图f-3)将压缩特征图输入到第一N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图/＞将压缩特征图输入到第一N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图/＞将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图/＞特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图依次输入到第一N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图/＞与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图/＞将通道注意力特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图将特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图和特征图/＞逐元素相加，得到特征图将特征图/＞输入到第一N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图输入到第一N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-4)将空间注意力特征图/＞输入到第二卷积块中，输出得到压缩特征图/＞f-5)将压缩特征图/＞输入到第二N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图将压缩特征图/＞输入到第二N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图依次输入到第二N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图/＞与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图/＞将通道注意力特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图将特征图/＞和特征图/＞逐元素相加，得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第二N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图/＞与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-6)将空间注意力特征图/＞输入到第三卷积块中，输出得到压缩特征图/＞f-7)将压缩特征图/＞输入到第三N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图将压缩特征图/＞输入到第三N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图/＞依次输入到第三N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图/＞将通道注意力特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图输入到第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图S_MP_fit_45输入到第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图和特征图/＞逐元素相加，得到特征图将特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图输入到第三N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-8)将空间注意力特征图/＞输入到第四卷积块中，输出得到压缩特征图/＞f-9)将压缩特征图/＞输入到第四N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局平均池化层中，输出得到特征图将压缩特征图/＞输入到第四N_CSAM块的通道注意力层N_CAM的全局空间池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞与可训练参数α相乘得到不同权重表示的特征图将特征图/＞与可训练参数β相乘得到不同权重表示的特征图/＞将特征图/＞与特征图/＞逐元素相加后与超参数θ相乘得到特征图/＞将特征图特征图/＞特征图/＞逐元素相加操作，得到融合全局空间池化的特征图/＞将特征图依次输入到第四N_CSAM块的通道注意力层N_CAM的1D卷积层、Sigmoid激活函数层中，输出得到各通道的注意力权重系数图/＞将注意力权重系数图/＞与压缩特征图/＞进行逐元素相乘操作后，得到通道注意力特征图/＞通道注意力特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局平均池化层中，输出得到特征图将通道注意力特征图/＞输入到第三N_CSAM块的空间注意力层N_SAM的全局通道池化层的全局最大池化层中，输出得到特征图/＞将特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图/＞将特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层中，输出得到特征图将特征图S_AP_fit_63和特征图S_MP_fit_64逐元素相加，得到特征图/＞将特征图/＞输入到第四N_CSAM块的空间注意力层N_SAM的第二中心差分卷积层中，输出得到特征图/＞将特征图输入到第四N_CSAM块的空间注意力层N_SAM的Sigmoid激活函数层中，输出得到空间各位置的注意力权重系数图/＞将注意力权重系数图与通道注意力特征图/＞进行逐元素相乘后得到空间注意力特征图/＞f-10)将空间注意力特征图/＞输入到特征提取模块的全局平均池化层中，输出一条长度为空间注意力特征图/＞通道数量的特征向量在该实施例中，优选的，步骤f-2)中第一卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为16、步长为1×2，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-3)中第一N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，可训练参数α和可训练参数β由Adam优化器训练得来，第一N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为16、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；步骤f-4)中第二卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为32、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-5)中第二N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，可训练参数α和可训练参数β由Adam优化器训练得来，第二N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为32、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；骤f-6)中第三卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为64、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-7)中第三N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为3、步长为1、填充为1，超参数θ设置为0.5，可训练参数α和可训练参数β由Adam优化器训练得来，第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为64、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3；骤f-8)中第四卷积块的二维卷积Conv2d层的卷积核大小为3×3、通道数为128、步长为1，填充为1，最大池化层的尺寸为2×2、步长为2；步骤f-9)中第四N_CSAM块的通道注意力层N_CAM的1D卷积层的卷积核大小为5、步长为1、填充为2，超参数θ设置为0.5，可训练参数α和可训练参数β由Adam优化器训练得来，第三N_CSAM块的空间注意力层N_SAM的第一中心差分卷积层的卷积核大小为7×7、通道数为128、步长为1，填充为3，第二中心差分卷积层的卷积核大小为7×7、通道数为1、步长为1，填充为3。实施例7：步骤i)中rPPG信号聚合模块由一维卷积Conv1D层构成。实施例8：步骤j)中通过公式计算得到损失函数Loss，式中为第t帧图像的真实rPPG信号值。步骤j)中使用Adam优化器利用损失函数Loss训练神经网络模型CS_TrNet时设置学习率为0.001，视频批量batchsize大小为64，训练500个epoch，当连续10个epoch的损失函数值不再下降时，即可视为训练达到饱和，保存得到优化后的神经网络模型CS_TrNet。最后应说明的是：以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
