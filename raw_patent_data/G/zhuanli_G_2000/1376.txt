标题title
一种基于人工智能的实时交通路网短时交通流预测方法
摘要abst
本发明公开了一种基于人工智能的实时交通路网短时交通流预测方法，具体包括以下步骤：S1：获取固定区域的交通路网及交通流数据集；S2：对步骤S1中待处理的交通流数据集进行数据预处理，得到符合标准的交通流数据集；S3：利用层次聚类方法分析各种影响交通的因素数据和影响交通流的相关性，并确定多个影响交通流的关键因素；S4：利用步骤S2中的交通流数据集构建训练样本；S5：利用CNN‑LSTM模型进行模型训练；S6：得出任意一个路段在某个时刻的交通流预测值；S7：得出所有路段的预测值；S8：利用映射关系和压缩预测矩阵，得出路网预测值。该预测方法利用数据不断改善学习的效果，其准确性和适用性均较好。
权利要求书clms
1.一种基于人工智能的实时交通路网短时交通流预测方法，其特征在于，具体包括以下步骤：S1：获取固定区域的交通路网及交通流数据集；S2：对所述步骤S1中获得的交通流数据集进行数据预处理，获得预处理后的交通流数据集；S3：利用层次聚类方法分析各种影响交通的因素数据和影响交通流的相关性，并确定多个影响交通流的关键因素；S4：利用所述步骤S2中预处理后的交通流数据集构建训练样本，构造路网数据矩阵、交通流压缩矩阵和路网数据矩阵与交通流压缩矩阵的关系矩阵；S5：利用CNN-LSTM交通流量预测模型进行模型训练，得到特征向量；S6：利用特征向量得出所述固定区域内任意一个路段在某个时刻的交通流预测值；S7：根据所述步骤S6获得压缩矩阵中所有路段的交通流预测值，构成压缩预测矩阵；S8：利用映射关系即路网数据矩阵与交通流压缩矩阵的关系矩阵和压缩预测矩阵，获得路网预测值。2.根据权利要求1所述的基于人工智能的实时交通路网短时交通流预测方法，其特征在于，所述步骤S2中的数据预处理包括缺失值处理、离群和噪声值处理、异常范围及类型值处理，得到预处理后的交通流数据集；所述步骤S3中的各种影响交通的因素数据包括时间、天气和道路结构。3.根据权利要求2所述的基于人工智能的实时交通路网短时交通流预测方法，其特征在于，所述步骤S3的具体步骤为：S31：通过欧式距离计算因素点与交通流量的相似度，欧式距离的计算公式为：；其中：K表示因素点与交通流量的相似度，xi表示影响交通的因素数据，yi表示交通流量数据，i表示的时间间隔；S32：从因素点集合Z中顺序选取因素点B和因素点C；B，C∈Z；S33：计算因素点B和因素点C到交通流Y的平均距离D即因素点集合与交通流的相似度，计算公式为：；S34：分别重复计算因素点和交通流的相似度和因素点集合与交通流的相似度，最终根据阙值确定影响交通流的单独因素和组合因素。4.根据权利要求3所述的基于人工智能的实时交通路网短时交通流预测方法，其特征在于，所述步骤S4的具体步骤为：S41：将影响交通流的关键因素映射到高维空间，并将这些数据ID作独热编码；S42：设一个区域内的高速公路路网为一个网状图G，则有G=，其中N表示路网中的节点数，E为整个网络中所有路段的集合；假设该区域内的高速公路路网中有p个路段，则；对于任意一个路段Si都包含一个连续的时间序列，记为矩阵qi，则，其中qi表示路段Si在时间段t1到td的交通流量，表示路段Si在时间间隔/＞内的交通流量，j表示时间间隔中的任意值；该区域内的整个交通路网的交通流量则组成一个二维矩阵Q，则/＞；S43：通过计算得出相关系数矩阵R，计算公式为：；其中，与/＞绝对值的大小反映了路段Si和路段Sj之间的相关性，R表示该区域内的高速公路路网中任意两个路段的相关系数，d表示时间序列；tk表示时间序列中时间为k时刻；S44：再利用二维矩阵Q构造出压缩矩阵C，CNN-LSTM交通流量预测模型的训练数据矩阵为X，公式为：Q=CX；设训练数据矩阵X在不同时刻表示为Xt，测试数据集Et，则有：，/＞；其中i=1,2,……,p；Xi,t表示第i路段在t时刻的交通流量，任意一个路段的/＞时刻的流量由相邻几个路段当前时刻和前M时刻的交通流量来进行预测，p为该区域内的高速公路路网的路段个数；S45：再利用公式，求出路网矩阵W和压缩矩阵C的关系矩阵X；其中，/＞；d为24小时中任意时刻，p为该区域内的高速公路路网的路段个数，R表示该区域内的高速公路路网中任意两个路段的相关系数，r为压缩矩阵X的列数，C为路网矩阵W的压缩矩阵，CT为压缩矩阵C的转置矩阵。5.根据权利要求4所述的基于人工智能的实时交通路网短时交通流预测方法，其特征在于，在所述步骤S5中构建CNN-LSTM交通流量预测模型并训练的具体步骤为：S51：首先将所述步骤S44中的训练数据集Xt输入卷积神经网络CNN的卷积层对数据进行特征提取；S52：再通过最大池化层控制卷积神经网络的收敛性；S53：再通过长短期记忆网络LSTM从时间序列上学习交通流数据；S54：将所述步骤S51、步骤S52和步骤S53三个部分的输出进行归一化，然后赋予权重输入一个ReLU激活函数，再通过反向传播来更新权重；S55：最后得到特征向量为H，则，其中∅表示CNN-LSTM交通流量预测模型，Et为所述步骤S44中测试数据集；再通过所述步骤S44中的测试数据集Et测试是否满足精度要求，不满足则重复执行模型训练过程步骤S51~步骤S54，直至满足精度要求；满足输出特征向量为H。6.根据权利要求5所述的基于人工智能的实时交通路网短时交通流预测方法，其特征在于，在所述步骤S6中得出任意一个路段j在时刻的交通流预测值为，其中f为LSTM模型，j=1,2,……,p。7.根据权利要求6所述的基于人工智能的实时交通路网短时交通流预测方法，其特征在于，在所述步骤S7中，得出压缩矩阵C中所有路段的预测值，则构成压缩预测矩阵C’。8.根据权利要求7所述的基于人工智能的实时交通路网短时交通流预测方法，其特征在于，在所述步骤S8中，利用映射关系X和压缩预测矩阵C’，由公式Q=CX得出路网预测值Q。
说明书desc
技术领域本发明涉及交通技术领域，尤其涉及一种基于人工智能的实时交通路网短时交通流预测方法。背景技术随着公路交通的大力发展机动车保有量的迅速增长引发交通需求的快速增长，需要寻找方法对交通流进行预测，从而优化道路车辆，进一步便利车辆出行。智能交通系统作为一种高效、实时、准确的解决途径，得到了越来越多的关注。ITS是将信息技术、计算机技术、数据通信技术、传感器技术、电子控制技术、自动控制理论、运筹学、人工智能等先进的科学技术有效地综合运用于交通运输、服务控制和车辆制造，加强车辆、道路、使用者三者之间的联系，从而形成一种保障安全、提高效率、改善环境、节约能源的综合运输系统。在ITS的各组成要素中，交通流状态的分析和预测作为重要的基础理论，显得尤为重要。短时交通流预测是指基于获取的道路交通流状态数据的时间序列预测未来时间的交通流状态数据，一般采集周期≤15min，以适应交通控制与交通诱导的实时性要求。通过预测交通流不仅可以为公众出行提供服务，改善导航系统，还能进一步提高道路资源的利用率。因此，利用交通大数据进行短时交通流预测已成为智能交通领域的研究热点。目前，短时交通流预测方法主要有间序列法、卡尔曼滤波、混沌理论、神经网络和支持向量机等。影响交通流变化的因素多种多样，比如周末节假日、交通出行早晚高峰、天气状况等因素以非线性和随机性方式相互影响。传统方法在预测时往往只考虑目标路段在时间维上的交通流变量，没有考虑道路网络当中交通状况之间的时间-空间相关性，不足以准确反映城市交通流的复杂变化特征。发明内容本发明要解决的技术问题是提供一种基于人工智能的实时交通路网短时交通流预测方法，能够解决准确反映城市交通流的复杂变化特征以及路网预测值的问题。为了解决上述技术问题，本发明采用的技术方案是：该基于人工智能的实时交通路网短时交通流预测方法，具体包括以下步骤：S1：获取固定区域的交通路网及交通流数据集；S2：对所述步骤S1中获得的交通流数据集进行数据预处理，获得预处理后的交通流数据集；S3：利用层次聚类方法分析各种影响交通的因素数据和影响交通流的相关性，并确定多个影响交通流的关键因素；S4：利用所述步骤S2中预处理后的交通流数据集构建训练样本，构造路网数据矩阵、交通流压缩矩阵和路网数据矩阵与交通流压缩矩阵的关系矩阵；S5：利用CNN-LSTM交通流量预测模型进行模型训练，得到特征向量；S6：利用特征向量得出所述固定区域内任意一个路段在某个时刻的交通流预测值；S7：根据步骤S6获得压缩矩阵中所有路段的交通流预测值，构成压缩预测矩阵；S8：利用映射关系即路网数据矩阵与交通流压缩矩阵的关系矩阵和压缩预测矩阵，获得路网预测值。上述技术方案的基于人工智能的实时交通路网短时交通流预测方法，首先通过CNN模型对临近时间与路口的实时交通路网交通流聚合提取稳定的时空依赖特征，这样的聚合类似于残差结构，能在梯度传播中保持梯度传导的通路，使得预测方法不会出现梯度消失和梯度爆炸问题，进一步使用LSTM抽取时间依赖也能通过门控机制有效缓解梯度消失和梯度爆炸问题。实验结果也表明，模型能够有效抽取交通流的稳定时空特征，有效预测短时间内的交通流量变化。该基于人工智能的实时交通路网短时交通流预测方法是基于端到端的交通流预测方法，应用了卷积神经网络和长短期记忆人工神经网络的技术，通过深度学习确定交通路网流量，实现了实时预测选定区域内的全路网交通流量目的；本发明实现路网交通流量的智能预测为道路使用者提供实时的、有价值的参考信息，帮助用户选择更优的出行路径；同时本发明也可实现预测道路交通拥堵的时间和地点，运输从业者可以提前选择优化路径，减少道路拥堵。优选的，所述步骤S2中的数据预处理包括缺失值处理、离群和噪声值处理、异常范围及类型值处理，得到预处理后的交通流数据集。优选的，所述步骤S3中各种影响交通的因素数据包括时间、天气和道路结构。优选的，所述步骤S3的具体步骤为：S31：通过欧式距离计算因素点与交通流量的相似度，欧式距离的计算公式为：；其中：K表示相似度，xi表示影响交通的因素数据，yi表示交通流量数据，i表示的时间间隔；S32：从包含时间、天气和道路结构的因素点集合Z中顺序选取因素点B和因素点C；B，C∈Z；S33：计算因素点B和因素点C到交通流Y的平均距离D即因素点集合与交通流的相似度，计算公式为：；S34：分别重复计算因素点和交通流的相似度和因素点集合与交通流的相似度，最终根据阙值确定影响交通流的单独因素和组合因素。优选的，所述步骤S4的具体步骤为：S41：将影响交通流的关键因素映射到高维空间，并将这些数据ID作独热编码；S42：设一个区域内的高速公路路网为一个网状图G，则有G=，其中N表示路网中的节点数，E为整个网络中所有路段的集合；假设该区域内的高速公路路网中有p个路段，则；对于任意一个路段Si都包含一个连续的时间序列，记为矩阵qi，则，其中qi表示路段Si在时间段t1到td的交通流量，表示路段Si在时间间隔/＞内的交通流量，j表示时间间隔中的任意值；该区域内的整个交通路网的交通流量则组成一个二维矩阵Q，则/＞；S43：通过计算得出相关系数矩阵R，计算公式为：；其中，与/＞绝对值的大小反映了路段Si和路段Sj之间的相关性，R表示该区域内的高速公路路网中任意两个路段的相关系数，d表示时间序列；tk表示时间序列中时间为k时刻；S44：再利用二维矩阵Q构造出压缩矩阵C，CNN-LSTM交通流量预测模型的训练数据矩阵为X，公式为：Q=CX；设训练数据矩阵X在不同时刻表示为Xt，测试数据集Et，则有：，；其中i=1,2,……,p；Xi,t表示第i路段在t时刻的交通流量，任意一个路段的/＞时刻的流量由相邻几个路段当前时刻和前M时刻的交通流量来进行预测，p为该区域内的高速公路路网的路段个数；S45：再利用公式，求出路网矩阵W和压缩矩阵C的关系矩阵X；其中，/＞；d为24小时中任意时刻，p为该区域内的高速公路路网的路段个数，R表示该区域内的高速公路路网中任意两个路段的相关系数，r为压缩矩阵X的列数，C为路网矩阵W的压缩矩阵，CT为压缩矩阵C的转置矩阵。优选的，在所述步骤S5中构建CNN-LSTM交通流量预测模型并训练的具体步骤为：S51：首先将所述步骤S44中的训练数据集Xt输入卷积神经网络CNN的卷积层对数据进行特征提取；S52：再通过最大池化层控制卷积神经网络的收敛性；S53：再通过长短期记忆网络LSTM从时间序列上学习交通流数据；S54：将所述步骤S51、步骤S52和步骤S53三个部分的输出进行归一化，然后赋予权重输入一个ReLU激活函数，再通过反向传播来更新权重；S55：最后得到特征向量为H，则，其中∅表示CNN-LSTM交通流量预测模型，Et为所述步骤S44中测试数据集；再通过所述步骤S44中的测试数据集Et测试是否满足精度要求，不满足则重复执行模型训练过程步骤S51~步骤S54，直至满足精度要求；满足输出特征向量为H。其中满足精度要求为要求预测精度与实际精度的均方根误差和平均误差趋近于0，本方法要求均方根误差小于9.0，平均误差小于8.0。优选的，在所述步骤S6中得出任意一个路段j在时刻的交通流预测值为，其中f为LSTM模型，j=1,2,……,p。优选的，在所述步骤S7中，得出压缩矩阵C中所有路段的预测值，则构成压缩预测矩阵C’。优选的，在所述步骤S8中，利用映射关系X和压缩预测矩阵C’，由公式Q=CX得出路网预测值Q。与现有技术相比，本发明具有的有益效果为：人工智能方法不受限于固定的模型结构，能够从数据中自动提取特征进行分析，并利用数据不断改善学习的效果，其准确性和适用性均较好；真实的交通流数据是稀疏矩阵，难以直接分析，本发明通过求解压缩矩阵，不仅有效降低输入数据的复杂度，更有利于模型抽取稳定的时空依赖特征；通过将附近路口的临近时间点的交通流量聚合提取隐变量，有效融合交通流的时空信息，利用LSTM来分析交通流的时间变化关系，实现对短时交通流量的有效预测。附图说明图1为本发明的基于人工智能的实时交通路网短时交通流预测方法的流程图。实施方式下面将结合本发明的实施例图中的附图，对本发明实施例中的技术方案进行清楚、完整的描述。实施例：如图1所示，该基于人工智能的实时交通路网短时交通流预测方法，具体包括以下步骤：S1：获取固定区域的交通路网及交通流数据集；S2：对所述步骤S1中获得的交通流数据集进行数据预处理，获得预处理后的交通流数据集；所述步骤S2中的数据预处理包括缺失值处理、离群和噪声值处理、异常范围及类型值处理，得到预处理后的交通流数据集；S3：利用层次聚类方法分析各种影响交通的因素数据和影响交通流的相关性，并确定多个影响交通流的关键因素；所述步骤S3中的各种影响交通的因素数据包括时间、天气和道路结构；所述步骤S3的具体步骤为：S31：通过欧式距离计算因素点与交通流量的相似度，欧式距离的计算公式为：；其中：K表示因素点与交通流量的相似度，xi表示影响交通的因素数据，yi表示交通流量数据，i表示的时间间隔；S32：从包含时间、天气和道路结构的因素点集合Z中顺序选取因素点B和因素点C；B，C∈Z；S33：计算因素点B和因素点C到交通流Y的平均距离D即因素点集合与交通流的相似度，计算公式为：；S34：分别重复计算因素点和交通流的相似度和因素点集合与交通流的相似度，最终根据阙值确定影响交通流的单独因素和组合因素；S4：利用所述步骤S2中预处理后的交通流数据集构建训练样本，构造路网数据矩阵、交通流压缩矩阵和路网数据矩阵与交通流压缩矩阵的关系矩阵；所述步骤S4的具体步骤为：S41：将影响交通流的关键因素映射到高维空间，并将这些数据ID作独热编码；S42：设一个区域内的高速公路路网为一个网状图G，则有G=，其中N表示路网中的节点数，E为整个网络中所有路段的集合；假设该区域内的高速公路路网中有p个路段，则；对于任意一个路段Si都包含一个连续的时间序列，记为矩阵qi，则，其中qi表示路段Si在时间段t1到td的交通流量，表示路段Si在时间间隔/＞内的交通流量，j表示时间间隔中的任意值；该区域内的整个交通路网的交通流量则组成一个二维矩阵Q，则/＞；S43：通过计算得出相关系数矩阵R，计算公式为：；其中，与/＞绝对值的大小反映了路段Si和路段Sj之间的相关性，R表示该区域内的高速公路路网中任意两个路段的相关系数，d表示时间序列；tk表示时间序列中时间为k时刻；S44：再利用二维矩阵Q构造出压缩矩阵C，CNN-LSTM交通流量预测模型的训练数据矩阵为X，公式为：Q=CX；设训练数据矩阵X在不同时刻表示为Xt，测试数据集Et，则有：，；其中i=1,2,……,p；Xi,t表示第i路段在t时刻的交通流量，任意一个路段的/＞时刻的流量由相邻几个路段当前时刻和前M时刻的交通流量来进行预测，p为该区域内的高速公路路网的路段个数；S45：再利用公式，求出路网矩阵W和压缩矩阵C的关系矩阵X；其中，/＞；d为24小时中任意时刻，p为该区域内的高速公路路网的路段个数，R表示该区域内的高速公路路网中任意两个路段的相关系数，r为压缩矩阵X的列数，C为路网矩阵W的压缩矩阵，CT为压缩矩阵C的转置矩阵；S5：利用CNN-LSTM交通流量预测模型进行模型训练，得到特征向量；在所述步骤S5中构建CNN-LSTM交通流量预测模型并训练的具体步骤为：S51：首先将所述步骤S44中的训练数据集Xt输入卷积神经网络CNN的卷积层对数据进行特征提取；S52：再通过最大池化层控制卷积神经网络的收敛性；S53：再通过长短期记忆网络LSTM从时间序列上学习交通流数据；S54：将所述步骤S51、步骤S52和步骤S53三个部分的输出进行归一化，然后赋予权重输入一个ReLU激活函数，再通过反向传播来更新权重；S55：最后得到特征向量为H，则，其中∅表示CNN-LSTM交通流量预测模型，Et为所述步骤S44中测试数据集；再通过所述步骤S44中的测试数据集Et测试是否满足精度要求，其中满足精度要求为要求预测精度与实际精度的均方根误差和平均误差趋近于0，本实施例要求均方根误差小于9.0，平均误差小于8.0；不满足则重复执行模型训练过程步骤S51~步骤S54，直至满足精度要求；满足输出特征向量为H；S6：利用特征向量得出所述固定区域内任意一个路段在某个时刻的交通流预测值；在所述步骤S6中得出任意一个路段j在时刻的交通流预测值为，其中f为LSTM模型，j=1,2,……,p；S7：根据步骤S6获得压缩矩阵中所有路段的交通流预测值，构成压缩预测矩阵；在所述步骤S7中，得出压缩矩阵C中所有路段的预测值，则构成压缩预测矩阵C’；S8：利用映射关系即路网数据矩阵与交通流压缩矩阵的关系矩阵和压缩预测矩阵，获得路网预测值；在所述步骤S8中，利用映射关系X和压缩预测矩阵C’，由公式Q=CX得出路网预测值Q。本发明提出利用CNN模型抽取交通流点的时空依赖，通过将附近路口的临近时间点的交通流量聚合提取隐变量，有效融合交通流的时空信息，进一步利用LSTM来分析交通流的时间变化关系，实现对短时交通流量的有效预测。对比传统的预测模型容易出现梯度消失和梯度爆炸问题，本发明首先通过CNN模型对临近时间与路口的实时交通路网交通流聚合提取稳定的时空依赖特征，这样的聚合类似于残差结构，能在梯度传播中保持梯度传导的通路，使得预测方法不会出现梯度消失和梯度爆炸问题，进一步使用LSTM抽取时间依赖也能通过门控机制有效缓解梯度消失和梯度爆炸问题。实验将CNN、LSTM、ARIMA和本发明提出的CNN-LSTM交通流量预测模型分别应用在江苏省南京市绕城收费站2020年5月至2021年5月收费数据上，结果显示绝对误差平均值MAE对比CNN、LSTM、ARIMA精度显著提升，表明CNN-LSTM交通流量预测模型能够有效抽取交通流的稳定时空特征，有效预测短时间内的交通流量变化，具体的对比数据如下表1所示。表1 不同模型的短端时间交通流量评估结果算法R2平均百分比误差绝对误差平均值均方根误差CNN0.9560.29633.3634.215LSTM0.9850.15119.7328.612ARIMA0.9770.24524.1332.227CNN-LSTM0.9880.10116.8524.147以上所述仅为本发明的较佳实施例而已，并不用于限制本发明，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
