标题title
一种次日光伏发电预测方法及系统
摘要abst
本发明公开了一种次日光伏发电预测方法及系统，包括下述步骤：1）收集长期的光伏发电过程中的发电功率数据，以及实测气象数据，并合并进行预处理作为实测数据，同时收集长期的数值气象预测数据并进行预处理以得到数据集；2）划分数据集；将数据集划分为若干个训练集域，一个验证数据集，与一个测试数据集；3）构建主干编码网络模型；4）对不同域内的样本分别进行编码和预测；5）计算总和损失函数，进行域泛化迁移学习训练。通过对数值气象预测数据进行修正，提升基于数值气象预测的次日光伏预测准确率；消除季节性波动对于光伏功率预测的影响；通过多种辅助损失函数设计，实现光伏气象数据的鲁棒表示。
权利要求书clms
1.一种次日光伏发电预测方法，其特征在于，包括下述步骤：1）收集长期的光伏发电过程中的发电功率数据，以及实测气象数据，并合并进行预处理作为实测数据，同时收集长期的数值气象预测数据并进行预处理以得到数据集；2）划分数据集；将数据集划分为若干个训练集域，一个验证数据集，与一个测试数据集；3）构建主干编码网络模型；使用主干编码网络对实测数据、数值气象预测数据分别进行编码、季节性分解，并进行次日光伏发电预测；同时，施加季节正则化操作，以修正数值气象预测数据的系统性误差；4）对不同域内的样本分别进行编码和预测；计算不同域的气象表征之间的差值，作为域间距离损失函数；5）计算总和损失函数，进行域泛化迁移学习训练。2.根据权利要求1所述的方法，其特征在于，步骤2）具体内容为：取最新的一个月数据作为测试数据集，次新的一个月数据作为验证数据集，其余的数据作为训练数据集，训练集中，每6周划分为一个域，共计划分为若干个域。3.根据权利要求2所述的方法，其特征在于，步骤3）具体内容为：设定主干编码网络模型的输入数据为过往天的实测数据与数值气象预测数据，以及次日的数值气象预测数据，过往/＞天的实测数据记为/＞，其中/＞表示前第/＞天的实测数据，/＞是一天内的数据长度，是实测数据特征数，过往/＞天的数值气象预测数据记为，其中/＞表示前第/＞天的数值气象预测数据，/＞是数值气象预测数据特征数，次日的数值气象预测数据表示为，以上角标/＞和/＞分别代表数值气象预测数据特征与实测数据特征，且/＞代表实数域；主干编码网络模型采用双向LSTM网络作为编码网络；编码网络由2层双向LSTM层堆叠而成，对每层LSTM的输出施加LeakyReLU激活函数和批归一化操作，采用实测数据编码器对实测数据进行编码，其操作记为；采用数值气象预测数据编码器对数值气象预测数据进行编码，其操作记为/＞；得到/＞天历史实测数据编码/＞，前一日实测数据编码/＞，/＞天历史数值气象预测数据编码/＞，前一日数值气象预测数据编码/＞，以及次日数值气象预测数据编码/＞如下所示：，，，，，令编码器的输出维度为，则历史实测数据编码和历史数值气象预测数据编码表示为，其中/＞表示最近第/＞天的实测数据编码，/＞表示最近第/＞天的数值气象预测数据编码，；计算实测数据编码和数值气象预测数据编码的/＞天编码均值/＞和如下：,,以前一日的实测数据编码和数值气象预测数据编码减去天编码均值，得到实测数据波动编码和数值气象预测数据波动编码/＞如下：,,计算两个波动编码之间的分布距离作为季节正则化项：,其中代表MMD损失函数，上述操作的目的是控制实测数据波动编码和数值气象预测数据波动编码之间的分布距离，以消除数值气象预测数据系统误差；构建光伏气象编码，并进行次日光伏预测/＞的操作为：,,其中为两层深度神经网络的前向运算，/＞是向量拼接操作；若实际次日光伏预测值为/＞，则训练过程中，预测损失函数/＞为：。4.根据权利要求3所述的方法，其特征在于，步骤4）具体内容为：在步骤2）中将训练数据集划分为了若干域，编号为，其中/＞为域数量，且下标越小，表示该域在时间上更临近验证数据集和测试数据集；而通过步骤3），实现对每个域内的样本的编码和预测；令不同域中的样本，通过编码器得到的光伏气象编码为，其中/＞为域/＞的样本光伏气象编码，/＞为/＞在时间步/＞的值，/＞为在时间步/＞的值，对于域/＞和域/＞,/＞，其样本光伏气象编码间的分布距离作为域间距损失函数/＞：,其中表示Coral损失函数。5.根据权利要求4所述的方法，其特征在于，步骤5）具体内容为：综合预测损失函数、季节正则化项、域间损失函数，计算总和损失函数如下：,其中是设定的超参数，通过最小化总和损失函数进行模型训练，训练过程中在验证数据集上评估模型性能，当模型在验证数据集上达到性能最优时结束训练，以最优模型作为最终训练模型。6.一种与权利要求1-5任一项所述的次日光伏发电预测方法对应的次日光伏发电预测系统，其特征在于，包括下述模块：1）数据收集模块，其功能是收集光伏发电过程中的实测气象数据和发电功率数据两者构成实测数据，以及数值气象预测数据；2）功率预测模块，其功能是对数值气象预测数据和实测数据进行编码，同时采用季节正则化操作，以消除数值气象预测数据的系统性误差，并提供功率预测；3）模型优化模块，其功能是对功率预测模块进行训练优化；次日光伏发电预测系统在运行中，将定期调用模型优化模块，通过采集的实测数据与数值气象预测数据，构建训练数据，并利用这些数据进行域泛化迁移学习，对模型训练优化。
说明书desc
技术领域本发明属于新能源发电技术领域，尤其涉及一种次日光伏发电预测方法及系统。背景技术由于光伏发电可以将太阳能直接转化为电力，正在世界上得到了越来越多的应用。然而，其能源通常不稳定，其实际发电量在现实中也不稳定。光伏发电的波动性给电网系统调度、电力平衡、负荷预测和配电网运营带来了巨大挑战。为了保证电网的稳定运行，进行光伏功率预测具有重要意义。同时，通过收集更多有利的信息将有助于提升光伏的功率预测精度。在未来几个小时的预测中，实地天空云量图和卫星云图可以有效提高预测精度。而在次日预报中，则需要借助数值天气预报数据来了解气象变化。然而，由于一些客观因素的限制，无法保证NWP数据的精度。首先，由于天气预报不仅仅用于光伏发电预测，最终训练的模型在预测与光伏发电相关的特征方面可能不是最准确的。其次，天气预报通常是保守的，对于极端天气和剧烈变化趋势的预测非常有限。最后，由于计算复杂度高，天气预报往往是针对附近的一些典型位置，而与相关光伏站有一定的偏差，且无法考虑地形和其他位置因素。此外，气象数据的季节性变化给光伏发电量预测带来了巨大挑战。在传统的监督学习下，训练集、验证集和测试集的内部时间跨度大，通常超过一个月，这导致它们的分布严重不一致；传统的机器学习算法假设训练数据集和测试数据集是独立且同分布的。因此，只有当测试数据与训练数据来自同一分布时，传统的自监督机器学习才能很好地工作。但由于真实世界的数据经常随着时间和空间的变化而变化，这种假设在实践中很少成立。对于光伏发电功率预测任务，许多基于机器学习或深度学习的方法根据测量的当前天气和天气变化来预测光伏功率。首先用于光伏发电功率预测的是时间序列分析方法，如自回归移动平均、自回归积分移动平均，以及递归神经网络、长短期记忆网络以及卷积神经网络的一些变体。最近，包括基于自注意力机制的方法问世，大大提高了长期预测的能力。为了解决光伏气象数据的分布不匹配问题，人们提出了基于迁移学习的方法。其中，域自适应试图通过将有效信息从源域转移到目标域。然而，由于验证集和测试集之间总是存在分布差异，域自适应方法无法从根本上解决问题。基于此考量，本发明采用域泛化迁移学习，因为光伏功率预测需要更多的域内不变特征表示，而不是学习域间的特征转移，以便将不同季节的气象和功率数据有效地映射到公共特征空间中。发明内容针对现有技术中的不足，本发明提出一种次日光伏发电预测方法及系统，通过对数值气象预测数据进行修正，提升基于数值气象预测的次日光伏功率预测准确率；消除季节性波动对于光伏功率预测的影响；通过多种辅助损失函数设计，实现光伏气象数据的鲁棒表示。本发明的具体方案如下：一种次日光伏发电预测方法，包括下述步骤： 1）收集长期的光伏发电过程中的发电功率数据，以及实测气象数据，并合并进行预处理作为实测数据，同时收集长期的数值气象预测数据并进行预处理以得到数据集； 2）划分数据集；将数据集划分为若干个训练集域，一个验证数据集，与一个测试数据集；3）构建主干编码网络模型；使用主干编码网络对实测数据、数值气象预测数据分别进行编码、季节性分解，并进行次日光伏发电预测；同时，施加季节正则化操作，以修正数值气象预测数据的系统性误差；4）对不同域内的样本分别进行编码和预测；计算不同域的气象表征之间的差值，作为域间距离损失函数；5）计算总和损失函数，进行域泛化迁移学习训练。进一步，步骤2）具体内容为：取最新的一个月数据作为测试数据集，次新的一个月数据作为验证数据集，其余的数据作为训练数据集，训练集中，每6周划分为一个域，共计划分为若干个域。进一步，步骤3）具体内容为：设定主干编码网络模型的输入数据为过往天的实测数据与数值气象预测数据，以及次日的数值气象预测数据，过往/＞天的实测数据记为/＞，其中/＞表示前第/＞天的实测数据，/＞是一天内的数据长度，是实测数据特征数，过往/＞天的数值气象预测数据记为/＞，其中/＞表示前第/＞天的数值气象预测数据，/＞是数值气象预测数据特征数，次日的数值气象预测数据表示为/＞，以上角标/＞和/＞分别代表数值气象预测数据特征与实测数据特征，且/＞代表实数域；主干编码网络模型采用双向LSTM网络作为编码网络；编码网络由2层双向LSTM层堆叠而成，对每层LSTM的输出施加LeakyReLU激活函数和批归一化操作，采用实测数据编码器对实测数据进行编码，其操作记为；采用数值气象预测数据编码器对数值气象预测数据进行编码，其操作记为/＞；得到/＞天历史实测数据编码/＞，前一日实测数据编码/＞，/＞天历史数值气象预测数据编码/＞，前一日数值气象预测数据编码/＞，以及次日数值气象预测数据编码/＞如下所示：，，，，，令编码器的输出维度为，则历史实测数据编码和历史数值气象预测数据编码表示为/＞，其中表示最近第/＞天的实测数据编码，/＞表示最近第/＞天的数值气象预测数据编码，/＞。计算实测数据编码和数值气象预测数据编码的/＞天均值和/＞如下：，，以前一日的实测数据编码和数值气象预测数据编码减去天编码均值，得到波动编码/＞如下：，，计算两个波动编码之间的分布距离作为季节正则化项：，其中代表MMD损失函数，上述操作的目的是控制实测数据波动编码和数值气象预测数据波动编码之间的分布距离，以消除数值气象预测数据系统误差；构建光伏气象编码，并进行次日光伏预测的操作为：，，其中为两层深度神经网络的前向运算，/＞是向量拼接操作；若实际次日光伏预测值为/＞，则训练过程中，预测损失函数/＞为：。进一步，步骤4）具体内容为：在步骤2）中将训练数据集划分为了若干域，编号为，其中/＞为域数量，且下标越小，表示该域在时间上更临近验证数据集和测试数据集；而通过步骤3），实现对每个域内的样本的编码和预测；令不同域中的样本，通过编码器得到的光伏气象编码为/＞，其中/＞为域/＞的样本光伏气象编码，为/＞在时间步/＞的值，/＞为/＞在时间步/＞的值。对于域/＞和域/＞，其样本气象编码间的分布距离作为域间距损失函数/＞：，其中表示Coral损失函数。进一步，步骤5）具体内容为：综合预测损失函数、季节正则化项、域间损失函数，计算总和损失函数如下：，其中是设定的超参数，通过最小化总和损失函数进行模型训练，训练过程中在验证数据集上评估模型性能，当模型在验证数据集上达到性能最优时结束训练，以最优模型作为最终训练模型。本发明还提出一种次日光伏发电预测系统，包括下述模块： 1）数据收集模块，其功能是收集光伏发电过程中的实测气象数据和发电功率数据两者构成实测数据，以及数值气象预测数据； 2）功率预测模块，其功能是对数值气象预测数据和实测数据进行编码，同时采用季节正则化操作，以消除数值气象预测数据的系统性误差，并提供功率预测； 3）模型优化模块，其功能是对功率预测模块进行训练优化；次日光伏发电预测系统在运行中，将定期调用模型优化模块，通过采集的实测数据与数值气象预测数据，构建训练数据，并利用这些数据进行域泛化迁移学习，对模型训练优化。本发明具有以下有益技术效果： 1）在本发明对气象特征进行分解，以提取平均季节特征的影响。采用季节正则化运算来减弱数值天气预报与实际天气之间的系统误差，从而更准确地学习气象表示。2）本发明采用领域泛化迁移学习来学习气象特征的季节不变特征，消除了季节气象变化导致的数据集分布不一致的问题。附图说明图1 为次日光伏发电预测方法示意图；图2 为次日光伏发电预测系统示意图。具体实施方式本发明提供了一种次日光伏发电预测方法及系统。通过季节分解，抽取出关键的光伏气象成分；并采用相应的季节正则化，消除了数值气象数据的系统性误差问题；通过域泛化迁移学习，学习光伏气象特征的季节不变性特征，避免了数据集特征分布不匹配带来的模型过训练问题。实施例一 该方法的示意图如图1所示，本发明提供了一种次日光伏发电预测方法，包括下述步骤： 1）收集长期的光伏发电过程中的发电功率数据，以及实测气象数据，并合并进行预处理作为实测数据。同时收集长期的数值气象预测数据并进行预处理以得到数据集。2）划分数据集。将数据集划分为若干个训练集域，一个验证数据集，与一个测试数据集。3）构建主干编码网络模型。使用主干编码网络对实测数据、数值气象预测数据分别进行编码、季节性分解，并进行次日光伏预测。同时，施加季节正则化操作，以修正数值气象预测数据的系统性误差。4）对不同域内的样本分别进行编码和预测。计算不同域的气象表征之间的差值，作为域间距离损失函数。5）计算总和损失函数，进行域泛化迁移学习训练。步骤2），具体内容为：取最新的一个月数据作为测试数据集，次新的一个月数据作为验证数据集，其余的数据作为训练数据集。训练数据集中，每6周划分为一个域。共计划分为若干个域。步骤3），具体内容为：设定模型的输入数据为过往天的实测数据LMD与数值气象预测数据NWP，以及次日的数值气象预测数据。过往/＞天的LMD数据记为/＞，其中表示前第/＞天的LMD数据，/＞是一天内的数据长度。/＞是LMD特征数。过往/＞天的NWP数据记为/＞，其中表示前第/＞天的NWP数据，/＞是NWP特征数。次日的NWP数据表示为/＞。模型采用双向LSTM网络作为编码网络。编码网络由2层双向LSTM层堆叠而成，对每层LSTM的输出施加LeakyReLU激活函数和批归一化操作。采用LMD编码器对LMD数据进行编码，其操作记为。采用NWP编码器对NWP数据进行编码，其操作记为/＞。得到/＞天历史LMD编码/＞，前一日LMD编码/＞，历史/＞天NWP编码，前一日NWP编码/＞，以及次日NWP编码/＞如下所示：，，，，，令编码器的输出维度为，则历史LMD编码和历史NWP编码可以表示为。其中/＞表示最近第/＞天的LMD编码，/＞表示最近第/＞天的NWP编码，/＞。计算LMD编码和NWP编码的/＞天均值/＞和/＞如下：，，以前一日的LMD编码和NWP编码减去天编码均值，得到波动编码/＞如下：，，计算两个波动编码之间的分布距离作为季节正则化项：， 其中代表MMD损失函数。上述操作的目的是控制LMD波动编码和NWP波动编码之间的分布距离，以消除NWP系统误差。构建光伏气象编码，并进行次日光伏预测/＞的操作为：，，其中为两层深度神经网络的前向运算，/＞是向量拼接操作。若实际次日光伏预测值为/＞，则训练过程中，预测损失函数/＞为：，步骤4），具体内容为：在步骤2）中将训练数据集划分为了若干域，编号为，其中/＞为域数量，且下标越小，表示该域在时间上更临近验证数据集和测试数据集。而通过步骤3），可以实现对每个域内的样本的编码和预测。令不同域中的样本，通过编码器得到的光伏气象编码为/＞，其中/＞为域/＞的样本气象编码，/＞为在时间步/＞的值，/＞为/＞在时间步/＞的值。对于域/＞和域/＞，其样本编码间的分布距离作为域间距损失函数/＞：， 其中表示Coral损失函数。步骤5），具体内容为：综合预测损失函数、季节正则化项、域间损失函数，计算总和损失函数如下：，其中是设定的超参数。通过最小化总和损失函数进行模型训练。训练过程中在验证数据集上评估模型性能，当模型在验证数据集上达到性能最优时结束训练，以最优模型作为最终训练模型。其中，训练的具体步骤如下： ⅰ构建验证数据集，测试数据集，和若干域数据集；设置批大小。初始化主干编码网络。ⅱ对每个域数据集，打乱内部样本。ⅲ从所有域数据集中各抽取一批数据，输入主干编码网络，得到每个域下的样本编码和预测值，计算预测损失函数和季节正则化项。ⅳ计算各域样本的编码值的分布差异，作为域间损失函数。ⅴ计算总和损失函数，更新主干编码网络参数。ⅵ判断训练数据是否全部抽取完毕。若抽取完毕，进入步骤vii）；否则进入步骤iii）。ⅶ验证集上进行模型性能验证，判断性能是否下降。当性能下降，进入步骤viii）；否则，进入步骤ii）。ⅷ训练结束，并在测试集上进行测试，输出最终模型性能。实施例二 本发明提供了一种次日光伏发电预测系统，包括下述模块： 1）数据收集模块，其功能是收集光伏发电过程中的实测气象数据和发电功率数据 即LMD数据，以及数值气象预测数据即NWP数据。2）功率预测模块，其功能是对LMD数据和NWP数据进行编码，同时采用季节正则化操作，以消除NWP数据的系统性误差，并提供功率预测。3）模型优化模块，其功能是对功率预测模块进行训练优化。该次日光伏发电预测系统的运行中，将定期调用模型优化模块，通过采集的长期LMD数据与NWP数据，构建训练数据，并利用这些数据进行域泛化迁移学习，对模型训练优化。该系统的示意图如图2所示。提供以上实施例仅仅是为了描述本发明的目的，而并非要限制本发明的范围。本发明的范围由所附权利要求限定。不脱离本发明的精神和原理而做出的各种等同替换和修改，均应涵盖在本发明的范围之内。
