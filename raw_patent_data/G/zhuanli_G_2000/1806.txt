标题title
基于角度斜率指数的林火判别方法、系统、设备以及介质
摘要abst
本发明涉及一种基于角度斜率指数的林火判别方法、系统、设备以及介质，其方法包括：获取目标区域的波段组合影像；对波段组合影像进行检测得到林地区域影像；构建角度斜率指数；基于角度斜率指数和火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别；排除干扰点后输出火点。本发明充分利用卫星影像光谱波段及波段之间的强相关性构建新的森林火点判别指数，同时针对不同区域中背景的差异采用分解的三维OTSU自适应阈值分割算法来进行森林火灾火点判别，以提高火点识别的准确度。
权利要求书clms
1.一种基于角度斜率指数的林火判别方法，其特征在于，包括：获取目标区域的遥感卫星的波段组合影像；对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像；根据波段组合影像中的各个波段之间的相关性、火灾发生前后的可见光波段、红外波段的反射率以及亮温值变化构建角度斜率指数；基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别；对火点判别结果进行非林火干扰点排除之后，输出林地区域影像的火点。2.如权利要求1所述的基于角度斜率指数的林火判别方法，其特征在于，获取目标区域的遥感卫星的波段组合影像包括：采集Himawari-8卫星的多个波段数据以形成波段组合影像；对波段组合影像进行包含目标区域剪裁、几何校正、辐射矫正的预处理，再遍历提取波段组合影像中每个网格的反射率数据和亮温数据。3.如权利要求2所述的基于角度斜率指数的林火判别方法，其特征在于，对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像包括：利用Himawari-8卫星03、04和05波段的反射率数据及07、14、16波段的亮温数据的不同阈值条件分别检测厚云、高云和中低云，并通过晴空修复公式对云检测结果中标记为云点的像元进行晴空修复，得到云检测最终结果；利用从公共数据库调取的30米精度全球地表覆盖分类数据进行水体检测，得到水体检测结果；利用从公共数据库调取的30米精度全球地表覆盖分类数据和Himawari-8卫星03、04波段的反射率数据进行林地识别，得到林地识别结果；其中，厚云检测的阈值条件为：ρ03＞0.3，或者高云检测的阈值条件为：BT16＜236K，或者；中低云检测的阈值条件为：BT14＜278K，或者BT7-BT14＞20K；ρ表示可见光通道反射率，BT表示热红外通道亮温；晴空修复公式为：-0.18≤NDVI≤0.2；林地识别满足：NDVI＞0.45，或者30米全球地表覆盖分类数据中地表覆盖类型为林地；NDVI＝/，BA03、BA04分别为03、04波段的反射率。4.如权利要求1所述的基于角度斜率指数的林火判别方法，其特征在于，角度斜率指数为：|B03B04|2＝2+2|B04B05|2＝2+2|B03B05| 2＝2+2|B06B07|2＝2+2|B07B08|2＝2+2|B06B08|2＝2+2其中，AMIR、ANIR分别为中红外角度斜率指数和近红外角度指数，B03B04、B04B05、B03B05、B06B07、B07B08、B06B08分别表示在设定坐标系中各波段对应的顶点之间的距离，x值为波段编号，y值分别为01～06波段的反射率数据和07～16波段的亮温数据；预先设置的火点阈值为：AMIR＞0.96；AMIR＞0.95且ANIR＜0；AMIR＞0.95，或者T7＞315K；其中，T7＞315K这项条件应用在可见光波部分不起作用的时段。5.如权利要求4所述的基于角度斜率指数的林火判别方法，其特征在于，基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别包括：获取包含至少两张火灾发生前后时序的林地区域影像的多时序影像；求取火灾发生后的当前时序影像的AMIR、ANIR指数，并基于AMIR、ANIR指数构建AMIR-ANIR的影像；针对影像不同区域和环境中的背景差异，采用分解的三维OTSU算法计算AMIR-ANIR的影像的自适应阈值，并依据自适应阈值对AMIR-ANIR的影像进行图像分割，得到的不同地域的火点目标影像；求取当前时序影像中的不同地域的火点目标影像与多时序影像中邻近时序的火灾之前的影像之间的角度斜率差指数，结合预设的指数差阈值判断火点目标影像是否为火点，输出火点判别结果；其中，角度斜率差指数为：ΔANIRt＝ANIRt2-ANIRt1ΔAMIRt＝AMIRt1-AMIRt2式中，ANIRt1、AMIRt1表示多时序影像中火灾发生前一景的近红外角度斜率指数和中红外角度斜率指数，ANIRt2、AMIRt2表示多时序影像中火灾发生后一景的近红外角度斜率指数和中红外角度斜率指数，ΔANIRt、ΔAMIRt表示前后两景的近红外角度斜率指数差和中红外角度斜率指数差；指数差阈值为：ΔAMIRt＞0.03且ΔANIRt＞1.0；ΔAMIRt＞0.03或者ΔT7＞10K；其中，ΔT7＞10K这项条件应用在可见光波部分不起作用的时段。6.如权利要求1所述的基于角度斜率指数的林火判别方法，其特征在于，采用分解的三维OTSU算法计算自适应阈值是通过如下阈值判别公式实施：其中，s是将一组离散的数据分为两类的值，当G取最大值所对应的灰度级即为s所求的最佳阈值S0，即S0＝argmax)，W0、W1分别是目标和背景数据所占的概率，sb为类间距离，sb＝|μ1-μ0|，μ1，μ0是目标和背景数据对应各自类别元素均值；sw为总体类内距离，sw＝w0d0+w1d1，d0、d1分别为目标和背景数据的各自的类内距离，L-1为离散数据中的最大值，Pi是数据i出现的概率。7.如权利要求1-6任一项所述的基于角度斜率指数的林火判别方法，其特征在于，对火点判别结果进行非林火干扰点排除包括：依据太阳耀斑计算公式结合太阳耀斑条件剃除火点结果中的太阳耀斑，得到火点确定结果；其中，太阳耀斑计算公式：cosθr＝cosθvcosθs-sinθvsinθscosψ其中，θv和θs分别是观测天顶角和太阳天顶角，ψ是相对方位角，θr是镜面反射方向与地面与卫星连线方向的夹角；太阳耀斑条件为：可见光和红外线的折射率均大于0.3，且太阳耀斑角小于30°，则该像素点为太阳耀斑；以及，输出林地区域影像的火点之后，还包括：利用准确度P、漏检率M以及综合准确率和漏检率的F值来对火点结果进行同一精度评定，评定公式如下：其中，Yy为监测的火点为真实火点的个数；Yn为误检火点的个数；Ny为漏检火点的个数，P和M分别为准确率和漏检率，F为准确率和漏检率的综合评价指数。8.一种基于角度斜率指数的林火判别系统，其特征在于，包括：影像组合模块，用于获取目标区域的遥感卫星的波段组合影像；要素检测模块，用于对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像；指数构建模块，用于根据波段组合影像中的各个波段之间的相关性、火灾发生前后的可见光波段、红外波段的反射率以及亮温值变化构成角度斜率指数；火点判别模块，用于基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别；火点输出模块，用于对火点判别结果进行非林火干扰点排除之后，输出林地区域影像的火点。9.一种基于角度斜率指数的林火判别设备，其特征在于，包括：至少一个处理器；以及与至少一个处理器通信连接的存储器；其中，存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行如权利要求1-7中任一项所述的基于角度斜率指数的林火判别方法步骤。10.一种计算机可读存储介质，其上存储有计算机可执行指令，其特征在于，所述可执行指令被处理器执行时实现如权利要求1-7任一项所述的基于角度斜率指数的林火判别方法步骤。
说明书desc
技术领域本发明涉及环境监测技术领域，尤其涉及一种基于角度斜率指数的林火判别方法、系统、设备以及介质。背景技术卫星遥感已成为当前林火快速监测的重要手段。目前已经有不少学者利用遥感数据进行林火识别相关研究。Schmidt和Prins等基于WF-ABBA算法编写了COESRABI火点识别算法理论文档。M.J.Wooster和G.Roberts等基于欧洲Meteosat卫星SEVIRI传感器的IR3.9μm，IR10.8μm的IR12.0μm通道的亮温值，IR3.9μm、VIS0.6μm通道的光谱弧度构建LSA SAF Meteosat卫星火点提取指数，该方法为了尽可能地避免对火点的漏检使用了较低的阈值，但在被太阳均匀加热区域的像元参数值也可能达到检测限，从而导致较大的误差。谭三清等根据中红外与热红外的亮温差异，利用影像像元值、影像均值和影像标准差之间的比值关系进行潜在火点判别。宫阿都等针对固定阈值判别法无法满足区域性差异的不足，利用BFAST算法检测时间序列数据断点判别潜在火点。但是目前国内外学者对林火判别的研究主要还是基于红外波段的固定阈值法和单时像的林火判别，分析的结果具有很大的主观性，准确性、适用性差；同时，常用的卫星产品无法满足东亚地区森林火灾火情探测的需求。目前国内外基于遥感数据的林火监测方法及林火产品都是基于红外波段构建的阈值判别法，忽略了火灾发生对可见光区域的影响，同时忽略了波段间的相关性；而森林火灾发生后，植被破坏及热辐射对可见光、近红外和红外波段都造成了一定的影响，在光谱影相中各个独立波段间有着很强的相关性，光谱数据中波段间的波长关系与反射率/亮温值同等重要；同时，大多数林火判别方法都建立在固定阈值基础之上，忽略了不同监测背景下阈值的变化，这种变化造成实际林火判别阈值差别较大。因此，现有林火判别方法在林火监测过程中造成了较高的漏分率和误分率。发明内容要解决的技术问题鉴于现有技术的上述缺点、不足，本发明提供一种基于角度斜率指数的林火判别方法、系统、设备以及介质，其解决了现有林火判别方法在林火监测过程中存在较高的漏分率和误分率的技术问题。技术方案为了达到上述目的，本发明采用的主要技术方案包括：第一方面，本发明实施例提供一种基于角度斜率指数的林火判别方法，包括：获取目标区域的遥感卫星的波段组合影像；对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像；根据波段组合影像中的各个波段之间的相关性、火灾发生前后的可见光波段、红外波段的反射率以及亮温值变化构建角度斜率指数；基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别；对火点判别结果进行非林火干扰点排除之后，输出林地区域影像的火点。可选地，获取目标区域的遥感卫星的波段组合影像包括：采集Himawari-8卫星的多个波段数据以形成波段组合影像；对波段组合影像进行包含目标区域剪裁、几何校正、辐射矫正的预处理，再遍历提取波段组合影像中每个网格的反射率数据和亮温数据。可选地，对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像包括：利用Himawari-8卫星03、04和05波段的反射率数据及07、14、16波段的亮温数据的不同阈值条件分别检测厚云、高云和中低云，并通过晴空修复公式对云检测结果中标记为云点的像元进行晴空修复，得到云检测最终结果；利用从公共数据库调取的30米精度全球地表覆盖分类数据进行水体检测，得到水体检测结果；利用从公共数据库调取的30米精度全球地表覆盖分类数据和Himawari-8卫星03、04波段的反射率数据进行林地识别，得到林地识别结果；其中，厚云检测的阈值条件为：ρ03＞0.3，或者高云检测的阈值条件为：BT16＜236K，或者；中低云检测的阈值条件为：BT14＜278K，或者BT7-BT14＞20K；ρ表示可见光通道反射率，BT表示热红外通道亮温；晴空修复公式为：-0.18≤NDVI≤0.2；林地识别满足：NDVI＞0.45，或者30米全球地表覆盖分类数据中地表覆盖类型为林地；NDVI＝/，BA03、BA04分别为03、04波段的反射率。可选地，角度斜率指数为：|B03B04|2＝2+（y04-y03)2|B04B05|2＝2+2|B03B05|2＝2+2|B06B07|2＝2+2|B07B08|2＝2+2|B06B08|2＝2+2其中，AMIR、ANIR分别为中红外角度斜率指数和近红外角度指数，B03B04、B04B05、B03B05、B06B07、B07B08、B06B08分别表示在设定坐标系中各波段对应的顶点之间的距离，x值为波段编号，y值分别为01～06波段的反射率数据和07～16波段的亮温数据；预先设置的火点阈值为：AMIR＞0.96；AMIR＞0.95且ANIR＜0；AMIR＞0.95，或者T7＞315K；其中，T7＞315K这项条件应用在可见光波部分不起作用的时段。可选地，基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别包括：获取包含至少两张火灾发生前后时序的林地区域影像的多时序影像；求取火灾发生后的当前时序影像的AMIR、ANIR指数，并基于AMIR、ANIR指数构建AMIR-ANIR的影像；针对影像不同区域和环境中的背景差异，采用分解的三维OTSU算法计算AMIR-ANIR的影像的自适应阈值，并依据自适应阈值对AMIR-ANIR的影像进行图像分割，得到的不同地域的火点目标影像；求取当前时序影像中的不同地域的火点目标影像与多时序影像中邻近时序的火灾之前的影像之间的角度斜率差指数，结合预设的指数差阈值判断火点目标影像是否为火点，输出火点判别结果；其中，角度斜率差指数为：ΔANIRt＝ANIRt2-ANIRt1ΔAMIRt＝AMIRt1-AMIRt2式中，ANIRt1、AMIRt1表示多时序影像中火灾发生前一景的近红外角度斜率指数和中红外角度斜率指数，ANIRt2、AMIRt2表示多时序影像中火灾发生后一景的近红外角度斜率指数和中红外角度斜率指数，ΔANIRt、ΔAMIRt表示前后两景的近红外角度斜率指数差和中红外角度斜率指数差；指数差阈值为：ΔAMIRt＞0.03且ΔANIRt＞1.0；ΔAMIRt＞0.03或者ΔT7＞10K；其中，ΔT7＞10K这项条件应用在可见光波部分不起作用的时段。可选地，采用分解的三维OTSU算法计算自适应阈值是通过如下阈值判别公式实施：其中，s是将一组离散的数据分为两类的值，当G取最大值所对应的灰度级即为s所求的最佳阈值S0，即S0＝argmax)，W0、W1分别是目标和背景数据所占的概率，sb为类间距离，sb＝|μ1-μ0|，μ1，μ0是目标和背景数据对应各自类别元素均值；sw为总体类内距离，sw＝w0d0+w1d1,d0、d1分别为目标和背景数据的各自的类内距离，L-1为离散数据中的最大值，Pi是数据i出现的概率。可选地，对火点判别结果进行非林火干扰点排除包括：依据太阳耀斑计算公式结合太阳耀斑条件剃除火点结果中的太阳耀斑，得到火点确定结果；其中，太阳耀斑计算公式：cosθr＝cosθv cosθs-sinθv sinθs cosψ其中，θv和θs分别是观测天顶角和太阳天顶角，ψ是相对方位角，θr是镜面反射方向与地面与卫星连线方向的夹角；太阳耀斑条件为：可见光和红外线的折射率均大于0.3，且太阳耀斑角小于30°，则该像素点为太阳耀斑；以及，输出林地区域影像的火点之后，还包括：利用准确度P、漏检率M以及综合准确率和漏检率的F值来对火点结果进行同一精度评定，评定公式如下：其中，Yy为监测的火点为真实火点的个数；Yn为误检火点的个数；Ny为漏检火点的个数，P和M分别为准确率和漏检率，F为准确率和漏检率的综合评价指数。第二方面，本发明实施例提供一种基于角度斜率指数的林火判别系统，包括：影像组合模块，用于获取目标区域的遥感卫星的波段组合影像；要素检测模块，用于对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像；指数构建模块，用于根据波段组合影像中的各个波段之间的相关性、火灾发生前后的可见光波段、红外波段的反射率以及亮温值变化构成角度斜率指数；火点判别模块，用于基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别；火点输出模块，用于对火点判别结果进行非林火干扰点排除之后，输出林地区域影像的火点。第三方面，本发明实施例提供一种基于角度斜率指数的林火判别设备，包括：至少一个处理器；以及与至少一个处理器通信连接的存储器；其中，存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行如上所述的基于角度斜率指数的林火判别方法步骤。第四方面，本发明实施例提供一种计算机可读存储介质，其上存储有计算机可执行指令，所述可执行指令被处理器执行时实现如上所述的基于角度斜率指数的林火判别方法步骤。有益效果本发明的有益效果是：针对林火判别过程中单波段固定阈值造成的漏分、误分，构建了角度斜率指数；角度斜率指数考虑了光谱影像中各个独立波段间的强相关性及森林火灾发生后可见光波段反射率的变化，对林火发生后的变化更为敏感，提高了林火判别的正确率；采用与森林火灾火点位置相对应的灾前林地样本数据进行统计，避免了不同区域背景与目标值的差异造成的误差，统计结果更为准确；针对不同背景下林火判别阈值的差别，采用分解的三维OTSU算法计算不同地域的火点阈值，这种自适应的阈值计算方法减少了林火判别的漏分率；针对单幅影像林火判别算法造成的漏分和误分，采用多时序影像角度斜率指数变化判别法，提高林火判别的正确率。附图说明图1为本发明实施例提供的一种基于角度斜率指数的林火判别方法的流程示意图；图2为本发明实施例提供的一种基于角度斜率指数的林火判别方法的步骤S1的具体流程示意图；图3为本发明实施例提供的一种基于角度斜率指数的林火判别方法的步骤S2的具体流程示意图；图4为本发明实施例提供的一种基于角度斜率指数的林火判别方法的林地及火点样本波谱曲线图；图5为本发明实施例提供的一种基于角度斜率指数的林火判别方法的火点及林地样本点位置图；图6为本发明实施例提供的一种基于角度斜率指数的林火判别方法的火点样本烟雾示例图；图7为本发明实施例提供的一种基于角度斜率指数的林火判别方法的火点、林地ANIR指数统计图；图8为本发明实施例提供的一种基于角度斜率指数的林火判别方法的火点、林地AMIR指数统计图；图9为本发明实施例提供的一种基于角度斜率指数的林火判别方法的步骤S5的具体流程示意图；图10为本发明实施例提供的一种基于角度斜率指数的林火判别方法的ΔANIR指数统计图；图11为本发明实施例提供的一种基于角度斜率指数的林火判别方法的ΔAMIR指数统计图；图12为本发明实施例提供的一种基于角度斜率指数的林火判别方法的2021年12月7日02：10Himawari-8全景影像火点判别结果；图13为本发明实施例提供的一种基于角度斜率指数的林火判别方法的2020年3月31日至4月1日云南省境内火点判别结果；图14为本发明实施例提供的一种基于角度斜率指数的林火判别方法的冕宁县石龙镇火点判别图；图15为本发明实施例提供的一种基于角度斜率指数的林火判别方法的整体流程示意图。具体实施方式为了更好地解释本发明，以便于理解，下面结合附图，通过具体实施方式，对本发明作详细描述。如图1所示，本发明实施例提出的一种基于角度斜率指数的林火判别方法，包括：首先，获取目标区域的遥感卫星的波段组合影像；其次，对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像；接着，根据波段组合影像中的各个波段之间的相关性、火灾发生前后的可见光波段、红外波段的反射率以及亮温值变化构建角度斜率指数；再者，基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别；最后，对火点判别结果进行非林火干扰点排除之后，输出林地区域影像的火点。由此，本发明具备如有益效果：针对林火判别过程中单波段固定阈值造成的漏分、误分，构建了角度斜率指数；角度斜率指数考虑了光谱影像中各个独立波段间的强相关性及森林火灾发生后可见光波段反射率的变化，对林火发生后的变化更为敏感，提高了林火判别的正确率。采用与森林火灾火点位置相对应的灾前林地样本数据进行统计，避免了不同区域背景与目标值的差异造成的误差，统计结果更为准确。针对不同背景下林火判别阈值的差别，采用分解的三维OTSU算法计算不同地域的火点阈值，这种自适应的阈值计算方法减少了林火判别的漏分率。针对单幅影像林火判别算法造成的漏分和误分，采用多时序影像角度斜率指数变化判别法，提高林火判别的正确率。为了更好地理解上述技术方案，下面将参照附图更详细地描述本发明的示例性实施例。虽然附图中显示了本发明的示例性实施例，然而应当理解，可以以各种形式实现本发明而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更清楚、透彻地理解本发明，并且能够将本发明的范围完整的传达给本领域的技术人员。具体地，本发明提供一种基于角度斜率指数的林火判别方法，其包括：S1、获取目标区域的遥感卫星的波段组合影像。如图2所示，步骤S1包括：S11、采集Himawari-8卫星的多个波段数据以形成波段组合影像。S12、对波段组合影像进行包含目标区域剪裁、几何校正、辐射矫正的预处理，再遍历提取波段组合影像中每个网格的反射率数据和亮温数据。森林火灾发生后，燃烧区域植被被毁，叶绿素含量减少引起可见光波段、红边波段以及近红外波段反射率的变化，具体体现在：近红外波段反射率下降、短波红外反射率有所增加，归一化植被指数显著降低。同时，根据热辐射基本定律，物体辐射峰值对应的波长与温度成反比，随着物体温度的升高，辐射峰值向短波方向移动。森林燃烧的主要温度范围为600～1300K，对应的峰值波长在中红外范围，而地表常温的辐射峰值波长在11μm左右。在中红外波段，燃烧释放的辐射与背景辐射之间的差异最高可以达到4个数量级。根据普朗克定律，这种辐射亮度上的差异导致即使火灾面积仅占像元总面积的1/104～1/103，火点像元在中红外波段的亮温值也会显著地升高，与周边像元出现明显差异。在远红外波段，同样会出现这种亮温上的差异，但差值较小。这种亮温差特性可以作为火点识别的主要依据。针对常用的卫星产品因时间、空间分辨率及观测区域的限制，无法满足东亚地区森林火情探测需求的情况，采用Himawari-8卫星数据进行林火监测。Himawari-8卫星是日本2014年10月7日发射的新一代静止气象卫星，时间分辨率可达10min，空间分辨率最高可达0.5km，包含可见光、近红外和红外通道，各通道输出的量化等级为12bit，可获取东亚地区所在半球的完整信息，可以满足我国火点识别的需求。基于以上分析选取Himawari-8卫星的03、04、05、06、07、08波段构建角度指数进行森林火灾火点判别。云检测、林地检测选用03、04和05波段的反射率数据及07、14、16波段的亮温数据。S2、对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像。如图3所示，步骤S2包括：S21、利用Himawari-8卫星03、04和05波段的反射率数据及07、14、16波段的亮温数据的不同阈值条件分别检测厚云、高云和中低云，并通过晴空修复公式对云检测结果中标记为云点的像元进行晴空修复，得到云检测最终结果。利用遥感影像进行林火监测时，云会遮挡地面真实的地物信息，降低影像的质量，影响火点判别的精度。云检测算法利用云在红外和可见光的亮温或者反射率与其它地物不同的特点来识别。采用多光谱综合阈值云监测算法进行检测：分别利用不同波段反射率及亮温的不同阈值对厚云、高云和中低云进行检测，并且利用晴空修复算法对检测结果进行修正。S22、利用从公共数据库调取的30米精度全球地表覆盖分类数据进行水体检测，得到水体检测结果。S23、利用从公共数据库调取的30米精度全球地表覆盖分类数据和Himawari-8卫星03、04波段的反射率数据进行林地识别，得到林地识别结果。其中，厚云检测的阈值条件为：ρ03＞0.3，或者高云检测的阈值条件为：BT16＜236K，或者。中低云检测的阈值条件为：BT14＜278K，或者BT7-BT14＞20K；ρ表示可见光通道反射率，BT表示热红外通道亮温。晴空修复公式为：-0.18≤NDVI≤0.2。林地识别满足：NDVI＞0.45，或者30米全球地表覆盖分类数据中地表覆盖类型为林地；NDVI＝/，BA03、BA04分别为03、04波段的反射率。S3、根据波段组合影像中的各个波段之间的相关性、火灾发生前后的可见光波段、红外波段的反射率以及亮温值变化构建角度斜率指数。本发明提供的角度斜率指数利用三个连续的波段间光谱的几何形状，描述三个光谱间的相互关系，因此它检测的不仅是任何波段的反射率值，还有波段间的关系。森林火灾发生后，植被破坏及热辐射对可见光、近红外和红外波段都造成了一定的影响，在光谱影像中各个独立波段间有着很强的相关性，光谱数据中波段间的波长关系与反射率同等重要，在此前提下，角度斜率指数对林火发生的反映更为敏感。本发明基于以上原则采用光谱分析与角度斜率指数进行火点识别。在一具体实施例中，通过历史新闻记载及Himawari-8卫星林火产品数据选取2022年5月2日West Arnhem西阿纳姆西南部02：00、02：10、02：30、2022年2月7日西澳大利亚西南部02：00、02：10、02：30、2021年2月2日西澳大利亚珀斯市外00：00、00：30、01：00、2019年12月17日新南威尔士州00：30、01：00时无云遮挡的火点样本257处；选取2022年3月12日02：00西阿纳姆西南部、2021年12月17日02：10西澳大利亚南部、2020年12月7日西澳大利亚珀斯市外00：30、2019年9月11日01：00新南威尔士州与火点位置相应的灾前林地样本132处。选取过程中通过Himawari-8卫星B7B14B15波段组合影像、B1B2B3波段组合影像及哨兵2号波段组合影像中的火灾烟雾及火点信息对火灾样本信息进行验证，如图5和图6所示，所示背景影像为B1B2B3波段组合。导出火点及林地波谱曲线如图4所示，从统计图可知：火点样本相对于林地样本波谱曲线整体上升，其中B7波段上升显著，而B4下降显著，从而引起∠B3B4B5显著增大、∠B6B7B8显著减小；B8～B16波段亮温值明显增加，与林地波谱线成整体分离状态，因变化程度不及B7波段显著，角度变化不明显；根据以上变化特征，构建如下中红外角度指数AMIR、近红外角度指数ANIR及近中角度差指数依据火点本身辐射特性对森林火灾火点进行判别：|B03B04|2＝2+2|B04B05|2＝2+2|B03B05|2＝2+2|B06B07|2＝2+2|B07B08|2＝2+2|B06B08|2＝2+2其中，AMIR、ANIR分别为中红外角度斜率指数和近红外角度指数，B03B04、B04B05、B03B05、B06B07、B07B08、B06B08分别表示在设定坐标系中各波段对应的顶点之间的距离，x值为波段编号，y值分别为01～06波段的反射率数据，07～16波段的亮温数据。S4、基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别。1)基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，具体为：从选取的132处样本点计算火点和林地像元的AMIR和ANIR指数值，并进行统计分析。由图7和图8可知，剔除异常点，火点像元的AMIR值均在0.96以上，ANIR值大都位于-0.5以下；林地像元的AMIR值均在0.95以下，ANIR值均在0.5以上。考虑林火初期，林地毁坏面积小，热辐射升温较慢，以及林火烟雾对可见光区域造成的影响，得到火点阈值为：AMIR＞0.96；AMIR＞0.95且ANIR＜0；AMIR＞0.95或T7＞315K，其中，T7＞315K这项条件应用在可见光波部分不起作用的时段。2)如图9所示，基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别，包括：S41、从波段组合影像中获取包含至少两张火灾发生前后时序的林地区域影像的多时序影像。S42、求取火灾发生后的当前时序影像的AMIR、ANIR指数，并基于AMIR、ANIR指数构建AMIR-ANIR的影像。S43、针对影像不同区域和环境中的背景差异，采用分解的三维OTSU算法计算AMIR-ANIR的影像的自适应阈值，并依据自适应阈值对AMIR-ANIR的影像进行图像分割，得到的不同地域的火点目标影像。S44、求取当前时序影像中的不同地域的火点目标影像与多时序影像中邻近时序的火灾之前的影像之间的角度斜率差指数，结合预设的指数差阈值判断火点目标影像是否为火点，输出火点判别结果。上述步骤的思路是：利用当前影像波段计算得到的AMIR、ANIR指数值构建AMIR-ANIR的影像，利用分解的三维OTSU算法对AMIR-ANIR的影像计算自适应阈值并进行图像分割，得到不同地域目标影像。再利用当前影像与时序影像中前一影像的角度斜率差指数判断这些目标影像是否为火点。其中，火点的识别则是依据火点辐射与背景辐射之间的差异，角度斜率差指数为：ΔANIRt＝ANIRt2-ANIRt1ΔAMIRt＝AMIRt1-AMIRt2式中，ANIRt1、AMIRt1表示多时序影像中火灾发生前一景的近红外角度斜率指数和中红外角度斜率指数，ANIRt2、AMIRt2表示多时序影像中火灾发生后一景的近红外角度斜率指数和中红外角度斜率指数，ΔANIRt、ΔAMIRt表示前后两景的近红外角度斜率指数差和中红外角度斜率指数差。角度斜率指数的阈值与坐标系纵横坐标中主刻度间隔的设置密切相关，在不同纵横坐标比值的情况下会有不同的判定阈值：当Y/X比值增大时，角度增大，阈值增大，阈值差随之增大；当Y/X比值减小时，阈值减小，阈值差随之减小。其中X坐标轴对应Himawari-8的16个通道，Y坐标轴对应01～06通道的反射率数据和07～16通道的亮温数据。本次实例中得到的阈值计算结果采用的纵横坐标比为Y/X＝500，ANIR、AMIR计算结果值为余弦值。从选取的132处样本点计算火点和林地像元的ΔAMIR和ΔANIR指数值，并进行统计分析。由图10、图11可知，剔除异常点，ΔANIR均在1以上，ΔAMIR均在0.03以上，火点阈值为：ΔAMIRt＞0.03且ΔANIRt＞1.0；ΔAMIRt＞0.03或者ΔT7＞10K；其中，ΔT7＞10K这项条件应用在可见光波部分不起作用的时段。进而，针对卫星影像不同区域和时段中背景差异造成的火点误判，对影像AMIR-ANIR采用分解的三维OTSU算法进行自适应阈值分割。分解的三维OTSU算法同时考虑了类间方差大小和内类的聚类性，比其它分割算法性能更优，其计算过程如下所示：设用值s将一组离散的数据分为了两类，对于这两个类，定义其类间距离为：sb＝|μ1-μ0|其中μ1，μ0是对应各自类别元素均值。可以看出sb越大，类间距离就越大，目标和背景就分得越开，分割效果就越好。设用值s将一组离散的数据分为了两类，Pi是数据i出现的概率，W0、W1分别是两类所占的概率，μ0和μ1是对应的两类的均值，那么这两类的类内距离分别为：两类的总体类内距离为：sw＝w0d0+w1d1表示类内的内聚性，当sw的值取得最小时，分割b效果最好。因此，同时考虑以上两个因素，既要保证类间距离最大，又要做到每个类的内聚性最好，这样才能获得更好的分割效果。基于这个要求，本发明在分析Otsu的基础上，提供一个阈值判别公式为：当G取最大值所对应的灰度级即为所求的最佳阈值S0，即S0＝argmax)。值得一提的是，本发明的自适应阈值，在做otsu之前将图像按经纬度划分为小区域范围，在小区域范围内做otsu，每个小区域范围内的自适应阈值会有差别，目标是基于不同的分割阈值得到，然后在得到的目标的基础上再判断与前一副图像的指数变化值是否超过阈值，超过了才是潜在火点。这样做是避免图像整体变化时反射率与亮温整体变化造成的误差。本发明实施例中的背景指林地，目标指火点，是在影像划分区域之后的子影像中进行OTSU计算，得到各分区的自适应分割阈值后分割影像，得到的目标不一定是火点，只是与背景明显不同的指数区间范围，再通过角度差指数在目标区域判别火点，这样做也是为了减少误差。进一步地，对火点判别结果进行非林火干扰点排除包括：依据太阳耀斑计算公式结合太阳耀斑条件剃除火点结果中的太阳耀斑。其中，太阳耀斑计算公式：cosθr＝cosθv cosθs-sinθv sinθs cosψ其中，θv和θs分别是观测天顶角和太阳天顶角，ψ是相对方位角，θr是镜面反射方向与地面与卫星连线方向的夹角。太阳耀斑条件为：可见光和红外线的折射率均大于0.3，且太阳耀斑角小于30°，则该像素点为太阳耀斑。进一步地，输出林地区域影像的火点之后，还包括：利用准确度P、漏检率M以及综合准确率和漏检率的F值来对火点结果进行同一精度评定，评定公式如下：其中，Yy为监测的火点为真实火点的个数；Yn为误检火点的个数；Ny为漏检火点的个数，P和M分别为准确率和漏检率，F为准确率和漏检率的综合评价指数。在一具体实施例中，利用日本气象厅推出的JAXAWLFdaily产品数据和判别结果进行对比分析。2021年12月7日02：10WLF daily产品数据中全景影像内火点总计240个，判别结果中223个火点中有209个与WLFdaily产品数据一致，两种方法的不一致处可能是由于虚假火点及非林地火点被识别等。由表1可知，判别结果与WLF daily产品数据的正确率达到0.87，漏检率为0.24，准确率和漏检率的综合评价为0.87，说明两者的一致性较高，能够较好地起到火点判别的目的。从中国森林草原防灭火网上获取2020年3月31日16时至2020年4月1日16时云南省境内发生的林火，共计22起。参考图13，通过对比分析，林火判别法识别的26起林火中有20起与中国森林草原防灭火网一致，未识别的两起火灾的可能原因是由于被云遮盖或火灾持续时间短、范围小等。由表1可知，判别结果与中国森林草原防灭火网林火数据的正确率到达0.77，漏检率为0.09，准确率和漏检率的综合评价价值为0.83，说明判别结果与中国森林草原防灭火网一致性较高。表1判别结果精度评价火点数据正确率漏检率F中国森林草原防灭火网林火数据0.770.090.83WLF-daily产品数据0.870.130.87选取2021年4月26日四川凉山州冕宁县石龙镇森林火灾的一场复燃余火，通过是否在林火初期识别出林火，来验证本发明方法的灵敏性。这场林火持续时间短，波及范围小，能够对判别方法的灵敏性起到很好的验证作用。火灾发生时间为4月26日3时45分，总共持续52分钟，火点像元大小为一个像元。用本发明林火判别方法在火灾20分钟后识别出了一个像元的林火热点，如图14所示。从而说明该判别方法对小火的灵敏性较高，能够在林火发生初期即时判别，为灭火救援赢得宝贵时间。此外，本发明实施例提供一种基于角度斜率指数的林火判别系统，包括：影像组合模块，用于获取目标区域的遥感卫星的波段组合影像。要素检测模块，用于对波段组合影像分别进行云、水体以及林地检测，得到剔除云、水体的林地区域影像。指数构建模块，用于根据波段组合影像中的各个波段之间的相关性、火灾发生前后的可见光波段、红外波段的反射率以及亮温值变化构成角度斜率指数。火点判别模块，用于基于角度斜率指数和预设的火点阈值对林地区域影像进行火点判别，或基于通过对由角度斜率指数构建的影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像和由多时序影像的角度斜率指数解算得到的角度斜率差指数进行火点判别。火点输出模块，用于对火点判别结果进行非林火干扰点排除之后，输出林地区域影像的火点。同时，本发明实施例提供一种基于角度斜率指数的林火判别设备，包括：至少一个处理器；以及与至少一个处理器通信连接的存储器；其中，存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行如上所述的基于角度斜率指数的林火判别方法步骤。以及，本发明实施例提供一种计算机可读存储介质，其上存储有计算机可执行指令，所述可执行指令被处理器执行时实现如上所述的基于角度斜率指数的林火判别方法步骤。综上所述，本发明实施例提供一种基于角度斜率指数的林火判别方法、系统、设备以及介质，参考图15，本发明的整体流程为：首先，数据和波段的筛选：选取Himawari-8卫星的B03、B04、B05、B06、B07、B08波段构建角度斜率指数进行森林火灾火点判别；其次，云检测、水体、林地检测；接着，构建角度斜率指数ANIR、AMIR；然后，构建角度斜率指数差AMIR-ANIR；继而，基于角度斜率指数和预先设置的火点阈值对林地区域影像进行火点判别，或者基于由多时序影像的角度斜率指数解算得到的角度斜率差指数和通过对林地区域影像采用分解的三维OTSU算法分割得到的不同地域的火点目标影像进行火点判别，满足二者之一的火点判断条件，则输出火点判别结果；之后，对火点判别结果进行非林火干扰点排除之后，输出林地区域影像的火点，再进行精度评价。由此，本发明充分利用卫星遥感影像光谱波段及波段之间的强相关性构建新的森林火点判别指数，同时针对不同区域中背景的差异采用分解的三维OTSU自适应阈值分割算法来进行森林火灾火点判别，以提高火点识别的准确度。由于本发明上述实施例所描述的系统/装置，为实施本发明上述实施例的方法所采用的系统/装置，故而基于本发明上述实施例所描述的方法，本领域所属技术人员能够了解该系统/装置的具体结构及变形，因而在此不再赘述。凡是本发明上述实施例的方法所采用的系统/装置都属于本发明所欲保护的范围。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例，或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明是参照根据本发明实施例的方法、设备和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。应当注意的是，位于部件之前的词语“一”或“一个”不排除存在多个这样的部件。本发明可以借助于包括有若干不同部件的硬件以及借助于适当编程的计算机来实现。在列举了若干装置的方案中，这些装置中的若干个可以是通过同一个硬件来具体体现。词语第一、第二、第三等的使用，仅是为了表述方便，而不表示任何顺序。可将这些词语理解为部件名称的一部分。此外，需要说明的是，在本说明书的描述中，术语“一个实施例”、“一些实施例”、“实施例”、“示例”、“具体示例”或“一些示例”等的描述，是指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。尽管已描述了本发明的优选实施例，但本领域的技术人员在得知了基本创造性概念后，则可对这些实施例作出另外的变更和修改。所以，本发明应该解释为包括优选实施例以及落入本发明范围的所有变更和修改。显然，本领域的技术人员可以对本发明进行各种修改和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明方案及其等同技术的范围之内，则本发明也应该包含这些修改和变型在内。
