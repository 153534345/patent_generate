标题title
一种基于人工智能的智能微电网能源管理系统
摘要abst
本发明提供了一种基于人工智能的智能微电网能源管理系统，该系统包括：用于获取各分布式能源下垂控制参数的参数获取模块；用于在预设时间段的初始时刻选择第一优化能源，在预设时间段的非初始时刻从第一优化能源中选择第二优化能源的能源选择模块；用于根据分布式能源的状态数据对所选优化能源的下垂控制参数进行优化并得到参数优化后的微电网稳定程度的参数优化模块；用于根据预设时间段内控制中心与第一优化能源间信道的利用率以及微电网的稳定程度确定中心控制能源的能源确定模块；本发明结合下垂控制和中心化控制得到各个分布式能源的控制参数，降低数据通讯成本，实现微电网快速响应的同时保证微电网的稳定性。
权利要求书clms
1.一种基于人工智能的智能微电网能源管理系统，其特征在于，该系统包括：参数获取模块，用于获取各分布式能源的下垂控制参数；能源选择模块，用于在预设时间段的初始时刻从分布式能源中选择第一优化能源，在预设时间段的非初始时刻从第一优化能源中选择第二优化能源；参数优化模块，用于根据分布式能源的状态数据对能源选择模块所选优化能源的下垂控制参数进行优化并得到参数优化后的微电网稳定程度；能源确定模块，用于根据预设时间段内控制中心与第一优化能源间信道的利用率以及微电网的稳定程度确定中心控制能源。2.如权利要求1所述的系统，其特征在于，所述参数获取模块包括：状态数据获取单元，用于以后一时刻分布式清洁能源的预测状态数据为约束，利用前一时刻各分布式能源的状态数据和下垂控制参数预测后一时刻各分布式能源的状态数据；下垂控制单元，用于基于各分布式能源的状态数据对各分布式能源进行下垂控制。3.如权利要求2所述的系统，其特征在于，所述状态数据获取单元将前一时刻各分布式能源的状态数据和下垂控制参数、后一时刻分布式清洁能源的预测状态数据输入状态预测网络，输出后一时刻各分布式能源的状态数据。4.如权利要求2所述的系统，其特征在于，所述状态预测网络为全连接神经网络。5.如权利要求1所述的系统，其特征在于，所述能源选择模块基于排列组合规则选择第一优化能源和第二优化能源。6.如权利要求5所述的系统，其特征在于，所述根据分布式能源的状态数据对能源选择模块所选能源的下垂控制参数进行优化并得到参数优化后的微电网稳定程度包括：将各分布式能源的状态数据和下垂控制参数输入参数优化模型，对所选分布式能源的下垂控制参数进行优化，输出优化后各分布式能源的下垂控制参数及其对应的微电网稳定程度。7.如权利要求6所述的系统，其特征在于，所述能源确定模块包括：能源寻找单元，用于在每个非初始时刻选择参数优化后微电网最稳定时对应的第二优化能源为第三优化能源；第一计算单元，用于根据每个非初始时刻的第三优化能源数量与第一优化能源数量的比值计算信道利用率。8.如权利要求7所述的系统，其特征在于，所述能源确定模块还包括：第二计算单元，用于根据对第一优化能源进行参数优化后的微电网稳定程度和第一优化能源的数量计算初始时刻的单位稳定程度，根据对第三优化能源进行参数优化后的微电网稳定程度和时第三优化能源的数量计算每个非初始时刻的单位稳定程度，对预设时间段内各时刻的单位稳定程度求和得到微电网的持续稳定程度。9.如权利要求8所述的系统，其特征在于，所述第二计算单元中的微电网稳定程度要经过归一化处理。
说明书desc
技术领域本发明涉及微电网领域，具体为一种基于人工智能的智能微电网能源管理系统。背景技术智能微电网是“智能电网”与“微电网”的结合，智能微电网能够在充分利用清洁能源的同时，由智能电网解决分布式能源不稳定的问题，同时还能对大电网起到“削峰填谷”的辅助作用；其中，“智能电网”是一个自动化的供电网路，能够通过传感器来对供电与用电设备起到实时监控与收集整合，由控制系统来对电力系统起到优化管理的作用；“微电网”是指由分布式能源、储能装置、能量转换装置、相关负荷及监控组合而成的小型发电配电系统，且“微电网”的运行控制应该能够做到基于本地信息对电网中的事故作出快速、独立的响应，而不用接受传统电网的统一调度。传统的微电网控制是通过下垂控制来实现功率均分和维持系统稳定运行的；下垂控制是模拟传统发电机系统的功率同步机理实现无需通信的功率分配功能，但同时由于下垂控制分布式能源间没有通信，使用该控制方法会使得电网整体的稳定性较差。另一种控制方法是控制中心与分布式能源间使用光纤通信实现功率调节，但该种控制方法成本较高，即使控制中心与各分布式能源进行先后间歇式通信，该方法也只是减少了同时刻的传输数据量来降低传输成本。发明内容为了解决上述问题，本发明提出一种基于人工智能的智能微电网能源管理系统，该系统包括：参数获取模块，用于获取各分布式能源的下垂控制参数；能源选择模块，用于在预设时间段的初始时刻从分布式能源中选择第一优化能源，在预设时间段的非初始时刻从第一优化能源中选择第二优化能源；参数优化模块，用于根据分布式能源的状态数据对能源选择模块所选优化能源的下垂控制参数进行优化并得到参数优化后的微电网稳定程度；能源确定模块，用于根据预设时间段内控制中心与第一优化能源间信道的利用率以及微电网的稳定程度确定中心控制能源。进一步地，所述参数获取模块包括：状态数据获取单元，用于以后一时刻分布式清洁能源的预测状态数据为约束，利用前一时刻各分布式能源的状态数据和下垂控制参数预测后一时刻各分布式能源的状态数据；下垂控制单元，用于基于各分布式能源的状态数据对各分布式能源进行下垂控制。进一步地，所述状态数据获取单元将前一时刻各分布式能源的状态数据和下垂控制参数、后一时刻分布式清洁能源的预测状态数据输入状态预测网络，输出后一时刻各分布式能源的状态数据。进一步地，所述状态预测网络为全连接神经网络。进一步地，所述能源选择模块基于排列组合规则选择第一优化能源和第二优化能源。进一步地，所述根据分布式能源的状态数据对能源选择模块所选能源的下垂控制参数进行优化并得到参数优化后的微电网稳定程度包括：将各分布式能源的状态数据和下垂控制参数输入参数优化模型，对所选分布式能源的下垂控制参数进行优化，输出优化后各分布式能源的下垂控制参数及其对应的微电网稳定程度。进一步地，所述能源确定模块包括：能源寻找单元，用于在每个非初始时刻选择参数优化后微电网最稳定时对应的第二优化能源为第三优化能源；第一计算单元，用于根据每个非初始时刻的第三优化能源数量与第一优化能源数量的比值计算信道利用率。进一步地，所述能源确定模块还包括：第二计算单元，用于根据对第一优化能源进行参数优化后的微电网稳定程度和第一优化能源的数量计算初始时刻的单位稳定程度，根据对第三优化能源进行参数优化后的微电网稳定程度和时第三优化能源的数量计算每个非初始时刻的单位稳定程度，对预设时间段内各时刻的单位稳定程度求和得到微电网的持续稳定程度。进一步地，所述第二计算单元中的微电网稳定程度要经过归一化处理。本发明的有益效果在于：1.本发明采用半中心化控制，具体地，结合下垂控制和中心化控制得到各个分布式能源的控制参数，降低数据通讯成本，实现微电网快速响应的同时保证微电网的稳定性。2.本发明结合前一时刻各分布式能源的状态数据和控制参数以及后一时刻清洁能源的预测状态数据，利用神经网络对未来时刻各分布式能源的状态数据进行预测，考虑了不同环境状态下，清洁能源的状态数据是多变的，所得预测状态数据更精确。3.本发明以微电网稳定程度和控制中心与分布式能源间通信通道的利用率为评价指标确定利用中心化控制分布式能源，可以在保证微电网稳定性的同时降低控制中心与分布式能源间的通信成本。附图说明图1为本发明系统构成图。具体实施方式为了让本领域技术人员更好的理解本发明，下面结合实施例对本发明进行详细描述。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构、或特点可由任何合适形式组合。本发明所述智能微电网具有“并网”与“孤岛”两种自由切换的模式，“孤岛”模式下微电网与其他电网断开连接，仅使用微电网内部的能源，包括燃料电池、微型燃气轮机等相对较稳定的能源，以及风力发电机、光伏电池等清洁能源；“并网”模式下，微电网可以作为一个负载从其他电网中获取电力，也可以作为一个能源，向其他电网提供电力。本发明的主要目的为：利用人工智能技术结合下垂控制使得微电网中各分布式能源能够得到更优的控制，在保证低通信成本的前提下使得分布式能源的输出更加合理。实施例一：该实施例提供了一种基于人工智能的智能微电网能源管理系统，如图1所示，该系统包括参数获取模块、能源选择模块、参数优化模块、能源确定模块，具体地：参数获取模块，用于获取各分布式能源的下垂控制参数；具体地，参数获取模块包括：状态数据获取单元，用于以后一时刻分布式清洁能源的预测状态数据为约束，利用前一时刻各分布式能源的状态数据和下垂控制参数预测后一时刻各分布式能源的状态数据。下垂控制单元，用于基于各分布式能源的状态数据对各分布式能源进行下垂控制，获取各分布式能源的下垂控制参数。该模块首先在状态数据获取单元获取预设时间段初始时刻分布式能源的状态数据，在下垂控制单元根据初始时刻分布式能源的状态数据对微电网进行下垂控制，得到各个分布式能源的控制参数，整合后得到初始时刻的参数控制矩阵，实施例中状态数据指输出功率，控制参数包括输出电压的频率和幅值；之后，在状态数据获取单元利用初始t1时刻各分布式能源的状态数据、初始t1时刻的参数控制矩阵和下一时刻即t2时刻部分分布式能源的预测状态数据预测t2时刻各分布式能源的状态数据；其中，所述部分分布式能源为清洁能源；之后在下垂控制单元基于t2时刻分布式能源的状态数据进行微电网下垂控制，得到t2时刻的参数控制矩阵，同样的，在状态数据获取单元利用t2时刻各分布式能源的状态数据、t2时刻的参数控制矩阵和下一时刻即t3时刻部分分布式能源的预测状态数据预测t3时刻各分布式能源的状态数据；重复上述步骤即可得到多个未来时刻即非初始时刻分布式能源的状态数据。需要说明的是，实施例中将控制参数整合成参数控制矩阵，实施者也可将控制参数整合成其他的数据格式，如一维数组。其中，状态数据获取单元将前一时刻各分布式能源的状态数据、前一时刻的参数控制矩阵和后一时刻分布式清洁能源的预测状态数据输入状态预测网络来预测后一时刻各分布式能源的状态数据。状态预测网络为全连接网络，获取训练数据和标签数据，采用均方误差损失函数进行状态预测网络的训练，其中，训练数据和标签数据的获取方法为：根据实际的微电网在模拟器中搭建仿真微电网，并在模拟器中设置前一时刻各个分布式能源的输出功率和预测的后一时刻部分分布式能源的输出功率，以预测得到的后一时刻部分分布式能源的输出功率为约束，通过前一时刻的参数控制矩阵改变各分布式能源输出电压的频率和幅值，得到后一时刻各分布式能源的输出功率。其中，前一时刻各个分布式能源的输出功率、参数控制矩阵和预测得到的后一时刻分布式清洁能源的输出功率为训练数据，后一时刻各个分布式能源的输出功率为标签数据。至此，在模拟器中按照上述步骤持续进行微电网的模拟即可获取多组训练数据和标签数据。在模拟器中以预测得到的后一时刻部分分布式能源的输出功率为约束的原因为，清洁能源和传统发电能源不同，清洁能源的输出功率与天气状态相关，例如，风力会对风力发电能源产生影响，光照会对光伏发电能源产生影响，因此，实施例中预测后一时刻各分布式能源的输出功率时要考虑预测的后一时刻清洁能源的输出功率，具体地预测未来时刻清洁能源输出功率的方法是公知的，可利用神经网络或预测算法来进行输出功率的预测。在模拟器中搭建仿真微电网的好处在于，不需要在微电网中各个分布式能源处安装传感器来获取实时状态数据，并将获取的实时状态数据传输给能源管理中心，可以实现不依赖传输而得到可以使用的状态数据。能源选择模块，用于在预设时间段的初始时刻从分布式能源中选择第一优化能源，在预设时间段的非初始时刻从第一优化能源中选择第二优化能源；其中，非初始时刻指未来时刻；具体地，能源选择模块包括：第一选择单元，在预设时间段的初始时刻基于排列组合规则选择第一优化能源。本实施例遍历所有排列组合方式，得到S个第一优化能源集合，每个第一优化能源集合对应一种能源选择方案，其中，M为分布式能源总个数，i表示选择i个第一优化能源。能源确定模块根据各种能源选择方案的信道利用率以及微电网稳定程度确定最佳能源选择方案。第二选择单元，在预设时间段的每个非初始时刻基于排列组合规则从第一优化能源中选择第二优化能源，每个非初始时刻都得到R个第二优化能源集合，其中，N为第一优化能源集合中第一优化能源的总个数，j表示在第一优化能源集合中选择j个第二优化能源。参数优化模块，用于根据分布式能源的状态数据对能源选择模块所选优化能源的下垂控制参数进行优化并得到参数优化后的微电网稳定程度，具体地：将各分布式能源的状态数据和下垂控制参数输入神经网络，对所选分布式能源的下垂控制参数进行优化，输出优化后各分布式能源的下垂控制参数及其对应的微电网稳定程度；其中，各分布式能源的状态数据和下垂控制参数为各分布式能源在预设时间段内某一时刻的状态数据和下垂控制参数。实施例中结合参数控制矩阵，该模块的实施步骤为：对所选分布式能源对应的参数控制矩阵元素进行标记，获取待优化矩阵，基于该时刻下分布式能源的状态数据对待优化矩阵进行矩阵优化，得到该时刻的优化参数控制矩阵及其对应的微电网稳定程度，具体地：i)对所选分布式能源对应的参数控制矩阵元素进行标记，获取待优化矩阵：实施例中参数控制矩阵设置为M*2的矩阵，矩阵中一行元素代表一个分布式能源输出电压的频率和幅值；则初始时刻可得到S个待优化矩阵，每个未来时刻可得到R个待优化矩阵；选择分布式能源后，在参数控制矩阵中将所选分布式能源对应的相关行的元素标记为0，得到待优化矩阵。ii)参数处理单元基于某一时刻下分布式能源的状态数据对待优化矩阵进行矩阵优化，具体地，将某一时刻的分布式能源的状态数据和待优化矩阵输入矩阵优化网络中进行矩阵优化，输出该时刻的优化参数控制矩阵和优化参数控制矩阵对应的微电网稳定程度；具体地，初始时刻可得到S个优化参数控制矩阵，每个未来时刻可得到R个优化参数控制矩阵。对参数控制矩阵的优化可以通过模拟仿真和最优化算法进行的，但是仿真及优化的次数、时间有限，若每组数据都经过模拟、优化的过程，势必降低系统的响应速度。所以本发明通过模拟、优化的方式，得到大量相对应的数据，而后用这些数据来训练矩阵优化网络，使矩阵优化网络具有优化推理的能力。矩阵优化网络的训练过程为：获取训练数据：矩阵优化网络的训练数据为不同时刻的分布式能源的状态数据和相应的待优化矩阵，分布式能源的状态数据可通过模拟器获得，待优化矩阵可人为对参数控制矩阵进行标记获得。获取标签数据：标签数据为与训练数据相对应的优化参数控制矩阵以及微电网稳定程度。其中，同样使用上述模拟器进行微电网仿真，通过改变分布式能源输出电压的幅值、频率，使得电网得到相应的状态，根据电网该状态下的各分布式能源或线路处电压等来计算该状态下微电网的稳定程度。可选用遗传算法、模拟退火等优化算法对优化参数控制矩阵进行优化，进行优化时目标函数可以有多个，实现多目标优化，也可以设定为单目标函数的优化，实施例中目标函数设定为微电网的稳定程度，优化过程中以分布式能源的控制参数为变量，以微电网稳定程度为目标函数，以让目标函数最小为目标进行优化。矩阵优化网络为全连接网络，基于所获取的训练数据和标签数据，采用均方误差损失函数进行矩阵优化网络的训练。能源确定模块，用于根据预设时间段内控制中心与所选分布式能源间信道的利用率以及微电网的稳定程度确定中心控制能源。本发明旨在考虑微电网的稳定程度的同时让传输信息的通道线路最少，且通道线路内传输的数据尽量少来保证信息传输的成本足够低。具体地，能源确定模块包括：能源寻找单元，用于在每个非初始时刻选择参数优化后微电网最稳定时对应的第二优化能源为第三优化能源，得到第三优化能源集合，也即根据微电网稳定程度在每个未来时刻的 R个优化参数控制矩阵中选择一个最优参数控制矩阵。需要说明的是，初始时刻得到的S个优化参数控制矩阵即为S个最优参数控制矩阵。第一计算单元，用于根据每个非初始时刻的第三优化能源数量与第一优化能源数量的比值计算信道利用率，实施例中信道利用率的具体计算方法为：根据第一优化能源集合和对应的每个非初始时刻的第三优化能源集合得到时序能源集合，即第一优化能源集合和对应的L个非初始时刻的第三优化能源集合构成长度为L+1的时序能源集合，则可得到S个时序能源集合，则时序能源集合中每个第三优化能源集合中第三优化能源数量与第一优化能源数量的比值的和为每个时序能源集合对应的信道利用率，具体地，可用以下公式计算信道利用率：其中，fa表示第a个时序能源集合对应的信道利用率，ua表示第a个时序能源集合中第三优化能源的数量总和，va表示第a个时序能源集合中第一优化能源的数量,a的取值范围为 。微电网的稳定程度可以通过预设时间段内所有时刻的微电网稳定程度累加和获得。为了提高中心控制的效率，本发明提供一种优选的实施方式，通过第二计算单元实现更精确的微电网稳定程度计算。第二计算单元，用于根据对第一优化能源进行参数优化后的微电网稳定程度和第一优化能源的数量计算初始时刻的单位稳定程度，根据对第三优化能源进行参数优化后的微电网稳定程度和第三优化能源的数量计算每个非初始时刻的单位稳定程度，对预设时间段内各时刻的单位稳定程度求和得到微电网的持续稳定程度；实施例中微电网持续稳定程度的具体计算方式为：对时序能源集合中每个优化能源集合对应的微电网稳定程度与能源个数的比值求和得到微电网的持续稳定程度。需要说明，预设时间段内每个时刻都得到S个最优参数控制矩阵，每个最优参数控制矩阵都对应一个微电网稳定程度，预设时间段共L+1个时刻，因此，可得到S行L+1列个微电网稳定程度，L表示有L个非初始时刻，一行数据表示一个时序能源集合中按照时序得到的每个优化能源集合对应的微电网稳定程度。其中，计算单位稳定程度所用微电网稳定程度需要经过归一化处理，具体的归一化过程为：p′a，b表示第a行第b列处微电网稳定程度数据经过归一化处理后的结果，pa，b表示第a行第 b列处微电网稳定程度数据，max表示第b列数据中的微电网稳定程度最大值，min表示第b列数据中的微电网稳定程度最小值,b的取值范围为。每个时序能源集合对应的微电网的持续稳定程度的计算方法为：ga表示第a个时序能源集合对应的微电网的持续稳定程度，oa，b表示第a个时序能源集合中第b个能源集合的能源个数。每种时序能源集合或每种第一优化能源集合对应一种能源选择方案。得到每个时序能源集合对应的信道利用率和微电网的持续稳定程度后，根据利用率和微电网的持续稳定程度确定最佳能源选择方案，从而确定中心控制能源：ha可以用来表示第a个时序能源集合中的第一优化能源集合的优越程度，在S个时序能源集合中选择优越程度最大的时序能源集合中的第一优化能源集合，所选第一优化能源集合中的第一优化能源为中心控制能源。确定好中心控制能源后，可只在控制中心与中心控制能源间铺设通信线路，以减少通信成本，利用中心化控制对所选中心控制能源进行状态调节，即由控制中心给中心控制能源发送控制参数；利用下垂控制对其他分布式能源进行本地状态调节；以尽可能少的通信通道实现参数传输的同时在保证微电网稳定程度的前提下实现微电网有效控制调节。实施例中所述通信包括两类通信方式，分别为光纤通信、无线通信，通信成本除了必要的硬件成本外，还包括传输数据带来的流量成本，本发明主要针对传输数据带来的流量成本，来判断数据的传输必要性，最终获得合适的传输信息。需要注意，实施例中为了系统快速响应，降低信息传输成本，并不直接传输相应的控制参数，而是先把控制参数信息转换为低字节的状态码再传输给中心控制能源，中心控制能源接受状态码后进行解析得到控制参数信息；状态码的转换过程利用自编码网络实现。以上所述旨在让本领域技术人员更好的理解本发明，并不用于限制本发明，凡是在本发明精神和原则之内做出的修改与变动皆在本发明的保护范围内。
