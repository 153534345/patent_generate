标题title
基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统
摘要abst
本发明公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统，该方法包括：确定扩展克雷洛夫角；计算得到偏航角、俯仰角、滚转角和扩展俯仰角在tk时刻的值；确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度；进行状态转移和积分更新解算，得到积分更新解算结果；根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，以提高惯性导航的精度。本发明在原三个克雷洛夫角的基础上增加一个姿态角扩展为四个克雷洛夫角，以正交安装于捷联式惯性系统本体上的陀螺仪输出的角速率作为输入信息，实现了惯性导航姿态角的实时更新，使姿态角更新过程中不出现奇异值，从而提高了解算精度。
权利要求书clms
1.一种基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，包括：确定扩展克雷洛夫角其中，扩展克雷洛夫角用于描述导航坐标系与本体坐标系之间的关系，导航坐标系经过四次转动后到达本体坐标系，四次转动对应的转动角分别记作偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ；计算得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk时刻的值，分别记作：ψk、γk和ξk；确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果；根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，以提高惯性导航的精度。2.根据权利要求1所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，捷联式惯性系统对应的本体坐标系记作O-X′Y′Z′，为动系；其中，OX′轴表示载体的纵轴，OZ′轴表示载体的横纵，OY′轴与OX′轴和OZ′轴组成右手坐标系；描述载体运动姿态角对应的导航坐标系记作O-XYZ，为定系；其中，初始时刻，OX轴指东，OY轴指北，OZ轴指天；本体坐标系O-X′Y′Z′与导航坐标系O-XYZ的原点重合，均以捷联式惯性系统的本体的几何中心为原点。3.根据权利要求1或2所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，导航坐标系到本体坐标系的转动过程如下：导航坐标系O-XYZ绕OZ轴转动到达坐标系O-LNZ；坐标系O-LNZ绕ON轴转动ψ，到达坐标系O-QNM；坐标系O-QNM绕OQ轴转动γ，到达坐标系O-QY′P；坐标系O-QY′P绕OY′轴转动ξ，到达本体坐标系O-X′Y′Z′。4.根据权利要求1所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度包括：在转动过程中，获取tk时刻陀螺仪输出的角速度：其中，陀螺仪安装在捷联式惯性系统本体上；和为tk时刻本体坐标系的三轴角速度分量；则，tk时刻时本体坐标系相对于导航坐标系的角速度为：5.根据权利要求1所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果，包括：当时，有：对ψk、γk和ξk进行状态转移，得到一组新的姿态角ψ′k、γ′k和ξ′k：以得到的新的姿态角ψ′k、γ′k和ξ′k作为初值，进行积分更新解算，得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk+1时刻的值，分别记作：ψk+1、γk+1和ξk+1：其中，tk+1＝tk+ΔT，ΔT表示采样时间。6.根据权利要求1所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果，包括：当或时，有：对ψk、γk和ξk进行状态转移，得到一组新的姿态角ψ′k、γ′k和ξ′k：以得到的新的姿态角ψ′k、γ′k和ξ′k作为初值，进行积分更新解算，得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk+1时刻的值，分别记作：ψk+1、γk+1和ξk+1：ψk+1＝ψ′k其中，tk+1＝tk+ΔT，ΔT表示采样时间。7.根据权利要求1所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ的取值范围均为：-180°～+180°。8.根据权利要求1所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，安装在捷联式惯性系统本体上的陀螺仪为3个单自由度陀螺仪或2个双自由度陀螺仪。9.根据权利要求5或6所述的基于扩展克雷洛夫角的惯性导航姿态角解算方法，其特征在于，根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，包括：根据ψk+1、γk+1和ξk+1，进行姿态坐标变换矩阵更新，得到更新后的本体坐标系相对导航坐标系的坐标变换矩阵将更新后的坐标变换矩阵以及视加速度和重力加速度作为速度微分方程的输入，经积分解算后，得到更新后的速度V；将更新后的速度V作为位置微分方程的输入，经积分解算后，得到更新后的位置r。10.一种基于扩展克雷洛夫角的惯性导航姿态角解算系统，其特征在于，包括：第一确定模块，用于确定扩展克雷洛夫角其中，扩展克雷洛夫角用于描述导航坐标系与本体坐标系之间的关系，导航坐标系经过四次转动后到达本体坐标系，四次转动对应的转动角分别记作偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ；计算模块，用于计算得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk时刻的值，分别记作：ψk、γk和ξk；第二确定模块，用于确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度解算模块，用于根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果；更新模块，用于根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，以提高惯性导航的精度。
说明书desc
技术领域本发明属于航空、航天技术领域，尤其涉及一种基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统。背景技术惯性导航广泛应用于导弹、飞机、舰船和兵器等领域，主要作用是实时确定载体相对导航系的位置、速度和姿态信息。捷联式惯性系统与载体直接固连，通过陀螺仪测量角速度并经数学解算后给出三个姿态角的值。目前，确定姿态信息的方法有方向余弦运动学方程、欧拉-克雷洛夫角运动学方程以及四元数运动学方程。方向余弦运动学方程的缺点是变换矩阵的参数为9个、联系式为6个，计算量较大，在工程中应用较少。而采用四元数求解的坐标变换矩阵唯一，但由坐标变换矩阵求解姿态角时不存在唯一解。相对而言，欧拉-克雷洛夫角运动学方程只有3个，但在本技术领域《惯性器件》第46页中，认为用欧拉-克雷洛夫角描述的运动学方程存在奇点，方程会退化。但是，在专利中提出了一种基于克雷洛夫角的姿态解算方法，可以实现载体的全姿态运动描述。但面临的问题是，当俯仰角＝90°时，进行离散化处理时姿态解算的误差较大，从而导致解算的速度和位置误差较大。为此，需要研究一种新型的基于克雷洛夫角的高精度姿态角解算方法，以提高惯性导航精度。发明内容本发明的技术解决问题：克服现有技术的不足，提供一种基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统，在原三个克雷洛夫角的基础上增加一个姿态角扩展为四个克雷洛夫角，以正交安装于捷联式惯性系统本体上的陀螺仪输出的角速率作为基于克雷洛夫运动学方程的输入信息，实现惯性导航姿态角的实时更新，使姿态角更新过程中不出现奇异值，从而提高了解算精度，保证了本体坐标系相对导航坐标系的稳定性。为了解决上述技术问题，本发明公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算方法，包括：确定扩展克雷洛夫角；其中，扩展克雷洛夫角用于描述导航坐标系与本体坐标系之间的关系，导航坐标系经过四次转动后到达本体坐标系，四次转动对应的转动角分别记作偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ；计算得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk时刻的值，分别记作：ψk、γk和ξk；确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果；根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，以提高惯性导航的精度。在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，捷联式惯性系统对应的本体坐标系记作O-X′Y′Z′，为动系；其中，OX′轴表示载体的纵轴，OZ′轴表示载体的横纵，OY′轴与OX′轴和OZ′轴组成右手坐标系；描述载体运动姿态角对应的导航坐标系记作O-XYZ，为定系；其中，初始时刻，OX轴指东，OY轴指北，OZ轴指天；本体坐标系O-X′Y′Z′与导航坐标系O-XYZ的原点重合，均以捷联式惯性系统的本体的几何中心为原点。在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，导航坐标系到本体坐标系的转动过程如下：导航坐标系O-XYZ绕OZ轴转动到达坐标系O-LNZ；坐标系O-LNZ绕ON轴转动ψ，到达坐标系O-QNM；坐标系O-QNM绕OQ轴转动γ，到达坐标系O-QY′P；坐标系O-QY′P绕OY′轴转动ξ，到达本体坐标系O-X′Y′Z′。在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度包括：在转动过程中，获取tk时刻陀螺仪输出的角速度：其中，陀螺仪安装在捷联式惯性系统本体上；和为tk时刻本体坐标系的三轴角速度分量；则，tk时刻时本体坐标系相对于导航坐标系的角速度为：在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果，包括：当时，有：对ψk、γk和ξk进行状态转移，得到一组新的姿态角ψ′k、γ′k和ξ′k：以得到的新的姿态角ψ′k、γ′k和ξ′k作为初值，进行积分更新解算，得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk+1时刻的值，分别记作：ψk+1、γk+1和ξk+1：其中，tk+1＝tk+ΔT，ΔT表示采样时间。在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果，包括：当或时，有：对ψk、γk和ξk进行状态转移，得到一组新的姿态角ψ′k、γ′k和ξ′k：以得到的新的姿态角ψ′k、γ′k和ξ′k作为初值，进行积分更新解算，得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk+1时刻的值，分别记作：ψk+1、γk+1和ξk+1：ψk+1＝ψ′k其中，tk+1＝tk+ΔT，ΔT表示采样时间。在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ的取值范围均为：-180°～+180°。在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，安装在捷联式惯性系统本体上的陀螺仪为3个单自由度陀螺仪或2个双自由度陀螺仪。在上述基于扩展克雷洛夫角的惯性导航姿态角解算方法中，根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，包括：根据ψk+1、γk+1和ξk+1，进行姿态坐标变换矩阵更新，得到更新后的本体坐标系相对导航坐标系的坐标变换矩阵将更新后的坐标变换矩阵以及视加速度和重力加速度作为速度微分方程的输入，经积分解算后，得到更新后的速度V；将更新后的速度V作为位置微分方程的输入，经积分解算后，得到更新后的位置r。相应的，本发明还公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算系统，包括：第一确定模块，用于确定扩展克雷洛夫角；其中，扩展克雷洛夫角用于描述导航坐标系与本体坐标系之间的关系，导航坐标系经过四次转动后到达本体坐标系，四次转动对应的转动角分别记作偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ；计算模块，用于计算得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk时刻的值，分别记作：ψk、γk和ξk；第二确定模块，用于确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度解算模块，用于根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果；更新模块，用于根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，以提高惯性导航的精度。本发明具有以下优点：本发明公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统，相对于3个姿态角描述的姿态角解算，精度提高了1～2个数量级，实现了姿态角的高精度解算。本发明公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统，完全覆盖了4个姿态角在任意象限的情况，有效减小了原有3个姿态角解算方法在俯仰角为±90°时由于离散化造成的量化误差引起的动态误差较大问题。本发明公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统，可直接精确给出本体坐标系相对导航坐标系的姿态角，而四元数只能通过坐标变换矩阵间接给出。本发明公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算方法和系统，首次给出了基于克雷洛夫角的捷联式惯性系统离散化全姿态解算方法，具有精度高的优点。附图说明图1是本发明实施例中一种基于扩展克雷洛夫角的惯性导航姿态角解算方法的步骤流程图；图2为捷联式惯性系统中以克雷洛夫角描述的本体相对导航坐标系的关系示意图；图3为采用原3个克雷洛夫角描述的飞机翻滚三圈过程中解算的三个姿态角；图4为采用原3个克雷洛夫角描述的飞机翻滚三圈过程中解算的三个姿态角误差；图5为本发明基于4个克雷洛夫角描述的飞机翻滚三圈过程中的四个姿态角；图6为本发明基于4个克雷洛夫角描述的飞机翻滚三圈过程中的四个姿态角误差；图7为基于本发明计算的姿态角进行导航解算的飞机运动三维轨迹。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明公开的实施方式作进一步详细描述。如图1，在本实施例中，该基于扩展克雷洛夫角的惯性导航姿态角解算方法，包括：步骤101，确定扩展克雷洛夫角。在本实施例中，扩展克雷洛夫角用于描述导航坐标系与本体坐标系之间的关系，导航坐标系经过四次转动后到达本体坐标系，四次转动对应的转动角分别记作偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ。其中，偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ的取值范围均为：-180°～+180°。如图2所示，捷联式惯性系统对应的本体坐标系记作O-X′Y′Z′，为动系；其中，OX′轴表示载体的纵轴，OZ′轴表示载体的横纵，OY′轴与OX′轴和OZ′轴组成右手坐标系。描述载体运动姿态角对应的导航坐标系记作O-XYZ，为定系；其中，初始时刻，OX轴指东，OY轴指北，OZ轴指天。本体坐标系O-X′Y′Z′与导航坐标系O-XYZ的原点重合，均以捷联式惯性系统的本体的几何中心为原点。优选的，导航坐标系到本体坐标系的转动过程如下：导航坐标系O-XYZ绕OZ轴转动到达坐标系O-LNZ；坐标系O-LNZ绕ON轴转动ψ，到达坐标系O-QNM；坐标系O-QNM绕OQ轴转动γ，到达坐标系O-QY′P；坐标系O-QY′P绕OY′轴转动ξ，到达本体坐标系O-X′Y′Z′。步骤102，计算得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk时刻的值，分别记作：ψk、γk和ξk。步骤103，确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度在本实施例中，在转动过程中，获取tk时刻陀螺仪输出的角速度：则，tk时刻时本体坐标系相对于导航坐标系的角速度为：其中，陀螺仪安装在捷联式惯性系统本体上，且安装在捷联式惯性系统本体上的陀螺仪为3个单自由度陀螺仪或2个双自由度陀螺仪。和为tk时刻本体坐标系的三轴角速度分量。步骤104，根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果。在本实施例中，当时，有：对ψk、γk和ξk进行状态转移，得到一组新的姿态角ψ′k、γ′k和ξ′k：以得到的新的姿态角ψ′k、γ′k和ξ′k作为初值，进行积分更新解算，得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk+1时刻的值，分别记作：ψk+1、γk+1和ξk+1：在本实施例中，当或时，有：对ψk、γk和ξk进行状态转移，得到一组新的姿态角ψ′k、γ′k和ξ′k：以得到的新的姿态角ψ′k、γ′k和ξ′k作为初值，进行积分更新解算，得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk+1时刻的值，分别记作：ψk+1、γk+1和ξk+1：ψk+1＝ψ′k其中，tk+1＝tk+ΔT，ΔT表示采样时间。步骤105，根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，以提高惯性导航的精度。在本实施例中，可以根据ψk+1、γk+1和ξk+1，进行姿态坐标变换矩阵更新，得到更新后的本体坐标系相对导航坐标系的坐标变换矩阵然后，将更新后的坐标变换矩阵以及视加速度和重力加速度作为速度微分方程的输入，经积分解算后，得到更新后的速度V。进一步的，将更新后的速度V作为位置微分方程的输入，经积分解算后，得到更新后的位置r。在上述实施例的基础上，下面通过一组示例对比进行说明。采用捷联式惯性导航解算飞机某次全姿态运动时的姿态角时，如果只采用如下离散化公式进行解算：则，解算得到的解算的1700s～2700s的姿态角如图3所示，图3a、3b、3c依此为滚转角γ、俯仰角ψ、偏航角；对应的姿态角误差如图4所示，图4a、4b、4c依此为滚转角误差dγ、俯仰角误差dψ、偏航角误差。从图4可以看出，在2700s时刻，滚转角误差dγ接近-0.5°，俯仰角误差dψ接近6.2°，偏航角误差接近-0.2°。上述姿态角误差直接导致速度和位置导航结果偏差较大。采用本发明方法解算得到的1700s～2700s的姿态角如图5所示，图5a、5b、5c、5d依次为滚转角γ、俯仰角ψ、偏航角和扩展俯仰角ξ。从5图中可以看出，在1964.66s之前，因此，ψ为0，而γ、ξ按照相应公式进行姿态解算。而在1964.66s时刻，进行状态转移，从初始状态ψ＝0、γ＝-45.0°、ξ＝-13.1°瞬时转移到末端状态ψ＝135.0°、γ＝90.0°、ξ＝-103.2°。在1964.66s之后，因此，为0，而ψ、γ、ξ按照相应公式进行姿态解算。姿态角误差如图6所示，图6a、6b、6c、6d依次为滚转角误差dγ、俯仰角误差dψ、偏航角误差和扩展俯仰角误差dξ。从图6可以看出，最大角度误差不大于0.002°，具备较高的精度。上述姿态角误差引起的速度和位置导航偏差较小可忽略。基于该滚转角γ、俯仰角ψ、偏航角和扩展俯仰角ξ导航解算的飞机运动三维轨迹见图7，可以看出，很好的复现出飞机大姿态高机动的运动过程。上述实施例可以验证本发明的基于扩展克雷洛夫角的惯性导航姿态角解算方法正确，有利于实现全姿态条件下的高精度速度和位置解算。在上述实施例的基础上，本发明还公开了一种基于扩展克雷洛夫角的惯性导航姿态角解算系统，包括：第一确定模块，用于确定扩展克雷洛夫角；其中，扩展克雷洛夫角用于描述导航坐标系与本体坐标系之间的关系，导航坐标系经过四次转动后到达本体坐标系，四次转动对应的转动角分别记作偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ。计算模块，用于计算得到偏航角俯仰角ψ、滚转角γ和扩展俯仰角ξ在tk时刻的值，分别记作：ψk、γk和ξk。第二确定模块，用于确定转动过程中，tk时刻时本体坐标系相对于导航坐标系的角速度解算模块，用于根据确定的ψk、γk、ξk和进行状态转移和积分更新解算，得到积分更新解算结果。更新模块，用于根据积分更新解算结果，进行坐标变换矩阵更新，并支撑速度更新和位置更新，以提高惯性导航的精度。对于系统实施例而言，由于其与方法实施例相对应，所以描述的比较简单，相关之处参见方法实施例部分的说明即可。本发明虽然已以较佳实施例公开如上，但其并不是用来限定本发明，任何本领域技术人员在不脱离本发明的精神和范围内，都可以利用上述揭示的方法和技术内容对本发明技术方案做出可能的变动和修改，因此，凡是未脱离本发明技术方案的内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化及修饰，均属于本发明技术方案的保护范围。本发明说明书中未作详细描述的内容属于本领域专业技术人员的公知技术。
