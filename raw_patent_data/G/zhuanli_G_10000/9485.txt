标题title
一种基于改进灰狼算法优化BP神经网络的管材成形质量预测方法
摘要abst
本发明提供了一种基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，将改进的灰狼算法，即PGWO，用于优化BP神经网络的权值和阈值，寻找管材自由弯曲成形中工艺参数与成形质量指标间复杂的非线性函数关系，以此提高输入与输出的神经网络预测模型的精度。本发明将数值模拟得到工艺参数和成形指标的数据样本进行归一化处理，根据输入输出节点确定神经网拓扑结构，在传统的灰狼算法优化BP神经网络的基础上，引入粒子群算法参数中矢量速度和惯性权重ω，改进灰狼算法迭代更新位置，训练网络构建PGWO‑BP预测模型；本发明提供的工艺参数预测方法提高了数据预测效率以及分析结果的准确性。
权利要求书clms
1.一种基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于，包括以下步骤：步骤1：通过数值模拟获得管材成形工艺参数与成形指标的实验样本数据；步骤2：对样本数据进行随机排序及归一化处理后，通过经验公式结合网络训练得到的误差最小值，确定神经网络拓扑结构；步骤3：针对管材成形质量预测场景下初始化灰狼参数，设置灰狼数量N，迭代次数I，优化维度D，结合网络拓扑结构初始化参数a、A、C；步骤4：将BP神经网络的初始权值和阈值作为灰狼个体位置，适应度函数为BP神经网络的训练误差值，进行迭代遍历；步骤5：将改进后的灰狼进行包围猎物并位置更新，满足给定精度要求或达到最大迭代次数，停止迭代寻优并输出最佳灰狼位置，否则重复执行所述步骤4；步骤6：所述步骤5得到的最佳位置即为神经网络的最佳权值和阈值，进行BP神经网络训练，得到管材成形质量预测结果。2.根据权利要求1所述的基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于：所述步骤2中的计算公式如式：其中，n1为隐藏节点数，n为输入层节点数，m为输出层节点数，a为1～10的常数。3.根据权利要求1所述的基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于：所述步骤3的计算公式如～式：a＝2-2*t/tmaxA＝2*a*rand1-aC＝2*rand2其中，a为控制因子，随迭代次数增加从2线性递减至0，t为当前迭代次数，tmax为最大迭代次数；A和C为协同系数向量，rand1和rand2为的随机数。4.根据权利要求1所述的基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于：所述步骤5中改进的灰狼进行包围猎物并位置更新的具体步骤如下：步骤5.1：继狼群完成初始化确定个体适应度值后，引入粒子群算法粒子自身运动速度最优解进行记忆保存的思想，增加惯性因子ω完成α、β、δ狼的位置更新；步骤5.2：同时在当前灰狼位置更新的数学模型中增加速度矢量即使得灰狼个体能够记忆狩猎遍历过程中的最优解。5.根据权利要求4所述的基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于，所述步骤5.1中的数学模.型为下～式：其中，分别表示t时刻α、β、δ与其他个体间的距离，分别代表t时刻α、β、δ当前位置，C1、C2、C3为随机向量，为t时刻灰狼位置，ω为一个为非负数的惯性因子，将其选值定为式：ω＝0.5+rand/2其中rand为间的随机数。6.根据权利要求4所述的基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于，所述步骤5.2中的数学模型为：其中，～式分别为灰狼个体朝向α、β、δ前进的步长和方向，A1、A2、A3为随机向量，rand为灰狼数量N和优化维度D的N×D维的随机矩阵，式为灰狼个体在下一时刻的位置，ri为的随机数。
说明书desc
技术领域本发明涉及神经网络预测领域，具体属于一种基于改进灰狼算法优化BP神经网络的管材成形质量预测方法。背景技术由于能够满足高强度、高重量比和冲击能量吸收的要求，弯管零件在航空、航天、汽车和造船等各种高技术行业中得到越来越多的应用。与其他各种弯曲方法如压弯、拉弯、推弯和滚弯相比，三维自由弯曲成形技术是近年来塑性成形领域的一项重要的技术创新。然而，由于多因素的耦合作用和成形理论的局限性，存在起皱、过薄、截面变形和回弹等多种成形缺陷。因此，通过实验、理论和数值方法对弯管成形质量的预测进行了大量的工作。相较于传统的弯管实验加工方法，数值模拟具有快速性和经济性的优点，并因此得到了广泛的应用，但是由于小半径弯管以及多样性管件工艺品的加工工艺复杂，所需的数值模拟分析时间较长，其快速性的优势无法显著体现。针对目前管件自由弯曲成形问题，有研究工作者通过建立BP神经网络对回弹量进行了预测，但没有关注管件成形结果的优劣；也有研究者对成形结果进行预测并用优化算法优化了工艺参数，但在研究中并未对神经网络的初始权值和阈值进行优化，缺少高精度性和有效性；同时传统的灰狼算法存在探索和开发能力难以协调、求解精度低等缺点，对于特定环境下优化BP神经网络进行预测的结果不够理想。因此为了改善管材三维矢量自由弯曲成形过程中出现的成形缺陷，提高其成形质量，有必要借助数值模拟的经济性和改进后适宜的神经网络预测的高效性，完成管材成形的质量预测，实现高效、高精度管材三维矢量自由弯曲成形。发明内容本发明的目的在于提供一种基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，以解决上述背景技术中提出的问题。为实现上述目的，本发明采用了如下技术方案：一种基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于，包括以下步骤：步骤1：通过数值模拟获得管材成形工艺参数与成形指标的实验样本数据；步骤2：对样本数据进行随机排序及归一化处理后，通过经验公式结合网络训练得到的误差最小值，确定神经网络拓扑结构；步骤3：针对管材成形质量预测场景下初始化灰狼参数，设置灰狼数量N，迭代次数I,优化维度D，结合网络拓扑结构初始化参数a、A、C；步骤4：将BP神经网络的初始权值和阈值作为灰狼个体位置，适应度函数为BP神经网络的训练误差值，进行迭代遍历；步骤5：将改进后的灰狼进行包围猎物并位置更新，满足给定精度要求或达到最大迭代次数，停止迭代寻优并输出最佳灰狼位置，否则重复执行所述步骤4；步骤6：所述步骤5得到的最佳位置即为神经网络的最佳权值和阈值，进行BP神经网络训练，得到管材成形质量预测结果。所述步骤2中的计算公式如式：其中，n1为隐藏节点数，n为输入层节点数，m为输出层节点数，a为1～10的常数。所述步骤3的计算公式如～式：a＝2-2*t/tmax A＝2*a*rand1-a C＝2*rand2 其中，a为控制因子，随迭代次数增加从2线性递减至0，t为当前迭代次数，tmax为最大迭代次数；A和C为协同系数向量，rand1和rand2为的随机数。所述步骤5中改进的灰狼进行包围猎物并位置更新的具体步骤如下：步骤5.1：继狼群完成初始化确定个体适应度值后，引入粒子群算法粒子自身运动速度最优解进行记忆保存的思想，增加惯性因子ω完成α、β、δ狼的位置更新；步骤5.2：同时在当前灰狼位置更新的数学模型中增加速度矢量即使得灰狼个体能够记忆狩猎遍历过程中的最优解。所述步骤5.1中的数学模型为下～式：其中，分别表示t时刻α、β、δ与其他个体间的距离，分别代表t时刻α、β、δ当前位置，C1、C2、C3为随机向量，为t时刻灰狼位置，ω为一个为非负数的惯性因子，将其选值定为式：ω＝0.5+rand/2 其中rand为间的随机数。所述步骤5.2中的数学模型为：其中，～式分别为灰狼个体朝向α、β、δ前进的步长和方向，A1、A2、A3为随机向量，rand为灰狼数量N和优化维度D的N×D维的随机矩阵，式为灰狼个体在下一时刻的位置，ri为的随机数。与现有技术相比，本发明具有以下优点：本发明采用神经网络进行管材三维矢量自由成形的成形质量预测，比传统数值模拟进行分析预测要更快速高效，而且对于后续优化工艺参数提供模型基础，并可实现成形结果可视化。同时使用改进后的灰狼算法优化BP神经网络，改善了灰狼算法在优化过程中出现早熟收敛的这一缺陷，实现优化过程协调全局搜索，并提高局部开发能力，使得改进优化后的神经网络具有更高精度的预测性能。附图说明图1为本发明的管材自由弯曲成形质量预测的流程示意图；图2为本发明的改进的灰狼算法的流程示意图。具体实施方式下面将结合本发明的附图，对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例，基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明的保护范围。一种基于改进灰狼算法优化BP神经网络的管材成形质量预测方法，其特征在于，包括以下步骤：步骤1：通过数值模拟获得管材自由弯曲成形工艺参数与成形指标的实验样本数据，为三输入三输出的25组正交实验样本；步骤2：对样本数据进行随机排序及归一化处理后，通过经验公式其中，n1为隐含节点数，n为输入层节点数，m为输出层节点数，a为1～10的常数。得到n1取值，结合网络训练得到不同隐含节点数的误差值，当n1取7时训练误差值最小，确定神经网络拓扑结构为3×7×3，结果如下表1：隐含节点3456789101112训练误差0.850.841.091.160.821.041.291.241.160.92表1不同隐含节点数的BP网络训练误差步骤3：针对工艺参数预测场景下初始化灰狼参数，设置灰狼数量N＝50，迭代次数I＝20,优化维度D＝3，结合网络拓扑结构初始化参数a、A、C,计算公式如～式：a＝2-2*t/tmax A＝2*a*rand1-a C＝2*rand2 其中，a为控制因子，随迭代次数增加从2线性递减至0，t为当前迭代次数，tmax为最大迭代次数；A和C为协同系数向量，rand1和rand2为的随机数。步骤4：将BP神经网络的初始权值和阈值作为灰狼个体位置，适应度函数为BP神经网络的训练误差值，进行迭代遍历；步骤5：将改进后的灰狼进行包围猎物并位置更新，满足给定精度要求或达到最大迭代次数，停止迭代寻优并输出最佳灰狼位置，否则重复执行步骤4。具体步骤如下：步骤5.1：继狼群完成初始化确定个体适应度值后，引入粒子群算法粒子自身运动速度最优解进行记忆保存的思想，增加惯性因子ω完成α、β、δ狼的位置更新；步骤5.2：同时在当前灰狼位置更新的数学模型中增加速度矢量即使得灰狼个体能够记忆狩猎遍历过程中的最优解；步骤5.1中的数学模型为下～式：其中，分别表示t时刻α、β、δ与其他个体间的距离，分别代表t时刻α、β、δ当前位置，C1、C2、C3为随机向量，为t时刻灰狼位置，ω为一个为非负数的惯性因子，将其选值定为式：ω＝0.5+rand/2 其中rand为间的随机数。步骤5.2中的数学模型为以下～式：其中，～式分别为灰狼个体朝向α、β、δ前进步长和方向，A1、A2、A3为随机向量，rand为灰狼数量N和优化维度D的N×D维的随机矩阵，式为灰狼个体在下一时刻的位置，ri为的随机数。步骤6：步骤5得到的最佳位置即为BP神经网络的最佳权值和阈值，进行BP神经网络训练，得到管材成形质量预测结果。表2为改进的灰狼算法和其他传统算法的寻优实验结果比较预测模型BPPSO-BPGWO-BPPGWO-BP均方误差0.14790.07520.01250.00439表2不同算法优化BP神经网络预测误差以上显示和描述了本发明的基本原理、主要特征和本发明的优点。本行业的技术人员应该了解，本发明不受上述实施例的限制，上述实施例和说明书中描述的仅为发明的优选例，并不用来限制本发明，在不脱离本发明新型精神和范围的前提下，本发明还会有各种变化和改进，这些变化和改进都落入要求保护的本发明范围内。本发明要求保护范围由所附的权利要求书及其等效物界定。
