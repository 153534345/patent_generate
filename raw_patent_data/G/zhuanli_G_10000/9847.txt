标题title
基于改进Transformer模型的RNA状态推断研究方法
摘要abst
本发明公开了一种基于改进Transformer模型的RNA状态推断研究方法，其方法为：第一步：搭建所需要的模块；第二步：进行模型训练数据清洗；第三步：设置训练次数；第四步：计算损失和调整模型参数；第五步：获取模拟的人工Shape‑Data；第六步：预测RNA序列上配对碱基。有益效果：结合生物领域和深度学习领域的知识进行交叉研究，利用计算机模拟算法来节省昂贵的生物实验，为分子生物学领域的研究人员提供更加方便高效的研究工具，同时也为在预测RNA二级结构的方向上进一步证明软约束在RNA二级结构预测模型上对提高模型准确性方面可以有很大的研究价值。
权利要求书clms
1.一种基于改进Transformer模型的RNA状态推断研究方法，其特征在于：其方法包括如下步骤：第一步：根据改进的Transformer模型，搭建所需要的模块，分别是位置编码函数、多头注意力函数、求和归一化函数、前向反馈函数、线性化函数和归一化函数；第二步：进行模型训练数据清洗，首先将数据集RNAStrAlign进行无效数据清除，然后将数据进行维度定档，将大于512nt的核苷酸序列的碱基去除或者将小于512nt的核苷酸序列的碱基进行填充，紧接着对数据进行编码，划分数据集；第三步：通过第一步和第二步得到的结果，将训练数据导入模型进行训练，设置训练次数；第四步：将训练好的模型进行保存，然后将需要预测的RNA序列通过编码和定档，作为训练好的模型的输入，获取状态推断结果，并计算损失和调整模型参数；第五步：根据状态结果的概率值，通过状态推断和Shape-Data之间换算公式，获取模拟的人工Shape-Data；第六步：将Shape-Data数据作为最小自由能的软约束和RNA序列一起输入模型中，预测RNA序列上配对碱基。
说明书desc
技术领域本发明涉及一种RNA状态推断研究方法，特别涉及一种基于改进Transformer模型的RNA状态推断研究方法。背景技术目前，RNA结构的预测在分子生物学的研究已经进行了数十年，与现有的热力学模型和比较序列分析法一起，不断提高RNA二级结构预测的精度。RNA二级结构的计算模拟，引出了两种不同的预测思路。第一种思路是比较分析，拥有相似一级序列的一组RNA具有相似的二级结构，根据这个思想的方法称为比较序列分析法；第二种思路是根据一个RNA序列判断是否可以折叠成稳定的二级结构。Tinoco等最先提出了最小自由能模型，Zuker等人对模型进行了改进，使用动态规划法找到了最佳结构。经过多年研究发现比较序列分析的结果更准确。因此，比较序列分析方法是目前确定二级结构的黄金标准，但一组合适的同源序列往往无法获得。所以，热力学优化仍然是预测RNA碱基配对最广泛使用的方法。生物实验方法：X光结晶学和核磁共振是确定RNA结构的最准确的方法，两者都可以以单碱基对的分辨率提供结构信息。然而，这两种方法的特点是实验成本高和产量低，限制了它们的广泛应用。另外，RNA分子高度不稳定，难以结晶。虽然已经开发了许多使用酶或化学探针结合下一代测序技术来推断RNA分子中核苷酸的状态方法，但其中大多数只能用于在体外捕获RNA二级结构。获得的结构可能与体内构象明显不同。事实上，迄今为止，只有极小比例的已知非编码核酸的结构是通过实验确定的。因此，使用计算方法预测RNA的二级结构是实验室方法的重要替代方法。计算预测方法：计算预测方法根据RNA在生物学中存在的必要条件，在算法模拟程序中作为必须条件来进行筛选符合生物特征的RNA二级结构，以下是当前应用在RNA二级结构预测中最常用的一些算法思想。1.动态规划动态规划是一种用于解决优化问题的编程技术。优化问题是指在众多其他解决方案中寻求最优解决方案的问题。动态规划适用的问题，是需要满足两个基本条件：最佳的子问题构建和重复的子问题。动态编程通过计算一次子问题并将结果记录在表格中以供进一步查找，从而有利于每个子问题的相同性，这将在查找时花费恒定的时间。要解决动态规划应用问题，首先要考虑的是学习最优解的结构特征。然后，以递归方式找到最优解值的定义并计算它。最后一步是用计算出的值构造一个最优解。2.遗传算法遗传算法是一种进化算法，在他的解决方案中存在很多可行的步骤，就如同生物在进化过程中有很多种选择，但是每种选择进化方向都有相应的时机，这种时机在算法中称为适合度，是解决一个问题接下来选择进化方向的度量方法。解决方案被视为复制、变异和可能重组的个体。进化逐渐导致高适应度解决方案的产生和选择。一般而言，遗传算法包括通过突变和选择阶段而受到遗传变异影响的群体。这是由程序员根据需求来实现，例如“最小的”、“最大的”或“适者生存”。遗传算法从第0代开始，一直持续到满足终止条件。在每一代中，完成一些遗传转换，并且通过选择函数过滤群体。最终的结果是一个具有理想品质的群体被磨砺和打磨。3.同源RNA分子序列比较分析根据研究表明RNA分子序列的保守性一般比生物学上的分子结构的保守性要低。例如，大部分tRNA分子的一级排列都有一些不同，但二级结构都是三叶草型，三级结构则是L形。基于这种RNA的特性，提出了比较序列分析。在分子结构预测和序列定位中，比较序列分析可以分为以下领域：结构预测前序列定位，序列定位前结构预测，结构预测和序列定位同步。序列定位前结构预测的方法是假设序列比结构的保守性更不保守，主要的软件是Pfold和foldJ。结构预测前序列定位的方法可以得到很多次优结构，主要软件是MARNA。结构预测和序列定位同步的主要软件是CARNAC和RNAStructure。4.基于最大似然方法：根据机器学习参与的子流程，基于最大似然法的RNA二级结构预测方法通常可分为三步：基于机器学习模型的评分方案、基于最大似然模型的预处理和后处理、基于最大似然模型的预测过程。尽管基于最大似然的方法可以用于评分方案中的参数估计来提高预测精度，但是结构预测仍然被公式化为优化问题，其中估计的参数被用于评估可能构象的分数。众所周知，最大似然技术是由竹富士等人首先引入到RNA二级结构预测过程中的。其建立在努西诺夫和雅各布森假设的基础上，并试图利用由m个相互作用神经元组成的系统，从相邻图中获得一个接近最大值的独立集。然后，通过考虑可能的碱基对的能量贡献，增强了模型的性能，并且使用霍普菲尔德神经网络来获得管理信息系统。HNN准确性不高是因为容易陷入局部极小值。为了避免这个问题，Steeg利用平均场理论网络来识别最佳结构，该结构与具有附加生物约束的复杂目标函数相结合。MFT网络的输入是以一种one-hot编码的RNA序列中的四种类型的碱基，输出是类似于联系表的格式。随后，阿波罗尼等人进一步发展了Steeg的方法，特别是在计算速度方面，因此它可以应用于稍长的RNA序列。此外，该模型在学习阶段和瞬时分辨率阶段都使用平均场近似来更新节点。在另一项研究中，Qasim等人通过建立一个新的MLP模型来获得管理信息系统，从而修改了武富士的工作。该模型包含隐藏层中的h个神经元，其激活功能基于Kolgomorov定理。但由于上述机器学习模型性能相对较差，可用数据量较小，基于机器学习的RNA二级结构预测模型只能处理tRNAs，准确率相对较低。目前，数字图书馆技术的使用正在迅速增加，它们正在极大地改变这种情况。Singh等人提出第一个端到端机器学习模型SPOT-RNA预测RNA二级结构。SPOT-RNA将RNA的二级结构视为一个联系表，并采用超深杂交网络和2D-BLSTMs的集成进行预测。其中，前者从整个序列中捕获上下文信息，后者对RNA结构中长序列依赖性的传播有效。转移学习用于训练SPOT-RNA，以有效利用有限的样本数量。E2Efold是陈等人提出的另一个成功的预测RNA二级结构的深度学习模型。它集成了两个耦合的部分：一个基于转换器的表示序列信息的深度模型，以及一个基于展开算法的多层网络，该算法逐渐加强约束并限制输出空间。SPOT-RNA和E2Efold在几个RNA基准数据集上都显示出优异的性能，大大优于基于最佳分数的方法和基于SCFG的方法。生物实验和计算相结合：在最新的关于RNA二级结构的研究中，Chang教授及其同事首次开发了可以在活细胞中全面分析RNA二级结构的新技术，SHAPE。这种技术可以直接在活细胞中通过引物延伸分析选择性2′-羟基酰化反应，获取有关核苷酸成对或不成对状态相关的Shape-Data，作为辅助信息纳入数据导向最小自由能模型的目标函数中，来提高预测的准确性。由于利用实验来获取Shape-Data效率不高，当前出现了一个新的研究热点方向，即利用计算的方法来模拟Shape-Data，然后将获得Shape-Data作为最小自由能模型的伪能量项，来提高预测精度。例如，德文、叶强利用深度递归神经网络模拟Shape-Data改进RNA二级结构预测。发明内容本发明的目的是通过RNA一级序列对每个碱基配对状态的推断，根据推断内容进行实验构思以提高预测精度，而提供的一种基于改进Transformer模型的RNA状态推断研究方法。本发明提供的基于改进Transformer模型的RNA状态推断研究方法，其方法包括如下步骤：第一步：根据改进的Transformer模型，搭建所需要的模块，分别是位置编码函数、多头注意力函数、求和归一化函数、前向反馈函数、线性化函数和归一化函数；第二步：进行模型训练数据清洗，首先将数据集RNAStrAlign进行无效数据清除，然后将数据进行维度定档，将大于512nt的核苷酸序列的碱基去除或者将小于512nt的核苷酸序列的碱基进行填充，紧接着对数据进行编码，划分数据集；第三步：通过第一步和第二步得到的结果，将训练数据导入模型进行训练，设置训练次数；第四步：将训练好的模型进行保存，然后将需要预测的RNA序列通过编码和定档，作为训练好的模型的输入，获取状态推断结果，并计算损失和调整模型参数；第五步：根据状态结果的概率值，通过状态推断和Shape-Data之间换算公式，获取模拟的人工Shape-Data；第六步：将Shape-Data数据作为最小自由能的软约束和RNA序列一起输入模型中，预测RNA序列上配对碱基。本发明的有益效果：本发明提供的基于改进Transformer模型的RNA状态推断研究方法是结合生物领域和深度学习领域的知识进行交叉研究，利用计算机模拟算法来节省昂贵的生物实验，为分子生物学领域的研究人员提供更加方便高效的研究工具，同时也为在预测RNA二级结构的方向上进一步证明软约束在RNA二级结构预测模型上对提高模型准确性方面可以有很大的研究价值。附图说明图1为本发明所述的RNA状态推断研究方法结构流程示意图。图2为本发明所述的RNA状态推断研究方法数据预处理的示意图。图3为本发明所述的RNA状态推断研究方法改进的Transformer模型示意图。具体实施方式请参阅图1至图3所示：本发明提供的基于改进Transformer模型的RNA状态推断研究方法，其方法包括如下步骤：第一步、模型搭建：使用Transformer模型中的Encoder模块，使用8层Encoder，然后将编码的结果通过两层的全连接层，最后使用一个Sofmax函数，获取每个序列上的碱基对配对的概率。其中每个Encoder模块使用的多头注意力机制配置是8个自注意力，如图3，Encoder的整个执行过程总结如下。1).碱基向量与位置编码，如公式1。X＝Embedding Lookup+Positional Encoding2).自注意力机制，如公式2计算所示：3).self-attention残差连接与LayerNorm，如公式3计算所示。4).下面进行Encoder block结构图中的第4部分，也就是FeedForward，其公式为4，就是两层线性映射并用激活函数激活。Xhidden＝Linear))5).FeedForward残差连接与Layer如公式5所示。Xhidden∈Rbatchsize*seqlen*embeddim第二步、数据处理：对数据集RNAStrAlign的处理流程如图2所示。步骤一、清理掉RNAStrAlign数据集中的所有无效类别数据，即存在“.CT”结尾的数据文件中的无效数据；步骤二、对数据集中的数据进行特征提取，获取CT文件的第一列、第二列碱基和第五列，即碱基索引、碱基表示和配对碱基索引；步骤三、去掉数据集中长度大于512个核苷酸的多余序列，对序列长度小于512的进行填充，统一数据长度；步骤四、对每个序列的数据进行编码，其中A，U，G，C，N分别对应1，2，3，4，0，每个核苷酸是否配对，对应0不配对1配对；步骤五、对数据集进行封装和数据集的划分。采用的是交叉验证中的常用函数train_test_split，其函数功能根据数据集分布，将数据集按相同的分布，划分成三个子集，即训练集、测试集、验证集。第三步、训练模型：通过前面两步利用数据不断的训练模型，数次训练以300Epoch为单位。第四步、调整模型参数：根据数据标签和损失函数，适当调整学习率以及注意力的head数和编码层的层数。第五步、模拟Shape-data：数据通过以上训练，将模型训练完毕得到相应的概率值p，然后通过公式5计算得出f。最后通过公式6计算Shape值，此公式是根据真实的形状数据反推而来。ΔGSHAPE＝2×6ln+1))0.8第六步、结合最小自由能预测RNA二级结构，将之前RNA序列作为输入数据输入最小自由能模型的方法改变为将Shape-data数据和RNA以及序列作为输入一起输入到带有软约束的最小自由能模型中，进行预测RNA二级结构。
