标题title
基于障碍车估计与预测的交叉路口轨迹规划与控制方法
摘要abst
本发明公开了一种基于障碍车估计与预测的交叉路口轨迹规划与控制方法，主要包括：建立无人车动力学模型，无人车运动学模型，以及障碍车的运动模型与量测模型；障碍车轨迹的初步预测：无人车轨迹规划；无人车动力学模型的动态解耦；自抗扰轨迹跟踪控制器设计。本发明针对无人车在含有其它交通参与者的交叉路口中行驶时，在无人车和障碍车运动学模型、交叉路口道路模型已知的基础上，对障碍车的运动轨迹和未来一段时间内的运动状态进行估计与预测，并在此基础上完成轨迹规划，最后使用基于模型动态解耦的自抗扰控制器进行轨迹跟踪，综合考虑轨迹规划的快速性，轨迹跟踪的准确性等性能指标，为无人车通过交叉路口提供高效可靠的行驶方案。
权利要求书clms
1.一种基于障碍车估计与预测的交叉路口轨迹规划与控制方法，其特征在于，包括以下步骤：步骤一、建立无人车动力学模型，无人车运动学模型，以及障碍车的运动模型与量测模型：1)采样时间为T的无人车运动学模型如下所示：式中，表示无人车在地面惯性坐标系下的位置，v为车辆质心处的速度，其方向与车辆前进方向存在夹角β，称为车辆侧滑角；表示车辆横摆角，δf表示前轮偏角；lf和lr为车辆前后轴距，lw为车身宽度；选择为状态变量，u＝T为控制变量；将式表示为：2)无人车动力学模型如下所示：式中，vx和vy分别为车辆纵向速度和横向速度，对应方向的加速度用ax和ay表示；v为纵向和横向的合速度，α为轮胎侧偏角，Fl·,*和Fc·,*分别表示轮胎纵向力和侧向力，其中，·∈{f,r}表示车辆前后轴，*∈{l,r}表示车辆左右轮胎；m为无人车质量，Iz代表无人车的转动惯量；选择为状态变量，ud＝T为控制变量；3)障碍车有两种运动状态，分别为：障碍车在直行道上进行的均匀加速运动和在转弯处进行的协同转弯运动；障碍车的运动模型包括匀加速运动模型和协同转弯运动模型；选取状态变量为设采样周期为T，得到离散形式的匀加速运动模型如下所示：式中，wCA是高斯白噪声，其协方差矩阵为设，所述障碍车做转弯角速度恒为ω0的匀速圆周运动，得到离散形式的协同转弯运动模型如下：式中，wCT是高斯白噪声，其协方差矩阵为4)为获得障碍车运动状态的观测量，取观测量为z＝T，得到障碍车的量测模型如下：是中，wob为量测的高斯白噪声，其协方差矩阵为Qob；步骤二、障碍车轨迹的初步预测：1)采用容积卡尔曼滤波算法对无人车状态进行初步预测，得到状态估计值及协方差矩阵如下：式中，为k时刻的最优估计值；为第k时刻的一步预测值；W为容积卡尔曼滤波增益；z为量测模型中观测量；为量测值的预测；P为第k时刻的一步预测值的协方差矩阵；Pzz为量测值的误差协方差矩阵；P为状态向量的协方差矩阵；2)设：障碍车在直行车道上做匀加速直线运动，在交叉路口处做协同转弯运动，并且转弯方向已知，通过容积卡尔曼滤波算法得到障碍车状态估计值后，将状态估计值代入相应的式或中，即得到预测时域Np内障碍车状态的模型预测值；引入误差修正因子修正上述模型预测值的误差，预测时域Np内障碍车状态预测值如下所示：式和式中，和为第k时刻计算得到的第时刻障碍车状态的实际预测值和模型预测值，和为加速度实际预测值和模型预测值，为加速度估计值，为加速度预测误差；为误差系数，用于衡量加速度预测误差的大小，其选择与障碍车加速度有关；的值与障碍车的加速度及预测时刻有关，随着时间的延长，k时刻的误差对后续时刻的影响越来越小，因此和的值与成反比，比例系数在区间内；经过上述修正，得到障碍车i在预测时域内的状态预测值：步骤三、无人车轨迹规划采用模型预测自适应动态规划算法，用于求解轨迹规划，内容如下：1)首先，基于动态规划和贝尔曼最优性原理，得到每个时刻的无限时域目标函数；然后，考虑预测时域内所有时刻的目标函数，将预测时域的所有无限时域目标函数进行叠加，得到堆叠目标函数，作为模型预测自适应动态规划控制算法的目标函数，表示如下：式中，V为第k时刻预测得到的第i个目标函数；2)设计参数逼近器，对每个预测时刻的目标函数进行逼近，参数逼近器为：V＝wTφ,u),i＝1,...,Np式中，w为参数向量，φ表示回归量；ξ和u分别为第k时刻预测得到的第i个状态量和控制量；模型预测自适应动态规划控制算法的评价模块中，针对性能指标的偏差，设计如下优化问题：式中：求解上述优化问题，得到最优的参数向量w*；将w*代入到式中，即可得到执行模块的优化问题；将模型预测自适应动态规划控制算法与障碍车轨迹预测算法结合，在障碍车行驶状态未知的情况下，当无人车探测到障碍车时，对障碍车在预测时域Np内的位置和速度进行在线预测；执行模块对于直行路段的优化问题为：式中，Nc为控制时域，w为参数向量，φ表示回归量；ξ和u分别为第k时刻预测得到的第i个状态量和控制量；amin和amax分别为加速度的上下界；Nobs为障碍车数量；当探测范围ddet内出现了障碍车时，将加速度的上下界放宽至和δfmin和δfmax分别为前轮偏角的上下界；Δumin和Δumax分别为控制增量Δu的上下界；dsafe为安全距离；j＝1,3，dsafe的取值与无人车所处位置有关，χ1,χ3表示直行状态集合，表示无人车与障碍车的估计位置的相对距离，表示无人车与障碍车的预测位置的相对距离，计算公式如下：对于交叉路口路段，优化问题为：式中，fout和fin分别为与道路外、内边缘避碰的非线性函数；b为车道宽度，R为直行道与交叉路口的连接处的四分之一圆弧的一个半径；χ2表示无人车转弯状态集合；步骤四、无人车动力学模型的动态解耦将各输出量之间的动态耦合作用视为扩张状态，采用扩张状态观测器进行观测，并反馈到控制器加以补偿；针对式所示的无人车动力学模型，选取输出量yd＝T，该动力学模型即为3维输入3维输出的耦合系统；采用小角度假设对该模型进行简化，得到简化模型：令u1＝Flf，u2＝δf，u3＝Flr，则式所述的非线性模型表示为：式中，和f3为非线性函数，表示如下：b11，b22和b33为相应子对象的输入增益：经上述解耦过程，设计如下扩张状态观测器估计子对象的实际状态和扩张状态：式至中，h为积分步长，βx1，βx2，βx3，βy1，βy2，βy3，βv1和βv2为增益系数，δx，δy，δv，αx1，αx2，αy1，αy2，αv1和αv2为可调参数；以状态量x的ESO为例，函数fal,αx1,δx)定义为：步骤五、自抗扰轨迹跟踪控制器设计1)设计自抗扰控制器：包括纵向、横向位置和速度的跟踪微分控制器、扩张状态观测器和非线性误差反馈控制律；其中，所述的跟踪微分控制器安排过渡过程以产生光滑的输入信号和输入微分信号；所述的扩张状态观测器通过控制量和输出量估计系统的状态以及内外扰动；所述的非线性误差反馈控制律将所述的跟踪微分控制器的输出与所述的扩张状态观测器的观测值之间的误差通过非线性组合得到控制量；2)以纵向状态量x为例，跟踪微分控制器的数学模型如下所示：式中，r0为快速因子，h为积分步长，xr为输入信号即纵向参考值，x1跟踪输入信号，x2为跟踪输入信号的变化率；函数fhan定义为：非线性误差反馈控制律的数学表达式如下所示：式中，kx1和kx2为待整定的参数；ux为实际控制量，由误差反馈控制量u0x及扰动估计值zx3的补偿得出；通过不断地测试得到最优参数，即可得到鲁棒性较强的控制效果；同理，得到横向状态量y和速度状态量v的跟踪微分控制器的数学模型和非线性误差反馈控制律的数学表达式。
说明书desc
技术领域本发明涉及障碍车的状态预测、无人车的轨迹规划与轨迹跟踪控制，以无人车在交叉路口环境下的通行为背景，通过预测障碍车未来一段时间的运动状态，设计了一种基于障碍车实时估计与预测的交叉路口轨迹规划与控制算法，适用于无人车在复杂场景下快速安全通过交叉路口，属于轨迹规划领域；背景技术无人驾驶车辆能够高效快速地响应各种复杂的道路情况，在确保安全的基础上，有效避免了诸如酒后驾车、疲劳驾驶等危险驾驶行为，同时还可以有效提高道路利用率；但实际的道路交通系统中存在多种干扰与约束，车辆在这些复杂场景中需要进行精准的判断、决策与控制来保证行车安全和通行效率；特别是在交叉路口中，场景的复杂性尤为凸显；交叉路口汇集了来自各个方向的交通流，是交通拥堵和交通事故的多发地；不同于一般的一维驾驶场景，交叉路口场景中需要兼顾二维的交通流，且其道路几何形状较为复杂，因此对安全性有更高的要求；无人车在复杂场景下的控制问题可以分为两个部分，即轨迹规划和轨迹跟踪控制；针对轨迹规划问题，首先应该需要考虑针对障碍车的避障问题；在车辆的实际行驶过程中，其它交通参与者的实时状态可通过传感器测量获得，但其未来一段时间内的运动状态无法直接得出；因此如何完成对障碍车准确且可靠的轨迹预测，是保证道路交通安全、减轻道路拥堵的关键问题，也是轨迹规划的重难点之一；其次，在轨迹规划的过程中还应当注意避免与交叉路口处的道路发生碰撞，因此如何在轨迹规划中加入道路碰撞约束也是研究重点之一；在基于上述条件得到期望轨迹后，还需要通过对车辆的执行机构发出控制指令，控制车辆的前进方向和速度等，使车辆能够精确、稳定地跟踪期望轨迹行驶；但车辆模型具有强耦合、强非线性的特点，如何处理模型状态之间的耦合，并且设计控制器在复杂的实际驾驶场景中快速、准确、稳定地完成跟踪任务，也是轨迹跟踪控制研究的重点；因此在考虑避障避碰、快速规划、轨迹跟踪精度等多重性能需求的情况下，为实现无人车在交叉路口快速安全行驶，对障碍车状态预测方法以及无人车轨迹规划和轨迹跟踪方法进行研究具有重要的理论意义和现实意义；发明内容无人车在交叉路口行驶的过程中，主要目标是使无人车躲避其它交通参与者，安全快速地通过交叉路口；为保证无人车行驶安全，需要根据其它交通参与者的运动状态和交叉路口的路况为无人车规划合理的行驶轨迹，既不能与其它交通参与者发生碰撞，也不能与交叉路口的道路边缘发生碰撞；为符合实际情况，研究中假设障碍车的运动状态是未知的，因此需要对障碍车的未来一段时间内的运动状态进行估计，同时要在轨迹规划中加入道路碰撞约束，这无疑增加了轨迹规划的难度；为保证无人车能够快速通过交叉路口避免发生拥堵，需要设计合理的控制方案使得无人车能够准确快速沿规划好的路径行进；针对上述现有技术，本发明的目的是为无人车在含有其它交通参与者的交叉路口中行驶时提供一个安全快速的行驶方案，即一种基于障碍车实时估计与预测的交叉路口轨迹规划与控制算法；在无人车和障碍车运动学模型、交叉路口道路模型已知的基础上，对障碍车的运动轨迹和未来一段时间内的运动状态进行估计与预测，并在此基础上完成轨迹规划，最后使用基于模型动态解耦的自抗扰控制器进行轨迹跟踪，综合考虑轨迹规划的快速性，轨迹跟踪的准确性等性能指标，为无人车通过交叉路口提供高效可靠的行驶方案。为了解决上述技术问题，本发明提出的一种基于障碍车估计与预测的交叉路口轨迹规划与控制方法，主要包括：步骤一、建立无人车动力学模型，无人车运动学模型，以及障碍车的运动模型与量测模型；步骤二、障碍车轨迹的初步预测：步骤三、无人车轨迹规划；步骤四、无人车动力学模型的动态解耦；步骤五、自抗扰轨迹跟踪控制器设计；本发明综合考虑轨迹规划的快速性，轨迹跟踪的准确性等性能指标，从而为无人车在含有其它交通参与者的交叉路口中行驶时提供一个安全快速、高效可靠的行驶方案。步骤一包括的具体内容如下：1)采样时间为T的无人车运动学模型如下所示：式中，表示无人车在地面惯性坐标系下的位置，v为车辆质心处的速度，其方向与车辆前进方向存在夹角β，称为车辆侧滑角；表示车辆横摆角，δf表示前轮偏角；lf和lr为车辆前后轴距，lw为车身宽度；选择为状态变量，u＝T为控制变量；将式表示为：2)无人车动力学模型如下所示：式中，vx和vy分别为车辆纵向速度和横向速度，对应方向的加速度用ax和ay表示；v为纵向和横向的合速度，α为轮胎侧偏角，Fl·,*和Fc·,*分别表示轮胎纵向力和侧向力，其中，·∈{f,r}表示车辆前后轴，*∈{l,r}表示车辆左右轮胎；m为无人车质量，Iz代表无人车的转动惯量；选择为状态变量，ud＝T为控制变量；3)障碍车有两种运动状态，分别为：障碍车在直行道上进行的均匀加速运动和在转弯处进行的协同转弯运动；障碍车的运动模型包括匀加速运动模型和协同转弯运动模型；选取状态变量为设采样周期为T，得到离散形式的匀加速运动模型如下所示：式中，wCA是高斯白噪声，其协方差矩阵为设，所述障碍车做转弯角速度恒为ω0的匀速圆周运动，得到离散形式的协同转弯运动模型如下：式中，wCT是高斯白噪声，其协方差矩阵为4)为获得障碍车运动状态的观测量，取观测量为z＝T，得到障碍车的量测模型如下：是中，wob为量测的高斯白噪声，其协方差矩阵为步骤二包括的具体内容如下：1)采用容积卡尔曼滤波算法对无人车状态进行初步预测，得到状态估计值及协方差矩阵如下：式中，为k时刻的最优估计值；为第k时刻的一步预测值；W为容积卡尔曼滤波增益；z为量测模型中观测量；为量测值的预测；P为第k时刻的一步预测值的协方差矩阵；Pzz为量测值的误差协方差矩阵；P为状态向量的协方差矩阵；2)设：障碍车在直行车道上做匀加速直线运动，在交叉路口处做协同转弯运动，并且转弯方向已知，通过容积卡尔曼滤波算法得到障碍车状态估计值后，将状态估计值代入相应的式或中，即得到预测时域Np内障碍车状态的模型预测值；引入误差修正因子修正上述模型预测值的误差，预测时域Np内障碍车状态预测值如下所示：式和式中，和为第k时刻计算得到的第时刻障碍车状态的实际预测值和模型预测值，和为加速度实际预测值和模型预测值，为加速度估计值，为加速度预测误差；为误差系数，用于衡量加速度预测误差的大小，其选择与障碍车加速度有关；和的值与障碍车加速度及预测时刻有关，随着时间的延长，k时刻的误差对后续时刻的影响越来越小，因此和的值与成反比，比例系数应根据实际情况选取，一般在区间内；经过上述修正，得到障碍车i在预测时域内的状态预测值：步骤三包括的具体内容如下：采用模型预测自适应动态规划算法，用于求解轨迹规划，内容如下：1)首先，基于动态规划和贝尔曼最优性原理，得到每个时刻的无限时域目标函数；然后，考虑预测时域内所有时刻的目标函数，将预测时域的所有无限时域目标函数进行叠加，得到堆叠目标函数，作为模型预测自适应动态规划控制算法的目标函数，表示如下：式中，V为第k时刻预测得到的第i个目标函数；2)设计参数逼近器，对每个预测时刻的目标函数进行逼近，参数逼近器为：V＝wTφ,u),i＝1,...,Np式中，w为参数向量，φ表示回归量；ξ和u分别为第k时刻预测得到的第i个状态量和控制量；模型预测自适应动态规划控制算法的评价模块中，针对性能指标的偏差，设计如下优化问题：式中：求解上述优化问题，得到最优的参数向量w*；将w*代入到式中，即可得到执行模块的优化问题；将模型预测自适应动态规划控制算法与障碍车轨迹预测算法结合，在障碍车行驶状态未知的情况下，当无人车探测到障碍车时，对障碍车在预测时域Np内的位置和速度进行在线预测；执行模块对于直行路段的优化问题为：式中，Nc为控制时域；ξ和u分别为第k时刻预测得到的第i个状态量和控制量；amin和amax分别为加速度的上下界；Nobs为障碍车数量；当探测范围ddet内出现了障碍车时，将加速度的上下界放宽至和δfmin和δfmax分别为前轮偏角的上下界；Δumin和Δumax分别为控制增量Δu的上下界；dsafe为安全距离；j＝1,3，dsafe的取值与无人车所处位置有关，χ1,χ3表示直行状态集合，表示无人车与障碍车的估计位置的相对距离，表示无人车与障碍车的预测位置的相对距离，计算公式如下：对于交叉路口路段，优化问题为：式中，fout和fin分别为与道路外、内边缘避碰的非线性函数；b为车道宽度，R为直行道与交叉路口的连接处的四分之一圆弧的一个半径；χ2表示无人车转弯状态集合；步骤四包括的具体内容如下：将各输出量之间的动态耦合作用视为扩张状态，采用扩张状态观测器进行观测，并反馈到控制器加以补偿；针对式所示的无人车动力学模型，选取输出量yd＝T，该动力学模型即为3维输入3维输出的耦合系统；采用小角度假设对该模型进行简化，得到简化模型：令u1＝Flf，u2＝δf，u3＝Flr，则式所述的非线性模型表示为：式中，和f3为非线性函数，表示如下：b11，b22和b33为相应子对象的输入增益：经上述解耦过程，设计如下扩张状态观测器估计子对象的实际状态和扩张状态：式至中，h为积分步长，βx1，βx2，βx3，βy1，βy2，βy3，βv1和βv2为增益系数，δx，δy，δv，αx1，αx2，αy1，αy2，αv1和αv2为可调参数；以状态量x的ESO为例，函数fal,αx1,δx)定义为：步骤五包括的具体内容如下：1)设计自抗扰控制器：包括纵向、横向位置和速度的跟踪微分控制器、扩张状态观测器和非线性误差反馈控制律；其中，所述的跟踪微分控制器安排过渡过程以产生光滑的输入信号和输入微分信号；所述的扩张状态观测器通过控制量和输出量估计系统的状态以及内外扰动；所述的非线性误差反馈控制律将所述的跟踪微分控制器的输出与所述的扩张状态观测器的观测值之间的误差通过非线性组合得到控制量；2)以纵向状态量x为例，跟踪微分控制器的数学模型如下所示：式中，r0为快速因子，h为积分步长，xr为输入信号即纵向参考值，x1跟踪输入信号，x2为跟踪输入信号的变化率；函数fhan定义为：非线性误差反馈控制律的数学表达式如下所示：式中，kx1和kx2为待整定的参数；ux为实际控制量，由误差反馈控制量u0x及扰动估计值zx3的补偿得出；通过不断地测试得到最优参数，即可得到鲁棒性较强的控制效果。同理，根据上述方法可以得出横向状态量y和速度状态量v的跟踪微分控制器的数学模型和非线性误差反馈控制律的数学表达式。与现有技术相比，本发明的有益效果是：本发明所提出的预测方法能够准确预测障碍车辆的轨迹和速度，并且能够准确反映障碍车未来的运动趋势，同时轨迹规划算法能够保证无人车与道路边缘和障碍车均无碰撞，说明障碍车状态预测算法能够为无人车提供较为可靠的预测信息，保证无人车在轨迹规划的过程中成功避障，并且所设计的自抗扰控制器控制效果良好，跟踪误差较小。因此，本发明中的基于障碍车实时估计与预测的交叉路口轨迹规划与控制算法具有可行性。附图说明图1是实现本发明方法的控制系统流程图；图2是本发明方法中自抗扰控制器结构图；图3是本发明中涉及的交叉路口场景示意图；图4是实施例的轨迹规划仿真结果图。具体实施方式本发明属于轨迹规划领域，其设计思路是：以无人车在交叉路口环境下的通行为背景，通过预测障碍车未来一段时间的运动状态，设计一种基于障碍车实时估计与预测的交叉路口轨迹规划与控制方法，主要包括障碍车的状态预测、无人车的轨迹规划与轨迹跟踪控制，从而实现无人车在复杂场景下快速安全通过交叉路口；下面结合附图及具体实施例对本发明做进一步的说明，但下述实施例绝非对本发明有任何限制；无人驾驶车辆能够提高驾驶安全性，减少人类在驾驶方面的劳动。由于车载传感器无法预知障碍车的驾驶意图，也无法获得未来一段时间内障碍车的运动状态，因此本发明采用容积卡尔曼滤波对障碍车的运动状态进行估计，并设计了误差修正策略，与障碍车的运动学模型结合完成对状态的多步预测。然后基于获得的运动轨迹预测结果对无人车进行轨迹规划。由于无人车动力学模型具有强耦合、非线性的特点，本发明采用动态解耦的方法对模型进行解耦，并利用自抗扰算法设计了轨迹跟踪控制器。本发明的控制系统流程图如图1所示，具体过程如下：1、模型建立本发明涉及到的模型有无人车动力学模型，无人车运动学模型，以及障碍车的运动模型与量测模型。首先介绍交叉路口场景。图3为本发明所研究的交叉路口场景示意图，车道宽度为b，各车道依次以进行命名。直行道与交叉路口的连接处是一个半径为R的四分之一圆弧，O为该圆弧圆心。本发明假设车辆在路口处可以没有任何限制地左转、右转和直行。R1，R2，R3和R4是位于车道中心线上的点，其中R1R2和R3R4表示直行路段，R2R3表示交叉路口路段。本发明采用采样时间为T的无人车运动学模型如下所示：v＝v+T·a上式中表示无人车在地面惯性坐标系下的位置，v为车辆质心处的速度，其方向与车辆前进方向存在夹角β，称为车辆侧滑角。表示车辆横摆角，δf表示前轮偏角。lf和lr为车辆前后轴距，lw为车身宽度。选择为状态变量，u＝T为控制变量。因此，上式可以表示为：无人车的动力学模型描述为：其中，vx和vy分别为车辆纵向速度和横向速度，对应方向的加速度用ax和ay表示。v为纵向和横向的合速度，α为轮胎侧偏角，Fl·,*和Fc·,*分别表示轮胎纵向力和侧向力，其中，·∈{f,r}表示车辆前后轴，*∈{l,r}表示车辆左右轮胎。m为无人车质量，Iz代表无人车的转动惯量。选择为状态变量，ud＝T为控制变量。本发明所设计场景中，障碍车有两种运动状态，分别为在直行道上进行的均匀加速运动，和在转弯处进行的协同转弯运动。选取状态变量为设采样周期为T，可得到离散形式的匀加速运动模型：其中，wCA是高斯白噪声，其协方差矩阵为协同转弯模型假设障碍车做转弯角速度恒为ω0的匀速圆周运动，离散形式的协同转弯运动模型如下：其中，wCT是高斯白噪声，其协方差矩阵为为获得障碍车运动状态的观测量，还需设计量测模型。取观测量为z＝T，量测模型可表示为：其中，wob为量测的高斯白噪声，其协方差矩阵为2、障碍车轨迹的多步预测障碍车的运动模型和量测模型中均带有高斯白噪声，为对障碍车运动状态进行最优估计，需要选取合适的滤波算法减少噪声干扰，以获得干扰较弱的信号。容积卡尔曼滤波算法较传统卡尔曼滤波算法能有效处理复杂度较高的非线性系统，较扩展卡尔曼滤波算法能有效提高精度。因此本发明采用容积卡尔曼滤波对无人车状态进行初步预测，得到状态估计值及协方差矩阵如下：P＝P-WPzzWT其中，为k时刻的最优估计值。为第k时刻的一步预测值。W为容积卡尔曼滤波增益。z为量测模型中观测量。为量测值的预测值。P为第k时刻的一步预测值的协方差矩阵。Pzz为量测值的误差协方差矩阵。P为状态向量的协方差矩阵。假设障碍车在直行车道上做匀加速直线运动，在交叉路口处做协同转弯运动，并且转弯方向已知，障碍车需要根据自身位置选择相应的滤波模型和预测模型，通过容积卡尔曼滤波算法得到障碍车状态估计值后将状态估计值代入到上述障碍车运动模型中，障碍车在直行车道上做匀加速直线运动则带入上述的离散形式的匀加速运动模型，障碍车在交叉路口处做协同转弯运动则带入上述的离散形式的协同转弯运动模型，即可得到预测时域Np内障碍车状态的模型预测值。然而，因干扰的存在，这种基于模型的预测方法无法准确反映无人车未来的运动轨迹。另外，由于无人车无法直接观测到障碍车在预测时域内的加速度，因此，对障碍车状态预测的误差主要由加速度误差导致。本发明针对该问题设计了一种误差修正策略，引入误差修正因子修正模型预测值的误差，得到较为可靠的障碍车状态预测值。其中，和为第k时刻计算得到的第时刻障碍车状态的实际预测值和模型预测值，和为加速度实际预测值和模型预测值，为加速度估计值，为加速度预测误差。为误差系数，用于衡量加速度预测误差的大小。和的值与障碍车的加速度有关，应根据实际情况选取。经过修正，即可得到障碍车i在预测时域内的状态预测值3、无人车轨迹规划本发明提出了模型预测自适应动态规划算法，用于求解轨迹规划问题。首先，基于动态规划和贝尔曼最优性原理，得到每个时刻的无限时域目标函数。然后，考虑预测时域内所有时刻的目标函数，将预测时域的所有无限时域目标函数进行叠加，得到堆叠目标函数，作为MPADP算法的目标函数。表示如下：其中，V为第k时刻预测得到的第i个目标函数。设计参数逼近器对每个预测时刻的目标函数进行逼近，参数逼近器为：V＝wTφ,u),i＝1,...,Np其中，w为参数向量，φ表示回归量。ξ和u分别为第k时刻预测得到的第i个状态量和控制量。MPADP算法的评价模块中，针对性能指标的偏差，设计如下优化问题：s.t.wTφ,u)＞0其中：求解上述优化问题，即可得到最优的参数向量w*。将w*代入到参数逼近器中，即可得到执行模块的优化问题。将MPADP算法与障碍车轨迹预测算法结合。在障碍车行驶状态未知的情况下，当无人车探测到障碍车时，会对障碍车在预测时域Np内的位置和速度进行在线预测。执行模块对于直行路段的优化问题为：其中，Nc为控制时域。ξ和u分别为第k时刻预测得到的第i个状态量和控制量。amin和amax分别为加速度的上下界。Nobs为障碍车数量。当探测范围ddet内出现了障碍车时，将加速度的上下界放宽至和δfmin和δfmax分别为前轮偏角的上下界。Δumin和Δumax分别为控制增量Δu的上下界；dsafe为安全距离；j＝1,3，dsafe的取值与无人车所处位置有关，χ1,χ3表示直行状态集合，表示无人车与障碍车的估计位置的相对距离，表示无人车与障碍车的预测位置的相对距离，二者计算公式如下：对于交叉路口路段，优化问题为：其中，fout和fin分别为与道路外、内边缘避碰的非线性函数。χ2表示无人车转弯状态集合。4、无人车动力学模型的动态解耦由于无人车的动力学模型具有很强的耦合性，因此本发明将各输出量之间的动态耦合作用视为扩张状态，采用扩张状态观测器进行观测，并反馈到控制器加以补偿。针对无人车动力学模型，选取输出量yd＝T，动力学模型即为3维输入3维输出的耦合系统。然后采用小角度假设对模型进行简化，即可得到简化模型：令u1＝Flf，u2＝δf，u3＝Flr，则上述非线性模型可表示为：其中，和f3为非线性函数，表示如下：b11，b22和b33为相应子对象的输入增益：经上述解耦过程，设计如下ESO估计子对象的实际状态和扩张状态：其中，h为积分步长，βx1，βx2，βx3，βy1，βy2，βy3，βv1和βv2为增益系数，δx，δy，δv，αx1，αx2，αy1，αy2，αv1和αv2为可调参数。以状态量x的ESO为例，函数fal,αx1,δx)定义为：5、自抗扰轨迹跟踪控制器设计本发明所设计的自抗扰控制器基本结构如图2所示，该控制器包括纵向、横向位置和速度的跟踪微分控制器、ESO和非线性误差反馈控制律。其中，TD安排过渡过程以产生光滑的输入信号和输入微分信号；ESO通过控制量和输出量估计系统的状态以及内外扰动；NLSEF将TD的输出与ESO的观测值之间的误差通过非线性组合得到控制量。其中，ESO已经在上文中说明。以纵向状态量x为例，自抗扰控制器中的TD的数学模型如下所示：其中，r0为快速因子，h为积分步长，xr为输入信号即纵向参考值，x1跟踪输入信号，x2为跟踪输入信号的变化率。函数fhan定义为：NLSEF的数学表达式如下所示：其中，kx1和kx2为待整定的参数。ux为实际控制量，由误差反馈控制量u0x及扰动估计值zx3的补偿得出。通过调参，即可得到鲁棒性较强的控制效果。业内人员按照上述方法同样可以得出横向状态量y和速度状态量v的跟踪微分控制器的数学模型和非线性误差反馈控制律的数学表达式，在此不再赘述。该实施方式通过程序编写完成模型建立、算法验证等过程，通过大量的数据，以验证所提出障碍车预测算法在交叉路口场景轨迹规划和轨迹跟踪中应用的有效性；本发明中以无人车在交叉路口行驶并躲避两辆障碍车为背景，开展测试；在完成数据处理后，得到结果如图4所示；图4为轨迹规划结果图，包括，无人车整体轨迹图，交叉路口处的局部放大图，无人车与障碍车之间的距离示意图即子图。仿真结果表明，本发明所提出的预测方法能够准确预测障碍车辆的轨迹和速度，并且能够准确反映障碍车未来的运动趋势，同时轨迹规划算法能够保证无人车与道路边缘和障碍车均无碰撞，说明障碍车状态预测算法能够为无人车提供较为可靠的预测信息，保证无人车在轨迹规划的过程中成功避障，并且所设计的自抗扰控制器控制效果良好，跟踪误差较小。本发明中的基于障碍车实时估计与预测的交叉路口轨迹规划与控制算法具有可行性。尽管上面结合附图对本发明进行了描述，但是本发明并不局限于上述的具体实施方式，上述的具体实施方式仅仅是示意性的，而不是限制性的，本领域的普通技术人员在本发明的启示下，在不脱离本发明宗旨的情况下，还可以做出很多变形，这些均属于本发明的保护之内。
