标题title
提升SSD低命令深度读性能方法、装置、计算机设备及存储介质
摘要abst
本发明涉及提升SSD低命令深度读性能方法、装置、计算机设备及存储介质，该方法，包括：获取第一个读命令；解析第一个读命令，将读请求发送给NAND；将数据移动至数据页中；将数据传输给主机；获取第二个读命令；解析第二个读命令，发送两笔读请求给NAND；将对应第一笔读请求的数据移动至数据页中，将对应第二笔读请求的数据移动至缓存页中；将数据传输给主机；获取新读命令；解析新读命令，发送两笔读请求给NAND；将对应第二笔读请求的数据从缓存页中拷贝至数据页中，将对应第三笔读请求的数据移动至数据页中，将对应第四笔读请求的数据移动至缓存页中；将数据传输给主机。本发明提升了SSD的低命令深度顺序读性能。
权利要求书clms
1.提升SSD低命令深度读性能方法，其特征在于，包括以下步骤：获取主机下发的第一个读命令；解析第一个读命令，获得读请求，并将读请求发送给NAND；NAND将对应读请求的数据移动至数据页中；将对应读请求的数据从数据页中传输给主机；获取主机下发的第二个读命令；解析第二个读命令，若第二个读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第一笔读请求和第二笔读请求；NAND将对应第一笔读请求的数据移动至数据页中，同时将对应第二笔读请求的数据移动至缓存页中；将对应第一笔读请求的数据从数据页中传输给主机；获取主机下发的新读命令；解析新读命令，若新读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第三笔读请求和第四笔读请求；NAND将对应第二笔读请求的数据从缓存页中拷贝至数据页中，然后将对应第三笔读请求的数据移动至数据页中，同时将对应第四笔读请求的数据移动至缓存页中；将对应第二笔读请求的数据和对应第三笔读请求的数据从数据页中传输给主机，然后返回执行步骤“获取主机下发的新读命令”。2.根据权利要求1所述的提升SSD低命令深度读性能方法，其特征在于，所述获取主机下发的第一个读命令步骤中，通过片上系统获取主机下发的第一个读命令。3.根据权利要求2所述的提升SSD低命令深度读性能方法，其特征在于，所述解析第一个读命令，获得读请求，并将读请求发送给NAND步骤中，通过片上系统解析第一个读命令，获得读请求，并将读请求发送给NAND。4.根据权利要求3所述的提升SSD低命令深度读性能方法，其特征在于，所述将对应读请求的数据从数据页中传输给主机步骤中，通过片上系统将对应读请求的数据从数据页中传输给主机。5.提升SSD低命令深度读性能装置，其特征在于，包括：第一获取单元，第一解析发送单元，第一移动单元，第一传输单元，第二获取单元，第二解析发送单元，第二移动单元，第二传输单元，第三获取单元，第三解析发送单元，拷贝移动单元，及传输返回单元；所述第一获取单元，用于获取主机下发的第一个读命令；所述第一解析发送单元，用于解析第一个读命令，获得读请求，并将读请求发送给NAND；所述第一移动单元，用于NAND将对应读请求的数据移动至数据页中；所述第一传输单元，用于将对应读请求的数据从数据页中传输给主机；所述第二获取单元，用于获取主机下发的第二个读命令；所述第二解析发送单元，用于析第二个读命令，若第二个读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第一笔读请求和第二笔读请求；所述第二移动单元，用于NAND将对应第一笔读请求的数据移动至数据页中，同时将对应第二笔读请求的数据移动至缓存页中；所述第二传输单元，用于将对应第一笔读请求的数据从数据页中传输给主机；所述第三获取单元，用于获取主机下发的新读命令；所述第三解析发送单元，用于解析新读命令，若新读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第三笔读请求和第四笔读请求；所述拷贝移动单元，用于NAND将对应第二笔读请求的数据从缓存页中拷贝至数据页中，然后将对应第三笔读请求的数据移动至数据页中，同时将对应第四笔读请求的数据移动至缓存页中；所述传输返回单元，用于将对应第二笔读请求的数据和对应第三笔读请求的数据从数据页中传输给主机，然后返回执行获取主机下发的新读命令。6.根据权利要求5所述的提升SSD低命令深度读性能装置，其特征在于，所述第一获取单元中，通过片上系统获取主机下发的第一个读命令。7.根据权利要求6所述的提升SSD低命令深度读性能装置，其特征在于，所述第一解析发送单元中，通过片上系统解析第一个读命令，获得读请求，并将读请求发送给NAND。8.根据权利要求7所述的提升SSD低命令深度读性能装置，其特征在于，所述第一传输单元中，通过片上系统将对应读请求的数据从数据页中传输给主机。9.一种计算机设备，其特征在于，所述计算机设备包括存储器及处理器，所述存储器上存储有计算机程序，所述处理器执行所述计算机程序时实现如权利要求1-4中任一项所述的提升SSD低命令深度读性能方法。10.一种存储介质，其特征在于，所述存储介质存储有计算机程序，所述计算机程序包括程序指令，所述程序指令当被处理器执行时可实现如权利要求1-4中任一项所述的提升SSD低命令深度读性能方法。
说明书desc
技术领域本发明涉及提升SSD低命令深度读性能技术领域，尤其是指提升SSD低命令深度读性能方法、装置、计算机设备及存储介质。背景技术SSD固态硬盘作为一种新型存储介质，其采用NAND颗粒作为数据存储，相比于传统HDD，其最大优势在于拥有很高的顺序读性能，通常主机端需要同时发送超过8个读命令给SSD，这样才能跑出最好性能，但是对于小于这个深度的顺序读请求，SSD的读效率偏低，因此无法满足需求。发明内容本发明的目的在于克服现有技术的不足，提供提升SSD低命令深度读性能方法、装置、计算机设备及存储介质。为了解决上述技术问题，本发明采用如下技术方案：提升SSD低命令深度读性能方法，包括以下步骤：获取主机下发的第一个读命令；解析第一个读命令，获得读请求，并将读请求发送给NAND；NAND将对应读请求的数据移动至数据页中；将对应读请求的数据从数据页中传输给主机；获取主机下发的第二个读命令；解析第二个读命令，若第二个读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第一笔读请求和第二笔读请求；NAND将对应第一笔读请求的数据移动至数据页中，同时将对应第二笔读请求的数据移动至缓存页中；将对应第一笔读请求的数据从数据页中传输给主机；获取主机下发的新读命令；解析新读命令，若新读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第三笔读请求和第四笔读请求；NAND将对应第二笔读请求的数据从缓存页中拷贝至数据页中，然后将对应第三笔读请求的数据移动至数据页中，同时将对应第四笔读请求的数据移动至缓存页中；将对应第二笔读请求的数据和对应第三笔读请求的数据从数据页中传输给主机，然后返回执行步骤“获取主机下发的新读命令”。其进一步技术方案为：所述获取主机下发的第一个读命令步骤中，通过片上系统获取主机下发的第一个读命令。其进一步技术方案为：所述解析第一个读命令，获得读请求，并将读请求发送给NAND步骤中，通过片上系统解析第一个读命令，获得读请求，并将读请求发送给NAND。其进一步技术方案为：所述将对应读请求的数据从数据页中传输给主机步骤中，通过片上系统将对应读请求的数据从数据页中传输给主机。提升SSD低命令深度读性能装置，包括：第一获取单元，第一解析发送单元，第一移动单元，第一传输单元，第二获取单元，第二解析发送单元，第二移动单元，第二传输单元，第三获取单元，第三解析发送单元，拷贝移动单元，及传输返回单元；所述第一获取单元，用于获取主机下发的第一个读命令；所述第一解析发送单元，用于解析第一个读命令，获得读请求，并将读请求发送给NAND；所述第一移动单元，用于NAND将对应读请求的数据移动至数据页中；所述第一传输单元，用于将对应读请求的数据从数据页中传输给主机；所述第二获取单元，用于获取主机下发的第二个读命令；所述第二解析发送单元，用于析第二个读命令，若第二个读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第一笔读请求和第二笔读请求；所述第二移动单元，用于NAND将对应第一笔读请求的数据移动至数据页中，同时将对应第二笔读请求的数据移动至缓存页中；所述第二传输单元，用于将对应第一笔读请求的数据从数据页中传输给主机；所述第三获取单元，用于获取主机下发的新读命令；所述第三解析发送单元，用于解析新读命令，若新读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第三笔读请求和第四笔读请求；所述拷贝移动单元，用于NAND将对应第二笔读请求的数据从缓存页中拷贝至数据页中，然后将对应第三笔读请求的数据移动至数据页中，同时将对应第四笔读请求的数据移动至缓存页中；所述传输返回单元，用于将对应第二笔读请求的数据和对应第三笔读请求的数据从数据页中传输给主机，然后返回执行获取主机下发的新读命令。其进一步技术方案为：所述第一获取单元中，通过片上系统获取主机下发的第一个读命令。其进一步技术方案为：所述第一解析发送单元中，通过片上系统解析第一个读命令，获得读请求，并将读请求发送给NAND。其进一步技术方案为：所述第一传输单元中，通过片上系统将对应读请求的数据从数据页中传输给主机。一种计算机设备，所述计算机设备包括存储器及处理器，所述存储器上存储有计算机程序，所述处理器执行所述计算机程序时实现如上述所述的提升SSD低命令深度读性能方法。一种存储介质，所述存储介质存储有计算机程序，所述计算机程序包括程序指令，所述程序指令当被处理器执行时可实现如上述所述的提升SSD低命令深度读性能方法。本发明与现有技术相比的有益效果是：针对NAND的读延迟，提前将主机下一笔要读取的数据预移动到NAND的缓存页中，减少实时从NAND读取数据的读延迟，当下一笔主机命令到来时，直接从缓存页拷贝到数据页中，然后读取传输给主机，提升了SSD的低命令深度顺序读性能。下面结合附图和具体实施例对本发明作进一步描述。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的提升SSD低命令深度读性能方法的流程示意图；图2为本发明实施例提供的提升SSD低命令深度读性能装置的示意性框图；图3为本发明实施例提供的计算机设备的示意性框图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。应当理解，当在本说明书和所附权利要求书中使用时，术语“包括”和“包含”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。还应当理解，在此本发明说明书中所使用的术语仅仅是出于描述特定实施例的目的而并不意在限制本发明。如在本发明说明书和所附权利要求书中所使用的那样，除非上下文清楚地指明其它情况，否则单数形式的“一”、“一个”及“该”意在包括复数形式。还应当进一步理解，在本发明说明书和所附权利要求书中使用的术语“和/或”是指相关联列出的项中的一个或多个的任何组合以及所有可能组合，并且包括这些组合。请参阅图1到图3所示的具体实施例，其中，现有的主机低命令深度的读命令，包括以下步骤：主机通过PCIe Bus发送命令给SOC；SOC解析命令，然后发送读命令给NAND；NAND收到命令后进行需要一个tR的时间，将数据放到Data Page中；NAND的数据准备好后，通知SOC，然后SOC把Data Page中数据通过PCIeBus发送给主机；当数据传输完成，命令完成，然后主机发送下一个顺序读命令。从上面步骤可以看出，低命令深度顺序读的性能计算公式：性能＝Read_Cmd_size/，由于tXFer是固定的时间，那么命令的完成时间主要取决于NAND的数据准备时间tR,而tR的长短决定了读性能的高低。请参阅图1所示，本发明公开了一种提升SSD低命令深度读性能方法，包括以下步骤：S1，获取主机下发的第一个读命令；其中，在S1步骤中，通过片上系统获取主机下发的第一个读命令。S2，解析第一个读命令，获得读请求，并将读请求发送给NAND；其中，在S2步骤中，通过片上系统解析第一个读命令，获得读请求，并将读请求发送给NAND。S3，NAND将对应读请求的数据移动至数据页中；其中，在NAND将对应读请求的数据移动至数据页中后，向片上系统反馈信号。S4，将对应读请求的数据从数据页中传输给主机；其中，在S4步骤中，通过片上系统将对应读请求的数据从数据页中传输给主机。S5，获取主机下发的第二个读命令；其中，通过片上系统获取主机下发的第二个读命令。S6，解析第二个读命令，若第二个读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第一笔读请求和第二笔读请求；其中，通过片上系统解析第二个读命令，然后发送两笔读请求给NAND，第一笔读请求是主机当前待完成的数据，第二笔读请求是主机下一笔将要读取的数据。S7，NAND将对应第一笔读请求的数据移动至数据页中，同时将对应第二笔读请求的数据移动至缓存页中；其中，当NAND将对应第一笔读请求的数据移动至数据页中后，向片上系统反馈信号。S8，将对应第一笔读请求的数据从数据页中传输给主机；其中，通过片上系统将对应第一笔读请求的数据从数据页中传输给主机。S9，获取主机下发的新读命令；其中，通过片上系统获取主机下发的新读命令。S10，解析新读命令，若新读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第三笔读请求和第四笔读请求；其中，通过片上系统解析新读命令，然后发送两笔读请求给NAND，第三笔读请求是主机当前待完成的数据，第四笔读请求是主机下一笔将要读取的数据。S11，NAND将对应第二笔读请求的数据从缓存页中拷贝至数据页中，然后将对应第三笔读请求的数据移动至数据页中，同时将对应第四笔读请求的数据移动至缓存页中；其中，此过程中减少了读命令的准备读时间，所以读命令的性能得到提升。S12，将对应第二笔读请求的数据和对应第三笔读请求的数据从数据页中传输给主机，然后返回执行步骤S9，循环重复步骤S9-S12，如此继续下去，那么主机的读性能接近，读命令长度/tXFer。本发明针对NAND的读延迟，提前将主机下一笔要读取的数据预移动到NAND的缓存页中，减少实时从NAND读取数据的读延迟，当下一笔主机命令到来时，直接从缓存页拷贝到数据页中，然后读取传输给主机，提升了SSD的低命令深度顺序读性能。请参阅图2所示，本发明还公开了一种提升SSD低命令深度读性能装置，包括：第一获取单元10，第一解析发送单元20，第一移动单元30，第一传输单元40，第二获取单元50，第二解析发送单元60，第二移动单元70，第二传输单元80，第三获取单元90，第三解析发送单元100，拷贝移动单元110，及传输返回单元120；所述第一获取单元10，用于获取主机下发的第一个读命令；所述第一解析发送单元20，用于解析第一个读命令，获得读请求，并将读请求发送给NAND；所述第一移动单元30，用于NAND将对应读请求的数据移动至数据页中；所述第一传输单元40，用于将对应读请求的数据从数据页中传输给主机；所述第二获取单元50，用于获取主机下发的第二个读命令；所述第二解析发送单元60，用于析第二个读命令，若第二个读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第一笔读请求和第二笔读请求；所述第二移动单元70，用于NAND将对应第一笔读请求的数据移动至数据页中，同时将对应第二笔读请求的数据移动至缓存页中；所述第二传输单元80，用于将对应第一笔读请求的数据从数据页中传输给主机；所述第三获取单元90，用于获取主机下发的新读命令；所述第三解析发送单元100，用于解析新读命令，若新读命令为顺序读，则发送两笔读请求给NAND，其中，两笔读请求包括第三笔读请求和第四笔读请求；所述拷贝移动单元110，用于NAND将对应第二笔读请求的数据从缓存页中拷贝至数据页中，然后将对应第三笔读请求的数据移动至数据页中，同时将对应第四笔读请求的数据移动至缓存页中；所述传输返回单元120，用于将对应第二笔读请求的数据和对应第三笔读请求的数据从数据页中传输给主机，然后返回执行获取主机下发的新读命令。其中，所述第一获取单元10中，通过片上系统获取主机下发的第一个读命令。其中，所述第一解析发送单元20中，通过片上系统解析第一个读命令，获得读请求，并将读请求发送给NAND。其中，所述第一传输单元40中，通过片上系统将对应读请求的数据从数据页中传输给主机。需要说明的是，所属领域的技术人员可以清楚地了解到，上述提升SSD低命令深度读性能装置和各单元的具体实现过程，可以参考前述方法实施例中的相应描述，为了描述的方便和简洁，在此不再赘述。上述提升SSD低命令深度读性能装置可以实现为一种计算机程序的形式，该计算机程序可以在如图3所示的计算机设备上运行。请参阅图3，图3是本申请实施例提供的一种计算机设备的示意性框图；该计算机设备500可以是终端，也可以是服务器，其中，终端可以是智能手机、平板电脑、笔记本电脑、台式电脑、个人数字助理和穿戴式设备等具有通信功能的电子设备。服务器可以是独立的服务器，也可以是多个服务器组成的服务器集群。参阅图3，该计算机设备500包括通过系统总线501连接的处理器502、存储器和网络接口505，其中，存储器可以包括非易失性存储介质503和内存储器504。该非易失性存储介质503可存储操作系统5031和计算机程序5032。该计算机程序5032包括程序指令，该程序指令被执行时，可使得处理器502执行一种提升SSD低命令深度读性能方法。该处理器502用于提供计算和控制能力，以支撑整个计算机设备500的运行。该内存储器504为非易失性存储介质503中的计算机程序5032的运行提供环境，该计算机程序5032被处理器502执行时，可使得处理器502执行一种提升SSD低命令深度读性能方法。该网络接口505用于与其它设备进行网络通信。本领域技术人员可以理解，图3中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备500的限定，具体的计算机设备500可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。应当理解，在本申请实施例中，处理器502可以是中央处理单元，该处理器502还可以是其他通用处理器、数字信号处理器、专用集成电路、现成可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。其中，通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。本领域普通技术人员可以理解的是实现上述实施例的方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成。该计算机程序包括程序指令，计算机程序可存储于一存储介质中，该存储介质为计算机可读存储介质。该程序指令被该计算机系统中的至少一个处理器执行，以实现上述方法的实施例的流程步骤。因此，本发明还提供一种存储介质。该存储介质可以为计算机可读存储介质。该存储介质存储有计算机程序，其中计算机程序包括程序指令，所述程序指令当被处理器执行时可实现上述的提升SSD低命令深度读性能方法。所述存储介质可以是U盘、移动硬盘、只读存储器、磁碟或者光盘等各种可以存储程序代码的计算机可读存储介质。本领域普通技术人员可以意识到，结合本文中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、计算机软件或者二者的结合来实现，为了清楚地说明硬件和软件的可互换性，在上述说明中已经按照功能一般性地描述了各示例的组成及步骤。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本发明的范围。在本发明所提供的几个实施例中，应该理解到，所揭露的装置和方法，可以通过其它的方式实现。例如，以上所描述的装置实施例仅仅是示意性的。例如，各个单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式。例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。本发明实施例方法中的步骤可以根据实际需要进行顺序调整、合并和删减。本发明实施例装置中的单元可以根据实际需要进行合并、划分和删减。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以是两个或两个以上单元集成在一个单元中。该集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分，或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。上述实施例为本发明较佳的实现方案，除此之外，本发明还可以其它方式实现，在不脱离本技术方案构思的前提下任何显而易见的替换均在本发明的保护范围之内。
