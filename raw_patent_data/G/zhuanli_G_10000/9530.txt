标题title
一种基于CT图像的髂后上棘自动检测与定位方法
摘要abst
本发明属于图像处理技术领域，具体公开了一种基于CT图像的髂后上棘自动检测与定位方法，首先获取人体CT序列图像，进行去噪、增强处理，然后通过图形学操作去除人体CT序列图像中的CT检查床；根据医学数字成像和通信DICOM信息将搜索范围定位到人体躯干下半部分的CT序列数据，获得人体躯干下半部分CT序列图像；在人体躯干下半部分CT序列图像中搜索并锁定骨盆区域，获得骨盆区域CT序列图像；在骨盆区域CT序列图像中搜索并定位左髂后上棘、右髂后上棘特征点。本发明可以自动、快速地检测髂后上棘的位置，并准确地标定其位置，有助于计算机辅助医学图像自动化分析以及医生为病人制定手术方案，能够大大提升自动化配准、定位等操作，有效减轻医生的工作量。
权利要求书clms
1.一种基于CT图像的髂后上棘自动检测与定位方法，其特征在于，包括以下步骤：S1、获取人体CT序列图像，进行去噪、增强处理，然后通过图形学操作去除人体CT序列图像中的CT检查床；S2、基于上述步骤S1的处理结果，根据医学数字成像和通信DICOM信息将搜索范围定位到人体躯干下半部分的CT序列数据，获得人体躯干下半部分CT序列图像；S3、在基于上述步骤S2获得的人体躯干下半部分CT序列图像中搜索并锁定骨盆区域，获得骨盆区域CT序列图像；S4、基于上述步骤S3的骨盆区域CT序列图像中搜索并定位左髂后上棘、右髂后上棘特征点。2.根据权利要求1所述的基于CT图像的髂后上棘自动检测与定位方法，其特征在于，所述步骤S1具体为：采取常规的高斯滤波器进行图像去噪，采取常规的频域增强算法对人体CT序列图像进行增强等预处理，在不损失图像信息的前提下提升影像质量，同时采用图形学膨胀、腐蚀去除CT检查床。3.根据权利要求1所述的基于CT图像的髂后上棘自动检测与定位方法，其特征在于，所述的步骤S2具体为：根据医学数字成像和通信DICOM信息中的病人位置信息判断人体CT检查时候的体位，同时结合医学数字成像和通信DICOM信息中的病人影像位置的Z轴坐标值判断骨盆的位置，定位人体躯干下半部分CT序列数据，从而排除人体躯干上半部分CT序列数据，获得人体躯干下半部分CT序列图像。4.根据权利要求1所述的基于CT图像的髂后上棘自动检测与定位方法，其特征在于，所述的步骤S3具体为：步骤S31、根据上述步骤S2获得的人体躯干下半部分CT序列图像，对这部分序列的每一张CT图像进行处理，利用骨头特征点、边缘信息，结合阈值判断，检测左、右髋骨脊与脊椎之间的距离；步骤S32、当左、右髋骨脊与脊椎之间的距离小于左右髋骨脊之间的最小距离时即确定为骨盆区域，从而获得骨盆区域CT序列图像。5.根据权利要求1所述的基于CT图像的髂后上棘自动检测与定位方法，其特征在于，所述地步骤S4具体为：步骤S41、对骨盆区域CT序列图像进行二值化处理，利用阈值去除器官、皮肤，仅保留骨组织；步骤S42、基于上述步骤S41，将只有骨组织的骨盆区域CT序列图像垂直划分为左、右兴趣区域，以分别搜索左、右两侧髂后上棘；步骤S43、对步骤S42获得的左兴趣区域的右边缘和右兴趣区域的左边缘进行裁剪，以消除骶骨和尾骨的干扰；步骤S44、基于上述步骤S43，根据左兴趣区域、右兴趣区域的Y轴坐标值Y轴坐标值确定左髂后上棘、右髂后上棘。6.根据权利要求5所述的基于CT图像的髂后上棘自动检测与定位方法，其特征在于，所述步骤S41中的二值化处理具体过程为：给定下阈值LT和上阈值UT，LT＝PSIS_WL-PSIS_WW/2，UT＝PSIS_WL+PSIS_WW/2，将范围内的体积值设置为前景1或背景0，生成二进制图像。7.根据权利要求6所述的基于CT图像的髂后上棘自动检测与定位方法，其特征在于，所述步骤S44的具体步骤为：分别在当前骨盆区域CT序列图像的左兴趣区域、右兴趣区域中检索前景值为1的点，找出y坐标值最大的点，记录此点坐标；若在下一张CT序列中检索到更大的y坐标值，则不断向下级CT序列检索，直至找到骨盆区域的CT序列中y坐标值最大的点。8.根据权利要求5所述的基于CT图像的髂后上棘自动检测与定位方法，其特征在于，所述PSIS_WL＝1300，PSIS_WW＝200，SACRUM_CLEARANCE＝25mm。
说明书desc
技术领域本发明涉及图像处理技术领域，特别是一种基于CT图像的髂后上棘自动检测与定位方法。背景技术在骨科、生物力学或形态计量学中，对骨性标志进行识别是必不可少的步骤。骨性标志的识别常应用于患者的术前计划和术中导航、肌肉骨骼模型缩放或骨形态的统计分析。髂后上棘是骨盆上的一个标志性结构，位于人体骨盆后面两侧，与人体腰椎周围软组织的交界处。触诊可以检测到髂后上棘，但这种手动的识别方法非常耗时，并且需要医生具有丰富的经验。近些年医学影像技术发展迅速，计算机断层扫描、磁共振成像等广泛地应用于临床诊断中。因为CT对骨性信息敏感，所以CT的扫描图像对于髂后上棘的检测与定位有着特殊意义。由于噪声等干扰使得CT图像成像不清晰，人体腹盆腔结构情况复杂，这些问题使得医生仅通过观察CT图像去检测定位髂后上棘的难度大大增加。发明内容本发明的目的是要提供一种基于CT图像的髂后上棘自动检测与定位方法。为达到上述目的，本发明是按照以下技术方案实施的：一种基于CT图像的髂后上棘自动检测与定位方法，包括以下步骤：S1、获取人体CT序列图像，进行去噪、增强处理，然后通过图形学操作去除人体CT序列图像中的CT检查床；S2、基于上述步骤S1的处理结果，根据医学数字成像和通信DICOM信息将搜索范围定位到人体躯干下半部分的CT序列数据，获得人体躯干下半部分CT序列图像；S3、在基于上述步骤S2获得的人体躯干下半部分CT序列图像中搜索并锁定骨盆区域，获得骨盆区域CT序列图像；S4、基于上述步骤S3的骨盆区域CT序列图像中搜索并定位左髂后上棘、右髂后上棘特征点。进一步地，所述步骤S1具体为：采取常规的高斯滤波器进行图像去噪，采取常规的频域增强算法对人体CT序列图像进行增强等预处理，在不损失图像信息的前提下提升影像质量，同时采用图形学膨胀、腐蚀去除CT检查床。进一步地，所述的步骤S2具体为：根据医学数字成像和通信DICOM信息中的病人位置信息判断人体CT检查时候的体位，同时结合医学数字成像和通信DICOM信息中的病人影像位置的Z轴坐标值判断骨盆的位置，定位人体躯干下半部分CT序列数据，从而排除人体躯干上半部分CT序列数据，获得人体躯干下半部分CT序列图像。进一步地，所述的步骤S3具体为：步骤S31、根据上述步骤S2获得的人体躯干下半部分CT序列图像，对这部分序列的每一张CT图像进行处理，检测左、右髋骨脊与脊椎之间的距离；步骤S32、当左、右髋骨脊与脊椎之间的距离小于左右髋骨脊之间的最小距离时即确定为骨盆区域，从而获得骨盆区域CT序列图像。进一步地，所述地步骤S4具体为：步骤S41、对骨盆区域CT序列图像进行二值化处理，利用阈值去除器官、皮肤，仅保留骨组织；步骤S42、基于上述步骤S41，将只有骨组织的骨盆区域CT序列图像垂直划分为左、右兴趣区域，以分别搜索左、右两侧髂后上棘；步骤S43、对步骤S42获得的左兴趣区域的右边缘和右兴趣区域的左边缘进行裁剪，以消除骶骨和尾骨的干扰；步骤S44、基于上述步骤S43，根据左兴趣区域、右兴趣区域的Y轴坐标值Y轴坐标值确定左髂后上棘、右髂后上棘。进一步地，所述步骤S41中的二值化处理具体过程为：给定下阈值LT和上阈值UT，LT＝PSIS_WL-PSIS_WW/2，UT＝PSIS_WL+PSIS_WW/2，将范围内的体积值设置为前景1或背景0，生成二进制图像。进一步地，所述步骤S44的具体步骤为：分别在当前骨盆区域CT序列图像的左兴趣区域、右兴趣区域中检索前景值为1的点，找出y坐标值最大的点，记录此点坐标；若在下一张CT序列中检索到更大的y坐标值，则不断向下级CT序列检索，直至找到骨盆区域的CT序列中y坐标值最大的点。优选地，所述PSIS_WL＝1300，PSIS_WW＝200，SACRUM_CLEARANCE＝25mm。与现有技术相比，本发明以人体CT图像为具体研究对象，提出一种髂后上棘自动检测与定位方法，可以自动、快速地检测髂后上棘的位置，并准确地标定其位置，有助于计算机辅助医学图像自动化分析以及医生为病人制定手术方案，能够大大提升自动化配准、定位等操作，有效减轻医生的工作量。附图说明图1为本发明的髂后上棘自动检测与定位方法的流程示意图。图2为本发明的CT坐标系统。图3为本发明的髂后上棘解剖学标志示意图。图4为本发明的髂后上棘自动检测与定位方法的检测结果。图5为本发明的CT序列的堆叠遍历方向。具体实施方式为使本发明的目的、技术方案及优点更加清楚明白，以下结合实施例，对本发明进行进一步的详细说明。此处所描述的具体实施例仅用于解释本发明，并不用于限定发明。如图1所示，本实施例具体提供了一种基于CT图像的髂后上棘自动检测与定位方法，包括以下步骤：S1、获取人体CT序列图像，采取常规的高斯滤波器进行图像去噪，采取常规的频域增强算法对人体CT序列图像进行增强等预处理，在不损失图像信息的前提下提升影像质量，同时采用图形学膨胀、腐蚀去除CT检查床；S2、基于上述步骤S1的处理结果，根据医学数字成像和通信DICOM信息中的病人位置信息判断人体CT检查时候的体位，同时结合医学数字成像和通信DICOM信息中的病人影像位置的Z轴坐标值判断骨盆的位置，定位人体躯干下半部分CT序列数据，从而排除人体躯干上半部分CT序列数据，获得人体躯干下半部分CT序列图像；S3、根据上述步骤S2获得的人体躯干下半部分CT序列图像，对这部分序列的每一张CT图像进行处理，利用骨头特征点、边缘信息，结合阈值判断，其中骨性的特征点提取可以直接采用现有技术中的Harris角点特征等，边缘信息可以直接采用现有技术中的经典Canny边缘提取等，阈值由经验数值进行设置，通过调整阈值优化特征点和边缘信息的准确度。在以上处理的基础上检测左、右髋骨脊与脊椎之间的距离；当左、右髋骨脊与脊椎之间的距离的距离小于左右髋骨脊之间的最小距离时即确定为骨盆区域，从而获得骨盆区域CT序列图像；S4、基于上述步骤S3的骨盆区域CT序列图像中搜索并定位左髂后上棘、右髂后上棘特征点；具体地，利用设置的统计学经验参数PSIS_WL和PSIS_WW，PSIS_WL和PSIS_WW可通过对大量CT序列的统计分析所得，本实施例中，PSIS_WL＝1300，PSIS_WW＝200，可以确保图像中只有骨头；通过开窗对骨盆区域CT序列图像进行二值化处理，利用阈值去除器官、皮肤，仅保留骨组织；给定下阈值LT和上阈值UT，LT＝PSIS_WL-PSIS_WW/2，UT＝PSIS_WL+PSIS_WW/2，将范围内的体积值设置为前景1或背景0，生成二进制图像。然后，利用正中矢状面将只有骨组织的骨盆区域CT序列图像垂直划分为左、右兴趣区域，以分别搜索左、右两侧髂后上棘；再利用设置的统计学经验参数SACRUM_CLEARANCE分别对获得的左兴趣区域的右边缘和右兴趣区域的左边缘进行裁剪，以消除骶骨和尾骨的干扰，SACRUM_CLEARANCE可通过对大量CT序列的统计分析所得，本实施例中，SACRUM_CLEARANCE＝25mm，可以确保图像中只有骨头；最后，分别在当前骨盆区域CT序列图像的左兴趣区域、右兴趣区域中检索前景值为1的点，找出y坐标值最大的点，记录此点坐标；若在下一张CT序列中检索到更大的y坐标值，则不断向下级CT序列检索，直至找到骨盆区域的CT序列中y坐标值最大的点即为左髂后上棘、右髂后上棘。CT序列的堆叠遍历方向如图5所示。通过上述方法，可以实现自动、快速地检测髂后上棘的位置，并准确地标定其位置，有助于计算机辅助医学图像自动化分析以及医生为病人制定手术方案，能够大大提升自动化配准、定位等操作，有效减轻医生的工作量。本发明的技术方案不限于上述具体实施例的限制，凡是根据本发明的技术方案做出的技术变形，均落入本发明的保护范围之内。
