标题title
信号特征筛选及降维方法及系统
摘要abst
本发明提供一种信号特征筛选及降维方法及系统，其中的方法包括：基于采集到的刀具切削的信号特征，确定与信号特征对应的特征矩阵和磨损量；基于特征矩阵和磨损量，获取训练集和测试集；搭建多层感知机模型，并基于训练集和测试集对多层感知机模型进行训练，直至多层感知机模型的训练完成；提取训练完成后的多层感知机模型的第一个线性回归层的节点权重，并基于节点权重确定信号特征对磨损量的贡献度；基于贡献度的大小排序，在信号特征中筛选目标特征；对目标特征进行主成分降维处理，获取降维特征。利用上述发明能够降低信号冗余、剔除误差值，获得优质的信号输入特征。
权利要求书clms
1.一种信号特征筛选及降维方法，其特征在于，包括：基于采集到的刀具切削的信号特征，确定与所述信号特征对应的特征矩阵和磨损量；基于所述特征矩阵和所述磨损量，获取训练集和测试集；搭建多层感知机模型，并基于所述训练集和所述测试集对所述多层感知机模型进行训练，直至所述多层感知机模型的训练完成；提取训练完成后的所述多层感知机模型的第一个线性回归层的节点权重，并基于所述节点权重确定所述信号特征对所述磨损量的贡献度；基于所述贡献度的大小排序，在所述信号特征中筛选目标特征；对所述目标特征进行主成分降维处理，获取降维特征。2.如权利要求1所述的信号特征筛选及降维方法，其特征在于，基于所述训练集和所述测试集对所述多层感知机模型进行训练的过程包括：基于所述训练集对所述多层感知机模型进行迭代，基于所述测试集对迭代后的多层感知机模型进行测试，直至所述多层感知机模型的损失符合预设阈值，完成所述多层感知机模型的训练。3.如权利要求2所述的信号特征筛选及降维方法，其特征在于，所述多层感知机模型包括依次设置的输入层、dropout层、线性回归层、sigmoid层和输出层；其中，所述输出层的表达公式为：其中，表示第n个信号特征，i表示第i次刀具切削，表示预测磨损量，wn和b表示所述多层感知机模型的参数。4.如权利要求2所述的信号特征筛选及降维方法，其特征在于，所述多层感知机模型的损失符合预设阈值的过程包括：获取所述多层感知机模型的平均绝对误差；判断所述平均绝对误差是否满足所述预设阈值；其中，所述损失函数的表达公式为：其中，l表示平均绝对误差，wn和b表示所述多层感知机模型的参数，n表示信号特征的个数，表示预测磨损量，y表示第i次刀具切削的实际磨损量。5.如权利要求2所述的信号特征筛选及降维方法，其特征在于，所述线性回归层的输出公式表示为：H＝XWh+bh其中，h表示所述线性回归层的当前层数，H表示第h层线性回归层的输出，X表示第h层线性回归层的输入，Wh和bh表示第h层线性回归层的优化参数向量。6.如权利要求2所述的信号特征筛选及降维方法，其特征在于，所述sigmoid层的输出公式表示为：其中，x表示所述sigmoid层的输入。7.如权利要求1所述的信号特征筛选及降维方法，其特征在于，基于所述节点权重确定所述信号特征对所述磨损量的贡献度的过程包括：确定所述信号特征对所述磨损量的贡献权重；所述贡献权重的公式表示为：其中，p表示第p组训练数据，P表示总的训练数据组数，q表示所述第一个线性回归层的当前节点数，Q表示所述第一个线性回归层的节点数，表示第p组训练数据的第i维信号特征对节点Q的节点权重。8.如权利要求7所述的信号特征筛选及降维方法，其特征在于，所述信号特征对所述磨损量的贡献度的公式表示为：其中，Ci表示所述信号特征对所述磨损量的贡献权重，N表示每组训练数据中的信号特征的维数，i表示所述训练数据的第i维信号特征。9.如权利要求1所述的信号特征筛选及降维方法，其特征在于，对所述目标特征进行主成分降维处理的过程包括：对所述目标特征进行归一化处理，获取归一化特征向量；获取所述归一化特征向量的协方差矩阵；基于所述协方差矩阵，确定与所述目标特征对应的特征值以及与所述特征值对应的特征向量v；基于预设压缩维数和贡献率对所述特征向量v进行标准化处理，获取与所述特征向量v对应的标准化向量；将所述归一化特征向量投影至所述标准化向量上，获取预设压缩维数的压缩特征向量。10.一种信号特征筛选及降维系统，其特征在于，包括：特征矩阵和磨损量确定单元，用于基于采集到的刀具切削的信号特征，确定与所述信号特征对应的特征矩阵和磨损量；训练集和测试集确定单元，用于基于所述特征矩阵和所述磨损量，获取训练集和测试集；模型训练单元，用于搭建多层感知机模型，并基于所述训练集和所述测试集对所述多层感知机模型进行训练，直至所述多层感知机模型的训练完成；贡献度确定单元，用于提取训练完成后的所述多层感知机模型的第一个线性回归层的节点权重，并基于所述节点权重确定所述信号特征对所述磨损量的贡献度；目标特征筛选单元，用于基于所述贡献度的大小排序，在所述信号特征中筛选目标特征；降维特征获取单元，用于对所述目标特征进行主成分降维处理，获取降维特征。
说明书desc
技术领域本发明涉及刀具磨损监测技术领域，更为具体地，涉及一种信号特征筛选及降维方法及系统。背景技术刀具磨损状态监测一般需要对所采集的信号进行时域和频域等特性分析及特征提取，由于所获得特征数往往较大，且不同特征参数之间及其与刀具磨损量的关联程度也不同，如果直接利用所有特征进行刀具磨损量分析，可能导致：预测精度低、泛化能力差、模型训练时间长等问题。所以需要进行特征选择，即根据某个标准，从众多特征中挑选出预测能力强的特征子集。目前，在刀具磨损监测的模型构建中，常用的特征选择方案包括：单变量选择、递归消除、基于决策树原理的特征重要性和主成分分析法。但是，单变量选择的特征与刀具磨损的关联关系并不一定是线性关系，与磨损量呈非线性关系的特征容易被漏选，影响对刀具磨损量的分析精度；而递归特征消除的主要思想是通过逐批剔除部分特征的反复迭代，排除使模型预测精度降低的特征以获得优质特征，但RFE的稳定性很大程度上取决于迭代时的底层模型和模型参数，选择合适的模型和参数尤其重要。此外，由于决策树在分裂的过程中重要的特征更可能出现在靠近根节点的位置，故利用通过以树模型为基础的集成学习算法量化输入特征的重要程度，提供特征筛选依据也是机器学习中常用的方案，但是树模型的分裂往往过分倚重少数特征，难以发掘变量之间的深度关系，也会影响对刀具磨损的分析效果。最后，PCA方法是一种把多个特征通过线性变换消除原始特征向量中各分量间相关性，去除带有较少信息的坐标轴来降低特征空间的维数，同时尽可能地反映原始特征信息的一种基于统计分析方法的降维技术。但是单纯采用PCA算法降维后的“新特征”是原始特征的线性组合，所以无关特征也参与了降维，降低了降维后的精度，且降维后特征的可解释性较差。发明内容鉴于上述问题，本发明的目的是提供一种信号特征筛选及降维方法及系统，以解决目前在刀具磨损监测的模型构建中，所获得的信号特征不能够全面、合理地反映特征与刀具磨损之间的关系，不能够有效消除特征所提供信息冗余等问题，导致输入模型的筛选或降维后特征可能降低模型对刀具磨损的预测效果的问题。本发明提供的信号特征筛选及降维方法，包括基于采集到的刀具切削的信号特征，确定与信号特征对应的特征矩阵和磨损量；基于特征矩阵和磨损量，获取训练集和测试集；搭建多层感知机模型，并基于训练集和测试集对多层感知机模型进行训练，直至多层感知机模型的训练完成；提取训练完成后的多层感知机模型的第一个线性回归层的节点权重，并基于节点权重确定信号特征对磨损量的贡献度；基于贡献度的大小排序，在信号特征中筛选目标特征；对目标特征进行主成分降维处理，获取降维特征。此外，优选的技术方案是，基于训练集和测试集对多层感知机模型进行训练的过程包括：基于训练集对多层感知机模型进行迭代，基于测试集对迭代后的多层感知机模型进行测试，直至多层感知机模型的损失符合预设阈值，完成多层感知机模型的训练。此外，优选的技术方案是，多层感知机模型包括依次设置的输入层、dropout层、线性回归层、sigmoid层和输出层；其中，输出层的表达公式为：其中，表示第n个信号特征，i表示第i次刀具切削，表示预测磨损量，wn和b表示多层感知机模型的参数。此外，优选的技术方案是，多层感知机模型的损失符合预设阈值的过程包括：获取多层感知机模型的平均绝对误差；判断平均绝对误差是否满足预设阈值；其中，损失函数的表达公式为：其中，l表示平均绝对误差，wn和b表示多层感知机模型的参数，n表示信号特征的个数，表示预测磨损量，y表示第i次刀具切削的实际磨损量。此外，优选的技术方案是，线性回归层的输出公式表示为：H＝XWh+bh其中，h表示线性回归层的当前层数，H表示第h层线性回归层的输出，X表示第h层线性回归层的输入，Wh和bh表示第h层线性回归层的优化参数向量。此外，优选的技术方案是，sigmoid层的输出公式表示为：其中，x表示sigmoid层的输入。此外，优选的技术方案是，基于节点权重确定信号特征对磨损量的贡献度的过程包括：确定信号特征对磨损量的贡献权重；贡献权重的公式表示为：其中，p表示第p组训练数据，P表示总的训练数据组数，q表示第一个线性回归层的当前节点数，Q表示第一个线性回归层的节点数，表示第p组训练数据的第i维信号特征对节点Q的节点权重；此外，优选的技术方案是，信号特征对磨损量的贡献度的公式表示为：其中，Ci表示信号特征对磨损量的贡献权重，N表示每组训练数据中的信号特征的维数，i表示训练数据的第i维信号特征。此外，优选的技术方案是，对目标特征进行主成分降维处理的过程包括：对目标特征进行归一化处理，获取归一化特征向量；获取归一化特征向量的协方差矩阵；基于协方差矩阵，确定与目标特征对应的特征值以及与特征值对应的特征向量v；基于预设压缩维数和贡献率对特征向量v进行标准化处理，获取与特征向量v对应的标准化向量；将归一化特征向量投影至标准化向量上，获取预设压缩维数的压缩特征向量。根据本发明的另一方面，提供一种信号特征筛选及降维系统，包括：特征矩阵和磨损量确定单元，用于基于采集到的刀具切削的信号特征，确定与信号特征对应的特征矩阵和磨损量；训练集和测试集确定单元，用于基于特征矩阵和磨损量，获取训练集和测试集；模型训练单元，用于搭建多层感知机模型，并基于训练集和测试集对多层感知机模型进行训练，直至多层感知机模型的训练完成；贡献度确定单元，用于提取训练完成后的多层感知机模型的第一个线性回归层的节点权重，并基于节点权重确定信号特征对磨损量的贡献度；目标特征筛选单元，用于基于贡献度的大小排序，在信号特征中筛选目标特征；降维特征获取单元，用于对目标特征进行主成分降维处理，获取降维特征。利用上述信号特征筛选及降维方法及系统，基于采集到的刀具切削的信号特征，确定与信号特征对应的特征矩阵和磨损量；基于特征矩阵和磨损量，获取训练集和测试集；搭建多层感知机模型，提取训练完成后的多层感知机模型的第一个线性回归层的节点权重，并基于节点权重确定信号特征对磨损量的贡献度；基于贡献度的大小排序，在信号特征中筛选目标特征；对目标特征进行主成分降维处理，获取降维特征，能够降低信号冗余、剔除误差值，获得优质的输入特征，以提高刀具磨损监测模型的监测效果。为了实现上述以及相关目的，本发明的一个或多个方面包括后面将详细说明的特征。下面的说明以及附图详细说明了本发明的某些示例性方面。然而，这些方面指示的仅仅是可使用本发明的原理的各种方式中的一些方式。此外，本发明旨在包括所有这些方面以及它们的等同物。附图说明通过参考以下结合附图的说明，并且随着对本发明的更全面理解，本发明的其它目的及结果将更加明白及易于理解。在附图中：图1为根据本发明实施例的信号特征筛选及降维方法的流程图；图2为根据本发明实施例的信号特征筛选及降维方法的简化流程图；图3为根据本发明实施例的信号特征筛选及降维系统的方框示意图。在所有附图中相同的标号指示相似或相应的特征或功能。具体实施方式在下面的描述中，出于说明的目的，为了提供对一个或多个实施例的全面理解，阐述了许多具体细节。然而，很明显，也可以在没有这些具体细节的情况下实现这些实施例。在其它例子中，为了便于描述一个或多个实施例，公知的结构和设备以方框图的形式示出。在本发明的描述中，需要理解的是，术语“中心”、“纵向”、“横向”、“长度”、“宽度”、“厚度”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”“内”、“外”、“顺时针”、“逆时针”、“轴向”、“径向”、“周向”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。为详细描述本发明实施例的信号特征筛选及降维方法及系统，以下将结合附图对本发明的具体实施例进行详细描述。图1和图2分别从不同角度示出了根据本发明实施例的信号特征筛选及降维方法的流程。如图1和图2共同所示，本发明实施例的信号特征筛选及降维方法包括：S110：基于采集到的刀具切削的信号特征，确定与信号特征对应的特征矩阵和磨损量；S120：基于特征矩阵和磨损量，获取训练集和测试集；S130：搭建多层感知机模型，并基于训练集和测试集对多层感知机模型进行训练，直至多层感知机模型的训练完成；S140：提取训练完成后的多层感知机模型的第一个线性回归层的节点权重，并基于节点权重确定信号特征对磨损量的贡献度；S150：基于贡献度的大小排序，在信号特征中筛选目标特征；S160：对目标特征进行主成分降维处理，获取降维特征。具体地，在步骤S110中，利用需要进行刀具磨损监测的机床，同步采集该机床在加工过程中的信号特征，对其进行时域、频域、时频域特征计算，获取特征矩阵X以及对应的刀具的磨损量Y。然后，基于特征矩阵X和磨损量Y，按照一定的比例划分训练集和测试集，例如，将特征矩阵X和磨损量Y中的70％划分为训练集，剩余30％为测试集。在步骤S130中，搭建多层感知机模型，并基于训练集和测试集对多层感知机模型进行训练的过程包括：基于训练集对多层感知机模型进行迭代，基于测试集对迭代后的多层感知机模型进行测试，直至多层感知机模型的损失符合预设阈值，完成多层感知机模型的训练。具体地，搭建的多层感知机模型包括：第一层为输出层、第二层为dropout层、后续依次为若干个线性回归层和sigmoid层，最后一层为输出层。该模型在训练过程中，输入层的输入数据为Xtrain，对应的输出层的输出数据为Ytrain，在迭代训练过程中，第二层的dropout层启用。但是，在测试过程中，输入层的输入数据为Xtest，输出层即对应的Ytest，在此过程中，第二层dropout层不启用。作为具体示例，在模型搭建过程中，以单层为例，将底i次刀具世燕计算出的n个信号特征作为特征向量对应的刀具的磨损量为y，将特征向量输入以下公式中，得到的预测磨损量为其中，输出层的表达公式为：其中，表示第n个信号特征，i表示第i次刀具切削，表示预测磨损量，wn和b表示多层感知机模型的需要输入的参数。进一步地，上述dropout层的原理是在对信号特征进行训练时，按照预设比例随机屏蔽输入的信号特征单元，使得模型每次训练的输入特征都不相同，能够削弱神经元之间的固定联合性，使得模型不至于过度依赖特定几个特征。同时由于神经网络具有非线性，通过统计输入层的每个特征在第一个隐藏层各单元中的激活程度，可以较好反映每个地综合反映每个输入特征对刀具磨损量的重要程度。在本发明的一个具体实施方式中，每次迭代的优化器可选用随机梯度下降SGD，学习率可设置为0.001，损失函数为MAELoss；其中，多层感知机模型的损失符合预设阈值的过程包括：获取多层感知机模型的平均绝对误差；判断平均绝对误差是否满足预设阈值；其中，损失函数的表达公式为：其中，l表示平均绝对误差，wn和b表示多层感知机模型的参数，n表示信号特征的个数，表示第i次刀具切削的预测磨损量，y表示第i次刀具切削的实际磨损量。其中，下表1示出了根据本发明一个实施例中的多层感知机模型的架构及参数设计表。表1在表1中，参数中的单元数为计算信号特征的数量。此外，线性回归层是原理为感知机的隐藏层，第h层的线性回归层的计算公式如下：H＝XWh+bh其中，h表示线性回归层的当前层数，H表示第h层线性回归层的输出，X表示第h层线性回归层的输入，Wh和bh表示第h层线性回归层的优化参数向量。而sigmoid层为激活函数，其作用是通过引入该非线性变换，增加模型的非线性，从而获得信号特征和刀具的磨损量之间的非线性关系。其中，sigmoid层的输出公式表示为：其中，x表示sigmoid层的输入。在本发明的信号特征筛选及降维方法的一个实施例中，基于节点权重确定信号特征对磨损量的贡献度的过程包括：确定信号特征对磨损量的贡献权重，设模型工训练P组数据，每组数据含N维特征，模型训练完毕后，第p组输入的样本的第i维特征对第一线性回归层的Q各节点的权重分别表示为则该特征的贡献权重的公式表示为：其中，p表示第p组训练数据，P表示总的训练数据组数，q表示第一个线性回归层的当前节点数，Q表示第一个线性回归层的节点数，表示第p组训练数据的第i维信号特征对节点Q的节点权重；将上述贡献权重换算成百分比贡献度，或信号特征对磨损量的贡献度的公式表示为：其中，Ci表示信号特征对磨损量的贡献权重，N表示每组训练数据中的信号特征的维数，i表示训练数据的第i维信号特征。在上述步骤S160中，对目标特征进行主成分降维处理的过程包括：对目标特征进行归一化处理，获取归一化特征向量；获取归一化特征向量的协方差矩阵；基于协方差矩阵，确定与目标特征对应的特征值以及与特征值对应的特征向量v；基于预设压缩维数和贡献率对特征向量v进行标准化处理，获取与特征向量v对应的标准化向量；将归一化特征向量投影至标准化向量上，获取预设压缩维数的压缩特征向量。具体地，设基于多层感知机模型筛选出的目标特征的矩阵为该目标特征的特征矩阵包含M组样本，每组样本包含N维特征向量，对所述目标特征按列进行归一化处理，获取归一化特征向量如下所示：其中，xn为X中第n列向量，为xn的均值，M表示样本的组数，N表示目标特征的特征向量的维数。进而得到归一化后的目标特征的矩阵如下所示：然后，将按列向量改写成并计算归一化特征向量的协方差矩阵Cov。进一步是，在确定与目标特征对应的特征值以及与特征值对应的特征向量v的过程中，对Cov进行特征值分解可得到特征向量v和特征值，将得到的特征值由大到小排列，即得到特征值λ1≥λ2≥...≥λt≥λt+1≥...。计算第t个主成分的贡献率为：则前t个主成分的累计贡献率为：给定一个累计贡献率阀值，计算使前t个主成分的累积贡献率达到阀值的最小t值所对应的λ1,λ2,...,λt，其对应的特征向量V＝是特征数据的PCA分析结果。累计贡献率为人为设定值，可根据具体的应用场景进行设定。在本发明的另一具体实施方式中，为了量化观察多层感知机模型的优化效果，本发明以支持向量回归为模型，以MAE为模型评价指标进行实验验证。具体地，MAE的表达公式如下：其中，yi为样本i的磨损量实际值，即实际磨损量，为对应的模型的预测磨损值。依据实验所提取的272维特征，通过基于dropout的多层感知机筛选出贡献度排名前49的特征，进行主成分分析后提取前9维主成分，计算出的误差指标MAE＝25.80，而采用随机森林和RFE-SVR所优化的特征的误差指标分别MAE＝26.64和MAE＝26.20。可知，利用本发明的信号特征筛选及降维方法能够充分发掘特征与磨损量之间线性和非线性关系，同时采用主成分分析降维消除了特征的信息冗余，优化后的特征更能够良好反应刀具磨损信息，提高刀具磨损监测模型的预测效果。与上述信号特征筛选及降维方法相对应的，本发明还提供一种信号特征筛选及降维系统。具体地，图3示出了根据本发明实施例的信号特征筛选及降维系统的示意逻辑框图。如图3所示，本发明实施例的信号特征筛选及降维系统200，包括：特征矩阵和磨损量确定单元210，用于基于采集到的刀具切削的信号特征，确定与信号特征对应的特征矩阵和磨损量；训练集和测试集确定单元220，用于基于特征矩阵和磨损量，获取训练集和测试集；模型训练单元230，用于搭建多层感知机模型，并基于训练集和测试集对多层感知机模型进行训练，直至多层感知机模型的训练完成；贡献度确定单元240，用于提取训练完成后的多层感知机模型的第一个线性回归层的节点权重，并基于节点权重确定信号特征对磨损量的贡献度；目标特征筛选单元250，用于基于贡献度的大小排序，在信号特征中筛选目标特征；降维特征获取单元260，用于对目标特征进行主成分降维处理，获取降维特征。需要说明的是，上述信号特征筛选及降维系统实施例可参考信号特征筛选及降维方法实施例中的描述，此处不再一一赘述。利用上述根据本发明的信号特征筛选及降维方法及系统，基于采集到的刀具切削的信号特征，确定与信号特征对应的特征矩阵和磨损量；基于特征矩阵和磨损量，获取训练集和测试集；搭建多层感知机模型，提取训练完成后的多层感知机模型的第一个线性回归层的节点权重，并基于节点权重确定信号特征对磨损量的贡献度；基于贡献度的大小排序，在信号特征中筛选目标特征；对目标特征进行主成分降维处理，获取降维特征即为目标特征，能够降低信号冗余、剔除误差值，获得优质的输入特征，以提高刀具磨损监测模型的监测效果。如上参照图附图以示例的方式描述根据本发明的信号特征筛选及降维方法及系统。但是，本领域技术人员应当理解，对于上述本发明所提出的信号特征筛选及降维方法及系统，还可以在不脱离本发明内容的基础上做出各种改进。因此，本发明的保护范围应当由所附的权利要求书的内容确定。
