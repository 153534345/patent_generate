标题title
一种基于阶段测试反馈的语音训练数据迭代更新方法
摘要abst
本发明公开了一种基于阶段测试反馈的语音训练数据迭代更新方法，该方法通过不断添加阶段测试语音中的误识别语音进行训练建立参考模型，然后计算原始训练语音在参考模型上的似然得分，再依据似然得分对各类语音进行排序，按照一定的比例对排序后的各类语音进行选择得到阶段核心训练语音。通过本发明提供的语音训练数据迭代更新方法，可以持续地根据测试数据的反馈来不断地筛选高质量的训练语音，所得的阶段核心训练语音及时利用了阶段应用反馈，因而其未来的识别性能表现会越来越好；该方法适用于语音识别、说话人识别、伪造语音识别等语音分类场景。
权利要求书clms
1.一种基于阶段测试反馈的语音训练数据迭代更新方法，包括如下步骤：S1.对原始训练语音提取特征后进行训练得到原始模型；S2.进行一轮阶段测试，根据测试语音在原始模型上的得分选出其中的误识别语音加入参考语音集合；S3.使用参考语音集合中的语音进行训练得到参考模型；S4.计算原始训练语音在参考模型上的匹配得分；S5.对每类训练语音集合中的每条训练语音按照其模型得分依次进行排序；S6.根据一定比例逐类选取排名靠前的训练语音作为本轮阶段测试的核心训练语音；S7.对核心训练语音提取特征后进行训练得到本轮阶段测试的核心模型；S8.进行新一轮阶段测试，根据测试语音在上一轮阶段测试所得核心模型上的得分选出其中的误识别语音加入参考语音集合，返回执行步骤S3。2.根据权利要求1所述的语音训练数据迭代更新方法，其特征在于：所述步骤S2的具体实现方式为：将测试语音按类别输入至原始模型中得到对应的得分，将得分较低且为本人真实语音以及得分较高且非本人真实语音的测试语音作为本阶段测试的误识别语音，并将其纳入参考语音集合中，初始参考语音集合包含已知的部分测试语音。3.根据权利要求1所述的语音训练数据迭代更新方法，其特征在于：所述步骤S3的具体实现方式为：对于N类语音分类任务，将参考语音集合中的语音按照所属类别划分为N个子集合，依次对各子集合中的语音提取特征后分别进行训练以获得各类语音的参考模型，即N个参考模型，N为大于1的自然数即设定的语音类别数。4.根据权利要求1所述的语音训练数据迭代更新方法，其特征在于：所述步骤S4的具体实现方式为：首先对原始训练语音按照语音类别进行分类后得到N个类训练语音集合，然后依次对各类训练语音集合中的原始训练语音提取特征后输入其对应类别的参考模型中，以计算输出得到各条训练语音的匹配得分即模型得分。5.根据权利要求1所述的语音训练数据迭代更新方法，其特征在于：所述步骤S5的具体实现方式为：根据步骤S4所获得的所有训练语音的匹配得分，按照语音类别对每一类训练语音集合中的训练语音以其模型得分从高到低进行排序。6.根据权利要求1所述的语音训练数据迭代更新方法，其特征在于：所述步骤S6的具体实现方式为：根据步骤S5得到的各类训练语音集合中的语音排列顺序，按照一定的比例选择排名靠前的训练语音作为各类别在本轮阶段测试的核心训练语音。7.根据权利要求1所述的语音训练数据迭代更新方法，其特征在于：所述步骤S7的具体实现方式为：对于N类语音分类任务，将本轮阶段测试的核心训练语音按照所属类别划分为N个集合，依次对各集合中的核心训练语音提取特征后分别进行训练以获得各类语音在本轮阶段测试的核心模型，即N个核心模型。8.根据权利要求1所述的语音训练数据迭代更新方法，其特征在于：所述步骤S8的具体实现方式为：将测试语音按类别输入至上一轮阶段测试的核心模型中得到对应的得分，将得分较低且为本人真实语音以及得分较高且非本人真实语音的测试语音作为本阶段测试的误识别语音，并将其纳入到本阶段的参考语音集合中。
说明书desc
技术领域本发明属于语音识别技术领域，具体涉及一种基于阶段测试反馈的语音训练数据迭代更新方法。背景技术声纹认证系统作为一种生物认证的方式，具有采集成本低、易于获取、方便远程认证等等优势，已经广泛应用于门禁系统、金融交易和司法鉴定等等领域。随着语音合成技术飞速发展，一方面给人们带来了更方便的服务和更良好的用户体验，如真声智能客服、真声智能导航、有声读物、智能语音呼叫等等；另一方面也给声纹认证系统的安全性带来了巨大的挑战，如利用合成语音攻击声纹认证系统使其性能显著下降，因此关于合成语音检测的研究具有重要的意义。合成语音检测的目的就是从真实语音中将合成语音检测出来。现有的关于合成语音检测的实验研究都是按照比赛设定的训练集进行训练的，通常会使用大量的训练数据；然而在实际情况中，当使用更多的训练数据时，性能反而有所下降，因为训练数据中是存在冗余的，进行数据选择是有必要的。在实际工程问题中，会遇到这样的场景：测试是分阶段进行的，当测试持续进行会得到许多测试阶段性结果，如何根据这些阶段结果反馈去选择我们的训练数据，得到更优的模型，以便在后续的测试阶段取得更好的性能，是一个值得探讨的实际问题。发明内容当语音分类系统在实际运行中获取阶段的测试数据后，如何利用其来迭代更新语音训练数据从而更新分类模型，使得未来的识别性能更佳；针对这个问题，本发明提供了一种基于阶段测试反馈的语音训练数据迭代更新方法，使用该方法可以在阶段测试场景利用阶段结果反馈选取高质量的核心训练语音集，使得模型在使用更少训练语音的情况下取得更好的性能，不仅节约了训练时间和能耗，而且提升了检测性能。一种基于阶段测试反馈的语音训练数据迭代更新方法，包括如下步骤：S1.对原始训练语音提取特征后进行训练得到原始模型；S2.进行一轮阶段测试，根据测试语音在原始模型上的得分选出其中的误识别语音加入参考语音集合；S3.使用参考语音集合中的语音进行训练得到参考模型；S4.计算原始训练语音在参考模型上的匹配得分；S5.对每类训练语音集合中的每条训练语音按照其模型得分依次进行排序；S6.根据一定比例逐类选取排名靠前的训练语音作为本轮阶段测试的核心训练语音；S7.对核心训练语音提取特征后进行训练得到本轮阶段测试的核心模型；S8.进行新一轮阶段测试，根据测试语音在上一轮阶段测试所得核心模型上的得分选出其中的误识别语音加入参考语音集合，返回执行步骤S3。进一步地，所述步骤S2的具体实现方式为：将测试语音按类别输入至原始模型中得到对应的得分，将得分较低且为本人真实语音以及得分较高且非本人真实语音的测试语音作为本阶段测试的误识别语音，并将其纳入参考语音集合中，初始参考语音集合包含已知的部分测试语音。进一步地，所述步骤S3的具体实现方式为：对于N类语音分类任务，将参考语音集合中的语音按照所属类别划分为N个子集合，依次对各子集合中的语音提取特征后分别进行训练以获得各类语音的参考模型，即N个参考模型，N为大于1的自然数即设定的语音类别数。进一步地，所述步骤S4的具体实现方式为：首先对原始训练语音按照语音类别进行分类后得到N个类训练语音集合，然后依次对各类训练语音集合中的原始训练语音提取特征后输入其对应类别的参考模型中，以计算输出得到各条训练语音的匹配得分即模型得分。本步骤中语音特征的提取方式与步骤S3训练参考模型时的语音特征提取方式保持一致。进一步地，所述步骤S5的具体实现方式为：根据步骤S4所获得的所有训练语音的匹配得分，按照语音类别对每一类训练语音集合中的训练语音以其模型得分从高到低进行排序。进一步地，所述步骤S6的具体实现方式为：根据步骤S5得到的各类训练语音集合中的语音排列顺序，按照一定的比例选择排名靠前的训练语音作为各类别在本轮阶段测试的核心训练语音。进一步地，所述步骤S7的具体实现方式为：对于N类语音分类任务，将本轮阶段测试的核心训练语音按照所属类别划分为N个集合，依次对各集合中的核心训练语音提取特征后分别进行训练以获得各类语音在本轮阶段测试的核心模型，即N个核心模型。进一步地，所述步骤S8的具体实现方式为：将测试语音按类别输入至上一轮阶段测试的核心模型中得到对应的得分，将得分较低且为本人真实语音以及得分较高且非本人真实语音的测试语音作为本阶段测试的误识别语音，并将其纳入到本阶段的参考语音集合中。通过本发明语音训练数据迭代更新方法，可以持续地根据测试数据的反馈来不断地筛选高质量的训练语音，所得的阶段核心训练语音及时利用了阶段应用反馈，因而其未来的识别性能表现会越来越好。因此，该方法适用于语音识别、说话人识别、伪造语音识别等语音分类场景。附图说明图1为本发明语音训练数据迭代更新方法的流程示意图。具体实施方式本发明适用于语音识别、说话人识别、伪造语音识别等语音分类场景。为了进一步理解本发明，下面仅就合成语音检测中选择核心训练语音的应用具体实施例来对本发明的技术方案进行详细描述，但是应当理解，这些描述只是为进一步说明本发明的特征和优点，而不是对本发明权利要求的限制。本实施方式中的实验数据采用的是2019年自动说话人识别欺骗攻击与防御对策挑战赛逻辑访问数据库、2015年自动说话人识别欺骗攻击与防御对策挑战赛和真实场景合成语音检测数据集。ASVspoof挑战赛由英国爱丁堡大学、法国EURECOM、日本NEC、东芬兰大学等多个世界领先的研究机构共同组织发起。ASVspoof 2019的真实语音来自107个说话人，其中61人为女性、46人为男性，数据集被划分为三部分：训练集、开发集、评估集，录音环境较安静，没有明显的信道或环境噪声。训练集和开发集的虚假语音是用各种算法从真实语音中生成的，其中训练集包含20个说话人，12人为女性、8人为男性，包含真实语音2580句、虚假语音22800句；开发集包含20个说话人，12人为女性、8人为男性，包含真实语音2548句、虚假语音22296句；评估集包含67个说话人，37人为女性、30人为男性，包含真是语音7355句、虚假语音63882句，评估集大小约为4GB。ASVspoof 2015的真实语音来自106个说话人，其中61人为女性、45人为男性，数据集被划分为三部分：训练集、开发集、评估集，录音环境较安静，没有明显的信道或环境噪声。训练集和开发集的虚假语音是用各种算法从真实语音中生成的，其中训练集包含25个说话人，15人为女性、10人为男性，包含真实语音3750句、虚假语音12625句；开发集包含35个说话人，20人为女性、15人为男性，包含真实语音2497句、虚假语音49875句；评估集包含46个说话人，26人为女性、20人为男性，约20万条测试语音，评估集大小约为20GB。真实场景合成语音检测数据集，简称为RS-SSD数据集，其中合成语音包括来自谷歌、腾讯、百度的合成语音和新华社人工智能主播的合成语音，时长共计4.12小时，以及同等时长的真实语音，包括来自网络媒体视频的真实语音、新华社新闻视频的真实语音以及部分来自浙江大学CCNT实验室发布的中文情感语料库、希尔贝壳提供的中文普通话开源语音数据库AISHELL1两个数据库的真实语音；其中各个类别的语音内容多样，包含了如新闻播报、智能家居、无人驾驶、工业生产等各种场景的语音内容。如图1所示，本发明基于阶段测试反馈的语音训练数据迭代更新方法包括如下步骤：S1.用现有的模型进行阶段测试，得到阶段测试误识别语句；S2.将阶段测试误识别语句加入到初始用于选择训练语句的集合；S3.提取新的集合的声学特征，进行训练获取参考模型参数；S4.计算所有训练语句在参考模型上的似然得分；S5.对所有真实语句和合成语句的似然得分分别进行降序和升序排序；S6.分别选取排名靠前的真实语句和合成语句组成训练集。前述步骤S1的具体实施方法是：首先定义合成语音检测真实语音训练语料为X_genuine，虚假语音训练语料为X_spoof，目标挑选语音个数为Mgenuine和Mspoof，已知的新测试误识别的测试语音为Q，初始用于挑选的测试语音集合Q0，Cgenuine,Cspoof为挑选后的语音集合。在阶段测试场景的当前测试阶段中，用现有的模型进行测试，得到阶段测试误识别语音集合Q，包含了真实语音被误识别为合成语音和合成语音被误识别为真实语音两种情况。前述步骤S2的具体实施方法是：把阶段测试误识别语音集合Q加入到最初用于选择训练的测试数据集Q0组成新的用于挑选训练数据的集合Qnew。前述步骤S3的具体实施方法是：对于新的用于挑选训练数据的语音集合Qnew，获取其特征数据，可以使用语音的32阶LFCC，并加上一阶Δ特征和二阶Δ特征。使用这些特征数据，训练得到拥有K阶高斯分量的GMM，将这个GMM作为之后用于选择训练语音的参考模型和GMM的训练是一个有监督的优化过程，一般采用最大似然准则。整个过程分为参数初始化和参数优化两部分，前者通常使用LBG算法，后者使用EM算法；由于GMM的训练以及语音特征的获取方法在现有的合成语音检测系统中已得到普遍的应用，在此不多作说明。对于GMM模型阶数K的选择，一般是2的幂次方如64、128、512、1024等等，在实验中发现对于使用的96维LFCC特征，512阶的GMM合成语音检测系统性能更优。前述步骤S4的具体实施方法是：获取所有训练语音的特征数据，语音特征的获取方式应该与步骤S3中训练GMM参考模型的数据的获取方式保持一致。然后针对各个训练语音，在真实语音参考模型和合成语音的参考模型上分别计算对数似然得分做差得到对数似然得分比前述步骤S5的具体实施方法是：对于步骤S4所获得的所有真实语音和合成语音的似然得分，分别进行降序和升序排序得到Υ＝{y1,y2,…,yn}和Υ’＝{y’1,y’2,…,y’n}。前述步骤S6的具体实施方法是：对于步骤S5得到的排序好的训练语音Υ和Υ’，选择排名靠前的Mgenuine句真实语音和Mspoof句合成语音分别加入选择的语音集合Cgenuine和Cspoof，即Mgenuine和Mspoof的取值根据数据选择比例来确定。以下我们对评估集的所有语音进行测试，实验均基于GMM系统，除了本发明提出的选择算法以外，对比了使用全部数据和随机选择的方法，实验等错误率EER结果比较如表1所示：表1从表1中可以看出，本发明能够在一定程度上提高系统识别性能且性能优于随机选择方法，对比原始使用全部数据训练的方法，仅选择1/3的数据进行训练时EER在三个数据集分别提升了0.77、1.31和5.26个百分点，仅选择1/2数据时EER在三个数据集分别提升了0.88、1.70和5.95个百分点。上述对实施例的描述是为便于本技术领域的普通技术人员能理解和应用本发明，熟悉本领域技术的人员显然可以容易地对上述实施例做出各种修改，并把在此说明的一般原理应用到其他实施例中而不必经过创造性的劳动。因此，本发明不限于上述实施例，本领域技术人员根据本发明的揭示，对于本发明做出的改进和修改都应该在本发明的保护范围之内。
