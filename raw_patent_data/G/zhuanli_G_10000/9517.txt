标题title
基于双层字典学习的CSI指纹定位方法、装置及设备
摘要abst
本发明实施例提供了一种基于双层字典学习的CSI指纹定位方法、装置及设备，在获取到对目标进行定位的指令时，采集所述目标的信道状态信息，作为目标信道状态信息CSI数据；基于预先训练得到的第一字典学习模型，获取所述目标CSI数据的第一稀疏编码以及区域标签；基于预先训练得到的第二字典学习模型和所述区域标签，获取所述第一稀疏编码的第二稀疏编码，并利用所述第二字典学习模型中的分类器，获取所述第二稀疏编码的位置标签，作为所述目标的位置标签；所述分类器用于按照稀疏编码的位置标签的不同进行分类。本方案可以兼顾提高定位准确度，以及降低存储压力和数据处理复杂度。
权利要求书clms
1.一种基于双层字典学习的CSI指纹定位方法，其特征在于，所述方法包括：在获取到对目标进行定位的指令时，采集所述目标的信道状态信息，作为目标信道状态信息CSI数据；基于预先训练得到的第一字典学习模型，获取所述目标CSI数据的第一稀疏编码以及区域标签；其中，所述第一字典学习模型用于基于最小化重构误差原则进行CSI数据所属区域的判别，且为利用多个样本CSI数据和每个样本CSI数据的位置标签训练得到的稀疏编码模型；基于预先训练得到的第二字典学习模型和所述区域标签，获取所述第一稀疏编码的第二稀疏编码，并利用所述第二字典学习模型中的分类器，获取所述第二稀疏编码的位置标签，作为所述目标的位置标签；其中，所述第二字典学习模型用于基于字典原子局部约束项增强所述第二稀疏编码的区分度，且为利用多个样本CSI数据的第一稀疏编码和每个样本CSI数据的位置标签训练得到的稀疏编码模型；所述分类器用于按照稀疏编码的位置标签的不同进行分类。2.根据权利要求1所述的方法，其特征在于，所述第一字典学习模型，采用如下步骤训练得到：基于所述多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据；将所述样本数据，字典学习模型的规格，以及字典学习模型的初始参数，输入第一字典学习模型的目标函数，对所述第一字典学习模型的目标函数进行迭代训练：当所述第一字典学习模型的目标函数收敛时，将所训练的第一字典学习模型的目标函数，作为所述第一字典学习模型；所述收敛包括：迭代次数达到第一迭代阈值，或当前迭代的目标函数与上一次迭代的目标函数之间，输出结果的差异小于第一差异阈值；当所述第一字典学习模型的目标函数不收敛时，利用所述样本数据，获取更新的第一稀疏编码，并利用所述更新的第一稀疏编码对所训练的第一字典学习模型的目标函数进行更新。3.根据权利要求1所述的方法，其特征在于，所述第二字典学习模型，采用如下步骤训练得到：基于所述多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据；将所述样本数据的第一稀疏编码，字典学习模型的规格，以及字典学习模型的初始参数，输入第一字典学习模型的目标函数，对所述第一字典学习模型的目标函数进行迭代训练：当所述第二字典学习模型的目标函数收敛时，将所训练的第二字典学习模型的目标函数，作为所述第二字典学习模型；所述收敛包括：迭代次数达到第二迭代阈值，或当前迭代的目标函数与上一次迭代的目标函数之间，输出结果的差异小于第二差异阈值；当所述第二字典学习模型的目标函数不收敛时，利用所述多个样本CSI数据，以及每个样本CSI数据的位置标签的图拉普拉斯矩阵，获取更新的第二稀疏编码，并利用所述更新的第二稀疏编码对所训练的第二字典学习模型的目标函数进行更新。4.根据权利要求2至3任一项所述的方法，其特征在于，所述基于所述多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据，包括：分别将每个样本CSI数据图像化，得到多个CSI图像；针对每个CSI图像，获取该CSI图像各像素点的原始平均振幅，并对各像素点的原始平均振幅进行离差标准化，得到第一标准化后的CSI图像；基于所述第一标准化后的CSI图像，获得所述样本数据。5.根据权利要求4所述的方法，其特征在于，所述基于所述第一标准化后的CSI图像，获得所述样本数据，包括：针对每个第一标准化后的CSI图像，利用所述原始平均振幅，对该第一标准化后的CSI图像中相应的像素点进行离差标准化，得到所述样本数据。6.根据权利要求1所述的方法，其特征在于，所述第一字典学习模型，为：其中，D为聚合了子字典的第一字典，Z为所述目标CSI数据的第一稀疏编码，n为所述第一字典对应的各区域的个数，Dl为第一字典中属于区域l的子字典，Xl为在区域l中采集的CSI数据Yl在对应子字典Dl上的稀疏编码，α,τ为常量参数，为字典原子约束项，f为非相干促进项，用于增强属于不同区域的CSI数据之间的区分度。7.根据权利要求1所述的方法，其特征在于，所述第二字典学习模型，为：其中，Z为CSI数据的第二稀疏编码，U,b均为分类器参数，λ1和λ2是两个常量参数，为字典原子局部约束项，D为第二字典，为支持向量判别项，用于区分属于不同位置标签的稀疏编码，uc是与所述支持向量判别项所代表的支持向量的第c类超平面相关联的法向量，bc是与所述支持向量对应的偏差。8.一种基于双层字典学习的CSI指纹定位装置，其特征在于，所述装置包括：信息采集模块，用于在获取到对目标进行定位的指令时，采集所述目标的信道状态信息，作为目标信道状态信息CSI数据；第一编码模块，用于基于预先训练得到的第一字典学习模型，获取所述目标CSI数据的第一稀疏编码以及区域标签；其中，所述第一字典学习模型用于基于最小化重构误差原则进行CSI数据所属区域的判别，且为利用多个样本CSI数据和每个样本CSI数据的位置标签训练得到的稀疏编码模型；第二编码模块，用于基于预先训练得到的第二字典学习模型和所述区域标签，获取所述第一稀疏编码的第二稀疏编码，并利用所述第二字典学习模型中的分类器，获取所述第二稀疏编码的位置标签，作为所述目标的位置标签；其中，所述第二字典学习模型用于基于字典原子局部约束项增强所述第二稀疏编码的区分度，且为利用多个样本CSI数据的第一稀疏编码和每个样本CSI数据的位置标签训练得到的稀疏编码模型；所述分类器用于按照稀疏编码的位置标签的不同进行分类。9.根据权利要求8所述的装置，其特征在于，所述第一字典学习模型，采用如下步骤训练得到：基于所述多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据；将所述样本数据，字典学习模型的规格，以及字典学习模型的初始参数，输入第一字典学习模型的目标函数，对所述第一字典学习模型的目标函数进行迭代训练：当所述第一字典学习模型的目标函数收敛时，将所训练的第一字典学习模型的目标函数，作为所述第一字典学习模型；所述收敛包括：迭代次数达到第一迭代阈值，或当前迭代的目标函数与上一次迭代的目标函数之间，输出结果的差异小于第一差异阈值；当所述第一字典学习模型的目标函数不收敛时，利用所述样本数据，获取更新的第一稀疏编码，并利用所述更新的第一稀疏编码对所训练的第一字典学习模型的目标函数进行更新。10.一种电子设备，其特征在于，包括处理器、通信接口、存储器和通信总线，其中，处理器，通信接口，存储器通过通信总线完成相互间的通信；存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现权利要求1-7任一所述的方法步骤。
说明书desc
技术领域本发明涉及指纹定位技术领域，特别是涉及一种基于双层字典学习的CSI指纹定位方法、装置及设备。背景技术在无线通信中，指纹定位方法具有不需要改变设备硬件即可定位的特点，因而被广泛应用。在具体应用中，信道状态信息指纹定位方法，依据室内环境复杂，信号反射和折射在不同位置形成不同的信号强度信息的原理，建立某区域内各参考节点的位置标签，与该参考节点的信道状态信息所表明的信号特征之间的映射关系，从而将该区域内的位置标签和信号特征一一对应存储，得到位置指纹数据库。这样，在对目标如某一终端进行定位时，可以获取目标的信道状态信息，从位置指纹数据库中确定与目标的信道状态信息匹配的位置标签，作为目标在该区域的位置标签，实现对目标的定位。但是，为了映射更丰富的场景信息，信道状态信息往往包含相对多的信道特征。因此，信道状态信息容易受噪声、多径以及人员移动等影响，产生较大波动，导致位置指纹数据库中的信道状态信息和定位时获取的信道状态信息之间存在明显差异，影响匹配效果，造成定位准确度降低的问题。并且，信道状态信息维度较高，因此，用传统方法构建的位置指纹数据库规模庞大，导致存储压力和数据处理复杂度较大的问题。发明内容本发明实施例的目的在于提供一种基于双层字典学习的CSI指纹定位方法、装置及设备，以实现兼顾提高定位准确度，以及降低存储压力和数据处理复杂度的效果。具体技术方案如下：第一方面，本发明实施例提供一种基于双层字典学习的CSI指纹定位方法，所述方法包括：在获取到对目标进行定位的指令时，采集所述目标的信道状态信息，作为目标信道状态信息CSI数据；基于预先训练得到的第一字典学习模型，获取所述目标CSI数据的第一稀疏编码以及区域标签；其中，所述第一字典学习模型用于基于最小化重构误差原则进行CSI数据所属区域的判别，且为利用多个样本CSI数据和每个样本CSI数据的位置标签训练得到的稀疏编码模型；基于预先训练得到的第二字典学习模型和所述区域标签，获取所述第一稀疏编码的第二稀疏编码，并利用所述第二字典学习模型中的分类器，获取所述第二稀疏编码的位置标签，作为所述目标的位置标签；其中，所述第二字典学习模型用于基于字典原子局部约束项增强所述第二稀疏编码的区分度，且为利用多个样本CSI数据的第一稀疏编码和每个样本CSI数据的位置标签训练得到的稀疏编码模型；所述分类器用于按照稀疏编码的位置标签的不同进行分类。第二方面，本发明实施例提供一种基于双层字典学习的CSI指纹定位装置，所述装置包括：信息采集模块，用于在获取到对目标进行定位的指令时，采集所述目标的信道状态信息，作为目标信道状态信息CSI数据；第一编码模块，用于基于预先训练得到的第一字典学习模型，获取所述目标CSI数据的第一稀疏编码以及区域标签；其中，所述第一字典学习模型用于基于最小化重构误差原则进行CSI数据所属区域的判别，且为利用多个样本CSI数据和每个样本CSI数据的位置标签训练得到的稀疏编码模型；第二编码模块，用于基于预先训练得到的第二字典学习模型和所述区域标签，获取所述第一稀疏编码的第二稀疏编码，并利用所述第二字典学习模型中的分类器，获取所述第二稀疏编码的位置标签，作为所述目标的位置标签；其中，所述第二字典学习模型用于基于字典原子局部约束项增强所述第二稀疏编码的区分度，且为利用多个样本CSI数据的第一稀疏编码和每个样本CSI数据的位置标签训练得到的稀疏编码模型；所述分类器用于按照稀疏编码的位置标签的不同进行分类。第三方面，本发明实施例提供一种电子设备，该电子设备包括处理器、通信接口、存储器和通信总线，其中，处理器，通信接口，存储器通过通信总线完成相互间的通信；存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现上述第一方面提供基于双层字典学习的CSI指纹定位方法步骤。本发明实施例有益效果：本发明实施例提供的方案中，基于预先训练得到的第一字典学习模型，获取目标CSI数据的第一稀疏编码以及区域标签，基于预先训练得到的第二字典学习模型和区域标签，获取第一稀疏编码的第二稀疏编码。因此，可以通过字典学习模型对目标CSI数据进行稀疏编码，实现对高纬度的目标CSI数据的简洁表达与深层特征提取，从而在对目标CSI数据降噪的并且，降低存储压力和数据处理复杂度。并且，通过两层字典学习模型：第一字典学习模型和第二字典学习模型，分别获取区域标签和增强区分度的第二稀疏编码，保证不同定位区域的稀疏编码具有高区分度，以及不同指纹点也就是不同位置标签的稀疏编码具有高区分度，从而提高定位的准确度。并且，基于第二稀疏编码，利用预先训练得到的分类器，获取第二稀疏编码的位置标签，作为目标的位置标签；其中，分类器用于按照稀疏编码的位置标签的不同进行分类。因此，可以将指纹定位中的匹配过程简化为对第二字典学习模型的输出进行分类即可，可以降低匹配过程，也就是数据处理的复杂度。可见，本方案可以兼顾提高定位准确度，以及降低存储压力和数据处理复杂度。当然，实施本发明的任一产品或方法并不一定需要并且达到以上所述的所有优点。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的实施例。图1为本发明一实施例提供的一种基于双层字典学习的CSI指纹定位方法的流程示意图；图2为本发明一实施例提供的一种基于双层字典学习的CSI指纹定位方法的应用场景示例图；图3为本发明一实施例提供的一种基于双层字典学习的CSI指纹定位方法中，字典学习模型的训练过程示例图；图4为本发明一实施例提供的一种基于双层字典学习的CSI指纹定位装置的结构示意图；图5为本发明一实施例提供的电子设备的结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员基于本申请所获得的所有其他实施例，都属于本发明保护的范围。正交频分复用技术是无线通信中一种带宽受限的数字多载波调制方式，已经成为应用最广的多载波调制技术。而在Wi-Fi网络中，OFDM将信号分成具有不同频率的多个正交子信道，其中信道状态信息反映了发送器和接收器之间通信链路的特征，包括距离、散射、衰落等对信号的影响。频道状态信息可以表示为：其中，和分别代表发射和接受信号向量，而向量表示加性高斯白噪声，H矩阵就表示信道状态信息，它是每个子载波信道信息的集合，可以利用和估计得到。其中H＝T，N为子载波数，Hi以复数形式出现：Hi＝|Hi|exp{j∠Hi}。其中，|Hi|和∠Hi分别是子载波i的幅度相应和相位相应。由于衰落效应和频率偏移，CSI数据的相位与幅度相比略显嘈杂，因此，利用CSI数据的幅度信息可以降低噪声。字典学习也称为稀疏表示，它通过学习一组原子并组合构成字典，使得给定的信号可以很好地利用稀疏表示，并能够通过字典矩阵中的几个原子的线性组合来重构。稀疏编码是指原始信号y基于一个字典D得到稀疏信号x的过程，通常表述为以下约束优化目标：其中，等式约束y＝Dx对于该优化问题来说过于严格，因此，可以用一个较小的阈值来放松该优化问题。并且，为了使算法更适用于分类问题，可以在目标函数中嵌入类标签信息或分类器参数，使稀疏编码更具有识别能力。结合上述内容，本发明实施例提供一种基于双层字典学习的CSI指纹定位方法，该方法可以应用于提供定位服务的电子设备。在具体应用中，该电子设备具体可以包括：台式计算机，便携式计算机，移动终端，可穿戴设备，互联网电视以及服务器等等。如图1所示，本发明实施例提供的一种基于双层字典学习的CSI指纹定位方法，该方法可以包括如下步骤：S101，在获取到对目标进行定位的指令时，采集目标的信道状态信息，作为目标信道状态信息CSI数据。其中，获取对目标进行定位的指令的方式具体可以是多种的。示例性的，可以接收目标发送的对目标进行定位的指令，或者，可以在检测到存在目标时，确定获取到对目标进行定位的指令。S102，基于预先训练得到的第一字典学习模型，获取目标CSI数据的第一稀疏编码以及区域标签。其中，第一字典学习模型用于基于最小化重构误差原则进行CSI数据所属区域的判别，且为利用多个样本CSI数据和每个样本CSI数据的位置标签训练得到的稀疏编码模型。S103，基于预先训练得到的第二字典学习模型和区域标签，获取第一稀疏编码的第二稀疏编码，并利用第二字典学习模型中的分类器，获取第二稀疏编码的位置标签，作为目标的位置标签。其中，第二字典学习模型用于基于字典原子局部约束项增强第二稀疏编码的区分度，且为利用多个样本CSI数据的第一稀疏编码和每个样本CSI数据的位置标签训练得到的稀疏编码模型；分类器用于按照稀疏编码的位置标签的不同进行分类。本发明实施例提供的方案中，可以通过字典学习模型对目标CSI数据进行稀疏编码，实现对高纬度的目标CSI数据的简洁表达与深层特征提取，从而在对目标CSI数据降噪的并且，降低存储压力和数据处理复杂度。并且，通过两层字典学习模型：第一字典学习模型和第二字典学习模型，分别获取区域标签和增强区分度的第二稀疏编码，保证不同定位区域的稀疏编码具有高区分度，以及不同指纹点也就是不同位置标签的稀疏编码具有高区分度，从而提高定位的准确度。并且，可以将指纹定位中的匹配过程简化为对第二字典学习模型的输出进行分类即可，可以降低匹配过程，也就是数据处理的复杂度。可见，本方案可以兼顾提高定位准确度，以及降低存储压力和数据处理复杂度。在一种可选的实施方式中，上述第一字典学习模型，采用如下步骤训练得到：基于多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据；将样本数据，字典学习模型的规格，以及字典学习模型的初始参数，输入第一字典学习模型的目标函数，对第一字典学习模型的目标函数进行迭代训练：当第一字典学习模型的目标函数收敛时，将所训练的第一字典学习模型的目标函数，作为第一字典学习模型；收敛包括：迭代次数达到第一迭代阈值，或当前迭代的目标函数与上一次迭代的目标函数之间，输出结果的差异小于第一差异阈值；当第一字典学习模型的目标函数不收敛时，利用样本数据，获取更新的第一稀疏编码，并利用更新的第一稀疏编码对所训练的第一字典学习模型的目标函数进行更新。在一种可选的实施方式中，上述第二字典学习模型，采用如下步骤训练得到：基于多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据；将样本数据的第一稀疏编码，字典学习模型的规格，以及字典学习模型的初始参数，输入第一字典学习模型的目标函数，对第一字典学习模型的目标函数进行迭代训练：当第二字典学习模型的目标函数收敛时，将所训练的第二字典学习模型的目标函数，作为第二字典学习模型；收敛包括：迭代次数达到第二迭代阈值，或当前迭代的目标函数与上一次迭代的目标函数之间，输出结果的差异小于第二差异阈值；当第二字典学习模型的目标函数不收敛时，利用多个样本CSI数据，以及每个样本CSI数据的位置标签的图拉普拉斯矩阵，获取更新的第二稀疏编码，并利用更新的第二稀疏编码对所训练的第二字典学习模型的目标函数进行更新。示例性的，如图2所示。本发明实施例提供的基于双层字典学习的CSI指纹定位方法，可以看作包括两个阶段：第一阶段是离线训练阶段，第二阶段是在线定位阶段。上述两个可选实施例即为离线训练阶段，本发明图1实施例即为在线定位阶段。在离线训练阶段，训练数据为Y，字典规格为K，参数为α,τ,λ1,λ2,θ。这样：针对第一字典学习模型：可以通过X＝TD+τI+τΛ)-1DTY更新稀疏编码；通过更新所训练的第一字典学习模型的目标函数。其中，X为更新后的第一稀疏编码，D为所训练的第一字典学习模型的目标函数，D为更新后的所训练的第一字典学习模型的目标函数。针对第二字典学习模型：可以通过获得图拉普拉斯矩阵；通过Z＝TD+λ1L)-1DTx获取更新的第二稀疏编码；通过D＝XZTZT+Δ)-1更新第二字典学习模型中的字典，以及通过更新分类器参数。其中，L为图拉普拉斯矩阵，D为所训练的第二字典学习模型的目标函数，Δ为一对角矩阵，其对角线上的元素为拉格朗日乘子，D为更新的第二字典学习模型中的字典，Z为更新的第二稀疏编码，U',b'为更新的分类器参数，n为输入的样本CSI数据的数量，l为损失函数，uc为支持向量机的第c类超平面参数，zi为第i个样本CSI数据的第二稀疏编码，为第i个类别为c类的样本CSI数据，bc为支持向量机的第c类偏差。在一种可选的实施方式中，上述基于多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据，具体可以包括如下步骤：分别将每个样本CSI数据图像化，得到多个CSI图像；针对每个CSI图像，获取该CSI图像各像素点的原始平均振幅，并对各像素点的原始平均振幅进行离差标准化，得到第一标准化后的CSI图像；基于第一标准化后的CSI图像，获得样本数据。示例性的，基于第一标准化后的CSI图像，获得样本数据的方式，可以是多种的。在一种可选的实施方式中，可以直接将第一标准化后的CSI图像作为样本数据。在另一种可选的实时方式中，上述基于第一标准化后的CSI图像，获得样本数据，具体可以包括如下步骤：针对每个第一标准化后的CSI图像，利用原始平均振幅，对该第一标准化后的CSI图像中相应的像素点进行离差标准化，得到样本数据。利用CSI数据轨迹增强定位效果，将每一个参考点的CSI进行多次采集，例如在第i个RP，我们将来自W个子载波的H个CSI幅度测量分组，从而构建一个H×W的矩阵：其中，是在第i个RP的第h个时间戳中，来自第w个子载波的CSI幅度特征。由于字典学习在应对图像分类任务上具有出色性能，因此，可以将CSI数据图像化。首先应用一个标准化过程从CSI数据矩阵中得到更清晰的数据，也就是计算每个图象在每个位置点li处的原始平均振幅：其中，Ai为每个图象在每个位置点li处的原始平均振幅。在CSI图像的每一行使用离差标准化：对于位置点li的CSI图像，分别记录每一行的最大值与最小值则第h行第w列的单个元素的标准化结果为最终，标准化后的CSI幅度图像即为并且，为了保持图像的原始输出功率，可以利用先前计算的平均幅值对每个位置点li的CSI图像进行再一次的标准化：其中，为位置点li的再一次标准化后的CSI图像，为位置点li的标准化后的CSI图像，Amax为所有位置点中CSI数据的最大幅值。在一种可选的实施方式中，上述第一字典学习模型，为：其中，D为聚合了子字典的第一字典，Z为所述目标CSI数据的第一稀疏编码，n为所述第一字典对应的各区域的个数，Dl为第一字典中属于区域l的子字典，Xl为在区域l中采集的CSI数据Yl在对应子字典Dl上的稀疏编码，α,τ为常量参数，为字典原子约束项，f为非相干促进项，用于增强属于不同区域的CSI数据之间的区分度。在一种可选的实施方式中，上述第二字典学习模型，为：其中，Z为CSI数据的第二稀疏编码，U,b均为分类器参数，λ1和λ2是两个常量参数，为字典原子局部约束项，D为第二字典，为支持向量判别项，用于区分属于不同位置标签的稀疏编码，uc是与支持向量判别项所代表的支持向量的第c类超平面相关联的法向量，bc是与支持向量对应的偏差。示例性的，如图3所示。在训练过程中的目标函数与上述模型相似，区别在于目标函数的参数在训练过程不断更新，直到目标函数收敛时，目标函数的参数与上述模型的参数相同。因此，上述第一字典学习模型和第二字典学习模型均为收敛的字典学习模型的目标函数。为了减少包含大量指纹点的位置指纹库对数据处理带来的负担，在第一字典学习模型中，训练区域特定的子字典。为了让不同分区的CSI幅度的稀疏编码之间具有高区分度，首先引入如下的非相干促进项：其中，Dl对应区域l的子字典，Xl为区域l上采集的CSI训练数据Yl在对应子字典Dl上的稀疏编码。表示Xl的互补矩阵，即在所有的训练数据中排除Xl本身。其中，Xl和分区l是对应的，也就是说训练数据Yl可以很好地被Xl表示而不是Xj,。如下式所示，在优化过程中要尽可能的小，从而确保DlXj和Yl并不接近，而这一点将显著增加指纹点分区时的判别效果：并且，为了保证Xl尽可能稀疏，为了减少现有的模型大多会对稀疏编码采用l0-范数正则化或l1-范数正则化所导致的计算耗时，以训练一个高效的区域分类模型，本发明实施例利用l2，1-范数保证编码系数的行稀疏，且l2，1-范数的计算比较容易。最终，定义第一字典学习模型的目标函数为：其中，为字典原子约束项，使第一字典学习模型的计算过程保持稳定。第一字典学习模型对输入的CSI数据进行区域判别，而不涉及更细节的指纹匹配，因此不额外训练分类器，而是以重构误差的最小化作为衡量标准来进行区域判别：也就是说，ynew根据它的稀疏编码来分区的，具体方法是将其分配给能够得到最小化重构误差的对象类。综上，在双层学习模型中，第一字典学习模型可以通过引入一个非相干促进项来保证CSI数据在对应区域子字典上的稀疏表示能力。并且，为了使稀疏编码还具备指纹定位的能力，可以将第一字典学习模型的第一稀疏编码作为第二字典学习模型的输入，引入一个支持向量判别项，从而强制来自不同指纹点的稀疏编码能分隔开，其具体定义为：并且，考虑到CSI数据的敏感性及不稳定性，引入字典原子局部约束项，它可以进一步增强第二字典学习模型对CSI数据流形结构描述的真实性。最终，提出第二层的目标函数如下：这样，经过第一字典学习模型的稀疏编码输入到第二字典学习中，并通过分类器参数U和b进行位置标签的预测。相应于上述方法实施例，本发明实施例还提供一种基于双层字典学习的CSI指纹定位装置。如图4所示，本发明一实施例提供的一种基于双层字典学习的CSI指纹定位装置的结构，该装置包括：信息采集模块401，用于在获取到对目标进行定位的指令时，采集所述目标的信道状态信息，作为目标信道状态信息CSI数据；第一编码模块402，用于基于预先训练得到的第一字典学习模型，获取所述目标CSI数据的第一稀疏编码以及区域标签；其中，所述第一字典学习模型用于基于最小化重构误差原则进行CSI数据所属区域的判别，且为利用多个样本CSI数据和每个样本CSI数据的位置标签训练得到的稀疏编码模型；第二编码模块403，用于基于预先训练得到的第二字典学习模型和所述区域标签，获取所述第一稀疏编码的第二稀疏编码，并利用所述第二字典学习模型中的分类器，获取所述第二稀疏编码的位置标签，作为所述目标的位置标签；其中，所述第二字典学习模型用于基于字典原子局部约束项增强所述第二稀疏编码的区分度，且为利用多个样本CSI数据的第一稀疏编码和每个样本CSI数据的位置标签训练得到的稀疏编码模型；所述分类器用于按照稀疏编码的位置标签的不同进行分类。本发明实施例提供的方案中，可以通过字典学习模型对目标CSI数据进行稀疏编码，实现对高纬度的目标CSI数据的简洁表达与深层特征提取，从而在对目标CSI数据降噪的并且，降低存储压力和数据处理复杂度。并且，通过两层字典学习模型：第一字典学习模型和第二字典学习模型，分别获取区域标签和增强区分度的第二稀疏编码，保证不同定位区域的稀疏编码具有高区分度，以及不同指纹点也就是不同位置标签的稀疏编码具有高区分度，从而提高定位的准确度。并且，可以将指纹定位中的匹配过程简化为对第二字典学习模型的输出进行分类即可，可以降低匹配过程，也就是数据处理的复杂度。可见，本方案可以兼顾提高定位准确度，以及降低存储压力和数据处理复杂度。可选的，所述第一字典学习模型，采用如下步骤训练得到：基于所述多个样本CSI数据以及每个样本CSI数据的位置标签，获取样本数据；将所述样本数据，字典学习模型的规格，以及字典学习模型的初始参数，输入第一字典学习模型的目标函数，对所述第一字典学习模型的目标函数进行迭代训练：当所述第一字典学习模型的目标函数收敛时，将所训练的第一字典学习模型的目标函数，作为所述第一字典学习模型；所述收敛包括：迭代次数达到第一迭代阈值，或当前迭代的目标函数与上一次迭代的目标函数之间，输出结果的差异小于第一差异阈值；当所述第一字典学习模型的目标函数不收敛时，利用所述样本数据，获取更新的第一稀疏编码，并利用所述更新的第一稀疏编码对所训练的第一字典学习模型的目标函数进行更新。本发明实施例还提供了一种电子设备，如图5所示，包括处理器501、通信接口502、存储器503和通信总线504，其中，处理器501，通信接口502，存储器503通过通信总线504完成相互间的通信，存储器503，用于存放计算机程序；处理器501，用于执行存储器503上所存放的程序时，实现如下步骤：在获取到对目标进行定位的指令时，采集所述目标的信道状态信息，作为目标信道状态信息CSI数据；基于预先训练得到的第一字典学习模型，获取所述目标CSI数据的第一稀疏编码以及区域标签；其中，所述第一字典学习模型用于基于最小化重构误差原则进行CSI数据所属区域的判别，且为利用多个样本CSI数据和每个样本CSI数据的位置标签训练得到的稀疏编码模型；基于预先训练得到的第二字典学习模型和所述区域标签，获取所述第一稀疏编码的第二稀疏编码，并利用所述第二字典学习模型中的分类器，获取所述第二稀疏编码的位置标签，作为所述目标的位置标签；其中，所述第二字典学习模型用于基于字典原子局部约束项增强所述第二稀疏编码的区分度，且为利用多个样本CSI数据的第一稀疏编码和每个样本CSI数据的位置标签训练得到的稀疏编码模型；所述分类器用于按照稀疏编码的位置标签的不同进行分类。本发明实施例提供的方案中，可以通过字典学习模型对目标CSI数据进行稀疏编码，实现对高纬度的目标CSI数据的简洁表达与深层特征提取，从而在对目标CSI数据降噪的并且，降低存储压力和数据处理复杂度。并且，通过两层字典学习模型：第一字典学习模型和第二字典学习模型，分别获取区域标签和增强区分度的第二稀疏编码，保证不同定位区域的稀疏编码具有高区分度，以及不同指纹点也就是不同位置标签的稀疏编码具有高区分度，从而提高定位的准确度。并且，可以将指纹定位中的匹配过程简化为对第二字典学习模型的输出进行分类即可，可以降低匹配过程，也就是数据处理的复杂度。可见，本方案可以兼顾提高定位准确度，以及降低存储压力和数据处理复杂度。上述电子设备提到的通信总线可以是外设部件互连标准总线或扩展工业标准结构总线等。该通信总线可以分为地址总线、数据总线、控制总线等。为便于表示，图中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。通信接口用于上述电子设备与其他设备之间的通信。存储器可以包括随机存取存储器，也可以包括非易失性存储器，例如至少一个磁盘存储器。可选的，存储器还可以是至少一个位于远离前述处理器的存储装置。上述的处理器可以是通用处理器，包括中央处理器、网络处理器等；还可以是数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。在本发明提供的又一实施例中，还提供了一种计算机可读存储介质，该计算机可读存储介质内存储有计算机程序，所述计算机程序被处理器执行时实现上述任一基于双层字典学习的CSI指纹定位方法的步骤。在本发明提供的又一实施例中，还提供了一种包含指令的计算机程序产品，当其在计算机上运行时，使得计算机执行上述实施例中任一基于双层字典学习的CSI指纹定位方法。在上述实施例中，可以全部或部分地通过软件、硬件、固件或者其任意组合来实现。当使用软件实现时，可以全部或部分地以计算机程序产品的形式实现。所述计算机程序产品包括一个或多个计算机指令。在计算机上加载和执行所述计算机程序指令时，全部或部分地产生按照本发明实施例所述的流程或功能。所述计算机可以是通用计算机、专用计算机、计算机网络、或者其他可编程装置。所述计算机指令可以存储在计算机可读存储介质中，或者从一个计算机可读存储介质向另一个计算机可读存储介质传输，例如，所述计算机指令可以从一个网站站点、计算机、服务器或数据中心通过有线)或无线方式向另一个网站站点、计算机、服务器或数据中心进行传输。所述计算机可读存储介质可以是计算机能够存取的任何可用介质或者是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。所述可用介质可以是磁性介质，、光介质、或者半导体介质)等。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。本说明书中的各个实施例均采用相关的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于装置和设备实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。以上所述仅为本发明的较佳实施例，并非用于限定本发明的保护范围。凡在本发明的精神和原则之内所作的任何修改、等同替换、改进等，均包含在本发明的保护范围内。
