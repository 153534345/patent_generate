标题title
一种基于多元纹理图像分析算法的多元图像分割方法
摘要abst
本发明公开了一种基于多元纹理图像分析算法的多元图像分割方法，步骤为：使用灰度共生矩阵求取图像各个通道的纹理特征影像，叠加纹理特征影像以构造多元图像，使用多元图像分析得到构造的多元图像的得分图像，利用阈值对感兴趣区域进行分割，使用分割结果构建决策树模型以将分割结果推广到具有同类型感兴趣区域的图像上。本发明为多元图像的纹理分析提供了更多的可能性，可用于对背景复杂、恶劣的图片中的感兴趣区域进行分割，也可应用于颜色与背景相比差异不明确的目标的识别。
权利要求书clms
1.一种基于多元纹理图像分析算法的多元图像分割方法，其特征在于，包括以下步骤：1)使用灰度共生矩阵求取图像各个通道的纹理特征影像，将纹理特征影像叠加构造多元图像，2)将构造的多元图像展开并基于主成分分析进行分解，得到得分向量；3)将得到的得分向量的每一列依照展开的顺序折叠回图像格式并以图像形式显示，这种图像称为得分图，选择感兴趣区域与其周边区域显示相差最大的得分图，使用阈值从这张得分图像上分割出感兴趣区域；4)使用步骤3)中的得分图和分割完成的图片作为训练的数据库训练决策树，得到的训练好的决策模型，对具有同类型感兴趣区域的图片进行分割。2.根据权利要求1所述的基于多元纹理图像分析算法的多元图像分割方法，其特征在于：所述步骤1)具体步骤为：1-1)对于一张r×c×3大小的RGB图像，r、c分别为图像的长和宽，分离出其R、G、B通道图像，每张通道图像表现为大小为r×c的图片矩阵I，对任意一个通道的图片矩阵I进行扩充：在图片矩阵I上下各拼接一个大小为n≤min的零矩阵，n为零矩阵的大小参数，在图片矩阵I左右各拼接一个大小为n≤min的零矩阵，得到扩充矩阵Ie；1-2)以图片矩阵Ie的任一元素i为中心，a和b是表示元素i的位置参数，其中a＜r，b＜c，取其前后的行和其前后的列并与其本身组成一个大小为n×n的矩阵W，求取矩阵W在0°、45°、90°和135°四个方向上的灰度共生矩阵，根据灰度共生矩阵算出矩阵W在四个方向上的对比度、相关性、能量和同质性统计量的值；然后求取每一种统计量的平均值，并以求得的平均值替换扩充矩阵Ie中的元素i，重复以上步骤直到对图片矩阵I中每一个元素执行上述替换操作为止，即得到了4个大小为×的统计量矩阵SCon、SCor、SEne和SHom，SCon为对比度矩阵，SCor为相关性矩阵、SEne为能量矩阵，SHom为同质性矩阵，将求得的统计量矩阵与Ie相加，即得到了相应的纹理影像矩阵ICon、ICor、IEne和IHom，ICon为对比度纹理影像矩阵、ICor为相关性纹理影像矩阵、IEne为能量纹理影响矩阵，IHom为同质性纹理影像矩阵；1-3)对图片的剩余两个通道重复以上操作便求得了整个图片的纹理特征影像，一共12张图片，将图片的12个纹理特征影像按照R、G、B的顺序叠加得到多元图像X××12。3.根据权利要求2所述的基于多元纹理图像分析算法的多元图像分割方法，其特征在于，所述步骤1)中，求取图像每个通道的纹理影像矩阵中使用滑动窗口遍历整个图像，对每个窗口内的矩阵求取灰度共生矩阵的统计量。4.根据权利要求2所述的基于多元纹理图像分析算法的多元图像分割方法，其特征在于，所述步骤2)具体过程为：首先将多元图像X××12依照顺序展开成大小为×12的二维矩阵；然后使用主成分分析的原理将之分解，得到大小为×1的分数向量。5.根据权利要求4所述的基于多元纹理图像分析算法的多元图像分割方法，其特征在于：所述步骤2)中，对多元图像展开是将每个通道依次展开成一个列向量，然后将所有的列向量并列得到展开的二维矩阵。6.根据权利要求1所述的基于多元纹理图像分析算法的多元图像分割方法，其特征在于：所述步骤3)中所述得分图的显示方法，对于每一个像素值的大小都作为像素强度显示，显示范围为。7.根据权利要求1所述的基于多元纹理图像分析算法的多元图像分割方法，其特征在于：所述步骤4)中，使用得分图和分割完成的图片作为决策树的训练数据时，依照步骤2)中的方法将图像展开，得到展开后的两个向量在在空间位置上一一对应。8.根据权利要求1所述的基于多元纹理图像分析算法的多元图像分割方法，其特征在于：所述步骤4)中所使用的决策树以信息增益为准则进行属性划分。
说明书desc
技术领域本发明涉及图像处理技术领域，特别涉及一种基于多元纹理图像分析算法的多元图像分割方法。背景技术图像分割是将感兴趣区域从图像中分割出来的一种图像处理技术，是由图像处理到图像分析的关键。大量的传统图像处理算法仅能处理二维图像，即被灰度化或二值化之后的图像。这些图像处理算法忽略了图片的颜色信息，且对图像的处理效果受光照影响较大，鲁棒性较差。多元图像分析可以对多图像的多元信息进行利用，一定程度上削弱了光照影响；但多元图像分析忽略了图像的部分纹理信息，难以分割场景复杂的图像。在实际运用中，为每一张图片都设计一种算法去分割感兴趣区域会使效率变得十分低下，因此设计出一种可以分割同一类型感兴趣区域的算法变得尤为关键，但是由于在不同光照环境下、不同背景中感兴趣区域会有一定的变化，因此对某一类型的感兴趣区域进行分割具有一定的难点。发明内容为了解决上述技术问题，本发明提供一种算法简单、分割精度高的基于多元纹理图像分析算法的多元图像分割方法。本发明解决上述问题的技术方案是：一种基于多元纹理图像分析算法的多元图像分割方法，包括以下步骤：1)使用灰度共生矩阵求取图像各个通道的纹理特征影像，将纹理特征影像叠加构造多元图像，2)将构造的多元图像展开并基于主成分分析进行分解，得到得分向量；3)将得到的得分向量的每一列依照展开的顺序折叠回图像格式并以图像形式显示，这种图像称为得分图，选择感兴趣区域与其周边区域显示相差最大的得分图，使用阈值从这张得分图像上分割出感兴趣区域；4)使用步骤3)中的得分图和分割完成的图片作为训练的数据库训练决策树，得到的训练好的决策模型，对具有同类型感兴趣区域的图片进行分割。上述基于多元纹理图像分析算法的多元图像分割方法，所述步骤1)具体步骤为：1-1)对于一张r×c×3大小的RGB图像，r、c分别为图像的长和宽，分离出其R、G、B通道图像，每张通道图像表现为大小为r×c的图片矩阵I，对任意一个通道的图片矩阵I进行扩充：在图片矩阵I上下各拼接一个大小为n≤min的零矩阵，n为零矩阵的大小参数，在图片矩阵I左右各拼接一个大小为n≤min的零矩阵，得到扩充矩阵Ie；1-2)以图片矩阵Ie的任一元素i为中心，a和b是表示元素i的位置参数，其中a＜r，b＜c，取其前后的行和其前后的列并与其本身组成一个大小为n×n的矩阵W，求取矩阵W在0°、45°、90°和135°四个方向上的灰度共生矩阵，根据灰度共生矩阵算出矩阵W在四个方向上的对比度、相关性、能量和同质性统计量的值；然后求取每一种统计量的平均值，并以求得的平均值替换扩充矩阵Ie中的元素i，重复以上步骤直到对图片矩阵I中每一个元素执行上述替换操作为止，即得到了4个大小为×的统计量矩阵SCon、Scor、SEne和SHom，SCon为对比度矩阵，SCor为相关性矩阵、SEne为能量矩阵，SHom为同质性矩阵，将求得的统计量矩阵与Ie相加，即得到了相应的纹理影像矩阵ICon、ICor、IEne和IHom，ICon为对比度纹理影像矩阵、ICor为相关性纹理影像矩阵、IEne为能量纹理影响矩阵，IHom为同质性纹理影像矩阵；1-3)对图片的剩余两个通道重复以上操作便求得了整个图片的纹理特征影像，一共12张图片，将图片的12个纹理特征影像按照R、G、B的顺序叠加得到多元图像X××12。上述基于多元纹理图像分析算法的多元图像分割方法，所述步骤1)中，求取图像每个通道的纹理影像矩阵中使用滑动窗口遍历整个图像，对每个窗口内的矩阵求取灰度共生矩阵的统计量。上述基于多元纹理图像分析算法的多元图像分割方法，所述步骤2)具体过程为：首先将多元图像X××12依照顺序展开成大小为×12的二维矩阵；然后使用主成分分析的原理将之分解，得到大小为×1的分数向量。上述基于多元纹理图像分析算法的多元图像分割方法，所述步骤2)中，对多元图像展开是将每个通道依次展开成一个列向量，然后将所有的列向量并列得到展开的二维矩阵。上述基于多元纹理图像分析算法的多元图像分割方法，所述步骤3)中所述得分图的显示方法，对于每一个像素值的大小都作为像素强度显示，显示范围为。上述基于多元纹理图像分析算法的多元图像分割方法，所述步骤4)中，使用得分图和分割完成的图片作为决策树的训练数据时，依照步骤2)中的方法将图像展开，得到展开后的两个向量在在空间位置上一一对应。上述基于多元纹理图像分析算法的多元图像分割方法，所述步骤4)中所使用的决策树以信息增益为准则进行属性划分。本发明的有益效果在于：本发明首先使用灰度共生矩阵求取图像各个通道的纹理特征影像，叠加纹理特征影像以构造多元图像，然后使用多元图像分析得到构造的多元图像的得分图像，利用阈值对感兴趣区域进行分割，再使用分割结果构建决策树模型以将分割结果推广到具有同类型感兴趣区域的图像上，本发明为多元图像的纹理分析提供了更多的可能性，可用于对背景复杂、恶劣的图片中的感兴趣区域进行分割，也可应用于颜色与背景相比差异不明确的目标的识别，适合于复杂场景下的同一类型感兴趣区域的分割，具有较强的实用性，可以利用图像的纹理、颜色和像素空间信息进行分割，几乎不受光照影响。附图说明图1为本发明的流程图。图2为实施例中包含感兴趣区域的原始图片示意图。图3为实施例中灰度共生影像示意图。图4为实施例中纹理特征影像示意图。图5为实施例中主成分分析分解后得到的得分图像示意图。图6为实施例中对感兴趣区域的分割结果示意图。图7为实施例中具有同类型感兴趣区域的原始图像示意图。图8为实施例中利用决策树对感兴趣区域的分割结果示意图。具体实施方式下面结合附图和实施例对本发明做进一步的说明。如图1所示，一种基于多元纹理图像分析算法的多元图像分割方法，包括以下步骤：1)使用灰度共生矩阵求取图像各个通道的纹理特征影像，将纹理特征影像叠加构造多元图像。步骤1)具体步骤为：1-1)对于一张r×c×3大小的RGB图像，r、c分别为图像的长和宽，分离出其R、G、B通道图像，每张通道图像表现为大小为r×c的图片矩阵I，对任意一个通道的图片矩阵I进行扩充：在图片矩阵I上下各拼接一个大小为n≤min的零矩阵，n为零矩阵的大小参数，在图片矩阵I左右各拼接一个大小为n≤min的零矩阵，得到扩充矩阵Ie；1-2)以图片矩阵Ie的任一元素i为中心，a和b是表示元素i的位置参数，其中a＜r，b＜c，取其前后的行和其前后的列并与其本身组成一个大小为n×n的矩阵W，求取矩阵W在0°、45°、90°和135°四个方向上的灰度共生矩阵，根据灰度共生矩阵算出矩阵W在四个方向上的对比度、相关性、能量和同质性统计量的值；然后求取每一种统计量的平均值，并以求得的平均值替换扩充矩阵Ie中的元素i，重复以上步骤直到对图片矩阵I中每一个元素执行上述替换操作为止，即得到了4个大小为×的统计量矩阵SCon、SCor、SEne和SHom，SCon为对比度矩阵，SCor为相关性矩阵、SEne为能量矩阵，SHom为同质性矩阵，将求得的统计量矩阵与Ie相加，即得到了相应的纹理影像矩阵ICon、ICor、IEne和IHom，ICon为对比度纹理影像矩阵、ICor为相关性纹理影像矩阵、IEne为能量纹理影响矩阵，IHom为同质性纹理影像矩阵；1-3)对图片的剩余两个通道重复以上操作便求得了整个图片的纹理特征影像，一共12张图片，将图片的12个纹理特征影像按照R、G、B的顺序叠加得到多元图像X××12。所述步骤1)中，求取图像每个通道的纹理影像矩阵中使用滑动窗口遍历整个图像，对每个窗口内的矩阵求取灰度共生矩阵的统计量。2)将构造的多元图像展开并基于主成分分析进行分解，得到得分向量。步骤2)具体过程为：首先将多元图像X××12依照一定顺序展开成大小为×12的二维矩阵；然后使用主成分分析的原理将之分解，得到大小为×1的分数向量；所述步骤2)中，对多元图像展开是将每个通道依次展开成一个列向量，然后将所有的列向量并列得到展开的二维矩阵。3)将得到的得分向量的每一列依照展开的顺序折叠回图像格式并以图像形式显示，这种图像称为得分图，得分图的显示方法，对于每一个像素值的大小都作为像素强度显示，显示范围为；选择感兴趣区域与其周边区域显示相差最大的得分图，使用阈值从这张得分图像上分割出感兴趣区域。4)使用步骤3)中的得分图和分割完成的图片作为训练的数据库训练决策树，得到的训练好的决策模型，对具有同类型感兴趣区域的图片进行分割。使用得分图和分割完成的图片作为决策树的训练数据时，依照步骤2)中的方法将图像展开，得到展开后的两个向量在在空间位置上一一对应。使用的决策树以信息增益为准则进行属性划分。实施例钢铁工业中的无损检测系统会对硅钢条的表面缺陷进行检测，以把控产品质量。本发明选用有表面缺陷的被油污污染的硅钢条表面图像作为实验对象，其缺陷为硅钢条缺陷中一种常见缺陷类型——刮痕。图像大小为640×480×3，图像上有反射伪缺陷干扰，如图2所示。选择缺陷为感兴趣区域，使用本发明的一种基于多元纹理图像分析算法对感兴趣区域进行分割。步骤一：得到包含感兴趣区域的图像，构造多元图像。图2为包含感兴趣区域的原始图片，图3为灰度共生影像，图4为纹理特征影像。选择使用尺寸为9的滑动窗口求取原始图像各通道的灰度共生矩阵的统计量矩阵，将其以图像形式显示。第一列从上到下分别为RGB通道的对比灰度共生影像，该图像突出了表面缺陷和伪缺陷的边缘。第二列从上到下分别为RGB通道的相关性灰度共生影像，该图像中硅钢条的刮痕像素强度与背景接近，伪缺陷较为突出。第三列从上到下分别为RGB通道的能量灰度共生影像，该图的刮痕和伪缺陷都较为突出，但刮痕与伪缺陷的像素强度相差较大。第四列从上到下分别为RGB通道的同质灰度共生影像，该图像突出了刮痕和伪缺陷的边缘。虽然这些图像都在一定程度上突出了刮痕，但是图像背景中散乱分布着大量与刮痕像素强度接近的像素点。将得到的灰度共生影像与各通道的图像叠加，得到纹理特征影像。将得到的纹理特征影像按照RGB通道顺序叠加，构造大小为640×480×12的多元图像。步骤二：针对构造的多元图像，使用主成分分析进行分解，得到得分图像。图5为主成分分析分解后得到的得分图像。将得到的多元图像展开后应用主成分分析分析，得到分数矩阵。分数矩阵中前四个主成分的方差为99.9982％，包含了原图的主要信息。将前四个主成分以图像的格式折叠，得到得分图像。步骤三：挑选合适的得分图像，使用阈值对感兴趣区域进行分割。图6为对感兴趣区域的分割结果。图5中左上方的得分图像PC1保留了原图的主要信息；图5中右上方的得分图像PC2突出显示了伪缺陷和刮痕，但二者的像素强度相近；图5中左下方的得分图像PC3突出显示了伪缺陷；图5中右下方的得分图像PC4突出显示了刮痕和伪缺陷，但二者的像素强度相差很大。因此，可选择PC4的得分图像用作分割，使用1作为分割阈值对PC4得分图像做分割，得到分割后的图像。步骤四：利用已经分割出感兴趣区域的图像和得分图像训练决策树模型。图7为具有同类型感兴趣区域的原始图像，图8为利用决策树对感兴趣区域的分割结果。将得分矩阵的第四列作为决策树的训练输入数据，分割结果图像展开为×1的列向量，作为决策树的训练输出数据。为了获得可靠稳定的模型，决策树采用五折交叉验证。得到的决策树模型分类准确度为100％。
