标题title
一种基于多核计算的层次聚类算法优化方法
摘要abst
本发明公开了一种基于多核计算的层次聚类算法优化方法，涉及并行化技术领域，包括S1准备压缩后的距离矩阵存储空间，层次聚类算法的距离矩阵存储空间压缩处理为数组da；S2数组da进行分块编号；S3构建线程池及任务队列；S4块block放入任务队列；S5判断任务队列中是否有任务块block，有进S6，没有进S8；S6选取一个块block，计算该块block在原距离矩阵中对应的索引区间；S7根据索引区间指示区域，计算该区域内所有样本点之间的距离，将距离写回数组da，返回S5；S8借助索引映射关系，样本数据两两合并，合并后类别数量与待处理样本数据一致时，结束聚类；缩短了层次聚类算法整体的运算时间，降低计算资源占用，提高了运行效率，且不影响输入输出数据的格式和大小。
权利要求书clms
1.一种基于多核计算的层次聚类算法优化方法，其特征在于，包括以下步骤：S1、为待处理样本数据准备压缩后的距离矩阵存储空间，将层次聚类算法的距离矩阵存储空间压缩处理为数组da；S2、对数组da按照固定块大小block_size进行分块,并对块按先后顺序从0开始编号；S3、构建线程池及其对应的任务队列；S4、将携带编号block_id和当前块大小bs的块block放入任务队列；S5、判断任务队列中是否还有任务块block，若有，则进入S6；若没有，则进入S8；S6、选取一个块block，并根据块block携带的block_id和块大小bs，利用索引映射关系计算出该块block在原距离矩阵中对应的索引区间；S7、根据索引区间指示区域，计算该区域内所有样本点之间的距离，将获得的距离写回到数组da指定索引位置，返回S5；S8、借助索引映射关系，运行NN-CHAIN算法对距离最近的样本数据进行两两合并，直到合并后的类别数量与待处理样本数据的类别数一致时，结束聚类。2.根据权利要求1所述的一种基于多核计算的层次聚类算法优化方法，其特征在于，在S3中，线程池的线程数量小于等于计算机的CPU核心数，块大小block_size设置为2097152。3.根据权利要求1所述的一种基于多核计算的层次聚类算法优化方法，其特征在于，在S6中，根据块block携带的block_id和块大小bs，确定该块block对应数组da的索引范围，再使用索引映射关系,计算出块block在原距离矩阵中对应的索引区间,其中行索引为i，列索引为j。4.根据权利要求3所述的一种基于多核计算的层次聚类算法优化方法，其特征在于，在S6中，索引范围为。5.根据权利要求3所述的一种基于多核计算的层次聚类算法优化方法，其特征在于，在S1中，待处理样本数据的样本数量为n，原始距离矩阵大小为n*n，压缩处理后的数组da大小为n*/2。6.根据权利要求3所述的一种基于多核计算的层次聚类算法优化方法，其特征在于，在S6中，原始距离矩阵的索引到数组da的索引k的映射关系为其中记函数则数组da的索引k到原始距离矩阵的索引映射关系：当k＝fk,n-1)时，则i＝fi1，j＝n-1；否则i＝fi1+1，j＝k-fk+i+1。7.根据权利要求1-6中任一项所述的一种基于多核计算的层次聚类算法优化方法，其特征在于，在S7中，采用距离计算函数计算，在距离计算函数中包括：将索引区间内需要处理的数据分批次从内存加载到ymm寄存器，采用AVX指令计算每批次数据中样本点之间的距离。
说明书desc
技术领域本发明涉及并行化技术领域，尤其涉及一种基于多核计算的层次聚类算法优化方法。背景技术层次聚类算法是目前在各个应用领域都广泛使用的一种无监督机器学习算法，它将相似的对象归到同一个簇中，聚类过程不依赖于预先定义的类或带类标记的训练实例，由聚类过程自动确定标记。然而通过层次聚类算法分析大量高维度数据时，难以克服分析速度慢、计算资源占用高等问题。在一些需要快速获得分析结果的情况下，就需要分析算法具有较快的分析速度。显然现有的层次聚类算法难以满足要求。发明内容本发明的目的就在于为了解决上述问题设计了一种基于多核计算的层次聚类算法优化方法。本发明通过以下技术方案来实现上述目的：一种基于多核计算的层次聚类算法优化方法，包括以下步骤：S1、为待处理样本数据准备压缩后的距离矩阵存储空间，将层次聚类算法的距离矩阵存储空间压缩处理为数组da；S2、对数组da按照固定块大小block_size进行分块,并对块按先后顺序从0开始编号；S3、构建线程池及其对应的任务队列；S4、将携带编号block_id和当前块大小bs的块block放入任务队列；S5、判断任务队列中是否还有任务块block，若有，则进入S6；若没有，则进入S8；S6、选取一个块block，并根据块block携带的block_id和块大小bs，利用索引映射关系计算出该块block在原距离矩阵中对应的索引区间；S7、根据索引区间指示区域，计算该区域内所有样本点之间的距离，将获得的距离写回到数组da指定索引位置，返回S5；S8、借助索引映射关系，运行NN-CHAIN算法对距离最近的样本数据进行两两合并，直到合并后的类别数量与待处理样本数据的类别数一致时，结束聚类。本发明的有益效果在于：采用本方法缩短了层次聚类算法整体的运算时间，降低计算资源占用，提高了运行效率，且不影响输入输出数据的格式和大小。附图说明图1是本发明一种基于多核计算的层次聚类算法优化方法的原理图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述。显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本发明实施例的组件可以以各种不同的配置来布置和设计。因此，以下对在附图中提供的本发明的实施例的详细描述并非旨在限制要求保护的本发明的范围，而是仅仅表示本发明的选定实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。应注意到：相似的标号和字母在下面的附图中表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中不需要对其进行进一步定义和解释。在本发明的描述中，需要理解的是，术语“上”、“下”、“内”、“外”、“左”、“右”等指示的方位或位置关系为基于附图所示的方位或位置关系，或者是该发明产品使用时惯常摆放的方位或位置关系，或者是本领域技术人员惯常理解的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的设备或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”等仅用于区分描述，而不能理解为指示或暗示相对重要性。在本发明的描述中，还需要说明的是，除非另有明确的规定和限定，“设置”、“连接”等术语应做广义理解，例如，“连接”可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接连接，也可以通过中间媒介间接连接，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。下面结合附图，对本发明的具体实施方式进行详细说明。一种基于多核计算的层次聚类算法优化方法，包括以下步骤：S1、为待处理样本数据准备压缩后的距离矩阵存储空间，将层次聚类算法的距离矩阵存储空间压缩处理为数组da，其中待处理样本数据的样本数量为n，原始距离矩阵大小为n*n，压缩处理后的数组da大小为n*/2。S2、对数组da按照固定块大小block_size进行分块,并对块按先后顺序从0开始编号。S3、构建线程池及其对应的任务队列，线程池的线程数量小于等于计算机的CPU核心数，块大小block_size设置为2097152。S4、将携带编号block_id和当前块大小bs的块block放入任务队列。S5、判断任务队列中是否还有任务块block，若有，则进入S6；若没有，则进入S8。S6、选取一个块block，并根据块block携带的block_id和块大小bs，确定该块block对应数组da的索引范围为，再利用索引映射关系计算出该块block在原距离矩阵中对应的索引区间，其中行索引为i，列索引为j，原始距离矩阵的索引到数组da的索引k的映射关系为其中记函数则数组da的索引k到原始距离矩阵的索引映射关系：当k＝fk,n-1)时，则i＝fi1，j＝n-1；否则i＝fi1+1，j＝k-fk+i+1。S7、根据索引区间指示区域，采用距离计算函数计算该区域内所有样本点之间的距离，将获得的距离写回到数组da指定索引位置，返回S5，在距离计算函数中：首先将索引区间内需要处理的数据分批次从内存加载到ymm寄存器，再采用AVX指令计算每批次数据中样本点之间的距离。S8、借助索引映射关系，运行NN-CHAIN算法对距离最近的样本数据进行两两合并，直到合并后的类别数量与待处理样本数据的类别数一致时，结束聚类，例如：待处理样本数据的类别数量要求为K，根据成此书进行数据样本间的两两合并，直到最终类别数量为K时，结束聚类。采用上述方法解决了层次聚类算法运行速度慢问题，提升了该算法的实时数据处理能力，缩短了层次聚类算法整体的运算时间，降低计算资源占用，提高了运行效率，且不影响输入输出数据的格式和大小。本发明的技术方案不限于上述具体实施例的限制，凡是根据本发明的技术方案做出的技术变形，均落入本发明的保护范围之内。
