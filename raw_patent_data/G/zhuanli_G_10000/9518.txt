标题title
一种面向手机用户的多源信息融合的室内定位方法
摘要abst
本发明公开了一种面向手机用户的多源信息融合的室内定位方法，该定位方法包括粗定位和精定位两个过程，离线阶段，利用手机信号和蓝牙信号强度进行数据级融合，然后利用支持向量机进行分类学习，得到区域分类模型，完成粗定位训练；将WiFi信号强度转变成WiFi图像，然后和摄像头拍摄的图像进行像素级图像融合，利用卷积神经网络进行回归学习，得到基于位置的回归模型，完成精定位训练。在线阶段，首先利用区域定位模型得到粗定位结果，然后选择对应的位置回归模型，得到精定位结果。本发明提出了粗定位与精定位联合定位的方式，可以明显缩短定位所需时间，同时本发明增加了手机信号与拍摄图像作为数据源，定位数据来源更丰富，能有效提高定位精度。
权利要求书clms
1.一种面向手机用户的多源信息融合的室内定位方法，其特征在于，包括离线阶段和在线阶段，其中，离线阶段包括以下步骤：S1：采集训练样本：在不同区域的不同参考点上，利用手机采集手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集图像；S2:粗定位训练：利用手机和蓝牙信号强度进行基于区域的分类学习，得到定位区域分类模型，实现粗定位训练；S3:精定位训练：利用WiFi信号和图像进行基于位置的回归学习，得到位置回归模型，实现精定位训练；在线阶段包括以下步骤：S4：采集数据：通过手机获取实时手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集实时图像；S5:位置估计：根据粗定位结果选择位置估计模型，将融合后的图像代入位置估计模型，得到移动终端目标位置，实现精定位。2.根据权利要求1所述的一种面向手机用户的多源信息融合的室内定位方法，其特征在于，所述步骤S5中，还包括以下步骤：S51：将手机信号和蓝牙信号强度代入离线阶段步骤S2的区域分类模型，得到定位区域估计值；S52：将WiFi信号强度和图像代入步骤S51估计的定位区域对应的位置回归模型，得到位置估计值。3.根据权利要求1所述的一种面向手机用户的多源信息融合的室内定位方法，其特征在于，步骤S2中，还包括以下步骤：A1:多源信息预处理：对获得的手机和蓝牙信号强度，进行数据归一化处理；A2:基于数据集的多源信息融合：将预处理后的手机信号强度向量和蓝牙信号强度向量进行向量并操作，形成一个新的信号强度向量；A3:基于SVM支持向量机的分类学习：将融合后的信号强度向量作为训练数据指纹，利用SVM支持向量机进行分类学习，得到定位区域分类模型。4.根据权利要求1所述的一种面向手机用户的多源信息融合的室内定位方法，其特征在于，步骤S3中，还包括以下步骤：B1:数据预处理：对接收到的WiFi信号强度向量排列成矩阵形式，利用线性映射的方法将矩阵中元素数值按大小转化为不同颜色，形成WiFi图像；对手机摄像头采集的图像进行预处理，使得尺寸与WiFi图像一致；B2:基于像素级图像融合：将WiFi图像和手机摄像头得到的图像进行基于像素级的图像融合；B3:基于CNN卷积神经网络的回归学习在线阶段：对每一个定位区域，将融合后的图像作为训练样本指纹，利用CNN卷积神经网络进行基于位置的回归学习，得到位置回归模型。5.根据权利要求4所述的一种面向手机用户的多源信息融合的室内定位方法，其特征在于，步骤B1中，所述预处理包括拉普拉斯金字塔分解和缩放步骤，所述手机摄像头采集的图像经过拉普拉斯金字塔分解后，得到Laplace拉普拉斯分解图像；所述手机摄像头采集的图像经过缩放，使得尺寸与WiFi图像一致。6.根据权利要求5所述的一种面向手机用户的多源信息融合的室内定位方法，其特征在于，步骤B2中，WiFi指纹经过归一化处理后形成WiFi图像，与Laplace拉普拉斯分解图像按照1:15的权重进行融合。7.根据权利要求6所述的一种面向手机用户的多源信息融合的室内定位方法，其特征在于，融合时WiFi图像与Laplace拉普拉斯分解图像大小与通道数一致，最后形成融合图像。8.一种面向手机用户的多源信息融合的室内定位方法，其特征在于，包括离线阶段和在线阶段，其中，离线阶段包括以下步骤：S1：采集训练样本：在不同区域的不同参考点上，利用手机采集手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集图像；S2:粗定位训练：利用手机和蓝牙信号强度进行基于区域的分类学习，得到定位区域分类模型，实现粗定位训练；S3:多源信息预处理：对获得的手机和蓝牙信号强度，进行数据归一化处理；S4:基于数据集的多源信息融合：将预处理后的手机信号强度向量和蓝牙信号强度向量进行向量并操作，形成一个新的信号强度向量；S5:基于SVM支持向量机的分类学习：将融合后的信号强度向量作为训练数据指纹，利用SVM支持向量机进行分类学习，得到定位区域分类模型。S6:精定位训练：利用WiFi信号和图像进行基于位置的回归学习，得到位置回归模型，实现精定位训练；S7:数据预处理：对接收到的WiFi信号强度向量排列成矩阵形式，利用线性映射的方法将矩阵中元素数值按大小转化为不同颜色，形成WiFi图像；对手机摄像头采集的图像进行预处理，使得尺寸与WiFi图像一致；所述预处理包括拉普拉斯金字塔分解和缩放步骤，所述手机摄像头采集的图像经过拉普拉斯金字塔分解后，得到Laplace拉普拉斯分解图像；所述手机摄像头采集的图像经过缩放，使得尺寸与WiFi图像一致；S8:基于像素级图像融合：将WiFi图像和手机摄像头得到的图像进行基于像素级的图像融合；WiFi指纹经过归一化处理后形成WiFi图像，与Laplace拉普拉斯分解图像按照一定的权重进行融合；融合时需要保证WiFi图像与Laplace拉普拉斯分解图像大小与通道数一致，最后形成融合图像；S9:基于CNN卷积神经网络的回归学习在线阶段：对每一个定位区域，将融合后的图像作为训练样本指纹，利用CNN卷积神经网络进行基于位置的回归学习，得到位置回归模型。在线阶段包括以下步骤：S10：采集数据：通过手机获取实时手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集实时图像；S11:位置估计：根据粗定位结果选择位置估计模型，将融合后的图像代入位置估计模型，得到移动终端目标位置，实现精定位。S12：将手机信号和蓝牙信号强度代入离线阶段步骤S2的区域分类模型，得到定位区域估计值；S13：将WiFi信号强度和图像代入步骤S51估计的定位区域对应的位置回归模型，得到位置估计值。
说明书desc
技术领域本发明涉及通信技术与定位导航领域，具体是一种面向手机用户的多源信息融合的室内定位方法。背景技术室内定位已有多年的发展历史，现有的室内定位技术大概有：红外线室内定位技术、超声波定位技术、蓝牙定位技术、ZigBee定位技术、超宽带定位技术、WiFi定位技术、图像定位技术等等，这些方法各有利弊。随着无线通信、计算机技术等一些关键技术的发展，室内定位同时也向着多技术互补融合定位的方向发展。通过多技术融合的方式弥补某些定位技术的缺陷，提高室内定位的精度，将是目前研究的热点。现有技术中，专利号2019101907610公开了融合Wi-Fi和蓝牙的增强位置指纹室内定位方法，该方法需要搜索整个定位范围，定位速度慢，而本发明对定位范围进行划分，提出了粗定位与精定位联合定位的方式，可以明显缩短定位所需要的时间，同时本发明额外增加了手机信号与拍摄图像作为数据源，定位数据来源更加丰富，能有效提高定位精度。发明内容为实现上述目的，本发明提供了一种面向手机用户的多源信息融合的室内定位方法，包括离线阶段和在线阶段，其中，离线阶段包括以下步骤：S1：采集训练样本：在不同区域的不同参考点上，利用手机采集手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集图像；S2:粗定位训练：利用手机和蓝牙信号强度进行基于区域的分类学习，得到定位区域分类模型，实现粗定位训练；S3:精定位训练：利用WiFi信号和图像进行基于位置的回归学习，得到位置回归模型，实现精定位训练；在线阶段包括以下步骤：S4：采集数据：通过手机获取实时手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集实时图像；S5:位置估计：根据粗定位结果选择位置估计模型，将融合后的图像代入位置估计模型，得到移动终端目标位置，实现精定位；将定位过程分为粗定位和精定位两个过程，该两步定位设计能够提高离线学习效率。进一步的，所述步骤S5中，还包括以下步骤：S51：将手机信号和蓝牙信号强度代入离线阶段步骤S2的区域分类模型，得到定位区域估计值；S52：将WiFi信号强度和图像代入步骤S51估计的定位区域对应的位置回归模型，得到位置估计值。进一步的，步骤S2中，还包括以下步骤：A1:多源信息预处理：对获得的手机和蓝牙信号强度，进行数据归一化处理；A2:基于数据集的多源信息融合：将预处理后的手机信号强度向量和蓝牙信号强度向量进行向量并操作，形成一个新的信号强度向量；A3:基于SVM支持向量机的分类学习：将融合后的信号强度向量作为训练数据指纹，利用SVM支持向量机进行分类学习，得到定位区域分类模型。充分利用现有手机能够接收到的定位参数，利用数据融合和机器学习算法进行位置估计，具有定位精度高，定位速度快的优点。进一步的，步骤S3中，还包括以下步骤：B1:数据预处理：对接收到的WiFi信号强度向量排列成矩阵形式，利用线性映射的方法将矩阵中元素数值按大小转化为不同颜色，形成WiFi图像；对手机摄像头采集的图像进行预处理，使得尺寸与WiFi图像一致；B2:基于像素级图像融合：将WiFi图像和手机摄像头得到的图像进行基于像素级的图像融合；B3:基于CNN卷积神经网络的回归学习在线阶段：对每一个定位区域，将融合后的图像作为训练样本指纹，利用CNN卷积神经网络进行基于位置的回归学习，得到位置回归模型。进一步的，步骤B1中，所述预处理包括拉普拉斯金字塔分解和缩放步骤，所述手机摄像头采集的图像经过拉普拉斯金字塔分解后，得到Laplace拉普拉斯分解图像；所述手机摄像头采集的图像经过缩放，使得尺寸与WiFi图像一致。进一步的，步骤B2中，WiFi指纹经过归一化处理后形成WiFi图像，与Laplace拉普拉斯分解图像按照1:15的权重进行融合。更进一步的，为了使WiFi图像与Laplace拉普拉斯分解图像能够按照对应像素一一融合，融合时WiFi图像与Laplace拉普拉斯分解图像大小与通道数一致，最后形成融合图像。与现有技术相比，本发明的有益效果为：1、本发明的定位过程分为粗定位和精定位两个过程，该两步定位设计能够提高离线学习效率；2、本发明不需要改变现有通信系统硬件，网络升级影响小，并且定位方法实现开销小；3、本发明充分利用现有手机能够接收到的定位参数，利用数据融合和机器学习算法进行位置估计，具有定位精度高，定位速度快的优点。附图说明图1为本发明一种面向手机用户的多源信息融合的室内定位方法的步骤流程图；图2为本发明一种面向手机用户的多源信息融合的室内定位方法的粗定位模型图；图3为本发明一种面向手机用户的多源信息融合的室内定位方法的精定位模型图；图4为本发明一种面向手机用户的多源信息融合的室内定位方法的精定位图像融合流程图。具体实施方式下为使本发明实施例的目的、技术方案和优点更加清楚，下面将对本发明实施例中的技术方案进行清楚、完整地描述。实施例中未注明具体条件者，按照常规条件或制造商建议的条件进行。所用试剂或仪器未注明生产厂商者，均为可以通过市售购买获得的常规产品。实施例：如图1所示，一种面向手机用户的多源信息融合的室内定位方法，包括离线阶段和在线阶段，离线阶段，分别收集在粗定位所需要的基于区域的指纹数据库和精定位所需要的基于网格的图像指纹库；在线阶段，SVM支持向量机得到粗定位区域位置，离线训练模型得到精定位目标位置；其中，离线阶段包括以下步骤：S1：采集训练样本：在不同区域的不同参考点上，利用手机采集手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集图像；S2:粗定位训练：利用手机和蓝牙信号强度进行基于区域的分类学习，得到定位区域分类模型，实现粗定位训练；S3:精定位训练：利用WiFi信号和图像进行基于位置的回归学习，得到位置回归模型，实现精定位训练；在线阶段包括以下步骤：S4：采集数据：通过手机获取实时手机信号，蓝牙信号和WiFi信号强度，同时利用手机摄像头采集实时图像；采集阶段：本发明共有三个定位区域，包括一个室内办公区域和两个走廊区域，在每个区域中等间隔的划分参考点，并在每个参考点上按要求采集手机信号，蓝牙信号，WiFi接收信号和手机拍摄图像。在本实施例中，室内办公区域面积为4m×6m，两个走廊区域面积为2m×22m，以每块地砖0.6m×0.6m的面积划分参考点，将每个区域都分为40个参考点。S5:位置估计：将经过融合后的手机和蓝牙信号强度向量代入区域分类模型，实现粗定位，根据粗定位结果选择位置估计模型，将融合后的图像代入位置估计模型，得到移动终端目标位置，实现精定位。如图3所示，选择移动终端拍摄图像和WiFi指纹作为精定位测量参数。首先根据粗定位结果选择位置估计模型，将融合后的图像代入位置估计模型，即可得到移动终端目标位置，实现精定位。步骤S5中，还包括以下步骤：如图2所示，选择蓝牙信号和手机信号强度作为粗定位测量参数。在离线阶段，在每个区域内均匀地选择参考点，在参考点上获取数据并进行归一化，形成离线指纹数据集，利用SVM支持向量机进行分类学习，得到定位区域分类模型。S51：将手机信号和蓝牙信号强度代入离线阶段步骤S2的区域分类模型，得到定位区域估计值；S52：将WiFi信号强度和图像代入步骤S51估计的定位区域对应的位置回归模型，得到位置估计值。步骤S2中，还包括以下步骤：A1:多源信息预处理：对获得的手机和蓝牙信号强度，进行数据归一化处理；A2:基于数据集的多源信息融合：将预处理后的手机信号强度向量和蓝牙信号强度向量进行向量并操作，形成一个新的信号强度向量；对于n维向量e1＝，对其中的每一个向量进行归一化：e1',i＝)/-min)，得到归一化向量e′1＝；在本实施例中共有两个向量e1,e2，并操作后的向量为e＝e′1∪e'2；A3:基于SVM支持向量机的分类学习：将融合后的信号强度向量作为训练数据指纹，利用SVM支持向量机进行分类学习，得到定位区域分类模型；其SVM的原理为：SVM的学习目标是在特征空间学习一个分离超平面，将样本数据分到不同的类别。假定一个二分类训练数据集为T＝，其中xi为训练样本，yi为样本类别。在这里，将分类超平面定义为：ω·x+b＝0；将分类决策函数定义为：f＝sign；SVM的目标就是找到一个样本分类间隔最大的分类超平面，所谓的间隔指的是样本点到超平面的距离，用来表示分类预测的置信度，间隔越大则预测结果的置信度越高。因此，定义样本点和超平面ω·x+b＝0的函数间隔为：则所有样本点的函数间隔的最小值为为了使样本点到超平面的距离更加规范化，现在对法向量ω做一定的约束，在这里引入几何间隔：则所有样本点的几何间隔的最小值为SVM的目的就是找到d最大的分类超平面，具体的，这个问题可以表述为约束最优化问题把约束条件放大||ω||倍，则最优化问题可以改写为yi*≥d,i＝，求解这个问题得到最优解ω*，b*，就能够得到分类超平面和分类决策函数。这是唯一的最大间隔分类超平面。粗定位阶段：本实施例中共包含5个蓝牙信标，且手机处于两个小区的范围内，需要将采集到的手机信号与蓝牙信号按照各自的物理地址进行排列，变为一个1行7列的向量，对其归一化和标准化后，输入支持向量机SVM中，调整参数以提高分类效果。在本专利所述方法中，分类精度达到92％。在每个区域等间隔的采集手机信号与蓝牙信号共40组，共120组向量输入支持向量机SVM中，在线阶段随机在三个区域内采集共50个点的数据，与离线得到的分类模型进行匹配，结果为，共有46个点落在正确的区域内，故分类精度为92％。步骤S3中，还包括以下步骤：B1:数据预处理：对接收到的WiFi信号强度向量排列成矩阵形式，利用线性映射的方法将矩阵中元素数值按大小转化为不同颜色，形成WiFi图像；对手机摄像头采集的图像进行预处理，使得尺寸与WiFi图像一致；B2:基于像素级图像融合：将WiFi图像和手机摄像头得到的图像进行基于像素级的图像融合；B3:基于CNN卷积神经网络的回归学习在线阶段：对每一个定位区域，将融合后的图像作为训练样本指纹，利用CNN卷积神经网络进行基于位置的回归学习，得到位置回归模型。步骤B1中，预处理包括拉普拉斯金字塔分解和缩放步骤，手机摄像头采集的图像经过拉普拉斯金字塔分解后，得到Laplace拉普拉斯分解图像；手机摄像头采集的图像经过缩放，使得尺寸与WiFi图像一致；其中，Laplace拉普拉斯分解图像通过如下公式得出：其中Li表示第i层拉普拉斯图像，在本实施例中取L3为顶层图像。Gi表示第i层高斯图像，UP操作表示上采样，也即将高斯图像中位置为的像素映射到的像素上，表示卷积，G5×5表示5×5的高斯内核。为了获取图像Gi，需对图像Gi-1进行高斯内核卷积，然后将所有偶数行和列全部去除，得到的图像即为Gi。步骤B2中，WiFi指纹经过归一化处理后形成WiFi图像，与Laplace拉普拉斯分解图像按照1:15的权重进行融合。为了使WiFi图像与Laplace拉普拉斯分解图像能够按照对应像素一一融合，融合时WiFi图像与Laplace拉普拉斯分解图像大小与通道数一致，最后形成融合图像；离线阶段，在每个参考点上采集WiFi接收信号强度，将其归一化后，通过线性映射方法形成WiFi图像；移动终端所拍摄图像经归一化后通过拉普拉斯金字塔分解为拉普拉斯图像，再将其与WiFi图像进行融合，形成训练数据库；利用卷积神经网络进行回归学习，得到位置估计模型。在线阶段首先根据粗定位结果选择位置估计模型，将融合后的图像代入位置估计模型，即可得到移动终端目标位置，实现精定位。精定位阶段：本实例中共包含49个固定路由器，且手机始终保持相同的方向进行拍摄，将采集得到的WiFi信号利用线性映射的方式渲染为图像，手机图像经拉普拉斯金字塔分解后，变为Laplace拉普拉斯分解图像。本实施例中，设置所述的金字塔层数为3层，Laplace拉普拉斯分解图像取其最后一层输出图像，将WiFi图像和Laplace拉普拉斯分解图像进行基于像素级的图像融合，最后将所得到的图像放入CNN回归模型中进行训练。在本专利所述方法中，CNN回归模型共有卷积层4层，池化层3层，采用的激活函数为线性整流函数，最终平均定位精度达到1.5米。如图4所示，左上方图像为手机相机拍摄图像，经过对其进行拉普拉斯金字塔分解，得到Laplace拉普拉斯分解图像；WiFi指纹经过归一化处理后形成WiFi图像，与之前得到的Laplace拉普拉斯分解图像按照一定的权重进行融合，在融合时需要保证两张图图像大小与通道数一致，最后形成融合图像。对于本领域技术人员而言，显然本发明不限于上述示范性实施例的细节，而且在不背离本发明的精神和基本特征的情况下，能够以其他的具体形式实现本发明。因此，无论从哪一点来看，均应将实施例看作是示范性的，而且是非限制性的，本发明的范围由所附权利要求而不是上述说明限定，因此旨在将落在权利要求的等同要件的含义和范围内的所有变化囊括在本发明内，不应将权利要求中的任何附图标记视为限制所涉及的权利要求。此外，应当理解，虽然本说明书按照实施方式加以描述，但并非每个实施方式仅包含一个独立的技术方案，说明书的这种叙述方式仅仅是为清楚起见，本领域技术人员应当将说明书作为一个整体，各实施例中的技术方案也可以经适当组合，形成本领域技术人员可以理解的其他实施方式。
