标题title
一种避免空间淤积的公共自行车空间调度优化方法
摘要abst
本发明公开了一种避免空间淤积的公共自行车空间调度优化方法，包括以下处理步骤：获取路网数据；对OSM地图文件进行地图可视化转化；公共自行车通过各单车平台的API接口传输各单车的GPS数据；公共自行车空间淤积检测；当区域将要出现淤积状况，选择公共自行车的调度方案，淤积调度方案采用近邻策略，为公共自行车还车者提供还车推荐路径。本发明更加精准，能够更好的帮助运营商规范各区域的单车数量，维系单车各区域投放量的基本稳定，适于在人口聚集相对密集的地区，提高单车用户的还车率，进而减少公共自行车调度运力支出，减少重点路段的公共自行车淤积，提高道路和区域的交通通行能力。
权利要求书clms
1.一种避免空间淤积的公共自行车空间调度优化方法，其特征在于：包括以下处理步骤：步骤一、获取路网数据，路网数据采用OpenStreetmap的开源地图数据，下载的开源地图数据是OSM地图文件；步骤二、对OSM地图文件进行地图可视化转化；步骤三、公共自行车通过各单车平台的API接口传输各单车的GPS数据；步骤四、公共自行车空间淤积检测，根据时间、空间条件，利用贝叶斯估计模型，结合城市的区域信息，进行公共自行车空间淤积检测；步骤五、当区域将要出现淤积状况，选择公共自行车的调度方案，淤积调度方案采用近邻策略，为公共自行车还车者提供还车推荐路径。2.根据权利要求1所述的避免空间淤积的公共自行车空间调度优化方法，其特征在于：地图可视化转化方法包括等距投影、兰勃脱投影、Mercator投影、极投影。3.根据权利要求2所述的避免空间淤积的公共自行车空间调度优化方法，其特征在于：各单车数据还包含单车公司名称、单车统一编号、位置时间、经度、纬度、保修号、状态、订单号、数据库存储时间，由各单车平台通过统一的接口，将数据传输到统一的共享自行车管理平台。4.根据权利要求3所述的避免空间淤积的公共自行车空间调度优化方法，其特征在于：公共自行车在固定时间间隔发送GPS信号，通过GPS信号插值，绘制骑行者的骑行路径，根据骑行者的骑行轨迹、方向预测、时间序列，贝叶斯模型估计骑行者的归还区域，通过计算归还区域的势能函数，判断归还区域是否会存在区域淤积。5.根据权利要求4所述的避免空间淤积的公共自行车空间调度优化方法，其特征在于：使用时间序列分析检测不同时间段不同区域的公共自行车时空分布数据，结合公共自行车的需求量、归还量、保有量，计算不同时段各区域的需求量、归还量、保有量的势能函数，势能函数代表不同区域公共自行车的需求量、归还量和保有量受到区域淤积阈值的约束，通过势能函数平衡不同区域的公共自行车调度算法，通过势能函数的最优化完成不同区域的公共自行车调度。6.根据权利要求5所述的避免空间淤积的公共自行车空间调度优化方法，其特征在于：空间淤积检测支持管理部门输入针对热点区域设定的淤积管理时间段、区域范围的限制条件，当指定区域、时间段的公共自行车容积接近淤积状态，发布公共自行车区域淤积信息。7.根据权利要求6所述的避免空间淤积的公共自行车空间调度优化方法，其特征在于：公共自行车在某个时间段的需求量d与人群数量p、时间段t呈单调递增函数，如式2、式3所示：d＝f式2p＝ region∈City式3式中，longitude表示经度，latitude表示纬度，region表示城市的区域；region∈City表示区域属于城市；公共自行车在某个时间端的归还量g与该区域的人群数量p、时段t的关系，如式4、式5所示：g＝f式4p＝ region∈City式5在该时间段内的公共自行车保有量h＝初始公共自行车保有量-出行量+归还量，如式6所示：h＝h-f+g式6在城市的所有区域的某个时段的总需求量为D，是所有区域的需求量d的总和，如式7所示：i表示区域的编号，N表示区域的数量；在城市的所有区域的某个时段的总归还量为G，是所有区域的需求量g的总和，如式8所示：在城市的所有区域的t时段的总保有量h等于上一时段的保有量h减去上一个时间段t的需求量f，加上t时段的归还量g的总和；如式9所示：各区域的借车量函数通过定义借车势能函数、还车势能函数，其中借车势能函数urental是区域租车需求量与选择Modelrental的卷积，借车势能函数与区域、时间有关；还车势能函数ureturn是区域还车的需求量与选择Modelreturn的卷积，还车势能函数与区域、时间有关，如式10、11所示：urental＝d·Modelrental 式10ureturn＝g·Modelreturn 式11Modelrental为借车模型，Modelrental的建立根据公共自行车的租-还车特征，构建不同人群对于公共自行车租车的转移矩阵，即出行者租借公共自行车的概率转移矩阵；Modelreturn为还车模型，Modelreturn的建立根据公共自行车的租-还车特征，构建不同人群对于公共自行车还车的转移矩阵，即出行者归还公共自行车的概率转移矩阵。8.根据权利要求7所述的避免空间淤积的公共自行车空间调度优化方法，其特征在于：借车模型与还车模型采用贝叶斯估计模型，贝叶斯估计将后验概率推导先验概率及似然函数的结果；贝叶斯推断根据贝叶斯定理计算后验概率，如式12所示：其中，H表示假说；E表示证据；P表示先验概率，是观察到证据E之前，假说H的机率；P表示后验概率，是在给定证据E之后，假说H的机率；P是假定H成立时，观察到E的机率；P为边缘似然率。
说明书desc
技术领域本发明涉及一种方法，尤其涉及一种避免空间淤积的公共自行车空间调度优化方法。背景技术对于经常使用城市公交、地铁的上班族，从公交站、地铁站到工作地点的最后一公里是早晚出勤时间最为紧张的路程。公共自行车通过支付少量费用满足市民的出现需求，大幅度地提高了城市交通的效率。公共自行车分为有桩位、无桩位两种类型，其中有桩位的公共自行车由于租还车地点固定，租车用户如果遇到还车车桩已满的情况，需要到邻近的车桩还车，不容易出现公共自行车的淤积状况。对于无桩位的公共自行车由于租还车的位置不固定，如果用户集中在城市的某些区域还车，就会出现自行车的淤积现象。对于城市交通管理部门的车辆管理提出了严重的挑战，在短时间内运送淤积的公共自行车也需要大量的运力。无桩的公共自行车使用方便快捷，用户下载不同的单车平台APP，或者直接使用小程序扫码即可使用这些公共自行车，归还时只需闭锁即可实现还车。在使用完毕后，公共自行车平台根据用户使用的时长进行付费。目前，在各大城市，无桩位公共自行车被大量投放，由于无桩位公共自行车可以在城市的任意区域借还，骑行者从自身的需求出发任意停放，以及一些骑行者使用自行车的不规范，造成大量的公共自行车在公交站、地铁口、景区出现淤积，给行人出行、交通管理造成了很多不便，同时运送淤积公共自行车也给城市管理者带来了巨大的挑战，造成大量的人力、财力的浪费。公共自行车在出行高峰时段，常在某些区域出现“无车可借，无桩可还”的现象，但是在另一些区域则出现“还大于借，车辆淤积”的现象，如图1所示。由此，为缓解高峰时段借还车困难、车辆淤积的问题，亟需提供一种避免空间淤积的公共自行车空间调度优化方法。发明内容为了解决上述技术所存在的不足之处，本发明提供了一种避免空间淤积的公共自行车空间调度优化方法。为了解决以上技术问题，本发明采用的技术方案是：一种避免空间淤积的公共自行车空间调度优化方法，包括以下处理步骤：步骤一、获取路网数据，路网数据采用OpenStreetmap的开源地图数据，下载的开源地图数据是OSM地图文件；步骤二、对OSM地图文件进行地图可视化转化；步骤三、公共自行车通过各单车平台的API接口传输各单车的GPS数据；步骤四、公共自行车空间淤积检测，根据时间、空间条件，利用贝叶斯估计模型，结合城市的区域信息，进行公共自行车空间淤积检测；步骤五、当区域将要出现淤积状况，选择公共自行车的调度方案，淤积调度方案采用近邻策略，为公共自行车还车者提供还车推荐路径。进一步地，地图可视化转化方法包括等距投影、兰勃脱投影、Mercator投影、极投影。进一步地，各单车数据还包含单车公司名称、单车统一编号、位置时间、经度、纬度、保修号、状态、订单号、数据库存储时间，由各单车平台通过统一的接口，将数据传输到统一的共享自行车管理平台。进一步地，公共自行车在固定时间间隔发送GPS信号，通过GPS信号插值，绘制骑行者的骑行路径，根据骑行者的骑行轨迹、方向预测、时间序列，贝叶斯模型估计骑行者的归还区域，通过计算归还区域的势能函数，判断归还区域是否会存在区域淤积。进一步地，使用时间序列分析检测不同时间段不同区域的公共自行车时空分布数据，结合公共自行车的需求量、归还量、保有量，计算不同时段各区域的需求量、归还量、保有量的势能函数，势能函数代表不同区域公共自行车的需求量、归还量和保有量受到区域淤积阈值的约束，通过势能函数平衡不同区域的公共自行车调度算法，通过势能函数的最优化完成不同区域的公共自行车调度。进一步地，空间淤积检测支持管理部门输入针对热点区域设定的淤积管理时间段、区域范围的限制条件，当指定区域、时间段的公共自行车容积接近淤积状态，发布公共自行车区域淤积信息。进一步地，公共自行车在某个时间段的需求量d与人群数量p、时间段t呈单调递增函数，如式2、式3所示：d＝f 式2p＝ region∈City 式3式中，longitude表示经度，latitude表示纬度，region表示城市的区域；region∈City表示区域属于城市；公共自行车在某个时间端的归还量g与该区域的人群数量p、时段t的关系，如式4、式5所示：g＝f式4p＝ region∈City式5在该时间段内的公共自行车保有量h＝初始公共自行车保有量-出行量+归还量，如式6所示：h＝h-f+g 式6在城市的所有区域的某个时段的总需求量为D，是所有区域的需求量d的总和，如式7所示：i表示区域的编号，N表示区域的数量；在城市的所有区域的某个时段的总归还量为G，是所有区域的需求量g的总和，如式8所示：在城市的所有区域的t时段的总保有量h等于上一时段的保有量h减去上一个时间段t的需求量f，加上t时段的归还量g的总和；如式9所示：各区域的借车量函数通过定义借车势能函数、还车势能函数，其中借车势能函数urental是区域租车需求量与选择Modelrental的卷积，借车势能函数与区域、时间有关；还车势能函数ureturn是区域还车的需求量与选择Modelreturn的卷积，还车势能函数与区域、时间有关，如式10、11所示：urental＝d·Modelrental式10ureturn＝g·Modelreturn 式11Modelrental为借车模型，Modelrental的建立根据公共自行车的租-还车特征，构建不同人群对于公共自行车租车的转移矩阵，即出行者租借公共自行车的概率转移矩阵；Modelreturn为还车模型，Modelreturn的建立根据公共自行车的租-还车特征，构建不同人群对于公共自行车还车的转移矩阵，即出行者归还公共自行车的概率转移矩阵。进一步地，借车模型与还车模型采用贝叶斯估计模型，贝叶斯估计将后验概率推导先验概率及似然函数的结果；贝叶斯推断根据贝叶斯定理计算后验概率，如式12所示：其中，H表示假说；E表示证据；P表示先验概率，是观察到证据E之前，假说H的机率；P表示后验概率，是在给定证据E之后，假说H的机率；P是假定H成立时，观察到E的机率；P为边缘似然率。本发明公开了一种避免空间淤积的公共自行车空间调度优化方法，能根据当前城市公共自行车管路的需求展开预测，通过结合公共自行车的动态调度方法完善区域淤积检测、调度方案技术。与现有的公共自行车调度方法相比，本发明所公开的避免空间淤积的公共自行车空间调度优化方法更加精准，能够更好的帮助运营商规范各区域的单车数量，维系单车各区域投放量的基本稳定，适于在人口聚集相对密集的地区，提高单车用户的还车率，由于单车的需求受到交通时段的影响，本发明的避免淤积的检测方法采用时变模型，能够适应城市不同区域单车需求，减少区域公共自行车的需求矛盾，提高公共自行车的利用率，进而减少公共自行车调度运力支出，减少重点路段的公共自行车淤积，提高道路和区域的交通通行能力。附图说明图1为公共自行车淤积示意图。图2为本发明OpenStreetmap的地图下载方式示意图。图3为本发明等距投影方式示意图。图4为本发明兰勃脱投影示意图。图5为本发明墨卡托投影示意图。图6为本发明极投影示意图。图7为本发明将地图转化为路网数据的示意图。图8为本发明公共自行车租车者骑行路径示意图。图9为本发明公共自行车停车热点示意图。图10为本发明公共自行车租还时间序列示意图。图11为本发明公共自行车全市的还车热点示意图。图12为本发明公共自行车还车路径推荐图。具体实施方式下面结合附图和具体实施方式对本发明作进一步详细的说明。为缓解高峰时段借还车困难、车辆淤积的问题，本发明提出了一种避免空间淤积的公共自行车空间调度优化方法，通过时间序列分析方法挖掘城市公共自行车的空间淤积特征，通过分析城市热点区域的公共自行车使用量数据，分析城市热点区域的自行车淤积特征，通过时间序列的长期变化、季节性周期变化、循环变化、随机性变化等特征分析，同时结合城市区域的空间地理信息对还车区域淤积状态进行检测，为了预防发生淤积发生之后，仍有较多的还车者在淤积区域内归还自行车，利用贝叶斯模型对还车区域进行估计，其中时间信息、空间信息是贝叶斯估计的条件概率，将不同区域自行车保有量、归还量统一用势能函数进行定义，通过平衡势能函数，对还车者的还车路径进行调度推荐，同时还车者自主将单车归还到非淤积区域，减少单车区域淤积的发生。公共自行车的时间序列可以分析公共自行车的租车信息、还车信息与时间之间的确定关系，通常有单调递增趋势或者单调递减趋势。时间序列中包括长期变化趋势，短期变化趋势等，其中长期变化趋势一般是以月、年为时间单位的宏观数据，一般使用的方法是移动平均法、指数平滑法、模型拟合法等。公共自行车的区域淤积不仅有长期变化趋势特征，同时也具有季节性周期变化趋势，如冬季和夏季的公共自行车的使用量以及使用规律会存在不同，通常会出现季节性的差异，在一些法定节假日，一些旅游景点会出现突发性的公共自行车淤积。综合分析，公共自行车在城市区域内出现的淤积状况，呈现出长期变化趋势、季节性周期变化趋势、随机性变化趋势和循环变化趋势，十分符合时间序列分析理论的各种特征和条件。基于此，本发明基于时间序列分析进行公共自行车空间淤积检测，通过时间序列分析不同区域的公共自行车淤积情况，通过阈值检测区域内的公共自行车是否达到淤积的阈值，进而避免热点区域淤积现象的发生，为全社会营造良好的公共自行车使用环境，公共自行车在城市区域的淤积不仅存在时间的相关性，同时在空间上也存在空间相关性，公共自行车的淤积区域与周边范围内的流动人口也存在高度的相关性，即不同区域会呈现不同的出行需求和归还需求，为解决淤积问题提供了一种很好的思路。本发明所公开的避免空间淤积的公共自行车空间调度优化方法，基本流程包括以下步骤：步骤一、获取路网数据，路网数据采用OpenStreetmap的开源地图数据，下载的开源地图数据是OSM地图文件；步骤二、对OSM地图文件进行地图可视化转化；步骤三、公共自行车通过各单车平台的API接口传输各单车的数据；步骤四、公共自行车空间淤积检测，根据时间、空间条件，利用贝叶斯估计模型，结合城市的区域信息，进行公共自行车空间淤积检测；步骤五、当区域将要出现淤积状况，选择公共自行车的调度方案，淤积调度方案采用近邻策略，为公共自行车还车者提供还车推荐路径。公共自行车用户在使用单车时，服务器端能够动态检测到公共自行车的经纬度信息，后端的服务器能够根据公共自行车骑行者的当前GPS信息，结合城市不同区域道路淤积的变化趋势时间序列分析，动态改变公共自行车区域淤积检测，并利用贝叶斯估计时间序列，结合自行车保有量、归还量的势能函数，利用动态调度算法对区域淤积的公共自行车进行调度。城市的地图采用OpenStreetMap的开源地图数据，通过等距投影、兰勃脱投影、Mercator投影、极投影等方式进行可视化转化；例如，通过墨卡托投影获取球面地图的投影平面地图，显示城市地图，由于墨卡托投影是将球面投影到圆柱面上，在高纬度区域，投影的地图面积会有明显的形变，也就是越靠近两极，投影的面积会增大。对于低纬度区域，尤其是靠近赤道的区域，投影面积的形变可以忽略。当用户通过App租借公共自行车之后，公共自行车或App会定时发送自行车或骑行者的GPS信号，骑行者的GPS信号一般会受到各种干扰源的干扰，会出现信号的漂移偏差。为了更加精准地处理信号的漂移偏差，需要将出现偏差的GPS信号过滤掉，并将GPS信号投影到地图上的道路或者建筑热点。当骑行者在租借点向归还点的骑行过程中，根据时间序列模型，后端服务器可以实时获取城市不同区域的自行车淤积情况。时间序列模型通过对数据的训练，可以得到城市不同区域地点的公共自行车区域淤积的时间序列模型。城市公共自行车区域淤积检测。对于城市管理部门，节假日景点的公共自行车的无序摆放造成的区域淤积甚至造成景点路段的交通瘫痪。如在节假日，杭州在西湖景区断桥、苏堤南口、雷峰塔等多个景点旁的道路上，大量不同品牌的公共自行车无序停放，挡住人行通道，与众多游客交织，显得异常拥挤。因此公共自行车区域淤积检测需要支持城市管理部门的定点、定时的管理条例。如管理部门需要能够输入需要限制的区域，范围、时段等条件，骑行者在租车之后，可以根据服务器端的公共自行车淤积信息，调整公共自行车的还车区域。下面结合附图对本发明所公开的避免空间淤积的公共自行车空间调度优化方法做进一步详细介绍。交通路网处理，公共自行车的空间淤积检测首先需要获取城市街道网络的路网数据，常见的路网数据包括省、市、县边界、河流、湖泊边界、城市建筑、兴趣点、多边形等。路网数据可以采用OpenStreetmap的开源地图数据，如图2所示，通过OpenStreetmap的API获取开源地图数据，其下载的地图数据是OSM地图文件，属于开源数据，可自由下载。OpenStreetMap包含空间数据以及属性数据，其中空间数据有点、路和联系；下载OpenStreetMap地图文件可以根据选择区域的经纬度区域进行下载，OSM地图由用户根据手持GPS设备、航空摄影照片、其他自由内容甚至单靠本地知识绘制。OSM文件是创造一个内容自由且能让所有人编辑的开源地图；OpenStreetmap的地图图像及矢量数据都是以Open Database License授权。OSM矢量地图的下载即可以通过手工下载，即通过在OpenStreetMap手工区域的左上角、右下角的经纬度。为了能够准确地表示公共自行车空间位置，地图文件通常需要将球面数据转化为平面数据，由此，对OSM地图文件数据进行交换，通过等距投影、兰勃脱投影、Mercator投影、极投影等四种方式进行地图可视化的转化；其中，如图3所示，等距投影，沿某一特定方向之距离，投影之后保持不变，即沿该特定方向长度之比等于1。在实际应用中多把经线绘成直线，并保持沿经线方向距离相等，面积和角度有些变形，多用于绘制交通图。通常是在沿经线方向上等距离，此时投影后经纬线正交。如图4所示，兰勃脱投影，兰勃脱投影适合中纬度大范围绘制，比如绘制中国地图、东亚形势、西北太平洋等。如图5所示，墨卡托投影，墨卡托投影适合显示低纬度赤道附近区域的地图，Mercator投影是最常见的地图投影方式。如图6所示，极投影方式采用极坐标系绘制地图，适合显示高纬度的气象状况，下图是使用极投影方式显示北极区域地图。以上四种投影方式适合不同的场景，默认等距投影适合单独省份或者地级市的绘制，在默认投影方式中，由于空间区域的范围较小，投影的变形基本可以忽略；Mercator投影是最常见的地图投影，适合显示低纬度靠近赤道地区的地图；对于以上两种投影方式，由于对于小尺度的区域失真度较小，较为适用于于城镇、乡镇等小区域范围；同时为便于用户的观察，OSM地图数据可以通过本地服务器提供地图服务。根据城市的路网数据，可以提取城市路网的距离、方向、经纬度等地理信息。在路网数据的基础上估算缺失的速度并计算图边行驶时间，同时能够简化和纠正网络的拓扑结构，以清理节点和合并交叉口，将点、路线或轨迹与最近的图边或节点快速进行地图匹配，为了便于对路网数据的处理，可以将路网的OSM文件格式转化为shapefiles、GraphML等路网文件格式。转化后的路网文件如图7所示，其中蓝色点表示路网的起始节点，灰色表示道路。X轴的刻度是等距的，Y轴方向越靠近两极变形越大。假设墨卡托投影的坐标系原点为，X轴为赤道，Y轴则在经度为λ0处垂直于赤道，墨卡托投影公式即为式1所示：x＝λ-λ0式1其中λ为经度，φ为维度；墨卡托投影将球面投影到圆柱面上，在X轴是等距投影，在Y轴靠近两极的形变越明显。下载的地图数据包括路网的节点、路径等道路属性特征，其中节点与地图的经纬度关联，路径通常是有多条线路构成，通过分析路径可以获取路网的长度、方向等属性。路网地图可以进行拓扑和空间分析，计算几十种指标计算并显示街道的方位和方向，计算并显示最短路径路线，使距离、旅行时间、海拔高度等最小化，将街道网络可视化为静态地图或交互式网络地图，用等值线图和等值线图将旅行距离和旅行时间可视化，绘制街道网络和建筑地图。在路网数据的基础上，结合公共自行车的起点-终点的经纬度，绘制公共自行车的路径，对于有固定桩位的公共自行车，只有租车、还车的地点。地点位置可以通过转化为经纬度信息，为租车和还车地点估计骑行者的路径；对于无固定桩位的公共自行车在固定时间间隔发送GPS信号，通过GPS信号插值，绘制骑行者的骑行路径，根据骑行者的骑行轨迹、方向预测、时间序列，贝叶斯模型估计骑行者的归还区域，通过计算归还区域的势能函数，判断归还区域是否会存在区域淤积，如果出现区域淤积，则会推荐骑行者到非淤积区域，并为骑行者推荐骑行路径。可以使用时间序列分析检测不同时间段不同区域的公共自行车时空分布数据，结合公共自行车的需求量、归还量、保有量，计算不同时段各区域的需求量、归还量、保有量的势能函数，势能函数代表不同区域公共自行车的需求量、归还量和保有量受到区域淤积阈值的约束，通过势能函数平衡不同区域的公共自行车调度算法，通过势能函数的最优化完成不同区域的公共自行车调度。该方法包括城市地图分析、地图定位模块以及中央处理器，所述用户终端用于用户取用单车操作并与中央处理器相连，向中央处理器发送或接受来自中央处理器的信息；所述地图定位模块利用GPS定位系统定位单车现有标地并判断单车起始标地与现有标地之间的距离远近；所述中央处理器包括有奖励制定模块、判断模块与信息存储模块，其中，奖励制定模块用于系统预设奖励规则、奖励领取方式、奖励领取时间；判断模块用于判断用户单车骑行是否达到预设奖励条件；信息存储模块用于系统存储单车起始标地信息及起始标地单车投放数量信息。如前所述，公共自行车在城市淤积的区域不仅存在时间相关性，同时在空间上也存在空间相关性，公共自行车的淤积区域与周边范围内的流动人口也存在高度相关性，即不同区域会呈现不同的出行需求和归还需求，具体有：公共自行车在某个时间段的需求量d与该区域的人群数量p有关，同时与时间段t的关系是：区域人群数量越高，则该区域的公共自行车的需求越大，当处于出行高峰时段，公共自行车的需求量d可以看成是单调递增函数，如式2、式3所示：d＝f式2p＝ region∈City 式3式中，longitude表示经度，latitude表示纬度，region表示城市的区域；region∈City表示区域属于城市；公共自行车在某个时间端的归还量g与该区域的人群数量p有关，同时也与时段t有关，如式4、式5所示：g＝f式4p＝ region∈City 式5在该时间段内的公共自行车保有量＝初始公共自行车保有量-出行量+归还量，如式6所示：h＝h-f+g式6在城市的所有区域的某个时段的总需求量为D，是所有区域的需求量d的总和，如式7所示：i表示区域的编号，N表示区域的数量；在城市的所有区域的某个时段的总归还量为G，是所有区域的需求量g的总和，如式8所示：在城市的所有区域的t时段的总保有量h等于上一时段的保有量h减去上一个时间段t的需求量f，加上t时段的归还量g的总和；如式9所示：不同区域的公共自行车的租车量、还车量、以及当前时段的保有量存在差异，同时不同区域的公共自行车潜在租车用户量也存在差异，不同区域的公共自行车潜在还车用户量也不同，当还车地点集中到某些核心的区域时，则会出现严重的公共自行车淤积现象。各区域的借车量函数通过定义借车势能函数、还车势能函数，其中借车势能函数urental是区域租车需求量与选择Modelrental的卷积，借车势能函数与区域、时间有关；还车势能函数ureturn是区域还车的需求量与选择Modelreturn的卷积，还车势能函数与区域、时间有关。urental＝d·Modelrental式10ureturn＝g·Modelreturn 式11Modelrental和Modelreturn模型首先通过历史数据构建不同起始点-终点的OD表，通过OD表构建不同租车点-还车点构成的骑行路径，如图8所示。Modelrental的建立可以根据公共自行车的租-还车特征，构建不同人群对于公共自行车租车的转移矩阵，即出行者租借公共自行车的概率转移矩阵。Modelreturn的建立可以根据公共自行车的租-还车特征，构建不同人群对于公共自行车还车的转移矩阵，即出行者归还公共自行车的概率转移矩阵。不同区域直接的转移矩阵可以构建OD，即不同租车骑行者在不同区域之间的起始—终点表。为了能够更加微观的表示租车、还车的动力学特征，借车势能在时刻t时刻通过OD转移矩阵表示转化为不同起始点—终点的借车动能，同时还车势能在时刻t时刻通过OD转移矩阵可以转化为不同起始点-终点的还车动能。城市公共自行车淤积点检测，当骑行者在完成租借之后，归还自行车。对于使用固定桩位的自行车，自行车由于受到桩位数的影响，如果某个租车点还车数超过桩位，就无法归还自行车，骑行者需要到附近的其他租借点归还直行车，一般不会出现公共自行车的淤积。然而，对于无桩位的公共自行车，由于无固定的租车和还车地点，可以在道路指定位置随借随还，容易出现公共自行车的淤积，通过设定动态的时间帧，对于交通早晚高峰时段，可以缩短公共自行车淤积检测的时间帧长度，对于交通低峰时段，延长公共自行车淤积检测的时间帧长度，当某区域的公共自行车超过阈值，即出现公共自行车的区域淤积。自行车淤积是建立在公共自行车热点检测基础上，图9通过检测公共自行车的GPS信息，通过热度图估计在区域内的公共自行车数量，当停留的数量超过区域内能够停靠的最大阈值时，即判断某区域出现公共自行车淤积，全市范围的公共自行车淤积检测如图10所示。其中，借车模型与还车模型采用贝叶斯估计模型，贝叶斯估计将后验概率推导先验概率及似然函数的结果；贝叶斯推断根据贝叶斯定理计算后验概率，如式12所示：其中，1)P表示将某事件成立作为条件表示假定B成立的A)。2)H表示假说，其机率可能会受实验数据影响；一般来说会有许多互相矛盾的假说，任务是要确认哪一个假说可能性最高。3)E表示证据。证据对应新的数据，也就是还没用来计算先验概率的数据。4)P表示先验概率，是观察到数据E之前，假说H的机率。5)P表示后验概率，是在给定证据E之后，假说H的机率，是希望求得的资讯，也就是在有目前证据时，假说H的机率。6)P是假定H成立时，观察到E的机率。在H不变时，这是E的函数，也是似然函数，指出在给定假设下假说和证据的相容程度。似然函数是证据E的函数，而后验概率是假说H的函数。7)P有时会称为边缘似然率。此系数对所有可能的假说都是定值，因此在判断不同假说的相对机率时，不会用到这个系数中。针对不同的H数值，只有P和P会影响P的数值，假设检验的后验概率和其先验概率和新产生的似然率乘积成正比。贝叶斯估计最关键的点是可以利用贝斯定理结合新的证据及以前的先验机率，来得到新的概率。贝叶斯估计使用迭代算法通过观察一些证据后得到的后验概率可以当作新的先验概率，再根据新的证据得到新的后验概率。以宁波市海曙区公共自车为例，通过对宁波市公共自行车的使用频率进行统计，宁波市海曙区公共自行车在6点之后出现一个使用高峰，在中午12点、17点出现公共自行车租还的高峰时段。凌晨12点至5点时段城市居民处于睡眠阶段，公共自行车的租还量处于低位，海曙区每个公共自行车站点的小时租还量低于10辆/小时，从早上6点开始，公共自行车的租还量显著上升，在早上7点出现第一次的高峰，在下午的17点出现第二次的高峰。在出行高峰时段，常在某些区域出现“无车可借，无桩可还”的现象，但是在另一些区域则出现“还大于借，车辆淤积”的现象，如图11所示。租车者在骑行过程中根据骑行的方向、骑行者现在所处的位置估计骑行者还车的位置。当骑行者的可能归还区域出现公共自行车淤积现象，为骑行者分配更好的归还区域和归还路径。其中归还区域的估计结合时间序列分析估计不同时间段的公共自行车的归还区域的概率分布，根据概率分布估计骑行者可能的归还区域概率，并为骑行者提供优化后还车路径和区域，如图12所示。由于城市区域的公共自行车的骑行规律与通勤、购物和运行等多种租借目标相关，选定一天内租借量最少时段的各区域的公共自行车的保有量作为租车势能函数、还车势能函数的初始状态，基于区域淤积检测的调度算法即平衡各区域的自行车保有量、归还量与初始状态的差异，在减少各区域淤积的前提下，通过势能变化最小作为优化目标，平衡不同区域的公共自行车保有量、归还量等各项指标，其中最优化调度方案通过为骑行者提供最短路径算法平衡不同区域的公共自行车的借车、还车势能。对于本发明所公开的一种避免空间淤积的公共自行车空间调度优化方法具有以下功能：1)通过服务器端对公共自行车进行时空状态检测，通过定义租车、还车的势能函数，通过对势能函数的优化完成空间调度优化；2)在空间区域淤积检测中，将时间序列分析与城市管理规定相结合，对于旅游景区、城市中心地段，可以支持在服务器端设定公共自行车区域最大的容纳阈值，当旅游景点、热点区域淤积的车辆超过容纳阈值，服务器端给租车者推荐非淤积区域作为租车者还车的位置。3)推荐还车点通过贝叶斯模型对租车者、还车者历史数据的学习，估计出使用者的还车区域。可结合公共自行车的位置﹑交通的时段设定以及骑行者的当前的骑行状况来判断单车骑行者具体状态，具体应用有：【实施例一】城市管理部门的淤积区域限行管理，根据城市公共自行车管理办法规定条例，输入时间、输入地点，设置限制停车的区域、时间段、设定最大停车量阈值，以上信息输入服务器的数据库。当骑行者在规定时间段进入公共自行车限制停车区域，结合时间序列模型和公共自行车限制条例，选择合适的公共自行车归还区域，防止公共自行车局部区域淤积发生。【实施例二】公共自行车租车用户使用App租借单车，租车用户在骑行过程发现还车区域已经出现局部区域出现淤积，骑行者动态调整还车区域，服务器端动态推荐骑行者的公共自行车的归还区域，并给出对应的归还路径。上述实施方式并非是对本发明的限制，本发明也并不仅限于上述举例，本技术领域的技术人员在本发明的技术方案范围内所做出的变化、改型、添加或替换，也均属于本发明的保护范围。
