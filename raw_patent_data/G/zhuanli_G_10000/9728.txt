标题title
一种高效晶体展胞方法及其系统
摘要abst
本发明提供一种高效晶体展胞方法及其系统，包括：基本信息提取：读取并解析晶体结构文件，获取晶体的非对称单元信息和晶胞信息：分析非对称单元中的每个分子，提取分子的相关信息；映射关系构建：以分子标签作为key，将提取的分子基本信息作为value，构建hash表，作为每个分子的基本配置信息，构建分子与其基本信息间的映射关系；晶体展胞：获取晶胞的基矢a、b、c、基矢夹角α、基矢夹角β、基矢夹角γ以及对称操作，将非对称单元中各分子的标签和原子坐标在三维空间中进行复制和计算，形成单胞；将单胞在三维空间中进行有序规则排列堆积，形成超胞。本发明提高计算模拟效率，加速新材料及晶体结构的研发，同时降低计算成本。
权利要求书clms
1.一种高效晶体展胞方法，其特征在于，包括如下几个步骤：基本信息提取：读取并解析晶体结构文件，获取晶体的非对称单元信息和晶胞信息：分析非对称单元中的每个分子，提取分子的相关信息；映射关系构建：以非对称单元中分子的原子为节点，与该原子键连的其它原子为节点的边，构建分子中各原子的拓扑关系，并以该拓扑关系构建成一个长字符串，将该长字符串哈希为一个固定程度的字符串，作为该分子的唯一标签；以分子标签作为key，将提取的分子基本信息作为value，构建hash表，作为每个分子的基本配置信息进行存储，构建分子与其基本信息间的映射关系；晶体展胞：获取晶胞的基矢a、基矢b、基矢c、基矢夹角α、基矢夹角β、基矢夹角γ以及对称操作，将非对称单元中各分子的标签和原子坐标在三维空间中进行复制和计算，形成单胞；再根据晶胞基矢、基矢夹角和在三维空间中的展胞倍数，将单胞在空间中进行有序规则排列堆积，形成超胞，在展胞过程中仅涉及分子标签的复制和原子坐标的计算，通过分子标签与配置信息即可获取超胞中每个分子的基本信息。2.如权利要求1所述的高效晶体展胞方法，其特征在于，所述基本信息提取中，采用MD5或SHA哈希算法将该长字符串哈希为一个固定程度的字符串。3.如权利要求1所述的高效晶体展胞方法，其特征在于，所述映射关系构建中，分子的相关信息为原子序号、原子符号、原子间的成键信息和原子坐标中的至少一种。4.如权利要求1所述的高效晶体展胞方法，其特征在于，所述解析晶体结构文件包括如下步骤：根据文件内容获取晶胞信息和非对称单元信息，晶胞信息包括晶胞的对称操作、基矢、基矢夹角和空间群号其中至少一种；非对称单元信息主要是非对称单元的一个或多个分子信息，至少包括分子的原子坐标和原子符号。5.如权利要求1所述的高效晶体展胞方法，其特征在于，分子中各原子的拓扑关系的构建方法包括：根据所述原子符号和原子坐标，计算得出原子间的成键关系以及非对称单元的分子个数；以原子为节点，与该原子的键连的其它原子为节点的边，构成拓扑关系。6.如权利要求1所述的高效晶体展胞方法，其特征在于，原子坐标的计算过程：根据晶胞的基矢和基矢夹角获取3x3晶格矩阵，原子坐标与该矩阵相乘，得到三维空间中分子的原子坐标。7.一种高效晶体展胞系统，其特征在于，包括：信息提取模块：读取并解析晶体结构文件，获取晶体的非对称单元信息和晶胞信息：分析非对称单元中的每个分子，提取分子的相关信息；映射关系构建模块：以非对称单元中分子的原子为节点，与该原子键连的其它原子为节点的边，构建分子中各原子的拓扑关系，并以该拓扑关系构建成一个长字符串，将该长字符串哈希为一个固定程度的字符串，作为该分子的唯一标签；以分子标签作为key，将提取的分子基本信息作为value，构建hash表，作为每个分子的基本配置信息进行存储，构建分子与其基本信息间的映射关系；晶体展胞模块：获取晶胞的基矢a、基矢b、基矢c、基矢夹角α、基矢夹角β、基矢夹角γ以及对称操作，将非对称单元中各分子的标签和原子坐标在三维空间中进行复制和计算，形成单胞；再根据晶胞基矢、基矢夹角和在三维空间中的展胞倍数，将单胞在空间中进行有序规则排列堆积，形成超胞，在展胞过程中仅涉及分子标签的复制和原子坐标的计算，通过分子标签与配置信息即可获取超胞中每个分子的基本信息。8.如权利要求7所述的高效晶体展胞系统，其特征在于，所述解析晶体结构文件包括如下步骤：根据文件内容获取晶胞信息和非对称单元信息，晶胞信息包括晶胞的对称操作、基矢、基矢夹角和空间群号其中至少一种；非对称单元信息主要是非对称单元的一个或多个分子信息，至少包括分子的原子坐标和原子符号。9.如权利要求7所述的高效晶体展胞系统，其特征在于，分子中各原子的拓扑关系的构建方法包括：根据所述原子符号和原子坐标，计算得出原子间的成键关系以及非对称单元的分子个数；以原子为节点，与该原子的键连的其它原子为节点的边，构成拓扑关系。10.如权利要求7所述的高效晶体展胞系统，其特征在于，原子坐标的计算过程：根据晶胞的基矢和基矢夹角获取3x3晶格矩阵，原子坐标与该矩阵相乘，得到三维空间中分子的原子坐标。
说明书desc
技术领域本发明属于晶体结构的计算模拟领域，涉及一种高效晶体展胞方法及其系统。背景技术随着计算机技术的发展，晶体材料的计算模拟技术也得到快速发展，计算机模拟在新材料及其晶体结构的研发中发挥着越来越重要的作用。在微观上，晶体是由原子、离子或分子按一定方式在三维空间中周期性排列而成。在通过计算机模拟技术对晶体进行比对、分析和性质计算时，往往需要对晶体结构进行展胞。传统的晶体展胞方法是将由一个或多个分子组成的非对称单元在空间中按晶体的对称操作进行复制，形成“单胞”；并以“单胞”为基本单元，在三维空间中进行有序规则排列堆积，形成“超胞”。传统的展胞方法是将非对称单元的全部要素在空间中进行复制，可以轻松获得超胞，但这种复制方法存在大量数据的重复拷贝和计算，如对仅有一个分子组成的单胞进行3x3x3展胞时，仅分子的每个原子符号就重复拷贝了27次；这种展胞方法消耗了计算模拟过程中计算机的大量存储资源和计算资源，展胞效率低，成本高。当进行大量晶体计算模拟时，晶体数量往往可达几百万甚至上千万，当对这些结构进行展胞时，普通的计算资源将难以满足。因此，亟需一种高效的晶体展胞方法，以提高晶体展胞效率，节省计算资源，降低计算成本。发明内容为了满足大量的晶体结构研发和计算模拟任务，降低研发和计算成本，本发明提供一种高效展胞方法：一种高效晶体展胞方法，包括如下几个步骤：基本信息提取：读取并解析晶体结构文件，获取晶体的非对称单元信息和晶胞信息：分析非对称单元中的每个分子，提取分子的相关信息；映射关系构建：以非对称单元中分子的原子为节点，与该原子键连的其它原子为节点的边，构建分子中各原子的拓扑关系，并以该拓扑关系构建成一个长字符串，将该长字符串哈希为一个固定程度的字符串，作为该分子的唯一标签；以分子标签作为key，将提取的分子基本信息作为value，构建hash表，作为每个分子的基本配置信息进行存储，构建分子与其基本信息间的映射关系；晶体展胞：获取晶胞的基矢a、基矢b、基矢c、基矢夹角α、基矢夹角β、基矢夹角γ以及对称操作，将非对称单元中各分子的标签和原子坐标在三维空间中进行复制和计算，形成单胞；再根据晶胞基矢、基矢夹角和在三维空间中的展胞倍数，将单胞进行有序规则排列堆积，形成超胞，在展胞过程中仅涉及分子标签的复制和原子坐标的计算，通过分子标签与配置信息即可获取超胞中每个分子的基本信息。优选的，所述基本信息提取中，采用MD5或SHA哈希算法将该长字符串哈希为一个固定程度的字符串。优选的，所述映射关系构建中，分子的相关信息为原子序号、原子符号、原子间的成键信息和原子坐标中的至少一种。优选的，所述解析晶体结构文件包括如下步骤：根据文件内容获取晶胞信息和非对称单元信息，晶胞信息包括晶胞的对称操作、基矢、基矢夹角和空间群号其中至少一种；非对称单元信息主要是非对称单元的一个或多个分子信息，至少包括分子的原子坐标和原子符号。优选的，分子中各原子的拓扑关系的构建方法包括：根据所述原子符号和原子坐标，计算得出原子间的成键关系以及非对称单元的分子个数；以原子为节点，与该原子的键连的其它原子为节点的边，构成拓扑关系。优选的，原子坐标的计算过程：根据晶胞的基矢和基矢夹角获取3x3晶格矩阵，原子坐标与该矩阵相乘，得到三维空间中分子的原子坐标。相应的，本发明提供一种高效晶体展胞系统，包括：信息提取模块：读取并解析晶体结构文件，获取晶体的非对称单元信息和晶胞信息：分析非对称单元中的每个分子，提取分子的相关信息；映射关系构建模块：以非对称单元中分子的原子为节点，与该原子键连的其它原子为节点的边，构建分子中各原子的拓扑关系，并以该拓扑关系构建成一个长字符串，将该长字符串哈希为一个固定程度的字符串，作为该分子的唯一标签；以分子标签作为key，将提取的分子基本信息作为value，构建hash表，作为每个分子的基本配置信息进行存储，构建分子与其基本信息间的映射关系；晶体展胞模块：获取晶胞的基矢a、基矢b、基矢c、基矢夹角α、基矢夹角β、基矢夹角γ以及对称操作，将非对称单元中各分子的标签和原子坐标在三维空间中进行复制和计算，形成单胞；再根据晶胞基矢、基矢夹角和在三维空间中的展胞倍数，将单胞进行有序规则排列堆积，形成超胞。本发明中的方法与系统在整个晶胞堆积过程中，只涉及到分子标签的拷贝和原子坐标的计算及存储，极大地降低了重复数据的拷贝和计算，可对大批量的晶体结构进行快速高效展胞。本发明通过分子标签与配置信息间的映射关系，可以快速获得超胞中每个分子的基本信息，用于后续的晶体比对、分析和性质计算等晶体研发。高效晶体展胞方法及系统通过对晶体结构的高效展胞，提高计算模拟效率，加速新材料及晶体结构的研发，同时降低计算成本。附图说明图1为本发明一实施例的高效晶体展胞方法的流程图。具体实施方式实施例1如图1所示，高效晶体展胞方法的流程图：1）信息提取读取并解析晶体结构文件，获取晶体的非对称单元信息和晶胞信息。分析非对称单元中的每个分子，提取分子的相关信息，如原子序号、原子符号、原子间的成键信息、原子坐标等。解析晶体文件就是获取和解析文件内容，根据文件内容获取晶胞信息和非对称单元信息，晶胞信息包括晶胞的对称操作、基矢和基矢夹角、空间群号等；非对称单元信息主要是非对称单元的一个或多个分子信息，主要包括分子的原子坐标和原子符号等。不同格式的晶体文件会有不同的描述，但基本都可以获取到这些信息。2）构建分子与其基本信息的映射关系分析非对称单元信息，根据原子符号和原子坐标，利用一些方法：如经验法，计算原子间的距离与经验值的判断得出原子间的成键关系，根据原子间的成键关系即可获得非对称单元中分子的个数及分子对应的原子信息，如原子序号、符号和坐标等。以非对称单元中分子的原子为节点，与该原子键连的其它原子为节点的边，构建分子中各原子的拓扑关系，并以该拓扑关系构建成一个长字符串，利用MD5或SHA哈希算法将该长字符串哈希为一个固定程度的字符串，作为该分子的唯一标签。其中，MD5和SHA均是广泛使用的密码散列函数，MD5算法由美国密码学家罗纳德·李维斯特设计，会产生一个128位长度的散列值，而SHA是散列函数族，由美国国家安全局所设计，以SHA-256为例，会产生一个256位长度的散列值。以分子标签作为key，将提取的分子基本信息，如原子序号、原子符号、原子间的成键信息等作为value，构建hash表，作为每个分子的基本配置信息进行存储，构建分子与其基本信息间的映射关系。3）展胞获取晶胞基矢、基矢夹角以及对称操作，将非对称单元中各分子的标签和原子坐标在三维空间中进行复制和计算，形成单胞；此时单胞中仅存储了各分子的标签以及所有原子的绝对坐标；分子的其它信息均存储在配置信息中。各分子的标签在展胞时是从单胞获取分子标签，而单胞中的分子标签是由非对称单元中的分子标签复制而来，存储是指计算机在计算过程中的存储，可以存储在计算机内存或磁盘中。其中，分子标签的复制过程相当于计算机中的拷贝；而原子坐标的计算过程：根据晶胞的基矢和基矢夹角获得3x3晶格矩阵，非对称单元中分子的原子坐标与晶格矩阵相乘，得到三维空间中分子的原子坐标；再根据对称操作，可获得单胞中分子的原子坐标；展胞时，因为晶体在空间中是周期性规则排布的，单胞是最小重复单元，得到单胞后，展胞就是单胞在空间中规则堆积的过程，由晶格矩阵和展胞方向及倍数获得变换矩阵，单胞中分子的原子坐标与该变换矩阵相乘，即可获得超胞中分子的原子坐标。上述计算得到的原子坐标为绝对坐标，绝对坐标是指其在三维空间中的真实坐标，如；而在有些晶体文件中解析出来的坐标是简坐标，简坐标是根据基矢和基矢夹角进行归一化后的坐标，如。以上述单胞为基本单元，根据晶胞基矢和基矢夹角，以及在三维空间中的展胞方向和倍数，将单胞进行有序规则排列堆积，形成超胞。实施例2以简单的C2H4.cif文件为例，文件内容如下：data_Untitled_symmetry_space_group_name_H-M 'P 1'_symmetry_Int_Tables_number 1_cell_length_a 5.00000000_cell_length_b 3.00000000_cell_length_c 3.00000000_cell_angle_alpha 80.00000000_cell_angle_beta 90.00000000_cell_angle_gamma 100.00000000loop__space_group_symop_operation_xyzx,y,zloop__atom_site_label_atom_site_type_symbol_atom_site_fract_x_atom_site_fract_y_atom_site_fract_z_atom_site_occupancyC1 C -0.12874162 0.00734782 -0.05805230 1.0000C2 C 0.12872635 -0.00735653 0.05810097 1.0000H3 H -0.25339225 -0.28875499 -0.14914626 1.0000H4 H -0.20964748 0.31538587 -0.06008413 1.0000H5 H 0.20963851 -0.31533396 0.05979416 1.0000H6 H 0.25358329 0.28880691 0.14885629 1.0000结合实施例1及如图1中的流程图；获取晶胞信息：空间群号：1对称操作：基矢：a：5，b：3，c：3基矢夹角：α：80，β：90，γ：100非对称单元信息：原子序号：原子坐标：,0.12872635 -0.00735653 0.05810097],-0.25339225 -0.28875499 -0.14914626],-0.20964748 0.31538587 -0.06008413],0.20963851 -0.31533396 0.05979416],0.25358329 0.28880691 0.14885629]]原子符号：原子键连关系：, , , , ]相连的原子可形成一个分子，根据键连关系即可识别非对称单元包含的分子数量，以原子为节点，与该原子键连的其它原子为边，构建不同分子对应的拓扑关系，如：C1与C2、H3、H4成键连关系，C2与C1、H5、H6成键连关系，构成C2H4分子的拓扑关系：C1-C2-H3-H4-H5-H6，利用MD5算法生成一个16字节的字符串“875b5d2ac04df4512035128f79440220”构成该分子的分子标签，并构建分子标签与其原子符号、坐标等的映射关系，得到基本配置信息：{“875b5d2ac04df4512035128f79440220”: {“index”:,“atom_symbol”: , “bonds”: , ...],“coords”: , ...], ...}}根据非对称单元信息和晶胞的对称操作信息，该案例仅一个对称操作，即单胞仅包含一个非对称单元，而非对称单元仅一个分子，因此单胞中仅有一个分子；对该分子的分子标签进行复制，原子坐标与基矢和基矢夹角构成的晶格矩阵相乘，得到原子的绝对坐标，获得单胞中分子在空间中的实际坐标和分子标签：{“sig”: “875b5d2ac04df4512035128f79440220”,“coords”: ,,,,,]}根据超胞倍数，将单胞在空间中进行有序堆积，如将C2H4超胞2x2x2，得到如下超胞的分子信息：,,,,,],“supercell_index”: 0},{“sig”: “875b5d2ac04df4512035128f79440220”,“coords”: ,,,,,],“supercell_index”: 1},...]通过超胞中的分子标签即可在配置信息中找到分子对应的原子信息，如原子序号、符号等；用于后续的晶体比对或性质计算等任务。实施例3以CH3OH.cif 为例，文件内容如下：_symmetry_space_group_name_H-M 'P 2_1 2_1 2_1'_symmetry_Int_Tables_number 19_cell_length_a 4.64690000_cell_length_b 4.92850000_cell_length_c 9.04030000_cell_angle_alpha90.00000000_cell_angle_beta 90.00000000_cell_angle_gamma90.00000000loop__space_group_symop_operation_xyz-x+1/2,-y,z+1/2-x,y+1/2,-z+1/2x+1/2,-y+1/2,-zx,y,zloop__atom_site_label_atom_site_type_symbol_atom_site_fract_x_atom_site_fract_y_atom_site_fract_z_atom_site_occupancyO1O 0.272632970.321981880.952737571.0000H1H 0.433487210.313888770.994887861.0000C2C 0.247669810.572305970.877207031.0000H2A H 0.257953640.721705130.948583361.0000H2B H 0.062782570.579096270.825136311.0000H2C H 0.404903600.589561560.805555771.0000同样解析晶体文件，获得晶胞信息和非对称单元信息，与C2H4不同的是，CH3OH的空间群号为19，有4个对称操作，分别为，，，；非对称单元仍为一个分子；这样在单胞中就有4个分子，同样展胞2x2x2，会产生32个分子。实施例4以下边这个晶体文件为例：data_Untitled_symmetry_cell_setting triclinic_symmetry_space_group_name_H-M 'P -1'_symmetry_Int_Tables_number2_space_group_name_Hall '-P 1'loop__symmetry_equiv_pos_site_id_symmetry_equiv_pos_as_xyz1 x,y,z2 -x,-y,-z_cell_length_a 11.026_cell_length_b 10.870_cell_length_c 10.130_cell_angle_alpha77.723_cell_angle_beta 76.987_cell_angle_gamma110.674_cell_volume 1048.4loop__atom_site_label_atom_site_type_symbol_atom_site_fract_x_atom_site_fract_y_atom_site_fract_zH_00 N 0.358 0.89 0.191C_01 C 0.22 0.797 0.191C_02 C 0.197 0.812 0.06C_03 C 0.123 0.7 0.32C_04 C -0.004 0.614 0.316C_05 C 0.07 0.724 0.058C_06 C -0.03 0.626 0.185H_07 H -0.085 0.537 0.412H_08 H 0.146 0.694 0.419H_09 H 0.277 0.887 -0.038H_0a H 0.05 0.731 -0.043H_0b C -0.169 0.532 0.188H_00 N 0.642 0.11 0.809C_01 C 0.78 0.203 0.809C_02 C 0.803 0.188 0.94C_03 C 0.877 0.3 0.68......晶胞信息中空间群号为2，含两个对称操作，分别为和；在非对称单元信息中，根据键连关系可获得非对称单元包含3个分子；在获得单胞时，单胞中有6个分子，同样做2x2x2展胞，获得的超胞中包含48个分子。以上述依据本申请的理想实施例为启示，通过上述的说明内容，相关工作人员完全可以在不偏离本项申请技术思想的范围内，进行多样的变更以及修改。本项申请的技术性范围并不局限于说明书上的内容，必须要根据权利要求范围来确定其技术性范围。
