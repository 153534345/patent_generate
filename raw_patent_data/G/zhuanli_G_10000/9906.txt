标题title
基于视频微运动放大的脉搏视频脉搏提取方法及系统
摘要abst
本发明涉及一种基于视频微运动放大的脉搏视频脉搏提取方法，包括以下步骤：步骤S1:获取人体手腕部视频信号；步骤S2:将采集到的视频信号通过EVM‑FRR算法进行微小动作放大处理;步骤S3:提取放大后视频信号红绿蓝通道的一维时间序列，并依次进行标准化处理；步骤S4:将标准化处理后的时间序列经过独立成分分析分解为三个独立成分，选取理想成分；步骤S5:根据得到的理想成分，通过自动寻谷算法寻找信号各个周期的波谷位置，并根据波谷位置将原始信号进行单周期分解;步骤S6:将分解后的单周期信号归一化，并通过混合高斯函数进行数据拟合;步骤S7:将拟合的单周期信号再次进行标准化处理，最后再合成,得到一个完整周期的脉搏波信号。本发明实现了对波形信号的非接触式测量。
权利要求书clms
1.一种基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，包括以下步骤：步骤S1：获取人体手腕部视频信号；步骤S2：将采集到的视频信号通过EVM-FRR算法进行微小动作放大处理；步骤S3：提取放大后视频信号红绿蓝通道的一维时间序列，并依次进行标准化处理；步骤S4：将标准化处理后的时间序列经过独立成分分析分解为三个独立成分，随后选取其中具有最高信噪比的信号作为理想成分；步骤S5：根据得到的理想成分，通过自动寻谷算法寻找信号各个周期的波谷位置，并根据波谷位置将原始信号进行单周期分解；步骤S6：将分解后的单周期信号归一化，并通过混合高斯函数进行数据拟合；步骤S7：将拟合的单周期信号再次进行标准化处理，最后再合成，得到一个完整周期的脉搏波信号。2.根据权利要求1所述的基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，所述人体手腕部视频信号采样频率不小于60fps，每一帧图像的分辨率不低于720p。3.根据权利要求1所述的基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，所述EVM-FRR算法，具体如下：①、将输入的视频信号的每一帧图像分解为HSI颜色空间，分别对每个空间内的视频帧图像做9层拉普拉斯金字塔分解；②、构建IIR数字带通滤波器；③、对于滤波器输出的一维向量各层金字塔做放大处理；④、对HSI各个颜色空间内的金字塔序列做图像重建处理，其中，将S和I颜色空间里的序列乘以一个抗失真因子；⑤、将经放大后的重建图像加上原始帧图像构成输出视频帧图像；⑥、将输出视频的所有帧图像按倒序输入，再做一次滤波及放大处理，即重复步骤①-⑤；⑦、将二次滤波及放大处理后的所有帧图像反转，作为EVM-FRR算法的输出。4.根据权利要求3所述的基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，所述滤波器输出与输入的关系为：滤波器的通带范围为0.5-4Hz，在带边频率处的衰减不大于3dB，在0.5Hz以下以及4Hz以上的衰减不小于20dB；滤波器系数的经验值为：b＝0.1037，b＝0，b＝-0.1037；a＝-1.7689，a＝0.7926；其中，对滤波器当前及过去的输入x与x以及过去的输出y与y均为视频帧图像经拉普拉斯金字塔分解后所组合成的一维序列。5.根据权利要求3所述的基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，所述放大处理具体为：第一层和第九层所乘的放大倍数为0、第二层和第八层乘以放大倍数5、其余各层均乘以放大倍数10。6.根据权利要求1所述的基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，所述序列标准化算法为：式中，xi代表原始各个通道的一维时间序列，ui以及σi分别为相应通道内时间序列的均值和方差。7.根据权利要求1所述的基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，所述独立成分分析分解，具体为：①、将标准化的时间序列X乘以白化矩阵W0，即：Z＝W0X，其中白化矩阵为：此时，经过白化处理后的Z满足：E{ZZT}＝I；②、随机初始化系数矩阵Wp，设置迭代停止准则；③、设置参数矩阵的更新公式为：Wp：＝E{Z*g}-E{g′}Wp其中，g＝tanh；④、计算Y＝Wp*Z为分离后的信号矩阵。8.根据权利要求1所述的基于视频微运动放大的脉搏视频脉搏提取方法，其特征在于，所述步骤S6，具体为：①、确定拟合函数为混合高斯函数，即：②、确定①中混合高斯函数的阶数n；③、计算原始单周期数据点y与拟合数据的最小均方误差，即：④、通过梯度下降法逐步计算当J达到最小时，所得到的最优参数Ai，τi，σi。确定后计算出拟合数据点集合f；、将拟合的单周期信号再次进行标准化处理，最后再合成为一个完整周期的脉搏波信号。9.一种基于视频微运动放大的脉搏视频脉搏提取系统，其特征在于，包括处理器、存储器以及存储在所述存储器上的计算机程序，所述处理器执行所述计算机程序时，具体执行如权利要求1-8任一项所述的脉搏提取方法中的步骤。
说明书desc
技术领域本发明涉及数字图像分析处理领域，具体涉及一种基于视频微运动放大的脉搏视频脉搏提取方法及系统。背景技术脉搏波信号因其包含丰富的生理学信息从而为分析个体的身体健康状况提供了重要的参考依据。在中医学中，脉诊是最具特色的诊断方法之一，医生通过无名指、中指和食指的指尖依次贴附与病人的手腕桡动脉三个被称为寸、关、尺的位置。通过感受桡动脉由于心脏泵血而引起血管体积的变化从而判断病人的身体健康状况。脉诊在我国有几千年的历史，在秦朝之前就有文献记载。然而，传统中医的脉诊也存在以下两点局限性：一是脉诊技巧是需要长时间的训练才能熟练的掌握，传统中医脉诊技巧需要医生花费数年甚至是数十年的临床经验才能熟练掌握。有关脉诊的相关资料也显得晦涩难懂，读者难易在短时间内领会并掌握其中的要义。其次是脉诊结果过度依赖于医生的经验，不同的医生由于各自的临床经验不同在面对同一种病例时可能会得到不同的诊断结论，此时的脉诊结果因其不具有客观性而显得不可靠。为了克服上述传统脉诊的局限性，计算机脉诊期望将计算机辅助诊断运用到传统脉诊中，使得计算机能够代替人类来完成这种复杂的、依赖于大量训练才能掌握的技巧。CPD如传统的模式识别算法步骤类似，包含三个步骤：脉搏数据采集、特征提取以及分类模型诊断。CPD通过各种传感器来获取到脉搏波信号再通过模式识别算法实现疾病的诊断和分类，因此具备更高的客观性以及可靠性。在过去的几十年里，已经有很多研究者展开了CPD的研究。然而，这些研究主要是集中在特征提取以及分类模型诊断两个方面，较少有关于脉搏波信息获取方法的创新型研究。而信号获取对CPD的研究起着决定性作用。因此，研究出一种新的脉搏波信号采集方法是非常有必要的。发明内容有鉴于此，本发明的目的在于提供一种基于视频微运动放大的脉搏视频脉搏提取方法及系统为实现上述目的，本发明采用如下技术方案：一种基于视频微运动放大的脉搏视频脉搏提取方法，包括以下步骤：步骤S1:获取人体手腕部视频信号；步骤S2:将采集到的视频信号通过EVM-FRR算法进行微小动作放大处理；步骤S3:提取放大后视频信号红绿蓝通道的一维时间序列，并依次进行标准化处理；步骤S4:将标准化处理后的时间序列经过独立成分分析分解为三个独立成分，随后选取其中具有最高信噪比的信号作为理想成分；步骤S5:根据得到的理想成分，通过自动寻谷算法寻找信号各个周期的波谷位置，并根据波谷位置将原始信号进行单周期分解；步骤S6:将分解后的单周期信号归一化，并通过混合高斯函数进行数据拟合；步骤S7:将拟合的单周期信号再次进行标准化处理，最后再合成,得到一个完整周期的脉搏波信号。进一步的，所述人体手腕部视频信号采样频率不小于60fps，每一帧图像的分辨率不低于720p。进一步的，所述EVM-FRR算法，具体如下：①、将输入的视频信号的每一帧图像分解为HSI颜色空间，分别对每个空间内的视频帧图像做9层拉普拉斯金字塔分解；②、构建IIR数字带通滤波器；③、对于滤波器输出的一维向量各层金字塔做放大处理；④、对HSI各个颜色空间内的金字塔序列做图像重建处理，其中，将S和I颜色空间里的序列乘以一个抗失真因子；⑤、将经放大后的重建图像加上原始帧图像构成输出视频帧图像；⑥、将输出视频的所有帧图像按倒序输入，再做一次滤波及放大处理，即重复步骤①-⑤；⑦、将二次滤波及放大处理后的所有帧图像反转，作为EVM-FRR算法的输出。进一步的，所述滤波器输出与输入的关系为：滤波器的通带范围为0.5-4Hz，在带边频率处的衰减不大于3dB,在0.5Hz以下以及4Hz以上的衰减不小于20dB；滤波器系数的经验值为：b＝0.1037，b＝0，b＝-0.1037；a＝-1.7689，a＝0.7926：其中，对滤波器当前及过去的输入x与x以及过去的输出y与y均为视频帧图像经拉普拉斯金字塔分解后所组合成的一维序列。进一步的，所述放大处理具体为：第一层和第九层所乘的放大倍数为0、第二层和第八层乘以放大倍数5、其余各层均乘以放大倍数10。进一步的，所述序列标准化算法为：式中，xi代表原始各个通道的一维时间序列，ui以及σi分别为相应通道内时间序列的均值和方差。进一步的，所述独立成分分析分解，具体为：①、将标准化的时间序列X乘以白化矩阵W0，即：Z＝W0X，其中白化矩阵为：此时，经过白化处理后的Z满足：E{ZZT}＝I；②、随机初始化系数矩阵Wp，设置迭代停止准则；③、设置参数矩阵的更新公式为：Wp：＝E{Z*g}-E{g′}Wp其中，g＝tanh；④、计算Y＝Wp*Z为分离后的信号矩阵。进一步的，所述步骤S6，具体为：①、确定拟合函数为混合高斯函数，即：②、确定①中混合高斯函数的阶数n；③、计算原始单周期数据点y与拟合数据的最小均方误差，即：④、通过梯度下降法逐步计算当J达到最小时，所得到的最优参数Ai，τi，σi。确定后计算出拟合数据点集合f；、将拟合的单周期信号再次进行标准化处理，最后再合成为一个完整周期的脉搏波信号。一种基于视频微运动放大的脉搏视频脉象提取系统，包括处理器、存储器以及存储在所述存储器上的计算机程序，所述处理器执行所述计算机程序时，具体执行如权利要求1-8任一项所述的脉象提取方法中的步骤。本发明与现有技术相比具有以下有益效果：本发明实现了非接触式测量且获取信号方便，且改进的欧拉算法提取的脉搏波信号具有更高的信噪比，获取的脉搏信号精度高。附图说明图1是本发明的总流程图；图2是一实施例中EVM-FRR算法示意图；图3是一实施例中原始以及经放大后视频的Y-T切片示意图；图4是一实施例中使用本发明方法提取的一维脉搏波效果图；具体实施方式下面结合附图及实施例对本发明做进一步说明。请参照图1，本发明提供一种基于视频微运动放大的脉搏视频脉搏提取方法通过EVM-FRR算法对所拍摄人体手腕部视频信号进行微小动作放大并滤除噪声信号，再通过盲信号分解算法提取出包含部分噪声的一维时域信号，最后使用混合高斯函数拟合原始波形从而形成最终的脉搏波波形数据。具体步骤如下：、通过高清数字摄像头拍摄人体手腕部视频信号，采样频率不小于60fps，每一帧图像的分辨率不低于720p；、将采集到的视频信号通过EVM-FRR算法进行微小动作放大处理：所述的EVM-FRR算法，其过程如下：①、将输入的视频信号的每一帧图像分解为HSI颜色空间，分别对每个空间内的视频帧图像做9层拉普拉斯金字塔分解；②、构建IIR数字带通滤波器，滤波器输出与输入的关系为：要求：滤波器的通带范围为0.5-4Hz，在带边频率处的衰减不大于3dB，在0.5Hz以下以及4Hz以上的衰减不小于20dB。滤波器系数的经验值为：b＝0.1037，b＝0，b＝-0.1037；a＝-1.7689，a＝0.7926。其中，对滤波器当前及过去的输入x与x以及过去的输出y与y均为视频帧图像经拉普拉斯金字塔分解后所组合成的一维序列；③、对于滤波器输出的一维向量各层金字塔做放大处理：第一层和第九层所乘的放大倍数为0、第二层和第八层乘以放大倍数5、其余各层均乘以放大倍数10；④、对HSI各个颜色空间内的金字塔序列做图像重建处理，其中，将S和I颜色空间里的序列乘以一个抗失真因子0.1；⑤、将经放大后的重建图像加上原始帧图像构成输出视频帧图像；⑥、将输出视频的所有帧图像按倒序输入，再做一次滤波及放大处理，即重复步骤①-⑤；⑦、将二次滤波及放大处理后的所有帧图像反转，作为EVM-FRR算法的输出。、提取放大后视频信号红绿蓝通道的一维时间序列，并依次进行标准化处理，序列标准化算法为：上式中，xi代表原始各个通道的一维时间序列，ui以及σi分别为相应通道内时间序列的均值和方差。、将标准化的时间序列经过独立成分分析分解为三个独立成分，随后选取其中具有最高信噪比的信号作为理想成分；所述的独立成分分析，其过程如下：①、将标准化的时间序列X乘以白化矩阵W0，即：Z＝W0X，其中白化矩阵为：此时，经过白化处理后的Z满足：E{ZZT}＝I。②、随机初始化系数矩阵Wp，设置迭代停止准则Crit＝0.0001。③、设置参数矩阵的更新公式为：Wp：＝E{Z*g}-E{g′}Wp。其中，g＝tanh。④、计算Y＝Wp*Z为分离后的信号矩阵。、选择理想成分后，通过自动寻谷算法寻找信号各个周期的波谷位置，并根据波谷位置将原始信号进行单周期分解；所述的自动寻谷算法，其过程如下：①、确定搜索步长s，其经验值为3，待分割的原始时间序列表示为xi|i＝1～N。②、算法从xs开始，到xN-s结束搜索。每次搜索计算bi＝xt-xt-1|t＝i～i-s+1以及fi＝xt+1-xt|t＝i～i+s-1。③、若②中计算的结果满足对于所有的i，均有：bi＜0且fi＞0，则输出当前位置i。记录搜索所有的位置i得到集合I，并认为I为原始信号的所有波谷位置。、将分解后的单周期信号归一化，并通过混合高斯函数进行数据拟合；所述的混合高斯函数拟合，其过程如下：①、确定拟合函数为混合高斯函数，即：②、确定①中混合高斯函数的阶数n通常为5。③、计算原始单周期数据点y与拟合数据的最小均方误差，即：④、通过梯度下降法逐步计算当J达到最小时，所得到的最优参数Ai，τi，σi。确定后计算出拟合数据点集合f。、将拟合的单周期信号再次进行标准化处理，最后再合成为一个完整周期的脉搏波信号。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。以上所述，仅是本发明的较佳实施例而已，并非是对本发明作其它形式的限制，任何熟悉本专业的技术人员可能利用上述揭示的技术内容加以变更或改型为等同变化的等效实施例。但是凡是未脱离本发明技术方案内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化与改型，仍属于本发明技术方案的保护范围。
