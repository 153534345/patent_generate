标题title
基于对比学习的孪生网络目标跟踪方法
摘要abst
本发明提出了一种基于对比学习的孪生网络目标跟踪方法，其利用表征模块、相似度计算模块、对比监督模块来实现；本方法提取目标模板和搜索图像块的特征表示，进而计算目标模板与搜索图像块中所有候选样本之间的相似度。根据相似度值和真实目标的位置信息，最小化目标候选样本和其他候选样本之间的对比损失，通过反向传播调节网络参数。不同于现有的跟踪方法分配同一人为设定的标签给不同的背景样本和最小化候选样本与人为设定的标签之间的误差，本方法利用样本之间内在相似度关系，促使学习到的跟踪模型不但能够区分不同类别的实例，而且还能够区别同类别不相同的实例。
权利要求书clms
1.一种基于对比学习的孪生网络目标跟踪方法，其特征在于，其利用表征模块、相似度计算模块、对比监督模块来实现；所述的表征模块，通过前向计算提取目标模板和搜索图像块的深度特征，目标模板和搜索图像块的深度特征用于目标模板和搜索图像块中候选样本相似度计算；表征模块通过修改的标准ResNet-50神经网络来实现，其对标准ResNet-50神经网络去掉平均池化层和全连接层，修改conv4_x和conv5_x中的步长为1,同时在最后增加一个卷积层以降低特征通道数，当输入目标模板和搜索图像块时，所述的修改的标准ResNet-50神经网络通过前向计算输入目标模板和搜索图像块的深度特征；所述的相似度计算模块，利用目标模板和搜索图像块的深度特征，计算目标样本与搜索图像块中所有的候选样本之间的相似度，相似度的计算公式为：R＝X*S，其中X是目标模板的深度特征，S是搜索图像块的深度特征，*为卷积操作，R是二维响应图，其中的每个值表示搜索图像块中对应位置候选样本与目标样本的相似度值；所述的对比监督模块，根据相似度计算模块计算得到的相似度值和真实目标位置信息，计算损失函数，产生反馈信息，进而反向传播调节网络参数；对比监督模块利用目标候选样本之间的对比，约束目标候选样本与目标模板的相似度值最大，即使得取最大值，对表征模块的修改的标准ResNet-50神经网络参数进行调节，约束目标候选样本与目标模板的相似度值最大时对应的神经网络参数为最优参数，其中，r+∈R表示目标候选样本与目标模板的相似度值，r-i∈R表示第i个背景候选样本与目标模板的相似度值，τ是超参数；该方法具体步骤包括：在训练阶段，在同一视频序列不同帧图像中分别裁剪目标模板和搜索图像块，搜索图像块包含目标并且搜索图像块的尺寸大于目标模板的尺寸；将目标模板和搜索图像块分别输入对应的表征模块，表征模块提取目标模板和搜索图像块的深度特征；将目标模板和搜索图像块的深度特征输入到相似度计算模块，相似度计算模块计算目标模板和搜索图像块中所有的目标候选样本之间的相似度值；将相似度计算模块计算得到的相似度值和搜索图像块中的真实目标位置信息输入到对比监督模块；对比监督模块选择对应真实目标位置信息的候选样本为目标候选样本，进而计算目标候选样本与其他候选样本之间的对比损失函数；以最小化对比损失函数为目标，计算梯度值，通过反向传播调节网络参数；在推理阶段，以当前帧图像的上一帧图像的目标几何中心为中心，剪裁搜索图像块，根据第一帧图像中的目标位置裁剪目标模板；同时将目标模板和搜索图像块输入表征模块，表征模块产生相应的深度特征；将目标模板和搜索图像块的深度特征输入相似度计算模块；相似度计算模块分别计算目标模板和搜索图像块中的所有候选样本之间的相似度，相似度最大值对应的候选样本即为检测得到的目标，此候选样本所在的位置即为目标的所在位置。2.如权利要求1所述的基于对比学习的孪生网络目标跟踪方法，其特征在于，所述的修改的标准ResNet-50神经网络由conv1、conv2_x、conv3_x、conv4_x、conv5_x和conv6串联而成；conv1包含1个卷积层，表示卷积层的卷积核的长和宽均为7，卷积层的通道数为64；conv2_x由一个池化层和3个拥有卷积层的block串联而成，conv2_x的block由1个卷积层、1个卷积层和1个卷积层串联而成；conv3_x由4个block串联而成，conv3_x的block由1个卷积层、1个卷积层和1个卷积层串联而成；conv4_x由6个block，1个卷积层、1个卷积层和1个卷积层串联而成；conv5_x由3个block，1个卷积层、1个卷积层和1个卷积层串联而成；conv6包含1个卷积层。3.如权利要求1所述的基于对比学习的孪生网络目标跟踪方法，其特征在于，利用两个表征模块分别对目标模板和搜索图像块进行深度特征提取，一个表征模块用来提取目标模板的深度特征，另一个表征模块用来提取搜索图像块的深度特征，这两个表征模块共享网络参数，从而构成孪生网络。
说明书desc
技术领域本发明涉及计算机视觉领域，尤其涉及基于对比学习的孪生网络目标跟踪方法。背景技术目标跟踪是计算机视觉领域中一个关键的课题，是视频分析系统中的重要组成部分。目标跟踪技术广泛应用于自动驾驶、公共安全、人机交互、交通控制、计算机辅助医疗等领域。这些应用的实际效果依赖于其所采用的目标跟踪技术。根据数据集中仅给出的目标位置信息，现有的目标跟踪方法通过分配特定的标签给目标样本，同时分配同一标签给其余的背景样本，构建跟踪模型。例如，现有的跟踪方法把目标样本标记为正类、背景样本标记为负类，把目标跟踪问题建模成二分类问题；还有的跟踪方法设定一个高斯响应分布，把跟踪问题建模成回归问题，回归样本集到一个高斯响应分布，其中目标样本对应高斯响应的波峰。由此可以看出，在现有方法中，不同的背景样本共享同一标签。然而，在实际应用中，背景样本并不都是同类型的，某些背景样本不包含任何物体，某些背景样本可能是与目标相似的干扰物。由于非物体背景样本在背景样本中占比非常大，如果非物体背景样本和与目标相似的背景样本共享同一标签，会导致跟踪器拟合众多非物体背景样本，从而使得学习得到的跟踪器不能很好地区分目标和相似干扰物，影响了目标跟踪效果。在测试时，跟踪器容易混淆目标和与之相似的背景样本，造成跟踪失败。发明内容针对现有的计算机视觉目标跟踪方法中，其对非物体背景样本和与目标相似的背景样本共享同一标签影响目标跟踪效果的问题，本发明借助样本之间内在相似度关系，促使学习到的跟踪模型能够区分不同类别的实例，同时能够区分同类别不相同的实例。为实现上述目的，本发明采取的技术方案为：本发明公开了基于对比学习的孪生网络目标跟踪方法，其利用表征模块、相似度计算模块、对比监督模块来实现。所述的表征模块，通过前向计算提取目标模板和搜索图像块的深度特征，目标模板和搜索图像块的深度特征用于目标模板和搜索图像块中候选样本相似度计算。表征模块通过修改的标准ResNet-50神经网络来实现，其对标准ResNet-50神经网络去掉平均池化层和全连接层，修改conv4_x和conv5_x中的步长为1,同时在最后增加一个卷积层以降低特征通道数，修改的标准ResNet-50神经网络由conv1、conv2_x、conv3_x、conv4_x、conv5_x和conv6串联而成。conv1包含1个卷积层，表示卷积层的卷积核的长和宽均为7，卷积层的通道数为64；conv2_x由一个池化层和3个拥有卷积层的block串联而成，conv2_x的block由1个卷积层、1个卷积层和1个卷积层串联而成；conv3_x由4个block串联而成，conv3_x的block由1个卷积层、1个卷积层和1个卷积层串联而成；conv4_x由6个block，1个卷积层、1个卷积层和1个卷积层串联而成；conv5_x由3个block，1个卷积层、1个卷积层和1个卷积层串联而成；conv6包含1个卷积层。当输入目标模板和搜索图像块时，所述的修改的标准ResNet-50神经网络通过前向计算输入目标模板和搜索图像块的深度特征。所述的相似度计算模块，利用目标模板和搜索图像块的深度特征，计算目标样本与搜索图像块中所有的候选样本之间的相似度，相似度的计算公式为：R＝X*S，其中X是目标模板的深度特征，S是搜索图像块的深度特征，*为卷积操作，R是二维响应图，其中的每个值表示搜索图像块中对应位置候选样本与目标样本的相似度值。所述的对比监督模块，根据相似度计算模块计算得到的相似度值和真实目标位置信息，计算损失函数，产生反馈信息，进而反向传播调节网络参数。对比监督模块利用目标候选样本之间的对比，约束目标候选样本与目标模板的相似度值最大，即使得取最大值，对表征模块的修改的标准ResNet-50神经网络参数进行调节，约束目标候选样本与目标模板的相似度值最大时对应的神经网络参数为最优参数，其中，r+∈R表示目标候选样本与目标模板的相似度值，表示第i个背景候选样本与目标模板的相似度值，τ是超参数。该方法具体步骤包括：在训练阶段，在同一视频序列不同帧图像中分别裁剪目标模板和搜索图像块，搜索图像块包含目标并且搜索图像块的尺寸大于目标模板的尺寸。将目标模板和搜索图像块分别输入对应的表征模块，表征模块提取目标模板和搜索图像块的深度特征。利用两个表征模块分别对目标模板和搜索图像块进行深度特征提取，一个表征模块用来提取目标模板的深度特征，另一个表征模块用来提取搜索图像块的深度特征，这两个表征模块共享网络参数，从而构成孪生网络。将目标模板和搜索图像块的深度特征输入到相似度计算模块，相似度计算模块计算目标模板和搜索图像块中所有的目标候选样本之间的相似度值。将相似度计算模块计算得到的相似度值和搜索图像块中的真实目标位置信息输入到对比监督模块。对比监督模块选择对应真实目标位置信息的候选样本为目标候选样本，进而计算目标候选样本与其他候选样本之间的对比损失函数。以最小化对比损失函数为目标，计算梯度值，通过反向传播调节网络参数。在推理阶段，以当前帧图像的上一帧图像的目标几何中心为中心，剪裁搜索图像块，根据第一帧图像中的目标位置裁剪目标模板。同时将目标模板和搜索图像块输入表征模块，表征模块产生相应的深度特征。将目标模板和搜索图像块的深度特征输入相似度计算模块。相似度计算模块分别计算目标模板和搜索图像块中的所有候选样本之间的相似度，相似度最大值对应的候选样本即为检测得到的目标，此候选样本所在的位置即为目标的所在位置。本发明的有益效果为：本发明不同于现有的跟踪方法人为地分配同一标签给不同的背景样本，本发明不强制分配标签给背景样本。同时，也不同于现有的跟踪方法计算候选样本的预测值和人为分配的标签之间的误差，本发明利用目标候选样本和其他候选样本之间的对比，限制约束目标候选样本应该获得最大的预测值。本方法借助样本之间内在相似度关系，如目标模板和与目标相似的背景样本之间的相似度大于目标和非物体背景之间的相似度、目标模板与目标样本之间的相似度大于目标和与目标相似的背景样本之间的相似度，促使学习到的跟踪模型不但能够区分不同类别的实例，而且还能够区别同类别不相同的实例。附图说明图1是本发明基于对比学习的孪生网络跟踪方法的结构示意图；图2是本发明基于对比学习的孪生网络跟踪方法的流程图。具体实施方式以下结合附图和具体实施案例，对本发明做进一步的详细说明：图1是本发明基于对比学习的孪生网络跟踪方法的结构示意图；图2是本发明基于对比学习的孪生网络跟踪方法的流程图。为了更好的了解本发明内容，这里给出一个实施例。本发明公开了基于对比学习的孪生网络目标跟踪方法，其利用表征模块、相似度计算模块、对比监督模块来实现；所述的表征模块，通过前向计算提取目标模板和搜索图像块的深度特征，目标模板和搜索图像块的深度特征用于目标模板和搜索图像块中候选样本相似度计算。表征模块通过修改的标准ResNet-50神经网络来实现，其对标准ResNet-50神经网络去掉平均池化层和全连接层，修改conv4_x和conv5_x中的步长为1,同时在最后增加一个卷积层以降低特征通道数，修改的标准ResNet-50神经网络由conv1、conv2_x、conv3_x、conv4_x、conv5_x和conv6串联而成。conv1包含1个卷积层，表示卷积层的卷积核的长和宽均为7，卷积层的通道数为64；conv2_x由一个池化层和3个拥有卷积层的block串联而成，conv2_x的block由1个卷积层、1个卷积层和1个卷积层串联而成；conv3_x由4个block串联而成，conv3_x的block由1个卷积层、1个卷积层和1个卷积层串联而成；conv4_x由6个block，1个卷积层、1个卷积层和1个卷积层串联而成；conv5_x由3个block，1个卷积层、1个卷积层和1个卷积层串联而成；conv6包含1个卷积层。当输入目标模板和搜索图像块时，所述的修改的标准ResNet-50神经网络通过前向计算输入目标模板和搜索图像块的深度特征。所述的相似度计算模块，利用目标模板和搜索图像块的深度特征，计算目标样本与搜索图像块中所有的候选样本之间的相似度，相似度的计算公式为：R＝X*S，其中X是目标模板的深度特征，S是搜索图像块的深度特征，*为卷积操作，R是二维响应图，其中的每个值表示搜索图像块中对应位置候选样本与目标样本的相似度值。所述的对比监督模块，根据相似度计算模块计算得到的相似度值和真实目标位置信息，计算损失函数，产生反馈信息，进而反向传播调节网络参数。在此过程中，不同于现有的跟踪方法人为地分配同一标签给搜索图像块中所有的背景样本并最小化标签与预测相似度之间的差，此模块不用人为设定背景候选样本的标签作为监督值。对比监督模块利用目标候选样本之间的对比，约束目标候选样本与目标模板的相似度值最大，即使得取最大值，对表征模块的修改的标准ResNet-50神经网络参数进行调节，约束目标候选样本与目标模板的相似度值最大时对应的神经网络参数为最优参数，其中，r+∈R表示目标候选样本与目标模板的相似度值，表示第i个背景候选样本与目标模板的相似度值，τ是超参数。该方法具体步骤包括：在训练阶段，在同一视频序列不同帧图像中分别裁剪目标模板和搜索图像块，搜索图像块包含目标并且搜索图像块的尺寸大于目标模板的尺寸。将目标模板和搜索图像块分别输入对应的表征模块，表征模块提取目标模板和搜索图像块的深度特征。利用两个表征模块分别对目标模板和搜索图像块进行深度特征提取，一个表征模块用来提取目标模板的深度特征，另一个表征模块用来提取搜索图像块的深度特征，这两个表征模块共享网络参数，从而构成孪生网络。将目标模板和搜索图像块的深度特征输入到相似度计算模块，相似度计算模块计算目标模板和搜索图像块中所有的目标候选样本之间的相似度值。将相似度计算模块计算得到的相似度值和搜索图像块中的真实目标位置信息输入到对比监督模块。对比监督模块选择对应真实目标位置信息的候选样本为目标候选样本，进而计算目标候选样本与其他候选样本之间的对比损失函数。以最小化对比损失函数为目标，计算梯度值，通过反向传播调节网络参数。在推理阶段，以当前帧图像的上一帧图像的目标几何中心为中心，剪裁搜索图像块，根据第一帧图像中的目标位置裁剪目标模板。同时将目标模板和搜索图像块输入表征模块，表征模块产生相应的深度特征。将目标模板和搜索图像块的深度特征输入相似度计算模块。相似度计算模块分别计算目标模板和搜索图像块中的所有候选样本之间的相似度，相似度最大值对应的候选样本即为检测得到的目标，此候选样本所在的位置即为目标的所在位置。以上所述仅为本申请的实施例而已，并不用于限制本申请。对于本领域技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本申请的权利要求范围之内。
