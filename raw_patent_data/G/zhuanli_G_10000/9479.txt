标题title
一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法
摘要abst
本发明涉及水轮机转轮叶片的缺陷检测技术领域，具体公开了一种基于YoloV4‑Lite网络的水轮机转轮叶片缺陷检测方法，包括步骤：S1：基于YoloV4‑Lite网络构建缺陷检测网络；S2：对水轮机转轮叶片的不同缺陷处进行图片采集，得到千张以上缺陷图片；S3：对步骤S2采集的缺陷图片进行预处理，得到数据集；S4：采用所述数据集对所述缺陷检测网络进行训练、测试和验证。本发明将YoloV4‑Lite的主干提取网络CSPDarkNet53网络替换为MobileNet网络，MobileNet网络是一种实时轻量型网络，可以提高检测网络速度，大幅度降低网络参数。实验结果表明，缺陷检测网络可以达到97.48％的准确率，且MobileNetV3的网络参数量只需要37.35MB，比CSPDarkNet53降低了206.94MB，FPS达到44.68，具有高准确率、低内存存储、实时性优势。
权利要求书clms
1.一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于，包括步骤：S1：基于YoloV4-Lite网络构建缺陷检测网络；S2：对水轮机转轮叶片的不同缺陷处进行图片采集，得到千张以上缺陷图片；S3：对步骤S2采集的缺陷图片进行预处理，得到数据集；S4：采用所述数据集对所述缺陷检测网络进行训练、测试和验证。2.根据权利要求1所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于，所述步骤S1具体为：将YoloV4-Lite网络的主干特征提取网络CSPDarkNet53替换为MobileNet网络，将YoloV4-Lite网络的加强特征提取网络PaNet的1x1和3x3的标准卷积替换为深度可分离卷积，构建缺陷检测网络。3.根据权利要求2所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于：替换的MobileNet网络为MobileNetV3网络。4.根据权利要求3所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于：所述缺陷检测网络在254层采用空间金字塔池化网络SPPNet，以进一步提取图片特征；在270层采用上采样层与181层结合，并卷积5次，作为第一个预测层；将69层与299层结合，作为第二个预测层；将268层与392层结合，作为第三个预测层。5.根据权利要求4所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于，所述步骤S3进行图像预处理包括步骤：S31：对步骤S2采集的缺陷图片进行筛选，保留与输入尺寸要求接近的缺陷图片；S32：对步骤S31筛选后的缺陷图片进行标签标注；S33：将步骤S32标注后的缺陷图片修改为VOC数据格式，得到用于输入所述缺陷检测网络的数据集。6.根据权利要求1～5任意一项所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于：所述步骤S4中，对所述缺陷检测网络进行训练的迭代次数为N+M次，其中前N代学习率为0.001，后M代学习率为0.0001。7.根据权利要求6所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于：N＝M＝1000。8.根据权利要求7所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于：步骤S2中采集时针对的缺陷为气蚀和裂纹。9.根据权利要求8所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于，所述步骤S4具体包括步骤：S41：将所述数据集分为训练集、测试集和验证集，所述训练集中包括相同数量的气蚀图像和裂纹图像；S42：采用所述训练集对所述缺陷检测网络进行训练；S43：采用所述测试集对训练后的所述缺陷检测网络进行测试，以及采用所述验证集对训练后的所述缺陷检测网络及用于对比的其他网络模型进行验证。10.根据权利要求9所述的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，其特征在于：所述缺陷检测网络的宽度乘子α＝1.0，分辨率乘子β＝1.0。
说明书desc
技术领域本发明涉及水轮机转轮叶片的缺陷检测技术领域，尤其涉及一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法。背景技术目前，水轮机转轮叶片检测所采用的方法大多是人工检测，但人工检测精度低、成本高、工作风险大。人工检查时，水轮机需要停止运行，每次人工检查需要一周左右的时间，这将带来巨大的经济损失。因此，从传统的人工检测向机器检测转变就显得尤为重要。在机器检测过程中，选择更合适的算法将决定故障检测的准确性。为了解决样本处理过程中分布不均匀的问题，目前有方法利用MC-SMOTE算法将样本划分为不同的聚类，然后进行分类，应用于风电叶片结冰的实际工业生产问题。分类结果表明MC-SMOTE比经典SMOTE具有更高的分类性能。目前还有基于SCADA数据的风电机组故障检测方法，该方法可以提取风电机组系统的故障特征，并将其应用于机组故障检测。结果也证明了该方法具有一定的预测检测能力。目前还有方法通过使用LSTM网络，预测正常运行的风力发电机的时间序列数据。仿真结果表明，该方法能够快速检测出可能的水轮机系统故障。目前还有方法将半监督学习方法应用于风力发电机组的故障检测中，采用NSGA-II方法选择特征参数，采用软标签和二进制支持向量机进行半监督故障检测。同时，该方法可以在系统崩溃之前预测系统故障，从而减少资源消耗。目前还有方法通过采集风力发电机发出的时域信号，并将其转换成二维矩阵，形成二维图像。然后通过图像识别分析图像的纹理特征，并对这些故障进行了分类。结果表明，该方法能够对风力发电机最常见的故障进行分类检测。目前还有方法通过迭代非线性滤波器来消除重噪声，提取弱故障振动特征。以形态分析为基础，将其应用于风力发电机叶片轴承的故障检测。结果表明，该方法优于一些常规的轴承故障诊断方法。目前，由于水轮机尺寸较大，故障数据采集困难，目前没有学者对水轮机转轮叶片表面缺陷检测等相关内容进行研究。发明内容本发明提供一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，解决的技术问题在于：如何对水轮机转轮叶片的表面缺陷进行精准的机器检测。为解决以上技术问题，本发明提供一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，包括步骤：S1：基于YoloV4-Lite网络构建缺陷检测网络；S2：对水轮机转轮叶片的不同缺陷处进行图片采集，得到千张以上缺陷图片；S3：对步骤S2采集的缺陷图片进行预处理，得到数据集；S4：采用所述数据集对所述缺陷检测网络进行训练、测试和验证。进一步地，所述步骤S1具体为：将YoloV4-Lite网络的主干特征提取网络CSPDarkNet53替换为MobileNet网络，将YoloV4-Lite网络的加强特征提取网络PaNet的1x1和3x3的标准卷积替换为深度可分离卷积，构建缺陷检测网络。优选的，替换的MobileNet网络为MobileNetV3网络。进一步地，所述缺陷检测网络在254层采用空间金字塔池化网络SPPNet，以进一步提取图片特征；在270层采用上采样层与181层结合，并卷积5次，作为第一个预测层；将69层与299层结合，作为第二个预测层；将268层与392层结合，作为第三个预测层。进一步地，所述步骤S3进行图像预处理包括步骤：S31：对步骤S2采集的缺陷图片进行筛选，保留与输入尺寸要求接近的缺陷图片；S32：对步骤S31筛选后的缺陷图片进行标签标注；S33：将步骤S32标注后的缺陷图片修改为VOC数据格式，得到用于输入所述缺陷检测网络的数据集。进一步地，所述步骤S4中，对所述缺陷检测网络进行训练的迭代次数为N+M次，其中前N代学习率为0.001，后M代学习率为0.0001。进一步地，N＝M＝1000。进一步地，步骤S2中采集时针对的缺陷为气蚀和裂纹。进一步地，所述步骤S4具体包括步骤：S41：将所述数据集分为训练集、测试集和验证集，所述训练集中包括相同数量的气蚀图像和裂纹图像；S42：采用所述训练集对所述缺陷检测网络进行训练；S43：采用所述测试集对训练后的所述缺陷检测网络进行测试，以及采用所述验证集对训练后的所述缺陷检测网络及用于对比的其他网络模型进行验证。进一步地，所述缺陷检测网络的宽度乘子α＝1.0，分辨率乘子β＝1.0。本发明提供的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，将YoloV4-Lite的主干提取网络CSPDarkNet53网络替换为MobileNet网络，为了进一步减少参数量和运算量，还将加强特征提取网络的1x1和3x3的标准卷积替换为深度可分离卷积，得到缺陷检测网络以应用于大型水轮机转轮叶片主要表面缺陷检测中。MobileNet网络是一种实时轻量型网络，可以提高检测网络速度，大幅度降低网络参数。实验结果表明，缺陷检测网络可以达到97.48％的准确率，且MobileNetV3的网络参数量只需要37.35MB，比CSPDarkNet53降低了206.94MB，FPS达到44.68，具有高准确率、低内存存储、实时性优势。附图说明图1是本发明实施例提供的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法的步骤图；图2是本发明实施例提供的DW卷积和PW卷积的结构图；图3是本发明实施例提供的缺陷检测网络的结构图；图4是本发明实施例提供的气蚀缺陷和裂纹缺陷的照片图；图5是本发明实施例提供的气蚀缺陷和裂纹缺陷的实验结果图。具体实施方式下面结合附图具体阐明本发明的实施方式，实施例的给出仅仅是为了说明目的，并不能理解为对本发明的限定，包括附图仅供参考和说明使用，不构成对本发明专利保护范围的限制，因为在不脱离本发明精神和范围基础上，可以对本发明进行许多改变。为了对水轮机转轮叶片的表面缺陷进行精准的机器检测，本发明实施例提供一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，采用深度学习领域的YoloV4-Lite算法对水轮机转轮叶片的表面缺陷进行检测，并对该算法进行改进。如图1所示，该方法主要包括步骤：S1：基于YoloV4-Lite网络构建缺陷检测网络；S2：对水轮机转轮叶片的不同缺陷处进行图片采集，得到千张以上缺陷图片；S3：对步骤S2采集的缺陷图片进行预处理，得到数据集；S4：采用所述数据集对所述缺陷检测网络进行训练、测试和验证。针对步骤S1，水轮机转轮叶片表面的缺陷，一般通过检测设备或检测机器人检测，这就要求检测网络模型是实时轻量型。目前的实时轻量型YoloV4-Lite网络适用于在便携嵌入式设备中运行的实时轻量化目标检测算法，其主干特征提取网络由CSPDarkNet53构成，其存在Resblock_body模块，其由一次下采样和多次残差结构的堆叠构成，并且使用了CSPnet结构，内存存储需求大，实时性效果差。这是因为YoloV4-Lite网络的主干提取网络采用的是CSPDarkNet53网络，该网络的网络参数量较大，因此会占用较多的内存。本步骤S1具体是：将YoloV4-Lite网络的主干特征提取网络CSPDarkNet53替换为MobileNet网络。MobileNet网络是一种保证准确率的前提下能够提高运行速度的轻量型DCNN网络。相比传统卷积神经网络，准确率有小幅度降低，但网络的参数量和运算量被大幅度降低。MobileNet网络使用Depthwise Convolution和1x1Pointwise Convolution代替传统标准卷积。在传统卷积中，每个卷积核的通道与输入特征矩阵的通道相等，而在DW卷积中，每个卷积核的通道都等于1。如果想改变输出特征矩阵的通道，那只需要在DW卷积后接上一个PW卷积即可，如图2所示。DW卷积和PW卷积一起称作深度可分离卷积。Dk是卷积核的大小，DF是输入特征图，M是输入特征矩阵的通道数，N是输出特征矩阵的通道数，mobileNet网络中DW卷积都是使用3x3大小的卷积核。标准卷积的计算量为：DK×DK×M×N×DF×DF标准卷积的参数量为：DK×DK×M×N 深度可分离卷积的计算量为：DK×DK×M×DF×DF+M×N×DF×DF深度可分离卷积的参数量为：DK×DK×M×N+DK×DK×N将式与式相除：将3x3卷积核代入计算，可得深度可分离卷积的计算量约为标准卷积的1/9。输入图像大小都为416×416×3，输入尺寸为1.98MB时，不考虑Residualarchitecture、Pooling layer、Activation function、BNlayer与FC layer的影响情况下，将CSPDarkNet53和MobileNet的参数量进行对比，如表1所示。表1网络模型参数量为了进一步减少参数量和运算量，本发明还将YoloV4-Lite网络的加强特征提取网络PaNet的1x1和3x3的标准卷积替换为深度可分离卷积，最终基于YoloV4-Lite网络构建了用于检测水轮机转轮叶片表面缺陷的缺陷检测网络，缺陷检测网络的架构如图3所示。表2优化前后网络参数量对比对于步骤S2，由于水轮机在日常运行维护的时间周期较长，一般为一年一次或一年2次，其采集的叶片数据很少，无法支撑深度学习所需的数据集要求，故实施例的数据集是人为在水轮机叶片上制作出缺陷进行拍摄而得。主要检测缺陷目标为气蚀、裂纹，部分缺陷图如图4所示。对于步骤S3，在收集满足网络训练所需的图片过程中，需要对步骤S2采集的缺陷图片进行预处理。具体的，S3包括步骤：S31：对步骤S2采集的缺陷图片进行筛选，保留与输入尺寸要求接近的缺陷图片，从而去除分辨率过大或过小的图片；S32：利用labelImg软件对步骤S31筛选后的缺陷图片进行标签标注；S33：将步骤S32标注后的缺陷图片修改为VOC数据格式，得到用于输入所述缺陷检测网络的数据集。标签标注工作环境是：Windows10；内存8GB；显卡是Nvidia GeForce GTX 1650。最后本实施例处理得到2080张的不同缺陷图片。其中气蚀和裂纹作为训练集，320张作为验证集，160张作为测试集。对于步骤S4，在训练时，按照batch_size批量训练输入到网络中，反向传播更新和保存权重，训练次数达到指定迭代次数停止训练，训练网络中的可调超参数如下表3所示。对所述缺陷检测网络进行训练的迭代次数为N+M次，其中前N代学习率为0.001，后M代学习率为0.0001，这里N＝M＝1000。表3可调超参数其中，MobileNetV3采用深度可分离卷积并使用h-swish激活函数。整个缺陷检测网络在254层采用空间金字塔池化网络SPPNet，以进一步提取图片特征；在270层采用上采样层与181层结合，并卷积5次，作为第一个预测层；将69层与299层结合，作为第二个预测层；将268层与392层结合，作为第三个预测层。最后以2080张的不同缺陷图片作为数据集进行训练、测试和验证。实验网络训练工作环境：Ubuntu；金士顿DDR42666MHz；显卡是Nvidia GeForce GTX 1660 SUPER；Cuda 10.2；cuDNN7.6。本实施例采用AP、F1、mAP、FPS以及参数量去评判一个网络是否适合一个工况。YoloV4-Lite网络选取DarkNet53、CSPDarkNet53、MobileNetV1、MobileNetV2、MobileNetV3作为主干提取网络进行训练，其实验结果如下表4。表4不同主干提取网络2000代训练结果每个网络结构进行了2000代。从表4可以看出，CSPDarkNet53的mAP比DarkNet53高出0.41％，FPS下降了4.53，参数量高达244.29MB，比DarkNet53增加了7.97MB，由此可以看出以CSPDarkNet53为主干特征提取网络是很难满足便携式嵌入式和设备的需求。MobileNetV3与CSPDarkNet53比较，mAP提升了3.27％，网络检测缺陷的准确率得到了提升，FPS达到44.68，一秒内可以处理44张图像，提升了27.74，并且参数量只需要37.35MB，降低了206.94MB。综上所述，MobileNetV3具有更高的准确率，更好的速度，更低的参数量，它的优势能够满足便携式嵌入式和设备的需求，因此YoloV4-Lite选取MobileNetV3作为主干特征提取网络。以MobileNetV3作为主干特征提取网络，进行2000代训练，对lw和QS缺陷识别，实验结果如图5所示，可以快速准确地识别缺陷，lw的识别率最高达到99％，QS可以达到96％。由此可以得出，本实施例的缺陷检测网络可以很好地满足便携设备的实时性和准确性。综上所述，本发明实施例提出的一种基于YoloV4-Lite网络的水轮机转轮叶片缺陷检测方法，将YoloV4-Lite的主干提取网络替换成MobileNetV3，并将其应用到大型水轮机叶轮叶片主要表面缺陷检测中。实验结果表明，缺陷检测网络可以达到97.48％的准确率，且MobileNetV3的参数量比CSPDarkNet53降低了206.94MB，说明本发明提出的缺陷检测网络在水轮机转轮叶片缺陷检测方面具有高检测率、低内存存储、实时性优势。上述实施例为本发明较佳的实施方式，但本发明的实施方式并不受上述实施例的限制，其他的任何未背离本发明的精神实质与原理下所作的改变、修饰、替代、组合、简化，均应为等效的置换方式，都包含在本发明的保护范围之内。
