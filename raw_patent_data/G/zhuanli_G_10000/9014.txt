标题title
一种基于概率慢特征分析和弹性权重巩固的过程监控方法
摘要abst
本发明公开了一种基于概率慢特征分析和弹性权重巩固的过程监控方法，属于工业监测和故障诊断领域，包括：依次采集工业系统正常工况下的过程数据构成训练集；利用概率慢特征分析和弹性权重巩固方法进行训练，计算模型参数和参数的重要性衡量矩阵；构建监测统计量并计算阈值；采集系统实时运行下的数据作为测试样本，利用当前训练模型计算该样本的统计量，判断系统运行状态。本发明利用单模型实现对多工况动态过程的有效监测，具有持续学习能力；可处理噪声和缺失数据，模型可解释性强，算法简单，易于实现，可广泛应用于化工、加工制造、大型火力发电厂等领域。
权利要求书clms
1.一种基于概率慢特征分析和弹性权重巩固的过程监控方法，其特征在于，包括离线训练和在线监测两个阶段；其中，阶段一、离线训练，基于历史工况数据训练PSFA-EWC算法模型；具体步骤如下：S101.采集工业过程中的历史工况MK作为训练数据其中TK为样本数量，m为变量数目；设隐变量p为隐变量数目；S102.计算训练数据的均值和方差，进行归一化处理，预处理后的数据为XK；S103.利用最大期望算法求解PSFA-EWC模型参数，求得参数VK、ΛK＝diag、Σx、Σ1、Σ；其中，λ表示特征值；S104.计算Fisher信息矩阵，更新参数的重要性衡量矩阵；S105.计算监控统计量T2、SPE和S2，用核密度估计方法估计相应的阈值；阶段二、在线监测阶段，基于训练的PSFA-EWC模型进行实时监测；具体步骤如下：S201.实时采集样本x0，对变量进行预处理，标记为x；S202.计算隐变量和预测误差；S203.计算监控统计量T2、SPE和S2；S204.判断系统运行状态：a)若所有统计量小于阈值，系统运行正常，继续用当前模型监控；b)若S2小于阈值，T2或SPE超过阈值，系统可能进入另一个工况；此时，借助专家知识进行进一步确定；当系统进入另一工况，令K＝K+1，采集少量数据进行模型更新；c)若S2大于阈值，系统出现故障，触发报警。2.根据权利要求1所述基于概率慢特征分析和弹性权重巩固的过程监控方法，其特征在于，所述步骤S104中，Fisher信息矩阵的计算公式为：则T为当前工况的训练样本总数；对第K个工况，信息矩阵标记为和参数的重要性衡量矩阵更新方式为：其中和是超参数，衡量当前工况参数的重要性，由先验信息确定。3.根据权利要求2所述基于概率慢特征分析和弹性权重巩固的过程监控方法，其特征在于，所述步骤S105的具体计算过程如下：对t时刻，隐变量计算如下：其中，是卡尔曼增益矩阵；T2统计量的计算公式如下：为了计算SPE统计量，需要隐变量在t时刻的真实值和预测值的偏差；在t-1时刻，推测的慢特征服从高斯分布，即P～N；其中，μt-1和Pt-1均由E步获得；yt的条件分布为相似地，P～N，预测误差为：εt＝xt-VKΛKμt-1～N 当t→∞，Φt→Φ；SPE统计量的计算如下：S2统计量用于反映动态特性的变化，用于区分正常的工况变化和动态特性异常，计算如下：其中，Ξ是的协方差矩阵；利用核密度估计计算3个统计量的阈值，置信水平为0.99。4.根据权利要求1所述基于概率慢特征分析和弹性权重巩固的过程监控方法，其特征在于，所述PSFA-EWC算法模型的具体原理为：工业过程依次出现正常运行工况MK，前一工况MK-1的训练参数为VK-1，ΛK-1＝diag，在新工况MK训练时，需要尽可能减缓VK-1和ΛK-1的变化，这样能实现多个工况的同时监控；对第K个工况，YK是对应的隐变量，单个PSFA模型的目标函数为：其中，θ＝{V，Λ，Σx，Σ1}，变量生成模型为：对PSFA-EWC模型，需要考虑所有工况的损失函数；但前K-1个工况的数据难以获取，引入替代函数逼近前K-1个工况的总损失函数，即其中，衡量变量λK-1，i重要性，是对角矩阵的第i个元素，衡量变量VK-1的重要性；γ1，K和γ2，K是超参数，衡量当前工况的重要性。因此，K个工况的总损失函数为：当K＝1，PSFA-EWC转化为传统的PSFA方法，模型仅对当前工况有效。5.根据权利要求4所述基于概率慢特征分析和弹性权重巩固的过程监控方法，其特征在于，用最大期望算法求解优化问题，包括E步和M步；E步包含基于卡尔曼滤波方法前向递归和基于RTS的后向递归两部分；前向递归用于估计后验分布P～N，θold表示前一时刻的参数值，后验边缘分布为∫NNdyt-1＝N；卡尔曼滤波的参数更新为：初始化参数为I为单位矩阵；后项递归用于估计P的参数，RTS方法主要包括：初始化参数为统计量的计算为：M步：假设统计量是固定的，交替更新模型参数：关于V的导数为0，得求解Sylvester方程，记为Vnew；关于一阶导数为0，得：其中，是Vnew的第i行，对参数Σ1，对参数Λ＝diag，关于λi的一阶导数为0，得其中，方程的系数为求解方程在区间本发明属于工业监测和故障诊断领域，具体涉及一种基于概率慢特征分析和弹性权重巩固的多工况动态过程监控方法。背景技术工业系统中，由于对产品质量、设备老化、原材料更换等因素，系统大多处于多工况动态运行状态。研究其过程监控，对提高系统运行的安全性和可靠性有重要意义。例如，在大型火力发电机组的制粉系统中，为了满足环保要求和经济效益，频繁更换煤的种类，这就导致了系统处于多工况。研究其运行安全性对提高机组安全性和燃烧效率有重大意义。传统多工况过程监测方法往往需要完备的工况数据，在每个工况内建立局部监控模型。通过k-均值、高斯混合模型等方法对工况进行划分，每个工况的局部模型可采用主成分分析、偏最小二乘方法、独立主元分析等。但是上述方法均不能区别系统的正常动态变化和真实异常。慢特征分析方法缓慢变化特征，通过构建监控统计量来区别正常工况变化和真实异常。此外，获取完备的工况数据需要消耗昂贵的资源，且难以实现。因此，亟需一种能够监控多工况动态系统的方法，且不需要完备的工况数据。发明内容为了解决上述问题，本发明提出了一种基于概率慢特征分析和弹性权重巩固的过程监控方法，实现对工业多工况动态过程的在线监控。本发明的技术方案如下：一种基于概率慢特征分析和弹性权重巩固的过程监控方法，简记为PSFA-EWC，包括离线训练和在线监测两个阶段；其中，阶段一、离线训练，基于历史工况数据训练PSFA-EWC算法模型；具体步骤如下：S101.采集工业过程中的历史工况MK作为训练数据其中TK为样本数量，m为变量数目；设隐变量p为隐变量数目；S102.计算训练数据的均值和方差，进行归一化处理，预处理后的数据为XK；S103.利用最大期望算法求解PSFA-EWC模型参数，求得参数VK、ΛK＝diag、Σx、Σ1、Σ；其中，λ表示特征值；S104.计算Fisher信息矩阵，更新参数的重要性衡量矩阵；S105.计算监控统计量T2、SPE和S2，用核密度估计方法估计相应的阈值；阶段二、在线监测阶段，基于训练的PSFA-EWC模型进行实时监测；具体步骤如下：S201.实时采集样本x0，对变量进行预处理，标记为x；S202.计算隐变量和预测误差；S203.计算监控统计量T2、SPE和S2；S204.判断系统运行状态：a)若所有统计量小于阈值，系统运行正常，继续用当前模型监控；b)若S2小于阈值，T2或SPE超过阈值，系统可能进入另一个工况；此时，借助专家知识进行进一步确定；当系统进入另一工况，令K＝K+1，采集少量数据进行模型更新；c)若S2大于阈值，系统出现故障，触发报警。进一步地，步骤S104中，Fisher信息矩阵的计算公式为：则对第K个工况，信息矩阵标记为和参数的重要性衡量矩阵更新方式为：其中和是超参数，衡量当前工况参数的重要性，由先验信息确定。进一步地，步骤S105的具体计算过程如下：对t时刻，隐变量计算如下：其中，是卡尔曼增益矩阵；T2统计量的计算公式如下：为了计算SPE统计量，需要隐变量在t时刻的真实值和预测值的偏差；在t-1时刻，推测的慢特征服从高斯分布，即P～N；其中，μt-1和Pt-1均由E步获得；yt的条件分布为相似地，P～N，预测误差为：εt＝xt-VKΛKμt-1～N当t→∞，Φt→Φ；SPE统计量的计算如下：S2统计量用于反映动态特性的变化，用于区分正常的工况变化和动态特性异常，计算如下：其中，Ξ是的协方差矩阵；利用核密度估计计算3个统计量的阈值，置信水平为0.99。进一步地，PSFA-EWC算法模型的具体原理为：工业过程依次出现正常运行工况MK，前一工况MK-1的训练参数为VK-1，ΛK-1＝diag，在新工况MK训练时，需要尽可能减缓VK-1和ΛK-1的变化，这样能实现多个工况的同时监控；对第K个工况，YK是对应的隐变量，单个PSFA模型的目标函数为：其中，θ＝{V,Λ,Σx,Σ1}，变量生成模型为：对PSFA-EWC模型，需要考虑所有工况的损失函数；但前K-1个工况的数据难以获取，引入替代函数逼近前K-1个工况的总损失函数，即其中，衡量变量重要性，是对角矩阵的第i个元素，衡量变量VK-1的重要性；γ1,K和γ2,K是超参数，衡量当前工况的重要性。因此，K个工况的总损失函数为：当K＝1，PSFA-EWC转化为传统的PSFA方法，模型仅对当前工况有效。进一步地，用最大期望算法求解优化问题，包括E步和M步；E步包含基于卡尔曼滤波方法前向递归和基于RTS的后向递归两部分；前向递归用于估计后验分布P～N，θold表示前一时刻的参数值，后验边缘分布为∫NNdyt-1＝N；卡尔曼滤波的参数更新为：初始化参数为I为单位矩阵；后项递归用于估计P的参数，RTS方法主要包括：初始化参数为统计量的计算为：M步：假设统计量是固定的，交替更新模型参数：关于V的导数为0，得求解Sylvester方程，记为Vnew；关于一阶导数为0，得：其中，是Vnew的第i行，对参数Σ1，对参数Λ＝diag，关于λi的一阶导数为0，得其中，方程的系数为求解方程在区间反复迭代E步和M步，直到目标函数收敛；训练得到的参数记为VK，ΛK，Σx和Σ1，本发明所带来的有益技术效果：本发明方法研究多工况动态系统过程监控，可实现正常工况变化和真实异常的区分；本发明具有良好的模型解释性能，能处理缺失数据和测量噪声；利用单模型实现对多工况动态过程的有效监测，具有持续学习能力，利用EWC方法解决PSFA在多工况应用的“遗忘灾难”问题，能够对短期变化信息实现记忆，具有前向和后向迁移能力，保留已学习工况的重要信息，对未来相关工况建模提供有效信息；区别于传统的多工况监控方法，本发明训练时不需要完备的工况数据，新工况出现时，只需要在当前模型上进行更新，不需要利用所有工况数据进行训练，计算量低，易于计算机实现；模型可解释性强，算法简单，易于实现，可广泛应用于化工、加工制造、大型火力发电厂等领域。附图说明图1为一种基于概率慢特征分析和弹性权重巩固的过程监控方法的流程图；图2为本发明实施例1中工况1的检测结果示意图；图3为本发明实施例1中工况2的检测结果示意图；图4为本发明实施例1中工况3的检测结果示意图。具体实施方式下面结合附图以及具体实施方式对本发明作进一步详细说明：本发明提出了一种基于概率慢特征分析和弹性权重巩固的多工况动态过程监控方法，用以解决多煤种下制粉系统的过程监控问题，首先利用概率慢特征分析方法提取缓慢变化特征，并区别系统的正常变化和真实异常；在工况发生变化时，利用弹性权重巩固方法保留之前工况的信息，对未来相关工况的监控提供有效信息。本发明实质上是基于概率慢特征分析和弹性权重巩固训练得到一种多工况动态过程的监控算法模型，记为PSFA-EWC算法模型；利用该模型进行过程监测。一种基于概率慢特征分析和弹性权重巩固的过程监控方法，包括离线训练和在线监测两个阶段；其中，阶段一、离线训练，基于历史工况数据训练PSFA-EWC算法模型；具体步骤如下：S101.采集工业过程中的历史工况MK作为训练数据其中TK为样本数量，m为变量数目；设隐变量p为隐变量数目；S102.计算训练数据的均值和方差，进行归一化处理，预处理后的数据为XK；S103.利用最大期望算法求解PSFA-EWC模型参数，求得参数VK、ΛK＝diag、Σx、Σ1、Σ；其中，λ表示特征值；S104.计算Fisher信息矩阵，更新参数的重要性衡量矩阵；其中，Fisher信息矩阵的计算公式为：则T是当前工况训练样本总数；对第K个工况，信息矩阵标记为和参数的重要性衡量矩阵更新方式为：其中和是超参数，衡量当前工况参数的重要性，由先验信息确定；S105.计算监控统计量T2、SPE和S2，用核密度估计方法估计相应的阈值；具体计算过程如下：对t时刻，隐变量计算如下：其中，是卡尔曼增益矩阵；T2统计量的计算公式如下：为了计算SPE统计量，需要隐变量在t时刻的真实值和预测值的偏差。在t-1时刻，推测的慢特征服从高斯分布，即P～N；其中，μt-1和Pt-1均由E步获得；yt的条件分布为相似地，P～N，预测误差为：εt＝xt-VKΛKμt-1～N当t→∞，Φt→Φ；SPE统计量的计算如下：S2统计量用于反映动态特性的变化，可用于区分正常的工况变化和动态特性异常，计算如下：其中，Ξ是的协方差矩阵。利用核密度估计来计算3个统计量的阈值，置信水平为0.99。阶段二、在线监测阶段，基于训练的PSFA-EWC模型进行实时监测；具体步骤如下：S201.实时采集样本x0，对变量进行预处理，标记为x；S202.计算隐变量和预测误差；S203.计算监控统计量T2、SPE和S2；S204.判断系统运行状态：a)若所有统计量小于阈值，系统运行正常，继续用当前模型监控；b)若S2小于阈值，T2或SPE超过阈值，系统可能进入另一个工况。此时，借助专家知识进行进一步确定。当系统进入另一工况，令K＝K+1，采集少量数据进行模型更新；c)若S2大于阈值，系统出现故障，触发报警。在监测过程中运用了EWC方法，EWC能够保存以前运行状态的重要信息，避免重要参数的巨大变化，能够解决PSFA方法的“遗忘灾难”问题。对未来相似或相同的运行状态，实现对系统的准确监控。PSFA-EWC算法模型的具体原理为：工业过程依次出现正常运行工况MK，前一工况MK-1的训练参数为VK-1，ΛK-1＝diag，在新工况MK训练时，需要尽可能减缓VK-1和ΛK-1的变化，这样能实现多个工况的同时监控。对第K个工况，YK是对应的隐变量，单个PSFA模型的目标函数为：其中，θ＝{V,Λ,Σx,Σ1}，变量生成模型为：对PSFA-EWC模型，需要考虑所有工况的损失函数。但前K-1个工况的数据难以获取，引入替代函数逼近前K-1个工况的总损失函数，即其中，衡量变量λK-1,i重要性，是对角矩阵的第i个元素，衡量变量VK-1的重要性；γ1,K和γ2,K是超参数，衡量当前工况的重要性。因此，K个工况的总损失函数为：当K＝1，PSFA-EWC转化为传统的PSFA方法，模型仅对当前工况有效。用最大期望算法求解优化问题，包括E步和M步。E步包含基于卡尔曼滤波方法前向递归和基于Ranch-Tung-Striebel的后向递归两部分。前向递归用于估计后验分布P～N，θold表示前一时刻的参数值，后验边缘分布为∫NNdyt-1＝N。卡尔曼滤波的参数更新为：初始化参数为I为单位矩阵。后项递归用于估计P的参数，RTS方法主要包括：初始化参数为统计量的计算为：M步：假设统计量是固定的，交替更新模型参数：关于V的导数为0，可得求解Sylvester方程，记为Vnew。关于一阶导数为0，可得：其中，是Vnew的第i行，对参数Σ1，对参数Λ＝diag，关于λi的一阶导数为0，可得其中，方程的系数为关于求解方程在区间反复迭代E步和M步，直到目标函数收敛。训练得到的参数记为VK，ΛK，Σx和Σ1，实施例1为了更加直观理解本发明的实际效果，本示例研究火力发电厂中制粉系统的过程监测，制粉系统由给煤机、磨煤机、旋转分离器、石子煤室等设备组成。将每个煤种的运行过程看成一种工况，训练数据和测试数据均来自于实际电厂运行过程，采样间隔为1分钟。以制粉系统出口温度异常为例，出口温度过高，容易导致制粉系统爆燃，出口温度过低，会降低燃烧效率。旋转分离器转速影响煤粉细度，煤粉越细，燃烧越充分，但易爆炸。选择9个变量，包括发电机有功功率、瞬时给煤量、一次风温度、出口温度、一次风压力等。三个工况的数据信息如下：工况1：训练样本2520个，测试样本1440个，故障时刻549，故障原因是磨煤机爆燃；工况2：训练样本1080个，测试样本1080个，故障时刻533，故障原因是一次风挡板异常；工况3：训练样本1440个，测试样本864个，故障时刻626，故障原因是一次风泄露。3个工况依次出现，以工况3为例进行说明。此时，已有基于工况1模型和工况2的数据训练的监控模型。工况3出现，在工况3数据和现有模型的基础上更新监控模型，实现对3个工况的同时监控。图2展示了工况1的监控效果，T2、SPE和S2的故障检测率分别为99.89％、99.89％和94.51％，误报率分别为0、0和16.06％。图3展示了工况2的监控效果，T2、SPE和S2的故障检测率分别为98.91％、99.45％和81.02％，误报率分别为0、0和2.82％。图4展示了工况3的监控效果，T2、SPE和S2的故障检测率分别为100％、99.58％和95.40％，误报率分别为0.16％、0.32％和4.80％。本发明方法能够区别真实异常和正常运行状态变化。当然，上述说明并非是对本发明的限制，本发明也并不仅限于上述举例，本技术领域的技术人员在本发明的实质范围内所做出的变化、改型、添加或替换，也应属于本发明的保护范围。
