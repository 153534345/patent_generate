标题title
一种融合容器信息的菜品信息检索方法
摘要abst
本发明公开了一种融合容器信息的菜品信息检索方法。本发明步骤如下：建立容器信息数据库；建立菜品信息数据库；菜品图片定位；容器边缘曲率信息提取；菜品图片特征提取；菜品相似度数值计算；菜品信息检索。本发明在对菜品识别方面，采用对比特征检索的方式，而不是直接分类方式去判别菜品类别，当要判别新的菜品类别的时候，只需要对新菜品采样，并将采样得到特征记录到数据集中。当需要判别类别的时候，使用特征在数据库中进行对比，就可得到结果。当然在判别时候使用特征相似度同时还引入菜品图像的颜色直方图相似度与容器边缘曲率相似度，进一步提高的判别的准确性。
权利要求书clms
1.一种融合容器信息的菜品信息检索方法，其特征在于该方法包括以下步骤：建立容器信息数据库：容器边缘曲率信息、容器图片与容器类别；建立菜品信息数据库：录入每一个菜品图片的特征数据、记录菜品图片的颜色直方图与菜品类别；菜品图片的特征数据使用训练好SENet网络提取；菜品图片定位：对采集的菜品图片使用神经网络进行目标检测和图像边缘信息提取，获得数字图像中全部的菜品位置信息并分割出每一个单独的菜品图片；容器边缘曲率信息提取：通过RCF网络对步骤中每一个获取的菜品图片进行菜品容器边缘提取，随后计算容器边缘曲率；菜品图片特征提取：使用训练好的SENet网络对步骤得到每一个菜品图片进行特征提取，获得2048个维度特征数据。菜品相似度数值计算：从容器信息数据库获取数据与当前待处理的容器信息计算曲率相似度，从菜品信息数据库获取数据与当前待处理的菜品图片之间计算特征数据之间的余弦值和颜色直方图相似度，并对计算得到的余弦值和颜色直方图相似度进行加权求和，以此作为菜品的相似度数值；菜品信息检索：使用加权K近邻分类方法，将步骤计算的全部相似度作为距离，对待分类菜品图片进行分类。2.根据权利要求1所述的融合容器信息的菜品信息检索方法，其特征在于步骤中容器信息数据库具体是：1-1.保证图像显示范围为能完整容器的最小范围；1-2.以图像中心点为参考点，图像正上方向为角度0度方向，顺时针为正向依次记录角度与曲率点对；1-3.容器类别字段：类别唯一，可使用中文、英文与阿拉伯数字；1-4.根据容器类别字段、创建时间与图像的md-256生成数据编号，将图像在指定的路径下保存，保存名称为该数据编号+“.jpg”。3.根据权利要求2所述的融合容器信息的菜品信息检索方法，其特征在于步骤中菜品信息数据库具体是：2-1.保证每个图像中只要一道菜品，同时图像显示范围为能完整的承装菜品容器的最小范围；2-2.使用预先标注好的菜品图片组成训练集，对SENet网络模型进行训练，直至模型收敛；2-3.将菜品图片送入训练好的SENet模型进行特征提取，获取菜品图片的2048维度特征数据并保存；2-4.统计菜品图片的RGB三通道的彩色数值概率直方图；2-5.菜品类别字段：类别唯一，可使用中文、英文与阿拉伯数字；2-6.根据菜品类别字段、创建时间与图像的md-256生成数据编号，并将图像在指定的路径下保存，保存名称为该数据编号+“.jpg”。4.根据权利要求3所述的融合容器信息的菜品信息检索方法，其特征在于步骤菜品图片定位具体是：3-1.使用预先标注的采集图像组成训练集，对容器检测神经网络进行训练，直至模型收敛；3-2.使用3-1训练的模型，在采集的图像上预测容器位置的坐标信息；3-3.使用人工标识的容器边缘图像组成训练集，训练边缘检测网络RCF，直到收敛。使用RCF网络对采集图像获得容器边缘信息；3-4.联合3-2坐标信息与3-3容器边缘信息，获得更高精度的容器坐标信息。3-5.根据3-4的容器坐标信息，分割出只存在每一个单独的菜品图片。5.根据权利要求4所述的融合容器信息的菜品信息检索方法，其特征在于步骤菜品相似度数值计算具体是：6-1.计算曲率相似度计算容器数据库中全部曲率，根据步骤1-2采集容器曲率，匹配时采用按照步长为0.1度的增量，滑动比对数据库与当前容器的曲率数据，记录最小平均欧式距离，对某些曲率缺失的数据点，该数据点不参与计算；6-2.采用向量余弦相似度公式计算菜品数据库中全部特征与待识别菜品图片特征的相似度，具体公式为：其中，＜x，y＞为特征向量x与y的内积值，||x||、||y||分别表示特征向量x和y的欧式距离；6-3.计算颜色直方图相似度，采用Bhattacharyya距离计算，具体公式为：其中，p、q分别表示p和q两个颜色直方图桶的概率；6-4.菜品的相似度数值为6-1、6-2与6-3的加权求和。6.根据权利要求5所述的融合容器信息的菜品信息检索方法，其特征在于步骤菜品信息检索具体是：7-1.根据步骤计算待识别菜品与全部菜品数据库的相似度数值，等到相似度数组与对应菜品的类别标签；7-2.使用Softmax方式对7-1的相似度数组进行加权；7-3.对7-2获得加权的数值，按照类别求和数值，取求和数值最大所对应的类别为带识别菜品图片类别。
说明书desc
技术领域本发明属于图像处理技术领域，涉及深度学习中的目标检测与特征提取与带权K近邻分类，图像直方图相似度和融合容器边缘的曲率信息的菜品信息检索方法。背景技术随着深度学习领域的不断突破，人类社会进入信息智能化时代，传统食堂的运营模式的弊端越发凸显，人工点菜结算不可避免的造成结算错误、结算时间过长等问题。人们开始关注如何更好的利用计算机来自动识别菜品并自动结算。提供服务速度与质量，减少人力成本。目前，主流的方式是使用深度学习的目标检测网络直接获取菜品图像，再使用训练好的网络直接进行菜品分类。这样的方式，存在一些弊端：a.直接使用目标检测网络得到的菜品图像不一定很好的表示菜品信息，可能预测的范围过大，为下一步分类引入了大量噪声；b.可能菜品图像没包含完整的菜品，导致菜品信息缺少，同样为下一步分类带来负面影响。c.分类网络分类结果固定，但需要添加新的菜品时候，需要重新调整网络输出维度，且准备新类别数据重新训练网络，过程繁琐、不稳定。通过研究发现，将菜品与容器绑定，在使用目标检测的预测框与深度学习方式提取容器边缘相结合可以得到精准的菜品图像。发明内容根据上述缺陷描述，本发明提出了一种融合容器信息的菜品信息检索方法；其中应用深度学习中的目标检测与特征提取与带权K近邻分类，图像直方图相似度和融合容器边缘的曲率信息的菜品信息检索方法。为实现以上的目的，本发明是通过以下技术方案来实现的：建立容器信息数据库：容器边缘曲率信息、容器图片与容器类别；建立菜品信息数据库：录入每一个菜品图片的特征数据、记录菜品图片的颜色直方图与菜品类别；菜品图片的特征数据使用训练好SENet网络提取；菜品图片定位：对采集的菜品图片使用神经网络进行目标检测和图像边缘信息提取，获得数字图像中全部的菜品位置信息并分割出每一个单独的菜品图片；容器边缘曲率信息提取：通过RCF网络对步骤中每一个获取的菜品图片进行菜品容器边缘提取，随后计算容器边缘曲率；菜品图片特征提取：使用训练好的SENet网络对步骤得到每一个菜品图片进行特征提取，获得2048个维度特征数据。菜品相似度数值计算：从容器信息数据库获取数据与当前待处理的容器信息计算曲率相似度，从菜品信息数据库获取数据与当前待处理的菜品图片之间计算特征数据之间的余弦值和颜色直方图相似度，并对计算得到的余弦值和颜色直方图相似度进行加权求和，以此作为菜品的相似度数值；菜品信息检索：使用加权K近邻分类方法，将步骤计算的全部相似度作为距离，对待分类菜品图片进行分类。进一步的的，步骤中容器信息数据库具体是：1-1.保证图像显示范围为能完整容器的最小范围；1-2.以图像中心点为参考点，图像正上方向为角度0度方向，顺时针为正向依次记录角度与曲率点对；1-3.容器类别字段：类别唯一，可使用中文、英文与阿拉伯数字；1-4.根据容器类别字段、创建时间与图像的md-256生成数据编号，将图像在指定的路径下保存，保存名称为该数据编号+“.jpg”；进一步的的，步骤中菜品信息数据库具体是：2-1.保证每个图像中只要一道菜品，同时图像显示范围为能完整的承装菜品容器的最小范围；2-2.使用预先标注好的菜品图片组成训练集，对SENet网络模型进行训练，直至模型收敛；2-3.将菜品图片送入训练好的SENet模型进行特征提取，获取菜品图片的2048维度特征数据并保存；2-4.统计菜品图片的RGB三通道的彩色数值概率直方图；2-5.菜品类别字段：类别唯一，可使用中文、英文与阿拉伯数字；2-6.根据菜品类别字段、创建时间与图像的md-256生成数据编号，并将图像在指定的路径下保存，保存名称为该数据编号+“.jpg”。进一步的的，步骤菜品图片定位具体是：3-1.使用预先标注的采集图像组成训练集，对容器检测神经网络进行训练，直至模型收敛；3-2.使用3-1训练的模型，在采集的图像上预测容器位置的坐标信息；3-3.使用人工标识的容器边缘图像组成训练集，训练边缘检测网络RCF，直到收敛。使用RCF网络对采集图像获得容器边缘信息；3-4.联合3-2坐标信息与3-3容器边缘信息，获得更高精度的容器坐标信息。3-5.根据3-4的容器坐标信息，分割出只存在每一个单独的菜品图片。进一步的的，步骤菜品相似度数值计算具体是：6-1.计算曲率相似度计算容器数据库中全部曲率，根据步骤1-2采集容器曲率，匹配时采用按照步长为0.1度的增量，滑动比对数据库与当前容器的曲率数据，记录最小平均欧式距离，对某些曲率缺失的数据点，该数据点不参与计算；6-2.采用向量余弦相似度公式计算菜品数据库中全部特征与待识别菜品图片特征的相似度，具体公式为：其中，＜x,y＞为特征向量x与y的内积值，||x||、||y||分别表示特征向量x和y的欧式距离；6-3.计算颜色直方图相似度，采用Bhattacharyya距离计算，具体公式为：其中，p、q分别表示p和q两个颜色直方图桶的概率；6-4.菜品的相似度数值为6-1、6-2与6-3的加权求和。进一步的的，步骤菜品信息检索具体是：7-1.根据步骤计算待识别菜品与全部菜品数据库的相似度数值，等到相似度数组与对应菜品的类别标签；7-2.使用Softmax方式对7-1的相似度数组进行加权；7-3.对7-2获得加权的数值，按照类别求和数值，取求和数值最大所对应的类别为带识别菜品图片类别。经过测试，本发明具有的有益效果是：1、使用基于深度学习的目标检测的预测框与深度学习方式提取容器边缘相结合可以得到精准的菜品图像。2、使用对比特征检索的方式，而不是直接分类方式去判别菜品类别，这样的好处是当要判别新的菜品类别的时候，我们只需要对新菜品采样，并将采样得到特征记录到数据集中，不需要重新调整和训练分类网络，灵活性更好，更方便。3、使用带权K近邻分类，提高了菜品分类效率和准确率，具有良好的自适应性及鲁棒性。本发明在对菜品识别方面，采用对比特征检索的方式，而不是直接分类方式去判别菜品类别，这样的好处是当要判别新的菜品类别的时候，我们只需要对新菜品采样，并将采样得到特征记录到数据集中。当需要判别类别的时候，使用特征在数据库中进行对比，就可得到结果。当然，我们在判别时候不仅仅使用特征相似度，我们还引入菜品图像的颜色直方图相似度与容器边缘曲率相似度，进一步提高的判别的准确性。附图说明图1本发明方法流程图。图2深度学习模型构建图。具体实施方式以下结合附图对本发明的具体实施方案做作进一步说明。本发明的主用于元器件的检测；图1为本发明的元器件检测框架图；步骤1采集含有容器图像，保证图像显示范围为能完整容器的最小范围；以图像中心点为参考点，图像正上方向为角度0度方向，顺时针为正向依次记录角度与曲率点对；对容器类别字段，类别唯一，可使用中文、英文与阿拉伯数字；根据容器类别字段、创建时间与图像的md-256生成数据编号，并将图像在指定的路径下保存，保存名称为该数据编号+“.jpg”。步骤2保证一个图像中只要一道菜品，同时图像显示范围为能完整的承装菜品容器的最小范围；使用预先标注好的菜品图片组成训练集，对SENet网络模型进行训练，直至模型收敛；将菜品图片送入训练好的SENet模型进行特征提取，获取菜品特图像的2048维度特征数据并保存；统计菜品图片的RGB三通道的彩色数值概率直方图；菜品类别字段，类别唯一，可使用中文、英文与阿拉伯数字；根据菜品类别字段、创建时间与图像的md-256生成数据编号，并将图像在指定的路径下保存，保存名称为该数据编号+“.jpg”。步骤3使用预先标注的采集图像组成训练集，对容器检测神经网络进行训练，直至模型收敛；使用人工标识的容器边缘图像组成训练集，训练边缘检测网络RCF，直到收敛；使用目标检测模型在采集的图像上预测容器位置信息；再使用使用RCF网络对采集图像获得容器边缘图像；联合目标检测的预测信息与边缘图像信息，获得更高精度的预测坐标信息。步骤4使用步骤3训练好的边缘检测网络RCF，计算容器图像的边缘信息，随后计算容器边缘的曲率；步骤5使用步骤训练好的SENet网络对步骤得到每一个菜品图像进行特征提取，获得2048个维度特征数据。步骤6计算曲率相似度计算容器数据库中全部曲率，根据步骤采集容器曲率，在匹配时候，我们采用按照步长为0.1度的增量，滑动比对数据库与当前容器的曲率数据，记录最小平均欧式距离，对某些曲率缺失的数据点，该数据点不参与计算；采用向量余弦相似度公式计算菜品数据库中全部特征与待识别菜品图像特征的相似度，具体公式为：其中，＜x,y＞为x与y特征向量的内积值，||x||、||y||分别表示x和y特征向量的欧式距离；计算颜色直方图相似度，采用Bhattacharyya距离计算，具体公式为：其中，p、q分别表示p和q两个颜色直方图桶的概率；菜品的相似度数值为特征相似度、直方图相似度与曲率相似度的加权求和。步骤7根据步骤计算待识别菜品与全部菜品数据库的相似度数值，等到相似度数组与对应菜品的类别标签；使用Softmax方式对计算得到的全部相似度数组进行加权；获得加权的数值，按照类别求和数值，取求和数值最大所对应的类别为带识别菜品图像类别。
