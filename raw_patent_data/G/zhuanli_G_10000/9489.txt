标题title
一种配电终端程序升级及管理系统及方法
摘要abst
本发明公开一种配电终端程序升级及管理系统及方法，该系统由配电终端程序管理平台和手持终端两部分组成；所述配电终端程序管理平台存储着配电网上所有的配电终端的信息和程序文件，存储着手持终端的信息，承担配电终端程序升级任务下发管理及配电终端升级报告的管理工作；所述手持终端基能够获取系统由配电终端程序管理平台下发的升级任务，实现对配电终端的程序升级及升级结果验证功能，并可生成配电终端程序升级作业报告。本发明通过配电终端程序管理平台和手持终端共同配合，可广泛用于配网内不同厂家，不同类型及离线配电终端的程序版本管理及程序升级等作业。
权利要求书clms
1.一种配电终端程序升级及管理系统，该系统由配电终端程序管理平台和手持终端两部分组成，其特征在于：配电终端程序管理平台与各手持终端信息交互，手持终端与配电终端信息交互；所述配电终端程序管理平台存储着配电网上所有的配电终端的信息和程序文件，存储着手持终端的信息，承担配电终端程序升级任务下发管理及配电终端升级报告的管理工作；所述手持终端获取系统由配电终端程序管理平台下发的升级任务，实现对配电终端的程序升级及升级结果验证功能，并可生成配电终端程序升级作业报告；所述配电终端程序管理平台架设在配网主站服务器上，所述配电终端程序管理平台存储有配网内所有已投运的配电终端的设备ID、GPS地理信息及软硬件版本号信息，存储有配网内所有已投运的配电终端的所有历史版本程序文件，存储有手持终端的库存信息；所述配电终端程序管理平台通过WIFI热点向指定手持终端推送配电终端升级任务工单及升级程序文件。2.如权利要求1所述的一种配电终端程序升级及管理系统，其特征是，所述手持终端的升级程序人机交互系统采用图形化的操作界面，负责操作人员与被操作手持终端之间的人机交互。3.如权利要求1所述的一种配电终端程序升级及管理系统，其特征是，所述手持终端通过RJ45网线与配电终端相连，采用符合国家电网企标的IEC104通信规约与配电终端进行信息交互。4.一种配电终端程序升级及管理方法，基于权利要求1-3任意一项所述的配电终端程序升级及管理系统，其特征在于，步骤如下：步骤一、配电终端程序管理平台派单：当发现某版本的配电终端程序出现问题时，操作员可通过配电终端程序管理平台查询到运行该版本程序的配电终端，根据实际需要选择在库的一台或多台手持终端用做现场程序升级，并通过调用配网主站服务器上的派单系统向相关运维人员派发运维通知消息，通知运维人员领取手持终端并到配网主站调度中心下载程序升级任务及程序文件；步骤二、手持终端下载程序升级任务和程序文件：完成以上派单操作后，配电终端程序管理平台打开无线WIFI服务设备，等待手持终端接入；运维人员持手持终端接入热点后，配电终端程序管理平台向手持终端推送程序升级任务和程序文件；步骤三、手持终端向配电终端上传程序文件，完成程序升级：运维人员携带手持终端至配电终端位置，使用网线连接手持终端与配电终端的程序升级接口，手持终端与配电终端成功连接后，查询配电终端的设备ID是否在此次升级任务中，并获取此时的GPS地理信息进行进一步的配电终端身份认定，在确定配电终端身份后，查询配电终端此时正在运行的程序版本，并记录到程序升级报告中；确定无误后，手持终端将自动推送升级程序至配电终端，升级程序的指令完全基于标准IEC104规约关于终端程序升级的定义，可确保适配符合标准的不同厂家的不同类型的配电终端产品；配电终端升级成功后，自动重启配电终端，再次查询配电终端的程序版本，验证程序是否已更换为指定程序；步骤四、上传升级报告并更新配电终端程序版本信息：待运维人员完成程序升级任务后，用手持终端再次接入配电终端程序管理平台的WIFI热点，向配电终端程序管理平台上传升级报告，配电终端程序管理平台读取升级报告，提取升级结果，更新配电终端程序管理平台存储的配电终端程序版本信息。5.如权利要求4所述的一种配电终端程序升级及管理方法，其特征在于，步骤三中，在进行程序升级前，手持终端会先召唤并记录配电终端此时的运行工况的断面数据，程序升级完毕后，再次召唤程序的运行工况的断面数据，并与升级前的数据进行比对，在误差范围内校验配电终端在进行程序升级后仍处于正常的运行状态。6.如权利要求4所述的一种配电终端程序升级及管理方法，其特征在于，程序成功升级完毕后，手持终端将推送下台需升级的配电终端的GPS地理信息，指导运维人员继续完成配电终端升级任务。7.如权利要求4所述的一种配电终端程序升级及管理方法，其特征在于，手持终端与配电终端通过RJ45网线与被升级程序的配电终端相连；手持终端在通过IEC104通信规约与配电终端建立通信连接后，通过IEC104规约中的远程参数查询命令查询待升级的配电终端的设备ID和程序版本号信息，手持终端通过查询到的配电终端的设备ID查询运维清单中是否存在该配电终端的设备ID，GPS地理信息是否与手持终端通过自身GPS芯片获取的定位信息相符，确认配电终端是否在升级清单中，如存在则找到该配电终端对应的升级程序文件。8.如权利要求4所述的一种配电终端程序升级及管理方法，其特征在于，手持终端在完成召唤并记录配电终端此时的运行工况的断面数据的工作后，通过IEC104规约中的程序升级命令，将程序文件下发至配电终端；下发完毕后，下发IEC104规约中的重启配电终端命令，待配电终端重新启动后，再次通过IEC104规约中的远程参数查询命令查询待升级的配电终端的程序版本号，验证升级结果。
说明书desc
技术领域本发明涉及配电终端技术领域，尤其涉及一种配电终端程序升级及管理系统及方法。背景技术近些年来，供电企业为提高供用电质量水平，提高对电力用户的服务质量，加速推进了配电自动化的建设。其中配电终端是配电自动化建设的重要组成部分。配电终端采集配电网实时运行数据，检测、识别故障，监视开关设备的运行工况，实现配电网的故障的快速定位与隔离。配网的自动化、智能化程度越来越高，更新换代的周期也越来越快，在提高了配网供电稳定性的同时也对配电运维工作也带来了以下问题：当线路智能化升级等方面的需求时，线路上已投运配电终端会出现功能不适配的问题，另外配电终端在长时间的运行下，可能会暴露出在入网检测时不易或不能被发现的软件功能缺陷。一般情况下，对配电终端的功能升级或消缺，可通过升级配电终端程序解决。但目前在国网范围内的配电终端技术规范上，未对配电终端程序升级接口做出统一规定。配电终端厂家升级程序的方法手段五花八门，下载程序所用的线缆也不统一，有些厂家甚至需要厂家定制的特殊线缆才能升级程序。不利于配电运维工作的开展。另外当投运的某台配网终端发生因程序设计缺陷发生的故障时，因缺乏统一的配电终端软件版本管理平台，造成无法统计受影响的配电终端数量及影响的范围，给消除缺陷工作带来很大的困难。同时在配网内存在大量脱离主站管理的配电终端，如果对这些离线配电终端的进行程序升级和软件管理也是一个配网运维工作中的一大难题。CN107453925A公开了一种基于多级通信平台的远程固件升级方法和云平台，所述方法包括：一级平台检测待升级设备是否属于二级平台，若属于，一级平台接收升级参数的设定，将升级程序文件传输至所述待升级设备；若不属于，一级平台接收升级参数的设定，将升级程序文件传输至所述待升级设备对应的二级平台设备；所述二级平台设备解析所述升级参数，确定待升级设备的终端类型、终端数量，以及升级方式，并据此将所述升级程序文件传输至所述待升级设备；所述待升级设备进行设备自检，检查自身是否满足程序升级的条件，若满足，读取所述程序文件，进行升级。实现了自上而下的逐级设备固件升级方法和同一级通信设备的横向固件升级。所述一级平台还与手持智能设备建立通信连接，通过手持智能设备对一级平台进行控制。但是这种方式虽然实现了升级统一管理，但是要求所有设备必须联网才能实现统一管理和升级，无法实现离线终端管理，虽然使用了手持智能设备，但是只是作为控制一级平台的设备，无法用于离线升级。发明内容针对现有技术存在的不足，本发明的目的在于提供一种配电终端程序升级及管理系统，特别是，解决离线配电终端难以升级的问题，最终解决现在配电终端程序升级费用高、效率低、覆盖面不足的问题。为了解决上述的技术问题，本发明采用如下技术方案予以实现。一种配电终端程序升级及管理系统，该系统由配电终端程序管理平台和手持终端两部分组成，配电终端程序管理平台与各手持终端信息交互，手持终端与配电终端信息交互；所述配电终端程序管理平台存储着配电网上所有的配电终端的信息和程序文件，存储着手持终端的信息，承担配电终端程序升级任务下发管理及配电终端升级报告的管理工作；所述手持终端获取系统由配电终端程序管理平台下发的升级任务，实现对配电终端的程序升级及升级结果验证功能，并可生成配电终端程序升级作业报告。进一步优选，所述配电终端程序管理平台架设在配网主站服务器上，所述配电终端程序管理平台存储有配网内所有已投运的配电终端的设备ID、GPS地理信息及软硬件版本号信息，存储有配网内所有已投运的配电终端的所有历史版本程序文件，存储有手持终端的库存信息。进一步优选，所述手持终端采用ARM架构的多核处理器的windows操作系统平台，包括无线4G、WIFI、北斗/GPS定位、USB3.0、RJ45网络接口等对外通信接口、满足配电终端程序升级对传输信道的需求。进一步优选，所述配电终端程序管理平台通过WIFI热点向指定手持终端推送配电终端升级任务工单及升级程序文件。进一步优选，所述手持终端的升级程序人机交互系统采用图形化的操作界面，负责操作人员与被操作手持终端之间的人机交互。操作者可在此平台上向上一级管理系统获取配电终端程序升级任务及程序文件，查询配电终端的正在运行的程序的版本号，向配电终端推送升级程序，形成程序升级报告并上传至配电终端程序管理平台等操作。进一步优选，所述手持终端通过网线与配电终端建立连接，采用符合国家电网企标的IEC104通信规约与配电终端进行信息交互。一种配电终端程序升级及管理方法，步骤如下：步骤一、配电终端程序管理平台派单：当发现某版本的配电终端程序出现问题时，操作员可通过配电终端程序管理平台查询到运行该版本程序的配电终端，根据实际需要选择在库的一台或多台手持终端用做现场程序升级，并通过调用配网主站服务器上的派单系统向相关运维人员派发运维通知消息，通知运维人员领取手持终端并到配网主站调度中心下载程序升级任务及程序文件；步骤二、手持终端下载程序升级任务和程序文件：完成以上派单操作后，配电终端程序管理平台打开无线WIFI服务设备，等待手持终端接入；运维人员持手持终端接入热点后，配电终端程序管理平台向手持终端推送程序升级任务和程序文件。步骤三、手持终端向配电终端上传程序文件，完成程序升级：运维人员携带手持终端至配电终端位置，使用网线连接手持终端与配电终端的程序升级接口，手持终端与配电终端成功连接后，查询配电终端的设备ID是否在此次升级任务中，并获取此时的GPS地理信息进行进一步的配电终端身份认定，在确定配电终端身份后，查询配电终端此时正在运行的程序版本，并记录到程序升级报告中；确定无误后，手持终端将自动推送升级程序至配电终端，升级程序的指令完全基于标准IEC104规约关于配电终端程序升级的定义，可确保适配符合标准的不同厂家的不同类型的配电终端产品；配电终端升级成功后，自动重启配电终端，再次查询配电终端的程序版本，验证程序是否已更换为指定程序；步骤四、上传升级报告并更新配电终端程序版本信息：待运维人员完成程序升级任务后，用手持终端再次接入配电终端程序管理平台的WIFI热点，向配电终端程序管理平台上传升级报告，配电终端程序管理平台读取升级报告，提取升级结果，更新配电终端程序管理平台存储的配电终端程序版本信息。进一步优选，在进行程序升级前，手持终端会先召唤并记录配电终端此时的运行工况的断面数据，程序升级完毕后，再次召唤程序的运行工况的断面数据，并与升级前的数据进行比对，在误差范围内校验配电终端在进行程序升级后仍处于正常的运行状态。进一步优选，程序成功升级完毕后，手持终端将推送下台需升级的配电终端的GPS地理信息，指导运维人员继续完成配电终端升级任务。进一步优选，手持终端与配电终端通过RJ45网线与被升级程序的配电终端相连；手持终端在通过IEC104通信规约与配电终端建立通信连接后，通过IEC104规约中的远程参数查询命令查询待升级的配电终端的设备ID和程序版本号信息，手持终端通过查询到配电终端的设备ID查询运维清单中是否存在该配电终端的设备ID、GPS地理信息是否与手持终端通过自身GPS芯片获取的定位信息相符，确认配电终端是否在升级清单中，如存在则找到该配电终端对应的升级程序文件。进一步优选，手持终端在完成召唤并记录配电终端此时的运行工况的断面数据的工作后，通过IEC104规约中的程序升级命令，将程序文件下发至配电终端；下发完毕后，下发IEC104规约中的重启终端命令，待配电终端重新启动后，再次通过IEC104规约中的远程参数查询命令查询待升级的配电终端的程序版本号，验证升级结果。本发明的配电终端程序升级及管理系统，配电终端程序管理平台与配电终端没有直接交互，本发明的系统结构简约，仅依靠装载有配电终端程序升级软件模块的手持终端即可完成配电终端的程序升级，无需其他系统和设备的支持，对网络环境亦无要求。特别适用于没有与配网主站联网互通的离线配电终端的就地程序升级与离线版本管理。本发明还具有以下优点：1.程序版本记录可查询，追溯：配电终端程序管理平台统一把控整个配网的配电终端的程序版本情况，在发现某版本的配电终端程序缺陷时，可快速确定要升级的配电终端分布情况，制定精确的配电终端升级运维方案。2.程序升级工具的统一化：手持终端可实现所有厂家不同种类配电终端的统一程序升级；3. 配电终端升级接口的统一化：基于统一RJ45接口的本地有线运维；4.程序升级协议的标准化：基于《配电自动化系统应用DLT634.5104-2009实施细则》标准，实现不同厂家和类型的配电终端的统一升级。附图说明图1为本发明提出的一种配电终端程序升级管理系统系统框图。具体实施方式以下结合附图对本发明的实施例进行详细说明，但是本发明可以由权利要求限定和覆盖的多种不同方式实施。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。如图1所示，一种配电终端程序升级及管理系统，该系统由配电终端程序管理平台和手持终端两部分组成，配电终端程序管理平台与各手持终端信息交互，手持终端与配电终端信息交互；配电终端程序管理平台是配网在运行的配电终端的软件程序版本管理平台，负责配电终端升级任务的派发及软件版本的管理。手持终端是一种配电终端程序升级管理系统的中间节点。所述配电终端程序管理平台存储着配电网上所有的配电终端的信息和程序文件，存储着手持终端的信息，承担配电终端程序升级任务下发管理及配电终端升级报告的管理工作；所述手持终端获取系统由配电终端程序管理平台下发的升级任务，实现对配电终端的程序升级及升级结果验证功能，并可生成配电终端程序升级作业报告。本发明中，所述配电终端程序管理平台架设在配网主站服务器上，所述配电终端程序管理平台存储有配网内所有已投运的配电终端的设备ID、GPS地理信息及软硬件版本号信息，存储有配网内所有已投运的配电终端的所有历史版本程序文件，存储有手持终端的库存信息。本发明中，所述手持终端采用ARM架构的多核处理器的windows操作系统平台，包括无线4G、WIFI、北斗/GPS定位、USB3.0、RJ45网络接口等对外通信接口、满足配电终端程序升级对传输信道的需求。本发明中，所述配电终端程序管理平台通过WIFI热点向指定手持终端推送配电终端升级任务工单及升级程序文件。本发明中，所述手持终端的升级程序人机交互系统采用图形化的操作界面，负责操作人员与被操作手持终端之间的人机交互。操作者可在此平台上向上一级管理系统获取配电终端程序升级任务及程序文件，查询配电终端的正在运行的程序的版本号，向配电终端推送升级程序，形成程序升级报告并上传至配电终端程序管理平台等操作。本发明中，所述手持终端通过网线与配电终端建立连接，采用符合国家电网企标的IEC104通信规约与配电终端进行信息交互。一种配电终端程序升级及管理方法，步骤如下：步骤一、配电终端程序管理平台派单：当发现某版本的配电终端程序出现问题时，或当某厂家的已投运的配电终端产品发现软件缺陷，需要升级程序时，配电终端程序管理平台启动程序更新管理流程，操作员可通过配电终端程序管理平台查询到运行该版本程序的配电终端，根据实际需要选择在库的一台或多台手持终端用做现场程序升级，并通过调用配网主站服务器上的派单系统向相关运维人员派发运维通知消息，通知运维人员领取手持终端并到配网主站调度中心下载程序升级任务及程序文件；升级任务的详细清单的生成由操作员在配电终端程序管理平台点击相关按钮触发，管理平台收到触发指令后，根据操作员在平台界面上选取的待升级的配电终端，从平台的后台数据库内提取被选配电终端的GPS地理信息、配电终端的设备ID，适配升级程序文件的文件名信息，生成文本文档。文本文档的命名以操作员在配电终端程序管理平台上指派的运维人员的11位手机号码及8位的派单日期组成。升级任务的详细清单文件生成后暂存在平台的派单任务下载目录下，等待运维人员获取。步骤二、手持终端下载程序升级任务和程序文件：完成以上派单操作后，配电终端程序管理平台打开无线WIFI服务设备，等待手持终端接入；运维人员持手持终端接入热点后，在登录界面上填写本人11位的手机号码并确认后，配电终端程序管理平台向手持终端推送对应的程序升级任务和程序文件。程序升级任务包括配电终端的GPS地理信息、配电终端的设备ID，适配程序文件的文件名等信息。运维人员利用手持终端在配电终端程序管理平台获取到升级文件和升级任务的详细清单后，根据派单上的配电终端GPS地理信息到达待升级程序的配电终端现场。步骤三、手持终端向配电终端上传程序文件，完成程序升级：运维人员携带手持终端至配电终端位置，使用网线连接手持终端与配电终端的程序升级接口，手持终端与配电终端成功连接后，查询配电终端的设备ID是否在此次升级任务中，并获取此时的GPS地理信息进行进一步的配电终端身份认定，在确定配电终端身份后，查询配电终端此时正在运行的程序版本，并记录到程序升级报告中；确定无误后，手持终端将自动推送升级程序至配电终端，升级程序的指令完全基于标准IEC104规约关于终端程序升级的定义，可确保适配符合标准的不同厂家的不同类型的配电终端产品；配电终端升级成功后，自动重启配电终端，再次查询配电终端的程序版本，验证程序是否已更换为指定程序。本发明中，手持终端与配电终端通过RJ45网线与被升级程序的配电终端相连。手持终端在通过IEC104通信规约与配电终端建立通信连接后，通过IEC104规约中的远程参数查询命令查询待升级的配电终端的设备ID和程序版本号等信息。手持终端通过自身装配的GPS芯片获取地理信息。以配电终端的设备ID和GPS地理信息为两个参数，查询升级清单文件中的待运维配电终端记录，当匹配到文件中的一条记录与查询条件的ID号相同，GPS地理信息经纬度相差在1秒范围内时，确认配电终端是否在升级清单中，并在配电终端清单内找到该配电终端对应的升级程序文件名。手持终端召唤并记录配电终端此时的运行工况的断面数据，断面数据的内容包括从配电终端获取到线电压，电流，蓄电池电压，环境温度等四个信号量，以16进制浮点数的形式保存至文件。完成断面数据采集后，手持终端通过IEC104规约中的程序升级命令，将对应的升级程序文件下发至配电终端。下发完毕后，下发IEC104规约中的重启配电终端命令，待配电终端重新启动后，再次通过IEC104规约中的远程参数查询命令查询待升级的配电终端的程序版本号，验证升级结果。程序升级成功后，再次召唤程序的运行工况的断面数据，包括线电压，电流，蓄电池电压，环境温度，并与升级前的采集到线电压，电流，蓄电池电压，环境温度的数据一一对应计算每个信号量相对误差，相对误差计算公式如公式1,如四个信号计算得到的绝对误差均小于10%，则认定该配电终端在进行程序升级后仍处于正常的运行状态。程序成功升级完毕后，记录升级结果至配电终端升级报告并推送下台需升级的配电终端的GPS地理信息，指导运维人员继续完成配电终端升级任务。其中，δ表示相对误差， L前 与L后 分别表示表示装置升级程序升级前后采集到信号值。在完成所有指派的配电终端程序升级任务后，手持终端指示运维人员向配电终端程序管理平台上传运维报告。步骤四、上传升级报告并更新配电终端程序版本信息：待运维人员完成程序升级任务后，用手持终端再次接入配电终端程序管理平台的WIFI热点，向配电终端程序管理平台上传升级报告，配电终端程序管理平台读取升级报告，提取升级结果，更新配电终端程序管理平台存储的配电终端程序版本信息。
