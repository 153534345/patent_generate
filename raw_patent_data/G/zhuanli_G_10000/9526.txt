标题title
一种基于计算机视觉的电动爬楼担架车辅助控制方法
摘要abst
本发明涉及一种基于计算机视觉的电动爬楼担架车辅助控制方法，其是通过构建网络模型，包括网络模型一和网络模型二；对所述网络模型进行训练，得到训练好的网络模型；将实时获取的担架车的晃动特征向量输入训练好的网络模型，输出第一特征向量；计算第一特征向量与目标向量集中的每一个特征向量的欧式距离，确定与第一特征向量的欧式距离最小的特征向量，将该特征向量作为目标运动特征向量，调整担架车的运动参数，使第一特征向量在下一时刻接触台阶时趋于目标运动特征向量。即本发明的方案能够调整运动特征向量控制担架车的运动，保证了担架车的平稳爬楼。
权利要求书clms
1.一种基于计算机视觉的电动爬楼担架车辅助控制方法，其特征在于，包括以下步骤：构建网络模型，包括网络模型一和网络模型二；对所述网络模型进行训练，得到训练好的网络模型；将实时获取的担架车的晃动特征向量输入训练好的网络模型，输出第一特征向量；计算第一特征向量与目标向量集中的每一个特征向量的欧式距离，确定与第一特征向量的欧式距离最小的特征向量，将该特征向量作为目标运动特征向量，调整担架车的运动参数，使第一特征向量在下一时刻接触台阶时趋于目标运动特征向量；其中，对所述网络模型进行训练的方法为：步骤A，采集担架车的运动特征向量和晃动特征向量，并将运动特征向量和晃动特征向量构成一组数据，获取数据集；步骤B，将数据集输入网络模型中，其中，将运动特征向量输入网络模型二中，经编码器二进行特征提取，输出隐空间特征二，将隐空间特征二输入解码器二中，获得输出结果二；将晃动特征向量输入网络模型一中的编码器一中，输出隐空间特征一，将隐空间特征一输入解码器一中，获得输出结果一；利用损失函数进行多次迭代，使所述隐空间特征二等于所述隐空间特征一，输出结果二等于输出结果一，从而迭代出更新后的权重参数，得到训练好的网络模型。2.根据权利要求1所述的基于计算机视觉的电动爬楼担架车辅助控制方法，其特征在于，所述损失函数为：其中，重构损失为：其中，为输出结果二，为担架车运动特征向量，为输出结果一；其中，特征对齐损失为：其中，g1为隐空间特征一，g2为隐空间特征二，表示的散度，，表示的散度，为K维的标准正态高斯概率密度函数，为融合系数。3.根据权利要求2所述的基于计算机视觉的电动爬楼担架车辅助控制方法，其特征在于，所述隐空间特征一的函数表达式为：g其中，,是K维空间的任意一个向量，表示K维高斯概率密度函数的K个均值，B1是K×K的协方差矩阵，矩阵对角元素为K个方差，其他元素为0；所述隐空间特征二的函数表达式为：g其中2表示K维高斯概率密度函数的K个均值，B2是的K×K的协方差矩阵，矩阵对角元素是高斯概率密度函数的K个方差，其他元素为0。4.根据权利要求1所述的基于计算机视觉的电动爬楼担架车辅助控制方法，其特征在于，将所述晃动特征向量输入训练好的网络模型的网络模型一中，输出第一特征向量，所述第一特征向量为运动特征向量。5.根据权利要求1所述的基于计算机视觉的电动爬楼担架车辅助控制方法，其特征在于，所述目标向量集为担架车稳定运行对应的运动特征向量集。6.根据权利要求1所述的基于计算机视觉的电动爬楼担架车辅助控制方法，其特征在于，所述运动参数包括星轮的每个子轮与子轮公转中心的轴长和/或星轮公转平面与担架车运动方向的夹角。
说明书desc
技术领域本发明涉及担架控制技术领域，具体涉及一种基于计算机视觉的电动爬楼担架车辅助控制方法。背景技术担架为医疗器械的一种，医院或军队中抬送病人、伤员的用具，用竹、木、金属等做架子，中间绷着帆布或绳子，符合病情需要，便于病人与伤员躺卧。传统的担架攀爬和越障环境时使用不便，需占用大量人力才能实现患者转移的现状，大大降低了担架使用时的便利性。同时，对于紧急情况下无自主移动能力的病人，经常出现其所在建筑物无电梯或较高楼层电梯无法迅速到达病患所在楼层的情况，所以对于病人的上下楼梯转运仍然需要采用人力的抱、背、双人抬等方式，采用上述方式容易使病人身体歪斜感到不适或对病人产生二次伤害，且上下楼梯过程人力转运病人的效率低下，同时也对医护人员的体力造成很大的消耗。因此，如何控制担架车的运行，使担架尽可能平稳爬楼梯，保证病人的安全是急需解决的问题。发明内容为了解决上述技术问题，本发明的目的在于提供一种基于计算机视觉的电动爬楼担架车辅助控制方法，所采用的技术方案具体如下：本发明的一种基于计算机视觉的电动爬楼担架车辅助控制方法，包括以下步骤：构建网络模型，包括网络模型一和网络模型二；对所述网络模型进行训练，得到训练好的网络模型；将实时获取的担架车的晃动特征向量输入训练好的网络模型，输出第一特征向量；计算第一特征向量与目标向量集中的每一个特征向量的欧式距离，确定与第一特征向量的欧式距离最小的特征向量，将该特征向量作为目标运动特征向量，调整担架车的运动参数，使第一特征向量在下一时刻接触台阶时趋于目标运动特征向量；其中，对所述网络模型进行训练的方法为：步骤A，采集担架车的运动特征向量和晃动特征向量，并将运动特征向量和晃动特征向量构成一组数据，获取数据集；步骤B，将数据集输入网络模型中，其中，将运动特征向量输入网络模型二中，经编码器二进行特征提取，输出隐空间特征二，将隐空间特征二输入解码器二中，获得输出结果二；将晃动特征向量输入网络模型一中的编码器一中，输出隐空间特征一，将隐空间特征一输入解码器一中，获得输出结果一；利用损失函数进行多次迭代，使所述隐空间特征二等于所述隐空间特征一，输出结果二等于输出结果一，从而迭代出更新后的权重参数，得到训练好的网络模型。进一步地，所述损失函数为：其中，重构损失为：其中，为输出结果二，为担架车运动特征向量，为输出结果一；其中，特征对齐损失为：其中，g1为隐空间特征一，g2为隐空间特征二，表示的散度，，表示的散度，为K维的标准正态高斯概率密度函数，为融合系数。进一步地，所述隐空间特征一的函数表达式为：g其中，,是K维空间的任意一个向量，表示K维高斯概率密度函数的K个均值，B1是K×K的协方差矩阵，矩阵对角元素是K个方差，其他元素为0；所述隐空间特征二的函数表达式为：g其中2表示K维高斯概率密度函数的K个均值，B2是的K×K的协方差矩阵，矩阵对角元素是高斯概率密度函数的K个方差，其他元素为0。进一步地，将所述晃动特征向量输入训练好的网络模型的网络模型一中，输出第一特征向量，所述第一特征向量为运动特征向量。进一步地，所述目标向量集为担架车稳定运行对应的运动特征向量集。进一步地，所述运动参数包括星轮的每个子轮与子轮公转中心的轴长和/或星轮公转平面与担架车运动方向的夹角。本发明的有益效果：本发明通过计算机视觉获得担架车在爬楼过程中的运动特征向量，利用运动特征向量来准确量化担架车的运动情况；本发明通过采集担架车大量的运动特征向量和晃动特征向量，训练一个关联网络模型，通过构建合理的网络结构和损失函数，使得网络模型能够利用采样的晃动特征向量去准确可靠的生成新的稳定运行的运动特征向量集合以及实时的运动特征向量，在该集合中实时的匹配出能够使担架车稳定运行的运动特征向量，据此来调整实时的运动特征向量，并控制担架车运动，尽可能的保证了担架车的平稳爬楼。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为三星轮式结构示意图；图2为本发明的一种基于计算机视觉的电动爬楼担架车辅助控制方法实施例的流程示意图；图3为本发明的一种基于计算机视觉的电动爬楼担架车辅助控制方法实施例中构建的网络模型的结构框图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明的方案，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构、或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种基于计算机视觉的电动爬楼担架车辅助控制方法的具体方案。本发明针对的是行星轮式爬楼担架车，担架车上前后左右有四个星轮；其中的星轮一般是由星轮、星轮架和星轮架主轴组成，采用了行星公转与自转的原理，星轮以及星轮架绕星轮主轴公转的同时星轮能够自转来实现爬楼梯的过程。其中，三星轮式是星轮式的一种最常用的形式，如图1所示，由布置成三角形的三个轮子组合而成的，每个轮以及三星轮架可以绕三星轮架主轴公转，同时每个轮子可以自身的轮轴自转。在上下楼梯的过程中，三星轮整体绕三星轮架的中心轴公转，而单个轮子锁死不转，从而使在上面的轮子翻转接触到高一级台阶的面上，再继续进行翻转，以此为循环，实现轮椅的爬楼梯功能，在实现上下楼的同时，始终保证轮子接触在楼梯台阶上，以提供给担架车支撑力，保证担架车的平稳。在平地行驶过程中，三星轮架受到力的作用相对于中心轴固定不动，而单个轮子绕自身轴线转动，得以实现平地的运动。基于上述行星轮式爬楼担架车，在爬楼梯的过程中，其可能由于楼梯的规格有所偏差，导致星轮可能在运动过程中抵在楼梯的垂直台阶壁上、担架车的轴线和楼梯的轴线不平行或者与下方台阶接触的两星轮接触不明显；前两种情况使得担架车车身相对楼梯发生倾斜，即左右两个星轮不同时接触台阶，也即一个接触点表示星轮没有稳定接触到台阶，尚有一个星轮没支撑在台阶上，此种情况无法使担架车爬楼梯；而最后一种情况则是担架车的星轮与台阶接触时有两个接触点，但是担架车的运行稳定性存在问题。因此，为了验证担架车在爬楼过程中的稳定性，本发明只针对有两个接触点的情况进行分析。本发明的应用场景为针对担架车的稳定性分析，根据采集不同环境下的数据，对担架车进行测试，提出一种能够适应各种环境下的担架车稳定性的控制方法，使担架车在不同的楼梯环境下能够做出适应性的调节，保证尽可能平稳爬楼梯。需要说明的是，本发明忽略不可控的人为因素，只考虑担架车的自身运动状态来控制担架车的运动，使担架车尽可能运行平稳。具体地，本发明的一个实施例提供的一种基于计算机视觉的电动爬楼担架车辅助控制方法的步骤流程图，如图2所示，该方法包括以下步骤：步骤1，构建网络模型，对所述网络模型进行训练，得到训练好的网络模型；本实施例中构建的网络模型包括网络模型一和网络模型二，如图3所示，网络模型一包括编码器1和解码器1，网络模型二包括编码器2和解码器2，其中解码器1和解码器2实现参数共享。其中的网络模型二为一个变分自编码器。上述中的编码器1和编码器2均由多个全连接层构成的，本发明采用5个全连接层，编码器1和2是神经网络中常用的网络结构，本发明不再赘述其具体结构。解码器1和解码器2均由5层全连接网络构成的；其中解码器1和解码器2的工作原理相似，均为：将隐空间特征输入5层的全连接神经网络中，获得输出结果。本实施例中构建的网络模型为DNN网络模型，其为结构为现有技术，此处不再过多赘述。本实施例中对网络模型进行训练的过程为：步骤A，获取训练数据集，所述训练数据集包括多组由担架车的运动特征向量和晃动特征向量构成的数据；本实施例中的训练数据集是将担架车运动特征向量和担架车晃动特征向量构成一组数据，所有组数据构成一个数据集。其中，担架车的运动特征向量的获取：本实施例中通过在担架车的四个星轮的上方、担架床的下方固定安装四个相机，每个相机向下俯视每个星轮，使得每个相机的视野能够拍摄到整个星轮运动过程的图像数据。本实施例中，将每个图像数据输入关键点检测网络中，提取星轮和台阶的接触点，并通过语义分割网络技术，确定接触点在台阶上位置。具体地，通过语义分割网络分割出每个台阶面的语义区域，台阶面包括水平的台阶面和竖直的台阶面，如果接触点处于水平台阶面上，那么接触点的垂直高度特征为0，水平距离特征为接触点到垂直台阶下边沿的最近距离；如果接触点处于竖直台阶面上，那么接触点的水平距离特征为0，垂直高度特征为接触点到竖直台阶面下边缘线的最小距离。假设第i个星轮的第j个接触点的水平距离特征和垂直高度特征为，那么第i个星轮的特征向量为。上述中的关键点检测网络是公知技术。至此，获取所有星轮的特征向量，将所有星轮的状态特征向量合并在一起构成一个向量，称为担架车运动状态特征向量。其中，担架车的晃动特征向量的获取：本实施例中通过在担架车的担架床下方安装震动传感器阵列，每个传感器的示数值表示传感器所在位置的晃动程度大小，通过传感器阵列能够获得不同位置的晃动程度。本发明将所有位置的晃动程度构成的向量称为担架车晃动特征向量。此处主要考虑的是，在担架车爬楼的过程中，星轮与台阶接触的时机和节奏不同会导致担架车的不同晃动情况。步骤B，将所述训练数据集输入网络模型中，其中，将担架车运动特征向量输入编码器2中对其进行特征提取，输出隐空间特征二，将隐空间特征二输入解码器2中，获得输出结果二；将担架车晃动特征向量输入编码器1，输出隐空间特征一，将隐空间特征1输入解码器一中，获得输出结果一，利用损失函数进行迭代，获取训练好的网络。本实施例中的损失函数为：其中，重构损失为：其中，为输出结果二，为担架车运动特征向量，为输出结果一。需要说明的是，，表示DNN网络输出的和输入的担架车运动特征向量的差异，本发明期望这种差异尽可能小，即本发明期望从担架车运动特征向量对应的K维高斯概率密度函数上采样的数据能够被解码器解码成与相似的、新的担架车运动特征向量。表示DNN网络输出的和的差异，本发明期望这种差异尽可能小，即本发明期望能够根据担架车晃动特征向量获得一个新的、正确的担架车运动特征向量。表示的向量的模长。其中，特征对齐损失为：其中，g1为隐空间特征一，g2为隐空间特征二，表示的散度，，表示的散度，为K维的标准正态高斯概率密度函数，为融合系数，令。其中，表示的KL散度，本发明期望的KL散度尽可能小，这样使得的概率分布密度尽可能相似。只有相似时，才能保证担架车晃动特征向量对应的高斯概率密度函数上采样的数据能够被解码器解码出的担架车运动特征向量是准确可信的。表示的KL散度，本发明期望的KL散度尽可能小，这样使得的概率分布密度尽可能相似，其中为K维的标准正态高斯概率密度函数，是与的融合结果，即本发明期望与的融合结果趋近于一个标准正态高斯分布，目的是使得不同组输入DNN网络后获得的多个进行融合，使多个融合之后近似于高斯分布，这样可以使得从不同的g上采样的数据被解码器解码之后获得的数据具有多样性和可解性。本实施例中的隐空间特征一和隐空间特征二，具有相同维度的向量，两者均是由一个K维的高斯概率密度函数的均值和方差构成，即隐空间特征是由K维的高斯概率密度函数的K个均值和K个方差构成的2K维的向量。需要说明的是，从一个K维的高斯概率密度函数上采样数据的过程是不可导的，为了保证DNN网络模型的可导性，首先从K维的标准正态概率密度函数上随机采用一个K维的数据，假设为,那么从一个K维的高斯概率密度函数上采样的一个数据就是，其中为K维的高斯概率密度函数上第i个维度的均值与标准差，所述的标准正态概率密度函数是指所有维度均值都为0、方差都为1的高斯函数，这样从一个K维的高斯概率密度函数上采样数据才能时采样过程具有可导性。本发明中分别将一组担架车晃动特征向量和担架车运动特征向量分别输入编码器一和编码器二后获得的隐空间特征一和隐空间特征二的K维高斯概率密度函数是相似的。则隐空间特征一的函数表达式为：g其中，,是K维空间的任意一个向量，表示K维高斯概率密度函数的K个均值，B1是K×K的协方差矩阵，矩阵对角元素是K个方差，其他元素为0；隐空间特征二的函数表达式为：g其中2表示K维高斯概率密度函数的K个均值，B2是的K×K的协方差矩阵，矩阵对角元素是高斯概率密度函数的K个方差，其他元素为0。本实施例中，使得B最小化的过程就是让和趋于一致，并且使和趋近于标准正态分布。本发明的上述训练过程是让DNN网络能够学习到如何从高斯概率密度函数上生成运动特征向量，以及如何用晃动特征向量去产生这么一个高斯概率密度函数：变分自编码器的解码器2就是用于表示如何从高斯概率密度函数生成运动特征向量的，编码器1就是表示如何用晃动特征向量去产生这么一个高斯概率密度函数。需要注意的是：两个解码器1和2实际上是具有相同的参数。当DNN网络模型训练完成之后，将担架车晃动特征向量输入编码器一中，就能使编码器一能够获得与担架车运动特征向量对应的K维高斯概率密度函数一致的隐空间特征二，从而由解码器一输出担架车运动特征向量。也即本发明通过建立担架车晃动特征向量与担架车运动特征向量对应的K维高斯概率密度函数的映射关系，然后将任意担架车晃动特征向量映射成高斯概率密度函数，然后在这个高斯概率密度函数上采样出担架车运动特征向量。这样就无需再设置相机去采集运动特征向量，也能用新的晃动特征向量去生成新的运动特征向量。步骤2，将实时获取的担架车的晃动特征向量输入训练好的网络模型，输出第一特征向量；本实施例中通过传感器实时获取当前状态下的担架车的晃动特征向量，将该担架车的晃动特征向量作为训练好的网络模型的输入，获得输出结果一。需要说明的是，由于输入的数据仅为晃动特征向量，因此，本实施例中的网络模型实际上仅仅利用了训练好的网络模型一进行数据的计算，其中的网络模型二由于并无数据的输入，其不输出相应的输出结果，也即并不参与计算。当然作为其他实施方式，本发明可以直接将训练好的网络模型中的网络模型二进行删除，仅保留网络模型一。步骤3，计算第一特征向量与目标向量集中的每一个特征向量的欧式距离，确定与第一特征向量的欧式距离最小的特征向量，将该特征向量作为目标运动特征向量，调整担架车的星轮状态，使第一特征向量在下一时刻接触台阶时趋于目标运动特征向量。本实施例中是将第一特征向量为担架车的当前实时的运动特征向量。本实施例中的设定向量集为设定的运动特征向量集，其为历史数据中的担架车稳定运行对应的稳定运动特征向量集，其还可以是通过晃动特征向量获取，具体方法如下：获取P个近似为0向量的晃动特征向量，其中P=50；将P个担架车晃动特征向量依次输入编码器1中，然后再输入解码器1中，分别输出P个输出结果；对所述P个输出结果进行非极大值抑制处理，剔除一部分密集分布的担架车运动特征向量，剩下的担架车运动特征向量构成集合S，将集合S作为担架车平稳运行时的运动特征向量集，也即设定向量集。需要说明的是，让担架车处于平稳运行时的运动状态有很多，而不是只有一个运动状态能够让车稳定本发明需要获得一个与当前运动特征向量最近似的、能保证稳定运行的运动特征向量，这样才能以较小的调整幅度使担架车保持稳定。本实施例中的调整担架车的星轮状态所采用的方法为：需要建立调整四个星轮的运动参数与运动特征向量的映射关系；也即满足通过调整四个星轮的运动参数，使得处于当前运动特征向量v下的四个星轮，在下一时刻其运动特征向量为。具体地，运动参数与运动特征向量的映射关系的方法为：获取标签数据：通过建模仿真的方式，在计算机中模拟出不同运动特征向量Vi，并获取对应的运动参数wi，那么，可以得到Vi+1以及对应的运动参数wi+1，将运动特征向量Vi和Vi+1构成一个数据，这个数据的标签就是△w。训练构建的全连接神经网络：通过计算机可以方便的模拟采集出大量的数据，以这些数据为数据集训练一个全连接神经网络，该网络输入的是一组，输出的是调整的参数值△w。基于上述获取的运动参数与运动特征向量的映射关系，也即训练好的全连接神经网络，即可获得调整参数值：将当前担架车的运动特征向量v，以及输入该网络中，输出参数△w。然后根据参数△w，调整担架车的星轮运动，并改变星轮姿态，使四个星轮的运动状态达到稳定运行的运动参数。本实施例中调整的运动参数包括：星轮上每个子轮与子轮公转中心的轴长，或者星轮的公转平面与担架车运动方向的夹角；上述改变轴长或者夹角均称为每个星轮的运动参数，即可实现改变下一时刻星轮与台阶的接触情况。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。且上述对本说明书特定实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
