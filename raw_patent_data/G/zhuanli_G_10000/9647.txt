标题title
一种外接设备的热插拔方法和装置
摘要abst
本发明公开了一种外接设备的热插拔方法和装置，方法包括：通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态。本发明能够提升OCP卡的热插拔稳定性和便利性。
权利要求书clms
1.一种外接设备的热插拔方法，其特征在于，包括执行以下步骤：响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由所述中央处理器启用供电使能信号并通过所述热插拔控制器将所述状态指示器调整到过渡状态；响应于所述热插拔控制器检测到外部设备在位并且所述供电使能信号已启用，而基于外接设备协议使用所述供电使能信号为外部设备上电，由所述中央处理器在总线上与外部设备通信连接并通过所述热插拔控制器将所述状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过所述热插拔控制器向中央处理器发送热拔信号，由所述中央处理器停用所述供电使能信号并通过所述热插拔控制器将所述状态指示器调整到过渡状态；响应于所述热插拔控制器检测到外部设备在位并且所述供电使能信号已停用，而使用所述供电使能信号为外部设备下电，由所述中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过所述热插拔控制器将所述状态指示器调整到断开状态。2.根据权利要求1所述的方法，其特征在于，所述通知器连接到所述热插拔控制器，并配置为响应于被触发而向所述热插拔控制器发送所述热插拔信号。3.根据权利要求2所述的方法，其特征在于，还包括执行以下步骤：响应于所述中央处理器上电时发出启用供电使能信号和将所述状态指示器调整到过渡状态的开机激活信号并且所述热插拔控制器检测到外部设备不在位，而由所述热插拔控制器屏蔽所述中央处理器发出的所述开机激活信号以不启用供电使能信号并且不将所述状态指示器调整到过渡状态。4.根据权利要求3所述的方法，其特征在于，还包括执行以下步骤：在由所述热插拔控制器屏蔽所述开机激活信号的同时，还由所述热插拔控制器生成并向所述中央处理器发送所述热拔信号以使所述中央处理器停用所述供电使能信号。5.根据权利要求3所述的方法，其特征在于，还包括执行以下步骤：响应于所述热插拔控制器在屏蔽所述开机激活信号后检测到外部设备在位，而解除针对所述中央处理器的信号屏蔽。6.根据权利要求2所述的方法，其特征在于，响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号包括：所述热插拔控制器响应于检测到所述状态指示器处于断开状态并且从所述通知器接收到所述热插拔信号，而向所述中央处理器发送所述热插信号；响应于状态指示器处于连接状态并且触发通知器，而通过所述热插拔控制器向中央处理器发送热拔信号包括：所述热插拔控制器响应于检测到所述状态指示器处于连接状态并且从所述通知器接收到所述热插拔信号，而向所述中央处理器发送所述热拔信号。7.根据权利要求2所述的方法，其特征在于，还包括执行以下步骤：响应于所述中央处理器下电，而由所述热插拔控制器识别并将外部设备的工作状态存储到所述热插拔控制器。8.根据权利要求7所述的方法，其特征在于，还包括执行以下步骤：响应于所述中央处理器重新上电并且所述热插拔控制器中存储的外部设备的工作状态为工作，而由所述热插拔控制器允许由所述中央处理器的发出启用供电使能信号和将所述状态指示器调整到过渡状态的开机激活信号为外部设备上电；响应于所述中央处理器重新上电并且所述热插拔控制器中存储的外部设备的工作状态为不工作，而由所述热插拔控制器屏蔽所述中央处理器发出的所述开机激活信号以不启用供电使能信号并且不将所述状态指示器调整到过渡状态。9.根据权利要求8所述的方法，其特征在于，还包括执行以下步骤：在由所述热插拔控制器屏蔽所述开机激活信号的同时，还由所述热插拔控制器生成并向所述中央处理器发送所述热拔信号以使所述中央处理器停用所述供电使能信号。10.一种外接设备的热插拔装置，其特征在于，包括：处理器；控制器，存储有所述处理器可运行的程序代码，所述处理器在运行所述程序代码时执行以下步骤：响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由所述中央处理器启用供电使能信号并通过所述热插拔控制器将所述状态指示器调整到过渡状态；响应于所述热插拔控制器检测到外部设备在位并且所述供电使能信号已启用，而基于外接设备协议使用所述供电使能信号为外部设备上电，由所述中央处理器在总线上与外部设备通信连接并通过所述热插拔控制器将所述状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过所述热插拔控制器向中央处理器发送热拔信号，由所述中央处理器停用所述供电使能信号并通过所述热插拔控制器将所述状态指示器调整到过渡状态；响应于所述热插拔控制器检测到外部设备在位并且所述供电使能信号已停用，而使用所述供电使能信号为外部设备下电，由所述中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过所述热插拔控制器将所述状态指示器调整到断开状态。
说明书desc
技术领域本发明涉及热插拔领域，更具体地，特别是指一种外接设备的热插拔方法和装置。背景技术目前服务器行业竞争日趋激烈，但服务器本身已经到达技术瓶颈，无法再提升产品的亮点及优势。基于此，服务器的外围设备不断涌现，用来完成灵活配置，实现不同的功能，而服务器本身也需要增加部分硬件线路及功能，对外围设备进行支持。OCP卡在现有技术中已经被广泛使用，其规范化及模块化设计增加了其通用性，其热插拔机制更增加了其易用性，因此OCP卡已然成为服务器的标配，但现有技术的OCP热插拔仍然存在问题。首先对于Windows系统，服务器开机时，无论OCP卡是否在位，CPU都会发出CPU Power EN信号，此时再插入OCP卡，在系统界面下，无法正常识别OCP卡。其次在观察到LED灯熄灭后，执行OCP热拔出动作时，概率性出现Linux系统崩溃及Windows系统蓝屏问题，其原因是LED虽然熄灭，但CPU与OCP卡之间的主线通信会概率性存在延时断开问题，此时强行拔出OCP卡，必然会存在问题。最后系统重新上电后，OCP卡若在位会默认上电，如果之前的使用设定是OCP卡暂时不工作，那便需要对每一台机器的OCP卡重新进行热拔操作，严重影响客户体验。针对现有技术中OCP卡热插拔机制的开机自动识别、热拔导致系统崩溃等的问题，目前尚无有效的解决方案。发明内容有鉴于此，本发明实施例的目的在于提出一种外接设备的热插拔方法和装置，能够解决OCP卡的热插拔机制所导致的开机自动识别和系统崩溃的问题，提升OCP卡的热插拔稳定性和便利性。基于上述目的，本发明实施例的第一方面提供了一种外接设备的热插拔方法，包括执行以下步骤：响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已启用，而基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已停用，而使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态。在一些实施方式中，通知器连接到热插拔控制器，并配置为响应于被触发而向热插拔控制器发送热插拔信号。在一些实施方式中，方法还包括执行以下步骤：响应于中央处理器上电时发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号并且热插拔控制器检测到外部设备不在位，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，方法还包括执行以下步骤：在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。在一些实施方式中，方法还包括执行以下步骤：响应于热插拔控制器在屏蔽开机激活信号后检测到外部设备在位，而解除针对中央处理器的信号屏蔽。在一些实施方式中，响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号包括：热插拔控制器响应于检测到状态指示器处于断开状态并且从通知器接收到热插拔信号，而向中央处理器发送热插信号；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号包括：热插拔控制器响应于检测到状态指示器处于连接状态并且从通知器接收到热插拔信号，而向中央处理器发送热拔信号。在一些实施方式中，方法还包括执行以下步骤：响应于中央处理器下电，而由热插拔控制器识别并将外部设备的工作状态存储到热插拔控制器。在一些实施方式中，方法还包括执行以下步骤：响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为工作，而由热插拔控制器允许由中央处理器的发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号为外部设备上电；响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为不工作，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，方法还包括执行以下步骤：在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。本发明实施例的第二方面提供了一种装置，包括：处理器；控制器，存储有处理器可运行的程序代码，处理器在运行程序代码时执行以下步骤：响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已启用，而基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已停用，而使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态。在一些实施方式中，通知器连接到热插拔控制器，并响应于被触发而向热插拔控制器发送热插拔信号。在一些实施方式中，步骤还包括：响应于中央处理器上电时发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号并且热插拔控制器检测到外部设备不在位，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，步骤还包括：在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。在一些实施方式中，步骤还包括：响应于热插拔控制器在屏蔽开机激活信号后检测到外部设备在位，而解除针对中央处理器的信号屏蔽。在一些实施方式中，响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号包括：热插拔控制器响应于检测到状态指示器处于断开状态并且从通知器接收到热插拔信号，而向中央处理器发送热插信号；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号包括：热插拔控制器响应于检测到状态指示器处于连接状态并且从通知器接收到热插拔信号，而向中央处理器发送热拔信号。在一些实施方式中，步骤还包括：响应于中央处理器下电，而由热插拔控制器识别并将外部设备的工作状态存储到热插拔控制器。在一些实施方式中，步骤还包括：响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为工作，而由热插拔控制器允许由中央处理器的发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号为外部设备上电；响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为不工作，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，步骤还包括：在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。本发明具有以下有益技术效果：本发明实施例提供的外接设备的热插拔方法和装置，通过响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已启用，而基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已停用，而使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态的技术方案，能够解决OCP卡的热插拔机制所导致的开机自动识别和系统崩溃的问题，提升OCP卡的热插拔稳定性和便利性。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明提供的外接设备的热插拔方法的流程示意图；图2为本发明提供的外接设备的热插拔方法的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚明白，以下结合具体实施例，并参照附图，对本发明实施例进一步详细说明。需要说明的是，本发明实施例中所有使用“第一”和“第二”的表述均是为了区分两个相同名称非相同的实体或者非相同的参量，可见“第一”“第二”仅为了表述的方便，不应理解为对本发明实施例的限定，后续实施例对此不再一一说明。基于上述目的，本发明实施例的第一个方面，提出了一种解决OCP卡的热插拔机制所导致的开机自动识别和系统崩溃的问题，提升OCP卡的热插拔稳定性和便利性的外接设备的热插拔方法的一个实施例。图1示出的是本发明提供的外接设备的热插拔方法的流程示意图。所述的外接设备的热插拔方法，如图1所示，包括执行以下步骤：步骤S101，响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；步骤S103，响应于热插拔控制器检测到外部设备在位并且供电使能信号已启用，而基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；步骤S105，响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；步骤S107，响应于热插拔控制器检测到外部设备在位并且供电使能信号已停用，而使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态。本发明实施例使用CPLD作为热插拔控制器来识别通知器状态并通过I2C发给CPU，同时解析CPU的I2C以识别CPU发出的PowerEN信号，对OCP卡的上下电进行操作，并对LED的状态进行控制。此外，CPLD内部的UFM可以记录系统断电时OCP卡的工作状态，并在系统再次上电后，控制OCP卡恢复到上一次工作状态，客户通过通知器重新设定OCP卡的工作状态，从而大大增加了客户体验。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，可以通过计算机程序来指令相关硬件来完成，所述的程序可存储于一计算机可读取存储介质中，该程序在执行时，可包括如上述各方法的实施例的流程。其中，所述的存储介质可为磁碟、光盘、只读存储记忆体或随机存储记忆体等。所述计算机程序的实施例，可以达到与之对应的前述任意方法实施例相同或者相类似的效果。在一些实施方式中，通知器连接到热插拔控制器，并配置为响应于被触发而向热插拔控制器发送热插拔信号。在一些实施方式中，方法还包括执行以下步骤：响应于中央处理器上电时发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号并且热插拔控制器检测到外部设备不在位，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，方法还包括执行以下步骤：在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。在一些实施方式中，方法还包括执行以下步骤：响应于热插拔控制器在屏蔽开机激活信号后检测到外部设备在位，而解除针对中央处理器的信号屏蔽。在一些实施方式中，响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号包括：热插拔控制器响应于检测到状态指示器处于断开状态并且从通知器接收到热插拔信号，而向中央处理器发送热插信号；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号包括：热插拔控制器响应于检测到状态指示器处于连接状态并且从通知器接收到热插拔信号，而向中央处理器发送热拔信号。在一些实施方式中，方法还包括执行以下步骤：响应于中央处理器下电，而由热插拔控制器识别并将外部设备的工作状态存储到热插拔控制器。在一些实施方式中，方法还包括执行以下步骤：响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为工作，而由热插拔控制器允许由中央处理器的发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号为外部设备上电；响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为不工作，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，方法还包括执行以下步骤：在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。下面根据图2所示的具体实施例进一步阐述本发明的具体实施方式。参见图2，本发明实施例使用CPLD作为热插拔控制器，使用按钮作为通知器来向CPLD发出用户的热插拔指令，使用LED作为状态指示器来显示OCP卡的工作状态。CPLD内部示出的GPIO是按钮和LED连接使用的总线，并且CPLD和CPU之间使用I2C连接。本发明实施例的CPLD在其内部模拟现有技术中使用的IO Expander芯片功能，能够将Button状态发送给CPU，同时可以解析I2C获取CPU Power EN信号及LED状态。对于Windows系统，如果服务器开机时OCP卡不在位，而CPU发出CPU Power EN信号及LED信号，则CPLD会进行屏蔽，不会给OCP卡上电，也不会点亮LED灯。同时，CPLD在发送给CPU的I2C中会模拟Hotplug signal，通知CPU控制CPU Power EN信号变为无效；之后在OCP卡插入后，CPLD不再进行信号屏蔽，此时可以通过Button完成OCP卡的正常热插入操作。本发明实施例的LED灯可以有三种状态：熄灭、闪烁、拔出，分别对应前述的指示器处于断开状态、过渡状态、连接状态。在执行OCP热拔出动作时，CPLD会识别CPU发出的LED状态，当CPU发出的LED状态闪烁停止后，CPLD会在此基础上延时的闪烁时间后，再控制LED熄灭。此时CPU与OCP的主线通信已完全终止，拔出OCP卡。充分的延迟可以防止破坏CPU与OCP的主线通信。当系统断电时，CPLD会识别OCP卡的状态，并存入UFM中。“0”表示OCP卡断电，“1”表示OCP卡上电。系统重新上电后，CPLD读取UFM中的数据，若为“1”，则CPLD会正常识别CPU的控制信号，从而完成OCP卡的正常上电；若为“0”，则CPLD屏蔽CPU Power EN信号及LED信号，同时，模拟Hotplug signal，通知CPU控制CPU Power EN信号变为无效，从而保证OCP卡处于非工作状态。从上述实施例可以看出，本发明实施例提供的外接设备的热插拔方法，通过响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已启用，而基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已停用，而使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态的技术方案，能够解决OCP卡的热插拔机制所导致的开机自动识别和系统崩溃的问题，提升OCP卡的热插拔稳定性和便利性。需要特别指出的是，上述外接设备的热插拔方法的各个实施例中的各个步骤均可以相互交叉、替换、增加、删减，因此，这些合理的排列组合变换之于外接设备的热插拔方法也应当属于本发明的保护范围，并且不应将本发明的保护范围局限在所述实施例之上。基于上述目的，本发明实施例的第二个方面，提出了一种解决OCP卡的热插拔机制所导致的开机自动识别和系统崩溃的问题，提升OCP卡的热插拔稳定性和便利性的外接设备的热插拔装置的一个实施例。装置包括：处理器；控制器，存储有处理器可运行的程序代码，处理器在运行程序代码时执行以下步骤：响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已启用，而基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已停用，而使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态。在一些实施方式中，通知器连接到热插拔控制器，并配置为响应于被触发而向热插拔控制器发送热插拔信号。在一些实施方式中，步骤还包括：响应于中央处理器上电时发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号并且热插拔控制器检测到外部设备不在位，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。在一些实施方式中，步骤还包括：响应于热插拔控制器在屏蔽开机激活信号后检测到外部设备在位，而解除针对中央处理器的信号屏蔽。在一些实施方式中，响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号包括：热插拔控制器响应于检测到状态指示器处于断开状态并且从通知器接收到热插拔信号，而向中央处理器发送热插信号；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号包括：热插拔控制器响应于检测到状态指示器处于连接状态并且从通知器接收到热插拔信号，而向中央处理器发送热拔信号。在一些实施方式中，步骤还包括：响应于中央处理器下电，而由热插拔控制器识别并将外部设备的工作状态存储到热插拔控制器。在一些实施方式中，步骤还包括：响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为工作，而由热插拔控制器允许由中央处理器的发出启用供电使能信号和将状态指示器调整到过渡状态的开机激活信号为外部设备上电；响应于中央处理器重新上电并且热插拔控制器中存储的外部设备的工作状态为不工作，而由热插拔控制器屏蔽中央处理器发出的开机激活信号以不启用供电使能信号并且不将状态指示器调整到过渡状态。在一些实施方式中，步骤还包括：在由热插拔控制器屏蔽开机激活信号的同时，还由热插拔控制器生成并向中央处理器发送热拔信号以使中央处理器停用供电使能信号。本发明例公开所述的装置、设备等可为各种电子终端设备，例如手机、个人数字助理、平板电脑、智能电视等，也可以是大型终端设备，如服务器等，因此本发明实施例公开的保护范围不应限定为某种特定类型的装置、设备。本发明实施例公开所述的客户端可以是以电子硬件、计算机软件或两者的组合形式应用于上述任意一种电子终端设备中。从上述实施例可以看出，本发明实施例提供的外接设备的热插拔装置，通过响应于状态指示器处于断开状态并且触发通知器，而通过热插拔控制器向中央处理器发送热插信号，由中央处理器启用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已启用，而基于外接设备协议使用供电使能信号为外部设备上电，由中央处理器在总线上与外部设备通信连接并通过热插拔控制器将状态指示器调整到连接状态；响应于状态指示器处于连接状态并且触发通知器，而通过热插拔控制器向中央处理器发送热拔信号，由中央处理器停用供电使能信号并通过热插拔控制器将状态指示器调整到过渡状态；响应于热插拔控制器检测到外部设备在位并且供电使能信号已停用，而使用供电使能信号为外部设备下电，由中央处理器在总线上与外部设备通信断开并在预定长度的时间延迟后通过热插拔控制器将状态指示器调整到断开状态的技术方案，能够解决OCP卡的热插拔机制所导致的开机自动识别和系统崩溃的问题，提升OCP卡的热插拔稳定性和便利性。需要特别指出的是，上述装置的实施例采用了所述外接设备的热插拔方法的实施例来具体说明各模块的工作过程，本领域技术人员能够很容易想到，将这些模块应用到所述外接设备的热插拔方法的其他实施例中。当然，由于所述外接设备的热插拔方法实施例中的各个步骤均可以相互交叉、替换、增加、删减，因此，这些合理的排列组合变换之于所述装置也应当属于本发明的保护范围，并且不应将本发明的保护范围局限在所述实施例之上。以上是本发明公开的示例性实施例，但是应当注意，在不背离权利要求限定的本发明实施例公开的范围的前提下，可以进行多种改变和修改。根据这里描述的公开实施例的方法权利要求的功能、步骤和/或动作不需以任何特定顺序执行。此外，尽管本发明实施例公开的元素可以以个体形式描述或要求，但除非明确限制为单数，也可以理解为多个。所属领域的普通技术人员应当理解：以上任何实施例的讨论仅为示例性的，并非旨在暗示本发明实施例公开的范围被限于这些例子；在本发明实施例的思路下，以上实施例或者不同实施例中的技术特征之间也可以进行组合，并存在如上所述的本发明实施例的不同方面的许多其它变化，为了简明它们没有在细节中提供。因此，凡在本发明实施例的精神和原则之内，所做的任何省略、修改、等同替换、改进等，均应包含在本发明实施例的保护范围之内。
