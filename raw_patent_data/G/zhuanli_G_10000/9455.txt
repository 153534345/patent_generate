标题title
一种基于离散-连续混合法的多节点储能系统配置方法
摘要abst
本发明涉及一种基于离散‑连续混合法的多节点储能系统配置方法。包括以下步骤：在各节点典型日功率曲线下建立系统及经济模型，综合考虑系统运行性能和经济性得出离散‑连续混合法目标函数；充分考虑离散部分和连续部分，定义编码串的形式和数量，初始化编码串；对初始编码串进行排序，利用离散‑连续混合法进行编码串的迭代；达到最大迭代次数结束，求得使得目标函数最优的储能控制与选址配置。本发明专利综合考虑储能系统运行性能和经济性，考虑遗传算法容易与其他算法相结合、粒子群算法虽简单但不能有效解决离散问题等特点，结构简单，对储能系统的研究推广具有重要意义。
权利要求书clms
1.一种基于离散-连续混合法的多节点储能系统配置方法，其特征在于，包括如下过程：步骤1：在各节点典型日功率曲线下建立系统模型；具体包括：步骤1.1：根据各节点的功率情况建立系统模型；Pk＝Py+PBk，SOE＝SOE+PBk×Δt×η÷Qe，储能系统能量状态的限制：SOEL≤SOE≤SOEU，储能系统功率的限制：-Pe≤PBk≤Pe，储能系统初始购置成本的限制：CPPe+CQQe≤A，每日初始时段储能系统能量状态与结束时段储能系统能量状态相同限制：SOE＝SOE，电力系统节点编号为j，0≤j≤J，k为其中安装储能的节点，Pk为第t时刻k节点安装储能后的功率，Py为第t时刻k节点安装储能前的功率，PBk为第t时刻k节点储能系统的功率，SOE为第t时刻的储能系统能量状态，Δt为采样时间，η为储能系统充放电效率，Qe为储能系统额定容量，Pe为储能系统额定功率，Qe为储能系统额定容量，CP为储能系统单位功率造价，CQ为储能系统单位容量造价，A为储能系统初始购置成本上限，SOE为每日初始时刻储能系统能量状态，SOE为每日结束时刻储能系统能量状态，SOEL代表储能系统能量状态下限，SOEU代表储能系统能量状态下限；得出储能系统相关功率函数f1：Ts为每日采样的最初一个时刻，Te为每日采样的最后一个时刻；步骤1.2根据各节点的成本情况建立经济模型；储能系统的初始购置成本Cc：Cc＝CP×Pe+CQ×Qe，储能系统的运维成本Cy:Cy＝CPy×Pe+CQy×Qe，资金回收系数By：CPy为储能系统单位功率运维造价，CQy为储能系统单位容量运维造价，r为贴现率，Y为储能系统的运行年限，通过电池类型可知总的循环寿命，再由功率损耗可知等效的每日循环寿命，如用雨流计数法，用总的循环寿命除每日的循环寿命得出的值再除365，便可得到储能系统使用寿命年限；经济模型的约束条件：Pk＝Py+PBk，SOE＝SOE+PBk×Δt×η÷Qe，SOEL≤SOE≤SOEU，-Pe≤PBk≤PeCPPe+CQQe≤ASOE＝SOE；得出储能系统每日成本函数f2：f2＝÷365，步骤1.3：根据步骤1.1和步骤1.2得到的储能系统功率损耗函数以及储能系统每日成本函数，得到综合考虑系统运行性能和经济性且用于离散-连续混合法的目标函数f3：其中F表示与函数f1相关的系统功率损耗公式；步骤2：充分考虑离散部分和连续部分，定义编码串的形式和数量，初始化编码串；步骤2.1：充分考虑离散部分和连续部分，定义储能安装节点、该节点中储能额定功率及额定容量、该节点储能功率PBk，在第g次迭代中，编码串为编码串长度等于编码位数m+n，其中离散部分二进制编码串为离散部分二进制编码串长度等于编码位数n，到之间的二进制编码位对应储能所选节点，其取值为零到储能节点编号J的任意整数，1≤p≤n-1，到之间的二进制编码位对应到之间的二进制编码位所对应的节点安装储能的额定功率及额定容量，需满足n-p为偶数，额定功率及额定容量取值均为零到连续部分编码串长度为其中bkd为该安装储能的k节点的第d时刻的储能系统的功率，初始随机生成S个编码串步骤2.2初始化编码串的最大迭代次数、选择率、交叉率、变异率、粒子速度和位置等；步骤3：对初始编码串进行排序，利用离散-连续混合法进行编码串的迭代；步骤4：达到最大迭代次数结束，求得使得目标函数最优的储能控制与选址配置。2.根据权利要求1所述一种基于离散-连续混合法的多节点储能系统配置方法，其特征在于，所述步骤2.2包括如下过程：步骤2.2.1：初始化编码串的最大迭代次数G，初始化离散部分交叉率Pc、变异率Pm，设定学习因子C1和C2、惯性权重w，初始化连续部分粒子的速度和位置，第d维度位置矢量代表第d时刻的储能系统的功率，第d维度速度矢量代表第d时刻的储能系统的功率的改变量，约束条件如下：粒子位置限制：为粒子f在第j次迭代中第d维的位置，xmin为位置的最小值，对应-Pe，由离散部分可知-Pe，xmax为位置的最大值，对应Pe，由离散部分可知Pe，粒子速度限制：为粒子f在第j次迭代中第d维的速度，vmin为速度的最小值，vmax为速度的最大值；步骤2.2.2：根据编码串编码位数值选择对应的储能安装节点、该节点中储能额定功率及额定容量、该节点储能功率PBk，代入步骤1所建立的系统及经济模型的约束条件，判断随机生成的F个初始编码串是否满足约束条件，然后去掉不满足约束条件的编码串并再次随机产生与去掉的编码串数目相同的编码串，直到F个编码串全部判断满足约束条件为止，初始化迭代次数为0，即g＝0。3.根据权利要求1所述一种基于离散-连续混合法的多节点储能系统配置方法，其特征在于，所述步骤3包括如下过程：步骤3.1：得到F个全部满足约束条件的编码串后，根据编码位数值选择对应的储能安装节点及该节点储能额定容量、额定功率、该节点储能功率PBk，代入f3，计算F个编码串对应的函数值，若则对应储能选址节点数的二进制编码串大于的部分默认对应储能节点0，按目标函数进行优劣排序；步骤3.2：每次编码串进行迭代时，分成离散部分和连续部分迭代，连续部分迭代使用粒子群算法的速度更新、位置更新，离散部分迭代使用遗传算法的选择、交叉、变异，两部分均迭代完成且满足约束条件的编码串为下一代编码串。4.根据权利要求3所述一种基于离散-连续混合法的多节点储能系统配置方法，其特征在于，所述步骤3.2包括如下过程：步骤3.2.1：对按目标函数进行优劣排序的编码串进行迭代，分为离散部分迭代和连续部分迭代；步骤3.2.2：离散部分对粒子群按公式进行速度更新，按公式进行位置更新；为粒子f在第d维的个体极值点的位置，为整个种群在第d维的全局极值点的位置，r1、r2为0-1的随机数；步骤3.2.3：连续部分对各个二进制编码串的二进制编码位数值进行选择运算、交叉运算、变异运算；步骤3.2.4：判断离散部分、连续部分都迭代完成后的编码串是否满足步骤1建立的系统及经济模型的约束，然后去掉不满足约束的编码串并再次随机产生与去掉的编码串数目相同的编码串，直到F个编码串全部判断满足约束为止，此为一次完整迭代，迭代次数增加1，即g＝g+1。5.根据权利要求4所述一种基于离散-连续混合法的多节点储能系统配置方法，其特征在于，所述步骤4包括如下过程：步骤4.1：判断当前迭代次数是否达到最大迭代次数G，若是，则达到要求不再继续寻优，输出使系统运行性能和经济性最优的编码串，否则回到步骤3.2.1；步骤4.2：通过步骤4.1输出的编码串，进而得到电力系统其中一个节点的储能功率控制情况、储能安装节点、该节点的储能额定功率及额定容量。
说明书desc
技术领域：本发明涉及一种储能系统，进一步涉及一种基于离散-连续混合法的多节点储能系统配置方法。背景技术：对储能系统进行规划时需要考虑储能接入的位置是否恰当，储能作为一个双向电力元件，在电力系统中的接入位置会直接影响系统潮流流向，改变线路负载，影响网络损耗，影响系统的功率水平。所以，选择合理的布局来提高系统运行安全稳定性尤为关键。由于储能价格相对较高，所以选择合理的配置来提升储能应用的经济性水平也成为重要的研究内容。此外，近年来新能源装机规模不断提高，新能源发电具有随机性和间歇性，储能系统可以双向输出，且输出功率稳定、可控、动态响应速度较快，可以促进新能源消纳以及平抑新能源功率波动，并在新能源发电不足时为负荷持续供电，因此，综合考虑储能出力特性与经济性，对储能系统控制与选址配置方法进行研究，不仅对增强供电可靠性、提高电能质量以及促进新能源消纳有影响，而且从长远来看，更是对促进我国新能源产业发展、转变电力的发展方式等具有重要作用。发明内容：考虑经济性是实现储能技术推广应用的必然发展趋势，储能系统的应用受到技术经济性水平、市场环境与相关政策等因素的影响。储能成本来源可以包括:初始购置成本、运维成本等，可以此成本最低为目标来实现储能选址以及优化配置。本发明专利综合考虑储能系统运行性能和经济性，考虑遗传算法与其他算法相结合比较容易、粒子群算法虽简单但不能有效解决离散问题等特点，使用粒子群算法进行连续优化，实现对多节点储能系统的储能额定功率及额定容量配置。具体技术方案如下：一种基于离散-连续混合法的多节点储能系统配置方法，包括如下过程：步骤1：在各节点典型日功率曲线下建立系统模型；具体包括：步骤1.1：根据各节点的功率情况建立系统模型；Pk＝Py+PBk，SOE＝SOE+PBk×Δt×η÷Qe，储能系统能量状态的限制：SOEL≤SOE≤SOEU，储能系统功率的限制：-Pe≤PBk≤Pe，储能系统初始购置成本的限制：CPPe+CQQe≤A，每日初始时段储能系统能量状态与结束时段储能系统能量状态相同限制：SOE＝SOE，电力系统节点编号为j，0≤j≤J，k为其中安装储能的节点，Pk为第t时刻k节点安装储能后的功率，Py为第t时刻k节点安装储能前的功率，PBk为第t时刻k节点储能系统的功率，SOE为第t时刻的储能系统能量状态，Δt为采样时间，η为储能系统充放电效率，Qe为储能系统额定容量，Pe为储能系统额定功率，Qe为储能系统额定容量，CP为储能系统单位功率造价，CQ为储能系统单位容量造价，A为储能系统初始购置成本上限，SOE为每日初始时刻储能系统能量状态，SOE为每日结束时刻储能系统能量状态，SOEL代表储能系统能量状态下限，SOEU代表储能系统能量状态下限；得出储能系统相关功率函数f1：Ts为每日采样的最初一个时刻，Te为每日采样的最后一个时刻；步骤1.2根据各节点的成本情况建立经济模型；储能系统的初始购置成本Cc：Cc＝CP×Pe+CQ×Qe，储能系统的运维成本Cy:Cy＝CPy×Pe+CQy×Qe，资金回收系数By：CPy为储能系统单位功率运维造价，CQy为储能系统单位容量运维造价，r为贴现率，Y为储能系统的运行年限，通过电池类型可知总的循环寿命，再由功率损耗可知等效的每日循环寿命，如用雨流计数法，用总的循环寿命除每日的循环寿命得出的值再除365，便可得到储能系统使用寿命年限；经济模型的约束条件：Pk＝Py+PBk，SOE＝SOE+PBk×Δt×η÷Qe，SOEL≤SOE≤SOEU，-Pe≤PBk≤PeCPPe+CQQe≤ASOE＝SOE；得出储能系统每日成本函数f2：f2＝÷365，步骤1.3：根据步骤1.1和步骤1.2得到的储能系统功率损耗函数以及储能系统每日成本函数，得到综合考虑系统运行性能和经济性且用于离散-连续混合法的目标函数f3：其中F表示与函数f1相关的系统功率损耗公式；步骤2：充分考虑离散部分和连续部分，定义编码串的形式和数量，初始化编码串；步骤2.1：充分考虑离散部分和连续部分，定义储能安装节点、该节点中储能额定功率及额定容量、该节点储能功率PBk，在第g次迭代中，编码串为编码串长度等于编码位数m+n，其中离散部分二进制编码串为离散部分二进制编码串长度等于编码位数n，到之间的二进制编码位对应储能所选节点，其取值为零到储能节点编号J的任意整数，1≤p≤n-1，到之间的二进制编码位对应到之间的二进制编码位所对应的节点安装储能的额定功率及额定容量，需满足n-p为偶数，额定功率及额定容量取值均为零到连续部分编码串长度为其中bkd为该安装储能的k节点的第d时刻的储能系统的功率，初始随机生成S个编码串e＝1,2,…,F；步骤2.2初始化编码串的最大迭代次数、选择率、交叉率、变异率、粒子速度和位置等；步骤3：对初始编码串进行排序，利用离散-连续混合法进行编码串的迭代；步骤4：达到最大迭代次数结束，求得使得目标函数最优的储能控制与选址配置。与最接近的现有技术相比，本发明的有益效果是：本发明技术方案中，借鉴粒子群算法中的速度更新、位置更新思想与遗传演化过程中的编码、选择、交叉以及变异思想，综合考虑储能系统运行性能和经济性，综合考虑遗传算法容易与其他算法相结合、粒子群算法虽简单但不能有效解决离散及组合优化问题等特点，每次编码串进行优化迭代时，分裂成离散部分和连续部分，使用粒子群算法进行连续部分迭代，而使用遗传算法进行离散部分迭代，各自迭代完成合成编码串为一次完整迭代，达到要求不再继续寻优时，输出使系统运行性能和经济性最优的编码串，进而实现电力系统其中一个节点的储能系统控制与选址配置，且构建单层模型，结构简单，有利于储能系统的研究推广。附图说明：图1是本发明方法流程图。图2是实施例中编码串示意图。图3是实施例中步骤2、步骤3、步骤4的过程流程示意图图4是实施例中遗传交叉运算过程示意图。图5是实施例中遗传变异运算过程示意图。具体实施方式：下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整描述。一种基于离散-连续混合法的多节点储能系统配置方法，包括如下过程：步骤1：在各节点典型日功率曲线下建立系统模型；具体包括：步骤1.1：根据各节点的功率情况建立系统模型；Pk＝Py+PBk，SOE＝SOE+PBk×Δt×η÷Qe，储能系统能量状态的限制：SOEL≤SOE≤SOEU，储能系统功率的限制：-Pe≤PBk≤Pe，储能系统初始购置成本的限制：CPPe+CQQe≤A，每日初始时段储能系统能量状态与结束时段储能系统能量状态相同限制：SOE＝SOE，电力系统节点编号为j，0≤j≤J，k为其中安装储能的节点，Pk为第t时刻k节点安装储能后的功率，Py为第t时刻k节点安装储能前的功率，PBk为第t时刻k节点储能系统的功率，SOE为第t时刻的储能系统能量状态，Δt为采样时间，η为储能系统充放电效率，Qe为储能系统额定容量，Pe为储能系统额定功率，Qe为储能系统额定容量，CP为储能系统单位功率造价，CQ为储能系统单位容量造价，A为储能系统初始购置成本上限，SOE为每日初始时刻储能系统能量状态，SOE为每日结束时刻储能系统能量状态，SOEL代表储能系统能量状态下限，SOEU代表储能系统能量状态下限；得出储能系统相关功率函数f1：Ts为每日采样的最初一个时刻，Te为每日采样的最后一个时刻；步骤1.2根据各节点的成本情况建立经济模型；储能系统的初始购置成本Cc：Cc＝CP×Pe+CQ×Qe，储能系统的运维成本Cy:Cy＝CPy×Pe+CQy×Qe，资金回收系数By：CPy为储能系统单位功率运维造价，CQy为储能系统单位容量运维造价，r为贴现率，Y为储能系统的运行年限，通过电池类型可知总的循环寿命，再由功率损耗可知等效的每日循环寿命，如用雨流计数法，用总的循环寿命除每日的循环寿命得出的值再除365，便可得到储能系统使用寿命年限；经济模型的约束条件：Pk＝Py+PBk，SOE＝SOE+PBk×Δt×η÷Qe，SOEL≤SOE≤SOEU，-Pe≤PBk≤PeCPPe+CQQe≤ASOE＝SOE；得出储能系统每日成本函数f2：f2＝÷365，步骤1.3：根据步骤1.1和步骤1.2得到的储能系统功率损耗函数以及储能系统每日成本函数，得到综合考虑系统运行性能和经济性且用于离散-连续混合法的目标函数f3：其中F表示与函数f1相关的系统功率损耗公式；步骤2：充分考虑离散部分和连续部分，定义编码串的形式和数量，初始化编码串；步骤2.1：充分考虑离散部分和连续部分，定义储能安装节点、该节点中储能额定功率及额定容量、该节点储能功率PBk，如图2所示，在第g次迭代中，编码串为编码串长度等于编码位数m+n，其中离散部分二进制编码串为离散部分二进制编码串长度等于编码位数n，到之间的二进制编码位对应储能所选节点，其取值为零到储能节点编号J的任意整数，1≤p≤n-1，到之间的二进制编码位对应到之间的二进制编码位所对应的节点安装储能的额定功率及额定容量，需满足n-p为偶数，额定功率及额定容量取值均为零到连续部分编码串长度为其中bkd为该安装储能的k节点的第d时刻的储能系统的功率，初始随机生成S个编码串e＝1,2,…,F；步骤2.2初始化编码串的最大迭代次数、选择率、交叉率、变异率、粒子速度和位置等；包括如下具体过程：步骤2.2.1：初始化编码串的最大迭代次数G，初始化离散部分交叉率Pc、变异率Pm，设定学习因子C1和C2、惯性权重w，初始化连续部分粒子的速度和位置，第d维度位置矢量代表第d时刻的储能系统的功率，第d维度速度矢量代表第d时刻的储能系统的功率的改变量，约束条件如下：粒子位置限制：为粒子f在第j次迭代中第d维的位置，xmin为位置的最小值，对应-Pe，由离散部分可知-Pe，xmax为位置的最大值，对应Pe，由离散部分可知Pe，粒子速度限制：为粒子f在第j次迭代中第d维的速度，vmin为速度的最小值，vmax为速度的最大值；步骤2.2.2：根据编码串编码位数值选择对应的储能安装节点、该节点中储能额定功率及额定容量、该节点储能功率PBk，代入步骤1所建立的系统及经济模型的约束条件，判断随机生成的F个初始编码串是否满足约束条件，然后去掉不满足约束条件的编码串并再次随机产生与去掉的编码串数目相同的编码串，直到F个编码串全部判断满足约束条件为止，初始化迭代次数为0，即g＝0；步骤3：对初始编码串进行排序，利用离散-连续混合法进行编码串的迭代；包括如下具体过程：步骤3.1：得到F个全部满足约束条件的编码串后，根据编码位数值选择对应的储能安装节点及该节点储能额定容量、额定功率、该节点储能功率PBk，代入f3，计算F个编码串对应的函数值，若则对应储能选址节点数的二进制编码串大于的部分默认对应储能节点0，按目标函数进行优劣排序；步骤3.2：每次编码串进行迭代时，分成离散部分和连续部分迭代，连续部分迭代使用粒子群算法的速度更新、位置更新，离散部分迭代使用遗传算法的选择、交叉、变异，两部分均迭代完成且满足约束条件的编码串为下一代编码串；如图3所示，包括如下具体过程：步骤3.2.1：对按目标函数进行优劣排序的编码串进行迭代，分为离散部分迭代和连续部分迭代；步骤3.2.2：离散部分对粒子群按公式进行速度更新，按公式进行位置更新；为粒子f在第d维的个体极值点的位置，为整个种群在第d维的全局极值点的位置，r1、r2为0-1的随机数；步骤3.2.3：连续部分对各个二进制编码串的二进制编码位数值进行选择运算、交叉运算、变异运算，如图4、图5所示；步骤3.2.4：判断离散部分、连续部分都迭代完成后的编码串是否满足步骤1建立的系统及经济模型的约束，然后去掉不满足约束的编码串并再次随机产生与去掉的编码串数目相同的编码串，直到F个编码串全部判断满足约束为止，此为一次完整迭代，迭代次数增加1，即g＝g+1；步骤4：达到最大迭代次数结束，求得使得目标函数最优的储能控制与选址配置，包括如下具体过程：步骤4.1：判断当前迭代次数是否达到最大迭代次数G，若是，则达到要求不再继续寻优，输出使系统运行性能和经济性最优的编码串，否则回到步骤3.2.1；步骤4.2：通过步骤4.1输出的编码串，进而得到电力系统其中一个节点的储能功率控制情况、储能安装节点、该节点的储能额定功率及额定容量。
