标题title
一种基于多数据源的电网气象预警系统
摘要abst
一种基于多数据源的电网气象预警系统，包括数据解析层、数据存储层、数据分析层以及数据应用层：数据解析层进行数据的下载与解析，将解析后的数据存储至所述数据存储层中对应的数据库；数据分析层从所述数据存储层调用所需数据进行逻辑处理，并将结果发送至所述数据应用层进行展示与应用。本发明的系统可结合运用多种数据进行更加精准的解析与预警，其中数据分析层结合多种数据源判断气象灾害与设备故障关联敏感性，山火对路线影响分析模型使用多种数据对山火情况进行分析，同时可应用改进的覆冰舞动天气与设备故障关联分析模型对覆冰舞动天气与设备故障进行预警，实现更加准确的多功能电网气象预警。
权利要求书clms
1.一种基于多数据源的电网气象预警系统，包括数据解析层、数据存储层、数据分析层以及数据应用层，其特征在于：所述数据解析层进行数据的下载与解析，将解析后的数据存储至所述数据存储层中对应的数据库；所述数据分析层从所述数据存储层调用所需数据进行逻辑处理，并将结果发送至所述数据应用层进行展示与应用；所述数据解析层包括气象局数据下载服务、跨强隔离装置传输服务、气象局数据接收服务、常规天气数据解析服务、多种数值预报数据解析服务、强对流天气分析预警服务、雷达数据解析服务以及GIS展示数据处理服务；多种数值预报数据解析服务包括1KM数值预报数据解析服务以及9KM数值预报数据解析服务；所述数据存储层包括关系型数据库、实时数据库、文档数据库以及分布式列存数据库；所述数据分析层包括气象灾害与设备故障关联敏感性分析模型、覆冰舞动天气与设备故障关联分析模型以及山火对路线影响分析模型；所述数据应用层包含应用系统，该应用系统包括Web应用以及移动应用。2.根据权利要求1所述的一种基于多数据源的电网气象预警系统，其特征在于：所述气象局数据下载服务下载包括气象自动站监测数据、数值预报数据、气象雷达数据、输电线路地理信息数据、常规天气预报数据以及卫星云图数据的相关数据；所述跨强隔离装置传输服务将气象局数据接收服务下载的数据传输至信息内网服务器；所述气象局数据接收服务将卫星云图数据以及气象自动站监测数据存储至数据存储层的文档数据库；所述常规天气数据解析服务将常规天气预报数据解析为结构化天气预报数据，并将其存储至数据库存储层的关系型数据库中；所述多种数值预报数据解析服务根据不同划分精度将数值预报数据进行解析，并将解析后的基础数据存储至数据库存储层的关系型数据库中；解析后的基础数据包括预报发布时间以及预报时间；将解析后的预报格点数据存储至数据库存储层的分布式列式数据库；所述强对流天气分析预警服务将气象雷达数据与输电线路地理信息数据进行关联，得到输电线路的强降水预警结果，并将此结果存储至数据库存储层的关系型数据库；所述雷达数据解析服务对气象雷达数据进行解析后将解析结果存入数据库存储层的关系型数据库；所述GIS展示数据处理服务解析数值预报数据，并将所生成图像信息存入数据库存储层的实时数据库。3.根据权利要求1或2所述的一种基于多数据源的电网气象预警系统，其特征在于：所述关系型数据库由多张能互相联接的二维行列表格组成的数据库，是采用了关系模型来组织数据的数据库，用以存储解析后数据，这些数据包括常规天气预报数据、预报发布时间、预报时间、输电线路的强降水预警结果；所述实时数据库是一种非关系型数据库，用以存储包括GIS展示数据处理服务解析数值预报数据后的GIS图像信息；所述文档数据库中的文档是处理信息的基本单位，一个文档相当于关系型数据库中的一条记录；电网气象预警系统使用文档数据库存储包括卫星云图数据的非结构化文档数据；所述分布式列存数据库为常规的基于Hadoop的NoSQL数据库，用以存储解析后的预报格点数据。4.根据权利要求3所述的一种基于多数据源的电网气象预警系统，其特征在于：所述气象灾害与设备故障关联敏感性分析模型使用区域电网气象敏感指标以明确不同地区的输电线路故障风险与各种气象灾害间的敏感程度，以如下公式表示：其中，SRm为区域R关于气象条件m的电网气象敏感度指标；NR为区域R内的设备总数；nmi为统计期内区域R的设备i在气象条件m下故障的次数；nR为区域R内所有设备在统计期间内的故障总次数；其中m∈{冰雹、降水、大风}。5.根据权利要求4所述的一种基于多数据源的电网气象预警系统，其特征在于：根据SRm可计算出区域R中气象灾害与设备故障的主要因素，其计算方法为：PFR＝argmax其中，PFR为影响区域R内设备的主要气象灾害因素；argmax表示使电网气象敏感度指标SRm取得最大值时的气象灾害因素集合；根据PFR可以粗略判断当前的预报数据中潜在气象灾害对引起设备故障的可能性。6.根据权利要求5所述的一种基于多数据源的电网气象预警系统，其特征在于：所述覆冰舞动天气与设备故障关联分析模型采用B个分类器对先对历史覆冰舞动天气进行训练得到一个最终分类模型，再将数值预报数据以及常规天气预报数据中相关的预报气象数据输入至最终分类模型，根据分类结果判定覆冰舞动天气是否会造成设备故障。7.根据权利要求6所述的一种基于多数据源的电网气象预警系统，其特征在于：所述覆冰舞动天气与设备故障关联分析模型中的最终分类模型函数为：其中，FLQ表示对整体样本集X的最终分类模型；sgn表示符号函数，当sgn中的函数结果大于0时，为1，表示覆冰舞动天气与设备故障有关；当sgn中的函数结果小于或等于0时，为-1，表示覆冰舞动天气与设备故障无关；X＝{，，...，}，xQ表示第Q个历史气象特征向量，该向量包括风速、风向、温度和相对湿度；yQ＝{-1，1}表示第Q个气象特征向量对应的而类别标号，-1表示设备没有故障，1表示设备有故障；W为历史气象特征向量总数，Q表示历史气象特征向量的总数；Cb表示第b个在随机对样本集X进行抽样后得到的随机样本集Xb分类的分类器；ab为分类器Cb的系数：εb为分类器Cb的分类错误率：其中，Cb表示对随机样本集Xb中第ii个样本的分类结果，xii表示随机样本集Xb中第ii个样本，yii表示随机样本Xb中第ii个样本对应的类别标号；当Cb≠yii时，I≠yii)为1，否则为0；wb为对第ii个样本权值分布。8.根据权利要求7所述的一种基于多数据源的电网气象预警系统，其特征在于：所述wb初始化为：更新方法为：其中，是归一化因子。9.根据权利要求1或8所述的一种基于多数据源的电网气象预警系统，其特征在于：所述山火对路线影响分析模型根据气象自动站监测数据、数值预报数据、气象雷达数据、常规天气预报数据中对于24小时降水量、日最高气温、日最低气温、日最小相对湿度、日最大风速的预测以及日降水历史数据计算森林火险气象指数FFDI后查找其对应的森林火险气象等级FFDR值，如果FFDR是三级或以上，则认为山火情况会引起设备故障。10.根据权利要求1所述的一种基于多数据源的电网气象预警系统，其特征在于：所述数据应用层结合数据分析层的分析结果以及存入至数据存储层中实时数据库的GIS图像信息绘制与GIS信息对应的图层，并将图层叠加至对应的GIS地图上。
说明书desc
技术领域本发明属于电网气象领域，具体涉及一种基于多数据源的电网气象预警系统。背景技术电力气象技术涵盖了整个发电、输电、变电、用电环节的气象资源及气象信息利用技术。气象因素密切影响着水电、风电、光伏发电的出力；线路输电能力及输电安全也与气象条件密切相关；电力负荷也会因为春季农业灌溉、夏季空调制冷、冬季取暖等因素呈现明显的季节性波动。此外，电网气象风险预警的重要性在电网气象灾害频发的背景下正逐渐突显出来。而不同的气象灾害作用于电网的机理和冲击影响不相同，因此预警方法也有差别，对其中一些故障机理清晰、数据资料完整的气象灾害，可采用机理研究的方法，而对致电网故障机理较复杂的，或部分参数难以获取的气象灾害，可采用统计分析的方法实现预警。河南省电力公司建立了以输电线路舞动、风偏放电预警为主，并包含雷电、大风、污闪、线路地质灾害在内的风险预警方法及模型。不同的预警模型需要不同类型的气象和电力数据作为支撑，现阶段预警系统大多都只有强降水、大风等常规的预警信息，数据来源也比较单一，无法满足电网生产和运维需求，因此，提出一种基于多数据源的电网气象预警系统是十分必要的。发明内容为解决现有技术中存在的不足，本发明的目的在于，提供一种基于多数据源的电网气象预警系统。本发明采用如下的技术方案：一种基于多数据源的电网气象预警系统，包括数据解析层、数据存储层、数据分析层以及数据应用层，其特征在于：数据解析层进行数据的下载与解析，将解析后的数据存储至所述数据存储层中对应的数据库；所述数据分析层从所述数据存储层调用所需数据进行逻辑处理，并将结果发送至所述数据应用层进行展示与应用；数据解析层包括气象局数据下载服务、跨强隔离装置传输服务、气象局数据接收服务、常规天气数据解析服务、多种数值预报数据解析服务、强对流天气分析预警服务、雷达数据解析服务以及GIS展示数据处理服务；多种数值预报数据解析服务包括1KM数值预报数据解析服务以及9KM数值预报数据解析服务；数据存储层包括关系型数据库、实时数据库、文档数据库以及分布式列存数据库；数据分析层包括气象灾害与设备故障关联敏感性分析模型、覆冰舞动天气与设备故障关联分析模型以及山火对路线影响分析模型；数据应用层包含应用系统，该应用系统包括Web应用以及移动应用。气象局数据下载服务下载包括气象自动站监测数据、数值预报数据、气象雷达数据、输电线路地理信息数据、常规天气预报数据以及卫星云图数据的相关数据；跨强隔离装置传输服务将气象局数据接收服务下载的数据传输至信息内网服务器；气象局数据接收服务将卫星云图数据以及气象自动站监测数据存储至数据存储层的文档数据库；常规天气数据解析服务将常规天气预报数据解析为结构化天气预报数据，并将其存储至数据库存储层的关系型数据库中；多种数值预报数据解析服务根据不同划分精度将数值预报数据进行解析，并将解析后的基础数据存储至数据库存储层的关系型数据库中；解析后的基础数据包括预报发布时间以及预报时间；将解析后的预报格点数据存储至数据库存储层的分布式列式数据库；强对流天气分析预警服务将气象雷达数据与输电线路地理信息数据进行关联，得到输电线路的强降水预警结果，并将此结果存储至数据库存储层的关系型数据库；雷达数据解析服务对气象雷达数据进行解析后将解析结果存入数据库存储层的关系型数据库；GIS展示数据处理服务解析数值预报数据，并将所生成图像信息存入数据库存储层的实时数据库。关系型数据库由多张能互相联接的二维行列表格组成的数据库，是采用了关系模型来组织数据的数据库，用以存储解析后数据，这些数据包括常规天气预报数据、预报发布时间、预报时间、输电线路的强降水预警结果；实时数据库是一种非关系型数据库，用以存储包括GIS展示数据处理服务解析数值预报数据后的GIS图像信息；文档数据库中的文档是处理信息的基本单位，一个文档相当于关系型数据库中的一条记录；电网气象预警系统使用文档数据库存储包括卫星云图数据的非结构化文档数据；分布式列存数据库为常规的基于Hadoop的NoSQL数据库，用以存储解析后的预报格点数据。气象灾害与设备故障关联敏感性分析模型使用区域电网气象敏感指标以明确不同地区的输电线路故障风险与各种气象灾害间的敏感程度，以如下公式表示：其中，SRm为区域R关于气象条件m的电网气象敏感度指标；NR为区域R内的设备总数；Bmi为统计期内区域R的设备i在气象条件m下故障的次数；nR为区域R内所有设备在统计期间内的故障总次数；其中m∈{冰雹、降水、大风}。根据SRm可计算出区域R中气象灾害与设备故障的主要因素，其计算方法为：PFR＝argmax其中，PFR为影响区域R内设备的主要气象灾害因素；argmax表示使电网气象敏感度指标SRm取得最大值时的气象灾害因素集合；根据PFR可以粗略判断当前的预报数据中潜在气象灾害对引起设备故障的可能性。覆冰舞动天气与设备故障关联分析模型采用B个分类器对先对历史覆冰舞动天气进行训练得到一个最终分类模型，再将数值预报数据以及常规天气预报数据中相关的预报气象数据输入至最终分类模型，根据分类结果判定覆冰舞动天气是否会造成设备故障。覆冰舞动天气与设备故障关联分析模型中的最终分类模型函数为：其中，FLQ表示对整体样本集X的最终分类模型；sgn表示符号函数，当sgn中的函数结果大于0时，为1，表示覆冰舞动天气与设备故障有关；当sgn中的函数结果小于或等于0时，为-1，表示覆冰舞动天气与设备故障无关；X＝{，，…，}，xQ表示第Q个历史气象特征向量，该向量包括风速、风向、温度和相对湿度；yQ＝{-1，1}表示第Q个气象特征向量对应的而类别标号，-1表示设备没有故障，1表示设备有故障；W为历史气象特征向量总数，Q表示历史气象特征向量的总数；Cb表示第b个在随机对样本集X进行抽样后得到的随机样本集Xb分类的分类器；ab为分类器Cb的系数：εb为分类器Cb的分类错误率：其中，Cb表示对随机样本集Xb中第ii个样本的分类结果，xii表示随机样本集Xb中第ii个样本，yii表示随机样本Xb中第ii个样本对应的类别标号；当Cb≠yii时，I≠yii)为1，否则为0；wb为对第ii个样本权值分布。wb初始化为：更新方法为：其中，是归一化因子。山火对路线影响分析模型根据气象自动站监测数据、数值预报数据、气象雷达数据、常规天气预报数据中对于24小时降水量、日最高气温、日最低气温、日最小相对湿度、日最大风速的预测以及日降水历史数据计算森林火险气象指数FFDI后查找其对应的森林火险气象等级FFDR值，如果FFDR是三级或以上，则认为山火情况会引起设备故障。数据应用层结合数据分析层的分析结果以及存入至数据存储层中实时数据库的GIS图像信息绘制与GIS信息对应的图层，并将图层叠加至对应的GIS地图上。本发明的有益效果在于，与现有技术相比，本发明的系统可结合运用多种数据进行更加精准的解析与预警，其中数据分析层结合多种数据源判断气象灾害与设备故障关联敏感性，山火对路线影响分析模型使用多种数据对山火情况进行分析，同时可应用改进的覆冰舞动天气与设备故障关联分析模型对覆冰舞动天气与设备故障进行预警，实现更加准确的多功能电网气象预警。附图说明图1为本发明基于多数据源的电网气象预警系统的系统图。具体实施方式下面结合附图对本申请作进一步描述。以下实施例仅用于更加清楚地说明本发明的技术方案，而不能以此来限制本申请的保护范围。本发明公开了一种基于多数据源的电网气象预警系统，包括数据解析层、数据存储层、数据分析层以及数据应用层，具体结构图如图1所示。数据解析层进行数据的下载与解析，将解析后的数据存储至数据存储层中对应的数据库；数据分析层从数据存储层调用所需数据进行逻辑处理，并将结果发送至数据应用层进行展示与应用。数据解析层包括气象局数据下载服务、跨强隔离装置传输服务、气象局数据接收服务、常规天气数据解析服务、多种数值预报数据解析服务、强对流天气分析预警服务、雷达数据解析服务以及GIS展示数据处理服务。多种数值预报数据解析服务包括1KM数值预报数据解析服务以及9KM数值预报数据解析服务。气象局数据下载服务从中国气象局公共气象服务中心FTP服务器下载相关数据，这些数据包括气象自动站监测数据、数值预报数据、气象雷达数据、输电线路地理信息数据、常规天气预报数据以及卫星云图数据；跨强隔离装置传输服务将气象局数据接收服务下载的数据传输至信息内网服务器；气象局数据接收服务将卫星云图数据以及气象自动站监测数据存储至数据存储层的文档数据库；常规天气数据解析服务将常规天气预报数据解析为结构化天气预报数据，并将其存储至数据库存储层的关系型数据库中；多种数值预报数据解析服务根据不同划分精度将数值预报数据进行解析，并将解析后的基础数据存储至数据库存储层的关系型数据库中；解析后的基础数据包括预报发布时间以及预报时间；将解析后的预报格点数据存储至数据库存储层的分布式列式数据库；强对流天气分析预警服务将气象雷达数据与输电线路地理信息数据进行关联，得到输电线路的强降水预警结果，并将此结果存储至数据库存储层的关系型数据库；雷达数据解析服务对气象雷达数据进行解析后将解析结果存入数据库存储层的关系型数据库；GIS展示数据处理服务解析数值预报数据，并将所生成图像信息存入数据库存储层的实时数据库。数据存储层包括关系型数据库、实时数据库、文档数据库以及分布式列存数据库；关系型数据库由多张能互相联接的二维行列表格组成的数据库，是采用了关系模型来组织数据的数据库，最大特点就是事物的一致性，电网气象预警系统采用关系型数据库来存储解析后数据，这些数据包括常规天气预报数据、预报发布时间、预报时间、输电线路的强降水预警结果；实时数据库是一种非关系型数据库，其重要特性就是实时性，能够保证数据实时性和事务实时性，电网气象预警系统采用实时数据库存储包括GIS展示数据处理服务解析数值预报数据后的GIS图像信息；文档数据库区别于传统的其它数据库的是文档数据库中的文档是处理信息的基本单位，一个文档相当于关系型数据库中的一条记录；电网气象预警系统使用文档数据库存储包括卫星云图数据的非结构化文档数据；分布式列存数据库为常规的基于Hadoop的NoSQL数据库，用以存储解析后的预报格点数据；数据分析层包括气象灾害与设备故障关联敏感性分析模型、覆冰舞动天气与设备故障关联分析模型以及山火对路线影响分析模型；气象灾害与设备故障关联敏感性分析模型使用区域电网气象敏感指标以明确不同地区的输电线路故障风险与各种气象灾害间的敏感程度，计算方法如下：其中，SRm为区域R关于气象条件m的电网气象敏感度指标；NR为区域R内的设备总数；nmi为统计期内区域R的设备i在气象条件m下故障的次数；nR为区域R内所有设备在统计期间内的故障总次数。其中m∈{冰雹、降水、大风}。根据SRm可计算出区域R中气象灾害与设备故障的主要因素，其计算方法为：PFR＝argmax其中，PFR为影响区域R内设备的主要气象灾害因素；argmax表示使电网气象敏感度指标SRm取得最大值时的气象灾害因素集合。根据PFR可以粗略判断当前的预报数据中潜在气象灾害对引起设备故障的可能性。覆冰舞动天气与设备故障关联分析模型采用B个分类器对先对历史覆冰舞动天气进行训练得到一个最终分类模型，再将数值预报数据以及常规天气预报数据中相关的预报气象数据输入至最终分类模型，根据分类结果判定覆冰舞动天气是否会造成设备故障；该最终分类模型的函数为：其中，FLQ表示对整体样本集X的最终分类模型；sgn表示符号函数，当sgn中的函数结果大于0时，为1，表示覆冰舞动天气与设备故障有关；当sgn中的函数结果小于或等于0时，为-1，表示覆冰舞动天气与设备故障无关；X＝{，，…，}，xQ表示第Q个历史气象特征向量，该向量包括风速、风向、温度和相对湿度，历史气象特征向量皆为从自动站监测数据中得到的数据；yQ＝{-1，1}表示第Q个气象特征向量对应的而类别标号，-1表示设备没有故障，1表示设备有故障；W为历史气象特征向量总数，Q表示历史气象特征向量的总数；Cb表示第b个在随机对样本集X进行抽样后得到的随机样本集Xb分类的分类器；ab为分类器Cb的系数：εb为分类器Cb的分类错误率：其中，Cb表示对随机样本集Xb中第ii个样本的分类结果，xii表示随机样本集Xb中第ii个样本，yii表示随机样本Xb中第ii个样本对应的类别标号；当Cb≠yii时，I≠yii)为1，否则为0；wb为对第ii个样本权值分布，初始化为：更新方法为：其中，是归一化因子。山火对路线影响分析模型利用对山火风险的评估以分析对路线有可能带来的影响。山火对输电线路的影响主要是破坏导线的电气外绝缘，使击穿电压降低，从而引起线路放电，由于山火的持续时间较长，合闸成功比例通常较低。山火对路线影响分析模型根据气象自动站监测数据、数值预报数据、气象雷达数据、常规天气预报数据中对于24小时降水量、日最高气温、日最低气温、日最小相对湿度、日最大风速的预测以及日降水历史数据计算森林火险气象指数FFDI后查找其对应的森林火险气象等级FFDR值，如果FFDR是三级或以上，则认为山火情况会引起设备故障。数据应用层包含应用系统，该应用系统包括Web应用以及移动应用；在应用层面，建立电力气象系统，系统通过直观的展示方式、友好的交互界面、灵活的访问方式和丰富的信息资源，充分满足用户的电力气象应用需求。数据应用层结合数据分析层的分析结果以及存入至数据存储层中实时数据库的GIS图像信息绘制与GIS信息对应的图层，并将图层叠加至对应的GIS地图上。应用层反馈内容包括用户填报的现场舞动信息以及防汛信息；现场舞动信息包括舞动线路、舞动时间、舞动图片，防汛信息包括累计降雨量、防汛物资情况、站点编号、汇报人、预警消息、舞动图片。系统将反馈信息进行存储并可在将来进行读取与应用。本发明申请人结合说明书附图对本发明的实施示例做了详细的说明与描述，但是本领域技术人员应该理解，以上实施示例仅为本发明的优选实施方案，详尽的说明只是为了帮助读者更好地理解本发明精神，而并非对本发明保护范围的限制，相反，任何基于本发明的发明精神所作的任何改进或修饰都应当落在本发明的保护范围之内。
