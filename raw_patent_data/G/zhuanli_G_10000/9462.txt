标题title
基于基础材料分解的多能谱CT重建方法及计算机可读介质
摘要abst
本发明涉及一种基于基础材料分解的多能谱CT重建方法及计算机可读介质，其中多能谱CT重建方法包括：步骤1：获取由SS‑SXCT方法或CSXCT方法的测量数据；步骤2：获取基于基础材料分解BMD重构基础材料组分的系数图像和基础材料的质量衰减系数；步骤3：重建出多能谱CT图像。与现有技术相比，本发明具有重建图像质量好、图像伪影低等优点。
权利要求书clms
1.一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的多能谱CT重建方法包括：步骤1：获取由SS-SXCT方法或CSXCT方法的测量数据；步骤2：获取基于基础材料分解BMD重构基础材料组分的系数图像和基础材料的质量衰减系数；步骤3：重建出多能谱CT图像。2.根据权利要求1所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤1中SS-SXCT方法获取的测量数据为：经过物体衰减的X射线强度为：I1＝∫f1I0DexpdE,I2＝∫f2I0DexpdE,其中，f1和f2分别为两个滤波器的能谱透过率；I0为射线源的能谱强度；D为探测器的响应度，H为CT的系统矩阵，表示射线穿过的积分变换过程；exp为物体x的指数衰减。3.根据权利要求2所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤2具体为：首先获取基础材料的质量衰减系数，然后基于基础材料分解BMD重构获取基础材料组分的系数图像；两个滤波器的能谱透过率f1和f2在外完全重合，计算在区间内的伪单能谱强度：其中，E21为区间的X光子平均能量；对上式两边同时取对数，获得关于x的线性函数：采用F个滤波器进行滤波扫描时，得到的线性测量集合为：Y＝HY其中，K＝F-1；P为总的测量数；N2为离散表示后物体的像素数；将多能谱CT重建问题优化表示为：将线性衰减系数X分解为：X＝PT其中，为M种材料的质量衰减系数，为各个基础材料对应的质量密度；将多能谱CT重建问题转化为：求解获得基础材料组分系数图像P*。4.根据权利要求3所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤2中基础材料的质量衰减系数的获取方法为：查表获得基础材料在区间和的质量衰减系数，并构造扩展后的基础材料质量系数矩阵5.根据权利要求4所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤3具体为：利用步骤2所得到的基础材料组分系数图像P*和扩展后的基础材料质量系数矩阵T′，获得更多能谱区间的CT图像，即：6.根据权利要求1所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤1中CSXCT方法获取的测量数据为：在CSXCT中，一条投影路径上得到的积分测量表示为：I＝∫fI0DexpdE当使用F中滤波器进行滤波时，整个谱带被划分为F+1个区间，,,…,，将积分测量数据离散到F+1窄谱带，即：其中，和是每个投影路径的滤波器在F+1各区间的透过率；I＝I0⊙D是每个窄谱区间的初始射线强度，探测器的积分过程由最后的求和过程表示。7.根据权利要求6所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤2具体为：首先获取基础材料的质量衰减系数，然后获取基于基础材料分解BMD重构基础材料组分的系数图像；所述的基础材料的质量衰减系数的获取方法为：根据扫描对象的先验知识确定其基础材料，然后从NIST数据集中获取基础材料的X射线质量衰减系数；对于数据集中未包含的特殊复合材料，可以由其组成元素质量衰减系数的加权确定。8.根据权利要求7所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤2中基础材料组分的系数图像获取方法为：将多能谱CT重建问题优化表示为：其中，是每个投影路径的滤波器在F+1区间的透过率，I＝I0⊙D是每个窄谱区间的初始射线强度，探测器的积分过程由最后的求和过程表示；查表得到物体内基础材料在整个谱带上的质量衰减系数矩阵然后将基础材料分解X＝PT′代入，考虑每种基础材料质量密度图像的光滑性，引入全变差正则，将多能谱CT重建问题优化表示为：其中，P*为P的最优解；求解上述优化问题，获得最终的基础材料密度图像P*。9.根据权利要求8所述的一种基于基础材料分解的多能谱CT重建方法，其特征在于，所述的步骤3具体为：根据X＝PT'，计算原问题的最优解，即：10.一种计算机可读介质，其特征在于，所述的计算机可读介质中存储有如权利要求1～9中任一项所述的多能谱CT重建方法。
说明书desc
技术领域本发明涉及多能谱CT重建技术领域，尤其是涉及一种基于基础材料分解的多能谱CT重建方法及计算机可读介质。背景技术X射线计算断层成像能够在无损地获取扫描截面的内部结构信息，目前已广泛地用于医学诊断和工业检测领域。而能谱X射线断层成像能利用不同化学组分的物质对X射线的能谱衰减特性不同，进一步获得扫描物体的材料组分信息，可用于鉴别CT图像上具有相似灰度的物质。用于临床诊断时可区分造影和钙化；用于工业检测时可给出扫描件的材料组成；用于机场、火车站安检时可筛选出可疑的违禁物品。因此SXCT具有巨大的应用潜力。传统的获取SXCT的方式是采用多个具有不同管电压的X射线源进行扫描，或者采取具有X光子能量分辨能力的探测器，但是它们都造价昂贵，会极大的增加系统的制造成本。一种低成本的SXCT的实现范式是采用对射线源的能谱进行滤波编码的方式，获取类似于多电压扫描的测量。典型的实现方式有两种，第一种方式为采用具有相近原子序数的K-edge材料制成能谱滤波器，通过多次滤波扫描，并将所测到的衰减后射线强度两两相减，即可获得多个谱段的伪单能测量。由于测量过程需要多次扫描，这种CT也称为序列扫描SXCT，如图2所示，图2中不同颜色的三角形表示由不同滤波器调制后的扇束X射线。第二种方式通过将不同的滤波器嵌入到不同的X射线投影路径，将具有X射线能谱调制作用的编码孔径与传统CT相结合，经过编码的X射线穿过被扫描物体后，被探测器以积分测量的方式获取测量值，然后用于能谱CT图像重建。由于能谱测量信息是被探测器在整个能谱域上进行积分之后记录的，这种SXCT的实现方式也称为压缩能谱CT，如图3所示。由于现有的从能谱滤波中重建多能谱CT图像的方法本质上都是基于平衡滤波器的，因此得到的能谱图像通道数总是少于所用滤波器种类数，导致重建图像的质量较差。发明内容本发明的目的就是为了克服上述现有技术存在的缺陷而提供一种重建图像质量好的基于基础材料分解的多能谱CT重建方法及计算机可读介质。本发明的目的可以通过以下技术方案来实现：一种基于基础材料分解的多能谱CT重建方法，所述的多能谱CT重建方法包括：步骤1：获取由SS-SXCT方法或CSXCT方法的测量数据；步骤2：获取基础材料的质量衰减系数和基于基础材料分解BMD重构得到的基础材料组分的系数图像；步骤3：重建出多能谱CT图像。优选地，所述的步骤1中SS-SXCT方法获取的测量数据为：经过物体衰减的X射线强度为：I1＝∫f1I0DexpdE,I2＝∫f2I0DexpdE,其中，f1和f2分别为两个滤波器的能谱透过率；I0为射线源的能谱强度；D为探测器的响应度，H为CT的系统矩阵，表示射线穿过的积分变换过程；exp为物体x的指数衰减。更加优选地，所述的步骤2具体为：首先获取基于基础材料分解BMD重构基础材料组分的系数图像，然后获取基础材料的质量衰减系数；两个滤波器的能谱透过率f1和f2在外完全重合，计算在区间内的伪单能谱强度：其中，E21为区间的X光子平均能量；对上式两边同时取对数，获得关于x的线性函数：采用F个滤波器进行滤波扫描时，得到的线性测量集合为：Y＝HY其中，K＝F-1；P为总的测量数；N2为离散表示后物体的像素数；将多能谱CT重建问题优化表示为：将线性衰减系数X分解为：X＝PT其中，为M种材料的质量衰减系数，为各个基础材料对应的质量密度；将多能谱CT重建问题转化为：求解获得基础材料组分系数图像P*。更加优选地，所述的步骤2中基础材料的质量衰减系数的获取方法为：查表获得基础材料在区间和的质量衰减系数，并构造扩展后的基础材料质量系数矩阵更加优选地，所述的步骤3具体为：利用步骤2所得到的基础材料组分系数图像P*和扩展后的基础材料质量系数矩阵T′，获得更多能谱区间的CT图像，即：优选地，所述的步骤1中CSXCT方法获取的测量数据为：在CSXCT中，一条投影路径上得到的积分测量表示为：I＝∫fI0DexpdE当使用F中滤波器进行滤波时，整个谱带被划分为F+1个区间，,,…,，将积分测量数据离散到F+1窄谱带，即：Y＝F＝·1其中，和是每个投影路径的滤波器在F+1各区间的透过率；I＝I0⊙D是每个窄谱区间的初始射线强度，探测器的积分过程由最后的求和过程表示。更加优选地，所述的步骤2具体为：首先获取基础材料的质量衰减系数，然后获取基于基础材料分解BMD重构基础材料组分的系数图像；所述的基础材料的质量衰减系数的获取方法为：根据扫描对象的先验知识确定其基础材料，然后从NIST数据集中获取基础材料的X射线质量衰减系数；对于数据集中未包含的特殊复合材料，可以由其组成元素质量衰减系数的加权确定。更加优选地，所述的步骤2中基础材料组分的系数图像获取方法为：将多能谱CT重建问题优化表示为：其中，是每个投影路径的滤波器在F+1区间的透过率，I＝I0⊙D是每个窄谱区间的初始射线强度，探测器的积分过程由最后的求和过程表示；查表得到物体内基础材料在整个谱带上的质量衰减系数矩阵然后将基础材料分解X＝PT′代入，考虑每种基础材料质量密度图像的光滑性，引入全变差正则，将多能谱CT重建问题优化表示为：其中，P*为P的最优解；求解上述优化问题，获得最终的基础材料密度图像P*。更加优选地，所述的步骤3具体为：根据X＝PT'，计算原问题的最优解，即：一种计算机可读介质，所述的计算机可读介质中存储有上述任一项所述的多能谱CT重建方法。与现有技术相比，本发明具有以下有益效果：重建的图像质量好：本发明中的多能谱CT重建方法基于基础材料分解针对现有技术中常用的SS-SXCT方法和CSXCT方法进行多能谱CT重建，采用本发明的间接重构方法，可以额外获得两个区间的伪单能CT图像，以及基础材料的分布图像，有效提高重建图像的质量，减少图像伪影。附图说明图1为本发明实施例中具有相近原子序数的滤波器对Ce和Gd，80kV X射线的能谱滤波曲线；图2为本发明实施例中采用多滤波器序列扫描SS-SXCT的扫描过程示意图；图3为本发明实施例中采用多滤波器编码测量测量的C-SXCT的测量过程示意图；图4为本发明实施例中CT图像重建结果示意图；其中，图4到图4为用于测试的能谱CT图像；图4到图4为采用本发明所提出的BMD-SS-SXCT算法的能谱CT图像重建结果；图4到图4为采用本发明所提出的BMD-C-SXCT算法的能谱CT图像重建结果；图5为本发明实施例中材料密度图像重建结果示意图；其中，图5和图5均为用于测试的能谱CT图像的材料密度图像；图5和图5为采用本发明所提出的BMD-SS-SXCT算法的重建出的材料密度图像；图5和图5为采用本发明所提出的BMD-C-SXCT算法的重建出的材料密度图像。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都应属于本发明保护的范围。一种基于基础材料分解的多能谱CT重建方法，包括：步骤1：获取由SS-SXCT方法或CSXCT方法的测量数据；步骤2：获取基于基础材料分解BMD重构基础材料组分的系数图像和基础材料的质量衰减系数；步骤3：重建出多能谱CT图像。本发明所提出的用于计算编码SXCT的基于材料分解的重构方法可以用序列扫描SXCT即SS-SXCT和压缩能谱CT即CSXCT，方便起见，对应的重构方法分别简称为BMD-SS-SXCT和BMD-CSXCT。以下分别陈述在对应的具体实施方式：一、BMD-SS-SXCT步骤1：获取由SS-SXCT方法的测量数据在SS-SXCT中，给定两个滤波器分别在两次扫描中对X射线源的能谱进行调制，则测量到的经过物体衰减的X射线强度为：I1＝∫f1I0DexpdE,I2＝∫f2I0DexpdE,其中，f1和f2分别为两个滤波器的能谱透过率；I0为射线源的能谱强度；D为探测器的响应度，H为CT的系统矩阵，表示射线穿过的积分变换过程；exp为物体x的指数衰减。步骤2：首先获取基于基础材料分解BMD重构基础材料组分的系数图像，然后获取基础材料的质量衰减系数；如图1所示，在对应的K-edge区间，即之外的两个滤波器的透过光谱近乎完全重合，由于两个滤波器的能谱透过率曲线在两个K-edge能量区间之几乎外完全重合，当此区间很窄的情况下，可以得到该区间的伪单能谱强度测量为：其中，E21为区间的X光子平均能量；对上式两边同时取对数，获得关于x的线性函数：采用F个滤波器进行滤波扫描时，得到的线性测量集合为：Y＝HY其中，K＝F-1；P为总的测量数；N2为离散表示后物体的像素数；将多能谱CT重建问题优化表示为：显然，尽管当F种滤波器用于滤波时，整个谱带被划分为F+1个区间,,…,但直接求解仅能得到和Y谱带数相同的能谱CT图像，即,…。考虑到在很多CT检测场景下，能谱CT的扫描对象具有已知的组分，也就是可以将线性衰减系数X分解为：X＝PT其中，为M种材料的质量衰减系数，为各个基础材料对应的质量密度；将多能谱CT重建问题转化为：求解获得基础材料组分系数图像P*。基础材料的质量衰减系数的获取方法为：查表获得基础材料在区间和的质量衰减系数，并构造扩展后的基础材料质量系数矩阵步骤3：重建出多能谱CT图像利用步骤2所得到的基础材料组分系数图像P*和扩展后的基础材料质量系数矩阵T′，获得更多能谱区间的CT图像，即：二、BMD-CSXCT在CSXCT中，不同投影路径采用不同的滤波器，其中一条投影路径上得到的积分测量可以表示为：I＝∫fI0DexpdE考虑到当F种滤波器用于滤波时，整个谱带被划分为F+1个区间,,…,，可以将上式离散到这样F+1窄谱带便于求解拟问题。它可以表示为：Y＝F＝·1其中，和是每个投影路径的滤波器在F+1各区间的透过率；I＝I0⊙D是每个窄谱区间的初始射线强度，探测器的积分过程由最后的求和过程表示。步骤2：首先获取基础材料的质量衰减系数，然后获取基于基础材料分解BMD重构基础材料组分的系数图像；所述的基础材料的质量衰减系数的获取方法为：根据扫描对象的先验知识确定其基础材料，然后从NIST数据集中获取基础材料的X射线质量衰减系数；对于数据集中未包含的特殊复合材料，可以由其组成元素质量衰减系数的加权确定。基础材料组分的系数图像获取方法为：将多能谱CT重建问题优化表示为：查表得到物体内基础材料在整个谱带上的质量衰减系数矩阵然后将基础材料分解X＝PT′代入，考虑每种基础材料质量密度图像的光滑性，引入全变差正则，将多能谱CT重建问题优化表示为：其中，P*为P的最优解；求解上述优化问题，获得最终的基础材料密度图像P*；求解方法为：采用广义交替投影的方法求解问题，引入中间变量Q，通过如下交替优化的方式获得最终的解：s.t.Y＝·1其中t表示迭代次数。其中J为前向投影模型的雅可比矩阵其中上述问题是一个高维问题，无法通过直接求逆得到最优解。为此采用Baizilai-Borwein方法迭代求解。采用负梯度方向为下降方向：对应的迭代步长为：从而求解高斯牛顿方向的迭代过程可以表示为给定P，可以通过求解以下TV最小化去噪问题求解Q迭代更新P和Q，可以得到最终的基础材料密度图像P*。步骤3：重建出多能谱CT图像根据X＝PT'，计算原问题的最优解，完成多能谱CT图像重建，即：从图4和图5中可以看出所提出的方法重建的图像和原始图像相吻合，并具有较好的图像重建质量，验证了上述重建方法的有效性。本实施例还涉及一种计算机可读介质，该介质内存储有上述任一项图像重建方法。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到各种等效的修改或替换，这些修改或替换都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以权利要求的保护范围为准。
