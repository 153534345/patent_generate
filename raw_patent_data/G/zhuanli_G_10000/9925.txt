标题title
一种基于高层和低层特征交叉增强的变化检测方法及装置
摘要abst
本发明公开了一种基于高层和低层特征交叉增强的变化检测方法及装置，包括：通过交叉增强模块对交叉编码特征进行反复优化，即：将得到的低层变化特征与高层变化特征逐元素相乘得到表征能力更好的低层特征；将处理过的高层变化特征与低层变化特征逐元素相乘以更新高层特征；重复以上操作以提高特征的代表能力；在训练过程中分别对交叉编码层的变化检测预测结果计算损失并求和，再分别将交叉增强过程中不同阶段的高层、低层变化特征的输出计算损失并求和，与最终的变化检测结果的损失依次相加得到最终的损失；基于Pytorch深度学习网络框架进行训练，基于训练后的模型进行变化检测。本发明经过融合多层预测图，得到准确的变化结果。
权利要求书clms
1.一种基于高层和低层特征交叉增强的变化检测方法，其特征在于，所述方法包括：通过交叉增强模块对交叉编码特征进行反复优化，即：将得到的低层变化特征与高层变化特征逐元素相乘得到表征能力更好的低层特征；将处理过的高层变化特征与低层变化特征逐元素相乘以更新高层特征；重复以上操作以提高特征的代表能力；在训练过程中分别对交叉编码层的变化检测预测结果计算损失并求和，再分别将交叉增强过程中不同阶段的高层、低层变化特征的输出计算损失并求和，与最终的变化检测结果的损失依次相加得到最终的损失；基于Pytorch深度学习网络框架进行训练，基于训练后的模型进行变化检测。2.根据权利要求1所述的一种基于高层和低层特征交叉增强的变化检测方法，其特征在于，所述方法还包括：通过孪生卷积神经网络分别从参考图像和查询图像中提取卷积层模块输出的卷积特征，对卷积特征进行内编码与交叉编码操作，获取交叉编码特征。3.根据权利要求2所述的一种基于高层和低层特征交叉增强的变化检测方法，其特征在于，所述内编码操作为：其中，是X或Y的第i个卷积层模块的卷积特征；是X或Y的第i个卷积层模块输出的卷积特征经内编码模块后产生的内编码特征；cat为拼接操作，将与按通道进行拼接；φ为内编码操作，包括：卷积、批归一化和上采样操作。4.根据权利要求2所述的一种基于高层和低层特征交叉增强的变化检测方法，其特征在于，所述交叉编码操作为：其中，表示第i层的交叉编码特征；表示交叉编码模块的计算过程，abs表示计算两个特征间的绝对差异。5.根据权利要求2所述的一种基于高层和低层特征交叉增强的变化检测方法，其特征在于，所述重复以上操作以提高特征的代表能力为：其中，Bi表示双线性插值运算，可以改变特征的分辨率，⊙为元素乘法运算，FtHF为交叉增强操作迭代第t次时得到的高层特征，FtLF为交叉增强操作迭代第t次时得到的低层特征。6.根据权利要求1所述的一种基于高层和低层特征交叉增强的变化检测方法，其特征在于，所述最终的变化检测结果为：其中，T为交叉增强操作的迭代次数，为第T次生成的预测结果。7.根据权利要求1所述的一种基于高层和低层特征交叉增强的变化检测方法，其特征在于，所述最终的损失共由4个部分组成，公式如下：其中，依次代表Pi、PtHF、PtLF以及Pf的损失。8.一种基于高层和低层特征交叉增强的变化检测装置，其特征在于，所述装置包括：处理器和存储器，所述存储器中存储有程序指令，所述处理器调用存储器中存储的程序指令以使装置执行权利要求1-7中的任一项所述的方法步骤。9.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机程序，所述计算机程序包括程序指令，所述程序指令被处理器执行时使所述处理器执行权利要求1-7中的任一项所述的方法步骤。
说明书desc
技术领域本发明涉及变化检测领域，尤其涉及一种基于高层和低层特征交叉增强的变化检测方法及装置。背景技术图像的变化检测是计算机视觉领域的一个重要研究课题，其主要任务是对同一场景不同时刻所拍摄的图像进行处理，从而检测出两次观测中所捕获图像的变化区域，在资源监测、异常检测、视频监控及自动驾驶等领域有着广泛的应用。传统的变化检测方法采用人为设计的手工特征和优化算法。早期变化检测方法最常使用的是图像差值法。虽然基于图像差值的变化检测方法简单直观，但是需要选取合适的阈值将变化区域和未变化区域分割出来。此外一些复杂的特征例如：梯度、变化向量分析等方法也被引入到变化检测领域中。文献中证明了变化向量分析法在土地覆盖与土地状况的多光谱监测中具有潜在实用性。为了提高检测结果的鲁棒性，变化检测中又引入了更多复杂的模型。例如文献提出了利用马尔科夫数据融合方法合并小波特征和空间上下文以生成精确的变化；文献将变化检测建模为具有迭代耦合字典学习模型的重构问题；文献利用像素不变的联合字典通过重构误差来检测图像中的变化。为了克服光照、相机位姿的影响，以得到更好的变化检测结果，文献提出了规模从小到大的图像对齐、照明校正和基于低秩变化检测的联合优化。还可以在图像对齐和校正照明后使用图像差值法，如文献。尽管传统的变化检测方法使用起来简单直观，但在现实场景应用中检测结果受光照和相机位姿等因素干扰较大。近年来，随着深度学习的迅猛发展，卷积神经网络在计算机视觉领域取得了巨大成功。目前，很多变化检测方法设计了不同的深度卷积神经网络体系结构，以克服相机位姿差异和光照的干扰，使检测结果具有较好的鲁棒性。例如文献设计了一种只有两个卷积层和一个全连接层的小型网络，用以检测28×28的图像对是否发生变化。训练后可以使用滑动窗口生成一个全分辨率预测。文献通过卷积神经网络处理海啸来临前后建筑物的航拍图像，以判断建筑物的损害情况。但以上方法仅是模型的输入不同，但其基础网络结构都是通过堆叠多个卷积层实现。除卷积神经网络外，一些其他方法也被应用到了变化检测中，例如：生成对抗网络、循环卷积神经网络和长短期记忆网络。实际上，上述大部分基于深度学习的变化检测方法仅仅是引入网络结构的不同。然而，如何设计高效的变化检测网络仍然是一个开放的问题。本方法将特征交叉增强的思想引入到变化检测中，在保证更好地描述图像变化的同时，对光照、相机位姿差异和季节变化具有较好的鲁棒性，得到更接近真实变化的预测结果。参考文献R.D.Johnson,E.Kasischke,Change vector analysis:A technique for themultispectral monitoring of land cover and condition,International Journal ofRemote Sensing 19411–426.G.Moser,E.Angiati,S.B.Serpico,Multiscale unsupervised changedetection on optical images by markov random fifields and wavelets,IEEEGeoscience and Remote Sensing Letters 8725–729.M.Gong,P.Zhang,L.Su,J.Liu,Coupled dictionary learning for changedetection from multisource data,IEEE Transactions on Geoscience and Remotesensing 547077–7091.X.Lu,Y.Yuan,X.Zheng,Joint dictionary learning for multispectralchange detection,IEEE transactions on cybernetics 47884–897.W.Feng,F.-P.Tian,Q.Zhang,N.Zhang,L.Wan,J.Sun,Fine-grained changedetection of misaligned scenes with varied illuminations,in:Proceedings ofthe IEEE International Conference on Computer Vision,2015,pp.1260–1268.S.Stent,R.Gherardi,B.Stenger,R.Cipolla,Precise deterministicchange detection for smooth surfaces,in:2016IEEE Winter Conference onApplications of Computer Vision,IEEE,2016,pp.1–9.A.Ding,Q.Zhang,X.Zhou,B.Dai,Automatic recognition of landslidebased on cnn and texture change detection,in:2016 31st Youth Academic AnnualConference of Chinese Association of Automation,IEEE,2016,pp.444–448.A.Fujita,K.Sakurada,T.Imaizumi,R.Ito,S.Hikosaka,R.Nakamura,Damagedetection from aerial images via convolutional neural networks,in:2017Fifteenth IAPR International Conference on Machine Vision Applications,IEEE,2017,pp.5–8.发明内容本发明提供了一种基于高层和低层特征交叉增强的变化检测方法及装置，本发明以VGG16为基础的孪生网络分别提取参考图像和查询图像的卷积特征，先后使用内编码与交叉编码技术得到两张图像间的多尺度差异特征，并将其划分为高层特征和低层特征，通过交叉增强的方法反复优化高层特征和低层特征；在不同层采用多层监督机制，逐层融合交叉编码中不同层及通过交叉增强后高层与低层特征的预测结果，用多层损失函数训练网络，详见下文描述：第一方面，一种基于高层和低层特征交叉增强的变化检测方法，所述方法包括：通过交叉增强模块对交叉编码特征进行反复优化，即：将得到的低层变化特征与高层变化特征逐元素相乘得到表征能力更好的低层特征；将处理过的高层变化特征与低层变化特征逐元素相乘以更新高层特征；重复以上操作以提高特征的代表能力；在训练过程中分别对交叉编码层的变化检测预测结果计算损失并求和，再分别将交叉增强过程中不同阶段的高层、低层变化特征的输出计算损失并求和，与最终的变化检测结果的损失依次相加得到最终的损失；基于Pytorch深度学习网络框架进行训练，基于训练后的模型进行变化检测。其中，所述方法还包括：通过孪生卷积神经网络分别从参考图像和查询图像中提取卷积层模块输出的卷积特征，对卷积特征进行内编码与交叉编码操作，获取交叉编码特征。第二方面，一种基于高层和低层特征交叉增强的变化检测装置，所述装置包括：处理器和存储器，所述存储器中存储有程序指令，所述处理器调用存储器中存储的程序指令以使装置执行第一方面的方法步骤。第三方面，一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序包括程序指令，所述程序指令被处理器执行时使所述处理器执行第一方面的方法步骤。本发明提供的技术方案的有益效果是：1、本发明设计的孪生卷积神经网络模型，不再是现有语义分割方法的简单延伸，利用该网络得到的图像差异特征检测变化，在PCD、VL-CMU-CD、和CDnet等数据集上检测性能优异；2、本发明设计出交叉增强模块，使用交叉增强的方法反复更新优化高层与低层特征，得到可以准确代表变化信息的多层特征；克服了照明和相机位姿差异，得到了鲁棒性更好的变化检测结果；3、本发明采用多层监督的方式，使得网络层找到图像的变化特征，并经过融合多层预测图，得到准确的变化结果。附图说明图1为本发明提出的基于高层和低层特征交叉增强的变化检测网络的示意图；图2为本发明提出方法和其他方法在公共数据集PCD上的检测结果示意图；图3为本发明提出方法和其他方法在公共数据集VL_CMU_CD上的检测结果示意图；图4为本发明提出方法和其他方法在公共数据集CDnet上的检测结果示意图；图5为基于高层和低层特征交叉增强的变化检测装置的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面对本发明实施方式作进一步地详细描述。本方法针对图像变化区域检测问题提出了基于高层和低层特征交叉增强的变化检测方法，通过反复对高层特征和低层特征交叉增强，得到具有较好鲁棒性的变化特征。实施例1一种基于高层和低层特征交叉增强的变化检测方法，参见图1，该方法包括以下步骤：一、构建孪生卷积神经网络参见图1，本方法中用于特征提取的孪生网络是以VGG16网络为基本结构的Unet网络，本发明将VGG 16的最后两个全连接层删除，只使用前五个卷积层模块。利用该网络分别从参考图像X和查询图像Y中提取5个卷积层模块输出的卷积特征。由于在两张图像上使用了独立的特征提取网络形成了本发明实施例所提及的孪生卷积神经网络。其中，VGG16网络结构主要包括：5个卷积层模块Conv1-Conv5、和两个全连接层模块FC6、FC7，VGG16网络结构为本领域技术人员所公知，本发明实施例对此不做赘述。二、将参考图像X与查询图像Y的卷积特征分别进行内编码与交叉编码操作其中，内编码模块包括：三个卷积单元，第一个卷积单元对之前得到的卷积特征进行上采样两次，再进行卷积、批归一化及ReLU操作。具体实现时，卷积、批归一化及ReLU操作均为本领域技术人员所公知，本发明实施例对此不做赘述。为了减少计算量，将第二个卷积单元中的卷积层的输入输出通道数减半。最后一个卷积单元中输出通道恢复为预先设定的通道数。通过上述处理，内编码模块可以提取到更鲁棒的语义特征，从而避免照明变化和摄像机位姿差异造成的干扰。在一种实施方式中，内编码模块公式如下：其中，是X或Y的第i个卷积层模块的卷积特征；是X或Y的第i个卷积层模块输出的卷积特征经内编码模块后产生的内编码特征；cat为拼接操作，将与按通道进行拼接；φ为内编码操作，包括：卷积、批归一化和上采样操作。需要注意的是的内编码特征将变化前后图像的内编码特征经过交叉编码模块，得到图像的绝对差异特征，能够准确反映每个特征层的变化。先将X和Y经过内编码操作后产生的5个内编码特征对应作差，得到5个不同层次的特征差异图。再将每一层的特征差异图与高一层特征差异图结合，得到有效性更高的交叉编码特征。交叉编码操作公式如下：其中，表示第i层的交叉编码特征；表示交叉编码模块的计算过程，abs表示计算两个特征间的绝对差异。需要注意的是第5层的交叉编码特征为交叉编码模块同样包含3个卷积单元，且每个卷积单元的操作与内编码模块相同，本发明实施例在此不做赘述。三、将5个交叉编码特征通过交叉增强模块进行反复优化由交叉编码模块到的5个交叉编码特征中，将特征进行拼接操作并输入到一个卷积单元，将通道数减少到128，得到低层变化特征。同样进行拼接操作通过一个卷积单元将通道数压缩为128，得到高层变化特征。其中，HF与LF的计算公式分别如下：其中，Conv表示卷积单元，该卷积单元由一个包含128个卷积核的卷积层，一个批归一化层和ReLU层构成。Bi表示双线性插值运算，可以改变特征的分辨率。由此得到的LF与HF特征逐元素相乘可得到表征能力更好的低层特征。同时，也将处理过的HF与LF特征相乘以更新高层特征。重复使用上一步，使最终所得到的结果包含高层语义信息以及低层纹理信息的同时，还可以避免单一高层特征或低层特征中噪声的影响。更新HF与LF特征的公式如下：其中，Bi表示双线性插值运算，可以改变特征的分辨率。⊙为元素乘法运算，为交叉增强操作迭代第t次时得到的高层特征，为交叉增强操作迭代第t次时得到的低层特征。另外，交叉增强的操作可以重复使用多次，以提高特征的代表能力，具体执行次数本发明实施例对此不做限制。四、变化结果预测在特征提取阶段由多尺度特征差异图得到的多尺度变化概率图P1-P5可由以下公式得到：其中，Conv为可以生成两张图像的卷积层，其中一张为变化概率图，另一张为未变化概率图。与只在网络末端生成预测概率图相比，添加对交叉编码特征的预测，可以得到更加贴近真实变化的预测值。第t次使用交叉增强操作时的LF和HF生成的预测结果及可由以下公式得到：为得到鲁棒性更好地变化预测结果，还需将Pi与拼接起来经过卷积。最终的变化检测结果可由以下公式计算：其中，T为交叉增强操作的迭代次数，为第T次生成的预测结果。需要注意的是，因为不同的预测图的分辨率不同，所以对所有预测图进行双线性上采样，调整其大小使得与参考图像X对齐。最后的预测结果由Pf的第一个通道产生。在训练过程中分别对特征提取网络中交叉编码层的五个变化检测预测结果P1-P5计算损失并求和，再分别将交叉增强过程中不同阶段的HF、LF特征的输出计算损失并求和，与最终的变化检测结果Pf的损失依次相加得到最终的损失最终的损失共由4个部分组成，公式如下：其中，依次代表Pi、以及Pf的损失。五、网络训练和测试基于Pytorch深度学习网络框架，训练第一步至第四步所提出的网络，可以在相应的数据集上得到一个训练好的网络模型。使用该网络模型，输入查询图像X和参考图像Y，经过网络计算后产生变化检测结果，流程结束。综上所述，本发明实施例通过孪生网络分别提取参考图像与查询图像的深度特征，通过内编码操作融合图像多尺度信息，通过交叉编码操作提取参考图像与查询图像间的多尺度差异特征，除最高层外当前层的变化差异特征都会融合上一层的变化差异特征。构建交叉增强模块，反复优化高层特征和低层特征。用多层损失函数训练网络，即得到具有准确变化信息又能克服照明和相机位姿差异的变化检测结果。实施例2下面结合图1、具体实例对实施例1中的方案进行进一步地介绍，详见下文描述：本发明实施例采用一种迭代的策略来反复更新高层和低层特征。使用低层特征增强高层特征，使得高层特征得到更多变化细节；使用高层特征增强低层特征，使得低层特征对光照、相机位姿差异和季节变化具有更好的鲁棒性。通过高层和低层特征之间的反复交叉增强，得到更贴近真实值的变化检测结果。具体地讲，根据其相应的原始特征提取层将得到的交叉编码特征分为高层和低层特征。通过高层和低层变化特征可以描述不同程度的变化。其中高层特征空间分辨率较小，但具有高度的语义抽象性，可以有效解决光照和相机位姿差异引起的非真实变化。而低层特征空间分辨率较高，图像细节丰富，可以显示清晰地变化边界。而仅使用其中之一并不能获得最好的变化结果。本方法中通过交叉特征增强模块，可以有效提高高层和低层特征的表征能力。综上所述，本发明实施例将交叉增强的方法引入到变化检测中，在保证更好地描述图像变化的同时，对光照、相机位姿差异和季节变化具有较好的鲁棒性，可以得到更接近真实变化的预测结果。实施例3下面结合图2-图4对实施例1和2中的方案进行可行性验证，详见下文描述：根据图1所示网络结构搭建本发明实施例中的网络基础学习率设为1e-3。将一次训练所抓取的数据样本数量设置为6，使用动量参数为0.9、权值衰减为0.999的Adam算法来更新网络参数。并在PCD、VL-CMU-CD和CDnet三个变化检测基准数据集来验证本方法。由图2、3、4可得，与其他方法相比，本发明实施例与ADCD网络均可以检测到更加细微的变化，比如树枝和电线杆。在图2的第4对图像中，本方法的检测结果比ADCD网络更准确，且在不同数据集上都取得了优异成果。实施例4基于同一发明构思，本发明实施例还提供了一种基于高层和低层特征交叉增强的变化检测装置，参见图5，该装置包括：处理器1和存储器2，存储器2中存储有程序指令，处理器1调用存储器2中存储的程序指令以使装置执行实施例中的以下方法步骤：通过孪生卷积神经网络分别从参考图像和查询图像中提取卷积层模块输出的卷积特征，对卷积特征进行内编码与交叉编码操作，获取交叉编码特征；通过交叉增强模块对交叉编码特征进行反复优化，即：将得到的低层变化特征与高层变化特征逐元素相乘得到表征能力更好的低层特征；将处理过的高层变化特征与低层变化特征逐元素相乘以更新高层特征；重复以上操作以提高特征的代表能力；在训练过程中分别对交叉编码层的变化检测预测结果计算损失并求和，再分别将交叉增强过程中不同阶段的高层、低层变化特征的输出计算损失并求和，与最终的变化检测结果的损失依次相加得到最终的损失；基于Pytorch深度学习网络框架进行训练，基于训练后的模型进行变化检测。最终的损失共由4个部分组成，公式如下：其中，依次代表Pi、以及Pf的损失。这里需要指出的是，以上实施例中的装置描述是与实施例中的方法描述相对应的，本发明实施例在此不做赘述。上述的处理器1和存储器2的执行主体可以是计算机、单片机、微控制器等具有计算功能的器件，具体实现时，本发明实施例对执行主体不做限制，根据实际应用中的需要进行选择。存储器2和处理器1之间通过总线3传输数据信号，本发明实施例对此不做赘述。实施例5基于同一发明构思，本发明实施例还提供了一种计算机可读存储介质，存储介质包括存储的程序，在程序运行时控制存储介质所在的设备执行上述实施例中的方法步骤。该计算机可读存储介质包括但不限于快闪存储器、硬盘、固态硬盘等。这里需要指出的是，以上实施例中的可读存储介质描述是与实施例中的方法描述相对应的，本发明实施例在此不做赘述。在上述实施例中，可以全部或部分地通过软件、硬件、固件或者其任意组合来实现。当使用软件实现时，可以全部或部分地以计算机程序产品的形式实现。计算机程序产品包括一个或多个计算机指令。在计算机上加载和执行所述计算机程序指令时，全部或部分地产生按照本发明实施例的流程或功能。计算机可以是通用计算机、专用计算机、计算机网络、或者其他可编程装置。计算机指令可以存储在计算机可读存储介质中，或者通过计算机可读存储介质进行传输。计算机可读存储介质可以是计算机能够存取的任何可用介质或者是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。可用介质可以是磁性介质或者半导体介质等。本发明实施例对各器件的型号除做特殊说明的以外，其他器件的型号不做限制，只要能完成上述功能的器件均可。本领域技术人员可以理解附图只是一个优选实施例的示意图，上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
