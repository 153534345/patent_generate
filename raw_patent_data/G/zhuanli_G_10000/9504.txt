标题title
一种通过消息驱动的刷新方法及刷新系统
摘要abst
本发明公开了一种通过消息驱动的刷新方法及刷新系统，步骤1：在前端用户登录后，开启心跳请求进程，定时发送请求到后端获取当前用户信息；步骤2：判断获取的当前用户信息中是否包含未读消息，若包含未读消息，则进行深入解析，根据未读消息的类型汇总到待刷新队列中；若不包含未读消息，则返回步骤1继续获取当前用户信息；步骤3：根据待刷新队列中未读消息的类型，确定刷新范围并对目标对象进行刷新。本发明通过模块的拆分与消息类型关联技术，形成了统一的规范，成功解决了显示内容和实际情况不一致、显示内容更新不及时等问题，此技术加载速度快，且不会打断当前用的行为，用户体验好。
权利要求书clms
1.一种通过消息驱动的刷新方法，其特征在于，包括以下步骤：步骤1：在前端用户登录后，开启心跳请求进程，定时发送请求到后端获取当前用户信息；步骤2：判断获取的当前用户信息中是否包含未读消息，若包含未读消息，则进行深入解析，根据未读消息的类型汇总到待刷新队列中；若不包含未读消息，则返回步骤1继续获取当前用户信息；步骤3：根据待刷新队列中未读消息的类型，确定刷新范围并对目标对象进行刷新。2.根据权利要求1所述的一种通过消息驱动的刷新方法，其特征在于：当待刷新的目标对象是单个元素时，通过该元素的数据接口发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该元素的显示效果。3.根据权利要求2所述的一种通过消息驱动的刷新方法，其特征在于：当待刷新的目标对象是多个元素时，遍历需要刷新的元素队列，依次执行单个元素的数据请求再渲染的操作。4.根据权利要求1所述的一种通过消息驱动的刷新方法，其特征在于：当待刷新的目标对象是单个栏目时，通过该栏目的已有参数发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该栏目的显示效果。5.根据权利要求4所述的一种通过消息驱动的刷新方法，其特征在于：当待刷新的目标对象是一个类型时，从当前空间里找到符合条件的栏目，然后再遍历需要刷新的队列，依次执行上述单个栏目的数据请求再渲染的操作。6.一种通过消息驱动的刷新系统，其特征在于，包括如下模块：模块M1：在前端用户登录后，开启心跳请求进程，定时发送请求到后端获取当前用户信息；模块M2：判断获取的当前用户信息中是否包含未读消息，若包含未读消息，则进行深入解析，根据未读消息的类型汇总到待刷新队列中；若不包含未读消息，则返回模块M1继续获取当前用户信息；模块M3：根据待刷新队列中未读消息的类型，确定刷新范围并对目标对象进行刷新。7.根据权利要求6所述的一种通过消息驱动的刷新系统，其特征在于：当待刷新的目标对象是单个元素时，通过该元素的数据接口发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该元素的显示效果。8.根据权利要求7所述的一种通过消息驱动的刷新系统，其特征在于：当待刷新的目标对象是多个元素时，遍历需要刷新的元素队列，依次执行单个元素的数据请求再渲染的操作。9.根据权利要求6所述的一种通过消息驱动的刷新系统，其特征在于：当待刷新的目标对象是单个栏目时，通过该栏目的已有参数发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该栏目的显示效果。10.根据权利要求9所述的一种通过消息驱动的刷新系统，其特征在于：当待刷新的目标对象是一个类型时，从当前空间里找到符合条件的栏目，然后再遍历需要刷新的队列，依次执行上述单个栏目的数据请求再渲染的操作。
说明书desc
技术领域本发明涉及通信技术领域，具体为一种通过消息驱动的刷新方法及刷新系统。背景技术现有的网站服务器使用的消息列表控件是一种全局刷新的控件，刷新一条新消息时需要刷新消息列表中所有可见的消息，同时每一条新消息刷新的次数是2次，一次是发送中状态的刷新，一次是发送成功状态的刷新，进而使得消息列表刷新的频率是页面可见消息数的2倍，由此可能会衍生诸如页面卡顿等问题，且会打断当前用户的行为，用户体验差。发明内容本发明的目的在于提供一种通过消息驱动的刷新方法及刷新系统，当接收到消息时，刷新门户、刷新导航菜单、刷新指定栏目的技术，目的在于及时准确的展示相关信息，做到无感更新，提升用户体验，以解决上述背景技术中提出的问题。为实现上述目的，本发明提供如下技术方案：一种通过消息驱动的刷新方法，包括以下步骤：步骤1：在前端用户登录后，开启心跳请求进程，定时发送请求到后端获取当前用户信息；步骤2：判断获取的当前用户信息中是否包含未读消息，若包含未读消息，则进行深入解析，根据未读消息的类型汇总到待刷新队列中；若不包含未读消息，则返回步骤1继续获取当前用户信息；步骤3：根据待刷新队列中未读消息的类型，确定刷新范围并对目标对象进行刷新。优选的，当待刷新的目标对象是单个元素时，通过该元素的数据接口发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该元素的显示效果。优选的，当待刷新的目标对象是多个元素时，遍历需要刷新的元素队列，依次执行单个元素的数据请求再渲染的操作。优选的，当待刷新的目标对象是单个栏目时，通过该栏目的已有参数发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该栏目的显示效果。优选的，当待刷新的目标对象是一个类型时，从当前空间里找到符合条件的栏目，然后再遍历需要刷新的队列，依次执行上述单个栏目的数据请求再渲染的操作。一种通过消息驱动的刷新系统，包括如下模块：模块M1：在前端用户登录后，开启心跳请求进程，定时发送请求到后端获取当前用户信息；模块M2：判断获取的当前用户信息中是否包含未读消息，若包含未读消息，则进行深入解析，根据未读消息的类型汇总到待刷新队列中；若不包含未读消息，则返回模块M1继续获取当前用户信息；模块M3：根据待刷新队列中未读消息的类型，确定刷新范围并对目标对象进行刷新。优选的，当待刷新的目标对象是单个元素时，通过该元素的数据接口发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该元素的显示效果。优选的，当待刷新的目标对象是多个元素时，遍历需要刷新的元素队列，依次执行单个元素的数据请求再渲染的操作。优选的，当待刷新的目标对象是单个栏目时，通过该栏目的已有参数发起异步请求，在回调函数里获取最新数据，然后调用模板渲染引擎，局部刷新该栏目的显示效果。优选的，当待刷新的目标对象是一个类型时，从当前空间里找到符合条件的栏目，然后再遍历需要刷新的队列，依次执行上述单个栏目的数据请求再渲染的操作。与现有技术相比，本发明的有益效果是：本发明通过模块的拆分与消息类型关联技术，形成了统一的规范，成功解决了显示内容和实际情况不一致、显示内容更新不及时等问题。在相关数据操作后，使用该技术可以做到局部刷新，及时更新到最新的数据状态，此技术加载速度快，且不会打断当前用的行为，用户体验好。附图说明图1为通过消息驱动的刷新方法流程图；图2为门户页面示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。请参阅图1和图2，本发明提供一种技术方案：通过模块拆分，把门户页面上的区域都拆分为元素来组成，每种元素都有它独有的数据来源，可一起渲染或分开单独渲染。另外页面还提供一个栏目布局的容器，它里面有N个栏目组成，如图2所示；每个前端用户登录后，开启一个心跳请求进程，定时发送请求到后端获取当前用户的一些信息；当返回的信息里包含未读消息时候，继续深入解析消息，根据每条消息的类型汇总到待刷新的队列中，然后根据需要刷新的类型队列，去找到刷新的目标对象，需要刷新的目标对象可能是单个元素或则一组相同类型的栏目。元素：·当刷新的目标对象是单个元素的时候，通过该元素的数据接口，发起一个异步的请求，在回调函数里拿到最新的数据，然后调用模板渲染引擎，局部刷新该元素的显示效果；当刷新的目标对象是多个元素的时候，遍历需要刷新的元素队列，依次执行上述操作。栏目：根据传入的类型，确定刷新范围。·当刷新的目标对象是单个指定栏目的时候，通过该栏目的已有参数，发起一个异步的请求，在回调函数里拿到最新的数据，然后调用模板渲染引擎，局部刷新该栏目的显示效果。·当刷新的目标对象是一个类型的时候，从当前空间里找到符合条件的栏目，这种情况一般是多个栏目的组合，然后再遍历需要刷新的元素队列，依次执行上述数据请求再渲染的操作。通过模块的拆分与消息类型关联技术，形成了统一的规范，成功解决了显示内容和实际情况不一致、显示内容更新不及时等问题。在相关数据操作后，使用该技术可以做到局部刷新，及时更新到最新的数据状态。此技术加载速度快，且不会打断当前用的行为，用户体验好。使用方法一种通过消息驱动的刷新方法，包括以下步骤：步骤1：在前端用户登录后，开启心跳请求进程，定时发送请求到后端获取当前用户信息；步骤2：判断获取的当前用户信息中是否包含未读消息，若包含未读消息，则进行深入解析，根据未读消息的类型汇总到待刷新队列中；若不包含未读消息，则返回步骤1继续获取当前用户信息；步骤3：根据待刷新队列中未读消息的类型，确定刷新范围并对目标对象进行刷新。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。
