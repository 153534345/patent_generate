标题title
一种基于病变扩散算法的白质高信号提取方法及系统
摘要abst
本发明公开了一种基于病变扩散算法的白质高信号提取方法及系统，输入包括FLAIR图像、T1加权图像和白质的组织先验概率图的原始图像；对输入的原始图像进行预处理操作；对预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图，对获取的组织信号强度分布置信图进行初始化和脑白质高信号分割，得到脑白质高信号概率图；对分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上，得到脑白质高信号定位图。易于操作，泛化性强，是一种效果稳定，实用性强，十分有效的白质高信号提取方法。
权利要求书clms
1.一种基于病变扩散算法的白质高信号提取方法，其特征在于，包括以下步骤：S1、输入包括FLAIR图像、T1加权图像和白质的组织先验概率图的原始图像；S2、对步骤S1输入的原始图像进行预处理操作；S3、对步骤S2预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图；S4、对步骤S3获取的组织信号强度分布置信图进行初始化和脑白质高信号分割，得到脑白质高信号概率图；S5、对步骤S4分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上，得到脑白质高信号定位图。2.根据权利要求1所述的方法，其特征在于，步骤S2中，预处理具体包括磁场偏移校正，图像配准、部分容积图像的生成、灰质白质脑脊液的组织分割和图像由标准空间到原始空间的变换。3.根据权利要求2所述的方法，其特征在于，部分容积图像的生成包括使用T1加权图像生成部分容积图像标签，其中，标签数值在1～3之间，1代表脑脊液，2代表灰质，3代表白质，将离散的标签分配到每一个体素中，分配到每一个体素的离散组织标签zi为：其中，i代表每一个体素，xi表示部分容积图像所标记的体素强度值。4.根据权利要求1所述的方法，其特征在于，步骤S3中，根据预处理后的FLAIR图像、T1的部分容积图像和白质的先验概率结果共同得到脑脊液、灰质和白质的组织信号强度分布置信图，组织信号强度分布置信图叠加获得完整的信号强度分布置信图B，根据BGM取阈值κ对病变点进行初始化。5.根据权利要求4所述的方法，其特征在于，信号强度分布置信图B为：B＝BCSF+BGM+BWM其中，BCSF、BGM、BWM分别是脑脊液、灰质和白质的组织信号强度分布置信图。6.根据权利要求4所述的方法，其特征在于，阈值κ为0.15～0.5。7.根据权利要求1所述的方法，其特征在于，步骤S4具体为：把初始点Linit附近的体素分为病变和其他体素，其他体素为脑脊液，灰质或白质，判断病变初始点Linit的附近点是否为病变；若附近点为病变，则判断对应点的附近点是否为病变，通过迭代增长算法使得与病变体素共享公共边界的体素也设定为病变体素，直到病变停止扩散，体素病变估计值为0～1，将初始点的值置为1，在更新病变分布参数α，β时，考虑的病变高概率体素，而在更新其他体素分布参数θ时只考虑的病变低概率体素；当没有新增的的体素时迭代停止，得到病变概率图，将马尔科夫随机场理论所代表的病变体素周围的体素病变增加的概率代入到病变概率图中，得到优化后的脑白质高信号概率图。8.根据权利要求7所述的方法，其特征在于，通过迭代增长算法进行迭代具体为：其中，i表示至少有一个相邻体素j满足bi为体素i的信号强度分布置信图，分别为前一时刻的分布参数估计值，POther为体素不属于病变的概率，PLes为体素属于病变的概率。9.根据权利要求7所述的方法，其特征在于，优化后的脑白质高信号概率图如下：其中，PLes为体素属于病变的概率，yi为体素i的FLAIR信号强度，分别为前一时刻的分布参数估计值，bi为体素i的信号强度分布置信图，为与体素i相邻的体素j的病变概率图，POther为体素不属于病变的概率。10.一种基于病变扩散算法的白质高信号提取系统，其特征在于，包括：输入模块，输入原始图像；预处理模块，对输入模块输入的原始图像进行预处理操作；初始化模块，预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图；病变提取模块，对获取的组织信号强度分布置信图进行初始化和脑白质高信号分割；后处理模块，将病变提取模块分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上得到脑白质高信号定位图。
说明书desc
技术领域本发明属于医学成像技术领域，具体涉及一种基于病变扩散算法的白质高信号提取方法及系统。背景技术白质高信号的处理通常使用到影像学手段，最常使用磁共振成像液体衰减反转恢复序列进行显示。在FLAIR序列中，脑脊液被抑制为低信号，增强高信号病变的对比度，对于脑室旁，脑室以及深部等白质高信号的成像效果好于其他成像方式。目前，对白质高信号的评定分为手动评定和自动评定两种。手动评定是指专门人员对磁共振影像进行裸眼观察，而后利用Fazekas等脑白质病变量表对患者脑白质高信号等级进行评定，这种方法对观察专家的水平依赖性强，所获结果主观性强，消耗时间长且效率较低。自动评定是指利用自动的白质高信号检测算法定量提取白质高信号的方法。近几年，由于人工智能的兴起，产生了许多基于机器学习和深度学习的白质高信号分割方法，例如基于支持向量机、K邻近、随机森林等基于机器的方法和基于VGG网络、2D全卷积网络、3D卷积网络等基于深度学习的方法。这些方法通常实现周期长，对原始影像的模态有较高要求，且通常对特定样本效果最佳，泛化性不足。发明内容本发明所要解决的技术问题在于针对上述现有技术中的不足，提供一种基于病变扩散算法的白质高信号提取方法及系统，提取结果可靠，泛化性强且易于使用。本发明采用以下技术方案：一种基于病变扩散算法的白质高信号提取方法，包括以下步骤：S1、输入包括FLAIR图像、T1加权图像和白质的组织先验概率图的原始图像；S2、对步骤S1输入的原始图像进行预处理操作；S3、对步骤S2预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图；S4、对步骤S3获取的组织信号强度分布置信图进行初始化和脑白质高信号分割，得到脑白质高信号概率图；S5、对步骤S4分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上，得到脑白质高信号定位图。具体的，步骤S2中，预处理具体包括磁场偏移校正，图像配准、部分容积图像的生成、灰质白质脑脊液的组织分割和图像由标准空间到原始空间的变换。进一步的，部分容积图像的生成包括使用T1加权图像生成部分容积图像标签，其中，标签数值在1～3之间，1代表脑脊液，2代表灰质，3代表白质，将离散的标签分配到每一个体素中，分配到每一个体素的离散组织标签zi为：其中，i代表每一个体素，xi表示部分容积图像所标记的体素强度值。具体的，步骤S3中，根据预处理后的FLAIR图像、T1的部分容积图像和白质的先验概率结果共同得到脑脊液、灰质和白质的组织信号强度分布置信图，组织信号强度分布置信图叠加获得完整的信号强度分布置信图B，根据BGM取阈值κ对病变点进行初始化。进一步的，信号强度分布置信图B为：B＝BCSF+BGM+BWM其中，BCSF、BGM、BWM分别是脑脊液、灰质和白质的组织信号强度分布置信图。进一步的，阈值κ为0.15～0.5。具体的，步骤S4具体为：把初始点Linit附近的体素分为病变和其他体素，其他体素为脑脊液，灰质或白质，判断病变初始点Linit的附近点是否为病变；若附近点为病变，则判断对应点的附近点是否为病变，通过迭代增长算法使得与病变体素共享公共边界的体素也设定为病变体素，直到病变停止扩散，体素病变估计值为0～1，将初始点的值置为1，在更新病变分布参数α，β时，考虑的病变高概率体素，而在更新其他体素分布参数θ时只考虑的病变低概率体素；当没有新增的的体素时迭代停止，得到病变概率图，将马尔科夫随机场理论所代表的病变体素周围的体素病变增加的概率代入到病变概率图中，得到优化后的脑白质高信号概率图。进一步的，通过迭代增长算法进行迭代具体为：其中，i表示至少有一个相邻体素j满足bi为体素i的信号强度分布置信图，分别为前一时刻的分布参数估计值，POther为体素不属于病变的概率，PLes为体素属于病变的概率。进一步的，优化后的脑白质高信号概率图如下：其中，PLes为体素属于病变的概率，yi为体素i的FLAIR信号强度，分别为前一时刻的分布参数估计值，bi为体素i的信号强度分布置信图，为与体素i相邻的体素j的病变概率图，POther为体素不属于病变的概率。本发明的另一技术方案是，一种基于病变扩散算法的白质高信号提取系统，包括：输入模块，输入原始图像；预处理模块，对输入模块输入的原始图像进行预处理操作；初始化模块，预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图；病变提取模块，对获取的组织信号强度分布置信图进行初始化和脑白质高信号分割；后处理模块，将病变提取模块分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上得到脑白质高信号定位图。与现有技术相比，本发明至少具有以下有益效果：本发明一种基于病变扩散算法的白质高信号提取方法，首先对FLAIR数据预处理，对T1数据生成部分容积图图像标签，将白质组织先验概率图转换到标准空间，而后生成信号强度分布置信图，之后进行以病变扩散算法为核心的白质高信号分割，最终生成白质高信号二值图像。该方法流程完整，能够去除原始图像的不稳定性，清晰完整的计算白质高信号。并且，对于使用者，该方法不仅使用方便，需要设置的参数较少，而且泛化性较强，能够适用于发生在不同类型被试中的数据。进一步的，由于不同数据个体之间的差异、相同个体不同模态MRI图像数据的环境等因素的差异、个体的头动以及偏移场造成的影响等无法统一的因素和不良影响，需要通过预处理对原始数据进行一定的校准和统一，该方法不仅可以做到使得FLAIR像和T1像两种模态的MRI图像在空间位置中一一对应，达到信息融合的目的，而且可以通过N4偏移场校正方法将偏移场估计图像叠加到原图像上，实现对相同组织体素值的灰度值均匀化，防止本属于相同组织的体素由于灰度值不均匀被划分到不同的组织。进一步的，以T1为原始图像对每个体素进行归类，生成标签数值在1-3之间的部分容积图像，并将离散的标签分配到每一个体素中。。部分容积图像是后续通过概率学方法计算每个组织的FLAIR信号强度分布置信图的的前提。进一步的，由原始FLAIR图像预处理后得到的FLAIR图像、原始T1处理后得到的部分容积图像和变换到原始空间的组织先验概率图进行乘积计算，将每个体素的FLAIR图像值与强度均值的差值、部分容积图像的标签值和组织先验概率图中该体素位置属于白质的概率三者相乘，得到三个组织的信号强度分布置信图，通过该图可以限制病变扩散的范围并能够提供病变初始化的种子点位置。进一步的，将三种组织的信号强度分布置信图叠加，得到信号强度分布置信图，叠加后的置信图可以限制病变扩散的范围，防止病变扩散到不合理的位置。其中灰质信号强度分布置信图能够对病变的起始种子点进行初始化。进一步的，在进行病变初始化时需要对灰质信号强度分布置信图设置阈值，如果阈值过高，可能会使本应属于病变的位置被归类为其他组织。如果阈值过低，会使得不属于病变的其他组织被归类为病变，因此阈值的取值不应过大或过小，需保证在0.15-0.5之间。进一步的，通过判断初始病变位置的邻域体素是否属于病变对病变进行扩散，再对新增病变继续判断其邻域是否为病变，通过反复迭代最终确定病变扩散的位置，也就是脑白质高信号概率图。基于马尔科夫随机场理论的改进可以加强邻域对体素的影响，从而提高计算结果的准确性。进一步的，对病变扩散的迭代增长算法进行迭代设置。将病变概率密度分布与其他组织概率密度分布相除，并将结果与该体素的信号强度分布置信图相乘，确保病变在假设范围内增长，而后与1取小，得到该算法思想下的基本病变概率图。进一步的，将基本算法中病变概率图与由马尔科夫随机场理论得到的基于能量函数的病变体素条件分布概率结果相乘，并和1取小，得到优化后的更加准确的病变概率图，也就是脑白质高信号概率图。综上所述，本发明能够通过基于病变扩散的算法对白质高信号进行清晰有效的提取，且该方法易于使用且泛化性强。下面通过附图和实施例，对本发明的技术方案做进一步的详细描述。附图说明图1为本发明流程示意图；图2为本发明模块示意图；图3为本发明方法过程的示例示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。应当理解，当在本说明书和所附权利要求书中使用时，术语“包括”和“包含”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。还应当理解，在本发明说明书中所使用的术语仅仅是出于描述特定实施例的目的而并不意在限制本发明。如在本发明说明书和所附权利要求书中所使用的那样，除非上下文清楚地指明其它情况，否则单数形式的“一”、“一个”及“该”意在包括复数形式。还应当进一步理解，在本发明说明书和所附权利要求书中使用的术语“和/或”是指相关联列出的项中的一个或多个的任何组合以及所有可能组合，并且包括这些组合。在附图中示出了根据本发明公开实施例的各种结构示意图。这些图并非是按比例绘制的，其中为了清楚表达的目的，放大了某些细节，并且可能省略了某些细节。图中所示出的各种区域、层的形状及它们之间的相对大小、位置关系仅是示例性的，实际中可能由于制造公差或技术限制而有所偏差，并且本领域技术人员根据实际所需可以另外设计具有不同形状、大小、相对位置的区域/层。本发明提供了一种基于病变扩散算法的白质高信号提取方法及系统，适用于脑白质高信号的分割，对原始输入图像进行预处理，使其满足病变扩散算法的输入需求；再通过病变扩散算法将图像进行病变位置初始化，病变位置的扩散和迭代，直到病变位置不再变化后得到脑白质高信号概率图，将白质高信号提取图叠加获得脑白质高信号定位图。操作简单，分割结果较为准确，对数据的泛化性强，实用性强。请参阅图1和图3，本发明一种基于病变扩散算法的白质高信号提取方法，包括以下步骤：S1、输入原始图像；原始图像包括：FLAIR图像、T1加权图像和白质的组织先验概率图。S2、对步骤S1输入的原始图像进行预处理操作；预处理操作包括磁场偏移校正，图像配准、部分容积图像的生成、灰质白质脑脊液的组织分割和图像由标准空间到原始空间的变换；图像配准具体为：以FLAIR图像为参考图像，将T1加权图像作为配对源图像执行配准。部分容积图像的生成包括使用T1加权图像生成部分容积图像标签，其中，标签数值在1-3之间，其中1代表脑脊液，2代表灰质，3代表白质，将离散的标签分配到每一个体素中，如公式1所示。其中，i代表每一个体素，xi表示部分容积图像所标记的体素强度值，zi代表分配到每一个体素的离散组织标签。图像由标准空间到原始空间的变换包括组织先验概率图由标准空间到原始空间的变换。由于FLAIR预处理后图像和T1原始图像得到的部分容积标签图像均存在于个体空间，而白质组织先验概率图存在于标准空间，需要将白质组织先验概率图由标准空间变换到原始空间。S3、对预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图；计算获得三种组织的信号强度分布置信图以及完整的信号强度分布置信图，对步骤S2预处理后的图像设置阈值，进行病变点初始化；三种组织的信号强度分布置信图由预处理后的FLAIR图像、T1的部分容积图像和白质的先验概率结果共同得到，计算方法如公式2所示。其中，i＝1,2,……,n，n表示体素的个数，i代表每一个体素，k代表组织的类型，有三种情况，包括脑脊液，灰质和白质。y＝表示FLAIR预处理后图像中n个体素的信号强度。表示沿着三个组织方向的y的平均值。当时，记录为该体素处FLAIR信号强度存在异常，此时，否则，该体素处FLAIR信号强度记录为正常，此时，选择三种不同的k，分别得到了脑脊液、灰质、白质三种组织的体素i的信号强度分布置信图bCSF,i、bGM,i、bWM,i。接下来，获得三种组织的信号强度分布置信图，如公式3所示。其中，BCSF、BGM、BWM分别是脑脊液、灰质和白质的组织信号分布强度置信图。当白质先验概率高、FLAIR信号高、T1信号xi＜1.5时，BCSF位置属于脑脊液；当白质先验概率高、FLAIR信号高、T1信号1.5≤xi＜2.5时，BGM属于灰质；当白质先验概率高、FLAIR信号高、T1信号xi≥2.5时，BWM属于白质，组织信号分布强度高的位置表示病变位置。由组织信号强度分布置信图叠加获得完整的信号强度分布置信图B，如公式4所示：B＝BCSF+BGM+BWM 由于病变与所有的部分容积图像的灰质标签有关，需要根据BGM取阈值κ对病变点进行初始化，如公式5所示。Linit＝{linit,1,linit,2,……,linit,n}当bGM＞κ时，linit,i＝1，Linit则为初始化后病变的种子点。阈值κ的取值不能过大也不能过小，阈值过大会导致病变没有被划分，阈值过小会导致较多普通组织被划分成病变，经试验得到适用阈值κ为0.15～0.5，最佳阈值κ为0.3。S4、对步骤S3获取的组织信号强度分布置信图进行初始化和脑白质高信号分割；通过病变生长算法对白质高信号进行分割，使病变由初始点Linit扩张成属于信号强度分布置信图B范围内的某一位置。具体的，需要判断病变初始点Linit的附近点是否为病变；若附近点为病变，则再判断该点的附近点是否为病变，通过迭代使病变点进行扩散，直到病变停止扩散，此时即可得到脑白质高信号概率图。更具体的，把初始点Linit附近的体素分为病变和其他两种，其中其他体素即为脑脊液，灰质或白质，三者均服从高斯分布，因此，其他体素整体符合高斯混合分布，如公式6所示。其中，φ为正态分布的概率密度函数，μk，分别为均值和方差，πk为该体素分配到第k类的比例，θ即为所有组织类别的参数μk，πk。由于体素i的组织类别在预处理过程中已知，因此高斯混合分布简化成分开的单独的高斯分布，根据高斯分布的极大似然估计，其他体素的参数估计结果如公式7所示。其中，nk表示属于第k类的体素个数，分别为估计的参数结果。通过迭代增长算法，使得与病变体素共享公共边界的体素也设定为病变体素，从而描述初始病变发展成病变图的过程，迭代过程如公式8所示。其中，i表示至少有一个相邻体素j满足bi确保了病变在假设范围内增长。由于病变的分布满足伽玛分布，α，β为伽玛分布的参数，表示病变体素分布与其他体素分布的比值。表示前一时刻的分布参数估计值。体素病变估计值是一个0-1之间的数，越大表明该体素越有可能是病变体素。把初始点的值置为1。在更新病变分布参数α，β时，只考虑的病变高概率体素，而在更新其他体素分布参数θ时只考虑的病变低概率体素。当没有新增的的体素时迭代停止，得到病变概率图。进一步的，通过将相邻体素的信息合并扩展算法，假设病变体素包围的体素更可能是病变，这种假设符合马尔科夫随机场理论。设随机变量Z＝的集合，每个Z的域L＝{Les,Oth，zi附近Ni的体素zNi＝{z'i|i'∈Ni}。由于Hammersley CliffordTheorem理论认为马尔科夫随机场和吉布斯分布是一致的，zi的条件分布可视为吉布斯分布，如公式9所示。其中，U为能量函数，满足Ising模型，如公式10所示。其中，I为指示符函数，即语句为真时，I＝1，语句为假时I＝0，默认取1。若Ni中更多体素被标记为病变，则能量函数U则有利于将体素分割为病变。由于算法是连续而非离散的，将病变的能量函数U更改为概率形式，如公式11所示。将马尔科夫随机场理论所代表的病变体素周围的体素病变增加的概率代入到病变概率图中，得到优化后的病变概率图，如公式12所示。其中，为体素i的病变概率图，PLes为体素为病变的概率，yi为体素i的信号强度，分别为前一时刻的分布参数估计值，bi为体素i的信号强度分布置信图，为与体素i相邻的体素j的病变概率图，POther为体素不是病变的概率。S5、将分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图；将脑白质高信号提取图叠加到标准化后的原始图像上，得到脑白质高信号定位图，确定白质高信号病变的尺寸和位置。将病变概率大于0的所有体素在受试者中的分布进行统计，选取1作为阈值，得到脑白质信号提取图。请参阅图2，本发明再一个实施例中，提供一种基于病变扩散算法的白质高信号提取系统，该系统能够用于实现上述基于病变扩散算法的白质高信号提取，具体的，该基于病变扩散算法的白质高信号提取系统包括输入模块、预处理模块、初始化模块、病变提取模块以及后处理模块。其中，输入模块，输入原始图像；预处理模块，对输入模块输入的原始图像进行预处理操作；初始化模块，预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图；病变提取模块，对获取的组织信号强度分布置信图进行初始化和脑白质高信号分割；后处理模块，将病变提取模块分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上得到脑白质高信号定位图。本发明再一个实施例中，提供了一种终端设备，该终端设备包括处理器以及存储器，所述存储器用于存储计算机程序，所述计算机程序包括程序指令，所述处理器用于执行所述计算机存储介质存储的程序指令。处理器可能是中央处理单元，还可以是其他通用处理器、数字信号处理器、专用集成电路、现成可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等，其是终端的计算核心以及控制核心，其适于实现一条或一条以上指令，具体适于加载并执行一条或一条以上指令从而实现相应方法流程或相应功能；本发明实施例所述的处理器可以用于基于病变扩散算法的白质高信号提取方法及系统的操作，包括：输入包括FLAIR图像、T1加权图像和白质的组织先验概率图的原始图像；对输入的原始图像进行预处理操作；对预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图，对获取的组织信号强度分布置信图进行初始化和脑白质高信号分割，得到脑白质高信号概率图；对分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上，得到脑白质高信号定位图。本发明再一个实施例中，本发明还提供了一种存储介质，具体为计算机可读存储介质，所述计算机可读存储介质是终端设备中的记忆设备，用于存放程序和数据。可以理解的是，此处的计算机可读存储介质既可以包括终端设备中的内置存储介质，当然也可以包括终端设备所支持的扩展存储介质。计算机可读存储介质提供存储空间，该存储空间存储了终端的操作系统。并且，在该存储空间中还存放了适于被处理器加载并执行的一条或一条以上的指令，这些指令可以是一个或一个以上的计算机程序。需要说明的是，此处的计算机可读存储介质可以是高速RAM存储器，也可以是非不稳定的存储器，例如至少一个磁盘存储器。可由处理器加载并执行计算机可读存储介质中存放的一条或一条以上指令，以实现上述实施例中有关基于病变扩散算法的白质高信号提取方法及系统的相应步骤；计算机可读存储介质中的一条或一条以上指令由处理器加载并执行如下步骤：输入包括FLAIR图像、T1加权图像和白质的组织先验概率图的原始图像；对输入的原始图像进行预处理操作；对预处理后的图像做异常信号乘积运算，获取组织信号强度分布置信图，对获取的组织信号强度分布置信图进行初始化和脑白质高信号分割，得到脑白质高信号概率图；对分割处理后生成的脑白质高信号概率图通过阈值进行图像二值化，获取脑白质高信号提取图，将脑白质高信号提取图叠加到标准化后的原始图像上，得到脑白质高信号定位图。综上所述，本发明一种基于病变扩散算法的白质高信号提取方法及系统，通过定位病变信号的初始种子点并通过算法对其进行扩散，找到白质中完整的病变位置，得到脑白质高信号定位图。能够清晰、准确的对白质高信号的位置和体积进行定位，且其易于操作，泛化性强，是一种效果稳定，实用性强，十分有效的白质高信号提取方法。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。以上内容仅为说明本发明的技术思想，不能以此限定本发明的保护范围，凡是按照本发明提出的技术思想，在技术方案基础上所做的任何改动，均落入本发明权利要求书的保护范围之内。
