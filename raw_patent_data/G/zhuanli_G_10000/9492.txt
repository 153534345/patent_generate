标题title
一种基于逆向粒子输运的辐射源强重建方法
摘要abst
本发明公开了一种基于逆向粒子输运的辐射源强重建方法，包括以下步骤：建立粒子逆向输运核数据库；获取测量设备处粒子能量、强度分布信息，结合初始源空间分布信息、介质影像信息、测量设备信息建立起逆向蒙特卡罗辐射输运计算模型；根据测量设备处粒子能量、强度分布信息，抽样得到源粒子，使用蒙特卡罗逆向输运方法对该粒子进行模拟，直到该粒子输运到达辐射源处；对所有粒子进行逆向输运模拟，并对统计得到的辐射源处粒子强度分布信息进行归一化处理，获取辐射源处粒子源强分布。本发明可有效获得粒子源强分布，可进行精确的辐射源反演。
权利要求书clms
1.一种基于逆向粒子输运的辐射源强重建方法，其特征在于：包括以下步骤：建立粒子逆向输运核数据库；获取测量设备处粒子能量、强度分布信息，结合初始源空间分布信息、介质影像信息、测量设备信息建立起逆向蒙特卡罗辐射输运计算模型；根据测量设备处粒子能量、强度分布信息，抽样得到源粒子，使用蒙特卡罗逆向输运方法对该粒子进行模拟，直到该粒子输运到达辐射源处；对所有粒子进行逆向输运模拟，并对统计得到的辐射源处粒子强度分布信息进行归一化处理，获取辐射源处粒子源强分布。2.根据权利要求1所述基于逆向粒子输运的辐射源强重建方法，其特征在于，步骤中，所述粒子逆向输运核数据库包括与不同元素发生反应后粒子对应的入射粒子能量、角度分布信息。3.根据权利要求1所述基于逆向粒子输运的辐射源强重建方法，其特征在于，步骤中，所述建立粒子逆向输运核数据库，具体包括以下步骤：将0MeV～20MeV的粒子能量划分为N群，其中，N为大于0的整数；建立单元球，在单元球中填充不同的元素，单元球球心设置点源，以步骤中各能群作为源能量分布，使用蒙特卡罗方法进行模拟，统计一次碰撞后粒子能量/角度分布；对所有能群进行模拟后，针对不同元素，对碰撞后粒子能量/角度分布数据进行处理，获得出射粒子能量对应的入射粒子能量/角度分布数据，建立粒子逆向输运核数据库。4.根据权利要求1所述基于逆向粒子输运的辐射源强重建方法，其特征在于，步骤中，所述建立逆向蒙特卡罗辐射输运计算模型，具体包括以下步骤：使用测量数据标定信息对测量设备探测数据进行标定，获得测量设备处粒子能量、强度分布；将测量设备作为逆向粒子输运源，初始源空间作为计数空间，建立起逆向蒙特卡罗辐射输运计算模型。5.根据权利要求1所述基于逆向粒子输运的辐射源强重建方法，其特征在于，步骤中，所述根据测量设备处粒子能量、强度分布信息，抽样得到源粒子，使用蒙特卡罗逆向输运方法对该粒子进行模拟，直到该粒子输运到达辐射源处，具体包括以下步骤：根据逆向蒙特卡罗辐射输运计算模型，抽样得到源光子状态，包括位置、能量和角度；根据粒子位置、方向、能量，结合介质材料信息，基于概率密度函数抽样获得粒子下一次碰撞点位置和碰撞后状态；对当前粒子进行模拟，一直到粒子输运到辐射源所在空间，将输运到辐射源所在空间的粒子权重添加到源粒子强度分布中；若当前粒子未输运到辐射源空间，则将当前粒子权重平均分配到由同一个计数空间产生的粒子贡献中。6.根据权利要求5所述基于逆向粒子输运的辐射源强重建方法，其特征在于，步骤中，所述概率密度函数P的表达式为：式中，E为粒子当前能量、Ω为粒子当前角度，r为粒子当前位置，E′为粒子碰撞前能量、Ω′为碰撞前角度、r′为粒子上一次碰撞点位置，∑t为能量为E′的粒子在r处的反应总截面，∑s为能量为E′的粒子在r′处的散射截面，f为粒子在r′处逆向输运核数据。
说明书desc
技术领域本发明涉及反应堆、放射治疗、辐射防护等核能与核技术应用领域，具体涉及一种基于逆向粒子输运的辐射源强重建方法。背景技术辐射源强度分布直接决定了辐射剂量场的分布情况，精确获得辐射源强度分布是辐射防护、反应堆检测、放射治疗剂量监测等领域的一个关键问题。在实际应用过程中存在辐射源强度高、空间有限、难以放置探测设备等问题，导致难以直接测量得到辐射源强度，射线穿过介质后会在介质后形成透射分布，该透射分布一定程度上反应了辐射源强分布，因此研究通过透射分布逆向重建得到辐射源强分布方法，对辐射防护、反应堆检测、放射治疗剂量监测等具有重要意义。目前辐射源强重建多采用散射核反卷积迭代方法，该方法基于解析散射核通过反复迭代优化得到辐射源强度分布，虽然计算速度快，但存在重建精度不高的问题，因此有必要发展一套精确的辐射源强重建方法。发明内容发明目的：本发明的目的在于提供一种基于逆向粒子输运的辐射源强重建方法，以解决辐射防护、反应堆检测、放射治疗剂量监测等领域辐射源难以精准重建的难题。技术方案：本发明的基于逆向粒子输运的辐射源强重建方法，包括以下步骤：建立粒子逆向输运核数据库；获取测量设备处粒子能量、强度分布信息，结合初始源空间分布信息、介质影像信息、测量设备信息建立起逆向蒙特卡罗辐射输运计算模型；根据测量设备处粒子能量、强度分布信息，抽样得到源粒子，使用蒙特卡罗逆向输运方法对该粒子进行模拟，直到该粒子输运到达辐射源处；对所有粒子进行逆向输运模拟，并对统计得到的辐射源处粒子强度分布信息进行归一化处理，获取辐射源处粒子源强分布。步骤中，所述粒子逆向输运核数据库包括与不同元素发生反应后粒子对应的入射粒子能量、角度分布信息。步骤中，所述建立粒子逆向输运核数据库，具体包括以下步骤：将0MeV～20MeV的粒子能量划分为N群，其中，N为大于0的整数；建立单元球，在单元球中填充不同的元素，单元球球心设置点源，以步骤中各能群作为源能量分布，使用蒙特卡罗方法进行模拟，统计一次碰撞后粒子能量/角度分布；对所有能群进行模拟后，针对不同元素，对碰撞后粒子能量/角度分布数据进行处理，获得出射粒子能量对应的入射粒子能量/角度分布数据，建立粒子逆向输运核数据库。步骤中，所述建立逆向蒙特卡罗辐射输运计算模型，具体包括以下步骤：使用测量数据标定信息对测量设备探测数据进行标定，获得测量设备处粒子能量、强度分布；将测量设备作为逆向粒子输运源，初始源空间作为计数空间，建立起逆向蒙特卡罗辐射输运计算模型。步骤中，所述根据测量设备处粒子能量、强度分布信息，抽样得到源粒子，使用蒙特卡罗逆向输运方法对该粒子进行模拟，直到该粒子输运到达辐射源处，具体包括以下步骤：根据逆向蒙特卡罗辐射输运计算模型，抽样得到源光子状态，包括位置、能量和角度；根据粒子位置、方向、能量，结合介质材料信息，基于概率密度函数抽样获得粒子下一次碰撞点位置和碰撞后状态；对当前粒子进行模拟，一直到粒子输运到辐射源所在空间，将输运到辐射源所在空间的粒子权重添加到源粒子强度分布中；若当前粒子未输运到辐射源空间，则将当前粒子权重平均分配到由同一个计数空间产生的粒子贡献中。步骤中，所述概率密度函数P的表达式为：式中，E为粒子当前能量、Ω为粒子当前角度，r为粒子当前位置，E′为粒子碰撞前能量、Ω′为碰撞前角度、r′为粒子上一次碰撞点位置，∑t为能量为E′的粒子在r处的反应总截面，∑s为能量为E′的粒子在r′处的散射截面，f为粒子在r′处逆向输运核数据有益效果：本发明与现有技术相比，其有益效果在于：采用逆向蒙特卡罗方法对辐射源强进行重建，通过蒙特卡罗模拟建立粒子逆向输运核数据库，为粒子逆向输运提供精确的核数据支持，解决了难以获取精确粒子逆向输运核数据的问题；基于逆向蒙特卡罗方法进行源强重建，相较于传统解析迭代方法，可实现高精度的辐射源强度分布重建；本发明可有效提高辐射防护、反应堆检测、放射治疗剂量监测等领域辐射源强度分布重建精度。附图说明图1为本发明的流程示意图；图2为输入图片与采用本发明所述方法得到的重建源强的对比图。具体实施方式下面结合具体实施方式和说明书附图对本发明的技术方案做进一步详细描述。如图1所示，本发明包括基于逆向粒子输运的辐射源强重建方法，包括以下步骤：建立粒子逆向输运核数据库；其中，粒子逆向输运核数据库应包括与不同元素发生反应后粒子对应的入射粒子能量、角度分布信息；具体包括以下步骤：将0MeV～20MeV的粒子能量划分为N群，其中，N为大于0的整数；建立单元球，在单元球中填充不同的元素，单元球球心设置点源，以步骤中各能群作为源能量分布，使用蒙特卡罗方法进行模拟，统计一次碰撞后粒子能量/角度分布f，其中E为入射粒子能量，E'为出射粒子能量，μ为出射角余弦；对所有能群进行模拟后，针对不同元素，对碰撞后粒子能量/角度分布数据进行处理，获得出射粒子能量对应的入射粒子能量/角度分布数据，建立粒子逆向输运核数据库f。获取测量设备处粒子能量、强度分布信息，结合初始源空间分布信息、介质影像信息、测量设备信息建立起逆向蒙特卡罗辐射输运计算模型；其中，建立逆向蒙特卡罗辐射输运计算模型，具体包括以下步骤：使用测量数据标定信息对测量设备探测数据进行标定，获得测量设备处粒子能量、强度分布；将测量设备作为逆向粒子输运源，初始源空间作为计数空间，建立起逆向蒙特卡罗辐射输运计算模型。根据测量设备处粒子能量、强度分布信息，抽样得到源粒子，使用蒙特卡罗逆向输运方法对该粒子进行模拟，直到该粒子输运到达辐射源处；具体包括以下步骤：根据粒子位置、方向、能量，结合介质材料信息，基于概率密度函数p抽样获得粒子下一次碰撞点位置和碰撞后状态；式中，E为粒子当前能量、Ω为粒子当前角度，r为粒子当前位置，E′为粒子碰撞前能量、Ω′为碰撞前角度、r′为粒子上一次碰撞点位置，∑t为能量为E′的粒子在r处的反应总截面，∑s为能量为E′的粒子在r′处的散射截面，f为粒子在r′处逆向输运核数据；对当前粒子进行模拟，一直到粒子输运到辐射源所在空间，将输运到辐射源所在空间的粒子权重添加到源粒子强度分布中；若当前粒子未输运到辐射源空间，则将当前粒子权重平均分配到由同一个计数空间产生的粒子贡献中。对所有粒子进行逆向输运模拟，并对统计得到的辐射源处粒子强度分布信息进行归一化处理，获取辐射源处粒子源强分布。实施例对一个典型肺癌患者进行放射治疗辐射源强重建。该肺癌患者接受调强放射治疗，共有7个射束进行照射，这里对射束1进行辐射源强重建，射束1垂直入射到人体表面，源点与人体等中心点距离为100cm，源点到射野影像装置距离为140cm，射野影像装置采集测量图像如图2所示。具体重建步骤如下：1、光子逆向输运核数据库建立将0MeV～20MeV的光子能量划分为200群，每群能量间隔为0.1MeV；建立单元球，在单元球中填充不同的元素，单元球球心设置点源，以步骤中各能群作为源能量分布，使用蒙特卡罗方法进行模拟，统计一次碰撞后粒子能量/角度分布f，其中E为入射粒子能量，E′为出射粒子能量，μ为出射角余弦；对所有能群光子进行模拟后，针对不同元素，对碰撞后光子能量/角度分布数据进行处理，获得出射光子能量对应的入射光子能量/角度分布数据f，建立光子逆向输运核数据库。2、逆向蒙特卡罗辐射输运计算模型建立使用测量数据标定信息对图2所示的探测数据进行标定，获得测量设备处光子能量、强度分布；将测量设备作为逆向光子输运源，初始源空间作为计数空间，建立起逆向光子输运模型。3、蒙特卡罗逆向光子输运模拟根据逆向蒙特卡罗辐射输运计算模型，抽样得到源光子状态，包括位置、能量和角度；根据粒子位置、方向、能量，结合介质材料信息，基于概率密度函数抽样获得粒子下一次碰撞点位置和碰撞后状态；其中，概率密度函数P的表达式为：式中，E为粒子当前能量、Ω为粒子当前角度，r为粒子当前位置，E′为粒子碰撞前能量、Ω′为碰撞前角度、r′为粒子上一次碰撞点位置，∑t为能量为E′的粒子在r处的反应总截面，∑s为能量为E′的粒子在r′处的散射截面，f为粒子在r′处逆向输运核数据。对当前粒子进行模拟，一直到粒子输运到辐射源所在空间，将输运到辐射源所在空间的粒子权重添加到源粒子强度分布中；若当前粒子未输运到辐射源空间，则将当前粒子权重平均分配到由同一个计数空间产生的粒子贡献中。4、辐射源强度分布重建对统计得到的辐射源处光子强度分布信息进行归一化处理，获取辐射源处光子源强分布，如图2所示。
