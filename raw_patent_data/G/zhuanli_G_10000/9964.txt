标题title
一种多源重力数据融合方法
摘要abst
本发明公开了一种多源重力数据融合方法，包括如下步骤：重力场数据源整理、构建网格、网格赋值、误差修正、网格数据输出。该多源重力数据融合方法仅需要少量重力实测数据作为控制点，通过构建多层网格，融合不同来源重力数据信息，输出网格化重力数据，具有使用成本低廉，输出数据面积大、精度高、可信度高的优点。
权利要求书clms
1.一种多源重力数据融合方法，其特征在于，包括如下步骤，S1：重力场数据源整理；S2：构建网格；S3：网格赋值；S4：误差修正；S41：寻找第四网格和第五网格中的重力异常数据的映射关系，以第六网格的输出网格节点为中心，查找邻域内存在的第四网格和第五网格的数据点进行赋值，形成第六网格：S411：若第六网格的输出节点处存在第五网格的数据点，则以第五网格的数据点进行赋值；S412：若第六网格的输出节点处不存在第五网格的数据点，但存在第四网格的数据点，且邻域内存在第五网格的数据点，则以第四网格的数据点加上由邻域点共同决定的修正值进行赋值，具体计算公式为：上式中g4，g6分别为第四和第六网格输出节点处的重力异常值，n为邻域内第四网格、第五网格同时存在的数据点个数，g4i和g5i分别为邻域内第四和第五网格数据点的重力异常值，i为数据点的编号；S413：若第六网格的输出节点处不存在第五网格的数据点，但存在第四网格的数据点，且邻域内不存在第五网格的数据点，则以第四网格的数据点加上由第五网格所有点共同决定的修正值进行赋值；S414：若第六网格的输出节点处第四网格和第五网格的数据点都不存在，则依然赋值为NaN；S42：寻找第三网格和第六网格中的重力异常数据的映射关系，并重新赋值形成第七网格；S43：寻找第二网格和第七网格中的重力异常数据的映射关系，并重新赋值形成第八网格；S5：生成多源重力数据融合的输出文档，进行数据输出；检查第八网格所有输出节点的重力异常值，若不存在NaN，则直接将第八网格的输出节点的经纬度与第八网格中的重力异常数据按经度、纬度、重力异常三列的形式排列，形成输出文档；若存在NaN，则以NaN点为中心，查找第八网格中离NaN点最近的四个数据点，计算重力异常值，替换NaN形成第九网格，最后将第九网格中的重力异常值按经度、纬度、重力异常三列的形式排列，形成输出文档。2.如权利要求1所述的多源重力数据融合方法，其特征在于，所述的步骤S1中还包括步骤S11：分析不同重力场数据源，将EGM2008重力场模型数据、区域重力场数据、流动重力数据、重力剖面数据归算到统一坐标系下，形成网格式的数据格式；S12：重新解算四种重力数据，获得四种重力数据的布格重力异常数据；S13：将数据按经度、纬度、重力异常三列的形式排列形成文档。3.如权利要求1所述的多源重力数据融合方法，其特征在于，所述的步骤S2中还包括步骤S21：在标准平面上建立第一网格，给出每个输出网格节点的经纬度坐标；S22：读取EGM2008重力场模型数据的经纬度，将其叠加在第一网格上形成第二网格；S23：读取区域重力场数据的经纬度，将其叠加在第一网格上形成第三网格；S24：读取流动重力数据的经纬度，将其叠加在第一网格上形成第四网格；S25：读取重力剖面数据的经纬度，将其叠加在第一网格上形成第五网格。4.如权利要求1所述的多源重力数据融合方法，其特征在于，所述的步骤S3中还包括步骤S31：利用EGM2008重力模型场数据对第二网格中的每个输出网格节点进行赋值。5.如权利要求4所述的多源重力数据融合方法，其特征在于，以第二网格中的每个输出网格节点为中心，查找邻域内存在的EGM2008重力模型场数据点进行赋值：所述的步骤S31还包括步骤S311：若邻域内存在的EGM2008数据点的个数多于或等于4个，则直接利用EGM2008重力模型场数据点的数据进行赋值，例如选择离输出网格节点最近的4个点，最近的4个点的经纬度分别为，，，，根据4个点的距离确定对输出网格节点的贡献，计算输出网格节点的重力异常值，具体计算公式为：g＝/ ；上式中为输出网格节点的坐标，g为输出网格节点处的重力异常值；S312：若邻域内存在的EGM2008重力模型场数据点的个数在2到4个之间，则需同时利用EGM2008重力模型场数据点的数据和邻近输出网格节点数据进行赋值，例如先选择离网格节点最近的2个点g11，g12及邻近输出网格节点gx，其经纬度分别为，，，计算输出网格节点的重力异常值，具体计算公式为：g＝/+*gx/；S313：若邻域内存在的EGM2008重力模型场数据点的个数少于2个，则将该输出网格节点的重力异常数据赋值为NaN。6.如权利要求4所述的多源重力数据融合方法，其特征在于，所述的步骤S3中还包括步骤S32：分别利用区域重力场数据的经纬度、流动重力数据的经纬度以及重力剖面数据的经纬度，对第三网格、第四网格以及第五网格中的输出网格节点进行赋值。7.如权利要求1所述的多源重力数据融合方法，其特征在于，以第七网格的输出网格节点为中心，查找邻域内存在的第三网格和第六网格的数据点进行赋值：所述的步骤S42还包括步骤S421：若第七网格的输出节点处存在第六网格的数据点，则以第六网格的数据点进行赋值；S422：若第七网格的输出节点处不存在第六网格的数据点，但存在第三网格的数据点，且邻域内存在第六网格的数据点，则以第三网格的数据点加上由邻域内存在第六网格的数据点共同决定的修正值进行赋值，具体计算公式为：上式中g3，g7分别为第三网格和第七网格的重力异常值，n为邻域内第三网格、第六网格的同时存在的数据点个数，g3i和g6i分别为邻域内第三网格数据点和第六网格数据点的重力异常值，i为数据点的编号；S423：若第七网格的输出节点处不存在第六网格的数据点，但存在第三网格的数据点，且邻域内不存在第六网格的数据点，则以第三网格的数据点加上由第六网格所有的数据点共同决定的修正值进行赋值；S424：若第七网格的输出节点处第三网格和第六网格的数据点都不存在，则依然赋值为NaN。8.如权利要求1所述的多源重力数据融合方法，其特征在于，以第八网格的输出网格节点为中心，查找邻域内存在的第二网格和第七网格的数据点进行赋值：所述的步骤S43还包括步骤S431：若第八网格的输出节点处存在第七网格的数据点，则以第七网格的数据点进行赋值；S432：若第八网格的输出节点处不存在第七网格的数据点，但存在第二网格的数据点，且邻域内存在第七网格的数据点，则以第二网格的数据点加上由邻域内存在第七网格的数据点共同决定的修正值进行赋值，具体计算公式为：上式中g2，g8分别为第二网格和第八网格的重力异常值，n为邻域内第二网格、第七网格同时存在的数据点个数，g2i和g7i分别为邻域内第二和第七网格数据点的重力异常值，i为数据点的编号；S433：若第八网格的输出节点处不存在第七网格的数据点，但存在第二网格的数据，且邻域内不存在第七网格的数据点，则以第二网格的数据点加上由第六网格所有的数据点共同决定的修正值进行赋值；S434：若第八网格的输出节点处第二网格和第七网格的数据点都不存在，则依然赋值为NaN。
说明书desc
技术领域本发明涉及重力数据融合的技术领域，尤其涉及一种多源重力数据融合方法。背景技术由于受地理条件限制、测量设备昂贵等原因，导致高精度网格化的重力数据获得成本很高，极大地限制了重力数据在地质资源勘探、地震监测、地质调查等领域的应用。事实上重力数据来源种类较多，例如EGM2008重力场模型数据，区域重力场数据，流动重力数据，重力剖面数据等，这些数据的点距、精度、测量时间、解算方法差别很大，所以各种数据都是独立使用。这些数据有的分布面广，但点距大，精度较低；有些数据精度高，但分布范围小，因此将不同来源、不同尺度的数据进行有效融合，输出大范围、高精度、高可信度的网格化的重力数据具有十分重要的意义。鉴于以上所述，实有必要提供一种新型的多源重力数据融合方法以克服上述缺陷。发明内容本发明的目的是提供一种多源重力数据融合方法，该多源重力数据融合方法仅需要少量重力实测数据作为控制点，通过构建多层网格，融合不同来源重力数据信息，输出网格化重力数据，具有使用成本低廉，输出数据面积大、精度高、可信度高等优点。为了实现上述目的，本发明提供一种多源重力数据融合方法，包括如下步骤，S1：重力场数据源整理；S2：构建网格；S3：网格赋值；S4：误差修正；S41：寻找第四网格和第五网格中的重力异常数据的映射关系，以第六网格的输出网格节点为中心，查找邻域内存在的第四网格和第五网格的数据点进行赋值，形成第六网格：S411：若第六网格的输出节点处存在第五网格的数据点，则以第五网格的数据点进行赋值；S412：若第六网格的输出节点处不存在第五网格的数据点，但存在第四网格的数据点，且邻域内存在第五网格的数据点，则以第四网格的数据点加上由邻域点共同决定的修正值进行赋值，具体计算公式为：上式中g4，g6分别为第四和第六网格输出节点处的重力异常值，n为邻域内第四网格、第五网格同时存在的数据点个数，g4i和g5i分别为邻域内第四和第五网格数据点的重力异常值，i为数据点的编号；S413：若第六网格的输出节点处不存在第五网格的数据点，但存在第四网格的数据点，且邻域内不存在第五网格的数据点，则以第四网格的数据点加上由第五网格所有点共同决定的修正值进行赋值；S414：若第六网格的输出节点处第四网格和第五网格的数据点都不存在，则依然赋值为NaN；S42：寻找第三网格和第六网格中的重力异常数据的映射关系，并重新赋值形成第七网格；S43：寻找第二网格和第七网格中的重力异常数据的映射关系，并重新赋值形成第八网格；S5：生成多源重力数据融合的输出文档，进行数据输出；检查第八网格所有输出节点的重力异常值，若不存在NaN，则直接将第八网格的输出节点的经纬度与第八网格中的重力异常数据按经度、纬度、重力异常三列的形式排列，形成输出文档；若存在NaN，则以NaN点为中心，查找第八网格中离NaN点最近的四个数据点，计算重力异常值，替换NaN形成第九网格，最后将第九网格中的重力异常值按经度、纬度、重力异常三列的形式排列，形成输出文档。优选的，所述的步骤S1中还包括步骤S11：分析不同重力场数据源，将EGM2008重力场模型数据、区域重力场数据、流动重力数据、重力剖面数据归算到统一坐标系下，形成网格式的数据格式；S12：重新解算四种重力数据，获得四种重力数据的布格重力异常数据；S13：将数据按经度、纬度、重力异常三列的形式排列形成文档。优选的，所述的步骤S2中还包括步骤S21：在标准平面上建立第一网格，给出每个输出网格节点的经纬度坐标；S22：读取EGM2008重力场模型数据的经纬度，将其叠加在第一网格上形成第二网格；S23：读取区域重力场数据的经纬度，将其叠加在第一网格上形成第三网格；S24：读取流动重力数据的经纬度，将其叠加在第一网格上形成第四网格；S25：读取重力剖面数据的经纬度，将其叠加在第一网格上形成第五网格。优选的，所述的步骤S3中还包括步骤S31：利用EGM2008重力模型场数据对第二网格中的每个输出网格节点进行赋值。优选的，以第二网格中的每个输出网格节点为中心，查找邻域内存在的EGM2008重力模型场数据点进行赋值：所述的步骤S31还包括步骤S311：若邻域内存在的EGM2008重力模型场数据点的个数多于或等于4个，则直接利用EGM2008重力模型场数据点的数据进行赋值，例如选择离输出网格节点最近的4个点，最近的4个点的经纬度分别为，，，，根据4个点的距离确定对输出网格节点的贡献，计算输出网格节点的重力异常值，具体计算公式为：g＝g13+**g14]/ ；上式中为输出网格节点的坐标，g为输出网格节点处的重力异常值；S312：若邻域内存在的EGM2008重力模型场数据点的个数在2到4个之间，则需同时利用EGM2008重力模型场数据点的数据和邻近输出网格节点数据进行赋值，例如先选择离网格节点最近的2个点g11，g12及邻近输出网格节点gx，其经纬度分别为，，，计算输出网格节点的重力异常值，具体计算公式为：g＝/+*gx/；S313：若邻域内存在的EGM2008重力模型场数据点的个数少于2个，则将该输出网格节点的重力异常数据赋值为NaN。优选的，所述的步骤S3中还包括步骤S32：分别利用区域重力场数据的经纬度、流动重力数据的经纬度以及重力剖面数据的经纬度，对第三网格、第四网格以及第五网格中的输出网格节点进行赋值。优选的，以第七网格的输出网格节点为中心，查找邻域内存在的第三网格和第六网格的数据点进行赋值：所述的步骤S42还包括步骤S421：若第七网格的输出节点处存在第六网格的数据点，则以第六网格的数据点进行赋值；S422：若第七网格的输出节点处不存在第六网格的数据点，但存在第三网格的数据点，且邻域内存在第六网格的数据点，则以第三网格的数据点加上由邻域内存在第六网格的数据点共同决定的修正值进行赋值，具体计算公式为：上式中g3，g7分别为第三网格和第七网格的重力异常值，n为邻域内第三网格、第六网格的同时存在的数据点个数，g3i和g6i分别为邻域内第三网格数据点和第六网格数据点的重力异常值，i为数据点的编号；S423：若第七网格的输出节点处不存在第六网格的数据点，但存在第三网格的数据点，且邻域内不存在第六网格的数据点，则以第三网格的数据点加上由第六网格所有的数据点共同决定的修正值进行赋值；S424：若第七网格的输出节点处第三网格和第六网格的数据点都不存在，则依然赋值为NaN；优选的，以第八网格的输出网格节点为中心，查找邻域内存在的第二网格和第七网格的数据点进行赋值：所述的步骤S43还包括步骤S431：若第八网格的输出节点处存在第七网格的数据点，则以第七网格的数据点进行赋值；S432：若第八网格的输出节点处不存在第七网格的数据点，但存在第二网格的数据点，且邻域内存在第七网格的数据点，则以第二网格的数据点加上由邻域内存在第七网格的数据点共同决定的修正值进行赋值，具体计算公式为：上式中g2，g8分别为第二网格和第八网格的重力异常值，n为邻域内第二网格、第七网格同时存在的数据点个数，g2i和g7i分别为邻域内第二和第七网格数据点的重力异常值，i为数据点的编号；S433：若第八网格的输出节点处不存在第七网格的数据点，但存在第二网格的数据，且邻域内不存在第七网格的数据点，则以第二网格的数据点加上由第六网格所有的数据点共同决定的修正值进行赋值；S434：若第八网格的输出节点处第二网格和第七网格的数据点都不存在，则依然赋值为NaN。与现有技术相比，本发明提供的一种多源重力数据融合方法，有益效果在于：该多源重力数据融合方法仅需要少量重力实测数据作为控制点，通过构建多层网格，融合不同来源重力数据信息，输出网格化重力数据。具有使用成本低廉，输出数据面积大、精度高、可信度高等优点。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1为本发明提供的重力数据融合方法流程图。图2为本发明提供的多源重力数据融合方法的网格示意图，图2中，ο：表示输出网格节点，*代表是EGM2008重力模型场的数据点。具体实施方式为了使本发明的目的、技术方案和有益技术效果更加清晰明白，以下结合附图和具体实施方式，对本发明进行进一步详细说明。应当理解的是，本说明书中描述的具体实施方式仅仅是为了解释本发明，并不是为了限定本发明。请参阅图1及图2，本发明提供一种多源重力数据融合方法，包括如下步骤，S1：重力场数据源整理；S11：分析不同重力场数据源，分析不同重力场数据源，将EGM2008重力场模型数据、区域重力场数据、流动重力数据、重力剖面数据归算到似大地水准面，形成网格式的数据格式；S12：重新解算四种重力数据，获得四种重力数据的布格重力异常数据；S13：将数据按经度、纬度、重力异常三列的形式排列，形成文档。S2：构建网格；S21：根据输出要求，在似大地水准面的基础上建立2.5Km*2.5Km的第一网格，给出每个输出网格节点的经纬度坐标；S22：读取EGM2008重力场模型数据的经纬度，将其叠加在第一网格上形成第二网格；S23：同理，读取区域重力场数据的经纬度，将其叠加在第一网格上形成第三网格；S24：读取流动重力数据的经纬度，将其叠加在第一网格上形成第四网格；S25：读取重力剖面数据的经纬度，将其叠加在第一网格上形成第五网格。S3：网格赋值；S31：利用EGM2008重力模型场数据对第二网格中的每个输出网格节点进行赋值。具体的，首先以第二网格中的每个输出网格节点为中心，查找5Km*5Km邻域内存在的EGM2008重力模型场的数据点，根据以下规则进行赋值：S311：若邻域内存在的EGM2008重力场模型的数据点的个数多于或等于4个，则直接利用EGM2008重力场模型的数据点的数据进行赋值，例如选择离输出网格节点最近的4个点，最近的4个点的经纬度分别为，，，，根据4个点的距离确定对输出网格节点的贡献，计算输出网格节点的重力异常值，具体计算公式为：g＝g13+**g14]/ ；上式中为输出网格节点的坐标，g为输出网格节点处的重力异常值；S312：若邻域内存在的EGM2008数据点的个数在2到4个之间，则需同时利用EGM2008重力场模型数据点的数据和邻近输出网格节点数据进行赋值，例如先选择离网格节点最近的2个点g11，g12及邻近输出网格节点gx，其经纬度分别为，，，计算输出网格节点的重力异常值，具体计算公式为：g＝/+*gx/；S313：若邻域内存在的EGM2008数据点的个数少于2个，则将该输出网格节点的重力异常数据赋值为NaN。S32：同理，分别利用区域重力场数据的经纬度、流动重力数据的经纬度以及重力剖面数据的经纬度，对第三网格、第四网格以及第五网格中的输出网格节点进行赋值。S4：误差修正；S41：寻找第四网格和第五网格中的重力异常数据的映射关系，并重新赋值形成第六网格。具体的，首先以第六网格的输出网格节点为中心，查找5Km*5Km邻域内存在的第四网格和第五网格的数据点，根据以下规则进行赋值：S411：若第六网格的输出节点处存在第五网格的数据点，则以第五网格的数据点进行赋值；S412：若第六网格的输出节点处不存在第五网格的数据点，但存在第四网格的数据点，且邻域内存在第五网格的数据点，则以第四网格的数据点加上由邻域点共同决定的修正值进行赋值，具体计算公式为：上式中g4，g6分别为第四网格和第六网格的重力异常值，n为邻域内第四网格、第五网格同时存在的数据点个数，g4i和g5i分别为邻域内第四和第五网格数据点的重力异常值，i为数据点的编号；S413：若第六网格的输出节点处不存在第五网格的数据点，但存在第四网格的数据点，且邻域内不存在第五网格的数据点，则以第四网格的数据点加上由第五网格所有点共同决定的修正值进行赋值，具体计算公式与式一致，n为网格中第四网格和第五网格同时存在的数据点个数，g5i和g4i分别为第四和第五网格数据点的重力异常值，i为数据点的编号；S414：如果第六网格的输出节点处第四网格和第五网格的数据点都不存在，则依然赋值为NaN；S42：寻找第三网格和第六网格中的重力异常数据的映射关系，并重新赋值形成第七网格；具体的，首先以第七网格的输出网格节点为中心，查找5Km*5Km邻域内存在的第三网格和第六网格的数据点，根据以下规则进行赋值：S421：若第七网格的输出节点处存在第六网格的数据点，则以第六网格的数据点进行赋值；S422：若第七网格的输出节点处不存在第六网格的数据点，但存在第三网格的数据点，且邻域内存在第六网格的数据点，则以第三网格的数据点加上由邻域内存在第六网格的数据点共同决定的修正值进行赋值，具体计算公式为：上式中g3，g7分别为第三网格和第七网格的重力异常值，n为邻域内第三网格、第六网格的同时存在的数据点个数，g6i和g3i分别为邻域内第三网格的数据点和第六网格的数据点的重力异常值，i为数据点的编号；S423：若第七网格的输出节点处不存在第六网格的数据点，但存在第三网格的数据点，且邻域内不存在第六网格的数据点，则以第三网格的数据点加上由第六网格所有的数据点共同决定的修正值进行赋值，具体计算公式与式一致，n为网格中第三网格、第六网格的同时存在的数据点个数，g3i和g6i分别为第三和第六网格的数据点的重力异常值；S424：若第七网格的输出节点处第三网格和第六网格的数据点都不存在，则依然赋值为NaN；S43：寻找第二网格和第七网格中的重力异常数据的映射关系，并重新赋值，形成第八网格；具体的，首先以第八网格的输出网格节点为中心，查找5Km*5Km邻域内存在的第二网格和第七网格的数据点，根据以下规则进行赋值：S431：若第八网格的输出节点处存在第七网格的数据点，则以第八网格的数据点进行赋值；S432：若第八网格的输出节点处不存在第七网格的数据点，但存在第二网格的数据点，且邻域内存在第七网格的数据点，则以第二网格的数据点加上由邻域内存在第七网格的数据点共同决定的修正值进行赋值，具体计算公式为：上式中g2，g8分别为第三网格和第七网格的重力异常值，n为邻域内第二网格、第七网格同时存在的数据点个数，g2i和g7i分别为邻域内第二和第七网格数据点的重力异常值，i为数据点的编号；S433：若第八网格的输出节点处不存在第七网格的数据点，但存在第二网格的数据点，且邻域内不存在第七网格的数据点，则以第二网格的数据点加上由第七网格所有的数据点共同决定的修正值进行赋值，具体计算公式与式一致，n为网格中第二网格、第七网格的同时存在的数据点个数，g2i和g7i分别为网格中第三和第六网格数据点的重力异常值；S434：若第八网格的输出节点处第二网格和第七网格的数据点都不存在，则依然赋值为NaN。S5：生成输出文档，进行数据输出；检查第八网格所有输出节点的重力异常值，若不存在NaN，则直接将第八网格的输出节点的经纬度与第八网格中的重力异常数据按经度、纬度、重力异常三列的形式排列，形成输出文档；若存在NaN，则以NaN点为中心，查找第八网格中离NaN点最近的四个数据点，计算重力异常值，替换NaN形成第九网格，最后将第九网格中的重力异常值按经度、纬度、重力异常三列的形式排列，形成输出文档。本发明提供的一种多源重力数据融合方法，该方法仅需要少量重力实测数据作为控制点，通过构建多层网格，融合不同来源重力数据信息，输出网格化重力数据。具有使用成本低廉，输出数据面积大、精度高、可信度高等优点。本发明并不仅仅限于说明书和实施方式中所描述，因此对于熟悉领域的人员而言可容易地实现另外的优点和修改，故在不背离权利要求及等同范围所限定的一般概念的精神和范围的情况下，本发明并不限于特定的细节、代表性的设备和这里示出与描述的示例。
