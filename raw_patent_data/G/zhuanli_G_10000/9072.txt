标题title
基于权相交及多次交叉梯度约束的联合反演方法
摘要abst
本发明公开了一种基于权相交及多次交叉梯度约束的联合反演方法，包括以下步骤，依据实际地质情况，剖分地下三维空间，建立相应的核函数矩阵，确定重力及重力梯度异常与物性参数的关系，计算地面观测到的重力及重力梯度异常，设定观测点坐标及立方体单元位置，确定核函数矩阵的具体计算公式，计算得到联合反演目标函数，将联合反演目标函数在加权参数域利用共轭梯度法并在交叉梯度函数约束下求取最优解。本发明通过重力与多个重力梯度分量权相交并进行多次交叉梯度约束，最大程度挖掘重力与重力梯度数据所包含的地下信息，解决了反演的多解性问题，提高了反演的分辨率与精度。
权利要求书clms
1.一种基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，包括以下步骤：步骤1：依据实际地质情况，剖分地下三维空间，设定两个规则立方体的大小和埋深；步骤2：建立相应的核函数矩阵；步骤3：确定重力及重力梯度异常与物性参数的关系，计算地面观测到的重力及重力梯度异常；步骤4：设定观测点坐标及立方体单元位置，确定核函数矩阵的具体计算公式；步骤5：将步骤4中的计算公式中表示的反演问题写成目标函数的形式；步骤6：确定三维交叉梯度函数，并计算其二范数；步骤7：将步骤6中的三维交叉梯度函数分别添加到步骤5中重力目标函数和重力梯度目标函数，得到联合反演目标函数；步骤8：对步骤7中联合反演目标函数在加权参数域利用共轭梯度法并在交叉梯度函数约束下求取最优解。2.根据权利要求1所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，步骤1中依据实际地质情况，，剖分地下三维空间，设定两个规则立方体的大小和埋深，具体为将地下三维空间剖分为M个大小100m×100m×100m规则立方体单元，背景密度为0，两个密度差均为1g/cm3的规则立方体大小分别为300m×300m×200m，地面有N个观测点。3.根据权利要求2所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，步骤2中建立相应的核函数矩阵A，维数为N×M，N＝30×30，M＝30×30×10。4.根据权利要求3所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，步骤3中地面观测到的重力及重力梯度异常与物性参数的关系为：Am＝d，其中列向量d为地面观测数据，包括重力异常Δg，重力梯度异常gxx、gxy、gxz、gyy、gyz和gzz；gxx表示重力异常在x-方向的二阶偏导数、gxy表示重力异常在x-方向和y-方向的偏导数、gxz表示重力异常在x-方向和z-方向的偏导数、gyy表示重力异常在y-方向的二阶偏导数、gyz表示重力异常在y-方向z-方向的偏导数、gzz表示重力异常在z-方向的二阶偏导数，其维数为N；列向量m为物性参数，这里代表密度参数ρ，其维数为M；矩阵A表示连接观测数据d和物性参数m的核函数矩阵，维数为N×M，计算重力及重力梯度异常。5.根据权利要求4所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，步骤4中，观测点坐标P坐标为，立方体单元Q的位置为，其中α∈，β∈，γ∈；步骤2中，核函数矩阵包括重力异常Δg，重力梯度异常gxx、gxy、gxz、gyy、gyz和gzz)的具体计算公式如下：其中，万有引力常数G＝6.67×10-11m3·kg-1·s-2，ρ为立方体单元的平均剩余密度，也就上式中中的密度差；xi＝x-αi，yj＝y-βj，zk＝z-γk；μijk＝ijk。6.根据权利要求5所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，步骤5中将式中Am＝d表示的反演问题写成目标函数的形式：Φ＝||Am-d||2＝T，引入正则化约束项后，重力和重力梯度目标函数可分别写成：其中gg1代表重力Δg，gg2代表重力梯度gxx、gxy、gxz、gyy、gyz和gzz；Wd为数据加权矩阵，Wm为模型加权矩阵，也就是所说的深度权；δ为正则化因子。7.根据权利要求6所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，步骤6：三维交叉梯度函数可写为：其中：将交叉梯度函数的二范数Φcg作为约束条件而不是模添加到反演中：8.根据权利要求7所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，步骤7：将步骤6中的三维交叉梯度函数分别添加到步骤5中重力目标函数和重力梯度目标函数，得到联合反演目标函数，Φ'gg1和Φ'gg2，如下所示：其中，λgg1和λgg2分别表示重力和重力梯度交叉梯度函数的系数。9.根据权利要求8所述的基于权相交及多次交叉梯度约束的联合反演方法，其特征在于，对步骤7中联合反演目标函数Φ'gg1和Φ'gg2在加权参数域利用共轭梯度法并在交叉梯度函数约束下求取最优解mgg1和mgg2。
说明书desc
技术领域本发明属于地球物理学技术领域，尤其涉及一种基于权相交及多次交叉梯度约束的联合反演方法。背景技术随着地球物理勘探逐渐转向地质条件更为复杂的地区，单一数据类型的反演已无法获得可靠的地球物理模型。单个数据反演势必会产生多解性，并且通常难以获得一致的地质-地球物理模型来全面解释反演的单参数模型结果。传统的联合反演在提升反演结果的分辨率和精度上，效果有限，因此也无法获得更加准确的地下信息。重力异常可以突出深部地质体的地质响应，并且随着深度的增加衰减会变慢。重力梯度异常可以突出浅层地质体的地质响应，并且比重力异常具有更高的水平分辨率。重力和重力梯度联合反演可用于更好指导深部矿产勘探和石油勘探，且可以促进对地球内部物理特性的进一步解释和对矿产分布的理解。在新的经济和社会发展形势下，我国已探明的石油和金属矿产资源已经无法满足经济社会发展的需要，加快地质找矿工作的步伐，缓解矿产资源紧缺的矛盾，已经迫在眉睫。然而，浅表矿产越来越少，找矿难度越来越大，找矿向深部进军是必然趋势。通过国内外找矿实践经验表明，现有矿区深部找矿潜力巨大。同时，隐伏矿床的找矿问题也一直备受关注和重视。因此，由过去的500m以浅勘探深度到现在的从深500-1000m可采深度甚至大于1000m采矿深度，高精度、高分辨率的联合反演方法，对于更好指导深部矿产勘探和石油勘探，促进对地球内部物理特性的进一步解释，至关重要。但是现有的反演结果多解性严重，反演精度和分辨率不够高，对于地下地质体位置的圈定不准确，影响其应用。发明内容本发明通过重力与多个重力梯度分量权相交并进行多次交叉梯度约束，最大程度挖掘重力与重力梯度数据所包含的地下信息，解决了反演的多解性问题，提高了反演的分辨率与精度，更好指导深部找矿和促进对地球内部物理特性的进一步解释。具体的，本发明是通过以下技术方案实现的：提供一种基于权相交及多次交叉梯度约束的联合反演方法，包括以下步骤：步骤1：依据实际地质情况，剖分地下三维空间，设定两个规则立方体的大小和埋深；步骤2：建立相应的核函数矩阵；步骤3：确定重力及重力梯度异常与物性参数的关系，计算地面观测到的重力及重力梯度异常；步骤4：设定观测点坐标及立方体单元位置，确定核函数矩阵的具体计算公式；步骤5：将步骤4中的计算公式中表示的反演问题写成目标函数的形式；步骤6：确定三维交叉梯度函数，并计算其二范数；步骤7：将步骤6中的三维交叉梯度函数分别添加到步骤5中重力目标函数和重力梯度目标函数，得到联合反演目标函数；步骤8：对步骤7中联合反演目标函数在加权参数域利用共轭梯度法并在交叉梯度函数约束下求取最优解。优选的，步骤1中依据实际地质情况，剖分地下三维空间，设定两个规则立方体的大小和埋深，具体为将地下三维空间剖分为M个大小100m×100m×100m规则立方体单元，背景密度为0，两个密度差均为1g/cm3的规则立方体大小分别为300m×300m×200m，地面有N个观测点。优选的，步骤2中建立相应的核函数矩阵A，维数为N×M，N＝30×30，M＝30×30×10。优选的，步骤3中地面观测到的重力及重力梯度异常与物性参数的关系为：Am＝d，其中列向量d为地面观测数据，包括重力异常Δg，重力梯度异常gxx、gxy、gxz、gyy、gyz和gzz；gxx表示重力异常在x-方向的二阶偏导数、gxy表示重力异常在x-方向和y-方向的偏导数、gxz表示重力异常在x-方向和z-方向的偏导数、gyy表示重力异常在y-方向的二阶偏导数、gyz表示重力异常在y-方向z-方向的偏导数、gzz表示重力异常在z-方向的二阶偏导数，其维数为N；列向量m为物性参数，这里代表密度参数ρ，其维数为M；矩阵A表示连接观测数据d和物性参数m的核函数矩阵，维数为N×M，计算重力及重力梯度异常。优选的，步骤4中，观测点坐标P坐标为，立方体单元Q的位置为，其中α∈，β∈，γ∈；步骤2中，核函数矩阵包括重力异常Δg，重力梯度异常gxx、gxy、gxz、gyy、gyz和gzz)的具体计算公式如下：其中，万有引力常数G＝6.67×10-11m3·kg-1·s-2，ρ为立方体单元的平均剩余密度，也就上式中中的密度差；xi＝x-αi，yj＝y-βj，zk＝z-γk；μijk＝ijk。优选的，步骤5中将式中Am＝d表示的反演问题写成目标函数的形式：Φ＝||Am-d||2＝T，引入正则化约束项后，重力和重力梯度目标函数可分别写成：其中gg1代表重力Δg，gg2代表重力梯度gxx、gxy、gxz、gyy、gyz和gzz；Wd为数据加权矩阵，Wm为模型加权矩阵，也就是所说的深度权；δ为正则化因子。优选的，步骤6：三维交叉梯度函数可写为：其中：将交叉梯度函数的二范数Φcg作为约束条件而不是模添加到反演中：优选的，步骤7：将步骤6中的三维交叉梯度函数分别添加到步骤5中重力目标函数和重力梯度目标函数，得到联合反演目标函数，Φ'gg1和Φ'gg2，如下所示：其中，λgg1和λgg2分别表示重力和重力梯度交叉梯度函数的系数。优选的，对步骤7中联合反演目标函数Φ'gg1和Φ'gg2在加权参数域利用共轭梯度法并在交叉梯度函数约束下求取最优解mgg1和mgg2，，将第1次交叉梯度约束得到的两个最优解m1gg1和m1gg2作为下一次交叉梯度的权分别相交传递到第2次交叉梯度，以此类推，完成方法的整个过程，得到反演结果m'gg1和m'gg2。与现有技术相比，本发明具有以下有益的技术效果：本发明本发明通过重力与多个重力梯度分量权相交并进行多次交叉梯度约束，最大程度挖掘重力与重力梯度数据所包含的地下信息，一定程度上解决了反演的多解性问题，提高了反演的分辨率与精度，从而更加准确圈定出地下地质体位置，更好指导深部找矿和促进对地球内部物理特性的进一步解释。附图说明图1是本发明提供的基于权相交及多次交叉梯度约束的联合反演方法的流程图；图2是本发明中地质体三维位置及观测点、立方体单元位置示例；图3是本发明中重力及重力梯度异常图，其中a是重力Δg异常；b是重力梯度gxx异常；图4是本发明单独反演结果图，其中黑色虚线框为地质体的真实位置，a是重力Δg单独反演结果；b是重力梯度gxx单独反演结果；图5是本发明中最终反演结果图，a是重力Δg最终反演结果；b是重力梯度gxx最终反演结果。具体实施方式为了能够更清楚地理解本发明的上述目的、特征和优点，下面结合附图和具体实施例对本发明进行详细描述。需要说明的是，在不冲突的情况下，本发明的实施例及实施例中的特征可以相互组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。本文中在本发明的说明书中所使用的术语只是为了描述具体的实施例的目的，不是旨在于限制本发明。具体如图1所示，提供一种基于权相交及多次交叉梯度约束的联合反演方法，包括以下步骤：步骤1：依据实际地质情况，剖分地下三维空间，设定两个规则立方体的大小和埋深；设定两个规则立方体的大小和埋深，具体为将地下三维空间剖分为M个大小100m×100m×100m规则立方体单元，背景密度为0，两个密度差均为1g/cm3的规则立方体大小分别为300m×300m×200m，地面有N个观测点，左侧立方体顶面埋深300m，右侧立方体顶面埋深400m，相距700m，具体如图2所示；步骤2：建立相应的核函数矩阵A，维数为N×M，N＝30×30，M＝30×30×10；步骤3：确定重力及重力梯度异常与物性参数的关系，计算地面观测到的重力及重力梯度异常，地面观测到的重力及重力梯度异常与物性参数的关系为：Am＝d，其中列向量d为地面观测数据，包括重力异常Δg，重力梯度异常gxx、gxy、gxz、gyy、gyz和gzz；gxx表示重力异常在x-方向的二阶偏导数、gxy表示重力异常在x-方向和y-方向的偏导数、gxz表示重力异常在x-方向和z-方向的偏导数、gyy表示重力异常在y-方向的二阶偏导数、gyz表示重力异常在y-方向z-方向的偏导数、gzz表示重力异常在z-方向的二阶偏导数，其维数为N；列向量m为物性参数，这里代表密度参数ρ，其维数为M；矩阵A表示连接观测数据d和物性参数m的核函数矩阵，维数为N×M，计算重力及重力梯度异常，具体如图3所示；步骤4：设定观测点坐标及立方体单元位置，确定核函数矩阵的具体计算公式；观测点坐标P坐标为，立方体单元Q的位置为，其中α∈，β∈，γ∈；步骤2中，核函数矩阵包括重力异常Δg，重力梯度异常gxx、gxy、gxz、gyy、gyz和gzz)的具体计算公式如下：其中，万有引力常数G＝6.67×10-11m3·kg-1·s-2，ρ为立方体单元的平均剩余密度，也就上式中中的密度差；xi＝x-αi，yj＝y-βj，zk＝z-γk；μijk＝ijk。步骤5：将步骤4中的计算公式中表示的反演问题写成目标函数的形式；将式中Am＝d表示的反演问题写成目标函数的形式：Φ＝||Am-d||2＝T，引入正则化约束项后，重力和重力梯度目标函数可分别写成：其中gg1代表重力Δg，gg2代表重力梯度gxx、gxy、gxz、gyy、gyz和gzz；Wd为数据加权矩阵，Wm为模型加权矩阵，也就是所说的深度权；δ为正则化因子。步骤6：确定三维交叉梯度函数，并计算其二范数；三维交叉梯度函数可写为：其中：将交叉梯度函数的二范数Φcg作为约束条件而不是模添加到反演中：步骤7：将步骤6中的三维交叉梯度函数分别添加到步骤5中重力目标函数和重力梯度目标函数，得到联合反演目标函数，Φ'gg1和Φ'gg2，如下所示：其中，λgg1和λgg2分别表示重力和重力梯度交叉梯度函数的系数。步骤8：对步骤7中联合反演目标函数在加权参数域利用共轭梯度法并在交叉梯度函数约束下求取最优解，具体如下：将第1次交叉梯度约束得到的两个最优解m1gg1和m1gg2作为下一次交叉梯度的权分别相交传递到第2次交叉梯度，以此类推，完成方法的整个过程，得到反演结果m'gg1和m'gg2。结果如图4中单独反演结果图，其中黑色虚线框为地质体的真实位置，a是重力Δg单独反演结果，b是重力梯度gxx单独反演结果；图5中a是重力Δg最终反演结果，b是重力梯度gxx最终反演结果。对比例：单独反演及最终反演结果与原始重力、重力梯度异常的均方根误差对比，RMSERMSE单独反演1.42520.0131最终反演0.05220.0079均方根值越大，反演结果越差，精度和分辨率越低，如下为均方根误差计算公式：A'代表原始重力异常的核函数矩阵，A”代表原始重力梯度异常的核函数矩阵；m'代表单独反演及最终反演得到的密度，m”代表单独反演及最终反演得到的密度；d'代表原始重力异常，d”代表原始重力梯度异常。最后应说明的是，以上实施例仅用以说明本发明的技术方案而非限制，尽管参照较佳实施例对本发明进行了详细说明，本领域的普通技术人员应当理解，可以对本发明的技术方案进行修改或等同替换，而不脱离本发明技术方案的精神和范围。
