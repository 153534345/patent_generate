标题title
基于生成对抗网络的车牌图像生成方法及系统
摘要abst
本发明提供一种基于生成对抗网络的车牌图像生成方法及系统，方法包括：获取目标文本图和测试车牌原图；将所述测试车牌原图和所述目标文本图输入至文本替换模型中，得到所述文本替换模型输出的车牌预测图；其中，所述文本替换模型是基于所述训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及所述训练车牌原图训练得到的；所述文本替换模型用于将预先获取的目标文本图的文本内容替换至所述测试车牌原图，得到车牌预测图。本发明实现了生成车牌预测图的同时，确保保留测试车牌原图的车牌背景和文字风格等特征。
权利要求书clms
1.一种基于生成对抗网络的车牌图像生成方法，其特征在于，包括：获取目标文本图和测试车牌原图；将所述测试车牌原图和所述目标文本图输入至文本替换模型中，得到所述文本替换模型输出的车牌预测图；其中，所述文本替换模型是基于所述训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及所述训练车牌原图训练得到的；所述文本替换模型用于将预先获取的目标文本图的文本内容替换至所述测试车牌原图，得到车牌预测图。2.根据权利要求1所述的基于生成对抗网络的车牌图像生成方法，其特征在于，所述文本替换模型，包括：文本转换层，基于所述测试车牌原图将所述目标文本图的前景风格转换为所述测试车牌原图的前景风格，得到目标文本前景图；背景修复层，对所述测试车牌原图进行文本擦除和纹理填充，形成车牌背景图；文本融合层，将所述目标文本前景图和所述车牌背景图进行文本融合，得到车牌预测图。3.根据权利要求2所述的基于生成对抗网络的车牌图像生成方法，其特征在于，训练所述文本替换模型，包括：对训练车牌原图进行文本擦除，得到背景图；基于预先获取的前景文本图和所述背景图合成，得到伪车牌图；将所述目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、所述前景文本图和所述伪车牌图输入至所述文本替换模型中，得到所述文本替换模型输出的车牌训练图；基于所述前景文本图、所述背景图、所述车牌训练图、所述文本骨架图、所述目标文本图和所述伪车牌图构建损失函数，并基于所述损失函数收敛以结束训练。4.根据权利要求3所述的基于生成对抗网络的车牌图像生成方法，其特征在于，所述将所述目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、所述前景文本图和所述伪车牌图输入至所述文本替换模型中，得到所述文本替换模型输出的车牌训练图，包括：将所述目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、所述前景文本图和所述伪车牌图输入至所述文本转换层，得到所述文本转换层输出的前景训练图；将所述训练车牌原图输入至所述背景修复层，得到所述背景修复层输出的背景训练图；将所述前景训练图和所述背景训练图输入至所述文本融合层，得到所述文本融合层输出的车牌训练图。5.根据权利要求4所述的基于生成对抗网络的车牌图像生成方法，其特征在于，所述基于所述前景文本图、所述背景图、所述车牌训练图、所述文本骨架图、所述目标文本图和所述伪车牌图构建损失函数，包括：基于所述伪车牌图、所述目标文本图、所述文本骨架图、所述前景文本图和所述前景训练图构建文本转换损失函数；基于所述伪车牌、所述背景图和所述背景训练图构建背景修复损失函数；基于所述伪车牌图和所述车牌训练图构建文本融合损失函数；基于所述文本转换损失函数、所述背景修复损失函数和所述文本融合损失函数得到损失函数。6.根据权利要求3所述的基于生成对抗网络的车牌图像生成方法，其特征在于，所述对训练车牌原图进行文本擦除，得到背景图，包括：基于所述训练车牌原图及其对应的预先获取的背景原图进行卷积操作，以获得特征图；基于所述特征图进行反卷积操作，生成背景图；基于卷积的中间层特征进行逐层横向连接，以使生成的所述背景图保留所述训练车牌原图的纹理特征。7.根据权利要求3所述的基于生成对抗网络的车牌图像生成方法，其特征在于，在所述基于预先制作的标准字体图、预先获取的前景文本图和所述背景图合成，得到伪车牌图之前，包括：制作具有所述训练车牌原图相同文本内容的标准字体图；基于所述训练车牌原图以及所述背景图进行差值计算，获得所述差值图；利用骨架提取算法对所述差值图进行提取，获得所述文本骨架图；将所述差值图进行二值化，获得背景为黒、文本为白色的文本掩码图；利用所述文本掩码图和所述训练车牌原图进行取交集的图像处理，获得所述前景文本图。8.一种基于生成对抗网络的车牌图像生成系统，其特征在于，包括：获取模块，获取目标文本图和测试车牌原图；文本替换模块，基于所述测试车牌原图和所述目标文本图，得到所述文本替换模块输出的车牌预测图；其中，所述文本替换模块是基于所述训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及所述训练车牌原图训练得到的；所述文本替换模块用于将预先获取的目标文本图的文本内容替换至所述测试车牌原图，得到车牌预测图。9.一种电子设备，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至7任一项所述基于生成对抗网络的车牌图像生成方法的步骤。10.一种非暂态计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1至7任一项所述基于生成对抗网络的车牌图像生成方法的步骤。
说明书desc
技术领域本发明涉及计算机视觉技术领域，尤其涉及一种基于生成对抗网络的车牌图像生成方法及系统。背景技术随着国内机动车的数量不断增多，各种交通管理问题也接连浮现。为了满足交通道路监控、停车场自动管理、车辆跟踪、高速公路自动收费管理等机器自动管理的应用需求，需要对车牌进行自动检测和识别。在深度学习的浪潮推动下，基于深度学习的车牌的检测与识别系统成为了热点问题，然而深度神经网络的训练需要大量的数据，其采集和标注工作的人力成本很高，且很多数据质量较差，容易导致训练数据的数据量不足或图像质量太差不符合应用标准等，是车牌检测识别系统一个很大的限制因素。由于车牌是一种带有文字的真实场景图像，具有固定的格式，因此，目前采用以下方式实现车牌的文本替换，以扩充深度神经网络的训练数据量，包括：图像到图像转换的网络框架方法、全卷积回归网络方法以及风格保留网络方法。其中，图像到图像转换的网络框架方法可以对边缘图进行着色，并从分割图生成相应的真实场景图，如果给定车牌的掩码作为输入，该网络就会输出和车牌掩码上的文本内容相同的车牌图像；FCNR方法以两种样式但文本不同的方式合成数据，该技术的主要思想是随机选择字体、颜色、变形参数来生成样式文本，然后渲染到背景图像上；SRNet方法在场景文本编辑方面表现出了较好的性能，可以在保持原图背景纹理的同时改变文本内容。然而，图像到图像转换的网络框架方法生成车牌图像的图像质量较差，且该方法需要配对的数据作为训练集，然而现实世界中很多图像并没有对应配对的图像；FCNR方法合成出的文本图像与真实场景的图像存在较大差距；SRNet方法只能使用自然场景图像数据集合成的数据进行训练，且多是针对英文进行训练，另外，其对于原图中的字体形态等保持较差，在英语以外其他国家的车牌图像生成任务上的泛化能力差。发明内容本发明提供一种基于生成对抗网络的车牌图像生成方法及系统，用以解决现有技术中生成的车牌图像质量较差且目标文本不可控的缺陷，实现生成图像质量清晰、风格逼真的车牌图像。本发明提供了一种基于生成对抗网络的车牌图像生成方法，包括：获取目标文本图和测试车牌原图；将所述测试车牌原图和所述目标文本图输入至文本替换模型中，得到所述文本替换模型输出的车牌预测图；其中，所述文本替换模型是基于所述训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及所述训练车牌原图训练得到的；所述文本替换模型用于将预先获取的目标文本图的文本内容替换至所述测试车牌原图，得到车牌预测图。根据本发明提供的一种基于生成对抗网络的车牌图像生成方法，所述文本替换模型，包括：文本转换层，基于所述测试车牌原图将所述目标文本图的前景风格转换为所述测试车牌原图的前景风格，得到目标文本前景图；背景修复层，对所述测试车牌原图进行文本擦除和纹理填充，形成车牌背景图；文本融合层，将所述目标文本前景图和所述车牌背景图进行文本融合，得到车牌预测图。根据本发明提供的一种基于生成对抗网络的车牌图像生成方法，训练所述文本替换模型，包括：对训练车牌原图进行文本擦除，得到背景图；基于预先获取的前景文本图和所述背景图合成，得到伪车牌图；将所述目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、所述前景文本图和所述伪车牌图输入至所述文本替换模型中，得到所述文本替换模型输出的车牌训练图；基于所述前景图、所述背景图、所述车牌训练图、所述文本骨架图、所述目标文本图和所述伪车牌图构建损失函数，并基于所述损失函数收敛以结束训练。根据本发明提供的一种基于生成对抗网络的车牌图像生成方法，所述将所述目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、所述前景文本图和所述伪车牌图输入至所述文本替换模型中，得到所述文本替换模型输出的车牌训练图，包括：将所述目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、所述前景文本图和所述伪车牌图输入至所述文本转换层，得到所述文本转换层输出的前景训练图；将所述训练车牌原图输入至所述背景修复层，得到所述背景修复层输出的背景训练图；将所述前景训练图和所述背景训练图输入至所述文本融合层，得到所述文本融合层输出的车牌训练图。根据本发明提供的一种基于生成对抗网络的车牌图像生成方法，所述基于所述前景文本图、所述背景图、所述车牌训练图、所述文本骨架图、所述目标文本图和所述伪车牌图构建损失函数，包括：基于所述伪车牌图、所述目标文本图、所述文本骨架图、所述前景文本图和所述前景训练图构建文本转换损失函数；基于所述伪车牌、所述背景图和所述背景训练图构建背景修复损失函数；基于所述伪车牌图和所述车牌训练图构建文本融合损失函数；基于所述文本转换损失函数、所述背景修复损失函数和所述文本融合损失函数得到损失函数。根据本发明提供的一种基于生成对抗网络的车牌图像生成方法，所述对训练车牌原图进行文本擦除，得到背景图，包括：基于所述训练车牌原图及其对应的预先获取的背景原图进行卷积操作，以获得特征图；基于所述特征图进行反卷积操作，生成背景图；基于卷积的中间层特征进行逐层横向连接，以使生成的所述背景图保留所述训练车牌原图的纹理特征。根据本发明提供的一种基于生成对抗网络的车牌图像生成方法，在所述基于预先制作的标准字体图、预先获取的前景文本图和所述背景图合成，得到伪车牌图之前，包括：制作具有所述训练车牌原图相同文本内容的标准字体图；基于所述训练车牌原图以及所述背景图进行差值计算，获得所述差值图；利用骨架提取算法对所述差值图进行提取，获得所述文本骨架图；将所述差值图进行二值化，获得背景为黒、文本为白色的文本掩码图；利用所述文本掩码图和所述训练车牌原图进行取交集的图像处理，获得所述前景文本图。本发明还提供了一种基于生成对抗网络的车牌图像生成系统，包括：获取模块，获取目标文本图和测试车牌原图；文本替换模块，基于所述测试车牌原图和所述目标文本图，得到所述文本替换模块输出的车牌预测图；其中，所述文本替换模块是基于所述训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及所述训练车牌原图训练得到的；所述文本替换模块用于将预先获取的目标文本图的文本内容替换至所述测试车牌原图，得到车牌预测图。本发明还提供了一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如上述任一种所述基于生成对抗网络的车牌图像生成方法的步骤。本发明还提供了一种非暂态计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如上述任一种所述基于生成对抗网络的车牌图像生成方法的步骤。本发明提供的基于生成对抗网络的车牌图像生成方法及系统，通过文本替换模型基于预先获取的目标文本图对测试车牌原图进行文本替换，以获得具有目标文本图的文本内容以及测试车牌原图背景的车牌测试图，从而生成新车牌，并确保生成的新车牌保持原车牌背景和文字风格等特征，并对车牌原图的车牌序列号进行替换，以有效扩充数据集。附图说明为了更清楚地说明本发明或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明提供的基于生成对抗网络的车牌图像生成方法的流程示意图；图2是本发明提供的文本替换模型的训练流程示意图；图3是本发明提供的基于生成对抗网络的车牌图像生成方法的车牌图像示例；图4是本发明提供的文本替换模型的训练集示例；图5是本发明提供的基于生成对抗网络的车牌图像生成方法的输入与输出示意图；图6是本发明提供的基于生成对抗网络的车牌图像生成结果的示意图；图7是本发明提供的基于生成对抗网络的车牌图像生成系统的结构示意图；图8是本发明提供的电子设备的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。图1示出了本发明一种基于生成对抗网络的车牌图像生成方法的流程示意图，该方法包括：S01，获取目标文本图和测试车牌原图；S02，将测试车牌原图和目标文本图输入至文本替换模型中，得到文本替换模型输出的车牌预测图；其中，文本替换模型是基于训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及训练车牌原图训练得到的；文本替换模型用于将预先获取的目标文本图的文本内容替换至测试车牌原图，得到车牌预测图。需要说明的是，本说明书中的S0N不代表基于生成对抗网络的车牌图像生成方法的先后顺序，下面结合图2-图6具体描述本发明的基于生成对抗网络的车牌图像生成方法。步骤S01，获取目标文本图和测试车牌原图。本实施例中，目标文本图为根据需求形成，目标文本图是在给定目标文本的前提下使用固定的字体、颜色、背景等属性制作得到的；目标文本图的文本内容与测试车牌原图中的文本内容、风格样式不同，从而便于将目标文本图除文本内容以外的其他风格特征渲染成测试车牌原图中的文本风格，比如文字形状、颜色等风格特征。另外，测试车牌原图可基于摄像机、移动端或行车记录仪等具有摄像功能的设备获取。步骤S02，将测试车牌原图和目标文本图输入至文本替换模型中，得到文本替换模型输出的车牌预测图；其中，文本替换模型是基于训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及训练车牌原图训练得到的；文本替换模型用于将预先获取的目标文本图替换至测试车牌原图，得到车牌预测图。本实施例中，文本替换模型，包括：文本转换层，基于所述测试车牌原图将目标文本图的前景风格转换为测试车牌原图的前景风格，得到目标文本前景图；背景修复层，对测试车牌原图进行文本擦除和纹理填充，形成车牌背景图；文本融合层，将目标文本前景图和车牌背景图进行文本融合，得到车牌预测图。通过上述三个模块，以生成具有车牌原图的背景且车牌号替换为指定的目标文本，且确保目标文本的字体和背景风格均保持良好。需要说明的是，通过背景修复层对测试车牌原图进行文本擦除，以避免目标文本前景图对生成的车牌背景图产生干扰，再通过对进行文本擦除后的测试车牌原图进行纹理填充，以使生成的车牌背景图更加逼真。本实施例中，文本转换层包括三个下采样卷积层和四个残差结构，之后经过通道级别的连接将两者融合，再经过三层上采样和一个卷积和多项式乘积-批量归一化-线性整流函数块得到具有测试车牌原图文本风格的目标文本前景图；背景修复层中的编码器是三个下采样卷积层和四个残差模块，解码器是三个上采样卷积层，以生成和测试车牌原图大小一样的车牌背景图；文本融合层包括Encoder-Decoder的FCN结构，然而在Decoder的上采样阶段，需要将背景修复层的解码特征图与相应的具有相同分辨率的特征图连接起来，从而便于背景细节的恢复，以使得目标文本前景图和车牌背景图合成出来的车牌预测图更具有真实感。在一个可选实施例中，基于生成对抗网络的车牌图像生成方法还可以包括如下步骤：参考图2，在将测试车牌原图和预先获取的目标文本图输入至文本替换模型之前，训练文本替换模型，具体包括：S11，对训练车牌原图进行文本擦除，得到背景图；S12，基于预先获取的前景文本图和背景图合成，得到伪车牌图；S13，将目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、前景文本图和伪车牌图输入至文本替换模型中，得到文本替换模型输出的车牌训练图；S14，基于前景图、背景图、车牌训练图、文本骨架图、目标文本图和伪车牌图构建损失函数，并基于损失函数收敛以结束训练。首先，对训练车牌原图进行文本擦除，得到背景图。本实施例中，可采用生成对抗网络模型对训练车牌原图的文本内容进行擦除。生成对抗网络包括图像翻译、图像文本删除、图像文本编辑等。编辑真实图像中的文本是将源图像中的文本替换为另一个文本，同时保持其样式属性，如纹理、字体和亮度等。由于车牌是一种带有文字的真实场景图像，具有固定的格式，因此，利用生成对抗网络来生成车牌图像数据是扩充训练集的数据量和提升图像质量的一种有效方法。具体而言，生成对抗网络网络模型，包括：生成器，基于训练车牌原图进行文本擦除，得到背景图。在本实施例中，利用生成器进行训练，以得到背景图，基于训练车牌原图进行文本擦除，得到背景图，包括：包括：基于训练车牌原图及其对应的预先获取的背景原图进行卷积操作，以获得特征图；基于特征图进行反卷积操作，生成背景图；基于卷积的中间层特征进行逐层横向连接，以使生成的背景图保留训练车牌原图的纹理特征。需要说明的是，背景原图可预先基于手工擦除获得；卷积可采用轻量级残差网络，基于Resnet18的最后一个卷积层，由最后一个完全连接层转换的1×1卷积层应用于预测文本或非文本得分图；反卷积模块由五个反卷积层组成，每个层的内核大小设置为4，跨步步长设置为2，填充大小设置为1。另外，由于较低级别的特征包含较强的语义，而较高级别的特征包含较弱的语义，且较高级别的特征还包含像素级颜色、纹理、对象的位置信息等详细信息，因此通过横向连接模块进行横向连接，以使特征融合时集成较低级别和较高级别的语义特征和纹理特征，从而较好的保留纹理特征，纹理特征表示为车牌图像的表层信息。横向连接模块包括变换块和上采样块，其中：变换块利用卷积模块的中间层作为输入，采用收缩层1×1卷积减小输入特征的要素尺寸，将两个大小相同的3×3卷积层堆叠以执行非线性变换从而代替大内核卷积实现大的接收场，并提高计算效率，再利用扩展层以1×1卷积的方式放大特征图通道；上采样块，利用反卷积模块放大卷积模块输出的特征图；将上采样块的特征映射与变换块中相应的特征映射按元素求和。在一个可选的实施例中，该基于生成对抗网络的车牌图像生成方法还可以包括如下步骤：在利用生成对抗网络网络模型对训练车牌原图进行文本擦除之前，还需要对生成对抗网络网络模型进行训练，训练生成对抗网络网络模型，包括：基于训练车牌原图及其对应的背景原图对发生器进行训练，并输出背景训练预测图；基于背景训练预测图及背景原图输入至判别器内，以基于背景原图判断背景图的真实性；基于生成器和判别器进行交替迭代训练，并基于背景训练预测图和判别结果判断是否停止训练。先基于训练车牌原图及其对应的背景原图构建生成对抗网络模型的训练集，具体包括：获取真实车牌作为训练车牌原图；预先利用人工对训练车牌原图进行手工擦除吗，得到对应的车牌原图。需要说明的是，预先利用手工擦除的训练车牌原图数量可以选择较少数量，比如100张，具体数量可根据实际设计需求确定。真实车牌可选取以首字符为汉字、后续字串由24个英文字母和10个阿拉伯数字组成的，且因不同的光照条件和拍摄角度以及距离远近程度等因素而表现出多种多样的车牌样式，具有特殊性，参考图3。真实车牌的获取包括：利用车辆中的行车记录仪在多省市采集道路数据；和/或，利用摄像头在多省市拍摄车辆数据。应当注意，摄像头可以采用移动设备，比如手机、摄像机等。再对生成对抗网络网络模型进行训练，生成对抗网络网络模型表示为：其中，D代表判别器；G代表生成器；表示为最大化判别器D对于训练车牌原图和背景原图的鉴别能力；表示为最小化判别器D对于生成器G生成的背景训练预测图的鉴别能力；表示为关于x、z的均值，且x服从于z，x表示为训练车牌原图，z表示为与x对应的背景训练预测图；y＝G，G表示为以x，z为输入的生成器G的输出，即背景训练预测图；D)表示为判别器D输出的训练车牌原图与背景训练预测图是否匹配的判别概率。在实际训练过程中，可以先固定生成器G以训练判别器D，在训练判别器D过程中，为了使判别器的分辨真假能力更强，即对于训练车牌原图的判别概率趋向于1，对于生成器生成的背景训练预测图的判别概率趋向于0，以求得判别器D的最大值然后，再固定判别器D训练生成器G，为了确保生成的背景训练预测图较为真实，应使生成器生成的背景训练预测图的判别概率趋向于1，而此时判别器D为常量，以求得发生器G的最小值随后基于生成器和判别器进行交替迭代训练，使得生成器和判别器相互促进，并基于背景训练预测图和判别结果判断是否停止训练。基于背景训练预测图和判别结果判断是否停止训练，包括：基于背景训练预测图和发生器损失函数和判别器损失函数对生成对抗网络模型进行约束，直至发生器损失函数和判别器损失函数收敛，生成的训练车牌背景使判别器难辨真假时，训练结束。基于发生器得到损失函数Lr，表示为：Lr＝LC+LT其中，LC表示为内容损失函数，表示为：其中，Iout表示为从反卷积路径中提取的特征图，即原始输出；Icomp表示为文本擦除区域的输出，Icomp以及Iout的非文本区域构成车牌真实背景；An是第n个选定层的激活图。LT表示为纹理损失函数，表示为：其中，Cn是高级激活图的形状，An是第n个选定层的激活图，用于弥补文本区域和非文本的纹理外观差异区域，以便于网络能够捕获全局样式以更合理地替换文本区域的功能，Iout表示为原始输出，Icomp表示为文本擦除区域的输出。基于判别器得到损失函数LD，表示为：其中，sum表示为比例因子，选取适当的比例以调整不同数量的文本擦除区域，N×N表示为擦除的文本补丁，Li表示为文本补丁对应的标签，Pi表示为判别器预测概率。在对生成对抗网络模型进行训练时，采用Adam优化策略进行优化，具体的，训练时批处理尺寸大小设置为50；初始学习率设置为0.0005；权重衰减参数设置为2×10-4；迭代次数设置为1000轮。其次，基于预先获取的前景文本图和背景图合成，得到伪车牌图。需要说明的是，基于多个训练车牌原图对应的前景文本图、背景图以及预先制作的标准字体图进行自由组合，以得到多个不同组合的伪车牌图，从而便于后续利用伪车牌图为文本替换模型的输入，以文本骨架图和前景文本图作为监督信息，对文本替换模型进行训练。在本实施例中，在生成对抗网络模型训练完成之后，用真实车牌集进行测试以得到大量的背景图，并对其进行筛选得到擦除效果较好的背景图；并基于背景图利用数据增广处理，以1∶15得到多组监督标签图，比如，筛选得到2005张擦除效果较好的背景图，则进行数据增广之后得到30075组增广数据，其中数据增广采用前景文本图和背景图自由组合，增广数据可以为上述标签图像，每组标签图像包含7种标签图像。参考图4，第一行从左往右依次为伪车牌图、文本骨架图、差值图和前景文本图；第二行从左往右依次为车牌背景、车牌原图、文本掩码图。通过上述获取测试标签监督图的方法，对每一张车牌原图进行上述处理，以得到每一张真实车牌都具有其对应的背景图和前景文本图，从而便于后续将真实车牌的第一背景预测图和前景文本图自由组合的图像进行处理，得到拼接而成的伪车牌图。在一个可选实施例中，在基于预先获取的前景文本图和背景图合成，得到伪车牌图之前，包括：基于训练车牌原图以及背景图进行差值计算，获得差值图；利用骨架提取算法对差值图进行提取，获得文本骨架图；将差值图进行二值化，获得背景为黒、文本为白色的文本掩码图；利用文本掩码图和训练车牌原图进行取交集的图像处理，获得前景文本图。需要说明的是，差值图的背景基本为黑色，像素为0，有颜色的像素位置大体轮廓为文本的位置；骨架提取算法主要利用经典图像处理方法中的图像腐蚀与膨胀，以提取文本的笔画信息，根据笔画的宽度设置对应的像素点个数，比如设置3个像素点；前景文本图的像素值与车牌原图中的文本的像素值相同。随后，将目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、前景文本图和伪车牌图输入至文本替换模型中，得到文本替换模型输出的车牌训练图。本实施例中，将目标文本图、预先获取的车牌背景图、预先获取的文本骨架图、前景文本图和伪车牌图输入至文本替换模型中，得到文本替换模型输出的车牌训练图，包括：将预先获取的目标文本图、车牌背景图和文本骨架图以及前景文本图、伪车牌图输入至文本转换层，得到文本转换层输出的前景训练图；将训练车牌原图输入至背景修复层，得到背景修复层输出的背景训练图；将前景训练图和背景训练图输入至文本融合层，得到文本融合层输出的车牌训练图。最后，基于前景文本图、背景图、车牌训练图、文本骨架图、目标文本图和伪车牌图构建损失函数，并基于损失函数收敛以结束训练。先利用具有标准字体文本的目标文本图和伪车牌图对文本转换层进行训练，并输出前景训练图。具体而言，利用前景文本图和文本骨架图对目标文本图进行文本风格转换，即将目标文本图进行样式转换，比如文本颜色、字体以及形状等信息转换，以使生成的前景训练图包含指定文本内容和指定的文本图像样式特征。本实施例中，指定的文本图像样式特征可以为训练车牌原图的前景文本特征。再基于伪车牌图、目标文本图、文本骨架图、前景训练图和前景文本图，构建文本转换损失函数，并根据文本转换损失函数收敛以结束训练，文本转换损失函数LT，表示为：其中，GT表示文本转换层的生成器；It表示为前景文本图；Is表示输入文本转换层的伪车牌图；Tt表示为前景文本图；GT表示为生成器生成的前景训练图；||Tt-GT||1表示为利用L1范数是对Tt和GT的绝对误差进行约束；Tsk表示为文本骨架图，用于约束Osk训练；Osk表示为输出的文本骨架图；表示为对Tsk和Osk做像素级求和以及交并比，从而便于判别Tsk和Osk的相似度；表示为Tsk和Osk的差异；α为系数。在训练过程中，最小化LT函数以使生成器生成的前景预测图与前景文本图尽可能相同。利用伪车牌对背景修复层进行训练，并输出背景训练图；基于伪车牌、背景训练图和背景图，构建背景修复损失函数，并根据背景修复损失函数收敛以结束训练。背景修复损失函数LB表示为：其中，DB表示为背景修复层的判别器；GB表示为背景修复层的生成器；Is表示为伪车牌；Tb表示为背景图；表示为关于Tb、Is的均值；DB表示为判别器输出的背景图与训练车牌原图是否匹配的判别概率；表示为关于Is的均值；GB表示为判别器基于伪车牌生成的背景训练图；DB，Is)表示为判别器输出的背景训练图和伪车牌是否匹配的判别概率；β表示为超参数；β||Tb-GB||1表示为L1范数，即最小化生成器生成的背景图与背景训练图之间的绝对误差。利用前景训练图和背景训练图对文本融合层进行训练，并输出车牌训练图；基于车牌训练图和伪车牌图，构建文本融合损失函数，并根据文本融合损失函数收敛以结束训练，文本融合损失函数LF表示为：其中，GF和DF分别为文本融合层的生成器和判别器，Tf和Of分别是输出端的伪车牌图和生成器预测出的车牌训练图；表示为关于Tf、It的均值；Df表示为判别器输出的伪车牌图与前景文本图是否匹配的判别概率；表示为关于It的均值；DF表示为判别器输出的生成器预测出的车牌训练图与前景文本图是否匹配的判别概率。需要说明的是，通过文本转换层、背景修复层和文本融合层的损失函数的约束，对文本转换层、背景修复层和文本融合层进行多次迭代训练，若文本转换损失函数、背景修复损失函数和文本融合损失函数收敛，使得输出的车牌训练图与伪车牌效果几乎相同，则训练结束。在对文本替换模型进行训练时，批处理尺寸大小设置为8；初始学习率设置为0.0001；最大迭代次数设置为50000次；动量参数设置为0.9。在训练完成之后，为确保实验结果的有效性，对其结果进行验证。为了实现车牌图像的生成，可直接测试第二阶段的车牌训练图，参考附图5，在给定一个输入验证车牌原图和一个具有标准字体的目标文本图的情况下，可以实现输出一张具有验证车牌原图背景和标准字体文本图的目标文本的新车牌图像，且能够保持验证车牌原图文本内容以外的背景以及文本的字体形状、颜色、图像的亮度等条件，保持了真实车牌图像的背景与前景文字的协调性和真实感，确保生成的车牌验证图保留验证车牌原图的背景及文本风格。更多的生成车牌示例可见附图6，其中每一行代表由一张车牌原图所生成出的多张省份不同、车牌序列号不同的新车牌，且其能够保持车牌背景以及前景文字的风格特征，生成车牌的各个字符结构笔画正确且与背景具有协调性。该结果图证明，本申请不仅可以解决图像质量清晰光线及位置正常良好情况下的车牌生成，对于整体亮度较暗、光线照射造成的阴影、或车牌位置略带偏移以及对于一定的曝光情况下的车牌图像，也可以很好的保持原车牌图像的背景和前景风格，确保只改变其车牌号文本，使得生成车牌训练测试图像与真实车牌图像较为相似，且真实感较强。综上所述，本发明通过文本替换模型基于预先获取的目标文本图对测试车牌原图进行文本替换，以获得具有目标文本图的文本内容以及测试车牌原图背景的车牌测试图，从而生成新车牌，并确保生成的新车牌保持原车牌背景和文字风格等特征，并对车牌原图的车牌序列号进行替换，以有效扩充数据集。下面对本发明提供的基于生成对抗网络的车牌图像生成系统进行描述，下文描述的基于生成对抗网络的车牌图像生成系统与上文描述的基于生成对抗网络的车牌图像生成方法可相互对应参照。参考图7，图7示出了一种基于生成对抗网络的车牌图像生成系统，该系统包括：获取模块71，获取目标文本图和测试车牌原图；文本替换模块72，基于输入的测试车牌原图和预先获取的目标文本图，得到所述文本替换模块72输出的车牌预测图；其中，所述文本替换模块72是基于所述训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及所述训练车牌原图训练得到的；所述文本替换模块72用于将预先获取的目标文本图的文本内容替换至所述测试车牌原图，得到车牌预测图。具体而言，获取模块71包括绘制单元和摄像单元，其中，绘制单元，用于根据给定目标文本内容和标准字体绘制，得到目标文本图；摄像单元，用于摄取车牌图像作为测试车牌原图，以便于后续将其输入至文本替换模块72内。文本替换模块72包括文本转换单元，基于所述测试车牌原图将所述目标文本图的前景风格转换为所述测试车牌原图的前景风格，得到目标文本前景图；背景修复单元，对所述测试车牌原图进行文本擦除和纹理填充，形成车牌背景图；文本融合单元，将所述目标文本前景图和所述车牌背景图进行文本融合，得到车牌预测图。通过上述三个单元，以生成具有车牌原图的背景且车牌号替换为指定的目标文本，且确保目标文本的字体和背景风格均保持良好。在一个可选实施例中，为便于对该文本替换模块72进行训练，该系统还包括文本擦除模块和车牌合成模块，其中，文本擦除模块，用于对训练车牌原图进行文本擦除，得到背景图；车牌合成模块，用于基于预先获取的前景文本图和所述背景图合成，得到伪车牌图。本实施例中，文本擦除模块包括发生器，基于训练车牌原图进行文本擦除，得到背景图。更进一步地说，发生器包括：卷积单元，基于训练车牌原图及其对应的预先获取的背景原图进行卷积操作，以获得特征图；反卷积单元，基于特征图进行反卷积操作，生成背景图；横向连接单元，基于卷积单元的中间层特征进行逐层横向连接，以保留纹理特征。需要说明的是，背景原图可基于手工擦除获得。车牌合成模块，包括：计算单元，基于训练车牌原图以及背景图进行差值计算，以获得差值图；提取单元，利用骨架提取算法对差值图进行提取，以获得文本骨架图；二值化单元，将差值图进行二值化，以获得背景为黒、文本为白色的文本掩码图；交并单元，利用文本掩码图和测试车牌原图进行取交集的图像处理，以获得前景文本图。图8示例了一种电子设备的实体结构示意图，如图8所示，该电子设备可以包括：处理器810、通信接口820、存储器830和通信总线840，其中，处理器810，通信接口820，存储器830通过通信总线840完成相互间的通信。处理器810可以调用存储器830中的逻辑指令，以执行基于生成对抗网络的车牌图像生成方法，该方法包括：获取目标文本图和测试车牌原图；将测试车牌原图和目标文本图输入至文本替换模型中，得到文本替换模型输出的车牌预测图；其中，文本替换模型是基于训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及训练车牌原图训练得到的；文本替换模型用于将预先获取的目标文本图的文本内容替换至测试车牌原图，得到车牌预测图。此外，上述的存储器830中的逻辑指令可以通过软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。另一方面，本发明还提供一种计算机程序产品，所述计算机程序产品包括存储在非暂态计算机可读存储介质上的计算机程序，所述计算机程序包括程序指令，当所述程序指令被计算机执行时，计算机能够执行上述各方法所提供的基于生成对抗网络的车牌图像生成方法，该方法包括：获取目标文本图和测试车牌原图；将测试车牌原图和目标文本图输入至文本替换模型中，得到文本替换模型输出的车牌预测图；其中，文本替换模型是基于训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及训练车牌原图训练得到的；文本替换模型用于将预先获取的目标文本图的文本内容替换至测试车牌原图，得到车牌预测图。又一方面，本发明还提供一种非暂态计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现以执行上述各提供的基于生成对抗网络的车牌图像生成方法，该方法包括：获取目标文本图和测试车牌原图；将测试车牌原图和目标文本图输入至文本替换模型中，得到文本替换模型输出的车牌预测图；其中，文本替换模型是基于训练车牌原图进行文本擦除得到的背景训练图形成的伪车牌图以及训练车牌原图训练得到的；文本替换模型用于将预先获取的目标文本图的文本内容替换至测试车牌原图，得到车牌预测图。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到各实施方式可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在计算机可读存储介质中，如ROM/RAM、磁碟、光盘等，包括若干指令用以使得一台计算机设备执行各个实施例或者实施例的某些部分所述的方法。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
