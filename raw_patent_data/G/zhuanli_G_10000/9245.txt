标题title
一种基于混合卡尔曼滤波的模糊度固定方法
摘要abst
本发明公开了一种基于混合卡尔曼滤波的模糊度固定方法，通过接收机观测卫星，获取诸如伪距观测值、载波相位观测值以及卫星钟差等数据，计算得到双差观测方程，多个卫星对应双差观测方程组，由该双差观测方程组、卡尔曼观测方程、接收机状态方程以及模糊度轨迹方程构建混合卡尔曼滤波估计模型，对接收机状态方程和模糊度轨迹方程进行边缘化粒子滤波，获得有限个解的模糊度整数解集合，由于边缘化粒子滤波可以对模糊度的范围进行预测，在使用上述混合卡尔曼滤波估计模型对模糊度进行搜索解算时，整周模糊度的解会限定在一个较小的范围，在接收机发生断电、周跳等导致卫星失锁的状态下，能够快速的得到整周模糊度的解。
权利要求书clms
1.一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于，包括以下步骤：基于接收机观测卫星获取的观测值，计算双差观测方程；基于所述双差观测方程、接收机状态以及模糊度轨迹构建混合卡尔曼滤波估计模型；对所述接收机状态和所述模糊度轨迹进行边缘化粒子滤波，获得模糊度整数解集合；在所述模糊度整数解集合的范围内，使用所述混合卡尔曼滤波估计模型，对所述接收机状态和所述模糊度轨迹进行估计，得到整周模糊度的解。2.根据权利要求1所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于，所述基于接收机观测卫星获取的观测值，计算双差观测方程，包括步骤：通过基准站接收机与流动站接收机在同一时刻对两颗卫星的观测值，构建标准观测值方程；对所述基准站接收机与所述流动站接收机的同时对所述两颗卫星进行线性组合，计算得到双差观测方程。3.根据权利要求2所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于，所述通过基准站接收机与流动站接收机在同一时刻对两颗卫星的观测值，构建标准观测值方程，对所述基准站接收机与所述流动站接收机的同时对所述两颗卫星进行线性组合，计算得到双差观测方程，包括步骤：构建在k历元时刻的标准观测方程:式中，上标j为卫星标识，Pj表示伪距观测值；ρj表示接收机到j卫星的实际距离；c为光速；δtr为接收机钟差；δtj为卫星钟差；Ij为电离层延迟；Tj为对流层延迟；∈j表示伪距观测噪声；φj为载波相位观测值；λ为载波波长；nj为整周模糊度；ηj为载波相位观测噪声；对基准站接收机b和流动站接收机r的同时对卫星j和l的观测值进行线性组合，计算得到双差观测方程：4.根据权利要求1所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于：所述模糊度轨迹是非线性的。5.根据权利要求4所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于，所述模糊度轨迹表示为：其中，Qn为模糊度噪声的协方差矩阵，贝叶斯表达方式为nk+1～p。6.根据权利要求5所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于，所述基于所述双差观测方程、接收机状态以及模糊度轨迹构建混合卡尔曼滤波估计模型包括步骤：设两个接收机有共同观测的卫星数为M+1，计算双差观测方程组合：根据卡尔曼滤波的观测方程为将所述双差观测方程组合转化为矩阵形式为：其中，构建所述接收机状态的状态方程：xk+1＝Fkxk+Bkωx,k式中，Fk为状态转移矩阵；Bk为噪声转移矩阵；ωx,k表示呈高斯分布的噪声；状态向量xk＝T，pr,k和vr,k分别表示接收机在k历元时刻的位置和速度；构建随机游走模型表示所述模糊度轨迹：其中，Qn为模糊度噪声的协方差矩阵，贝叶斯表达方式为：nk+1～p。7.根据权利要求1所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于，所述对所述接收机状态和模糊度进行边缘化粒子滤波，获得模糊度整数解集合，包括步骤：构建接收机状态和模糊度轨迹的联合概率密度：p＝pp用一个含N个权重粒子的粒子滤波器对p进行估计，得到：式中，δ为狄拉克函数；为给定观测值y0:k相对应的i粒子的权重；对p进行扩展卡尔曼滤波，其高斯近似为：式中，为由模糊度轨迹n0:k和相关协方差Pk|k所约束的状态估计；通过扩展卡尔曼滤波对条件概率密度函数的均值和协方差进行计算：Pk|k＝Pk|k-1-KkHkPk|k-1计算均值和协方差的一步预测方程：更新粒子权重计算方式：选择nk+1～p中的条件概率分布作为粒子滤波器的重要性采样：获得其概率密度函数：简化粒子权重更新关系式：对样本进行采样，得到观测方程的边缘化粒子滤波器：取初始协方差矩阵为无穷大：更新粒子权重似然函数：根据粒子权重对模糊度集合进行重采样，得到粒子的归一化权重近似模糊度的后验概率：使用核密度函数对离散的模糊度后验概率分布进行平滑处理：式中，Kh为高斯核密度函数；h表示带宽；对进行平滑处理后的上式进行截断处理，得到包含Ns个模糊度向量整数解的集合：8.根据权利要求1所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于：通过最大似然估计得到整周模糊度的解。9.根据权利要求8所述的一种基于混合卡尔曼滤波的模糊度固定方法，其特征在于，所述在所述模糊度整数解集合的范围内，使用所述混合卡尔曼滤波估计模型，对每颗卫星对应的模糊度进行估计，得到整周模糊度的解，包括步骤：基于Ns个模糊度向量整数解，得到Ns个扩展卡尔曼滤波器来求解状态向量根据全概率公式，使用高斯混合分布表示状态的后验概率：其中，为的后验概率；用替代对和进行递归计算，根据贝叶斯法则，计算后验概率：其中，和通过对应的扩展卡尔曼滤波器计算得到；通过最大似然估计得到整周模糊度的解：
说明书desc
技术领域本发明涉及模糊度固定技术领域，特别涉及一种基于混合卡尔曼滤波的模糊度固定方法。背景技术全球卫星导航系统已经在全世界范围内获得了广泛的应用。GNSS接收机的定位方式通常有两种，即通过伪距观测值或载波相位观测值进行定位。由于载波相位观测值的定位方式相比伪距观测值的精度更高，已经成为GNSS高精度定位的重要手段，而寻找正确的整周模糊度是进行载波相位解算的基本前提。传统的模糊度解算方法一般先通过卡尔曼滤波估计一个浮点近视解，然后以此为基础，采用整数最小二乘等方法搜索模糊度的整数精确解。传统模糊度解算方法虽然能很好的解算出整周模糊度，但是当接收机发生断电、周跳等导致卫星失锁时，这些解算方法需要对模糊度进行重新估计、搜索，导致计算效率的降低，非常耽误时间。发明内容本发明旨在至少解决现有技术中存在的技术问题。为此，本发明提出一种基于混合卡尔曼滤波的模糊度固定方法，该方法通过先对模糊度进行边缘化粒子滤波来获取一个较小范围的模糊度整数解，再利用卡尔曼滤波获取接收机状态和模糊度进行精确估计。在接收机发生卫星失锁的情况时，实现快速固定模糊度的效果。本发明实施例提供的一种基于混合卡尔曼滤波的模糊度固定方法，包括以下步骤：基于接收机观测卫星获取的观测值，计算双差观测方程；基于所述双差观测方程、接收机状态以及模糊度轨迹构建混合卡尔曼滤波估计模型；对所述接收机状态和所述模糊度轨迹进行边缘化粒子滤波，获得模糊度整数解集合；在所述模糊度整数解集合的范围内，使用所述混合卡尔曼滤波估计模型，对所述接收机状态和所述模糊度轨迹进行估计，得到整周模糊度的解。根据本发明的实施例，至少具有如下技术效果：基于接收机观测卫星，获取诸如伪距观测值、载波相位观测值以及卫星钟差等数据，计算得到双差观测方程，多个卫星对应双差观测方程组，由该双差观测方程组、卡尔曼观测方程、接收机状态方程以及模糊度轨迹方程构建混合卡尔曼滤波估计模型，对接收机状态方程和模糊度轨迹方程进行边缘化粒子滤波，获得有限个解的模糊度整数解集合，由于边缘化粒子滤波可以对模糊度的范围进行预测，在使用上述混合卡尔曼滤波估计模型对模糊度进行搜索解算时，整周模糊度的解会限定在一个较小的范围，在接收机发生断电、周跳等导致卫星失锁的状态下，能够快速的得到整周模糊度的解。根据本发明的一些实施例，所述基于接收机观测卫星获取的观测值，计算双差观测方程，包括步骤：通过基准站接收机与流动站接收机在同一时刻对两颗卫星的观测值，构建标准观测值方程；对所述基准站接收机与所述流动站接收机的同时对所述两颗卫星进行线性组合，计算得到双差观测方程。根据本发明的一些实施例，所述通过基准站接收机与流动站接收机在同一时刻对两颗卫星的观测值，构建标准观测值方程，对所述基准站接收机与所述流动站接收机的同时对所述两颗卫星进行线性组合，计算得到双差观测方程，包括步骤：构建在k历元时刻的标准观测方程:式中，上标j为卫星标识，Pj表示伪距观测值；ρj表示接收机到j卫星的实际距离；c为光速；δtr为接收机钟差；δtj为卫星钟差；Ij为电离层延迟；Tj为对流层延迟；εj表示伪距观测噪声；φj为载波相位观测值；λ为载波波长；nj为整周模糊度；ηj为载波相位观测噪声；对基准站接收机b和流动站接收机r的同时对卫星j和l的观测值进行线性组合，计算得到双差观测方程：根据本发明的一些实施例，所述模糊度轨迹是非线性的。根据本发明的一些实施例，所述模糊度轨迹表示为：nk+1＝nk+ωn,k,其中，Qn为模糊度噪声的协方差矩阵，该式的贝叶斯表达方式为nk+1～p。根据本发明的一些实施例，所述基于所述双差观测方程、接收机状态以及模糊度轨迹构建混合卡尔曼滤波估计模型包括步骤：设两个接收机有共同观测的卫星数为M+1，计算双差观测方程组合：根据卡尔曼滤波的观测方程为将所述双差观测方程组合转化为矩阵形式为：其中，构建所述接收机状态的状态方程：xk+1＝Fkxk+Bkωx,k；式中，Fk为状态转移矩阵；Bk为噪声转移矩阵；ωx,k表示呈高斯分布的噪声；状态向量xk＝T，pr,k和vr,k分别表示接收机在k历元时刻的位置和速度；构建随机游走模型表示所述模糊度轨迹：nk+1＝nk+ωn,k,其中，Qn为模糊度噪声的协方差矩阵，贝叶斯表达方式为：nk+1～p。根据本发明的一些实施例，所述对所述接收机状态和模糊度进行边缘化粒子滤波，获得模糊度整数解集合包括步骤：构建接收机状态和模糊度轨迹的联合概率密度：p＝pp；用一个含N个权重粒子的粒子滤波器对p进行估计，得到：式中，δ为狄拉克函数；为给定观测值y0:k相对应的i粒子的权重；对p进行扩展卡尔曼滤波，其高斯近似为：式中，为由模糊度轨迹n0:k和相关协方差Pk|k所约束的状态估计；通过扩展卡尔曼滤波对条件概率密度函数的均值和协方差进行计算：Pk|k＝Pk|k-1-KkHkPk|k-1计算均值和协方差的一步预测方程：更新粒子权重计算方式：选择nk+1～p中的条件概率分布作为粒子滤波器的重要性采样：获得其概率密度函数：简化粒子权重更新关系式：对样本进行采样，得到观测方程的边缘化粒子滤波器：取初始协方差矩阵为无穷大：更新粒子权重似然函数：根据粒子权重对模糊度集合进行重采样，得到粒子的归一化权重近似模糊度的后验概率：使用核密度函数对离散的模糊度后验概率分布进行平滑处理：式中，Kh为高斯核密度函数；h表示带宽；对进行平滑处理的上式进行截断处理，得到包含Ns个模糊度向量整数解的集合：根据本发明的一些实施例，通过最大似然估计得到整周模糊度的解。根据本发明的一些实施例，所述在所述模糊度整数解集合的范围内，使用所述混合卡尔曼滤波估计模型，对每颗卫星对应的模糊度进行估计，得到整周模糊度的解包括步骤：基于Ns个模糊度向量整数解，得到Ns个扩展卡尔曼滤波器来求解状态向量根据全概率公式，使用高斯混合分布表示状态的后验概率：其中，为的后验概率；用替代对和进行递归计算，根据贝叶斯法则，计算后验概率：其中，和通过对应的扩展卡尔曼滤波器计算得到；通过最大似然估计得到整周模糊度的解：本发明的附加方面和优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明本发明的上述和/或附加的方面和优点从结合下面附图对实施例的描述中将变得明显和容易理解，其中：图1为本发明实施例提供的一种基于混合卡尔曼滤波的模糊度固定方法的流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行完整地描述,显然，所描述的实施例仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。非另有定义，本发明所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。本发明中在本发明的说明书中所使用的术语只是为了描述具体的实施例的目的，不是在于限制本发明。实施例1参照图1，本发明实施例提供了一种基于混合卡尔曼滤波的模糊度固定方法，包括以下步骤：步骤S110：基于接收机观测卫星获取的观测值，计算双差观测方程。接收机的主要作用是从空中存在的众多电磁波中，选出自己需要的频率成分，抑制或滤除不需要的信号或噪声与干扰信号，然后经过放大、解调得到原始的有用信息。在本实施例中，接收机接收卫星发射的电磁波，获取到诸如伪距观测值、载波相位观测值以及载波相位观测噪声等观测值，再结合接收机钟差、卫星钟差、电离层延迟、对流层延迟以及接收机到卫星距离等数据，可以构建标准观测方程，为了消除一些无关因素的影响，对两个卫星的标准观测方程进行求差处理，得到双差观测方程。步骤S120：基于双差观测方程、接收机状态以及模糊度轨迹构建混合卡尔曼滤波估计模型。卡尔曼滤波是一种利用线性系统状态方程，通过系统输入输出观测数据，对系统状态进行最优估计的算法。由于观测数据中包括系统中的噪声和干扰的影响，所以最优估计也可看作是滤波过程。在本实施中，多个卫星进行两两线性组合，对应得到双差观测方程组，将此双差观测方程组作为卡尔曼滤波的观测方程。模糊度一般不会随着时间变化而变化，但是一些其它因素例如接收机断电、周跳等导致卫星失锁发生，模糊度会发生不可预期的变化。因此，模糊度的这个变化过程可以用一个随机游走模型来表示。在本实施例中，将接收机状态方程和模糊度轨迹方程作为为卡尔曼滤波的状态方程。步骤S130：对接收机状态和模糊度轨迹进行边缘化粒子滤波，获得模糊度整数解集合。在本实施例中，将接收机状态和模糊度轨迹进行联合，构成概率密度方程，通过粒子滤波寻找一组在状态空间中传播的随机样本来近似的表示概率密度函数，用样本均值代替积分运算，进而获得系统状态的最小方差估计。步骤S140：在模糊度整数解集合的范围内，使用混合卡尔曼滤波估计模型，对接收机状态和模糊度轨迹进行估计，得到整周模糊度的解。在本实施例中，由于粒子滤波可以通过观测值和条件概率密度分布对模糊度的范围进行预测，在使用混合卡尔曼滤波估计模型对每颗卫星对应的模糊度进行估计时，整周模糊度的解会限定在一个较小的范围，在接收机发生断电、周跳等导致卫星失锁的状态下，能够快速的得到整周模糊度的解。传统的模糊度解算方法一般先通过卡尔曼滤波估计一个浮点近视解，然后以此为基础，采用整数最小二乘等方法搜索模糊度的整数精确解，该方法虽然能很好的解算出整周模糊度，但是当接收机发生断电、周跳等导致卫星失锁时，这些解算方法需要对模糊度进行重新估计、搜索，导致计算效率的降低，非常耽误时间。本发明实施例提供一种基于混合卡尔曼滤波的模糊度固定方法，通过接收机观测卫星，获取诸如伪距观测值、载波相位观测值以及卫星钟差等数据，计算得到双差观测方程，多个卫星对应双差观测方程组，由该双差观测方程组、卡尔曼观测方程、接收机状态方程以及模糊度轨迹方程构建混合卡尔曼滤波估计模型，对接收机状态方程和模糊度轨迹方程进行边缘化粒子滤波，获得有限个解的模糊度整数解集合，由于边缘化粒子滤波可以对模糊度的范围进行预测，在使用上述混合卡尔曼滤波估计模型对模糊度进行搜索解算时，整周模糊度的解会限定在一个较小的范围，在接收机发生断电、周跳等导致卫星失锁的状态下，能够快速的得到整周模糊度的解。实施例2以实施例1为基础，本发明实施例提供了一种基于混合卡尔曼滤波的模糊度固定方法，包括以下步骤：步骤一：计算双差观测值在k历元时刻的标准观测方程为:式中，上标j为卫星标识，Pj表示伪距观测值；ρj表示接收机到j卫星的实际距离；c为光速；δtr为接收机钟差；δtj为卫星钟差；Ij为电离层延迟；Tj为对流层延迟；∈j表示伪距观测噪声；φj为载波相位观测值；λ为载波波长；nj为整周模糊度；ηj为载波相位观测噪声。对基准站b和流动站接收机r的同时对卫星j和l的观测值进行线性组合，可计算得到双差观测方程：步骤二：构建混合卡尔曼滤波估计模型若两个接收机有共同观测的卫星数为M+1，相应则有M组双差观测方程组合：卡尔曼滤波的观测方程为:其矩阵形式为：其中，流动站接收机的运动状态的状态方程为：xk+1＝Fkxk+Bkωx,k 式中，Fk为状态转移矩阵；Bk为噪声转移矩阵；ωx,k表示呈高斯分布的噪声；状态向量xk＝T，pr,k和vr,k分别表示接收机在k历元时刻的位置和速度。模糊度一般不会随着时间变化而变化，但是一些其它因素例如接收机断电、周跳等导致卫星失锁发生，模糊度会发生不可预期的变化。因此，模糊度的这个变化过程可以用一个随机游走模型来表示：其中，Qn为模糊度噪声的协方差矩阵，上式的贝叶斯表达方式为：nk+1～p 步骤三：预测模糊度的取值范围模糊度的范围可以利用粒子滤波的方式来确定，然后扩展卡尔曼滤波来对接收机的状态进行解算。接收机状态xk和模糊度轨迹的联合概率密度为：p＝pp 先用一个包含N个权重粒子的粒子滤波器对p进行估计，可得到：式中，δ为狄拉克函数；为给定观测值y0:k相对应的i粒子的权重。对于给定的模糊度集合对p进行扩展卡尔曼滤波，其高斯近似为：上式中，为由模糊度轨迹n0:k和相关协方差Pk|k所约束的状态估计。条件概率密度函数的均值和协方差可以通过以下扩展卡尔曼滤波进行计算：均值和协方差的一步预测方程为：粒子权重更新计算方式为：选择式中的条件概率分布作为粒子滤波器的重要性采样：其概率密度函数：粒子权重更新关系式可简化为：在式中，观测方程的模糊度向量具有线性高斯分布的特性，对其中的样本进行采样，得到观测方程的边缘化粒子滤波器：因为没有模糊度的先验信息，取初始协方差矩阵Qn为无穷大，则有：粒子权重更新的似然函数为：根据粒子权重对模糊度集合进行重采样，得到粒子的归一化权重模糊度的后验概率可近似为：使用核密度函数对离散的模糊度后验概率分布进行平滑，使其连续化：式中，Kh为高斯核密度函数；h表示带宽。对上式进行截断处理，可以得到包含Ns个模糊度向量整数解的集合：步骤四：解算模糊度基于Ns个模糊度向量整数解，可以得到Ns个扩展卡尔曼滤波器来求解状态向量根据全概率公式，状态的后验概率可以用Ns个参数的高斯混合分布表示：式中，为的后验概率。用替代式中的对和进行递归计算。根据贝叶斯法则，可计算出后验概率：其中，和可通过对应的扩展卡尔曼滤波器计算得到。最后，通过最大似然估计得到整周模糊度的解：该基于混合卡尔曼滤波的模糊度固定方法通过构建一个混合卡尔曼滤波估计模型，先利用边缘化卡粒子滤波对模糊度的组合的结果进行预测，然后用一组混合卡尔曼滤波器对每颗卫星对应的模糊度和接收机的状态参数进行估计，直接获得模糊度的精确解。因为模糊度的取值范围被限定在一个较小的范围内，模糊度的解算速度能有效的提高。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。尽管已经示出和描述了本发明的实施例，本领域的普通技术人员可以理解：在不脱离本发明的原理和宗旨的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由权利要求及其等同物限定。
