标题title
基于深度学习和计权型多因子评价的测土配方施肥方法
摘要abst
本发明提供了一种基于深度学习和计权型多因子评价的测土配方施肥方法，包括以下步骤：将土壤数据和地块产量数据进行整理和归档，并进行归一化处理和添加标签操作，得到样本数据；针对不同作物对不同化学元素敏感度的差异设置对应的权重，利用分肥力系数标准公式和改进的内梅罗指数法对土壤的肥力状况和重金属污染状况划分等级，得出综合肥力指数；通过计权型多因子评价改进经典遗传算法中的适应度函数，通过适应度函数选取合适的子代数据来进行数据增强，扩充数据样本；使用扩充的数据样本对神经网络模型进行训练，得出作物的产量预测与配肥补肥策略。本发明解决了神经网络要求训练样本量大的问题，还给出土壤的丰缺度评价和污染指标评价。
权利要求书clms
1.一种基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，具体包括以下步骤：S1，数据预处理：将土壤传感器获取的土壤数据和设定年份内统计的地块产量数据进行整理和归档，并进行归一化处理和添加标签操作，得到样本数据；S2，土壤综合肥力评价：针对不同作物对不同化学元素敏感度的差异设置对应的权重，利用分肥力系数标准公式和改进的内梅罗指数法对土壤的肥力状况和重金属污染状况划分等级，数据传入计权型多因子评价模型得出综合肥力指数；S3，数据增强：通过计权型多因子评价改进经典遗传算法中的适应度函数，保留遗传算法中数据交配的思想，通过适应度函数选取合适的子代数据来进行数据增强，扩充数据样本；S4，基于神经网络的配方施肥：使用扩充的数据样本对神经网络模型进行训练，得出作物的产量预测与配肥补肥策略。2.根据权利要求1所述的基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，步骤S1具体包括以下步骤：S101，清除土壤数据和地块产量数据中的无关数据、故障数据；S102，对清除后的土壤数据和地块产量数据进行归一化处理；S103，将处理后的土壤数据和地块产量数据合并为一个文件，并进行随机打乱，得到样本数据。3.根据权利要求2所述的基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，步骤S102中归一化处理采用的公式如下：式中：Xij表示样本中第i个序列数据的第j个属性；N表示样本中序列数据的个数；n表示每条样本的属性维度。max{g}表示取最大值；min{g}表示取最小值。4.根据权利要求1所述的基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，步骤S2具体包括以下步骤：S201，根据自变量与肥力水平的正负相关性，计算各不同自变量的分肥力系数；S202，将分肥力系数带入改进的内梅罗公式，得出所需的综合肥力指数；S203，确定综合肥力指数的修正系数，计算对应的综合肥力指数的取值区间；S204，将综合肥力指数的取值区间划分级别，进行对应评级，并定级给出丰缺度等级评价。5.根据权利要求4所述的基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，步骤S203确定综合肥力指数的修正系数具体指的是通过设定不同修正系数进行对比试验，分析综合肥力指数的函数图像的平滑度和方差大小，得到最佳的修正系数。6.根据权利要求4所述的基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，步骤S3中通过计权型多因子评价改进经典遗传算法中的适应度函数具体指的是将丰缺度等级评价作为适应度函数，应用丰缺度等级评价分别对土壤数据和地块产量数据进行两次丰缺评价，若两组数据的丰缺评价等级一致，则适应度为1，否则为0。7.根据权利要求1所述的基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，步骤S4具体包括以下步骤：S401，将扩充的数据样本分为训练集、验证集和测试集，选定神经网络模型，设定神经网络模型的激活函数和损失函数；S402，设定输入层单元数、隐藏层神经元数、输出层单元数、迭代次数和学习率；S403，隐藏层通过插值公式将低维空间的非线性不可分数据映射到高维空间，并通过一个含有解的先验知识的约束来控制映射函数的光滑性；S404，选择中心选择算法并进行训练；S405，根据设定的迭代次数进行训练，最终得出作物的产量预测与配肥补肥策略。8.根据权利要求7所述的基于深度学习和计权型多因子评价的测土配方施肥方法，其特征在于，神经网络模型为RBF神经网络模型。
说明书desc
技术领域本发明涉及种植技术，特别是涉及一种基于深度学习和计权型多因子评价的测土配方施肥方法。背景技术测土配方施肥方法是以土壤测试以及肥料田间试验结果为基础，根据作物需肥规律、土壤供肥性能和肥料效应，合理提出肥料的施用量、施用时期和方法的技术，此技术可被分为测土施肥和配方施肥，测土施肥和配方施肥都要进行土壤养分测定，后者还需要根据大量的田间试验得出结论，但因目的一样，因此被统称为测土配方施肥技术。随着网络信息技术和数据采集技术的飞速发展，农业物联网的技术日趋成熟，规模日益增大，传统的农业种植也愈发依赖信息技术的参与和指导。传统的测土配方施肥是在农业专家指导下科学施用配方肥，其技术核心是调节和解决作物需肥与土壤供肥之间的矛盾，使得肥料的施放实现最大经济效益和最小环境污染。而针对一些类似于枳壳、石斛、双孢菌、白芷这类小微量不常见的农作物，现阶段该类作物种植存在农业物联网覆盖不全面、作物数据量级小、专家经验匮乏的问题，要实现测土配方施肥有必要要结合人工智能的方法，对要分析的作物建立物联网，生成专属数据库。再结合数据增强的方法和深度学习的神经网络模型进行相应的分析学习，给出测土配方的配肥建议和对应的产量预测。当前进行测土配方施肥的方法可以归为以下几类：基于最小养分律和报酬递减律的拟合方程法。这类方法，是充分应用作物的生长规律映射出的函数关系，即作物产量与配肥关系符合二次项系数为负时二次函数的数值变化趋势，所以该方法利用最小二乘法确定方程系数，最后得出拟合方程。局限性在于某些作物的生长规律和拟合出的方程不符，又或者原始拟合数据点的数据采样误差太大，上述情况均会极大影响拟合方程的精度。基于专家经验与数学模型相融合的方法。专家经验通常表现为：依据土壤样本的不同属性和不同作物对元素敏感度的差异来构建以元素阈值作为分支的决策树，每一叶节点对应一个配肥建议和预测产量的概率值。此类方法适合作物常见、专家经验丰富、数据样本呈低维性的情况，若样本维数过高或分类较多时，专家经验概率组合会十分复杂。此外，专家经验主观性较强，其正确与否将直接影响判别结果。基于传感器和肥料效应方程的方法。这类方法，是充分利用了物联网技术和农业科学技术。通过传感器采集的土壤理化数据，结合农业科学研究总结的肥料效应方程进行计算，以此来有针对性地补充作物所需的营养元素，实现各种养分平衡供应。此方法的局限性在于对某些小微量作物，其对土壤各元素的敏感度截然不同，又或者种植地区的经纬度、湿度、气候类型都可能极大影响作物的配肥方式和产量，故常用肥料效应方程不适用于不常见作物。基于神经网络的测土配方施肥方法。这类方法利用前馈神经网络、卷积神经网络、自组织竞争网络等基本的深度学习模型对作物进行产量预测和配肥建议。神经网络由于有很强的泛化能力和一定的容错能力，因此神经网络在应用时，其对数据质量和规格要求相对较低，适用范围更广。此外还有些方法是利用卷积神经网络或循环神经网络提取样本数据特征，来进行预测和配肥推荐。这类方法对原始数据量的要求较大，在大量训练样本下训练形成的模型能够准确预测产量和给出精确配肥建议。综上所述，现有的测土配方施肥方法若基于农学公式和数学方法，对于某些非常见的作物对象或采样点偏差较大的作物数据会出现较大的分析误差；若基于专家经验和概率论，对于一些复杂条件下生长的作物会出现概率论中高维度过度复杂的情形，极大影响算法分析和预测的精度；若基于单一神经网络，则要求原始样本数量大，这显然不符合某些非常见作物的数据特征。发明内容针对现有技术中存在的缺陷，本发明的目的在于提供一种基于深度学习和计权型多因子评价的测土配方施肥方法，该方法在保留神经网络强泛化能力和强分析能力的同时，使用计权型多因子评价改进经典遗传算法中的适应度函数来进行数据增强，在解决了神经网络要求训练样本量大这一问题的同时，还通过计权型多因子评价给出了土壤的丰缺度评价和污染指标评价。为了达到上述目的，本发明所采用的具体技术方案如下：一种基于深度学习和计权型多因子评价的测土配方施肥方法，具体包括以下步骤：S1，数据预处理：将土壤传感器获取的土壤数据和设定年份内统计的地块产量数据进行整理和归档，并进行归一化处理和添加标签操作，得到样本数据；S2，土壤综合肥力评价：针对不同作物对不同化学元素敏感度的差异设置对应的权重，利用分肥力系数标准公式和改进的内梅罗指数法对土壤的肥力状况和重金属污染状况划分等级，数据传入计权型多因子评价模型得出综合肥力指数；S3，数据增强：通过计权型多因子评价改进经典遗传算法中的适应度函数，保留遗传算法中数据交配的思想，通过适应度函数选取合适的子代数据来进行数据增强，扩充数据样本；S4，基于神经网络的配方施肥：使用扩充的数据样本对神经网络模型进行训练，得出作物的产量预测与配肥补肥策略。优选的，步骤S1具体包括以下步骤：S101，清除土壤数据和地块产量数据中的无关数据、故障数据；S102，对清除后的土壤数据和地块产量数据进行归一化处理；S103，将处理后的土壤数据和地块产量数据合并为一个文件，并进行随机打乱，得到样本数据。优选的，步骤S102中归一化处理采用的公式如下：式中：Xij表示样本中第i个序列数据的第j个属性；N表示样本中序列数据的个数；n表示每条样本的属性维度。max{g}表示取最大值；min{g}表示取最小值。优选的，步骤S2具体包括以下步骤：S201，根据自变量与肥力水平的正负相关性，计算各不同自变量的分肥力系数；S202，将分肥力系数带入改进的内梅罗公式，得出所需的综合肥力指数；S203，确定综合肥力指数的修正系数，计算对应的综合肥力指数的取值区间；S204，将综合肥力指数的取值区间划分级别，进行对应评级，并定级给出丰缺度等级评价。优选的，步骤S203确定综合肥力指数的修正系数具体指的是通过设定不同修正系数进行对比试验，分析综合肥力指数的函数图像的平滑度和方差大小，得到最佳的修正系数。优选的，步骤S3中通过计权型多因子评价改进经典遗传算法中的适应度函数具体指的是将丰缺度等级评价作为适应度函数，应用丰缺度等级评价分别对土壤数据和地块产量数据进行两次丰缺评价，若两组数据的丰缺评价等级一致，则适应度为1，否则为0。优选的，步骤S4具体包括以下步骤：S401，将扩充的数据样本分为训练集、验证集和测试集，选定神经网络模型，设定神经网络模型的激活函数和损失函数；S402，设定输入层单元数、隐藏层神经元数、输出层单元数、迭代次数和学习率；S403，隐藏层通过插值公式将低维空间的非线性不可分数据映射到高维空间，并通过一个含有解的先验知识的约束来控制映射函数的光滑性；S404，选择中心选择算法并进行训练；S405，根据设定的迭代次数进行训练，最终得出作物的产量预测与配肥补肥策略。优选的，神经网络模型为RBF神经网络模型。本发明的有益效果在于：在保留神经网络强泛化能力和强分析能力的同时，使用计权型多因子评价改进经典遗传算法中的适应度函数来进行数据增强，在解决了神经网络要求训练样本量大这一问题的同时，还通过计权型多因子评价给出了土壤的丰缺度评价和污染指标评价。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是基于深度学习和计权型多因子评价的测土配方施肥方法的原理框图；图2是基于深度学习和计权型多因子评价的测土配方施肥方法的流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的其他实施例，都属于本发明保护的范围。在本发明的描述中，需要说明的是，术语“竖直”、“上”、“下”、“水平”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。在本发明的描述中，还需要说明的是，除非另有明确的规定和限定，术语“设置”、“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。如图1和图2所示，本发明提出了一种基于深度学习和计权型多因子评价的测土配方施肥方法，包括四个阶段：数据预处理；土壤综合肥力评价；数据增强；基于神经网络的配方施肥。首先，在数据预处理阶段，对作物土壤样本进行归一化处理、添加标签等操作；其次，在土壤综合肥力评价阶段，利用分肥力系数标准公式和改进的内梅罗指数法对土壤的肥力状况和重金属污染状况划分等级，一方面给出测土评价，一方面为数据增强模块的改进遗传算法提供对应的适应度函数。再次，改进经典遗传算法，保留遗传算法中数据“交配”的思想，通过适应度函数选取合适的子代数据来进行数据增强，扩充数据样本。最后，使用扩充好的训练样本对RBF神经网络模型进行充分训练，得出预测产量结果与推荐补肥策略。具体包括以下步骤：S1，数据预处理：将土壤传感器获取的土壤数据和设定年份内统计的地块产量数据进行整理和归档，并进行归一化处理和添加标签操作，得到样本数据；在数据预处理阶段，将枳壳土壤化学元素数据、枳壳产量数据、枳壳水肥数据处理为统一且符合实验要求的数据。S101，清除原始样本数据中的传感器序列号、数据库表头列名等无关数据，舍去样本数据首部和尾部第一列参数值为0的样本值，并且过滤掉所有由于设备问题出现的故障数据，例如一些int类型数据的极值和负值。S102，初始样本数据的数值可能数量级过高、过低或不同属性间的单位量纲不统一。对样本按属性进行归一化处理，可消除指标之间量纲的影响，增强不同属性指标间的可比性，有助于模型更好的学习和判别数据。采用归一化公式如下：式中：Xij表示样本中第i个序列数据的第j个属性；N表示样本中序列数据的个数；n表示每条样本的属性维度。max{g}表示取最大值；min{g}表示取最小值。S103，对处理后的土壤和作物数据进行合并，合为一个文件后将样本序列进行随机打乱。打乱样本可以增加训练和测试样本的随机性，训练出更好的模型。S2，土壤综合肥力评价：针对不同作物对不同化学元素敏感度的差异设置对应的权重，利用分肥力系数标准公式和改进的内梅罗指数法对土壤的肥力状况和重金属污染状况划分等级，数据传入计权型多因子评价模型得出综合肥力指数；在测土评价阶段，数据传入计权型多因子评价模型中，根据枳壳对不同元素敏感度不同设置不同权重进行土壤肥力评价和重金属污染评价。S201根据自变量与肥力水平的正负相关性，使用公式或计算土壤各元素、PH值、湿度等不同自变量的分肥力系数。为非降序，公式为非升序)S202通过对原内梅罗公式)的改进，使用第二步1)中的分肥力系数带入改进后的公式中可得出需要的综合肥力指数P：其中：S203确定λ的具体值：λ的作用是用来修正测量数据中极值存在的误差对整个评价的影响，而修正幅度可用所有地块综合肥力指数P修正的差值的绝对值平均值来衡量，修正趋势则用P差值的方差大小来衡量。通过设定不同λ进行对比实验，分析函数图像的平滑度和方差大小，即可得出最适合的λ。S204将得出的综合肥力指数涵盖的区间按照第三步中的粒度m划分为m级别，进行对应评级，并定级给出丰缺度等级评价，为第三步的适应度函数做准备。S3，数据增强：通过计权型多因子评价改进经典遗传算法中的适应度函数，保留遗传算法中数据交配的思想，通过适应度函数选取合适的子代数据来进行数据增强，扩充数据样本；在数据增强阶段，通过计权型多因子评价改进经典遗传算法中的适应度函数，使得遗传算法着重点由最优解变为数据的“交配繁衍”，从而达成数据增强，扩充样本量。S301编码：由于遗传算法在运算过程中会使用基因这个概念，需要将输入的初始种群数据编码成基因的形式，本算法采用二进制编码。根据氮、磷、钾数据取值区间大小200左右，精度为1的情形下，则设置氮、磷、钾数据各8位,产量数据取值区间大小2500，精度取10，则设置产量数据8位，故该四维数据编码长度32位。分别为：1-8位为产量，9-16 位为钾，17-24位为磷，25-32位为氮。S302交叉：种群中选择两条数据样本作为初代父类样本模拟交配过程。交配产生后代中只保留双亲的基因种群中未选择、未配对过的数据。在初始父类这里把上述32位二进制数看成一组基因片段。在交叉时需氮、磷、钾、产量对应的8位基因片段完整的进行交叉移动。对于每个要交配个体随机产生一个随机数并对要交叉的个体进行两两配对。设置一个长度为基因片段数的二进制数，对应位置代表要交换的基因片段位置。若对应位置为0，则该段片段不发生交换，反之则交换。允许出现全0和全1的情况出现，此时两个个体未交换基因。若两个体的要交换的基因片段一致，则只有一段基因片段被交换。S303变异：对于每个交叉后的个体的每一个基因点位上都有基因变异的可能性，需要设置合适的变异概率对个体基因进行变异操作。本文算法中设置的变异概率为0.35。一般来说，变异算子操作的基本步骤如下：①对群中所有个体以事先设定的变异概率判断是否进行变异；②对进行变异的个体随机选择变异位置进行变异。S304适应度函数：适应度函数的作用是对种群中的个体进行评价，个体评价越高，越不容易被淘汰。本文采用3.2.2中的土壤丰缺度等级评级作为适应度函数，应用丰缺度评价分别对输入的土壤元素数据和产量数据进行两次丰缺评价，若两组数据的丰缺评价等级一致，则适应度为1，否则为0。而其中丰缺指标的划分可根据具体情况划分不同粒度，具体步骤如下：土壤元素数据的丰缺评价使用3.2.2节中得出的丰缺度等级，取粒度m将值所覆盖区间等分为 m级，从上至下依次评级；产量数据的丰缺评价较为简单，将产量数据取值区间取m粒度等分为m级别从上至下依次评级。本算法中m取值10，即共有10级划分。S305选择：将4)中两次丰缺评价进行比较，即比较土壤综合肥力所在等级和产量数据所在等级，若相等则数据匹配度为1，保留数据加入父类样本；若不相等则为0，舍弃数据；S306迭代：通过1)-5)的迭代，直至满足种群数量要求，或父类样本中全部配对完成，结束循环。S4，基于神经网络的配方施肥：使用扩充的数据样本对神经网络模型进行训练，得出作物的产量预测与配肥补肥策略。在配方施肥阶段，将S3得出的训练集D、验证集V和测试集T传入RBF神经网络中进行训练得出最终枳壳产量预测结果和配肥补肥施放策略。S401设定RBF模型中的激活函数和损失函数。RBFNN隐藏层的激活函数为RBF，即径向基函数，常见的径向基函数有：高斯函数、多二次函数、逆二次函数、逆多二次函数、多重调和样条函数等，在本专利中的RBFNN的激活函数设置为高斯函数)，损失函数使用均方误差损失函数)其中yk是神经网络的输出，tk是训练数据所带标签值，k表示数据的维度，在该模型中数据维度为4，即氮、磷、钾、产量。S402输入层单元数为4，隐藏层神经元数量为50，输出层单元数也为4，迭代次数设置为2000次，学习率0.0001。由于输入层维度低于隐藏层维度，故各径向基函数的方差由算法确定，设置为公式：其中dmax是中心点之间的最大距离，M是中心点个数。S403隐藏层通过公式所述的插值公式，将低维空间的非线性不可分数据映射到高维空间，从而达到线性可分的目的，并且由于易受噪声影响，且可能是超定问题，需要加入公式，一个含有解的先验知识的约束来控制映射函数的光滑性。)其中λ为正则化参数，D为线性微分算子，代表对F的先验知识。S404选择最小二乘法作为RBFNN的中心选择算法，进行训练。S405根据设定的迭代次数进行训练，最终得出预测产量结果和配肥补肥策略。本发明的有益效果在于：1、与基于最小养分律和报酬递减律的拟合方程法相比，本技术方案当中使用的径向基函数神经网络具有更好的非线性函数拟合性能，具有更优的全局逼近性能，这弥补了最小养分律和报酬递减律的拟合方程法中拟合出的方程精度差的缺陷；2、与基于专家经验与数学模型相融合的方法相比，本技术方案是针对小样本、小微量农作物设计的测土配方施肥方法，故一明显的技术难点就是针对该类农作物专家经验匮乏，常见数学模型泛化能力地下不能够适用与此类作物。另外本技术发明的测土配方施肥中的产量预测与配肥施肥策略交给了泛化能力优秀的神经网络实现，不需要使用复杂的概率组合判别，降低了误差风险；3、与基于传感器和肥料效应方程的方法相比，本技术方案结合了传感器采集的数据与神经网络拟合出的肥料效应方程，在使用传感器数据的同时，又使用数据增强模型将采集的小样本数据量进行扩充，最后再使用径向基神经网络拟合出对应的肥料相应方程。这弥补了传统的基于传感器和肥料效应方程方法使用一成不变的一元二次或三元二次方程进行肥料效应方程拟合的缺陷，也弥补了传感器采集数据量不足的缺陷；4、与基于神经网络的测土配方施肥方法相比，本技术方案能够使用于样本量更小的情形，而基于神经网络的测土配方施肥方法对数据量要求较大，否则训练出神经网络泛化能力差不能够使用。综上，本技术方案融合了方案，在使用传感器采集作物数据的同时，又使用数据增强模型扩充样本，最后再使用神经网络模型来拟合肥料效应方程，给出最终的测土配方施肥方法。以上述依据本发明的理想实施例为启示，通过上述的说明内容，本领域技术人员完全可以在不偏离本发明技术思想的范围内，进行多样的变更以及修改。本发明的技术性范围并不局限于说明书上的内容，必须要根据权利要求书范围来确定其技术性范围。
