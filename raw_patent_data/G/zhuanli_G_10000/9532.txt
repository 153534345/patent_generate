标题title
数据库扩容的方法和装置
摘要abst
本发明公开了数据库扩容的方法和装置，涉及计算机技术领域。该方法的一具体实施方式包括：接收数据库扩容请求，根据数据库扩容请求和至少一个现有数据库，确定扩容倍数；根据扩容倍数，获取至少一个现有数据库对应的新扩容数据库，建立至少一个现有数据库和对应的新扩容数据库的第一主从关系；基于第一主从关系进行数据拷贝，在数据拷贝成功后，根据至少一个现有数据库和对应的新扩容数据库，生成扩容后数据库。该实施方式不需要长时间停止应用，实现了利用扩容倍数进行数据库动态扩容，降低对业务的影响，提高用户体验。
权利要求书clms
1.一种数据库扩容的方法，其特征在于，包括：接收数据库扩容请求，根据所述数据库扩容请求和至少一个现有数据库，确定扩容倍数；根据所述扩容倍数，获取所述至少一个现有数据库对应的新扩容数据库，建立所述至少一个现有数据库和所述对应的新扩容数据库的第一主从关系；基于所述第一主从关系进行数据拷贝，在数据拷贝成功后，根据所述至少一个现有数据库和所述对应的新扩容数据库，生成扩容后数据库。2.根据权利要求1所述的方法，其特征在于，所述根据所述数据库扩容请求和至少一个现有数据库，确定扩容倍数，包括：根据所述数据库扩容请求，获取扩容个数；计算所述扩容个数与所述至少一个现有数据库的个数的比值，判断所述比值是否为整数；若是，则直接确定所述比值为扩容倍数；若否，则对所述比值进行向上取整处理，获得所述扩容倍数。3.根据权利要求1所述的方法，其特征在于，所述至少一个现有数据库包括：至少一个现有主数据库；以及，所述根据所述扩容倍数，获取所述至少一个现有数据库对应的新扩容数据库，建立所述至少一个现有数据库和所述对应的新扩容数据库的第一主从关系，包括：根据所述扩容倍数，获取所述至少一个现有主数据库对应的新扩容主数据库和对应的新扩容从数据库；将所述对应的新扩容主数据库和所述对应的待扩容从数据库设置为所述至少一个现有主数据库对应的从数据库，以建立所述第一主从关系。4.根据权利要求3所述的方法，其特征在于，所述基于所述第一主从关系进行数据拷贝，在数据拷贝成功后，根据所述至少一个现有数据库和所述对应的新扩容数据库，生成扩容后数据库，包括：根据所述第一主从关系，基于数据主从同步原理，将所述至少一个现有主数据库中的数据拷贝至所述对应的新扩容主数据库和所述对应的新扩容从数据库中；在数据拷贝成功后，解除所述第一主从关系；将所述对应的新扩容从数据库设置为所述对应的新扩容主数据库对应的从库，以建立第二主从关系；将所述至少一个现有数据库、所述对应的新扩容主数据库和所述对应的新扩容从数据库进行组合，生成所述扩容后数据库。5.根据权利要求1所述的方法，其特征在于，所述方法还包括：在数据拷贝成功后，停止数据库读写操作；在生成所述扩容后数据库后，设置所述扩容后数据库对应的第一读写规则，按照所述第一读写规则，对所述扩容后数据库进行读写操作。6.根据权利要求5所述的方法，其特征在于，所述设置所述扩容后数据库对应的第一读写规则，包括：直接根据所述扩容后数据库的个数，设置所述第一读写规则；以及根据所述现有数据库对应的第二读写规则和所述扩容倍数，设置所述第一读写规则。7.根据权利要求5所述的方法，其特征在于，在生成扩容后数据库之后，所述方法还包括：根据所述第一读写规则，设置冗余数据清除规则；按照所述冗余数据清除规则，对所述扩容后数据库进行冗余数据清除处理。8.一种数据库扩容的装置，其特征在于，包括：确定模块，用于接收数据库扩容请求，根据所述数据库扩容请求和至少一个现有数据库，确定扩容倍数；建立模块，用于根据所述扩容倍数，获取所述至少一个现有数据库对应的新扩容数据库，建立所述至少一个现有数据库和所述对应的新扩容数据库的第一主从关系；生成模块，用于基于所述第一主从关系进行数据拷贝，在数据拷贝成功后，根据所述至少一个现有数据库和所述对应的新扩容数据库，生成扩容后数据库。9.一种电子设备，其特征在于，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如权利要求1-7中任一所述的方法。10.一种计算机可读介质，其上存储有计算机程序，其特征在于，所述程序被处理器执行时实现如权利要求1-7中任一所述的方法。
说明书desc
技术领域本发明涉及计算机技术领域，尤其涉及一种数据库扩容的方法和装置。背景技术随着数据量的不断增长，当现有数据库不能承载业务需求时，则需要进行扩容操作。现有技术，按照当前业务数据量要求，评估需要扩容的数据库数量以后，修改代码中的求余规则，在扩展数据库时，需要长时间停止应用，扫描现有数据库所有数据，按照新的求余规则将现有的数据库的部分数据迁移至新扩展的数据库中，清除现有数据库中冗余的数据。在实现本发明过程中，发明人发现现有技术中至少存在如下问题：一、目前数据库扩容的方法中，数据迁移的过程需要扫描所有数据，按照新的求余规则进行数据迁移和冗余数据清除，耗时费力；二、面对海量数据，执行扩容操作时，应用需要停的时间很长，影响业务开展。发明内容有鉴于此，本发明实施例提供一种数据库扩容的方法和装置，不需要长时间停止应用，实现了利用扩容倍数进行数据库动态扩容，降低对业务的影响，提高用户体验。为实现上述目的，根据本发明实施例的第一方面，提供了一种数据库扩容的方法。本发明实施例的一种数据库扩容的方法，包括：接收数据库扩容请求，根据所述数据库扩容请求和至少一个现有数据库，确定扩容倍数；根据所述扩容倍数，获取所述至少一个现有数据库对应的新扩容数据库，建立所述至少一个现有数据库和所述对应的新扩容数据库的第一主从关系；基于所述第一主从关系进行数据拷贝，在数据拷贝成功后，根据所述至少一个现有数据库和所述对应的新扩容数据库，生成扩容后数据库。可选地，所述根据所述数据库扩容请求和至少一个现有数据库，确定扩容倍数，包括：根据所述数据库扩容请求，获取扩容个数；计算所述扩容个数与所述至少一个现有数据库的个数的比值，判断所述比值是否为整数；若是，则直接确定所述比值为扩容倍数；若否，则对所述比值进行向上取整处理，获得所述扩容倍数。可选地，所述至少一个现有数据库包括：至少一个现有主数据库；以及，所述根据所述扩容倍数，获取所述至少一个现有数据库对应的新扩容数据库，建立所述至少一个现有数据库和所述对应的新扩容数据库的第一主从关系，包括：根据所述扩容倍数，获取所述至少一个现有主数据库对应的新扩容主数据库和对应的新扩容从数据库；将所述对应的新扩容主数据库和所述对应的待扩容从数据库设置为所述至少一个现有主数据库对应的从数据库，以建立所述第一主从关系。可选地，所述基于所述第一主从关系进行数据拷贝，在数据拷贝成功后，根据所述至少一个现有数据库和所述对应的新扩容数据库，生成扩容后数据库，包括：根据所述第一主从关系，基于数据主从同步原理，将所述至少一个现有主数据库中的数据拷贝至所述对应的新扩容主数据库和所述对应的新扩容从数据库中；在数据拷贝成功后，解除所述第一主从关系；将所述对应的新扩容从数据库设置为所述对应的新扩容主数据库对应的从库，以建立第二主从关系；将所述至少一个现有数据库、所述对应的新扩容主数据库和所述对应的新扩容从数据库进行组合，生成所述扩容后数据库。可选地，所述方法还包括：在数据拷贝成功后，停止数据库读写操作；在生成所述扩容后数据库后，设置所述扩容后数据库对应的第一读写规则，按照所述第一读写规则，对数据库进行读写操作。可选地，所述设置所述扩容后数据库对应的第一读写规则，包括：直接根据所述扩容后数据库的个数，设置所述第一读写规则；以及根据所述现有数据库对应的第二读写规则和所述扩容倍数，设置所述第一读写规则。可选地，在生成扩容后数据库之后，所述方法还包括：根据所述第一读写规则，设置冗余数据清除规则；按照所述冗余数据清除规则，对所述扩容后数据库进行冗余数据清除处理。为实现上述目的，根据本发明实施例的第二方面，提供了一种数据库扩容的装置。本发明实施例的一种数据库扩容的装置，包括：确定模块，用于接收数据库扩容请求，根据所述数据库扩容请求和至少一个现有数据库，确定扩容倍数；建立模块，用于根据所述扩容倍数，获取所述至少一个现有数据库对应的新扩容数据库，建立所述至少一个现有数据库和所述对应的新扩容数据库的第一主从关系；生成模块，用于基于所述第一主从关系进行数据拷贝，在数据拷贝成功后，根据所述至少一个现有数据库和所述对应的新扩容数据库，生成扩容后数据库。可选地，所述确定模块还用于：根据所述数据库扩容请求，获取扩容个数；计算所述扩容个数与所述至少一个现有数据库的个数的比值，判断所述比值是否为整数；若是，则直接确定所述比值为扩容倍数；若否，则对所述比值进行向上取整处理，获得所述扩容倍数。可选地，所述至少一个现有数据库包括：至少一个现有主数据库；以及，所述建立模块还用于：根据所述扩容倍数，获取所述至少一个现有主数据库对应的新扩容主数据库和对应的新扩容从数据库；将所述对应的新扩容主数据库和所述对应的待扩容从数据库设置为所述至少一个现有主数据库对应的从数据库，以建立所述第一主从关系。可选地，所述生成模块还用于：根据所述第一主从关系，基于数据主从同步原理，将所述至少一个现有主数据库中的数据拷贝至所述对应的新扩容主数据库和所述对应的新扩容从数据库中；在数据拷贝成功后，解除所述第一主从关系；将所述对应的新扩容从数据库设置为所述对应的新扩容主数据库对应的从库，以建立第二主从关系；将所述至少一个现有数据库、所述对应的新扩容主数据库和所述对应的新扩容从数据库进行组合，生成所述扩容后数据库。可选地，所述生成模块还用于：在数据拷贝成功后，停止数据库读写操作；在生成所述扩容后数据库后，设置所述扩容后数据库对应的第一读写规则，按照所述第一读写规则，对所述扩容后数据库进行读写操作。可选地，所述生成模块还用于：直接根据所述扩容后数据库的个数，设置所述第一读写规则；以及，根据所述现有数据库对应的第二读写规则和所述扩容倍数，设置所述第一读写规则。可选地，所述生成模块还用于：根据所述第一读写规则，设置冗余数据清除规则；按照所述冗余数据清除规则，对所述扩容后数据库进行冗余数据清除处理。为实现上述目的，根据本发明实施例的第三方面，提供了一种电子设备。本发明实施例的一种电子设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当一个或多个程序被一个或多个处理器执行，使得一个或多个处理器实现本发明实施例的数据库扩容的方法。为实现上述目的，根据本发明实施例的第四方面，提供了一种计算机可读介质。本发明实施例的一种计算机可读介质，其上存储有计算机程序，程序被处理器执行时实现本发明实施例的数据库扩容的方法。上述发明中的一个实施例具有如下优点或有益效果：能够利用数据库扩容请求和至少一个现有数据库，确定扩容倍数，进而获取每个现有数据库对应的新扩容数据库，然后利用主从关系进行数据拷贝，最后得到扩容后数据库，解决了现有技术中数据迁移过程中需要扫描所有数据而导致的耗时费力的技术问题，并且不需要长时间停止应用，实现了利用扩容倍数进行数据库动态扩容，降低对业务的影响，提高用户体验。上述的非惯用的可选方式所具有的进一步效果将在下文中结合具体实施方式加以说明。附图说明附图用于更好地理解本发明，不构成对本发明的不当限定。其中：图1是根据本发明实施例的数据库扩容的方法的主要步骤的示意图；图2是根据本发明实施例的现有数据库的示意图；图3是根据本发明实施例的进行数据库扩容的示意图；图4是根据本发明实施例的扩容后数据库的示意图；图5是根据本发明实施例的数据库扩容的方法的主要流程的示意图；图6是根据本发明实施例的数据库扩容的装置的主要模块的示意图；图7是本发明实施例可以应用于其中的示例性系统架构图；图8是适于用来实现本发明实施例的终端设备或服务器的计算机系统的结构示意图。具体实施方式以下结合附图对本发明的示范性实施例做出说明，其中包括本发明实施例的各种细节以助于理解，应当将它们认为仅仅是示范性的。因此，本领域普通技术人员应当认识到，可以对这里描述的实施例做出各种改变和修改，而不会背离本发明的范围和精神。同样，为了清楚和简明，以下的描述中省略了对公知功能和结构的描述。现有技术，按照当前业务数据量要求，评估需要扩容的数据库数量，修改代码中的求余规则。假如原来是2个数据库，则对2求余，当前需要扩展为4个数据库时，需要将求余规则修改为对4求余。在数据库扩容时，需要长时间停止应用，扫描现有数据库中所有数据，按照新的求余规则将现有的数据库的部分数据迁移至新扩容的数据库中，清除现有数据库中冗余的数据。可以发现，现有数据库扩容的方法中，数据迁移过程需要扫描所有数据，耗时费力；并且如果数据量很庞大，需要停止应用时间会很长，影响业务开展。为了解决上述问题，本发明实施例提供一种数据库扩容的方法，能够利用扩容倍数，获取每个现有数据库对应的新扩容数据库，然后利用主从关系进行数据拷贝，最后得到新扩容数据库，解决了现有技术中数据迁移过程中需要扫描所有数据而导致的耗时费力的技术问题，并且不需要长时间停止应用，降低对业务的影响。图1是根据本发明实施例的数据库扩容的方法的主要步骤的示意图。如图1所示，本发明实施例的数据库扩容的方法的主要步骤可以包括：步骤S101，接收数据库扩容请求，根据数据库扩容请求和现有数据库，确定扩容倍数；步骤S102，根据扩容倍数，获取至少一个现有数据库对应的新扩容数据库，建立至少一个现有数据库和对应的新扩容数据库的第一主从关系；步骤S103，基于第一主从关系进行数据拷贝，在数据拷贝成功后，根据至少一个现有数据库和对应的新扩容数据库，生成扩容后数据库。本发明实施例的数据库扩容的方法中，在接收到数据库扩容请求后，可以根据数据库扩容请求和现有数据库，确定出扩容倍数。其中，扩容倍数是指需要扩容的数据库的个数与现有数据库个数的倍数，比如，现有数据库为5个，需要扩容的数据库为10个，那么扩容倍数为2。本发明技术方案结合扩容倍数进行数据库扩容，结合了哈希倍数求余算法原理。具体实现为，在分库技术中，可以对数据的一个特定字段求哈希值，然后用哈希值和数据库的数量进行求余，以此得到需要落入的数据库编号。比如，订单表中有订单号字段，现在订单表需要分10个数据库进行存储，那么就可以求取订单号字段的哈希值，然后用求取的哈希值对10求余，如果某订单号得到的哈希值为1，则对10求余为1，那么将该订单号的订单信息存储至编号为1的数据库中。考虑到哈希倍数求余符合一致性原理，比如，有数据，按照2求余时，得到余数为0的A1组和余数为1的A2组，按照4求余时，得到余数为0的B1组、余数为1的B2组、余数为2的B3组、余数为3的B3组。从求余结果发现，B1组和B3组的数据之和为A1组数据，B2组和B4组的数据之和为A2组数据。因此，本发明实施例可以运用哈希倍数求余一致性原理进行动态扩容，即对现有数据库按照扩容倍数进行扩容，所以本发明实施例中首先根据数据库扩容请求和现有数据库个数，确定扩容倍数，接下来可以利用扩容倍数进行数据库扩容。在确定扩容倍数后，针对每个现有数据库，可以获取每个现有数据库对应的新扩容数据库个数。比如，扩容倍数为2，现有数据库有D1至D5共5个，因此数据库D1至D5中，每个数据库对应的新扩容数据库为2个。接着，可以建立新扩容数据库与现有数据库之间的第一主从关系。比如，现有数据库D1对应的新扩容数据库为X1和X2，则建立D1与X1和X2之间的主从关系。从上述分析得知，若现有数据库为D1和D2，扩容倍数为2，那么现在扩容成4个库D1、D2、D3、D4，则依据哈希倍数求余一致性原理，存储至D1和D3的数据一定在原数据库D1中，存储至D2和D4的数据一定在原数据库D2中，因此需要将原数据库D1中的数据拷贝一份至数据库D3，需要将原数据库D2中的数据拷贝一份至数据库D4中。所以，在获取到每个现有数据库对应的新扩容数据库后，通过每个现有数据库与对应的新扩容数据库的主从关系，进行数据拷贝。在数据拷贝成功后，组合现有数据库和新扩容数据库，得到扩容后数据库。本发明实施例的数据库扩容的方法，能够利用数据库扩容请求和至少一个现有数据库，确定扩容倍数，进而获取每个现有数据库对应的新扩容数据库，然后利用主从关系进行数据拷贝，最后得到扩容后数据库，解决了现有技术中数据迁移过程中需要扫描所有数据而导致的耗时费力的技术问题，并且不需要长时间停止应用，实现了利用扩容倍数进行数据库动态扩容，降低对业务的影响，提高用户体验。扩容倍数的确定是本发明实施例的数据库扩容方法的重要部分。作为本发明的一个可参考实施例，根据数据库扩容请求和现有数据库，确定扩容倍数，可以包括：步骤S1011，根据数据库扩容请求，获取扩容个数；步骤S1012，计算扩容个数与至少一个现有数据库的个数的比值，判断比值是否为整数，若是，则执行步骤S1013，若否，则执行步骤S1014；步骤S1013，直接确定比值为扩容倍数；步骤S1014，对比值进行向上取整处理，获得扩容倍数。其中，扩容个数是指需要扩容的数据库个数，即需要增加的数据库个数。本发明实施例的数据库扩容请求中可以包括需要扩容的数据库个数；也可以包括根据业务需求评估的数据库个数，这样可以根据评估的数据库个数减去现有数据库个数，获得需要扩容的数据库个数，在获得扩容个数之后，计算扩容个数与现有数据库个数的比值。如果比值为整数，则可以直接确定该比值为扩容倍数，比如扩容个数为4，现有数据库的个数为2，则扩容倍数为2。如果比值不是整数，则需要对比值进行向上取整处理，比如扩容个数为5，现有数据库的个数为3，则比值为5/3，对5/3向上取整，得到扩容倍数为2。本发明实施例进行数据库扩容操作时，可以增加主数据库和从数据库，这样当出现数据库硬件损毁、网络连接问题等问题导致主库宕机时，可以立刻挂接到从库上，继续执行数据库读写操作。因此，本发明实施例中，现有数据库可以包括至少一个现有主数据库。以及，步骤S102根据扩容倍数，获取至少一个现有数据库对应的新扩容数据库，建立至少一个现有数据库和对应的新扩容数据库的第一主从关系，可以包括：步骤S1021，根据扩容倍数，获取至少一个现有主数据库对应的新扩容主数据库和对应的新扩容从数据库；步骤S1022，将对应的新扩容主数据库和对应的待扩容从数据库设置为至少一个现有主数据库对应的从数据库，以建立第一主从关系。在获取到扩容倍数后，对于一个现有主数据库，可以确定该现有主数据库对应的需要增加的主数据库和从数据库。比如，现有主数据库D1，扩容倍数为2，得到需要扩容的主数据个数为2，需要扩容的从数据库个数为2，那么可以确定，对于现有主数据库D1，扩容的主数据库为X1和X2，扩容的从数据库为X11和X22。然后，将增加的主数据库和增加的从数据库设置为该现有主数据库的从库，以建立第一主从关系。比如，将扩容的主数据库X1、X2和扩容的从数据库X11、X22均设置为现有主数据库D1的从库，这样就建立了第一主从关系。在建立第一主从关系后，可以利用建立的第一主从关系进行数据拷贝。所以，作为本发明的又一个可参考实施例，步骤S103的基于第一主从关系进行数据拷贝，在数据拷贝成功后，根据至少一个现有数据库和对应的新扩容数据库，生成扩容后数据库，可以包括：步骤S1031，根据第一主从关系，基于数据主从同步原理，将至少一个现有主数据库中的数据拷贝至对应的新扩容主数据库和对应的新扩容从数据库中；步骤S1032，在数据拷贝成功后，解除第一主从关系；将对应的新扩容从数据库设置为对应的新扩容主数据库对应的从库，以建立第二主从关系；步骤S1033，将至少一个现有数据库、对应的新扩容主数据库和对应的新扩容从数据库进行组合，生成扩容后数据库。在建立了第一主从关系之后，可以基于数据主从同步原理，将现有主数据库中的数据拷贝至对应的新扩容主数据库和对应的新扩容从数据库中。比如，现有主数据库D1与扩容的主数据库为X1、X2和扩容的从数据库为X11、X22建立了第一主从关系，则可以将现有主数据库D1中的数据拷贝至数据库X1、X2、X11和X22中。需要注意的是，在数据拷贝成功后，需要解除建立的第一主从关系，这样可以使得新扩容的数据库与现有主数据库解除关系，为业务提供数据读写服务。此外，还需要建立新扩容主数据库与新扩容从数据库之间的第二主从关系，这样在新扩容主数据库出现宕机时，可以挂载新扩容从数据库，能够继续提供读写服务。比如，将扩容的从数据库X11设置为扩容的主数据库X1的从库，将扩容的从数据库X22设置为扩容的主数据库X2的从库，以建立第二主从关系。最后，就可以利用至少一个现有数据库、对应的新扩容主数据库和对应的新扩容从数据库进行组合，生成扩容后数据库。需要注意的是，扩容后数据库中包括的是现有数据库，也就是说可以包括现有主数据库和现有主数据库对应的现有从数据库。考虑到本发明实施例中，利用现有主数据库进行数据拷贝的，因此在上文中没有涉及到现有从数据库，但是为了避免现有主数据库出现宕机导致不能进行读写操作的问题，现有数据库中可以包括现有主数据库对应的现有从数据库。在生成扩容后数据库后，可以按照扩容后数据库对应的读写规则进行读写操作。因此，本发明实施例的数据库扩容的方法还可以包括：在数据拷贝成功后，停止数据库读写操作；在生成扩容后数据库后，设置扩容后数据库对应的第一读写规则，按照第一读写规则，对扩容后数据库进行读写操作。本发明实施例的数据库扩容是动态扩容的，在数据拷贝过程中，并没有停止数据库读写操作，此时应用可以继续将数据存储至现有数据库中；而且在数据拷贝过程中，新扩容数据库与现有数据库之间建立主从关系，新扩容数据库没有提供读写服务，只是从现有数据库中拷贝数据。由于数据拷贝成功后，生成扩容后数据库，此时可以是扩容后数据库提供读写服务，所以在数据拷贝成功后，停止数据库读写操作，然后设置扩容后数据库对应的第一读写规则，这样就可以按照设置的第一读写规则，对扩容后数据库进行读写操作。比如现有数据库有D1和D2，新扩容数据库有D3和D4，在数据拷贝过程中，应用可以继续向D1和D2中存储数据，此时的读写规则为按2求余，在数据拷贝成功后，停止采用按2求余的读写规则进行数据库读写操作，设置新的读写规则为按4求余，然后采用按4求余的规则向D1、D2、D3和D4中存储数据。可以发现，本发明实施例的数据库扩容方法中，仅需要暂时的停止数据库读写操作，不需要长时间停止应用，从而可以降低对业务的影响，提高用户体验。本发明实施例中，设置扩容后数据库对应的第一读写规则，可以包括：直接根据扩容后数据库的个数，设置第一读写规则；以及根据现有数据库对应的第二读写规则和扩容倍数，设置第一读写规则。读写规则是指将数据存储至具体的数据库的规则，比如有10个数据库，需要判断数据库将被分配至哪个数据库进行存储。此外，本发明实施例中读写规则可以看作是分库技术中的求余规则，比如有10个数据库，分库时按10求余，则对应的读写规则为按10求余。第一读写规则是指扩容后数据库对应的读写规则；第二读写规则是指现有数据库对应的读写规则。本方案中，可以直接根据扩容后数据库的个数设置扩容后数据库对应的读写规则；还可以将现有数据库对应的读写规则与扩容倍数相乘，获得扩容后数据库对应的读写规则。扩容后数据库运行平稳后，为了保持每一个数据库数据清洁，可以将每一个数据库的冗余数据清除掉。所以作为本发明的再一个可参考实施例，在生成扩容后数据库之后，数据库扩容的方法还可以包括：根据第一读写规则，设置冗余数据清除规则；按照冗余数据清除规则，对扩容后数据库进行冗余数据清除处理。上文介绍过第一读写规则是扩容后数据库对应的读写规则，因此可以利用第一读写规则，设置冗余数据清除规则，比如，一个数据按照第一读写规则，可以被分配至数据库D1中，那么如果这个数据在数据库D2中，则需要将数据库D2中的该数据清除掉。本发明实施例中，可以开启一个后台任务，对扩容后数据库中的数据进行冗余清除。此外，需要注意的是，如果不关注冗余数据，那么这部分冗余数据有而可以保留，这样就可以免除数据清洗工作，可以根据实际情况设置。为了便于理解，接下来结合具体的例子进行说明，图2是根据本发明实施例的现有数据库的示意图，图3是根据本发明实施例的进行数据库扩容的示意图，图4是根据本发明实施例的扩容后数据库的示意图。如图2所示，现有数据库中部署了2个数据库集群，每一个数据库集群都有一个主库和一个从库，比如一个主库DB1，对应的从库DB1-1；另一个主库DB2，对应从库DB2-1。扩容后为4个数据库集群，即需要增加2个数据库集群，也就是需要增加2个主数据库和2个从数据库，如图3所示，包括：一个新扩容主数据库DB3，对应的新扩容从数据库DB3-1；另一个新扩容主数据库DB4，对应的新扩容从数据库DB4-1。图3还可以看出，将新扩容主数据库DB3和新扩容从数据库DB3-1设置为现有主数据库DB1的从库，将新扩容主数据库DB4和新扩容从数据库DB4-1设置为现有主数据库DB2的从库，运用数据库主从数据同步机制，新扩容主数据库DB3和新扩容从数据库DB3-1将得到一份与现有主数据库DB1完全一致的数据，新扩容主数据库DB4和新扩容从数据库DB4-1将得到一份与现有主数据库DB2完全一致的数据，本发明实施例中运用数据库主从同步机制完成数据库之间的数据拷贝，无需开发代码进行数据结转。当新扩容主数据库DB3、新扩容从数据库DB3-1、新扩容主数据库DB4和新扩容从数据库DB4-1这四个新扩容数据库完成数据拷贝之后，将新扩容主数据库DB3和新扩容从数据库DB3-1从现有主数据库DB1上摘除从库设置，将DB3设置为主库，将DB3-1设置为DB3的从库，建立新的主从关系。同样地，将新扩容主数据库DB4和新扩容从数据库DB4-1从现有主数据库DB2上摘除从库设置，将DB4设置为主库，将DB4-1设置为DB4的从库，建立新的主从关系，得到图4所示的扩容后数据库的示意图。此外，为了保持每一个数据库的数据清洁，可以将每一个数据库的冗余数据清除，当然如果不关注冗余数据，那么这部分数据也可以保留，这样就可以免除数据清洗工作。图4中，对扩容后数据库进行冗余数据清除。以数据为例，未清除冗余数据之前，数据库DB1中的数据为，按照扩容后数据库对应的第一读写规则，即按4求余，将余数为0的数据落入数据库DB1中，这时候通过运算发现数据为数据库DB1的冗余数据，可以将数据清除，得到数据库DB1中的数据为。同样的原理，分别对数据库DB2、DB3和DB4进行冗余数据清除工作。至此，整个数据库扩容操作全部完成。图5是根据本发明实施例的数据库扩容的方法的主要流程的示意图。如图5所示，本发明实施例的数据库扩容的方法的主要流程可以包括：步骤S501，根据数据库扩容请求，获取扩容个数，计算扩容个数与至少一个现有数据库的个数的比值；步骤S502，判断比值是否为整数，若是，则执行步骤S503，否则，执行步骤S504；步骤S503，直接确定比值为扩容倍数；步骤S504，对比值进行向上取整处理，获得扩容倍数；步骤S505，根据扩容倍数，获取至少一个现有主数据库对应的新扩容主数据库和对应的新扩容从数据库；步骤S506，将对应的新扩容主数据库和对应的待扩容从数据库设置为至少一个现有主数据库对应的从数据库，以建立第一主从关系；步骤S507，根据第一主从关系，基于数据主从同步原理，将至少一个现有主数据库中的数据拷贝至对应的新扩容主数据库和对应的新扩容从数据库中；步骤S508，在数据拷贝成功后，停止数据库读写操作，解除第一主从关系；步骤S509，将对应的新扩容从数据库设置为对应的新扩容主数据库对应的从库，以建立第二主从关系；步骤S510，将至少一个现有数据库、对应的新扩容主数据库和对应的新扩容从数据库进行组合，生成扩容后数据库；步骤S511，设置扩容后数据库对应的第一读写规则，按照第一读写规则，对扩容后数据库进行读写操作；步骤S512，根据第一读写规则，设置冗余数据清除规则；步骤S513，按照冗余数据清除规则，对扩容后数据库进行冗余数据清除处理。需要注意的是，步骤S511中设置扩容后数据库对应的第一读写规则，可以包括：直接根据扩容后数据库的个数，设置第一读写规则；以及根据现有数据库对应的第二读写规则和扩容倍数，设置第一读写规则。还有，步骤S512和步骤S513是对扩容后数据库中的冗余数据进行清除，如果不需要进行冗余数据清除，则可以不执行步骤S512和步骤S513，本发明实施例对此不做限定。本发明实施例的数据库扩容的技术方案，能够利用数据库扩容请求和至少一个现有数据库，确定扩容倍数，进而获取每个现有数据库对应的新扩容数据库，然后利用主从关系进行数据拷贝，最后得到扩容后数据库，解决了现有技术中数据迁移过程中需要扫描所有数据而导致的耗时费力的技术问题，并且不需要长时间停止应用，实现了利用扩容倍数进行数据库动态扩容，降低对业务的影响，提高用户体验。图6是根据本发明实施例的数据库扩容的装置的主要模块的示意图。如图6所示，本发明实施例的数据库扩容的装置600可以包括：确定模块601、建立模块602和生成模块603。其中，确定模块601可用于：接收数据库扩容请求，根据数据库扩容请求和至少一个现有数据库，确定扩容倍数；建立模块602可用于：根据扩容倍数，获取至少一个现有数据库对应的新扩容数据库，建立至少一个现有数据库和对应的新扩容数据库的第一主从关系；生成模块603可用于：基于第一主从关系进行数据拷贝，在数据拷贝成功后，根据至少一个现有数据库和对应的新扩容数据库，生成扩容后数据库。本发明实施例中，确定模块601还可用于：根据数据库扩容请求，获取扩容个数；计算扩容个数与至少一个现有数据库的个数的比值，判断比值是否为整数；若是，则直接确定比值为扩容倍数；若否，则对比值进行向上取整处理，获得扩容倍数。本发明实施例中，至少一个现有数据库可以包括：至少一个现有主数据库。以及，建立模块602还可用于：根据扩容倍数，获取至少一个现有主数据库对应的新扩容主数据库和对应的新扩容从数据库；将对应的新扩容主数据库和对应的待扩容从数据库设置为至少一个现有主数据库对应的从数据库，以建立第一主从关系。本发明实施例中，生成模块603还可用于：根据第一主从关系，基于数据主从同步原理，将至少一个现有主数据库中的数据拷贝至对应的新扩容主数据库和对应的新扩容从数据库中；在数据拷贝成功后，解除第一主从关系；将对应的新扩容从数据库设置为对应的新扩容主数据库对应的从库，以建立第二主从关系；将至少一个现有数据库、对应的新扩容主数据库和对应的新扩容从数据库进行组合，生成扩容后数据库。本发明实施例中，生成模块603还可用于：在数据拷贝成功后，停止数据库读写操作；在生成扩容后数据库后，设置扩容后数据库对应的第一读写规则，按照第一读写规则，对扩容后数据库进行读写操作。本发明实施例中，生成模块603还可用于：直接根据扩容后数据库的个数，设置第一读写规则；以及，根据现有数据库对应的第二读写规则和扩容倍数，设置第一读写规则。本发明实施例中，生成模块603还可用于：根据第一读写规则，设置冗余数据清除规则；按照冗余数据清除规则，对扩容后数据库进行冗余数据清除处理。从以上描述可以看出，本发明实施例的数据库扩容的装置能够利用数据库扩容请求和至少一个现有数据库，确定扩容倍数，进而获取每个现有数据库对应的新扩容数据库，然后利用主从关系进行数据拷贝，最后得到扩容后数据库，解决了现有技术中数据迁移过程中需要扫描所有数据而导致的耗时费力的技术问题，并且不需要长时间停止应用，实现了利用扩容倍数进行数据库动态扩容，降低对业务的影响，提高用户体验。图7示出了可以应用本发明实施例的数据库扩容的方法或数据库扩容的装置的示例性系统架构700。如图7所示，系统架构700可以包括终端设备701、702、703，网络704和服务器705。网络704用以在终端设备701、702、703和服务器705之间提供通信链路的介质。网络704可以包括各种连接类型，例如有线、无线通信链路或者光纤电缆等等。用户可以使用终端设备701、702、703通过网络704与服务器705交互，以接收或发送消息等。终端设备701、702、703上可以安装有各种通讯客户端应用，例如购物类应用、网页浏览器应用、搜索类应用、即时通信工具、邮箱客户端、社交平台软件等。终端设备701、702、703可以是具有显示屏并且支持网页浏览的各种电子设备，包括但不限于智能手机、平板电脑、膝上型便携计算机和台式计算机等等。服务器705可以是提供各种服务的服务器，例如对用户利用终端设备701、702、703所浏览的购物类网站提供支持的后台管理服务器。后台管理服务器可以对接收到的产品信息查询请求等数据进行分析等处理，并将处理结果反馈给终端设备。需要说明的是，本发明实施例所提供的数据库扩容的方法一般由服务器705执行，相应地，数据库扩容的装置一般设置于服务器705中。应该理解，图7中的终端设备、网络和服务器的数目仅仅是示意性的。根据实现需要，可以具有任意数目的终端设备、网络和服务器。下面参考图8，其示出了适于用来实现本发明实施例的终端设备的计算机系统800的结构示意图。图8示出的终端设备仅仅是一个示例，不应对本发明实施例的功能和使用范围带来任何限制。如图8所示，计算机系统800包括中央处理单元801，其可以根据存储在只读存储器802中的程序或者从存储部分808加载到随机访问存储器803中的程序而执行各种适当的动作和处理。在RAM 803中，还存储有系统800操作所需的各种程序和数据。CPU 801、ROM 802以及RAM 803通过总线804彼此相连。输入/输出接口805也连接至总线804。以下部件连接至I/O接口805：包括键盘、鼠标等的输入部分806；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分807；包括硬盘等的存储部分808；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分809。通信部分809经由诸如因特网的网络执行通信处理。驱动器810也根据需要连接至I/O接口805。可拆卸介质811，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器810上，以便于从其上读出的计算机程序根据需要被安装入存储部分808。特别地，根据本发明公开的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本发明公开的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分809从网络上被下载和安装，和/或从可拆卸介质811被安装。在该计算机程序被中央处理单元801执行时，执行本发明的系统中限定的上述功能。需要说明的是，本发明所示的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本发明中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本发明中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、电线、光缆、RF等等，或者上述的任意合适的组合。附图中的流程图和框图，图示了按照本发明各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本发明实施例中所涉及到的模块可以通过软件的方式实现，也可以通过硬件的方式来实现。所描述的模块也可以设置在处理器中，例如，可以描述为：一种处理器包括确定模块、建立模块和生成模块。其中，这些模块的名称在某种情况下并不构成对该模块本身的限定，例如，确定模块还可以被描述为“接收数据库扩容请求，根据数据库扩容请求和至少一个现有数据库，确定扩容倍数的模块”。作为另一方面，本发明还提供了一种计算机可读介质，该计算机可读介质可以是上述实施例中描述的设备中所包含的；也可以是单独存在，而未装配入该设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被一个该设备执行时，使得该设备包括：接收数据库扩容请求，根据数据库扩容请求和至少一个现有数据库，确定扩容倍数；根据扩容倍数，获取至少一个现有数据库对应的新扩容数据库，建立至少一个现有数据库和对应的新扩容数据库的第一主从关系；基于第一主从关系进行数据拷贝，在数据拷贝成功后，根据至少一个现有数据库和对应的新扩容数据库，生成扩容后数据库。根据本发明实施例的技术方案，能够利用数据库扩容请求和至少一个现有数据库，确定扩容倍数，进而获取每个现有数据库对应的新扩容数据库，然后利用主从关系进行数据拷贝，最后得到扩容后数据库，解决了现有技术中数据迁移过程中需要扫描所有数据而导致的耗时费力的技术问题，并且不需要长时间停止应用，实现了利用扩容倍数进行数据库动态扩容，降低对业务的影响，提高用户体验。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，取决于设计要求和其他因素，可以发生各种各样的修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
