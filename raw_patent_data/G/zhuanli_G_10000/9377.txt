标题title
一种数据处理方法、处理装置、电子设备及存储介质
摘要abst
本公开是关于一种数据处理方法、处理装置、电子设备及存储介质，其中方法包括：从内存中读取权重矩阵，其中，权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，权重矩阵中保存有多个嵌入向量变量值以及各嵌入向量变量值对应的序号，嵌入向量变量值用于表示嵌入向量的权重，嵌入向量是基于特征的各特征值生成的；在权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值，目标输入嵌入向量变量值为待输入机器学习模型的全连接网络层中的嵌入向量变量值。本公开实施例能够避免在生成嵌入向量的过程中出现延迟升高的问题，使得生成嵌入向量的过程更加快速。
权利要求书clms
1.一种数据处理方法，其特征在于，包括：从内存中读取权重矩阵，其中，所述权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，所述权重矩阵中保存有多个嵌入向量变量值以及各嵌入向量变量值对应的序号，所述嵌入向量变量值用于表示嵌入向量的权重；在所述权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值，所述目标输入嵌入向量变量值为待输入所述机器学习模型的全连接网络层中的嵌入向量变量值。2.根据权利要求1所述的方法，其特征在于，所述从内存中读取权重矩阵之前，所述方法还包括：加载所述机器学习模型的数据文件中的数据至内存，所述数据文件包括：计算图和检查点文件，所述计算图用于表示所述机器学习模型的结构，所述检查点文件用于保存所述计算图所表示的机器学习模型中，各神经网络节点的嵌入向量变量值；从内存中提取所述嵌入向量变量值；将所提取的所述嵌入向量变量值保存为所述权重矩阵；缓存所述权重矩阵至内存。3.根据权利要求2所述的方法，其特征在于，所述缓存所述权重矩阵至内存之后，所述方法还包括：在所述机器学习模型的计算图中删除目标删除节点，得到新的计算图，所述目标删除节点为与嵌入向量变量值加载至内存相关的节点；加载所述新的计算图至内存，得到新的机器学习模型。4.根据权利要求3所述的方法，其特征在于，所述在所述权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值之后，所述方法还包括：将所述目标输入嵌入向量变量值输入所述新的机器学习模型的全连接网络层，以使所述新的机器学习模型基于所述目标输入嵌入向量变量值输出预测结果，并基于所述预测结果进行广告内容推荐。5.一种数据处理装置，其特征在于，包括：读取模块，被配置为执行从内存中读取权重矩阵，其中，所述权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，所述权重矩阵中保存有多个嵌入向量变量值以及各嵌入向量变量值对应的序号，所述嵌入向量变量值用于表示嵌入向量的权重；查找模块，被配置为执行在所述权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值，所述目标输入嵌入向量变量值为待输入所述机器学习模型的全连接网络层中的嵌入向量变量值。6.根据权利要求5所述的装置，其特征在于，所述装置还包括：第一加载模块，被配置为执行加载所述机器学习模型的数据文件中的数据至内存，所述数据文件包括：计算图和检查点文件，所述计算图用于表示所述机器学习模型的结构，所述检查点文件用于保存所述计算图所表示的机器学习模型中，各神经网络节点的嵌入向量变量值；提取模块，被配置为执行从内存中提取所述嵌入向量变量值；保存模块，被配置为执行将所提取的所述嵌入向量变量值保存为所述权重矩阵；缓存模块，被配置为执行缓存所述权重矩阵至内存。7.根据权利要求6所述的装置，其特征在于，所述装置还包括：删除模块，被配置为执行在所述机器学习模型的计算图中删除目标删除节点，得到新的计算图，所述目标删除节点为与嵌入向量变量值加载至内存相关的节点；第二加载模块，被配置为执行加载所述新的计算图至内存，得到新的机器学习模型。8.根据权利要求7所述的装置，其特征在于，所述装置还包括：输入模块，被配置为执行将所述目标输入嵌入向量变量值输入所述新的机器学习模型的全连接网络层，以使所述新的机器学习模型基于所述目标输入嵌入向量变量值输出预测结果，并基于所述预测结果进行广告内容推荐。9.一种服务器，其特征在于，包括：处理器；用于存储所述处理器可执行指令的存储器；其中，所述处理器被配置为执行所述指令，以实现如权利要求1至4中任一项所述的数据处理方法。10.一种存储介质，当所述存储介质中的指令由服务器的处理器执行时，使得服务器能够执行如权利要求1至4中任一项所述的数据处理方法。
说明书desc
技术领域本公开涉及计算机技术领域，尤其涉及一种数据处理方法、处理装置、电子设备及存储介质。背景技术随着深度学习技术的快速发展，基于深度学习技术的内容推荐方法越来越广泛地应用于诸如广告推荐等业务场景中，这就需要对所产生的数据进行处理。相关技术在对待处理数据进行处理的过程中，通常先提取数据的特征，再生成特征的特征值，然后通过TensorFlow中的embedding_lookup_sparse操作生成特征值对应的嵌入向量，即，将特征值转换为向量表示的形式，再将嵌入向量输入全连接网络层，得到全连接网络层的输出结果，进而基于输出结果进行内容推荐。其中，TensorFlow是一个开源的、基于C++计算机程序设计语言的机器学习框架，TensorFlow的embedding_lookup_sparse操作中通常包括多个基础子节点。然而，在生成嵌入向量的过程中，由于TensorFlow底层的计算采用线程池模型，因此所有节点的线程资源是一定的，一旦embedding_lookup_sparse操作中某个子节点的线程资源被其他节点占用，则该子节点将因没有线程资源而无法计算，需要在重新得到线程资源后才能继续计算，造成embedding_lookup_sparse操作延迟升高，导致生成嵌入向量的过程延迟升高。发明内容本公开提供一种数据处理方法、处理装置、电子设备及存储介质，以至少解决相关技术中生成嵌入向量的过程延迟高的问题。本公开的技术方案如下：根据本公开实施例的第一方面，提供一种数据处理方法，包括：从内存中读取权重矩阵，其中，所述权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，所述权重矩阵中保存有多个嵌入向量变量值以及各嵌入向量变量值对应的序号，所述嵌入向量变量值用于表示嵌入向量的权重；在所述权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值，所述目标输入嵌入向量变量值为待输入所述机器学习模型的全连接网络层中的嵌入向量变量值。可选的，所述从内存中读取权重矩阵之前，所述方法还包括：加载所述机器学习模型的数据文件中的数据至内存，所述数据文件包括：计算图和检查点文件，所述计算图用于表示所述机器学习模型的结构，所述检查点文件用于保存所述计算图所表示的机器学习模型中，各神经网络节点的嵌入向量变量值；从内存中提取所述嵌入向量变量值；将所提取的所述嵌入向量变量值保存为所述权重矩阵；缓存所述权重矩阵至内存。可选的，所述缓存所述权重矩阵至内存之后，所述方法还包括：在所述机器学习模型的计算图中删除目标删除节点，得到新的计算图，所述目标删除节点为与嵌入向量变量值加载至内存相关的节点；加载所述新的计算图至内存，得到新的机器学习模型。可选的，所述在所述权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值之后，所述方法还包括：将所述目标输入嵌入向量变量值输入所述新的机器学习模型的全连接网络层，以使所述新的机器学习模型基于所述目标输入嵌入向量变量值输出预测结果，并基于所述预测结果进行广告内容推荐。可选的，所述在所述权重矩阵中查找与目标查找序号对应的嵌入向量变量值的步骤，包括：获取所述目标查找序号及预设长度，并根据所述目标查找序号及所述预设长度，确定所述目标输入嵌入向量变量值在所述权重矩阵中的偏移起始位置，所述预设长度为预设的嵌入向量变量值的长度；在所述偏移起始位置处，从所述权重矩阵中抽取预设长度的所述嵌入向量变量值，作为所述目标输入嵌入向量变量值。可选的，在抽取到多个所述嵌入向量变量值的情况下，所述方法还包括：将多个所述嵌入向量变量值相加，并进行平均值处理，得到新的嵌入向量变量值；将所述新的嵌入向量变量值确定为所述目标输入嵌入向量变量值。根据本公开实施例的第二方面，提供一种数据处理装置，包括：读取模块，被配置为执行从内存中读取权重矩阵，其中，所述权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，所述权重矩阵中保存有多个嵌入向量变量值以及各嵌入向量变量值对应的序号，所述嵌入向量变量值用于表示嵌入向量的权重；查找模块，被配置为执行在所述权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值，所述目标输入嵌入向量变量值为待输入所述机器学习模型的全连接网络层中的嵌入向量变量值。可选的，所述装置还包括：第一加载模块，被配置为执行加载所述机器学习模型的数据文件中的数据至内存，所述数据文件包括：计算图和检查点文件，所述计算图用于表示所述机器学习模型的结构，所述检查点文件用于保存所述计算图所表示的机器学习模型中，各神经网络节点的嵌入向量变量值；提取模块，被配置为执行从内存中提取所述嵌入向量变量值；保存模块，被配置为执行将所提取的所述嵌入向量变量值保存为所述权重矩阵；缓存模块，被配置为执行缓存所述权重矩阵至内存。可选的，所述装置还包括：删除模块，被配置为执行在所述机器学习模型的计算图中删除目标删除节点，得到新的计算图，所述目标删除节点为与嵌入向量变量值加载至内存相关的节点；第二加载模块，被配置为执行加载所述新的计算图至内存，得到新的机器学习模型。可选的，所述装置还包括：输入模块，被配置为执行将所述目标输入嵌入向量变量值输入所述新的机器学习模型的全连接网络层，以使所述新的机器学习模型基于所述目标输入嵌入向量变量值输出预测结果，并基于所述预测结果进行广告内容推荐。可选的，所述查找模块包括：获取子模块，被配置为执行获取所述目标查找序号及预设长度，并根据所述目标查找序号及所述预设长度，确定所述目标输入嵌入向量变量值在所述权重矩阵中的偏移起始位置，所述预设长度为预设的嵌入向量变量值的长度；抽取子模块，被配置为执行在所述偏移起始位置处，从所述权重矩阵中抽取预设长度的所述嵌入向量变量值，作为所述目标输入嵌入向量变量值。可选的，在抽取到多个所述嵌入向量变量值的情况下，所述装置还包括：计算模块，被配置为执行将多个所述嵌入向量变量值相加，并进行平均值处理，得到新的嵌入向量变量值；确定模块，被配置为执行将所述新的嵌入向量变量值确定为所述目标输入嵌入向量变量值。根据本公开实施例的第三方面，提供一种服务器，包括：处理器；用于存储处理器可执行指令的存储器；其中，所述处理器被配置为执行所述指令，以实现本公开实施例第一方面提供的数据处理方法。根据本公开实施例的第四方面，提供一种存储介质，当所述存储介质中的指令由移动终端的处理器执行时，使得移动终端能够执行本公开实施例第一方面提供的数据处理方法。根据本公开实施例的第五方面，提供一种计算机程序产品，使得计算机执行本公开实施例第一方面提供的数据处理方法。本公开的实施例提供的技术方案至少带来以下有益效果：本公开实施例提供的一种数据处理方法、处理装置、电子设备及存储介质，通过从内存中读取权重矩阵，从而在权重矩阵中查找与目标查找序号对应的嵌入向量变量值，然后将该嵌入向量变量值作为目标输入嵌入向量变量值，即作为待输入机器学习模型的全连接网络层中的嵌入向量变量值，由于权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，因此不需要再通过TensorFlow中的embedding_lookup_sparse操作生成特征值对应的嵌入向量，避免了因embedding_lookup_sparse操作中某个子节点的线程资源被其他节点占用而导致的embedding_lookup_sparse操作延迟升高的问题，从而避免在生成嵌入向量的过程中出现延迟升高的问题，使得生成嵌入向量的过程更加快速。应当理解的是，以上的一般描述和后文的细节描述仅是示例性和解释性的，并不能限制本公开。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本公开的实施例，并与说明书一起用于解释本公开的原理，并不构成对本公开的不当限定。图1是根据一示例性实施例示出的一种数据处理方法的流程图。图2是根据一示例性实施例示出的另一种数据处理方法的流程图。图3是根据一示例性实施例示出的再一种数据处理方法的流程图。图4是根据一示例性实施例示出的对计算图进行改写的示意图；图5是根据一示例性实施例示出的在权重矩阵中查找与目标查找序号对应的嵌入向量变量值的一种流程图。图6是根据一示例性实施例示出的第四种数据处理方法的流程图。图7是根据一示例性实施例示出的一种数据处理装置的框图。图8是根据一示例性实施例示出的另一种数据处理装置的框图。图9是根据一示例性实施例示出的再一种数据处理装置的框图。图10是根据一示例性实施例示出的第四种数据处理装置的框图。图11是根据一示例性实施例示出的查找模块的框图。图12是根据一示例性实施例示出的第五种数据处理装置的框图。图13是根据一示例性实施例示出的一种用于数据处理的装置的框图。图14是根据一示例性实施例示出的一种用于数据处理的装置的框图。具体实施方式为了使本领域普通人员更好地理解本公开的技术方案，下面将结合附图，对本公开实施例中的技术方案进行清楚、完整地描述。需要说明的是，本公开的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本公开的实施例能够以除了在这里图示或描述的那些以外的顺序实施。以下示例性实施例中所描述的实施方式并不代表与本公开相一致的所有实施方式。相反，它们仅是与如所附权利要求书中所详述的、本公开的一些方面相一致的装置和方法的例子。图1是根据一示例性实施例示出的一种数据处理方法的流程图，如图1所示，本公开实施例的数据方法方法用于终端中，包括以下步骤:S 101，从内存中读取权重矩阵。本公开实施例中，权重矩阵可以是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值得到的。可以理解的是，对于利用TensorFlow建立的机器学习模型，当需要打开模型时，可以通过读取该模型的数据文件以在内存中加载模型，在TensorFlow中一个模型的数据文件通常包括计算图文件和检查点文件，其中，计算图中保存有机器学习模型的结构，检查点文件中保存有机器学习模型中的嵌入向量变量值，因此，在读取数据文件后，便可以读取内存中的嵌入向量变量值，其中，嵌入向量变量值可以用于表示特征的各个嵌入向量的权重，它通常是一组具有固定长度的浮点值，且上述固定长度可以为预先设定好的。上述特征可以是预先从广告内容候选集的多条候选广告内容中提取得到的，特征的提取过程将在下文中示出。TensorFlow是一个开源的、基于C++计算机程序设计语言的机器学习框架，支持多种语言使用，可以以图形的形式建立机器学习模型。上述权重矩阵中，矩阵的行可以是桶号，每个桶中都有一个Embedding向量，且这些Embedding向量的长度固定，例如，一个权重矩阵中有1000个桶，每个桶中都有一个长度为8位的Embedding向量，则这个权重矩阵的大小可以为1000*8。S102，在权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值。本公开实施例中，在读取权重矩阵后，由于权重矩阵中保存有上述机器学习模型的所有嵌入向量变量值，因此可以从权重矩阵中查找需要的嵌入向量变量值，从而将查找到的嵌入向量变量值作为目标输入嵌入向量变量值，具体查找过程将在下述实施例中示出，其中，目标输入嵌入向量变量值可以是指待输入机器学习模型的全连接网络层中的嵌入向量变量值。可以理解的是，一个机器学习模型中可以包括全连接网络层，因此可以将查找到的目标输入嵌入向量变量值输入全连接网络层，以利用全连接网络层得到输出结果。作为本公开实施例一种可选的实施方式，在图1所示流程的基础上，如图2所示，本公开实施例的数据处理方法还可以包括：S201，加载机器学习模型的数据文件中的数据至内存。本公开实施例中，机器学习模型可以是利用TensorFlow预先建立好的，因此可以利用所保存的该机器学习模型的数据文件，将数据文件中的数据加载到内存中，即上述加载机器学习模型的数据至内存的过程，其中，上述数据文件可以包括：计算图和检查点文件，计算图中保存有机器学习模型的结构数据，检查点文件中保存有机器学习模型中的嵌入向量变量值，可见，计算图用于表示机器学习模型的结构，检查点文件用于保存上述计算图所表示的机器学习模型中各神经网络节点的嵌入向量变量值。S202，从内存中提取嵌入向量变量值。由于检查点文件中保存有机器学习模型中的嵌入向量变量值，并且这些嵌入向量变量值已经读取至内存中，因此可以内存中提取嵌入向量变量值。示例性地，可以利用TensorFlow的子图执行功能，在计算图中设置用于生成嵌入向量变量值的节点为输出节点，然后，通过对计算图执行会话运行后，便可以提取所有的嵌入向量变量值。S203，将所提取的嵌入向量变量值保存为权重矩阵。提取嵌入向量变量值后，便可以将所提取的嵌入向量变量值以权重矩阵的形式进行保存。S204，缓存权重矩阵至内存。在将嵌入向量变量值保存为权重矩阵后，便可以将该权重矩阵缓存至内存中，以便于需要使用嵌入向量变量值时，直接从内存缓存的权重矩阵中读取，提高了嵌入向量变量值的读取速度。作为本公开实施例一种可选的实施方式，如图3所示，本公开实施例的数据处理方法还可以包括：S301，在机器学习模型的计算图中删除目标删除节点，得到新的计算图。该步骤可以位于步骤S204之后，即，将权重矩阵缓存至内存后，可以删除先前加载机器学习模型的数据文件中的数据至内存过程中，在内存中缓存的嵌入向量变量值，这是由于，嵌入向量变量值通常的内存占用量是整个模型的99％，对于GB级别的模型，对内存的浪费比较严重，服务器在对模型进行更新时，往往采用双缓冲结构，即一个模型在使用时，同时另一个模型进行更新，因此，如果不对这部分内存进行处理，则在更新模型的时候，需要的内存是一个模型自身所占用内存的4倍，在使用模型时，需要的内存是一个模型自身所占用内存的2倍，这将限制服务器，尤其是单机服务器对模型的可支持大小。例如，如果不删除内存中缓存的嵌入向量变量值，则对于一台内存128GB的服务器，可支持的模型大小为32GB，但是，如果删除内存中缓存的嵌入向量变量值，则在更新模型的时候，需要的内存是一个模型自身所占用内存的3倍，因此，仍对于上述内存128GB的服务器，可支持的模型大小可以扩大至42.6GB，从而提高了单机服务器对模型的可支持大小。基于上述分析，本公开实施例可以对计算图进行改写，在机器学习模型的计算图中删除与嵌入向量变量值加载至内存相关的节点，即删除目标删除节点，从而使服务器加载删除目标删除节点后的计算图时，不会再将嵌入向量变量值加载至内存中。示例性地，可以将计算图中，进行embedding_lookup_sparse操作的节点进行短路操作，具体地，参考图4，可以在计算图中将全连接网络层指定为输入节点，然后将计算图中的embedding_looup_sparse操作中的节点给去掉，这样就避免了再次加载模型的数据时，仍然把检查点文件文件中的嵌入向量变量值加载到内存中。S302，加载新的计算图至内存，得到新的机器学习模型。得到新的计算图后，可以将新的计算图加载至内存，从而得到新的机器学习模型，由于新的机器学习模型对应的新的计算图中，去除了embedding_looup_sparse操作中的节点，即，去除了与嵌入向量变量值加载至内存相关的节点，因此不会再把检查点文件文件中的嵌入向量变量值加载到内存中，从而达到节省内存空间的目的，并且，使服务器在可用内存资源不变的情况下能够支持更大的模型。作为本公开实施例一种可选的实施方式，在得到新的机器学习模型，并且得到目标输入嵌入向量之后，可以将目标输入嵌入向量变量值输入新的机器学习模型的全连接网络层，以使新的机器学习模型基于目标输入嵌入向量变量值输出预测结果，该预测结果可以是一个某条候选广告被展示的置信度，置信度越高该条候选广告被展示的可能性越高，因此，服务器可以基于预测结果推荐相应的广告内容。上述特征可以是依据广告内容候选集中的多条候选广告内容提取得到的，例如，将性别作为特征，每个特征可以对应一个或多个特征值，例如，性别对应男或女，每个特征值可以对应一个嵌入向量，例如，男对应嵌入向量A，女对应嵌入向量A，在机器学习模型中，各嵌入向量可以以嵌入向量变量值的形式表示。作为本公开实施例一种可选的实施方式，如图5所示，在权重矩阵中查找与目标查找序号对应的嵌入向量变量值的步骤，可以包括：S1021，获取目标查找序号及预设长度，并根据目标查找序号及预设长度，确定目标输入嵌入向量变量值在权重矩阵中的偏移起始位置。可以理解的是，由于嵌入向量变量值通过一组浮点值表示，且长度通常是预先设定好的，因此可以称为预设长度。由于权重矩阵中保存有多个嵌入向量变量值以及各嵌入向量变量值对应的序号，因此在获取目标查找序号后，即，获取希望在权重矩阵中提取的嵌入向量变量值的序号后，便可以根据上述目标查找序号及预设长度，确定目标输入嵌入向量变量值在权重矩阵中的偏移起始位置，示例性地，一个特征的权重矩阵可以用一个大小为N*M的向量表示，其中，N表示权重矩阵中序号的个数，M表示预设长度，因此可以通过序号*M计算出目标输入嵌入向量变量值在权重矩阵中的偏移起始位置。S1022，在偏移起始位置处，从权重矩阵中抽取预设长度的嵌入向量变量值，作为目标输入嵌入向量变量值。示例性地，仍以上述大小为N*M的权重矩阵为例说明，在计算出该嵌入向量变量值在权重矩阵中的偏移起始位置后，便可以在偏移起始位置处，读取M个浮点值，这M个浮点值可以为该嵌入向量的嵌入向量变量值，从而可以将该嵌入向量变量值作为目标输入嵌入向量变量值。作为本公开实施例一种可选的实施方式，由于一个广告可以具有多个特征，有可能一次会抽取多个嵌入向量变量值，在这种情况下，如图6所示，本公开实施例的数据处理方法还可以包括：S410，将多个嵌入向量变量值相加，并进行平均值处理，得到新的嵌入向量变量值。示例性地，对于嵌入向量变量值a和嵌入向量变量值b，可以将它们相加后得到一个数值，然后取平均值，得到新的嵌入向量变量值。当然，还可以对相加结果进行平方平均数处理，示例性地，可以将上述嵌入向量变量值a和嵌入向量变量值b分别求平方，然后将求平方后的数值相加，再将相加结果开方，便得到了得到新的嵌入向量变量值。S420，将新的嵌入向量变量值确定为目标输入嵌入向量变量值。得到新的嵌入向量变量值后，便可以将该新的嵌入向量变量值，确定为目标输入嵌入向量变量值。本公开实施例提供的一种数据处理方法，通过从内存中读取权重矩阵，从而在权重矩阵中查找与目标查找序号对应的嵌入向量变量值，然后将该嵌入向量变量值作为目标输入嵌入向量变量值，即作为待输入机器学习模型的全连接网络层中的嵌入向量变量值，由于权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，因此不需要再通过TensorFlow中的embedding_lookup_sparse操作生成特征值对应的嵌入向量，避免了因embedding_lookup_sparse操作中某个子节点的线程资源被其他节点占用而导致的embedding_lookup_sparse操作延迟升高的问题，从而避免在生成嵌入向量的过程中出现延迟升高的问题，使得生成嵌入向量的过程更加快速。图7是根据一示例性实施例示出的一种数据处理装置框图。参照图7，该装置包括：读取模块610，被配置为执行从内存中读取权重矩阵，其中，权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，权重矩阵中保存有多个嵌入向量变量值以及各嵌入向量变量值对应的序号，嵌入向量变量值用于表示嵌入向量的权重。查找模块620，被配置为执行在权重矩阵中查找与目标查找序号对应的嵌入向量变量值，作为目标输入嵌入向量变量值，目标输入嵌入向量变量值为待输入机器学习模型的全连接网络层中的嵌入向量变量值。其中，在图7所示装置结构的基础上，如图8所示，本公开实施例的数据处理装置还可以包括：第一加载模块630，被配置为执行加载机器学习模型的数据文件中的数据至内存，数据文件包括：计算图和检查点文件，所述计算图用于表示所述机器学习模型的结构，所述检查点文件用于保存所述计算图所表示的机器学习模型中，各神经网络节点的嵌入向量变量值。提取模块640，被配置为执行从内存中提取嵌入向量变量值。保存模块650，被配置为执行将所提取的嵌入向量变量值保存为权重矩阵。缓存模块660，被配置为执行缓存权重矩阵至内存。其中，在图8所示装置结构的基础上，如图9所示，本公开实施例的数据处理装置还可以包括：删除模块670，被配置为执行在机器学习模型的计算图中删除目标删除节点，得到新的计算图，目标删除节点为与嵌入向量变量值加载至内存相关的节点。第二加载模块680，被配置为执行加载新的计算图至内存，得到新的机器学习模型。其中，在图9所示装置结构的基础上，如图10所示，本公开实施例的数据处理装置还可以包括：输入模块690，被配置为执行将目标输入嵌入向量变量值输入新的机器学习模型的全连接网络层，以使新的机器学习模型基于目标输入嵌入向量变量值输出预测结果，并基于预测结果进行广告内容推荐。其中，如图11所示，查找模块620包括：获取子模块6201，被配置为执行获取目标查找序号及预设长度，并根据目标查找序号及预设长度，确定目标输入嵌入向量变量值在权重矩阵中的偏移起始位置，预设长度为预设的嵌入向量变量值的长度。抽取子模块6202，被配置为执行在偏移起始位置处，从权重矩阵中抽取预设长度的嵌入向量变量值，作为目标输入嵌入向量变量值。其中，在抽取到多个嵌入向量变量值的情况下，如图12所示，本公开实施例的数据处理装置还可以包括：计算模块710，被配置为执行将多个嵌入向量变量值相加，并进行平均值处理，得到新的嵌入向量变量值。确定模块720，被配置为执行将新的嵌入向量变量值确定为目标输入嵌入向量变量值。本公开实施例提供的一种数据处理装置，通过从内存中读取权重矩阵，从而在权重矩阵中查找与目标查找序号对应的嵌入向量变量值，然后将该嵌入向量变量值作为目标输入嵌入向量变量值，即作为待输入机器学习模型的全连接网络层中的嵌入向量变量值，由于权重矩阵是预先在机器学习模型的数据文件加载至内存后，通过读取内存中的嵌入向量变量值生成得到的，因此不需要再通过TensorFlow中的embedding_lookup_sparse操作生成特征值对应的嵌入向量，避免了因embedding_lookup_sparse操作中某个子节点的线程资源被其他节点占用而导致的embedding_lookup_sparse操作延迟升高的问题，从而避免在生成嵌入向量的过程中出现延迟升高的问题，使得生成嵌入向量的过程更加快速。关于上述实施例中的装置，其中各个模块执行操作的具体方式已经在有关该方法的实施例中进行了详细描述，此处将不做详细阐述说明。图13是根据一示例性实施例示出的一种用于数据处理的装置800的框图。例如，装置800可以是服务器、个人计算机等。参照图13，装置800可以包括以下一个或多个组件：处理组件802，存储器804，电源组件806，多媒体组件808，音频组件810，输入/输出的接口812，传感器组件814，以及通信组件816。处理组件802通常控制装置800的整体操作，诸如与显示，电话呼叫，数据通信，相机操作和保存操作相关联的操作。处理组件802可以包括一个或多个处理器820来执行指令，以完成上述的方法的全部或部分步骤。此外，处理组件802可以包括一个或多个模块，便于处理组件802和其他组件之间的交互。例如，处理组件802可以包括多媒体模块，以方便多媒体组件808和处理组件802之间的交互。存储器804被配置为存储各种类型的数据以支持在装置800的操作。这些数据的示例包括用于在装置800上操作的任何应用程序或方法的指令，联系人数据，电话簿数据，消息，图片，视频等。存储器804可以由任何类型的易失性或非易失性存储设备或者它们的组合实现，如静态随机存取存储器，电可擦除可编程只读存储器，可擦除可编程只读存储器，可编程只读存储器，只读存储器，磁存储器，快闪存储器，磁盘或光盘。电源组件806为装置800的各种组件提供电力。电源组件806可以包括电源管理系统，一个或多个电源，及其他与为装置800生成、管理和分配电力相关联的组件。多媒体组件808包括在所述装置800和用户之间的提供一个输出接口的屏幕。在一些实施例中，屏幕可以包括液晶显示器和触摸面板。如果屏幕包括触摸面板，屏幕可以被实现为触摸屏，以接收来自用户的输入信号。触摸面板包括一个或多个触摸传感器以感测触摸、滑动和触摸面板上的手势。所述触摸传感器可以不仅感测触摸或滑动动作的边界，而且还检测与所述触摸或滑动操作相关的持续时间和压力。在一些实施例中，多媒体组件808包括一个前置摄像头和/或后置摄像头。当装置800处于操作模式，如拍摄模式或视频模式时，前置摄像头和/或后置摄像头可以接收外部的多媒体数据。每个前置摄像头和后置摄像头可以是一个固定的光学透镜系统或具有焦距和光学变焦能力。音频组件810被配置为输出和/或输入音频信号。例如，音频组件810包括一个麦克风，当装置800处于操作模式，如呼叫模式、保存模式和语音识别模式时，麦克风被配置为接收外部音频信号。所接收的音频信号可以被进一步存储在存储器804或经由通信组件816发送。在一些实施例中，音频组件810还包括一个扬声器，用于输出音频信号。I/O接口812为处理组件802和外围接口模块之间提供接口，上述外围接口模块可以是键盘，点击轮，按钮等。这些按钮可包括但不限于：主页按钮、音量按钮、启动按钮和锁定按钮。传感器组件814包括一个或多个传感器，用于为装置800提供各个方面的状态评估。例如，传感器组件814可以检测到装置800的打开/关闭状态，组件的相对定位，例如所述组件为装置800的显示器和小键盘，传感器组件814还可以检测装置800或装置800一个组件的位置改变，用户与装置800接触的存在或不存在，装置800方位或加速/减速和装置800的温度变化。传感器组件814可以包括接近传感器，被配置用来在没有任何的物理接触时检测附近物体的存在。传感器组件814还可以包括光传感器，如CMOS或CCD图像传感器，用于在成像应用中使用。在一些实施例中，该传感器组件814还可以包括加速度传感器，陀螺仪传感器，磁传感器，压力传感器或温度传感器。通信组件816被配置为便于装置800和其他设备之间有线或无线方式的通信。装置800可以接入基于通信标准的无线网络，如WiFi，运营商网络，或它们的组合。在一个示例性实施例中，通信组件816经由广播信道接收来自外部广播管理系统的广播信号或广播相关信息。在一个示例性实施例中，所述通信组件816还包括近场通信模块，以促进短程通信。例如，在NFC模块可基于射频识别技术，红外数据协会技术，超宽带技术，蓝牙技术和其他技术来实现。在示例性实施例中，装置800可以被一个或多个应用专用集成电路、数字信号处理器、数字信号处理设备、可编程逻辑器件、现场可编程门阵列、控制器、微控制器、微处理器或其他电子元件实现，用于执行上述数据处理方法。在示例性实施例中，还提供了一种包括指令的非临时性计算机可读存储介质，例如包括指令的存储器804，上述指令可由装置800的处理器820执行以完成上述方法。例如，所述非临时性计算机可读存储介质可以是ROM、随机存取存储器、CD-ROM、磁带、软盘和光数据存储设备等。图14是根据一示例性实施例示出的一种用于数据处理的装置900的框图。例如，装置900可以被提供为一服务器。参照图14，装置900包括处理组件922，其进一步包括一个或多个处理器，以及由存储器932所代表的存储器资源，用于存储可由处理组件922的执行的指令，例如应用程序。存储器932中存储的应用程序可以包括一个或一个以上的每一个对应于一组指令的模块。此外，处理组件922被配置为执行指令，以执行上述数据处理方法装置900还可以包括一个电源组件926被配置为执行装置900的电源管理，一个有线或无线网络接口950被配置为将装置900连接到网络，和一个输入输出接口958。装置900可以操作基于存储在存储器932的操作系统，例如Windows ServerTM，Mac OS XTM，UnixTM,LinuxTM，FreeBSDTM或类似。本领域技术人员在考虑说明书及实践这里公开的公开后，将容易想到本公开的其它实施方案。本公开旨在涵盖本公开的任何变型、用途或者适应性变化，这些变型、用途或者适应性变化遵循本公开的一般性原理并包括本公开未公开的本技术领域中的公知常识或惯用技术手段。说明书和实施例仅被视为示例性的，本公开的真正范围和精神仅由所附的权利要求指出。应当理解的是，本公开并不局限于上面已经描述并在附图中示出的精确结构，并且可以在不脱离其范围进行各种修改和改变。本公开的范围仅由所附的权利要求来限制。
