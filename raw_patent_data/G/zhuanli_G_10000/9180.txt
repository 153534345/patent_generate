标题title
一种高光谱成像系统及重构光谱成像方法
摘要abst
一种高光谱成像系统及重构光谱成像方法属于光电成像技术领域，不仅可以保持成像系统高灵敏度和高空间分辨率，而且谱段在轨可重构可以解决光谱分辨率与体积重量和有限星上资源的矛盾。本发明提出的高光谱成像系统，不仅在小体积尺寸下可保持成像系统高灵敏度和高空间分辨率，而且谱段可重构方法可以解决光谱分辨率与体积重量以及有限的压缩存储数传等硬件资源的矛盾。
权利要求书clms
1.一种高光谱成像系统，其特征在于，该系统包括：分光元件、图像传感器和数据处理单元；所述数据处理单元包括：通信模块、谱段开窗索引模块、成像参数记录模块、传感器驱动控制模块、图像数据接收模块、谱段可重构TDI模块和数据输出模块；所述分光元件贴合在所述图像传感器表面，光线进入所述分光元件后实现透光波长渐变，所述图像传感器根据波长选择通过不同的窗口进行曝光成像和读出；所述通信模块完成成像指令，接收解析和状态信息组帧发送；谱段开窗索引模块预存了分光元件全部透光波长投影位置的标定结果，当接收谱段选择指令后依据指令参数完成所述图像传感器开窗位置大小的索引；成像参数记录模块对FLASH进行读写操作，实现谱段选择执行结果、图像传感器开窗位置大小、不同谱段积分级数、曝光时间、增益的成像参数的记录保存以及上电自动读取功能；传感器驱动控制模块依据图像传感器开窗设置参数生成图像传感器驱动时序，完成所需谱段对应窗口的曝光成像；图像数据接收模块接收图像传感器输出数据，并进行数据解码和格式转换，为谱段可重构TDI模块提供预处理图像数据；谱段可重构TDI模块根据谱段选择指令参数和所需谱段积分级数参数，分别对所述分光元件和图像传感器接收的所需m个谱段进行独立时间延迟积分操作；数据输出模块将所述图像传感器每个行周期每个谱段的1行积分图像进行谱段和行流水编号后按数传格式输出，谱段编号按照波长依次编号，同一行m个谱段数据行流水号相同，经过一个行周期行流水号自动加1，并将数据打包至输出数据。2.根据权利要求1所述的一种高光谱成像系统，其特征在于，所述分光元件为渐变滤光片。3.根据权利要求1所述的一种高光谱成像系统，其特征在于，所述图像传感器为面阵CMOS图像传感器。4.根据权利要求1、2或3所述的一种高光谱成像系统，其特征在于，所述图像传感器与所述渐变滤光片的安装方向为行向正交于渐变滤光片透光光谱变化方向。5.基于1-4任意一项权利要求所述的一种高光谱成像系统的重构光谱成像方法，其特征在于，该方法包括如下步骤：步骤一：系统上电，所述成像参数记录模块读取FLASH存储的谱段选择结果、图像传感器开窗位置大小、不同谱段积分级数、曝光时间、增益的成像参数；步骤二：针对某一应用场景，分析得到一组谱段数量为m的光谱；步骤三：选取步骤二所述光谱中的m个波长生成谱段选择指令，发送至谱段开窗索引模块；步骤四：所述谱段开窗索引模块根据谱段选择指令参数，对预存的渐变滤光片透光波长投影位置标定结果进行索引，确定图像传感器m个窗口位置及大小，生成图像传感器开窗参数及谱段选择执行结果，并存储至FLASH；步骤五：谱段可重构TDI模块根据谱段选择执行结果，结合标定的波长响应能量分布数据，以各谱段响应灰度均匀为原则，确定不同谱段的积分级数，生成数字域TDI积分级数参数，并存储至FLASH；步骤六：在接收到开始拍照指令后，传感器驱动控制模块按照图像传感器开窗设置参数自动生成传感器驱动时序，同时谱段可重构TDI模块按照积分级数参数对m个谱段进行独立时间延迟积分；步骤七：数据输出模块对TDI图像经过谱段和行流水编号数据格式编排，每个行周期对外输出m行m个谱段积分图像；步骤八：当应用需求更改时，重新得到一组m个波长；重复步骤二至步骤七，即向数据处理单元发送一条谱段选择指令，即可得到谱段重构后的m个谱段积分图像，实现谱段重构的成像方法。6.根据权利要求5所述的重构光谱成像方法，其特征在于，所述谱段可重构TDI模块对每个谱段采用单独的TDI算法。7.根据权利要求5所述的重构光谱成像方法，其特征在于，所述步骤三中的谱段选择的获取包括如下步骤：步骤一：将渐变滤光片表贴于面阵CMOS图像传感器感光面，其粘贴方向为面阵CMOS图像传感器行向正交于渐变滤光片透光光谱变化方向；步骤二：设置面阵CMOS图像传感器为非开窗面阵输出；步骤三：在渐变滤光片透光波长范围内分别选取短、中、长3类波长作为测试波长，选取高精度单色仪输出测试波长单色光；步骤四：在成像参数记录模块中设置成像参数记录模块曝光时间、增益的成像参数，使得一类测试波长中透过率最强波长的图像亮条区域灰度约为饱和值3/4；步骤五：按照单色仪最小步长调整单色仪输出一类单色光波长；步骤六：拍照并存储图像；步骤七：在一类测试波长中，重复步骤五和六，直至遍历渐变滤光片一类透光波长范围；在所有类测试波长中，重复步骤五和六，直至遍历渐变滤光片所有类透光波长范围；步骤八：计算所有图像响应区间和能量分布，建立全部波长在面阵CMOS图像传感器感光面的投影映射关系和响应能量分布曲线。
说明书desc
技术领域本发明属于光电成像技术领域，涉及一种高光谱成像系统及重构光谱成像方法。背景技术光谱成像技术在获取目标的二维空间特征信息的同时，可以获取目标的光谱信息，因此在军事侦查、农林观察、环境监测、灾害调查以及地质勘探等领域具有广阔的应用空间并发挥着重要作用。其中高光谱成像系统在自然科学的大部分领域以及人民生活的部分领域，比如农作物产量预估、土壤质量评估、水体污染检测、空气污染检测等，起着重要作用。目前国内外高光谱成像系统一般采用首先针对应用分析谱段需求，然后以此为依据研制谱段固定的成像系统的方法，因此一旦设计或研制完成其应用也被限制，不能灵活适配各类应用需求，而为了满足光谱分辨率高和谱段范围宽的双重需求，系统又普遍存在体积重量大、成本高昂的问题。而近些年快速发展的微小卫星由于受体积重量限制以及星上有限压缩存储和数传资源的制约，难以实现高空间分辨率高光谱分辨率的高光谱成像应用。发明内容为了解决上述问题，本发明提出一种高光谱成像系统及重构光谱成像方法，不仅可以保持成像系统高灵敏度和高空间分辨率，而且谱段在轨可重构可以解决光谱分辨率与体积重量和有限星上资源的矛盾。本发明解决技术问题所采用的技术方案如下：一种高光谱成像系统，该系统包括：分光元件、图像传感器和数据处理单元；所述数据处理单元包括：通信模块、谱段开窗索引模块、成像参数记录模块、传感器驱动控制模块、图像数据接收模块、谱段可重构TDI模块和数据输出模块；所述分光元件贴合在所述图像传感器表面，光线进入所述分光元件后实现透光波长渐变，所述图像传感器根据波长选择通过不同的窗口进行曝光成像和读出；所述通信模块完成成像指令，接收解析和状态信息组帧发送；谱段开窗索引模块预存了分光元件全部透光波长投影位置的标定结果，当接收谱段选择指令后依据指令参数完成所述图像传感器开窗位置大小的索引；成像参数记录模块对FLASH进行读写操作，实现谱段选择执行结果、图像传感器开窗位置大小、不同谱段积分级数、曝光时间、增益的成像参数的记录保存以及上电自动读取功能；传感器驱动控制模块依据图像传感器开窗设置参数生成图像传感器驱动时序，完成所需谱段对应窗口的曝光成像；图像数据接收模块接收图像传感器输出数据，并进行数据解码和格式转换，为谱段可重构TDI模块提供预处理图像数据；谱段可重构TDI模块根据谱段选择指令参数和所需谱段积分级数参数，分别对所述分光元件和图像传感器接收的所需m个谱段进行独立时间延迟积分操作；数据输出模块将所述图像传感器每个行周期每个谱段的1行积分图像进行谱段和行流水编号后按数传格式输出，谱段编号按照波长依次编号，同一行m个谱段数据行流水号相同，经过一个行周期行流水号自动加1，并将数据打包至输出数据。优选的，所述分光元件为渐变滤光片。优选的，所述图像传感器为面阵CMOS图像传感器。优选的，所述图像传感器与所述渐变滤光片的安装方向为行向正交于渐变滤光片透光光谱变化方向。一种高光谱成像系统的重构光谱成像方法，该方法包括如下步骤：步骤一：系统上电，所述成像参数记录模块读取FLASH存储的谱段选择结果、图像传感器开窗位置大小、不同谱段积分级数、曝光时间、增益的成像参数；步骤二：针对某一应用场景，分析得到一组谱段数量为m的光谱；步骤三：选取步骤二所述光谱中的m个波长生成谱段选择指令，发送至谱段开窗索引模块；步骤四：所述谱段开窗索引模块根据谱段选择指令参数，对预存的渐变滤光片透光波长投影位置标定结果进行索引，确定图像传感器m个窗口位置及大小，生成图像传感器开窗参数及谱段选择执行结果，并存储至FLASH；步骤五：谱段可重构TDI模块根据谱段选择执行结果，结合标定的波长响应能量分布数据，以各谱段响应灰度均匀为原则，确定不同谱段的积分级数，生成TDI积分级数参数，并存储至FLASH；步骤六：在接收到开始拍照指令后，传感器驱动控制模块按照图像传感器开窗设置参数自动生成传感器驱动时序，同时谱段可重构TDI模块按照积分级数参数对m个谱段进行独立时间延迟积分；步骤七：数据输出模块对TDI图像经过谱段和行流水编号数据格式编排，每个行周期对外输出m行m个谱段积分图像；步骤八：当应用需求更改时，重新得到一组m个波长；重复步骤二至步骤七，即向数据处理单元发送一条谱段选择指令，即可得到谱段重构后的m个谱段积分图像。优选的，所述谱段可重构TDI模块对每个谱段采用单独的TDI算法。优选的，所述步骤三中的谱段选择的获取包括如下步骤：步骤一：将渐变滤光片表贴于面阵CMOS图像传感器感光面，其粘贴方向为面阵CMOS图像传感器行向正交于渐变滤光片透光光谱变化方向；步骤二：设置面阵CMOS图像传感器为非开窗面阵输出；步骤三：在渐变滤光片透光波长范围内分别选取短、中、长3类波长作为测试波长，选取高精度单色仪输出测试波长单色光；步骤四：在成像参数记录模块中设置成像参数记录模块曝光时间、增益的成像参数，使得一类测试波长中透过率最强波长的图像亮条区域灰度约为饱和值3/4；步骤五：按照单色仪最小步长调整单色仪输出一类单色光波长；步骤六：拍照并存储图像；步骤七：在一类测试波长中，重复步骤五和六，直至遍历渐变滤光片一类透光波长范围；在所有类测试波长中，重复步骤五和六，直至遍历渐变滤光片所有类透光波长范围；步骤八：计算所有图像响应区间和能量分布，建立全部波长在面阵CMOS图像传感器感光面的投影映射关系和响应能量分布曲线。本发明的有益效果是：本发明提出的高光谱成像系统，不仅在小体积尺寸下可保持成像系统高灵敏度和高空间分辨率，而且谱段可重构方法可以解决光谱分辨率与体积重量以及有限的压缩存储数传等硬件资源的矛盾。附图说明图1本发明一种高光谱成像系统焦面单元结构示意图。图2本发明谱段重构示意图。图3本发明渐变滤光片透光波长归一化能量分布示意图。图4本发明一种高光谱成像系统的重构光谱成像方法流程图。具体实施方式下面结合附图和实施例对本发明做进一步详细说明。如图1所示，本发明的高光谱成像系统包括：焦面单元和数据处理单元；焦面单元包括渐变滤光片和面阵CMOS图像传感器。渐变滤光片与面阵CMOS图像传感器感光面紧密贴合，其安装方向为面阵CMOS图像传感器行向正交于渐变滤光片透光光谱变化方向。面阵CMOS图像传感器具有行向多开窗功能，可根据渐变滤光片在传感器的透光光谱投影进行多窗口成像，m个谱段对应m个成像窗口。根据渐变滤光片的穿透波长在面阵CMOS图像传感器行向发生线性变化的规律，只要调整面阵CMOS图像传感器的开窗位置和大小即可实现谱段的调整，如图2所示。数据处理单元以可编程逻辑器件为核心，围绕谱段可重构高光谱成像需求，实现通信、谱段开窗索引、成像参数记录、传感器驱动控制、图像数据接收、谱段可重构TDI、数据输出等功能。通信模块完成成像指令接收解析和状态信息组帧发送。谱段开窗索引模块预存了渐变滤光片全部透光波长投影位置的标定结果，当接收的谱段选择指令后依据指令参数完成面阵CMOS图像传感器开窗位置大小的索引。成像参数记录模块对FLASH进行读写操作，实现谱段选择执行结果、面阵CMOS图像传感器开窗位置大小、不同谱段积分级数、曝光时间、增益等成像参数的记录保存以及上电自动读取功能。传感器驱动控制模块依据面阵CMOS图像传感器开窗设置参数生成传感器驱动时序，完成所需谱段对应窗口的曝光成像。图像数据接收模块接收面阵CMOS图像传感器输出数据，并进行数据解码和格式转换，为谱段可重构TDI模块提供预处理图像数据。谱段可重构TDI模块根据谱段选择指令参数和所需谱段积分级数参数，分别对所需m个谱段进行独立时间延迟积分操作，并采用动态累加设计思想使其不受部分或全部谱段更改重构的影响，同时可在不损失空间分辨率和时间分辨率前提下提升系统灵敏度，解决高光谱成像普遍存在的能量低问题。数据输出模块将每个行周期每个谱段的1行积分图像进行谱段和行流水编号后按数传格式输出，谱段编号按照波长依次编号，同一行m个谱段数据行流水号相同，经过一个行周期行流水号自动加1，另外为了方便后期图像处理还可以将谱段选择执行结果、传感器开窗位置、不同谱段积分级数、曝光时间、增益、成像时间等数据打包至输出数据。受星上资源限制，本发明高光谱成像系统的谱段数量m可根据选用图像传感器和数传资源计算得到，其计算公式为：式中，Ncolumn为面阵CMOS图像传感器列向分辨率，Nbit为图像数据位深，Nsensor为成像系统包含的焦面单元数量，T为行周期，k为数据压缩比，遥感成像通常选用压缩比最大为4的无损压缩，Nchnl为数传通道数，Q为数传单通道速率，t1为卫星拍照时长，t2为卫星数传时长。本发明高光谱成像系统可在确定谱段数量后根据应用需求进行谱段重构。渐变滤光片在传感器的透光光谱投影及归一化能量分布示意图如图3所示，不仅每个波长的单色光均有一定宽度的透光窗口，而且每个波长透过率不同，另外对于短波长间隔的相邻谱段其透光窗口存在部分重叠。该分布特性是渐变滤光片在小体积尺寸内实现光谱细分固然引起的。因此，每次谱段重构除了考虑透光光谱投影位置区间分布和能量分布外，为了避免谱段混叠还需满足最小谱段间隔要求。所述透光光谱投影位置区间分布和能量分布以及最小谱段间隔要求由焦面单元透光光谱投影标定得到，具体步骤如下：步骤一：将渐变滤光片表贴于面阵CMOS图像传感器感光面，其粘贴方向为面阵CMOS图像传感器行向正交于渐变滤光片透光光谱变化方向；步骤二：设置面阵CMOS图像传感器为非开窗面阵输出；步骤三：在渐变滤光片透光波长范围内分别选取短、中、长3类波长作为测试波长，选取高精度单色仪输出测试波长单色光；步骤四：设置曝光时间、增益等成像参数，使得测试波长中透过率最强波长的图像亮条区域灰度约为饱和值3/4；步骤五：按照单色仪最小步长调整单色仪输出单色光波长；步骤六：拍照并存储图像；步骤七：在一类测试波长中，重复步骤五和六，直至遍历渐变滤光片一类透光波长范围；在所有类测试波长中，重复步骤五和六，直至遍历渐变滤光片所有类透光波长范围；步骤八：计算所有图像响应区间和能量分布，建立全部波长在传感器感光面的投影映射关系和响应能量分布曲线。所述高光谱成像系统谱段重构成像方法，步骤如下：步骤一：系统上电，所述成像参数记录模块读取FLASH存储的谱段选择结果、图像传感器开窗位置大小、不同谱段积分级数、曝光时间、增益的成像参数；步骤二：针对某一应用场景，分析得到一组谱段数量为m的光谱；步骤三：选取步骤二所述光谱中的m个波长生成谱段选择指令，发送至谱段开窗索引模块；步骤四：所述谱段开窗索引模块根据谱段选择指令参数，对预存的渐变滤光片透光波长投影位置标定结果进行索引，确定图像传感器m个窗口位置及大小，生成图像传感器开窗参数及谱段选择执行结果，并存储至FLASH；步骤五：谱段可重构TDI模块根据谱段选择执行结果，结合标定的波长响应能量分布数据，以各谱段响应灰度均匀为原则，确定不同谱段的积分级数，生成TDI积分级数参数，一方面发送至所述的谱段可重构TDI模块，另一方面将积分级数参数存储至FLASH；步骤六：在接收到开始拍照指令后，传感器驱动控制模块按照图像传感器开窗设置参数自动生成传感器驱动时序，同时谱段可重构TDI模块按照积分级数参数对m个谱段进行独立时间延迟积分；步骤七：数据输出模块对TDI图像经过谱段和行流水编号数据格式编排，每个行周期对外输出m行m个谱段积分图像；步骤八：当应用需求更改时，重新得到一组m个波长；重复步骤二至步骤七，即向数据处理单元发送一条谱段选择指令，即可得到谱段重构后的m个谱段积分图像，实现谱段重构的成像方法。所述的m个谱段的确定，除了紧密结合应用需求外，还应该兼顾焦面单元透光光谱在传感器感光面的投影映射标定结果，使得选取谱段满足最小谱段间隔要求，以免产生谱段间混叠串扰，该操作可以由数据处理单元自动判断并对不满足最小间隔要求的谱段进行微调，也可以在工控机等其他计算平台完成后直接发送至高光谱成像系统。
