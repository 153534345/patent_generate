标题title
基于自适应卷积核和级联检测头的土地覆盖变化检测方法
摘要abst
本发明公开了基于自适应卷积核和级联检测头的土地覆盖变化检测方法，包括以下步骤：S1：数据集准备；同一区域不同时期的土地覆盖变化检测数据集准备，使用旋转、缩放、裁剪和对比度等方式进行数据集增强；S2：将数据集输入编码器模型进行特征提取；S3：将步骤S2提取的特征输入优化的级联解码器模型进行操作；S4：输出图像变化区域，通过在现有的基于语义分割的变化检测级联解码器模型中加入基于自适应变化卷积核的级联检测头，就可以达到保证检测精度的同时有效处理变化区域的边界信息效果，而且新生成的优化的级联解码器模型体积变化不大，解决了目前的土地覆盖变化检测方法无法实现对变化区域边界处进行较好的处理的问题。
权利要求书clms
1.基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，包括以下步骤：S1：数据集准备；同一区域不同时期的土地覆盖变化检测数据集准备，并进行数据集增强；S2：将数据集输入编码器模型进行特征提取；在编码器模型编码过程中，通过预先训练好的语义分割模型基于ResNet50算法提取待预测影像的特征图；得到的特征图：；S3：将步骤S2提取的特征输入优化的级联解码器模型进行操作；输入步骤S2得到的一个特征图：其中，/＞表示/＞的维度，/＞表示特征图/＞的高度，/＞表示/＞的宽度，/＞表示/＞的通道数，/＞代表实数集；在级联解码器模型解码过程中，对编码器模型编码过程得到的特征图进行采样和卷积操作,以使特征图还原到待预测影像的分辨率,并利用多个级联检测头预测所述待预测影像中每个像元所属的语义类别；设定一个卷积矩阵，/＞中包含/＞个卷积核，/＞其中，/＞表示/＞的维度；并利用卷积矩阵对输入的特征图/＞进行卷积分割，输出为对应的/＞个类别；最终级联解码器模型得到输入的特征图相对应的分割输出结果：/＞其中，/＞表示/＞的维度；S4：输出图像变化区域。2.根据权利要求1所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，在步骤S3时中，建立优化的级联解码器模型的步骤为：基于现有的级联解码器模型中的单个解码器，加入自适应变化卷积核和级联检测头，即将现有的级联解码器模型中原本用于输入图像变化区域的检测头扩展成多个级联解码器，并对其过程中的卷积核进行自适应变化，即可建立优化的级联解码器模型。3.根据权利要求1或2所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，在步骤S3中，分割输出结果的实现公式为：。4.根据权利要求3所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，在步骤S3中输入的特征图中每类像素均对应着一个卷积核/＞，其中具体的卷积核/＞更新并输出/＞的步骤有三个：A：特征信息融合；B：实现卷积核自适应变化；C：信息交互并输出每一类别的分割结果，/＞是/＞的子集，其维度可表示为，其中/＞表示类别编号，取值范围是/＞。5.根据权利要求4所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，步骤A具体为：使用上一个检测头预测出来的结果与输入的特征图/＞进行逐点相乘得到融合后的特征图/＞，公式为：其中，表示输入的特征图/＞的高度，/＞表示输入的特征图/＞的宽度，/＞表示卷积核的个数，/＞是通道数的数量，/＞表示数值，范围为/＞，/＞表示数值，范围为/＞，/＞和用于实现/＞与输入的特征图/＞进行逐点相乘。6.根据权利要求4所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，步骤B具体为：将融合后的特征图作用于卷积核/＞上，输出当前自适应修改后的卷积核/＞。7.根据权利要求6所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，输出当前自适应修改后的卷积核具体步骤为：a：进行元素组相乘，公式为：其中，和/＞表示线性变化，/＞表示元素组乘积后的特征图；b：学习两个权重值，/＞，用于调整/＞和/＞的贡献，来更新卷积核/＞，公式为：其中，，/＞，/＞和/＞分别代表不同的全连接层。8.根据权利要求4所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法，其特征在于，步骤C具体为：C1：使用多头注意力机制实现卷积核之间的交互，即实现卷积核之间的有效特征信息共享，输入为当前更新的卷积核，输出为有效特征信息共享后的完整卷积核/＞，公式为：其中，表示多头注意力机制的实现过程;C2：使用完整卷积核来生成新的掩膜/＞，公式为：其中，是/＞的复合函数，/＞表示全连接操作，/＞表示层归一化操作，/＞表示激活函数。
说明书desc
技术领域本发明涉及计算视觉技术领域，特别是涉及基于自适应卷积核和级联检测头的土地覆盖变化检测方法。背景技术基于遥感影像下的土地覆盖变化检测任务在农业和土地资源管理方面扮演着至关重要的角色。它为农业规划、土地资源管理和粮食安全等领域提供了有价值的信息。通过土地覆盖变化检测，可以更好地管理土地资源，以及未经批准的土地利用变更现象，促进农业可持续发展，实现农村经济的繁荣。近年来，深度学习在遥感领域受到广泛关注。其可以有效地提取图像的深层特征，并且深层特征的泛化能力有利于检测变化区域。现有的土地覆盖变化检测方法集中在对图像特征提取进行深度研究，主要是基于像素级统计方法，使用独立像素作为检测单元可以逐像素分析像素光谱变化信息。目前的土地覆盖变化检测方法通常采用两种模型对变化区域边界进行处理，第一种是基于语义分割的变化检测模型，通常基于语义分割的模型是直接学习一系列的预定好类别的卷积核，然后使用这些卷积核进行像素分类，并设定了每个卷积核负责查找图像中相似类别的所有像素；第二种是基于实例分割的变化检测模型，与基于语义分割的变化检测模型不同，在基于实例分割的变化检测模型中图像的每类像素集对应的是一个对象，实例分割通常采用两阶段模型，先对图像中感兴趣的区域进行目标检测得到预测框，再对预测框中的变化区域进行识别定位。在基于语义分割的变化检测模型中，因为它只需要将图像中的每个像素分为不同的语义类别，所以模型的计算复杂度较低。但正是因为语义分割忽略了物体实例之间的个体信息，导致语义分割无法准确定位物体边界，只能给出每个像素属于哪个类别，进而无法定位降低了变化检测模型的识别精确度；在基于实例分割的变化检测模型中，虽然可以区分多个相同类别的物体实例进而相对语义分割的变化检测来说可以更好的标记出每个物体的边界，但是其计算复杂度更高同时需要多个模型组合完成也增大了模型参数体积，不利于后期的边缘部署实现。因此，不论是使用基于语义分割的变化检测模型，还是使用基于先目标检测再识别的实例分割变化检测模型，都无法实现对变化区域边界处进行较好的处理。在专利公开号CN116363526A中提到了构建基于孪生网络架构的MROCNet模型，该模型的每个主干网由四个长短型分支构成，并基于构建的数据集训练模型，通过语义计算对比实现地物类型变化检测；在专利公开号CN116091492A中构建了基于图像语义分割网络的图像变化检测模型，通过预训练的图像语义分割网络获取特征提取子网络，得到具有目标导向的特征图，能够显著消除非目标的影响；通过小波变换及其逆变换的引入使网络的上下采样信息损失减小；多种注意力机制的引入能够有效提升特征图融合性能；在专利公开号CN115731477A中提到了通过特征提取模型提取无人机图像的特征图像；再通过特征检测模型生成特征图像内的目标建筑物检测框；其次通过所述掩码生成模型按照目标建筑物检测框在所述特征图像上生成目标建筑物的掩码；最后基于实例分割网络输出的掩码获取无人机图像中的建筑物信息；在专利公开号CN112489096A中提到为了解决多个不同建筑物分割后区域相连的问题，采用基于实例分割方法的斑块提取，从而区分不同的斑块，得到不同时相的多个建筑物对应的区域；接下来根据斑块对应的位置信息和其他特征，进行基于图匹配模型的斑块匹配；最后根据匹配的信息，提取对应的变化信息，但是其仍然存在无法实现对变化区域边界处进行较好的处理的问题。发明内容基于此，针对上述问题，本发明提出了基于自适应卷积核和级联检测头的土地覆盖变化检测方法，解决了目前的土地覆盖变化检测方法无法实现对变化区域边界处进行较好的处理的问题。本发明的技术方案是：基于自适应卷积核和级联检测头的土地覆盖变化检测方法，包括以下步骤：S1：数据集准备；同一区域不同时期的土地覆盖变化检测数据集准备，并进行数据集增强；S2：将数据集输入编码器模型进行特征提取；在编码器模型编码过程中，通过预先训练好的语义分割模型基于ResNet50算法提取待预测影像的特征图；得到的特征图：；S3：将步骤S2提取的特征输入优化的级联解码器模型进行操作；输入步骤S2得到的一个特征图：其中，/＞表示/＞的维度，/＞表示特征图/＞的高度，/＞表示/＞的宽度，/＞表示/＞的通道数，/＞代表实数集；在级联解码器模型解码过程中，对编码器模型编码过程得到的特征图进行采样和卷积操作,以使特征图还原到待预测影像的分辨率,并利用多个级联检测头预测所述待预测影像中每个像元所属的语义类别；设定一个卷积矩阵，/＞中包含/＞个卷积核，/＞其中，/＞表示/＞的维度；并利用卷积矩阵对输入的特征图/＞进行卷积分割，输出为对应的/＞个类别；最终级联解码器模型得到输入的特征图相对应的分割输出结果：其中，/＞表示/＞的维度；S4：输出图像变化区域。优选的是，在步骤S3时中，建立优化的级联解码器模型的步骤为：基于现有的级联解码器模型中的单个解码器，加入自适应变化卷积核和级联检测头，即将现有的级联解码器模型中原本用于输入图像变化区域的检测头扩展成多个级联解码器，并对其过程中的卷积核进行自适应变化，即可建立优化的级联解码器模型。优选的是，在步骤S3中，分割输出结果的实现公式为：。优选的是，在步骤S3中输入的特征图中每类像素均对应着一个卷积核/＞，其中具体的卷积核/＞更新并输出/＞的步骤有三个：A：特征信息融合；B：实现卷积核自适应变化；C：信息交互并输出每一类别的分割结果，/＞是/＞的子集，其维度可表示为，其中/＞表示类别编号，取值范围是/＞。优选的是，步骤A具体为：使用上一个检测头预测出来的结果与输入的特征图进行逐点相乘得到融合后的特征图/＞，公式为：其中，表示输入的特征图/＞的高度，/＞表示输入的特征图/＞的宽度，/＞表示卷积核的个数，/＞是通道数的数量，/＞表示数值，范围为/＞，/＞表示数值，范围为/＞，和/＞用于实现/＞与输入的特征图/＞进行逐点相乘。优选的是，步骤B具体为：将融合后的特征图作用于卷积核/＞上，输出当前自适应修改后的卷积核/＞。优选的是，输出当前自适应修改后的卷积核具体步骤为：a：进行元素组相乘，公式为：其中，和/＞表示线性变化，/＞表示元素组乘积后的特征图；b：学习两个权重值，/＞，用于调整/＞和/＞的贡献，来更新卷积核/＞，公式为：其中，，/＞，/＞和/＞分别代表不同的全连接层。优选的是，步骤C具体为：C1：使用多头注意力机制实现卷积核之间的交互，即实现卷积核之间的有效特征信息共享，输入为当前更新的卷积核，输出为有效特征信息共享后的完整卷积核/＞，公式为：其中，表示多头注意力机制的实现过程;C2：使用完整卷积核来生成新的掩膜/＞，公式为：其中，是/＞的复合函数，/＞表示全连接操作，/＞表示层归一化操作，/＞表示激活函数。与现有技术相比，本发明的有益效果是：在使用时，本发明基于现有的级联解码器模型进行优化，加入自适应变化卷积核和级联检测头，即将现有的级联解码器模型中原本用于输入图像变化区域的检测头扩展成多个级联检测头，并对其过程中的卷积核进行自适应变化，产生优化的级联解码器模型，通过将数据集输入优化的级联解码器模型，最终输入一张精度更高，边缘处理更好的变化区域结果图，解决了目前的土地覆盖变化检测方法无法实现对变化区域边界处进行较好的处理的问题。附图说明图1是本发明实施例中所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法的流程图；图2是本发明实施例中所述的基于自适应卷积核和级联检测头的土地覆盖变化检测方法的整体框架图。具体实施方式下面结合附图对本发明的实施例进行详细说明。土地覆盖变化检测是一项具有较高实际落地应用的技术，因此在需要保证有较高的检测精度的同时进行边缘部署时需要考虑模型体积的大小，现有的技术中基于语义分割的变化检测模型对边界信息处理较差，基于实例分割的变化检测模型都会在目标检测基础上添加额外的神经网络模型，增大模型体积；而本发明只需要在基于语义分割的变化检测级联解码器模型中加入基于自适应变化卷积核的级联检测头，就可以保证检测精度的同时有效处理变化区域的边界信息，而且新生成的优化的级联解码器模型体积变化不大。实施例：如图1至图2所示，本实施例公开了基于自适应卷积核和级联检测头的土地覆盖变化检测方法，包括以下步骤：S1：数据集准备；同一区域不同时期的土地覆盖变化检测数据集准备，并进行数据集增强；S2：将数据集输入编码器模型进行特征提取；在编码器模型编码过程中，通过预先训练好的语义分割模型基于ResNet50算法提取待预测影像的特征图；得到的特征图：；S3：将步骤S2提取的特征输入优化的级联解码器模型进行操作；输入步骤S2得到的一个特征图：其中，/＞表示/＞的维度，/＞表示特征图/＞的高度，/＞表示/＞的宽度，/＞表示/＞的通道数，/＞代表实数集；在级联解码器模型解码过程中，对编码器模型编码过程得到的特征图进行采样和卷积操作,以使特征图还原到待预测影像的分辨率,并利用多个级联检测头预测所述待预测影像中每个像元所属的语义类别；设定一个卷积矩阵，/＞中包含/＞个卷积核，/＞其中，/＞表示/＞的维度；并利用卷积矩阵对输入的特征图/＞进行卷积分割，输出为对应的/＞个类别；最终级联解码器模型得到输入的特征图相对应的分割输出结果：其中，/＞表示/＞的维度；S4：输出图像变化区域。在使用时，本发明基于现有的级联解码器模型进行优化，加入自适应变化卷积核和级联检测头，即将现有的级联解码器模型中原本用于输入图像变化区域的检测头扩展成多个级联检测头，并对其过程中的卷积核进行自适应变化，产生优化的级联解码器模型，通过将数据集输入优化的级联解码器模型，最终输入一张精度更高，边缘处理更好的变化区域结果图，解决了目前的土地覆盖变化检测方法无法实现对变化区域边界处进行较好的处理的问题。优选的是，在步骤S3时中，建立优化的级联解码器模型的步骤为：基于现有的级联解码器模型中的单个解码器，加入自适应变化卷积核和级联检测头，即将现有的级联解码器模型中原本用于输入图像变化区域的检测头扩展成多个级联解码器，并对其过程中的卷积核进行自适应变化，即可建立优化的级联解码器模型。为了方便实现相对应的分割输出/＞，本实施例在上述实施例的基础上进行改进，与上述实施例的不同之处在于，在步骤S3中，分割输出结果/＞的实现公式为：。优选的是，在步骤S3中输入的特征图中每类像素均对应着一个卷积核/＞，其中具体的卷积核/＞更新并输出/＞的步骤有三个：A：特征信息融合；B：实现卷积核自适应变化；C：信息交互并输出每一类别的分割结果，/＞是/＞的子集，其维度可表示为，其中/＞表示类别编号，取值范围是/＞。优选的是，步骤A具体为：使用上一个检测头预测出来的结果与输入的特征图/＞进行逐点相乘得到融合后的特征图/＞，公式为：其中，表示输入的特征图/＞的高度，/＞表示输入的特征图/＞的宽度，/＞表示卷积核的个数，/＞是通道数的数量，/＞表示数值，范围为/＞，/＞表示数值，范围为/＞，和/＞用于实现/＞输入的特征图/＞进行逐点相乘。优选的是，步骤B具体为：将融合后的特征图作用于卷积核/＞上，输出当前自适应修改后的卷积核/＞。优选的是，输出当前自适应修改后的卷积核具体步骤为：a：进行元素组相乘，公式为：其中，和/＞表示线性变化，/＞表示元素组乘积后的特征图；b：学习两个权重值，/＞，用于调整/＞和/＞的贡献，来更新卷积核/＞，公式为：其中，，/＞，/＞和/＞分别代表不同的全连接层。优选的是，步骤C具体为：C1：使用多头注意力机制实现卷积核之间的交互，即实现卷积核之间的有效特征信息共享，输入为当前更新的卷积核，输出为有效特征信息共享后的完整卷积核/＞，公式为：其中，表示多头注意力机制的实现过程;C2：使用完整卷积核来生成新的掩膜/＞，公式为：其中，是/＞的复合函数，/＞表示全连接操作，/＞表示层归一化操作，/＞表示激活函数。为了保证模型体积变化不大，本实施例在上述实施例的基础上进行改进，与上述实施例的不同之处在于，优化的级联解码器模型中级联检测头包括解码器检测头1、Decoder检测头2和Decoder检测头3，每个检测头处均进行分类和分割操作。如图2所示，为了使生成的图像边缘处理更加精确，本实施例在上述实施例的基础上进行改进，与上述实施例的不同之处在于，在进行S3时，还需要进行图像损失计算步骤，公式为：其中，表示总损失，/＞为Decoder检测头1处分类/＞处的损失，为Decoder检测头1处分割/＞处的损失，/＞为Decoder检测头2处分类/＞处的损失，/＞为Decoder检测头2处分割/＞处的损失，/＞为Decoder检测头3处分类/＞处的损失，/＞为Decoder检测头3处分割/＞处的损失。本发明的关键点和保护点是：本发明方法中，基于现有的语义分割的变化检测级联解码器模型，对其进行优化，加入基于自适应变化卷积核的级联检测头，产生优化的级联解码器模型，在优化的级联解码器模型内进行一系列计算、分析和处理，不需要依赖额外附加的模型，就可以高效实现土地覆盖变化检测和有效处理边界信息。本发明原理：在使用时，本发明基于现有的级联解码器模型进行优化，加入自适应变化卷积核和级联检测头，即将现有的级联解码器模型中原本用于输入图像变化区域的检测头扩展成多个级联检测头，并对其过程中的卷积核进行自适应变化，产生优化的级联解码器模型，通过将数据集输入优化的级联解码器模型，最终输入一张精度更高，边缘处理更好的变化区域结果图。以上所述实施例仅表达了本发明的具体实施方式，其描述较为具体和详细，但并不能因此而理解为对本发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。
