标题title
一种数据库软件数据安全智能检测方法
摘要abst
本发明涉及数据监测技术领域，具体涉及一种数据库软件数据安全智能检测方法。该方法获得数据库操作日志中不同用户的每条操作语句的操作权值，根据操作权值时序上的分布情况获得分布段，根据每个操作权值在分布段的邻域分布和整体分布情况，得到操作权值的操作关联度；根据操作权值的操作关联度在在不同预设分析窗口中的偏差程度，更新局部加权回归算法中操作权值的拟合权重；基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型进行数据安全监测。本发明通过对历史操作数据量化并从局部和整体综合分析得到准确性更高的分析模型，使及时对数据库软件数据进行安全智能检测的准确性更高，检测过程更可靠。
权利要求书clms
1.一种数据库软件数据安全智能检测方法，其特征在于，所述方法包括：在数据库操作日志中获得不同用户的每条操作语句的操作权值；所述操作权值为时序数据；根据每个用户的操作权值在时序上的分布情况，获得时序上操作权值的分布段；根据每个分布段中每个操作权值的邻域数据变化分布情况，以及每个操作权值在所在分布段中的整体分布情况，得到每个分布段中每个操作权值的操作关联度；根据时序上每个操作权值的操作关联度在不同预设分析窗口中的偏差程度，更新局部加权回归算法中每个操作权值的拟合权重；基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型；根据权值分析模型进行数据安全监测。2.根据权利要求1所述一种数据库软件数据安全智能检测方法，其特征在于，所述在数据库操作日志中获得不同用户的每条操作语句的操作权值，包括：数据库操作日志中的每条操作语句包含的数据信息为：操作类型、操作对象和数据重要度等级；操作类型、操作对象和数据重要度等级中不同的数据具有不同的预设权重值；将每条操作语句中操作类型、操作对象和数据重要度等级分别对应数据的预设权重值组成三元组，获得每条操作语句的操作权值。3.根据权利要求2所述一种数据库软件数据安全智能检测方法，其特征在于，所述操作关联度的获取方法包括：依次将每个分布段作为参考段，将参考段中的每个操作权值映射到多维空间中并进行曲线拟合，获得参考段的权值曲线；对于权值曲线中任意一个操作权值，在该操作权值的预设邻域范围内，根据该操作权值与每个其他操作权值的分布位置，得到该操作权值与每个其他操作权值的相似度；计算该操作权值与预设邻域范围内每个其他操作权值的相似度的平均值，获得该操作权值的邻域相关度；在参考段中，将该操作权值前所有操作权值对应邻域相关度的平均值，作为该操作权值的前显著均值；将该操作权值后所有操作权值对应邻域相关度的平均值，作为该操作权值的后显著均值；将该操作权值的前显著均值与后显著均值的平均值，作为该操作权值的显著趋势值；将该操作权值的邻域相关度与显著趋势值的差异，作为该操作权值的显著偏差指标；将该操作权值的前显著均值与后显著均值的差异，作为该操作权值的显著差异；将该操作权值的显著差异与参考段中操作权值的总数量的比值，作为该操作权值的显著程度指标；将该操作权值的显著偏差指标与显著程度指标的乘积进行负相关映射并归一化处理，获得该操作权值的操作关联度。4.根据权利要求3所述一种数据库软件数据安全智能检测方法，其特征在于，所述相似度的获取方法包括：在参考段的权值曲线上，将原点与该操作权值组成的向量，作为该操作权值的分布向量；计算该操作权值与预设邻域范围内每个其他操作权值的分布向量之间的余弦相似度，获得该操作权值与每个其他操作权值的相似度。5.根据权利要求1所述一种数据库软件数据安全智能检测方法，其特征在于，所述根据时序上每个操作权值的操作关联度在不同预设分析窗口中的偏差程度，更新局部加权回归算法中每个操作权值的拟合权重，包括：获取两个以上的预设分析窗口，将所有预设分析窗口根据边长从小到大的顺序进行排列，获得窗口序列；依次将窗口序列中每个预设分析窗口作为待分析窗口；对于数据库操作日志中任意一个操作权值，计算该操作权值对应待分析窗口中所有操作权值的操作关联度的平均值，获得该操作权值在对应待分析窗口中的关联稳定度；将该操作权值的操作关联度与关联稳定度的差异，作为该操作权值在对应待分析窗口中的关联偏差值；在该操作权值对应的窗口序列中，计算该操作权值在每相邻两个预设分析窗口之间的关联偏差值的差异，获得该操作权值的偏差差异；计算该操作权值的所有偏差差异的平均值进行负相关映射并归一化处理，获得该操作权值的变化相似度；将所有操作权值的变化相似度的平均值，作为相似指标；将该操作权值的变化相似度与相似指标的比值，作为该操作权值的调整权重；将局部加权回归算法中每个操作权值的拟合权重与对应的调整权重相乘，获得每个操作权值更新后的拟合权重。6.根据权利要求1所述一种数据库软件数据安全智能检测方法，其特征在于，所述基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型，包括：基于更新后的局部加权回归算法对数据库操作日志中操作权值的序列进行STL分解后，获得趋势项和季节项；采用长短期记忆神经网络模型，将数据库操作日志中操作权值的序列、趋势项和季节项作为训练集进行模型训练，根据损失函数对长短期记忆神经网络模型进行调整评估，得到权值分析模型。7.根据权利要求3所述一种数据库软件数据安全智能检测方法，其特征在于，所述根据权值分析模型进行数据安全监测，包括：根据权值分析模型获得当前操作语句的预测操作权值；根据预测操作权值与当前操作权值之间的分布差异，获得预测偏差值；当预测偏差值小于或等于预设偏差阈值时，不需要预警观察；当预测偏差值大于预设偏差阈值时，若当前操作权值对应用户与前一操作权值对应用户不相同，则不进行预警观察；若当前操作权值对应用户与前一操作权值对应用户相同时，则进行预警并对操作语句进行异常检测。8.根据权利要求7所述一种数据库软件数据安全智能检测方法，其特征在于，所述根据预测操作权值与当前操作权值之间的分布差异，获得预测偏差值，包括：计算预测操作权值与当前操作权值在多维空间中的欧式距离，并进行归一化处理作为预测偏差值。9.根据权利要求1所述一种数据库软件数据安全智能检测方法，其特征在于，所述分布段的获取方法包括：在时序上将所有操作权值划分为不同的分布段；相邻分布段之间操作权值对应的用户不同，单个分布段中操作权重对应的用户相同。10.根据权利要求3所述一种数据库软件数据安全智能检测方法，其特征在于，所述将参考段中的每个操作权值映射到多维空间中并进行曲线拟合，获得参考段的权值曲线，包括：将操作权值的时序信息作为时间轴，将操作权值中对应的操作类型、操作对象和数据重要度等级的预设权重值作为其余数据轴，获得多维空间；参考段中每个操作权值在多维空间中均映射对应一个坐标点，根据操作权值对应坐标点的位置进行曲线拟合，获得参考段的权值曲线。
说明书desc
技术领域本发明涉及数据监测技术领域，具体涉及一种数据库软件数据安全智能检测方法。背景技术数据库软件数据安全检测是保护数据库中数据安全的重要手段，其通常通过分析数据库操作日志中的SQL语句进行异常行为的检测，如检测到频繁访问敏感数据的操作、非授权用户的登录尝试或异常的数据修改等，这些攻击行为将会造成数据库服务器的过载与信息泄露，对系统安全和个人隐私产生严重的威胁，因此加强数据库安全检测和及时应对安全威胁是非常重要的。在通常对用户操作行为进行检测时，往往基于数据库造作日志中SQL语句的局部异常操作行为情况进行监测，而像SQL注入等攻击手段较为隐蔽，它利用不正确的输入验证或不正确的使用数据查询语言的方式，将恶意的SQL代码注入到应用程序的数据库查询中，而常用的如添加预处理来预防SQL注入攻击的方法，不仅增加了代码维护负担也并不能完全阻止黑客寻找新的漏洞绕过验证进行攻击，同时由于被插入的恶意SQL代码可以是任何SQL操作语句，仅采用局部操作行为的异常分析，不能更准确的将隐蔽性较强的注入攻击行为检测出来，使及时对数据库软件数据进行安全智能检测的准确性较低，检测过程可靠性不强。发明内容为了解决现有技术中使及时对数据库软件数据进行安全智能检测的准确性较低，检测过程可靠性不强的技术问题，本发明的目的在于提供一种数据库软件数据安全智能检测方法，所采用的技术方案具体如下：本发明提供了一种数据库软件数据安全智能检测方法，所述方法包括：在数据库操作日志中获得不同用户的每条操作语句的操作权值；所述操作权值为时序数据；根据每个用户的操作权值在时序上的分布情况，获得时序上操作权值的分布段；根据每个分布段中每个操作权值的邻域数据变化分布情况，以及每个操作权值在所在分布段中的整体分布情况，得到每个分布段中每个操作权值的操作关联度；根据时序上每个操作权值的操作关联度在不同预设分析窗口中的偏差程度，更新局部加权回归算法中每个操作权值的拟合权重；基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型；根据权值分析模型进行数据安全监测。进一步地，所述在数据库操作日志中获得不同用户的每条操作语句的操作权值，包括：数据库操作日志中的每条操作语句包含的数据信息为：操作类型、操作对象和数据重要度等级；操作类型、操作对象和数据重要度等级中不同的数据具有不同的预设权重值；将每条操作语句中操作类型、操作对象和数据重要度等级分别对应数据的预设权重值组成三元组，获得每条操作语句的操作权值。进一步地，所述操作关联度的获取方法包括：依次将每个分布段作为参考段，将参考段中的每个操作权值映射到多维空间中并进行曲线拟合，获得参考段的权值曲线；对于权值曲线中任意一个操作权值，在该操作权值的预设邻域范围内，根据该操作权值与每个其他操作权值的分布位置，得到该操作权值与每个其他操作权值的相似度；计算该操作权值与预设邻域范围内每个其他操作权值的相似度的平均值，获得该操作权值的邻域相关度；在参考段中，将该操作权值前所有操作权值对应邻域相关度的平均值，作为该操作权值的前显著均值；将该操作权值后所有操作权值对应邻域相关度的平均值，作为该操作权值的后显著均值；将该操作权值的前显著均值与后显著均值的平均值，作为该操作权值的显著趋势值；将该操作权值的邻域相关度与显著趋势值的差异，作为该操作权值的显著偏差指标；将该操作权值的前显著均值与后显著均值的差异，作为该操作权值的显著差异；将该操作权值的显著差异与参考段中操作权值的总数量的比值，作为该操作权值的显著程度指标；将该操作权值的显著偏差指标与显著程度指标的乘积进行负相关映射并归一化处理，获得该操作权值的操作关联度。进一步地，所述相似度的获取方法包括：在参考段的权值曲线上，将原点与该操作权值组成的向量，作为该操作权值的分布向量；计算该操作权值与预设邻域范围内每个其他操作权值的分布向量之间的余弦相似度，获得该操作权值与每个其他操作权值的相似度。进一步地，所述根据时序上每个操作权值的操作关联度在不同预设分析窗口中的偏差程度，更新局部加权回归算法中每个操作权值的拟合权重，包括：获取两个以上的预设分析窗口，将所有预设分析窗口根据边长从小到大的顺序进行排列，获得窗口序列；依次将窗口序列中每个预设分析窗口作为待分析窗口；对于数据库操作日志中任意一个操作权值，计算该操作权值对应待分析窗口中所有操作权值的操作关联度的平均值，获得该操作权值在对应待分析窗口中的关联稳定度；将该操作权值的操作关联度与关联稳定度的差异，作为该操作权值在对应待分析窗口中的关联偏差值；在该操作权值对应的窗口序列中，计算该操作权值在每相邻两个预设分析窗口之间的关联偏差值的差异，获得该操作权值的偏差差异；计算该操作权值的所有偏差差异的平均值进行负相关映射并归一化处理，获得该操作权值的变化相似度；将所有操作权值的变化相似度的平均值，作为相似指标；将该操作权值的变化相似度与相似指标的比值，作为该操作权值的调整权重；将局部加权回归算法中每个操作权值的拟合权重与对应的调整权重相乘，获得每个操作权值更新后的拟合权重。进一步地，所述基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型，包括：基于更新后的局部加权回归算法对数据库操作日志中操作权值的序列进行STL分解后，获得趋势项和季节项；采用长短期记忆神经网络模型，将数据库操作日志中操作权值的序列、趋势项和季节项作为训练集进行模型训练，根据损失函数对长短期记忆神经网络模型进行调整评估，得到权值分析模型。进一步地，所述根据权值分析模型进行数据安全监测，包括：根据权值分析模型获得当前操作语句的预测操作权值；根据预测操作权值与当前操作权值之间的分布差异，获得预测偏差值；当预测偏差值小于或等于预设偏差阈值时，不需要预警观察；当预测偏差值大于预设偏差阈值时，若当前操作权值对应用户与前一操作权值对应用户不相同，则不进行预警观察；若当前操作权值对应用户与前一操作权值对应用户相同时，则进行预警并对操作语句进行异常检测。进一步地，所述根据预测操作权值与当前操作权值之间的分布差异，获得预测偏差值，包括：计算预测操作权值与当前操作权值在多维空间中的欧式距离，并进行归一化处理作为预测偏差值。进一步地，所述分布段的获取方法包括：在时序上将所有操作权值划分为不同的分布段；相邻分布段之间操作权值对应的用户不同，单个分布段中操作权重对应的用户相同。进一步地，所述将参考段中的每个操作权值映射到多维空间中并进行曲线拟合，获得参考段的权值曲线，包括：将操作权值的时序信息作为时间轴，将操作权值中对应的操作类型、操作对象和数据重要度等级的预设权重值作为其余数据轴，获得多维空间；参考段中每个操作权值在多维空间中均映射对应一个坐标点，根据操作权值对应坐标点的位置进行曲线拟合，获得参考段的权值曲线。本发明具有如下有益效果：本发明通过操作行为的转变主要基于操作语句中不同的信息变化，得到数据库操作日志中不同用户的每条操作语句的操作权值，进行操作行为的量化分析，提高分析结果的精确性。由于异常操作行为的分析是基于与正常操作行为之间的差异进行的，因此需要首先对数据库操作日志中的历史操作权值进行分析，而此时的历史数据中并不是每个操作权值均为可信的正常数据，存在异常数据需要降低其影响程度，对每个单次连续操作进行分析，获得时序上操作权值的分布段，每个分布段代表单次连续操作的操作权值分布情况，具体分析分布段中的异常性，才能准确减小异常数据的影响，进而根据每个操作权值在分布段的邻域分布和整体分布情况，得到每个操作权值的操作关联度，从局部分布的差异性初步分析数据的相关程度，进而根据操作权值的操作关联度在在不同预设分析窗口中的偏差程度，从整体的范围变化情况，进一步减小由于操作本身带来变化使得判断为异常的可能性，更新局部加权回归算法中操作权值的拟合权重，使得拟合过程更充分的考虑正常数据的趋势。最后基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型，可以对实时的操作重要性的变化情况进行准确分析预测，进而进行数据安全监测。本发明通过对历史数据中操作行为对应操作语句进行量化，并从局部和整体综合去噪，得到对正常操作分析更准确的权值分析模型，使及时对数据库软件数据进行安全智能检测的准确性更高，检测过程更可靠。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明一个实施例所提供的一种数据库软件数据安全智能检测方法流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种数据库软件数据安全智能检测方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种数据库软件数据安全智能检测方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种数据库软件数据安全智能检测方法流程图，该方法包括以下步骤：S1：在数据库操作日志中获得不同用户的每条操作语句的操作权值；操作权值为时序数据。在数据库操作日志中存储着数据库执行各种操作的具体SQL语句，每条具体的SQL语句代表一条操作语句，由于SQL注入通常隐藏在不同操作语句中，因此基于每条操作语句的执行特征进行对操作重要性的表征，例如在用户查询某项信息时，注入联合查询语句，使用户在查询某样商品信息时，注入的查询语句查询了用户的名称和密码，并返回结果，而对商品信息的查询与用户名密码的查询，其针对的数据的重要性是不同的，通过这种不正常的异常变化能够找到存在的注入情况，但为了能够对这种变化进行检测，需要通过历史数据中正常查询操作过程的语句变化来进行对比判断，因此首先在数据库操作日志中获得不同用户的每条操作语句的操作权值。在本发明实施例中，数据库操作日志中的每条操作语句包含的数据信息为：操作类型、操作对象和数据重要度等级，其中操作类型为操作的目的，例如登录、查询、更新、修改或删除等，操作对象为操作主要针对的对消，例如对数据表中单条记录操作、对单数据表操作、对多表联合操作或对数据库操作等，数据重要度等级反映数据的敏感程度或者保密程度，例如登录信息数据重要度等级为5、个人信息数据重要度等级为4、普通文本数据重要度等级为1等，这些重要度对应不同的保密程度，越敏感的数据具有越高的重要度等级，在处理时也需要更多的注意。操作类型、操作对象和数据重要度等级中不同的数据具有不同的预设权重值，举例而言，操作类型中查询操作对应预设权重值设置为2，删除操作的预设权重值设置为4，登录操作的预设权重值设置为8等等，操作对象中对单条记录操作的预设权重值设置为2，对单数据表操作的预设权重设置为7，对数据库操作的预设权重值设置为10等等，数据重要度等级中数据重要度等级为1的数据的预设权重设置为1，数据重要度等级为5的数据的预设权重值设置为10等等，更多数据预设权重值的设置不再赘述，具体数值实施者可根据具体实施情况自行调整，仅需表征出三个数据信息中每种数据对应不同的权重即可，在此不做限制。进一步地，将每条操作语句中操作类型、操作对象和数据重要度等级分别对应数据的预设权重值组成三元组，获得每条操作语句的操作权值，举例而言，用户对商品表单中的某种商品进行查询时，单条查询语句中操作类型对应的查询操作的预设权重值为2，操作对象对应的对单商品表单操作的预设权重值为7，数据重要度等级为对重要度等级为1的商品信息，其预设权重值为1，则此单条查询语句对应的操作权值为。由于数据库操作日志中操作语句是基于时序顺序进行存储记录的，因此每个操作语句存在对应的时序信息，故对应的操作权值为时序数据。S2：根据每个用户的操作权值在时序上的分布情况，获得时序上操作权值的分布段；根据每个分布段中每个操作权值的邻域数据变化分布情况，以及每个操作权值在所在分布段中的整体分布情况，得到每个分布段中每个操作权值的操作关联度。在数据库操作日志中，每个用户的单个操作会在日志中呈现出连续分布的几条操作语句，例如在用户的登录操作中，首先通过用户名查询数据库用户记录，验证是否存在，其次将输入的密码与数据库存储中的密码进行匹配，若匹配正确后允许用户进入系统，最后记录登录信息，将登录记录更新入数据库中，可以看出用户的登录操作是对应多个操作语句的。因此为了保证记录的完整性，在总数据库操作日志中，每个用户单次操作对应的操作语句将是连续出现的，而由于多用户的存在，不同用户的操作行为可能在整体的数据库操作日志中存在交叉记录的情况。由于SQL注入时需要结合用户单次操作的操作语句，因此异常操作行为相较于正常操作行为在操作权值上会出现突变的情况，例如在一个用户进行登录时，注入SQL语句修改用户信息，操作权值会基于正常登录操作出现一个异常的变化情况，因此基于异常变化可对用户进行监测。故需要对数据库操作日志中历史的操作过程进行分析，为了能够对历史的数据库操作日志中正常操作的操作权值变化情况进行准确的分析，需要减小历史数据中可能记录到的噪声等异常变化数据的影响。为了后续能够针对每次的单次操作行为进行准确分析，首先根据每个用户的操作权值在时序上的分布情况，获得时序上操作权值的分布段，优选地，在时序上将所有操作权值划分为不同的分布段，相邻分布段之间操作权值对应的用户不同，单个分布段中操作权重对应的用户相同。通过用户对应操作权值连续分布情况得到表征每个用户连续操作情况的分布段，进而对单次连续操作中每个操作语句具体分析。在每个分布段中反映了每个用户在时序上的一次连续操作情况，由于连续的操作在操作权值变化上不会出现较为突出的变化，例如用户在对商品信息进行查询浏览时，查询语句在关联调用时多条操作语句也仅基于商品数据和商品表单，其变化是较小的且具有趋势性的，因此基于分布段分析每个操作权值在对应操作过程中的相关程度，也即根据每个分布段中每个操作权值的邻域数据变化分布情况，以及每个操作权值在所在分布段中的整体分布情况，得到每个分布段中每个操作权值的操作关联度。优选地，依次将每个分布段作为参考段，将参考段中的每个操作权值映射到多维空间中并进行曲线拟合，获得参考段的权值曲线。在本发明实施例中，将操作权值的时序信息作为时间轴，将操作权值中对应的操作类型、操作对象和数据重要度等级的预设权重值作为其余数据轴，获得多维空间，由于操作权值具有时序信息，因此参考段中每个操作权值在多维空间中均映射对应一个坐标点，进而根据操作权值对应坐标点的位置进行曲线拟合，获得参考段的权值曲线，反映参考段中整体操作权值的分布。需要说明的是，多维空间的构建和曲线拟合为本领域技术人员熟知的技术手段，如选用多项式拟合方式等拟合，在此不做赘述。进一步地，对于权值曲线中任意一个操作权值，在该操作权值的预设邻域范围内，根据该操作权值与每个其他操作权值的分布位置，得到该操作权值与每个其他操作权值的相似度，在本发明实施例中，预设邻域范围为操作权值为中心的边长为2大小的范围，具体的数值实施者可根据具体实施场景进行调整，在此不做限制。进而通过分布位置之间的差异性，反映两个操作权值之间的相关程度，在本发明一个实施例中，在参考段的权值曲线上，将原点与该操作权值组成的向量，作为该操作权值的分布向量，计算该操作权值与预设邻域范围内每个其他操作权值的分布向量之间的余弦相似度，获得该操作权值与每个其他操作权值的相似度，当余弦相似度越大，说明操作权值之间的相关度是越大的，故相似度大。进一步地，计算该操作权值与预设邻域范围内每个其他操作权值的相似度的平均值，获得该操作权值的邻域相关度，通过邻域相关度反映该操作权值与局部操作权值之间整体分布相关程度，在本发明实施例中，邻域相关度的表达式为：式中，表示为第/＞个操作权值的邻域相关度，/＞表示为第/＞个操作权值的分布向量，/＞表示为第/＞个操作权值的预设邻域范围内其他操作权值的总数量，/＞表示为第/＞个操作权值的预设邻域范围内第/＞个其他操作权值的分布向量，/＞表示为余弦相似度函数。其中，表示为第/＞个操作权值与预设邻域范围内第/＞个其他操作权值的相似度，当相似度越大，则邻域相关度越大，说明操作权值在邻域分布上相关性是较强的，在邻域上的整体的分布一致性较强的，故邻域相关度越大。在参考段中，将该操作权值前所有操作权值对应邻域相关度的平均值，作为该操作权值的前显著均值，将该操作权值后所有操作权值对应邻域相关度的平均值，作为该操作权值的后显著均值，通过参考段中操作权值前后整体邻域相关度的情况，反映在该操作权值位置处的参考段的整体相关度分布差异情况。进一步地，将该操作权值的前显著均值与后显著均值的平均值，作为该操作权值的显著趋势值，反映除该操作权值外，在此连续操作上整体操作权值的邻域相关度的整体趋势。将该操作权值的邻域相关度与显著趋势值的差异，作为该操作权值的显著偏差指标，当该操作权值与整体趋势越接近，也即显著偏差指标越小，则说明该操作权值的异常性较低。进一步地，将前显著均值与后显著均值的差异，作为该操作权值的显著差异，通过前后整体相关度的差异反映整体变化程度。将该操作权值的显著差异与参考段中操作权值的总数量的比值，作为该操作权值的显著程度指标，当显著差异越小，参考段中操作权值数量越多，说明操作整体相关度越小，且前后变化差异表证的可信度越高，也即显著程度越小，则该操作权值的异常性较低。将该操作权值的显著偏差指标与显著程度指标的乘积进行负相关映射并归一化处理，获得该操作权值的操作关联度，操作关联度反映该操作权值在参考段分布上的相关程度，在本发明实施例中，操作关联度的表达式为：式中，表示为第/＞个操作权值的操作关联度，/＞表示为第/＞个操作权值的邻域相关度，/＞表示为第/＞个操作权值的前显著均值，/＞表示为第/＞个操作权值的后显著均值，表示为第/＞个操作权值所在分布段中操作权值的总数量，/＞表示为以自然常数为底的指数函数。其中，表示为第/＞个操作权值的显著趋势值，/＞表示为第/＞个操作权值的显著偏差指标，/＞表示为第/＞个操作权值的显著差异，/＞表示为第个操作权值的显著程度指标。当显著偏差指标越小，显著程度指标越小，说明该操作权值对应的异常性越低，也即该操作权值的正常性越高，因此通过负相关映射后的操作关联度越大。至此，完成对每个操作权值在分布上的异常性的分析。S3：根据时序上每个操作权值的操作关联度在不同预设分析窗口中的偏差程度，更新局部加权回归算法中每个操作权值的拟合权重。由于操作权值反映为操作行为在操作重要性上的数值表现，因此对于单次连续操作而言，其操作权值是在一定范围内变化的，虽然在日志记录时会存在不同用户的交叉记录，但是由于操作行为是具有重复性的，例如登录、查看、修改等操作的操作语句执行是重复性的，因此操作权值的变化也均为在一定范围内变化，因此可通过分析历史的数据库操作日志中操作权值的整体变化情况，在时序上的操作权值的变化进行分析，进而对后续操作行为的操作权值变化进行监测。使用STL分解法对数据库操作日志中的操作权值进行分解，STL分解法是一种可以把时间序列分解为趋势项、季节项和残差项的方法，STL分解法包含一系列局部加权回归平滑器，计算速度比较快，可以应对非常大的时间序列数据。局部加权回归是对数据进行拟合平滑的算法，因为局部加权回归算法中每个数据点进行拟合的拟合权重是基于相邻数据点获取的，因此误差点等异常点对局部加权回归算法的干扰性极大，为了能够对正常操作的操作权值的后续分析，需要调整拟合过程中的拟合权重。通过分开操作行为分析每个操作权值在关联性上的异常后，在数据库操作日志的整个时序上通过操作权值的操作关联度的变化情况，能够找到关联情况较为不一致的操作情况，减小其异常的操作记录对整体正常操作记录的影响，也即根据时序上每个操作权值的操作关联度在不同预设分析窗口中的偏差程度，更新局部加权回归算法中每个操作权值的拟合权重。优选地，获取两个以上的预设分析窗口，将所有预设分析窗口根据边长从小到大的顺序进行排列，获得窗口序列。由于操作关联度反映每个操作权值对应可能正常的程度，若每个操作权值对应操作关联度小但局部范围较为一致时，也说明其操作可能本身存在重要性的变化，也应该为正常情况，因此需要对每个操作权值在范围内的操作关联度的一致性进行分析，而范围的大小将影响对一致性的判断，因此取多个范围窗口进行分析，在本发明实施例中，根据操作权值的数量进行选取，将操作权值总数量的百分之二十的数据对应的长度作为预设分析窗口的最大边长，将操作权值总数量的百分之五的数据对应的长度作为预设分析窗口的最小边长，在预设分析窗口的边长范围内，每变化操作权值总数量的百分之一的数据对应的长度获取一个预设分析窗口，具体预设窗口的选取范围实施者可根据具体实施情况进行调整，在此不做限制。进而依次将窗口序列中每个预设分析窗口作为待分析窗口，对于数据库操作日志中任意一个操作权值，计算该操作权值对应待分析窗口中所有操作权值的操作关联度的平均值，获得该操作权值在对应待分析窗口中的关联稳定度，关联稳定度反映窗口内操作关联度的平均程度。将该操作权值的操作关联度与关联稳定度的差异，作为该操作权值在对应待分析窗口中的关联偏差值，当关联偏差值越大，说明该操作权值偏离平均趋势的程度较大。当该操作权值可能为异常情况时，其在局部可能表现较为明显，但是在范围更广的变化上将表现的明显情况减弱。进一步地，在该操作权值对应的窗口序列中，计算该操作权值在每相邻两个预设分析窗口之间的关联偏差值的差异，获得该操作权值的偏差差异，通过该操作权值在大小接近的两个预设分析窗口之间的偏差值的相似程度，反映该偏离情况的正常程度，若该操作权值为异常情况，在不同范围内其偏离程度将会发生变化，若该操作权值为正常情况，在不同范围内的偏离程度将不会发生变化。计算该操作权值的所有偏差差异的平均值进行负相关映射并归一化处理，获得该操作权值的变化相似度，变化相似度反映操作关联度在局部范围的变化相似程度，在本发明实施例中，变化相似度的表达式：式中，表示为第/＞个操作权值的变化相似度，/＞表示为窗口序列中预设分析窗口的总数量，/＞表示为第/＞个操作权值的操作关联度，/＞表示为第/＞个操作权值对应第/＞个预设分析窗口中操作权值的总数量，/＞表示为第/＞个操作权值对应第/＞个预设分析窗口中第/＞个操作权值的操作关联度，/＞表示为第/＞个操作权值对应第/＞个预设分析窗口中操作权值的总数量，/＞表示为以自然常数为底的指数函数。其中，表示为第/＞个操作权值对应第/＞个预设分析窗口的关联稳定度，/＞表示为第/＞个操作权值在对应第/＞个预设分析窗口中的关联偏差值，表示为第/＞个操作权值对应第/＞个预设分析窗口中的关联稳定度，表示为第/＞个操作权值对应第/＞个预设分析窗口中的关联偏差值，/＞表示为第/＞个操作权值对应的偏差差异。当变化相似度越大，说明该操作权值在范围内的关联度的变化程度均是较为相似的，该操作权值反映的操作语句的重要性越为正常数据，可以在拟合中给予更大权重，使拟合分析更针对正常数据进行分析。将所有操作权值的变化相似度的平均值，作为相似指标，将该操作权值的变化相似度与相似指标的比值，作为该操作权值的调整权重，通过整体变化相似情况得到需要调整的比重，通过相似指标反映整体变化程度，当整体变化程度越小，说明异常性的数据较多，相对正常数据的比重越大，提高对正常数据拟合的准确性。进而将局部加权回归算法中每个操作权值的拟合权重与对应的调整权重相乘，获得每个操作权值更新后的拟合权重，需要说明的是，局部加权回归算法中每个操作权值的拟合权重的计算为本领域技术人员熟知的公知技术手段，在此仅通过调整权重进一步调整原算法中的权重，因此对公知的拟合权重的计算不做具体赘述。至此，通过局部异常分析和整体异常影响分析，调整了对每个操作权值的拟合权重，以便于后续能够对正常数据进行更准确的分析。S4：基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型；根据权值分析模型进行数据安全监测。通过操作权值量化了不同操作行为，通过操作重要性的变化趋势能够分析后续操作的重要性变化正常情况，因此基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型，在本发明实施例中，基于更新后的局部加权回归算法对数据库操作日志中操作权值的序列进行STL分解后，获得趋势项和季节项，通过趋势项和季节项反映正常操作的操作权值在变化上的波动情况，进而采用长短期记忆神经网络模型，将数据库操作日志中操作权值的序列、趋势项和季节项作为训练集进行模型训练，根据损失函数对长短期记忆神经网络模型进行调整评估，得到权值分析模型。需要说明的是，对于模型的选择还可以采用循环神经模型或线性回归等，损失函数可采用均方误差等，在此不做限制，此外基于趋势项和季节项反映操作权值的变化特征，用于指导帮助模型理解数据的时序特征和模式，能够使得到的权值分析模型更准确的得到预测结果，由于STL分解和神经网络模型的构建训练均为本领域技术人员熟知的技术手段，在此不做具体赘述。通过权值分析模型可以在监测过程中，对后续操作权值进行预测，当预测权值与实际偏差存在差异时，需要具体分析进行预警和处理，因此根据权值分析模型进行数据安全监测，优选地，根据权值分析模型获得当前操作语句的预测操作权值，根据预测操作权值与当前操作权值之间的分布差异，获得预测偏差值，由于操作权值为三个预设权重值构成的三元组，因此其差异通过在多维空间中的距离进行计算，在本发明一个实施例中，计算预测操作权值与当前操作权值在多维空间中的欧式距离，并进行归一化处理作为预测偏差值。需要说明的是欧式距离为本领域技术人员熟知的技术手段，在此不做赘述。考虑到SQL注入攻击隐藏在用户操作行为的操作语句中，因此通过操作重要性的不正常转变进行异常预警，当预测偏差值小于或等于预设偏差阈值时，说明预测操作权值波动在正常范围内，不需要预警观察，在本发明实施例中，预设偏差阈值设置为0.6，具体数值实施者可根据具体实时情况进行调整。当预测偏差值大于预设偏差阈值时，说明在正常操作重要性的波动过程中，操作行为中出现了操作重要性的较大转变，由于用户操作行为存在不同用户交叉记录的特性，其转变可能由于不同用户之间产生，也可能为同一用户操作产生异常，因此需要进一步对操作权值用户进行分析。若当前操作权值对应用户与前一操作权值对应用户不相同，说明此操作为用户操作行为转变产生，则不进行预警，若当前操作权值对应用户与前一操作权值对应用户相同时，说明该用户的操作行为与历史正常操作行为产生了较大偏移，则进行预警对操作语句异常检测。在本发明实施例中，对预警后的操作语句进行异常操作语句的判断，当出现攻击性的语句时，进行数据表锁定等操作进行数据库数据的保护。综上，本发明通过操作行为的转变主要基于操作语句中不同的信息变化，得到数据库操作日志中不同用户的每条操作语句的操作权值，进行操作行为的量化分析，提高分析结果的精确性。由于异常操作行为的分析是基于与正常操作行为之间的差异进行的，因此需要首先对数据库操作日志中的历史操作权值进行分析，而此时的历史数据中并不是每个操作权值均为可信的正常数据，存在异常数据需要降低其影响程度，对每个单次连续操作进行分析，获得时序上操作权值的分布段，每个分布段代表单次连续操作的操作权值分布情况，具体分析分布段中的异常性，才能准确减小异常数据的影响，进而根据每个操作权值在分布段的邻域分布和整体分布情况，得到每个操作权值的操作关联度，从局部分布的差异性初步分析数据的相关程度，进而根据操作权值的操作关联度在在不同预设分析窗口中的偏差程度，从整体的范围变化情况，进一步减小由于操作本身带来变化使得判断为异常的可能性，更新局部加权回归算法中操作权值的拟合权重，使得拟合过程更充分的考虑正常数据的趋势。最后基于更新后的局部加权回归算法对时序上所有操作权值进行STL分解，获得权值分析模型，可以对实时的操作重要性的变化情况进行准确分析预测，进而进行数据安全监测。本发明通过对历史数据中操作行为对应操作语句进行量化，并从局部和整体综合去噪，得到对正常操作分析更准确的权值分析模型，使及时对数据库软件数据进行安全智能检测的准确性更高，检测过程更可靠。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。
