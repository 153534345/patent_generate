标题title
一种基于二维滤波MapDrift的SAR等效雷达速度估计方法
摘要abst
本申请涉及一种基于二维滤波MapDrift的SAR等效雷达速度估计方法。该方法包括：对SAR原始数据进行距离聚焦成像；先利用一个初始等效雷达速度进行粗略聚焦成像；接着加窗截取SAR复图像的其中一块区域，并对该区域的数据进行逆成像还原为未聚焦的SAR原始数据；后构建子视图像偏移函数；接着利用黄金分割搜索法估计二维MapDrift的迭代系数；然后利用迭代系数和子视图像偏移函数进行速度迭代，得到等效雷达速度估计值；最后用上一步得到的等效雷达速度估计值替换初始的速度，重新执行成像、加窗截取、逆成像和速度迭代等步骤，直至达到迭代次数阈值。无需利用任何卫星轨道速度和姿态参数信息，具有良好的稳健性，能快速估计出高精度的SAR等效雷达速度值。
权利要求书clms
1.一种基于二维滤波MapDrift的SAR等效雷达速度估计方法，其特征在于，所述方法包括：步骤1：将下变频解调SAR回波数据在慢时间维和快时间维进行分块，得到SAR回波数据；步骤2：利用平均互相关系数法估计所述SAR回波数据的多普勒频率中心，确定所述SAR回波数据的多普勒频率中心；步骤3：对所述SAR回波数据进行距离聚焦成像，获得距离聚焦后的二维频率域数据；步骤4：在预设的速度范围内随机取一个初始的SAR等效雷达速度值，以所述初始的SAR等效雷达速度值作为第一次外层中的第一次内层迭代时的SAR等效雷达速度值；步骤5：定义外层迭代次数为L=l，内层迭代次数为K=k，内层和外层迭代估计开始；步骤6：根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对所述距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，随机加窗截取所述距离和方位聚焦后的SAR复图像中的部分区域进行逆成像，获得未聚焦的SAR数据；步骤7：根据所述未聚焦的SAR数据构建子视图像偏移函数；步骤8：根据所述子视图像偏移函数，采用黄金分割搜索方法估计迭代系数，确定第l次外层的第k次内层迭代的迭代系数；步骤9：根据所述迭代系数以及所述SAR等效雷达速度值，获得第l 次外层的第k次内层迭代的等效雷达速度估计值，该等效雷达速度估计值为：；其中，为第l 次外层的第k次内层迭代的等效雷达速度估计值，/＞为第l 次外层的第k-1次内层迭代的等效雷达速度估计值，/＞为速度值为/＞时前子视SAR图像和后子视SAR图像在方位向的偏移量；步骤10：若所述SAR等效雷达速度值未满足内层停止迭代条件，其中，/＞表示取绝对值，/＞为设定的等效雷达速度的估计精度，令L=l，K=k+1，将所述等效雷达速度估计值作为第l 次外层的第k+1次内层迭代时的SAR等效雷达速度值，重复执行步骤7-步骤10，直至SAR等效雷达速度值满足内层停止迭代条件，输出满足内层停止迭代条件时获得的等效雷达速度估计值，进入步骤11；步骤11：判断当前的外层迭代次数L的值是否等于次数阈值，若否，令L=l+1，K=1，将满足内层停止迭代条件时获得的等效雷达速度估计值作为第l+1次外层的第1次内层迭代的SAR等效雷达速度值，重复执行步骤6-步骤11，直至当前的外层迭代次数L的值等于次数阈值/＞，输出当前的外层迭代次数L的值等于次数阈值/＞的最后一次内层的等效雷达速度估计值，作为最终估计的等效雷达速度。2.根据权利要求1所述的基于二维滤波MapDrift的SAR等效雷达速度估计方法，其特征在于，所述SAR回波数据的多普勒频率中心为：；其中，为SAR回波数据，/＞表示取复共轭；/＞表示取SAR回波数据的相位角；/＞表示脉冲重复频率；/＞为慢时间采样间隔，/＞，/＞和/＞分别表示快时间和慢时间。3.根据权利要求2所述的基于二维滤波MapDrift的SAR等效雷达速度估计方法，其特征在于，所述距离聚焦成像的表达式为：，；其中，与/＞分别表示快时间频率与多普勒频率，/＞表示距离聚焦后的二维频率域数据，/＞表示二维傅里叶变换，/＞表示距离成像匹配滤波器，/＞为雷达发射线性调频信号的调频率，j为虚数。4.根据权利要求3所述的基于二维滤波MapDrift的SAR等效雷达速度估计方法，其特征在于，所述根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对所述距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，随机加窗截取所述距离和方位聚焦后的SAR复图像中的部分区域进行逆成像，获得未聚焦的SAR数据，包括：根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对所述距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，所述方位向成像的表达式为：，；其中，表示方位和距离聚焦后的SAR复图像，/＞表示二维傅里叶逆变换算子，/＞表示距离聚焦后的二维频率域数据，/＞为二维频率域成像滤波器，/＞为关于SAR等效雷达速度值的变量，/＞表示SAR回波数据/＞对应的场景中心到雷达的斜距，/＞为光速，/＞为雷达载频；以大小为的矩形窗随机加窗截取所述距离和方位聚焦后的SAR复图像中的部分区域，获得截取的SAR复图像，所述截取的SAR复图像表达式为：；其中，与/＞分别为所述距离和方位聚焦后的SAR复图像/＞距离向与方位向的长度，/＞与/＞为小于1的常数，/＞与/＞分别为矩形窗距离向与方位向的长度；对所述截取的SAR复图像进行逆成像，获得未聚焦的SAR数据，所述逆成像的表达式为：；其中，表示所述截取的SAR复图像经过逆成像后的未聚焦的SAR数据，为二维频率域逆成像滤波器，所述二维频率域逆成像滤波器是二维频率成像滤波器/＞的共轭形式。5.根据权利要求4所述的基于二维滤波MapDrift的SAR等效雷达速度估计方法，其特征在于，所述根据所述未聚焦的SAR数据构建子视图像偏移函数，包括：对所述未聚焦的SAR数据进行二维匹配滤波，获得匹配滤波后的数据，所述二维匹配滤波的表达式为：；其中，为匹配滤波后的数据，/＞为二维频率域成像滤波器；根据所述匹配滤波后的数据，获得前子视SAR图像和后子视SAR图像，所述前子视SAR图像和后子视SAR图像的表达式为：，；其中，为前子视SAR图像，/＞为后子视SAR图像，为前子视矩形窗，/＞为后子视矩形窗，/＞矩形窗函数定义为：；其中，为矩形窗的自变量，对于前子视矩形窗/＞取值为/＞，对于后子视矩形窗/＞取值为/＞；根据所述前子视SAR图像和后子视SAR图像，分析出所述前子视SAR图像和所述后子视SAR图像在方位向的互相关函数，所述前子视SAR图像和所述后子视SAR图像在方位向的互相关函数/＞为：；其中，表示所述互相关函数/＞的自变量，/＞表示关于以/＞为变量的数学期望；利用所述互相关函数，构建子视图像偏移函数，所述子视图像偏移函数为：；其中，表示取使所述互相关函数/＞最大化的自变量/＞的值，/＞为子视图像偏移函数。6.根据权利要求5所述的基于二维滤波MapDrift的SAR等效雷达速度估计方法，其特征在于，所述根据所述子视图像偏移函数，采用黄金分割搜索方法估计迭代系数，确定迭代系数，包括：步骤7.1：确定两个速度值v1与v2；步骤7.2：计算v1与v2的差值， ；步骤7.3：根据所述子视图像偏移函数，以v为速度值为/＞，计算前子视SAR图像和后子视SAR图像在方位向的偏移量/＞，以及以v为速度值为/＞时，计算前子视SAR图像和后子视SAR图像在方位向的偏移量/＞；步骤7.4：根据差值以及/＞与/＞之间的大小关系，更新速度值/＞或/＞；步骤7.5、计算更新后的v1与v2的差值；步骤7.6：判断更新后的v1与v2的差值是否满足迭代终止条件/＞，若不满足，以更新后的速度值/＞和/＞，重复迭代步骤7.3至步骤7.6，直至满足迭代终止条件，输出满足迭代终止条件的v1与v2，其中，/＞为设定的差值阈值；步骤7.7：根据满足迭代终止条件的v1与v2，计算迭代系数，其中，迭代系数/＞为：。7.根据权利要求6所述的基于二维滤波MapDrift的SAR等效雷达速度估计方法，其特征在于，所述根据差值以及/＞与/＞之间的大小关系，更新速度值/＞或/＞，包括：若，分析以速度值/＞和/＞在一维空间中构成的线段/＞靠近的分割点/＞：；用替换当前的/＞；若，则计算线段/＞靠近/＞的分割点/＞：；用替换当前的/＞。
说明书desc
技术领域本申请涉及雷达信号处理技术领域，特别是涉及一种基于二维滤波MapDrift的SAR等效雷达速度估计方法。背景技术星载合成孔径雷达是一种主动微波传感器，具有高分辨的成像能力。除了强降雨天气外，SAR发射的电磁波几乎能够完全穿透大气层而不受损失，因此具有全天候、全天时的工作能力。星载SAR在地表测绘、高度测绘、地球变化检测、海洋观测、环境保护等方面有广泛的应用，目前已成为对地高分辨观测的重要工具。SAR通过发射宽带信号实现距离高分辨；通过雷达与场景之间的相对运动形成一个“虚拟”的合成孔径，并通过方位匹配滤波对合成孔径回波数据进行信号处理实现方位高分辨。影响SAR成像质量的一个重要的多普勒参数是方位调频率，而方位调频率又与一个称为“等效雷达速度”的参数有直接的关系。对于机载SAR，等效雷达速度就是雷达平台的速度；然而，对于星载SAR，其等效雷达速度不等于卫星速度，二者的差异足以导致严重的SAR图像散焦。因此，需要对等效雷达速度进行估计以得到高聚焦程度的SAR图像。目前估计SAR等效雷达速度的方法可分为两大类：第一大类方法是利用卫星轨道和姿态数据通过几何模型拟合得到等效雷达速度的估计值；第二大类是根据SAR接收的雷达回波数据利用自聚焦的方式估计得出等效雷达速度。基于雷达回波数据自聚焦的等效雷达速度估计方法又分为两种：基于非参数法的自聚焦方法和基于参数法的自聚焦方法。基于参数法的自聚焦方法包括两种常用的方法：对比度优化法和子视图像错位法。而MapDrift法基于方位滤波器的调频率误差会导致两个子视SAR图像之间存在方位向偏移，通过估计方位向偏移即可估计出等效雷达速度。然而，传统的MapDrift方法仍然存在一些缺点：比如，传统的MapDrift方法所用的成像滤波器为一维滤波器，只考虑了方位维的相位匹配滤波而没有考虑方位和距离之间的耦合，再者，所用滤波器只考虑了二阶相位匹配而未考虑三阶及以上高阶相位匹配，因此，影响了等效雷达速度的估计精度。对于传统的MapDrift方法，速度迭代公式中的迭代系数是通过解析表达式计算得到的，该迭代系数表达式中包含多普勒带宽和等效雷达速度这两个参数，然而，多普勒带宽这个参数有时不能准确得到，此外，迭代系数表达式中的等效雷达速度这个参数恰好是需要估计的参数，因此，传统MapDrift方法所用到的迭代系数往往不能准确得到。此外，传统的MapDrift方法依赖等效雷达速度初始值,若初始值与真实值之间的误差过大则子图像之间的偏移量难以估计。综上所述，目前传统的MapDrift方法估计SAR等效雷达速度的精度较低。发明内容基于此，有必要针对上述技术问题，提供一种能够提高MapDrift方法估计SAR等效雷达速度的精度的基于二维滤波MapDrift的SAR等效雷达速度估计方法。一种基于二维滤波MapDrift的SAR等效雷达速度估计方法，所述方法包括：步骤1：将下变频解调SAR回波数据在慢时间维和快时间维进行分块，得到SAR回波数据；步骤2：利用平均互相关系数法估计所述SAR回波数据的多普勒频率中心，确定所述SAR回波数据的多普勒频率中心；步骤3：对所述SAR回波数据进行距离聚焦成像，获得距离聚焦后的二维频率域数据；步骤4：在预设的速度范围内随机取一个初始的SAR等效雷达速度值，以所述初始的SAR等效雷达速度值作为第一次外层中的第一次内层迭代时的SAR等效雷达速度值；步骤5：定义外层迭代次数为L=l，内层迭代次数为K=k，内层和外层迭代估计开始；步骤6：根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对所述距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，随机加窗截取所述距离和方位聚焦后的SAR复图像中的部分区域进行逆成像，获得未聚焦的SAR数据；步骤7：根据所述未聚焦的SAR数据构建子视图像偏移函数；步骤8：根据所述子视图像偏移函数，采用黄金分割搜索方法估计迭代系数，确定第l 次外层的第k次内层迭代的迭代系数；步骤9：根据所述迭代系数以及所述SAR等效雷达速度值，获得第l 次外层的第k次内层迭代的等效雷达速度估计值，该等效雷达速度估计值为：；其中，为第l 次外层的第k次内层迭代的等效雷达速度估计值，/＞为第l 次外层的第k-1次内层迭代的等效雷达速度估计值，/＞为速度值为/＞时前子视SAR图像和后子视SAR图像在方位向的偏移量；步骤S10：若所述SAR等效雷达速度值未满足内层停止迭代条件，其中，/＞表示取绝对值，/＞为设定的等效雷达速度的估计精度，令L=l，K=k+1，将所述等效雷达速度估计值作为第l 次外层的第k+1次内层迭代时的SAR等效雷达速度值，重复执行步骤7-步骤10，直至SAR等效雷达速度值满足内层停止迭代条件，输出满足内层停止迭代条件时获得的等效雷达速度估计值，进入步骤11；步骤11：判断当前的外层迭代次数L的值是否等于次数阈值，若否，令L=l+1，K=1，将满足内层停止迭代条件时获得的等效雷达速度估计值作为第l+1次外层的第1次内层迭代的SAR等效雷达速度值，重复执行步骤6-步骤11，直至当前的外层迭代次数L的值等于次数阈值/＞，输出当前的外层迭代次数L的值等于次数阈值/＞的最后一次内层的等效雷达速度估计值，作为最终估计的等效雷达速度。在其中一个实施例中，所述SAR回波数据的多普勒频率中心为：；其中，为SAR回波数据，/＞表示取复共轭；/＞表示取SAR回波数据的相位角；/＞表示脉冲重复频率；/＞为慢时间采样间隔，/＞，/＞和/＞分别表示快时间和慢时间。在其中一个实施例中，所述距离聚焦成像的表达式为：，；其中，与/＞分别表示快时间频率与多普勒频率，/＞表示距离聚焦后的二维频率域数据，/＞表示二维傅里叶变换，/＞表示距离成像匹配滤波器，为雷达发射线性调频信号的调频率，j为虚数。在其中一个实施例中，所述根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对所述距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，随机加窗截取所述距离和方位聚焦后的SAR复图像中的部分区域进行逆成像，获得未聚焦的SAR数据，包括：根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对所述距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，所述方位向成像的表达式为：，；其中，表示方位和距离聚焦后的SAR复图像，/＞表示二维傅里叶逆变换算子，/＞表示距离聚焦后的二维频率域数据，/＞为二维频率域成像滤波器，/＞为关于SAR等效雷达速度值的变量，/＞表示SAR回波数据/＞对应的场景中心到雷达的斜距，/＞为光速，/＞为雷达载频；以大小为的矩形窗随机加窗截取所述距离和方位聚焦后的SAR复图像中的部分区域，获得截取的SAR复图像，所述截取的SAR复图像表达式为：；其中，与/＞分别为所述距离和方位聚焦后的SAR复图像/＞距离向与方位向的长度，/＞与/＞为小于1的常数，/＞与/＞分别为矩形窗距离向与方位向的长度；对所述截取的SAR复图像进行逆成像，获得未聚焦的SAR数据，所述逆成像的表达式为：；其中，表示所述截取的SAR复图像经过逆成像后的未聚焦的SAR数据，为二维频率域逆成像滤波器，所述二维频率域逆成像滤波器是二维频率成像滤波器/＞的共轭形式。在其中一个实施例中，所述根据所述未聚焦的SAR数据构建子视图像偏移函数，包括：对所述未聚焦的SAR数据进行二维匹配滤波，获得匹配滤波后的数据，所述二维匹配滤波的表达式为：；其中，为匹配滤波后的数据，/＞为二维频率域成像滤波器；根据所述匹配滤波后的数据，获得前子视SAR图像和后子视SAR图像，所述前子视SAR图像和后子视SAR图像的表达式为：，；其中，为前子视SAR图像，/＞为后子视SAR图像，为前子视矩形窗，/＞为后子视矩形窗，/＞矩形窗函数定义为：；其中，为矩形窗的自变量，对于前子视矩形窗/＞取值为/＞，对于后子视矩形窗/＞取值为/＞；根据所述前子视SAR图像和后子视SAR图像，分析出所述前子视SAR图像和所述后子视SAR图像在方位向的互相关函数，所述前子视SAR图像和所述后子视SAR图像在方位向的互相关函数/＞为：；其中，表示所述互相关函数/＞的自变量，/＞表示关于以/＞为变量的数学期望；利用所述互相关函数，构建子视图像偏移函数，所述子视图像偏移函数为：；其中，表示取使所述互相关函数/＞最大化的自变量/＞的值，为子视图像偏移函数。在其中一个实施例中，所述根据所述子视图像偏移函数，采用黄金分割搜索方法估计迭代系数，确定迭代系数，包括：步骤7.1：确定两个速度值v1与v2；步骤7.2：计算v1与v2的差值， ；步骤7.3：根据所述子视图像偏移函数，以v为速度值为/＞，计算前子视SAR图像和后子视SAR图像在方位向的偏移量/＞，以及以v为速度值为/＞时，计算前子视SAR图像和后子视SAR图像在方位向的偏移量/＞；步骤7.4：根据差值以及/＞与/＞之间的大小关系，更新速度值/＞或；步骤7.5、计算更新后的v1与v2的差值；步骤7.6：判断更新后的v1与v2的差值是否满足迭代终止条件/＞，若不满足，以更新后的速度值/＞和/＞，重复迭代步骤7.3至步骤7.6，直至满足迭代终止条件，输出满足迭代终止条件的v1与v2，其中，/＞为设定的差值阈值；步骤7.7：根据满足迭代终止条件的v1与v2，计算迭代系数，其中，迭代系数/＞为：/＞。在其中一个实施例中，所述根据差值以及/＞与/＞之间的大小关系，更新速度值/＞或/＞，包括：若，分析以速度值/＞和/＞在一维空间中构成的线段/＞靠近/＞的分割点/＞：；用替换当前的/＞；若，则计算线段/＞靠近/＞的分割点/＞：；用替换当前的/＞。本申请与现有技术相比其显著优点在于：第一、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法是基于二维频率域成像滤波器的SAR等效雷达速度估计方法，该方法所用到的滤波器不仅考虑了方位滤波，而且考虑了方位和距离的耦合问题，通过外层迭代对距离走动进行校正。此外，本申请的在进行二维匹配滤波时不仅考虑了二次相位而且还包含了高阶相位，提高了二维成像的效果，进而提高了估计SAR等效雷达速度的精度。第二、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法不是通过解析表达式计算迭代系数，而是通过SAR回波数据利用黄金分割搜索法估计速度迭代系数，因此可得到较为精确的迭代系数，克服了传统MapDrift方法的缺点，进一步的提高了估计SAR等效雷达速度的精度。第三、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法采用了成像/加窗/逆成像等步骤，即：通过某个雷达等效速度值对距离聚焦后的二维频率域数据实现方位向成像，然后利用矩形窗截取小块区域并进行逆成像，因此避免了散射点部分照射导致两子视图像内容不一致的问题，并且本申请还能够解决等效雷达速度本身的空变问题和二维匹配滤波器的距离向空变问题。第四、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法在估计SAR等效雷达速度估计值的过程中采用了双层迭代，即：内层迭代通过计算前子视SAR图像和后子视SAR图像在方位向的偏移量迭代估计SAR等效雷达速度估计值，而外层迭代利用内层迭代估计得到的SAR等效雷达速度估计值重新进行方位成像/加窗截取/逆成像这个步骤。本申请通过外层迭代解决了由于等效雷达速度不准确导致方位压缩和距离走动校正不准确进而导致的散射点加窗截取不彻底的问题，可进一步提高等效雷达速度的估计精度。第五，本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法，无需利用任何卫星轨道速度和姿态参数信息，具有良好的稳健性，能快速估计出高精度的SAR等效雷达速度值。附图说明图1为一个实施例中一种基于二维滤波MapDrift的SAR等效雷达速度估计方法的流程示意图；图2为一个示例中的距离和方位聚焦后的SAR复图像以及截取的SAR复图像；图3为一个示例中前子视SAR图像；图4为一个示例中后子视SAR图像；图5为一个示例中两子视SAR图像互相关函数的变化曲线示意图；图6为一个示例中等效雷达速度估计值随迭代次数变化的曲线示意图；图7为利用本申请方法估计的等效雷达速度所得到的SAR图像。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。在一个实施例中，如图1所示，提供了一种基于二维滤波MapDrift的SAR等效雷达速度估计方法，以该方法应用于终端为例进行说明，包括以下步骤：步骤1：将下变频解调SAR回波数据在慢时间维和快时间维进行分块，得到SAR回波数据。其中，下变频解调SAR回波数据可以是下变频SAR回波数据通过解调得到可用于实现SAR成像的SAR回波数据。步骤2：利用平均互相关系数法估计SAR回波数据的多普勒频率中心，确定SAR回波数据的多普勒频率中心。步骤3：对SAR回波数据进行距离聚焦成像，获得距离聚焦后的二维频率域数据。步骤4：在预设的速度范围内随机取一个初始的SAR等效雷达速度值，以初始的SAR等效雷达速度值作为第一次外层中的第一次内层迭代时的SAR等效雷达速度值。其中，预设的速度范围可以根据雷达实际的速度范围确定。预设的速度范围可以为6000m/s-8000m/s的速度范围。步骤5：定义外层迭代次数为L=l，内层迭代次数为K=k，内层和外层迭代估计开始。其中，l和k为正整数。步骤6：根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，随机加窗截取距离和方位聚焦后的SAR复图像中的部分区域进行逆成像，获得未聚焦的SAR数据。步骤7：根据未聚焦的SAR数据构建子视图像偏移函数。步骤8：根据子视图像偏移函数，采用黄金分割搜索方法估计迭代系数，确定第l次外层的第k次内层迭代的迭代系数。步骤9：根据迭代系数以及SAR等效雷达速度值，获得第l 次外层的第k次内层迭代的等效雷达速度估计值，该等效雷达速度估计值为：；其中，为第l 次外层的第k次内层迭代的等效雷达速度估计值，/＞为第l 次外层的第k-1次内层迭代的等效雷达速度估计值，/＞为速度值为/＞时前子视SAR图像和后子视SAR图像在方位向的偏移量。应理解，若在第1次外层的第1次内层迭代估计等效雷达速度估计值时，为初始的SAR等效雷达速度值。步骤10：若SAR等效雷达速度值未满足内层停止迭代条件，其中，/＞表示取绝对值，/＞为设定的等效雷达速度的估计精度，令L=l，K=k+1，将等效雷达速度估计值作为第l 次外层的第k+1次内层迭代时的SAR等效雷达速度值，重复执行步骤7-步骤10，直至SAR等效雷达速度值满足内层停止迭代条件，输出满足内层停止迭代条件时获得的等效雷达速度估计值，进入步骤11。其中，设定的等效雷达速度的估计精度可以是根据精度要求进行设定。如的值设置为0.001m/s。步骤11：判断当前的外层迭代次数L的值是否等于次数阈值，若否，令L=l+1，K=1，将满足内层停止迭代条件时获得的等效雷达速度估计值作为第l+1次外层的第1次内层迭代的SAR等效雷达速度值，重复执行步骤6-步骤11，直至当前的外层迭代次数L的值等于次数阈值/＞，输出当前的外层迭代次数L的值等于次数阈值/＞的最后一次内层的等效雷达速度估计值，作为最终估计的等效雷达速度。应理解，外层迭代与内层迭代相比较，外层迭代的目的是为了解决由于等效雷达速度不准确导致方位压缩和距离走动校正不准确而导致的散射点“加窗截取”不彻底的问题，从而可估计出较高精度的等效雷达速度估计值。上述基于二维滤波MapDrift的SAR等效雷达速度估计方法，首先对SAR原始数据进行距离聚焦成像；先利用一个初始等效雷达速度进行粗略聚焦成像；接着加窗截取SAR复图像的其中一块区域，并对该区域的数据进行逆成像，还原为未聚焦的SAR原始数据；然后构建子视图像偏移函数计算出前子视SAR图像与后子视SAR图像的偏移量；接着利用黄金分割搜索法估计二维MapDrift的迭代系数；然后利用迭代系数和子视图像偏移函数进行速度迭代，得到等效雷达速度估计值；最后用上一步得到的等效雷达速度估计值替换初始速度，重新执行成像、加窗截取、逆成像、二维MapDrift速度迭代等步骤，直至达到指定的迭代次数。由此无需利用任何卫星轨道速度和姿态参数信息，具有良好的稳健性，能快速估计出高精度的SAR等效雷达速度值。在一个实施例中，SAR回波数据的多普勒频率中心为：；其中，为SAR回波数据，/＞表示取复共轭；/＞表示取SAR回波数据的相位角；/＞表示脉冲重复频率；/＞为慢时间采样间隔，/＞，/＞和/＞分别表示快时间和慢时间。应理解，估计得到的多普勒频率中心可以作为后续方位成像的一个辅助参数，使得被雷达波束中心照射的那些散射点聚焦成像后能够位于SAR图像的方位向中间位置，从而便于后续的SAR复图像加窗截取处理。在一个实施例中，距离聚焦成像的表达式为：，；其中，与/＞分别表示快时间频率与多普勒频率，/＞表示距离聚焦后的二维频率域数据，/＞表示二维傅里叶变换，/＞表示距离成像匹配滤波器，为雷达发射线性调频信号的调频率，j为虚数。在一个实施例中，根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，随机加窗截取距离和方位聚焦后的SAR复图像中的部分区域进行逆成像，获得未聚焦的SAR数据，包括：根据第l 次外层的第k次内层迭代的SAR等效雷达速度值，对距离聚焦后的二维频率域数据进行方位向成像，获得距离和方位聚焦后的SAR复图像，方位向成像的表达式为：，；其中，表示方位和距离聚焦后的SAR复图像，/＞表示二维傅里叶逆变换算子，/＞表示距离聚焦后的二维频率域数据，/＞为二维频率域成像滤波器，/＞为关于SAR等效雷达速度值的变量，/＞表示SAR回波数据/＞对应的场景中心到雷达的斜距，/＞为光速，/＞为雷达载频。应理解，在执行第1次外层的第1次内层迭代时，的值为随机取一个初始的SAR等效雷达速度值，在执行第l次外层的第k次内层迭代时，/＞的值为第l 次外层的第k-1次内层迭代的等效雷达速度估计值，应理解，在k为1的情况下，在执行第l次外层的第k次内层迭代时，/＞的值为第l-1 次外层的最后一次内层迭代的等效雷达速度估计值。以大小为的矩形窗随机加窗截取距离和方位聚焦后的SAR复图像中的部分区域，获得截取的SAR复图像，截取的SAR复图像表达式为：；其中，与/＞分别为距离和方位聚焦后的SAR复图像/＞距离向与方位向的长度，/＞与/＞为小于1的常数，/＞与/＞分别为矩形窗距离向与方位向的长度；对截取的SAR复图像进行逆成像，获得未聚焦的SAR数据，逆成像的表达式为：；其中，表示截取的SAR复图像经过逆成像后的未聚焦的SAR数据，为二维频率域逆成像滤波器，二维频率域逆成像滤波器是二维频率成像滤波器/＞的共轭形式。在一个实施例中，根据未聚焦的SAR数据构建子视图像偏移函数，包括：对未聚焦的SAR数据进行二维匹配滤波，获得匹配滤波后的数据，二维匹配滤波的表达式为：；其中，为匹配滤波后的数据，/＞为二维频率域成像滤波器。其中，二维频率域成像滤波器为双曲函数形式。根据匹配滤波后的数据，获得前子视SAR图像和后子视SAR图像，前子视SAR图像和后子视SAR图像的表达式为：，；其中，为前子视SAR图像，/＞为后子视SAR图像，为前子视矩形窗，/＞为后子视矩形窗，/＞矩形窗函数定义为：；其中，为矩形窗的自变量，对于前子视矩形窗/＞取值为/＞，对于后子视矩形窗/＞取值为/＞。根据前子视SAR图像和后子视SAR图像，分析出前子视SAR图像和后子视SAR图像在方位向的互相关函数，前子视SAR图像和后子视SAR图像在方位向的互相关函数为：；其中，表示互相关函数/＞的自变量，/＞表示关于以/＞为变量的数学期望。利用互相关函数，构建子视图像偏移函数，子视图像偏移函数为：；其中，表示取使互相关函数/＞最大化的自变量/＞的值，/＞为子视图像偏移函数。在一个实施例中，根据子视图像偏移函数，采用黄金分割搜索方法估计迭代系数，确定迭代系数，包括：步骤7.1：确定两个速度值v1与v2；步骤7.2：计算v1与v2的差值， ；/＞步骤7.3：根据子视图像偏移函数，以v为速度值为/＞，计算前子视SAR图像和后子视SAR图像在方位向的偏移量/＞，以及以v为速度值为/＞时，计算前子视SAR图像和后子视SAR图像在方位向的偏移量/＞；步骤7.4：根据差值以及/＞与/＞之间的大小关系，更新速度值/＞或；步骤7.5、计算更新后的v1与v2的差值；步骤7.6：判断更新后的v1与v2的差值是否满足迭代终止条件/＞，若不满足，以更新后的速度值/＞和/＞，重复迭代步骤7.3至步骤7.6，直至满足迭代终止条件，输出满足迭代终止条件的v1与v2，其中，/＞为设定的差值阈值；步骤7.7：根据满足迭代终止条件的v1与v2，计算迭代系数，其中，迭代系数/＞为：/＞。应理解，在每一次迭代更新速度值时，根据偏移量和偏移量/＞之间的大小关系，确定更新的v1还是v2。即，在步骤7.5和7.6中的更新后的v1与v2，其中一个是新的速度值，另一个则是之前的速度值。在一个示例中，在执行第1次外层的第1次内层迭代时，在第一次执行步骤7.1时，将两个速度值v1与v2预先设定为与/＞，后续执行步骤7.1时，以上一次更新后的速度值v1与v2确定为当前次步骤7.1的v1与v2。应理解，给定v1与v2时，满足：，且SAR等效雷达速度的真实值在v1与v2之间，根据先验知识：雷达等效雷达速度在/＞范围之内，所以等效雷达速度真实值在v1与v2之间。其中，的值可以根据精度要求进行设置，如设置为200m/s。其中，步骤7.1至步骤7.6的目的是逐步缩小等效雷达速度的范围直至达到某个设定的最大可接受的v1与v2的差值。在一个示例中，在的值设置为200m/s，在经过步骤7.1至步骤7.6将v1与v2分别变为7334.8m/s与7462.9m/s时，满足/＞，则输出满足迭代终止条件的v1=7334.8m/s与v2=7462.9m/s。在一个实施例中，根据差值以及/＞与/＞之间的大小关系，更新速度值/＞或/＞，包括：若，分析以速度值/＞和/＞在一维空间中构成的线段/＞靠近/＞的分割点/＞：；用替换当前的/＞；若，则计算线段/＞靠近/＞的分割点/＞：；用替换当前的/＞。本申请与现有技术相比其显著优点在于：第一、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法是基于二维频率域成像滤波器的SAR等效雷达速度估计方法，该方法所用到的滤波器不仅考虑了方位滤波，而且考虑了方位和距离的耦合问题，通过外层迭代对距离走动进行校正。此外，本申请的在进行二维匹配滤波时不仅考虑了二次相位而且还包含了高阶相位，提高了二维成像的效果，进而提高了估计SAR等效雷达速度的精度。第二、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法不是通过解析表达式计算迭代系数，而是通过SAR回波数据利用黄金分割搜索法估计速度迭代系数，因此可得到较为精确的迭代系数，克服了传统MapDrift方法的缺点，进一步的提高了估计SAR等效雷达速度的精度。第三、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法采用了成像/加窗/逆成像等步骤，即：通过某个雷达等效速度值对距离聚焦后的二维频率域数据实现方位向成像，然后利用矩形窗截取小块区域并进行逆成像，因此避免了散射点部分照射导致两子视图像内容不一致的问题，并且本申请还能够解决等效雷达速度本身的空变问题和二维匹配滤波器的距离向空变问题。第四、本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法在估计SAR等效雷达速度估计值的过程中采用了双层迭代，即：内层迭代通过计算前子视SAR图像和后子视SAR图像在方位向的偏移量迭代估计SAR等效雷达速度估计值，而外层迭代利用内层迭代估计得到的SAR等效雷达速度估计值重新进行方位成像/加窗截取/逆成像这个步骤。本申请通过外层迭代解决了由于等效雷达速度不准确导致方位压缩和距离走动校正不准确进而导致的散射点加窗截取不彻底的问题，可进一步提高等效雷达速度的估计精度。第五，本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法，无需利用任何卫星轨道速度和姿态参数信息，具有良好的稳健性，能快速估计出高精度的SAR等效雷达速度值。在一个示例中，提供的一种基于二维滤波MapDrift的SAR等效雷达速度估计方法，以预设的速度范围设置为6000m/s-8000m/s，的值设置为0.001m/s，/＞的值设置为200m/s为例，通过执行步骤1-步骤3对下变频解调SAR回波数据进行预处理，获得距离聚焦后的二维频率域数据；基于距离聚焦后的二维频率域数据，通过外层迭代和内层迭代，估计出最终估计的等效雷达速度。其中，在执行第1次外层迭代时，利用随机取一个初始的SAR等效雷达速度值，通过执行步骤4-步骤6：对距离聚焦后的二维频率域数据进行成像，获得距离和方位聚焦后的SAR复图像，其中，图2所示的距离和方位聚焦后的SAR复图像，由于初始的SAR等效雷达速度值并不是等效雷达速度的精确估计值，而是某个“初猜”值，因此，图2所示的该距离和方位聚焦后的SAR复图像只是一个“粗略”的SAR图像，再对该距离和方位聚焦后的SAR复图像进行加窗截取/逆成像，获得截取的SAR复图像，该截取的SAR复图像如图2所示白色框中的内容。之后，进入内层迭代，通过重复执行步骤7-步骤10：将截取的SAR复图像进行逆成像和二维匹配滤波后，获得前子视SAR图像和后子视SAR图像，其中，如图3和图4所示的前子视SAR图像和后子视SAR图像。进而分析前子视SAR图像和后子视SAR图像在方位向的互相关函数，其中，前子视SAR图像和后子视SAR图像在方位向的互相关函数的变化曲线如图5所示。利用互相关函数，构建子视图像偏移函数，并采用黄金分割搜索方法，根据子视图像偏移函数，迭代分析出迭代系数，根据迭代系数/＞以及SAR等效雷达速度值，获得第l 次外层的第k次内层迭代的等效雷达速度估计值，直至SAR等效雷达速度值满足内层停止迭代条件，输出满足内层停止迭代条件时获得的等效雷达速度估计值，进入第1次外层的步骤11，判断当前的外层迭代次数L的值是否等于次数阈值/＞，若否，重复执行步骤6-步骤11，直至当前的外层迭代次数等于次数阈值/＞，获得最终估计的等效雷达速度。其中，如图6所示的等效雷达速度估计值随迭代次数变化的曲线。从图6中可以看出，随着迭代次数的增加，等效雷达速度估计值逐渐趋于稳定，收敛于7419.777m/s。在一个示例中，外层迭代之前，内层迭代得到的等效雷达速度估计值为7419.777m/s，经过第一次外层迭代，等效雷达速度估计值变为7417.687m/s；经过第二次外层迭代，等效雷达速度估计值变为7417.683m/s。可以看出，经过两次外层迭代，即可得到一个较为稳定的等效雷达速度估计值。将以等效雷达速度估计值作为输入参数应用于Omega-k成像算法，并对图2所示的整景SAR数据重新进行成像，得到图7所示的聚焦良好的SAR图像，可见本申请的基于二维滤波MapDrift的SAR等效雷达速度估计方法提高了MapDrift方法估计SAR等效雷达速度的精度。应该理解的是，虽然图1的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，图1中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些子步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
