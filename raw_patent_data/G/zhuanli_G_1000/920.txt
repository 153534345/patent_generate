标题title
一种基于脑图的低遗忘热点事件预测方法及装置
摘要abst
本发明公开了一种基于脑图的低遗忘热点事件预测方法及装置，方法包括：将待预测的社交网络热点事件流输入构建好的BNN模型，利用构建好的BNN模型预测事件后续发展；构建BNN模型包括：提取推理预测的脑区fMRI成像；将脑区fMRI成像转化为脑图网络并融合；将融合图中节点替换为神经元模型得到原始BNN；分批次将若干个事件流中事件逐个输入原始BNN，每一批次均对原始BNN进行权重更新后利用相似性计算进行阈值处理得到若干组BNN1、BNN2…BNNn；将若干组BNN1、BNN2…BNNn相继融合，利用相似性计算对需要重放的事件进行经验重放，BNN模型构建完成。本发明提高了热点事件的预测精度。
权利要求书clms
1.一种基于脑图的低遗忘热点事件预测方法，其特征在于，包括：将待预测的社交网络热点事件流输入构建好的BNN模型，利用构建好的BNN模型预测事件后续发展；其中，BNN模型的构建包括：提取推理预测的三个脑区fMRI成像；将三个脑区fMRI成像转化为脑图网络并融合，得到融合图；将融合图中节点替换为神经元模型，得到原始BNN；以一个事件流为一批次地分批次将若干个事件流中事件逐个输入原始BNN，每一批次均对原始BNN进行权重更新后利用相似性计算进行阈值处理，得到若干组BNN1、BNN2…BNNn；将若干组BNN1、BNN2…BNNn相继融合，并利用相似性计算对需要重放的事件进行经验重放，得到构建好的BNN模型。2.根据权利要求1所述的一种基于脑图的低遗忘热点事件预测方法，其特征在于，将三个脑区fMRI成像转化为脑图网络，包括：将fMRI成像转为时序数据，通过时序数据构建Shrinkage协方差矩阵；将Shrinkage协方差矩阵转换为相关性系数矩阵，通过相关性系数矩阵构建功能脑区网络；使用Kamada-Kawai布局算法将功能脑区网络可视化；使用二维Newton-Raphson方法对fMRI成像中随机选取的节点m求单个功能脑区网络系统能量的最小值；使用单个功能脑区网络系统能量最小下求得的参数绘制出脑图网络；其中，Shrinkage协方差矩阵为：；式中，为Shrinkage协方差矩阵，/＞为平滑参数，/＞为时序数据的协方差矩阵，n为时序数据的样本数量，/＞为第i个样本，/＞为样本均值，D为一个对角矩阵，其非对角元素为0，对角线上的元素为：/＞， p为矩阵S的维数；相关性系数矩阵为： ；式中，和/＞为变量i和变量j的标准差，/＞，/＞，/＞为相关性系数矩阵的元素取值范围为且/＞，当的绝对值大于设定值时，判定节点i与节点j有联系。3.根据权利要求2所述的一种基于脑图的低遗忘热点事件预测方法，其特征在于，当梯度最大值小于设定阈值时，得到单个功能脑区网络系统能量的最小值；其中，单个功能脑区网络系统能量计算公式为：；式中， x、y为功能脑区网络节点的坐标，k为设置的常数，l为长度与平衡状态的差值；梯度的计算公式为：；式中，和/＞为/＞和/＞的偏导数，为：；。4.根据权利要求1所述的一种基于脑图的低遗忘热点事件预测方法，其特征在于，脑图网络的融合和若干组BNN1、BNN2…BNNn的相继融合均采用共识迭代算法进行，包括：步骤a：对初始图做并集处理，得到共识图；步骤b：计算每张初始图与共识图之间的相似度，根据相似度分配每张初始图对应的权重；步骤c：对权重分配后的初始图做并集处理并融合出新的共识图；步骤d：重复步骤b和步骤c，直至达到设定的迭代次数K，得到最终共识图；步骤e：根据设定的边与节点的阈值，将最终共识图权重低于阈值的边与节点抹除；其中，共识图的计算公式为：；式中，为共识图，/＞为初始图；每张初始图与共识图之间的相似度的计算公式为：；式中，为初始图i的相似度，/＞与/＞为初始图i的边与节点，/＞与/＞为共识图的边与节点，a为设定的初始图与共识图每条边与每条节点的初始权重，为常数；每张初始图所对应的权重分配公式为：；式中，为初始图i的权重，/＞为初始图的相似度之和；新的共识图的每条边和每个节点的权重为：；式中，为新的共识图中边或节点i的权重，/＞为初始图j所对应的权重，/＞为初始图j中边或节点i的权重。5.根据权利要求1所述的一种基于脑图的低遗忘热点事件预测方法，其特征在于，对原始BNN进行权重更新后利用相似性计算进行阈值处理，包括：利用交叉熵损失函数对原始BNN进行权重更新，得到新的BNN；计算新的BNN中各节点和边与原始BNN的相似度，根据设定的相似度阈值删去低于阈值的边或节点；其中，交叉熵损失函数和权重更新公式为：；；式中，为真实标签，/＞为预测输出，/＞和/＞为新、旧权重，/＞为学习率， g为损失函数对权重的梯度；新的BNN中各节点和边与原始BNN的相似度的计算公式为：；；式中，为边i的相似度，/＞和/＞为边i的新旧权重，/＞与/＞为与边i相连的节点的新、旧权重；/＞为节点j的相似度，/＞和/＞为节点j的新、旧权重，/＞和为与节点j相连的边的新、旧权重。6.根据权利要求1所述的一种基于脑图的低遗忘热点事件预测方法，其特征在于，利用相似性计算对需要重放的事件进行经验重放，包括：对于每一组BNN1、BNN2…BNNn，计算BNN1、BNN2…BNNn分别与原始BNN的相似度并排序，选取相似度满足设定阈值的若干BNNi，将若干BNNi对应的事件存入预设的重放池并加至对应事件流的末尾；在若干BNNi对应的事件存入重放池时，将若干BNNi对应的相似度与已存入重放池的事件对应的相似度进行排序并选取较高相似度的事件存入，更新重放池并维持重放池内存入事件的数目不变；其中，BNN1、BNN2…BNNn分别与原始BNN的相似度的计算公式为：；；式中，为BNNk与原始BNN的相似度，/＞为边i的相似度，/＞为节点j的相似度， n、m分别为边与节点的总数。7.一种基于脑图的低遗忘热点事件预测装置，其特征在于，包括：预测模块，用于将待预测的社交网络热点事件流输入构建好的BNN模型，利用构建好的BNN模型预测事件后续发展；其中，BNN模型的构建包括：提取推理预测的三个脑区fMRI成像；将三个脑区fMRI成像转化为脑图网络并融合，得到融合图；将融合图中节点替换为神经元模型，得到原始BNN；以一个事件流为一批次地分批次将若干个事件流中事件逐个输入原始BNN，每一批次均对原始BNN进行权重更新后利用相似性计算进行阈值处理，得到若干组BNN1、BNN2…BNNn；将若干组BNN1、BNN2…BNNn相继融合，并利用相似性计算对需要重放的事件进行经验重放，得到构建好的BNN模型。8.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现权利要求1至6中任一项所述的基于脑图的低遗忘热点事件预测方法的步骤。9.计算机可读存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时实现权利要求1至6中任一项所述的基于脑图的低遗忘热点事件预测方法的步骤。
说明书desc
技术领域本发明涉及人工智能技术领域，尤其涉及一种基于脑图的低遗忘热点事件预测方法及装置。背景技术随着信息化时代的到来，五花八门的新闻事件借助社交网络来到人们的眼前，自然而然地提高了人们对社交网络热点事件的关注，而为了预测这些热点事件的后续发展，对于终身学习的利用也在逐步发展。终身学习，也被称为持续学习、增量学习、永无止境的学习，是一种学习特性，旨在模仿人类在一生中进行持续学习和转移、获得和完善知识的能力。一个终身学习模型应该能够识别即将到来的知识和以前的知识之间的相似性。当一个新的任务与以前的经验非常相似时，学习代理应该改进现有的模型，使其表现更好。同时，当一个新任务与以前的经验没有什么相似性或关联性时，系统可以转移知识来解决新的任务。大多数流行的深度学习算法不具备增量学习传入的新信息的能力，这导致了灾难性的遗忘或干扰问题。特别是，新信息会干扰以前的知识，导致模型在旧任务上的性能下降，因为新的信息正在覆盖它。灾难性遗忘是指学习系统在获取新信息时突然严重丧失先前获得的信息，灾难性遗忘一直是标准人工神经网络在学习时一个致命的弱点。学习系统必须足够稳定，能够长期保存先前的知识，同时具有一定的可塑性能够用以适应新的学习，这两个条件是对立的，从而构成了“稳定性-可塑性难题”。目前的人工神经网络，包括深度神经网络，一般都具有过度的可塑性，会导致严重的灾难性遗忘。发明内容本发明的目的在于克服现有技术中的不足，提供一种基于脑图的低遗忘热点事件预测方法及装置，以解决在进行社交网络热点事件的预测时随着时间的推移与事件流的不断输入从而引起灾难性遗忘的问题。为解决上述技术问题，本发明是采用下述方案实现的：本发明提供一种基于脑图的低遗忘热点事件预测方法，包括：将待预测的社交网络热点事件流输入构建好的BNN模型，利用构建好的BNN模型预测事件后续发展；其中，BNN模型的构建包括：提取推理预测的三个脑区fMRI成像；将三个脑区fMRI成像转化为脑图网络并融合，得到融合图；将融合图中节点替换为神经元模型，得到原始BNN；以一个事件流为一批次地分批次将若干个事件流中事件逐个输入原始BNN，每一批次均对原始BNN进行权重更新后利用相似性计算进行阈值处理，得到若干组BNN1、BNN2…BNNn；将若干组BNN1、BNN2…BNNn相继融合，并利用相似性计算对需要重放的事件进行经验重放，得到构建好的BNN模型。进一步地，将三个脑区fMRI成像转化为脑图网络，包括：将fMRI成像转为时序数据，通过时序数据构建Shrinkage协方差矩阵；将Shrinkage协方差矩阵转换为相关性系数矩阵，通过相关性系数矩阵构建功能脑区网络；使用Kamada-Kawai布局算法将功能脑区网络可视化；使用二维Newton-Raphson方法对fMRI成像中随机选取的节点m求单个功能脑区网络系统能量的最小值；使用单个功能脑区网络系统能量最小下求得的参数绘制出脑图网络；其中，Shrinkage协方差矩阵为：；式中，为Shrinkage协方差矩阵，/＞为平滑参数，为时序数据的协方差矩阵，n为时序数据的样本数量，/＞为第i个样本，/＞为样本均值，D为一个对角矩阵，其非对角元素为0，对角线上的元素为：，p为矩阵S的维数；相关性系数矩阵为： ；式中，和/＞为变量i和变量j的标准差，/＞，/＞，/＞为相关性系数矩阵的元素取值范围为且/＞，当的绝对值大于设定值时，判定节点i与节点j有联系。进一步地，当梯度最大值小于设定阈值时，得到单个功能脑区网络系统能量的最小值；其中，单个功能脑区网络系统能量计算公式为：；式中，x、y为功能脑区网络节点的坐标，k为设置的常数，l为长度与平衡状态的差值；梯度的计算公式为：；式中，和/＞为/＞和/＞的偏导数，为：；。进一步地，脑图网络的融合和若干组BNN1、BNN2…BNNn的相继融合均采用共识迭代算法进行，包括：步骤a：对初始图做并集处理，得到共识图；步骤b：计算每张初始图与共识图之间的相似度，根据相似度分配每张初始图对应的权重；步骤c：对权重分配后的初始图做并集处理并融合出新的共识图；步骤d：重复步骤b和步骤c，直至达到设定的迭代次数K，得到最终共识图；步骤e：根据设定的边与节点的阈值，将最终共识图权重低于阈值的边与节点抹除；其中，共识图的计算公式为：；式中，为共识图，/＞为初始图；每张初始图与共识图之间的相似度的计算公式为：；式中，为初始图i的相似度，/＞与/＞为初始图i的边与节点，/＞与/＞为共识图的边与节点，a为设定的初始图与共识图每条边与每条节点的初始权重，为常数；每张初始图所对应的权重分配公式为：；式中，为初始图i的权重，/＞为初始图的相似度之和。新的共识图的每条边和每个节点的权重为：；式中，为新的共识图中边或节点i的权重，/＞为初始图j所对应的权重，/＞为初始图j中边或节点i的权重。进一步地，对原始BNN进行权重更新后利用相似性计算进行阈值处理，包括：利用交叉熵损失函数对原始BNN进行权重更新，得到新的BNN；计算新的BNN中各节点和边与原始BNN的相似度，根据设定的相似度阈值删去低于阈值的边或节点；其中，交叉熵损失函数和权重更新公式为：；；式中，为真实标签，/＞为预测输出，/＞和/＞为新、旧权重，/＞为学习率，g为损失函数对权重的梯度；新的BNN中各节点和边与原始BNN的相似度的计算公式为：；；式中，为边i的相似度，/＞和/＞为边i的新旧权重，/＞与/＞为与边i相连的节点的新、旧权重；/＞为节点j的相似度，/＞和/＞为节点j的新、旧权重，/＞和/＞为与节点j相连的边的新、旧权重。进一步地，利用相似性计算对需要重放的事件进行经验重放，包括：对于每一组BNN1、BNN2…BNNn，计算BNN1、BNN2…BNNn分别与原始BNN的相似度并排序，选取相似度满足设定阈值的若干BNNi，将若干BNNi对应的事件存入预设的重放池并加至对应事件流的末尾；在若干BNNi对应的事件存入重放池时，将若干BNNi对应的相似度与已存入重放池的事件对应的相似度进行排序并选取较高相似度的事件存入，更新重放池并维持重放池内存入事件的数目不变；其中，BNN1、BNN2…BNNn分别与原始BNN的相似度的计算公式为：；；式中，为BNNk与原始BNN的相似度，/＞为边i的相似度，/＞为节点j的相似度，n、m分别为边与节点的总数。本发明还提供一种基于脑图的低遗忘热点事件预测装置，包括：预测模块，用于将待预测的社交网络热点事件流输入构建好的BNN模型，利用构建好的BNN模型预测事件后续发展；其中，BNN模型的构建包括：提取推理预测的三个脑区fMRI成像；将三个脑区fMRI成像转化为脑图网络并融合，得到融合图；将融合图中节点替换为神经元模型，得到原始BNN；以一个事件流为一批次地分批次将若干个事件流中事件逐个输入原始BNN，每一批次均对原始BNN进行权重更新后利用相似性计算进行阈值处理，得到若干组BNN1、BNN2…BNNn；将若干组BNN1、BNN2…BNNn相继融合，并利用相似性计算对需要重放的事件进行经验重放，得到构建好的BNN模型。本发明还提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现所述基于脑图的低遗忘热点事件预测方法的步骤。本发明还提供一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现所述基于脑图的低遗忘热点事件预测方法的步骤。与现有技术相比，本发明所达到的有益效果：本发明针对传统防遗忘方法的改进，考虑到灾难性遗忘的本质在于对之前学习的内容的遗忘，参考人脑的工作原理并结合了动态架构中的渐进网络，缓解在进行社交网络热点事件的预测时随着时间的推移与事件流的不断输入从而引起灾难性遗忘，提高对热点事件预测的准确率；通过“重放池”解决了传统经验重放方法中占用过多储存空间的问题；新的图融合算法的设计提高了图融合的合理性。附图说明图1是本发明实施例提供的一种基于脑图的低遗忘热点事件预测方法的流程图；图2是本发明实施例提供的一种基于脑图的低遗忘热点事件预测方法中步骤40的流程图；图3是本发明实施例提供的一种基于脑图的低遗忘热点事件预测方法采用的共识迭代算法的流程图。具体实施方式下面结合附图对本发明作进一步描述。以下实施例仅用于更加清楚地说明本发明的技术方案，而不能以此来限制本发明的保护范围。实施例如图1所示，本实施例提供一种基于脑图的低遗忘热点事件预测方法，包含以下步骤：步骤10：提取推理预测的三个脑区fMRI成像，将三个脑区fMRI成像转化为脑图网络。提取大脑推理预测过程中的前提加工阶段，前提整合阶段与验证阶段的三部分脑区的fMRI成像，构建功能脑区。在脑区fMRI成像中，空间上的每个体素可以被分配到特定的脑区域，这些区域可以被称为“标签”，而在数据处理中，我们需要将这些标签转化为二进制的掩模，以便从脑区fMRI成像中抽取对应区域的信号。对于每个体素vin图像：如果v的标签值等于我们感兴趣的脑区域的标签值，该体素在掩模中的对应位置标记为 1，否则该体素在掩模中的对应位置标记为 0；如果掩膜中的值为 1，表示该体素或时间点属于感兴趣的区域，我们可以保留对应的数据，反之舍弃。对每个保留数据区域内的体素信号进行求均值，得到代表该区域的时间序列信号即时序数据。将时序数据输入Shrinkage协方差估计器构建协方差矩阵。计算时序数据的样本协方差矩阵：其中，n为时序数据的样本数量，是第i个样本，/＞是样本均值。构建Shrinkage协方差矩阵： 其中，为Shrinkage协方差矩阵，/＞为一个平滑参数，S为样本数据的协方差矩阵，D为一个对角矩阵，其非对角元素为0，对角线上的元素为：/＞，p是矩阵S的维数。将Shrinkage协方差矩阵转化为相关性系数矩阵： 其中，和/＞为变量i和变量j的标准差，/＞为相关性系数矩阵的元素取值范围为且/＞。当的绝对值大于0.5时，我们认为节点i与节点j有联系，以构建功能脑区网络。绘图空间上两个大脑区域之间的几何距离近似于它们之间的最短路径长度。使用Kamada-Kawai布局算法将功能脑区网络可视化，以求得到脑图网络的拓扑结构。Kamada-Kawai布局算法是受弹簧的弹性势能启发，通过使整个功能脑区网络系统的能量最小得到脑图网络的拓扑结构。使用二维Newton-Raphson方法对脑区fMRI成像中所选节点m求单个功能脑区网络系统能量的最小值。单个功能脑区网络系统能量计算公式为： 其中，x与y为功能脑区网络节点的坐标，k为设置的常数，l为长度与平衡状态的差值。当的处于局部最小值时，/＞和/＞的偏导数都为0，如下： 和/＞的偏导数如下：  根据上述公式计算局部最小值。当梯度最大值小于设定阈值时，得到单个功能脑区网络系统能量/＞的最小值，梯度最大值/＞的计算公式如下： 通过上述局部最小值检验梯度最大值/＞下得到的/＞的最小值是否为极小的。在单个功能脑区网络系统能量极小下求得x、y参数，使用得到的x、y参数绘制出脑图网络。步骤20：利用共识迭代算法完成步骤10中三张脑图网络的融合，得到融合图；方法流程与下述步骤50相同，详见步骤50。步骤30：利用自适应指数积分-发放模型将融合图中节点替换为神经元模型，得到原始BNN。将自适应指数积分-发放模型引入，这是一种用于描述神经元电活动的模型，它是对传统的指数积分-发放模型的扩展，引入了自适应性机制以更好地模拟神经元的行为，其方程通常表示如下： 其中，V是神经元的膜电位，是静息膜电位，R是膜电阻，I是输入电流，/＞是膜时间常数，/＞是阈值电位，/＞是跨膜电位敏感性， /＞是自适应电流成分。步骤40：如图2所示，分批次将若干个事件流中事件逐个输入原始BNN，每一批次均对原始BNN进行权重更新后利用相似性计算进行阈值处理，得到若干组BNN1、BNN2…BNNn。构造如下交叉熵损失函数，随后更新损失参数：  其中，为真实标签，/＞为网络的预测输出，/＞和/＞是新、旧权重，/＞是学习率，g是损失函数对权重的梯度。利用上述交叉损失函数对原始BNN更新权重得到新的BNN之后，将新的BNN与原始BNN进行对比，即计算新的BNN中各节点以及各边与原始BNN的相似度，根据设定的相似度阈值下限，删去低于阈值的边或节点，边与节点的相似度计算公式如下：  其中，为边i的相似度，/＞和/＞为边i的新旧权重，/＞与/＞为与边i相连的节点的新、旧权重；/＞为节点j的相似度，/＞和/＞为节点j的新、旧权重，/＞和/＞为与节点j相连的边的新旧权重。步骤50：利用共识迭代算法的图融合方法将若干组BNN1、BNN2…BNNn相继融合。对于每一组BNN1、BNN2…BNNn的融合，是将BNN1与BNN2进行融合，得到BNN1*；再将得到的BNN1*与BNN3进行融合，得到BNN2*，以此类推得到BNNn-1*；而对于不同组BNN1、BNN2…BNNn的融合，是将上一组融合得到的BNNn-1*与下一组的BNN1进行融合，以此类推完成若干组BNN1、BNN2…BNNn相继融合。使用共识迭代算法，针对每一对待融合图，通过并集处理得到共识图，随后通过每一张待融合图与共识图之间的相似度，对每一张待融合图分别分配其权重；通过上述权重再次对两张待融合图做并集处理，从而得到新的共识图；如此迭代K次，得到最终共识图；对最终共识图做阈值处理，得到融合图。如图3所示，具体包括以下步骤：步骤501：对初始图做并集处理，得到共识图： 其中，为共识图，/＞为初始图。步骤502：计算每张初始图与共识图之间的相似度，计算公式如下： 其中，为初始图i的相似度，/＞与/＞为初始图i的边与节点，/＞与/＞为共识图的边与节点，a为设定好的初始图与共识图每条边与每条节点的初始权重，为常数。根据上述计算出的相似度，分配每张初始图所对应的权重： 其中，为初始图的权重，/＞为初始图的相似度之和。步骤503：通过上述权重，再次对初始图进行并集处理并融合出新的共识图，对于新的共识图的每条边与每个节点，有： 其中，为新的共识图中边或节点i的权重，/＞为初始图j所对应的权重，/＞为初始图j中边或节点i的权重。步骤504：重复步骤502与步骤503，直至达到设定的迭代次数K，得到最终共识图。步骤505：通过设定的边与节点的阈值，将最终共识图权重低于阈值的边与节点抹除，得到融合图。步骤60：利用相似性计算对需要重放的事件进行经验重放，得到构建好的BNN模型。对于每一组BNN1、BNN2…BNNn，利用步骤40中节点与边的相似度计算公式依次计算BNN1与原始BNN的相似度、BNN2与原始BNN的相似度…BNNn与原始BNN的相似度，即： 其中，为BNNk与原始BNN的相似度，/＞为边i的相似度，/＞为节点j的相似度，n、m分别为边与节点的总数。在进行上述求和时，考虑到减弱单个节点或边的相似度对全局的影响，构建如下映射函数：；即： 。对于每一组BNN1、BNN2…BNNn，对上述n个相似度进行排序，选取相似度较高对应的若干BNNi，对若干BNNi所对应的若干事件进行经验重放，即将若干BNNi对应的事件存入预先准备的“重放池”，再将“重放池”中的事件加到事件流的末尾；每当若干BNNi对应的事件存入“重放池”时，将若干BNNi对应的相似度与已存入“重放池”的事件对应的相似度进行排序并选取较高相似度的事件存入，更新“重放池”并维持“重放池”内存入事件的数目不变。步骤70：通过步骤50和步骤60得到构建好的BNN模型，再将待预测的社交网络热点事件流输入构建好的BNN模型，利用构建好的BNN模型预测事件后续发展。综上，本发明针对传统防遗忘方法的改进，考虑到灾难性遗忘的本质在于对之前学习的内容的遗忘，参考人脑的工作原理并结合了动态架构中的渐进网络，缓解在进行社交网络热点事件的预测时随着时间的推移与事件流的不断输入从而引起灾难性遗忘，提高对热点事件预测的准确率；通过“重放池”解决了传统经验重放方法中占用过多储存空间的问题；新的图融合算法的设计提高了图融合的合理性。
