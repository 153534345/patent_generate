标题title
一种风速反演方法、系统、存储介质及设备
摘要abst
本发明公开了一种风速反演方法、系统、存储介质及设备，本发明将激光雷达回波进行单比特采样，在对应总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换将单比特采样数据转化成频谱，从而进行风速反演，并且通过前面反演周期的总功率谱峰值频率收窄后面反演周期计算的频率区间，可大大降低风速反演所需的计算量，降低了计算资源的消耗。
权利要求书clms
1.一种风速反演方法，其特征在于，包括：对Tj,m,i内的回波进行单比特采样；其中，Tj,m,i为第j次反演周期中第m束激光的第i个回波时间窗；在预估的Tj,i对应的总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱；其中，Tj,i为第j次反演周期的第i个回波时间窗，Tj,i对应的功率谱峰值频率范围根据Tj-1,i和Tj-2,i内的总功率谱峰值频率预估；Tj-1,i和Tj-2,i分别为第j-1次反演周期和第j-2次反演周期的第i个回波时间窗，反演周期中第i个回波时间窗的总功率谱为反演周期中所有激光的第i个回波时间窗内的功率谱累加；将Tj,m,i内的频谱转换成功率谱，根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演。2.根据权利要求1所述的风速反演方法，其特征在于，在进行基于方波基底的快速傅里叶变换之前，还包括将单比特采样数据中的0转化为-1。3.根据权利要求1所述的风速反演方法，其特征在于，基于方波基底的快速傅里叶变换为：采用函数sq_exp替换函数exp进行快速傅里叶变换；其中，sq_exp= sq_cos+ jsq_sin；函数；函数；式中，x为自变量。4.根据权利要求1所述的风速反演方法，其特征在于，根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演，包括：根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，获得Tj,i内的总功率谱；根据Tj,i内的总功率谱，在风速范围内查找Tj,i内的总功率谱峰值频率；根据Tj,i内的总功率谱峰值频率，计算功率谱频移；根据功率谱频移和激光波长，计算Tj,i内的风速在激光方向上的速度分量。5.根据权利要求1所述的风速反演方法，其特征在于，Tj,i对应的总功率谱峰值频率范围为；其中，fj-1,i为Tj-1,i内的总功率谱峰值频率，df为调节参数，df=max{dfmin，q|fj-1,i- fj-2,i|}，q为常数，dfmin为df的最小值，fj-2,i为Tj-2,i内的总功率谱峰值频率。6.一种风速反演系统，其特征在于，包括：采样模块，对Tj,m,i内的回波进行单比特采样；其中，Tj,m,i为第j次反演周期中第m束激光的第i个回波时间窗；基于方波基底的快速傅里叶变换模块，在预估的Tj,i对应的总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱；其中，Tj,i为第j次反演周期的第i个回波时间窗，Tj,i对应的功率谱峰值频率范围根据Tj-1,i和Tj-2,i内的总功率谱峰值频率预估；Tj-1,i和Tj-2,i分别为第j-1次反演周期和第j-2次反演周期的第i个回波时间窗，反演周期中第i个回波时间窗的总功率谱为反演周期中所有激光的第i个回波时间窗内的功率谱累加；反演模块，将Tj,m,i内的频谱转换成功率谱，根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演。7.根据权利要求6所述的风速反演系统，其特征在于，基于方波基底的快速傅里叶变换模块中，基于方波基底的快速傅里叶变换为：采用函数sq_exp替换函数exp进行快速傅里叶变换；其中，sq_exp= sq_cos+ jsq_sin；函数；函数；式中，x为自变量。8.根据权利要求6所述的风速反演系统，其特征在于，基于方波基底的快速傅里叶变换模块中，Tj,i对应的总功率谱峰值频率范围为；其中，fj-1,i为Tj-1,i内的总功率谱峰值频率，df为调节参数，df=max{dfmin，q|fj-1,i- fj-2,i|}，q为常数，dfmin为df的最小值，fj-2,i为Tj-2,i内的总功率谱峰值频率。9.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储一个或多个程序，所述一个或多个程序包括指令，所述指令当由计算设备执行时，使得所述计算设备执行权利要求1~5所述的任一方法。10.一种计算机设备，其特征在于，包括：一个或多个处理器、以及一个或多个存储器，一个或多个程序存储在所述一个或多个存储器中并被配置为由所述一个或多个处理器执行，所述一个或多个程序包括用于执行权利要求1~5所述的任一方法的指令。
说明书desc
技术领域本发明涉及一种风速反演方法、系统、存储介质及设备，属于多普勒测风激光雷达领域。背景技术风的精确观测在环境、军事、航空航天、气象等领域具有重大应用价值，多普勒测风激光雷达在测量范围与精度上有着其它测风手段难以比拟的优势，多普勒效应是其测量风速的基本原理。激光雷达出射的激光脉冲与大气中的粒子作用产生后向散射，粒子在激光方向上的速度分量使得后向散射的回波产生多普勒频移，通过提取多普勒频移信息，可以反演获得风速。提取有效的多普勒频谱信息对实现风速反演有着重要意义，激光雷达通常将时域信号转化成频域信号，从而得到多普勒频移信息来进行后续的分析处理。时频转换的传统方法是对信号做快速傅里叶变换，尽管快速傅里叶变换相较于离散傅里叶变换计算量更少，但计算量依然十分庞大，需消耗大量计算资源。发明内容本发明提供了一种风速反演方法、系统、存储介质及设备，解决了背景技术中披露的问题。为了解决上述技术问题，本发明所采用的技术方案是：一种风速反演方法，包括：对Tj,m,i内的回波进行单比特采样；其中，Tj,m,i为第j次反演周期中第m束激光的第i个回波时间窗；在预估的Tj,i对应的总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱；其中，Tj,i为第j次反演周期的第i个回波时间窗，Tj,i对应的功率谱峰值频率范围根据Tj-1,i和Tj-2,i内的总功率谱峰值频率预估；Tj-1,i和Tj-2,i分别为第j-1次反演周期和第j-2次反演周期的第i个回波时间窗，反演周期中第i个回波时间窗的总功率谱为反演周期中所有激光的第i个回波时间窗内的功率谱累加；将Tj,m,i内的频谱转换成功率谱，根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演。在进行基于方波基底的快速傅里叶变换之前，还包括将单比特采样数据中的0转化为-1。基于方波基底的快速傅里叶变换为：采用函数sq_exp替换函数exp进行快速傅里叶变换；其中，sq_exp= sq_cos+ jsq_sin ；函数；函数；式中，x为自变量。根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演，包括：根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，获得Tj,i内的总功率谱；根据Tj,i内的总功率谱，在风速范围内查找Tj,i内的总功率谱峰值频率；根据Tj,i内的总功率谱峰值频率，计算功率谱频移；根据功率谱频移和激光波长，计算Tj,i内的风速在激光方向上的速度分量。Tj,i对应的总功率谱峰值频率范围为；其中，fj-1,i为Tj-1,i内的总功率谱峰值频率，df为调节参数，df=max{dfmin，q|fj-1,i-fj-2,i|}，q为常数，dfmin为df的最小值，fj-2,i为Tj-2,i内的总功率谱峰值频率。一种风速反演系统，包括：采样模块，对Tj,m,i内的回波进行单比特采样；其中，Tj,m,i为第j次反演周期中第m束激光的第i个回波时间窗；基于方波基底的快速傅里叶变换模块，在预估的Tj,i对应的总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱；其中，Tj,i为第j次反演周期的第i个回波时间窗，Tj,i对应的功率谱峰值频率范围根据Tj-1,i和Tj-2,i内的总功率谱峰值频率预估；Tj-1,i和Tj-2,i分别为第j-1次反演周期和第j-2次反演周期的第i个回波时间窗，反演周期中第i个回波时间窗的总功率谱为反演周期中所有激光的第i个回波时间窗内的功率谱累加；反演模块，将Tj,m,i内的频谱转换成功率谱，根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演。基于方波基底的快速傅里叶变换模块中，基于方波基底的快速傅里叶变换为：采用函数sq_exp替换函数exp进行快速傅里叶变换；其中，sq_exp= sq_cos+ jsq_sin ；函数；函数；式中，x为自变量。基于方波基底的快速傅里叶变换模块中，Tj,i对应的总功率谱峰值频率范围为；其中，fj-1,i为Tj-1,i内的总功率谱峰值频率，df为调节参数，df=max{dfmin，q|fj-1,i-fj-2,i|}，q为常数，dfmin为df的最小值，fj-2,i为Tj-2,i内的总功率谱峰值频率。一种计算机可读存储介质，所述计算机可读存储介质存储一个或多个程序，所述一个或多个程序包括指令，所述指令当由计算设备执行时，使得所述计算设备执行风速反演方法。一种计算机设备，包括一个或多个处理器、以及一个或多个存储器，一个或多个程序存储在所述一个或多个存储器中并被配置为由所述一个或多个处理器执行，所述一个或多个程序包括用于执行风速反演方法的指令。本发明所达到的有益效果：本发明将激光雷达回波进行单比特采样，在对应总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换将单比特采样数据转化成频谱，从而进行风速反演，并且通过前面反演周期的总功率谱峰值频率收窄后面反演周期计算的频率区间，可大大降低风速反演所需的计算量，降低了计算资源的消耗。附图说明图1为风速反演方法的流程图。具体实施方式下面结合附图对本发明作进一步描述。以下实施例仅用于更加清楚地说明本发明的技术方案，而不能以此来限制本发明的保护范围。如图1所示，一种风速反演方法，包括以下步骤：步骤1，对Tj,m,i内的回波进行单比特采样；其中，Tj,m,i为第j次反演周期中第m束激光的第i个回波时间窗。步骤2，在预估的Tj,i对应的总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱；其中，Tj,i为第j次反演周期的第i个回波时间窗，Tj,i对应的功率谱峰值频率范围根据Tj-1,i和Tj-2,i内的总功率谱峰值频率预估；Tj-1,i和Tj-2,i分别为第j-1次反演周期和第j-2次反演周期的第i个回波时间窗，反演周期中第i个回波时间窗的总功率谱为反演周期中所有激光的第i个回波时间窗内的功率谱累加。步骤3，将Tj,m,i内的频谱转换成功率谱，根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演。上述方法将激光雷达回波进行单比特采样，在对应总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换将单比特采样数据转化成频谱，从而进行风速反演，并且通过前面反演周期的总功率谱峰值频率收窄后面反演周期计算的频率区间，可大大降低风速反演所需的计算量，降低了计算资源的消耗。多普勒测风激光雷达出射一束激光后，激光与不同距离处的粒子作用产生回波，距离越远的粒子，回波到达激光雷达的时间越晚，因此将一束激光出射后接收回波的时间划分成若干个回波时间窗。在一个反演周期中往往发射多束激光，每束激光的回波时间窗数量一致，时间窗的时间跨度是一致，根据不同激光的回波时间窗内的回波，进行风速反演。每个回波时间窗内，在反演时，需要先将采样的数据转换成频谱，然后进一步将频谱转化为功率谱，通过累加的方式获得具有足够信噪比的总功率谱，进而反演风速。传统的数据采样使用的是高精度采样，并且采用多比特采样电路，为了简化后续计算和电路，可将数据由传统的高精度采样数据替换为单比特数据，即对Tj,m,i内的回波进行单比特采样，Tj,m,i为第j次反演周期中第m束激光的第i个回波时间窗，这不仅可以使得激光雷达回波的采样电路由多比特采样电路简化成单比特采样电路。由于单比特数据的值为0或1，其均值为0.5，这会导致计算得到的频谱中低频部分受到影响。因此，在进行频谱转化之前，可将单比特采样数据中的0转化为-1，然后用1和-1组成的数据序列进行后续计算。假设某个回波时间窗对应的激光雷达回波被采样，并进行适当的预处理后为x，n=0,1,…,N-1，N=2L，L为正整数，x是第n个预处理后的采样数据，N是回波时间窗内预处理后的采样数据的总个数，若采用离散傅里叶变换对x进行时频转换，则转换得到的频谱数据X为：；式中，k=0,1,…,N-1，X为复数，将X的实部和虚部求平分和即可获得功率谱P。由于离散傅里叶变换计算量较大，可以采用快速傅里叶变换替换，从而节省大量的运算，但是在快速傅里叶变换中仍然需要使用这样的高精度复数参数，这仍会造成巨大的计算量，因此根据欧拉公式：exp= cos+ jsq_sin由于的实部和虚部均为三角函数，为了简化计算，令：方波余弦函数；方波正弦函数；其中，函数sq_exp= sq_cos+ jsq_sin，x为自变量。因此本发明采用函数sq_exp替换指数函数exp进行快速傅里叶变换，即采用基于方波基底的快速傅里叶变换进行单比特采样数据转化，如此项被1或-1替换，可大大降低计算复杂度。基于方波基底的快速傅里叶变换得到每个频谱都是一个复数，将复数的实部和虚部做平方和计算，即可将频谱转化为功率谱。由于单个激光脉冲的回波信号较为微弱，对于每个反演周期，需要将多个激光脉冲得到的功率谱做累加，来得到具有足够信噪比的总功率谱，具体可以将第j次反演周期中所有束激光的第i个回波时间窗内的功率谱进行累加，获得Tj,i内的总功率谱。累加结束后，可根据Tj,i内的总功率谱，在风速范围内查找Tj,i内的总功率谱峰值频率，根据Tj,i内的总功率谱峰值频率，计算与风速相对应的功率谱频移，根据功率谱频移和激光波长，计算Tj,i内的风速在激光方向上的速度分量，公式可以如下：v=λ△f/2式中，v为风速在激光方向上的速度分量，λ为激光波长，上述风速范围可以是-30米/秒~+30米/秒。为了进一步降低功率谱计算所需的计算量，本发明在通过累加得到一个具有距离分辨的总功率谱后，除了计算风速外，还根据上两个反演周期同一时间窗内的总功率谱峰值频率，预估下一个周期同一时间窗内的总功率谱峰值频率的可能范围，这样在接下来的频谱计算中，收窄计算的频率区间，即不再将X到X都计算一遍，而是只计算范围覆盖部分，从而免除不必要的频谱计算，可以极大地减少激光回波信号时频转换所需的计算量。确定预估功率谱峰值频率可能范围的过程可以如下：定义Tj,i为第j次反演周期的第i个回波时间窗， Tj-1,i和Tj-2,i分别为第j-1次反演周期和第j-2次反演周期的第i个回波时间窗，Tj-1,i内的总功率谱峰值频率为fj-1,i，Tj-2,i内的总功率谱峰值频率为fj-2,i，那么Tj,i对应的总功率谱峰值频率范围为，在计算是仅需计算该范围内的X，范围之外的则不需要计算，通过该方法，频谱计算的频率范围可以自适应地调整；其中，df为调节参数，根据测风的情况进行调节，以确保在减少计算量的同时不会导致功率谱峰值频率未被覆盖；df=max{dfmin，q|fj-1,i-fj-2,i|}，q为常数，通常在1~3之间，dfmin为df的最小值。经过上述分析，以Tj,i为例，上述风速反演方法的具体过程可以如下：1）对Tj,m,i内的激光雷达回波进行单比特采样，并将单比特采样数据中的0转化为-1。2）若当前反演周期j为第一个周期或第二个周期，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱；若当前反演周期j不是第一个周期或第二个周期，根据Tj-1,i和Tj-2,i内的总功率谱峰值频率预估Tj,i对应的功率谱峰值频率范围，在Tj,i对应的功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱。3）将Tj,m,i内的频谱转化为功率谱，并将反演周期j中所有激光的第i个回波时间窗内的功率谱累加，获得Tj,i内的总功率谱，根据Tj,i内的总功率谱，在风速范围内查找Tj,i内的总功率谱峰值频率。4）根据Tj,i内的总功率谱峰值频率，计算功率谱频移，根据功率谱频移和激光波长，计算Tj,i内的风速在激光方向上的速度分量。基于相同的技术方案，本发明还公开了上述方法的软件系统，一种风速反演系统，包括：采样模块，对Tj,m,i内的回波进行单比特采样；其中，Tj,m,i为第j次反演周期中第m束激光的第i个回波时间窗。基于方波基底的快速傅里叶变换模块，在预估的Tj,i对应的总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换，将Tj,m,i内的单比特采样数据转化成频谱；其中，Tj,i为第j次反演周期的第i个回波时间窗，Tj,i对应的功率谱峰值频率范围根据Tj-1,i和Tj-2,i内的总功率谱峰值频率预估；Tj-1,i和Tj-2,i分别为第j-1次反演周期和第j-2次反演周期的第i个回波时间窗，反演周期中第i个回波时间窗的总功率谱为反演周期中所有激光的第i个回波时间窗内的功率谱累加。基于方波基底的快速傅里叶变换模块中，基于方波基底的快速傅里叶变换为：采用函数sq_exp函数替换函数exp进行快速傅里叶变换；其中，sq_exp= sq_cos+ jsq_sin ；函数；函数；式中，x为自变量。基于方波基底的快速傅里叶变换模块中，Tj,i对应的总功率谱峰值频率范围为；其中，fj-1,i为Tj-1,i内的总功率谱峰值频率，df为调节参数，df=max{dfmin，q|fj-1,i-fj-2,i|}，q为常数，dfmin为df的最小值，fj-2,i为Tj-2,i内的总功率谱峰值频率。反演模块，将Tj,m,i内的频谱转换成功率谱，根据第j次反演周期中各束激光的第i个回波时间窗内的功率谱，进行Tj,i内风速反演。上述系统将激光雷达回波进行单比特采样，在对应总功率谱峰值频率范围内，采用基于方波基底的快速傅里叶变换将单比特采样数据转化成频谱，从而进行风速反演，并且通过前面反演周期的总功率谱峰值频率收窄后面反演周期计算的频率区间，可大大降低风速反演所需的计算量，降低了计算资源的消耗。基于相同的技术方案，本发明还公开了一种计算机可读存储介质，所述计算机可读存储介质存储一个或多个程序，所述一个或多个程序包括指令，所述指令当由计算设备执行时，使得所述计算设备执行风速反演方法。基于相同的技术方案，本发明还公开了一种计算机设备，包括一个或多个处理器、以及一个或多个存储器，一个或多个程序存储在所述一个或多个存储器中并被配置为由所述一个或多个处理器执行，所述一个或多个程序包括用于执行风速反演方法的指令。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明是参照根据本发明实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。以上仅为本发明的实施例而已，并不用于限制本发明，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均包含在申请待批的本发明的权利要求范围之内。
