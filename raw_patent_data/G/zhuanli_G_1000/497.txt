标题title
组网卫星光学载荷辐射一致性校正方法、装置和电子设备
摘要abst
本发明提供了一种组网卫星光学载荷辐射一致性校正方法、装置和电子设备。该方法包括：根据通道定标系数、像元的计数值，计算辐亮度观测值；根据辐亮度观测值对基准影像和待校准影像进行空间匹配和光谱匹配，计算再定标系数；根据再定标系数对待校准影像的辐亮度进行校正，得到经再定标后的辐亮度；根据基准影像的辐亮度和待校准影像的经再定标后的辐亮度得到地表反射率；根据基准影像和待校准影像的重叠区域生成唯一像素值列表和参考像素值列表；对唯一像素值列表和参考像素值列表中的像素值进行局部加权拟合得到拟合曲线，以通过拟合曲线对待校准影像的像素值进行更新得到经基准影像校正后的影像。
权利要求书clms
1.一种组网卫星光学载荷辐射一致性校正方法，其特征在于，包括：针对基准参考载荷和每个待校准载荷，根据通道定标系数、基准影像和待校准影像中每个像元的计数值，计算得到与每个所述像元对应的辐亮度观测值，其中，所述基准影像是从所述基准参考载荷过境目标区域得到的影像中筛选得到的，所述待校准影像是从所述待校准载荷过境所述目标区域得到的影像中筛选得到的；根据所述基准影像和所述待校准影像中每个像元的辐亮度观测值，对所述基准影像和所述待校准影像进行空间匹配和光谱匹配，计算得到与所述待校准载荷对应的再定标系数；根据与组网卫星中的待校准载荷对应的再定标系数，对与所述待校准载荷对应的全部待校准影像中每个像元的辐亮度进行校正，得到与每个所述像元对应的经再定标后的辐亮度；根据所述基准影像中每个像元的辐亮度和所述待校准影像中每个像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对所述待校准影像和所述基准影像的地表反射率进行角度归一化和映射处理，得到每个所述像元的像素值；根据所述基准影像和所述待校准影像的重叠区域，生成与所述待校准影像对应的唯一像素值列表和与所述基准影像对应的参考像素值列表；以及对所述唯一像素值列表和所述参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过所述拟合曲线对所述待校准影像中每个像元的像素值进行更新，得到经所述基准影像辐射一致性校正后的待校准影像。2.根据权利要求1所述的方法，其特征在于，还包括：根据长时间序列的卫星无云影像和大气再分析资料数据，确定满足区域约束条件的多个所述目标区域；针对每个所述目标区域，对所述基准参考载荷和每个所述待校准载荷过境所述目标区域的影像进行筛选，得到满足云量约束条件的影像；以及根据获取到的所述目标区域与所述基准参考载荷、每个所述待校准载荷之间的观测几何信息，筛选得到满足观测约束条件的影像子集，其中，所述影像子集包括与所述基准参考载荷对应的所述基准影像和与多个所述待校准载荷对应的所述待校准影像。3.根据权利要求2所述的方法，其特征在于，所述根据所述基准影像和所述待校准影像中每个像元的辐亮度观测值，对所述基准影像和所述待校准影像进行空间匹配和光谱匹配，计算得到与所述待校准载荷对应的再定标系数，包括：将所述影像子集中每对所述基准影像和所述待校准影像中空间分辨率最高的影像确定为第一影像，将所述基准影像和所述待校准影像中空间分辨率最低的影像确定为第二影像；根据所述第一影像和所述第二影像的空间分辨率，确定所述第一影像中与所述第二影像中每个像元对应的目标像元区域；针对每个所述目标像元区域，根据所述目标像元区域中每个像元的辐亮度观测值，得到与所述目标像元区域对应的校正辐亮度；利用模拟辐亮度，根据与每个所述目标区域对应的所述第一影像中每个所述目标像元区域的校正辐亮度和所述第二影像中每个像元的辐亮度观测值，得到与所述待校准载荷对应的再定标系数。4.根据权利要求3所述的方法，其特征在于，所述利用模拟辐亮度，根据与每个所述目标区域对应的所述第一影像中每个所述目标像元区域的校正辐亮度和所述第二影像中每个像元的辐亮度观测值，得到与所述待校准载荷对应的再定标系数，包括：根据与所述基准参考载荷和所述待校准载荷各自对应的模拟辐亮度和光谱响应函数，计算得到光谱匹配因子；根据所述基准影像中每个像元的辐亮度和所述光谱匹配因子，计算得到所述待校准影像中每个像元的辐亮度理论真值；以及根据与每个所述目标区域对应的所述待校准影像中每个像元的辐亮度理论真值和辐亮度，计算得到所述再定标系数。5.根据权利要求1所述的方法，其特征在于，所述根据所述基准影像中每个像元的辐亮度和所述待校准影像中每个像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对所述待校准影像和所述基准影像的地表反射率进行角度归一化和映射处理，得到每个所述像元的像素值，包括：从大气再分析资料数据中分别获取所述基准参考载荷和所述待校准载荷过境所述目标区域的环境参数；根据与所述基准参考载荷对应的环境参数和所述基准影像中每个像元的辐亮度，反演得到所述基准影像中每个像元的地表反射率；根据与所述待校准载荷对应的环境参数和所述待校准影像中每个像元的经再定标后的辐亮度，反演得到所述待校准影像中每个像元的地表反射率；以及对所述基准影像和所述待校准影像中每个像元的地表反射率进行角度归一化处理和映射处理，得到所述基准影像和所述待校准影像中每个像元的像素值。6.根据权利要求5所述的方法，其特征在于，所述对所述基准影像和所述待校准影像中每个像元的地表反射率进行角度归一化处理和映射处理，得到所述基准影像和所述待校准影像中每个像元的像素值，包括：根据所述基准参考载荷与所述目标区域之间的观测角度信息，计算得到与所述基准参考载荷对应的二向反射因子；根据所述待校准载荷与所述目标区域之间的观测角度信息，计算得到与所述待校准载荷对应的二向反射因子；根据与所述基准参考载荷对应的二向反射因子和与所述待校准载荷对应的二向反射因子，得到角度转换系数；根据所述角度转换系数和所述待校准影像中每个像元的地表反射率，得到与所述待校准影像中每个像元对应的经角度归一化处理后的地表反射率；将与所述待校准影像中每个像元对应的经角度归一化处理后的地表反射率映射到目标像素值区间，得到所述待校准影像中每个像元的像素值；以及将所述基准影像中每个像元的地表反射率映射到所述目标像素值区间，得到所述基准影像中每个像元的像素值。7.根据权利要求1所述的方法，其特征在于，所述根据所述基准影像和所述待校准影像的重叠区域，生成与所述待校准影像对应的唯一像素值列表和与所述基准影像对应的参考像素值列表，包括：将所述待校准影像的重叠区域中每个像元的像素值进行去重处理，得到唯一像素值集合；针对所述唯一像素值集合中的每个唯一像素值，从所述待校准影像的重叠区域中确定像素值为所述唯一像素值的像元的位置信息；根据所述唯一像素值集合中的每个所述唯一像素值和与所述唯一像素值对应的像元的位置信息，生成所述唯一像素值列表；针对所述唯一像素值列表中的每个所述唯一像素值，根据与所述唯一像素值对应的像元的位置信息，确定所述基准影像的重叠区域中与所述位置信息对应的像元的像素值；根据所述基准影像的重叠区域中与所述位置信息对应的像元的像素值，得到与每个所述唯一像素值对应的参考像素值；基于得到的多个所述参考像素值，生成所述参考像素值列表。8.根据权利要求1所述的方法，其特征在于，所述对所述唯一像素值列表和所述参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过所述拟合曲线对所述待校准影像中每个像元的像素值进行更新，得到经所述基准影像辐射一致性校正后的待校准影像，包括：以所述唯一像素值列表中的唯一像素值为第一坐标，以所述参考像素值列表中与所述唯一像素值对应的参考像素值为第二坐标，得到多个数据点；将所述多个数据点按照区间宽度进行划分，得到多个区间；针对每个所述区间，对所述区间中的数据点进行多项式拟合，得到与所述区间对应的回归曲线；基于与所述每个区间对应的回归曲线，得到所述拟合曲线；根据所述拟合曲线，对所述待校准影像中每个像元的像素值进行更新，得到新的待校准影像；以及将所述新的待校准影像中每个像元的像素值转换成地表反射率，得到经所述基准影像辐射一致性校正后的待校准影像。9.一种组网卫星光学载荷辐射一致性校正装置，其特征在于，包括：计算模块，用于针对基准参考载荷和每个待校准载荷，根据通道定标系数、基准影像和待校准影像中每个像元的计数值，计算得到与每个所述像元对应的辐亮度观测值，其中，所述基准影像是从所述基准参考载荷过境所述目标区域得到的影像中筛选得到的，所述待校准影像是从所述待校准载荷过境所述目标区域得到的影像中筛选得到的；匹配模块，用于根据所述基准影像和所述待校准影像中每个像元的辐亮度观测值，对所述基准影像和所述待校准影像进行空间匹配和光谱匹配，得到与所述待校准载荷对应的再定标系数；校正模块，用于根据与组网卫星中的待校准载荷对应的再定标系数，对与所述待校准载荷对应的全部待校准影像中每个像元的辐亮度进行校正，得到与每个所述像元对应的经再定标后的辐亮度；获得模块，用于根据所述基准影像中每个像元的辐亮度和所述待校准影像中每个像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对所述待校准影像和所述基准影像的地表反射率进行角度归一化和映射处理，得到每个所述像元的像素值；生成模块，用于根据所述基准影像和所述待校准影像的重叠区域，生成与所述待校准影像对应的唯一像素值列表和与所述基准影像对应的参考像素值列表；以及拟合模块，用于对所述唯一像素值列表和所述参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过所述拟合曲线对所述待校准影像中每个像元的像素值进行更新，得到经所述基准影像辐射一致性校正后的待校准影像。10.一种电子设备，其特征在于，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，其中，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器执行根据权利要求1~8中任一项所述的方法。
说明书desc
技术领域本发明涉及遥感技术领域，尤其涉及一种组网卫星光学载荷辐射一致性校正方法、装置和电子设备。背景技术遥感卫星技术逐渐向星座组网、多星协同的趋势发展，多卫星联合观测和数据综合应用已进入常态化运行模式，但当前卫星数据产品处理还是以单星单载荷的处理方式为主。对于几何和辐射的数据产品处理方法虽基本一致，但由于卫星载荷数据处理系统独立，实际卫星在轨运行周期内，不同卫星载荷的数据在几何、光谱以及辐射方面具有很大差异。因此，针对多源卫星数据联合应用，如何实现对不同卫星载荷数据的一致性校正是相关技术中需要解决的技术问题。发明内容鉴于上述问题，本发明提供了一种组网卫星光学载荷辐射一致性校正方法、装置和电子设备。根据本发明的第一个方面，提供了一种组网卫星光学载荷辐射一致性校正方法，包括：针对基准参考载荷和每个待校准载荷，根据通道定标系数、基准影像和待校准影像中每个像元的计数值，计算得到与每个上述像元对应的辐亮度观测值，其中，上述基准影像是从上述基准参考载荷过境上述目标区域得到的影像中筛选得到的，上述待校准影像是从上述待校准载荷过境上述目标区域得到的影像中筛选得到的；根据上述基准影像和上述待校准影像中每个像元的辐亮度观测值，对上述基准影像和上述待校准影像进行空间匹配和光谱匹配，计算得到与上述待校准载荷对应的再定标系数；根据与组网卫星中的待校准载荷对应的再定标系数，对与上述待校准载荷对应的全部待校准影像中每个像元的辐亮度进行校正，得到与每个上述像元对应的经再定标后的辐亮度；根据上述基准影像中每个像元的辐亮度和上述待校准影像中每个像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对上述待校准影像和上述基准影像的地表反射率进行角度归一化和映射处理，得到每个上述像元的像素值；根据上述基准影像和上述待校准影像的重叠区域，生成与上述待校准影像对应的唯一像素值列表和与上述基准影像对应的参考像素值列表；以及对上述唯一像素值列表和上述参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过上述拟合曲线对上述待校准影像中每个像元的像素值进行更新，得到经上述基准影像辐射一致性校正后的待校准影像。本发明的第二方面提供了一种组网卫星光学载荷辐射一致性校正装置，包括：计算模块、匹配模块、校正模块、获得模块、生成模块和拟合模块。其中，计算模块，用于针对基准参考载荷和每个待校准载荷，根据通道定标系数、基准影像和待校准影像中每个像元的计数值，计算得到与每个上述像元对应的辐亮度观测值，其中，上述基准影像是从上述基准参考载荷过境上述目标区域得到的影像中筛选得到的，上述待校准影像是从上述待校准载荷过境上述目标区域得到的影像中筛选得到的。匹配模块，用于根据上述基准影像和上述待校准影像中每个像元的辐亮度观测值，对上述基准影像和上述待校准影像进行空间匹配和光谱匹配，得到与上述待校准载荷对应的再定标系数。校正模块，用于根据与组网卫星中的待校准载荷对应的再定标系数，对与上述待校准载荷对应的全部待校准影像中每个像元的辐亮度进行校正，得到与每个上述像元对应的经再定标后的辐亮度。获得模块，用于根据上述基准影像中每个像元的辐亮度和上述待校准影像中每个上述像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对上述待校准影像和上述基准影像的地表反射率进行角度归一化和映射处理，得到每个上述像元的像素值。生成模块，用于根据上述基准影像和上述待校准影像的重叠区域，生成与上述待校准影像对应的唯一像素值列表和与上述基准影像对应的参考像素值列表。拟合模块，用于对上述唯一像素值列表和上述参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过上述拟合曲线对上述待校准影像中每个像元的像素值进行更新，得到经上述基准影像辐射一致性校正后的待校准影像。本发明的第三方面提供了一种电子设备，包括：一个或多个处理器；存储器，用于存储一个或多个程序，其中，当所述一个或多个程序被所述一个或多个处理器执行时，使得一个或多个处理器执行上述方法。本发明的第四方面还提供了一种计算机可读存储介质，其上存储有可执行指令，该指令被处理器执行时使处理器执行上述方法。本发明的第五方面还提供了一种计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现上述方法。根据本发明提供的组网卫星光学载荷辐射一致性校正方法、装置和电子设备，对基准影像和待校准影像进行空间匹配和光谱匹配，以通过计算得到的再定标系数对与待校准载荷对应的全部待校准影像的辐亮度进行校正，使得能够消除因载荷空间分辨率不同和地理坐标不一致给星-星互定标带来的影响以及因通道光谱响应不一致带来的观测辐射值差异性，并且，在根据再定标系对待校准载荷的全部待校准影像的辐亮度进行校正后，对基准影像和待校准影像进行角度转换，以消除观测角度差异导致的观测辐射值差异性，在对待校准影像进行角度归一化和映射处理后，可以基于基准影像和待校准影像的重叠区域，对与待校准影像对应的唯一像素值列表和与基准影像对应的参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过拟合曲线对待校准影像中每个像元的像素值进行更新，得到经基准影像辐射一致性校正后的待校准影像，由于借助局部加权拟合，克服了传统校正方法需要大量基准影像支持且拼接处无法色差消除的问题，能够为星座协调观测模式下标准时序数据产品生成提供支持，同时，该方案具有较强的鲁棒性，可有效消除因地物强反光和光照强度变化等因素造成星座组网影像辐射不一致性的问题。附图说明通过以下参照附图对本发明实施例的描述，本发明的上述内容以及其他目的、特征和优点将更为清楚，在附图中：图1示出了根据本发明实施例的组网卫星光学载荷辐射一致性校正方法的应用场景图。图2示出了根据本发明实施例的组网卫星光学载荷辐射一致性校正方法的流程图。图3示出了根据本发明实施例的得到像元的像素值的流程图。图4示出了根据本发明实施例的生成唯一像素值列表和参考像素值列表的流程图。图5示出了根据本发明实施例的待校准影像的重叠区域的示意图。图5示出了根据本发明实施例的基准影像的重叠区域的示意图。图6示出了根据本发明实施例的组网卫星光学载荷辐射一致性校正装置的结构框图。图7示出了根据本发明实施例的适于实现组网卫星光学载荷辐射一致性校正方法的电子设备的方框图。具体实施方式以下，将参照附图来描述本发明的实施例。但是应该理解，这些描述只是示例性的，而并非要限制本发明的范围。在下面的详细描述中，为便于解释，阐述了许多具体的细节以提供对本发明实施例的全面理解。然而，明显地，一个或多个实施例在没有这些具体细节的情况下也可以被实施。此外，在以下说明中，省略了对公知结构和技术的描述，以避免不必要地混淆本发明的概念。在此使用的术语仅仅是为了描述具体实施例，而并非意在限制本发明。在此使用的术语“包括”、“包含”等表明了所述特征、步骤、操作和/或部件的存在，但是并不排除存在或添加一个或多个其他特征、步骤、操作或部件。在此使用的所有术语具有本领域技术人员通常所理解的含义，除非另外定义。应注意，这里使用的术语应解释为具有与本说明书的上下文相一致的含义，而不应以理想化或过于刻板的方式来解释。在使用类似于“A、B和C等中至少一个”这样的表述的情况下，一般来说应该按照本领域技术人员通常理解该表述的含义来予以解释。在本发明的技术方案中，所涉及的用户信息和数据，均为经用户授权或者经过各方充分授权的信息和数据，并且相关数据的收集、存储、使用、加工、传输、提供、公开和应用等处理，均遵守相关地区的相关法律法规和标准，采取了必要保密措施，不违背公序良俗，并提供有相应的操作入口，供用户选择授权或者拒绝。在实现本发明的过程中发现，当前卫星地面和应用系统技术还是以单星单载荷的处理方式为主，协同处理星座内部多载荷数据且保证不同卫星数据产品一致性的遥感地面和应用系统尚未建立，无法满足当前星座化多星多载荷协调观测、信息快速获取和更新的需求。因此，面向高精度、高时效的卫星数据产品获取需求，从数据获取源头上提升多星多载荷数据产品质量，是进行星座组网光学载荷遥感数据产品质量控制，充分发挥其卫星载荷应用效能最为重要的环节。目前用于实现数据一致性校正的典型算法可以包含两大类：第一类是利用辐射基准传递的方式，建立全球星载辐射基准传递系统，旨在为气候监测、天气预报和环境应用等，在世界空间观测范围内提供精度一致的观测结果。如果辐射基准传递的参考目标较理想且两个传感器光谱差异较小，辐射基准传递可以有效校正载荷间的非一致性，不确定性可以控制到1.0%以内。第二类是基于基准影像利用机器学习模型对影像进行预测和处理，改善单星时序数据、多星不同载荷数据之间的辐射一致性。可以基于CubeSat的时空增强方法，以定标精度更高的Landsat 8/OLI为参考，利用多尺度机器学习的方法来校正CubeSat数据非一致性。然而，这需要大量的基准影像数据，并且无法生产无缝拼接影像，影像拼接处仍然清晰可见。因此，针对多源卫星数据联合应用，如何实现对不同卫星载荷数据的一致性校正是相关技术中需要解决的技术问题。图1示出了根据本发明实施例的组网卫星光学载荷辐射一致性校正方法的应用场景图。如图1所示，根据该实施例的应用场景100可以包括第一终端设备101、第二终端设备102、第三终端设备103、网络104和服务器105。网络104用以在第一终端设备101、第二终端设备102、第三终端设备103和服务器105之间提供通信链路的介质。网络104可以包括各种连接类型，例如有线、无线通信链路或者光纤电缆等等。用户可以使用第一终端设备101、第二终端设备102、第三终端设备103中的至少一个通过网络104与服务器105交互，以接收或发送消息等。第一终端设备101、第二终端设备102、第三终端设备103上可以安装有各种通讯客户端应用，例如购物类应用、网页浏览器应用、搜索类应用、即时通信工具、邮箱客户端、社交平台软件等。第一终端设备101、第二终端设备102、第三终端设备103可以是具有显示屏并且支持网页浏览的各种电子设备，包括但不限于智能手机、平板电脑、膝上型便携计算机和台式计算机等等。服务器105可以是提供各种服务的服务器，例如对用户利用第一终端设备101、第二终端设备102、第三终端设备103所浏览的网站提供支持的后台管理服务器。后台管理服务器可以对接收到的用户请求等数据进行分析等处理，并将处理结果反馈给终端设备。需要说明的是，本发明实施例所提供的组网卫星光学载荷辐射一致性校正方法一般可以由服务器105执行。相应地，本发明实施例所提供的组网卫星光学载荷辐射一致性校正装置一般可以设置于服务器105中。本发明实施例所提供的组网卫星光学载荷辐射一致性校正方法也可以由不同于服务器105且能够与第一终端设备101、第二终端设备102、第三终端设备103和/或服务器105通信的服务器或服务器集群执行。相应地，本发明实施例所提供的组网卫星光学载荷辐射一致性校正装置也可以设置于不同于服务器105且能够与第一终端设备101、第二终端设备102、第三终端设备103和/或服务器105通信的服务器或服务器集群中。应该理解，图1中的终端设备、网络和服务器的数目仅仅是示意性的。根据实现需要，可以具有任意数目的终端设备、网络和服务器。以下将基于图1描述的场景，通过图2~图5对公开实施例的组网卫星光学载荷辐射一致性校正方法进行详细描述。图2示出了根据本发明实施例的组网卫星光学载荷辐射一致性校正方法的流程图。如图2所示，该方法200包括操作S210~操作S260。在操作S210，针对基准参考载荷和每个待校准载荷，根据通道定标系数、基准影像和待校准影像中每个像元的计数值，计算得到与每个像元对应的辐亮度观测值。根据本发明的实施例，基准影像是从基准参考载荷过境目标区域得到的影像中筛选得到的，待校准影像是从待校准载荷过境目标区域得到的影像中筛选得到的。目标区域可以包括多个。基准参考载荷和待校准载荷可以包括多个通道，载荷的每个通道在载荷过境目标区域时均可以获取到对应的影像。根据本发明的实施例，可以从数据辅助文件中获取基准参考载荷和待校准载荷相应通道的通道定标系数以及基准影像和待校准影像中每个像元的计数值。其中，数据辅助文件可以表征影像配备的XML文件等。根据本发明的实施例，与像元对应的辐亮度观测值的计算公式可以表示为如下公式。其中，Li可以表示载荷过境目标区域i得到的影像中某个像元的辐亮度观测值，可以表示载荷过境目标区域i得到的影像中某个像元的计数值，Gain和Bias分别表示载荷相应通道的定标增益和偏置，通道定标系数可以包括定标增益和偏置。根据本发明的实施例，可以通过上述公式，分别计算得到基准影像中每个像元的辐亮度观测值和待校准影像中每个像元的辐亮度观测值。其中，辐亮度观测值也可以表示为观测辐射值。在操作S220，根据基准影像和待校准影像中每个像元的辐亮度观测值，对基准影像和待校准影像进行空间匹配和光谱匹配，计算得到与待校准载荷对应的再定标系数。根据本发明的实施例，根据基准影像和待校准影像中每个像元的辐亮度观测值，对基准影像和待校准影像进行空间聚合，以将基准影像和待校准影像中具有较高空间分辨率载荷的影像聚合到较低空间分辨率载荷的影像的空间分辨率上，并将经过空间聚合后的影像进行地理配准，以将待校准影像校正到基准影像的地理坐标系下，以消除因载荷间空间分辨率不同和地理坐标不一致给星-星互定标带来的影响。其中，空间匹配可以表征对基准影像和待校准影像进行空间聚合和地理配准。根据本发明的实施例，可以利用大气辐射传输方程产生模拟数据，并基于模拟数据对空间匹配后的基准影像和待校准影像进行光谱匹配，以消除基准参考载荷和待校准载荷因通道光谱响应不一致带来的其观测辐射值差异性。其中，模拟数据可以表征模拟辐亮度。根据本发明的实施例，可以根据进行空间匹配和光谱匹配之后的基准影像和待校准影像中每个像元的辐亮度，计算得到与待校准载荷对应的再定标系数。其中，辐亮度还可以表示为辐射值。在操作S230，根据与组网卫星中的待校准载荷对应的再定标系数，对与待校准载荷对应的全部待校准影像中每个像元的辐亮度进行校正，得到与每个像元对应的经再定标后的辐亮度。根据本发明的实施例，通过上述步骤S220，可以计算得到与每个待校准载荷对应的再定标系数。将与组网卫星中每个待校准载荷对应的全部待校准影像中每个像元的辐亮度分别乘以对应的再定标系数，得到与每个像元对应的经再定标后的辐亮度，以实现对与待校准载荷对应的待校准影像中每个像元的辐亮度的再定标。其中，待校准影像中每个像元的辐亮度是对基准影像和待校准影像进行空间匹配和光谱匹配之后得到的像元的辐亮度。在操作S240，根据基准影像中每个像元的辐亮度和待校准影像中每个像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对待校准影像和基准影像的地表反射率进行角度归一化和映射处理，得到每个像元的像素值。根据本发明的实施例，基准影像中每个像元的辐亮度是对基准影像和待校准影像进行空间匹配和光谱匹配之后得到的像元的辐亮度。可以对基准影像和待校准影像进行角度转换，即根据基准影像中每个像元的辐亮度和待校准影像中每个像元的经再定标后的辐亮度，反演得到对应像元的地表反射率。对反演得到的地表反射率进行角度归一化处理，再将经角度归一化处理的地表反射率映射到目标像素值区域，以得到基准影像和待校准影像中每个像元的像素值。其中，目标像素值区域，例如可以是0~255。在操作S250，根据基准影像和待校准影像的重叠区域，生成与待校准影像对应的唯一像素值列表和与基准影像对应的参考像素值列表。根据本发明的实施例，可以根据基准影像和待校准影像，确定基准影像和待校准影像中的重叠区域。可以根据待校准影像中与重叠区域对应的每个像元的像素值，生成唯一像素值列表。可以根据基准影像中与重叠区域对应的每个像元的像素值，并基于唯一像素值列表，生成参考像素值列表。参考像素值列表中存在与唯一像素值列表中的每个唯一像素值对应的参考像素值。在操作S260，对唯一像素值列表和参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过拟合曲线对待校准影像中每个像元的像素值进行更新，得到经基准影像辐射一致性校正后的待校准影像。根据本发明的实施例，可以利用LOESS，对唯一像素值列表和参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线。根据本发明的实施例，对基准影像和待校准影像进行空间匹配和光谱匹配，以通过计算得到的再定标系数对与待校准载荷对应的全部待校准影像的辐亮度进行校正，使得能够消除因载荷空间分辨率不同和地理坐标不一致给星-星互定标带来的影响以及因通道光谱响应不一致带来的观测辐射值差异性，并且，在根据再定标系对待校准载荷的全部待校准影像的辐亮度进行校正后，对基准影像和待校准影像进行角度转换，以消除观测角度差异导致的观测辐射值差异性，在对待校准影像进行角度归一化和映射处理后，可以基于基准影像和待校准影像的重叠区域，对与待校准影像对应的唯一像素值列表和与基准影像对应的参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过拟合曲线对待校准影像中每个像元的像素值进行更新，得到经基准影像辐射一致性校正后的待校准影像，由于借助局部加权拟合，克服了传统校正方法需要大量基准影像支持且拼接处无法色差消除的问题，能够为星座协调观测模式下标准时序数据产品生成提供支持，同时，该方案具有较强的鲁棒性，可有效消除因地物强反光和光照强度变化等因素造成星座组网影像辐射不一致性的问题。根据本发明的实施例，上述组网卫星光学载荷辐射一致性校正方法还包括：根据长时间序列的卫星无云影像和大气再分析资料数据，确定满足区域约束条件的多个目标区域；针对每个目标区域，对基准参考载荷和每个待校准载荷过境目标区域的影像进行筛选，得到满足云量约束条件的影像；根据获取到的目标区域与基准参考载荷、每个待校准载荷之间的观测几何信息，筛选得到满足观测约束条件的影像子集。根据本发明的实施例，影像子集包括与基准参考载荷对应的基准影像和与多个待校准载荷对应的待校准影像。长时间序列的卫星无云影像可以表征获取到的某一区域在一段时间内的无云影像，以根据该区域在一段时间内的无云影像判断是否满足区域约束条件。根据本发明的实施例，可以基于目标辐射特性和大气光学特性参数，甄选出地球稳定均一目标区域，即多个目标区域，其中，目标辐射特性可以包括空间非均匀性、地表反射率稳定等，大气光学特性参数可以包括云覆盖率、晴空水汽含量、能见度等，使得可以通过综合考虑目标空间均匀性、辐射特性长期稳定性、光谱平坦性、以及大气环境等因素，在全球范围内甄选目标特性均一、稳定且大气通透性良好的场区，为开展辐射一致性校正奠定基础。根据本发明的实施例，区域约束条件可以表征通过量化地球稳定目标空间均匀性、辐射特性长期稳定性、光谱平坦性、各向异性以及时间稳定性等表征指标，在分析地球稳定目标空间、光谱、大气条件等要素敏感性的基础上，形成的一套完整的包含空间、光谱、角度、大气条件等要素的地球稳定目标甄别约束机制。例如，区域约束条件可以包括空间非均匀性优于3%，地表反射率稳定且20年内变化小于4%，云覆盖率小于20%/年，晴空水汽含量小于3g/cm2，能见度大于23km。根据本发明的实施例，基于长时间序列MODIS、Landsat8/OLI、Sentinel等获取到的无云影像和大气再分析资料数据，依据区域约束条件，选取广泛地理分布的宽动态地球稳定目标，即多个目标区域。其中，可以从大气再分析资料数据中获取能见度、晴空水汽含量等区域约束条件中所需的各类数据。根据本发明的实施例，从选取的用于辐射一致性校准的星座组网载荷中，确定用于星-星互定标的基准参考载荷和多个待校准载荷。其中，以定标精度较高的组网卫星为基准参考载荷，其余定标精度较低的组网卫星都为待校准载荷。根据本发明的实施例，基准参考载荷和待校准载荷可以通过过境每个目标区域，得到与每个目标区域对应的影像。云量约束条件可以表征影像中对应的目标区域为晴空无云。下载和筛选满足云量约束条件的基准参考载荷和待校准载荷过境目标区域的晴天无云匹配图像对。其中，可以利用云掩膜产品，判读影像中目标区域的空云量，下载和筛选基准参考载荷和待校准载荷过境目标区域的晴天无云匹配影像对。根据本发明的实施例，观测几何信息可以包括载荷与对应目标区域之间的观测天顶角和观测方位角以及太阳的观测天顶角和观测方位角。对于每个目标区域，可以从数据辅助文件中获取满足云量约束条件的影像的四角经纬度信息、目标区域在对应影像中的位置、观测时间信息、载荷与对应目标区域之间的观测天顶角和观测方位角等。其中，可以结合卫星载荷过境目标区域的日期和时间，即观测时间信息，计算得到太阳的观测天顶角和观测方位角。根据本发明的实施例，观测约束条件可以表征对于载荷过境目标区域的观测角度和观测时间的约束条件。从满足云量约束条件的影像中，再次筛选得到满足观测约束条件的基准影像和待校准影像。例如，观测约束条件可以包括基准参考载荷和待校准载荷过境目标区域的时间差异小于15分钟、观测天顶角差异小于10°、相对方位角差异小于15°，以尽可能地减少观测时间/角度差异带来的辐射值变化影响。根据本发明的实施例，筛选满足区域约束条件的多个目标区域，以在全球范围内甄选得到目标特性均一、稳定且大气通透性良好的目标区域，为开展辐射一致性校正奠定基础；筛选满足云量约束条件的影像，以得到目标区域为晴天无云的影像；筛选得到的满足观测约束条件的影像子集，以消除基准参考载荷和待校准载荷因观测时间引起的星-星互定标不确定度，也尽可能地减少观测时间/角度差异带来的辐射值变化影响，以便于后续依据影像子集中每对基准影像和待校准影像计算与待校准载荷对应的再定标系数。根据本发明的实施例，根据基准影像和待校准影像中每个像元的辐亮度观测值，对基准影像和待校准影像进行空间匹配和光谱匹配，计算得到与待校准载荷对应的再定标系数，包括：将影像子集中每对基准影像和待校准影像中空间分辨率最高的影像确定为第一影像，将基准影像和待校准影像中空间分辨率最低的影像确定为第二影像；根据第一影像和第二影像的空间分辨率，确定第一影像中与第二影像中每个像元对应的目标像元区域；针对每个目标像元区域，根据目标像元区域中每个像元的辐亮度观测值，得到与目标像元区域对应的校正辐亮度；利用模拟辐亮度，根据与每个目标区域对应的第一影像中每个目标像元区域的校正辐亮度和第二影像中每个像元的辐亮度观测值，得到与待校准载荷对应的再定标系数。根据本发明的实施例，影像子集中可以包括基准参考载荷过境多个目标区域的基准影像和每个待校准影像过境多个目标区域的待校准影像，影像子集中基准参考载荷过境某一目标区域的基准影像与某一待校准载荷过境该目标区域的待校准影像可以匹配成影像对。影像子集中包括多对影像对，即多对基准影像和待校准影像。根据本发明的实施例，在基准影像和待校准影像的空间分辨率不一致的情况下，可以采用反距离加权算法，对两个载荷的观测数据进行空间聚合和匹配，将具有较高空间分辨率载荷数据配准到较低空间分辨率载荷数据上，以减少空间分辨率不一致产生的不确定性。根据本发明的实施例，可以将基准影像和待校准影像中空间分辨率最高的影像确定为第一影像，将基准影像和待校准影像中空间分辨率最低的影像确定为第二影像。根据本发明的实施例，反距离加权算法公式可以表示为如下公式。其中，L可以表示经空间聚合后得到的较低空间分辨率影像中每个像元的校正辐亮度，即经空间聚合后的第一影像中每个像元的校正辐亮度， Lj表示较高空间分辨率影像中第j个像元的辐亮度观测值，表示较高空间分辨率影像中第j个像元与采样点之间距离的倒数。根据本发明的实施例，在基准影像和待校准影像的空间分辨率不同的情况下，可以确定较高空间分辨率的第一影像中与较低空间分辨率的第二影像中每个像元对应的目标像元区域。针对每个目标像元区域，可以根据目标像元区域中每个像元的辐亮度观测值，通过公式上述，得到与目标像元区域对应的校正辐亮度，以将第一影像聚合到第二影像的空间分辨率上。其中，采样点可以表征目标像元区域的中心点。例如，较高空间分辨率影像为100×100，较低空间分辨率影像为5×5，则较高空间分辨率影像中与较低空间分辨率图像中每个像元对应的目标像元区域为20×20。根据本发明的实施例，可以将经过空间聚合后的影像进行地理配准，以将待校准影像校正到基准影像的地理坐标系下。根据本发明的实施例，利用大气辐射传输方程模拟得到的模拟辐亮度，可以计算得到与待校准载荷对应的光谱匹配因子，从而可以根据与每个目标区域对应的经过空间聚合和配准后的第一影像中每个目标像元区域的校正辐亮度和第二影像中每个像元的辐亮度观测值，计算得到再定标系数，即根据经过空间聚合和配准后的基准影像和待校准影像的辐亮度，计算得到再定标系数。根据本发明的实施例，根据目标像元区域中每个像元的辐亮度观测值，得到与目标像元区域对应的校正辐亮度，消除了因载荷间空间分辨率不同给星-星互定标带来的影响，实现了将具有较高空间分辨率载荷数据配准到较低空间分辨率载荷数据上，减少了空间分辨率不一致产生的不确定性；再利用模拟辐亮度，计算得到与待校准载荷对应的再定标系数，以此来纠正基准参考载荷和待校准载荷的入瞳辐射值差异，即辐亮度差异。根据本发明的实施例，利用模拟辐亮度，根据与每个目标区域对应的第一影像中每个目标像元区域的校正辐亮度和第二影像中每个像元的辐亮度观测值，得到与待校准载荷对应的再定标系数，包括：根据与基准参考载荷和待校准载荷各自对应的模拟辐亮度和光谱响应函数，计算得到光谱匹配因子；根据基准影像中每个像元的辐亮度和光谱匹配因子，计算得到待校准影像中每个像元的辐亮度理论真值；根据与每个目标区域对应的待校准影像中每个像元的辐亮度理论真值和辐亮度，计算得到再定标系数。根据本发明的实施例，基于大气再分析资料数据、目标反射率以及基准参考载荷与待校准载荷的光谱响应函数等参数，在待校准载荷观测几何条件下，可以利用大气辐射传输方程，模拟得到基准参考载荷和待校准载荷相应通道的大气层顶辐亮度数据集。根据本发明的实施例，光谱匹配因子SBAF的具体计算方式可以表示为如下公式。其中，fref和fcal分别为基准参考载荷和待校准载荷的光谱响应函数，Rref和Rcal 分别为大气辐射传输模型模拟得到的载荷入瞳处辐亮度，即模拟辐亮度；λ为波长。其中，上述公式，对波长λ的积分范围为基准载荷的波谱范围。根据本发明的实施例，通过上述公式，利用最小二乘线性拟合的方法计算得到光谱匹配因子，并将光谱匹配因子作为乘性因子，与基准影像中每个像元的辐亮度相乘，以将其变换到待校准载荷的相应通道上，得到待校准影像中对应像元的辐亮度理论真值。根据本发明的实施例，根据待校准载荷过境每个目标区域得到的待校准影像中每个像元的辐亮度理论真值和辐亮度，采用最小二乘线性拟合的方法，计算得到与待校准载荷对应的再定标系数。根据本发明的实施例，利用经过光谱匹配后的待校准影像中每个像元的辐亮度理论真实和辐亮度，计算得到再定标系数，使得能够通过再定标系数来纠正基准参考载荷和待校准载荷的入瞳辐射值差异。根据本发明的实施例，根据基准影像中每个像元的辐亮度和待校准影像中每个像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对待校准影像和基准影像的地表反射率进行角度归一化和映射处理，得到每个像元的像素值，包括：从大气再分析资料数据中分别获取基准参考载荷和待校准载荷过境目标区域的环境参数；根据与基准参考载荷对应的环境参数和基准影像中每个像元的辐亮度，反演得到基准影像中每个像元的地表反射率；根据与待校准载荷对应的环境参数和待校准影像中每个像元的经再定标后的辐亮度，反演得到待校准影像中每个像元的地表反射率；对基准影像和待校准影像中每个像元的地表反射率进行角度归一化处理和映射处理，得到基准影像和待校准影像中每个像元的像素值。根据本发明的实施例，可以从大气再分析资料数据中获取基准参考载荷和待校准载荷过境目标区域的环境参数，其中，环境参数可以包括大气水汽含量、气溶胶光学厚度等参数；环境参数为载荷过境目标区域成像时刻的环境参数。根据本发明的实施例，可以通过将环境参数结合载荷观测角度信息、光谱响应函数等参数，反演得到基准影像和待校准影像中每个像元的地表反射率。根据本发明的实施例，可以基于待校准影像中每个像元的经再定标后的辐亮度和基准影像中每个像元的辐亮度，通过从大气再分析资料数据中提取载荷过境目标区域时刻的大气水汽含量和气溶胶光学厚度等参数，并利用大气辐射传输模型，计算大气层辐射、大气透过率、大气球面反照率等参数，从而可以基于大气辐射传输方程，推算每个像元的地表反射率。根据本发明的实施例，卫星载荷接收的TOA辐亮度L’可以表示为如下公式。其中，L’为卫星载荷接收到的每个像元的辐亮度，Lpath为大气层辐射，ρ为对应像元的地表反射率，S为大气球面反照率，Es为大气外太阳辐照度，τ和τ均为大气透过率，μs与μv分别为太阳天顶角的余弦值与观测天顶角的余弦值。根据本发明的实施例，可以基于大气层辐射、大气透过率、大气球面反照率等参数，通过上述公式，将校准影像中每个像元的经再定标后的辐亮度和基准影像中每个像元的辐亮度依次作为L’，从而可以推算出每个像元的地表反射率。根据本发明的实施例，通过上述公式，可以根据像元的辐亮度，反演推算得到待校准影像和基准影像中每个像元的地表反射率。并通过对每个像元的地表反射率进行角度归一化处理和映射处理，得到每个像元的像素值。根据本发明的实施例，通过将像元的经校正后的辐亮度，反演得到像元的地表反射率，并对地表反射率进行角度归一化处理和映射处理，得到像元的像素值，以便于后续的校正过程。图3示出了根据本发明实施例的得到像元的像素值的流程图。如图3所示，该方法300包括操作S310~操作S360。在操作S310，根据基准参考载荷与目标区域之间的观测角度信息，计算得到与基准参考载荷对应的二向反射因子。根据本发明的实施例，可以通过构建的目标区域的二向反射率函数模型，对基准影像和待校准影像反演得到的地表反射率进行角度归一化。观测角度信息可以包括观测天顶角、太阳天顶角、相对方位角等。根据本发明的实施例，采取地面多角度观测的方式或者二向性反射产品，针对每个目标区域构建BRDF模型，以描述地表反射率和观测角度变化的关系。其中，BRDF模型可以表示为如下公式。其中，R为二向反射因子，θv和θs分别为观测天顶角和太阳天顶角，φ为观测方向与太阳入射方向在水平面上的相对方位角；kiso、kvol、kgeo分别为各向同性散射量、体散射量和几何光学散射量，均是与角度无关与场景有关的参数；fiso=1可以表示地表散射中的各向均一散射部分的核函数，fvol和fgeo是由太阳天顶角、观测天顶角和相对方位角组成的体散射核函数与几何光学散射核函数。对于体散射核函数，选择使用较多的Roujean和Ross提出的基于辐射传输理论的公式，它是在忽略多次散射的条件下计算水平均匀冠层的二向反射，通常称为RossThick核，可以表示为如下公式。其中，cosε = cosθvcosθs+sinθvsinθscosφ；ε可以表示太阳入射方向与观测方向在立体空间上的相对立体角，即太阳入射方向与观测方向在立体空间上的夹角。对于几何光学散射核函数，使用基于几何光学模型推导的几何光学核，常用的形式有，LiSparse核、LiDense核以及LiTransit核等。根据本发明的实施例，可以通过上述公式，根据基准参考载荷载荷与目标区域之间的观测角度信息，计算得到与基准参考载荷对应的二向反射因子。在操作S320，根据待校准载荷与目标区域之间的观测角度信息，计算得到与待校准载荷对应的二向反射因子。根据本发明的实施例，可以通过上述公式，根据待校准载荷与目标区域之间的观测角度信息，计算得到与待校准载荷对应的二向反射因子。在操作S330，根据与基准参考载荷对应的二向反射因子和与待校准载荷对应的二向反射因子，得到角度转换系数。根据本发明的实施例，为了便于后续的校正处理，需对反演得到的地表反射率进行角度转换，将待校准载荷在观测几何下反演得到的地表反射率变换到基准参考载荷的观测几何下，以消除目标BRDF引起的辐射值不一致的问题。根据本发明的实施例，角度转换系数的计算公式可以表示为如下公式。其中，R，R分别为利用BRDF模型计算得到的与第一目标待校准载荷对应的二向反射因子和与第二目标待校准载荷对应的二向反射因子。在操作S340，根据角度转换系数和待校准影像中每个像元的地表反射率，得到与待校准影像中每个像元对应的经角度归一化处理后的地表反射率。根据本发明的实施例，可以将待校准影像中每个像元的地表反射率分别乘以角度转换系数，得到经角度归一化处理后后的地表反射率。在操作S350，将与待校准影像中每个像元对应的经角度归一化处理后的地表反射率映射到目标像素值区间，得到待校准影像中每个像元的像素值。根据本发明的实施例，将待校准影像中每个像元的经角度归一化的地表反射率映射到目标像素值区间。例如，0~255像素值区间。根据本发明的实施例，像素值的计算公式可以表示为如下公式。/＞其中，DNi为影像中像元i的像素值，REFi为影像中像元i对应的地表反射率，REFmax为影像中像元的最大反射率值。根据本发明的实施例，可以通过上述公式，将待校准影像中每个像元的地表反射率映射到0~255之间，以得到每个像元的像素值。在操作S360，将基准影像中每个像元的地表反射率映射到目标像素值区间，得到基准影像中每个像元的像素值。根据本发明的实施例，可以通过上述公式，将基准影像中每个像元的地表反射率映射到0~255之间，以得到每个像元的像素值。根据本发明的实施例，通过将基准影像和待校准影像中每个像元的地表反射率进行角度归一化处理，实现将第一待校准载荷观测几何下反演得到的地表反射率纠正到第二待校准载荷的观测几何下，以消除目标BRDF引起的辐射值不一致的问题，并将地表反射率映射到目标像素值区间，能够便于后续计算。图4示出了根据本发明实施例的生成唯一像素值列表和参考像素值列表的流程图。如图4所示，该方法400包括操作S410~操作S460。在操作S410，将待校准影像的重叠区域中每个像元的像素值进行去重处理，得到唯一像素值集合。根据本发明的实施例，假设{DN}为待校准影像中重叠区域的所有像素值的集合，将集合中像素值进行去重处理，即剔除集合{DN}中的重复像素值，得到与待校准影像中重叠区域对应的唯一像素值集合{DNunique}。图5示出了根据本发明实施例的待校准影像的重叠区域的示意图。如图5所示，为与待校准影像中重叠区域的每个像元对应的像素值，其中，像素值170存在重复。该重叠区域的唯一像素值集合{DNunique}可以包括像素值127、137、152、149、150、160、170、154、151、140、158、147、143和162。在操作S420，针对唯一像素值集合中的每个唯一像素值，从待校准影像的重叠区域中确定像素值为唯一像素值的像元的位置信息。根据本发明的实施例，对于{DNunique}中任意一个唯一像素值DNi，寻找待校准影像中重叠区域内所有像素值为DNi的像元，记录这些像元在待校准影像中的坐标{x,y}i，其中，{x,y}i中可以包含ni个像元，位置信息可以表征坐标{x,y}i。例如，对于图5中的唯一像素值127，其位置信息为。在操作S430，根据唯一像素值集合中的每个唯一像素值和与唯一像素值对应的像元的位置信息，生成唯一像素值列表。根据本发明的实施例，所有的唯一像素值DNi和与其对应的坐标{x,y}i的组合构成唯一像素值列表。在操作S440，针对唯一像素值列表中的每个唯一像素值，根据与唯一像素值对应的像元的位置信息，确定基准影像的重叠区域中与位置信息对应的像元的像素值。根据本发明的实施例，针对唯一像素值列表中的每个唯一像素值，寻找每组{x,y}i在基准影像的重叠区域上对应的同名点{x',y'}i，其中，同名点可以表征基准影像中与待校准影像中每个唯一像素值对应的坐标相同的点。图5示出了根据本发明实施例的基准影像的重叠区域的示意图。如图5所示，为与基准影像中重叠区域的每个像元对应的像素值。图5中某一唯一像素值127的位置信息为坐标，则基准影像中与该坐标的位置信息相同的点的像素值为126。以待校准影像中的唯一像素值170为例，与该唯一像素值对应的待校准影像中的坐标{x,y}i以及基准影像中对应的像素值可以表示为如下表1。表1在操作S450，根据基准影像的重叠区域中与位置信息对应的像元的像素值，得到与每个唯一像素值对应的参考像素值。根据本发明的实施例，可以计算{x',y'}i的像素值的均值DN'i，将参考像素值DN’i作为待校准影像上{x,y}i对应的唯一像素值的理论真值。根据本发明的实施例，可以设置像元数量限制m，若ni小于m，则不采用DN'i作为理论真值；若ni大于等于m，仅使用{x',y'}i中间95%的像素值计算DN'i。其中，使用{x',y'}i中间95%的像素值计算，即指使用在该像元集合{x',y'}i中像素值排在中间95%的像元的像素值计算。根据本发明的实施例，与表1中唯一像素值对应的参考像素值可以表示为如下表2。表2在操作S460，基于得到的多个参考像素值，生成参考像素值列表。根据本发明的实施例，所有DN'i构成基准影像上相应理论真值集合{DN'}unique，即参考像素值列表。根据本发明的实施例，基于待校准影像和基准影像的重叠区域，生成唯一像素值列表和参考像素值列表，能够得到与每个唯一像素值对应的参考像素值，便于后续进行局部加权拟合。根据本发明的实施例，对唯一像素值列表和参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过拟合曲线对待校准影像中每个像元的像素值进行更新，得到经基准影像辐射一致性校正后的待校准影像，包括：以唯一像素值列表中的唯一像素值为第一坐标，以参考像素值列表中与唯一像素值对应的参考像素值为第二坐标，得到多个数据点；将多个数据点按照区间宽度进行划分，得到多个区间；针对每个区间，对区间中的数据点进行多项式拟合，得到与区间对应的回归曲线；基于与每个区间对应的回归曲线，得到拟合曲线；根据拟合曲线，对待校准影像中每个像元的像素值进行更新，得到新的待校准影像；将新的待校准影像中每个像元的像素值转换成地表反射率，得到经基准影像辐射一致性校正后的待校准影像。根据本发明的实施例，利用待校准影像上重叠区域的唯一像素值与基准影像上相应的理论真值，即参考像素值，通过LOESS局部加权回归拟合两幅影像像素值之间的函数关系，并用建立的模型对待校准影像的像素值进行预测，再将预测后的像素值转换为地表反射率，从而实现整幅待校准影像的更新。其中，LOESS是一种用于局部回归分析的非参数方法，适合于小样本和不均匀采样数据，Python、Matlab、R语言等均提供了LOESS包。相比于普通最小二乘回归，LOESS能更灵活地拟合数据曲线，且更符合传感器在不同亮度水平下光谱响应的非线性。根据本发明的实施例，以待校准影像的唯一像素值列表中的唯一像素值为x轴，即第一坐标，基准影像的参考像素值列表中的参考像素值为y轴，即第二坐标，可以得到多个数据点，其中，每个数据点的x轴坐标由唯一像素值列表的唯一像素值确定，y轴坐标由与唯一像素值对应的参考像素值确定。根据本发明的实施例，可以把多个数据点按照区间宽度划分成一个个小区间，对每个区间中的数据点进行多项式拟合，不断重复这个过程得到不同区间的回归曲线，最后再把这些回归曲线的中心连在一起，合成完整的拟合曲线。根据本发明的实施例，首先从数据点中选定拟合中心点的数量和位置，设置区间宽度为frac。对一拟合中心点，用权重函数计算区间上数据点的权重，离拟合中心点越近，权重越大。然后使用加权回归，得到附近的局部加权回归曲线，如果数据变化平缓，选用局部直线拟合，如果数据变化剧烈，则选用局部曲线拟合。对所有区间重复以上步骤，最后获取完整的拟合曲线。根据本发明的实施例，通过得到的LOESS拟合曲线，对待校准影像的像素值进行预测。由于设置了像素数量限制，在某些待校准影像的像素值区间上可能缺少数据点，导致回归曲线不连续，为了使回归曲线连续，可以在预测点之间对这些像素值进行线性插值，这是因为预测点之间往往非常接近，直线足以近似它们之间的预测值。用LOESS曲线预测值，对整幅待校准影像的像素值进行更新，其中，超出基准影像在重叠区域的像素值上下限的预测值将不被采用，仍保留原像素值。最后根据上述公式将待校准影像的像素值转换回地表反射率，得到经基准影像辐射校正的待校准影像。根据本发明的实施例，通过对唯一像素值列表和参考像素值列表中的像素值进行局部加权拟合，能够更灵活的拟合回归曲线，且不需大量基准影像，就能够消除因地物强反光和光照强度变化等因素造成星座组网影像辐射不一致性的问题，使得能够得到经基准影像校正后的待校准影像。基于上述组网卫星光学载荷辐射一致性校正方法，本发明还提供了一种组网卫星光学载荷辐射一致性校正装置。以下将结合图6对该装置进行详细描述。图6示出了根据本发明实施例的组网卫星光学载荷辐射一致性校正装置的结构框图。如图6所示，该实施例的组网卫星光学载荷辐射一致性校正装置600包括计算模块610、匹配模块620、校正模块630、获得模块640、生成模块650和拟合模块660。计算模块610用于针对基准参考载荷和每个待校准载荷，根据通道定标系数、基准影像和待校准影像中每个像元的计数值，计算得到与每个像元对应的辐亮度观测值，其中，基准影像是从基准参考载荷过境目标区域得到的影像中筛选得到的，待校准影像是从待校准载荷过境目标区域得到的影像中筛选得到的。在一实施例中，计算模块610可以用于执行前文描述的操作S210，在此不再赘述。匹配模块620用于根据基准影像和待校准影像中每个像元的辐亮度观测值，对基准影像和待校准影像进行空间匹配和光谱匹配，得到与待校准载荷对应的再定标系数。在一实施例中，匹配模块620可以用于执行前文描述的操作S220，在此不再赘述。校正模块630用于根据与组网卫星中的待校准载荷对应的再定标系数，对与待校准载荷对应的待校准影像中每个像元的辐亮度进行校正，得到与每个像元对应的经再定标后的辐亮度。在一实施例中，校正模块630可以用于执行前文描述的操作S230，在此不再赘述。获得模块640用于根据所述基准影像中每个像元的辐亮度和所述待校准影像中每个像元的经再定标后的辐亮度，反演得到每个像元的地表反射率，以通过对所述待校准影像和所述基准影像的地表反射率进行角度归一化和映射处理，得到每个所述像元的像素值。在一实施例中，获得模块640可以用于执行前文描述的操作S240，在此不再赘述。生成模块650用于根据基准影像和待校准影像的重叠区域，生成与待校准影像对应的唯一像素值列表和与基准影像对应的参考像素值列表。在一实施例中，生成模块650可以用于执行前文描述的操作S250，在此不再赘述。拟合模块660用于对唯一像素值列表和参考像素值列表中的像素值进行局部加权拟合，得到拟合曲线，以通过拟合曲线对待校准影像中每个像元的像素值进行更新，得到经基准影像辐射一致性校正后的待校准影像。在一实施例中，拟合模块660可以用于执行前文描述的操作S260，在此不再赘述。根据本发明的实施例，上述组网卫星光学载荷辐射一致性校正装置600还包括确定模块、第一筛选模块和第二筛选模块。确定模块，用于根据长时间序列的卫星无云影像和大气再分析资料数据，确定满足区域约束条件的多个目标区域。第一筛选模块，用于针对每个目标区域，对基准参考载荷和每个待校准载荷过境目标区域的影像进行筛选，得到满足云量约束条件的影像。第二筛选模块，用于根据获取到的目标区域与基准参考载荷、每个待校准载荷之间的观测几何信息，筛选得到满足观测约束条件的影像子集，其中，影像子集包括与基准参考载荷对应的基准影像和与多个待校准载荷对应的待校准影像。根据本发明的实施例，匹配模块620包括第一确定单元、第二确定单元、第一获得单元和第二获得单元。第一确定单元，用于将影像子集中每对基准影像和待校准影像中空间分辨率最高的影像确定为第一影像，将基准影像和待校准影像中空间分辨率最低的影像确定为第二影像。第二确定单元，用于根据第一影像和第二影像的空间分辨率，确定第一影像中与第二影像中每个像元对应的目标像元区域。第一获得单元，用于针对每个目标像元区域，根据目标像元区域中每个像元的辐亮度观测值，得到与目标像元区域对应的校正辐亮度。第二获得单元，用于利用模拟辐亮度，根据与每个目标区域对应的第一影像中每个目标像元区域的校正辐亮度和第二影像中每个像元的辐亮度观测值，得到与待校准载荷对应的再定标系数。根据本发明的实施例，第二获得单元包括第一计算子单元、第一获得子单元和第二计算子单元。第一计算子单元，用于根据与基准参考载荷和待校准载荷各自对应的模拟辐亮度和光谱响应函数，计算得到光谱匹配因子。第一获得子单元，用于根据基准影像中每个像元的辐亮度和光谱匹配因子，计算得到待校准影像中每个像元的辐亮度理论真值。第二计算子单元，用于根据与每个目标区域对应的待校准影像中每个像元的辐亮度理论真值和辐亮度，计算得到再定标系数。根据本发明的实施例，获得模块640包括获取单元、第一反演单元、第二反演单元和第三获得单元。获取单元，用于从大气再分析资料数据中分别获取基准参考载荷和待校准载荷过境目标区域的环境参数。第一反演单元，用于根据与基准参考载荷对应的环境参数和基准影像中每个像元的辐亮度，反演得到基准影像中每个像元的地表反射率。第二反演单元，用于根据与待校准载荷对应的环境参数和待校准影像中每个像元的经再定标后的辐亮度，反演得到待校准影像中每个像元的地表反射率。第三获得单元，用于对基准影像和待校准影像中每个像元的地表反射率进行角度归一化处理和映射处理，得到基准影像和待校准影像中每个像元的像素值。根据本发明的实施例，第三获得单元包括第三计算子单元、第四计算子单元、第二获得子单元、第三获得子单元和第四获得子单元。第三计算子单元，用于根据基准参考载荷与目标区域之间的观测角度信息，计算得到与基准参考载荷对应的二向反射因子。第四计算子单元，用于根据待校准载荷与目标区域之间的观测角度信息，计算得到与待校准载荷对应的二向反射因子。第二获得子单元，用于根据与基准参考载荷对应的二向反射因子和与待校准载荷对应的二向反射因子，得到角度转换系数。第三获得子单元，用于根据角度转换系数和待校准影像中每个像元的地表反射率，得到与待校准影像中每个像元对应的经角度归一化处理后的地表反射率。第四获得子单元，用于将与待校准影像中每个像元对应的经角度归一化处理后的地表反射率映射到目标像素值区间，得到待校准影像中每个像元的像素值。将基准影像中每个像元的地表反射率映射到目标像素值区间，得到基准影像中每个像元的像素值。根据本发明的实施例，生成模块650包括第四获得单元、第三确定单元、第一生成单元、第四确定单元、第五获得单元和第二生成单元。第四获得单元，用于将待校准影像的重叠区域中每个像元的像素值进行去重处理，得到唯一像素值集合。第三确定单元，用于针对唯一像素值集合中的每个唯一像素值，从待校准影像的重叠区域中确定像素值为唯一像素值的像元的位置信息。第一生成单元，用于根据唯一像素值集合中的每个唯一像素值和与唯一像素值对应的像元的位置信息，生成唯一像素值列表。第四确定单元，用于针对唯一像素值列表中的每个唯一像素值，根据与唯一像素值对应的像元的位置信息，确定基准影像的重叠区域中与位置信息对应的像元的像素值。第五获得单元，用于根据基准影像的重叠区域中与位置信息对应的像元的像素值，得到与每个唯一像素值对应的参考像素值。第二生成单元，用于基于得到的多个参考像素值，生成参考像素值列表。根据本发明的实施例，拟合模块660包括第六获得单元、划分单元、拟合单元、第七获得单元、更新单元和转换单元。第六获得单元，用于以唯一像素值列表中的唯一像素值为第一坐标，以参考像素值列表中与唯一像素值对应的参考像素值为第二坐标，得到多个数据点。划分单元，用于将多个数据点按照区间宽度进行划分，得到多个区间。拟合单元，用于针对每个区间，对区间中的数据点进行多项式拟合，得到与区间对应的回归曲线。第七获得单元，用于基于与每个区间对应的回归曲线，得到拟合曲线。更新单元，用于根据拟合曲线，对待校准影像中每个像元的像素值进行更新，得到新的待校准影像。转换单元，用于将新的待校准影像中每个像元的像素值转换成地表反射率，得到经基准影像辐射一致性校正后的待校准影像。根据本发明的实施例，计算模块610、匹配模块620、校正模块630、获得模块640、生成模块650和拟合模块660中的任意多个模块可以合并在一个模块中实现，或者其中的任意一个模块可以被拆分成多个模块。或者，这些模块中的一个或多个模块的至少部分功能可以与其他模块的至少部分功能相结合，并在一个模块中实现。根据本发明的实施例，计算模块610、匹配模块620、校正模块630、获得模块640、生成模块650和拟合模块660中的至少一个可以至少被部分地实现为硬件电路，例如现场可编程门阵列、可编程逻辑阵列、片上系统、基板上的系统、封装上的系统、专用集成电路，或可以通过对电路进行集成或封装的任何其他的合理方式等硬件或固件来实现，或以软件、硬件以及固件三种实现方式中任意一种或以其中任意几种的适当组合来实现。或者，计算模块610、匹配模块620、校正模块630、获得模块640、生成模块650和拟合模块660中的至少一个可以至少被部分地实现为计算机程序模块，当该计算机程序模块被运行时，可以执行相应的功能。图7示出了根据本发明实施例的适于实现组网卫星光学载荷辐射一致性校正方法的电子设备的方框图。如图7所示，根据本发明实施例的电子设备700包括处理器701，其可以根据存储在只读存储器702中的程序或者从存储部分708加载到随机访问存储器703中的程序而执行各种适当的动作和处理。处理器701例如可以包括通用微处理器、指令集处理器和/或相关芯片组和/或专用微处理器）等等。处理器701还可以包括用于缓存用途的板载存储器。处理器701可以包括用于执行根据本发明实施例的方法流程的不同动作的单一处理单元或者是多个处理单元。在RAM 703中，存储有电子设备700操作所需的各种程序和数据。处理器 701、ROM702以及RAM 703通过总线704彼此相连。处理器701通过执行ROM 702和/或RAM 703中的程序来执行根据本发明实施例的方法流程的各种操作。需要注意，所述程序也可以存储在除ROM 702和RAM 703以外的一个或多个存储器中。处理器701也可以通过执行存储在所述一个或多个存储器中的程序来执行根据本发明实施例的方法流程的各种操作。根据本发明的实施例，电子设备700还可以包括输入/输出接口705，输入/输出接口705也连接至总线704。电子设备700还可以包括连接至输入/输出接口705的以下部件中的一项或多项：包括键盘、鼠标等的输入部分706；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分707；包括硬盘等的存储部分708；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分709。通信部分709经由诸如因特网的网络执行通信处理。驱动器710也根据需要连接至输入/输出接口705。可拆卸介质711，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器710上，以便于从其上读出的计算机程序根据需要被安装入存储部分708。本发明还提供了一种计算机可读存储介质，该计算机可读存储介质可以是上述实施例中描述的设备/装置/系统中所包含的；也可以是单独存在，而未装配入该设备/装置/系统中。上述计算机可读存储介质承载有一个或者多个程序，当上述一个或者多个程序被执行时，实现根据本发明实施例的方法。根据本发明的实施例，计算机可读存储介质可以是非易失性的计算机可读存储介质，例如可以包括但不限于：便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本发明中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。例如，根据本发明的实施例，计算机可读存储介质可以包括上文描述的ROM 702和/或RAM 703和/或ROM 702和RAM 703以外的一个或多个存储器。本发明的实施例还包括一种计算机程序产品，其包括计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。当计算机程序产品在计算机系统中运行时，该程序代码用于使计算机系统实现本发明实施例所提供的方法。在该计算机程序被处理器701执行时执行本发明实施例的系统/装置中限定的上述功能。根据本发明的实施例，上文描述的系统、装置、模块、单元等可以通过计算机程序模块来实现。在一种实施例中，该计算机程序可以依托于光存储器件、磁存储器件等有形存储介质。在另一种实施例中，该计算机程序也可以在网络介质上以信号的形式进行传输、分发，并通过通信部分709被下载和安装，和/或从可拆卸介质711被安装。该计算机程序包含的程序代码可以用任何适当的网络介质传输，包括但不限于：无线、有线等等，或者上述的任意合适的组合。在这样的实施例中，该计算机程序可以通过通信部分709从网络上被下载和安装，和/或从可拆卸介质711被安装。在该计算机程序被处理器701执行时，执行本发明实施例的系统中限定的上述功能。根据本发明的实施例，上文描述的系统、设备、装置、模块、单元等可以通过计算机程序模块来实现。根据本发明的实施例，可以以一种或多种程序设计语言的任意组合来编写用于执行本发明实施例提供的计算机程序的程序代码，具体地，可以利用高级过程和/或面向对象的编程语言、和/或汇编/机器语言来实施这些计算程序。程序设计语言包括但不限于诸如Java，C++，python，“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。在涉及远程计算设备的情形中，远程计算设备可以通过任意种类的网络，包括局域网或广域网，连接到用户计算设备，或者，可以连接到外部计算设备。附图中的流程图和框图，图示了按照本发明各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。本领域技术人员可以理解，本发明的各个实施例和/或权利要求中记载的特征可以进行多种组合或/或结合，即使这样的组合或结合没有明确记载于本发明中。特别地，在不脱离本发明精神和教导的情况下，本发明的各个实施例和/或权利要求中记载的特征可以进行多种组合和/或结合。所有这些组合和/或结合均落入本发明的范围。以上对本发明的实施例进行了描述。但是，这些实施例仅仅是为了说明的目的，而并非为了限制本发明的范围。尽管在以上分别描述了各实施例，但是这并不意味着各个实施例中的措施不能有利地结合使用。本发明的范围由所附权利要求及其等同物限定。不脱离本发明的范围，本领域技术人员可以做出多种替代和修改，这些替代和修改都应落在本发明的范围之内。
