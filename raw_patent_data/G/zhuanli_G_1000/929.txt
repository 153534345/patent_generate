标题title
基于融合规则强化学习的储能充放电控制决策方法及装置
摘要abst
本说明书涉及电力技术领域，尤其涉及基于融合规则强化学习的储能充放电控制决策方法及装置，应用于电网及用户侧光伏储能设备，包括：将任意时间段的用户用电功率、储能电池的荷电状态、室外温度、太阳光辐照度、电网用电单价、电网卖电单价，确定状态空间；将状态空间输入至基于融合规则强化学习的充放电控制决策模型，得到最优充放电决策变量，其中最优充放电决策变量包括：储能电池最优充放电功率及最优系数，基于融合规则强化学习的充放电控制决策模型通过样本状态空间、光伏发电不确定模型训练得到。本说明书融合预先定义规则，提高强化学习训练收敛至最优充放电控制策略的速度，提高用电经济性，降低电网功率波动和负担。
权利要求书clms
1.一种基于融合规则强化学习的储能充放电控制决策方法，其特征在于，所述方法应用于电网及用户侧光伏储能设备，其中，用户侧光伏储能设备包括：光伏发电装置、用户用电装置及储能电池，所述方法包括：将任意时间段的用户用电功率、储能电池的荷电状态、室外温度、太阳光辐照度、电网用电单价、电网卖电单价，确定状态空间；将所述状态空间输入至基于融合规则强化学习的充放电控制决策模型，得到任意时间段的最优充放电决策变量，其中，所述最优充放电决策变量包括：储能电池最优充放电功率及最优系数，所述基于融合规则强化学习的充放电控制决策模型通过样本状态空间、光伏发电不确定模型训练得到。2.根据权利要求1所述的基于融合规则强化学习的储能充放电控制决策方法，其特征在于，基于融合规则强化学习的充放电控制决策模型通过如下步骤训练得到：根据样本时间段与用户用电装置、储能电池、电网相关的状态变量及环境变量，确定样本状态空间；根据光伏发电不确定模型，构建充放电控制决策基础模型，其中，所述光伏发电不确定模型为考虑环境变量的高斯分布模型；将样本状态空间中的状态变量输入至所述充放电控制决策基础模型，输出充放电决策变量；根据预设充放电规则约束所述充放电决策变量，利用奖励函数迭代训练所述充放电控制决策基础模型，得到训练完成的充放电控制决策模型。3.根据权利要求2所述的基于融合规则强化学习的储能充放电控制决策方法，其特征在于，通过如下方式，确定样本时间段储能电池的状态变量：获取样本时间段之前的历史样本时段储能电池的荷电功率；根据历史样本时段储能电池的荷电功率，通过如下公式确定样本时间段储能电池的荷电状态：；其中，k表示当前样本时间段，/＞为第1个样本时间段的储能电池的荷电状态；/＞为储能电池的自放电率；/＞为储能电池的开路电压；/＞为储能电池的额定容量；/＞为储能电池的充放电效率；/＞，/＞，/＞为第i个样本时间段的储能电池充放电功率，当储能电池放电时，/＞，当储能电池充电时，/＞；/＞，/＞，为第i时间段的效率指数，其满足：/＞。4.根据权利要求2所述的基于融合规则强化学习的储能充放电控制决策方法，其特征在于，在输出充放电决策变量之后，所述方法还包括：基于服从高斯分布光伏发电不确定模型，确定样本时间段的光伏发电功率；根据充放电控制决策基础模型输出的决策变量、样本时间段的光伏发电功率与用户用电功率之差，确定样本时间段光伏发电装置输出到电网的功率。5.根据权利要求4所述的基于融合规则强化学习的储能充放电控制决策方法，其特征在于，所述方法包括：通过如下公式确定光伏发电不确定模型： ；其中，/＞为样本时间段的光伏发电功率；/＞为光电转换效率；/＞为光伏材料面积；表示样本时间段的太阳光辐照度；/＞为方差；光伏发电功率服从均值期望为、方差为/＞的高斯分布；根据光伏发电不确定模型得到的光伏发电功率，通过如下公式确定光伏发电装置的输出到电网的功率：；其中，/＞为第k个样本时间段光伏发电装置输出到电网的功率；/＞为第k个样本时间段的用户用电功率；/＞表示第k个样本时间段光的光伏发电功率；/＞为比例权重，/＞。6.根据权利要求5所述的基于融合规则强化学习的储能充放电控制决策方法，其特征在于，通过如下方式确定预设充放电规则包括：若当前时段属于用电高峰时间段，设定储能电池的充放电功率为负；若当前时段属于用电低谷时间段，设定储能电池的充放电功率为正；若光伏发电功率小于负载功率，设定所述比例权重为零；若光伏发电功率大于负载功率，设定所述比例权重为比例权重原本值；根据上述预设充放电规则，约束充放电控制决策模型中的决策变量。7.根据权利要求6所述的基于融合规则强化学习的储能充放电控制决策方法，其特征在于，利用奖励函数迭代训练所述充放电控制决策基础模型包括：根据各时段的卖电单价、用电单价、各时段从电网的输入功率，确定经济性奖励函数；根据当前时刻的储能电池充放电功率及上一时刻储能电池的充放电功率，构建平顺性奖励函数；根据各时段的电网的输入功率，确定最大需求功率奖励函数；根据储能电池的最小荷电状态、储能电池的最大荷电状态及当前时刻储能电池的荷电状态，确定约束惩罚奖励函数；根据所述经济性奖励函数、平顺性奖励函数、最大需求功率奖励函数及约束惩罚奖励函数，迭代训练所述充放电控制决策模型，当上述奖励取得最大值且在预设迭代次数中保持稳定，确定充放电控制决策模型训练完成。8.一种基于融合规则强化学习的光伏储能系统，其特征在于，所述系统包括：电网，与用户侧光伏储能设备通信连接，用于向用户侧光伏储能设备供电；用户侧光伏储能设备，包括：光伏发电装置、用户用电装置及储能电池，其中，所述光伏发电装置用于向用户用电装置提供光伏发电的电量，并用于当电量剩余时，将剩余电量输送至储能电池或电网；所述储能电池用于存储光伏发电装置的剩余电量，并用于向用户用电装置供电。9.一种基于融合规则强化学习的储能充放电控制决策装置，其特征在于，所述装置包括：状态空间构建单元，用于将任意时间段的用户用电功率、储能电池的荷电状态、室外温度、太阳光辐照度、电网用电单价、电网卖电单价，确定状态空间；最优充放电决策变量确定单元，用于将所述状态空间输入至基于融合规则强化学习的充放电控制决策模型，得到任意时间段的最优充放电决策变量，其中，所述最优充放电决策变量包括：储能电池最优充放电功率及最优系数，所述基于融合规则强化学习的充放电控制决策模型通过样本状态空间、光伏发电不确定模型训练得到。10.一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至7任意一项所述的方法。11.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现权利要求1至7任意一项所述的方法。
说明书desc
技术领域本说明书涉及电力技术领域，尤其是基于融合规则强化学习的储能充放电控制决策方法及装置。背景技术随着第三产业、城乡居民用户的用电总量和用电占比不断提升，用电高峰时电网峰值负荷需求不断提高，且峰谷电价差进一步拉大并维持高位。为了降低电网负荷波动、减少电网扩容成本和提升电力系统经济效率，用户侧储能技术受到了广泛关注，拥有着较大的发展潜力。在用户侧储能技术领域，用户侧光伏储能同时包含了光伏发电、储能电池和电网供电，不同电力设备之间的高效协调亟待解决。现有研究主要关注用户侧储能设施的最优配置和储能规划方法。通过计算储能系统在充电时段需配置的第一功率和第一容量、放电时段需配置的第二功率和第二容量，取第一功率和第二功率中的最大值作为储能系统需配置的功率，取第一容量和第二容量中的最小值作为储能系统需配置的容量，提高了削峰填谷的收益。现有技术中也有用户储能规划方法，构建用户侧储能规划模型，通过最小化初期消耗、运维消耗、电力消耗和基本消耗的综合目标函数，求解得到最优规划模型参数，模型简单、无法自适应调整，且未考虑光伏发电因素。此外，光伏发电受灰尘、温度和遮挡等不确定性因素的影响，其发电功率具有不确定性。因此，考虑光伏发电不确定性的用户侧储能运行控制有待进一步优化。发明内容为解决上述现有技术中未考虑光伏发电不确定性的用户侧储能问题，本说明书实施例提供了基于融合规则强化学习的充放电控制决策模型训练方法。本说明书实例提供了一种基于融合规则强化学习的储能充放电控制决策方法，所述方法应用于电网及用户侧光伏储能设备，其中，用户侧光伏储能设备包括：光伏发电装置、用户用电装置及储能电池，所述方法包括：将任意时间段的用户用电功率、储能电池的荷电状态、室外温度、太阳光辐照度、电网用电单价、电网卖电单价，确定状态空间；将所述状态空间输入至基于融合规则强化学习的充放电控制决策模型，得到任意时间段的最优充放电决策变量，其中，所述最优充放电决策变量包括：储能电池最优充放电功率及最优系数，所述基于融合规则强化学习的充放电控制决策模型通过样本状态空间、光伏发电不确定模型训练得到。根据本说明书实施例的一个方面，基于融合规则强化学习的充放电控制决策模型通过如下步骤训练得到：根据样本时间段与用户用电装置、储能电池、电网相关的状态变量及环境变量，确定样本状态空间；根据光伏发电不确定模型，构建充放电控制决策基础模型，其中，所述光伏发电不确定模型为考虑环境变量的高斯分布模型；将样本状态空间中的状态变量输入至所述充放电控制决策基础模型，输出充放电决策变量；根据预设充放电规则约束所述充放电决策变量，利用奖励函数迭代训练所述充放电控制决策基础模型，得到训练完成的充放电控制决策模型。根据本说明书实施例的一个方面，通过如下方式，确定样本时间段储能电池的状态变量：获取样本时间段之前的历史样本时段储能电池的荷电功率；根据历史样本时段储能电池的荷电功率，通过如下公式确定样本时间段储能电池的荷电状态：；其中，k表示当前样本时间段，/＞为第1个样本时间段的储能电池的荷电状态；/＞为储能电池的自放电率；/＞为储能电池的开路电压；/＞为储能电池的额定容量；/＞为储能电池的充放电效率；/＞，/＞，/＞为第i个样本时间段的储能电池充放电功率，当储能电池放电时，/＞，当储能电池充电时，/＞；/＞，/＞，为第i个时间段的效率指数，其满足：/＞。根据本说明书实施例的一个方面，根据光伏发电不确定模型，构建储能装置的充放电控制决策基础模型包括：基于服从高斯分布光伏发电不确定模型，确定样本时间段的光伏发电功率；根据样本时间段的光伏发电功率与用户用电功率之差，确定样本时间段光伏发电装置输出到电网的功率。根据本说明书实施例的一个方面，所述方法包括：通过如下公式确定光伏发电不确定模型：；其中，/＞为样本时间段的光伏发电功率；/＞为光电转换效率；/＞为光伏材料面积；/＞表示样本时间段的太阳光辐照度；/＞为方差；光伏发电功率服从均值期望为/＞、方差为/＞的高斯分布；根据光伏发电不确定模型得到的光伏发电功率，通过如下公式确定光伏发电装置的输出到电网的功率：/＞；其中，/＞为样本时间段光伏发电装置输出到电网的功率；Pload为用户用电功率；/＞表示光伏发电功率；/＞为比例权重，/＞。根据本说明书实施例的一个方面，通过如下方式确定预设充放电规则包括：若当前时段属于用电高峰时间段，设定储能电池的充放电功率为负；若当前时段属于用电低谷时间段，设定储能电池的充放电功率为正；若光伏发电功率小于负载功率，设定所述比例权重为零；若光伏发电功率大于负载功率，设定所述比例权重为比例权重原本值；根据上述预设充放电规则，约束充放电控制决策模型中的决策变量。根据本说明书实施例的一个方面，利用奖励函数迭代训练所述充放电控制决策基础模型包括：根据各时段的卖电单价、用电单价、各时段从电网的输入功率，确定经济性奖励函数；根据当前时刻的储能电池充放电功率及上一时刻储能电池的充放电功率，构建平顺性奖励函数；根据各时段的电网的输入功率，确定最大需求功率奖励函数；根据储能电池的最小荷电状态、储能电池的最大荷电状态及当前时刻储能电池的荷电状态，确定约束惩罚奖励函数；根据所述经济性奖励函数、平顺性奖励函数、最大需求功率奖励函数及约束惩罚奖励函数，迭代训练所述充放电控制决策模型，当上述奖励取得最大值且在预设迭代次数中保持稳定，确定充放电控制决策模型训练完成。本说明书实施例还提供了一种基于融合规则强化学习的光伏储能系统，所述系统包括：电网，与用户侧光伏储能设备通信连接，用于向用户侧光伏储能设备供电；用户侧光伏储能设备，包括：光伏发电装置、用户用电装置及储能电池，其中，所述光伏发电装置用于向用户用电装置提供光伏发电的电量，并用于当电量剩余时，将剩余电量输送至储能电池或电网；所述储能电池用于存储光伏发电装置的剩余电量，并用于向用户用电装置供电。本说明书实施例还提供了一种基于融合规则强化学习的充放电控制决策模型训练装置，所述装置包括：样本状态空间构建单元，用于根据样本时间段与用户用电装置、储能电池、电网相关的状态变量及环境变量，确定样本状态空间；基础模型构建单元，用于根据光伏发电不确定模型，构建储能装置的充放电控制决策基础模型，其中，所述光伏发电不确定模型为考虑环境变量的高斯分布模型；输出单元，用于将样本状态空间中的状态变量输入至所述充放电控制决策基础模型，输出充放电决策变量；模型训练单元，用于根据预设充放电规则，迭代训练所述充放电控制决策基础模型，直到基础模型满足预设条件，得到训练完成的充放电控制决策模型。本说明书实施例提供了一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现所述基于融合规则强化学习的充放电控制决策模型训练方法。本说明书实施例还提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现所述基于融合规则强化学习的充放电控制决策模型训练方法。本说明书融合预先定义的规则，提高强化学习训练收敛至最优充放电控制策略的速度，降低电网功率波动和负担。附图说明为了更清楚地说明本说明书实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本说明书的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1所示为本说明书实施例一种基于融合规则强化学习的充放电控制决策方法的流程图；图2所示为本说明书实施例一种训练基于融合规则强化学习的充放电控制决策模型的方法流程图；图3所示为本说明书实施例一种构建充放电控制决策基础模型的方法流程图；图4所示为本说明书实施例一种确定样本时间段储能电池的状态变量的方法流程图；图5所示为本说明书实施例一种确定预设充放电规则的方法流程图；图6所示为本说明书实施例一种利用奖励函数迭代训练所述充放电控制决策基础模型的方法流程图；图7所示为本说明书实施例一种基于融合规则强化学习的光伏储能系统的示意图；图8所示为本说明书实施例一种基于融合规则强化学习的充放电控制决策模型训练装置的结构示意图；图9所示为本说明书实施例一种计算机设备的结构示意图。附图符号说明：701、电网；702、用户侧光伏储能设备；703、光伏发电装置；704、用户用电装置；705、储能电池；801、状态空间构建单元；802、最优充放电决策变量确定单元；902、计算机设备；904、处理器；906、存储器；908、驱动机构；910、输入/输出模块；912、输入设备；914、输出设备；916、呈现设备；918、图形用户接口；920、网络接口；922、通信链路；924、通信总线。具体实施方式为了使本技术领域的人员更好地理解本说明书中的技术方案，下面将结合本说明书实施例中的附图，对本说明书实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本说明书一部分实施例，而不是全部的实施例。基于本说明书中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本说明书保护的范围。需要说明的是，本说明书的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本说明书的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、装置、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。本说明书提供了如实施例或流程图所述的方法操作步骤，但基于常规或者无创造性的劳动可以包括更多或者更少的操作步骤。实施例中列举的步骤顺序仅仅为众多步骤执行顺序中的一种方式，不代表唯一的执行顺序。在实际中的系统或装置产品执行时，可以按照实施例或者附图所示的方法顺序执行或者并行执行。需要说明的是，本说明书的基于融合规则强化学习的储能充放电控制决策方法及装置可用于电力技术领域，本说明书对基于融合规则强化学习的储能充放电控制决策方法及装置的应用领域不做限定。图1所示为本说明书实施例一种基于融合规则强化学习的充放电控制决策方法的流程图，具体包括如下步骤：步骤101，将任意时间段的用户用电功率、储能电池的荷电状态、室外温度、太阳光辐照度、电网用电单价、电网卖电单价，确定状态空间。本步骤应用于模型应用阶段，与模型训练阶段构建状态样本空间类似，取任意未知时间段的用户用电功率、储能电池的荷电状态、室外温度、太阳光辐照度、电网用电单价、电网卖电单价，确定状态空间。步骤102，将所述状态空间输入至基于融合规则强化学习的充放电控制决策基础模型，得到所述任意时间段的最优充放电决策变量。其中，所述最优充放电决策变量包括：储能电池最优充放电功率及最优系数，所述基于融合规则强化学习的充放电控制决策模型通过样本状态空间、光伏发电不确定模型训练得到。本步骤中，将状态空间作为最优策略网络的输入，输出该时间段的用户侧储能电池的最优充放电动作。本步骤中，关于基于融合规则强化学习的充放电控制决策模型的训练过程详见图2描述。图2所示为本说明书实施例一种训练基于融合规则强化学习的充放电控制决策模型的方法流程图，具体包括如下步骤：步骤201，根据样本时间段与用户用电装置、储能电池、电网相关的状态变量及环境变量，确定样本状态空间。在本步骤中，用户用电装置相关的状态变量为用户负荷功率，其中，样本时间段的用户负荷功率可以由表示；储能电池相关的状态变量为储能电池的荷电状态，可以由/＞表示；电网相关的状态变量为用电单价、卖电单价，其中，样本时间段的用电单价可以由/＞表示；样本时间段的卖电单价可以由/＞表示。环境变量为室外空气温度及太阳光辐照度。其中，样本时间段的室外空气温度可以由/＞表示；样本时间段的太阳光辐照度可以由/＞表示。将上述同一样本时间段的状态变量及环境变量，确定为样本状态空间，后续用于充放电控制决策基础模型的输入。步骤202，根据光伏发电不确定模型，构建充放电控制决策基础模型，其中，所述光伏发电不确定模型为考虑环境变量的高斯分布模型。在本步骤中，通过构建样本状态空间、动作空间，结合光伏发电不确定模型，构建用户侧光伏储能设备的充放电控制决策基础模型。充放电控制决策基础模型为策略网络，基础模型由全连接神经网络构建。其中，充放电控制决策基础模型通过随机初始化策略网络的参数得到。本说明书实施例的动作空间可以如下表示：；其中，/＞表示储能电池的最大充电功率，/＞表示储能电池的最大放电功率。步骤203，将样本状态空间中的状态变量输入至所述充放电控制决策基础模型，输出充放电决策变量。决策变量为储能电池的充放电功率及比例权重。其中，比例权重决定光伏输出到电网的功率，目的在于将光伏发电多余的电量卖入电网赚取经济利润。步骤204，根据预设充放电规则约束所述充放电决策变量，利用奖励函数迭代训练所述充放电控制决策基础模型，得到训练完成的充放电控制决策模型。本步骤中，采用融合规则的强化学习方法，迭代训练所述充放电控制决策基础模型，直到获得使得奖励最大的模型得到充放电控制决策模型。在本说明书实施例中，将充放电控制决策模型的状态变量作为策略网络的输入，动作网络输出充放电控制决策模型的动作变量/＞；采用预先定义的规则校正动作变量。进一步的，利用奖励函数训练充放电控制决策基础模型，当充放电控制决策模型的奖励函数的值达到最大，且在一定迭代时间或迭代次数内保持稳定，则将最大奖励值对应的策略网络确定充放电控制决策基础模型，模型训练完成。本说明书融合预先定义的规则，提高强化学习训练收敛至最优充放电控制策略的速度，提高用电经济性，降低电网功率波动和负担。图3所示为本说明书实施例一种构建充放电控制决策基础模型的方法流程图，具体包括如下步骤：步骤301，基于服从高斯分布光伏发电不确定模型，确定样本时间段的光伏发电功率。在本说明书实施例中，光伏发电不确定性模型能够确定第k样本时间段的光伏发电功率，利用光伏发电不确定性模型计算光伏发电功率，考虑了环境因素，包括环境温度、太阳光辐照度，第k样本时间段的光伏发电功率服从均值期望为，方差为/＞的高斯分布，其中，/＞为样本时间段的光伏发电功率；/＞为光电转换效率；/＞为光伏材料面积；/＞表示样本时间段的太阳光辐照度；/＞为方差。本说明书考虑了环境因素造成的光伏发电的不确定性，实现了光伏发电装置、储能电池和电网之间的协调，降低了用户经济成本和电网供电负荷。步骤302，根据充放电控制决策基础模型输出的决策变量、样本时间段的光伏发电功率与用户用电功率之差，确定样本时间段光伏发电装置输出到电网的功率。在本步骤中，充放电控制决策基础模型输出的决策变量包括比例权重及储能电池的充放电功率。根据前述步骤可知，样本时间段的光伏发电功率由/＞表示。在本步骤中，样本时间段的光伏发电装置输出到电网的功率由如下公式表示：；其中，/＞为第k个样本时间段光伏发电装置输出到电网的功率；/＞为第k个样本时间段的用户用电功率；/＞表示第k个样本时间段的光伏发电功率；/＞为比例权重，/＞。其中，用户用电功率可以直接采集得到。上述光伏发电装置输出到电网的功率公式表示：光伏发电装置发电电量优先供给用户使用，若有剩余电量则分配给储能电池或电网。在本说明书实施例中，光伏发电装置输出到电网的功率、比例权重为训练充放电控制决策基础模型的决策变量。在本说明书另外一些实施例中，电力平衡方程用于描述电网及用户侧光伏储能设备组成的系统，在运行状态时的电力输入及输出的平衡。电力平衡方程由如下公式表示：，/＞为第k个样本时间段从电网输入的功率；/＞为第k个样本时间段输出到电网的功率，其由光伏发电装置提供；/＞为第k个样本时间段的用户用电功率；/＞表示第k个样本时间段的光伏发电功率。图4所示为本说明书实施例一种确定样本时间段储能电池的状态变量的方法流程图，具体包括如下步骤：步骤401，获取样本时间段之前的历史样本时段储能电池的荷电功率。在本步骤中，样本时间段之前的历史样本时段为：当前样本时段之前的所有历史样本时段。例如，当前样本时间段为第k个样本时间段，则样本时间段之前的历史样本时段为第k-1个样本时间段、第k-2个样本时间段……第2个样本时间段、第1个样本时间段。在本说明书实施例中，历史样本时段的储能电池的荷电功率可以采集获取得到。步骤402，根据历史样本时段储能电池的荷电功率，确定样本时间段储能电池的荷电状态。本步骤中，具体通过如下公式确定样本时间段储能电池的荷电状态：；其中，k表示当前样本时间段，/＞为第1个样本时间段的储能电池的荷电状态；/＞为储能电池的自放电率；/＞为储能电池的开路电压；/＞为储能电池的额定容量；/＞为储能电池的充放电效率；/＞，/＞，/＞为第i个样本时间段的储能电池充放电功率，当储能电池放电时，/＞，当储能电池充电时，/＞；/＞，/＞，为第i时间段的效率指数，其满足：/＞。在本说明书实施例中，通过如下公式确定光伏发电不确定模型：；其中，/＞为样本时间段的光伏发电功率；/＞为光电转换效率；/＞为光伏材料面积；/＞表示样本时间段的太阳光辐照度；/＞为方差；光伏发电功率服从均值期望为/＞、方差为/＞的高斯分布；根据光伏发电不确定模型得到的光伏发电功率，通过如下公式确定光伏发电装置的输出到电网的功率：；其中，/＞为第k个样本时间段光伏发电装置输出到电网的功率；/＞为第k个样本时间段的用户用电功率；/＞表示第k个样本时间段光的光伏发电功率；/＞为比例权重，/＞。图5所示为本说明书实施例一种确定预设充放电规则的方法流程图，具体包括如下步骤：步骤501，若当前时段属于用电高峰时间段，设定储能电池的充放电功率为负。本步骤中的预设充放电规则表示在用电高峰时间段，禁止储能电池充电，由此确保储能电池的在用电高峰时间段能全面供给用户用电装置使用，提高储能电池在用电高峰时间段的利用效率。步骤502，若当前时段属于用电低谷时间段，设定储能电池的充放电功率为正。本步骤中的预设充放电规则表示在用电低估时间段，允许储能电池充电，由此；其中，F表示用电高峰时间段集合，G表示用电低谷时间段集合；/＞表示第k时间段的储能电池的充放电功率，步骤503，若光伏发电功率小于负载功率，设定所述比例权重为零。本步骤中的预设充放电规则表示：若光伏发电装置的发电功率小于用户用电装置的负载功率，光伏发电装置无法再向储能电池或电网供电，则设定比例权重为0。步骤504，若光伏发电功率大于负载功率，设定所述比例权重为比例权重原本值。本步骤中，预设规则表示当光伏发电装置的发电功率大于用户用电装置的用电功率，则光伏发电装置可以向储能电池或电网供电，则比例权重保留为其原有的值。在本说明书实施例中，根据上述预设充放电规则，可以约束充放电控制决策模型中的决策变量，利用规则可以加速强化学习的效率及模型迭代的效率。图6所示为本说明书实施例一种利用奖励函数迭代训练所述充放电控制决策基础模型的方法流程图，具体包括如下步骤：步骤601，根据各时段的卖电单价、用电单价、各时段从电网的输入功率，确定经济性奖励函数。在本说明书实施例中，经济型奖励函数可以由如下公式确定：其中，为第k时间段的经济性奖励；表示第i个样本时间段从电网输入的功率；表示第i个样本时间段输出到电网的功率，N表示时间段的总数量；表示第i个样本时间段的用电单价，/＞表示第i个样本时间段的卖电单价。步骤602，根据当前时刻的储能电池充放电功率及上一时刻储能电池的充放电功率，构建平顺性奖励函数。具体的，平顺性奖励函数由如下公式表示：；式中，为第k样本时间段的平顺性奖励；/＞和/＞分别为第k时间段和第k-1时间段的储能电池充放电功率。步骤603，根据各时段的电网的输入功率，确定最大需求功率奖励函数。本步骤中，最大需求功率奖励函数由如下公式表示： ；式中，为第k时间段的最大需求功率奖励函数。最大需求奖励函数用于尽量减少电网的输入功率，减轻用电高峰期的用电网负担。步骤604，根据储能电池的最小荷电状态、储能电池的最大荷电状态及当前时刻储能电池的荷电状态，确定约束惩罚奖励函数。约束惩罚奖励函数可以由如下公式表示：；式中，为第k样本时间段的约束惩罚奖励函数，/＞为指数参数；/＞和分别为储能电池的最小荷电状态和最大荷电状态。约束惩罚奖励函数目的在于约束储能电池的荷电状态，避免损伤电池。步骤605，根据所述经济性奖励函数、平顺性奖励函数、最大需求功率奖励函数及约束惩罚奖励函数，迭代训练所述充放电控制决策模型，当上述奖励取得最大值且在预设迭代次数中保持稳定，确定充放电控制决策模型训练完成。在本说明书实施例中，根据前述步骤构建的经济型奖励函数、平顺性奖励函数、最大需求功率奖励函数、约束惩罚奖励函数，确定充放电控制决策模型的奖励函数，如下公式表示：；式中，为第k时间段的奖励；/＞、/＞、/＞和/＞分别为第k样本时间段的经济性奖励、平顺性奖励、最大需求功率奖励和约束惩罚奖励；/＞、/＞、/＞和/＞为权重系数。根据所述奖励函数迭代训练充放电控制决策模型，当奖励取得最大值且在预设迭代次数中保持稳定或在模型训练一段时间内保持稳定，确定充放电控制决策模型训练完成。图7所示为本说明书实施例一种基于融合规则强化学习的光伏储能系统的示意图，所述系统包括：电网701、用户侧光伏储能设备702。其中，电网701与用户侧光伏储能设备702通信连接，用于向用户侧光伏储能设备702供电。用户侧光伏储能设备702包括：光伏发电装置703、用户用电装置704及储能电池705，其中，所述光伏发电装置703用于向用户用电装置704提供光伏发电的电量，并用于当电量剩余时，将剩余电量输送至储能电池705或电网701。所述储能电池705用于存储光伏发电装置703的剩余电量，并用于向用户用电装置704供电。如图8所示为本说明书实施例一种基于融合规则强化学习的充放电控制决策装置的结构示意图，在本图中描述了基于融合规则强化学习的充放电控制决策装置的基本结构，其中的功能单元、模块可以采用软件方式实现，也可以采用通用芯片或者特定芯片实现基于融合规则强化学习的充放电控制决策，该装置具体包括：状态空间构建单元801，用于将任意时间段的用户用电功率、储能电池的荷电状态、室外温度、太阳光辐照度、电网用电单价、电网卖电单价，确定状态空间；最优充放电决策变量确定单元802，用于将所述状态空间输入至基于融合规则强化学习的充放电控制决策模型，得到任意时间段的最优充放电决策变量，其中，所述最优充放电决策变量包括：储能电池最优充放电功率及最优系数，所述基于融合规则强化学习的充放电控制决策模型通过样本状态空间、光伏发电不确定模型训练得到。本说明书针对用户侧光伏储能设施的光伏发电、储能电池和电网之间的协调问题，考虑了用户侧光伏储能设施的光伏发电不确定性，建立了光伏发电不确定模型，融合预先定义的规则，提高强化学习训练收敛至最优充放电控制策略的速度，并设计了经济性奖励、平顺性奖励、最大需求功率奖励和约束惩罚奖励，提高了用户侧用电经济性，降低了电网功率波动和负担。如图9所示为本说明书实施例提供的一种计算机设备，所述计算机设备用于执行所述基于融合规则强化学习的储能充放电控制决策方法，所述计算机设备902可以包括一个或多个处理器904，诸如一个或多个中央处理单元，每个处理单元可以实现一个或多个硬件线程。计算机设备902还可以包括任何存储器906，其用于存储诸如代码、设置、数据等之类的任何种类的信息。非限制性的，比如，存储器906可以包括以下任一项或多种组合：任何类型的RAM，任何类型的ROM，闪存设备，硬盘，光盘等。更一般地，任何存储器都可以使用任何技术来存储信息。进一步地，任何存储器可以提供信息的易失性或非易失性保留。进一步地，任何存储器可以表示计算机设备902的固定或可移除部件。在一种情况下，当处理器904执行被存储在任何存储器或存储器的组合中的相关联的指令时，计算机设备902可以执行相关联指令的任一操作。计算机设备902还包括用于与任何存储器交互的一个或多个驱动机构908，诸如硬盘驱动机构、光盘驱动机构等。计算机设备902还可以包括输入/输出模块910，其用于接收各种输入和用于提供各种输出。一个具体输出机构可以包括呈现设备916和相关联的图形用户接口918。在其他实施例中，还可以不包括输入/输出模块910、输入设备912以及输出设备914，仅作为网络中的一台计算机设备。计算机设备902还可以包括一个或多个网络接口920，其用于经由一个或多个通信链路922与其他设备交换数据。一个或多个通信总线924将上文所描述的部件耦合在一起。通信链路922可以以任何方式实现，例如，通过局域网、广域网、点对点连接等、或其任何组合。通信链路922可以包括由任何协议或协议组合支配的硬连线链路、无线链路、路由器、网关功能、名称服务器等的任何组合。对应于图1至图6中的方法，本说明书实施例还提供了一种计算机可读存储介质，该计算机可读存储介质上存储有计算机程序，该计算机程序被处理器运行时执行上述方法的步骤。本说明书实施例还提供一种计算机可读指令，其中当处理器执行所述指令时，其中的程序使得处理器执行如图1至图6所示的方法。应理解，在本说明书的各种实施例中，上述各过程的序号的大小并不意味着执行顺序的先后，各过程的执行顺序应以其功能和内在逻辑确定，而不应对本说明书实施例的实施过程构成任何限定。还应理解，在本说明书实施例中，术语“和/或”仅仅是一种描述关联对象的关联关系，表示可以存在三种关系。例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。另外，本说明书中字符“/”，一般表示前后关联对象是一种“或”的关系。本领域普通技术人员可以意识到，结合本说明书中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、计算机软件或者二者的结合来实现，为了清楚地说明硬件和软件的可互换性，在上述说明中已经按照功能一般性地描述了各示例的组成及步骤。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本说明书的范围。所属领域的技术人员可以清楚地了解到，为了描述的方便和简洁，上述描述的系统、装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在本说明书所提供的几个实施例中，应该理解到，所揭露的系统、装置和方法，可以通过其它的方式实现。例如，以上所描述的装置实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另外，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口、装置或单元的间接耦合或通信连接，也可以是电的，机械的或其它的形式连接。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本说明书实施例方案的目的。另外，在本说明书各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以是两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。所述集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本说明书的技术方案本质上或者说对现有技术做出贡献的部分，或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本说明书各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。本说明书中应用了具体实施例对本说明书的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本说明书的方法及其核心思想；同时，对于本领域的一般技术人员，依据本说明书的思想，在具体实施方式及应用范围上均会有改变之处，综上所述，本说明书内容不应理解为对本说明书的限制。
