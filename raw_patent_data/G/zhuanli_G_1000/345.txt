标题title
一种基于数据质量与强化学习的元任务小样本分类方法
摘要abst
本申请涉及一种基于数据质量与强化学习的元任务小样本分类方法，该方法包括：分别对标准化处理后的训练集和测试集进行采样，得到采样训练集和采样测试集；将采样训练集和采样测试集组合成一元学习任务；对计算出的每个权重进行归一化，得到每个任务对应的归一化权重；基于每个任务对应的归一化权重，确定每个任务的所属类别；对所属类别为0的任务，进行元策略优化，得到第一元策略以及第一参数；对所属类别为1的任务，进行元强化学习，得到第二元策略以及第二参数；基于第一元策略和第二元策略，得到混合策略；基于第一参数和第二参数，得到混合参数；基于混合策略和混合参数构建目标函数，并最大化目标函数，直至收敛，得到分类模型。
权利要求书clms
1.一种基于数据质量与强化学习的元任务小样本分类方法，用于对金融科技产品数据进行分类，其特征在于，包括：S1：获取金融科技产品数据的特征向量和类别标签，并构建原始数据集；所述特征向量包括金融科技产品的名称、描述、开发者、技术基础、种类；所述类别标签包括理财、支付、手机银行、借贷、股票、记账、保险、资讯、基金；S2：将所述原始数据集按比例划分为训练集和测试集，分别对标准化处理后的训练集和测试集进行采样，得到采样训练集和采样测试集；将所述采样训练集和所述采样测试集组合成一元学习任务；S3：采用数据质量评估函数计算所述元学习任务中每个任务的权重，并对计算出的每个权重进行归一化，得到每个任务对应的归一化权重；所述任务为二分类任务，所述任务包括对金融科技产品数据进行理财类型或支付类型分类、对金融科技产品数据进行借贷类型或股票类型分类、对金融科技产品数据进行记账类型或保险类型分类、对金融科技产品数据进行资讯类型或基金类型分类；每个所述任务中的数据为二分类任务中各类别标签对应的金融科技产品数据；数据质量评估函数的计算公式为：；其中，表示元学习任务中第k个任务的权重；f表示数据质量评估函数；/＞表示元学习任务中第k个任务的所有数据的集合；/＞表示元学习任务中第k个任务的第1条数据的质量；/＞表示元学习任务中第k个任务的第e条数据的质量；e表示元学习任务中第k个任务的所有数据的总条数；/＞表示元学习任务中第k个任务的所有数据的标准差，计算公式为：；其中，表示元学习任务中第k个任务的第l条数据；S4：基于每个任务对应的归一化权重，确定每个任务的所属类别；任务的所属类别包括0和1；对所属类别为0的任务，进行元策略优化，得到第一元策略以及第一参数；对所属类别为1的任务，进行元强化学习，得到第二元策略以及第二参数；S5：基于所述第一元策略和所述第二元策略，得到混合策略；基于所述第一参数和所述第二参数，得到混合参数；S6：基于所述混合策略和所述混合参数构建目标函数，并最大化所述目标函数，直至收敛，得到分类模型；S7：将待分类的金融科技产品数据输入至所述分类模型，得到分类结果。2.根据权利要求1所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，将所述原始数据集按设定比例p划分为训练集和测试集，所述训练集记为Dtrain，所述测试集记为Dtest，且所述训练集与所述测试集之间满足关系式：；；其中，D表示原始数据集；表示第i个金融科技产品数据的特征向量；/＞表示第i个金融科技产品数据的类别标签；N表示金融科技产品数据总数。3.根据权利要求2所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，对所述训练集和所述测试集进行标准化处理包括：对训练集中金融科技产品数据的特征向量以及测试集中金融科技产品数据的特征向量均进行标准化处理，标准化公式为：；；；其中，表示标准化后第i个金融科技产品数据的特征向量；/＞表示第i个金融科技产品数据的特征向量；μ表示特征向量的均值；σ表示特征向量的标准差，N表示金融科技产品数据总数。4.根据权利要求3所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，所述采样训练集表示为：；所述采样测试集表示为：；所述元学习任务表示为：；表示标准化后第i个金融科技产品数据的特征向量；/＞表示第i个金融科技产品数据的类别标签；n表示采样后的金融科技产品数据数量。5.根据权利要求1所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，对计算出的每个权重进行归一化，得到每个任务对应的归一化权重，计算公式为：；其中，表示元学习任务中第k个任务对应的归一化权重；k表示元学习任务中任务的总数；/＞表示元学习任务中第j个任务的权重。6.根据权利要求5所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，基于每个任务对应的归一化权重，确定每个任务的所属类别，表达式为：；其中，表示元学习任务中第k个任务的所属类别；/＞为可调节的阈值参数。7.根据权利要求1所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，所述对所属类别为0的任务，进行元策略优化，得到第一元策略以及第一参数包括：步骤1：初始化一元策略，其中/＞为元策略参数；步骤2：对于元学习任务中每一个所属类别为0的任务b，从所述元策略中采样一个初始策略，其中，/＞；/＞表示初始策略参数，/＞为一个随机扰动；步骤3：在任务b上执行初始策略，并收集其中的第一轨迹数据/＞，/＞表示在任务b中，初始策略/＞所采取的一系列动作和所获得的一系列奖励的记录；基于第一轨迹数据计算第一累积奖励，计算公式为：；其中，表示第一累积奖励；t表示时间步；/＞表示在时间步t时，初始策略所获得的奖励；步骤4：根据所述第一轨迹数据、所述第一累积奖励更新所述初始策略参数，得到新的策略，其中，/＞；/＞表示新的策略参数，α为第一学习率；步骤5：在任务b上执行新的策略，并收集其中的第二轨迹数据/＞；基于第二轨迹数据计算第二累积奖励，计算公式为：；其中，表示第二累积奖励；步骤6：根据元学习任务中所有所属类别为0的任务的第二累积奖励更新所述元策略参数，得到新的元策略，其中，/＞；/＞表示新的元策略参数，β为第二学习率；步骤7：重复步骤2-6，直至收敛，得到第一元策略以及第一参数。8.根据权利要求1所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，所述对所属类别为1的任务，进行元强化学习，得到第二元策略以及第二参数包括：步骤1：初始化一元强化学习模型的参数δ、元学习率ζ以及任务学习率η；步骤2：对于每一个元训练迭代，从元学习任务中所属类别为1的任务中采样一批任务G，，其中的第h个任务Gh包含一个类不平衡的训练集和一个第二测试集；步骤3：对于第h个任务Gh，执行以下操作：步骤3.1：使用当前的参数δ，在类不平衡的训练集上进行一步策略梯度更新，得到新的参数，/＞；其中，/＞是基于类不平衡的数据任务的策略目标函数，表达式为：；；；；；其中，表示类不平衡的训练集；/＞为类不平衡的训练集中的数据；/＞是基于参数δ的策略函数；/＞是基于参数δ的优势函数；λ为一个正则化系数；/＞是策略的熵；/＞表示类别数；I是指示函数；y是状态s对应的真实类别；zc是类别c的权重，；p为类别c在类不平衡的训练集中出现的频率；a为动作；o表示奖励函数r中的一个常数因子；γ表示折扣因子；/＞表示基于参数δ的价值函数，用于估计状态s或状态/＞下策略/＞能够获得的期望回报；/＞表示基于参数/＞的动作价值函数，/＞表示温度参数；步骤3.2：使用新的参数在第二测试集上评估策略的性能，得到回报值/＞；其中，/＞为第二测试集，J为策略目标函数；步骤4：基于元学习任务中所有所属类别为1的任务的回报值更新参数δ，更新公式为：；其中，表示更新后的参数；M表示从元学习任务中所属类别为1的任务中采样的任务的数量；步骤5：重复步骤2-4，直至收敛，得到第二元策略以及第二参数。9.根据权利要求8所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，基于所述第一元策略和所述第二元策略，得到混合策略，计算公式为：；其中，表示混合策略；a为动作，s为状态；/＞为混合系数；/＞表示第一元策略；表示第二元策略；基于所述第一参数和所述第二参数，得到混合参数，计算公式为：；其中，表示混合参数；/＞表示第一参数；/＞表示第二参数，表示连接操作。10.根据权利要求9所述的基于数据质量与强化学习的元任务小样本分类方法，其特征在于，所述基于所述混合策略和所述混合参数构建目标函数，并最大化所述目标函数，直至收敛，得到分类模型包括：步骤1：使用所述混合策略和所述混合参数评估元学习任务中每个任务的回报函数，并求取平均值作为目标函数，计算公式为：；其中，表示目标函数；/＞表示元学习任务中第j个任务对应的策略；/＞表示元学习任务中第j个任务对应的 策略参数；k表示元学习任务中任务的总数；/＞表示元学习任务中第j个任务的回报函数，表达式为：；表示元学习任务中第j个任务的真实标签，/＞的取值为0或1；/＞表示元学习任务中第j个任务的预测概率，/＞的取值范围为；步骤2：采用梯度上升法最大化目标函数，并更新所述混合系数以及混合参数，表达式为：；其中，表示混合系数，/＞第三学习率，/＞表示第四学习率；步骤3：重复步骤1、2，直至收敛，将收敛的目标函数作为分类模型。
说明书desc
技术领域本申请涉及元任务小样本分类技术领域，特别是涉及一种基于数据质量与强化学习的元任务小样本分类方法。背景技术小样本分类是指只有少量标注数据的情况下，训练出能够对新类别的数据进行准确分类的模型。在金融领域，小样本分类是一个重要的问题，因为金融数据往往具有高维、稀疏、非线性、动态变化等特点，导致难以获取足够多的标注数据来训练有效的分类模型。例如，在信用卡欺诈检测中，欺诈交易的比例非常低，而且欺诈手段不断更新，因此需要一种能够在少量标注数据下，快速识别出新的欺诈模式的方法。元学习在这方面具有很大的潜力，例如，它可以利用已有的正常交易和欺诈交易数据，学习一个通用的分类器，然后在新出现的交易数据上进行快速适应和预测。但是，元学习也面临着数据质量的问题，如果元任务中抽取的数据存在类别不平衡或者噪声，那么元学习模型将难以从元任务中获取有效的信息，从而影响其在目标任务上的泛化能力。因此，需要一种方法来评估元任务抽取到的数据质量和优化元任务的选择策略，使其能够更好地适应目标任务。发明内容基于此，有必要针对传统的小样本分类方法存在的过拟合、泛化能力差、对噪声数据敏感等问题，提供一种能够根据目标任务的特征，动态地选择和调整元任务的数据分布和数量，从而提高元学习模型在目标任务上的分类性能的小样本分类方法，具体为一种基于数据质量与强化学习的元任务小样本分类方法。本发明提供了一种基于数据质量与强化学习的元任务小样本分类方法，该方法用于对金融科技产品数据进行分类，包括：S1：获取金融科技产品数据的特征向量和类别标签，并构建原始数据集；所述特征向量包括金融科技产品的名称、描述、开发者、技术基础、种类；所述类别标签包括理财、支付、借贷、股票、记账、保险、资讯、基金；S2：将所述原始数据集按比例划分为训练集和测试集，分别对标准化处理后的训练集和测试集进行采样，得到采样训练集和采样测试集；将所述采样训练集和所述采样测试集组合成一元学习任务；S3：采用数据质量评估函数计算所述元学习任务中每个任务的权重，并对计算出的每个权重进行归一化，得到每个任务对应的归一化权重；所述任务为二分类任务，所述任务包括对金融科技产品数据进行理财类型或支付类型分类、对金融科技产品数据进行借贷类型或股票类型分类、对金融科技产品数据进行记账类型或保险类型分类、对金融科技产品数据进行资讯类型或基金类型分类；每个所述任务中的数据为二分类任务中各类别标签对应的金融科技产品数据；S4：基于每个任务对应的归一化权重，确定每个任务的所属类别；任务的所属类别包括0和1；对所属类别为0的任务，进行元策略优化，得到第一元策略以及第一参数；对所属类别为1的任务，进行元强化学习，得到第二元策略以及第二参数；S5：基于所述第一元策略和所述第二元策略，得到混合策略；基于所述第一参数和所述第二参数，得到混合参数；S6：基于所述混合策略和所述混合参数构建目标函数，并最大化所述目标函数，直至收敛，得到分类模型；S7：将待分类的金融科技产品数据输入至所述分类模型，得到分类结果。有益效果：该方法利用数据质量指标来评估每个元任务的适应算法，然后使用强化学习算法来动态地分配不同的元任务以不同的策略，从而提高了小样本分类的性能。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本申请实施例的基于数据质量与强化学习的元任务小样本分类方法的流程图。具体实施方式为使本申请的上述目的、特征和优点能够更加明显易懂，下面结合附图对本申请的具体实施方式做详细的说明。在下面的描述中阐述了很多具体细节以便于充分理解本申请。但是本申请能够以很多不同于在此描述的其它方式来实施，本领域技术人员可以在不违背本申请内涵的情况下做类似改进，因此本申请不受下面公开的具体实施例的限制。如图1所示，本实施例提供了一种基于数据质量与强化学习的元任务小样本分类方法，该方法用于对金融科技产品数据进行分类，包括：S1：获取金融科技产品数据的特征向量和类别标签，并构建原始数据集；所述特征向量包括金融科技产品的名称、描述、开发者、技术基础、种类；所述类别标签包括理财、支付、借贷、股票、记账、保险、资讯、基金。S2：将所述原始数据集按比例划分为训练集和测试集，分别对标准化处理后的训练集和测试集进行采样，得到采样训练集和采样测试集；将所述采样训练集和所述采样测试集组合成一元学习任务。具体的，将所述原始数据集按设定比例p划分为训练集和测试集，所述训练集记为Dtrain，所述测试集记为Dtest，且所述训练集与所述测试集之间满足关系式：；；其中，D表示原始数据集；表示第i个金融科技产品数据的特征向量；/＞表示第i个金融科技产品数据的类别标签；N表示金融科技产品数据总数。进一步的，对所述训练集和所述测试集进行标准化处理包括：对训练集中金融科技产品数据的特征向量以及测试集中金融科技产品数据的特征向量均进行标准化处理，标准化公式为：；；；其中，表示标准化后第i个金融科技产品数据的特征向量；/＞表示第i个金融科技产品数据的特征向量；μ表示特征向量的均值；σ表示特征向量的标准差，N表示金融科技产品数据总数。更进一步的，所述采样训练集表示为：；所述采样测试集表示为：；所述元学习任务表示为：；表示标准化后第i个金融科技产品数据的特征向量；/＞表示第i个金融科技产品数据的类别标签；n表示采样后的金融科技产品数据数量。还包括：将所述训练集中的任务划分为支持集和查询集；所述支持集表示为：；所述查询集表示为：；且所述支持集和所述查询集之间满足关系式：；表示第v个金融科技产品数据的特征向量；/＞表示第v个金融科技产品数据的类别标签；/＞表示支持集中的金融科技产品数据总数；/＞表示第l个金融科技产品数据的特征向量；/＞表示第l个金融科技产品数据的类别标签；/＞表示查询集中的金融科技产品数据总数；/＞表示训练集中的第u个任务。S3：采用数据质量评估函数计算所述元学习任务中每个任务的权重，并对计算出的每个权重进行归一化，得到每个任务对应的归一化权重。具体的，采用数据质量评估函数计算所述元学习任务中每个任务的权重，计算公式为：；其中，表示元学习任务中第k个任务的权重；f表示数据质量评估函数；/＞表示元学习任务中第k个任务的所有数据的集合；/＞表示元学习任务中第k个任务的第1条数据的质量；/＞表示元学习任务中第k个任务的第e条数据的质量；e表示元学习任务中第k个任务的所有数据的总条数；/＞表示元学习任务中第k个任务的所有数据的标准差；，计算公式为：；其中，表示元学习任务中第k个任务的第l条数据；对计算出的每个权重进行归一化，得到每个任务对应的归一化权重，计算公式为：；其中，表示元学习任务中第k个任务对应的归一化权重；k表示元学习任务中任务的总数；/＞表示元学习任务中第j个任务的权重。在本实施例中，所述金融科技产品数据为金融科技产品的相关信息。所述任务为二分类任务，所述任务包括对金融科技产品数据进行理财类型或支付类型分类、对金融科技产品数据进行借贷类型或股票类型分类、对金融科技产品数据进行记账类型或保险类型分类、对金融科技产品数据进行资讯类型或基金类型分类。每个任务的本质就是把一个多标签分类的问题通过任务拆分为一个个二分类问题，每个任务均专注于从金融科技产品数据中识别和区分出两个特定的类别。每个所述任务中的数据为二分类任务中各类别标签对应的金融科技产品数据。S4：基于每个任务对应的归一化权重，确定每个任务的所属类别；任务的所属类别包括0和1。具体的，基于每个任务对应的归一化权重，确定每个任务的所属类别，表达式为：；其中，表示元学习任务中第k个任务的所属类别；/＞为可调节的阈值参数，在本实施例中取值0.5，其作为对任务分类的判断条件，针对不同的模型使用者，可根据实际情况调节参数。对所属类别为0的任务，进行元策略优化，得到第一元策略以及第一参数。进一步的，该步骤包括：步骤1：初始化一元策略，其中/＞为元策略参数；步骤2：对于元学习任务中每一个所属类别为0的任务b，从所述元策略中采样一个初始策略，其中，/＞；/＞表示初始策略参数，/＞为一个随机扰动；步骤3：在任务b上执行初始策略，并收集其中的第一轨迹数据/＞，/＞表示在任务b中，初始策略/＞所采取的一系列动作和所获得的一系列奖励的记录；基于第一轨迹数据计算第一累积奖励，计算公式为：；其中，表示第一累积奖励；t表示时间步；/＞表示在时间步t时，初始策略所获得的奖励；步骤4：根据所述第一轨迹数据、所述第一累积奖励更新所述初始策略参数，得到新的策略，其中，/＞；/＞表示新的策略参数，α为第一学习率；步骤5：在任务b上执行新的策略，并收集其中的第二轨迹数据/＞；基于第二轨迹数据计算第二累积奖励，计算公式为：；其中，表示第二累积奖励；步骤6：根据元学习任务中所有所属类别为0的任务的第二累积奖励更新所述元策略参数，得到新的元策略，其中，/＞；/＞表示新的元策略参数，β为第二学习率；步骤7：重复步骤2-6，直至收敛，得到第一元策略以及第一参数。对所属类别为1的任务，进行元强化学习，得到第二元策略及其对应的第二参数。进一步的，该步骤包括：步骤1：初始化一元强化学习模型的参数δ、元学习率ζ以及任务学习率η；步骤2：对于每一个元训练迭代，从元学习任务中所属类别为1的任务中采样一批任务G，，其中的第h个任务Gh包含一个类不平衡的训练集和一个第二测试集；步骤3：对于第h个任务Gh，执行以下操作：步骤3.1：使用当前的参数δ，在类不平衡的训练集上进行一步策略梯度更新，得到新的参数，/＞；其中，/＞是基于类不平衡的数据任务的策略目标函数，表达式为：；；；其中，表示类不平衡的训练集；/＞为类不平衡的训练集中的数据；/＞是基于参数δ的策略函数；/＞是基于参数δ的优势函数；λ为一个正则化系数；/＞是策略的熵；/＞表示类别数；I是指示函数；y是状态s对应的真实类别；zc是类别c的权重，/＞；p为类别c在类不平衡的训练集中出现的频率；a为动作；o表示奖励函数r中的一个常数因子，用于调节奖励值的大小；γ表示折扣因子，用于衡量未来奖励值对当前状态-动作对的影响；/＞表示基于参数δ的价值函数，用于估计状态s或状态/＞下策略/＞能够获得的期望回报；；表示基于参数/＞的动作价值函数，/＞表示温度参数，控制了策略的随机性。温度参数越高，策略越倾向于随机选择动作a或/＞；温度参数越低，策略越倾向于贪心选择动作。；步骤3.2：使用新的参数在第二测试集上评估策略的性能，得到回报值；其中，/＞为第二测试集，J为策略目标函数；步骤4：基于元学习任务中所有所属类别为1的任务的回报值更新参数δ，更新公式为：；其中，表示更新后的参数；M表示从元学习任务中所属类别为1的任务中采样的任务的数量；步骤5：重复步骤2-4，直至收敛，得到第二元策略及其对应的第二参数。S5：基于所述第一元策略和所述第二元策略，得到混合策略；基于所述第一参数和所述第二参数，得到混合参数。具体的，基于所述第一元策略和所述第二元策略，得到混合策略，计算公式为：；其中，表示混合策略；a为动作，s为状态；/＞为混合系数；/＞表示第一元策略；/＞表示第二元策略；基于所述第一参数和所述第二参数，得到混合参数，计算公式为：；其中，表示混合参数；/＞表示第一参数；/＞表示第二参数，表示连接操作。S6：基于所述混合策略和所述混合参数构建目标函数，并最大化所述目标函数，直至收敛，得到分类模型。具体的，包括：步骤1：使用所述混合策略和所述混合参数评估元学习任务中每个任务的回报函数，并求取平均值作为目标函数，计算公式为：；其中，表示目标函数；/＞表示元学习任务中第j个任务对应的策略；/＞表示元学习任务中第j个任务对应的策略参数；k表示元学习任务中任务的总数；表示元学习任务中第j个任务的回报函数，表达式为：；表示元学习任务中第j个任务的真实标签，/＞的取值为0或1；/＞表示元学习任务中第j个任务的预测概率，/＞的取值范围为；步骤2：采用梯度上升法最大化目标函数，并更新所述混合系数以及混合参数，表达式为：；其中，表示混合系数，/＞第三学习率，/＞表示第四学习率；步骤3：重复步骤1、2，直至收敛，将收敛的目标函数作为分类模型。S7：将待分类的金融科技产品数据输入至所述分类模型，得到分类结果。在本实施例中，所述分类结果为分类模型预测的待分类的金融科技产品数据的类别标签。本实施例提供的这种方法利用数据质量指标来评估每个元任务的适应算法，然后使用强化学习算法来动态地分配不同的元任务以不同的策略，从而提高了小样本分类的性能。该方法能够评估元任务抽取到的数据质量和优化元任务的选择策略，使其能够更好地适应目标任务。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对申请专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
