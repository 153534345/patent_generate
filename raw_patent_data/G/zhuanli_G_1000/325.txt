标题title
一种钛金属板材缺陷图像分类方法
摘要abst
本发明涉及图像处理领域，更具体地，本发明涉及一种钛金属板材缺陷图像分类方法。所述方法包括：获取钛金属板材表面的灰度图，计算灰度图中每个像素点的梯度值，获得梯度图；获取初始点，基于初始点计算第一可能性，并构建第一区域；计算目标像素点是最终边缘点的第二可能性，获得裂纹区域，计算最优第二可能性阈值，以保证裂纹区域的完整性；通过裂纹区域面积和灰度图面积的比值，比较比值和预设裂纹面积占比阈值对钛金属板材进行等级分类，对不同等级的钛金属板材进行分类处理。通过本发明的技术方案，能够提高裂纹区域的检测的抗干扰性，提高裂纹区域计算及分类的精度。
权利要求书clms
1.一种钛金属板材缺陷图像分类方法，其特征在于，包括以下步骤：获取钛金属板材表面的灰度图；计算所述灰度图中每个像素点的梯度值，获得梯度图；基于预设的聚类算法对所述梯度值聚类，获得预设个数的聚类簇，将每个所述聚类簇中所述梯度值最大的像素点作为初始点；基于所述梯度值和获得的梯度值变化率计算所述梯度图中被标记像素点为边缘点的第一可能性；保留大于预设第一可能性阈值的所述第一可能性的像素点构建第一区域；基于预设阈值分割算法对所述灰度图分割获得第二区域；计算目标像素点到所述第一区域的第一距离和目标像素点到所述第二区域的第二距离；基于所述第一距离、所述第二距离和获得的第三距离计算目标像素点是最终边缘点的第二可能性，遍历所述灰度图中所有像素点，获得裂纹区域，计算最优第二可能性阈值，以保证所述裂纹区域的完整性；通过裂纹区域面积和所述灰度图面积的比值，比较所述比值和预设裂纹面积占比阈值对钛金属板材进行等级分类，对不同等级的钛金属板材进行分类处理；获取所述第一可能性包括步骤：以所述初始点为中心，依次计算所述初始点的8邻域中像素点的所述梯度值和所述初始点的所述梯度值的差值，将所述差值作为对应像素点的梯度值变化率；所述梯度值变化率最小的像素点为所述被标记像素点，将所述被标记像素点作为所述初始点的扩张点进行扩张；遍历所有初始点，响应于同一像素点被标记两次，停止所有所述初始点的扩张；计算每个被标记像素点的第一可能性，所述第一可能性满足关系式：其中，表示第/＞个被标记像素点的第一可能性，/＞表示第/＞个被标记像素点的梯度值，表示被标记像素点的梯度值变化率；获得所述第二可能性包括步骤：计算目标像素点到所述第一区域的最短距离记为第一距离，计算目标像素点到所述第二区域的最短距离记为第二距离；获取第一像素点和第二像素点，所述第一像素点为所述第一距离和所述第一区域的交点，所述第二像素点为所述第二距离和所述第二区域的交点；计算所述第一像素点和所述第二像素点之间的最短距离记为第三距离；基于所述第一距离、所述第二距离和所述第三距离计算目标像素点的第二可能性，所述第二可能性满足关系式：其中，表示第/＞个像素点的第二可能性，/＞表示第一距离，/＞表示第二距离，/＞表示第三距离；所述计算最优第二可能性阈值包括步骤：由于所述第二可能性为归一化后的值，值域为，对于所述第二可能性阈值的初始取值范围也为/＞；通过预设遍历幅度从大到小依次遍历所述第二可能性阈值的取值范围；在遍历过程中，获得的裂纹区域存在从少到多的情况；基于Zhang-Suen算法提取裂纹区域的骨架线，获得骨架线连通域区域；计算骨架线上目标骨架点的8邻域中环绕骨架点的个数，遍历骨架线上所有目标骨架点，响应于所有目标骨架点的环绕骨架点个数不小于2，即骨架线封闭；响应于骨架线不封闭，继续遍历所述第二可能性阈值的取值范围，直至骨架线封闭，遍历结束；骨架线从不封闭到封闭时的第二可能性阈值为最优第二可能性阈值。2.根据权利要求1所述的一种钛金属板材缺陷图像分类方法，其特征在于，所述获得第二区域包括步骤：计算构建所述第一区域边缘的所有像素点的灰度值均值；将所述灰度值均值作为所述预设阈值分割算法的区域阈值，对所述灰度图分割；所述灰度图中像素点大于所述区域阈值的为背景点，所述灰度图中像素点小于所述区域阈值的为所述第二区域中的点，从而获得所述第二区域。3.根据权利要求1所述的一种钛金属板材缺陷图像分类方法，其特征在于，所述对钛金属板材进行等级分类包括步骤：比较所述比值与预设裂纹面积占比阈值，将钛金属板材分为小裂纹板材和大裂纹板材；响应于所述比值不大于预设裂纹面积占比阈值，钛金属板材为小裂纹板材；响应于所述比值大于预设裂纹面积占比阈值，钛金属板材为大裂纹板材。
说明书desc
技术领域本发明一般地涉及图像处理领域。更具体地，本发明涉及一种钛金属板材缺陷图像分类方法。背景技术钛金属板材具有优异的耐腐蚀性能、密度小、比强度高、高温性能好等一系列优点，是新兴的结构材料和功能材料，目前广泛应用在航空航天、石油化工、造船、汽车、医药等部门。在板材需求量显著提高的同时，其质量也越来越受到人们的重视。在板材生产过程中由于轧制设备和轧制工艺等原因，或者在运输和存储过程中，板材表面会形成裂纹缺陷，这样既不美观也影响板材寿命和性能。现有技术中通过阈值分割和边缘检测等技术分析钛金属表面裂纹缺陷，它们的抗干扰能力较差，比如钛金属板材表面会有一些加工痕迹或者一些小的划痕，从而得到的裂纹检测结果较差。发明内容为解决上述一个或多个技术问题，本发明提出基于图像处理的钛板表面缺陷检测方法。为此，本发明在如下的多个方面中提供方案。一种钛金属板材缺陷图像分类方法，包括以下步骤：获取钛金属板材表面的灰度图；计算所述灰度图中每个像素点的梯度值，获得梯度图；基于预设的聚类算法对所述梯度值聚类，获得预设个数的聚类簇，将每个所述聚类簇中所述梯度值最大的像素点作为初始点；基于所述梯度值和获得的梯度值变化率计算所述梯度图中被标记像素点为边缘点的第一可能性；保留大于预设第一可能性阈值的所述第一可能性的像素点构建第一区域；基于预设阈值分割算法对所述灰度图分割获得第二区域；计算目标像素点到所述第一区域的第一距离和目标像素点到所述第二区域的第二距离；基于所述第一距离、所述第二距离和获得的第三距离计算目标像素点是最终边缘点的第二可能性，遍历所述灰度图中所有像素点，获得裂纹区域，计算最优第二可能性阈值，以保证所述裂纹区域的完整性；通过裂纹区域面积和所述灰度图面积的比值，比较所述比值和预设裂纹面积占比阈值对钛金属板材进行等级分类，对不同等级的钛金属板材进行分类处理；获得所述第一可能性包括步骤：以所述初始点为中心，依次计算所述初始点的8邻域中像素点的所述梯度值和所述初始点的所述梯度值的差值，将所述差值作为对应像素点的梯度值变化率；所述梯度值变化率最小的像素点为所述被标记像素点，将所述被标记像素点作为所述初始点的扩张点进行扩张；遍历所有初始点，响应于同一像素点被标记两次，停止所有所述初始点的扩张；计算每个被标记像素点的第一可能性，所述第一可能性满足关系式：其中，表示第/＞个被标记像素点的第一可能性，/＞表示第/＞个被标记像素点的梯度值，/＞表示被标记像素点的梯度值变化率。获得所述第二可能性包括步骤：计算目标像素点到所述第一区域的最短距离记为第一距离，计算目标像素点到所述第二区域的最短距离记为第二距离；获取第一像素点和第二像素点，所述第一像素点为所述第一距离和所述第一区域的交点，所述第二像素点为所述第二距离和所述第二区域的交点；计算所述第一像素点和所述第二像素点之间的最短距离记为第三距离；基于所述第一距离、所述第二距离和所述第三距离计算目标像素点的第二可能性，所述第二可能性满足关系式：其中，表示第/＞个像素点的第二可能性，/＞表示第一距离，/＞表示第二距离，表示第三距离。所述计算最优第二可能性阈值包括步骤：由于所述第二可能性为归一化后的值，值域为，对于所述第二可能性阈值的初始取值范围也为/＞；通过预设遍历幅度从大到小依次遍历所述第二可能性阈值的取值范围；在遍历过程中，获得的裂纹区域存在从少到多的情况；基于Zhang-Suen算法提取裂纹区域的骨架线，获得骨架线连通域区域；计算骨架线上目标骨架点的8邻域中环绕骨架点的个数，遍历骨架线上所有目标骨架点，响应于所有目标骨架点的环绕骨架点个数不小于2，即骨架线封闭；响应于骨架线不封闭，继续遍历所述第二可能性阈值的取值范围，直至骨架线封闭，遍历结束；骨架线从不封闭到封闭时的第二可能性阈值为最优第二可能性阈值。在一个实施例中，所述获得第二区域包括步骤：计算构建所述第一区域边缘的所有像素点的灰度值均值；将所述灰度值均值作为所述预设阈值分割算法的区域阈值，对所述灰度图分割；所述灰度图中像素点大于所述区域阈值的为背景点，所述灰度图中像素点小于所述区域阈值的为所述第二区域中的点，从而获得所述第二区域。在一个实施例中，所述对钛金属板材进行等级分类包括步骤：比较所述比值与预设裂纹面积占比阈值，将钛金属板材分为小裂纹板材和大裂纹板材；响应于所述比值不大于预设裂纹面积占比阈值，钛金属板材为小裂纹板材；响应于所述比值大于预设裂纹面积占比阈值，钛金属板材为大裂纹板材。本发明具有以下技术效果：本发明相对于现有技术提高了检测结果的抗干扰性，并基于通过梯度值获得的第一区域和通过灰度值获得的第二区域，结合分析得到准确且完整的裂纹区域，计算得到裂纹面积也更加精准，提高了后续进行裂纹面积分类结果的准确性。附图说明通过参考附图阅读下文的详细描述，本发明示例性实施方式的上述以及其他目的、特征和优点将变得易于理解。在附图中，以示例性而非限制性的方式示出了本发明的若干实施方式，并且相同或对应的标号表示相同或对应的部分，其中：图1是本发明实施例一种钛金属板材缺陷图像分类方法的流程图。图2是本发明实施例一种钛金属板材缺陷图像分类方法的钛金属板材表面裂纹区域的灰度图示意图。图3是本发明实施例一种钛金属板材缺陷图像分类方法的区域示意图。附图标记说明：301、第一区域；302、第二区域；303、目标像素点；304、第一距离；305、第二距离；306、第一像素点；307、第二像素点；308、第三距离。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。应当理解，当本发明的权利要求、说明书及附图使用术语“第一”、“第二”等时，其仅是用于区别不同对象，而不是用于描述特定顺序。本发明的说明书和权利要求书中使用的术语“包括”和“包含”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。本发明提供了一种钛金属板材缺陷图像分类方法。如图1所示，一种钛金属板材缺陷图像分类方法包括步骤S1-步骤S4，以下具体说明。S1，获取钛金属板材表面的灰度图，计算灰度图中每个像素点的梯度值，获得梯度图。在一个实施例中，使用CCD摄像机放置在金属板表面正上方拍摄平放的钛金属板材，以便更好地展示金属板的表面特征，采集RGB彩色图像的大小为，其中，M表示RGB彩色图像长度像素数，N表示RGB彩色图像宽度像素数。然后将采集到的RGB彩色图像进行灰度化处理得到初始灰度图，再对初始灰度图进行高斯滤波去噪，得到钛金属板材表面的灰度图，为后续的裂纹区域检测和处理更加准确和可靠，如图2所示，为钛金属板材表面裂纹区域的灰度图。对钛金属板材表面的灰度图中每个像素点使用Soble算子计算像素点的梯度值，计算梯度值为现有技术，在此不过多赘述。获得每个位置像素点的梯度值后，构建梯度图。完成梯度图的构建后，如图3所示，需要构建第一区域301，具体方式如下：S2，获取初始点，基于初始点计算第一可能性，并构建第一区域301。在一个实施例中，按照梯度大小通过预设的聚类算法对像素点进行分类，示例性的，预设的聚类算法包括DBSCAN、层次聚类、谱聚类、K-means等，本发明采用DBSCAN算法对像素点进行聚类，聚类半径设置为0.1，响应于每一个聚类簇最少包含20个像素点时，聚类结束。选择每一个聚类簇中梯度值最大的像素点，将每一个聚类簇中梯度值最大的像素点作为初始点，以减少计算量。以初始点为中心，依次计算初始点的8邻域中像素点的梯度值和初始点的梯度值的差值，将差值作为对应像素点的梯度值变化率，梯度值变化率值越小，说明对应的像素点与初始点的相似度越高，即与初始点的连续性高，所以，选择初始点的8邻域中梯度值变化率最低的像素点作为扩张点进行扩张，并对扩张的像素点进行标记，记为被标记像素点，因为初始点不止一个，在扩张的过程中会出现重复计算同一被标记像素点的情况，所以需要遍历所有初始点，响应于同一像素点被标记两次，停止所有初始点的扩张。计算每个被标记像素点的第一可能性，第一可能性满足关系式：其中，表示第/＞个被标记像素点的第一可能性，/＞表示第/＞个被标记像素点的梯度值，/＞表示被标记像素点的梯度值变化率。/＞与/＞均为归一化手段。通过本领域技术人员预设第一可能性阈值，示例性的，本发明将预设第一可能性阈值设置为0.8。将小于预设第一可能性阈值的像素点过滤掉，只保留大于预设第一可能性阈值的第一可能性的像素点构建第一区域301，其中，第一区域301不连续。S3，计算目标像素点303是最终边缘点的第二可能性，获得裂纹区域，计算最优第二可能性阈值，以保证裂纹区域的完整性。需要说明的是，第一区域301是根据梯度值和梯度值变化率获得的，所以在第一区域301中，不仅包含裂纹区域的边缘区域，还会包含其他干扰区域，例如加工痕迹区域，钛金属板材在加工过程中，可能会留下一些加工痕迹，这些痕迹会在区域中表现出来。并且使用预设第一可能性阈值筛选后，第一区域301是不闭合不连续的，在裂纹区域末端，或者是微裂区域，也会被预设第一可能性阈值过滤掉。所以需要构建第二区域302，同第一区域301共同确定最终的裂纹区域。在一个实施例中，计算构建第一区域301边缘的所有像素点的灰度值均值；将灰度值均值作为预设阈值分割算法的区域阈值，对灰度图分割；灰度图中像素点大于区域阈值的为背景点，灰度图中像素点小于区域阈值的为第二区域302中的点，保留所有灰度图中像素点小于区域阈值的像素点从而获得第二区域302。因为第二区域302是由灰度值确定的，所以在第二区域302构建过程中会相应减少干扰区域，总结来说，第一区域301的裂纹准确度高于第二区域302，第二区域302的干扰区域要比第一区域301少。在一个实施例中，基于第一区域301和第二区域302共同确定最终的裂纹区域。计算目标像素点303到第一区域301的最短距离记为第一距离304，计算目标像素点303到第二区域302的最短距离记为第二距离305；获取第一像素点306和第二像素点307，第一像素点306为第一距离304和第一区域301的交点，第二像素点307为第二距离305和第二区域302的交点；计算第一像素点306和第二像素点307之间的最短距离记为第三距离308。如图3所示，为区域示意图。基于第一距离304、第二距离305和第三距离308计算目标像素点303的第二可能性，第二可能性满足关系式：其中，表示第/＞个像素点的第二可能性，/＞表示第一距离304，/＞表示第二距离305，/＞表示第三距离308。遍历钛金属板材表面的灰度图中所有像素点，获得裂纹区域，计算最优第二可能性阈值，以保证裂纹区域的完整性。计算最优第二可能性阈值包括步骤：由于第二可能性为归一化后的值，值域为，对于第二可能性阈值的初始取值范围也为/＞；通过预设遍历幅度从大到小依次遍历第二可能性阈值的取值范围；在遍历过程中，获得的裂纹区域存在从少到多的情况；基于Zhang-Suen算法提取裂纹区域的骨架线，获得骨架线连通域区域；计算骨架线上目标骨架点的8邻域中环绕骨架点的个数，遍历骨架线上所有目标骨架点，响应于所有目标骨架点的环绕骨架点个数不小于2，即骨架线封闭；响应于骨架线不封闭，继续遍历第二可能性阈值的取值范围，直至骨架线封闭，遍历结束；骨架线从不封闭到封闭时的第二可能性阈值为最优第二可能性阈值。S4，通过裂纹区域面积和灰度图面积的比值，比较比值和预设裂纹面积占比阈值对钛金属板材进行等级分类，对不同等级的钛金属板材进行分类处理。在一个实施例中，在获得最优第二可能性阈值后，能够获得骨架线，骨架线围成的区域即为裂纹区域。通过形态学填充法对骨架线所围成的区域进行填充，填充后得到其连通域区域，最后再计算连通域像素点个数，作为钛金属板材表面的裂纹区域面积。计算裂纹区域面积和灰度图面积的比值，比较比值和预设裂纹面积占比阈值对钛金属板材进行等级分类，将钛金属板材分为小裂纹板材和大裂纹板材；响应于比值不大于预设裂纹面积占比阈值，钛金属板材为小裂纹板材，可以使用相应方法进行修复处理，比如采用焊接、涂层、贴片等修复方法；响应于比值大于预设裂纹面积占比阈值，钛金属板材为大裂纹板材，则可能需要更换材料或进行更深入的评估和处理。示例性的，预设裂纹面积占比阈值为。虽然本说明书已经示出和描述了本发明的多个实施例，但对于本领域技术人员显而易见的是，这样的实施例只是以示例的方式提供的。本领域技术人员会在不偏离本发明思想和精神的情况下想到许多更改、改变和替代的方式。应当理解的是在实践本发明的过程中，可以采用本文所描述的本发明实施例的各种替代方案。以上均为本发明的较佳实施例，并非依此限制本发明的保护范围，故：凡依本发明的结构、形状、原理所做的等效变化，均应涵盖于本发明的保护范围之内。
