标题title
基于双域加权宽度学习的心电图分类方法及系统
摘要abst
本发明公开了一种基于双域加权宽度学习的心电图分类方法及系统，构建基于双域加权宽度学习的心电图分类模型，对目标心电图数据进行分类，基于双域加权宽度学习在时间域特征层上进行了频域映射，生成了一个频域特征层，与模型内现有的时域特征层和增强层并行组合，扩展了模型结构的宽度，并在输入心电图样本数据上同时提供了不同视角的独特特征映射，从而获得从时域和频域提取数据特征的能力，此外还在损失函数中引入成本敏感因子，为心电图分类提供了一种新颖的方法并解决新电图领域中的数据不平衡问题。
权利要求书clms
1.一种基于双域加权宽度学习的心电图分类方法，其特征在于，包括以下步骤：获取心电图数据进行预处理，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间；基于所述特征层特征节点利用频域特征层映射及增强层映射将输入数据样本对应的特征从两个不同领域进行映射，将时域特征层特征节点、频域特征层特征节点及增强层特征节点按照顺序连接到输出层；根据历史心电图数据构建训练数据集，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，输出基于双域加权宽度学习的心电图分类模型，对所述心电图数据进行分类。2.根据权利要求1所述的一种基于双域加权宽度学习的心电图分类方法，其特征在于，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间具体为：在预处理后心电图数据中提取输入数据样本 ，其中，表示输入数据样本，为初始心电图数据，/＞表示总样本数量，/＞表示样本特征维度，/＞示分类的数量，/＞表示实数；所述双域加权宽度学习包括输入层、时域特征层、频域特征层、增强层和输出层，假设存在个特征窗口，每个窗口包含K个特征节点，宽度学习将输入数据样本映射到/＞组随机特征空间中，每组特征空间包含K个特征；获取第组特征节点/＞：;其中，为特征映射函数，/＞和/＞分别为随机生成的权重和偏差，在获得 /＞后，将所有/＞连接起来生成特征层/＞，构建特征空间。3.根据权利要求1所述的一种基于双域加权宽度学习的心电图分类方法，其特征在于，采用并行结构同时进行频域特征层映射和增强层映射，将输入数据样本从两个不同的领域进行映射，频域特征层的映射公式如下：;其中，表示变换后的频域信号，/＞表示输入的时间域数据，/＞表示信号的长度，/＞表示虚数单位；/＞表示为时域信号的编号；对于不同的特征节点组/＞，生成相应的频域特征层节点组/＞，将所有的/＞连接起来生成频域特征层/＞；将所构造的节点组导入增强层进行非线性变换，获取第/＞组增强层特征节点/＞：;其中，表示激活函数，/＞和/＞表示随机生成的权重和偏差,m表示增强层特征节点组数，将所有的/＞连接起来生成增强层/＞；将频域特征层、时域特征层/＞和增强层/＞按顺序连接到输出层，创建特征矩阵，/＞。4.根据权利要求1所述的一种基于双域加权宽度学习的心电图分类方法，其特征在于，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，具体为：根据含有类型标签的历史心电图数据构建训练数据集，通过训练样本的类型标签将样本分为个类别：/＞，其中/＞和/＞分别表示训练数据中属于类别/＞的样本及其类别本身；在数据分割后，创建扩展矩阵;其中表示与/＞对应的所有频域特征节点组的连接，/＞表示与/＞对应的所有时域特征层特征节点组的连接，/＞表示与/＞对应的所有增强层特征节点的连接；基于双域加权宽度学习的优化函数表示如下：;表示连接权重矩阵，/＞表示第1类别、第2类别…第/＞类别的系数，/＞表示惩罚系数，/＞表示第1类别、第2类别…第/＞类别的扩展矩阵。5.根据权利要求4所述的一种基于双域加权宽度学习的心电图分类方法，其特征在于，对优化函数中的连接权重矩阵进行导数计算，将导数设置为0，获取连接权重矩阵，;其中，表示单位矩阵，/＞表示矩阵转置，/＞表示第i类别的扩展矩阵，/＞表示第i类别本身，/＞表示类别系数。6.一种基于双域加权宽度学习的心电图分类系统，其特征在于，该系统包括：存储器、处理器，所述存储器中包括基于双域加权宽度学习的心电图分类方法程序，所述基于双域加权宽度学习的心电图分类方法程序被所述处理器执行时实现如下步骤：获取心电图数据进行预处理，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间；基于所述特征层特征节点利用频域特征层映射及增强层映射将输入数据样本对应的特征从两个不同领域进行映射，将时域特征层特征节点、频域特征层特征节点及增强层特征节点按照顺序连接到输出层；根据历史心电图数据构建训练数据集，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，输出基于双域加权宽度学习的心电图分类模型，对所述心电图数据进行分类。7.根据权利要求6所述的一种基于双域加权宽度学习的心电图分类系统，其特征在于，采用并行结构同时进行频域特征层映射和增强层映射，将输入数据样本从两个不同的领域进行映射，频域特征层的映射公式如下：;其中，表示变换后的频域信号，/＞表示输入的时间域数据，/＞表示信号的长度，表示虚数单位；/＞表示为时域信号的编号；对于不同的特征节点组/＞ ，生成相应的频域特征层节点组/＞，将所有的/＞连接起来生成频域特征层/＞；将所构造的节点组导入增强层进行非线性变换，获取第/＞组增强层特征节点/＞：;其中，表示激活函数，/＞和/＞表示随机生成的权重和偏差,m表示增强层特征节点组数，将所有的/＞连接起来生成增强层/＞；将频域特征层、时域特征层/＞和增强层/＞按顺序连接到输出层，创建特征矩阵，/＞。8.根据权利要求6所述的一种基于双域加权宽度学习的心电图分类系统，其特征在于，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，具体为：根据含有类型标签的历史心电图数据构建训练数据集，通过训练样本的类型标签将样本分为个类别：/＞，其中/＞和/＞分别表示训练数据中属于类别/＞的样本及其类别本身；在数据分割后，创建扩展矩阵;其中表示与/＞对应的所有频域特征节点组的连接，/＞表示与/＞对应的所有时域特征层特征节点组的连接，/＞表示与/＞对应的所有增强层特征节点的连接；基于双域加权宽度学习的优化函数表示如下：;表示连接权重矩阵，/＞表示第1类别、第2类别…第/＞类别的系数，/＞表示惩罚系数，/＞表示第1类别、第2类别…第/＞类别的扩展矩阵；对优化函数中的连接权重矩阵进行导数计算，将导数设置为0，获取连接权重矩阵/＞，;其中，表示单位矩阵，/＞表示矩阵转置，/＞表示第i类别的扩展矩阵，/＞表示第i类别本身，/＞表示类别系数。
说明书desc
技术领域本发明涉及心电图分类技术领域，更具体的，涉及一种基于双域加权宽度学习的心电图分类方法及系统。背景技术在心电图分类领域，传统的机器学习算法通常需要复杂的特征提取过程，而深度学习尽管是一个端到端模型，但需要大量的硬件资源。最近一种基于扁平网络结构的新兴高效随机神经网络宽度学习系统被提出，与深度学习不同，BLS通过扩展网络宽度实现数据拟合，具有结构简单和模型参数减少的优势。然而BLS也存在一些局限性：BLS的特征映射层具有有限的表示能力，这可能导致模型容易过拟合。BLS缺乏局部映射能力，在面对异常值和噪声数据时表现出降低的鲁棒性。在面对数据不平衡时，BLS分类效果不佳，缺乏泛化能力。现有的改进的宽度学习系统大多从深度进行延伸，违背宽度学习系统的初衷。在现有技术中，通过改变数据层面的方式克服数据不平衡问题，使用重采样技术增加或减少样本数量来修改数据分布，这无疑增加了由于需要额外的数据平衡操作而导致的时间消耗。除此之外，深度学习架构中损失函数的有效设计也可以缓解类不平衡问题，在算法层面，不需要改变数据集的大小，通过使用原始数据进行操作，但是他们是基于深度学习架构进行的，因此会消耗大量的学习时间。发明内容为了解决上述技术问题，本发明提出了一种基于双域加权宽度学习的心电图分类方法及系统。本发明第一方面提供了一种基于双域加权宽度学习的心电图分类方法，包括：获取心电图数据进行预处理，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间；基于所述特征层特征节点利用频域特征层映射及增强层映射将输入数据样本对应的特征从两个不同领域进行映射，将时域特征层特征节点、频域特征层特征节点及增强层特征节点按照顺序连接到输出层；根据历史心电图数据构建训练数据集，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，输出基于双域加权宽度学习的心电图分类模型，对所述心电图数据进行分类。本方案中，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间具体为：在预处理后心电图数据中提取输入数据样本，其中，/＞表示输入数据样本，为初始心电图数据，/＞表示总样本数量，/＞表示样本特征维度，/＞表示分类的数量，/＞表示实数；所述双域加权宽度学习包括输入层、时域特征层、频域特征层、增强层和输出层，假设存在个特征窗口，每个窗口包含K个特征节点，宽度学习将输入数据样本映射到/＞组随机特征空间中，每组特征空间包含K个特征；获取第组特征节点/＞：;其中，为特征映射函数，/＞ 和/＞分别为随机生成的权重和偏差，在获得后，将所有/＞连接起来生成特征层/＞，构建特征空间。本方案中，采用并行结构同时进行频域特征层映射和增强层映射，将输入数据样本从两个不同的领域进行映射，频域特征层的映射公式如下：;其中，表示变换后的频域信号，/＞表示输入的时间域数据，/＞表示信号的长度，/＞表示虚数单位；/＞表示为时域信号的编号；对于不同的特征节点组/＞，生成相应的频域特征层节点组/＞，将所有的/＞连接起来生成频域特征层/＞；将所构造的节点组导入增强层进行非线性变换，获取第/＞组增强层特征节点：;其中，表示激活函数，/＞和/＞表示随机生成的权重和偏差,m表示增强层特征节点组数，将所有的/＞连接起来生成增强层/＞；将频域特征层、时域特征层/＞和增强层/＞按顺序连接到输出层，创建特征矩阵/＞，/＞。本方案中，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，具体为：根据含有类型标签的历史心电图数据构建训练数据集，通过训练样本的类型标签将样本分为个类别：，其中/＞和/＞分别表示训练数据中属于类别/＞的样本及其类别本身；在数据分割后，创建扩展矩阵;其中表示与/＞对应的所有频域特征节点组的连接，/＞表示与/＞对应的所有时域特征层特征节点组的连接，/＞表示与/＞对应的所有增强层特征节点的连接；基于双域加权宽度学习的优化函数表示如下：;表示连接权重矩阵，/＞表示第1类别、第2类别…第/＞类别的系数，表示惩罚系数，/＞表示第1类别、第2类别…第/＞类别的扩展矩阵；对优化函数中的连接权重矩阵进行导数计算，将导数设置为0，获取连接权重矩阵/＞，;其中，表示单位矩阵，/＞表示矩阵转置，/＞表示第/＞类别的扩展矩阵，/＞表示第/＞类别本身，/＞表示类别系数。本发明第二方面还提供了一种基于双域加权宽度学习的心电图分类系统，该系统包括：存储器、处理器，所述存储器中包括基于双域加权宽度学习的心电图分类方法程序，所述基于双域加权宽度学习的心电图分类方法程序被所述处理器执行时实现如下步骤：获取心电图数据进行预处理，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间；基于所述特征层特征节点利用频域特征层映射及增强层映射将输入数据样本对应的特征从两个不同领域进行映射，将时域特征层特征节点、频域特征层特征节点及增强层特征节点按照顺序连接到输出层；根据历史心电图数据构建训练数据集，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，输出基于双域加权宽度学习的心电图分类模型，对所述心电图数据进行分类。本发明消除了手动特征提取的必要性。为了解决传统宽度学习局部映射能力和鲁棒性差的局限性，使特征能够同时在频率和时间域进行映射。通过添加频域特征层来增强宽度学习模型的结构，创建了一个基于双域加权宽度学习模型，增强了模型的表现能力和稳定性，并减少对硬件资源的依赖。此外，为了解决心电图领域中的数据不平衡问题，引入了一个成本敏感因子，以减轻心电图数据不平衡的问题。附图说明图1示出了本发明基于双域加权宽度学习的心电图分类方法的流程图；图2示出了本发明基于双域加权宽度学习的心电图分类模型的示意图；图3示出了本发明基于双域加权宽度学习的心电图分类系统的框图。具体实施方式为了能够更清楚地理解本发明的上述目的、特征和优点，下面结合附图和具体实施方式对本发明进行进一步的详细描述。需要说明的是，在不冲突的情况下，本申请的实施例及实施例中的特征可以相互组合。在下面的描述中阐述了很多具体细节以便于充分理解本发明，但是，本发明还可以采用其他不同于在此描述的其他方式来实施，因此，本发明的保护范围并不受下面公开的具体实施例的限制。图1示出了本发明基于双域加权宽度学习的心电图分类方法的流程图。如图1所示，本发明第一方面提供了基于双域加权宽度学习的心电图分类方法，包括S102，获取心电图数据进行预处理，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间；S104，基于所述特征层特征节点利用频域特征层映射及增强层映射将输入数据样本对应的特征从两个不同领域进行映射，将时域特征层特征节点、频域特征层特征节点及增强层特征节点按照顺序连接到输出层；S106，根据历史心电图数据构建训练数据集，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，输出基于双域加权宽度学习的心电图分类模型，对所述心电图数据进行分类。需要说明的是，在预处理后心电图数据中提取输入数据样本，其中/＞表示输入数据样本，为初始心电图数据，/＞表示总样本数量，/＞表示样本特征维度，/＞表示分类的数量，/＞表示实数；所述双域加权宽度学习包括输入层、时域特征层、频域特征层、增强层和输出层，假设存在/＞个特征窗口，每个窗口包含K个特征节点，宽度学习将输入数据样本映射到/＞组随机特征空间中，每组特征空间包含K个特征；获取第组特征节点/＞：;其中，为特征映射函数，/＞ 和/＞分别为随机生成的权重和偏差，在获得后，将所有/＞连接起来生成特征层/＞，构建特征空间。需要说明的是，为了解决宽度学习BLS缺乏局部映射能力和表现出降低的鲁棒性的问题，在时间域特征层上进行了频域映射，生成了一个频域特征层，这个新层与模型内现有的时域特征层和增强层并行组合。这种方法扩展了模型结构的宽度，并在输入样本数据上同时提供了不同视角的独特特征映射，从而获得从时域和频域提取数据特征的能力，从而增强了其表示能力。采用并行结构同时进行傅立叶特征层映射和增强层映射，将输入数据样本从两个不同的领域进行映射，使宽度学习能够保留其原始的特征映射能力，同时将信息从两个不同的领域进行映射，从而增强了模型的本地表示能力，频域特征层的映射公式如下：;其中，表示变换后的频域信号，/＞表示输入的时间域数据，/＞表示信号的长度，/＞表示虚数单位；/＞表示为时域信号的编号；对于不同的特征节点组/＞，生成相应的频域特征层节点组/＞，将所有的/＞连接起来生成频域特征层/＞；将所构造的节点组导入增强层进行非线性变换，获取第/＞组增强层特征节点：;其中，表示激活函数，/＞表示随机生成的权重和偏差,m表示增强层特征节点组数，将所有的/＞连接起来生成增强层/＞；将频域特征层、时域特征层/＞和增强层/＞按顺序连接到输出层，创建特征矩阵/＞ 。需要说明的是，为了解决宽度学习数据的不平衡问题，引入成本敏感性因子，通过增加少数类样本的损失权重和减少多数类样本的损失权重来实现。根据含有类型标签的历史心电图数据构建训练数据集，训练数据将根据样本类别进行分割和分区，以实现成本敏感因子的加权效果，通过训练样本的类型标签将样本分为个类别：，其中/＞和/＞分别表示训练数据中属于类别/＞的样本及其类别本身；在数据分割后，创建扩展矩阵/＞，其中/＞表示与/＞对应的所有频域特征节点组的连接，/＞ 表示与/＞对应的所有时域特征层特征节点组的连接，/＞表示与/＞对应的所有增强层特征节点的连接；基于双域加权宽度学习的优化函数表示如下：;表示连接权重矩阵，/＞表示第1类别、第2类别…第/＞类别的系数，表示惩罚系数，/＞表示第1类别、第2类别…第/＞类别的扩展矩阵。需要说明的是，对优化函数中的连接权重矩阵进行导数计算，其计算过程为：;将导数设置为0，获取连接权重矩阵，;其中，表示单位矩阵，/＞表示矩阵转置，/＞表示第/＞类别的扩展矩阵，/＞表示第/＞类别本身，/＞表示类别系数，/＞。根据连接权重及优化函数输出基于双域加权宽度学习的心电图分类模型，对所述心电图数据进行分类。图3示出了本发明基于双域加权宽度学习的心电图分类系统的框图。本发明第二方面还提供了一种基于双域加权宽度学习的心电图分类系统3，该系统包括：存储器31、处理器32，所述存储器中包括基于双域加权宽度学习的心电图分类方法程序，所述基于双域加权宽度学习的心电图分类方法程序被所述处理器执行时实现如下步骤：获取心电图数据进行预处理，根据预处理后的心电图数据提取输入数据样本，利用双域加权宽度学习建立特征映射，获取特征层特征节点，构建特征空间；基于所述特征层特征节点利用频域特征层映射及增强层映射将输入数据样本对应的特征从两个不同领域进行映射，将时域特征层特征节点、频域特征层特征节点及增强层特征节点按照顺序连接到输出层；根据历史心电图数据构建训练数据集，在所述训练数据集中引入成本敏感因子获取特征节点之间的连接权重及优化函数，输出基于双域加权宽度学习的心电图分类模型，对所述心电图数据进行分类。本发明第三方面还提供一种计算机可读存储介质，所述计算机可读存储介质中包括基于双域加权宽度学习的心电图分类方法程序，所述基于双域加权宽度学习的心电图分类方法程序被处理器执行时，实现如上述基于双域加权宽度学习的心电图分类方法的步骤。在本申请所提供的几个实施例中，应该理解到，所揭露的设备和方法，可以通过其它的方式实现。以上所描述的设备实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，如：多个单元或组件可以结合，或可以集成到另一个系统，或一些特征可以忽略，或不执行。另外，所显示或讨论的各组成部分相互之间的耦合、或直接耦合、或通信连接可以是通过一些接口，设备或单元的间接耦合或通信连接，可以是电性的、机械的或其它形式的。上述作为分离部件说明的单元可以是、或也可以不是物理上分开的，作为单元显示的部件可以是、或也可以不是物理单元；既可以位于一个地方，也可以分布到多个网络单元上；可以根据实际的需要选择其中的部分或全部单元来实现本实施例方案的目的。另外，在本发明各实施例中的各功能单元可以全部集成在一个处理单元中，也可以是各单元分别单独作为一个单元，也可以两个或两个以上单元集成在一个单元中；上述集成的单元既可以采用硬件的形式实现，也可以采用硬件加软件功能单元的形式实现。本领域普通技术人员可以理解：实现上述方法实施例的全部或部分步骤可以通过程序指令相关的硬件来完成，前述的程序可以存储于计算机可读取存储介质中，该程序在执行时，执行包括上述方法实施例的步骤；而前述的存储介质包括：移动存储设备、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。或者，本发明上述集成的单元如果以软件功能模块的形式实现并作为独立的产品销售或使用时，也可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明实施例的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分。而前述的存储介质包括：移动存储设备、ROM、RAM、磁碟或者光盘等各种可以存储程序代码的介质。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以所述权利要求的保护范围为准。
