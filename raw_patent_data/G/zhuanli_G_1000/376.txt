标题title
多模型融合的配电网分时分段线损精细诊断方法及系统
摘要abst
本发明公开了一种多模型融合的配电网分时分段线损精细诊断方法及系统，包括：获取配电网分时分段线损诊断所需数据；利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合；遍历可信开关集合，利用剪枝法，生成单开关下游分段集合；遍历单开关下游分段集合，采用统计方法和状态估计方法，分别计算单开关下游的分时分段统计线损率和分时分段理论线损率；开展单开关下游线损两率对比，生成线路的线损异常单开关下游集合；针对线损异常单开关下游集合，进行基于停电事件的段变关系异常诊断，输出疑似段变关系异常配变集合；针对段变关系正常的线损异常单开关下游分段，进行配变用电异常诊断，输出疑似用电异常配变集合。
权利要求书clms
1.一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：包括以下步骤；步骤1：获取待诊断线路的拓扑结构、自动化开关的台账、配变的台账、待诊断线路参数和配变参数；以及获取待诊断线路的量测数据、自动化开关的量测数据和历史分级保护分合闸信号、配变的量测数据和历史停电事件；所述自动化开关和配变位于待诊断线路上；步骤2：利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合；步骤3：遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞；步骤4：遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率；遍历单开关下游分段集合/＞，利用状态估计方法，计算单开关下游的分时分段理论线损率；步骤5：对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线损异常单开关下游集合/＞；步骤6：遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞；步骤7：对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合。2.根据权利要求1所述的一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：所述的利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合，包括以下步骤：从距离待诊断线路首端最近的自动化开关开始，遍历到距离待诊断线路末端最近的自动化开关结束，假设待诊断线路上第个自动化开关的上游为/＞，利用加权最小二乘状态估计方法，对第/＞个自动化开关的上游/＞进行状态估计，估算出第个自动化开关的功率估计值序列/＞和电流估计值序列/＞；将第个自动化开关的功率量测数据/＞与功率估计值序列/＞进行对比，仅当两者的功率偏差率小于功率偏差率阈值/＞时，表示第/＞个自动化开关的功率量测数据可用；将第个自动化开关的电流量测数据/＞与电流估计值序列/＞进行对比，仅当两者的电流偏差率小于电流偏差率阈值/＞时，则表示第/＞个自动化开关的电流量测数据可用；若第个自动化开关的功率量测数据和电流量测数据均可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据可用但电流量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的电流量测数据可用但功率量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率估计值序列/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据和电流量测数据均不可用，则表示第/＞个自动化开关为不可信开关。3.根据权利要求1所述的一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：所述的遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞，包括以下步骤：判断待诊断线路的可信开关集合是否为空，若可信开关集合/＞不为空，从距离待诊断线路末端最近的可信开关开始，遍历到距离待诊断线路首端最近的可信开关结束；若可信开关集合/＞为空，则停止计算，将待诊断线路的拓扑结构加入到单开关下游分段集合/＞；当遍历到可信开关集合中的第/＞个可信开关，若存在以第/＞个可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段/＞时，且所述单开关下游分段/＞内包含1个以上的配变，则将该单开关下游分段/＞加入单开关下游分段集合/＞中，该单开关下游分段/＞从待诊断线路的拓扑结构中剪除，并将第/＞个可信开关等效为待诊断线路拓扑中负荷叶子节点；否则，继续遍历可信开关集合/＞的其他可信开关。4.根据权利要求1所述的一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：所述的遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率，包括以下步骤：假定单开关下游分段集合中的单开关下游分段/＞以1个可信开关为根节点，分段内共有/＞个配变和/＞个视为负荷叶子节点的下游可信开关，获取/＞个可信开关的功率数据和/＞个配变的功率数据；假定可信开关的功率数据和配变的功率数据在指定统计时间段内等间距采样，采样时间点记为/＞；对于第个可信开关，将流入单开关下游分段/＞的功率数据设置为正向，流出单开关下游分段/＞的功率数据设置为反向，则第/＞个可信开关对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量/＞及反向积分电量/＞分别为：；；式中，为第/＞个可信开关在采样时间点/＞的功率数据；对于第个配变对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量及反向积分电量/＞分别为：；；式中，为第/＞个配变在采样时间点/＞的功率数据；按照下式，计算单开关下游分段在指定统计时间段/＞的输入电量/＞、输出电量：；；按照下式，计算单开关下游分段在指定统计时间段/＞的分时分段统计线损率/＞：。5.根据权利要求1所述的一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：所述的遍历单开关下游分段集合，利用状态估计方法，计算单开关下游的分时分段理论线损率，包括以下步骤：利用加权最小二乘状态估计方法，对单开关下游分段集合中的单开关下游分段/＞进行状态估计，估算出在采样时间点/＞的单开关下游分段/＞中第/＞个可信开关的功率估计值序列/＞和第/＞个配变的功率估计值序列/＞；利用单开关下游分段中的可信开关的功率估计值序列和配变的功率估计值序列，按照下式，计算单开关下游分段/＞的分时分段理论线损率/＞：；式中，、/＞分别为第/＞个可信开关利用功率估计值序列/＞计算出的正向积分电量和反向积分电量；/＞、/＞分别为第/＞个配变利用功率估计值序列/＞计算出的正向积分电量和反向积分电量。6.根据权利要求1所述的一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线损异常单开关下游集合/＞，包括以下步骤：对于任意一属于单开关下游分段集合的单开关下游分段/＞，获取该单开关下游分段任意时间段的分时分段统计线损率/＞和分时分段理论线损率/＞；若单开关下游分段任意时间段的分时分段统计线损率/＞与分时分段理论线损率之间的偏差满足如下：；则单开关下游分段为线损异常单开关下游分段，加入到线损异常单开关下游集合/＞中；式中，/＞表示单开关下游分段的线损两率偏差阈值。7.根据权利要求1所述的一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：所述的遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞，包括以下步骤：基于自动化开关的历史分级保护分合闸信号和配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段的自动化开关的历史分级保护分合闸信号和配变的历史停电事件，定义为发生分级保护故障的配变停电事件集合/＞，通过发生分级保护故障的开关将线路分为故障区域/＞和非故障区域/＞，其中故障区域/＞为发生分级保护故障的开关围成的配变集合，非故障区域/＞为线路上不在故障区域的其他配变集合；若线损异常单开关下游分段在故障区域/＞中，则线损异常单开关下游分段/＞内所有配变应该停电，将线损异常单开关下游分段/＞内配变与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，判定线损异常单开关下游分段为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，应停未停配变集合的配变个数/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞1为应停未停配变集合/＞中的配变数量；若线损异常单开关下游分段在非故障区域/＞中，则线损异常单开关下游分段内所有配变不该停电；将线损异常单开关下游分段/＞与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在停电的配变时，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，不该停但停配变集合的配变个数/＞占比计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为不该停但停配变集合中的配变数量；基于无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，定义为无分级保护故障的配变停电事件集合/＞；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量/＞占比大于阈值/＞时，则该线损异常单开关下游分段/＞内所有配变应该停电，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量占比/＞小于等于阈值/＞，则该线损异常单开关下游分段/＞内所有配变不应该停电，若线损异常单开关下游分段/＞上存在停电的配变，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变数量占比/＞小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量占比/＞计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量。8.根据权利要求1所述的一种多模型融合的配电网分时分段线损精细诊断方法，其特征在于：所述的对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合，包括以下步骤：S700：取线损异常单开关下游集合中段变关系正常的线损异常单开关下游分段，判断在该段变关系正常的线损异常单开关下游分段内是否只存在一个专变，若是，则利用加权最小二乘状态估计方法，估算出该专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与该专变的功率量测数据的功率偏差率大于功率偏差率阈值/＞的专变加入到疑似用电异常配变集合/＞中；否则，假定有/＞个专变，则利用专变的功率量测数据，计算每个专变在指定统计时间段/＞内的积分电量并排序，生成积分电量排名集合/＞，并执行S710；S710：取当前积分电量排名集合中第一名的专变，在该专变的上游安装1个便携式量测终端；S720：利用便携式量测终端将当前段变关系正常的线损异常单开关下游分段分为上游子分段和下游子分段，计算上游子分段和下游子分段的统计线损率，若下游子分段的统计线损率大于上游子分段的统计线损率，则在下游子分段中该专变疑似用电异常，执行S730；若下游子分段的统计线损率不大于上游子分段的统计线损率，则在积分电量排名集合中剔除该专变，执行S710，直至积分电量排名集合/＞为空停止；S730：利用加权最小二乘状态估计方法，估算出被认定为疑似用电异常的专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与功率量测数据的功率偏差率大于功率偏差率阈值的专变加入到疑似用电异常配变集合/＞中。9.一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：包括；诊断数据获取模块，用于获取待诊断线路的拓扑结构、自动化开关的台账、配变的台账、待诊断线路参数和配变参数；以及获取待诊断线路的量测数据、自动化开关的量测数据和历史分级保护分合闸信号、配变的量测数据和历史停电事件；所述自动化开关和配变位于待诊断线路上；可信开关集合生成模块，用于利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合；单开关下游分段集合生成模块，用于遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞；线损率计算模块，用于遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率；遍历单开关下游分段集合/＞，利用状态估计方法，计算单开关下游的分时分段理论线损率；线损异常单开关下游集合生成模块，用于对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合/＞中，以此生成线损异常单开关下游集合/＞；疑似段变关系异常配变集合输出模块，用于遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞；疑似用电异常配变集合输出模块，用于对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合。10.根据权利要求9所述的一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：所述的利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合，包括以下步骤：从距离待诊断线路首端最近的自动化开关开始，遍历到距离待诊断线路末端最近的自动化开关结束，假设待诊断线路上第个自动化开关的上游为/＞，利用加权最小二乘状态估计方法，对第/＞个自动化开关的上游/＞进行状态估计，估算出第个自动化开关的功率估计值序列/＞和电流估计值序列/＞；将第个自动化开关的功率量测数据/＞与功率估计值序列/＞进行对比，仅当两者的功率偏差率小于功率偏差率阈值/＞时，表示第/＞个自动化开关的功率量测数据可用；将第个自动化开关的电流量测数据/＞与电流估计值序列/＞进行对比，仅当两者的电流偏差率小于电流偏差率阈值/＞时，则表示第/＞个自动化开关的电流量测数据可用；若第个自动化开关的功率量测数据和电流量测数据均可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据可用但电流量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的电流量测数据可用但功率量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率估计值序列/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据和电流量测数据均不可用，则表示第/＞个自动化开关为不可信开关。11.根据权利要求9所述的一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：所述的遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞，包括以下步骤：判断待诊断线路的可信开关集合是否为空，若可信开关集合/＞不为空，从距离待诊断线路末端最近的可信开关开始，遍历到距离待诊断线路首端最近的可信开关结束；若可信开关集合/＞为空，则停止计算，将待诊断线路的拓扑结构加入到单开关下游分段集合/＞；当遍历到可信开关集合中的第/＞个可信开关，若存在以第/＞个可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段/＞时，且所述单开关下游分段/＞内包含1个以上的配变，则将该单开关下游分段/＞加入单开关下游分段集合/＞中，该单开关下游分段/＞从待诊断线路的拓扑结构中剪除，并将第/＞个可信开关等效为待诊断线路拓扑中负荷叶子节点；否则，继续遍历可信开关集合/＞的其他可信开关。12.根据权利要求9所述的一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：所述的遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率，包括以下步骤：假定单开关下游分段集合中的单开关下游分段/＞以1个可信开关为根节点，分段内共有/＞个配变和/＞个视为负荷叶子节点的下游可信开关，获取/＞个可信开关的功率数据和/＞个配变的功率数据；假定可信开关的功率数据和配变的功率数据在指定统计时间段内等间距采样，采样时间点记为/＞；对于第个可信开关，将流入单开关下游分段/＞的功率数据设置为正向，流出单开关下游分段/＞的功率数据设置为反向，则第/＞个可信开关对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量/＞及反向积分电量/＞分别为：；；式中，为第/＞个可信开关在采样时间点/＞的功率数据；对于第个配变对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量及反向积分电量/＞分别为：；；式中，为第/＞个配变在采样时间点/＞的功率数据；按照下式，计算单开关下游分段在指定统计时间段/＞的输入电量/＞、输出电量：；；按照下式，计算单开关下游分段在指定统计时间段/＞的分时分段统计线损率/＞：。13.根据权利要求9所述的一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：所述的遍历单开关下游分段集合，利用状态估计方法，计算单开关下游的分时分段理论线损率，包括以下步骤：利用加权最小二乘状态估计方法，对单开关下游分段集合中的单开关下游分段/＞进行状态估计，估算出在采样时间点/＞的单开关下游分段/＞中第/＞个可信开关的功率估计值序列/＞和第/＞个配变的功率估计值序列/＞；利用单开关下游分段中的可信开关的功率估计值序列和配变的功率估计值序列，按照下式，计算单开关下游分段/＞的分时分段理论线损率/＞：；式中，、/＞分别为第/＞个可信开关利用功率估计值序列/＞计算出的正向积分电量和反向积分电量；/＞、/＞分别为第/＞个配变利用功率估计值序列/＞计算出的正向积分电量和反向积分电量。14.根据权利要求9所述的一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线损异常单开关下游集合/＞，包括以下步骤：对于任意一属于单开关下游分段集合的单开关下游分段/＞，获取该单开关下游分段任意时间段的分时分段统计线损率/＞和分时分段理论线损率/＞；若单开关下游分段任意时间段的分时分段统计线损率/＞与分时分段理论线损率之间的偏差满足如下：；则单开关下游分段为线损异常单开关下游分段，加入到线损异常单开关下游集合/＞中；式中，/＞表示单开关下游分段的线损两率偏差阈值。15.根据权利要求9所述的一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：所述的遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞，包括以下步骤：基于自动化开关的历史分级保护分合闸信号和配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段的自动化开关的历史分级保护分合闸信号和配变的历史停电事件，定义为发生分级保护故障的配变停电事件集合/＞，通过发生分级保护故障的开关将线路分为故障区域/＞和非故障区域/＞，其中故障区域/＞为发生分级保护故障的开关围成的配变集合，非故障区域/＞为线路上不在故障区域的其他配变集合；若线损异常单开关下游分段在故障区域/＞中，则线损异常单开关下游分段/＞内所有配变应该停电，将线损异常单开关下游分段/＞内配变与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，判定线损异常单开关下游分段为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，应停未停配变集合的配变个数/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞1为应停未停配变集合/＞中的配变数量；若线损异常单开关下游分段在非故障区域/＞中，则线损异常单开关下游分段内所有配变不该停电；将线损异常单开关下游分段/＞与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在停电的配变时，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，不该停但停配变集合的配变个数/＞占比计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为不该停但停配变集合/＞中的配变数量；基于无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，定义为无分级保护故障的配变停电事件集合/＞；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量/＞占比大于阈值/＞时，则该线损异常单开关下游分段/＞内所有配变应该停电，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量占比/＞小于等于阈值/＞，则该线损异常单开关下游分段/＞内所有配变不应该停电，若线损异常单开关下游分段/＞上存在停电的配变，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变数量占比/＞小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量占比/＞计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量。16.根据权利要求9所述的一种多模型融合的配电网分时分段线损精细诊断系统，其特征在于：所述的对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合，包括以下步骤：/＞S700：取线损异常单开关下游集合中段变关系正常的线损异常单开关下游分段，判断在该段变关系正常的线损异常单开关下游分段内是否只存在一个专变，若是，则利用加权最小二乘状态估计方法，估算出该专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与该专变的功率量测数据的功率偏差率大于功率偏差率阈值/＞的专变加入到疑似用电异常配变集合/＞中；否则，假定有/＞个专变，则利用专变的功率量测数据，计算每个专变在指定统计时间段/＞内的积分电量并排序，生成积分电量排名集合/＞，并执行S710；S710：取当前积分电量排名集合中第一名的专变，在该专变的上游安装1个便携式量测终端；S720：利用便携式量测终端将当前段变关系正常的线损异常单开关下游分段分为上游子分段和下游子分段，计算上游子分段和下游子分段的统计线损率，若下游子分段的统计线损率大于上游子分段的统计线损率，则在下游子分段中该专变疑似用电异常，执行S730；若下游子分段的统计线损率不大于上游子分段的统计线损率，则在积分电量排名集合中剔除该专变，执行S710，直至积分电量排名集合/＞为空停止；S730：利用加权最小二乘状态估计方法，估算出被认定为疑似用电异常的专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与功率量测数据的功率偏差率大于功率偏差率阈值的专变加入到疑似用电异常配变集合/＞中。17.一种计算机设备，其特征在于，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现权利要求1至8任意一项所述的一种多模型融合的配电网分时分段线损精细诊断方法的步骤。18.一种存储介质，其特征在于，所述存储介质存储有诊断程序，所述诊断程序被至少一个处理器执行时实现权利要求1至8任意一项所述的一种多模型融合的配电网分时分段线损精细诊断方法的步骤。
说明书desc
技术领域本发明属于中压配电网线损诊断技术领域，具体为一种多模型融合的配电网分时分段线损精细诊断方法及系统。背景技术线损是反映公司经营效益和管理水平的关键指标。传统配电网线损计算在空间维度是整线，时间维度是整天，难以精准定位线路线损异常时空区段，存在部分顽固高负损线路难以治理，存在疑难异常用电行为难以发现。随着配电自动化的持续建设及实用化水平不断提升，在馈线中间增加了大量量测终端，通过配电自动化量测数据与营配调数据的深度融合，可将传统的日线损计算拓展到空间上以自动化开关为分段、时间上以量测数据采样周期为时段的分时分段线损计算模式，有利于将异常现象放大到其所属区段中，提升了线损分析的精细度和准确度。因此，研究基于多模型融合的配电网分时分段线损精细诊断方法及相关技术具有重要的应用价值，可帮助相关部门精准定位线路线损异常时空区段，加快线损异常的定位和追踪，提供了线损问题治理有力抓手。发明内容发明目的：为解决当前配电网线损计算难以精准定位线路线损异常时空区段的问题，本发明提出了一种多模型融合的配电网分时分段线损精细诊断方法及系统。技术方案：一种多模型融合的配电网分时分段线损精细诊断方法，包括以下步骤；步骤1：获取待诊断线路的拓扑结构、自动化开关的台账、配变的台账、待诊断线路参数和配变参数；以及获取待诊断线路的量测数据、自动化开关的量测数据和历史分级保护分合闸信号、配变的量测数据和历史停电事件；所述自动化开关和配变位于待诊断线路上；步骤2：利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合；步骤3：遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞；步骤4：遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率；遍历单开关下游分段集合/＞，利用状态估计方法，计算单开关下游的分时分段理论线损率；步骤5：对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线损异常单开关下游集合/＞；步骤6：遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞；步骤7：对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合。进一步的，所述的利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合，包括以下步骤：从距离待诊断线路首端最近的自动化开关开始，遍历到距离待诊断线路末端最近的自动化开关结束，假设待诊断线路上第个自动化开关的上游为/＞，利用加权最小二乘状态估计方法，对第/＞个自动化开关的上游/＞进行状态估计，估算出第个自动化开关的功率估计值序列/＞和电流估计值序列/＞；将第个自动化开关的功率量测数据/＞与功率估计值序列/＞进行对比，仅当两者的功率偏差率小于功率偏差率阈值/＞时，表示第/＞个自动化开关的功率量测数据可用；将第个自动化开关的电流量测数据/＞与电流估计值序列/＞进行对比，仅当两者的电流偏差率小于电流偏差率阈值/＞时，则表示第/＞个自动化开关的电流量测数据可用；若第个自动化开关的功率量测数据和电流量测数据均可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据可用但电流量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的电流量测数据可用但功率量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率估计值序列/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据和电流量测数据均不可用，则表示第/＞个自动化开关为不可信开关。进一步的，所述的遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞，包括以下步骤：判断待诊断线路的可信开关集合是否为空，若可信开关集合/＞不为空，从距离待诊断线路末端最近的可信开关开始，遍历到距离待诊断线路首端最近的可信开关结束；若可信开关集合/＞为空，则停止计算，将待诊断线路的拓扑结构加入到单开关下游分段集合/＞；当遍历到可信开关集合中的第/＞个可信开关，若存在以第/＞个可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段/＞时，且所述单开关下游分段/＞内包含1个以上的配变，则将该单开关下游分段/＞加入单开关下游分段集合/＞中，该单开关下游分段/＞从待诊断线路的拓扑结构中剪除，并将第/＞个可信开关等效为待诊断线路拓扑中负荷叶子节点；否则，继续遍历可信开关集合/＞的其他可信开关。进一步的，所述的遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率，包括以下步骤：假定单开关下游分段集合中的单开关下游分段/＞以1个可信开关为根节点，分段内共有/＞个配变和/＞个视为负荷叶子节点的下游可信开关，获取/＞个可信开关的功率数据和/＞个配变的功率数据；假定可信开关的功率数据和配变的功率数据在指定统计时间段内等间距采样，采样时间点记为/＞；对于第个可信开关，将流入单开关下游分段/＞的功率数据设置为正向，流出单开关下游分段/＞的功率数据设置为反向，则第/＞个可信开关对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量/＞及反向积分电量/＞分别为：；；式中，为第/＞个可信开关在采样时间点/＞的功率数据；对于第个配变对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量及反向积分电量/＞分别为：；；式中，为第/＞个配变在采样时间点/＞的功率数据；按照下式，计算单开关下游分段在指定统计时间段/＞的输入电量/＞、输出电量/＞：；；按照下式，计算单开关下游分段在指定统计时间段/＞的分时分段统计线损率：。进一步的，所述的遍历单开关下游分段集合，利用状态估计方法，计算单开关下游的分时分段理论线损率，包括以下步骤：利用加权最小二乘状态估计方法，对单开关下游分段集合中的单开关下游分段进行状态估计，估算出在采样时间点/＞的单开关下游分段/＞中第/＞个可信开关的功率估计值序列/＞和第/＞个配变的功率估计值序列/＞；利用单开关下游分段中的可信开关的功率估计值序列和配变的功率估计值序列，按照下式，计算单开关下游分段/＞的分时分段理论线损率/＞：；式中，、/＞分别为第/＞个可信开关利用功率估计值序列/＞计算出的正向积分电量和反向积分电量；/＞、/＞分别为第/＞个配变利用功率估计值序列/＞计算出的正向积分电量和反向积分电量。进一步的，对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线损异常单开关下游集合/＞，包括以下步骤：对于任意一属于单开关下游分段集合的单开关下游分段/＞，获取该单开关下游分段任意时间段的分时分段统计线损率/＞和分时分段理论线损率/＞；若单开关下游分段任意时间段的分时分段统计线损率/＞与分时分段理论线损率/＞之间的偏差满足如下：；则单开关下游分段为线损异常单开关下游分段，加入到线损异常单开关下游集合/＞中；式中，/＞表示单开关下游分段的线损两率偏差阈值。进一步的，所述的遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞，包括以下步骤：基于自动化开关的历史分级保护分合闸信号和配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段的自动化开关的历史分级保护分合闸信号和配变的历史停电事件，定义为发生分级保护故障的配变停电事件集合/＞，通过发生分级保护故障的开关将线路分为故障区域/＞和非故障区域/＞，其中故障区域/＞为发生分级保护故障的开关围成的配变集合，非故障区域/＞为线路上不在故障区域的其他配变集合；若线损异常单开关下游分段在故障区域/＞中，则线损异常单开关下游分段内所有配变应该停电，将线损异常单开关下游分段/＞内配变与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，应停未停配变集合的配变个数/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞1为应停未停配变集合中的配变数量；若线损异常单开关下游分段在非故障区域/＞中，则线损异常单开关下游分段/＞内所有配变不该停电；将线损异常单开关下游分段/＞与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在停电的配变时，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，不该停但停配变集合的配变个数/＞占比计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为不该停但停配变集合中的配变数量；基于无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，定义为无分级保护故障的配变停电事件集合/＞；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量/＞占比大于阈值/＞时，则该线损异常单开关下游分段/＞内所有配变应该停电，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段/＞内停电配变数量；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量占比/＞小于等于阈值/＞，则该线损异常单开关下游分段/＞内所有配变不应该停电，若线损异常单开关下游分段/＞上存在停电的配变，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变数量占比/＞小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量占比/＞计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量。进一步的，所述的对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合，包括以下步骤：S700：取线损异常单开关下游集合中段变关系正常的线损异常单开关下游分段，判断在该段变关系正常的线损异常单开关下游分段内是否只存在一个专变，若是，则利用加权最小二乘状态估计方法，估算出该专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与该专变的功率量测数据的功率偏差率大于功率偏差率阈值/＞的专变加入到疑似用电异常配变集合/＞中；否则，假定有个专变，则利用专变的功率量测数据，计算每个专变在指定统计时间段/＞内的积分电量并排序，生成积分电量排名集合/＞，并执行S710；S710：取当前积分电量排名集合中第一名的专变，在该专变的上游安装1个便携式量测终端；S720：利用便携式量测终端将当前段变关系正常的线损异常单开关下游分段分为上游子分段和下游子分段，计算上游子分段和下游子分段的统计线损率，若下游子分段的统计线损率大于上游子分段的统计线损率，则在下游子分段中该专变疑似用电异常，执行S730；若下游子分段的统计线损率不大于上游子分段的统计线损率，则在积分电量排名集合中剔除该专变，执行S710，直至积分电量排名集合/＞为空停止；S730：利用加权最小二乘状态估计方法，估算出被认定为疑似用电异常的专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与功率量测数据的功率偏差率大于功率偏差率阈值的专变加入到疑似用电异常配变集合/＞中。本发明公开了一种多模型融合的配电网分时分段线损精细诊断系统，包括；诊断数据获取模块，用于获取待诊断线路的拓扑结构、自动化开关的台账、配变的台账、待诊断线路参数和配变参数；以及获取待诊断线路的量测数据、自动化开关的量测数据和历史分级保护分合闸信号、配变的量测数据和历史停电事件；所述自动化开关和配变位于待诊断线路上；可信开关集合生成模块，用于利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合；单开关下游分段集合生成模块，用于遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞；线损率计算模块，用于遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率；遍历单开关下游分段集合/＞，利用状态估计方法，计算单开关下游的分时分段理论线损率；线损异常单开关下游集合生成模块，用于对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合/＞中，以此生成线损异常单开关下游集合/＞；疑似段变关系异常配变集合输出模块，用于遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞；疑似用电异常配变集合输出模块，用于对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合。进一步的，所述的利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合，包括以下步骤：从距离待诊断线路首端最近的自动化开关开始，遍历到距离待诊断线路末端最近的自动化开关结束，假设待诊断线路上第个自动化开关的上游为/＞，利用加权最小二乘状态估计方法，对第/＞个自动化开关的上游/＞进行状态估计，估算出第个自动化开关的功率估计值序列/＞和电流估计值序列/＞；将第个自动化开关的功率量测数据/＞与功率估计值序列/＞进行对比，仅当两者的功率偏差率小于功率偏差率阈值/＞时，表示第/＞个自动化开关的功率量测数据可用；将第个自动化开关的电流量测数据/＞与电流估计值序列/＞进行对比，仅当两者的电流偏差率小于电流偏差率阈值/＞时，则表示第/＞个自动化开关的电流量测数据可用；若第个自动化开关的功率量测数据和电流量测数据均可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据可用但电流量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的电流量测数据可用但功率量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率估计值序列/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据和电流量测数据均不可用，则表示第/＞个自动化开关为不可信开关。进一步的，所述的遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞，包括以下步骤：判断待诊断线路的可信开关集合是否为空，若可信开关集合/＞不为空，从距离待诊断线路末端最近的可信开关开始，遍历到距离待诊断线路首端最近的可信开关结束；若可信开关集合/＞为空，则停止计算，将待诊断线路的拓扑结构加入到单开关下游分段集合/＞；当遍历到可信开关集合中的第/＞个可信开关，若存在以第/＞个可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段/＞时，且所述单开关下游分段/＞内包含1个以上的配变，则将该单开关下游分段/＞加入单开关下游分段集合/＞中，该单开关下游分段/＞从待诊断线路的拓扑结构中剪除，并将第/＞个可信开关等效为待诊断线路拓扑中负荷叶子节点；否则，继续遍历可信开关集合/＞的其他可信开关。进一步的，所述的遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率，包括以下步骤：假定单开关下游分段集合中的单开关下游分段/＞以1个可信开关为根节点，分段内共有/＞个配变和/＞个视为负荷叶子节点的下游可信开关，获取/＞个可信开关的功率数据和/＞个配变的功率数据；假定可信开关的功率数据和配变的功率数据在指定统计时间段内等间距采样，采样时间点记为/＞；对于第个可信开关，将流入单开关下游分段/＞的功率数据设置为正向，流出单开关下游分段/＞的功率数据设置为反向，则第/＞个可信开关对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量/＞及反向积分电量/＞分别为：；；式中，为第/＞个可信开关在采样时间点/＞的功率数据；对于第个配变对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量及反向积分电量/＞分别为：；；式中，为第/＞个配变在采样时间点/＞的功率数据；按照下式，计算单开关下游分段在指定统计时间段/＞的输入电量/＞、输出电量/＞：；；按照下式，计算单开关下游分段在指定统计时间段/＞的分时分段统计线损率：。进一步的，所述的遍历单开关下游分段集合，利用状态估计方法，计算单开关下游的分时分段理论线损率，包括以下步骤：利用加权最小二乘状态估计方法，对单开关下游分段集合中的单开关下游分段进行状态估计，估算出在采样时间点/＞的单开关下游分段/＞中第/＞个可信开关的功率估计值序列/＞和第/＞个配变的功率估计值序列/＞；利用单开关下游分段中的可信开关的功率估计值序列和配变的功率估计值序列，按照下式，计算单开关下游分段/＞的分时分段理论线损率/＞：；式中，、/＞分别为第/＞个可信开关利用功率估计值序列/＞计算出的正向积分电量和反向积分电量；/＞、/＞分别为第/＞个配变利用功率估计值序列/＞计算出的正向积分电量和反向积分电量。进一步的，对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线损异常单开关下游集合/＞，包括以下步骤：对于任意一属于单开关下游分段集合的单开关下游分段/＞，获取该单开关下游分段任意时间段的分时分段统计线损率/＞和分时分段理论线损率/＞；若单开关下游分段任意时间段的分时分段统计线损率/＞与分时分段理论线损率/＞之间的偏差满足如下：；则单开关下游分段为线损异常单开关下游分段，加入到线损异常单开关下游集合/＞中；式中，/＞表示单开关下游分段的线损两率偏差阈值。进一步的，所述的遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞，包括以下步骤：基于自动化开关的历史分级保护分合闸信号和配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段的自动化开关的历史分级保护分合闸信号和配变的历史停电事件，定义为发生分级保护故障的配变停电事件集合/＞，通过发生分级保护故障的开关将线路分为故障区域/＞和非故障区域/＞，其中故障区域/＞为发生分级保护故障的开关围成的配变集合，非故障区域/＞为线路上不在故障区域的其他配变集合；若线损异常单开关下游分段在故障区域/＞中，则线损异常单开关下游分段内所有配变应该停电，将线损异常单开关下游分段/＞内配变与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，应停未停配变集合的配变个数/＞占比的计算公式如下：；/＞式中，为线损异常单开关下游分段/＞的配变总数，/＞1为应停未停配变集合中的配变数量；若线损异常单开关下游分段在非故障区域/＞中，则线损异常单开关下游分段/＞内所有配变不该停电；将线损异常单开关下游分段/＞与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在停电的配变时，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，不该停但停配变集合的配变个数/＞占比计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为不该停但停配变集合中的配变数量；基于无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，定义为无分级保护故障的配变停电事件集合/＞；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量/＞占比大于阈值/＞时，则该线损异常单开关下游分段/＞内所有配变应该停电，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段/＞内停电配变数量；/＞若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量占比/＞小于等于阈值/＞，则该线损异常单开关下游分段/＞内所有配变不应该停电，若线损异常单开关下游分段/＞上存在停电的配变，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变数量占比/＞小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量占比/＞计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量。进一步的，所述的对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合，包括以下步骤：S700：取线损异常单开关下游集合中段变关系正常的线损异常单开关下游分段，判断在该段变关系正常的线损异常单开关下游分段内是否只存在一个专变，若是，则利用加权最小二乘状态估计方法，估算出该专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与该专变的功率量测数据的功率偏差率大于功率偏差率阈值/＞的专变加入到疑似用电异常配变集合/＞中；否则，假定有个专变，则利用专变的功率量测数据，计算每个专变在指定统计时间段/＞内的积分电量并排序，生成积分电量排名集合/＞，并执行S710；S710：取当前积分电量排名集合中第一名的专变，在该专变的上游安装1个便携式量测终端；S720：利用便携式量测终端将当前段变关系正常的线损异常单开关下游分段分为上游子分段和下游子分段，计算上游子分段和下游子分段的统计线损率，若下游子分段的统计线损率大于上游子分段的统计线损率，则在下游子分段中该专变疑似用电异常，执行S730；若下游子分段的统计线损率不大于上游子分段的统计线损率，则在积分电量排名集合中剔除该专变，执行S710，直至积分电量排名集合/＞为空停止；S730：利用加权最小二乘状态估计方法，估算出被认定为疑似用电异常的专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与功率量测数据的功率偏差率大于功率偏差率阈值的专变加入到疑似用电异常配变集合/＞中。本发明公开了一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现一种多模型融合的配电网分时分段线损精细诊断方法的步骤。本发明公开了一种存储介质，所述存储介质存储有诊断程序，所述诊断程序被至少一个处理器执行时实现一种多模型融合的配电网分时分段线损精细诊断方法的步骤。有益效果：本发明与现有技术相比，具有以下优点：本发明将整线整日线损计算拓展到空间上以自动化开关为分段、时间上以量测数据采样周期为时段的分时分段线损计算模式，有利于将异常现象放大到其所属区段中，大大提升了线损分析的精细度和准确度；本发明利用统计方法和加权最小二乘状态估计方法分别进行基于单开关下游的分时分段统计线损率和理论线损率的线损两率计算，并利用线损两率对比获取线损异常单开关下游，大大提高诊断的准确率；本发明提出了基于停电事件的段变关系异常诊断方法，能实现快速诊断出段变关系异常的配变，方便运维人员正确维护段变关系；本发明提出了基于状态估计方法和便携式量测终端的配变用电异常诊断，能够及时发现疑难异常用电行为，可帮助相关部门治理部分顽固高负损线路；本发明计算简单，原理明确，可实现精准定位线路线损异常时空区段，加快线损异常的定位和追踪，提供了线损问题治理有力抓手，具有良好的应用前景。附图说明图1为本发明公开的一种多模型融合的配电网分时分段线损精细诊断方法的流程示意图；图2为实施例1中某线路单线示意图；图3为单开关下游分段的普通模式示意图；图4为单开关下游分段的等效模式示意图；图5为本发明公开的一种多模型融合的配电网分时分段线损精细诊断系统的框图。具体实施方式现结合附图和实施例进一步阐述本发明的技术方案。实施例1本实施例以2023年7月2日某地市某变电站某线路为例，对本发明提出的一种多模型融合的配电网分时分段线损精细诊断方法做进一步说明。图1描述了将多模型融合的配电网分时分段线损精细诊断方法应用于中压配电网中的情况，包括但不限于进行中压配电网线损诊断。如图1所示，本实施例采用的一种多模型融合的配电网分时分段线损精细诊断方法，其主要包括以下步骤：步骤1：某地市某变电站某线路下辖19个配变和6个自动化开关，具体包含：公变9个、专变10个、1个断路器和5个自动化开关，其单线图如图2所示。从PMS系统获取线路/＞的拓扑结构、所属母线台账、19个配变、1个断路器和5个自动化开关的台账，母线、线路、自动化开关、配变之间的关联关系，线路的导线长度、电阻、电抗、额定功率、允许载流量等设备参数，配变的电阻、电抗等设备参数。/＞以及从D5000系统利用断路器编号和母线编号获取2023年7月2日的线路96点功率、电流、电压数据，从配电自动化系统利用自动化开关编号获取2023年7月2日的5个自动化开关96点功率、电流数据，从用电采集系统利用19个配变对应的采集对象编号获取2023年7月2日配变的96点功率、电压、电流数据，从供电可靠性系统获取19个配变2023年7月2日之前的历史停电事件和自动化开关的历史分级保护分合闸信号。步骤2：利用加权最小二乘状态估计方法开展自动化开关可信度辨识，生成线路的可信开关集合/＞；具体操作步骤包括：S200：从距离线路首端最近的自动化开关开始，遍历到距离线路/＞末端最近的自动化开关结束，假设线路/＞上第/＞个自动化开关的上游为/＞，利用加权最小二乘状态估计方法，对第/＞个自动化开关的上游/＞进行状态估计，估算出第个自动化开关的功率估计值序列/＞和电流估计值序列/＞；如图2所示，假设从距离线路首端最近的自动化开关开始，遍历到距离线路/＞末端最近的自动化开关结束，即遍历顺序为：自动化开关BR1、BR2、BR3、BR4、BR5，现以自动化开关BR1为例，自动化开关BR1的上游为BR-BR1，包含配变PB1、配变PB15、配变PB16、配变PB17等4个配变，获取上游BR-BR1的设备台账、设备参数、功率、电压、电流量测数据，利用加权最小二乘状态估计方法，对自动化开关BR1的上游为BR-BR1进行状态估计，估算出第1个自动化开关BR1的功率估计值序列/＞、电流估计值序列/＞，其他自动化开关同理计算功率估计值序列/＞，电流估计值序列/＞。将自动化开关的功率量测数据与功率估计值序列进行对比，仅当两者之间的偏差率小于功率偏差率阈值，则表示自动化开关的功率量测数据可用；具体操作包括：获取第个自动化开关在时间段/＞内的功率量测数据/＞为：；式中，分别表示第/＞个自动化开关的功率量测数据和第/＞个自动化开关在第个时刻的功率；基于对自动化开关的上游进行状态估计，获取第个自动化开关在时间段/＞内的功率估计值序列/＞为：；式中，分别表示第/＞个自动化开关的功率估计值序列和第/＞个自动化开关在第/＞个时刻的功率估计值；将自动化开关的功率量测数据与功率估计值序列进行对比，仅当两者之间的偏差率小于功率偏差率阈值，则表示自动化开关的功率量测数据可用。其中，两个自动化开关的功率量测数据与功率估计值序列的偏差率计算公式如下：；式中，为线路/＞的额定功率，/＞为/＞和/＞的偏差率，/＞表示时间段/＞内的采样点个数。本实施例中，功率偏差率阈值取3%，按上述步骤判断自动化开关BR1、BR2、BR3、BR4、BR5的功率量测数据是否可用，经过上述计算，在本实施例中，功率量测数据可用的自动化开关为BR1、BR2、BR3、BR5，功率量测数据不可用的自动化开关为BR4。S220：同理，将自动化开关的电流量测数据与电流估计值序列进行对比，仅当两者之间的偏差率小于电流偏差率阈值，则自动化开关电流量测数据可用。其中，自动化开关的电流量测数据与电流估计值序列的偏差率计算公式如下：；式中，为线路/＞的允许载流量，/＞为/＞的偏差率，/＞表示第/＞个自动化开关在第/＞个时刻的电流估计值，/＞表示第/＞个自动化开关在第/＞个时刻的电流；本实施例中，电流偏差率阈值取3%，同理判断自动化开关BR1、BR2、BR3、BR4、BR5电流量测数据是否可用，经过上述计算，在本实施例中，电流量测数据可用的自动化开关为BR1、BR3、BR4，电流量测数据不可用的自动化开关为BR2、BR5。S230：若第个自动化开关的功率量测数据和电流量测数据均可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第/＞个自动化开关的功率量测数据可用但电流量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第/＞个自动化开关的电流量测数据可用但功率量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合中，将第/＞个自动化开关的功率估计值序列/＞作为第/＞个自动化开关的功率数据；若第/＞个自动化开关的功率量测数据和电流量测数据均不可用，则表示第/＞个自动化开关为不可信开关。本实施例中，由于断路器BR的数据质量较好，直接判为可信开关，利用上述规则判断自动化开关BR1、BR2、BR3、BR4、BR5是否可信，可信开关集合包括自动化开关BR、BR1、BR2、BR3、BR4、BR5，具体如下：表1自动化开关可信辨识结果表步骤3：遍历线路的可信开关集合/＞，利用剪枝法生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的所有单开关下游分段集合/＞。具体包括以下步骤：单开关下游分段有两种模式：一种是普通模式的单开关下游分段，见图3中虚线框图部分；另一种是等效模式的单开关下游分段，见图4中虚线框图部分。判断待诊断线路的可信开关集合是否为空，若可信开关集合/＞不为空，从距离待诊断线路末端最近的可信开关开始，遍历到距离待诊断线路首端最近的可信开关结束；若可信开关集合/＞为空，则停止计算，将待诊断线路的拓扑结构加入到单开关下游分段集合/＞；当遍历到可信开关集合中的第/＞个可信开关，若存在以第/＞个可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段/＞时，且所述单开关下游分段/＞内包含1个以上的配变，则将该单开关下游分段/＞加入单开关下游分段集合/＞中，该单开关下游分段/＞从待诊断线路的拓扑结构中剪除，并将第/＞个可信开关等效为待诊断线路拓扑中负荷叶子节点；否则，继续遍历可信开关集合/＞的其他可信开关。本实施例中，线路的可信开关集合/＞有BR、BR1、BR2、BR3、BR4、BR5可信开关，从距离待诊断线路末端最近的可信开关开始，遍历到距离待诊断线路首端最近的可信开关结束，遍历的顺序为BR5、BR4、BR3、BR2、BR1、BR，利用上述规则，遍利用剪枝法生成5个单开关下游分段集合/＞：BR5下游分段、BR4下游分段、BR3-BR5间分段、BR2下游分段、BR-BR1间分段，具体如下：表2单开关下游分段生成结果表步骤4：遍历线路的单开关下游分段集合/＞，利用统计方法和加权最小二乘状态估计方法分别进行基于单开关下游的分时分段统计线损率和理论线损率的线损两率计算。具体包括以下步骤：遍历线路的单开关下游分段集合/＞，利用统计方法进行基于单开关下游的分时分段统计线损率计算，包括：当遍历单开关下游分段集合中的单开关下游分段/＞时，假定单开关下游分段集合/＞中的单开关下游分段/＞以1个可信开关为根节点，分段内共有/＞个配变和/＞个视为负荷叶子节点的下游可信开关，获取/＞个可信开关的功率数据和/＞个配变的功率数据；假定可信开关的功率数据和配变的功率数据在指定统计时间段内等间距采样，采样时间点记为/＞；/＞和/＞分别为第/＞个可信开关和第/＞个配变在采样时间点/＞的功率量测值，下面利用矩形面积法计算可信开关及配变在指定统计时间段/＞内的正向积分电量和反向积分电量：对于第个可信开关，将流入单开关下游分段/＞的功率数据设置为正向，流出单开关下游分段/＞的功率数据设置为反向，则第/＞个可信开关对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量/＞及反向积分电量/＞分别为：；；对于第个配变对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量及反向积分电量/＞分别为：；；单开关下游分段输入电量为/＞个可信开关的正向积分电量和/＞个配变正向积分电量的和，输出电量为/＞个可信开关的反向积分电量和/＞个配变反向积分电量的和，按照下式，计算单开关下游分段/＞在指定统计时间段/＞的输入电量/＞、输出电量/＞：；；按照下式，计算单开关下游分段在指定统计时间段/＞的分时分段统计线损率：。遍历单开关下游分段集合，利用加权最小二乘状态估计方法，计算单开关下游的分时分段理论线损率，包括以下步骤：当遍历线路的单开关下游分段集合/＞时，利用加权最小二乘状态估计方法，对单开关下游分段集合/＞中的单开关下游分段/＞进行状态估计，估算出在采样时间点/＞的单开关下游分段/＞中第/＞个可信开关的功率估计值序列/＞和第/＞个配变的功率估计值序列/＞；利用单开关下游分段中的可信开关的功率估计值序列和配变的功率估计值序列，类似上述统计线损率的计算，按照下式，计算单开关下游分段/＞的分时分段理论线损率/＞：；式中，、/＞分别为第/＞个可信开关利用功率估计值序列/＞计算出的正向积分电量和反向积分电量；/＞、/＞分别为第/＞个配变利用功率估计值序列/＞计算出的正向积分电量和反向积分电量。本实施例中，利用上述方法分别计算整线路和5个单开关下游分段集合在7月2日的日统计线损率、日理论线损率及，，，四个时间段的统计线损率、理论线损率，具体如下表3所示。表3线路及各分段的分时统计线损率和理论线损率步骤5：对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线路/＞的线损异常单开关下游集合/＞，包括以下步骤：对于任意一属于单开关下游分段集合的单开关下游分段/＞，获取该单开关下游分段/＞任意时间段的分时分段统计线损率/＞和分时分段理论线损率/＞；若单开关下游分段任意时间段的分时分段统计线损率/＞与分时分段理论线损率/＞之间的偏差满足如下：；则单开关下游分段为线损异常单开关下游分段，加入到线路/＞线损异常单开关下游集合/＞中；式中，/＞表示单开关下游分段的线损两率偏差阈值。本实施例中，单开关下游分段的线损两率偏差阈值/＞取10%，对上述表3中分别计算整线路和5个单开关下游分段在7月2日的日线损两率偏差及，，，四个时间段的线损两率偏差，具体如下表4所示。从表4可以看出，BR5下游分段、BR3-BR5间分段线损两率偏差超过阈值10%，则BR5下游分段、BR3-BR5间分段加入到线路/＞的线损异常单开关下游集合/＞中。表4馈线及各分段的分时线损两率偏差步骤6：遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞，包括以下步骤：基于自动化开关的历史分级保护分合闸信号和配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段的自动化开关的历史分级保护分合闸信号和配变的历史停电事件，定义为发生分级保护故障的配变停电事件集合/＞，通过发生分级保护故障的开关将线路分为故障区域/＞和非故障区域/＞，其中故障区域/＞为发生分级保护故障的开关围成的配变集合，非故障区域/＞为线路上不在故障区域的其他配变集合；若线损异常单开关下游分段在故障区域/＞中，则线损异常单开关下游分段内所有配变应该停电，将线损异常单开关下游分段/＞内配变与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，应停未停配变集合的配变个数/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞1为应停未停配变集合中的配变数量；/＞若线损异常单开关下游分段在非故障区域/＞中，则线损异常单开关下游分段/＞内所有配变不该停电；将线损异常单开关下游分段/＞与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在停电的配变时，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，不该停但停配变集合的配变个数/＞占比计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为不该停但停配变集合中的配变数量；基于无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，定义为无分级保护故障的配变停电事件集合/＞；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量/＞占比大于阈值/＞时，则该线损异常单开关下游分段/＞内所有配变应该停电，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段/＞内停电配变数量；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量占比/＞小于等于阈值/＞，则该线损异常单开关下游分段/＞内所有配变不应该停电，若线损异常单开关下游分段/＞上存在停电的配变，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变数量占比/＞小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量占比/＞计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量。本实施例中，阈值都取25%，阈值/＞取75%。针对BR5下游分段、BR3-BR5间分段所属线路/＞，获取2023年1月1日到2023年7月1日之间的线路/＞下所有配变停电事件和自动化开关的分级保护开合闸信号，发现2023年4月23日13:43:00到14:15:00期间自动化开关BR3发生了分级保护开合闸信号，BR5下游分段在故障区域中，并且BR5下游分段有3个配变停电，1个配变PB14没有停电，没有停电集合配变个数占比为25%，刚好满足S610方法中阈值/＞，则BR5下游分段为段变关系异常分段，配变PB14为段变关系异常配变。步骤7：对段变关系正常的线损异常单开关下游分段进行基于加权最小二乘状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合，包括以下步骤：S700：取线损异常单开关下游集合中段变关系正常的线损异常单开关下游分段，判断在该段变关系正常的线损异常单开关下游分段内是否只存在一个专变，若是，则利用加权最小二乘状态估计方法，估算出该专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与该专变的功率量测数据的功率偏差率大于功率偏差率阈值/＞的专变加入到疑似用电异常配变集合/＞中；否则，假定有个专变，则利用专变的功率量测数据，计算每个专变在指定统计时间段/＞内的积分电量并排序，生成积分电量排名集合/＞，并执行S710；S710：取当前积分电量排名集合中第一名的专变，在该专变的上游安装1个便携式量测终端，此处为便携式量测终端的最优安装位置；S720：利用便携式量测终端将当前段变关系正常的线损异常单开关下游分段分为上游子分段和下游子分段，计算上游子分段和下游子分段的统计线损率，若下游子分段的统计线损率大于上游子分段的统计线损率，则在下游子分段中该专变疑似用电异常，执行S730；若下游子分段的统计线损率不大于上游子分段的统计线损率，则在积分电量排名集合中剔除该专变，执行S710，直至积分电量排名集合/＞为空停止；S730：利用加权最小二乘状态估计方法，估算出被认定为疑似用电异常的专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与功率量测数据的功率偏差率大于功率偏差率阈值的专变加入到疑似用电异常配变集合/＞中。针对在S710中被判定为疑似用电异常的专变，利用加权最小二乘状态估计方法估算出该专变的功率估计值序列，将该专变的功率估计值序列与功率量测数据对比，若两者之间的偏差率大于功率偏差率阈值，则该专变用电异常，将其加入到疑似用电异常配变集合/＞中。本实施例中，针对段变关系正常的线损异常分段BR3-BR5间分段，该分段下面有2个公变和2个专变，其中PB5、PB6为专变，PB7、PB8为公变，将计算PB5、PB6在7月2日的积分电量，发现PB6积分电量更大，于是在PB6上游安装便携式量测终端M1，将该分段被分为BR3-M1-BR5和便携式量测终端M1下游分段。经过分析，便携式量测终端M1下游分段的统计线损率大于BR3-M1-BR5间分段的统计线损率，则专变PB6疑似用电异常。利用加权最小二乘状态估计方法估算出专变PB6的功率估计值序列，与专变PB6的功率量测数据对比，功率偏差率阈值取3%，发现专变PB6的功率估计值序列与专变PB6的功率量测数据之间的偏差率大于3%，则确定专变PB6为用电异常配变。经相关人员核查，核实专变PB6违法将电表开盖操作，并利用等比例方式进行窃电。实施例2如图5所示，本实施例公开了一种多模型融合的配电网分时分段线损精细诊断系统，包括：诊断数据获取模块，用于获取待诊断线路的拓扑结构、自动化开关的台账、配变的台账、待诊断线路参数和配变参数；以及获取待诊断线路的量测数据、自动化开关的量测数据和历史分级保护分合闸信号、配变的量测数据和历史停电事件；所述自动化开关和配变位于待诊断线路上；可信开关集合生成模块，用于利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合；单开关下游分段集合生成模块，用于遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞；线损率计算模块，用于遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率；遍历单开关下游分段集合/＞，利用状态估计方法，计算单开关下游的分时分段理论线损率；线损异常单开关下游集合生成模块，用于对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合/＞中，以此生成线损异常单开关下游集合/＞；疑似段变关系异常配变集合输出模块，用于遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞；疑似用电异常配变集合输出模块，用于对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合。在本实施例中，利用状态估计方法，对自动化开关进行可信度辨识，生成可信开关集合，包括以下步骤：从距离待诊断线路首端最近的自动化开关开始，遍历到距离待诊断线路末端最近的自动化开关结束，假设待诊断线路上第个自动化开关的上游为/＞，利用加权最小二乘状态估计方法，对第/＞个自动化开关的上游/＞进行状态估计，估算出第个自动化开关的功率估计值序列/＞和电流估计值序列/＞；将第个自动化开关的功率量测数据/＞与功率估计值序列/＞进行对比，仅当两者的功率偏差率小于功率偏差率阈值/＞时，表示第/＞个自动化开关的功率量测数据可用；将第个自动化开关的电流量测数据/＞与电流估计值序列/＞进行对比，仅当两者的电流偏差率小于电流偏差率阈值/＞时，则表示第/＞个自动化开关的电流量测数据可用；若第个自动化开关的功率量测数据和电流量测数据均可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据可用但电流量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率量测数据/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的电流量测数据可用但功率量测数据不可用，则表示第/＞个自动化开关为可信开关，加入到可信开关集合/＞中，将第/＞个自动化开关的功率估计值序列/＞作为第/＞个自动化开关的功率数据；若第个自动化开关的功率量测数据和电流量测数据均不可用，则表示第/＞个自动化开关为不可信开关。在本实施例中，遍历可信开关集合，利用剪枝法，生成以可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段集合/＞，包括以下步骤：判断待诊断线路的可信开关集合是否为空，若可信开关集合/＞不为空，从距离待诊断线路末端最近的可信开关开始，遍历到距离待诊断线路首端最近的可信开关结束；若可信开关集合/＞为空，则停止计算，将待诊断线路的拓扑结构加入到单开关下游分段集合/＞；当遍历到可信开关集合中的第/＞个可信开关，若存在以第/＞个可信开关为根节点且不存在非根节点、非叶子节点的其他可信开关的单开关下游分段/＞时，且所述单开关下游分段/＞内包含1个以上的配变，则将该单开关下游分段/＞加入单开关下游分段集合/＞中，该单开关下游分段/＞从待诊断线路的拓扑结构中剪除，并将第/＞个可信开关等效为待诊断线路拓扑中负荷叶子节点；否则，继续遍历可信开关集合/＞的其他可信开关。在本实施例中，遍历单开关下游分段集合，采用统计方法，计算单开关下游的分时分段统计线损率，包括以下步骤：假定单开关下游分段集合中的单开关下游分段/＞以1个可信开关为根节点，分段内共有/＞个配变和/＞个视为负荷叶子节点的下游可信开关，获取/＞个可信开关的功率数据和/＞个配变的功率数据；假定可信开关的功率数据和配变的功率数据在指定统计时间段内等间距采样，采样时间点记为/＞；对于第个可信开关，将流入单开关下游分段/＞的功率数据设置为正向，流出单开关下游分段/＞的功率数据设置为反向，则第/＞个可信开关对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量/＞及反向积分电量/＞分别为：；；式中，为第/＞个可信开关在采样时间点/＞的功率数据；对于第个配变对于单开关下游分段/＞在指定统计时间段/＞的正向积分电量及反向积分电量/＞分别为：；；式中，为第/＞个配变在采样时间点/＞的功率数据；按照下式，计算单开关下游分段在指定统计时间段/＞的输入电量/＞、输出电量/＞：；；按照下式，计算单开关下游分段在指定统计时间段/＞的分时分段统计线损率：。在本实施例中，遍历单开关下游分段集合，利用状态估计方法，计算单开关下游的分时分段理论线损率，包括以下步骤：利用加权最小二乘状态估计方法，对单开关下游分段集合中的单开关下游分段进行状态估计，估算出在采样时间点/＞的单开关下游分段/＞中第/＞个可信开关的功率估计值序列/＞和第/＞个配变的功率估计值序列/＞；/＞利用单开关下游分段中的可信开关的功率估计值序列和配变的功率估计值序列，按照下式，计算单开关下游分段/＞的分时分段理论线损率/＞：；式中，、/＞分别为第/＞个可信开关利用功率估计值序列/＞计算出的正向积分电量和反向积分电量；/＞、/＞分别为第/＞个配变利用功率估计值序列/＞计算出的正向积分电量和反向积分电量。在本实施例中，对于任意一属于单开关下游分段集合的单开关下游分段，仅当其分时分段统计线损率与分时分段理论线损率之间的偏差大于线损两率偏差阈值时，将该单开关下游分段加入到线损异常单开关下游集合中，以此生成线损异常单开关下游集合/＞，包括以下步骤：对于任意一属于单开关下游分段集合的单开关下游分段/＞，获取该单开关下游分段任意时间段的分时分段统计线损率/＞和分时分段理论线损率/＞；若单开关下游分段任意时间段的分时分段统计线损率/＞与分时分段理论线损率/＞之间的偏差满足如下：；则单开关下游分段为线损异常单开关下游分段，加入到线损异常单开关下游集合/＞中；式中，/＞表示单开关下游分段的线损两率偏差阈值。在本实施例中，遍历线损异常单开关下游集合，基于配变的历史停电事件和自动化开关的历史分级保护分合闸信号，进行基于停电事件的段变关系异常诊断，得到段变关系异常的线损异常单开关下游分段，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合/＞，包括以下步骤：基于自动化开关的历史分级保护分合闸信号和配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段的自动化开关的历史分级保护分合闸信号和配变的历史停电事件，定义为发生分级保护故障的配变停电事件集合/＞，通过发生分级保护故障的开关将线路分为故障区域/＞和非故障区域/＞，其中故障区域/＞为发生分级保护故障的开关围成的配变集合，非故障区域/＞为线路上不在故障区域的其他配变集合；若线损异常单开关下游分段在故障区域/＞中，则线损异常单开关下游分段内所有配变应该停电，将线损异常单开关下游分段/＞内配变与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，应停未停配变集合的配变个数/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞1为应停未停配变集合中的配变数量；若线损异常单开关下游分段在非故障区域/＞中，则线损异常单开关下游分段/＞内所有配变不该停电；将线损异常单开关下游分段/＞与发生分级保护故障的配变停电事件集合/＞进行关联过滤，若线损异常单开关下游分段/＞存在停电的配变时，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变个数/＞占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，不该停但停配变集合的配变个数/＞占比计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为不该停但停配变集合中的配变数量；基于无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，按照以下情况判断线损异常单开关下游分段是否存在段变关系异常，从段变关系异常的线损异常单开关下游分段中输出疑似段变关系异常配变集合：对于任意一属于线损异常单开关下游集合的线损异常单开关下游分段/＞，筛选出线损异常单开关下游分段/＞所属线路上同一时段无自动化开关的历史分级保护分合闸信号但有配变的历史停电事件，定义为无分级保护故障的配变停电事件集合/＞；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量/＞占比大于阈值/＞时，则该线损异常单开关下游分段/＞内所有配变应该停电，若线损异常单开关下游分段/＞存在没有停电的配变，则将没有停电的配变放入应停未停配变集合/＞中；仅当应停未停配变集合/＞的配变个数占比小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将应停未停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量/＞占比的计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段/＞内停电配变数量；若利用线损异常单开关下游分段筛选配变停电事件集合/＞，线损异常单开关下游分段/＞存在停电的配变数量占比/＞小于等于阈值/＞，则该线损异常单开关下游分段/＞内所有配变不应该停电，若线损异常单开关下游分段/＞上存在停电的配变，则将线损异常单开关下游分段/＞上停电的配变放入不该停但停配变集合/＞中；仅当不该停但停配变集合/＞的配变数量占比/＞小于等于阈值/＞或者配变个数小于等于2个时，则判定线损异常单开关下游分段/＞为段变关系异常的线损异常单开关下游分段，并将不该停但停配变集合/＞加入到疑似段变关系异常配变集合/＞中；其中，线损异常单开关下游分段存在停电的配变数量占比/＞计算公式如下：；式中，为线损异常单开关下游分段/＞的配变总数，/＞为线损异常单开关下游分段内停电配变数量。在本实施例中，对段变关系正常的线损异常单开关下游分段进行基于状态估计方法和便携式量测终端的配变用电异常诊断，输出疑似用电异常配变集合，包括以下步骤：S700：取线损异常单开关下游集合中段变关系正常的线损异常单开关下游分段，判断在该段变关系正常的线损异常单开关下游分段内是否只存在一个专变，若是，则利用加权最小二乘状态估计方法，估算出该专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与该专变的功率量测数据的功率偏差率大于功率偏差率阈值/＞的专变加入到疑似用电异常配变集合/＞中；否则，假定有个专变，则利用专变的功率量测数据，计算每个专变在指定统计时间段/＞内的积分电量并排序，生成积分电量排名集合/＞，并执行S710；S710：取当前积分电量排名集合中第一名的专变，在该专变的上游安装1个便携式量测终端；S720：利用便携式量测终端将当前段变关系正常的线损异常单开关下游分段分为上游子分段和下游子分段，计算上游子分段和下游子分段的统计线损率，若下游子分段的统计线损率大于上游子分段的统计线损率，则在下游子分段中该专变疑似用电异常，执行S730；若下游子分段的统计线损率不大于上游子分段的统计线损率，则在积分电量排名集合中剔除该专变，执行S710，直至积分电量排名集合/＞为空停止；S730：利用加权最小二乘状态估计方法，估算出被认定为疑似用电异常的专变的功率估计值序列，将该专变的功率估计值序列与该专变的功率量测数据进行比较，仅将功率估计值序列与功率量测数据的功率偏差率大于功率偏差率阈值的专变加入到疑似用电异常配变集合/＞中。实施例3本实施例公开了一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，处理器执行计算机程序时实现上述任意一实施例公开的步骤。实施例4本实施例公开了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现上述任意一实施例公开的步骤。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一非易失性计算机可读取存储介质中，该计算机程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、存储、数据库或其它介质的任何引用，均可包括非易失性和易失性存储器中的至少一种。非易失性存储器可包括只读存储器、磁带、软盘、闪存或光存储器等。易失性存储器可包括随机存取存储器或外部高速缓冲存储器。作为说明而非局限，RAM可以是多种形式，比如静态随机存取存储器或动态随机存取存储器等。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
