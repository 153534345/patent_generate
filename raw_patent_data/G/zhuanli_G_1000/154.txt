标题title
图像校正方法、装置、计算机设备和存储介质
摘要abst
本申请涉及一种图像校正方法、装置、计算机设备和存储介质。方法包括：针对待校正图像中的每个目标像素，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果；基于各尺度下的检测结果确定目标像素对应的离散程度；对目标像素进行色彩失真评估，得到目标像素对应的失真程度；基于目标像素对应的离散程度和失真程度确定出待校正图像中的色彩失真像素；对色彩失真像素的像素值进行校正，得到校正后的目标图像。采用本方法能够提高图像校正的准确性。
权利要求书clms
1.一种图像校正方法，其特征在于，所述方法包括：针对待校正图像中的每个目标像素，基于所述待校正图像中各像素的像素值对所述目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果；基于所述各尺度下的检测结果确定所述目标像素对应的离散程度；对所述目标像素进行色彩失真评估，得到所述目标像素对应的失真程度；基于所述目标像素对应的离散程度和失真程度确定出所述待校正图像中的色彩失真像素；对所述色彩失真像素的像素值进行校正，得到校正后的目标图像。2.根据权利要求1所述的方法，其特征在于，所述基于所述待校正图像中各像素的像素值对所述目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果，包括：基于所述待校正图像中各像素的像素值确定每个像素的亮度值；根据每个预设尺度和所述目标像素在所述待校正图像中的位置确定所述预设尺度下的检测范围；基于所述预设尺度下的检测范围内各像素的亮度值的离散程度确定所述预设尺度下的检测结果。3.根据权利要求1所述的方法，其特征在于，所述基于所述各尺度下的检测结果确定所述目标像素对应的离散程度，包括：根据所述各尺度下的检测结果的乘积确定所述目标像素对应的离散程度。4.根据权利要求1所述的方法，其特征在于，所述像素值包括各个颜色分量值；所述色彩失真像素呈现出目标颜色；所述对所述目标像素进行色彩失真评估，得到所述目标像素对应的失真程度，包括：确定所述目标像素的各个颜色分量值两两之间的颜色差值；根据所述颜色差值和失真评估函数对所述目标像素进行色彩失真评估，得到所述目标像素对应的失真程度；其中，所述失真评估函数是基于所述目标颜色对应的颜色分量关系构建的；所述失真程度与所述目标像素呈现出的目标颜色的强度相匹配。5.根据权利要求4所述的方法，其特征在于，所述目标像素的各个颜色分量值包括第一分量值、第二分量值和第三分量值；所述颜色差值包括第一色差值、第二色差值和第三色差值；所述第一色差值是所述第一分量值减去所述第二分量值得到的；所述第二色差值是所述第三分量值减去所述第二分量值得到的；所述第三色差值是所述第三分量值减去所述第二分量值得到的；所述目标颜色对应的颜色分量关系包括第三分量下的值大于第一分量下的值且所述第一分量下的值大于第二分量下的值；所述失真评估函数用于表征在输入色差值大于零的情况下输出失真程度为预设最大失真程度以及在输入色差值不大于零且大于预设调整参数的情况下所述输出失真程度与所述输入色差值正相关；所述根据所述颜色差值和失真评估函数对所述目标像素进行色彩失真评估，得到所述目标像素对应的失真程度，包括：分别将所述第一色差值、所述第二色差值和所述第三色差值作为失真评估函数的输入，得到所述失真评估函数输出的第一失真程度、第二失真程度和第三失真程度；对所述第一失真程度、所述第二失真程度和所述第三失真程度进行合并，得到所述目标像素对应的失真程度。6.根据权利要求1至5任一项所述的方法，其特征在于，所述色彩失真像素的像素值中目标分量值偏离真实值；所述对所述色彩失真像素的像素值进行校正，得到校正后的目标图像，包括：对所述色彩失真像素的非目标分量值进行转换处理，得到灰度值；根据预设衰减强度、所述色彩失真像素对应的失真程度和离散程度，将所述色彩失真像素的像素值与所述灰度值进行加权融合，得到校正后的目标图像。7.根据权利要求1至5任一项所述的方法，其特征在于，所述对所述色彩失真像素的像素值进行校正，得到校正后的目标图像，包括：根据所述色彩失真像素与每个非色彩失真像素间的距离，从各个非色彩失真像素中确定出参考像素；根据所述参考像素的像素值对所述色彩失真像素的像素值进行校正，得到校正后的目标图像。8.一种图像校正装置，其特征在于，所述装置包括：检测模块，用于针对待校正图像中的每个目标像素，基于所述待校正图像中各像素的像素值对所述目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果；第一确定模块，用于基于所述各尺度下的检测结果确定所述目标像素对应的离散程度；评估模块，用于对所述目标像素进行色彩失真评估，得到所述目标像素对应的失真程度；第二确定模块，用于基于所述目标像素对应的离散程度和失真程度确定出所述待校正图像中的色彩失真像素；校正模块，用于对所述色彩失真像素的像素值进行校正，得到校正后的目标图像。9.一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至7中任一项所述的方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1至7中任一项所述的方法的步骤。
说明书desc
技术领域本申请涉及图像处理技术领域，特别是涉及一种图像校正方法、装置、计算机设备和存储介质。背景技术随着图像处理技术的发展，出现了图像校正技术，图像校正技术被广泛应用于改善图像的质量。比如，对于镜头的色散、光线条件、拍摄角度等因素引起的图像缺陷，使用图像校正技术对图像缺陷进行后期处理，提高图像质量。传统技术中，人工手动地在图像处理软件上选取缺陷区域，使用图像处理软件提供的工具进行校正。但是，由于人眼的感知存在一定的局限性，使得难以准确地识别图像中的缺陷区域，导致图像校正的准确性不高。发明内容基于此，有必要针对上述技术问题，提供一种能够提高准确性的图像校正方法、装置、计算机设备、计算机可读存储介质和计算机程序产品。第一方面，本申请提供了一种图像校正方法，包括：针对待校正图像中的每个目标像素，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果；基于各尺度下的检测结果确定目标像素对应的离散程度；对目标像素进行色彩失真评估，得到目标像素对应的失真程度；基于目标像素对应的离散程度和失真程度确定出待校正图像中的色彩失真像素；对色彩失真像素的像素值进行校正，得到校正后的目标图像。第二方面，本申请还提供了一种图像校正装置，包括：检测模块，用于针对待校正图像中的每个目标像素，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果；第一确定模块，用于基于各尺度下的检测结果确定目标像素对应的离散程度；评估模块，用于对目标像素进行色彩失真评估，得到目标像素对应的失真程度；第二确定模块，用于基于目标像素对应的离散程度和失真程度确定出待校正图像中的色彩失真像素；校正模块，用于对色彩失真像素的像素值进行校正，得到校正后的目标图像。第三方面，本申请还提供了一种计算机设备，包括存储器和处理器，存储器存储有计算机程序，处理器执行计算机程序时实现上述的方法中的步骤。第四方面，本申请还提供了一种计算机可读存储介质，其上存储有计算机程序，计算机程序被处理器执行时实现上述的方法中的步骤。第五方面，本申请还提供了一种计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现上述的方法中的步骤。上述图像校正方法、装置、计算机设备、存储介质和计算机程序产品，针对待校正图像中的每个目标像素，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果；综合各尺度下的检测结果能够准确地确定目标像素对应的离散程度，目标像素对应的离散程度能够准确地表征目标像素是否处于高反差区域，离散程度越大则反差越大，而色彩失真现象往往出现在高反差区域；对目标像素进行色彩失真评估，得到目标像素对应的失真程度；处于高反差区域且失真程度高的目标像素往往是色彩失真像素，基于目标像素对应的离散程度和失真程度能够准确地确定出待校正图像中的色彩失真像素；进而能够精准地对色彩失真像素的像素值进行校正，得到校正后的目标图像，提高图像校正的准确性。附图说明为了更清楚地说明本申请实施例或相关技术中的技术方案，下面将对实施例或相关技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本申请实施例提供的一种图像校正方法的流程示意图。图2为本申请实施例提供的一种基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果的流程示意图。图3为本申请实施例提供的一种对目标像素进行色彩失真评估，得到目标像素对应的失真程度的流程示意图。图4为本申请实施例提供的一种根据颜色差值和失真评估函数对目标像素进行色彩失真评估，得到目标像素对应的失真程度的流程示意图。图5为本申请实施例提供的一种对色彩失真像素的像素值进行校正，得到校正后的目标图像的流程示意图。图6为本申请实施例提供的另一种对色彩失真像素的像素值进行校正，得到校正后的目标图像的流程示意图。图7为本申请实施例提供的一种图像校正装置的结构框图。图8为本申请实施例提供的一种计算机设备的内部结构图。图9为本申请实施例提供的另一种计算机设备的内部结构图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。在一个示例性的实施例中，如图1所示，提供了一种图像校正方法，以该方法应用于计算机设备为例进行说明，包括以下步骤102至步骤110。其中：步骤102，针对待校正图像中的每个目标像素，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果。其中，待校正图像中存在色彩失真现象。色彩失真现象可以是由物理元器件本身造成的，例如镜头色散；也可以是图像处理算法造成的，例如颜色插值等。色彩失真现象往往出现在像素值相差过大的区域，比如，高亮与低亮交界的高反差区域。比如，色彩失真现象可以但不限于图像紫边，紫边是指在高反差区域出现的紫色带状边缘现象，紫边中的紫色并非物体本身的颜色，而是由于镜头色散或颜色插值等导致的。可以理解，使用更好的镜头在一定程度上能够缓解由于镜头色散造成的紫边，但是价格昂贵，且不能完全解决紫边现象，所以就需要使用图像校正方法来消除紫边，提升图像质量。示例性地，计算机设备可以遍历待校正图像中的各像素，将遍历至的像素确定为目标像素。各尺度下的检测结果包括每个预设尺度下的检测结果。根据每个预设尺度和目标像素在待校正图像中的位置确定该预设尺度下的检测范围。基于预设尺度下的检测范围内各像素的像素值的离散程度确定该预设尺度下的检测结果。在一些实施例中，计算机设备可以基于预设尺度下的检测范围内各像素值的标准差确定该预设尺度下的检测结果。可以理解，各像素的像素值之间的标准差用于表征预设尺度下的检测范围内的离散程度。在一些实施例中，计算机设备可以基于预设尺度下的检测范围内各像素值的方差确定该预设尺度下的检测结果。在一些实施例中，计算机设备可以包括终端或服务器中的至少一种。终端可以但不限于是各种个人计算机、笔记本电脑、智能手机、平板电脑、物联网设备和便携式可穿戴设备，物联网设备可为智能音箱、智能电视、智能空调、智能车载设备等。便携式可穿戴设备可为智能手表、智能手环、头戴设备等。服务器可以用独立的服务器或者是多个服务器组成的服务器集群来实现。步骤104，基于各尺度下的检测结果确定目标像素对应的离散程度。其中，目标像素对应的离散程度用于表征目标像素所处图像区域的反差情况。示例性地，计算机设备可以对各尺度下的检测结果进行合并得到目标像素对应的离散程度。在一些实施例中，计算机设备可以对各尺度下的检测结果进行加权融合，得到目标像素对应的离散程度。在一些实施例中，计算机设备可以对各尺度下的检测结果进行加权求和，得到目标像素对应的离散程度。在一些实施例中，计算机设备可以将各尺度下的检测结果的中位数或均值等确定为目标像素对应的离散程度。步骤106，对目标像素进行色彩失真评估，得到目标像素对应的失真程度。示例性地，计算机设备可以根据目标像素的各颜色分量值之间的差异，对目标像素进行色彩失真评估，得到目标像素对应的失真程度。在一些实施例中，待校正图像中包括呈现出目标颜色的色彩失真区域。可以理解，色彩失真区域内的色彩失真像素表现为目标颜色，即，色彩失真像素的像素值表征的颜色是目标颜色。计算机设备可以通过比对目标颜色与目标像素的像素值表征的颜色，对目标像素进行色彩失真评估，得到目标像素对应的失真程度。比如，计算机设备可以将目标像素的像素值与目标颜色对应的像素值进行比对，得到失真程度。计算机设备也可以基于目标像素的像素值确定目标像素的色调值，根据目标像素的色调值确定目标像素是否呈现出目标颜色，得到失真程度。在一些实施例中，计算机设备可以确定根据目标颜色的特性构建的失真评估函数。根据失真评估函数对目标像素进行色彩失真评估，得到目标像素对应的失真程度。步骤108，基于目标像素对应的离散程度和失真程度确定出待校正图像中的色彩失真像素。示例性地，计算机设备可以根据目标像素对应的离散程度和失真程度确定该目标像素是否为色彩失真像素，从而确定出待校正图像中的色彩失真像素。在一些实施例中，在目标像素对应的离散程度大于预设反差阈值的情况下，目标像素处于高反差区域。在目标像素对应的失真程度大于预设失真阈值的情况下，目标像素呈现出目标颜色。对于处于高反差区域且呈现出目标颜色的目标像素可以认为是色彩失真像素。在一些实施例中，计算机设备可以根据目标像素的色调值从高反差区域中提取出目标颜色区域，分析目标颜色区域内的梯度变化，将梯度大小突然增加或方向突然变化的位置处的像素作为色彩失真像素。可以理解，对于紫边这一色彩失真现象，可以先通过对图像的高反差区域进行检测，来锁定紫边可能出现的区域，并通过对紫色区域的梯度变化进行分析，可以有效的避免对紫色物体的误检，准确地确定出色彩失真像素。在一些实施例中，计算机设备可以使用目标像素对应的离散程度对该目标像素对应的失真程度进行加权，得到目标像素对应的失真加权结果。在失真加权结果满足色彩失真条件的情况下，确定该目标像素为色彩失真像素。色彩失真条件可以是失真加权结果大于色彩失真阈值，也可以是失真加权结果处于色彩失真范围等。步骤110，对色彩失真像素的像素值进行校正，得到校正后的目标图像。可以理解，在待校正图像中每个色彩失真像素被校正后，得到了目标图像。示例性地，计算机设备可以对色彩失真像素的像素值进行饱和度消除，得到校正后的目标图像。比如，基于色彩失真像素的像素值确定色彩失真像素的饱和度值，直接降低饱和度值，实现饱和度消除。在一些实施例中，计算机设备也可以对色彩失真像素的像素值进行颜色插值，得到校正后的目标图像。上述图像校正方法中，针对待校正图像中的每个目标像素，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果；综合各尺度下的检测结果能够准确地确定目标像素对应的离散程度，目标像素对应的离散程度能够准确地表征目标像素是否处于高反差区域，离散程度越大则反差越大，而色彩失真现象往往出现在高反差区域；对目标像素进行色彩失真评估，得到目标像素对应的失真程度；处于高反差区域且失真程度高的目标像素往往是色彩失真像素，基于目标像素对应的离散程度和失真程度能够准确地确定出待校正图像中的色彩失真像素；进而能够精准地对色彩失真像素的像素值进行校正，得到校正后的目标图像，提高图像校正的准确性。在一些实施例中，如图2所示，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果包括步骤202至步骤206。步骤202，基于待校正图像中各像素的像素值确定每个像素的亮度值。示例性地，计算机设备可以对每个像素的各个颜色分量值进行加权求和，得到该像素的亮度值。可以理解，每个颜色分量对应的权重可以是一致的也可以是不一致的。比如，像素的亮度值可以但不限于是多个颜色分量值的均值。在一些实施例中，每个像素的像素值包括第一分量值、第二分量值和第三分量值。第一分量值、第二分量值和第三分量值分别对应不同的颜色通道。像素的亮度值可以是该像素的第一分量值、第二分量值与第三分量值的均值。比如，第一分量值、第二分量值和第三分量值分别对应红色通道、绿色通道和蓝色通道，即，像素值实际是RGB值。对于待校正图像中处于位置处的像素，其亮度值I=/3。R、G和B分别代表第一分量值、第二分量值和第三分量值。步骤204，根据每个预设尺度和目标像素在待校正图像中的位置确定预设尺度下的检测范围。其中，不同预设尺度对应不同尺寸的窗口。将目标像素的位置作为每个预设尺寸对应窗口的中心，即可得到该预设尺度下的检测范围。由于图像是二维数据，故而每个预设尺度对应窗口的长和宽可以都是该预设尺度，即，每个预设尺度对应窗口的尺寸是该预设尺度的平方。比如，预设尺度为2k+1时，相应的窗口尺寸为×，对于处于位置处的像素，即，横向位置为x且纵向位置为y的像素，检测范围是x-k至x+k且y-k至y+k。示例性地，如表1所示，提供了对于 位置处的像素，预设尺度为5时检测范围。表1：。可以理解，对于处于位置处的像素，计算预设尺度为5时的离散程度，需要的亮度值包括I至I。步骤206，基于预设尺度下的检测范围内各像素的亮度值的离散程度确定预设尺度下的检测结果。可以理解，数据方差能够表征数据的离散程度。计算机设备可以通过计算预设尺度下的检测范围内各像素的亮度值的方差确定预设尺度下的检测结果。示例性地，预设尺度下的检测结果包括目标像素在预设尺度下对应的离散程度。对于处于位置处的像素，公式为预设尺度为2k+1时离散程度的计算公式。。其中，VLk代表对于处于位置处的像素，预设尺度为2k+1时的离散程度。I是该像素的亮度值。AvgL是预设尺度为2k+1时的检测范围内各像素亮度值的平均数。公式为预设尺度2k+1下的平均数的计算公式。。其中，AvgL是预设尺度2k+1下的平均数。在一些实施例中，预设尺度可以包括7、5以及3。对于位置处的像素，检测范围分别是x-1至x+1且y-1至y+1、x-2至x+2且y-2至y+2、x-3至x+3且y-3至y+3。本实施例中，基于待校正图像中各像素的像素值确定每个像素的亮度值；基于预设尺度下的检测范围内各像素的亮度值的离散程度确定预设尺度下的检测结果，能够准确地确定出目标像素的不同预设尺度下的亮度反差情况。在一些实施例中，基于各尺度下的检测结果确定目标像素对应的离散程度，包括：根据各尺度下的检测结果的乘积确定目标像素对应的离散程度。示例性地，计算机设备可以将各尺度下的检测结果的乘积作为目标像素对应的离散程度。比如，预设尺度包括7、5以及2，此时，目标像素对应的离散程度VL= VL7×VL5 × VL2。本实施例中，根据各尺度下的检测结果的乘积确定目标像素对应的离散程度，能够准确地确定出目标像素的位置处的亮度反差情况，进而后续准确地能够针对高反差区域的色彩失真像素进行校正。在一些实施例中，像素值包括各个颜色分量值；色彩失真像素呈现出目标颜色；如图3所示，对目标像素进行色彩失真评估，得到目标像素对应的失真程度，包括步骤302至步骤304。步骤302，确定目标像素的各个颜色分量值两两之间的颜色差值。示例性地，计算机设备可以确定目标像素的第一分量值与第二分量值之间的第一差值、第三分量值与第二分量值之间的第二差值以及第三分量值与第一分量值之间的第三差值。示例性地，对于处于位置处的目标像素，第一分量值为r、第二分量值为g、第三分量值为b。公式可以分别是第一差值、第二差值以及第三差值的计算公式。rg_diff = r- g bg_diff= b- g br_diff= b- r 其中，rg_diff代表第一差值。bg_diff代表第二差值。br_diff代表第三差值。需要说明的是，第一差值、第二差值以及第三差值的计算方式不限于公式。比如，第一差值也可以是第二分量值减去第一分量值、第二差值也可以是第二分量值减去第三分量值、第三差值也可以是第一分量值减去第三分量值。步骤304，根据颜色差值和失真评估函数对目标像素进行色彩失真评估，得到目标像素对应的失真程度；其中，失真评估函数是基于目标颜色对应的颜色分量关系构建的；失真程度与目标像素呈现出的目标颜色的强度相匹配。可以理解，目标颜色对应一个像素值范围。像素值处于上述像素值范围内的像素呈现出目标颜色。如果要呈现出一种颜色，像素的各个分量要满足一定的大小关系。目标颜色对应的颜色分量关系用于指示呈现出目标颜色的像素的各个分量之间的大小关系。比如，对于图像紫边中的像素，一般为B＞R＞G，这就是一种颜色分量关系。失真评估函数描述的函数关系与目标颜色对应的颜色分量关系是相匹配的。失真程度可以表征目标像素呈现出目标颜色的强度。可以理解，只要失真程度不为零，目标像素就具备一定程度的目标颜色的色彩特性，失真程度越大，在一些实施例中，目标颜色的色彩特性，一般可以但不限于为第三分量＞第一分量＞第二分量，但是在少数情况下，会存在相反的情况，故而可以采用各颜色分量之间互相做约束，来圈定一个失真范围。失真评估函数描述的函数关系可以是在这个失真范围内认为目标像素对应的失真程度与目标像素中各分量的大小关系相对颜色分量关系的偏离程度负相关，超出这个范围则认为失真程度为0，目标像素中各分量的大小关系满足颜色分量关系则认为失真程度为1。在一些实施例中，颜色差值包括第一差值、第二差值和第三差值。根据第一差值和失真评估函数可以确定第一失真程度。根据第二差值和失真评估函数可以确定第二失真程度。根据第三差值和失真评估函数可以确定第三失真程度。基于第一失真程度、第二失真程度和第三失真程度确定目标像素对应的失真程度。本实施例中，确定目标像素的各个颜色分量值两两之间的颜色差值；根据颜色差值和失真评估函数对目标像素进行色彩失真评估，得到目标像素对应的失真程度，进而后续准确地能够针对呈现出目标颜色的色彩失真像素进行校正。在一些实施例中，目标像素的各个颜色分量值包括第一分量值、第二分量值和第三分量值；颜色差值包括第一色差值、第二色差值和第三色差值；第一色差值是第一分量值减去第二分量值得到的；第二色差值是第三分量值减去第二分量值得到的；第三色差值是第三分量值减去第二分量值得到的；目标颜色对应的颜色分量关系包括第三分量下的值大于第一分量下的值且第一分量下的值大于第二分量下的值；失真评估函数用于表征在输入色差值大于零的情况下输出失真程度为预设最大失真程度以及在输入色差值不大于零且大于预设调整参数的情况下输出失真程度与输入色差值正相关。可以理解，目标颜色对应的颜色分量关系一般情况下是第三分量＞第一分量＞第二分量，满足第三分量＞第一分量＞第二分量这一关系的输入色差值相应的输出失真程度为预设最大失真程度，对于处于预设调整参数至零这个区间内的输入色差值相应的输出失真程度随着相对第三分量＞第一分量＞第二分量这一关系的偏离程度的降低而降低。如果说满足第三分量＞第一分量＞第二分量这一关系的输入色差值相应的输出失真程度为1的话，那么处于预设调整参数至零这个区间内的输入色差值相应的输出失真程度则出入0至1中间。对于超出预设调整参数至零这个区间、不满足第三分量＞第一分量＞第二分量这一关系的输入色差值相应的输出失真程度为0，此时认为不失真。如图4所示，根据颜色差值和失真评估函数对目标像素进行色彩失真评估，得到目标像素对应的失真程度，包括步骤402至步骤404。步骤402，分别将第一色差值、第二色差值和第三色差值作为失真评估函数的输入，得到失真评估函数输出的第一失真程度、第二失真程度和第三失真程度。示例性地，如公式分别是在输入色差值为第一色差值、第二色差值和第三色差值时失真评估函数。其中，当输入是第一色差值rg_diff时输出的失真程度prg为第一失真程度。其中，当输入是第二色差值bg_diff时输出的失真程度pbg为第二失真程度。其中，当输入是第三色差值br_diff时输出的失真程度pbr为第三失真程度。步骤404，对第一失真程度、第二失真程度和第三失真程度进行合并，得到目标像素对应的失真程度。示例性地，计算机设备可以基于第一失真程度、第二失真程度和第三失真程度的乘积确定目标像素对应的失真程度。在一些实施例中，公式为失真程度的计算公式。p_map=prg×pbg×pbr其中，p_map表征失真程度。prg为第一失真程度。pbg为第二失真程度。pbr为第三失真程度。在一些实施例中，计算机设备可以从第一失真程度、第二失真程度和第三失真程度中选择出目标像素对应的失真程度。也可以对第一失真程度、第二失真程度和第三失真程度进行加权融合得到目标像素对应的失真程度。本实施例中，分别将第一色差值、第二色差值和第三色差值作为失真评估函数的输入，得到失真评估函数输出的第一失真程度、第二失真程度和第三失真程度；对第一失真程度、第二失真程度和第三失真程度进行合并，得到目标像素对应的失真程度，失真程度能够表征目标像素呈现出目标颜色的强度，进而后续准确地能够针对呈现出目标颜色的色彩失真像素进行校正。在一些实施例中，计算机设备可以基于目标像素对应的离散程度和失真程度的乘积确定目标像素是否为色彩失真像素。假设 位置处的目标像素对应的失真程度为p_map，离散程度为VL，则二者的乘积即失真加权结果pe_map= p_map× VL。pe_map能够表征目标像素是否处于高反差区域且呈现出目标颜色，pe_map越大目标像素为色彩失真像素的可能性越大，pe_map满足色彩失真条件的情况下认为目标像素为色彩失真像素。在一些实施例中，色彩失真像素的像素值中目标分量值偏离真实值。可以理解，色彩失真现象表现为颜色分量的不准确或失真，对于色彩失真像素来说，存在至少一个颜色分量是不可信的。比如，对于紫边这一色彩失真现象，蓝色通道下的分量值是不可信的，此时蓝色分量值就是偏离真实值的目标分量值。如图5所示，对色彩失真像素的像素值进行校正，得到校正后的目标图像，包括步骤502至步骤504。步骤502，对色彩失真像素的非目标分量值进行转换处理，得到灰度值。其中，非目标分量值是指色彩失真像素的像素值中除了目标分量值外的剩余的颜色分量值。示例性地，计算机设备可以将色彩失真像素在色彩空间中的非目标分量值转换成灰度空间中的灰度值。比如，计算机设备可以将各个非目标分量值的平均值作为灰度值。假设色彩失真像素是紫边区域内的像素，目标分量值是指蓝色通道下的分量值，对于位置处的色彩失真像素，灰度值L=+G)/2，R代表红色通道下的分量值，G代表绿色通道下的分量值。步骤504，根据预设衰减强度、色彩失真像素对应的失真程度和离散程度，将色彩失真像素的像素值与灰度值进行加权融合，得到校正后的目标图像。示例性地，计算机设备可以使用色彩失真像素对应的失真程度和离散程度对预设衰减强度进行加权得到灰度值对应的第一权重。将基于第一权重确定像素值对应的第二权重。分别使用第一权重和第二权重对灰度值和像素值进行加权后进行求和，得到被校正后的像素值。目标图像包括被校正后的像素值。可以理解，上述过程其实是通过在色彩空间和灰度空间这两个空间中进行线性插值，对像素值进行校正。在一些实施例中，计算机设备可以使用目标像素对应的离散程度对该目标像素对应的失真程度进行加权，得到目标像素对应的失真加权结果。再使用目标像素对应的失真加权结果对灰度值进行加权得到第一权重。在一些实施例中，计算机设备可以分别使用第一权重和第二权重对灰度值和第一分量值进行加权后进行求和，得到被校正后的第一分量值。分别使用第一权重和第二权重对灰度值和第二分量值进行加权后进行求和，得到被校正后的第二分量值。分别使用第一权重和第二权重对灰度值和第三分量值进行加权后进行求和，得到被校正后的第三分量值。在一些实施例中，第一权重与第二权重的总和为单位权重。比如，第一权重+第二权重=1。可以理解，计算机设备可以根据单位权重与第一权重的差值确定第二权重。在一些实施例中，公式分别是对于位置处的色彩失真像素，校正第一分量、第二分量值和第三分量值的计算公式。R’=)× R+ L× Gain×pe_map其中，R是色彩失真像素的蓝色通道下的分量值。R’是校正后的蓝色通道下的分量值。L是灰度值。Gain是预设衰减强度。pe_map是色彩失真像素对应的失真加权结果。G’= )× G+ L× Gain×pe_map其中，G是色彩失真像素的蓝色通道下的分量值。G’是校正后的蓝色通道下的分量值。L是灰度值。Gain是预设衰减强度。pe_map是色彩失真像素对应的失真加权结果。B’= )× B+ L× Gain×pe_map其中，B是色彩失真像素的蓝色通道下的分量值。B’是校正后的蓝色通道下的分量值。L是灰度值。Gain是预设衰减强度。pe_map是色彩失真像素对应的失真加权结果。本实施例中，通过对色彩失真像素的非目标分量值进行转换处理，得到灰度值；根据预设衰减强度、色彩失真像素对应的失真程度和离散程度，将色彩失真像素的像素值与灰度值进行加权融合，得到校正后的目标图像，能够实现对色彩失真像素的饱和度消除，准确地对色彩失真像素进行校正。在一些实施例中，如图6所示，对色彩失真像素的像素值进行校正，得到校正后的目标图像，包括步骤602至步骤604。步骤602，根据色彩失真像素与每个非色彩失真像素间的距离，从各个非色彩失真像素中确定出参考像素。示例性地，非色彩失真像素未呈现出目标颜色，相应的失真程度为零。在色彩失真像素的预设范围内选择与色彩失真像素距离最近的非色彩失真像素，将其作为参考像素。在一些实施例中，计算机设备可以在色彩失真像素的预设范围内选择与色彩失真像素的欧式距离最小的非色彩失真像素，得到参考像素。在一些实施例中，非色彩失真像素也可以是指待校正图像中除色彩失真像素外的剩余像素。在一些实施例中，在色彩失真像素的预设范围内不存在非色彩失真像素的情况下，通过对色彩失真像素的非目标分量值进行转换处理，得到灰度值；根据预设衰减强度、色彩失真像素对应的失真程度和离散程度，将色彩失真像素的像素值与灰度值进行加权融合，得到校正后的像素值。步骤604，根据参考像素的像素值对色彩失真像素的像素值进行校正，得到校正后的目标图像。示例性地，计算机设备可以将参考像素的各个颜色分量值的均值与色彩失真像素的各非目标分量值的均值之间的比值作为第三权重，使用第三权重对参考像素的各个颜色分量值分别进行加权，得到校正后的像素值。在一些实施例中，如表2所示，提供了对于 位置处的色彩失真像素，预设范围内的像素分别对应的失真程度。表2：。其中，与色彩失真像素距离最近的参考像素是位置处的非色彩失真像素，那么公式分别是对于位置处的色彩失真像素，校正第一分量、第二分量值和第三分量值的计算公式。其中，R是色彩失真像素的红色通道下的第一分量值。G是色彩失真像素的绿色通道下的第二分量值。B是色彩失真像素的蓝色通道下的第三分量值。R是参考像素的红色通道下的第一分量值。G是参考像素的绿色通道下的第二分量值。B是参考像素的蓝色通道下的第三分量值。本实施例中，根据色彩失真像素与每个非色彩失真像素间的距离，从各个非色彩失真像素中确定出参考像素；根据参考像素的像素值对色彩失真像素的像素值进行校正，得到校正后的目标图像，能够准确地实现图像校正。应该理解的是，虽然如上所述的各实施例所涉及的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，如上所述的各实施例所涉及的流程图中的至少一部分步骤可以包括多个步骤或者多个阶段，这些步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤中的步骤或者阶段的至少一部分轮流或者交替地执行。基于同样的发明构思，本申请实施例还提供了一种用于实现上述所涉及的图像校正方法的图像校正装置。该装置所提供的解决问题的实现方案与上述方法中所记载的实现方案相似，故下面所提供的一个或多个图像校正装置实施例中的具体限定可以参见上文中对于图像校正方法的限定，在此不再赘述。在一个示例性的实施例中，如图7所示，提供了一种图像校正装置，包括：检测模块702、第一确定模块704、评估模块706、第二确定模块708和校正模块710，其中：检测模块702，用于针对待校正图像中的每个目标像素，基于待校正图像中各像素的像素值对目标像素进行多尺度的离散程度检测，得到各尺度下的检测结果。第一确定模块704，用于基于各尺度下的检测结果确定目标像素对应的离散程度。评估模块706，用于对目标像素进行色彩失真评估，得到目标像素对应的失真程度。第二确定模块708，用于基于目标像素对应的离散程度和失真程度确定出待校正图像中的色彩失真像素。校正模块710，用于对色彩失真像素的像素值进行校正，得到校正后的目标图像。在一些实施例中，检测模块702，用于基于待校正图像中各像素的像素值确定每个像素的亮度值；根据每个预设尺度和目标像素在待校正图像中的位置确定预设尺度下的检测范围；基于预设尺度下的检测范围内各像素的亮度值的离散程度确定预设尺度下的检测结果。在一些实施例中，第一确定模块704，用于根据各尺度下的检测结果的乘积确定目标像素对应的离散程度。在一些实施例中，像素值包括各个颜色分量值；色彩失真像素呈现出目标颜色；评估模块706，用于确定目标像素的各个颜色分量值两两之间的颜色差值；根据颜色差值和失真评估函数对目标像素进行色彩失真评估，得到目标像素对应的失真程度；其中，失真评估函数是基于目标颜色对应的颜色分量关系构建的；失真程度与目标像素呈现出的目标颜色的强度相匹配。在一些实施例中，目标像素的各个颜色分量值包括第一分量值、第二分量值和第三分量值；颜色差值包括第一色差值、第二色差值和第三色差值；第一色差值是第一分量值减去第二分量值得到的；第二色差值是第三分量值减去第二分量值得到的；第三色差值是第三分量值减去第二分量值得到的；目标颜色对应的颜色分量关系包括第三分量下的值大于第一分量下的值且第一分量下的值大于第二分量下的值；失真评估函数用于表征在输入色差值大于零的情况下输出失真程度为预设最大失真程度以及在输入色差值不大于零且大于预设调整参数的情况下输出失真程度与输入色差值正相关；评估模块706，用于分别将第一色差值、第二色差值和第三色差值作为失真评估函数的输入，得到失真评估函数输出的第一失真程度、第二失真程度和第三失真程度；对第一失真程度、第二失真程度和第三失真程度进行合并，得到目标像素对应的失真程度。在一些实施例中，色彩失真像素的像素值中目标分量值偏离真实值；校正模块710，用于对色彩失真像素的非目标分量值进行转换处理，得到灰度值；根据预设衰减强度、色彩失真像素对应的失真程度和离散程度，将色彩失真像素的像素值与灰度值进行加权融合，得到校正后的目标图像。在一些实施例中，校正模块710，用于根据色彩失真像素与每个非色彩失真像素间的距离，从各个非色彩失真像素中确定出参考像素；根据参考像素的像素值对色彩失真像素的像素值进行校正，得到校正后的目标图像。上述图像校正装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。在一个示例性的实施例中，提供了一种计算机设备，该计算机设备可以是服务器，其内部结构图可以如图8所示。该计算机设备包括处理器、存储器、输入/输出接口(Input/Output，简称I/O）和通信接口。其中，处理器、存储器和输入/输出接口通过系统总线连接，通信接口通过输入/输出接口连接到系统总线。其中，该计算机设备的处理器用于提供计算和控制能力。该计算机设备的存储器包括非易失性存储介质和内存储器。该非易失性存储介质存储有操作系统、计算机程序和数据库。该内存储器为非易失性存储介质中的操作系统和计算机程序的运行提供环境。该计算机设备的数据库用于存储待校正图像。该计算机设备的输入/输出接口用于处理器与外部设备之间交换信息。该计算机设备的通信接口用于与外部的终端通过网络连接通信。该计算机程序被处理器执行时以实现一种图像校正方法。在一个示例性的实施例中，提供了一种计算机设备，该计算机设备可以是终端，其内部结构图可以如图9所示。该计算机设备包括处理器、存储器、输入/输出接口、通信接口、显示单元和输入装置。其中，处理器、存储器和输入/输出接口通过系统总线连接，通信接口、显示单元和输入装置通过输入/输出接口连接到系统总线。其中，该计算机设备的处理器用于提供计算和控制能力。该计算机设备的存储器包括非易失性存储介质和内存储器。该非易失性存储介质存储有操作系统和计算机程序。该内存储器为非易失性存储介质中的操作系统和计算机程序的运行提供环境。该计算机设备的输入/输出接口用于处理器与外部设备之间交换信息。该计算机设备的通信接口用于与外部的终端进行有线或无线方式的通信，无线方式可通过WIFI、移动蜂窝网络、NFC或其他技术实现。该计算机程序被处理器执行时以实现一种图像校正方法。该计算机设备的显示单元用于形成视觉可见的画面，可以是显示屏、投影装置或虚拟现实成像装置。显示屏可以是液晶显示屏或者电子墨水显示屏，该计算机设备的输入装置可以是显示屏上覆盖的触摸层，也可以是计算机设备外壳上设置的按键、轨迹球或触控板，还可以是外接的键盘、触控板或鼠标等。本领域技术人员可以理解，图8或图9中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备的限定，具体的计算机设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。在一个示例性的实施例中，提供了一种计算机设备，包括存储器和处理器，存储器中存储有计算机程序，该处理器执行计算机程序时实现上述各方法实施例中的步骤。在一个实施例中，提供了一种计算机可读存储介质，其上存储有计算机程序，计算机程序被处理器执行时实现上述各方法实施例中的步骤。在一个实施例中，提供了一种计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现上述各方法实施例中的步骤。需要说明的是，本申请所涉及的用户信息和数据，均为经用户授权或者经过各方充分授权的信息和数据，且相关数据的收集、使用和处理需要符合相关规定。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一非易失性计算机可读取存储介质中，该计算机程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、数据库或其它介质的任何引用，均可包括非易失性和易失性存储器中的至少一种。非易失性存储器可包括只读存储器、磁带、软盘、闪存、光存储器、高密度嵌入式非易失性存储器、阻变存储器、磁变存储器、铁电存储器、相变存储器、石墨烯存储器等。易失性存储器可包括随机存取存储器或外部高速缓冲存储器等。作为说明而非局限，RAM可以是多种形式，比如静态随机存取存储器或动态随机存取存储器等。本申请所提供的各实施例中所涉及的数据库可包括关系型数据库和非关系型数据库中至少一种。非关系型数据库可包括基于区块链的分布式数据库等，不限于此。本申请所提供的各实施例中所涉及的处理器可为通用处理器、中央处理器、图形处理器、数字信号处理器、可编程逻辑器、基于量子计算的数据处理逻辑器等，不限于此。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对本申请专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请的保护范围应以所附权利要求为准。
