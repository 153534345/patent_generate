标题title
一种切片中药的烘焙质量评价方法
摘要abst
本发明涉及图像数据处理技术领域，具体涉及一种切片中药的烘焙质量评价方法，包括：通过获取切片中药图像、利用不同方法对切片中药图像进行超像素分割获得若干超像素图像，然后对超像素区域进行合并获得第一超像素图像，并最终根据烘焙质量系数的大小对切片中药的烘焙质量进行评价。本发明通过对多种超像素分割方法得到的超像素区域进行迭代合并处理，提高了在对切片中药图像进行超像素分割的边界回归率，提高了切片中药边缘的检测准确性，进一步提高了切片中药的整体烘焙质量。
权利要求书clms
1.一种切片中药的烘焙质量评价方法，其特征在于，该方法包括以下步骤：获取切片中药图像；利用不同方法对切片中药图像超像素分割获得若干超像素图像，一个超像素图像包括若干超像素区域，将超像素区域的区域边缘处对应的像素点记为超像素区域的边界点，将超像素图像中相邻两个超像素区域之间共有的边界点形成的线段，记为所述两个超像素区域的公共边界线，获取切片中药图像中的边缘像素点以及任意像素点的梯度幅值，根据切片中药图像中边缘像素点的数量、像素点的梯度幅值以及像素点在同位置下所有超像素图像中对应边界点的数量获得公共边界线的边界系数，所述公共边界线的边界系数用于描述公共边界线可以作为切片中药实际边缘的概率；根据边界系数与预设的边界系数阈值的大小关系对超像素图像中的超像素区域进行合并，获得第一超像素图像，将第一超像素图像中的超像素区域记为第一超像素区域；将第一超像素图像中的第一超像素区域的面积和边界点的曲率进行融合获得第一超像素区域的轮廓参数，根据第一超像素区域中像素点的灰度分布情况获得第一超像素区域之间的相似参数；对边界系数阈值进行迭代，利用第一超像素区域之间在轮廓参数和相似参数分别对应的差异，对第一超像素图像中轮廓参数和相似参数的分布情况进行加权，构建第一超像素图像的目标函数，根据目标函数的输出值的大小获得烘焙质量系数；根据烘焙质量系数的大小对切片中药的烘焙质量进行评价。2.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述用不同方法对切片中药图像超像素分割获得若干超像素图像，包括的具体方法为：利用个不同的超像素分割算法分别对切片中药图像进行超像素分割，获得对应的超像素分割结果图像，记为超像素图像，一个超像素分割算法对应一个超像素图像，其中/＞为预设的超参数。3.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述获取切片中药图像中的边缘像素点以及任意像素点的梯度幅值，根据切片中药图像中边缘像素点的数量、像素点的梯度幅值以及像素点在同位置下所有超像素图像中对应边界点的数量获得公共边界线的边界系数，包括的具体方法为：同位置下，切片中药图像中一个像素点在所有超像素图像中对应若干个边界点，将切片中药图像中任意像素点在所有超像素图像中对应边界点的数量，记为所述像素点的边界因子；利用Sobel算子获取切片中药图像中的边缘像素点以及切片中药图像中任意像素点的梯度幅值，预设超参数作为切片中药图像中像素点的边缘因子，将切片中药图像中像素点为边缘像素点时像素点的边缘因子记为数值/＞，将切片中药图像中像素点不为边缘像素点时，像素点的边缘因子记为/＞，其中/＞；在任意超像素图像中，将任意相邻的两个超像素区域之间共有的边界点记为所述两个超像素区域的公共边界点；获取任意相邻的两个超像素区域的公共边界线的边界系数，具体计算方法为：其中，表示公共边界线的边界系数；/＞表示公共边界线包括的公共边界点的数量；/＞表示公共边界线对应所有公共边界点在切片中药图像中对应边缘像素点的数量；/＞表示公共边界线的第/＞个公共边界点在切片中药图像中对应像素点的边缘因子；/＞表示公共边界线的第/＞个公共边界点在切片中药图像中对应像素点的梯度幅值；/＞表示公共边界线的第/＞个公共边界点在切片中药图像中对应像素点的边界因子；/＞表示线性归一化函数；/＞表示以自然常数为底数的指数函数。4.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述根据边界系数与预设的边界系数阈值的大小关系对超像素图像中的超像素区域进行合并，获得第一超像素图像，包括的具体方法为：预设在区间内从小到大迭代的边界系数阈值，预设迭代步长为/＞，当公共边界线的边界系数小于边界系数阈值时，将公共边界线对应的两个超像素区域合并，将超像素区域合并后得到的超像素图像记为第一超像素图像，获得每个超像素图像对应的第一超像素图像，将第一超像素图像中的超像素区域记为第一超像素区域。5.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述将第一超像素图像中的第一超像素区域的面积和边界点的曲率进行融合获得第一超像素区域的轮廓参数，包括的具体方法为：获取任意第一超像素区域的面积以及第一超像素区域的每个边界点的曲率；将所有第一超像素区域的所有边界点的平均曲率记为第一均值；将第一超像素区域的最小曲率与第一均值的差值绝对值记为第一差值；将第一超像素区域的最大曲率与第一均值的差值绝对值记为第二差值；将第一差值和第二差值的比值记为曲率因子，将/＞记为第一超像素区域的轮廓参数，其中/＞表示第一超像素区域的面积；/＞表示第一超像素区域的最小外接矩形的面积；/＞表示圆周率。6.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述根据第一超像素区域中像素点的灰度分布情况获得第一超像素区域之间的相似参数，包括的具体方法为：获取任意第一超像素图像中每个第一超像素区域在0°、45°、90度以及135°方向上的灰度共生矩阵，根据每个方向对应灰度共生矩阵获得第一超像素区域的小梯度优势、相关性、混合熵以及差分矩，将小梯度优势、相关性、混合熵以及差分矩统称为第一超像素区域的纹理参数；将第一超像素区域的所有纹理参数形成的向量记为第一超像素区域的纹理向量，获取任意第一超像素图像中任意两个第一超像素区域对应纹理向量之间的余弦相似度，记为所述两个第一超像素区域之间的相似参数。7.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述对边界系数阈值进行迭代，利用第一超像素区域之间在轮廓参数和相似参数分别对应的差异，对第一超像素图像中轮廓参数和相似参数的分布情况进行加权，构建第一超像素图像的目标函数，包括的具体方法为：获取边界系数阈值迭代过程中任意超像素图像在对应边界系数阈值下的第一超像素图像；根据第一超像素区域之间在轮廓参数和相似参数分别对应的差异，获得超像素图像在对应边界系数阈值下，第一超像素图像的轮廓权重系数和相似权重系数；构建第一超像素图像的目标函数：其中，表示超像素图像的目标函数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的平均轮廓参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的平均相似参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的轮廓参数的标准差；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的相似参数的标准差；/＞表示边界系数阈值；/＞表示自然常数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像的轮廓权重系数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像的相似权重系数。8.根据权利要求7所述一种切片中药的烘焙质量评价方法，其特征在于，所述根据第一超像素区域之间在轮廓参数和相似参数分别对应的差异，获得超像素图像在对应边界系数阈值下，第一超像素图像的轮廓权重系数和相似权重系数，包括的具体方法为：将超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的平均轮廓参数记为第二均值；将超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的平均相似参数记为第三均值；将超像素图像在对应边界系数阈值下的第一超像素图像中，任意第一超像素区域的轮廓参数与第二均值的差值绝对值记为第一超像素区域的第三差值；将超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的任意相似参数与第三均值的差值绝对值记为第一超像素区域之间的第四差值；将记为第一超像素图像的轮廓权重系数，将/＞记为第一超像素图像的相似权重系数，其中/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中第一超像素区域的数量；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间相似参数的数量；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，第/＞个第一超像素区域的第三差值；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的第/＞个第四差值；表示以自然常数为底数的指数函数。9.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述根据目标函数的输出值的大小获得烘焙质量系数，包括的具体方法为：边界系数阈值在迭代过程中，当超像素图像的目标函数的输出值最大时，将超像素图像在对应边界系数阈值下的第一超像素图像记为超像素图像的第二超像素图像，将第二超像素图像中的超像素区域记为第二超像素区域；获取切片中药图像中任意像素点在所有第二超像素图像下对应的边界因子记为像素点的最终边界因子，将所有第二超像素图像的数量记为图像数量参数，将像素点的最终边界因子与图像数量参数的比值记为像素点的边界投票概率，将切片中药图像中所有边界投票概率大于概率阈值的像素点记为最终边界点，将由切片中药图像中所有最终边界点形成的图像作为切片中药图像的最终超像素分割图像，将最终超像素分割图像中最终边界点形成的超像素区域记为最终超像素区域，其中概率阈值/＞为预设的超参数；对烘焙后的同一批中药切片进行多次翻动，采集翻动后的切片中药图像，获得个切片中药图像，并获取每个切片中药图像的最终超像素分割图像，将最终超像素分割图像中的超像素区域记为最终超像素区域；将切片中药图像对应最终超像素分割图像中轮廓参数的最终超像素区域记为中药切面区域，将任意中药切面区域内所有像素点的平均灰度记为中药切面区域的灰度参数，将切片中药图像中所有中药切面区域的平均灰度参数记为切片中药图像的灰度因子，将切片中药图像中所有中药切面区域的灰度参数的标准差记为切片中药图像的第一均匀因子，将所有切片中药图像的灰度因子的标准差记为第二均匀因子，其中/＞为预设的超参数；获取烘焙质量系数，具体计算方法为：其中，表示烘焙质量系数；/＞表示sigmiod归一化函数；/＞表示切片中药图像的数量；/＞表示第/＞个切片中药图像的第一均匀因子；/＞表示第/＞个切片中药图像的灰度因子；/＞表示第二均匀因子。10.根据权利要求1所述一种切片中药的烘焙质量评价方法，其特征在于，所述根据烘焙质量系数的大小对切片中药的烘焙质量进行评价，包括的具体方法为：当烘焙质量系数位于区间时切片中药的烘焙质量合格，当烘焙质量系数位于区间和/＞内时切片中药的烘焙质量不合格，其中/＞和/＞均为预设的超参数，将烘焙质量合格的切片中药进行包装，将烘焙质量系数位于区间/＞内的切片中药进行重新烘焙，直至对应的烘焙质量系数位于区间/＞内，将烘焙质量系数位于区间/＞内的切片中药进行销毁。
说明书desc
技术领域本发明涉及图像数据处理技术领域，具体涉及一种切片中药的烘焙质量评价方法。背景技术烘焙是中药材加工的重要环节之一，不同的烘焙程度对切片中药质量的影响不同，且不同的烘焙程度适用于不同的中药材和制剂，需要根据具体情况进行选择和调整。同时，为了确保切片中药的质量和安全性，应注意对中药材的烘焙过程进行控制和监测，避免过度烘焙或烘焙不足等情况的发生。目前，在对切片中药的烘焙质量进行监测评价过程中，通常使用图像处理技术进行烘焙质量评价，具体通过超像素分割算法对烘焙过程中的切片中药图像进行超像素分割，分析切片对应区域的烘焙程度，但是传统的超像素分割算法受参数影响较大，导致得到的超像素区域的边界召回率低，使得无法准确获取切片中药对应的区域，进一步导致对切片中药的烘焙质量评价结果准确性低，切片中药的烘焙质量无法有效保证。发明内容本发明提供一种切片中药的烘焙质量评价方法，以解决现有的问题。本发明的一种切片中药的烘焙质量评价方法采用如下技术方案：本发明一个实施例提供了一种切片中药的烘焙质量评价方法，该方法包括以下步骤：获取切片中药图像；利用不同方法对切片中药图像超像素分割获得若干超像素图像，一个超像素图像包括若干超像素区域，将超像素区域的区域边缘处对应的像素点记为超像素区域的边界点，将超像素图像中相邻两个超像素区域之间共有的边界点形成的线段，记为所述两个超像素区域的公共边界线，获取切片中药图像中的边缘像素点以及任意像素点的梯度幅值，根据切片中药图像中边缘像素点的数量、像素点的梯度幅值以及像素点在同位置下所有超像素图像中对应边界点的数量获得公共边界线的边界系数，所述公共边界线的边界系数用于描述公共边界线可以作为切片中药实际边缘的概率；根据边界系数与预设的边界系数阈值的大小关系对超像素图像中的超像素区域进行合并，获得第一超像素图像，将第一超像素图像中的超像素区域记为第一超像素区域；将第一超像素图像中的第一超像素区域的面积和边界点的曲率进行融合获得第一超像素区域的轮廓参数，根据第一超像素区域中像素点的灰度分布情况获得第一超像素区域之间的相似参数；对边界系数阈值进行迭代，利用第一超像素区域之间在轮廓参数和相似参数分别对应的差异，对第一超像素图像中轮廓参数和相似参数的分布情况进行加权，构建第一超像素图像的目标函数，根据目标函数的输出值的大小获得烘焙质量系数；根据烘焙质量系数的大小对切片中药的烘焙质量进行评价。进一步地，所述用不同方法对切片中药图像超像素分割获得若干超像素图像，包括的具体方法为：利用个不同的超像素分割算法分别对切片中药图像进行超像素分割，获得对应的超像素分割结果图像，记为超像素图像，一个超像素分割算法对应一个超像素图像，其中为预设的超参数。进一步地，所述获取切片中药图像中的边缘像素点以及任意像素点的梯度幅值，根据切片中药图像中边缘像素点的数量、像素点的梯度幅值以及像素点在同位置下所有超像素图像中对应边界点的数量获得公共边界线的边界系数，包括的具体方法为：同位置下，切片中药图像中一个像素点在所有超像素图像中对应若干个边界点，将切片中药图像中任意像素点在所有超像素图像中对应边界点的数量，记为所述像素点的边界因子；利用Sobel算子获取切片中药图像中的边缘像素点以及切片中药图像中任意像素点的梯度幅值，预设超参数作为切片中药图像中像素点的边缘因子，将切片中药图像中像素点为边缘像素点时像素点的边缘因子记为数值/＞，将切片中药图像中像素点不为边缘像素点时，像素点的边缘因子记为/＞，其中/＞；在任意超像素图像中，将任意相邻的两个超像素区域之间共有的边界点记为所述两个超像素区域的公共边界点；获取任意相邻的两个超像素区域的公共边界线的边界系数，具体计算方法为：其中，表示公共边界线的边界系数；/＞表示公共边界线包括的公共边界点的数量；/＞表示公共边界线对应所有公共边界点在切片中药图像中对应边缘像素点的数量；/＞表示公共边界线的第/＞个公共边界点在切片中药图像中对应像素点的边缘因子；/＞表示公共边界线的第/＞个公共边界点在切片中药图像中对应像素点的梯度幅值；/＞表示公共边界线的第个公共边界点在切片中药图像中对应像素点的边界因子；/＞表示线性归一化函数；表示以自然常数为底数的指数函数。进一步地，所述根据边界系数与预设的边界系数阈值的大小关系对超像素图像中的超像素区域进行合并，获得第一超像素图像，包括的具体方法为：预设在区间内从小到大迭代的边界系数阈值，预设迭代步长为/＞，当公共边界线的边界系数小于边界系数阈值时，将公共边界线对应的两个超像素区域合并，将超像素区域合并后得到的超像素图像记为第一超像素图像，获得每个超像素图像对应的第一超像素图像，将第一超像素图像中的超像素区域记为第一超像素区域。进一步地，所述将第一超像素图像中的第一超像素区域的面积和边界点的曲率进行融合获得第一超像素区域的轮廓参数，包括的具体方法为：获取任意第一超像素区域的面积以及第一超像素区域的每个边界点的曲率；将所有第一超像素区域的所有边界点的平均曲率记为第一均值；将第一超像素区域的最小曲率与第一均值的差值绝对值记为第一差值；将第一超像素区域的最大曲率与第一均值的差值绝对值记为第二差值；将第一差值和第二差值的比值记为曲率因子，将/＞记为第一超像素区域的轮廓参数，其中/＞表示第一超像素区域的面积；/＞表示第一超像素区域的最小外接矩形的面积；/＞表示圆周率。进一步地，所述根据第一超像素区域中像素点的灰度分布情况获得第一超像素区域之间的相似参数，包括的具体方法为：获取任意第一超像素图像中每个第一超像素区域在0°、45°、90度以及135°方向上的灰度共生矩阵，根据每个方向对应灰度共生矩阵获得第一超像素区域的小梯度优势、相关性、混合熵以及差分矩，将小梯度优势、相关性、混合熵以及差分矩统称为第一超像素区域的纹理参数；将第一超像素区域的所有纹理参数形成的向量记为第一超像素区域的纹理向量，获取任意第一超像素图像中任意两个第一超像素区域对应纹理向量之间的余弦相似度，记为所述两个第一超像素区域之间的相似参数。进一步地，所述对边界系数阈值进行迭代，利用第一超像素区域之间在轮廓参数和相似参数分别对应的差异，对第一超像素图像中轮廓参数和相似参数的分布情况进行加权，构建第一超像素图像的目标函数，包括的具体方法为：获取边界系数阈值迭代过程中任意超像素图像在对应边界系数阈值下的第一超像素图像；根据第一超像素区域之间在轮廓参数和相似参数分别对应的差异，获得超像素图像在对应边界系数阈值下，第一超像素图像的轮廓权重系数和相似权重系数；构建第一超像素图像的目标函数：其中，表示超像素图像的目标函数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的平均轮廓参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的平均相似参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的轮廓参数的标准差；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的相似参数的标准差；/＞表示边界系数阈值；/＞表示自然常数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像的轮廓权重系数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像的相似权重系数。进一步地，所述根据第一超像素区域之间在轮廓参数和相似参数分别对应的差异，获得超像素图像在对应边界系数阈值下，第一超像素图像的轮廓权重系数和相似权重系数，包括的具体方法为：将超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的平均轮廓参数记为第二均值；将超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的平均相似参数记为第三均值；将超像素图像在对应边界系数阈值下的第一超像素图像中，任意第一超像素区域的轮廓参数与第二均值的差值绝对值记为第一超像素区域的第三差值；将超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的任意相似参数与第三均值的差值绝对值记为第一超像素区域之间的第四差值；将记为第一超像素图像的轮廓权重系数，将/＞记为第一超像素图像的相似权重系数，其中/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中第一超像素区域的数量；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间相似参数的数量；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，第/＞个第一超像素区域的第三差值；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的第/＞个第四差值；/＞表示以自然常数为底数的指数函数。进一步地，所述根据目标函数的输出值的大小获得烘焙质量系数，包括的具体方法为：边界系数阈值在迭代过程中，当超像素图像的目标函数的输出值最大时，将超像素图像在对应边界系数阈值下的第一超像素图像记为超像素图像的第二超像素图像，将第二超像素图像中的超像素区域记为第二超像素区域；获取切片中药图像中任意像素点在所有第二超像素图像下对应的边界因子记为像素点的最终边界因子，将所有第二超像素图像的数量记为图像数量参数，将像素点的最终边界因子与图像数量参数的比值记为像素点的边界投票概率，将切片中药图像中所有边界投票概率大于概率阈值的像素点记为最终边界点，将由切片中药图像中所有最终边界点形成的图像作为切片中药图像的最终超像素分割图像，将最终超像素分割图像中最终边界点形成的超像素区域记为最终超像素区域，其中概率阈值/＞为预设的超参数；对烘焙后的同一批中药切片进行多次翻动，采集翻动后的切片中药图像，获得个切片中药图像，并获取每个切片中药图像的最终超像素分割图像，将最终超像素分割图像中的超像素区域记为最终超像素区域；将切片中药图像对应最终超像素分割图像中轮廓参数的最终超像素区域记为中药切面区域，将任意中药切面区域内所有像素点的平均灰度记为中药切面区域的灰度参数，将切片中药图像中所有中药切面区域的平均灰度参数记为切片中药图像的灰度因子，将切片中药图像中所有中药切面区域的灰度参数的标准差记为切片中药图像的第一均匀因子，将所有切片中药图像的灰度因子的标准差记为第二均匀因子，其中/＞为预设的超参数；获取烘焙质量系数，具体计算方法为：其中，表示烘焙质量系数；/＞表示sigmiod归一化函数；/＞表示切片中药图像的数量；/＞表示第/＞个切片中药图像的第一均匀因子；/＞表示第/＞个切片中药图像的灰度因子；/＞表示第二均匀因子。进一步地，所述根据烘焙质量系数的大小对切片中药的烘焙质量进行评价，包括的具体方法为：当烘焙质量系数位于区间时切片中药的烘焙质量合格，当烘焙质量系数位于区间/＞和/＞内时切片中药的烘焙质量不合格，其中/＞和/＞均为预设的超参数，将烘焙质量合格的切片中药进行包装，将烘焙质量系数位于区间/＞内的切片中药进行重新烘焙，直至对应的烘焙质量系数位于区间/＞内，将烘焙质量系数位于区间/＞内的切片中药进行销毁。本发明的技术方案的有益效果是：通过获取切片中药图像、利用不同方法对切片中药图像进行超像素分割获得若干超像素图像，然后对超像素区域进行迭代合并处理，提高了在对切片中药图像进行超像素分割的边界回归率，提高了切片中药边缘的检测准确性，另外最终根据烘焙质量系数的大小对切片中药的烘焙质量进行评价，通过对每个超像素区域的纹理特征进行分析，可以评价切片中药的烘焙程度的均匀性，从而可以用于指导烘焙过程，进一步提高了切片中药的整体烘焙质量。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一种切片中药的烘焙质量评价方法的步骤流程图；图2为切片中药示意图；图3为切面示意图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种切片中药的烘焙质量评价方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种切片中药的烘焙质量评价方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种切片中药的烘焙质量评价方法的步骤流程图，该方法包括以下步骤：步骤S001：获取切片中药图像。具体的，为了实现本实施例提出的一种切片中药的烘焙质量评价方法，首先需要采集切片中药图像，具体过程为：利用工业相机获取切片中药在烘焙后的图像，记为切片中药图像，如图2所示。至此，通过上述方法得到切片中药图像。步骤S002：利用不同方法对切片中药图像进行超像素分割获得若干超像素图像，根据切片中药图像中边缘像素点的数量、像素点的梯度幅值以及像素点在同位置下所有超像素图像中对应边界点的数量获得边界系数，根据边界系数与预设的边界系数阈值的大小关系对超像素区域进行合并获得第一超像素图像。具体的，步骤，首先，利用个不同的超像素分割算法分别对切片中药图像进行超像素分割，获得对应的超像素分割结果图像，记为超像素图像，一个超像素分割算法对应一个超像素图像，一个超像素图像中包括若干个超像素区域，将超像素区域的区域边缘处对应的像素点记为边界点；同位置下，切片中药图像中一个像素点在所有超像素图像中对应若干个边界点，将切片中药图像中任意像素点在所有超像素图像中对应边界点的数量，记为所述像素点的边界因子，其中/＞为预设的超参数。需要说明的是，本实施例中选择SLIC、SEEDS以及LSC个超像素分割算法，分别对应的中文名称为简单线性迭代聚类超像素分割算法、通过能量驱动采样提取的超像素分割算法以及线性谱聚类超像素分割算法，可根据需要调整超参数/＞以及超像素分割算法，本实施例不进行具体限定，另外由于SLIC、SEEDS以及LSC三个超像素分割算法为现有的超像素分割算法，因此本实施例不进行赘述。需要说明的是，由于不同超像素分割算法的超像素分割原理不相同，因此在对切片中药图像进行超像素分割后得到多个超像素图像中同位置下的像素点不一定都是边界点，因此为了提高超像素分割算法的边界回归率，本实施例目的在于通过在同位置下的像素点在多个超像素图像中是否为边界点的情况进行分析，获取能够反映切片中药实际边缘的边界点。然后，利用Sobel算子获取切片中药图像中的边缘像素点以及切片中药图像中每个像素点的梯度幅值，预设超参数作为切片中药图像中像素点的边缘因子，当切片中药图像中像素点为边缘像素点时，像素点的边缘因子/＞；当切片中药图像中像素点不为边缘像素点时，像素点的边缘因子/＞。需要说明的是，Sobel算子为现有的边界检测算法，因此本实施例不进行赘述。需要说明的是，在预设超参数时，应保证切片中药图像中像素点为边缘像素点时像素点的边缘因子，大于切片中药图像中像素点不为边缘像素点时像素点的边缘因子，超参数/＞可根据实际情况调整超参数，本实施例不进行具体限定。需要说明的是，超像素分割算法的算法目的在于获取图像中的边缘信息，因此为了提高超像素分割算法的边界回归率，需要使得超像素分割算法的边界点趋近于图像中的边缘像素点，但是由于边缘检测算法得到的边缘像素点。最后，在任意超像素图像中，将任意相邻的两个超像素区域之间共有的边界点记为所述两个超像素区域的公共边界点，将相邻的两个超像素区域的所有公共边界点形成的线段记为所述两个超像素区域的公共边界线，获取任意相邻的两个超像素区域的公共边界线的边界系数，具体计算方法为：其中，表示公共边界线的边界系数；/＞表示公共边界线包括的公共边界点的数量；/＞表示公共边界线对应所有公共边界点在切片中药图像中对应边缘像素点的数量；/＞表示公共边界线的第/＞个公共边界点在切片中药图像中对应像素点的边缘因子；/＞表示公共边界线的第/＞个公共边界点在切片中药图像中对应像素点的梯度幅值；/＞表示公共边界线的第个公共边界点在切片中药图像中对应像素点的边界因子；/＞表示线性归一化函数；表示以自然常数为底数的指数函数。需要说明的是，所述公共边界线的边界系数用于描述公共边界线可以作为中药切片的实际边缘的概率，边界系数越大，公共边界线可以作为中药切片的实际边缘的概率越大，反之越小。需要说明的是，边缘率反映了公共边界线上公共边界点在切片中药图像中作为边缘像素点的概率，公共边界线上公共边界点在切片中药图像中作为边缘像素点的数量越多，边缘率越大，则所述公共边界线越能够反映切片中药的实际边缘，在后续对超像素区域进行合并过程中，该公共边缘线被合并取消的概率越小；边界融合因子/＞反映了切片中药图像经过超像素分割后，超像素图像中公共边界点能够反映切片中药边缘信息的能力，边界融合因子越大，公共边界点能够反映切片中药边缘信息的能力越大，即公共边界点所在公共边界线可以作为中药切片的实际边缘的概率越大，在后续对超像素区域进行合并过程中该公共边缘线被合并取消的概率越小。步骤，预设在区间内从小到大迭代的边界系数阈值，预设迭代步长为/＞，当公共边界线的边界系数小于边界系数阈值时，将公共边界线对应的两个超像素区域合并，将超像素区域合并后得到的超像素图像记为第一超像素图像，获得每个超像素图像对应的第一超像素图像，将第一超像素图像中的超像素区域记为第一超像素区域。需要说明的是，根据经验预设迭代步长为，可根据实际情况进行调整，本实施例不进行具体限定。至此，通过上述方法得到第一超像素图像以及第一超像素图像中第一超像素区域。步骤S003：获取第一超像素区域的轮廓参数以及的相似参数；对边界系数阈值进行迭代，利用第一超像素区域之间分别在轮廓参数和相似参数的差异，对第一超像素图像中轮廓参数和相似参数的分布情况进行加权，获得第一超像素图像的目标函数，根据目标函数的输出值的大小获得烘焙质量系数。具体的，步骤，获取任意第一超像素区域的面积以及第一超像素区域的每个边界点的曲率，根据曲率和面积获取任意第一超像素区域的轮廓参数，具体计算方法为：其中，表示第一超像素区域的轮廓参数；/＞表示第一超像素区域的最小曲率；表示第一超像素区域的最大曲率；/＞表示所有第一超像素区域的所有边界点的平均曲率；/＞表示第一超像素区域的面积；/＞表示第一超像素区域的最小外接矩形的面积。需要说明的是，通常烘焙的中药切片外形轮廓为圆形或椭圆形状，因此实施例根据椭圆的相关形状特征获取任意第一超像素区域的轮廓参数。需要说明的是，轮廓参数反映了第一超像素区域的边界轮廓特征，第一超像素区域的外形轮廓越接近于圆形或椭圆形，则对应轮廓参数的数值越接近于1；另外由于圆形或椭圆形边缘的最大曲率和最小曲率通常分别与平均曲率之间的差异相近，因此第一超像素区域的最大曲率和最小曲率分别与平均曲率之间的差异的比值越接近于1，第一超像素区域的外形轮廓越接近于圆形或椭圆形。需要说明的是，超像素图像中属于同一个中药切片对应区域的若干个超像素区域之间在整体的图像纹理上存在较高程度的相似性，因此本实施例通过灰度共生矩阵获取超像素图像内超像素区域的图像纹理特征。步骤，首先，获取任意第一超像素图像中每个第一超像素区域在0°、45°、90度以及135°方向上的灰度共生矩阵，根据每个方向对应灰度共生矩阵获得第一超像素区域的小梯度优势、相关性、混合熵以及差分矩，将小梯度优势、相关性、混合熵以及差分矩统称为第一超像素区域的纹理参数。需要说明的是，为了避免对第一超像素区域中的像素纹理的冗余描述，因此要选取不相关的特征描述参数的特征信息，因此本实施例通过获取第一超像素区域在4个方向上的小梯度优势、相关性、混合熵和差分矩作为第一超像素区域的纹理参数，以描述超像素区域的图像纹理特征。然后，将第一超像素区域的所有纹理参数形成的向量记为第一超像素区域的纹理向量，获取任意第一超像素图像中任意两个第一超像素区域对应纹理向量之间的余弦相似度，记为所述两个第一超像素区域之间的相似参数。需要说明的是，最小梯度优势反映了第一超像素区域中像素点在区域中梯度小的程度以及所占比例；相关性反映了第一超像素区域中像素点的灰度和梯度之间的相关程度；混合熵反映了第一超像素区域中像素点在灰度和梯度分布的随机性；差分矩反映了第一超像素区域中像素点的灰度和梯度所构成纹理的清晰和规则程度；步骤，首先，在区间内从小到大迭代边界系数阈值/＞，获取迭代过程中任意超像素图像在边界系数阈值下对应的第一超像素图像，根据任意一次迭代得到的边界系数阈值所对应第一超像素图像中第一超像素区域的轮廓参数和相似参数，构建第一超像素图像的目标函数：其中，表示超像素图像的目标函数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的平均轮廓参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的平均相似参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域的轮廓参数的标准差；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的相似参数的标准差；/＞表示边界系数阈值；/＞表示自然常数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像的轮廓权重系数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，第/＞个第一超像素区域的轮廓参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中第一超像素区域的数量；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像的相似权重系数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间的第/＞个相似参数；/＞表示超像素图像在对应边界系数阈值下的第一超像素图像中，所有第一超像素区域之间相似参数的数量；/＞表示绝对值符号；/＞表示以自然常数为底数的指数函数。需要说明的是，中药切片的外形轮廓通常近似于圆形或椭圆形，且中药切片的表面纹理通常相近，为了保证对切片中药图像进行超像素分割后得到的超像素区域更接近中药切片对应区域，故在边界系数阈值迭代过程中，所有第一超像素区域的轮廓参数和相似参数的和值越大，表示第一超像素区域轮廓越接近于圆形或椭圆形，且第一超像素区域之间的表面纹理越相似；另外，通过将第一超像素区域与所有第一超像素区域之间分别在轮廓参数和相似参数上的差异，即/＞和/＞，分别作为迭代过程中对轮廓参数和相似参数的权重，即轮廓权重系数/＞和相似权重系数/＞，轮廓权重系数和相似权重系数越小，表示第一超像素图像中存在第一超像素区域的轮廓参数和相似参数，与所有第一超像素区域的平均轮廓参数和平均相似参数之间的差异过大，即所述第一超像素区域对中药切片的边界召回率过低，因此通过轮廓权重系数和相似权重系数分别对轮廓参数和相似参数进行加权调节，以分别调节对超像素区域进行合并过程中对超像素区域的轮廓参数和相似参数之间的关注程度，使迭代过程能够最大程度保证第一超像素区域之间的轮廓和纹理更接近中药切片的轮廓和纹理特征，提高超像素分割的边界召回率；同时，为了避免边界系数阈值迭代数值过大，导致第一超像素区域合并过程中出现局部最优解，因此本实施例将/＞作为目标函数的惩罚项。然后，边界系数阈值在迭代过程中，当超像素图像的目标函数的输出值最大时，将超像素图像在对应边界系数阈值下的第一超像素图像记为超像素图像的第二超像素图像，将第二超像素图像中的超像素区域记为第二超像素区域。最后，获取切片中药图像中任意像素点在所有第二超像素图像下对应的边界因子记为像素点的最终边界因子，将所有第二超像素图像的数量记为图像数量参数，将像素点的最终边界因子与图像数量参数的比值记为像素点的边界投票概率，将切片中药图像中所有边界投票概率大于概率阈值的像素点记为最终边界点，将由切片中药图像中所有最终边界点形成的图像作为切片中药图像的最终超像素分割图像，将最终超像素分割图像中最终边界点形成的超像素区域记为最终超像素区域，其中概率阈值/＞为预设的超参数。需要说明的是，根据经验预设概率阈值为0.6，可根据实际情况进行调整，本实施例不进行具体限定。需要说明的是，烘焙质量合格的切片中药在切片中药图像中，可以通过对切面表面的灰度分布情况体现出来，所述切面的示意图如图3所示，灰度均匀且灰度水平适中为烘焙效果合格的，为了更好的对中药切片烘焙效果进行质量评价以指导实际烘焙加工过程，故需要提出对切片中药烘焙质量的评价模型。步骤，首先，对烘焙后的同一批中药切片进行多次翻动，采集翻动后的切片中药图像，获得个切片中药图像，并获取每个切片中药图像的最终超像素分割图像，将最终超像素分割图像中的超像素区域记为最终超像素区域。然后，将切片中药图像对应最终超像素分割图像中轮廓参数的最终超像素区域记为中药切面区域，将任意中药切面区域内所有像素点的平均灰度记为中药切面区域的灰度参数，将切片中药图像中所有中药切面区域的平均灰度参数记为切片中药图像的灰度因子，将切片中药图像中所有中药切面区域的灰度参数的标准差记为切片中药图像的第一均匀因子，将所有切片中药图像的灰度因子的标准差记为第二均匀因子，其中/＞为预设的超参数。需要说明的是，根据经验预设超参数为0.8，可根据实际情况进行调整，本实施例不进行具体限定。最后，获取烘焙质量系数，具体计算方法为：其中，表示烘焙质量系数；/＞表示sigmiod归一化函数；/＞表示切片中药图像的数量；/＞表示第/＞个切片中药图像的第一均匀因子；/＞表示第/＞个切片中药图像的灰度因子；/＞表示第二均匀因子。需要说明的是，中药切面区域的灰度参数反映了中药切片在烘焙过程中的烘焙程度，灰度参数越大，烘焙程度越高，反之越小，但是烘焙程度越高不代表烘焙质量越好，需要根据实际情况进行判断，第一均匀因子和第二均匀因子分别反映了中药切片在单次翻动以及所有次翻动过程中所有中药切片的烘焙程度的均匀性，第一均匀因子和第二均匀因子越小，烘焙程度的均匀性越大，即烘焙的越均匀，烘焙质量越好。至此，通过上述方法得到烘焙质量系数。步骤S004：根据烘焙质量系数的大小对切片中药的烘焙质量进行评价。需要说明的是，同一批烘焙后的切片中药对应的烘焙质量系数反映了切片中药的烘焙质量，切片中药烘焙后，烘焙质量系数越小切片中药的烘焙程度越小，可能不利于切片中药保存和药效提升；而烘焙质量系数越大切片重要的烘焙程度越大，可能导致中药的药效和营养流失，影响药品质量，因此烘焙质量合格的切片中药所对应的烘焙质量系数应该在合适的区间内。具体的，当烘焙质量系数位于区间时切片中药的烘焙质量合格，当烘焙质量系数位于区间/＞和/＞内时切片中药的烘焙质量不合格，其中/＞和/＞均为预设的超参数，将烘焙质量合格的切片中药进行包装，将烘焙质量系数位于区间/＞内的切片中药进行重新烘焙，直至对应的烘焙质量系数位于区间/＞内，将烘焙质量系数位于区间/＞内的切片中药进行销毁。需要说明的是，根据经验预设超参数和/＞分别为0.4和0.7，可根据实际情况进行调整，本实施例不进行具体限定。至此，本实施例完成。需要说明的是，本实施例中所用的模型仅用于表示负相关关系和约束模型输出的结果处于/＞区间内，具体实施时，可替换成具有同样目的的其他模型，本实施例只是以/＞模型为例进行叙述，不对其做具体限定，其中/＞是指该模型的输入。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
