标题title
一种增强图推荐模型鲁棒性的方法、装置及一种推荐方法
摘要abst
本申请涉及一种增强图推荐模型鲁棒性的方法、装置及一种推荐方法，其中，该增强图推荐模型鲁棒性的方法包括：获取待优化的初始图推荐模型，扩充所述初始图推荐模型中每个节点的邻居节点；其中，所述节点包括用户节点和物品节点；调整所述初始图推荐模型中每条边的权重，根据调整后的所述边的权重确定所述初始图推荐模型的邻接矩阵；根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型。通过本申请提高了目标图推荐模型的鲁棒性，解决了现有的图推荐模型在分布偏移场景下的推荐效果不佳的问题。
权利要求书clms
1.一种增强图推荐模型鲁棒性的方法，其特征在于，包括：获取待优化的初始图推荐模型，扩充所述初始图推荐模型中每个节点的邻居节点；其中，所述节点包括用户节点和物品节点；调整所述初始图推荐模型中每条边的权重，根据调整后的所述边的权重确定所述初始图推荐模型的邻接矩阵；根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型。2.根据权利要求1所述的增强图推荐模型鲁棒性的方法，其特征在于，对于任意节点，所述节点/＞扩充后的邻居节点集合的表达式为：其中，为所述目标节点扩充后的邻居节点集合，/＞为节点编号，/＞为所述目标节点扩充前的邻居节点集合，/＞为所述节点/＞新增的邻居节点集合；所述新增的邻居节点集合包括与所述节点相似度最高的多个节点。3.根据权利要求2所述的增强图推荐模型鲁棒性的方法，其特征在于，所述新增的邻居节点集合的表达式为：其中，函数的表达式为：其中，为节点编号，θ为所述初始图推荐模型的模型参数，/＞为用户节点集合，/＞为物品节点集合，/＞为用户节点集合U和物品节点集合I中的任意节点，/＞为/＞范数，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的度，/＞为所述节点/＞的度，/＞表示节点/＞和/＞的规范化表征向量之间的/＞范数，/＞为所述节点/＞在规范化表征向量的斐波那契范数意义下相似度最高的节点构成的集合。4.根据权利要求3所述的增强图推荐模型鲁棒性的方法，其特征在于，对于任意节点和节点x，所述节点/＞和所述节点x之间调整后的边的权重表达式为：其中，为所述节点/＞和所述节点x之间调整后的边的权重，/＞为预设的超参数，/＞为所述节点/＞和所述节点x之间调整前的边的权重，q为所述节点/＞的扩充后的邻居节点。5.根据权利要求1所述的增强图推荐模型鲁棒性的方法，其特征在于，根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，包括：根据所述邻接矩阵对所述初始图推荐模型进行聚合操作，确定所述节点的最终表征向量矩阵；根据所述节点的最终表征向量矩阵确定所述初始图推荐模型的目标损失。6.根据权利要求5所述的增强图推荐模型鲁棒性的方法，其特征在于，根据所述邻接矩阵对所述初始图推荐模型进行聚合操作，确定所述节点的最终表征向量矩阵，包括：根据所述邻接矩阵对所述初始图推荐模型中所述节点的表征向量矩阵进行K次聚合，对每次聚合得到的表征向量矩阵进行加权平均，得到所述初始图推荐模型中所述节点的最终表征向量矩阵；其中，K为所述初始图推荐模型的网络层数。7.根据权利要求1所述的增强图推荐模型鲁棒性的方法，其特征在于，所述图推荐模型的目标损失的表达式为：其中，L为所述目标损失，U为用户节点集合，I为物品节点集合，u为用户节点，v为物品节点，为损失函数，/＞为用户节点的最终表征向量矩阵的转置矩阵，/＞为物品节点的最终表征向量矩阵，/＞为表示用户u是否喜欢物品v的标签值。8.根据权利要求1所述的增强图推荐模型鲁棒性的方法，其特征在于，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型，包括：通过梯度下降算法对所述初始图推荐模型的目标损失进行优化，更新初始图推荐模型的参数，得到目标图推荐模型。9.一种增强图推荐模型鲁棒性的装置，其特征在于，包括：节点扩充模块，用于获取待优化的初始图推荐模型，扩充所述初始图推荐模型中每个节点的邻居节点；其中，所述节点包括用户节点和物品节点；边权调整模块，用于调整所述初始图推荐模型中每条边的权重，根据调整后的所述边的权重确定所述初始图推荐模型的邻接矩阵；训练优化模块，用于根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型。10.一种推荐方法，其特征在于，包括：获取待优化的初始图推荐模型，扩充所述初始图推荐模型中每个节点的邻居节点；其中，所述节点包括用户节点和物品节点；调整所述初始图推荐模型中每条边的权重，根据调整后的所述边的权重确定所述初始图推荐模型的邻接矩阵；根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型；通过所述目标图推荐模型向用户推荐物品。
说明书desc
技术领域本申请涉及推荐系统优化领域，特别是涉及一种增强图推荐模型鲁棒性的方法、装置及一种推荐方法。背景技术得益于图神经网络可以利用高阶邻居节点信息的特性，相比于传统的矩阵分解模型，基于图神经网络的推荐模型取得了更好的效果。除此之外，图推荐模型也被证明在处理冷启动用户和建模更加复杂的交互关系方面具备更强的能力，由此成为推荐模型中最先进的模型之一。现有的机器学习模型要求训练数据集和测试集服从相同的分布，然而这一假设并不总是成立，在许多情况下两者之间会存在分布偏移的现象。尽管图推荐模型在训练集和测试集服从相同分布的条件下取得了较为不错的效果，但其被发现在分布偏移场景下表现不佳，甚至会弱于传统的矩阵分解模型。因此，针对图推荐系统设计的提高其鲁棒性的方法是必要的。目前已经提出一些针对推荐系统解决分布偏移问题的方法。一类方法被称为鲁棒推荐系统，该类方法采用不变学习或因果学习的方式识别不随分布发生改变的变量，基于这些变量学习用户和物品的表征向量，使用这些表征向量可以提供稳定的推荐结果。但是，鲁棒推荐系统并不是针对图神经网络结构设计的，因此无法避免分布偏移对图神经网络结构本身的影响。另一类方法通过图对比学习、图增强等方式降低分布偏移对图结构本身的影响。这类方法虽然是针对图神经网络结构设计的，但是其设计往往是基于启发式的而缺乏理论保证，因此在分布偏移场景下效果并不稳定，实际效果不佳。针对相关技术中存在的图推荐模型在分布偏移场景下的推荐效果不佳的问题，目前还没有提出有效的解决方案。发明内容在本实施例中提供了一种增强图推荐模型鲁棒性的方法、装置及一种推荐方法，以解决相关技术中存在的图推荐模型在分布偏移场景下的推荐效果不佳的问题。第一个方面，在本发明中提供了一种增强图推荐模型鲁棒性的方法，包括：获取待优化的初始图推荐模型，扩充所述初始图推荐模型中每个节点的邻居节点；其中，所述节点包括用户节点和物品节点；调整所述初始图推荐模型中每条边的权重，根据调整后的所述边的权重确定所述初始图推荐模型的邻接矩阵；根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型。在其中的一些实施例中，对于任意节点，所述节点/＞扩充后的邻居节点集合的表达式为：其中，为所述目标节点扩充后的邻居节点集合，/＞为节点编号，/＞为所述目标节点扩充前的邻居节点集合，/＞为所述节点/＞新增的邻居节点集合；所述新增的邻居节点集合包括与所述节点相似度最高的多个节点。在其中的一些实施例中，所述新增的邻居节点集合的表达式为：其中，函数的表达式为：其中，为节点编号，θ为所述初始图推荐模型的模型参数，U为用户节点集合，I为物品节点集合，/＞为用户节点集合U和物品节点集合I中的任意节点，/＞为/＞范数，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的度，/＞为所述节点/＞的度，/＞表示节点/＞和/＞的规范化表征向量之间的/＞范数，/＞为所述节点/＞在规范化表征向量的斐波那契范数意义下相似度最高的节点构成的集合。在其中的一些实施例中，对于任意节点和节点x，所述节点/＞和所述节点x之间调整后的边的权重表达式为：其中，为所述节点/＞和所述节点x之间调整后的边的权重，/＞为预设的超参数，为所述节点/＞和所述节点x之间调整前的边的权重，q为所述节点/＞的扩充后的邻居节点。在其中的一些实施例中，所述根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，包括：根据所述邻接矩阵对所述初始图推荐模型进行聚合操作，确定所述节点的最终表征向量矩阵；根据所述节点的最终表征向量矩阵确定所述初始图推荐模型的目标损失。在其中的一些实施例中，根据所述邻接矩阵对所述初始图推荐模型进行聚合操作，确定所述节点的最终表征向量矩阵，包括：根据所述邻接矩阵对所述初始图推荐模型中所述节点的表征向量矩阵进行K次聚合，对每次聚合得到的表征向量矩阵进行加权平均，得到所述初始图推荐模型中所述节点的最终表征向量矩阵；其中，K为所述初始图推荐模型的网络层数。在其中的一些实施例中，所述图推荐模型的目标损失的表达式为：其中，L为所述目标损失，U为用户节点集合，I为物品节点集合，为用户节点的数量，/＞为物品节点的数量，u为用户节点，v为物品节点，/＞为损失函数，/＞为用户节点的最终表征向量矩阵的转置矩阵，/＞为物品节点的最终表征向量矩阵，/＞为表示用户u是否喜欢物品v的标签值。在其中的一些实施例中，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型，包括：通过梯度下降算法对所述初始图推荐模型的目标损失进行优化，更新初始图推荐模型的参数，得到目标图推荐模型。第二个方面，在本发明中提供了一种增强图推荐模型鲁棒性的装置，其特征在于，包括：节点扩充模块，用于获取待优化的初始图推荐模型，扩充所述初始图推荐模型中每个节点的邻居节点；其中，所述节点包括用户节点和物品节点；边权调整模块，用于调整所述初始图推荐模型中每条边的权重，根据调整后的所述边的权重确定所述初始图推荐模型的邻接矩阵；训练优化模块，用于根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型。第三个方面，在本发明中提供了一种推荐方法，包括：获取待优化的初始图推荐模型，扩充所述初始图推荐模型中每个节点的邻居节点；其中，所述节点包括用户节点和物品节点；调整所述初始图推荐模型中每条边的权重，根据调整后的所述边的权重确定所述初始图推荐模型的邻接矩阵；根据所述初始图推荐模型的邻接矩阵确定所述初始图推荐模型的目标损失，对所述初始图推荐模型进行训练优化所述目标损失，得到目标图推荐模型；通过所述目标图推荐模型向用户推荐物品。与相关技术相比，在本发明中提供了一种增强图推荐模型鲁棒性的方法，通过对初始图推荐模型的每个节点的邻居节点进行扩充，调整初始图推荐模型中每条边的权重，并确定初始图推荐模型的邻接矩阵，以扩大用户与物品之间交互关系的范围。然后根据初始图推荐模型的邻接矩阵确定目标损失，并对初始图推荐模型进行训练优化，降低目标损失，得到目标图推荐模型。由于目标图推荐模型中包含了更多的邻居节点的可能分布情况，即包含了更多的用户对物品的评价信息，在实际使用时，目标图推荐模型中可用作参考的数据涵盖范围更广，目标图推荐模型的鲁棒性更高，解决了现有的图推荐模型在分布偏移场景下的推荐效果不佳的问题。本申请的一个或多个实施例的细节在以下附图和描述中提出，以使本申请的其他特征、目的和优点更加简明易懂。附图说明此处所说明的附图用来提供对本申请的进一步理解，构成本申请的一部分，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。在附图中：图1是执行本发明中提供的增强图推荐模型鲁棒性的方法的终端硬件结构框图；图2是本发明的增强图推荐模型鲁棒性的方法的流程图；图3是本发明的增强图推荐模型鲁棒性的装置的结构框图；图4是本发明的推荐方法的流程图。具体实施方式为更清楚地理解本申请的目的、技术方案和优点，下面结合附图和实施例，对本申请进行了描述和说明。除另作定义外，本申请所涉及的技术术语或者科学术语应具有本申请所属技术领域具备一般技能的人所理解的一般含义。在本申请中的“一”、“一个”、“一种”、“该”、“这些”等类似的词并不表示数量上的限制，它们可以是单数或者复数。在本申请中所涉及的术语“包括”、“包含”、“具有”及其任何变体，其目的是涵盖不排他的包含；例如，包含一系列步骤或模块的过程、方法和系统、产品或设备并未限定于列出的步骤或模块，而可包括未列出的步骤或模块，或者可包括这些过程、方法、产品或设备固有的其他步骤或模块。在本申请中所涉及的“连接”、“相连”、“耦接”等类似的词语并不限定于物理的或机械连接，而可以包括电气连接，无论是直接连接还是间接连接。在本申请中所涉及的“多个”是指两个或两个以上。“和/或”描述关联对象的关联关系，表示可以存在三种关系，例如，“A和/或B”可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。通常情况下，字符“/”表示前后关联的对象是一种“或”的关系。在本申请中所涉及的术语“第一”、“第二”、“第三”等，只是对相似对象进行区分，并不代表针对对象的特定排序。在本发明中提供的方法实施例可以在终端、计算机或者类似的运算装置中执行。比如在终端上运行，图1是执行本发明中提供的增强图推荐模型鲁棒性的方法的终端硬件结构框图。如图1所示，终端可以包括一个或多个处理器120和用于存储数据的存储器140，其中，处理器120可以包括但不限于微处理器MCU或可编程逻辑器件FPGA等的处理装置。上述终端还可以包括用于通信功能的传输设备160以及输入输出设备180。本领域普通技术人员可以理解，图1所示的结构仅为示意，其并不对上述终端的结构造成限制。例如，终端还可包括比图1中所示更多或者更少的组件，或者具有与图1所示出的不同配置。存储器140可用于存储计算机程序，例如，应用软件的软件程序以及模块，如在本发明中的增强图推荐模型鲁棒性的方法对应的计算机程序，处理器120通过运行存储在存储器140内的计算机程序，从而执行各种功能应用以及数据处理，即实现上述的方法。存储器140可包括高速随机存储器，还可包括非易失性存储器，如一个或者多个磁性存储装置、闪存、或者其他非易失性固态存储器。在一些实例中，存储器140可进一步包括相对于处理器120远程设置的存储器，这些远程存储器可以通过网络连接至终端。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。传输设备160用于经由一个网络接收或者发送数据。上述的网络包括终端的通信供应商提供的无线网络。在一个实例中，传输设备160包括一个网络适配器，其可通过基站与其他网络设备相连从而可与互联网进行通讯。在一个实例中，传输设备160可以为射频模块，其用于通过无线方式与互联网进行通讯。在本发明中提供了一种增强图推荐模型鲁棒性的方法，图2是本发明的增强图推荐模型鲁棒性的方法的流程图，如图2所示，该流程包括如下步骤：步骤S201，获取待优化的初始图推荐模型，扩充初始图推荐模型中每个节点的邻居节点；其中，节点包括用户节点和物品节点。步骤S202，调整初始图推荐模型中每条边的权重，根据调整后的边的权重确定初始图推荐模型的邻接矩阵。步骤S203，根据初始图推荐模型的邻接矩阵确定初始图推荐模型的目标损失，对初始图推荐模型进行训练优化目标损失，得到目标图推荐模型。其中，图推荐模型为用于向用户进行物品推荐的图神经网络模型。对于初始图推荐模型的邻接矩阵，假设用户数量为n个，物品数量为m个，则初始图推荐模型的邻接矩阵的大小为*，在邻接矩阵中，对于任意节点和节点/＞，元素/＞的值标识节点与节点/＞之间是否存在交互，若元素值为1，则表示/＞与/＞之间存在交互，若元素值为0，则表示/＞与/＞之间没有交互。在上述方法中，首先获取待优化的初始图推荐模型，初始图推荐模型为现有的常规图推荐模型，初始图推荐模型只关联交互过的用户节点与物品节点。对于用户而言，可能部分用户原本交互过的物品数量比较少，即初始图推荐模型中邻居节点的可能分布情况较少，用户对物品的评价信息较少，使得初始图推荐模型在实际使用时，可用作参考的数据较少，鲁棒性较低，这就导致初始图推荐模型在对分布不同的数据进行推荐时的推荐效果不佳。为此，本方法对初始图推荐模型的每个节点的邻居节点进行扩充，调整初始图推荐模型中每条边的权重，并确定初始图推荐模型的邻接矩阵，以扩大用户与物品之间交互关系的范围。然后根据初始图推荐模型的邻接矩阵确定目标损失，并对初始图推荐模型进行训练优化，降低目标损失，得到目标图推荐模型。由于目标图推荐模型中包含了更多的邻居节点的可能分布情况，即包含了更多的用户对物品的评价信息，在实际使用时，目标图推荐模型中可用作参考的数据涵盖范围更广，目标图推荐模型的鲁棒性更高，解决了现有的图推荐模型在分布偏移场景下的推荐效果不佳的问题。对于用户没有交互的物品，其中包含用户可能感兴趣的物品或者用户不感兴趣的物品，为了能够更精确地对每个节点的邻居节点进行扩充，在其中的一些实施例中，对于任意节点，节点/＞扩充后的邻居节点集合的表达式为：其中，为目标节点扩充后的邻居节点集合，/＞为节点编号，/＞为目标节点扩充前的邻居节点集合，/＞为节点/＞新增的邻居节点集合；新增的邻居节点集合包括与节点/＞相似度最高的多个节点。具体的，新增的邻居节点集合的表达式为：其中，函数的表达式为：其中，为节点编号，θ为所述初始图推荐模型的模型参数，U为用户节点集合，I为物品节点集合，/＞为用户节点集合U和物品节点集合I中的任意节点，/＞为/＞范数，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的度，/＞为所述节点/＞的度，/＞表示节点/＞和/＞的规范化表征向量之间的/＞范数，/＞为所述节点/＞在规范化表征向量的斐波那契范数意义下相似度最高的节点构成的集合。其中，节点的度即为节点的邻居节点数量。示例性的，对于任意节点，将节点/＞的规范化表征向量与集合U∪I中的节点的规范化表征向量进行对比，根据对比的差异结果，选择出多个与节点/＞相似度最高的节点，并将选择出的节点作为节点/＞新增的邻居节点。具体的，新增的邻居节点的数量可根据需要进行调整。在本实施例中，根据节点与其他节点之间相似度对节点/＞的邻居节点进行扩充，使得新增的邻居节点更加有可能为节点/＞潜在的有正向关系的节点。通过上述操作，能够在一定程度上减少每个节点扩充的邻居节点的数量，使得最终扩充的邻居节点均为更加具有参考意义的与节点/＞有正向关系的节点。其中，有正向关系的节点表示对节点/＞感兴趣的节点或者节点/＞感兴趣的节点。在其中的一些实施例中，对于任意节点和节点x，其中，节点x为节点/＞的邻居节点，所述节点/＞和所述节点x之间调整后的边的权重表达式为：其中，为所述节点/＞和所述节点x之间调整后的边的权重，/＞为预设的超参数，为所述节点/＞和所述节点x之间调整前的边的权重，q为所述节点/＞的扩充后的邻居节点。在其中的一些实施例中，步骤S203，根据初始图推荐模型的邻接矩阵确定初始图推荐模型的目标损失，包括：根据邻接矩阵对初始图推荐模型进行聚合操作，确定节点的最终表征向量矩阵；根据节点的最终表征向量矩阵确定初始图推荐模型的目标损失。具体的，根据邻接矩阵对初始图推荐模型进行聚合操作，确定节点的最终表征向量矩阵，包括：根据邻接矩阵对初始图推荐模型中节点的表征向量矩阵进行K次聚合，对每次聚合得到的表征向量矩阵进行加权平均，得到初始图推荐模型中节点的最终表征向量矩阵；其中，K为初始图推荐模型的网络层数。更具体的，对初始图推荐模型中节点的表征向量矩阵进行聚合的表达式为：其中，为经过k次聚合操作后的节点的表征向量矩阵，其中1≤k≤K，/＞为初始图推荐模型的邻接矩阵。节点的最终表征向量矩阵的表达式为：其中，E为节点的最终表征向量矩阵。图推荐模型的目标损失的表达式为：其中，L为目标损失，U为用户节点集合，I为物品节点集合，为用户节点的数量，为物品节点的数量，u为用户节点，v为物品节点，/＞为损失函数，/＞为用户节点的最终表征向量矩阵的转置矩阵，/＞为物品节点的最终表征向量矩阵，/＞为表示用户u是否喜欢物品v的标签值，示例性的，假设D为正样本数据集合，若/＞=1，则表示/＞，即用户u喜欢物品v，若/＞，则表明/＞，即用户u不喜欢物品v。通过上述操作，确定了进行边权调整后的初始图推荐模型的目标损失，方便对初始图推荐模型的目标损失进行优化，减小初始图推荐模型的损失，提高初始图推荐模型的推荐性能。在其中的一些实施例中，步骤S203，对初始图推荐模型进行训练优化目标损失，得到目标图推荐模型，包括：通过梯度下降算法对所述初始图推荐模型的目标损失进行优化，更新初始图推荐模型的参数，得到目标图推荐模型。梯度下降是迭代法的一种，可以用于求解最小二乘问题。在求解机器学习算法的模型参数，即无约束优化问题时，梯度下降是最常采用的方法之一。在求解损失函数的最小值时，可以通过梯度下降法来一步步地迭代求解，得到最小化的损失函数和模型参数值。本实施例中，通过梯度下降算法对初始图推荐模型的目标损失进行优化，得到目标图推荐模型。目标推荐模型为经过邻居节点扩充、边权调整以及损失优化后的推荐模型，涵盖了更多的节点可能分布情况，还具有较小的损失值，即目标推荐模型能够适应更多分布类型的场景，而且具有较高的推荐准确度。综上，本方法通过根据初始图推荐模型中所有节点的规范化表征向量之间的相似性为每一节点扩充其邻居节点，等价于按照特定的规则增加初始图推荐模型中边的数量。而且，本方法基于图聚合操作与平滑正则之间的等价性，使用分布鲁棒优化理论构建了一种图推荐模型的边权调整机制，并根据该边权调整机制对初始图推荐模型的边权进行调整。上述操作考虑到了邻居节点分布存在的不确定性，将更多的可能分布情况纳入对初始图推荐模型的优化过程中，以增强初始图推荐模型对于分布偏移的鲁棒性。然后，确定经过边权调整后的初始图推荐模型的目标损失，并对目标损失进行优化，得到具有较高的推荐准确度的目标图推荐模型。为了验证上述目标图推荐模型的推荐性能，在Gowalla公开数据集和Yelp2018公开数据集上进行了验证实验。两类数据集根据流行度偏差的设定人为制造训练集和测试集之间的分布偏移现象，具体来说，通过随机采样的方式使得测试集中物品的流行度尽可能趋向于均匀分布，而在训练集中物品流行度仍保持长尾分布，因此两者之间存在分布偏移现象。我们采用LightGCN作为图推荐模型的骨架模型，同时将本方法与其他提升模型鲁棒性算法进行比较，包括InvCF和APDA，这两种方法代表着两大类现有技术。InvCF采用不变学习使得模型学到与流行度无关的表征，APDA通过调整图推荐模型的边权增大流行度较小的物品的权重，但其设计是启发式的而缺乏理论保证，因此无法很好地解决分布偏移问题。我们以Recall@20和NDCG@20作为最终的测试指标，测试结果如表1所示：表1 不同方法在公开数据集上推荐性能的结果表在表1中，LightGCN为初始图推荐模型，DR-GNN为经过本方法优化后的目标图推荐模型。由表1可以看出，本方法优化后得到的DR-GNN图推荐模型的性能均高于LightGCN图推荐模型以及经过现有的InvCF方法和APDA方法优化后的图推荐模型，在分布偏移场景中取得了出色的效果。而同样基于边权调整策略的APDA方法相比基线方法LightGCN取得了非常有限的提升甚至在NDCG指标上取得了更差的效果。这进一步证明了基于启发式设计的APDA方法在实际实验中表现并不稳定。需要说明的是，在上述流程中或者附图的流程图中示出的步骤可以在诸如一组计算机可执行指令的计算机系统中执行，并且，虽然在流程图中示出了逻辑顺序，但是在某些情况下，可以以不同于此处的顺序执行所示出或描述的步骤。在本发明中还提供了一种增强图推荐模型鲁棒性的装置，该装置用于实现上述实施例及优选实施方式，已经进行过说明的不再赘述。以下所使用的术语“模块”、“单元”、“子单元”等可以实现预定功能的软件和/或硬件的组合。尽管在以下实施例中所描述的装置较佳地以软件来实现，但是硬件，或者软件和硬件的组合的实现也是可能并被构想的。图3是本发明的增强图推荐模型鲁棒性的装置的结构框图，如图3所示，该装置包括：节点扩充模块301，用于获取待优化的初始图推荐模型，扩充初始图推荐模型中每个节点的邻居节点；其中，节点包括用户节点和物品节点；边权调整模块302，用于调整初始图推荐模型中每条边的权重，根据调整后的边的权重确定初始图推荐模型的邻接矩阵；训练优化模块303，用于根据初始图推荐模型的邻接矩阵确定初始图推荐模型的目标损失，对初始图推荐模型进行训练优化目标损失，得到目标图推荐模型。在本装置中，对初始图推荐模型的每个节点的邻居节点进行扩充，调整初始图推荐模型中每条边的权重，并确定初始图推荐模型的邻接矩阵，以扩大用户与物品之间交互关系的范围。然后根据初始图推荐模型的邻接矩阵确定目标损失，并对初始图推荐模型进行训练优化，降低目标损失，得到目标图推荐模型。由于目标图推荐模型中包含了更多的邻居节点的可能分布情况，即包含了更多的用户对物品的评价信息，在实际使用时，目标图推荐模型中可用作参考的数据涵盖范围更广，目标图推荐模型的鲁棒性更高，解决了现有的图推荐模型在分布偏移场景下的推荐效果不佳的问题。需要说明的是，上述各个模块可以是功能模块也可以是程序模块，既可以通过软件来实现，也可以通过硬件来实现。对于通过硬件来实现的模块而言，上述各个模块可以位于同一处理器中；或者上述各个模块还可以按照任意组合的形式分别位于不同的处理器中。在本发明中提供了一种推荐方法，图4是本发明的推荐方法的流程图，如图4所示，该流程包括如下步骤：步骤S401，获取待优化的初始图推荐模型，扩充初始图推荐模型中每个节点的邻居节点；其中，节点包括用户节点和物品节点；步骤S402，调整初始图推荐模型中每条边的权重，根据调整后的边的权重确定初始图推荐模型的邻接矩阵；步骤S403，根据初始图推荐模型的邻接矩阵确定初始图推荐模型的目标损失，对初始图推荐模型进行训练优化目标损失，得到目标图推荐模型；步骤S404，通过目标图推荐模型向用户推荐物品。在本方法中，首先获取待优化的初始图推荐模型，对于用户而言，可能部分用户原本交互过的物品数量比较少，即初始图推荐模型中邻居节点的可能分布情况较少，用户对物品的评价信息较少，使得初始图推荐模型在实际使用时，可用作参考的数据较少，鲁棒性较低，这就导致初始图推荐模型在对分布不同的数据进行推荐时的推荐效果不佳。为此，本方法对初始图推荐模型的每个节点的邻居节点进行扩充，调整初始图推荐模型中每条边的权重，并确定初始图推荐模型的邻接矩阵，以扩大用户与物品之间交互关系的范围。然后根据初始图推荐模型的邻接矩阵确定目标损失，并对初始图推荐模型进行训练优化，降低目标损失，得到目标图推荐模型。由于目标图推荐模型中包含了更多的邻居节点的可能分布情况，即包含了更多的用户对物品的评价信息。最后，使用目标图推荐模型向用户推荐物品，由于目标图推荐模型中可用作参考的数据涵盖范围更广，目标图推荐模型的鲁棒性更高，使得目标图推荐模型受物品的分布偏差影响较小，提高了推荐的准确性。对于用户没有交互的物品，其中包含用户可能感兴趣的物品或者用户不感兴趣的物品，为了能够更精确地对每个节点的邻居节点进行扩充，在其中的一些实施例中，对于任意节点，节点/＞扩充后的邻居节点集合的表达式为：其中，为目标节点扩充后的邻居节点集合，/＞为节点编号，/＞为目标节点扩充前的邻居节点集合，/＞为节点/＞新增的邻居节点集合；新增的邻居节点集合包括与节点/＞相似度最高的多个节点。具体的，新增的邻居节点集合的表达式为：其中，函数的表达式为：其中，为节点编号，θ为所述初始图推荐模型的模型参数，U为用户节点集合，I为物品节点集合，/＞为用户节点集合U和物品节点集合I中的任意节点，/＞为/＞范数，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的原始表征向量，/＞为所述节点/＞的度，/＞为所述节点/＞的度，/＞表示节点/＞和/＞的规范化表征向量之间的/＞范数，/＞为所述节点/＞在规范化表征向量的斐波那契范数意义下相似度最高的节点构成的集合。其中，节点的度即为节点的邻居节点数量。在其中的一些实施例中，对于任意节点和节点x，其中，节点x为节点/＞的邻居节点，所述节点/＞和所述节点x之间调整后的边的权重表达式为：其中，为所述节点/＞和所述节点x之间调整后的边的权重，/＞为预设的超参数，为所述节点/＞和所述节点x之间调整前的边的权重，q为所述节点/＞的扩充后的邻居节点。在其中的一些实施例中，步骤S403，根据初始图推荐模型的邻接矩阵确定初始图推荐模型的目标损失，包括：根据邻接矩阵对初始图推荐模型进行聚合操作，确定节点的最终表征向量矩阵；根据节点的最终表征向量矩阵确定初始图推荐模型的目标损失。具体的，根据邻接矩阵对初始图推荐模型进行聚合操作，确定节点的最终表征向量矩阵，包括：根据邻接矩阵对初始图推荐模型中节点的表征向量矩阵进行K次聚合，对每次聚合得到的表征向量矩阵进行加权平均，得到初始图推荐模型中节点的最终表征向量矩阵；其中，K为初始图推荐模型的网络层数。更具体的，对初始图推荐模型中节点的表征向量矩阵进行聚合的表达式为：其中，为经过k次聚合操作后的节点的表征向量矩阵，其中1≤k≤K，/＞为初始图推荐模型的邻接矩阵。节点的最终表征向量矩阵的表达式为：其中，E为节点的最终表征向量矩阵。图推荐模型的目标损失的表达式为：其中，L为目标损失，U为用户节点集合，I为物品节点集合，为用户节点的数量，为物品节点的数量，u为用户节点，v为物品节点，/＞为损失函数，/＞为用户节点的最终表征向量矩阵的转置矩阵，/＞为物品节点的最终表征向量矩阵，/＞为表示用户u是否喜欢物品v的标签值。在其中的一些实施例中，在其中的一些实施例中，步骤S403，对初始图推荐模型进行训练优化目标损失，得到目标图推荐模型，包括：通过梯度下降算法对所述初始图推荐模型的目标损失进行优化，更新初始图推荐模型的参数，得到目标图推荐模型。在本发明中还提供了一种电子设备，包括存储器和处理器，该存储器中存储有计算机程序，该处理器被设置为运行计算机程序以执行上述任一项方法实施例中的步骤。可选地，上述电子设备还可以包括传输设备以及输入输出设备，其中，该传输设备和上述处理器连接，该输入输出设备和上述处理器连接。可选地，在一个实施例中，上述处理器可以被设置为通过计算机程序执行以下步骤：S1，获取待优化的初始图推荐模型，扩充初始图推荐模型中每个节点的邻居节点；其中，节点包括用户节点和物品节点。S2，调整初始图推荐模型中每条边的权重，根据调整后的边的权重确定初始图推荐模型的邻接矩阵。S3，根据初始图推荐模型的邻接矩阵确定初始图推荐模型的目标损失，对初始图推荐模型进行训练优化目标损失，得到目标图推荐模型。需要说明的是，本电子设备的具体示例可以参考上述方法的实施例及可选实施方式中所描述的示例，在本实施例中不再赘述。此外，结合上述本发明中提供的增强图推荐模型鲁棒性的方法，在本发明中还可以提供一种存储介质来实现。该存储介质上存储有计算机程序；该计算机程序被处理器执行时实现上述实施例中的任意一种增强图推荐模型鲁棒性的方法。应该明白的是，这里描述的具体实施例只是用来解释这个应用，而不是用来对它进行限定。根据本申请提供的实施例，本领域普通技术人员在不进行创造性劳动的情况下得到的所有其它实施例，均属本申请保护范围。显然，附图只是本申请的一些例子或实施例，对本领域的普通技术人员来说，也可以根据这些附图将本申请适用于其他类似情况，但无需付出创造性劳动。另外，可以理解的是，尽管在此开发过程中所做的工作可能是复杂和漫长的，但是，对于本领域的普通技术人员来说，根据本申请披露的技术内容进行的某些设计、制造或生产等更改仅是常规的技术手段，不应被视为本申请公开的内容不足。“实施例”一词在本申请中指的是结合实施例描述的具体特征、结构或特性可以包括在本申请的至少一个实施例中。该短语出现在说明书中的各个位置并不一定意味着相同的实施例，也不意味着与其它实施例相互排斥而具有独立性或可供选择。本领域的普通技术人员能够清楚或隐含地理解的是，本申请中描述的实施例在没有冲突的情况下，可以与其它实施例结。
