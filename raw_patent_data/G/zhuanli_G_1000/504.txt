标题title
一种基于改进孪生网络的小样本心电信号分类方法
摘要abst
一种基于改进孪生网络的小样本心电信号分类方法，涉及心电信号分类技术领域，通过构建CMP模块作为孪生网络的子网络，将提取局部特征和全局特征相结合，能够更好的分析波峰的位置、振幅和偏移量等信息，使得转换后的特征向量变得更加鲁棒，从而提高小样本心电信号分类的准确率和稳定性。
权利要求书clms
1.一种基于改进孪生网络的小样本心电信号分类方法，其特征在于，包括如下步骤：a)获取n条原始心电信号，得到原始心电信号集D，D＝{,,...,,...,}，其中xi为第i条原始心电信号，yi为第i条原始心电信号xi对应的类标签，i∈{1,...,n}；b)对原始心电信号集D进行预处理，去除原始心电信号中的噪音，得到干净的心电信号集D′，D′＝{,,...,,...,}，其中x′i为第i条干净的心电信号；c)将第i条干净的心电信号x′i进行归一化操作，得到归一化后的心电信号x″i，如果归一化后的心电信号x″i的序列的长度小于Lmax则对归一化后的心电信号x″i的序列的后面填充零操作，使归一化后的心电信号x″i的序列的长度与Lmax长度相等，得到归一化后的心电信号集D″，D″＝{,,...,,...,}；d)根据归一化后的心电信号集D″创建样本对集P，其中/＞yi-1为第i条原始心电信号xi-1对应的类标签，样本对集P中的样本对个数为M，/＞e)构建小样本分类模型，将样本对集P中的样本对,Y′)输入到小样本分类模型中，输出得到相似度度量值Ew；f)通过损失函数L利用Adam优化器训练小样本分类模型，得到优化后的小样本分类模型；g)在MIT-BIH数据集的N个类别中的每个类别随机抽样K个心电信号构成支持集Ssupprt，Ssupprt＝{,,...,,...,}，其中si为第i个心电信号，ai为第i个心电信号si对应的类标签，i∈{1,...,NK}；h)在MIT-BIH数据集的N个类别中的每个类别随机抽样Q个心电信号构成查询集Squery，Squery＝{,,...,,...,}，其中qi为第i个心电信号，bi为第i个心电信号qi对应的类标签，i∈{1,...,NQ}；i)将第i个心电信号si替代第i条原始心电信号xi后重复执行步骤b)至步骤c)得到第i个归一化后的心电信号s″i，得到归一化后的支持集S″supprt，S″supprt＝{,,...,,...,}，将第i个心电信号qi替代第i条原始心电信号xi后重复执行步骤b)至步骤c)得到第i个归一化后的心电信号q″i，得到归一化后的查询集S″query，S″query＝{,,...,,...,}；j)将第i个归一化后的心电信号s″i及第i个归一化后的心电信号q″i输入到优化后的小样本分类模型中，输出得到分类结果。2.根据权利要求1所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于：步骤a)中从UCR数据集中获取n条原始心电信号。3.根据权利要求1所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于：步骤b)中将第i条原始心电信号xi依次经过第一中值滤波器、第二中值滤波器滤波后去除噪声，得到第i条干净的心电信号x′i。4.根据权利要求3所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于：第一中值滤波器的宽度为300ms，第二中值滤波器的宽度为600ms。5.根据权利要求1所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于：Lmax＝187。6.根据权利要求1所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于，步骤e)包括如下步骤：e-1)小样本分类模型由嵌入模块、度量模块构成；e-2)小样本分类模型的嵌入模块由第一CMP模块与第二CMP模块组成的孪生网络构成，第一CMP模块由卷积层、第一ReLU激活函数层、胶囊网络的主胶囊层、胶囊网络的数字胶囊层、第一全连接层、第二ReLU激活函数层、第二全连接层构成，第二CMP模块由卷积层、第一ReLU激活函数层、胶囊网络的主胶囊层、胶囊网络的数字胶囊层、第一全连接层、第二ReLU激活函数层、第二全连接层构成；e-3)将第i个归一化后的心电信号x″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征f11，将特征f11输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量f12，将向量f12输入到第一CMP模块的胶囊网络的数字胶囊层中，输出得到特征f13，将特征f13依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征f14，将特征f14输入到第一CMP模块的第二全连接层中，输出得到特征f；e-4)将第i+1个归一化后的心电信号x″i+1依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征将特征/＞输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量/＞将向量/＞输入到第一CMP模块的胶囊网络的数字胶囊层中，输出得到特征/＞将特征/＞依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征/＞将特征/＞输入到第一CMP模块的第二全连接层中，输出得到特征f；e-5)将特征f及特征f输入到小样本分类模型的度量模块中，通过公式Ew＝||f-f||计算得到相似度度量值Ew，式中||·||为计算欧式距离操作。7.根据权利要求6所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于：步骤e-2)中第一CMP模块的卷积层的卷积核大小为3×3，第二CMP模块的卷积层的卷积核大小为3×3。8.根据权利要求1所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于：步骤f)中通过公式L＝L1+αL2计算得到损失函数L，式中m为超参数，α为超参数，L2为交叉熵损失函数。9.根据权利要求6所述的基于改进孪生网络的小样本心电信号分类方法，其特征在于，步骤j)包括如下步骤：j-1)将第u类的第i个归一化后的心电信号s″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征u∈{1,...,N}，将特征/＞输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量/＞将向量/＞输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到特征/＞将特征/＞依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征/＞将特征/＞输入到第一CMP模块的第二全连接层中，输出得到特征fu，将第u类的所有K个特征fu,fu,...,fu,...,fu通过Python中的mean函数求平均，得到特征向量μu；j-2)将第i个归一化后的心电信号q″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征将特征/＞输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量/＞将向量/＞输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到特征/＞将特征/＞依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征/＞将特征/＞输入到第一CMP模块的第二全连接层中，输出得到特征f；j-3)将特征向量μu及特征f输入到小样本分类模型的度量模块中，通过公式Ew)＝||μu-f||计算得到相似度度量值Ew)；j-4)通过公式计算得到第i个归一化后的心电信号q″i的类标签/＞所有NQ个归一化后的心电信号的类标签构成分类结果。
说明书desc
技术领域本发明涉及心电信号分类技术领域，具体涉及一种基于改进孪生网络的小样本心电信号分类方法。背景技术近年来，在面对大数据处理的过程中，深度学习的算法模型在人工智能领域取得前所未有的成功，但由于某些类型的心律失常罕见且个体差异较大，所采集的数据有限，因此现有模型的泛化能力和准确性可能受到限制。小样本学习主要作用在神经网络分类器中，仅需要少量的样本进行学习训练，可以高效的对心电信号进行识别分类。发明内容本发明为了克服以上技术的不足，提供了一种提高分类的准确率的基于改进孪生网络的小样本心电信号分类方法。本发明克服其技术问题所采用的技术方案是：一种基于改进孪生网络的小样本心电信号分类方法，包括如下步骤：a)获取n条原始心电信号，得到原始心电信号集D，D＝{,,...,,...,}，其中xi为第i条原始心电信号，yi为第i条原始心电信号xi对应的类标签，i∈{1,...,n}；b)对原始心电信号集D进行预处理，去除原始心电信号中的噪音，得到干净的心电信号集D′，D′＝{,,...,,...,}，其中x′i为第i条干净的心电信号；c)将第i条干净的心电信号x′i进行归一化操作，得到归一化后的心电信号x″i，如果归一化后的心电信号x″i的序列的长度小于Lmax则对归一化后的心电信号x″i的序列的后面填充零操作，使归一化后的心电信号x″i的序列的长度与Lmax长度相等，得到归一化后的心电信号集D″，D″＝{,,...,,...,}；d)根据归一化后的心电信号集D″创建样本对集P，其中/＞yi-1为第i条原始心电信号xi-1对应的类标签，样本对集P中的样本对个数为M，/＞e)构建小样本分类模型，将样本对集P中的样本对,Y′)输入到小样本分类模型中，输出得到相似度度量值Ew；f)通过损失函数L利用Adam优化器训练小样本分类模型，得到优化后的小样本分类模型；g)在MIT-BIH数据集的N个类别中的每个类别随机抽样K个心电信号构成支持集Ssupprt，Ssupprt＝{,,...,,...,}，其中si为第i个心电信号，ai为第i个心电信号si对应的类标签，i∈{1,...,NK}；h)在MIT-BIH数据集的N个类别中的每个类别随机抽样Q个心电信号构成查询集Squery，Squery＝{,,...,,...,}，其中qi为第i个心电信号，bi为第i个心电信号qi对应的类标签，i∈{1,...,NQ}；i)将第i个心电信号si替代第i条原始心电信号xi后重复执行步骤b)至步骤c)得到第i个归一化后的心电信号s″i，得到归一化后的支持集S″supprt，S″supprt＝{,,...,,...,}，将第i个心电信号qi替代第i条原始心电信号xi后重复执行步骤b)至步骤c)得到第i个归一化后的心电信号q″i，得到归一化后的查询集S″query，S″query＝{,,...,,...,}；j)将第i个归一化后的心电信号s″i及第i个归一化后的心电信号q″i输入到优化后的小样本分类模型中，输出得到分类结果。进一步的，步骤a)中从UCR数据集中获取n条原始心电信号。进一步的，步骤b)中将第i条原始心电信号xi依次经过第一中值滤波器、第二中值滤波器滤波后去除噪声，得到第i条干净的心电信号x′i。优选的，第一中值滤波器的宽度为300ms，第二中值滤波器的宽度为600ms。优选的，Lmax＝187。进一步的，步骤e)包括如下步骤：e-1)小样本分类模型由嵌入模块、度量模块构成；e-2)小样本分类模型的嵌入模块由第一CMP模块与第二CMP模块组成的孪生网络构成，第一CMP模块由卷积层、第一ReLU激活函数层、胶囊网络的主胶囊层、胶囊网络的数字胶囊层、第一全连接层、第二ReLU激活函数层、第二全连接层构成，第二CMP模块由卷积层、第一ReLU激活函数层、胶囊网络的主胶囊层、胶囊网络的数字胶囊层、第一全连接层、第二ReLU激活函数层、第二全连接层构成；e-3)将第i个归一化后的心电信号x″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征f11，将特征f11输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量f12，将向量f12输入到第一CMP模块的胶囊网络的数字胶囊层中，输出得到特征f13，将特征f13依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征f14，将特征f14输入到第一CMP模块的第二全连接层中，输出得到特征f；e-4)将第i+1个归一化后的心电信号x″i+1依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征f21，将特征f21输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量f22，将向量f22输入到第一CMP模块的胶囊网络的数字胶囊层中，输出得到特征f23，将特征f23依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征f24，将特征f24输入到第一CMP模块的第二全连接层中，输出得到特征f；e-5)将特征f及特征f输入到小样本分类模型的度量模块中，通过公式Ew＝||f-f||计算得到相似度度量值Ew，式中||·||为计算欧式距离操作。优选的，步骤e-2)中第一CMP模块的卷积层的卷积核大小为3×3，第二CMP模块的卷积层的卷积核大小为3×3。进一步的，步骤f)中通过公式L＝L1+αL2计算得到损失函数L，式中m为超参数，α为超参数，L2为交叉熵损失函数。进一步的，步骤j)包括如下步骤：j-1)将第u类的第i个归一化后的心电信号s″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征f31，u∈{1,...,N}，将特征f31输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量f32，将向量f32输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到特征f33，将特征f33依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征f34，将特征f34输入到第一CMP模块的第二全连接层中，输出得到特征fu，将第u类的所有K个特征fu,fu,...,fu,...,fu通过Python中的mean函数求平均，得到特征向量μu；j-2)将第i个归一化后的心电信号q″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征f41，将特征f41输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量f42，将向量f42输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到特征f43，将特征f43依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征f44，将特征f44输入到第一CMP模块的第二全连接层中，输出得到特征f；j-3)将特征向量μu及特征f输入到小样本分类模型的度量模块中，通过公式Ew)＝||μu-f||计算得到相似度度量值Ew)；j-4)通过公式计算得到第i个归一化后的心电信号q″i的类标签/＞所有NQ个归一化后的心电信号的类标签构成分类结果。本发明的有益效果是：通过构建CMP模块作为孪生网络的子网络，将提取局部特征和全局特征相结合，能够更好的分析波峰的位置、振幅和偏移量等信息，使得转换后的特征向量变得更加鲁棒，从而提高小样本心电信号分类的准确率和稳定性。附图说明图1为本发明的方法流程图；图2为本发明的CMP模块结构图。具体实施方式下面结合附图1、附图2对本发明做进一步说明。一种基于改进孪生网络的小样本心电信号分类方法，包括如下步骤：a)获取n条原始心电信号，得到原始心电信号集D，D＝{,,...,,...,}，其中xi为第i条原始心电信号，yi为第i条原始心电信号xi对应的类标签，i∈{1,...,n}。b)对原始心电信号集D进行预处理，去除原始心电信号中的噪音，得到干净的心电信号集D′，D′＝{,,...,,...,}，其中x′i为第i条干净的心电信号。c)将第i条干净的心电信号x′i进行归一化操作，得到归一化后的心电信号x″i，如果归一化后的心电信号x″i的序列的长度小于Lmax则对归一化后的心电信号x″i的序列的后面填充零操作，使归一化后的心电信号x″i的序列的长度与Lmax长度相等，得到归一化后的心电信号集D″，D″＝{,,...,,...,}。d)根据归一化后的心电信号集D″创建样本对集P，其中/＞yi-1为第i条原始心电信号xi-1对应的类标签，样本对集P中的样本对个数为M，/＞e)构建小样本分类模型，将样本对集P中的样本对,Y′)输入到小样本分类模型中，输出得到相似度度量值Ew。f)通过损失函数L利用Adam优化器训练小样本分类模型，得到优化后的小样本分类模型。g)在MIT-BIH数据集的N个类别中的每个类别随机抽样K个心电信号构成支持集Ssupprt，Ssupprt＝{,,...,,...,}，其中si为第i个心电信号，ai为第i个心电信号si对应的类标签，i∈{1,...,NK}。h)在MIT-BIH数据集的N个类别中的每个类别随机抽样Q个心电信号构成查询集Squery，目标是在给定NK个样本的情况下准确分类NQ个查询，Squery＝{,,...,,...,}，其中qi为第i个心电信号，bi为第i个心电信号qi对应的类标签，i∈{1,...,NQ}。i)将第i个心电信号si替代第i条原始心电信号xi后重复执行步骤b)至步骤c)得到第i个归一化后的心电信号s″i，得到归一化后的支持集S″supprt，S″supprt＝{,,...,,...,}，将第i个心电信号qi替代第i条原始心电信号xi后重复执行步骤b)至步骤c)得到第i个归一化后的心电信号q″i，得到归一化后的查询集S″query，S″query＝{,,...,,...,}。j)将第i个归一化后的心电信号s″i及第i个归一化后的心电信号q″i输入到优化后的小样本分类模型中，输出得到分类结果。本发明提供了一种全新的CMP模块来搭建孪生网络进行小样本心电信号分类，提高分类的准确率在本发明的一个实施例中，步骤a)中从UCR数据集中获取n条原始心电信号。在本发明的一个实施例中，步骤b)中将第i条原始心电信号xi依次经过第一中值滤波器、第二中值滤波器滤波后去除噪声，得到第i条干净的心电信号x′i。在该实施例中，优选的，第一中值滤波器的宽度为300ms，第二中值滤波器的宽度为600ms。在本发明的一个实施例中，Lmax＝187。在本发明的一个实施例中，步骤e)包括如下步骤：e-1)小样本分类模型由嵌入模块、度量模块构成。e-2)小样本分类模型的嵌入模块由第一CMP模块与第二CMP模块组成的孪生网络构成，第一CMP模块由卷积层、第一ReLU激活函数层、胶囊网络的主胶囊层、胶囊网络的数字胶囊层、第一全连接层、第二ReLU激活函数层、第二全连接层构成，第二CMP模块由卷积层、第一ReLU激活函数层、胶囊网络的主胶囊层、胶囊网络的数字胶囊层、第一全连接层、第二ReLU激活函数层、第二全连接层构成。e-3)将第i个归一化后的心电信号x″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，用于提取心电信号x″i的底层特征，输出得到特征f11，将特征f11输入到第一CMP模块的胶囊网络的主胶囊层中，用于将特征转化为矢量，输出得到向量f12，将向量f12输入到第一CMP模块的胶囊网络的数字胶囊层中，对向量f12进行矩阵变换、输入加权、求和、非线性变换，输出得到特征f13，将特征f13依次输入到第一CMP模块的具有O个神经元的第一全连接层、第二ReLU激活函数层中，进行非线性映射，输出得到特征f14，将特征f14输入到第一CMP模块的第二全连接层中，可以将第一全连接层映射到O维空间的嵌入向量输出呈与输入维度相同维度的嵌入向量，输出得到特征f。e-4)将第i+1个归一化后的心电信号x″i+1依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，用于提取心电信号x″i+1的底层特征，输出得到特征f21，将特征f21输入到第一CMP模块的胶囊网络的主胶囊层中，用于将特征转化为矢量，输出得到向量f22，将向量f22输入到第一CMP模块的胶囊网络的数字胶囊层中，对向量f22进行矩阵变换、输入加权、求和、非线性变换，输出得到特征f23，将特征f23依次输入到第一CMP模块的具有O个神经元的第一全连接层、第二ReLU激活函数层中，进行非线性映射，输出得到特征f24，将特征f24输入到第一CMP模块的第二全连接层中，可以将第一全连接层映射到O维空间的嵌入向量输出呈与输入维度相同维度的嵌入向量，输出得到特征f。e-5)将特征f及特征f输入到小样本分类模型的度量模块中，通过公式Ew＝||f-f||计算得到相似度度量值Ew，式中||·||为计算欧式距离操作。在该实施例中，步骤e-2)中第一CMP模块的卷积层的卷积核大小为3×3，第二CMP模块的卷积层的卷积核大小为3×3。步骤f)中通过公式L＝L1+αL2计算得到损失函数L，式中L1为用于调节孪生网络损失函数，m为超参数，α为超参数，L2为交叉熵损失函数。进一步的，α＝5，m＝5。整个总损失L同时兼顾了样本的距离与特征分类。步骤j)包括如下步骤：j-1)将第u类的第i个归一化后的心电信号s″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征f31，u∈{1,...,N}，将特征f31输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量f32，将向量f32输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到特征f33，将特征f33依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征f34，将特征f34输入到第一CMP模块的第二全连接层中，输出得到特征fu，将第u类的所有K个特征fu,fu,...,fu,...,fu通过Python中的mean函数求平均，得到特征向量μu。j-2)将第i个归一化后的心电信号q″i依次输入到第一CMP模块的卷积层、第一ReLU激活函数层中，输出得到特征f41，将特征f41输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到向量f42，将向量f42输入到第一CMP模块的胶囊网络的主胶囊层中，输出得到特征f43，将特征f43依次输入到第一CMP模块的第一全连接层、第二ReLU激活函数层中，输出得到特征f44，将特征f44输入到第一CMP模块的第二全连接层中，输出得到特征f。j-3)将特征向量μu及特征f输入到小样本分类模型的度量模块中，通过公式Ew)＝||μu-f||计算得到相似度度量值Ew)。j-4)通过公式计算得到第i个归一化后的心电信号q″i的类标签/＞所有NQ个归一化后的心电信号的类标签构成分类结果。最后应说明的是：以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
