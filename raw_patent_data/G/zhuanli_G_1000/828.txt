标题title
一种幅频响应和相频响应的补偿装置、补偿方法及示波器
摘要abst
一种幅频响应和相频响应的补偿装置、补偿方法及示波器，涉及测量领域。该装置包括模数转换模块、滤波模块、延时调整模块和加法模块。模数转换模块用于获取示波器通道输出数据的模拟量，并转换为数字量；滤波模块对输出数据进行抽取，以对抽取后的输出数据的数字量在各频段上进行对应幅频调整，以完成各频段的幅频响应的补偿；延时调整模块获取幅频响应补偿后的各频段，根据各频段的相位差分别对每个频段对应进行延时，分别生成每一个频段上对应的相频数字量；加法模块将每一个频段上的相频数字量按对应的次序依次相加，以完成各频段的相频响应的补偿。本申请提供一种幅频响应和相频响应可以同时补偿的补偿装置、补偿方法及示波器。
权利要求书clms
1.一种幅频响应和相频响应的补偿装置，其特征在于，应用于示波器，包括：模数转换模块，用于获取示波器通道输出数据的模拟量，并将输出数据的模拟量转换为输出数据的数字量；滤波模块，连接于所述模数转换模块，所述滤波模块对所述输出数据进行抽取，以对抽取后的输出数据的数字量在各频段上进行对应幅频调整，以完成各频段的幅频响应的补偿；延时调整模块，连接于所述滤波模块，所述延时调整模块获取幅频响应补偿后的各频段，根据各频段的相位差分别对每个频段对应进行延时，分别生成每一个频段上对应的相频数字量；加法模块，连接于所述延时调整模块，将每一个频段上对应的相频数字量按对应的次序依次相加，以完成各频段的相频响应的补偿。2.如权利要求1所述的幅频响应和相频响应的补偿装置，其特征在于，所述滤波模块至少包括低通滤波器、高通滤波器和带通滤波器的任意两种：所述低通滤波器，用于根据抽取的所述输出数据的衰减程度或增益程度对所述输出数据的数字量的低频段进行相反的幅频调整；所述高通滤波器，用于根据抽取的所述输出数据的衰减程度或增益程度对所述输出数据的数字量的高频段进行相反的幅频调整；所述带通滤波器，用于根据抽取的所述输出数据的衰减程度或增益程度对所述输出数据的数字量的设定频段进行相反的幅频调整。3.如权利要求1所述的幅频响应和相频响应的补偿装置，其特征在于，所述模数转换模块根据预设的时钟在所述输出数据的模拟量上生成原始采样点，以使幅频响应补偿后的各频段包含所述原始采样点。4.如权利要求3所述的幅频响应和相频响应的补偿装置，其特征在于，所述延时调整模块包括：插值模块，用于对幅频响应补偿后的各频段的原始采样点中相邻两个采样点之间进行插值，以拟合出设定数量的采样点；若干个延时寄存器，所述若干个延时寄存器依次串联，用于对幅频响应补偿后的各频段中的采样点进行延时移动，以补偿各频段的相位畸变；抽样模块，用于对相位对齐后的各频段采样点进行抽样，还原到所述原始采样点数量的采样点，以生成各频段的相频数字量。5.如权利要求4所述的幅频响应和相频响应的补偿装置，其特征在于，所述加法模块将各频段的相频数字量中的采样点对应相加，以完成输出数据相频响应的补偿。6.如权利要求4所述的幅频响应和相频响应的补偿装置，其特征在于，所述设定数量为原始采样点数量的整倍数；所述延时寄存器的数量与各采样点的延时次数成正比；所述延时寄存器对各采样点的延时间距与采样点的数量成反比。7.如权利要求2所述的幅频响应和相频响应的补偿装置，其特征在于，所述低通滤波器包括FIR低通滤波器，所述高通滤波器包括FIR高通滤波器。8.如权利要求1所述的幅频响应和相频响应的补偿装置，其特征在于，通过网络分析仪确定示波器通道的输入端和输出端的相位的差值，以确定所述相位差。9.一种幅频响应和相频响应的补偿方法，其特征在于，应用于示波器，包括：获取示波器通道输出数据的模拟量，并将输出数据的模拟量转换为输出数据的数字量；对所述输出数据进行抽取，以对抽取后的数字量在各频段上进行对应幅频调整，以生成各频段的幅频响应的补偿；获取幅频响应补偿后的各频段，根据各频段的相位差分别对每个频段对应进行延时，分别生成每一个频段上对应的相频数字量；将每一个频段上对应的相频数字量按对应的次序依次相加，以完成各频段的相频响应的补偿。10.一种示波器，其特征在于，包括：前端模拟电路，用于生成各示波器通道输出数据的模拟量；幅频响应和相频响应的补偿装置，所述补偿装置采用权利要求1-8中任意一条所述的补偿装置。
说明书desc
技术领域本申请涉及测量领域，具体涉及一种幅频响应和相频响应的补偿装置、补偿方法及示波器。背景技术示波器的通道指标中，幅频响应和相频响应是其中重要的指标，但是由于受限于硬件电路的结构、成本、尺寸，从而导致幅频响应和相频响应不及设计与其或者需要花费较大的成本和尺寸代价才能改善。现有的方案通常是优先由硬件电路来保证幅频响应和相频响应，后级加以数字低通滤波来补偿，通常使用的是单一的FIR数字滤波。在使用FIR数字滤波进行幅频响应的补偿时，一般使用更多的是FIR低通滤波器，其一般为线性相频特性，也仅能补偿幅频响应，难以调整相频响应。发明内容本申请主要解决的技术问题是：提供一种同时补偿相频响应和幅频响应的补偿装置、补偿 方法及示波器。根据第一方面，一种实施例中提供一种幅频响应和相频响应的补偿装置，应用于示波器，包括：模数转换模块，用于获取示波器通道输出数据的模拟量，并将输出数据的模拟量转换为输出数据的数字量；滤波模块，连接于所述模数转换模块，所述滤波模块对所述输出数据进行抽取，以对抽取后的输出数据的数字量在各频段上进行对应幅频调整，以完成各频段的幅频响应的补偿；延时调整模块，连接于所述滤波模块，所述延时调整模块获取幅频响应补偿后的各频段，根据各频段的相位差分别对每个频段对应进行延时，分别生成每一个频段上对应的相频数字量；加法模块，连接于所述延时调整模块，将每一个频段上对应的相频数字量按对应的次序依次相加，以完成各频段的相频响应的补偿。一种实施例中，滤波模块至少包括低通滤波器、高通滤波器和带通滤波器的任意两种：所述低通滤波器，用于根据抽取的所述输出数据的衰减程度或增益程度对所述输出数据的数字量的低频段进行相反的幅频调整；所述高通滤波器，用于根据抽取的所述输出数据的衰减程度或增益程度对所述输出数据的数字量的高频段进行相反的幅频调整；所述带通滤波器，用于根据抽取的所述输出数据的衰减程度或增益程度对所述输出数据的数字量的设定频段进行相反的幅频调整。一种实施例中，所述模数转换模块根据预设的时钟在所述输出数据的模拟量上生成原始采样点，以使幅频响应补偿后的各频段包含所述原始采样点。一种实施例中，所述延时调整模块包括：插值模块，用于对幅频响应补偿后的各频段的原始采样点中相邻两个采样点之间进行插值，以拟合出设定数量的采样点；若干个延时寄存器，所述若干个延时寄存器依次串联，用于对幅频响应补偿后的各频段中的采样点进行延时移动，以补偿各频段的相位畸变；抽样模块，用于对相位对齐后的各频段的采样点进行抽样，还原到所述原始采样点数量的采样点，以生成各频段的相频数字量。一种实施例中，所述加法模块将各频段的相频数字量中的采样点对应相加，以完成输出数据的幅频响应和相频响应的补偿。一种实施例中，所述设定数量为原始采样点数量的整倍数；所述延时寄存器的数量与各采样点的延时次数成正比；所述延时寄存器对各采样点的延时间距与采样点的数量成反比。一种实施例中，所述低通滤波器包括FIR低通滤波器，所述高通滤波器包括FIR高通滤波器。一种实施例中，通过网络分析仪确定示波器通道的输入端和输出端的相位的差值，以确定所述相位差。根据第二方面，一种实施例中提供一种幅频响应和相频响应的补偿方法，应用于示波器，包括：获取示波器通道输出数据的模拟量，并将输出数据的模拟量转换为输出数据的数字量；对所述输出数据进行抽取，以对抽取后的数字量在各频段上进行对应幅频调整，以生成各频段的幅频响应的补偿；获取幅频响应补偿后的各频段，根据各频段的相位差分别对每个频段对应进行延时，分别生成每一个频段上对应的相频数字量；将每一个频段上对应的相频数字量按对应的次序依次相加，以完成各频段的相频响应的补偿。根据第三方面，一种实施例提供一种示波器，包括：前端模拟电路，以生成各示波器通道输出数据的模拟量；幅频响应和相频响应的补偿装置，所述补偿装置采用上述任意一个实施例中所述的补偿装置。根据上述实施例的幅频响应和相频响应的补偿装置、补偿方法及示波器，在补偿装置中包括模数转换模块、滤波模块和延时调整模块。先利用模数转换模块将示波器通道输出数据的模拟量转换为输出数据的数字量。接着利用滤波模块对输出数据进行抽取，以对抽取后的输出数据的数字量在各频段上进行对应幅频调整。再利用延时调整模块根据各频段的相位差对每个频段对应进行延时，以分别生成每个频段上对应的相频数字量。最后再将每个频段上对应的数字量按照对应的次序依次相加，从而完成了输出数据的相频响应的补偿。本申请将示波器前端模拟电路输出的模拟量转换为数字量，减轻了对前端模拟电路依赖，可以使用标准的数字器件进行处理，降低设计复杂度。在该数字量的基础上根据实际情况利用滤波模块进行相应的幅频调整，再利用延时调整模块同样进行相应的相频调整，从而最终实现任意幅频响应和相频响应的补偿，使用更加灵活，且相对于纯模拟量的方式，补偿精度更高。附图说明图1为一种实施例的幅频响应和相频响应的补偿装置的结构示意图；图2为一种实施例的幅频响应和相频响应的补偿装置的滤波模块的结构示意图；图3为一种实施例的幅频响应和相频响应的补偿装置的滤波模块的效果图；图4为一种实施例的幅频响应和相频响应的补偿装置的延时调整模块的结构示意图；图5为一种实施例的包含原始采样点的各频段的示意图；图6为一种实施例的拟合出原始采样点数量的整倍数的采样点的各频段的示意图；图7为一种实施例的延时后的各频段的示意图；图8为一种实施例的还原到原始采样点的数量各频段的示意图；图9为另一种实施例的幅频响应和相频响应的补偿方法的流程图；图10为另一种实施例的示波器的结构示意图。具体实施方式下面通过具体实施方式结合附图对本申请作进一步详细说明。其中不同实施方式中类似元件采用了相关联的类似的元件标号。在以下的实施方式中，很多细节描述是为了使得本申请能被更好的理解。然而，本领域技术人员可以毫不费力的认识到，其中部分特征在不同情况下是可以省略的，或者可以由其他元件、材料、方法所替代。在某些情况下，本申请相关的一些操作并没有在说明书中显示或者描述，这是为了避免本申请的核心部分被过多的描述所淹没，而对于本领域技术人员而言，详细描述这些相关操作并不是必要的，他们根据说明书中的描述以及本领域的一般技术知识即可完整了解相关操作。另外，说明书中所描述的特点、操作或者特征可以以任意适当的方式结合形成各种实施方式。同时，方法描述中的各步骤或者动作也可以按照本领域技术人员所能显而易见的方式进行顺序调换或调整。因此，说明书和附图中的各种顺序只是为了清楚描述某一个实施例，并不意味着是必须的顺序，除非另有说明其中某个顺序是必须遵循的。本文中为部件所编序号本身，例如“第一”、“第二”等，仅用于区分所描述的对象，不具有任何顺序或技术含义。而本申请所说“连接”、“联接”，如无特别说明，均包括直接和间接连接。请参考图1，本申请提供一种幅频响应和相频响应的补偿装置100，该装置应用于示波器，其包括模数转换模块110、滤波模块120、延时调整模块130和加法模块140，下面进行具体阐述。其中，幅频响应是探讨频率和幅度的关系，一个信号通常包含很多频率，通过某电路时，不同频率所获得的增益或衰减是不同的；相频响应是探讨不同频率通过某电路时所造成的相位偏移问题。一种实施例中，模数转换模块110用于获取示波器通道输出数据的模拟量，并将输出数据的模拟量转换为输出数据的数字量。模数转换模块110根据预设的时钟在输出数据的模拟量上生成原始采样点。一种实施例中，滤波模块120连接于模数转换模块110，滤波模块120对输出数据进行抽取对抽取后的输出数据的数字量在各频段上进行对应的幅频调整，以完成各频段的幅频响应的补偿。其中，抽取的输出数据的数字量的各频段可以是有次序的频段，也可以是间隔的频段，也可以是其他预设的任意频段。请参考图2，一种实施例中，滤波模块120包括至少低通滤波器121、高通滤波器122和带通滤波器123中的任意两种。低通滤波器121用于根据抽取的输出数据的衰减程度或增益程度对输出数据的数字量的低频段进行相反的幅频调整，也即，当提前预知抽取的输出数据为衰减时，低通滤波器121根据该衰减程度对输出数据的数字量进行相应程度的增益；当提前预知抽取的输出数据为增益时，低通滤波器121根据该增益程度对输出数据的数字量进行相应程度的衰减。高通滤波器122用于根据抽取的输出数据的衰减程度或增益程度对输出数据的数字量的高频段进行相反的幅频调整，也即，当提前预知抽取的输出数据为衰减时，高通滤波器122根据该衰减程度对输出数据的数字量进行相应程度的增益；当提前预知抽取的输出数据为增益时，高通滤波器122根据该增益程度对输出数据的数字量进行相应程度的衰减。一种实施例中，低通滤波器121和高通滤波器122分别采用FIR低通滤波器和FIR高通滤波器。FIR低通滤波器和FIR高通滤波器均是一种数字滤波器，它对数字信号进行处理。这类滤波器的特点是其脉冲响应是有限的，因此可以在有限的时间内完全响应一个输入信号。FIR低通滤波器和FIR高通滤波器的输入和输出都是数字信号，通常是以离散时间步长的形式表示。并且，FIR低通滤波器和FIR高通滤波器有线性相频特性，不会对信号的相位产生非线性的偏移，也即相位响应是线性的，不同频率的信号组成部分在经过滤波器后的相对相位关系保持不变。请参考图3，FIR低通滤波器和FIR高通滤波器的幅频响应在各个频点叠加后与通道自身的幅频响应具有相反的特征，从而补偿通道的幅频响应，使之更加平坦。一种实施例中，带通滤波器123也采用FIR带通滤波器，FIR带通滤波器用于根据抽取的输出数据的衰减程度或增益程度对输出数据的数字量的设定频段进行相反的幅频调整。FIR带通滤波器是一种电子滤波器，允许特定频率范围的信号通过，而阻止其他频率的信号。一种实施例中，延时调整模块130连接于滤波模块120，延时调整模块130获取幅频响应补偿后的各频段，根据各频段的相位差分别对每个频段进行延时，分别生成各频段的相频数字量。一种实施例中，各滤波器的输出可以连接到同一个延时调整模块130，则该延时调整模块130对获取到不同频段的相频数字量分别进行处理。各滤波器的输出也可以分别连一个延时调整模块130，如图2中的延时调整模块130a和延时调整模块130b，每个延时调整模块130只针对连接路的滤波器进行处理。请参考图4，一种实施例中，延时调整模块130包括插值模块131、若干个延时寄存器132和抽样模块133。一种实施例中，由于模数转换模块110在输出数据的模拟量上生成了原始采样点，所以幅频响应补偿后的各频段也包含原始采样点。插值模块131根据各频段的原始采样点中相邻两个采样点之间进行插值，以拟合出设定数量的采样点。请参考图5为包含原始采样点的各频段的示意图，在该原始采样点中相邻两个采样点之间进行插值，以拟合出原始采样点数量的整倍数的采样点，以得到图6。插值模块131可以采用sin插值法或者线性插值等方法。一种实施例中，若干个延时寄存器132依次串联，用于对幅频响应补偿后的各频段中的采样点进行延时移动，以补偿各频段的相位畸变，以得到图7。例如，在低频和高频的一对相对应的采样点中，低通滤波器121输出的低频的相位超前于高通滤波器122输出的高频的相位，则将低频中的该采样点延时移动至与高频的采样点相同的时间轴。延时寄存器132的数量与各采样点的延时次数成正比，延时寄存器132数量越多，则各采样点的延时次数越多。并且，延时寄存器对各采样点的延时间距与采样点的数量有关，也就是，各采样点的延时间距越短采样点数量越多，其中，延时间距可以通过控制延时寄存器132进行人为设定。需要说明的是，在数字信号处理中，利用延时寄存器132对采样点进行延时移动可以实现相位调整的原因涉及到信号的离散性质和采样定理。数字信号是以离散的形式存在的，即信号在时间上以一系列离散的采样点表示。因此，通过对这些采样点进行延时移动，实际上是在时间轴上进行相位调整。采样定理指出，一个信号的完整信息可以由其采样值确定，前提是采样频率满足一定条件。在离散时间系统中，采样率是一个重要的参数。当对高频数字信号进行采样时，采样率必须足够高，以确保完整捕捉信号的高频信息。相应地，通过对低频数字信号进行适当的延时移动，可以调整相位，因为这等效于在时间域上移动信号。举例来说，考虑一个高频信号，它的一个周期在离散时间中可能包含很多个采样点。通过延时移动一定数量的采样点，实际上在时间轴上将信号的起始点移动了，从而改变了相位。一种实施例中，抽样模块133用于对相位对齐后的各频段的采样点进行抽样，还原到原始采样点数量的采样点，以生成各频段的相频数字量。也即，将改变了相位后的各频段中的采样点进行等间距抽样，以还原到原始采样点的数量，最终生成各频段的相频数字量，如图8所示。需要说明的是，各频段的相位差是在信号源-示波器通道-模数转换模块中产生，示波器通道会导致输出数据的相频或者幅频的畸变，因此各频段相位差可以通过网络分析仪测得示波器通道输入端和输出端的相位的差值确定。其中，相位差的获取只要在延时调整模块130之前即可，具体在模数转换模块110之前或之后不做限定。一种实施例中，加法模块140将各频段的相频数字量中的采样点对应相加，从而完成输出数据的相频响应的补偿。从滤波模块120输出的各频段经过延时调整模块130对各频段进行移相，以调整各频段的相频响应，最后再将各频段的信号相加为一个信号，即可完成相频响应的调整。需要说明的是，延时寄存器132用于数字信号处理领域，延时寄存器132的作用是将信号在时域上进行延时，因此延时寄存器132对采样点的延时移动可以被认为是在时域上进行的。延时寄存器132通过在采样点上引入一定的延时，实现了对信号的时间推移，从而影响信号的时域特性，这种延时移动在时域上的效果用来调整输出数据的相位。加法模块140将各采样点对应相加，从而便完成了各频段的相频相应的补偿。在频域上，利用延时寄存器132对采样点进行延时移动会引起相位变化，这是因为频域分析涉及到信号的频率成分，而延时操作会导致不同频率的成分在时间上发生相位偏移。以正弦波信号为例，如果在时域上对信号进行延时，相当于在频域上引入了线性相位变化，具体来说，对于正弦波信号，相位偏移的大小与频率成正比，这意味着延时寄存器132引入了频域上的线性相位变化。在频域中，加法模块140对应于将各频段的相频数字量中的相应采样点进行相加，也就是将各频段的相频数字量中各采样点的幅度和相位对应相加，从而便完成了各频段的相频相应的补偿。请参考图9，作为另一种实施例中，本申请还提供一种幅频响应和相频响应的补偿方法，该补偿方法应用于上述任意一个实施例中的补偿装置100，包括如下步骤。步骤S100：获取示波器通道输出数据的模拟量，并将输出数据的模拟量转换为输出数据的数字量。一种实施例中，利用模数转换模块110获取示波器通道输出数据的模拟量，并将输出数据的模拟量转换为输出数据的数字量。模数转换模块110根据预设的时钟在输出数据的模拟量上生成原始采样点。步骤S200：对输出数据进行抽取，以对抽取后的数字量在各频段上进行对应幅频调整，以生成各频段的幅频响应的补偿。一种实施例中，滤波模块120对输出数据进行抽取，对抽取后的输出数据的数字量在各频段上进行对应的幅频调整，以完成各频段的幅频响应的补偿。抽取的输出数据的数字量的各频段可以是有次序的频段，也可以是间隔的频段，也可以是其他预设的任意频段。其中，滤波模块包括低通滤波器、高通滤波器和带通滤波器。低通滤波器用于根据抽取的输出数据的衰减程度或增益程度对输出数据的数字量的低频段进行相反的幅频调整，高通滤波器用于根据抽取的输出数据的衰减程度或增益程度对输出数据的数字量的高频段进行相反的幅频调整，带通滤波器用于根据抽取的输出数据的衰减程度或增益程度对输出数据的数字量的设定频段进行相反的幅频调整。步骤S300：获取幅频响应补偿后的各频段，根据各频段的相位差分别对每个频段对应进行延时，分别生成每一个频段上对应的相频数字量。一种实施例中，利用延时调整模块获取幅频调整后的各频段，根据各频段的相位差分别对每个频段进行延时，分别生成各频段的相频数字量。其中，延时调整模块包括插值模块、若干个延时寄存器和抽样模块。步骤S400：将每一个频段的相频数字量按照对应的次序相加，以完成各频段的相频响应的补偿。一种实施例中，由于模数转换模块在输出数据的模拟量上生成了原始采样点，所以幅频响应补偿后的各频段也包含原始采样点。插值模块对各频段的原始采样点中相邻两个采样点之间进行插值，以拟合出设定数量的采样点。若干个延时寄存器依次串联，对幅频响应补偿后的各频段中的采样点进行延时移动，以补偿各频段的相位畸变。抽样模块用于对相位对齐后的各频段的采样点进行抽样，还原到原始采样点数量的采样点，以生成各频段的相频数字量。一种实施例中，利用加法模块将各频段的相频数字量中的采样点对应相加，从而完成输出数据的相频响应的补偿。从滤波模块输出的各频段经过延时调整模块对各频段进行移相，以调整各频段的相频响应，最后再将各频段的信号相加为一个信号，即可完成相频响应的调整。请参考图10，本申请还有一种实施例提供一种示波器，该示波器包括前端模拟电路200和幅频响应和相频响应的补偿装置100。前端模拟电路200用于生成各示波器通道输出数据的模拟量，幅频响应和相频响应的补偿装置100采用上述任意一个实施例中所述的补偿装置100，由于该补偿装置100已经在上述实施例中阐述清楚，此处不再赘述。以上应用了具体个例对本发明进行阐述，只是用于帮助理解本发明，并不用以限制本发明。对于本发明所属技术领域的技术人员，依据本发明的思想，还可以做出若干简单推演、变形或替换。
