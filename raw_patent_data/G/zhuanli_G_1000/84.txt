标题title
一种基于残差密集U形网络的图像去模糊模型及方法
摘要abst
本发明提供一种基于残差密集U形网络的图像去模糊模型及方法，包括：应用于第一阶段的梯度残差密集混合U形子网络，用于粗略获取模糊图像的多分辨率特征，并提取模糊图像边缘信息；应用于第二、三、四阶段的梯度残差密集多尺度卷积注意力U形子网络，用于获得更加精细的模糊图像的多分辨率特征；同时引入特征监督注意力模块连接两个阶段并进行特征融合。本发明的基于残差密集网络的图像去模糊模型及方法使网络训练更加稳定，能够极大地减少特征图信息的丢失，进而实现模糊图像复原的效果。
权利要求书clms
1.一种基于残差密集U形网络的图像去模糊模型，其特征在于，包括：梯度残差密集混合U形子网络，粗略获取模糊图像的多分辨率特征，所述梯度残差密集混合U形子网络应用于第一阶段；梯度残差密集多尺度卷积注意力U形子网络，获得更加精细的所述模糊图像的所述多分辨率特征，所述梯度残差密集多尺度卷积注意力U形子网络应用于第二阶段、第三阶段和第四阶段；特征监督注意力模块SAM，融合不同阶段的多尺度特征信息。2.根据权利要求1所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述梯度残差密集混合U形子网络包括：梯度残差密集混合编码网络，所述梯度残差密集混合编码网络包括：三个通道注意力模块，突出模糊块的重要特征；三组密集残差混合U形模块GRDB_RSU4Mix Block×L1；两个下采样模块，采用扩张因子为0.5的上采样函数并加入了1×1卷积层，每次通过下采样操作特征尺度缩小为原来的1/2，通道数增加ex_factor，所述ex_factor设置为32；梯度残差密集混合解码网络，所述梯度残差密集混合解码网络包括：三个通道注意力模块，突出模糊块的重要特征；三组密集残差混合U形模块GRDB_RSU4Mix Block×L1；两组上采样模块，采用两组1×1卷积核的卷积层；跳连接模块，采用一组通道注意力模块，通过所述通道注意力模块将所述梯度残差密集混合编码网络提取的特征信息送入所述梯度残差密集混合解码网络。3.根据权利要求2所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述密集残差混合U形模块GRDB_RSU4Mix Block×L1包括：密集残差模块GRDB Block，所述密集残差模块GRDB Block包括两组3×3卷积核的卷积层，两组GELU的激活层密集连接，最后在残差支路中加入Sobel梯度运算来计算特征的梯度幅度并使用一个1×1卷积层跳连来消除输入输出通道维度的不同；残差混合U形模块RSU4Mix Block，所述残差混合U形模块RSU4Mix Block包括：输入深度卷积层，所述输入深度卷积层包括一组3×3卷积核的深度卷积层，所述输入深度卷积层将输入特征 变为通道数为64的中间输入特征/＞ ；深度卷积编码子网络，所述深度卷积编码子网络包括三组3×3卷积核的深度卷积层，两组最大池化层模拟下采样操作，经过所述深度卷积编码子网络后输出特征；深度卷积解码子网络，包括三组3×3卷积核的深度卷积层，两组特征混合模块MixBlock，三组残差连接模块，所述深度卷积解码子网络将局部特征和多尺度特征进行融合；级联深度卷积模块，包括一组3×3卷积核的深度卷积层，用以将所述深度卷积编码子网络提取的所述特征传递到所述深度卷积解码子网络中。4.根据权利要求3所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述残差混合U形模块RSU4Mix Block包括：输入深度卷积层，所述输入深度卷积层包括一组3×3卷积核的深度卷积层，所述输入深度卷积层将输入特征 变为通道数为64的中间输入特征/＞ ；深度卷积编码子网络，所述深度卷积编码子网络包括三组3×3卷积核的深度卷积层，两组最大池化层模拟下采样操作，经过所述深度卷积编码子网络后输出特征；深度卷积解码子网络，包括三组3×3卷积核的深度卷积层，两组特征混合模块MixBlock，三组残差连接模块，所述深度卷积解码子网络将局部特征和多尺度特征进行融合；级联深度卷积模块，包括一组3×3卷积核的深度卷积层，用以将所述深度卷积编码子网络提取的所述特征传递到所述深度卷积解码子网络中。5.根据权利要求4所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述特征混合模块Mix Block的操作如下：将下采样层处理的特征信息和下一层的上采样层的信息进行自适应混合操作来融合这两层的信息并将所述特征信息传入到下一个上采样层，自适应混合操作公式化为：，其中和/＞分别来自第i-1个下采样层的特征图和第i个上采样层的特征图，/＞表示第i+1个上采样层的特征图，其中i为2或3，/＞表示自适应混合操作因子，用于融合第i-1个下采样的特征图和第i个上采样的特征图，其中/＞由Sigmoid算子/＞决定。6.根据权利要求1所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述梯度残差密集多尺度卷积注意力U形子网络包括：梯度残差密集多尺度卷积注意力编码网络，所述梯度残差密集多尺度卷积注意力编码网络包括：三个通道注意力模块，突出模糊块的重要特征；三组梯度残差密集多尺度卷积注意力模块GRDB_MSCA Block×L1；两个下采样模块，采用扩张因子为0.5的上采样函数并加入1×1卷积层，通过下采样操作特征尺度缩小为原来的1/2，通道数增加ex_factor，所述ex_factor设置为32；梯度残差密集多尺度卷积注意力解码网络；跳连接模块，采用一组通道注意力模块，通过所述通道注意力模块将所述梯度残差密集多尺度卷积注意力编码网络提取的特征信息送入所述梯度残差密集多尺度卷积注意力解码网络。7.根据权利要求6所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述梯度残差密集多尺度卷积注意力模块GRDB_MSCA Block×L1包括：密集残差模块GRDB Block，所述密集残差模块GRDB Block包括两组3×3卷积核的卷积层，两组GELU的激活层密集链接，最后在残差支路中加入Sobel梯度运算来计算特征的梯度幅度并使用一个1×1卷积层跳连来消除输入输出通道维度的不同；多尺度卷积注意力模块MSCA Block。8.根据权利要求7所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述多尺度卷积注意力模块MSCA Block包括：第一层，所述第一层包括一组5×5的深度可分离卷积，所述第一层聚集图像信息；第二层，所述第二层包括一组7×7普通卷积层、一组11×11普通卷积层及一组21×21普通卷积层；第三层，所述第三层包括一组7×7的深度过参数化卷积层、一组11×11的深度过参数化卷积层及一组21×21的深度过参数化卷积层，所述第三层深度提取特征信息；第四层，所述第四层包括一组1×1的深度过参数化卷积层，所述第四层模拟信道关系。9.根据权利要求8所述的一种基于残差密集U形网络的图像去模糊模型，其特征在于，所述多尺度卷积注意力模块进行提取特征的步骤为：，，其中分别为输出，注意力图和特征的输入，/＞表示各个元素矩阵的乘法运算，/＞为深度过参数化卷积，/＞由两层卷积构成，第一层使用Depthwise Conv，每个卷积核对应输出的每一个通道；第二层使用Pointwise Conv；为连接输入处，其中/＞。10.一种基于残差密集U形网络的图像去模糊模型方法，其特征在于，包括：第一阶段、将模糊图像分为八个大小相同的模糊块送入梯度残差密集混合U形子网络，粗略提取所述模糊图像的多分辨率特征，并提取所述模糊图像的边缘信息，将处理后的图像块两两拼接，通过特征监督注意力模块SAM输入到第二阶段；第二阶段、将所述模糊图像分为四个大小相同的模糊块，并与所述第一阶段处理过的图像块进行特征融合后送入梯度残差密集多尺度卷积注意力U形子网络，获得更加精细的所述模糊图像的多分辨率特征，将处理后的图像块两两拼接，通过所述特征监督注意力模块SAM输入到第三阶段；第三阶段、将所述模糊图像分为两个大小相同的模糊块，并与所述第二阶段处理过的图像块进行特征融合后送入所述梯度残差密集多尺度卷积注意力U形子网络，获得更加精细的所述模糊图像的多分辨率特征，将处理后的图像块两两拼接，通过所述特征监督注意力模块SAM输入到第四阶段；第四阶段、将完整图像与所述第三阶段处理过的图像块进行特征融合后，所述梯度残差密集多尺度卷积注意力U形子网络获得最终清楚的图像。
说明书desc
技术领域本发明涉及人工智能技术领域，具体涉及一种基于残差密集U形网络的图像去模糊模型及方法。背景技术目前，基于深度学习的图像去模糊技术在稳步发展，该技术主要基于卷积神经网络，利用卷积神经网络进行图像去模糊的大致步骤为：首先，准备一组模糊图像和对应的清晰图像作为数据集，还需要对数据集进行预处理，如裁剪、缩放、旋转等操作，以增加数据的多样性和丰富性，处理后的数据集分为训练集和测试集；其次设计一个适合图像去模糊的卷积神经网络，通常包括卷积层、反卷积层、残差块、生成器网络、判别器网络等。其中卷积层对输入图像进行卷积操作提取图像的特征，反卷积层用于将低分辨率的特征图恢复到高分辨率的图像实现图像的上采样，残差块用于解决深度网络训练中的梯度消失问题，生成器网用于将模糊图像映射到清晰图像，判别器网络用于区分生成的清晰图像和真实清晰图像的差异。然后，使用准备好的模糊数据集训练卷积神经网络模型，并通过反向传播算法和梯度下降法等优化算法，不断调整卷积神经网络模型参数，以逐步提高模型性能，最后通过测试集进行测试，评估模型在去模糊任务中的性能，如峰值信噪比、结构相似性指标、均方根误差三种公认的客观评价指标对处理后的图像进行评价。深度学习的方法已经在图像去模糊领域上取得了重大成功，但是多数方法普遍存在对模糊图像的细节特征提取不足，边缘特征丢失严重，导致复原图像的细节方面依然模糊。有鉴于此，有必要提出一种基于残差密集U形网络的图像去模糊模型，以解决上述问题。发明内容本发明的目的在于提供一种能复原模糊图像的基于残差密集网络的图像去模糊模型。为实现上述目的，本发明采用以下技术方案，包括：梯度残差密集混合U形子网络，粗略获取模糊图像的多分辨率特征，所述梯度残差密集混合U形子网络应用于第一阶段；梯度残差密集多尺度卷积注意力U形子网络，获得更加精细的所述模糊图像的所述多分辨率特征，所述梯度残差密集多尺度卷积注意力U形子网络应用于第二阶段、第三阶段和第四阶段；特征监督注意力模块SAM，融合不同阶段的多尺度特征信息。作为本发明的进一步改进，所述梯度残差密集混合U形子网络包括：梯度残差密集混合编码网络，所述梯度残差密集混合编码网络包括：三个通道注意力模块，突出模糊块的重要特征；三组密集残差混合U形模块GRDB_RSU4Mix Block×L1；两个下采样模块，采用扩张因子为0.5的上采样函数并加入了1×1卷积层，每次通过下采样操作特征尺度缩小为原来的1/2，通道数增加ex_factor，所述ex_factor设置为32；梯度残差密集混合解码网络，所述梯度残差密集混合解码网络包括：三个通道注意力模块，突出模糊块的重要特征；三组密集残差混合U形模块GRDB_RSU4Mix Block×L1；两组上采样模块，采用两组1×1卷积核的卷积层；跳连接模块，采用一组通道注意力模块，通过所述通道注意力模块将所述梯度残差密集混合编码网络提取的特征信息送入所述梯度残差密集混合解码网络。作为本发明的进一步改进，所述密集残差混合U形模块GRDB_RSU4Mix Block×L1包括：密集残差模块GRDB Block，所述密集残差模块GRDB Block包括两组3×3卷积核的卷积层，两组GELU的激活层密集连接，最后在残差支路中加入Sobel梯度运算来计算特征的梯度幅度并使用一个1×1卷积层跳连来消除输入输出通道维度的不同；残差混合U形模块RSU4Mix Block，所述残差混合U形模块RSU4Mix Block包括：输入深度卷积层，所述输入深度卷积层包括一组3×3卷积核的深度卷积层，所述输入深度卷积层将输入特征 变为通道数为64的中间输入特征/＞ ；深度卷积编码子网络，所述深度卷积编码子网络包括三组3×3卷积核的深度卷积层，两组最大池化层模拟下采样操作，经过所述深度卷积编码子网络后输出特征；深度卷积解码子网络，包括三组3×3卷积核的深度卷积层，两组特征混合模块MixBlock，三组残差连接模块，所述深度卷积解码子网络将局部特征和多尺度特征进行融合；级联深度卷积模块，包括一组3×3卷积核的深度卷积层，用以将所述深度卷积编码子网络提取的所述特征传递到所述深度卷积解码子网络中。作为本发明的进一步改进，所述残差混合U形模块RSU4Mix Block包括：输入深度卷积层，所述输入深度卷积层包括一组3×3卷积核的深度卷积层，所述输入深度卷积层将输入特征 变为通道数为64的中间输入特征/＞ ；深度卷积编码子网络，所述深度卷积编码子网络包括三组3×3卷积核的深度卷积层，两组最大池化层模拟下采样操作，经过所述深度卷积编码子网络后输出特征；深度卷积解码子网络，包括三组3×3卷积核的深度卷积层，两组特征混合模块MixBlock，三组残差连接模块，所述深度卷积解码子网络将局部特征和多尺度特征进行融合；级联深度卷积模块，包括一组3×3卷积核的深度卷积层，用以将所述深度卷积编码子网络提取的所述特征传递到所述深度卷积解码子网络中。作为本发明的进一步改进，所述特征混合模块Mix Block的操作如下：将下采样层处理的特征信息和下一层的上采样层的信息进行自适应混合操作来融合这两层的信息并将所述特征信息传入到下一个上采样层，自适应混合操作可以公式化为：，其中和/＞分别来自第i-1个下采样层的特征图和第i个上采样层的特征图，表示第i+1个上采样层的特征图，其中i为2或3，/＞表示自适应混合操作因子，用于融合第i-1个下采样的特征图和第i个上采样的特征图，其中/＞由Sigmoid算子/＞决定。作为本发明的进一步改进，所述梯度残差密集多尺度卷积注意力U形子网络包括：梯度残差密集多尺度卷积注意力编码网络，所述梯度残差密集多尺度卷积注意力编码网络包括：三个通道注意力模块，突出模糊块的重要特征；三组梯度残差密集多尺度卷积注意力模块GRDB_MSCA Block×L1；两个下采样模块，采用扩张因子为0.5的上采样函数并加入1×1卷积层，通过下采样操作特征尺度缩小为原来的1/2，通道数增加ex_factor，所述ex_factor设置为32；梯度残差密集多尺度卷积注意力解码网络；跳连接模块，采用一组通道注意力模块，通过所述通道注意力模块将所述梯度残差密集多尺度卷积注意力编码网络提取的特征信息送入所述梯度残差密集多尺度卷积注意力解码网络。作为本发明的进一步改进，所述梯度残差密集多尺度卷积注意力模块GRDB_MSCABlock×L1包括：密集残差模块GRDB Block，所述密集残差模块GRDB Block包括两组3×3卷积核的卷积层，两组GELU的激活层密集链接，最后在残差支路中加入Sobel梯度运算来计算特征的梯度幅度并使用一个1×1卷积层跳连来消除输入输出通道维度的不同；多尺度卷积注意力模块MSCA Block。作为本发明的进一步改进，所述多尺度卷积注意力模块MSCA Block包括：第一层，所述第一层包括一组5×5的深度可分离卷积，所述第一层聚集图像信息；第二层，所述第二层包括一组7×7普通卷积层、一组11×11普通卷积层及一组21×21普通卷积层；第三层，所述第三层包括一组7×7的深度过参数化卷积层、一组11×11的深度过参数化卷积层及一组21×21的深度过参数化卷积层，所述第三层深度提取特征信息；第四层，所述第四层包括一组1×1的深度过参数化卷积层，所述第四层模拟信道关系。作为本发明的进一步改进，所述多尺度卷积注意力模块进行提取特征的步骤为：，，其中分别为输出，注意力图和特征的输入，/＞表示各个元素矩阵的乘法运算，/＞为深度过参数化卷积，/＞由两层卷积构成，第一层使用Depthwise Conv，每个卷积核对应输出的每一个通道；第二层使用Pointwise Conv；为连接输入处，其中/＞。本发明的另一目的在于提供一种能复原模糊图像的基于残差密集网络的图像去模糊模型方法。为实现上述目的，本发明采用以下技术方案，包括：第一阶段、将模糊图像分为八个大小相同的模糊块送入所述梯度残差密集混合U形子网络，粗略提取所述模糊图像的多分辨率特征，并提取所述模糊图像的边缘信息，将处理后的图像块两两拼接，通过特征监督注意力模块SAM输入到第二阶段；第二阶段、将所述模糊图像分为四个大小相同的模糊块，并与所述第一阶段处理过的图像块进行特征融合后送入梯度残差密集多尺度卷积注意力U形子网络，获得更加精细的所述模糊图像的多分辨率特征，将处理后的图像块两两拼接，通过所述特征监督注意力模块SAM输入到第三阶段；第三阶段、将所述模糊图像分为两个大小相同的模糊块，并与所述第二阶段处理过的图像块进行特征融合后送入所述梯度残差密集多尺度卷积注意力U形子网络，获得更加精细的所述模糊图像的多分辨率特征，将处理后的图像块两两拼接，通过所述特征监督注意力模块SAM输入到第四阶段；第四阶段、将完整图像与所述第三阶段处理过的图像块进行特征融合后，所述梯度残差密集多尺度卷积注意力U形子网络获得最终清楚的图像。本发明的有益效果是：本发明提出四阶段渐进式提取模糊图像的特征信息，引入了梯度残差密集混合U形子网络，粗略获取模糊图像的多分辨率特征，并提取模糊图像边缘信息。同时引入了梯度残差密集多尺度卷积注意力U形子网络，用于获得更加精细的模糊图像的多分辨率特征。由粗到细处理模糊图像，更加有效得保存了模糊图像的细节特征，更有利于模糊图像的复原工作。附图说明图1为基于多阶段渐进式残差密集U型网络与注意力机制的图像去模糊模型结构图。图2为基于多阶段渐进式残差密集U型网络与注意力机制的图像去模糊模型中的梯度残差密集混合U形子网络结构图。图3为密集残差混合U形模块中的密集残差模块GRDBBlock结构图。图4为密集残差混合U形模块中的残差混合U形模块RSU4Mix Block结构图。图5为基于多阶段渐进式残差密集U型网络与注意力机制的图像去模糊模型中的梯度残差密集多尺度卷积注意力U形子网络结构图。图6为残差密集多尺度卷积注意力模块中的多尺度卷积注意力模块结构图。具体实施方式为了使本发明的目的、技术方案和优点更加清楚，下面结合附图和具体实施例对本发明进行详细描述。在此，还需要说明的是，为了避免因不必要的细节而模糊了本发明，在附图中仅仅示出了与本发明的方案密切相关的结构和/或处理步骤，而省略了与本发明关系不大的其他细节。为了使本发明的目的，技术方案和优点更加清楚，下面结合附图和具体实施例对本发明进行详细描述。请参阅图1所示，本发明提供了多阶段渐进式残差密集U型网络与注意力机制的图像去模糊模型，用于对图像进行去模糊，以在确保图像去模糊的同时保留更多的边缘特征，图像去模糊模型包括：请参阅图2所示，梯度残差密集混合U形子网络，包括：梯度残差密集混合编码网络；跳连接模块，采用一组通道注意力模块，通过该模块将编码网络提取的特征信息送入解码网络；梯度残差密集混合解码网络。梯度残差密集混合U形子网络用于粗略提取模糊图像的多分辨率特征，并提取模糊图像边缘信息，将处理后的图像块两两拼接，通过特征监督注意力模块SAM输入到第二阶段。请参阅图3所示，密集残差混合U形模块中的密集残差模块GRDB Block，包括：两组3×3卷积核的卷积层，两组GELU的激活层密集连接，最后在残差支路中加入Sobel梯度运算来计算特征的梯度幅度并使用一个1×1卷积层跳连来消除输入输出通道维度的不同。请参阅图4所示，密集残差混合U形模块中的残差混合U形模块RSU4Mix Block，包括：输入深度卷积层，包括一组3×3卷积核的深度卷积层，该卷积块将输入特征 变为通道数为64的中间输入特征/＞ ；深度卷积编码子网络，包括三组3×3卷积核的深度卷积层，两组最大池化层模拟下采样操作，经过深度卷积编码子网络后输出特征；级联深度卷积模块，包括一组3×3卷积核的深度卷积层，用以将编码子网络提取的特征传递到解码子网络中；深度卷积解码子网络，包括三组3×3卷积核的深度卷积层，两组特征混合模块MixBlock，三组残差连接模块用以将局部特征和多尺度特征进行融合。请参阅图5所示，梯度残差密集多尺度卷积注意力U形子网络，包括：梯度残差密集多尺度卷积注意力编码网络；跳连接模块，采用一组通道注意力模块，通过该模块将编码网络提取的特征信息送入解码网络；梯度残差密集多尺度卷积注意力解码网络。请参阅图6所示，残差密集多尺度卷积注意力模块中的多尺度卷积注意力模块，包括：第一层，包括一组5×5的深度可分离卷积，有效得聚集图像信息；第二层，包括一组7×7普通卷积层、一组11×11普通卷积层、一组21×21普通卷积层；第三层，包括一组7×7的深度过参数化卷积层、一组11×11的深度过参数化卷积层、一组21×21的深度过参数化卷积层，深度提取特征信息；第四层，包括一组1×1的深度过参数化卷积层，模拟信道关系。综上所述，本发明提供了一种基于残差密集U形网络的图像去模糊模型及方法，第一阶段引入梯度残差密集混合U形子网络，第二、三、四阶段引入梯度残差密集多尺度卷积注意力U形子网络，相邻两个阶段之间采用特征监督注意力模块连接进行特征融合，使网络训练更加稳定，网络能够极大地减少特征图信息的丢失，进而实现模糊图像复原的效果。以上实施例仅用以说明本发明的技术方案而非限制，尽管参照较佳实施例对本发明进行了详细说明，本领域的普通技术人员应当理解，可以对本发明的技术方案进行修改或者等同替换，而不脱离本发明技术方案的精神和范围。
