标题title
一种遥感图像海陆分割方法及系统
摘要abst
本发明涉及一种遥感图像海陆分割方法及系统，属于图像处理领域，包括：将遥感图像分别输入Swin‑Transformer Block单元和ResNet单元提取不同的图像特征，构建特征图；将特征图输入到MCA单元中，通过深度可分离卷积模块和自注意力空间金字塔池化模块捕捉特征图中不同窗口大小和尺度的特征，引入SE模块关注重要特征；采用上采样模块进行上采样，通过长程残差连接得到长程残差后的特征图，将长程残差后的特征图继续输入上采样模块恢复到初始尺寸，输出预测图片。本发明提高了模型的特征信息提取能力，在海陆分割任务中实现了狭长水域的正确分割，减少了低区别度区域的分割错误，提升了整体分割的精确性与稳定性。
权利要求书clms
1.一种遥感图像海陆分割方法，其特征在于：所述分割方法包括：步骤一、将遥感图像分别输入Swin-Transformer Block单元和ResNet单元提取不同的图像特征Fp1与Fp2，通过进行三个阶段的卷积计算以构建特征图，/＞表示Swin-Transformer Block单元，/＞表示ResNet单元，/＞表示特征图；步骤二、将特征图输入到MCA单元中，通过MCA单元中的深度可分离卷积模块和自注意力空间金字塔池化模块捕捉特征图中不同窗口大小和尺度的特征，并引入SE模块关注重要特征，提高关键信息的敏感性；步骤三、采用上采样模块对MCA单元输出的特征图进行上采样，并通过长程残差连接防止多次上采样导致的信息丢失，得到长程残差后的特征图，将长程残差后的特征图继续输入上采样模块恢复到初始尺寸，最后输出预测图片。2.根据权利要求1所述的一种遥感图像海陆分割方法，其特征在于：所述步骤二，具体包括以下内容：A1、首先通过一个3×3的卷积群，再分别通过深度可分离卷积模块进行深度卷积和逐点卷积处理捕捉特征图中不同窗口大小和尺度的特征，再通过一个3×3的卷积群，再通过SE模块进行重要特征的关注；A2、然后，通过自注意力空间金字塔池化模块进一步捕捉特征图中不同窗口大小和尺度的特征，再重复A1步骤。3.根据权利要求1所述的一种遥感图像海陆分割方法，其特征在于：所述步骤三，具体包括以下内容：特征图进入包括一个转置卷积、一个3×3卷积、一个BN归一化层和一个ReLU激活层的上采样模块，通过转置卷积实现图像的上采样，将低分辨率的特征图放大到与原始输入图像相同的分辨率；经过第一次上采样后输出的特征图分别与Swin-Transformer Block单元和ResNet单元的第一个阶段建立长程残差特征，得到建立长程残差后的特征图；将长程残差后的特征图继续送入上采样模块以恢复初始尺寸，最后输出预测图片。4.一种遥感图像海陆分割系统，其特征在于：它包括Swin-Transformer单元、ResNet单元、MCA单元和采样单元；所述Swin-Transformer Block单元和ResNet单元：用于将输入的遥感图像提取不同的图像特征Fp1与Fp2，通过进行三个阶段的卷积计算以构建特征图，/＞表示Swin-Transformer Block单元，/＞表示ResNet单元，/＞表示特征图；所述MCA单元：用于对输入的特征图通过深度可分离卷积模块和自注意力空间金字塔池化模块捕捉特征图中不同窗口大小和尺度的特征，并引入SE模块关注重要特征，提高关键信息的敏感性；所述采样单元：用于采用上采样模块对MCA单元输出的特征图进行上采样，并通过长程残差连接防止多次上采样导致的信息丢失，得到长程残差后的特征图，将长程残差后的特征图继续输入上采样模块恢复到初始尺寸，最后输出预测图片。5.根据权利要求4所述的一种遥感图像海陆分割系统，其特征在于：所述MCA单元具体包括以下内容：A1、首先通过一个3×3的卷积群，再分别通过深度可分离卷积模块进行深度卷积和逐点卷积处理捕捉特征图中不同窗口大小和尺度的特征，再通过一个3×3的卷积群，再通过SE模块进行重要特征的关注；A2、然后，通过自注意力空间金字塔池化模块进一步捕捉特征图中不同窗口大小和尺度的特征，再重复A1步骤。6.根据权利要求4所述的一种遥感图像海陆分割系统，其特征在于：所述采样单元具体包括以下内容：特征图进入包括一个转置卷积、一个3×3卷积、一个BN归一化层和一个ReLU激活层的上采样模块，通过转置卷积实现图像的上采样，将低分辨率的特征图放大到与原始输入图像相同的分辨率；经过第一次上采样后的特征图与Swin-Transformer Block单元和ResNet单元的第一个阶段建立长程残差特征，得到建立长程残差后的特征图；将长程残差后的特征图继续送入上采样模块以恢复初始尺寸，最后输出预测图片。
说明书desc
技术领域本发明涉及图像处理技术领域，尤其涉及一种遥感图像海陆分割方法及系统。背景技术在当今的全球变暖和气候变化的大背景下，海岸线作为海洋与陆地之间的交界地带，逐渐称为备受关注的焦点。气温的急剧升高和海底火山的活动增多，导致了地球两极的冰川融化，这产生了令人担忧的后果。海陆分割技术的重要性扩展到内陆湖泊和河流地区，尤其是在季节性雨季和干旱季明显的热带和亚热带地区。其对水资源管理、灾害管理、生态保护、农业和渔业以及城市发展的重要影响有助于维护可持续发展和生态平衡。然而，尽管海陆分割在各个领域中具有广泛的应用，但由于海洋和陆地交界混淆不清、海岸线错综复杂等问题，这给海陆分割任务带来了巨大的挑战，因此需要其进行海陆分割。传统的海陆分割方法，如阈值分割法和信息熵分析法，阈值分割法是首先对海陆图像进行预处理，然后通过算法确定适当的阈值，其中高于阈值的部分标记为一类，低于阈值的部分标记为另一类，之后通过需要后处理以提高分割的准确性，其包括去除小的连通区域，填充空洞等操作。这种方法虽然在某些情况下有效，但是通常是海岸线需要更频繁地监测不同时间段的情况，然而这些方法难以应对因此产生的大规模、高速处理遥感图像需求，同时成本较高。在深度学习遥感图像语义分割领域，一些先进方法采用了空间金字塔池化和空洞卷积等技术以提高模型对多尺度和广域信息的理解。空间金字塔池化允许模型在不同尺度上聚合特征，使其能够有效地捕捉遥感图像中的细节和整体结构。与此同时，空洞卷积通过引入空洞率的概念，扩大了感受野，有助于更好地捕捉遥感图像中的上下文信息，这些先进的技术已经成功地集成到自主构建的深度学习模型中，用于遥感图像的海陆分割任务，但仍存在以下两个问题：1. 有些海洋水体夹在陆地之间，海洋陆地交错复杂，在两岬角或两半岛之间形成明显水曲的海湾或者河口湾部分，通过遥感影像对这些深入陆地内部的狭长的水域进行分割时会产生分割失败的问题，无法将狭长水域正确分割。2. 在遥感图像的整体颜色相近，陆地与海洋颜色区别度较低时候整体分割不精确。当陆地上的某些区域与海洋的光谱相近时，分割算法可能会错误地将这些陆地区域分类为海洋，导致分割错误。发明内容本发明的目的在于克服现有技术的缺点，提供了一种遥感图像海陆分割方法及系统，解决了现有方法存在的不足。本发明的目的通过以下技术方案来实现：一种遥感图像海陆分割方法，所述分割方法包括：步骤一、将遥感图像分别输入Swin-Transformer Block单元和ResNet单元提取不同的图像特征Fp1与Fp2，通过进行三个阶段的卷积计算以构建特征图，/＞表示Swin-Transformer Block单元，/＞表示ResNet单元，/＞表示特征图；步骤二、将特征图输入到MCA单元中，通过MCA单元中的深度可分离卷积模块和自注意力空间金字塔池化模块捕捉特征图中不同窗口大小和尺度的特征，并引入SE模块关注重要特征，提高关键信息的敏感性；步骤三、采用上采样模块对MCA单元输出的特征图进行上采样，并通过长程残差连接防止多次上采样导致的信息丢失，得到长程残差后的特征图，将长程残差后的特征图继续输入上采样模块恢复到初始尺寸，最后输出预测图片。所述步骤二，具体包括以下内容：A1、首先通过一个3×3的卷积群，再分别通过深度可分离卷积模块进行深度卷积和逐点卷积处理捕捉特征图中不同窗口大小和尺度的特征，再通过一个3×3的卷积群，再通过SE模块进行重要特征的关注；A2、然后，通过自注意力空间金字塔池化模块进一步捕捉特征图中不同窗口大小和尺度的特征，再重复A1步骤。所述步骤三，具体包括以下内容：特征图进入包括一个转置卷积、一个3×3卷积、一个BN归一化层和一个ReLU激活层的上采样模块，通过转置卷积实现图像的上采样，将低分辨率的特征图放大到与原始输入图像相同的分辨率；经过第一次上采样后的特征图与Swin-Transformer Block单元和ResNet单元的第一个阶段建立长程残差特征，得到建立长程残差后的特征图；将长程残差后的特征图继续送入上采样模块以恢复初始尺寸，最后输出预测图片。一种遥感图像海陆分割系统，它包括Swin-Transformer单元、ResNet单元、MCA单元和采样单元；所述Swin-Transformer Block单元和ResNet单元：用于将输入的遥感图像提取不同的图像特征Fp1与Fp2，通过进行三个阶段的卷积计算以构建特征图，/＞表示Swin-Transformer Block单元，/＞表示ResNet单元，/＞表示特征图；所述MCA单元：用于对输入的特征图通过深度可分离卷积模块和自注意力空间金字塔池化模块捕捉特征图中不同窗口大小和尺度的特征，并引入SE模块关注重要特征，提高关键信息的敏感性；所述采样单元：用于采用上采样模块对MCA单元输出的特征图进行上采样，并通过长程残差连接防止多次上采样导致的信息丢失，得到长程残差后的特征图，将长程残差后的特征图继续输入上采样模块恢复到初始尺寸，最后输出预测图片。所述MCA单元具体包括以下内容：A1、首先通过一个3×3的卷积群，再分别通过深度可分离卷积模块进行深度卷积和逐点卷积处理捕捉特征图中不同窗口大小和尺度的特征，再通过一个3×3的卷积群，再通过SE模块进行重要特征的关注；A2、然后，通过自注意力空间金字塔池化模块进一步捕捉特征图中不同窗口大小和尺度的特征，再重复A1步骤。所述采样单元具体包括以下内容：特征图进入包括一个转置卷积、一个3×3卷积、一个BN归一化层和一个ReLU激活层的上采样模块，通过转置卷积实现图像的上采样，将低分辨率的特征图放大到与原始输入图像相同的分辨率；经过第一次上采样后的特征图与Swin-Transformer Block单元和ResNet单元的第一个阶段建立长程残差特征，得到建立长程残差后的特征图；将长程残差后的特征图继续送入上采样模块以恢复初始尺寸，最后输出预测图片。本发明具有以下优点：一种遥感图像海陆分割方法及系统，将传统的卷积运算与Transformer相结合，将Transformer强大的自注意力引入传统的卷积框架，提高了模型的特征信息提取能力，同时与多尺度融合注意力模块结合提升了模型对狭长水域的捕捉能力，在海陆分割任务中实现了狭长水域的正确分割，并且减少了低区别度区域的分割错误，提升了整体分割的精确性与稳定性。附图说明图1为本发明的总结构示意图；图2为本发明编码器的结构示意图；图3为本发明编码器的Swin-Transformer Block模块的结构示意图；图4为本发明编码器的ResNet模块1的结构示意图；图5为本发明编码器的ResNet模块2的结构示意图；图6为本发明多尺度融合注意力单元的结构示意图。具体实施方式为使本申请实施例的目的、技术方案和优点更加清楚，下面将结合本申请实施例中附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本申请实施例的组件可以以各种不同的配置来布置和设计。因此，以下结合附图中提供的本申请的实施例的详细描述并非旨在限制要求保护的本申请的保护范围，而是仅仅表示本申请的选定实施例。基于本申请的实施例，本领域技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本申请保护的范围。下面结合附图对本发明做进一步的描述。如图1所示，本发明涉及一种基于双分支并行多尺度注意力网络的遥感图像海陆分割方法，其具体包括以下内容。如图2所示， Swin-Transformer Block单元以其自注意力机制擅长捕捉图像中的长程依赖关系，有助于理解广阔海陆地貌的整体结构。这种全局信息对于正确区分大范围的海洋和陆地区域至关重要。ResNet单元在局部特征提取上表现出色，能够有效捕捉图像中的细微结构和地物纹理。这对于在局部区域进行准确的海陆分割决策至关重要，尤其是在复杂地貌条件下。为了陆地上的某些区域与海洋的光谱相近时更加准确的分割，因此将Swin-Transformer单元和ResNet单元作为一个双分支编码器，这样能够在不同空间层次上整合全局和局部信息，可以同时关注广泛区域和局部细节，从而更全面地理解图像，提高对海陆分割任务的整体性能；其中Swin-Transformer Block单元表示自注意力模块单元，ResNet单元表示残差神经网络单元，Swin-Transformer 模块表示视觉自注意力模块。编码器具体方法如下：遥感图像在进入编码器会被分别输入Swin-Transformer Block单元与ResNet单元来提取不同的图像特征Fp1与Fp2，每个单元都会进行三个阶段的卷积计算以构建特征图。这个阶段可公式化为：，其中表示Swin-Transformer Block单元，/＞表示ResNet单元，/＞表示通过双分支编码器后的特征图。如图3所示，Swin-Transformer Block单元首先输入图像被引入模型，然后通过块分割将图像划分为均匀的块，以减轻计算负担和提高计算效率。每个块通过线性层进行嵌入，将原始图像信息映射到一个更适于处理的表示。接下来，Swin-Transformer Block成为关键组件，构成了整个模型的核心，由层归一化进行输入数据的归一化。多层感知机通过两个全连接层和GELU非线性激活函数对特征进行非线性变换，这有助于模型更好地捕捉图像中的复杂模式和特征和提高模型对不同地物类别的区分能力。同时，基于窗口的多头自注意模块和基于移位窗口的自我注意模块通过引入局部性，提高了计算效率，使模型这有助于模型理解图像中不同区域的上下文信息，特别是在海陆交界处可能存在复杂的纹理和形状。最后通过块嵌入将处理过的图像块重新合并，有助于还原图像的整体结构，确保最终输出与原始图像相符。这些设计选择共同为海陆分割任务提供了强大的特征提取和上下文理解能力，使得模型在复杂地表情景中表现卓越，同时保持了可解释性。基于这种窗口划分机制，连续的Swin-Transformer Block可以公式化为：，，，，其中，表示层归一化，/＞表示加权多头自注意，/＞表示多层感知机，/＞表示滑动窗口多头自注意，/＞和/＞分别表示第l个块的和/＞的输出。Swin-Transformer Block是一种基于注意力机制的骨干网络，自注意力来使得Swin-Transformer Block能够自适应的学习输入图像的重要区域，通过线性层和窗口划分的组标记，将输入的特征图X映射到QKV。自注意力的计算机制如下：，其中Attention表示自注意力函数，SoftMax代表是SoftMax激活函数，Q,K,V分别表示为查询矩阵、键矩阵和值矩阵，KT表示 K 的转置， 表示查询、键和值矩阵的维度，/＞表示为实数域，M2表示一个窗口下的块数量，d表示为查询除以键的维，B表示为相对位置的偏差项，/＞表示相对位置的偏差项维度。如图4、图5所示，ResNet是一种深层残差网络，通过残差结构的设计，避免了深层网络梯度消失和梯度爆炸的问题，残差连接也可以保留原始特征，提升模型的精度和泛化能力。我们选取了ResNet50的在前四个阶段中通过7x7卷积和最大池化层提取全局特征，并在后三个阶段的模块1保留原始输入的信息，避免梯度消失问题，使网络更容易学习复杂的特征。这一阶段的特征提取有可能包含一些关于海陆分割任务有用的中级语义信息，和模块2更进一步地提高了特征的抽象层次。通过堆叠更多的残差块，网络能够学到更高级的语义信息，例如海陆的结构、边界等。使得网络能够更好地适应并理解海陆分割任务中的各种图像特征。残差连接的使用有效地解决了深层网络中的梯度问题，提高了模型的精度和泛化能力。残差连接的计算如下：，其中为直接映射，/＞为残差映射，/＞为第l层特征图，/＞为对l层特征图进行卷积操作。将输入的遥感图像分别用Swin-Transformer Block单元与ResNet单元两个backbone进行三个大阶段的特征提取，每个阶段之间都会进行卷积下采样。其中Swin-Transformer Block单元的三个阶段的模块数分别为2，2，6，ResNet单元的三个阶段的模块数分别为3，4，6。两个模块群提取到的特征图将被拼接后送入多尺度融合注意力单元，以进一步获取空间与通道特征以及多尺度下的特征表示，本发明将Swin-TransformerBlock与ResNet相结合，能够更有效地进行特征提取，避免单一分支进行特征提取时所造成的特征丢失。通过引入Swin-Transformer Block的注意力机制，可以弥补ResNet在处理低层特征时可能存在的信息丢失和模糊化问题，从而提高网络的性能。同时，由于ResNet的残差结构可以实现更深的网络结构，可以更好地利用Swin-Transformer Block的注意力机制，进一步提高网络的表达能力和性能。如图6所示，海洋陆地交错复杂，在两岬角或两半岛之间形成明显水曲的海湾或者河口湾部分，形成了海陆分割中的一个难点。因此为了更加准确的分割狭长水域本发明提出了多尺度融合注意力模块，通过结合使用深度可分离卷积进行特征提取可以分别对空间与通道特征进行提取和处理，自注意力空间金字塔池化能够捕捉不同窗口大小和尺度的特征，将深度可分离卷积和自注意力空间金字塔池化结合有助于模型对海陆地貌多尺度信息特别是狭长水域的捕捉能力。其中还引入SE模块使得模型可以更加关注重要的特征，提高对关键信息的敏感性。最后引入丢弃层以减轻过拟合问题，提高模型的泛化能力。在海陆分割任务中，MCA单元有助于模型更有效地识别和区分地表特征，提高分割的准确性。这个阶段公式化为：，其中表示SE模块，/＞表示深度可分离模块，/＞表示自注意力空间金字塔池化模块，/＞表示为进入编码器模块后的特征图，/＞表示进入MCA单元后的特征图。为了有效融合编码器和多尺度融合注意力模块提取的特征信息，并将低分辨率特征图上采样至原始输入图像相同分辨率，因此采用了上采样模块和长程残差连接。上采样模块通过转置卷积实现图像的上采样，将低分辨率的特征图放大到与原始输入图像相同的分辨率。这有助于细化海陆分割结果，提高对图像细节的捕捉能力。通过建立长程残差连接，可以防止在解码过程中由于多次上采样而导致的信息丢失。这有助于维持模型对重要地物和边界的感知，提高了分割的准确性。上采样模块和长程残差特征的结合使得解码器能够在提高分辨率的同时，充分利用编码器中学到的上下文信息。有助于模型更全面地理解图像，同时保持细节信息，提高了海陆分割任务的整体性能和可解释性。具体步骤包括：接着会进行进入上采样模块，上采样模块包括一个转置卷积，一个3×3卷积，一个BN归一化层与一个ReLU激活层。在通过一个上采样模块后，输出的特征图会与Swin-Transformer Block单元与ResNet单元第一个大阶段建立长程残差特征。这一阶段可用公式表现为：，，其中表示ReLU激活层，/＞表示BN归一化层，/＞表示3×3卷积层，/＞表示反卷积层， /＞表示通过第一个上采样模块后的特征图，表示Swin-Transformer Block单元的第一个大阶段，/＞表示ResNet单元的第一个大阶段， /＞表示建立长程残差后的特征图。随后会继续进入上采样模块以恢复初始尺寸，最后输出预测图片。以上所述仅是本发明的优选实施方式，应当理解本发明并非局限于本文所披露的形式，不应看作是对其他实施例的排除，而可用于各种其他组合、修改和完善，并能够在本文所述构想范围内，通过上述教导或相关领域的技术或知识进行改动。而本领域人员所进行的改动和变化不脱离本发明的精神和范围，则都应在本发明所附权利要求的保护范围内。
