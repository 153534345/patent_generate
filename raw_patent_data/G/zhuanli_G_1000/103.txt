标题title
一种用于平衡性能与面积的数字ASIC串并结合乘法器
摘要abst
本发明公开了一种用于平衡性能与面积的数字ASIC串并结合乘法器，包括串行乘法计数器模块、操作数多路选择模块和并行乘法器模块，所述串行乘法计数器模块、操作数多路选择模块和并行乘法器模块依次连接，其中，串行乘法计数器模块在每个时钟周期内产生递增的数字点数，并作为选择条件控制操作数多路选择模块输出乘数和被乘数，所述并行乘法器模块接收乘数和被乘数完成乘法计算并输出乘法结果。本发明可有效弥补串行乘法器和并行乘法器在运算速度以及面积方面的不足，适用于数字ASIC设计中需要对性能与面积作专用定制的电路。
权利要求书clms
1.一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，包括串行乘法计数器模块、操作数多路选择模块和并行乘法器模块，所述串行乘法计数器模块、操作数多路选择模块和并行乘法器模块依次连接，其中，串行乘法计数器模块在每个时钟周期内产生递增的数字点数，并作为选择条件控制操作数多路选择模块输出乘数和被乘数，所述并行乘法器模块接收乘数和被乘数完成乘法计算并输出乘法结果。2.如权利要求1所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，所述串行乘法计数器模块包括计数器电路和多路选择MUX3电路，所述计数器电路用于上电后循环产生周期点数，所述点数用于多路选择MUX3电路的多路选择输入，以控制串行乘法计数器模块的行进方向。3.如权利要求2所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，所述操作数多路选择模块包括多路选择MUX1电路和多路选择MUX2电路，所述多路选择MUX1电路用于将输入的M1位宽被乘数按N1个多路选择条件等分，所述多路选择MUX2电路用于将输入的M2位宽乘数按N2个多路选择条件等分。4.如权利要求3所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，所述多路选择MUX1电路的case1端与多路选择MUX3电路的输出端相连接，根据case1端输入信号的不同，选择被乘数的不同位作为输出；所述多路选择MUX2电路的case2端与多路选择MUX3电路的输出端相连接，根据case2端输入信号的不同，选择乘数的不同位作为输出。5.如权利要求4所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，所述并行乘法器模块为依赖于综合库指定或定制IP，选择在一个时钟周期内完成并行乘法运算的乘法器，且不同位宽的并行乘法器的类型需一致。6.如权利要求4所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，所述并行乘法器模块的位宽选择为：根据数据采样率fs与时钟频率fclk计算其倍数关系h，所述的倍数关系h计算公式如下：h=fclk/fs；其中，h为最大串行复用乘法器的周期数，根据周期数选择最小位宽并行乘法器。7.如权利要求4所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，所述并行乘法器模块包括乘法器电路与累加和电路，所述乘法器电路的被乘数与乘数分别由多路选择MUX1电路与多路选择MUX2电路的输出接入，所述累加和电路完成当前乘法器电路输出位的累加与低位乘法结果的进位加法作为当前位的乘法结果输出，并产生进位，从而依次完成从最低位到最高位的运算。8.如权利要求7所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，所述累加和电路采用临时寄存器存储乘法结果，通过控制累加和电路的复用，在当前位完成乘法结果后产生相应位宽的输出。9.如权利要求8所述的一种用于平衡性能与面积的数字ASIC串并结合乘法器，其特征在于，在当前位完成乘法结果输出后，对临时寄存器做覆写操作，可将临时寄存器数量控制到仅为1个，临时寄存器的位宽为乘法中间位结果的最大位宽。
说明书desc
技术领域本发明涉及集成电路技术领域，尤其涉及一种用于平衡性能与面积的数字ASIC串并结合乘法器。背景技术ASIC芯片由于体积小、高性能、低成本、可大规模生产等优点被广泛应用于各行各业。随着应用需求的不断升级，人们对ASIC芯片的PPA提出了更高的要求。而乘法器作为芯片中重要的运算处理单元，直接决定了芯片的综合性能。目前，应用于数字ASIC芯片中的串行乘法器往往采用移位相加的方式来串行完成乘法，此方式节约面积，但运行速度慢，很难满足芯片运算速度的需求。目前，并行乘法器往往依赖于指定综合库中的乘法器单元或用自研设计的并行乘法器如Booth乘法器等并行乘法器电路，通过并行乘法运算提高速度，但随着操作数的位宽增大，并行运算导致的面积也会增大，在规模复用时，往往会导致芯片面积大幅增加。在ASIC的实际设计实现时，如何设计ASIC专用乘法器以满足电路性能的同时也能保证面积达到设计预期是当前的一大技术难题。发明内容本发明的目的是提供一种用于平衡性能与面积的数字ASIC串并结合乘法器，以解决如何在保证性能的同时，又能兼顾芯片电路面积的技术问题。本发明是采用以下技术方案实现的：一种用于平衡性能与面积的数字ASIC串并结合乘法器，包括串行乘法计数器模块、操作数多路选择模块和并行乘法器模块，所述串行乘法计数器模块、操作数多路选择模块和并行乘法器模块依次连接，其中，串行乘法计数器模块在每个时钟周期内产生递增的数字点数，并作为选择条件控制操作数多路选择模块输出乘数和被乘数，所述并行乘法器模块接收乘数和被乘数完成乘法计算并输出乘法结果。进一步的，所述串行乘法计数器模块包括计数器电路和多路选择MUX3电路，所述计数器电路用于上电后循环产生周期点数，所述点数用于多路选择MUX3电路的多路选择输入，以控制串行乘法计数器模块的行进方向。进一步的，所述操作数多路选择模块包括多路选择MUX1电路和多路选择MUX2电路，所述多路选择MUX1电路用于将输入的M1位宽被乘数按N1个多路选择条件等分，所述多路选择MUX2电路用于将输入的M2位宽乘数按N2个多路选择条件等分。进一步的，所述多路选择MUX1电路的case1端与多路选择MUX3电路的输出端相连接，根据case1端输入信号的不同，选择被乘数的不同位作为输出；所述多路选择MUX2电路的case2端与多路选择MUX3电路的输出端相连接，根据case2端输入信号的不同，选择乘数的不同位作为输出。进一步的，所述并行乘法器模块为依赖于综合库指定或定制IP，选择在一个时钟周期内完成并行乘法运算的乘法器，且不同位宽的并行乘法器的类型需一致。进一步的，所述并行乘法器模块的位宽选择为：根据数据采样率fs与时钟频率fclk计算其倍数关系h，所述的倍数关系h计算公式如下：h=fclk/fs；其中，h为最大串行复用乘法器的周期数，根据周期数选择最小位宽并行乘法器。进一步的，所述并行乘法器模块包括乘法器电路与累加和电路，所述乘法器电路的被乘数与乘数分别由多路选择MUX1电路与多路选择MUX2电路的输出接入，所述累加和电路完成当前乘法器电路输出位的累加与低位乘法结果的进位加法作为当前位的乘法结果输出，并产生进位，从而依次完成从最低位到最高位的运算。进一步的，所述累加和电路采用临时寄存器存储乘法结果，通过控制累加和电路的复用，在当前位完成乘法结果后产生相应位宽的输出。进一步的，在当前位完成乘法结果输出后，对临时寄存器做覆写操作，可将临时寄存器数量控制到仅为1个，临时寄存器的位宽为乘法中间位结果的最大位宽。本发明的有益效果在于：本发明通过数字IC中常见的组合逻辑电路和时序逻辑电路，构成逻辑简单、易实现的可灵活取舍性能与面积的乘法器，独特的串并行电路实现方式可有效弥补串行乘法器和并行乘法器在运算速度以及面积方面的不足，非常适用于数字ASIC设计中需要对性能与面积作专用定制的电路。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图示出的结构获得其他的附图。图1为本发明电路图；图2为本发明中间运算原理图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本发明实施例的组件可以以各种不同的配置来布置和设计。应注意到：相似的标号和字母在下面的附图中表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中不需要对其进行进一步定义和解释。下面结合附图，对本发明的一些实施方式作详细说明。在不冲突的情况下，下述的实施例及实施例中的特征可以相互组合。参见图1，一种用于平衡性能与面积的数字ASIC串并结合乘法器，包括串行乘法计数器模块、操作数多路选择模块和并行乘法器模块，所述串行乘法计数器模块、操作数多路选择模块和并行乘法器模块依次连接，其中，串行乘法计数器模块在每个时钟周期内产生递增的数字点数，并作为选择条件控制操作数多路选择模块输出乘数和被乘数，所述并行乘法器模块接收乘数和被乘数完成乘法计算并输出乘法结果。在本实施例当中，所述操作数多路选择模块包括两个MUX电路：MUX1电路和MUX2电路，MUX1电路用于将输入M1位被宽乘数按N1个多路选择条件等分；MUX2电路用于将输入M2位宽乘数按N2个多路选择条件等分。所述MUX1电路以)作为多路选择器条件可查询被乘数对应位宽的值至，MUX2以)作为多路选择器条件可查询乘数对应位宽的值至。串行乘法计数器模块主要包括一个计数器电路和一个MUX3电路，计数器用于上电后循环产生周期点数，点数用于MUX3电路的多路选择输入，目的是实现计数器点数控制串行复用乘法器的行进方向，所述行进方向如图2所示，与阵列乘法器有相似的原理，但进位传播路线和乘法行进路线与阵列乘法器完全不同。进一步的，所述MUX3电路通过将计数器点数作为多路选择器条件，每个计数器点数会为MUX1电路与MUX2电路的多路选择条件赋值，进而与部分位宽操作数进行匹配，如MUX3即对应到MUX1和MUX2，对应查询到被乘数与乘数相应位宽上的值。并行乘法器模块包括并行乘法器电路与累加和电路。并行乘法器模块指依赖于综合库指定或定制IP，选择在一个时钟周期内完成并行乘法运算的乘法器，该发明中，不同位宽的并行乘法器的类型需一致。并行乘法器位宽的选择要结合数据采样率、时钟频率以及设计面积的规划来做出判断，具体地，根据数据采样率fs与时钟频率fclk计算其倍数关系h，所述的倍数关系h计算公式如下：h=fclk/fs；h即最大串行复用乘法器的周期数，根据周期数可选择最小位宽并行乘法器；进一步地，根据面积和计算性能做出合理调整，共同决定并行乘法器位宽与串行复用乘法器的周期数。并行乘法器模块中乘法模块的被乘数和乘数由MUX1电路与MUX2电路的输出传入。累加和电路完成当前乘法输出位的累加与低和位乘法结果的进位加法作为当前位的乘法结果输出，并产生进位，从而依次完成从最低位到最高位的运算。所述进位即当前乘法结果的高位，如临时寄存器位宽为Y位，当前乘法输出结果为X位，则Y所在高位应作为进位参与下一次乘法运算的高位的累加。通过串行控制乘法电路的复用，在当前位完成乘法结果后产生相应位宽的输出，在当前位输出后，对该临时寄存器做覆写操作，可以将并形乘法器的临时寄存器数量控制到仅为1个，临时寄存器的位宽为乘法中间位结果的最大位宽。具体的，操作数多路选择模块中MUX1电路的输入端与被乘数数据相连接、MUX2电路的输入端与乘数数据连接，MUX1电路的case1与MUX2电路的case2的输入端与串行乘法计数器模块中MUX3的输出端信号连接。根据MUX1中case1的不同，选择被乘数的不同位作为输出；根据MUX2中case2的不同，选择乘数的不同位作为输出；串行乘法计数器模块中的计数器电路用于每个时钟周期产生递增的数字点数，每个周期产生的点会作为MUX3的多路选择条件，每个条件下case1和case2都会赋特殊值，该输出则与MUX1与MUX2中的case1与case2连接，case1和case2的赋值可参考附图2。并行乘法器模块中的被乘数输入与MUX1模块输出相连、乘数输入与MUX2模块输出相连，并行乘法器模块的输出直接作为该模块的输出，按位串行输出乘法结果，即根据计数器产生的数字点数为并行乘法器提供被乘数与乘数的指定位，计数器产生的数字点数串行控制并行乘法器计算。在本实施例中，通过计算倍数h=fclk/fs，即最大串行复用乘法器的周期数，输入的被乘数与乘数的位宽为48，通过面积与性能的考虑，采用并行乘法器，总串行复用周期数为36，即确定计数器的最大点数可为36，临时寄存器的位宽为19，采用8bit串行输出，如附图2所示。进一步的，MUX1和MUX2为6路选择器，MUX3为36路选择器。在计数器为0时刻，MUX3中多路选择产生赋值为case1=0,case2=0；MUX1与MUX2选择从输出端传递到并行乘法器输入端的被乘数A与乘数B，产生16bit的乘法结果存入19bit临时寄存器a，该临时寄存器a取aS0，高11位作为进位寄存，需要产生两个进位数据carry1与carry2，carry1为乘法结果的a进行寄存，carry2为a，进行移位寄存。进一步地，产生清零信号和输出有效信号，清零信号使下一次完成乘法写入寄存器是做覆写操作而不是累加操作，输出有效信号使下一时刻输出该位结果。在计数器为1时刻，MUX3中多路选择产生赋值为case1=0,case2=1；乘法器输入端传递被乘数A与乘数B，完成乘法后，产生16bit乘法结果，进行覆写操作。在计数器为2时刻，MUX3中多路选择产生赋值为case1=1,csae2=0；乘法器输入端传递被乘数A与乘数B。完成乘法后，产生16bit乘法结果，该结果与第1时刻的乘法结果进行累加操作，然后与第0时刻的进位完成加法运算，产生19bit累加和结果，同时输出a,即S1；此时产生清零信号和输出有效信号，该结果产生的两个进位数据carry1与carry2，carry1则覆写过去的carry1中的值，carry2则移位寄存。所述进位信号carry1总是需要寄存延迟到下一个累加和时刻后覆写；carry2则总是需要移位寄存两个累加和时刻后覆写。在形如第0，2，5，9等时刻在该位乘法完成后产生串行乘法输出，同时产生进位数据、清零信号和输出有效信号。在形如1，3，6，10等时刻完成上一次乘法输出后，完成临时寄存器的覆写操作。在完成一次完整的乘法运算后，计数器完成一次清零复位，重新开始计数。利用数字电路常见的计数器电路、MUX电路复用低位宽的并行乘法器和加法器以及一定数量的寄存器，实现串并结合的乘法器电路。与传统的串行乘法器相比，可大幅度提高乘法运算速度，与目前主流的并行乘法器相比，显著节约了芯片面积。通过串行控制乘法的行进方向，使临时寄存器得到了最大复用，极大的节省了电路面积，并且通过该行进方式完成的串行乘法器都仅需一个临时寄存器并不仅局限于在该发明中的应用。基于上述实施例，本发明提供的用于平衡性能与面积的数字ASIC串并结合乘法器，采用简单的逻辑结构和电路实现方式，可根据设计需求的不同，调整串行周期和并行乘法器的操作数位宽，进而灵活的取舍乘法器的面积与性能。对于前述的实施例，为了简单描述，故将其都表述为一系列的动作组合，但是本领域技术人员应该知悉，本申请并不受所描述的动作顺序的限制，因为依据本申请，某一些步骤可以采用其他顺序或者同时进行。其次，本领域技术人员也应该知悉，说明书中所描述的实施例属于优选实施例，所涉及的动作并不一定是本申请所必须的。上述实施例中，描述了本发明的基本原理和主要特征和本发明的优点。本行业的技术人员应该了解，本发明不受上述实施例的限制，上述实施例和说明书中描述的只是说明本发明的原理，在不脱离本发明精神和范围的前提下，本领域人员所进行的改动和变化不脱离本发明的精神和范围，则都应在本发明所附权利要求的保护范围内。
