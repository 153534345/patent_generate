标题title
一种基于图像处理的人迹检测方法
摘要abst
本发明涉及图像识别技术领域，具体涉及一种基于图像处理的人迹检测方法，获取目标对象的连续多帧图像的视频图像数据集；对视频图像数据集中各帧图像进行放大处理，得到放大图像集；将所述放大图像集作为输入数据，标签作为输出数据，对预先构建的网络模型进行训练，基于训练后的网络模型完成待测目标对象的识别。即本发明在进行人迹行为中微小变化信号的检测时，能够提高视频图像的清晰度，避免视频图像失真模糊的问题。
权利要求书clms
1.一种基于图像处理的人迹检测方法，其特征在于，包括以下步骤：获取目标对象的连续多帧图像的视频图像数据集；对视频图像数据集中各帧图像进行放大处理，得到放大图像集；将所述放大图像集作为输入数据，标签作为输出数据，对预先构建的网络模型进行训练，基于训练后的网络模型完成待测目标对象的识别；其中，所述放大图像集中放大图像的获取过程为：采用欧拉视频动作放大算法对当前帧图像中各像素点的亮度值进行放大，得到放大亮度值；将放大亮度值与亮度值的差值作为放大效果；获取当前帧图像中各像素点的噪声概率，所述噪声概率为至少两个噪声指标的均值，所述噪声指标包括第一噪声指标、第二噪声指标和第三噪声指标；采用各像素点的噪声概率，对所述放大效果进行调整，将调整后的放大效果与亮度值进行叠加，得到调整亮度值，最终得到放大图像；其中，所述第一噪声指标由当前帧图像中各像素点与其邻域内像素点的灰度差值以及灰度差值的熵值确定；所述第二噪声指标由当前帧图像与前一帧图像的差异图像中各像素点的灰度值与对应的邻域内所有像素点的灰度值均值确定；所述第三噪声指标的获取过程为：获取当前帧图像及其前后相邻的连续多帧图像中相同位置像素点的灰度级别序列；计算当前帧图像的像素点的当前灰度级别与灰度级别序列中出现次数最多的灰度级别的差值绝对值；统计灰度级别序列中出现所述当前灰度级别的频数；基于所述频数以及差值绝对值，得到第三噪声指标。2.根据权利要求1所述的一种基于图像处理的人迹检测方法，其特征在于，所述第一噪声指标为：其中，为第一噪声指标，/＞表示第i帧图像中第j个像素点与该像素点的第k个邻域像素点的灰度差值，/＞为第t类灰度差值出现的频率，/＞表示第j个像素点邻域内灰度差值的熵的相反数，T为不同灰度差值的类别总数，exp为以自然常数e为底数的指数函数。3.根据权利要求2所述的一种基于图像处理的人迹检测方法，其特征在于，所述第二噪声指标为：其中，为第二噪声指标，/＞表示第i-1帧图像与第i帧图像的差异图像中第j个像素点的灰度值，/＞表示差异图像中第j个像素点的第/＞个邻域像素点的灰度值，/＞为差异图像中的第j个像素点的邻域总个数，其中i大于1。4.根据权利要求3所述的一种基于图像处理的人迹检测方法，其特征在于，当噪声概率为第一噪声指标和第二噪声指标的均值时，所述调整亮度值为：其中，表示第i帧图像中第j个像素点的噪声概率，/＞为第一噪声指标，/＞为第二噪声指标，/＞表示第i帧图像中第j个像素点的亮度值，/＞表示第i帧图像中第j个像素点经过欧式视频动作放大算法放大处理之后得到的放大亮度值，/＞表示放大效果，/＞表示第i帧图像中第j个像素点的调整亮度值。5.根据权利要求4所述的一种基于图像处理的人迹检测方法，其特征在于，所述第三噪声指标为：其中，M表示灰度级别序列中与第i帧图像中第j个像素点的灰度级别相同的灰度级别的频数，表示第i帧图像中第j个像素点对应的灰度级别序列中相同灰度级别个数最多的灰度级别，/＞为第i帧图像中第j个像素点的灰度级别，exp为以自然常数e为底数的指数函数。6.根据权利要求5所述的一种基于图像处理的人迹检测方法，其特征在于，当噪声概率为第一噪声指标、第二噪声指标以及第三噪声指标的均值时，所述调整亮度值为：其中，表示第i帧图像中第j个像素点的噪声概率，/＞为第一噪声指标，为第二噪声指标，/＞为第三噪声指标，/＞表示第i帧图像中第j个像素点的亮度值，/＞表示第i帧图像中第j个像素点经过欧式视频动作放大算法放大处理之后得到的放大亮度值，/＞表示放大效果，/＞表示第i帧图像中第j个像素点的调整亮度值。7.根据权利要求1所述的一种基于图像处理的人迹检测方法，其特征在于，所述网络模型采用yolov5网络模型。8.根据权利要求1所述的一种基于图像处理的人迹检测方法，其特征在于，所述标签是对放大图像集中的各放大图像进行人工标注得到的。
说明书desc
技术领域本发明涉及图像识别技术领域，具体涉及一种基于图像处理的人迹检测方法。背景技术现有对人的行为变化进行的目标检测算法是针对较大幅度的行为动作，通过对图像或视频标注数据集，对构建的人工神经网络模型进行训练，使用训练完成后的人工神经网络模型进行人的行为动作的识别。而对于视频图像中的微小变化信号，如脸部皮肤的颜色变化，腹部起伏以及头部振动等，往往无法准确识别。然而，这些微小变化信号通常还包含着丰富的信息，例如人面部皮肤的颜色变化频率与心率和呼吸率有关；腹部的起伏周期与人体呼吸周期一致；头部的振动周期也与心率和呼吸率有关。由此，视频放大技术应运而生。其中，视频放大技术是一种利用图像序列时空信息处理改变影像中微小变化幅度的技术，其可以将自然界中微小变化信号的幅度进行增强，实现对肉眼难以感知的微小变化的可视化，从而揭示自然界中微小变化所蕴含的重要信息与规律。其中，视频放大技术包括欧拉视频放大技术，该放大技术是采用欧拉视角的思路方法，从全局角度分析视频内容的时空变化特性，感知图像序列中的微小变化。因此，对于微小变化信号的识别，可通过对数据集中的视频图像进行欧拉视频动作放大处理，再进行人工神经网络的模型训练，实现微小变化信号的检测。但是，欧拉视频放大算法在视频放大过程中，其不仅对图像中的目标进行了放大，还对图像中的噪声进行了放大，这样就导致放大后的视频图像出现失真模糊情况的问题。因此，在进行人迹行为中的微小变化信号检测时，如何避免放大后的视频图像的失真模糊问题，是尤为重要的。发明内容本发明的目的在于提供一种基于图像处理的人迹检测方法，用于解决现有在进行人迹行为中的微小变化信号检测时，放大后的视频图像容易出现失真模糊的问题。为解决上述技术问题，本发明提供的一种基于图像处理的人迹检测方法，包括以下步骤：获取目标对象的连续多帧图像的视频图像数据集；对视频图像数据集中各帧图像进行放大处理，得到放大图像集；将所述放大图像集作为输入数据，标签作为输出数据，对预先构建的网络模型进行训练，基于训练后的网络模型完成待测目标对象的识别；其中，所述放大图像集中放大图像的获取过程为：采用欧拉视频动作放大算法对当前帧图像中各像素点的亮度值进行放大，得到放大亮度值；将放大亮度值与亮度值的差值作为放大效果；获取当前帧图像中各像素点的噪声概率，所述噪声概率为至少两个噪声指标的均值，所述噪声指标包括第一噪声指标、第二噪声指标和第三噪声指标；采用各像素点的噪声概率，对所述放大效果进行调整，将调整后的放大效果与亮度值进行叠加，得到调整亮度值，最终得到放大图像；其中，所述第一噪声指标由当前帧图像中各像素点与其邻域内像素点的灰度差值以及灰度差值的熵值确定；所述第二噪声指标由当前帧图像与前一帧图像的差异图像中各像素点的灰度值与对应的邻域内所有像素点的灰度值均值确定；所述第三噪声指标的获取过程为：获取当前帧图像及其前后相邻的连续多帧图像中相同位置像素点的灰度级别序列；计算当前帧图像的像素点的当前灰度级别与灰度级别序列中出现次数最多的灰度级别的差值绝对值；统计灰度级别序列中出现所述当前灰度级别的频数；基于所述频数以及差值绝对值，得到第三噪声指标。可选地，所述第一噪声指标为：其中，为第一噪声指标，/＞表示第i帧图像中第j个像素点与该像素点的第k个邻域像素点的灰度差值，/＞为第t类灰度差值出现的频率，/＞表示第j个像素点邻域内灰度差值的熵的相反数，T为不同灰度差值的类别总数，exp为以自然常数e为底数的指数函数。可选地，所述第二噪声指标为：其中，为第二噪声指标，/＞表示第i-1帧图像与第i帧图像的差异图像中第j个像素点的灰度值，/＞表示差异图像中第j个像素点的第/＞个邻域像素点的灰度值，/＞为差异图像中的第j个像素点的邻域总个数，其中i大于1。可选地，当噪声概率为第一噪声指标和第二噪声指标的均值时，所述调整亮度值为：其中，表示第i帧图像中第j个像素点的噪声概率，/＞为第一噪声指标，为第二噪声指标，/＞表示第i帧图像中第j个像素点的亮度值，/＞表示第i帧图像中第j个像素点经过欧式视频动作放大算法放大处理之后得到的放大亮度值，表示放大效果，/＞表示第i帧图像中第j个像素点的调整亮度值。可选地，所述第三噪声指标为：其中，M表示灰度级别序列中与第i帧图像中第j个像素点的灰度级别相同的灰度级别的频数，表示第i帧图像中第j个像素点对应的灰度级别序列中相同灰度级别个数最多的灰度级别，/＞为第i帧图像中第j个像素点的灰度级别，exp为以自然常数e为底数的指数函数。可选地，当噪声概率为第一噪声指标、第二噪声指标以及第三噪声指标的均值时，所述调整亮度值为：其中，表示第i帧图像中第j个像素点的噪声概率，/＞为第一噪声指标，/＞为第二噪声指标，/＞为第三噪声指标，/＞表示第i帧图像中第j个像素点的亮度值，/＞表示第i帧图像中第j个像素点经过欧式视频动作放大算法放大处理之后得到的放大亮度值，/＞表示放大效果，/＞表示第i帧图像中第j个像素点的调整亮度值。可选地，所述网络模型采用yolov5网络模型。可选地，所述标签是对放大图像集中的各放大图像进行人工标注得到的。本发明的有益效果为：本发明的方案通过对每帧图像中的每个像素点进行噪声可能性的检测，从单帧图像、相邻两帧图像、连续多帧图像的至少两个方面综合分析，得到各像素点为噪声的可能性大小，并在采用欧拉视频动作放大算法过程中，对属于噪声可能性大的像素点不进行放大处理或者使得放大程度尽可能的小，从而对噪声可能性小的像素点进行放大处理，这样就减小了噪声对放大后视频图像的影响，提高放大后的视频图像的图像质量。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1示意性示出了本发明的一种基于图像处理的人迹检测方法的步骤流程图；图2示意性示出了本发明的一种基于图像处理的人迹检测方法中获取第三噪声指标的步骤流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的技术方案的具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的一个实施例或另一个实施例指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构、或特点可由任何合适形式组合。在捕捉目标对象的微小动作变化时，采用欧拉视频动作放大算法对动作放大处理时，其对图像中的噪声也进行了放大，导致放大后的视频图像出现失真模糊的问题，基于此，本发明提出了一种基于图像处理的人迹检测方法，即通过对目标对象在某时间段的视频数据集进行噪声检测分析，将噪声可能性大的像素点不进行放大处理或者放大程度降低，对噪声可能性小的像素点进行放大处理，从而减小噪声对放大后图像的影响，以获取高质量的视频图像，实现目标对象的行为动作的变化。需要说明的是，上述目标对象可以为人；示例性的，其可以针对视频会议或者工作过程中的人员的状态进行检测，如疲劳、走神、瞌睡或其他身体状态等的异常行为；尤其是，对于一些特殊工作场景的人员，如驾驶长途汽车的驾驶员，可以检测驾驶员的疲劳状态以及身体异常情况，并予以提醒，以保证安全驾驶；又如工厂内、矿井里操控危险机器进行作业时的操作员，可以检测操作员的疲劳状态、呼吸状态等的微小变化动作，能够及时发现异常，并进行警报提醒，以提高人员的安全性。当然也可以针对人的身体健康状态的监测，如婴儿的呼吸状态、人体的震颤信息等等。当然目标对象也可以为设备，即对运行过程中设备的微小振动进行检测，以确定设备是否存在故障，示例性的，该目标对象可以是台式电风扇，那么采集的目标视频图像为运行过程中台式电风扇。图1示意性示出了本发明的一种基于图像处理的人迹检测方法的步骤流程图。图2示意性示出了本发明的一种基于图像处理的人迹检测方法中获取第三噪声指标的步骤流程图。本实施例中以作业人员为例，对本实施例中的一种基于图像处理的人迹检测方法进行具体介绍。如图1所示，本发明的一种基于图像处理的人迹检测方法，包括如下步骤：在步骤S1处，获取目标对象的连续多帧图像的视频图像数据集。通过在工厂内、办公室或者办公区域内设置的摄像头，拍摄一段时间内作业人员的坐姿或站立状态的视频，并对获取的视频中每帧图像进行人体不同身体部位的识别，以获得局部视频图像数据，本实施例中将获取的各帧图像的局部视频图像数据作为视频图像数据集。当然作为其他实施方式，本实施中获取的视频，还可以为人体的局部位置，如人脸、胸部或上肢等信息，由于不同身体部位的微小变化动作分别表征不同的身体状态信息，因此，可根据实际需要，采集身体部位的局部位置的视频，将局部位置的视频中的所有帧图像作为视频图像数据集。需要说明的是，本实施例中针对的是工厂内的作业人员的工作状态进行检测，如走神、疲劳等，因此，以人脸的局部图像为例，获取某段时间内人脸的图像数据，并对各图像数据进行灰度处理，得到视频图像数据集。在步骤S2处，对视频图像数据集中各帧图像进行放大处理，得到放大图像集。在一个实施例中，放大图像集中放大图像的获取过程为：采用欧拉视频动作放大算法对当前帧图像中各像素点的亮度值进行放大，得到放大亮度值；将放大亮度值与亮度值的差值作为放大效果；获取当前帧图像中各像素点的噪声概率，所述噪声概率为至少两个噪声指标的均值，所述噪声指标包括第一噪声指标、第二噪声指标和第三噪声指标；采用各像素点的噪声概率，对所述放大效果进行调整，将调整后的放大效果与亮度值进行叠加，得到调整亮度值，最终得到放大图像。其中，欧拉视频动作放大算法利用时空处理方法来增强特定的颜色变化，能够放大视频中的特定颜色变化，以及放大感兴趣的动作变化的效果。欧拉视频动作放大算法核心步骤在于对视频的每一帧进行拉普拉斯金字塔分解，并进行滤波处理，对滤波后的每一层信号乘以特定的放大倍率，并与频域滤波前原始信号相加，得到新的金字塔，合成新的金字塔中的每一层，得到最终的放大后的视频。由于欧拉视频动作放大算法对图像的放大处理为现有技术，此处不再过多赘述具体的放大过程。由于欧拉视频动作放大算法通过增强每个像素的亮度变化，使得本身不明显的动作变化变得明显。但是该算法对于滤波处理无法过滤掉的噪声也进行了放大处理，因此本发明对每帧图像中的每个像素点进行了噪声的可能性检测，得到对应的噪声概率，并对欧拉视频动作放大算法中的放大效果进行调整，以减小噪声的放大对视频的影响。需要说明的是，本实施例中的噪声概率可以是第一噪声指标、第二噪声指标和第三噪声指标中的至少两种组合，也就是说，三种噪声指标中任意两种或者三种均可以对各帧图像的像素点的噪声进行评估。其中，第一噪声指标由当前帧图像中任一像素点与其邻域内像素点的灰度差值以及灰度差值的熵值确定。这是由于噪声分布具有随机性，且在单帧图像中，如果一个像素点的灰度值与邻域内像素灰度值的差值都较大，其可能为噪声，当然也可能为图像的边缘。当该点为噪声时，其与邻域内像素点灰度差值范围均相近，混乱程度小，邻域的熵较小；当该点为边缘时，其与邻域内像素点的灰度差值范围较大，较为混乱，此时邻域的熵较大。因此利用该像素点与其邻域的灰度差值及其灰度差值的熵，衡量单帧图像中各像素点为噪声可能性。具体地，第一噪声指标为：其中，表示第i帧图像中第j个像素点与该像素点的第k个邻域像素点的灰度差值，/＞为第t类灰度差值出现的频率，/＞表示第j个像素点邻域内灰度差值的熵的相反数，T为不同灰度差值的类别总数，exp为以自然常数e为底数的指数函数。其中，是当前像素点与周围邻域的灰度差值均值的归一化值，其中的分母上的255是为了将灰度差值均值进行归一化，当/＞越大，说明该像素点与邻域内其余像素点的灰度值的差值较大，该位置为噪声或者边缘的可能性越大。/＞表示该像素点与周围邻域内像素点的灰度差值的熵的相反数，当熵越小时，越大，说明灰度差值越为相近，混乱程度越小，该像素点为边缘的可能性越小，为噪声的可能性越大，从而/＞越大。上述中的像素点的邻域可以为八邻域，也可以为四邻域。本实施例中采用八邻域进行相关数据的分析，即K=8。以八邻域为例，本实施例中可得到8个灰度差值，对得到的8个灰度差值出现的频数进行计数，得到不同灰度差值的类别总数T以及对应的出现频率，将第t类灰度差值出现的频率记为/＞，计算该像素点的与8邻域内像素点的灰度差值的熵，进而得到单帧图像中当前像素点的噪声指标/＞。需要说明的是，T的数量是基于8个灰度差值确定的，当8个灰度差值中存在相同灰度差值时，T的值必然小于8。进一步地，由于噪声通常是孤立存在且无变化规律，而人的动作变化通常会引起大范围内像素点的灰度变化，因此，通过获取相邻两帧图像的差异图像，并对差异图像进行邻域分析，即从相邻两帧图像的变化衡量当前帧图像的各像素点的第二噪声指标，具体为：其中，表示第i-1帧图像与第i帧图像的差异图像中第j个像素点的灰度值，表示差异图像中第j个像素点的第/＞个邻域像素点的灰度值，/＞为差异图像中的第j个像素点的邻域总个数，其中i大于1。上述公式中，表示差异图像中第j个像素点的邻域内所有像素点灰度值的均值；而/＞是为了衡量该像素点与周围邻域像素点的灰度值差异，当/＞远大于/＞时，/＞接近于2，/＞越接近于1；当/＞远小于/＞时，接近于0，/＞越接近于1。即当该像素点的灰度值与周围邻域像素点的差异越大，/＞越接近于1，该像素点的灰度变化越为孤立，该像素点的为噪声的可能性越大。当该像素点的灰度值与周围差异较小，即/＞与/＞越接近，/＞越接近于1，/＞越接近于0，该像素点的灰度变化与周围邻域像素点的灰度变化的差异越小，该像素点的灰度变化越可能为人的动作变化而引起大范围内像素点的灰度变化，噪声的可能性就越小。需要说明的是，本实施例中的差异图像是相邻帧图像中后一帧与前一帧的差异，其中第一帧图像不进行上述操作，进而也不进行放大处理。上述中的像素点的领域可以为八邻域，也可以为四邻域。本实施例中采用八邻域进行相关数据的分析，即取值为8。需要说明的是，由于当前帧图像与相邻帧图像、差异图像的尺寸大小是相同的，因此像素点的个数也是相同，因此，不同图像中的像素点个数以及对应的像素点位置是相同的，不同仅在于灰度值大小；即本实施例中当前帧图像中的第j个像素点与差值图像中的第j个像素点中的j仅表示的是像素点在不同图像上的位置或者个数的顺序，其并不包括该像素点的灰度值大小。进一步地，考虑到人的动作行为在时间上具有连续性，即在连续帧图像中同一个位置处对应的像素点的灰度值变化具有连续性，而噪声是随机的，不具备连续变化性，因此在连续多帧图像中，对同一个位置处的像素点的灰度值及其灰度值出现的频数进行统计分析，以此来区分人的行为与噪声。具体地，第三噪声指标的获取过程为：首先，统计当前帧图像及其前后相邻的连续多帧图像中相同位置处对应像素点的灰度值，并确定各灰度值的灰度级别，将灰度级别按照时序进行排序，得到灰度级别序列；其次，基于所述灰度级别序列，计算当前帧图像的像素点的灰度级别与灰度级别序列中相同灰度级别个数最多的灰度级别的差值绝对值；然后，获取灰度级别序列中与当前帧图像的像素点的灰度级别相同的灰度级别的频数；基于所述频数以及差值绝对值，得到第三噪声指标，具体为：其中，M表示灰度级别序列中与第i帧图像中第j个像素点的灰度级别相同的灰度级别的频数，表示第i帧图像中第j个像素点对应的灰度级别序列中相同灰度级别个数最多的灰度级别，/＞为第i帧图像中第j个像素点的灰度级别，exp为以自然常数e为底数的指数函数。其中，当越小，说明当前位置像素点的灰度值在连续多帧图像中出现的频数越少，该灰度值孤立性越强，其为噪声的可能性越大，此时/＞越大，从而/＞越大，表示当前位置像素点的灰度级别与灰度级别序列中相同灰度级别个数最多的灰度级别的差值，差值越大，说明当前位置像素点的灰度值在连续帧图像中孤立性越强，当前位置的像素点为噪声的可能性越大，即/＞越大。示例性的，对第i帧图像及其前后相邻的各n帧图像进行相同位置的像素点的灰度值的统计，并将所有灰度值按照时间顺序进行排序，得到一个灰度值序列，并计算各灰度值的灰度级别，具体地，将0~255的灰度值，分为26个灰度级别，即级别1、级别2，…，级别25，级别26，其中设定相邻级别的间隔为1；其中，n大于等于3，即n的取值可以为3、4、5、6或者更多个，本实施例中n取值为5。本实施例中根据预先划分的26个灰度级别，确定11帧图像的灰度值序列中的各灰度值的灰度级别，得到对应的灰度级别序列，并对每个灰度级别出现的次数进行统计，得到每个灰度级别的频数，其中，当灰度级别出现的次数越少，灰度级别对应的像素点为噪声的可能性越大。在一个实施例中，当噪声概率为第一噪声指标和第二噪声指标的均值时，基于噪声概率，调整欧拉视频动作放大算法对各帧图像进行放大的放大效果，得到各像素点的调整亮度值，具体为：将经过欧拉视频动作放大算法放大处理之后得到的每一帧图像的每个像素点的放大亮度值与原图像的相同位置的像素点的亮度值作差，得到放大效果，并根据该位置像素点的噪声概率，对放大效果进行调整，将调整后的放大效果与亮度值进行叠加得到调整亮度值，具体如下：其中，表示第i帧图像中第j个像素点的噪声概率，/＞为第一噪声指标，为第二噪声指标，/＞表示第i帧图像中第j个像素点的亮度值，/＞表示第i帧图像中第j个像素点经过欧式视频动作放大算法放大处理之后得到的放大亮度值，表示放大效果，/＞表示第i帧图像中第j个像素点的调整亮度值。需要说明的是，当噪声概率为第一噪声指标和第三噪声指标或第二噪声指标和第三噪声指标时，当前帧图像的各像素点的调整亮度值的计算方式与上述实施例中的计算过程相同，不同仅在于选取的噪声指标。作为最优选的实施例，当噪声概率为第一噪声指标、第二噪声指标以及第三噪声指标的均值时，各像素点的调整亮度值为：其中，表示第i帧图像中第j个像素点的噪声概率，/＞为第一噪声指标，/＞为第二噪声指标，/＞为第三噪声指标，/＞表示第i帧图像中第j个像素点的亮度值，/＞表示第i帧图像中第j个像素点经过欧式视频动作放大算法放大处理之后得到的放大亮度值，/＞表示放大效果，/＞表示第i帧图像中第j个像素点的调整亮度值。其中，当噪声概率越大，即该像素点为噪声的可能性越大，就越小，能够减小对噪声的放大效果；当/＞越小，即该像素点为噪声的可能性越小，为人的动作的可能性越大，/＞就越大，能够对人的动作进行有效放大，因此通过噪声概率对放大效果的调整，以减小噪声对放大后视频的影响。至此，得到了经过放大处理的放大图像，进而得到放大图像集。在步骤S3处，将放大图像集作为输入数据，标签作为输出数据，对预先构建的网络模型进行训练，基于训练后的网络模型完成待测目标对象的识别；其中，标签是对放大图像集中各放大图像进行标注得到的。本实施例中预先构建的网络模型采用yolov5网络模型。由于yolov5网络模型的结构为现有技术，此处不再过多进行赘述。本实施例中，通过构建yolov5网络模型，将经过调整的欧拉视频动作放大算法处理后的放大图像集中的各图像进行人工标注，得到对应的标签，即当放大图像集为人脸时，其标注的标签分为正常状态、疲劳状态、瞌睡状态的三类标签。需要说明的是，疲劳状态可通过人的脸部皮肤颜色确定，如脸部皮肤颜色较其正常状态时发白，可标注为疲劳状态；瞌睡状态可根据人的瞳孔变化以及眨眼情况进行确定。本实施例中的训练数据集由放大图像集和标签构成，并将训练数据集输入yolov5网络模型进行训练，其中，放大图像集作为输入数据，标签作为输出数据；使用训练好的yolov5网络模型对待检测目标对象的视频图像中的人的状态进行检测，其中在进行检测时，需要先对待检测目标对象的视频图像进行放大，之后将放大后的待检测目标对象的视频图像输入训练好的yolov5网络模型，其中待检测目标对象的视频图像的具体放大过程与上述实施例中放大图像集中的放大图像的处理过程相同。本发明的方案，通过对每帧图像中的每个像素点进行噪声可能性的检测，从单帧图像、相邻两帧图像、连续多帧图像中的至少两个方面综合分析，得到该位置像素点为噪声的可能性大小，在欧式视频动作放大算法的放大处理之后，进行各像素点的放大亮度值的调整，将噪声可能性大的像素点的放大效果进行调低，使得调整的放大效果接近于0，而对噪声可能性小的像素点的放大效果，尽可能的保持不变，从而减小了噪声对放大后视频图像的影响，提高放大后的视频图像的图像质量。虽然本说明书已经示出和描述了本发明的多个实施例，但对于本领域技术人员显而易见的是，这样的实施例只是以示例的方式提供的。本领域技术人员会在不偏离本发明思想和精神的情况下想到许多更改、改变和替代的方式。应当理解的是在实践本发明的过程中，可以采用对本文所描述的本发明实施例的各种替代方案。
