标题title
一种基于深度迁移学习的调控变异预测方法
摘要abst
本发明属于生物信息学领域，涉及一种基于深度迁移学习的调控变异预测方法，其中包括卷积自编码器、多任务学习和迁移学习等技术。该方法的核心思想是在非编码变异数据上预训练模型，通过半监督方法学习非编码变异的底层特征表示能力。包括如下步骤：首先构建源域样本和目标域样本，并对DNA序列进行独热编码；其次使用卷积自编码器，通过多任务学习，训练特征提取器；最后将源域样本知识迁移到目标域，辅助模型在目标域进行预测。本方法采用半监督学习方法进行预训练，极大的保留了源域数据的底层特征，可以有效对候选变异进行筛选，对未来的实验验证具有重要意义。
权利要求书clms
1.一种基于深度迁移学习的调控变异预测方法，其特征在于，将上下文无关的非编码变异视为源域，上下文相关的功能性非编码变异视为目标域，通过迁移学习可以将源域知识迁移到目标域中，使用多任务学习方法在模型预训练时综合考虑模型特征提取能力和模型预测能力，该方法包括DNA序列预处理、模型构建、模型预训练、模型迁移、模型预测五个步骤、其具体步骤如下：步骤1、首先构建源域数据，获得M个长度为P的非编码区通用变异，并获取对应的标签；其次构建目标域数据，获得N个长度为P的调控变异，并获取对应的标签；将获得的数据进行独热编码，组成训练数据和测试数据；步骤2、使用一维卷积自编码器对独热矩阵进行特征压缩，将得到的特征输入前馈神经网络学习特征映射并进行分类，同时将特征输入到一维卷积自解码器进行特征重构；步骤3、使用交叉熵误差计算前馈神经网络的预测结果与真实标签的差异，同时采用均方误差计算一维卷积自动解码器的输出特征与输入特征的差异，并将二者损失混合后进行反向传播训练模型；步骤4、使用步骤3获得的编码器迁移到目标域数据进行特征压缩，并结合前馈神经网络进行训练，为了防止过拟合，编码器不进行微调，只针对新的全连接层训练，保存训练好的模型；步骤5、使用步骤4训练好的模型对目标域测试数据进行预测，获得分类的结果。2.根据权利要求1所述的一种基于深度迁移学习的调控变异预测方法，其特征在于，使用独热编码可以有效表示DNA序列的时空特征，DNA序列的预处理的实现过程如下：对获得的DNA序列数据进行独热编码，具体是根据序列中A、C、G、T 四种碱基分别对应、、、四种数据矩阵来编码，编码后源域数据和目标域数据对应维度分别是M×P×4，N×P×4，其中M为源域数据的个数，N为目标域数据的个数，P为序列的长度。3.根据权利要求1所述的一种基于深度迁移学习的调控变异预测方法，其特征在于，通过卷积自编码器学习如何压缩DNA序列和重构DNA序列，同时使用编码器产生的特征向量进行预测，可以更好的训练特征提取器，模型构建的实现过程如下：在构建模型时，使用keras.layers的Conv1D、MaxPooling1D、UpSampling1D、Conv1DTranspose构建主干网络，主干网络以独热矩阵作为输入，第一层使用一维卷积层，第二层使用一维最大池化层，第三层使用一维上采样层，第四层使用一维反卷积层，第五层使用一维反卷积层；使用keras.layers的Dense构建预测网络，第一层和第二层均为全连接层，使用主干网络第二层的输出作为输入；其中编码器的操作定义为：；对于输入的独热矩阵X，首先进行1维卷积，并进行均匀填充，保持时间维度大小不变，然后进行一维最大池化，压缩时间维度大小到原来的1/7；解码器的操作定义为：；对于编码器的输出Z，首先进行上采样，将时间维度大小恢复到压缩前，然后进行两次一维反卷积，进行均匀填充，保持时间维度大小不变，输出重构矩阵/＞。4.根据权利要求1所述的一种基于深度迁移学习的调控变异预测方法，其特征在于，使用混合损失进行误差反向传播来更新参数，通过多任务学习方法使卷积自编码器在学习特征压缩和重构能力的同时，又考虑该特征能否实现好的预测效果，更好的进行预训练，模型预训练的实现过程如下：在模型的训练过程中，混合损失函数定义为：；其中/＞是重构损失，使用均方误差来衡量，/＞是预测误差，使用交叉熵损失来衡量，/＞为权重系数，用于衡量重构误差和预测误差所占的比例；所述的均方误差定义为：；其中，n表示批量数，xij表示独热矩阵中某一位置的元素值，x′ij表示重构矩阵中对应位置的元素值；所述的交叉熵函数定义为：；其中，/＞是第i个样本的预测概率，/＞是第i个样本的标签；每一轮训练时，通过Adam优化器进行混合误差反向传播，并根据20%的验证集上的准确率对k进行自适应调整，自适应调整的公式定义为：；其中，/＞为第i轮的权重系数，/＞为自定义更新系数，/＞为第i轮中验证集上的准确率，设定初始的/＞为0.5，/＞为0.2。5.根据权利要求1所述的一种基于深度迁移学习的调控变异预测方法，其特征在于，在模型迁移的过程中，冻结编码器的参数，针对目标数据训练全连接层，学习上下文特定非编码变异的高级特征，模型迁移的实现过程如下：在模型的迁移过程中，为了防止过拟合，不针对目标域对编码器的参数进行微调，保持编码器在源域学习的参数不变，只对新的全连接神经层进行训练；将目标域的特征矩阵输入到编码器，得到压缩表示的对应特征图，展平后将输入的特征送入两层全连接层，第一层有60个神经元，使用Sigmoid函数激活，并以0.5的概率进行Dropout操作，第二层有2个神经元，使用Softmax函数激活，对应目标域数据中的两个类别，保存训练好的模型。6.根据权利要求1所述的一种基于深度迁移学习的调控变异预测方法，其特征在于，使用训练好的模型进行预测，模型预测的实现过程如下：将调控变异序列的独热编码矩阵输入到步骤4中训练好的模型进行预测，得到预测结果，两个输出结果分别代表阴性变异和阳性变异的概率。
说明书desc
技术领域本发明属于生物信息学领域，涉及一种基于深度迁移学习的调控变异预测方法，其中包括卷积自编码器、多任务学习和迁移学习等技术。背景技术预测人类基因组中的功能性或者致病性调控变异有助于解释疾病的因果关系。但是由于连锁不平衡，某个基因座上的等位基因往往与其相邻基因座上的等位基因一起遗传，不确定到底是该基因座自身的变异导致了相关性，还是与其连锁的其他基因座所导致，很难从多个相关变异中确定可能的因果变异。大规模平行报告基因测定是一种高通量的功能分析方法，通过在单个实验中研究成千上万个基因序列及其变体的调控活性，为评估遗传变异的功能效应提供了重要的机会。随着MPRA实验越来越流行，发现了越来越多的功能性非编码变异，但是与人类基因组的规模相比，经过验证的非编码变异数量仍然很少。现有的迁移学习在源域进行预训练时通常只考虑模型的预测性能，而忽略了特征压缩的能力，导致模型迁移到目标域后特征压缩能力不足，性能下降，这限制了开发一个有效的深度迁移学习模型来预测非编码变异的功能。特征压缩的目的是从高维特征中提取出最关键和有用的信息，并以更低维度的形式表示。通过特征压缩和特征重构，可以过滤掉无关特征和噪声，提取出更精确和鲁棒的特征表示，使得模型具备更强的泛化能力。此外，多任务学习的优势也在于特征提取和预测的联合建模，它可以提高深度迁移学习模型的性能。发明内容本发明最重要的创新点是采用半监督的训练模式，通过多任务学习使模型在源域进行预训练时，可以兼顾特征压缩与模型预测的能力，有效巩固非编码变异底层特征的学习。另外，针对目标任务对模型的全连接层进行训练，构成一个完整的针对目标任务的预测模型，提高了对MPRA验证变异的预测精度。一种基于深度迁移学习的调控变异预测方法，包括DNA序列的预处理、模型构建、模型预训练、模型迁移和模型预测五个过程，其具体步骤如下：步骤1、DNA序列的预处理：首先构建源域数据，获得M个长度为P的非编码区通用变异，并获取对应的标签；其次构建目标域数据，获得N个长度为P的非编码调控变异，并获取对应的标签；将获得的数据进行独热编码，组成训练数据和测试数据；步骤2、模型构建：使用一维卷积自编码器对独热矩阵进行特征压缩，将得到的特征输入前馈神经网络学习特征映射并进行分类，同时将特征输入到一维卷积自解码器进行特征重构；步骤3、模型预训练：采用交叉熵误差计算前馈神经网络的预测结果与真实标签的差异，同时采用均方误差计算一维卷积自动解码器的输出特征与输入特征的差异，并将二者损失混合后进行反向传播训练模型；步骤4、模型迁移：将步骤3获得的编码器迁移到目标域数据进行特征压缩，并结合前馈神经网络进行训练，为了防止过拟合，编码器不进行微调，只针对新的前馈神经网络进行再训练，保存训练好的模型；步骤5、模型预测：使用步骤4训练好的模型对目标域测试数据进行预测，获得分类的结果。一种基于深度迁移学习的调控变异预测方法，步骤1的实现过程如下：对获得的DNA序列数据进行独热编码，具体是根据序列中A、C、G、T 四种碱基分别对应、、、四种数据矩阵来编码，编码后源域数据和目标域数据对应维度分别是M×P×4，N×P×4，其中M为源域数据的个数，N为目标域数据的个数，P为序列的长度。一种基于深度迁移学习的调控变异预测方法，步骤2的实现过程如下：模型构建部分包括主干网络和预测网络，由一维卷积自编码器，一维卷积自解码器，前馈神经网络构成；主干网络以独热矩阵作为输入，第一层使用一维卷积层，第二层使用一维最大池化层，第三层使用一维上采样层，第四层使用一维反卷积层，第五层使用一维反卷积层；其中第一层中卷积核个数是30，窗口长度是30，第二层的池化步长大小为7，第三层的上采样因子为7，第四层中卷积核个数是30，窗口长度是30，第五层中卷积核个数是4，窗口长度是30，此外一维卷积层和一维反卷积层均使用ReLU函数进行激活，并进行均匀填充；预测网络使用的是前馈神经网络，第一层和第二层均为全连接神经网络，其中第一层的神经元个数为128，使用ReLU函数激活，并以0.5的概率进行Dropout操作，第二层的神经元个数为2，使用Softmax函数激活，对应源域数据中的两个类别；其中编码器的操作定义为：；对于输入的独热矩阵X，首先进行Conv1，并进行均匀填充，保持时间维度大小不变，然后进行Maxpool1，压缩时间维度大小到原来的1/7。解码器的操作定义为：；对于编码器的输出Z，首先进行UpSampling，将时间维度大小恢复到压缩前，然后进行两次Conv1Tranpose，进行均匀填充，保持时间维度大小不变，输出重构矩阵/＞。一种基于深度迁移学习的调控变异预测方法，步骤3的实现过程如下：在模型的训练过程中，混合损失函数定义为：；其中/＞是重构损失，使用均方误差来衡量，/＞是预测误差，使用交叉熵损失来衡量，/＞为权重系数，用于衡量重构误差和预测误差所占的比例；所述的均方误差定义为：；其中，n表示批量数，xij表示独热矩阵中某一位置的元素值，x′ij表示重构矩阵中对应位置的元素值。所述的交叉熵函数定义为：；其中，/＞是第i个样本的预测概率，/＞是第i个样本的标签；每一轮训练时，通过Adam优化器进行混合误差反向传播，并根据20%的验证集上的准确率对k进行自适应调整，自适应调整的公式定义为：；其中，/＞为第i轮的权重系数，/＞为自定义更新系数，/＞为第i轮中验证集上的准确率，设定初始的/＞为0.5，/＞为0.2。一种基于深度迁移学习的调控变异预测方法，步骤4的实现过程如下：在模型的迁移过程中，为了防止过拟合，不针对目标域对编码器的参数进行微调，保持编码器在源域学习的参数不变，只对新的前馈神经网络进行再训练；将目标域的特征矩阵输入到编码器，得到压缩表示的对应特征图，展平后将输入的特征送入两层全连接层，第一层有60个神经元，使用Sigmoid函数激活，并以0.5的概率进行Dropout操作，第二层有2个神经元，使用Softmax函数激活，对应目标域数据中的两个类别，保存训练好的模型。一种基于深度迁移学习的调控变异预测方法，步骤5的实现过程如下：将目标域数据的独热矩阵输入到步骤4中训练好的模型进行预测，得到预测结果，0表示阴性变异，1表示阳性变异。本发明与现有技术相比具有以下优点：模型在源域进行预训练的结构包括主干网络和预测网络两部分，通过多任务学习，使模型在训练的过程中同时兼顾预测能力与特征压缩能力，有效的对非编码变异底层特征进行学习；在知识迁移过程中，通过前馈神经网络的针对训练和不进行编码器微调，可以有效的学习非编码变异高级特征的表示能力，提高预测性能的同时避免过拟合的风险。附图说明图1是基于深度迁移学习的调控变异预测方法的流程图。图2是训练深度迁移学习模型流程图。具体实施方式以下结合附图和实例对本发明进行详细说明，本发明具体步骤如下：步骤1、DNA序列的预处理。源域数据从公开数据库 HGMD, ClinVar, OregAnno下载获得，包括5247个非编码阳性变异，55 923个非编码阴性变异。将获得的DNA序列进行独热编码，这样可以获得的特征矩阵可以表示为：；横向特征维度为4，代表A、C、G、T四个特征，纵向时间维度为i，代表i个碱基。本发明使用的非编码变异序列是根据变异位点及上下游延伸500bp的侧翼基因组序列作为模型输入，故编码后的每一变异序列对应1001×4的特征矩阵。 步骤2、模型构建。主干网络的输入是batch×1001×4的特征矩阵，第一层为一维卷积层，卷积核个数为30，窗口长度为30，并进行均匀填充，使用ReLU函数激活，特征矩阵经过第一层处理后，通道数变为30，特征数为1001；第二层为一维最大池化层，池化步长为7，第二层处理后特征数变为143，通道数不变；第三层为一维上采样层，上采样因子为7，第三层处理后特征数变为1001，通道数不变；第四层为一维反卷积层，卷积核个数为30，窗口长度为30，使用ReLU函数激活，并进行均匀填充，第四层处理后通道数和特征数不变，仍为30和1001；第五层为一维反卷积层，卷积核个数为4，窗口长度为30，使用Softmax函数激活，并进行均匀填充，第五层处理后通道数变为4，特征数为1001； 预测网络的输入来自主干网络的第二层，输入的维度是batch×143×30，经过展平层后特征数变为143×30=4290，将4290个特征输入到有128个神经元的全连接层，使用ReLU函数激活，并以0.5的概率进行Dropout操作；最后将128个特征输入到神经元个数为2的全连接层进行概率输出，使用Softmax函数激活。步骤3、模型预训练。模型的损失函数为混合损失，由重构误差和预测误差加权组成，混合损失函数定义为：； 权重系数k为自适应获得，根据每轮训练后在验证集上的正确率动态调整，公式为：；/＞为第i轮的权重系数，/＞为自定义更新系数，/＞为第i轮中验证集上的准确率，设定初始的/＞为0.5，/＞为0.2；模型训练采用的是Adam优化器，每轮动态调整学习率。另外，由于样本的不平衡性，训练时进行平衡采样，保持阳性变异和阴性变异的数量相等。步骤4、模型迁移。针对目标域任务的模型由源域的卷积自编码器和前馈神经网络构成。具体而言，将确定参数的编码器迁移到目标域进行特征压缩，针对目标任务压缩后的空间特征对全连接层进行训练。编码器的输出特征数是143×30=4290，将4290个特征输入到神经元个数为60的全连接层，使用Sigmoid函数进行激活，并以0.5的概率进行Dropout操作，最后将60个特征输入到神经元个数为2的全连接层，使用Softmax函数计算分类概率，并使用交叉熵损失函数基于Adam优化器进行误差反向传播，对模型的全连接层进行训练，保存训练好的模型。步骤5、模型预测：对需要预测的数据进行独热编码，将获得的特征矩阵输入到步骤4保存的模型中即可进行预测。在MPRA_eQTL数据上测试本发明提出的方法与前人提出的方法进行对比，用AUC来评估模型的性能，AUC为ROC曲线下的面积，其中，ROC曲线为受试者工作特征曲线，以真阳性率为纵坐标，假阳性率为横坐标绘制的曲线，AUC值越高代表模型性能越好。十折交叉验证的平均AUC，Eigen_PC取得了0.64，Genocanyon取得了0.65，本方法取得了0.66；在CAGT_eQTL数据上，五折交叉验证的平均AUC，TLVar取得了0.708，本方法取得了0.722，实验证明本发明提出的方法取得了最好的预测结果。以上内容是结合具体的优选实施方式对本发明所作的进一步详细说明，不能认定本发明的具体实施只局限于这些说明。对于本发明所属技术领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干简单推演或替换，都应当视为属于本发明的保护范围。
