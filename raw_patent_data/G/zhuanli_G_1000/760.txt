标题title
一种基于模式选择参数的五合一火箭轨迹优化方法及系统
摘要abst
本发明公开了一种基于模式选择参数的五合一火箭轨迹优化方法及系统，涉及火箭轨迹优化技术领域。方法包括：获取火箭飞行中的当前状态参数；获取火箭发射前装载的标称轨迹；基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值并建立误差函数；根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型；设定最优控制问题模型中的标称值并在标称值处线性化最优控制问题，得到凸最优控制问题；对凸最优控制问题进行多次迭代求解，输出最优火箭轨迹。本发明能够有效提高火箭控制系统的适应性、可靠性和计算效率，并有效降低火箭控制系统的资源消耗和成本。
权利要求书clms
1.一种基于模式选择参数的五合一火箭轨迹优化方法，其特征在于，包括：获取火箭飞行中的当前状态参数；所述当前状态参数包括：当前位置、当前速度、当前质量、推力大小、质量流量以及干重；获取火箭发射前装载的标称轨迹；所述标称轨迹包括：标称飞行时间、标称位置曲线、标称速度曲线、标称质量曲线以及标称推力方向曲线；基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值；所述五类轨迹规划问题包括：燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题以及限制近地点高度的椭圆轨道最大化问题；基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数；根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型；设定最优控制问题模型中的标称值并在标称值处线性化最优控制问题，得到凸最优控制问题；对凸最优控制问题进行多次迭代求解，输出最优火箭轨迹。2.根据权利要求1所述的基于模式选择参数的五合一火箭轨迹优化方法，其特征在于，所述基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值，具体包括：当轨迹规划问题为燃料最优入轨问题时，令模式选择参数，采用公式/＞求解动量矩向量参考值/＞；采用公式/＞求解拉普拉斯向量参考值/＞；采用公式/＞求解近地点高度参考值/＞；其中，/＞、/＞和/＞分别为动量矩向量、拉普拉斯向量以及近地点高度的计算函数；/＞为标称位置曲线；/＞为标称速度曲线。3.根据权利要求2所述的基于模式选择参数的五合一火箭轨迹优化方法，其特征在于，所述基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值，还包括：当轨迹规划问题为圆轨道最大化问题时，令模式选择参数，采用公式求解动量矩向量参考值/＞；拉普拉斯向量参考值/＞；近地点高度参考值/＞；其中，/＞为轨道倾角；/＞为升交点赤经。4.根据权利要求3所述的基于模式选择参数的五合一火箭轨迹优化方法，其特征在于，所述基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值，还包括：当轨迹规划问题为椭圆轨道最大化问题时，令模式选择参数，采用公式求解动量矩向量参考值/＞；采用公式求解拉普拉斯向量参考值/＞；近地点高度参考值/＞；其中，/＞为离心率；/＞为近地点辐角；/＞为地球引力常数。5.根据权利要求4所述的基于模式选择参数的五合一火箭轨迹优化方法，其特征在于，所述基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值，还包括：当轨迹规划问题为固定近地点高度的椭圆轨道最大化问题或限制近地点高度的椭圆轨道最大化问题时，令模式选择参数为或/＞，采用公式/＞求解动量矩向量参考值/＞；采用公式/＞求解拉普拉斯向量参考值/＞；近地点高度参考值/＞为预设输入值。6.根据权利要求5所述的基于模式选择参数的五合一火箭轨迹优化方法，其特征在于，所述基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数，具体包括：基于五类轨迹规划问题的动量矩向量参考值、拉普拉斯向量参考值/＞以及近地点高度参考值/＞分别建立第一误差函数/＞、第二误差函数以及第三误差函数/＞；其中，/＞和/＞为引入的标量参数；/＞表示位置；/＞表示速度。7.根据权利要求6所述的基于模式选择参数的五合一火箭轨迹优化方法，其特征在于，所述根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型，具体包括：根据误差函数、当前状态参数以及模式选择参数构建出统一的最优控制问题模型；其中，/＞为燃料最优入轨问题的模式选择参数；/＞为圆轨道最大化问题的模式选择参数；/＞为椭圆轨道最大化问题的模式选择参数；/＞为固定近地点高度的椭圆轨道最大化问题的模式选择参数；/＞为限制近地点高度的椭圆轨道最大化问题的模式选择参数；maximize表示最大化；subject to表示约束组；/＞表示/＞时间后火箭的质量；/＞表示当前状态量；/＞表示/＞时间后的状态量；/＞为当前位置；/＞为当前速度；/＞为当前质量；/＞为由位置/＞、速度/＞和质量/＞组成的状态量；/＞为/＞的一阶导数；/＞为控制量；/＞为求幅值符号；/＞为火箭的飞行时间；/＞；；/＞；其中，/＞为推力大小；/＞为质量流量；/＞为干重；/＞为/＞时间后火箭的位置；/＞为/＞时间后火箭的速度。8.一种基于模式选择参数的五合一火箭轨迹优化系统，其特征在于，包括：当前状态参数获取模块，用于获取火箭飞行中的当前状态参数；所述当前状态参数包括：当前位置、当前速度、当前质量、推力大小、质量流量以及干重；标称轨迹获取模块，用于获取火箭发射前装载的标称轨迹；所述标称轨迹包括：标称飞行时间、标称位置曲线、标称速度曲线、标称质量曲线以及标称推力方向曲线；参数计算模块，用于基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值；所述五类轨迹规划问题包括：燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题以及限制近地点高度的椭圆轨道最大化问题；误差函数建立模块，用于基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数；最优控制问题模型构建模块，用于根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型；线性化模块，用于设定最优控制问题模型中的标称值并在标称值处线性化最优控制问题，得到凸最优控制问题；轨迹输出模块，用于对凸最优控制问题进行多次迭代求解，输出最优火箭轨迹。
说明书desc
技术领域本发明涉及火箭轨迹优化技术领域，特别是涉及一种基于模式选择参数的五合一火箭轨迹优化方法及系统。背景技术在火箭的上升段飞行过程中，可能出现的发动机故障会严重影响火箭的飞行轨迹，导致火箭无法进入期望的目标轨道，使得发射任务失败。因此，在火箭控制系统计算机检测到火箭发动机故障时，需要应用轨迹优化方法重新规划火箭未来的飞行轨迹和目标轨道。常见的轨迹规划问题包含五类：燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题和限制近地点高度的椭圆轨道最大化问题。其中，第一类燃料最优入轨问题计算达到目标轨道所需的燃料，从而判断火箭发动机故障后还能否达到目标轨道；其他四类问题是在火箭无法到达目标轨道的场景下，重新优化目标轨道作为安全降级轨道。通过求解五类轨迹规划问题，火箭控制系统计算机可有效应对各种类型的发动机故障，保证载荷的安全，对增强重要航天任务的可靠性具有重要意义。然而，现有的火箭轨迹优化方法主要是针对一类问题开发的，因此求解五类问题需要在火箭控制系统计算机上搭载五种不同的方法，显著增加了对火箭控制系统计算机资源的消耗以及对应方法的编程、测试和维护成本。发明内容本发明的目的是提供一种基于模式选择参数的五合一火箭轨迹优化方法及系统，能够有效提高火箭控制系统的适应性、可靠性和计算效率，并有效降低火箭控制系统的资源消耗和成本。为实现上述目的，本发明提供了如下方案。一种基于模式选择参数的五合一火箭轨迹优化方法，包括以下步骤。获取火箭飞行中的当前状态参数；所述当前状态参数包括：当前位置、当前速度、当前质量、推力大小、质量流量以及干重。获取火箭发射前装载的标称轨迹；所述标称轨迹包括：标称飞行时间、标称位置曲线、标称速度曲线、标称质量曲线以及标称推力方向曲线。基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值；所述五类轨迹规划问题包括：燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题以及限制近地点高度的椭圆轨道最大化问题。基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数。根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型。设定最优控制问题模型中的标称值并在标称值处线性化最优控制问题，得到凸最优控制问题。对凸最优控制问题进行多次迭代求解，输出最优火箭轨迹。可选地，所述基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值，具体包括：当轨迹规划问题为燃料最优入轨问题时，令模式选择参数，采用公式/＞求解动量矩向量参考值/＞；采用公式/＞求解拉普拉斯向量参考值/＞；采用公式求解近地点高度参考值/＞；其中，/＞、/＞和/＞分别为动量矩向量、拉普拉斯向量以及近地点高度的计算函数；/＞为标称位置曲线；/＞为标称速度曲线。当轨迹规划问题为圆轨道最大化问题时，令模式选择参数，采用公式/＞求解动量矩向量参考值/＞；拉普拉斯向量参考值/＞；近地点高度参考值/＞；其中，/＞为轨道倾角；/＞为升交点赤经。当轨迹规划问题为椭圆轨道最大化问题时，令模式选择参数，采用公式/＞求解动量矩向量参考值/＞；采用公式求解拉普拉斯向量参考值/＞；近地点高度参考值/＞；其中，/＞为离心率；/＞为近地点辐角；/＞为地球引力常数。当轨迹规划问题为固定近地点高度的椭圆轨道最大化问题或限制近地点高度的椭圆轨道最大化问题时，令模式选择参数为或/＞，采用公式求解动量矩向量参考值/＞；采用公式求解拉普拉斯向量参考值/＞；近地点高度参考值/＞为预设输入值。可选地，所述基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数，具体包括：基于五类轨迹规划问题的动量矩向量参考值、拉普拉斯向量参考值/＞以及近地点高度参考值/＞分别建立第一误差函数、第二误差函数/＞以及第三误差函数/＞；其中，/＞和/＞为引入的标量参数；/＞表示位置；/＞表示速度。可选地，所述根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型，具体包括：根据误差函数、当前状态参数以及模式选择参数构建出统一的最优控制问题模型；其中，/＞为燃料最优入轨问题的模式选择参数；/＞为圆轨道最大化问题的模式选择参数；/＞为椭圆轨道最大化问题的模式选择参数；/＞为固定近地点高度的椭圆轨道最大化问题的模式选择参数；/＞为限制近地点高度的椭圆轨道最大化问题的模式选择参数；maximize表示最大化；subject to表示约束组；/＞表示/＞时间后火箭的质量；/＞表示当前状态量；/＞表示/＞时间后的状态量；/＞为当前位置；/＞为当前速度；/＞为当前质量；/＞为由位置/＞、速度/＞和质量/＞组成的状态量；/＞为/＞的一阶导数；/＞为控制量；/＞为求幅值符号；/＞为火箭的飞行时间；；/＞；；其中，/＞为推力大小；/＞为质量流量；/＞为干重；为/＞时间后火箭的位置；/＞为/＞时间后火箭的速度。一种基于模式选择参数的五合一火箭轨迹优化系统，包括以下模块。当前状态参数获取模块，用于获取火箭飞行中的当前状态参数；所述当前状态参数包括：当前位置、当前速度、当前质量、推力大小、质量流量以及干重。标称轨迹获取模块，用于获取火箭发射前装载的标称轨迹；所述标称轨迹包括：标称飞行时间、标称位置曲线、标称速度曲线、标称质量曲线以及标称推力方向曲线。参数计算模块，用于基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值；所述五类轨迹规划问题包括：燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题以及限制近地点高度的椭圆轨道最大化问题。误差函数建立模块，用于基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数。最优控制问题模型构建模块，用于根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型。线性化模块，用于设定最优控制问题模型中的标称值并在标称值处线性化最优控制问题，得到凸最优控制问题。轨迹输出模块，用于对凸最优控制问题进行多次迭代求解，输出最优火箭轨迹。根据本发明提供的具体实施例，本发明公开了以下技术效果。本发明提供了一种基于模式选择参数的五合一火箭轨迹优化方法及系统，在将五类轨迹规划问题转化为统一的最优控制问题的过程中，提出模式选择参数的概念，创新性地应用一个最优控制问题描述五类轨迹规划问题，通过设置模式选择参数的值来建立最优控制问题和不同轨迹规划问题之间的对应关系。对应这一个包含模式选择参数的最优控制问题只需要一种求解方法，就能够求解五类火箭轨迹规划问题，从而能够应用一个方法统一求解五类火箭轨迹规划问题，具有较高的适应性、可靠性和计算效率。因此，本发明能够有效提高火箭控制系统的适应性、可靠性和计算效率，并有效降低火箭控制系统的资源消耗和成本。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明提供的基于模式选择参数的五合一火箭轨迹优化方法的流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的目的是提供一种基于模式选择参数的五合一火箭轨迹优化方法及系统，能够有效提高火箭控制系统的适应性、可靠性和计算效率，并有效降低火箭控制系统的资源消耗和成本。为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图和具体实施方式对本发明作进一步详细的说明。图1为本发明提供的基于模式选择参数的五合一火箭轨迹优化方法的流程图。如图1所示，本发明公开的一种基于模式选择参数的五合一火箭轨迹优化方法共涉及7个步骤，其中步骤1至步骤5计算得到火箭轨迹规划问题对应的最优控制问题，步骤6至步骤7应用迭代方法求解最优控制问题，所有步骤的执行主体均为火箭控制系统计算机。步骤1：获取火箭飞行中的当前状态参数。具体地，从导航系统中获取火箭飞行中的当前状态参数，包括当前位置、当前速度/＞、当前质量/＞、推力大小/＞、质量流量/＞和干重/＞。其中，当前位置/＞是火箭质心在地心惯性坐标系中的坐标，当前速度/＞是当前位置/＞的变化率，二者均为三维向量。推力大小/＞是火箭所有发动机提供的推力总和，质量流量/＞是火箭所有发动机每秒消耗的燃料总和，二者均为标量。干重/＞是火箭不含燃料的结构质量，当前质量/＞减去干重/＞即为燃料质量。步骤2：获取火箭发射前装载的标称轨迹。具体地，获取火箭控制系统在火箭发射前装载的标称轨迹，包括标称飞行时间、标称位置曲线/＞、标称速度曲线/＞、标称质量曲线/＞和标称推力方向曲线/＞。其中，标称轨迹是指火箭在无干扰、发动机无故障情况下的飞行轨迹。标称轨迹在火箭发射前设计得到，并作为发射诸元装载进火箭控制系统计算机中。标称位置曲线/＞、标称速度曲线/＞、标称质量曲线/＞、标称推力方向曲线/＞都是飞行时间的函数。步骤3：基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值。根据控制系统计算机需要求解的五类轨迹规划问题类型，分别为燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题以及限制近地点高度的椭圆轨道最大化问题，计算火箭轨迹规划问题的参数，包括：模式选择参数、动量矩向量参考值/＞、拉普拉斯向量参考值/＞和近地点高度参考值/＞。其中，模式选择参数/＞是一个五维向量，/＞的分量分别记作/＞、/＞、/＞、/＞和/＞，对应于五类轨迹规划问题。动量矩向量参考值/＞和拉普拉斯向量参考值/＞是三维向量，近地点高度参考值是一个标量，这些参考值用于描述火箭轨迹规划问题中的目标轨道。下面根据轨迹规划问题类型的不同，分别计算燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题以及限制近地点高度的椭圆轨道最大化问题的参数。当轨迹规划问题为燃料最优入轨问题时，火箭轨迹规划的目标是以最省燃料的方式将火箭送入目标轨道。此时，令模式选择参数。动量矩向量参考值/＞、拉普拉斯向量参考值/＞和近地点高度参考值/＞根据目标轨道上任意一点的标称位置曲线/＞、标称速度曲线/＞和公式、公式以及公式进行计算。。。。其中，、/＞和/＞分别为动量矩向量、拉普拉斯向量以及近地点高度的计算函数，分别如公式、公式和公式所示。。。。其中，表示位置，可以代入/＞或/＞等位置相关参数；/＞表示速度，可以代入/＞或等速度相关参数；/＞为求幅值符号；/＞为地球引力常数。当轨迹规划问题为圆轨道最大化问题时，火箭轨迹规划的目标是确定火箭可达的具有最大高度的圆轨道，要求圆轨道的轨道倾角为、升交点赤经为/＞。其中，轨道倾角/＞和升交点赤经/＞均为标量，是描述航天器轨道时常用的轨道要素。此时，令模式选择参数/＞。动量矩向量参考值/＞、拉普拉斯向量参考值/＞和近地点高度参考值/＞根据公式、公式和公式进行计算。。。。当轨迹规划问题为椭圆轨道最大化问题时，火箭轨迹规划的目标是确定火箭可达的具有最大高度的椭圆轨道，要求椭圆轨道的轨道倾角为、升交点赤经为/＞、离心率为/＞、近地点辐角为/＞。其中，离心率/＞和近地点辐角/＞均为标量。此时，令模式选择参数/＞。动量矩向量参考值/＞、拉普拉斯向量参考值/＞和近地点高度参考值/＞根据公式、公式和公式进行计算。。。。当轨迹规划问题为固定近地点高度的椭圆轨道最大化问题时，火箭轨迹优化的目标是确定火箭可达的具有最大高度的椭圆轨道，要求椭圆轨道的轨道倾角为、升交点赤经为/＞、近地点辐角为/＞，并要求近地点高度等于/＞。此时，令模式选择参数/＞，近地点高度参考值/＞为预设输入值。动量矩向量参考值/＞和拉普拉斯向量参考值根据公式和公式进行计算。。。与椭圆轨道最大化问题的区别是，的表达式中没有了/＞。当轨迹规划问题为限制近地点高度的椭圆轨道最大化问题时，火箭轨迹规划的目标是确定火箭可达的具有最大高度的椭圆轨道，要求椭圆轨道的轨道倾角为、升交点赤经为/＞、近地点辐角为/＞，并要求近地点高度大于等于/＞。与固定近地点高度的椭圆轨道最大化问题的区别是，固定近地点高度的椭圆轨道最大化问题要求近地点高度等于，而限制近地点高度的椭圆轨道最大化问题允许近地点高度大于/＞。此时，/＞，近地点高度参考值/＞为预设输入值。动量矩向量参考值/＞和拉普拉斯向量参考值/＞的计算公式与固定近地点高度的椭圆轨道最大化问题相同，同为公式和公式。步骤4：基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数。基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值/＞以及近地点高度参考值/＞分别建立第一误差函数/＞、第二误差函数/＞和第三误差函数/＞，服务于步骤5中的最优控制问题模型的计算。。。。其中，和/＞为引入的标量参数，取值待定。步骤5：根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型。火箭控制系统计算机将五类火箭轨迹规划问题转化为统一的最优控制问题。此最优控制问题的时间区间为，状态量为/＞，是由位置/＞、速度/＞和质量/＞拼接而成的向量；控制量为/＞；参数量包括/＞、/＞和/＞，其中/＞为火箭的飞行时间。最优控制问题是轨迹规划问题的数学建模表达，本发明建立的统一的最优控制问题模型如下所示。。其中，为燃料最优入轨问题的模式选择参数；/＞为圆轨道最大化问题的模式选择参数；/＞为椭圆轨道最大化问题的模式选择参数；/＞为固定近地点高度的椭圆轨道最大化问题的模式选择参数；/＞为限制近地点高度的椭圆轨道最大化问题的模式选择参数。/＞为/＞的一阶导数；maximize表示最大化；subject to表示约束组；/＞表示/＞时间后火箭的质量；/＞表示当前状态量；/＞表示/＞时间后的状态量。其中，函数、/＞和/＞的表达式如下所示。。。。其中，为/＞时间后火箭的位置；/＞为/＞时间后火箭的速度。步骤6：设定最优控制问题模型中的标称值并在标称值处线性化最优控制问题，得到凸最优控制问题。将参数的标称值/＞设置为1，将参数/＞的标称值/＞设置为1。在标称值处线性化最优控制问题，得到以下形式的凸最优控制问题。。其中，为时间；/＞、/＞和/＞分别是函数/＞、/＞和/＞在标称值处的一阶泰勒展开，其表达式如公式、公式和公式所示。。。。其中，符号表示求取函数对某个变量的偏导数。特别地，对函数/＞定义如公式和公式所示。。。其中，和/＞分别为状态量的标称值和标称推力方向曲线/＞关于时间的函数；/＞为/＞时间后的状态量/＞的标称值。步骤7：对凸最优控制问题进行多次迭代求解，输出最优火箭轨迹。火箭控制系统计算机应用凸内点法求解凸最优控制问题，得到新的标称值，包括：标称飞行时间、标称位置曲线/＞、标称速度曲线/＞、标称质量曲线/＞、标称推力方向曲线/＞以及/＞和/＞。求解凸最优控制问题后，如公式所示。。其中，凸内点法是用于求解凸最优控制问题的一种高效方法。火箭控制系统计算机应用步骤7得到的新的标称值，转步骤6，重新在新的标称值处线性化最优控制问题，再进入步骤7，求解线性化得到的凸最优控制问题。当步骤7的执行次数小于给定值时，转步骤6。否则，轨迹规划方法结束，输出当前的标称飞行时间/＞、标称位置曲线/＞、标称速度曲线/＞、标称质量曲线/＞以及标称推力方向曲线/＞作为最优火箭轨迹。本发明提供的基于模式选择参数的五合一火箭轨迹优化方法可应用于火箭控制系统的计算机中，能够在发动机故障的场景下，统一求解五类火箭轨迹规划问题，在火箭发动机故障时确定新的飞行轨迹和目标轨道，从而确保发射任务仍能成功或进入安全降级轨道。统一求解五类轨迹规划问题的能力使得本发明基于模式选择参数的五合一火箭轨迹优化方法能够适应不同的发射任务和发动机故障。本发明提出的火箭轨迹优化方法具有较高的适应性、可靠性和计算效率，适用于对可靠性和计算效率要求较高的火箭控制系统中。此外，由于现有的火箭轨迹规划方法是一种方法对应一类问题，因此求解五类问题需要在火箭控制系统计算机上搭载五种方法，显著增加了对火箭控制系统计算机资源的消耗以及对应方法的编程、测试和维护成本。而本发明提出的五合一火箭轨迹优化方法只需要更少的资源和更低的开发成本，其能够求解五类问题的适应性使得五合一火箭轨迹优化方法可更简单地应用到不同类型的火箭上。基于本发明提供的方法，本发明还提供一种基于模式选择参数的五合一火箭轨迹优化系统，包括以下模块。当前状态参数获取模块，用于获取火箭飞行中的当前状态参数；所述当前状态参数包括：当前位置、当前速度、当前质量、推力大小、质量流量以及干重。标称轨迹获取模块，用于获取火箭发射前装载的标称轨迹；所述标称轨迹包括：标称飞行时间、标称位置曲线、标称速度曲线、标称质量曲线以及标称推力方向曲线。参数计算模块，用于基于标称轨迹分别计算五类轨迹规划问题对应的模式选择参数、动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值；所述五类轨迹规划问题包括：燃料最优入轨问题、圆轨道最大化问题、椭圆轨道最大化问题、固定近地点高度的椭圆轨道最大化问题以及限制近地点高度的椭圆轨道最大化问题。误差函数建立模块，用于基于五类轨迹规划问题对应的动量矩向量参考值、拉普拉斯向量参考值以及近地点高度参考值建立误差函数。最优控制问题模型构建模块，用于根据误差函数、当前状态参数以及模式选择参数构建统一的最优控制问题模型。线性化模块，用于设定最优控制问题模型中的标称值并在标称值处线性化最优控制问题，得到凸最优控制问题。轨迹输出模块，用于对凸最优控制问题进行多次迭代求解，输出最优火箭轨迹。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似部分互相参见即可。对于实施例公开的系统而言，由于其与实施例公开的方法相对应，所以描述的比较简单，相关之处参见方法部分说明即可。本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处。综上所述，本说明书内容不应理解为对本发明的限制。
