标题title
一种图像信号相位恢复的方法
摘要abst
本发明公开了一种图像信号相位恢复的方法，属于图像信号相位恢复领域。本发明有效地结合了低秩张量环秩和总体最小二乘框架来解决相位恢复问题。通过强制图像序列保持低秩，能够充分挖掘和利用多维数据的内在结构特性。这种处理方式不仅提高了信号恢复的准确性，也增强了处理高维数据的能力。本发明的总体最小二乘框架是专门设计来应对传感张量中的误差，无论是加性噪声还是由于传感器不精确或偏差引起的乘性误差。这种全面而细致的误差处理策略保证了即使在噪声和测量误差的情况下，本发明的图像信号相位恢复方法也能保持出色的表现。
权利要求书clms
1.一种图像信号相位恢复的方法，其特征在于，包括下列步骤：步骤1，构建基于张量总体最小二乘的图像信号相位恢复的优化目标；采用张量表示图像序列的结构信息，并选择对整个图像序列进行联合采样，生成最终的第m次测量的测量向量/＞：/＞；其中，/＞，张量/＞的张量维度为/＞，/＞表示图像的空间分辨率，Q表示时间采样点数；/＞是与张量/＞尺寸相匹配的传感张量，M表示测量次数；定义表示传感张量/＞的修正项，其维度为/＞；定义/＞表示加性传感误差项，构成包含噪声的测量值；基于自定义的张量的秩类型，在满足秩定义和包含噪声的测量值等于修正后的联合采样结果/＞的条件下，以最小化/＞为图像信号相位恢复的优化目标，其中，/＞、/＞分别为关于加性传感误差项/＞和修正项/＞的校正系数；步骤2，基于构建的图像信号相位恢复的优化目标对张量进行迭代求解，当满足预置的迭代收敛条件时停止，并基于当前的迭代求解得到的张量/＞得到最终的图像信号相位恢复结果。2.如权利要求1所述的方法，其特征在于，步骤1中，采用的秩类型为张量环秩。3.如权利要求1或2所述的方法，其特征在于，步骤1中，将基于张量总体最小二乘的图像信号相位恢复的优化目标转换为：；其中，符号表示核范数符号，张量/＞的核范数/＞，参数/＞，N表示图像信号的数据维度，/＞表示预置的第/＞个校正系数，/＞表示张量/＞的平衡/＞移动展开矩阵。4.如权利要求3所述的方法，其特征在于，步骤2中，采用拉格朗日函数对张量进行迭代求解，具体包括：步骤201，构建拉格朗日函数：；其中，表示关于张量/＞、张量/＞、拉格朗日乘数/＞和M个修正后的传感张量/＞的拉格朗日函数，且第m个修正后的传感张量/＞，张量/＞的初始值为/＞；表示张量/＞的平衡/＞移动展开矩阵，/＞表示拉格朗日乘子，/＞表示F范数符号；步骤202，基于预置的张量、张量/＞和拉格朗日乘数/＞的初始值，按照先迭代更新张量/＞，接着更新修正后的传感张量/＞，再然后更新张量/＞，最后更新拉格朗日乘数/＞的顺序进行迭代更新处理，当满足预置的迭代收敛条件时停止；步骤203，基于最近迭代更新后的张量得到最终的图像信号相位恢复结果。5.如权利要求4所述的方法，其特征在于，步骤202中的迭代更新处理具体包括：1）通过梯度下降对张量进行迭代更新：；其中，、/＞和/＞分别表示张量/＞在第t+1次迭代时的向量化值、第t次迭代时的向量化值和初始值的向量化值，/＞表示预置的学习率，/＞表示拉式函数/＞关于当前张量/＞的向量化值/＞的梯度；拉式函数为：；2）基于当前更新后的向量化值更新/＞：最小化拉式函数以得到新的/＞的向量化值/＞，再基于/＞得到更新后的/＞；其中，，/＞表示传感张量/＞的向量化值；3）更新张量：基于当前的张量得到其平衡/＞移动展开矩阵/＞；对进行奇异值分解，其中，/＞表示拉格朗日乘数/＞的平衡/＞移动展开矩阵；并对奇异值分解得到的对角矩阵进行更新：计算对角矩阵的每个奇异值与/＞的差值，将最大差值赋值给每一个奇异值后得到新对角矩阵；再基于新对角矩阵进行该奇异值分解的逆操作得到/＞；通过更新张量/＞，其中，Fold表示张量展开的逆操作；4）基于当前的张量和/＞更新拉格朗日乘数/＞：/＞。6.如权利要求5所述的方法，其特征在于，步骤202中，迭代收敛条件具体为：迭代次数达到预置的最大迭代次数和/或恢复误差小于或等于预置的恢复误差阈值；其中，恢复误差为，/＞和/＞分别表示张量/＞在第t+1次和第t迭代时的向量化值。
说明书desc
技术领域本发明属于图像信号相位恢复领域，具体涉及一种图像信号相位恢复的方法。背景技术信号相位恢复是从信号的幅度或强度测量中恢复其相位信息的过程，这在各种应用中都有出现，例如：X射线晶体学，光学和计算生物学。信号相位恢复的目标是基于幅度测量，通过解决一个带有关于信号属性附加假设的优化问题来恢复信号，其中/＞是第m次测量的传感向量，/＞表示共轭转置，M表示测量次数，/＞表示复数域，N表示信号的数据维度，即单轮测量时生成的测量向量的长度。近来，对具有更复杂属性信号的研究兴趣逐渐增长，低秩稀疏相位恢复便是其中之一。低秩相位恢复的应用场景之一是动态环境，例如在太阳成像技术中，需要恢复一系列随时间变化的信号，其中，/＞表示第q个采样点的原始信号，Q表示时间采样点数。在这种情况下，信号间的时间相关性形成了预期矩阵/＞的低秩结构，这对信号恢复非常有利。对于每个采样点的原始信号/＞，都可以生成一系列标量测量值/＞，/＞。即需要从已知的测量值/＞和传感值/＞恢复出原始信号/＞，其中，/＞。但在现实测量中，由于测量设备只能捕捉到振幅信息，或者在信号传输过程中相位信息遭到破坏，例如，在光学成像中，常常只能获取到光的强度，而非光波的相位；在无线通信中，由于各种干扰，相位信息也可能会丢失。此外，由于已知的测量值和传感值/＞包含大量的噪声，所以无法有效恢复出原始信号。低秩相位恢复的交替最小化方法作为一种可验证的解决方案，它最初针对基本的问题设计，后来被进一步发展以适应含有噪声的测量。除了交替最小化之外，研究人员还探索了其他解决低秩相位恢复问题的方法。尽管如此，这些现有方法在特别是在欠定条件下准确恢复图像方面仍面临挑战。为了克服这些难题并降低样本的复杂性，最近有新的方法被提出，这些方法采用了张量表示。不过，这些新方法依然依赖于传统的Tucker张量分解方法，并且继续采用按照逐矩阵、逐切片的采样流程。此外，尽管测量数据中直接包含了加性噪声，但由于传感矢量或张量的不准确或偏差而产生的乘性传感误差也给数据校准带来了挑战。这种情况激发了在相位恢复中首次采用总体最小二乘法框架来解决传感矢量中的乘法误差问题的研究。然而，这一框架是基于矢量表示的，因此在动态环境中的应用受到了限制。因此,有必要针对上述挑战，研究新的相位恢复方法，尤其是适用于图像信号的相位恢复方法。发明内容本发明提供了一种图像信号相位恢复的方法，旨在过使用张量来建模图像序列及其对应的传感算子，灵活地应用不同的低张量秩先验，以探索固有的高维结构信息，从而有效解决加性感应误差，以及有效应对由传感张量的不准确性或偏差引起的乘性感应误差，进而显著提高估计性能的稳健性。本发明采用的技术方案为：一种图像信号相位恢复的方法，该方法包括下列步骤：步骤1，构建基于张量总体最小二乘的图像信号相位恢复的优化目标；采用张量表示图像序列的结构信息，并选择对整个图像序列进行联合采样，生成最终的第m次测量的测量向量/＞：/＞；其中，/＞，张量/＞的张量维度为/＞，/＞表示图像的空间分辨率，Q表示时间采样点数；/＞是与张量尺寸相匹配的传感张量，M表示测量次数；定义表示传感张量/＞的修正项，其维度为；定义/＞表示加性传感误差项，/＞构成包含噪声的测量值；基于自定义的张量的秩类型秩、 张量树秩、张量环秩等），在满足秩定义和包含噪声的测量值等于修正后的联合采样结果/＞的条件下，以最小化/＞为图像信号相位恢复的优化目标，其中，/＞、/＞分别为关于加性传感误差项/＞和修正项/＞的校正系数；步骤2，基于构建的图像信号相位恢复的优化目标对张量进行迭代求解，当满足预置的迭代收敛条件时停止，并基于当前的迭代求解得到的张量/＞得到最终的图像信号相位恢复结果。进一步的，步骤1中，采用的秩类型为张量环秩。进一步的，步骤1中，将基于张量总体最小二乘的图像信号相位恢复的优化目标转换为：其中，符号表示核范数符号，张量/＞的核范数/＞，参数/＞，N表示图像信号的数据维度，/＞表示预置的第/＞个校正系数，/＞表示张量/＞的平衡/＞移动展开矩阵，即/＞表示将张量/＞沿第/＞维度平衡移动展开得到的展开矩阵。进一步的，步骤2中，采用拉格朗日函数对张量进行迭代求解，具体包括：步骤201，构建拉格朗日函数：其中，表示关于张量/＞、张量/＞、拉格朗日乘数/＞和M个修正后的传感张量/＞的拉格朗日函数，且第m个修正后的传感张量/＞，张量/＞的初始值为；/＞表示张量/＞的平衡/＞移动展开矩阵，/＞表示拉格朗日乘子，/＞表示F范数符号；步骤202，基于预置的张量、张量/＞和拉格朗日乘数/＞的初始值，按照先迭代更新张量/＞，接着更新修正后的传感张量/＞，再然后更新张量/＞，最后更新拉格朗日乘数/＞的顺序进行迭代更新处理，当满足预置的迭代收敛条件时停止；步骤203，基于最近迭代更新后的张量得到最终的图像信号相位恢复结果。进一步的，步骤202中的迭代更新处理具体包括：1）通过梯度下降对张量进行迭代更新：其中，、/＞和/＞分别表示张量/＞在第t+1次迭代时的向量化值、第t次迭代时的向量化值和初始值的向量化值，/＞表示预置的学习率，用于控制更新张量/＞的向量化值的步长大小，/＞表示拉式函数/＞关于当前张量/＞的向量化值/＞的梯度，指示了误差减少最快的方向；拉式函数为：；2）基于当前更新后的向量化值更新/＞：最小化拉式函数以得到新的/＞的向量化值/＞，再基于/＞得到更新后的/＞，以用于下一迭代更新对张量/＞的更新计算；其中，，/＞表示传感张量/＞的向量化值；3）更新张量：基于当前的张量得到其平衡/＞移动展开矩阵/＞，再根据公式计算张量/＞发平衡/＞移动展开矩阵/＞，其中，/＞表示拉格朗日乘数的平衡/＞移动展开矩阵，函数/＞表示对函数输入进行奇异值分解，接着将奇异值分解中的对角矩阵的奇异值替换为/＞得到新对角矩阵，再基于新对角矩阵进行奇异值分解的逆操作得到函数/＞的函数值，其中，/＞表示奇异值分解后的任一奇异值，/＞表示截断参数，本发明中/＞；即对/＞进行奇异值分解，接着对奇异值分解得到的对角矩阵进行更新：计算对角矩阵的每个奇异值与/＞的差值，将最大差值赋值给每一个奇异值后得到新对角矩阵，再基于新对角矩阵进行该奇异值分解的逆操作得到/＞；进而可以通过/＞更新张量/＞，其中，Fold表示张量展开的逆操作。4）基于当前的张量和/＞更新拉格朗日乘数/＞：/＞。进一步的，步骤202中，迭代收敛条件具体为：迭代次数达到预置的最大迭代次数和/或恢复误差小于或等于预置的恢复误差阈值；其中，恢复误差为，/＞和/＞分别表示张量/＞在第t+1次和第t迭代时的向量化值。本发明提供的技术方案至少带来如下有益效果：本发明整合两个关键要素来解决低秩相位恢复问题：一是利用多维结构信息，二是减少传感误差，本发明强制图像序列保持低张量环秩，以实现允许充分利用图像序列的多维结构信息；通过这种低秩结构，可以更有效地捕捉和利用信号中的固有关联性，从而提高恢复质量。同时，本发明方法还采用了总最小二乘框架来处理传感张量中的误差，TLS框架能够同时考虑数据和测量过程中的不确定性，这包括加性噪声以及由于传感器不精确或偏差引起的乘性误差。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将对本发明实施方式作进一步地详细描述。为了实现含噪声的图像信号的相位恢复，本发明实施例提供的一种图像信号相位恢复的方法，其具体实现过程如下：首先，使用张量表示图像序列中的结构信息，即，其中，/＞表示复数域，表示图像的空间分辨率，Q表示时间采样点数。选择对整个序列进行联合采样，即，其中联合采样，/＞表示联合采样生成的第m次测量的测量向量，是与张量/＞尺寸相匹配的传感张量，M表示测量次数。在考虑传感张量的不准确性，可能导致的加法和乘法传感误差时，本发明实施例提出了一种针对相位恢复问题的张量全最小二乘模型，即：其中，表示传感张量/＞的修正项，其维度为；/＞表示加性传感误差项，/＞构成包含噪声的测量值，/＞、/＞分别为关于加性传感误差项/＞和修正项/＞的校正系数，用于平衡模型的偏差与复杂度。/＞表示满足秩定义，即张量/＞的秩不超过预置的秩R。在处理张量/＞时，可以选择不同类型的秩定义，如塔克秩、 张量树秩、张量环秩等。本发明实施例选择使用张量环表示法，由于其出色的高维数据表示能力。TR结构可以有效捕捉和表达高维数据的复杂结构，使得问题进一步转化为一个低秩张量环优化问题。所以问题转化为：其中，为了简化表示，，/＞表示张量/＞的平衡/＞移动展开矩阵，参数/＞，/＞表示预置的第/＞个校正系数，/＞代表关于/＞的核范数。符号/＞表示2范数。为了解决上述问题，本发明实施例构造了一个拉格朗日函数，即：其中，张量表示拉格朗日乘数，/＞表示拉格朗日乘子，/＞表示张量/＞的平衡/＞移动展开矩阵，张量/＞用于中间计算，其初始值为张量/＞的初始值，/＞为校正系数，/＞表示F范数符号。通过拉格朗日函数进行更新，将上述问题与即将更新的变量结合，分解成若干子问题。接下来，将对张量进行更新，可以通过最小化/＞来得到/＞，即：本发明实施例使用梯度下降法，令，表示将张量/＞进行向量化。此时的拉式函数可以写为：继续求关于的梯度/＞：最后，更新：其中，为预置的更新步长，/＞为初始值，/＞为/＞关于/＞的梯度，分别表示张量/＞在第s+1次和第s迭代更新时的向量化值。更新完后，将继续更新/＞，可以通过最小化拉式函数/＞：其中，向量化值，/＞可以通过以下标量三次方程求解，其中，参数，参数/＞，参数/＞。定义正实数解/＞，负实数解/＞，拉格朗日乘子/＞，/＞分别为正、负实数域。此时便可以更新/＞，即/＞,其中，/＞是/＞的归一化版本，参量/＞由以下公式确定：接下来，对张量的平衡/＞移动展开矩阵/＞进行更新，即：可以通过奇异值阈值求解，通过对张量环分解产生的奇异值进行截断，来控制张量环的秩。具体来说，本实施例会设定一个阈值，只保留大于这个阈值的奇异值，从而简化数据表示，同时保留大部分重要信息。即：其中，函数表示对括号中对象/＞进行奇异值分解，/＞表示分解得到的两个酉矩阵，/＞表示对角矩阵，其对角元素为奇异值/＞，基于截段参数/＞对/＞进行更新，得到/＞，基于更新后的对角矩阵/＞执行奇异值分解的逆操作，即基于得到/＞，进而可以通过/＞更新张量/＞，其中，Fold表示张量展开的逆操作。最后，可以通过更新张量/＞。上述是迭代一次的具体步骤，在具体实施过程中，需要对整个问题中的变量赋予初值，进行初始化，具体来说，。初始奇异值为/＞，/＞，随后，本实施例使用python中的tensorly函数包进行张量初始化得到/＞。随后确定迭代次数S和最小误差/＞，然后迭代循环执行张量/＞、/＞、/＞和/＞的更新，在循环过程中，实时评估相位恢复之后的重构误差，如果其小于最小误差或者达到最大迭代次数后，迭代更新停止，代表相位恢复完成。 下面将对本发明实施例进行实际仿真，验证TTLS在处理相位恢复问题上的优秀能力。具体来说，本实施例使用伪随机高斯分布张量  作为原始数据。使用复高斯采样或CDP采样后，在传感矩阵/张量中引入复数高斯噪声，在测量中引入随机实高斯噪声。相对距离指标用于衡量误差水平。一般来说，当相对距离小于0.1时，相位能基本被恢复。首先考虑了不同的传感张量信噪比，并评估了测信噪比为15 dB、M/N=4时的相对距离，其中，M表示测量次数，N表示单轮测量时生成的测量向量的长度。采样采用CDP模式。通过本发明得出的恢复结果，如表1所示。可以看出，本实施例能很好的恢复出相位，尤其是当传感张量信噪比低于20 dB时，相对距离能降低到0.05以下。表1本发明实施例在不同传感信噪比上的恢复结果本发明实施例还调整测量次数，并在测量信噪比为40 dB、传感张量信噪比为20dB时评估恢复性能。为了更好地揭示不同测量次数的影响，在此采用了复高斯采样。表2中展示了由本发明实施例得出的恢复误差。本发明实施例显著降低了恢复误差，在大多数情况下都提供了优越的性能。特别是当M/N低于4时，本发明实施例展示了显著的改进，有效减少了实现特定恢复误差所需的测量次数。表2本发明实施例在不同的M/N下的恢复结果此外，本发明实施例还使用了真实数据集来评估本发明，该数据集是一个90帧的倒计时电影。选取5帧作为测试数据。表3展示了在测量信噪比为40 dB、传感信噪比为20 dB时，本发明实施例方法与现有方法在不同M/N值下的恢复结果。结果显示，由于TR结构的灵活性，本发明实施例在真实数据集上使用三种采样方式都能很好地恢复相位。此外，当M/N=4时，本发明实施例能很好地恢复出原始结果，几乎没有明显的噪声斑点。对表3中涉及到的缩写词说明如下：LS为最小二乘，TLS为总体最小二乘，RWF为重塑Wirtinger流，LRPR为低秩相位恢复，AltMinLowRaP为基于交替最小化的低秩相位恢复，TSPR为基于塔克结构的相位恢复，TTLS为本发明实施例的基于张量总体最小二乘的相位恢复。表3本发明实施例在真实数据上的相位恢复结果综上所述，在本发明实施例中，有效地结合了低秩张量环秩和总体最小二乘框架来解决相位恢复问题。通过强制图像序列保持低TR秩，能够充分挖掘和利用多维数据的内在结构特性。这种方法不仅提高了信号恢复的准确性，也增强了处理高维数据的能力。本发明实施例的TTLS框架是专门设计来应对传感张量中的误差，无论是加性噪声还是由于传感器不精确或偏差引起的乘性误差。这种全面而细致的误差处理策略保证了即使在噪声和测量误差的情况下，该方法也能保持出色的表现。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。以上所述的仅是本发明的一些实施方式。对于本领域的普通技术人员来说，在不脱离本发明创造构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。
