标题title
脑电信号的特征提取方法及装置、设备、存储介质
摘要abst
本发明属于信号特征提取技术领域，公开了一种脑电信号的特征提取方法及装置、设备、存储介质，通过构建信号近邻网络图，可表示脑区之间复杂的空间关系，有利于保留信号拓扑结构，根据近邻图自适应优化核函数参数，可结合信号复杂非线性拓扑结构特性建立更好的信号表达；利用核技术将信号度量矩阵映射到高维空间，有效提升信号非线性可分性；结合内积度量样本间相似性，将较相似的映射到高斯核空间以增强其相似性，将较不相似的映射到多项式核空间以增强其区分度，两种核函数配合可以得到更好的核映射效果；融合多域信息进行核重构，能更好地反映信号内在特征关系，减少噪声影响，在抑制噪声的同时保留更丰富特征，提高后续分类准确性。
权利要求书clms
1.脑电信号的特征提取方法，其特征在于，包括：根据采集到的多通道的原始脑电信号，构建初始脑电度量矩阵；根据所述初始脑电度量矩阵，构建简化近邻网络图；根据所述简化近邻网络图，分别自适应优化高斯核函数和多项式核函数的参数，获得目标高斯核函数和目标多项式核函数；计算所述初始脑电度量矩阵中每个通道序列对的内积；根据所述目标高斯核函数将所述内积达到预设内积阈值的通道序列对映射到高斯核空间，以及，根据所述目标多项式核函数将所述内积小于所述预设内积阈值的通道序列对映射到多项式核空间；在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征；根据所述初始脑电度量矩阵的类别标签，将各核空间的信息素特征融合映射到组合核空间，获得重构脑电度量矩阵；对所述重构脑电度量矩阵进行降维，获得脑电特征矩阵。2.如权利要求1所述的脑电信号的特征提取方法，其特征在于，根据所述初始脑电度量矩阵，构建简化近邻网络图，包括：计算所述初始脑电度量矩阵中各个通道序列对之间的度量距离，将各个通道序列视为节点，根据各个通道序列对之间的度量距离构建包含全部节点的初始全连接网络图；根据所述初始全连接网络图中各节点对之间的度量距离，确定所述初始全连接网络图中每个节点的真近邻节点，构建获得候选近邻网络图；根据所述候选近邻网络图，确定备用近邻网络图；根据所述备用近邻网络图中每个节点的真近邻点数量，对所述备用近邻网络图进行稀疏化处理获得简化近邻网络图。3.如权利要求2所述的脑电信号的特征提取方法，其特征在于，根据所述候选近邻网络图，确定备用近邻网络图，包括：判断所述候选近邻网络图的数量是否大于一；若所述候选近邻网络图的数量大于一，根据所述初始脑电度量矩阵计算出拓扑结构基准值；以及，计算各个所述候选近邻网络图的拓扑结构指标值与所述拓扑结构基准值之间的误差，将误差最小的其中一个候选近邻网络图确定为备用近邻网络图。4.如权利要求2所述的脑电信号的特征提取方法，其特征在于，根据所述备用近邻网络图中每个节点的真近邻点数量，对所述备用近邻网络图进行稀疏化处理获得简化近邻网络图，包括：将所述备用近邻网络图中真近邻点数量小于真近邻阈值的节点标记为边缘节点；以所述边缘节点为中心，识别构成其连接边的相邻节点，并从所述备用近邻网络图中删除所述边缘节点及其所有连接边，同时约束每个节点的连接边总数不大于最大连接数，获得简化近邻网络图。5.如权利要求1至4任一项所述的脑电信号的特征提取方法，其特征在于，在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征，包括：在高斯核空间和多项式核空间中，计算映射后的距离矩阵作为各核空间的核矩阵；根据所述简化近邻网络图以及各核空间的核矩阵，计算各核空间对应的拉普拉斯矩阵；将所述拉普拉斯矩阵的最大特征值确定为对应核空间的信息素特征。6.如权利要求5所述的脑电信号的特征提取方法，其特征在于，根据所述简化近邻网络图以及各核空间的核矩阵，计算各核空间对应的拉普拉斯矩阵，包括：根据所述简化近邻网络图以及各核空间的核矩阵，确定各核空间的相邻关系矩阵；将各核空间的核矩阵减去相应的相邻关系矩阵，得到拉普拉斯矩阵。7.脑电信号的特征提取装置，其特征在于，包括：第一构建单元，用于根据采集到的多通道的原始脑电信号，构建初始脑电度量矩阵；第二构建单元，用于根据所述初始脑电度量矩阵，构建简化近邻网络图；优化单元，用于根据所述简化近邻网络图，分别自适应优化高斯核函数和多项式核函数的参数，获得目标高斯核函数和目标多项式核函数；计算单元，用于计算所述初始脑电度量矩阵中每个通道序列对的内积；映射单元，用于根据所述目标高斯核函数将所述内积达到预设内积阈值的通道序列对映射到高斯核空间，以及，根据所述目标多项式核函数将所述内积小于所述预设内积阈值的通道序列对映射到多项式核空间；提取单元，用于在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征；融合单元，用于根据所述初始脑电度量矩阵的类别标签，将各核空间的信息素特征融合映射到组合核空间，获得重构脑电度量矩阵；降维单元，用于对所述重构脑电度量矩阵进行降维，获得脑电特征矩阵。8.如权利要求7所述的脑电信号的特征提取装置，其特征在于，所述第二构建单元包括：第一构建子单元，用于计算所述初始脑电度量矩阵中各个通道序列对之间的度量距离，将各个通道序列视为节点，根据各个通道序列对之间的度量距离构建包含全部节点的初始全连接网络图；第二构建子单元，用于根据所述初始全连接网络图中各节点对之间的度量距离，确定所述初始全连接网络图中每个节点的真近邻节点，构建获得候选近邻网络图；确定子单元，用于根据所述候选近邻网络图，确定备用近邻网络图；处理子单元，用于根据所述备用近邻网络图中每个节点的真近邻点数量，对所述备用近邻网络图进行稀疏化处理获得简化近邻网络图。9.电子设备，其特征在于，包括存储有可执行程序代码的存储器以及与所述存储器耦合的处理器；所述处理器调用所述存储器中存储的所述可执行程序代码，用于执行权利要求1至6任一项所述的脑电信号的特征提取方法。10.计算机可读存储介质，其特征在于，所述计算机可读存储介质存储计算机程序，其中，所述计算机程序使得计算机执行权利要求1至6任一项所述的脑电信号的特征提取方法。
说明书desc
技术领域本发明属于信号特征提取技术领域，具体涉及一种脑电信号的特征提取方法及装置、设备、存储介质。背景技术脑电信号作为一种包含丰富脑活动信息的生理信号，在许多领域都有着重要的分析价值。但脑电信号往往包含复杂的人为噪声，且带有明显的非线性、非稳态特性，会使特征提取和信号分析过程复杂化，给脑电信号的分析带来很大挑战。目前，传统的基于线性滤波和小波变换的方法难以有效提取脑电信号的非线性特征，因此导致现有技术中提取的信号特征不够丰富，影响后续分类的准确性。发明内容本发明的目的在于提供一种脑电信号的特征提取方法及装置、设备、存储介质，可以提升信号的非线性可分性，在抑制噪声的同时保留更丰富信号特征，进而提高后续分类的准确性。本发明第一方面公开一种脑电信号的特征提取方法，包括：根据采集到的多通道的原始脑电信号，构建初始脑电度量矩阵；根据所述初始脑电度量矩阵，构建简化近邻网络图；根据所述简化近邻网络图，分别自适应优化高斯核函数和多项式核函数的参数，获得目标高斯核函数和目标多项式核函数；计算所述初始脑电度量矩阵中每个通道序列对的内积；根据所述目标高斯核函数将所述内积达到预设内积阈值的通道序列对映射到高斯核空间，以及，根据所述目标多项式核函数将所述内积小于所述预设内积阈值的通道序列对映射到多项式核空间；在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征；根据所述初始脑电度量矩阵的类别标签，将各核空间的信息素特征融合映射到组合核空间，获得重构脑电度量矩阵；对所述重构脑电度量矩阵进行降维，获得脑电特征矩阵。在一些实施例中，根据所述初始脑电度量矩阵，构建简化近邻网络图，包括：计算所述初始脑电度量矩阵中各个通道序列对之间的度量距离，将各个通道序列视为节点，根据各个通道序列对之间的度量距离构建包含全部节点的初始全连接网络图；根据所述初始全连接网络图中各节点对之间的度量距离，确定所述初始全连接网络图中每个节点的真近邻节点，构建获得候选近邻网络图；根据所述候选近邻网络图，确定备用近邻网络图；根据所述备用近邻网络图中每个节点的真近邻点数量，对所述备用近邻网络图进行稀疏化处理获得简化近邻网络图。在一些实施例中，根据所述候选近邻网络图，确定备用近邻网络图，包括：判断所述候选近邻网络图的数量是否大于一；若所述候选近邻网络图的数量大于一，根据所述初始脑电度量矩阵计算出拓扑结构基准值；以及，计算各个所述候选近邻网络图的拓扑结构指标值与所述拓扑结构基准值之间的误差，将误差最小的其中一个候选近邻网络图确定为备用近邻网络图。在一些实施例中，根据所述备用近邻网络图中每个节点的真近邻点数量，对所述备用近邻网络图进行稀疏化处理获得简化近邻网络图，包括：将所述备用近邻网络图中真近邻点数量小于真近邻阈值的节点标记为边缘节点；以所述边缘节点为中心，识别构成其连接边的相邻节点，并从所述备用近邻网络图中删除所述边缘节点及其所有连接边，同时约束每个节点的连接边总数不大于最大连接数，获得简化近邻网络图。在一些实施例中，在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征，包括：在高斯核空间和多项式核空间中，计算映射后的距离矩阵作为各核空间的核矩阵；根据所述简化近邻网络图以及各核空间的核矩阵，计算各核空间对应的拉普拉斯矩阵；将所述拉普拉斯矩阵的最大特征值确定为对应核空间的信息素特征。在一些实施例中，根据所述简化近邻网络图以及各核空间的核矩阵，计算各核空间对应的拉普拉斯矩阵，包括：根据所述简化近邻网络图以及各核空间的核矩阵，确定各核空间的相邻关系矩阵；将各核空间的核矩阵减去相应的相邻关系矩阵，得到拉普拉斯矩阵。本发明第二方面公开一种脑电信号的特征提取装置，包括：第一构建单元，用于根据采集到的多通道的原始脑电信号，构建初始脑电度量矩阵；第二构建单元，用于根据所述初始脑电度量矩阵，构建简化近邻网络图；优化单元，用于根据所述简化近邻网络图，分别自适应优化高斯核函数和多项式核函数的参数，获得目标高斯核函数和目标多项式核函数；计算单元，用于计算所述初始脑电度量矩阵中每个通道序列对的内积；映射单元，用于根据所述目标高斯核函数将所述内积达到预设内积阈值的通道序列对映射到高斯核空间，以及，根据所述目标多项式核函数将所述内积小于所述预设内积阈值的通道序列对映射到多项式核空间；提取单元，用于在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征；融合单元，用于根据所述初始脑电度量矩阵的类别标签，将各核空间的信息素特征融合映射到组合核空间，获得重构脑电度量矩阵；降维单元，用于对所述重构脑电度量矩阵进行降维，获得脑电特征矩阵。在一些实施例中，所述第二构建单元包括：第一构建子单元，用于计算所述初始脑电度量矩阵中各个通道序列对之间的度量距离，将各个通道序列视为节点，根据各个通道序列对之间的度量距离构建包含全部节点的初始全连接网络图；第二构建子单元，用于根据所述初始全连接网络图中各节点对之间的度量距离，确定所述初始全连接网络图中每个节点的真近邻节点，构建获得候选近邻网络图；确定子单元，用于根据所述候选近邻网络图，确定备用近邻网络图；处理子单元，用于根据所述备用近邻网络图中每个节点的真近邻点数量，对所述备用近邻网络图进行稀疏化处理获得简化近邻网络图。本发明第三方面公开一种电子设备，包括存储有可执行程序代码的存储器以及与所述存储器耦合的处理器；所述处理器调用所述存储器中存储的所述可执行程序代码，用于执行第一方面公开的脑电信号的特征提取方法。本发明第四方面公开一种计算机可读存储介质，所述计算机可读存储介质存储计算机程序，其中，所述计算机程序使得计算机执行第一方面公开的脑电信号的特征提取方法。本发明的有益效果在于，通过构建脑电信号的简化近邻网络图，可以表示脑区之间复杂的空间关系，有利于保留脑电信号的拓扑结构信息，根据简化近邻网络图自适应优化核函数参数，可以结合脑电信号的复杂非线性拓扑结构特性建立更好的信号表达，并利用核技术将信号度量矩阵映射到高维空间，有效提升信号的非线性可分性，以及结合内积度量样本间的相似性，将较相似的映射到高斯核空间以增强其相似性，将较不相似的映射到多项式核空间以增强其区分度，这样既考虑了通道对的相似性，也增强了不相似通道对的区分度，两种核函数互相配合，可以增强样本区分性，得到更好的核映射效果，最后融合多域信息进行核重构得到具有更丰富特征关系的脑电度量矩阵，能够更好地反映信号的内在特征关系，减少噪声影响，从而在抑制噪声的同时保留更丰富信号特征，进而提高后续分类的准确性。此外，基于核矩阵的降维方法，可以获得保留脑电动力学特性的、更干净的低维特征表达，实现对关键脑活动特征的提取和解释。附图说明此处的附图，示出了本发明所述技术方案的具体实例，并与具体实施方式构成说明书的一部分，用于解释本发明的技术方案、原理及效果。除非特别说明或另有定义，不同附图中，相同的附图标记代表相同或相似的技术特征，对于相同或相似的技术特征，也可能会采用不同的附图标记进行表示。图1是本发明实施例公开的一种脑电信号的特征提取方法的流程图；图2是本发明实施例公开的一种脑电信号的特征提取装置的结构示意图；图3是本发明实施例公开的一种电子设备的结构示意图。附图标记说明：201、第一构建单元；202、第二构建单元；203、优化单元；204、计算单元；205、映射单元；206、提取单元；207、融合单元；208、降维单元；301、存储器；302、处理器。具体实施方式除非特别说明或另有定义，本文所使用的所有技术和科学术语与所属技术领域的技术人员通常理解的含义相同。在结合本发明的技术方案以现实的场景的情况下，本文所使用的所有技术和科学术语也可以具有与实现本发明的技术方案的目的相对应的含义。本文所使用的“第一、第二…”仅仅是用于对名称的区分，不代表具体的数量或顺序。本文所使用的术语“和／或”包括一个或多个相关的所列项目的任意的和所有的组合。需要说明的是，当元件被认为“固定于”另一个元件，它可以是直接固定在另一个元件上，也可以是存在居中的元件；当一个元件被认为是“连接”另一个元件，它可以是直接连接到另一个元件，也可以是同时存在居中元件；当一个元件被认为是“安装在”另一个元件，它可以是直接安装在另一个元件，也可以是同时存在居中元件。当一个元件被认为是“设在”另一个元件，它可以是直接设在另一个元件，也可以是同时存在居中元件。除非特别说明或另有定义，本文所使用的“所述”、“该”为相应位置之前所提及或描述的技术特征或技术内容，该技术特征或技术内容与其所提及的技术特征或技术内容可以是相同的，也可以是相似的。此外，本文所使用的术语“包括”和“具有”以及它们任何变形，意图在于覆盖不排他的包含。例如包含了一系列步骤或单元的过程、方法、系统、产品或设备没有限定于已列出的步骤或单元，而是可选地还包括没有列出的步骤或单元，或可选地还包括对于这些过程、方法、产品或设备固有的其他步骤或单元。本发明实施例公开一种脑电信号的特征提取方法，该方法可以通过计算机编程实现。该方法的执行主体可为如计算机电脑、笔记本电脑、平板电脑等电子设备，或内嵌于电子设备中的脑电信号的特征提取装置，本发明对此不作限定。为了便于理解本发明，下面将参照说明书附图对本发明的具体实施例进行更详细的描述。如图1所示，该方法包括以下步骤110~180：110、根据采集到的多通道的原始脑电信号，构建初始脑电度量矩阵。为获取高时间分辨率的多通道脑电活动信号，可以采用采样频率高、通道数多的脑电信号采集装置。参考国际标准10-20系统确定电极布置方案，使用Ag/AgCl材质电极，在受试者整个头皮覆盖布置电极，同时在部位如额叶、顶叶等关键区域采用密集网阵布置以获取更为详细的局部脑电信息。控制皮肤阻抗在5 kΩ以下然后进行采集。考虑到后续分析对信号质量的要求，采集参数设定为：采样频率1000Hz，使用0.5-100Hz带通滤波器过滤采集信号。为了获得稳定的脑电信号，让受试者在经过处理的屏蔽房内保持舒适静息状态或者进行规定任务，同时监测信号质量，确保获得至少5min长度的原始脑电信号。获得多通道的原始脑电信号后，需要进行数据组织和构建初始脑电度量矩阵以方便后续分析。具体将64通道5min长度的原始脑电信号波形整理形成一个64×300000的二维矩阵X，矩阵行数对应采集通道数，列数对应采样频率1000Hz下5min波形的采样点数n。该二维矩阵包含采集所有通道在全时长内的脑电采样值，保留了完整的时空特征信息，可作为脑电分析的初始脑电度量矩阵输入。120、根据初始脑电度量矩阵，构建简化近邻网络图。示例性的，步骤120包括以下未图示的步骤1201~1204：1201、计算初始脑电度量矩阵中各个通道序列对之间的度量距离，将各个通道序列视为节点，根据各个通道序列对之间的度量距离构建包含全部节点的初始全连接网络图。为了得到反映各通道序列之间关系的度量距离矩阵D，首先需要计算矩阵X中每对通道序列在n维空间内的度量距离。该度量距离可以是欧式距离或者马氏距离等距离度量值。以欧式距离为例，具体计算过程为：设矩阵X中第i个通道序列为Xi，第j个通道序列为Xj，其中i，j=1，2，...，m。遍历矩阵X的行序，每次提取一个通道序列Xi作为当前通道序列。然后分别计算该当前通道序列Xi与其它每个通道序列Xj逐采样点值的差的平方，对所有n个采样点值的差的平方进行累加求和，再对该累加和进行开方运算，即可获得该当前样本Xi与其它通道序列Xj之间的欧式距离，计算公式如下式所示：其中，Xi 和 Xj 表示这两个通道序列在第k个采样点上的采样值；Σ表示对k=1到n进行求和运算，n为每个通道序列包含的采样点数；-Xj)^2 表示计算这两个通道序列在第k个采样点上值的差的平方。重复该过程，计算矩阵X中各两个通道序列之间的欧式距离，最终得到一个对称的度量距离矩阵D，其元素D表示度量矩阵X中第i通道与第j通道序列在n维采样空间内的欧式距离，反映了通道序列之间的相似性。然后，将各个通道序列视为节点，根据度量距离矩阵D中各节点对之间的欧式距离，构建包含全部通道序列的初始全连接网络图。1202、根据初始全连接网络图中各节点对之间的度量距离，确定初始全连接网络图中每个节点的真近邻节点，构建获得候选近邻网络图。其中，遍历初始全连接网络图中每个节点作为当前节点，将度量距离小于距离阈值的其它节点标记为当前节点的真近邻节点，遍历所有节点之后，根据各个节点的真近邻节点构建获得候选近邻网络图。以欧式距离为例，遍历初始全连接网络图中每个节点作为当前节点，对于当前节点的Xi相关的所有欧式距离Dij，比较Dij与距离阈值d的大小关系。如果Dij小于r，则认为相应的其它节点Xj与当前节点Xi之间有较强的相似性关联，将Xj标记为Xi的真近邻节点。重复比较运算，最终可以得到当前节点Xi的真近邻节点集合Ni，表达为：Ni= {Xj| Dij＜d 对所有其它通道序列Xj}。同时，计算真近邻节点集合Ni的元素个数，即为当前节点Xi的真近邻点数量Ki= |Ni|。通过上述流程，实现了基于预设距离阈值d筛选每个节点局部区域内与其最相似的Ki个真近邻节点。其真近邻节点集合Ni和真近邻点数量Ki可以有效反映节点与相邻节点之间的相似性程度及密集程度。举例来说，假设有一个包含3个通道序列的矩阵X，每个通道序列有4个采样点，即n=4。那么矩阵X可以表示为：其中第一行是第1个通道序列，第二行是第2个通道序列，第三行是第3个通道序列。每个通道序列有4个采样点，将每两个通道序列在每个采样点上的采样值差求平方和后开方，就得到了这两个通道序列在4维空间上的欧式距离，例如D12= 2.345、 D13= 1.732、D23= 3.1622，可以得到度量距离矩阵D：设置距离阈值d=2.5，对于通道序列1与通道序列3的欧式距离D13=1.732＜d，所以通道序列3是通道序列1的真近邻节点；对于通道序列1与通道序列2的欧式距离D12=2.345＞d，所以通道序列2不是通道序列1的真近邻节点。重复上述判断，可以获得每个通道序列的真近邻节点，进而构建候选近邻网络图，例如，用以下有向网络图表示了三个通道序列之间的近邻关系：通道序列1 →通道序列3通道序列21203、根据候选近邻网络图，确定备用近邻网络图。度量距离可以采用一种或多种不同的距离度量方式计算，每一种距离度量方式可以计算出一个候选近邻网络图。在实际应用中，可以判断候选近邻网络图的数量是否大于一，若候选近邻网络图的数量等于一，说明度量距离采用一种距离度量方式计算时，可以直接将计算的唯一候选近邻网络图确定为备用近邻网络图。若候选近邻网络图的数量大于一，则说明度量距离采用多种距离度量方式计算，比如同时采用多种距离度量方式，按照上述步骤1201~1202计算得到与多种距离度量方式一一对应的多个候选近邻网络图，则可以从多个候选近邻网络图中选择出一个保真度最高的候选近邻网络图作为备用近邻网络图。具体的，从多个候选近邻网络图中选择出一个保真度最高的候选近邻网络图作为备用近邻网络图的实施方式可以包括以下未图示的步骤S11~S12：S11、根据初始脑电度量矩阵计算出拓扑结构基准值。首先设计一个计算原始脑电信号数据集网络拓扑结构特征的流程。这涉及选择图论算法，例如聚类系数算法、最短路径算法等，来分析基于原始脑电信号构建的初始脑电度量矩阵，计算出表示网络拓扑结构的关键指标，包括但不限于：①利用聚类系数算法，计算初始脑电度量矩阵中每个通道序列作为节点时的聚类系数Ci，Ci用于反映该节点的相邻节点之间的互相连接程度；将所有节点的聚类系数Ci求平均，即得原始脑电信号网络的平均聚类系数Cp0，Cp0=∑Ci/ n；②利用最短路径算法，计算任意两个节点之间的最短路径长度dij，反映原始脑电信号网络的路径距离特征。将所有节点间最短路径长度dij计算平均，即得原始脑电信号网络的平均最短路径长度Lp0，。将Cp0、Lp0确定为原始脑电信号网络的拓扑结构基准值。S12、计算各个候选近邻网络图的拓扑结构指标值与拓扑结构基准值之间的误差，将误差最小的其中一个候选近邻网络图确定为备用近邻网络图。假设基于欧式距离、马氏距离两种距离度量方式，构建出两个候选近邻网络图G1和G2。对两个候选近邻网络图分别采用上述选择图论算法，计算各个候选近邻网络图的拓扑结构指标值，如计算获得候选近邻网络图G1的Cp1、Lp1，以及候选近邻网络图G2的Cp2、Lp2。下一步，对两个候选近邻网络图的拓扑结构指标值与原始脑电信号网络中计算得到的拓扑结构基准值进行量化比较和分析。具体来说，分别计算出各个候选近邻网络图的拓扑结构指标值与相应的拓扑结构基准值之间的误差，例如，候选近邻网络图G1的平均聚类系数Cp1与原始脑电信号网络的平均聚类系数Cp0之差的绝对值，表示为误差项Err；候选近邻网络图G1的平均最短路径长度Lp1与原始脑电信号网络的平均最短路径长度Lp0之差的绝对值，表示为误差项Err。同理，计算出候选近邻网络图G2的各项拓扑结构指标值与相应的拓扑结构基准值之间的误差，例如Err， Err等。接着，判断这些拓扑结构指标值的误差大小，如果某个候选近邻网络图的各个误差项很小，例如Err、Err等都比较接近0，那么就可以认为这个候选近邻网络图在保留原始脑电信号网络的拓扑结构方面，与原始脑电信号网络的相似性较高，可以选择它作为最终使用的备用近邻网络图。具体的，采用多个拓扑结构指标值与拓扑结构基准值的误差之和最小的候选近邻网络图作为最终使用的备用近邻网络图。1204、根据备用近邻网络图中每个节点的真近邻点数量，对备用近邻网络图进行稀疏化处理，获得简化近邻网络图。示例性的，步骤1204可以包括以下未图示的步骤S21~S22：S21、将备用近邻网络图中真近邻点数量小于真近邻阈值的节点标记为边缘节点。根据先前计算得到的每个节点Xi的真近邻点数量Ki，遍历所有节点，判断每个节点的Ki与预设的真近邻阈值Kt的大小关系。如果某个节点Xi的真近邻点数量Ki小于真近邻阈值Kt，则认为该节点与周围节点的相似性较弱，将该节点标记为边缘节点。S22、以边缘节点为中心，识别构成其连接边的相邻节点，并从备用近邻网络图中删除边缘节点及其所有连接边，同时约束每个节点的连接边总数不大于最大连接数，获得简化近邻网络图。重复上述操作，依次删除真近邻节点较少的边缘节点及其连接边，以达到降低节点连接密度的目的。同时在稀疏化处理过程中，除了根据真近邻点数量对节点进行过滤之外，还可以设置最大连接数Cm对每个节点的连接边总数进行约束。具体来说，统计每一个节点Xi的连接边总数，如果连接边总数超过预设的最大连接数Cm，则保留节点Xi与之度量距离较近的Cm个相邻节点，其余连接边全部删除。这样通过设置最大连接数Cm的约束，可以进一步控制网络图的连接稀疏程度，删除节点连接关系中较弱的边，使最后得到的简化近邻网络图中每个节点的连接边总数被限制在Cm以内。这种双重筛选方法可以更有效地构建出通道序列之间联系最密切的核心拓扑网络结构。最终获得一个节点连接较稀疏、剔除了相似性较弱冗余连接的简化近邻网络图。该简化近邻网络图突出了通道序列之间的核心近邻拓扑关系，提供了重要的网络结构信息，为后续连接特征分析奠定基础。130、根据简化近邻网络图，分别自适应优化高斯核函数和多项式核函数的参数，获得目标高斯核函数和目标多项式核函数。示例性的，步骤130包括以下未图示的步骤1301~1302：1301、设置参数可调的高斯核函数和多项式核函数。在本发明实施例中，基于构建的简化近邻网络图，在设置高斯核时会参考简化近邻网络图的节点分布情况，高斯核函数的表达方式为Kg=exp，其中，||x-x'||表示样本点x和x'之间欧式距离，σ为可调的核宽度参数。同时设置多项式核时会考虑网络图的节点数和边数，以获取良好的映射维度设置，多项式核函数的表达方式为，其中，γ为核的缩放参数，r为偏移参数，d为度数参数，这些参数都可调；x表示一个列向量，T表示转置运算，xTx'表示先对列向量x进行转置，得到行向量xT，然后计算行向量xT与另一列向量x'的内积。其中，高斯核函数可以提取网络图节点间线性可分的特征，多项式核函数可以提取非线性复杂特征，结合使用可以优化后续样本点核映射到新的特征空间时的效果，使得映射后可以更好保留原样本点组成的近邻网络结构中的关键信息。1302、根据简化近邻网络图中连接的节点对，分别自适应优化高斯核函数和多项式核函数的参数，获得目标高斯核函数和目标多项式核函数。具体的，根据简化近邻网络图中连接的成对节点，采用粒子群算法等优化方法，自动调节高斯核函数中的核宽度参数σ以及多项式核函数中的γ、r、d等参数，得到了优化后的目标高斯核函数Kg'和目标多项式核函数Kp'。粒子群算法是通过维护一组粒子即参数候选解在特征空间中飞行迭代搜索最优参数点，从而实现核函数参数的自适应优化，使样本点经过核函数映射到新的高维特征空间后，其拓扑结构能够最大程度保留原始近邻网络图中的结构信息，达到提高脑电信号特征提取效果，从而可以优化核映射效果，有利于后续信号分析任务的目的。140、计算初始脑电度量矩阵中每个通道序列对的内积。为了评估不同通道序列之间的相似性，需要将矩阵X中的每对通道序列Xi和Xj视为样本点，计算Xi和Xj的内积Sim，内积计算公式为对两个通道序列在各个采样点k上的采样值乘积求和，，k从1到n。其中，Xi和Xj分别表示通道序列Xi和Xj在第k个采样点上的采样值。内积Sim的大小表示了两个通道序列Xi和Xj的相似程度，内积越大意味着两条序列越相似。150、根据目标高斯核函数将内积达到预设内积阈值的通道序列对映射到高斯核空间，以及，根据目标多项式核函数将内积小于预设内积阈值的通道序列对映射到多项式核空间。计算得到所有通道序列对的内积后，根据预设的内积阈值τ，τ的设置会综合考虑简化近邻网络图的节点对分布情况，以对通道序列对相似性进行合理判定。将内积Sim大于或等于τ的通道序列对映射到高斯核空间，以及，将内积小于τ的通道序列对则映射到多项式核空间。其中，高斯核函数能很好地度量样本间的相似性，将内积较大的通道序列对映射到高斯核空间，可以增强其相似性。而多项式核具有映射样本到高维空间的能力，可以增加不相似样本的区分度，将内积较小的通道序列对映射到多项式核空间，可以进一步拉大它们之间的距离，增强区分度。这样，既考虑了通道序列对的相似性，也增强了不相似通道序列对的区分能力，两种核函数互相配合，可以得到更好的核映射效果。示例性地，例如τ=100，第1通道序列和第2通道序列的内积计算过程为：。第1通道序列和第3通道序列的内积计算过程为：。第2通道序列和第3通道序列的内积计算过程为：。则通道序列对  和  映射到多项式核空间，通道序列对 映射到高斯核空间。160、在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征。示例性的，步骤160包括以下未图示的步骤1601~1602：1601、在高斯核空间和多项式核空间中，计算映射后的距离矩阵作为各核空间的核矩阵。在高斯核空间中，初始化一个N×N的距离矩阵D_Kg，N代表高斯核空间中的样本数量，矩阵D_Kg的所有元素先置为0。然后遍历高斯核空间中的每一对通道序列xp和xq，计算每对通道序列之间的欧式距离，采用公式，这里求和是对向量的每一个维度计算差值的平方。计算得到欧式距离d_pq后，将d_pq填入距离矩阵D_Kg中的第p行第q列元素。重复上述过程，遍历计算高斯核空间中每一对通道序列之间的欧式距离，并将结果填入距离矩阵D_Kg中对应的元素。最后令距离矩阵D_Kg对角线元素为0，这样就得到了高斯核空间中的距离矩阵D_Kg作为核矩阵。同样的过程，初始化M×M矩阵的距离矩阵D_Kp，M为多项式核空间的样本数量，初始化的矩阵元素置为0，然后遍历每对样本点，计算欧式距离填入对应矩阵元素，最后令对角线元素设为0，可计算得到多项式核空间中的距离矩阵D_Kp作为核矩阵。示例性地：通道序列对映射到高斯核空间。其中，x2为矩阵X的第2行，x3为矩阵X的第3行。则通道序列对x2和x3之间的欧式距离为： d = sqrt^2 + ^2 + ^2 + ^2) =sqrt = 2.6，所以。通道序列对和映射到多项式核空间。其中，x1为矩阵X的第1行，x2为矩阵X的第2行，x3为矩阵X的第3行。计算欧式距离d = 2.9，d = 2.1，所以。1602、根据简化近邻网络图以及各核空间的核矩阵，计算各核空间对应的拉普拉斯矩阵，将拉普拉斯矩阵的最大特征值确定为对应核空间的信息素特征。示例性的，可以根据简化近邻网络图以及各核空间的核矩阵，确定各核空间的相邻关系矩阵，然后将各核空间的核矩阵减去相应的相邻关系矩阵，得到拉普拉斯矩阵，再求解拉普拉斯矩阵的特征方程，得到最大特征值确定为对应核空间的信息素特征。具体的，首先需要根据高斯核空间的距离矩阵D_Kg确定它对应的相邻关系矩阵A_Kg，其中相邻关系矩阵A_Kg与距离矩阵D_Kg大小相同，用于表示距离矩阵对应的图结构关系，即，如果样本点之间在简化近邻网络图中有连接，则相邻关系矩阵对应的元素置1，不连接则为0。然后使距离矩阵D_Kg减去其对应的相邻关系矩阵A_Kg，进行矩阵减法D_Kg-A_Kg后可以得到拉普拉斯矩阵L_Kg。接下来需要求解拉普拉斯矩阵L_Kg的特征方程，特征方程的形式为：L_Kg的特征值λ乘以单位矩阵I减去L_Kg等于0矩阵。通过求解这个特征方程，可以得到拉普拉斯矩阵L_Kg的全部特征值。在这些特征值中，找到最大的特征值，这个最大特征值即为距离矩阵D_Kg的谱半径，记为λ_Kg_max。同样的，可以根据多项式核空间的距离矩阵D_Kp，构建其拉普拉斯矩阵L_Kp，并求解特征方程获取最大特征值λ_Kp_max，即为D_Kp的谱半径。最终，λ_Kg_max和λ_Kp_max这两个谱半径可以作为高斯核空间和多项式核空间的信息素特征。示例说明：假设高斯核空间中只有通道序列对。而如果两个通道序列在简化近邻网络图中有连接，则相邻关系矩阵对应的元素置1，不连接则为0。因此，对于只有通道序列对x2和x3的高斯核空间，相邻关系矩阵A_Kg可以构建如下：第一行的第一个元素为0表示x2和x2之间没有连接，第二个元素为1表示x2和x3之间有连接。第二行也是类似的相邻关系表示。相邻关系矩阵A_Kg构建为一个2x2的矩阵，对角线元素为0，非对角线元素为1，表示这种相邻关系。那么拉普拉斯矩阵。然后求特征方程|L_Kg - λI| = 0的特征值，求得λ = ±1.6，则D_Kg的谱半径λ_Kg_max = 1.6；同理计算D_Kp的拉普拉斯矩阵L_Kp和特征值，得到谱半径λ_Kp_max = 4.2。170、根据初始脑电度量矩阵的类别标签，将各核空间的信息素特征融合映射到组合核空间，获得重构脑电度量矩阵。示例性的，可以采用核重构模型，实现对初始脑电度量矩阵进行分类，以及同时融合各核空间的信息素特征以对初始脑电度量矩阵进行核重构，获得重构脑电度量矩阵。其中，核重构模型是一个可以学习样本的多个核矩阵结合表示的框架，也即这里要学习的是由多个核矩阵结合得到的联合核矩阵K，包含了不同核函数映射后的特征信息。具体的，核重构模型的输入有两部分任务，一部分任务是对原始样本特征进行分类获得类别标签；另一部分任务是学习前面计算得到的各核空间的信息素特征，如谱半径λ_Kg_max和λ_Kp_max它们反映了各个核映射空间中的样本结构信息。通过在核重构模型内部设计一个用于优化的目标函数J，学习样本在多个核空间的坐标映射函数f。其中，目标函数如下式所示： 式中，K表示组合多个核空间的信息素特征得到的联合核矩阵，f表示学习的核映射函数，X原始样本特征矩阵，每行表示一个样本，f表示对样本矩阵X通过函数f核映射得到的新特征矩阵，α表示正则化参数，控制正则项的强度，||·||^2 表示矩阵或向量的弗罗贝尼乌斯范数，计算元素平方和然后开根号。这个目标函数使学习到的映射函数f既逼近联合核矩阵K又具有正则化。通过最小化目标函数求解学习坐标映射函数f，函数f可以将新的样本根据其类别标签以及提供的各核空间的信息素特征，映射到组合核空间中，生成新的特征表示z = f，对全部样本重复这个映射计算，就可以得到重构后的脑电度量矩阵Z。核重构通过核函数映射到高维空间进行非线性降噪，适当选择参数，获得更干净的低维特征表达，从而可以有效减少噪声影响，提高脑电信号的降噪和分类效果。这个重构脑电度量矩阵Z基于丰富的核空间结构信息，反映了更丰富的特征关系，如不同频率范围的能量特征，不同区域之间的关联特征等，可以更好地反映样本之间的内在特征关系。这与核重构映射到高维核空间所反映的丰富结构信息是一致的，可以保留样本间在高维空间的内在特征关系，在抑制噪声的同时保留更丰富信号特征的低维表达，因此可以增强样本区分性，提高后续分类的准确率。180、对重构脑电度量矩阵进行降维，获得脑电特征矩阵。在获得重构脑电度量矩阵Z后，基于核矩阵理论，使用核算法对重构后的脑电度量矩阵进行降维，得到低维的脑电特征矩阵。具体来说，先计算Z的奇异值分解：，以获得矩阵Z在高维空间的主要特征信息。U是左奇异向量矩阵，其列向量ui代表了Z的对应的特征向量；Σ是奇异值对角矩阵，对角线元素按大小排序代表了Z矩阵的特征值λ1≥ λ2 ≥ ... ≥ λn；VT是右奇异向量矩阵的转置。V矩阵的列向量vi是Z的右奇异向量，和U矩阵的左奇异向量ui一一对应，VT中的右奇异向量vi表示了Z在行空间的正交基。通过奇异值分解可以获得Z的列空间和行空间的正交基以及奇异值信息。接下来，选择奇异值较大的前p个奇异值，提取对应的左奇异向量构成矩阵Up。选择前p个是为了保留样本在高维空间中的主要特征信息，p值的选择考虑余弦递减性原则，即当奇异值贡献达到一定阈值时确定p值。最后，进行低秩逼近：/＞，其中Σp包含选择的前p个奇异值，Up和Vp分别包含对应选取的左右奇异向量。低秩逼近实现对矩阵Z的降维映射，得到降维后的低维脑电特征矩阵Zr。低维的脑电特征矩阵Zr可以用于建立分类模型，实现对脑电信号的自动分类和预测。这里以支持向量机为例详细说明。首先，将降维后的脑电特征矩阵Zr与对应样本的类别标签组成完整的训练数据集，其中Zr表示样本在低维特征空间中的坐标，标签y表示样本属于的类别。然后将训练数据集输入SVM进行模型训练，SVM通过核函数将样本映射到高维特征空间中，在这个虚拟的特征空间里面寻找最优的分类超平面，即最大程度分隔不同类别样本的决策边界，完成模型参数的优化过程。训练完成后，SVM模型得到决策函数，用于判断新样本的类别。对于测试集中的一个新的样本x，先用同样的核函数将其映射到高维特征空间，然后利用SVM学习到的决策函数计算样本x在该高维特征空间中的坐标，依据其相对于决策边界的位置来预测其类别，依次对所有测试样本进行预测，完成对整个测试集的分类。通过上述SVM模型训练和预测过程，可以利用低维特征矩阵中反映的样本特征信息，自动完成对脑电信号的分类，实现智能控制、人机交互等实际应用。综上所述，实施本发明实施例，通过构建脑电信号的简化近邻网络图，可以表示脑区之间复杂的空间关系，有利于保留脑电信号的拓扑结构信息，根据简化近邻网络图自适应优化核函数参数，可以结合脑电信号的复杂非线性拓扑结构特性建立更好的信号表达，并利用核技术将信号度量矩阵映射到高维空间，有效提升信号的非线性可分性，以及结合内积度量样本间的相似性，将较相似的映射到高斯核空间以增强其相似性，将较不相似的映射到多项式核空间以增强其区分度，这样既考虑了通道对的相似性，也增强了不相似通道对的区分度，两种核函数互相配合，可以增强样本区分性，得到更好的核映射效果，最后融合多域信息进行核重构得到具有更丰富特征关系的脑电度量矩阵，能够更好地反映信号的内在特征关系，减少噪声影响，从而在抑制噪声的同时保留更丰富信号特征，进而提高后续分类的准确性。此外，基于核矩阵的降维方法，可以获得保留脑电动力学特性的、更干净的低维特征表达，实现对关键脑活动特征的提取和解释。如图2所示，本发明实施例公开一种脑电信号的特征提取装置，包括第一构建单元201、第二构建单元202、优化单元203、计算单元204、映射单元205、提取单元206、融合单元207、降维单元208，其中，第一构建单元201，用于根据采集到的多通道的原始脑电信号，构建初始脑电度量矩阵；第二构建单元202，用于根据初始脑电度量矩阵，构建简化近邻网络图；优化单元203，用于根据简化近邻网络图，分别自适应优化高斯核函数和多项式核函数的参数，获得目标高斯核函数和目标多项式核函数；计算单元204，用于计算初始脑电度量矩阵中每个通道序列对的内积；映射单元205，用于根据目标高斯核函数将内积达到预设内积阈值的通道序列对映射到高斯核空间，以及，根据目标多项式核函数将内积小于预设内积阈值的通道序列对映射到多项式核空间；提取单元206，用于在高斯核空间和多项式核空间中，根据映射后的核矩阵分别提取各核空间的信息素特征；融合单元207，用于根据初始脑电度量矩阵的类别标签，将各核空间的信息素特征融合映射到组合核空间，获得重构脑电度量矩阵；降维单元208，用于对重构脑电度量矩阵进行降维，获得脑电特征矩阵。作为一种可选的实施方式，第二构建单元202包括以下未图示的子单元：第一构建子单元，用于计算初始脑电度量矩阵中各个通道序列对之间的度量距离，将各个通道序列视为节点，根据各个通道序列对之间的度量距离构建包含全部节点的初始全连接网络图；第二构建子单元，用于根据初始全连接网络图中各节点对之间的度量距离，确定初始全连接网络图中每个节点的真近邻节点，构建获得候选近邻网络图；确定子单元，用于根据候选近邻网络图，确定备用近邻网络图；处理子单元，用于根据备用近邻网络图中每个节点的真近邻点数量，对备用近邻网络图进行稀疏化处理获得简化近邻网络图。如图3所示，本发明实施例公开一种电子设备，包括存储有可执行程序代码的存储器301以及与存储器301耦合的处理器302；其中，处理器302调用存储器301中存储的可执行程序代码，执行上述各实施例中描述的脑电信号的特征提取方法。本发明实施例还公开一种计算机可读存储介质，其存储计算机程序，其中，该计算机程序使得计算机执行上述各实施例中描述的脑电信号的特征提取方法。以上实施例的目的，是对本发明的技术方案进行示例性的再现与推导，并以此完整的描述本发明的技术方案、目的及效果，其目的是使公众对本发明的公开内容的理解更加透彻、全面，并不以此限定本发明的保护范围。以上实施例也并非是基于本发明的穷尽性列举，在此之外，还可以存在多个未列出的其他实施方式。在不违反本发明构思的基础上所作的任何替换与改进，均属本发明的保护范围。
