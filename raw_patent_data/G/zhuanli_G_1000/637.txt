标题title
一种基于脑电信号特征的分类方法
摘要abst
本发明公开一种基于脑电信号特征的分类方法，通过引入近似熵，并与GRU所捕捉的时序关系相结合，模型能够更好地理解信号的复杂结构，使K‑Means与GRU相互补充，形成一个更为综合和精确的意识状态分类模型。这种融合方法有效地利用了传统机器学习和深度学习的优势，提高了对意识状态的全面分类性能，特别是在捕捉脑电信号动态变化方面的准确性得到显著提升；本发明不仅提供了高效的K‑Means与GRU相结合的特征提取方法，还实现了对意识状态的自动分类。通过深度学习模型与机器学习方法的协同学习和训练，使得模型能够实时对新的脑电信号进行智能分类，为医疗领域提供了一种更加智能、高效的意识状态监测手段。
权利要求书clms
1.一种基于脑电信号特征的分类方法，其特征在于，包括以下步骤：采集脑电信号数据，并处理；对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波；在滤波后的脑电信号数据上，计算每个信号片段的近似熵作为特征，计算公式为：其中，m是模式的长度，r是相似度阈值，N是时间序列的长度，/＞表示m阶近似熵；将提取的特征序列划分为训练集和测试集；采用反向传播算法，通过最小化损失函数，不断调整GRU网络的权重和偏差；GRU网络捕捉预处理后的信号的时序关系，再与近似熵融合；在GRU网络的输出基础上，对K-Means聚类算法进行训练，对训练集中的数据进行分类；使用测试集对训练好的GRU网络与K-Means聚类算法模型评估模型在意识状态分类上的性能；将经过训练的GRU网络与K-Means聚类算法模型应用于新采集的脑电信号数据，实现对意识状态的实时分类。2.根据权利要求1所述的基于脑电信号特征的分类方法，其特征在于，所述采集脑电信号数据的步骤之后还包括：将脑电信号数据保存为edf格式文件，并提取原始脑电信号数据，并将其整理为mat格式；对整理后的数据进行降采样，采样率为256Hz。3.根据权利要求1所述的基于脑电信号特征的分类方法，其特征在于，所述对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波的步骤包括：去除脑电信号中的暂态部分；选择相关的导联；进行基线校正，基线校正的公式为：，其中，X为原始信号，Xb为经过基线校正后的信号，mean）为信号X在某一时间范围内的均值；进行0.01Hz至45Hz的带通滤波，带通滤波可以通过差分方程表示，差分方程为，其中，Xb是经过基线校正后的输入信号，y是输出信号，n是滤波器的阶数，b0,b1,…,bn和a1,…,an是滤波器的系数。4.根据权利要求3所述的基于脑电信号特征的分类方法，其特征在于，所述对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波的步骤还包括：对于连续时间的带通滤波，传递函数表示为： 其中，s是Laplace变换的复变量，s1，s2，…，s2n是希望通过的频率点，z1，z2，…，z2n是需要阻止的频率点，K是增益系数。5.根据权利要求1所述的基于脑电信号特征的分类方法，其特征在于，所述采用反向传播算法，通过最小化损失函数，不断调整GRU网络的权重和偏差；GRU网络捕捉预处理后的信号的时序关系，再与近似熵融合；在GRU网络的输出基础上，对K-Means聚类算法进行训练，对训练集中的数据进行分类的步骤中，所述GRU网络通过门控单元捕捉脑电信号中的时序关系包括以下步骤：初始化一个状态向量为隐藏状态；对于输入序列中的每个时间步，接收当前时间步的输入数据和前一个时间步的隐藏状态，计算当前时间步的候选隐藏状态；从前一个时间步的隐藏状态中保留信息并输出，其输出范围在0到1之间；忽略部分来自前一个时间步的隐藏状态的信息并输出，其输出范围在0到1之间；计算当前时间步的候选隐藏状态；将当前时间步的候选隐藏状态与前一个时间步的隐藏状态整合，得到最终的当前时间步的隐藏状态；重复上述步骤，处理整个输入序列，在每个时间步，都会更新隐藏状态，以捕捉序列中的时序关系。
说明书desc
技术领域本发明涉及脑电信号分类技术领域，尤其涉及一种基于脑电信号特征的分类方法。背景技术在神经科学和神经生理学领域，对脑电信号进行全面而准确的分析一直是一项具有重要研究价值的任务。传统的信号处理方法，如时域和频域分析，以及一些基于统计学的特征提取方法，曾在很长一段时间内是主流研究方向。然而，这些方法在处理复杂的时序关系和提高分类准确性方面存在一定的局限性。综上所述，如何设计一种用于处理复杂的时序关系和提高分类准确性的脑电信号特征的分类方法，是目前本领域技术人员亟待解决的问题。发明内容本发明实施例的主要目的在于提出一种基于脑电信号特征的分类方法，旨在设计一种用于处理复杂的时序关系和提高分类准确性的脑电信号特征的分类方法。本发明解决上述技术问题的技术方案是，提供一种基于脑电信号特征的分类方法，包括以下步骤：采集脑电信号数据，并处理；对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波；在滤波后的脑电信号数据上，计算每个信号片段的近似熵作为特征，计算公式为：其中，m是模式的长度，r是相似度阈值，N是时间序列的长度，表示m阶近似熵；将提取的特征序列划分为训练集和测试集；采用反向传播算法，通过最小化损失函数，不断调整GRU网络的权重和偏差；GRU网络捕捉预处理后的信号的时序关系，再与近似熵融合；在GRU网络的输出基础上，对K-Means聚类算法进行训练，对训练集中的数据进行分类；使用测试集对训练好的GRU网络与K-Means聚类算法模型评估模型在意识状态分类上的性能；将经过训练的GRU网络与K-Means聚类算法模型应用于新采集的脑电信号数据，实现对意识状态的实时分类。进一步地，所述采集脑电信号数据的步骤之后还包括：将脑电信号数据保存为edf格式文件，并提取原始脑电信号数据，并将其整理为mat格式；对整理后的数据进行降采样，采样率为256Hz。进一步地，所述对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波的步骤包括：去除脑电信号中的暂态部分；选择相关的导联；进行基线校正，基线校正的公式为：，其中，X为原始信号，Xb为经过基线校正后的信号，mean）为信号X在某一时间范围内的均值；进行0.01Hz至45Hz的带通滤波，带通滤波可以通过差分方程表示，差分方程为，其中，Xb是经过基线校正后的输入信号，y是输出信号，n是滤波器的阶数，b0,b1,…,bn和a1,…,an是滤波器的系数。进一步地，所述对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波的步骤还包括：对于连续时间的带通滤波，传递函数表示为：其中，s是Laplace变换的复变量，s1，s2，…，s2n是希望通过的频率点，z1，z2，…，z2n是需要阻止的频率点，K是增益系数。进一步地，所述采用反向传播算法，通过最小化损失函数，不断调整GRU网络的权重和偏差；GRU网络捕捉预处理后的信号的时序关系，再与近似熵融合；在GRU网络的输出基础上，对K-Means聚类算法进行训练，对训练集中的数据进行分类的步骤中，所述GRU网络通过门控单元捕捉脑电信号中的时序关系包括以下步骤：初始化一个状态向量为隐藏状态；对于输入序列中的每个时间步，接收当前时间步的输入数据和前一个时间步的隐藏状态，计算当前时间步的候选隐藏状态；从前一个时间步的隐藏状态中保留信息并输出，其输出范围在0到1之间；忽略部分来自前一个时间步的隐藏状态的信息并输出，其输出范围在0到1之间；计算当前时间步的候选隐藏状态；将当前时间步的候选隐藏状态与前一个时间步的隐藏状态整合，得到最终的当前时间步的隐藏状态；重复上述步骤，处理整个输入序列。在每个时间步，都会更新隐藏状态，以捕捉序列中的时序关系。本发明的技术方案引入了近似熵作为时域特征，并与时序关系相融合，通过量化脑电信号的复杂性，K-Means与GRU相结合的模型在这一背景下更能准确地捕捉脑电信号的动态变化。K-Means作为一种传统机器学习方法在特定特征上表现出色，而GRU作为深度学习分类器则能够有效地捕捉脑电信号中的时序关系。通过近似熵引入，并与GRU所捕捉的时序关系相结合，模型能够更好地理解信号的复杂结构，使K-Means与GRU相互补充，形成一个更为综合和精确的意识状态分类模型。这种融合方法有效地利用了传统机器学习和深度学习的优势，提高了对意识状态的全面分类性能，特别是在捕捉脑电信号动态变化方面的准确性得到显著提升；本发明不仅提供了高效的K-Means与GRU相结合的特征提取方法，还实现了对意识状态的自动分类。通过深度学习模型与机器学习方法的协同学习和训练，使得模型能够实时对新的脑电信号进行智能分类，为医疗领域提供了一种更加智能、高效的意识状态监测手段。综上所述，本发明的创新在于采用三分类方法引入近似熵作为时域特征，实现了深度学习与机器学习的融合，以及自动化分类的实现。这一综合创新不仅提高了对意识状态的准确检测能力，同时为深度学习与机器学习在医学领域的协同应用提供了新的思路，为未来智能医疗领域的发展开辟了新的方向。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图示出的结构获得其他的附图。图1为本发明所述基于脑电信号特征的分类方法的方法流程图；图2为本发明所述基于脑电信号特征的分类方法的网络结构图；图3为本发明所述GRU的网络结构图；图4为本发明所述K-Means网络的结构图。具体实施方式下面将结合本发明说明书附图中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明，本发明实施例中所有方向性指示仅用于解释在某一特定姿态下各部件之间的相对位置关系、运动情况等，如果该特定姿态发生改变时，则该方向性指示也相应地随之改变。另外，在本发明中如涉及“第一”、“第二”等的描述仅用于描述目的，而不能理解为指示或暗示其相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本发明的描述中，“若干”、“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。在本发明中，除非另有明确的规定和限定，术语“连接”、“固定”等应做广义理解，例如，“固定”可以是固定连接，也可以是可拆卸连接，或成一体；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通或两个元件的相互作用关系，除非另有明确的限定。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。另外，本发明各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当认为这种技术方案的结合不存在，也不在本发明要求的保护范围之内。本发明提出一种基于脑电信号特征的分类方法，旨在设计一种用于处理复杂的时序关系和提高分类准确性的脑电信号特征的分类方法。下面将在具体实施例中对本发明提出的基于脑电信号特征的分类方法进行说明：在本实施例的技术方案中，如图1所示，一种基于脑电信号特征的分类方法，包括以下步骤：S10：采集脑电信号数据，并处理；具体地，使用专业脑电信号采集设备，对意识状态已知的患者进行脑电信号采集；确保在安静、无干扰的环境中进行采集，以获取高质量的脑电信号。S20：对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波；具体地，文件处理：将采集到的脑电信号保存为edf格式文件，使用专门的edf文件解析工具，提取原始脑电信号数据，并将其整理为mat格式，以便后续处理；然后，对整理后的数据进行降采样，将采样率调整至256Hz；随后，按照2秒为单位对数据进行分段，形成适用于深度学习的输入序列。数据处理：首先，去除信号中的暂态部分，以减少可能的噪音影响。其次，选择相关的导联，确保只使用与意识状态相关的脑电信号。进行基线校正，以消除可能的漂移。最后，对信号进行0.01Hz至45Hz的带通滤波，保留感兴趣的频率范围。S30：在滤波后的脑电信号数据上，计算每个信号片段的近似熵作为特征，计算公式为：其中，m是模式的长度，r是相似度阈值，N是时间序列的长度，表示m阶近似熵；具体地，近似熵是一种用于度量信号复杂性的统计特征，适用于描述脑电信号的动态变化；其计算步骤为先将原始信号分成长度为m的子序列，计算每个子序列对于其他子序列的距离，通常使用欧氏距离或其他合适的距离度量，对比距离与相似度阈值r，计算m阶近似熵和阶近似熵，最终的ApEn由两者差值给出；S40：将提取的特征序列划分为训练集和测试集；具体地，在构建训练集和测试集时，确保两者的分布均匀，在训练集上进行深度学习模型的训练，而测试集用于评估模型的性能。S50：采用反向传播算法，通过最小化损失函数，不断调整GRU网络的权重和偏差；GRU网络捕捉预处理后的信号的时序关系，再与近似熵融合；在GRU网络的输出基础上，对K-Means聚类算法进行训练，对训练集中的数据进行分类；具体地，GRU的主要任务是通过其门控机制有效地捕捉脑电信号中的时序关系。由于GRU具备内部状态的更新机制，能够动态地维护和更新网络中的信息，因此特别适用于处理时间序列数据。通过对GRU的训练，模型能够学习脑电信号中复杂的时序模式，从而显著提高对不同意识状态的分类准确性；与此同时，引入了近似熵作为另一重要的特征；将GRU提取的时序关系和近似熵进行融合，形成了一个综合的特征。使用融合后的特征向量作为每个样本的表示，将其输入到K-Means算法中进行聚类。K-Means将相似的样本聚集在一起，形成不同的簇，每个簇可以看作是一种类别。S60：使用测试集对训练好的GRU网络与K-Means聚类算法模型评估模型在意识状态分类上的性能；具体地，使用适当的评估指标来评估模型的性能。S70：将经过训练的GRU网络与K-Means聚类算法模型应用于新采集的脑电信号数据，实现对意识状态的实时分类。具体地，将经过训练的深度学习与K-Means聚类算法模型应用于新采集的脑电信号数据，实现对意识状态的实时分类。旨在检验所提出的深度学习与K-Means聚类算法相结合的分类方法在意识状态检测中的有效性，并可将该方法应用于医学临床实践。可以理解地，本申请引入了近似熵作为时域特征，并与时序关系相融合，通过量化脑电信号的复杂性，K-Means与GRU相结合的模型在这一背景下更能准确地捕捉脑电信号的动态变化。K-Means作为一种传统机器学习方法在特定特征上表现出色，而GRU作为深度学习分类器则能够有效地捕捉脑电信号中的时序关系。通过近似熵引入，并与GRU所捕捉的时序关系相结合，模型能够更好地理解信号的复杂结构，使K-Means与GRU相互补充，形成一个更为综合和精确的意识状态分类模型。这种融合方法有效地利用了传统机器学习和深度学习的优势，提高了对意识状态的全面分类性能，特别是在捕捉脑电信号动态变化方面的准确性得到显著提升；本发明不仅提供了高效的K-Means与GRU相结合的特征提取方法，还实现了对意识状态的自动分类。通过深度学习模型与机器学习方法的协同学习和训练，使得模型能够实时对新的脑电信号进行智能分类，为医疗领域提供了一种更加智能、高效的意识状态监测手段。综上所述，本发明的创新在于采用三分类方法引入近似熵作为时域特征，实现了深度学习与机器学习的融合，以及自动化分类的实现。这一综合创新不仅提高了对意识状态的准确检测能力，同时为深度学习与机器学习在医学领域的协同应用提供了新的思路，为未来智能医疗领域的发展开辟了新的方向其中主要的深度学习网络选择了门控循环单元网络。该方法的最终目标是对意识状态进行三分类，分别为VS、MCS+和MCS-。具体地，模型包括输入层、GRU层、K-Means聚类层、全连接层、输出层、如图2所示，其中GRU层如图3所示，包括输入、重置门、更新门、记忆单元、输出；其中K-Means聚类层如图4所示，包括选择初始中心点、分配数据到最近的中心、收敛或达到最大迭代次数、更新聚类中心、输出聚类结果。进一步地，所述采集脑电信号数据的步骤之后还包括：将脑电信号数据保存为edf格式文件，并提取原始脑电信号数据，并将其整理为mat格式；对整理后的数据进行降采样，采样率为256Hz。进一步地，所述对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波的步骤包括：去除脑电信号中的暂态部分；选择相关的导联；进行基线校正，基线校正的公式为：，其中，X为原始信号，Xb为经过基线校正后的信号，mean）为信号X在某一时间范围内的均值；这样的操作能够使得信号相对于基线的平均值为零，突显信号的波动和变化，使得后续分析更加准确。进行0.01Hz至45Hz的带通滤波，带通滤波可以通过差分方程表示，差分方程为，其中，Xb是经过基线校正后的输入信号，y是输出信号，n是滤波器的阶数，b0,b1,…,bn和a1,…,an是滤波器的系数。进一步地，所述对脑电信号数据进行基线校正，对校正后的脑电信号数据进行带通滤波的步骤还包括：对于连续时间的带通滤波，传递函数表示为：其中，s是Laplace变换的复变量，s1，s2，…，s2n是希望通过的频率点，z1，z2，…，z2n是需要阻止的频率点，K是增益系数。进一步地，所述采用反向传播算法，通过最小化损失函数，不断调整GRU网络的权重和偏差；GRU网络捕捉预处理后的信号的时序关系，再与近似熵融合；在GRU网络的输出基础上，对K-Means聚类算法进行训练，对训练集中的数据进行分类的步骤中，所述GRU网络通过门控单元捕捉脑电信号中的时序关系包括以下步骤：初始化一个状态向量为隐藏状态；具体地，处理序列数据之前，GRU需要初始化一个状态向量，通常称为隐藏状态。这个隐藏状态可以看作是模型对先前信息的记忆。对于输入序列中的每个时间步，接收当前时间步的输入数据和前一个时间步的隐藏状态，计算当前时间步的候选隐藏状态；从前一个时间步的隐藏状态中保留信息并输出，其输出范围在0到1之间；具体地，0表示完全忽略前一个时间步的隐藏状态，1表示完全保留；忽略部分来自前一个时间步的隐藏状态的信息并输出，其输出范围在0到1之间；计算当前时间步的候选隐藏状态；将当前时间步的候选隐藏状态与前一个时间步的隐藏状态整合，得到最终的当前时间步的隐藏状态；重复上述步骤，处理整个输入序列。在每个时间步，都会更新隐藏状态，以捕捉序列中的时序关系。可以理解地，GRU引入了两个重要的门控单元，即更新门和重置门，更新门：决定要从前一个时间步的隐藏状态中保留多少信息。其输出范围在0到1之间，0表示完全忽略前一个时间步的隐藏状态，1表示完全保留。重置门：决定要忽略多少来自前一个时间步的隐藏状态的信息。与更新门类似，其输出范围在0到1之间。计算候选隐藏状态：使用更新门和重置门的输出，计算当前时间步的候选隐藏状态。候选隐藏状态将包含当前输入和前一个时间步的隐藏状态的信息。整合信息：将当前时间步的候选隐藏状态与前一个时间步的隐藏状态整合，得到最终的当前时间步的隐藏状态。这个隐藏状态包含了模型对序列中过去信息的理解，以及对当前输入的响应。迭代：重复上述步骤，处理整个输入序列。在每个时间步，都会更新隐藏状态，以捕捉序列中的时序关系。具体地，K-Means聚类器训练：在GRU网络的输出基础上，对K-Means聚类算法进行训练。通过利用训练集中的样本，计算输入样本与其最近邻样本之间的距离，并选择多数类别进行分类。K-Means聚类器的训练有助于细致地区分不同的意识状态。在K-Means中，簇的数量决定了数据将被划分成的簇的个数。因此，进行三分类，可以将K设置为3。具体步骤如下：1、选择K值：设置K值为3。2、初始化簇中心：随机选择三个数据点作为初始的簇中心。3、分配数据点：计算每个数据点到三个簇中心的距离，并将其分配到距离最近的簇。4、更新簇中心：对每个簇，计算其中所有数据点的平均值，并将该平均值作为新的簇中心。5、重复步骤3和步骤4：重复进行数据点的分配和簇中心的更新，直到簇中心不再发生显著变化或者达到预定的迭代次数。6、得到分类结果：最终，每个数据点被分配到了三个簇中的其中一个，从而实现了三分类。在整个训练过程中，综合考虑GRU网络和K-Means聚类器的优化，确保两者在时序关系学习和特征分类上的协同作用。通过反复迭代，网络逐渐学习到脑电信号中不同意识状态的时序特征，提高了分类的准确性和鲁棒性。这一综合训练过程使得网络能够更好地适应脑电信号的复杂时序模式，为意识状态的准确检测提供了可靠的基础。通过将深度学习和机器学习方法相互结合，我们得到了既能捕捉时序信息又能考虑样本聚类特性的网络模型，为脑电信号三分类任务提供了强大的训练和优化机制。模型的网络结构为：1.输入层：接收经过预处理的脑电信号与特征序列。2.GRU层：GRU层作为主体网络，具有内部记忆单元，通过训练过程，GRU层能够学习脑电信号在时序上的复杂关系，捕捉时序关系。3.K-Means聚类层：在GRU输出的基础上，引入K-Means聚类算法。K-Means算法通过测量输入样本与聚类中心的距离，将样本分类到最近的簇，实现对意识状态的细致分类。4.全连接层：K-Means聚类层的输出通过全连接层，将时序信息映射到最终的输出层。全连接层的节点数和输出层的节点数根据具体问题进行设计，通常采用Softmax激活函数输出概率值，表示不同意识状态的可能性。5.输出层：由于要实现三分类，输出层的节点数应设置为3。这样设计的输出层能够有效地适应使用K-Means聚类输出进行三分类的任务，最终选择具有最高概率的类别作为模型的分类结果。这样，整体网络结构中融合了GRU和K-Means，通过GRU层学习时序关系，再通过K-Means层对特征进行更精细的分类，提高了网络的综合性能。这种结构的优势在于既能有效地捕捉脑电信号中的时序信息，又能通过K-Means聚类层实现更精细的分类，从而提高了对患者意识状态的全面判定能力。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应该以权利要求的保护范围为准。
