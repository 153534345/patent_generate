标题title
一种血管造影图像增强方法
摘要abst
本发明涉及图像数据处理技术领域，具体涉及一种血管造影图像增强方法，包括：通过对血管图像中不同区域的边缘线对应的斜率进行分析，根据斜率之间的差异获取迭代特征参数，结合迭代特征参数并通过迭代形态学操作对血管图像对应的边缘图像进行处理，获得掩膜图像，利用掩膜图像提取血管图像中的血管部分。本发明通过以低计算成本下自适应核大小进行迭代形态学处理，获得更加理想的血管造影图像的增强效果。
权利要求书clms
1.一种血管造影图像增强方法，其特征在于，该方法包括以下步骤：获取血管图像；根据血管图像中像素点的灰度值和梯度值获得像素点的选取系数，根据选取系数的大小获取分割阈值，利用分割阈值对血管图像进行二值化获得血管二值图像；将血管二值图像对应的边缘图像记为血管边缘图像，根据边缘像素点之间的距离获得边缘像素点的第一距离，对第一距离进行聚类，根据聚类结果获得余像素点，构建滑动窗口对血管边缘图像进行遍历，根据滑动窗口内余像素点的第一距离的均值获得滑动窗口在遍历过程中对应位置下形态学算法的核的边长；结合滑动窗口在不同位置下形态学算法的核的边长对血管边缘图像进行形态学操作，获得第一血管边缘图像；根据第一血管边缘图像中边缘像素点的斜率差异获得病变区域顶点，获取若干个连续相邻的像素点形成的像素点组，结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代形态学操作，在形态学操作过程中，根据任意两个像素点组中边缘像素点的斜率差异获得迭代特征参数，根据迭代特征参数的大小结束迭代操作获得掩膜图像；根据掩膜图像和血管图像获取新血管图像；其中，所述根据掩膜图像和血管图像获取新血管图像，包括：将掩膜图像与血管图像相乘，获得新血管图像。2.根据权利要求1所述一种血管造影图像增强方法，其特征在于，所述根据血管图像中像素点的灰度值和梯度值获得像素点的选取系数，根据选取系数的大小获取分割阈值，包括的具体方法为：首先，获取血管图像中所有像素点的灰度值，并利用Sobel算子获取所有像素点的梯度值；然后，预设超参数和/＞，将超参数/＞与像素点的灰度值相乘获得第一选取因子，将超参数/＞与像素点的梯度值相乘获得第二选取因子；最后，将第一选取因子和第二选取因子的和值记为像素点的选取系数，将血管图像中最大选取系数所对应像素点的灰度值，作为血管图像的分割阈值。3.根据权利要求1所述一种血管造影图像增强方法，其特征在于，所述根据边缘像素点之间的距离获得边缘像素点的第一距离，包括的具体方法为：在血管边缘图像中，将任意一个边缘像素点记为目标像素点，获取过目标像素点的切线，将切线对应垂线上与目标像素点最近的边缘像素点，记为目标像素点的第一像素点，将目标像素点与第一像素点之间的距离记为目标像素点的第一距离。4.根据权利要求1所述一种血管造影图像增强方法，其特征在于，所述对第一距离进行聚类，根据聚类结果获得余像素点，包括的具体方法为：预设K-Means聚类算法的值，并利用K-Means聚类算法对所有边缘像素点的第一距离进行聚类，获得若干个聚类簇，获取任意聚类簇中所有第一距离的平均值记为聚类簇的距离参数，将所有距离参数中数值最大时对应的聚类簇删除，将删除后剩余的聚类簇中的边缘像素点记为余像素点。5.根据权利要求1所述一种血管造影图像增强方法，其特征在于，所述构建滑动窗口对血管边缘图像进行遍历，根据滑动窗口内余像素点的第一距离的均值获得滑动窗口在遍历过程中对应位置下形态学算法的核的边长，包括的具体方法为：构建大小为的滑动窗口对血管边缘图像进行遍历，其中/＞为预设的超参数，获取滑动窗口中余像素点的数量；获取滑动窗口在遍历过程中任意位置下形态学算法的核的边长，具体计算方法为：其中，表示形态学算法的核的边长，/＞表示滑动窗口内余像素点的数量；/＞表示滑动窗口内第/＞个余像素点的第一距离；/＞表示向上取整。6.根据权利要求1所述一种血管造影图像增强方法，其特征在于，所述结合滑动窗口在不同位置下形态学算法的核的边长对血管边缘图像进行形态学操作，获得第一血管边缘图像，包括的具体方法为：结合滑动窗口在不同位置下形态学算法的核的边长，对血管边缘图像进行形态学的闭运算操作，获得第一血管边缘图像。7.根据权利要求1所述一种血管造影图像增强方法，其特征在于，所述根据第一血管边缘图像中边缘像素点的斜率差异获得病变区域顶点，包括的具体方法为：对血管二值图像进行连通域检测获取血管二值图像中的若干个连通域，获取第一血管边缘图像中各边缘线中所有像素点的斜率，将任意边缘线中所有边缘像素点的斜率所形成的序列记为边缘线的斜率序列，获取斜率序列对应的后向差分序列记为边缘线的斜率差分序列，获取任意边缘线的斜率差分序列中所有元素的平均值记为平均变化斜率，将大于平均变化斜率的元素所对应的边缘像素点记为疑似病变点，获取任意疑似病变点所属连通域中所有余像素点的第一距离的平均值记为疑似病变点的参考数，当疑似病变点为余像素点且疑似病变点的第一距离小于参考数时，将疑似病变点记为病变点；将任意边缘像素点记为目标像素点，当目标像素点相邻两侧的个边缘像素点包含病变点时，将目标像素点与相邻两侧的/＞个边缘像素点所构成的集合记为像素点集合，获取像素点集合内所有边缘像素点的斜率的方差记为目标像素点的第一斜率方差，获取目标像素点所在边缘线上所有边缘像素点的斜率的方差记为目标像素点的第二斜率方差，当第一斜率方差大于第二斜率方差时，将目标像素点记为病变区域顶点，其中/＞为预设的超参数。8.根据权利要求1所述一种血管造影图像增强方法，其特征在于，所述获取若干个连续相邻的像素点形成的像素点组，结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代形态学操作，在形态学操作过程中，根据任意两个像素点组中边缘像素点的斜率差异获得迭代特征参数，包括的具体方法为：首先，将任意边缘线的所有边缘像素点的第一距离的方差记为边缘线的整体距离方差，将任意边缘线的所有边缘像素点的斜率的方差记为边缘线的整体斜率方差；将边缘线中每个连续的边缘像素点作为一组记为像素点组，根据像素点组的内边缘像素点的斜率和第一距离获得交界点，其中/＞为预设的超参数；然后，将由病变点构成的像素点组记为病变点组，将由不是病变点的边缘像素点构成的像素点组记为正常点组；结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代膨胀处理操作；迭代膨胀过程中，根据任意两个像素点组中边缘像素点的斜率，获得迭代特征参数，具体计算方法为：其中，表示迭代特征参数；/＞表示像素点组中边缘像素点的数量；/＞表示第一个像素点组中第/＞个边缘像素点的斜率，/＞表示第二个像素点组中第/＞个边缘像素点的斜率。9.根据权利要求8所述一种血管造影图像增强方法，其特征在于，所述根据像素点组的内边缘像素点的斜率和第一距离获得交界点，根据迭代特征参数的大小结束迭代操作获得掩膜图像，包括：在每次膨胀操作后，计算交界点两侧的像素点组对应的迭代特征参数，当病变点组与相邻两个正常点组对应的迭代特征参数均与两个正常点组对应的迭代特征参数的差值小于预设迭代参数阈值时，结束对第一血管边缘图像进行膨胀操作，获得掩膜图像。10.根据权利要求8所述一种血管造影图像增强方法，其特征在于，所述根据像素点组的内边缘像素点的斜率和第一距离获得交界点，具体获取方法为：将第一血管边缘图像中任意边缘线的所有边缘像素点的第一距离的方差记为边缘线的整体距离方差，将第一血管边缘图像中任意边缘线的所有边缘像素点的斜率的方差记为边缘线的整体斜率方差；将像素点组的所有边缘像素点斜率和第一距离分别对应的方差分别记为像素点组的局部斜率方差和局部距离方差，当边缘线上连续出现个像素点组的局部斜率方差和局部距离方差均小于所属边缘线的整体斜率方差和整体距离方差时，将/＞个像素点组中的第1个像素点组中所有边缘像素点的第一距离的中位数对应的边缘像素点记为交界点，其中/＞为预设的超像素。
说明书desc
技术领域本发明涉及图像数据处理技术领域，具体涉及一种血管造影图像增强方法。背景技术在临床实践中，医生通常需要人工观察医学影像中的血管壁，容易出现主观误差，因此通过结合计算机视觉技术对血管造影图像进行增强可以有效提高对血管壁识别的准确性。由于血管内壁出现病变如血栓、动脉瘤等病变时，在图像中的灰度值较小，利用传统的分割算法无法有效获取完整的血管壁，导致血管图像显示不完整，病变区域没有完整保留在血管图像中，无法得到较为理想的分割效果，以增强图像中血管壁部分，导致对血管造影图像的增强效果不佳，影响识血管壁的准确性。发明内容本发明提供一种血管造影图像增强方法，以解决现有的问题。本发明的一种血管造影图像增强方法采用如下技术方案：本发明一个实施例提供了一种血管造影图像增强方法，该方法包括以下步骤：获取血管图像；根据血管图像中像素点的灰度值和梯度值获得像素点的选取系数，根据选取系数的大小获取分割阈值，利用分割阈值对血管图像进行二值化获得血管二值图像；将血管二值图像对应的边缘图像记为血管边缘图像，根据边缘像素点之间的距离获得边缘像素点的第一距离，对第一距离进行聚类，根据聚类结果获得余像素点，构建滑动窗口对血管边缘图像进行遍历，根据滑动窗口内余像素点的第一距离的均值获得滑动窗口在遍历过程中对应位置下形态学算法的核的边长；结合滑动窗口在不同位置下形态学算法的核的边长对血管边缘图像进行形态学操作，获得第一血管边缘图像；根据第一血管边缘图像中边缘像素点的斜率差异获得病变区域顶点，获取若干个连续相邻的像素点形成的像素点组，结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代形态学操作，在形态学操作过程中，根据任意两个像素点组中边缘像素点的斜率差异获得迭代特征参数，根据迭代特征参数的大小结束迭代操作获得掩膜图像；根据掩膜图像和血管图像获取新血管图像。进一步地，所述根据血管图像中像素点的灰度值和梯度值获得像素点的选取系数，根据选取系数的大小获取分割阈值，包括的具体方法为：首先，获取血管图像中所有像素点的灰度值，并利用Sobel算子获取所有像素点的梯度值；然后，预设超参数和/＞，将超参数/＞与像素点的灰度值相乘获得第一选取因子，将超参数/＞与像素点的梯度值相乘获得第二选取因子；最后，将第一选取因子和第二选取因子的和值记为像素点的选取系数，将血管图像中最大选取系数所对应像素点的灰度值，作为血管图像的分割阈值。进一步地，所述根据边缘像素点之间的距离获得边缘像素点的第一距离，包括的具体方法为：在血管边缘图像中，将任意一个边缘像素点记为目标像素点，获取过目标像素点的切线，将切线对应垂线上与目标像素点最近的边缘像素点，记为目标像素点的第一像素点，将目标像素点与第一像素点之间的距离记为目标像素点的第一距离。进一步地，所述对第一距离进行聚类，根据聚类结果获得余像素点，包括的具体方法为：预设K-Means聚类算法的值，并利用K-Means聚类算法对所有边缘像素点的第一距离进行聚类，获得若干个聚类簇，获取任意聚类簇中所有第一距离的平均值记为聚类簇的距离参数，将所有距离参数中数值最大时对应的聚类簇删除，将删除后剩余的聚类簇中的边缘像素点记为余像素点。进一步地，所述构建滑动窗口对血管边缘图像进行遍历，根据滑动窗口内余像素点的第一距离的均值获得滑动窗口在遍历过程中对应位置下形态学算法的核的边长，包括的具体方法为：构建大小为的滑动窗口对血管边缘图像进行遍历，其中/＞为预设的超参数，获取滑动窗口中余像素点的数量；获取滑动窗口在遍历过程中任意位置下形态学算法的核的边长，具体计算方法为：其中，表示形态学算法的核的边长，/＞表示滑动窗口内余像素点的数量；/＞表示滑动窗口内第/＞个余像素点的第一距离；/＞表示向上取整。进一步地，所述结合滑动窗口在不同位置下形态学算法的核的边长对血管边缘图像进行形态学操作，获得第一血管边缘图像，包括的具体方法为：结合滑动窗口在不同位置下形态学算法的核的边长，对血管边缘图像进行形态学的闭运算操作，获得第一血管边缘图像。进一步地，所述根据第一血管边缘图像中边缘像素点的斜率差异获得病变区域顶点，包括的具体方法为：对血管二值图像进行连通域检测获取血管二值图像中的若干个连通域，获取第一血管边缘图像中各边缘线中所有像素点的斜率，将任意边缘线中所有边缘像素点的斜率所形成的序列记为边缘线的斜率序列，获取斜率序列对应的后向差分序列记为边缘线的斜率差分序列，获取任意边缘线的斜率差分序列中所有元素的平均值记为平均变化斜率，将大于平均变化斜率的元素所对应的边缘像素点记为疑似病变点，获取任意疑似病变点所属连通域中所有余像素点的第一距离的平均值记为疑似病变点的参考数，当疑似病变点为余像素点且疑似病变点的第一距离小于参考数时，将疑似病变点记为病变点；将任意边缘像素点记为目标像素点，当目标像素点相邻两侧的个边缘像素点包含病变点时，将目标像素点与相邻两侧的/＞个边缘像素点所构成的集合记为像素点集合，获取像素点集合内所有边缘像素点的斜率的方差记为目标像素点的第一斜率方差，获取目标像素点所在边缘线上所有边缘像素点的斜率的方差记为目标像素点的第二斜率方差，当第一斜率方差大于第二斜率方差时，将目标像素点记为病变区域顶点，其中/＞为预设的超参数。进一步地，所述获取若干个连续相邻的像素点形成的像素点组，结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代形态学操作，在形态学操作过程中，根据任意两个像素点组中边缘像素点的斜率差异获得迭代特征参数，根据迭代特征参数的大小结束迭代操作获得掩膜图像，包括的具体方法为：首先，将任意边缘线的所有边缘像素点的第一距离的方差记为边缘线的整体距离方差，将任意边缘线的所有边缘像素点的斜率的方差记为边缘线的整体斜率方差；将边缘线中每个连续的边缘像素点作为一组记为像素点组，根据像素点组的内边缘像素点的斜率和第一距离获得交界点，其中/＞为预设的超参数；然后，将由病变点构成的像素点组记为病变点组，将由不是病变点的边缘像素点构成的像素点组记为正常点组；结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代膨胀处理操作；迭代膨胀过程中，根据任意两个像素点组中边缘像素点的斜率，获得迭代特征参数，具体计算方法为：其中，表示迭代特征参数；/＞表示像素点组中边缘像素点的数量；/＞表示第一个像素点组中第/＞个边缘像素点的斜率，/＞表示第二个像素点组中第/＞个边缘像素点的斜率；最后，每次膨胀操作后，计算交界点两侧的像素点组对应的迭代特征参数，当病变点组与相邻两个正常点组对应的迭代特征参数均与两个正常点组对应的迭代特征参数的差值小于预设迭代参数阈值时，结束对第一血管边缘图像进行膨胀操作，获得掩膜图像。进一步地，所述根据像素点组的内边缘像素点的斜率和第一距离获得交界点，具体获取方法为：将第一血管边缘图像中任意边缘线的所有边缘像素点的第一距离的方差记为边缘线的整体距离方差，将第一血管边缘图像中任意边缘线的所有边缘像素点的斜率的方差记为边缘线的整体斜率方差；将像素点组的所有边缘像素点斜率和第一距离分别对应的方差分别记为像素点组的局部斜率方差和局部距离方差，当边缘线上连续出现个像素点组的局部斜率方差和局部距离方差均小于所属边缘线的整体斜率方差和整体距离方差时，将个像素点组中的第1个像素点组中所有边缘像素点的第一距离的中位数对应的边缘像素点记为交界点，其中/＞为预设的超像素。进一步地，所述根据掩膜图像和血管图像获取新血管图像，包括的具体方法为：将掩膜图像与血管图像相乘，获得新血管图像。本发明的技术方案的有益效果是：通过对血管图像中不同区域的边缘线对应的斜率分布情况的差异进行分析，获取在形态学处理过程中的迭代特征参数，结合迭代特征参数并通过迭代形态学操作对第一血管边缘图像进行处理，提高了对第一血管边缘图像的形态学处理效果，使第一血管边缘图像中的边缘线更加完整，避免边缘信息缺失，进一步提高了对血管图像的增强效果，通过形态学迭代处理实现了对血管图像以较低计算成本下的动态分割，并获得更加理想的分割效果。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一种血管造影图像增强方法的步骤流程图；图2为本发明一种血管造影图像增强方法的血管图像；图3为本发明一种血管造影图像增强方法的血管二值图像。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种血管造影图像增强方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种血管造影图像增强方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种血管造影图像增强方法的步骤流程图，该方法包括以下步骤：步骤S001：获取血管图像。具体的，为了实现本实施例提出的一种血管造影图像增强方法，首先需要采集血管图像，具体过程为：首先，获取血管的MRI图像，记为原始血管图像。然后，对原始血管图像进行灰度化处理，使原始血管图像中像素点的灰度值分布于区间内。需要说明的是，由于成像机器型号不同，获取的图像类型也存在一定的差异，为了方便后续处理，故本实施例对原始血管图像进行灰度化处理。最后，利用保边滤波算法对灰度化后的原始血管图像进行降噪处理，获得血管图像，如图2所示。至此，通过上述方法得到血管图像。步骤S002：根据血管图像中像素点的灰度值和梯度值获得像素点的选取系数，根据选取系数的大小获取分割阈值，利用分割阈值对血管图像进行二值化获得血管二值图像。需要说明的是，在血管图像中可能会出现由于病变引起的阴影或黑块，导致血管图像中的血管部分显示不完整，因此在通过图像分割获取血管图像中的血管部分之前，本实施例通过获取掩膜以分割出血管图像中的血管部分。另外，血管的核磁共振图像中，在不单独抑制血液信号的情况下，血管往往在图像中呈现出高亮度的特点，因此为了更好地分割血管图像，本实施例通过二值化地方法对血管区域进行一次粗分割，大致选取到血管区域，而为了使分割结果更准确，需要选取更准确的阈值。由于血管内壁可能存在部分类似血栓的灰度值较低的区域，因此本实施例通过形态学对血管图像进行处理。本实施例通过分割出一些血管周边区域，以提高形态学处理精度。由于血管的周边区域在血管图像中的亮度受到血管影响而高于其他组织的灰度，因此存在较高的梯度值，另外除了血管周边区域还可能存在一些梯度值较高的部分，因此，本实施例通过像素点的灰度和梯度值建立模型，获取最优的二值化分割阈值。具体的，首先，利用Sobel算子获取血管图像中所有像素点的梯度值。需要说明的是，由于Sobel算子为现有的边缘检测算子，因此本实施例不进行赘述。然后，根据像素点的梯度值和灰度值获得像素点的选取系数，具体计算方法为：其中，表示血管图像中第/＞个像素点的选取系数；/＞表示血管图像中第/＞个像素点的灰度值；/＞表示血管图像中第/＞个像素点的梯度值；/＞和/＞均为预设的超参数。需要说明的是，根据经验分别预设超参数为0.35，/＞为0.65，可根据实际情况进行调整，本实施例不进行具体限定。最后，将血管图像中最大选取系数所对应像素点的灰度值，作为血管图像的分割阈值，利用分割阈值对血管图像进行二值化处理获得血管二值图像，如图3所示。至此，通过上述方法得到血管图像对应的血管二值图像。步骤S003：将血管二值图像对应的边缘图像记为血管边缘图像，根据边缘像素点之间的距离获得边缘像素点的第一距离，对第一距离进行聚类，根据聚类结果获得余像素点，构建滑动窗口对血管边缘图像进行遍历，根据滑动窗口内余像素点的第一距离的均值获得滑动窗口在遍历过程中对应位置下形态学算法的核的边长；结合滑动窗口在不同位置下形态学算法的核的边长对血管边缘图像进行形态学操作，获得第一血管边缘图像；根据第一血管边缘图像中边缘像素点的斜率差异获得病变区域顶点，获取若干个连续相邻的像素点形成的像素点组，结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代形态学操作，在形态学操作过程中，根据任意两个像素点组中边缘像素点的斜率差异获得迭代特征参数，根据迭代特征参数的大小结束迭代操作获得掩膜图像。需要说明的是，为了能够尽可能完整的分割出血管图像中的血管及血管内部病变区域，本实施例通过利用形态学对血管二值图像进行形态学处理，消除血管二值图像中血管异常缺陷的部分。但是在血管二值图像中，血管的形态除了较粗的杈状血管还有还存在弯曲的细小血管，如果针对血管二值图像使用同一个大小的核进行形态学处理，无法得到理想的形态学处理效果，因此需要根据图像自适应获取形态学运算核的大小，对形态学运算进行特殊优化调整。具体的，步骤，首先，对血管二值图像进行连通域检测获取血管二值图像中的若干个连通域，并利用Canny边缘检测算法获取血管二值图像对应的边缘图像，记为血管边缘图像。需要说明的是，连通域检测和Canny边缘检测算法均为现有技术，因此本实施例中不过多赘述。然后，在血管边缘图像中，将任意一个边缘像素点记为目标像素点，获取目标像素点在血管边缘图像中所属边缘线的切线，将位于切线的垂线上且与目标像素点欧氏距离最近的边缘像素点，记为目标像素点的第一像素点，将血管边缘图像中目标像素点与第一像素点之间的欧氏距离记为第一距离。需要说明的是，如果存在边缘像素点无法直接获取对应的第一像素点，则将所述边缘像素点在所属边缘线上相邻两个边缘像素点对应第一距离的均值作为该边缘像素点对应的第一距离。需要说明的是，对于同一连通域的边缘线，边缘像素点的第一距离理论上不会出现突然显著大于其他部分的数值，但是由于存在部分血管在图像中的灰度逐渐降低导致对应的边缘线不完整，因此这部分边缘线在计算第一距离的过程中会出现误差，通常表现为同一边缘线上的部分边缘像素点的第一距离会显著高于其他部分边缘像素点的第一距离，因此本实施例对边缘像素点进行筛选。最后，预设K-Means聚类算法的K值，并利用K-Means聚类算法对所有边缘像素点的第一距离进行聚类，获得若干个聚类簇，获取任意聚类簇中所有第一距离的平均值记为聚类簇的距离参数，将最大距离参数对应的聚类簇删除，将删除后剩余的所有聚类簇中的边缘像素点记为余像素点。需要说明的是，根据经验预设K-Means聚类算法的K值为2，可根据实际进行调整，本实施例不进行具体限定；另外，由于K-Means聚类算法为现有算法，因此本实施例中不过多赘述。步骤，首先，构建大小为的滑动窗口对血管边缘图像进行遍历，其中/＞为预设的超参数，获取滑动窗口中余像素点的数量，根据余像素点的第一距离获得滑动窗口在任意位置下形态学算法的核的边长，具体计算方法为：其中，表示形态学算法的核的边长，/＞表示滑动窗口内余像素点的数量；/＞表示滑动窗口内第/＞个余像素点的第一距离；/＞表示向上取整。需要说明的是，根据经验预设超参数为3，可根据实际进行调整，本实施例不仅具体限定。需要说明的是，通过获取形态学算法在血管边缘图像中不同位置下的核的大小，避免了形态学算法的固定大小的核对图像进行形态学处理时，对图像进行了过度或不足的形态学处理，导致出现错误的处理结果，因此通过对形态学算法的核大小在图像中不同位置进行自适应调整，提高了在对不同大小的血管进行形态学处理的效果。需要说明的是，为了尽可能提高分割出血管中病变区域的概率，本实施例通过引入血管图像中像素点的灰度值和梯度模作为血管图像的分割阈值，以对血管图像进行二值化处理，而由于血管图像中的病变位置对应的灰度值较小，在二值化过程中往往无法完整分割出血管区域，因此通过对血管二值图像进行形态学算法的闭运算处理，消除血管二值图像中血管上病变位置的空缺，并平滑血管二值图像。然后，结合滑动窗口在不同位置下形态学算法的核的边长，并利用形态学算法对血管边缘图像进行闭运算处理，获得第一血管边缘图像。需要说明的是，当血管存在病变区域时，血管管壁在图像中对应的边缘往往会出现较大的斜率变化，在过渡至血管弯折或图像血管尽头处也会出现较大的斜率变化，因此本实施例根据余像素点的斜率变化情况进行分类。最后，获取第一血管边缘图像中各边缘线上所有边缘像素点的斜率，将任意边缘线中所有边缘像素点的斜率所形成的序列记为边缘线的斜率序列，获取斜率序列对应的后向差分序列记为边缘线的斜率差分序列，获取任意边缘线的斜率差分序列中所有元素的平均值记为边缘线的平均变化斜率，将边缘线的斜率差分序列中数值大于平均变化斜率的元素在第一血管边缘图像中所对应的边缘像素点记为疑似病变点，获取第一血管边缘图像中任意疑似病变点所属连通域中所有余像素点的第一距离的平均值记为疑似病变点的参考数，当疑似病变点为余像素点且疑似病变点的第一距离小于参考数时，将疑似病变点记为病变点。步骤，首先，当第一血管边缘图像中目标像素点相邻两侧的个边缘像素点中存在病变点时，将目标像素点与相邻两侧的/＞个边缘像素点所构成的集合记为像素点集合，获取像素点集合内所有边缘像素点的斜率的方差记为目标像素点的第一斜率方差，获取目标像素点所在边缘线上所有边缘像素点的斜率的方差记为目标像素点的第二斜率方差，当第一斜率方差大于第二斜率方差时，将目标像素点记为病变区域顶点，当边缘线上任意两个病变区域顶点之间的所有边缘像素点都是病变点时，将所述边缘线记为病变区域，其中/＞为预设的超参数。需要说明的是，根据经验预设超参数为20，可根据实际情况进行调整，本实施例不进行具体限定。需要说明的是，获取病变区域顶点后，可根据斜率及第一距离大致确定病变区域，确定病变区域后，为了获取完整的血管掩膜图像，可以根据血管对称位置判断填充完整度，并获取血管的完整二值图像。需要说明的是，所述病变区域为边缘线。另外，利用上步骤中获取到的病变区域顶点，遍历顶点两侧相邻像素点。如果仍是病变区域的肿块，那么像素点的斜率和第一距离与正常血管位置相比应该较大；当遍历至正常血管处时，其斜率和第一距离会达到相对稳定的区间。然后，将第一血管边缘图像中任意边缘线的所有边缘像素点的第一距离的方差记为边缘线的整体距离方差，将第一血管边缘图像中任意边缘线的所有边缘像素点的斜率的方差记为边缘线的整体斜率方差；将第一血管边缘图像中任意边缘线内每个连续的边缘像素点作为一组记为像素点组，将像素点组的所有边缘像素点斜率和第一距离分别对应的方差分别记为像素点组的局部斜率方差和局部距离方差，当边缘线上连续出现/＞个像素点组的局部斜率方差和局部距离方差均小于所属边缘线的整体斜率方差和整体距离方差时，将/＞个像素点组中的第1个像素点组中所有边缘像素点的第一距离的中位数对应的边缘像素点记为交界点，其中/＞和/＞均为预设的超像素。需要说明的是，交界点两侧的像素点组，一个由病变点构成，一个由不是病变点的边缘像素点构成。需要说明的是，根据经验预设超像素和/＞分别为5和3，可根据实际情况进行调整，本实施例不进行具体限定。最后，将含有病变点的像素点组记为病变点组，将不含有病变点的像素点组记为正常点组，边缘线上一个交接点相邻两侧的像素点组分别为病变点组合正常点组；结合病变区域顶点所在滑动窗口在对应位置下形态学算法的核的边长，利用形态学算法对第一血管边缘图像中的边缘线进行迭代膨胀处理，迭代膨胀过程中，根据任意交界点相邻两侧像素点组中边缘像素点的斜率，获得任意交界点相邻两侧像素点组之间的迭代特征参数，具体计算方法为：其中，表示交界点相邻两侧像素点组之间的迭代特征参数；/＞表示像素点组中边缘像素点的数量；/＞表示第1个像素点组中第/＞个边缘像素点的斜率，/＞表示第2个像素点组中第/＞个边缘像素点的斜率；/＞表示sigmoid归一化函数。进一步地，迭代膨胀处理过程中，每次膨胀操作后获取交界点相邻两侧像素点组之间的迭代特征参数，将与交界点一侧的正常点组相邻的正常点组记为交界点的新正常点组，将交界点一侧的正常点组与交界点的新正常点组之间的迭代特征参数记为交界点的新迭代特征参数，当所有交界点相邻两侧像素点组之间的迭代特征参数与交界点的新迭代特征参数的差值绝对值小于预设的迭代参数阈值时，停止对第一血管边缘图像进行膨胀操作，获得掩膜图像。需要说明的是，根据经验预设迭代参数阈值为0.2，可根据实际情况进行调整，本实施例进行具体限定。需要说明的是，由于血管图像二值分割后不一定仍是平滑的，因此还需要与最近的两处同长度的相邻血管区域进行对比，计算填充完整概率，获取最佳迭代次数，并最终得到完整填充的掩膜图像。至此，通过上述方法得到掩膜图像。步骤S004：根据掩膜图像和血管图像获取新血管图像。具体的，将掩膜图像与血管图像相乘，获得新血管图像。本实施例通过获取可以自适应的二值化分割的阈值，并通过自适应优化形态学算法的核的大小，进一步通过形态学对图像进行处理获取掩膜图像，最终结合掩膜图像对原始血管图像进行分割，提取出更加完整的血管图像，即新血管图像。至此，本实施例完成。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
