标题title
一种基于拟态结构动态防御的模型训练方法及装置
摘要abst
本说明书公开了一种基于拟态结构动态防御的模型训练方法及装置。所述任务执行方法包括：获取预训练模型，将训练预训练模型所使用的第一图像输入到预训练模型中，得到第一图像对应的识别结果。根据第一图像对应的识别结果以及第一图像对应的实际标签，确定出第二图像。将第二图像输入到预训练模型中，以通过预训练模型中的权重网络层，确定预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对第二图像进行识别，得到各识别结果，并根据确定出的各子识别网络对应的权重，对各识别结果进行加权，得到最终识别结果，以最小化最终识别结果与实际标签之间的偏差为优化目标，对预训练模型进行训练。
权利要求书clms
1.一种基于拟态结构动态防御的模型训练方法，其特征在于，包括：获取预训练模型；将训练所述预训练模型所使用的第一图像输入到所述预训练模型中，得到所述第一图像对应的识别结果；根据所述第一图像对应的识别结果以及所述第一图像对应的实际标签，确定所述第一图像对应的梯度信息；根据所述梯度信息对应梯度方向的反向梯度方向，生成干扰数据；将所述干扰数据加入到所述第一图像中，得到第二图像；将所述第二图像输入到所述预训练模型中，以通过所述预训练模型中的权重网络层，确定所述预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对所述第二图像进行识别，得到各识别结果，并根据确定出的所述各子识别网络对应的权重，对所述各识别结果进行加权，得到最终识别结果；以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练。2.如权利要求1所述的方法，其特征在于，所述各子识别网络中包含有第一子识别网络以及第二子识别网络，所述第一子识别网络用于通过学习到的针对第一图像进行识别的识别规则，对输入到第一子识别网络中的图像进行识别，所述第二子识别网络用于通过学习到的针对第二图像进行识别的识别规则，对输入到第二子识别网络中的图像进行识别；以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练，具体包括：固定所述预训练模型中所述第一子识别网络的网络参数，并以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述第二子识别网络中的网络参数以及所述权重网络层中的网络参数进行调整。3.如权利要求1所述的方法，其特征在于，所述方法还包括：当监测到获取与训练所述预训练模型所使用的图像数据的类型不符的图像数据时，生成若干新的子识别网络，并将所述新的子识别网络部署到所述预训练模型中，并根据所述新的子识别网络，对所述权重网络层进行维度扩展，得到更新后的预训练模型；将获取到与训练所述预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据作为扩充后图像数据输入到所述更新后的预训练模型中，以通过所述更新后的预训练模型中的权重网络层，确定原始的各子识别网络对应的权重和各新的子识别网络对应的权重，以及通过原始的每个子识别网络和每个新的子识别网络，分别对所述扩充后图像数据进行识别，得到各识别结果，并根据确定出的原始的各子识别网络对应的权重和所述各新的子识别网络对应的权重，对所述各识别结果进行加权，得到所述扩充后图像数据对应的识别结果；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练。4.如权利要求3所述的方法，其特征在于，以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练，具体包括：固定所述预训练模型中原始的各子识别网络的网络参数以及所述权重网络层中针对原始的各子识别网络的维度所对应的网络参数；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述各新的子识别网络中的网络参数以及所述权重网络层中针对所述各新的子识别网络的扩展维度对应的网络参数进行调整。5.如权利要求3所述的方法，其特征在于，以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练，具体包括：针对第N轮次的训练，根据在第N轮次训练中得到的所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差，得到第一损失值；针对每个原始的子识别网络，根据训练前所述预训练模型中原始的该子识别网络针对所述扩充后图像数据所得到的识别结果，与经过第N-1轮次训练后所述预训练模型中原始的该子识别网络针对所述扩充后图像数据所得到的识别结果之间的偏差，确定原始的该子识别网络所对应的第二损失值；根据所述第一损失值和所述第二损失值，得到总损失值，以通过最小化所述总损失值为优化目标，对所述预训练模型进行第N轮次的训练。6.一种基于拟态结构动态防御的模型训练装置，其特征在于，包括：获取模块，用于获取预训练模型；生成模块，用于将训练所述预训练模型所使用的第一图像输入到所述预训练模型中，得到所述第一图像对应的识别结果；根据所述第一图像对应的识别结果以及所述第一图像对应的实际标签，确定所述第一图像对应的梯度信息；根据所述梯度信息对应梯度方向的反向梯度方向，生成干扰数据；将所述干扰数据加入到所述第一图像中，得到第二图像；加权模块，用于将所述第二图像输入到所述预训练模型中，以通过所述预训练模型中的权重网络层，确定所述预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对所述第二图像进行识别，得到各识别结果，并根据确定出的所述各子识别网络对应的权重，对所述各识别结果进行加权，得到最终识别结果；训练模块，用于以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练。7.如权利要求6所述的装置，其特征在于，所述各子识别网络中包含有第一子识别网络以及第二子识别网络，所述第一子识别网络用于通过学习到的针对第一图像进行识别的识别规则，对输入到第一子识别网络中的图像进行识别，所述第二子识别网络用于通过学习到的针对第二图像进行识别的识别规则，对输入到第二子识别网络中的图像进行识别；所述训练模块具体用于，固定所述预训练模型中所述第一子识别网络的网络参数，并以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述第二子识别网络中的网络参数以及所述权重网络层中的网络参数进行调整。8.如权利要求6所述的装置，其特征在于，所述训练模块还用于，当监测到获取与训练所述预训练模型所使用的图像数据的类型不符的图像数据时，生成若干新的子识别网络，并将所述新的子识别网络部署到所述预训练模型中，并根据所述新的子识别网络，对所述权重网络层进行维度扩展，得到更新后的预训练模型；将获取到与训练所述预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据作为扩充后图像数据输入到所述更新后的预训练模型中，以通过所述更新后的预训练模型中的权重网络层，确定原始的各子识别网络对应的权重和各新的子识别网络对应的权重，以及通过原始的每个子识别网络和每个新的子识别网络，分别对所述扩充后图像数据进行识别，得到各识别结果，并根据确定出的原始的各子识别网络对应的权重和所述各新的子识别网络对应的权重，对所述各识别结果进行加权，得到所述扩充后图像数据对应的识别结果；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练。9.一种计算机可读存储介质，其特征在于，所述存储介质存储有计算机程序，所述计算机程序被处理器执行时实现上述权利要求1~5任一项所述的方法。10.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现上述权利要求1~5任一项所述的方法。
说明书desc
技术领域本说明书涉及人工智能领域，尤其涉及一种基于拟态结构动态防御的模型训练方法及装置。背景技术随着人工智能的快速发展，深度学习在图像识别、自然语言处理、语音识别等多个领域都取得了显著的成就。然而，神经网络模型在噪声、扰动、对抗性攻击等复杂环境中的表现往往不稳定，缺乏鲁棒性。目前，当使用神经网络模型对图片进行识别时，其中输入到神经网络模型中的图片样本可能包括对抗性样本，神经网络模型在面对对抗性样本进行识别时，输出的结果准确率可能会降低，并且随着时间推移，对抗性样本的种类不断增加，当前的训练方法不足以得到准确性较高的神经网络模型。基于此，如何提高神经网络模型训练的准确性，则是一个亟待解决的问题。发明内容本说明书提供一种基于拟态结构动态防御的模型训练方法及装置，以部分的解决现有技术存在的上述问题。本说明书采用下述技术方案：本说明书提供了一种基于拟态结构动态防御的模型训练方法，包括：获取预训练模型；将训练所述预训练模型所使用的第一图像输入到所述预训练模型中，得到所述第一图像对应的识别结果；根据所述第一图像对应的识别结果以及所述第一图像对应的实际标签，确定所述第一图像对应的梯度信息；根据所述梯度信息对应梯度方向的反向梯度方向，生成干扰数据；将所述干扰数据加入到所述第一图像中，得到第二图像；将所述第二图像输入到所述预训练模型中，以通过所述预训练模型中的权重网络层，确定所述预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对所述第二图像进行识别，得到各识别结果，并根据确定出的所述各子识别网络对应的权重，对所述各识别结果进行加权，得到最终识别结果；以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练。可选地，所述各子识别网络中包含有第一子识别网络以及第二子识别网络，所述第一子识别网络用于通过学习到的针对第一图像进行识别的识别规则，对输入到第一子识别网络中的图像进行识别，所述第二子识别网络用于通过学习到的针对第二图像进行识别的识别规则，对输入到第二子识别网络中的图像进行识别；以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练，具体包括：固定所述预训练模型中所述第一子识别网络的网络参数，并以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述第二子识别网络中的网络参数以及所述权重网络层中的网络参数进行调整。可选地，所述方法还包括：当监测到获取与训练所述预训练模型所使用的图像数据的类型不符的图像数据时，生成若干新的子识别网络，并将所述新的子识别网络部署到所述预训练模型中，并根据所述新的子识别网络，对所述权重网络层进行维度扩展，得到更新后的预训练模型；将获取到与训练所述预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据作为扩充后图像数据输入到所述更新后的预训练模型中，以通过所述更新后的预训练模型中的权重网络层，确定原始的各子识别网络对应的权重和各新的子识别网络对应的权重，以及通过原始的每个子识别网络和每个新的子识别网络，分别对所述扩充后图像数据进行识别，得到各识别结果，并根据确定出的原始的各子识别网络对应的权重和所述各新的子识别网络对应的权重，对所述各识别结果进行加权，得到所述扩充后图像数据对应的识别结果；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练。可选地，以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练，具体包括：固定所述预训练模型中原始的各子识别网络的网络参数以及所述权重网络层中针对原始的各子识别网络的维度所对应的网络参数；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述各新的子识别网络中的网络参数以及所述权重网络层中针对所述各新的子识别网络的扩展维度对应的网络参数进行调整。可选地，以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练，具体包括，具体包括：针对第N轮次的训练，根据在第N轮次训练中得到的所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差，得到第一损失值；针对每个原始的子识别网络，根据训练前所述预训练模型中原始的该子识别网络针对所述扩充后图像数据所得到的识别结果，与经过第N-1轮次训练后所述预训练模型中原始的该子识别网络针对所述扩充后图像数据所得到的识别结果之间的偏差，确定原始的该子识别网络所对应的第二损失值；根据所述第一损失值和所述第二损失值，得到总损失值，以通过最小化所述总损失值为优化目标，对所述预训练模型进行第N轮次的训练。本说明书提供了一种基于拟态结构动态防御的模型训练装置，包括：获取模块，用于获取预训练模型；生成模块，用于将训练所述预训练模型所使用的第一图像输入到所述预训练模型中，得到所述第一图像对应的识别结果；根据所述第一图像对应的识别结果以及所述第一图像对应的实际标签，确定所述第一图像对应的梯度信息；根据所述梯度信息对应梯度方向的反向梯度方向，生成干扰数据；将所述干扰数据加入到所述第一图像中，得到第二图像；加权模块，用于将所述第二图像输入到所述预训练模型中，以通过所述预训练模型中的权重网络层，确定所述预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对所述第二图像进行识别，得到各识别结果，并根据确定出的所述各子识别网络对应的权重，对所述各识别结果进行加权，得到最终识别结果；训练模块，用于以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练。可选地，所述各子识别网络中包含有第一子识别网络以及第二子识别网络，所述第一子识别网络用于通过学习到的针对第一图像进行识别的识别规则，对输入到第一子识别网络中的图像进行识别，所述第二子识别网络用于通过学习到的针对第二图像进行识别的识别规则，对输入到第二子识别网络中的图像进行识别；所述训练模块具体用于，固定所述预训练模型中所述第一子识别网络的网络参数，并以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述第二子识别网络中的网络参数以及所述权重网络层中的网络参数进行调整。可选地，所述训练模块还用于，当监测到获取与训练所述预训练模型所使用的图像数据的类型不符的图像数据时，生成若干新的子识别网络，并将所述新的子识别网络部署到所述预训练模型中，并根据所述新的子识别网络，对所述权重网络层进行维度扩展，得到更新后的预训练模型；将获取到与训练所述预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据作为扩充后图像数据输入到所述更新后的预训练模型中，以通过所述更新后的预训练模型中的权重网络层，确定原始的各子识别网络对应的权重和各新的子识别网络对应的权重，以及通过原始的每个子识别网络和每个新的子识别网络，分别对所述扩充后图像数据进行识别，得到各识别结果，并根据确定出的原始的各子识别网络对应的权重和所述各新的子识别网络对应的权重，对所述各识别结果进行加权，得到所述扩充后图像数据对应的识别结果；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练。本说明书提供了一种计算机可读存储介质，所述存储介质存储有计算机程序，所述计算机程序被处理器执行时实现上述基于拟态结构动态防御的模型训练方法。本说明书提供了一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现上述基于拟态结构动态防御的模型训练方法。本说明书采用的上述至少一个技术方案能够达到以下有益效果：在本说明书提供的基于拟态结构动态防御的模型训练方法中，获取预训练模型，将训练预训练模型所使用的第一图像输入到预训练模型中，得到第一图像对应的识别结果。根据第一图像对应的识别结果以及第一图像对应的实际标签，确定出第二图像。将第二图像输入到预训练模型中，以通过预训练模型中的权重网络层，确定预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对第二图像进行识别，得到各识别结果，并根据确定出的各子识别网络对应的权重，对各识别结果进行加权，得到最终识别结果，以最小化最终识别结果与实际标签之间的偏差为优化目标，对预训练模型进行训练。从上述方法可以看出，在本说明书提供的基于拟态结构动态防御的模型训练方法中，预训练模型中有多个子识别网络，每个子识别网络会针对输入的图像数据给出不同的识别结果，并且权重网络层会根据图像数据的样本特性，确定出哪个子识别模型输出的识别结果更具有说服力，从而得到更准确的针对输入到预训练模型中的图像数据的识别结果。在实际应用中，随着时间推移，输入到预训练模型中的对抗性样本的种类不断增加，而本说明书中随着大量的样本输入到模型中，模型会根据输入的样本生成若干新的子识别网络，通过不断添加子识别网络，并对预训练模型进行训练，进而使得训练之后的预训练模型在风险识别领域防御性更强。附图说明此处所说明的附图用来提供对本说明书的进一步理解，构成本说明书的一部分，本说明书的示意性实施例及其说明用于解释本说明书，并不构成对本说明书的不当限定。在附图中：图1为本说明书中提供的一种基于拟态结构动态防御的模型训练方法的流程示意图；图2为本说明书提供的一种预训练模型的训练过程示意图；图3为本说明书提供的一种预训练模型的训练过程示意图；图4为本说明书提供的一种基于拟态结构动态防御的模型训练装置的示意图；图5为本说明书提供的一种对应于图1的电子设备示意图。具体实施方式为使本说明书的目的、技术方案和优点更加清楚，下面将结合本说明书具体实施例及相应的附图对本说明书技术方案进行清楚、完整地描述。显然，所描述的实施例仅是本说明书一部分实施例，而不是全部的实施例。基于本说明书中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本说明书保护的范围。以下结合附图，详细说明本说明书各实施例提供的技术方案。图1为本说明书中提供的一种基于拟态结构动态防御的模型训练方法的流程示意图，包括以下步骤：S101：获取预训练模型。深度学习作为人工智能领域的一个重要分支，已经在图像识别、自然语言处理、语音识别等多个方面取得了显著的成就。当前，使用神经网络模型对图像进行识别时，在噪声、扰动、对抗性攻击等复杂环境中的表现往往不稳定，缺乏鲁棒性。尤其是当出现对抗性样本时，神经网络模型不能准确识别图像。其中，对抗性样本是指在机器学习模型中，通过向输入数据添加精心设计的扰动或干扰，使模型对对抗性样本的判断产生错误的一种特殊样本。这些样本通常在训练数据的基础上进行微小的修改，以使修改后的样本在模型中产生预期的错误判断。对抗性样本的存在可能会对机器学习模型的性能产生严重影响，导致模型在某些情况下无法正确地分类或识别数据。因此，在对抗性攻击下，模型的准确性和稳定性可能会受到严重影响。对抗性样本的制造通常需要具备一定的技巧和知识，以便正确地设计和制造出能够欺骗模型的扰动或干扰。制造对抗性样本的方法包括但不限于添加噪声、改变图像的颜色或亮度、修改文本的语法或语义等。另外，随着时间推移，越来越多的对抗性样本出现，其种类变化无穷，使用传统的训练手段训练神经网络模型时，可能会使神经网络模型产生灾难性遗忘问题，从而造成得到的图像识别结果不准确。基于此，本说明书提供了一种基于拟态结构动态防御的模型训练方法，获取预训练模型，将训练预训练模型所使用的第一图像输入到预训练模型中，得到第一图像对应的识别结果。根据第一图像对应的识别结果以及第一图像对应的实际标签，确定出第一图像对应的梯度信息，并根据梯度信息对应梯度方向的反向梯度方向，生成干扰数据，然后，将干扰数据加入到第一图像中，得到第二图像。将第二图像输入到预训练模型中，以通过预训练模型中的权重网络层，确定预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对第二图像进行识别，得到各识别结果，并根据确定出的各子识别网络对应的权重，对各识别结果进行加权，得到最终识别结果，以最小化最终识别结果与实际标签之间的偏差为优化目标，对预训练模型进行训练。这种训练方式可以提高神经网络模型的鲁棒性，在面对对抗性样本时，也能使神经网络模型更加安全可靠，相较于传统的训练方式，提高了神经网络模型的准确性，以得到更加接近真实标签的识别结果。在本说明书中，用于实现一种基于拟态结构动态防御的模型训练方法的执行主体可以是诸如笔记本电脑、平板电脑等终端设备，当然，也可以是服务器，为了便于描述，本说明书仅以服务器作为执行主体为例，对本说明书中提供的一种基于拟态结构动态防御的模型训练方法进行说明。在本说明书中，服务器首先获取预训练模型，这里的预训练模型包括权重网络层以及一个或多个子识别网络，其中，权重网络层是针对每一个子识别网络给出相应的权重，子识别网络是针对输入的图像数据分别给出识别结果。S102：将训练所述预训练模型所使用的第一图像输入到所述预训练模型中，得到所述第一图像对应的识别结果。服务器可以将第一图像输入到预训练模型中第一图像对应的子识别网络中，以对预训练模型中第一图像对应的子识别网络进行训练，其中，第一图像可以有多种，例如，普通图像数据、困难图像数据。其中，普通图像是指清晰度较高的正常图像，困难图像包含的情况有多种，例如，图像模糊、图像主体残缺、图像主体不明、图像倾斜翻转等。困难图像数据可以由普通图像数据经过算法造成损坏后生成，例如，对图像进行噪声处理，如高斯噪声、散粒噪声、脉冲噪声等；对图像进行模糊处理，如散焦模糊、磨砂玻璃模糊、运动模糊、变焦模糊等；在图像中增加天气因素，如雪、霜、雾等；对图像的数码类别进行调整，如亮度、对比度、塑性、像素化、JPEG。进一步地，将第一图像输入到预训练模型中，得到第一图像对应的识别结果。S103：根据所述第一图像对应的识别结果以及所述第一图像对应的实际标签，确定所述第一图像对应的梯度信息。服务器将第一图像输入到预训练模型中，得到第一图像对应的识别结果，再计算出损失函数，这里使用交叉熵损失计算损失值，可以表示为：其中，预训练模型的输入为，输出为对/＞的图像识别结果，记作/＞，/＞表示真实标签的第 i 个类别，/＞是预训练模型输出的图像识别结果中第 i 个类别的概率。进一步地，对损失函数关于输入的的梯度进行计算，其公式可表示为：其中，为/＞对应的梯度信息，/＞为/＞对应的识别结果，/＞是/＞对应的真实标签。S104：根据所述梯度信息对应梯度方向的反向梯度方向，生成干扰数据。在本说明书中，服务器根据梯度信息对应梯度方向的反向梯度方向，生成干扰数据，对输入的/＞生成扰动，可以用公式表示为：其中，为生成的干扰数据，/＞为扰动系数，/＞越大，扰动程度越高，/＞为符号函数，通过计算损失函数关于输入/＞的梯度信息，使用/＞符号函数将其转换为反向梯度的方向，可以生成一个指向损失增加方向的干扰数据，从而达到对抗攻击的目的。S105：将所述干扰数据加入到所述第一图像中，得到第二图像。服务器将生成的干扰数据加入到第一图像中，得到第二图像，可以用公式表示为：其中，为输入到预训练模型中的x添加扰动后的图像数据，也就是说，/＞为第一图像添加干扰数据后得到的第二图像。S106：将所述第二图像输入到所述预训练模型中，以通过所述预训练模型中的权重网络层，确定所述预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对所述第二图像进行识别，得到各识别结果，并根据确定出的所述各子识别网络对应的权重，对所述各识别结果进行加权，得到最终识别结果。预训练模型中包含有权重网络层和各子识别网络，其中，各子识别网络中包含有第一子识别网络以及第二子识别网络，第一子识别网络用于通过学习到的针对第一图像进行识别的识别规则，对输入到第一子识别网络中的图像进行识别，第二子识别网络用于通过学习到的针对第二图像进行识别的识别规则，对输入到第二子识别网络中的图像进行识别。服务器将第二图像输入到预训练模型中，此时，第二图像通过预训练模型中的权重网络层，得到预训练模型中设置的各子识别网络对应的权重。并将第二图像分别输入到预训练模型中的各子识别网络中，以通过每个子识别网络，分别对第二图像进行识别，得到各识别结果，并根据确定出的各子识别网络对应的权重，对各识别结果进行加权，得到最终识别结果。需要指出的是，对于预训练模型中的第二子识别网络，可以是完全初始化的子识别网络，后续通过在S107中提到的模型训练方式进行训练得到的。也可以是，服务器将第二图像输入到预训练模型的第二子识别网络中，对第二子识别网络进行训练，以使第二子识别网络通过学习到的针对第二图像进行识别的识别规则，可以对输入到第二子识别网络中的图像进行识别，再将训练好的第二子识别网络部署到预训练模型中，通过后续在S107中提到的模型训练方式进行进一步训练。在本说明书中，当服务器使用第一图像对第一子识别网络进行训练以及使用第二图像对第二子识别网络进行训练时，也可以在第一图像中添加少量第二图像，同样的，在第二图像中添加少量第一图像，这样可以增强每个子识别网络自身的泛化能力，减少过拟合现象。S107：以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练。在本说明书中，服务器将第二图像输入到预训练模型中，并对预训练模型进行训练时，提供有两种训练方式，一种方式是以最小化最终识别结果与实际标签之间的偏差为优化目标，对预训练模型进行训练，并更新预训练模型中权重网络层以及第一子识别网络和第二子识别网络中的参数，即，这种方式着重体现的在训练过程中，所有网络层的参数均要进行调整；另一种方式是固定预训练模型中第一子识别网络的网络参数，并以最小化最终识别结果与实际标签之间的偏差为优化目标，对第二子识别网络中的网络参数以及权重网络层中的网络参数进行调整，即，对于已经训练过的第一子识别网络的网络参数，无需调整，而只调整第二子识别网络以及权重网络层中的参数，其中，预训练模型中的第一子识别网络已经提前学习到针对第一图像的识别规则，也就是说，服务器提前使用第一图像对第一子识别网络进行单独训练，根据第一子识别网络的识别结果，对其网络参数进行调整，使其具备针对第一图像的识别能力，所以在预训练模型的训练过程中，可以固定第一子识别网络的网络参数，只对第二子识别网络中的网络参数以及权重网络层中的网络参数进行调整。另外，当服务器监测到预训练模型获取与训练预训练模型所使用的图像数据的类型不符的图像数据时，具体地，在某一段时间中，服务器监测出针对这段时间输入到预训练模型中的图像数据对应的识别结果的准确率显著降低，那么，就可以认为这段时间输入到预训练模型中的图像数据的类型与之前输入到预训练模型中的图像数据的类型不同，所以需要根据这段时间输入到预训练模型中的图像数据训练预训练模型，进一步地，服务器生成若干新的子识别网络，并将新的子识别网络部署到预训练模型中，并根据新的子识别网络，对权重网络层进行维度扩展，得到更新后的预训练模型。服务器将获取到与训练预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据作为扩充后图像数据输入到更新后的预训练模型中，也就是说，服务器获取到与训练预训练模型所使用的图像数据的类型不符的图像数据后，需要将与训练预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据融合形成一个样本集，这个样本集中的图像数据即为扩充后图像数据，将扩充后图像数据输入到更新后的预训练模型中，其中，原始图像数据可以包括第一图像和第二图像。将与训练预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据一起输入到更新后的预训练模型中，进而对预训练模型进行训练，这样的方式可以防止预训练模型中新的子识别网络产生过拟合的现象，也可以在一定程度上防止预训练模型中原始的子识别网络在更新网络参数时偏移过大。进一步地，通过更新后的预训练模型中的权重网络层，确定原始的各子识别网络对应的权重和各新的子识别网络对应的权重，以及通过原始的每个子识别网络和每个新的子识别网络，分别对扩充后图像数据进行识别，得到各识别结果，并根据确定出的原始的各子识别网络对应的权重和各新的子识别网络对应的权重，对各识别结果进行加权，得到扩充后图像数据对应的识别结果。进而服务器以最小化扩充后图像数据对应的识别结果与扩充后图像数据对应的实际标签之间的偏差为优化目标，对更新后的预训练模型进行训练。这里的预训练模型的训练方式也涉及两种，一种是以最小化扩充后图像数据对应的识别结果与扩充后图像数据对应的实际标签之间的偏差为优化目标，对更新后的预训练模型进行训练，并对预训练模型中的权重网络层的所有网络参数以及各子识别网络的网络参数进行更新，如图2所示。图2为本说明书提供的一种预训练模型的训练过程示意图。图2中有阴影的部分代表参与训练的部分，也就是说，在本说明书提供的第一种训练方式中，可以对预训练模型中的权重网络层的所有网络参数以及各子识别网络的网络参数进行更新，以得到更加融合的权重网络层和各子识别网络，从而使得预训练模型更加准确。另一种是固定预训练模型中原始的各子识别网络的网络参数以及权重网络层中针对原始的各子识别网络的维度所对应的网络参数，并以最小化扩充后图像数据对应的识别结果与扩充后图像数据对应的实际标签之间的偏差为优化目标，对各新的子识别网络中的网络参数以及权重网络层中针对各新的子识别网络的扩展维度对应的网络参数进行调整，如图3所示。图3为本说明书提供的一种预训练模型的训练过程示意图。图3中有阴影的部分代表参与训练的部分，也就是说，在本说明书提供的第二种训练方式中，参与到训练过程中的网络参数包括各新的子识别网络中的网络参数以及权重网络层中针对各新的子识别网络的扩展维度对应的网络参数，这样的方式可以减小模型的训练压力，只对预训练模型中的一部分参数进行调整，并且减少预训练模型发生灾难性遗忘的问题。在第一种训练方式中，因为是对各子识别网络中的网络参数以及权重网络层中的所有网络参数进行调整，所以为了使模型训练效果更好，服务器可以通过计算两个部分的损失函数，以得到两个损失值，从而根据这两个损失值，得到总损失值。具体地，针对第N轮次的训练，服务器根据在第N轮次训练中得到的扩充后图像数据对应的识别结果与扩充后图像数据对应的实际标签之间的偏差，得到第一损失值，具体可表示为：其中，为第一损失值，n表示子识别网络的数量，/＞表示权重网络层针对第i个子识别网络输出的权重值，其中，/＞是经过/＞函数处理后的值，从而保证/＞。/＞函数处理过程可具体表示为：进一步地，由于预训练模型中原始的子识别网络可以是已经训练过的子识别网络，为防止第N轮训练出的预训练模型与训练前的预训练模型中的网络参数偏移过远，造成灾难性遗忘的问题，进而计算第二损失值。具体地，针对每个原始的子识别网络，服务器根据训练前预训练模型中原始的该子识别网络针对扩充后图像数据所得到的识别结果，与经过第N-1轮次训练后预训练模型中原始的该子识别网络针对扩充后图像数据所得到的识别结果之间的偏差，确定原始的该子识别网络所对应的第二损失值，第二损失值具体可表示为：其中，表示训练前预训练模型中各原始的子识别网络针对扩充后图像数据所得到的识别结果，/＞表示经过第N-1轮次训练后预训练模型中各原始的子识别网络针对扩充后图像数据所得到的识别结果。具体地，JS散度的具体计算公式为：其中，M表示P，Q的平均分布，具体计算公式为：而表示KL散度，其计算公式为：进而，服务器可以通过上述公式得到第二损失值，再根据第一损失值和第二损失值，得到总损失值，具体可以表示为：其中，表示调质因子，用于控制子识别网络的遗忘比例。服务器以最小化总损失值为优化目标，对预训练模型进行第N轮次的训练。需要说明的是，服务器监测到获取到与训练预训练模型所使用的图像数据的类型不符的图像数据时，生成若干新的子识别网络，然而，当生成的新的子识别网络较多时，此时将与训练预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据作为扩充后图像数据分别输入到所有子识别网络中会造成预训练模型计算量增大的情况。因此，在子识别网络的数量较多时，针对未经过函数处理的各子识别网络的权重进行/＞采样，如果该子识别网络的权重在前k个内，则保留，否则，将该子识别网络的权重直接置为负无穷。上述公式还需要经过函数处理，对于非/＞的部分，由于该子识别网络对应的权重是负无穷，这样在经过/＞函数处理之后该子识别网络对应的权重将置为0，可以有效减少计算量。例如，在/＞采样中的/＞时，只保留子识别网络的权重值在前3内的子识别网络，服务器将扩充后图像数据分别输入到保留的3个子识别网络中，并根据这3个子识别网络对应的权重，对3个识别结果进行加权，以得到扩充后图像数据对应的识别结果。在本说明书中，通过第一图像对应的识别结果以及第一图像对应的实际标签，得到第二图像，再将第二图像输入到预训练模型中，并对预训练模型中的网络参数进行调整更新，以得到更加准确的识别结果。当服务器监测到输入预训练模型中的图像数据的类型与预训练模型所使用的图像数据的类型不符时，可以生成若干新的子识别网络，以便增加预训练模型对环境的适应性，进而针对多种图像数据，也能有很好的识别结果。并且在预训练模型的训练过程中，还提供两种训练方式，一种是对预训练模型中的权重网络层和各子识别网络的网络参数都进行调整，这种方式能够实现预训练模型中的权重网络层和各子识别网络的深度融合，以得到准确性较高的预训练模型。另一种是固定预训练模型中原始的各子识别网络的网络参数以及权重网络层中针对原始的各子识别网络的维度所对应的网络参数，只对各新的子识别网络中的网络参数以及权重网络层中针对各新的子识别网络的扩展维度对应的网络参数进行调整，这样的方式可以保留之前的训练效果，防止发生灾难性遗忘。这两种方式适应的场景不同，在实际应用中需要根据不同的情况对预训练模型进行训练，也可以根据输入的图像数据，选择正确的训练方式，以得到更加准确的预训练模型。本说明书提供的方法可以应用于多种图像识别场景中，尤其是在风险识别领域对图像进行识别，例如，在人脸识别领域，可以通过采集到的人脸图像来判断用户是否存在业务风险，本说明书提供的方法即可应用在上述领域中。通过本说明书可以看出，随着对抗性样本种类的增加，自动添加子识别网络，并通过上述的训练方式对各子识别网络和权重网络层的网络参数进行调整，使其能够得到准确的识别结果。因此，虽然随着时间的推移风险种类逐渐增加，本说明书提供的方法可以根据图像数据的样本特性对预训练模型进行训练，使得预训练模型可以学习出针对新风险的子识别网络，实现了模型动态防御的过程。为了进一步描述本说明书中提供的方法，这里提供一种预训练模型的网络结构，其中包含三个子识别网络：A、B和C，A或B可以是通过第一图像得到的第一子识别网络，C可以是通过第二图像得到的第二子识别网络。其中，A主要是用于识别普通图像数据的，B主要是用于识别困难图像数据的，C主要是用于识别对抗性图像数据的。A、B和C都能够对三种不同的图像数据进行识别，并得到相应的结果，在预训练模型的预训练过程中，分别使用普通图像数据、困难图像数据和对抗性图像数据对A、B和C进行单独训练，将训练后的A、B和C部署到预训练模型中，并在预训练模型中设置权重网络层，再对预训练模型进行训练，使得权重网络层和三个子识别网络能够学习到彼此的学习特性，以使预训练模型能够根据不同图像数据的输入，得到更加合理的识别结果。同时在权重网络层的作用下，对三个子识别网络的识别结果进行融合，使得得到的最终识别结果更加准确，实现了动态防御的过程。以上为本说明书的一个或多个实施基于拟态结构动态防御的模型训练方法，基于同样的思路，本说明书还提供了相应的基于拟态结构动态防御的模型训练装置，如图4所示。图4为本说明书提供的一种基于拟态结构动态防御的模型训练装置的示意图，包括：获取模块401，用于获取预训练模型；生成模块402，用于将训练所述预训练模型所使用的第一图像输入到所述预训练模型中，得到所述第一图像对应的识别结果；根据所述第一图像对应的识别结果以及所述第一图像对应的实际标签，确定所述第一图像对应的梯度信息；根据所述梯度信息对应梯度方向的反向梯度方向，生成干扰数据；将所述干扰数据加入到所述第一图像中，得到第二图像；加权模块403，用于将所述第二图像输入到所述预训练模型中，以通过所述预训练模型中的权重网络层，确定所述预训练模型中设置的各子识别网络对应的权重，以及通过每个子识别网络，分别对所述第二图像进行识别，得到各识别结果，并根据确定出的所述各子识别网络对应的权重，对所述各识别结果进行加权，得到最终识别结果；训练模块404，用于以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述预训练模型进行训练。可选地，所述各子识别网络中包含有第一子识别网络以及第二子识别网络，所述第一子识别网络用于通过学习到的针对第一图像进行识别的识别规则，对输入到第一子识别网络中的图像进行识别，所述第二子识别网络用于通过学习到的针对第二图像进行识别的识别规则，对输入到第二子识别网络中的图像进行识别；所述训练模块404具体用于，固定所述预训练模型中所述第一子识别网络的网络参数，并以最小化所述最终识别结果与所述实际标签之间的偏差为优化目标，对所述第二子识别网络中的网络参数以及所述权重网络层中的网络参数进行调整。可选地，所述训练模块404还用于，当监测到获取与训练所述预训练模型所使用的图像数据的类型不符的图像数据时，生成若干新的子识别网络，并将所述新的子识别网络部署到所述预训练模型中，并根据所述新的子识别网络，对所述权重网络层进行维度扩展，得到更新后的预训练模型；将获取到与训练所述预训练模型所使用的图像数据的类型不符的图像数据以及原始的图像数据作为扩充后图像数据输入到所述更新后的预训练模型中，以通过所述更新后的预训练模型中的权重网络层，确定原始的各子识别网络对应的权重和各新的子识别网络对应的权重，以及通过原始的每个子识别网络和每个新的子识别网络，分别对所述扩充后图像数据进行识别，得到各识别结果，并根据确定出的原始的各子识别网络对应的权重和所述各新的子识别网络对应的权重，对所述各识别结果进行加权，得到所述扩充后图像数据对应的识别结果；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述更新后的预训练模型进行训练。可选地，所述训练模块404具体用于，固定所述预训练模型中原始的各子识别网络的网络参数以及所述权重网络层中针对原始的各子识别网络的维度所对应的网络参数；以最小化所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差为优化目标，对所述各新的子识别网络中的网络参数以及所述权重网络层中针对所述各新的子识别网络的扩展维度对应的网络参数进行调整。可选地，所述训练模块404具体用于，针对第N轮次的训练，根据在第N轮次训练中得到的所述扩充后图像数据对应的识别结果与所述扩充后图像数据对应的实际标签之间的偏差，得到第一损失值；针对每个原始的子识别网络，根据训练前所述预训练模型中原始的该子识别网络针对所述扩充后图像数据所得到的识别结果，与经过第N-1轮次训练后所述预训练模型中原始的该子识别网络针对所述扩充后图像数据所得到的识别结果之间的偏差，确定原始的该子识别网络所对应的第二损失值；根据所述第一损失值和所述第二损失值，得到总损失值，以通过最小化所述总损失值为优化目标，对所述预训练模型进行第N轮次的训练。本说明书还提供了一种计算机可读存储介质，该存储介质存储有计算机程序，计算机程序可用于执行上述图1提供的一种基于拟态结构动态防御的模型训练方法。本说明书还提供了图5所示的一种对应于图1的电子设备的示意结构图。如图5所述，在硬件层面，该电子设备包括处理器、内部总线、网络接口、内存以及非易失性存储器，当然还可能包括其他业务所需要的硬件。处理器从非易失性存储器中读取对应的计算机程序到内存中然后运行，以实现上述图1所述的基于拟态结构动态防御的模型训练方法。当然，除了软件实现方式之外，本说明书并不排除其他实现方式，比如逻辑器件抑或软硬件结合的方式等等，也就是说以下处理流程的执行主体并不限定于各个逻辑单元，也可以是硬件或逻辑器件。对于一个技术的改进可以很明显地区分是硬件上的改进还是软件上的改进。然而，随着技术的发展，当今的很多方法流程的改进已经可以视为硬件电路结构的直接改进。设计人员几乎都通过将改进的方法流程编程到硬件电路中来得到相应的硬件电路结构。因此，不能说一个方法流程的改进就不能用硬件实体模块来实现。例如，可编程逻辑器件）就是这样一种集成电路，其逻辑功能由用户对器件编程来确定。由设计人员自行编程来把一个数字系统“集成”在一片PLD上，而不需要请芯片制造厂商来设计和制作专用的集成电路芯片。而且，如今，取代手工地制作集成电路芯片，这种编程也多半改用“逻辑编译器”软件来实现，它与程序开发撰写时所用的软件编译器相类似，而要编译之前的原始代码也得用特定的编程语言来撰写，此称之为硬件描述语言，而HDL也并非仅有一种，而是有许多种，如ABEL、AHDL、Confluence、CUPL、HDCal、JHDL、Lava、Lola、MyHDL、PALASM、RHDL等，目前最普遍使用的是VHDL与Verilog。本领域技术人员也应该清楚，只需要将方法流程用上述几种硬件描述语言稍作逻辑编程并编程到集成电路中，就可以很容易得到实现该逻辑方法流程的硬件电路。控制器可以按任何适当的方式实现，例如，控制器可以采取例如微处理器或处理器以及存储可由该处理器执行的计算机可读程序代码的计算机可读介质、逻辑门、开关、专用集成电路、可编程逻辑控制器和嵌入微控制器的形式，控制器的例子包括但不限于以下微控制器：ARC 625D、Atmel AT91SAM、Microchip PIC18F26K20 以及Silicone Labs C8051F320，存储器控制器还可以被实现为存储器的控制逻辑的一部分。本领域技术人员也知道，除了以纯计算机可读程序代码方式实现控制器以外，完全可以通过将方法步骤进行逻辑编程来使得控制器以逻辑门、开关、专用集成电路、可编程逻辑控制器和嵌入微控制器等的形式来实现相同功能。因此这种控制器可以被认为是一种硬件部件，而对其内包括的用于实现各种功能的装置也可以视为硬件部件内的结构。或者甚至，可以将用于实现各种功能的装置视为既可以是实现方法的软件模块又可以是硬件部件内的结构。上述实施例阐明的系统、装置、模块或单元，具体可以由计算机芯片或实体实现，或者由具有某种功能的产品来实现。一种典型的实现设备为计算机。具体的，计算机例如可以为个人计算机、膝上型计算机、蜂窝电话、相机电话、智能电话、个人数字助理、媒体播放器、导航设备、电子邮件设备、游戏控制台、平板计算机、可穿戴设备或者这些设备中的任何设备的组合。为了描述的方便，描述以上装置时以功能分为各种单元分别描述。当然，在实施本说明书时可以把各单元的功能在同一个或多个软件和/或硬件中实现。本领域内的技术人员应明白，本说明书的实施例可提供为方法、系统、或计算机程序产品。因此，本说明书可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本说明书可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本说明书是参照根据本说明书实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。在一个典型的配置中，计算设备包括一个或多个处理器、输入/输出接口、网络接口和内存。内存可能包括计算机可读介质中的非永久性存储器，随机存取存储器和/或非易失性内存等形式，如只读存储器或闪存。内存是计算机可读介质的示例。计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存、静态随机存取存储器、动态随机存取存储器、其他类型的随机存取存储器、只读存储器、电可擦除可编程只读存储器、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体，如调制的数据信号和载波。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。本领域技术人员应明白，本说明书的实施例可提供为方法、系统或计算机程序产品。因此，本说明书可采用完全硬件实施例、完全软件实施例或结合软件和硬件方面的实施例的形式。而且，本说明书可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本说明书可以在由计算机执行的计算机可执行指令的一般上下文中描述，例如程序模块。一般地，程序模块包括执行特定任务或实现特定抽象数据类型的例程、程序、对象、组件、数据结构等等。也可以在分布式计算环境中实践本说明书，在这些分布式计算环境中，由通过通信网络而被连接的远程处理设备来执行任务。在分布式计算环境中，程序模块可以位于包括存储设备在内的本地和远程计算机存储介质中。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于系统实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。以上所述仅为本说明书的实施例而已，并不用于限制本说明书。对于本领域技术人员来说，本说明书可以有各种更改和变化。凡在本说明书的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本说明书的权利要求范围之内。
