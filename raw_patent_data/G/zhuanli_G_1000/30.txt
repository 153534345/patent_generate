标题title
基于改进的YOLO网络的脑电图伪影检测方法
摘要abst
本发明涉及脑电信号处理技术领域，尤其涉及一种基于改进的YOLO网络的脑电图伪影检测方法，包括：S1：对原始信号进行预处理，获得待检测脑电信号；S2：建立改进的YOLO网络模型，将待检测脑电信号划分为1*s个网格，并将划分为1*s个网格的待检测脑电信号输送至训练好的改进的YOLO网络模型进行训练，获得与1*s个网格相对应的边框置信度；S3：将1*s个网格对应的边框置信度依次进行非极大值抑制，获得最终的伪影检测框。本发明通过对YOLO网络进行改进并结合MobileNet算法，以深度可分离卷积模块作为骨干网络，同时对改进的YOLO网络的输入数据、结果矩阵和损失函数进行调整，能够有效提升脑电图中伪影的检测速率和检测精度。
权利要求书clms
1.一种基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，具体包括如下步骤：S1：对原始信号进行预处理，获得待检测脑电信号；S2：建立改进的YOLO网络模型，将所述待检测脑电信号划分为1*s个网格，并将划分为1*s个网格的所述待检测脑电信号输送至训练好的改进的YOLO网络模型进行训练，获得与1*s个网格相对应的边框置信度；S3：将1*s个网格对应的边框置信度依次进行非极大值抑制，获得最终的伪影检测框。2.根据权利要求1所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，改进的YOLO网络模型包括局部特征提取模块、全局特征提取模块、n个级联的深度可分离卷积模块、3*3卷积层、归一化层、ELU激活函数和两个全连接层，其中，将划分为1*s个网格的所述待检测脑电信号依次输入至所述局部特征提取模块和所述全局特征提取模块进行单通道特征信息和多通道特征信息的提取，对应获得映射至二维空间的波形特征；所述波形特征经n个级联的深度可分离卷积模块进行卷积操作后，获得减少网络参数的第一特征图，所述第一特征图经所述3*3卷积层进行卷积操作及相应的归一化处理，并采用所述ELU激活函数进行激活操作后，再经两个级联的全连接层进行卷积操作，获得包含伪影位置和类别概率值的第二特征图。3.根据权利要求2所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，所述局部特征提取模块的卷积核为1*1*7，所述全局特征提取模块的卷积核为1*1*19。4.根据权利要求2所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，所述深度可分离卷积模块包括Depthwise卷积层、Pointwise卷积层、两个ELU激活函数和两个归一化层，其中，输入至所述深度可分离卷积模块的特征图经所述Depthwise卷积层进行卷积操作及相应的归一化处理，并采用所述ELU激活函数进行激活操作后，获得包含空间滤波信息的第三特征图；所述第三特征图经所述Pointwise卷积层进行卷积操作及相应的归一化处理，并采用所述ELU激活函数进行激活操作后，获得包含特征生成信息的第四特征图。5.根据权利要求1所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，所述步骤S2具体包括如下步骤：S21：设置每个网格均对应B个预测框，且每个预测框均对应设置第一预测值、第二预测值和第三预测值；S22：设置伪影出现在当前预测框的条件概率，并通过下式依次计算包含当前预测框的网格所对应的B个预测框的边框置信度：；；其中，为边框置信度，/＞为伪影出现在当前预测框的条件概率，为预测框与真实框的交集面积与并集面积之比，class为标注数据的类别，/＞为所述预测框的面积，/＞为所述真实框的面积，/＞为所述预测框的宽度，/＞为所述真实框的宽度，/＞为用于衡量所述预测框和所述真实框之间重叠程度的度量；S23：重复所述步骤S22，计算所有网格中的所有预测框的边框置信度。6.根据权利要求5所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，所述第一预测值为所述预测框的中心相对于网格边界的横向偏移量，所述第二预测值是所述预测框的宽度与所述待检测脑电信号的宽度的比值，所述第三预测值是所述预测框的边框置信度。7.根据权利要求1所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，所述步骤S1具体包括如下步骤：S11：利用带通滤波器对所述原始信号中的0.5~70Hz以外的频段进行滤除，并利用陷波滤波器对所述原始信号中的50Hz的工频干扰进行剔除，获得干扰较少的脑电信号；S12：采用独立成分分析法将干扰较少的脑电信号所包含的由眼动和心跳所产生的伪影剔除，并统一降采样为250Hz，获得待检测脑电信号。8.根据权利要求6所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，利用损失函数对所述第一预测值、所述第二预测值和所述第三预测值进行更新，所述损失函数的公式为：其中，为第一实测值，/＞为所述第一预测值，/＞为第二实测值，/＞为所述第二预测值，/＞为第三实测值，/＞为所述第三预测值，/＞为实际目标的类别为c的概率，/＞为预测目标的预测概率，/＞为第/＞个网格中的第/＞个预测框是否包含实际目标，/＞为第个网格中的第/＞个预测框是否不包含实际目标，/＞为位置损失的权重系数，取5.5，为无伪影的预测框的置信度损失，取0.5。9.根据权利要求6所述的基于改进的YOLO网络的脑电图伪影检测方法，其特征在于，所述伪影检测框由所述第一预测值、所述第二预测值和所述第三预测值构成。
说明书desc
技术领域本发明涉及脑电信号处理技术领域，尤其涉及一种基于改进的YOLO网络的脑电图伪影检测方法。背景技术脑电信号是一种毫伏级或微伏级的微弱宽频电生理信号，脑电信号经过颅骨和头皮的衰减后，在头皮表面通过前置差分放大器，并经多级连续电压可放大数百万倍。如图1所示，在记录脑电信号的过程中，将两个位置不同的参考电极所产生的电压差和位相差通过差分放大的形式显示出脑电图。如图2所示，采用侧耳对A1、A2的位置作为参考电极，全部电极的安放位置参考国际脑电图学会建议的10-20标准系统，该标准目前被广泛应用于规范电极的摆放位置。将参考电极记录到的不被需要的信号作为伪影，伪影分为环境伪影和生物伪影。环境伪影一般来源于人体外部，如电机、电源等外部设备的干扰或电极位移，而人体肌肉、眼部和心脏活动等非脑源信号被认为是生物伪影。环境伪影和生物伪影都会降低脑电信号，即脑机接口应用或医学诊断会因为功率谱的失真而受阻。现有的基于神经网络模型的方法包括：利用一维残差卷积神经网络模型对基于原始波形的EEG信号进行去噪，但此模型因具有架构和训练策略不足以捕捉各种噪声的普遍特征，因此，不能够在未知噪声的情况下提高去噪性能；深度学习网络的在线和离线的两个阶段的方法均可用于去除EEG信号中的眼部伪影，但是深度学习网络模型不适用于大型数据集；将深度学习分类器与其他方法结合使用的混合方法能够在线剔除伪影，且能够采用独立成分分析法分解波形的独立成分，但该方法无法给出明确的分类边界，存在信息丢失的风险。发明内容本发明为解决现有的网络结构在检测伪影的过程中存在的不适用于大型数据集，且无法给出明确的分类边界，存在信息丢失的风险的缺点，提供一种基于改进的YOLO网络的脑电图伪影检测方法，通过对YOLO网络进行改进并结合MobileNet算法，以深度可分离卷积模块作为骨干网络，同时对网络输入数据、结果矩阵和损失函数进行调整，能够有效提升脑电图中伪影的检测速率和检测精度。本发明提出的基于改进的YOLO网络的脑电图伪影检测方法，具体包括如下步骤：S1：对原始信号进行预处理，获得待检测脑电信号；S2：建立改进的YOLO网络模型，将待检测脑电信号划分为1*s个网格，并将划分为1*s个网格的待检测脑电信号输送至训练好的改进的YOLO网络模型进行训练，获得与1*s个网格相对应的边框置信度；S3：将1*s个网格对应的边框置信度依次进行非极大值抑制，获得最终的伪影检测框。优选地，改进的YOLO网络模型包括局部特征提取模块、全局特征提取模块、n个级联的深度可分离卷积模块、3*3卷积层、归一化层、ELU激活函数和两个全连接层，其中，将划分为1*s个网格的待检测脑电信号依次输入至局部特征提取模块和全局特征提取模块进行单通道特征信息和多通道特征信息的提取，对应获得映射至二维空间的波形特征；波形特征经n个级联的深度可分离卷积模块进行卷积操作后，获得减少网络参数的第一特征图，第一特征图经3*3卷积层进行卷积操作及相应的归一化处理，并采用ELU激活函数进行激活操作后，再经两个级联的全连接层进行卷积操作，获得包含伪影位置和类别概率值的第二特征图。优选地，局部特征提取模块的卷积核为1*1*7，全局特征提取模块的卷积核为1*1*19。优选地，深度可分离卷积模块包括Depthwise卷积层、Pointwise卷积层、两个ELU激活函数和两个归一化层，其中，输入至深度可分离卷积模块的特征图经Depthwise卷积层进行卷积操作及相应的归一化处理，并采用ELU激活函数进行激活操作后，获得包含空间滤波信息的第三特征图；第三特征图经Pointwise卷积层进行卷积操作及相应的归一化处理，并采用ELU激活函数进行激活操作后，获得包含特征生成信息的第四特征图。优选地，步骤S2具体包括如下步骤：S21：设置每个网格均对应B个预测框，且每个预测框均对应设置第一预测值、第二预测值和第三预测值；S22：设置伪影出现在当前预测框的条件概率，并通过下式依次计算包含当前预测框的网格所对应的B个预测框的边框置信度：；；其中，为边框置信度，/＞为伪影出现在当前预测框的条件概率，为预测框与真实框的交集面积与并集面积之比，class为标注数据的类别，/＞为预测框的面积，/＞为真实框的面积，/＞为预测框的宽度，/＞为真实框的宽度，为用于衡量预测框和真实框之间重叠程度的度量；S23：重复步骤S22，计算所有网格中的所有预测框的边框置信度。优选地，第一预测值为预测框的中心相对于网格边界的横向偏移量，第二预测值是预测框的宽度与待检测脑电信号的宽度的比值，第三预测值是预测框的边框置信度。优选地，步骤S1具体包括如下步骤：S11：利用带通滤波器对原始信号中的0.5~70Hz以外的频段进行滤除，并利用陷波滤波器对原始信号中的50Hz的工频干扰进行剔除，获得干扰较少的脑电信号；S12：采用独立成分分析法将干扰较少的脑电信号所包含的由眼动和心跳所产生的伪影剔除，并统一降采样为250Hz，获得待检测脑电信号。优选地，利用损失函数对第一预测值、第二预测值和第三预测值进行更新，损失函数的公式为：其中，为第一实测值，/＞为第一预测值，/＞为第二实测值，/＞为第二预测值，/＞为第三实测值，/＞为第三预测值，/＞为实际目标的类别为c的概率，/＞为预测目标的预测概率，/＞为第/＞个网格中的第/＞个预测框是否包含实际目标，/＞为第/＞个网格中的第/＞个预测框是否不包含实际目标，/＞为位置损失的权重系数，取5.5，/＞为无伪影的预测框的置信度损失，取0.5。优选地，伪影检测框由第一预测值、第二预测值和第三预测值构成。与现有技术相比，本发明能够取得如下有益效果：本发明提出的改进的YOLO网络能够进一步提高伪影检测的准确率，避免因不合适的伪影剔除量对脑电图的自动化识别效率所造成的影响，在脑电信号的伪影检测上，本发明相较于现有技术能够在更短的时间内获得更精准的目标位置边框，有利于精准剔除伪影，并有效提高后期异常脑电信号的检测准确率。本发明的骨干网络采用MobileNet中的深度可分离卷积思想，将每个卷积层拆分成Pointwise卷积和Depthwise卷积，从而实现了减少网络参数，缩短检测时间的目的，且有效降低了计算时耗。附图说明图1是数字化EEG仪器的结构示意图；图2是国际10-20电极定位系统的布局示意图；图3是根据本发明实施例提供的基于改进的YOLO网络的脑电图伪影检测方法的流程示意图；图4是根据本发明实施例提供的基于改进的YOLO网络的脑电图伪影检测的过程示意图；图5是根据本发明实施例提供的改进的YOLO网络的网络结构示意图；图6是根据本发明实施例提供的深度可分离卷积模块的结构示意图。具体实施方式在下文中，将参考附图描述本发明的实施例。在下面的描述中，相同的模块使用相同的附图标记表示。在相同的附图标记的情况下，它们的名称和功能也相同。因此，将不重复其详细描述。为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及具体实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅用以解释本发明，而不构成对本发明的限制。图3示出了根据本发明实施例提供的基于改进的YOLO网络的脑电图伪影检测方法的流程，图4示出了根据本发明实施例提供的基于改进的YOLO网络的脑电图伪影检测的过程。如图3-图4所示，本发明提出的基于改进的YOLO网络的脑电图伪影检测方法，具体包括如下步骤：S1：对原始信号进行预处理，获得待检测脑电信号。步骤S1具体包括如下步骤：S11：利用带通滤波器对原始信号中的0.5~70Hz以外的频段进行滤除，并利用陷波滤波器对原始信号中的50Hz的工频干扰进行剔除，获得干扰较少的脑电信号；S12：采用独立成分分析法将干扰较少的脑电信号所包含的由眼动和心跳所产生的伪影剔除，并统一降采样为250Hz，获得待检测脑电信号。S2：建立改进的YOLO网络模型，将待检测脑电信号划分为1*s个网格，并将划分为1*s个网格的待检测脑电信号输送至训练好的改进的YOLO网络模型进行训练，获得与1*s个网格相对应的边框置信度。步骤S2具体包括如下步骤：S21：设置每个网格均对应B个预测框，且每个预测框均对应设置第一预测值、第二预测值和第三预测值。第一预测值为预测框的中心相对于网格边界的横向偏移量，第二预测值是预测框的宽度与待检测脑电信号的宽度的比值，第三预测值是预测框的边框置信度。S22：设置伪影出现在当前预测框的条件概率，并通过下式依次计算包含当前预测框的网格所对应的B个预测框的边框置信度：；；其中，为边框置信度，/＞为伪影出现在当前预测框的条件概率，为预测框与真实框的交集面积与并集面积之比，class为标注数据的类别，/＞为预测框的面积，/＞为真实框的面积，/＞为预测框的宽度，/＞为真实框的宽度，为用于衡量预测框和真实框之间重叠程度的度量。真实框是由人工标注或者数据集提供的，用来表示脑电图中目标的真实位置和大小。S23：重复步骤S22，计算所有网格中的所有预测框的边框置信度。S3：将1*s个网格对应的边框置信度依次进行非极大值抑制，获得最终的伪影检测框。非极大值抑制是计算机视觉领域中一种常用的技术，通常用于在检测或识别过程中减少冗余的边界框或关键点，其主要目的是选择具有最高置信度或得分的目标，以减少重叠的检测结果，使结果更加准确和精简。图5示出了是根据本发明实施例提供的改进的YOLO网络的网络结构。如图5所示，改进的YOLO网络模型包括局部特征提取模块、全局特征提取模块、n个级联的深度可分离卷积模块、3*3卷积层、归一化层、ELU激活函数和两个全连接层，其中，将划分为1*s个网格的待检测脑电信号依次输入至局部特征提取模块和全局特征提取模块进行单通道特征信息和多通道特征信息的提取，对应获得映射至二维空间的波形特征；波形特征经n个级联的深度可分离卷积模块进行卷积操作后，获得减少网络参数的第一特征图，第一特征图经3*3卷积层进行卷积操作及相应的归一化处理，并采用ELU激活函数进行激活操作后，再经两个级联的全连接层进行卷积操作，获得包含伪影位置和类别概率值的第二特征图。局部特征提取模块的卷积核为1*1*7，全局特征提取模块的卷积核为1*1*19。图6示出了根据本发明实施例提供的深度可分离卷积模块的结构。如图6所示，深度可分离卷积模块包括Depthwise卷积层、Pointwise卷积层、两个ELU激活函数和两个归一化层，其中，输入至深度可分离卷积模块的特征图经Depthwise卷积层进行卷积操作及相应的归一化处理，并采用ELU激活函数进行激活操作后，获得包含空间滤波信息的第三特征图；第三特征图经Pointwise卷积层进行卷积操作及相应的归一化处理，并采用ELU激活函数进行激活操作后，获得包含特征生成信息的第四特征图。ELU激活函数的数学表达式为：，α为常数，输入/＞为神经元接收到输入信号或激活前的值，输出/＞为输入/＞经ELU激活函数处理后的输出值，在神经网络的上下文中，输入和输出通常是指单个神经元的输入和输出，整个神经网络的输入是由输入层提供的，输出是由输出层产生的。ELU激活函数被用于每个神经元，以引入非线性和网络学习的复杂映射，且能够通过减少偏置偏移的影响，使正常梯度更接近于单位自然梯度。在全连接层以外的卷积操作中均进行相应的批量归一化处理，以加速改进的YOLO网络的收敛速度；采用ELU激活函数作为激活函数，且在输入下会饱和至负值，从而减少改进的YOLO网络的前向传播的变异和信息，且符合脑电信号的数值小且含有正负值的特征。网络体系结构和参数如表1所示：表1设置损失函数是为了能够在伪影检测过程中兼顾位置精度、目标存在判断和目标类别预测。伪影检测框由第一预测值、第二预测值和第三预测值构成。利用损失函数对第一预测值、第二预测值和第三预测值进行更新，损失函数的公式为：其中，为第一实测值，/＞为第一预测值，/＞为第二实测值，/＞为第二预测值，/＞为第三实测值，/＞为第三预测值，/＞为实际目标的类别为c的概率，/＞为预测目标的预测概率，/＞为第/＞个网格中的第/＞个预测框是否包含实际目标，/＞为第/＞个网格中的第/＞个预测框是否不包含实际目标，/＞为位置损失的权重系数，取5.5，/＞为无伪影的预测框的置信度损失，取0.5。是一个指示函数，表示在第/＞个网格中的第j个预测框是否不包含实际目标，/＞为1表示第/＞个网格中的第j个预测框不包含实际目标，/＞为0表示第/＞个网格中的第j个预测框包含实际目标。对于不包含实际目标的预测框，置信度损失中的相应项将被计算。/＞也是一个指示函数，表示在第/＞个网格中是否包含实际目标，/＞为1表示在第/＞个网格中包含实际目标，/＞为0表示在第/＞个网格中不包含目标，对于包含实际目标的预测框，定位损失、分类损失以及置信度损失中的相应项将被计算。在损失函数中，为适配脑电数据及伪影的多导联全面性发生的特点，取消了原YOLO网络中的预测框高度和预测框中心相对于单元格的纵向偏移的两个变量，只预测目标的边界框宽度和单元格的横向偏移量/＞，即损失函数的设置可降低网络参数量，缩短模型训练时间。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发明公开中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本发明公开的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
