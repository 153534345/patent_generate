标题title
基于光谱重构的高光谱交叉定标方法、装置及电子设备
摘要abst
本发明属于光谱定标技术领域，涉及基于光谱重构的高光谱交叉定标方法、装置及电子设备，该方法包括：建立具有多头注意力机制的卷积神经网络模型；选择目标波段的高光谱波段数据；建立长短期记忆神经网络模型，模型训练；高光谱波段数据重建得到目标波段高光谱数据；使用目标波段高光谱数据进行交叉定标。本发明有效解决了传统交叉定标要求待定标遥感器和目标遥感器之间必须有相近谱段的问题，通过具有多头注意力机制的卷积神经网络模型，训练卷积神经网络模型使其具有良好的波段选择能力并筛选出高光谱数据中代表性较强的波段，波段选择后利用长短期记忆网络进行光谱重建，拟合出需要的波段信息，进而满足交叉定标的需求。
权利要求书clms
1.基于光谱重构的高光谱交叉定标方法，其特征在于，包括：建立具有多头注意力机制的卷积神经网络模型；利用所述卷积神经网络模型选择目标波段的高光谱波段数据；建立长短期记忆神经网络模型，采用反向传播算法对所述长短期记忆神经网络模型进行训练；利用训练后的所述长短期记忆神经网络模型对选择的目标波段的所述高光谱波段数据进行重建，得到重建后的目标波段高光谱数据；使用所述目标波段高光谱数据进行交叉定标。2.根据权利要求1所述基于光谱重构的高光谱交叉定标方法，其特征在于，采用若干个多头注意力模块和全连接层作为所述长短期记忆神经网络模型的基础结构并在输出时加入阶梯函数作为滤波器。3.根据权利要求1所述基于光谱重构的高光谱交叉定标方法，其特征在于，利用所述卷积神经网络模型选择目标波段的高光谱波段数据，包括：对所述高光谱波段数据进行特征提取得到目标波段的权重矩阵；对目标波段的所述权重矩阵进行筛选，使用阶梯函数保留权重最大的高光谱波段，得到目标波段的所述高光谱波段数据。4.根据权利要求1所述基于光谱重构的高光谱交叉定标方法，其特征在于，利用训练后的所述长短期记忆神经网络模型对选择的目标波段的所述高光谱波段数据进行重建时，将每个波段的辐亮度作为一维特征，筛选后的波段集合作为序列，进行长短期记忆神经网络计算。5.根据权利要求1所述基于光谱重构的高光谱交叉定标方法，其特征在于，采用反向传播算法更新所述卷积神经网络模型参数，计算原始矩阵和使用所述卷积神经网络模型重建的矩阵之间的均方误差；根据所述均方误差确定满足重构原始的全波段信息的波段。6.根据权利要求1所述基于光谱重构的高光谱交叉定标方法，其特征在于，使用所述目标波段高光谱数据进行交叉定标，包括：得到重建后的目标波段高光谱数据后，将一维的辐亮度信息进行扩充和计算得到多维的张量；使用两个线性回归网络对所述张量进行降维运算，拟合出的重建波段信息，得到辐亮度；将数据输入训练后的所述长短期记忆神经网络模型，拟合出缺失的波段辐亮度；将拟合出的波段辐亮度作为目标值并结合待定标遥感器的DN值计算定标系数，完成交叉定标。7.基于光谱重构的高光谱交叉定标装置，其特征在于，包括模型建立单元、选择单元、模型训练单元、重建单元与交叉定标单元；所述模型建立单元，用于建立具有多头注意力机制的卷积神经网络模型；所述选择单元，用于利用所述卷积神经网络模型选择目标波段的高光谱波段数据；所述模型训练单元，用于建立长短期记忆神经网络模型，采用反向传播算法对所述长短期记忆神经网络模型进行训练；所述重建单元，用于利用训练后的所述长短期记忆神经网络模型对选择的目标波段的所述高光谱波段数据进行重建，得到重建后的目标波段高光谱数据；所述交叉定标单元，用于使用所述目标波段高光谱数据进行交叉定标。8.一种电子设备，其特征在于，包括:处理器和存储器；所述存储器，用于存储计算机操作指令；所述处理器，用于通过调用所述计算机操作指令，执行权利要求1至6中任一项所述的方法。
说明书desc
技术领域本发明属于光谱定标技术领域，具体而言，涉及基于光谱重构的交叉定标方法、装置及电子设备。背景技术当前遥感应用逐渐从定性向定量化发展的趋势对辐射定标的可靠性提出了更高的要求。传统的场地替代定标法虽然定标精度较高，但有着诸多限制难以大规模高频率的开展。交叉定标是近年来发展较为迅速的一种无场地定标技术，它解决了场地定标门槛高的问题。交叉定标的思想是待定标的在轨卫星遥感器与定标结果较好的卫星遥感器在同一时间、相近角度观测同一区域时，可以通过对比二者的测量值，来实现对待定标卫星遥感器的标定。与场地替代定标技术相比，它无需建立地面校正场，就可进行多遥感器卫星数据之间的标定。它的优点是定标成本较低，可以实现高频次、多遥感器间的辐射定标。刘佳欣等人曾在2021年使用MODIS卫星对我国风云4号卫星的热红外通道进行交叉定标。虽然交叉定标的限制条件与场地定标相比有所降低，但是交叉定标要求待定标遥感器与目标遥感器有着相似的光谱范围，这就导致了一些待定标遥感器缺少可利用的具有相似光谱范围的目标遥感器进行参考。发明内容为了解决上述技术问题，本发明提供基于光谱重构的高光谱交叉定标方法、装置及电子设备。第一方面，本发明提供了基于光谱重构的高光谱交叉定标方法，包括：建立具有多头注意力机制的卷积神经网络模型；利用所述卷积神经网络模型选择目标波段的高光谱波段数据；建立长短期记忆神经网络模型，采用反向传播算法对所述长短期记忆神经网络模型进行训练；利用训练后的所述长短期记忆神经网络模型对选择的目标波段的所述高光谱波段数据进行重建，得到重建后的目标波段高光谱数据；使用所述目标波段高光谱数据进行交叉定标。第二方面，本发明提供了基于光谱重构的高光谱交叉定标装置，包括模型建立单元、选择单元、模型训练单元、重建单元与交叉定标单元；所述模型建立单元，用于建立具有多头注意力机制的卷积神经网络模型；所述选择单元，用于利用所述卷积神经网络模型选择目标波段的高光谱波段数据；所述模型训练单元，用于建立长短期记忆神经网络模型，采用反向传播算法对所述长短期记忆神经网络模型进行训练；所述重建单元，用于利用训练后的所述长短期记忆神经网络模型对选择的目标波段的所述高光谱波段数据进行重建，得到重建后的目标波段高光谱数据；所述交叉定标单元，用于使用所述目标波段高光谱数据进行交叉定标。第三方面，本发明提供了一种电子设备，包括:处理器和存储器；所述存储器，用于存储计算机操作指令；所述处理器，用于通过调用所述计算机操作指令，执行所述的基于光谱重构的高光谱交叉定标方法。本发明的有益效果是：本发明有效解决了传统交叉定标要求待定标遥感器和目标遥感器之间必须有相近谱段的问题，通过具有多头注意力机制的卷积神经网络模型，训练卷积神经网络模型使其具有良好的波段选择能力并筛选出高光谱数据中代表性较强的波段，波段选择后利用长短期记忆网络进行光谱重建，拟合出需要的波段信息，进而满足交叉定标的需求。在上述技术方案的基础上，本发明还可以做如下改进。进一步，采用若干个多头注意力模块和全连接层作为所述长短期记忆神经网络模型的基础结构并在输出时加入阶梯函数作为滤波器。进一步，利用所述卷积神经网络模型选择目标波段的高光谱波段数据，包括：对所述高光谱波段数据进行特征提取得到目标波段的权重矩阵；对目标波段的所述权重矩阵进行筛选，使用阶梯函数保留权重最大的高光谱波段，得到目标波段的所述高光谱波段数据。进一步，利用训练后的所述长短期记忆神经网络模型对选择的目标波段的所述高光谱波段数据进行重建时，将每个波段的辐亮度作为一维特征，筛选后的波段集合作为序列，进行长短期记忆神经网络计算。进一步，采用反向传播算法更新所述卷积神经网络模型参数，计算原始矩阵和使用所述卷积神经网络模型重建的矩阵之间的均方误差；根据所述均方误差确定满足重构原始的全波段信息的波段。进一步，使用所述目标波段高光谱数据进行交叉定标，包括：得到重建后的目标波段高光谱数据后，将一维的辐亮度信息进行扩充和计算得到多维的张量；使用两个线性回归网络对所述张量进行降维运算，拟合出的重建波段信息，得到辐亮度；将数据输入训练后的所述长短期记忆神经网络模型，拟合出缺失的波段辐亮度；将拟合出的波段辐亮度作为目标值并结合待定标遥感器的DN值计算定标系数，完成交叉定标。附图说明图1为本发明实施例1提供的基于光谱重构的高光谱交叉定标方法的流程图；图2为本发明基于光谱重构的高光谱交叉定标装置的原理图；图3为本发明实施例3中一种电子设备的原理图。图标：30-电子设备；310-处理器；320-总线；330-存储器；340-收发器。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本发明实施例的组件可以以各种不同的配置来布置和设计。实施例1作为一个实施例，如附图1所示，为解决上述技术问题，本实施例提供基于光谱重构的高光谱交叉定标方法，包括：建立具有多头注意力机制的卷积神经网络模型；利用卷积神经网络模型选择目标波段的高光谱波段数据；建立长短期记忆神经网络模型，采用反向传播算法对长短期记忆神经网络模型进行训练；利用训练后的长短期记忆神经网络模型对选择的目标波段的高光谱波段数据进行重建，得到重建后的目标波段高光谱数据；使用目标波段高光谱数据进行交叉定标。在实际应用过程中，建立具有多头注意力机制的卷积神经网络模型，通过模型训练实现波段选择的功能。可选的，采用若干个多头注意力模块和全连接层作为长短期记忆神经网络模型的基础结构并在输出时加入阶梯函数作为滤波器。在实际应用过程中，在建立具有多头注意力机制的卷积神经网络模型时，具体包括如下步骤：S11：采用64个多头注意力模块和全连接层做为待训练模型的基础结构并在输出时加入阶梯函数作为滤波器；S12：构建卷积神经网络结构，使用多层卷积，利用过滤后的低秩矩阵重建原始矩阵；S13：采用反向传播算法更新网络参数，计算原始矩阵和使用卷积神经网络重建的矩阵之间的均方误差分析原始矩阵和重建的矩阵的差异性，均方误差越小则差异性越小。；利用具有多头注意力机制的卷积神经网络模型选择目标波段的高光谱波段数据，差异性越小则波段选择越成功，反之差异性越大说明选择到的波段代表性不强、冗余度高。采用注意力机制增强卷积神经网络的特征提取能力，对大量冗余的高光谱波段进行特征提取并得到波段的权重矩阵，以选择出最具有代表性的波段，设aij为注意力分布；softmax为激活函数；s为注意力打分函数；exp)为注意力打分函数的指数映射；contexti为输入数据；注意力机制公式如下：使用注意力网络对波段矩阵进行加权时，不会改变输入数据X的大小，在大小为H×W×S的张量X中只有被选择的波段值为1，其他未被选择的波段值为0。设hi为第i个注意力头；Wi为查询q的可学习参数；Wi为键k的可学习参数；Wi为值v的可学习参数；RPv为注意力的作用域；多头注意力算法公式如下：hi＝fq,Wik,Wiv)∈RPv；其中hi为第i个注意力头，q为查询，k为键，v为值，得到多个注意力头的输出之后需要进行线性转换，对多个注意力头的结果进行拼接，公式如下：可选的，利用卷积神经网络模型选择目标波段的高光谱波段数据，包括：对高光谱波段数据进行特征提取得到目标波段的权重矩阵；对目标波段的权重矩阵进行筛选，使用阶梯函数保留权重最大的高光谱波段，得到目标波段的高光谱波段数据。在实际应用过程中，使用具有多头注意力机制的卷积神经网络模型对波段矩阵进行加权，对代表性强的波段赋1值，对冗余波段赋0值，再使用选择后的波段矩阵还原完整的原始矩阵，当选择后的波段矩阵可以近似表达原始矩阵时即可认为模型收敛，波段选择的结果有效且代表性强。对得到的权重矩阵进行筛选，使用阶梯函数保留权重较大、代表能力更强的高光谱波段。在使用长短期记忆网络进行光谱重建的过程中只使用选择后的波段以避免冗余和过大的时间复杂度。可选的，利用训练后的长短期记忆神经网络模型对选择的目标波段的高光谱波段数据进行重建时，将每个波段的辐亮度作为一维特征，筛选后的波段集合作为序列，进行长短期记忆神经网络计算。在实际应用过程中，设It为t时刻的输入门；Ft为t时刻的遗忘门；Ot为t时刻的输出门；Xt为当前时刻网络的输入值；Wxi为输入门当前时刻的可学习参数；Wxf为遗忘门当前时刻的可学习参数；Wxo为输出门当前时刻的可学习参数；Ht-1为上一时刻LSTM的输出值；Whi为输入门曾经输入的可学习参数；Whf为遗忘门曾经输入的可学习参数；Who为遗忘门曾经输入的可学习参数；bi为输入门的偏置项；bf为遗忘门的偏置项；bo为输出门的偏置项；σ为；长短期记忆网络公式如下：It＝σ；Ft＝σ；Ot＝σ；可选的，采用，更新卷积神经网络模型参数，计算原始矩阵和使用卷积神经网络模型重建的矩阵之间的均方误差；根据均方误差确定满足重构原始的全波段信息的波段。可选的，使用目标波段高光谱数据进行交叉定标，包括：得到重建后的目标波段高光谱数据后，将一维的辐亮度信息进行扩充和计算得到多维的张量；使用两个线性回归网络对张量进行降维运算，拟合出的重建波段信息，得到辐亮度；将数据输入训练后的长短期记忆神经网络模型，拟合出缺失的波段辐亮度；将拟合出的波段辐亮度作为目标值并结合待定标遥感器的DN值计算定标系数，完成交叉定标。在实际应用过程中，经过长短期记忆神经网络的计算后，数据的特征维度会发生变化，需要进行线性回归，可选的，线性回归的具体过程如下示例：得到重建后的目标波段高光谱数据后，并将输出特征的维度数量设置为64，隐藏层设置为3；使用线性回归的方式将64维特征进行降维，降维后的特征维度数量为8，之后再次使用线性回归的方式将特征维度降至1；降维后的张量格式为，其中n为输入波段数，使用线性连接将张量变形成为；经过三次计算最终得到目标波段的辐亮度值，并用于交叉定标。下面将采用两组数据集模拟高光谱数据集用于训练神经网络：1.JPL高光谱数据集地物的波谱特征是电磁波与地物表面相互作用的结果，往往表现为地物在不同波段反射、热辐射、微波辐射及散射特征，从波谱数据库筛选地物类型，再将地物反射率转换为地物发射率，从热力学数据库中获取大气廓线数据，最后将筛选出的数据通过MODTRAN模拟软件计算得到对应的辐亮度。2.TIGR大气廓线数据集TIGR大气廓线数据集是法国动力气象实验室建立的一个大气廓线数据库，主要用于作为大气廓线反演的初估值，包括大气温度和湿度廓线，这些廓线是利用拓扑学方法从不同时期、全球范围内大量大气样本中精选出来的，均属于探空观测，共有2311条大气廓线，分布在全球各地。上述方法中筛选晴空廓线共716条作为大气廓线数据。本发明有效解决了传统交叉定标要求待定标遥感器和目标遥感器之间必须有相近谱段的问题，通过具有多头注意力机制的卷积神经网络模型，训练卷积神经网络模型使其具有良好的波段选择能力并筛选出高光谱数据中代表性较强的波段，波段选择后利用长短期记忆网络进行光谱重建，拟合出需要的波段信息，进而满足交叉定标的需求。实施例2基于与本发明的实施例1中所示的方法相同的原理，如附图2所示，本发明的实施例中还提供了基于光谱重构的高光谱交叉定标装置，包括模型建立单元、选择单元、模型训练单元、重建单元与交叉定标单元；模型建立单元，用于建立具有多头注意力机制的卷积神经网络模型；选择单元，用于利用卷积神经网络模型选择目标波段的高光谱波段数据；模型训练单元，用于建立长短期记忆神经网络模型，采用反向传播算法对长短期记忆神经网络模型进行训练；重建单元，用于利用训练后的长短期记忆神经网络模型对选择的目标波段的高光谱波段数据进行重建，得到重建后的目标波段高光谱数据；交叉定标单元，用于使用目标波段高光谱数据进行交叉定标。可选的，采用若干个多头注意力模块和全连接层作为长短期记忆神经网络模型的基础结构并在输出时加入阶梯函数作为滤波器。可选的，利用卷积神经网络模型选择目标波段的高光谱波段数据，包括：对高光谱波段数据进行特征提取得到目标波段的权重矩阵；对目标波段的权重矩阵进行筛选，使用阶梯函数保留权重最大的高光谱波段，得到目标波段的高光谱波段数据。可选的，利用训练后的长短期记忆神经网络模型对选择的目标波段的高光谱波段数据进行重建时，将每个波段的辐亮度作为一维特征，筛选后的波段集合作为序列，进行长短期记忆神经网络计算。可选的，采用反向传播算法更新卷积神经网络模型参数，计算原始矩阵和使用卷积神经网络模型重建的矩阵之间的均方误差；根据均方误差确定满足重构原始的全波段信息的波段。可选的，使用目标波段高光谱数据进行交叉定标，包括：得到重建后的目标波段高光谱数据后，将一维的辐亮度信息进行扩充和计算得到多维的张量；使用两个线性回归网络对张量进行降维运算，拟合出的重建波段信息，得到辐亮度；将数据输入训练后的长短期记忆神经网络模型，拟合出缺失的波段辐亮度；将拟合出的波段辐亮度作为目标值并结合待定标遥感器的DN值计算定标系数，完成交叉定标。实施例3基于与本发明的实施例中所示的方法相同的原理，本发明的实施例中还提供了一种电子设备，如附图所示，该电子设备可以包括但不限于：处理器和存储器；存储器，用于存储计算机程序；处理器，用于通过调用计算机程序执行本发明任一实施例的方法。在一个可选实施例中提供了一种电子设备，附图3所示的电子设备30包括：处理器310和存储器330。其中，处理器310和存储器330相连，如通过总线320相连。可选地，电子设备30还可以包括收发器340，收发器340可以用于该电子设备与其他电子设备之间的数据交互，如数据的发送和/或数据的接收等。需要说明的是，实际应用中收发器340不限于一个，该电子设备30的结构并不构成对本发明实施例的限定。处理器310可以是CPU中央处理器，通用处理器，DSP数据信号处理器，ASIC专用集成电路，FPGA现场可编程门阵列或者其他可编程逻辑器件、硬件部件或者其任意组合。处理器310也可以是实现计算功能的组合，例如包含一个或多个微处理器组合，DSP和微处理器的组合等。总线320可包括一通路，在上述组件之间传送信息。总线320可以是PCI外设部件互连标准总线或EISA扩展工业标准结构总线等。总线320可以分为控制总线、数据总线、地址总线等。为便于表示，附图3中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。存储器330可以是ROM只读存储器或可存储静态信息和指令的其他类型的静态存储设备，RAM随机存储器或者可存储信息和指令的其他类型的动态存储设备，也可以是EEPROM电可擦可编程只读存储器、CD-ROM只读光盘或其他光盘存储、光碟存储、磁盘存储介质，或者能够用于携带或存储具有指令或数据结构形式的期望的程序代码并能够由计算机存取的任何其他介质，但不限于此。存储器330用于存储执行本发明方案的应用程序代码，并由处理器310来控制执行。处理器310用于执行存储器330中存储的应用程序代码，以实现前述方法实施例所示的内容。以上仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
