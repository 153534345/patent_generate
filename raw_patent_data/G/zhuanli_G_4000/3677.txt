标题title
人脸伪造视频检测模型的训练方法、装置及计算设备
摘要abst
本发明公开了一种人脸伪造视频检测模型的训练方法、装置及计算设备，该方法包括：收集目标人物的原始人脸视频和人脸伪造视频；分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列；以及将多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型；其中，双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。基于该训练方法，有效地降低检测模型对待检测视频质量的要求，提高对多重压缩检测视频的鲁棒性，在保证精度的同时提升检测模型的泛化能力。
权利要求书clms
1.一种人脸伪造视频检测模型的训练方法，其特征在于，所述方法包括：收集目标人物的原始人脸视频和人脸伪造视频；分别从所述原始人脸视频和所述人脸伪造视频中提取特征，得到对应的多变量时间序列；以及将所述多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型；其中，所述双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将所述目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。2.根据权利要求1所述的训练方法，其特征在于，所述分别从所述原始人脸视频和所述人脸伪造视频中提取特征，得到对应的多变量时间序列进一步包括：分别跟踪所述原始人脸视频和所述人脸伪造视频每一帧的面部运动单元数据、视线估计数据以及头部运动数据，得到对应的多变量时间序列。3.根据权利要求1或2所述的方法，其特征在于，所述空域分支网络用于：将所述多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；以及通过顺序连接的多个编码器，基于非线性激活后的多变量时间序列，提取得到目标人物说话模式特征；其中，在每个编码器中，对非线性激活后的多变量时间序列进行多头自注意力计算，然后通过前馈网络获取所述目标人物说话模式特征。4.根据权利要求1或2所述的训练方法，其特征在于，所述时域分支网络用于：将所述多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；通过位置编码器，对非线性激活后的多变量时间序列进行位置编码；以及通过顺序连接的多个编码器，基于经过位置编码后的多变量时间序列获取视频时间相关性特征；其中，在每个编码器中，对经过位置编码后的特定数据进行带掩码的多头注意力计算，然后通过前馈网络获取视频时间相关性特征。5.根据权利要求1所述的训练方法，其特征在于，所述收集目标人物的原始人脸视频和人脸伪造视频，进一步包括：收集目标人物的原始人脸视频；基于所述原始人脸视频，生成所述人脸伪造视频，其中，生成所述人脸伪造视频的方法包括面部替换、唇音同步和/或表情动作迁移。6.一种人脸伪造视频的检测方法，其特征在于，所述方法包括：获取待检测的人脸视频；从所述待检测的人脸视频中提取特征，得到对应的多变量时间序列；将所述多变量时间序列输入至人脸伪造视频检测模型，得到所述待检测的人脸视频的检测结果；其中，所述人脸伪造视频检测模型是根据权利要求1-5中任一项所述的人脸伪造视频检测模型的训练方法而得到。7.一种人脸伪造视频检测模型的训练装置，其特征在于，所述训练装置包括：视频收集模块，适于收集目标人物的原始人脸视频和人脸伪造视频；第一特征提取模块，适于分别从所述原始人脸视频和所述人脸伪造视频中提取特征，得到对应的多变量时间序列；以及训练模块，适于将所述多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型；其中，所述双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将所述目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。8.一种人脸伪造视频的检测装置，其特征在于，所述检测装置包括：视频获取模块，适于获取待检测的人脸视频；第二特征提取模块，适于从所述待检测的人脸视频中提取特征，得到对应的多变量时间序列；以及检测模块，适于将所述多变量时间序列输入至人脸伪造视频检测模型，得到所述待检测的人脸模型的检测结果；其中，所述人脸伪造视频检测模型是根据权利要求1-5中任一项所述的人脸伪造视频检测模型的训练方法而得到。9.一种计算设备，包括：处理器、存储器、通信接口和通信总线，所述处理器、所述存储器和所述通信接口通过所述通信总线完成相互间的通信；所述存储器用于存放至少一可执行指令，所述可执行指令使所述处理器执行如权利要求1-5中任一项所述的用于人脸伪造视频检测模型的训练方法对应的操作或如权利要求6所述的人脸伪造视频的检测方法对应的操作。10.一种计算机存储介质，所述存储介质中存储有至少一可执行指令，所述可执行指令使处理器执行如权利要求1-5中任一项所述的用于人脸伪造视频检测模型的训练方法对应的操作或如权利要求6所述的人脸伪造视频的检测方法对应的操作。
说明书desc
技术领域本发明涉及一种人脸伪造视频检测模型的训练方法，具体涉及一种人脸伪造视频检测模型的训练方法、装置、计算设备及计算机存储介质。背景技术随着近年来各种各样的人脸伪造算法、软件相继推出，在各大网络平台出现了大量人眼无法区分的人脸伪造视频或者图片。一些别有用心的人利用这些技术，将名人的人脸替换到另一个人的身上，或是直接操纵名人视频的面部或唇部发表一些违背他们意愿的言论。这些虚假视频的恶意传播，给整个社会带来极大的威胁。因此，解除这些人脸伪造视频的威胁迫在眉睫，人脸伪造视频和图片的检测研究受到了广泛的关注。为了防止这些人脸伪造视频和图片的泛滥，近年来研究者们从各个角度提出了不同的检测方法，其大致可分为三类：基于单帧伪影特征的方法、基于生物特征的方法和基于时间特征的方法。基于单帧伪影特征的方法，主要以伪造人脸生成过程中在RGB域或频域留下的伪影为线索，然而基于单帧伪影特征挖掘的方法，过于依赖特定的伪影信息，对训练数据未包含的伪造人脸数据普遍表现出泛化性不足的问题，无法满足实际的应用需求；基于生物特征的方法，主要通过挖掘真实人脸与人脸伪造视频的某些特定生物特征之间的矛盾，来区分真实人脸和伪造人脸，然而生物特征大多数会被针对性的精细化后处理所消除，导致检测方法的失效；基于时间特征的方法，则是通过挖掘人脸伪造视频的时间相关性信息来检测虚假人脸，但是随着人脸伪造生成技术的快速发展，伪造人脸的种类多样，导致了这些人脸伪造检测器表现出泛化性不足。发明内容鉴于上述问题，提出了本发明以便提供一种克服上述问题或者至少部分地解决上述问题的人脸伪造视频检测模型的训练方法、装置、计算设备及计算机存储介质。根据本发明的第一方面，提供了一种人脸伪造视频检测模型的训练方法，该方法包括：收集目标人物的原始人脸视频和人脸伪造视频；分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列；以及将多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型；其中，双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。可选地，分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列进一步包括：分别跟踪原始人脸视频和人脸伪造视频每一帧的面部运动单元数据、视线估计数据以及头部运动数据，得到对应的多变量时间序列。可选地，空域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；以及通过顺序连接的多个编码器，基于非线性激活后的多变量时间序列，提取得到目标人物说话模式特征；其中，在每个编码器中，对非线性激活后的多变量时间序列进行多头自注意力计算，然后通过前馈网络获取目标人物说话模式特征。可选地，时域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；通过位置编码器，对非线性激活后的多变量时间序列进行位置编码；以及通过顺序连接的多个编码器，基于经过位置编码后的多变量时间序列获取视频时间相关性特征；其中，在每个编码器中，对经过位置编码后的特定数据进行带掩码的多头注意力计算，然后通过前馈网络获取视频时间相关性特征。可选地，收集目标人物的原始人脸视频和人脸伪造视频，进一步包括：收集目标人物的原始人脸视频；基于原始人脸视频，生成人脸伪造视频，其中，生成人脸伪造视频的方法包括面部替换、唇音同步和/或表情动作迁移。根据本发明的第二方面，提供了一种人脸伪造视频的检测方法，该方法包括：获取待检测的人脸视频；从待检测的人脸视频中提取特征，得到对应的多变量时间序列；将多变量时间序列输入至人脸伪造视频检测模型，得到待检测的人脸视频的检测结果；其中，人脸伪造视频检测模型是根据第一方面提供的人脸伪造视频检测模型的训练方法而得到。根据本发明的第三方面，提供了一种人脸伪造视频检测模型的训练装置，该训练装置包括：视频收集模块，适于收集目标人物的原始人脸视频和人脸伪造视频；第一特征提取模块，适于分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列；以及训练模块，适于将多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型；其中，双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。可选地，第一特征提取模块进一步适于：分别跟踪原始人脸视频和人脸伪造视频每一帧的面部运动单元数据、视线估计数据以及头部运动数据，得到对应的多变量时间序列。可选地，空域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；以及通过顺序连接的多个编码器，基于非线性激活后的多变量时间序列，提取得到目标人物说话模式特征；其中，在每个编码器中，对非线性激活后的多变量时间序列进行多头自注意力计算，然后通过前馈网络获取目标人物说话模式特征。可选地，时域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；通过位置编码器，对非线性激活后的多变量时间序列进行位置编码；以及通过顺序连接的多个编码器，基于经过位置编码后的多变量时间序列获取视频时间相关性特征；其中，在每个编码器中，对经过位置编码后的特定数据进行带掩码的多头注意力计算，然后通过前馈网络获取视频时间相关性特征。可选地，视频收集模块进一步适于：收集目标人物的原始人脸视频；基于原始人脸视频，生成人脸伪造视频，其中，生成人脸伪造视频的方法包括面部替换、唇音同步和/或表情动作迁移。根据本发明的第四方面，本发明提供了一种人脸伪造视频的检测装置，该检测装置包括：视频获取模块，适于获取待检测的人脸视频；第二特征提取模块，适于从待检测的人脸视频中提取特征，得到对应的多变量时间序列；以及检测模块，适于将多变量时间序列输入至人脸伪造视频检测模型，得到待检测的人脸模型的检测结果；其中，人脸伪造视频检测模型是根据第一方面提供的人脸伪造视频检测模型的训练方法而得到。根据本发明的第五方面，提供了一种计算设备，包括：处理器、存储器、通信接口和通信总线，处理器、存储器和通信接口通过通信总线完成相互间的通信；存储器用于存放至少一可执行指令，可执行指令使处理器执行第一方面提供的用于人脸伪造视频检测模型的训练方法对应的操作或第二方面提供的人脸伪造视频的检测方法对应的操作。根据本发明的第六方面，提供了一种计算机存储介质，存储介质中存储有至少一可执行指令，可执行指令使处理器执行第一方面提供的用于人脸伪造视频检测模型的训练方法对应的操作或第二方面提供的人脸伪造视频的检测方法对应的操作。根据本发明的人脸伪造视频检测模型的训练方法、装置、计算设备及计算机存储介质，收集目标人物的原始人脸视频和人脸伪造视频，分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列以及将多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型，其中，双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。基于该训练方法，能有效地降低检测模型对检测视频质量的要求，提高对多重压缩检测视频的鲁棒性，在保证精度的同时提升检测模型的泛化能力。上述说明仅是本发明技术方案的概述，为了能够更清楚了解本发明的技术手段，而可依照说明书的内容予以实施，并且为了让本发明的上述和其它目的、特征和优点能够更明显易懂，以下特举本发明的具体实施方式。附图说明通过阅读下文优选实施方式的详细描述，各种其他的优点和益处对于本领域普通技术人员将变得清楚明了。附图仅用于示出优选实施方式的目的，而并不认为是对本发明的限制。而且在整个附图中，用相同的参考符号表示相同的部件。在附图中：图1示出了根据本发明一实施例的人脸伪造视频检测模型的训练方法的流程示意图；图2示出了根据本发明另一实施例的人脸伪造视频检测模型的训练方法的流程示意图；图3示出了根据本发明又一实施例的人脸伪造视频检测模型的训练方法的示意图；图4示出了根据本发明实施例的基于空域分支网络提取目标人物说话模式特征的示意图；图5示出了根据本发明实施例的基于时域分支网络提取视频时间相关性特征的示意图；图6示出了根据本发明一实施例的人脸伪造视频的检测方法的流程示意图；图7示出了根据本发明一实施例的人脸伪造视频检测模型的训练装置的结构示意图；图8示出了根据本发明另一实施例的人脸伪造视频的检测装置的结构示意图；以及图9示出了根据本发明实施例的一种计算设备的结构示意图。具体实施方式下面将参照附图更详细地描述本发明的示例性实施例。虽然附图中显示了本发明的示例性实施例，然而应当理解，可以以各种形式实现本发明而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更透彻地理解本发明，并且能够将本发明的范围完整的传达给本领域的技术人员。图1示出了根据本发明一实施例的人脸伪造视频检测模型的训练方法的流程示意图。如图1所示，该方法包括以下步骤：步骤S101，收集目标人物的原始人脸视频和人脸伪造视频。根据训练需求确定目标人物，基于确定的目标人物从网络收集目标人物的原始人脸视频以及大量人脸伪造视频，并对目标人物的原始人脸视频和大量人脸伪造视频进行预处理，例如使用SceneDetecte、FFMPEG开源数据库对收集的目标人物的原始人脸视频和人脸伪造视频分别进行预处理，以获取目标人物的原始人脸视频和人脸伪造视频的视频数据，其中，对目标人物的原始人脸视频和人脸伪造视频的预处理包括视频场景分割、视频切割等，具体的预处理方式不做限定；目标人物的数量为一个或多个。具体地，从网络上收集若干位目标人物的原始人脸视频和大量人脸伪造视频，原始人脸视频和人脸伪造视频中均需包括目标人物的全部面部特征且面部正面朝向镜头。使用SceneDetecte开源工具库对所收集的目标人物的原始人脸视频和大量人脸伪造视频进行场景镜头分割，以挑选出镜头长度不小于特定帧且符合上述要求的原始人脸视频片段和人脸伪造视频片段；利用FFMPEG工具库对挑选出的符合要求的原始人脸视频和人脸伪造视频片段进行等长度分割，如使用滑动窗口的方法对视频片段进行等长度和等间隔的滑动分割处理。步骤S102，分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列。现有技术的大多数人脸伪造检测方法以伪造生成过程中在空域或频域留下的伪影为线索，通过挖掘这些伪影来区分真实与伪造人脸。然而随着人脸伪造生成技术的快速发展和具有针对性的精细化处理，这些线索逐渐被消除，从而导致了这些人脸伪造视频的检测方法的失效。在本实施例中，使用OpenFace开源工具库从目标人物的原始人脸视频和人脸伪造视频中提取特征，以获取对应的多变量时间序列，用于人脸伪造视频检测模型学习目标人物说话时表现出的特定面部和头部运动模式来区分真实与伪造人脸，提高模型对精细化处理样本的抵抗能力，具体地，提取特征包括跟踪原始人脸视频和人脸伪造视频每一帧的面部运动单元数据、视线估计数据以及头部运动数据。步骤S103，将多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型。具体地，双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。空域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；以及通过顺序连接的多个编码器，基于非线性激活后的多变量时间序列，提取得到目标人物说话模式特征，在空域分支网络的每个编码器中，对非线性激活后的多变量时间序列进行多头自注意力计算，然后通过前馈网络获取目标人物说话模式特征；时域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；通过位置编码器，对非线性激活后的多变量时间序列进行位置编码；以及通过顺序连接的多个编码器，基于经过位置编码后的多变量时间序列获取视频时间相关性特征，在时域分支网络的每个编码器中，对经过位置编码后的特定数据进行带掩码的多头注意力计算，然后通过前馈网络获取视频时间相关性特征。根据本实施例的方法所提取的特征不依赖于伪影细节特征，不受反复压缩的影响，鲁棒性更好。图2示出了根据本发明另一实施例的人脸伪造视频检测模型的训练方法的流程示意图。如图2所示，该方法包括以下步骤：步骤S201，收集目标人物的原始人脸视频。根据训练需求确定目标人物，基于确定的目标人物从网络收集目标人物的原始人脸视频，并对目标人物的原始人脸视频进行预处理，例如使用SceneDetecte、FFMPEG开源数据库对收集的目标人物的原始人脸视频进行预处理，以获取目标人物的原始人脸视频的视频数据，其中，对目标人物的原始人脸视频的预处理包括视频场景分割、视频切割等，具体的预处理方式不做限定。步骤S202，基于原始人脸视频，生成人脸伪造视频。根据目标人物的不同确定是否需要生成人脸伪造视频，若网络上存在目标人物的大量人脸伪造视频，则可基于网络直接下载目标人物的人脸伪造视频，若网络上不存在目标人物的人脸伪造视频，则需要基于原始人脸视频生成人脸伪造视频。基于原始人脸视频，截取原始人脸视频中的人物的面部区域。本实施例中，使用Dlib开源工具库对原始人脸视频进行人脸检测，获取原始人脸视频帧中的人脸区域框坐标，其中x、y、w、h分别代表了人脸区域框的左上角坐标、区域的长度和高度。在本实施例中，在保持区域框中心不变的前提下，将人脸区域框的长和宽分别扩大了一倍，得到新的人脸区域框坐标，根据新的人脸区域框坐标在原始人脸视频帧的基础上截取出人脸区域，以确保人脸区域框包含整个人物的头部，使得OpenFace提取的运动信息更加精准。具体地，生成人脸伪造视频的方法包括面部替换、唇音同步和/或表情动作迁移。本实施例中，将目标人物的面部替换到其各自的模仿者的面部区域，生成目标人物的面部替换类型的人脸伪造视频；篡改目标人物原始人脸视频的唇部，生成目标人物的唇音同步类型的人脸伪造视频；使用源视频驱动目标人物原始视频的面部表情和头部动作，以生成目标人物的表情动作迁移类型的人脸伪造视频。最终得到每位目标人物各个类型预定数量的人脸伪造视频数据。本实施例的生成人脸伪造视频的方法仅是示例性的，本领域技术人员可根据需求选择生成人脸伪造视频的任何方法。步骤S203，分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列。步骤S204，将多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型，其中，双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。根据本实施例的方法所提取的特征不依赖于伪影细节特征，不受反复压缩的影响，鲁棒性更好步骤S203-步骤204与步骤S102-步骤103的具体执行过程类似，在此不再赘述。图3示出了根据本发明实施例的人脸伪造视频检测模型的训练方法的示意图。如图3所示，首先从网络上搜集目标人物的原始人脸视频，原始人脸视频中包括目标人物的全部面部特征且目标人物面向镜头，使用SceneDetecte开源工具库对所收集的原始人脸视频进行场景镜头分割，挑选出镜头长度不小于300帧且符合上述要求的原始人脸视频片段，利用FFMPEG工具库对挑选出的符合要求的原始人脸视频进行等长度分割，使用滑动窗口的方法对原始人脸视频进行等长度和等间隔的滑动分割处理，其中窗口长度为与滑动步伐可分别设置为300帧和50帧，得到目标人物的10000个长度为300帧的原始人脸视频。需要注意的是，镜头长度的帧数、窗口长度的帧数、滑动步伐的帧数、原始人脸视频的个数均可根据具体情况灵活设定。基于上述原始人脸视频，截取原始人脸视频中的人物的面部区域，本实施例中，使用Dlib开源工具库对原始视频进行人脸检测，获取原始人脸视频的视频帧中的人脸区域框坐标，其中x、y、w、h分别代表了人脸区域框的左上角坐标、区域的长度和高度。在保持区域框中心不变的前提下，将原始人脸视频中的人脸区域框的长和宽分别扩大了一倍，得到新的人脸区域框坐标，根据新的坐标在原始人脸视频帧的基础上截取出人脸区域。将目标人物的原始视频按照以上方法进行逐帧处理后，即可得到目标人物的原始人脸区域视频以用于生成对应的人脸伪造视频。本实施例中使用FaceSwap算法，将目标人物的脸替换到其各自的模仿者的面部区域，生成目标人物的面部替换类型人脸伪造视频；从网络数据集收集若干个音频数据，并使用Wav2Lip算法，以这些音频为驱动源篡改目标人物的原始人脸视频的唇部，生成目标人物的唇音同步类型人脸伪造视频；使用FOMM算法，使用源视频驱动目标人物的原始人脸视频的面部表情和头部动作，以生成目标人物的表情动作迁移类型人脸伪造视频，最终得到了目标人物的各个类型的预定数量的人脸伪造视频数据。本实施例的生成人脸伪造视频的方法仅是示例性的，本领域技术人员可根据需求选择生成人脸伪造视频的任何方法。针对现有技术中精细化处理导致人脸伪造检测方法失效的问题，本实施例使用OpenFace开源工具库从目标人物的原始人脸视频和人脸伪造视频中提取面部运动单元、视线估计、头部运动等数据，用于人脸伪造视频检测模型学习目标人物说话时表现出的特定面部和头部运动模式来区分真实与伪造人脸，提高模型对精细化处理样本的抵抗能力。具体地，跟踪目标人物地原始人脸视频和人脸伪造视频地视频中每一帧的头部姿势、视线估计和面部动作单元等多个变量的数据，其中，包括17个AU单元、6个头部三维姿态估计和8个视线三维估计，共31个变量的多变量时间序列数据，并生成一个CSV文件存储上述数据。其中OpenFace开源工具库提取的具体数据变量如表1所示：表1人脸伪造视频经过多重压缩处理会抹除其面部的一些细节和伪影，致使在高质量人脸伪造视频上训练的人脸伪造检测器在经过反复压缩的人脸伪造视频上表现不佳；其次随着人脸伪造生成技术的不断完善和人脸伪造方法的多变，导致目前的人脸伪造检测方法普遍存在泛化能力不足的问题。为了增强所提方法对多重压缩视频的鲁棒性和对方法多变的泛化能力，本实施例设计了一种双流神经网络。双流神经网络包含空域分支网络和时域分支网络，其中，空域分支网络用于从目标人物的原始人脸视频和人脸伪造视频中分别提取目标人物的说话模式特征，时域分支网络用于从目标人物的原始人脸视频和人脸伪造视频中分别提取视频时间相关性特征。根据本实施例的方法所提取的特征不依赖于伪影细节特征，不受反复压缩的影响，鲁棒性更好。图4示出了根据本发明实施例的基于空域分支网络提取目标人物说话模式特征的示意图。如图4所示，将现有技术中的线性嵌入更改为全连接层和非线性激活并取消了现有技术中神经网络的位置编码器，由于空域分支网络用于计算各变量之间的相关性，而不关注每个变量之间的位置关系；因此，本实施例的空域分支网络不包括现有技术中的神经网络的解码器部分，只包括编码器部分以用于变量相关性特征提取，在本实施例中，编码器的数量设置为8，编码的具体数量可根据需求具体设置，在此不做限制。本实施例的神经网络取消了现有神经网络的位置编码器，结构更简洁，有效地节省资源。本实施例的空域分支网络由一个非线性嵌入层和8个相同的编码器按顺序连接组成。具体计算步骤如下：在空域分支网络中输入维度为31×300多变量时间序列，嵌入层将输入数据中的每个变量作为一个整体，经过全连接层的投影和ReLU函数激活，31个变量序列数据并行处理，嵌入层的输入大小是300，输出大小是统一的512，其公式为：X’＝ReLU基于公式，输入X维度为31×300，经过嵌入层的非线性映射得到维度为31×512的X’。输入数据经过嵌入层的非线性投影后被送入后面的编码器中提取变量相关性信息，8个编码器依次按照顺序连接，前一个编码器的输出作为后一个编码器的输入，其公式为：Outputi＝Encoderi其中Outputi、Outputi-1分别表示第i和i-1个编码器的输出，每个编码器的输出大小为512，Encoderi表示第i个编码器的运算。在本实施例中，每个编码器包括两部分，第一部分为多头自注意力机制，第二部分为由全连接层组成的前馈网络。每个部分都采用残差连接方式并在后面添加一个标准化层，且每个部分的输入和输出大小都与嵌入层的输出保持一致为512。单个编码器的具体计算步骤如下所示：首先输入一个特征F，进行多头自注意力计算。使用三个不同的参数矩阵W将特征F线性投影到三个不同的隐空间，得到Q、K、V三个不同键值。计算公式为：Q＝F·WQK＝F·WKV＝F·WV与单头自注意力计算不同，多头自注意力机制在K、Q、V的每一个投影上，并行执行自注意力函数，得到每个自注意力头的自注意力值headi。计算公式为：其中，Attention计算公式为：在得到每个头的自注意力值后，使用残差连接每个头的输出并再次进行线性投影，得到计算的最终值，多头自注意力计算公式为：MutiHead＝ConcatWO特征F经过多头自注意力计算得到的最终值再与特征F进行残差连接，并通过标准化层进行标准化处理，得到新的特征F’，计算公式如下：F’＝Normalization)然后，F’再经过第二部分的全连接层部分，通过两层全连接层对F’进一步的映射激活后进行残差连接和标准化处理，得到空域网络分支的输出F”。第二部分的计算公式为：图5示出了根据本发明实施例的基于时域分支网络的提取视频时间相关性特征的示意图。如图5所示，时域分支网络包括全连接层加非线性激活结构，激活函数为ReLU函数，且与空域分支网络的嵌入层参数共享。时域分支网络的嵌入层以每一帧的各个变量数据作为整体输入嵌入层进行非线性投影，嵌入层的输入尺寸为31，输出尺寸为512，输入X维度为300×31，经过嵌入层的非线性映射得到维度为300×512的X’。如图5所示，本实施例的时域分支网络还包括位置编码模块，本实施例使用不同频率的正弦Sine函数和余弦Cosine函数对不同帧的嵌入进行位置编码，公式如下：其中i为帧号。在本实施例中，使用带掩码的多头注意力机制，在计算前i帧数据间的注意力值时屏蔽后续帧的影响。带掩码的多头注意力机制与位置编码器配合，确保了某一个位置的预测只能依赖于这个位置之前帧的已知输出，有效地提高了检测的精度。在空域分支网络和时域分支网络分别提取目标人物的说话模式特征和视频时间相关性特征后，融合目标人物的说话模式特征和视频时间相关性特征，融合后的特征尺寸与目标人物的说话模式特征和视频时间相关性特征保持一致，为512。将融合的特征依次送入后续的全连接神经网络层和全连接层进一步压缩成尺寸为2的具有分辨性的特征表示为f，最后使用归一化函数进行分类，即可得到最终结果。构建面向目标人物的人脸伪造检测的深度网络，在预先构建的训练集上进行训练。在训练时使用的loss函数采用交叉熵损失函数，公式为：具体训练步骤为：根据需求收集目标人物的原始人脸视频和人脸伪造视频数据；使用OpenFace开源工具库提取目标人物的原始人脸视频和人脸伪造视频的面部动作单元、视线估计、头部运动数据，并保存至CSV文件中；将上述提取的数据训练人脸伪造视频检测模型。根据本实施例的人脸伪造视频检测模型的训练方法，设计了一种包含空域分支网络和时域分支网络的双流神经网络，通过空域分支网络学习目标人物说话模式特征，能有效地降低检测模型对待检测视频质量的要求，提高对多重压缩待检测视频的鲁棒性；通过时域分支网络挖掘视频时间相关性特征，不关注特定的伪影细节，增强检测模型对不同人脸伪造方法的泛化能力，此外，由于本实施例提供的方法不关注特定的伪影信息，因此适用于所有类型的人脸伪造视频的检测，并且对数据集外的人脸伪造视频数据也能保持良好的泛化性。图6示出了根据本发明实施例的人脸伪造视频的检测方法的流程示意图。如图6所示，该方法包括以下步骤：步骤S301，获取待检测的人脸视频。根据检测需求确定目标人物，基于确定的目标人物从网络收集目标人物的人脸视频，并对目标人物的人脸视频进行预处理。步骤S302，从待检测的人脸视频中提取特征，得到对应的多变量时间序列。在本实施例中，使用OpenFace开源工具库从目标人物的人脸视频中提取特征，以获取对应的多变量时间序列，具体地，提取特征包括跟踪目标人物的人脸视频每一帧的面部运动单元数据、视线估计数据以及头部运动数据。步骤S303，将多变量时间序列输入至人脸伪造视频检测模型，得到待检测的人脸视频的检测结果；其中，人脸伪造视频检测模型是根据上述提供的人脸伪造视频检测模型的训练方法而得到。根据本发明实施例的人脸伪造视频的检测方法不关注特定的伪影信息，因此适用于所有类型的人脸伪造视频的检测，并且对数据集外的人脸伪造视频数据也能保持良好的泛化性。图7示出了根据本发明实施例的人脸伪造视频检测模型的训练装置的结构示意图。如图7所示，该训练装置包括：视频收集模块410、第一特征提取模块420以及训练模块430。视频收集模块410，适于收集目标人物的原始人脸视频和人脸伪造视频；第一特征提取模块420，适于分别从原始人脸视频和人脸伪造视频中提取特征，得到对应的多变量时间序列；以及训练模块430，适于将多变量时间序列作为训练数据，基于双流神经网络进行训练，得到人脸伪造视频检测模型；其中，双流神经网络包含：用于提取得到目标人物说话模式特征的空域分支网络、用于提取视频时间相关性特征的时域分支网络、以及用于将目标人物说话模式特征和视频时间相关性特征进行融合并进行预测的预测层。可选地，第一特征提取模块420进一步适于：分别跟踪原始人脸视频和人脸伪造视频每一帧的面部运动单元数据、视线估计数据以及头部运动数据，得到对应的多变量时间序列。可选地，空域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；以及通过顺序连接的多个编码器，基于非线性激活后的多变量时间序列，提取得到目标人物说话模式特征；其中，在每个编码器中，对非线性激活后的多变量时间序列进行多头自注意力计算，然后通过前馈网络获取目标人物说话模式特征。可选地，时域分支网络用于：将多变量时间序列通过全连接层进行投影并通过非线性激活函数进行非线性激活；通过位置编码器，对非线性激活后的多变量时间序列进行位置编码；以及通过顺序连接的多个编码器，基于经过位置编码后的多变量时间序列获取视频时间相关性特征；其中，在每个编码器中，对经过位置编码后的特定数据进行带掩码的多头注意力计算，然后通过前馈网络获取视频时间相关性特征。可选地，视频收集模块410进一步适于：收集目标人物的原始人脸视频；基于原始人脸视频，生成人脸伪造视频，其中，生成人脸伪造视频的方法包括面部替换、唇音同步和/或表情动作迁移。根据本实施例的人脸伪造视频检测模型的训练装置，设计了一种包含空域分支网络和时域分支网络的双流神经网络，通过空域分支网络学习目标人物说话模式特征，能有效地降低检测模型对待检测视频质量的要求，提高对多重压缩待检测视频的鲁棒性；通过时域分支网络挖掘视频时间相关性特征，不关注特定的伪影细节，增强检测模型对不同人脸伪造方法的泛化能力，此外，由于本实施例提供的训练装置不关注特定的伪影信息，因此适用于所有类型的人脸伪造视频的检测，并且对数据集外的人脸伪造视频数据也能保持良好的泛化性。图8示出了根据本发明实施例的人脸伪造视频的检测装置的结构示意图。如图8所示，该训练装置包括：视频获取模块510、第二特征提取模块520以及检测模块530。视频获取模块510，适于获取待检测的人脸视频；第二特征提取模块520，适于从待检测的人脸视频中提取特征，得到对应的多变量时间序列；以及检测模块530，适于将多变量时间序列输入至人脸伪造视频检测模型，得到待检测的人脸模型的检测结果；其中，人脸伪造视频检测模型是根据第一方面提供的人脸伪造视频检测模型的训练方法而得到。根据本发明实施例的人脸伪造视频的检测装置不关注特定的伪影信息，因此适用于所有类型的人脸伪造视频的检测，并且对数据集外的人脸伪造视频数据也能保持良好的泛化性。本发明实施例提供了一种非易失性计算机存储介质，计算机存储介质存储有至少一可执行指令，该计算机可执行指令可执行上述任意方法实施例中的人脸伪造视频检测模型的训练方法或人脸伪造视频的检测方法。图9示出了根据本发明实施例的一种计算设备的结构示意图，本发明具体实施例并不对计算设备的具体实现做限定。如图9所示，该计算设备可以包括：处理器602、通信接口604、存储器606、以及通信总线608。其中：处理器602、通信接口604、以及存储器606通过通信总线608完成相互间的通信。通信接口604，用于与其它设备比如客户端或其它服务器等的网元通信。处理器602，用于执行程序610，具体可以执行上述方法实施例中的相关步骤。具体地，程序610可以包括程序代码，该程序代码包括计算机操作指令。处理器602可能是中央处理器CPU，或者是特定集成电路ASIC，或者是被配置成实施本发明实施例的一个或多个集成电路。计算设备包括的一个或多个处理器，可以是同一类型的处理器，如一个或多个CPU；也可以是不同类型的处理器，如一个或多个CPU以及一个或多个ASIC。存储器606，用于存放程序610。存储器606可能包含高速RAM存储器，也可能还包括非易失性存储器，例如至少一个磁盘存储器。程序610具体可以用于使得处理器602执行上述任意方法实施例中的移动终端设备流量的预测方法。程序610中各步骤的具体实现可以参见上述移动终端设备流量的预测实施例中的相应步骤和单元中对应的描述，在此不赘述。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的设备和模块的具体工作过程，可以参考前述方法实施例中的对应过程描述，在此不再赘述。在此提供的算法和显示不与任何特定计算机、虚拟系统或者其它设备固有相关。各种通用系统也可以与基于在此的示教一起使用。根据上面的描述，构造这类系统所要求的结构是显而易见的。此外，本申请实施例也不针对任何特定编程语言。应当明白，可以利用各种编程语言实现在此描述的本申请实施例的内容，并且上面对特定语言所做的描述是为了披露本申请实施例的最佳实施方式。在此处所提供的说明书中，说明了大量具体细节。然而，能够理解，本申请实施例可以在没有这些具体细节的情况下实践。在一些实例中，并未详细示出公知的方法、结构和技术，以便不模糊对本说明书的理解。类似地，应当理解，为了精简本公开并帮助理解各个发明方面中的一个或多个，在上面对本申请实施例的示例性实施例的描述中，本申请实施例的各个特征有时被一起分组到单个实施例、图、或者对其的描述中。然而，并不应将该公开的方法解释成反映如下意图：即所要求保护的本申请实施例要求比在每个权利要求中所明确记载的特征更多的特征。更确切地说，如下面的权利要求书所反映的那样，发明方面在于少于前面公开的单个实施例的所有特征。因此，遵循具体实施方式的权利要求书由此明确地并入该具体实施方式，其中每个权利要求本身都作为本申请实施例的单独实施例。本领域那些技术人员可以理解，可以对实施例中的设备中的模块进行自适应性地改变并且把它们设置在与该实施例不同的一个或多个设备中。可以把实施例中的模块或单元或组件组合成一个模块或单元或组件，以及此外可以把它们分成多个子模块或子单元或子组件。除了这样的特征和/或过程或者单元中的至少一些是相互排斥之外，可以采用任何组合对本说明书中公开的所有特征以及如此公开的任何方法或者设备的所有过程或单元进行组合。除非另外明确陈述，本说明书中公开的每个特征可以由提供相同、等同或相似目的的替代特征来代替。此外，本领域的技术人员能够理解，尽管在此所述的一些实施例包括其它实施例中所包括的某些特征而不是其它特征，但是不同实施例的特征的组合意味着处于本申请实施例的范围之内并且形成不同的实施例。例如，在下面的权利要求书中，所要求保护的实施例的任意之一都可以以任意的组合方式来使用。本申请实施例的各个部件实施例可以以硬件实现，或者以在一个或者多个处理器上运行的软件模块实现，或者以它们的组合实现。本领域的技术人员应当理解，可以在实践中使用微处理器或者数字信号处理器来实现根据本申请实施例中的一些或者全部部件的一些或者全部功能。本申请实施例还可以实现为用于执行这里所描述的方法的一部分或者全部的设备或者装置程序。这样的实现本申请实施例的程序可以存储在计算机可读介质上，或者可以具有一个或者多个信号的形式。这样的信号可以从因特网网站上下载得到，或者在载体信号上提供，或者以任何其他形式提供。应该注意的是上述实施例对本申请实施例进行说明而不是对本申请实施例进行限制，并且本领域技术人员在不脱离所附权利要求的范围的情况下可设计出替换实施例。在权利要求中，不应将位于括号之间的任何参考符号构造成对权利要求的限制。单词“包含”不排除存在未列在权利要求中的元件或步骤。位于元件之前的单词“一”或“一个”不排除存在多个这样的元件。本申请实施例可以借助于包括有若干不同元件的硬件以及借助于适当编程的计算机来实现。在列举了若干装置的单元权利要求中，这些装置中的若干个可以是通过同一个硬件项来具体体现。单词第一、第二、以及第三等的使用不表示任何顺序。可将这些单词解释为名称。
