标题title
地图模型构建方法及终端
摘要abst
本发明提供一种地图模型构建方法及终端，地图模型构建方法包括：获取目标区域对应的正射影像图和数字表面模型；对正射影像图中的各像素进行类别检测，得到各像素对应的检测类别；基于各像素对应的像素类别，确定各检测类别对应的连通域；将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息；基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型。本申请通过对目标区域的正射影像图中包含的地物的位置进行检测，基于各连通域映射在数字表面模型中的区域数据，确定连通域对应的地物的高度信息，进而构建目标区域的地图模型，提高了地图模型的精确度。
权利要求书clms
1.一种地图模型构建方法，其特征在于，所述地图模型构建方法包括：获取目标区域对应的正射影像图和数字表面模型；对所述目标区域的正射影像图中的各像素进行类别检测，得到各所述像素对应的检测类别；基于所述正射影像图中各所述像素对应的像素类别，确定所述目标区域中各所述检测类别对应的连通域；将各所述连通域在所述正射影像图中的位置映射至所述数字表面模型，确定各所述连通域的高度信息；基于所述连通域的高度信息以及各所述连通域在所述正射影像图中的位置，构建所述目标区域的地图模型。2.根据权利要求1所述的地图模型构建方法，其特征在于，所述获取目标区域对应的正射影像图和数字表面模型，包括：获取图像序列，所述图像序列包括多张针对所述目标区域采集的视频帧，所述视频帧中包含有目标；对所述图像序列中的所有所述视频帧进行拼接处理，得到所述目标区域对应的所述正射影像图和所述数字表面模型；所述正射影像图和所述数字表面模型的尺寸相同。3.根据权利要求2所述的地图模型构建方法，其特征在于，所述获取图像序列，所述图像序列包括多张针对所述目标区域采集的视频帧，包括：在所述目标区域布控标定位置；对所述目标区域进行图像采集，得到多张针对所述目标区域的视频帧；所述对所述图像序列中的所有所述视频帧进行拼接处理，得到所述目标区域的正射影像图和数字表面模型的在步骤之后，还包括：基于同一所述标定位置在各所述视频帧中的位置，对所述正射影像图和所述数字表面模型分别进行校正。4.根据权利要求1所述的地图模型构建方法，其特征在于，所述对所述目标区域的正射影像图中的各像素进行类别检测，得到各所述像素对应的检测类别，包括：对所述正射影像图进行裁剪处理，得到多张预设尺寸的正射影像子图；通过地物要素识别模型对所述正射影像子图中的各所述像素进行类别检测，得到各所述像素对应的所述检测类别；其中，所述地物要素识别模型包括依次级联的编码模块、特征增强模块和解码模块；将各所述正射影像子图中各所述像素的检测类别作为所述正射影像图中对应位置的所述像素的检测类别。5.根据权利要求4所述的地图模型构建方法，其特征在于，所述通过地物要素识别模型对所述正射影像子图中的各所述像素进行类别检测，得到各所述像素对应的所述检测类别，包括：通过所述编码模块对所述正射影像子图中的各所述像素进行特征提取，得到像素特征图；通过所述特征增强模块对所述像素特征图进行特征提取，得到目标特征图；通过所述解码模块对所述像素对应的所述目标特征图进行特征融合，得到融合特征图；基于所述像素对应的所述融合特征图，确定所述像素的检测类别。6.根据权利要求5所述的地图模型构建方法，其特征在于，所述编码模块包括多个依次级联的第一特征提取单元，第一个所述第一特征提取单元包括依次级联的线性编码层和第一特征提取层，其他所述第一特征提取单元包括依次级联的块图拼接层和第二特征提取层；所述通过所述编码模块对所述正射影像子图中的各所述像素进行特征提取，得到像素特征图，包括：通过所述线性编码层将所述正射影像子图中的各所述像素转化为一维数据，得到各像素对应的一维特征；通过所述第一特征提取层对所述像素的一维特征进行特征提取，得到第一特征图；通过所述块图拼接层对所述像素的第一特征图进行拼接融合，得到合并特征图；通过所述第二特征提取层对应所述像素的合并特征图进行特征提取，得到所述像素特征图，所述像素特征图的尺寸小于所述第一特征图。7.根据权利要求6所述的地图模型构建方法，其特征在于，所述特征增强模块包括多个依次级联的第二特征提取单元，所述通过所述特征增强模块对所述像素特征图进行特征提取，得到目标特征图，包括：通过第一个所述第二特征提取单元对所述像素特征图进行特征提取并进行上采样，得到第三特征图；通过第二个所述第二特征提取单元对所述第三特征图和所述第一特征图进行特征融合，得到第四特征图；所述第三特征图与所述第一特征图的尺寸相同；通过第二个所述第二特征提取单元对所述第四特征图进行特征提取，得到所述目标特征图；所述通过所述解码模块对所述像素对应的所述目标特征图进行特征融合，得到融合特征图，包括：通过所述解码模块将所述第三特征图、所述第四特征图和所述目标特征图插值到同一尺寸并进行特征融合，得到融合特征图。8.根据权利要求1所述的地图模型构建方法，其特征在于，所述基于所述正射影像图中各所述像素对应的像素类别，确定所述目标区域中各所述检测类别对应的连通域，包括：遍历所有所述检测类别，选取一所述检测类别作为目标类别；将所述正射影像图中所述目标类别对应的所有所述像素均赋值为第一标识符；基于所述第一标识符对应的所有所述像素，确定所述目标类别对应的连通域信息，所述连通域信息包括所述连通域。9.根据权利要求8所述的地图模型构建方法，其特征在于，所述检测类别至少包括道路线类别和待检测类别；所述道路线类别为道路线的检测类别，所述待检测类别为待检测目标的检测类别；所述将各所述连通域在所述正射影像图中的位置映射至所述数字表面模型，确定各所述连通域的高度信息，包括：将所述道路线类别对应的所述连通域在所述正射影像图中的位置映射至所述数字表面模型，确定所述道路线对应的第一高度值；将所述待检测类别对应的所述连通域在所述正射影像图中的位置映射至所述数字表面模型，确定所述待检测目标对应的第二高度值；基于所述第一高度值和所述第二高度值的差值，确定所述待检测目标的高度信息。10.根据权利要求9所述的地图模型构建方法，其特征在于，所述将各所述连通域在所述正射影像图中的位置映射至所述数字表面模型，确定各所述连通域的高度信息，还包括：将所述待检测目标的高度信息与对应的所述连通域包含的所有所述像素进行关联。11.根据权利要求9所述的地图模型构建方法，其特征在于，所述连通域信息还包括连通域编号、外接矩形框以及所述检测类别对应的连通域总数；所述将所述待检测类别对应的所述连通域在所述正射影像图中的位置映射至所述数字表面模型，确定所述待检测目标对应的第二高度值，包括：响应于所述连通域的连通域编号不大于所述连通域对应的所述检测类别的连通域总数，则将所述连通域的外接矩形框中所述连通域对应所述像素均赋值为1，将所述外接矩形框中除所述连通域的其他所述像素均赋值为0；将所述外接矩形框中各所述像素的赋值乘以所述数字表面模型中对应位置的数值得到各所述像素对应的高度值；基于所述外接矩形框中所述连通域对应的所有所述像素的高度值，确定所述连通域对应的所述待检测目标的第二高度值。12.根据权利要求11所述的地图模型构建方法，其特征在于，所述基于所述外接矩形框中所述连通域对应的所有所述像素的高度值，确定所述连通域对应的所述待检测目标的第二高度值，包括：将所述外接矩形框中所述连通域对应的所有所述像素的高度值的平均值，作为所述连通域对应的所述待检测目标的第二高度值。13.根据权利要求1所述的地图模型构建方法，其特征在于，所述基于所述连通域的高度信息以及各所述连通域在所述正射影像图中的位置，构建所述目标区域的地图模型，包括：对所述正射影像图中各所述像素对应的检测类别和各所述连通域对应的高度信息进行矢量化处理，分别生成所述连通域的轮廓线；所述连通域对应的所述轮廓线具有数据类型，所述数据类型包括点数据、线数据和面数据；所述轮廓线所包含的轮廓点的坐标位置属于球形坐标系；响应于所述连通域对应的所述数据类型为所述面数据，则将所述连通域对应的所述轮廓线中各所述轮廓点在球形坐标系中的坐标位置转换为在平面坐标系中的平面坐标位置；基于所述连通域中各所述轮廓点的平面坐标位置以及所述连通域的高度信息，构建所述目标区域的地图模型。14.根据权利要求13所述的地图模型构建方法，其特征在于，所述基于所述连通域中各所述轮廓点的平面坐标位置以及所述连通域的高度信息，构建所述目标区域的地图模型，包括：基于所述连通域中各所述轮廓点的平面坐标位置进行底面建模，生成底面模型；基于所述轮廓点的平面坐标位置和所述连通域对应的高度信息，确定顶点轮廓点的平面坐标位置；基于所述顶点轮廓点的平面坐标位置进行顶面建模，生成顶面模型；基于所述轮廓点和所述顶点轮廓点进行侧面建模，生成侧面模型；将所述底面模型、所述顶面模型和所述侧面模型进行合并，得到所述目标区域的地图模型。15.一种终端，其特征在于，所述终端包括存储器、处理器以及存储于所述存储器中并在所述处理器上运行的计算机程序，所述处理器用于执行程序数据以实现如权利要求1~14任一项所述的地图模型构建方法中的步骤。
说明书desc
技术领域本发明涉及图像识别技术领域，特别是涉及一种地图模型构建方法及终端。背景技术城市道路交叉路口是城市道路中环境最复杂、参与者最多、问题状况最频繁的交通场景。它是道路交通系统的节点和枢纽，承担了大量交通流量，交叉路口的畅通程度直接影响交通通行能力。基于高精度地图、智能摄像头与雷视融合路面感知系统部署的全息路口可以实时计算路口的车辆位置、速度、轨迹、行驶姿态、车辆属性、车道占有率、平均车速、车辆排队长度、斑马线状态等多种数据进行智能分析，并形成交通流量热力图，从而可以及时开展交通信号灯控制和调整信号时长的工作，提高交通运转效率，缓解交通阻塞。而高精度地图作为全息路口的底图是打开是实景路口全息视角的关键所在，其一方面能更加清晰地描绘出公里模型，另一方面能更加精准地反映出每条车道的实时路况。目前高精度数据采集包括移动测车采集、1:500地形图测绘和无人机航测三种方法。移动测绘车需要搭载激光雷达、惯导、实时动态、全景相机等传感器设备，集成造价高，采集成本高；1:500地形图测绘，需要控制网布设、外业测绘和内业编绘等大量工作，工作周期长；而无人机航测是采集成本较低，处理速度较快的一种方法，但是目前无人机航测得到的全息路口地图模型的精确度不佳。发明内容本发明主要解决的技术问题是提供一种地图模型构建方法及终端，解决现有技术中构建的地图模型精确度比较低的问题。为解决上述技术问题，本发明采用的第一个技术方案是：提供一种地图模型构建方法，地图模型构建方法包括：获取目标区域对应的正射影像图和数字表面模型；对目标区域的正射影像图中的各像素进行类别检测，得到各像素对应的检测类别；基于正射影像图中各像素对应的像素类别，确定目标区域中各检测类别对应的连通域；将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息；基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型。其中，获取目标区域对应的正射影像图和数字表面模型，包括：获取图像序列，图像序列包括多张针对目标区域采集的视频帧，视频帧中包含有目标；对图像序列中的所有视频帧进行拼接处理，得到目标区域对应的正射影像图和数字表面模型；正射影像图和数字表面模型的尺寸相同。其中，获取图像序列，图像序列包括多张针对目标区域采集的视频帧，包括：在目标区域布控标定位置；对目标区域进行图像采集，得到多张针对目标区域的视频帧；对图像序列中的所有视频帧进行拼接处理，得到目标区域的正射影像图和数字表面模型的在步骤之后，还包括：基于同一标定位置在各视频帧中的位置，对正射影像图和数字表面模型分别进行校正。其中，对目标区域的正射影像图中的各像素进行类别检测，得到各像素对应的检测类别，包括：对正射影像图进行裁剪处理，得到多张预设尺寸的正射影像子图；通过地物要素识别模型对正射影像子图中的各像素进行类别检测，得到各像素对应的检测类别；其中，地物要素识别模型包括依次级联的编码模块、特征增强模块和解码模块；将各正射影像子图中各像素的检测类别作为正射影像图中对应位置的像素的检测类别。其中，通过地物要素识别模型对正射影像子图中的各像素进行类别检测，得到各像素对应的检测类别，包括：通过编码模块对正射影像子图中的各像素进行特征提取，得到像素特征图；通过特征增强模块对像素特征图进行特征提取，得到目标特征图；通过解码模块对像素对应的目标特征图进行特征融合，得到融合特征图；基于像素对应的融合特征图，确定像素的检测类别。其中，编码模块包括多个依次级联的第一特征提取单元，第一个第一特征提取单元包括依次级联的线性编码层和第一特征提取层，其他第一特征提取单元包括依次级联的块图拼接层和第二特征提取层；通过编码模块对正射影像子图中的各像素进行特征提取，得到像素特征图，包括：通过线性编码层将正射影像子图中的各像素转化为一维数据，得到各像素对应的一维特征；通过第一特征提取层对像素的一维特征进行特征提取，得到第一特征图；通过块图拼接层对像素的第一特征图进行拼接融合，得到合并特征图；通过第二特征提取层对应像素的合并特征图进行特征提取，得到像素特征图，像素特征图的尺寸小于第一特征图。其中，特征增强模块包括多个依次级联的第二特征提取单元，通过特征增强模块对像素特征图进行特征提取，得到目标特征图，包括：通过第一个第二特征提取单元对像素特征图进行特征提取并进行上采样，得到第三特征图；通过第二个第二特征提取单元对第三特征图和第一特征图进行特征融合，得到第四特征图；第三特征图与第一特征图的尺寸相同；通过第二个第二特征提取单元对第四特征图进行特征提取，得到目标特征图。其中，通过解码模块对像素对应的目标特征图进行特征融合，得到融合特征图，包括：通过解码模块将第三特征图、第四特征图和目标特征图插值到同一尺寸并进行特征融合，得到融合特征图。其中，基于正射影像图中各像素对应的像素类别，确定目标区域中各检测类别对应的连通域，包括：遍历所有检测类别，选取一检测类别作为目标类别；将正射影像图中目标类别对应的所有像素均赋值为第一标识符；基于第一标识符对应的所有像素，确定目标类别对应的连通域信息，连通域信息包括连通域。其中，检测类别至少包括道路线类别和待检测类别；道路线类别为道路线的检测类别，待检测类别为待检测目标的检测类别；将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息，包括：将道路线类别对应的连通域在正射影像图中的位置映射至数字表面模型，确定道路线对应的第一高度值；将待检测类别对应的连通域在正射影像图中的位置映射至数字表面模型，确定待检测目标对应的第二高度值；基于第一高度值和第二高度值的差值，确定待检测目标的高度信息。其中，将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息，还包括：将待检测目标的高度信息与对应的连通域包含的所有像素关联。其中，连通域信息还包括连通域编号、外接矩形框以及检测类别对应的连通域总数；将待检测类别对应的连通域在正射影像图中的位置映射至数字表面模型，确定待检测目标对应的第二高度值，包括：响应于连通域的连通域编号不大于连通域对应的检测类别的连通域总数，则将连通域的外接矩形框中连通域对应像素均赋值为1，将外接矩形框中除连通域的其他像素均赋值为0；将外接矩形框中各像素的赋值乘以数字表面模型中对应位置的数值得到各像素对应的高度值；基于外接矩形框中连通域对应的所有像素的高度值，确定连通域对应的待检测目标的第二高度值。其中，基于外接矩形框中连通域对应的所有像素的高度值，确定连通域对应的待检测目标的第二高度值，包括：将外接矩形框中连通域对应的所有像素的高度值的平均值，作为连通域对应的待检测目标的第二高度值。其中，基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型，包括：对正射影像图中各像素对应的检测类别和各连通域对应的高度信息进行矢量化处理，分别生成连通域的轮廓线；连通域对应的轮廓线具有数据类型，数据类型包括点数据、线数据和面数据；轮廓线所包含的轮廓点的坐标位置属于球形坐标系；响应于连通域对应的数据类型为面数据，则将连通域对应的轮廓线中各轮廓点在球形坐标系中的坐标位置转换为在平面坐标系中的平面坐标位置；基于连通域中各轮廓点的平面坐标位置以及连通域的高度信息，构建目标区域的地图模型。其中，基于连通域中各轮廓点的平面坐标位置以及连通域的高度信息，构建目标区域的地图模型，包括：基于连通域中各轮廓点的平面坐标位置进行底面建模，生成底面模型；基于轮廓点的平面坐标位置和轮廓点对应的高度信息，确定顶点轮廓点的平面坐标位置；基于顶点轮廓点的平面坐标位置进行顶面建模，生成顶面模型；基于轮廓点和顶点轮廓点进行侧面建模，生成侧面模型；将底面模型、顶面模型和侧面模型进行合并，得到目标区域的地图模型。为解决上述技术问题，本发明采用的第二个技术方案是：提供一种终端，该终端包括存储器、处理器以及存储于存储器中并在处理器上运行的计算机程序，处理器用于执行程序数据以实现上述地图模型构建方法中的步骤。本发明的有益效果是：区别于现有技术的情况，提供的一种地图模型构建方法及终端，地图模型构建方法包括：获取目标区域对应的正射影像图和数字表面模型；对目标区域的正射影像图中的各像素进行类别检测，得到各像素对应的检测类别；基于正射影像图中各像素对应的像素类别，确定目标区域中各检测类别对应的连通域；将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息；基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型。本申请通过对目标区域的正射影像图中的各像素进行类别检测得到目标区域中的连通域，确定目标区域中包含的地物的位置，基于各连通域映射在数字表面模型中的区域数据，确定连通域对应的地物的高度信息，通过目标区域中包含的地物的位置信息和高度信息构建目标区域的地图模型，进而提高了构建的地图模型的精确度。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1是本发明提供的地图模型构建方法的流程示意图；图2是本发明提供的地图模型构建方法一实施例的示意图；图3是图1提供的地图模型构建方法中步骤S1一实施例的流程示意图；图4是本发明提供的目标区域的图像；图5是图1提供的地图模型构建方法中步骤S2一实施例的流程示意图；图6是本发明提供的地物要素识别模型一实施例结构示意图；图7是图1提供的地图模型构建方法中步骤S4一实施例的流程示意图；图8是图1提供的地图模型构建方法中步骤S4一具体实施例的流程示意图；图9是图1提供的地图模型构建方法中步骤S5一具体实施例的流程示意图；图10是图9提供的地图模型构建方法中步骤S53一具体实施例的流程示意图；图11是本发明提供的地图模型构建装置一实施例的框架示意图；图12是本发明提供的终端一实施例的框架示意图；图13为本发明提供的计算机可读存储介质一实施例的框架示意图。具体实施方式下面结合说明书附图，对本申请实施例的方案进行详细说明。以下描述中，为了说明而不是为了限定，提出了诸如特定系统结构、接口、技术之类的具体细节，以便透彻理解本申请。本文中术语“和/或”，仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。另外，本文中字符“/”，一般表示前后关联对象是一种“或”的关系。此外，本文中的“多”表示两个或者多于两个。为使本领域的技术人员更好地理解本发明的技术方案，下面结合附图和具体实施方式对本发明所提供的地图模型构建方法做进一步详细描述。请参阅图1和图2，图1是本发明提供的地图模型构建方法的流程示意图；图2是本发明提供的地图模型构建方法一实施例的示意图。本实施例中提供一种地图模型构建方法，该地图模型构建方法包括如下步骤。S1：获取目标区域对应的正射影像图和数字表面模型。S2：对目标区域的正射影像图中的各像素进行类别检测，得到各像素对应的检测类别。S3：基于正射影像图中各像素对应的像素类别，确定目标区域中各检测类别对应的连通域。S4：将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息。S5：基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型。请参阅图3，图3是图1提供的地图模型构建方法中步骤S1一实施例的流程示意图。具体地，步骤S1中获取目标区域对应的正射影像图和数字表面模型的步骤具体包括如下步骤。S11：获取图像序列，图像序列包括多张针对目标区域采集的视频帧，视频帧中包含有目标。具体地，在目标区域布控标定位置；对目标区域进行图像采集，得到多张针对目标区域的视频帧。本实施例中，图像序列可以是针对目标区域采集的多帧连续的视频帧，也可以是针对目标区域采集的多帧非连续的视频帧。请参阅图4，图4是本发明提供的目标区域的图像。在一具体实施例中，目标区域为道路交叉口区域，以路口为目标区域中心向外延伸200米作为目标区域，如目标区域为矩形框。在目标区域内布控标定位置，为了不影响交通，标定位置主要布控在道路边缘位置和道路交叉口，记录标定位置的实际坐标。其中，标定位置为五角星的位置。实际坐标为球形坐标系中的坐标位置。在目标区域内规划航线，如矩形框内的线。通过无人机在目标区域沿规划航线进行飞行，并持续采集目标区域内的图像。获取的多张连续的针对目标区域采集的视频帧作为视频帧。S12：对图像序列中的所有视频帧进行拼接处理，得到目标区域对应的正射影像图和数字表面模型；正射影像图和数字表面模型的尺寸相同。在一实施例中，采用Pix4D软件对图像序列中的所有视频帧进行拼接处理，输出正射影像图和数字表面模型。具体地，将图像序列中的所有视频帧输入到Pix4D软件，将Pix4D软件中的处理模块选择“3D地图”模板，输出为正射影像图、DSM影像、3D纹理和点云数据。在一具体实施例中，在Pix4D软件中新建项目，在Pix4D软件中导入图像序列包含的所有视频帧，Pix4D软件读取各视频帧中的特征信息，并获取无人机采集视频帧时的经纬度、高度和俯仰角等信息。通过Pix4D软件对图像序列中的所有视频帧进行拼接，输出目标区域对应的正射影像图和数字表面模型。数字表面模型是指包含了地表建筑物、桥梁和树木等高度的地面高程模型。其中，数字表面模型也称为DSM影像图。在一实施例中，基于同一标定位置在各视频帧中的位置，对正射影像图和数字表面模型分别进行校正。具体地，将各视频帧中的同一标定位置进行对齐重合，以使不同视频帧中的内容处于同一坐标系中，进而提高得到正射影像图中各目标的位置精确度。具体地，步骤S2中各像素对应的检测类别的步骤具体包括如下步骤。本实施例中，由于目标区域对应的正射影像图的尺寸在亿级像素以上，地物要素识别模型无法直接对正射影像图中的各像素进行类别检测。为了便于对正射影像图中的各像素进行检测，需要将正射影像图进行剪裁得到多张预设尺寸的正射影像子图。各正射影像子图具有在正射影像图中的位置信息。在一实施例中，通过地物要素识别模型对正射影像子图中的各像素进行类别检测，得到各像素对应的检测类别。检测类别为道路线类别、建筑类别、绿化带类别、人行道类别、安全岛类别、渠化岛类别、植被类别和水体类别中的一种。将各正射影像子图进行拼接得到正射影像图，将各正射影像子图中各像素的检测类别作为正射影像图中对应位置的像素的检测类别。在一实施例中，地物要素识别模型的训练步骤如下所示。获取多张预设尺寸的正射影像训练图，正射影像训练图中各像素具有对应的标注类别；通过初始网络对正射影像训练图中各像素进行类别预测，得到像素属于各预设类别的概率值；将最大概率值对应的预设类别确定为像素的预设类别；基于正射影像训练图中各像素对应的预设类别与标注类别之间的误差值对初始网络进行训练得到地物要素识别模型。预设类别包括但不限于道路线类别、建筑类别、绿化带类别、人行道类别、安全岛类别、渠化岛类别、植被类别和水体类别。请参阅图5和图6，图5是图1提供的地图模型构建方法中步骤S2一实施例的流程示意图；图6是本发明提供的地物要素识别模型一实施例结构示意图。本实施例中，地物要素识别模型包括依次级联的编码模块、特征增强模块和解码模块。其中，地物要素识别模型采用Cascade-Encoder-Decoder框架。S21：通过编码模块对正射影像子图中的各像素进行特征提取，得到像素特征图。在一实施例中，编码模块包括多个依次级联的第一特征提取单元，第一个第一特征提取单元包括依次级联的线性编码层和第一特征提取层，其他第一特征提取单元包括依次级联的块图拼接层和第二特征提取层。具体地，通过线性编码层将正射影像子图中的各像素转化为一维数据，得到各像素对应的一维特征；通过第一特征提取层对像素的一维特征进行特征提取，得到第一特征图；通过块图拼接层对像素的第一特征图进行拼接融合，得到合并特征图；通过第二特征提取层对应像素的合并特征图进行特征提取，得到像素特征图，像素特征图的尺寸小于第一特征图。在一具体实施例中，编码模块可以为Swin Transformer结构。其中，编码模块包括四个依次级联的第一特征提取单元，第一个第一特征提取单元包括依次级联的线性编码层和两个第一特征提取层，第二个第一特征提取单元包括块图拼接层和两个第二特征提取层；第三个第一特征提取单元包括块图拼接层和十八个第二特征提取层；第四个第一特征提取单元包括块图拼接层和两个第二特征提取层。其中，第一特征提取层和第二特征提取层可以是窗口的多头自注意力模块、移动窗口的多头自注意力模块或多层感知机中的一种。第一特征提取层和第二特征提取层可以相同，也可以不同。块图拼接层用于将相邻的两个原特征图进行拼接融合，并加深通道数。其中，正射影像子图的尺寸为H*W，先按照1/4的尺寸采用一层卷积将正射影像子图编码为H/4*W/4*的特征图，其中C表示输入图像的通道数。第一个第一特征提取单元输出的特征图的尺寸是正射影像子图编码后特征图的尺寸的1/4；第二个第一特征提取单元输出的特征图的尺寸是正射影像子图编码后特征图的尺寸的1/8；第三个第一特征提取单元输出的特征图的尺寸是正射影像子图编码后特征图的尺寸的1/16；第四个第一特征提取单元输出的特征图的尺寸是正射影像子图编码后特征图的尺寸的1/32。S22：通过特征增强模块对像素特征图进行特征提取，得到目标特征图。在一实施例中，特征增强模块包括多个依次级联的第二特征提取单元。其中，特征增强模块可以为Neck模块。具体地，通过第一个第二特征提取单元对像素特征图进行特征提取并进行上采样，得到第三特征图；通过第二个第二特征提取单元对第三特征图和第一特征图进行特征融合，得到第四特征图；第三特征图与第一特征图的尺寸相同；通过第二个第二特征提取单元对第四特征图进行特征提取，得到目标特征图。在一具体实施例中，特征增强模块为FPN结构。其中，特征增强模块包括四个依次级联的第二特征提取单元。第一个第二特征提取单元对像素特征图进行特征提取并进行上采样处理得到第三特征图；第二个第二特征提取单元将第三特征图和第三个第一特征提取单元输出的特征图进行拼接、特征提取得到第一子特征图；对第一子特征图进行上采样处理后，通过第三个第二特征提取单元将第一子特征图和第二个第一特征提取单元输出的特征图进行拼接并特征提取得到第二子特征图；对第二子特征图进行上采样处理后，通过第四个第二特征提取单元将第二子特征图和第一个第一特征提取单元输出的特征图进行拼接、特征提取得到目标特征图。其中，第二特征提取单元的卷积核包括但不限于3*3、第二特征提取单元的通道数为256。S23：通过解码模块对像素对应的目标特征图进行特征融合，得到融合特征图。在一实施例中，解码模块的结构与特征增强模块的结构可以相同。其中，解码模块的结构也可以为FPN结构。通过解码模块将第三特征图、第四特征图和目标特征图插值到同一尺寸并进行特征融合，得到融合特征图。具体地，解码模块包括四个依次级联的第三特征提取单元。第一个第三特征提取单元对目标特征图进行特征提取得到第三子特征图；第二个第三特征提取单元将第三子特征图和第三个第二特征提取单元输出的特征图进行拼接、特征提取得到第四子特征图；通过第三个第三特征提取单元将第四子特征图和第二个第二特征提取单元输出的特征图进行拼接并特征提取得到第五子特征图；通过第四个第三特征提取单元将第五子特征图和第一个第二特征提取单元输出的特征图进行拼接、特征提取得到融合特征图。其中，第三特征提取单元的卷积核包括但不限于1*1，第三特征提取单元的通道数为128。在一实施例中，将目标特征图、第三子特征图和第三个第二特征提取单元输出的特征图、第四子特征图第二个第二特征提取单元输出的特征图、第五子特征图和第一个第二特征提取单元输出的特征图的尺寸插值到同一尺寸后再进行对应拼接融合。例如，尺寸可以为1/8H*1/8W。S24：基于像素对应的融合特征图，确定像素的检测类别。具体地，通过对像素对应的融合特征图进行卷积得到像素的检测类别。根据正射影像子图中的各像素的检测类别确定正射影像图对应的多个检测类别。统计正射影像子图中的各像素的检测类别，将统计得到的多个检测类别作为正射影像图对应的多个检测类别。检测类别可以为道路线类别、建筑类别、绿化带类别、人行道类别、安全岛类别、渠化岛类别、植被类别和水体类别。具体地，步骤S3中确定目标区域中各检测类别对应的连通域的步骤具体包括如下步骤。遍历所有检测类别，选取一检测类别作为目标类别；将正射影像图中目标类别对应的所有像素均赋值为第一标识符；基于第一标识符对应的所有像素，确定目标类别对应的连通域信息，连通域信息包括连通域。在一具体实施例中，将正射影像图中目标类别对应的所有像素均赋值为第一标识符，将正射影像图中除目标类别对应的像素之外的其他像素均赋值为第二标识符，即对正射影像图进行二值化得到目标类别对应的掩码图。各掩码图中具有对应的至少一个连通域。在一实施例中，第一标识符为1，第二标识符为0。根据目标类别对应的掩码图，将第一标识符组成的连通区域作为连通域。将目标类别的掩码图中对应的连通域进行编号，得到各连通域的连通域编号。将连通域编号均赋值给连通域中包含的所有像素，统计目标类别对应的掩码图中的连通域总数。根据连通域确定连通域的外接矩形框。具体地，将连通域的最小外接矩形框作为连通域的外接矩形框。具体地，步骤S4中确定各连通域的高度信息的步骤具体包括如下步骤。在一实施例中，连通域信息包括连通域、连通域编号、外接矩形框以及检测类别对应的连通域总数。请参阅图7和图8，图7是图1提供的地图模型构建方法中步骤S4一实施例的流程示意图；图8是图1提供的地图模型构建方法中步骤S4一具体实施例的流程示意图。由于道路线设置于地面上，可以将道路线类别对应的道路线的高度信息确定为地面的高度信息，再基于其他类别对应的待检测目标的高度值与地面的高度信息之间的差值确定待检测目标的高度信息。S41：将道路线类别对应的连通域在正射影像图中的位置映射至数字表面模型，确定道路线对应的第一高度值。具体地，由于正射影像图和数字表面模型的尺寸一致。将道路线类别对应的掩码图中连通域中各像素的标识符与数字表面模型中对应位置的高度值相乘，得到连通域中各像素对应的高度值。可以将道路线类别对应的所有连通域的各像素对应的高度值进行平均，得到道路线对应的第一高度值。S42：将待检测类别对应的连通域在正射影像图中的位置映射至数字表面模型，确定待检测目标对应的第二高度值。具体地，响应于连通域的连通域编号不大于连通域对应的检测类别的连通域总数，则将连通域中所有像素均赋值为1，将连通域对应的外接矩形框中除连通域的其他像素均赋值为0。将外接矩形框中连通域对应各像素的赋值乘以数字表面模型中对应位置的数值得到各像素对应的高度值。基于外接矩形框中连通域对应的所有像素的高度值，确定连通域对应的待检测目标的第二高度值。在一实施例中，将外接矩形框中连通域对应的所有像素的高度值的平均值，作为连通域对应的待检测目标的第二高度值。待计算得到连通域对应的待检测目标的第二高度信息，则通过该步骤继续计算待检测类别对应的另一连通域的高度信息，直至计算得到将待检测类别对应的所有连通域的第二高度值。S43：基于第一高度值和第二高度值的差值，确定待检测目标的高度信息。具体地，将连通域对应的第二高度值和道路线对应的第一高度值之间的差值确定为连通域对应的待检测目标的高度信息。在一实施例中，将待检测目标的高度信息与对应的连通域包含的所有像素关联。通过上述方法计算正射影像图中各检测类别对应的各连通域的高度信息。在一实施例中，新建与正射影像图尺寸相同的高度值为0的矩阵，以保存各检测类别对应的所有连通域的高度信息。具体地，矩阵的个数可以与正射影像图中检测类别的个数相同，矩阵的个数也可以为一个，即正射影像图对应的所有检测类别的连通域的高度值均保存至同一矩阵。请参阅图9，图9是图1提供的地图模型构建方法中步骤S5一具体实施例的流程示意图。具体地，步骤S5中基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型的步骤具体包括如下步骤。S51：对正射影像图中各像素对应的检测类别和各连通域对应的高度信息进行矢量化处理，分别生成连通域的轮廓线。具体地，根据正射影像图中各像素对应的检测类别可以确定像素所属的连通域对应的目标。即通过正射影像图中所有像素对应的检测类别可以确定正射影像图中包含的所有目标。例如，检测类别为道路线类别，则确定道路线类别对应的目标为道路线，检测类别对建筑类别，则确定建筑类别对应的目标为建筑。矢量化处理是将正射影像图中检测的所有目标和各目标对应的高度结果，由栅格文件转为矢量文件，矢量文件为三维数据格式，例如，shp格式或geojson格式等。将正射影像图中检测的所有目标和各目标对应的高度结果进行矢量化后得到点数据、线数据、面数据。例如，人行道、建筑、安全岛皆由矢量面组成，即矢量化的连通域的数据类型为面数据。标识物皆由矢量点组成，即矢量化的连通域的数据类型为点数据。道路线皆由矢量线组成，即矢量化的连通域的数据类型为线数据。具体地，连通域对应的轮廓线具有数据类型，数据类型包括点数据、线数据和面数据；轮廓线所包含的轮廓点的坐标位置属于球形坐标系。其中，轮廓线的数据类别、所属目标以及对应的高度信息等信息均存储在矢量化后的轮廓线中，作为轮廓线的特征值。矢量化操作是使用第三方库进行实现，例如通过GDAL进行矢量化。在一实施例中，根据需要构建的地图模型的维度确定矢量化的矢量文件的格式。例如，在2D和2.5D场景中，矢量文件的格式需要转化为shp格式，进而通过shp格式直接进行显示；而在3D场景中必须使用模型数据展示。即将矢量文件的shp格式或geojson格式转化为网格体，进而进行保存，进而使用GDAL进行矢量文件的读取和VTK库进行建模。本实施例中，主要针对面数据进行地图模型的构建，因此将步骤S51得到的连通域的轮廓线的矢量化文件的格式转换为面状网格体或柱状网格体。也就是说，通过对正射影像图中各像素对应的检测类别和各连通域对应的高度信息进行矢量化处理，得到正射影像图对应的矢量文件，矢量文件中存储多个检测类别的图层，各检测类别的图层中存储有对应的所有连通域的轮廓线，各轮廓线具有对应的特征值。S52：响应于连通域对应的数据类型为面数据，则将连通域对应的轮廓线中各轮廓点在球形坐标系中的坐标位置转换为在平面坐标系中的平面坐标位置。具体地，先检测正射影像图对应的矢量文件是否打开，如果界面显示弹窗界面，则直接读取矢量文件中的各检测类别的图层以及各检测类别的图层中存储有对应的所有连通域。由于本实施例中是基于面数据构建的立体地图模型。因此先判断连通域对应的数据类型是否为面数据，如果连通域对应的数据类型是面数据，则将连通域对应的轮廓线中各轮廓点在球形坐标系中的坐标位置转换为在平面坐标系中的平面坐标位置。例如，平面坐标位置为UTM投影坐标。S53：基于连通域中各轮廓点的平面坐标位置以及连通域的高度信息，构建目标区域的地图模型。请参阅图10，图10是图9提供的地图模型构建方法中步骤S53一具体实施例的流程示意图。S531：基于连通域中各轮廓点的平面坐标位置进行底面建模，生成底面模型。具体地，通过VTK Delaunay 2D基于连通域对应的所有轮廓点的平面坐标位置进行底面建模，生成底面模型。如果仅需要构建面状网格体，则将连通域对应的所有轮廓点的平面坐标位置作为vtkOBJWriter的端点数据和约束数据进行底面建模，将连通域对应的所有轮廓点构建的底面模型存储为obj文件。S532：基于轮廓点的平面坐标位置和连通域对应的高度信息，确定顶点轮廓点的平面坐标位置。具体地，将轮廓点的平面坐标位置与连通域的高度信息进行加和，得到顶点轮廓点的平面坐标位置。S533：基于顶点轮廓点的平面坐标位置进行顶面建模，生成顶面模型。具体地，若需要构建柱状网格体，则基于顶点轮廓点的平面坐标位置进行顶面建模，生成顶面模型。具体地，读取顶点轮廓点对应的平面坐标位置，将顶点轮廓点的平面坐标位置作为vtkDelaunay2D的端点数据和约束数据进行顶面建模，将连通域对应的所有轮廓点构建的顶面模型存储为obj文件。S534：基于轮廓点和顶点轮廓点进行侧面建模，生成侧面模型。具体地，遍历顶面模型和底面模型中处于同一面的所有轮廓点，选取顶面模型中的相邻两个顶面轮廓点以及底面模型的相邻两个轮廓点组成三角面，基于生成的所有三角面生成对应的侧面模型。S535：将底面模型、顶面模型和侧面模型进行合并，得到目标区域的三维地图模型。具体地，使用vtkAppendPolyData将顶面模型、底面模型、侧面模型合并成一个模型，得到目标区域的地图模型。使用vtkOBJWriter将模型存储为obj文件。本实施例提供的地图模型构建方法，通过获取目标区域对应的正射影像图和数字表面模型；对目标区域的正射影像图中的各像素进行类别检测，得到各像素对应的检测类别；基于正射影像图中各像素对应的像素类别，确定目标区域中各检测类别对应的连通域；将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息；基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型。通过对目标区域的正射影像图中的各像素进行类别检测得到目标区域中的连通域，确定目标区域中包含的地物的位置，基于各连通域映射在数字表面模型中的区域数据，确定连通域对应的地物的高度信息，通过目标区域中包含的地物的位置信息和高度信息构建目标区域的地图模型，进而提高了构建的地图模型的精确度。请参阅图11，图11是本发明提供的地图模型构建装置一实施例的框架示意图。本实施例提供一种地图模型构建装置60，地图模型构建装置60包括获取模块61、类别检测模块62、分析模块63、计算模块64和构建模块65。获取模块61用于获取目标区域对应的正射影像图和数字表面模型。类别检测模块62用于对目标区域的正射影像图中的各像素进行类别检测，得到各像素对应的检测类别。分析模块63用于基于正射影像图中各像素对应的像素类别，确定目标区域中各检测类别对应的连通域。计算模块64用于将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息。构建模块65用于基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型。本实施例提供的地图模型构建装置，通过获取模块获取目标区域对应的正射影像图和数字表面模型；类别检测模块对目标区域的正射影像图中的各像素进行类别检测，得到各像素对应的检测类别；分析模块基于正射影像图中各像素对应的像素类别，确定目标区域中各检测类别对应的连通域；计算模块将各连通域在正射影像图中的位置映射至数字表面模型，确定各连通域的高度信息；构建模块基于连通域的高度信息以及各连通域在正射影像图中的位置，构建目标区域的地图模型。通过对目标区域的正射影像图中的各像素进行类别检测得到目标区域中的连通域，确定目标区域中包含的地物的位置，基于各连通域映射在数字表面模型中的区域数据，确定连通域对应的地物的高度信息，通过目标区域中包含的地物的位置信息和高度信息构建目标区域的地图模型，进而提高了构建的地图模型的精确度。请参阅图12，图12是本申请终端一实施例的框架示意图。终端80包括相互耦接的存储器81和处理器82，处理器82用于执行存储器81中存储的程序指令，以实现上述任一地图模型构建方法实施例的步骤。在一个具体的实施场景中，终端80可以包括但不限于：微型计算机、服务器，此外，终端80还可以包括笔记本电脑、平板电脑等移动设备，在此不做限定。具体而言，处理器82用于控制其自身以及存储器81以实现上述任一地图模型构建方法实施例的步骤。处理器82还可以称为CPU。处理器82可能是一种集成电路芯片，具有信号的处理能力。处理器82还可以是通用处理器、数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。另外，处理器82可以由集成电路芯片共同实现。请参阅图13，图13为本申请计算机可读存储介质90一实施例的框架示意图。计算机可读存储介质90存储有能够被处理器运行的程序指令901，程序指令901用于实现上述任一地图模型构建方法实施例的步骤。在一些实施例中，本公开实施例提供的装置具有的功能或包含的模块可以用于执行上文方法实施例描述的方法，其具体实现可以参照上文方法实施例的描述，为了简洁，这里不再赘述。上文对各个实施例的描述倾向于强调各个实施例之间的不同之处，其相同或相似之处可以互相参考，为了简洁，本文不再赘述。在本申请所提供的几个实施例中，应该理解到，所揭露的方法和装置，可以通过其它的方式实现。例如，以上所描述的装置实施方式仅仅是示意性的，例如，模块或单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，装置或单元的间接耦合或通信连接，可以是电性、机械或其它的形式。另外，在本申请各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备或处理器执行本申请各个实施方式方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上仅为本发明的实施方式，并非因此限制本发明的专利保护范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
