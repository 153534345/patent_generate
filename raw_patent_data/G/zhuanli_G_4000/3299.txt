标题title
一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法
摘要abst
本发明提供了一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，属于锂离子电池技术领域。解决了传统二阶RC等效电路模型输出非线性映射能力不足的技术问题。其技术方案为：包括以下步骤：步骤1)对锂离子电池进行间歇恒流放电实验测取其端电压及负载电流数据；步骤2)建立基于Wiener结构的锂离子电池非线性模型；步骤3)构建辅助模型随机梯度的算法流程；步骤4)对AM‑SG算法进行优化；步骤5)对锂电池端电压进行预测。本发明的有益效果为：本发明利用AM‑εFG算法进行参数辨识，精度高。
权利要求书clms
1.一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，其特征在于，包括以下步骤：步骤1)对锂离子电池进行间歇恒流放电实验测取其端电压及负载电流数据，依据数据通过多项式拟合法确定其OCV-SOC的函数关系,以便计算出各时间点锂电池开路电压；步骤2)建立基于Wiener结构的锂离子电池非线性模型；步骤3)构建辅助模型随机梯度的算法流程；步骤4)对AM-SG算法进行优化，提高算法性能，构建辅助模型修正遗忘梯度算法；步骤5)利用AM-εFG算法对建立的Wiener结构的锂离子电池非线性模型进行参数辨识，并对锂电池端电压进行预测。2.根据权利要求1所述的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，其特征在于，所述步骤2)包括如下步骤：基于Wiener结构的锂离子电池非线性模型由二阶RC等效电路线性部分及输出非线性项构成，将锂离子电池非线性的输入输出关系分解为两个相互连接的不同段，Wiener结构的锂离子电池非线性模型中线性部分有两个RC并联环节，其中利用R1和C1并联结构表示电化学极化效应，利用R2和C2并联结构表示浓度差极化效应；Uoc和U为电池开路电压与端电压，用U1和U2表示C1和C2两端的电压，Romc是锂电池欧姆内阻；则建立线性部分模型如下：其中G为线性部分的传递函数，m为线性部分的输出项，I为线性部分的输入，即电流值，通过双线性变化s＝2/T，其中s表示连续时间复平面上的变量，z表示离散时间复平面上的变量，T为采样周期，取1秒，将式从s平面映射到z平面，得到：其中a＝Romc，b＝τ1τ2，c＝τ1+τ2，d＝Romc+R1+R2，e＝Romc+R1τ1+R2τ2，τ1＝R1C1，τ2＝R2C2；则Wiener结构的锂离子电池非线性模型中的线性部分用输出误差模型表示如下：其中k为采样样本指标，I是锂电池负载电流，m是线性部分输出，z-1是单位延迟符号：z-1I＝I，A，B是常数多项式，在该模型中有：将线性部分的输出作为Wiener模型中非线性部分的输入，最终电池端电压表示为：其中q是Wiener结构中的非线性输出项，f是Wiener结构中的输出非线性函数，U是电池端电压，Uoc是电池开路电压，v是一个均值为0、方差为σ2并满足高斯分布的白噪声，w是系统外部扰动，假设其扰动通道的极点多项式与过程通道一致，零极点多项式阶次相同，则有：该Wiener结构的锂离子电池非线性模型中非线性部分的输出表示为：q＝f)＝γ1·m+γ2·m2其中γ1和γ2是需要辨识的未知参数，设γ1＝1而不丧失一般性，将上述各式进行展开合并整理得到基于Wiener结构的锂离子电池非线性模型：其中y为系统等效输出，因此，模型回归方程写为：其中η为参数估计误差，上述公式中，φ为系统的信息向量，表示为：为系统的参数向量，表示为：其中α1＝γ2a1，α2＝γ2a2，至此完成基于Wiener结构的锂离子电池非线性模型的构建。3.根据权利要求1所述的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，其特征在于，所述步骤3)包括如下步骤：步骤1)辅助模型辨识是用系统的可测信息建立一个辅助模型，用辅助模型的输出代替系统的不可测变量的一种辨识方法，并且通过选择辅助模型的参数变量，使得辅助模型的输出逼近这些不可测变量，从而获得系统参数的一致估计；步骤2)建立基于Wiener结构的锂离子电池非线性模型，而其中信息向量φ中包含不可测的中间信号m，根据辅助模型思想不可测中间信号由下式更新：极小化准则函数：其中E表示期望值，从而得到随机梯度算法：其中r为收敛因子，基于辅助模型思想，将作为辅助模型的参数向量，将由式更新的/＞代替式中的m得到的信息向量/＞作为辅助模型的信息向量，因此有：极小化新准则函数：得到AM-SG算法：4.根据权利要求1所述的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，其特征在于，所述步骤4)包括如下步骤：步骤4-1)在研究辅助模型随机梯度算法的收敛性后，为提高其收敛速度，在AM-SG算法中引入遗忘因子λ，得到辅助模型遗忘随机梯度算法，则式更新为：其中遗忘因子λ满足0≤λ≤1；步骤4-2)为解决遗忘因子在提高算法收敛速度情况下使得辨识误差增大的情况，在AM-FG算法中引入收敛指数ε，得到辅助模型修正遗忘梯度算法，则式更新为：其中收敛指数ε满足0≤ε＜1，在加入收敛指数后AM-εFG算法参数辨识误差减小，在收敛速度和辨识误差之间找到折中，实验表明AM-εFG算法优于AM-SG算法及AM-FG算法，最终AM-εFG算法表示为：5.根据权利要求1所述的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，其特征在于，所述步骤5)包括如下步骤：将步骤1)中测量得到的锂电池负载电流作为模型的输入数据I，将测量得到的锂电池端电压与确定的开路电压之差U-Uoc作为输出数据y，利用AM-εFG算法完成参数在线实时辨识，根据式得出a，b，c，d，e的值，最终推导得出锂电池参数Romc，R1，R2，C1，C2的辨识值及端电压估计值利用辨识得到的电池端电压估计值与实际端电压值构造误差函数δ：式中δ为预测端电压与实测端电压误差，以此验证模型精度。
说明书desc
技术领域本发明涉及锂离子电池技术领域，尤其涉及一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法。背景技术锂离子电池是一种高能量密度电池，其能量密度相较传统镍氢电池和铅酸电池高出数倍，且因其具有轻量化、无记忆效应，环保等优点而被广泛应用于移动电子设备和电动汽车领域。随着其技术的不断发展，人们在开发高效电池模型方面不断努力，来实现电池管理系统中的目标，例如电池荷电状态估计与健康状况估计等，电池系统的优化能够提高电池的安全性、循环寿命和能量密度，而这与建立精确的电池模型与精确的参数预测方法息息相关。传统的二阶RC等效电路模型是一种动态线性模型，而锂离子电池是一个非线性系统，加之，在锂电池实际工作中输出端会受到外部噪声的影响，使得传统的二阶RC等效电路模型精度不足。建立更高精度的等效电路模型及更精确的参数辨识算法是一个重要的问题。如何解决上述技术问题为本发明面临的课题。发明内容本发明的目的在于提供一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法,在锂电池实际工作过程中输出端会受到外部噪声的影响，且其本身是一个非线性系统，而传统的二阶RC等效电路模型是线性动态模型，考虑以上问题，本发明引入非线性块结构Wiener模型，在保证参数能够在线辨识的前提下，提高等效电路模型的非线性映射能力，从而提高锂电池参数辨识的精度。本发明利用辅助模型修正梯度算法对建立的Wiener结构的锂离子电池非线性模型进行参数辨识，并用多种工况进行准确性验证，结果表明，基于Wiener结构的锂离子等效电池模型具有更高的精度，预测端电压误差值明显低于传统二阶RC等效电路的误差值。本发明是通过如下措施实现的：一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，包括以下步骤：步骤1)对锂离子电池进行间歇恒流放电实验测取其端电压及负载电流数据，依据数据通过多项式拟合法确定其OCV-SOC的函数关系,以便计算出各时间点锂电池开路电压；步骤2)建立基于Wiener结构的锂离子电池非线性模型；步骤3)构建辅助模型随机梯度的算法流程；步骤4)对AM-SG算法进行优化，提高算法性能，构建辅助模型修正遗忘梯度算法；步骤5)利用AM-εFG算法对建立的Wiener结构的锂离子电池非线性模型进行参数辨识，并对锂电池端电压进行预测。作为本发明的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法的进一步优化方案，所述步骤2)的具体步骤如下：基于Wiener结构的锂离子电池非线性模型由二阶RC等效电路线性部分及输出非线性项构成，将锂离子电池非线性的输入输出关系分解为两个相互连接的不同段，Wiener结构的锂离子电池非线性模型中线性部分有两个RC并联环节，其中利用R1和C1并联结构表示电化学极化效应，利用R2和C2并联结构表示浓度差极化效应；Uoc和U为电池开路电压与端电压，用U1和U2表示C1和C2两端的电压，Romc是锂电池欧姆内阻；则建立线性部分模型如下：其中G为线性部分的传递函数，m为线性部分的输出项，I为线性部分的输入，即电流值，通过双线性变化s＝2/T，其中s表示连续时间复平面上的变量，z表示离散时间复平面上的变量，T为采样周期，本发明中取1秒，将式从s平面映射到z平面，得到：其中a＝Romc，b＝τ1τ2，c＝τ1+τ2，d＝Romc+R1+R2，e＝Romc+R1τ1+R2τ2，τ1＝R1C1，τ2＝R2C2；则Wiener结构的锂离子电池非线性模型中的线性部分可用输出误差模型表示如下：其中k为采样样本指标，I是锂电池负载电流，m是线性部分输出，z-1是单位延迟符号：z-1I＝I，A，B是常数多项式，根据式，在该模型中有：将线性部分的输出作为Wiener结构的锂离子电池非线性模型中非线性部分的输入，最终电池端电压表示为：其中q是Wiener结构中的非线性输出项，f是Wiener结构中的输出非线性函数，U是电池端电压，Uoc是电池开路电压，v是一个均值为0、方差为σ2并满足高斯分布的白噪声，w是系统外部扰动，假设其扰动通道的极点多项式与过程通道一致，零极点多项式阶次相同，则有：该Wiener结构的锂离子电池非线性模型中非线性部分的输出表示为：q＝f)＝γ1·m+γ2·m2其中γ1和γ2是需要辨识的未知参数，设非线性分量的第一模数γ1＝1而不丧失一般性。将上述各式进行展开合并整理得到基于Wiener结构的锂离子电池非线性模型：其中y为系统等效输出，因此，模型回归方程可以写为：其中η为参数估计误差，上述公式中，φ为系统的信息向量，表示为：为系统的参数向量，表示为：其中α1＝γ2a1，α2＝γ2a2，至此完成基于Wiener结构的锂离子电池非线性模型的构建。作为本发明的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法的进一步优化方案，所述步骤3)的具体步骤如下：辅助模型辨识思想是用系统的可测信息建立一个辅助模型，用辅助模型的输出代替系统的不可测变量的一种辨识方法，并且通过选择辅助模型的参数变量，使得辅助模型的输出逼近这些不可测变量，从而获得系统参数的一致估计。随机梯度算法是沿着准则函数负梯度方向搜索参数估计，其计算量小，辨识速度快。在步骤2)中建立了基于Wiener结构的锂离子电池非线性模型，而其信息向量φ中包含不可测的中间信号m，根据辅助模型思想不可测中间信号由下式更新：极小化准则函数：其中E表示期望值，从而得到随机梯度算法：其中r为收敛因子，基于辅助模型思想，将作为辅助模型的参数向量，将由式更新的/＞代替式中的m得到的信息向量/＞作为辅助模型的信息向量。因此有：极小化新准则函数：可得到AM-SG算法：该算法流程图如下：附图不能要放在说明书附图位置，不能放在这里作为本发明的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法的进一步优化方案，所述步骤4)的具体步骤如下：步骤4-1)在研究辅助模型随机梯度算法的收敛性后，为提高其收敛速度，在AM-SG算法中引入遗忘因子λ，得到辅助模型遗忘随机梯度算法，则式更新为：其中遗忘因子λ满足0≤λ≤1，在加入遗忘因子后，AM-FG算法收敛速度提高，但误差相较AM-SG算法有所增大。步骤4-2)为解决遗忘因子在提高算法收敛速度情况下使得辨识误差增大的情况，在AM-FG算法中引入收敛指数ε，得到辅助模型修正遗忘梯度算法，则式更新为：其中收敛指数ε满足0≤ε＜1，在加入收敛指数后AM-εFG算法参数辨识误差减小，在收敛速度和辨识误差之间找的折中，最终AM-εFG算法表示为：AM-εFG算法在AM-SG算法的基础上通过增加遗忘因子以及收敛指数，兼顾了算法的收敛速度以及误差量，实现了算法的优化，实验表明AM-εFG算法优于AM-SG算法及AM-FG算法。作为本发明的一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法的进一步优化方案，所述步骤5)的具体步骤如下：将步骤1)中测量得到的锂电池放电电流作为模型的输入数据I，将测量得到的锂电池端电压与确定的开路电压之差U-Uoc作为输出数据y，利用AM-εFG算法完成参数在线实时辨识，根据式可以得出a，b，c，d，e的值，最终可以推导得出锂电池参数Romc，R1，R2，C1，C2的辨识值及端电压估计值利用辨识得到的电池端电压估计值与实际端电压值构造误差函数δ：式中δ为预测端电压与实测端电压误差，以此验证模型精度。与现有技术相比，本发明的有益效果为：本发明在传统二阶RC等效电路模型的基础上，以Wiener结构来构建锂离子电池等效模型，将锂离子电池等效模型构建为一个动态线性系统与一个静态非线性系统串联的结构，且将输出噪声整合到模型中模拟锂电池实际输出时受到的外部干扰，有效提高了模型精度，端电压预测误差明显低于传统二阶RC模型的误差。本发明在参数辨识过程中，为保证算法在精度及收敛速度上的优越性，在原AM-SG算法的基础上，引入遗忘因子以提高收敛速度，引入收敛指数以提高辨识精度，最终优化为AM-εFG算法，利用其完成参数在线辨识，辨识精度较高。附图说明附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。图1是实施例的锂电池实测电压、电流数据曲线图。图2是本发明提供的基于Wiener结构的锂离子电池非线性模型结构图；其中，为Wiener结构的锂离子电池非线性模型中线性部分的具体结构图；为Wiener结构的锂离子电池非线性模型的整体结构图。图3是本发明提供的AM-SG算法流程图。图4本发明提供的在Wiener结构等效模型中AM-εFG算法与AM-SG算法端电压预测误差对比曲线图。图5实施例的各参数辨识结果曲线图。图6本发明提供的Wiener结构等效模型与二阶RC模型的端电压预测对比曲线图。图7本发明提供的Wiener结构等效模型与二阶RC模型的端电压预测误差对比曲线图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。当然，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明。本实施例研究对象为松下锂离子电池NCR-18650B，额定电压3.7V，容量3400mAh。首先将电池以恒流充电方式进行充电，直至达到截止电压，使电池静置一段时间从而达到满电状态。参见图1至图6，本实施例提供一种基于Wiener结构的锂离子电池非线性建模及其参数辨识方法，包括下列步骤：步骤1)对锂离子电池进行间歇恒流放电实验测取其端电压及负载电流数据，依据数据通过多项式拟合法确定其OCV-SOC的函数关系,以便计算出各时间点锂电池开路电压；步骤2)建立基于Wiener结构的锂离子电池非线性模型；步骤3)构建辅助模型随机梯度的算法流程；步骤4)对AM-SG算法进行优化，提高算法性能，构建辅助模型修正遗忘梯度算法；步骤5)利用AM-εFG算法对建立的Wiener结构的锂离子电池非线性模型进行参数辨识，并对锂电池端电压进行预测。具体地，所属步骤1)具体包括如下步骤：在恒温25℃下，进行锂电池间歇恒流放电实验，每放电5min，静置30min，总时间长度为16800s，放电倍率为1C，电流为3400mA。整个实验过程中测得的锂电池端电压及放电电流数据如图1所示。选取各静置阶段中较为稳定的电压作为开路电压，与对应时刻的SOC进行多项式拟合，确定OCV-SOC函数关系：由OCV-SOC函数关系根据某一时刻对应的SOC值计算出锂电池的开路电压。具体地，所属步骤2)具体包括如下步骤：如图2所示，本实施例提供的一种基于Wiener结构的锂离子电池非线性模型由二阶RC等效电路线性部分及输出非线性项构成，将锂离子电池非线性的输入输出关系分解为两个相互连接的不同段，Wiener结构的锂离子电池非线性模型中线性部分有两个RC并联环节，其中利用R1和C1并联结构表示电化学极化效应，利用R2和C2并联结构表示浓度差极化效应；Uoc和U为电池开路电压与端电压，用U1和U2表示C1和C2两端的电压，Romc是锂电池欧姆内阻；则建立线性部分模型如下：通过双线性变化s＝2/T，其中s表示连续时间复平面上的变量，z表示离散时间复平面上的变量，将式从s平面映射到z平面，可以得到：其中a＝Romc，b＝τ1τ2，c＝τ1+τ2，d＝Romc+R1+R2，e＝Romc+R1τ1+R2τ2，τ1＝R1C1，τ2＝R2C2；则Wiener等效电路模型中的线性部分可用输出误差模型表示如下：其中k为采样样本指标，I是锂电池负载电流，m是线性部分输出，z-1是单位延迟符号：z-1I＝I，A，B是常数多项式，根据式，在该模型中有：将线性部分的输出作为Wiener结构的锂离子电池非线性模型中非线性部分的输入，最终电池端电压表示为：其中q是Wiener结构的锂离子电池非线性模型中的非线性输出项，f是Wiener结构中的输出非线性函数，U是电池端电压，Uoc是电池开路电压，v是一个均值为0、方差为σ2并满足高斯分布的白噪声，w是系统外部扰动，假设其扰动通道的极点多项式与过程通道一致，零极点多项式阶次相同，则有：该Wiener结构的锂离子电池非线性模型中非线性部分的输出表示为：q＝f)＝γ1·m+γ2·m2其中γ1和γ2是需要辨识的未知参数，设非线性分量的第一模数γ1＝1而不丧失一般性。将上述各式进行展开合并整理得到基于Wiener结构的锂离子电池非线性模型：其中y为系统等效输出，因此，模型回归方程可以写为：其中η为参数估计误差，上述公式中，φ为系统的信息向量，表示为：为系统的参数向量，表示为：其中α1＝γ2a1，α2＝γ2a2，至此完成基于Wiener结构的锂离子电池非线性模型的构建。具体地，所属步骤3)具体包括如下步骤：辅助模型辨识思想是用系统的可测信息建立一个辅助模型，用辅助模型的输出代替系统的不可测变量的一种辨识方法，并且通过选择辅助模型的参数变量，使得辅助模型的输出逼近这些不可测变量，从而获得系统参数的一致估计。随机梯度算法是沿着准则函数负梯度方向搜索参数估计，其计算量小，辨识速度快。在步骤2)中建立了基于Wiener结构的锂离子电池非线性模型，而其信息向量φ中包含不可测的中间信号m，根据辅助模型思想不可测中间信号由下式更新：极小化准则函数：其中E表示期望值，从而得到随机梯度算法：其中r为收敛因子，基于辅助模型思想，将作为辅助模型的参数向量，将由式更新的/＞代替式中的m得到的信息向量/＞作为辅助模型的信息向量。因此有：极小化新准则函数：可得到AM-SG算法：该算法流程图如图3所示。具体地，所属步骤4)具体包括如下步骤：步骤4-1)在研究辅助模型随机梯度算法的收敛性后，为提高其收敛速度，在AM-SG算法中引入遗忘因子λ，得到辅助模型遗忘随机梯度算法，则式更新为：其中遗忘因子λ满足0≤λ≤1，在加入遗忘因子后，AM-FG算法收敛速度提高，但误差相较AM-SG算法有所增大。步骤4-2)为解决遗忘因子在提高算法收敛速度情况下使得辨识误差增大的情况，在AM-FG算法中引入收敛指数ε，得到辅助模型修正遗忘梯度算法，则式更新为：其中收敛指数ε满足0≤ε＜1，在加入收敛指数后AM-εFG算法参数辨识误差减小，在收敛速度和辨识误差之间找的折中，最终AM-εFG算法表示为：AM-εFG算法与AM-SG算法基于Wiener结构等效电路模型中的端电压预测误差对比图如图4所示，结果表明AM-εFG在AM-SG算法基础上改进后收敛速度变快，预测误差变小，实现了算法优化，有助于更精确的完成参数估计。具体地，所属步骤5)具体包括如下步骤：将步骤1)中测量得到的锂电池放电电流作为模型的输入数据I，将测量得到的锂电池端电压与确定的开路电压之差U-Uoc作为输出数据y，利用AM-εFG算法完成参数在线实时辨识，根据式可以得出a，b，c，d，e的值，最终可以推导得出锂电池参数Romc，R1，R2，C1，C2的辨识值，如图4所示。利用辨识得到的电池端电压估计值与实际端电压值构造误差函数δ：式中δ为预测端电压与实测端电压误差，以此验证模型精度。Wiener结构的锂离子电池非线性模型利用AM-εFG算法与二阶RC模型利用εFG算法端电压预测结果及误差如图6、图7所示，结果表明本实施例所建立的基于Wiener结构的锂离子电池非线性模型比传统二阶RC模型预测误差小，非线性映射能力强，具有更高的精度。综上，可以看出基于Wiener结构的锂离子电池非线性模型较之传统二阶RC模型有着更好的效果，模型精度高于传统二阶RC模型，具有一定的工程价值。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
