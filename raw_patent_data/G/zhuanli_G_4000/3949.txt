标题title
代码检测系统及代码检测方法
摘要abst
本发明涉及漏洞检测技术领域，公开了一种代码检测系统及代码检测方法，该代码检测系统包括：对PLC工程项目文件进行完整性校验，获得校验结果；在校验结果为校验通过时，对所述PLC工程项目文件进行代码解析，获得不同类型的代码块；对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块；通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。本发明通过对完整的PLC工程项目文件进行代码解析，获得不同类型的代码块，通过对各类代码块进行解析将各类代码块以预设格式输出为目标程序代码块，并通过预设漏洞知识库对目标程序代码块进行漏洞检测，解决了无法对PLC工程项目代码进行非语法性检测的问题。
权利要求书clms
1.一种代码检测系统，其特征在于，所述代码检测系统：代码解析模块和代码检测模块；所述代码解析模块，用于对PLC工程项目文件进行完整性校验，获得校验结果；所述代码解析模块，还用于在校验结果为校验通过时，对所述PLC工程项目文件进行代码解析，获得不同类型的代码块；所述代码解析模块，还用于对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块；所述代码检测模块，用于通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。2.如权利要求1所述代码检测系统，其特征在于，所述代码检测系统还包括：代码扫描模块；其中，所述代码扫描模块分别与所述代码解析模块和所述代码检测模块相连；所述代码扫描模块，用于对所述代码解析模块发送的目标程序代码块进行扫描；所述代码检测模块，还用于在所述代码扫描模块扫描所述目标程序代码块时，通过预设漏洞知识库对所述目标程序代码块进行漏洞检测；所述代码检测模块，还用于将漏洞检测结果发送至所述代码扫描模块；所述代码扫描模块，还用于基于所述漏洞检测结果生成扫描结果，并将所述扫描结果输出为目标检测报告文件。3.如权利要求2所述的代码检测系统，其特征在于，所述代码解析模块，还用于对PLC工程项目文件进行分析，获得目标项目信息和不同类型的代码块；所述代码扫描模块，还用于获取所述代码检测模块发送的各类代码块对应的漏洞检测结果；所述代码扫描模块，还用于基于所述漏洞检测结果和所述目标项目信息生成扫描结果，并将所述扫描结果输出为目标检测报告文件。4.如权利要求3所述的代码检测系统，其特征在于，所述代码解析模块，还用于获取PLC工程项目文件对应的标准工程项目文件；所述代码解析模块，还用于根据所述标准工程项目文件对所述PLC工程项目文件进行完整性校验。5.如权利要求1至3任一项所述的代码检测系统，其特征在于，所述代码解析模块，还用于判断PLC工程项目文件的文件类型是否属于预设文件类型；所述代码解析模块，还用于若是，则确定所述PLC工程项目文件的路径信息；所述代码解析模块，还用于基于所述路径信息将所述PLC工程项目文件转换为文件流；所述代码解析模块，还用于将所述文件流转换为字节数组，并基于所述字节数组获得所述PLC工程项目文件的项目信息和项目目录信息；所述代码解析模块，还用于将所述项目信息和所述项目目录信息封装为对象；所述代码解析模块，还用于对所述对象中的项目目录信息进行遍历，获得目标项目信息和不同类型的代码块。6.如权利要求2所述的代码检测系统，其特征在于，所述代码检测模块，还用于通过预设漏洞知识库对所述目标程序代码块进行遍历匹配；所述代码检测模块，还用于在遍历匹配结束时，生成漏洞检测结果。7.一种基于权利要求1至6任一项所述的代码检测系统的代码检测方法，其特征在于，所述代码检测方法包括：获取PLC工程项目文件中不同类型的代码块；对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块；通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。8.如权利要求7所述的代码检测方法，其特征在于，所述通过预设漏洞知识库对所述目标程序代码块进行漏洞检测的步骤，包括：获取预设漏洞知识库中的若干个漏洞类型；将所述目标程序代码块对各个漏洞类型进行遍历匹配；在匹配成功时，获取所述目标程序代码块对应的漏洞类型。9.如权利要求8所述的代码检测方法，其特征在于，所述漏洞类型包括操作数地址重复；相应的，所述在匹配成功时，获取所述目标程序代码块对应的漏洞类型的步骤，包括：对所述目标程序代码块中每一行代码进行分割；在检测到所述目标程序代码块中存在类型转换语句时，根据所述类型转换语句所在行向所述目标程序代码块的上一行和下一行进行查找；在检测到第一目标转换指令和第二目标转换指令时，将所述第一目标转换指令和所述第二目标转换指令对应的操作数转换为相同格式的操作数；通过地址重复匹配算法对所述操作数进行验证；若出现重复地址，则所述目标程序代码块对应的漏洞类型为操作数地址重复。10.如权利要求7所述的代码检测方法，其特征在于，所述通过预设漏洞知识库对所述目标程序代码块进行漏洞检测的步骤之后，还包括：获取所述PLC工程项目文件的目标项目信息；基于所述目标项目信息和漏洞检测结果生成目标检测报告文件。
说明书desc
技术领域本发明涉及漏洞检测技术领域，尤其涉及一种代码检测系统及代码检测方法。背景技术冶金行业是我国国民经济的支柱性产业，是关系国计民生的基础性行业，冶金ICS生产包括球团、烧结、焦化、炼铁、炼钢、连铸、轧制等多个复杂环节，受外部环境等条件的限制，有些工序和环节必须应用自动化系统进行辅助进行。其中，PLC处于ICS架构的底层，直接控制冶金现场设备，同时兼顾通信功能，由于PLC是网络和现实之间的交互点，因此对PLC的恶意代码进行检测是ICS安全的核心问题之一。现有的技术中通过编译器对PLC的代码进行检测，但编译器只能进行语法层面的代码检测，无法对PLC的恶意代码进行非语法性的检测。因此，对PLC工程项目的恶意代码进行非语法性检测，成为一个亟待解决的问题。上述内容仅用于辅助理解本发明的技术方案，并不代表承认上述内容是现有技术。发明内容本发明的主要目的在于提供了一种代码检测系统及代码检测方法，旨在解决现有技术中无法对PLC工程项目代码进行非语法性检测的技术问题。为实现上述目的，本发明提供了一种代码检测系统，所述代码检测系统包括：代码解析模块和代码检测模块；所述代码解析模块，用于对PLC工程项目文件进行完整性校验，获得校验结果；所述代码解析模块，还用于在校验结果为校验通过时，对所述PLC工程项目文件进行代码解析，获得不同类型的代码块；所述代码解析模块，还用于对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块；所述代码检测模块，用于通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。可选地，所述代码检测系统还包括：代码扫描模块；其中，所述代码扫描模块分别与所述代码解析模块和所述代码检测模块相连；所述代码扫描模块，用于对所述代码解析模块发送的目标程序代码块进行扫描；所述代码检测模块，还用于在所述代码扫描模块扫描所述目标程序代码块时，通过预设漏洞知识库对所述目标程序代码块进行漏洞检测；所述代码检测模块，还用于将漏洞检测结果发送至所述代码扫描模块；所述代码扫描模块，还用于基于所述漏洞检测结果生成扫描结果，并将所述扫描结果输出为目标检测报告文件。可选地，所述代码解析模块，还用于对PLC工程项目文件进行分析，获得目标项目信息和不同类型的代码块；所述代码扫描模块，还用于获取所述代码检测模块发送的各类代码块对应的漏洞检测结果；所述代码扫描模块，还用于基于所述漏洞检测结果和所述目标项目信息生成扫描结果，并将所述扫描结果输出为目标检测报告文件。可选地，所述代码解析模块，还用于获取PLC工程项目文件对应的标准工程项目文件；所述代码解析模块，还用于根据所述标准工程项目文件对所述PLC工程项目文件进行完整性校验。可选地，所述代码解析模块，还用于判断PLC工程项目文件的文件类型是否属于预设文件类型；所述代码解析模块，还用于若是，则确定所述PLC工程项目文件的路径信息；所述代码解析模块，还用于基于所述路径信息将所述PLC工程项目文件转换为文件流；所述代码解析模块，还用于将所述文件流转换为字节数组，并基于所述字节数组获得所述PLC工程项目文件的项目信息和项目目录信息；所述代码解析模块，还用于将所述项目信息和所述项目目录信息封装为对象；所述代码解析模块，还用于对所述对象中的项目目录信息进行遍历，获得目标项目信息和不同类型的代码块。可选地，所述代码检测模块，还用于通过预设漏洞知识库对所述目标程序代码块进行遍历匹配；所述代码检测模块，还用于在遍历匹配结束时，生成漏洞检测结果。进一步地，为了实现上述目的，本申请还提出一种基于上述代码检测系统的代码检测方法，所述代码检测方法包括：获取PLC工程项目文件中不同类型的代码块；对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块；通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。可选地，所述通过预设漏洞知识库对所述目标程序代码块进行漏洞检测的步骤，包括：获取预设漏洞知识库中的若干个漏洞类型；将所述目标程序代码块对各个漏洞类型进行遍历匹配；在匹配成功时，获取所述目标程序代码块对应的漏洞类型。可选地，所述漏洞类型包括操作数地址重复；相应的，所述在匹配成功时，获取所述目标程序代码块对应的漏洞类型的步骤，包括：对所述目标程序代码块中每一行代码进行分割；在检测到所述目标程序代码块中存在类型转换语句时，根据所述类型转换语句所在行向所述目标程序代码块的上一行和下一行进行查找；在检测到第一目标转换指令和第二目标转换指令时，将所述第一目标转换指令和所述第二目标转换指令对应的操作数转换为相同格式的操作数；通过地址重复匹配算法对所述操作数进行验证；若出现重复地址，则所述目标程序代码块对应的漏洞类型为操作数地址重复。可选地，所述通过预设漏洞知识库对所述目标程序代码块进行漏洞检测的步骤之后，还包括：获取所述PLC工程项目文件的目标项目信息；基于所述目标项目信息和漏洞检测结果生成目标检测报告文件。在本发明中，公开了代码解析模块和代码检测模块；代码解析模块，用于对PLC工程项目文件进行完整性校验，获得校验结果；在校验结果为校验通过时，对所述PLC工程项目文件进行代码解析，获得不同类型的代码块；对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块；代码检测模块，用于通过预设漏洞知识库对所述目标程序代码块进行漏洞检测；相较于现有技术通过编译器对PLC代码进行语法层面的检测，由于本发明提供的代码检测系统中代码解析模块在对PLC工程项目文件的完整性校验通过时，对PLC工程项目文件进行代码解析，获得不同类型的代码块，并通过对各类代码块进行解析将各类代码块以预设格式输出为目标程序代码块，代码检测模块再通过预设漏洞知识库对目标程序代码块进行漏洞检测，从而解决了现有技术中无法对PLC工程项目代码进行非语法性检测的技术问题，进而保障设备的安全。附图说明图1为本发明代码检测系统第一实施例的结构框图；图2为本发明代码检测系统第一实施例中对各类代码块的解析结果示意图；图3为本发明代码检测系统第二实施例的结构框图；图4为本发明代码检测系统第二实施例中漏洞检测结果示意图；图5为本发明代码检测系统第二实施例中目标检测报告文件的示意图；图6为本发明基于代码检测系统的代码检测方法第一实施例的流程示意图；图7为本发明基于代码检测系统的代码检测方法第二实施例的流程示意图。本发明目的的实现、功能特点及优点将结合实施例，参照附图做进一步说明。具体实施方式应当理解，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明。下面将结合本发明实施例中的附图，对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例、基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有实施例，都属于本发明保护的范围。需要说明，在本发明实施例中涉及“第一”、“第二”等的描述仅用于描述目的，而不能理解为指示或暗示其相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。另外，各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当人认为这种技术方案的结合不存在，也不在本发明要求的保护范围之内。参照图1，图1为本发明实施例方案涉及的代码检测系统第一实施例的结构框图。如图1所示，本实施例代码检测系统包括代码解析模块100和代码检测模块200。需要说明的是，本实施例涉及的代码检测系统可以为具有数据处理和网络通信功能的代码检测设备，或者是其他能够实现相同或相似功能的、包含了该代码检测设备的代码检测系统。所述代码解析模块100，用于对PLC工程项目文件进行完整性校验，获得校验结果。应当理解的是，上述PLC工程项目文件可以为对工业控制设备编写的项目文件，例如西门子工业控制设备或其他冶金行业的工业控制设备，本实施例对此不加以限制。可以理解的是，上述完整性校验可以为检验上述PLC工程项目文件内容是否缺失，例如检验PLC工程项目文件的目录数和目录结构是否缺失。实际应用中，可以获取PLC工程项目文件对应的标准工程项目文件，再根据标准工程项目文件对PLC工程项目文件进行完整性校验。在具体实现中，代码解析模块100可以获取PLC工程项目文件对应的标准工程项目文件，再将PLC工程项目文件与标准工程项目文件作比较，检测PLC工程项目文件的目录数、目录结构和项目文件等内容是否缺失，若PLC工程项目文件存在缺失的内容，则校验不通过，若PLC工程项目文件内容完整，则校验通过，在校验完成后，输出对应的校验结果。所述代码解析模块100，还用于在校验结果为校验通过时，对所述PLC工程项目文件进行代码解析，获得不同类型的代码块。应当理解的是，上述校验通过可以表示PLC工程项目文件内容完整。需要说明的是，上述代码解析可以为对PLC工程项目文件进行结构分析，从而获取PLC工程项目文件的基本信息以及程序中包含的代码块信息。可以理解的是，上述不同类型的代码块可以为对PLC工程项目文件进行结构分析后获得的该项目的程序代码块信息，例如：OB组织块、DB数据库、FC功能块和FB背景功能块。在具体实现中，代码解析模块100可以读取PLC工程项目的项目类型，如.s7p西门子项目，再通过字符流形式读取项目目录内容结构，从而获取PLC工程项目的项目信息，并获得不同类型的代码块。所述代码解析模块100，还用于对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块。需要说明的是，上述预设代码格式可以为一种代码输出的文件格式，例如STL语句表格式，或其他与STL语句表格式具有相同或相似功能的代码格式，本实施例对此不加以限制。应当理解的是，上述目标程序代码块可以为将各类代码块以STL语句表格式输出的代码块。实际应用中，对各类代码块进行解析后的解析结果如图2所示，本实施例中目标程序代码块可以以图2中的代码格式进行显示。所述代码检测模块200，用于通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。可以理解的是，上述预设漏洞知识库可以为预先建立的检测代码块中是否存在漏洞的知识库。预设漏洞知识库中包含漏洞ID、漏洞类型漏洞描述、漏洞级别和漏洞修复方案等内容。例如：漏洞ID为CVE-101的漏洞表示代码中存在变量地址超过CPU的寄存器地址造成地址范围超限的漏洞，漏洞级别表示为“error”，对应的修复方案为将寄存器的地址修改为CPU对应的合理地址；漏洞ID为CVE-102的漏洞表示代码中存在已定义的程序块未进行引用的漏洞，漏洞级别表示为“warning”，对应的修复方案为不调用程序中未定义的数据块。实际应用中，代码检测模块200可以通过预设漏洞知识库中已经存在的漏洞类型特征对目标程序代码块中的漏洞进行识别。在具体实现中，代码解析模块100在对PLC工程项目文件进行漏洞检测时，首先获取PLC工程项目文件对应的标准工程项目文件，再通过将标准工程项目文件与PLC工程项目文件进行比较实现对PLC工程项目文件进行完整性校验，检测PLC工程项目文件中的目录数、目标结构和项目文件等内容是否缺失，若内容完整，则校验通过，此时可以对PLC工程项目文件进行结构分析，获取PLC工程项目文件的基本信息和不同类型的代码块，再对各类代码块进行解析，将解析后的各类代码块以STL语句表格式输出为目标程序代码块，最后将目标程序代码块与预设漏洞知识库中存在的漏洞类型进行匹配，从而实现对PLC工程项目文件中程序代码块的漏洞识别。进一步地，为了获得PLC工程项目文件中的目标项目信息和不同类型的代码块，所述代码解析模块100，还用于判断PLC工程项目文件的文件类型是否属于预设文件类型；所述代码解析模块100，还用于若是，则确定所述PLC工程项目文件的路径信息；所述代码解析模块100，还用于基于所述路径信息将所述PLC工程项目文件转换为文件流；所述代码解析模块100，还用于将所述文件流转换为字节数组，并基于所述字节数组获得所述PLC工程项目文件的项目信息和项目目录信息；所述代码解析模块100，还用于将所述项目信息和所述项目目录信息封装为对象；所述代码解析模块100，还用于对所述对象中的项目目录信息进行遍历，获得目标项目信息和不同类型的代码块。需要说明的是，在对PLC工程项目文件进行解析前，需要对文件进行校验，判断该PLC工程项目文件是否属于S7项目文件或其他系统支持的项目类型，若PLC工程项目文件不属于S7项目文件或其他系统支持的项目类型，则无法继续进行漏洞检测，若PLC工程项目文件属于S7项目文件或其他系统支持的项目类型，则继续对项目进行解析。应当理解的是，上述路径信息可以为PLC工程项目文件的获取子目录名，例如：Block路径，Source路径和Symbol路径等。可以理解的是，上述PLC工程项目文件的项目信息和项目目录信息可以通过对上述字节数组进行截取而获得。应当理解的是，上述目标项目信息可以为PLC工程项目文件具体的硬件信息，例如：PLC型号、固件版本、设备型号、项目名称和目录层级等信息，本实施例对此不加以限制。本实施例公开了代码解析模块100和代码检测模块200；代码解析模块100，用于对PLC工程项目文件进行完整性校验，获得校验结果；在校验结果为校验通过时，对所述PLC工程项目文件进行代码解析，获得不同类型的代码块；对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块；代码检测模块200，用于通过预设漏洞知识库对所述目标程序代码块进行漏洞检测；相较于现有技术通过编译器对PLC代码进行语法层面的检测，由于本实施例提供的代码检测系统中代码解析模块在对PLC工程项目文件的完整性校验通过时，对PLC工程项目文件进行代码解析，获得不同类型的代码块，并通过对各类代码块进行解析将各类代码块以预设格式输出为目标程序代码块，代码检测模块再通过预设漏洞知识库对目标程序代码块进行漏洞检测，从而解决了现有技术中无法对PLC工程项目代码进行非语法性检测的技术问题，进而保障设备的安全。参考图3，图3为本发明代码检测系统第二实施例的结构框图。基于上述第一实施例，提出本发明代码检测系统的第二实施例。在第二实施例中，所述代码检测系统还包括：代码扫描模块300；其中，所述代码扫描模块300分别与所述代码解析模块100和所述代码检测模块200相连。所述代码扫描模块300，用于对所述代码解析模块100发送的目标程序代码块进行扫描。需要说明的是，代码扫描模块300可以对解析出来的目标程序代码块进行统计和储存，并对目标程序代码块进行扫描。其中，代码扫描模块300扫描的对象可以是单功能代码块信息，也可以使整个功能代码块信息，代码扫描模块可以以OB1代码块为入口，进行功能块内部和功能块调用的扫描。所述代码检测模块200，还用于在所述代码扫描模块300扫描所述目标程序代码块时，通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。应当理解的是，代码检测模块200和代码扫描模块300之间密切联合，代码扫描模块300在对目标程序代码块进行扫描时，代码检测模块200也同时进行漏洞检测。所述代码检测模块200，还用于将漏洞检测结果发送至所述代码扫描模块300。可以理解的是，上述漏洞检测结果可以为通过预设漏洞知识库对目标程序代码块进行遍历匹配，在遍历匹配结束时，生成漏洞检测结果。实际应用中，可以将目标程序代码块中的代码与预设漏洞知识库中的每一种漏洞类型进行匹配，其时间复杂度为o，在完成与预设漏洞知识库中所有的漏洞类型的遍历后，若目标程序代码块中的漏洞与预设漏洞知识库中的漏洞匹配成功，就可以显示匹配成功的漏洞类型，生成对应的漏洞检测结果，其中，漏洞检测结果如图4所示，可以包括目标代码块中存在的漏洞数据、漏洞等级和漏洞类型个数等信息。所述代码扫描模块300，还用于基于所述漏洞检测结果生成扫描结果，并将所述扫描结果输出为目标检测报告文件。需要说明的是，上述扫描结果可以为代码扫描模块300扫描的代码检测模块200对PLC工程项目代码进行漏洞检测的检测结果，实际应用中，代码扫描模块300可以在代码检测模块200进行代码的漏洞检测时，实时获取对应的漏洞检测结果，从而生成扫描结果。应当理解的是，上述目标检测报告文件可以为代码扫描模块300基于代码检测模块200的漏洞检测结果生成的PDF格式或XML格式的文件，如图5所示，图5为PDF格式的检测报告文件，检测报告文件中可以包括项目名称、程序代码块信息和漏洞扫描信息等。实际应用中，代码扫描模块300还会对代码解析模块100解析出来的目标项目信息进行统计和储存，相应的，扫描结果是基于目标项目信息和漏洞检测结果生成的。在具体实现中，代码解析模块100对PLC工程项目文件进行分析，获得目标项目信息和不同类型的代码块，代码扫描模块300对目标项目信息和各类代码块进行扫描，此时代码检测模块200可以在代码扫描模块300扫描各类代码块的同时进行漏洞检测，生成漏洞检测结果，代码扫描模块300基于目标项目信息和漏洞检测结果生成对应的扫描结果，并将扫描结果以PDF格式或XML格式输出为检测报告文件，此外，用户还可以通过安装并运行相应的窗体应用程序项目，从而可以在对应的客户端界面查看漏洞扫描结果。本实施例通过代码扫描模块300对目标程序代码块进行扫描，代码检测模块200在代码扫描模块300进行代码扫描时通过预设漏洞知识库进行漏洞检测，获得漏洞检测结果，代码扫描模块300基于漏洞检测结果输出对应的检测报告文件，从而可以将PLC过程项目文件中存在的漏洞信息导出为PDF格式或XML格式的文件，使漏洞检测数据持久化保存且方便用户进行查看，提高了用户体验。基于上述代码检测系统的各实施例，提出本发明基于代码检测系统的代码检测方法第一实施例。参考图6，图6为本发明基于代码检测系统的代码检测方法第一实施例的流程示意图。本实施例中，所述基于代码检测系统的代码检测方法包括以下步骤：步骤S10：获取PLC工程项目文件中不同类型的代码块。需要说明的是，需要说明的是，本实施例的方法的执行主体可以为对PLC工程项目文件进行代码检测的代码检测设备，或者是其他能够实现相同或相似功能的、包含了该代码检测设备的代码检测系统。此处以代码检测系统对本实施例和下述各实施例提供的代码检测方法进行具体说明。可以理解的是，在接收到PLC工程项目文件时，首先对项目文件类型进行识别，若系统支持该项目类别，则对该项目进行完整性校验，在校验通过时，对PLC工程项目文件进行解析，获得该PLC项目的不同类型的程序代码块信息，其中，程序代码块信息包括：OB组织块、DB数据库、FC功能块和FB背景功能块。步骤S20：对各类代码块进行解析，并将解析后的各类代码块以预设代码格式输出为目标程序代码块。应当理解的是，通过预设代码格式将解析后的各类代码块输出为目标程序代码块可以实现将PLC代码的梯形图、功能块图、顺序功能流程图等解析成结构化文本。步骤S30：通过预设漏洞知识库对所述目标程序代码块进行漏洞检测。可以理解的是，通过预设漏洞知识库对目标程序代码块进行漏洞检测后可以获得对应的漏洞信息，其中，漏洞信息中可以包括漏洞ID、漏洞描述、漏洞等级、修复等级、漏洞涉及的指令信息以及实例信息，有助于用户根据这些信息了解漏洞情况。进一步地，为了方便用户对漏洞检测结果进行查看，上述步骤S30之后，所述方法还包括：获取所述PLC工程项目文件的目标项目信息；基于所述目标项目信息和漏洞检测结果生成目标检测报告文件。本实施例通过对PLC工程项目文件中不同类型的代码块进行解析，并将解析后的代码块以预设代码格式输出为目标程序代码块，再通过预设漏洞知识库对目标程序代码块进行漏洞检测，最后基于漏洞检测结果和PLC工程项目文件的目标项目信息生成对应的检测报告文件，从而可以使用户通过查看检测报告文件获取PLC工程项目文件中的漏洞信息，了解漏洞情况，并且可以根据检测报告文件中提供的修复方案对存在的漏洞进行修复，从而保障工业控制设备的设备安全。参考图7，图7本发明基于代码检测系统的代码检测方法第二实施例的流程示意图。基于上述第一实施例，为了通过预设漏洞知识库对目标程序代码块中的漏洞进行检测，本实施例中，所述步骤S30包括：步骤S301：获取预设漏洞知识库中的若干个漏洞类型。需要说明的是，上述若干个漏洞类型可以为预先在预设漏洞知识库中指定的目标程序代码块可能会出现的漏洞类型，例如：操作数地址重复、程序中已定义的程序块未引用等漏洞。步骤S302：将所述目标程序代码块对各个漏洞类型进行遍历匹配。可以理解的是，上述遍历匹配可以为目标程序块中每一个网格代码对预设漏洞知识库中的每一类漏洞进行遍历，并对各类漏洞进行匹配，查看目标程序块中是否出现预设漏洞知识库中存在的漏洞类型。步骤S303：在匹配成功时，获取所述目标程序代码块对应的漏洞类型。可以理解的是，在目标程序代码块中出现了预设漏洞知识库中指定的漏洞类型时，则匹配成功，此时可以获取目标程序代码块中存在的漏洞类型。进一步地，为了对目标程序代码块中出现的操作数地址重复情况进行漏洞匹配，上述步骤S303包括：对所述目标程序代码块中每一行代码进行分割；在检测到所述目标程序代码块中存在类型转换语句时，根据所述类型转换语句所在行向所述目标程序代码块的上一行和下一行进行查找；在检测到第一目标转换指令和第二目标转换指令时，将所述第一目标转换指令和所述第二目标转换指令对应的操作数转换为相同格式的操作数；通过地址重复匹配算法对所述操作数进行验证；若出现重复地址，则所述目标程序代码块对应的漏洞类型为操作数地址重复。可以理解的是，对于类型转换语句DTR和BTI等有着需要转换的两个变量，对于需要转换类型的两个in、out量，转换为语句表后为L和T，如果存在操作数地址重复，会导致其数值不精确以及后续不能对其数值进行改变的错误，因此需要对这种类型的漏洞进行检测。在具体实现中，首先按行读取目标程序代码块，并对读取的每一行代码进行分割，根据检测到的DTR等转换地址的行，向这一行的上方或下方查找第一个L和T指令，对于检测到的L和T指令，得到L和T指令对应的操作数后，将L和T指令对应的操作数转换为相同格式的操作数，再对相同格式的操作数进行地址重复匹配算法，若地址正确则跳过对应的代码，若出现重复地址则报错，说明目标程序代码块中存在操作数地址重复的漏洞。本实施例通过将目标代码块中的代码与预设漏洞知识库中各个漏洞类型进行遍历匹配，在匹配与对应的漏洞类型匹配成功后，获取对应的漏洞类型，从而可以获取PLC工程项目文件中出现的所有漏洞类型，完成对PLC工程项目文件的非语法性漏洞检测。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者系统不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者系统所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者系统中还存在另外的相同要素。上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台终端设备执行本发明各个实施例所述的方法。以上仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
