标题title
一种天气雷达数据格式存储及读取方法
摘要abst
本发明公开了一种天气雷达数据格式存储及读取方法，其中存储方法包括：获取天气雷达基数据；天气雷达基数据由多个PPI数据构成；每个PPI数据由多个径向数据构成；将径向数据中的反射率因子参数数据进行回波确定二值化操作，生成回波确定字节；回波确定字节带有是否存在回波的标识；将回波确定字节作为位置掩码，控制径向数据中各个探测参数数据的存储。该存储方法利用反射率因子的回波数据生成位置掩码，显著提高了天气雷达数据的存储效率。
权利要求书clms
1.一种天气雷达数据格式存储方法，其特征在于，包括：获取天气雷达基数据；所述天气雷达基数据由多个PPI数据构成；每个所述PPI数据由多个径向数据构成；将所述径向数据中的反射率因子参数数据进行回波确定二值化操作，生成回波确定字节；所述回波确定字节带有是否存在回波的标识；将所述回波确定字节作为位置掩码，控制所述径向数据中各个探测参数数据的存储；所述探测参数为同时间探测到的同径向其他探测参数。2.如权利要求1所述的一种天气雷达数据格式存储方法，其特征在于，将所述径向数据中的反射率因子参数数据进行回波确定二值化操作，生成回波确定字节，包括：将所述径向数据中的反射率因子参数数据进行有无回波二值化；将二值化的数据通过第一标记标识为存在回波；将二值化的数据通过第二标记标识为不存在回波；根据所述第一标记和第二标记，生成回波确定字节。3.如权利要求1所述的一种天气雷达数据格式存储方法，其特征在于，将所述回波确定字节作为位置掩码，控制所述径向数据中各个探测参数数据的存储，包括：将所述回波确定字节作为位置掩码，控制所述径向数据中各个探测参数数据只存储有回波的数据，去除无回波的数据。4.一种天气雷达数据格式读取方法，其特征在于，适用于如权利要求1～3任一项所述的天气雷达数据格式存储方法，该读取方法包括：读取径向数据中反射率因子参数数据的位置掩码；所述位置掩码为回波确定字节；多个所述径向数据构成PPI数据；多个所述PPI数据构成所述天气雷达基数据；根据所述回波确定字节，对各个探测参数数据按顺序检索标识存在回波的字节，确定回波数据的位置；根据所述回波数据的位置，从所述径向数据中读取各个探测参数的回波数据，并将所述回波数据按照所述位置掩码的位置放置，完成天气雷达基数据的读取。
说明书desc
技术领域本发明涉及数据格式存储及读取技术领域，特别涉及一种天气雷达数据格式存储及读取方法。背景技术多普勒天气雷达能探测到原始反射率因子、反射率因子、多普勒速度、谱宽数据；双偏振天气雷达除了可以探测到上述数据外还能探测到相关系数、差分发射率、差分相移、差分相移率等数据。中国气象局的标准天气雷达数据格式和各天气雷达厂家自定义雷达数据格式，在数据存储时无优化、无压缩，存储效率低。双偏振天气雷达的9层仰角的单个数据文件可达30M，相控阵雷达的36层仰角的数据文件超过600M，存储效率低。此基数据太大不利于数据的传输存储以及后续的分析处理。例如，新一代天气雷达CINRAD/SAD以VCP21D扫描模式采集的基数据为9个仰角，11个PPI的数据；其中每个PPI有366个径向，探测距离为230km，距离分辨率为250米，且每个径向有920个数据，共有8个探测参数，每个数据用1个字节存储数据，那么不算公共数据块和径向数据头，数据大小就为366×11×920×8＝29631360bytes，约30M大小。S波段双偏振相控阵天气雷达，36层，每层366个径向，探测距离为230km，距离分辨率为62.5米，每个径向有3680个数据，存储7种探测参数，每个探测参数用短整形存储占2个字节，数据大小就为366×36×4000×7×2＝678827520bytes，约663M大小。由此可见，现有天气雷达探测数据的实时传输的时候需要很大的带宽来传输数据，效率极低。历史资料数据的存储的现有办法为用第三方压缩软件或算法压缩数据文件，压缩率在8％到20％之间，每次使用数据的时候需要先解压，数据分析处理效率低。根据数据分析，其主要原因在于各雷达探测数据的无回波数据在天气雷达探测中的占比非常高，在各参数的数据中都要存储。根据天气雷达探测原理，天气雷达探测的数据是以反射率因子为基础的，只有有反射率因子回波数据才会有多普勒速度、谱宽、相关系数、差分发射率、差分相移、差分相移率等回波数据，所以每个探测参数都存储无回波数据是大量的重复存储。而在雷达探测的时候大气中无回波的数据占绝大多数，尤其是无降水的晴空天气，无回波数据可占比97％。因此，在现有天气雷达探测数据存储的基础上，如何在记录有回波数据存储的前提下，去除无回波数据存储，成为本领域技术人员亟需解决的问题。发明内容鉴于上述问题，本发明提出了一种至少解决上述部分技术问题的天气雷达数据格式存储及读取方法，该方法利用反射率因子的回波数据生成位置掩码，显著提高了天气雷达数据的存储及读取效率。本发明实施例提供一种天气雷达数据格式存储方法，包括：获取天气雷达基数据；所述天气雷达基数据由多个PPI数据构成；每个所述PPI数据由多个径向数据构成；将所述径向数据中的反射率因子参数数据进行回波确定二值化操作，生成回波确定字节；所述回波确定字节带有是否存在回波的标识；将所述回波确定字节作为位置掩码，控制所述径向数据中各个探测参数数据的存储；所述探测参数为同时间探测到的同径向其他探测参数。进一步地，将所述径向数据中的反射率因子参数数据进行回波确定二值化操作，生成回波确定字节，包括：将所述径向数据中的反射率因子参数数据进行有无回波二值化；将二值化的数据通过第一标记标识为存在回波；将二值化的数据通过第二标记标识为不存在回波；根据所述第一标记和第二标记，生成回波确定字节。进一步地，将所述回波确定字节作为位置掩码，控制所述径向数据中各个探测参数数据的存储，包括：将所述回波确定字节作为位置掩码，控制所述径向数据中各个探测参数数据只存储有回波的数据，去除无回波的数据。本发明实施例还提供一种天气雷达数据格式读取方法，适用于如上述任一项所述的天气雷达数据格式存储方法，该读取方法包括：读取径向数据中反射率因子参数数据的位置掩码；所述位置掩码为回波确定字节；多个所述径向数据构成PPI数据；多个所述PPI数据构成所述天气雷达基数据；根据所述回波确定字节，对各个探测参数数据按顺序检索标识存在回波的字节，确定回波数据的位置；根据所述回波数据的位置，从所述径向数据中读取各个探测参数的回波数据，并将所述回波数据按照所述位置掩码的位置放置，完成天气雷达基数据的读取。本发明实施例提供的上述技术方案的有益效果至少包括：本发明实施例提供的一种天气雷达数据格式存储方法，包括：获取天气雷达基数据；天气雷达基数据由多个PPI数据构成；每个PPI数据由多个径向数据构成；将径向数据中的反射率因子参数数据进行回波确定二值化操作，生成回波确定字节；回波确定字节带有是否存在回波的标识；将回波确定字节作为位置掩码，控制径向数据中各个探测参数数据的存储。该方法利用反射率因子的回波数据生成位置掩码，显著提高了天气雷达数据的存储效率。本发明的其它特征和优点将在随后的说明书中阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点可通过在所写的说明书、权利要求书、以及附图中所特别指出的结构来实现和获得。下面通过附图和实施例，对本发明的技术方案做进一步的详细描述。附图说明附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。在附图中：图1为本发明实施例提供的天气雷达数据格式存储方法流程图；图2为本发明实施例提供的天气雷达基数据文件存储示意图一；图3为本发明实施例提供的天气雷达基数据文件存储示意图二；图4为本发明实施例提供的单根径向数据根据位置掩码存储编码示意图一；图5为本发明实施例提供的单根径向数据根据位置掩码存储编码示意图二。具体实施方式下面将参照附图更详细地描述本公开的示例性实施例。虽然附图中显示了本公开的示例性实施例，然而应当理解，可以以各种形式实现本公开而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更透彻地理解本公开，并且能够将本公开的范围完整的传达给本领域的技术人员。本发明实施例提供一种天气雷达数据格式存储方法，参照图1所示，包括：获取天气雷达基数据；天气雷达基数据由多个PPI数据构成；每个PPI数据由多个径向数据构成；将径向数据中的反射率因子参数数据进行回波确定二值化操作，生成回波确定字节；回波确定字节带有是否存在回波的标识；将回波确定字节作为位置掩码，控制径向数据中各个探测参数数据的存储；探测参数为同时间探测到的同径向其他探测参数。本实施例提供的天气雷达数据格式存储方法，利用反射率因子的回波数据，生成位置掩码，提高了天气雷达数据的存储效率。下面对该方法进行具体阐述：参照图2和图3所示，天气雷达基数据的存储是以径向数据存储为核心的，解决单根径向数据的存储，就能解决整个基数据中所有径向的存储。本方法把径向数据的反射率因子有无回波二值化，然后把二值化数据用1比特的0、1表示，那么一个字节有8比特可以表示8个位置的数据有无，以920个径向数据为例，920个数据的径向可以用115字节表示完成回波的有无。将这115个字节作为位置掩码，之后的同时间探测到的同径向其他探测参数的径向数据只存储有回波的数据，去除无回波数据，参照图4所示。参照图5所示，假如单根径向中只有13个回波数据，用此方法存储单根径向的存储空间由7,360字节锐减为219字节，存储空间只约为原来的3％，效果非常显著，根据有回波数据的多少这个比例会有所波动。天气雷达基数据中有回波数据率一般不超过10％，以10％的有回波数据计算，整个基数据在编码前后的存储空间比为不超过14％。其余径向照此方法循环编码即可完成数据的高效存储。在读取数据的时候先读取反射率因子的115字节的位置掩码，按顺序检索知道有回波数据的位置，再读取有回波的数据按掩码位置放置，其余设置为无回波数据，即可还原920个径向数据。其余探测参数可以以反射率因子的115个字节作为自己的位置掩码，做类似操作，也可以还原920个这个探测参数的径向数据。本发明实施例还提供了一种天气雷达数据格式读取方法，包括：读取径向数据中反射率因子参数数据的位置掩码；位置掩码为回波确定字节；多个径向数据构成PPI数据；多个PPI数据构成天气雷达基数据；根据回波确定字节，对各个探测参数数据按顺序检索标识存在回波的字节，确定回波数据的位置；根据回波数据的位置，从径向数据中读取各个探测参数的回波数据，并将回波数据按照位置掩码的位置放置，完成天气雷达基数据的读取。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似部分互相参见即可。显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围之内，则本发明也意图包含这些改动和变型在内。
