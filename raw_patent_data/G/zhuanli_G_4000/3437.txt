标题title
一种基于改进YOLOv5的变压器漏油检测方法
摘要abst
本发明公开了一种基于改进YOLOv5的变压器漏油检测方法，其包括以下步骤：S1、构建变压器漏油图像数据集；S2、构建改进YOLOv5网络模型；S3、采用变压器漏油图像数据集对改进YOLOv5网络模型进行训练，得到训练后的YOLOv5网络模型；S4、采用训练后的YOLOv5网络模型对目标变压器图像进行识别，将训练后的YOLOv5网络模型的输出结果作为识别结果，完成变压器漏油检测。本发明通过基础YOLOv5网络模型FPN结构基础上加入一个上采样模块和一个下采样模块，来使得网络能够将变压器相关图像中不同层的特征信息进行跨层融合，使得网络能够更好的学习这些特征，从而增加模型对变压器漏油的检测准确率。
权利要求书clms
1.一种基于改进YOLOv5的变压器漏油检测方法，其特征在于，包括以下步骤：S1、构建变压器漏油图像数据集；S2、构建改进YOLOv5网络模型：将基础YOLOv5网络模型的Neck网络的80*80链路输出端连接至第一拼接层的一个输入端；在基础YOLOv5网络模型的Neck网络的第一个CBL模块的输出端连接一个上采样模块，将上采样模块的输出端连接至第一拼接层的另一个输入端；将第一拼接层的输出端作为基础YOLOv5网络模型的Neck网络的80*80链路的新输出端；将基础YOLOv5网络模型的Neck网络的20*20链路输出端连接至第二拼接层的一个输入端，在基础YOLOv5网络模型的Neck网络的80*80链路输出端连接一个下采样模块，将下采样模块的输出端连接至第二拼接层的另一个输入端，将第二拼接层的输出端作为基础YOLOv5网络模型的Neck网络的20*20链路的新输出端；S3、采用变压器漏油图像数据集对改进YOLOv5网络模型进行训练，得到训练后的YOLOv5网络模型；S4、采用训练后的YOLOv5网络模型对目标变压器图像进行识别，将训练后的YOLOv5网络模型的输出结果作为识别结果，完成变压器漏油检测。2.根据权利要求1所述的基于改进YOLOv5的变压器漏油检测方法，其特征在于，步骤S1的具体方法为：获取并统一变压器相关图像的大小，将存在漏油图像作为正样本，将不包含漏油的图像作为负样本，得到初始图像数据集；对初始图像数据集进行数据扩充，得到用于训练改进YOLOv5网络模型的变压器漏油图像数据集。3.根据权利要求1所述的基于改进YOLOv5的变压器漏油检测方法，其特征在于，步骤S2中上采样模块包括依次连接的第一卷积层、第一上采样层和第二上采样层；第一卷积层的输入端为上采样模块的输入端，第二上采样层的输出端为上采样模块的输出端。4.根据权利要求3所述的基于改进YOLOv5的变压器漏油检测方法，其特征在于，第一卷积层的大小为1×1；第一上采样层和第二上采样层均采用最近邻图像差值算法进行上采样，第一上采样和第二上采样的采样倍数均为4。5.根据权利要求1所述的基于改进YOLOv5的变压器漏油检测方法，其特征在于，步骤S2中下采样模块包括依次连接的第二卷积层、第一下采样层和第二下采样层；第二卷积层的输入端为下采样模块的输入端；第二下采样层的输出端为下采样模块的输出端。6.根据权利要求5所述的基于改进YOLOv5的变压器漏油检测方法，其特征在于，第二卷积层的大小为1×1；第一下采样层和第二下采样层均采用卷积核大小均为3、步距均为2、填充均为1的卷积层。7.根据权利要求1所述的基于改进YOLOv5的变压器漏油检测方法，其特征在于，基础YOLOv5网络模型为YOLOv5s网络模型，训练过程中的损失函数为WIoU损失函数。
说明书desc
技术领域本发明涉及变压器漏油检测领域，具体涉及一种基于改进YOLOv5的变压器漏油检测方法。背景技术目前，电力是人类生活中不可或缺的动力源，因而电网公司在电力运行工作方面压力巨大，包括对电力正常运行维持，电器设备检修与维护等。其中，变压器在电力正常运行中起到关键作用，而变压器油在维护变压器正常运转中又起到至关重要的作用。变压器油，是石油经酸碱精制处理，分馏得到的纯净稳定、粘度小、绝缘性好、冷却性好的淡黄色透明液体，其主要成分为烷烃、环烷族饱和烃、芳香族不饱和烃等化合物的混合物，相对密度0.895，凝固点＜-45℃，常被用于变压器、电抗器、互感器、套管等油浸式电气设备中。变压器油具有以下五种作用：绝缘：通常情况下，认为空气的介电常数与真空中的介电常数相等为1.0，而变压器油的介电常数为2.25，变压器油的绝缘强度比空气的大得多。所以，变压器油通常被用于电气设备中，将存在电势差的带电部分分隔开来，以防止短路的发生。冷却：变压器在带电运行过程中，电流通过线圈时，因电阻引起功率损耗，这部分损耗称为“铜耗”；电流通过铁芯时，由于铁芯磁通发生作用，引起功率损耗，这部分损耗称为“铁芯损耗”，且这两部分损耗均以发热的形式表现出来。如果不将线圈内的这种热量散发出去，它必然会使线圈和铁芯内积蓄的热量越积越多而使铁芯内部温度升高，从而会损坏线圈外部包覆的固体绝缘，以致烧毁线圈。一般情况下，通过填充变压器油来吸收内部产生的这部分热量，利用变压器油良好的导热性，使热量散发出来，从而保证电力设备的安全运行。消弧：在开关设备中，变压器油主要起消灭电弧的作用。当油浸开关切断电力负荷时，其固定触头和滑动触头之间会产生电弧，使弧柱上的温度急剧升高，如果不将弧柱的热量降低，使触头冷却，那么在初始电弧发生之后，还会有连续的电弧产生，很容易使设备烧毁，同时还可能会引起过电压，从而损坏电力设备。填充变压器油之后，开关开断受到电弧作用时，高温会使变压器油发生剧烈的热分解，而产生约70％的氢气，同时由于氢的导热系数较大，此时氢气就能够吸收超多的热，并且将热量传导至油中，而直接将触头冷却，从而到达了灭弧的目的。保护：由于变压器油充填在绝缘材料的空隙中，所以能够起到保护铁芯和线圈组件的作用。防氧化：同样，由于变压器油通常充填在绝缘材料的空隙之中，因此可将易于氧化的纤维素和其它材料所吸收的氧含量减少到最低限度，延缓氧化反应对绝缘材料的影响。但是，如果不能及时检测变压器漏油问题，随着变压器油的泄漏，就会影响内部变压器油的介电常数，影响变压器油的绝缘强度，甚至可能引发击穿、短路等情况造成设备损坏；漏油问题还可能会使变压器运转不流畅，造成机器间歇性运转，产生电力系统电压不稳定等问题；且还可能会造成变压器不能及时散热，供电线路温度过高，导致变压器严重的故障，甚至会造成大面积停电；同时，变压器漏油问题还会污染周边环境。所以，在电力安全生产中，对变压器漏油隐患的检测就变得尤为重要。很长时间以来，对变压器漏油的监测主要依靠人工巡检来完成，存在检测不及时，检测效率低等问题。随着巡检机器人和视频监控在变电站中的广泛应用，不用依靠人工巡检就可以快速采集到大量的监控图像，有助于及早发现变压器漏油情况，维护变压器的正常运行。虽然不再需要人工进行巡检，但对采集数据的处理与判断仍然是人工进行的，这意味着，长时间关注类似的图像数据会带来视觉疲劳，从而影响人工检测效率和检测精度。随着科学技术的发展，使用各种传感器来检测油气泄漏的方法被相继提出，但利用传感器来检测变压器漏油的方法，容易收到外界环境改变的干扰，可靠性不高。还有学者提出利用变压器油作为矿物油所具有的荧光特性通过图像处理的方法来判断变压器是否漏油，虽然能够有效的检测变压器漏油情况，但通常情况下只能检测夜间的漏油情况。且检测准确率不是很高，只有92.23％。发明内容针对现有技术中的上述不足，本发明提供的一种基于改进YOLOv5的变压器漏油检测方法解决了现有技术检测变压器漏油准确率低的问题。为了达到上述发明目的，本发明采用的技术方案为：提供一种基于改进YOLOv5的变压器漏油检测方法，其包括以下步骤：S1、构建变压器漏油图像数据集；S2、构建改进YOLOv5网络模型：将基础YOLOv5网络模型的Neck网络的80*80链路输出端连接至第一拼接层的一个输入端；在基础YOLOv5网络模型的Neck网络的第一个CBL模块的输出端连接一个上采样模块，将上采样模块的输出端连接至第一拼接层的另一个输入端；将第一拼接层的输出端作为基础YOLOv5网络模型的Neck网络的80*80链路的新输出端；将基础YOLOv5网络模型的Neck网络的20*20链路输出端连接至第二拼接层的一个输入端，在基础YOLOv5网络模型的Neck网络的80*80链路输出端连接一个下采样模块，将下采样模块的输出端连接至第二拼接层的另一个输入端，将第二拼接层的输出端作为基础YOLOv5网络模型的Neck网络的20*20链路的新输出端；S3、采用变压器漏油图像数据集对改进YOLOv5网络模型进行训练，得到训练后的YOLOv5网络模型；S4、采用训练后的YOLOv5网络模型对目标变压器图像进行识别，将训练后的YOLOv5网络模型的输出结果作为识别结果，完成变压器漏油检测。进一步地，步骤S1的具体方法为：获取并统一变压器相关图像的大小，将存在漏油图像作为正样本，将不包含漏油的图像作为负样本，得到初始图像数据集；对初始图像数据集进行数据扩充，得到用于训练改进YOLOv5网络模型的变压器漏油图像数据集。进一步地，步骤S2中上采样模块包括依次连接的第一卷积层、第一上采样层和第二上采样层；第一卷积层的输入端为上采样模块的输入端，第二上采样层的输出端为上采样模块的输出端。进一步地，第一卷积层的大小为1×1；第一上采样层和第二上采样层均采用最近邻图像差值算法进行上采样，第一上采样和第二上采样的采样倍数均为4。进一步地，步骤S2中下采样模块包括依次连接的第二卷积层、第一下采样层和第二下采样层；第二卷积层的输入端为下采样模块的输入端；第二下采样层的输出端为下采样模块的输出端。进一步地，第二卷积层的大小为1×1；第一下采样层和第二下采样层均采用卷积核大小均为3、步距均为2、填充均为1的卷积层。进一步地，基础YOLOv5网络模型为YOLOv5s网络模型，训练过程中的损失函数为WIoU损失函数。本发明的有益效果为：1、本发明通过基础YOLOv5网络模型FPN结构基础上加入一个上采样模块和一个下采样模块，来使得网络能够将变压器相关图像中不同层的特征信息进行跨层融合，使得网络能够更好的学习这些特征，从而增加模型对变压器漏油的检测准确率。2、本发明通过引入具有动态非单调聚焦机制的Wise-IoU边界框损失函数来加快网络的训练与推理，通过权衡低质量样本和高质量样本的学习进一步提高模型在变压器漏油识别方面的整体性能，增强了对变压器漏油等复杂场景的检测能力。附图说明图1为本方法的流程示意图；图2为现有YOLOv5s网络模型结构示意图；图3为改进YOLOv5网络模型结构示意图；图4为上采样模块与第一拼接层的结构示意图；图5为下采样模块与第二拼接层的结构示意图；图6为IoU示意图；图7为原YOLOv5s进行变压器漏油识别的训练损失曲线；图8为原YOLOv5s进行变压器漏油识别的训练过程曲线；图9为改进YOLOv5进行变压器漏油识别的训练损失曲线；图10为改进YOLOv5进行变压器漏油识别的训练过程曲线；图11为部分变压器漏油测试集的检测结果。具体实施方式下面对本发明的具体实施方式进行描述，以便于本技术领域的技术人员理解本发明，但应该清楚，本发明不限于具体实施方式的范围，对本技术领域的普通技术人员来讲，只要各种变化在所附的权利要求限定和确定的本发明的精神和范围内，这些变化是显而易见的，一切利用本发明构思的发明创造均在保护之列。如图1、图2和图3所示，该基于改进YOLOv5的变压器漏油检测方法包括以下步骤：S1、构建变压器漏油图像数据集；S2、构建改进YOLOv5网络模型：将基础YOLOv5网络模型的Neck网络的80*80链路输出端连接至第一拼接层的一个输入端；在基础YOLOv5网络模型的Neck网络的第一个CBL模块的输出端连接一个上采样模块，将上采样模块的输出端连接至第一拼接层的另一个输入端；将第一拼接层的输出端作为基础YOLOv5网络模型的Neck网络的80*80链路的新输出端；将基础YOLOv5网络模型的Neck网络的20*20链路输出端连接至第二拼接层的一个输入端，在基础YOLOv5网络模型的Neck网络的80*80链路输出端连接一个下采样模块，将下采样模块的输出端连接至第二拼接层的另一个输入端，将第二拼接层的输出端作为基础YOLOv5网络模型的Neck网络的20*20链路的新输出端；S3、采用变压器漏油图像数据集对改进YOLOv5网络模型进行训练，得到训练后的YOLOv5网络模型；S4、采用训练后的YOLOv5网络模型对目标变压器图像进行识别，将训练后的YOLOv5网络模型的输出结果作为识别结果，完成变压器漏油检测。步骤S1的具体方法为：获取变压器相关图像，并通过通过Python中的reshape函数将图像大小进行统一，将存在漏油图像作为正样本，将不包含漏油的图像作为负样本，得到初始图像数据集；为了使网络得到更好的训练，可以对初始图像数据集进行数据扩充，得到用于训练改进YOLOv5网络模型的变压器漏油图像数据集。数据扩充主要包含对图片进行翻转、裁剪、亮度变换等操作，除此之外，网络训练迭代15次后，还可以引入Mosaic和Mixup数据增强技术。Mosaic数据增强技术：随机使用4张图片，随机缩放，再随机分布进行拼接，大大丰富了检测数据集，特别是随机缩放增加了很多小目标，让网络的鲁棒性更好。Mixup数据增强技术:对两个样本-标签数据对按比例相加后生成新的样本-标签数据，Mixup不仅具有好的泛化性能，也具有很好的鲁棒性。如图4所示，步骤S2中上采样模块包括依次连接的第一卷积层、第一上采样层和第二上采样层；第一卷积层的输入端为上采样模块的输入端，第二上采样层的输出端为上采样模块的输出端。第一卷积层的大小为1×1；第一上采样层和第二上采样层均采用最近邻图像差值算法进行上采样，第一上采样和第二上采样的采样倍数均为4。即先通过1×1的卷积保持图像宽高不变的同时，将通道维度放缩到与链接的特征层的通道维度一致，然后依次经过两个上采样层，使特征图的宽度和高度变为了原来的4倍，从而得到与连接的特征层一致的高度和宽度；再经过一个拼接层将连接的特征层与采样后的特征层在深度方向上将两个特征层进行拼接，最后送到YOLO Head进行检测。上采样层可以采用Python中最邻近图像插值算法实现。如图5所示，步骤S2中下采样模块包括依次连接的第二卷积层、第一下采样层和第二下采样层；第二卷积层的输入端为下采样模块的输入端；第二下采样层的输出端为下采样模块的输出端。第二卷积层的大小为1×1；第一下采样层和第二下采样层均采用卷积核大小均为3、步距均为2、填充均为1的卷积层。即先通过1×1的卷积保持图像宽高不变的同时，将通道维度放缩到与链接的特征层的通道维度一致，然后依次经过两个下采样层，使特征图的宽度和高度变为了原来的1/4，从而得到与连接的特征层一致的高度和宽度；再经过一个拼接层将连接的特征层与采样后的特征层在深度方向上将两个特征层进行拼接，最后送到YOLO Head进行检测。下采样层采用卷积核大小为3，步距为2，填充为1的卷积层实现。在具体实施过程中，本发明将YOLO Head中的CIoU损失函数替换为Wise-IoU损失函数，解决正负样本，难易样本，高低质量样本的不平衡问题，进一步提高网络的检测准确率。IoU示意图如图6所示，其中，最外侧方框为最小的封闭框，中间的线段为两方框中心点的连线。Wise-IoU具有V1～V3三个版本，本发明采用了V3版本，以加快网络进行变压器漏油识别的训练和推理速度，进一步提高模型对变压器漏油识别的检测准确率。在训练过程中，需要设置训练参数，包括初始学习率及学习率下降方法，迭代次数，梯度下降优化算法，动量参数等。梯度下降优化算法中，可以选择动量随机梯度下降法和Adam优化算法。由于随机梯度下降法容易陷入局部最优值的局限性，研究者们引入了动量的思想，即保留上次更新的梯度方向，在进行下次更新时，下次的梯度方向将会结合上次梯度方向进行参数更新，即动量梯度下降法。动量项γ的取值决定了保留上部分更新的方向信息，取值区间为，初始时可以取0.5，随着迭代逐渐增大。Adam算法是动量梯度下降法和RMSprop算法的结合体，它不仅要保留历史梯度的指数衰减均值vt，还要保存一个指数衰减的历史平方梯度的平均st，另外针对初期迭代vt和st趋向于零的问题，Adam算法还引入了偏差修正，以此在训练初期获得更好的统计。基础YOLOv5网络模型具有四个版本，但均存在三个尺度输出，以640*640的图像大小为例，最终输出80*80、40*40、20*20三个尺度，分别用于检测小，中，大的目标。最终输出80*80尺度的链路即为本发明提及的80*80链路，最终输出20*20尺度的链路即为本发明提及的20*20链路。在本发明的一个实施例中，由于Yolov5s深度最小，特征图宽度最小，不同版本的网络模型具有不同的深度和宽度，按表1中的配置信息来改变网络中CSP模块的深度就能够得到不同的版本，这使得YOLOv5可以适用于不同的应用场景。在本实施例中以YOLOv5s为基础YOLOv5网络模型进行改进，得到本申请的改进YOLOv5网络模型。表1：YOLOv5各版本配置信息表统一变压器漏油数据集图像的规格，将收集到的数据图片设置为640*640的大小，随后输入改进的YOLOv5网络模型进行训练，训练过程如图7、图8、图9和图10所示。如图11所示，将测试集输入到训练好的改进的YOLOv5网络模型中，得到测试集图片的漏油位置，并用标注框进行显示。以测试集的mAP值，召回率和精准率作为评价指标，本方法与直接使用YOLOv5网络进行变压器漏油检测的结果如表2所示。表2：变压器漏油检测结果对比从表2可以看出，本方法相比现有技术在准确率、召回率、平均精确度方面均有明显提高，综合准确率达到了98.7％，远高于其他现有技术的准确率。综上所述，本发明集成了深度学习、目标检测、特征融合、Wise-IoU等关键技术，增强了变压器漏油等复杂场景下的目标检测能力，提高了变压器漏油检测的准确率，有效避免了漏检和误检。为变压器漏油的及时检测，提供了技术支持，保障了变压器的正常运转以及电网的正常运行，实现了对变压器漏油隐患的自动化、智能化和信息化检测，代替传统的人工巡检，减少人力、物力等，效率提升数倍以上，检测精度有了明显的提高，满足工程部署的要求。
