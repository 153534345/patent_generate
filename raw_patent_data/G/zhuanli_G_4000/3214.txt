标题title
一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法
摘要abst
本发明提出一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，包括以下步骤：提取稻穗的反射光谱和样本的病情严重度；利用多生育时期光谱响应特征与相关性分析，提取多个光谱区间的特征波段；创建三波段光谱指数以提高光谱特征对病情严重度的敏感性；最后通过精度对比筛选出最佳波段组合以估算穗腐病严重度。本发明在多生育时期内捕捉对病情严重度敏感的特征波段，构建指数在不同生育时期内的病情估算均适用，且显著提高了发病早期的估算精度；该方法步骤简单，运算代价小，且新型光谱指数所选波段常用于低成本的无人机载多光谱相机，可广泛应用于水稻种质资源筛选和病害监测与防治工作。
权利要求书clms
1.一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，包括以下步骤：步骤1：获取多个生育时期不同病情严重度病穗样本的反射光谱和数字照片；步骤2：基于数字照片提取感病样本的病情严重度；步骤3：利用相关性分析和反射光谱波形分析提取多个特征波段；步骤4：基于特征波段构建双差值光谱指数并确定最佳波段组合，估算多生育时期的水稻穗腐病病情严重度。2.根据权利要求1所述的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，其特征在于，步骤1中多生育时期、不同病情严重度数据获取的具体步骤包括：步骤1-1：每次高光谱图像及数字照片采集时，将5-8个感病稻穗从植株上裁剪下来以一定间距平铺在黑色参考板以提高采集效率；步骤1-2：利用标准反射率白板对获取到的器官尺度高光谱图像进行辐射矫正，获取高光谱图像的反射率数据；利用阈值法将反射率低于0.2的黑色背景去除；步骤1-3：使用ENVI软件的ROI工具将每个稻穗的高光谱图像从中裁剪出来，于空间维对样本高光谱立方进行平均，获取每个样本的平均反射光谱。3.根据权利要求1所述的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，其特征在于，步骤2的具体步骤包括：步骤2-1：使用ENVI软件的ROI工具将每个病穗样本从原始数字照片中裁剪出来；并按照测试顺序与步骤1所得样本的反射光谱一一对应；步骤2-2：基于色彩空间转换将病穗样本的数字照片转化为Lab色彩空间图像；步骤2-3：基于python环境下skimage工具包中的动态阈值方法，结合Lab图像的“b”波段生成用于背景去除的阈值，阈值方法的块尺寸参数设置为2001像素，大于阈值的像素为稻穗像素，小于阈值的像素为背景噪声并将背景掩膜去除；步骤2-4：基于python环境下skimage工具包中的动态阈值方法，结合Lab图像的“a”波段生成用于感病像素识别的阈值，阈值方法的块尺寸参数设置为1001像素，大于阈值的像素为感病像素，小于阈值的像素为健康像素；步骤2-5：定义量化的病情严重度，其计算公式如下：其中，DS表示每个病穗样本的水稻穗腐病病斑比例，即病情严重度；nd和N分别表示感病像素的总数和稻穗像素的总数。4.根据权利要求1所述的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，其特征在于，步骤3中特征波段提取的具体步骤包括：步骤3-1：根据样本生育时期将所有病穗样本划分为多个子数据集，对各子数据集的样本病情严重度进行正态检验，符合正态分布则使用皮尔逊相关性分析，不符合正态分布则使用斯皮尔曼相关性分析，计算各个波段与病情严重度的相关系数；步骤3-2：根据相关系数数值的正负，将反射光谱划分为与病情严重度关联的正相关区间和负相关区间，每个相关性区间内与病情严重度相关系数绝对值最高的波段被选为特征波段，分别提取每个生育时期对应子数据集中的特征波段。5.根据权利要求1所述的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，其特征在于，步骤4中特征波段的筛选及光谱指数的构建：步骤4-1：构建双差值Doubledifference形式光谱指数，其公式为：其中，Rλ1,Rλ2,Rλ3分别为不同步骤3中的三个特征波段，波段编号按照波长增序排列；步骤4-2：从步骤3中提取的特征波段中，选取在多个生育时期内相关系数均最高的红光区间和一个近红外区间；根据多生育时期内相关区间特征波段波长进行近似，从而统一不同生育时期红光区间和近红外区间的特征波段，并将其作为病害指数的两个固定特征波段；根据剩余蓝色光谱区间的特征波段，分别与上述两个固定特征波段建多个双差值光谱指数，对比其多生育时期的病情估算表现，选择在抽穗期、开花期和灌浆期估算精度总和最高的光谱指数，作为最终的病害指数。
说明书desc
技术领域本发明属于作物病害监测领域，特别是一种构建新型病害指数并提高水稻穗腐病发病早期病情严重度估算精度的监测方法。背景技术水稻在我国粮食生产中具有重要地位，及时准确地监测水稻病害的发生情况对保障我国粮食安全和农业生产减药增效起基础作用。水稻穗腐病是一种真菌性病害，受环境气候、栽培品种和种植方式改变的影响，其近年来作为一种新兴病害在我国水稻主产区广泛发生，严重危害水稻的优质高产。目前，已有许多学者利用光谱技术对作物病害进行有效识别和病情估算。常用方式为构建特征。这些特征主要包括光谱参数和植被生理结构参数两类。生理结构参数通常依靠植被辐射传输模型反演获得，由于缺乏可靠的穗辐射传输模型，在稻穗上应用这类方式较为困难。对于光谱参数而言，部分方法则需要使用连续的一段或者大量的光谱信息。例如连续小波变换依赖连续的光谱信号进行特征构建，难以在宽波段数据上利用，应用成本过高。而植被指数方法以特定数学形式对少数几个特征波段进行组合，提升光谱特征敏感性的同时还能够显著降低波段数量需求，实际应用潜力突出。由于病害的光谱响应特征存在一定特异性，例如归一化植被指数NDVI等传统植被指数，用于病情严重度估算精度较低。目前还缺乏一个专门用于水稻穗腐病病情严重度估算的光谱指数。现阶段基于光谱特征技术的病害监测，严重依赖病害侵染过程中作物生理生化参数改变所引起的光谱响应。然而，作物穗器官的生理特性随生育时期发展，也会产生显著差异。现有的穗部病害光谱监测研究多基于接种后数天内，或基于单一时期的数据样本，进行病害监测研究，不同生育时期的病害光谱响应规律是否相同、其病情严重度估算精度是否一致尚不明确。对于穗部病害来说，生育时期与病情严重度也存在一定相关性，抽穗期的稻穗基本处于感病早期，该阶段的病害光谱响应弱，更容易受到稻穗成熟的影响，水稻穗腐病早期监测的可行性及精度仍不明确。鉴于此，目前还缺乏一个机理性强的指数构建方法，使得构建的水稻穗腐病指数能够用于多个生育时期的病情估算，且在发病早期具备较高的估算精度。发明内容本发明所解决的技术问题在于提供一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，通过提取稻穗的反射光谱和样本的病情严重度；利用多生育时期光谱响应特征与相关性分析，提取多个光谱区间的特征波段；创建三波段光谱指数以提高光谱特征对病情严重度的敏感性；最后通过精度对比筛选出最佳波段组合以估算穗腐病严重度。本发明在多生育时期内捕捉对病情严重度敏感的特征波段，构建指数在不同生育时期内的病情估算均适用，且显著提高了发病早期的估算精度；该方法步骤简单，运算代价小，且新型光谱指数所选波段常用于低成本的无人机载多光谱相机，可广泛应用于水稻种质资源筛选和病害监测与防治工作。实现本发明目的的技术解决方案为：一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，包括以下步骤：步骤1：获取多个生育时期不同病情严重度病穗样本的反射光谱和数字照片；步骤2：基于数字照片提取感病样本的病情严重度步骤3：利用相关性分析和反射光谱波形分析提取多个特征波段；步骤4：基于特征波段构建双差值光谱指数并确定最佳波段组合，估算多生育时期的水稻穗腐病病情严重度。进一步的，本发明提出的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，步骤1中多生育时期、不同病情严重度数据获取的具体步骤包括：步骤1-1：每次高光谱图像及数字照片采集时，将5-8个感病稻穗从植株上裁剪下来以一定间距平铺在黑色参考板以提高采集效率；步骤1-2：利用标准反射率白板对获取到的器官尺度高光谱图像进行辐射矫正，获取高光谱图像的反射率数据；利用阈值法将反射率低于0.2的黑色背景去除；步骤1-3：使用ENVI软件的ROI工具将每个稻穗的高光谱图像从中裁剪出来，于空间维对样本高光谱立方进行平均，获取每个样本的平均反射光谱。进一步的，本发明提出的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，步骤2的具体步骤包括：步骤2-1：使用ENVI软件的ROI工具将每个病穗样本从原始数字照片中裁剪出来；并按照测试顺序与步骤1所得样本的反射光谱一一对应；步骤2-2：基于色彩空间转换将病穗样本的数字照片转化为Lab色彩空间图像；步骤2-3：基于python环境下skimage工具包中的动态阈值方法，结合Lab图像的“b”波段生成用于背景去除的阈值，阈值方法的块尺寸参数设置为2001像素，大于阈值的像素为稻穗像素，小于阈值的像素为背景噪声并将背景掩膜去除；步骤2-4：基于python环境下skimage工具包中的动态阈值方法，结合Lab图像的“a”波段生成用于感病像素识别的阈值，阈值方法的块尺寸参数设置为1001像素，大于阈值的像素为感病像素，小于阈值的像素为健康像素；步骤2-5：定义量化的病情严重度，其计算公式如下：其中，DS表示每个病穗样本的水稻穗腐病病斑比例，即病情严重度；nd和N分别表示感病像素的总数和稻穗像素的总数。进一步的，本发明提出的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，步骤3中特征波段提取的具体步骤包括：步骤3-1：根据样本生育时期将所有病穗样本划分为多个子数据集，对各子数据集的样本病情严重度进行正态检验，符合正态分布则使用皮尔逊相关性分析，不符合正态分布则使用斯皮尔曼相关性分析，计算各个波段与病情严重度的相关系数；步骤3-2：根据相关系数数值的正负，将反射光谱划分为与病情严重度关联的正相关区间和负相关区间，每个相关性区间内与病情严重度相关系数绝对值最高的波段被选为特征波段，分别提取每个生育时期对应子数据集中的特征波段。进一步的，本发明提出的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，步骤4中特征波段的筛选及光谱指数的构建：步骤4-1：构建双差值形式光谱指数，其公式为：其中，Rλ1,Rλ2,and Rλ3分别为不同步骤3中的三个特征波段，波段编号按照波长增序排列。步骤4-2：从步骤3中提取的特征波段中，选取在多个生育时期内相关系数均最高的红光区间和一个近红外区间；根据多生育时期内相关区间特征波段波长进行近似，从而统一不同生育时期红光区间和近红外区间的特征波段，并将其作为病害指数的两个固定特征波段。研究表明蓝光波段对病害早期监测重要性高，根据剩余蓝色光谱区间的特征波段，分别与固定波段构建多个双差值光谱指数，对比其多生育时期的病情估算表现选择表现最优的光谱指数，作为最终的病害指数。本发明采用以上技术方案与现有技术相比，具有以下技术效果：1、本发明的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法具备特征波段选择速度快，指数构建简单的特点；2、本发明的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，其构建的病害光谱指数适用于抽穗后多个生育时期的病情估算精度，且能够显著提高发病早期的估算精度；3、本发明的一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，新型指数所选波段常用于低成本无人机载多光谱相机，能够广泛用于水稻生产中的种质筛选及病害监测工作。附图说明图1是本发明的基于光谱分析构建病害指数并提高水稻穗腐病发病早期病情严重估算精度方法的流程图；图2是实施例中使用斯皮尔曼相关性分析计算各个波段与病情严重度的相关系数及特征波段提取示意图；图3是现有指数和本发明所构建的光谱指数与水稻穗腐病严重度的关系对比图；图4是已有光谱指数与本发明所得指数在不同生育时期验证样本的病情严重度估算模型散点图。具体实施方式下面详细描述本发明的实施方式，所实施方式的实例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施方式是是示例性的，仅用于解释本发明，而不能解释为对本发明的限制。本发明实施基于小区试验条件下不同生育时期、不同感病严重度的病穗样本，根据获取的反射光谱提取对病害敏感的特征波段，将其用于病害光谱指数的构建，并用于多时期水稻穗腐病病情严重度估算，具体水稻试验的基本信息和数据获取情况如表1所示。不同生育时期对应获取到的感病稻穗数量如表2所示。表1水稻试验田基本信息表2不同生育时期的水稻病穗样本数量生育时期样本数量抽穗期57开花期161灌浆期184分别于水稻抽穗期、开花期和灌浆期，从水稻试验田中获取器官尺度的感病稻穗反射光谱和高分辨率数字照片。本发明的实验数据获取系统性强，涵盖了江苏省常见的水稻品种，包含了最佳防治时期和重点发病时期，且病情严重度范围和样本数量大，能够有效地验证本发明构建的病害光谱指数在不同栽培品种、不同生育时期及不同感病阶段下水稻穗腐病病情严重度估算的准确性和适应性。如图1所示，一种基于新型三波段光谱指数的水稻穗腐病病情严重度估算方法，具体包括以下步骤：步骤1：获取多生育时期器官尺度下感水稻穗腐病稻穗的高光谱图像及数字照片。选取水稻的抽穗期、开花期和灌浆期在晴朗无云的天气条件下，于中午前后使用龙门架搭载成像高光谱仪和单反相机进行光谱数据和数字照片采集。成像光谱测量采用江苏双利合谱公司生产的GaiaField-V10E推扫式高光谱相机，使用的波段范围为450-800nm。数字照片获取使用日本佳能公司生产的EOS 80D单反相机，最大分辨率为6000×4000像素。穗部图像的采集方式具体为：步骤1-1：选取不同严重程度感病稻穗从植株上剪下，每次将5-8个样本平铺至黑色参考板上并放置与光谱相机正下方进行数据采集。镜头距离样本高度调节至0.4米，并将相机曝光设置为0.4s以避免白色参考板过曝。步骤1-2：利用标准反射率白板对获取到的器官尺度高光谱图像进行辐射矫正，获取高光谱图像的反射率数据；利用阈值法将反射率低于0.2的黑色背景去除；步骤1-3：使用ENVI软件的ROI工具将每个稻穗的高光谱图像从中裁剪出来，于空间维对样本高光谱立方进行平均，获取每个样本的平均反射光谱。步骤2：基于数字照片提取感病样本的病情严重度：步骤2-1：使用ENVI软件的ROI工具将每个病穗样本从原始数字照片中裁剪出来；并按照测试顺序与步骤1所得样本的高光谱图像一一对应；步骤2-2：基于色彩空间转换将病穗样本的数字照片转化为Lab色彩空间图像；步骤2-3：基于python环境下skimage工具包中的动态阈值方法，结合Lab图像的“b”波段生成用于背景去除的阈值，阈值方法的块尺寸参数设置为2001像素，大于阈值的像素为稻穗像素，小于阈值的像素为背景噪声并将背景掩膜去除；步骤2-4：基于python环境下skimage工具包中的动态阈值方法，结合Lab图像的“a”波段生成用于感病像素识别的阈值，阈值方法的块尺寸参数设置为1001像素，大于阈值的像素为感病像素，小于阈值的像素为健康像素；步骤2-5：定义量化的病情严重度，其计算公式如下：其中，DS表示每个病穗样本的水稻穗腐病病斑比例，即病情严重度；nd和N分别表示感病像素的总数和稻穗像素的总数。步骤3：如图2所示，利用相关性分析和反射光谱波形分析提取多个特征波段：步骤3-1：根据样本生育时期将所有病穗样本划分为多个子数据集，实例病穗样本的病情严重度未通过正态检验，使用斯皮尔曼相关性分析计算各个波段与病情严重度的相关系数；步骤3-2：根据相关系数数值的正负，将反射光谱划分为与病情严重度关联的正相关区间和负相关区间，每个相关性区间内与病情严重度相关系数绝对值最高的波段被选为特征波段，分别提取每个生育时期对应子数据集中的特征波段。步骤4：基于特征波段构建双差值光谱指数并确定最佳波段组合，估算多生育时期的水稻穗腐病病情严重度：步骤4-1：构建双差值形式光谱指数，其公式为：其中，Rλ1,Rλ2,and Rλ3分别为不同步骤3中的三个特征波段，波段编号按照波长增序排列。步骤4-2：从步骤3中提取的特征波段中，选取在多个生育时期内相关系数均最高的红光区间和一个近红外区间；根据多生育时期内相关区间特征波段波长进行近似，从而统一不同生育时期红光区间和近红外区间的特征波段，并将其作为病害指数的两个固定特征波段。实例所选红光区间和近红外区间的特征波段分别为675nm和740nm。研究表明蓝光波段对病害早期监测重要性高，根据剩余蓝色光谱区间的特征波段，分别与固定波段构建多个双差值光谱指数，对比其多生育时期的病情估算表现选择表现最优的光谱指数，作为最终的病害指数。实例所选蓝光区间的特征波段为453nm。下面比较本发明提出的方法与归一化色素指数NPCI、光化学指数PRI、归一化植被指数NDVI，在发病早期和多生育时期对水稻穗腐病病情严重度估算的表现。现有指数和本发明所构建的光谱指数与水稻穗腐病严重度的关系对比如图3所示，各方法构建的模型验证散点图如图4所示。从图3和图4可得，本发明方法所生成的光谱指数从病害早期病情严重度估算和多生育时期病情严重度估算方面优于其他光谱指数，本发明的方法可以显著提高抽穗期的病情估算精度，同时兼顾了其他生育时期病情估算精度，消除了生育时期对水稻穗腐病监测的影响，提高了稻穗病害监测在实际生产中的适应性。以上所述仅是本发明的部分实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干改进，这些改进应该是为本发明的保护范围。
