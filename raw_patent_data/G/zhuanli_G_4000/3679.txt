标题title
基于CIM平台三维空间数据的采集与轻量化系统和方法
摘要abst
本发明提出了基于CIM平台三维空间数据的采集与轻量化系统和方法。所述系统包括所述采集与轻量化系统，包括：模型数据采集模块，用于利用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型；其中，所述全要素城市信息模型CIM基础信息库包括地上和地下信息，室内和室外信息；模型构建模块，用于利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景；数据呈现及模型渲染模块，用于对三维可视化场景进行渲染和实时展示。所述方法包括与所述系统模块对应的步骤。
权利要求书clms
1.基于CIM平台三维空间数据的采集与轻量化系统，其特征在于，所述采集与轻量化系统，包括：模型数据采集模块，用于利用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型；模型构建模块，用于利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景；数据呈现及模型渲染模块，用于对三维可视化场景进行渲染和实时展示。2.根据权利要求1所述采集与轻量化系统，其特征在于，所述模型数据采集模块包括：空间数据采集模块，利用过实地观测和./或遥感影像方式获取所述任务目标对象的空间数据；其中，所述空间数据包括矢量数据、影像数据、高程模型数据、地理实体数据、地名地址数据和三维模型数据；空间数据轻量化处理模块，用于利用CIM平台内置的轻量化引擎将BIM数据进行轻量化处理；空间数据存储模块，用于通过多源数据入库配置方式结合目录和索引调用方式对BIM数据和空间数据进行存储和管理。3.根据权利要求2所述采集与轻量化系统，其特征在于，所述空间数据轻量化处理模块包括：几何转换模块，用于通过参数化方式描述单个构件的几何信息，并且，通过三角面片和/或相似性算法减少图元的方式对模型进行几何优化转换；渲染模块，用于使用八叉树剔除不可见图元用以减少进行渲染区域的绘制对象后，对渲染区域的绘制对象进行渲染。4.根据权利要求2所述采集与轻量化系统，其特征在于，所述空间数据轻量化处理模块的运行过程包括：步骤1、遍历BIM模型，统计BIM模型的总包围范围，确定成果BIM树的八叉树结构，并根据模型分布情况调整BIM树类型；步骤2、通过八叉树结构对作为源模型的BIM模型进行空间划分，并动态切割出树的节点瓦片，确保树中的叶子节点能够满足三角面数与纹理精度要求；步骤3、在对节点瓦片进行几何化简，形成简化后的节点所形成的几何图形；步骤4、提取简化后的节点所形成的几何图形，并对所述简化后的节点所形成的几何图形进行纹理处理，保持为例正射状态，获得纹理处理后的BIM模型；步骤5、对BIM模型中的复用模型的保持复用，减少轻量化成果的数据量；步骤6、当出现异常数据时，触发输入模型中的退化三角形对异常数据进行剔除。5.根据权利要求1所述采集与轻量化系统，其特征在于，所述模型构建模块包括：模型平台构建模块，用于利用三维场景定义工具各类三维模型在三维空间场景中布局，并构建任务目标对象对应的三维可视化场景结构；多源数据融合模块，用于将地理要素数据和城市全要素数据融合加载至三维可视化场景结构中，形成任务目标对象对应的三维可视化场景。6.根据权利要求5所述采集与轻量化系统，其特征在于，所述多源数据融合模块包括：数据编码模块，用于对空间数据的组织结构和关联关系进行识别编码；空间数据格式转换模块，用于多种三维模型数据格式、GIS文件格式和倾斜摄影格式进行转换，并放入统一的数据格式下；BIM+GIS数据融合模块，用于利用GIS地理信息坐标系将BIM模型按空间属性和业务属性进行多数据集的融合；物联网空间数据融合模块，用于利用BIM模型坐标系将IOT物联设备进行空间关联和数据关联，并将IOT物联点位和BIM坐标与地理坐标系进行融合关联；视频空间数据融合模块，用于BIM模型及GIS平台的不同空间尺度的视频流融合方式通过物联网对接将视频画面与三维地理信息共同展示。7.根据权利要求1所述采集与轻量化系统，其特征在于，所述数据呈现及模型渲染模块包括：多源数据加载模块，用于对所述空间数据进行分层加载和显示；模型渲染模块，用于利用UE4游戏引擎对三维可视化场景进行渲染。8.基于CIM平台三维空间数据的采集与轻量化方法，其特征在于，所述采集与轻量化方法包括：利用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型；利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景；对三维可视化场景进行渲染和实时展示。9.根据权利要求8所述采集与轻量化系统，其特征在于，用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型，包括：利用过实地观测和./或遥感影像方式获取所述任务目标对象的空间数据；其中，所述空间数据包括矢量数据、影像数据、高程模型数据、地理实体数据、地名地址数据和三维模型数据；利用CIM平台内置的轻量化引擎将BIM数据进行轻量化处理；通过多源数据入库配置方式结合目录和索引调用方式对BIM数据和空间数据进行存储和管理。10.根据权利要求8所述采集与轻量化系统，其特征在于，利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景，包括：利用三维场景定义工具各类三维模型在三维空间场景中布局，并构建任务目标对象对应的三维可视化场景结构；将地理要素数据和城市全要素数据融合加载至三维可视化场景结构中，形成任务目标对象对应的三维可视化场景。
说明书desc
技术领域本发明提出了基于CIM平台三维空间数据的采集与轻量化系统和方法，属于智慧城市基础设施技术领域。背景技术2018年12月19日，中国信息通信研究院发布了《数字孪生城市研究报告》，指出数字孪生技术从制造业逐步延伸拓展至城市空间，深刻影响着城市规划、建设与发展，明确了基于多源数据融合的城市信息模型是数字孪生城市建设的核心，也是智能城市大脑的重点。数字孪生城市既是数字城市的目标，也是智慧城市建设的新高度。近年来，在各部门的协同推进和各地方持续创新实践下，我国新型智慧城市建设已取得显著成效，但仍存在着一些短板和不足：城市的数据孤岛：城市信息模型是智慧城市建设的关键因素，整合多源异构数据资源是智慧城市建设的核心，但由于相关CIM数据标准、法规的缺失和技术的不成熟，使得数据孤岛成为阻碍数据资源整合的最大障碍，造成数据孤岛的原因很多，一方面由于各部门系统分散，缺乏统一规划和数据拉通机制，导致部门之间数据无法融合，从而使得协同治理难以提升；另一方面是技术问题，由于没有很好的数据融合标准、技术和平台，导致各委办局虽然沉淀了大量的数据资源，却无法在跨部门之间形成融合与共享，导致数据重复建设问题。要解决智慧城市各层级、各部门、各系统之间数据融合、信息共享和业务协同机制，重点是解决各系统之间的衔接配合与关联约束关系问题，用系统科学的方法指导智慧城市的复杂系统的规划设计，提高顶层设计的科学性、规范性和可操作性。城市空间数字化程度低：近几年随着智慧城市建设业务的发展，空间数据的时空分辨率、数据精度不断提高，单位面积的数据量急剧增长，同时，决策尺度大幅度增加，从局部区域扩展到全省、全国乃至全球。这些变化对于三维空间数据的管理、处理和可视化方式已难以应对，需要依赖新型技术架构的发展。在以往的智慧城市建设中，对城市空间数字化的重视和建设程度不高，虽然部分城市强调了GIS、BIM等三维信息技术的重要作用，但实际建设过程中，对于这类技术的使用却不尽人意。其中很重要的一个原因是缺少可以高效兼容BIM、GIS等三维数据和模型的承载平台，从而无法对城市要素进行全面的数字化，并基于城市基础设施本身融合交通、环境、教育、医疗、经济、旅游等各类人文数据。通过对城市基础设施的数字化，建立城市CIM平台，既是智慧城市不可或缺的、基础性的信息资源，也是其它信息资源交换共享与协同应用的载体，为其它信息在三维空间和时间交织构成的四维环境中提供时空基础，实现基于统一时空基础下的规划、设计、建设、分析和决策。发明内容本发明提供了基于CIM平台三维空间数据的采集与轻量化系统和方法，用以解决城市的数据孤岛问题及城市空间数字化程度低的问题，所采取的技术方案如下。基于CIM平台三维空间数据的采集与轻量化系统，所述采集与轻量化系统包括：模型数据采集模块，用于利用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型；模型构建模块，用于利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景；数据呈现及模型渲染模块，用于对三维可视化场景进行渲染和实时展示。进一步地，所述模型数据采集模块包括：空间数据采集模块，利用过实地观测和./或遥感影像方式获取所述任务目标对象的空间数据；其中，所述空间数据包括矢量数据、影像数据、高程模型数据、地理实体数据、地名地址数据和三维模型数据；空间数据轻量化处理模块，用于利用CIM平台内置的轻量化引擎将BIM数据进行轻量化处理；空间数据存储模块，用于通过多源数据入库配置方式结合目录和索引调用方式对BIM数据和空间数据进行存储和管理。进一步地，所述空间数据轻量化处理模块包括：几何转换模块，用于通过参数化方式描述单个构件的几何信息，并且，通过三角面片和/或相似性算法减少图元的方式对模型进行几何优化转换；渲染模块，用于使用八叉树剔除不可见图元用以减少进行渲染区域的绘制对象后，对渲染区域的绘制对象进行渲染。进一步地，所述空间数据轻量化处理模块的运行过程包括：步骤1、遍历BIM模型，统计BIM模型的总包围范围，确定成果BIM树的八叉树结构，并根据模型分布情况调整BIM树类型；步骤2、通过八叉树结构对作为源模型的BIM模型进行空间划分，并动态切割出树的节点瓦片，确保树中的叶子节点能够满足三角面数与纹理精度要求；步骤3、在对节点瓦片进行几何化简，形成简化后的节点所形成的几何图形；步骤4、提取简化后的节点所形成的几何图形，并对所述简化后的节点所形成的几何图形进行纹理处理，保持为例正射状态，获得纹理处理后的BIM模型；步骤5、对BIM模型中的复用模型的保持复用，减少轻量化成果的数据量；步骤6、当出现异常数据时，触发输入模型中的退化三角形对异常数据进行剔除。进一步地，所述模型构建模块包括：模型平台构建模块，用于利用三维场景定义工具各类三维模型在三维空间场景中布局，并构建任务目标对象对应的三维可视化场景结构；多源数据融合模块，用于将地理要素数据和城市全要素数据融合加载至三维可视化场景结构中，形成任务目标对象对应的三维可视化场景。进一步地，所述多源数据融合模块包括：数据编码模块，用于对空间数据的组织结构和关联关系进行识别编码；空间数据格式转换模块，用于多种三维模型数据格式、GIS文件格式和倾斜摄影格式进行转换，并放入统一的数据格式下；支持格式包括：ifc、rvt、dgn、catia、fbx、osgb、osg、ive、obj、3ds、dwg、dae、gltf、low、lxo、scn、mdl、md3、md5、smd、m3、3d、ms3d等；BIM+GIS数据融合模块，用于利用GIS地理信息坐标系将BIM模型按空间属性和业务属性进行多数据集的融合；物联网空间数据融合模块，用于利用BIM模型坐标系将IOT物联设备进行空间关联和数据关联，并将IOT物联点位和BIM坐标与地理坐标系进行融合关联；视频空间数据融合模块，用于BIM模型及GIS平台的不同空间尺度的视频流融合方式通过物联网对接将视频画面与三维地理信息共同展示。进一步地，所述数据呈现及模型渲染模块包括：多源数据加载模块，用于对所述空间数据进行分层加载和显示；模型渲染模块，用于利用UE4游戏引擎对三维可视化场景进行渲染。基于CIM平台三维空间数据的采集与轻量化方法，所述采集与轻量化方法包括：利用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型；利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景；对三维可视化场景进行渲染和实时展示。进一步地，用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型，包括：利用过实地观测和./或遥感影像方式获取所述任务目标对象的空间数据；其中，所述空间数据包括矢量数据、影像数据、高程模型数据、地理实体数据、地名地址数据和三维模型数据；利用CIM平台内置的轻量化引擎将BIM数据进行轻量化处理；通过多源数据入库配置方式结合目录和索引调用方式对BIM数据和空间数据进行存储和管理。进一步地，利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景，包括：利用三维场景定义工具各类三维模型在三维空间场景中布局，并构建任务目标对象对应的三维可视化场景结构；将地理要素数据和城市全要素数据融合加载至三维可视化场景结构中，形成任务目标对象对应的三维可视化场景。本发明有益效果：本发明提出了基于CIM平台三维空间数据的采集与轻量化系统和方法。通过对地理信息、三维模型、BIM模型、倾斜摄影模型等多源异构空间数据融合技术、CIM三维空间数据轻量化技术、基于自然物理世界的高逼真渲染技术，使城市变得更易于被感知，城市资源更易于被充分整合、利用，实现对城市各领域的精细化管理，实现对城市资源的集约化利用，实现智慧城市各层级、各部门、各系统之间的数据共享和业务协同机制，从而解决数据孤岛、数据重复建设问题，提高智慧城市顶层设计的科学性、规范性和可操作性。附图说明图1为HDFS体系架构图；图2为MongoDB结构图；图3为Postgres-XL结构图；图4为本发明所述CIM平台三层架构图；图5为本发明所述空间数据轻量化处理全过程；图6为本发明所述BIM模型轻量化过程；图7为本发明所述基于LOD的BIM模型轻量化渲染流程；图8为本发明所述模型平台搭建过程示意图。具体实施方式以下结合附图对本发明的优选实施例进行说明，应当理解，此处所描述的优选实施例仅用于说明和解释本发明，并不用于限定本发明。本发明实施例提出了基于CIM平台三维空间数据的采集与轻量化系统和方法，如图4所示，所述智慧城市CIM平台包括三部分：模型数据采集模块，用于利用统一空间坐标构建全要素城市信息模型CIM基础信息库，同时，对BIM模型进行轻量化处理，形成轻量化的BIM模型；模型构建模块，用于利用全要素城市信息模型CIM基础信息库结合三维场景搭建和编辑场景定义工具，针对任务目标对象构建三维可视化场景；数据呈现及模型渲染模块，用于对三维可视化场景进行渲染和实时展示。具体的：模型数据采集模块，基于统一的空间坐标，构建涵盖地上地下、室内室外的全要素城市信息模型，包括遥感影像数据、高程数据、倾斜摄影数据、BIM数据等建立统一的空间基础信息库，实现多源异构数据逻辑集中，作为城市数据体系的基底。数据来源主要通过实地观测、遥感影像、人工建模、物联网传感器等方式采集获取。模型构建模块，以CIM空间基础信息库为基础，利用三维场景搭建和编辑场景定义工具，将包括倾斜摄影、BIM模型、各类设施设备三维精细化模型等在三维空间中布局，并结合专题业务数据快速构建满足业务场景应用的三维可视化场景。数据呈现及模型渲染模块，利用UE4游戏引擎作为CIM平台三维模型渲染引擎底层技术框架，完美展现数字孪生空间场景，为各类数字孪生应用提供场景支持，通过对城市级别的决策与建设过程中的详实数据的积累，可支持新型智慧城市的建设、保障未来的运营维护、实现智慧化城市管理。其中，所述模型数据的采集包括：空间数据采集模块、空间数据轻量化处理模块、空间数据存储模块。空间数据采集模块，空间数据来源广泛，存储方式和数据格式多种多样，数据采集模块将CIM平台收集到的不同数据源根据定义的规则进行采集，提取出包含所需有效信息的数据，数据类型包括结构化数据、非结构化数据、半结构化数据、GIS数据等多种形态数据。CIM平台为了能够统一管理、融合和应用这些数据，为后期的数据分析与处理提供规范化的数据成果，利用数据汇聚技术将多源异构数据进行聚合。空间数据轻量化处理模块，主要针对BIM模型的轻量化处理，采用CIM平台内置的轻量化引擎对三维模型进行轻量化处理，通过规范化后的轻量化模型在加载的同时具有更细节的层次表达。BIM模型轻量化包括两个阶段：一是几何转换，主要通过参数化方式描述单个构件的几何信息可以对其轻量化，还可以通过三角面片、相似性算法减少图元等方式对模型进行几何优化转换；二是渲染处理，使用八叉树快速剔除不可见图元，减少进行渲染区域的绘制对象，加速单图元渲染速度空间数据存储模块，包括矢量数据、栅格数据、地图瓦片数据和三维模型数据，这些数据的存储管理通常基于关系数据库或一般文件系统。用于空间数据分布式存储系统有：Postgres-XL、MongoDB、HDFS和HBase。基于Hadoop的HDFS实现非结构化数据的存储；通过MongoDB分布式数据库对海量二维或三维的瓦片数据进行存储管理；通过对Elasticsearch分布式数据库实现对流式数据存储管理；大规模的影像数据采用HDFS、HBase等分布式存储技术；大规模的矢量数据存储时，侧重SQL查询的使用Postgres-XL；侧重超大规模矢量数据复杂迭代计算的则使用HDFS，二者都有的话，使用HBase。同时，所述空间数据存储模块采用分布式的可扩展架构，利用多存储节点分担读写负载。HDFS使用主从体系结构，如图1所示，一个HDFS集群包括一个NameNode和成百上千个DataNode。NameNode是一个管理文件系统命名空间的主服务节点，同时管理客户端对文件的访问。DataNode用于管理其上存储的文件块，通常集群中的一个节点对应一个DataNode。在系统内部，大型文件被分成一个或多个文件块，这些文件块被存储在一组DataNode中。NameNode负责文件系统命名空间的操作，包括打开、关闭和重命名文件及目录，同时负责文件块到DataNode的映射。DataNode负责客户端的读写请求，还负责执行文件块的创建、删除等操作。MongoDB设计采用横向扩展，面向文档的数据类型在多台服务器之间进行数据分割，自动处理跨集群的数据和负载，自动重新分配文档。MongoDB中的记录是一个文档，它是一个由字段和值对组成的数据结构。MongoDB文档类似于JSON对象，即一个文档认为是一个对象，字段的数据类型是字符型，它的值除了使用基本的一些类型外，还可以包括其他文档、普通数组和文档数组。如图2所示：一个MongoDB实例，由多个数据库组成；一个数据库由多个集合组成；一个集合由多个文档组成。Postgres-XL是在PostgreSQL基础上将PostgreSQL的SQL解析层的工作和数据存取层的工作分离到不同的两种节点上，分别为Coordinator节点和DataNode节点，如图3所示：每种节点可以配置多个，共同协调完成原本由单个PostgreSQL实例完成的工作，此外，为保证分布模式下事务的正确执行，Postgres-XL增加了一个全局事务管理器节点。Postgres-xl中为避免单点故障，可为所有节点配置Slave节点。Postgres-xl的Coordinator节点是整个集群的数据访问入口，通过Nginx实现负载均衡。Coordinator节点维护数据的存储信息，但不存储数据本身。在接受到一条SQL语句后，Coordinator解析SQL，制定执行计划，分发任务到相关DataNode，DataNode返回执行结果到Coordinator，Coordinator整合各个DataNode返回的结果并返回到客户端。Postgres-XL的DataNode节点负责实际存储数据，数据在多个DataNode上的分布有两种方式：复制模式和分片模式。在复制模式下，一个表的数据在指定的节点上存在多个副本。在分片模式下，一个表的数据按照指定的规则分布在多个数据加点上，这些节点共同保存一份完整的表。其中，模型数据采集模块将平台收集得到的不同数据源根据定义的规则进行采集，提取出包含所需有效信息的数据，数据类型包括结构化数据、非结构化数据、半结构化数据和GIS数据等多种形态数据。模型数据采集可分为几个功能模块：采集源注册模块，用于管理所要采集的数据项、定义采集规则等；采集任务模块，文件数据与数据库的执行任务情况展示与统计；数据检索模块，用于采集后数据的查询检索；原始数据填报模块，用于针对手工填报的数据进行采集。空间数据轻量化处理模块，利用CIM平台内置的轻量化引擎，解决海量、大体量空间数据跑不动的难题。针对BIM模型的轻量化包括两个阶段处理过程：几何转换，主要是微观层面的优化，可以通过参数化方式描述单个构件的几何信息可以对其轻量化，还可以通过相似性算法减少图元等方式对模型进行几何优化转换；渲染处理，八叉树快速剔除不可见图元，减少进行渲染区域的绘制对象，加速单图元渲染速度。所述模型平台构建层包括模型平台构建和多源数据融合模块。模型平台构建模块，基于采集的模型数据通过三维场景定义工具，将航飞影像、倾斜摄影、BIM模型等各类模型数据在三维空间场景中布局，并结合业务数据进行关联与融合，快速构建满足业务应用的三维可视化场景，辅助数字孪生应用工作者提供场景支持。多源数据融合模块，用于多种数据的融合显示，包括GIS基础数据、倾斜摄影数据、实景模型、BIM模型、各种设备设施模型等，将多源BIM数据和GIS数据一体化融合在应用平台中实现三维场景的展示，构建涵盖地质、山川、河流、绿地、建筑、设备设施等地理要素及城市基础设施的城市全要素场景。所述业务应用类三维场景开发过程是一个搭积木组装过程，设计过程采用模型驱动的方法，寻找使用者设计用户场景从中抽象出业务对象与业务行为将业务对象分解成数据对象。具体过程如下：步骤1：数据对象建模，在平台中通过可视化的方式建立共享的数据对象模型库，构建最小的积木块以及积木块之间的关联关系，全过程无须操作数据库；步骤2：业务模型建模，将一个或多个数据对象模型组装成业务对象，并建立主从关系，形成业务模型；步骤3：配置接口，将业务行为关联配置到业务对象上，或通过视图快速配置接口，构建起微服务，每个微服务都是独立的业务功能单元，其包含了业务对象的所有业务操作，也是具体应用中共享的业务部件；步骤4：应用模块组装，通过UI形式，将用户使用系统与微服务的业务操作进行关联建模，形成共享业务组件/业务模块；步骤5：应用系统组装，通过菜单将应用系统所需的业务模块统一组织，平台自动打包应用所包含的业务模块、微服务、业务模型及数据模型，构建起面向用户的业务应用。进一步地，所述多源数据融合模块重点解决在GIS+BIM应用时，多家用户的不同类数据不能融合的问题，打通数据链路，实现多源空间数据的高效处理，实现视觉无损、构件无损、语义无损、结构无损的融合效果，实现多源数据的融合与分析。所述多源数据融合包括：数据编码，指进行空间数据组织关联时的统一标识技术系列，如地理编码、BIM编码技术等，以及依次衍生的坐标转换技术、空间地址匹配技术等。所述数据呈现与渲染层包括数据加载和模型渲染模块。数据加载模块，用于空间数据的分层加载及显示；分层是空间数据组织的高级形式，可按照某种属性特征形成一个数据层。可以按以下方法分层：按专题属性分层，每个图层对应一个专题属性，包含某一种或某一类数据，如：地貌层、水系层、道路层、植被层、居民住宅层，对于不同的专题应用，可以根据不同的专题分成不同的数据层；按时间序列分层，把不同时间或不同时期的数据分别构成各个数据层。当地理目标分为若干数据层后，对所有地理目标的管理就简化为对各数据层的管理，对分层的地理目标进行查询时，不需要对所有数据查询，只需要对某一层数据进行查询，加快了查询速度；分层后的数据可以任意选择要显示的图层，增加了图层的灵活性；对不同数据进行叠加，可进行各种目的空间分析；按实体几何类型分层，因数据文件存储和属性管理的需要，一般可以按点、线、面类型分别存储文件；按实体属性结构分层，同一类型或同一专题的数据，因属性取值类型或属性项不同，也需将他们分在不同图层。模型渲染模块，利用UE4游戏引擎作为三维模型渲染的底层技术框架，实现三维数据真实一比一还原，实现对各种数据的高效、逼真、酷炫的渲染效果以及大场景下三维数据的实时加载与展示。包括：宏观大场景与精细局部模型无缝可视化展示：宏观大场景数据一般为GIS数据，包括但不限于地形影像、倾斜摄影、点云等不同类型的空间数据，精细局部模型一般为BIM模型；GIS+BIM从宏观的角度表现和管理数据，BIM从微观精细化的角度表现和管理数据。具体功能涵盖三维模型加载与渲染，三维场景分级组织与LOD构建以及静动态场景可视化编辑等。地上地下一体化可视化展示：实现地上地下一体化任意角度的剖切与浏览功能。针对城市地下空间数据，如：地质模型、地下管线模型、地铁隧道及站点模型等，以及地上空间数据如：建筑模型、水体模型、路桥模型等，实现在实地漫游过程中，视点从远到近，模型从粗到细变化的多层次结构。同时采用地上地下场景动态交互技术，使地上地下场景满足实时漫游的帧率要求，一体化展示地上地下空间的数据及信息。室内室外一体化可视化展示：实现由室外至室内的一体化浏览，在室内能够通过窗户等区域观察室外场景，通过对多源BIM数据，包括室内结构、机电设备、钢结构以及室外幕墙等数据的一体化融合，实现在实时漫游的过程中，视点从远到近，模型从粗到细变化的多层次结构，同时采用室内外场景动态交互可视化技术，使室内外场景满足实时漫游的帧率要求。上述技术方案的工作原理为：首先，多源模型数据源采集，通过汇聚城市数据，构建时空基础信息数据库，作为城市数据体系的基底。通过新建或向相关部门收集，汇集城市建设管理数据，主要包括已建或在建的城建项目的基础数据成果，如遥感影像数据、GIS倾斜摄影数据、BIM模型数据、城市基础设施物联网数据、摄影头影像等业务数据，构建CIM基础信息数据库，针对CIM平台所涉及的各类数据、模型、文档及完整数字化工程进行管理，以数据库代替模型作为信息的承载体，实现全生命周期的数据的汇聚、处理、存储、管理与共享。然后，以CIM基础信息库为基础，构建数字孪生城市运行的信息载体，利用UE4游戏引擎作为CIM三维可视化图形引擎底层技术框架，解决CIM平台场景构造、实体对象处理、场景加载与渲染等问题，通过场景搭建定义工具以搭积木的方式高效组织BIM图形利用，使其规格化和最佳化，满足平台运行的可靠性、易用性，实现海量三维数据的快速加载。最后，利用CIM平台三维可视化图形引擎进行数据渲染展现数字孪生空间场景，实现宏观微观一体化、地上地下一体化、室内室外一体化、二三维一体化、三维视频融合的可视化展示。面向政府与城市管理部门，基于各类设施实际情况的智慧城市应用，如智慧交通、智慧管网、智慧水务、智慧园区、智慧社区等，汇聚各类专题业务数据，，为各类数字孪生城市应用提供场景支持。上述技术方案的效果为：CIM数字孪生技术通过融合GIS、BIM、3D、与物联网技术、大数据技术，以时间轴为线形成一个集“宏观+微观”、“地上+地下”、“室内+室外”的三位一体的真实城市立体空间，可贯穿城市规划、设计、建设、管理、运营全生命周期，是城市静态物理仿真模型与城市动态仿真模型的结合，成为解决城市数据孤岛的一门益民技术，是智慧城市建设的基础性、关键性和实体性的信息基础设施，提高智慧城市顶层设计的科学性、规范性和可操作性。本发明的一个优选实施例，如图5所示，其中空间数据轻量化处理运行过程包括：第一步：数模分离，三维模型包括三维几何数据和模型结构属性等非几何数据两部分，首先三维模型轻量化引擎需要将几何数据和非几何数据进行拆分。通过这样的处理，原始三维模型文件中约20％～50％的非几何数据会被剥离出去，输出为数据文件供CIM应用开发使用；第二步：三维几何数据轻量化处理，1)几何转换：微观层面的轻量化通过参数化的方法做单个构件的轻量化；宏观层面的轻量化通过相似性算法减少图元数量，做图元合并，比如保留一根柱子的数据，其它柱子用一个引用+空间坐标即可，这种方式可以减少图元数量，进而达到轻量化。2)渲染处理：微观层面的优化通过多重LOD,加速图元渲染速度，多重LOD用不同级别的几何体来表示物体，距离越远加载的模型越粗糙，距离越近加载的模型越精细，从而在不影响视觉效果的前提下提高显示效率并降低存储；宏观层面的优化通过遮挡剔除，减少渲染图元数量，对图元做八叉树空间索引，然后根据视点计算场景中要剔除掉的图元，只绘制可见图元。另外绘制调用非常耗费CPU、并且通常会造成GPU时间闲置，为优化性能，平衡CPU和GPU负载，可以将具有相同状态的物合合并到一次绘制调用中，进行批量绘制，提升渲染流畅度。第三步：WEB浏览器或APP端实时渲染，CIM平台内置的BIM轻量化引擎对三维几何数据实时渲染，有两种渲染方式：1)前端渲染，三维几何数据从服务器端下载到客户端，然后调用客户端电脑的GPU高效实时渲染在维何数据，还原三维BIM模型，业务应用通过API接口形式，实现对三维BIM模型及其构件的操作；2)云端渲染即服务器端渲染，和云计算相似，将三维应用程序放在远程服务器中渲染，用户终端发出渲染指令给服务器，服务端根据渲染指令执行相应渲染任务，并将渲染结果通过网络传送至用户终端中显示。上述技术方案的工作原理为：首先，数模分离，分成空间图形数据处理和属性数据的处理，空间数据处理模块汇聚与转换多种格式的地理空间数据为标准的统一的轻量化数据模型UDM格式，以实现对空间数据的快速访问与统一化标准调用；然后，采用几何转换的方式进行三维几何数据的轻量化处理，微观层面通过参数化的方法做单个构件的轻量化，宏观层面通过相似性算法减少图元数量，做图元合并以减少图元数量，进而达到轻量化；最后是渲染的处理，微观层面通过LOD技术加速图元渲染速度，宏观层面通过遮挡剔除减少渲染图元数量，对图元做八叉树空间索引，只绘制可见图元。其中,利用CIM平台三维可视化图形引擎实现WEB浏览器或APP端实时渲染。本发明的一个优选实施例如图6所示，所述BIM模型轻量化过程：从BIM模型处理的全过程看，设计模型包含几何信息和非几何信息两部分，模型体量大，首先要数模分离，对于非几何信息，按需提取存储即可，对于几何信息的轻量化，需要经过两个处理过程：几何转换，将设计模型转换到BIM模型，从微观和宏观两方面优化，实现轻量化，微观层面采用参数化几何描述：用多个参数来描述一个几何体，例如：一个圆形柱子，可以用3个参数使用5个数值即可完成一个圆柱的搭建，参数化几何描述将单个图元做到最极致的轻量化；宏观层面采用相似性图元合并，例如：在一个工程中，有很多图元长得一样，只是位置不一样，这个时候可以做图元合并，只保留一个图元的数据，其他图元用一个引用+空间坐标，通过这种方式有效减少图元数量，达到轻量化目的。渲染处理，从微观和宏观两个方面优化，微观层面采用多重LOD，加速单图元渲染速度，多重LOD用不同级别的几何体表示物体，距离越远加载的模型越粗糙，距离越近加载的模型越精细，从而在不影响视觉效果的前提下提高显示效率，降低存储。LOD技术需要根据情况使用，比如按照室内、室外区分模型数据，或按照远近、楼层、建筑专业与细节层次分类处理大小不同的建筑构件；宏观层面剔除遮挡，减少渲染图元数量，剔除遮挡将无法投射到人眼视锥中的物体裁剪掉，在场景绘制中剔除掉当前视点下被遮挡的对象，只绘制前面的对象，通常通过对图元做八叉数空间索引，然后根据视点计算场景中要剔除掉的图元，只绘制可见图元。上述技术方案的工作原理：首先，将BIM原始数据转化为IFC标准格式，对不同来源的BIM模型进行规范化处理；然后，借助层次细分模型技术LOD实现原始BIM模型在不同层级的快速渲染需求，其中对于对于大块三维数据利用网格切片技术将其进行切分，实现数据的按需加载。上述技术方案的效果为：通过分类、分层、分级、轻量化等数据加工处理后的成果数据，最终以数据服务的形式面向公众与企业提供开放的空间数据服务管理能力。同时，通过轻量化处理后的BIM数据更适合Web网络发布与共享，秒级内可看到完整画面,增强用户在可视化应用中的操作体验。本发明的一个优选实时例如图7所示：基于LOD的BIM模型轻量化渲染流程：步骤S1：对BIM模型文件进行数模分离，分别进行几何数据解析和属性信息解析，并获取几何模型的网格数据，对mesh网格进行分层处理；步骤S2：遍历场景中所有物体，确定物体对应mesh网格的层级；步骤S3：对场景中的每个mesh网格层级增量加载，同一级的所有物体批量渲染；步骤S4：通过Restful数据库查询接口，实现模型构件的属性信息查询。上述技术方案的工作原理：该方法对BIM模型的mesh网格分层处理，确定不同层级mesh网格之间的差异，在进行渲染时，对不同层级的物体按照需求增量加载，以不同层级的物体进行渲染。上述技术方案的效果为：本发明对BIM模型不同层级的显示内容按需加载和渲染，减少计算量，提高加载速度和渲染效率。本发明的一个优选实施例如图8所示：模型平台的搭建模块用于快速构建满足业务应用的三维可视化场景，其构建过程如下：步骤1：数据对象建模，在平台中通过可视化的方式建立共享的数据对象模型库，构建最小的积木块以及积木块之间的关联关系，全过程无须操作数据库；步骤2：业务模型建模，将一个或多个数据对象模型组装成业务对象，并建立主从关系，形成业务模型；步骤3：配置接口，将业务行为关联配置到业务对象上，或通过视图快速配置接口，构建起微服务，每个微服务都是独立的业务功能单元，其包含了业务对象的所有业务操作，也是具体应用中共享的业务部件；步骤4：应用模块组装，通过UI形式，将用户使用系统与微服务的业务操作进行关联建模，形成共享业务组件/业务模块；步骤5：应用系统组装，通过菜单将应用系统所需的业务模块统一组织，平台自动打包应用所包含的业务模块、微服务、业务模型及数据模型，构建起面向用户的业务应用。上述技术方案的效果为：本实施例提出的基于城市CIM平台三维空间数据采与轻量化技术及应用方法将轻量化后的BIM+二三维数据模型，通过三维场景定义工具快速布局，并对接实时的物联网数据及业务数据，形成以数字资产+实时信息接入的方式进行三维图形仿真式管理，有效提高三维场景制作效率。同时，通过上述方式能够有效提高动静态数据的一体化融合，有效提高场景渲染力度，进而提高管理效率和可视化直观性。本发明的一个实施例，所述采集与轻量化系统还包括：模型更新模块，用于按照预设的模型更新时间间隔，针对模型数据采集模块在所述模型更新时间间隔内所采集的数据更新信息对所述三维可视化场景进行当时更新；所述模型更新模块的运行过程包括：利用时间间隔模型设置模型更新时间间隔；其中，所述时间间隔模型如下：其中，T表示模型更新时间间隔；n表示当前经历的更新次数；Mi表示第i次更新对应的更新元素数量；T0表示当更新元素数量达到三维可视化场景所包含元素的30％时对应的三维可视化场景更新所消耗的理论时间；Tmax表示当前经历的更新过程中，更新所消耗的实际最大时间；当n为1时，令Tmax＝0.5T0；在所述模型更新时间间隔结束时候提取所述模型数据采集模块在所述模型更新时间间隔内所采集的数据更新信息；并利用模型数据采集模块在所述模型更新时间间隔内所采集的数据更新信息对所述三维可视化场景进行当时更新。上述技术方案的工作原理和效果为：通过上述公式进行三维可视化场景的定时设置可以结合三维可视化场景的实际消耗时间进行更新时间间隔的设置，同时，结合每次更新的更新元素的数量进行更新时间间隔的设置能够有效提高时间间隔设置的合理性，当更新元素增加时降低更新时间间隔的时间设置长度能够防止单次更新元素过多导致单次更新所消耗的时间过长，进而降低更新效率的问题发生。同时，通过也能够根据单次更新元素较少的情况下增加下一次更新的时间间隔，进而降低更新频率，防止高频更新导致增加系统更新负荷，进而增加资源浪费的情况发生。另一方面，通过单次更新时间的长度判定进行更新时间间隔的调整，能够在单次更新时间消耗过长的情况下缩短更新时间间隔，通过提高更新频率的方式降低单次更新所消耗的时间，进而提高更新效率。显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围之内，则本发明也意图包含这些改动和变型在内。
