标题title
点云缺陷检测方法、装置、系统及存储介质
摘要abst
本发明公开了点云缺陷检测方法、装置、系统及存储介质，三维激光点云处理技术领域，包括从预构建的k‑d树结构中获取待检测点云和参考点云；轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测；本发明能够提高点云缺陷检测的效率和准确率。
权利要求书clms
1.点云缺陷检测方法，其特征在于，包括：从预构建的k-d树结构中获取待检测点云和参考点云；轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。2.根据权利要求1所述的点云缺陷检测方法，其特征在于，所述k-d树结构通过以下方法进行构建：对于k-d树结构中的每一个节点，按照预设的维度将节点对应的数据点划分成两部分以创建左子树和右子树，直至每个节点只包含一个数据点；在所述按照预设的维度将节点对应的数据点划分成两部分的过程中，基于维度方差的大小来确定划分顺序。3.根据权利要求2所述的点云缺陷检测方法，其特征在于，所述维度方差通过以下公式进行计算：，其中，xi、yi和zi分别是x轴、y轴和z轴方向第i个数据点的坐标值，n是x/y/z轴方向数据点的个数，、/＞和/＞分别是x轴、y轴和z轴方向的坐标均值，D、D和D分别是x轴、y轴和z轴方向的维度方差。4.根据权利要求1所述的点云缺陷检测方法，其特征在于，所述局部方向中心度通过以下公式进行计算：，其中，DCM是局部方向中心度，Si是第i个数据点在待检测点云邻域/参考点云邻域内邻近点连接而成的三角形的面积，是所有数据点对应的三角形的平均面积，k是需要搜索邻近点的数量。5.根据权利要求1所述的点云缺陷检测方法，其特征在于，所述差值通过以下公式进行计算：ΔDCM=|DCMdefect-DCMreference|，其中，DCMdefect是数据点在待检测点云邻域内的局部方向中心度，DCMreference是数据点在在参考点云邻域内的局部方向中心度，ΔDCM是两个局部方向中心度的差值。6.根据权利要求1所述的点云缺陷检测方法，其特征在于，在进行聚类分割之前，采用半径滤波策略对缺陷点中由于误判别出现的噪声点进行去除，所述半径滤波策略包括：若缺陷点在邻域内的邻近点数量低于预设数量，将该缺陷点作为噪声点。7.根据权利要求1所述的点云缺陷检测方法，其特征在于，通过K-means聚类分割算法对检测到的所有缺陷点进行聚类分割。8.点云缺陷检测装置，其特征在于，包括：点云获取模块：用于从预构建的k-d树结构中获取待检测点云和参考点云；数据点检测模块：用于轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；缺陷检测模块：用于对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。9.点云缺陷检测系统，其特征在于，包括：存储器，用于存储指令；处理器，用于执行所述指令，使得所述装置执行实现如权利要求1-7任一项所述的点云缺陷检测方法的操作。10.计算机可读存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时，实现如权利要求1-7中任一所述点云缺陷检测方法。
说明书desc
技术领域本发明涉及点云缺陷检测方法、装置、系统及存储介质，属于三维激光点云处理技术领域。背景技术三维点云是由大量三维坐标点组成的集合，每个点都具有X、Y、Z三个坐标值。它可以被用来表示物体的三维形状、空间位置和运动状态等信息。三维点云通常使用激光雷达、摄像头等设备进行采集，也可以通过三维建模软件进行创建。三维点云具有以下特点：高精度，三维点云可以提供高精度的物体形状和位置信息，可用于精确的测量和分析；丰富信息，三维点云不仅包含物体的几何形状信息，还可以包含颜色、纹理、反射率等信息；大规模，三维点云可以包含数百万个点，可以表示复杂的场景和大规模的物体；实时性：通过优化算法和硬件设备，可以实现对三维点云的实时处理和分析。三维点云在许多领域都有广泛的应用，如自动驾驶、机器人导航、虚拟现实、建筑设计、地形测绘等。点云的缺陷检测技术难点主要有以下几个方面：数据量大，点云数据通常非常庞大，包含数百万个点，因此需要高效的算法和计算资源来处理和分析；噪声和误差，在采集和处理点云数据时，由于设备本身的限制和环境的影响，会产生一定的噪声和误差，这些干扰因素会影响点云的质量和准确性；无序性和不规则性，点云数据本质上是一组无序的三维坐标点，缺乏结构和规则性，这使得点云的处理和分析变得更加复杂和困难；多样性和复杂性，点云数据通常包含多种类型的信息，如几何形状、颜色、纹理等，这些信息的多样性和复杂性增加了点云处理和分析的难度；缺陷类型多样，点云数据中可能存在多种类型的缺陷，如噪声点、离群点、缺失点等，这些缺陷的检测和修复需要不同的算法和技术。因此，目前点云的缺陷检测技术存在检测效率和检测准确率低的问题。需要克服这些难点，提高点云数据的质量和准确性，以便更好地应用于各种领域。发明内容本发明的目的在于提供点云缺陷检测方法、装置、系统及存储介质，解决现有计算中点云缺陷检测检测效率和检测准确率低的问题。为实现以上目的，本发明是采用下述技术方案实现的：第一方面，本发明提供了点云缺陷检测方法，包括：从预构建的k-d树结构中获取待检测点云和参考点云；轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。结合第一方面，进一步的，所述k-d树结构通过以下方法进行构建：对于k-d树结构中的每一个节点，按照预设的维度将节点对应的数据点划分成两部分以创建左子树和右子树，直至每个节点只包含一个数据点；在所述按照预设的维度将节点对应的数据点划分成两部分的过程中，基于维度方差的大小来确定划分顺序。结合第一方面，进一步的，所述维度方差通过以下公式进行计算：，其中，xi、yi和zi分别是x轴、y轴和z轴方向第i个数据点的坐标值，n是x/y/z轴方向数据点的个数，、/＞和/＞分别是x轴、y轴和z轴方向的坐标均值，D、D和D分别是x轴、y轴和z轴方向的维度方差。结合第一方面，进一步的，所述局部方向中心度通过以下公式进行计算：，其中，DCM是局部方向中心度，Si是第i个数据点在待检测点云邻域/参考点云邻域内邻近点连接而成的三角形的面积，是所有数据点对应的三角形的平均面积，k是需要搜索邻近点的数量。结合第一方面，进一步的，所述差值通过以下公式进行计算：ΔDCM=|DCMdefect-DCMreference|，其中，DCMdefect是数据点在待检测点云邻域内的局部方向中心度，DCMreference是数据点在在参考点云邻域内的局部方向中心度，ΔDCM是两个局部方向中心度的差值。结合第一方面，进一步的，在进行聚类分割之前，采用半径滤波策略对缺陷点中由于误判别出现的噪声点进行去除，所述半径滤波策略包括：若缺陷点在邻域内的邻近点数量低于预设数量，将该缺陷点作为噪声点。结合第一方面，进一步的，通过K-means聚类分割算法对检测到的所有缺陷点进行聚类分割。第二方面，本发明还提供了点云缺陷检测装置，包括：点云获取模块：用于从预构建的k-d树结构中获取待检测点云和参考点云；数据点检测模块：用于轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；缺陷检测模块：用于对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。第三方面，本发明还提供了点云缺陷检测系统，包括：存储器，用于存储指令；处理器，用于执行所述指令，使得所述装置执行实现如第一方面任一项所述的点云缺陷检测方法的操作。第四方面，本发明还提供了计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时，实现如第一方面中任一所述点云缺陷检测方法。与现有技术相比，本发明所达到的有益效果是：本发明提供的点云缺陷检测方法、装置、系统及存储介质，将待检测点云和参考点云存储在k-d树结构中，以便于快速查找，提高点云缺陷检测的效率，通过数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度的差值，来衡量缺陷点在其自身范围内和在参考点云范围内的局部方向中心度差异，在未发生表面变化的区域，两个点云空间分布类似，差值较小，而在变化区域，两个点云空间分布差异较大，差值也较高，通过阈值的设定实现对缺陷点的判定，从而提高点云缺陷检测的准确度。附图说明图1是本发明实施例提供的点云缺陷检测方法的流程图；图2是本发明实施例提供的邻近点搜索示意图；图3是本发明实施例提供的三维球面三角形构建示意图；图4是本发明实施例提供的ΔDCM缺陷检测原理图；图5是本发明实施例提供的变化区域DCM分布图；图6是本发明实施例提供的在缺叶叶轮缺陷检测中的DCM计算结果；图7是本发明实施例提供的在缺叶叶轮缺陷检测中的缺陷点提取结果；图8是本发明实施例提供的在缺叶叶轮缺陷检测中的缺陷聚类分割结果；图9是本发明实施例提供的仿真实验CAD零件模型图，螺钉式底板夹紧件凸轮式分度销履带传动齿轮轮辐手轮叶轮；图10是本发明实施例提供的采样步长step=0.50与ΔDCM=0.35判定阈值条件下的仿真数据缺陷检测结果，完整参考零件点云，缺损零件点云，缺陷检测结果，缺陷分割结果。实施方式下面结合附图对本发明作进一步描述，以下实施例仅用于更加清楚地说明本发明的技术方案，而不能以此来限制本发明的保护范围。实施例1如图1所示，本发明实施例提供了点云缺陷检测方法，包括以下步骤：S1、从预构建的k-d树结构中获取待检测点云和参考点云。步骤S1的核心在于解决三维空间下数据集的索引问题，其核心思想是将点云数据集按照特定的规则存储在二叉树结构中，以便于快速查找。k-d树是一种重要的数据结构，旨在解决k维空间下数据集的索引问题。其核心思想是将数据集按照特定的规则存储在二叉树结构中，以便于快速查找。其中，k-d树的构建是实现高效数据检索的关键。在构建k-d树时，首先需要确定每一级节点的划分方式。具体来说，对于每一个节点，需要按照指定的维度将其对应的数据点划分成两部分，同时创建左子树、右子树。这个过程一直持续到每个叶子节点只包含一个数据点，从而形成了完整的k-d树结构。除了节点划分之外，还需要确定数据集在每个维度上的划分顺序。因为每一轮必须在k个维度上分别进行划分，所以划分顺序会直接影响最终构建出来的k-d树的性能。通常情况下，可以采用简单的贪心策略，按照方差最大的维度进行划分。总之，k-d树是一种重要的数据结构，用来快速检索k维空间下的数据集。维度的划分顺序对于k-d树的构建至关重要，不同的计算方式会影响到最终树结构的形态和数据检索的效率。本发明采用的方式是基于维度方差大小来确定切分顺序。方差越大，说明数据的偏离程度越大，也就意味着在该维度上进行数据划分后，能够获得更高的分辨率。在三维空间中，点云数据点各个维度的方差计算方法如下：，其中，xi、yi和zi分别是x轴、y轴和z轴方向第i个数据点的坐标值，n是x/y/z轴方向数据点的个数，、/＞和/＞分别是x轴、y轴和z轴方向的坐标均值，D、D和D分别是x轴、y轴和z轴方向的维度方差。S2、待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点。在步骤S2中，还包括邻近点搜索的步骤。为了计算某一定点p的法线和曲率，需要搜索其欧式距离最近的若干点。近邻点搜索步骤如下：首先，创建一个存放点数据的点集P={p1,…,pk}，k 为需要搜索近邻点的数量。其次，从二叉树根节点A点出发搜索，并将其设为最近邻点，添加到P中，以点p为圆心，pA 为半径绘制圆形区域，如图2所示，以pA为半径的圆包含二叉树根节点A的左右子树的根节点B和C，根据下式计算lpB与lpC并将其添加到P中，若P中数据已满，则用lpB与lpC中较小的数与P中的最大值比较，若大于则不动，若小于则替换。由于图2中半径更大的圆形区域不包含C的子树，所以不需要计算。计算B的叶子节点ED到p点的距离lpE与lpD，并判断是否继续对P更新。搜索完成后可得到p点的近邻点集合P。，其中，p1和p2为点云数据中的两个点，表示数据当前的维度。基于邻域搜索的方向中心性度量：方向中心性度量的核心思想是根据邻域内点的分布来区分点集中的边界点和内部点。集群的内部点往往被其各个方向上的邻近点所包围，而边界点只包括一定方向范围内的相邻点。为了衡量这种方向性分布的差异，将二维空间中查询点与邻域内的点连接形成的角度的方差定义为局部方向中心度。推导至三维空间中，邻近点被映射到一个单位球面上。它们连接相邻的点，形成球形三角形，DCM被扩展为三角形的面积的方差。为了在高维空间中细分超球面，本发明采用Qhull算法来构建邻近点的凸复合体。由于所有的邻近点都被映射到了球面上，邻近点被保证为凸复合体的顶点，如图3所述，其中重复的邻近点不包括在内。三维球面上三角形面积计算如下，设三角形顶点为A，B，C，所求三角形面积S为：，为了衡量三维空间中点的局部方向性分布，将三维空间中查询点邻域内的点连接凸包的三角形面积的方差定义为三维空间中的局部方向中心度：，其中，DCM是局部方向中心度，Si是第i个数据点在待检测点云邻域/参考点云邻域内邻近点连接而成的三角形的面积，是所有数据点对应的三角形的平均面积，k是需要搜索邻近点的数量。在三维点集分布中，内部点邻域内邻近点分布均匀，其邻近点所构建的凸包表面三角形面积分布均匀，DCM值较低，而集合边缘点邻近点分布总是倾向于邻域一侧，所构建三维凸包表面三角形面积差异较大，DCM值较高，如图4所示。缺陷检测旨在找到检测物体在参考物体表面基础上发生的缺陷变化。当缺陷发生时，缺陷区域表面将逐渐远离参考平面，缺陷表面点在其邻域范围内的参考平面点也将逐渐向邻域一侧减少直至消失，如图4所示。依据此原理，对缺陷点云中的点分别在其自身以及参考点云中进行邻域搜索，然后在两邻域中分别计算DCM值，并求得差值，差值通过以下公式进行计算：ΔDCM=|DCMdefect-DCMreference|，其中，DCMdefect是数据点在待检测点云邻域内的局部方向中心度，DCMreference是数据点在在参考点云邻域内的局部方向中心度，ΔDCM是两个局部方向中心度的差值。ΔDCM则衡量了缺陷点云在其自身范围内和在参考点云范围内的局部方向中心度差异，在未发生表面变化的区域，参考点云与对比点云空间分布类似，ΔDCM值较小。而在变化区域，参考点云与对比点云空间分布差异较大，ΔDCM值也较高，如图5所示。图6展示了缺叶叶轮缺陷检测中的DCM计算结果。S3、对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。图7展示了在缺叶叶轮缺陷检测中的缺陷点提取结果。在聚类分割前，采用半径滤波策略对判别结果中由于误判别出现的噪声点进行去除。点云半径滤波是设定点云的邻域范围r与领域内点的数量Num，当点的领域内的邻近点数量低于设定Num值时，则被判定为噪声点。聚类分割采用K-means算法，首先随机选择样本中k个点作为聚类中心，然后计算剩余点到聚类中心的距离，将其分配至最近的聚类中心内，若所选聚类中心与计算聚类中心发生变化，则重复第二步，直至聚类中心不再发生变化。基于K-means算法，本文将多部位缺陷按照聚类思想进行分割，在缺陷叶轮模型点云中的实验结果如图8所示。本发明实施例利用仿真数据进行点云零件缺陷检测算法的仿真实验验证。这些仿真数据是根据需求针对标准三维CAD零件模型建立的，并且转化成点云数据的处理。使用仿真数据进行实验验证具有多个优势，其中包括：1.可以初步验证算法在各个步骤的处理效果，为算法的改进和优化提供有力的支持。可以通过修改模型中的缺陷大小、形状等参数来测试算法的自适应性，进一步提升算法的实用性和适用性。2.能够精确计算三维模型中的缺陷尺寸，在缺陷定量分析过程中可以得到准确的测量结果，从而验证三维缺陷检测算法对缺陷测量结果的精度。3.通过利用仿真数据进行实验验证，可以有效降低实验成本和时间成本，同时还能够提高算法的稳定性和可靠性。仿真点云数据生成过程如下：使用CAD设计软件建立标准零件三维模型，并保存为OBJ格式。在本次实验中共建立了5个标准零件模型，如图9所示，-分别为螺钉式底板夹紧件，凸轮式分度销、履带传动齿轮、轮辐手轮和叶轮。在标准零件模型中建立模型缺陷，并分离缺陷部位作为后续缺陷检测实验的真实值。在ClouCompare中导入OBJ模型，在OBJ模型表面进行两次随机点采样生成点云。由于点采样可以改变点云数据的密集度的同时也会影响曲面过渡处的点云密度，例如缺陷区域内的边界位置。因此，不同参数设置的结果也会导致测量到的缺陷三维尺寸有所不同。另一方面，ΔDCM阈值参数是影响缺陷二维尺寸测量结果的一个重要因素。因此，通过对各个参数进行调整，可以检验算法对三维缺陷特征测量结果的影响。总体而言，本发明通过对算法参数的修改和优化，可以进一步提高算法的准确性和稳定性，得到更加可靠和精确的三维缺陷特征测量结果，为后续的处理和分析提供有效支持。表1-多参数不同阈值对缺陷测量结果的影响表1中的a至e模型分别对应于图9中的零件模型至，δ为测量得到的缺陷信息相对误差，其计算方式为：δ=Δ/L×100%，其中，Δ为绝对误差，其值等于测量值与真实值的差值，L为缺陷的相关尺寸真值。通过分析表1中实验数据可以得出以下结论：对零件点云模型缺陷检测四组实验中的1、2组和3、4组保持采样大小一致，改变判定缺陷点的ΔDCM阈值大小会对缺陷的三维尺寸精度产生较大的影响，由表1可知，为取得较好的缺陷提取精度需要选择较小的采样步长和较小的ΔDCM阈值，但是为了综合考虑到算法运行的时间成本，当点云数据需要采用较大采样策略时配合所设置的ΔDCM阈值也需要进行适当增大，以保证缺陷检测精度，如图10为0.50采样步长与0.35ΔDCM判定阈值条件下的仿真数据缺陷检测结果图，其中-分别为螺钉式底板夹紧件，凸轮式分度销、履带传动齿轮、轮辐手轮和叶轮。本发明提出了一种基于局部方向中心性的点云缺陷检测算法，具体而言，该方法通过对参考零件点云与待检测件点云表面在缺陷区域中点的局部方向中心性差异来进行缺陷检测，并采用K-means聚类方法，对检测到的缺陷点进行缺陷部位聚类，已达到多部位缺陷识别的目的，更好的对零件缺陷进行定量和定性分析。在仿真数据中的实验结果表明，所述方法能够较好的完成缺陷区域识别与分割任务。实施例2本发明实施例还提供了点云缺陷检测装置，包括：点云获取模块：用于从预构建的k-d树结构中获取待检测点云和参考点云；数据点检测模块：用于轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；缺陷检测模块：用于对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。实施例3本发明实施例提供了点云缺陷检测系统，包括：存储器，用于存储指令；处理器，用于执行所述指令，使得所述装置执行实现如实施例1所述的点云缺陷检测方法的操作：从预构建的k-d树结构中获取待检测点云和参考点云；轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。实施例4本发明实施例提供了计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时，实现如实施例1所述的点云缺陷检测方法：从预构建的k-d树结构中获取待检测点云和参考点云；轮询检测待检测点云中的所有数据点，分别计算待检测点云中的数据点在待检测点云邻域内和在参考点云邻域内的局部方向中心度，计算两个局部方向中心度的差值，若所述差值超过预设阈值，则所述差值对应的数据点为缺陷点；对检测到的所有缺陷点进行聚类分割，得到缺陷区域，实现点云缺陷检测。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。以上所述仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明技术原理的前提下，还可以做出若干改进和变形，这些改进和变形也应视为本发明的保护范围。
