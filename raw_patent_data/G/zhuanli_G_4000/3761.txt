标题title
自动驾驶汽车的测试场景构建方法、设备和介质
摘要abst
本发明涉及自动驾驶领域，公开了一种自动驾驶汽车的测试场景构建方法、设备和介质，该方法包括：根据预先建立的静态元素集合，确定待组合静态元素，根据待组合静态元素，构建至少一个待测试静态场景；根据待测试静态场景以及预设的与交通参与者元素对应的动态参数，构建至少一个待处理测试场景；根据各待处理测试场景中的待测试车辆与各交通参与者元素对应干扰车辆之间的位置关系以及待处理测试场景中的车道数量，从各待处理测试场景中确定出仿真测试场景。本发明能够实现通过排列组合静态元素以及与交通参与者元素对应的动态参数，提高测试场景覆盖度，并对测试场景的合并和整理，降低测试场景的重复度的效果。
权利要求书clms
1.一种自动驾驶汽车的测试场景构建方法，其特征在于，包括：根据预先建立的静态元素集合，确定待组合静态元素，并根据所述待组合静态元素，构建至少一个待测试静态场景；其中，所述待组合静态元素中至少包括交通参与者元素；根据所述待测试静态场景以及预设的与所述交通参与者元素对应的动态参数，构建至少一个待处理测试场景；其中，所述动态参数包括速度信息、位置信息、反应时间以及未来意图；根据各所述待处理测试场景中的待测试车辆与各所述交通参与者元素对应干扰车辆之间的位置关系以及所述待处理测试场景中的车道数量，从各所述待处理测试场景中确定出仿真测试场景。2.根据权利要求1所述的方法，其特征在于，静态元素集合包括至少两个类别元素集合，所述根据预先建立的静态元素集合，确定待组合静态元素，包括：针对每个类别元素集合，从所述类别元素集合中确定出至少一个子元素；根据各所述子元素，确定待组合静态元素；其中，所述类别元素集合为交通参与者类型集合、光照类型集合、车道类型集合、交通类型集合、地形类型集合、道路类型集合、路面类型集合和/或天气类型集合。3.根据权利要求1所述的方法，其特征在于，所述根据所述待测试静态场景以及预设的与所述交通参与者元素对应的动态参数，构建至少一个待处理测试场景，包括：针对每个待测试静态场景，确定所述待测试静态场景中的每个交通参与者元素对应的至少一组动态参数，根据各所述交通参与者元素对应的至少一组动态参数进行组合，确定与每个待测试静态场景对应的至少一个待处理测试场景。4.根据权利要求1所述的方法，其特征在于，在所述构建至少一个待处理测试场景之后，还包括：针对每个待处理测试场景，根据所述待处理测试场景中的各干扰车辆的动态参数，确定各所述干扰车辆对所述待测试车辆的干扰程度；将所述待处理测试场景中的所述干扰程度小于预设阈值的干扰车辆删除。5.根据权利要求1所述的方法，其特征在于，在所述构建至少一个待处理测试场景之后，还包括：将所述待处理测试场景，按照动态场景类别进行分类，确定与每个动态场景类别相对应的至少一个待处理测试场景；其中，所述动态场景类别包括突发场景、超车场景、换道场景和跟驰场景。6.根据权利要求5所述的方法，其特征在于，所述根据各所述待处理测试场景中的待测试车辆与各所述交通参与者元素对应干扰车辆之间的位置关系以及所述待处理测试场景中的车道数量，从各所述待处理测试场景中确定出仿真测试场景，包括：针对每个待处理测试场景，确定所述待处理测试场景中的待测试车辆与各干扰车辆之间的位置关系；其中，所述位置关系包括侧包围、半包围或全包围；若存在至少两个待处理测试场景的动态场景类别相同，位置关系相同，且车道数量不同，则保留所述至少两个待处理测试场景中所述车道数量最少的待处理测试场景作为仿真测试场景，并删除所述至少两个待处理测试场景中所述车道数量非最少的待处理测试场景。7.根据权利要求1所述的方法，其特征在于，在所述从各所述待处理测试场景中确定出仿真测试场景之后，还包括：根据所述待测试车辆，构建待测试车辆仿真模型；根据所述待测试车辆仿真模型以及所述仿真测试场景，对待测试功能进行测试，获取测试数据，并根据所述测试数据以及与所述待测试功能对应的期望数据范围，确定测试结果。8.根据权利要求7所述的方法，其特征在于，所述根据所述待测试车辆，构建待测试车辆仿真模型，包括：针对所述待测试车辆进行模型参数化处理，得到初始车辆仿真模型；其中，所述模型参数化处理包括：车体模型参数化处理、轮胎模型参数化处理、转向系统模型参数化处理、制动系统模型参数化处理、动力系统模型参数化处理、传动系统模型参数化处理、空气动力学模型参数化处理以及硬件接口模型参数化处理中的至少一种；根据所述待测试车辆上安装的待测试传感器，构建传感器模型；将所述传感器模型配置在所述初始车辆仿真模型上，得到待测试车辆仿真模型。9.一种电子设备，其特征在于，所述电子设备包括：处理器和存储器；所述处理器通过调用所述存储器存储的程序或指令，用于执行如权利要求1至8任一项所述的自动驾驶汽车的测试场景构建方法的步骤。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储程序或指令，所述程序或指令使计算机执行如权利要求1至8任一项所述的自动驾驶汽车的测试场景构建方法的步骤。
说明书desc
技术领域本发明涉及自动驾驶领域，尤其涉及一种自动驾驶汽车的测试场景构建方法、设备和介质。背景技术自动驾驶汽车为解决“交通拥挤、环境污染、事故频发、能源短缺”等问题提供了新的途径和方向。当然，对于自动驾驶汽车在运用在实际生活之前，需要对其安全性能进行充分验证。由于目前开放道路测试仍受到较大的限制，且存在极端交通条件和场景复现困难的问题，会导致安全性能的测试不准确的问题，以至于投入使用后存在隐患的问题。目前，基于场景的自动驾驶汽车仿真测试较为常见，但是，其对于构建静态和动态场景不完善，存在场景覆盖度低，但是重复度高的问题，这会导致难以有效的对自动驾驶汽车的控制系统进行测试。有鉴于此，特提出本发明。发明内容为了解决上述技术问题，本发明提供了一种自动驾驶汽车的测试场景构建方法、设备和介质，实现通过排列组合静态元素以及与交通参与者元素对应的动态参数，提高测试场景覆盖度，并通过对测试场景的合并和整理，降低测试场景的重复度。本发明实施例提供了一种自动驾驶汽车的测试场景构建方法，该方法包括：根据预先建立的静态元素集合，确定待组合静态元素，并根据所述待组合静态元素，构建至少一个待测试静态场景；其中，所述待组合静态元素中至少包括交通参与者元素；根据所述待测试静态场景以及预设的与所述交通参与者元素对应的动态参数，构建至少一个待处理测试场景；其中，所述动态参数包括速度信息、位置信息、反应时间以及未来意图；根据各所述待处理测试场景中的待测试车辆与各所述交通参与者元素对应干扰车辆之间的位置关系以及所述待处理测试场景中的车道数量，从各所述待处理测试场景中确定出仿真测试场景。本发明实施例提供了一种电子设备，所述电子设备包括：处理器和存储器；所述处理器通过调用所述存储器存储的程序或指令，用于执行任一实施例所述的自动驾驶汽车的测试场景构建方法的步骤。本发明实施例提供了一种计算机可读存储介质，所述计算机可读存储介质存储程序或指令，所述程序或指令使计算机执行任一实施例所述的自动驾驶汽车的测试场景构建方法的步骤。本发明具有以下技术效果：根据预先建立的静态元素集合，从中确定出待组合静态元素，以组合构建得到至少一个待测试静态场景，进而，结合预设的与交通参与者元素对应的动态参数，将每个待测试静态场景构建为至少一个待处理测试场景，并且，根据各待处理测试场景中的待测试车辆与各交通参与者元素对应干扰车辆之间的位置关系以及待处理测试场景中的车道数量，从各待处理测试场景中确定出仿真测试场景，以删除相同和相似的待处理测试场景，实现了通过排列组合静态元素以及与交通参与者元素对应的动态参数，提高测试场景覆盖度，并通过对测试场景的合并和整理，降低测试场景的重复度的效果。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例提供的一种自动驾驶汽车的测试场景构建方法的流程图；图2是本发明实施例提供的交通标志对应的静态元素示意图；图3是本发明实施例提供的交通指示对应的静态元素示意图；图4是本发明实施例提供的道路类型对应的静态元素示意图；图5是本发明实施例提供的一种T字道路对应的待测试静态场景示意图；图6是本发明实施例提供的一种向右急转弯道路对应的待测试静态场景示意图；图7是本发明实施例提供的一种待测试车辆和干扰车辆的行驶意图的示意图；图8是本发明实施例提供的另一种自动驾驶汽车的测试场景构建方法的流程图；图9是本发明实施例提供的一种待测试车辆与干扰车辆之间的位置关系示意图；图10是本发明实施例提供的一种“全包围”状态下的替代示意图；图11是本发明实施例提供的一种“半包围”状态下的替代示意图；图12是本发明实施例提供的一种“侧包围”状态下的替代示意图；图13是本发明实施例提供的一种自动驾驶汽车的功能安全仿真测试方法的流程图；图14是本发明实施例提供的一种待测试车辆的受力示意图；图15是本发明实施例提供的一种电子设备的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将对本发明的技术方案进行清楚、完整的描述。显然，所描述的实施例仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所得到的所有其它实施例，都属于本发明所保护的范围。本发明实施例提供的自动驾驶汽车的测试场景构建方法，主要适用于针对构建自动驾驶汽车的测试场景，以用于后续仿真测试等的情况。本发明实施例提供的自动驾驶汽车的测试场景构建方法可以由电子设备执行。图1是本发明实施例提供的一种自动驾驶汽车的测试场景构建方法的流程图。参见图1，该自动驾驶汽车的测试场景构建方法具体包括：S110、根据预先建立的静态元素集合，确定待组合静态元素，并根据待组合静态元素，构建至少一个待测试静态场景。其中，静态元素可以是不会随时间或者环境而发生改变的元素，如道路、建筑物等。静态元素集合可以是各静态元素所组成的集合，可选的，静态元素集合中可以包括各种类别的静态元素。待组合静态元素可以是从静态元素集合中选出的，用于构建静态场景的静态元素。待组合静态元素中至少包括交通参与者元素，交通参与者元素可以用于描述出待测试车辆之外的其他交通参与者，即后续的干扰车辆。待测试静态场景可以是由各待组合静态元素组合构建的场景，用于表征后续测试场景中的静态场景。具体的，从预先建立的静态元素集合中，按照预先确定的选取规则选出一定数量的静态元素作为待组合静态元素。进而，将这些待组合静态元素进行组合，得到待测试静态场景。可以理解的是，预先确定的选取规则可以是随机选取，还可以是按照静态元素的类别进行分别选取，也可以是根据测试需求进行选取，例如根据真实场景来选择对应各种静态元素等，针对其具体的选取方式不做具体限定。在上述示例的基础上，静态元素集合包括至少两个类别元素集合，可以通过下述方式来根据预先建立的静态元素集合，确定待组合静态元素：针对每个类别元素集合，从类别元素集合中确定出至少一个子元素；根据各子元素，确定待组合静态元素。其中，类别元素集合可以理解为静态元素集合中的各个静态元素按照类别进行划分，得到的至少两个集合。类别元素集合为交通参与者类型集合、光照类型集合、车道类型集合、交通类型集合、地形类型集合、道路类型集合、路面类型集合和/或天气类型集合。子元素可以是类别元素集合中确定出的元素，用于组合成为待组合静态元素。可以理解的是，子元素可以为空。具体的，将静态元素集合中的各个静态元素按照类别进行划分，可以得到至少两个类别元素集合。从每个类别元素集合中，都可以选择出至少一个静态元素作为子元素。进而，将各个类别元素集合中选择出的子元素组合在一起，得到待组合静态元素。类别元素集合中的交通参与者类型集合可以包括行人、机动车、非机动车等；类别元素集合中的光照类型集合中的静态元素可以包括强烈、正常、暗沉、无光等；类别元素集合中的车道类型集合中的静态元素可以包括单车道、双车道、三车道、四车道等；类别元素集合中的交通类型集合中的静态元素可以包括交通参与方式子集合、交通状况类型子集合、交通信号灯子集合、交通标线子集合等，其中，交通参与方式子集合中的静态元素可以包括机动车、非机动车、行人等，交通状况类型子集合中的静态元素可以包括畅通、正常、拥挤等，交通信号灯子集合中的静态元素可以包括车道信号灯、人行横道信号灯、方向指示灯、其他指示灯等，交通标线子集合中的静态元素可以包括指示标线、禁止标线、警告标线等；类别元素集合中的地形类型集合中的静态元素可以包括城市道路、高速公路、山区道路等；类别元素集合中的道路类型集合中的静态元素可以包括直线路段、弯道路段、陡坡路段、十字路段、T字路段、环岛路段、桥梁路段等；类别元素集合中的路面类型集合中的静态元素可以包括刚性路面、柔性路面、其他路面等；类别元素集合中的天气类型集合中的静态元素可以包括晴天、雨天、阴天、雾霾天等。通过已获取的地图资源和实地采集的实际环境中的场景信息对道路上的各类交通标志以及建筑房屋等进行建模，得到各种静态元素组成的静态元素集合。根据静态元素集合中的各种静态元素的组合可以还原真实的道路场景。在构建待测试静态场景的过程中，不仅需要建立道路，还应该建立一些引导或者制约驾驶车辆行驶的交通标志线等元素，以通过文字或者符号传递引导、限制、警告或指示等信息，给自动驾驶车辆与其他参与者指定一些规则和约束，以便让自动驾驶汽车在交通环境中更安全的行驶。基于待测试静态场景中的道路，可以选择道路的三维几何形状、路面情况、车道标线信息、天气条件、光线条件等不同类别的静态元素，并对这些静态元素进行随机实景组合，为仿真提供基础道路条件。交通标志对应的静态元素示意图如图2所示，交通指示对应的静态元素示意图如图3所示，道路类型对应的静态元素示意图如图4所示。通过选择不同类型的待组合静态元素，就可以对待测试静态场景进行快速的构建，且使场景内的元素内容比较丰富。S120、根据待测试静态场景以及预设的与交通参与者元素对应的动态参数，构建至少一个待处理测试场景。其中，动态参数可以是用于描述交通参与者元素的运动情况和运动趋势的参数，可以包括速度信息、位置信息、反应时间以及未来意图。待处理测试场景可以是在待测试静态场景的基础上为各交通参与者元素添加动态参数后构建的场景。具体的，可以从待测试静态场景中确定出交通参与者元素，并为各交通参与者元素赋予各种预设的动态参数，例如，结合交通流理论以通过随机交通流的生成多种动态参数，或者基于真实案例数据的泛化生成多种动态参数，通过排列组合来模拟复杂的交通环境，得到至少一个待处理测试场景。需要说明的是，若是基于实案例数据的泛化来构建待处理测试场景，则需要合理的调整真实案例中的某些数据特征，比如对多元类型数据进行整合与加工，通过算法构建逼真且真实的智能实际模型，从而泛化生成新的动态场景案例，以生成与交通参与者元素对应的多种动态参数，来构建待处理测试场景。在真实的场景中，自动驾驶车辆的运动以及相对于其他交通参与者之间的相互运动关系是随着时间在发生不断的变化，因此，需要根据添加动态参数对不同的交通参与者元素进行组合构建和测试。图5是本发明实施例提供的一种T字道路对应的待处理测试场景示意图。图6是本发明实施例提供的一种向右急转弯道路对应的待处理测试场景示意图。在上述示例的基础上，在构建至少一个待处理测试场景之后，还可以通过删除待处理测试场景中某些无关的干扰车辆来保证待处理测试场景的有效性和可靠性，具体可以是：针对每个待处理测试场景，根据待处理测试场景中的各干扰车辆的动态参数，确定各干扰车辆对待测试车辆的干扰程度；将待处理测试场景中的干扰程度小于预设阈值的干扰车辆删除。其中，干扰程度可以用于描述干扰车辆对待测试车辆的行驶产生影响的程度。预设阈值可以是预先设定的数值或者条件，用于剔除无关的干扰车辆。具体的，针对每个待处理测试场景，针对其中每个干扰车辆，通过该干扰车辆的动态参数，进行干扰车辆的运动分析，确定该干扰车辆以及待测试车辆的行驶意图，进而，确定该干扰车辆对待测试车辆的干扰程度。在确定出干扰程度后，判断干扰程度是否满足预设阈值，若是，则将该干扰车辆从待处理测试场景中删除，若否，则保留待处理测试场景中该干扰车辆。示例性的，若干扰车辆的所有未来意图对待测试车辆的运动行为不造成干扰或者干扰很小，则可以将此类的干扰车辆从待处理测试场景中去除。若干扰车辆在某一行驶方向的运动行为对待测试车辆的运动行为不造成干扰或者干扰很小，则将此类的干扰车辆从待处理测试场景中去除。例如：当待测试车辆和干扰车辆都在同一方向直行、或者待测试车辆和干扰车辆，向相邻车道以及相隔车道在安全距离内向左或向右换道时，此时，干扰车辆对待测试车辆的运动影响很小，即干扰程度小于预设阈值，可以去除。当待测试车辆与干扰车辆分别向不同方向的车道行驶时，或者待测试车辆换道的过程中，干扰车辆静止，此时，干扰车辆对待测试车辆的影响也可以忽略不计，可以去除。进一步的，需要确定待测试车辆和干扰车辆的行驶意图，如图7所示。一般情况下，在长直道场景路段，待测试车辆和干扰车辆一般有7种可能的运动意图：车道保持直行和逆行，向左或向右变道，向左或向右偏离和静止状态，具体的行驶意图需要取决于道路交互环境。S130、根据各待处理测试场景中的待测试车辆与各交通参与者元素对应干扰车辆之间的位置关系以及待处理测试场景中的车道数量，从各待处理测试场景中确定出仿真测试场景。其中，待测试车辆可以是用于进行仿真测试的自动驾驶车辆。干扰车辆可以是交通参与者元素中的机动车和/或非机动车。位置关系可以是各干扰车辆相对于待测试车辆在位置上的相对关系，可以包括方位和距离等。车道数量可以是待处理测试场景中当前的车道的数量。仿真测试场景可以是通过构建和合并筛选后剩余的待处理测试场景，以用于后续的自动驾驶汽车仿真测试等。具体的，针对每个待处理测试场景，可以确定其中待测试车辆与各干扰车辆之间的位置关系。进而，根据待处理测试场景中的位置关系和车道数量，将位置关系和车道数量相同或相似的待处理测试场景进行合并，保留其中一个，避免待处理测试场景的重复，将剩余的待处理测试场景作为仿真测试场景。本实施例具有以下技术效果：根据预先建立的静态元素集合，从中确定出待组合静态元素，以组合构建得到至少一个待测试静态场景，进而，结合预设的与交通参与者元素对应的动态参数，将每个待测试静态场景构建为至少一个待处理测试场景，并且，根据各待处理测试场景中的待测试车辆与各交通参与者元素对应干扰车辆之间的位置关系以及待处理测试场景中的车道数量，从各待处理测试场景中确定出仿真测试场景，以删除相同和相似的待处理测试场景，实现了通过排列组合静态元素以及与交通参与者元素对应的动态参数，提高测试场景覆盖度，并通过对测试场景的合并和整理，降低测试场景的重复度的效果。图8是本发明实施例提供的另一种自动驾驶汽车的测试场景构建方法的流程图，在上述实施例的基础上，针对构建待处理测试场景的具体实施方式以及新增的划分待处理测试场景，确定仿真测试场景的具体实施方式可以参见本技术方案的详细阐述。其中，与上述各实施例相同或相应的术语的解释在此不再赘述。参见图8，该自动驾驶汽车的测试场景构建方法具体包括：S210、根据预先建立的静态元素集合，确定待组合静态元素，并根据待组合静态元素，构建至少一个待测试静态场景。S220、根据待测试静态场景以及预设的与交通参与者元素对应的动态参数，构建至少一个待处理测试场景。S230、针对每个待测试静态场景，确定待测试静态场景中的每个交通参与者元素对应的至少一组动态参数，根据各交通参与者元素对应的至少一组动态参数进行组合，确定与每个待测试静态场景对应的至少一个待处理测试场景。具体的，针对每个待测试静态场景，对该待测试静态场景中的每个交通参与者元素构建至少一组动态参数。进而，将各交通参与者元素对应的动态参数进行排列组合，可以得到至少一个待处理测试场景。可以理解的是，每个待测试静态场景对应至少一个待处理测试场景。示例性的，某一个待测试静态场景包括三个交通参与者元素，即元素A、B和C，针对元素A构建了3组动态参数，针对元素B构建了4组动态参数，针对元素C构建了6组动态参数，那么，元素A、B和C进行组合可以得到3×4×6=72种组合，即可以得到72个待处理测试场景。S240、将待处理测试场景，按照动态场景类别进行分类，确定与每个动态场景类别相对应的至少一个待处理测试场景。其中，动态场景类别可以是对待处理测试场景进行分类的类别，动态场景类别包括突发场景、超车场景、换道场景和跟驰场景。具体的，可以通过随机交通流理论对各待处理测试场景进行分析，确定每个待处理测试场景所属的动态场景类别，即确定与每个动态场景类别相对应的至少一个待处理测试场景，以对待处理测试场景进行分类。示例性的，在超车场景中，待测试车辆的左右两侧或后方都可能出现干扰车辆，当某一干扰车辆进行超车时，需要通过不同的速度变化和转向行驶来调整与待测试车辆的距离，进而实现超越待测试车辆的目的。在此场景中，自动驾驶汽车，即待测试车辆，需要对周围环境进行全面的识别与预测，需要识别各其他干扰车辆是否在其车道正常行驶，旁侧车道是否有其他干扰车辆通过的危险以及静态场景影响的一些视觉等信息，这些信息综合起来就形成一系列的信息量用于后续仿真测试，即分类后能够更加细致的按照不同动态场景类别针对后续各功能安全进行仿真测试。S250、针对每个待处理测试场景，确定待处理测试场景中的待测试车辆与各干扰车辆之间的位置关系。其中，位置关系包括侧包围、半包围或全包围。侧包围指的是待测试车辆的任意一侧出现干扰车辆。半包围指的是待测试车辆的至少两侧且至少有一个方位上没有出现干扰车辆。全包围指的是待测试车辆的任一方位都有干扰车辆的存在。示例性的，现以双向三车道的一侧方向车道为例，“侧包围”状态是指待测试车辆位于任一车道上，只有任意一个车道的任一方位有干扰车辆分布；“半包围”状态是指待测试车辆位于任一车道上，只有一侧车道没有干扰车辆；“全包围状态”是指待测试车辆位于中间车道，其余任一车道上均有干扰车辆分布。如图9所示，待测试车辆与干扰车辆之间的位置关系示意图，其中，左侧为“侧包围”状态，中间为“半包围”状态，右侧为“全包围”状态。S260、若存在至少两个待处理测试场景的动态场景类别相同，位置关系相同，且车道数量不同，则保留至少两个待处理测试场景中车道数量最少的待处理测试场景作为仿真测试场景，并删除至少两个待处理测试场景中车道数量非最少的待处理测试场景。其中，车道数量可以是待处理测试场景中的与待测试车辆同方向的车道的数量。具体的，若存在至少两个待处理测试场景的动态场景类别相同，位置关系相同，且车道数量不同，则表明这至少两个待处理测试场景是相类似的，可以通过保留至少两个待处理测试场景中车道数量最少的待处理测试场景，并删除至少两个待处理测试场景中车道数量非最少的待处理测试场景，来留下一个待处理测试场景作为仿真测试场景。可以理解的是，若存在至少两个待处理测试场景的动态场景类别相同，位置关系相同，且车道数量相同，则表明这至少两个待处理测试场景是相同的，可以保留其中任意一个待处理测试场景。可选的，若保留的至少两个待处理测试场景中车道数量最少的待处理测试场景中存在空闲车道，则可以将空闲车道删除。其中，空闲车道为不存在任意车辆的车道。进一步的，现实道路中按照公路等级可以把车道数量分为：高速、一级公路的车道数大于等于4；二级公路和三级公路的车道数一般为2；四级公路的车道数一般采用双车道，交通量小或困难路段可以采用单车道。以最多车道数对测试环境进行设计时，即以双向四车道为例，待测试车辆与干扰车辆在车道上有“侧包围”、“半包围”和“全包围”等几种状态。示例性的，如图10所示的“全包围”状态下的替代示意图，在双向四车道上当待测试车辆位于中间车道的“全包围”状态可以被双向三车道的“全包围”状态替代。如图11所示的“半包围”状态下的替代示意图，双向四车道和三车道的“半包围”状态可以被双向两车道的“半包围”状态替代。如图12所示的“侧包围”状态下的替代示意图，双向四车道和三车道的“侧包围”状态可以被双向两车道的“侧包围”状态替代。当然，对于双向两车道和双向单车道的“半包围”和“侧包围”状态的干扰车辆行驶方向不同，这就需要对自动驾驶汽车的控制系统在此场景中仿真测试其识别对向来车的能力，因此，此类场景不能被替代。本实施例具有以下技术效果：通过针对每个待测试静态场景，确定待测试静态场景中的每个交通参与者元素对应的至少一组动态参数，根据各交通参与者元素对应的至少一组动态参数进行组合，确定与每个待测试静态场景对应的至少一个待处理测试场景，以提高测试场景的覆盖度，通过将待处理测试场景，按照动态场景类别进行分类，确定与每个动态场景类别相对应的至少一个待处理测试场景，以便对测试场景进行分类，根据动态场景类别进行后续的合并处理，通过针对每个待处理测试场景，确定待处理测试场景中的待测试车辆与各干扰车辆之间的位置关系，若存在至少两个待处理测试场景的动态场景类别相同，位置关系相同，且车道数量不同，则保留至少两个待处理测试场景中车道数量最少的待处理测试场景作为仿真测试场景，并删除至少两个待处理测试场景中车道数量非最少的待处理测试场景，实现了对测试场景的合并和整理，降低测试场景的重复度的效果。图13是本发明实施例提供的一种自动驾驶汽车的功能安全仿真测试方法的流程图，在上述实施例的基础上，在从各待处理测试场景中确定出仿真测试场景之后，进行功能安全仿真测试的具体实施方式可以参见本技术方案的详细阐述。其中，与上述各实施例相同或相应的术语的解释在此不再赘述。参见图13，该自动驾驶汽车的功能安全仿真测试方法具体包括：S310、根据预先建立的静态元素集合，确定待组合静态元素，并根据待组合静态元素，构建至少一个待测试静态场景。S320、根据待测试静态场景以及预设的与交通参与者元素对应的动态参数，构建至少一个待处理测试场景。S330、根据各待处理测试场景中的待测试车辆与各交通参与者元素对应干扰车辆之间的位置关系以及待处理测试场景中的车道数量，从各待处理测试场景中确定出仿真测试场景。S340、根据待测试车辆，构建待测试车辆仿真模型。其中，待测试车辆仿真模型可以是对待测试车辆进行动力学仿真建模后得到的仿真模型，用于模拟待测试车辆。具体的，针对待测试车辆，可以获取待测试车辆各种参数化表达形式，根据获取的参数化表达形式可以进行动力学仿真建模，得到待测试车辆仿真模型。其中，待测试车辆仿真模型中应当包含安装在待测试车辆上的用于感知环境的传感器的模型，以便于后续进行模拟自动驾驶功能测试时能够对自动驾驶算法进行响应。动力学仿真建模的目的是用于模拟待测试车辆本身对自动驾驶算法控制的响应，可以是对加速、制动和转向的响应。待测试车辆的参数化是评判自动驾驶汽车操纵稳定性和行驶平顺性的重要依据。对于后续面向车辆的功能安全仿真测试，通常需要待测试车辆模型具有较高的精度，才能使仿真结果具有较高的可信度。待测试车辆模型可以用于逼真地反映待测试车辆受力与运动之间的关系。通常可以是由多自由度构成的高阶非线性模型，还可以是基于车辆系统的机械结构或者系统特性等不同角度建立的模型。并且，在模型的建立过程中还需要在模型的精度和数值求解的效率间取得平衡。可以使用集中质量化法把待测试车辆中除弹性零件外的各个部件如车体、构架等都可视为刚体，只有在分析其结构弹性振动或弹性变形时才考虑其弹性。将没有相对运动关系的零部件组合为一体。对于轮胎，可以只考虑纯侧偏轮胎特性，忽略横向、纵向轮胎力的耦合关系，不考虑轮胎的横向载荷转移。在上述示例的基础上，可以通过下述各步骤来根据待测试车辆，构建待测试车辆仿真模型：步骤一、针对待测试车辆进行模型参数化处理，得到初始车辆仿真模型。其中，初始车辆仿真模型可以是对待测试车辆进行模型参数化处理得到的参数模型。在建立初始车辆仿真模型之前，需要根据待测试车辆的动力学特征配置合适的车辆参数，以使这些复杂的车辆参数融合在一起，来保证待测试车辆的仿真精度较高，使初始车辆仿真模型更接近于实际场景中的待测试车辆。其中，模型参数化处理包括：车体模型参数化处理、轮胎模型参数化处理、转向系统模型参数化处理、制动系统模型参数化处理、动力系统模型参数化处理、传动系统模型参数化处理、空气动力学模型参数化处理以及硬件接口模型参数化处理中的至少一种。步骤二、根据待测试车辆上安装的待测试传感器，构建传感器模型。其中，待测试传感器可以是安装在待测试车辆上的传感器，用于在自动驾驶过程中进行环境感知。传感器模型可以是与不同类型的传感器对应的模型，其中包括各种传感器参数的配置。具体的，针对待测试车辆上安装的每个待测试传感器，均可以建立一个与之对应的模型，即传感器模型，用于在测试环境中，模拟待测试传感器对测试环境的感知。可选的，可以根据待测试功能确定与待测试功能对应的待测试传感器，针对与待测试功能无关的传感器进行默认模型建模处理即可，以简化传感器模型的构建过程，提高模型构建效率。构建传感器模型，即环境感知传感器的建模，传感器模型可以用于模拟待测试车辆上安装的各种待测试传感器。模拟待测试传感器的传感器模型可以直接输出目标级信息，可以包括交通物体的类型、位置、速度等信息，道路相关信息、交通标志信息等。需要说明的是，自动驾驶汽车关键技术中的感知系统是以多种传感器捕获的数据以及地图资源的信息作为输入，之后经过计算机处理，来预估自动驾驶汽车的状态和对自动驾驶汽车周围环境的精确感知，为后续在实际道路上行驶时进行决策和控制提供必要的信息。依赖复杂的传感器和算法进行工作的感知系统是预期功能安全问题的重要来源。根据待测试传感器的种类的不同，可以模拟不同的信号内容，例如，摄像头传感器输出图像信号，激光雷达传感器输出点云信号，导航传感器输出定位信号等。步骤三、将传感器模型配置在初始车辆仿真模型上，得到待测试车辆仿真模型。具体的，根据待测试传感器在待测试车辆上的实际位置，可以将传感器模型配置在初始车辆仿真模型上，进而，可以将与待测试传感器相关的算法加载至初始车辆仿真模型中，以得到能够进行自动驾驶的待测试车辆仿真模型。通过待测试车辆上的雷达、超声波传感器、摄像头和其他传感器等对应的传感器模型可以感知待测试车辆周围的环境信号，并生成仿真的传感器信号，再进行信号处理、传感器融合和实施控制算法。通过这些算法可以决定是否通过加速或者制动来改变待测试车辆的速度，以及是否通过转动方向盘来改变待测试车辆方向等。其中，毫米波雷达可以利用无线电波对周围的物体进行探测和定位，可有效提取物体的速度信息，以识别障碍物。激光雷达系统能探测静态和动态物体，并提供被探测物体的高分辨率的几何图像、距离图像、速度图像。超声波传感器主要应用于短距离场景，可帮助待测试车辆探测外部环境并指导待测试车辆对此做出适当的反应，可应用在自动泊车和自动刹车系统中。图像传感器通过对采集图像进行计算机算法分析，能够识别行人、自行车、机动车、道路轨迹线、信号灯等环境信息，进而实现车道保持辅助、车道偏离预警、前向碰撞预警、全景泊车等功能。S350、根据待测试车辆仿真模型以及仿真测试场景，对待测试功能进行测试，获取测试数据，并根据测试数据以及与待测试功能对应的期望数据范围，确定测试结果。其中，待测试功能可以是仿真测试时需要进行功能安全测试的功能，例如自动泊车、自动刹车、车道保持辅助、车道偏离预警、前向碰撞预警、全景泊车等功能。测试数据可以是进行功能测试时，获取的与待测试车辆对应的参数数据。期望数据范围可以是功能安全时各种参数数据的范围，即各种参数数据的安全范围。可以理解的是，不同的待测试功能对应的期望数据范围可以相同也可以不同。测试结果可以是待测试车辆仿真模型在仿真测试场景中进行待测试功能的仿真测试的结果，可以包括测试通过或测试不通过。具体的，将待测试车辆仿真模型投放至仿真测试场景中，针对各种待测试功能，可以通过仿真平台分别进行仿真测试，得到与各种待测试功能对应的测试数据。进而，根据测试数据与待测试功能对应的期望数据范围，可以确定测试数据是否属于功能安全的数据，据此，可以确定测试结果。可选的，针对每种待测试功能，可以进行多次仿真测试，并将各次仿真对应的测试数据中危险系数最高的作为与该待测试功能对应的测试数据。通过仿真平台对自动驾驶汽车的功能安全进行仿真测试，在建立了待测试静态场景、待测试动态场景以及准确的待测试车辆仿真模型之后，对待测试功能安全的仿真测试的验证与精度评估主要就是对存在于待测试车辆的架构内各个模块的评估和对待测试车辆的整体框架的再评估，即获取的测试数据，从而，根据测试数据以及期望数据范围去验证仿真结果是否达到安全指标，即测试结果。在上述示例的基础上，测试数据包括自由度数据，自由度数据包括纵向数据、侧向数据、垂向数据、横摆数据、俯仰数据以及侧倾数据中的至少一种；可以通过下述步骤来根据测试数据以及与待测试功能对应的期望数据范围，确定测试结果：步骤一、针对每个待测试功能，将获取的与待测试功能对应的自由度数据和与待测试功能对应的期望数据范围进行匹配，得到匹配结果。其中，匹配结果可以包括匹配成功或匹配失败，自由度数据落入期望数据范围，可以认为是匹配成功，否则，可以认为是匹配失败。具体的，针对每个待测试功能，都可以获得六个自由度数据。进而，针对每个自由度数据，可以将其与对应的期望数据范围进行匹配，得到与该自由度数据对应的子匹配结果。若不存在子匹配结果为匹配失败，则认为与该待测试功能对应的匹配结果为匹配成功；若存在至少一个子匹配结果为匹配失败，则认为与该待测试功能对应的匹配结果为匹配失败。步骤二、若匹配结果为匹配成功，则确定与待测试功能对应的测试结果为测试通过；若匹配结果为匹配失败，则确定与待测试功能对应的测试结果为测试不通过。示例性的，测试数据还可以包括如图14所示的待测试车辆的受力示意图中的受力数据，例如：推力数据、制动力数据、接触力数据、驱动力数据等。采用简化待测试车辆的结构和零部件的组成，以等效质点或者刚体的受力和运动特性替代待测试车辆内成千上万个零部件的组成，通过仿真测试获取待测试车辆仿真模型的几何和动力学参数，即测试数据，以简化系统结构和模型，即简化待测试车辆的架构内各个模块的评估数据和对待测试车辆的整体框架的再评估数据，进而，提高仿真测试效率。可选的，根据待测试车辆仿真模型以及仿真测试场景，对待测试功能进行测试，可以是：把根据传感器模型获取的仿真测试场景中的感知信号进行处理得到的控制信号传递给待测试车辆仿真模型，控制待测试车辆仿真模型移动；通过传感器模型感知仿真测试场景中的路面的情况以及天气状况等条件，控制待测试车辆仿真模型进行准确有效的移动。经过上述测试流程，整个控制环路不断重复，直至完成待测试车辆在仿真测试场景中的各待测试功能的仿真测试。在对待测试功能进行测试，获取测试数据之后，基于获取的测试数据进行分析测试，可以了解待测试车辆仿真模型在虚拟的仿真测试场景中，随机突发事件对传感器模型所造成的影响，进而模拟待测试车辆会发生怎样的事故后果。进而，可以根据这些事故后果对控制系统中的控制算法等进行修复和改进，以降低事故发生的概率，从而减少或避免不安全事故的发生。本实施例具有以下技术效果：通过构建与待测试车辆对应的待测试车辆仿真模型，并根据待测试车辆仿真模型以及仿真测试场景，对待测试功能进行测试，得到测试结果，以通过元素化的方式构建场景模型，解决了测试路况单一、场景复杂度低的问题，实现了通过模型化的方式构建车辆模型并进行仿真测试，实现了有效的对车辆各功能进行仿真测试的效果。图15是本发明实施例提供的一种电子设备的结构示意图。如图15所示，电子设备400包括一个或多个处理器401和存储器402。处理器401可以是中央处理单元或者具有数据处理能力和/或指令执行能力的其他形式的处理单元，并且可以控制电子设备400中的其他组件以执行期望的功能。存储器402可以包括一个或多个计算机程序产品，所述计算机程序产品可以包括各种形式的计算机可读存储介质，例如易失性存储器和/或非易失性存储器。所述易失性存储器例如可以包括随机存取存储器和/或高速缓冲存储器等。所述非易失性存储器例如可以包括只读存储器、硬盘、闪存等。在所述计算机可读存储介质上可以存储一个或多个计算机程序指令，处理器401可以运行所述程序指令，以实现上文所说明的本发明任意实施例的自动驾驶汽车的测试场景构建方法以及/或者其他期望的功能。在所述计算机可读存储介质中还可以存储诸如初始外参、阈值等各种内容。在一个示例中，电子设备400还可以包括：输入装置403和输出装置404，这些组件通过总线系统和/或其他形式的连接机构互连。该输入装置403可以包括例如键盘、鼠标等等。该输出装置404可以向外部输出各种信息，包括预警提示信息、制动力度等。该输出装置404可以包括例如显示器、扬声器、打印机、以及通信网络及其所连接的远程输出设备等等。当然，为了简化，图15中仅示出了该电子设备400中与本发明有关的组件中的一些，省略了诸如总线、输入/输出接口等等的组件。除此之外，根据具体应用情况，电子设备400还可以包括任何其他适当的组件。除了上述方法和设备以外，本发明的实施例还可以是计算机程序产品，其包括计算机程序指令，所述计算机程序指令在被处理器运行时使得所述处理器执行本发明任意实施例所提供的自动驾驶汽车的测试场景构建方法的步骤。所述计算机程序产品可以以一种或多种程序设计语言的任意组合来编写用于执行本发明实施例操作的程序代码，所述程序设计语言包括面向对象的程序设计语言，诸如Java、C++等，还包括常规的过程式程序设计语言，诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、作为一个独立的软件包执行、部分在用户计算设备上部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。此外，本发明的实施例还可以是计算机可读存储介质，其上存储有计算机程序指令，所述计算机程序指令在被处理器运行时使得所述处理器执行本发明任意实施例所提供的自动驾驶汽车的测试场景构建方法的步骤。所述计算机可读存储介质可以采用一个或多个可读介质的任意组合。可读介质可以是可读信号介质或者可读存储介质。可读存储介质例如可以包括但不限于电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。需要说明的是，本发明所用术语仅为了描述特定实施例，而非限制本申请范围。如本发明说明书中所示，除非上下文明确提示例外情形，“一”、“一个”、“一种”和/或“该”等词并非特指单数，也可包括复数。术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法或者设备中还存在另外的相同要素。还需说明的是，术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。除非另有明确的规定和限定，术语“安装”、“相连”、“连接”等应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案。
