标题title
坐标数据处理方法和装置
摘要abst
本发明实施例提供了一种坐标数据处理方法和装置，其中，该方法包括：获取相机坐标系的参数，根据第一转换规则将相机坐标系转换成倾角仪坐标系；获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将倾角仪坐标系转换成世界坐标系；将相机采集到的点云数据通过第一转换规则和第二转换规则转换成世界坐标系的数据。通过本发明，解决了建筑测量设备坐标拟合结果精确度低的问题，达到提高建筑测量设备坐标转换结果精确度的效果。
权利要求书clms
1.一种坐标数据处理方法，应用于3D相机与倾角仪组合结构，其特征在于，包括：获取相机坐标系的参数，根据第一转换规则将所述相机坐标系转换成倾角仪坐标系；获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系；将所述相机采集到的点云数据通过所述第一转换规则和所述第二转换规则转换成所述世界坐标系的数据。2.根据权利要求1所述的方法，其特征在于，获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系包括：获取所述倾角仪x轴与所述世界坐标系的水平面之间的夹角α、所述倾角仪y轴与所述世界坐标系的水平面之间的夹角β；确定所述世界坐标系的水平面的法向量，根据所述夹角α、夹角β确定所述倾角仪x轴的单位向量、所述倾角仪的y轴向量；通过预设参数对所述倾角仪的y轴向量进行方向约束，得到约束向量；根据所述约束向量和所述倾角仪x轴的单位向量计算所述倾角仪坐标系的XoY平面法向量；根据所述倾角仪坐标系的XoY平面法向量、世界坐标系x轴的单位向量和世界坐标系y轴的向量计算基变换矩阵；对所述基变换矩阵进行变换得到M矩阵，其中，所述M矩阵用于将所述倾角仪坐标系XoY平面变换至与所述世界坐标系的水平面平行。3.根据权利要求2所述的方法，其特征在于，获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系包括：确定所述倾角仪x轴的单位向量为所述倾角仪的y轴向量通过公式1计算向量b和所述世界坐标系水平面的夹角：将所述向量a和所述向量b的数据带入公式1得到公式2，通过参数对所述向量b进行方向约束，得到约束向量/＞通过公式3计算所述倾角仪坐标系的XoY平面XoY平面法向量/＞对公式3进行变换，得到所述基变换矩阵利用所述基变换矩阵将倾角仪XoY平面变换至与世界水平面平行：4.根据权利要求3所述的方法，其特征在于，获取相机坐标系的参数，根据第一转换规则将所述相机坐标系转换成所述倾角仪坐标系包括：对所述相机坐标系的水平面和所述倾角仪坐标系的XoY平面进行平行验证；在验证通过的情况下，通过矩阵表示所述相机坐标系旋转角度γ后与所述倾角仪坐标系同向；通过矩阵将所述相机坐标系的水平面转换成所述倾角仪坐标系的XoY平面。5.根据权利要求4所述的方法，其特征在于，对所述相机坐标系的水平面和所述倾角仪坐标系的XoY平面进行平行验证包括：在将所述相机和所述倾角仪组件安装在水平基座后，调节水平基座控制倾角仪X轴与Y轴偏转角度均为0度；获取相机拍摄的标准水平面点云，获取点云平面的法向量，若点云平面的法向量与世界坐标系Z轴的差小于预设差值，即确定相机坐标系的水平面和所述倾角仪坐标系的XoY平面平行。6.根据权利要求4所述的方法，其特征在于，通过以下方式确定γ：通过代码在区间内以预设步长遍历各个角度带入矩阵MH确定γ，其中，通过矩阵MH变换所述相机拍摄到的每组点云平面的法向量，在遍历过程中存在角度γ，使每个点云平面的法向量在变换后与的差值在预设范围内。7.一种坐标数据处理装置，应用于3D相机与倾角仪组合结构，其特征在于，包括：第一获取单元，用于获取相机坐标系的参数，根据第一转换规则将所述相机坐标系转换成所述倾角仪坐标系；第二获取单元，用于获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系；转换单元，用于将所述相机采集到的点云数据通过所述第一转换规则和所述第二转换规则转换成所述世界坐标系的数据。8.根据权利要求7所述的装置，其特征在于，所述第二获取单元包括：获取模块，用于获取所述倾角仪x轴与所述世界坐标系的水平面之间的夹角α、所述倾角仪y轴与所述世界坐标系的水平面之间的夹角β；确定模块，用于确定所述世界坐标系的水平面的法向量，根据所述夹角α、夹角β确定所述倾角仪x轴的单位向量、所述倾角仪的y轴向量；约束模块，用于通过预设参数对所述倾角仪的y轴向量进行方向约束，得到约束向量；第一计算模块，用于根据所述约束向量和所述倾角仪x轴的单位向量计算所述倾角仪坐标系的XoY平面法向量；第二计算模块，用于根据所述倾角仪坐标系的XoY平面法向量、世界坐标系x轴的单位向量和世界坐标系y轴的向量计算基变换矩阵；变换模块，用于对所述基变换矩阵进行变换得到M矩阵，其中，所述M矩阵用于将所述倾角仪坐标系XoY平面变换至与所述世界坐标系的水平面平行。9.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有计算机程序，其中，所述计算机程序被设置为运行时执行所述权利要求1至6任一项中所述的方法。10.一种电子装置，包括存储器和处理器，其特征在于，所述存储器中存储有计算机程序，所述处理器被设置为运行所述计算机程序以执行所述权利要求1至6任一项中所述的方法。
说明书desc
技术领域本发明实施例涉及数据处理领域，具体而言，涉及一种坐标数据处理方法和装置。背景技术现有一种建筑测量设备，其测量功能由3D相机扫描点云，并对点云进行评估完成。测量任务中，对墙面的垂直度和地面的水平度测量是重要环节，并需要结合倾角仪辅助完成，两者固定安装在一起，如图1所示上方为相机、下方为倾角仪。在测量墙面垂直度与地面水平度时，相机坐标系XoY面应保持水平，而实际测量过程中，由于相机与倾角仪的姿态会跟随下方设备整体不断变化，无法保证始终处于水平状态，因此，标定任务即是利用已知数据，经过一系列变换，将相机坐标系XoY面变换至水平。传统标定方法通过多角度拍摄点云，算法拟合转换矩阵来对齐两坐标系的三个轴，同时拟合三个轴在算法上变换难度大、在采样上耗时长、在拟合结果上精度低，无法满足建筑测量领域高精度的需求。由此可知，相关技术中存在建筑测量设备坐标拟合结果精确度低的问题。针对相关技术中存在的上述问题，目前尚未提出有效的解决方案。发明内容本发明实施例提供了一种坐标数据处理方法和装置，以至少解决相关技术中存在建筑测量设备坐标拟合结果精确度低的问题。根据本发明的一个实施例，提供了一种坐标数据处理方法，应用于3D相机与倾角仪组合结构，包括：获取相机坐标系的参数，根据第一转换规则将所述相机坐标系转换成所述倾角仪坐标系；获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系；将所述相机采集到的点云数据通过所述第一转换规则和所述第二转换规则转换成所述世界坐标系的数据。进一步地，获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系包括：获取所述倾角仪x轴与所述世界坐标系的水平面之间的夹角α、所述倾角仪y轴与所述世界坐标系的水平面之间的夹角β；确定所述世界坐标系的水平面的法向量，根据所述夹角α、夹角β确定所述倾角仪x轴的单位向量、所述倾角仪的y轴向量；通过预设参数对所述倾角仪的y轴向量进行方向约束，得到约束向量；根据所述约束向量和所述倾角仪x轴的单位向量计算所述倾角仪坐标系的XoY平面法向量；根据所述倾角仪坐标系的XoY平面法向量、世界坐标系x轴的单位向量和世界坐标系y轴的向量计算基变换矩阵；对所述基变换矩阵进行变换得到M矩阵，其中，所述M矩阵用于将所述倾角仪坐标系XoY平面变换至与所述世界坐标系的水平面平行。进一步地，获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系包括：确定所述倾角仪x轴的单位向量为所述倾角仪的y轴向量/＞通过公式1计算向量b和所述世界坐标系水平面的夹角：/＞将所述向量a和所述向量b的数据带入公式1得到公式2，/＞通过参数/＞对所述向量b进行方向约束，得到约束向量/＞通过公式3计算所述倾角仪的XoY平面法向量/＞对公式3进行变换，得到所述基变换矩阵/＞利用所述基变换矩阵将倾角仪XoY平面变换至与世界水平面平行：进一步地，获取相机坐标系的参数，根据第一转换规则将所述相机坐标系转换成所述倾角仪坐标系包括：对所述相机坐标系的水平面和所述倾角仪坐标系的XoY平面进行平行验证；在验证通过的情况下，通过矩阵表示所述相机坐标系旋转角度γ后与所述倾角仪坐标系同向；通过矩阵/＞将所述相机坐标系的水平面转换成所述倾角仪坐标系的XoY平面。进一步地，对所述相机坐标系的水平面和所述倾角仪坐标系的XoY平面进行平行验证包括：在将所述相机和所述倾角仪组件安装在水平基座后，调节水平基座控制倾角仪X轴与Y轴偏转角度均为0度；获取相机拍摄的标准水平面点云，获取点云平面的法向量，若点云平面的法向量与世界坐标系Z轴的差小于预设差值，即确定相机坐标系的水平面和所述倾角仪坐标系的XoY平面平行。进一步地，通过以下方式确定γ：通过代码在区间内以预设步长遍历各个角度带入矩阵MH确定γ，其中，通过矩阵MH变换所述相机拍摄到的每组点云平面的法向量，在遍历过程中存在角度γ，使每个点云平面的法向量在变换后与的差值在预设范围内。根据本发明的另一个实施例，提供了一种坐标数据处理装置，应用于3D相机与倾角仪组合结构，包括：第一获取单元，用于获取相机坐标系的参数，根据第一转换规则将所述相机坐标系转换成所述倾角仪坐标系；第二获取单元，用于获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将所述倾角仪坐标系转换成所述世界坐标系；转换单元，用于将所述相机采集到的点云数据通过所述第一转换规则和所述第二转换规则转换成所述世界坐标系的数据。进一步地，所述第二获取单元包括：获取模块，用于获取所述倾角仪x轴与所述世界坐标系的水平面之间的夹角α、所述倾角仪y轴与所述世界坐标系的水平面之间的夹角β；确定模块，用于确定所述世界坐标系的水平面的法向量，根据所述夹角α、夹角β确定所述倾角仪x轴的单位向量、所述倾角仪的y轴向量；约束模块，用于通过预设参数对所述倾角仪的y轴向量进行方向约束，得到约束向量；第一计算模块，用于根据所述约束向量和所述倾角仪x轴的单位向量计算所述倾角仪坐标系的XoY平面法向量；第二计算模块，用于根据所述倾角仪坐标系的XoY平面法向量、世界坐标系x轴的单位向量和世界坐标系y轴的向量计算基变换矩阵；变换模块，用于对所述基变换矩阵进行变换得到M矩阵，其中，所述M矩阵用于将所述倾角仪坐标系XoY平面变换至与所述世界坐标系的水平面平行。根据本发明的又一个实施例，还提供了一种计算机可读存储介质，所述计算机可读存储介质中存储有计算机程序，其中，所述计算机程序被设置为运行时执行上述任一项方法实施例中的步骤。根据本发明的又一个实施例，还提供了一种电子装置，包括存储器和处理器，所述存储器中存储有计算机程序，所述处理器被设置为运行所述计算机程序以执行上述任一项方法实施例中的步骤。通过本发明，获取相机坐标系的参数，根据第一转换规则将相机坐标系转换成倾角仪坐标系；获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将倾角仪坐标系转换成世界坐标系；将相机采集到的点云数据通过第一转换规则和第二转换规则转换成世界坐标系的数据，因此，可以解决相关技术中存在的建筑测量设备坐标拟合结果精确度低的问题，达到提高建筑测量设备坐标转换结果精确度的效果。附图说明图1是本实施例的结构示意图；图2是本发明实施例的一种坐标数据处理方法的移动终端的硬件结构框图；图3是根据本发明实施例的坐标数据处理方法的流程图；图4是本实施例的两组坐标的位置关系示意图；图5是根据本发明实施例的坐标数据处理装置的结构框图。具体实施方式下文中将参考附图并结合实施例来详细说明本发明的实施例。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。本申请实施例中所提供的方法实施例可以在移动终端、计算机终端或者类似的运算装置中执行。以运行在移动终端上为例，图2是本发明实施例的一种坐标数据处理方法的移动终端的硬件结构框图。如图2所示，移动终端可以包括一个或多个处理器102和用于存储数据的存储器104，其中，上述移动终端还可以包括用于通信功能的传输设备106以及输入输出设备108。本领域普通技术人员可以理解，图2所示的结构仅为示意，其并不对上述移动终端的结构造成限定。例如，移动终端还可包括比图2中所示更多或者更少的组件，或者具有与图2所示不同的配置。存储器104可用于存储计算机程序，例如，应用软件的软件程序以及模块，如本发明实施例中的坐标数据处理方法对应的计算机程序，处理器102通过运行存储在存储器104内的计算机程序，从而执行各种功能应用以及数据处理，即实现上述的方法。存储器104可包括高速随机存储器，还可包括非易失性存储器，如一个或者多个磁性存储装置、闪存、或者其他非易失性固态存储器。在一些实例中，存储器104可进一步包括相对于处理器102远程设置的存储器，这些远程存储器可以通过网络连接至移动终端。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。传输设备106用于经由一个网络接收或者发送数据。上述的网络具体实例可包括移动终端的通信供应商提供的无线网络。在一个实例中，传输设备106包括一个网络适配器，其可通过基站与其他网络设备相连从而可与互联网进行通讯。在一个实例中，传输设备106可以为射频模块，其用于通过无线方式与互联网进行通讯。在本实施例中提供了一种坐标数据处理方法，应用于3D相机与倾角仪组合结构，图3是根据本发明实施例的坐标数据处理方法的流程图，如图3所示，该流程包括如下步骤：步骤S101，获取相机坐标系的参数，根据第一转换规则将相机坐标系转换成倾角仪坐标系；步骤S102，获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将倾角仪坐标系转换成世界坐标系；步骤S103，将相机采集到的点云数据通过第一转换规则和第二转换规则转换成世界坐标系的数据。本实施例的技术方案可以应用于3D相机与倾角仪组合结构，在本实施例中，倾角仪和相机两者固定安装在一起，用于在建筑测量中扫描建筑物点云，并对点云进行评估完成测量，评估墙面的垂直度和地面的水平度，因此需要根据相机坐标系的参数，并根据一定规则来将相机坐标系转换成倾角仪坐标系，并根据倾角仪坐标系的参数和第二转换规则将倾角仪坐标系转换成世界坐标系，需要说明的是，第一转换规则和第二转换规则是基于相关参数来计算确定出的转换规则，基于同一个3D相机与倾角仪组合，在安装好不再移动的情况下，规则可以是不变的。在确定转换方式后，经过相机采集到的待测量的点云数据通过这两种转换规则可以转换成世界坐标系的数据，下一步可以通过这些数据判断待测量的建筑物的墙面垂直度和地面的水平度等。点云数据可以是待测量的建筑的图像等数据，本实施例通过这样的规则变换来实现坐标系的数据转换，相比于传统的算法拟合能够减少数据的计算量，减少变换难度，减少采样耗时，提高计算精度。在一个示例性实施例中，获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将倾角仪坐标系转换成世界坐标系包括：获取倾角仪x轴与世界坐标系的水平面之间的夹角α、倾角仪y轴与世界坐标系的水平面之间的夹角β；确定世界坐标系的水平面的法向量，根据夹角α、夹角β确定倾角仪x轴的单位向量、倾角仪的y轴向量；通过预设参数对倾角仪的y轴向量进行方向约束，得到约束向量；根据约束向量和倾角仪x轴的单位向量计算倾角仪坐标系的XoY平面法向量；根据倾角仪坐标系的XoY平面法向量、世界坐标系x轴的单位向量和世界坐标系y轴的向量计算基变换矩阵；对基变换矩阵进行变换得到M矩阵，其中，M矩阵用于将倾角仪坐标系XoY平面变换至与世界坐标系的水平面平行。在本实施例中，在坐标系转换时，需要获取倾角仪的x轴、y轴与世界坐标系水平面之间的夹角，根据夹角和各种法向量以及引入约束关系计算得到M矩阵，用该矩阵来得到变换关系，通过这样的计算，可以将倾角仪坐标系的XoY平面变换到与世界坐标系的水平面平行，也即坐标轴相同或者相反方向，由于倾角仪绕世界z轴旋转不影响其与世界水平面的夹角，因而不考虑z轴的变换，只需将倾角仪坐标系的XoY平面变换到世界坐标系的水平面即可。在一个示例性实施例中，获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将倾角仪坐标系转换成世界坐标系包括：确定倾角仪x轴的单位向量为倾角仪的y轴向量/＞通过公式1计算向量b和世界坐标系水平面的夹角：/＞将向量a和向量b的数据带入公式1得到公式2，通过参数/＞对向量b进行方向约束，得到约束向量通过公式3计算倾角仪坐标系的XoY平面法向量对公式3进行变换，得到基变换矩阵/＞利用所述基变换矩阵将倾角仪XoY平面变换至与世界水平面平行：/＞对基变换矩阵M矩阵进行变形得到M矩阵：在一个示例性实施例中，获取相机坐标系的参数，根据第一转换规则将相机坐标系转换成倾角仪坐标系包括：对相机坐标系的水平面和倾角仪坐标系的XoY平面进行平行验证；在验证通过的情况下，通过矩阵表示相机坐标系旋转角度γ后与倾角仪坐标系同向；通过矩阵/＞将相机坐标系的水平面转换成倾角仪坐标系的XoY平面。在本实施例中MH矩阵中M矩阵是上一步变换得到的M矩阵，将相机坐标系的水平面转换成倾角仪坐标系的XoY平面时，需要用到倾角仪坐标系的参数和世界坐标系之间的转换规则，通过MH矩阵可以将相机坐标系的水平面转换成倾角仪坐标系的XoY平面，最终实现相机坐标系向世界坐标系的转换，提高转换精度。在一个示例性实施例中，对相机坐标系的水平面和倾角仪坐标系的XoY平面进行平行验证包括：在将相机和倾角仪组件安装在水平基座后，调节水平基座控制倾角仪X轴与Y轴偏转角度均为0度；获取相机拍摄的标准水平面点云，获取点云平面的法向量，若点云平面的法向量与世界坐标系Z轴的差小于预设差值，即确定相机坐标系的水平面和倾角仪坐标系的XoY平面平行。该实施例实现相机坐标系与倾角仪坐标系的转换，这部分标定需要将相机坐标系X轴Y轴与倾角仪坐标系X轴Y轴对齐。现有数据为：标准水平面、相机坐标系下水平面点云数据、倾角仪数据。传统标定算法对三个轴的同时标定精度较差，本实施例能够简化标定过程、提升标定精度。若相机坐标系XoY平面与倾角仪坐标系XoY平面平行，则相机坐标系只需绕Z轴旋转一定角度就能使两系朝向一致，即只需标定一个角度，因此本实施例严格要求相机与倾角仪在组装固定后，两系的XoY平面互相平行。将组装好相机与倾角仪组件安装在水平基座上，调节水平基座控制倾角仪X轴与Y轴偏转角度均为0度，即倾角仪XoY平面水平，此处的调节可以是设备自动调节，也可以是手动调节，相机拍摄一标准水平面点云，获取点云平面的法向量，若法向量与世界坐标系Z轴的差极小，即可视为该点云平面与世界坐标系XoY平面平行。在一个示例性实施例中，通过以下方式确定γ：通过代码在区间内以预设步长遍历各个角度带入矩阵MH确定γ，其中，通过矩阵MH变换相机拍摄到的每组点云平面的法向量，在遍历过程中存在角度γ，使每个点云平面的法向量在变换后与的差值在预设范围内。将相机调整多种视角，拍摄标准水平面的点云多组，每组点云应均满足：经上式变换后，点云平面法向量无限接近。可通过代码遍历角度方法找出γ，在区间内，可以一定的步长为步伐，利用上式变换每组点云平面的法向量，带入矩阵成立，则表明该γ是合适的。若系统不存在其他显著误差，则在遍历过程中，必然会存在某个角度γ，令每个法向量在变换后都无限接近，且旋转角越远离γ，法向量与相差的越大，因此可确定γ的数值，标定完成。本发明还提供了一种具体实施方式，下面结合该具体实施方式对本发明的技术方案进行说明。本实施例的标定方法分为两个阶段，第一阶段完成倾角仪坐标系与世界坐标系的标定，第二阶段完成相机坐标系与倾角仪坐标系的标定。一、倾角仪坐标系与世界坐标系倾角仪的特性：倾角仪内置X轴与Y轴，且互相垂直，并提供两轴分别与水平面的夹角。在相机姿态变化后，倾角仪内部坐标系的x轴和y轴均会相对世界坐标产生方向偏移。为了计算点云的垂直度，需将点云从倾角仪坐标系通过基变换到世界坐标系，而垂直度与水平度的计算与绕z轴的旋转无关，故只需在变换后让两系的XoY平面平行即可。理论求解步骤：1.已知条件为：图4是本实施例的两组坐标的位置关系示意图，倾角仪x轴与世界水平面夹角α，倾角仪y轴与世界水平面夹角β；2、世界坐标系XoY平面默认水平，其法向量为3、由于倾角仪绕世界z轴旋转不影响其与世界水平面的夹角，因此可以默认倾角仪x轴在世界x轴上方，取作单位向量4、倾角仪y轴向量则有：代入数据得：不考虑向量的模长，为了约束方向可令x＝-sin，且根据右手系及实际的转动范围，可添加参数进行方向约束，则有：5、倾角仪XoY平面法向量为：综上可得基变换矩阵为：将倾角仪坐标系XoY面变换至水平可由下式计算完成：二、相机坐标系与倾角仪坐标系这部分标定需要将相机坐标系X轴Y轴与倾角仪坐标系X轴Y轴对齐。现有数据为：标准水平面、相机坐标系下水平面点云数据、倾角仪数据。传统标定算法对三个轴的同时标定精度较差，本实施例旨在简化标定过程、提升标定精度。事实上，若相机坐标系XoY平面与倾角仪坐标系XoY平面平行，则相机坐标系只需绕Z轴旋转一定角度就能使两系朝向一致，即只需标定一个角度。因此本实施例严格要求相机与倾角仪在组装固定后，两系的XoY平面互相平行。验证平行的方法如下：将组装好相机与倾角仪组件安装在水平基座上，调节水平基座控制倾角仪X轴与Y轴偏转角度均为0度，即倾角仪XoY平面水平。相机拍摄一标准水平面点云，获取点云平面的法向量，若法向量与世界坐标系Z轴的差极小，即可视为该点云平面与世界坐标系XoY平面平行。在平行的前提下，若存在角度γ使得相机坐标系旋转γ后能与倾角仪坐标系同向，则上述旋转变换可如此表示：整个变换过程可写为：旋转角度γ标定方法：将相机调整多种视角，拍摄标准水平面的点云多组。每组点云应均满足：经上式变换后，点云平面法向量无限接近。可通过代码遍历角度方法找出γ，在区间内，以0.01°为步长，利用上式变换每组点云平面的法向量。若系统不存在其他显著误差，则在遍历过程中，必然会存在某个角度γ，令每个法向量在变换后都无限接近，且旋转角越远离γ，法向量与相差的越大。遂标定完成。综上，标定过程中利用了倾角仪的两项数据、相机拍摄的点云数据以及标准水平面。第一阶段理论推导出计算公式后，不同设备的标定任务只需代入倾角仪数据即可完成坐标系变换；第二阶段，需拍摄水平面点云，所需数据量不大，通常5至7组点云即可获得较高的标定精度。从原理上看，本实施例的3D相机与倾角仪组合结构的标定方法，不依赖复杂的优化算法，基于基本的向量与矩阵变换原理完成标定，形式简洁；从操作上看，本方法采集少量数据即可完成标定，可大幅降低人力与时间成本；按本方法标定后，墙面垂直度和地面水平度的测量误差可控制在0.1°以内，达到行业领先水平。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到根据上述实施例的方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台终端设备执行本发明各个实施例所述的方法。在本实施例中还提供了一种坐标数据处理装置，该装置用于实现上述实施例及优选实施方式，已经进行过说明的不再赘述。如以下所使用的，术语“模块”可以实现预定功能的软件和/或硬件的组合。尽管以下实施例所描述的装置较佳地以软件来实现，但是硬件，或者软件和硬件的组合的实现也是可能并被构想的。图5是根据本发明实施例的坐标数据处理装置的结构框图，如图5所示，该装置包括：第一获取单元10，用于获取相机坐标系的参数，根据第一转换规则将相机坐标系转换成倾角仪坐标系；第二获取单元20，用于获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将倾角仪坐标系转换成世界坐标系；转换单元30，用于将相机采集到的点云数据通过第一转换规则和第二转换规则转换成世界坐标系的数据。该实施例通过第一获取单元10获取相机坐标系的参数，根据第一转换规则将相机坐标系转换成倾角仪坐标系；第二获取单元20获取倾角仪坐标系的参数和世界坐标系的参数，根据第二转换规则将倾角仪坐标系转换成世界坐标系；转换单元30将相机采集到的点云数据通过第一转换规则和第二转换规则转换成世界坐标系的数据，可以解决相关技术中存在的建筑测量设备坐标拟合结果精确度低的问题，达到提高建筑测量设备坐标转换结果精确度的效果。在一个示例性实施例中，第二获取单元20包括：获取模块，用于获取倾角仪x轴与世界坐标系的水平面之间的夹角α、倾角仪y轴与世界坐标系的水平面之间的夹角β；确定模块，用于确定世界坐标系的水平面的法向量，根据夹角α、夹角β确定倾角仪x轴的单位向量、倾角仪的y轴向量；约束模块，用于通过预设参数对倾角仪的y轴向量进行方向约束，得到约束向量；第一计算模块，用于根据约束向量和倾角仪x轴的单位向量计算倾角仪坐标系的XoY平面法向量；第二计算模块，用于根据倾角仪坐标系的XoY平面法向量、世界坐标系x轴的单位向量和世界坐标系y轴的向量计算基变换矩阵；变换模块，用于对基变换矩阵进行变换得到M矩阵，其中，M矩阵用于将倾角仪坐标系XoY平面变换至与世界坐标系的水平面平行。需要说明的是，上述各个模块是可以通过软件或硬件来实现的，对于后者，可以通过以下方式实现，但不限于此：上述模块均位于同一处理器中；或者，上述各个模块以任意组合的形式分别位于不同的处理器中。本发明的实施例还提供了一种计算机可读存储介质，该计算机可读存储介质中存储有计算机程序，其中，该计算机程序被设置为运行时执行上述任一项方法实施例中的步骤。在一个示例性实施例中，上述计算机可读存储介质可以包括但不限于：U盘、只读存储器、随机存取存储器、移动硬盘、磁碟或者光盘等各种可以存储计算机程序的介质。本发明的实施例还提供了一种电子装置，包括存储器和处理器，该存储器中存储有计算机程序，该处理器被设置为运行计算机程序以执行上述任一项方法实施例中的步骤。在一个示例性实施例中，上述电子装置还可以包括传输设备以及输入输出设备，其中，该传输设备和上述处理器连接，该输入输出设备和上述处理器连接。本实施例中的具体示例可以参考上述实施例及示例性实施方式中所描述的示例，本实施例在此不再赘述。显然，本领域的技术人员应该明白，上述的本发明的各模块或各步骤可以用通用的计算装置来实现，它们可以集中在单个的计算装置上，或者分布在多个计算装置所组成的网络上，它们可以用计算装置可执行的程序代码来实现，从而，可以将它们存储在存储装置中由计算装置来执行，并且在某些情况下，可以以不同于此处的顺序执行所示出或描述的步骤，或者将它们分别制作成各个集成电路模块，或者将它们中的多个模块或步骤制作成单个集成电路模块来实现。这样，本发明不限制于任何特定的硬件和软件结合。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
