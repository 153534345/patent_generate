标题title
基于对比学习的康复运动质量评估系统
摘要abst
本发明公开了一种基于对比学习的康复运动质量评估系统，其包括：三元组样本生成单元获取受试者的骨架序列集，并根据所述骨架序列集生成三元组样本；特征提取单元将所述三元组样本输入至特征提取网络中进行特征提取，以获得各个样本的特征；分数生成单元对提取到的各个样本的特征，使用高斯混合模型进行性能度量和分数映射，得到各个样本的分数；质量评估网络训练单元将生成的分数作为对应的样本的标签，将样本以及标签输入至质量评估网络中，对所述质量评估网络进行训练。质量评估单元基于训练得到的所述质量评估网络对采集的用户的骨架序列进行质量评估，获得预测分数。本发明解决了康复运动中缺乏专家评分标签导致的评估困难的问题。
权利要求书clms
1.一种基于对比学习的康复运动质量评估系统，其特征在于，包括：三元组样本生成单元，用于获取受试者的骨架序列集，并根据所述骨架序列集生成三元组样本；其中，所述三元组样本包括一个正样本、一个负样本以及一个anchor样本；特征提取单元，用于将所述三元组样本输入至特征提取网络中进行特征提取，以获得各个样本的特征；其中，所述特征提取网络采用多个输入使用权重共享的骨干网络；分数生成单元，用于对提取到的各个样本的特征，使用高斯混合模型进行性能度量和分数映射，得到各个样本的分数；质量评估网络训练单元，用于将生成的分数作为对应的样本的标签，重新采样生成用于质量评估的训练样本对，将训练样本对输入至质量评估网络中，对所述质量评估网络进行训练；其中，在质量评估网络的质量评价任务中，使用排列组合的方式在所述骨架序列集中构建训练样本对，然后通过特征提取网络提取不同样本的特征，并且在该训练中将不同样本的关节注意力矩阵和特征的差距进行量化，使得分数差距较小的样本的关节注意力矩阵和特征的差异较小，分数差距较大的样本的差距较大；质量评估单元，用于基于训练得到的所述质量评估网络对采集的用户的骨架序列进行质量评估，获得预测分数。2.根据权利要求1所述的基于对比学习的康复运动质量评估系统，其特征在于，所述骨架序列集的所有正常的样本为正样本，所有不正常的样本为负样本；在所述正样本中选择每个受试者的随机一次重复作为anchor样本。3.根据权利要求2所述的基于对比学习的康复运动质量评估系统，其特征在于，所述特征提取单元具体用于：设给定的三元组样本包括anchor样本、正样本/＞以及负样本/＞；将anchor样本、正样本/＞以及负样本/＞作为输入，经过权重共享的特征提取网络以提取对应的特征/＞；其中，特征提取网络的特征提取目标用如下公示表示：=/＞,/＞,/＞其中，函数F表示将构建的三元组样本编码到一定的特征空间，参数设置为w；损失函数Loss用于衡量正样本、负样本与anchor样本之间的距离；损失函数Loss的定义如下：其中，表示正样本和负样本之间的界限。4.根据权利要求3所述的基于对比学习的康复运动质量评估系统，其特征在于，所述分数生成单元具体用于：根据提取的所有正样本的特征初始化高斯混合模型的参数，以构造运动的统一标准；在具有/＞个高斯分量的高斯混合模型下发生的概率表示如下：其中，N为混合高斯函数，为高斯参数集合，/＞={/＞}，/＞分别表示第个高斯分量的混合系数、均值和协方差；将提取的每个样本的特征，计算其在高斯混合模型下的负对数似然，以得到样本动作的量化分数；其中，具体的映射公式如下所示：对于量化后得到的正样本分数集合P=，和负样本分数集合N=，采用如下的公式将量化分数映射至0～1区间，以获得各个正样本的最终分数/＞和负样本的最终分数/＞：其中，是特定的参数。5.根据权利要求4所述的基于对比学习的康复运动质量评估系统，其特征在于，所述质量评估网络训练单元具体用于：从所述骨架序列集中选择一对带分数标签的骨架序列生成训练样本对＜/＞, /＞＞；将所述训练样本对＜, /＞＞分别输入到特征提取网络来提取特征对＜/＞, /＞＞和关节注意力矩阵对＜/＞, /＞＞；根据所述特征对＜, /＞＞和关节注意力矩阵＜/＞, /＞＞对所述质量评估网络进行训练。6.根据权利要求5所述的基于对比学习的康复运动质量评估系统，其特征在于，所述特征提取网络包括十层相互叠加的时空卷积块，第层的时空卷积块表示为：其中，表示从全局角度学习的关节连接的拓扑结构，/＞表示根据样本生成的相邻矩阵，/＞、/＞分别表示第/＞层的输入和输出，/＞表示该层可训练的权重，/＞设为3，表示自环，向心，远心三个不同的图拓扑连接；从两个角度组合邻接矩阵，则定义关节注意力矩阵为:。7.根据权利要求6所述的基于对比学习的康复运动质量评估系统，其特征在于，所述质量评估网络的总体损失函数表示如下：=/＞+ /＞+/＞其中，=/＞表示分数误差损失，用于测量从给定骨架序列预测的分数与真实值的误差；/＞表示第/＞个样本的真实分数值，/＞表示第/＞个样本的分数预测值，/＞表示预测的误差阈值；表示特征相似度损失，/＞为输入成对骨架序列＜/＞＞的真实值，/＞为通过特征提取网络提取的输入样本的特征，/＞表示余弦相似度；/＞表示特征量化公式，被计算通过/＞,其中/＞表示训练数据中的最高分；表示关节注意力权重的损失，/＞为输入成对骨架序列＜/＞＞的真实值，表示输入成对样本＜/＞＞对应的关节注意力矩阵。
说明书desc
技术领域本发明涉及计算机技术领域，尤其涉及一种基于对比学习的康复运动质量评估系统。背景技术随着无监督学习的迅速发展，在计算机视觉问题中引入了对比学习方法。研究者尝试运用对比训练策略，获得有效的体育活动评价评分预测模型，以及技能训练的等级或等级评价模型。近年来，对比学习策略已被应用于其他计算机视觉任务中，通过使用对比学习可以更好的获得不同样本之间的细微差异，强化模型学习到更具有区分性的特征表示。在康复医学领域，身体康复训练往往是各种肌肉骨骼疾病患者康复的必修课和关键。最初的康复训练通常由临床医生组织和监督，以指导患者进行康复计划。但是为每个病人配备一名专业的临床医生是昂贵的。因此，最重要的康复训练通常是由患者在家进行。但由于缺乏专业指导和持续反馈，只有少数患者能够坚持完成居家康复训练，导致治疗时间延长，医疗成本增加。初步的研究已经把这个任务作为一个分类问题来处理。然而现有的研究目标是确定一个练习是正确的还是错误的，而不是评估练习的连续质量，患者在进行一段时间的训练后，无法给患者一个增量的反馈，而且需要特定领域的专家对运动质量进行标注，不能有效对患者的康复运动进行指导。此外，患者无法有针对性的对身体部位进行提升，现有方法无法提供可指导性的反馈意见。当患者和专家运动之间的差异较小时，采用现有的网络模型可能无法提取到显著的区分性的特征来对其进行区分，从而影响正确的判断。发明内容有鉴于此，本发明的目的在于提供一种基于对比学习的康复运动质量评估系统，以解决上述问题。本发明实施例提供了一种基于对比学习的康复运动质量评估系统，其包括：三元组样本生成单元，用于获取受试者的骨架序列集，并根据所述骨架序列集生成三元组样本；其中，所述三元组样本包括一个正样本、一个负样本以及一个anchor样本；特征提取单元，用于将所述三元组样本输入至特征提取网络中进行特征提取，以获得各个样本的特征；其中，所述特征提取网络采用多个输入使用权重共享的骨干网络；分数生成单元，用于对提取到的各个样本的特征，使用高斯混合模型进行性能度量和分数映射，得到各个样本的分数；质量评估网络训练单元，用于将生成的分数作为对应的样本的标签，重新采样生成用于质量评估的训练样本对，将训练样本对输入至质量评估网络中，对所述质量评估网络进行训练；其中，在质量评估网络的质量评价任务中，使用排列组合的方式在所述骨架序列集中构建训练样本对，然后通过特征提取网络来提取不同样本的特征，并且在该训练中将不同样本的关节注意力矩阵和特征的差距进行量化，使得分数差距较小的样本的关节注意力矩阵和特征的差异较小，分数差距较大的样本的差距较大；质量评估单元，用于基于训练得到的所述质量评估网络对采集的用户的骨架序列进行质量评估，获得预测分数。优选地，所述骨架序列集的所有正常的样本为正样本，所有不正常的样本为负样本；在所述正样本中选择每个受试者的随机一次重复作为anchor样本。优选地，所述特征提取单元具体用于：设给定的三元组样本包括anchor样本、正样本/＞以及负样本/＞；将anchor样本、正样本/＞以及负样本/＞作为输入，经过权重共享的特征提取网络以提取对应的特征/＞、/＞、/＞；其中，特征提取的目标用如下公示表示：=/＞,/＞,/＞其中，函数F表示将构建的三元组样本编码到一定的特征空间，参数设置为w；损失函数Loss用于衡量正样本、负样本与anchor样本之间的距离；损失函数Loss的定义如下：其中，表示正样本和负样本之间的界限。优选地，所述分数生成单元具体用于：根据提取的所有正样本的特征初始化高斯混合模型的参数，以构造运动的统一标准；/＞在带有/＞个高斯分量的高斯混合模型下发生的概率表示如下：其中，N为混合高斯函数，为高斯参数集合，/＞={/＞}，/＞分别表示第/＞个高斯分量的混合系数、均值和协方差；将提取的每个样本的特征，计算其在高斯混合模型下的负对数似然，以得到样本动作的量化分数，具体的公式如下所示：对于量化后得到的正样本分数集合P=，和负样本分数集合N=，采用如下的公式将量化分数映射至0～1区间，以获得各个正样本的最终分数/＞和负样本的最终分数/＞：其中，是特定的参数。优选地，所述质量评估网络训练单元具体用于：从所述骨架序列集中选择一对带分数标签的骨架序列生成训练样本对＜/＞,/＞＞；将所述训练样本对＜,/＞＞分别输入到特征提取网络来提取特征对＜/＞,/＞＞和关节注意力矩阵＜/＞,/＞＞；根据所述特征对＜,/＞＞和关节注意力矩阵＜/＞,/＞＞对所述质量评估网络进行训练。优选地，所述特征提取网络包括十层相互叠加的时空卷积块，第层的时空卷积块表示为：其中，表示从全局角度学习的关节连接的拓扑结构，/＞表示根据样本生成的相邻矩阵，/＞、/＞分别表示第/＞层的输入和输出，/＞表示该层可训练的权重，/＞设为3，表示自环，向心，远心三个不同的图拓扑连接；从两个角度组合邻接矩阵，则定义关节关节注意力矩阵为:。优选地，所述质量评估网络的总体损失函数表示如下：=/＞+/＞+/＞其中，=/＞表示分数误差损失，用于测量从给定骨架序列预测的分数与真实值的误差；/＞表示第/＞个样本的真实分数值，/＞表示第/＞个样本的分数预测值，/＞表示预测的误差阈值；表示特征相似度损失，/＞为输入成对骨架序列＜/＞＞的真实值，/＞为通过特征提取网络提取的输入样本的特征表示，/＞表示余弦相似度；/＞表示特征量化公式，被计算通过/＞,其中/＞表示训练数据中的最高分；表示关节注意力权重的损失，/＞为输入成对骨架序列＜/＞＞的真实值，表示输入成对样本＜/＞＞对应的关节关节注意力矩阵。综上所述，本实施例具有如下优点：1）针对康复训练中缺少连续分数标签的问题，利用对比学习的思想，使用来自同一练习的正样本、负样本以及anchor样本组成的三元组样本来训练特征提取网络，使特征提取网络能提取出样本更具代表性的特征，从而得到的分数可以更好的表示不同质量的运动，解决了康复运动中缺乏专家评分标签的问题；2）通过关节注意力矩阵区分不同关节对体育锻炼的重要性。此外，定义了不同样本骨骼间关节注意力矩阵的偏差损失，并将其与评分预测损失相结合，增强了网络对特征的学习能力。附图说明为了更清楚地说明本发明的技术方案，下面将对实施方式中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明第一实施例提供的基于对比学习的康复运动质量评估系统的结构示意图；图2为高斯混合模型的工作原理图；图3为质量评估网络的训练示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。请参阅图1，本发明第一实施例提供了一种基于对比学习的康复运动质量评估系统，其包括：三元组样本生成单元110，用于获取受试者的骨架序列集，并根据所述骨架序列集生成三元组样本；其中，所述三元组样本包括一个正样本、一个负样本以及一个anchor样本。具体地，在本实施例中，将受试者的骨架序列集的所有正常的样本作为正样本，所有不正常样本作为负样本。而对于anchor样本，一般选择为在正样本中选择每个受试者的随机一次重复。特别的，本实施例选择每个受试者的第一次重复作为anchor样本。在本实施例中，骨架序列集一般需要分为训练集以及测试集，其中，本实施例提供如下两种不同的划分方式：1、将构建的三元组样本来划分训练接和测试集；2、根据运动样本的受试者来划分训练集和测试集。特征提取单元120，用于将所述三元组样本输入至特征提取网络中进行特征提取，以获得各个样本的特征；其中，特征提取网络采用多个输入使用权重共享的骨干网络。如图2所示，在本实施例中，为了提取到正样本和负样本之间更具有区分性的特征，本实施例使用的特征提取网络利用了对比学习的概念，即多个输入使用权重共享的骨干网络。骨干网络采用的是增强自适应图卷积网络来从人体运动动态变化的骨架数据表征，以及从整体身体形态和关节间的时间关系中提取更丰富的运动特征。具体地，设给定的三元组样本包括anchor样本、正样本/＞以及负样本/＞；将anchor样本、正样本/＞以及负样本/＞作为输入，经过权重共享的特征提取网络以提取对应的特征/＞、/＞、/＞；其中，特征提取的目标用如下公示表示：=/＞,/＞,/＞这里，函数F表示将构建的三元组样本编码到一定的特征空间，参数设置为w；损失函数Loss用于衡量正样本、负样本与anchor样本之间的距离；损失函数Loss的定义如下：其中，表示正样本和负样本之间的界限。分数生成单元130，用于对提取到的各个样本的特征，使用高斯混合模型进行性能度量和分数映射，得到各个样本的分数。在本实施例中，使用高斯混合模型来量化运动的表现。首先，根据提取的所有正样本的特征初始化高斯混合模型的参数，以构造运动的统一标准；/＞在带有/＞个高斯分量的高斯混合模型发生的概率表示如下：其中，N表示高斯混合函数，为高斯参数集合，/＞={/＞}，分别表示第/＞个高斯分量的混合系数、均值和协方差；然后，将提取的每个样本的特征，计算其在高斯混合模型下的负对数似然，以得到样本动作的量化分数，具体的映射公式如下所示：最后，对于量化后的正样本分数集合P=，和负样本分数集合N=，采用如下的公式将量化分数映射为0～1区间，以获得各个正样本的最终分数/＞和负样本的最终分数/＞：其中，是数据特定的参数。质量评估网络训练单元140，用于将生成的分数作为对应的样本的标签，重新采样生成用于质量评估的训练样本对，将训练样本对输入至质量评估网络中，对所述质量评估网络进行训练；其中，在质量评估网络的质量评价任务中，使用排列组合的方式在训练集中构建训练样本，然后通过特征提取网络来提取不同样本的特征，并且在该训练中将不同样本关节注意力矩阵和特征的差距进行量化，使得分数差距较小的样本关节注意力矩阵和特征的差异也较小，分数差距较大的样本两者的差距也较大。其中，如图3所示，针对康复运动质量的有效性评估问题，为了更加准确有效地给患者反馈，本实施例的质量评估网络使用了对比学习的质量回归模型。首先，在所提出的质量回归模型中，采用两两学习策略来进行训练。具体来说，从原始的骨架序列集中选择一对带分数标签的骨架序列＜/＞,/＞＞作为样本对输入到特征提取网络中。设训练集中骨架序列样本的总数为N，则训练样本对的总数可以达到/＞。然后，本实施例构造了两个和上述相同的特征提取网络来分别提取训练样本对的两个样本的特征＜,/＞＞。其中，所述特征提取网络包括十层相互叠加的时空卷积块，采用权值共享策略训练特征提取网络，以提取不同层次特征表示，从局部上下文到高级动作模型，使用样本对进行训练可以更好的估计患者的康复状况。具体地，第层的时空卷积块表示为：其中，表示从全局角度学习的关节连接的拓扑结构，/＞表示根据样本生成的相邻矩阵，/＞、/＞分别表示第/＞层的输入和输出，/＞表示该层可训练的权重，/＞设为3，表示自环，向心，远心三个不同的图拓扑连接；从两个角度组合邻接矩阵，则定义关节注意力矩阵为:在本实施例中，可通过取特征提取网络的最后一层的关节注意力矩阵来解决运动缺陷缺乏反馈的问题。通过比较关节注意力矩阵和专家矩阵来指导患者对身体关节部分的关注。在本实施例中，在对质量评估网络进行训练时，制定了三个约束条件，并相应地设计了三个损失函数。因为对于现在大多数的方法仅仅考虑真实分数与预测分数之间的偏差，但这是不够的，捕获不同特征表示和关节注意权重的差异是至关重要的。第一个约束使用Huber损失函数测量预测分数和真实分数的偏差，分数损失的定义如下所示：=/＞表示分数误差损失，用于测量从给定骨架序列预测的分数与真实值的误差。/＞表示第/＞个样本的真实分数值，/＞表示第/＞个样本的分数预测值，/＞表示预测的误差阈值。其次，基于成对训练策略，本实施例提出了第二个约束，旨在减少得分相似的骨架序列之间的特征距离，而增加得分差异较大的骨架序列之间的特征距离。用于度量特征相似度的损失函数公式如下:表示特征相似度损失，/＞为输入成对骨架序列＜/＞＞的真实值，/＞为通过特征提取网络提取的输入样本的特征表示，/＞表示余弦相似度；/＞表示特征量化公式，被计算通过/＞,其中/＞表示训练数据中的最高分。第三个约束为一致性约束，旨在最小化得分相似的骨架序列之间的关节注意权重的偏差，这可以保证为运动表现提升提供有用的反馈。表示关节注意力权重的损失，/＞为输入成对骨架序列＜/＞＞的真实值，表示输入成对样本＜/＞＞对应的关节关节注意力矩阵，/＞和/＞与第二个约束损失中的计算方式一致。综上，本实施例提出的质量评估网络的总体损失函数总结如下：=/＞+/＞+/＞利用成对的训练样本对之间的分数差异和训练样本对中样本真实分数标签的差异来对质量评估网络进行训练。通过比较患者样本与专家样本的关节注意力矩阵的差异来使得患者更关注于哪部分关节的学习和锻炼。质量评估单元150，用于基于训练得到的所述质量评估网络对采集的用户的骨架序列进行质量评估，获得预测分数。在本实施例中，在实际使用时，可以通过传感器系统采集患者执行康复运动的运动图像，然后根据运行图像来生成骨架序列，将所述骨架序列输入至训练好的质量回归模型的单个分支中，就可以得到对该康复运动的分数预测和关节注意力矩阵。具体的公式如下：,M =/＞)。综上所述，本实施例具有如下优点：1）针对康复训练中缺少连续分数标签的问题，利用对比学习的思想，使用来自同一练习的正样本、负样本以及anchor样本组成的三元组样本来训练特征提取网络，使特征提取网络能提取出样本更具代表性的特征，从而得到的分数可以更好的表示不同质量的运动，解决了康复运动中缺乏专家评分标签的问题；2）通过关节注意力矩阵区分不同关节对体育锻炼的重要性。此外，定义了不同样本骨骼间关节注意力矩阵的偏差损失，并将其与评分预测损失相结合，增强了网络对特征的学习能力。在本发明各个实施例中的各功能模块可以集成在一起形成一个独立的部分，也可以是各个模块单独存在，也可以两个或两个以上模块集成形成一个独立的部分。所述功能如果以软件功能模块的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
