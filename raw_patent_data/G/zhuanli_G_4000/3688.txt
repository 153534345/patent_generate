标题title
图像补全方法、装置、计算机设备和存储介质
摘要abst
本申请涉及一种图像补全方法、装置、计算机设备和存储介质。该方法包括：对待补全的第一图像进行直线提取处理，得到直线信息；第一图像中包括缺失图像内容的缺失区域；基于直线信息对缺失区域进行分块，得到多个子缺失区域；按照子缺失区域的数量对第一图像进行多次加噪，得到符合数量的、且高斯噪声不同的高斯噪声图；针对每个子缺失区域，从符合数量的高斯噪声图中选取目标高斯噪声图，并从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图；将各子缺失区域的噪声图和第一图像合并，得到初步补全图像；对初步补全图像进行降噪处理，得到目标图像。采用本方法生成的补全的图像内容更加准确。
权利要求书clms
1.一种图像补全方法，其特征在于，所述方法包括：对待补全的第一图像进行直线提取处理，得到直线信息；所述第一图像中包括缺失图像内容的缺失区域；基于所述直线信息对所述缺失区域进行分块，得到多个子缺失区域；按照所述子缺失区域的数量对所述第一图像进行多次加噪，得到符合所述数量的高斯噪声图；每个所述高斯噪声图中的高斯噪声不同；针对每个所述子缺失区域，从所述符合所述数量的高斯噪声图中选取目标高斯噪声图，并从所述目标高斯噪声图中提取与所述子缺失区域对应的图像内容，得到所述子缺失区域的噪声图；将各所述子缺失区域的噪声图和所述第一图像合并，得到初步补全图像；对所述初步补全图像进行降噪处理，得到目标图像。2.根据权利要求1所述的方法，其特征在于，所述第一图像中包括具备图像内容的已知区域；所述直线信息包括全局直线；所述全局直线是贯穿所述第一图像中的缺失区域的直线；所述对待补全的第一图像进行直线提取处理，得到直线信息，包括：对待补全的第一图像中的已知区域进行直线提取处理，得到所述已知区域中的局部直线；对各所述局部直线进行聚类处理，将聚为一类的各所述局部直线进行融合，得到多条候选直线；从所述多条候选直线中选取所述全局直线。3.根据权利要求2所述的方法，其特征在于，所述基于所述直线信息对所述缺失区域进行分块，得到多个子缺失区域，包括：基于提取的所述全局直线形成二值图像，得到直线二值图像；所述直线二值图像中直线区域像素值与非直线区域像素值不同；将所述直线二值图像和所述缺失区域进行相与操作，以对所述缺失区域进行分块得到多个子缺失区域。4.根据权利要求3所述的方法，其特征在于，所述将所述直线二值图像和所述缺失区域进行相与操作，以对所述缺失区域进行分块得到多个子缺失区域，包括：在所述缺失区域处于所述第一图像的图像边缘的情况下，提取所述第一图像的边缘特征；将所述直线二值图像和所述缺失区域进行相与操作，以对所述缺失区域进行划分，得到位于所述图像边缘的非闭合的缺失子区域和位于非图像边缘的闭合的缺失子区域；基于所述边缘特征对所述非闭合的缺失子区域添加相应的图像边缘，得到位于所述图像边缘的闭合的缺失子区域。5.根据权利要求1所述的方法，其特征在于，所述方法还包括：确定所述第一图像的初始掩膜；对所述初始掩膜进行取反操作，得到所述缺失区域的掩膜；基于所述直线信息对所述缺失区域的掩膜进行分块，得到各所述子缺失区域的掩膜；所述从所述目标高斯噪声图中提取与所述子缺失区域对应的图像内容，得到所述子缺失区域的噪声图，包括：根据所述子缺失区域的掩膜从所述目标高斯噪声图中提取所述子缺失区域对应的图像内容，得到所述子缺失区域的噪声图。6.根据权利要求1所述的方法，其特征在于，所述对所述初步补全图像进行降噪处理，得到目标图像，包括：将所述初步补全图像作为当前补全图像，对所述当前补全图像进行降噪处理，得到进阶补全图像；将所述进阶补全图像作为所述当前补全图像，返回执行所述对所述当前补全图像进行降噪处理，得到进阶补全图像的步骤以进行迭代降噪，直到迭代停止，将迭代停止后的进阶补全图像作为目标图像。7.根据权利要求1至6中任一项所述的方法，其特征在于，所述目标图像是通过已训练的图像生成模型对所述初步补全图像进行降噪处理得到的；所述已训练的图像生成模型是使用不同场景下、且包含不同建筑纹理的目标建筑图像集进行训练得到的；所述目标建筑图像集中的目标建筑图像是对原始建筑图像进行预处理的步骤得到的；所述对原始建筑图像进行预处理的步骤包括：对原始建筑图像进行投影摆正，得到所述原始建筑图像的投影摆正图像；对所述投影摆正图像进行裁剪处理，得到满足预设分辨率条件的裁剪图像；从各所述裁剪图像中确定满足建筑纹理语义的目标裁剪图像，并将所述目标裁剪图像作为目标建筑图像。8.一种图像补全装置，其特征在于，所述装置包括：直线提取模块，用于对待补全的第一图像进行直线提取处理，得到直线信息；所述第一图像中包括缺失图像内容的缺失区域；基于所述直线信息对所述缺失区域进行分块，得到多个子缺失区域；加噪模块，用于按照所述子缺失区域的数量对所述第一图像进行多次加噪，得到符合所述数量的高斯噪声图；每个所述高斯噪声图中的高斯噪声不同；合并模块，用于针对每个所述子缺失区域，从所述符合所述数量的高斯噪声图中选取目标高斯噪声图，并从所述目标高斯噪声图中提取与所述子缺失区域对应的图像内容，得到所述子缺失区域的噪声图；将各所述子缺失区域的噪声图和所述第一图像合并，得到初步补全图像；降噪模块，用于对所述初步补全图像进行降噪处理，得到目标图像。9.一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至7中任一项所述的方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1至7中任一项所述的方法的步骤。
说明书desc
技术领域本申请涉及图像技术领域，特别是涉及一种图像补全方法、装置、计算机设备和存储介质。背景技术由于各种原因，图像中的部分区域存在图像内容缺失的情况，进而影响图像的视觉效果。传统方法中提出块复制的思想，对图像中缺失的图像内容进行补全。具体地，在缺失图像内容的缺失区域的周围，依照最邻近原则，快速的去搜索与缺失的图像内容相似的图像块，将搜索到的图像块的图像内容复制到缺失区域。然而，利用传统方法所补全的缺失区域的图像内容不够准确，与缺失区域实际所丢失的图像内容相差较大，导致补全后的图像具有较大的视觉偏差。发明内容基于此，有必要针对上述技术问题，提供一种能够得到准确的补全的图像内容的图像补全方法、装置、计算机设备、计算机可读存储介质和计算机程序产品。第一方面，本申请提供了一种图像补全方法，方法包括：对待补全的第一图像进行直线提取处理，得到直线信息；第一图像中包括缺失图像内容的缺失区域；基于直线信息对缺失区域进行分块，得到多个子缺失区域；按照子缺失区域的数量对第一图像进行多次加噪，得到符合数量的高斯噪声图；每个高斯噪声图中的高斯噪声不同；针对每个子缺失区域，从符合数量的高斯噪声图中选取目标高斯噪声图，并从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图；将各子缺失区域的噪声图和第一图像合并，得到初步补全图像；对初步补全图像进行降噪处理，得到目标图像。在一些实施例中，第一图像中包括具备图像内容的已知区域；直线信息包括全局直线；全局直线是贯穿第一图像中的缺失区域的直线；对待补全的第一图像进行直线提取处理，得到直线信息，包括：对待补全的第一图像中的已知区域进行直线提取处理，得到已知区域中的局部直线；对各局部直线进行聚类处理，将聚为一类的各局部直线进行融合，得到多条候选直线；从多条候选直线中选取全局直线。在一些实施例中，基于直线信息对缺失区域进行分块，得到多个子缺失区域，包括：基于提取的全局直线形成二值图像，得到直线二值图像；直线二值图像中直线区域像素值与非直线区域像素值不同；将直线二值图像和缺失区域进行相与操作，以对缺失区域进行分块得到多个子缺失区域。在一些实施例中，将直线二值图像和缺失区域进行相与操作，以对缺失区域进行分块得到多个子缺失区域，包括：在缺失区域处于第一图像的图像边缘的情况下，提取第一图像的边缘特征；将直线二值图像和缺失区域进行相与操作，以对缺失区域进行划分，得到位于图像边缘的非闭合的缺失子区域和位于非图像边缘的闭合的缺失子区域；基于边缘特征对非闭合的缺失子区域添加相应的图像边缘，得到位于图像边缘的闭合的缺失子区域。在一些实施例中，方法还包括：确定第一图像的初始掩膜；对初始掩膜进行取反操作，得到缺失区域的掩膜；基于直线信息对缺失区域的掩膜进行分块，得到各子缺失区域的掩膜；从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图，包括：根据子缺失区域的掩膜从目标高斯噪声图中提取子缺失区域对应的图像内容，得到子缺失区域的噪声图。在一些实施例中，对初步补全图像进行降噪处理，得到目标图像，包括：将初步补全图像作为当前补全图像，对当前补全图像进行降噪处理，得到进阶补全图像；将进阶补全图像作为当前补全图像，返回执行对当前补全图像进行降噪处理，得到进阶补全图像的步骤以进行迭代降噪，直到迭代停止，将迭代停止后的进阶补全图像作为目标图像。在一些实施例中，目标图像是通过已训练的图像生成模型对初步补全图像进行降噪处理得到的；已训练的图像生成模型是使用不同场景下、且包含不同建筑纹理的目标建筑图像集进行训练得到的；目标建筑图像集中的目标建筑图像是对原始建筑图像进行预处理的步骤得到的；对原始建筑图像进行预处理的步骤包括：对原始建筑图像进行投影摆正，得到原始建筑图像的摆正图像；对投影摆正图像进行裁剪处理，得到满足预设分辨率条件的裁剪图像；从各裁剪图像中确定满足建筑纹理语义的目标裁剪图像，并将目标裁剪图像作为目标建筑图像。第二方面，本申请还提供了一种图像补全装置，该装置包括：直线提取模块，用于对待补全的第一图像进行直线提取处理，得到直线信息；第一图像中包括缺失图像内容的缺失区域；基于直线信息对缺失区域进行分块，得到多个子缺失区域；加噪模块，用于按照子缺失区域的数量对第一图像进行多次加噪，得到符合数量的高斯噪声图；每个高斯噪声图中的高斯噪声不同；合并模块，用于针对每个子缺失区域，从符合数量的高斯噪声图中选取目标高斯噪声图，并从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图；将各子缺失区域的噪声图和第一图像合并，得到初步补全图像；降噪模块，用于对初步补全图像进行降噪处理，得到目标图像。第三方面，本申请还提供了一种计算机设备。该计算机设备包括存储器和处理器，该存储器存储有计算机程序，该处理器执行该计算机程序时实现上述的方法的步骤。第四方面，本申请还提供了一种计算机可读存储介质。该计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现上述的方法的步骤。第五方面，本申请还提供了一种计算机程序产品。该计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现上述的方法的步骤。上述图像补全方法、装置、计算机设备和存储介质，通过从待补全的第一图像中提取的直线信息，对第一图像的缺失区域进行分块，并对分块得到的各子缺失区域进行多次加噪，得到符合子缺失区域数量的高斯噪声图，并从符合数量的高斯噪声图中选取目标高斯噪声图，以及从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图，将各子缺失区域的噪声图和第一图像合并，得到初步补全图像，对初步补全图像进行降噪处理，得到目标图像，由于利用直线信息对缺失区域进行分块，并针对不同的子缺失区域添加不同的高斯噪声，得到不同的子缺失区域的噪声图，因此对初步补全图像进行降噪处理得到目标图像的过程中，针对各子缺失区域，会生成与各子缺失区域大小匹配的补全的图像内容，避免出现过拟合的现象，使得生成的补全的图像内容更加准确，从而减小了补全的图像内容与缺失区域实际丢失的图像内容之间的差异，使得到的目标图像具有更好的视觉效果。附图说明图1为一个实施例中图像补全方法的流程示意图；图2为另一个实施例中图像补全方法的流程示意图；图3为另一个实施例中图像补全方法的流程示意图；图4为一个实施例中图像补全装置的结构框图；图5为一个实施例中直线提取模块的结构框图；图6为一个实施例中计算机设备的内部结构图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。可以理解，在很多应用场景中，需要用到具备完整图像内容的图像以满足特定的需求，然而由于各种原因，导致图像中的部分区域存在图像内容缺失的情况，进而无法满足特定的需求。例如，在对建筑物进行三维重建时，需要将从不同视角对建筑物拍摄得到的图像中的建筑纹理映射到三维建筑模型上，以得到带有建筑纹理的三维建筑模型，然而由于从不同视角对建筑物进行拍摄时，会受到遮挡、光照或位置的影响，因此拍摄得到的图像中常常存在建筑纹理缺失的情况，导致三维建筑模型的建筑纹理不完整。因此，需要对缺失图像内容的图像进行图像补全。在一个实施例中，如图1所示，提供了一种图像补全方法，以该方法应用于计算机设备为例进行说明，包括以下步骤：步骤101、对待补全的第一图像进行直线提取处理，得到直线信息；第一图像中包括缺失图像内容的缺失区域。其中，待补全的第一图像中包括缺失图像内容的缺失区域和具备图像内容的已知区域。直线信息是待补全的第一图像中的特征直线，根据特征直线的长度将特征直线分为全局直线和局部直线，即直线信息包括全局直线和局部直线。全局直线是贯穿第一图像中的缺失区域的直线。贯穿包括横贯、纵贯或斜贯，因此全局直线是指横贯第一图像中的缺失区域的直线、纵观第一图像中的缺失区域的直线或斜贯第一图像中的缺失区域的直线中的任意一种。示例性地，计算机设备对待补全的第一图像中的已知区域进行直线提取处理，得到待补全的第一图像中的直线信息。在一些实施例中，对待补全的第一图像进行直线提取处理，得到直线信息的步骤包括：计算待补全的第一图像的梯度场，根据梯度场确定直线信息。步骤102、基于直线信息对缺失区域进行分块，得到多个子缺失区域。示例性地，计算机设备基于全局直线对缺失区域进行分块，得到多个子缺失区域，即通过贯穿第一图像中的缺失区域的直线，将缺失区域进行划分，得到多个子缺失区域。在一些实施例中，在缺失区域处于第一图像的图像边缘的情况下，基于全局直线和第一图像的边缘特征，对缺失区域进行分块，得到多个子缺失区域。步骤103、按照子缺失区域的数量对第一图像进行多次加噪，得到符合数量的高斯噪声图；每个高斯噪声图中的高斯噪声不同。示例性地，计算机设备确定子缺失区域的数量，并按照子缺失区域的数量对第一图像进行多次加噪，即在第一图像的基础上，分别对第一图像添加不同的高斯噪声，每当对第一图像进行加噪时，都会生成一个高斯噪声图。因此对第一图像进行多次加噪会得到符合数量的高斯噪声图，即高斯噪声图的数量与子缺失区域的数量一致。为了便于理解，举例说明按照子缺失区域的数量对第一图像进行多次加噪，得到符合数量的高斯噪声图的过程。例如，子缺失区域的数量是3，则分别给第一图像添加3种不同的高斯噪声A、高斯噪声B和高斯噪声C，得到3种高斯噪声图，即在第一次加噪时，给第一图像添加高斯噪声A；在第二次加噪时，给第一图像添加高斯噪声B；在第三次加噪时，给第一图像添加高斯噪声B。可以理解，每次对第一图像加噪时，从3种高斯噪声中选择一种高斯噪声，并且每次选择的高斯噪声是各不相同的。此外，添加高斯噪声的顺序可以是预设的，例如依次添加高斯噪声A、高斯噪声B和高斯噪声C，也可以是随机的，本实施例在此不做限定。步骤104、针对每个子缺失区域，从符合数量的高斯噪声图中选取目标高斯噪声图，并从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图。其中，目标高斯噪声图是提供子缺失区域对应的图像内容的高斯噪声图。可以理解，由于是将提取的目标高斯噪声图中的高斯噪声作为子缺失区域对应的图像内容，因此需要从符合数量的高斯噪声图中确定子缺失区域对应的目标高斯噪声图。示例性地，计算机设备针对每个子缺失区域，从符合数量的高斯噪声图中选取能提供子缺失区域对应的图像内容的目标高斯噪声图，并根据子缺失区域的掩膜从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图。在一些实施例中，针对每个子缺失区域，从符合数量的高斯噪声图中选取目标高斯噪声图的步骤包括：针对每个子缺失区域，从符合数量的高斯噪声图中随机选取目标高斯噪声图。在一些实施例中，针对每个子缺失区域，从符合数量的高斯噪声图中选取目标高斯噪声图的步骤包括：针对每个子缺失区域，从符合数量的高斯噪声图中添加高斯噪声的顺序选取目标高斯噪声图。即，按添加高斯噪声的顺序，将得到的高斯噪声图依次分给各子缺失区域。步骤105、将各子缺失区域的噪声图和第一图像合并，得到初步补全图像。示例性地，计算机设备将各子缺失区域的噪声图和第一图像合并，即将各子缺失区域的噪声图作为第一图像中的缺失区域的图像内容，以将第一图像进行初步补全，得到初步补全图像。在一些实施例中，在得到符合数量的高斯噪声图的步骤之后，对各高斯噪声图进行降噪。将各子缺失区域的噪声图和第一图像合并之前，会对第一图像进行加噪。因此，将各子缺失区域的噪声图和第一图像合并时，是将降噪后的各子缺失区域的噪声图和加噪后的第一图像进行合并。可以理解，初步补全图像是对待补全的第一图像进行首次补全时得到的图像，因此无论是将各子缺失区域的噪声图和第一图像合并得到的图像，还是将降噪后的各子缺失区域的噪声图和加噪后的第一图像合并得到的图像均可以称为初步补全图像。可以理解，通过对各高斯噪声图进行降噪和对第一图像进行加噪，可以减小第一图像的缺失区域与已知区域之间的图像内容差异，从而对初步补全图像进行降噪处理时，可以减小降噪处理所需时间，加快得到目标图像的速度。步骤106、对初步补全图像进行降噪处理，得到目标图像。其中，目标图像是缺失区域中的图像内容已补全、且缺失区域中的图像内容与已知区域的图像内容具有语义一致性和几何一致性的图像。可以理解，语义一致性是指补全的图像内容与已知区域的图像内容的属性一致，也就是说补全的图像内容与已知区域的图像内容属于同一目标对象。例如，已知区域的图像内容是建筑纹理，而补全的图像内容为草坪纹理，则表明补全的图像内容与已知区域的图像内容不具有语义一致性；又例如，已知区域的图像内容是建筑纹理，而补全的图像内容为建筑纹理，则表明补全的图像内容与已知区域的图像内容具有语义一致性。几何一致性是指补全的图像内容与已知区域的图像内容在几何层面上保持一致。当补全的图像内容与已知区域的图像内容具有语义一致性和几何一致性，表明补全的图像内容准确。示例性地，计算机设备对初步补全图像进行降噪处理，以去除初步补全图像中的噪声，得到目标图像。在一些实施例中，对初步补全图像进行降噪处理之前，对初步补全图像进行重采样，得到重采样后的初步补全图像，再对重采样后的初步补全图像进行降噪处理，得到目标图像。可以理解，对初步补全图像进行降噪处理前，进行重采样，可以减小降噪处理所需时间，加快得到目标图像的速度。上述实施例中，由于利用直线信息对缺失区域进行分块，并针对不同的子缺失区域添加不同的高斯噪声，得到不同的子缺失区域的噪声图，因此对初步补全图像进行降噪处理得到目标图像的过程中，针对各子缺失区域，会生成与各子缺失区域大小匹配的补全的图像内容，避免出现过拟合的现象，使得生成的补全的图像内容更加准确，从而减小了补全的图像内容与缺失区域实际丢失的图像内容之间的差异，使得到的目标图像具有更好的视觉效果。在一些实施例中，第一图像中包括具备图像内容的已知区域；直线信息包括全局直线；全局直线是贯穿第一图像中的缺失区域的直线；对待补全的第一图像进行直线提取处理，得到直线信息的步骤，包括：对待补全的第一图像中的已知区域进行直线提取处理，得到已知区域中的局部直线；对各局部直线进行聚类处理，将聚为一类的各局部直线进行融合，得到多条候选直线；从多条候选直线中选取全局直线。其中，局部直线是已知区域中的特征直线。相较于全局直线，局部直线的长度较短。候选直线是贯穿第一图像的直线。可以理解，第一图像包括缺失图像内容的缺失区域和具备图像内容的已知区域，因此候选直线包括贯穿第一图像中的缺失区域的直线和贯穿第一图像中的已知区域的直线。示例性地，计算机设备对待补全的第一图像中的已知区域进行直线提取处理，得到第一图像中的已知区域的局部直线；将聚为一类的各局部直线进行融合，得到多条候选直线，即得到贯穿第一图像中的缺失区域的直线和贯穿第一图像中的已知区域的直线；从多条候选直线中选取全局直线，即从多条候选直线中，选取贯穿第一图像中的缺失区域的直线。上述实施例中，通过提取待补全的第一图像中的已知区域的局部直线，并对局部直线进行聚类和融合，得到多条候选直线，并从多条候选直线中确定贯穿第一图像的缺失区域的全局直线，以通过全局直线对缺失区域进行分块。在一些实施例中，基于直线信息对缺失区域进行分块，得到多个子缺失区域的步骤，包括：基于提取的全局直线形成二值图像，得到直线二值图像；直线二值图像中直线区域像素值与非直线区域像素值不同；将直线二值图像和缺失区域进行相与操作，以对缺失区域进行分块得到多个子缺失区域。示例性地，计算机设备基于提取的全局直线形成二值图像，得到直线区域像素值与非直线区域像素值不同的直线二值图像，即非直线区域的像素值为0，直线区域的像素值为1；或者是非直线区域的像素值为1，直线区域的像素值为0。将直线二值图像和缺失区域进行相与操作，以对缺失区域进行分块得到多个子缺失区域，即进行相与操作后，非直线区域对应的每个区域为子缺失区域。上述实施中，将全局直线的直线二值图像与缺失区域进行相与操作，以对缺失区域进行分块得到多个子缺失区域，因此对初步补全图像进行降噪处理得到目标图像的过程中，针对各子缺失区域，会生成与各子缺失区域大小匹配的补全的图像内容，避免出现过拟合的现象，使得生成的补全的图像内容更加准确。在一些实施例中，将直线二值图像和缺失区域进行相与操作，以对缺失区域进行分块得到多个子缺失区域的步骤，包括：在缺失区域处于第一图像的图像边缘的情况下，提取第一图像的边缘特征；将直线二值图像和缺失区域进行相与操作，以对缺失区域进行划分，得到位于图像边缘的非闭合的缺失子区域和位于非图像边缘的闭合的缺失子区域；基于边缘特征对非闭合的缺失子区域添加相应的图像边缘，得到位于图像边缘的闭合的缺失子区域。其中，边缘特征是指缺失区域处于第一图像的图像边缘时，缺失区域的边缘特征。可以理解，由于直线提取只能提取位于第一图像中的已知区域的直线，因此在缺失区域处于第一图像的图像边缘的情况下，即第一图像的图像边缘缺失图像内容，对缺失区域进行划分会得到位于图像边缘的非闭合的缺失子区域和位于非图像边缘的闭合的缺失子区域。因而需要基于边缘特征对非闭合的缺失子区域添加相应的图像边缘，得到位于图像边缘的闭合的缺失子区域。也就是说，各缺失子区域包括位于非图像边缘的闭合的缺失子区域和位于图像边缘的闭合的缺失子区域。上述实施例中，在缺失区域处于第一图像的图像边缘的情况下，基于边缘特征对非闭合的缺失子区域添加相应的图像边缘，得到位于图像边缘的闭合的缺失子区域，使得到的各缺失子区域都是闭合的，因此对初步补全图像进行降噪处理得到目标图像的过程中，针对各子缺失区域，才会生成与各子缺失区域大小匹配的补全的图像内容，避免出现过拟合的现象，使得生成的补全的图像内容更加准确。在一些实施例中，方法还包括：确定第一图像的初始掩膜；对初始掩膜进行取反操作，得到缺失区域的掩膜；基于直线信息对缺失区域的掩膜进行分块，得到各子缺失区域的掩膜；从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图的步骤，包括：根据子缺失区域的掩膜从目标高斯噪声图中提取子缺失区域对应的图像内容，得到子缺失区域的噪声图。其中，初始掩膜是第一图像的掩膜。可以理解，初始掩膜是指第一图像的已知区域中的像素为白色，缺失区域中的像素为黑色的二值图像。因此，对初始掩膜进行取反操作，即将第一图像的已知区域中的像素由白色变为黑色，将第一图像的缺失区域中的像素由黑色变为白色，就得到缺失区域的掩膜。也就是说，缺失区域的掩膜是指第一图像的已知区域中的像素为黑色，缺失区域中的像素为白色的二值图像。示例性地，计算机设备确定第一图像的初始掩膜，对初始掩膜进行取反操作，得到缺失区域的掩膜；基于全局直线对缺失区域的掩膜进行分块，得到各子缺失区域的掩膜；根据子缺失区域的掩膜从目标高斯噪声图中提取子缺失区域对应的图像内容，即将子缺失区域的掩膜与目标高斯高声图相乘，提取目标高斯噪声图中的高斯噪声，并将提取的目标高斯噪声图中的高斯噪声作为子缺失区域对应的图像内容，得到子缺失区域的噪声图。上述实施例中，通过对第一图像的初始掩膜进行取反操作得到缺失区域的掩膜，基于全局直线对缺失区域的掩膜进行分块，得到子缺失区域的掩膜，并根据子缺失区域的掩膜从目标高斯噪声图中提取子缺失区域对应的图像内容，得到子缺失区域的噪声图，以通过子缺失区域的噪声图对待补全的第一图像进行初步补全，得到初步补全图像。在一些实施例中，对初步补全图像进行降噪处理，得到目标图像，包括：将初步补全图像作为当前补全图像，对当前补全图像进行降噪处理，得到进阶补全图像；将进阶补全图像作为当前补全图像，返回执行对当前补全图像进行降噪处理，得到进阶补全图像的步骤以进行迭代降噪，直到迭代停止，将迭代停止后的进阶补全图像作为目标图像。上述实施例中，通过对初步补全图像进行迭代降噪处理，使得生成的补全的图像内容更加准确，减小了补全的图像内容与缺失区域实际丢失的图像内容之间的差异，从而使得到的目标图像具有更好的视觉效果。在一些实施例中，目标图像是通过已训练的图像生成模型对初步补全图像进行降噪处理得到的；已训练的图像生成模型是使用不同场景下、且包含不同建筑纹理的目标建筑图像集进行训练得到的；目标建筑图像集中的目标建筑图像是对原始建筑图像进行预处理的步骤得到的；对原始建筑图像进行预处理的步骤包括：对原始建筑图像进行投影摆正，得到原始建筑图像的投影摆正图像；对投影摆正图像进行裁剪处理，得到满足预设分辨率条件的裁剪图像；从各裁剪图像中确定满足建筑纹理语义的目标裁剪图像，并将目标裁剪图像作为目标建筑图像。其中，已训练的图像生成模型是对初步补全图像进行降噪处理，得到目标图像的模型，即已训练的图像生成模型通过对初步补全图像进行降噪处理，以补全缺失的图像内容，使得补全的图像内容与已知区域的图像内容具有语义一致性和几何一致性。可以理解，在使用图像生成模型对初步补全图像进行降噪处理前，需要用训练样本图像对未训练的图像生成模型进行训练。根据使用已训练的图像生成模型的应用场景的不同，需要使用不同的训练样本图像对未训练的图像生成模型进行训练。举例而言，当应用场景是补全建筑图像的图像内容时，训练样本图像为不同场景下、且包含不同建筑纹理的目标建筑图像集。目标建筑图像是对原始建筑图像进行预处理得到的，因而原始建筑是从不同场景下拍摄得到、且包含不同建筑纹理的图像。不同场景是指原始建筑图像的多个拍摄场景，包括学校、公寓或企业等场景，即原始建筑图像是对学校、公寓或企业等场景中的建筑物进行拍摄得到的。为了保证训练的有效性，需要对原始建筑图像进行预处理，得到目标建筑图像。可以理解，由于拍摄原始建筑图像时，可能存在角度斜拍的问题，得到的原始建筑图像中的建筑图像是斜的，因此计算机设备对原始建筑图像进行投影摆正，即将原始建筑图像中的建筑图像进行投影摆正处理，得到投影摆正图像。为了减小投影摆正图像的分辨率的损失，计算机设备对投影摆正图像进行裁剪处理，得到满足预设分辨率条件的裁剪图像，并删除裁剪图像中的模糊的裁剪图像。紧接着，计算机设备从各裁剪图像中确定满足建筑纹理语义的目标裁剪图像，即对各裁剪图像进行语义分割，确定各裁剪图像中包含大量建筑纹理的目标裁剪图像，并将目标裁剪图像作为目标建筑图像。也就是说，目标建筑图像是对原始建筑图像进行投影摆正、裁剪和语义分割这一系列预处理得到的。上述实施例中，由于目标建筑图像集中的目标建筑图像是对原始建筑图像进行投影摆正、裁剪和语义分割这一系列预处理得到的，因此目标建筑图像中保留了建筑纹理的特点，使用目标建筑图像集训练得到的已训练的图像生成模型生成的补全的图像内容更符合建筑纹理的特征，具有更好的语义一致性和几何一致性，即补全的图像内容更加准确，从而能减小补全的图像内容与缺失区域实际丢失的图像内容之间的差异，使得到的目标图像具有更好的视觉效果。在一些实施例中，如图2所示，提供了另一种图像补全方法的流程示意图，为了便于理解，现针对图2做如下说明，其中：步骤201、输入待补全的第一图像。步骤202、直线提取。即对待补全的第一图像进行直线提取处理，得到贯穿第一图像中的缺失区域的全局直线。在一些实施例中，基于全局直线对缺失区域进行分块，得到多个子缺失区域。步骤203、掩膜分块。即基于全局直线对缺失区域的掩膜进行分块，得到各子缺失区域的掩膜。步骤204、图像补全。即将各子缺失区域的噪声图和第一图像合并，得到初步补全图像。其中，子缺失区域的噪声图是根据子缺失区域的掩膜，从目标高斯噪声图中提取的子缺失区域对应的图像内容。目标高斯噪声图是按照子缺失区域的数量对第一图像进行多次加噪时，得到的符合数量的高斯噪声图中的一个。步骤205、生成目标图像。即对初步补全图像进行降噪处理，得到目标图像。在一些实施例中，如图3所示，提供了另一种图像补全方法的流程示意图，以该方法应用于计算机设备，且以已训练的图像生成模型是已训练的扩散模型为例进行说明，具体包括以下步骤：1、对输入的待补全的第一图像301进行加噪，得到加噪后的第一图像302。其中，待补全的第一图像301中包括缺失图像内容的缺失区域和具备图像内容的已知区域。2、将加噪后的第一图像302与第一图像的初始掩膜303进行相与操作，得到对已知区域进行加噪后的图像304。在一些实施例中，基于全局直线对缺失区域进行分块，得到多个子缺失区域。在一些实施例中，在缺失区域处于第一图像的图像边缘的情况下，基于全局直线和边缘特征对缺失区域进行分块，得到多个子缺失区域。3、按照子缺失区域的数量对第一图像301进行多次加噪，得到符合数量的高斯噪声图305。其中，每个高斯噪声图中的高斯噪声不同。4、对各高斯噪声图305进行降噪，得到降噪后的各高斯噪声图306。5、分别将降噪后的各高斯噪声图306与各子缺失区域的掩膜307进行相与操作，得到降噪后的各子缺失区域的噪声图308。由图3可知，得到各子缺失区域的掩膜307的步骤包括：对第一图像的初始掩膜303进行取反操作，得到缺失区域的掩膜；基于全局直线对缺失区域的掩膜进行分块，得到各子缺失区域的掩膜。6、将降噪后的各子缺失区域的噪声图308进行合并，得到缺失区域的噪声图309。7、将缺失区域的噪声图309和对已知区域进行加噪后的图像304合并，得到初步补全图像。可以理解，初步补全图像是对待补全的第一图像进行首次补全时得到的图像，因此将降噪后的各子缺失区域的噪声图308和对已知区域进行加噪后的图像304合并得到的图像也是初步补全图像。8、对初步补全图像进行重采样，得到重采样后的图像310。9、通过已训练的扩散模型对重采样后的图像310进行迭代降噪处理，得到进阶补全图像，直到迭代停止，将迭代停止后的进阶补全图像作为目标图像。也就是说，将每一次降噪处理的结果作为下一次迭代的输入，进而通过多次迭代，可以得到缺失区域中的图像内容已补全、且缺失区域中的图像内容与已知区域的图像内容具有语义一致性和几何一致性的目标图像。需要说明的是，掩膜m通常是一个二值图像，白色代表未知区域，黑色代表已知区域。真值图像为x，则未知区域的图像内容表示为m⊙x，已知区域的图像内容表示为⊙x。可以理解，当已训练的图像生成模型为已训练的扩散模型时，依据马尔科夫链的理论，扩散模型的反向过程从xt到xt-1的每一步都只依赖于xt，即只要保证对应分布的正确性，就可以改变已知区域⊙x。扩散模型的前向过程同样遵照马尔科夫链的理论给样本加噪声，故我们可以在任意时间t得到采样的中间结果。是从输入的图像中采样得到的，即从待补全的第一图像中的已知区域采样得到的，而/＞是由已训练的图像生成模型所生成。通过掩膜将/＞和/＞合并，利用重采样促使已训练的扩散模型生成进阶补全图像xt-1，迭代停止后的进阶补全图像xt-1即为目标图像。其中，代表后验概率分布函数，q代表先验概率分布函数。可以理解，在对待补全的第一图像301进行加噪时，是利用先验概率分布函数q来进行加噪的。使用已训练的扩散模型对重采样后的图像310进行迭代降噪处理时，是利用代表后验概率分布函数/＞来进行去噪的。上述图像补全方法中，由于利用直线信息对缺失区域进行分块，并针对不同的子缺失区域添加不同的高斯噪声，得到不同的子缺失区域的噪声图，因此对初步补全图像进行降噪处理得到目标图像的过程中，针对各子缺失区域，会生成与各子缺失区域大小匹配的补全的图像内容，避免出现过拟合的现象，使得生成的补全的图像内容更加准确，从而减小了补全的图像内容与缺失区域实际丢失的图像内容之间的差异，使得到的目标图像具有更好的视觉效果。应该理解的是，虽然如上所述的各实施例所涉及的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，如上所述的各实施例所涉及的流程图中的至少一部分步骤可以包括多个步骤或者多个阶段，这些步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤中的步骤或者阶段的至少一部分轮流或者交替地执行。基于同样的发明构思，本申请实施例还提供了一种用于实现上述所涉及的图像补全方法的图像补全装置。该装置所提供的解决问题的实现方案与上述方法中所记载的实现方案相似，故下面所提供的一个或多个图像补全装置实施例中的具体限定可以参见上文中对于图像补全方法的限定，在此不再赘述。在一个实施例中，如图4所示，提供了一种图像补全装置，包括：直线提取模块401、加噪模块402、合并模块403和降噪模块404，其中：直线提取模块401，用于对待补全的第一图像进行直线提取处理，得到直线信息；第一图像中包括缺失图像内容的缺失区域；基于直线信息对缺失区域进行分块，得到多个子缺失区域；加噪模块402，用于按照子缺失区域的数量对第一图像进行多次加噪，得到符合数量的高斯噪声图；每个高斯噪声图中的高斯噪声不同；合并模块403，用于针对每个子缺失区域，从符合数量的高斯噪声图中选取目标高斯噪声图，并从目标高斯噪声图中提取与子缺失区域对应的图像内容，得到子缺失区域的噪声图；将各子缺失区域的噪声图和第一图像合并，得到初步补全图像；降噪模块404，用于对初步补全图像进行降噪处理，得到目标图像。在一些实施例中，第一图像中包括具备图像内容的已知区域；直线信息包括全局直线；全局直线是贯穿第一图像中的缺失区域的直线；如图5所示，直线提取模块401包括直线提取单元401a、聚类融合单元401b和选取单元401c，其中：直线提取单元401a，用于对待补全的第一图像中的已知区域进行直线提取处理，得到已知区域中的局部直线。聚类融合单元401b，用于对各局部直线进行聚类处理，将聚为一类的各局部直线进行融合，得到多条候选直线。选取单元401c，用于从多条候选直线中选取全局直线。在一些实施例中，直线提取模块401用于基于提取的全局直线形成二值图像，得到直线二值图像；直线二值图像中直线区域像素值与非直线区域像素值不同；将直线二值图像和缺失区域进行相与操作，以对缺失区域进行分块得到多个子缺失区域。在一些实施例中，直线提取模块401具体用于在缺失区域处于第一图像的图像边缘的情况下，提取第一图像的边缘特征；将直线二值图像和缺失区域进行相与操作，以对缺失区域进行划分，得到位于图像边缘的非闭合的缺失子区域和位于非图像边缘的闭合的缺失子区域；基于边缘特征对非闭合的缺失子区域添加相应的图像边缘，得到位于图像边缘的闭合的缺失子区域。在一些实施例中，合并模块403用于确定第一图像的初始掩膜；对初始掩膜进行取反操作，得到缺失区域的掩膜；基于直线信息对缺失区域的掩膜进行分块，得到各子缺失区域的掩膜；根据子缺失区域的掩膜从目标高斯噪声图中提取子缺失区域对应的图像内容，得到子缺失区域的噪声图。在一些实施例中，降噪模块404用于将初步补全图像作为当前补全图像，对当前补全图像进行降噪处理，得到进阶补全图像；将进阶补全图像作为当前补全图像，返回执行对当前补全图像进行降噪处理，得到进阶补全图像的步骤以进行迭代降噪，直到迭代停止，将迭代停止后的进阶补全图像作为目标图像。上述图像补全装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。在一个实施例中，提供了一种计算机设备，其内部结构图可以如图6所示。该计算机设备包括处理器、存储器、输入/输出接口(Input/Output，简称I/O）和通信接口。其中，处理器、存储器和输入/输出接口通过系统总线连接，通信接口通过输入/输出接口连接到系统总线。其中，该计算机设备的处理器用于提供计算和控制能力。该计算机设备的存储器包括非易失性存储介质和内存储器。该非易失性存储介质存储有操作系统和计算机程序。该内存储器为非易失性存储介质中的操作系统和计算机程序的运行提供环境。该计算机设备的输入/输出接口用于处理器与外部设备之间交换信息。该计算机设备的通信接口用于与外部的终端通过网络连接通信。该计算机程序被处理器执行时以实现一种图像补全方法。本领域技术人员可以理解，图6中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备的限定，具体的计算机设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。在一个实施例中，提供了一种计算机设备，包括存储器和处理器，存储器中存储有计算机程序，该处理器执行计算机程序时实现上述各方法实施例中的步骤。在一个实施例中，提供了一种计算机可读存储介质，其上存储有计算机程序，计算机程序被处理器执行时实现上述各方法实施例中的步骤。在一个实施例中，提供了一种计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现上述各方法实施例中的步骤。需要说明的是，本申请所涉及的用户信息和数据，均为经用户授权或者经过各方充分授权的信息和数据，且相关数据的收集、使用和处理需要遵守相关国家和地区的相关法律法规和标准。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一非易失性计算机可读取存储介质中，该计算机程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、数据库或其它介质的任何引用，均可包括非易失性和易失性存储器中的至少一种。非易失性存储器可包括只读存储器、磁带、软盘、闪存、光存储器、高密度嵌入式非易失性存储器、阻变存储器、磁变存储器、铁电存储器、相变存储器、石墨烯存储器等。易失性存储器可包括随机存取存储器或外部高速缓冲存储器等。作为说明而非局限，RAM可以是多种形式，比如静态随机存取存储器或动态随机存取存储器等。本申请所提供的各实施例中所涉及的数据库可包括关系型数据库和非关系型数据库中至少一种。非关系型数据库可包括基于区块链的分布式数据库等，不限于此。本申请所提供的各实施例中所涉及的处理器可为通用处理器、中央处理器、图形处理器、数字信号处理器、可编程逻辑器、基于量子计算的数据处理逻辑器等，不限于此。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对本申请专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请的保护范围应以所附权利要求为准。
