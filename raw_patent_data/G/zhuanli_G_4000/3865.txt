标题title
基于图像特征和深度学习的相似场次降雨模式库构建方法
摘要abst
本发明公开一种基于图像特征和深度学习的相似场次降雨模式库构建方法：采用滑动窗口对历史降雨图像数据集进行分割得到所有场次降雨过程；提取各场次降雨过程的降雨持续天数、场次降雨总量、各日降雨量分布、降雨空间分布以及降雨中心运动轨迹特征；并进行特征相似性度量，采用基于混沌映射的多族群灰狼优化算法对特征的相似性度量进行融合，得到场次降雨过程的最优特征融合相似性度量；采用该最优特征融合相似性度量，从场次降雨过程历史库中搜索相似场次降雨过程并进行描述和表达，以此构建相似降雨模式库。本发明解决现有技术方案中或因用时序数据难以表达场次降雨过程的时空特征信息、或因场次降雨过程特征表达及相似性度量方法不足等问题。
权利要求书clms
1.一种基于图像特征和深度学习的相似场次降雨模式库构建方法，其特征在于：包括以下步骤：步骤S1、采集研究流域对应的历史时段日降雨量图像数据，设置单日降雨总量阈值，采用滑动窗口对历史降雨图像数据集进行分割，得到研究时段内所有场次降雨过程；步骤S2、分别定义场次降雨过程的降雨持续天数N、累积降雨量SP、降雨时间分布TD、降雨空间分布SD以及降雨中心运动轨迹Cm特征，然后采用不同方法提取场次降雨过程的上述五个特征，并存入场次降雨过程特征数据库；步骤S3、分别使用SIMN、SIMSP、SIMTD、SIMSD和SIMC来表征不同场次降雨过程的降雨持续天数N、累积降雨量SP、降雨时间分布TD、降雨空间分布SD以及降雨中心运动轨迹Cm五个特征间的相似度，以此度量场次降雨过程不同特征间的相似性；步骤S4、采用多指标加权融合方法对上述步骤S3中提取的降雨持续天数相似度SIMN、累积降雨量相似度SIMSP、日降雨量分布相似度SIMTD、降雨空间分布相似度SIMSD以及降雨中心运动轨迹相似度SIMC进行融合，使用基于混沌Tent映射的多族群灰狼优化算法IGWO获得最优权重系数，得到多特征融合的场次降雨之间的相似性度量方法；具体过程如下：步骤S4.1、将步骤S3中所得降雨持续天数相似度SIMN、累积降雨量相似度SIMSP、日降雨量分布相似度SIMTD、降雨空间分布相似度SIMSD、降雨中心运动轨迹相似度SIMC进行多元特征融合，最终得到场次降雨之间的融合相似度SIM；步骤S4.2、使用基于混沌Tent映射的多族群灰狼优化算法IGWO确定多元特征融合中的五个特征指标的权重系数ω1~ω5：首先从历史场次降雨数据中选取一部分作为样本集，剩余的部分作为对照集，通过使用IGWO动态调整权重系数，使得最终的搜索结果接近人为标注的结果；步骤S4.3、初始化权重系数ω1~ω5、灰狼α、β、 的位置以及整个灰狼群的位置；引入基于混沌Tent映射初始化整个灰狼群的位置；并引入多领导机制提高种群的多样性；步骤S4.4、使用归一化折损累计增益指标NDCG作为评估指标计算全部灰狼适应度；步骤S4.5、更新权重系数ω1~ω5、灰狼α、β、的位置以及灰狼群的位置；步骤S4.6、判断是否达到最大迭代数，如果没有达到最大迭代数，重复步骤S4.4至步骤S4.6，如果已经达到最大迭代数，输出最优的权重系数；并以最优权重系数对应的相似度作为最优特征融合相似性度判定相似场次降雨过程；步骤S5、基于最优特征融合相似性度量，从历史库中搜索并输出不同类别的相似场次降雨过程；并根据相似场次降雨过程对应的特征信息，构建相似降雨模式库。2.根据权利要求1所述的基于图像特征和深度学习的相似场次降雨模式库构建方法，其特征在于：所述步骤S1的详细过程为：步骤S1.1、对日降雨量图像进行规格化处理、冗余信息预处理，然后根据研究流域的子流域划分情况、降雨量等级划分标准及其在降雨图像中对应的颜色特征表示方法，采用加权颜色直方图技术提取降雨图像中各子流域包含的不同颜色类别及每类颜色对应的像素点数量；/＞M是子流域的数量，K是不同降雨等级对应的颜色类别总数；步骤S1.2 采用公式计算日降雨图像中各子流域对应的日降雨量：式上式中，1≤i≤M，1≤j≤K；则日降雨图像的单日降雨量P表示为其M个子流域的降雨量之和，如式： 式步骤S1.3、设置单日降雨阈值δ1，将日降雨量值P小于单日降雨阈值δ1的日期定为无雨期，具体过程为：步骤S1.3.1、以步长Step=1的滑动窗口技术遍历日降雨量图像序列，将历史降雨图像中第1个单日降雨总量P1超过δ1的降雨日定义为场次降雨过程Proc1的第1天；然后判定第2天的单日降雨总量情况；步骤S1.3.2、若第2天的单日降雨总量P2大于δ1，则将第2日并入场次降雨过程Proc1，并继续判断第3天的降雨情况是否并入场次降雨过程Proc1；步骤S1.3.3、若第2天的单日降雨总量P2小于或等于δ1，则接着判断第3天的单日降雨总量P3，若第3天单日降雨总量P3小于等于δ1，则场次降雨过程Proc1划分结束；否则将第2天和第3天加入到降雨过程Proc1；假设数据集的长度为L,直至碰到第l、l+1连续2日的单日降雨总量Pl、Pl+1小于等于δ1，则场次降雨过程Proc1划分结束；l＜L；步骤S1.3.4、上一个场次降雨过程Procd且d≥1划分结束后，重新将其后第1个单日降雨总量超过δ1的降雨日定义为第d+1个场次降雨过程Procd+1的第1天，然后采用上述步骤S1.3.1~步骤S1.3.3判断该场次降雨过程包含的降雨天数；直至遍历完日降雨量图像序列，并得到最终的场次降雨过程Proc1~Procw；w是历史降雨图像中的总降雨场次，1≤d≤w。3.根据权利要求1所述的基于图像特征和深度学习的相似场次降雨模式库构建方法，其特征在于：所述步骤S2中场次降雨特征指标的提取方法如下：步骤S2.1、降雨持续天数是指第d场次降雨过程Procd的总降雨天数，用Nd表示，1≤d≤w，w历史降雨图像中的总降雨场次，通过计算该场次降雨过程中包含的降雨量图像数量得到Nd；步骤S2.2、场次降雨总量SP是指第d场次降雨过程Procd中的所有单日降雨量累积之和；设该第d场次降雨过程的持续天数为Nd，则该场次降雨总量如式： 式其中Pdk示第d场次降雨过程Procd第k日的单日降雨量，1≤k≤Nd；步骤S2.3、场次降雨过程的日降雨时间分布TD是指在场次降雨过程Procd中每日的降雨量大小，具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，该场次降雨过程中第k日的日降雨量为Pdk，则第d场次降雨过程的日降雨量时间分布TDd形式化表示为向量；步骤S2.4、场次降雨过程的降雨空间分布TD是指在场次降雨过程Procd中，降落在各子流域的降雨量信息；具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，第d场次降雨过程第k日的日降雨量Pdk表示为其M个子流域 的降雨量之和；则第d场次降雨过程中子流域Basini的累积降雨量SPBsni由公式计算得到： 式上式中1≤i≤M，则第d场次降雨过程的降雨空间分布SDd形式化表示为向量：式步骤S2.5、场次降雨过程的降雨中心运动轨迹是指场次降雨过程Procd中最大降雨子流域的空间变化情况；具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，该场次降雨过程中第k日的降雨中心为，形式化的表示为；1≤d≤w；则第d场次降雨过程Procd的降雨中心运动轨迹Cm形式化的表示为。4.根据权利要求1所述的一种基于图像特征和深度学习的相似场次降雨模式库构建方法，其特征在于：所述步骤S3中不同场次降雨过程之间相似性度量计算的详细过程为：步骤S3.1、使用曼哈顿距离度量来计算降雨持续天数距离，则场次降雨过程Procd和场次降雨过程Procs降雨持续天数Nd和Ns之间的距离DN为：DN=|Nd-Ns| 式上式中，Procd 和Procs是两个不同场次降雨过程，且1≤d≤w，1≤s≤w；则场次降雨过程Procd和Procs降雨持续天数Nd和Ns之间的相似度SIMN表示为：式其中，max表示Nd和Ns中最大的降雨持续天数；步骤S3.2、使用曼哈顿距离度量来计算场次降雨总量距离，则场次降雨过程Procd和Procs累积降雨量SPd和SPs之间的距离DSP为：DSP=|SPd-SPs|式则场次降雨过程Procd和Procs累积降雨量SPd和SPs之间的相似度SIMSP表示为：式其中，max表示SPd和SPs中最大的累计降雨量；步骤S3.3、使用动态弯曲距离DTW计算场次降雨的降雨时间分布距离，则场次降雨过程Procd和Procs降雨时间分布向量TDd和TDs间的距离DTD表示为：DTD=DTW 式则场次降雨过程Procd和Procs降雨时间分布向量TDd和TDs间的相似度SIMTD表示为： 式步骤S3.4、场次降雨空间分布距离度量是一个M维的向量，使用欧氏距离度量来计算场次降雨空间分布距离，场次降雨过程Procd和Procs降雨空间分布向量SDd和SDs间的距离DSD表示为： 式其中，SPdBsni为第d场次第i个子流域Basini的总降雨量；SPsBsni为第s场次第i个子流域Basini的总降雨量；1≤i≤M；则场次降雨过程Procd和Procs降雨空间分布向量SDd和SDs间的相似度SIMSD表示为： 式步骤S3.5、使用动态弯曲距离DTW求解降雨中心运动轨迹距离：场次降雨过程Procd和Procs降雨中心运动轨迹Cmd和Cms间的距离DC计算方式如下：DC=DTW 式则场次降雨过程Procd和Procs降雨中心运动轨迹Cmd和Cms间的相似度SIMC计算方式如下： 式其中max表示SMPd和SMPs中最大值，SMPd和SMPs则分别表示场次降雨过程Procd和Procs中多日降雨量最大子流域的降雨量值之和；SMPd表示为：式。5.根据权利要求1所述的基于图像特征和深度学习的相似场次降雨模式库构建方法，其特征在于，所述步骤S4.1场次降雨之间的综合相似度SIM的计算方法为：采用多指标加权融合方法，对上述步骤S3降雨持续天数相似度SIMN、累积降雨量相似度SIMSP、日降雨量分布相似度SIMTD、降雨空间分布相似度SIMSD、降雨中心运动轨迹相似度SIMC进行融合，得到综合相似度SIM： 式上式中ω1~ω5依次是上述五个特征相似度的权重系数；所述步骤S4.3的详细过程为：初始化权重系数ω1~ω5、初始化灰狼α、β、的位置以及初始化整个灰狼群的位置；然后引入基于混沌Tent映射初始化整个灰狼群的位置；Tent混沌映射的表达式如式：式式中，yw+1 和yw均是中间计算量；引入多领导机制，将初始化后的灰狼群划分为4个小族群，在每次迭代过程中，小族群内部对最优位置进行更新；每10次迭代结束，进行小族群之间的信息交流，将整个种群内的个体进行打乱重组。6.根据权利要求1所述的基于图像特征和深度学习的相似场次降雨模式库构建方法，其特征在于，所述步骤S5的详细过程为：根据上述步骤S4.6中得到的最优权重系数~/＞对应的融合相似性度方法，从场次降雨过程历史库中搜索相似场次降雨过程并进行描述和表达，以此构建相似降雨模式库。/＞
说明书desc
技术领域本发明涉及水文气象和图像处理技术，具体涉及一种基于图像特征和深度学习的相似场次降雨模式库构建方法。背景技术暴雨洪水演变过程中各阶段间的规律，通常在历史场次暴雨洪水资料中以时空相似性模式和关联规则等形式重复出现。暴雨洪水的时空相似性规律发现对未来暴雨洪水过程的预测及防洪决策具有十分重要的借鉴价值：一方面，经过多年的水文观测与不断积累，各级水文部门已经形成了大量丰富的一手水雨情历史资料，为时空相似模式和关联规则挖掘提供了坚实的数据支撑；另一方面，大数据分析能力和机器学习、深度学习技术的发展，为历史暴雨洪水过程分级归类、历史相似暴雨洪水过程挖掘等应用提供新的技术手段和算力支撑。降雨是产生洪水的一个重大因素，在进行评估洪水风险的时候，降雨的相似性评价是一个重要依据。在降雨的相似性方面，也有一些研究，但是这些方法基本上是从降雨的时间序列数据出发，而且研究方法相对匮乏。例如王雍君等.水土保持研究，2007,14  :89-95.]以淮河流域为例，选取年降雨量、最大1d降雨量和最大7d降雨量3个降雨、径流指标，运用非平权距离系数法进行相似性分析；汤静静等. 成都工业学院学报, 2014, 17:65-68.]基于集对分析原理建立了降雨相似性评价方法-集对分析法；丁武等.计算机科学,2020,47:459-463.]利用XGBOOST机器学习算法建立参照期与水文预见期之间各水文特征的相似度映射模型，从而在历史水文时间序列中匹配出与预见期水文趋势最相似的序列。随着技术的发展，降雨的数据也不仅限于文本类型数据，已经出现了图像型数据，可以通过机器学习、深度学习技术来研究降雨量图的相似性，从而为洪水的预测提供新的方法。例如专利CN111027763A公开一种基于机器学习的流域洪水响应相似性分析方法，专利CN111027764B公开一种基于机器学习的适用于径流资料缺乏流域的洪水预报方法，专利CN115271255A公开基于知识图谱和机器学习的雨洪相似性分析方法和系统。这三个现有技术均使用机器学习的方法对雨洪的相似性进行分析，这些方法或采用面向降雨时间序列数据进行相似降雨部分的研究，导致研究的数据集形式较为单一、研究方法相对传统；或因降雨图像的特征提取及相似性度量方法不足等问题，导致在时间和效率上都有一定欠缺。发明内容发明目的：本发明提供一种基于图像特征和深度学习的相似场次降雨模式库构建方法，结合颜色直方图、图像特征提取、相似性度量、主客观集成赋权、灰狼优化等算法，提出基于深度学习的相似场次降雨过程搜索方法，实现相似降雨过程的识别和搜索及模式库的构建，能够解决现有技术方案中或因用时序数据难以表达降雨过程的时空特征信息、或因降雨图像的特征表达及相似性度量方法不足等问题。技术方案：本发明一种基于图像特征和深度学习的相似场次降雨模式库构建方法，包括以下步骤：步骤S1、采集研究流域对应的历史时段降雨量图像数据，设置单日降雨总量阈值，采用滑动窗口技术对历史降雨图像数据集进行分割，得到研究时段内所有场次降雨过程；步骤S2、分别定义场次降雨过程的降雨持续天数N、累积降雨量SP、降雨时间分布TD、降雨空间分布SD以及降雨中心运动轨迹Cm特征，并采用不同的算法提取场次降雨过程的上述特征并存入场次降雨过程特征数据库；步骤S3、分别使用SIMN、SIMSP、SIMTD、SIMSD和SIMC来表征不同场次降雨过程的降雨持续天数N、累积降雨量SP、降雨时间分布TD、降雨空间分布SD以及降雨中心运动轨迹Cm五个特征间的相似度，进而度量场次降雨特征间的相似性；步骤S4、采用多指标加权融合方法对上述步骤S3中提取的降雨持续天数相似度SIMN、累积降雨量相似度SIMSP、日降雨量分布相似度SIMTD、降雨空间分布相似度SIMSD以及降雨中心运动轨迹相似度SIMC进行融合，使用基于混沌Tent映射的多族群灰狼优化算法IGWO获得最优权重系数，得到多特征融合的场次降雨之间的相似性度量方法；具体过程如下：步骤S4.1、将步骤S3中所得降雨持续天数相似度SIMN、累积降雨量相似度SIMSP、日降雨量分布相似度SIMTD、降雨空间分布相似度SIMSD、降雨中心运动轨迹相似度SIMC进行多元特征融合，最终得到场次降雨之间的综合相似度SIM；步骤S4.2、使用基于混沌Tent映射的多族群灰狼优化算法IGWO确定多元特征融合中的各特征指标的权重系数ω1~ω5：首先从历史场次降雨数据中选取一部分作为样本集，剩余的部分作为对照集，通过使用IGWO动态调整权重系数，使得最终的搜索结果接近人为标注的结果；步骤S4.3、初始化权重系数ω1~ω5、灰狼α、β、的位置以及整个灰狼群的位置；引入基于混沌Tent映射初始化整个灰狼群的位置；并引入多领导机制提高种群的多样性；步骤S4.4、计算全部灰狼适应度：使用归一化折损累计增益指标NDCG作为全部灰狼的适应度；步骤S4.5、更新权重系数ω1~ω5、灰狼α、β、的位置以及灰狼群的位置；步骤S4.6、判断是否达到最大迭代数，如果没有达到最大迭代数，重复步骤S4.4至步骤S4.6，如果已经达到最大迭代数，输出最优的权重系数ω1~ω5；并以最优权重系数对应的相似度作为相似场次降雨过程判定的依据。步骤S5、基于最优特征融合相似性度量，从历史库中搜索并输出不同类别的相似场次降雨过程；并根据相似场次降雨过程对应的特征信息，构建相似降雨模式库。进一步地，所述步骤S1的详细过程为：步骤S1.1、对日降雨量图像进行规格化处理、冗余信息预处理等操作，然后根据研究流域的子流域划分情况、降雨量等级划分标准及其在降雨图像中对应的颜色特征表示方法，采用加权颜色直方图技术提取降雨图像中各子流域包含的不同颜色类别及每类颜色对应的像素点数量；M是子流域的数量，K是不同降雨等级对应的颜色类别总数；步骤S1.2 采用公式计算日降雨图像中各子流域对应的日降雨量PBsni： 式则日降雨图像的单日降雨量P可表示为其M个子流域的降雨量之和： 式步骤S1.3、设置单日降雨阈值δ1，将日降雨量值P小于单日降雨阈值δ1的日期定为无雨期；以滑动窗口技术遍历日降雨量图像序列，将历史降雨图像中第1个单日降雨总量P1超过δ1的降雨日定义为场次降雨过程Proc1的第1天；判定第2天的单日降雨总量情况：I、若第2天的单日降雨总量P2大于δ1，则将第2日并入场次降雨过程Proc1，并继续判断第3天的降雨情况是否并入场次降雨过程Proc1；II、若第2天的单日降雨总量P2小于等于δ1，则判断第3天的单日降雨总量P3,若第3天单日降雨总量P3小于等于δ1，则场次降雨过程Proc1划分结束；否则将第2天和第3天加入到降雨过程Proc1；假设数据集的长度为L，直至碰到第l、l+1连续2日的单日降雨总量Pl、Pl+1小于等于δ1，则场次降雨过程Proc1划分结束；l＜L；III、上一场次降雨过程Procd划分结束后，重新将其后第1个单日降雨总量超过δ1的降雨日定义为第d+1场次降雨过程Procd+1的第1天，然后采用上述I）~II）判断该场次降雨过程包含的降雨天数；直至遍历完日降雨量图像序列并得到最终的场次降雨过程Proc1~Procw；w是历史降雨图像中的总降雨场次，1≤d≤w。进一步地，所述步骤S2的详细过程为：步骤S2.1、所述降雨持续天数是指第d场次降雨过程Procd的持续天数，用Nd表示，可通过计算该场次降雨过程中包含的降雨量图像数量得到；步骤S2.2、所述场次降雨总量SP是指第d场次降雨过程Procd所有包含的所有单日降雨量累积之和；设该第d场次降雨过程的持续天数为Nd，则该场次降雨总量如式： 式其中Pk示第d场次降雨过程Procd第k日的单日降雨量,可由公式计算得到；步骤S2.3、所述场次降雨过程的日降雨时间分布TD是指在场次降雨过程Procd中每日的降雨量大小，具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，该场次降雨过程中第k日的日降雨量为Pdk，则第d场次降雨过程的日降雨量时间分布TDd形式化表示为向量；步骤S2.4、所述场次降雨过程的降雨空间分布TD是指在场次降雨过程Procd中，降落在上述步骤S1.1中所述各子流域的降雨量信息；具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，由上述步骤S1.2中公式, 第d场次降雨过程第k日的日降雨量为Pdk可表示为其M个子流域 的降雨量之和；则第d场次降雨过程中子流域Basini的累积降雨量SPBsni由公式计算得到： 式则第d场次降雨过程的降雨空间分布SDd形式化表示为向量，且有式步骤S2.5、所述场次降雨过程的降雨中心运动轨迹是指场次降雨过程Procd中最大降雨子流域的空间变化情况；具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，该场次降雨过程中第k日的降雨中心为ck，可形式化的表示为；则第d场次降雨过程Procd的降雨中心运动轨迹Cm形式化的表示为；进一步地，所述步骤S3不同场次降雨过程之间相似性度量计算的详细过程为：步骤S3.1、使用曼哈顿距离度量来计算降雨持续天数距离，则场次降雨过程Procd和场次降雨过程Procs降雨持续天数Nd和Ns之间的距离DN为：DN=|Nd-Ns|式上式中，Procd和Procs是两个不同场次降雨过程，且1≤d≤w，1≤s≤w，则场次降雨过程Procd和Procs降雨持续天数Nd和Ns之间的相似度SIMN可以表示为：式其中，max表示Nd和Ns中最大的降雨持续天数。步骤S3.2、使用曼哈顿距离度量来计算场次降雨总量距离，则场次降雨过程Procd和Procs累积降雨量SPd和SPs之间的距离DSP为：式；则场次降雨过程Procd和Procs累积降雨量SPd和SPs之间的相似度SIMSP可以表示为：式其中，max表示SPd和SPs中最大的累计降雨量。步骤S3.3、使用动态弯曲距离DTW计算场次降雨的降雨时间分布距离，则场次降雨过程Procd和Procs降雨时间分布向量TDd和TDs间的距离DTD可表示为：式则场次降雨过程Procd和Procs降雨时间分布向量TDd和TDs间的相似度SIMTD可表示为： 式步骤S3.4、场次降雨空间分布距离度量是一个M维的向量，使用欧氏距离度量来计算场次降雨空间分布距离，场次降雨过程Procd和Procs降雨空间分布向量SDd和SDs间的距离DSD可表示为： 式其中，SPdBsni为第d场次第i个子流域Basini的总降雨量；SPsBsni为第s场次第i个子流域Basini的总降雨量；则场次降雨过程Procd和Procs降雨空间分布向量SDd和SDs间的相似度SIMSD可表示为：式步骤S3.5、使用动态弯曲距离DTW求解降雨中心运动轨迹距离：场次降雨过程Procd和Procs降雨中心运动轨迹Cmd和Cms间的距离DC计算方式如下： 式那么场次降雨过程Procd和Procs降雨中心运动轨迹Cmd和Cms间的相似度SIMC计算方式如下：式其中max表示SMPd和SMPs中最大值，SMPd和SMPs则分别表示场次降雨过程Procd和Procs中多日降雨量最大子流域的降雨量值之和，SMPd可以表示为：式进一步地，所述步骤S4.1场次降雨之间的综合相似度SIM的计算方法为：采用多指标加权融合方法，对上述步骤S3降雨持续天数相似度SIMN、累积降雨量相似度SIMSP、日降雨量分布相似度SIMTD、降雨空间分布相似度SIMSD、降雨中心运动轨迹相似度SIMC进行融合，得到融合相似度SIM：式上式中ω1~ω5分别是降雨持续天数相似距离SIMN、累计降雨量相似距离SIMSP、日降雨量分布相似距离SIMTD、降雨空间分布相似距离SIMSD、降雨中心运动轨迹相似距离SIMC的权重系数；进一步地，所述步骤S4.3的详细过程为：初始化权重系数ω1~ω5、初始化灰狼α、β、的位置以及初始化整个灰狼群的位置；引入基于混沌Tent映射初始化整个灰狼群的位置；Tent混沌映射的表达式如式：式/＞式中，yw+1和yw均是中间计算量；引入多领导机制，将初始化后的灰狼群划分为4个小族群，在每次迭代过程中，小族群内部对最优位置进行更新；每10次迭代结束，进行小族群之间的信息交流，将整个种群内的个体进行打乱重组。进一步地，所述步骤S5的详细过程为：根据上述步骤S4.6中得到的最优权重系数~/＞对应的融合相似性度方法，从场次降雨过程历史库中搜索相似场次降雨过程并进行描述和表达，以此构建相似降雨模式库。有益效果：本发明通过使用改进的智能优化算法对降雨的图像数据的特征进行融合，来实现降雨的相似性研究。本发明应用的场景为水文气象领域中相似降雨过程检索，针对现有的降雨图像数据，通过设置降雨阈值将历史的时序的日降雨图划分为多场次降雨，并提取了场次降雨的持续天数、累积降雨量、降雨时间分布、降雨空间分布、降雨中心运动轨迹五个指标，作为刻画场次降雨的特征，并分别定义了上述五个特征指标的相似性度量，然后采用灰狼优化算法对上述特征进行融合，综合度量场次降雨之间的相似度，提升相似场次降雨搜索过程的准确性，并根据相似性搜索结果进行分类，构建相似降雨过程模式库。附图说明图1是本发明实施例中的流程图。图2是本发明实施例中某流域降雨图像数据集序列示意图；图3是本发明实施例中降雨场次划分滑动窗口示意图；图4是本发明实施例中采用滑动窗口分割形成场次降雨过程图；图5是本发明实施例中基于IGWO算法的参数寻优流程图；图6是本发明实施例中场次降雨搜索的结果。具体实施方式下面对本发明技术方案进行详细说明，但是本发明的保护范围不局限于所述实施例。如图1所示，本实施例的基于图像特征和深度学习的相似场次降雨模式库构建方法，包括以下步骤：步骤S1、采集研究流域对应的历史时段降雨量图像数据集，设置单日降雨量阈值，采用滑动窗口技术对历史降雨图像数据集进行分割，得到研究时段内所有场次降雨过程；步骤S1.1、对日降雨量图像进行规格化处理、冗余信息预处理等操作，然后根据研究流域的子流域划分情况、降雨量等级划分标准及其在降雨图像中对应的颜色特征表示方法，采用加权颜色直方图技术提取降雨图像中各子流域包含的不同颜色类别及每类颜色对应的像素点数量；M是子流域的数量，K是不同降雨等级对应的颜色类别总数；步骤S1.2 采用公式计算日降雨图像中各子流域对应的日降雨量PBsni：式/＞则日降雨图像的单日降雨量P表示为M个子流域的降雨量之和： 式步骤S1.3、设置单日降雨阈值δ1，将日降雨量值P小于单日降雨阈值δ1的日期定为无雨期；以滑动窗口技术遍历日降雨量图像序列，将历史降雨图像中第1个单日降雨总量P1超过δ1的降雨日定义为场次降雨过程Proc1的第1天；判定第2天的单日降雨总量情况：I、若第2天的单日降雨总量P2大于δ1，则将第2日并入场次降雨过程Proc1，并继续判断第3天的降雨情况是否并入场次降雨过程Proc1；II、若第2天的单日降雨总量P2小于等于δ1，则判断第3天的单日降雨总量P3,若第3天单日降雨总量P3小于等于δ1，则场次降雨过程Proc1划分结束；否则将第2天和第3天加入到降雨过程Proc1；假设数据集的长度为L，直至碰到第l、l+1连续2日的单日降雨总量Pl、Pl+1小于等于δ1，则场次降雨过程Proc1划分结束；III、上一场次降雨过程Procd划分结束后，重新将其后第1个单日降雨总量超过δ1的降雨日定义为第d+1场次降雨过程Procd+1的第1天，然后采用上述I）~II）判断该场次降雨过程包含的降雨天数；直至遍历完日降雨量图像序列并得到最终的场次降雨过程Proc1~Procw；步骤S2、分别定义场次降雨过程的降雨持续天数N、累计降雨量SP、降雨时间分布TD、降雨空间分布R以及降雨中心运动轨迹Cm特征，并采用不同的算法提取场次降雨过程的上述特征并存入场次降雨过程特征数据库；、所述降雨持续天数是指第d场次降雨过程Procd的持续天数，用Nd表示，可通过计算该场次降雨过程中包含的降雨量图像数量得到；、所述场次降雨总量SP是指第d场次降雨过程Procd所有包含的所有单日降雨量累积之和；设该第d场次降雨过程的持续天数为Nd，则该场次降雨总量如式：式其中Pk示第d场次降雨过程Procd第k日的单日降雨量,可由公式计算得到；、所述场次降雨过程的日降雨时间分布TD是指在场次降雨过程Procd中每日的降雨量大小，具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，该场次降雨过程中第k日的日降雨量为Pdk，则第d场次降雨过程的日降雨量时间分布TDd形式化表示为向量；、所述场次降雨过程的降雨空间分布TD是指在场次降雨过程Procd中，降落在上述步骤S1.1中所述各子流域的降雨量信息；具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，由上述步骤S1.2中公式, 第d场次降雨过程第k日的日降雨量为Pdk可表示为其M个子流域 的降雨量之和；则第d场次降雨过程中子流域Basini的累积降雨量SPBsni由公式计算得到： 式则第d场次降雨过程的降雨空间分布SDd形式化表示为向量,且有式、所述场次降雨过程的降雨中心运动轨迹是指场次降雨过程Procd中最大降雨子流域的空间变化情况；具体提取方法为：假设第d场次降雨过程的降雨持续天数为Nd，该场次降雨过程中第k日的降雨中心为ck，可形式化的表示为；则第d场次降雨过程Procd的降雨中心运动轨迹Cm形式化的表示为；步骤S3、分别定义SIMN、SIMSP、SIMTD、SIMSD、SIMC表征不同场次降雨过程的降雨持续天数N、累积降雨量SP、降雨时间分布TD、降雨空间分布SD以及降雨中心运动轨迹Cm五个特征间的相似度，以度量场次降雨过程Procd和场次降雨过程Procs之间的相似性；、使用曼哈顿距离度量来计算降雨持续天数距离，则场次降雨过程Procd和Procs降雨持续天数Nd和Ns之间的距离DN为：DN=|Nd-Ns|式那么场次降雨过程Procd和Procs降雨持续天数Nd和Ns之间的相似度SIMN可以表示为：式其中，max表示Nd和Ns中最大的降雨持续天数；、使用曼哈顿距离度量来计算场次降雨总量距离，则场次降雨过程Procd和Procs累积降雨量SPd和SPs之间的距离DSP为： 式那么场次降雨过程Procd和Procs累积降雨量SPd和SPs之间的相似度SIMSP可以表示为： 式其中，max表示SPd和SPs中最大的累计降雨量；、使用动态弯曲距离DTW计算场次降雨的降雨时间分布距离，则场次降雨过程Procd和Procs降雨时间分布向量TDd和TDs间的距离DTD可表示为： 式那么场次降雨过程Procd和Procs降雨时间分布向量TDd和TDs间的相似度SIMTD可表示为： 式、场次降雨空间分布距离度量是一个M维的向量，使用欧氏距离度量来计算场次降雨空间分布距离，场次降雨过程Procd和Procs降雨空间分布向量SDd和SDs间的距离DSD可表示为：/＞ 式其中，SPdBsni为第d场次第i个子流域Basini的总降雨量；SPsBsni为第s场次第i个子流域Basini的总降雨量；那么场次降雨过程Procd和Procs降雨空间分布向量SDd和SDs间的相似度SIMSD可表示为： 式、使用动态弯曲距离DTW求解降雨中心运动轨迹距离：场次降雨过程Procd和Procs降雨中心运动轨迹Cmd和Cms间的距离DC计算方式如下：DC=DTW式那么场次降雨过程Procd和Procs降雨中心运动轨迹Cmd和Cms间的相似度SIMC计算方式如下：式其中max表示SMPd和SMPs中最大值，SMPd和SMPs则分别表示场次降雨过程Procd和Procs中多日降雨量最大子流域的降雨量值之和。SMPd可以表示为：式步骤S4、采用多指标加权融合对上述区域降雨持续天数、累积降雨量、降雨时间分布、降雨空间分布、降雨中心运动轨迹五个特征距离进行融合，得到综合距离SIM： 式上式中ω1~ω5分别是各特征相似度的权重系数；从历史降雨图像数据库中选择30场降雨作为样本集，其中6场降雨等级为小雨、9场降雨等级为中雨和15场降雨等级为大到暴雨；并按照2:1的比例将样本划分为训练集和测试集，使用基于混沌Tent映射的多族群灰狼优化算法获得最优权重系数，得到多特征融合的场次降雨之间的相似性度量方法；其中IGWO步骤如下：、初始化权重系数ω1~ω5、初始化灰狼α、β、/＞的位置；、引入基于混沌Tent映射初始化整个灰狼群的位置。Tent混沌映射的表达式如式： 式式中，yw+1和yw均是中间计算量；、引入多领导机制，将初始化后的灰狼群划分为4个小族群，在每次迭代过程中，小族群内部对最优位置进行更新；每10次迭代结束，进行小族群之间的信息交流，将整个种群的个体进行打乱重组；Ⅳ、计算全部灰狼适应度：使用归一化折损累计增益指标作为全部灰狼的适应度；Ⅴ、更新权重系数ω1~ω5、α、β、的位置以及灰狼群的位置；/＞Ⅵ、判断是否达到最大迭代数，如果没有达到最大迭代数，重复步骤Ⅳ、Ⅴ、Ⅵ；如果已经达到最大迭代数，输出最优的权重系数ω1~ω5。步骤S5、根据上述最优的权重系数~/＞确定的相似度度量方法，从历史库中，搜索出相似度最高的历史场次降雨；并根据不同类别相似场次降雨过程对应的特征信息进行分类，构建相似降雨模式库。实施例：本实施例的具体流程如图1所示。对图2所示的流域降雨图像数据集序列，采用如图3所示滑动步长Step=1的滑动窗口来划分场次降雨过程，得到研究流域给定时间范围内的所有场次降雨过程Procw；对图4所示的场次降雨过程，分别采用上述步骤S2中Ⅰ）~Ⅴ）提取该场次降雨过程的降雨持续天数N、累积降雨量SP、降雨时间分布TD、降雨空间分布SD以及降雨中心运动轨迹Cm五个特征并存储进场次降雨过程特征数据库；对图4所示的场次降雨过程，采用图5算法确定最优的权重系数ω1~ω5，并以其对应的相似度度量方法从场次降雨过程特征数据库中搜索和该场次降雨过程最相似的场次降雨过程，结果如图6所示。采用图5算法确定最优的权重系数ω1~ω5，并以其对应的相似度度量方法对历史场次降雨过程特征数据库的所有场次降雨过程进行相似性检索，对相似降雨过程进行分类，并以同类别的相似场次降雨过程为基础构建降雨模式，形成降雨特征模式库。
