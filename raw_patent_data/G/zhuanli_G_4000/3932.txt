标题title
反馈调节充电电路和电子设备
摘要abst
本申请提出一种反馈调节充电电路和电子设备，其中，反馈调节充电电路包括BUCK降压电路、PWM驱动电路、电流检测电路和电流误差放大电路，通过设置检测管和参考电流源生成电流检测电路，电流误差放大电路对第一功率管导通时的平均电流和N倍的参考电流的大小进行误差比较，根据比较结果对PWM驱动电路的电压误差信号以及PWM驱动信号的占空比进行负反馈调节，从而实现对反馈调节充电电路的恒流控制输出，并且检测功率管的导通内阻等于第一功率管的导通内阻的N倍，稳态时，参考电流等同于第一功率管导通时的平均电流的1/N倍，电流检测电路引起的功率损耗小，提高了恒流充电的控制精度。
权利要求书clms
1.一种反馈调节充电电路，其特征在于，包括：BUCK降压电路，包括第一功率管、第二功率管、电感和第一电容，所述第一功率管的第一端构成所述反馈调节充电电路的电源输入端；PWM驱动电路，与所述第一功率管连接，所述PWM驱动电路，用于根据接收到的电压误差信号产生对应大小占空比的PWM驱动信号，以控制所述第一功率管通断，所述第一功率管的占空比大小与所述电压误差信号的大小呈正相关变化；电流检测电路，所述电流检测电路包括检测功率管和参考电流源，所述检测功率管的第一端与所述第一功率管的第一端连接，所述检测功率管的受控端与所述第一功率管的受控端连接，所述检测功率管的第二端与所述参考电流源连接，所述参考电流源用于输出参考电流，其中，所述检测功率管的导通内阻等于所述第一功率管的导通内阻的N倍，N＞1；电流误差放大电路，分别与所述检测功率管的第二端、所述第一功率管的第二端和所述PWM驱动电路连接，所述电流误差放大电路，用于比较所述第一功率管导通时的平均电流和N倍的所述参考电流的大小，并输出预设大小的第一误差电压信号；其中，第一电压差值与第二电压差值呈负相关变化，所述第一电压差值为所述第一功率管导通时的平均电流和N倍的所述参考电流的电压差值，所述第二电压差值为所述第一误差电压信号与第一目标误差电压信号的电压差值。2.如权利要求1所述的反馈调节充电电路，其特征在于，所述电流误差放大电路包括第一误差放大器、第一与门、第二与门、第一反相放大器、第一电流源、第二电流源、第一开关、第二开关、第二电容和电压跟随器；所述第一误差放大器的正相输入端与所述第一功率管的第二端连接，所述第一误差放大器的反相输入端与所述检测功率管的第二端连接，所述第一误差放大器输出端与所述第一与门的第一输入端连接，所述第一与门的第二输入端与所述第一功率管的第二端连接，所述第一与门的输出端和所述第一开关的受控端连接，所述第一开关的第一端、所述第一电流源的输出端、所述第二电流源的输入端、所述第二电容的第一端和所述电压跟随器的正相输入端连接，所述电压跟随器的反相输入端和所述电压跟随器的输出端连接构成所述电流误差放大电路的信号输出端，所述第一电流源的输入端与正电源端连接，所述第二电流源的输出端与所述第二开关的第一端连接，所述第二开关的第二端接地，所述第二开关的受控端与所述第二与门的输出端连接，所述第二电容的第二端接地；所述第一反相放大器的输入端与所述第一与门的输出端连接，所述第一反相放大器的输出端与所述第二与门的第一输入端连接，所述第二与门的第二输入端与所述第一功率管的第二端连接；或者，所述第一反相放大器的输入端与所述第一误差放大器的输出端连接，所述第一反相放大器的第二端与所述第二与门的第一输入端连接，所述第二与门的第二输入端与所述第一功率管的受控端连接；所述第一电流源的电流大小等于所述第二电流源的电流大小。3.如权利要求1所述的反馈调节充电电路，其特征在于，所述电流误差放大电路包括第一误差放大器、第一与门、第一同相放大器、第一电流源、第二电流源、第一开关、第二开关和第二电容；所述第一误差放大器的正相输入端与所述第一功率管的第二端连接，所述第一误差放大器的反相输入端与所述检测功率管的第二端连接，所述第一误差放大器输出端与所述第一与门的第一输入端连接，所述第一与门的第二输入端与所述第一功率管的第二端连接，所述第一与门的输出端和所述第一开关的受控端连接，所述第一开关的第一端、所述第一电流源的输出端、所述第二电流源的输入端、所述第二电容的第一端和所述电压跟随器的正相输入端连接，所述电压跟随器的反相输入端和所述电压跟随器的输出端连接构成所述电流误差放大电路的信号输出端，所述第一电流源的输入端与正电源端连接，所述第二电流源的输出端与所述第二开关的第一端连接，所述第二开关的第二端接地，所述第二开关的受控端与所述第一同相放大器的输出端连接，所述第一同相放大器的输入端与所述第一功率管的第二端连接，所述第二电容的第二端接地；所述第一电流源的电流大小为所述第二电流源的电流大小的两倍。4.如权利要求1所述的反馈调节充电电路，其特征在于，所述电流误差放大电路包括第一误差放大器、第一与门、第一电流源、第二电流源、第二电容、第一开关和第二开关；所述第一误差放大器的正相输入端与所述第一功率管的第二端连接，所述第一误差放大器的反相输入端与所述检测功率管的第二端连接，所述第一误差放大器输出端与所述第一与门的第一输入端连接，所述第一与门的第二输入端与所述第一功率管的受控端连接，所述第一与门的输出端和所述第一开关的受控端连接，所述第一开关的第一端、所述第一电流源的输出端、所述第二电流源的输入端、所述第二电容的第一端和所述电压跟随器的正相输入端连接，所述电压跟随器的反相输入端和所述电压跟随器的输出端连接构成所述电流误差放大电路的信号输出端，所述第一电流源的输入端与正电源端连接，所述第二电流源的输出端与所述第二开关的第一端连接，所述第二开关的第二端接地，所述第二开关的受控端与所述第一功率管的受控端连接，所述第二电容的第二端接地；所述第一电流源的电流大小为所述第二电流源的电流大小的两倍。5.如权利要求1~4任一项所述的反馈调节充电电路，其特征在于，所述反馈调节充电电路还包括：电压误差放大电路，与所述BUCK降压电路的输出端连接，所述电压误差放大电路，用于将所述BUCK降压电路的输出电压与预设参考电压进行比较，并输出预设大小的第二误差电压信号；其中，第三电压差值与第四电压差值呈负相关变化，所述第三电压差值为所述BUCK降压电路的输出电压与预设参考电压的电压差值，所述第四电压差值为所述第二误差电压信号与第二目标误差电压信号的电压差值；误差信号选择电路，分别与所述电压误差放大电路、所述电流误差放大电路和所述PWM驱动电路连接，所述误差信号选择电路，用于：将所述第一误差电压信号和所述第二误差电压信号进行比较；并在所述第一误差电压信号小于所述第二误差电压信号时，选择输出所述第一误差电压信号；以及在所述第二误差电压信号小于所述第一误差电压信号时，选择输出所述第二误差电压信号。6.如权利要求5所述的反馈调节充电电路，其特征在于，所述电压误差放大电路包括第二误差放大器；所述第二误差放大器的反相输入端与所述BUCK降压电路输出端连接，所述第二误差放大器的正相输入端用于输入所述预设参考电压，所述第二误差放大器的输出端构成所述电压误差放大电路的信号输出端。7.如权利要求5所述的反馈调节充电电路，其特征在于，所述误差信号选择电路包括第一二极管、第二二极管、第三电容和第三电流源；所述第一二极管的阴极与所述电流误差放大电路的信号输出端连接，所述第二二极管的阴极与所述电压误差放大电路的信号输出端连接，所述第一二极管的阳极、所述第二二极管的阳极、所述第三电容的第一端和所述第三电流源的输出端共接，所述第三电容的第二端接地，所述第三电流源的输入端与正电源端连接。8.如权利要求1所述的反馈调节充电电路，其特征在于，所述PWM驱动电路包括比较器、第二同相放大器和第二反相放大器；所述比较器的正相输入端与所述电压源电路连接，所述比较器的反相输入端用于输入三角波参考信号，所述比较器的输出端、所述第二同相放大器的输入端和所述第二反相放大器的输入端连接，所述第二同相放大器的输出端与所述第一功率管的受控端连接，所述第二反相放大器的输出端与所述第二功率管的受控端连接。9.如权利要求1所述的反馈调节充电电路，其特征在于，所述PWM驱动电路包括比较器、触发器、第三同相放大器和第四同相放大器；所述比较器的反相输入端与所述电压源电路连接，所述比较器的正相输入端用于输入第一功率管的电流和和谐波补偿电流，所述比较器的输出端与所述触发器的输入端连接，所述触发器的时钟输入端用于输入时钟信号，所述触发器的输出端与所述第三同相放大器的输入端连接，所述触发器的反相输出端与所述第四同相放大器的输入端连接，所述第三同相放大器的输出端与所述第一功率管的受控端连接，所述第四同相放大器的输出端与所述第二功率管的受控端连接。10.一种电子设备，其特征在于，包括如权利要求1~9任一项所述的反馈调节充电电路。
说明书desc
技术领域本申请属于充电技术领域，尤其涉及一种反馈调节充电电路和电子设备。背景技术储能器件或者设备通常通过对应的充电电路进行恒压或者恒流充电，例如锂电池通过对应的电池充电电路进行充电，如图1所示，常见的充电电路采用两个功率管、电感和电容组成降压拓扑结构，第一功率管的第一端用于输入直流电源，第一功率管的第二端、第二功率管的第一端和电感的第一端共接，第二功率管的第二端接地，电感的第二端和电容的第一端连接构成充电电路的电源输出端，电容的第二端接地。为了提高充电安全性，在恒流充电过程中需要充电电路的充电电流保持恒定，对应地，为了实现恒流充电的电流控制，需要对电池充电电流进行检测，其中，常规的电流检测电路通常采用串接电阻、串接检测开关管、或者检测电感的电压降等方式，容易引起较大的功率损耗，影响恒流充电的控制精度。发明内容本申请的目的在于提供一种反馈调节充电电路，旨在解决传统的充电电路中电流检测电路存在恒流充电控制精度差的问题。本申请实施例的第一方面提出了一种反馈调节充电电路，包括：BUCK降压电路，包括第一功率管、第二功率管、电感和第一电容，所述第一功率管的第一端构成所述反馈调节充电电路的电源输入端；PWM驱动电路，与所述第一功率管连接，所述PWM驱动电路，用于根据接收到的电压误差信号产生对应大小占空比的PWM驱动信号，以控制所述第一功率管通断，所述第一功率管的占空比大小与所述电压误差信号的大小呈正相关变化；电流检测电路，所述电流检测电路包括检测功率管和参考电流源，所述检测功率管的第一端与所述第一功率管的第一端连接，所述检测功率管的受控端与所述第一功率管的受控端连接，所述检测功率管的第二端与所述参考电流源连接，所述参考电流源用于输出参考电流，其中，所述检测功率管的导通内阻等于所述第一功率管的导通内阻的N倍，N＞1；电流误差放大电路，分别与所述检测功率管的第二端、所述第一功率管的第二端和所述PWM驱动电路连接，所述电流误差放大电路，用于比较所述第一功率管导通时的平均电流和N倍的所述参考电流的大小，并输出预设大小的第一误差电压信号；其中，第一电压差值与第二电压差值呈负相关变化，所述第一电压差值为所述第一功率管导通时的平均电流和N倍的所述参考电流的电压差值，所述第二电压差值为所述第一误差电压信号与第一目标误差电压信号的电压差值。可选地，所述电流误差放大电路包括第一误差放大器、第一与门、第二与门、第一反相放大器、第一电流源、第二电流源、第一开关、第二开关、第二电容和电压跟随器；所述第一误差放大器的正相输入端与所述第一功率管的第二端连接，所述第一误差放大器的反相输入端与所述检测功率管的第二端连接，所述第一误差放大器输出端与所述第一与门的第一输入端连接，所述第一与门的第二输入端与所述第一功率管的第二端连接，所述第一与门的输出端和所述第一开关的受控端连接，所述第一开关的第一端、所述第一电流源的输出端、所述第二电流源的输入端、所述第二电容的第一端和所述电压跟随器的正相输入端连接，所述电压跟随器的反相输入端和所述电压跟随器的输出端连接构成所述电流误差放大电路的信号输出端，所述第一电流源的输入端与正电源端连接，所述第二电流源的输出端与所述第二开关的第一端连接，所述第二开关的第二端接地，所述第二开关的受控端与所述第二与门的输出端连接，所述第二电容的第二端接地；所述第一反相放大器的输入端与所述第一与门的输出端连接，所述第一反相放大器的输出端与所述第二与门的第一输入端连接，所述第二与门的第二输入端与所述第一功率管的第二端连接；或者，所述第一反相放大器的输入端与所述第一误差放大器的输出端连接，所述第一反相放大器的第二端与所述第二与门的第一输入端连接，所述第二与门的第二输入端与所述第一功率管的受控端连接；所述第一电流源的电流大小等于所述第二电流源的电流大小。可选地，所述电流误差放大电路包括第一误差放大器、第一与门、第一同相放大器、第一电流源、第二电流源、第一开关、第二开关和第二电容；所述第一误差放大器的正相输入端与所述第一功率管的第二端连接，所述第一误差放大器的反相输入端与所述检测功率管的第二端连接，所述第一误差放大器输出端与所述第一与门的第一输入端连接，所述第一与门的第二输入端与所述第一功率管的第二端连接，所述第一与门的输出端和所述第一开关的受控端连接，所述第一开关的第一端、所述第一电流源的输出端、所述第二电流源的输入端、所述第二电容的第一端和所述电压跟随器的正相输入端连接，所述电压跟随器的反相输入端和所述电压跟随器的输出端连接构成所述电流误差放大电路的信号输出端，所述第一电流源的输入端与正电源端连接，所述第二电流源的输出端与所述第二开关的第一端连接，所述第二开关的第二端接地，所述第二开关的受控端与所述第一同相放大器的输出端连接，所述第一同相放大器的输入端与所述第一功率管的第二端连接，所述第二电容的第二端接地；所述第一电流源的电流大小为所述第二电流源的电流大小的两倍。可选地，所述电流误差放大电路包括第一误差放大器、第一与门、第一电流源、第二电流源、第二电容、第一开关和第二开关；所述第一误差放大器的正相输入端与所述第一功率管的第二端连接，所述第一误差放大器的反相输入端与所述检测功率管的第二端连接，所述第一误差放大器输出端与所述第一与门的第一输入端连接，所述第一与门的第二输入端与所述第一功率管的受控端连接，所述第一与门的输出端和所述第一开关的受控端连接，所述第一开关的第一端、所述第一电流源的输出端、所述第二电流源的输入端、所述第二电容的第一端和所述电压跟随器的正相输入端连接，所述电压跟随器的反相输入端和所述电压跟随器的输出端连接构成所述电流误差放大电路的信号输出端，所述第一电流源的输入端与正电源端连接，所述第二电流源的输出端与所述第二开关的第一端连接，所述第二开关的第二端接地，所述第二开关的受控端与所述第一功率管的受控端连接，所述第二电容的第二端接地；所述第一电流源的电流大小为所述第二电流源的电流大小的两倍。可选地，所述反馈调节充电电路还包括：电压误差放大电路，与所述BUCK降压电路的输出端连接，所述电压误差放大电路，用于将所述BUCK降压电路的输出电压与预设参考电压进行比较，并输出预设大小的第二误差电压信号；其中，第三电压差值与第四电压差值呈负相关变化，所述第三电压差值为所述BUCK降压电路的输出电压与预设参考电压的电压差值，所述第四电压差值为所述第二误差电压信号与第二目标误差电压信号的电压差值；误差信号选择电路，分别与所述电压误差放大电路、所述电流误差放大电路和所述PWM驱动电路连接，所述误差信号选择电路，用于：将所述第一误差电压信号和所述第二误差电压信号进行比较；并在所述第一误差电压信号小于所述第二误差电压信号时，选择输出所述第一误差电压信号；以及在所述第二误差电压信号小于所述第一误差电压信号时，选择输出所述第二误差电压信号。可选地，所述电压误差放大电路包括第二误差放大器；所述第二误差放大器的反相输入端与所述BUCK降压电路输出端连接，所述第二误差放大器的正相输入端用于输入所述预设参考电压，所述第二误差放大器的输出端构成所述电压误差放大电路的信号输出端。可选地，所述误差信号选择电路包括第一二极管、第二二极管、第三电容和第三电流源；所述第一二极管的阴极与所述电流误差放大电路的信号输出端连接，所述第二二极管的阴极与所述电压误差放大电路的信号输出端连接，所述第一二极管的阳极、所述第二二极管的阳极、所述第三电容的第一端和所述第三电流源的输出端共接，所述第三电容的第二端接地，所述第三电流源的输入端与正电源端连接。可选地，所述PWM驱动电路包括比较器、第二同相放大器和第二反相放大器；所述比较器的正相输入端与所述电压源电路连接，所述比较器的反相输入端用于输入三角波参考信号，所述比较器的输出端、所述第二同相放大器的输入端和所述第二反相放大器的输入端连接，所述第二同相放大器的输出端与所述第一功率管的受控端连接，所述第二反相放大器的输出端与所述第二功率管的受控端连接。可选地，所述PWM驱动电路包括比较器、触发器、第三同相放大器和第四同相放大器；所述比较器的反相输入端与所述电压源电路连接，所述比较器的正相输入端用于输入第一功率管的电流和和谐波补偿电流，所述比较器的输出端与所述触发器的输入端连接，所述触发器的时钟输入端用于输入时钟信号，所述触发器的输出端与所述第三同相放大器的输入端连接，所述触发器的反相输出端与所述第四同相放大器的输入端连接，所述第三同相放大器的输出端与所述第一功率管的受控端连接，所述第四同相放大器的输出端与所述第二功率管的受控端连接。本申请实施例的第二方面提出了一种电子设备，包括如上所述的反馈调节充电电路。本申请实施例与现有技术相比存在的有益效果是：上述的反馈调节充电电路通过设置检测管和参考电流源生成电流检测电路，其中，第一功率管导通时的平均电流等于BUCK降压电路的输出电流，电流误差放大电路对第一功率管导通时的平均电流和N倍的参考电流的大小进行误差比较，根据比较结果对PWM驱动电路的电压误差信号以及PWM驱动信号的占空比进行负反馈调节，从而实现对反馈调节充电电路的恒流控制输出，并且检测功率管的导通内阻等于第一功率管的导通内阻的N倍，稳态时，参考电流等同于第一功率管导通时的平均电流的1/N倍，电流检测电路引起的功率损耗小，提高了恒流充电的控制精度。附图说明图1为本申请实施例提供的BUCK降压电路的第一种结构示意图；图2为本申请实施例提供的BUCK降压电路的第二种结构示意图；图3为本申请实施例提供的反馈调节充电电路的第一种结构示意图；图4为本申请实施例提供的反馈调节充电电路的第二种结构示意图；图5为本申请实施例提供的反馈调节充电电路的第三种结构示意图；图6为本申请实施例提供的反馈调节充电电路的第四种结构示意图；图7为本申请实施例提供的反馈调节充电电路的第五种结构示意图；图8为本申请实施例提供的反馈调节充电电路的第六种结构示意图；图9为本申请实施例提供的反馈调节充电电路的第七种结构示意图；图10为本申请实施例提供的反馈调节充电电路的第八种结构示意图。其中，图中各附图标记为：10、BUCK降压电路；20、电流检测电路；30、电流误差放大电路；40、PWM驱动电路；50、电压误差放大电路；60、误差信号选择电路；Q1、第一功率管；Q2、功率开关管；Q3、检测功率管；L、电感；ICHG_REF、参考电压源；U1、第一误差放大器；U2、第一与门；U3、第二与门；U4、第一反相放大器；U5、电压跟随器；U6、第二误差放大器；U7、比较器；U11、第一同相放大器；U9、第二反相放大器；U10、触发器；U8、第二同相放大器；U12、第三同相放大器；U13、第四同相放大器；D1、第一二极管；D2、第二二极管；D11、功率二极管；C1、第一电容；C2、第二电容；C3、第三电容；IS0、参考电流源；IS1、第一电流源、IS2，第二电流源；IS3，第三电流源；K1、第一开关；K2、第二开关。具体实施方式为了使本申请所要解决的技术问题、技术方案及有益效果更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本申请的描述中，“多个”的含义是两个或两个以上，除非另有明确具体的限定。本申请实施例的第一方面提出了一种反馈调节充电电路，通过检测比较功率管的第一功率管导通时的平均电流大小实现恒流控制功能。如图3所示，本实施例中，反馈调节充电电路包括BUCK降压电路10、PWM驱动电路40、电流检测电路20和电流误差放大电路30。其中，BUCK降压电路10包括第一功率管Q1、第二功率管、电感L和第一电容C1，第一功率管Q1的第一端构成BUCK降压电路10的电源输入端并用于输入直流电源，第一功率管Q1的第二端、第二功率管的第一端和电感L的第一端共接，第二功率管的第二端接地，电感L的第二端和第一电容C1的第一端连接构成BUCK降压电路10的电源输出端，第一电容C1的第二端接地，BUCK降压电路10为对应储能负载供电，例如为带有电池的各种设备器件，例如智能手机、充电宝、笔记本等设备，具体受电负载类型不限。其中，第一功率管Q1为对应类型的功率开关管，如图1和图2所示，第二功率管可为对应类型的功率开关管Q2或者功率二极管D11，当为功率开关管Q2时，功率开关管Q2的第一端、第二端、控制端分别为第二功率管的第一端、第二端、控制端。当第二功率管为功率二极管D11时，功率二极管D11的阴极为第二功率管的第一端，功率二极管D11的阳极为第二功率管的第二端。当第二功率管为功率开关管Q2时，根据降压原理，第一功率管Q1和功率开关管Q2分别接收一路PWM驱动信号，并交错导通和关断，即第一功率管Q1导通且功率开关管Q2关断时，电源输入端VIN、第一功率管Q1、电感L、第一电容C1构成充电环路，电感L充电，电感L电流上升，第一功率管Q1的导通电流等于电感L电流，第一功率管Q1关断且功率开关管Q2导通时，功率开关管Q2、电感L和第一电容C1构成放电环路，降压输出，电感L电流下降，第一功率管Q1的导通电流等于电感L电流，因此，电感L电流的平均值也就是负载的充电电流，等于第一功率管Q1导通时的平均电流，第一功率管Q1和功率开关管Q2采用MOS功率管。或者当第二功率管为功率二极管D11时，第一功率管Q1导通时，电源输入端VIN、第一功率管Q1、电感L、第一电容C1构成充电环路，电感L充电，电感L电流上升，第一功率管Q1的导通电流等于电感L电流，第一功率管Q1关断时，功率二极管D11、电感L和第一电容C1构成放电环路，降压输出，电感L电流下降，第一功率管Q1的导通电流等于电感L电流，因此，电感L电流的平均值也就是负载的充电电流，等于第一功率管Q1导通时的平均电流。基于此，如图3所示，以第二功率管为功率开关管Q2为例，本实施例中，设置了由检测功率管Q3和参考电流源IS0构成的电流检测电路20，检测功率管Q3为与第一功率管Q1同类型的MOS管，检测功率管Q3的第一端与第一功率管Q1的第一端连接，检测功率管Q3的受控端与第一功率管Q1的受控端连接，检测功率管Q3的第二端与参考电流源IS0连接，参考电流源IS0用于输出参考电流ICHG_REF，检测功率管Q3与第一功率管Q1按变比匹配，其中，第一功率管Q1的大小是检测功率管Q3的N倍，检测功率管Q3的导通内阻Rdson_Q3等于第一功率管Q1的导通内阻Rdson_Q1的N倍，参考电流源IS0的参考电流ICHG_REF流过检测功率管Q3的压降为，第一功率管Q1的电流IQ1流过第一功率管Q1产生的压降是，当检测功率管Q3和第一功率管Q1上产生的压降相等时，流过第一功率管Q1的瞬间电流是: IQ1 = ICHG_REF*=ICHG_REF*N，1/N是电流取样倍数，N＞1，实际应用中，N一般大于1000甚至达10000以上，即N≥103，因此，检测功率管Q3和第一功率管Q1的大小和成本相比很小，可以忽略不计，同时，ICHG_REF的电流是第一功率管Q1电流的1/N倍，因此，电流检测电路20引起的功率损耗小，可忽略不计，近似无功率损耗，无外加器件成本，实现了高控制精度和低成本的电流检测方法。PWM驱动电路40分别与第一功率管Q1、功率开关管Q2和电流误差放大电路30连接，PWM驱动电路40，用于根据电流误差放大电路30输出的电压误差信号产生两路对应大小占空比的PWM驱动信号，两路PWM驱动信号输出至第一功率管Q1和功率开关管Q2，从而控制第一功率管Q1和功率开关管Q2交错导通和关断，第一功率管Q1的占空比大小与电压误差信号的大小呈正相关变化，即当接收到的电压误差信号大时，第一功率管Q1的占空比大，功率开关管Q2的占空比小，第一功率管Q1单个驱动周期内导通时间长，第一功率管Q1导通时的平均电流以及负载的充电电流增大，当接收到的电压误差信号小时，第一功率管Q1的占空比小，功率开关管Q2的占空比大，第一功率管Q1单个驱动周期内导通时间短，第一功率管Q1导通时的平均电流以及负载的充电电流减小。电流误差放大电路30分别与检测功率管Q3的第二端、第一功率管Q1的第二端和PWM驱动电路40连接，电流误差放大电路30比较第一功率管Q1导通时的平均电流和N倍的参考电流ICHG_REF的大小，并输出预设大小的第一误差电压信号；其中，第一电压差值与第二电压差值呈负相关变化，第一电压差值为第一功率管Q1导通时的平均电流和N倍的参考电流的电压差值，第二电压差值为第一误差电压信号与第一目标误差电压信号的电压差值。即PWM驱动电路40输出的PWM驱动信号的占空比与接收到的第一误差电压信号为正相关变化，电流误差放大电路30基于第一功率管Q1导通时的平均电流进行负反馈调节，当第一功率管Q1导通时的平均电流变大时，第一功率管Q1导通时的平均电流与采样电压的第一电压差值变大，则第一误差电压信号变小，使得第一误差电压信号与第一目标误差电压信号的差值变小，实现负反馈调节，PWM驱动电路输出至第一功率管Q1的占空比变小，第一功率管Q1导通时的平均电流变小，反之，当第一功率管Q1导通时的平均电流变小时，第一功率管Q1导通时的平均电流与采样电压的第一电压差值变小，则第一误差电压信号变大，使得第一误差电压信号与第一目标误差电压信号变大，实现负反馈调节，PWM驱动电路40输出至第一功率管Q1的占空比变大，第一功率管Q1导通时的平均电流变大，通过负反馈调节，第一功率管Q1导通时的平均电流逐步稳定至N倍的参考电流ICHG_REF。具体地，将N倍的参考电流ICHG_REF作为恒流充电的恒流参考值，并在第一功率管Q1导通时的平均电流等于N倍的参考电流ICHG_REF时维持输出第一目标误差电压信号，使得当前PWM驱动电路40根据第一目标误差电压信号维持第一功率管Q1和功率开关管Q2的占空比达到匹配的预设占空比，以及使得第一功率管Q1导通时的平均电流达到N倍的参考电流ICHG_REF。即第一目标误差电压信号与N倍的参考电流ICHG_REF呈映射关系，在第一目标误差电压信号输出至PWM驱动电路40后，PWM驱动电路40分别输出第一预设占空比和第二预设占空比的PWM驱动信号至第一功率管Q1和功率开关管Q2，第一功率管Q1根据第一预设占空比生成与N倍的参考电流ICHG_REF相等的第一功率管Q1导通时的平均电流。以及在当前的第一功率管Q1导通时的平均电流小于N倍的参考电流ICHG_REF时，即当前第一功率管Q1的占空比小于第一预设占空比，电流误差放大电路30输出比第一目标误差电压信号大的第一误差电压信号，提高第一功率管Q1的占空比，将第一功率管Q1导通时的平均电流拉升至N倍的参考电流ICHG_REF，实现恒流控制。以及在第一功率管Q1导通时的平均电流大于N倍的参考电流ICHG_REF时，表明当前输出至PWM驱动电路40的电压误差信号过大，输出至第一功率管Q1的PWM驱动信号的占空比大于第一预设占空比，此时，电流误差放大电路30将输出比第一目标误差电压信号小的第一电压误差信号，进而拉低第一功率管Q1的PWM驱动信号的占空比，实现恒流控制。电流误差放大电路30的输入参考量为N倍的参考电流ICHG_REF和第一功率管Q1导通时的平均电流，当N倍的参考电流ICHG_REF和第一功率管Q1导通时的平均电流相等时，电流误差放大电路30达到稳态，误差信号停止积分。为了提高充电安全性和减少杂波干扰，BUCK降压电路10的前端还可设置防反灌电路，防止负载电流反灌至电源输入端，防反灌电路可采用功率管、二极管等结构，同时，还可设置输入滤波电路，以对输入的直流电源进行滤波处理，减少杂波干扰。其中，负载充电通常包括恒流充电和恒压充电两个连续过程，恒流充电时，负载电压逐步上升，直至负载电压达到负载工作电压时，切换至恒压充电，此时，负载电流逐步下降，预设时段后，负载完成充电。因此，为了实现恒压充电，保证负载可靠充电至负载工作电压，可选地，如图3所示，反馈调节充电电路还包括：电压误差放大电路50，与BUCK降压电路10的输出端连接，电压误差放大电路50，用于将BUCK降压电路10的输出电压与预设参考电压进行比较，并输出预设大小的第二误差电压信号；其中，第三电压差值与第四电压差值呈负相关变化，第三电压差值为BUCK降压电路10的输出电压与预设参考电压的电压差值，第四电压差值为第二误差电压信号与第二目标误差电压信号的电压差值；误差信号选择电路60，分别与电压误差放大电路50、电流误差放大电路30和PWM驱动电路40连接，误差信号选择电路60，用于：将第一误差电压信号和第二误差电压信号进行比较；并在第一误差电压信号小于第二误差电压信号时，选择输出第一误差电压信号；以及在第二误差电压信号小于第一误差电压信号时，选择输出第二误差电压信号。本实施例中，负载充电过程为，先恒流充电，恒流充电过程中，电压逐步上升，并在负载电压达到预设参考电压时，恒压充电，恒压充电过程中，电流逐步下降，因此，恒流充电过程中，BUCK降压电路10的输出电压小于预设参考电压，第二误差电压信号大于第二目标误差电压信号，且大于第一误差电压信号，此时，误差信号选择电路60选择第一误差电压信号输出，并进行恒流充电控制，并在第一功率管Q1导通时的平均电流大于N倍的参考电流ICHG_REF时，表明当前输出至PWM驱动电路40的电压误差信号过大，输出至第一功率管Q1的PWM驱动信号的占空比大于第一预设占空比，此时，电流误差放大电路30将输出比第一目标误差电压信号小的第一电压误差信号，进而拉低第一功率管Q1的PWM驱动信号的占空比，实现恒流控制。以及在当前的第一功率管Q1导通时的平均电流小于或者等于N倍的参考电流ICHG_REF时，即当前第一功率管Q1的占空比小于或者等于第一预设占空比，此时，第一误差电压信号大于第一目标误差电压信号，且大于第二误差电压信号，误差信号选择电路60选择输出第二误差电压信号，由恒流充电控制切换至恒压充电控制。恒压充电控制时，电压误差放大电路50将BUCK降压电路10的输出电压与预设参考电压进行比较，在负载电压上升至负载工作电压时，即BUCK降压电路10的输出电压大于或者等于预设参考电压时，表明此时已经满足恒压充电条件，电压误差放大电路50将第二误差电压信号拉低至第二目标误差电压信号，降低第一功率管Q1的占空比，从而实现恒压输出控制。其中，电压误差放大电路50可采用对应的电压误差放大器等结构，如图4所示，可选地，电压误差放大电路50包括第二误差放大器U6；第二误差放大器U6的反相输入端与BUCK降压电路10输出端连接，第二误差放大器U6的正相输入端用于输入预设参考电压，第二误差放大器U6的输出端构成电压误差放大电路50的信号输出端。当BUCK降压电路10的输出电压小于预设参考电压时，表明当前负载电压未达到负载工作电压，此时，由电流误差放大电路30进行恒流输出控制，PWM驱动电路40根据接收到的第一误差电压信号进行负反馈恒流控制，BUCK降压电路10继续恒流充电，负载电压继续上升。以及在负载电压上升至负载工作电压时，即BUCK降压电路10的输出电压接近预设参考电压时，表明此时已经满足恒压充电条件，第二误差放大器U6输出降低，将电流误差放大电路30的第二误差电压信号拉低至第二目标误差电压信号，降低第一功率管Q1的占空比，从而实现恒压输出控制。误差信号选择电路60可采用信号选择器或者比较器、二极管等结构，为了简化线路结构，降低设计成本，如图4所示，误差信号选择电路60包括第一二极管D1、第二二极管D2、第三电容C3和第三电流源IS3；第一二极管D1的阴极与电流误差放大电路30的信号输出端连接，第二二极管D2的阴极与电压误差放大电路50的信号输出端连接，第一二极管D1的阳极、第二二极管D2的阳极、第三电容C3的第一端和第三电流源IS3的输出端共接，第三电容C3的第二端接地，第三电流源IS3的输入端与正电源端VCC连接。本实施例中，恒流充电过程中，电压逐步上升，BUCK降压电路10的输出电压小于预设参考电压，第二误差电压信号大于第二目标误差电压信号，且大于第一误差电压信号，此时，第一二极管D1正向导通，第二二极管D2反向截止，误差信号选择电路60选择第一误差电压信号输出，并进行恒流充电控制。以及在当前的第一功率管Q1导通时的平均电流小于或者等于N倍的参考电流ICHG_REF时，即当前第一功率管Q1的占空比小于或者等于第一预设占空比，此时，第一误差电压信号大于第一目标误差电压信号，且大于第二误差电压信号，此时，第一二极管D1反向截止，第二二极管D2正向导通，误差信号选择电路60选择输出第二误差电压信号，由恒流充电控制切换至恒压充电控制。恒压充电控制时，电压误差放大电路50将BUCK降压电路10的输出电压与预设参考电压进行比较，在负载电压上升至负载工作电压时，即BUCK降压电路10的输出电压大于或者等于预设参考电压时，表明此时已经满足恒压充电条件，电压误差放大电路50将第二误差电压信号拉低至第二目标误差电压信号，降低第一功率管Q1的占空比，从而实现恒压输出控制。PWM驱动电路40可采用对应的PWM生成电路和驱动器，可选地，如图5所示，PWM驱动电路40包括比较器U7、第二同相放大器U8和第二反相放大器U9；比较器U7的正相输入端与电压源电路32连接，比较器U7的反相输入端用于输入三角波参考信号，比较器U7的输出端、第二同相放大器U8的输入端和第二反相放大器U9的输入端连接，第二同相放大器U8的输出端与第一功率管Q1的受控端连接，第二反相放大器U9的输出端与第二功率管的受控端连接。本实施例中，比较器U7将接收到的电压误差信号与三角波参考信号进行比较并生成对应的比较信号，比较信号经过第二同相放大器U8和第二反相放大器U9分别同相放大和反相放大后，输出第一PWM驱动信号和第二PWM驱动信号。当接收到的电压误差信号大时，输出的比较信号的占空比大，输出至第一功率管Q1的第一PWM驱动信号的占空比大，输出至第二功率管的第二PWM驱动信号的占空比小，反之，当接收到的电压误差信号小时，输出的比较信号的占空比小，第一PWM驱动信号的占空比小，第二PWM驱动信号的占空比大。当电流误差放大电路的电流环路或者电压误差放大电路的电压环路达到稳态输出时，第二同相放大器U8输出预设占空比的PWM驱动信号至第一功率管Q1，第二反相放大器U9则输出预设占空比的PWM驱动信号至第二功率管，使得第一功率管Q1导通时的平均电流达到N倍的参考电流ICHG_REF，实现恒流输出控制，或者使得稳压电路10的输出电压达到预设参考电压，实现恒压输出控制。在另一实施例中，为了实现电流峰值保护，PWM驱动电路40切换为带峰值电流控制模式，如图7所示，可选地，PWM驱动电路40包括比较器U7、触发器U10、第三同相放大器U12和第四同相放大器U13；比较器U7的反相输入端与电压源电路32连接，比较器U7的正相输入端用于输入第一功率管Q1的电流和和谐波补偿电流，比较器U7的输出端与触发器U10的输入端连接，触发器U10的时钟输入端用于输入时钟信号，触发器U10的输出端与第三同相放大器U12的输入端连接，触发器U10的反相输出端与第四同相放大器U13的输入端连接，第三同相放大器U12的输出端与第一功率管Q1的受控端连接，第四同相放大器U13的输出端与第二功率管的受控端连接。本实施例中，PWM驱动电路40替换为带峰值电流反馈和谐波补偿的PWM调制单元，时钟信号上升沿输入至触发器U10的时钟输入端时，触发器U10置位，产生第二功率管的关断信号和第一功率管Q1的导通信号，此时，第一功率管Q1的电流和谐波补偿电流叠加后形成的电压信号和电压误差信号进行比较，当第一功率管Q1的电流和谐波补偿电流叠加后形成的电压信号之和大于电压误差信号时，比较器U7输出信号复位触发器U10，第一功率管Q1关断，第二功率管导通，实现峰值保护，且具有环路易补偿的优点。电流误差放大电路30可采用对应的误差放大电路、比较电路等，可选地，如图5和图7所示，电流误差放大电路30包括第一误差放大器U1、第一与门U2、第二与门U3、第一反相放大器U4、第一电流源IS1、第二电流源IS2、第一开关K1、第二开关K2、第二电容C2和电压跟随器U5；第一误差放大器U1的正相输入端与第一功率管Q1的第二端连接，第一误差放大器U1的反相输入端与检测功率管Q3的第二端连接，第一误差放大器U1输出端与第一与门U2的第一输入端连接，第一与门U2的第二输入端与第一功率管Q1的第二端连接，第一与门U2的输出端和第一开关K1的受控端连接，第一开关K1的第一端、第一电流源IS1的输出端、第二电流源IS2的输入端、第二电容C2的第一端和电压跟随器U5的正相输入端连接，电压跟随器U5的反相输入端和电压跟随器U5的输出端连接构成电流误差放大电路30的信号输出端，第一电流源IS1的输入端与正电源端连接，第二电流源IS2的输出端与第二开关K2的第一端连接，第二开关K2的第二端接地，第二开关K2的受控端与第二与门U3的输出端连接，第二电容C2的第二端接地；第一反相放大器U4的输入端与第一与门U2的输出端连接，第一反相放大器U4的输出端与第二与门U3的第一输入端连接，第二与门U3的第二输入端与第一功率管Q1的第二端连接。或者，如图8所示，第一反相放大器U4的输入端与第一误差放大器U1的输出端连接，第一反相放大器U4的第二端与第二与门U3的第一输入端连接，第二与门U3的第二输入端与第一功率管Q1的受控端连接；第一电流源IS1的电流大小等于第二电流源IS2的电流大小，均为IS。本实施例中，第一误差放大器U1的输出信号为A，如图6所示，信号B可以为SW的电压信号或者如图6所示中的第一功率管Q1的驱动信号同步生成，信号A和信号B相与产生信号SA，信号B与信号SA的非相与产生信号SB，信号SA和信号SB分别控制图中的第一开关K1和第二开关K2，当第一功率管Q1导通时的平均电流等于N*ICHG_REF信号时，信号SA和信号SB的脉宽大小为第一功率管Q1的控制信号Ctr1和输出信号SW的脉宽的50%，第一开关K1和第二开关K2高电平闭合。当第一开关K1闭合时，第一电流源IS1向第二电容C2充电，节点电压Vcerr上升。同理，当第二开关K2闭合时，第二电流源IS2向第二电容C2放电，节点电压Vcerr下降。第一开关K1和第二开关K2的导通时间共同决定了节点电压Vcerr的上升和下降。如图6所示，当第一功率管Q1的电流的中点值即第一功率管Q1导通时的平均电流大于N*ICHG_REF时，说明电感L电流的平均值大于N倍的参考电流ICHG_REF，信号SA的脉宽小于信号信号SB的脉宽，则第一开关K1的导通时间小于第二开关K2的导通时间，第二电容C2的充电电流小于放电电流，节点电压Vcerr下降，当节点电压Vcerr小于电压误差放大电路50输出的第二误差电压信号时，第一二极管D1正向导通，第一电压误差信号跟随节点电压Vcerr下降，第一功率管Q1的占空比减小，驱使电感L的平均电流降低。以及当第一功率管Q1导通时的平均电流小于N*ICHG_REF时，说明电感L电流的平均值小于N倍的参考电流ICHG_REF，信号SA的脉宽大于信号信号SB的脉宽，则第一开关K1的导通时间大于第二开关K2的导通时间，第二电容C2的充电电流大于放电电流，节点电压Vcerr上升，如果节点电压Vcerr高于电压源电路32的电压误差信号时，由于第一二极管的存在，则电流环对电流不做控制调节，此时，由电压误差放大电路50进行恒压输出控制，即输出第二误差电压信号至PWM驱动电路40。第一误差放大器U1将电流给定信号N*ICHG_REF和第一功率管Q1导通时的平均电流比较，产生SA和SB两个脉冲信号，这两个脉冲信号控制对应的第一开关K1和第二开关K2，产生输出电流误差信号，并通过第二电容C2转换为第一电压误差信号，即节点电压Vcerr，该第一电压误差信号通过误差信号选择电路60输出至PWM驱动电路40，进而调制产生PWM驱动信号，调节占空比从而控制实现充电电流的闭环负反馈控制。当电感L电流的第一功率管Q1导通时的平均电流和N*ICHG_REF相等时，SA和SB的脉宽相等，第一开关K1的导通时间等于第二开关K2的导通时间，第二电容C2的充电电流等于放电电流，也即闭环系统达到稳态时，误差信号停止积分，节点电压Vcerr和输出至PWM驱动电路的误差电压信号维持不变，实现稳态恒流输出。如图9所示，在又一可选实施例中，电流误差放大电路30包括第一误差放大器U1、第一与门U2、第一同相放大器U11、第一电流源IS1、第二电流源IS2、第一开关K1、第二开关K2、第二电容C2和第一二极管D1；第一误差放大器U1的正相输入端与第一功率管Q1的第二端连接，第一误差放大器U1的反相输入端与检测功率管Q3的第二端连接，第一误差放大器U1输出端与第一与门U2的第一输入端连接，第一与门U2的第二输入端与第一功率管Q1的第二端连接，第一与门U2的输出端和第一开关K1的受控端连接，第一开关K1的第一端、第一电流源IS1的输出端、第二电流源IS2的输入端、第二电容C2的第一端和电压跟随器U5的正相输入端连接，电压跟随器U5的反相输入端和电压跟随器U5的输出端连接构成电流误差放大电路30的信号输出端，第一电流源IS1的输入端与正电源端连接，第二电流源IS2的输出端与第二开关K2的第一端连接，第二开关K2的第二端接地，第二开关K2的受控端与第一同相放大器U11的输出端连接，第一同相放大器U11的输入端与第一功率管Q1的第二端连接，第二电容C2的第二端接地；第一电流源IS1的电流大小与第二电流源IS2的电流大小的两倍，第一电流源IS1的电流大小为2*IS，第二电流源IS1的电流大小为IS。本实施例中，相较于图5和图7的主要区别在于，第一电流源IS1与第二电流源IS2的比值为2，第一开关K1由控制信号SA控制，第二开关K2由SW经过缓冲后的信号SW_C控制，参见图6所示，SW的脉宽等于信号SA的两倍，因此，当第一电流源IS1与第二电流源IS2的比值为2时，即SA*2*IS=SW*IS，第一开关K1和第二开关K2对第二电容C2的充放电电流刚好相等，闭环系统达到稳态，并且此时对应的第一功率管Q1导通时的平均电流等于N倍的参考电流ICHG_REF，从而实现对电感L的平均电流的检测和调节。如图10所示，在又一可选实施例中，可选地，电流误差放大电路30包括第一误差放大器U1、第一与门U2、第一电流源IS1、第二电流源IS2、第二电容C2、第一开关K1和第二开关K2；第一误差放大器U1的正相输入端与第一功率管Q1的第二端连接，第一误差放大器U1的反相输入端与检测功率管Q3的第二端连接，第一误差放大器U1输出端与第一与门U2的第一输入端连接，第一与门U2的第二输入端与第一功率管Q1的受控端连接，第一与门U2的输出端和第一开关K1的受控端连接，第一开关K1的第一端、第一电流源IS1的输出端、第二电流源IS2的输入端、第二电容C2的第一端和电压跟随器U5的正相输入端连接，电压跟随器U5的反相输入端和电压跟随器U5的输出端连接构成电流误差放大电路30的信号输出端，第一电流源IS1的输入端与正电源端连接，第二电流源IS2的输出端与第二开关K2的第一端连接，第二开关K2的第二端接地，第二开关K2的受控端与第一功率管Q1的受控端连接，第二电容C2的第二端接地，第一二极管D1的阳极与电压源电路32连接；第一电流源IS1的电流大小与第二电流源IS2的电流大小的两倍，第一电流源IS1的电流大小为2*IS，第二电流源IS1的电流大小为IS。本实施例中，相较于图9所示，第二开关K2的驱动信号直接由第一功率管Q1的PWM驱动信号Ctr1提供，其工作原理等同于图10所示，同样，第一电流源IS1和第二电流源IS2的电流，第一开关K1由控制信号SA控制，第二开关K2由第一功率管Q1的PWM驱动信号Ctr1控制，参见图6所示，Ctr1的脉宽等于信号SA的两倍，因此，当第一电流源IS1与第二电流源IS2的比值为2时，即SA*2*IS=Ctr1*IS，第一开关K1和第二开关K2对第二电容C2的充放电电流刚好相等，闭环系统达到稳态，并且此时对应的第一功率管Q1导通时的平均电流等于N倍的参考电流ICHG_REF，从而实现对电感L的平均电流的检测和调节。本申请实施例与现有技术相比存在的有益效果是：上述的反馈调节充电电路通过设置检测管和参考电流源IS0生成电流检测电路20，其中，第一功率管Q1导通时的平均电流等于BUCK降压电路10的输出电流，电流误差放大电路30对第一功率管Q1导通时的平均电流和N倍的参考电流ICHG_REF的大小进行误差比较，根据比较结果对PWM驱动电路40的电压误差信号以及PWM驱动信号的占空比进行负反馈调节，从而实现对反馈调节充电电路的恒流控制输出，并且检测功率管Q3的导通内阻等于第一功率管Q1的导通内阻的N倍，检测功率管Q3体积可设计为第一功率管Q1的1/N倍，检测成本低，同时稳态时，参考电流ICHG_REF等同于第一功率管Q1导通时的平均电流的1/N倍，电流检测电路20引起的功率损耗小，提高了恒流充电的控制精度。本申请还提出一种电子设备，该电子设备包括反馈调节充电电路，该反馈调节充电电路的具体结构参照上述实施例，由于本电子设备采用了上述所有实施例的全部技术方案，因此至少具有上述实施例的技术方案所带来的所有有益效果，在此不再一一赘述。本实施例中，通过采用反馈调节充电电路，实现了低成本和高精度的电流采样、恒流充电控制和恒压充电控制工作，电子设备可为对应的充电装置，例如充电器、适配器等，电子设备还可为包括负载在内的储能装置，例如充电宝、手机、平板等结构，负载为对应的电池结构，电子设备的具体结构和类型不限。以上所述实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的精神和范围，均应包含在本申请的保护范围之内。
