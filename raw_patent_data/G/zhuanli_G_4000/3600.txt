标题title
5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法
摘要abst
本发明公开了5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法，基于用户在医疗资讯平台上点击和跳过行为序列，预测用户点击一个医疗资讯的概率。本发明分为七个部分：第一部分是挖掘出用户正负隐式反馈行为序列中的图结构，并找到正负隐式反馈行为序列中的噪音；第二部分是计算用户正负反馈关联图结构，并结合用户正反馈图结构和负反馈图结构，得到涉及用户所有行为的图结构；第三部分是采用图神经网络更新医疗资讯向量表示；第四部分是采用序列编码器得到用户的正反馈序列向量和用户的负反馈序列向量；第五部分是得到用户向量；第六部分是预测用户对目标医疗资讯的点击率；第七部分是根据模型特性，设计损失函数。
权利要求书clms
1.5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法，其特征在于：挖掘出用户正负隐式反馈行为序列中的图结构，并找到正负隐式反馈行为序列中的噪音；在医疗资讯推荐场景中，用户正隐式反馈行为是点击行为，用户负隐式反馈行为是跳过行为；用户集合是U，医疗资讯集合是V，用户点击行为序列表示为用户的跳过行为序列表示为/＞其中l1和l2分别是用户的点击行为序列和跳过行为序列的长度，且pi和ni∈V；对于任一被点击的医疗资讯pi，它的向量表征为/＞对于任一被跳过的医疗资讯pi，它的向量表征为/＞以用户正面隐式反馈行为序列为例，该过程为：采用聚类的思想从正面隐式反馈行为序列中挖掘出图结构，通过计算序列中任意两个医疗资讯之间的相似度得到一个全连接的图结构，图结构中边的值就是医疗资讯之间的相似度；然后设置图稀疏度ε，保留值排名前ε·l12的边，具体公式为：其中，Spp是一个全连接图结构，表示图中任意两个医疗资讯pi和pj之间边的值为这两个医疗资讯的cosine相似度，w是模型训练向量参数，⊙表示元素级别的乘法；Mpp图结构是对Spp图结构进行过滤，保留值较高的边，使得图稀疏度为ε；也就是，对Spp图中的边按照值由大到小进行排序，保留前ε·l12的边，该功能由函数Top实现；得到Mpp图结构之后，计算图Mpp的度Dpp，度Dpp的计算公式为/＞过滤出Dpp中值排名靠后的资讯节点，即度小的资讯节点，度小的资讯节点说明和别的资讯节点的相似度低，是孤立的，即噪点；本方法把正隐式反馈行为序列中噪音称作潜在负反馈行为，为了区分，用户的负反馈行为叫做真实负反馈行为；噪点的映射计算公式为：其中，Last表示图Mpp中度排名靠后的k个资讯节点，k设置为β·l1；采用同样的流程从用户负隐式反馈行为序列中挖掘出图结构Mnn，并找到负隐式反馈行为序列中噪音映射Maskn；计算用户正负反馈关联图结构，并结合用户正反馈图结构和负反馈图结构，得到涉及用户所有行为的图结构；接下来以潜在负反馈行为和真实负反馈行为之间的关联图结构为例，介绍计算用户正负反馈关联图结构的过程；具体步骤是，先计算正反馈和负反馈序列中医疗资讯的相似度，得到一个全连接的二分图，再利用正隐式反馈行为序列中噪音映射Maskp得到潜在负反馈行为和真实负反馈行为之间的图结构，最后设置图的稀疏度为εnn，即保留值排名前εnn·k·l2的边，计算公式如下：其中，Spn是正反馈和负反馈的全连接二分图，二分图的边的值是正反馈pi和负反馈nj的cosine相似度，w是模型训练向量参，⊙表示元素级别的乘法；Proj函数是对图Spn进行Maskp映射，即只取潜在负反馈行为和真实负反馈行为之间的边，得到图/＞最后对图/＞进行稀疏度设置，稀疏度设置为εnn，保留排名前εnn·k·l2的边，该功能由函数实现，最终得到图Mpn；其中，k是潜在负反馈行为个数，l2是真实负反馈行为个数；采用同样的流程得到潜在正反馈行为和真实正反馈行为之间的关联图结构Mnp；最后，涉及用户所有行为的图结构为：其中，矩阵M就是涉及用户所有行为的图结构的邻接矩阵；进一步对矩阵M进行正则化，得到矩阵D是矩阵M的度；基于涉及用户所有行为的图结构，采用图神经网络更新医疗资讯向量表示；向量更新公式为其中Hl-1是l-1层医疗资讯的向量空间，Hl是l层医疗资讯的向量空间；其中H0是医疗资讯的初始化向量E；最后得到医疗资讯的向量空间为Z＝HL；采用序列编码器得到用户的正反馈序列向量和用户的负反馈序列向量；本方法采用常用的LSTM网络作为序列编码器，得到用户的正反馈序列向量qp和负反馈序列向量qn；其中，是医疗资讯pi在向量空间Z下的向量表示，/＞是医疗资讯ni在向量空间Z下的向量表示；LSTM网络将序列作为输入，最后一层的隐藏层输出作为序列向量；结合用户的正反馈序列向量和用户的负反馈序列向量，得到用户向量；用户的最终向量表示为λ是模型超参数；预测用户对目标医疗资讯的点击率；将用户向量和目标医疗资讯向量连接，然后传入一个双层感知器网络中，预测用户对于目标医疗资讯的点击率；具体如下：其中，enew是目标医疗资讯的向量表征，q是用户向量；表示将两个向量q和enew连接起来；W1是矩阵参数，by和/＞是向量参数，/＞的上标T是向量的转置符号；cy是标量参数；σ是sigmoid激活函数，tanh是tanh激活函数；根据模型特性，设计损失函数；通过用户对目标医疗资讯的点击率预测值计算预测值和真实值y之间的误差，进而使用误差来更新模型参数；采用交叉熵损失函数来指导模型参数的更新过程：其中，y∈{0，1}是真实值，代表用户是否点击了目标医疗资讯；采用Adam优化器更新模型参数。
说明书desc
技术领域本发明属于互联网服务技术领域，尤其是涉及5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法。背景技术5G通信具有超高数据速率和低时延等特点，这使得用户可以很方便地采用移动终端设备观看医疗领域的资讯。然而医疗资讯平台上积累了大量的医疗资讯，用户需要花很多时间才能找到自己感兴趣的医疗资讯。因此，推荐系统显得尤为重要。本方法是一种序列推荐方法，序列推荐方法是根据用户历史交互行为，从中挖掘出用户的喜好，并给用户推荐他感兴趣的医疗资讯。在医疗平台中，用户如果对推荐的医疗资讯感兴趣，可以点击并进行阅览；如果不感兴趣，则可以选择跳过。把用户的点击行为叫做用户的正面隐式反馈，跳过行为叫做用户的负面隐式反馈。现有的推荐方法通常对用户的点击行为进行挖掘，捕捉用户的兴趣，并推荐符合用户兴趣的物品。但是该种方法忽略了用户负面反馈数据中丰富的信息。本方法将用户负面反馈数据也引入推荐系统，不仅可以缓解数据稀疏性，还可以对用户的偏好进行更全面地刻画。但是用户的隐式反馈数据中包含了大量的噪音数据，现有的推荐系统采用的降噪处理是将噪音识别出来，然后把噪音去掉。但是据本方法观察，隐式反馈中的噪音数据通常包含了丰富的用户偏好信息。如用户点击了某医疗资讯，但是却不一定表示用户喜欢该医疗资讯，因为用户是看到了医疗资讯的标题才点进去，可能看到资讯内容后发现和自己想象的不一样，因此又退出去。这样的点击行为就是属于正面隐式反馈中的噪音。同样，负面隐式反馈数据中的噪音也包含了用户偏好的丰富信息，如用户跳过了某条医疗资讯并不一定表示用户不喜欢该医疗资讯，而是可能平台给用户同时展示了多个用户感兴趣的医疗资讯，但是用户只能点击一个资讯或者用户只愿意在一个主题中点击一个资讯。所以，负面反馈中的噪音可能包含了用户的正面兴趣。为了从用户的正面和负面隐式反馈数据中的挖掘出噪音，并将该噪音转化为有价值的信息，本方法提出了5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法。从正面隐式反馈数据中挖掘出代表用户负面兴趣信息的噪音，同样从负面隐式反馈数据中挖掘出代表用户正面兴趣信息的噪音。从用户的正负隐式反馈序列中构建图，进行信息交换，并利用图神经网络的过平滑和降噪作用，将序列中的噪音进行进一步地降噪处理。发明内容本方法的问题定义为基于用户在医疗资讯平台上点击和跳过行为序列，预测用户点击一个医疗资讯的概率。涉及到的数学符号有：用户集合U,医疗资讯集合V。根据患者的点击和跳过行为，可以把患者的行为序列分为正面隐式反馈行为序列和负面隐式反馈行为序列。正面隐式反馈行为序列就是用户的点击行为序列，表示为负面隐式反馈行为序列就是用户的跳过行为序列，表示为/＞其中l1和l2分别是用户的点击行为序列和跳过行为序列的长度，且pi和ni∈V。现有的医疗资讯推荐方法在降噪处理时，通常将噪音识别出来，然后把噪音去掉。但是据本方法观察，隐式反馈中的噪音数据通常包含了丰富的用户偏好信息。如用户点击了某医疗资讯，但是却不一定表示用户喜欢该医疗资讯，因为用户是看到了医疗资讯的标题才点进去，可能看到资讯内容后发现和自己想象得不一样，因此又退出去。这样的点击行为就是属于正面隐式反馈中的噪音。同样，负面隐式反馈数据中的噪音也包含了用户偏好的丰富信息，如用户跳过了某条医疗资讯并不一定表示用户不喜欢该医疗资讯，而是可能平台给用户同时展示了多个用户感兴趣的医疗资讯，但是用户只能点击一个资讯或者用户只愿意在一个主题中点击一个资讯。所以，这样的负面反馈中的噪音包含了用户的正面兴趣。为了从用户的正面和负面隐式反馈数据中的挖掘出噪音，并将该噪音转化为有价值的信息，本方法采用以下技术方案：挖掘出用户正负隐式反馈行为序列中的图结构，并找到正负隐式反馈行为序列中的噪音。在医疗资讯推荐场景中，用户正隐式反馈行为是点击行为，用户负隐式反馈行为是跳过行为。以用户正面隐式反馈行为序列为例，用户集合是U,医疗资讯集合是V,用户点击行为序列表示为用户的跳过行为序列表示为/＞其中l1和l2分别是用户的点击行为序列和跳过行为序列的长度，且pi和ni∈V。对于任一被点击的医疗资讯pi，它的向量表征为/＞对于任一被跳过的医疗资讯pi，它的向量表征为/＞采用聚类的思想从正面隐式反馈行为序列中挖掘出图结构，通过计算序列中任意两个医疗资讯之间的相似度得到一个全连接的图结构，图结构中边的值就是医疗资讯之间的相似度；然后设置图稀疏度ε，保留值排名前ε·l12的边，具体公式为：其中，Spp是一个全连接图结构，表示图中任意两个医疗资讯pi和pj之间边的值为这两个医疗资讯的cosine相似度，w是模型训练向量参数，⊙表示元素级别的乘法。Mpp图结构是对Spp图结构进行过滤，保留值较高的边，使得图稀疏度为ε。也就是，对Spp图中的边按照值由大到小进行排序，保留前ε·l12的边，该功能由函数Top实现。得到Mpp图结构之后，计算图Mpp的度Dpp，度Dpp的计算公式为/＞过滤出Dpp中值排名靠后的资讯节点，即度小的资讯节点，度小的资讯节点说明和别的资讯节点的相似度低，是孤立的，即噪点。本方法把正隐式反馈行为序列中噪音称作潜在负反馈行为，为了区分，用户的负反馈行为叫做真实负反馈行为。噪点的映射计算公式为：其中，Last表示图Mpp中度排名靠后的k个资讯节点，k设置为β·l1。采用同样的流程从用户负隐式反馈行为序列中挖掘出图结构Mnn，并找到负隐式反馈行为序列中噪音映射Maskn。计算用户正负反馈关联图结构，并结合用户正反馈图结构和负反馈图结构，得到涉及用户所有行为的图结构。接下来以潜在负反馈行为和真实负反馈行为之间的关联图结构为例，介绍计算用户正负反馈关联图结构的过程。具体步骤是，先计算正反馈和负反馈序列中医疗资讯的相似度，得到一个全连接的二分图，再利用正隐式反馈行为序列中噪音映射Maskp得到潜在负反馈行为和真实负反馈行为之间的图结构，最后设置图的稀疏度为εnn，即保留值排名前εnn·k·l2的边，计算公式如下：其中，Spn是正反馈和负反馈的全连接二分图，二分图的边的值是正反馈pi和负反馈n.的cosine相似度，w是模型训练向量参，⊙表示元素级别的乘法。Proj函数是对图Spn进行Maskp映射，即只取潜在负反馈行为和真实负反馈行为之间的边，得到图/＞最后对图/＞进行稀疏度设置，稀疏度设置为εnn，保留排名前εnn·k·l2的边，该功能由函数实现，最终得到图Mpn。其中，k是潜在负反馈行为个数，l2是真实负反馈行为个数。采用同样的流程得到潜在正反馈行为和真实正反馈行为之间的关联图结构Mnp。最后，涉及用户所有行为的图结构为：其中，矩阵M就是涉及用户所有行为的图结构的邻接矩阵。进一步对矩阵M进行正则化，得到矩阵D是矩阵M的度。基于涉及用户所有行为的图结构，采用图神经网络更新医疗资讯向量表示。向量更新公式为其中Hl-1是l-1层医疗资讯的向量空间，Hl是l层医疗资讯的向量空间。其中H0是医疗资讯的初始化向量E。最后得到医疗资讯的向量空间为Z＝HL。采用序列编码器得到用户的正反馈序列向量和用户的负反馈序列向量。本方法采用常用的LSTM网络作为序列编码器，得到用户的正反馈序列向量qp和负反馈序列向量qn。其中，是医疗资讯pi在向量空间Z下的向量表示，/＞是医疗资讯ni在向量空间Z下的向量表示。LSTM网络将序列作为输入，最后一层的隐藏层输出作为序列向量。结合用户的正反馈序列向量和用户的负反馈序列向量，得到用户向量。用户的最终向量表示为q＝λqp+qn，λ是模型超参数。预测用户对目标医疗资讯的点击率。将用户向量和目标医疗资讯向量连接，然后传入一个双层感知器网络中，预测用户对于目标医疗资讯的点击率。具体如下:其中，ene8是目标医疗资讯的向量表征，q是用户向量。表示将两个向量q和ene8连接起来。W1是矩阵参数，by和/＞是向量参数，/＞的上标T是向量的转置符号。cy是标量参数。σ是sigmoid激活函数，tanh是tanh激活函数。根据模型特性，设计损失函数。通过用户对目标医疗资讯的点击率预测值计算预测值/＞和真实值y之间的误差，进而使用误差来更新模型参数。采用交叉熵损失函数来指导模型参数的更新过程：其中，y∈{0,1}是真实值，代表用户是否点击了目标医疗资讯。采用Adam优化器更新模型参数。本发明的有益技术效果如下：本方法创新性地提出用户的隐式反馈数据中存在噪音，并且噪音也是有价值的。用户的正面隐式反馈数据中可能存在反映用户不感兴趣的信息，同样，用户的负面隐式反馈数据中可能存在反映用户感兴趣的信息。本方法创新性地提出从用户的行为序列中挖掘出涉及到用户全部正负反馈行为的图结构，学习用户同类行为之间的关联，也学习用户正反馈和负反馈行为之间的关联。附图说明图1为本发明5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法的流程示意图；图2为本发明5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法的行为示意图；图3为本发明5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法的矩阵示意图。具体实施方式为了进一步理解本发明，下面结合具体实施方式对本发明提供的5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法进行具体描述，但本发明并不限于此，该领域技术人员在本发明核心指导思想下做出的非本质改进和调整，仍然属于本发明的保护范围。本方法的问题定义为基于用户在医疗资讯平台上点击和跳过行为序列，预测用户点击一个医疗资讯的概率。涉及到的数学符号有：用户集合U,医疗资讯集合V。根据患者的点击和跳过行为，可以把患者的行为序列分为正面隐式反馈行为序列和负面隐式反馈行为序列。正面隐式反馈行为序列就是用户的点击行为序列，表示为负面隐式反馈行为序列就是用户的跳过行为序列，表示为/＞其中l1和l2分别是用户的点击行为序列和跳过行为序列的长度，且pi和ni∈V。5G应用领域中一种考虑用户正负隐式反馈关联的医疗资讯推荐方法主要由七个部分组成。第一部分是挖掘出用户正负隐式反馈行为序列中的图结构，并找到正负隐式反馈行为序列中的噪音；第二部分是计算用户正负反馈关联图结构，并结合用户正反馈图结构和负反馈图结构，得到涉及用户所有行为的图结构；第三部分是基于涉及用户所有行为的图结构，采用图神经网络更新医疗资讯向量表示；第四部分是采用序列编码器得到用户的正反馈序列向量和用户的负反馈序列向量；第五部分是结合用户的正反馈序列向量和用户的负反馈序列向量，得到用户向量；第六部分是预测用户对目标医疗资讯的点击率；第七部分是根据模型特性，设计损失函数。如图1所示，按照本发明的一个实施例，本方法包括如下步骤：S100，挖掘出用户正负隐式反馈行为序列中的图结构，并找到正负隐式反馈行为序列中的噪音。在医疗资讯推荐场景中，用户正隐式反馈行为是点击行为，用户负隐式反馈行为是跳过行为。如图2所示，用户点击行为序列中存在和用户跳过行为接近的噪音，同样，用户跳过行为序列中也存在实际体现了用户喜欢信息的行为，因此本方法从用户的隐式反馈行为中挖掘出噪音。以用户正面隐式反馈行为序列为例，用户集合是U,医疗资讯集合是V,用户点击行为序列表示为用户的跳过行为序列表示为/＞其中l1和l2分别是用户的点击行为序列和跳过行为序列的长度，且pi和ni∈V。对于任一被点击的医疗资讯pi，它的向量表征为/＞对于任一被跳过的医疗资讯pi，它的向量表征为/＞采用聚类的思想从正面隐式反馈行为序列中挖掘出图结构，通过计算序列中任意两个医疗资讯之间的相似度得到一个全连接的图结构，图结构中边的值就是医疗资讯之间的相似度；然后设置图稀疏度ε，保留值排名前ε·l12的边，在本方法中ε设置为0.6，具体公式为：其中，Spp是一个全连接图结构，表示图中任意两个医疗资讯pi和pj之间边的值为这两个医疗资讯的cosine相似度，w是模型训练向量参数，⊙表示元素级别的乘法。Mpp图结构是对Spp图结构进行过滤，保留值较高的边，使得图稀疏度为ε。也就是，对Spp图中的边按照值由大到小进行排序，保留前ε·l12的边，该功能由函数Top实现。得到Mpp图结构之后，计算图Mpp的度Dpp，度Dpp的计算公式为/＞过滤出Dpp中值排名靠后的资讯节点，即度小的资讯节点，度小的资讯节点说明和别的资讯节点的相似度低，是孤立的，即噪点。本方法把正隐式反馈行为序列中噪音称作潜在负反馈行为，为了区分，用户的负反馈行为叫做真实负反馈行为。噪点的映射计算公式为：其中，Last表示图Mpp中度排名靠后的k个资讯节点，k设置为β·l1，且β在本方法重设置为0.1。采用同样的流程从用户负隐式反馈行为序列中挖掘出图结构Mnn，并找到负隐式反馈行为序列中噪音映射Maskn。S200，计算用户正负反馈关联图结构，并结合用户正反馈图结构和负反馈图结构，得到涉及用户所有行为的图结构。接下来以潜在负反馈行为和真实负反馈行为之间的关联图结构为例，介绍计算用户正负反馈关联图结构的过程。具体步骤是，先计算正反馈和负反馈序列中医疗资讯的相似度，得到一个全连接的二分图，再利用正隐式反馈行为序列中噪音映射Maskp得到潜在负反馈行为和真实负反馈行为之间的图结构，最后设置图的稀疏度为εnn，即保留值排名前εnn·k·l2的边，计算公式如下：其中，Sm是正反馈和负反馈的全连接二分图，二分图的边的值是正反馈pi和负反馈nj的cosine相似度，w是模型训练向量参，⊙表示元素级别的乘法。Proj函数是对图Spn进行Maskp映射，即只取潜在负反馈行为和真实负反馈行为之间的边，得到图/＞最后对图/＞进行稀疏度设置，稀疏度设置为εnn，保留排名前εnn·k·l2的边，该功能由函数实现，最终得到图Mpn。其中，k是潜在负反馈行为个数，l2是真实负反馈行为个数。采用同样的流程得到潜在正反馈行为和真实正反馈行为之间的关联图结构Mnp。最后，涉及用户所有行为的图结构为：其中，矩阵M就是涉及用户所有行为的图结构的邻接矩阵。图3为矩阵M的示意图，从图3可以看出矩阵M既体现了用户同类型行为之间的关联，还反映了用户不同类型行为之间的关联。进一步对矩阵M进行正则化，得到矩阵D是矩阵M的度。S300，基于涉及用户所有行为的图结构，采用图神经网络更新医疗资讯向量表示。向量更新公式为其中Hl-1是l-1层医疗资讯的向量空间，Hl是l层医疗资讯的向量空间。其中H0是医疗资讯的初始化向量E。本方法图神经网络层数L设置为2。最后得到医疗资讯的向量空间为Z＝HL。S400，采用序列编码器得到用户的正反馈序列向量和用户的负反馈序列向量。本方法采用常用的LSTM网络作为序列编码器，得到用户的正反馈序列向量qp和负反馈序列向量qn。其中，是医疗资讯pi在向量空间Z下的向量表示，/＞是医疗资讯ni在向量空间Z下的向量表示。LSTM网络将序列作为输入，最后一层的隐藏层输出作为序列向量。S500，结合用户的正反馈序列向量和用户的负反馈序列向量，得到用户向量。用户的最终向量表示为q＝λqp+qn，λ是模型超参数，本方法中设置λ＝0.5。S600，预测用户对目标医疗资讯的点击率。将用户向量和目标医疗资讯向量连接，然后传入一个双层感知器网络中，预测用户对于目标医疗资讯的点击率。具体如下:其中，enew是目标医疗资讯的向量表征，q是用户向量。表示将两个向量q和enew连接起来。W1是矩阵参数，by和/＞是向量参数，/＞的上标/＞是向量的转置符号。cy是标量参数。σ是sigmoid激活函数，tanh是tanh激活函数。S700，根据模型特性，设计损失函数。通过用户对目标医疗资讯的点击率预测值计算预测值/＞和真实值y之间的误差，进而使用误差来更新模型参数。采用交叉熵损失函数来指导模型参数的更新过程：其中，y∈{0,1}是真实值，代表用户是否点击了目标医疗资讯。采用Adam优化器更新模型参数。上述对实施例的描述是为方便于本技术领域的普通技术人员能理解和应用本发明。熟悉本领域技术的人员显然可以容易地对上述实施例做出各种修改，并把在此说明的一般原理应用到其他实施例中而不必经过创造性的劳动。因此，本发明不限于上述实施例，本领域技术人员根据本发明的揭示，对于本发明做出的改进和修改都应该在本发明的保护范围之内。
