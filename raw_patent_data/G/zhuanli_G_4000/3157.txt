标题title
一种基于多图融合的隧道瓦斯浓度预测方法
摘要abst
本发明提供一种基于多图融合的隧道瓦斯浓度预测方法，包括：获取每个监测点的瓦斯浓度序列并进行时间片段分片，合并形成浓度分段序列矩阵；构建监测点关联的多语义瓦斯浓度空间关系融合图；将多语义瓦斯浓度空间关系融合图输入至完成训练的图神经网络，对浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量；利用完成训练的循环神经网络进行时空特征挖掘；利用完成训练的适用于分片预测的分段式注意力网络以及循环神经网络的解码器得到每个监测点将来某个预测时间段的瓦斯浓度表示向量，通过预测网络进行瓦斯浓度预测。能够自适应地、动态地学习监测点之间时空相关关系，提升了瓦斯浓度预测效果，进而保障施工安全。
权利要求书clms
1.一种基于多图融合的隧道瓦斯浓度预测方法，其特征在于，包括：获取每个监测点的瓦斯浓度序列并进行时间片段分片，合并后形成对应多个监测点的浓度分段序列矩阵；构建监测点关联的多语义瓦斯浓度空间关系融合图；将所述多语义瓦斯浓度空间关系融合图输入至完成训练的图神经网络，对所述浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量；将各监测点的所述空间关系表示向量输入至完成训练的循环神经网络的编码器得到每个监测点当前时间段的时空特征；将所述每个监测点当前时间段的时空特征输入至完成训练的适用于分片预测的分段式注意力网络训练得到所述监测点的将来某个预测时间段的表示向量，并将所述预测时间段的表示向量输入至完成训练的所述循环神经网络的解码器得到每个监测点将来某个预测时间段的瓦斯浓度表示向量；将所述预测时间段的瓦斯浓度表示向量输入至完成训练的预测网络得到对应于所述预测时间段的瓦斯浓度。2.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，所述获取每个监测点的瓦斯浓度序列并进行时间片段分片，合并后形成对应多个监测点的浓度分段序列矩阵，包括：获取每个监测点监测的多个时刻的瓦斯浓度形成所述监测点的浓度序列；将每个所述监测点的浓度序列合并形成多个监测点的浓度序列矩阵；采用预设的时间窗口和移动步长对所述浓度序列矩阵中每个所述监测点的浓度序列进行片段分片，生成多个时间段的浓度分段序列；将每个监测点的所述多个时间段的浓度分段序列合并形成多个监测点的浓度分段序列矩阵。3.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，所述构建监测点关联的多语义瓦斯浓度空间关系融合图，包括：基于可学习的瓦斯浓度变化参数矩阵构建关联监测点的第一邻接矩阵，并生成对应的第一空间关系图；基于监测点的瓦斯浓度序列构建关联监测点的第二邻接矩阵，并生成对应的第二空间关系图；分别对不同语义的所述第一空间关系图和所述第二空间关系图作图的标准化；将标准化后的所述第一空间关系图和所述第二空间关系图相加处理得到所述多语义瓦斯浓度空间关系融合图。4.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，基于完成训练的所述图神经网络对所述浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量，包括：获取所述多语义瓦斯浓度空间关系融合图对应的图数据，其中，所述图数据包括：所述多语义瓦斯浓度空间关系融合图的邻接矩阵、所述邻接矩阵的度矩阵和单位矩阵；将所述图数据和所述浓度分段序列矩阵输入至完成训练的所述图神经网络，进行空间相关性特征向量提取，通过所述图神经网络的输出层获取各监测点的空间关系表示向量。5.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，基于完成训练的所述循环神经网络获取得到每个监测点当前时间段的时空特征，包括：将当前时间段的所述空间关系表示向量与所述当前时间段的前一个时间段的隐藏状态进行拼接，得到第一拼接特征向量；将所述第一拼接特征向量输入至完成训练的所述循环神经网络的编码器，基于所述编码器的重置门和更新门的计算方法将所述第一拼接特征向量与预设的可学习权重矩阵进行融合；将当前时刻输入的表示向量输入至所述循环神经网络的编码器，通过编码器输出得到当前时间段的时空特征。6.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，基于完成训练的所述分段式注意力网络获取得到所述监测点的将来某个预测时间段的表示向量，包括：获取所述监测点将来某个预测时间段对应解码单元的隐藏向量；基于所述隐藏向量和所述时空特征获取所述解码单元的注意力分数向量；基于所述注意力分数向量获取将来某个预测时间段的表示向量，并作为所述解码单元的输入。7.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，基于完成训练的所述循环神经网络得到每个监测点将来某个预测时间段的瓦斯浓度表示向量，包括：将所述将来某个预测时间段的表示向量与所述预测时间段的前一个时间段的隐藏状态进行拼接，得到第二拼接特征向量；将所述第二拼接特征向量输入至完成训练的所述循环神经网络的解码器，基于所述解码器的重置门和更新门的计算方法将所述第二拼接特征向量与预设的可学习权重矩阵进行融合；将隐藏状态的表示向量输入至所述循环神经网络的解码器，通过解码器输出得到将来某个预测时间段的瓦斯浓度表示向量。8.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，基于完成训练的所述预测网络得到对应于所述预测时间段的瓦斯浓度，包括：将所述预测时间段的瓦斯浓度向量输入至完成训练的所述预测网络，基于所述预测网络的神经网络参数对所述预测时间段的瓦斯浓度向量进行预测，通过所述预测网络的输出层得到所述预测时间段的瓦斯浓度。9.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，所述预测网络为多层感知机网络。10.根据权利要求1所述的基于多图融合的隧道瓦斯浓度预测方法，其特征在于，得到所述预测时间段的瓦斯浓度之后，还包括：获取隧道瓦斯浓度真实值，通过平均绝对误差或均方根误差计算所述隧道瓦斯浓度真实值与所述预测时间段的瓦斯浓度的误差值，用于预测效果指标评价。
说明书desc
技术领域本发明涉及瓦斯浓度预测技术领域，尤其涉及一种基于多图融合的隧道瓦斯浓度预测方法。背景技术随着国家交通基础设施的不断规划和建设，崎岖陡峻、沟谷交错的山地地形特征导致山区交通道路的隧道和桥梁比例增大、分布集中。随着隧道总量增大，越来越多的隧道穿越油气盆地、煤系地层等瓦斯积聚区山脉，瓦斯问题日益突出。隧道瓦斯涌出会引起燃烧、爆炸、突出等灾难性后果以及人员中毒、窒息。公路隧道的开挖揭露面积大，施工中瓦斯管理与控制十分关键。瓦斯浓度的变化具有时变性、非线性和高复杂度等特点。针对该特点，现有的瓦斯浓度预测技术主要有两大类。基于传统机器学习方法的预测技术，主要包括时间序列方法、灰色理论方法、支持向量机、聚类算法等；基于神经网络的预测技术，由于神经网络具有强大的非线性关系建模能力，目前这类的预警技术应用比较广泛，主要采用的神经网络包括循环神经网络、深度信念网络、回声状态网络、模糊神经网络等。总的来说，现有预警技术考虑了输入数据为一维时序数据和多维时序数据的场景。针对多维数据的场景，现有技术主要是监测数据形成多变量瓦斯浓度时间序列，从数据层面出发，通过各个巷道监测点瓦斯浓度序列之间的相似性对各站点进行关联,依据关联程度提取影响瓦斯浓度变化的因素构建多变量瓦斯浓度预测方法。然而，基于关联性分析解决多维数据的瓦斯浓度预警方法，忽略了给个监测点之间相关性变化的情况。根据气体分子运动理论,瓦斯的运移和分布与时间、空间密切相关。因此，忽略监测点之间相关性变化势必会影响瓦斯浓度的预测效果。发明内容本发明提供一种基于多图融合的隧道瓦斯浓度预测方法，用于解决现有技术中因忽略监测点之间瓦斯浓度相关性变化势必会影响各监测点瓦斯浓度预测效果的缺陷。本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，包括：获取每个监测点的瓦斯浓度序列并进行时间片段分片，合并后形成对应多个监测点的浓度分段序列矩阵；构建监测点关联的多语义瓦斯浓度空间关系融合图；将所述多语义瓦斯浓度空间关系融合图输入至完成训练的图神经网络，对所述浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量；将各监测点的所述空间关系表示向量输入至完成训练的循环神经网络的编码器得到每个监测点当前时间段的时空特征；将所述每个监测点当前时间段的时空特征输入至完成训练的适用于分片预测的分段式注意力网络训练得到所述监测点的将来某个预测时间段的表示向量，并将所述预测时间段的表示向量输入至完成训练的所述循环神经网络的解码器得到每个监测点将来某个预测时间段的瓦斯浓度表示向量；将所述预测时间段的瓦斯浓度表示向量输入至完成训练的预测网络得到对应于所述预测时间段的瓦斯浓度。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，所述获取每个监测点的瓦斯浓度序列并进行时间片段分片，合并后形成对应多个监测点的浓度分段序列矩阵，包括：获取每个监测点监测的多个时刻的瓦斯浓度形成所述监测点的浓度序列；将每个所述监测点的浓度序列合并形成多个监测点的浓度序列矩阵；采用预设的时间窗口和移动步长对所述浓度序列矩阵中每个所述监测点的浓度序列进行片段分片，生成多个时间段的浓度分段序列；将每个监测点的所述多个时间段的浓度分段序列合并形成多个监测点的浓度分段序列矩阵。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，所述构建监测点关联的多语义瓦斯浓度空间关系融合图，包括：基于可学习的瓦斯浓度变化参数矩阵构建关联监测点的第一邻接矩阵，并生成对应的第一空间关系图；基于监测点的瓦斯浓度序列构建关联监测点的第二邻接矩阵，并生成对应的第二空间关系图；分别对不同语义的所述第一空间关系图和所述第二空间关系图作图的标准化；将标准化后的所述第一空间关系图和所述第二空间关系图相加处理得到所述多语义瓦斯浓度空间关系融合图。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，基于完成训练的所述图神经网络对所述浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量，包括：获取所述多语义瓦斯浓度空间关系融合图对应的图数据，其中，所述图数据包括：所述多语义瓦斯浓度空间关系融合图的邻接矩阵、所述邻接矩阵的度矩阵和单位矩阵；将所述图数据和所述浓度分段序列矩阵输入至完成训练的所述图神经网络，进行空间相关性特征向量提取，通过所述图神经网络的输出层获取各监测点的空间关系表示向量。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，基于完成训练的所述循环神经网络获取得到每个监测点当前时间段的时空特征，包括：将当前时间段的所述空间关系表示向量与所述当前时间段的前一个时间段的隐藏状态进行拼接，得到第一拼接特征向量；将所述第一拼接特征向量输入至完成训练的所述循环神经网络的编码器，基于所述编码器的重置门和更新门的计算方法将所述第一拼接特征向量与预设的可学习权重矩阵进行融合；将当前时刻输入的表示向量输入至所述循环神经网络的编码器，通过编码器输出得到当前时间段的时空特征。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，基于完成训练的所述分段式注意力网络获取得到所述监测点的将来某个预测时间段的表示向量，包括：获取所述监测点将来某个预测时间段对应解码单元的隐藏向量；基于所述隐藏向量和所述时空特征获取所述解码单元的注意力分数向量；基于所述注意力分数向量获取将来某个预测时间段的表示向量，并作为所述解码单元的输入。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，基于完成训练的所述循环神经网络得到每个监测点将来某个预测时间段的瓦斯浓度表示向量，包括：将所述将来某个预测时间段的表示向量与所述预测时间段的前一个时间段的隐藏状态进行拼接，得到第二拼接特征向量；将所述第二拼接特征向量输入至完成训练的所述循环神经网络的解码器，基于所述解码器的重置门和更新门的计算方法将所述第二拼接特征向量与预设的可学习权重矩阵进行融合；将隐藏状态的表示向量输入至所述循环神经网络的解码器，通过解码器输出得到将来某个预测时间段的瓦斯浓度表示向量。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，将所述预测时间段的瓦斯浓度向量输入至完成训练的所述预测网络，基于所述预测网络的神经网络参数对所述预测时间段的瓦斯浓度向量进行预测，通过所述预测网络的输出层得到所述预测时间段的瓦斯浓度。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，所述预测网络为多层感知机网络。根据本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法，得到所述预测时间段的瓦斯浓度之后，还包括：获取隧道瓦斯浓度真实值，通过平均绝对误差或均方根误差计算所述隧道瓦斯浓度真实值与所述预测时间段的瓦斯浓度的误差值，用于预测效果指标评价。本发明提供一种基于多图融合的隧道瓦斯浓度预测方法，基于各个监测点获取的瓦斯浓度序列生成多个时间段分片的浓度分段序列矩阵，动态地构建监测点之间的多语义瓦斯浓度空间关系融合图，基于浓度分段序列矩阵和多语义瓦斯浓度空间关系融合图，依次通过训练完成的图神经网络、循环神经网络的编码器、基于分片预测的分段式注意力网络、循环神经网络的解码器以及预测网络等多个神经网络模型精准预测未来某一时间段的瓦斯浓度，能够自适应地、动态地学习各监测点之间时空相关性，提升了瓦斯浓度预测效果，进而保障施工安全。附图说明为了更清楚地说明本发明或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法的流程示意图之一；图2为本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法的流程示意图之二；图3为本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法的流程示意图之三；图4为本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法中通过多个神经网络学习训练并进行瓦斯浓度预测的示意图；图5为本发明提供的一种基于多图融合的隧道瓦斯浓度预测方法中对各监测点的浓度序列进行分片的示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。参照图1所示，本发明提供一种基于多图融合的隧道瓦斯浓度预测方法，包括：步骤S1：获取每个监测点的瓦斯浓度序列并进行时间片段分片，合并后形成对应多个监测点的浓度分段序列矩阵；步骤S2：构建监测点关联的多语义瓦斯浓度空间关系融合图；步骤S3：将多语义瓦斯浓度空间关系融合图输入至完成训练的图神经网络，对浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量；步骤S4：将各监测点的空间关系表示向量输入至完成训练的循环神经网络的编码器得到每个监测点当前时间段的时空特征；步骤S5：将每个监测点当前时间段的时空特征输入至完成训练的适用于分片预测的分段式注意力网络得到监测点的将来某个预测时间段的表示向量，并将预测时间段的表示向量输入至完成训练的循环神经网络的解码器得到每个监测点将来某个预测时间段的瓦斯浓度表示向量；将预测时间段的瓦斯浓度表示向量输入至完成训练的预测网络得到对应于预测时间段的瓦斯浓度。具体的，本发明提出一种基于多图融合的隧道瓦斯浓度预测方法，基于各个监测点获取的瓦斯浓度序列生成多个时间段分片的浓度分段序列矩阵；分别从基于静态的历史关联和动态的数据驱动的方式动态构建了各监测点之间的多语义瓦斯浓度空间关系融合图；基于多语义瓦斯浓度空间关系融合图和浓度分段序列矩阵，利用完成训练的图神经网络GCN得到每个监测点的空间关系表示向量；针对每个监测点的空间关系表示向量，利用完成训练的循环神经网络GRU的编码器进行时空特征挖掘；基于获取到的每个监测点的时空特征，利用完成训练的适用于分片预测的分段式注意力网络以及循环神经网络GRU的解码器预测每个监测点将来某个预测时间段的瓦斯浓度表示向量，即，将每个监测点当前时间段的时空特征输入至适用于分片预测的分段式注意力网络训练并获取监测点的将来某个预测时间段的表示向量，并将预测时间段的表示向量输入至完成训练循环神经网络GRU的解码器得到每个监测点将来某个预测时间段的瓦斯浓度表示向量；最后，基于将来某个预测时间段的瓦斯浓度表示向量通过预测网络预测出该预测时间段的瓦斯浓度。因此，本发明通过基于浓度分段序列矩阵和多语义瓦斯浓度空间关系融合图，利用训练完成的图神经网络GCN、循环神经网络GRU、适用于分片预测的分段式注意力网络和预测网络等一系列神经网络模型能够自适应地、动态地学习各监测点之间时空相关性获取时空特征，并精准预测未来某一时间段的瓦斯浓度，提升了瓦斯浓度预测效果，进而保障施工安全。参见图2所示，优选地，获取每个监测点的瓦斯浓度序列并进行时间片段分片，合并后形成对应多个监测点的浓度分段序列矩阵，包括：步骤S11：获取每个监测点监测的多个时刻的瓦斯浓度形成监测点的浓度序列；步骤S12：将每个监测点的浓度序列合并形成多个监测点的浓度序列矩阵；步骤S13：采用预设的时间窗口和移动步长对浓度序列矩阵中每个监测点的浓度序列进行片段分片，生成多个时间段的浓度分段序列；步骤S14：将每个监测点的多个时间段的浓度分段序列合并形成多个监测点的浓度分段序列矩阵。具体的，给定n个监测点，获取每个监测点记录的过去m个时刻的瓦斯浓度，第i个监测点的瓦斯浓度序列表示为Xi＝∈R1×m，n个监测点的浓度序列矩阵用X表示。在时空特征挖掘时，采用的是适用于分片的分段式注意力网络。因此，对含有m个时刻的浓度序列矩阵X需要进行时间片段分片，每个时间片段的时间窗口是w，移动步长是w，将m个时刻分片成t个时间片段，分片过程如图5所示。将分片之后的第i个监测点，过去t个时间段的瓦斯浓度序列表示为Si＝，S是一个分段序列。n个监测点的分段序列矩阵用S表示。考虑相近时间段内，各个监测点的瓦斯浓度空间关系不会发生很大变化。因此对瓦斯浓度序列采用了分片的方式，在图神经网络GCN进行空间关系表示学习训练过程中，提升了动态挖掘空间关系的效率。参见图3所示，优选地，构建监测点关联的多语义瓦斯浓度空间关系融合图，包括：步骤S21：基于可学习的瓦斯浓度变化参数矩阵构建关联监测点的第一邻接矩阵，并生成对应的第一空间关系图；步骤S22：基于监测点的瓦斯浓度序列构建关联监测点的第二邻接矩阵，并生成对应的第二空间关系图；步骤S23：分别对不同语义的第一空间关系图和第二空间关系图作图的标准化；步骤S24：将标准化后的第一空间关系图和第二空间关系图相加处理得到多语义瓦斯浓度空间关系融合图。具体的，根据气体分子运动理论，瓦斯的运移和分布与时间、空间密切相关。为了充分挖掘各监测点之间的空间相关性，更好地构建各监测点关系。本发明采用多图融合的方式进行空间相关性表示，即分别从动态的数据驱动的角度构建第一空间关系图和静态的历史关联的角度构建第二空间关系图，然后对得到的两个图进行融合：1)从动态的数据驱动的角度构建第一空间关系图：针对瓦斯浓度的变化具有时变性、非线性和高复杂度等特点，将这些复杂因素通过可学习的瓦斯浓度变化参数矩阵E∈Rn×d进行建模。其中，d为每个浓度变化属性向量的维度，n为监测点数量，Et为第t个时间段的瓦斯浓度变化参数矩阵。通过公式构建关联于监测点的第一空间关系图Gdata的第一邻接矩阵Adata表示为：Adata＝ei，t*T；其中，ei，t∈Et表示监测点i第t个时间段的表示向量，其向量维度为1×d，ej，t∈Et表示监测点j第t个时间段的表示向量，其向量维度为1×d；2)从静态的历史关联的角度构建第二空间关系图：基于监测点的瓦斯浓度序列通过公式构建关联于监测点的第二空间关系图Ghist的第二邻接矩阵Ahist表示为：其中，α为自定义的超参数，其取值范围为，r为任意两个监测点i和j的瓦斯浓度序列的历史相关性；给定两个监测点i和j的瓦斯浓度序列分别为Xi∈R1×T和Xj∈R1×T，采用Pearson相关系数通过下述公式计算任意两个监测点i和j的历史相关性，计算公式如下：和/＞分别表示两个监测点i和j的瓦斯浓度序列Xi，Xj的均值；第一空间关系图Gdata和第二空间关系图Ghis为graph图，在第二空间关系图Ghis表示的无向图中，浓度变化模式相关性越强的两个监测点，其空间关系的权重越大；3)两个空间关系图的融合：有了不同语义下的第一空间关系图和第二空间关系图，则可以通过多图融合构建多语义瓦斯浓度空间关系融合图，以便输入至图神经网络GCN通过图卷积操作进行空间关系表示学习训练。多图融合前，通过公式先作图的标准化：其中，Idata和Ihist分别表示邻接矩阵Adata和邻接矩阵Ahist的单位矩阵，用来表示监测点对自身的影响，Ddata和Dhist分别表示邻接矩阵Adata和邻接矩阵Ahis的度矩阵，Ddata-1和Dhist-1分别为其对应转置矩阵，和/＞分别为作图的标准化后语义图对应的邻接矩阵，然后通过公式将标准化后的两个语义图相加得到多语义瓦斯浓度空间关系融合图：其中，表示多语义瓦斯浓度空间关系融合图对应的邻接矩阵，a，b为系数，且满足约束条件a+b＝1。优选地，基于完成训练的图神经网络对浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量，包括：获取多语义瓦斯浓度空间关系融合图对应的图数据，其中，图数据包括：多语义瓦斯浓度空间关系融合图的邻接矩阵、邻接矩阵的度矩阵和单位矩阵；将图数据和浓度分段序列矩阵输入至完成训练的图神经网络，进行空间相关性特征向量提取，通过图神经网络的输出层获取各监测点的空间关系表示向量。具体的，完成训练的所述图神经网络对浓度分段序列矩阵进行空间相关性特征提取，获取各监测点的空间关系表示向量，通过下述公式实现：其中，表示多语义瓦斯浓度空间关系融合图对应的邻接矩阵，S表示多个监测点的浓度分段序列矩阵，/＞表示该邻接矩阵的度矩阵，度矩阵/＞中的元素值/＞Wθ和b表示可学习的权重矩阵和偏置，IN表示该邻接矩阵的单位矩阵，V∈Rn×d表示训练得到的n个监测点的空间关系表示向量，Rn×d表示可学习的瓦斯浓度变化参数矩阵，其中第i个监测点的空间关系表示向量用Vi表示。优选地，基于完成训练的循环神经网络获取得到每个监测点当前时间段的时空特征，包括：将当前时间段的空间关系表示向量与当前时间段的前一个时间段的隐藏状态进行拼接，得到第一拼接特征向量；将第一拼接特征向量输入至完成训练的循环神经网络的编码器，基于编码器的重置门和更新门的计算方法将第一拼接特征向量与预设的可学习权重矩阵进行融合；将当前时刻输入的表示向量输入至循环神经网络的编码器，通过编码器输出得到当前时间段的时空特征。具体的，将各监测点的空间关系表示向量输入至完成训练的循环神经网络GRU的编码器得到每个监测点当前时间段的时空特征，通过下述公式～实现：zi，t＝σ；ri，t＝σ；其中，vI，t||hI，t-1表示当前第t个时间段的输入向量，hI，t-1表示t-1时间段得到的隐藏状态，vI，t表示第i个监测点的第t个时间段的空间关系表示向量，||表示特征向量的拼接，当前时刻输入的表示向量，⊙表示哈达玛积，zi，t表示重置门，ri，t表示更新门，Wz，Wr，分别表示对应的可学习权重矩阵，hi，t表示输出为第i个监测点的第t个时间段的时空特征。公式和采用的计算为非线性激活函数，其表达式为：/＞公式采用的计算为双曲正切激活函数，其表达式为：/＞进一步地，根据公式，对于循环神经网络GRU的编码器的最后一个单元的输出，将其定义为gi，0，并将其作为解码阶段的输入。优选地，基于完成训练的分段式注意力网络获取得到监测点的将来某个预测时间段的表示向量，包括：获取监测点将来某个预测时间段对应解码单元的隐藏向量；基于隐藏向量和时空特征获取解码单元的注意力分数向量；基于注意力分数向量获取将来某个预测时间段的表示向量，并作为解码单元的输入。具体的，基于对瓦斯浓度序列采用分片的方式，对应地设计了适用于分片预测的注意力网络，即分段式注意力网络。在解码阶段，训练完成的分段式注意力网络能够预测将来某个预测时间段的瓦斯浓度表示向量，也表示着未来一段时间瓦斯浓度的向量。因此，将每个监测点当前时间段的时空特征输入至完成训练的适用于分片预测的分段式注意力网络得到监测点的将来某个预测时间段的表示向量，通过下述公式～实现：αi，q＝softmax；fi，q＝；其中，q表示分段式注意力网络解码阶段的第q个预测时间段，q-1则表示第q-1个预测时间段，j∈1～t个时间段，bi，q-1表示第i个监测点在第q-1个解码单元的隐藏向量，hi，t表示第i个监测点的第t个时间段的时空特征，ci，q表示第i个监测点在第q个解码单元的注意力分数向量，αi，q表示对应ci，q的分数分布，βi，q为权重系数向量，fi，q表示为训练得到的第i个监测点在第q个预测时间段的表示向量，并作为对应第q个解码单元的输入。优选地，基于完成训练的循环神经网络得到每个监测点将来某个预测时间段的瓦斯浓度表示向量，包括：将将来某个预测时间段的表示向量与预测时间段的前一个时间段的隐藏状态进行拼接，得到第二拼接特征向量；将第二拼接特征向量输入至完成训练的循环神经网络的解码器，基于解码器的重置门和更新门的计算方法将第二拼接特征向量与预设的可学习权重矩阵进行融合；将隐藏状态的表示向量输入至循环神经网络的解码器，通过解码器输出得到将来某个预测时间段的瓦斯浓度表示向量。具体的，将预测时间段的表示向量输入至完成训练的循环神经网络的解码器得到每个监测点将来某个预测时间段的瓦斯浓度表示向量，通过下述公式～实现：zi，q＝σ；ri，q＝σ；其中，fi，q||gI，q-1表示第q个预测时间段的输入向量，gI，q-1表示第q-1个预测时间段得到的隐藏状态，fi，q是训练得到的第i个监测点在第q个预测时间段的表示向量，||表示特征向量的拼接，⊙为哈达玛积，zi，q表示重置门，ri，q表示更新门，Wz，Wr，分别表示为对应的可学习权重矩阵，/＞表示隐藏状态的表示向量，gi，q表示为训练得到的第i个监测点第q个预测时间段的瓦斯浓度表示向量。公式和采用的计算为非线性激活函数，其表达式同上所述，公式采用的计算为双曲正切激活函数，其表达式同上所述。优选地，将预测时间段的瓦斯浓度表示向量输入至预测网络进行训练，训练后得到对应于预测时间段的瓦斯浓度，其预测过程通过下述公式实现：其中，表示预测的第q个预测时间段的瓦斯浓度，Wh、Wo、bh、ho均为网络参数。公式采用的计算为非线性激活函数，其表达式同上所述。进一步地，预测网络为多层感知机网络，可以有效地降低瓦斯浓度的过拟合现象，提高感知预测的鲁棒性。优选地，得到预测时间段的瓦斯浓度之后，还包括：获取隧道瓦斯浓度真实值，通过平均绝对误差或均方根误差计算隧道瓦斯浓度真实值与预测时间段的瓦斯浓度的误差值，用于预测效果指标评价。具体的，通过RMSE和MAPE两种验证指标在测试数据集上面验证本方法的可用性。RMSE的计算方法为公式：MAPE的计算方法为公式：其中，n为测试数据集样本数，xi为获取的隧道瓦斯浓度真实值，为预测的瓦斯浓度。实施例一给定一批数据集，该数据集记录了5个监测点，1000个时刻的瓦斯浓度变化值。按照机器学习的流程，将数据集分成训练集、测试集两部分。训练集包括5个监测点从第1时刻到第600时刻的记录值，测试集包括5个监测点从第601时刻到1000时刻都记录值。接下来，将训练集进行分片处理，分解为长度为50个时刻的瓦斯浓度序列，前40个时刻作为模型输入，记为X，最后10个时刻记为Y。最终得到551个训练样本，每个样本时间长度是50。同理，测试集会得到351个测试样本，每个样本时间长度为50。参照图4所示的通过神经网络学习训练并进行瓦斯浓度预测的示意图，下面进行训练：分片处理，对于每一个训练样本Xi，将其进行分片，这里时间窗口大小设置为10，移动步长是10，即将训练样本Xi分为了5个片段，前4个片段输入Si＝，最后一个片段输出Si，5；基于历史关联的空间关系计算，利用5个监测点从第1时刻到第600时刻的记录值，按照公式～计算第二空间关系图；初始化可学习的瓦斯浓度变化参数矩阵E，开始迭代训练；对每个训练样本Xi依次按照公式计算第一空间关系图；按照公式～对第一空间关系图和第二空间关系图进行多图融合；利用图神经网络GCN按照公式进行空间关系表示学习得到监测点的空间关系表示向量V；根据公式得到的V，利用公式～进行时空特征挖掘；根据公式的输出的时空特征gi,0，利用公式～对将来第1个时间片段的瓦斯浓度表示向量进行预测；根据公式的输出瓦斯浓度表示向量gi,1，利用公式对将来第1个时间片段的瓦斯浓度进行预测,即得到所有样本的预测值之后，基于目标函数计算误差，即根据误差值loss，进行反向传播，并基于随机梯度下降算法更新公式、～中涉及到各神经网络模型的参数；重复～，直到模型参数收敛满足收敛条件，即前后两次迭代过程的误差值小于0.0001。测试流程：通过训练后，即可得到完成训练的神经网络模型。将测试集中的351个测试样本依次进行分片；基于历史关联的空间关系计算，利用5个监测点从训练集第1时刻到第600时刻的记录值，按照公式～计算空间关系；将得到的分片输入训练完成的图神经网络GCN，然后依次按照公式-得到浓度预测值。瓦斯浓度预测时的实际操作时与测试流程一样，下表给出了本方法与其他方法的预测效果对比，用于预测效果指标评价：模型RMSEMAPEHA2.6512.42ARIMA2.3411.31GBRT2.1411.09GRU2.0310.33GCN1.849.87本发明方法1.227.82通过对比可以看出，本发明方法相比HA、ARIMA、GBRT、GRU以及GCN等常用的预测方法效果都较好。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
