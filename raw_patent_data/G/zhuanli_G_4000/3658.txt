标题title
一种基于度量学习的非接触式跨域人体活动识别方法
摘要abst
一种基于度量学习的非接触式跨域人体活动识别方法，通过对已采集到的活动数据采用自编码器进行数据增强，然后通过采用度量学习完成未出现在训练集中的新活动类别的识别。具体步骤如下：在室内环境中采集人员活动时对应的无线信号数据，从中提取CSI原始数据；对原始CSI数据进行数据预处理，数据插值，统一数据长度，数据去噪；对已知活动类型的数据使用自编码器进行数据增强，扩充数据集；使用扩充后的数据集训练特征提取网络，将待识别活动数据和支持集输入特征提取网络得到相应特征，使用度量学习的方法将待识别数据特征与支持集数据特征一一对比，从而判断活动类型。本方法对于未训练的活动类型能实现较高识别精度，增强泛化性和鲁棒性。
权利要求书clms
1.一种基于度量学习的非接触式跨域人体活动识别方法，其特征在于：所述方法包括如下步骤：步骤1，在室内环境中采集人员活动时对应的无线信号数据，从中提取CSI的原始信号；步骤2，对步骤1中采集到的原始CSI数据进行数据预处理，数据插值统一长度，数据去噪来去除硬件设备造成的噪声信号；步骤3，使用自编码器对步骤2处理后的数据进行数据增强，生成对应活动相关的数据以扩大数据集；步骤4，使用基于度量学习的方法，建立活动识别模型，对步骤3中生成的数据和原有数据进行训练，学习数据之间的相似度，训练活动相关特征提取模型，对比待识别数据和支持集数据的特征，进行未知类型活动的识别。2.根据权利要求1所述的一种基于度量学习的非接触式跨域人体活动识别方法，其特征在于：步骤1中，使用Linux 802.11 CSI tools从中提取CSI的原始信号。3.根据权利要求1所述的一种基于度量学习的非接触式跨域人体活动识别方法，其特征在于：步骤2中，数据预处理方法如下：步骤2-1：数据插值，对于数据传输过程中发生的丢包现象，根据时间戳使用三次样条插值对CSI数据进行补全；步骤2-2：数据去噪，利用巴特沃斯低通滤波器对步骤2-1中的CSI数据进行去燥，去除环境中的高频噪声，利用Hampel滤波器去除CSI数据中的异常值，得到预处理后的数据。4.根据权利要求1所述的一种基于度量学习的非接触式跨域人体活动识别方法，其特征在于：步骤3中，数据增强的具体方法如下：使用自动编码器来生成相关的活动数据，其中每个自动编码器都是一个编码器-解码器结构；首先，通过编码器对数据进行压缩，提取与其活动相关的特征信息，将输入编码为正态分布；假设产生数据/＞的概率为/＞；编码器在输入为/＞的条件下输出潜在向量z的概率为/＞；然后将提取的特征和高斯随机噪声输入解码器以重构数据；最后，在训练阶段引入损失函数；目标是训练编码器输出潜在向量z的概率近似于生成潜在向量z的概率/＞，其中/＞符合/＞的正态分布；将编码器损失定义为Kullback–Leibler散度，/＞和/＞分别表示类别/＞的正态分布的期望和方差；；编码器的输出混合噪声输入解码器中来重构输入/＞，其中/＞为真实值，最小化重构损失为：；那么，数据增强模块的整体损失函数定义为：。5.根据权利要求1所述的一种基于度量学习的非接触式跨域人体活动识别方法，其特征在于：步骤4中，活动识别模块包括特征提取网络和活动分类模块；步骤4-1：划分数据集；基于步骤3，获得增强后的扩充数据集，以此数据集作为训练集；训练数据集表示为，其中正样本与基准样本/＞具有相同的类别标签，而负样本/＞则具有不同的活动类别标签；从未知类型的活动数据集中，随机选取一组数据来生成支持集；将支撑集描述为，其中/＞是数据样本/＞对应的标签，/＞为未知类型活动的数量；步骤4-2：训练特征提取器，提取活动相关特征；特征提取模块由三个模块组成，它们使用同样的前馈网络并共享相同的参数；特征提取模块有三个输入和对应的两个中间输出值，它们表示两个输入的L2距离；为了从模型中输出一个比较操作符，Softmax函数被应用于输出以创建一个比率度；前馈网络主要由六个网络层构成，CNN→LSTM→CNN→LSTM→CNN→Linear；CNN层学习CSI的深层特征信号，它由BatchNorm→CNN→Maxpool构成；LSTM层学习CSI信号在时域的相关性，具体为BatchNorm→LSTM→Dropout；线性层Linear则由Linear→Relu→Linear组成，将提取的数据映射到特征空间中；训练的目的是使同一类别之间的数据距离尽可能小，不同类别之间的数据距离尽可能大，因此将损失定义为：；其中，；式中，函数E指特征提取器；目标是使得特征提取网络的损失趋近于0，定义，/＞表示/＞和/＞之间的欧氏距离，/＞表示/＞和/＞之间的欧氏距离；步骤4-3：活动识别；输入支持集和目标样本数据到特征提取网络，获得相应的活动特征；测量目标样本的特征值与支持集中所有样本特征值之间的相似性，选择相似度最大的支持集样本对应的标签作为目标样本的标签/＞；；其中，指的是支持集中样本对应的标签，/＞指支持集，i指支持集中第i个数据；支持集样本和目标样本/＞之间的余弦相似度/＞为：。
说明书desc
技术领域本发明涉及活动识别领域，具体涉及一种基于度量学习的非接触式跨域人体活动识别方法。背景技术基于Wi-Fi的人体活动识别旨在利用Wi-Fi信号识别人体活动。由于不需要用户佩戴特殊设备和额外的部署成本，基于Wi-Fi的人体识别在构建人机交互、智能监、入侵检测智能应用方面受到越来越多的关注。然而，由于采集信道状态信息 数据需要大量的人力物力，现有的Wi-Fi感知公开数据集非常匮乏。因此，Wi-Fi感知没有足够的标记数据来训练具有良好性能的机器学习模型。同时，无线信号受到物理环境，人类行为的影响，传输过程中的人体 不同的动作类型可能引起相似的信号波动，这无疑使棏活动识别的过程变得更加复杂。特别是在实际应用中，系统可能需要识别一些在训练阶段从未见过的活动类型，对未知活动类型进行识别是一个巨大的挑战。传统的基于Wi-Fi的识别通常采用有监督的方法，只能识别预先定义的活动，并且需要大量的数据来学习足够的先验知识，它们复杂的训练过程加剧了模型训练的成本，使得整体开销大幅增加。这些活动识别方法首先收集大量带标签的样本，然后训练一个传统的机器学习模型来识别活动类型。然而，当需要识别训练过程中未出现的新活动类型时，由于新数据的活动类别和训练集中数据活动类别不同，需要跨类别对新的活动数据进行识别，此时上述方法的模型的识别性能会严重下降。为了解决这个问题，最近的一些工作收集了一些未出现在训练集中的新类型的活动数据来重新训练模型。但是，重训练的过程无疑增加了模型训练的开销。在计算机视觉领域中，度量学习被广泛用于识别未见过的活动和场景。度量学习问题通常被描述为一个优化问题，优化一些衡量数据相似性的目标函数。将数据从原始向量空间映射到隐藏空间，得到与活动相关的特征。针对上述问题，由于Wi-Fi CSI的数据集很少，实际场景中可能会出现需要识别未知类型活动的情况。发明内容本发明的目的是提供一种基于度量学习的非接触式跨域人体活动识别方法，使用自编码器对活动数据集进行扩充来丰富数据集提升识别准确度，之后通过基于度量学习的方法比较数据之间的相似度来实现对未出现在训练集中的新活动类别进行识别的功能。一种基于度量学习的非接触式跨域人体活动识别方法，包括如下步骤：步骤1，在室内环境中采集人员活动时对应的无线信号数据，从中提取CSI的原始信号；步骤2，对步骤1中采集到的原始CSI数据进行数据预处理，数据插值统一长度，数据去噪来去除硬件设备造成的噪声信号；步骤3，使用自编码器对步骤2处理后的数据进行数据增强，生成对应活动相关的数据以扩大数据集；步骤4，使用基于度量学习的方法，建立活动识别模型，对步骤3中生成的数据和原有数据进行训练，学习数据之间的相似度，训练活动相关特征提取模型，对比待识别数据和支持集数据的特征，进行未知类型活动的识别。本发明达到的有益效果：利用度量学习的方法将待识别的未知类型活动数据特征与支持集数据特征一一对比，从而实现了未知类型活动的识别。解决了无线感知中未知类型活动识别的问题，对于未训练的活动类型能实现较高的识别精度，无需额外的训练成本，增强了活动识别网络的鲁棒性。受度量学习核心思想的启发，通过使相似样本更靠近，不相似样本更远离的准则来训练网络，不需要复杂的训练策略就可以实现对未知类型活动的识别。附图说明图1是本发明实施例中的基于信道状态信息的未知类型的活动识别方法的流程示意图。图2是本发明实施例中的未知活动识别网络的网络结构示意图。图3是本发明实施例中在实验室场景下的跨域活动识别效果示意图。图4是本发明实施例中在会议室场景下的跨域活动识别效果示意图。图5是本发明实施例中在卧室场景下的跨域活动识别效果示意图。图6是本发明实施例中在走廊场景下的跨域活动识别效果示意图。图7是本发明实施例中的数据增强方法对活动识别精度的影响示意图。具体实施方式下面结合说明书附图对本发明的技术方案做进一步的详细说明。如图1所示，本发明提供了一种基于度量学习的非接触式跨域人体活动识别方法，其过程如下所述：步骤1：使用配备有Intel 5300 网卡和三根天线的电脑作为实验的接收器，配备有Intel 5300 网卡和一根天线的电脑作为实验的发射器，将设备部署在四个不同的日常生活场景中。其中发射器和接收器之间的直线距离为3米，高度距离地面1米。收发器在志愿者活动时收发数据包，采集人员活动相关数据。使用Linux802.11 CSI tools从采集到的活动数据中提取用于人体活动识别的CSI原始数据。步骤2：CSI刻画了信号传播空间的特性，不同的活动会导致信号不同的多径传播，利用这一特点，可以使用Wi-Fi进行人体活动识别。发送端发射的无线信号在传输过程中受物理环境或人的因素影响，形成直射、反射和散射等多条路径传播，产生多径效应。当有人员活动时，接收端信号发生变化。此时接收端接收到的信号反映了由于人员活动造成的多径变化。CSI包含了每个子载波上的幅度和相位信息，刻画信号空间传播的特性，能够反映信号的变化。接收端接收到的信号可以描述成：其中为信道矩阵，表示CSI信息；接收和发射的信号向量分别为和；为加性高斯白噪声。由于在室内环境中射频信号从发射器到接收器通过多条路径传播，CSI是所有路径信号的叠加。因此信道矩阵可以表示为：这里是路径的数量，是复衰减，是第条路径的传播长度，是波长。由此模型可以得到当室内人员活动时，信号经过人体的反射，改变了信号路径长度，从而影响信道状态矩阵。步骤2-1：数据插值，由于设备硬件和信道影响，数据传输过程中会发生丢包现象，根据时间戳使用三次样条插值对CSI数据进行补全，使得CSI数据的长度统一。插值补全Matlab中有直接提供插值函数，是一种常用的数据处理方法。步骤2-2：数据去噪，对于人类日常活动行为，CSI的幅值在30 ~ 60 Hz之间波动。在保证信号不失真的前提下最大的去除硬件设备带来的噪声，本发明利用巴特沃斯低通滤波器对步骤2-1中的CSI数据进行去燥，去除环境中的高频噪声，利用Hample滤波器去除CSI数据中的异常值，得到预处理后的数据。步骤3：为了从收集到的数据中生成更多对应的活动数据，设计了一个多自编码器模块，其中每个子模块专用于一个活动类型。数据增强模块整体框架如图2中的所示，对于第个活动类型，使用第个自动编码器来生成相关的活动数据。其中每个自动编码器都是一个编码器-解码器结构。首先，通过编码器对数据进行压缩，提取与其活动相关的特征信息，将输入编码为正态分布。假设产生数据的概率为；编码器在输入为的条件下输出潜在向量z的概率为。然后将提取的特征和高斯随机噪声输入解码器以重构数据，其中解码器被描述为。最后，在训练阶段引入损失函数。目标是训练编码器输出潜在向量z的概率近似于生成潜在向量z的概率，其中符合 的正态分布。将编码器损失定义为Kullback–Leibler散度，和分别表示类别的正态分布的期望和方差。编码器的输出混合噪声输入解码器中来重构输入，其中为真实值，最小化重构损失为那么，数据增强模块的整体损失函数定义为：通过数据增强模块可以生成大量与训练数据相似但不同的合成数据用来扩充训练集。步骤4：对于未知的活动类型，不能直接将它们映射到已知的标签。受度量学习思想的启发，通过学习两个样本之间的相似程度，可以将简单的分类问题转化为对比问题，即对比样本之间的相似度。由此本发明提出了一个活动识别模块。步骤4-1：划分数据集。基于步骤3，获得增强后的扩充数据集，以此数据集作为训练集。之后，以的形式对训练集进行标注，其中正样本与基准样本具有相同的类别标签，而负样本则具有不同的活动类别标签。因此，训练数据集可以表示为，其中对应第个样本。对于未知类型的活动数据，从未知类型的活动数据集中，随机选取一组数据来生成支持集。将支撑集描述为，其中为随机抽取样本对应的标签，对应的是未知类型活动的数量。步骤4-2：训练特征提取器，提取活动相关特征。特征提取模块整体框架如图2中的所示。具体来说，活动识别方法由三个模块组成，它们使用同样的前馈网络并共享相同的参数。活动识别方法有三个输入和对应的两个中间输出值，它们表示两个输入的L2距离；为了从模型中输出一个比较操作符，Softmax函数被应用于输出以创建一个比率度；前馈网络主要由六个网络层构成，CNN→LSTM→CNN→LSTM→CNN→Linear；CNN层学习CSI的深层特征信号，它由BatchNorm→CNN→Maxpool构成；LSTM层学习CSI信号在时域的相关性，具体为BatchNorm→LSTM→Dropout；线性层Linear则由Linear→Relu→Linear组成，将提取的数据映射到特征空间中。训练的目的是使同一类别之间的数据距离尽可能小，不同类别之间的数据距离尽可能大。因此将损失定义为：其中，式中，函数E指特征提取器；目标是使得特征提取网络的损失趋近于0，此外定义，表示和之间的欧氏距离，表示和之间的欧氏距离。使用反向传播算法同时更新三个前馈网络。最后，将训练集输入特征提取器，通过训练获得了一个特征提取器来提取CSI数据中与活动相关的特征。步骤4-3：活动识别。如图2所示，输入支持集和目标样本数据到特征提取网络，获得相应的活动特征。活动识别过程如图2中的所示，测量目标样本的特征值与支持集中所有样本特征值之间的相似性，选择相似度最大的支持集样本对应的标签作为目标样本的标签。其中指的是支持集中样本对应的标签，/＞指支持集，i指支持集中第i个数据；支持集样本和目标样本/＞之间的余弦相似度/＞为通过以上步骤来完成对未知类型活动的识别。为了评估本方法在不同环境下的鲁棒性，在4个室内场景中实现了所提出的方法，这些室内场景具有各种复杂的无线环境。每个场景使用两台笔记本电脑作为收发器，两台设备都配备了Intel 5300卡，安装了Linux802.11n CSI Tool，用于采集CSI数据。发射端天线数为Nt= 1，接收端天线数为Nr= 3。通过采集人员活动信号，可以得到1 × 3 × 30 = 90个子载波的CSI数据，其中每个收发天线对有30个子载波。本方法中，信号频率为5.8 GHz，带宽为20MHz，采样频率为200Hz。为了评估本方法对不同人员的适应能力，在每个实验场景中，招募了7名不同身高和体重的志愿者来完成8项活动。每个场景的数据分为训练集、测试集和支持集。使用准确率来评价系统的性能。本发明的识别效果如下：1、整体识别准确率。在四个场景中验证提出的方法。根据下表内容可以看到，与现有的一些网络进行对比，本方法的识别准确度有很明显的提升。具体而言，本发明的活动识别方法相较于CNN和MatNet活动识别准确度有显著提升；此外，本发明提出的方法在4种生活场景下的准确率对比迁移学习方法分别达到了9.31%、5.25%、10.22%和21.33%的提升。这主要得益于本发明提出的方法挖掘数据之间的关系，通过对比数据与支持集数据的相似度来进行识别，从而更有效地区分样本。表 1ModelLaboratoryMeeting roomBedroomParlorCNN26.1523.4823.7921.74MatNet55.3552.8753.1052.61Transfer63.1968.8570.2856.67WIUS72.5074.1080.5078.002、未出现在训练集中的新类别活动识别准确率。通过绘制活动分类的混淆矩阵，详细说明本发明的活动识别方法在不同的类别活动中的有效性。如图3-6所示，对新类别活动识别的准确率分别达到72.5%、74.1%、80.5%和78%。实验结果表明，对未见过的"起立"动作的正确识别概率高于其他动作。原因是当人员站起来时，他们首先会经历快速加速，然后速度下降到零。此外，起立动作是一个持续的接近收发对的过程，这个过程很好地区别于其他活动。而“挥手”和“转身”，都有一个远离收发器链路到最远距离后靠近收发对的过程，因此它们很容易被错误地归类到对方的类别中。3、数据增强方法对活动识别精度的影响。为了验证本方法中提出的数据增强方法的有效性，在使用数据增强方法和不使用数据增强方法的跨域活动识别的情况下进行消融分析。如图7所示，增强数据集后本方法的未知活动识别准确率有大幅提升，在四个生活场景中，对本方法未知活动的平均识别准确率提高了10.95%。特别是在卧室和走廊中，数据集的扩充使得本方法有足够的数据对模型进行训练，提升了模型的特征提取能力。以上所述仅为本发明的较佳实施方式，本发明的保护范围并不以上述实施方式为限，但凡本领域普通技术人员根据本发明所揭示内容所作的等效修饰或变化，皆应纳入权利要求书中记载的保护范围内。
