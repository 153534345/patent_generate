标题title
一种单目相机的地表物体空间分析方法、设备及介质
摘要abst
本说明书实施例公开了一种单目相机的地表物体空间分析方法、设备及介质，涉及空间定位技术领域，方法包括：获取单目相机的相机参数和地表对应的数字高程模型，并获取实时视频流数据，以获取多个待分析地表物体图像；根据相机参数、数字高程模型和预先生成的单目相机安装误差，确定指定光线射线的当前空间位置；根据每个待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与数字高程模型的交点坐标；基于交点坐标，确定每个待分析地表物体的实时空间位置数据；通过每个待分析地表物体的实时空间位置数据，对多个待分析地表物体进行空间分析。
权利要求书clms
1.一种单目相机的地表物体空间分析方法，其特征在于，所述方法包括：获取单目相机的相机参数和地表对应的数字高程模型，并获取所述单目相机采集的地表物体对应的实时视频流数据，以在所述实时视频流数据的视频帧中获取多个待分析地表物体图像；根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置，其中，所述指定光线射线为所述单目相机的当前安装位置与每个所述地表物体与地面接触点的光线射线；根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与所述数字高程模型的交点坐标；基于每个指定光线射线与所述数字高程模型的交点坐标，确定每个所述待分析地表物体的实时空间位置数据；通过每个所述待分析地表物体的实时空间位置数据，对所述多个待分析地表物体进行空间分析。2.根据权利要求1所述的一种单目相机的地表物体空间分析方法，其特征在于，根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置之前，所述方法还包括：确定所述相机参数中的内方位元素数据和预先通过所述单目相机采集的校正图像数据，所述校正图像数据包括参考地表物体、所述参考地表物体的实际位置坐标；根据所述相机参数中的内方位元素数据、所述校正图像数据和预先设置的初始单目相机安装误差，生成所述参考地表物体的计算位置坐标；基于所述参考地表物体的计算位置坐标和所述参考地表物体的实际位置坐标，对所述初始单目相机安装误差进行校正，生成符合要求的单目相机安装误差。3.根据权利要求2所述的一种单目相机的地表物体空间分析方法，其特征在于，根据所述相机参数中的内方位元素数据、所述校正图像数据和预先设置的初始单目相机安装误差，生成所述参考地表物体的计算位置坐标，具体包括：根据所述相机参数中的内方位元素数据和所述校正图像数据，生成所述单目相机与所述参考地表物体与地面接触点的第一光线射线的初始空间位置；根据所述初始空间位置和预先设置的初始单目相机安装误差，确定所述第一光线射线与所述数字高程模型的计算交点坐标，将所述计算交点坐标作为所述参考地表物体的计算位置坐标。4.根据权利要求1所述的一种单目相机的地表物体空间分析方法，其特征在于，根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置，具体包括：确定所述相机参数，其中，所述相机参数包括内方位元素数据和相机安装位置点的相机安装位置坐标；根据所述单目相机安装误差和所述相机安装位置坐标，生成所述单目相机的云台水平夹角和云台垂直夹角；确定所述待分析地表物体图像中待分析地表物体与地面的接触点，并根据所述接触点，生成所述接触点与所述相机安装位置点的指定光线射线；根据所述相机参数中的内方位元素数据，生成所述指定光线射线与所述单目相机主光轴的光线水平夹角和光线垂直夹角；基于所述云台水平夹角和所述光线水平夹角，生成所述指定光线射线的方位角；基于所述云台垂直夹角和所述光线垂直夹角，生成所述指定光线射线的俯仰角；通过所述相机安装位置点、所述指定光线射线的方位角和所述指定光线射线的俯仰角，确定所述指定光线射线的当前空间位置。5.根据权利要求1所述的一种单目相机的地表物体空间分析方法，其特征在于，根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与所述数字高程模型的交点坐标，具体包括：确定所述数字高程模型中的多个栅格；在所述多个栅格中进行栅格筛选，得到符合要求的指定数量个栅格；根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定所述指定光线射线与所述指定数量个栅格之间的多个待选交点；获取每个待选交点与所述单目相机的当前安装位置之间的距离；根据每个待选交点与所述单目相机的当前安装位置之间的距离，在所述多个待选交点中，将距离最近的第一交点作为所述指定光线射线与所述数字高程模型的交点，并生成所述交点坐标。6.根据权利要求5所述的一种单目相机的地表物体空间分析方法，其特征在于，生成所述交点坐标，具体包括：确定所述第一交点对应的栅格平面，以确定所述第一交点对应的栅格平面的第一平面法向量坐标；在所述栅格平面中，获取任意一点的点坐标；根据所述指定光线射线的当前空间位置，确定所述指定光线射线对应的向量坐标；根据所述当前安装位置坐标、所述第一平面法向量坐标、所述点坐标和所述指定光线射线对应的向量坐标，生成所述交点坐标。7.根据权利要求2所述的一种单目相机的地表物体空间分析方法，其特征在于，基于所述参考地表物体的计算位置坐标和所述参考地表物体的实际位置坐标，对所述初始单目相机安装误差进行校正，生成符合要求的单目相机安装误差，具体包括：根据所述参考地表物体的计算位置坐标和所述参考地表物体的实际位置坐标，计算所述计算位置坐标和所述实际位置坐标的差值；判断所述计算位置坐标和所述实际位置坐标的差值是否满足预设误差范围；若所述计算位置坐标和所述实际位置坐标的差值不满足所述预设误差范围，调整所述初始单目相机安装误差中的多个位置位移调整参数和偏转角参数，生成校正单目相机安装误差；根据所述相机参数中的内方位元素数据、所述校正图像数据和所述校正单目相机安装误差，生成所述参考地表物体的校正计算位置坐标；确定所述校正计算位置坐标和所述实际位置坐标之间的差值，当所述校正计算位置坐标和所述实际位置坐标之间的差值符合所述预设误差范围时，将所述校正计算位置坐标，作为符合要求的单目相机安装误差。8.根据权利要求1所述的一种单目相机的地表物体空间分析方法，其特征在于，通过每个所述待分析地表物体的实时空间位置数据，对所述多个待分析地表物体进行空间分析，具体包括：根据每个所述待分析地表物体的实时空间位置数据，生成多个待分析地表物体之间的相对空间位置关系；获取任意时间间隔内多个时刻下每个所述待分析地表物体的多个实时空间位置数据；根据每个所述待分析地表物体的多个实时空间位置数据，生成每个所述待分析地表物体在所述时间间隔内的空间变化轨迹；根据所述多个待分析物体之间的相对空间位置关系和所述空间变化轨迹，对所述多个待分析地表物体进行空间分析。9.一种单目相机的地表物体空间分析设备，其特征在于，所述设备包括：至少一个处理器；以及，与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行如权利要求1-8中所述的方法。10.一种非易失性计算机存储介质，存储有计算机可执行指令，其特征在于，所述计算机可执行指令设置为：获取单目相机的相机参数和地表对应的数字高程模型，并获取所述单目相机采集的地表物体对应的实时视频流数据，以在所述实时视频流数据的视频帧中获取多个待分析地表物体图像；根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置，其中，所述指定光线射线为所述单目相机的当前安装位置与每个所述地表物体与地面接触点的光线射线；根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与所述数字高程模型的交点坐标；基于每个指定光线射线与所述数字高程模型的交点坐标，确定每个所述待分析地表物体的实时空间位置数据；通过每个所述待分析地表物体的实时空间位置数据，对所述多个待分析地表物体进行空间分析。
说明书desc
技术领域本说明书涉及空间定位技术领域，尤其涉及一种单目相机的地表物体空间分析方法、设备及介质。背景技术在水利领域中，水利安全监测尤其重要，水利安全监测适用于水利管理部门远程监测水库实时数据，同时支持远程图像监控，为保障水库提供了准确、及时的现场信息。在进行水利安全监测时，需要对地表物体的空间活动进行分析。在隐患预警的场景下，当在监测区域内出现人员或异常物体时，其所处的实际位置、移动轨迹都是需要监测的内容。另外，在日常监测的场景下，对地表物体进行空间分析可以及时发现异常情况，起到安全防护的作用。在对地表物体进行空间分析时，需要对地表物体进行定位，视觉定位测量技术目前主要分为单目视觉测量、多目视觉测量等。其中多目视觉测量是利用多相机同时采集图像，并根据各相机间的相对位置关系确定空间坐标。单目相机相对于多目相机存在结构简单、测量视场范围大等优势，并且在实时测量中避免了特征点匹配等问题。在水利领域，单目相机的安装通常会安装在距离地面一定高度的位置处，不同的安装参数下采集到的图像不同，现有的通过单目相机进行空间定位的方法未考虑相机的安装误差，导致定位结果不准确，也就无法对地表物体进行准确的空间分析，此外，在采集到图像后需要进行数据处理的过程，导致空间分析的实时性较差。因此，目前的单目相机定位方法由于无法实时、准确的得到物体实际位置，导致无法满足水利领域空间分析的准确性和实时性的分析需求。发明内容本说明书一个或多个实施例提供了一种单目相机的地表物体空间分析方法、设备及介质，用于解决如下技术问题：目前的单目相机定位方法由于无法实时、准确的得到物体实际位置，导致无法满足水利领域空间分析的准确性和实时性的分析需求。本说明书一个或多个实施例采用下述技术方案：本说明书一个或多个实施例提供一种单目相机的地表物体空间分析方法，所述方法包括：获取单目相机的相机参数和地表对应的数字高程模型，并获取所述单目相机采集的地表物体对应的实时视频流数据，以在所述实时视频流数据的视频帧中获取多个待分析地表物体图像；根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置，其中，所述指定光线射线为所述单目相机的当前安装位置与每个所述地表物体与地面接触点的光线射线；根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与所述数字高程模型的交点坐标；基于每个指定光线射线与所述数字高程模型的交点坐标，确定每个所述待分析地表物体的实时空间位置数据；通过每个所述待分析地表物体的实时空间位置数据，对所述多个待分析地表物体进行空间分析。进一步地，根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置之前，所述方法还包括：确定所述相机参数中的内方位元素数据和预先通过所述单目相机采集的校正图像数据，所述校正图像数据包括参考地表物体、所述参考地表物体的实际位置坐标；根据所述相机参数中的内方位元素数据、所述校正图像数据和预先设置的初始单目相机安装误差，生成所述参考地表物体的计算位置坐标；基于所述参考地表物体的计算位置坐标和所述参考地表物体的实际位置坐标，对所述初始单目相机安装误差进行校正，生成符合要求的单目相机安装误差。进一步地，根据所述相机参数中的内方位元素数据、所述校正图像数据和预先设置的初始单目相机安装误差，生成所述参考地表物体的计算位置坐标，具体包括：根据所述相机参数中的内方位元素数据和所述校正图像数据，生成所述单目相机与所述参考地表物体与地面接触点的第一光线射线的初始空间位置；根据所述初始空间位置和预先设置的初始单目相机安装误差，确定所述第一光线射线与所述数字高程模型的计算交点坐标，将所述计算交点坐标作为所述参考地表物体的计算位置坐标。进一步地，根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置，具体包括：确定所述相机参数，其中，所述相机参数包括内方位元素数据和相机安装位置点的相机安装位置坐标；根据所述单目相机安装误差和所述相机安装位置坐标，生成所述单目相机的云台水平夹角和云台垂直夹角；确定所述待分析地表物体图像中待分析地表物体与地面的接触点，并根据所述接触点，生成所述接触点与所述相机安装位置点的指定光线射线；根据所述相机参数中的内方位元素数据，生成所述指定光线射线与所述单目相机主光轴的光线水平夹角和光线垂直夹角；基于所述云台水平夹角和所述光线水平夹角，生成所述指定光线射线的方位角；基于所述云台垂直夹角和所述光线垂直夹角，生成所述指定光线射线的俯仰角；通过所述相机安装位置点、所述指定光线射线的方位角和所述指定光线射线的俯仰角，确定所述指定光线射线的当前空间位置。进一步地，根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与所述数字高程模型的交点坐标，具体包括：确定所述数字高程模型中的多个栅格；在所述多个栅格中进行栅格筛选，得到符合要求的指定数量个栅格；根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定所述指定光线射线与所述指定数量个栅格之间的多个待选交点；获取每个待选交点与所述单目相机的当前安装位置之间的距离；根据每个待选交点与所述单目相机的当前安装位置之间的距离，在所述多个待选交点中，将距离最近的第一交点作为所述指定光线射线与所述数字高程模型的交点，并生成所述交点坐标。进一步地，生成所述交点坐标，具体包括：确定所述第一交点对应的栅格平面，以确定所述第一交点对应的栅格平面的第一平面法向量坐标；在所述栅格平面中，获取任意一点的点坐标；根据所述指定光线射线的当前空间位置，确定所述指定光线射线对应的向量坐标；根据所述当前安装位置坐标、所述第一平面法向量坐标、所述点坐标和所述指定光线射线对应的向量坐标，生成所述交点坐标。进一步地，基于所述参考地表物体的计算位置坐标和所述参考地表物体的实际位置坐标，对所述初始单目相机安装误差进行校正，生成符合要求的单目相机安装误差，具体包括：根据所述参考地表物体的计算位置坐标和所述参考地表物体的实际位置坐标，计算所述计算位置坐标和所述实际位置坐标的差值；判断所述计算位置坐标和所述实际位置坐标的差值是否满足预设误差范围；若所述计算位置坐标和所述实际位置坐标的差值不满足所述预设误差范围，调整所述初始单目相机安装误差中的多个位置位移调整参数和偏转角参数，生成校正单目相机安装误差；根据所述相机参数中的内方位元素数据、所述校正图像数据和所述校正单目相机安装误差，生成所述参考地表物体的校正计算位置坐标；确定所述校正计算位置坐标和所述实际位置坐标之间的差值，当所述校正计算位置坐标和所述实际位置坐标之间的差值符合所述预设误差范围时，将所述校正计算位置坐标，作为符合要求的单目相机安装误差。进一步地，通过每个所述待分析地表物体的实时空间位置数据，对所述多个待分析地表物体进行空间分析，具体包括：根据每个所述待分析地表物体的实时空间位置数据，生成多个待分析地表物体之间的相对空间位置关系；获取任意时间间隔内多个时刻下每个所述待分析地表物体的多个实时空间位置数据；根据每个所述待分析地表物体的多个实时空间位置数据，生成每个所述待分析地表物体在所述时间间隔内的空间变化轨迹；根据所述多个待分析物体之间的相对空间位置关系和所述空间变化轨迹，对所述多个待分析地表物体进行空间分析。本说明书一个或多个实施例提供一种单目相机的地表物体空间分析设备，包括：至少一个处理器；以及，与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行上述方法。本说明书一个或多个实施例提供的一种非易失性计算机存储介质，存储有计算机可执行指令，所述计算机可执行指令设置为：获取单目相机的相机参数和地表对应的数字高程模型，并获取所述单目相机采集的地表物体对应的实时视频流数据，以在所述实时视频流数据的视频帧中获取多个待分析地表物体图像；根据所述相机参数、所述数字高程模型和预先生成的单目相机安装误差，确定所述单目相机与每个待分析地表物体的指定光线射线的当前空间位置，其中，所述指定光线射线为所述单目相机的当前安装位置与每个所述地表物体与地面接触点的光线射线；根据每个所述待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与所述数字高程模型的交点坐标；基于每个指定光线射线与所述数字高程模型的交点坐标，确定每个所述待分析地表物体的实时空间位置数据；通过每个所述待分析地表物体的实时空间位置数据，对所述多个待分析地表物体进行空间分析。本说明书实施例采用的上述至少一个技术方案能够达到以下有益效果：通过上述技术方案，根据相机参数、数字高程模型和预先生成的单目相机安装误差，确定单目相机与每个待分析地表物体的指定光线射线的当前空间位置，考虑单目相机的安装误差，对光线射线进行校正，保证了定位的准确性；根据每个指定光线射线与数字高程模型的交点坐标，生成每个待分析地表物体的实时空间位置数据，对地表物体进行非接触定位，可以实时获得到多个物体真实空间坐标；将现实世界的地表物体实时投射到虚拟信息系统中，可以利用地理信息技术实时分析区域内，地表物体的轨迹运动及空间分布情况，还可利用结果中的高程信息得到闸站水位；此外，由于是用单目摄像头进行信息采集，可以充分利用存量摄像头硬件资源，没有硬件重复建设，硬件成本低，并且可以满足位置数据的实时性需求。附图说明为了更清楚地说明本说明书实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本说明书中记载的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。在附图中：图1为本说明书实施例提供的一种单目相机的地表物体空间分析方法的流程示意图；图2为本说明书实施例提供的一种单目相机安装误差的校正流程示意图；图3为本说明书实施例提供的一种地表物体与地面接触的应用示意图；图4为本说明书实施例提供的一种夹角计算示意图；图5为本说明书实施例提供的一种光线射线与数字高程模型的空间位置关系示意图；图6为本说明书实施例提供的一种光线射线与数字高程模型的交点示意图；图7为本说明书实施例提供的一种单目相机的地表物体空间分析设备的结构示意图。具体实施方式为了使本技术领域的人员更好地理解本说明书中的技术方案，下面将结合本说明书实施例中的附图，对本说明书实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本说明书一部分实施例，而不是全部的实施例。基于本说明书实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都应当属于本说明书保护的范围。在水利领域中，水利安全监测尤其重要，水利安全监测适用于水利管理部门远程监测水库实时数据，同时支持远程图像监控，为保障水库提供了准确、及时的现场信息。在进行水利安全监测时，需要对地表物体的空间活动进行分析。在隐患预警的场景下，当在监测区域内出现人员或异常物体时，其所处的实际位置、移动轨迹都是需要监测的内容。另外，在日常监测的场景下，对地表物体进行空间分析可以及时发现异常情况，起到安全防护的作用。在对地表物体进行空间分析时，需要对地表物体进行定位，视觉定位测量技术目前主要分为单目视觉测量、多目视觉测量等。其中多目视觉测量是利用多相机同时采集图像，并根据各相机间的相对位置关系确定空间坐标。单目相机相对于多目相机存在结构简单、测量视场范围大等优势，并且在实时测量中避免了特征点匹配等问题。在水利领域，单目相机的安装通常会安装在距离地面一定高度的位置处，不同的安装参数下采集到的图像不同，现有的通过单目相机进行空间定位的方法未考虑相机的安装误差，导致定位结果不准确，也就无法对地表物体进行准确的空间分析，此外，在采集到图像后需要进行数据处理的过程，导致空间分析的实时性较差。因此，目前的单目相机定位方法由于无法实时、准确的得到物体实际位置，导致无法满足水利领域空间分析的准确性和实时性的分析需求。本说明书实施例提供一种单目相机的地表物体空间分析方法，需要说明的是，本说明书实施例中的执行主体可以是服务器，也可以是任意一种具备数据处理能力的设备。图1为本说明书实施例提供的一种单目相机的地表物体空间分析方法的流程示意图，如图1所示，主要包括如下步骤：步骤S101，获取单目相机的相机参数和地表对应的数字高程模型，并获取单目相机采集的地表物体对应的实时视频流数据，以在实时视频流数据的视频帧中获取多个待分析地表物体图像。在本说明书的一个实施例中，获取单目相机的相机参数，相机参数包括内方位元素数据和相机安装位置点的相机安装位置坐标，此处的内方位元素数据是指摄影中心与像片之间相关位置的参数。包括内参矩阵。并获取预先构建的地表对应的数字高程模型，数字高程模型，用一组有序数值阵列形式表示地面高程的一种实体地面模型。由于DEM描述的是地面高程信息，在测绘、水文、气象、地貌、地质、土壤、工程建设、通讯、军事等国民经济和国防建设以及人文和自然科学领域有着广泛的应用。在本说明书的一个实施例中，通过单目相机摄像头采集地表物体对应的实时视频流数据。在得到实时视频流数据中，在实时视频流数据的视频帧中获取多个待分析地表物体图像，在每个待分析地表物体图像中均包括至少一个待分析地表物体。步骤S102，根据相机参数、数字高程模型和预先生成的单目相机安装误差，确定单目相机与每个待分析地表物体的指定光线射线的当前空间位置。其中，该指定光线射线为该单目相机的当前安装位置与每个该地表物体与地面接触点的光线射线。根据该相机参数、该数字高程模型和预先生成的单目相机安装误差，确定该单目相机与每个待分析地表物体的指定光线射线的当前空间位置之前，该方法还包括：确定该相机参数中的内方位元素数据和预先通过该单目相机采集的校正图像数据，该校正图像数据包括参考地表物体、该参考地表物体的实际位置坐标；根据该相机参数中的内方位元素数据、该校正图像数据和预先设置的初始单目相机安装误差，生成该参考地表物体的计算位置坐标；基于该参考地表物体的计算位置坐标和该参考地表物体的实际位置坐标，对该初始单目相机安装误差进行校正，生成符合要求的单目相机安装误差。基于该参考地表物体的计算位置坐标和该参考地表物体的实际位置坐标，对该初始单目相机安装误差进行校正，生成符合要求的单目相机安装误差，具体包括：根据该参考地表物体的计算位置坐标和该参考地表物体的实际位置坐标，计算该计算位置坐标和该实际位置坐标的差值；判断该计算位置坐标和该实际位置坐标的差值是否满足预设误差范围；若该计算位置坐标和该实际位置坐标的差值不满足该预设误差范围，调整该初始单目相机安装误差中的多个位置位移调整参数和偏转角参数，生成校正单目相机安装误差；根据该相机参数中的内方位元素数据、该校正图像数据和该校正单目相机安装误差，生成该参考地表物体的校正计算位置坐标；确定该校正计算位置坐标和该实际位置坐标之间的差值，当该校正计算位置坐标和该实际位置坐标之间的差值符合该预设误差范围时，将该校正计算位置坐标，作为符合要求的单目相机安装误差。根据该相机参数中的内方位元素数据、该校正图像数据和预先设置的初始单目相机安装误差，生成该参考地表物体的计算位置坐标，具体包括：根据该相机参数中的内方位元素数据和该校正图像数据，生成该单目相机与该参考地表物体与地面接触点的第一光线射线的初始空间位置；根据该初始空间位置和预先设置的初始单目相机安装误差，确定该第一光线射线与该数字高程模型的计算交点坐标，将该计算交点坐标作为该参考地表物体的计算位置坐标。在本说明书的一个实施例中，相机的镜头在制作的时候存在误差，此外当光线进入摄像机镜头也会发生折射，因此需要对光线进行校正以抵消相机畸变。首先，固定摄像头焦距，使用棋盘标定板对摄像头进行标定，可以得到此焦距设定下的内方位元素数据，也就是内参矩阵。在本说明书的一个实施例中，图2为本说明书实施例提供的一种单目相机安装误差的校正流程示意图，如图2所示，确定相机参数中的内方位元素数据和预先通过单目相机采集的校正图像数据，校正图像数据包括参考地表物体、参考地表物体的实际位置坐标，主要用于对相机的安装误差进行校正，图2中的已知点图片坐标，是指已知实际空间位置的参考地表物体的图片坐标。根据相机参数中的内方位元素数据、校正图像数据和预先设置的初始单目相机安装误差，生成参考地表物体的计算位置坐标。图3为本说明书实施例提供的一种地表物体与地面接触的应用示意图，如图3所示，地表物体的移动作用在地表上，移动的物体与地表有接触点X，相机拍摄点O与X唯一确定一条射线。由于摄像头安装位置是固定的，拍摄位置O的坐标是已知的，云台水平方向与正北方向有夹角，夹角为δ1，云台垂直方向俯仰角为γ1。此外，需要说明的是，安装位置决定了拍摄位置，本说明书实施例提到的安装位置也可以通过拍摄位置实现。图4为本说明书实施例提供的一种夹角计算示意图，如图4所示，将待分析地表物体X在摄像头的视频帧上的投影点记为x，根据内方位元素，在像空间坐标系内根据X相片坐标计算与主光轴水平夹角δ2及垂直夹角γ2。水平夹角δ2与垂直夹角γ2的计算可以根据三角函数计算得到。则光线射线的方位角α=δ1+δ2，光线的俯仰角β=γ1+γ2。由于光线射线过O点，且则可确定射线OX空间位置。另外，由于摄像头安装误差，无法做到完全水平安装和垂直安装，因此还需要给其位置设置三个位置位移调整参数和三个偏转角参数，以便校正时使用。在本说明书的一个实施例中，预先设置初始单目相机安装误差，根据初始空间位置和预先设置的初始单目相机安装误差，确定第一光线射线与该数字高程模型的计算交点坐标，将该计算交点坐标作为该参考地表物体的计算位置坐标。图5为本说明书实施例提供的一种光线射线与数字高程模型的空间位置关系示意图，如图5所示，摄像机拍到的地面部分，从O点与地面部分点连线构成的所有射线，与DEM是相交的，计算射线OX与DEM的交点就可以得到物体与地表接触点坐标，也就是X点坐标。得到X的坐标后，检验计算值与真实值的差距，调整摄像头安装误差的三个位置位移调整参数和三个偏转角参数，直到满意为止，并记录上述参数供后续计算使用。根据该相机参数、该数字高程模型和预先生成的单目相机安装误差，确定该单目相机与每个待分析地表物体的指定光线射线的当前空间位置，具体包括：确定该相机参数，其中，该相机参数包括内方位元素数据和相机安装位置点的相机安装位置坐标；根据该单目相机安装误差和该相机安装位置坐标，生成该单目相机的云台水平夹角和云台垂直夹角；确定该待分析地表物体图像中待分析地表物体与地面的接触点，并根据该接触点，生成该接触点与该相机安装位置点的指定光线射线；根据该相机参数中的内方位元素数据，生成该指定光线射线与该单目相机主光轴的光线水平夹角和光线垂直夹角；基于该云台水平夹角和该光线水平夹角，生成该指定光线射线的方位角；基于该云台垂直夹角和该光线垂直夹角，生成该指定光线射线的俯仰角；通过该相机安装位置点、该指定光线射线的方位角和该指定光线射线的俯仰角，确定该指定光线射线的当前空间位置。在本说明书的一个实施例中，根据图3和图4所示，地表物体的移动作用在地表上，移动的物体与地表有接触点X，相机拍摄点O与X唯一确定一条射线。由于摄像头安装位置是固定的，拍摄位置O的坐标是已知的，云台水平方向与正北方向有夹角，夹角为δ1，云台垂直方向俯仰角为γ1。此外，需要说明的是，安装位置决定了拍摄位置，本说明书实施例提到的安装位置也可以通过拍摄位置实现。将待分析地表物体X在摄像头的视频帧上的投影点记为x，根据内方位元素，在像空间坐标系内根据X相片坐标计算与主光轴水平夹角δ2及垂直夹角γ2。水平夹角δ2与垂直夹角γ2的计算可以根据三角函数计算得到。则光线射线的方位角α=δ1+δ2，光线的俯仰角β=γ1+γ2。由于光线射线过O点，且则可确定射线OX空间位置。步骤S103，根据每个待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与数字高程模型的交点坐标。根据每个该待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与该数字高程模型的交点坐标，具体包括：确定该数字高程模型中的多个栅格；在该多个栅格中进行栅格筛选，得到符合要求的指定数量个栅格；根据每个该待分析地表物体对应的指定光线射线的当前空间位置，确定该指定光线射线与该指定数量个栅格之间的多个待选交点；获取每个待选交点与该单目相机的当前安装位置之间的距离；根据每个待选交点与该单目相机的当前安装位置之间的距离，在该多个待选交点中，将距离最近的第一交点作为该指定光线射线与该数字高程模型的交点，并生成该交点坐标。生成该交点坐标，具体包括：确定该第一交点对应的栅格平面，以确定该第一交点对应的栅格平面的第一平面法向量坐标；在该栅格平面中，获取任意一点的点坐标；根据该指定光线射线的当前空间位置，确定该指定光线射线对应的向量坐标；根据该当前安装位置坐标、该第一平面法向量坐标、该点坐标和该指定光线射线对应的向量坐标，生成该交点坐标。在本说明书的一个实施例中，在做好校正的前提下，摄像机拍到的地面部分，从O点与地面部分点连线构成的所有射线，与DEM是相交的，计算射线OX与DEM的交点就可以得到物体与地表接触点坐标。需要说明的是，DEM的精度越高，计算得到坐标的精度越高。DEM是规则的按行按列排列的格网数据，每个格子记录的数值代表该格子的高程，格子的四个角点都有明确的水平坐标和高程值。在本说明书的一个实施例中，可以将单个DEM格子看做一个四棱柱，通过计算射线OX与四棱柱表面的交点即可得到X的坐标。在计算射线OX与四棱柱表面的交点前进行数据过滤。由于DEM是密集的数据，以O为原点，根据空间射线所在的象限，过滤掉大部分数据以节省计算时间。将光线射线与四棱柱的四个侧面的交点作为待选点，此外，待选点还包括光线射线与四棱柱顶面的交点，在多个待选点中，根据每个待选点与该单目相机的当前安装位置之间的距离，将离点O最近的点坐标即为X的坐标。此处的点O可以理解为拍摄点，也可以理解为相机的安装位置点。图6为本说明书实施例提供的一种光线射线与数字高程模型的交点示意图，如图6所示，设X为待求坐标点，坐标为；O是拍摄点，坐标为，由实际测量及误差校正得到；N是平面上一点，坐标为，可以任选一个格子角点坐标代替；向量Vn是平面法向量，记为，如果是四棱柱顶部面，可以取值，如果是左右的侧面可以取值，如果是前后的侧面可以取值；向量V代表射线OX，记为，零水平面的高程为0，射线与零水平面的交点坐标可以经过三角函数计算得到，然后根据射线与零水平面的交点坐标和O点坐标得到。射线与平面相交点坐标计算公式如下所示：x = ox + vx × ty = oy + vy × tz = oz + vz × t其中，t =  × vnx +  × vny +  × vnz) / pp = vnx × vx + vny × vy + vnz × vz，p不能等于0，当p等于0时，表示射线OX与平面没有交点。按照上述公式计算得到X点坐标，在生成每个指定光线射线与数字高程模型之间的交点坐标时，对得到的X点坐标寻找最优解，得到每个指定光线射线与数字高程模型的交点坐标。步骤S104，基于每个指定光线射线与数字高程模型的交点坐标，确定每个待分析地表物体的实时空间位置数据。在本说明书的一个实施例中，将每个指定光线射线与数字高程模型的交点坐标，作为每个待分析地表物体的实时空间位置数据。步骤S105，通过每个待分析地表物体的实时空间位置数据，对多个待分析地表物体进行空间分析。通过每个该待分析地表物体的实时空间位置数据，对该多个待分析地表物体进行空间分析，具体包括：根据每个该待分析地表物体的实时空间位置数据，生成多个待分析地表物体之间的相对空间位置关系；获取任意时间间隔内多个时刻下每个该待分析地表物体的多个实时空间位置数据；根据每个该待分析地表物体的多个实时空间位置数据，生成每个该待分析地表物体在该时间间隔内的空间变化轨迹；根据该多个待分析物体之间的相对空间位置关系和该空间变化轨迹，对该多个待分析地表物体进行空间分析。在本说明书的一个实施例中，根据每个该待分析地表物体的实时空间位置数据，生成多个待分析地表物体之间的相对空间位置关系，通过多个待分析地表物体之间的相对空间位置关系，可以防止多个待分析地表物体之间的碰撞等问题。获取任意时间间隔内多个时刻下每个该待分析地表物体的多个实时空间位置数据，根据每个该待分析地表物体的多个实时空间位置数据，生成每个该待分析地表物体在该时间间隔内的空间变化轨迹，基于每个该待分析地表物体在时间间隔内的空间变化轨迹，可以对每个待分析地表物体的运行情况进行监测。根据多个待分析物体之间的相对空间位置关系和空间变化轨迹，对多个待分析地表物体进行空间分析。通过上述技术方案，根据相机参数、数字高程模型和预先生成的单目相机安装误差，确定单目相机与每个待分析地表物体的指定光线射线的当前空间位置，考虑单目相机的安装误差，对光线射线进行校正，保证了定位的准确性；根据每个指定光线射线与数字高程模型的交点坐标，生成每个待分析地表物体的实时空间位置数据，对地表物体进行非接触定位，可以实时获得到多个物体真实空间坐标；将现实世界的地表物体实时投射到虚拟信息系统中，可以利用地理信息技术实时分析区域内，地表物体的轨迹运动及空间分布情况，还可利用结果中的高程信息得到闸站水位；此外，由于是用单目摄像头进行信息采集，可以充分利用存量摄像头硬件资源，没有硬件重复建设，硬件成本低，并且可以满足位置数据的实时性需求。本说明书实施例还提供一种单目相机的地表物体空间分析设备，如图7所示，设备包括：至少一个处理器；以及，与至少一个处理器通信连接的存储器；其中，存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行上述方法。本说明书实施例还提供一种非易失性计算机存储介质，存储有计算机可执行指令，计算机可执行指令设置为：获取单目相机的相机参数和地表对应的数字高程模型，并获取该单目相机采集的地表物体对应的实时视频流数据，以在该实时视频流数据的视频帧中获取多个待分析地表物体图像；根据该相机参数、该数字高程模型和预先生成的单目相机安装误差，确定该单目相机与每个待分析地表物体的指定光线射线的当前空间位置，其中，该指定光线射线为该单目相机的当前安装位置与每个该地表物体与地面接触点的光线射线；根据每个该待分析地表物体对应的指定光线射线的当前空间位置，确定每个指定光线射线与该数字高程模型的交点坐标；基于每个指定光线射线与该数字高程模型的交点坐标，确定每个该待分析地表物体的实时空间位置数据；通过每个该待分析地表物体的实时空间位置数据，对该多个待分析地表物体进行空间分析。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于装置、设备、非易失性计算机存储介质实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。上述对本说明书特定实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书实施例提供的设备和介质与方法是一一对应的，因此，设备和介质也具有与其对应的方法类似的有益技术效果，由于上面已经对方法的有益技术效果进行了详细说明，因此，这里不再赘述设备和介质的有益技术效果。本领域内的技术人员应明白，本说明书的实施例可提供为方法、系统、或计算机程序产品。因此，本说明书可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本说明书可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本说明书是参照根据本说明书实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。在一个典型的配置中，计算设备包括一个或多个处理器 、输入/输出接口、网络接口和内存。内存可能包括计算机可读介质中的非永久性存储器，随机存取存储器  和/或非易失性内存等形式，如只读存储器  或闪存。内存是计算机可读介质的示例。计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存 、静态随机存取存储器 、动态随机存取存储器 、其他类型的随机存取存储器 、只读存储器 、电可擦除可编程只读存储器 、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘  或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体 ，如调制的数据信号和载波。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。以上所述仅为本说明书的一个或多个实施例而已，并不用于限制本说明书。对于本领域技术人员来说，本说明书的一个或多个实施例可以有各种更改和变化。凡在本说明书的一个或多个实施例的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本说明书的权利要求范围之内。
