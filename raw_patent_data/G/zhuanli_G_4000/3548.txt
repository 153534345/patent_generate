标题title
一种基于改进Transformer的燃气轮机故障诊断方法
摘要abst
本发明提供了一种基于改进Transformer的燃气轮机故障诊断方法，涉及故障诊断技术领域，包括如下步骤：S1、获取目标工业设备的传感器历史测量数据，得到训练数据集和测试数据集；S2、构建基于改进Transformer的故障诊断模型；S3、搭建网络训练框架，分批次将训练数据集输入到故障诊断模型中，得到训练后模型；S4、分批次将测试数据集输入到训练后模型中，记录模型预测值和重构误差；S5、设定故障阈值，当所述重构误差大于阈值时，判定设备发生故障，否则判定设备处于正常工作状态，完成故障诊断。本发明通过引入卷积神经网络作为特征提取器增强了算法对局部特征的关注能力，提高了算法对与正常运行状态偏差很小的故障数据的识别能力，保证了故障在恶化之前可以被及时发现。
权利要求书clms
1.一种基于改进Transformer的燃气轮机故障诊断方法，其特征在于，包括如下步骤：S1、获取目标工业设备的传感器历史测量数据，并对历史测量数据进行数据预处理和数据集划分，得到训练数据集和测试数据集；S2、构建基于改进Transformer的故障诊断模型；S3、搭建网络训练框架，分批次将S1中得到的训练数据集输入到步骤S2搭建的故障诊断模型中，得到训练后模型；S4、分批次将步骤S1中得到的测试数据集输入到训练后模型中，记录模型预测值和重构误差；S5、设定故障阈值，当所述重构误差大于阈值时，判定设备发生故障，否则判定设备处于正常工作状态，完成故障诊断。2.根据权利要求1所述的基于改进Transformer的燃气轮机故障诊断方法，其特征在于，S1具体包括如下步骤：S101、收集历史测量数据所述历史测量数据覆盖机组不同的运行工况；S102、对收集到的历史测量数据进行归一化处理，将历史测量数据放缩到范围内，得到预处理后数据，公式如下：其中xt是当前时刻的数据，和/＞分别是传感器记录数据/＞中的最大值和最小值；S103、将所述预处理后数据整理成batch_size×seq_len×N维度，其中，batch_size是为了满足神经网络并行化运算的需求，seq_len表示一次输入到模型的时间窗口长度，N为传感器数据维度；S104、将发生故障之前的样本数据划分为训练数据集，发生故障之后的样本数据划分为测试数据集。3.根据权利要求1所述的基于改进Transformer的燃气轮机故障诊断方法，其特征在于，S2具体包括如下步骤：S201、构建两层一维卷积网络，所述两层一维卷积网络用于提取不同传感器数据间的局部特征，卷积层使用的卷积核尺寸均为3，填充尺寸均为1，经过卷积层得到数据X；S202、将数据X复制成三份，第一份与矩阵O拼接，得到；第二份与第三份拼接，得到；将模型经过两阶段训练，第一阶段时矩阵O是与X同尺寸的全零向量，第二阶段时矩阵O是第一阶段训练得到的重构误差2；S203、构建位置编码，并与S202得到的对应位置相加；S204、构建多头自注意力层。定义三个矩阵向量：WQ,WK,WV，分别对S203得到的数据做线性变化，得到查询矩阵Q、键矩阵K和值矩阵V，再做如下运算:其中，dk为Q的维度，除以dk是为了防止内积过大；S205、将S203和S204得到的特征直接相加，构建残差网络，并将相加后的结果进行层标准化，以加快网络收敛；S206、构建线性层，并将线性层的输入和输出直接相加，构建残差网络，再将相加后的结果进行层标准化；S207、构建位置编码，并与S202得到的对应位置相加；S208、重复构建S204～S205的网络，并将S207得到的结果相继输入；S209、构建多头自注意力层。重新定义三个矩阵向量：WQ,WK,WV，其中WQ,WK分别对S206得到的数据、WV对S208得到的数据做线性变化，得到查询矩阵Q、键矩阵K和值矩阵V，再做同S204相同的运算；S210、重复构建S205的残差网络和层标准化，并将S209得到的结果相继输入；S211、构建线性层，构建Sigmoid层，将S210得到的结果相继输入，输出对S201输出的X的重构X1'，完成第一阶段训练。采用Sigmoid层是为了把输出的数据拟合到输入数据的归一化状态中，即范围内；S212、计算重构误差O＝2，如S202所述，代替第一阶段与X同尺寸的全零向量，此阶段将第一阶段的重构误差信息引入编码器的注意力层，引导模型关注重构误差较大的部分，重复S202～S211的过程，输出对S201输出的X的第二次重构X2'，完成第二阶段训练。第二阶段的训练可帮助模型加强对与机组健康工作时偏差较小的异常数据的关注；S213、对S211X1'得到的重构和S212得到的重构X2'采用对抗训练的方式，通过如下损失函数计算损失：其中n代表训练的轮数epochs；S214、选择Adam优化算法，公式如下：其中，wt表示原始梯度，a表示学习率，表示对梯度的一阶矩估计的校正，/＞表示对梯度的二阶矩估计的校正，ε是为了维持数值稳定性而添加的常数。4.根据权利要求1所述的基于改进Transformer的燃气轮机故障诊断方法，其特征在于，S3具体包括如下步骤：S301、设置训练的轮数、批处理数和学习率。S302、将训练数据集打乱，分批次输入到步骤S2搭建的模型中，计算每轮训练模型输出的损失值，并绘制图表。5.根据权利要求4所述的基于改进Transformer的燃气轮机故障诊断方法，其特征在于，S301中，训练的轮数设置为100、批处理数为128、学习率为0.001。6.一种存储介质，其特征在于，所述存储介质包括存储的程序，其中，所述程序运行时，执行所述权利要求1至5中任一项权利要求所述的基于改进Transformer的燃气轮机故障诊断方法。7.一种电子装置，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器通过所述计算机程序运行执行所述权利要求1至5中任一项权利要求所述的基于改进Transformer的燃气轮机故障诊断方法。
说明书desc
技术领域本发明涉及故障诊断技术领域，具体而言，尤其涉及一种基于改进Transformer的燃气轮机故障诊断方法。背景技术风力发电机、汽轮机和燃气轮机等动力设备是电力系统的重要组成部分，因动力设备故障导致停机甚至引发伤亡事故的事件时有发生。因此，研究如何提高动力设备运行的安全性与可靠性具有非常重要的意义。针对动力设备的故障诊断方法通过对传感器收集到的机组运行状态进行监测和分析，可以在故障程度轻微时准确地发现和识别故障，辅助运行人员对异常进行处理，避免严重事故，提高设备可靠性。现有的针对动力设备进行故障诊断的常见方法主要分为基于解析模型的方法、基于信号处理的方法和基于机器学习的方法。基于解析模型的方法需要建立不同系统变量间的机理模型，然而随着非线性系统复杂性和不确定性的增加，建立精确的动态模型变得越来越困难，大大限制了其发展。基于信号处理的方法需要人为设计特征提取的方法，具有主观性，针对某一特定类型故障提取和选择的特征可能并不适用于其它类型故障。近年来，随着人工智能技术的发展成熟，基于机器学习的故障诊断方法受到越来越多的重视。然而，传统的基于卷积神经网络的诊断方法卷积提取出的特征会更多地关注局部而非全局特征，且无法捕获长距离特征；而基于循环神经网络的诊断方法固有的顺序属性阻碍了训练样本间的并行化，且随着时间步长的增加会出现严重的信息丢失。这些都会对故障诊断的效果带来负面影响。目前还存在基于Transformer的诊断方法，而基于Transformer的诊断方法凭借其可以并行计算的特点和自注意力机制可以有效避免上述问题。然而，在故障发生的初期，由于故障数据的偏差很小，传统的基于Transformer的方法往往无法将故障数据与正常数据区分开，这将会导致模型无法在故障初期及时发现故障，错过故障排除的最佳时间窗口。发明内容有鉴于此，本发明的目的在于提出一种基于改进Transformer的燃气轮机故障诊断方法，以解决现有基于机器学习的故障诊断方法无法在故障发生的初期及时发现故障的问题。本发明采用的技术手段如下：一种基于改进Transformer的燃气轮机故障诊断方法，包括如下步骤：S1、获取目标工业设备的传感器历史测量数据，并对历史测量数据进行数据预处理和数据集划分，得到训练数据集和测试数据集；S2、构建基于改进Transformer的故障诊断模型；S3、搭建网络训练框架，分批次将S1中得到的训练数据集输入到步骤S2搭建的故障诊断模型中，得到训练后模型；S4、分批次将步骤S1中得到的测试数据集输入到训练后模型中，记录模型预测值和重构误差；S5、设定故障阈值，当所述重构误差大于阈值时，判定设备发生故障，否则判定设备处于正常工作状态，完成故障诊断。进一步地，S1具体包括如下步骤：S101、收集历史测量数据所述历史测量数据覆盖机组不同的运行工况；S102、对收集到的历史测量数据进行归一化处理，将历史测量数据放缩到范围内，得到预处理后数据，公式如下：其中xt是当前时刻的数据，和/＞分别是传感器记录数据/＞中的最大值和最小值；S103、将所述预处理后数据整理成batch_size×seq_len×N维度，其中，batch_size是为了满足神经网络并行化运算的需求，seq_len表示一次输入到模型的时间窗口长度，N为传感器数据维度；S104、将发生故障之前的样本数据划分为训练数据集，发生故障之后的样本数据划分为测试数据集。进一步地，S2具体包括如下步骤：S201、构建两层一维卷积网络，所述两层一维卷积网络用于提取不同传感器数据间的局部特征，卷积层使用的卷积核尺寸均为3，填充尺寸均为1，经过卷积层得到数据X；S202、将数据X复制成三份，第一份与矩阵O拼接，得到；第二份与第三份拼接，得到；将模型经过两阶段训练，第一阶段时矩阵O是与X同尺寸的全零向量，第二阶段时矩阵O是第一阶段训练得到的重构误差2；S203、构建位置编码，并与S202得到的对应位置相加；S204、构建多头自注意力层。定义三个矩阵向量：WQ,WK,WV，分别对S203得到的数据做线性变化，得到查询矩阵Q、键矩阵J和值矩阵V，再做如下运算:其中，dk为Q的维度，除以dk是为了防止内积过大；S205、将S203和S204得到的特征直接相加，构建残差网络，并将相加后的结果进行层标准化，以加快网络收敛；S206、构建线性层，并将线性层的输入和输出直接相加，构建残差网络，再将相加后的结果进行层标准化；S207、构建位置编码，并与S202得到的对应位置相加；S208、重复构建S204～S205的网络，并将S207得到的结果相继输入；S209、构建多头自注意力层。重新定义三个矩阵向量：WQ,WK,WV，其中WQ,WK分别对S206得到的数据、WV对S208得到的数据做线性变化，得到查询矩阵Q、键矩阵K和值矩阵V，再做同S204相同的运算；S210、重复构建S205的残差网络和层标准化，并将S209得到的结果相继输入；S211、构建线性层，构建Sigmoid层，将S210得到的结果相继输入，输出对S201输出的X的重构X1'，完成第一阶段训练。采用Sigmoid层是为了把输出的数据拟合到输入数据的归一化状态中，即范围内；S212、计算重构误差O＝2，如S202所述，代替第一阶段与X同尺寸的全零向量，此阶段将第一阶段的重构误差信息引入编码器的注意力层，引导模型关注重构误差较大的部分，重复S202～S211的过程，输出对S201输出的X的第二次重构X2'，完成第二阶段训练。第二阶段的训练可帮助模型加强对与机组健康工作时偏差较小的异常数据的关注；S213、对S211X1'得到的重构和S212得到的重构X2'采用对抗训练的方式，通过如下损失函数计算损失：其中n代表训练的轮数epochs；S214、选择Adam优化算法，公式如下：其中，wt表示原始梯度，a表示学习率，表示对梯度的一阶矩估计的校正，/＞表示对梯度的二阶矩估计的校正，ε是为了维持数值稳定性而添加的常数。进一步地，S3具体包括如下步骤：S301、设置训练的轮数、批处理数和学习率。S302、将训练数据集打乱，分批次输入到步骤S2搭建的模型中，计算每轮训练模型输出的损失值，并绘制图表。进一步地，S301中，训练的轮数设置为100、批处理数为128、学习率为0.001。本发明还提供了一种存储介质，所述存储介质包括存储的程序，其中，所述程序运行时，执行上述任一项基于改进Transformer的燃气轮机故障诊断方法。本发明还提供了一种电子装置，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述处理器通过所述计算机程序运行执行上述任一项基于改进Transformer的燃气轮机故障诊断方法。较现有技术相比，本发明具有以下优点：本发明提出的基于改进Transformer的故障诊断模型，在大大减少深度学习算法训练和测试时间、减少计算资源、提高对长距离特征学习能力的同时，通过引入卷积神经网络作为特征提取器增强了算法对局部特征的关注能力，引入生成对抗网络的训练机制，提高了算法对与正常运行状态偏差很小的故障数据的识别能力，保证了故障在恶化之前可以被及时发现。基于上述理由本发明可在故障诊断等领域广泛推广。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图做以简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为本发明方法的流程图。图2为本发明模型结构示意图。图3为本发明训练阶段损失随训练轮数变化的曲线图。图4为本发明测试阶段模型重构值和重构误差曲线图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分的实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本发明保护的范围。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。如图1-4所示，本发明提供了一种基于改进Transformer的燃气轮机故障诊断方法，包括以下步骤：S1、获取目标工业设备的传感器历史测量数据，并完成数据预处理和数据集划分。S101、本次实验采用从南京某燃机电厂收集到的某型号燃气轮机从生命周期开始到当前传感器记录时刻的传感器记录数据该机组曾发生过两次燃烧筒裂纹故障，因此收集与燃烧筒工作状态紧密关联的机组负荷、燃料量、燃料温度、NOx排放量、透平出口温度、透平出口压力等传感器参数，要求收集到的数据应覆盖机组不同的运行工况。S102、对收集到的时序数据进行归一化处理，将数据放缩到范围内，公式如下：其中xt是当前时刻的数据，和/＞分别是传感器记录数据/＞中的最大值和最小值。S103、将预处理后的数据整理成batch_size×seq_len×N维度，其中，batch_size是为了满足神经网络并行化运算的需求，seq_len表示一次输入到模型的时间窗口长度，N为传感器数据维度。S104、将发生故障之前的样本数据划分为训练数据集，剩余数据划分为测试数据集。S2、构建基于改进Transformer的故障诊断模型，请参阅图2本发明实施例1的改进Transformer模型的结构示意图。S201、构建两层一维卷积网络，用于提取不同传感器数据间的局部特征，卷积层使用的卷积核尺寸均为3，填充尺寸均为1，经过卷积层得到数据X；S202、将数据X复制成三份，第一份与矩阵O拼接，得到；第二份与第三份拼接，得到。本模型需经过两阶段训练，第一阶段时矩阵O是与X同尺寸的全零向量，第二阶段时矩阵O是第一阶段训练得到的重构误差2。S203、构建位置编码，并与S202得到的对应位置相加，位置编码为输入数据增加了的相对位置信息。S204、构建多头自注意力层。定义三个矩阵向量：WQ,WK,WV，分别对S203得到的数据做线性变化，得到查询矩阵Q、键矩阵K和值矩阵V，再做如下运算:其中，dk为Q的维度，除以dk是为了防止内积过大。S205、将S203和S204得到的特征直接相加，构建残差网络，并将相加后的结果进行层标准化，以加快网络收敛。S206、构建线性层，并将线性层的输入和输出直接相加，构建残差网络，再将相加后的结果进行层标准化。S207、构建位置编码，并与S202得到的对应位置相加。S208、重复构建S204～S205的网络，并将S207得到的结果相继输入。S209、构建多头自注意力层。重新定义三个矩阵向量：WQ,WK,WV，其中WQ,WK分别对S206得到的数据、WV对S208得到的数据做线性变化，得到查询矩阵Q、键矩阵K和值矩阵V，再做同S204相同的运算。S210、重复构建S205的残差网络和层标准化，并将S209得到的结果相继输入。S211、构建线性层，构建Sigmoid层，将S210得到的结果相继输入，输出对S201输出的X的重构X1'，完成第一阶段训练。采用Sigmoid层是为了把输出的数据拟合到输入数据的归一化状态中，即范围内。S212、计算重构误差O＝2，如S202所述，代替第一阶段与X同尺寸的全零向量，此阶段将第一阶段的重构误差信息引入编码器的注意力层，引导模型关注重构误差较大的部分，重复S202～S211的过程，输出对S201输出的X的第二次重构X2'，完成第二阶段训练。第二阶段的训练可帮助模型加强对与机组健康工作时偏差较小的异常数据的关注。S213、对S211X1'得到的重构和S212得到的重构X2'采用对抗训练的方式，通过如下损失函数计算损失：/＞其中n代表训练的轮数epochs。可以理解的是，在训练的一开始，给予第一阶段训练的损失2较大的权重，这是为了确保第一阶段训练中在重构较差时模型能进行稳定的训练；而给予第二阶段训练的损失2较小的权重，这是因为第一阶段的重构误差整体都比较大，对引导模型关注重构误差较大的部分帮助不大，且容易造成模型训练的不稳定。随着训练轮数的增大，倒数慢慢变小，第一阶段损失的权重慢慢变小，第二阶段损失的权重慢慢增大，这是因为第一阶段训练的重构误差已经足够小了，不需要再给予较大的权重；而第二阶段训练的损失应受到越来越高的重视，以引导模型关注重构误差较大的部分。S214、选择Adam优化算法，公式如下：其中，wt表示原始梯度，a表示学习率，表示对梯度的一阶矩估计的校正，/＞表示对梯度的二阶矩估计的校正，ε是为了维持数值稳定性而添加的常数。S3、搭建网络训练框架，分批次将步骤S1中得到的不含故障数据的训练数据集输入到步骤S2搭建的故障诊断模型中，完成模型的训练。S301、设置训练的轮数、批处理数和学习率。优选地，训练的轮数设置为100、批处理数为128、学习率为0.001。S302、将训练数据集打乱，分批次输入到步骤S2搭建的模型中，计算每轮训练模型输出的损失值，并绘制图表。参阅图3可知，训练过程中损失不断减小，并且在第50Epoch之后一直保持稳定。S4、分批次将步骤S1中得到的含有故障数据的故障数据集输入到步骤S2搭建的模型中，记录模型预测值和重构误差。S5、设定故障阈值为0.1，当重构误差大于阈值时，判定设备发生故障，否则判定设备处于正常工作状态，完成故障诊断。参阅图4可知，所提出的模型将目标设备的两次故障均诊断及时预测了出来。以上只是对两次故障数据的诊断，可以理解的是，本申请实施例可以在任意的时刻，基于构建的数据集训练得到的模型对工业设备进行故障预测。上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。在本发明的上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述的部分，可以参见其他实施例的相关描述。在本申请所提供的几个实施例中，应该理解到，所揭露的技术内容，可通过其它的方式实现。其中，以上所描述的装置实施例仅仅是示意性的，例如所述单元的划分，可以为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，单元或模块的间接耦合或通信连接，可以是电性或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。所述集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、只读存储器、随机存取存储器、移动硬盘、磁碟或者光盘等各种可以存储程序代码的介质。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围。
