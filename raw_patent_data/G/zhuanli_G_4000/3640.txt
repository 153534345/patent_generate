标题title
基于数字孪生的三维场景模型自动吸附方法、装置及介质
摘要abst
本发明公开了一种基于数字孪生的三维场景模型自动吸附方法、装置及介质，属于三维可视化技术领域。方法特征在于，包括以下步骤：S1、将模型导入三维场景；S2、响应于对场景内某一模型的移动操控，调用以下方法：获取各模型包围盒的三视图二维投影并提取各投影顶点；计算各模型在同一投影视图中对应边的斜率，并以此为条件判断各模型间是否存在平行面；计算模型间相邻面的相对距离并取其绝对值与预设的吸附距离阈值比较，当所述绝对值小于等于吸附距离阈值时，设置当前模型与其他模型在同一投影视图中相邻面所在直线方程中的C值相等，实现模型间的自动吸附。本发明可实现场景内模型间的自动吸附，提升场景搭建效率，省时省力。
权利要求书clms
1.一种基于数字孪生的三维场景模型自动吸附方法，其特征在于，包括以下步骤：S1、将模型导入三维场景，分别获取各模型包围盒参数信息；S2、响应于对场景内某一模型的移动操控，调用方法控制该模型去吸附其他模型，实现该模型与其他模型之间的自动吸附：S21、分别获取各模型包围盒在XY面、YZ面、XZ面的三视图二维投影；S22、提取各模型在同一投影视图中的投影顶点，并记录各投影顶点的坐标信息；S23、将各模型在同一投影视图中的4个投影顶点连线，分别计算各模型在同一投影视图中具有对应关系的边的斜率；S24、以各模型在同一投影视图中其对应边的斜率是否相等作为条件，判断各模型间是否存在平行面；对存在平行面的模型执行步骤25；S25、计算当前移动的模型与其他模型之间相邻面的相对距离，并取其绝对值与预设的吸附距离阈值作比较，当前移动的模型与其他模型之间相邻面的相对距离的绝对值小于等于预设的吸附距离阈值时，执行步骤26;S26、系统自动设置，使当前移动的模型与其他模型在同一投影视图中相邻面所在直线方程中的C值相等，实现模型间的自动吸附。2.根据权利要求1所述的一种基于数字孪生的三维场景模型自动吸附方法，其特征在于，所述S25中，所述当前移动的模型与其他模型之间相邻面的相对距离，通过以下方式获得：用方程Y=kX+C表示各模型在同一投影视图中对应边的所在直线，在式中，代表各直线斜率的k值相等，C值代表各直线与Y轴交点至原点的距离，也即代表各直线的相对位置；两直线间C值的差值用以计算直线之间的相对距离；在同一投影视图中，当前移动的模型与其他模型之间相邻面的投影直线的相对距离即为当前移动的模型与其他模型之间相邻面的相对距离。3.根据权利要求1所述的一种基于数字孪生的三维场景模型自动吸附方法，其特征在于，所述S25中，所述预设的吸附距离阈值为一个自定义的、代表模型之间相邻面的相对距离的参数。4.一种基于数字孪生的三维场景模型自动吸附装置，其特征在于，包括：模型导入模块，用以将模型导入三维场景，分别获取各模型包围盒参数信息；方法执行模块，用以响应于对场景内某一模型的移动操控，调用方法控制该模型去吸附其他模型，实现该模型与其他模型之间的自动吸附；其中，所述的方法执行模块，进一步包括：二维投影模块，用以分别获取各模型包围盒在XY面、YZ面、XZ面的三视图二维投影；顶点提取模块，用以提取各模型在同一投影视图中的投影顶点，并记录各投影顶点的坐标信息；斜率计算模块，用以将各模型在同一投影视图中的4个投影顶点连线，分别计算各模型在同一投影视图中具有对应关系的边的斜率；条件判断模块，用以将各模型在同一投影视图中其对应边的斜率是否相等作为条件，判断各模型间是否存在平行面，并通过位置计算模块对存在平行面的模型执行位置计算；位置计算模块，计算当前移动的模型与其他模型之间相邻面的相对距离，并取其绝对值与预设的吸附距离阈值作比较，当前移动的模型与其他模型之间相邻面的相对距离的绝对值小于等于预设的吸附距离阈值时，通过自动吸附模块执行吸附操作；自动吸附模块，用以通过使当前移动的模型与其他模型在同一投影视图中相邻面所在直线方程中的C值相等，实现模型间的自动吸附。5.一种基于数字孪生的三维场景模型自动吸附装置，其特征在于，包括：存储器，用以存储计算机程序；处理器，用以执行所述计算机程序时实现如权利要求1至2任意一项所述的基于数字孪生的三维场景模型自动吸附方法的步骤。6.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1至2任意一项所述的基于数字孪生的三维场景模型自动吸附方法的步骤。
说明书desc
技术领域本发明涉及一种基于数字孪生的三维场景模型自动吸附方法、装置及介质，属于三维可视化技术领域。背景技术数字孪生技术是指以物理实体为基础，运用数字化技术手段对其进行数字化建模，形成与之相对应的虚拟物体。目前数字孪生技术已广泛应用于多个领域，如机械制造、建筑设计、医疗诊断等，具有广阔的应用前景。在数字孪生的三维场景搭建过程中，操作人员需要耗费大量时间精力对模型的摆放位置及各模型之间的三维空间关系进行人工干预，由于操作人员通常一次只能从一个角度观察，很容易因观察不到位或操作精度不够高，而一旦操作人员观察不到位或操作精度不够高，就会出现诸如模型之间互相穿透而导致的穿模、未按要求对齐以及模型腾空之类的问题。现有常规的模型吸附方法，需要计算三维场景内各个模型的空间距离，其算法是将模型内部核心之间的相对距离，减去各个模型边界距离核心的长度。此类模型吸附方法的一系列算法不仅复杂，且需要频繁使用乘方和开方计算，计算效率不高，且计算过程对计算机资源消耗较多。发明内容为了解决上述问题，本发明公开了一种基于数字孪生的三维场景模型自动吸附方法、装置及介质，用以提升三维场景中模型搭建的工作效率，减少因人工观察视角局限或操作精度不够高所产生的穿模、未按要求对齐等问题。本发明解决其技术问题采取的技术方案是：第一方面，本发明提供一种基于数字孪生的三维场景模型自动吸附方法，包括以下步骤：S1、将模型导入三维场景，分别获取各模型包围盒参数信息；S2、响应于对场景内某一模型的移动操控，调用方法控制该模型去吸附其他模型，实现该模型与其他模型之间的自动吸附：S21、分别获取各模型包围盒在XY面、YZ面、XZ面的三视图二维投影，所有投影视图均为矩形；S22、提取各模型在同一投影视图中的投影顶点，并记录各投影顶点的坐标信息；S23、将各模型在同一投影视图中的4个投影顶点连线，分别计算各模型在同一投影视图中具有对应关系的边的斜率；S24、以各模型在同一投影视图中其对应边的斜率是否相等作为条件，判断各模型间是否存在平行面；存在平行面的模型执行步骤25；S25、计算当前移动的模型与其他模型之间相邻面的相对距离，并取其绝对值与预设的吸附距离阈值作比较，当前移动的模型与其他模型之间相邻面的相对距离的绝对值小于等于预设的吸附距离阈值时，执行步骤26;S26、系统自动设置，使当前移动的模型与其他模型在同一投影视图中相邻面所在直线方程中的C值相等，实现模型间的自动吸附。进一步地，在所述S25中，所述当前移动的模型与其他模型之间相邻面的相对距离，通过以下方式获得：用方程Y=kX+C表示各模型在同一投影视图中对应边的所在直线，在式中，代表各直线斜率的k值相等，C值代表各直线与Y轴交点至原点的距离，也即代表各直线的相对位置；两直线间C值的差值用以计算直线之间的相对距离；在同一投影视图中，当前移动的模型与其他模型之间相邻面的投影直线的相对距离即为当前移动的模型与其他模型之间相邻面的相对距离。进一步地，在所述S25中，所述预设的吸附距离阈值为一个自定义的、代表模型之间相邻面的相对距离的参数，可以根据实际情况和用户体验进行调整。第二方面，本发明提供一种基于数字孪生的三维场景模型自动吸附装置，所述装置包括：模型导入模块，用以将模型导入三维场景，分别获取各模型包围盒参数信息；方法执行模块，用以响应于对场景内某一模型的移动操控，调用方法控制该模型去吸附其他模型，实现模型间的自动吸附；其中，所述的方法执行模块，进一步包括：二维投影模块，用以分别获取各模型包围盒在XY面、YZ面、XZ面的三视图二维投影；顶点提取模块，用以提取各模型在同一投影视图中的投影顶点，并记录各投影顶点的坐标信息；斜率计算模块，用以将各模型在同一投影视图中的4个投影顶点连线，分别计算各模型在同一投影视图中具有对应关系的边的斜率；条件判断模块，用以将各模型在同一投影视图中其对应边的斜率是否相等作为条件，判断各模型间是否存在平行面，并通过位置计算模块对存在平行面的模型执行位置计算；位置计算模块，计算当前移动的模型与其他模型之间相邻面的相对距离，并取其绝对值与预设的吸附距离阈值作比较，当前移动的模型与其他模型之间相邻面的相对距离的绝对值小于等于预设的吸附距离阈值时，通过自动吸附模块执行吸附操作；自动吸附模块，用以通过使当前移动的模型与其他模型在同一投影视图中相邻面所在直线方程中的C值相等，实现模型间的自动吸附。第三方面，本发明还提供一种基于数字孪生的三维场景模型自动吸附装置，所述装置包括：存储器，用以存储计算机程序；处理器，用以执行所述计算机程序时实现如上所述的基于数字孪生的三维场景模型自动吸附方法的步骤。第四方面，本发明还提供一种计算机可读储存介质，所述计算机可读储存介质上存储有计算机程序，所述计算机程序被处理器执行时实现如上述的基于数字孪生的三维场景模型自动吸附方法的步骤。本发明的有益效果如下：本发明提供的方法通过三视图投影的方法将三维模型的包围盒转化为XY、YZ、XZ三个面的二维投影，并对模型投影的四个顶点进行计算，实现模型吸附的空间方位识别和阈值判断。本发明涉及的相关计算方法相对于传统算法来说，更为简单快捷，阈值判断精度更高，同时对计算机资源的消耗更少。本发明通过对三维模型做二维投影解决物体之间空间关系的识别问题。用户操作移动模型位置时，可以实时识别被移动的模型物体与三个方向上距离最近的物体，一旦模型之间的距离触发设定的阈值，即可实现自动吸附。本发明可以大大提升操作人员搭建场景的工作效率，减少因人工观察视角局限或操作精度不够高所产生的穿模、未按要求对齐等问题。附图说明图1是实施例一中模型包围盒的立方体结构示意图；图2是实施例一中通过XY面的俯视图投影获取到的模型A包围盒和模型B包围盒的俯视图投影及其顶点示意图；图3是一种基于数字孪生的三维场景模型自动吸附装置的结构示意图；图4是另一种基于数字孪生的三维场景模型自动吸附装置的结构示意图。具体实施方式下面结合附图与实施例对本发明做进一步说明：为能清楚说明本发明方案的技术特点，下面将通过具体实施方式，并结合其附图，对本发明进行详细阐述。下文的公开提供了许多不同的实施例用来实现本发明的不同结构。为了简化本发明的公开，下文中对特定例子的部件和设置进行描述。此外，本发明可以在不同例子中重复参考数字和/或字母。这种重复是为了简化和清楚的目的，其本身不指示所讨论各种实施例和/或设置之间的关系。应当注意，在附图中所图示的部件不一定按比例绘制。本发明省略了对公知组件和处理技术及工艺的描述以避免不必要地限制本发明。本实施例以两个数字孪生模型为例，详细介绍本发明的一种基于数字孪生的三维场景模型自动吸附方法，在以下内容中，本实施例的两个数字孪生模型分别用模型A和模型B表示。实施例一一种基于数字孪生的三维场景模型自动吸附方法，具体包括以下步骤：S1、将模型A和模型B导入三维场景，分别获取模型A和模型B的模型包围盒参数信息，所述模型包围盒为立方体结构，参见附图1；S2、点击并拖动模型B，系统响应于对模型B的移动操控，调用以下方法控制模型B去吸附模型A，实现模型B与模型A之间的自动吸附；所述方法包括以下步骤:S21、将两个模型的包围盒立方体通过三视图投影分别转化为XY面、YZ面、XZ面三个面的二维投影视图，所有投影视图均为矩形，即得模型A包围盒的三视图二维投影和模型B包围盒的三视图二维投影；S22、如图2所示，以XY面的俯视图为例，通过XY面的俯视图投影分别能够提取模型A包围盒的俯视图投影顶点A1、A2、A3、A4，以及模型B包围盒的俯视图投影顶点B1、B2、B3、B4，分别记录以上各点的X轴坐标和Y轴坐标，用x和y表示；S23、通过两点一线方式分别计算模型A包围盒的俯视图投影顶点A1、A2所连接边A1A2的斜率kA和模型B包围盒的俯视图投影顶点B1、B2所连接边B1B2的斜率kB，具体计算公式为斜率k=/，计算结果分别记作kA和kB；S24、判断kA和kB两个值是否相等，若不相等说明两个模型没有平行面，不存在吸附条件，需对模型进行旋转操作后再重新判断；若相等，则说明模型A和模型B具有平行面，两模型的相邻面可以作为吸附面执行步骤25；S25、计算模型B与模型A之间相邻面的相对距离，并取其绝对值与预设的吸附距离阈值d作比较，当模型B与模型A之间相邻面的相对距离的绝对值小于等于预设的吸附距离阈值d时，执行步骤26;所述模型B与模型A之间相邻面的相对距离，通过以下方法获得：将模型A和模型B的投影面对应边的所在直线用方程Y=kX+C表示，得到模型A的直线方程YA=kX+C1和模型B的直线方程YB=kX+C2，其中k表示斜率，由于kA=kB，通过数学公式推定可知两条直线方程的k值相同，只有C值不同，C值代表各直线与Y轴交点至原点的距离，也即代表各直线的相对位置，在XY面的俯视图中，模型A与模型B相邻面投影直线分别是直线A3A4和直线B1B2，这两条直线的相对距离即为模型B与模型A之间相邻面的相对距离，由C2-C1表示；当操作人员移动模型A时，C1的数值会实时变化，同样的，移动模型B时，C2的数值会实时变化，本实施例以移动模型B吸附模型A为例，在移动时系统实时计算模型B与模型A之间相邻面的相对距离，并将模型B与模型A之间相邻面的相对距离的绝对值与预设的吸附距离阈值d进行对比，当模型B移动至满足｜C2-C1｜≤d的条件时，执行步骤26。所述预设的吸附距离阈值d由平台或用户自定义设置，其代表了模型间吸附距离的动态参数，可以根据实际情况和用户体验进行调整。需要注意的是，当两个模型互相穿透时，C2-C1的结果为负值，故此处进行阈值判断时应取绝对值进行计算。S26、系统自动设置，使C1=C2，控制模型A与模型B相邻面投影直线A3A4和B1B2两条直线重合，进而实现了模型A与模型B之间的自动吸附。实施例二本申请提供了两种基于数字孪生的三维场景模型自动吸附装置，以下从两个角度分别对这两种装置的实施例进行描述。基于功能模块的角度，本实施例提供一种基于数字孪生的三维场景模型自动吸附装置，如图3所示，包括：模型导入模块，用以将模型导入三维场景，分别获取各模型包围盒参数信息；方法执行模块，用以响应于对场景内某一模型的移动操控，调用方法控制该模型去吸附其他模型，实现模型间的自动吸附；其中，所述的方法执行模块，进一步包括：二维投影模块，用以分别获取各模型包围盒在XY面、YZ面、XZ面的三视图二维投影；顶点提取模块，用以提取各模型在同一投影视图中的投影顶点，并记录各投影顶点的坐标信息；斜率计算模块，用以将各模型在同一投影视图中的4个投影顶点连线，分别计算各模型在同一投影视图中具有对应关系的边的斜率；条件判断模块，用以将各模型在同一投影视图中其对应边的斜率是否相等作为条件，判断各模型间是否存在平行面，并通过位置计算模块对存在平行面的模型执行位置计算；位置计算模块，计算当前移动的模型与其他模型之间相邻面的相对距离，并取其绝对值与预设的吸附距离阈值作比较，当前移动的模型与其他模型之间相邻面的相对距离的绝对值小于等于预设的吸附距离阈值时，通过自动吸附模块执行吸附操作；自动吸附模块，用以通过使当前移动的模型与其他模型在同一投影视图中相邻面所在直线方程中的C值相等，实现模型间的自动吸附。基于硬件的角度，本实施例提供一种基于数字孪生的三维场景模型自动吸附装置，其结构如图4所示，包括处理器、存储器和总线，所述存储器存储有计算机程序，当所述计算机设备运行时，所述处理器与所述存储器之间通过总线通信，所述处理器执行所述计算机程序，以执行如上所述的基于数字孪生的三维场景模型自动吸附方法的步骤。本实施例提供的一种基于数字孪生的三维场景模型自动吸附装置可以包括但不限于智能手机、平板电脑、笔记本电脑或台式电脑等。具体地，上述存储器和处理器能够为通用的存储器和处理器，这里不做具体限定，当处理器运行存储器存储的计算机程序时，能够执行上述基于数字孪生的三维场景模型自动吸附方法的步骤。本领域技术人员可以理解，图4中示出的计算机设备的结构并不构成对计算机设备的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者拆分某些部件，或者不同的部件布置。在一些实施例中，该计算机设备还可以包括触摸屏可用于显示图形用户界面和接收用户针对图形用户界面的操作。具体的触摸屏可包括显示面板和触控面板。其中显示面板可以采用LCD、OLED等形式来配置。触控面板可收集用户在其上或附近的接触或者非接触操作，并生成预先设定的操作指令，例如，用户使用手指、触笔等任何适合的物体或附件在触控面板上或在触控面板附近的操作。另外，触控面板可包括触摸检测装置和触摸控制器两个部分。其中，触摸检测装置检测用户的触摸方位、姿势，并检测触摸操作带来的信号，将信号传送给触摸控制器；触摸控制器从触摸检测装置上接收触摸信息，并将它转换成处理器能够处理的信息，再送给处理器，并能接收处理器发来的命令并加以执行。此外，可以采用电阻式、电容式、红外线以及表面声波等多种类型实现触控面板，也可以采用未来发展的任何技术实现触控面板。进一步的，触控面板可覆盖显示面板，用户可以根据显示面板显示的图形用户界面，在显示面板上覆盖的触控面板上或者附近进行操作，触控面板检测到在其上或附近的操作后，传送给处理器以确定用户输入，随后处理器响应于用户输入在显示面板上提供相应的视觉输出。另外，触控面板与显示面板可以作为两个独立的部件来实现也可以集成而来实现。实施例三本发明实施例还提供了一种计算机可读储存介质，所述计算机可读储存介质上存储有计算机程序，所述计算机程序被处理器执行时实现如上述的基于数字孪生的三维场景模型自动吸附方法的步骤。可以理解的是，如果上述实施例中的方法以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，执行本申请各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。在本申请所提供的实施例中，应该理解到，所揭露装置和方法，可以通过其它的方式实现。以上所描述的装置实施例仅仅是示意性的，例如，模块的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，又例如，多个模块或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些通信接口，装置或模块的间接耦合或通信连接，可以是电性，机械或其它的形式。作为分离部件说明的模块可以是或者也可以不是物理上分开的，作为模块显示的部件可以是或者也可以不是物理模块，即可以位于一个地方，或者也可以分布到多个网络模块上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。另外，在本申请提供的实施例中的各功能模块可以集成在一个处理模块中，也可以是各个模块单独物理存在，也可以两个或两个以上模块集成在一个模块中。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。最后应当说明的是：以上实施例仅用以说明本发明的技术方案而非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等同替换，其均应涵盖在本发明的权利要求保护范围之内。
