标题title
一种动力电池中单调数据的异常标记修正方法
摘要abst
本发明属于动力电池技术领域，具体涉及一种动力电池中单调数据的异常标记修正方法，包括解析获得动力电池上报的原始数据，在原始数据中匹配出设定周期内满足单调数据特性的目标数据，对目标数据依次进行向量化和连续去重的预处理后将向量化数据中各数据作为散点并直线连接，计算直线斜率后构建斜率数集；在进行斜率判断后标记异常数据，再判断异常数据数据量是否小于正常数据的跳变幅度，再逐个判断异常数据内的散点是否满足预设第二预设条件；本发明中针对单调数据中的异常标记引入散点构成直线的斜率判断，将斜率不为“1”的直线段的散点记为异常数据，并对异常数据进行拉伸变化，将实际数据曲线中的异常值抹平，便于数据的进一步使用。
权利要求书clms
1.一种动力电池中单调数据的异常标记修正方法，应用于处理车辆T-BOX上报至TSP平台的动力电池相关指标的实时报文，其特征在于，包括如下步骤：S1：基于第一预设条件对所述实时报文进行解析，以获得动力电池上报的原始数据，匹配出所述原始数据在预设周期内满足单调数据特性的目标数据并进行备份，对所述目标数据依次进行向量化和连续去重的预处理，生成预处理后的待分析数据；S2：将所述待分析数据中各条数据作为散点，并分析由两点构建的每段直线的斜率生成的斜率数集，若斜率数集内的斜率均为“1”，则执行步骤S4，否则，计算出斜率数集内斜率不为“1”的数据量，并将斜率不为“1”的直线段散点标记为异常数据，对斜率为“1”的直线段散点标记为正常数据，并对异常数据执行步骤S3；S3：判断所述数据量是否小于异常数据相邻两端的正常数据的跳变幅度，若是则执行步骤S4，否则再逐个判断异常数据内的散点是否满足第二预设条件，若满足，则采用拉伸变换对异常数据内的散点进行填充得到修正值，若不满足，则取前一个满足第二预设条件的修正后散点值作为修正值；S4：结束异常标记修正流程。2.根据权利要求1所述的一种动力电池中单调数据的异常标记修正方法，其特征在于：步骤S1中所述第一预设条件具体为动力电池上报实时报文的国标GB/T32960的数据格式和要求，获取的所述原始数据至少包括动力电池的里程数据、放电SOC数据、充电SOC数据。3.根据权利要求1所述的一种动力电池中单调数据的异常标记修正方法，其特征在于：步骤S1中还包括，在获得动力电池上报的原始数据后，依据所述原始数据采集的时间序列对原始数据依次执行排序和数据清洗以清除重复数据和空数据。4.根据权利要求1所述的一种动力电池中单调数据的异常标记修正方法，其特征在于：步骤S1中预处理的方法为：对所述目标数据进行向量化处理后生成向量化数据，并生成对应所述向量化数据的索引号；若向量化数据中数据值连续重复，则进行去重操作，保留第一条数据及其对应的索引号，若向量化数据中数据值不连续重复，则不进行去重操作。5.根据权利要求4所述的一种动力电池中单调数据的异常标记修正方法，其特征在于：步骤S2中对所述异常数据进行标记具体为：取两段所述正常数据之间的尾索引号和头索引号，对尾索引号和头索引号之间的向量化数据对应的原始数据进行标记。6.根据权利要求1所述的一种动力电池中单调数据的异常标记修正方法，其特征在于：步骤S3中，所述第二预设条件至少包括：电芯工作时电流不为0；电芯工作时温度范围在-30℃~60℃；电芯soc范围在0~100；铁锂电芯工作时电压范围在2500mv~3650mv；三元锂电芯工作时电压范围在2750mv~4200mv。
说明书desc
技术领域本发明属于动力电池技术领域，具体涉及一种动力电池中单调数据的异常标记修正方法。背景技术动力电池作为新能源汽车的核心部件，直接关系到车辆的安全稳定行驶。根据要求，新能源汽车需要根据标准GBT32960《电动汽车远程服务与管理系统技术规范》的协议格式向大数据平台发送数据。但是由于新能源汽车所处的工况较为复杂，以及T-BOX、BMS数据存储和传输的问题，导致T-BOX上报的报文存在一些异常数据，针对报文中类似于里程、放电SOC、充电SOC等有单调不减或者单调不增要求的字段，本文提出了一种异常数据标记和修正方法。发明内容本发明的目的就在于提供一种动力电池中单调数据的异常标记修正方法，以解决背景技术中提出的问题。本发明通过以下技术方案来实现上述目的：一种动力电池中单调数据的异常标记修正方法，应用于处理车辆T-BOX上报至TSP平台的动力电池相关指标的实时报文，包括如下步骤：S1：基于第一预设条件对所述实时报文进行解析，以获得动力电池上报的原始数据，匹配出所述原始数据在预设周期内满足单调数据特性的目标数据并进行备份，对所述目标数据依次进行向量化和连续去重的预处理，生成预处理后的待分析数据；S2：将所述待分析数据中各条数据作为散点，并分析由两点构建的每段直线的斜率生成的斜率数集，若斜率数集内的斜率均为“1”，则执行步骤S4，否则，计算出斜率数集内斜率不为“1”的数据量，并将斜率不为“1”的直线段散点标记为异常数据，对斜率为“1”的直线段散点标记为正常数据，并对异常数据执行步骤S3；S3：判断所述数据量是否小于异常数据相邻两端的正常数据的跳变幅度，若是则执行步骤S4，否则再逐个判断异常数据内的散点是否满足第二预设条件，若满足，则采用拉伸变换对异常数据内的散点进行填充得到修正值，若不满足，则取前一个满足第二预设条件的修正后散点值作为修正值；S4：结束异常标记修正流程。进一步改进在于，步骤S1中所述第一预设条件具体为动力电池上报实时报文的国标GB/T32960的数据格式和要求，获取的所述原始数据至少包括动力电池的里程数据、放电SOC数据、充电SOC数据。进一步改进在于，步骤S1中还包括，在获得动力电池上报的原始数据后，依据所述原始数据采集的时间序列对原始数据依次执行排序和数据清洗以清除重复数据和空数据。进一步改进在于，步骤S1中连续去重的方法为：对所述目标数据进行向量化处理后生成向量化数据，并生成对应所述向量化数据的索引号；若向量化数据中数据值连续重复，则进行去重操作，保留第一条数据及其对应的索引号，若向量化数据中数据值不连续重复，则不进行去重操作。进一步改进在于，步骤S2中对所述异常数据进行标记具体为：取两段所述正常数据之间的尾索引号和头索引号，对尾索引号和头索引号之间的向量化数据对应的原始数据进行标记。进一步改进在于，步骤S3中，所述第二预设条件至少包括：电芯工作时电流不为0；电芯工作时温度范围在-30℃~60℃；电芯soc范围在0~100；铁锂电芯工作时电压范围在2500mv~3650mv；三元锂电芯工作时电压范围在2750mv~4200mv。本发明的有益效果在于：本发明中针对单调数据中的异常标记的方法标记位置更加准确、快速，在处理从GBT32960报文中解析的里程数据，可能存在里程跳变、里程异常值存在多帧、里程异常跳低并持续一段时间等情况，现有技术采用一阶差分或者窗口判断的方法会存在效率低效且易出现标记错位的问题，而本发明则能避免；本发明中针对异常数据的修正策略简单有效，契合实际情况，通过拉伸变化，将实际数据曲线中的异常值抹平，增添数据的有效性，便于数据的进一步使用。附图说明图1是本发明中动力电池中单调数据的异常标记修正方法整体执行流程示意图；图2是本发明中目标数据的连续去重操作示意图；图3是本发明中单调数据的异常标记修正示意图。具体实施方式下面结合附图对本发明作进一步详细描述，有必要在此指出的是，以下具体实施方式只用于对本发明进行进一步的说明，不能理解为对本发明保护范围的限制，该领域的技术人员可以根据上述发明内容对本发明作出一些非本质的改进和调整。如图1所示，本发明提供了一种动力电池中单调数据的异常标记修正方法，应用于处理车辆T-BOX上报至TSP平台的动力电池相关指标的实时报文，包括如下步骤：S1：基于第一预设条件对实时报文进行解析，以获得动力电池上报的原始数据，匹配出原始数据在预设周期内满足单调数据特性的目标数据并进行备份，对目标数据依次进行向量化和连续去重的预处理，生成预处理后的待分析数据。其中，设定周期可设为一天，即一天内动力电池相关指标的原始数据；单调数据特性是指动力电池指标数据中符合单调不增或者单调不减条件要求的数据；而现有技术中动力电池的电压数组和温度数组这类相关性数据，由于其瞬时变化的不确定性，不满足本发明中所限定的单调数据的特性。本发明中，步骤S1中第一预设条件具体为动力电池上报实时报文的国标GB/T32960的数据格式和要求，获取的原始数据至少包括动力电池的里程数据、放电SOC数据、充电SOC数据。本发明中，步骤S1中还包括，在获得动力电池上报的原始数据后，依据所述原始数据采集的时间序列对原始数据依次执行排序和数据清洗以清除重复数据和空数据。另外，步骤S1中连续去重的方法为：对所述目标数据进行向量化处理后生成向量化数据，并生成对应所述向量化数据的索引号；若向量化数据中数据值连续重复，则进行去重操作，保留第一条数据及其对应的索引号，若向量化数据中数据值不连续重复，则不进行去重操作；去重操作具体为去除重复数据。具体参考图2，该图为目标数据的连续去重操作示意图。S2：将待分析数据中各条数据作为散点，并分析由两点构建的每段直线的斜率生成的斜率数集，若斜率数集内的斜率均为“1”，则执行步骤S4，否则，计算出斜率数集内斜率不为“1”的数据量，并将斜率不为“1”的直线段散点标记为异常数据，对斜率为“1”的直线段散点标记为正常数据，并对异常数据执行步骤S3。本发明中，步骤S2中对异常数据进行标记具体为：若该周期内斜率全为“1”，则判定为正常数据。若该周期内斜率不全为“1”，则证明存在异常数据，取两段正常数据之间的尾索引号和头索引号，对尾索引号和头索引号之间的向量化数据对应的原始数据进行标记。S3：判断数据量是否小于异常数据相邻两端的正常数据的跳变幅度，若是则执行步骤S4，否则再逐个判断异常数据内的散点是否满足第二预设条件，若满足，则采用拉伸变换对异常数据内的散点进行填充得到修正值，若不满足，则取前一个满足第二预设条件的修正后散点值作为修正值。本发明中，第二预设条件至少包括：电芯工作时电流不为0；电芯工作时温度范围在-30℃~60℃；电芯soc范围在0~100；铁锂电芯工作时电压范围在2500mv~3650mv；三元锂电芯工作时电压范围在2750mv~4200mv。本发明中，若针对原始数据中的里程数据，步骤S3中跳变幅度是指异常里程数据相邻两端的正常里程数据的差值；如里程数据在13000km到13200km为异常数据，则异常数据相邻两端的正常数据的跳变幅度为200km。具体参考图3，该图为单调数据的异常标记修正示意图；在异常修正过程中，记异常数据段前后正常数据段的最后一个值和第一个值及其索引号分别为y1,y2和x1,x2，异常数据的数据量记为n；当异常数据内的散点均满足合规条件时，对异常数据前一个正常数据段进行直线拟合，拟合直线记作，/＞为其反函数； 当/＞时，进行修正；当/＞时，不进行修正。其中第/＞个满足条件的修正值/＞为：/＞。第个不满足条件的修正值/＞为：。其中，为取整函数，/＞取的是索引号更大的最近一个满足条件的修正点的值。本发明中，对于异常数据的修正过程中需要优先判断异常数据的数据量与跳变幅度的大小，若数据量＜跳变幅度，则不修正；若数据量≥跳变幅度，则修正的时候判断参考数据是否满足合规条件，若满足，则对满足条件的散点采用拉伸的方式填充获得修正值，若不满足，则将前一个满足合规条件的值作为修正值；其中本发明修正方法中对满足条件的散点依据索引号大小进行依次修正。需要强调的是，本发明中单调数据的异常标记和修正过程中生成索引号的方式保证了原有数据的单调特性，另外预设的合规条件加入也保证了修正后数据的科学性和合理性。以上所述具体实施方式描述较为具体和详细，但并不能因此而理解为对本发明范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。
