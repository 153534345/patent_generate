标题title
基于计算机视觉的五金冲压配件质量检测方法
摘要abst
本发明涉及图像处理领域，具体涉及基于计算机视觉的五金冲压配件质量检测方法，包括：获取模板点云、待测点云以及模板点云中各个特征点和各个区域；根据各个特征点对应的各个球体区域的参考权重以及法向变化程度得到各个特征点的特征强度，并根据各个特征点的代表性得到各个特征点的自身特征，根据各个特征点之间的距离以及各个特征点的自身特征得到各个特征点的局部聚集强度，进而得到各个区域的区域特征强度；根据各个区域的区域特征强度及预设数量得到各个区域的预匹配特征点；根据配准后的待测点云中各个点的最邻近距离得到各个缺陷区域。本发明用较少的特征点获取较为准确的点云配准效果，提高五金冲压配件的质量检测效率。
权利要求书clms
1.基于计算机视觉的五金冲压配件质量检测方法，其特征在于，该方法包括以下步骤：获取模板点云以及待测点云；获取模板点云中各个点的法向量以及模板点云中的各个特征点；对模板点云进行区域划分，得到模板点云的各个区域；根据各个特征点的描述子得到各个特征点的代表性；根据模板点云中所有特征点之间的距离得到最大半径，根据最大半径得到各个球体半径；获取以各个特征点为球心，各个球体半径对应的球体区域，对各个球体区域中所有点的法向量坐标进行聚类，得到各个聚类结果以及对应聚类中心，根据各个球体区域内各个聚类中心之间的距离得到各个球体区域的法向变化程度；根据各个球体区域的参考权重以及法向变化程度得到各个特征点的特征强度；根据各个特征点的代表性以及特征强度得到各个特征点的自身特征，根据各个特征点之间的距离以及各个特征点的自身特征得到各个特征点的局部聚集强度；根据各个区域中各个特征点的局部聚集强度得到各个区域的区域特征强度；根据各个区域的区域特征强度以及预设数量得到各个区域的预匹配特征点；获取待测点云中的各个特征点，将模板点云中所有预匹配特征点与待测点云的各个特征点进行匹配，得到配准后的待测点云，根据配准后的待测点云中各个点的最邻近距离得到各个点的缺陷概率，根据各个点的缺陷概率得到各个缺陷点，根据各个缺陷点得到各个缺陷区域。2.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述各个特征点的代表性的获取方法包括：获取各个特征点与其他特征点的描述子之间的夹角余弦值，计算所得所有夹角余弦值的平均值，将超参数与所得平均值之间的差值作为各个特征点的代表性。3.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述最大半径的获取方法为：计算模板点云中各个特征点之间的距离，将所得各个距离的最小值作为最大半径。4.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述根据各个球体区域内各个聚类中心之间的距离得到各个球体区域的法向变化程度的方法为：计算各个球体区域中各个聚类中心与其他聚类中心之间距离的平均值，将所得平均值作为各个聚类中心的距离平均值；将各个球体区域中所有聚类中心对应的距离平均值的累加和作为各个球体区域的法向变化程度。5.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述各个球体区域的参考权重的获取方法为：计算各个球体区域的序号与1.0之间的差值，并获取所得差值与预设等分量之间的比值，将1.0与所得比值之间的差值作为各个球体区域的参考权重。6.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述各个特征点的特征强度的获取方法为：计算以各个特征点为球心的各个球体区域对应的法向变化程度与参考权重之间的乘积，将所得各个乘积的累加和作为各个特征点的特征强度。7.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述各个特征点的局部聚集强度的获取表达式为：式中，为第i个特征点的局部聚集强度；u为第i个特征点所处区域的序号；为第u个区域中包含的特征点的总个数；为第i个特征点的自身特征；R为最大半径；为第i个特征点与其所处区域中的第s个特征点之间的欧氏距离；为该第s个特征点的自身特征。8.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述各个区域的预匹配特征点的获取方法为：获取模板点云的各个区域归一化后的区域特征强度，将各个区域归一化后的区域特征强度作为各个区域的特征点提取比例，将各个区域的特征点提取比例与预设数量的乘积，并对所得提取数量值向下取整后的结果作为各个区域的提取数量值，将各个区域中所有特征点的局部聚集强度从大到小进行排序，并依次选取数量等于对应提取数量值的特征点作为各个区域的预匹配特征点。9.根据权利要求1所述的基于计算机视觉的五金冲压配件质量检测方法，其特征在于，所述配准后的待测点云中各个点的最邻近距离是指：计算配准后的待测点云中各个点与模板点云中的所有点之间的距离，将所得所有距离中的最小距离作为各个点的最邻近距离。
说明书desc
技术领域本发明涉及图像处理领域，具体涉及基于计算机视觉的五金冲压配件质量检测方法。背景技术五金冲压配件是指在室温条件下，使用模具以及压力机对钢/有色金属等板材进行冲压或锻造，使之产生塑性变形或分离后得到的工件。由于使用同一模具冲压形成的五金冲压配件具有相同的尺寸精度，因此根据待检测的五金冲压配件与合格的五金冲压配件进行对比，即可实现对待检测的五金冲压配件表面的缺陷检测。现有的五金冲压配件质量检测方法大多为模板匹配法，但是由于金属材质对光的反射能力较强，且五金冲压配件的加工环境较为复杂，加工过程中使用的设备也会在五金冲压配件表面形成阴影，使得五金冲压配件的表面纹理发生变化，因此直接根据五金冲压配件的表面图像对其进行质量检测，所得检测结果存在一定的误差，而现有的五金冲压配件在加工过程中常见的缺陷，如毛刺、辊子印、开裂以及划痕等，均会使五金冲压配件发生形变，因此根据五金冲压配件在三维空间下的形变情况对缺陷进行检测可以得到更加准确的检测结果，但是由于点云中包含的数据量较多，且五金冲压配件的结构类型较多，在点云配准的过程中会产生较大的计算量，影响点云配准的效率，进而影响五金冲压配件的质量检测效率。发明内容本发明提供基于计算机视觉的五金冲压配件质量检测方法，以解决现有的问题。本发明的基于计算机视觉的五金冲压配件质量检测方法采用如下技术方案：本发明一个实施例提供了基于计算机视觉的五金冲压配件质量检测方法，该方法包括以下步骤：获取模板点云以及待测点云；获取模板点云中各个点的法向量以及模板点云中的各个特征点；对模板点云进行区域划分，得到模板点云的各个区域；根据各个特征点的描述子得到各个特征点的代表性；根据模板点云中所有特征点之间的距离得到最大半径，根据最大半径得到各个球体半径；获取以各个特征点为球心，各个球体半径对应的球体区域，对各个球体区域中所有点的法向量坐标进行聚类，得到各个聚类结果以及对应聚类中心，根据各个球体区域内各个聚类中心之间的距离得到各个球体区域的法向变化程度；根据各个球体区域的参考权重以及法向变化程度得到各个特征点的特征强度；根据各个特征点的代表性以及特征强度得到各个特征点的自身特征，根据各个特征点之间的距离以及各个特征点的自身特征得到各个特征点的局部聚集强度；根据各个区域中各个特征点的局部聚集强度得到各个区域的区域特征强度；根据各个区域的区域特征强度以及预设数量得到各个区域的预匹配特征点；获取待测点云中的各个特征点，将模板点云中所有预匹配特征点与待测点云的各个特征点进行匹配，得到配准后的待测点云，根据配准后的待测点云中各个点的最邻近距离得到各个点的缺陷概率，根据各个点的缺陷概率得到各个缺陷点，根据各个缺陷点得到各个缺陷区域。优选的，所述各个特征点的代表性的获取方法包括：获取各个特征点与其他特征点的描述子之间的夹角余弦值，计算所得所有夹角余弦值的平均值，将超参数与所得平均值之间的差值作为各个特征点的代表性。优选的，所述最大半径的获取方法为：计算模板点云中各个特征点之间的距离，将所得各个距离的最小值作为最大半径。优选的，所述根据各个球体区域内各个聚类中心之间的距离得到各个球体区域的法向变化程度的方法为：计算各个球体区域中各个聚类中心与其他聚类中心之间距离的平均值，将所得平均值作为各个聚类中心的距离平均值；将各个球体区域中所有聚类中心对应的距离平均值的累加和作为各个球体区域的法向变化程度。优选的，所述各个球体区域的参考权重的获取方法为：计算各个球体区域的序号与1.0之间的差值，并获取所得差值与预设等分量之间的比值，将1.0与所得比值之间的差值作为各个球体区域的参考权重。优选的，所述各个特征点的特征强度的获取方法为：计算以各个特征点为球心的各个球体区域对应的法向变化程度与参考权重之间的乘积，将所得各个乘积的累加和作为各个特征点的特征强度。优选的，所述各个特征点的局部聚集强度的获取表达式为：式中，为第i个特征点的局部聚集强度；u为第i个特征点所处区域的序号；为第u个区域中包含的特征点的总个数；为第i个特征点的自身特征；R为最大半径；为第i个特征点与其所处区域中的第s个特征点之间的欧氏距离；为该第s个特征点的自身特征。优选的所述各个区域的预匹配特征点的获取方法为：获取模板点云的各个区域归一化后的区域特征强度，将各个区域归一化后的区域特征强度作为各个区域的特征点提取比例，将各个区域的特征点提取比例与预设数量的乘积，并对所得提取数量值向下取整后的结果作为各个区域的提取数量值，将各个区域中所有特征点的局部聚集强度从大到小进行排序，并依次选取数量等于对应提取数量值的特征点作为各个区域的预匹配特征点。优选的，所述配准后的待测点云中各个点的最邻近距离是指：计算配准后的待测点云中各个点与模板点云中的所有点之间的距离，将所得所有距离中的最小距离作为各个点的最邻近距离。本发明的有益效果是：首先根据模板点云中各个特征点描述子之间的差异得到各个特征点的代表性，从而获取五金冲压配件中较为独特的结构对应的特征点，避免因五金冲压配件上的重复结构形成的特征点之间的相似度较高所导致的对点云配准效率的影响；然后根据各个特征点的在不同半径的球体区域内法向量的方向变化程度，即法向变化程度，得到各个特征点的特征强度，用以表征各个特征点周边结构的复杂性，并根据各个特征点的代表性以及特征强度对各个特征点的自身特征进行判断，此外，由于特征点的自身特征只能表征单个特征点的特征信息，忽略了特征点之间的关联信息，因此进一步根据各个特征点周边的特征点之间的距离以及自身特征得到各个特征点的局部聚集强度，从而得到五金冲压配件上较为独特且结构较为复杂的位置对应的特征点，提高对模板点云以及待测点云进行点云配准时的准确性；通过不同区域的区域特征强度确定各个区域中预匹配特征点的数量，使提取出的预匹配特征点可以分布在模板点云中的各个区域，从而保证提取出的预匹配特征点可以表征模板点云的整体特征，最后通过模板点云中的所有预匹配特征点，对模板点云以及待测点云进行点云配准，通过配准后的待测点云与模板点云中各个点之间的距离得到待检测的五金冲压配件的各个缺陷区域，实现用较少的特征点获取较为准确的点云配准效果，从而提高五金冲压配件的质量检测效率。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明的基于计算机视觉的五金冲压配件质量检测方法的步骤流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的基于计算机视觉的五金冲压配件质量检测方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的基于计算机视觉的五金冲压配件质量检测方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的基于计算机视觉的五金冲压配件质量检测方法的步骤流程图，该方法包括以下步骤：步骤S001：获取模板点云以及待测点云，并获取模板点云中各个点的法向量以及模板点云中的各个特征点。由于金属材质对光的反射能力较强，且五金冲压配件的加工环境较为复杂，加工过程中使用的设备也会在五金冲压配件表面形成阴影，使得五金冲压配件的表面纹理发生变化，且五金冲压件的结构类型较为复杂，不同结构之间的相互遮挡会导致五金冲压配件的表面图像中存在遮挡，此时根据图像进行质量检测容易产生较大误差，而五金冲压配件的常见缺陷大多为形变缺陷，且同模具尺寸均匀一致，因此使用三维激光扫描技术分别获取检测合格的五金冲压配件的点云数据以及待检测的五金冲压配件的点云数据，将所得点云数据分别称为模板点云以及待测点云，对模板点云进行法向量估计，得到模板点云中各个点的法向量；然后使用快速点特征直方图算法，即FPFH算法，对待测点云以及模板点云进行特征点的提取，得到模板点云中的各个特征点以及待测点云中的各个特征点，其中点云法向量估计以及FPFH算法均为现有方法，此处不再赘述。步骤S002：获取模板点云的各个区域；根据各个特征点的描述子得到各个特征点的代表性；根据以各个特征点为球心的各个球体区域的法向变化程度以及参考权重得到各个特征点的特征强度。由于生产线上的待检测的五金冲压配件在进行点云数据采集时，可以保证采集设备与检测合格的五金冲压配件的采集高度以及采集分辨率一致，但是待检测的五金冲压配件的摆放角度可能与检测合格的五金冲压配件之间存在差异，因此要想根据待测点云与模板点云对应位置上的点之间的距离对待检测的五金冲压配件进行质量检测，首先需要将待测点云与模板点云进行点云配准；但是由于待测点云以及模板点云中还有大量的点数据，点云的配准过程是将待测点云中的各个特征点与模板点云中的各个特征点分别进行匹配，会产生较大计算量，其中两个特征点之间的匹配是指计算这两个特征点的描述子之间的欧氏距离，当所得欧氏距离小于距离阈值时，认为这两个特征点互相匹配，其中点云特征点匹配为现有技术，此处不再赘述；而实际加工过程中，五金冲压配件的种类较多且生产速度较快，为了保证对五金冲压配件的质量检测效率，需要提高待测点云与模板点云的配准效率，而同模具生产的五金冲压配件是均匀一致的，因此并不需要将待测点云的所有特征点均与模板点云中的所有特征点进行匹配，而是待测点云或模板点云中筛选出少量具有较高可靠性的特征点，根据这些特征点进行模板点云与待测点云之间的配准，从而提高点云配准效率，同时得到较为准确的配准效果。其中具有较高可靠性的特征点是指具有较高特征强度的点，由于五金冲压配件上往往会存在多个相同的结构，例如五金冲压配件上的多个孔型结构，而这些孔型结构形成的特征点位置并不相同，但对应描述子之间的相似度较高，使得点云配准过程中出现一个特征点与多个位置上的特征点均具有较高匹配程度的现象，从而影响点云配准的速度以及准确度，因此当一个特征点与其他特征点之间的差异较大，表示该特征点对应位置上的结构特征越独特，即该特征点更具有代表性，此时根据该特征点进行配准得到的结果也越准确，即相对于多个同类型结构形成的特征点，本实施例期望可以根据五金冲压配件上的比较独特结构产生的特征点进行点云配准，从而提高配准效率；当一个特征点的特征强度越高，表示该特征点对应位置越具有代表性，此时根据该点进行点云配准得到的匹配效果越好；而当一个特征点周边的特征点数量越多，表示该特征点所处区域存在较多的结构信息，此时该特征点的特征强度越高；此外，相对于周边法向量方向变化较为平缓的特征点，周边点的法向量方向变化越剧烈的特征点，越能反映对应位置上的结构信息，且对应位置上的特征越明显，由于待检测的五金冲压配件表面出现形变缺陷时，会在待测点云中产生模板点云中并不存在的特征点，且部分缺陷，如毛刺缺陷较小且局部区域内形成的特征点数量较多，会认为此时的缺陷特征点具有较大的特征强度，然而缺陷往往处于待测点云的局部区域，因此待测点云中的大部分区域仍然是正常区域，且模板点云中存在的特征点在待测点云中基本上都可以找到对应的特征点，因此本实施例对模板点云进行处理，根据模板点云中各个特征点的代表性以及各个特征点的法向变化程度得到各个特征点的特征强度，根据各个特征点的特征强度得到各个区域的区域特征强度，并根据各个区域的区域特征强度进行预匹配特征点的选取，最后通过所得预匹配特征点对待测点云以及模板点云进行配准，进而实现对待测点云的缺陷检测，具体过程如下：将模板点云在横轴以及纵轴上对应的长度分别作为模板点云的长度和宽度，然后将所得长度与宽度分别进行N等分，该值可由实施者根据实际情况自行设定，例如当五金冲压配件较大时，可以将N的值设置较大一些，当五金冲压配件较小时，可以将N设置较小一些，本实施例中设置N=5，即将模板点云平均划分为25个区域；根据模板点云中各个特征点与其他特征点对应描述子之间的相似度得到各个特征点的代表性，其中使用FPFH算法得到的特征点的描述子为一个向量，因此本实施例使用各个特征点与其他特征点描述子之间的向量夹角大小表征各个特征点的代表性，其中模板点云中第i个特征点的代表性可表示为：式中，M为模板点云中特征点的总个数；表示模板点云中第i个特征点的描述子；表示模板点云中第j个特征点的描述子；表示向量取模；a为超参数，且a=1。表示第i个特征点与第j个特征点的描述子之间的夹角余弦值，用以表征第i个特征点与第j个特征点的描述子之间的差异程度，当两个特征点属于相同结构相同位置上产生的特征点时，对应的两个描述子相同，这两个描述子之间的夹角为0，当第i个特征点与其他特征点之间的夹角为0的个数越多，对应夹角余弦值为1的个数也越多，表示此时五金冲压配件中包含的相同结构越多，该特征点具有的代表性也就越小；反之，则该特征点具有的代表性也越大。通过各个特征点可以选取出五金冲压配件表面较为单一、独特的结构对应的特征点，根据此类特征点可以提高不同类型的五金冲压配件识别的准确性，提高待测点云与模板点云之间的匹配效率；但是特征点的代表性是相对于其他特征点而言的，如果一个特征点对应位置属于较为独特的结构，但是该特征点对应位置上的特征并不明显，例如该特征点周边法向量方向变化较为平缓，如该特征点为曲平面上形成的特征点，相对于周边法向量方向变化越剧烈的特征点，如棱角形成的特征点，显然棱角对应的特征点的描述子更能表征对应位置上的结构信息，在点云的配准过程中得到的匹配效果也更好，即一个特征点的代表性是根据该特征点与其他特征点的描述子之间的差异得到的，只能表示该特征点对应位置在五金冲压配件上的独特性，但是当该特征点对应位置上的特征不明显时，得到的匹配效果可能较差，因此为了得到更好的匹配效果，本实施例还需要考虑单个特征点自身的特征强度，即单个特征点周边法向量方向的变化程度，简称为法向变化程度，当单个特征点周边的法向量方向变化越剧烈，对应该特征点的特征强度越强；反之，则该特征点的特征强度越弱；本实施例根据各个特征点在不同范围内法向变化程度计算各个特征点的特征强度，即以各个特征点为球心，不同半径的球体区域内包含的所有点对应法向量方向之间的变化程度得到各个特征点的特征强度，其中，计算模板点云中所有特征点两两之间的欧氏距离，将所得所有欧氏距离中的最小值作为最大半径，记为R，此时模板点云中任意一个特征点对应的各个球体区域中均不会存在其他特征点的干扰，本实施例中将R平均分为f份，其中记f为预设等分量，本实施例中设置f=3，由此得到三种不同的球体半径，即，，，分别计算各个特征点在以、、为球体半径时对应球体区域中法向量方向之间的变化情况，得到各个特征点的特征强度，由于法向量本身为一个向量，可以将法向量转化为坐标的形式，例如向量对应的坐标也是，因此根据各个法向量对应坐标之间的距离即可得到法向量之间的差异情况，则对于模板点云中的第i个特征点，当球体半径为时，获取以第i个特征点为球心，为半径的球体区域内，所有点的法向量对应的坐标，使用均值漂移聚类算法对各个点法向量对应的坐标进行聚类，得到多个聚类结果以及各个聚类结果的聚类中心，当所得聚类结果越多，不同聚类结果对应的聚类中心之间的差异越大，对应该特征点在该球体区域内的结构越复杂，此时该特征点具有的特征强度也越大，此时该第i个特征点的特征强度可以表示为：其中，t为第t个球体半径，当t=1时，对应的球体半径为；当t=2时，球体半径为；当t=3时，球体半径为；表示第t个球体半径对应的球体区域中聚类结果的个数，因此t也可以称为第t个球体半径对应球体区域的序号；f为预设等分量，表示第t个球体半径对应的球体区域中，第k个聚类中心与其他聚类中心之间欧氏距离的平均值，将该值记为第k个聚类中心的距离平均值；表示第t个球体半径对应的球体区域中所有聚类中心的距离平均值的累加和，用以表征该球体区域的法向变化程度；当第t个球体半径对应的球体区域中所得聚类结果的聚类中心之间的欧氏距离越大，表示对应的球体区域内法线方向之间的差异越大，对应该球体区域内的五金冲压配件结构越复杂，此时该第i个特征点在对应球体区域内的特征强度越大，反之，则表示该第i个特征点在对应球体区域内的特征强度越小；表示对第i个特征点在球体半径为第t个球体半径时所得特征强度的参考权重，考虑到单一球体半径范围内特征强度的获取可能会因为数据量较少而存在误差，因此需要根据同一特征点在不同球体半径范围内的法向变化程度对该特征点的特征强度进行综合判断，但是随着球体半径的增加，对应球体区域内包含的点的数量也会增加，球体区域内聚类结果的个数增加的可能性越大，这些特征点虽然也可以表征第i个特征点的特征强度，但是并不能排除此时的特征强度是由其他点的法向量方向的变化的干扰，因此越靠近第i个特征点的球体区域内越能反映第i个特征点本身的特征，即本实施例对球体半径越小的球体区域对应的特征强度设置的参考权重更大，对球体半径越大的球体区域对应的特征强度设置的参考权重更小；重复上述方法，得到模板点云中各个特征点的特征强度。步骤S003：根据各个特征点的代表性以及特征强度得到各个特征点的自身特征，根据各个特征点之间的距离以及各个特征点的自身特征得到各个特征点的局部聚集强度，进而得到各个区域的区域特征强度；根据各个区域的区域特征强度以及预设数量得到各个区域的预匹配特征点。由于单个特征点的特征强度是建立在球体半径变化范围小于R的基础上的，而R为模板点云中所有特征点之间的最小欧氏距离，这也就意味着单个特征点在不同球体半径下的法向量方向之间的变化情况并不会受到其他特征点的干扰，因此上述所得各个特征点的特征强度本质上只能表征单个特征点的特征信息，而忽略了特征点之间的关联信息，即当一个特征点周边特征点的数量越多，各个特征点的特征强度越大，表示该特征点处于一个特征点密集分布的区域，对应该区域内的特征结构越复杂，此时如果该特征点的代表性也越大，表示该特征点对应位置同时也是五金冲压配件上较为独特且结构较为复杂的位置，相较于特征并不明显且由五金冲压配件上的重复结构形成的特征点，将此类特征点作为预匹配特征点可以得到更好的匹配效果；因此本实施例进一步根据各个特征点的自身特征，即各个特征点的代表性、特征强度，结合各个特征点与其周边特征点的位置关系得到各个特征点的局部聚集强度，根据各个特征点的局部聚集强度判断各个特征点能否作为预匹配特征点，由于判断各个特征点是否处于特征点分布密集的区域只需要判断局部区域内的特征点密度即可，为了减少不必要的计算，本实施例只根据各个特征点在所处区域内特征点的分布情况进行计算，记第i个特征点所处区域的序号为u，即第i个特征点所处区域为第u个区域，则该第i个特征点的局部聚集强度可以表示为：其中，为第u个区域中包含的特征点的总个数；为第i个特征点的自身特征，该值为第i个特征点的代表性与该第i个特征点的特征强度之间的乘积；R为最大半径；为第i个特征点与其所处区域中的第s个特征点之间的欧氏距离；为该第s个特征点的自身特征。由于各个特征点的局部聚集强度是在单个特征点的自身特征以及局部区域内特征点的位置关系计算得到的，所得结果仍然只能表征五金冲压配件的局部区域特征，如果仅根据各个特征点的局部聚集强度获取预匹配特征点，可能会出现提取的预匹配特征点分布较为集中的现象，但是点云配准过程是将两个点云进行整体匹配，为了保证点云配准的准确性，需要模板点云中提取的预匹配特征点可以表征模板点云的整体特征，即尽可能实现从模板点云的各个区域中均可以提取出特征点作为预匹配特征点；本实施例根据各个区域所包含特征点的特征强度以及代表性得到各个区域的区域特征强度，当一个区域的区域特征强度越高，表示五金冲压配件在该区域内的结构特征越明显，因此在该区域内需要提取更多的特征点作为预匹配特征点，在结构特征较弱的区域也需要提取部分特征点，从而使提取出的预匹配特征点可以表征五金冲压配件的整体特征，则第u个区域的区域特征强度为第u个区域内包含的所有特征点的局部聚集强度之间的累加和，由此得到各个区域的区域特征强度；重复上述方法，得到模板点云的各个区域的区域特征强度；然后对所有区域的特征强度进行线性归一化，并以模板点云中各个区域归一化后的区域特征强度作为各个区域的特征点提取比例，记本实施例中预匹配特征点的预设数量为Y，该值可由实施者根据实际情况自行设定，例如根据五金冲压配件的结构复杂程度或者五金冲压配件的大小，本实施例中设置Y=150，则第u个区域应该选取的预匹配特征点数量，即第u个区域的提取数量值的获取方法为：计算预设数量Y与第u个区域的特征点提取比例之间的乘积，并对所得乘积向下取整后的结果，其中在对第u个区域进行预匹配特征点的选取时，将该第u个区域中所有特征点的局部聚集强度从大到小进行排序，依次选取个特征点作为该第u个区域对应的预匹配特征点；重复上述方法，得到模板点云中各个区域的预匹配特征点。步骤S004：根据模板点云的所有预匹配特征点得到配准后的待测点云，根据配准后的待测点云中各个点的最邻近距离得到各个点的缺陷概率，进而得到各个缺陷区域。使用ICP算法对模板点云中的所有预匹配特征点与待测点云中的各个特征点进行匹配，从而将待测点云与模板点云调整到一个坐标系下，完成待测点云与模板点云之间的点云配准，得到配准后的待测点云；计算配准后的待测点云中各个点与模板点云中所有点之间的最小欧氏距离，将所得所有欧氏距离的最小距离作为待测点云中各个点的最邻近距离，其中第w个点的缺陷概率可表示为：式中，为待测点云中第w个点的最邻近距离；exp为以自然常数为底数的指数函数。由于同模具冲压形成的五金冲压配件具有均匀一致性，因此正常情况下，待检测的五金冲压配件对应的待测点云与检测合格的五金冲压配件对应的模板点云是可以完全重合的，因此模板点云与待测点云经过配准后，正常情况下第w个点的最邻近距离应趋于0，趋于1，对应第w个点的缺陷概率趋于0，而存在质量问题的缺陷区域会使对应的区域发生形变，导致缺陷区域中的点无法与模板点云完全重合，进而导致对应点的缺陷概率较大；设置概率阈值，当第w个点的缺陷概率大于等于概率阈值时，认为第w个点属于缺陷区域，否则认为该第w个点不属于缺陷区域；重复上述方法，得到待测点云中各个属于缺陷区域的点，记为各个缺陷点；最后通过均值漂移聚类算法对各个缺陷点的坐标进行聚类，得到多个聚类结果，每个聚类结果均为待检测的五金冲压配件的一个缺陷区域。通过以上步骤，完成对五金冲压配件的质量检测。本实施例首先根据模板点云中各个特征点描述子之间的差异得到各个特征点的代表性，从而获取五金冲压配件中较为独特的结构对应的特征点，避免因五金冲压配件上的重复结构形成的特征点之间的相似度较高所导致的对点云配准效率的影响；然后根据各个特征点的在不同半径的球体区域内法向量的方向变化程度，即法向变化程度，得到各个特征点的特征强度，用以表征各个特征点周边结构的复杂性，并根据各个特征点的代表性以及特征强度对各个特征点的自身特征进行判断，此外，由于特征点的自身特征只能表征单个特征点的特征信息，忽略了特征点之间的关联信息，因此进一步根据各个特征点周边的特征点之间的距离以及自身特征得到各个特征点的局部聚集强度，从而得到五金冲压配件上较为独特且结构较为复杂的位置对应的特征点，提高对模板点云以及待测点云进行点云配准时的准确性；通过不同区域的区域特征强度确定各个区域中预匹配特征点的数量，使提取出的预匹配特征点可以分布在模板点云中的各个区域，从而保证提取出的预匹配特征点可以表征模板点云的整体特征，最后通过模板点云中的所有预匹配特征点，对模板点云以及待测点云进行点云配准，通过配准后的待测点云与模板点云各个点之间的距离得到待检测的五金冲压配件的各个缺陷区域，实现用较少的特征点获取较为准确的点云配准效果，从而提高五金冲压配件的质量检测效率。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
