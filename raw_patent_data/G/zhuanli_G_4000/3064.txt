标题title
一种模型构建方法、装置、设备和介质
摘要abst
本发明公开了一种模型构建方法、装置、设备和介质。该方法包括：根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构；获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；基于样本数据，以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型。本发明实现了数据驱动的模型训练过程，并基于目标预测模型对药物体内行为数据进行预测，有效提高了模型的预测准确度度。
权利要求书clms
1.一种模型构建方法，其特征在于，包括：根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构；获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；基于所述样本数据，以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型。2.根据权利要求1所述的方法，其特征在于，所述根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型，包括：根据所述生理学先验知识和解剖学先验知识建立对应的整体生理学模型结构；或者，根据所述生理学先验知识和解剖学先验知识建立对应的局部生理学模型结构。3.根据权利要求1所述的方法，其特征在于，所述生理学参数和解剖学参数由特定个体的生理特征组成；所述药物应使用理化性质、结构特征与药学相关参数描述；所述药物体内行为数据用于表征药物与生物体的局部交互作用或其完整体内行为。4.根据权利要求1所述的方法，其特征在于，所述基于所述样本数据，以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型，包括：将所述样本数据划分为训练样本集和验证样本集；基于所述训练样本集以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的中间预测模型；基于所述验证样本集对所述中间预测模型对应的模型配置参数进行调整，得到对应的目标预测模型。5.根据权利要求4所述的方法，其特征在于，所述基于所述训练样本集以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的中间预测模型，包括：基于所述生理学模型结构将所述训练样本集中的药物相关参数、生理学参数和解剖学参数输入至原始预测模型中，经机器学习方法，并依据第一实际药物体内行为数据得到对应的第一模型生成药物体内行为数据；基于所述第一模型生成药物体内行为数据和所述第一实际药物体内行为数据对原始预测模型进行迭代训练，得到对应的中间预测模型。6.根据权利要求4所述的方法，其特征在于，所述基于所述验证样本集对所述中间预测模型对应的模型配置参数进行调整，得到对应的目标预测模型，包括：基于所述生理学模型结构将所述验证样本集中的药物相关参数、生理学参数和解剖学参数输入至中间预测模型中，得到对应的第二模型生成药物体内行为数据；基于所述第二模型生成药物体内行为数据和所述验证样本集中的第二实际药物体内行为数据对中间预测模型的模型配置参数进行调整，得到对应的至少两个候选预测模型；根据每个所述候选预测模型的泛化性能确定对应的目标预测模型。7.根据权利要求1-6任一项所述的方法，其特征在于，在所述基于所述样本数据，以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型之后，还包括：将目标对象对应的目标生理学参数、目标解剖学参数和目标药物相关参数输入至所述目标预测模型，得到对应的目标模型生成药物体内行为数据；所述目标模型生成药物体内行为数据包括：所述目标药物相关参数对应的目标药物在体内局部器官的交互特征及整体的药物体内行为数据；基于预先获取的目标实际药物体内行为数据和所述目标模型生成药物体内行为数据对所述目标预测模型的模型配置参数进行调整，得到所述目标对象对应的个性化预测模型。8.一种模型构建装置，其特征在于，包括：第一创建模块，用于根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构；获取模块，用于获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；第二创建模块，用于基于所述样本数据，以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型。9.一种电子设备，其特征在于，所述电子设备包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的计算机程序，所述计算机程序被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-7中任一项所述的模型构建方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机指令，所述计算机指令用于使处理器执行时实现权利要求1-7中任一项所述的模型构建方法。
说明书desc
技术领域本发明涉及生物信息技术领域，尤其涉及一种模型构建方法、装置、设备和介质。背景技术在药物临床开发阶段，往往需要对药物的药代动力学与药效动力学行为进行评估，药物在生物体内的行为主要取决于药物与机体的相互作用，目前基于药物结构已发展了众多定量构动关系与定量构效关系的研究方法，然而相关性质的预测对药物体内行为的预测能力不足，需要结合“自下而上”的生理药代动力学模型，PBPK模型将药物固有性质与生理参数结合起来，可基于体外实验数据预测药物在机体内的药动学行为。目前，PBPK模型广泛应用于药物相互作用评价、药物毒性和风险评估、特殊人群的药动学研究和精准用药等。在药物临床应用阶段，为区分不同患者体内药物暴露程度，需要利用大量临床数据建立“自上而下”的群体药动学模型，定量研究剂量-暴露的经时变化及其变异程度，以及影响药动学变异的因素，最终能够预测目标群体的药动学参数的典型特征及其变异性，在此基础上结合随机效应与残差变异预测未知个体的药动学参数及其置信区间。无论何种建模手段，最终目标都是预测药物给药剂量与有效性/安全性指标之间的关系，为清晰区分药动学与药效学带来的不同变异，则需要借助药物体内浓度作为中间媒介。对于特定药物，在已知给药剂量与生理参数的情况下预测药物在机体循环中不同部位的游离药物浓度，进一步表征机体循环或靶组织局部的暴露效应关系，即围绕剂量-暴露-效应关系建立药物体内行为的完整模型。然而，“自下而上”的PBPK模型涵盖了过多的经验性公式、模型假设与虚拟生理参数，有时无法表征药物体内行为与药物参数、生理参数之间的潜在关系。导致模型预测结果不理想；“自上而下”的群体药动学模型将药物的体内行为抽象为药动学参数，忽略了引起药物体内行为差异的深层规律，对于未见样本的泛化性较差。近年来，机器学习方法已经广泛应用于多个学科的实际问题，并逐步融合机制化先验知识与黑盒模型，在保留机器学习强预测能力的同时，加入先验知识形成半机制性模型，以提高模型的可解释性。目前有较多机器学习的方法对药物体外性质或体内行为进行端到端的预测，但仍未将机制性的生理学、解剖学、药代动力学、药效动力学等先验知识与机器学习的方法相结合。发明内容本发明提供了一种模型构建方法、装置、设备和介质，结合机器学习方法与生理学、药学等先验知识建立半机制模型，能够实现基于数据驱动的模型训练过程，较准确地预测局部与整体的药物体内行为。根据本发明的一方面，提供了一种模型构建方法，包括：根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构；获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；基于所述样本数据，以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型。根据本发明的另一方面，提供了一种模型构建装置，包括：第一创建模块，用于根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构；获取模块，用于获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；第二创建模块，用于基于所述样本数据，以及所述生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型。根据本发明的另一方面，提供了一种电子设备，所述电子设备包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的计算机程序，所述计算机程序被所述至少一个处理器执行，以使所述至少一个处理器能够执行本发明任一实施例所述的模型构建方法。根据本发明的另一方面，提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机指令，所述计算机指令用于使处理器执行时实现本发明任一实施例所述的模型构建方法。本发明实施例的技术方案，通过根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构，并获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；然后基于样本数据以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型，实现了数据驱动的模型训练过程，并基于目标预测模型对药物体内行为数据进行预测，有效提高了模型的预测准确度度。应当理解，本部分所描述的内容并非旨在标识本发明的实施例的关键或重要特征，也不用于限制本发明的范围。本发明的其它特征将通过以下的说明书而变得容易理解。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例提供的一种模型构建方法的流程图；图2是本发明实施例提供的一种生理学模型结构的配置示意图；图3是本发明实施例提供的另一种模型构建方法的流程图；图4是本发明实施例提供的又一种模型构建方法的流程图；图5为本发明实施例提供的一种模型构建装置的结构示意图；图6是本发明实施例提供的一种电子设备的结构框图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分的实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本发明保护的范围。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”、“原始”、“中间”、“候选”、“目标”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。在一实施例中，图1是本发明实施例提供的一种模型构建方法的流程图，本实施例可适用于采用先验知识构建目标预测模型的情况，该方法可以由模型构建装置来执行，该模型构建装置可以采用硬件和/或软件的形式实现，该模型构建装置可配置于电子设备中。如图1所示，该方法包括：S110、根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构。其中，生理学模型结构用于表征药物和生物体的局部交互作用，与已知生理学特征、解剖学特征和药物特征之间的关联关系。在实际操作过程中，生理学先验知识可以采用不同生物体的生理学特征进行表征，以及解剖学先验知识可以采用不同生物体的解剖学特征进行表征。其中，不同生物体可以包括人与医药研发领域常用的模式动物，所述模式动物包括但不限于啮齿类、非人灵长类、犬类、兔类、猪类、斑马鱼类等动物种类。生理学特征可以包括但不限于生物体的新陈代谢特征和生长发育特征；解剖学特征可以包括但不限于器官组织的结构与动态变化特征。不同生物体的生理学特征和解剖学特征可以从现有的数据库中获取。示例性地，在生物体为人体的情况下，可以从某出版物中获取不同年龄段和不同种族人口的典型生理学与解剖学特征；或者，从其它的出版物中获取多种模式生物的生理学与解剖学特征。在实施例中，药物和生物体的局部交互作用包括：生物体对药物的作用，与药物对生物体的作用。其中，生物体对药物的作用为药代动力学研究内容，即药物在生物体内的经时处置过程；药物对生物体的作用以药效动力学描述，即药物在体内产生的药效随时间和浓度变化的动力学过程。将药代动力学与药效动力学有机地结合起来，描述药物在体内随时间变化的局部与整体PK/PD特征，能更深刻表述药物与生物体的交互作用。在一实施例中，图2是本发明实施例提供的一种生理学模型结构的配置示意图。如图2所示，假设一个生物体包括N个器官，每个器官的血流量与静脉血流以及动脉血流之间存在关联，即可以通过每个器官的血流量与静脉血流，以及动脉血流的关联表征药物在体内的过程。S120、获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据。在一实施例中，生理学参数和解剖学参数由特定个体的生理特征组成；所述药物应使用理化性质、结构特征与药学相关参数描述；药物体内行为数据用于表征药物与生物体的局部交互作用或其完整体内行为。在实施例中，生理学参数和解剖学参数可以包括但不限于每个生物体的体重、性别、年龄、酶的活性以及转运体的活性等；药物与生物体的局部交互作用可以采用但不限于下述参数进行表征：与酶的相互作用，与靶点的相互作用，药物在体内各个器官的浓度，以及与蛋白结合的速率；药物的完整体内行为可以采用药动学行为进行表征。S130、基于样本数据，以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型。其中，原始预测模型指的是预先创建的一个待训练的模型框架。示例性地，原始预测模型可以为生成对抗环境模型。其中，生成对抗环境模型是使用生成对抗网络的方式学习智能决策中的环境模型。在实施例中，通过预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据作为样本数据，并基于生理学模型结构将该样本数据输入至原始预测模型中，以对原始预测模型进行迭代训练，直至迭代训练后的预测模型达到预设目标，即可得到对应的目标预测模型。本实施例的技术方案，通过根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构，并获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；然后基于样本数据以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型，实现了数据驱动的模型训练过程，并基于目标预测模型对药物体内行为数据进行预测，有效提高了模型的预测准确度度。在一实施例中，图3是本发明实施例提供的另一种模型构建方法的流程图，本实施例与上述实施例的基础上，对目标预测模型的创建过程进行说明。如图3所示，该方法包括：S310、根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构。在一实施例中，S310包括：根据生理学先验知识和解剖学先验知识建立对应的整体生理学模型结构；或者，根据生理学先验知识和解剖学先验知识建立对应的局部生理学模型结构。其中，整体生理学模型结构用于表征药物在一个生物体内的完整体内行为；局部生理学模型结构用于表征药物与生物体的局部交互作用。可以理解为，可以根据生理学先验知识和解剖学先验知识建立对应的整体生理学模型结构或局部生理学模型结构，可以根据实际应用需求进行建立。S320、获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据。S330、将样本数据划分为训练样本集和验证样本集。在实施例中，训练样本集指的是在对原始预测模型进行迭代训练所采用的训练样本数据的集合；验证样本集指的是对训练得到的预测模型进行验证所采用的验证样本数据的集合。可以理解为，训练样本集中的训练样本数据用于训练阶段；验证样本集中的验证样本数据用于验证阶段。为了保证所创建得到的目标预测模型的预测准确度，配置训练样本集中的训练样本数据与验证样本集中的验证样本数据是互斥的。S340、基于训练样本集以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的中间预测模型。在一实施例中，S340包括：S3401-S3402：S3401、基于生理学模型结构将训练样本集中的药物相关参数、生理学参数和解剖学参数输入至原始预测模型中，经机器学习方法，并依据第一实际药物体内行为数据得到对应的第一模型生成药物体内行为数据。其中，第一实际药物体内行为数据指的是训练样本集中与药物相关参数、生理学参数和解剖学参数相对应的药物体内行为数据。可以理解为，第一实际药物体内行为数据指的是根据训练样本集中的药物相关参数、生理学参数和解剖学参数而得到的真实药物体内行为数据。第一模型生成药物体内行为数据指的是将一个生物体的药物相关参数、生理学参数和解剖学参数输入至原始预测模型中，由原始预测模型生成的药物体内行为数据。在实施例中，药物体内行为数据可以理解为一个药物在生物体体内行为的时序数据，可以将药物体内行为的时序数据建模为有限步长的马尔科夫决策过程。具体来说，药物在各个时刻的体内行为数据组成状态空间；给药过程视为动作；转移模型为当前时刻的药物体内行为数据在执行动作之后的状态转移；建模过程即是从数据中训练得到药物体内行为数据的状态转移模型。在模型训练阶段的每轮迭代中，可以根据训练样本集中的生理学参数、解剖学参数和药物相关参数生成若干条对应的药物体内行为数据，作为对应的第一模型生成药物体内行为数据。S3402、基于第一模型生成药物体内行为数据和第一实际药物体内行为数据对原始预测模型进行迭代训练，得到对应的中间预测模型。其中，中间预测模型指的是以第一实际药物体内行为数据为目标，对原始预测模型进行迭代训练所得到的预测模型。可以理解为，将一个生物体的药物相关参数、生理学参数和解剖学参数输入至中间预测模型中，所得到的第一模型生成药物体内行为数据，与第一实际药物体内行为数据之间的差异值最小。S350、基于验证样本集对中间预测模型对应的模型配置参数进行调整，得到对应的目标预测模型。在一实施例中，S350包括S3501-S3503：S3501、基于生理学模型结构将验证样本集中的药物相关参数、生理学参数和解剖学参数输入至中间预测模型中，得到对应的第二模型生成药物体内行为数据。其中，第二模型生成药物体内行为数据指的是将一个生物体的药物相关参数、生理学参数和解剖学参数输入至中间预测模型中，由中间预测模型生成的药物体内行为数据。S3502、基于第二模型生成药物体内行为数据和验证样本集中的第二实际药物体内行为数据对中间预测模型的模型配置参数进行调整，得到对应的至少两个候选预测模型。其中，第二实际药物体内行为数据指的是验证样本集中与药物相关参数、生理学参数和解剖学参数相对应的药物体内行为数据。可以理解为，第二实际药物体内行为数据指的是根据验证样本集中的药物相关参数、生理学参数和解剖学参数而得到的真实药物体内行为数据。其中，候选预测模型指的是对中间预测模型的模型配置参数进行调整，所得到的的预测模型。可以理解为，每个候选预测模型与不同模型配置参数的中间预测模型相对应。在实施例中，将同一组药物相关参数、生理学参数和解剖学参数输入至不同模型配置参数的中间预测模型中，得到对应的多个第二模型生成药物体内行为数据，将与第二实际药物体内行为数据最接近和次接近的第二模型生成药物体内行为数据所对应模型配置参数的中间预测模型，作为对应的候选预测模型。当然，在候选预测模型为两个以上的情况下，可以对第二实际药物体内行为数据与第二模型生成药物体内行为数据之间的接近程度进行比对，并对接近程度进行降序排序，然后将最靠前的多个模型配置参数的中间预测模型作为对应的候选预测模型。S3503、根据每个候选预测模型的泛化性能确定对应的目标预测模型。其中，泛化性能指的是每个候选预测模型对新鲜样本的适应能力。在实施例中，泛化性能可以采用泛化误差和赤池信息量准则等评价指标进行表征。可以理解为，可以根据泛化误差、赤池信息量准则等评价指标选择最优且参数最少的候选预测模型，作为对应的目标预测模型。本实施例的技术方案，在上述实施例的基础上，基于训练样本集对原始预测模型进行迭代训练，得到对应的中间预测模型；并基于验证样本集对中间预测模型对应的模型配置参数进行调整，得到对应的目标预测模型，实现了数据驱动的模型训练过程，提高了对药物体内行为数据的预测准确度。在一实施例中，在基于样本数据，以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型之后，还包括：将目标对象对应的目标生理学参数、目标解剖学参数和目标药物相关参数输入至目标预测模型，得到对应的目标模型生成药物体内行为数据；其中，目标模型生成药物体内行为数据包括：目标药物参数对应的目标药物在体内局部器官的交互特征及整体的药物体内行为数据；基于预先获取的目标实际药物体内行为数据和目标模型生成药物体内行为数据对目标预测模型的模型配置参数进行调整，得到目标对象对应的个性化预测模型。其中，目标生理学参数、目标解剖学参数、目标药物相关参数、目标模型生成药物体内行为数据、目标实际药物体内行为数据指的是与目标对象相匹配的相关参数，但其具体的解释，与上述实施例中对应的生理学参数、解剖学参数和药物相关参数的解释类似，在此不再赘述。在实施例中，目标预测模型可以理解为一个统一的，并且可以适用于大部分生物体的预测模型。在实际操作过程中，可以在目标预测模型的基础上，根据不同生物体的药物相关参数、生理学参数和解剖学参数对目标预测模型的模型配置参数进行微调与优化，以得到相匹配于对应生物体的个性化预测模型。在实施例中，可以在目标预测模型的基础上，将目标对象的目标生理学参数、目标解剖学参数和目标药物相关参数输入至目标预测模型中，得到对应的目标模型生成药物体内行为数据，并基于目标对象的目标实际药物体内行为数据与目标模型生成药物体内行为数据对目标预测模型的模型配置参数进行微调与优化，得到与目标对象相匹配的个性化预测模型。本实施例的技术方案，在目标预测模型的基础上，可以根据目标对象的目标生理学参数、目标解剖学参数和目标药物相关参数对目标预测模型的模型配置参数进行微调与优化，得到对应的个性化预测模型，从而可以较准确地预测出目标对象的局域与整体的药物体内行为数据。在一实施例中，图4是本发明实施例提供的又一种模型构建方法的流程图。本实施例以原始预测模型为生成对抗环境模型为例，对模型构建的过程进行说明。其中，生成对抗环境模型包括生成器和判别器。如图4所示，本实施例中的模型构建过程包括如下步骤：S410、根据生理学先验知识和解剖学先验知识建立描述药物体内过程的整体或局部生理学模型结构。S420、获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据。S430、将样本数据划分为训练样本集和验证样本集。S440、基于训练样本集以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的中间预测模型。在实施例中，原始预测模型为生成对抗环境模型。相对应的，药物体内行为的时序数据被建模为有限步长的马尔可夫决策过程。具体来说，药物在各个时刻的体内数据组成状态空间；给药过程视为动作；转移模型为当前时刻的药物体内数据在执行动作之后的状态转移；建模过程即是从数据中训练得到药物体内行为数据的状态转移模型。在模型训练环节的每轮迭代中，生成器首先根据训练样本集中生理学参数、解剖学参数和药物相关参数生成若干条对应的药物体内行为数据，生成器更新目标为最大化判别器给出奖赏的累积值；判别器用于对第一模型生成药物体内行为数据赋以相应的奖赏，其更新目标为最大化区分第一模型生成药物体内行为数据与训练样本集中第一实际药物体内行为数据的能力。具体而言，当生成器完成初始化之后，判别器则最大化其对训练样本数据的对数估计，并最小化其对第一模型生成药物体内行为数据的对数估计，该过程近似于计算第一模型生成药物体内行为数据的分布与第一实际药物体内行为数据的分布之间的Jensen-Shannon散度。判别器优化目标对应的损失函数计算方式如下：上式中，为状态转移数据，Dw为判别器，w为判别器的神经网络参数。生成器的输入是状态转移数据，输出是该状态转移数据的奖赏，log)为对判别器输出的对数估计，Mθ是生成器得到的转移数据集，B是训练样本集中的转移数据集。其中，s指的是这一时刻的药物体内行为数据，a指的是在s-s′这一阶段的给药动作或饮食动作，s′指的是下一时刻的药物体内行为数据。生成器的目标是在已知策略的前提下最大化该生成对抗环境模型能够获得的奖赏函数累积值。示例性地，该过程可以使用柔性行动者-评论家、近端策略优化等算法。以PPO为例，该算法利用梯度上升的方法最大化更新后的模型与当前模型之间的优势函数。由于计算环境转移累积奖赏的优化目标时，PPO使用当前模型的转移数据分布近似更新后模型的转移数据分布，因而要求每一次迭代更新后的模型与当前模型的转移分布较为接近。该过程在最大化累积奖赏的同时限制更新后的模型与当前模型之间的距离，每一步的训练结果具有单调提升的性质。在使用PPO后，生成模型的优化目标计算方式如下：其中，是当前模型，Mθ是当前步更新后的模型，A是强化学习中的优势函数，clip函数保证了更新后模型与当前模型之间的距离较小。结合判别器的更新和生成器的更新，当判别器达到理论最优时，生成对抗环境模型学习的目标可等价于最小化第一模型生成药物体内行为数据的分布与训练样本集中第一实际生成药物体内行为数据的分布之间的距离。相较于监督学习，上述方案能够将模型关于轨迹长度的误差项从平方级减小到线性级，显著提升了模型性能。综上所述，生成对抗环境模型的学习的优化目标可表示为：S450、基于验证样本集对中间预测模型对应的模型配置参数进行调整，得到对应的目标预测模型。在模型验证阶段，生成器根据验证样本集中生理学参数、解剖学参数和药物相关参数生成若干条对应的药物体内行为数据，并计算第二模型生成药物体内行为数据与验证样本集中的第二实际药物体内行为数据之间的差异值，以评估模型的泛化性能；在此基础上不断迭代训练与验证步骤，进一步优化模型配置参数，最终根据泛化误差、赤池信息量准则等评价指标选择最优且参数最少的模型，其中，泛化误差常使用平均绝对值误差表示：其中，H表示样本数量，表示验证样本集Mθ中第i个样本的预测值，si表示验证样本集B中第i个样本的真实值。赤池信息准则建立在熵的概念基础上，可以权衡所估计模型的复杂度和此模型拟合数据的优良性，可通过下式计算。AIC＝/n其中，k是所拟合模型中参数的数量，L是通过残差平方和计算的对数似然值，n是样本数量。S460、将目标对象对应的目标生理学参数、目标解剖学参数和目标药物相关参数输入至目标预测模型，得到对应的目标模型生成药物体内行为数据。其中，目标模型生成药物体内行为数据包括：所述目标药物相关参数对应的目标药物在体内局部器官的交互特征及整体的药物体内行为数据。S470、基于预先获取的目标实际药物体内行为数据和目标模型生成药物体内行为数据对目标预测模型的模型配置参数进行调整，得到目标对象对应的个性化预测模型。在实施例中，可以根据目标对象的部分实测结果预测药物在体内其它器官的交互特征，从而若可以还原药物在体内整体的药物体内行为数据。本实施例的技术方案，结合已知的生理学参数、解剖学参数、药代动力学、药效动力学等机制性先验知识与多种机器学习方法建立目标预测模型，实现了数据驱动的模型训练过程，对药物体内行为预测准确度高，可用于新药临床前研发、临床试验阶段、临床实践用药过程的药物体内行为预测，在药物发现、开发与应用阶段提供成药性评价、临床前与临床试验设计、个体化给药的依据，可以促进药物研发与临床精准用药的极大发展。在一实施例中，图5为本发明实施例提供的一种模型构建装置的结构示意图。如图5所示，该装置包括：第一创建模块510、获取模块520和第二创建模块530。其中，第一创建模块510，用于根据生理学先验知识和解剖学先验知识建立描述药物体内过程的生理学模型结构；获取模块520，用于获取预设生物体集合中每个生物体的生理学参数、解剖学参数及其使用特定药物后的药物体内行为数据，作为样本数据；第二创建模块530，用于基于样本数据，以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型。在一实施例中，第一创建模块510，具体用于：根据生理学先验知识和解剖学先验知识建立对应的整体生理学模型结构；或者，根据生理学先验知识和解剖学先验知识建立对应的局部生理学模型结构。在一实施例中，生理学参数和解剖学参数由特定个体的生理特征组成；药物应使用理化性质、结构特征与药学相关参数描述；药物体内行为数据用于表征药物与生物体的局部交互作用或其完整体内行为。在一实施例中，第二创建模块530，包括：划分单元，用于将样本数据划分为训练样本集和验证样本集；训练单元，用于基于训练样本集以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的中间预测模型；调整单元，用于基于验证样本集对中间预测模型对应的模型配置参数进行调整，得到对应的目标预测模型。在一实施例中，训练单元，包括：第一生成子单元，用于基于生理学模型结构将训练样本集中的药物相关参数、生理学参数和解剖学参数输入至原始预测模型中，经机器学习方法，并依据第一实际药物体内行为数据得到对应的第一模型生成药物体内行为数据；训练子单元，用于基于第一模型生成药物体内行为数据和第一实际药物体内行为数据对原始预测模型进行迭代训练，得到对应的中间预测模型。在一实施例中，调整单元，包括：第二生成子单元，用于基于生理学模型结构将验证样本集中的药物相关参数、生理学参数和解剖学参数输入至中间预测模型中，得到对应的第二模型生成药物体内行为数据；调整子单元，用于基于第二模型生成药物体内行为数据和验证样本集中的第二实际药物体内行为数据对中间预测模型的模型配置参数进行调整，得到对应的至少两个候选预测模型；确定子单元，用于根据每个候选预测模型的泛化性能确定对应的目标预测模型。在一实施例中，在基于样本数据，以及生理学模型结构对预先创建的原始预测模型进行训练，得到对应的目标预测模型之后，模型构建装置，还包括：生成模块，用于将目标对象对应的目标生理学参数、目标解剖学参数和目标药物相关参数输入至目标预测模型，得到对应的目标模型生成药物体内行为数据；目标模型生成药物体内行为数据包括：目标药物相关参数对应的目标药物在体内局部器官的交互特征及整体的药物体内行为数据；第三创建模块，用于基于预先获取的目标实际药物体内行为数据和目标模型生成药物体内行为数据对目标预测模型的模型配置参数进行调整，得到目标对象对应的个性化预测模型。本发明实施例所提供的模型构建装置可执行本发明任意实施例所提供的模型构建方法，具备执行方法相应的功能模块和有益效果。在一实施例中，图6是本发明实施例提供的一种电子设备的结构框图。如图6所示，示出了可以用来实施本发明的实施例的电子设备10的结构示意图。电子设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本发明的实现。如图6所示，电子设备10包括至少一个处理器11，以及与至少一个处理器11通信连接的存储器，如只读存储器12、随机访问存储器13等，其中，存储器存储有可被至少一个处理器执行的计算机程序，处理器11可以根据存储在只读存储器12中的计算机程序或者从存储单元18加载到随机访问存储器13中的计算机程序，来执行各种适当的动作和处理。在RAM 13中，还可存储电子设备10操作所需的各种程序和数据。处理器11、ROM 12以及RAM 13通过总线14彼此相连。输入/输出接口15也连接至总线14。电子设备10中的多个部件连接至I/O接口15，包括：输入单元16，例如键盘、鼠标等；输出单元17，例如各种类型的显示器、扬声器等；存储单元18，例如磁盘、光盘等；以及通信单元19，例如网卡、调制解调器、无线通信收发机等。通信单元19允许电子设备10通过诸如因特网的计算机网络和/或各种电信网络与其他设备交换信息/数据。处理器11可以是各种具有处理和计算能力的通用和/或专用处理组件。处理器11的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的处理器、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。处理器11执行上文所描述的各个方法和处理，例如模型构建方法。在一些实施例中，模型构建方法可被实现为计算机程序，其被有形地包含于计算机可读存储介质，例如存储单元18。在一些实施例中，计算机程序的部分或者全部可以经由ROM 12和/或通信单元19而被载入和/或安装到电子设备10上。当计算机程序加载到RAM 13并由处理器11执行时，可以执行上文描述的模型构建方法的一个或多个步骤。备选地，在其他实施例中，处理器11可以通过其他任何适当的方式而被配置为执行模型构建方法。本文中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、负载可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本发明的方法的计算机程序可以采用一个或多个编程语言的任何组合来编写。这些计算机程序可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器，使得计算机程序当由处理器执行时使流程图和/或框图中所规定的功能/操作被实施。计算机程序可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本发明的上下文中，计算机可读存储介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的计算机程序。计算机可读存储介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。备选地，计算机可读存储介质可以是机器可读信号介质。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在电子设备上实施此处描述的系统和技术，该电子设备具有：用于向用户显示信息的显示装置或者LCD监视器)；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给电子设备。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网、区块链网络和互联网。计算系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，又称为云计算服务器或云主机，是云计算服务体系中的一项主机产品，以解决了传统物理主机与VPS服务中，存在的管理难度大，业务扩展性弱的缺陷。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发明中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本发明的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
