标题title
一种预测行人轨迹的方法、装置、设备及存储介质
摘要abst
本发明公开了一种预测行人轨迹的方法、装置、设备及存储介质，其方法包括：获取当前行人过去的历史轨迹信息，并通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征；利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息，并利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征；利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹。
权利要求书clms
1.一种预测行人轨迹的方法，其特征在于，包括：获取当前行人过去的历史轨迹信息，并通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征；利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息，并利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征；利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹。2.根据权利要求1所述的方法，其特征在于，所述通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征包括：通过全连接网络将所述当前行人过去的历史轨迹信息从坐标空间转化到特征空间；通过将所述特征空间和当前行人上一时刻的行人运动特征进行编码处理，得到当前行人的行人运动特征。3.根据权利要求2所述的方法，其特征在于，所述通过将所述特征空间和当前行人上一时刻的行人运动特征进行编码处理，得到当前行人的行人运动特征包括：其中，是指行人运动特征；是指函数；是指特征空间；是指函数的权重参数，是编码器的权重参数。4.根据权利要求2所述的方法，其特征在于，所述利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息包括：根据当前行人的行人运动特征，计算当前行人与其每个相邻行人的相对运动信息；利用所述相对运动信息，计算当前行人与其每个相邻行人的注意力权重；利用所述相对运动信息和所述注意力权重，得到当前行人的权重信息。5.根据权利要求4所述的方法，其特征在于，所述利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征包括：其中，是行人运动隐藏特征；是相邻行人上一时刻的运动状态信息，是上一时刻周围行人的对行人未来轨迹的影响，权重信息是权重信息；是噪声。6.根据权利要求5所述的方法，其特征在于，所述利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹包括：获取当前行人的初始运动状态信息，并利用所述当前行人的行人运动隐藏特征对所述初始运动状态信息进行更新处理，得到更新后的运动状态信息；通过将所述更新后的当前运动状态转化到坐标空间,得到当前行人的预测行人轨迹。7.根据权利要求6所述的方法，其特征在于，所述通过将所述更新后的当前运动状态转化到坐标空间,得到当前行人的预测行人轨迹包括：其中，是预测行人轨迹：是更新后的当前运动状态，是指函数的权重参数。8.一种预测行人轨迹的装置，其特征在于，包括：处理模块，用于获取当前行人过去的历史轨迹信息，并通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征；利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息，并利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征；预测模块，用于利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹。9.一种电子设备，其特征在于，包括：存储器；处理器；以及计算机程序；其中，所述计算机程序存储在所述存储器中，并被配置为由所述处理器执行以实现如权利要求1-7任一项所述的方法。10.一种计算机可读存储介质，其特征在于，其上存储有计算机程序；所述计算机程序被处理器执行以实现如权利要求1-7任一项所述的方法。
说明书desc
技术领域本发明涉及交通环境感知技术领域，特别涉及一种预测行人轨迹的方法、装置、设备及存储介质。背景技术目前国内外研究者对人与人，人与车的交互特征的提取较为单一，无法充分利用其中的交互信息。人们开始加强对无人驾驶系统安全性的研究，预测行人的轨迹路线可让无人驾驶决策系统提前做出下一步的规划，避免交通事故的发生。但是行人的轨迹预测是很难的，首先行人的轨迹预测会受到很多因素的影响，例如和周边其他行人的运动轨迹，周边障碍物的分布，地面的情况等，会导致行人轨迹多种多样。其次是行人之间的运动轨迹是相互影响的，例如为了躲避周边其他人，行人会下意识的改变自己之前的运动轨迹去保护自己，防止被碰撞等。其中交通环境感知是无人驾驶技术中极为重要的一部分，而行人轨迹预测则是一个亟待解决和优化的难点。传统方法只能简单地进行线性序列预测，容易忽视人的运动信息特征，从而导致准确性差。随着神经网络在行人轨迹预测方面的使用，极大地增强了行人运动特征和意图收集与分析，虽然增加了预测的准确性，反而造成网络的负担过重、特征信息过多过杂，导致准确性达不到预期。发明内容根据本发明实施例提供的方案解决的技术问题是车辆在静止状态下人流湍急的行人过马路的交通场景预测行人轨迹的网络收集特征信息过杂导致准确性低的问题。根据本发明实施例提供的一种预测行人轨迹的方法，包括：获取当前行人过去的历史轨迹信息，并通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征；利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息，并利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征；利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹。根据本发明实施例提供的一种预测行人轨迹的装置，包括：处理模块，用于获取当前行人过去的历史轨迹信息，并通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征；利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息，并利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征；预测模块，用于利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹。本申请实施例提供的一种电子设备，包括：存储器；处理器；以及计算机程序；其中，所述计算机程序存储在所述存储器中，并被配置为由所述处理器执行以实现一种预测行人轨迹的方法。本申请实施例提供的一种计算机可读存储介质，其上存储有计算机程序；所述计算机程序被处理器执行以实现一种预测行人轨迹的方法。根据本发明实施例提供的方案，提升了行人运动隐藏特征提取准确率，并在符合社交规则的前提下提供了多条良好的预测轨迹可能，结果更具有多样性和可选择性。附图说明此处所说明的附图用来提供对本发明的进一步理解，构成本发明的一部分，本发明的示意性实施例及其说明用于理解本发明，并不构成对本发明的不当限定。在附图中：图1是本发明实施例提供的一种预测行人轨迹的方法流程图；图2是本发明实施例提供的一种预测行人轨迹的装置示意图；图3是本发明实施例提供的基于社交行为的行人运动隐藏特征提取方法的流程图。具体实施方式以下结合附图对本发明的优选实施例进行详细说明，应当理解，以下所说明的优选实施例仅用于说明和解释本发明，并不用于限定本发明。本发明实施例适用于车辆在静止状态下人流湍急的行人过马路的交通场景预测行人轨迹的网络收集特征信息过杂环境下。图1是本发明实施例提供的一种预测行人轨迹的方法流程图，如图1所示，包括：步骤S101：获取当前行人过去的历史轨迹信息，并通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征；步骤S102：利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息，并利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征；步骤S103：利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹。具体地说，所述通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征包括：通过全连接网络将所述当前行人过去的历史轨迹信息从坐标空间转化到特征空间；通过将所述特征空间和当前行人上一时刻的行人运动特征进行编码处理，得到当前行人的行人运动特征。其中，所述通过将所述特征空间和当前行人上一时刻的行人运动特征进行编码处理，得到当前行人的行人运动特征包括：其中，是指行人运动特征；是指函数；是指特征空间；是指函数的权重参数，是编码器的权重参数。进一步地，所述利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息包括：根据当前行人的行人运动特征，计算当前行人与其每个相邻行人的相对运动信息；利用所述相对运动信息，计算当前行人与其每个相邻行人的注意力权重；利用所述相对运动信息和所述注意力权重，得到当前行人的权重信息。其中，所述利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征包括：其中，是行人运动隐藏特征；是相邻行人上一时刻的运动状态信息，是上一时刻周围行人的对行人未来轨迹的影响，权重信息是权重信息；是噪声。具体地说，所述利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹包括：获取当前行人的初始运动状态信息，并利用所述当前行人的行人运动隐藏特征对所述初始运动状态信息进行更新处理，得到更新后的运动状态信息；通过将所述更新后的当前运动状态转化到坐标空间,得到当前行人的预测行人轨迹。其中，所述通过将所述更新后的当前运动状态转化到坐标空间,得到当前行人的预测行人轨迹包括：其中，是预测行人轨迹：是更新后的当前运动状态，是指函数的权重参数。图2是本发明实施例提供的一种预测行人轨迹的装置示意图，如图2所示，包括：处理模块，用于获取当前行人过去的历史轨迹信息，并通过对所述历史轨迹信息进行编码处理，得到当前行人的行人运动特征；利用社交注意力机制对所述行人运动特征进行处理，得到当前行人的权重信息，并利用所述权重信息和所述行人运动特征，得到当前行人的行人运动隐藏特征；预测模块，用于利用所述当前行人的行人运动隐藏特征对当前行人的行人轨迹进行预测，得到当前行人的预测行人轨迹。本申请实施例提供的一种电子设备，包括：存储器；处理器；以及计算机程序；其中，所述计算机程序存储在所述存储器中，并被配置为由所述处理器执行以实现一种预测行人轨迹的方法。本申请实施例提供的一种计算机可读存储介质，其上存储有计算机程序；所述计算机程序被处理器执行以实现一种预测行人轨迹的方法。图3是本发明实施例提供的基于社交行为的行人运动隐藏特征提取方法的流程图，包括以下步骤：S1.在编码器中通过长短时序网络对过去的轨迹进行编码，得到行人的运动特征。通过全连接网络将当前行人的轨迹序列从坐标空间转化到特征空间得到；是编码器中全连接网络的权重参数。通过函数将线性嵌入后与行人之前的状态输入到编码器LSTM模块进行编码,直到观测序列结束，将所有信息都完成编码,并对行人u的运动特征进行更新；式中：是函数的权重参数，是编码器的权重参数，通过预训练微调初始化。长短时序网络内部结构循环单元，整个网络可以建立较长距离的时序依赖关系。首先读取上一时刻的序列，进行编码，得到隐藏状态和简单的序列传递规律，经由第一个门：遗忘门，输入一个在0到1之间数值给每个在记忆单元，1表示完全保留，0表示完全舍弃。经由第二个门：输入门，将确定什么样的信息内存放在记忆单元中。经由第三个门：更新门，去除掉不用需要的特征留下重要的特征，更新记忆元状态，得到下一时刻的序列传递规律。最后一个门：输出门，在这里将最后内部筛选的结果传递给外部的隐藏状态，从而得到下一时刻的隐藏状态，进一步得到下一时刻的序列。S2. 将步骤S1中得到的行人的运动特征,通过社交注意力机制对待测行人产生权重信息来评估其他行人对待测行人的影响。S21、计算行人与他周围相邻行人的相对运动信息；行人和他周围交互密切的行人之间相对位置信息由进行计算，再将通过全连接网络映射至，得到行人和他周围交互密切的行人之间相对运动信息，由行人和之间的欧氏距离相组合，行人与行人的方位角，以及最近接近的距离三个部分组成，式中为该全连接层的权重参数，计算公式如下所示：式中，是过去轨迹的序列数，本发明是将前八序列轨迹作为过去的轨迹。S22、计算每个相邻行人的注意力权重。行人和之间的是通过全连接层将嵌入中的，是相邻行人的运动特征信息。式中，是行人a与他周围相邻行人的交互运动信息，N是行人的总数，是和应用于运动特征信息的线性映射权重的公共行列, 是全连接层的权重参数。S23、将和通过标量积和softmax运算得到每个相邻行人的注意力权重，是所有行人运动特征信息，表示行人的数量，、。,S3.在解码器中根据S2得到的权重信息，结合行人的运动状态和相邻行人的运动状态，得到有用的行人运动隐藏特征。式中，是相邻行人上一时刻的运动状态信息，是上一时刻周围行人的对行人未来轨迹的影响，是噪声。S4.根据S3中得到的运动隐藏特征和行人的当前运动状态预测行人轨迹。解码器中长短时序网络接收到的行人的初始的当前运动状态信息为,是编码器的状态级联高级噪声得到的。随后更新，就需要将上一时刻的运动状态信息和上一时刻注意力机制模块筛选到的有用的行人运动隐藏特征相结合到长短时序网络中得到的。式中，是长短时序网络的解码单元函数，是解码器中长短时序网络的权重。然后通过函数将更新后的当前运动状态转化到坐标空间,得到预测的未来轨迹：式中是函数的权重。尽管上文对本发明进行了详细说明，但是本发明不限于此，本技术领域技术人员可以根据本发明的原理进行各种修改。因此，凡按照本发明原理所作的修改，都应当理解为落入本发明的保护范围。
