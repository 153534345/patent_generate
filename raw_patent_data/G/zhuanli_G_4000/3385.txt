标题title
面部绑定模型的训练方法、面部绑定方法、装置及设备
摘要abst
本公开提供了一种面部绑定模型的训练方法、面部绑定方法、装置及设备，涉及人工智能技术领域，尤其涉及深度学习技术领域，可用于虚拟数字人场景。具体实现方案为：采用所述第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到所述第一面部形变数据对应的最优面部绑定参数；采用所述第一面部绑定子模型，对所述最优面部绑定参数进行面部形变预测，得到所述第一面部形变数据对应的重建面部形变数据；根据所述第一面部形变数据和所述重建面部形变数据，对所述第二面部绑定子模型进行训练。通过上述技术方案，能够提高面部绑定的效率。
权利要求书clms
1.一种面部绑定模型的训练方法，所述面部绑定模型包括第一面部绑定子模型和第二面部绑定子模型，包括：采用所述第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到所述第一面部形变数据对应的最优面部绑定参数；采用所述第一面部绑定子模型，对所述最优面部绑定参数进行面部形变预测，得到所述第一面部形变数据对应的重建面部形变数据；根据所述第一面部形变数据和所述重建面部形变数据，对所述第二面部绑定子模型进行训练。2.根据权利要求1所述的方法，其中，所述第一面部绑定子模型的训练过程如下：对样本面部形变数据进行特征提取，得到所述样本面部形变数据的全局形状特征；对所述全局形状特征进行降维预测，得到所述样本面部形变数据对应的预测面部绑定参数；根据所述预测面部绑定参数和所述样本面部形变数据对应的样本面部绑定参数，对第一面部绑定子模型进行训练。3.根据权利要求2所述的方法，其中，所述对样本面部形变数据进行特征提取，得到所述样本面部形变数据的全局形状特征，包括：对所述样本面部形变数据中顶点进行特征提取，得到所述顶点的顶点特征；对所述顶点特征进行特征转换，得到所述样本面部形变数据的全局形状特征。4.根据权利要求3所述的方法，其中，所述对所述顶点特征进行特征转换，得到所述样本面部形变数据的全局形状特征，包括：按照特征顺序，对所述顶点特征进行转换，得到序列特征；对所述序列特征进行处理，得到所述样本面部形变数据的全局形状特征。5.根据权利要求1所述的方法，其中，所述采用所述第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到所述第一面部形变数据对应的最优面部绑定参数，包括：采用所述第一面部绑定子模型，对初始面部绑定参数进行面部形变预测，得到预测面部形变数据；根据所述预测面部形变数据和所述第一面部形变数据，确定最优面部绑定参数。6.根据权利要求5所述的方法，其中，所述根据所述预测面部形变数据和所述第一面部形变数据，确定最优面部绑定参数，包括：根据所述预测面部形变数据和所述第一面部形变数据，逐点构建参数优化损失；对所述参数优化损失进行优化，得到最优面部绑定参数。7.根据权利要求1所述的方法，其中，所述根据所述第一面部形变数据和所述重建面部形变数据，对所述第二面部绑定子模型进行训练，包括：对所述重建面部形变数据进行噪声处理，得到第二重建面部形变数据；根据所述第一面部形变数据和所述第二重建面部形变数据，对所述第二面部绑定子模型进行训练。8.根据权利要求7所述的方法，其中，所述对所述重建面部形变数据进行噪声处理，得到第二重建面部形变数据，包括：对所述重建面部形变数据添加噪声，得到第一重建面部形变数据；对所述第一重建面部形变数据进行反向去噪处理，得到第二重建面部形变数据。9.一种面部绑定方法，包括：获取目标对象的目标面部绑定参数；采用面部绑定模型，对所述目标面部绑定参数进行面部形变预测，得到所述目标对象的目标面部形变数据；其中，所述面部绑定模型基于权利要求1-8中任一项所述的面部绑定模型的训练方法训练得到。10.一种面部绑定模型的训练装置，所述面部绑定模型包括第一面部绑定子模型和第二面部绑定子模型，包括：最优绑定参数确定模块，用于采用所述第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到所述第一面部形变数据对应的最优面部绑定参数；重建面部数据确定模块，用于采用所述第一面部绑定子模型，对所述最优面部绑定参数进行面部形变预测，得到所述第一面部形变数据对应的重建面部形变数据；第二模型训练模块，用于根据所述第一面部形变数据和所述重建面部形变数据，对所述第二面部绑定子模型进行训练。11.根据权利要求10所述的装置，其中，所述装置还包括第一模型训练模块，所述第一模型训练模块包括：全局形状特征确定单元，用于对样本面部形变数据进行特征提取，得到所述样本面部形变数据的全局形状特征；预测绑定参数确定单元，用于对所述全局形状特征进行降维预测，得到所述样本面部形变数据对应的预测面部绑定参数；第一模型训练单元，用于根据所述预测面部绑定参数和所述样本面部形变数据对应的样本面部绑定参数，对第一面部绑定子模型进行训练。12.根据权利要求11所述的装置，其中，所述全局形状特征确定单元，包括：顶点特征确定子单元，用于对所述样本面部形变数据中顶点进行特征提取，得到所述顶点的顶点特征；全局形状特征确定子单元，用于对所述顶点特征进行特征转换，得到所述样本面部形变数据的全局形状特征。13.根据权利要求12所述的装置，其中，所述全局形状特征确定子单元具体用于：按照特征顺序，对所述顶点特征进行转换，得到序列特征；对所述序列特征进行处理，得到所述样本面部形变数据的全局形状特征。14.根据权利要求10所述的装置，其中，所述最优绑定参数确定模块，包括：预测形变数据确定单元，用于采用所述第一面部绑定子模型，对初始面部绑定参数进行面部形变预测，得到预测面部形变数据；最优绑定参数确定单元，用于根据所述预测面部形变数据和所述第一面部形变数据，确定最优面部绑定参数。15.根据权利要求14所述的装置，其中，所述最优绑定参数确定单元具体用于：根据所述预测面部形变数据和所述第一面部形变数据，逐点构建参数优化损失；对所述参数优化损失进行优化，得到最优面部绑定参数。16.根据权利要求10所述的装置，其中，所述第二模型训练模块，包括：重建形变数据处理单元，用于对所述重建面部形变数据进行噪声处理，得到第二重建面部形变数据；第二模型训练单元，用于根据所述第一面部形变数据和所述第二重建面部形变数据，对所述第二面部绑定子模型进行训练 。17.根据权利要求16所述的装置，其中，所述重建形变数据处理单元具体用于：对所述重建面部形变数据添加噪声，得到第一重建面部形变数据；对所述第一重建面部形变数据进行反向去噪处理，得到经处理的重建面部形变数据。18.一种面部绑定装置，包括：目标绑定参数获取模块，用于获取目标对象的目标面部绑定参数；目标形变数据确定模块，用于采用面部绑定模型，对所述目标面部绑定参数进行面部形变预测，得到所述目标对象的目标面部形变数据 ；其中，所述面部绑定模型基于权利要求1-8中任一项所述的面部绑定模型的训练方法训练得到。19. 一种电子设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-8中任一项所述的面部绑定模型的训练方法，或权利要求9所述的面部绑定方法。20.一种存储有计算机指令的非瞬时计算机可读存储介质，其中，所述计算机指令用于使计算机执行根据权利要求1-8中任一项所述的面部绑定模型的训练方法，或权利要求9所述的面部绑定方法。21.一种计算机程序产品，包括计算机程序，所述计算机程序在被处理器执行时实现根据权利要求1-8中任一项所述的面部绑定模型的训练方法，或权利要求9所述的面部绑定方法。
说明书desc
技术领域本公开涉及人工智能技术领域，尤其涉及深度学习技术领域，可用于虚拟数字人场景。背景技术目前数字人应用场景涉及大量的三维面部动画，而要驱动三维面部，必不可少的一个步骤是进行三维面部的绑定。传统的三维面部绑定流程需要投入大量的人力和时间，动画师需要进行反复的调优和测试才能得到一套可用的绑定。如何进行快速精准的三维面部绑定是一个亟待解决的技术难题。发明内容本公开提供了一种面部绑定模型的训练方法、面部绑定方法、装置及设备。根据本公开的一方面，提供了一种面部绑定模型的训练方法，所述面部绑定模型包括第一面部绑定子模型和第二面部绑定子模型，该方法包括：采用所述第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到所述第一面部形变数据对应的最优面部绑定参数；采用所述第一面部绑定子模型，对所述最优面部绑定参数进行面部形变预测，得到所述第一面部形变数据对应的重建面部形变数据；根据所述第一面部形变数据和所述重建面部形变数据，对所述第二面部绑定子模型进行训练。根据本公开的另一方面，提供了一种面部绑定方法，该方法包括：获取目标对象的目标面部绑定参数；采用面部绑定模型，对所述目标面部绑定参数进行面部形变预测，得到所述目标对象的目标面部形变数据；其中，所述面部绑定模型基于本公开任一实施例所述的面部绑定模型的训练方法训练得到。根据本公开的另一方面，提供了一种面部绑定模型的训练装置，所述面部绑定模型包括第一面部绑定子模型和第二面部绑定子模型，包括：最优绑定参数确定模块，用于采用所述第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到所述第一面部形变数据对应的最优面部绑定参数；重建面部数据确定模块，用于采用所述第一面部绑定子模型，对所述最优面部绑定参数进行面部形变预测，得到所述第一面部形变数据对应的重建面部形变数据；第二模型训练模块，用于根据所述第一面部形变数据和所述重建面部形变数据，对所述第二面部绑定子模型进行训练。根据本公开的另一方面，提供了一种面部绑定装置，包括：目标绑定参数获取模块，用于获取目标对象的目标面部绑定参数；目标形变数据确定模块，用于采用面部绑定模型，对所述目标面部绑定参数进行面部形变预测，得到所述目标对象的目标面部形变数据 ；其中，所述面部绑定模型基于本公开任一实施例所述的面部绑定模型的训练方法训练得到。根据本公开的另一方面，提供了一种电子设备，该电子设备包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行本公开任一实施例所述面部绑定模型的训练方法或面部绑定方法。根据本公开的另一方面，提供了一种存储有计算机指令的非瞬时计算机可读存储介质，其中，所述计算机指令用于使计算机执行本公开任一实施例所述的面部绑定模型的训练方法或面部绑定方法。根据本公开的另一方面，提供了一种计算机程序产品，包括计算机程序，所述计算机程序在被处理器执行时实现本公开任一实施例所述的面部绑定模型的训练方法或面部绑定方法。根据本公开的技术，能够提高面部绑定效率。应当理解，本部分所描述的内容并非旨在标识本公开的实施例的关键或重要特征，也不用于限制本公开的范围。本公开的其它特征将通过以下的说明书而变得容易理解。附图说明附图用于更好地理解本方案，不构成对本公开的限定。其中：图1是根据本公开实施例提供的一种面部绑定模型的训练方法的流程图；图2是根据本公开实施例提供的另一种面部绑定模型的训练方法的流程图；图3是根据本公开实施例提供的又一种面部绑定模型的训练方法的流程图；图4是根据本公开实施例提供的又一种面部绑定模型的训练方法的流程图；图5是根据本公开实施例提供的一种面部绑定方法的流程图；图6是根据本公开实施例提供的一种面部绑定模型的训练装置的结构示意图；图7是根据本公开实施例提供的一种面部绑定装置的结构示意图；图8是用来实现本公开实施例的面部绑定模型的训练方法或面部绑定方法的电子设备的框图。具体实施方式以下结合附图对本公开的示范性实施例做出说明，其中包括本公开实施例的各种细节以助于理解，应当将它们认为仅仅是示范性的。因此，本领域普通技术人员应当认识到，可以对这里描述的实施例做出各种改变和修改，而不会背离本公开的范围和精神。同样，为了清楚和简明，以下的描述中省略了对公知功能和结构的描述。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”、“样本”、“目标”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。此外，还需要说明的是，本发明的技术方案中，所涉及的面部绑定参数、面部形变数据及其相关数据等的收集、存储、使用、加工、传输、提供和公开等处理，均符合相关法律法规的规定，且不违背公序良俗。传统三维面部绑定方案主要分为骨骼绑定和混合形变绑定两种形式，原理上骨骼绑定主要基于脸部形变和骨骼的物理作用关系，bs绑定主要基于面部的形变组合关系。这两种方式的实现都需要动画师在三维动画软件中进行手动操作和效果调优，最终效果完全依赖于动画师的经验积累，且一旦定版之后要更改效果会非常繁琐。传统三维面部绑定方式具体可以分为如下几步：1）获取三维面部数据，其中，三维面部数据通常为具有固定拓扑结构的大量三维网格。2）基于这些三维mesh进行骨骼绑定：根据骨骼的物理驱动关系确定每个关节点对应的mesh顶点，并对每个mesh顶点确定权重。3）在骨骼绑定的基础上确定bs绑定：针对一些重要表情手工捏出对应的面部形状，并和之前的骨骼绑定结果进行融合调优。4）针对前面骨骼绑定和bs绑定的输出结果进行修补矫正，对于一些难以正确表达的表情组合引入矫正表情进行补充，并反复调试权重直至效果自然可接受。5）对前面这一套绑定系统进行反复的测试调优，直至所有表情表达都能做到准确自然，此时这套绑定可以定版。如上，整个绑定流程非常繁琐，并且高度依赖动画师的经验。如果对于每个新面部图像都需要重复这样的流程，带来的工作量是难以想象。总言而之，现有方案主要存在以下三个问题：1）流程过长：基于传统三维面部绑定方式即先完成骨骼绑定再进行bs绑定然后进行bs矫正的方式，通常需要数月的时间，流程繁琐且耗时长；2）改动不易：一旦定版之后，任何一个流程要改动都需要重新对全部环节进行调试验证；3）无法迁移：对于新面部图像无法复用已有的绑定，重新做完一套流程非常耗时。图1是根据本公开实施例提供的一种面部绑定模型的训练方法的流程图。本实施例适用于虚拟数字人场景中如何进行面部绑定的情况。该方法可以由面部绑定模型的训练装置来执行，该装置可以采用软件和/或硬件的方式实现，并可集成于承载面部绑定模型的训练功能的电子设备中，比如服务器中。如图1所示，本实施例的面部绑定模型的训练方法可以包括：S101，采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数。本实施例中，第一面部绑定子模型是指用于实现任意面部形变数据绑定的深度学习模型；可选的，第一面部绑定子模型可以包括特征提取网络和参数预测网络；其中，特征提取网络用于提取面部形变数据的特征；参数预测网络用于基于特征提取网络所提取的特征进行面部绑定参数预测。需要说明的是，本实施例中的第一面部绑定子模型是预先训练好的。所谓面部形变数据是指由多个小三角形或四边形组成的三维面部模型。所谓第一面部形变数据是指样本对象的面部形变数据。其中，样本对象可以是任意人物等。所谓面部绑定参数是指骨骼绑定或bs绑定的相关参数，例如可以是骨骼的平移旋转、bs权重等。所谓最优面部绑定参数是指与第一面部形变数据对应的最优的面部绑定参数。具体的，可以将第一面部形变数据输入第一面部绑定子模型中，经过模型反向优化处理，得到第一面部形变数据对应的最优面部绑定参数。其中，反向优化是指采用第一面部绑定子模型进行逆向处理的过程，即将第一面部形变数据输入第一面部绑定子模型，经过模型不断优化，得到第一面部形变数据对应的最优面部绑定参数。需要说明的是，第一面部绑定子模型的正向处理过程为：输入面部绑定参数，经过第一面部绑定子模型处理，输出面部形变数据。S102，采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据。本实施例中，重建面部形变数据是指基于最优面部绑定参数进行重建后的样本对象的面部形变数据。具体的，可以将最优面部绑定参数输入至第一面部绑定子模型中，经过模型预测，得到第一面部形变数据对应的重建面部形变数据。S103，根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。本实施例中，第二面部绑定子模型用于学习第一面部形变数据和重建面部形变数据之间的形状变化关系；可选的，第二面部绑定子模型可以是基于深度神经网络所构建的模型，其中，深度神经网络可以是全连接网络；例如，第二面部绑定子模型可以是基于至少一个全连接网络所构建的模型。具体的，可以根据第一面部形变数据和重建面部形变数据确定第二训练损失，基于第二训练损失对第二面部绑定子模型进行迭代训练，直到满足第二训练停止条件，停止模型迭代训练。其中，第二训练停止条件可以是第二训练次数满足第二设定次数，第二训练损失稳定在第二设定范围内；需要说明的是，第二设定次数和第二设定范围可以由本领域技术人员根据实际需求设定。其中，第二训练损失是用于对第二面部绑定子模型进行训练的损失；可选的，可以基于预设损失函数，根据第一面部形变数据和重建面部形变数据，确定第二训练损失。例如可以基于L2范数，计算第一面部形变数据中的顶点和重建面部形变数据中的顶点之间的L2范数损失，将该L2范数损失作为第二训练损失。又如，可以基于交叉熵损失，根据第一面部形变数据和重建面部形变数据，确定第二训练损失。本公开实施例提供的技术方案，通过采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数，之后采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据，进而根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。上述技术方案，相比于现有面部绑定人力和时间成本过高的问题，本公开中通过第一面部绑定子模型确定重建面部形变数据，并结合第一面部形变数据和重建面部形变数据来训练第二面部绑定子模型，提高了面部绑定的效率，同时实现了面部绑定的全自动化，并且具备良好的可拓展性。图2是根据本公开实施例提供的另一种面部绑定模型的训练方法的流程图。本实施例在上述实施例的基础上，进一步对第一面部绑定子模型的训练过程进行详细阐述。如图2所示，本实施例的面部绑定模型的训练方法可以包括：S201，对样本面部形变数据进行特征提取，得到样本面部形变数据的全局形状特征。本实施例中，所谓样本面部形变数据是训练第一面部绑定子模型所采用的面部形变数据。所谓全局形状特征是指用于表征样本面部形变数据的整体形状的特征，可以采用矩阵或向量形式表示。一种可选方式，可以基于预设形状特征提取方式，对样本面部形变数据进行特征提取，得到样本面部形变数据的全局形状特征。例如，可以采用几何参数法等常见形状特征提取方式，对样本面部形变数据进行特征提取，得到样本面部形变数据的全局形状特征。又如，还可以采用形状特征提取网络，对样本面部形变数据进行特征提取，得到样本面部形变数据的全局形状特征。其中，形状特征提取网络可以是卷积神经网络。S202，对全局形状特征进行降维预测，得到样本面部形变数据对应的预测面部绑定参数。本实施例中，所谓预测面部绑定参数是指对全局形状特征进行预测所得到的样本面部形变数据对应的面部绑定参数。所谓降维预测是指对全局形状特征进行先降维后再预测的处理过程。具体的，可以采用参数预测网络，对全局形状特征进行降维，然后对降维后的全局形状特征进行预测，得到样本面部形变数据对应的预测面部绑定参数。其中，参数预测网络可以是全连接网络。S203，根据预测面部绑定参数和样本面部形变数据对应的样本面部绑定参数，对第一面部绑定子模型进行训练。本实施例中，所谓样本面部绑定参数是指与样本面部形变数据配对的面部绑定参数。需要说明的是，样本面部绑定参数和样本面部形变数据是基于现有的绑定效果较好的三维面部绑定方式生产得到的。具体的，可以根据预测面部绑定参数和样本面部形变数据对应的样本面部绑定参数确定第一训练损失，基于第一训练损失对第一面部绑定子模型进行迭代训练，直到满足第一训练停止条件，停止模型训练。其中，第一训练停止条件为第一训练次数达到第一设定次数，或第一训练损失稳定在第一设定范围内。需要说明的是，第一设定次数和第一设定范围可以由本领域技术人员根据实际需求设定。其中，第一训练损失是用于对第一面部绑定子模型进行训练的损失；可选的，可以基于预设损失函数，根据预测面部绑定参数和样本面部绑定参数，确定第一训练损失。例如可以基于L2范数，计算预测面部绑定参数和样本面部绑定参数之间的L2范数损失，将该L2范数损失作为第一训练损失。又如，可以基于交叉熵损失，根据预测面部绑定参数和样本面部绑定参数，确定第一训练损失。S204，采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数。S205，采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据。S206，根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。本公开实施例提供的技术方案，通过对样本面部形变数据进行特征提取，得到样本面部形变数据的全局形状特征，并对全局形状特征进行降维预测，得到样本面部形变数据对应的预测面部绑定参数，之后根据预测面部绑定参数和样本面部形变数据对应的样本面部绑定参数，对第一面部绑定子模型进行训练。进而采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数，并采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据，最后根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。上述技术方案，通过预先确定的配对数据即样本面部形变数据及其对应的样本面部绑定参数，来对第一面部绑定子模型进行训练，提高了第一面部绑定子模型的面部绑定自动化，解决了传统绑定过程繁杂成本高耗时久的问题。在上述实施例的基础上，作为本公开的一种可选方式，对样本面部形变数据进行特征提取，得到样本面部形变数据的全局形状特征可以是，对样本面部形变数据中顶点进行特征提取，得到顶点的顶点特征；对顶点特征进行特征转换，得到样本面部形变数据的全局形状特征。其中，顶点特征是指样本面部形变数据中顶点的特征，可以采用矩阵或向量表示。具体的，可以采用顶点特征提取网络，对样本面部形变数据中每一顶点进行特征提取，得到该顶点的顶点特征；其中，顶点特征提取网络可以是全连接网络。之后可以将各顶点的顶点特征进行拼接，得到样本面部形变数据的全局形状特征。可以理解的是，提供一种全局形状特征的确定方式，可以准确的得到样本面部形变数据的形状特征，为后续第一面部绑定子模型的训练奠定了基础。进一步的，对顶点特征进行特征转换，得到样本面部形变数据的全局形状特征还可以是，按照特征顺序，对顶点特征进行转换，得到序列特征；对序列特征进行处理，得到样本面部形变数据的全局形状特征。其中，序列特征是指对顶点特征进行序列转换所得到的特征，可以采用矩阵或向量形式表示。所谓特征顺序是指预设的特定的顺序。具体的，可以按照特征顺序，对顶点特征进行排序，得到序列特征。之后可以基于全局形状特征提取网络，对序列特征进行二次特征提取，得到样本面部形变数据的全局形状特征，其中，全局形状特征提取网络可以是transformer模型。可以理解的是，通过对顶点特征进行序列处理来确定全局形状特征，可以得到更准确合理的全局形状特征。图3是根据本公开实施例提供的又一种面部绑定模型的训练方法的流程图。本实施例在上述实施例的基础上，对“采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数”进一步优化，提供一种可选实施方案。如图3所示，本实施例的面部绑定模型的训练方法可以包括：S301，采用第一面部绑定子模型，对初始面部绑定参数进行面部形变预测，得到预测面部形变数据。本实施例中，所谓初始面部绑定参数是随机初始化的面部绑定参数。所谓预测面部形变数据是指基于第一面部绑定子模型对初始面部绑定参数进行预测所得到的面部形变数据。具体的，可以将初始面部绑定参数输入第一面部绑定子模型，经过模型进行面部形变预测，得到预测面部形变数据。S302，根据预测面部形变数据和第一面部形变数据，确定最优面部绑定参数。一种可选方式，可以确定预测面部形变数据和第一面部形变数据之间的误差，根据该误差，对初始面部绑定参数进行调整，得到最优面部绑定参数。S303，采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据。S304，根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。本公开实施例提供的技术方案，通过采用第一面部绑定子模型，对初始面部绑定参数进行面部形变预测，得到预测面部形变数据，并根据预测面部形变数据和第一面部形变数据，确定最优面部绑定参数，之后采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据，进而根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。上述技术方案，借助第一面部绑定子模型来确定最优面部绑定参数，可以为后续第二面部绑定子模型的训练奠定基础。在上述实施例的基础上，作为本公开的一种可选实施方式，根据预测面部形变数据和第一面部形变数据，确定最优面部绑定参数可以是，根据预测面部形变数据和第一面部形变数据，逐点构建参数优化损失，对参数优化损失进行优化，得到最优面部绑定参数。其中，参数优化损失是指基于预测面部形变数据与第一面部形变数据之间逐顶点所确定的损失，例如可以是L2范数损失。具体的，对于预测面部形变数据的每一顶点，确定该顶点与第一面部形变数据中对应顶点之间的参数优化损失。之后可以采用自适应动量估计优化器对各顶点对应的参数优化损失进行优化，得到最优面部绑定参数。可以理解的是，通过逐点构建损失的方式，可以快速且准确地得到最优面部绑定参数。图4是根据本公开实施例提供的又一种面部绑定模型的训练方法的流程图。本实施例在上述实施例的基础上，对“根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练”进一步优化，提供一种可选实施方案。如图4所示，本实施例的面部绑定模型的训练方法可以包括：S401，采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数。S402，采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据。S403，对重建面部形变数据进行噪声处理，得到第二重建面部形变数据。本实施例中，第二重建面部形变数据是指对重建面部形变数据添加噪声后再去噪所得到的面部形变数据。具体的，可以基于预设噪声处理方式，对重建面部形变数据进行噪声处理，得到第二重建面部形变数据。S404，根据第一面部形变数据和第二重建面部形变数据，对第二面部绑定子模型进行训练。具体的，对第一面部形变数据和第二重建面部形变数据，进行逐点计算L2范数损失，反复迭代优化L2范数损失，以对第二面部绑定子模型进行训练。本公开实施例提供的技术方案，通过采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参，之后采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据，进而对重建面部形变数据进行噪声处理，得到第二重建面部形变数据，并根据第一面部形变数据和第二重建面部形变数据，对第二面部绑定子模型进行训练。上述技术方案，在第二面部绑定子模型中通过噪声处理重建面部形变数据，可以提升第二面部绑定子模型的迁移性能，从而可以自动精准地进行迁移绑定。在上述实施例的基础上，作为本公开的一种可选方式，对重建面部形变数据进行噪声处理，得到第二重建面部形变数据还可以是，对重建面部形变数据添加噪声，得到第一重建面部形变数据；对第一重建面部形变数据进行反向去噪处理，得到第二重建面部形变数据。其中，第一重建面部形变数据是指对面部重建数据进行噪声添加所得到的面部形变数据。具体的，可以确定噪声强度，基于噪声强度对重建面部形变数据添加高斯白噪声，得到第一重建面部形变数据。之后对第一重建面部形变数据反向去噪，逐步得到第二重建面部形变数据，也即去噪后的重建面部形变数据。其中，反向去噪是指对第一重建面部形变数据去除高斯白噪声的处理过程；也可以理解为添加噪声过程是正向过程，去除噪声的过程即为反向过程。可以理解的是，通过学习噪声和去噪的过程，可以增强第二面部绑定子模型学习第一面部绑定子模型到第二面部绑定子模型的面部形变变换关系，从而提高面部绑定模型的面部绑定性能。图5是根据本公开实施例提供的一种面部绑定方法的流程图。本实施例适用于虚拟数字人场景中如何进行面部绑定的情况。该方法可以由面部绑定装置来执行，该装置可以采用软件和/或硬件的方式实现，并可集成于承载面部绑定功能的电子设备中，比如服务器中。如图5所示，本实施例的面部绑定方法可以包括：S501，获取目标对象的目标面部绑定参数。本实施例中，所谓目标对象是指任意需要进行面部绑定的对象。所谓目标面部绑定参数是指目标对象对应的面部绑定参数。具体的，可以通过交互界面，获取目标对象的目标面部绑定参数。S502，采用面部绑定模型，对目标面部绑定参数进行面部形变预测，得到目标对象的目标面部形变数据。本实施例中，目标面部形变数据是指适配目标对象的面部形变数据。面部绑定模型基于上述任意实施例所提供的面部绑定模型的训练方法训练得到。具体的，可以将目标面部绑定参数输入面部绑定模型，通过面部绑定模型进行面部形变预测，得到目标对象的目标面部形变数据。本公开实施例提供的技术方案，通过获取目标对象的目标面部绑定参数，之后采用面部绑定模型，对目标面部绑定参数进行面部形变预测，得到目标对象的目标面部形变数据。上述技术方案，相比于现有技术中绑定过程繁琐且成本高耗时久，本公开中通过面部绑定模型可以实现全自动的面部绑定，并且可以实现自动精准的面部绑定迁移。图6是根据本公开实施例提供的一种面部绑定模型的训练装置的结构示意图。本实施例适用于虚拟数字人场景中如何进行面部绑定的情况。该装置可以采用软件和/或硬件的方式实现，并可集成于承载面部绑定模型的训练功能的电子设备中，比如服务器中。如图6所示，本实施例的面部绑定模型的训练装置600可以包括：最优绑定参数确定模块601，用于采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数；重建面部数据确定模块602，用于采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据；第二模型训练模块603，用于根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。本公开实施例提供的技术方案，通过采用第一面部绑定子模型，对第一面部形变数据进行反向优化处理，得到第一面部形变数据对应的最优面部绑定参数，之后采用第一面部绑定子模型，对最优面部绑定参数进行面部形变预测，得到第一面部形变数据对应的重建面部形变数据，进而根据第一面部形变数据和重建面部形变数据，对第二面部绑定子模型进行训练。上述技术方案，相比于现有面部绑定人力和时间成本过高的问题，本公开中通过第一面部绑定子模型确定重建面部形变数据，并结合第一面部形变数据和重建面部形变数据来训练第二面部绑定子模型，提高了面部绑定的效率，同时实现了面部绑定的全自动化，并且具备良好的可拓展性。进一步地，该装置还包括第一模型训练模块，第一模型训练模块包括：全局形状特征确定单元，用于对样本面部形变数据进行特征提取，得到样本面部形变数据的全局形状特征；预测绑定参数确定单元，用于对全局形状特征进行降维预测，得到样本面部形变数据对应的预测面部绑定参数；第一模型训练单元，用于根据预测面部绑定参数和样本面部形变数据对应的样本面部绑定参数，对第一面部绑定子模型进行训练。进一步地，全局形状特征确定单元，包括：顶点特征确定子单元，用于对样本面部形变数据中顶点进行特征提取，得到顶点的顶点特征；全局形状特征确定子单元，用于对顶点特征进行特征转换，得到样本面部形变数据的全局形状特征。进一步地，全局形状特征确定子单元具体用于：按照特征顺序，对顶点特征进行转换，得到序列特征；对序列特征进行处理，得到样本面部形变数据的全局形状特征。进一步地，最优绑定参数确定模块601，包括：预测形变数据确定单元，用于采用第一面部绑定子模型，对初始面部绑定参数进行面部形变预测，得到预测面部形变数据；最优绑定参数确定单元，用于根据预测面部形变数据和第一面部形变数据，确定最优面部绑定参数。进一步地，最优绑定参数确定单元具体用于：根据预测面部形变数据和第一面部形变数据，逐点构建参数优化损失；对参数优化损失进行优化，得到最优面部绑定参数。进一步地，第二模型训练模块603，包括：重建形变数据处理单元，用于对重建面部形变数据进行噪声处理，得到第二重建面部形变数据；第二模型训练单元，用于根据第一面部形变数据和第二重建面部形变数据，对第二面部绑定子模型进行训练。进一步地，重建形变数据处理单元具体用于：对重建面部形变数据添加噪声，得到第一重建面部形变数据；对第一重建面部形变数据进行反向去噪处理，得到第二重建面部形变数据。图7是根据本公开实施例提供的一种面部绑定装置的结构示意图。本实施例适用于虚拟数字人场景中如何进行面部绑定的情况。该装置可以采用软件和/或硬件的方式实现，并可集成于承载面部绑定功能的电子设备中，比如服务器中。如图7所示，本实施例的面部绑定装置700可以包括：目标绑定参数获取模块701，用于获取目标对象的目标面部绑定参数；目标形变数据确定模块702，用于采用面部绑定模型，对目标面部绑定参数进行面部形变预测，得到目标对象的目标面部形变数据；其中，面部绑定模型基于上述任意实施例所提供的面部绑定模型的训练方法训练得到。本公开实施例提供的技术方案，通过获取目标对象的目标面部绑定参数，之后采用面部绑定模型，对目标面部绑定参数进行面部形变预测，得到目标对象的目标面部形变数据。上述技术方案，相比于现有技术中绑定过程繁琐且成本高耗时久，本公开中通过面部绑定模型可以实现全自动的面部绑定，并且可以实现自动精准的面部绑定迁移。根据本公开的实施例，本公开还提供了一种电子设备、一种可读存储介质和一种计算机程序产品。图8是用来实现本公开实施例的面部绑定模型的训练方法或面部绑定方法的电子设备的框图。图8示出了可以用来实施本公开的实施例的示例电子设备800的示意性框图。电子设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本公开的实现。如图8所示，电子设备800包括计算单元801，其可以根据存储在只读存储器802中的计算机程序或者从存储单元808加载到随机访问存储器803中的计算机程序，来执行各种适当的动作和处理。在RAM 803中，还可存储电子设备800操作所需的各种程序和数据。计算单元801、ROM 802以及RAM 803通过总线804彼此相连。输入/输出接口805也连接至总线804。电子设备800中的多个部件连接至I/O接口805，包括：输入单元806，例如键盘、鼠标等；输出单元807，例如各种类型的显示器、扬声器等；存储单元808，例如磁盘、光盘等；以及通信单元809，例如网卡、调制解调器、无线通信收发机等。通信单元809允许电子设备800通过诸如因特网的计算机网络和/或各种电信网络与其他设备交换信息/数据。计算单元801可以是各种具有处理和计算能力的通用和/或专用处理组件。计算单元801的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的计算单元、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。计算单元801执行上文所描述的各个方法和处理，例如面部绑定模型的训练方法或面部绑定方法。例如，在一些实施例中，面部绑定模型的训练方法或面部绑定方法可被实现为计算机软件程序，其被有形地包含于机器可读介质，例如存储单元808。在一些实施例中，计算机程序的部分或者全部可以经由ROM 802和/或通信单元809而被载入和/或安装到电子设备800上。当计算机程序加载到RAM 803并由计算单元801执行时，可以执行上文描述的面部绑定模型的训练方法或面部绑定方法的一个或多个步骤。备选地，在其他实施例中，计算单元801可以通过其他任何适当的方式而被配置为执行面部绑定模型的训练方法或面部绑定方法。本文中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、现场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、复杂可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本公开的方法的程序代码可以采用一个或多个编程语言的任何组合来编写。这些程序代码可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器或控制器，使得程序代码当由处理器或控制器执行时使流程图和/或框图中所规定的功能/操作被实施。程序代码可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本公开的上下文中，机器可读介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的程序。机器可读介质可以是机器可读信号介质或机器可读储存介质。机器可读介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在计算机上实施此处描述的系统和技术，该计算机具有：用于向用户显示信息的显示装置或者LCD监视器）；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给计算机。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网和互联网。计算机系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，也可以为分布式系统的服务器，或者是结合了区块链的服务器。人工智能是研究使计算机来模拟人的某些思维过程和智能行为的学科，既有硬件层面的技术也有软件层面的技术。人工智能硬件技术一般包括如传感器、专用人工智能芯片、云计算、分布式存储、大数据处理等技术；人工智能软件技术主要包括计算机视觉技术、语音识别技术、自然语言处理技术及机器学习/深度学习技术、大数据处理技术、知识图谱技术等几大方向。云计算，指的是通过网络接入弹性可扩展的共享物理或虚拟资源池，资源可以包括服务器、操作系统、网络、软件、应用和存储设备等，并可以按需、自服务的方式对资源进行部署和管理的技术体系。通过云计算技术，可以为人工智能、区块链等技术应用、模型训练提供高效强大的数据处理能力。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发公开中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本公开公开的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本公开保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本公开的精神和原则之内所作的修改、等同替换和改进等，均应包含在本公开保护范围之内。
