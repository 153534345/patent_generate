标题title
一种融合主成分分析与体素积分的滑坡体积量计算方法
摘要abst
本发明公开了一种融合主成分分析与体素积分的滑坡体积量计算方法，包括步骤：两期点云数据采集并配准；在滑坡区域内建立栅格；利用主成分分析法计算各栅格内点的法向量和拟合平面函数；通过平面函数积分计算各栅格的体积变化量；计算所有栅格体积变化量，通过统计分析识别异常值，并对异常值进行改正。本发明利用激光雷达测距技术，利用获取的点云，通过构建体素单元，融合主成分分析方法，利用体素二重积分计算体素内体积变化，实现了滑坡体积量高效精准的计算，克服了采用平均高程计算体积结果不可靠的问题。
权利要求书clms
1.一种融合主成分分析与体素积分的滑坡体积量计算方法，其特征在于：包括以下步骤：采用激光扫描系统对同一滑坡塌陷区进行两期扫描，获取滑坡表面点云数据，在滑坡外围设置个标靶，其中，，激光扫描系统的观测值为滑坡表面点的三维坐标；利用步骤设置的标靶，采用三维坐标转换方程计算两期点云坐标转换参数Z，对点云进行配准；利用步骤中得到的配准后数据，对两期点云进行格网化，计算各个栅格角点的平面坐标；利用步骤得到的栅格角点坐标， 搜索两期点云在各个栅格内的点，过滤点数少的栅格；利用主成分分析法计算两期点云在各个栅格内点的法向量和拟合平面函数；通过步骤中得出的各个栅格内两期点云的拟合平面函数，采用二重积分计算各个栅格内的体积变化量；过程为：假设栅格内两期点云的拟合平面函数为 、 ，栅格区域为D，则体积变化量V的计算方法如下:;根据步骤得到的所有栅格的体积变化量，利用各个栅格体积变化量的均值和标准差，根据统计分析对异常栅格进行识别；对步骤识别到的异常栅格进行改正，重新计算异常栅格内的体积变化量，从而获取整个滑坡的体积变化量。2.根据权利要求1所述的融合主成分分析与体素积分的滑坡体积量计算方法，其特征在于：步骤中，两期扫描过程中，标靶固定。3.根据权利要求1所述的融合主成分分析与体素积分的滑坡体积量计算方法，其特征在于：步骤中所述三维坐标转换方程如下：设矩阵A为A坐标系下的点云三维坐标，矩阵B为B坐标系下的点云三维坐标，A、B两坐标系的三维坐标转换方程如下所示：;其中，表示坐标原点的向平移量,表示坐标原点的向平移量,表示坐标原点的向平移量，为尺度因子，,R为A坐标系到B坐标系的旋转矩阵。4.根据权利要求1所述的融合主成分分析与体素积分的滑坡体积量计算方法，其特征在于：步骤中计算栅格角点的平面坐标的方法如下：假设滑坡区域坐标的最大值为，坐标的最小值为 ，坐标的最大值为，坐标的最小值为，格网边长大小为，栅格行数，列数计算方法如下所示：；；令，，根据，计算各个栅格的平面坐标边界，计算过程如下所示：；；；。5.根据权利要求1所述的融合主成分分析与体素积分的滑坡体积量计算方法，其特征在于：步骤中，利用主成分分析法计算两期点云在各个栅格内点的法向量和拟合平面函数的方法如下：设栅格内的点的三维坐标，构造相应的协方差矩阵：；其中，，为点集的重心坐标，对矩阵进行主成分分析，求得三个特征值并按降序排列，得到，所对应的特征向量，且为法向量；拟合平面函数的计算过程如下：；其中，。6.根据权利要求1所述的融合主成分分析与体素积分的滑坡体积量计算方法，其特征在于：步骤中所有栅格的体积变化量计算数学期望和标准差的方法为：设所有栅格的体积变化量，则根据统计分析中的数学期望和标准差的计算方法如下：；。7.根据权利要求1所述的融合主成分分析与体素积分的滑坡体积量计算方法，其特征在于：步骤中，所述异常栅格改正的过程如下：对任一异常栅格，通过主成分分析法计算异常栅格及附近搜索到的正常栅格上拟合平面的法向量，若，则令；获得附近正常栅格的法向量平均值，则所述平均值在水平面投影为，认为为异常山体的凸出方向；获得异常栅格的法向量在水平面的投影，按照下式计算的夹角，若，则认为所述异常山体为外凸山体，否则为内凹山体；；对点云密度不均匀问题，按照下式计算异常栅格上各点到拟合平面的离差，计算所有点离差的期望和标准差，建立95%的置信区间，认为离差在区间外的点为平面点，其余为斜面点，获得斜面点坐标的的最大值，的最小值，的最大值，的最小值；以 、、 、 做角点建立斜面区域，栅格剩余区域为；；式中，为拟合平面系数，为点的坐标值；由步骤中计算出来的来判断山体的凹凸性，对不同凹凸性的山体，按以下方法计算体积：对于外凸山体，通过下式求得体积：；对于内凹山体，通过下式求得体积：；式中，是指倾斜点的拟合平面中、相对的函数，为栅格内所有点的高度平均值，为区域的面积，为区域的面积，为倾斜点的最大值，为所有倾斜点减去倾斜点中最低点高度后得到的点所拟合平面中、相对的函数。
说明书desc
技术领域本发明涉及大地测量学和摄影测量与遥感领域中，基于激光雷达点云的滑坡体积量计算方法，尤其涉及一种融合主成分分析与体素积分的滑坡体积量计算方法。背景技术山体滑坡是最常见的地质灾害之一，具有危害大、分布广的特点，严重时将威胁人民的生命和财产安全。对山体滑坡的监测一方面可以预测泥石流的发生；另一方面，对山体滑坡量的精确计算也可以预测泥石流的爆发范围，进而减少相关损失。因此，开展快速、高效、精确、低成本的山体滑坡的识别与计算具有重要的应用价值。传统探测滑坡变形的方法主要是基于大地测量技术的“点”式测量，利用水准仪、全站仪等仪器测量变形监测点的变形信息，进而对滑坡的变形进行预测和预报。这种方法虽然测量的监测点精度高，但点的密度低，无法获取滑坡表面整体信息，并且作业效率低，受地形、气象等条件约束大。近年来随着摄影测量技术的发展，这种无接触、“面”式采集数据的测量方法也被应用于滑坡变形监测中。利用摄影测量技术采集滑坡数据，通过摄影测量专业软件的数据处理技术获取滑坡的三维模型。这种测量方法可以获得面状测量信息，测量效率高，但测量精度不如传统大地测量方法。近年来高速发展的激光雷达技术为滑坡的监测提供了新的思路，激光雷达技术通过向目标发射激光束，然后将接收到的信号与发射信号进行比较，获取目标的距离、方位、高度等几何参数，从而实现目标表面高分辨率三维信息的获取。该技术突破了传统的单点测量模式，具有高效、高分辨率、高精度、自动化程度高、非接触的优势，但是如何提供一种能够精确计算滑坡体积量的方法是值得探讨的技术问题。发明内容发明目的：针对现有技术的不足之处，本发明提出一种融合主成分分析与体素积分的滑坡体积量计算方法，通过构建体素单元，融合主成分分析方法，利用体素二重积分计算体素内体积变化，实现了滑坡体积量高效精准的计算，克服了采用平均高程计算体积结果不可靠的问题。技术方案：本发明融合主成分分析与体素积分的滑坡体积量计算方法包括以下步骤：采用激光扫描系统对同一滑坡塌陷区进行两期扫描，获取滑坡表面点云数据，在滑坡外围设置个标靶，其中，，激光扫描系统的观测值为滑坡表面点的三维坐标；利用步骤设置的标靶，采用三维坐标转换方程计算两期点云坐标转换参数Z，对点云进行配准；利用步骤中得到的配准后的数据，对两期点云进行格网化，计算各个栅格角点的平面坐标；利用步骤得到的栅格角点的平面坐标，搜索两期点云在各个栅格内的点，过滤点数少的栅格；利用主成分分析法计算两期点云在各个栅格内点的法向量和拟合平面函数；通过步骤中得出的各个栅格内两期点云的拟合平面函数，采用二重积分计算各栅格内的体积变化量，过程为：假设栅格内两期点云的拟合平面函数为、，栅格区域为D,则体积变化量V的计算方法如下：;根据步骤得到的所有栅格内的体积变化量，利用各栅格体积变化量的均值和标准差，根据统计分析对异常栅格进行识别；对步骤识别得到的异常栅格进行改正，重新计算异常栅格内的体积变化量，从而获取整个滑坡的体积变化量。其中，步骤中两期扫描过程中，标靶固定不动。步骤中的三维坐标转换方程如下：设矩阵A为A坐标系下的点云三维坐标，矩阵B为B坐标系下的点云三维坐标，A、B两坐标系的三维坐标转换方程如下所示：;其中，表示坐标原点的x向平移量，表示坐标原点的y向平移量，表示坐标原点的z向平移量，为尺度因子，，R为A坐标系到B坐标系的旋转矩阵。步骤中计算栅格角点的平面坐标的方法如下：假设滑坡区域X坐标的最大值为，X坐标的最小值为，Y坐标的最大值为，Y坐标的最小值为，格网边长大小为d,栅格行列数m、n计算方法如下所示：；；令，，根据m、n大小计算各个栅格的平面坐标边界，计算过程如下所示：；；；。步骤中，利用主成分分析法计算两期点云在各栅格内的点的法向量和拟合平面函数的方法如下：设栅格内的点X的三维坐标，构造相应的协方差矩阵：；其中，，为点集的重心坐标，对矩阵C进行主成分分析，求得三个特征值并按降序排列，得到，所对应的特征向量，且为法向量。拟合平面函数的计算过程如下：；其中，。步骤中所有栅格的体积变化量计算均值和标准差的具体方法为：设所有栅格的体积变化量，则数学期望和标准差的计算方法如下；。步骤中的异常栅格改正的具体过程如下：对任一异常栅格，通过主成分分析法分别计算异常栅格及附近搜索到的正常栅格上拟合平面的法向量，若，则令；获得附近正常栅格的法向量平均值，则该平均值在水平面投影为，认为为异常山体的凸出方向；获得异常栅格的法向量在水平面的投影，按照下式计算的夹角，若，则认为该异常山体是外凸山体，否则为内凹山体：；对点云密度不均匀问题，按照下式计算异常栅格上各点到拟合平面的离差d,计算所有点离差的期望和标准差，建立95%的置信区间，认为离差在区间外的点为平面点，其余为斜面点，获得斜面点坐标的x的最大值，x的最小值，y的最大值，y的最小值；以、、 、  做角点建立斜面区域，栅格剩余区域为：；式中，A、B、C、D为拟合平面系数，为点的坐标值； 由中计算出来的来判断山体的凹凸性，对不同凹凸性的山体，分别按以下方法计算体积：相较于传统DEM比较法，本发明利用二重积分计算体素内体积变化，克服了采用平均高程计算体积结果不可靠的问题；在精度保证的前提下， 本发明确保了体素内局部平面的有效提取；本方法提出了异常栅格的解决方案，对进一步提高本发明方法的适用性提供了基础。附图说明图1为本发明融合主成分分析与体素积分的滑坡体积量计算方法的流程图；图2 为本发明的测站坐标系示意图；图3为第一期数据栅格投影图；图4为第二期数据栅格投影图；图5为本发明的栅格内法向量和拟合平面示意图；图6为本发明改正前栅格体积变化量直方图；图7为本发明改正前栅格体积变化量小于1立方米的直方图；图8为本发明改正前栅格体积变化量大于1.5立方米的直方图；图9为本发明改正后栅格体积变化量直方图。具体实施方式如图1所示，本发明融合主成分分析与体素积分的滑坡体积量计算方法包括以下步骤：采用激光扫描系统对同一滑坡塌陷区进行两期扫描，获取滑坡表面点云数据，在滑坡外围设置个标靶，其中，，激光扫描仪系统的观测值为滑坡表面点的三维坐标；利用步骤设置的标靶，采用三维坐标转换方程计算两期点云坐标转换参数Z，对点云进行配准；利用步骤中得到的配准后数据，对两期点云进行格网化，计算各个栅格角点的平面坐标；利用步骤得到的栅格角点坐标， 搜索两期点云在各个栅格内的点，过滤点数少的栅格；利用主成分分析法计算两期点云在各个栅格内点的法向量和拟合平面函数；通过步骤得出的各个栅格内两期点云的拟合平面函数采用二重积分计算各栅格内的体积变化量，过程为：假设栅格内两期点云的拟合平面函数为、，栅格区域为D，则体积变化量V的计算方法如下：；根据步骤得到的所有栅格内的体积变化量，利用各栅格体积变化量的均值和标准差，根据统计分析对异常栅格进行识别；对步骤识别得到的异常栅格进行改正，重新计算异常栅格内的体积变化量，从而获取整个滑坡的体积变化量。以“某居民区施工现场滑坡变化检测”为例，对本发明作进一步阐述：利用FARO FocusS Plus350扫描仪对该滑坡塌陷区进行扫描，在实验区以外稳定区域布设4个标靶，两期扫描间隔时间为5天；获取两期山体滑坡表面激光点云数据，观测值为三维坐标。如图2所示，以测站为中心，竖直方向为Z轴，利用步骤设置的标靶，计算两期点云坐标转换参数Z，将第2期点云坐标配准至第1期点云测站坐标系中完成配准。如图3和图4所示，利用步骤中得到的配准数据，对两期配准后的点云进行格网化，滑坡体区域点X、Y坐标的最大值和最小值分别为,格网边长大小为0.5m ，计算各个栅格角点的平面坐标。如图5所示，利用步骤得到的栅格角点坐标， 搜索两期点云在各栅格内的点，设置点数阈值，过滤点数过少的栅格。利用主成分分析法分别计算两期点云在各栅格内点的法向量和拟合平面函数。通过步骤已得各栅格内两期点云的拟合平面函数进行二重积分计算各栅格内的体积变化量，结果如图6至图8所示。根据步骤得到的所有栅格内的体积变化量，计算栅格体积变化量的数学期望和标准差，根据概率统计，为95%的置信区间，提取出体积变化量在置信区间外的栅格。认为步骤得到的栅格为异常栅格，异常栅格内的点为异常点，根据这些点进行异常栅格改正，重新计算异常栅格内的体积变化量，改正后的栅格体积变化量直方图如图9，最终得到全部的滑坡体积量为。
