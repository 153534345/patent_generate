标题title
一种基于风格自组的遥感图像生成方法、存储介质及设备
摘要abst
本发明涉及遥感图像生成领域，公开了一种基于风格自组的遥感图像生成方法、存储介质及设备。包括创建初始掩膜数据。获取预设的控制参数。将所述初始掩膜数据及所述控制参数输入遥感样本生成器，生成目标遥感图像。本发明在创建初始掩膜数据时，可以对多个配置参数进行适应性设计，进而快速创建出多种场景对应的初始掩膜数据。以生成对应的目标遥感图像。由此可以对应的生成大量不同的场景的遥感图像样本。以适应于不同的深度学习网络模型的训练。同时，由于遥感图像样本的生成无需耗费人力标注成本，使得生成的遥感图像样本的成本更低。另外，由于目标迭代次数可以控制遥感样本生成器，能够更加快速的生成对应的目标遥感图像。
权利要求书clms
1.一种基于风格自组的遥感图像生成方法，其特征在于，所述方法包括如下步骤：创建初始掩膜数据；所述初始掩膜数据包括背景掩膜及至少一个目标物掩膜；其中，每一所述目标物掩膜均具有若干配置参数，不同的目标物掩膜之间的配置参数存在差异；所述配置参数包括目标物掩膜类别、数量及在所述背景掩膜中的设置位置；每一所述目标物掩膜均包括对应目标物的轮廓信息；获取预设的控制参数；所述控制参数包括目标图像尺寸及目标迭代次数A；A∈；将所述初始掩膜数据及所述控制参数输入遥感样本生成器，生成目标遥感图像；所述目标遥感图像中包括与所述目标物掩膜对应类型的物体图像及与所述背景掩膜对应的场景背景图像；所述目标遥感图像的尺寸为所述目标图像尺寸，所述遥感样本生成器在生成所述目标遥感图像的过程中的计算迭代次数为所述目标迭代次数；所述目标遥感图像具有由每一目标物掩膜类别生成的对应的物体图像的标签。2.根据权利要求1所述的方法，其特征在于，所述方法还包括：从ISAID数据集中获取初始样本生成器的初始训练样本集；将所述初始训练样本集中的每一样本进行裁切处理，生成第一初始训练样本集；所述第一初始训练样本集中包括多个裁切样本；每一所述裁切样本的尺寸均为预设尺寸；随机对所述第一初始训练样本集中的多个所述裁切样本进行翻转处理，生成第一目标训练样本集。3.根据权利要求2所述的方法，其特征在于，所述预设尺寸为512dpi*512dpi；在生成第一目标训练样本集之后，所述方法还包括：将所述第一目标训练样本集中的每一样本的尺寸缩小至256dpi*256dpi，生成第二目标训练样本集。4.根据权利要求3所述的方法，其特征在于，在生成第二目标训练样本集之后，所述方法还包括：对所述第二目标训练样本集中的每一样本进行噪声添加处理，生成第三目标训练样本集；所述噪声添加处理包括：在样本的背景图像区域中生成背景噪声；所述背景噪声为服从一个μ＝10，σ2＝2的高斯分布的噪声；其中，μ为所述高斯分布的平均值；σ2为所述高斯分布的方差。5.根据权利要求4所述的方法，其特征在于，所述方法还包括：使用第一目标训练样本集或第二目标训练样本集或第三目标训练样本集对初始样本生成器进行训练，生成所述初始样本生成器对应的多组模型参数；其中，每完成1万次训练之后获取一组初始样本生成器对应的模型参数；从的训练次数区间中获取多组所述模型参数进行均值计算处理，生成目标模型参数；优选的，对完成97万次、98万次、99万次、100万次及101万次训练后分别得到的所述模型参数进行均值计算处理，生成目标模型参数；将所述目标模型参数配置到所述初始样本生成器中，生成所述遥感样本生成器。6.根据权利要求5所述的方法，其特征在于，在使用第一目标训练样本集或第二目标训练样本集或第三目标训练样本集对初始样本生成器进行训练之前，所述方法还包括：对第一初始样本生成器进行模型优化处理，生成初始样本生成器；所述模型优化处理用于调整所述第一初始样本生成器的结构，以提高生成的初始样本生成器的预测精度。7.根据权利要求6所述的方法，其特征在于，所述第一初始样本生成器包括DDPM扩散模型；所述模型优化处理包括：为所述DDPM扩散模型配置鉴别器，生成初始样本生成器；所述初始样本生成器为生成式对抗网络；所述鉴别器为由resnet网络构建的鉴别器；其中，所述DDPM扩散模型的损失值Gloss符合如下条件：Gloss＝MSE)*+λ*C)；所述鉴别器的损失值Dloss符合如下条件：Dloss＝C)+C)；其中，C为二元交叉熵函数，MSE为均值平方差函数；nosie为随机高斯噪声；f为DDPM扩散模型拟合的高斯噪声；fake为DDPM扩散模型生成的图像矩阵；D为fake经鉴别器进行特征提取后一个特征矩阵，特征矩阵的尺寸为512*1；true为训练样本中的真实图像；D为ture经鉴别器进行特征提取后一个特征矩阵，特征矩阵的尺寸为512*1；outzeros为与D相同尺寸的全0矩阵，outones为与D相同尺寸的全1矩阵；λ为影响系数，λ∈。8.根据权利要求6所述的方法，其特征在于，所述第一初始样本生成器包括DDPM扩散模型；所述模型优化处理包括：将DDPM扩散模型中的Unet网络替换为3个并行设置的Unet网络，生成初始样本生成器；其中，第一个Unet网络用于对初始样本生成器在去噪迭代次数属于中的噪声数据进行处理；第二个Unet网络用于对初始样本生成器对去噪迭代次数属于。优选的，目标图像尺寸在256dpi到512dpi之间。S300:将初始掩膜数据及控制参数输入遥感样本生成器，生成目标遥感图像。目标遥感图像中包括与目标物掩膜对应类型的物体图像及与背景掩膜对应的场景背景图像。目标遥感图像的尺寸为目标图像尺寸，遥感样本生成器在生成目标遥感图像的过程中的计算迭代次数为目标迭代次数。目标遥感图像具有由每一目标物掩膜类别生成的对应的物体图像的标签。优选的，遥感样本生成器可以为DDPM扩散模型经过训练后生成的目标DDPM扩散模型。具体的，目标遥感图像为带有标签的样本图像。其中每一目标物均会对应一个标签，该标签可以为对应的目标物的类别信息。由于生成的目标遥感图像中已具有了对应的标签，所以其可以被当作深度学习网络的训练样本使用。本发明中在创建初始掩膜数据时，可以根据需求对目标物掩膜的多个配置参数进行适应性设计，进而可以根据需求快速创建出多种场景对应的初始掩膜数据。然后，将初始掩膜数据及控制参数，输入遥感样本生成器中以生成对应的目标遥感图像。该目标遥感图像即为根据初始掩膜数据生成的对应的遥感样本数据。其中，目标遥感图像中的每一个物体图像都有根据对应的目标物掩膜类别生成的标签。由于，可以通过自主组合可以快速大量的生成多种不同的初始掩膜数据，所以也可以对应的生成大量不同的场景的遥感图像样本。以适应于不同方向的深度学习网络模型的训练。同时，由于遥感图像样本的生成过程无需耗费大量的人力标注成本，由此使得该方法生成的遥感图像样本的成本更低。另外，由于目标迭代次数A∈，可以控制遥感样本生成器，在能够获得较高的图像质量的情况下，更加快速的生成对应的目标遥感图像，通常可以将生成时间控制在2秒内。作为本发明的另一种实施例，本方法还包括：S400:从ISAID数据集中获取初始样本生成器的初始训练样本集。具体的，ISAID数据集为一个现有的数据集，其具有2806张图像，共包含15个类别共655451个目标物体，是遥感领域第一个大型实例分割数据集。在选取初始训练样本时，需要根据对应的任务可能涉及到的场景以及对遥感样本生成器学习的帮助大小来确定。本实施例中，选取的初始训练样本集涉及小车、大车、篮球场、轮船、飞机、田径场、桥梁、储物罐八种目标类型，共1411张遥感图像作为初始训练数据。具体的，将ISAID数据集中的遥感图像及该图像对应的掩膜数据作为一对训练数据；其中，遥感图像为实际的训练图像，对应的掩膜数据作为训练的标签。并以此对初始样本生成器进行有监督训练，以生成遥感样本生成器。该图像对应的掩膜数据的样式与初始掩膜数据的样式相同。也即，具有同一颜色的背景掩膜。S500:将初始训练样本集中的每一样本进行裁切处理，生成第一初始训练样本集。第一初始训练样本集中包括多个裁切样本。每一裁切样本的尺寸均为预设尺寸。具体的，在进行裁切处理时，预设尺寸的大小可以为128dpi*128dpi到512dpi*512dpi区间内的任意尺寸规格。S600:随机对第一初始训练样本集中的多个裁切样本进行翻转处理，生成第一目标训练样本集。具体的，经过裁切处理以及翻转处理后，第一目标训练样本集中包括了57对图片清晰且目标物掩膜较小的训练图像。由此可以训练遥感样本生成器对目标物掩膜较小的初始掩膜数据的预测能力。在保证运动场等大型目标完整性和小车等小目标分辨率的前提下，还包含453张相同规格的RS图像和453张对应的掩膜数据。上述453对图像数据中涉及小车、大车、篮球场、轮船、飞机、田径场、桥梁、储物罐八种目标类型。该图像数据中掩膜信息各不相同，且对应的目标场景更加多元化，其中包含的标签的类别也更加丰富。由此，可以提高遥感样本生成器对多元化场景以及标签的学习。另外，在第一目标训练样本集中还包括多张具有残缺目标物掩膜的样本数据。如样本图像中均包括田径场或篮球场的部分区域。由此，有利于提高遥感样本生成器针对残缺目标物掩膜的边缘的计算能力。同时，还包含了46张纯背景图像来评估模型的场景恢复能力。本实施例中，通过裁切和随机翻转可以增加初始训练数据的数量，同时也增加了初始训练数据的多样性，由此可以提高初始样本生成器的学习能力，进而可以提高最终训练生成的遥感样本生成器的预测能力。作为本发明的另一种实施例，预设尺寸为512dpi*512dpi。在生成第一目标训练样本集之后，方法还包括：S610:将第一目标训练样本集中的每一样本的尺寸缩小至256dpi*256dpi，生成第二目标训练样本集。因为遥感图像尺寸较大，所以当裁剪出的图像的大小为128dpi*128dpi时，其往往存在裁不到目标物或是只截取到目标物的一小部分图像的问题。由此会造成初始样本生成器学习不完整、不规律，无法使得得到的遥感样本生成器具有较高的预测精度。同时，得到的遥感样本生成器对于分辨率低的图像生成的预测图像的效果很差，而且在对于输入图像的目标区域较为模糊时，往往生成的目标物的类别都不稳定。如将小车对应的目标物掩膜误判为大车的标签类别。本实施例为了解决上述新出现的问题，将预设尺寸设置为512dpi*512dpi。由于裁切范围更大，进而可以尽量避免裁不到目标物或是只截取到目标物的一小部分图像的问题。然后，再整体将512dpi*512dpi的图像缩小至256dpi*256dpi的图像。由此，既保证了裁切处的图像中可以尽可能的包含目标物或目标物的大部分区域，同时还降低了图像的尺寸，以保证CPU可以有足够的计算资源来进行处理。进而可以提高初始样本生成器学习能力，终而使得得到的遥感样本生成器具有较高的预测精度。作为本发明的另一种实施例，在S610:生成第二目标训练样本集之后，本方法还包括：S620:对第二目标训练样本集中的每一样本进行噪声添加处理，生成第三目标训练样本集。噪声添加处理包括：S621:在样本的背景图像区域中生成背景噪声。背景噪声为服从一个μ＝10，σ2＝2的高斯分布的噪声。其中，μ为高斯分布的平均值。σ2为高斯分布的方差。在经过上述实施例中的训练数据训练后，由最终得到的遥感样本生成器生成的目标遥感图像存在背景色的渲染效果较低，且生成的图像场景较为单一的问题。由于，现有的训练样本中的背景掩码的颜色同样为单一颜色。也即背景掩码对应的数据矩阵的值全部相同，所以在进行训练时初始样本生成器无法对背景掩码进行差异化的处理，进而使得生成的目标遥感图像存在背景色的渲染效果较低，且生成的图像场景较为单一的问题。本实施例中的通过在第二目标训练样本集中的每一样本背景图像区域中生成背景噪声，来对不同的背景设置不同的噪声值。由此可以扩大样本背景图像中每一像素之间的差异，进而可以提高初始样本生成器在训练过程中对背景图像的生成能力。对应的，使得最终得到的遥感样本生成器生成的目标遥感图像，具有更加细致丰富的细节图像，由此也提高了背景色的渲染效果，使得生成的图像的场景细节更为丰富，更加真实。作为本发明的另一种实施例，本方法还包括：S630:使用第一目标训练样本集或第二目标训练样本集或第三目标训练样本集对初始样本生成器进行训练，生成初始样本生成器对应的多组模型参数。其中，每完成1万次训练之后获取一组初始样本生成器对应的模型参数。S640:从的训练次数区间中获取多组模型参数进行均值计算处理，生成目标模型参数。优选的，对完成97万次、98万次、99万次、100万次及101万次训练后分别得到的模型参数进行均值计算处理，生成目标模型参数。S650:将目标模型参数配置到初始样本生成器中，生成遥感样本生成器。具体的，在训练过程中，若训练次数太多，容易使得最终得到的模型存在过拟合的问题；而训练次数太少，还容易使得最终得到的模型存在欠拟合的问题。所以本实施例中，会在模型训练效果较佳的区间中，选择多组模型参数进行均值计算处理，由此使得生成的目标模型参数可以尽量避免单组模型参数存在的误差，最终使得生成的遥感样本生成器具有更好的预测精度。作为本发明的另一种实施例，在S630:使用第一目标训练样本集或第二目标训练样本集或第三目标训练样本集对初始样本生成器进行训练之前，本方法还包括：S700:对第一初始样本生成器进行模型优化处理，生成初始样本生成器。模型优化处理用于调整第一初始样本生成器的结构，以提高生成的初始样本生成器的预测精度。本实施例，对现有的DDPM扩散模型进行优化改进，来使得生成的初始样本生成器可以具有更高的预测精度。作为本发明的另一种实施例，第一初始样本生成器包括DDPM扩散模型。模型优化处理包括：S710:为DDPM扩散模型配置鉴别器，生成初始样本生成器。初始样本生成器为生成式对抗网络。鉴别器为由resnet网络构建的鉴别器。本实施例通过为DDPM扩散模型配置鉴别器，来将初始样本生成器构造为生成式对抗网络。生成式对抗网络是一种深度学习模型，是近年来复杂分布上无监督学习最具前景的方法之一。模型通过框架中至少存在两个模块：生成模型，也即DDPM扩散模型；以及判别模型，也即鉴别器。并通过生成模型和判别模型的互相博弈学习，来产生相当好的输出。其中，DDPM扩散模型的损失值Gloss符合如下条件：Gloss＝MSE)*+λ*C)。鉴别器的损失值Dloss符合如下条件：Dloss＝C)+C)。其中，C为二元交叉熵函数，MSE为均值平方差函数。C与MSE均为现有的损失函数。nosie为随机高斯噪声。f为DDPM扩散模型拟合的高斯噪声。fake为DDPM扩散模型生成的图像矩阵。D为fake经鉴别器进行特征提取后一个特征矩阵，特征矩阵的尺寸为512*1。true为训练样本中的真实图像。D为ture经鉴别器进行特征提取后一个特征矩阵，特征矩阵的尺寸为512*1。outzeros为与D相同尺寸的全0矩阵，outones为与D相同尺寸的全1矩阵。λ为影响系数，λ∈。优选的，λ＝0.2。本实施例通过引入GAN的架构思想，可以通过鉴别器来自动检测DDPM扩散模型生成的图像是否真实，若鉴别器认为是真实的，则对DDPM扩散模型进行奖励；若鉴别器认为是虚假的，则对DDPM扩散模型进行惩罚。在Gloss加入λ*C)这一项，可以对最终的损失值进行适应性的调节。具体为，当鉴别器认为DDPM扩散模型生成的图像更加接近真实值时，λ*C)的值较小，则使得Gloss对应的损失函数值也较小；而当鉴别器认为DDPM扩散模型生成的图像与真实值相差较大时，λ*C)的值较大，则使得Gloss对应的损失函数值也较大。由此，通过在Gloss加入λ*C)这一项，可以对最终的损失值进行适应性的调节。进而可以使得经过训练最终生成的遥感样本生成器，也即训练完成的DDPM扩散模型，可以生成与真实图像更加接近且更加真实的目标遥感图像。作为本发明的另一种实施例，第一初始样本生成器包括DDPM扩散模型。模型优化处理包括：S720:将DDPM扩散模型中的Unet网络替换为3个并行设置的Unet网络，生成初始样本生成器。其中，第一个Unet网络用于对初始样本生成器在去噪迭代次数属于中的噪声数据进行处理。第二个Unet网络用于对初始样本生成器对去噪迭代次数属于(n/3，2n/3]中的噪声数据进行处理。第三个Unet网络用于对初始样本生成器在去噪迭代次数属于(2n/3，n]中的噪声数据进行处理。n为初始样本生成器在每次对训练样本进行处理时对应的去噪迭代总次数。以n＝300为例进行如下说明：第一个Unet网络用于对初始样本生成器在去噪迭代次数属于中的噪声数据进行处理。第二个Unet网络用于对初始样本生成器对去噪迭代次数属于(100，200]中的噪声数据进行处理。第三个Unet网络用于对初始样本生成器在去噪迭代次数属于(200，300]中的噪声数据进行处理。本实施例中的模型在实际的目标遥感图像的生成过程中，具体的处理过程如下：将初始样本输入第一个Unet网络进行迭代进行去噪迭代处理，当初始样本完成第100次迭代后，此时将输出的迭代后的初始样本作为第一初始样本，然后再将第一初始样本输入第二个Unet网络进行迭代。当初始样本完成第200次迭代后，此时将输出的迭代后的初始样本作为第二初始样本，然后再将第二初始样本输入第三个Unet网络进行迭代。当初始样本完成第300次迭代后，此时将输出的迭代后的初始样本作为第三初始样本，也即最终生成的目标遥感图像。本实施例中，将现有的DDPM扩散模型中的主干网络Unet网络由一个增加至三个；且每一个Unet网络分别来负责DDPM扩散模型在迭代去噪的前中后3个阶段的噪声处理工作。由此可以把推理过程分为初始、中间和收尾3个阶段，并且由3个Unet网络分别处理推理过程的不同阶段。由于不同阶段的噪声、去噪比例和去噪程度都有所区别，所以通过分别设置3个UNet网络分别对不同的阶段进行针对性的处理。降低了不同去噪阶段的UNet网络之间的耦合性，可以进一步细化的这个去噪的过程。虽然模型变大了，但是各个过程的去噪效果有较大的提升，整体效果也比原来更加出色。本发明的实施例还提供了一种非瞬时性计算机可读存储介质，该存储介质可设置于电子设备之中以保存用于实现方法实施例中一种方法相关的至少一条指令或至少一段程序，该至少一条指令或该至少一段程序由该处理器加载并执行以实现上述实施例提供的方法。本发明的实施例还提供了一种电子设备，包括处理器和前述的非瞬时性计算机可读存储介质。本发明的实施例还提供一种计算机程序产品，其包括程序代码，当程序产品在电子设备上运行时，程序代码用于使该电子设备执行本说明书上述描述的根据本发明各种示例性实施方式的方法中的步骤。虽然已经通过示例对本发明的一些特定实施例进行了详细说明，但是本领域的技术人员应该理解，以上示例仅是为了进行说明，而不是为了限制本发明的范围。本领域的技术人员还应理解，可以对实施例进行多种修改而不脱离本发明的范围和精神。本发明开的范围由所附权利要求来限定。
