标题title
利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法
摘要abst
本发明涉及一种利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，属于组合导航技术领域；包括：GNSS/INS组合导航过程中GNSS正常时，在设定的周期内，交替训练第一神经网络和第二神经网络；通过逐个周期循环，使第一神经网络和第二神经网络中始终有一个处于训练过程的训练状态和另一个处于训练好的待命状态；其中，训练好的神经网络用于实现根据输入的INS数据预测出伪GNSS信号功能；当导航过程中GNSS丢失时，将处于待命状态的神经网络接入组合导航的组合结构；将INS数据输入到接入的神经网络，利用神经网络预测出的伪GNSS信号通过卡尔曼滤波器对INS原始数据进行补偿输出定位结果。本发明在GNSS丢失时能做出符合用户当前所处环境的预测，具有很强的实时性和灵活性。
权利要求书clms
1.一种利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，包括：步骤S1、GNSS/INS组合导航过程中GNSS正常时，在设定的周期内，交替训练第一神经网络和第二神经网络；通过逐个周期循环，使第一神经网络和第二神经网络中始终有一个处于训练过程的训练状态和另一个处于训练好的待命状态；其中，训练好的神经网络用于实现根据输入的INS数据预测出伪GNSS信号功能；步骤S2、当导航过程中GNSS丢失时，将处于待命状态的神经网络接入组合导航的组合结构；将INS数据输入到接入的神经网络，利用神经网络预测出的伪GNSS信号通过卡尔曼滤波器对INS原始数据进行补偿输出定位结果。2.根据权利要求1所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，所述步骤S1包括：步骤S101、在GNSS正常工作时，收集INS原始输出数据和GNSS输出的位置变化量数据，在设定的周期内，将收集的数据进行打包处理；步骤S102、对打包处理后的INS原始数据中的包括比力和角速度在内的数据进行去噪和标准化处理得到用于神经网络训练的INS数据；步骤S103、对设为训练状态的第一神经网络或第二神经网络进行训练；训练中，将用于神经网络训练的INS数据作为训练神经网络的输入特征，将打包处理后的GNSS位置变化量作为神经网络的输出特征的目标数据；所述训练的过程不超过半个周期；步骤S104、将训练好的神经网络设为待命状态，同时将另一神经网络设为训练状态进行训练；所述训练过程同样不超过半个周期；进入下一个周期后，重复步骤S101-S104，交替训练两个神经网络。3.根据权利要求2所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，步骤S101中，所收集的INS原始数据是由当前时刻三轴的比力、角速度、速度和上一时刻三轴的比力、角速度、速度组成的的向量x；所收集的GNSS输出数据是由GNSS解算的三轴位置变化量组成的的向量y；将设定的周期内收集的m个连续时刻的GNSS数据y至y打包组成一个矩阵Y；将与GNSS数据对应时刻的m个时刻的INS数据打包组成一个矩阵X。4.根据权利要求3所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，在步骤S102中，采用小波阈值去噪算法对X中的比力f、角速度ω进行了去噪。5.根据权利要求4所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，在小波阈值去噪算法中，选择sym8函数作为小波基，采用3级小波基分解，并采用软硬阈值折中的方法设定小波阈值。6.根据权利要求5所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，小波阈值；其中，/＞为第一级小波分解后高频部分的小波系数绝对值的均值，m为矩阵X的行数。7.根据权利要求5所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，去噪后，采用标准差标准化的方法对矩阵X每列数据进行了标准化处理，得到新矩阵Xnew；所述新矩阵Xnew中比力、角速度数据为去噪和标准化后的结果，速度数据为标准化后的结果。8.根据权利要求7所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，所述第一神经网络和第二神经网络均为结构相同的MLP神经网络。9.根据权利要求8所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，所述MLP神经网络包括一个输入层、两个隐藏层、一个输出层；其中，输入层为18个神经元，分别接收18维输入特征，输入特征为由矩阵Xnew提供的一行数据；输出层为3个神经元，用于输出3维的输出特征；两个隐含层分别为100维和50维，激活函数均采用Relu函数，优化器选择SGD优化器，学习率设置为0.002，采用均方根误差计算损失函数，模型迭代训练轮数epoch变量设置为10000。10.根据权利要求8所述的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，其特征在于，在输入层与第一隐含层之前加入Dropout层，在训练时随机忽略50%的权重；添加momentum变量，数值设置为0.9，用于帮助神经网络跳出局部最值。
说明书desc
技术领域本发明涉及组合导航技术领域，尤其涉及一种利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法。背景技术GNSS/INS组合导航由于其较高的定位精度和泛用性，成为了导航领域研究的热点。但当GNSS信号失锁时，仅靠INS进行导航服务时，由于INS的累计误差，导航的精度会急剧下降。因此，如何在GNSS信号失锁时补偿INS的累计误差，将组合导航的精度维持在较高的范围，是提高GNSS/INS组合导航可用性的重要课题。近几年人工智能技术的兴起，为解决GNSS信号失锁时组合导航精度下降问题提供了新的方向。目前，利用神经网络解决组合导航中GNSS信号失锁问题的方法主要有两种，分别是神经网络输出伪GNSS信号和神经网络输出INS信号的误差。目前的研究大多存在一些缺陷，一些研究都没有考虑历史导航信息的影响，而考虑了历史导航信息的研究大多采用了较为复杂的神经网络，训练成本较高，这导致它们无法进行实时的训练，必须在投入应用前利用已有的数据集进行训练，这将使他们的神经网络模型无法根据用户当时的环境做出预测，使其在实际应用中的精度和灵活性有所降低。因此，能够实时训练的神经网络辅助组合导航系统具有探索和研究的价值。发明内容鉴于上述的分析，本发明旨在公开了一种利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法；用于在GNSS失锁时提高GNSS/INS组合导航的精度。本发明公开了一种利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，包括：步骤S1、GNSS/INS组合导航过程中GNSS正常时，在设定的周期内，交替训练第一神经网络和第二神经网络；通过逐个周期循环，使第一神经网络和第二神经网络中始终有一个处于训练过程的训练状态和另一个处于训练好的待命状态；其中，训练好的神经网络用于实现根据输入的INS数据预测出伪GNSS信号功能；步骤S2、当导航过程中GNSS丢失时，将处于待命状态的神经网络接入组合导航的组合结构；将INS数据输入到接入的神经网络，利用神经网络预测出的伪GNSS信号通过卡尔曼滤波器对INS原始数据进行补偿输出定位结果。进一步地，所述步骤S1包括：步骤S101、在GNSS正常工作时，收集INS原始输出数据和GNSS输出的位置变化量数据，在设定的周期内，将收集的数据进行打包处理；步骤S102、对打包处理后的INS原始数据中的包括比力和角速度在内的数据进行去噪和标准化处理得到用于神经网络训练的INS数据；步骤S103、对设为训练状态的第一神经网络或第二神经网络进行训练；训练中，将用于神经网络训练的INS数据作为训练神经网络的输入特征，将打包处理后的GNSS位置变化量作为神经网络的输出特征的目标数据；所述训练的过程不超过半个周期；步骤S104、将训练好的神经网络设为待命状态，同时将另一神经网络设为训练状态进行训练；所述训练过程同样不超过半个周期；进入下一个周期后，重复步骤S101-S104，交替训练两个神经网络。进一步地，步骤S101中，所收集的INS原始数据是由当前时刻三轴的比力、角速度、速度和上一时刻三轴的比力、角速度、速度组成的的向量x；所收集的GNSS输出数据是由GNSS解算的三轴位置变化量组成的的向量y；将设定的周期内收集的m个连续时刻的GNSS数据y至y打包组成一个矩阵Y；将与GNSS数据对应时刻的m个时刻的INS数据打包组成一个矩阵X。进一步地，在步骤S102中，采用小波阈值去噪算法对X中的比力f、角速度ω进行了去噪。进一步地，在小波阈值去噪算法中，选择sym8函数作为小波基，采用3级小波基分解，并采用软硬阈值折中的方法设定小波阈值。进一步地，小波阈值；其中，/＞为第一级小波分解后高频部分的小波系数绝对值的均值，m为矩阵X的行数。进一步地，去噪后，采用标准差标准化的方法对矩阵X每列数据进行了标准化处理，得到新矩阵Xnew；所述新矩阵Xnew中比力、角速度数据为去噪和标准化后的结果，速度数据为标准化后的结果。进一步地，所述第一神经网络和第二神经网络均为结构相同的MLP神经网络。进一步地，所述MLP神经网络包括一个输入层、两个隐藏层、一个输出层；其中，输入层为18个神经元，分别接收18维输入特征，输入特征为由矩阵Xnew提供的一行数据；输出层为3个神经元，用于输出3维的输出特征；两个隐含层分别为100维和50维，激活函数均采用Relu函数，优化器选择SGD优化器，学习率设置为0.002，采用均方根误差计算损失函数，模型迭代训练轮数epoch变量设置为10000。进一步地，在输入层与第一隐含层之前加入Dropout层，在训练时随机忽略50%的权重；添加momentum变量，数值设置为0.9，用于帮助神经网络跳出局部最值。本发明可实现以下有益效果之一：本发明公开的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，采用轻量级的神经网络进行训练，可以在用户使用的过程中，基于用户当前所处的环境和运动状态对神经网络进行训练，从而使神经网络在GNSS丢失时可以做出更符合用户当前所处环境的预测，在应用上具有很强的实时性和灵活性；本发明采用去噪算法对INS原始信号进行去噪，再将去噪后的INS信号作为神经网络的输入，通过这种方法提升了神经网络的预测精度，改善了轻量级神经网络预测精度不如复杂神经网络的问题。附图说明附图仅用于示出具体实施例的目的，而并不认为是对本发明的限制，在整个附图中，相同的参考符号表示相同的部件；图1为本发明实施例中的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法流程图；图2为本发明实施例中的GNSS正常时数据采集和神经网络训练方法流程图；图3为本发明实施例中的小波分解流程框图；图4为本发明实施例中的训练模式的结构框图；图5为本发明实施例中的数据补偿的结构框图。具体实施方式下面结合附图来具体描述本发明的优选实施例，其中，附图构成本申请一部分，并与本发明的实施例一起用于阐释本发明的原理。本发明的一个实施例公开了一种利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，如图1所示，包括：步骤S1、GNSS/INS组合导航过程中GNSS正常时，在设定的周期内，交替训练第一神经网络和第二神经网络；通过逐个周期循环，使第一神经网络和第二神经网络中始终有一个处于训练过程的训练状态和另一个处于训练好的待命状态；其中，训练好的神经网络用于实现根据输入的INS数据预测出伪GNSS信号功能；步骤S2、当导航过程中GNSS丢失时，将处于待命状态的神经网络接入组合导航的组合结构；将INS数据输入到接入的神经网络，利用神经网络预测出的伪GNSS信号通过卡尔曼滤波器对INS原始数据进行补偿输出定位结果。具体的，如图2所示，所述步骤S1包括：步骤S101、在GNSS正常工作时，收集INS原始输出数据和GNSS输出的位置变化量数据，在设定的周期内，将收集的数据进行打包处理；例如，设定的周期为3分钟，以3分钟为间隔，收集INS原始输出数据和GNSS输出的位置变化量数据进行打包处理。其中，所收集的INS原始数据是由当前时刻三轴的比力、角速度、速度和上一时刻三轴的比力、角速度、速度组成的的向量x；即：；其中，f表示比力，ω表示角速度，v表示速度，t表示当前时刻，比力和角速度的下标x、y、z分别表示载体坐标系三轴，速度的下标x、y、z分别表示东北天坐标系三轴。所收集的GNSS输出数据是由GNSS解算的三轴位置变化量组成的的向量y；即：；其中，表示位置变化量，下标x、y、z分别表示经、纬、高三轴。将设定的周期内收集的m个连续时刻的GNSS数据y至y打包组成矩阵Y，Y是一个的矩阵；第p行即为第p时刻GNSS输出的数据y，其中p为整数且p∈。；将与GNSS数据对应时刻的m个时刻的INS数据打包组成矩阵X，X是一个的矩阵。矩阵X第q行即为在GNSS工作的第q时刻INS所输出的数据x，其中q为整数且q∈。；由于INS的数据输出频率往往远高于GNSS的数据输出频率。因此，INS在设定的周期内收集的数据量通常远大于m。而在训练神经网络时需要输入特征和输出特征数据量一致，所以在这一步需要取与GNSS数据的时刻对应的m个INS数据进行打包。步骤S102、对打包处理后的INS原始数据中的包括比力和角速度在内的数据进行去噪和标准化处理得到用于神经网络训练的INS数据；优选的，采用小波阈值去噪算法对X中的比力f、角速度ω进行了去噪。在小波阈值去噪算法中，小波分解采用Mallet算法，流程框图如图3所示。Mallet算法的流程为将信号分解为低频近似和高频细节两个部分，对于低频部分再次进行一级分解，得到该级的低频近似与高频细节，以此类推，逐级细分，实际应用中可以根据分辨率的需求进行所需层数的小波分解。经典的小波基函数主要有haar小波、dbN小波、coifN小波、symlet小波、meyer小波等等。在本实施例的小波阈值去噪算法中，选择sym8函数作为小波基，采用3级小波基分解，并采用软硬阈值折中的方法设定小波阈值。其中，sym8函数为symlet8小波基函数，是symlet小波系中的一种小波基函数。阈值函数公式如下：；其中，W表示去噪前的小波系数，Q表示去噪后的小波系数，k表示小波域的坐标，α是一个参数，取值范围为，本实例中，α取0.5，λ为选取的阈值，本实施例中，计算小波阈值的公式如下：；其中，为第一级小波分解后高频部分的小波系数绝对值的均值，m为原数据量，即矩阵X的行数。具体的，去噪后，采用标准差标准化的方法对每列数据进行了标准化处理，这个步骤是为了提高神经网络的训练速度，同时也有避免神经网络过拟合的作用。标准差标准化的公式如下：；其中，表示标准化后的值，/＞表示数据集的均值，/＞表示数据集的标准差。用去噪和标准化后的结果fnew、ωnew、vnew替换原来的矩阵X中的f、ω、v，得到的新矩阵Xnew中：；其中，fnew、ωnew分别为f、ω经过去噪和标准化后的结果，vnew为v仅经过标准化后的结果。包含经过小波阈值去噪后的当前时刻和上一时刻的三轴比力、角速度，和直接由INS输出得到的当前时刻和上一时刻的速度，是一个的矩阵。采用去噪和标准化处理后的INS数据去训练神经网络，数据量更小，实时性更好，更利于在线采集情况的神经网络训练。步骤S103、对设为训练状态的第一神经网络或第二神经网络进行训练；训练中，将用于神经网络训练的INS数据作为训练神经网络的输入特征，将打包处理后的GNSS位置变化量作为神经网络的输出特征的目标数据；所述训练的过程不超过半个设定的周期；步骤S104、将训练好的神经网络设为待命状态，同时将另一神经网络设为训练状态进行训练；所述训练过程同样不超过半个设定的周期；在进入下一个周期时，重复步骤S101-S104，交替训练两个神经网络。所述第一神经网络和第二神经网络均为结构相同的MLP神经网络。MLP神经网络模型结构简单，训练速度快，泛化能力强，符合在用户使用的过程中，基于用户当前所处的环境和运动状态对神经网络进行训练的要求。具体的，本实施例采用的MLP神经网络包括一个输入层、两个隐藏层、一个输出层；其中，输入层为18个神经元，分别接收18维输入特征，输入特征由矩阵Xnew提供；输出层为3个神经元，用于输出3维的输出特征；训练时，输出特征的目标数据由矩阵Y提供；两个隐含层分别为100维和50维，激活函数均采用Relu函数，优化器选择SGD优化器，学习率设置为0.002，采用均方根误差计算损失函数，模型迭代训练轮数epoch变量设置为10000。为了避免过拟合，除了对数据进行了标准化外，本本实施例的神经网络还包括：在输入层与第一隐含层之前加入Dropout层，在训练时随机忽略50%的权重；添加momentum变量，数值设置为0.9，用于帮助神经网络跳出局部最值。本实施例中通过上述改进，在避免过拟合的同时还可以加快训练速度: Dropout层减少了计算时的权重数量，momentum 加快了损失区数收敛的速度。通过本实施例的神经网络训练过程，使最新训练好的神经网络处于待命状态，在先训练好的神经网络处于重新训练状态，从而使在GNSS正常工作时，始终有一个神经网络处于待命状态，另一个处于训练状态，且处于待命状态的神经网络始终是使用最新的数据训练好的，在使用待命状态的神经网络进行预测时，更符合用户当前所处环境在应用上具有很强的实时性和灵活性。如图4所示，给出了在GNSS/INS松组合导航系统中实施以上步骤中的训练模式的结构框图。图中，去噪模块，用于实施步骤S102中的去噪方法，神经网络中包括第一和第二神经网络，KF模块为现有的卡尔曼滤波器结构。同样的，以上步骤中的训练模式同样可以应用于GNSS/INS紧组合导航系统中，利用GNSS信息和INS信息进行紧组合导航的技术方案可参照现有的紧组合导航技术方案。在步骤S2中，当导航过程中GNSS丢失时，将处在待命状态的神经网络接入组合导航的组合结构，将INS数据输入到待命状态的神经网络进行伪GNSS信号的预测，神经网络输入与训练时使用的输入相同，输出为预测的的伪GNSS信号的三轴位置变化量，输出到卡尔曼滤波器对INS原始数据进行补偿后输出定位结果。如图5所示，给出了在GNSS/INS松组合导航系统中实施数据补偿的结构框图。图中去噪模块，用于实施步骤S102中的去噪方法，神经网络中采用处于待命状态的神经网络接入组合导航的组合结构。同样的，以上步骤中的数据补偿同样可以应用于GNSS/INS紧组合导航系统中，利用GNSS信息和INS信息进行紧组合导航的技术方案可参照现有的紧组合导航技术方案。综上所述，本发明实施例公开的利用神经网络模型在线学习和补偿的GNSS/INS组合导航方法，采用轻量级的神经网络进行训练，可以在用户使用的过程中，基于用户当前所处的环境和运动状态对神经网络进行训练，从而使神经网络在GNSS丢失时可以做出更符合用户当前所处环境的预测，在应用上具有很强的实时性和灵活性；采用去噪算法对INS原始信号进行去噪，再将去噪后的INS信号作为神经网络的输入，提升了神经网络的预测精度，改善了轻量级神经网络预测精度不如复杂神经网络的问题。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。
