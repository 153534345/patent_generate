标题title
标记物的伪影坐标去除方法及相关装置
摘要abst
本申请实施例提供了标记物的伪影坐标去除方法及相关装置，以光学追踪设备的光学坐标系中的第一传感器的坐标、第二传感器的坐标分别与任两个候选坐标为基础，得到第一直线和第二直线后，将M个候选坐标中除第一候选坐标和第二候选坐标以外，与第一直线之间的距离小于或等于第一阈值且与第二直线之间的距离小于或等于第一阈值的候选坐标作为伪影坐标，基于M个候选坐标确定N个伪影坐标；从M个候选坐标中去除N个伪影坐标，得到追踪范围内的标记物的目标坐标，可以有效去除伪影坐标，从而提高标记物坐标的准确性，提高后续配准流程的效率，提高手术导航系统的实时性。
权利要求书clms
1.一种标记物的伪影坐标去除方法，其特征在于，所述方法包括：获取M个候选坐标，所述M个候选坐标为光学追踪设备对追踪范围内的标记物采集的坐标，所述光学追踪设备包括第一传感器和第二传感器，所述第一传感器和所述第二传感器用于接收所述光学追踪设备追踪范围内的标记物反射的光线以确定所述标记物的坐标；所述M为大于或等于3的整数；根据所述第一传感器的坐标和第一候选坐标确定第一直线，以及，根据所述第二传感器的坐标和第二候选坐标确定第二直线；所述第一候选坐标和所述第二候选坐标为所述M个候选坐标中任两个不同的候选坐标；将所述M个候选坐标中除所述第一候选坐标和所述第二候选坐标以外，与所述第一直线之间的距离小于或等于第一阈值且与所述第二直线之间的距离小于或等于所述第一阈值的候选坐标作为伪影坐标；基于所述M个候选坐标确定N个伪影坐标，所述N为大于或等于1的整数；从所述M个候选坐标中去除所述N个伪影坐标，得到所述追踪范围内的标记物的目标坐标。2.根据权利要求1所述的方法，其特征在于，所述将所述M个候选坐标中除所述第一候选坐标和所述第二候选坐标以外，与所述第一直线之间的距离小于或等于第一阈值且与所述第二直线之间的距离小于或等于所述第一阈值的候选坐标作为伪影坐标，包括：在所述第一直线与所述第二直线之间的距离小于或等于第二阈值的情况下，执行所述将所述M个候选坐标中除所述第一候选坐标和所述第二候选坐标以外，与所述第一直线之间的距离小于或等于第一阈值且与所述第二直线之间的距离小于或等于所述第一阈值的候选坐标作为伪影坐标步骤。3.根据权利要求1或2所述的方法，其特征在于，所述将所述M个候选坐标中除所述第一候选坐标和所述第二候选坐标以外，与所述第一直线之间的距离小于或等于第一阈值且与所述第二直线之间的距离小于或等于所述第一阈值的候选坐标作为伪影坐标，包括：确定目标线段的中点为参考点，所述目标线段为相交于所述第一直线和所述第二直线且距离最短的线段，所述目标线段的第一端点位于所述第一直线上，所述目标线段的第二端点位于所述第二直线上；将所述M个候选坐标中除所述第一候选坐标和所述第二候选坐标以外，与所述参考点之间的距离小于或等于所述第一阈值的候选坐标作为伪影坐标。4.根据权利要求1或2所述的方法，其特征在于，在所述N大于或等于3的情况下，所述从所述M个候选坐标中去除N个伪影坐标，得到所述追踪范围内的标记物的目标坐标，包括：在所述N个伪影坐标不包括目标伪影坐标的情况下，执行所述从所述M个候选坐标中去除N个伪影坐标，得到所述追踪范围内的标记物的目标坐标步骤；用于确定所述目标伪影坐标的两个候选坐标均为伪影坐标。5.根据权利要求4所述的方法，其特征在于，所述方法还包括：在所述N个伪影坐标中包括所述目标伪影坐标的情况下，基于所述N个伪影坐标确定K个伪影坐标，用于确定所述K个伪影坐标的候选坐标均不为伪影坐标，所述K为大于或等于1的整数；从所述M个候选坐标中去除所述K个伪影坐标，得到所述追踪范围内的标记物的目标坐标。6.根据权利要求5所述的方法，其特征在于，所述根据所述第一传感器的坐标和第一候选坐标确定第一直线，以及，根据所述第二传感器的坐标和第二候选坐标确定第二直线之前，所述方法还包括：获取所述光学追踪设备对第一参考标记物和第二参考标记物采集的第一参考坐标，第二参考坐标，第一参考伪影坐标以及第二参考伪影坐标；所述第一参考坐标与参考平面之间的距离小于或等于第三阈值，所述参考平面是基于所述第二参考坐标、所述第一传感器的坐标以及所述第二传感器的坐标确定的；所述第一参考伪影坐标为采集到的坐标中距离所述光学追踪设备所在坐标系的原点最近的坐标，所述第二参考伪影坐标为采集到的坐标中距离所述光学追踪设备所在坐标系的原点最远的坐标；基于第一参考线段的中点确定所述第一传感器的坐标；第一参考线段的第一端点位于第一参考直线上，所述第一参考线段的第二端点位于第二参考直线上，所述第一参考直线为所述第一参考坐标与所述第一参考伪影坐标对应的直线，所述第二参考直线为所述第二参考坐标与所述第二参考伪影坐标对应的直线；基于第二参考线段的中点确定所述第二传感器的坐标；第二参考线段的第一端点位于第三参考直线上，所述第二参考线段的第二端点位于第四参考直线上，所述第三参考直线为所述第一参考坐标与所述第二参考伪影坐标对应的直线，所述第四参考直线为所述第二参考坐标与所述第一参考伪影坐标对应的直线。7.根据权利要求1所述的方法，其特征在于，所述标记物为球形标记物，所述第一阈值为所述标记物的半径。8.一种标记物的伪影坐标去除装置，其特征在于，包括用于执行如权利要求1-7中任一项所述方法的单元。9.一种电子设备，其特征在于，包括：处理器和存储器，其中，所述存储器中存储有计算机程序，所述处理器调用所述存储器中存储的计算机程序，用于执行如权利要求1-7中任一项所述的方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有计算机程序，当所述计算机程序在一个或多个处理器上运行时，使得如权利要求1-7中任一项所述的方法被执行。
说明书desc
技术领域本申请实施例涉及计算机技术领域，具体涉及标记物的伪影坐标去除方法及相关装置。背景技术光学追踪设备可以发射红外光以及接收标记物反射的红外光，对标记物进行定位。但是，通过光学追踪设备采集到的坐标可能比现实空间中的标记物数量多。在现实空间中未对应有标记物的坐标可以称为伪影坐标，伪影坐标的存在将导致标记物的坐标不准确，因此，去除伪影坐标具有重要意义。发明内容本申请实施例提供了一种标记物的伪影去除方法及相关装置，通过本申请提供的方法可以有效去除伪影坐标。第一方面，本申请实施例提供了一种标记物的伪影去除方法，包括：获取M个候选坐标，上述M个候选坐标为光学追踪设备对追踪范围内的标记物采集的坐标，上述光学追踪设备包括第一传感器和第二传感器，上述第一传感器和上述第二传感器用于接收上述光学追踪设备追踪范围内的标记物反射的光线以确定上述标记物的坐标；上述M为大于或等于3的整数；根据上述第一传感器的坐标和第一候选坐标确定第一直线，以及，根据上述第二传感器的坐标和第二候选坐标确定第二直线；上述第一候选坐标和上述第二候选坐标为上述M个候选坐标中任两个不同的候选坐标；将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述第一直线之间的距离小于或等于第一阈值且与上述第二直线之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标；基于上述M个候选坐标确定N个伪影坐标，上述N为大于或等于1的整数；从上述M个候选坐标中去除上述N个伪影坐标，得到上述追踪范围内的标记物的目标坐标。本申请实施例，以光学追踪设备的光学坐标系中的第一传感器的坐标、第二传感器的坐标分别与任两个候选坐标为基础，得到第一直线和第二直线后，将M个候选坐标中除第一候选坐标和第二候选坐标以外，与第一直线之间的距离小于或等于第一阈值且与第二直线之间的距离小于或等于第一阈值的候选坐标作为伪影坐标，基于M个候选坐标确定N个伪影坐标；从M个候选坐标中去除N个伪影坐标，得到追踪范围内的标记物的目标坐标，可以有效去除伪影坐标，从而提高标记物坐标的准确性，提高后续配准流程的效率，提高手术导航系统的实时性。结合第一方面，在一种可能的实现方式中，上述将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述第一直线之间的距离小于或等于第一阈值且与上述第二直线之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标，包括：在上述第一直线与上述第二直线之间的距离小于或等于第二阈值的情况下，执行上述将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述第一直线之间的距离小于或等于第一阈值且与上述第二直线之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标步骤。结合第一方面，在一种可能的实现方式中，上述将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述第一直线之间的距离小于或等于第一阈值且与上述第二直线之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标，包括：确定目标线段的中点为参考点，上述目标线段为相交于上述第一直线和上述第二直线且距离最短的线段，上述目标线段的第一端点位于上述第一直线上，上述目标线段的第二端点位于上述第二直线上；将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述参考点之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标。结合第一方面，在一种可能的实现方式中，在上述N大于或等于3的情况下，上述从上述M个候选坐标中去除N个伪影坐标，得到上述追踪范围内的标记物的目标坐标，包括：在上述N个伪影坐标不包括目标伪影坐标的情况下，执行上述从上述M个候选坐标中去除N个伪影坐标，得到上述追踪范围内的标记物的目标坐标步骤；用于确定上述目标伪影坐标的两个候选坐标均为伪影坐标。结合第一方面，在一种可能的实现方式中，上述方法还包括：在上述N个伪影坐标中包括上述目标伪影坐标的情况下，基于上述N个伪影坐标确定K个伪影坐标，用于确定上述K个伪影坐标的候选坐标均不为伪影坐标，上述K为大于或等于1的整数；从上述M个候选坐标中去除上述K个伪影坐标，得到上述追踪范围内的标记物的目标坐标。结合第一方面，在一种可能的实现方式中，上述根据上述第一传感器的坐标和第一候选坐标确定第一直线，以及，根据上述第二传感器的坐标和第二候选坐标确定第二直线之前，上述方法还包括：获取上述光学追踪设备对第一参考标记物和第二参考标记物采集的第一参考坐标，第二参考坐标，第一参考伪影坐标以及第二参考伪影坐标；上述第一参考坐标与参考平面之间的距离小于或等于第三阈值，上述参考平面是基于上述第二参考坐标、上述第一传感器的坐标以及上述第二传感器的坐标确定的；上述第一参考伪影坐标为采集到的坐标中距离上述光学追踪设备所在坐标系的原点最近的坐标，上述第二参考伪影坐标为采集到的坐标中距离上述光学追踪设备所在坐标系的原点最远的坐标；基于第一参考线段的中点确定上述第一传感器的坐标；第一参考线段的第一端点位于第一参考直线上，上述第一参考线段的第二端点位于第二参考直线上，上述第一参考直线为上述第一参考坐标与上述第一参考伪影坐标对应的直线，上述第二参考直线为上述第二参考坐标与上述第二参考伪影坐标对应的直线；基于第二参考线段的中点确定上述第二传感器的坐标；第二参考线段的第一端点位于第三参考直线上，上述第二参考线段的第二端点位于第四参考直线上，上述第三参考直线为上述第一参考坐标与上述第二参考伪影坐标对应的直线，上述第四参考直线为上述第二参考坐标与上述第一参考伪影坐标对应的直线。结合第一方面，在一种可能的实现方式中，上述标记物为球形标记物，上述第一阈值为上述标记物的半径。第二方面，本申请实施例提供了一种标记物的伪影坐标去除装置，包括用于执行第一方面或第一方面的任意可能的实现方式中的方法的单元。第三方面，本申请实施例提供了一种电子设备，包括：处理器和存储器，其中，该存储器中存储有计算机程序，该处理器调用该存储器中存储的计算机程序，用于执行如第一方面或者第一方面的任意一种可能的实施方式中的方法。第四方面，本申请还提供了另一种电子设备，包括：处理器、发送装置、输入装置、输出装置和存储器，所述存储器用于存储计算机程序代码，所述计算机程序代码包括计算机指令，在所述处理器执行所述计算机指令的情况下，所述电子设备执行如第一方面或者第一方面的任意一种可能的实施方式中的方法。第五方面，本申请实施例提供了一种计算机可读存储介质，该计算机可读存储介质中存储有计算机程序，当该计算机程序在一个或多个处理器上运行时，使得如第一方面或者第一方面的任意一种可能的实施方式中的方法被执行。第六方面，本申请实施例提供了一种计算机程序产品，该计算机程序产品包括程序指令，该程序指令当被处理器执行时使该处理器执行如第一方面或者第一方面的任意一种可能的实施方式中的方法。附图说明为了更清楚地说明本申请实施例或背景技术中的技术方案，下面将对本申请实施例或背景技术中所需要使用的附图作简单的介绍。图1是本申请实施例提供的一种光学追踪设备定位原理的示意图；图2是本申请实施例提供的一种标记物的伪影坐标去除方法的流程示意图；图3是本申请实施例提供的一种伪影坐标产生原理的示意图；图4是本申请实施例提供的一种伪影坐标误识别的场景示意图；图5是本申请实施例提供的一种计算双目坐标的示意图；图6是本申请实施例提供的一种确定双目坐标的方法流程示意图；图7a是本申请实施例提供的另一种标记物的伪影坐标去除方法的流程示意图；图7b是本申请实施例提供的又一种标记物的伪影坐标去除方法的流程示意图；图8是本申请实施例提供的一种电子设备的结构示意图；图9是本申请实施例提供的另一种电子设备的结构示意图。具体实施方式本申请以下实施例中所使用的术语只是为了描述特定实施例的目的，而并非旨在作为对本申请的限制。如在本申请的说明书和所附权利要求书中所使用的那样，单数表达形式“一个”、“一种”、“上述”、“该”和“这一”旨在也包括复数表达形式，除非其上下文中明确地有相反指示。还应当理解，本申请中使用的术语“和/或”是指并包含一个或多个所列出项目的任何或所有可能组合。本申请的说明书、权利要求书及附图中的术语“第一”和“第二”等是用于区别不同对象，而不是用于描述特定顺序。需要说明的是，本申请的说明书、权利要求书及附图中的术语“第一”、“第二”、“第三”以及“第四”等是用于区别不同对象，而不是用于描述特定顺序。还应理解，本申请实施例中，步骤前的编号是为了便于理解和描述方案而作出的，而不应该理解为对步骤执行顺序的限定。随着计算机科学技术的不断发展，医学技术也随之迎来了重大突破，使得微创手术的应用越来越广泛。相比于开放手术，微创手术具有创伤面积小、感染率低、患者康复快和住院时间短等特点。正是由于微创手术的创口较小，医生在进行微创手术时无法直视到患者的内部结构，即失去对现场的直接视觉反馈；另外，微创手术还存在术中视野区域过小，导致医生需要反复查看术前图像等问题，因此，微创手术依赖于手术导航系统。示例性地，手术导航系统中可以包括光学追踪设备，可以利用光学追踪设备将实际场景中的手术针、患者躯体等实时映射到显示器上，使得医生可以通过显示器获取更多信息，不仅可以减轻医生的压力，还可以提高手术精度。本申请实施例中，光学追踪设备可以理解为用于测量标记物的空间位置信息的设备。示例性地，请参阅图1，图1是本申请实施例提供的一种光学追踪设备定位原理的示意图。如图1所示，光学追踪设备101的追踪范围内包括标记物102，其中，光学标记物的追踪范围可以理解为光学追踪设备能够扫描并定位空间信息的范围，比如光学追踪设备的红外线扫描范围。示例性地，光学追踪设备101可以包括第一传感器1011和第二传感器1012。第一传感器1011可以包括第一红外发光二极管以及第一红外接收器，第二传感器1012可以包括第二红外发光二极管以及第二红外接收器。在对标记物102进行定位时，第一红外发光二极管和第二红外发光二极管可以产生红外光线，并照射到标记物102上，标记物102表面的反光涂层将红外光线反射回第一红外接收器和第二红外接收器上，光学追踪设备101利用如图1所示的红外光线对标记物102进行定位。可选地，上述第一传感器1011和第二传感器1012可以统称为双目视觉。实际情况中，光学追踪设备通过双目视觉对标记物进行定位时，采集到的坐标可能比现实空间中的标记物数量多，即光学追踪设备采集到的坐标中包括伪影坐标。本申请实施例中，伪影坐标可以理解为光学追踪设备采集的、在现实空间中未对应有标记物的坐标。比如现实空间中包括5个标记物，但是光学追踪设备采集到6个坐标，那么，上述6个坐标中包括1个伪影坐标。可以理解，伪影坐标的存在将导致光学追踪设备采集的标记物坐标不准确，不准确的标记物坐标将导致后续其他流程效率降低，比如将导致后续的配准流程效率降低，进而导致手术导航系统的视觉反馈不及时以及导航实时性的下降，拖慢手术进度。为便于理解，以手术导航系统中患者注册为例。现实空间中，可以通过粘贴在患者体表的标记物对患者进行定位，但是患者内部器官的详细情况需要从计算机断层扫描设备采集的CT图像获得。可以理解，采集的标记物的坐标属于光学追踪设备对应的光学坐标系，采集的CT图像属于CT设备对应的CT坐标系，为了实现手术导航，需要将CT坐标系下患者的解剖组织转换到光学坐标系中显示。在一种可能的实现方式中，可以利用标记物的坐标对光学坐标系与CT坐标系进行配准，实现患者注册。示例性地，可以在患者身上粘贴标记物，基于同一组标记物在CT坐标系下的坐标和在光学坐标系下的坐标计算转换矩阵，基于转换矩阵对光学坐标系与CT坐标系配准。容易理解，如果光学追踪设备采集的标记物坐标不准确，将导致转换矩阵的计算过程效率降低，进而导致配准过程效率降低。因此，去除伪影坐标具有重要意义。基于此，本申请实施例提供了标记物的伪影坐标去除方法和相关装置，本申请可以有效去除光学追踪设备采集到的伪影坐标。本申请实施例提供的方法可以由电子设备执行，其中，上述电子设备可以是任意一种可执行本申请方法实施例所公开的技术方案的电子设备，电子设备可以是平板电脑、掌上电脑、笔记本电脑、移动互联网设备、穿戴式设备或扫描设备等，还可以是终端设备、服务器或者多个服务器组成的服务器集群等，在此不做限定。可选地，本申请方法实施例还可以通过处理器执行计算机程序代码的方式实现。为便于理解，示例性地，请参阅图2，图2是本申请实施例提供的一种标记物的伪影坐标去除方法的流程示意图。如图2所示，上述方法包括：201：获取M个候选坐标，该M个候选坐标为光学追踪设备对追踪范围内的标记物采集的坐标，该光学追踪设备包括第一传感器和第二传感器，该第一传感器和该第二传感器用于接收该光学追踪设备追踪范围内的标记物反射的光线以确定该标记物的坐标；该M为大于或等于3的整数。本步骤中，M个候选坐标可以理解为光学追踪设备对追踪范围内的实际存在标记物采集的坐标，即待进行伪影坐标去除的坐标，其中，M为大于或等于3的整数。可以理解，如果光学追踪设备的追踪范围内实际包括1个标记物时，那么不会采集到伪影坐标；在光学追踪设备的追踪范围内实际包括2个或2个以上标记物时，才可能会存在至少1个伪影坐标，因此，本申请实施例中，M为大于或等于3的整数。本申请实施例不限定光学追踪设备追踪范围内实际存在的标记物的摆放位置，只要标记物包括在光学追踪设备追踪范围内、能够被定位即可。本步骤中，第一传感器可以理解为图1中的第一传感器1011，第二传感器可以理解为图1中的第二传感器1012，用于实现光学追踪设备对标记物的定位功能。可以理解的是，本申请实施例中的标记物表面可以包括反光涂层，用于反射传感器发射的光线，其中，上述光线可以是红外线，也可以是其他反射光线，本申请对此不作限定。202：根据该第一传感器的坐标和第一候选坐标确定第一直线，以及，根据该第二传感器的坐标和第二候选坐标确定第二直线；该第一候选坐标和该第二候选坐标为该M个候选坐标中任两个不同的候选坐标。203：将该M个候选坐标中除该第一候选坐标和该第二候选坐标以外，与该第一直线之间的距离小于或等于第一阈值且与该第二直线之间的距离小于或等于该第一阈值的候选坐标作为伪影坐标。204：基于该M个候选坐标确定N个伪影坐标，该N为大于或等于1的整数。本申请实施例中，步骤202和步骤203可以理解为循环，M个候选坐标中任意两个候选坐标都将进行上述步骤202和步骤203，因此，上述步骤202和步骤203将执行次，在M个候选坐标中所有候选坐标对都进行伪影坐标筛选后，循环结束。为便于理解，可以将上述循环简称为第一循环。可以理解，在第一循环结束后，电子设备将得到N个伪影坐标，其中，N为大于或等于1的整数。由于第一循环中每个循环节的处理流程是一样的，因此，以候选坐标对包括第一候选坐标和第二候选坐标为例对一个循环节进行介绍。在电子设备选定第一候选坐标和第二候选坐标后，根据两个点确定一条直线原理，可以得到第一直线和第二直线，其中，第一直线由第一传感器的坐标和第一候选坐标确定，第二直线由第二传感器的坐标和第二候选坐标确定。在确定上述第一直线和第二直线后，根据点到直线之间的距离原理，对M个候选坐标中其他候选坐标进行筛选，将与第一直线之间的距离小于或等于第一阈值且与第二直线之间的距离也小于或等于第一阈值的候选坐标作为伪影坐标。此时，可以认为完成上述候选坐标对的伪影坐标筛选。也就是说，本申请实施例中，每个循环节利用一个候选坐标对确定是否存在伪影坐标。反过来说，每个伪影坐标是基于两个候选坐标确定的。容易理解，对于每个循环节来说，电子设备可能确定出至少一个伪影坐标，也可能确定不存在伪影坐标，但是整个第一循环结束后将得到至少一个伪影坐标。对于不同的循环节来说，不同的候选坐标对确定出的伪影坐标可能是相同的，也可能是不同的。本申请实施例中，第一阈值可以根据经验值确定，或者，可以根据标记物大小确定，本申请对此不作限定。在一些实施例中，光学追踪设备追踪的标记物包括球形标记物，上述第一阈值为标记物的半径。本实施例中，将第一阈值设定为标记物半径筛选出的伪影坐标更加准确，降低误识别成伪影坐标的概率。可选地，在标记物为其他形状时，也可以根据标记物的特性设定。比如，如果标记物是椭球体，上述第一阈值可以设定为椭球体的长半轴，或者，可以设定为椭球体的短半轴，还可以设定为大于短半轴，小于长半轴之间的任一数值等。205：从该M个候选坐标中去除该N个伪影坐标，得到该追踪范围内的标记物的目标坐标。本步骤中，目标坐标可以理解为经过伪影坐标筛选后，得到的标记物的真实坐标。其中，上述目标坐标应该理解为追踪范围内的各个标记物的坐标的统称，可以是至少两个坐标。可以理解的是，在基于该M个候选坐标未确定出伪影坐标，即确定出0个伪影坐标的情况下，可以认为光学追踪设备采集到的坐标均为真实坐标，不需要进行伪影坐标去除处理。示例性地，请参阅图3，图3是本申请实施例提供的一种伪影坐标产生原理的示意图。光学追踪设备301对标记物进行定位时，第一传感器和第二传感器会计算出标记物302和标记物303与自身之间的线，例如图3所示的虚线。当这些线相互交叉，且线与线之间的距离小于一定阈值的情况下，光学追踪设备会认为线之间的交点也是标记物的坐标，即产生伪影坐标，如图3所示的标记物304和标记物305可以理解为幻象标记，对应的坐标为伪影坐标。基于伪影坐标的产生原理，本申请实施例，电子设备先获取M个候选坐标，M个候选坐标为光学追踪设备对追踪范围内的标记物采集的坐标，光学追踪设备包括第一传感器和第二传感器，第一传感器和第二传感器用于接收光学追踪设备追踪范围内的标记物反射的光线以确定标记物的坐标；M为大于或等于3的整数；然后，根据第一传感器的坐标和第一候选坐标确定第一直线，以及，根据第二传感器的坐标和第二候选坐标确定第二直线；第一候选坐标和第二候选坐标为M个候选坐标中任两个不同的候选坐标；将M个候选坐标中除第一候选坐标和第二候选坐标以外，与第一直线之间的距离小于或等于第一阈值且与第二直线之间的距离小于或等于第一阈值的候选坐标作为伪影坐标；基于M个候选坐标确定N个伪影坐标，N为大于或等于1的整数；最后，从M个候选坐标中去除N个伪影坐标，得到追踪范围内的标记物的目标坐标。由于伪影坐标是由于传感器与至少两个真实标记物之间的线产生的，那么伪影坐标会出现在第一直线和第二直线趋近于相交的附近区域，本申请实施例，以光学追踪设备的光学坐标系中的第一传感器的坐标、第二传感器的坐标分别与任两个候选坐标为基础，得到第一直线和第二直线后，将M个候选坐标中除第一候选坐标和第二候选坐标以外，与第一直线之间的距离小于或等于第一阈值且与第二直线之间的距离小于或等于第一阈值的候选坐标作为伪影坐标，基于M个候选坐标确定N个伪影坐标；从M个候选坐标中去除N个伪影坐标，得到追踪范围内的标记物的目标坐标，可以有效去除伪影坐标，从而提高标记物坐标的准确性，提高后续配准流程的效率，提高手术导航系统的实时性。可以理解的，基于伪影坐标的产生原理，在基于候选坐标对进行伪影坐标筛选时，可以先判断候选坐标对是否有产生伪影的条件，在候选坐标对产生伪影坐标的可能性较大的情况下在进行伪影坐标筛选，可以提高确定伪影坐标的效率。因此，在一些实施例中，上述步骤203，将该M个候选坐标中除该第一候选坐标和该第二候选坐标以外，与该第一直线之间的距离小于或等于第一阈值且与该第二直线之间的距离小于或等于该第一阈值的候选坐标作为伪影坐标，包括：2031：在第一直线与第二直线之间的距离小于或等于第二阈值的情况下，执行将M个候选坐标中除第一候选坐标和第二候选坐标以外，与第一直线之间的距离小于或等于第一阈值且与第二直线之间的距离小于或等于第一阈值的候选坐标作为伪影坐标步骤。本实施例中，可以根据经验值或者标记物特征设定上述第二阈值，比如可以是球形标记物的直径。可选地，上述第二阈值可以设定为与上述第一阈值相同的值。除了可以直接通过候选坐标与第一直线和第二直线的距离筛选伪影坐标外，还可以给予第一直线和第二直线确定参考点，以参考点为中心筛选伪影坐标。因此，在一些实施例中，上述步骤203或上述步骤2031中，将M个候选坐标中除第一候选坐标和第二候选坐标以外，与第一直线之间的距离小于或等于第一阈值且与第二直线之间的距离小于或等于第一阈值的候选坐标作为伪影坐标，包括：20311：确定目标线段的中点为参考点，目标线段为相交于第一直线和第二直线且距离最短的线段，目标线段的第一端点位于所述第一直线上，目标线段的第二端点位于所述第二直线上。20312：将M个候选坐标中除第一候选坐标和第二候选坐标以外，与参考点之间的距离小于或等于第一阈值的候选坐标作为伪影坐标。可以理解，满足一个端点在第一直线上，另一个端点在第二直线上的线段有多条，本申请实施例中，上述多条线段中最短的线段可以理解为目标线段。目标线段的中点为参考点，以参考点为球心，距离与参考点之间的距离小于或等于第一阈值的候选坐标可以作为伪影坐标。其中，对上述第一阈值的描述可以参阅前文步骤203，这里不再赘述。可选地，电子设备根据第一循环确定出的N个伪影坐标可能存在误识别的情况，为便于理解，示例性地，请参阅图4，图4是本申请实施例提供的一种伪影坐标误识别的场景示意图。如图4所示，光学追踪设备401对追踪范围的标记物402、标记物403以及标记物404进行定位，其中，光学追踪设备401识别到6个伪影坐标，如图4所示的标记物405、标记物406、标记物407、标记物408、标记物409以及标记物410可以理解为幻象标记。可以理解，如果按照前文图2所示的方式进行伪影坐标识别，伪影坐标405以及伪影坐标406作为候选坐标对时，会把标记物403对应的坐标确定为伪影坐标。显然，标记物403是真实存在的标记物，被确定为伪影坐标属于误识别。因此，可以在第一循环筛选出N个伪影坐标后，对N个伪影坐标进行二次筛选，以进一步提高伪影坐标识别的准确性，进而提高标记物坐标识别的准确性。本申请实施例中，用于确定某个伪影坐标的两个候选坐标均为伪影坐标的情况下，该伪影坐标可以称为目标伪影坐标。目标伪影坐标可以形象地理解为误识别的伪影坐标，即真实坐标。如图4所示，经过第一循环后，电子设备会将如图4所示的标记物405、标记物406、标记物407、标记物408、标记物409、标记物410以及标记物403均确定为幻象标记，但是，用于确定标记物403的坐标405以及坐标406本身也是伪影坐标，那么，标记物403对应的坐标可以理解为上述目标伪影坐标。因此，在一些实施例中，步骤205，从M个候选坐标中去除N个伪影坐标，得到追踪范围内的标记物的目标坐标，包括：2051：在N个伪影坐标不包括目标伪影坐标的情况下，执行从M个候选坐标中去除N个伪影坐标，得到追踪范围内的标记物的目标坐标步骤；用于确定目标伪影坐标的两个候选坐标均为伪影坐标。本实施例中，电子设备先确定经过第一循环确定出的N个伪影坐标不包括目标伪影坐标，即N个伪影坐标不存在误识别的情况才从M个候选坐标中去除N个伪影坐标，可以进一步提高伪影去除的准确性。在另一些实施例中，步骤2051之后，还包括：2052：在N个伪影坐标中包括目标伪影坐标的情况下，基于N个伪影坐标确定K个伪影坐标，用于确定K个伪影坐标的候选坐标均不为伪影坐标，K为大于或等于1的整数。2053：从M个候选坐标中去除K个伪影坐标，得到追踪范围内的标记物的目标坐标。本实施例中，在确定在N个伪影坐标中包括目标伪影坐标的情况下，电子设备基于N个伪影坐标重新确定K个伪影坐标。其中，K个伪影坐标中每个坐标均不为目标伪影坐标，即用于确定K个伪影坐标的候选坐标均不为伪影坐标，以排除误识别的伪影坐标，进一步提高伪影坐标识别的准确率。本申请实施例中，第一传感器和第二传感器是光学追踪设备上的硬件，可以根据第一传感器和第二传感器与光学坐标系原点之间的空间关系计算出第一传感器的坐标和第二传感器的坐标。可选地，可以通过伪影产生原理计算出第一传感器坐标和第二传感器的坐标。可以理解的是，第一传感器坐标和第二传感器的坐标在采集候选坐标进行伪影坐标筛选之前进行，并且，计算好第一传感器坐标和第二传感器的坐标后可以在后续流程中重复使用，无需重复计算。在一些实施例中，步骤202，根据该第一传感器的坐标和第一候选坐标确定第一直线，以及，根据该第二传感器的坐标和第二候选坐标确定第二直线；该第一候选坐标和该第二候选坐标为该M个候选坐标中任两个不同的候选坐标之前，还包括：206：获取光学追踪设备对第一参考标记物和第二参考标记物采集的第一参考坐标，第二参考坐标，第一参考伪影坐标以及第二参考伪影坐标；第一参考坐标与参考平面之间的距离小于或等于第三阈值，参考平面是基于第二参考坐标、第一传感器的坐标以及第二传感器的坐标确定的；第一参考伪影坐标为采集到的坐标中距离光学追踪设备所在坐标系的原点最近的坐标，第二参考伪影坐标为采集到的坐标中距离光学追踪设备所在坐标系的原点最远的坐标。207：基于第一参考线段的中点确定第一传感器的坐标；第一参考线段的第一端点位于第一参考直线上，第一参考线段的第二端点位于第二参考直线上，第一参考直线为第一参考坐标与第一参考伪影坐标对应的直线，第二参考直线为第二参考坐标与第二参考伪影坐标对应的直线。208：基于第二参考线段的中点确定第二传感器的坐标；第二参考线段的第一端点位于第三参考直线上，第二参考线段的第二端点位于第四参考直线上，第三参考直线为第一参考坐标与第二参考伪影坐标对应的直线，第四参考直线为第二参考坐标与第一参考伪影坐标对应的直线。本实施例中，光学追踪设备的追踪范围内包括第一参考标记物和第二参考标记物。根据三个点确定一个平面原理，基于第二参考坐标、第一传感器的坐标以及第二传感器的坐标可以确定出参考平面，本申请实施例中，第一参考坐标与参考平面之间的距离小于或等于第三阈值，其中，上述第三阈值可以根据实际情况或经验值确定，本申请实施例对此不作限定，比如可以是10毫米，还可以是标记物的直径等。可选地，上述限定可以理解为第一参考标记物、第二参考标记物对应的直线与第一传感器、第二传感器对应的直线趋近平行。因此，上述限定也可以是第二参考坐标与参考平面之间的距离小于或等于第三阈值，参考平面是基于第一参考坐标、第一传感器的坐标以及第二传感器的坐标确定的；或者，第一传感器的坐标与参考平面之间的距离小于或等于第三阈值，参考平面是基于第一参考坐标、第二参考坐标以及第二传感器的坐标确定的；或者，第二传感器的坐标与参考平面之间的距离小于或等于第三阈值，参考平面是基于第一参考坐标、第二参考坐标以及第一传感器的坐标确定的。为便于理解，复用图3，图3中的标记物302和标记物303可以理解为参考标记物。在满足上述条件下，第一参考标记物和第二参考标记物将对应产生两个伪影坐标，那么电子设备将得到4个坐标。根据伪影产生原理，对于采集到的4个坐标，距离光学追踪设备所在坐标系的原点最近的坐标和最远的坐标为伪影坐标。那么，电子设备可以确定第一参考伪影坐标为采集到的坐标中距离光学追踪设备所在坐标系的原点最近的坐标，第二参考伪影坐标为采集到的坐标中距离光学追踪设备所在坐标系的原点最远的坐标。其余两个坐标分别为第一参考坐标和第二参考坐标。需要说明的是，本实施例中的参考标记物，以及参考标记物对应的参考坐标和参考伪影坐标用于确定传感器的坐标，不是前文实施例中需要进行伪影筛选的标记物以及候选坐标。可以理解，在基于第一参考线段的中点确定第一传感器的坐标，以及，基于第二参考线段的中点确定第二传感器的坐标时，可以采集多组测量数据进行拟合，以减小误差。为了更清楚地理解本申请实施例提供的方法，接下来从整体上对本申请实施例提供的方法进行介绍。为了便于描述，后文将第一传感器的坐标和第二传感器的坐标统称为双目坐标，其中，第一传感器为光学追踪设备上左边的传感器，用点A表示，第二传感器为光学追踪设备上右边的传感器，用点B表示。用于计算点A和点B的第一参考标记物用点表示，第一参考标记物用点/＞表示，第一参考伪影坐标用点D表示，第二参考伪影坐标用点C表示，最终结果如图5所示，图5是本申请实施例提供的一种计算双目坐标的示意图。可以理解，当两个标记物产生伪影坐标时，伪影坐标与两个标记物间的连线的延长线必将经过光学追踪设备的双目，即上述点A和点B，且如图5所示的直线和直线经过点A；直线/＞和直线/＞经过点B。因此，可以采用如图6所示的流程确定点A和点B的坐标。图6是本申请实施例提供的一种确定双目坐标的方法流程示意图。包括：601：放置两个参考标记物并开启光学追踪。602：采集标记物坐标。603：判断是否采集到4个坐标。在步骤603的判断结果为是的情况下，执行步骤605：从4个坐标中确定出真实坐标M1和M2以及伪影坐标C和D。在步骤603的判断结果为否的情况下，执行步骤604：调整两个参考标记物的摆放位置。然后重新执行步骤602。一般地，将两个参考标记物调整到与光学追踪设备趋近与平行即可得到4个坐标。步骤605之后，执行步骤606：求直线DM1与直线CM2的两个最近点的中点B’，求直线CM1与直线DM2的两个最近点的中点A’。607：记录坐标A’和坐标B’。608：判断是否继续采集。示例性地，可以设定采集50次或100次，在步骤607的执行次数小于预设次数的情况下，继续采集，在步骤607的执行次数等于预设次数的情况下，结束继续采集。在步骤608的判断结果为是的情况下，重新执行步骤602。在步骤608的判断结果为否的情况下，执行步骤609：对多组坐标A’和坐标B’求平均值，分别得到坐标A和坐标B。610：将坐标A和坐标B写入配置文件。接下来请参阅图7a和图7b，图7a是本申请实施例提供的另一种标记物的伪影坐标去除方法的流程示意图，图7b是本申请实施例提供的又一种标记物的伪影坐标去除方法的流程示意图。在已知点A和点B的坐标情况下，假设光学追踪设备采集到M个坐标，从M个坐标中任意取2个坐标，一共个组合，即/＞个坐标对，如图7a所示，包括：701：获取一个坐标对。其中，上述坐标对可以理解为个坐标对中的任一个。702：设坐标对的两个坐标为坐标P1、坐标P2。703：求直线AP1和直线BP2之间的距离d1。704：判断距离d1是否小于或等于标记物的直径。在步骤704的判断结果为是的情况下，执行步骤705：求直线AP1和直线BP2两个最近点的中点s。在步骤704的判断结果为否的情况下，执行步骤708：判断是否基于直线BP1和直线AP2做伪影坐标筛选。步骤705之后执行步骤706：判断除坐标P1、坐标P2之外的其他坐标是否落在以中点s为球心，标记物的半径为半径的目标区域内。在步骤706的判断结果为是的情况下，执行步骤707：将落入目标区域内的坐标作为伪影坐标。在步骤706的判断结果为否的情况下，执行步骤708：判断是否基于直线BP1和直线AP2做伪影坐标筛选。在步骤708的判断结果为是的情况下，执行步骤710：判断是否全部坐标对均完成伪影坐标筛选。在步骤708的判断结果为否的情况下，执行步骤709：求直线BP1和直线AP2之间的距离d1。在步骤710的判断结果为是的情况下，执行步骤711：记录得到的N个伪影坐标以及每个伪影坐标对应的坐标对。其中，N为大于或等于1的整数。在步骤710的判断结果为否的情况下，重新执行步骤701：获取一个坐标对。应理解，在步骤710之后重新执行步骤701时，选取的坐标对为剩下的未进行伪影坐标筛选的其他坐标对。如图7b所示，包括：712：获取一个伪影坐标以及对应的坐标对。713：判断该伪影坐标对应的坐标对是否均为伪影坐标。在步骤713的判断结果为是的情况下，执行步骤714：将该伪影坐标作为非伪影坐标。在步骤713的判断结果为否的情况下，重新执行步骤712：获取一个伪影坐标以及对应的坐标对。应理解，在步骤713之后重新执行步骤712时，选取的伪影坐标以及对应的坐标对为未被选取过的伪影坐标以及对应的坐标对。步骤714之后执行步骤715：判断是否遍历完全部N个伪影坐标以及对应的坐标对。在步骤715的判断结果为是的情况下，执行步骤716：输出伪影坐标和真实坐标。在步骤715的判断结果为否的情况下，重新执行步骤712：获取一个伪影坐标以及对应的坐标对。应理解，在步骤715之后重新执行步骤712时，选取的伪影坐标以及对应的坐标对为未被选取过的伪影坐标以及对应的坐标对。以上详细阐述了本申请实施例提供的方法，下面介绍本申请实施例提供的装置。请参阅图8，图8是本申请实施例提供的一种电子设备的结构示意图。如图8所示的电子设备80用于执行标记物的伪影去除方法，可以是上述标记物的伪影去除装置。如图8所示，电子设备80包括获取单元801、确定单元802以及去除单元803。其中，各个单元的描述如下：获取单元801，用于获取M个候选坐标，上述M个候选坐标为光学追踪设备对追踪范围内的标记物采集的坐标，上述光学追踪设备包括第一传感器和第二传感器，上述第一传感器和上述第二传感器用于接收上述光学追踪设备追踪范围内的标记物反射的光线以确定上述标记物的坐标；上述M为大于或等于3的整数；确定单元802，用于根据上述第一传感器的坐标和第一候选坐标确定第一直线，以及，根据上述第二传感器的坐标和第二候选坐标确定第二直线；上述第一候选坐标和上述第二候选坐标为上述M个候选坐标中任两个不同的候选坐标；确定单元802，还用于将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述第一直线之间的距离小于或等于第一阈值且与上述第二直线之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标；确定单元802，还用于基于上述M个候选坐标确定N个伪影坐标，上述N为大于或等于1的整数；去除单元803，用于从上述M个候选坐标中去除上述N个伪影坐标，得到上述追踪范围内的标记物的目标坐标。可选地，确定单元802，具体用于在上述第一直线与上述第二直线之间的距离小于或等于第二阈值的情况下，执行上述将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述第一直线之间的距离小于或等于第一阈值且与上述第二直线之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标步骤。可选地，确定单元802，具体用于确定目标线段的中点为参考点，上述目标线段为相交于上述第一直线和上述第二直线且距离最短的线段，上述目标线段的第一端点位于上述第一直线上，上述目标线段的第二端点位于上述第二直线上；确定单元802，具体用于将上述M个候选坐标中除上述第一候选坐标和上述第二候选坐标以外，与上述参考点之间的距离小于或等于上述第一阈值的候选坐标作为伪影坐标。可选地，去除单元803，具体用于在上述N大于或等于3的情况下，在上述N个伪影坐标不包括目标伪影坐标的情况下，执行上述从上述M个候选坐标中去除N个伪影坐标，得到上述追踪范围内的标记物的目标坐标步骤；用于确定上述目标伪影坐标的两个候选坐标均为伪影坐标。可选地，确定单元802，具体用于在上述N个伪影坐标中包括上述目标伪影坐标的情况下，基于上述N个伪影坐标确定K个伪影坐标，用于确定上述K个伪影坐标的候选坐标均不为伪影坐标，上述K为大于或等于1的整数；去除单元803，具体用于从上述M个候选坐标中去除上述K个伪影坐标，得到上述追踪范围内的标记物的目标坐标。可选地，获取单元801，还用于获取上述光学追踪设备对第一参考标记物和第二参考标记物采集的第一参考坐标，第二参考坐标，第一参考伪影坐标以及第二参考伪影坐标；上述第一参考坐标与参考平面之间的距离小于或等于第三阈值，上述参考平面是基于上述第二参考坐标、上述第一传感器的坐标以及上述第二传感器的坐标确定的；上述第一参考伪影坐标为采集到的坐标中距离上述光学追踪设备所在坐标系的原点最近的坐标，上述第二参考伪影坐标为采集到的坐标中距离上述光学追踪设备所在坐标系的原点最远的坐标；确定单元802，还用于基于第一参考线段的中点确定上述第一传感器的坐标；第一参考线段的第一端点位于第一参考直线上，上述第一参考线段的第二端点位于第二参考直线上，上述第一参考直线为上述第一参考坐标与上述第一参考伪影坐标对应的直线，上述第二参考直线为上述第二参考坐标与上述第二参考伪影坐标对应的直线；确定单元802，还用于基于第二参考线段的中点确定上述第二传感器的坐标；第二参考线段的第一端点位于第三参考直线上，上述第二参考线段的第二端点位于第四参考直线上，上述第三参考直线为上述第一参考坐标与上述第二参考伪影坐标对应的直线，上述第四参考直线为上述第二参考坐标与上述第一参考伪影坐标对应的直线。请参阅图9，图9是本申请实施例提供的另一种电子设备的结构示意图。如图9所示的电子设备90包括存储器901、处理器902。进一步可选的，还可以包含通信接口903以及总线904，其中，存储器901、处理器902以及通信接口903通过总线904实现彼此之间的通信连接。其中，存储器901用于提供存储空间，存储空间中可以存储操作系统和计算机程序等数据。存储器901包括但不限于是随机存储记忆体、只读存储器、可擦除可编程只读存储器、或便携式只读存储器。处理器902是进行算术运算和逻辑运算的模块，可以是中央处理器、显卡处理器或微处理器等处理模块中的一种或者多种的组合。存储器901中存储有计算机程序，处理器902调用存储器901中存储的计算机程序，以执行上述图像配准方法。示例性地，在上述电子设备90为上述电子设备80的情况下，获取单元801获取的内容可以由通信接口903实现，上述确定单元802以及去除单元803执行的步骤可以由处理器902实现。本申请还提供一种计算机可读存储介质，该计算机可读存储介质中存储有计算机代码，当计算机代码在计算机上运行时，使得计算机执行上述实施例的方法。本申请还提供一种计算机程序产品，该计算机程序产品包括计算机代码或计算机程序，当该计算机代码或计算机程序在计算机上运行时，使得上述实施例中的方法被执行。以上所述，仅为本申请的具体实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本申请的保护范围之内。因此，本申请的保护范围应以上述权利要求的保护范围为准。
