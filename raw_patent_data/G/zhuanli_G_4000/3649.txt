标题title
一种非常见工况下的污水处理过程的故障分类方法
摘要abst
本发明提供一种非常见工况下的污水处理过程的故障分类方法，首先分离出非平稳变量的过程数据，基于邻域保持成分分析的方法提取非平稳特征；然后基于典型相关分析的迁移学习方法减小源域和目标域正常数据的分布差异，获得投影后的源域和目标域数据；画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图，对两者做相似度分析，实现对目标域的第一次故障分类；如果目标域单类未带标签的故障数据的贡献图与源域多类带标签的故障数据的贡献图的相似度相同，将对应的投影后的源域多类带标签的故障数据训练支持向量机模型；根据对应的投影后的目标域少量带标签的故障数据更新支持向量机模型，实现对目标域的第二次故障分类。
权利要求书clms
1.一种非常见工况下的污水处理过程的故障分类方法，其特征在于，包括以下步骤：S1，采集污水处理过程数据，包括源域和目标域的历史数据，数据预处理后分离出非平稳变量的过程数据，基于邻域保持成分分析的方法提取非平稳特征；S2，基于典型相关分析的迁移学习方法减小源域和目标域正常数据的分布差异，获得投影后的源域和目标域的数据；S3，根据投影后的源域数据集训练故障检测模型，画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图，利用欧式距离和余弦距离对源域和目标域的贡献图做相似度分析，对目标域进行第一次故障分类；S4，如果目标域单类未带标签的故障数据的贡献图与源域多类带标签的故障数据的贡献图的相似度相同，将对应的投影后的源域多类带标签的故障数据训练支持向量机模型；根据对应的投影后的目标域少量带标签的故障数据更新支持向量机模型，最后将目标域单类未带标签的故障数据输入支持向量机模型，对目标域进行第二次故障分类。2.根据权利要求1所述的故障分类方法，其特征在于，所述步骤S1具体包括以下步骤：S11，采集污水处理过程数据，包含两类工况数据：常见工况即源域的正常数据集Xsc和带标签的故障数据集Xsf，非常见工况即目标域的少量的正常数据集Xtc和少量带标签的故障数据集Xtf；S12，分离出非平稳变量的过程数据；首先建立平稳性检验模型，对每组单变量的数据进行平稳性检验；根据平稳性检验结果，分离出非平稳变量的过程数据，获得常见工况即源域的非平稳变量的正常数据集和带标签的非平稳变量的故障数据集/＞获得非常见工况即目标域的非平稳变量的少量的正常数据集/＞和少量带标签的非平稳变量的故障数据集/＞S13，基于邻域保持成分分析的方法提取非平稳特征；对S12获得的数据进行归一化处理，得到源域的非平稳变量的正常数据集为：其中表示/＞的列向量，ns1表示源域的非平稳变量的正常数据集的样本数，ms表示源域的非平稳变量的正常数据集的变量数；源域的非平稳变量的带标签的故障数据集为：其中表示/＞的列向量，ns2表示源域的非平稳变量的带标签的故障数据集的样本数；目标域的非平稳变量的正常数据集为：其中表示/＞的列向量，nt1表示目标域的非平稳变量的正常数据集的样本数，mt表示目标域的非平稳变量的正常数据集的变量数；/＞目标域的非平稳变量的带标签的故障数据集为：其中表示/＞的列向量，nt2表示目标域的非平稳变量的带标签的故障数据集的样本数；以提取源域的正常数据集的非平稳特征为例，根据给定的核函数k，计算正定核矩阵K：其中，Kij表示正定核矩阵中的元素，表示/＞中的任意两列样本，/＞表示从原始特征空间到高维特征空间的一个核映射，/＞表示/＞的转置；计算中心核矩阵其中，Ik表示全为的ms阶方阵；计算矩阵所有特征值，对这些特征值进行排序，选择前p个特征值λ1≥λ2≥···≥λp，然后计算它们所对应的特征向量v1,v2,···,vp；特征提取矩阵W的第i个列向量wi为：其中λi和vi分别表示第i个特征值和对应的第i个特征向量，W＝；因此，的输出特征集Ysc的列向量ysci为：其中Ysc＝，表示/＞中的所有列向量，p表示保留的特征值的个数；利用K最近邻算法构建邻域图；Ysc＝，则邻域图共有p个结点，其中ysci表示第i个结点；如果yscj是ysci的k个最近邻居之一，那么将这两点连接，反之不连接；设权重矩阵为U，其中元素Uij代表结点i和结点j之间的边的权重，如果两点之间没有边，则对应的矩阵元素为0；矩阵U的元素值Uij主要通过最小化如下目标函数得到：其中U应满足归一化约束：邻域保持算法的思想是降维后的特征空间与原始高维空间具有相似的局部结构；通过求解广义特征向量问题来计算映射矩阵A：其中矩阵M＝T，矩阵IU＝diag，是特征值，a是特征向量，所有特征值按照从小到大的次序排列并保留前d个特征值/＞对应的前d个特征值对应的特征向量为a1,a2,…,ad，因此邻域保持算法降维后的数据为：其中A＝，降维后的数据矩阵为其中d表示矩阵/＞的变量的个数；因此，源域的正常数据的非平稳特征为源域的带标签的故障数据集的非平稳特征为/＞目标域的少量的正常数据的非平稳特征为/＞目标域的少量带标签的故障数据的非平稳特征为/＞3.根据权利要求2所述的故障分类方法，其特征在于，所述步骤S2具体包括以下步骤：根据步骤S1获得源域的正常数据的非平稳特征为目标域的少量的正常数据的非平稳特征为/＞将典型相关分析扩展到求解一对投影矩阵Ps,Pt的情况，因此有以下目标函数：Zsc和Ztc有如下约束：ZscZscT＝Id，ZtcZtcT＝Id其中，Zsc和Ztc分别是和/＞的投影，zsc和ztc分别是Zsc和Ztc的元素，trace表示矩阵的迹，Id表示全为1的d阶方阵；因此，上述目标函数表示为如下优化问题：s.t.ZscZscT＝IdZtcZtcT＝Id.源域的正常数据的非平稳特征变为源域的带标签的故障数据集的非平稳特征变为/＞目标域的少量的正常数据的非平稳特征变为/＞目标域的少量带标签的故障数据的非平稳特征变为/＞4.根据权利要求3所述的故障分类方法，其特征在于，所述步骤S3具体包括以下步骤：S31，根据投影后的源域数据集训练故障检测模型，画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图；源域的正常数据的非平稳特征变为Zsc，给定非平稳时间序列Zsc，计算参考均值和参考标准差：其中i表示第i个变量，μi是均值，σi是标准差，ns1是源域的正常数据的样本数，Iz是具有适当维数的全为1的向量，t是采样时刻，zsc,i是第i个变量，zsc,t,i是第t个采样时刻的第i个变量的值，因此，原始数据Zsc被归一化为：其中表示归一化的数据，μ＝，∑＝diag{σ1,σ2,…,σd}；利用Johansen多变量协整分析方法对选取的数据进行协整关系检验；如果一个时间序列经过一次差分变成平稳的，则称原序列是1阶单整的，记为I；假设所有时间序列都是1阶单整的；矢量误差修正模型描述为：式中其中是第t个时刻的时间序列，/＞是第t-1个时刻的时间序列；是第t-i个时刻的时间序列，/＞是第t-i-1个时刻的时间序列；εt为白噪声向量并服从高斯分布N，Ξ是高斯分布的方差，p是模型的阶次；Πi和Πj为系数矩阵，Im为随机矩阵，Im可以分解为Υ和Bf两个列满秩矩阵，Γ＝ΥBfT，Bf是协积分矩阵，Bf的列向量是协积分向量，Υ是一个辅助矩阵；根据Johansen多变量协整分析方法，Bf可以通过下面的似然函数L求解：利用特征值分解可以得到Bf的最大似然估计：其中E为预测误差，为特征值，系数矩阵Θi和Φi通过最小二乘方法得到；在线监测时，q+1时刻的长期的动态平稳关系表示为：/＞其中EB为反映了长期动态平稳关系的误差，Bf,q为第q个时刻的协积分矩阵，表示第q+1个时刻的时间序列；因此，监测统计量L2可以表示为：L2＝EBTEB其中，μL和sL分别为L2的均值和方差，表示卡方分布，g和h是参数，置信水平为α；监测统计量L2还可以表示为：第i个变量对L2的贡献可以表示为：其中eB,i表示EB的第i个元素，d表示源域正常数据的非平稳特征Zsc的变量个数；利用上述的故障检测模型画出源域带标签的故障数据的贡献图，作为先验知识储存；利用上述的故障检测模型再获取目标域未带标签的故障数据，进一步画出目标域未带标签的故障数据的贡献图；S32，利用欧式距离和余弦距离对源域和目标域的贡献图做相似度分析；源域和目标域的贡献图可以看作是很多副不同的直方图图像，计算目标域未带标签的故障数据的贡献图与源域所有带标签的故障数据的贡献图之间的图像相似度，找出与目标域贡献图的图像相似度最大的那一类源域的贡献图，此时对应的源域的故障标签即为目标域的故障类型；通过对图像进行处理，利用欧式距离表示图像之间的相似度，欧氏距离越小，相似度越大；n维空间中的欧式距离公式为：其中DEuc表示欧式距离，x和y表示n维空间中的两个点，x＝，y＝；通过对图像进行处理，也可以用余弦相似度表示图像之间的相似度，余弦相似度越大，相似度越大；余弦相似度把图片表示成一个向量，通过计算向量之间的余弦值来表征两张图片的相似度，余弦值接近1，夹角趋于0，表明两个向量越相似，余弦值接近于0，夹角趋于90度，表明两个向量越不相似；n维空间中的余弦相似度公式为：其中DCos表示余弦相似度，x和y表示n维空间中的两个点，x＝，y＝；因此，基于欧式距离和余弦相似度的图像相似度的计算公式为：其中DCE表示图像相似度，DCE越大，图像之间的相似度越大。5.根据权利要求4所述的故障分类方法，其特征在于，所述步骤S4具体包括以下步骤：支持向量机进行非线性分类时通过高维空间变换，将非线性分类变成高维空间的线性分类问题；假设大小为l的训练样本集{,i＝1,2,...,l}由两个类别组成，通过非线性映射Φ，将原始空间的样本映射到高维的特征空间中，对应的对偶问题变为：其中hi表示原始空间的样本，Φ表示hi映射到高维特征空间后的样本，vi是原始空间的样本对应的标签，F是对偶函数，β＝T是拉格朗日乘子，＜Φ,Φ＞表示内积，C为惩罚因子；设β的最优解为则/＞其中ω*是一个实数向量，从而得到最优的分类模型为：其中是f分类函数，sgn表示阶跃函数，b*是一个常数，＜Φ,Φ＞表示内积，表示核函数，这里采用高斯核函数。/＞
说明书desc
技术领域本发明涉及工业过程故障分类技术领域，尤其涉及一种非常见工况下的污水处理过程的故障分类方法。背景技术污水处理过程是一个具有多工况特点的复杂工业过程。增强故障检测的能力是保证污水处理过程安全稳定运行的关键。由于天气和季节的影响，污水处理过程一般具有非线性、多工况、多变量等特征。一般来说，污水处理过程的工况可以分为常见工况和非常见工况。常见工况的特点是带标签数据容易获取且有着大量的历史数据。非常见工况的特点是带标签数据不容易获取，而且只有少量的历史数据。非常见工况下的污水处理过程的故障分类模型不容易被建立，这是因为传统的数据驱动的故障分类方法如支持向量机、神经网络等方法均依赖于大量的历史数据。当历史数据不足时，就无法训练模型。此外，传统的数据驱动的故障分类模型会受到工况变化的影响，这是因为不同工况下提取到的数据特征是有差异的，而大多数数据驱动的故障分类方法没有考虑到这一点。除此之外，大多数故障分类方法如支持向量机、神经网络等都是先离线训练好分类模型，再进行故障分类。在数据量和故障类型比较多的情况下，这些方法训练模型所耗费的时间是比较长的。目前，数据驱动的故障分类方法在污水处理过程的非常见工况的故障分类问题上的应用有限，这些方法大多数应用于历史数据较多的常见工况中。传统方法建立的故障分类模型会受到工况变化的影响，这是因为常见工况和非常见工况提取到的数据特征是有差异的，而大多数方法在特征提取时没有考虑到工况变化的影响。另外，现有的大部分故障分类算法没有考虑从故障检测模型的基础上去开发算法。发明内容为了解决污水处理过程的非常见工况下因历史数据不足无法建立故障分类模型的问题，本发明提供一种非常见工况下的污水处理过程的故障分类方法，针对多工况的污水处理过程，采用迁移学习的策略将常见工况的故障分类模型迁移到非常见工况，同时提取数据的非平稳特征从而降低工况变化对系统模型的影响，采用基于邻域保持成分分析的特征提取方法，最后采用贡献图和支持向量机结合的方法实现对非常见工况下的故障分类。为解决上述技术问题，本发明的实施例提供如下方案：一种非常见工况下的污水处理过程的故障分类方法，包括以下步骤：S1，采集污水处理过程数据，包括源域和目标域的历史数据，数据预处理后分离出非平稳变量的过程数据，基于邻域保持成分分析的方法提取非平稳特征；S2，基于典型相关分析的迁移学习方法减小源域和目标域正常数据的分布差异，获得投影后的源域和目标域的数据；S3，根据投影后的源域数据集训练故障检测模型，画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图，利用欧式距离和余弦距离对源域和目标域的贡献图做相似度分析，对目标域进行第一次故障分类；S4，如果目标域单类未带标签的故障数据的贡献图与源域多类带标签的故障数据的贡献图的相似度相同，将对应的投影后的源域多类带标签的故障数据训练支持向量机模型；根据对应的投影后的目标域少量带标签的故障数据更新支持向量机模型，最后将目标域单类未带标签的故障数据输入支持向量机模型，对目标域进行第二次故障分类。优选地，所述步骤S1具体包括以下步骤：S11，采集污水处理过程数据，包含两类工况数据：常见工况即源域的正常数据集Xsc和带标签的故障数据集Xsf，非常见工况即目标域的少量的正常数据集Xtc和少量带标签的故障数据集Xtf；S12，分离出非平稳变量的过程数据；首先建立平稳性检验模型，对每组单变量的数据进行平稳性检验；根据平稳性检验结果，分离出非平稳变量的过程数据，获得常见工况即源域的非平稳变量的正常数据集和带标签的非平稳变量的故障数据集/＞获得非常见工况即目标域的非平稳变量的少量的正常数据集/＞和少量带标签的非平稳变量的故障数据集/＞S13，基于邻域保持成分分析的方法提取非平稳特征；对S12获得的数据进行归一化处理，得到源域的非平稳变量的正常数据集为：其中表示/＞的列向量，ns1表示源域的非平稳变量的正常数据集的样本数，ms表示源域的非平稳变量的正常数据集的变量数；源域的非平稳变量的带标签的故障数据集为：其中表示/＞的列向量，ns2表示源域的非平稳变量的带标签的故障数据集的样本数；目标域的非平稳变量的正常数据集为：其中表示/＞的列向量，nt1表示目标域的非平稳变量的正常数据集的样本数，mt表示目标域的非平稳变量的正常数据集的变量数；目标域的非平稳变量的带标签的故障数据集为：其中表示/＞的列向量，nt2表示目标域的非平稳变量的带标签的故障数据集的样本数；以提取源域的正常数据集的非平稳特征为例，根据给定的核函数k，计算正定核矩阵K：/＞其中，Kij表示正定核矩阵中的元素，表示/＞中的任意两列样本，/＞表示从原始特征空间到高维特征空间的一个核映射，/＞表示/＞的转置；计算中心核矩阵其中，Ik表示全为的ms阶方阵；计算矩阵所有特征值，对这些特征值进行排序，选择前p个特征值λ1≥λ2≥···≥λp，然后计算它们所对应的特征向量v1,v2,···,vp。特征提取矩阵W的第i个列向量wi为：其中λi和vi分别表示第i个特征值和对应的第i个特征向量，W＝；因此，的输出特征集Ysc的列向量ysci为：其中Ysc＝，表示/＞中的所有列向量，p表示保留的特征值的个数；利用K最近邻算法构建邻域图；Ysc＝，则邻域图共有p个结点，其中ysci表示第i个结点；如果yscj是ysci的k个最近邻居之一，那么将这两点连接，反之不连接；设权重矩阵为U，其中元素Uij代表结点i和结点j之间的边的权重，如果两点之间没有边，则对应的矩阵元素为0；矩阵U的元素值Uij主要通过最小化如下目标函数得到：其中U应满足归一化约束：邻域保持算法的思想是降维后的特征空间与原始高维空间具有相似的局部结构；通过求解广义特征向量问题来计算映射矩阵A：其中矩阵M＝T，矩阵IU＝diag，是特征值，a是特征向量，所有特征值按照从小到大的次序排列并保留前d个特征值/＞对应的前d个特征值对应的特征向量为a1,a2,…,ad，因此邻域保持算法降维后的数据为：/＞其中A＝，降维后的数据矩阵为其中d表示矩阵/＞的变量的个数；因此，源域的正常数据的非平稳特征为源域的带标签的故障数据集的非平稳特征为/＞目标域的少量的正常数据的非平稳特征为/＞目标域的少量带标签的故障数据的非平稳特征为/＞优选地，所述步骤S2具体包括以下步骤：根据步骤S1获得源域的正常数据的非平稳特征为目标域的少量的正常数据的非平稳特征为/＞将典型相关分析扩展到求解一对投影矩阵Ps,Pt的情况，因此有以下目标函数：Zsc和Ztc有如下约束：ZscZscT＝Id，ZtcZtcT＝Id其中，Zsc和Ztc分别是和/＞的投影，zsc和ztc分别是Zsc和Ztc的元素，trace表示矩阵的迹，Id表示全为1的d阶方阵；因此，上述目标函数表示为如下优化问题：s.t.ZscZscT＝IdZtcZtcT＝Id.源域的正常数据的非平稳特征变为源域的带标签的故障数据集的非平稳特征变为/＞目标域的少量的正常数据的非平稳特征变为/＞目标域的少量带标签的故障数据的非平稳特征变为/＞优选地，所述步骤S3具体包括以下步骤：S31，根据投影后的源域数据集训练故障检测模型，画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图；源域的正常数据的非平稳特征变为Zsc，给定非平稳时间序列Zsc，计算参考均值和参考标准差：/＞其中i表示第i个变量，μi是均值，σi是标准差，ns1是源域的正常数据的样本数，Iz是具有适当维数的全为1的向量，t是采样时刻，zsc,i是第i个变量，zsc,t,i是第t个采样时刻的第i个变量的值，因此，原始数据Zsc被归一化为：其中表示归一化的数据，μ＝，∑＝diag{σ1,σ2,…,σd}；利用Johansen多变量协整分析方法对选取的数据进行协整关系检验；如果一个时间序列经过一次差分变成平稳的，则称原序列是1阶单整的，记为I；假设所有时间序列/＞都是1阶单整的。矢量误差修正模型描述为：式中其中是第t个时刻的时间序列，/＞是第t-1个时刻的时间序列；/＞是第t-i个时刻的时间序列，/＞是第t-i-1个时刻的时间序列；εt为白噪声向量并服从高斯分布N，Ξ是高斯分布的方差，p是模型的阶次；Πi和Πj为系数矩阵，Im为随机矩阵，Im可以分解为Υ和Bf两个列满秩矩阵，Γ＝ΥBfT，Bf是协积分矩阵，Bf的列向量是协积分向量，Υ是一个辅助矩阵；根据Johansen多变量协整分析方法，Bf可以通过下面的似然函数L求解：利用特征值分解可以得到Bf的最大似然估计：其中E为预测误差，为特征值，系数矩阵Θi和Φi通过最小二乘方法得到；在线监测时，q+1时刻的长期的动态平稳关系表示为：其中EB为反映了长期动态平稳关系的误差，Bf,q为第q个时刻的协积分矩阵，表示第q+1个时刻的时间序列；因此，监测统计量L2可以表示为：L2＝EBTEB其中，μL和sL分别为L2的均值和方差，表示卡方分布，g和h是参数，置信水平为α；监测统计量L2还可以表示为：第i个变量对L2的贡献可以表示为：其中eB,i表示EB的第i个元素，d表示源域正常数据的非平稳特征Zsc的变量个数；利用上述的故障检测模型画出源域带标签的故障数据的贡献图，作为先验知识储存；利用上述的故障检测模型再获取目标域未带标签的故障数据，进一步画出目标域未带标签的故障数据的贡献图；S32，利用欧式距离和余弦距离对源域和目标域的贡献图做相似度分析；源域和目标域的贡献图可以看作是很多副不同的直方图图像，计算目标域未带标签的故障数据的贡献图与源域所有带标签的故障数据的贡献图之间的图像相似度，找出与目标域贡献图的图像相似度最大的那一类源域的贡献图，此时对应的源域的故障标签即为目标域的故障类型；通过对图像进行处理，利用欧式距离表示图像之间的相似度，欧氏距离越小，相似度越大；n维空间中的欧式距离公式为：其中DEuc表示欧式距离，x和y表示n维空间中的两个点，x＝，y＝；通过对图像进行处理，也可以用余弦相似度表示图像之间的相似度，余弦相似度越大，相似度越大；余弦相似度把图片表示成一个向量，通过计算向量之间的余弦值来表征两张图片的相似度，余弦值接近1，夹角趋于0，表明两个向量越相似，余弦值接近于0，夹角趋于90度，表明两个向量越不相似；n维空间中的余弦相似度公式为：其中DCos表示余弦相似度，x和y表示n维空间中的两个点，x＝，y＝；因此，基于欧式距离和余弦相似度的图像相似度的计算公式为：/＞其中DCE表示图像相似度，DCE越大，图像之间的相似度越大。优选地，所述步骤S4具体包括以下步骤：支持向量机进行非线性分类时通过高维空间变换，将非线性分类变成高维空间的线性分类问题；假设大小为l的训练样本集{,i＝1,2,…,l}由两个类别组成，通过非线性映射Φ，将原始空间的样本映射到高维的特征空间中，对应的对偶问题变为：其中hi表示原始空间的样本，Φ表示hi映射到高维特征空间后的样本，vi是原始空间的样本对应的标签，F是对偶函数，β＝T是拉格朗日乘子，＜Φ,Φ＞表示内积，C为惩罚因子；设β的最优解为则/＞其中ω*是一个实数向量，从而得到最优的分类模型为：其中是f分类函数，sgn表示阶跃函数，b*是一个常数，＜Φ,Φ＞表示内积，表示核函数，这里采用高斯核函数。本发明实施例提供的技术方案带来的有益效果至少包括：1)针对多工况的污水处理过程，基于邻域保持成分分析的特征提取方法提取过程数据的非平稳特征，可以减小常见工况和非常见工况下提取到的特征的差异，降低工况变化对系统模型的影响。2)针对多工况的污水处理过程，基于典型相关分析的迁移学习方法，解决了非常见工况因历史数据不足而无法建立故障诊断模型的问题。3)针对多工况的污水处理过程，开发了一种非常见工况下的污水处理过程的故障分类方法。贡献图分类是第一次故障分类，支持向量机分类是第二次故障分类，对第一次分类过程中未成功分类的故障进行分类。两者结合大大提高了在线监测时故障分类的效率，降低了模型复杂度且缩短了离线训练的时间。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例提供的一种非常见工况下的污水处理过程的故障分类方法的流程图；图2是根据本发明一实施例的污水处理过程的结构示意图；图3是根据本发明一实施例的雨天模式下带标签的故障A的贡献图；图4是根据本发明一实施例的雨天模式下带标签的故障B的贡献图；图5是根据本发明一实施例的雨天模式下带标签的故障C的贡献图；图6是根据本发明一实施例的雨天模式下带标签的故障D的贡献图；图7是根据本发明一实施例的目标域未带标签的故障1和故障2的支持向量机故障分类结果。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例的附图，对本发明实施例的技术方案进行清楚、完整地描述。显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。基于所描述的本发明的实施例，本领域普通技术人员在无需创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的实施例提供了一种非常见工况下的污水处理过程的故障分类方法，如图1所示，所述方法包括以下步骤：S1，采集污水处理过程数据，包括源域和目标域的历史数据，数据预处理后分离出非平稳变量的过程数据，基于邻域保持成分分析的方法提取非平稳特征。所述步骤S1具体包括：S11，采集污水处理过程数据，包含两类工况数据：常见工况即源域的正常数据集Xsc和带标签的故障数据集Xsf，非常见工况即目标域的少量的正常数据集Xtc和少量带标签的故障数据集Xtf；S12，分离出非平稳变量的过程数据；首先建立平稳性检验模型，对每组单变量的数据进行平稳性检验；根据平稳性检验结果，分离出非平稳变量的过程数据，获得常见工况即源域的非平稳变量的正常数据集和带标签的非平稳变量的故障数据集/＞获得非常见工况即目标域的非平稳变量的少量的正常数据集/＞和少量带标签的非平稳变量的故障数据集/＞S13，基于邻域保持成分分析的方法提取非平稳特征；对S12获得的数据进行归一化处理，得到源域的非平稳变量的正常数据集为：其中表示/＞的列向量，ns1表示源域的非平稳变量的正常数据集的样本数，ms表示源域的非平稳变量的正常数据集的变量数；源域的非平稳变量的带标签的故障数据集为：/＞其中表示/＞的列向量，ns2表示源域的非平稳变量的带标签的故障数据集的样本数；目标域的非平稳变量的正常数据集为：其中表示/＞的列向量，nt1表示目标域的非平稳变量的正常数据集的样本数，mt表示目标域的非平稳变量的正常数据集的变量数；目标域的非平稳变量的带标签的故障数据集为：其中表示/＞的列向量，nt2表示目标域的非平稳变量的带标签的故障数据集的样本数；以提取源域的正常数据集的非平稳特征为例，根据给定的核函数k，计算正定核矩阵K：其中，Kij表示正定核矩阵中的元素，表示/＞中的任意两列样本，/＞表示从原始特征空间到高维特征空间的一个核映射，/＞表示/＞的转置；计算中心核矩阵其中，Ik表示全为的ms阶方阵；计算矩阵所有特征值，对这些特征值进行排序，选择前p个特征值λ1≥λ2≥···≥λp，然后计算它们所对应的特征向量v1,v2,···,vp。特征提取矩阵W的第i个列向量wi为：其中λi和vi分别表示第i个特征值和对应的第i个特征向量，W＝；因此，的输出特征集Ysc的列向量ysci为：其中Ysc＝，表示/＞中的所有列向量，p表示保留的特征值的个数；利用K最近邻算法构建邻域图；Ysc＝，则邻域图共有p个结点，其中ysci表示第i个结点；如果yscj是ysci的k个最近邻居之一，那么将这两点连接，反之不连接；设权重矩阵为U，其中元素Uij代表结点i和结点j之间的边的权重，如果两点之间没有边，则对应的矩阵元素为0；矩阵U的元素值Uij主要通过最小化如下目标函数得到：其中U应满足归一化约束：邻域保持算法的思想是降维后的特征空间与原始高维空间具有相似的局部结构；通过求解广义特征向量问题来计算映射矩阵A：其中矩阵M＝T，矩阵IU＝diag，是特征值，a是特征向量，所有特征值按照从小到大的次序排列并保留前d个特征值/＞对应的前d个特征值对应的特征向量为a1,a2,…,ad，因此邻域保持算法降维后的数据为：其中A＝，降维后的数据矩阵为其中d表示矩阵/＞的变量的个数；因此，源域的正常数据的非平稳特征为源域的带标签的故障数据集的非平稳特征为/＞目标域的少量的正常数据的非平稳特征为/＞目标域的少量带标签的故障数据的非平稳特征为/＞S2，基于典型相关分析的迁移学习方法减小源域和目标域正常数据的分布差异，获得投影后的源域和目标域的数据。所述步骤S2具体包括：根据步骤S1获得源域的正常数据的非平稳特征为目标域的少量的正常数据的非平稳特征为/＞将典型相关分析扩展到求解一对投影矩阵Ps,Pt的情况，因此有以下目标函数：Zsc和Ztc有如下约束：ZscZscT＝Id，ZtcZtcT＝Id其中，Zsc和Ztc分别是和/＞的投影，zsc和ztc分别是Zsc和Ztc的元素，trace表示矩阵的迹，Id表示全为1的d阶方阵；/＞因此，上述目标函数表示为如下优化问题：s.t.ZscZscT＝IdZtcZtcT＝Id.源域的正常数据的非平稳特征变为源域的带标签的故障数据集的非平稳特征变为/＞目标域的少量的正常数据的非平稳特征变为/＞目标域的少量带标签的故障数据的非平稳特征变为/＞S3，根据投影后的源域数据集训练故障检测模型，画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图，利用欧式距离和余弦距离对源域和目标域的贡献图做相似度分析，对目标域进行第一次故障分类。所述步骤S3具体包括：S31，根据投影后的源域数据集训练故障检测模型，画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图；源域的正常数据的非平稳特征变为Zsc，给定非平稳时间序列Zsc，计算参考均值和参考标准差：其中i表示第i个变量，μi是均值，σi是标准差，ns1是源域的正常数据的样本数，Iz是具有适当维数的全为1的向量，t是采样时刻，zsc,i是第i个变量，zsc,t,i是第t个采样时刻的第i个变量的值，因此，原始数据Zsc被归一化为：其中表示归一化的数据，μ＝，∑＝diag{σ1,σ2,…,σd}；利用Johansen多变量协整分析方法对选取的数据进行协整关系检验；如果一个时间序列经过一次差分变成平稳的，则称原序列是1阶单整的，记为I；假设所有时间序列/＞都是1阶单整的。矢量误差修正模型描述为：式中其中是第t个时刻的时间序列，/＞是第t-1个时刻的时间序列；/＞是第t-i个时刻的时间序列，/＞是第t-i-1个时刻的时间序列；εt为白噪声向量并服从高斯分布N，Ξ是高斯分布的方差，p是模型的阶次；Πi和Πj为系数矩阵，Im为随机矩阵，Im可以分解为Υ和Bf两个列满秩矩阵，Γ＝ΥBfT，Bf是协积分矩阵，Bf的列向量是协积分向量，Υ是一个辅助矩阵；根据Johansen多变量协整分析方法，Bf可以通过下面的似然函数L求解：利用特征值分解可以得到Bf的最大似然估计：其中E为预测误差，为特征值，系数矩阵Θi和Φi通过最小二乘方法得到；在线监测时，q+1时刻的长期的动态平稳关系表示为：其中EB为反映了长期动态平稳关系的误差，Bf,q为第q个时刻的协积分矩阵，表示第q+1个时刻的时间序列；因此，监测统计量L2可以表示为：L2＝EBTEB其中，μL和sL分别为L2的均值和方差，表示卡方分布，g和h是参数，置信水平为α；监测统计量L2还可以表示为：第i个变量对L2的贡献可以表示为：其中eB,i表示EB的第i个元素，d表示源域正常数据的非平稳特征Zsc的变量个数；利用上述的故障检测模型画出源域带标签的故障数据的贡献图，作为先验知识储存；利用上述的故障检测模型再获取目标域未带标签的故障数据，进一步画出目标域未带标签的故障数据的贡献图；S32，利用欧式距离和余弦距离对源域和目标域的贡献图做相似度分析；源域和目标域的贡献图可以看作是很多副不同的直方图图像，计算目标域未带标签的故障数据的贡献图与源域所有带标签的故障数据的贡献图之间的图像相似度，找出与目标域贡献图的图像相似度最大的那一类源域的贡献图，此时对应的源域的故障标签即为目标域的故障类型；通过对图像进行处理，利用欧式距离表示图像之间的相似度，欧氏距离越小，相似度越大；n维空间中的欧式距离公式为：其中DEuc表示欧式距离，x和y表示n维空间中的两个点，x＝，y＝；通过对图像进行处理，也可以用余弦相似度表示图像之间的相似度，余弦相似度越大，相似度越大；余弦相似度把图片表示成一个向量，通过计算向量之间的余弦值来表征两张图片的相似度，余弦值接近1，夹角趋于0，表明两个向量越相似，余弦值接近于0，夹角趋于90度，表明两个向量越不相似；n维空间中的余弦相似度公式为：其中DCos表示余弦相似度，x和y表示n维空间中的两个点，x＝，y＝；因此，基于欧式距离和余弦相似度的图像相似度的计算公式为：其中DCE表示图像相似度，DCE越大，图像之间的相似度越大。S4，如果目标域单类未带标签的故障数据的贡献图与源域多类带标签的故障数据的贡献图的相似度相同，将对应的投影后的源域多类带标签的故障数据训练支持向量机模型；根据对应的投影后的目标域少量带标签的故障数据更新支持向量机模型，最后将目标域单类未带标签的故障数据输入支持向量机模型，对目标域进行第二次故障分类。所述步骤S4具体包括：支持向量机进行非线性分类时通过高维空间变换，将非线性分类变成高维空间的线性分类问题；假设大小为l的训练样本集{,i＝1,2,…,l}由两个类别组成，通过非线性映射Φ，将原始空间的样本映射到高维的特征空间中，对应的对偶问题变为：其中hi表示原始空间的样本，Φ表示hi映射到高维特征空间后的样本，vi是原始空间的样本对应的标签，F是对偶函数，β＝T是拉格朗日乘子，＜Φ,Φ＞表示内积，C为惩罚因子；设β的最优解为则/＞其中ω*是一个实数向量，从而得到最优的分类模型为：/＞其中是f分类函数，sgn表示阶跃函数，b*是一个常数，＜Φ,Φ＞表示内积，表示核函数，这里采用高斯核函数。本发明实施例中，针对多工况的污水处理过程，在非常见工况缺乏大量历史数据的条件下，利用污水处理过程的常见工况的历史数据，通过迁移学习实现对非常见工况的故障分类。下面以收集来自污水处理过程的BMS1模型的运行数据为例，对本发明提供的一种非常见工况下的污水处理过程的故障分类方法的有效性进行详细的说明，具体步骤包括：步骤1、建立污水处理过程的BMS1模型，采集污水处理过程中的实际运行数据，一共有晴天、雨天、暴雨三种工况，三种工况可以分为常见工况和非常见工况，假设常见工况为源域，非常见工况为目标域，对数据集进行预处理。在预处理后的过程数据中分离出非平稳变量构成非平稳数据集，基于邻域保持成分分析的方法提取非平稳特征。步骤2、基于典型相关分析的迁移学习方法减小源域和目标域正常数据的分布差异，获得投影后的源域和目标域的正常和故障数据集。步骤3、根据投影后的源域数据集训练故障检测模型，画出源域带标签的故障数据的贡献图和目标域未带标签的故障数据的贡献图，利用欧式距离和余弦距离对源域和目标域的贡献图做相似度分析。步骤4、如果目标域单类未带标签的故障数据的贡献图与源域多类带标签的故障数据的贡献图的相似度相同，将对应的投影后的源域多类带标签的故障数据训练支持向量机模型；根据对应的投影后的目标域少量带标签的故障数据集更新支持向量机模型，最后将目标域单类未带标签的故障数据输入支持向量机模型。采用污水处理过程的BMS1模型的运行数据进行仿真。如图2所示，污水处理模型由1个生物反应器和1个二次沉淀池组成，生物反应器包括5个混合完全的小单元。整个污水处理过程共收集27个过程变量，在数据预处理时分离出了共7个非平稳变量，整个污水处理过程共采集了14天的运行数据，数据采样间隔为4次/小时。所有数据根据工况可以划分为晴天、雨天、暴雨三种数据集，每一种工况的运行数据包括正常数据和故障数据。三种工况可以分为常见工况和非常见工况，假设常见工况雨天为源域，非常见工况暴雨为目标域，源域含有大量带标签的故障数据和正常数据，目标域含有少量带标签的故障数据和正常数据，假设源域和目标域的故障的类型相同，共有四类故障。源域带标签的四类故障的贡献图与目标域未带标签的四类故障的贡献图的图像相似度分析的结果如表1所示，根据表格结果得到，目标域中只有故障3和故障4可以通过贡献图分类确定故障类型，目标域故障3的类型是源域故障C，目标域故障4的类型是源域故障D，目标域的故障1与源域的故障A和故障B的图像相似度基本一致，目标域的故障2也与源域的故障A和故障B的图像相似度基本一致。表1源域和目标域四类贡献图图像相似度分析结果图像相似度源域故障A源域故障B源域故障C源域故障D目标域故障149.279950.68012.06722.7584目标域故障255.972250.39525.72632.3676目标域故障35.03515.2944185.70774.5461目标域故障41.44481.51352.330553.4451因此，目标域的故障1和故障2需要在支持向量机模型中进行分类。首先利用源域带标签的故障A和故障B的数据训练支持向量机模型，再利用目标域少量带标签的故障A和故障B的数据训练模型，微调模型参数，直到模型分类的准确率最高。支持向量机模型的训练样本集为190，测试集样本为82。本实施例对基于贡献图和支持向量机的非常见工况下的故障分类方法的实验结果如图3、图4、图5、图6和图7所示。其中，图3是根据本实施例画出的源域带标签的故障A的贡献图，图4是根据本实施例画出的源域带标签的故障B的贡献图，图5是根据本实施例画出的源域带标签的故障C的贡献图，图6是根据本实施例画出的源域带标签的故障D的贡献图，图7是根据本实施例，假设常见工况雨天为源域，非常见工况暴雨为目标域，把源域训练好的支持向量机模型迁移到目标域，画出的支持向量机模型对目标域未带标签的故障1和故障2的分类结果。与现有技术相比，本发明提供的一种非常见工况下的污水处理过程的故障分类方法，具有以下有益效果：1)针对多工况的污水处理过程，基于邻域保持成分分析的特征提取方法提取过程数据的非平稳特征，可以减小常见工况和非常见工况下提取到的特征的差异，降低工况变化对系统模型的影响。2)针对多工况的污水处理过程，基于典型相关分析的迁移学习方法，解决了非常见工况因历史数据不足而无法建立故障诊断模型的问题。3)针对多工况的污水处理过程，开发了一种非常见工况下的污水处理过程的故障分类方法。贡献图分类是第一次故障分类，支持向量机分类是第二次故障分类，对第一次分类过程中未成功分类的故障进行分类。两者结合大大提高了在线监测时故障分类的效率，降低了模型复杂度且缩短了离线训练的时间。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者终端设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者终端设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者终端设备中还存在另外的相同要素。在说明书中提到“一个实施例”、“实施例”、“示例性实施例”、“一些实施例”等指示所述的实施例可以包括特定特征、结构或特性，但未必每个实施例都包括该特定特征、结构或特性。另外，在结合实施例描述特定特征、结构或特性时，结合其它实施例实现这种特征、结构或特性应在相关领域技术人员的知识范围内。本发明涵盖任何在本发明的精髓和范围上做的替代、修改、等效方法以及方案。为了使公众对本发明有彻底的了解，在以下本发明优选实施例中详细说明了具体的细节，而对本领域技术人员来说没有这些细节的描述也可以完全理解本发明。另外，为了避免对本发明的实质造成不必要的混淆，并没有详细说明众所周知的方法、过程、流程、元件和电路等。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分步骤是可以通过程序来指令相关的硬件来完成，该程序可以存储于计算机可读取存储介质中，如：ROM/RAM、磁碟、光盘等。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
