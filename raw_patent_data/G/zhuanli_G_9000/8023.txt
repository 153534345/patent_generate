标题title
基于浏览器和办公软件客户端进行文档比对的方法
摘要abst
本发明公开了基于浏览器和办公软件客户端进行文档比对的方法，包括：用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮；WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，判断用户本地Office客户端是否下载和打开；若没有下载，则下载相应的版本，若没有打开，则唤起用户本地Office客户端；若已下载并打开，WEB应用和用户本地Office客户端之间建立交互关系；Office本地客户端JS加载项通过WEB应用传入的待对比文档和基准文档的在线下载地址，下载相应文件，打开文档比对窗口对文档进行比对。以WEB应用为实现载体，兼顾了BS架构用户交互体验良好、数据集中管理和本地Office客户端文档编辑能力强大和稳定。
权利要求书clms
1.基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，包括：S100，用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮；S200，WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，判断用户本地Office客户端是否下载和打开；S300，若没有下载，则下载相应的版本，若没有打开，则唤起用户本地Office客户端；若已下载并打开，WEB应用和用户本地Office客户端之间建立交互关系；S400，Office本地客户端JS加载项通过WEB应用传入的待对比文档和基准文档的在线下载地址，下载相应文件，打开文档比对窗口对文档进行比对。2.根据权利要求1所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述S200包括：S201，WEB应用通过浏览器向用户本地Office客户端伺服进程一组发送指令为：检测用户本地是否安装了匹配的Office客户端及版本；若不支持检测到的版本，则提示用户安装匹配的Office客户端及版本，并提供Office客户端的下载链接；S202，WEB应用通过浏览器向用户本地Office客户端伺服进程另一组发送指令为：判断用户Office客户端是否打开；如果没有打开就唤起用户本地Office客户端。3.根据权利要求2所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述S202步骤之后，包括：S203，Office本地客户端启动过程中，判断安装插件目录是否存在JS加载项；S204，若存在JS加载项，检测JS加载项版本是否为最新版本；若不是最新版本，启用加载项开关，配置更新JS加载项到相应位置；S205，若不存在JS加载项，用户设置本地Office客户端，启用加载项开关，配置JS加载项在线地址下载到相应位置。4.根据权利要求2所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述S202中唤起用户本地Office客户端包括：S2021，对用户使用率高的Office客户端进行兼容性设计，所述用户使用率高的Office客户端包括：WPS、微软Office。5.根据权利要求4所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述S2021包括：用户本地WPS客户端的监听进程wpscloudsvr.exe提供HTTP和HTTPS两种通信协议；两种通信协议分别对应58890端口和58891端口；浏览器通过传参data进行数据交互，其中，data传参的格式为：ksowebstartupwps://base64，为封装好的动作和参数。6.根据权利要求2所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述S201之前，包括：开发JS加载项，以HTTP/HTTPS通信为基础，实现JS加载项与WEB应用之间安全认证、API调用的业务逻辑；所述JS加载项是基于Web技术用来扩展应用程序的方式，JS加载项的底层是以Chromium开源浏览器项目为基础进行的优化扩展；一个JS加载项中的多个网页形成了一个整体，相互之间进行数据共享。7.根据权利要求1所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述S400中打开文档比对窗口对文档进行比对包括：S401，文档比对窗口的右侧分为上下两部分，上部分显示基准文档，右侧下部分显示待对比文档；S402，文档比对窗口左侧显示待对比文档的内容，该内容包括：与基准文档内容、格式有差异的部分通过为红色字体和下划线标识；S403，用户根据文档比对内容差异，修改窗口左侧待对比文档，点击保存后待对比文档回传到WEB应用服务器，实现了应用数据的集中管理。8.根据权利要求1所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述待对比文档和基准文档的格式包括：doc、docx、wps。9.根据权利要求1所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述WEB应用提供文件上传下载、文件列表API，同时提供JS加载项的在线下载地址。10.根据权利要求1所述的基于浏览器和办公软件客户端进行文档比对的方法，其特征在于，所述S400之后，包括：设置共同修改模式；在所述共同修改模式下，所有待对比文档同时被打开和修改；当同一待对比文档同时被打开时，对该被打开行为设置打开标记，当该待对比文档执行保存动作时设置保存标记，并对应保存时间；所述保存标记包括：编辑操作内容、编辑对象、编辑记录、存储地址；WEB应用按照设定时间和设定频率读取所述存储地址，获得存储地址中包含保存标记的待对比文档；基于保存标记对应的保存时间同步该待对比文档的所有编辑操作内容。
说明书desc
技术领域本发明涉及文档比对技术领域，具体涉及基于浏览器和办公软件客户端进行文档比对的方法。背景技术在企业信息化建设中，涉及到文档模板的业务场景，一般都会有文档比对功能的需求。目前，实现文档比对功能的方式一般有两种：一是采购市面上插件类文档编辑产品，实现文档比对；二是从系统WEB应用中下载文档到本地，通过本地Office客户端进行文档比对。通过用户本地办公软件客户端实现文档比对，操作复杂，用户交互体验较差。WPS云办公、石墨文档等在线产品用户交互体验不错，但是由于它们更侧重文档协同，文档编辑能力相对较弱，缺乏文档比对功能。软航、金格、PageOffice、WebOffice等插件类产品文档编辑能力强，可以实现文档比对，但对本地操作系统和本地office软件依赖较高，浏览器兼容性较差，文档比对功能不稳定。发明内容本发明提供基于浏览器和办公软件客户端进行文档比对的方法，以解决现有技术中存在的上述问题。本发明提供基于浏览器和办公软件客户端进行文档比对的方法，该方法包括：S100，用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮；S200，WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，判断用户本地Office客户端是否下载和打开；S300，若没有下载，则下载相应的版本，若没有打开，则唤起用户本地Office客户端；若已下载并打开，WEB应用和用户本地Office客户端之间建立交互关系；S400，Office本地客户端JS加载项通过WEB应用传入的待对比文档和基准文档的在线下载地址，下载相应文件，打开文档比对窗口对文档进行比对。优选的，所述S200包括：S201，WEB应用通过浏览器向用户本地Office客户端伺服进程一组发送指令为：检测用户本地是否安装了匹配的Office客户端及版本；若不支持检测到的版本，则提示用户安装匹配的Office客户端及版本，并提供Office客户端的下载链接；S202，WEB应用通过浏览器向用户本地Office客户端伺服进程另一组发送指令为：判断用户Office客户端是否打开；如果没有打开就唤起用户本地Office客户端。优选的，所述S202步骤之后，包括：S203，Office本地客户端启动过程中，判断安装插件目录是否存在JS加载项；S204，若存在JS加载项，检测JS加载项版本是否为最新版本；若不是最新版本，启用加载项开关，配置更新JS加载项到相应位置；S205，若不存在JS加载项，用户设置本地Office客户端，启用加载项开关，配置JS加载项在线地址下载到相应位置。优选的，所述S202中唤起用户本地Office客户端包括：S2021，对用户使用率高的Office客户端进行兼容性设计，所述用户使用率高的Office客户端包括：WPS、微软Office。优选的，所述S2021包括：用户本地WPS客户端的监听进程wpscloudsvr.exe提供HTTP和HTTPS两种通信协议；两种通信协议分别对应58890端口和58891端口；浏览器通过传参data进行数据交互，其中，data传参的格式为：ksowebstartupwps://base64，为封装好的动作和参数。优选的，所述S201之前，包括：开发JS加载项，以HTTP/HTTPS通信为基础，实现JS加载项与WEB应用之间安全认证、API调用的业务逻辑；所述JS加载项是基于Web技术用来扩展应用程序的方式，JS加载项的底层是以Chromium开源浏览器项目为基础进行的优化扩展；一个JS加载项中的多个网页形成了一个整体，相互之间进行数据共享。优选的，所述S400中打开文档比对窗口对文档进行比对包括：S401，文档比对窗口的右侧分为上下两部分，上部分显示基准文档，右侧下部分显示待对比文档；S402，文档比对窗口左侧显示待对比文档的内容，该内容包括：与基准文档内容、格式有差异的部分通过为红色字体和下划线标识；S403，用户根据文档比对内容差异，修改窗口左侧待对比文档，点击保存后待对比文档回传到WEB应用服务器，实现了应用数据的集中管理。优选的，所述待对比文档和基准文档的格式包括：doc、docx、wps。优选的，所述WEB应用提供文件上传下载、文件列表API，同时提供JS加载项的在线下载地址。优选的，所述S400之后，包括：设置共同修改模式；在所述共同修改模式下，所有待对比文档同时被打开和修改；当同一待对比文档同时被打开时，对该被打开行为设置打开标记，当该待对比文档执行保存动作时设置保存标记，并对应保存时间；所述保存标记包括：编辑操作内容、编辑对象、编辑记录、存储地址；WEB应用按照设定时间和设定频率读取所述存储地址，获得存储地址中包含保存标记的待对比文档；基于保存标记对应的保存时间同步该待对比文档的所有编辑操作内容。与现有技术相比，本发明具有以下优点：本发明提供基于浏览器和办公软件客户端进行文档比对的方法，包括：用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮；WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，判断用户本地Office客户端是否下载和打开；若没有下载，则下载相应的版本，若没有打开，则唤起用户本地Office客户端；若已下载并打开，WEB应用和用户本地Office客户端之间建立交互关系；Office本地客户端JS加载项通过WEB应用传入的待对比文档和基准文档的在线下载地址，下载相应文件，打开文档比对窗口对文档进行比对。以WEB应用为实现载体，兼顾了BS架构用户交互体验良好、数据集中管理和本地Office客户端文档编辑能力强大、稳定的优点，提供了企业信息化建设中文档比对功能最佳技术实践。另外，1，文档比对实现方式创新。从集成的角度入手，分析现有解决方案的优缺点，取长补短，以WEB应用为载体，整合BS架构用户交互体验良好、数据集中管理和本地Office客户端文档编辑能力强大、稳定的优点。2，文档比对采用新技术方法。JS加载项技术建立起WEB应用和用户本地Office客户端交互的桥梁，支持Office客户端通过HTTPS/HTTP协议调用WEB应用API，支持WEB应用通过Socket监听处理Office客户端事件，实现与业务应用数据的闭环，简化了用户的操作步骤，提升了用户的交互体验。3，兼容性设计。不同的Office客户端对JS加载项技术、浏览器唤起客户端技术的支持方式可能存在差异，在WEB应用建设过程中，接合实际情况筛选出用户使用较多Office客户端，进行兼容性设计。对于用户使用较少Office客户端，提示用户安装匹配的Office客户端。尽量减少WEB应用对用户本地Office客户端的捆绑效应，降低用户接入成本。本发明的其它特征和优点将在随后的说明书中阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点可通过在所写的说明书、权利要求书、以及附图中所特别指出的结构来实现和获得。下面通过附图和实施例，对本发明的技术方案做进一步的详细描述。附图说明附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。在附图中：图1为本发明实施例中基于浏览器和办公软件客户端进行文档比对的方法的流程图；图2为本发明实施例中判断用户本地Office客户端是否下载和打开的方法流程图；图3为本发明实施例中打开文档比对窗口对文档进行比对的方法流程图。具体实施方式以下结合附图对本发明的优选实施例进行说明，应当理解，此处所描述的优选实施例仅用于说明和解释本发明，并不用于限定本发明。本发明实施例提供了基于浏览器和办公软件客户端进行文档比对的方法，请参照图1，该方法包括以下几个步骤：S100，用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮；S200，WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，判断用户本地Office客户端是否下载和打开；S300，若没有下载，则下载相应的版本，若没有打开，则唤起用户本地Office客户端；若已下载并打开，WEB应用和用户本地Office客户端之间建立交互关系；S400，Office本地客户端JS加载项通过WEB应用传入的待对比文档和基准文档的在线下载地址，下载相应文件，打开文档比对窗口对文档进行比对。上述技术方案的工作原理为：本实施例采用的方案是用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮；WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，判断用户本地Office客户端是否下载和打开；若没有下载，则下载相应的版本，若没有打开，则唤起用户本地Office客户端；若已下载并打开，WEB应用和用户本地Office客户端之间建立交互关系；Office本地客户端JS加载项通过WEB应用传入的待对比文档和基准文档的在线下载地址，下载相应文件，打开文档比对窗口对文档进行比对。实现流程：1、用户设置本地Office客户端。启用加载项开关，配置JS加载项在线地址。2、开发JS加载项。以HTTP/HTTPS通信为基础，实现JS加载项与WEB应用之间安全认证、API调用等业务逻辑。3、WEB应用提供文件上传下载、文件列表API，提供JS加载项的在线下载地址。4、用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮。5、WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，一是检测用户本地是否安装了匹配的Office客户端及版本，如果不支持提示用户安装推荐Office客户端及版本，提供下载链接；二是判断用户Office客户端是否打开，如果没有打开就唤起用户本地Office客户端。6、Office本地客户端启动过程中，判断安装插件目录是否存在JS加载项、JS加载项版本是否为最新版本，如果不是就会通过步骤一配置的JS加载项地址下载或更新JS加载项到相应位置。7、随着用户本地Office客户端打开，JS加载项完成加载，WEB应用和用户本地Office客户端建立起交互的桥梁。8、Office本地客户端JS加载项通过步骤三传入的待对比文档和基准文档在线地址，下载相应文件，随后打开文档比对窗口，右侧分为上下两部分，上部分显示基准文档，右侧下部分显示待对比文档；窗口左侧显示待对比文档的内容，与基准文档内容、格式有差异的部分通过为红色字体和下划线标识。9、用户根据文档比对内容差异，修改窗口左侧待对比文档，点击保存后待对比文档回传到WEB应用服务器，实现了应用数据的集中管理。上述技术方案的有益效果为：采用本实施例提供的方案用户通过浏览器打开WEB应用页面，查询文件列表，选择待对比文档和基准文档，点击页面上的文档比对按钮；WEB应用通过浏览器向用户本地Office客户端伺服进程两组发送指令，判断用户本地Office客户端是否下载和打开；若没有下载，则下载相应的版本，若没有打开，则唤起用户本地Office客户端；若已下载并打开，WEB应用和用户本地Office客户端之间建立交互关系；Office本地客户端JS加载项通过WEB应用传入的待对比文档和基准文档的在线下载地址，下载相应文件，打开文档比对窗口对文档进行比对。本实施例以WEB应用为实现载体，兼顾了BS架构用户交互体验良好、数据集中管理和本地Office客户端文档编辑能力强大、稳定的优点，提供了企业信息化建设中文档比对功能最佳技术实践。另外，1，文档比对实现方式创新。从集成的角度入手，分析现有解决方案的优缺点，取长补短，以WEB应用为载体，整合BS架构用户交互体验良好、数据集中管理和本地Office客户端文档编辑能力强大、稳定的优点。2，文档比对采用新技术方法。JS加载项技术建立起WEB应用和用户本地Office客户端交互的桥梁，支持Office客户端通过HTTPS/HTTP协议调用WEB应用API，支持WEB应用通过Socket监听处理Office客户端事件，实现与业务应用数据的闭环，简化了用户的操作步骤，提升了用户的交互体验。3，兼容性设计。不同的Office客户端对JS加载项技术、浏览器唤起客户端技术的支持方式可能存在差异，在WEB应用建设过程中，接合实际情况筛选出用户使用较多Office客户端，进行兼容性设计。对于用户使用较少Office客户端，提示用户安装匹配的Office客户端。尽量减少WEB应用对用户本地Office客户端的捆绑效应，降低用户接入成本。在另一实施例中，所述S200包括：S201，WEB应用通过浏览器向用户本地Office客户端伺服进程一组发送指令为：检测用户本地是否安装了匹配的Office客户端及版本；若不支持检测到的版本，则提示用户安装匹配的Office客户端及版本，并提供Office客户端的下载链接；S202，WEB应用通过浏览器向用户本地Office客户端伺服进程另一组发送指令为：判断用户Office客户端是否打开；如果没有打开就唤起用户本地Office客户端。上述技术方案的工作原理为：本实施例采用的方案是WEB应用通过浏览器向用户本地Office客户端伺服进程一组发送指令为：检测用户本地是否安装了匹配的Office客户端及版本；若不支持检测到的版本，则提示用户安装匹配的Office客户端及版本，并提供Office客户端的下载链接；WEB应用通过浏览器向用户本地Office客户端伺服进程另一组发送指令为：判断用户Office客户端是否打开；如果没有打开就唤起用户本地Office客户端。上述技术方案的有益效果为：采用本实施例提供的方案WEB应用通过浏览器向用户本地Office客户端伺服进程一组发送指令为：检测用户本地是否安装了匹配的Office客户端及版本；若不支持检测到的版本，则提示用户安装匹配的Office客户端及版本，并提供Office客户端的下载链接；WEB应用通过浏览器向用户本地Office客户端伺服进程另一组发送指令为：判断用户Office客户端是否打开；如果没有打开就唤起用户本地Office客户端。在另一实施例中，请参照图2，所述S202步骤之后，包括：S203，Office本地客户端启动过程中，判断安装插件目录是否存在JS加载项；S204，若存在JS加载项，检测JS加载项版本是否为最新版本；若不是最新版本，启用加载项开关，配置更新JS加载项到相应位置；S205，若不存在JS加载项，用户设置本地Office客户端，启用加载项开关，配置JS加载项在线地址下载到相应位置。上述技术方案的工作原理为：本实施例采用的方案是Office本地客户端启动过程中，判断安装插件目录是否存在JS加载项；若存在JS加载项，检测JS加载项版本是否为最新版本；若不是最新版本，启用加载项开关，配置更新JS加载项到相应位置；若不存在JS加载项，用户设置本地Office客户端，启用加载项开关，配置JS加载项在线地址下载到相应位置。上述技术方案的有益效果为：采用本实施例提供的方案Office本地客户端启动过程中，判断安装插件目录是否存在JS加载项；若存在JS加载项，检测JS加载项版本是否为最新版本；若不是最新版本，启用加载项开关，配置更新JS加载项到相应位置；若不存在JS加载项，用户设置本地Office客户端，启用加载项开关，配置JS加载项在线地址下载到相应位置。在另一实施例中，所述S202中唤起用户本地Office客户端包括：S2021，对用户使用率高的Office客户端进行兼容性设计，所述用户使用率高的Office客户端包括：WPS、微软Office。上述技术方案的工作原理为：本实施例采用的方案是所述S202中唤起用户本地Office客户端包括：S2021，对用户使用率高的Office客户端进行兼容性设计，所述用户使用率高的Office客户端包括：WPS、微软Office。上述技术方案的有益效果为：采用本实施例提供的方案所述S202中唤起用户本地Office客户端包括：S2021，对用户使用率高的Office客户端进行兼容性设计，所述用户使用率高的Office客户端包括：WPS、微软Office。在另一实施例中，所述S2021包括：用户本地WPS客户端的监听进程wpscloudsvr.exe提供HTTP和HTTPS两种通信协议；两种通信协议分别对应58890端口和58891端口；浏览器通过传参data进行数据交互，其中，data传参的格式为：ksowebstartupwps://base64，为封装好的动作和参数。上述技术方案的工作原理为：本实施例采用的方案是用户本地WPS客户端的监听进程wpscloudsvr.exe提供HTTP和HTTPS两种通信协议；两种通信协议分别对应58890端口和58891端口；浏览器通过传参data进行数据交互，其中，data传参的格式为：ksowebstartupwps://base64，为封装好的动作和参数。上述技术方案的有益效果为：采用本实施例提供的方案浏览器唤起Office客户端技术，不同的Office客户端支持的浏览器唤起的方式有所不同，鉴于不同Office客户端支持浏览器唤起方法的差异，在实现WEB应用唤起浏览器过程中，对用户使用率高的Office客户端进行兼容性设计。在另一实施例中，所述S201之前，包括：开发JS加载项，以HTTP/HTTPS通信为基础，实现JS加载项与WEB应用之间安全认证、API调用的业务逻辑；所述JS加载项是基于Web技术用来扩展应用程序的方式，JS加载项的底层是以Chromium开源浏览器项目为基础进行的优化扩展；一个JS加载项中的多个网页形成了一个整体，相互之间进行数据共享。上述技术方案的工作原理为：本实施例采用的方案是开发JS加载项，以HTTP/HTTPS通信为基础，实现JS加载项与WEB应用之间安全认证、API调用的业务逻辑；所述JS加载项是基于Web技术用来扩展应用程序的方式，JS加载项的底层是以Chromium开源浏览器项目为基础进行的优化扩展；一个JS加载项中的多个网页形成了一个整体，相互之间进行数据共享。上述技术方案的有益效果为：采用本实施例提供的方案JS加载项是一套基于Web技术用来扩展应用程序的解决方案。JS加载项建立了WEB应用和本地Office客户端的桥梁，实现了WEB应用网页与应用程序的交互，同时一个加载项中的多个网页形成了一个整体，相互之间可以进行数据共享。开发者不必关注浏览器兼容的问题，因为加载项的底层是以Chromium开源浏览器项目为基础进行的优化扩展。加载项具备快速开发、轻量化、跨平台的特性，目前已针对Winows/Linux操作系统进行适配。在另一实施例中，请参照图3，所述S400中打开文档比对窗口对文档进行比对包括：S401，文档比对窗口的右侧分为上下两部分，上部分显示基准文档，右侧下部分显示待对比文档；S402，文档比对窗口左侧显示待对比文档的内容，该内容包括：与基准文档内容、格式有差异的部分通过为红色字体和下划线标识；S403，用户根据文档比对内容差异，修改窗口左侧待对比文档，点击保存后待对比文档回传到WEB应用服务器，实现了应用数据的集中管理。上述技术方案的工作原理为：本实施例采用的方案是打开文档比对窗口对文档进行比对包括：文档比对窗口的右侧分为上下两部分，上部分显示基准文档，右侧下部分显示待对比文档；文档比对窗口左侧显示待对比文档的内容，该内容包括：与基准文档内容、格式有差异的部分通过为红色字体和下划线标识；用户根据文档比对内容差异，修改窗口左侧待对比文档，点击保存后待对比文档回传到WEB应用服务器，实现了应用数据的集中管理。上述技术方案的有益效果为：采用本实施例提供的方案以WEB应用为实现载体，兼顾了BS架构用户交互体验良好、数据集中管理和本地Office客户端文档编辑能力强大、稳定的优点，提供了企业信息化建设中文档比对功能最佳技术实践。在另一实施例中，所述待对比文档和基准文档的格式包括：doc、docx、wps。所述WEB应用提供文件上传下载、文件列表API，同时提供JS加载项的在线下载地址。在另一实施例中，所述S400之后，包括：设置共同修改模式；在所述共同修改模式下，所有待对比文档同时被打开和修改；当同一待对比文档同时被打开时，对该被打开行为设置打开标记，当该待对比文档执行保存动作时设置保存标记，并对应保存时间；所述保存标记包括：编辑操作内容、编辑对象、编辑记录、存储地址；WEB应用按照设定时间和设定频率读取所述存储地址，获得存储地址中包含保存标记的待对比文档；基于保存标记对应的保存时间同步该待对比文档的所有编辑操作内容。上述技术方案的工作原理为：本实施例采用的方案是设置共同修改模式；在所述共同修改模式下，所有待对比文档同时被打开和修改；当同一待对比文档同时被打开时，对该被打开行为设置打开标记，当该待对比文档执行保存动作时设置保存标记，并对应保存时间；所述保存标记包括：编辑操作内容、编辑对象、编辑记录、存储地址；WEB应用按照设定时间和设定频率读取所述存储地址，获得存储地址中包含保存标记的待对比文档；基于保存标记对应的保存时间同步该待对比文档的所有编辑操作内容。另外，对保存的编辑记录、编辑对象进行存储时，采用加密的方式存储，具体的方式如下：将存储信息形成加密数据块和未加密的数据块，并对加密数据块进行解密后与未加密的数据块进行自适应重新组合得到原始信息，具体方式包括：根据以下公式针对获取加密数据块中数据的稳定度：其中，F加密数据块中数据的稳定度，xi,j代表第i个加密数据块中的第j个加密数据，i＝1,2,3…m,j＝1,2,3…n；利用加密数据块中数据的稳定度并根据以下公式获取解密数据块：其中，J代表解密数据块，Gk代表第k个子服务器加密有的结果，k＝1,2,3…L，L代表子服务器的个数，H代表安全链路的负载能力值，Dj代表第j个子服务器加密系数，Ay代表第j个子服务器标识编号；将解密的数据块与未加密的数据块进行自适应重新组合得到原始信息。上述技术方案的有益效果为：采用本实施例提供的方案保障存储的同步性，提供共同修改的模式，对文档修改没有限制，方便文档的多端处理。显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围之内，则本发明也意图包含这些改动和变型在内。
