标题title
一种考虑初始状态变量影响的新安江模型参数率定方法
摘要abst
本发明公开了一种考虑初始状态变量影响的新安江模型参数率定方法，包括如下步骤，S1、构建研究流域的新安江模型；S2、设置新安江模型用于确定初始状态变量计算时段的目标函数；S3、基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最优参数；S4、利用最优参数确定参数率定期初始状态变量的计算时段；S5、利用参数率定期初始状态变量的计算时段，基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最终最优参数。优点是：在数据系列较短的情况下，通过简单的操作即可充分利用现有数据更精准确定模型初始状态变量，从而得到更加准确的新安江模型参数。
权利要求书clms
1.一种考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：包括如下步骤，S1、构建研究流域的新安江模型；S2、设置新安江模型用于确定初始状态变量计算时段的目标函数；S3、基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最优参数；S4、利用最优参数确定参数率定期初始状态变量的计算时段；S5、利用参数率定期初始状态变量的计算时段，基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最终最优参数。2.根据权利要求1所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：步骤S1之前还包括收集研究流域的资料并整编；具体为，收集所研究流域的DEM数据，流域内各雨量站和水文站的经纬度信息及其相应的降雨量、径流量、蒸发量数据；利用GIS软件提取流域水系图，获取流域面积数据，划分泰森多边形确定各个雨量站的面积权重，计算流域的面平均雨量系列、相应时段长度的流域出口断面流量系列以及相应时段长度的蒸发量系列。3.根据权利要求1所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：步骤S1具体为，根据研究流域水系以及水文站雨量站网的分布特点，进行研究流域的子流域划分；每个子流域上分别进行蒸散发计算、流域产流计算、分水源计算和流域汇流计算，蒸散发采用两层或三层蒸发模式；流域产流采用蓄满产流模型进行计算；若划分为地面径流和地下径流两种水源，则按照稳定下渗率进行分水源操作；若划分为地面径流、壤中流和地下径流三种水源，则按照自由水箱进行分水源操作；每个子流域出口断面的流量经过马斯京根法、线性水库法或滞后演算法汇流到总的流域出口断面。4.根据权利要求3所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：构建的新安江模型有蒸散发模块、产流模块、分水源模块和汇流模块，蒸散发模块进行蒸散发计算，产流模块进行流域产流计算，分水源模块进行分水源操作，汇流模块进行流域汇流计算。5.根据权利要求1所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：新安江模型用于确定初始状态变量计算时段的目标函数为f，f的计算公式为，f＝α×f1+β×f2其中，f1为考虑实测流量与模拟流量误差平方和的均方根的分式；f2为考虑实测洪量与模拟洪量的相对误差的分式；α为f1的系数；β为f2的系数；Qs为实测的流量系列；Qj为新安江模型模拟的流量系列；f1的计算公式为，其中，N为实测流量过程线纵坐标的数量；Qs为实测流量过程线的第i个纵坐标；Qj为计算的流量过程线的第i个纵坐标；i＝1，2，3，...，N；f2的计算公式为，其中，Ws为实测的径流量；Wj为新安江模型模拟的径流量；abs为绝对值函数，取Ws-Wj的绝对值；Ws和Wj的计算公式分别如下，其中，Qs为实测流量过程线的第1个纵坐标；Qs为实测流量过程线的第N个纵坐标；Qs为实测流量过程线的第k个纵坐标；Qj为计算的流量过程线的第1个纵坐标；Qj为计算的流量过程线的第N个纵坐标；Qj为计算的流量过程线的第k个纵坐标；k＝2，3，4，...，N-1；Δt表示计算时段的长度。6.根据权利要求5所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：系数α和系数β的限定条件为，0＜β＜α＜1α+β＝1。7.根据权利要求1所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：步骤S3具体为，设置新安江模型参数的阈值，对新安江模型的初始状态变量在合理范围内进行假定，通过优化算法按照目标函数最小的原则优化新安江模型的参数，获取新安江模型的最优参数。8.根据权利要求7所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：步骤S4具体为，将最优参数代入到新安江模型，作为新安江模型的初始状态变量，利用该初始状态变量计算流域出口断面的流量系列，进而计算逐时段的纳什系数的值，从而得到逐时段的纳什系数系列，选取纳什系数的极大值对应的时段作为参数率定期初始状态变量的计算时段L，并计算该时段末的状态变量。9.根据权利要求8所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：步骤S5具体为，取步骤S4中确定的初始状态变量的计算时段L的下一时段作为参数率定时段的起始时段，取步骤S4中确定的时段末的状态变量作为新安江模型的初始状态变量，通过优化算法按照目标函数最小的原则优化新安江模型的参数，获取新安江模型的最终最优参数。10.根据权利要求1所述的考虑初始状态变量影响的新安江模型参数率定方法，其特征在于：优化算法为模式搜索法。
说明书desc
技术领域本发明涉及水文预报技术领域，尤其涉及一种考虑初始状态变量影响的新安江模型参数率定方法。背景技术当前通过新安江模型研究水库调度、水资源管理等问题，模型参数的估计是必不可少的步骤之一。现在广泛采用的新安江模型参数率定的方法均着重于研究各种优化算法的优化效果，而没有考虑模型的初始状态变量在什么时段取得最优的问题，当数据资料系列很长，数据量很充足的情况下，初始状态变量对模型的参数估计结果影响不大，能够估计出符合计算要求的参数。然而，有些小流域，数据系列较短，存在资料不足的情况。这时初始状态变量对新安江模型参数估计的影响很大，需要确定最优的初始状态变量的时段并计算最优的初始状态变量为新安江模型的参数率定提供初始数据。同时，现在广泛采用的优化新安江模型参数的目标函数均只考虑了洪水过程线的误差或只考虑洪量的误差，没有综合全面的考虑洪水过程和洪量两个要素，所以洪水过程和洪量的模拟效果通常不能兼顾，因此构建一个综合反映径流特征的目标函数来解决上述问题。发明内容本发明的目的在于提供一种考虑初始状态变量影响的新安江模型参数率定方法，从而解决现有技术中存在的前述问题。为了实现上述目的，本发明采用的技术方案如下：一种考虑初始状态变量影响的新安江模型参数率定方法，包括如下步骤，S1、构建研究流域的新安江模型；S2、设置新安江模型用于确定初始状态变量计算时段的目标函数；S3、基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最优参数；S4、利用最优参数确定参数率定期初始状态变量的计算时段；S5、利用参数率定期初始状态变量的计算时段，基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最终最优参数。优选的，步骤S1之前还包括收集研究流域的资料并整编；具体为，收集所研究流域的DEM数据，流域内各雨量站和水文站的经纬度信息及其相应的降雨量、径流量、蒸发量数据；利用GIS软件提取流域水系图，获取流域面积数据，划分泰森多边形确定各个雨量站的面积权重，计算流域的面平均雨量系列、相应时段长度的流域出口断面流量系列以及相应时段长度的蒸发量系列。优选的，步骤S1具体为，根据研究流域水系以及水文站雨量站网的分布特点，进行研究流域的子流域划分；每个子流域上分别进行蒸散发计算、流域产流计算、分水源计算和流域汇流计算，蒸散发采用两层或三层蒸发模式；流域产流采用蓄满产流模型进行计算；若划分为地面径流和地下径流两种水源，则按照稳定下渗率进行分水源操作；若划分为地面径流、壤中流和地下径流三种水源，则按照自由水箱进行分水源操作；每个子流域出口断面的流量经过马斯京根法、线性水库法或滞后演算法汇流到总的流域出口断面。优选的，构建的新安江模型有蒸散发模块、产流模块、分水源模块和汇流模块，蒸散发模块进行蒸散发计算，产流模块进行流域产流计算，分水源模块进行分水源操作，汇流模块进行流域汇流计算。优选的，新安江模型用于确定初始状态变量计算时段的目标函数为f，f的计算公式为，f＝α×f1+β×f2其中，f1为考虑实测流量与模拟流量误差平方和的均方根的分式；f2为考虑实测洪量与模拟洪量的相对误差的分式；α为f1的系数；β为f2的系数；Qs为实测的流量系列；Qj为新安江模型模拟的流量系列；f1的计算公式为，其中，N为实测流量过程线纵坐标的数量；Qs为实测流量过程线的第i个纵坐标；Qj为计算的流量过程线的第i个纵坐标；i＝1,2,3,…,N；f2的计算公式为，其中，Ws为实测的径流量；Wj为新安江模型模拟的径流量；abs为绝对值函数，取Ws-Wj的绝对值；Ws和Wj的计算公式分别如下，其中，Qs为实测流量过程线的第1个纵坐标；Qs为实测流量过程线的第N个纵坐标；Qs为实测流量过程线的第k个纵坐标；Qj为计算的流量过程线的第1个纵坐标；Qj为计算的流量过程线的第N个纵坐标；Qj为计算的流量过程线的第k个纵坐标；k＝2,3,4,…,N-1；Δt表示计算时段的长度。优选的，系数α和系数β的限定条件为，0＜β＜α＜1α+β＝1。优选的，步骤S3具体为，设置新安江模型参数的阈值，对新安江模型的初始状态变量在合理范围内进行假定，通过优化算法按照目标函数最小的原则优化新安江模型的参数，获取新安江模型的最优参数。优选的，步骤S4具体为，将最优参数代入到新安江模型，作为新安江模型的初始状态变量，利用该初始状态变量计算流域出口断面的流量系列，进而计算逐时段的纳什系数的值，从而得到逐时段的纳什系数系列，选取纳什系数的极大值对应的时段作为参数率定期初始状态变量的计算时段L，并计算该时段末的状态变量。优选的，步骤S5具体为，取步骤S4中确定的初始状态变量的计算时段L的下一时段作为参数率定时段的起始时段，取步骤S4中确定的时段末的状态变量作为新安江模型的初始状态变量，通过优化算法按照目标函数最小的原则优化新安江模型的参数，获取新安江模型的最终最优参数。优选的，优化算法为模式搜索法。本发明的有益效果是：1、本发明方法确定了最优的初始状态变量所在的时段，同时在目标函数中综合考虑了洪水过程线和洪量两种误差，并给洪水过程线误差较大的权重值，得到能够综合反映洪水过程和洪量等径流特征的新安江模型参数。2、本发明方法在数据系列较短的情况下，通过简单的操作即可充分利用现有数据更精准确定模型初始状态变量，从而得到更加准确的新安江模型参数。附图说明图1是本发明实施例中参数率定方法的流程示意图；图2是本发明实施例中大坡岭以上流域的泰森多边形及各个水文站位置；图3是本发明实施例中各时段相对应的纳什系数图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施方式仅仅用以解释本发明，并不用于限定本发明。实施例一如图1所示，本实施例中，提供了一种考虑初始状态变量影响的新安江模型参数率定方法，包括如下步骤，S1、构建研究流域的新安江模型；S2、设置新安江模型用于确定初始状态变量计算时段的目标函数；S3、基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最优参数；S4、利用最优参数确定参数率定期初始状态变量的计算时段；S5、利用参数率定期初始状态变量的计算时段，基于目标函数通过优化算法优化新安江模型参数，获取新安江模型的最终最优参数。根据参数率定方法的流程步骤可知，率定过程主要以下内容：新安江模型的构建、目标函数的设置、最优参数的获取、参数率定期初始状态变量计算时段的确定、最终最优参数的确定。在新安江模型构建之前需要对研究流域的资料进行收集换个整编，因此，下面分别对这六部分内容做出详细的说明。一、研究流域的资料收集与整编收集所研究流域的DEM数据，流域内各雨量站和水文站的经纬度信息及其相应的降雨量、径流量、蒸发量数据；利用GIS软件提取流域水系图，获取流域面积数据，划分泰森多边形确定各个雨量站的面积权重，计算流域的面平均雨量系列、相应时段长度的流域出口断面流量系列以及相应时段长度的蒸发量系列。本实施例中，运用GIS软件获取流域水系、面积、各雨量站泰森多边形权重。之后根据需要对研究流域进行子流域划分。二、新安江模型的构建该部分内容对应步骤S1，步骤S1具体为，根据研究流域水系以及水文站雨量站网的分布特点，通过HEC-GeoHMS工具进行研究流域的子流域划分；每个子流域上分别进行蒸散发计算、流域产流计算、分水源计算和流域汇流计算，蒸散发采用两层或三层蒸发模式；流域产流采用蓄满产流模型进行计算；若划分为地面径流和地下径流两种水源，则按照稳定下渗率进行分水源操作；若划分为地面径流、壤中流和地下径流三种水源，则按照自由水箱进行分水源操作；每个子流域出口断面的流量经过马斯京根法、线性水库法或滞后演算法汇流到总的流域出口断面。本实施例中，构建的新安江模型有蒸散发模块、产流模块、分水源模块和汇流模块，蒸散发模块进行蒸散发计算，产流模块进行流域产流计算，分水源模块进行分水源操作，汇流模块进行流域汇流计算。每个模块可以选择不同的方法进行计算。三、目标函数的设置该部分对应步骤S2，步骤S2中新安江模型用于确定初始状态变量计算时段的目标函数为f，f的计算公式为，f＝α×f1+β×f2其中，f1为考虑实测流量与模拟流量误差平方和的均方根的分式，主要优化洪水过程线的形状；f2为考虑实测洪量与模拟洪量的相对误差的分式，主要优化洪水的洪量；α为f1的系数；β为f2的系数；Qs表示实测的流量系列；Qj为新安江模型模拟的流量系列；f1的计算公式为，其中，N为实测流量过程线纵坐标的数量；Qs为实测流量过程线的第i个纵坐标；Qj为计算的流量过程线的第i个纵坐标；i＝1,2,3,…,N；f2的计算公式为，其中，Ws为实测的径流量；Wj为新安江模型模拟的径流量；abs为绝对值函数，取Ws-Wj的绝对值；Ws和Wj的计算公式分别如下，其中，Qs为实测流量过程线的第1个纵坐标；Qs为实测流量过程线的第N个纵坐标；Qs为实测流量过程线的第k个纵坐标；Qj为计算的流量过程线的第1个纵坐标；Qj为计算的流量过程线的第N个纵坐标；Qj为计算的流量过程线的第k个纵坐标；k＝2,3,4,…,N-1；Δt为计算时段的长度，单位为秒。本实施例中，系数α和系数β的限定条件为，0＜β＜α＜1α+β＝1。目标函数中囊括了f1和f2，其中，f1主要优化洪水过程线的形状；f2主要优化洪水的洪量；保证目标函数能够同时兼顾洪水过程线的形状和洪量。四、最优参数的获取该部分内容对应步骤S3，步骤S3具体为，设置新安江模型参数的阈值，对新安江模型的初始状态变量在合理范围内进行假定，通过优化算法按照目标函数最小的原则优化新安江模型的参数，获取新安江模型的最优参数。优化算法采用模式搜索算法。本实施例中，新安江模型的初始状态变量在合理范围内进行假定，初始状态变量的改变不影响参数率定期初始状态变量的计算时段L的确定。五、参数率定期初始状态变量计算时段的确定该部分内容对应步骤S4，步骤S4具体为，将步骤S3中获取的最优参数代入到新安江模型，作为新安江模型的初始状态变量，利用该初始状态变量计算流域出口断面的流量系列，进而计算逐时段的纳什系数的值，从而得到逐时段的纳什系数系列，选取纳什系数的极大值对应的时段作为参数率定期初始状态变量的计算时段L，并计算该时段末的状态变量。六、最终最优参数的确定该部分内容对应步骤S5，步骤S5具体为，取步骤S4中确定的初始状态变量的计算时段L的下一时段作为参数率定时段的起始时段，取步骤S4中确定的时段末的状态变量作为新安江模型的初始状态变量，通过优化算法按照目标函数最小的原则优化新安江模型的参数，获取新安江模型的最终最优参数。本实施例中，参数率定期的初始状态变量采用S4中计算出的值。参数率定期的目标函数还采用步骤S2中设置的目标函数f，能够同时兼顾洪水过程线的形状和洪量。实施例二本实施例中，以淮河上游大坡岭流域的新安江模型参数率定为实例，以表现本发明达到的效果。大坡岭站是淮河干流最上游的水文站，控制流域面积1640平方公里。大坡岭以上河流长73公里，流域内多为山区丘陵，植被良好。河流属山溪性河流，支流多，坡度大，汇流快，水流急，干旱时易断流。流域内水利工程不多，农作物以水稻为主。大坡岭以上流域有4个水文站。本实施例以起止时间为1999年1月1日至2002年12月31日4个水文站的逐日降雨量资料，桐柏站的逐日蒸发量、大坡岭站的逐日流量资料为基础，对大坡岭以上流域的新安江模型进行参数率定。本实施例中，考虑初始状态变量影响的新安江模型参数率定方法步骤如下：一、研究流域的资料收集与整编收集1999年1月1日至2002年12月31日流域内4个水文站的逐日各雨量数据、桐柏站的逐日蒸发量数据、大坡岭站的逐日平均流量数据。收集大坡岭水文站以上流域的DEM数据，4个水文站的经纬度数据，利用GIS软件提取流域水系图，获取流域面积数据，划分泰森多边形确定各水文站的面积权重，计算流域的面平均雨量系列。大坡岭以上流域的泰森多边形图及个水文站位置见附图2。由于大坡岭以上流域面积较小，水文站较少，将研究流域作为一个整体进行考虑，不再细分子流域。二、新安江模型的构建新安江模型的蒸发模块按照三层蒸发模型进行计算；产流模块按照蓄满产流模型进行计算；水源划分按照三水源自由水蓄水箱模型进行计算；坡面汇流模块采用线性水库模型进行计算；河网汇流模块采用滞后演算法。三、目标函数的设置目标函数为f，f1和f2的系数α和β的初选值分别为0.7和0.3。四、最优参数的获取根据建立的新安江模型，该模型有16个参数，分别为，其中K为流域蒸散发折算系数；SM为表层自由水蓄水容量；KG为表层自由水蓄水库对地下水的日出流系数；KSS为表层自由水蓄水库对壤中流的日出流系数；KKG为地下水消退系数；KKSS为壤中流消退系数；CR为河网蓄水消退系数；WUM为上层张力水容量；WLM为下层张力水容量；WDM为深层张力水容量；IMP为不透水率；B为张力蓄水容量曲线方次；C为深层蒸散发折算系数；EX为表层自由水蓄水容量曲线方次；L为滞时；KKS为地表径流消退系数。设置该组参数的最小值系列lb,如下：lb＝；设置该组参数的最大值系列ub，如下：ub＝；新安江模型的初始状态变量在合理范围内进行假定，比如设初始上层土壤蓄水量WU为2.79毫米；初始下层土壤蓄水量WL为0毫米；初始深层土壤蓄水容量WD为42.44毫米；初始产流面积比FR为0.2；初始自由水蓄水量S为0毫米；初始壤中流出流量TRSS＝1.11立方米每秒；初始地面径流流量QS＝0立方米每秒；初始地下径流流量为TRG＝1.48立方米每秒。通过模式搜索算法，按照目标函数最小的原则优化新安江模型的参数，最优参数为,取该组参数时确定性系数为0.89；洪量计算的相对误差为17.76％。五、参数率定期初始状态变量计算时段的确定确定参数率定期初始状态变量的计算时段L＝520，此时纳什系数最大为0.96。各时段相对应的纳什系数图见附图3。即2000年6月3日末的状态变量作为模型最终参数率定的初始状态变量。该初始变量为上层土壤蓄水量WU为78.27毫米；初始下层土壤蓄水量WL为0毫米；初始深层土壤蓄水容量WD为26.83毫米；初始产流面积比FR为0.63；初始自由水蓄水量S为11.72毫米。初始壤中流出流量TRSS＝60.87立方米每秒；初始地面径流流量QS＝170.68立方米每秒；初始地下径流流量为TRG＝20.42立方米每秒。六、最终最优参数的确定取2000年6月4日至2008年12月31日为新安江模型参数率定期，以步骤五中得到的状态变量作为新安江模型的初始状态变量，通过模式搜索算法对目标函数进行优化，确定新安江模型最终的最优参数为,此时确定性系数为0.87，洪量计算的相对误差为0％。通过采用本发明公开的上述技术方案，得到了如下有益的效果：本发明提供了一种考虑初始状态变量影响的新安江模型参数率定方法，本发明方法确定了最优的初始状态变量所在的时段，同时在目标函数中综合考虑了洪水过程线和洪量两种误差，并给洪水过程线误差较大的权重值，得到能够综合反映洪水过程和洪量等径流特征的新安江模型参数。本发明方法在数据系列较短的情况下，通过简单的操作即可充分利用现有数据更精准确定模型初始状态变量，从而得到更加准确的新安江模型参数。以上所述仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干改进和润饰，这些改进和润饰也应视本发明的保护范围。
