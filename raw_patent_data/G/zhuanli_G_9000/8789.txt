标题title
太赫兹光谱图像重构模型的构建方法及系统和应用
摘要abst
本发明公开了一种太赫兹光谱图像重构模型的构建方法，其包括：S1、获取太赫兹光谱图像；S2、对太赫兹光谱图像进行预处理；S3、对预处理图像进行欠采样观测；S4、将欠采样图像依次输入至线性映射网络、残差网络中进行网络训练，得重构模型；S5、判断重构模型训练次数是否不小于预设训练次数，若是，则输出重构模型；否则进入S6；S6、重复S4～S5，每重复一次训练次数加1。本发明针对太赫兹光谱图像，在DR2‑Net的基础上，增加了自适应采样步骤，并引入了残差网络思想，大大提高了图像重构质量，缩短图像重构时间，一定程度上提高了太赫兹系统的图像重构效率。
权利要求书clms
1.太赫兹光谱图像重构模型的构建方法，其特征在于，包括：S1、获取太赫兹光谱图像；S2、对太赫兹光谱图像进行预处理，得预处理图像；S3、通过高斯随机采样矩阵对预处理图像进行欠采样观测，得到欠采样图像；S4、将欠采样图像依次输入至线性映射网络、残差网络中进行训练，得重构模型；S5、判断重构模型训练次数是否不小于预设训练次数，若是，则输出重构模型；否则进入S6；S6、重复S4～S5，每重复一次训练次数加1。2.如权利要求1所述的太赫兹光谱图像重构模型的构建方法，其特征在于，步骤S2具体为：将太赫兹光谱图像分为多个平面光谱图像，将每个平面光谱图像分割为多个n×n的不重叠图像块，即得预处理图像。3.如权利要求2所述的太赫兹光谱图像重构模型的构建方法，其特征在于，步骤S3具体为：采用高斯随机采样矩阵对预处理图像进行欠采样，得到欠采样图像信号yi作为压缩感知测量值，采样次数A＝N×b，其中b为采样率，N为每个图像块的总像素数。4.如权利要求3所述的太赫兹光谱图像重构模型的构建方法，其特征在于，步骤S4具体为：S4.1、将欠采样图像信号yi一并输入至线性映射网络中，对欠采样图像进行初始重构，得到初始重构图像信号xi；其中线性映射网络的模型为：xi＝f式中，W∈Rm×n是映射矩阵；线性映射网络的损失函数为：式中X∈{X1,X2,…XN}，Y∈{Y1,Y2,…YN}；S4.2、将初始重构图像信号xi输入至残差网络中，对图像进行精度重构，得n×n的分块重建图像，即为重构模型；其中残差网络结构包括6个残差学习块，每个学习块包括3个卷积层，第一卷积层使用11×11的内核，第二卷积层使用1×1的内核，第三卷积层使用7×7的内核；每个卷积层均选用PReLU作为激活函数，式中ai为参数。5.如权利要求4所述的太赫兹光谱图像重构模型的构建方法，其特征在于，步骤S4.2中采用BM3D滤波器对n×n的分块重建图像进行去噪，得到高分辨率的重建图像，即为重构模型。6.太赫兹光谱图像重构模型的构建系统，其特征在于，包括：获取模块，其用于获取太赫兹光谱图像；自适应采样模块，其用于对太赫兹光谱图像进行预处理，随后通过高斯随机采样矩阵对预处理图像进行欠采样观测，得到欠采样图像；重构模块，其将欠采样图像依次输入至线性映射网络、残差网络中进行网络训练，得重构模型。7.太赫兹光谱图像重构模型的应用，其特征在于，将权利要求1～5中任一项所述的太赫兹光谱图像重构模型应用于小麦种子或玉米籽粒的太赫兹光谱图像的重构。8.电子设备，其特征在于，包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器执行权利要求1-5中任一项所述的方法。9.存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时，实现权利要求1-5中任一项所述的方法。
说明书desc
技术领域本发明涉及图像处理技术领域。更具体地说，本发明涉及一种太赫兹光谱图像重构模型的构建方法及系统和应用。背景技术太赫兹电磁辐射，也被称为THz波，波长在0.03～3mm，发射的频率在0.1～10THz，利用物质对太赫兹频带的不同特征吸收谱，分析研究物质成分、结构及其相互作用关系。太赫兹成像技术是以太赫兹时域光谱技术为基础发展起来的。由于THz波能够穿过布、木材、陶瓷等非极性材料，并能对物体内部成像，因此在成像领域受到越来越多的关注。太赫兹光谱图像不仅包含了目标物的几何信息，而且还具有目标物对THz脉冲响应的强度、相位和时间等完整信息，得到的样品图像具有“图谱合一”的特性，能同时获取空间图像信息和丰富的光谱信息，目前太赫兹成像技术和算法层出不穷，如Randon变换和干涉成像，THz-TDS成像、THz面阵成像、近场成像等，但仍存在一些局限性，如成像速度慢，图像数据量大，且实时性差。因此，如何提高太赫兹图像的重建速度并保证图像质量，是亟待解决的研究问题。发明内容本发明的一个目的是解决至少上述问题，并提供至少后面将说明的优点。本发明还有一个目的是提供一种太赫兹光谱图像重构模型的构建方法及系统，其解决了太赫兹时域光谱成像系统普遍存在图像采集时间长、数据冗余较大等问题，降低采样率将导致成像重建质量下降的技术问题。为了实现根据本发明的这些目的和其它优点，提供了一种太赫兹光谱图像重构模型的构建方法，其包括：S1、获取太赫兹光谱图像；S2、对太赫兹光谱图像进行预处理，得预处理图像；S3、通过高斯随机采样矩阵对预处理图像进行欠采样观测，得到欠采样图像；S4、将欠采样图像依次输入至线性映射网络、残差网络中进行训练，得重构模型；S5、判断重构模型训练次数是否不小于预设训练次数，若是，则输出重构模型；否则进入S6；S6、重复S4～S5，每重复一次训练次数加1。优选的是，所述的太赫兹光谱图像重构模型的构建方法，步骤S2具体为：将太赫兹光谱图像分为多个平面光谱图像，将每个平面光谱图像分割为多个n×n的不重叠图像块，即得预处理图像。优选的是，所述的太赫兹光谱图像重构模型的构建方法，步骤S3具体为：采用高斯随机采样矩阵对预处理图像进行欠采样，得到欠采样图像信号yi作为压缩感知测量值，采样次数A＝N×b，其中b为采样率，N为每个图像块的总像素数。优选的是，所述的太赫兹光谱图像重构模型的构建方法，步骤S4具体为：S4.1、将欠采样图像信号yi一并输入至线性映射网络中，对欠采样图像进行初始重构，得到初始重构图像信号xi；其中线性映射网络的模型为：xi＝f 式中，W∈Rm×n是映射矩阵；线性映射网络的损失函数为：式中X∈{X1,X2,…XN}，Y∈{Y1,Y2,…YN}；S4.2、将初始重构图像信号xi输入至残差网络中，对图像进行精度重构，得n×n的分块重建图像，即为重构模型；其中残差网络结构包括6个残差学习块，每个学习块包括3个卷积层，第一卷积层使用11×11的内核，第二卷积层使用1×1的内核，第三卷积层使用7×7的内核；每个卷积层均选用PReLU作为激活函数，式中ai为参数。优选的是，所述的太赫兹光谱图像重构模型的构建方法，步骤S4.2中采用BM3D滤波器对n×n的分块重建图像进行去噪，得到高分辨率的重建图像，即为重构模型。本发明还提供一种太赫兹光谱图像重构模型的构建系统，其包括：获取模块，其用于获取太赫兹光谱图像；自适应采样模块，其用于对太赫兹光谱图像进行预处理，随后通过高斯随机采样矩阵对预处理图像进行欠采样观测，得到欠采样图像；重构模块，其将欠采样图像依次输入至线性映射网络、残差网络中进行网络训练，得重构模型。本发明提供一种太赫兹光谱图像重构模型的应用，将上述的太赫兹光谱图像重构模型应用于小麦种子或玉米籽粒的太赫兹光谱图像的重构。本发明还提供一种电子设备，其包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器执行上述的方法。本发明还提供一种存储介质，其上存储有计算机程序，该程序被处理器执行时，实现上述的方法。本发明至少包括以下有益效果：本发明针对太赫兹光谱图像，在DR2-Net的基础上，增加了自适应采样步骤，并引入了残差网络思想，大大提高了图像重构质量，缩短图像重构时间，一定程度上提高了太赫兹系统的图像重构效率。本发明的其它优点、目标和特征将部分通过下面的说明体现，部分还将通过对本发明的研究和实践而为本领域的技术人员所理解。附图说明图1为本发明所述的太赫兹光谱图像重构模型的结构示意图；图2为本发明步骤二重构模型训练流程图；图3为本发明重构的效果图。具体实施方式下面结合附图及实施例对本发明做进一步的详细说明，以令本领域技术人员参照说明书文字能够据以实施。应当理解，本文所使用的诸如“具有”、“包含”以及“包括”术语并不排除一个或多个其它元件或其组合的存在或添加。需要说明的是，下述实施方案中所述实验方法，如无特殊说明，均为常规方法，所述试剂和材料，如无特殊说明，均可从商业途径获得。在本发明的描述中，术语“横向”、“纵向”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，并不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。本发明提供一种太赫兹光谱图像重构模型的构建方法，其包括：S1、获取太赫兹光谱图像；对获取的太赫兹光谱图像贴上标签；S2、对太赫兹光谱图像进行预处理，得预处理图像；S3、通过高斯随机采样矩阵对预处理图像进行欠采样观测，得到欠采样图像；S4、将欠采样图像依次输入至线性映射网络、残差网络中进行网络训练，得重构模型；S5、判断重构模型训练次数是否不小于预设训练次数，若是，则输出重构模型；否则进入S6；S6、重复S4～S5，每重复一次训练次数加1。在传统的压缩感知图像重建算法中，需要将图像进行分块处理，以实现对复杂信息块的特殊处理，可在降低图像重建复杂度的同时提高重建精确度。为了解决传统压缩感知重构算法的应用瓶颈，在减少重构阶段的计算量的同时，能够提高重构精度，许多学者提出采用卷积神经网络代替优化过程，加快重构阶段。ReconNet是由Kulkarni等人研发的一种非迭代的、快速的分块压缩感知重构算法。ReconNet基于卷积神经网络来实现非迭代的压缩感知图像重构，这是应用卷积神经网络对由高斯随机矩阵测量的低分辨率混合图像进行重构的代表性工作。将原始图像分为不重叠的子块进行重构，既可以处理复杂的信息块，又能够达到降低重构复杂度和提高重构质量的目的。DR2-Net是在ReconNet的基础上改进而来，也运用了此种构想，它将图像分为不重叠的块，通过将相应的压缩感知测量值馈送到它的网络中来重构每个块，并组合好重构的块来形成整幅重构图像。但是这种重构图像有块状伪影，因此，再将其输入到BM3D去噪器中去除块效应并获得最终的输出图像。本发明针对太赫兹光谱图像，在DR2-Net的基础上，增加了自适应采样步骤，并引入了残差网络思想，大大提高了图像重构质量，缩短图像重构时间，一定程度上提高了太赫兹系统的图像重构效率。另一种技术方案中，所述的太赫兹光谱图像重构模型的构建方法，步骤S2具体为：将太赫兹光谱图像分为多个平面光谱图像，将每个平面光谱图像分割为多个n×n的不重叠子块，即得预处理图像。另一种技术方案中，所述的太赫兹光谱图像重构模型的构建方法，步骤S3具体为：采用高斯随机采样矩阵对预处理图像进行欠采样，得到欠采样图像信号yi作为压缩感知测量值，采样次数A＝N×b，其中b为采样率，N为每个图像块的总像素数，N＝1089。一组U×V×Y的太赫兹光谱图像数据，每个1×1×Y数据都是一条完整的THz频域或时域光谱，根据频域将图像分为Y个平面THz光谱图像，之后将这些图像分割为33×33的不重叠子块，并采用高斯随机测量矩阵怎对其进行观测，得到M维矢量作为线性映射网络的输入，记为ΦX。其中Φ是大小为M×H维的观测矩阵，M是测量数据，X是向量化的图像块。网络将图像分成33×33的不重叠子块进行重构。另一种技术方案中，所述的太赫兹光谱图像重构模型的构建方法，步骤S4具体为：S4.1、将欠采样图像信号yi一并输入至线性映射网络中，对欠采样图像进行初始重构，得到初始重构图像信号xi；其中线性映射网络的模型为：xi＝f 式为超定方程，W∈Rm×n是映射矩阵；线性映射网络的损失函数为：其中，xi是第i个图像块，yi是图像块的测量值，{Wf}使用反向传播机制，f是通过线性映射网络输出的第i个重构图像，S是训练集中图像块总数。MSE是真实值与预测值之间的差值的平方再求和平均。由于MSE是平方的形式，容易求导，并且MSE的损失梯度随着损失的增大而增大，损失趋于0时则会减小。假设一个映射矩阵Wf，使得有一个最小误差。yi∈Rm代表压缩感知测量值，xi∈Rn代表其相应的源信号，那么，包含n个训练样本的训练数据可以表示为{,,…}。根据这些训练数据求解下式，可得到Wf：式中X∈{X1,X2,…XN}，Y∈{Y1,Y2,…YN}；式提供了一个线性映射函数，该函数可以在深度学习中通过全连接层来有效模拟。因此，在所有训练样本上都可得到与最小方程相对应的最优映射矩阵Wf；S4.2、将初始重构图像信号xi输入至残差网络中，对图像进行精度重构，得n×n的分块重建图像，即为重构模型；残差网络可提高图像的重构精度，获得一个高分辨率的输出；其中残差网络结构包括6个残差学习块，每个学习块包括3个卷积层，第一卷积层使用11×11的内核，第二卷积层使用1×1的内核，第三卷积层使用7×7的内核；每个卷积层均选用PReLU作为激活函数，具体表达式为：式中ai为参数，具体为控制负部分斜率的系数。如果ai为0，则退化为Relu；如果ai是一个很小的固定值，则PRelu退化为Leaky Relu。本申请中ai初始化为0.2。另一种技术方案中，所述的太赫兹光谱图像重构模型的构建方法，步骤S4.2中采用BM3D滤波器对n×n的分块重建图像进行去噪，得到高分辨率的重建图像，即为重构模型。经过残差网络之后输出为33×33的分块重建图像，并将这些图像通过BM3D滤波器去除中间重建图像因分块量化的量化误差而产生的块效应，输出最终的高分辨率重建图像。本发明还提供一种太赫兹光谱图像重构模型的构建系统，其包括：获取模块，其用于获取太赫兹光谱图像；自适应采样模块，其用于对太赫兹光谱图像进行预处理，随后通过高斯随机采样矩阵对预处理图像进行欠采样观测，得到欠采样图像；重构模块，其将欠采样图像依次输入至线性映射网络、残差网络中进行网络训练，得重构模型。重构模块包括线性映射网络和残差网络；去噪模块，其重构模型进行去噪处理。如图1所示，本发明的太赫兹光谱图像重构模型结构包括图像获取模块、自适应采样模块、线性映射网络、残差网络、和去噪模块。本发明还提供一种太赫兹光谱图像重构模型的应用，将上述的太赫兹光谱图像重构模型应用于小麦种子或玉米籽粒的太赫兹光谱图像的重构。具体为：为了验证我们所提出的模型的性能，实验使用的THz仪器为Zomega公司的Z3系列THz时域光谱仪，有效光谱范围为0.1～3.5THz，峰值动态范围大于1000，系统信噪比大于3000。以小麦种子为实验对象，将样品放置在THz-TDS系统中的移动平台上，并进行反射成像测量，系统最大扫描面积是50mm×50mm，空间分辨率设置为0.1mm。获取到样品的THz光谱图像数据后，使用本发明构建的太赫兹光谱图像重构模型进行图像重构。为了更加满足日常需求，全部实验过程在常温常湿环境下进行。图像重构包括以下步骤：步骤一：从小麦种子的THz图像中各个像素点提取出THz光谱，并在各频率点求平均，获得一条平均光谱信号，每条光谱包含500个点；步骤二：如图2所示，重构模型训练：S1、获取太赫兹光谱图像训练集：选用小麦种子和玉米籽粒各12粒，同一样品，不同频域下的500张THz光谱图像为一组，将十二组共12000张THz光谱图像作为训练集；S2、进入自适应采样模块进行处理：将训练集中的光谱图像贴标签，采用对训练集的光谱图像进行降维、分割为多个n×n的互不重叠的图像块，得预处理图像，其中，每个图像块的总像素数N＝1089；采用高斯随机采样矩阵Φ对预处理图像信号进行欠采样，得欠采样图像，其中依次采用4种不同的采样率b对预处理图像进行四次欠采样，得四个欠采样图像，四次欠采样经高斯矩阵测量次数A分别为871，546，272和109；S3、将四个欠采样图像依次输入线性映射网络、残差网络中进行网络模型训练，得四个图像重构模型，模型训练次数不小于预设训练次数，经过训练后的图像重构模型都经过了去噪处理，具体为采用BM3D滤波器对n×n的分块重建图像进行去噪，得到高分辨率的重建图像，即为图像重构模型；步骤三、基于步骤二的四个采样率，采用步骤二中的训练集依次对OMP、IRLS、IHTDR2-Net进行训练，分别得到四个对照图像重构模型组，分别为A组、B组、C组和D组，且四个对照图像重构模型组均包括四个对照图像重构模型；上述四种算法的参数被设置为默认值，由于重建会产生块效应，均采用BM3D去噪器对对照图像重构模型进行去噪处理；OMP、IRLS、IHT为三种传统的压缩感知图像重构算法；步骤四、选取步骤一种信号最强处的频域光谱，依次输入四个图像重构模型、四个A组对照图像重构模型、四个B组对照图像重构模型、四个C组对照图像重构模型和四个D组对照图像重构模型中，最终重构得到如图3所示的效果图。为减少随机测量矩阵带来的误差，五种重构方法的PSNR、SSIM和重构时间取100次测试结果的平均，采用五种算法在采样率分别为0.8、0.5、0.25和0.1时，对小麦种子重构的效果如图3所示。从图3中可以看出，采样率为0.8时，五种算法均可以清晰的重构出原始图像，当采样率低于0.5时，采用OMP算法重构的图像已严重失真，图像基本被噪声淹没，此时IRLS、IHT、DR2-Net和ATResCS依然有着较高的重构质量。采样率为0.1时，采用IHT算法重构的图像基本被噪声淹没，IRLS算法重构图像的特征也模糊不清，此时DR2-Net和ATResCS重构图像的特征相对较为清晰。实验证明本申请提出的ATResCS重构网络的重构效果超出了传统的重构算法，大大提高了在低采样率下的图像重构质量。ATResCS相较于三种传统压缩感知方法和DR2-Net不仅对图像的重建质量有一定的提升，同时也提高了重建速度。不同采样率时小麦种子的THz光谱图像重构时间对比见表1。由表1可得，ATResCS重构网络的重构均低于其他重构算法所需的重构时间，在一定程度上提高了太赫兹系统的图像重构效率。表1.不同采样率的小麦种子THz光谱图像重构时间对比本发明还提供一种电子设备，其包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器执行上述的方法。本发明还提供了一种存储介质，其上存储有计算机程序，该程序被处理器执行时，实现上述的方法。这里说明的设备数量和处理规模是用来简化本发明的说明的。对本发明的应用、修改和变化对本领域的技术人员来说是显而易见的。尽管本发明的实施方案已公开如上，但其并不仅仅限于说明书和实施方式中所列运用，它完全可以被适用于各种适合本发明的领域，对于熟悉本领域的人员而言，可容易地实现另外的修改，因此在不背离权利要求及等同范围所限定的一般概念下，本发明并不限于特定的细节和这里示出与描述的图例。
