标题title
一种原子力显微镜压电驱动器的多轴耦合迟滞预测方法
摘要abst
本发明公开了一种原子力显微镜压电驱动器的多轴耦合迟滞预测方法，采集原子力显微镜压电管扫描器X轴由Y轴耦合产生的位移时间序列，利用观测函数和Koopman算子将原来的数据提升到高维空间，将多轴耦合非线性关系用线性的方程表示，其中利用提升数据构造汉克矩阵，并且利用两次降维，得到系统的模态信息，最终实现多轴耦合模型的建立。本发明所设计的预测方法能够对原子力显微镜压电管扫描器的多轴耦合进行建模，并对多轴耦合位移进行预测，可以在后期控制中有效提高原子力显微镜的高速高精成像，该方法能够推广于其他压电陶瓷驱动器产品中。
权利要求书clms
1.一种原子力显微镜压电驱动器的多轴耦合迟滞预测方法，其特征在于，包括：S1，向所述压电驱动器的一轴输入周期性的电压信号，采集另一轴的位移zi；S2，基于Koopman观测函数ψ将所述另一轴的位移转换为观测序列并构造汉克尔矩阵R和R′；存在R′＝KR，K为Koopman算子；S3，对所述汉克尔矩阵R和R′进行降维，得到降维后的线性模型并构建后对其进行降维，以对所述线性模型进行二次降维，得到二次降维后的线性模型S4，求解的最优值及其谱特征，得到所述二次降维后的线性模型的解，基于所述二次降维后的线性模型的解得到降维观测序列的表达式为：并对θi进行辨识；S5，根据θi得到观测序列的表达式为：用于预测所述另一轴的耦合迟滞特性；其中，k＝1,2,…,r，ui和vi分别为增长率和频率，θi为幅值向量，si是模态向量，Δt为采样时间。2.如权利要求1所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法，其特征在于，当观测函数ψ取状态zk自身时，所述另一轴的耦合位移为：3.如权利要求1所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法，其特征在于，汉克尔矩阵R的表达式为：其中，m为时延嵌入维度，R′是R的下一时间节点值。4.如权利要求1或2所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法，其特征在于，其中，gk＝T。5.如权利要求1或2所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法，其特征在于，所述二次降维后的线性模型的解为：6.如权利要求1所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法，其特征在于，基于最小二乘法对θi进行辨识。7.如权利要求1所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法，其特征在于，基于最小二乘法求解的最优值，根据所述最优值得到的特征向量wi和对应特征值λi，根据λi得到增长率ui和频率vi。8.一种原子力显微镜压电驱动器的多轴耦合迟滞预测系统，其特征在于，包括：计算机可读存储介质和处理器；所述计算机可读存储介质用于存储可执行指令；所述处理器用于读取所述计算机可读存储介质中存储的可执行指令，执行如权利要求1-7任一项所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法。
说明书desc
技术领域本发明属于精密制造领域，更具体地，涉及一种原子力显微镜压电驱动器的多轴耦合迟滞预测方法。背景技术原子力显微镜是纳米尺度表面形貌测量装备，被广泛地应用于微纳米测量成像与制造中，而其扫描成像效果很大程度取决于压电管扫描器的定位精度。由于压电管扫描器的压电材料特有性质，多轴之间存在复杂的耦合迟滞效应，严重地制约了其影像级扫描成像和测量精度。传统的压电管扫描器控制方法中，通常将多轴耦合迟滞当做一种干扰，用反馈控制器如H∞控制、PID控制等进行消除，但是反馈控制器忽略了压电管扫描器的内在特性，极大地阻碍压电管扫描器的超高精度的应用。而对耦合迟滞建模如Bouc–Wen模型、Duhem模型等在实际控制应用中，对实际参数十分敏感，很难达到控制效果，因此亟需建立一种方法，能够精确建立压电管扫描器多轴耦合迟滞模型并进行预测的同时便于用于实际控制。发明内容针对现有技术的以上缺陷或改进需求，本发明提供了一种原子力显微镜压电驱动器的多轴耦合迟滞预测方法，由此解决难以对多轴耦合迟滞进行精确测量的技术问题。为实现上述目的，按照本发明的第一方面，提供了一种原子力显微镜压电驱动器的多轴耦合迟滞预测方法，包括：S1，向所述压电驱动器的一轴输入周期性的电压信号，采集另一轴的位移；S2，基于Koopman观测函数将所述另一轴的位移转换为观测序列并构造汉克尔矩阵R和R′；存在R′＝KR，K为Koopman算子；S3，对所述汉克尔矩阵R和R′进行降维，得到降维后线性模型并构建后对其进行降维，以对所述线性模型进行二次降维，得到二次降维后的线性模型S4，求解的最优值及其谱特征，得到所述二次降维后的线性模型的解，基于所述二次降维后的线性模型的解得到降维观测序列的表达式为：并对θi进行辨识；S5，根据θi得到观测序列的表达式为：用于预测所述另一轴的耦合迟滞特性；其中，k＝1,2,…,r，ui和vi分别为增长率和频率，θi为幅值向量，si是模态向量，Δt为采样时间。优选地，当观测函数ψ取状态zk自身时，所述另一轴的耦合位移为：优选地，汉克尔矩阵R的表达式为：其中，m为时延嵌入维度，R′是R的下一时间节点值。优选地，其中，gk＝T。优选地，所述二次降维线性模型的解为：优选地，基于最小二乘法对θi进行辨识。优选地，基于最小二乘法求解的最优值，根据所述最优值得到的特征向量wi和对应特征值λi，根据λi得到增长率ui和频率vi。按照本发明的第二方面，提供了一种原子力显微镜压电驱动器的多轴耦合迟滞预测系统，包括：计算机可读存储介质和处理器；所述计算机可读存储介质用于存储可执行指令；所述处理器用于读取所述计算机可读存储介质中存储的可执行指令，执行如第一方面所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法。总体而言，通过本发明所构思的以上技术方案与现有技术相比，能够取得下列有益效果：1、本发明提供的基于原子力显微镜的多轴耦合迟滞预测方法，采集原子力显微镜压电管扫描器X轴由Y轴耦合产生的位移时间序列，利用观测函数和Koopman算子将原来的数据提升到高维空间，将多轴耦合非线性关系用线性的方程表示，其中利用提升数据构造汉克矩阵，并且利用两次降维，得到系统的模态信息，最终实现多轴耦合模型的建立。本发明所设计的预测方法能够对原子力显微镜压电管扫描器的多轴耦合进行建模，并对多轴耦合位移进行预测，可以在后期控制中有效提高原子力显微镜的高速高精成像，该方法能够推广于其他压电陶瓷驱动器产品中。2、本发明提供的基于原子力显微镜的多轴耦合迟滞预测方法，是一种纯数据驱动方法，利用采集数据对多轴耦合进行建模，建立原子力显微镜中一轴的运动引起的另一轴的耦合运动位移模型，将非线性地耦合过程映射到高维空间，从而转化为线性模型，通过两次降维，去除数据冗余和干扰信息，同时降低计算复杂度，辨识出了Koopman谱特征，最终建立耦合迟滞模型。本方法简单易行，能够更精确的建立多轴耦合迟滞模型，预测出耦合位移，对其他压电迟滞系统具有通用性，并且该模型为后续原子力显微镜地控制奠定了基础，对于提高原子力显微镜的探测精度具有重要意义。3、本发明提供的基于原子力显微镜的多轴耦合迟滞预测方法，利用原子力显微镜压电管扫描器多轴的位移数据，基于Koopman算子，将压电管扫描器的多轴耦合非线性特性转换为线性特性，建立多轴耦合模型，并对多轴耦合迟滞进行预测，提高了建模精度。通过降维，去除了数据中的冗余部分，去除噪声的同时减小了计算复杂度；使用了Koopman谱特征值精确地预测压电管扫描器多轴耦合位移。4、本发明提供的基于原子力显微镜的多轴耦合迟滞预测方法，基于数据驱动，无需原子力显微镜压电管扫描器先验模型，简单便捷，能够建立多轴耦合迟滞精确模型，为后续控制消除耦合干扰奠定了基础，提高原子力显微镜观测精度。附图说明图1为本发明提供的原子力显微镜压电驱动器的多轴耦合迟滞预测方法流程图；图2为本发明提供的实验平台数据采集示意图；图3、图3分别为本发明提供的原子力显微镜压电驱动器的多轴耦合迟滞预测方法实验结果图之一；图4、图4分别为本发明提供的原子力显微镜压电驱动器的多轴耦合迟滞预测方法实验结果图之二。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。此外，下面所描述的本发明各个实施方式中所涉及到的技术特征只要彼此之间未构成冲突就可以相互组合。本发明实施例提供一种原子力显微镜压电驱动器的多轴耦合迟滞预测方法，如图1所示，包括：S1，向所述压电驱动器其中的一轴输入周期性的电压信号，采集另一轴的位移；S2，基于Koopman观测函数将所述另一轴的位移转换为观测序列并构造汉克尔矩阵R和R′；存在R′＝KR，K为Koopman算子；S3，对所述汉克尔矩阵R和R′进行降维，得到降维后线性模型并且构建再对进行降维，将上述线性模型进行二次降维，得到二次降维后的线性模型S4，求解的最优值及其谱特征，得到所述二次降维后的线性模型的解，基于所述二次降维后的线性模型的解得到降维观测序列的表达式为：并对θi进行辨识；S5，根据θi得到观测序列的表达式为：用于预测所述另一轴的耦合迟滞特性；其中，k＝1,2,…,r，ui和vi分别为增长率和频率，θi为幅值向量，si是模态向量，Δt为采样时间。具体地，在具体介绍本发明之前，为了让整个实施过程更容易理解，现在简要介绍一下Koopman算子：对于n维欧式空间非线性系统：zk+1＝ff表示状态到输出zk+1非线性映射关系。存在观测器ψ将状态zk从欧式空间映射到无穷维希尔伯特空间在希尔伯特空间中，Koopman算子将上述非线性系统转化为：Koopman算子为希尔伯特空间中线性算子，因此欧式空间中非线性系统可以映射为希尔伯特空间中线性系统：ψ＝Kψ本发明提供的方法，在步骤S1，向所述压电驱动器其中的一轴输入周期性的电压信号，采集另一轴的位移。具体地，以一轴为X轴、另一轴为Y轴为例，给原子力显微镜的压电扫描器Y轴输入一个正弦驱动电压信号，采集压电扫描器X轴的位移电压信号，经过转换为X轴位移。如图2所示，其中，a为显示模块，b为dSPACE，c为信号放大器，d为信号连接器，e为原子力显微镜；利用dSPACE中的DAC模块经过放大器向原子力显微镜压电扫描器的Y轴输入正弦电压信号，然后用dSPACE中的ADC模块分别采集X轴耦合位移，获取得到长度为r+1的X轴耦合位移数据。在步骤S2，利用Koopman观测函数ψ将X轴位移序列转换为Koopman观测序列利用观测序列构造两个汉克尔矩阵R、R′，对应关系R′＝KR。也即，利用Koopman观测函数ψ，将上述采集得X轴位移数据映射到Koopman空间，转换为{ψ,ψ,ψ,…,ψ}，即观测序列ψ为Koopman观测器。然后构造汉克尔矩阵如下，其中，m是时延嵌入维度，同理构造汉克矩阵R′，R′是R的下一时间节点值，可以建立线性模型：R′＝KR其中，K为Koopman算子。在步骤S3，分别对汉克尔矩阵进行两次降维，具体包括：首先，对所有观测数据进行截断奇异值分解，即其中，V1是分别包含左右奇异向量的正交矩阵，∑1是包含奇异值的对角阵。则式中K可降维为：其中，原汉克尔矩阵R和R′降维为：然后构建新的矩阵其中，gk＝T。与一样，对新的矩阵进行截断奇异值分解其中，V2是分别包含左右奇异向量的正交矩阵，∑2是包含奇异值的对角阵。通过上述截断奇异值分解降维，由此得到原线性模型的二次降维线性模型：其中，在步骤S4-S5，计算谱特征，利用谱特征得到X轴耦合位移模型，从而可以预测未来X轴由X-Y轴耦合产生的位移。进一步的，通过的谱特征分析X轴耦合位移。优选地，采用最小二乘法求解的最优值为然后得到的特征向量wi和对应特征值λi。由此得到线性模型的解的形式为：其中，ui和vi分别是增长率和频率，可通的特征值λi和采样时间Δt求得：θi为待辨识的参数。根据线性模型的解可以得到降维状态：其中，通过选取向量U2wi的前d行得到。矩阵可以写为如下形式：其中Ω＝diag，通过上述参数即可求出幅值向量θi。优选地，采用最小二乘法进行求解。通过降维步骤中的公式，预测的系统的耦合迟滞特性为：其中此处取θi中最大的M个值。当ψ取状态zk自身时，即为X轴由Y轴耦合引起的位移，即可用于预测X轴耦合效应位移，即有：采用本发明提供的原子力显微镜压电驱动器的多轴耦合迟滞预测方法进行仿真实验。图3、图3分别为采用发明提供的方法在在35Hz的Y轴输入信号下，X轴的耦合预测输出及预测误差示意图；图4、图4分别为采用发明提供的方法在在100Hz的Y轴输入信号下，X轴的耦合预测输出及预测误差示意图；由此可知，本发明提供的方法对不同频率的Y轴输入信号，均能很好的预测X轴耦合输出。下面对本发明提供的原子力显微镜压电驱动器的多轴耦合迟滞预测系统进行描述，下文描述的原子力显微镜压电驱动器的多轴耦合迟滞预测系统与上文描述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法可相互对应参照。本发明实施例提供一种原子力显微镜压电驱动器的多轴耦合迟滞预测系统，包括：计算机可读存储介质和处理器；所述计算机可读存储介质用于存储可执行指令；所述处理器用于读取所述计算机可读存储介质中存储的可执行指令，执行如上述任一实施例所述的原子力显微镜压电驱动器的多轴耦合迟滞预测方法。本领域的技术人员容易理解，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
