标题title
多尺度自校准气动光学效应湍流退化图像复原方法及系统
摘要abst
本发明公开了一种多尺度自校准气动光学效应湍流退化图像复原方法，包括以下步骤：S1、提取原始气动光学效应湍流退化图像的特征图；S2、通过预先构建的自校准网络对特征图进行校准，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；S3、对原始气动光学效应湍流退化图像的特征图进行多尺度卷积恢复，得到针对全局区域的全局恢复特征图；S4、将局部融合特征图和全局恢复特征图合并，并通过卷积对合并后的特征图进行图像复原。本发明能在利用图像潜在高、低分辨率空间信息的同时兼顾到图像的多尺度信息，从而精准复原气动光学效应湍流退化图像。
权利要求书clms
1.一种多尺度自校准气动光学效应湍流退化图像复原方法，其特征在于,包括以下步骤：S1、提取原始气动光学效应湍流退化图像的特征图，特征图大小为C×H×W，其中通道维数为C，H、W分别为湍流退化图像的高、宽；S2、通过预先构建的自校准网络对特征图进行校准，具体沿着通道维度将特征图分离为两个子特征图，每个子特征图的通道数为C/2，提取其中一个子特征图的高、低分辨率空间特征，并进行加权融合，得到校准空间特征；提取另一个子特征图的原始分辨率空间特征；将原始分辨率空间特征与校准空间特征进行融合，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；S3、对原始气动光学效应湍流退化图像的特征图进行多尺度卷积恢复，得到针对全局区域的全局恢复特征图；S4、将局部融合特征图和全局恢复特征图合并，并通过卷积对合并后的特征图进行图像复原。2.根据权利要求1所述的多尺度自校准气动光学效应湍流退化图像复原方法，其特征在于，步骤S2中，将局部融合特征图作为输入，重复m次融合操作，将m个融合特征图进行级联，作为最终的局部融合特征图，其中m为自然数。3.根据权利要求1所述的多尺度自校准气动光学效应湍流退化图像复原方法，其特征在于，步骤S2中对高、低分辨率空间特征使用sigmoid函数进行加权融合，得到校准空间特征。4.根据权利要求1所述的多尺度自校准气动光学效应湍流退化图像复原方法，其特征在于，步骤S2中具体采用卷积层提取湍流退化图像的特征图。5.根据权利要求1所述的多尺度自校准气动光学效应湍流退化图像复原方法，其特征在于，步骤S3中，具体利用一多通道滤波器，不同通道中卷积核的空洞率不同，从而形成多尺度卷积，该多通道滤波器的通道数等于特征图的通道维数C；利用多尺度卷积将原始气动光学效应湍流退化图像的特征图感受野扩大，经过多尺度卷积后输出的全局区域恢复后的特征图。6.一种基于多尺度自校准网络的气动光学效应湍流退化图像复原系统，其特征在于，包括：特征图像提取模块，用于提取原始气动光学效应湍流退化图像的特征图，特征图大小为C×H×W，其中通道维数为C，H、W分别为湍流退化图像的高、宽；局部模糊区域校准模块，用于通过预先构建的自校准网络对特征图进行校准，具体沿着通道维度将特征图分离为两个子特征图，每个子特征图的通道数为C/2，提取其中一个子特征图的高、低分辨率空间特征，并进行加权融合，得到校准空间特征；提取另一个子特征图的原始分辨率空间特征；将原始分辨率空间特征与校准空间特征进行融合，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；全局区域恢复模块，用于对原始气动光学效应湍流退化图像的特征图进行多尺度卷积恢复，得到针对全局区域的全局恢复特征图；图像复原模块，用于将局部融合特征图和全局恢复特征图合并，并通过卷积对合并后的特征图进行图像复原。7.根据权利要求6所述的基于多尺度自校准网络的气动光学效应湍流退化图像复原系统，其特征在于，局部模糊区域校准模块还用于具体将融合特征图作为输入，重复m次融合操作，将m个融合特征图进行级联，作为终的融合特征图，其中m为自然数。8.根据权利要求6所述的基于多尺度自校准网络的气动光学效应湍流退化图像复原系统，其特征在于，局部模糊区域校准模块具体对高、低分辨率空间特征使用sigmoid函数进行加权融合，得到校准空间特征。9.根据权利要求6所述的基于多尺度自校准网络的气动光学效应湍流退化图像复原系统，其特征在于，全局区域恢复模块具体用于：具体利用一多通道滤波器，不同通道中卷积核的空洞率不同，从而形成多尺度卷积，该多通道滤波器的通道数等于特征图的通道维数C；利用多尺度卷积将原始气动光学效应湍流退化图像的特征图感受野扩大，经过多尺度卷积后输出的全局区域恢复后的特征图。10.一种计算机存储装置，其特征在于，其内存储有可被处理器执行的计算机程序，该计算机程序执行权利要求1-5中任一项所述的多尺度自校准气动光学效应湍流退化图像复原方法。
说明书desc
技术领域本发明涉及图像处理领域，尤其涉及一种基于多尺度自校准网络的气动光学效应湍流退化图像复原方法及系统。背景技术当飞行器到达一定的速度后周围空气产生的压缩效应会使流场密度发生改变，使光学系统成像的性能造成不利影响。由气动光学效应引起的图像模糊会受到各种因素的影响。和生活中的退化图像不同，湍流图像恢复的过程具有更多复杂的因素：1.大气折射率的改变会影响光学系统成像过程中图像的分辨率；2.空气层中的低空风切变和空气层中的不稳定性、湍流介质的影响及传输过程中设备的不完善造成图像质量下降；3.原图像退化的情况未知，难以从湍流退化图像中估计退化模型，且各种自然现象造成了随机因素的干扰。现有的传统气动光学效应退化图像复原方法通常采用三种方式：1、流场控制方法；2、自适应光学方法；3、数字图像复原方法。以上方法能够减小气动光学效应的影响，但现有的算法对其求解出的点扩散函数始终会有偏差。发明内容本发明主要目的在于提供一种可以提高光学效应湍流退化图像复原精度的方法。本发明所采用的技术方案是：提供一种多尺度自校准气动光学效应湍流退化图像复原方法，包括以下步骤：S1、提取原始气动光学效应湍流退化图像的特征图，特征图大小为C×H×W，其中通道维数为C，H、W分别为湍流退化图像的高、宽；S2、通过预先构建的自校准网络对特征图进行校准，具体沿着通道维度将特征图分离为两个子特征图，每个子特征图的通道数为C/2，提取其中一个子特征图的高、低分辨率空间特征，并进行加权融合，得到校准空间特征；提取另一个子特征图的原始分辨率空间特征；将原始分辨率空间特征与校准空间特征进行融合，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；S3、对原始气动光学效应湍流退化图像的特征图进行多尺度卷积恢复，得到针对全局区域的全局恢复特征图；S4、将局部融合特征图和全局恢复特征图合并，并通过卷积对合并后的特征图进行图像复原。接上述技术方案，步骤S2中，将融合特征图作为输入，重复m次融合操作，将m个融合特征图进行级联，作为终的融合特征图，其中m为自然数。接上述技术方案，步骤S2中对高、低分辨率空间特征使用sigmoid函数进行加权融合，得到校准空间特征。接上述技术方案，步骤S2中具体采用卷积层提取湍流退化图像的特征图。接上述技术方案，步骤S3中，具体利用一多通道滤波器，不同通道中卷积核的空洞率不同，从而形成多尺度卷积，该多通道滤波器的通道数等于特征图的通道维数C；利用多尺度卷积将原始气动光学效应湍流退化图像的特征图感受野扩大，经过多尺度卷积后输出的全局区域恢复后的特征图。本发明还提供一种基于多尺度自校准网络的气动光学效应湍流退化图像复原系统，包括：特征图像提取模块，用于提取原始气动光学效应湍流退化图像的特征图，特征图大小为C×H×W，其中通道维数为C，H、W分别为湍流退化图像的高、宽；局部模糊区域校准模块，用于通过预先构建的自校准网络对特征图进行校准，具体沿着通道维度将特征图分离为两个子特征图，每个子特征图的通道数为C/2，提取其中一个子特征图的高、低分辨率空间特征，并进行加权融合，得到校准空间特征；提取另一个子特征图的原始分辨率空间特征；将原始分辨率空间特征与校准空间特征进行融合，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；全局区域恢复模块，用于对原始气动光学效应湍流退化图像的特征图进行多尺度卷积恢复，得到针对全局区域的全局恢复特征图；图像复原模块，用于将局部融合特征图和全局恢复特征图合并，并通过卷积对合并后的特征图进行图像复原。接上述技术方案，局部模糊区域校准模块还用于具体将融合特征图作为输入，重复m次融合操作，将m个融合特征图进行级联，作为终的融合特征图，其中m为自然数。接上述技术方案，局部模糊区域校准模块具体对高、低分辨率空间特征使用sigmoid函数进行加权融合，得到校准空间特征。接上述技术方案，全局区域恢复模块具体用于：具体利用一多通道滤波器，不同通道中卷积核的空洞率不同，从而形成多尺度卷积，该多通道滤波器的通道数等于特征图的通道维数C；利用多尺度卷积将原始气动光学效应湍流退化图像的特征图感受野扩大，经过多尺度卷积后输出的全局区域恢复后的特征图。本发明还提供一种计算机存储装置，其内存储有可被处理器执行的计算机程序，该计算机程序执行上述技术方案所述的多尺度自校准气动光学效应湍流退化图像复原方法。本发明产生的有益效果是：本发明通过自校准网络对高、低分辨率空间特征加权融合得到校准空间特征，之后融合气动光学效应湍流退化图像特征图的校准空间特征和原始分辨率空间特征，在保留原始图像特征的同时对图像的局部区域进行了校准，得到局部融合特征图。进行多次校准后，局部模糊区域得到更精确的恢复。进一步地，多尺度卷积利用不同空洞率的空洞卷积对全局模糊区域中的感受野进行不同程度的扩大并集成了不同尺度的特征，可学习到更大的模糊范围和多尺度信息，能够提取有利于恢复图像的细节信息。可见，本发明既校准了图像中的局部模糊区域，又使图像中全局区域中的细节得到有效复原，从而提升了图像整体复原的质量。附图说明下面将结合附图及实施例对本发明作进一步说明，附图中：图1为本发明实施例多尺度自校准气动光学效应湍流退化图像复原方法的流程图；图2为本发明另一实施例多尺度自校准气动光学效应湍流退化图像复原方法的流程图；图3为本发明实施例多尺度自校准网络的示意图；图4为本发明图像局部模糊区域自校准过程图；图5为本发明实施例测试结果。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明。如图1所示，本发明实施例多尺度自校准气动光学效应湍流退化图像复原方法，包括以下步骤：S101、提取原始气动光学效应湍流退化图像的特征图，特征图大小为C×H×W，其中通道维数为C，H、W分别为湍流退化图像的高、宽；S102、通过预先构建的自校准网络对特征图进行校准，具体沿着通道维度将特征图分离为两个子特征图，每个子特征图的通道数为C/2，提取其中一个子特征图的高、低分辨率空间特征，并进行加权融合，得到校准空间特征；提取另一个子特征图的原始分辨率空间特征；将原始分辨率空间特征与校准空间特征进行融合，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；S103、对原始气动光学效应湍流退化图像的特征图进行多尺度卷积恢复，得到针对全局区域的全局恢复特征图；S104、将局部融合特征图和全局恢复特征图合并，并通过卷积对合并后的特征图进行图像复原。进一步地，步骤S102中，可将融合特征图作为输入，重复m次融合操作，将m个融合特征图进行级联，作为终的融合特征图，其中m为自然数。步骤S102中对高、低分辨率空间特征使用sigmoid函数进行加权融合，得到校准空间特征。进一步地，步骤S102中可具体采用卷积层提取湍流退化图像的特征图。步骤S103中，具体利用一多通道滤波器，不同通道中卷积核的空洞率不同，从而形成多尺度卷积，该多通道滤波器的通道数等于特征图的通道维数C；利用多尺度卷积将原始气动光学效应湍流退化图像的特征图感受野扩大，经过多尺度卷积后输出的全局区域恢复后的特征图。本发明通过空洞率不同的空洞卷积构建多尺度卷积。空洞率的不同对全局模糊区域的感受野扩大程度不同，因此多尺度卷积有助于集成不同尺度的特征，从而有助于对不同模糊范围、模糊程度的模糊区域进行复原。本发明另一实施例的基于多尺度自校准网络的气动光学效应湍流退化图像复原方法，可在Linux 操作系统平台采用python语言编写，如图2所示，包括以下步骤：S201、利用气动光学效应湍流退化图像仿真软件，获得气动光学效应序列湍流退化图像数据库，将数据库划分为训练集和测试集，并在测试样本集中加入真实场景气动光学效应湍流退化图像；S202、通过训练集中的样本数据训练预先构建的自校准网络，具体训练过程包括：输入气动光学效应湍流退化图像，提取气动光学效应湍流退化图像特征图；关注气动光学效应湍流退化图像特征图的局部模糊区域，并多次校准特征图局部特征，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；学习气动光学效应湍流退化图像特征图中更大的模糊范围和多尺度信息并恢复图像细节，得到全局恢复特征图；合并局部融合特征图和全局恢复特征图，并通过卷积对合并后的图进行复原。提取原始气动光学效应湍流退化图像的特征图，特征图大小为C×H×W，其中通道维数为C，H、W分别为湍流退化图像的高、宽；通过预先构建的自校准网络对特征图进行校准，具体沿着通道维度将特征图分离为两个子特征图，每个子特征图的通道数为C/2，提取其中一个子特征图的高、低分辨率空间特征，并进行加权融合，得到校准空间特征；提取另一个子特征图的原始分辨率空间特征；将原始分辨率空间特征与校准空间特征进行融合，得到针对湍流退化图像局部模糊区域校准的局部融合特征图；将局部融合特征图作为输入，重复m次融合操作，再将m个融合特征图进行级联，作为最终的局部融合特征图，其中m为自然数。对原始气动光学效应湍流退化图像的特征图进行多尺度卷积恢复，得到针对全局区域的全局恢复特征图；将局部融合特征图和全局恢复特征图合并；通过卷积对合并后的特征图进行图像复原。可采用端到端的训练策略，通过训练集对多尺度自校准网络进行不断优化，直到获得最优权重，得到训练好的自校准网络；S203、利用测试样本集对训练好的自校准网络进行测试，对该自校准网络的性能进行评估；S204、将待复原的气动光学效应湍流退化图像输入到经评估符合要求的自校准网络，输出复原后的图像。进一步地，如图3所示，步骤S2中采用特征提取模块提取气动光学效应湍流退化图像特征图。该模块利用单个3×3的卷积层提取大小为C×H×W的气动光学效应湍流退化图像特征图。其中C表示特征图通道数，H和W分别表示特征图的高和宽。所述提取的气动光学效应湍流退化图像特征图表示为：SSF=CSFISF表示输入的气动光学效应湍流退化图像，CSF表示卷积操作，SSF表示得到的气动光学效应湍流退化图像特征图。步骤S3中，依据上一步得到的气动光学效应湍流退化图像特征图SSF，将其沿着通道维度C分离为两个子特征图，每个子特征图的通道数为C/2。本发明的自校准过程如图4所示，其中一个子特征图进行了下采样操作并使用卷积层进行特征提取，学习低分辨率特征空间的表示。同时对该子特征图进行上采样并使用卷积层进行特征提取，学习高分辨率特征空间的表示。对于一幅图像I，对其进行s倍下采样，即得到×尺寸的分辨率图像。由于子特征图进行了下采样操作，意味着子特征图进行了图像缩小，这个缩小的图像分辨率低，当用卷积层提取特征的时候学习到的就是低分辨率特征空间的表示。同样的，对于上采样的子特征图，意味着子特征图进行了图像放大, 从而可以得到更高分辨率的图像，当用卷积层提取特征的时候学习到的就是高分辨率特征空间的表示。可对高、低分辨率空间特征使用sigmoid函数进行加权融合，得到校准后的空间特征。对于另外一个子特征图，利用卷积层提取原始分辨率空间的特征。将原始分辨率空间的特征与校准特征进行融合得到输出Y 1。将融合得到输出Y 1作为输入，重复步骤S3的操作，得到输出Y 2，以此类推，重复m次操作。将m个输出, , …,进行级联，如图3所示展现了m个输出得到总输出Y M的级联过程，将Y M表示为：Y M=CsumY M表示级联, , …,的总输出，Csum表示对, , …,级联操作。Y m表示第m次的输出。进一步地，如图3所示，步骤S4中，具体利用一多通道滤波器，不同通道中卷积核的空洞率不同，从而形成多尺度卷积，该多通道滤波器的通道数等于特征图的通道维数C；利用多尺度卷积将原始气动光学效应湍流退化图像的特征图感受野扩大，经过多尺度卷积后输出的全局区域恢复后的特征图。进一步地，步骤S5中，将气动光学效应湍流退化图像特征图SSF和的级联后的输出Y M进行逐像素相加，使局部模糊区域校准后的特征图和全局模糊区域恢复后的特征图进行组合并输出SDF：SDF=SSF+WSC Csum= SSF+WSCY MWSC是设置在Y M后的3×3卷积的权重，SSF表示原始的气动光学效应湍流退化图像特征图。采用3×3的卷积层将所述的组合后的特征图重建为清晰图像：ICI=CRec，CRec表示卷积操作，ICI表示所述复原图像。进一步地，步骤S6具体采用训练样本集，通过自动微分技术、使用基于随机梯度下降和反向传播算法，构建损失函数，N表示数据集的总数量，HDRN表示整个多尺度自校准网络， IiBI表示训练集中的第i张气动光学效应湍流退化图像，IiCI表示第i张原图像。利用损失函数L优化多尺度自校准网络，更新网络参数θ，获得训练样本集的权重；在采用训练集权重的基础上，测试样本集对多尺度自校准网络进行测试。测试采用的是经过训练后的自校准网络，测试相当于是将湍流退化图像送到网络中，它直接就会出来复原后的图像。从直观上来讲它变得更清晰了，但一般会将测试后的结果进行评估以此来验证网络的有效性。本发明实施例采用的是峰值信噪比评价指标对测试之后的结果进行评价的。该评价指标是图像质量评估的常用指标，其值越大表明图像的质量越好。本发明提供一个实施案例，利用气动光学效应湍流退化图像仿真软件，获得气动光学效应序列湍流退化图像数据库，将数据库划分为训练集和测试集，并在测试样本集中加入真实场景气动光学效应湍流退化图像；其中1000 幅原图像和1000幅气动光学效应湍流退化图像作为训练集，50 幅图像作为测试数据集。数据集中图像大小均为256*256像素。如图5所示的测试结果表明和原先输入的湍流退化图像相比，其质量更好，这表明经过训练的网络模型对于湍流退化图像的复原是有效的。用测试样本进行自校准网络测试时，具体可使用一个峰值信噪比评价指标对重建后的结果进行评价。在训练的每次迭代的过程中，初始学习率设置为10-4，参数设置：m=M=20，用PyTorch在GeForce GTX Titan V上实现整体模型架构，训练周期为800epoch，训练完成后保存最优的模型参数。在测试阶段，从气动光学效应湍流退化图像数据集中另外选择50幅图像作为测试数据集，其中退化图的平均PSNR=20.006dB。采用训练得到的最优模型参数进行测试，得到复原图像，平均耗时1.18s，恢复图像的平均PSNR=32.361 dB，测试结果如图5所示。从图中可以很直观的看见我们输入的是PSNR=20.006dB的湍流退化图像，在最优模型的基础上经过整个网络恢复后得到了复原图像，且复原图像平均PSNR=32.361dB，有了明显的上升，这证明我们的网络对气动光学效应湍流退化图像的恢复是有效的。本申请还提供一种计算机可读存储介质，如闪存、硬盘、多媒体卡、卡型存储器、随机访问存储器、静态随机访问存储器、只读存储器、电可擦除可编程只读存储器、可编程只读存储器、磁性存储器、磁盘、光盘、服务器、App应用商城等等，其上存储有计算机程序，程序被处理器执行时实现相应功能。本实施例的计算机可读存储介质用于在被处理器执行时实现方法实施例的多尺度自校准气动光学效应湍流退化图像复原方法。应当理解的是，对本领域普通技术人员来说，可以根据上述说明加以改进或变换，而所有这些改进和变换都应属于本发明所附权利要求的保护范围。
