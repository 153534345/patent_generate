标题title
一种基于长时间序列的植被特征提取及选择方法
摘要abst
本发明提供一种基于长时间序列的植被特征提取及选择方法，包括对一年内各月共12景Sentinel‑2时序影像与同年间11月份的一景Sentinel‑1影像进行预处理、进行双极化分解并提取极化植被指数、纹理特征和后向散射系数共17个特征；进行B2～B8、B11和B12波段提取并进行重采样；提取12景各景影像数据NDVI均值与IRECI均值，按时间绘制折线并提取VFC均值；分别时序折线插值与平滑滤波，提取14个相关物候参数；获得基于VFC的新型NDVI时序折线和IRECI时序折线，从中提取新型物候参数14个；根据SVM样本训练结果，利用人工蜂群特征选择算法对提取的17个极化特征与28个光学特征进行特征选择，筛选出分类的最优特征子集。
权利要求书clms
1.一种基于长时间序列的植被特征提取及选择方法，其特征在于，包括以下步骤：步骤1，对一年内各月共12景Sentinel-2时序影像与同年间11月份的一景Sentinel-1影像进行预处理，以确保13景影像数据的坐标系统和覆盖范围统一，且提高图像的目视解译效果；步骤2，对预处理后的Sentinel-1极化影像进行双极化分解并提取极化植被指数、纹理特征和后向散射系数共17个特征；步骤3，对预处理后的12景Sentinel-2光学影像数据进行B2～B8、B11和B12波段提取并进行重采样；步骤4，重采样后提取12景各景影像数据的归一化植被指数NDVI均值与新型倒红边叶绿素指数IRECI均值，按时间绘制折线并提取该年植被覆盖度VFC均值；步骤5，分别对NDVI与IRECI时序折线插值与平滑滤波后，得到时序曲线，从中提取14个相关物候参数；步骤6，计算新型植被指数以获得基于VFC的新型NDVI时序折线和IRECI时序折线，在对二者进行插值与平滑滤波后得到曲线，从中提取新型物候参数14个；步骤7，根据SVM样本训练结果，利用人工蜂群特征选择算法对提取的17个极化特征与28个光学特征进行特征选择，筛选出分类的最优特征子集。2.根据权利要求1所述的一种基于长时间序列的植被特征提取及选择方法，其特征在于，所述步骤2中，为进行Sentinel-1双极化数据分解，在预处理过程中提取协方差矩阵C2；双极化分解方法采用H/A/Alpha分解法，得到分解后的5个极化分解参数；极化植被指数RVI公式如下：以上公式中和分别为极化影像数据VH通道与VV通道的后向散射系数。3.根据权利要求2所述的一种基于长时间序列的植被特征提取及选择方法，其特征在于，所述步骤4中，归一化植被指数NDVI、新型倒红边叶绿素指数IRECI公式以及植被覆盖度VFC如下：以上公式中NIR、R分别代表Sentinel-2中的B8、B4波段；ρ783、ρ665、ρ705和ρ740分别代表Sentinel-2中的B7、B4、B5和B6波段；ω为每个月VFC的均值。4.根据权利要求3所述的一种基于长时间序列的植被特征提取及选择方法，其特征在于，所述步骤5中，对提取出的NDVI与IRECI时序折线采用差值法与Savitzky-Golay滤波器对其进行平滑滤波，获得时序拟合曲线；S-G滤波器所含的两个参数包括滑动窗口数值与多项式阶数；滑动窗口数值设置在3到7之间；多项式阶数设置在2到4之间；物候参数为滤波后植被生长季始期、生长季末期、生长季始期和生长季末期的导数值、生长季始期和生长季末期之间差值、生长季期间数值的积分和生长季期间最大值与最小值间的差值。5.根据权利要求4所述的一种基于长时间序列的植被特征提取及选择方法，其特征在于，所述步骤6中，新的时序植被指数公式如下所示：上式中Time Index在此发明中指12景影像各景的NDVI均值或IRECI均值与一年的植被覆盖度均值的商组成的时序折线。6.根据权利要求5所述的一种基于长时间序列的植被特征提取及选择方法，其特征在于，所述步骤7中，将基于面向对象分割后的对象作为一个单元，选取不同植被样本作为数据集，将其分割为训练集和测试集。在确认了样本的维度、同一蜜源采蜜次数与迭代次数后，对个蜜源进行初始化，利用随机化公式即公式7随机生成某样本特征即蜜源并计算其适宜度：上式中中j代表蜜源即随机属于某样本的特征，和分别代表i维所有类别维度中数值的最大与最小值；适宜度采用支持向量机模型SVM进行训练得出训练结果即正确率；随后为蜜源分配一只雇佣蜂，按式8进行搜索，产生新蜜源；式中是均匀分布的随机数，决定扰动幅度；指代表邻域蜜源即同一特征其他类别数值，代表雇佣蜂对这个j蜜源的更新所得的结果；得到新蜜源后，同样计算其适应度，利用贪婪算法，比较新旧蜜源适应值，选择优者保存旧蜜源适应度；之后每一个跟随蜂依据概率选择一个蜜源，概率公式为:其中fiti是可能解Xj的适应值；对于被选择的蜜源，跟随蜂根据上面概率公式搜寻新的可能解并采用与雇佣蜂相同的方式进行搜索，根据贪婪选择的方法确定保留的蜜源；当所有的雇佣蜂和跟随蜂都搜索完整个搜索空间时，如果一个蜜源的适应值在给定的次数内没有被提高,则丢弃该蜜源，而与该蜜源相对应的采蜜蜂变成探索蜂，探索蜂通过公式7搜索新的可能解并计算其适应度，即SVM训练的正确率；然后继续以上步骤直至达到迭代次数；最后获得经过指定次数更新迭代的最佳特征与历次更新的其他蜜源适应度解集；t代表迭代次数；再对被淘汰的蜜源进行适应度排序，获取排序靠后的特征与最佳特征组成最佳特征子集。
说明书desc
技术领域本发明属于图像处理领域，主要涉及遥感影像数据特征提取及选择，是一种基于长时间序列的植被特征提取及选择方法，具体是一种长时间序列的植被特征提取与基于人工蜂群算法的特征选择方法。背景技术植被作为覆盖地球表面31.7％的地表生物，与气候、土壤、地形、动物界及水等自然环境要素密切相关。面对植被的多样性与植被覆盖的密集程度，传统且单一的遥感数据无法将地表植被提取区分。为此本发明根据不同植被的生长周期，在特征提取方面将植被物候信息结合植被覆盖度提出了一种新型的特征参数，充分考虑到植被的生长形式与生长状态。Sentinel-2影像的红边与短波波段与植被叶面积和植被茂密程度的较好相关性，与Sentinel-1影像的极化特征能进一步区分不同类型的植被。在此过程中，为提高精度和速度，避免无关特征的影响与信息的冗余，选取相关性强、区分力度大的特征是至关重要的。人工蜂群算法一种基于群智能的全局优化算法，其直观背景来源于蜂群的采蜜行为，蜜蜂根据各自的分工进行不同的活动，并实现蜂群信息的共享和交流，从而找到问题的最优解。属于群智能算法的一种。该算法每次迭代中都进行全局和局部搜索，因而找出最优解的概率大大增加，并在较大程度上避免了局部最优。但其本质是一种优化算法，因此本发明提出了将子集的选择看作是一个搜索寻优问题，采用支持向量机模型训练结果作为筛选特征适应度评价依据，最终得到最优特征子集。发明内容本发明的目的在于提出一种基于长时间序列的植被特征提取及选择方法，结合Sentinel-2近红外和红边波段以及Sentinel-1极化特征，采用通过SVM模型训练的人工蜂群特征选择方法筛选出最优特征子集，避免了局部最优，进一步提高不同植被的区分度。由此，本发明方法步骤如下所示；步骤1，对一年内各月共12景Sentinel-2时序影像与同年间11月份的一景Sentinel-1影像进行预处理，以确保13景影像数据的坐标系统和覆盖范围统一，且提高图像的目视解译效果；步骤2，对预处理后的Sentinel-1极化影像进行双极化分解并提取极化植被指数、纹理特征和后向散射系数共17个特征；步骤3，对预处理后的12景Sentinel-2光学影像数据进行B2～B8、B11和B12波段提取并进行重采样；步骤4，重采样后提取12景各景影像数据的归一化植被指数均值与新型倒红边叶绿素指数均值，按时间绘制折线并提取该年植被覆盖度均值；步骤5，分别对NDVI与IRECI时序折线插值与平滑滤波后，得到时序曲线，从中提取14个相关物候参数；步骤6，计算新型植被指数以获得基于VFC的新型NDVI时序折线和IRECI时序折线，在对二者进行插值与平滑滤波后仍可以得到曲线，从中提取新型物候参数14个；步骤7，根据SVM样本训练结果，利用人工蜂群特征选择算法对提取的17个极化特征与28个光学特征进行特征选择，筛选出分类的最优特征子集。进一步的，所述步骤2中，为进行Sentinel-1双极化数据分解，须在预处理过程中提取协方差矩阵C2。双极化分解方法采用H/A/Alpha分解法，得到分解后的5个极化分解参数。此外，极化植被指数RVI公式如下：以上公式中和分别为极化影像数据VH通道与VV通道的后向散射系数。进一步的，所述步骤4中，归一化植被指数NDVI、新型倒红边叶绿素指数IRECI公式以及植被覆盖度VFC如下：以上公式中NIR、R分别代表Sentinel-2中的B8、B4波段；ρ783、ρ665、ρ705和ρ740分别代表Sentinel-2中的B7、B4、B5和B6波段；ω为每个月VFC的均值。进一步的，所述步骤5中，对提取出的NDVI与IRECI时序折线采用差值法与Savitzky-Golay滤波器对其进行平滑滤波，获得时序拟合曲线。这种滤波器最大的特点在于在滤除噪声的同时可以确保时序曲线的形状、宽度不变。S-G滤波器所含的两个参数包括滑动窗口数值与多项式阶数。为防细节被过滤掉或平滑效果不明显，滑动窗口数值设置在3到7之间；多项式阶数设置在2到4之间，阶数越低，平滑效果越好。物候参数为滤波后植被生长季始期、生长季末期、生长季始期和生长季末期的导数值、生长季始期和生长季末期之间差值、生长季期间数值的积分和生长季期间最大值与最小值间的差值。进一步的，所述步骤6中，新的时序植被指数公式如下所示：上式中Time Index在此发明中指12景影像各景的NDVI均值或IRECI均值与一年的植被覆盖度均值的商组成的时序折线。进一步的，所述步骤7中，将基于面向对象分割后的对象作为一个单元，选取不同植被样本作为数据集，将其分割为训练集和测试集。ABC算法通过模拟实际蜜蜂的采蜜机制将人工蜂群分为3类：雇佣蜂、跟随蜂、探索蜂。假设问题的解空间是D维的，雇佣蜂和跟随蜂的个数都是SN，雇佣蜂的个数或跟随蜂的个数与蜜源的数量相等。则标准的ABC算法将优化问题的求解过程看成是在D维搜索空间中进行搜索。每个蜜源的位置代表一类样本的一个特征，搜索最优解就是在样本特征中寻找最佳的特征X＝，而判别是否最佳的标准则是解的适应度即该特征通过模型训练的正确率。在确认了样本的维度、同一蜜源采蜜次数与迭代次数后，对个蜜源进行初始化，利用随机化公式随机生成某样本特征并计算其适宜度：上式中中j代表蜜源即随机属于某样本的特征，和分别代表i维所有类别维度中数值的最大与最小值。适宜度采用支持向量机模型进行训练得出训练结果即正确率。随后为蜜源分配一只雇佣蜂，按式8进行搜索，产生新蜜源。式中是均匀分布的随机数，决定扰动幅度。指代表邻域蜜源，代表雇佣蜂对这个j蜜源的更新所得的结果。得到新蜜源后，同样计算其适应度，利用贪婪算法，比较新旧蜜源适应值，选择优者保存旧蜜源适应度。之后每一个跟随蜂依据概率选择一个蜜源，概率公式为:其中fiti是可能解Xj的适应值。对于被选择的蜜源，跟随蜂根据上面概率公式搜寻新的可能解并采用与雇佣蜂相同的方式进行搜索，根据贪婪选择的方法确定保留的蜜源。当所有的雇佣蜂和跟随蜂都搜索完整个搜索空间时，如果一个蜜源的适应值在给定的次数内没有被提高,则丢弃该蜜源，而与该蜜源相对应的采蜜蜂变成探索蜂，探索蜂通过公式7搜索新的可能解并计算其适应度。然后继续以上步骤直至达到迭代次数。最后可获得经过指定次数更新迭代的最佳特征与历次更新的其他蜜源适应度解集。t代表迭代次数。再对被淘汰的蜜源进行适应度排序，获取排序靠后的特征与最佳特征组成最佳特征子集。本发明提供的一种基于长时间序列的植被特征提取及选择方法，具有的技术效果：分析植被生长周期状态的同时结合植被叶片面积与生长覆盖度，提升了生长周期相似的植被间的区分度；此外，采用ABC人工蜂群算法对提取特征进行筛选，在避免了局部最优解的基础上提取类别最优特征子集，进一步提高了后期植被分类精度与速度。附图说明图1为本发明提供的一种基于长时间序列的植被特征提取及选择方法的流程示意图；图2为实施例植被指数时序曲线物候参数的示意图；图3为本发明提供的人工蜂群算法特征提取的初始示意图；图4为本发明提供的人工蜂群搜索更新最佳特征蜜源的示意图；图5为本发明提供的人工蜂群算法特征提取中观察蜂更新蜜源的示意图；图6为本发明提供的人工蜂群算法特征提取中搜索蜜源迭代过程的示意图；具体实施方式以下实施例仅用于更清楚地说明本发明的技术方案，流程图如图1：步骤1，对一年内各月共12景Sentinel-2时序影像与同年间11月份的一景Sentinel-1影像进行预处理，以确保13景影像数据的坐标系统和覆盖范围统一，且提高图像的目视解译效果。Sentinel-1需提取协方差矩阵C2便于之后极化分解，而对各景Sentinel-2影像则需批量完成包括几何校正、辐射校正和裁剪处理，以确保13景影像数据的范围一致且效果清晰；步骤2，对预处理后的Sentinel-1极化影像进行双极化分解，提取5个分解特征、1个极化植被指数、9个纹理特征和2个后向散射系数共17个特征；特别说明双极化分解的分解方法只有H/A/Alpha分解法，如若数据采用全极化数据可加入其他极化分解结果。再者，极化植被指数公式仅针对双极化数据，全极化的极化植被指数公式与本发明中所展示的不同。以上公式中和分别为极化影像数据后向散射系数。步骤3，对预处理后的12景Sentinel-2光学影像数据进行B2～B8、B11和B12波段提取并进行重采样；由于Sentinel-2不同波段分辨率不一致，波段提取后需要重采样保证波段分辨率统一。其次提取B8、B11和B12，首要原因是在于近红外波段与短波波段特别善于突出呈现为深绿色的茂密植被。在植被覆被密度方面能有较大体现，此外B5至B6的红边波段对监测植被生长十分有效，较适用于观察植被物候变化。步骤4，重采样后提取12景各景影像数据的归一化植被指数均值与新型倒红边叶绿素指数均值，按时间绘制折线并提取该年的植被覆盖度均值；归一化植被指数、新型倒红边叶绿素指数公式以及植被覆盖度如下：以上公式中NIR、R分别代表Sentinel-2中的B8、B4波段；ρ783、ρ665、ρ705和ρ740分别代表Sentinel-2中的B7、B4、B5和B6波段；ω为每个月VFC的均值。步骤5，对NDVI与IRECI时序折线进行插值与平滑滤波后，得到时序曲线，如图2，从两条时序曲线中提取14个物候参数，即植被生长季始期、生长季末期、生长季始期和生长季末期的导数值、生长季始期和生长季末期之间差值、生长季期间数值的积分，以及生长季期间最大值与最小值间的差值，如图2中所示；对提取出的NDVI与IRECI时序折线采用差值法与Savitzky-Golay滤波器对其进行平滑滤波，获得时序拟合曲线。这种滤波器最大的特点在于在滤除噪声的同时可以确保曲线的形状、宽度不变。其所含的两个参数包括滑动窗口数值与多项式阶数。为防细节容易被过滤掉或平滑效果不明显，滑动窗口数值设置在3到7之间，使之参与拟合的值多，效果较好；多项式阶数设置在2到4之间，阶数越低，平滑效果越好。进一步的，所述步骤6中，新的时序植被指数公式如下所示：上式中Time Index在此发明中指12景影像各景的NDVI均值或IRECI均值与一年的植被覆盖度均值的商组成的时序折线。步骤6，计算新型植被指数以获得基于VFC的新型NDVI时序折线和IRECI时序折线，在对二者进行插值与平滑滤波后得到时序曲线，从中提取新型物候参数14个；其中的滤波器采用的与步骤5中的Savitzky-Golay滤波器一致；提取的物候参数也与步骤5一致。步骤7，根据SVM样本训练结果，利用人工蜂群特征选择算法对提取的17个极化特征与28个光学特征进行特征选择，筛选出分类的最优特征子集。具体步骤是将基于面向对象分割后的对象作为一个单元，选取不同植被样本作为数据集，将其分割为训练集和测试集。ABC算法通过模拟实际蜜蜂的采蜜机制将人工蜂群分为3类：雇佣蜂、跟随蜂、探索蜂。假设问题的解空间是D维的，雇佣蜂和跟随蜂的个数都是SN，雇佣蜂的个数或跟随蜂的个数与蜜源的数量相等。则标准的ABC算法将优化问题的求解过程看成是在D维搜索空间中进行搜索。每个蜜源的位置代表该类别中对应样本的特征值，搜索最优解就是在样本特征中寻找最佳的特征X＝，而判别是否最佳的标准则是解的适应度即该特征通过模型训练的正确率，如图4。在确认了维度、同一蜜源采蜜次数与迭代次数后，对个蜜源进行初始化，如图3，利用随机化公式随机选中其中一类别中对应样本的特征值样本特征并计算其适宜度：上式中中j代表蜜源即随机属于某样本的特征，和分别代表i维所有类别维度中数值的最大与最小值。适宜度采用支持向量机模型进行训练得出训练结果即正确率。随后为蜜源分配一只雇佣蜂，按式8进行搜索，产生新蜜源。式中是均匀分布的随机数，决定扰动幅度。指代表邻域蜜源，代表雇佣蜂对这个j蜜源的更新所得的结果，如图5。得到新蜜源后，同样计算其适应度，利用贪婪算法，比较新旧蜜源适应值，选择优者保存旧蜜源适应度。如果一个蜜源经过多次开采没被更新，那么需抛弃这个蜜源，启动探索蜂阶段。之后每一个跟随蜂依据概率选择一个蜜源，概率公式为:其中fiti是可能解Xj的适应值。对于被选择的蜜源，跟随蜂根据上面概率公式搜寻新的解并采用与雇佣蜂相同的方式进行搜索，根据贪婪选择的方法确定保留的蜜源。当所有的雇佣蜂和跟随蜂都搜索完整个搜索空间时，如果一个蜜源的适应值在给定的次数内没有被提高，则丢弃该蜜源，而与该蜜源相对应的采蜜蜂变成探索蜂，探索蜂通过公式7搜索新的可能解并计算其适应度。然后继续以上步骤直至达到迭代次数。最后可获得经过指定次数更新迭代的最佳特征与历次更新的其他蜜源适应度解集。t代表迭代次数，如图6。再对被淘汰的蜜源进行适应度排序，获取排序靠后的特征与最佳特征组成最佳特征子集。
