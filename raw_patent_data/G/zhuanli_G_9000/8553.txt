标题title
一种基于可视化目标标记的玻片细胞扫描方法
摘要abst
本发明涉及图像处理技术领域，公开了一种基于可视化目标标记的玻片细胞扫描方法，在20倍物镜基于细胞颜色进行白细胞识别，并在识别完成后，对高低倍镜的玻片步数进行转换；将通过20倍物镜获取的图片进行区域划分，并利用高倍镜对白细胞进行复位扫描和细胞校准；若没有获取到设定数量的细胞，则转入常规流程进行细胞获取，直至获取到设定数量的细胞，同时，为了保证在进行拍摄前的位置的确定，还提前进行了起始点的调试，解决了常规玻片细胞扫描流程无法准确找到白细胞位置，导致整体流程过长的问题，保证识别效率。
权利要求书clms
1.一种基于可视化目标标记的玻片细胞扫描方法，其特征在于，包括以下步骤：在20倍物镜基于细胞颜色进行白细胞识别，并在识别完成后，对高低倍镜的玻片步数进行转换；将通过20倍物镜获取的图片进行区域划分，并利用高倍镜对白细胞进行复位扫描和细胞校准；若没有获取到设定数量的细胞，则转入常规流程进行细胞获取，直至获取到设定数量的细胞。2.如权利要求1所述的基于可视化目标标记的玻片细胞扫描方法，其特征在于，在20倍物镜基于细胞颜色进行白细胞识别，并在识别完成后，对高低倍镜的玻片步数进行转换，包括：根据拍摄图片细胞和背景的颜色以及细胞大小，设定阈值对细胞进行筛选，并且记录白细胞的20倍物镜下的坐标；当筛选的数量达到扫描阈值时，结束20倍拍摄流程；基于设定的起始点，对低倍镜和高倍镜的玻片步数进行转换。3.如权利要求2所述的基于可视化目标标记的玻片细胞扫描方法，其特征在于，基于设定的起始点，对低倍镜和高倍镜的玻片步数进行转换，包括：将20倍物镜下的第一块的设定位置与高倍镜下的起始点进行对应；把20倍物镜拍摄图片中的每张图片的坐标根据像素和视野的对应关系转换成电机步数。4.如权利要求1所述的基于可视化目标标记的玻片细胞扫描方法，其特征在于，将通过20倍物镜获取的图片进行区域划分，并利用高倍镜对白细胞进行复位扫描和细胞校准，包括：把20倍物镜拍摄的每块分为25个区域，将1号区域作为块复位点；在利用100倍物镜拍摄时，每次读取白细胞的位置，然后从块复位点出发，并且在每次拍摄完成后复位到块复位点，再移动到下个块寻找白细胞；对获取的白细胞进行细胞识别，同时计算细胞坐标，并在利用100倍物镜进行下一块的拍摄时，自动补偿坐标，进行细胞校准。5.如权利要求1所述的基于可视化目标标记的玻片细胞扫描方法，其特征在于，在利用20倍物镜进行白细胞识别前，所述方法还包括：对扫描仪器的起始点进行调试，包括手动调试和自动调试。6.如权利要求5所述的基于可视化目标标记的玻片细胞扫描方法，其特征在于，对扫描仪器进行手动调试，包括：在100倍物镜下基于左边边界寻找起始点，移动到20倍物镜下寻找相同区域，根据100倍和20倍电机步数相同的原理，在找到基于边界的起始点后平行移动到阅片区域的左上角；在找到对应起始点后，分别记录下100倍起始点和20倍起始点x、y的运动坐标，并将其作为仪器的起始点参数。
说明书desc
技术领域本发明涉及图像处理技术领域，尤其涉及一种基于可视化目标标记的玻片细胞扫描方法。背景技术常规玻片细胞扫描流程：拍摄图片＞移动镜头一个视野＞再次拍摄，设定好玻片细胞扫描路径后直到扫描的白细胞数量足够，或者是扫描流程超时。该方法所扫描的细胞图像是随机的，无法保证每个视野都有白细胞，这种流程的优点是适应性较广不用对电机的初始步数进行太大的调试，缺点是效率低，拍摄图片的清晰度和细胞位置较差，影响识别效率。发明内容本发明的目的在于提供一种基于可视化目标标记的玻片细胞扫描方法，保证识别效率。为实现上述目的，本发明提供了一种基于可视化目标标记的玻片细胞扫描方法，包括以下步骤：在20倍物镜基于细胞颜色进行白细胞识别，并在识别完成后，对高低倍镜的玻片步数进行转换；将通过20倍物镜获取的图片进行区域划分，并利用高倍镜对白细胞进行复位扫描和细胞校准；若没有获取到设定数量的细胞，则转入常规流程进行细胞获取，直至获取到设定数量的细胞。其中，在20倍物镜基于细胞颜色进行白细胞识别，并在识别完成后，对高低倍镜的玻片步数进行转换，包括：根据拍摄图片细胞和背景的颜色以及细胞大小，设定阈值对细胞进行筛选，并且记录白细胞的20倍物镜下的坐标；当筛选的数量达到扫描阈值时，结束20倍拍摄流程；基于设定的起始点，对低倍镜和高倍镜的玻片步数进行转换。其中，基于设定的起始点，对低倍镜和高倍镜的玻片步数进行转换，包括：将20倍物镜下的第一块的设定位置与高倍镜下的起始点进行对应；把20倍物镜拍摄图片中的每张图片的坐标根据像素和视野的对应关系转换成电机步数。其中，将通过20倍物镜获取的图片进行区域划分，并利用高倍镜对白细胞进行复位扫描和细胞校准，包括：把20倍物镜拍摄的每块分为25个区域，将1号区域作为块复位点；在利用100倍物镜拍摄时，每次读取白细胞的位置，然后从块复位点出发，并且在每次拍摄完成后复位到块复位点，再移动到下个块寻找白细胞；对获取的白细胞进行细胞识别，同时计算细胞坐标，并在利用100倍物镜进行下一块的拍摄时，自动补偿坐标，进行细胞校准。其中，在利用20倍物镜进行白细胞识别前，所述方法还包括：对扫描仪器的起始点进行调试，包括手动调试和自动调试。其中，对扫描仪器进行手动调试，包括：在100倍物镜下基于左边边界寻找起始点，移动到20倍物镜下寻找相同区域，根据100倍和20倍电机步数相同的原理，在找到基于边界的起始点后平行移动到阅片区域的左上角；在找到对应起始点后，分别记录下100倍起始点和20倍起始点x、y的运动坐标，并将其作为仪器的起始点参数。本发明的一种基于可视化目标标记的玻片细胞扫描方法，在20倍物镜基于细胞颜色进行白细胞识别，并在识别完成后，对高低倍镜的玻片步数进行转换；将通过20倍物镜获取的图片进行区域划分，并利用高倍镜对白细胞进行复位扫描和细胞校准；若没有获取到设定数量的细胞，则转入常规流程进行细胞获取，直至获取到设定数量的细胞，同时，为了保证在进行拍摄前的位置的确定，还提前进行了起始点的调试，解决了常规玻片细胞扫描流程无法准确找到白细胞位置，导致整体流程过长的问题，保证识别效率。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明提供的一种基于可视化目标标记的玻片细胞扫描方法的步骤示意图。图2是本发明提供的细胞定位流程图。图3是本发明提供的起始点调试流程图。具体实施方式下面详细描述本发明的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，旨在用于解释本发明，而不能理解为对本发明的限制。在本发明的描述中，需要理解的是，术语“长度”、“宽度”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，在本发明的描述中，“多个”的含义是两个或两个以上，除非另有明确具体的限定。请参阅图1至图3，本发明提供一种基于可视化目标标记的玻片细胞扫描方法，包括以下步骤：S101、在20倍物镜基于细胞颜色进行白细胞识别，并在识别完成后，对高低倍镜的玻片步数进行转换。具体的，根据拍摄图片细胞和背景的颜色和大小设定阈值进行筛选，并且记录白细胞的20倍物镜下的坐标。待筛选的数量足够时，结束20倍拍摄流程，转换到100倍流程下进行识别拍摄。由于高倍镜定位流程中需要读取白细胞位置。所在100倍物镜拍摄流程开始前，需要对记录的20倍物镜下记录的白细胞坐标进行坐标转换，转换成100倍镜流程下的电机运行坐标后再开始高倍镜的识别流程，步数转换方法如下所述：①保证20倍流程下第一块的位置1号区域与100倍流程下的起始点对应，由于20倍和100倍电机步数相同，设定好起始点后，就保证了基于20倍流程下每块位置和100倍流程下每块位置一一对应。②白细胞坐标转换成电机步数：在保证块位置对应的前提下，把20倍拍摄图片中的每张图片的坐标根据像素和视野的对应关系转换成电机步数，在100倍拍摄流程中读取到电机步数后就可以正确的找到白细胞所在的位置了。S102、将通过20倍物镜获取的图片进行区域划分，并利用高倍镜对白细胞进行复位扫描和细胞校准。具体的，在介绍高倍镜和低倍镜的玻片步数转换方法前，需要先介绍高倍镜下的细胞定位流程和常规流程，以便理解步数转换方法的必要性：常规流程：直接进行拍摄，不进行细胞定位，连续移动镜头随机拍摄图片；①不能保证每一个视野都有白细胞；②不能保证每个视野的白细胞都在中心，会出现边缘细胞的情况，影响识别效率。基于可视化目标标记的玻片细胞扫描方法：把20倍拍摄的每块分为25个区域，1号区域是块复位点，在100倍物镜拍摄流程中，每次读取白细胞的位置，然后从复位点出发，保证每次拍摄的细胞都在视野中心，每次拍摄完成后复位到块复位点，保证下次玻片细胞扫描的准确性。拍摄完一个20倍小区域后，复位到每块的1号区域复位点，再移动到下个块寻找细胞。高倍镜下拍摄图片由于电机误差，无法准确的把细胞移动到镜头中心，所以对100倍下的图片进行细胞识别，计算细胞坐标，到下一细胞拍摄时自动补偿坐标，保证每次玻片细胞扫描的准确性。S103、若没有获取到设定数量的细胞，则转入常规流程进行细胞获取，直至获取到设定数量的细胞。具体的，由于白细胞类别的不确定性，以及涂抹细胞和血小板的干扰性，无法保证定位流程能够准确的识别100个白细胞，由于常规流程的适应性较广，所以在该玻片细胞扫描方法运行结束后，细胞数量不达标，转换到常规流程进行补偿，完善了该方法的适应性。由于高倍镜和低倍镜的玻片步数转换方法中20倍物镜视野和100倍物镜视野下的玻片位置需要一一对应，所以在细胞扫描前需要设定仪器的起始点，保证高倍镜视野和低倍镜视野一一对应。所以每款仪器在出厂前都需要调试起始点电机步数。设定流程如下所述：在没有初始步数的时候，仪器无法自动调试，需要手动精调仪器，获得到起始点的初始步数，初始步数可以作为本仪器的初始步数，也可作为之后仪器的自动调试的起始点参数。通常先在100倍物镜下基于左边边界寻找起始点，移动到20倍物镜下寻找相同区域，根据100倍和20倍电机步数相同的原理，在找到基于边界的起始点后平行移动到阅片区域的左上角。在找到后分别记录下100倍起始点和20倍起始点x、y的运动坐标以供之后仪器作为起始点参数，本仪器的手动调试流程结束。获得起始参数后，之后的仪器就可以利用第一台仪器的参数进入自动调试流程：输入起始点参数：把之前一起获得的起始点参数输入本流程。根据参数，在100倍物镜下，根据25个小区域拼接成1个大块的流程，进行移动拍摄，寻找白细胞。并记录下移动位置。找到白细胞后，转入20倍物镜下，根据坐标转换原理反向转换坐标。获得白细胞定位并移动到白细胞位置。由于每台仪器的电机存在误差，无法保证初始点能适配其他仪器，所以在20倍物镜下，拍摄基于白细胞识别区域所在块位置的周围9个块。由于20倍视野比100倍视野广，所以只要保证电机误差在20倍9个块视野范围内，流程就能正常进行。拍摄完9个块后，通过手动寻找对应的白细胞，选择相应的块位置，根据块位置和白细胞距离中心的差值进行补偿。补偿完毕后进行测试流程验证结果，测试流程就是运行定位流程，只识别一个白细胞的情况，若3次测试结果中100倍视野中心都有白细胞，则认定调试完成，流程结束。自动流程细节繁琐，但是不需要手动调节，只需要点击调试＞获得参数＞输入参数＞测试结果，几个简单的操作就可以完成仪器调节。手动调试流程简单，但是需要手动寻找起始点，调节起来费时费力。所以根据仪器精度，写了一个自动调试流程。在获得起始点参数后，保证不同仪器的机械精度在20倍物镜9个块视野内的前提下，能够使用自动调试功能调试之后的所有仪器，使得起始点设置流程操作变得简单。有益效果添加了细胞定位流程的玻片扫描流程：1、增加了20倍的细胞扫描流程和定位流程，增加了高倍镜和低倍镜的细胞识别流程。使得每次相机能够准确的找到白细胞。2、100倍玻片扫描数量大大降低，平均识别100个白细胞由常规流程的1000张图片减小到平均100张图片，大大减少了玻片细胞扫描时间。3、由于每次拍摄图片细胞在中心位置，保证了每次对焦都在白细胞层，保证了连续拍摄时图像的清晰度和识别细胞的准确性。以上所揭露的仅为本发明一种较佳实施例而已，当然不能以此来限定本发明之权利范围，本领域普通技术人员可以理解实现上述实施例的全部或部分流程，并依本发明权利要求所作的等同变化，仍属于发明所涵盖的范围。
