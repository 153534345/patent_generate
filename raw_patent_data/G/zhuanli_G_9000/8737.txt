标题title
产品表面缺陷检测方法、装置、设备及存储介质
摘要abst
本发明公开了一种产品表面缺陷检测方法、装置、设备及存储介质，该方法包括：将待检测产品的产品图片输入预设自编码器模型，以使预设自编码器模型输出产品图片的重构图片；通过基于高斯核函数的SSIM算法确定产品图片的像素点与重构图片的对应像素点之间的差异信息，并根据差异信息确定重构图片的差异得分图；根据差异得分图判断待检测产品是否存在表面缺陷。本发明是通过将待检测产品的产品图片输入预设自编码器模型获得重构图片，通过基于高斯核函数的SSIM算法确定的产品图片和重构图片之间的差异得分图，根据差异得分图判断待检测产品是否存在表面缺陷，能够检测出产品表面存在的细小缺陷，提高了产品表面缺陷检测的准确度。
权利要求书clms
1.一种产品表面缺陷检测方法，其特征在于，所述方法包括：将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；根据所述差异得分图判断所述待检测产品是否存在表面缺陷。2.如权利要求1所述的方法，其特征在于，所述将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片之前，所述方法还包括：获取大量的产品良品图片，并对所述产品良品图片进行预处理，获得若干预处理图片；通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集；将所述模拟缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练；在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。3.如权利要求2所述的方法，其特征在于，所述通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集，包括：从若干预处理图片中依次选取目标预处理图片，并在选取目标预处理图片时生成对应的图形参数；根据所述图形参数在对应的目标预处理图片上构造图形区域，按照预设规则在所述构造图形区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域；为所述多边形区域分配颜色，获得各预处理图片对应电的模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集。4.如权利要求3所述的方法，其特征在于，所述根据所述图形参数在对应的目标处理图片上构造图形区域，按照预设规则在所述构造图形区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域，包括：在所述图形参数为椭圆参数时，根据所述椭圆参数在对应的目标预处理图片上构造椭圆区域，将所述椭圆区域通过极坐标展开；在通过极坐标展开的椭圆区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域。5.如权利要求2所述的方法，其特征在于，所述通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集之后，所述方法还包括：获取若干难检缺陷图片，对所述若干难检图片进行像素级标注，获得若干难检缺陷标注图片；将所述若干难检缺陷标注图片添加至所述模拟缺陷模型训练集，获得混合缺陷模型训练集；将所述混合缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练；在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。6.如权利要求1所述的方法，其特征在于，所述通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异，获得所述重构图片的差异得分图，包括：根据高斯核函数确定在对比所述产品图片的像素点与所述重构图片对应的像素点差异时的窗口初始化值；根据所述窗口初始化值和窗口大小确定单次对比区域，并通过SSIM算法根据所述单次对比区域将所述产品图片与所述重构图片进行差异对比，获得对应像素点的差异得分；在所述产品图片与所述重构图片对应的像素点差异对比完成时，获得所述重构图片的差异得分图。7.如权利要求6所述的方法，其特征在于，所述根据所述差异得分图判断所述待检测产品是否存在表面缺陷，包括：将所述差异得分图中的差异得分与预设阈值进行对比，并判断所述差异得分是否大于预设阈值；在所述差异得分大于预设阈值时，判定与所述差异得分对应的待检测产品区域存在表面缺陷；在所述差异得分小于或等于预设阈值时，判定与所述差异得分对应的待检测产品区域不存在表面缺陷。8.一种产品表面缺陷检测装置，其特征在于，所述装置包括：输入模块，用于将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；确定模块，用于通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；判断模块，用于根据所述差异得分图判断所述待检测产品是否存在表面缺陷。9.一种产品表面缺陷检测设备，其特征在于，所述设备包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的产品表面缺陷检测程序，所述产品表面缺陷检测程序配置为实现如权利要求1至7中任一项所述的产品表面缺陷检测方法的步骤。10.一种存储介质，其特征在于，所述存储介质上存储有产品表面缺陷检测程序，所述产品表面缺陷检测程序被处理器执行时实现如权利要求1至7任一项所述的产品表面缺陷检测方法的步骤。
说明书desc
技术领域本发明涉及产品缺陷检测技术领域，尤其涉及一种产品表面缺陷检测方法、装置、设备及存储介质。背景技术工业产品的表面缺陷对产品的美观度、舒适度和使用性能等产生不良影响，所以在生产产品时需要对产品的表面缺陷进行检测以便及时发现并加以控制。现有的缺陷检测方法包括人工检测和机器视觉检测，人工检测一般采用抽检的方式，易出现漏检的问题，而且检测效率低；机器视觉检测的方法可以很大程度上克服人工检测方法的抽检率低、准确性不高、实时性差、效率低、劳动强度大等弊端，在现代工业中得到越来越广泛的研究和应用，但是机器视觉检测算法仍然存在检测准确度低的问题。随着人工智能的发展，基于非监督分割算法的检测方法得到了更广泛的应用。但是目前的非监督算法只能检出较大较明显的缺陷，无法检测出细小的缺陷，从而出现漏检导致缺陷检测准确度低。因此，如何提高产品表面缺陷检测的准确度成为亟待解决的技术问题。上述内容仅用于辅助理解本发明的技术方案，并不代表承认上述内容是现有技术。发明内容本发明的主要目的在于提供了一种产品表面缺陷检测方法、装置、设备及存储介质，旨在解决现有技术产品表面缺陷检测的准确度低的技术问题。为实现上述目的，本发明提供了一种产品表面缺陷检测方法，所述方法包括以下步骤:将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；根据所述差异得分图判断所述待检测产品是否存在表面缺陷。可选地，所述将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片之前，所述方法还包括：获取大量的产品良品图片，并对所述产品良品图片进行预处理，获得若干预处理图片；通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集；将所述模拟缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练；在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。可选地，所述通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集，包括：从若干预处理图片中依次选取目标预处理图片，并在选取目标预处理图片时生成对应的图形参数；根据所述图形参数在对应的目标预处理图片上构造图形区域，按照预设规则在所述构造图形区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域；为所述多边形区域分配颜色，获得各预处理图片对应电的模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集。可选地，所述根据所述图形参数在对应的目标处理图片上构造图形区域，按照预设规则在所述构造图形区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域，包括：在所述图形参数为椭圆参数时，根据所述椭圆参数在对应的目标预处理图片上构造椭圆区域，将所述椭圆区域通过极坐标展开；在通过极坐标展开的椭圆区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域。可选地，所述通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集之后，所述方法还包括：获取若干难检缺陷图片，对所述若干难检图片进行像素级标注，获得若干难检缺陷标注图片；将所述若干难检缺陷标注图片添加至所述模拟缺陷模型训练集，获得混合缺陷模型训练集；将所述混合缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练；在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。可选地，所述通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异，获得所述重构图片的差异得分图，包括：根据高斯核函数确定在对比所述产品图片的像素点与所述重构图片对应的像素点差异时的窗口初始化值；根据所述窗口初始化值和窗口大小确定单次对比区域，并通过SSIM算法根据所述单次对比区域将所述产品图片与所述重构图片进行差异对比，获得对应像素点的差异得分；在所述产品图片与所述重构图片对应的像素点差异对比完成时，获得所述重构图片的差异得分图。可选地，所述根据所述差异得分图判断所述待检测产品是否存在表面缺陷，包括：将所述差异得分图中的差异得分与预设阈值进行对比，并判断所述差异得分是否大于预设阈值；在所述差异得分大于预设阈值时，判定与所述差异得分对应的待检测产品区域存在表面缺陷；在所述差异得分小于或等于预设阈值时，判定与所述差异得分对应的待检测产品区域不存在表面缺陷。此外，为实现上述目的，本发明还提出一种产品表面缺陷检测装置，所述装置包括：输入模块，用于将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；确定模块，用于通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；判断模块，用于根据所述差异得分图判断所述待检测产品是否存在表面缺陷。此外，为实现上述目的，本发明还提出一种产品表面缺陷检测设备，所述设备包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的产品表面缺陷检测程序，所述产品表面缺陷检测程序配置为实现如上文所述的产品表面缺陷检测方法的步骤。此外，为实现上述目的，本发明还提出一种存储介质，所述存储介质上存储有产品表面缺陷检测程序，所述产品表面缺陷检测程序被处理器执行时实现如上文所述的产品表面缺陷检测方法的步骤。本发明将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；根据所述差异得分图判断所述待检测产品是否存在表面缺陷。由于本发明是通过将待检测产品的产品图片输入预设自编码器模型获得产品图片的重构图片，通过基于高斯核函数的SSIM算法确定的产品图片和重构图片之间的差异信息确定差异得分图，根据差异得分图判断待检测产品是否存在表面缺陷，能够检测出产品表面存在的细小缺陷，提高了产品表面缺陷检测的准确度。附图说明图1是本发明实施例方案涉及的硬件运行环境的产品表面缺陷检测设备的结构示意图；图2为本发明产品表面缺陷检测方法第一实施例的流程示意图；图3为本发明产品表面缺陷检测方法第二实施例的流程示意图；图4为本发明产品表面缺陷检测方法第三实施例的流程示意图；图5为本发明产品表面缺陷检测装置第一实施例的结构框图。本发明目的的实现、功能特点及优点将结合实施例，参照附图做进一步说明。具体实施方式应当理解，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明。参照图1，图1为本发明实施例方案涉及的硬件运行环境的产品表面缺陷检测设备结构示意图。如图1所示，该产品表面缺陷检测设备可以包括：处理器1001，例如中央处理器，通信总线1002、用户接口1003，网络接口1004，存储器1005。其中，通信总线1002用于实现这些组件之间的连接通信。用户接口1003可以包括显示屏、输入单元比如键盘，可选用户接口1003还可以包括标准的有线接口、无线接口。网络接口1004可选的可以包括标准的有线接口、无线接口接口）。存储器1005可以是高速的随机存取存储器，也可以是稳定的非易失性存储器，例如磁盘存储器。存储器1005可选的还可以是独立于前述处理器1001的存储装置。本领域技术人员可以理解，图1中示出的结构并不构成对产品表面缺陷检测设备的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。如图1所示，作为一种存储介质的存储器1005中可以包括操作系统、网络通信模块、用户接口模块以及产品表面缺陷检测程序。在图1所示的产品表面缺陷检测设备中，网络接口1004主要用于与网络服务器进行数据通信；用户接口1003主要用于与用户进行数据交互；本发明产品表面缺陷检测设备中的处理器1001、存储器1005可以设置在产品表面缺陷检测设备中，所述产品表面缺陷检测设备通过处理器1001调用存储器1005中存储的产品表面缺陷检测程序，并执行本发明实施例提供的产品表面缺陷检测方法。本发明实施例提供了一种产品表面缺陷检测方法，参照图2，图2为本发明产品表面缺陷检测方法第一实施例的流程示意图。本实施例中，所述产品表面缺陷检测方法包括以下步骤：步骤S1：将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片。需要说明的是，本实施例的执行主体可以是一种具有数据处理、网络通信以及程序运行功能的计算服务设备，例如平板电脑、个人电脑、手机等，或者是一种能够实现上述功能的电子设备、产品表面缺陷检测设备等。以下以产品表面缺陷检测设备为例，对本实施例及下述各实施例进行说明。可以理解的是，待检测产品可以是需要进行表面缺陷检测的产品；产品图片可以是待检测产品的图片，产品图片可以是通过设置在产线上的照相设备拍照获得，也可以是从设置在产线上的监控设备的视频流中获得，还可以通过其他方式获得，本实施例对此不作限制。应该理解的是，预设自编码器模型可以是预先设置的经过训练的自编码器模型，本实施例中的自编码器模型可以是卷积自编码器，卷积自编码器经过训练获得预设自编码器模型；卷积自编码器由两个结构组成：编码器和解码器，编码器用于提取输入图片的特征，解码器用于根据该特征来生成输入图片的重构图。在具体实现中，对待检测产品进行产品表面缺陷检测时，将待检测产品的产品图片输入预先设置的经过训练的自编码器模型，自编码器模型的编码器提取该产品图片的特征，自编码器模型的解码器根据该特征来生成输入图片的重构图片。步骤S2：通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图。可以理解的是，本实施例使用改进的SSIM算法作为对比算法，SSIM算法由于综合考虑了图片的颜色差异、对比度差异和结构差异，因此能够更好的将两个图像之间的差异区分出来；SSIM算法一般会使用滑动窗口的方式来对两幅图像进行比对，此时需要对窗口的大小和窗口的初始化值进行设置。应该理解的是，传统的SSIM算法使用均值作为窗口的初始化值，导致SSIM算法在进行图像对比时受窗口大小的影响较大，为了检测出大而明显的缺陷，会将窗口设置的较大，会导致小缺陷漏检。可以理解的是，本实施例根据高斯核函数确定窗口的初始化值，通过SSIM算法进行图像对比，高斯核函数可由下式表示：式中，N为窗口大小；x、y表示窗口内的任意位置，其中x＞0，y＜N；为常数。由上式可知，当x=N/2且y=N/2时有最大值，因此高斯核函数只关注窗口最中间位置的情况，因此在通过基于高斯核函数的SSIM算法进行图像对比时，窗口的大小对结果影响较小，产品图片的大缺陷和小缺陷就能在相同的评价标准下进行比对打分，从而能同时保证两者的检出。可以理解的是，差异信息可以是重构图片的像素点和产品图片中对应位置像素点之间的SSIM得分信息；差异得分图可以是个像素点的SSIM得分构成的得分图；差异得分图中的SSIM得分的数量与产品图片像素点的数量相同。在具体实现中，根据高斯核函数确定窗口的初始化值，通过SSIM算法使用滑动窗口的方式将产品图片和重构图片对应的像素点进行对比，获得各像素点的SSIM得分，在全部像素点对比完成时，所有像素点的SSIM得分构成差异得分图，其中各SSIM得分在差异得分图中的位置与像素点在图片中的位置对应。应该理解的是，由于目前的SSIM算法不适用于小缺陷对比的情况，本实施例使用了基于高斯核函数的SSIM算法。传统的SSIM算法都是用均值来作为核函数，而均值核函数会对缺陷的大小特别敏感，导致无法同时兼容大缺陷和小缺陷的检出。而高斯核函数由于其自身的特性，对于缺陷大小不敏感，无论面对大缺陷还是小缺陷都能以同样的标准进行打分，适用于工业场景细小缺陷的检测。步骤S3：根据所述差异得分图判断所述待检测产品是否存在表面缺陷。可以理解的是，可对差异得分图中的各SSIM得分进行分析，根据分析结果判断待检测产品是否存在表面缺陷；还可根据分析结果确定差异得分图中的异常位置，根据异常位置可确定对应的产品图片中存在表面缺陷的区域。在具体实现中，产品表面缺陷检测设备将待检测产品的产品图片输入预设自编码器模型，通过预设自编码器模型解码器提取产品图片的特征，通过预设自编码器的解码器根据该特征对产品图片进行重构，获得产品图片的重构图片，根据高斯核函数确定进行图片对比时窗口的初始化值，SSIM算法使用滑动窗口的方式将产品图片的像素点和重构图片对应的像素点进行对比，获得像素点的SSIM得分，在图片中的所有像素点对比完成时，获得与像素点数量相等的SSIM得分，根据像素点在图片中的位置确定SSIM得分的位置，根据SSIM得分和对应的位置生成差异得分图，对差异得分图进行分析，根据分析结果判断待检测产品是否存在表面缺陷，还可根据分析结果确定差异得分图中的异常位置，根据异常位置可确定对应的产品图片中存在表面缺陷的区域。进一步地，由于生产产品的过程中，良品的数量多，缺陷产品存在的数量较少，在现有技术中进行模型训练时，一般只采用良品的图片进行模型训练，导致在使用训练后的模型进行缺陷检测时缺陷检测的准确度低，在所述步骤S1之前，所述方法还包括：步骤S01：获取大量的产品良品图片，并对所述产品良品图片进行预处理，获得若干预处理图片。可以理解的是，产品良品图片可以是不存在表面缺陷的产品图片；预处理可以是对产品良品图片进行平移、旋转、光照增强和调整大小等处理；预处理图片可以是进行上述预处理后的图片；另外本实施例中的预处理还可以仅包括调整大小处理。应该理解的是，产品良品图片经过上述预处理后，在训练自编码器模型时，可使自编码器模型学习到更多的数据特征，从而使训练后的模型泛化性更强；由于获取到的产品良品图片可能与自编码器模型所规定的输入图片的尺寸不同，此时将产品良品图片的尺寸调整为自编码器模型规定的尺寸。步骤S02：通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集。可以理解的是，缺陷模拟算法可以是按照一定规则在预处理图片上构造缺陷的算法；模拟缺陷图片可以是图片上有模拟缺陷的图片；模拟缺陷模型训练集可以是对自编码器模型进行训练的模拟缺陷图片的集合。应该理解的是，在预处理图片上构造缺陷是针对自编码器容易忽略掉细小缺陷的问题提出的，构造缺陷时为了模拟细小缺陷；本实施例在训练阶段在预处理图片上构造缺陷，预处理图片上的构造缺陷可称为模拟缺陷区域，并且最终期望自编码器模型将这块模拟出来的缺陷区域给重构成正常区域，进一步地，为了保证在训练自编码器模型时关注到模拟缺陷区域，本实施例在构造缺陷时，提升了模拟缺陷区域的像素缺失权重，使得自编码器模型着重关注模拟缺陷区域的重构效果。由于在训练阶段就有意识的引导自编码器模型关注模拟缺陷区域即细小缺陷的修复效果，在推理阶段遇到细小缺陷时自编码器也能很好的将细小缺陷去除。步骤S03：将所述模拟缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练。可以理解的是，本实施例中的自编码器模型可以是卷积自编码器，卷积自编码器的训练过程与神经网络模型的训练过程类似。在具体实现中，将模拟缺陷模型训练集中的若干模拟缺陷图片输入卷积自编码器，对卷积自编码器进行训练。步骤S04：在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。可以理解的是，预设迭代次数可以是预先设定的自编码器模型的训练次数；在自编码器模型的训练次数达到预设迭代次数时，模型训练完成获得预设自编码器模型。在具体实现中，获取大量产品良品图片，对产品良品图片进行图片大小调整、平移、旋转和光照增强等预处理获得若干预处理图片，通过缺陷模拟算法在若干预处理图片上随机构造缺陷获得若干模拟缺陷图片，若干模拟缺陷图片构成模拟缺陷模型训练集，通过模拟缺陷模型训练集中的图片对卷积自编码器进行训练，在模型的训练次数达到预先设定的训练次数时，模型训练完成获得预设自编码器模型。进一步地，为了引导自编码器模型能够学习到难检缺陷的特征，以提高缺陷检测的准确度，在所述步骤S02之后，所述方法还包括：获取若干难检缺陷图片，对所述若干难检图片进行像素级标注，获得若干难检缺陷标注图片；将所述若干难检缺陷标注图片添加至所述模拟缺陷模型训练集，获得混合缺陷模型训练集；将所述混合缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练；在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。可以理解的是，难检缺陷图片可以是产品存在的难以检测的细微缺陷对应的图片；像素级标注可以是根据难检缺陷图片中缺陷区域的像素点对缺陷进行标注，例如可以是通过软件或人工将存在缺陷的像素区域用封闭区域圈出；难检缺陷标注图片可以是进行像素级标注后的难检缺陷图片；混合缺陷模型训练集包括模拟缺陷图片和难检缺陷标注图片。应该理解的是，对于及其细微的难检缺陷，本实施例获取难检缺陷图片，对难检缺陷图片进行像素级标注，由于只有完全难以检出的缺陷才会使用这种方法进行标注，因此标注的量并不大，通过将标注过的难检缺陷图片加入到训练集对自编码器模型进行训练，能引导自编码器很好地学习到难检缺陷的特征，这样在后续遇到相同缺陷时便不会出现漏检情况，从而提高产品表面缺陷检测的准确度。可以理解的是，将混合缺陷模型训练集中的模拟缺陷图片和难检缺陷标注图片对自编码器模型进行训练，在训练次数达到迭代次数时，获得预设自编码器模型。应该理解的是，本实施例虽然同时使用模拟缺陷图片和难检缺陷标注图片对自编码器模型进行训练，但是两者训练的目标不同：针对正常区域，两者的训练目标是相同的，只要保证输入区域和重构区域完全一致就可以；而针对模拟缺陷图片中的模拟缺陷区域，其目标主要是将模拟缺陷区域恢复成正常区域；针对难检缺陷标注图片中的难检缺陷区域，其目标主要是将难检缺陷区域给重构成像素值为预设值的区域，这是因为难检缺陷标注图片中的难检缺陷是真实的缺陷，将难检缺陷标注图片加入训练集是为了帮助自编码器模型更好的学习到难检缺陷的特征，因此只有指定将所有难检缺陷区域的像素给映射到某个指定的值，才能保证训练后的自编码器模型后续在遇到相似的缺陷时都能直接将此类缺陷的像素值映射到预设值，从而与产品图片产生极其明显的差别，以被比对算法比对出来，其中预设值可以设定为0。本实施例将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；根据所述差异得分图判断所述待检测产品是否存在表面缺陷。由于本实施例是通过将待检测产品的产品图片输入预设自编码器模型获得产品图片的重构图片，通过基于高斯核函数的SSIM算法确定的产品图片和重构图片之间的差异信息确定差异得分图，根据差异得分图判断待检测产品是否存在表面缺陷，能够检测出产品表面存在的细小缺陷，提高了产品表面缺陷检测的准确度。参考图3，图3为本发明产品表面缺陷检测方法第二实施例的流程示意图。基于上述第一实施例，在本实施例中，所述步骤S02包括：步骤S021：从若干预处理图片中依次选取目标预处理图片，并在选取目标预处理图片时生成对应的图形参数。可以理解的是，图形参数可以是在目标预处理图片上构造缺陷区域的参数；例如若在目标预处理图片上构造的缺陷区域为椭圆形，则图像参数为椭圆形参数，若在目标预处理图片上构造的缺陷区域为矩形或三角形，则图片参数对应为矩形参数和三角形参数，还可以是其他参数，本实施例对此不作限制。应该理解的是，为各目标预处理图片生成的图形参数是随机生成的，可保证模拟缺陷区域的多样性。步骤S022：根据所述图形参数在对应的目标预处理图片上构造图形区域，按照预设规则在所述构造图形区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域。在具体实现中，根据图像参数在各目标预处理图片上构造图形区域，按照预设规则在该图形区域上选取若干缺陷点，根据若干缺陷点可生成多边形区域。步骤S023：为所述多边形区域分配颜色，获得各预处理图片对应电的模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集。应该理解的是，为多边形区域分配颜色可以是为多边形区域随机分配颜色，其中颜色可以通过RGB值表示。进一步地，为了提高缺陷检测的准确度，所述步骤S022包括：在所述图形参数为椭圆参数时，根据所述椭圆参数在对应的目标预处理图片上构造椭圆区域，将所述椭圆区域通过极坐标展开；在通过极坐标展开的椭圆区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域。在具体实现中，在图形参数为椭圆参数时，可根据椭圆参数确定椭圆的长轴长度a和短轴长度b，其中长轴长度a大于短轴长度b，且大于预设阈值，保证椭圆为细长椭圆，通过极坐标将椭圆展开，在椭圆表上选取16个缺陷点，将16个缺陷点连接起来生成多边形区域，在0-255之间随机选取一个值作为该多边形区域的颜色，获得模拟缺陷图片。本实施例从若干预处理图片中依次选取目标预处理图片，并在选取目标预处理图片时生成对应的图形参数；根据所述图形参数在对应的目标预处理图片上构造图形区域，按照预设规则在所述构造图形区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域；为所述多边形区域分配颜色，获得各预处理图片对应电的模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集。由于本实施例是通过随机生成图形参数在预处理图片上构造图形区域，从构造图形区域的边上选取若干缺陷点生成多边形区域，为该多边形区域随机分配颜色获得模拟缺陷图片，能够在产品良品图片上模拟出缺陷区域对自编码器模型进行训练获得预设自编码器模型，能够提高预设自编码器模型缺陷检测的准确度。参考图4，图4为本发明产品表面缺陷检测方法第三实施例的流程示意图。基于上述各实施例，在本实施例中，所述步骤S2包括：步骤S21：根据高斯核函数确定在对比所述产品图片的像素点与所述重构图片对应的像素点差异时的窗口初始化值。可以理解的是，在使用SSIM算法时，一般会使用滑动窗口的方式来将产品图片与重构图片进行对比，本实施例使用高斯核函数作为滑动窗口的窗口初始化值。步骤S22：根据所述窗口初始化值和窗口大小确定单次对比区域，并通过SSIM算法根据所述单次对比区域将所述产品图片与所述重构图片进行差异对比，获得对应像素点的差异得分。在具体实现中，根据窗口初始化值和窗口大小确定单次对比区域，通过SSIM算法依次将产品图片和重构图片进行对比获得各像素点的差异得分即SSIM得分。步骤S23：在所述产品图片与所述重构图片对应的像素点差异对比完成时，获得所述重构图片的差异得分图。可以理解的是，差异得分图的大小与产品图片的大小一致，即差异得分图的像素点个数与产品图片的像素点个数一致；差异得分图中每一个像素点的值代表以该像素为中心的滑动窗口的SSIM得分，SSIM得分越大代表产品图片和重构图片之间在该区域的差异越大。进一步地，为了提高缺陷检测的准确度，所述步骤S3包括：将所述差异得分图中的差异得分与预设阈值进行对比，并判断所述差异得分是否大于预设阈值；在所述差异得分大于预设阈值时，判定与所述差异得分对应的待检测产品区域存在表面缺陷；在所述差异得分小于或等于预设阈值时，判定与所述差异得分对应的待检测产品区域不存在表面缺陷。在具体实现中，将差异得分图中的SSIM得分与预设阈值进行对比，在SSIM得分大于预设阈值时，可判定该区域存为异常区域，即待检测产品的对应区域存在表面缺陷；在SSIM得分小于或等于预设阈值时，可判定该区域为正常区域，即待检测产品的对应区域不存在表面缺陷。可以理解的是，若预设自编码器模型的检测结果不理想，仍存在漏检情况，则可将对应的缺陷图片进行标注，将标注后的缺陷图片加入训练集继续对模型进行训练，再次迭代更新模型以使预设自编码器模型完全无漏检。本实施例根据高斯核函数确定在对比所述产品图片的像素点与所述重构图片对应的像素点差异时的窗口初始化值；根据所述窗口初始化值和窗口大小确定单次对比区域，并通过SSIM算法根据所述单次对比区域将所述产品图片与所述重构图片进行差异对比，获得对应像素点的差异得分；在所述产品图片与所述重构图片对应的像素点差异对比完成时，获得所述重构图片的差异得分图。在进行缺陷检测时，能够使大缺陷和小缺陷在相同的评价标准下进行比对打分，保证大缺陷和小缺陷都能被检测出来，提高了缺陷检测的准确度。此外，本发明实施例还提出一种存储介质，所述存储介质上存储有产品表面缺陷检测程序，所述产品表面缺陷检测程序被处理器执行时实现如上文所述的产品表面缺陷检测方法的步骤。参照图5，图5为本发明产品表面缺陷检测装置第一实施例的结构框图。如图5所示，本发明实施例提出的产品表面缺陷检测装置包括：输入模块10、确定模块20和判断模块30。所述输入模块10，用于将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；所述确定模块20，用于通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；所述判断模块30，用于根据所述差异得分图判断所述待检测产品是否存在表面缺陷。本实施例将待检测产品的产品图片输入预设自编码器模型，以使所述预设自编码器模型输出所述产品图片的重构图片；通过基于高斯核函数的SSIM算法确定所述产品图片的像素点与所述重构图片的对应像素点之间的差异信息，并根据所述差异信息确定所述重构图片的差异得分图；根据所述差异得分图判断所述待检测产品是否存在表面缺陷。由于本实施例是通过将待检测产品的产品图片输入预设自编码器模型获得产品图片的重构图片，通过基于高斯核函数的SSIM算法确定的产品图片和重构图片之间的差异信息确定差异得分图，根据差异得分图判断待检测产品是否存在表面缺陷，能够检测出产品表面存在的细小缺陷，提高了产品表面缺陷检测的准确度。基于本发明上述产品表面缺陷检测装置第一实施例，提出本发明产品表面缺陷检测装置的第二实施例。在本实施例中，所述输入模块10，还用于获取大量的产品良品图片，并对所述产品良品图片进行预处理，获得若干预处理图片；通过缺陷模拟算法在所述若干预处理图片上构造缺陷，获得若干模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集；将所述模拟缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练；在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。所述输入模块10，还用于从若干预处理图片中依次选取目标预处理图片，并在选取目标预处理图片时生成对应的图形参数；根据所述图形参数在对应的目标预处理图片上构造图形区域，按照预设规则在所述构造图形区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域；为所述多边形区域分配颜色，获得各预处理图片对应电的模拟缺陷图片，并根据所述若干模拟缺陷图片构造模拟缺陷模型训练集。所述输入模块10，还用于在所述图形参数为椭圆参数时，根据所述椭圆参数在对应的目标预处理图片上构造椭圆区域，将所述椭圆区域通过极坐标展开；在通过极坐标展开的椭圆区域上选取若干缺陷点，并根据所述若干缺陷点生成多边形区域。所述输入模块10，还用于获取若干难检缺陷图片，对所述若干难检图片进行像素级标注，获得若干难检缺陷标注图片；将所述若干难检缺陷标注图片添加至所述模拟缺陷模型训练集，获得混合缺陷模型训练集；将所述混合缺陷模型训练集中的图片输入自编码器模型，以对所述自编码器模型进行训练；在所述自编码器模型的训练次数达到预设迭代次数时，获得预设自编码器模型。所述确定模块20，还用于根据高斯核函数确定在对比所述产品图片的像素点与所述重构图片对应的像素点差异时的窗口初始化值；根据所述窗口初始化值和窗口大小确定单次对比区域，并通过SSIM算法根据所述单次对比区域将所述产品图片与所述重构图片进行差异对比，获得对应像素点的差异得分；在所述产品图片与所述重构图片对应的像素点差异对比完成时，获得所述重构图片的差异得分图。所述判断模块30，还用于将所述差异得分图中的差异得分与预设阈值进行对比，并判断所述差异得分是否大于预设阈值；在所述差异得分大于预设阈值时，判定与所述差异得分对应的待检测产品区域存在表面缺陷；在所述差异得分小于或等于预设阈值时，判定与所述差异得分对应的待检测产品区域不存在表面缺陷。本发明产品表面缺陷检测装置的其他实施例或具体实现方式可参照上述各方法实施例，此处不再赘述。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者系统不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者系统所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者系统中还存在另外的相同要素。上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台终端设备执行本发明各个实施例所述的方法。以上仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
