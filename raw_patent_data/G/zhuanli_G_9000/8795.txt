标题title
一种水体光学分类及质量控制方法及计算机可读存储介质
摘要abst
本发明提供一种水体光学分类及质量控制方法及计算机可读存储介质，包括：获取预设探测波段和参考水域，并获取参考光谱，通过聚类分析得到不少于两个分类光谱数据；获取目标水域在预设探测波段内的探测光谱，探测光谱为下行漫衰减系数光谱；基于探测光谱与分类光谱数据的相似性，为目标水域匹配对应的水体类型。据本发明实施例所提供的水体光学分类及质量控制方法，聚类分析获得不同水体类型的分类光谱数据，并对目标水域的下行漫衰减系数光谱通过相似性进行匹配，从而确定对应的水体类型。由于下行漫衰减系数光谱更稳定，并结合聚类分析过程，使得水体类型的分类和匹配更加准确稳定，一定程度解决了由遥感反射率导出的光学水体类型多样且多变的问题。
权利要求书clms
1.一种水体光学分类及质量控制方法，其特征在于，包括：获取预设探测波段；选取参考水域，所述参考水域包括至少两种不同的水体类型，获取所述参考水域在所述预设探测波段内的参考光谱，所述参考光谱为下行漫衰减系数光谱；基于所述参考光谱，通过聚类分析得到与所述水体类型对应的分类光谱数值，所述分类光谱数据至少包括所述水体类型在所述预设探测波段内的光谱数值的平均值；获取目标水域在所述预设探测波段内的探测光谱，所述探测光谱为下行漫衰减系数光谱；基于所述探测光谱与所述分类光谱数据的相似性，为所述目标水域匹配对应的所述水体类型。2.如权利要求1所述的水体光学分类及质量控制方法，其特征在于，所述基于所述参考光谱，通过聚类分析得到不少于两个分类光谱数据包括：基于所述参考光谱，获得归一化参考光谱；基于所述归一化参考光谱，通过聚类分析得到所述分类光谱数据。3.如权利要求2所述的水体光学分类及质量控制方法，其特征在于，所述基于所述归一化参考光谱，通过聚类分析得到所述分类光谱数据包括：基于所述归一化参考光谱，通过最短距离法分析得到所述归一化参考光谱的最佳聚类数；基于所述最佳聚类数对所述归一化参考光谱进行聚类分析得到不少于两个水体类型分类光谱数据。4.如权利要求2所述的水体光学分类及质量控制方法，其特征在于，所述基于所述参考光谱，获得所述参考光谱的归一化参考光谱包括：提取光谱波长为412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm的下行漫衰减系数为参考数据，基于所述参考数据对所述参考光谱进行归一化得到所述归一化参考光谱。5.如权利要求2所述的水体光学分类及质量控制方法，其特征在于，所述基于所述探测光谱与所述分类光谱数据的相似性，为所述目标水域匹配对应的所述水体类型包括：基于所述探测光谱，获得归一化探测光谱；基于所述归一化探测光谱与所述水体类型的分类光谱数据的相似性，判断所述目标水域所对应的所述水体类型。6.如权利要求5所述的水体光学分类及质量控制方法，其特征在于，所述基于所述归一化探测光谱与所述分类光谱数据的相似性包括：基于所述归一化探测光谱获得所述归一化探测光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内的归一化待评估光谱；基于所述参考光谱获得所述归一化参考光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内的归一化对照光谱；基于所述归一化待评估光谱和所述归一化对照光谱，通过光谱角制图分析分别得到所述归一化待评估光谱与至少两个所述水体类型对应的所述归一化对照光谱之间的光谱夹角；比较所述光谱夹角的角度值，将所述角度值最低的所述光谱夹角对应的所述水体类型匹配给所述目标水域。7.如权利要求5所述的水体光学分类及质量控制方法，其特征在于，在基于所述归一化探测光谱与所述水体类型的分类光谱数据的相似性，判断所述目标水域所对应的所述水体类型之后，还包括：所述分类光谱数据还包括所述水体类型在所述预设探测波段内的光谱数值上下限；基于所述归一化探测光谱与所述光谱数值上下限，获得所述归一化探测光谱的数据质量。8.如权利要求7所述的水体光学分类及质量控制方法，其特征在于，所述基于所述归一化探测光谱与所述光谱数值上下限，获得所述归一化探测光谱的数据质量包括：判断所述归一化探测光谱在不同波段内是否超过所述光谱数值上下限；基于超过所述光谱数值上下限的波段数获得所述归一化探测光谱的数据质量。9.如权利要求8所述的水体光学分类及质量控制方法，其特征在于，所述基于超过所述光谱数值上下限的波段数获得所述归一化探测光谱的数据质量包括：获取所述探测光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内不超过所述光谱数值上下限的次数之和；基于所述次数之和，获得所述数据质量。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1至9中任一项所述的水体光学分类及质量控制方法。
说明书desc
技术领域本发明涉及自然环境监测技术领域，具体而言，涉及一种水体光学分类及质量控制方法及计算机可读存储介质。背景技术水体光学分类一直是水色遥感和光学海洋学的研究热点。光学水体类型可以表征受浮游植物、悬浮颗粒物和溶解有机物控制的水域的光学状态，还可以为解释生态多样性和模式提供有用的信息。水体类型的精确分类对于理解海洋、沿海和内陆湖水的生物物理过程非常重要。由于遥感反射率可以很容易地通过远程监测而被获得，所以被广泛应用于水体类型光学分类，甚至水色遥感领域。虽然已有研究在特定区域获得了光学水体类型的独特知识，但数据质量控制还是基于与现场测量或参考文献的比较。所以，需要一个系统的质量控制方案，以重新评估遥感反射率。已有的基于现场和卫星遥感反射率的质量保证系统可以根据幅度和光谱形状评估给定的遥感反射率光谱。然而，现有技术中存在一个问题，即遥感反射率受到水中成分和环境因素的极大影响，使得由遥感反射率导出的光学水体类型多样且多变。因此，亟待提供一种水体光学分类及质量控制方法，以至少部分解决上述问题。发明内容本发明的目的是提供一种水体光学分类及质量控制方法及计算机可读存储介质，其能够至少部分地克服了现有技术中的不足。根据本发明的一个方面，提供一种水体光学分类及质量控制方法，包括：获取预设探测波段；选取参考水域，所述参考水域包括至少两种不同的水体类型，获取所述参考水域在所述预设探测波段内的参考光谱，所述参考光谱为下行漫衰减系数光谱；基于所述参考光谱，通过聚类分析得到与所述水体类型对应的分类光谱数值，所述分类光谱数据至少包括所述水体类型在所述预设探测波段内的光谱数值的平均值；获取目标水域在所述预设探测波段内的探测光谱，所述探测光谱为下行漫衰减系数光谱；基于所述探测光谱与所述分类光谱数据的相似性，为所述目标水域匹配对应的所述水体类型。优选地，所述基于所述参考光谱，通过聚类分析得到不少于两个分类光谱数据包括：基于所述参考光谱，获得归一化参考光谱；基于所述归一化参考光谱，通过聚类分析得到所述分类光谱数据。优选地，所述基于所述归一化参考光谱，通过聚类分析得到所述分类光谱数据包括：基于所述归一化参考光谱，通过最短距离法分析得到所述归一化参考光谱的最佳聚类数；基于所述最佳聚类数对所述归一化参考光谱进行聚类分析得到不少于两个水体类型分类光谱数据。优选地，所述基于所述参考光谱，获得所述参考光谱的归一化参考光谱包括：提取光谱波长为412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm的下行漫衰减系数为参考数据，基于所述参考数据对所述参考光谱进行归一化得到所述归一化参考光谱。优选地，所述基于所述探测光谱与所述分类光谱数据的相似性，为所述目标水域匹配对应的所述水体类型包括：基于所述探测光谱，获得归一化探测光谱；基于所述归一化探测光谱与所述水体类型的分类光谱数据的相似性，判断所述目标水域所对应的所述水体类型。优选地，所述基于所述归一化探测光谱与所述分类光谱数据的相似性包括：基于所述归一化探测光谱获得所述归一化探测光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内的归一化待评估光谱；基于所述参考光谱获得所述归一化参考光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内的归一化对照光谱；基于所述归一化待评估光谱和所述归一化对照光谱，通过光谱角制图分析分别得到所述归一化待评估光谱与至少两个所述水体类型对应的所述归一化对照光谱之间的光谱夹角；比较所述光谱夹角的角度值，将所述角度值最低的所述光谱夹角对应的所述水体类型匹配给所述目标水域。优选地，在基于所述归一化探测光谱与所述水体类型的分类光谱数据的相似性，判断所述目标水域所对应的所述水体类型之后，还包括：所述分类光谱数据还包括所述水体类型在所述预设探测波段内的光谱数值上下限；基于所述归一化探测光谱与所述光谱数值上下限，获得所述归一化探测光谱的数据质量。优选地，所述基于所述归一化探测光谱与所述光谱数值上下限，获得所述归一化探测光谱的数据质量包括：判断所述归一化探测光谱在不同波段内是否超过所述光谱数值上下限；基于超过所述光谱数值上下限的波段数获得所述归一化探测光谱的数据质量。优选地，所述基于超过所述光谱数值上下限的波段数获得所述归一化探测光谱的数据质量包括：获取所述探测光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内不超过所述光谱数值上下限的次数之和；基于所述次数之和，获得所述数据质量。根据本发明的另一方面，还提供一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现如上所述的水体光学分类及质量控制方法。根据本发明实施例所提供的水体光学分类及质量控制方法，获取参考水域在预设探测波段内的类型为下行漫衰减系数光谱的参考光谱，并通过聚类分析获得不同水体类型的分类光谱数据，并对目标水域的下行漫衰减系数光谱通过相似性进行匹配，从而确定目标水域对应的水体类型。由于下行漫衰减系数光谱更稳定且不受影响，并结合聚类分析过程，使得水体类型的分类和匹配更加准确稳定，一定程度解决了由遥感反射率导出的光学水体类型多样且多变的问题。附图说明通过阅读参照以下附图所作的对非限制性实施例的详细描述，本发明的其它特征、目的和优点将会变得更明显：图1是本申请所提供的水体光学分类及质量控制方法的示意图；图2是获得分类光谱数据的实施例的示意图；图3是判断目标水域的水体类型的实施例示意图。具体实施方式下面结合附图和实施例对本发明作进一步的详细说明。可以理解的是，此处所描述的具体实施例仅用于解释相关发明，而非对该发明的限定。为了便于描述，附图中仅示出了与发明相关的部分。需要说明的是，在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。本发明实施例提供一种水体光学分类及质量控制方法，水体类型光学分类一直是水色遥感和光学海洋学的研究热点。光学水体类型可以表征受浮游植物、悬浮颗粒物和溶解有机物控制的水域的光学状态，还可以为解释生态多样性和模式提供有用的信息。水体类型的精确分类对于理解海洋、沿海和内陆湖水的生物物理过程非常重要。光学水分类方案采用的参数通常包括浮游植物、塞氏盘深度、固有光学特性、漫衰减系数和遥感反射率。其中，由于遥感反射率可以很容易地通过远程监测而被获得，所以被广泛应用于水体类型光学分类，甚至水色遥感领域。虽然已有研究在特定区域获得了光学水体类型的独特知识，但数据质量控制还是基于与现场测量或参考文献的比较。所以，需要一个系统的质量控制方案，以重新评估遥感反射率。已有的基于现场和卫星遥感反射率的质量保证系统可以根据幅度和光谱形状评估给定的遥感反射率光谱。然而，存在一个问题，即遥感反射率受到水中成分和环境因素的极大影响，这使得由Rrs导出的光学水体类型多样且多变。下行漫衰减系数是一个重要的水光学性质，是通过水文光学和生物学的结合来理解自然水体类型生态过程和生物地球化学循环的基本参数。Kd是一种准固有光学性质，包含总吸收系数)和后向散射系数)的信息。因此，与Rrs相比，Kd更稳定且不受影响，这使其成为光学水分类的可靠变量。本申请实施例中的水体类型，可以是用于描述污染等级，也可以是用于描述水体类型浮游生物富集程度，还可以是用于描述洋流盐度等多种指标。本申请并不对水体类型所描述的具体指标做过多限制，只要能够通过下行漫衰减系数进行描述即可。本申请实施例中的下行漫衰减系数，可以是利用中分辨率成像光谱仪和陆地成像仪等传感器综合联用获得的，也可以是单纯使用陆地成像仪的数据进行估算得到，本申请实施例同样不限制下行漫衰减系数的获得方式，只要能够通过一定手段获得参考水域和目标水域的下行漫衰减系数即可。本申请实施例提供一种水体光学分类及质量控制方法，如图1所示，包括如下处理：S101：获取预设探测波段；S102：选取参考水域，参考水域包括至少两种不同的水体类型，获取参考水域在预设探测波段内的参考光谱，参考光谱为下行漫衰减系数光谱；S103：基于参考光谱，通过聚类分析得到与所述水体类型对应的分类光谱数值，分类光谱数据至少包括水体类型在预设探测波段内的光谱数值的平均值；S104：获取目标水域在预设探测波段内的探测光谱，探测光谱为下行漫衰减系数光谱；S105：基于探测光谱与分类光谱数据的相似性，为目标水域匹配对应的水体类型。在处理S101中，预设探测波段的选取例如可以是400nm至700nm，也可以是其他根据具体需要设定的波长范围。这是由于在探测目的不同的情况下，为了提高探测效率或节约探测资源，又或者由于探测仪器本身的固有性质，预设探测波段的数值是需要根据具体情况进行设置的。在确定了预设探测波段后，在预设探测波段内的参考光谱和探测光谱就可以通过一定的技术手段进行对比，例如下文所要描述的相似性分析等。在处理S102中，参考水域的选择可以是一个包含两种或两种以上不同的水体类型的水域，例如一个水体类型情况复杂的湖泊等，也可以是根据文献中所描述的全球水域，例如在文献《A compilation of global bio-optical in situ data for ocean-coloursatellite applications》中，就记录了全球水域的下行漫衰减系数光谱，因此，本申请实施例中的参考光谱可以是对参考水域采用临时测量得到的，也可以是从文献记录中读取的，只要能够包含水域内两种或两种以上的不同的水体类型的下行漫衰减系数光谱，足以作为参考光谱即可。在处理S103中，由于参考光谱中对不同水体类型往往没有具体分类或分类标准不符合实际需要，其数据是多种水体类型的下行漫衰减系数光谱混杂在一起所构成的，因此在处理S103中，使用聚类分析得到不少于两个分类光谱数据，本申请实施例中的分类光谱数据与水体类型存在对应关系，或者可以说，分类光谱数据即可描述所对应的水体类型在下行漫衰减系数光谱中的数据特征，最基本的，分类光谱数据应当包括所对应的水体类型在上述的预设探测波段中的下行漫衰减系数光谱的平均值，或者说下行漫衰减系数光谱的质心，这样便于后续在获取目标水域的下行漫衰减系数光谱时作相似性分析。在处理S104中，目标水域可以是仅包含一种水体类型的水域，例如为一个小面积水域确定整体的水体类型，也可以是一个较大的包含较多水体类型的水域，例如一个随季节变换水体类型分布不断变化的海湾等。这里目标水域可以仅包含一种水体类型和上述的参考水域必须包含两种或两种以上的水体类型的原理不同，上述的参考水域中，为了实现区分性，必须包含至少两种不同的水体类型，才能根据不同的水体类型之间的区别对目标水域进行区分；而目标水域则没有这个限制，根据具体需要进行选择即可。获取目标水域在上述的预设探测波段内的探测光谱的方式与获取参考水域的参考光谱的方式类似，此处不再赘述。在处理S105中，在获取了探测光谱和分类光谱数据后，即可根据两者之间的相似性，判断探测光谱与何种分类光谱数据类似，相似性的分析过程具体可以是计算探测光谱与分类光谱数据的质心之间的光谱角大小，例如通过下述公式进行计算：其中，cosα为光谱角的余弦值，α为探测光谱和分类光谱数据的质心之间的角度。这样，将通过获得角度值α，则说明探测光谱与该分类光谱数据之间的相似程度较高。当然探测光谱与分类光谱数据之间的相似性也可以使用frechet distance分析方式等本领域技术人员所熟知的曲线相似度分析方式等，此处不一一赘述。上述对本说明书特定实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。根据本发明实施例所提供的水体光学分类及质量控制方法，获取参考水域在预设探测波段内的类型为下行漫衰减系数光谱的参考光谱，并通过聚类分析获得不同水体类型的分类光谱数据，并对目标水域的下行漫衰减系数光谱通过相似性进行匹配，从而确定目标水域对应的水体类型。由于下行漫衰减系数光谱更稳定且不受影响，并结合聚类分析过程，使得水体类型的分类和匹配更加准确稳定，一定程度解决了由遥感反射率导出的光学水体类型多样且多变的问题。作为一种优选的实现方式，在处理S103中的基于参考光谱，通过聚类分析得到不少于两个分类光谱数据的一种具体实现过程可以是如图2所示：S1031：基于参考光谱，获得归一化参考光谱；S1032：基于归一化参考光谱，通过聚类分析得到分类光谱数据。在处理S1031中，获得归一化参考光谱的具体实现方式可以是通过以下方程式进行归一化。其中，nKd为归一化后的Kd光谱，取值为0-1；N为波段总数；λi分别对应不同的波长；Kd为Kd光谱。优选地，基于参考光谱，获得参考光谱的归一化参考光谱包括：提取光谱波长为412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm的下行漫衰减系数为参考数据，基于参考数据对参考光谱进行归一化得到归一化参考光谱。申请人通过反复实践发现，选取上述8个波段，可以有效区分大部分的水体类型。在处理S1032中，获得归一化参考光谱后，由于消除了量纲，因此便于后续进行聚类分析得到分类光谱数据。在一种优选的实现方式中，基于归一化参考光谱，通过聚类分析得到分类光谱数据包括的一种具体实现过程可以是：基于归一化参考光谱，通过最短距离法分析得到归一化参考光谱的最佳聚类数；基于最佳聚类数对归一化参考光谱进行聚类分析得到不少于两个水体类型分类光谱数据。其中，上述最短距离法可以使用下述公式进行处理：其中n是样本大小，k是聚类数。Wk是集群内分散度量的集合，定义为：其中nr是集群r中的数据数量。Dr是群集r中所有数据的成对距离之和。期望值由参考分布的蒙特卡罗抽样确定,log由样本数据计算得到。在获得了k值，即聚类数后，即可对归一化参考光谱进行聚类并分析得到不少于两种水体类型的分类光谱数据，例如污染超标水体类型的分类光谱数据和达标水体类型的分类光谱数据。在一种优选的实现方式中，处理S105：基于探测光谱与分类光谱数据的相似性，为目标水域匹配对应的水体类型的一种实现方式可以包括如图3所示：S1051：基于探测光谱，获得归一化探测光谱；S1052：基于归一化探测光谱与水体类型的分类光谱数据的相似性，判断目标水域所对应的水体类型。经过处理S1051和处理S1052后，将探测光谱归一化，并与上述经过归一化得到的水体类型的分类光谱进行对比分析，可以有效降低计算难度，具体的归一化公式可以使用上述的公式。这里基于归一化探测光谱与分类光谱数据的相似性可以是如下的过程：基于归一化探测光谱获得归一化探测光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内的归一化探测光谱；基于参考光谱获得归一化参考光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内的归一化对照光谱；获取预设角度阈值，基于归一化待评估光谱和归一化对照光谱，通过光谱角制图分析得到归一化待评估光谱与水体类型的归一化对照光谱之间的光谱夹角。这里获得光谱夹角的具体计算方法可以是通过一下公式进行计算：其中，cosα为光谱角制图，α为归一化探测光谱的归一化待评估光谱和归一化参考光谱的归一化对照光谱之间的光谱夹角，N为波段总数，如上所取的8个波段数。在获得了光谱夹角α的角度值后，即可根据目标水域的归一化待评估光谱与不同的水体分类的归一化对照光谱，如与污染水体的归一化对照光谱和未污染水体的归一化对照光谱之间的两个光谱夹角α的角度值的大小关系进行判断，若目标水域的归一化待评估光谱与未污染的水体分类的归一化对照光谱之间光谱夹角α的角度值最小，则可以将未污染水体匹配给目标水域。作为一种优选的实现方式，在基于归一化探测光谱与水体类型的分类光谱数据的相似性，判断目标水域所对应的水体类型之后，还包括：分类光谱数据还包括水体类型在预设探测波段内的光谱数值上下限；基于归一化探测光谱与光谱数值上下限，获得归一化探测光谱的数据质量。其中，在确定了归一化探测光谱所对应的水体类型后，即可根据水体类型的分类光谱数据的光谱数值上下限与归一化探测光谱之间的关系，确定其数据质量高低，这里可以是根据归一化探测光谱超过分类光谱数据的光谱数值上限的次数，超过次数越多，则说明数据偏离普遍数据的情况越严重，数据质量越差，也就意味着数据不可信度越高。这里，基于归一化探测光谱与光谱数值上下限，获得归一化探测光谱的数据质量的一种实现方式可以是：判断归一化探测光谱在不同波段内是否超过光谱数值上下限，并基于超过光谱数值上下限的波段数获得归一化探测光谱的数据质量。这里可以是获取探测光谱在412nm、443nm、490nm、510nm、530nm、560nm、665nm、681nm波段内超过光谱数值上下限的次数之和；基于次数之和，获得数据质量。次数越多，则数据质量越差。本申请还提供一种计算机可读介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如上所描述的水体光学分类及质量控制方法。该计算机可读介质包括永久性和非永久性、可移动和非可移动，媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存、静态随机存取存储器、动态随机存取存储器、其他类型的随机存取存储器、只读存储器、电可擦除可编程只读存储器、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体，如调制的数据信号和载波。根据本发明实施例所提供的水体光学分类及质量控制方法，获取参考水域在预设探测波段内的类型为下行漫衰减系数光谱的参考光谱，并通过聚类分析获得不同水体类型的分类光谱数据，并对目标水域的下行漫衰减系数光谱通过相似性进行匹配，从而确定目标水域对应的水体类型。由于下行漫衰减系数光谱更稳定且不受影响，并结合聚类分析过程，使得水体类型的分类和匹配更加准确稳定，一定程度解决了由遥感反射率导出的光学水体类型多样且多变的问题。以上描述仅为本申请的较佳实施例以及对所运用技术原理的说明。本领域技术人员应当理解，本申请中所涉及的发明范围，并不限于上述技术特征的特定组合而成的技术方案，同时也应涵盖在不脱离发明构思的情况下，由上述技术特征或其等同特征进行任意组合而形成的其它技术方案。例如上述特征与本申请中公开的具有类似功能的技术特征进行互相替换而形成的技术方案。
