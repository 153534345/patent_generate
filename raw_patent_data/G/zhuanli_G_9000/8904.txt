标题title
一种无人车路径平滑方法及系统
摘要abst
本发明涉及一种无人车路径平滑方法及系统。该方法包括提取固定步长的离散路点和参考路点；构建第一目标函数；对第一目标函数进行求解，并对优化后的离散路点进行三次自然样条差值拟，之后提取固定步长的离散路点，并转到Frenet坐标系下；将Frenet坐标系下的离散路点以设定步长在Frenet坐标系的l轴上进行上下偏移采样，确定采样点；利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束；构建第二目标函数；对第二目标函数进行求解。本发明能够在全局导航指引线和车辆实时环境信息已知情况下，生成一条考虑车辆实时朝向和位置偏差的无碰撞平滑曲线。
权利要求书clms
1.一种无人车路径平滑方法，其特征在于，包括：获取车辆全局导航指引线的离散路点，并进行三次B样条曲线拟合，得到第一拟合曲线；对第一拟合曲线上的离散路点进行三次自然样条差值拟，得到第二拟合曲线；对第一拟合曲线和第二拟合曲线分别提取固定步长的离散路点，并将所述第二拟合曲线提取的固定步长的离散路点作为参考路点；离散路点均包括：当前点在笛卡尔坐标系下坐标、当前点对应的角度以及曲率；根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数；利用二次规划求解器对第一目标函数进行求解，获得优化后的离散路点，并对优化后的离散路点进行三次自然样条差值拟，之后提取固定步长的离散路点，并转到Frenet坐标系下；将Frenet坐标系下的离散路点以设定步长在Frenet坐标系的l轴上进行上下偏移采样，确定采样点；利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束；以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数；利用二次规划求解器对第二目标函数进行求解，获得二次优化后的离散路点，进而根据二次优化后的离散路点确定路径平滑曲线。2.根据权利要求1所述的一种无人车路径平滑方法，其特征在于，所述根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数，具体包括：利用公式确定代价函数；利用公式确定离散路点和参考路点的连续性约束；利用公式确定车辆朝向约束、车辆实时位置偏差约束及终点约束；其中，为代价函数，、以及均为权重，为提取固定步长的离散路点的个数，和为第i个离散路点在笛卡尔坐标系下坐标，和为第i个参考路点在笛卡尔坐标系下坐标，为第i个离散路点的曲率，为第i+1个离散路点的曲率，为第i个参考路点对应的角度，为第i个离散路点对应的角度，为第i个离散路点与第i个参考路点的角度偏差，和为第i+1个离散路点在笛卡尔坐标系下坐标，为第i+1个离散路点与第i+1个参考路点的角度偏差，为当前车辆实时朝向，为车辆此时位置距离，和为起点在笛卡尔坐标系下坐标，和为终点在笛卡尔坐标系下坐标，和为第n个参考路点在笛卡尔坐标系下坐标，为Frenet坐标系下的第i个离散路点与第i+1离散路点之间的距离。3.根据权利要求2所述的一种无人车路径平滑方法，其特征在于，所述以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数，具体包括：利用公式确定根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数；利用公式确定Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束；利用公式确定避障约束；其中，为根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数，为Frenet坐标系下的第i个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为的二阶导数，为Frenet坐标系下的第i+1个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为Frenet坐标系下的第i个离散路点的累加距离，为Frenet坐标系下的第i+1个离散路点的累加距离，为初始累加距离，为车辆此时累加距离，为凸可行集边界的最大值和最小值。4.根据权利要求1所述的一种无人车路径平滑方法，其特征在于，所述利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束，具体以下公式：；其中，和均为每一层最小的代价值，为安全性代价，为平滑性代价，为偏差性代价，j为采样点的序号，i为Frenet坐标系下的离散路点的序号。5.一种无人车路径平滑系统，其特征在于，包括：第一拟合曲线确定模块，用于获取车辆全局导航指引线的离散路点，并进行三次B样条曲线拟合，得到第一拟合曲线；第二拟合曲线确定模块，用于对第一拟合曲线上的离散路点进行三次自然样条差值拟，得到第二拟合曲线；离散路点提取模块，用于对第一拟合曲线和第二拟合曲线分别提取固定步长的离散路点，并将所述第二拟合曲线提取的固定步长的离散路点作为参考路点；离散路点均包括：当前点在笛卡尔坐标系下坐标、当前点对应的角度以及曲率；第一目标函数构建模块，用于根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数；第一优化模块，用于利用二次规划求解器对第一目标函数进行求解，获得优化后的离散路点，并对优化后的离散路点进行三次自然样条差值拟，之后提取固定步长的离散路点，并转到Frenet坐标系下；采样点确定模块，用于将Frenet坐标系下的离散路点以设定步长在Frenet坐标系的l轴上进行上下偏移采样，确定采样点；动态规划模块，用于利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束；第二目标函数构建模块，用于以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数；第二优化模块，用于利用二次规划求解器对第二目标函数进行求解，获得二次优化后的离散路点，进而根据二次优化后的离散路点确定路径平滑曲线。6.根据权利要求5所述的一种无人车路径平滑系统，其特征在于，所述第一目标函数构建模块具体包括：代价函数第一确定单元，用于利用公式确定代价函数；约束条件第一确定单元，用于利用公式确定离散路点和参考路点的连续性约束；约束条件第二确定单元，用于利用公式确定车辆朝向约束、车辆实时位置偏差约束及终点约束；其中，为代价函数，、以及均为权重，为提取固定步长的离散路点的个数，和为第i个离散路点在笛卡尔坐标系下坐标，和为第i个参考路点在笛卡尔坐标系下坐标，为第i个离散路点的曲率，为第i+1个离散路点的曲率，为第i个参考路点对应的角度，为第i个离散路点对应的角度，为第i个离散路点与第i个参考路点的角度偏差，和为第i+1个离散路点在笛卡尔坐标系下坐标，为第i+1个离散路点与第i+1个参考路点的角度偏差，为当前车辆实时朝向，为车辆此时位置距离，和为起点在笛卡尔坐标系下坐标，和为终点在笛卡尔坐标系下坐标，和为第n个参考路点在笛卡尔坐标系下坐标，为Frenet坐标系下的第i个离散路点与第i+1离散路点之间的距离。7.根据权利要求6所述的一种无人车路径平滑系统，其特征在于，所述第二目标函数构建模块具体包括：代价函数第二确定单元，用于利用公式确定根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数；约束条件第三确定单元，用于利用公式确定Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束；约束条件第四确定单元，用于利用公式确定避障约束；其中，为根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数，为Frenet坐标系下的第i个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为的二阶导数，为Frenet坐标系下的第i+1个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为Frenet坐标系下的第i个离散路点的累加距离，为Frenet坐标系下的第i+1个离散路点的累加距离，为初始累加距离，为车辆此时累加距离，为凸可行集边界的最大值和最小值。8.根据权利要求5所述的一种无人车路径平滑系统，其特征在于，所述动态规划模块具体以下公式：；其中，和均为每一层最小的代价值，为安全性代价，为平滑性代价，为偏差性代价，j为采样点的序号，i为Frenet坐标系下的离散路点的序号。
说明书desc
技术领域本发明涉及路径规划领域，特别是涉及一种无人车路径平滑方法及系统。背景技术无人车辆从起点运动到目标点，需要全局导航指引线的引导，全局导航指引线生成是指依据某个或某些性能指标，例如工作代价最小、行走路线最短、行走时间最短等，依据地图信息找到一条最优或者接近最优的路径，属于路径规划问题，常用方法包括基于图搜索和基于采样的规划算法，这些算法目前已经被广泛采用，但得到的路径一般是折线路径，曲率不连续，不利于车辆进行执行；无人车路径平滑是指依据平滑性指标，在全局折线路径的基础上规划出一条连接起始点和目标点、避开障碍物的平滑路径，常用方法一般通过不同曲线模型拟合获得平滑路径，包括多项式曲线、贝塞尔曲线、样条曲线等。然而上述使用曲线模型拟合的路径平滑方式往往并未考虑车辆实时朝向信息、位置与导航指引线之间的偏差距离信息以及障碍物信息，不能提供带有足够信息的路径平滑曲线。因此，亟需一种考虑车辆实时朝向及位置偏差的避障平滑路径生成方式，为后续车辆最终运动规划轨迹的生成提供更加准确的参考信息。发明内容本发明的目的是提供一种无人车路径平滑方法及系统，能够在全局导航指引线和车辆实时环境信息已知情况下，生成一条考虑车辆实时朝向和位置偏差的无碰撞平滑曲线。为实现上述目的，本发明提供了如下方案：一种无人车路径平滑方法，包括：获取车辆全局导航指引线的离散路点，并进行三次B样条曲线拟合，得到第一拟合曲线；对第一拟合曲线上的离散路点进行三次自然样条差值拟，得到第二拟合曲线；对第一拟合曲线和第二拟合曲线分别提取固定步长的离散路点，并将所述第二拟合曲线提取的固定步长的离散路点作为参考路点；离散路点均包括：当前点在笛卡尔坐标系下坐标、当前点对应的角度以及曲率；根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数；利用二次规划求解器对第一目标函数进行求解，获得优化后的离散路点，并对优化后的离散路点进行三次自然样条差值拟，之后提取固定步长的离散路点，并转到Frenet坐标系下；将Frenet坐标系下的离散路点以设定步长在Frenet坐标系的l轴上进行上下偏移采样，确定采样点；利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束；以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数；利用二次规划求解器对第二目标函数进行求解，获得二次优化后的离散路点，进而根据二次优化后的离散路点确定路径平滑曲线。可选地，所述根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数，具体包括：利用公式确定代价函数；利用公式确定离散路点和参考路点的连续性约束；利用公式确定车辆朝向约束、车辆实时位置偏差约束及终点约束；其中，为代价函数，、以及均为权重，为提取固定步长的离散路点的个数，和为第i个离散路点在笛卡尔坐标系下坐标，和为第i个参考路点在笛卡尔坐标系下坐标，为第i个离散路点的曲率，为第i+1个离散路点的曲率，为第i个参考路点对应的角度，为第i个离散路点对应的角度，为第i个离散路点与第i个参考路点的角度偏差，和为第i+1个离散路点在笛卡尔坐标系下坐标，为第i+1个离散路点与第i+1个参考路点的角度偏差，为当前车辆实时朝向，为车辆此时位置距离，和为起点在笛卡尔坐标系下坐标，和为终点在笛卡尔坐标系下坐标，和为第n个参考路点在笛卡尔坐标系下坐标，为Frenet坐标系下的第i个离散路点与第i+1离散路点之间的距离。可选地，所述以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数，具体包括：利用公式确定根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数；利用公式确定Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束；利用公式确定避障约束；其中，为根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数，为Frenet坐标系下的第i个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为的二阶导数，为Frenet坐标系下的第i+1个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为Frenet坐标系下的第i个离散路点的累加距离，为Frenet坐标系下的第i+1个离散路点的累加距离，为初始累加距离，为车辆此时累加距离，为凸可行集边界的最大值和最小值。可选地，所述利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束，具体以下公式：；其中，和均为每一层最小的代价值，为安全性代价，为平滑性代价，为偏差性代价，j为采样点的序号，i为Frenet坐标系下的离散路点的序号。一种无人车路径平滑系统，包括：第一拟合曲线确定模块，用于获取车辆全局导航指引线的离散路点，并进行三次B样条曲线拟合，得到第一拟合曲线；第二拟合曲线确定模块，用于对第一拟合曲线上的离散路点进行三次自然样条差值拟，得到第二拟合曲线；离散路点提取模块，用于对第一拟合曲线和第二拟合曲线分别提取固定步长的离散路点，并将所述第二拟合曲线提取的固定步长的离散路点作为参考路点；离散路点均包括：当前点在笛卡尔坐标系下坐标、当前点对应的角度以及曲率；第一目标函数构建模块，用于根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数；第一优化模块，用于利用二次规划求解器对第一目标函数进行求解，获得优化后的离散路点，并对优化后的离散路点进行三次自然样条差值拟，之后提取固定步长的离散路点，并转到Frenet坐标系下；采样点确定模块，用于将Frenet坐标系下的离散路点以设定步长在Frenet坐标系的l轴上进行上下偏移采样，确定采样点；动态规划模块，用于利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束；第二目标函数构建模块，用于以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数；第二优化模块，用于利用二次规划求解器对第二目标函数进行求解，获得二次优化后的离散路点，进而根据二次优化后的离散路点确定路径平滑曲线。可选地，所述第一目标函数构建模块具体包括：代价函数第一确定单元，用于利用公式确定代价函数；约束条件第一确定单元，用于利用公式确定离散路点和参考路点的连续性约束；约束条件第二确定单元，用于利用公式确定车辆朝向约束、车辆实时位置偏差约束及终点约束；其中，为代价函数，、以及均为权重，为提取固定步长的离散路点的个数，和为第i个离散路点在笛卡尔坐标系下坐标，和为第i个参考路点在笛卡尔坐标系下坐标，为第i个离散路点的曲率，为第i+1个离散路点的曲率，为第i个参考路点对应的角度，为第i个离散路点对应的角度，为第i个离散路点与第i个参考路点的角度偏差，和为第i+1个离散路点在笛卡尔坐标系下坐标，为第i+1个离散路点与第i+1个参考路点的角度偏差，为当前车辆实时朝向，为车辆此时位置距离，和为起点在笛卡尔坐标系下坐标，和为终点在笛卡尔坐标系下坐标，和为第n个参考路点在笛卡尔坐标系下坐标，为Frenet坐标系下的第i个离散路点与第i+1离散路点之间的距离。可选地，所述第二目标函数构建模块具体包括：代价函数第二确定单元，用于利用公式确定根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数；约束条件第三确定单元，用于利用公式确定Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束；约束条件第四确定单元，用于利用公式确定避障约束；其中，为根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数，为Frenet坐标系下的第i个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为的二阶导数，为Frenet坐标系下的第i+1个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为Frenet坐标系下的第i个离散路点的累加距离，为Frenet坐标系下的第i+1个离散路点的累加距离，为初始累加距离，为车辆此时累加距离，为凸可行集边界的最大值和最小值。可选地，所述动态规划模块具体以下公式：；其中，和均为每一层最小的代价值，为安全性代价，为平滑性代价，为偏差性代价，j为采样点的序号，i为Frenet坐标系下的离散路点的序号。根据本发明提供的具体实施例，本发明公开了以下技术效果：本发明所提供的一种无人车路径平滑方法及系统，在全局导航指引线和车辆实时环境信息已知情况下，通过利用二次规划和动态规划的组合优化方式，生成一条考虑车辆实时朝向和位置偏差的无碰撞平滑曲线，相比与仅用曲线拟合方式的路径平滑方法，能够生成考虑车辆实时朝向和位置偏差信息的避障曲线，有利于为车辆最终运动规划结果的生成提供更加丰富的信息。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为本发明所提供的一种无人车路径平滑方法流程示意图；图2为整体流程示意图；图3为参考路点示意图；图4为第一次优化后的路点示意图；图5为连续性约束示意图；图6为动态规划算法示意图；图7为第二次优化后的路点示意图；图8为本发明生成的路径平滑曲线示意图；图9为依靠三次B样条曲线生成的路径平滑曲线示意图；图10为本发明所提供的一种无人车路径平滑系统结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的目的是提供一种无人车路径平滑方法及系统，能够在全局导航指引线和车辆实时环境信息已知情况下，生成一条考虑车辆实时朝向和位置偏差的无碰撞平滑曲线。为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图和具体实施方式对本发明作进一步详细的说明。图1为本发明所提供的一种无人车路径平滑方法流程示意图，图2整体流程示意图，如图1和图2所示，本发明所提供的一种无人车路径平滑方法，包括：S101，获取车辆全局导航指引线的离散路点，并进行三次B样条曲线拟合，得到第一拟合曲线；S102，对第一拟合曲线上的离散路点进行三次自然样条差值拟，得到第二拟合曲线；S103，对第一拟合曲线和第二拟合曲线分别提取固定步长的离散路点，并将所述第二拟合曲线提取的固定步长的离散路点作为参考路点；离散路点均包括：当前点在笛卡尔坐标系下坐标、当前点对应的角度以及曲率；即在第一拟合曲线上依据设置步长在拟合曲线上选取n个待优化离散点笛卡尔坐标系下坐标点，依据拟合曲线上选取n个待优化离散点笛卡尔坐标系下坐标点计算每两个点之间的距离，获得包含一系列点集，其中表示点距离的累加，其计算方式为，并分别进行关于和关于的三次自然样条差值拟合，然后依据给定步长提取一系列固定步长的点，并获得每个点对应的角度和曲率，获得一系列待优化点集，如图3所示。S104，根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数；确定优化变量，优化目标为使得优化后的一系列点集构成的曲线尽可能贴近步骤一获得的拟合曲线的同时，尽可能平滑且曲率变化平缓，如图4所示，故使得以下代价函数最小。S104具体包括：利用公式确定代价函数；第一项表示使平滑后的曲线尽量贴近初始全局路径，其权重表示为，第二项表示最小化曲率，使得曲线尽可能平滑，其权重表示为，第三项表示最小化曲率差，使曲率变化平缓，其权重表示为。利用公式确定离散路点和参考路点的连续性约束，如图5所示；利用公式确定车辆朝向约束、车辆实时位置偏差约束及终点约束；其中，为代价函数，、以及均为权重，为提取固定步长的离散路点的个数，和为第i个离散路点在笛卡尔坐标系下坐标，和为第i个参考路点在笛卡尔坐标系下坐标，为第i个离散路点的曲率，为第i+1个离散路点的曲率，为第i个参考路点对应的角度，为第i个离散路点对应的角度，为第i个离散路点与第i个参考路点的角度偏差，和为第i+1个离散路点在笛卡尔坐标系下坐标，为第i+1个离散路点与第i+1个参考路点的角度偏差，为当前车辆实时朝向，为车辆此时位置距离，和为起点在笛卡尔坐标系下坐标，和为终点在笛卡尔坐标系下坐标，和为第n个参考路点在笛卡尔坐标系下坐标，为Frenet坐标系下的第i个离散路点与第i+1离散路点之间的距离。S105，利用二次规划求解器对第一目标函数进行求解，获得优化后的离散路点，并对优化后的离散路点进行三次自然样条差值拟，之后提取固定步长的离散路点，并转到Frenet坐标系下；即计算每两个点之间的距离获得包含的一系列点集，并分别进行关于和关于三次样条差值，然后依据给定步长提取一系列固定步长的点，将其转到Frenet坐标系下。一次优化后曲线仅能保证车辆朝向偏差、位置偏差的消除，以及曲线平滑性及平顺性的保证，并无法满足避障需求，故采用动态规划算法对其进行重新处理，获得避障曲线。S106，将Frenet坐标系下的离散路点以设定步长在Frenet坐标系的l轴上进行上下偏移采样，确定采样点；作为一个具体的实施例，Frenet坐标系下的离散路点为m个，，每一层采样点为，个数为n；S107，利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束；S107具体以下公式：；其中，和均为每一层最小的代价值，为安全性代价，为平滑性代价，为偏差性代价，j为采样点的序号，i为Frenet坐标系下的离散路点的序号。其中，将安全性代价设置为，期望的距离障碍物的安全距离设置为，当前点距离障碍物距离表示为，则安全性代价设定为：；将当前点与对应原始点的Frenet坐标系下l轴的距离表示，每两个原始点之间的距离表示为，当前点角度为，则将平滑性代价表示为：；偏差性代价是指希望在保证安全和平滑的前提下，位置和朝向能够尽可能贴近原有的参考线，为的朝向，将偏差性代价表示为：；对每一层进行动态规划搜索，当前层最小代价值的点的上一层对应的点标记为当前层的父节点，直到搜索到最后一层后，依据父节点逐层向上分别找到每一层代价最小的点，作为一系列可通行点。每一层的代价值最小的点，在其l轴上寻找尽量满足安全距离的上下边界，作为每一层对应的可通行凸边界，如图6所示。S108，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数；S108具体包括：利用公式确定根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数；期望函数主要包括与全局路径的偏移程度和曲线的平滑性两个指标，如图7所示。第一个指标可以通过最小化l来完成。对于第二个指标，可以使曲线相对于全局路径的横向变化尽量轻微，即最小化横向距离的一阶导数和二阶导数；利用公式确定Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束；利用公式确定避障约束，并将第一个点的横向位移设置为车辆当前位置的l坐标；其中，为根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数，为Frenet坐标系下的第i个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为的二阶导数，为Frenet坐标系下的第i+1个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为Frenet坐标系下的第i个离散路点的累加距离，为Frenet坐标系下的第i+1个离散路点的累加距离，为初始累加距离，为车辆此时累加距离，为凸可行集边界的最大值和最小值。S109，利用二次规划求解器对第二目标函数进行求解，获得二次优化后的离散路点，进而根据二次优化后的离散路点确定路径平滑曲线。本发明确定路径平滑曲线考虑车辆实时位置偏差和朝向，如图8所示；仅依靠三次B样条曲线拟合路径如图9所示，由图8和图9的对比可知，本发明路径平滑且避障效果好。图10为本发明所提供的一种无人车路径平滑系统结构示意图，如图10所示，本发明所提供的一种无人车路径平滑系统，包括：第一拟合曲线确定模块1001，用于获取车辆全局导航指引线的离散路点，并进行三次B样条曲线拟合，得到第一拟合曲线；第二拟合曲线确定模块1002，用于对第一拟合曲线上的离散路点进行三次自然样条差值拟，得到第二拟合曲线；离散路点提取模块1003，用于对第一拟合曲线和第二拟合曲线分别提取固定步长的离散路点，并将所述第二拟合曲线提取的固定步长的离散路点作为参考路点；离散路点均包括：当前点在笛卡尔坐标系下坐标、当前点对应的角度以及曲率；第一目标函数构建模块1004，用于根据对应位置的离散路点和参考路点构建以代价函数最小为优化目标，以离散路点和参考路点的连续性约束、车辆朝向约束、车辆实时位置偏差约束及终点约束为约束条件的第一目标函数；第一优化模块1005，用于利用二次规划求解器对第一目标函数进行求解，获得优化后的离散路点，并对优化后的离散路点进行三次自然样条差值拟，之后提取固定步长的离散路点，并转到Frenet坐标系下；采样点确定模块1006，用于将Frenet坐标系下的离散路点以设定步长在Frenet坐标系的l轴上进行上下偏移采样，确定采样点；动态规划模块1007，用于利用动态规划算法确定每一层代价值最小的采样点，确定凸可行集边界，并根据凸可行集边界确定避障约束；第二目标函数构建模块1008，用于以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定代价函数最小为优化目标，以Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束和避障约束为约束条件，构建第二目标函数；第二优化模块1009，用于利用二次规划求解器对第二目标函数进行求解，获得二次优化后的离散路点，进而根据二次优化后的离散路点确定路径平滑曲线。所述第一目标函数构建模块1004具体包括：代价函数第一确定单元，用于利用公式确定代价函数；约束条件第一确定单元，用于利用公式确定离散路点和参考路点的连续性约束；约束条件第二确定单元，用于利用公式确定车辆朝向约束、车辆实时位置偏差约束及终点约束；其中，为代价函数，、以及均为权重，为提取固定步长的离散路点的个数，和为第i个离散路点在笛卡尔坐标系下坐标，和为第i个参考路点在笛卡尔坐标系下坐标，为第i个离散路点的曲率，为第i+1个离散路点的曲率，为第i个参考路点对应的角度，为第i个离散路点对应的角度，为第i个离散路点与第i个参考路点的角度偏差，和为第i+1个离散路点在笛卡尔坐标系下坐标，为第i+1个离散路点与第i+1个参考路点的角度偏差，为当前车辆实时朝向，为车辆此时位置距离，和为起点在笛卡尔坐标系下坐标，和为终点在笛卡尔坐标系下坐标，和为第n个参考路点在笛卡尔坐标系下坐标，为Frenet坐标系下的第i个离散路点与第i+1离散路点之间的距离。所述第二目标函数构建模块1008具体包括：代价函数第二确定单元，用于利用公式确定根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数；约束条件第三确定单元，用于利用公式确定Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离的连续性约束；约束条件第四确定单元，用于利用公式确定避障约束；其中，为根据Frenet坐标系下的离散路点与相应位置对应的采样点之间的距离确定的代价函数，为Frenet坐标系下的第i个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为的二阶导数，为Frenet坐标系下的第i+1个离散路点与相应位置对应的采样点之间的距离，为的一阶导数，为Frenet坐标系下的第i个离散路点的累加距离，为Frenet坐标系下的第i+1个离散路点的累加距离，为初始累加距离，为车辆此时累加距离，为凸可行集边界的最大值和最小值。所述动态规划模块1007具体以下公式：；其中，和均为每一层最小的代价值，为安全性代价，为平滑性代价，为偏差性代价，j为采样点的序号，i为Frenet坐标系下的离散路点的序号。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似部分互相参见即可。对于实施例公开的系统而言，由于其与实施例公开的方法相对应，所以描述的比较简单，相关之处参见方法部分说明即可。本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处。综上所述，本说明书内容不应理解为对本发明的限制。
