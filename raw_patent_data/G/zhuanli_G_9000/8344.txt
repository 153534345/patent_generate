标题title
一种基于时间序列多尺度钢轨伤损缺陷的检测方法
摘要abst
本发明适用于信号处理及深度学习技术改进领域，提供了一种基于时间序列多尺度钢轨伤损缺陷的检测方法，包括：S1、根据超声波探头类别的回声通道的原始轨道超声波数据进行数据切分及预处理；S2、设置采样系数对预处理后的切分数据进行采样获取不同尺度的采样数据；S3、对采集的不同尺度的钢轨伤损数据进行特征提取及特征融合；S4、对融合后的特征输入深度卷积神经网络连接softmax函数对时间序列进行分类；S5、根据卷积神经网络的识别结果得到钢轨伤损列表。利用多尺度的钢轨超声波时间序列信号划分，能够明显提升伤损检出率以及极大程度降低漏报率。
权利要求书clms
1.一种基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，所述检测方法包括以下步骤：S1、根据超声波探头类别的回声通道的原始轨道超声波数据进行数据切分及预处理；S2、设置采样系数对预处理后的切分数据进行采样获取不同尺度的采样数据；S3、对采集的不同尺度的钢轨伤损数据进行特征提取及特征融合；S4、对融合后的特征输入深度卷积神经网络连接softmax函数对时间序列进行分类；S5、根据卷积神经网络的识别结果得到钢轨伤损列表。2.根据权利要求1所述的基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，所述步骤S3中提取每组超声时间序列信息的平滑特征及频域特征。3.根据权利要求2所述的基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，在超声数据采集中通过采集平滑特征降低噪声的影响，设置其中fsm表示平滑后的超声时间序列信息；f＝X*，X*表示任意通道和切分组合的超声时间序列信号；xj表示时刻为j时超声波出波的回波点；l表示平滑的步长。4.根据权利要求3所述的基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，在提取频域特征时，由于钢轨超声信号属于离散时间序列，采用Z变换，Z∈Rx，将离散的时间序列变换到复频域范围内，其中，Z就是一个复数变量，表示形式可以为Z＝|Z|ejω；x表示时间序列，n表示时刻；Rx为X的收敛域。5.根据权利要求4所述的基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，所述步骤S4中对输入深度卷积神经网络的特征尺度统一并且增加特征维度中包括以下步骤：S41、在第一层设计使用不容的卷积核kconv对时间序列进行卷积操作；S42、在卷积层输出维度相同使用一层池化层对特征进行降维。6.根据权利要求5所述的基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，所述步骤S1中数据切分及预处理钢轨超声波数据现阶段显数据按照图像的方式进行呈现，根据超声波出波信息不同，按时间序列分为轨头、轨腰及轨底部分；按通道划分超声波时间序列数据。7.根据权利要求6所述的基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，所述步骤S2中使用下采样系数σ对原始的时间序列数据进行下采样操作，形成多尺度的时间序列数据，利用滑动平均算子对多尺度时间序列分析进行滑动平滑，获得滑动平滑特征fsm，时频变换的方式获取多尺度时间序列的复频域特征ffr。8.根据权利要求7所述的基于时间序列多尺度钢轨伤损缺陷的检测方法，其特征在于，融合特征作为输入数据，输入到深度卷积神经网络中，通过前向和后向迭代不断调整深度卷积神经网络的权值，最终使损失值最小。
说明书desc
技术领域本发明属于信号处理及深度学习技术改进领域，尤其涉及一种基于时间序列多尺度钢轨伤损缺陷的检测方法。背景技术大型钢轨探伤车在巡检作业过程中，由于样本采集效率高，行驶速率快，探测面积大等优势已被广泛用于日常钢轨线路巡检工作中。但由于钢轨超声波伤损数据回放时间长，数据量大以及伤损核准人员的培养难度高、周期长等因素影响。钢轨超声探伤需要耗费大量的时间及人力。因此，钢轨超声波信号的智能识别方法，将大幅提高钢轨伤损缺陷检出效率，并能够有效节省钢轨探伤投入的人工成本，并有效缩短探伤周期。现阶段较为广泛的钢轨探伤智能检测系统是根据钢轨超声波数据解析绘制成B显图像，从图像的角度，运用计算机视觉对钢轨伤损进行检测。这样可以直观感受钢轨异常部分的图像成型，但对于数据质量不够优秀的钢轨超声波数据，很难排除噪声的干扰。发明内容本发明的目的在于提供一种基于时间序列多尺度钢轨伤损缺陷的检测方法，旨在解决通过信号处理及深度学习技术进行钢轨质量的监测及评估，能够更精准和高效的检测钢轨伤损缺陷的问题。本发明是这样实现的，一种基于时间序列多尺度钢轨伤损缺陷的检测方法，所述检测方法包括以下步骤：S1、根据超声波探头类别的回声通道的原始轨道超声波数据进行数据切分及预处理；S2、设置采样系数对预处理后的切分数据进行采样获取不同尺度的采样数据；S3、对采集的不同尺度的钢轨伤损数据进行特征提取及特征融合；S4、对融合后的特征输入深度卷积神经网络连接softmax函数对时间序列进行分类；S5、根据卷积神经网络的识别结果得到钢轨伤损列表。本发明的进一步技术方案是：所述步骤S3中提取每组超声时间序列信息的平滑特征及频域特征。本发明的进一步技术方案是：在超声数据采集中通过采集平滑特征降低噪声的影响，设置其中fsm表示平滑后的超声时间序列信息；f＝X*，X*表示任意通道和切分组合的超声时间序列信号；xj表示时刻为j时超声波出波的回波点；l表示平滑的步长。本发明的进一步技术方案是：在提取频域特征时，由于钢轨超声信号属于离散时间序列，采用Z变换，Z∈Rx，将离散的时间序列变换到复频域范围内，其中，Z就是一个复数变量，表示形式可以为Z＝|Z|ejω；x表示时间序列，n表示时刻；Rx为X的收敛域。本发明的进一步技术方案是：所述步骤S4中对输入深度卷积神经网络的特征尺度统一并且增加特征维度中包括以下步骤：S41、在第一层设计使用不容的卷积核kconv对时间序列进行卷积操作；S42、在卷积层输出维度相同使用一层池化层对特征进行降维。本发明的进一步技术方案是：所述步骤S1中数据切分及预处理钢轨超声波数据现阶段显数据按照图像的方式进行呈现，根据超声波出波信息不同，按时间序列分为轨头、轨腰及轨底部分；按通道划分超声波时间序列数据。本发明的进一步技术方案是：所述步骤S2中使用下采样系数σ对原始的时间序列数据进行下采样操作，形成多尺度的时间序列数据，利用滑动平均算子对多尺度时间序列分析进行滑动平滑，获得滑动平滑特征fsm，时频变换的方式获取多尺度时间序列的复频域特征ffr。本发明的进一步技术方案是：融合特征作为输入数据，输入到深度卷积神经网络中，通过前向和后向迭代不断调整深度卷积神经网络的权值，最终使损失值最小。本发明的有益效果是：钢轨超声波信号视为时间序列信号，通过时间尺度的调整，可以精确定位某一时间段出现了伤损缺陷。并且利用多尺度的钢轨超声波时间序列信号划分，能够明显提升伤损检出率以及极大程度降低漏报率。在多尺度的时间序列数据的基础上，继续设计更高层次的平滑特征、复频域特征等，可以有效地避免钢轨超声数据中噪声对伤损结果的影响，并可以准确判断伤损出现的时刻。可以有效降低伤损识别的误报率。附图说明图1是本发明实施例提供的基于时间序列多尺度钢轨伤损缺陷的检测方法的流程图。具体实施方式如图1所示，本发明提供的基于时间序列多尺度钢轨伤损缺陷的检测方法的流程图，其详述如下：针对现有的钢轨伤损缺陷检测存在的问题，本发明将钢轨超声数据视为一种时间序列，针对时间序列使用下采样分别生成不同尺度的时间序列，对不同尺度时间序列进行特征提取，再使用深度卷积神经网络实现钢轨伤损检测。钢轨超声波数据是由大型钢轨探伤车一次作业过程中，由三组探轮不断发射超声波信号，根据钢轨异物反射得到钢轨超声波数据。其中，探轮总共包括轨头、轨腰及轨底以及底波消失，共20组不同频率及方向探头。由于一次作业中，探头不断接受发射的超声波信号，因此，钢轨超声波信号可以视为一段时间序列信号。原始钢轨超声波信号由于轨头、轨腰、轨底出波相互混杂，针对每个部分，存在不同的特征用作钢轨伤损缺陷检测。因此，本发明根据超声波探头类别，即不同的回波通道将原始的钢轨超声波回波数据进行分离切割。记录为Xcm＝{xc1,xc2,…,xcm}，其中Xcm表示第m个通道c的出波时间序列，m∈，xctn表示第n个时刻通道c出波的信号回波点。初始的完整钢轨超声波出波信号可表示为X＝{Xc1,Xc2,…,Xcm}。根据超声波信号不同，将完整超声波信号细分为轨头超声时间序列信号Xhead，轨腰超声时间序列信号Xweb以及轨底超声时间序列信号Xbase。并且根据钢轨出波具有时间特性，即钢轨内某伤损不会仅存在某一个出波上，而在一段时间间隔内都应该有相互联系的超声波出波。因此，本发明在设置时间序列的时间尺度上进行了调整，时间尺度可以分为Tr＝，n∈R。即n＝1时，即按照2个单位的时间尺寸数据作为本发明的一个时间单位数据成为一组数据，以此类推，也就是将原始数据按照时间尺度的不同切成不同的段。本发明中根据伤损位置不同，n取值不同。例如，在轨头超声回波时间序列n最大取11，即符合不超过一根钢轨的范围。对于单个通道出波的时间序列数据Xcm以及融合的超声时间序列数据Xhead、Xweb、Xbase均做时间尺度调整。设置采样系数σ对轨头，轨腰及轨底的超声时间序列进行采样，由于钢轨伤损缺陷在时间域内呈现的形式是连续且有趋势的蔓延。因此，设置采样系数σ不会影响时间序列信号的高频和低频分布。通常，σ可以取值的空间为，当σ＝1，表示不进行时间序列采样，保持原始时间序列不变；当σ＝2表示按照2倍采样率对时间序列进行采样，以此类推。由于过大的采样系数可能会导致丢失大量的时间序列信息，使时间序列信号失去原有的时间分布，因此最大采样率设置为16。由此，每组时间序列，包括单个通道的超声时间序列信息以及轨头、轨腰、轨底的切分融合超声时间序列信息，均可以生成5组新的时间序列信息。不同尺寸，不同采样频率生成的时间数据序列可以提供更为丰富的特征。对于多尺度的时间序列信息，希望可以提取丰富的，能够反映时间序列真实状态的特征用于钢轨内伤损异常的检测。在本发明中，涉及到的特征包括时间序列信号的平滑特征以及复频域特征等。特征的选择和描述如下：在钢轨超声波数据中，由于采集过程中硬件干扰以及采集过程探头调整不及时等因素影响，可能会在正常出波伤损缺陷附近产生零散的，具有高频特征的噪声信号。设置其中fsm表示平滑后的超声时间序列信息；f＝X*，X*表示任意通道和切分组合的超声时间序列信号；xj表示时刻为j时超声波出波的回波点；l表示平滑的步长，即设置多长的时间范围为一次平滑区间。通过平滑特征采集，可以降低尖锐的回波时间序列信息的影响，让真实呈现趋势的伤损更为明显。根据钢轨伤损缺陷出现位置的不同，l应设置不同阈值，例如轨头部分，l可设置为整根钢轨长度；对于轨腰部分，l可设置一个螺孔的长度。复频域特征也是时间序列信号重要的特征，可以将频率域中某些限制条件按照相应的条件转换到复频域中，在复频域中直接观测信号或系统的特征。由于钢轨超声信号属于离散时间序列，因此采用Z变换，Z∈Rx，将离散的时间序列变换到复频域范围内。其中，Z就是一个复数变量，表示形式可以为Z＝|Z|ejω；x表示时间序列，n表示时刻；Rx为X的收敛域。进一步地，在多尺寸的时间序列信息特征的基础上，为了让输入深度卷积神经网络的特征尺度统一并且为了进一步增加特征维度。针对多尺寸时间序列信息特征基础上，第一层先设计使用不同的卷积核kconv对时间序列进行卷积操作，例如，此处不同卷积核kconv可以包含基础的统计学计算局部均值、方差等卷积核等。只要保证该层卷积层输出维度相同，实现归一化，再分别使用一层池化层，对特征进行降维。这一步骤也可以实现多尺寸时间序列特征的扩增。最后将归一化融合后的特征输入深度卷积神经网络，最后连接softmax函数实现时间序列的分类。在钢轨超声时间序列信息中，由于钢轨内伤损缺陷出波是连续的并具有明显的伤损趋势，那呈现出来的时间序列的特征会存在明显不同，例如，某一通道的回波频率突然增高。结合调整时间尺度的方法，在所有钢轨超声时间序列识别完成后，可以通过时间序列识别结果反应出在时刻t时出现了伤损异常，最终伤损类别由深度卷积神经网络的识别结果确定，得到最终的伤损列表。在多尺度的时间序列数据的基础上，继续设计更高层次的平滑特征、复频域特征等，可以有效地避免钢轨超声数据中噪声对伤损结果的影响，并可以准确判断伤损出现的时刻。可以有效降低伤损识别的误报率。步骤S1，钢轨超声波时间序列的切分及预处理对于原始的超声数据信号X，根据大型钢轨探伤车出波探头的不同，可以将原始信号X按照通道拆分为Xcm，根据出波通道的性质，将通道信号融合成为轨头超声时间序列数据Xhead，轨腰超声时间序列数据Xweb以及轨底超声时间序列数据Xbase。调整轨头时间序列数据Xhead，轨腰时间序列数据Xweb，轨底时间序列数据Xbase的时间尺度，按照Tr＝尺度，将原始时间序列按照新时间尺度表示一段数据段。步骤S2，钢轨超声波时间序列的多尺度划分在切分数据的基础上，对每种数据，包括单通道的时间序列数据以及融合的时间序列数据，分别使用采样率σ＝分别对切分数据进行采样。得到不同尺度的采样数据。步骤S3，设计多尺度时间序列信号特征针对步骤S2得到的多尺寸采样数据，对于单通道的超声时间序列信号以及融合的轨头、轨腰、轨底的时间序列信号进行特征设计。本发明提取每组超声时间序列信息的平滑特征以及频域特征。由计算每组超声时间序列的平滑特征，即在某一段时间序列信号f的基础上乘上该段出波数的均值，输出为一段平滑后的时间序列。平滑步长l决定求取平滑特征时关注的时间序列长度，结合使用不同长度的平滑步长l，可以获得更多感受野下的时间序列的特征。平滑特征可以消除尖锐噪声的影响，将持续时间短暂的噪声影响消除掉。由将时域内的信号转换为复频域的信号特征ffr。复频域特征ffr特征是根据给定信号的收敛域Rx确定的，当Z＝1时，上式可变为若再定义初始信号为单边信号，即为即时间序列信号x为有限长时，信号的响应不会无穷大，信号稳定。Z变换同时具有线性可加性等特质均可以混合成为新的可以描述原始信号的特征。步骤S4，不同尺度特征的扩增及归一化在步骤S3得到的特征中，由于初始数据尺度不一样，因此生成的特征尺度也可能不一样，针对每一种特征，设计特殊的卷积核kconv，进一步地处理步骤S3得到的特征，使生成的特征图尺度一致。本发明中卷积核kconv使用过计算局域均值，方差等卷积核。再连接一层最大池化层对数据进行降维。步骤S5，深度卷积神经网络的设计、训练及识别将步骤S4生成的多维特征按照层级连接方式输入到深度卷积神经网络，现阶段，比较广泛的深度卷积神经网络种类繁多，本发明尝试使用VGG-Net网络以及Res-Net网络。尤其是Res-Net网络，可以利用残差块避免训练过程中梯度消失的问题。对于数据标注，由于在步骤S1时已经将数据进行切分处理，并根据步骤S2和步骤S3生成了多尺度特征，因此采用人工标注的方式对数据段进行标注，标签为对应的伤损类别。将具有标签的数据按照批量的方式送入深度卷积神经网络，在初始化时，会根据数据的分布特征自动初始化生成损失超曲面，按照交叉熵损失函数其中yi表示样本的标签，pi表示样本的预测概率，经过不断前向传播计算每层特征权重的损失值。根据损失值反向传播一次网络，对特征权重进行修正。不断进行训练迭代，损失值会沿着损失曲面梯度最大的方向向全局最优迭代。当损失值很小并且稳定时，表明已经迭代到最优的损失值。最终连接softmax进行伤损缺陷类别识别。在深度卷积神经网络模型训练好后，新样本识别过程只是新样本经过一次前向传播，不再反向传播计算调整网络权重，直接由softmax函数输出识别结果。步骤S6，生成钢轨伤损缺陷列表，将识别结果进行记录生成伤损缺陷列表。将钢轨超声波信号视为时间序列信号，通过时间尺度的调整，可以精确定位某一时间段出现了伤损缺陷。并且利用多尺度的钢轨超声波时间序列信号划分，能够明显提升伤损检出率以及极大程度降低漏报率。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
