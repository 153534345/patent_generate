标题title
基于随机控制的自动化生产线欺骗攻击检测方法及系统
摘要abst
本发明公开了一种基于随机控制的自动化生产线欺骗攻击检测方法及系统。在训练阶段，随机产生生产线不同设备的控制指令，使设备按照控制指令执行，并产生设备的真实运行/等待时间；通过线性回归方法识别生产线所有设备各自的真实运行/等待时间和接收到的控制指令之间的关系；在攻击检测阶段，随机产生不同设备的控制指令和预期运行/等待时间，并使生产线的预期操作周期不变，最后根据生产线上传的不同设备的运行数据计算设备真实和预期的运行/等待之间的累积偏差，从而实现攻击检测。借助本发明提供的技术方案，能够在保持生产线运行效率的前提下实现针对欺骗攻击的检测，检测过程不易受外界干扰，且检测准确率较高。
权利要求书clms
1.一种基于随机控制的自动化生产线欺骗攻击检测方法，其特征在于，所述自动化生产线符合如下特征：自动化生产线由一个或多个独立运行的工作站构成；每个工作站由速度实时可调的设备组成；每个工作站都有固定的操作周期，生产线的操作周期等于所有工作站操作周期的最大值；自动化生产线存在如下两种操作模式的工作站，第一种是所有设备按顺序操作，使得工作站的操作周期为工作站内所有设备操作时间的总和，第二种是主要设备按顺序操作，非主要设备的操作并行于主要设备，使得工作站的操作周期为工作站内所有主要设备操作时间的总和；所述检测方法包括如下步骤：步骤1：在自动化生产线训练阶段，随机产生生产线不同设备的控制指令，所述控制指令包括运行控制指令和等待控制指令，使设备按照控制指令执行，并产生设备的真实运行/等待时间；步骤2：通过线性回归方法识别生产线所有设备各自的真实运行/等待时间和接收到的控制指令之间的关系；步骤3：在自动化生产线攻击检测阶段，在生产线的每个操作周期都随机产生生产线不同设备的控制指令，使得生产线所有设备的预期运行/等待时间都随着控制指令的变化而变化，且生产线不同工作站的预期操作周期不变，从而保证生产线的预期操作周期不变；步骤4：采集自动化生产线上传的不同设备的真实运行数据，并根据设备在启动、停止时的特征，计算不同设备的真实运行/等待时间；步骤5：将真实和预期的设备等待/运行时间相减并取绝对值，得到时间偏差，并根据在一段时间内累积偏差是否超过某一阈值来完成欺骗攻击检测；如果判断生产线没有遭受攻击，则将设备的真实运行/等待时间和接收到的控制指令用于它们关系的更新。2.如权利要求1所述的基于随机控制的自动化生产线欺骗攻击检测方法，其特征在于，步骤1中，在由工程师事先制定的使生产线设备安全运行的控制范围内，对自动化生产线的设备随机下达控制指令，并收集该控制指令所对应的运行/等待时间。3.如权利要求1所述的基于随机控制的自动化生产线欺骗攻击检测方法，其特征在于，步骤2中，自动化生产线设备的运行时间和等待时间的表达式分别如下：tn＝tw其中，tm和tn分别是设备的运行时间和等待时间，v和tw分别是由接收到的控制指令所指定的设备速度和设备等待时间，d和a分别是预设的运行距离和加速度；设备的运行/等待时间和控制指令所指定的设备速度/等待时间可统一写为如下一般化的表达式：t＝ω1c-1+ω2+ω3c其中，t是设备的运行/等待时间，c是控制指令中的设备速度/等待时间；{ω1,ω2,ω3}是需用线性回归模型辨识的参数；利用控制指令和相应的设备运行/等待时间进行线性回归训练，从而得到控制指令和设备运行/等待时间之间的关系。4.如权利要求1所述的基于随机控制的自动化生产线欺骗攻击检测方法，其特征在于，步骤3中，对每个工作站中的所有设备产生控制指令，且保证每个工作站的预期操作周期固定；针对第一种工作站，具体包括如下子步骤：a.根据事先制定的安全的控制范围，计算所有设备在最快运行速度和最短等待时间下工作站的最短操作周期；b.用工作站的固定操作周期减去最短操作周期，得到工作站的总体可调整操作时间；c.根据事先制定的安全控制范围，计算工作站内不同设备的可调整运行时间和等待时间，并将可调整运行和等待时间由小到大排序；d.从最小的可调整时间对应的设备开始，随机生成一个调整时间，该调整时间的范围为从0到该设备可调整运行/等待时间和工作站总体可调整操作时间中的较小值，并将该调整时间和该设备的最快运行/等待时间相加，得到该设备的预期运行/等待时间；e.从工作站的总体可调整操作时间中减去该随机生成的调整时间，作为新的工作站的总体可调整操作时间；f.接着取下一个可调整时间对应的设备，如果不是最后一个可调整时间对应的设备，则跳转到步骤d；如果为最后一个可调整时间对应的设备，则直接将工作站的最新的总体可调整操作时间作为该设备的调整时间，并将调整时间和该设备的最快运行/等待时间相加，得到该设备的预期运行/等待时间；g.利用步骤2得到的控制指令和设备运行/等待时间之间的关系计算不同设备的控制指令；针对第二种工作站，具体包括如下子步骤：A.主要设备的运行/等待时间的控制指令的产生步骤和第一种工作站的控制指令的产生步骤相同；B.根据事先制定的安全控制范围，随机产生非主要设备的预期运行/等待时间；C.判断随机产生的所有设备的预期运行/等待时间是否满足事先制定的主要设备的运行/等待时间和非主要设备的运行/等待时间之间的用于防止碰撞的时间约束关系，如果满足则计算非主要设备的控制指令，如果不满足则回到步骤A重新产生所有设备的预期运行/等待时间。5.如权利要求1所述的基于随机控制的自动化生产线欺骗攻击检测方法，其特征在于，步骤4中，将自动化生产线上传的不同设备的真实运行数据转换为设备的真实运行/等待时间，具体包括如下子步骤：步骤4.1：根据上传的设备运行数据是否只包含0/1数据，判断这些数据是否是离散量，如果是离散量，则直接根据设备运行数据何时从0变为1来辨识设备的启动/停止事件的时间，如果是连续量，则根据设备运行数据的变化幅度来辨识设备启动/停止事件的时间；步骤4.2：将事件发生时间相近的两个事件合并为同一事件；步骤4.3：将来自同一个工作站的事件归至同一类处理；步骤4.4：对每个工作站中的启动和停止事件按时间从小到大排序；步骤4.5：根据相邻事件的时间差值来计算工作站内不同设备的运行/等待时间。6.一种基于随机控制的自动化生产线欺骗攻击检测系统，其特征在于，该系统包括设备控制指令随机产生模块、线性回归模块、运行/等待时间转换模块和欺骗攻击检测模块；在自动化生产线训练阶段，设备控制指令随机产生模块随机产生生产线不同设备的控制指令，所述控制指令包括运行控制指令和等待控制指令，使设备按照控制指令执行，并产生设备的真实运行/等待时间；通过线性回归模块使用线性回归方法识别生产线所有设备各自的真实运行/等待时间和接收到的控制指令之间的关系；在自动化生产线攻击检测阶段，设备控制指令随机产生模块在生产线的每个操作周期都随机产生生产线不同设备的控制指令，使得生产线所有设备的预期运行/等待时间都随着控制指令的变化而变化，且生产线不同工作站的预期操作周期不变，从而保证生产线的预期操作周期不变；通过运行/等待时间转换模块采集自动化生产线上传的不同设备的真实运行数据，并根据设备在启动、停止时的特征，计算不同设备的真实运行/等待时间；通过欺骗攻击检测模块将真实和预期的设备等待/运行时间相减并取绝对值，得到时间偏差，并根据在一段时间内累积偏差是否超过某一阈值来完成欺骗攻击检测，如果判断生产线没有遭受攻击，则将设备的真实运行/等待时间和接收到的控制指令用于它们关系的更新。7.一种基于随机控制的自动化生产线欺骗攻击检测装置，包括存储器和一个或多个处理器，其特征在于，所述存储器中存储有可执行代码，所述处理器执行所述可执行代码时，用于实现如权利要求1-5中任一项所述的基于随机控制的自动化生产线欺骗攻击检测方法中的步骤。8.一种计算机可读存储介质，其上存储有程序，其特征在于，该程序被处理器执行时，实现如权利要求1-5中任一项所述的基于随机控制的自动化生产线欺骗攻击检测方法中的步骤。
说明书desc
技术领域本发明涉及工控系统安全领域，特别涉及一种基于随机控制的自动化生产线欺骗攻击检测方法及系统。背景技术自动化生产线广泛部署在制造系统。自动化生产线总是周期性地执行相同的操作，导致很容易受到欺骗攻击。在欺骗攻击中，攻击者可以先记录一段时间正常的自动化生产线的运行数据，然后在攻击时篡改自动化生产线的运行数据同时重放之前记录的看似正常的自动化生产线的运行数据。这种欺骗攻击不仅可以造成设备破坏、降低生产效率等问题，还能欺骗一般的基于自动化生产线上传数据的检测器，导致工作人员不能及时发现攻击，从而造成更严重的破坏。目前，针对自动化生产线的攻击检测方法主要利用了机器学习、物理建模、形式化方法等。具体来说，这些检测器假设从自动化生产线上传上来的运行数据至少有一部分是可信的、未被攻击者欺骗的。基于上述假设，这些检测器再利用机器学习方法，例如SVM，学习正常或异常情况下自动化生产线上传上来的运行数据，在检测时主要利用未被篡改的运行数据来判断是否遭受攻击。相似的，物理建模直接对自动化生产线进行物理建模，并利用模型预测生产线正常的操作，形式化方法定义了一些物理规约，并判断上传的运行数据是否满足物理规约。然而，在攻击者欺骗/重放全部上传的运行数据时，上述检测器无法检测出攻击。发明内容本发明的目的在于针对现有技术的不足，提供一种基于随机控制的自动化生产线欺骗攻击检测方法及系统，适用于自动化生产线遭受欺骗攻击导致基于自动化生产线运行数据检测方法失效的情形。该检测方法阻止了攻击者利用自动化生产线重复工作所带来的欺骗攻击安全隐患。具体来说，该检测方法通过随机控制自动化生产线的设备，使得这些设备的运行不再只做重复的操作，从而能够阻止欺骗攻击，且检测准确率较高。本发明的目的是通过以下技术方案实现的：第一方面，本发明提供一种基于随机控制的自动化生产线欺骗攻击检测方法，在训练阶段随机产生生产线不同设备的控制指令使设备运行和等待时间随着控制指令的变化而变化，通过线性回归方法识别生产线设备的真实运行/等待时间和接收到的控制指令之间的关系；在攻击检测阶段，随机产生不同的控制指令和预期的运行/等待时间，且使得生产线的操作周期不变/固定，最后根据生产线上传的不同设备的运行数据计算生产线设备的真实运行/等待时间，并计算真实和预期的运行/等待时间之间的累积偏差实现欺骗攻击检测，如果判断生产线没有遭受攻击，则将设备的真实运行/等待时间和接收到的控制指令用于它们关系的更新。所述自动化生产线需符合如下特征：1.自动化生产线由一个或多个独立运行的工作站构成，2.每个工作站由机械臂、数控机床、电机、传送带等速度实时可调的设备组成，3.每个工作站都有固定的操作周期，生产线的操作周期等于所有工作站操作周期的最大值，4.自动化生产线可能存在如下两种操作模式的工作站，第一种是所有设备按顺序操作，使得工作站的操作周期为工作站内所有设备操作时间的总和，第二种是主要设备按顺序操作，非主要设备的操作并行于主要设备，使得工作站的操作周期为工作站内所有主要设备操作时间的总和；所述检测方法包括如下步骤：步骤1：在自动化生产线训练阶段，随机产生生产线不同设备的控制指令，所述控制指令包括运行控制指令和等待控制指令，使设备按照控制指令执行，并产生设备的真实运行/等待时间；步骤2：通过线性回归方法识别生产线所有设备各自的真实运行/等待时间和接收到的控制指令之间的关系；步骤3：在自动化生产线攻击检测阶段，在生产线的每个操作周期都随机产生生产线不同设备的控制指令，使得生产线所有设备的预期运行/等待时间都随着控制指令的变化而变化，且生产线不同工作站的预期操作周期不变，从而保证生产线的预期操作周期不变；步骤4：采集自动化生产线上传的不同设备的真实运行数据，并根据设备在启动、停止时的特征，计算不同设备的真实运行/等待时间；步骤5：将真实和预期的设备等待/运行时间相减并取绝对值，得到时间偏差，并根据在一段时间内累积偏差是否超过某一阈值来完成欺骗攻击检测。进一步地，步骤1中，在由工程师事先制定的使生产线设备安全运行的控制范围内，对自动化生产线的设备随机下达控制指令，并收集该控制指令所对应的运行/等待时间。进一步地，步骤2中，自动化生产线设备的运行时间和等待时间的表达式分别如下：tn＝tw其中，tm和tn分别是设备的运行时间和等待时间，v和tw分别是由接收到的控制指令所指定的设备速度和设备等待时间，d和a分别是预设的运行距离和加速度；设备的运行/等待时间和控制指令所指定的设备速度/等待时间可统一写为如下一般化的表达式：t＝ω1c-1+ω2+ω3c其中，t是设备的运行/等待时间，c是控制指令中的设备速度/等待时间；{ω1,ω2,ω3}是需用线性回归模型辨识的参数；利用控制指令和相应的设备运行/等待时间进行线性回归训练，从而得到控制指令和设备运行/等待时间之间的关系。进一步地，步骤3中，对每个工作站中的所有设备产生控制指令，且保证每个工作站的预期操作周期固定；针对第一种工作站，具体包括如下子步骤：a.根据工程师事先制定的安全的控制范围，计算所有设备在最快运行速度和最短等待时间下工作站的最短操作周期；b.用工作站的固定操作周期减去最短操作周期，得到工作站的总体可调整操作时间；c.根据工程师事先制定的安全控制范围，计算工作站内不同设备的可调整运行时间和等待时间，并将可调整运行和等待时间由小到大排序；d.从最小的可调整时间对应的设备开始，随机生成一个调整时间，该调整时间的范围为从0到该设备可调整运行/等待时间和工作站总体可调整操作时间中的较小值，并将该调整时间和该设备的最快运行/等待时间相加，得到该设备的预期运行/等待时间；e.从工作站的总体可调整操作时间中减去该随机生成的调整时间，作为新的工作站的总体可调整操作时间；f.接着取下一个可调整时间对应的设备，如果不是最后一个可调整时间对应的设备，则跳转到步骤d；如果为最后一个可调整时间对应的设备，则直接将工作站的最新的总体可调整操作时间作为该设备的调整时间，并将调整时间和该设备的最快运行/等待时间相加，得到该设备的预期运行/等待时间；g.利用步骤2得到的控制指令和设备运行/等待时间之间的关系计算不同设备的控制指令；针对第二种工作站，具体包括如下子步骤：A.主要设备的运行/等待时间的控制指令的产生步骤和第一种工作站的控制指令的产生步骤相同；B.根据工程师事先制定的安全控制范围，随机产生非主要设备的预期运行/等待时间；C.判断随机产生的所有设备的预期运行/等待时间是否满足工程师事先制定的主要设备的运行/等待时间和非主要设备的运行/等待时间之间的用于防止碰撞的时间约束关系，如果满足则计算非主要设备的控制指令，如果不满足则回到步骤A重新产生所有设备的预期运行/ 等待时间。进一步地，步骤4中，将自动化生产线上传的不同设备的真实运行数据转换为设备的真实运行/等待时间，具体包括如下子步骤：步骤4.1：根据上传的设备运行数据是否只包含0/1数据，判断这些数据是否是离散量，如果是离散量，则直接根据设备运行数据何时从0变为1来辨识设备的启动/停止事件的时间，如果是连续量，则根据设备运行数据的变化幅度来辨识设备启动/停止事件的时间，例如当设备运行数据的变化大于预设阈值，则辨识为设备启动，否则辨识为设备停止，阈值可以设置为设备停止时运行数据变化的最大值；步骤4.2：将事件发生时间相近的两个事件合并为同一事件；步骤4.3：将来自同一个工作站的事件归至同一类处理；步骤4.4：对每个工作站中的启动和停止事件按时间从小到大排序；步骤4.5：根据相邻事件的时间差值来计算工作站内不同设备的运行/等待时间。第二方面，本发明提供一种基于随机控制的自动化生产线欺骗攻击检测系统，该系统包括设备控制指令随机产生模块、线性回归模块、运行/等待时间转换模块和欺骗攻击检测模块；在自动化生产线训练阶段，设备控制指令随机产生模块随机产生生产线不同设备的控制指令，所述控制指令包括运行控制指令和等待控制指令，使设备按照控制指令执行，并产生设备的真实运行/等待时间；通过线性回归模块使用线性回归方法识别生产线所有设备各自的真实运行/等待时间和接收到的控制指令之间的关系；在自动化生产线攻击检测阶段，设备控制指令随机产生模块在生产线的每个操作周期都随机产生生产线不同设备的控制指令，使得生产线所有设备的预期运行/等待时间都随着控制指令的变化而变化，且生产线不同工作站的预期操作周期不变，从而保证生产线的预期操作周期不变；通过运行/等待时间转换模块采集自动化生产线上传的不同设备的真实运行数据，并根据设备在启动、停止时的特征，计算不同设备的真实运行/等待时间；通过欺骗攻击检测模块将真实和预期的设备等待/运行时间相减并取绝对值，得到时间偏差，并根据在一段时间内累积偏差是否超过某一阈值来完成欺骗攻击检测，如果判断生产线没有遭受攻击，则将设备的真实运行/等待时间和接收到的控制指令用于它们关系的更新。第三方面，本发明提供一种基于随机控制的自动化生产线欺骗攻击检测装置，包括存储器和一个或多个处理器，所述存储器中存储有可执行代码，所述处理器执行所述可执行代码时，用于实现如上述第一方面所述的基于随机控制的自动化生产线欺骗攻击检测方法中的步骤。第四方面，本发明提供一种计算机可读存储介质，其上存储有程序，该程序被处理器执行时，实现上述第一方面所述的基于随机控制的自动化生产线欺骗攻击检测方法中的步骤。与现有技术相比，本发明提出的基于随机控制的自动化生产线欺骗攻击检测的显著优点为：现有技术基于自动化生产线上传的运行数据进行攻击检测，这些检测器假设上传的部分数据是真实可靠的，因此存在当所有上传数据都被欺骗的时候检测器失效的问题。本发明可以动态地改变设备的运行时间，使得自动化生产线的设备不产生重复运行的问题，从根源上抵御了欺骗攻击。附图说明图1为本发明实施例提供的基于随机控制的自动化生产线欺骗攻击检测方法流程图。图2为本发明实施例提供的针对第一种工作站随机产生控制指令并保持工作站操作周期不变的流程图。图3为本发明实施例提供的针对第二种工作站随机产生控制指令并保持工作站操作周期不变的流程图。图4为本发明实施例提供的自动化生产线设备运行数据和运行/等待时间转换的流程图。图5为本发明实施例提供的攻击检测流程图。图6是本发明实施例提供的基于随机控制的自动化生产线欺骗攻击检测系统的结构图。图7是本发明实施例提供的基于随机控制的自动化生产线欺骗攻击检测装置的结构图。具体实施方式为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图对本发明的具体实施方式做详细的说明。最后说明，以上为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本领域的技术人员在本发明揭露的技术范围内，可以轻易的对本发明的技术方案进行修改或同等替换，都应涵盖在本发明的权利要求范围当中。本发明提供的一种基于随机控制的自动化生产线欺骗攻击检测方法，在训练阶段随机产生生产线不同设备的控制指令使设备运行和等待时间随着控制指令的变化而变化，通过线性回归方法识别生产线设备的真实运行/等待时间和接收到的控制指令之间的关系；在攻击检测阶段，随机产生不同的控制指令和预期的运行/等待时间，且使得生产线的操作周期不变/固定，最后根据生产线上传的不同设备的运行数据计算生产线设备的真实运行/等待时间，并计算真实和预期的运行/等待时间之间的累积偏差实现欺骗攻击检测，如果判断生产线没有遭受攻击，则将设备的真实运行/等待时间和接收到的控制指令用于它们关系的更新。所述自动化生产线需符合如下特征：1.自动化生产线由一个或多个独立运行的工作站构成，2.每个工作站由机械臂、数控机床、电机、传送带等速度实时可调的设备组成，3.每个工作站都有固定的操作周期，生产线的操作周期等于所有工作站操作周期的最大值，4.自动化生产线可能存在如下两种操作模式的工作站，第一种是所有设备按顺序操作，使得工作站的操作周期为工作站内所有设备操作时间的总和，第二种是主要设备按顺序操作，非主要设备的操作并行于主要设备，使得工作站的操作周期为工作站内所有主要设备操作时间的总和；本发明提出的一种主动改变系统动态性，从而抵御欺骗攻击的方法，为自动化生产线的欺骗攻击检测问题提供了一种新的思路。实施例如图1所示，本实施例提供的基于随机控制的自动化生产线欺骗攻击在线检测方法，具体包括以下步骤：步骤1、在自动化生产线训练阶段，随机产生生产线不同设备的控制指令，控制指令包括运行控制指令和等待控制指令，这些控制指令在工程师事先制定的控制范围内，接着对自动化生产线的设备随机下达控制指令，并收集该控制指令所对应的运行/等待时间。所述设备为机械臂、数控机床、电机、传送带等速度实时可调的设备。步骤2、通过线性回归方法识别生产线所有设备各自的真实运行/等待时间和接收到的控制指令之间的关系，具体为：自动化生产线设备的运行时间和等待时间的表达式分别如下：tn＝tw其中，tm和tn分别是设备的运行时间和等待时间，v和tw分别是由接收到的控制指令所指定的设备速度和设备等待时间，d和a分别是预设的运行距离和加速度；设备的运行/等待时间和控制指令所指定的设备速度/等待时间可统一写为如下一般化的表达式：t＝ω1c-1+ω2+ω3c其中，t是设备的运行/等待时间，c是控制指令中的设备速度/等待时间；{ω1,ω2,ω3}是需用线性回归模型辨识的参数；利用控制指令和相应的设备运行/等待时间进行线性回归训练，从而得到控制指令和设备运行/等待时间之间的关系。步骤3、在自动化生产线攻击检测阶段，在生产线的每个操作周期都随机产生生产线不同设备的控制指令，使得生产线所有设备的预期运行/等待时间都随着控制指令的变化而变化，且生产线不同工作站的预期操作周期不变，从而保证生产线的预期操作周期不变；如图2所示，针对第一种工作站，具体包括如下子步骤：a.根据工程师事先制定的安全的控制范围，计算所有设备在最快运行速度和最短等待时间下工作站的最短操作周期；b.用工作站的固定操作周期减去最短操作周期，得到工作站的总体可调整操作时间；c.根据工程师事先制定的安全控制范围，计算工作站内不同设备的可调整运行时间和等待时间，并将可调整运行和等待时间由小到大排序；d.从最小的可调整时间对应的设备开始，随机生成一个调整时间，该调整时间的范围为从0到该设备可调整运行/等待时间和工作站总体可调整操作时间中的较小值，并将该调整时间和该设备的最快运行/等待时间相加，得到该设备的预期运行/等待时间；e.从工作站的总体可调整操作时间中减去该随机生成的调整时间，作为新的工作站的总体可调整操作时间；f.接着取下一个可调整时间对应的设备，如果不是最后一个可调整时间对应的设备，则跳转到步骤d；如果为最后一个可调整时间对应的设备，则直接将工作站的最新的总体可调整操作时间作为该设备的调整时间，并将调整时间和该设备的最快运行/等待时间相加，得到该设备的预期运行/等待时间；g.利用步骤2得到的控制指令和设备运行/等待时间之间的关系计算不同设备的控制指令；如图3所示，针对第二种工作站，具体包括如下子步骤：A.主要设备的运行/等待时间的控制指令的产生步骤和第一种工作站的控制指令的产生步骤相同；B.根据工程师事先制定的安全控制范围，随机产生非主要设备的预期运行/等待时间；C.判断随机产生的所有设备的预期运行/等待时间是否满足工程师事先制定的主要设备的运行/等待时间和非主要设备的运行/等待时间之间的用于防止碰撞的时间约束关系，如果满足则计算非主要设备的控制指令，如果不满足则回到步骤A重新产生所有设备的预期运行/ 等待时间。时间约束写为如下表达式：其中，q是工作站内时间约束的数量，m是工作站所有主要设备的预期运行/等待操作的数量，r是工作站所有非主要设备预期运行/等待操作的数量，ti是工作站第i个预期运行/等待操作的时间，ai,k是需要辨识的工作站第k个约束中第i个预期运行/等待操作的时间的系数。 ai,k可由对自动化生产线调试经验丰富的工程师给出，或是通过生产线数字孪生/仿真器自动给出。具体来说，可以在生产线数字孪生/仿真器中随机生成控制指令并使仿真的生产线运行，得到控制指令所对应的仿真运行等待时间以及生产线设备是否会发生碰撞，最后利用线性回归和支持向量机等方法来辨识ai,k。步骤4、采集自动化生产线上传的不同设备的真实运行数据，并根据设备在启动、停止时的特征，计算不同设备的真实运行/等待时间；如图4所示，具体包括如下子步骤：步骤4.1：根据上传的设备运行数据是否只包含0/1数据，判断这些数据是否是离散量，如果是离散量，则直接根据设备运行数据何时从0变为1来辨识设备的启动/停止事件的时间，如果是连续量，则根据设备运行数据的变化幅度来辨识设备启动/停止事件的时间，例如当设备运行数据的变化大于预设阈值，则辨识为设备启动，否则辨识为设备停止，阈值可以设置为设备停止时运行数据变化的最大值；步骤4.2：将事件发生时间相近的两个事件合并为同一事件；步骤4.3：将来自同一个工作站的事件归至同一类处理；步骤4.4：对每个工作站中的启动和停止事件按时间从小到大排序；步骤4.5：根据相邻事件的时间差值来计算工作站内不同设备的运行/等待时间。步骤5、如图5所示，将真实和预期的设备等待/运行时间相减并取绝对值，得到时间偏差，并根据在一段时间内累积偏差是否超过某一阈值来完成欺骗攻击检测；如果判断生产线没有遭受攻击，则将设备的真实运行/等待时间和接收到的控制指令用于它们关系的更新。与前述基于随机控制的自动化生产线欺骗攻击检测方法的实施例相对应，本发明还提供了基于随机控制的自动化生产线欺骗攻击检测系统的实施例。如图6所示，该系统包括设备控制指令随机产生模块、线性回归模块、运行/等待时间转换模块和欺骗攻击检测模块；在自动化生产线训练阶段，设备控制指令随机产生模块随机产生生产线不同设备的控制指令，所述控制指令包括运行控制指令和等待控制指令，使设备按照控制指令执行，并产生设备的真实运行/等待时间；通过线性回归模块使用线性回归方法识别生产线所有设备各自的真实运行/等待时间和接收到的控制指令之间的关系；在自动化生产线攻击检测阶段，设备控制指令随机产生模块在生产线的每个操作周期都随机产生生产线不同设备的控制指令，使得生产线所有设备的预期运行/等待时间都随着控制指令的变化而变化，且生产线不同工作站的预期操作周期不变，从而保证生产线的预期操作周期不变；通过运行/等待时间转换模块采集自动化生产线上传的不同设备的真实运行数据，并根据设备在启动、停止时的特征，计算不同设备的真实运行/等待时间；通过欺骗攻击检测模块将真实和预期的设备等待/运行时间相减并取绝对值，得到时间偏差，并根据在一段时间内累积偏差是否超过某一阈值来完成欺骗攻击检测。与前述基于随机控制的自动化生产线欺骗攻击检测方法的实施例相对应，本发明还提供了基于随机控制的自动化生产线欺骗攻击检测装置的实施例。参见图7，本发明实施例提供的一种基于随机控制的自动化生产线欺骗攻击检测装置，包括存储器和一个或多个处理器，所述存储器中存储有可执行代码，所述处理器执行所述可执行代码时，用于实现上述实施例中的基于随机控制的自动化生产线欺骗攻击检测方法。本发明基于随机控制的自动化生产线欺骗攻击检测装置的实施例可以应用在任意具备数据处理能力的设备上，该任意具备数据处理能力的设备可以为诸如计算机等设备或装置。装置实施例可以通过软件实现，也可以通过硬件或者软硬件结合的方式实现。以软件实现为例，作为一个逻辑意义上的装置，是通过其所在任意具备数据处理能力的设备的处理器将非易失性存储器中对应的计算机程序指令读取到内存中运行形成的。从硬件层面而言，如图7所示，为本发明基于随机控制的自动化生产线欺骗攻击检测装置所在任意具备数据处理能力的设备的一种硬件结构图，除了图7所示的处理器、内存、网络接口、以及非易失性存储器之外，实施例中装置所在的任意具备数据处理能力的设备通常根据该任意具备数据处理能力的设备的实际功能，还可以包括其他硬件，对此不再赘述。上述装置中各个单元的功能和作用的实现过程具体详见上述方法中对应步骤的实现过程，在此不再赘述。对于装置实施例而言，由于其基本对应于方法实施例，所以相关之处参见方法实施例的部分说明即可。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本发明方案的目的。本领域普通技术人员在不付出创造性劳动的情况下，即可以理解并实施。本发明实施例还提供一种计算机可读存储介质，其上存储有程序，该程序被处理器执行时，实现上述实施例中的基于随机控制的自动化生产线欺骗攻击检测方法。所述计算机可读存储介质可以是前述任一实施例所述的任意具备数据处理能力的设备的内部存储单元，例如硬盘或内存。所述计算机可读存储介质也可以是任意具备数据处理能力的设备的外部存储设备，例如所述设备上配备的插接式硬盘、智能存储卡、SD卡、闪存卡等。进一步的，所述计算机可读存储介质还可以既包括任意具备数据处理能力的设备的内部存储单元也包括外部存储设备。所述计算机可读存储介质用于存储所述计算机程序以及所述任意具备数据处理能力的设备所需的其他程序和数据，还可以用于暂时地存储已经输出或者将要输出的数据。应说明的是，以上实施例仅用以说明本发明的技术方案而非限制，尽管参照较佳实施例对本发明进行了详细说明，本领域的普通技术人员应当理解，可以对本发明的技术方案进行修改或者等同替换，而不脱离本发明技术方案的精神和范围，其均应涵盖在本发明的权利要求范围当中。
