标题title
阿尔茨海默病风险评估方法和装置
摘要abst
本发明提供一种阿尔兹海默病风险评估方法和装置，所述方法包括：获取预定格式的大脑磁共振图像的输入；在图像质量检查结果为符合第一质量等级的情况下，基于第一预处理流程对磁共振图像进行预处理，在图像质量检查结果为符合第二质量等级的情况下，基于第二预处理流程对磁共振图像进行预处理；对预处理后的图像进行分割，得到灰质影像和海马体影像；将灰质影像和海马体影像输入到已训练的多模型融合风险评估模型中，得到风险评估结果。本发明能够进一步提高阿尔兹海默病风险评估的准确率，实现高效的、标准化的风险评估。
权利要求书clms
1.一种阿尔兹海默病风险评估方法，其特征在于，包括：获取预定格式的大脑磁共振图像，基于预定的图像质量评估参数对图像质量进行检查，得到图像质量检查结果；在图像质量检查结果为符合第一质量等级的情况下，基于第一预处理流程对磁共振图像进行预处理，所述第一预处理流程包括：基于大脑掩膜膨胀的图像优化步骤、图像配准步骤和灰度值归一化步骤；在图像质量检查结果为符合第二质量等级的情况下，基于第二预处理流程对磁共振图像进行预处理，所述第二预处理流程包括：图像配准步骤和灰度值归一化步骤；对预处理后的图像进行分割，得到灰质影像和海马体影像；将灰质影像和海马体影像输入到已训练的多模型融合风险评估模型中，得到风险评估结果。2.根据权利要求1所述的方法，其特征在于，所述获取预定格式的大脑磁共振图像的步骤包括：对输入图像的文件格式进行检查，若输入图像的文件格式不是预定格式，则转化为预定格式；对图像的头文件进行检查，确保图像的中心点位于脑内；所述图像质量评估参数包括以下信息中的一种或多种：磁共振视野、分辨率、对比度、图像区域大小和信噪比。3.根据权利要求1所述的方法，其特征在于，所述基于大脑掩膜膨胀的图像优化步骤包括：对图像进行颅骨去除，生成大脑掩膜；使用形态学操作对大脑掩膜使用球形核进行膨胀操作；校验掩膜大小，与大脑标准掩膜大小比较，小于标准大小则重复膨胀操作；提取膨胀后的掩膜区域作为新的图像区域；所述图像配准步骤包括：对图像进行非均匀场校正；对图像进行第一次配准操作，以带有颅骨的模板为参考配准到MNI标准空间；对图像进行颅骨去除操作；对图像进行第二次配准操作，以不带有颅骨的模板为参考配准到MNI标准空间；所述灰度值归一化步骤包括：将图像的灰度值归一化到0-1。4.根据权利要求1所述的方法，其特征在于，图像分割包含组织分割步骤和海马体分割步骤，组织分割步骤将预处理后的图像分割为灰质区域、白质区域和脑脊液区域，得到灰质影像，海马体分割步骤对预处理后的图像进行海马体提取，得到海马体影像。5.根据权利要求1所述的方法，其特征在于，所述多模型融合风险评估模型包括：基于形态学的自适应风险识别模型、基于注意力机制的风险识别模型、基于海马影像组学的风险识别模型和逻辑回归模型；将灰质影像和海马体影像输入到已训练的多模型融合风险评估模型中，得到风险评估结果，包括：将选取的灰质影像样本输入到基于形态学的自适应风险识别模型中，提取各脑区灰质体积，精细的刻画局部萎缩，鲁棒地刻画疾病，得到第一风险评估结果；将选取的灰质影像样本输入到基于注意力机制的风险识别模型中，输出分类结果和大脑注意力图谱，定位个体重要病变区域，得到第二风险评估结果；将选取的海马体影像样本输入到基于海马影像组学的风险识别模型，精确的捕捉脑补的微小病变，对阿尔兹海默病进行分类，得到第三风险评估结果；将所述第一风险评估结果、第二风险评估结果和第三风险评估结果输入到逻辑回归模型中，得到所述多模型融合风险评估模型。6.根据权利要求5所述的方法，其特征在于，所述方法还包括：所述多模型融合风险评估模型的训练步骤。7.根据权利要求5所述的方法，其特征在于，所述基于形态学的自适应风险评估模型，基于两个不同尺度的模板提取所述各脑区灰质体积，基于脑网络组图谱模板提取246个脑区的灰质体积，基于AAL模板提取90个脑区的灰质体积。8.根据权利要求1所述的方法，其特征在于，还包括输出所述风险评估结果的步骤，输出方式包括以下方式的一种或多种：图形用户界面输出、电子信息形式发送到客户端、纸质报告打印；所述多模型融合风险评估模型输出的风险评估结果是一个概率结果，表示输入的大脑磁共振图像主人患有阿尔兹海默病的概率。9.一种阿尔兹海默病风险评估装置，所述装置包含处理器和存储器，其特征在于，所述存储器中存储有计算机程序，所述处理器用于执行所述存储器中存储的计算机程序，当所述计算机程序被处理器执行时该装置实现如权利要求1至8中任一项所述方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现如权利要求1至8中任一项所述方法的步骤。
说明书desc
技术领域本发明涉及数据处理技术领域，尤其涉及一种阿尔茨海默病风险评估方法和装置。背景技术阿尔茨海默症是一种常见的老年性痴呆疾病，患者会出现包括语言和记忆在内的多项认知能力的下降。随着中国老龄化进程的加深，AD患者数量急剧攀升，已经成为了不可忽视的社会健康问题。人脑由灰质、白质和脑脊液组成，灰质萎缩作为阿尔茨海默症的重要临床指标在疾病的诊断中发挥巨大的作用。海马萎缩是阿尔茨海默病的又一显著特征，评估海马体的病变对疾病的评估非常重要。磁共振成像可以利用磁共振现象从人体中获得电磁信号,并重建出人体信息，生成脑磁共振图像。目前，磁共振成像已经成为了辅助AD早期诊断的重要方法，通过检查。越来越多的研究期望利用图像处理的方法来进一步提高脑疾病的诊断准确率，实现计算机辅助诊断。结构磁共振具有无伤、快捷、普及、花费较小等优势，然而，结构磁共振所直接反应的体积等影像学生物标记具有敏感性弱、特异性差等缺点，无法在阿尔茨海默病早期或高危人群提供强有力的信息。不同磁共振扫描仪和不同医院得到的磁共振影像异质性大，图像参数和质量各不相同，给基于影像的风险评估方法带来挑战。目前已经出现了一些利用机器学习的辅助诊断方法，但各种方法流程不一且繁杂，难以具有可用性。同时，各种方法要求的预处理方法不同，不具有标准性。尚未有针对阿尔茨海默病风险评估的综合性方法和可用性系统实现。同时，阿尔茨海默病具有一定异质性，不同被试的损伤有所不同。各种评估模型受图像质量的影响程度不同，侧重于不同的特征改变，单个模型很难完整刻画全局病变。发明内容针对现有技术中存在的问题，本发明的目的在于提供一种阿尔茨海默病风险评估方法和装置，用于阿尔兹海默病风险评估，能够呈现高效的、高实用性的、高准确率的、流程标准化的风险评估结果。本发明的一个方面提供了一种阿尔兹海默病风险评估方法，该方法包括以下步骤：获取预定格式的大脑磁共振图像，基于预定的图像质量评估参数对图像质量进行检查，得到图像质量检查结果；在图像质量检查结果为符合第一质量等级的情况下，基于第一预处理流程对磁共振图像进行预处理，所述第一预处理流程包括：基于大脑掩膜膨胀的图像优化步骤、图像配准步骤和灰度值归一化步骤；在图像质量检查结果为符合第二质量等级的情况下，基于第二预处理流程对磁共振图像进行预处理，所述第二预处理流程包括：图像配准步骤和灰度值归一化步骤；对预处理后的图像进行分割，得到灰质影像和海马体影像；将灰质影像和海马体影像输入到已训练的多模型融合风险评估模型中，得到风险评估结果。在本发明一些实施例中，所述获取预定格式的大脑磁共振图像的步骤包括：对输入图像的文件格式进行检查，若输入图像的文件格式不是预定格式，则转化为预定格式；对图像的头文件进行检查，确保图像的中心点位于脑内；所述图像质量评估参数包括以下信息中的一种或多种：磁共振视野、分辨率、对比度、图像区域大小和信噪比。在本发明一些实施例中，所述基于大脑掩膜膨胀的图像优化步骤包括：对图像进行颅骨去除，生成大脑掩膜；使用形态学操作对大脑掩膜使用球形核进行膨胀操作；校验掩膜大小，与大脑标准掩膜大小比较，小于标准大小则重复膨胀操作；提取膨胀后的掩膜区域作为新的图像区域；所述图像配准步骤包括：对图像进行非均匀场校正；对图像进行第一次配准操作，以带有颅骨的模板为参考配准到MNI标准空间；对图像进行颅骨去除操作；对图像进行第二次配准操作，以不带有颅骨的模板为参考配准到MNI标准空间；所述灰度值归一化步骤包括：将图像的灰度值归一化到0-1。在本发明一些实施例中，图像分割包含组织分割步骤和海马体分割步骤，组织分割步骤将预处理后的图像分割为灰质区域、白质区域和脑脊液区域，得到灰质影像，海马体分割步骤对预处理后的图像进行海马体提取，得到海马体影像。在本发明一些实施例中，所述多模型融合风险评估模型包括：基于形态学的自适应风险识别模型、基于注意力机制的风险识别模型、基于海马影像组学的风险识别模型和逻辑回归模型。将灰质影像和海马体影像输入到已训练的多模型融合风险评估模型中，得到风险评估结果，包括：将选取的灰质影像样本输入到基于形态学的自适应风险识别模型中，提取各脑区灰质体积，精细的刻画局部萎缩，鲁棒地刻画疾病，得到第一风险评估结果；将选取的灰质影像样本输入到基于注意力机制的风险识别模型中，输出分类结果和大脑注意力图谱，定位个体重要病变区域，得到第二风险评估结果；将选取的海马体影像样本输入到基于海马影像组学的风险识别模型，精确的捕捉脑补的微小病变，对阿尔兹海默病进行分类，得到第三风险评估结果；将所述第一风险评估结果、第二风险评估结果和第三风险评估结果输入到逻辑回归模型中，得到所述多模型融合风险评估模型。在本发明一些实施例中，所述方法还包括：所述多模型融合风险评估模型的训练步骤。在本发明一些实施例中，所述基于形态学的自适应风险评估模型，基于两个不同尺度的模板提取所述各脑区灰质体积，基于脑网络组图谱模板提取246个脑区的灰质体积，基于AAL模板提取90个脑区的灰质体积。在本发明一些实施例中，还包括输出所述风险评估结果的步骤，输出方式包括以下方式的一种或多种：图形用户界面输出、电子信息形式发送到客户端、纸质报告打印；所述多模型融合风险评估模型输出的风险评估结果是一个概率结果，表示输入的大脑磁共振图像主人患有阿尔兹海默病的概率。本发明的另一个方面提供了一种阿尔兹海默病风险评估装置，该装置包含处理器和存储器，所述存储器中存储有计算机程序，所述处理器用于执行所述存储器中存储的计算机程序，当所述计算机程序被处理器执行时该装置实现如前所述方法的步骤。本发明的另一个方面提供了一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如前所述方法的步骤。本发明实施例提供的阿尔兹海默病风险评估方法和评估装置，能够进一步提高阿尔兹海默病风险评估的准确率，通过计算机辅助诊断，实现流程的标准化，具有高效的、高实用性的、高准确率的、流程标准化的突出优点。进一步地，多模型融合风险评估模型使用可扩展的多种机器学习模型进行评估，并基于图像质量融合个模型的结果，实现对磁共振图像的精准鲁棒分析，装置实现了磁共振影像全处理流程实现。本发明的附加优点、目的，以及特征将在下面的描述中将部分地加以阐述，且将对于本领域普通技术人员在研究下文后部分地变得明显，或者可以根据本发明的实践而获知。本发明的目的和其它优点可以通过在说明书以及附图中具体指出的结构实现到并获得。本领域技术人员将会理解的是，能够用本发明实现的目的和优点不限于以上具体所述，并且根据以下详细说明将更清楚地理解本发明能够实现的上述和其他目的。附图说明此处所说明的附图用来提供对本发明的进一步理解，构成本申请的一部分，并不构成对本发明的限定。在附图中：图1为本发明一实施例的阿尔兹海默病风险评估方法。图2为为本发明一实施例自适应预处理流程示意图。图3为本发明一实施例MRI原始低质图像。图4为本发明一实施例MRI使用其他预处理方法失败图像。图5为本发明一实施例MRI使用自适应预处理流程得到的正确结果。图6为本发明一实施例中一基于图像质量的多模型融合方法流程示意图。图7为本发明又一实施例的阿尔兹海默病风险评估方法。图8为本发明提供的一种自适应阿尔茨海默病风险评估装置的电子设备的硬件结构框图。具体实施方式为使本发明的目的、技术方案和优点更加清楚明白，下面结合实施方式和附图，对本发明做进一步详细说明。在此，本发明的示意性实施方式及其说明用于解释本发明，但并不作为对本发明的限定。基于本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都应当属于本申请保护的范围。在此，还需要说明的是，为了避免因不必要的细节而模糊了本发明，在附图中仅仅示出了与根据本发明的方案密切相关的结构和/或处理步骤，而省略了与本发明关系不大的其他细节。应该强调，术语“包括/包含”在本文使用时指特征、要素、步骤或组件的存在，但并不排除一个或更多个其它特征、要素、步骤或组件的存在或附加。在此，还需要说明的是，如果没有特殊说明，术语“连接”在本文不仅可以指直接连接，也可以表示存在中间物的间接连接。为了提高阿尔兹海默病风险评估的准确率，提供标准化的风险评估流程，实现评估方法和装置的高可用性和高效率，本发明提供了一种阿尔兹海默病风险评估方法和装置，采用计算机辅助，对脑磁共振图像进行处理、分析，基于机器学习和图像处理算法实现阿尔兹海默病风险的有效评估。图1为本发明一实施例的阿尔兹海默病风险评估方法，该方法可通过计算机软件来实现，如图1所示，该方法包括以下步骤：步骤S110，获取预定格式的大脑磁共振图像，基于预定的图像质量评估参数对图像质量进行检查，得到图像质量检查结果。优选地，在一些实施例中，预定格式例如为NIFTI格式，但并不限于此格式。本步骤可包括在获得大脑磁共振图像后，对大脑磁共振图像的文件格式进行检查，若图像的文件格式不是预定格式，则转化为预定格式，例如，若输入的图像格式为DICOM格式，则将其转化为NIFTI格式，预定格式也可以是其他的医学图像领域内通用的文件格式。在本发明实施例中，在获取预定格式的大脑磁共振图像后，对文件的头文件格式进行检查，确保图像的中心点位于脑内。在本发明实施例中，图像质量评估参数包括：磁共振视野、分辨率、对比度、图像区域大小和信噪比。但是也可以是只包含以上参数中的部分参数。在本发明实施例中，依据图像质量评估参数得到的图像质量检查结果，将图像分为优质图像和低质图像。步骤S120，在图像质量检查结果为符合第一质量等级的情况下，基于第一预处理流程对磁共振图像进行预处理，所述第一预处理流程包括：基于大脑掩膜膨胀的图像优化步骤、图像配准步骤和灰度值归一化步骤；在图像质量检查结果为符合第二质量等级的情况下，基于第二预处理流程对磁共振图像进行预处理，所述第二预处理流程包括：图像配准步骤和灰度值归一化步骤。本步骤是一个自适应预处理流程，可以针对不同的图像质量，进行不同流程的预处理，从而优化预处理的步骤，提高预处理的效率，提升预处理后的结果。需要说明的是，预处理的流程并不局限于第一预处理流程和第二预处理流程，取决于，步骤S110中得到的图像质量检查结果将图像分为几类，适应性的分别进行预处理流程，预处理流程相似，为技术领域内通识性的技术方案。在本发明实施例中，基于大脑掩膜膨胀的图像优化步骤包括：对图像进行颅骨去除，生成大脑掩膜；使用形态学操作对大脑掩膜使用球形核进行膨胀操作；校验掩膜大小，与大脑标准掩膜大小比较，小于标准大小则重复膨胀操提取膨胀后的掩膜区域作为新的图像区域。对图像配准步骤包括：对图像进行非均匀场校正；对图像进行第一次配准操作，以带有颅骨的模板为参考配准到MNI标准空间；对图像进行颅骨去除操作；对图像进行第二次配准操作，以不带有颅骨的模板为参考配准到MNI标准空间。在本发明实施例中，灰度值归一化步骤是将图像的灰度值归一化到0-1。第一预处理流程和第二预处理流程的主要区别在于，没有基于大脑掩膜膨胀的图像优化步骤，原因在于第一预处理流程针对的是图像质量相对较差的图像，而第二预处理流程针对的图像质量相对较好，因而第二预处理流程不再需要执行基于大脑掩膜膨胀的图像优化步骤，从而提升图像处理效率。如图2所示，为本发明一实施例自适应预处理流程的具体示例，在检查完图像头文件后，使用自适应阈值方法生成图像掩膜，标示脑图像位置。计算图像的对比度和信噪比，根据图像分辨率、对比度和信噪比对图像进行分级，分为低质和优质两级。在本实施例中，若图像的信噪比大于1.1，对比度大于10，原始分辨率数值大于2，将其置为低质影像；反之则为高质影像。进一步地，对低质影像选择第一预处理流程进行预处理，对于高质影像选择第二预处理流程进行预处理。最后，自动检查图像配准效果，对不通过检查的图像使用第一预处理流程重新处理。在本发明实施方式中，自适应预处理模块中的第一预处理流程包括如下步骤：步骤1：对图像进行第一次颅骨去除，生成大脑掩膜；步骤2：使用形态学操作对大脑掩膜使用大小为10的球形核进行膨胀操作步骤3：校验掩膜大小，与大脑标准掩膜大小比较，小于标准大小则重复膨胀操作；步骤4：提取膨胀后的掩膜区域作为新的图像区域；步骤5：对图像进行非均匀场校正；步骤6：对图像进行第一次配准操作，以带有颅骨的模板为参考配准到MNI标准空间；步骤7：对图像进行第二次颅骨去除操作；步骤8：对图像进行第二次配准操作，以不带有颅骨的模板为参考配准到MNI标准空间；步骤9：将图像的灰度值归一化到0-1。在本发明实施方式中，自适应预处理模块中的第二预处理流程包括如下步骤：步骤1：对图像进行非均匀场校正；步骤2：对图像进行第一次配准操作，以带有颅骨的模板为参考配准到MNI标准空间；步骤3：对图像进行颅骨去除操作；步骤4：将图像的灰度值归一化到0-1。在本发明一些实施例中，非均匀场校正使用N4非均匀场校正算法实现，颅骨去除可使用FSL的Bet2工具箱实现，配准操作使用基于块匹配的算法实现。优选地，上述获取自适应预处理流程包含配准、非均匀场校正和标准化操作，有效地去除磁共振影像中存在的噪声和伪影。同时，由于人与人之间大脑结构不同，该模块将图像配准到MNI标准空间使得不同的样本之间可以互相比较。模块根据图像质量自适应预处理步骤，得到高质量的预处理结果。在本发明实施例中，标准化的自适应预处理步骤使得图像的预处理更加鲁棒和快速。磁共振采集中存在许多不确定因素，例如患者的头动、不同扫描参数和磁场的不均匀性。这些不利因素可能导致图像视野偏移和图像伪影，对图像的预处理流程造成影响。例如，过大的磁共振视野导致脖子图像占据主要部分，进而导致颅骨去除和配准失败。多次质量检查和控制保证了影像预处理的高质量。如图3所示，为本发明一实施例MRI原始低质图像，图4为本发明一实施例MRI使用其他预处理方法失败图像，图5为本发明一实施例MRI使用自适应预处理流程得到的正确结果。可以看到，自适应处理流程能够有效地避免出现因为图像质量造成的预处理失败。步骤S130，对预处理后的图像进行分割，得到灰质影像和海马体影像。在本发明实施例中，图像分割包含组织分割步骤和海马体分割步骤，组织分割步骤将预处理后的图像分割为灰质区域、白质区域和脑脊液区域，得到灰质影像，海马体分割步骤对预处理后的图像进行海马体提取，得到海马体影像。进一步的，灰质影像和海马体影像为概率体积密度图，特征性的表示人脑灰质和海马体区域的病理特征。在本发明实施例中，使用基于马尔可夫随机场的分割算法对图像进行自适应组织分割，图像已经过预处理配准到MNI标准空间，所以可以使用标准空间中灰质、白质和脑脊液的位置作为先验信息帮助精准分割。首先使用标准空间的组织掩膜提取灰质、白质和脑脊液的体素灰度均值和方差，将其作为隐马尔可夫随机场模型的初始化参数，可实现更加准确的分割。隐马尔可夫随机场是一种无监督的方法，不需要训练即可进行分割。在本发明实施例中，使用基于U-net的分割算法对图像进行自适应海马分割，图像已经过预处理配准到MNI标准空间，所以可以使用标准空间中灰质、白质和脑脊液的位置作为先验信息帮助精准分割。选择直径为5的球形核对标准空间的海马掩膜进行形态学膨胀后，提取相应区域的图像输入基于U-net的海马体分割网络进行分割，得到个体化的海马影像。模块使用手工勾画的训练集进行训练，采用BP反传算法进行参数优化，获得最优分割模型。此处也可选择其他鲁棒的分割模型进行实现。步骤S140，将灰质影像和海马体影像输入到已训练的多模型融合风险评估模型中，得到风险评估结果。在本发明实施例中，多模型融合风险评估模型包括：基于形态学的自适应风险识别模型、基于注意力机制的风险识别模型、基于海马影像组学的风险识别模型和逻辑回归模型。需要说明的是，本发明实施例中仅示意性的给出三种机器学习模型，但并不局限于仅对这三种机器学习模型进行训练，其他通识性的其他拓展模型也在多模型的范围之内。基于形态学的自适应风险识别模型，基于两个不同尺度的模板进行灰质体积提取。基于脑网络组图谱提取246个脑区的灰质体积，基于AAL模板提取90个脑区的灰质体积作为特征。当目标影像灰质体积并未发生明显变换时，246个精细脑区的灰质体积有助于更加精细地刻画局部萎缩。当目标影像灰质体积发生明显变换时， 90个脑区的灰质体积作为特征，有助于鲁棒地刻画疾病。两则兼顾，有效提高模型的准确率。选择SVM为分类器，可以选择支持向量机核函数为径向基函数，设置可调参数为惩罚系数和核函数半径。对于训练完成的模型可以选择SVM输出的分数作为模型预测风险分数。基于注意力机制的风险识别模型，模型接收分割后的灰质密度图作为输入，可由输入层、自注意力机制、全连接层和分类器构成，模型可输出分类结果和大脑注意力图谱，定位个体重要病变区域。模型训练可使用交叉熵损失函数作为目标函数，使用梯度反传算法对模型进行优化。自注意机制能够自动地提取影像中对于分类更加重要的区域，提示需要关注的微小病变。基于海马影像组学的风险识别模型，模型接收个体影像输入，高通量地提取个体海马影像的影像组学特征作为输入特征。影像组学能够精确地捕捉脑部的微小病变，以影像组学特征为参考进行阿尔茨海默病分类具有较高的敏感性。类似地，选择SVM为分类器，可以选择支持向量机核函数为径向基函数，设置可调参数为惩罚系数和核函数半径。在本发明实施例中，包括训练步骤和测试步骤，如图6所示，为本发明一实施例中一基于图像质量的多模型融合方法流程示意图。首先将N个训练样本分为6份，4份作为训练集，1份作为测试集，1份作为验证集。通过自适应预处理对每个样本获得其灰质概率密度图和个体海马图像，将灰质概率密度图输入基于形态学的自适应风险识别模型和基于注意力机制的风险识别模型中，将个体海马图像输入基于海马影像组学的风险识别模型中。基于形态学的自适应风险识别模型基于脑网络组图谱模板提取246个脑区的灰质体积，基于AAL图谱模板提取90个脑区的灰质体积，一共336个特征作为分类特征。使用训练集进行网格参数寻优，并使用测试集验证选择最优模型，输出SVM评分作为风险评分。基于注意力机制的风险识别模型接收灰质概率密度图输入，可使用交叉熵函数和BP反向传播函数对卷积网络进行训练。同时，为了增强模型的泛化性，可在训练前，将获取到的海马图像进行变换，包括加入随机噪声、随机扭曲图像和随机旋转图像。模型使用算法在训练集对参数进行寻优，并使用测试集进行验证，得到最优模型，输出模型患病评分以及注意力图谱。基于海马影像组学的风险识别模型接收海马体影像作为输入，高通量地对每个样本的海马体图像进行影像组学特征提取。模型使用训练集进行网格参数寻优，并使用测试集验证选择最优模型，输出测试集SVM评分作为风险评分。示例性的，在获得了最优的三个模型后，首先将测试集样本输入三个最优模型中，得到每个模型的评分。对每个样本可得到，其中，score1对应基于形态学的自适应风险识别模型评分，score2对应基于注意力机制的风险识别模型评分，score3对应基于海马影像组学的风险识别模型评分。将各模型的输出评分及图像质量评级输入逻辑回归模型中。逻辑回归模型包含7个自变量，分别为c，score1，score2，score3，score1*c，score2*c，score3*c。其中，score1*c，score2*c，score3*c表示基于形态学的自适应风险识别模型评分与图像质量的交互项。对逻辑回归模型进行训练，并在验证集上验证确认分类准确率，最终得到分类准确率和每个人的风险评分。在本发明的一个实施方式中，可通过完成训练的上述模型获得各模型评分输出，将各模型输出分数以及其与图像质量的交互项作为输入，使用逻辑回归对结果进行融合，输出融合后的评估结果。可以按照如下公式计算将测试集输入基于多尺度的风险评分融合模型的分类准确率：其中，accuracy表示准确率，TP表示判断正确的正类数量，TN表示判断正确的负类数量、FP表示判断错误的正类数量、FN表示判断错误的负类数量。在本实施例中，当多模型融合风险评估模型的训练步骤完成后，将灰质影像和和海马体影像输入到已训练的多模型融合风险评估模型中，得到风险评估结果，包括以下步骤：将选取的灰质影像样本输入到基于形态学的自适应风险识别模型中，提取各脑区灰质体积，精细的刻画局部萎缩，鲁棒地刻画疾病，得到第一风险评估结果；将选取的灰质影像样本输入到基于注意力机制的风险识别模型中，输出分类结果和大脑注意力图谱，定位个体重要病变区域，得到第二风险评估结果；将选取的海马体影像样本输入到基于海马影像组学的风险识别模型，精确的捕捉脑补的微小病变，对阿尔兹海默病进行分类，得到第三风险评估结果；将所述第一风险评估结果、第二风险评估结果和第三风险评估结果输入到逻辑回归模型中，得到所述多模型融合风险评估模型。如图7所示，图7为本发明又一实施例的阿尔兹海默病风险评估方法，在本发明一实施例中还包括步骤S150，输出所述风险评估结果的步骤，输出方式包括以下方式的一种或多种：图形用户界面输出、电子信息形式发送到客户端、纸质报告打印。本发明实施例还提供了一种自适应的磁共振影像的分类及预测电子设备，可以包括，输入单元、输出单元、存储器、以及处理器；所述输入单元被配置为输入待预测样本；所述存储器被配置为：存储采用上述任一实施例所述的方法得到多个样本数据；以及所述自适应预处理模块、分割模块及分类器模型；所述的处理器被配置为：从所述存储器读取所述多个样本及所述自适应预处理模块、分割模块及分类模型；至少基于所述多个样本数据训练所述多模型融合模块；以及采用训练后的多模型融合对所述预处理完成图像进行预测操作；所述输出单元被配置为输出预测结果。下面通过阿尔茨海默症和正常对照的脑疾病分类问题，基于磁共振成像数据来说明本发明的使用方法和效果，在该实例中：采用收集的阿尔茨海默患者和正常对照组的磁共振图像数据。其中，正常对照组共231人，阿尔茨海默患者共261人。具体的包括如下步骤：步骤1：评估装置输入模块获得输入；步骤2：自适应预处理模块对影像进行预处理；具体包括，根据图像的分辨率、对比度和信噪比，将影像分为低质和高质两种类型，并分别对其采用上述提到的标准处理流程和快速处理流程进行预处理，最终每个图像得到标准化的、去除头皮的、配准到MNI标准空间的图像。步骤3：对影像进行分割，获得海马体图像和灰白质图像。步骤4：将分割后的图像以及质量评级分为5份，每次选择4份进入模型融合模块训练，进行参数寻优，剩下的一份作为测试，获得测试集准确率，以此循环5次，最终获得准确率和AUC数据，如表1所示：表1基于形态学的自适应评估系统基于海马影像组学的评估系统基于注意力机制的评估系统融合模型准确率0.860.880.90.91AUC0.90.950.940.95在本实施例中，能够实现对阿尔兹海默病的准确的评估和分类，相比于单个模型准确率进一步得到了提升。从上述描述可知，本申请实施例在单个模型特征的基础上增加了多模融合，从而可以全面刻画结构影像的病变，通过建立的基于模型的评估系统，可以实现对阿尔茨海默病的准确预测。图8为本发明提供的一种自适应阿尔茨海默病风险评估装置的电子设备的硬件结构框图。如图8所示，电子设备10可以包括一个或多个处理器02、用于存储数据的存储器04、以及用于通信功能的传输模块06。本领域普通技术人员可以理解，图8所示的结构仅为示意，其并不对上述电子装置的结构造成限定。例如，电子设备10还可包括比图8中所示更多或者更少的组件，或者具有与图8所示不同的配置，处理器02可以包括但不限于微处理器MCU或可编程逻辑器件FPGA等的处理装置。存储器04可用于存储实现上述功能的的软件程序以及模块，如本申请实施例中的自适应阿尔茨海默病风险评估装置的程序指令/模块，处理器02通过运行存储在存储器04内的软件程序以及模块，从而执行各种功能应用以及数据处理，即实现上述的评估装置。存储器04可包括高速随机存储器，还可包括非易失性存储器，如一个或者多个磁性存储装置、闪存、或者其他非易失性固态存储器。在一些实例中，存储器04可进一步包括相对于处理器02远程设置的存储器，这些远程存储器可以通过网络连接至电子设备10。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。传输模块06用于经由一个网络接收或者发送数据。上述的网络具体实例可包括电子设备10的通信供应商提供的无线网络。在一个实例中，传输模块06包括一个网络适配器，其可通过基站与其他网络设备相连从而可与互联网进行通讯。在一个实例中，传输模块06可以为射频模块，其用于通过无线方式与互联网进行通讯。本申请的实施例还提供能够实现上述实施例中的阿尔茨海默病风险评估模型建立方法中全部步骤的一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，该计算机程序被处理器执行时实现上述实施例中的阿尔茨海默病风险评估模型建立方法的全部步骤。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于系统实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本说明书实施例的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。需要明确的是，本发明并不局限于上文所描述并在图中示出的特定配置和处理。为了简明起见，这里省略了对已知方法的详细描述。在上述实施例中，描述和示出了若干具体的步骤作为示例。但是，本发明的方法过程并不限于所描述和示出的具体步骤，本领域的技术人员可以在领会本发明的精神后，作出各种改变、修改和添加，或者改变步骤之间的顺序。本领域普通技术人员应该可以明白，结合本文中所公开的实施方式描述的各示例性的组成部分、系统和方法，能够以硬件、软件或者二者的结合来实现。具体究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本发明的范围。当以硬件方式实现时，其可以例如是电子电路、专用集成电路、适当的固件、插件、功能卡等等。当以软件方式实现时，本发明的元素是被用于执行所需任务的程序或者代码段。程序或者代码段可以存储在机器可读介质中，或者通过载波中携带的数据信号在传输介质或者通信链路上传送。“机器可读介质”可以包括能够存储或传输信息的任何介质。机器可读介质的例子包括电子电路、半导体存储器设备、ROM、闪存、可擦除ROM、软盘、CD-ROM、光盘、硬盘、光纤介质、射频链路，等等。代码段可以经由诸如因特网、内联网等的计算机网络被下载。本发明中，针对一个实施方式描述和/或例示的特征，可以在一个或更多个其它实施方式中以相同方式或以类似方式使用，和/或与其他实施方式的特征相结合或代替其他实施方式的特征。以上所述仅为本说明书实施例的实施例，并不用于限制本说明书实施例。对于本领域技术人员来说，本说明书实施例可以有各种更改和变化。凡在本说明书实施例的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本说明书实施例的权利要求范围之内。
