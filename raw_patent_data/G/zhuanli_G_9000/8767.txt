标题title
一种基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法
摘要abst
一种基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法，考虑了存在过程噪声,测量噪声以及参数不确定情况下的维纳非线性模型的辨识问题。根据随机优化的思想,将模型参数分为全局隐变量和局部隐变量,通过自然梯度下降方法计算全局隐变量对应的全局变分参数,实现对模型信息的更新。针对VBEM方法的局限性，只需要部分局部隐变量的信息即可实现对全局隐变量后验分布的更新,从而实现目标函数的最大化,可以显著降低变分推理的计算量,对于压力传感器温度建模的辨识具有显著的进步。
权利要求书clms
1.一种基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法，其特征在于，所述方法包括以下步骤：1)以△T为采样间隔，采集压力传感器标定装置的历史数据，包括有空气流量un和温度yn；2)构建维纳非线性模型；3)对维纳模型采用随机变分贝叶斯算法SVBI进行辨识，优化维纳模型；4)采集新的流量u′n，通过优化后的维纳模型对压力传感器标定装置的温度y′n进行计算，根据压力传感器标定装置的温度y′n对空气流量进行调节。2.如权利要求1所述的基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法，其特征在于，步骤2)中所述构建的维纳模型公式如下：yn＝f+en其中,un为系统输入变量,yn为系统输出变量并受到测量噪声en的干扰,xn为局部隐变量并受到过程噪声ωn的干扰,f为系统的非线性部分,G为输入传递函数。3.如权利要求2所述的基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法，其特征在于，步骤3)中所述对维纳模型采用随机变分贝叶斯算法SVBI进行辨识，优化维纳模型的具体方法如下：3-1)通过极大似然估计MLE算法，对维纳模型中的参数G、fi、wn、en进行最优估计，可以表示为其中，Θ为G中需要辨识参数，Λ为fi中需要辨识参数，δw为过程噪声ωn的精度，δe为测量噪声en的精度，v为测量噪声en的自由度；联合先验分布表示为：其中,α-1为参数Θ和Λ的协方差,Ι是与参数Θ和Λ具有相同维度的单位矩阵；a0和b0表示系统的超参数,为常量；3-2)记为观测数据,为局部隐变量,为全局隐变量,为结构参数集；设为变分下界，3-3)通过SVBI算法迭代更新，求解维纳模型的解局部隐变量、全局变量对应的变分参数。4.如权利要求3所述的基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法，其特征在于，步骤3-3)中所述SVBI算法迭代更新，求解维纳模型的解局部隐变量、全局变量对应的变分参数的具体步骤如下：3-3-1)初始化，设定初始迭代时刻k＝1,初始化各变量{x1:N,r1:N,Θ,Λ,δw,δe,α}的分布以及全局隐变量{Θ,Λ,δw,δe,α}对应的自然参数；分别设定超参数a0＝10-2和b0＝10-4以及结构参数v＝5.分别设定超参数a0和b0以及结构参数v的初始值；3-3-2)设定步长ρk＝-γ,ρk＝-γ≤1,k表示第k个迭代时刻,遗忘率γ表示控制旧信息遗忘的速率；延迟因子τ≥0；3-3-3)从原始数据点均匀分布的地采样Z个数据点Iz；3-3-4)计算第n个数据点对应的局部隐变量xn和rn：更新局部隐变量xn：其中,δ表示δ-函数.至此,我们可以得到局部隐变量xn在第k次迭代时的期望和方差；更新局部隐变量q：根据伽马分布的性质，可以得到局部隐变量rn在第k次迭代时的期望和方差：3-3-5)分别计算全局隐变量Θ和Λ对应的全局变分参数；更新全局隐变量Θ：可以得到下界函数在第k次迭代关于全局变分参数βΘ的自然梯度估计值为:此时全局变量Θ对应的全局变分参数βΘ的更新方式为按照高斯分布性质，得到全局隐变量Θ在第k次迭代时的期望和方差：其中,表示的第i个元素，idvec定义为向量矩阵化操作；更新全局隐变量Λ：可以得到下界函数在第k次迭代关于全局变分参数βΛ的自然梯度估计值为:此时全局变量Λ对应的全局变分参数βΛ的更新方式为按照高斯分布性质，得到全局隐变量Λ在第k次迭代时的期望和方差：3-3-6)分别计算全局隐变量δw和δe对应的全局变分参数；更新全局隐变量δw：可以得到下界函数在第k次迭代关于全局变分参数的自然梯度估计值为:此时全局变量Λ对应的全局变分参数的更新方式为按照伽马分布性质，得到全局隐变量δw在第k次迭代时的期望和方差：更新全局隐变量δe：可以得到下界函数在第k次迭代关于全局变分参数的自然梯度估计值为:此时全局变量Λ对应的全局变分参数的更新方式为按照伽马分布性质，得到全局隐变量δe在第k次迭代时的期望和方差：3-3-7)计算全局隐变量α对应的全局变分参数；可以得到下界函数在第k次迭代关于全局变分参数βα的自然梯度估计值为:此时全局变量α对应的全局变分参数βα的更新方式为按照伽马分布性质，得到全局隐变量α在第k次迭代时的期望和方差：3-3-8)求解优化问题更新vk：其中,Ψ表示lnΓ的微分；3-3-9)当下界函数收敛时停止迭代；否则返回步骤3-3-2)重复。5.如权利要求1所述的基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法，其特征在于，步骤4)中所述根据压力传感器标定装置的温度y′n对空气流量进行调节的具体方法如下：采集新的空气流量u′n，利用得到优化后的维纳模型对标定装置温度y′n进行识别，并根据当标定装置的温度稳定在62.5℃，对空气流量进行调节。
说明书desc
技术领域本发明涉及一种压力传感器标定装置温度计算方法，特别是一种基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法。背景技术压力传感器是工业实践中最为常用的一种传感器，其广泛应用于各种工业自控环境，涉及水利水电、铁路交通、智能建筑、生产自控、航空航天、军工、石化、油井、电力、船舶、机床、管道等众多行业，压力传感器在出厂前和作业前都要进行标定，作业时，压力传感器标定装置的测量精度和工作可靠性直接影响着作业质量；作业环境的压力和温度因素会引起压力传感器产生误差，在作业环境压力不变的情况下，不同的温度，会给压力传感器带来不同的输出响应，因此，对压力压力传感器标定装置温度进行识别并控制极为重要。压力传感器标定装置温度的动态变化是一个非线性过程，维纳模型是常见的用于描述非线性过程的模型，维纳模型的结构示意图如图1、图2所示。在对维纳模型的研究方法中,预测误差方法使用最为广泛,该方法通过最小化预测误差来拟合输入输出数据,从而得到系统模型。该方法原理简单,是系统辨识的标准方法,但是当模型噪声较大且出现奇异值的情况下,该方法很难得到满意的参数估计效果。极大似然估计是另一中系统辨识经典方法,它通过最大化似然函数获得参数的无偏估计,是处理强噪声情况下参数估计的有效手段。Ljung提出了维纳模型的极大似然估计方法。利用传统的MLE方法进行非线性系统辨识,由于需要直接计算似然函数,大量的指数运算和积分运算使得辨识计算量较大；而在具有隐变量不能直接计算似然函数的情况下,传统的MLE也不能用于参数估计。在MLE方法不能使用的情况下,EM算法通过直接计算隐变量的后验分布来极大化全概率似然函数,从而达到参数估计的目的。然而,由于模型中的非线性环节,很难直接计算隐变量的后验分布,使得EM算法不能直接用于维纳系统的辨识。针对此，在CN112729675A中公开了基于变分贝叶斯期望最大化的维纳模型辨识方法。该方法利用变分推断结合重要性采样技术近似求解了潜变量的后验分布,然后通过极大化全概率似然函数估计模型参数。然而,该方法由于使用了重要性采样技术且需要对每个隐变量都进行变分推断,使得该方法计算量大,不适合大规模数据下的系统辨识。发明内容本发明的目的就是提供一种基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法。本发明的目的是通过这样的技术方案实现的，它方法包括以下步骤：1)以△T为采样间隔，采集压力传感器标定装置的历史数据，包括有空气流量un和温度yn；2)构建维纳非线性模型；3)对维纳模型采用随机变分贝叶斯算法SVBI进行辨识，优化维纳模型；4)采集新的流量u′n，通过优化后的维纳模型对压力传感器标定装置的温度y′n进行计算，根据压力传感器标定装置的温度y′n对空气流量进行调节。进一步，其特征在于，步骤2)中所述构建的维纳模型公式如下：yn＝f+en其中,un为系统输入变量,yn为系统输出变量并受到测量噪声en的干扰,xn为局部隐变量并受到过程噪声ωn的干扰,f为系统的非线性部分,G为输入传递函数。进一步，其特征在于，步骤3)中所述对维纳模型采用随机变分贝叶斯算法SVBI进行辨识，优化维纳模型的具体方法如下：3-1)通过极大似然估计MLE算法，对维纳模型中的参数G、fi、wn、en进行最优估计，可以表示为其中，Θ为G中需要辨识参数，Λ为fi中需要辨识参数，δw为过程噪声ωn的精度，δe为测量噪声en的精度，v为测量噪声en的自由度；联合先验分布表示为：其中,α-1为参数Θ和Λ的协方差,Ι是与参数Θ和Λ具有相同维度的单位矩阵；a0和b0表示系统的超参数,为常量；3-2)记为观测数据,为局部隐变量,为全局隐变量,为结构参数集；设为变分下界，3-3)通过SVBI算法迭代更新，求解维纳模型的解局部隐变量、全局变量对应的变分参数。进一步，其特征在于，步骤3-3)中所述SVBI算法迭代更新，求解维纳模型的解局部隐变量、全局变量对应的变分参数的具体步骤如下：3-3-1)初始化，设定初始迭代时刻k＝1,初始化各变量{x1:N,r1:N,Θ,Λ,δw,δe,α}的分布以及全局隐变量{Θ,Λ,δw,δe,α}对应的自然参数；分别设定超参数a0＝10-2和b0＝10-4以及结构参数v＝5.分别设定超参数a0和b0以及结构参数v的初始值；3-3-2)设定步长ρk＝-γ,ρk＝-γ≤1,k表示第k个迭代时刻,遗忘率γ表示控制旧信息遗忘的速率；延迟因子τ≥0；3-3-3)从原始数据点均匀分布的地采样Z个数据点Iz；3-3-4)计算第n个数据点对应的局部隐变量xn和rn：更新局部隐变量xn：其中,δ表示δ-函数.至此,我们可以得到局部隐变量xn在第k次迭代时的期望和方差；更新局部隐变量q：根据伽马分布的性质，可以得到局部隐变量rn在第k次迭代时的期望和方差：3-3-5)分别计算全局隐变量Θ和Λ对应的全局变分参数；更新全局隐变量Θ：可以得到下界函数在第k次迭代关于全局变分参数βΘ的自然梯度估计值为:此时全局变量Θ对应的全局变分参数βΘ的更新方式为按照高斯分布性质，得到全局隐变量Θ在第k次迭代时的期望和方差：其中,表示的第i个元素，idvec定义为向量矩阵化操作；更新全局隐变量Λ：可以得到下界函数在第k次迭代关于全局变分参数βΛ的自然梯度估计值为:此时全局变量Λ对应的全局变分参数βΛ的更新方式为按照高斯分布性质，得到全局隐变量Λ在第k次迭代时的期望和方差：3-3-6)分别计算全局隐变量δw和δe对应的全局变分参数；更新全局隐变量δw：可以得到下界函数在第k次迭代关于全局变分参数的自然梯度估计值为:此时全局变量Λ对应的全局变分参数的更新方式为按照伽马分布性质，得到全局隐变量δw在第k次迭代时的期望和方差：更新全局隐变量δe：可以得到下界函数在第k次迭代关于全局变分参数的自然梯度估计值为:此时全局变量Λ对应的全局变分参数的更新方式为按照伽马分布性质，得到全局隐变量δe在第k次迭代时的期望和方差：3-3-7)计算全局隐变量α对应的全局变分参数；可以得到下界函数在第k次迭代关于全局变分参数βα的自然梯度估计值为:此时全局变量α对应的全局变分参数βα的更新方式为按照伽马分布性质，得到全局隐变量α在第k次迭代时的期望和方差：3-3-8)求解优化问题更新vk：其中,Ψ表示lnΓ的微分；3-3-9)当下界函数收敛时停止迭代；否则返回步骤3-3-2)重复。进一步，步骤4)中所述根据压力传感器标定装置的温度y′n对空气流量进行调节的具体方法如下：采集新的空气流量u′t，利用得到优化后的维纳模型对标定装置温度y′t进行识别，并根据当标定装置的温度稳定在62.5℃，对空气流量进行调节。由于采用了上述技术方案，本发明具有如下的优点：本发明采用SVBI解决存在过程噪声、奇异点及参数不确定情况下的维纳模型辨识问题。与VBEM算法相比，通过直接最大化全概率似然函数对模型参数信息进行更新,利用随机优化思想,采用自然梯度下降的方法对模型参数进行更新。使用随机梯度下降方法,在迭代中只要知道梯度期望值即可保证梯度下降的收敛性。因此,在隐变量独立的假设下,只需要部分隐变量信息即可对模型信息进行更新。通过SVBI算法可以显著降低变分推理的计算量。本发明的其他优点、目标和特征在某种程度上将在随后的说明书中进行阐述，并且在某种程度上，基于对下文的考察研究对本领域技术人员而言将是显而易见的，或者可以从本发明的实践中得到教导。本发明的目标和其他优点可以通过下面的说明书和权利要求书来实现和获得。附图说明本发明的附图说明如下。图1为维纳模型的结构示意图；图2为维纳模型的图模型表示图；图3为全局隐变量Θ的前五个参数以及Λ的收敛情况；图4为下界函数随着迭代次数增加的收敛情况；图5为预测输出与实际输出比较；图6为系统预测输出与实际输出；图7为本发明的流程示意图。具体实施方式下面结合附图和实施例对本发明作进一步说明。一种基于随机变分贝叶斯学习的压力传感器标定装置温度建模方法，具体方法如下：1)以固定的30s为采样间隔，对压力传感器标定装置的空气流量un以及标定装置的温度yn进行采集，将温度稳定在62.5℃，得到300个采样点，得到采样数据；异常值被随机地添加到5％的输出值上模拟传感器故障。2)建立维纳模型：其中,则Λ的真实值为Λ＝,将传递函数根据式和式改写为FIR模型,取L＝10,有可以得到Θ的真实值为：Θ＝T3)结合采集的数据，采用SVBI算法优化维纳模型：3-1)初始化，设定初始迭代时刻k＝1,初始化各变量{x1:N,r1:N,Θ,Λ,δw,δe,α}的分布以及全局隐变量{Θ,Λ,δw,δe,α}对应的自然参数；分别设定超参数a0＝10-2和b0＝10-4以及结构参数v＝5.分别设定超参数a0和b0以及结构参数v的初始值；3-2)设定步长ρk＝-γ,ρk＝-γ≤1,k表示第k个迭代时刻,遗忘率γ表示控制旧信息遗忘的速率；延迟因子τ≥0；3-3)从原始数据点均匀分布的地采样Z个数据点Iz；3-4)计算第n个数据点对应的局部隐变量xn和rn：更新局部隐变量xn：其中,δ表示δ-函数.至此,我们可以得到局部隐变量xn在第k次迭代时的期望和方差；更新局部隐变量q：根据伽马分布的性质，可以得到局部隐变量rn在第k次迭代时的期望和方差：3-5)分别计算全局隐变量Θ和Λ对应的全局变分参数；更新全局隐变量Θ：可以得到下界函数在第k次迭代关于全局变分参数βΘ的自然梯度估计值为:此时全局变量Θ对应的全局变分参数βΘ的更新方式为按照高斯分布性质，得到全局隐变量Θ在第k次迭代时的期望和方差：其中,表示的第i个元素，idvec定义为向量矩阵化操作；更新全局隐变量Λ：可以得到下界函数在第k次迭代关于全局变分参数βΛ的自然梯度估计值为:此时全局变量Λ对应的全局变分参数βΛ的更新方式为按照高斯分布性质，得到全局隐变量Λ在第k次迭代时的期望和方差：3-6)分别计算全局隐变量δw和δe对应的全局变分参数；更新全局隐变量δw：可以得到下界函数在第k次迭代关于全局变分参数的自然梯度估计值为:此时全局变量Λ对应的全局变分参数的更新方式为按照伽马分布性质，得到全局隐变量δw在第k次迭代时的期望和方差：更新全局隐变量δe：可以得到下界函数在第k次迭代关于全局变分参数的自然梯度估计值为:此时全局变量Λ对应的全局变分参数的更新方式为按照伽马分布性质，得到全局隐变量δe在第k次迭代时的期望和方差：3-7)计算全局隐变量α对应的全局变分参数；可以得到下界函数在第k次迭代关于全局变分参数βα的自然梯度估计值为:此时全局变量α对应的全局变分参数βα的更新方式为按照伽马分布性质，得到全局隐变量α在第k次迭代时的期望和方差：3-8)求解优化问题更新vk：其中,Ψ表示lnΓ的微分；3-9)当下界函数收敛时停止迭代；否则返回步骤3-2)重复。在仿真之前,将系统引入5％的异常值,其都来自于∪之间的均匀分布,设定遗忘速率γ＝0.3,延迟因子τ＝5.在实验过程中,从的均匀分布中采样300个数据点作为系统的激励信号,为了获得唯一解,对数据进行归一化操作,固定线性环节的第一个参数θ0＝1。分别在每次迭代时随机采样1个、5％个、10％个、20％个、以及全部数据点,每次迭代时刻使算法循环500次,从而实现对全局隐变量的更新,将辨识到的参数集列入表1。表1不同子采样数据点对应的辨识参数根据表1可知本文所提出的SVBI在对所考虑维纳模型辨识的有效性,当每次迭代时刻子采样数据点的个数增加时,对模型参数的辨识更加准确,相应的会降低算法的速度优势。为了进一步说明所提出SVBI方法的有效性,为了兼顾模型的准确性和算法的效率,在每次循环中随机均匀分布地选择5％的局部隐变量进行更新,图3为全局隐变量Θ的前五个参数以及Λ的收敛情况,随着迭代次数的增加,可以看出各参数逐渐收敛到真值；图4为下界函数随着迭代次数增加的收敛情况；图5为当系统存在5％的异常值情况下使用本文所提出方法得到的预测输出,同时绘出了系统的实际输出与无异常值时的输出曲线,通过对比表明了SVBI方法对于参数辨识的有效性。表2列出了模型存在不同程度异常值时使用本方所提出方法对参数的辨识情况；为了将本SVBI与VBEM、PEM、MLE方法进行比较,其中异常值来自于∪之间的均匀分布,假设分别有5％,10％的测量值被异常值所影响,使用50次蒙特卡洛实验来验证辨识方法,四种方法所得到的系统非线性部分的参数列入表3,同时使用均方误差来评估识别性能,同时记录了不同异常值存在时各方法的平均CPU时间。SVBI相比于其他三种方法,在时间代价上有着极大的优势；当系统不存在异常值时,在使用SVBI与VBEM方法相比于MLE和PEM方法所得到的参数平均值更接近真实值,而SVBI在运算时间上又明显由于VBEM方法；当系统存在异常值时,各方法得到的参数标准差显著增加,此时SVBI方法依旧能较为准确地得到参数估计的真实值,且当大量的测量值被异常值所破坏时,MLE无法估计模型。比较结果表明,SVBI方法在不同异常值存在时,并未破坏算法的正确性,且与VBEM方法有着相似的准确性,而在计算时间上明显优于其他三种算法,有着极大的计算优势。表2不同异常值存在时的辨识情况表3不同辨识方法的性能比较本发明用在多个非线性系统中来验证辨识参数的准确性,模型示意图如图1所示,其中G在Benchmark模型中为切比雪夫滤波器,模型中的静态非线性环节由二极管电路所建立,我们用以下过程来描述Benchmark过程：yn＝f+en其中,为了辨识此模型并体现出本文所提出方法的有效性,设定L＝35,故有共40个参数需要辨识。一共包含了188000组数据点,使用前100000个数据点来辨识模型,剩下的数据用来测试模型的准确性。在此,取6001-16000共10000个数据点来辨识模型参数,使用150001-152000共2000个数据点来验证模型。图6为系统预测输出与实际输出，表4列出了使用本文所述SVBI方法辨识到的模型的部分参数值,图5表示了在数据150001-152000时系统输出预测值与实际值的比较,结果表明了使用SVBI方法得到的辨识参数可以准确地预测输出值,对于辨识WH-Benchmark问题具有较高的准确性。表5将本文所述方法与VBEM方法以及最佳线性估计方法在进行WH-Benchmark问题辨识的结果进行了对比,均方根的值代表了预测的准确程度,明显地,本文所提出的SVBI得到预测输出的均方根明显优于BLA方法所得到的,且相比于VBEM方法也有进一步的提升。表4过程的辨识部分参数辨识结果θ01θ1-2.2829θ22.2369θ3-0.837θ4-0.6479θ5-3.931θ63.0021θ7-6.2944θ8-3.6036θ9-2.597c0-0.018239c1-0.008161c2-0.000019Q0.267599R0.00086表5不同方法的均方根比较RMS参数个数SVBI0.033540VBEM0.036719BLA0.055813本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。最后应当说明的是：以上实施例仅用以说明本发明的技术方案而非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等同替换，其均应涵盖在本发明的权利要求保护范围之内。
