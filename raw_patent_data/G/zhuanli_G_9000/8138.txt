标题title
一种基于机载音频的告警播放系统及方法
摘要abst
本发明涉及机载音频技术领域，公开了一种基于机载音频的告警播放系统，包括告警管理系统、互为主从关系的两个音频管理单元以及至少一个音频控制面板；所述告警管理系统用于收集外部系统的告警/状态指示信息，然后周期性地将告警播放信息请求的第一告警ID发出给所述音频管理单元；所述音频管理单元用于根据所述第一告警ID查询存储在所述音频管理单元内的告警音频，然后将所述告警音频发送到所述音频控制面板进行播放，同时，将当前告警音频的播放状态信息的第二告警ID周期性反馈给所述告警管理系统，本发明还公开了一种基于机载音频的告警播放方法。本发明设计的告警管理系统和音频管理单元之间的通信协议能有效防止虚警。
权利要求书clms
1.一种基于机载音频的告警播放系统，其特征在于，包括告警管理系统、互为主从关系的两个音频管理单元以及至少一个音频控制面板；所述告警管理系统用于收集外部系统的告警/状态指示信息，根据所述告警/状态信息的优先级对所述告警/状态指示信息进行综合排序和播放/中断控制，然后周期性地将告警播放信息请求的第一告警ID发出给所述音频管理单元；所述音频管理单元用于收到所述第一告警ID后，根据所述第一告警ID查询存储在所述音频管理单元内的告警音频，然后将所述告警音频发送到所述音频控制面板进行播放，同时，将当前告警音频的播放状态信息的第二告警ID周期性反馈给所述告警管理系统，其中，所述告警播放状态信息的反馈周期是所述告警播放请求信息的发送周期的两倍，以防止出现报虚警的情况。2.根据权利要求1所述的一种基于机载音频的告警播放系统，其特征在于，所述告警管理系统与所述音频管理单元之间通过ARINC429总线连接。3.根据权利要求1所述的一种基于机载音频的告警播放系统，其特征在于，所述告警音频存储在所述音频管理单元内，具体过程为：通过音频生成器产生告警音频的声波文件，将所述声波文件按顺序存储到所述音频管理单元的FLASH中。4.根据权利要求3所述的一种基于机载音频的告警播放系统，其特征在于，所述第一告警ID查询存储在所述音频管理单元内的告警音频，具体过程为：所述音频管理单元采用基于HASH索引的方法查询存储的告警音频的声波文件，HASH表中存储有所述告警音频对应的配置信息，所述第一告警ID为HASH Key；根据所述第一告警ID索引到所述HASH表中的一个Entries，获得对应的所述告警音频的配置信息，根据所述告警音频的配置信息找到存储在所述FLASH中对应的音频文件。5.根据权利要求4所述的一种基于机载音频的告警播放系统，其特征在于，所述配置信息包括但不限于所述告警音频对应的起始地址的偏移量、音频文件大小、播放次数和蜂鸣音次数。6.根据权利要求5所述的一种基于机载音频的告警播放系统，其特征在于，根据所述告警音频的配置信息找到存储在所述FLASH中对应的音频文件的具体过程为：所述音频管理单元根据Entries，获得对应的所述告警音频的起始地址的偏移量和音频文件大小，再根据所述告警音频的起始地址的偏移量和音频文件大小到FLASH对应的地址中获取音频文件；所述音频管理单元根据从HASH表中获得的告警音频的蜂鸣音次数确定播放告警音频时是否先播放蜂鸣音，根据告警音频的播放次数控制发送给所述音频控制面板的音频数据次数。7.根据权利要求3-6任一所述的一种基于机载音频的告警播放系统，其特征在于，所述声波文件的格式为wav格式。8.一种基于机载音频的告警播放方法，使用权利要求1-7任一所述的一种基于机载音频的告警播放系统，其特征在于，包括如下步骤：步骤1、所述告警管理系统收集外部系统的告警/状态指示信息，根据所述告警/状态信息的优先级对所述告警/状态指示信息进行综合排序和播放/中断控制，然后周期性地将告警播放信息请求的第一告警ID发出给所述音频管理单元；步骤2、所述音频管理单元收到所述第一告警ID后，根据所述第一告警ID查询存储在所述音频管理单元内的告警音频，然后将所述告警音频发送到所述音频控制面板进行播放，同时，将当前告警音频的播放状态信息的第二告警ID周期性反馈给所述告警管理系统，其中，所述告警播放状态信息的反馈周期是所述告警播放请求信息的发送周期的两倍，以防止出现报虚警的情况。9.根据权利要求8所述的一种基于机载音频的告警播放方法，其特征在于，步骤1中，所述第二告警ID的设置具体为：若无告警音频播放时，第二告警ID＝0；若所述音频管理单元正在进行告警音频播放处理时，将所述第二告警ID设置为正在处理的告警音频的ID。10.根据权利要求9所述的一种基于机载音频的告警播放系统，其特征在于，所述告警播放状态信息的周期性反馈与所述告警播放请求信息的周期性发送的具体步骤为：若所述音频管理单元在连续两个周期T收到同一个第一告警ID的播放请求消息，进行告警音频播放的处理，并且以两倍周期2T向所述告警管理系统反馈当前告警状态消息的第二告警ID；若所述音频管理单元在连续两个周期T中收到不同的第一告警ID的播放请求消息，则不进行告警音频播放的处理，再令第二告警ID为0，并且以两倍周期2T反馈给所述告警管理系统。
说明书desc
技术领域本发明涉及机载音频技术领域，具体涉及一种基于机载音频的告警播放系统及方法。背景技术FAR25-1309条款要求，飞机系统非正常或故障状态信息必须及时地提供给飞行机组，以便机组人员能在任何情况下及时地察觉并响应。驾驶舱音频告警用于通过驾驶舱中扬声器或耳机中发出声音的方式告知飞行员当前飞机存在的需要其知晓的异常工作状态或飞机运行指示状态。音频告警须按照告警优先级进行排序，同一时间只允许存在一种音频告警，且必要时可中断当前进行的音频告警以播放优先级更好的音频告警。民用飞机告警系统中使用的告警音频主要有两种：音调和语音告警。当前民用飞机驾驶舱告警系统一般由告警管理系统负责收集飞机系统的告警或指示信息，进行告警优先级的综合排序、根据优先级进行播放及抑制管理、告警播放次数管理等；而飞机上所有音频信号的管理和控制又是由机载音频管理系统负责的。告警管理系统只负责告警信号的控制管理，不会产生告警音频，也不会实现音频播放。因此，在机载音频管理系统中需要实现根据来自告警管理系统的告警消息生成告警音频并进行播放。而目前，若告警管理系统在没有接收到告警或指示信息的时候就传递告警信息给机载音频管理系统，会造成报虚警的情况。发明内容本发明提供一种基于机载音频的告警播放系统及方法，有效地避免了出现报虚警的情况。本发明通过下述技术方案实现：一种基于机载音频的告警播放系统，包括告警管理系统、互为主从关系的两个音频管理单元以及至少一个音频控制面板；所述告警管理系统用于收集外部系统的告警/状态指示信息，根据所述告警/状态信息的优先级对所述告警/状态指示信息进行综合排序和播放/中断控制，然后周期性地将告警播放信息请求的第一告警ID发出给所述音频管理单元；所述音频管理单元用于收到所述第一告警ID后，根据所述第一告警ID查询存储在所述音频管理单元内的告警音频，然后将所述告警音频发送到所述音频控制面板进行播放，同时，将当前告警音频的播放状态信息的第二告警ID周期性反馈给所述告警管理系统，其中，所述告警播放状态信息的反馈周期是所述告警播放请求信息的发送周期的两倍，以防止出现报虚警的情况。作为优化，所述告警管理系统与所述音频管理单元之间通过ARINC429总线连接。作为优化，所述告警音频存储在所述音频管理单元内，具体过程为：通过音频生成器产生告警音频的声波文件，将所述声波文件按顺序存储到所述音频管理单元的FLASH中。作为优化，所述第一告警ID查询存储在所述音频管理单元内的告警音频，具体过程为：所述音频管理单元采用基于HASH索引的方法查询存储的告警音频的声波文件，HASH表中存储有所述告警音频对应的配置信息，所述第一告警ID为HASH Key；根据所述第一告警ID索引到所述HASH表中的一个Entries，获得对应的所述告警音频的配置信息，根据所述告警音频的配置信息找到存储在所述FLASH中对应的音频文件。作为优化，所述配置信息包括但不限于所述告警音频对应的起始地址的偏移量、音频文件大小、播放次数和蜂鸣音次数。作为优化，根据所述告警音频的配置信息找到存储在所述FLASH中对应的音频文件的具体过程为：所述音频管理单元根据Entries，获得对应的所述告警音频的起始地址的偏移量和音频文件大小，再根据所述告警音频的起始地址的偏移量和音频文件大小到FLASH对应的地址中获取音频文件；所述音频管理单元根据从HASH表中获得的告警音频的蜂鸣音次数确定播放告警音频时是否先播放蜂鸣音，根据告警音频的播放次数控制发送给所述音频控制面板的音频数据次数。作为优化，所述声波文件的格式为wav格式。本发明还公开了一种基于机载音频的告警播放方法，包括如下步骤：步骤1、所述告警管理系统收集外部系统的告警/状态指示信息，根据所述告警/状态信息的优先级对所述告警/状态指示信息进行综合排序和播放/中断控制，然后周期性地将告警播放信息请求的第一告警ID发出给所述音频管理单元；步骤2、所述音频管理单元收到所述第一告警ID后，根据所述第一告警ID查询存储在所述音频管理单元内的告警音频，然后将所述告警音频发送到所述音频控制面板进行播放，同时，将当前告警音频的播放状态信息的第二告警ID周期性反馈给所述告警管理系统，其中，所述告警播放状态信息的反馈周期是所述告警播放请求信息的发送周期的两倍，以防止出现报虚警的情况。作为优化，步骤1中，所述第二告警ID的设置具体为：若无告警音频播放时，第二告警ID＝0；若所述音频管理单元正在进行告警音频播放处理时，将所述第二告警ID设置为正在处理的告警音频的ID。作为优化，所述告警播放状态信息的周期性反馈与所述告警播放请求信息的周期性发送的具体步骤为：若所述音频管理单元在连续两个周期T收到同一个第一告警ID的播放请求消息，进行告警音频播放的处理，并且以两倍周期2T向所述告警管理系统反馈当前告警状态消息的第二告警ID；若所述音频管理单元在连续两个周期T中收到不同的第一告警ID的播放请求消息，则不进行告警音频播放的处理，再令第二告警ID为0，并且以两倍周期2T反馈给所述告警管理系统。本发明与现有技术相比，具有如下的优点和有益效果：本发明设计的告警管理系统和音频管理单元之间的通信协议能有效防止虚警，基于HASH索引的音频文件存储和查询方法能快速提高告警文件查询速度，提高音频告警的处理效率。附图说明为了更清楚地说明本发明示例性实施方式的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。在附图中：图1为本发明所述的一种基于机载音频的告警播放系统的系统框架图；图2为图1中互为主动关系的两个音频管理单元之间的工作顺序图；图3为音频管理单元接收第一告警ID后反馈第二告警ID的行为示意图；图4为根据第一告警ID查询告警音频的行为示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚明白，下面结合实施例和附图，对本发明作进一步的详细说明，本发明的示意性实施方式及其说明仅用于解释本发明，并不作为对本发明的限定。实施例1如图1所示，一种基于机载音频的告警播放系统，包括告警管理系统、互为主从关系的两个音频管理单元以及至少一个音频控制面板。本实施例中，所述告警管理系统与所述音频管理单元之间通过ARINC429总线连接。二者之间周期性地传递音频告警ID播放请求消息和播放状态消息；告警播放状态消息的周期是告警播放请求消息的两倍。为满足FAR25-1309条款要求的告警系统冗余设计的要求，本系统中两台音频管理单元在告警音频处理中互为主备关系。其中一台音频管理单元通过一根主备指示离散线向另外一台音频管理单元输出当前的主/备状态，同时读取另外一台音频管理单元的主/备指示离散信号进行主备切换控制；如图2所示，当本台音频管理单元出现故障时，主动降为备用设备；当检测到另一台音频管理单元降为音频告警功能的备用设备时，本台音频管理单元升为主设备。所述告警管理系统用于收集外部系统的告警/状态指示信息，根据所述告警/状态信息的优先级对所述告警/状态指示信息进行综合排序和播放/中断控制，然后周期性地将告警播放信息请求的第一告警ID发出给所述音频管理单元；音频管理单元是音频告警播放的执行单元，所述音频管理单元用于收到所述第一告警ID后，根据所述第一告警ID查询存储在所述音频管理单元内的告警音频，进行音频音量调节、压缩处理，然后将所述告警音频通过ARINC429总线发送到所述音频控制面板进行播放，同时，将当前告警音频的播放状态信息的第二告警ID周期性反馈给所述告警管理系统，其中，所述告警播放状态信息的反馈周期是所述告警播放请求信息的发送周期的两倍，以防止出现报虚警的情况。如图3所示，告警管理系统将要播放的音频的第一告警ID以请求消息Aural Alerting Request通过ARINC429总线周期性地发送到音频管理单元，当无告警音频播放时，第一告警ID＝0。音频管理单元是告警音频播放的执行单元，收到第一告警ID播放请求信息AuralAlerting Request后，根据第一告警ID索引到内部存储的告警音频进行播放处理，同时会将当前告警音播放状态信息以Aural Alerting Echo消息的第二告警ID通过ARINC429总线周期性地反馈给告警管理系统，当音频管理单元正在进行告警音频播放处理时，Aural Alerting Echo消息中的第二告警ID设置为正在处理的告警音频的ID；当无音频告警处理或告警音频已经播放完成时，Aural Alerting Echo消息中的第二告警ID设置为0，然后传输给告警管理系统，以通知告警管理系统目前音频管理单元为空闲状态，可以传输告警播放信息请求。本实施例中，所述告警音频存储在所述音频管理单元内，具体过程为：通过音频生成器产生告警音频的声波文件，将所述声波文件按顺序存储到所述音频管理单元的FLASH中，每个告警音频都有起始地址偏移量和音频文件大小两个属性。如图4所示，本实施例中，所述第一告警ID查询存储在所述音频管理单元内的告警音频，具体过程为：所述音频管理单元采用基于HASH索引的方法查询存储的告警音频的声波文件，HASH表中存储有所述告警音频对应的配置信息，所述告警ID为HASH Key；根据所述告警ID索引到所述HASH表中的一个Entries，获得对应的所述告警音频的配置信息，根据所述告警音频的配置信息找到存储在所述FLASH中对应的音频文件。总的来说，如图4所示，音频管理单元采用基于HASH索引的方法查询存储的告警音频文件；将告警ID作为HASH Key，哈希函数可由使用者根据实际的音频告警需求设计，HASH表中存储着告警音频起始地址的偏移量、音频文件大小和播放次数、蜂鸣音次数等关键配置信息；音频管理单元根据告警ID索引到HASH表中的一个Entries，得到对应的告警音频在FALSH中的起始地址的偏移量和音频文件大小，再根据偏移地址和文件大小到FLASH对应的地址中获取音频文件。本实施例中，所述配置信息包括但不限于所述告警音频对应的起始地址的偏移量、音频文件大小、播放次数和蜂鸣音次数。本实施例中，根据所述告警音频的配置信息找到存储在所述FLASH中对应的音频文件的具体过程为：所述音频管理单元根据Entries，获得对应的所述告警音频的起始地址的偏移量和音频文件大小，再根据所述告警音频的起始地址的偏移量和音频文件大小到FLASH对应的地址中获取音频文件；所述音频管理单元根据从HASH表中获得的告警音频的蜂鸣音次数确定播放告警音频时是否先播放蜂鸣音，根据告警音频的播放次数控制发送给所述音频控制面板的音频数据次数。当配置信息中的蜂鸣音次数N大于等于1时，音频管理单元就会优先播放蜂鸣音，然后在播放音频告警；如果N为0，则不会播放蜂鸣音。实施例2本发明还公开了一种基于机载音频的告警播放方法，包括如下步骤：步骤1、所述告警管理系统收集外部系统的告警/状态指示信息，根据所述告警/状态信息的优先级对所述告警/状态指示信息进行综合排序和播放/中断控制，然后周期性地将告警ID以告警播放信息请求的形式发出给所述音频管理单元；步骤2、所述音频管理单元收到所述告警ID后，根据所述告警ID查询存储在所述音频管理单元内的告警音频，然后将所述告警音频发送到所述音频控制面板进行播放，同时，将当前告警音频的播放状态信息周期性反馈给所述告警管理系统，其中，所述告警播放状态信息的反馈周期是所述告警播放请求信息的发送周期的两倍，以防止出现报虚警的情况。本实施例中，为达到防虚警的目的，所述告警播放状态信息的周期性反馈与所述告警播放请求信息的周期性发送的具体步骤为：若所述音频管理单元在连续两个周期T收到同一个第一告警ID的播放请求消息，进行告警音频播放的处理，并且以两倍Aural Alerting Request周期2T向所述告警管理系统反馈当前告警状态消息；若所述音频管理单元在连续两个周期T中收到不同告警ID的播放请求消息，不进行告警音频播放的处理，则令告警ID为0，并且以两倍周期2T反馈给所述告警管理系统。机载音频告警系统支持两种类型的告警音频：音调和语音。语音音频是由一种包含话音信号的声波文件，话音告警信号采用汉语普通话，语速在0.20秒/字至0.30秒/字的范围内；音调音频为一种频率范围为200Hz～4500Hz的音频信号，至少由两种频率的单音信号组合而成或由一种频率以不同音调间隔的形式组成。每个告警音频有一个ID，用于唯一标识一个告警音频。以上所述的具体实施方式，对本发明的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上所述仅为本发明的具体实施方式而已，并不用于限定本发明的保护范围，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
