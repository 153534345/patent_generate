标题title
一种提高调制光谱测量精度的装置与方法
摘要abst
本发明公开了一种提高调制光谱测量精度的装置与方法，包括窄线宽激光器、电光调制器、光谱分析模块、微波信号源、数据采集与控制模块，其中窄线宽激光器、电光调制器和光谱分析模块依次光学连接，微波信号源与电光调制器电学连接，数据采集与控制模块分别与微波信号源和光谱分析模块采用数据总线连接。用光谱仪测量窄线宽光载波的谱线作为系统基函数，然后以该系统基函数构建实测谱线模型对实测光谱进行拟合，获得待测光谱各个谱线的位置和幅度。本发明解决了在光谱测量过程中，受到光栅光谱分析分辨率的限制，在待分辨的谱线靠近的情形下，谱线强度相互叠加，导致调制光谱测量误差较大的问题，提高了调制光谱的测量精度。
权利要求书clms
1.一种提高调制光谱测量精度的装置，其特征在于：包括窄线宽激光器、电光调制器、光谱分析模块、微波信号源、数据采集与控制模块，其中窄线宽激光器、电光调制器和光谱分析模块依次光学连接，微波信号源与电光调制器电学连接，数据采集与控制模块分别与微波信号源和光谱分析模块采用数据总线连接；用窄线宽激光器输出的窄线宽光载波入射到电光调制器，数据采集与控制模块通过总线设置微波信号源输出的频率和功率，该微波信号通过电光调制器加载到光载波上形成调制光信号入射到光谱分析模块，数据采集与控制模块通过总线采集获得调制光谱数据。2.一种提高调制光谱测量精度的方法，其特征在于，包括以下步骤：S1：数据采集与控制模块控制微波信号源输出特定频率与功率的微波信号，并通过光谱分析模块获取实测光谱数据x；S2：数据采集与控制模块控制微波信号源不输出微波信号，并通过光谱分析模块获取电光调制器空载下的空载光谱数据h；S3：事先给定谱峰数目N，如果已知第i个谱峰的峰位λi，则略过步骤S4和S5直接进入步骤S6；S4：观察实测光谱数据x的噪底，对高于噪底20dB以上的实测光谱数据求梯度，得到梯度数据Dx，寻找Dx中相邻两侧数据点的符号由正变为负的数据点，其对应的λ作为第i个谱峰的峰位λi，一共得到M个峰位信息；S5：如果M＞＝N，直接进入步骤S6，否则在步骤S4获得的M个峰位信息的基础上再添加N-M个峰位信息，对应的峰位λN+p的值可从λi中选取，从而得到新的峰位信息λi；S6：对每一个谱峰的峰位λi施加一个偏离量Δλi，得到谱峰的新峰位λi+Δλi；构造实测光谱x的估计值：其中ai为谱线峰位λi+Δλi的幅度值，δ是关于λ的狄拉克函数；S7：通过优化算法结合最小二乘拟合的方式以，ΔΛ＝，n为光谱数据点数)最小为目标函数求解得到每个谱峰的峰位λi+Δλi和对应的幅度值ai；S8：利用S7求得的峰位λi+Δλi和幅度值ai得到调制光谱3.根据权利要求2所述的方法，其特征在于，所述步骤S7中，所述优化算法为遗传算法，遗传算法结合最小二乘拟合的方式求解谱峰的峰位偏离量ΔΛ和对应的幅度值A的具体步骤为：T1：将ΔΛ＝作为遗传算法的搜索变量，其维度为N，并根据实际情况限定搜索范围；T2：将ΔΛ编码生成染色体；T3：在搜索范围内随机生成种群大小为G的初始种群，种群中每个个体的染色体对应不同的峰位偏离量ΔΛg；T4：将第g个个体的ΔΛg代入中，然后用列文伯格-马夸尔特算法求解该最小二乘拟合问题，得到ΔΛ＝ΔΛg时的幅度值Ag和残差平方和Fg，并将-Fg作为该个体的适应度值；T5：重复步骤T4，直到计算出种群中所有个体的适应度值；T6：记录最优个体的ΔA和在该ΔΛ下通过最小二乘拟合获得的幅度值A；T7：采用轮盘赌法选择种群中的较优个体“生存下来”，将其染色体进行交叉与变异操作生成下一代种群；T8：重复步骤T4～T7，直至最优适应度值的相对变化低于设定值，然后输出最后一代中最优个体的ΔΛ和在该ΔΛ下通过最小二乘拟合获得的幅度值A。4.根据权利要求2所述的方法，其特征在于，所述步骤S4中，由正变为负一般由连续2个以上的正和连续2个以上的负构成，如“正正负负”。5.根据权利要求2所述的方法，其特征在于，所述步骤S6中，δ也可以替换为微波信号源输出的微波信号的线型函数。6.根据权利要求3所述的方法，其特征在于，所述步骤T8中，一般优化直至连续20代最优适应度值的相对变化低于设定值。
说明书desc
技术领域本发明涉及光谱分辨增强领域，具体涉及一种提高调制光谱测量精度的装置与方法。背景技术光谱在获取过程中，由于谱线的自然展宽和仪器响应函数等因素影响，光谱数据谱带重叠，信噪比降低，表达在函数上，即观测结果是真实信号与多种卷积核函数的复合卷积的结果。根据瑞利判据，当幅度相同的两条谱线合成强度成马鞍形分布且强度谷值小于或等于强度峰值的81％或73％时，谱线恰能或者可以分辨；但是当谱线幅度相差较大时，幅度较低的谱线完全淹没在幅度较高谱线中，此时通过瑞利判据的强度峰谷值进行判断和测量谱线误差较大，甚至出现错误。由于卷积过程会使光谱展宽并且导致谱线重叠，使得测得的光谱失真，从该失真的谱线中恢复和还原真实谱线，以提高光谱分辨率是一个反卷积的问题。若仪器响应函数已知，其为常规反卷积问题，目前常规反卷积方法主要有基于傅里叶变换的频域反卷积算法和基于迭代反卷积的空域算法；若仪器响应函数未知，则为盲目反卷积问题。常规反卷积需要定义准确的卷积核函数，由于实测光谱是真实信号与多种卷积核函数的复合卷积结果，其受包括仪器、环境等多种因素影响，很难提出普遍适用的核函数。而盲目反卷积虽然解决了寻找核函数困难的问题，但是其难以满足结果可重复的要求。此外，由于噪声以及核函数不准确的影响，反卷积方法只能尽可能减小实测谱线的展宽，以分辨出谱线中的各个谱峰，而无法完全消除其对真实谱线强度的影响。在需要精确测量光谱中某个特定波长处谱线强度的应用场合中，反卷积方法提高谱线强度测量精度的效果有限，尤其是在两个待测谱线的位置十分接近时，通过反卷积方法获得的待测谱线强度峰值误差仍然较大甚至无法分辨互相淹没的谱线。发明内容为解决上述原因导致调制光谱测量精度低的问题，本发明提出了一种提高调制光谱测量精度的装置与方法。用光谱仪测量窄线宽光载波的谱线作为系统基函数，然后以该系统基函数作为基函数构建实测谱线模型对实测光谱进行拟合，获得待测光谱各个谱线的位置和幅度。该方法获取的系统基函数同时包含了仪器、环境等多种因素对谱线的影响，并且是以拟合而非反卷积的方式恢复真实谱线，极大降低了核函数不准确和噪声对复原结果的影响，从而可以提高谱线的测量精度。一种提高调制光谱测量精度的装置，如图1所示，包括窄线宽激光器、电光调制器、光谱分析模块、微波信号源、数据采集与控制模块，其中窄线宽激光器、电光调制器和光谱分析模块依次光学连接，微波信号源与电光调制器电学连接，数据采集与控制模块分别与微波信号源和光谱分析模块采用数据总线连接。用窄线宽激光器输出的窄线宽光载波入射到电光调制器，数据采集与控制模块通过总线设置微波信号源输出的频率和功率，该微波信号通过电光调制器加载到光载波上形成调制光信号入射到光谱分析模块，数据采集与控制模块通过总线采集获得调制光谱数据。一种提高调制光谱测量精度的方法，包括以下步骤：S1：数据采集与控制模块控制微波信号源输出特定频率与功率的微波信号，并通过光谱分析模块获取实测光谱数据x；S2：数据采集与控制模块控制微波信号源不输出微波信号，并通过光谱分析模块获取电光调制器空载下的空载光谱数据h；S3：事先给定谱峰数目N，如果已知第i个谱峰的峰位λi，则略过步骤S4和S5直接进入步骤S6；S4：观察实测光谱数据x的噪底，对高于噪底20dB以上的实测光谱数据求梯度，得到梯度数据Dx，寻找Dx中相邻两侧数据点的符号由正变为负的数据点，其对应的λ作为第i个谱峰的峰位λi，一共得到M个峰位信息；S5：如果M＞＝N，直接进入步骤S6，否则在步骤S4获得的M个峰位信息的基础上再添加N-M个峰位信息，对应的峰位λN+p的值可从λi中选取，从而得到新的峰位信息λi；S6：对每一个谱峰的峰位λi施加一个偏离量Δλi，得到谱峰的新峰位λi+Δλi；构造实测光谱x的估计值：其中ai为谱线峰位λi+Δλi的幅度值，δ是关于λ的狄拉克函数；S7：通过优化算法结合最小二乘拟合的方式以，ΔΛ＝，n为光谱数据点数)最小为目标函数求解得到每个谱峰的峰位λi+Δλi和对应的幅度值ai；S8：利用S7求得的峰位λi+Δλi和幅度值ai得到调制光谱进一步的，所述步骤S7中，所述优化算法为遗传算法，遗传算法结合最小二乘拟合的方式求解谱峰的峰位偏离量ΔΛ和对应的幅度值A的具体步骤为：T1：将ΔΛ＝作为遗传算法的搜索变量，其维度为N，并根据实际情况限定搜索范围；T2：将ΔΛ编码生成染色体；T3：在搜索范围内随机生成种群大小为G的初始种群，种群中每个个体的染色体对应不同的峰位偏离量ΔΛg；T4：将第g个个体的ΔΛg代入中，然后用列文伯格-马夸尔特算法求解该最小二乘拟合问题，得到ΔΛ＝ΔΛg时的幅度值Ag和残差平方和Fg，并将-Fg作为该个体的适应度值；T5：重复步骤T4，直到计算出种群中所有个体的适应度值；T6：记录最优个体的ΔΛ和在该ΔΛ下通过最小二乘拟合获得的幅度值A；T7：采用轮盘赌法选择种群中的较优个体“生存下来”，将其染色体进行交叉与变异操作生成下一代种群；T8：重复步骤T4～T7，直至最优适应度值的相对变化低于设定值，然后输出最后一代中最优个体的ΔΛ和在该ΔΛ下通过最小二乘拟合获得的幅度值A。进一步的，所述步骤S4中，由正变为负一般由连续2个以上的正和连续2个以上的负构成，如“正正负负”。进一步的，所述步骤S6中，δ也可以替换为微波信号源输出的微波信号的线型函数。相对于现有技术，本发明的有益效果为：1.本发明通过将用光谱分析模块获取的光载波光谱作为系统基函数，从而避免了提出普遍适用的核函数的困难，并且在测量调制光谱时，该系统基函数同时包含了光载波线宽、仪器、环境等多种因素对谱线的影响，对光谱仪在不同环境下的响应描述更为精确。2.相较于反卷积方法，本发明采用拟合的方法恢复原始谱线，极大降低了核函数不准确和噪声对复原结果的影响，并且可以完全消除光载波线宽和系统基函数展宽的影响，从而可以提高调制光谱的分辨率。3.在需要测量调制光谱中某个特定谱线强度的应用场合下，本发明充分利用整个观测光谱的信息，从拟合结果中获得特定调制谱线的强度值，而不是仅仅利用观测光谱的一个谱峰值，从而可以提高调制光谱谱峰的测量精度。并且通过理论推导，将各个调制谱线之间的强度关系融入进拟合模型可进一步减小测量误差。4.本发明提供了两种获取初始谱峰峰位的方式及其相应的求解算法，增加了其灵活性。对于已知谱峰峰位的情况，在建立拟合模型时，针对某一具体的调制系统，可充分利用调制谱线之间的关系约束信息，提高测量精度；而用算法从实测光谱中获取初始谱峰位可避免理论推导过程，并且其具有一定的普适性。附图说明图1为本发明一种提高调制光谱测量精度的装置示意图。图2为实施例一中用本发明的方法恢复调制光谱的结果。图3为实施例二中用本发明的方法恢复调制光谱的结果。具体实施方式下面结合实施例对本发明作进一步的描述，所描述的实施例仅仅是本发明一部分实施例，并不是全部的实施例。基于本发明中的实施例，本领域的普通技术人员在没有做出创造性劳动前提下所获得的其他所用实施例，都属于本发明的保护范围。下面结合附图及数学推导对本发明的实施例做进一步说明。实施例一一种提高调制光谱测量精度的装置，如图1所示，包括窄线宽激光器、电光调制器、光谱分析模块、微波信号源、数据采集与控制模块，其中窄线宽激光器、电光调制器和光谱分析模块依次光学连接，微波信号源与电光调制器电学连接，数据采集与控制模块分别与微波信号源和光谱分析模块采用数据总线连接。用窄线宽激光器输出的窄线宽光载波入射到电光调制器，数据采集与控制模块通过总线设置微波信号源输出的频率和功率，该微波信号通过电光调制器加载到光载波上形成调制光信号入射到光谱分析模块，数据采集与控制模块通过总线采集获得调制光谱数据。本实施例用本发明的装置与方法提高已知谱峰峰位的实测调制光谱的测量精度。由激光器发出的频率为f0的光载波经过电光调制器进行调制，首先数据采集与控制模块控制微波信号源输出频率为fm的微波信号并采集光谱分析模块的光谱数据得到实测光谱数据x，然后数据采集与控制模块控制微波信号源不输出微波信号并采集光谱分析模块的光谱数据得到电光调制器空载下的空载光谱数据h。对于一个具体的电光调制器，可推导出其调制边带的位置，本实施例中的电光调制器的调制边带的频率为f0+nfm，若取只取正负三阶边带，则调制边带的频率为f0+nfm。用式λ＝c/f将其转换为波长即得到7个谱峰的峰位，λi。对每一个谱峰的峰位λi施加一个偏离量Δλi，得到谱峰的新峰位λi+Δλi；构造实测光谱x的估计值：其中ai为谱线峰位λi+Δλi的幅度值，δ是关于λ的狄拉克函数。若已知各个调制边带之间的强度关系可对ai作进一步限制从而进一步提高测量精度，为不失普适性，本实施例不考虑调制边带之间的强度关系。通过优化算法结合最小二乘拟合的方式以，ΔΛ＝，n为光谱数据点数)最小为目标函数求解得到每个谱峰的峰位λi+Δλi和对应的幅度值ai。具体求解步骤如下：T1：将ΔΛ＝作为遗传算法的搜索变量，其维度为7，由于已知调制谱线位置，其偏移量一般不会超过光谱仪采样步长的量级，故限定搜索范围为；T2：将ΔΛ编码生成染色体；T3：在搜索范围内随机生成种群大小为100的初始种群，种群中每个个体的染色体对应不同的峰位偏离量ΔΛg；T4：将第g个个体的ΔΛg代入中，然后用列文伯格-马夸尔特算法求解该最小二乘拟合问题，得到ΔΛ＝ΔΛg时的幅度值Ag和残差平方和Fg，并将-Fg作为该个体的适应度值；T5：重复步骤T4，直到计算出种群中所有个体的适应度值；T6：记录最优个体的ΔΛ和在该ΔΛ下通过最小二乘拟合获得的幅度值A；T7：采用轮盘赌法选择种群中的较优个体“生存下来”，将其染色体进行交叉与变异操作生成下一代种群；T8：重复步骤T4～T7，直至连续20代最优适应度值的相对变化低于10-6，然后输出最后一代中最优个体的ΔΛ和在该ΔΛ下通过最小二乘拟合获得的幅度值A。最后根据求得的峰位λi+Δλi和幅度值ai得到调制光谱图2为本实施例中，光载波波长为1550nm，微波调制频率fm设置为1GHz时的实测调制光谱与用本发明的方法恢复出的调制光谱的对比。可以看出用本发明的方法成功恢复出了被载波覆盖的边带，提高了光谱分辨率。实施例二本实施例用本发明的装置与方法提高调制光谱的分辨率与测量精度。与实施例一的区别在于，本实施例中事先并不知道调制光谱的谱峰峰位λi。具体实施过程如下：由激光器发出的频率为f0的光载波经过电光调制器进行调制，首先数据采集与控制模块控制微波信号源输出频率为fm的微波信号并采集光谱分析模块的光谱数据得到实测光谱数据x，然后数据采集与控制模块控制微波信号源不输出微波信号并采集光谱分析模块的光谱数据得到电光调制器空载下的空载光谱数据h。给定需要从实测调制光谱中分辨出的谱峰数目5，由于不知道谱峰峰位信息，则需要从实测光谱数据x中获取谱峰峰位信息。观察实测光谱数据x的噪底，对高于噪底20dB以上的实测光谱数据求梯度，得到梯度数据Dx，寻找Dx中相邻两侧数据点的符号由正变为负的数据点，其对应的λ作为第i个谱峰的峰位λi，一共得到M个峰位信息。由于本实施例中调制频率fm设置为4GHz，调制光谱靠的的太近，通过上述方法只识别出了2个谱峰和相应的峰位λi，因此需要额外添加3个谱峰及其相应的峰位λp，选取λ2的值作为新添加的谱峰的粗略峰位值，即λp＝λ2。于是得到了新的峰位信息λi。对每一个谱峰的峰位λi施加一个偏离量Δλi，得到谱峰的新峰位λi+Δλi；构造实测光谱x的估计值：其中ai为谱线峰位λi+Δλi的幅度值，δ是关于λ的狄拉克函数。通过优化算法结合最小二乘拟合的方式以，ΔΛ＝，n为光谱数据点数)最小为目标函数求解得到每个谱峰的峰位λi+Δλi和对应的幅度值ai。具体求解步骤如下：T1：将ΔΛ＝作为遗传算法的搜索变量，其维度为5，限定搜索范围为；T2：将ΔΛ编码生成染色体；T3：在搜索范围内随机生成种群大小为100的初始种群，种群中每个个体的染色体对应不同的峰位偏离量ΔΛg；T4：将第g个个体的ΔΛg代入中，然后用列文伯格-马夸尔特算法求解该最小二乘拟合问题，得到ΔΛ＝ΔΛg时的幅度值Ag和残差平方和Fg，并将-Fg作为该个体的适应度值；T5：重复步骤T4，直到计算出种群中所有个体的适应度值；T6：记录最优个体的ΔΛ和在该ΔΛ下通过最小二乘拟合获得的幅度值A；T7：采用轮盘赌法选择种群中的较优个体“生存下来”，将其染色体进行交叉与变异操作生成下一代种群；T8：重复步骤T4～T7，直至连续20代最优适应度值的相对变化低于10-6，然后输出最后一代中最优个体的ΔΛ和在该ΔΛ下通过最小二乘拟合获得的幅度值A。最后根据求得的峰位λi+Δλi和幅度值ai得到调制光谱图3为本实施例中，光载波波长为1550nm，微波调制频率fm设置为4GHz时的实测调制光谱与用本发明的方法恢复出的调制光谱的对比。可以看出用本发明的方法成功恢复出了被载波覆盖的边带，提高了光谱分辨率。
