标题title
Fast-Flux僵尸网络检测方法、装置、设备及存储介质
摘要abst
本发明实施例公开了一种Fast‑Flux僵尸网络检测方法、装置、设备及存储介质。该方法包括获取目标检测域名，每隔监控时长，获取匹配的解析IP结果数据；将监控时长划分为多个时间单元，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算归一化静态统计指标集和归一化动态统计指标集；进而计算对应的拟合静态值和拟合动态值，并分别输入至预先训练的支持向量机SVM模型中，确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定僵尸网络。本实施例的技术方案实现提高分析DNS流量数据的工作效率，降低误报率，提高检测结果的准确性的效果。
权利要求书clms
1.一种Fast-Flux僵尸网络检测方法，其特征在于，包括：获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据；将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集；根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值；将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果；根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果；在确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。2.根据权利要求1所述的方法，其特征在于，获取目标检测域名，包括：从所述DNS流量中获取多个响应数据包，并对所有响应数据包进行解析，获取多个待检测域名；从各待检测域名中，滤除具有内容分发网络CDN特征及解析IP结果数据的缓存时间值TTL超过设定时间阈值的检测域名后，形成所述目标检测域名。3.根据权利要求1所述的方法，其特征在于，根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集，包括：根据每个时间单元内的解析IP结果数据，计算得到与每个时间单元分别对应的各静态统计指标集；根据所述与每个时间单元分别对应的各静态统计指标集对应的各静态统计指标的平均值及预设公式，计算得到与每个时间单元分别对应的各动态统计指标集。4.根据权利要求3所述的方法，其特征在于，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，包括：从各静态统计指标集或者各动态统计指标集中，分别获取与当前处理统计指标对应的多个指标值；根据公式：计算得到所述当前处理统计指标，在当前目标时间单元下的归一化指标值Xnorm；其中，X为当前目标时间单元对应的指标值，Xmax为获取的全部指标值中的最大值，Xmin为获取的全部指标值中的最小值。5.根据权利要求3所述的方法，其特征在于，静态统计指标包括：最大请求长度、累积不同解析IP数量、累积不同网段数量、累积不同AS码数量、AS分值和解析IP分布；动态统计指标包括：解析IP集合变化、网段的变化、AS码的变化和单次响应解析IP最大数量的变化。6.根据权利要求5所述的方法，其特征在于，确定目标静态统计指标集不满足正常域名检测条件，包括：将不满足解析IP分布值为0且累积不同AS码数量小于或等于3的静态统计指标集，确定为不满足正常域名检测条件的目标静态统计指标集。7.根据权利要求5所述的方法，其特征在于，根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值，包括：根据与每个目标时间单元内对应的归一化静态统计指标集与预设静态统计指标权重参数集获取拟合静态值；根据与每个目标时间单元内对应的归一化动态统计指标集与预设动态统计指标权重参数集获取拟合动态值。8.一种Fast-Flux僵尸网络检测装置，其特征在于，包括：解析IP结果获取模块，用于获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据；统计指标集获取模块，用于将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；归一化统计指标集获取模块，用于在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集；拟合值计算模块，用于根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值；各识别结果获取模块，用于将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果；目标识别结果获取模块，用于根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果；僵尸网络确定模块，用于在确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。9.一种计算机设备，其特征在于，所述计算机设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如权利要求1-7中任一所述的Fast-Flux僵尸网络检测方法。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现如权利要求1-7中任一所述的Fast-Flux僵尸网络检测方法。
说明书desc
技术领域本发明实施例涉及计算机技术，尤其涉及一种Fast-Flux僵尸网络检测方法、装置、设备及存储介质。背景技术僵尸网络是感染僵尸程序病毒的多个互联网主机所构成的网络，控制者和被感染的主机之间通常形成一对多的控制网络，严重危害网络安全，因此，对僵尸网络的检测一直是热点问题。在正常的DNS服务器中，用户对同一个域名做DNS查询，在较长的一段时间内，无论查询多少次返回的结果基本上是不会改变的。而Fast-flux技术是指不断改变域名和IP地址映射关系的一种技术，也就是说在短时间内查询使用Fast-flux技术部署的域名，会得到不同的结果，因此，Fast-flux技术是僵尸网络的一大利器。现有技术中对Fast-flux僵尸网络检测取决于对DNS查询结果的多次分析，需要通过算法评分机制来评估DNS记录，分析每个DNS查询返回的IP情况，A类IP地址，NS资源数等相关信息来检测。发明人在实现本发明的过程中，发现现有技术存在如下缺陷：多次分析DNS查询结果，工作量巨大并且准确率不高。发明内容本发明实施例提供了一种Fast-Flux僵尸网络检测方法、装置、设备及存储介质，以提高分析DNS流量数据的工作效率，并降低误报率，提高检测结果的准确性。第一方面，本发明实施例提供了一种Fast-Flux僵尸网络检测方法，该方法包括：获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据；将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集；根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值；将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果；根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果；在确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。第二方面，本发明实施例还提供了一种Fast-Flux僵尸网络检测装置，该装置包括：解析IP结果获取模块，用于获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据；统计指标集获取模块，用于将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；归一化统计指标集获取模块，用于在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集；拟合值计算模块，用于根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值；各识别结果获取模块，用于将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果；目标识别结果获取模块，用于根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果；僵尸网络确定模块，用于在确定目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。第三方面，本发明实施例还提供了一种计算机设备，该计算机设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如本发明任意实施例所述的Fast-Flux僵尸网络检测方法。第四方面，本发明实施例还提供了一种计算机可读存储介质，其上存储有计算机程序，其中，该程序被处理器执行时实现如本发明任意实施例所述的Fast-Flux僵尸网络检测方法。本发明实施例通过获取目标检测域名，每隔监控时长，获取匹配的解析IP结果数据；将监控时长划分为多个时间单元，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算归一化静态统计指标集和归一化动态统计指标集；进而计算对应的拟合静态值和拟合动态值，并分别输入至预先训练的支持向量机SVM模型中，监控时长内确定目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定僵尸网络的技术手段，解决现有技术中多次分析DNS查询结果导致工作量巨大并且准确率不高的问题，实现提高分析DNS流量数据的工作效率，并降低误报率，提高检测结果的准确性的效果。附图说明图1A为本发明实施例一提供了一种Fast-Flux僵尸网络检测方法的流程图；图1B为本发明实施例一提供了一种Fast-Flux僵尸网络检测方法的具体应用场景流程图；图2为本发明实施例二提供了一种Fast-Flux僵尸网络检测装置的结构示意图；图3为本发明实施例三提供了一种计算机设备的结构示意图。具体实施方式下面结合附图和实施例对本发明作进一步的详细说明。可以理解的是，此处所描述的具体实施例仅仅用于解释本发明，而非对本发明的限定。另外还需要说明的是，为了便于描述，附图中仅示出了与本发明相关的部分而非全部结构。实施例一图1A为本发明实施例一提供的一种Fast-Flux僵尸网络检测方法的流程图，本实施例可适用于对僵尸网络检测的情况，该方法可以由Fast-Flux僵尸网络检测装置来执行，该装置可以通过软件和/或硬件的方式实现，并一般可以集成在服务器中。参考图1，该方法具体包括如下步骤：S110、获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据。其中，目标检测域名可以是指需要通过检测判断是否正常的域名。监控时长可以是指对与目标检测域名匹配的DNS流量的监控时长，例如，可以设置为4小时。在本实施例中，可以获取目标检测域名，并监控DNS流量数据，从DNS流量数据中在监控时长内获取与目标检测域名匹配的解析IP结果数据。在本发明的一个可选实施例中，获取目标检测域名，可以包括：从所述DNS流量中获取多个响应数据包，并对所有响应数据包进行解析，获取多个待检测域名；从各待检测域名中，滤除具有内容分发网络CDN特征及解析IP结果数据的缓存时间值TTL超过设定时间阈值的检测域名后，形成所述目标检测域名。其中，待检测域名可以是指从所有响应数据包中解析得到的全部域名，待检测域名可以是客户端IP向DNS服务器请求解析的域名。CDN特征的检测域名可以包括两种情况：一种是主域名中含有“cdn”字样的域名，另一种是由两个域名通过“.”组合而成的域名。设定时间阈值可以是指解析IP结果数据的TTL值的下限值。可选的，监控过程中，可以从DNS流量数据中获取多个响应数据包，进而对所有响应数据包进行解析获得多个待检测域名；进一步的，从各待检测域名中，滤除具有CDN特征及解析IP结果数据的TTL超过设定时间阈值的检测域名后，可以将各待检测域名中剩余的检测域名确定为目标检测域名。具有CDN特征检测域名可能被认为恶意域名，另外，由于fast-flux僵尸网络里面用到的域名往往TTL的值都很小，当解析IP结果数据的TTL值超过1800秒时，对应的检测域名很大概率也是正常域名，因此可以将其滤除。需要说明，目标检测域名可以是待检测域名的子集，目标检测域名的数量可以是一个或者多个，本发明实施例对此并不进行限定。S120、将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集。其中，时间单元可以是指对预设监控时长的划分，例如，4小时的监控时长可以以1小时为单元划分为4个时间单元。目标时间单元可以是指从多个时间单元中选定的某个时间单元，例如，监控时长为4小时的4个时间单元内的第1个时间单元、第2个时间单元、第3个时间单元或者第4个时间单元。静态统计指标集可以用于表示每个目标时间单元内的解析IP的特征，例如，解析IP的数量和分布等。其中，静态统计指标可以包括：最大请求长度、累积不同解析IP数量、累积不同网段数量、累积不同AS码数量、AS分值和解析IP分布。具体的，最大请求长度表示每个时间单元内，与目标检测域名匹配的单个响应数据包中返回解析IP的最大数量。累积不同解析IP数量表示每个时间单元内，目标检测域名在同一DNS服务器下得到的所有不同解析IP的数量，值越大表示该域名对应的解析IP越多。累积不同网段数量值越大表示返回的解析IP分布越分散，可以考虑三类IP地址，以首字节范围划分：A类：1-127，首字节不同，即为一个不同网段；B类：128-191，首字节+第二字节不同，即为一个不同网段；C类：192-223，首字节+第二字节+第三字节不同，即为一个不同网段。累积不同AS码数量表示每个时间单元内，目标检测域名在同一DNS服务器下所得的解析IP对应多少不同的AS码，值越大代表返回的解析IP分布越分散。AS分值表示nip与nas综合后的分值，fas＝/nip。解析IP分布：解析IP地址转化为32位整数，记为x_i，计算公式可以为：dip＝1/p*median；deta_x＝{x_i-x_i-1}，i＝2...n，{x_i}中x_i＞＝x_i-1，p为32位解析IP的平均值。动态统计指标集可以用于表示每个目标时间单元内的解析IP结果数据的变化情况，例如，在第一个时间单元内nip值相对于全部时间单元nip的平均值的变化情况。其中，动态统计指标可以包括：解析IP集合变化、网段的变化、AS码的变化和单次响应解析IP最大数量的变化。具体的，解析IP集合变化：cip＝nip/c_nip-1，其中，c_nip表示在监控时长内全部时间单元nip的平均值。网段的变化：cnet＝nnet/c_nnet-1，其中，c_nnet表示在监控时长内全部时间单元nnet的平均值。AS码的变化：cas＝nas/c_nas-1，其中，c_nas表示在监控时长内全部时间单元nas的平均值。单次响应解析IP最大数量的变化：cal＝mal/c_mal-1，其中，c_mal表示在监控时长内全部时间单元mal的平均值。可选的，可以将设定的监控时长以单元划分，从而根据每个时间单元内获取的解析IP结果数据，统计计算得到与当前处理的目标检测域名匹配的，在每个目标时间单元内的全部静态统计指标，确定为静态统计指标集；同理可以获取与该目标检测域名匹配的全部动态统计指标，确定为动态统计指标集。需要说明，在每个时间单元内，同一域名对某一DNS服务器发起的请求数量不能低于10次。另外，由于要检测请求域名得到的解析IP的变化情况，因此，监控时长内划分的时间单元至少要有两个及两个以上。在本发明的一个可选实施例中，根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集，可以包括：根据每个时间单元内的解析IP结果数据，计算得到与每个时间单元分别对应的各静态统计指标集；根据所述与每个时间单元分别对应的各静态统计指标集对应的各静态统计指标的平均值及预设公式，计算得到与每个时间单元分别对应的各动态统计指标集。其中，预设公式可以是指计算动态统计指标的公式，例如，cip＝nip/c_nip-1。可选的，根据每个时间单元内获取的解析IP结果数据，统计得到与每个时间单元分别对应的各静态统计指标集；并根据监控时长内全部时间单元对应的各静态统计指标的指标值，计算得到监控时长内全部时间单元各静态统计指标的指标值对应的平均值；进一步比较各指标值及与各指标值匹配的平均值，根据预设公式获取各动态统计指标集。示例性的，监控时长设为4小时，以1小时为单元将监控时长划分为4个时间单元，统计得到4个时间单元分别对应的各静态统计指标集。以nip为例，可以计算4小时内nip指标对应的平均值c_nip，进一步的，根据cip＝nip/c_nip-1将4个nip分别代入，可以计算出每个时间单元内的cip，即4个cip值。同理可以根据其他静态统计指标nnet、nas和mal，分别计算出动态统计指标cnet、cas和cal。可以理解，在监控时长内，可以获取4个静态统计指标集与4个动态统计指标集。S130、在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集。其中，目标静态统计指标集可以是指从每个时间单元对应的各静态统计指标集中选定的某个或者某些静态统计指标集。正常域名检测条件可以是指用于判断目标检测域名是否正常的各静态统计指标集中的某个或者某些静态统计指标值是否满足预设范围。例如，将不满足解析IP分布值为0且累积不同AS码数量小于或等于3的静态统计指标集，确定为不满足正常域名检测条件的目标静态统计指标集，这样设置的好处在于可以降低误报率使检测结果更准确。相应的，若满足解析IP分布值为0且累积不同AS码数量小于或等于3的条件，可以将对应的目标检测域名确定为正常域名，不再执行后续检测操作。归一化静态统计指标集可以是指对各静态统计指标集归一化处理的结果集合。归一化动态统计指标集可以是指对各动态统计指标集归一化处理的结果集合。具体的，可以判断目标静态统计指标集是否满足正常域名检测条件，在确定目标静态统计指标集满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集。在本发明的一个可选实施例中，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，可以包括：从各静态统计指标集或者各动态统计指标集中，分别获取与当前处理统计指标对应的多个指标值；根据公式：计算得到所述当前处理统计指标，在当前目标时间单元下的归一化指标值Xnorm；其中，X为当前目标时间单元对应的指标值，Xmax为获取的全部指标值中的最大值，Xmin为获取的全部指标值中的最小值。可选的，可以从各静态统计指标集或者各动态统计指标集中，获取与当前处理统计指标对应的多个指标值；进而可以根据公式计算得到与各指标值对应的归一化指标值，归一化指标值处于0-1范围内。示例性的，在4小时的监控时长内，根据4个时间单元分别获得4个静态统计指标集，每个静态统计指标集包含6个静态统计指标，因此，每个静态统计指标对应4个指标值。具体的，针对某一个静态统计指标，从其对应的4个指标值中确定出最大值与最小值，根据公式：计算出4个指标值分别对应的归一化指标值，同理，可以计算其余5个静态统计指标的指标值对应的归一化值。S140、根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值。其中，拟合静态值可以是对每个时间单元对应的归一化静态统计指标集包含的多个指标值进行加权求和的值。拟合动态值可以是对每个时间单元对应的归一化动态统计指标集包含的多个指标值进行加权求和的值。具体的，可以以与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集包含的指标值为依据，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值。在本发明的一个可选实施例中，根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值，可以包括：根据与每个目标时间单元内对应的归一化静态统计指标集与预设静态统计指标权重参数集获取拟合静态值；根据与每个目标时间单元内对应的归一化动态统计指标集与预设动态统计指标权重参数集获取拟合动态值。其中，预设静态统计指标权重参数集可以是预先设定的反应静态统计指标集中各静态统计指标重要程度的系数值的集合。预设动态统计指标权重参数集可以是预先设定的反应动态统计指标集中各动态统计指标重要程度的系数值的集合。具体的，可以为每个目标时间单元内的归一化静态统计指标集或者归一化动态统计指标集添加匹配的预设静态统计指标权重参数集或者预设动态统计指标权重参数集，获取对应的拟合静态值或者拟合动态值。例如，可以根据Ystat＝wip*nip+wnet*nnet+was*nas+wal*mal+wf*fas+wd*dip获取每个目标时间单元内的拟合静态值，其中，nip、nnet、nas、mal、fas和dip为一个归一化静态统计指标集，wip、wnet、was、wal、wf和wd为对应的一个预设静态统计指标权重参数集。可以根据Ydong＝wip'*cip+wnet'*cnet+was'*cas+wal'*cal获取每个目标时间单元内的拟合动态值，其中，cip、cnet、cas和cal为一个归一化动态态统计指标集，wip'、wnet'、was'和wal'为对应的一个预设动态统计指标权重参数集。S150、将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果。其中，SVM模型可以通过已知僵尸网络的拟合静态值与拟合动态值经过至少一轮训练获得。识别结果可以是指SVM模型根据输入的拟合静态值和拟合动态值判断目标检测域名是否异常的结果。在本实施例中，可以将每个时间单元下的拟合静态值与拟合动态值分别输入至预先训练的SVM模型中，进而SVM模型可以针对每个时间单元下的拟合静态值与拟合动态值各输出一条识别结果。S160、根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果。其中，识别结果数目比例可以是指监控时长内获取的，当前处理的目标检测域名为异常的全部识别结果的数量，在监控时长内获取的全部识别结果的数量中所占比例。目标识别结果可以是指综合监控时长内获取的全部识别结果，判断当前处理的目标检测域名在监控时长内是否异常的结果。预设比例阈值可以是指各识别结果中当前处理的目标检测域名为异常域名的识别结果数目比例的下限值。具体的，可以根据监控时长内获取的全部识别结果中，识别结果为异常的数量占比，综合获取监控时长内当前处理的目标检测域名是否异常的识别结果。在监控时长内全部时间单元对应输出的全部识别结果中，若对当前处理的目标检测域名的识别结果为异常的数量，超过预设比例阈值，SVM模型可以输出监控时间内当前处理的目标检测域名的识别结果为异常。相应的，在监控时长内全部时间单元输出的全部识别结果中，若对当前处理的目标检测域名的识别结果为异常的数量，未超过预设异常比例阈值，SVM模型可以输出监控时间内当前处理的目标检测域名的识别结果为正常。这样设置的好处在于，结合多个特征、多个时间单元对同一域名的检测结果，通过预设比例阈值进一步确定识别结果，可以更好的降低恶意域名的误报率。示例性的，将4对拟合静态值与拟合动态值输入SVM模型得到4对“0”或者“1”的识别结果，那么如果“1”出现3次，也就是75％被SVM模型判断为“1”，则可以输出当前处理的目标检测域名在监控时长内的识别结果是异常。如果“1”出现1次，也就是25％被SVM模型判断为“1”，则可以输出该目标检测域名在监控时长内的识别结果是正常。S170、在确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。可选的，在监控时长内确定当前处理的目标检测域名为异常域名时，可以从DNS流量数据中查看访问该目标检测域名的全部IP地址，从而确定出与该目标检测域名匹配的僵尸网络。本实施例的技术方案，通过获取目标检测域名，每隔监控时长，获取匹配的解析IP结果数据；将监控时长划分为多个时间单元，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算归一化静态统计指标集和归一化动态统计指标集；进而计算对应的拟合静态值和拟合动态值，并分别输入至预先训练的支持向量机SVM模型中，确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定僵尸网络的技术手段，解决现有技术中多次分析DNS查询结果导致工作量巨大并且准确率不高的问题，实现提高分析DNS流量数据的工作效率，并降低误报率，提高检测结果的准确性的效果。示例性的，图1B为本发明实施例一提供的一种Fast-Flux僵尸网络检测方法的具体应用场景流程图。从原始DNS流量数据中，获取待检测域名，过滤具有CDN特征的域名，确定目标检测域名，从DNS流量数据中获取与目标检测域名相关的解析IP数据结构并按小时进行划分，按照特征工程的静态统计指标和动态统计指标对解析IP结果数据进行统计计算获取相应指标值，在指标值满足正常域名检测条件时，将当前处理的目标检测域名确定为正常域名；不满足正常域名检测条件的目标检测域名，将其匹配的各统计指标值经过归一化和拟合等操作输入至SVM分类模型，识别出异常域名，从而根据访问异常检测域名的IP地址确定出僵尸网络。实施例二图2为本发明实施例二提供的一种Fast-Flux僵尸网络检测装置的结构示意图。该装置可以包括：解析IP结果获取模块210、统计指标集获取模块220、归一化统计指标集获取模块230、拟合值计算模块240、各识别结果获取模块250、目标识别结果获取模块260和僵尸网络确定模块270。其中：解析IP结果获取模块210，用于获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据；统计指标集获取模块220，用于将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；归一化统计指标集获取模块230，用于在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集；拟合值计算模块240，用于根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值；各识别结果获取模块250，用于将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果；目标识别结果获取模块260，用于根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果；僵尸网络确定模块270，用于在确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。本实施例的技术方案，通过获取目标检测域名，每隔监控时长，获取匹配的解析IP结果数据；将监控时长划分为多个时间单元，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算归一化静态统计指标集和归一化动态统计指标集；进而计算对应的拟合静态值和拟合动态值，并分别输入至预先训练的支持向量机SVM模型中，确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定僵尸网络的技术手段，解决现有技术中多次分析DNS查询结果导致工作量巨大并且准确率不高的问题，实现提高分析DNS流量数据的工作效率，并降低误报率，提高检测结果的准确性的效果。上述装置中，可选的是，解析IP结果获取模块210，可以具体用于：从所述DNS流量中获取多个响应数据包，并对所有响应数据包进行解析，获取多个待检测域名；从各待检测域名中，滤除具有内容分发网络CDN特征及解析IP结果数据的缓存时间值TTL超过设定时间阈值的检测域名后，形成所述目标检测域名。上述装置中，可选的是，统计指标集获取模块220，可以具体用于：根据每个时间单元内的解析IP结果数据，计算得到与每个时间单元分别对应的各静态统计指标集；根据所述与每个时间单元分别对应的各静态统计指标集对应的各静态统计指标的平均值及预设公式，计算得到与每个时间单元分别对应的各动态统计指标集。上述装置中，可选的是，归一化统计指标集获取模块230，可以具体用于：从各静态统计指标集或者各动态统计指标集中，分别获取与当前处理统计指标对应的多个指标值；根据公式：计算得到所述当前处理统计指标，在当前目标时间单元下的归一化指标值Xnorm；其中，X为当前目标时间单元对应的指标值，Xmax为获取的全部指标值中的最大值，Xmin为获取的全部指标值中的最小值。上述装置中，可选的是，静态统计指标包括：最大请求长度、累积不同解析IP数量、累积不同网段数量、累积不同AS码数量、AS分值和解析IP分布；动态统计指标包括：解析IP集合变化、网段的变化、AS码的变化和单次响应解析IP最大数量的变化。上述装置中，可选的是，归一化统计指标集获取模块230，还可以具体用于：将不满足解析IP分布值为0且累积不同AS码数量小于或等于3的静态统计指标集，确定为不满足正常域名检测条件的目标静态统计指标集。上述装置中，可选的是，拟合值计算模块240，可以具体用于：根据与每个目标时间单元内对应的目标归一化静态统计指标集与预设静态统计指标权重参数集获取拟合静态值；根据与每个目标时间单元内对应的目标归一化动态统计指标集与预设动态统计指标权重参数集获取拟合动态值。本发明实施例所提供的一种Fast-Flux僵尸网络检测装置可执行本发明任意实施例所提供的Fast-Flux僵尸网络检测方法，具备执行方法相应的功能模块和有益效果。实施例三图3为本发明实施例三提供的一种计算机设备的结构示意图，如图3所示，该设备包括处理器310、存储装置320、输入装置330和输出装置340；设备中处理器310的数量可以是一个或多个，图3中以一个处理器310为例；设备中的处理器310、存储装置320、输入装置330和输出装置340可以通过总线或其他方式连接，图3中以通过总线连接为例。存储装置320作为一种计算机可读存储介质，可用于存储软件程序、计算机可执行程序以及模块，如本发明实施例中的Fast-Flux僵尸网络检测方法对应的程序指令/模块。处理器310通过运行存储在存储装置320中的软件程序、指令以及模块，从而执行设备的各种功能应用以及数据处理，即实现上述的Fast-Flux僵尸网络检测方法，该方法可以包括：获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据；将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集；根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值；将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果；根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果；在确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。存储装置320可主要包括存储程序区和存储数据区，其中，存储程序区可存储操作系统、至少一个功能所需的应用程序；存储数据区可存储根据终端的使用所创建的数据等。此外，存储装置320可以包括高速随机存取存储器，还可以包括非易失性存储器，例如至少一个磁盘存储器件、闪存器件、或其他非易失性固态存储器件。在一些实例中，存储装置320可进一步包括相对于处理器310远程设置的存储器，这些远程存储器可以通过网络连接至设备/终端/服务器。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。输入装置330可用于接收输入的数字或字符信息，以及产生与设备的用户设置以及功能控制有关的键信号输入。输出装置340可包括显示屏等显示设备。实施例四本发明实施例四还提供一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时用于执行一种Fast-Flux僵尸网络检测方法，该方法可以包括：获取目标检测域名，并每隔监控时长，从域名解析服务DNS流量数据中，获取与目标检测域名匹配的解析IP结果数据；将监控时长划分为多个时间单元，并根据每个时间单元内的解析IP结果数据，计算目标检测域名在每个目标时间单元内的静态统计指标集和动态统计指标集；在确定目标静态统计指标集不满足正常域名检测条件时，计算与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集；根据与每个目标时间单元内分别对应的归一化静态统计指标集和归一化动态统计指标集，计算与每个目标时间单元分别对应的拟合静态值和拟合动态值；将每个目标时间单元下的拟合静态值和拟合动态值，分别输入至预先训练的支持向量机SVM模型中，获取监控时长内每个目标时间单元下目标检测域名是否为异常域名的各识别结果；根据所述各识别结果中目标检测域名为异常域名的识别结果数目比例与预设比例阈值，获取监控时长内目标检测域名是否为异常域名的目标识别结果；在确定监控时长内目标检测域名为异常域名时，根据访问目标检测域名的IP地址，确定与目标检测域名匹配的僵尸网络。当然，本发明实施例所提供的一种计算机可读存储介质，其计算机程序不限于如上所述的方法操作，还可以执行本发明任意实施例所提供的Fast-Flux僵尸网络检测方法中的相关操作。通过以上关于实施方式的描述，所属领域的技术人员可以清楚地了解到，本发明可借助软件及必需的通用硬件来实现，当然也可以通过硬件实现，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在计算机可读存储介质中，如计算机的软盘、只读存储器、随机存取存储器、闪存、硬盘或光盘等，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述的方法。值得注意的是，上述Fast-Flux僵尸网络检测装置的实施例中，所包括的各个单元和模块只是按照功能逻辑进行划分的，但并不局限于上述的划分，只要能够实现相应的功能即可；另外，各功能单元的具体名称也只是为了便于相互区分，并不用于限制本发明的保护范围。注意，上述仅为本发明的较佳实施例及所运用技术原理。本领域技术人员会理解，本发明不限于这里所述的特定实施例，对本领域技术人员来说能够进行各种明显的变化、重新调整和替代而不会脱离本发明的保护范围。因此，虽然通过以上实施例对本发明进行了较为详细的说明，但是本发明不仅仅限于以上实施例，在不脱离本发明构思的情况下，还可以包括更多其他等效实施例，而本发明的范围由所附的权利要求范围决定。
