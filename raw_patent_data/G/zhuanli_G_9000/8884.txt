标题title
综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法与系统
摘要abst
本发明提供一种综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法与系统，首先基于仿真系统设置扰动，获得系统受扰后各光伏电站出口的电压受扰轨迹。其次，综合电压跌落深度分群以及电压波动的相似性距离分区，分析上述2种分群结果的交集，根据交集数获得光伏场群的分群结果；最后基于最终分群结果，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数。本发明提出综合电压跌落深度与电压波动相似性的光伏场站动态分群方法，与现有仅基于LVRT进行光伏场站动态分群方法相比，进一步考虑电压波动相似性的分群，可显著提高光伏场群的动态等值精度。
权利要求书clms
1.一种综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其特征在于，包括以下步骤：步骤1、基于仿真系统设置的扰动，获取受扰动后的各光伏场站出口的电压受扰轨迹；步骤2、计算受扰期间光伏场站端口的电压跌落深度，并依据电压跌落深度是否进入低电压穿越对光伏场站进行分群；步骤3、根据故障清除后各光伏场站端口的电压轨迹，计算电压波动的相似性距离，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群；步骤4、结合步骤2的分群结果以及步骤3的分群结果，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果；步骤5、基于步骤4的最终分群结果，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数。2.根据权利要求1所述的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其特征在于，所述步骤1中，所述光伏场站仿真系统分为外部系统和内部系统，外部系统即为被等值系统；扰动设置在内部系统，受扰后各光伏场站出口的电压受扰轨迹以Ui表示，即第i个光伏场站出口电压，1≤t≤K，K为仿真时长内的总点数；Ui由受扰期间的光伏场站出口电压Ui.dip以及故障清除后的光伏场站出口电压两部分构成，1≤t1≤K1，1≤t2≤K2，K＝K1+K2，K1和K2分别为受扰期间内的总点数和故障清除后的总点数。3.根据权利要求1所述的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其特征在于，所述步骤2中，依据电压跌落深度，将进入低电压穿越的光伏场站分在一群，未进入低电压穿越的光伏场站则分在另外一群。4.根据权利要求3所述的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其特征在于，所述步骤2中，依据电压跌落深度对光伏场站进行分群，包括以下步骤：设故障前光伏场站i的稳态电压为Ui.0，则故障期间光伏场站i的电压跌落深度为Ui.0-Ui.dip；设光伏电源进入LVRT的电压跌落门槛值为Uin，则：若Ui0-Ui.dip＜Uin时，光伏场站i进入LVRT若Ui0-Ui.dip＞Uin时，光伏场站i未进入LVRT；将进入LVRT的光伏场站分在群G11，其余分在另外一群G12。5.根据权利要求1所述的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其特征在于，所述根据电压波动的相似性距离并采用类平均法对光伏场站进行分群，其中采用以下方式计算两个光伏场站光伏场站i和光伏场站j的电压波动相似性距离：根据电压波动相似性距离，采用类平均法进行分群：其中，D表示等值光伏场站PVeq.m和PVeq.n间电压波动性相似性距离的均值，M和N分别表示等值光伏场站PVeq.m和PVeq.n内光伏电源的个数。6.根据权利要求1所述的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其特征在于，所述步骤4中，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果，包括：根据电压跌落深度的分群结果的G11和G12，以及电压波动相似性距离的c个分群结果，从电压跌落深度的分群中的G11开始，将该群内的光伏机组逐个与电压波动相似性距离分群中的第1～c群内的所有光伏机组进行比较，将电压跌落深度分群与电压波动相似性分群中相同的机组分在新的一群，将该电压跌落深度分群与电压波动相似性分群中不同的机组则各自分在新的一群中；再从电压跌落深度分群中的G12开始，重复光伏机组的逐个步骤过程，得到最终的分群结果。7.根据权利要求1所述的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其特征在于，所述步骤5中，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数，包括：以下述方式确定等值电源参数值xeq：其中，xi为第i个光伏场站内光伏电源的参数，r为同群内光伏场站的数目，Si为第i个光伏场站的容量，Seq为群内所有光伏电源的容量之和。8.一种综合电压跌落深度与电压波动相似性的光伏场群动态等值建模系统，其特征在于，包括以下步骤：用于基于仿真系统设置的扰动，获取受扰动后的各光伏场站出口的电压受扰轨迹的扰动仿真模块；用于计算受扰期间光伏场站端口的电压跌落深度，并依据电压跌落深度是否进入低电压穿越对光伏场站进行分群的第一分群模块；用于根据故障清除后各光伏场站端口的电压轨迹，计算电压波动的相似性距离，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群的第二分群模块；用于结合第一分群模块的分群结果以及第二分群模块的分群结果，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果的第三分群模块；以及用于前述最终分群结果，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数的等值获取模块。9.一种用于综合电压跌落深度与电压波动相似性的光伏场群动态等值建模的计算机系统，其特征在于，包括：一个或多个处理器；存储器，存储可被操作的指令，所述指令在通过所述一个或多个处理器执行时使得所述一个或多个处理器执行操作，所述操作包括执行上述权利要求1-7中任意一项所述方法的过程。
说明书desc
技术领域本发明涉及智能电网技术领域，尤其是光伏场群的动态等值建模，具体而言涉及一种综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法与系统。背景技术随着风电、光伏发电并网的趋势，建立与实际运行特性相同的风电场等值模型、正确评估其对电力系统的影响日益重要，已成为目前需要解决的关键问题。目前新能源场站等值建模常采用多机等值方法，常用的方法包括基于指标的分群和基于动态相似度的分群两类，然而上述分群方法都基于新能源本体的动态特性进行的等值建模，未计及系统侧对新能源动态的影响。现有对新能源场站进行等值建模时，一般忽略系统侧动态对各场站间动态影响的差异；但当各新能源场站的电气距离较远，系统对各场站的影响则差别较大时，如果忽略的话将与实际的运行特性相差较大。现有技术：专利文献1：CN106451418A光伏电站的在线分群等值建模方法专利文献2：CN104008267A一种基于特征距离的光伏电站分群方法发明内容鉴于现有技术存在的缺陷与不足，本发明的目的在于综合电压跌落深度与电压波动相似性，提出一种新型光伏场群等值建模分群方法，将系统侧对光伏场站的影响考虑到电压波动特性中，可有效提高光伏场群的动态等值建模的精度。为实现上述目的，本发明第一方面提出一种综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，包括以下步骤：步骤1、基于仿真系统设置的扰动，获取受扰动后的各光伏场站出口的电压受扰轨迹；步骤2、计算受扰期间光伏场站端口的电压跌落深度，并依据电压跌落深度是否进入低电压穿越对光伏场站进行分群；步骤3、根据故障清除后各光伏场站端口的电压轨迹，计算电压波动的相似性距离，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群；步骤4、结合步骤2的分群结果以及步骤3的分群结果，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果；步骤5、基于步骤4的最终分群结果，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数。其中，在步骤2中，依据电压跌落深度，将进入低电压穿越的光伏场站分在一群，未进入低电压穿越的光伏场站则分在另外一群。作为可先的方式和，依据电压跌落深度对光伏场站进行分群，包括以下步骤：设故障前光伏场站i的稳态电压为Ui.0，则故障期间光伏场站i的电压跌落深度为Ui.0-Ui.dip；设光伏电源进入LVRT的电压跌落门槛值为Uin，则：若Ui0-Ui.dip＜Uin时，光伏场站i进入LVRT；若Ui0-Ui.dip＞Uin时，光伏场站i未进入LVRT；将进入LVRT的光伏场站分在群G11，其余分在另外一群G12。其中，所述步骤3中，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群，其中采用以下方式计算两个光伏场站光伏场站i和光伏场站j的电压波动相似性距离：根据电压波动相似性距离，采用类平均法进行分群：其中，D表示等值光伏场站PVeq.m和PVeq.n间电压波动性相似性距离的均值，M和N分别表示等值光伏场站PVeq.m和PVeq.n内光伏电源的个数。其中，所述步骤4中，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果，包括：根据电压跌落深度的分群结果的G11和G12，以及电压波动相似性距离的c个分群结果，从电压跌落深度的分群中的G11开始，将该群内的光伏机组逐个与电压波动相似性距离分群中的第1～c群内的所有光伏机组进行比较，将电压跌落深度分群与电压波动相似性分群中相同的机组分在新的一群，将该电压跌落深度分群与电压波动相似性分群中不同的机组则各自分在新的一群中；再从电压跌落深度分群中的G12开始，重复光伏机组的逐个步骤过程，得到最终的分群结果。根据本发明目的的第二方面还提出一种综合电压跌落深度与电压波动相似性的光伏场群动态等值建模系统，包括以下步骤：用于基于仿真系统设置的扰动，获取受扰动后的各光伏场站出口的电压受扰轨迹的扰动仿真模块；用于计算受扰期间光伏场站端口的电压跌落深度，并依据电压跌落深度是否进入低电压穿越对光伏场站进行分群的第一分群模块；用于根据故障清除后各光伏场站端口的电压轨迹，计算电压波动的相似性距离，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群的第二分群模块；用于结合第一分群模块的分群结果以及第二分群模块的分群结果，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果的第三分群模块；以及用于前述最终分群结果，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数的等值获取模块。根据本发明目的的第二方面还提出一种用于综合电压跌落深度与电压波动相似性的光伏场群动态等值建模的计算机系统，包括：一个或多个处理器；存储器，存储可被操作的指令，所述指令在通过所述一个或多个处理器执行时使得所述一个或多个处理器执行操作，所述操作包括执行上述方法的过程。与现有技术相比，本发明的有益效果在于：本发明提出的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，除了从影响光伏电源自身动态特性的因素出发，提出基于LVRT特性的光伏电站分群方法，还进一步从电网对光伏电源的影响出发，提出考虑光伏电站端口电压动态相似性的分群方法，综合二分群的结果进行融合，实现更加准确的分析和分群，从而在此基础上进行加权计算，获得最终的等值参数，有效提高光伏场群的动态等值模型的精度。附图说明图1是本发明的光伏场群动态等值建模方法的流程图；图2为本发明示例性实施例的10机39节点的系统图；图3为本发明示例性实施例的光伏电源母线电压图；图4为本发明示例性实施例的光伏电站分群聚类图；图5为等值前后边界节点27的电压误差示意图；图5为等值前后边界线路17-27有功功率的误差示意图；图5为等值前后边界线路17-27无功功率的误差示意图。图6是本发明示例性实施例的光伏场群动态等值建模系统的示意图。具体实施方式为了更了解本发明的技术内容，特举具体实施例并配合所附图式说明如下。实施例1结合图1所示示例的综合电压跌落深度与电压波动相似性的光伏场群动态等值建模方法，其实现过程包括以下步骤：步骤1、基于仿真系统设置的扰动，获取受扰动后的各光伏场站出口的电压受扰轨迹；步骤2、计算受扰期间光伏场站端口的电压跌落深度，并依据电压跌落深度是否进入低电压穿越对光伏场站进行分群；步骤3、根据故障清除后各光伏场站端口的电压轨迹，计算电压波动的相似性距离，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群；步骤4、结合步骤2的分群结果以及步骤3的分群结果，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果；步骤5、基于步骤4的最终分群结果，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数。其中，步骤1中，光伏场站仿真系统分为外部系统和内部系统，外部系统即为被等值系统；扰动设置在内部系统，受扰后各光伏场站出口的电压受扰轨迹以Ui表示，即第i个光伏场站出口电压，1≤t≤K，K为仿真时长内的总点数；Ui由受扰期间的光伏场站出口电压Ui，dip以及故障清除后的光伏场站出口电压两部分构成，1≤t1≤K1，1≤t2≤K2，K＝K1+K2，K1和K2分别为受扰期间内的总点数和故障清除后的总点数。其中，步骤2中，依据电压跌落深度，将进入低电压穿越的光伏场站分在一群，未进入低电压穿越的光伏场站则分在另外一群。作为可选的方式，依据电压跌落深度对光伏场站进行分群，包括以下步骤：设故障前光伏场站i的稳态电压为Ui.0，则故障期间光伏场站i的电压跌落深度为Ui.0-Ui.dip；设光伏电源进入LVRT的电压跌落门槛值为Uin，则：若Ui0-Ui.dip＜Uin时，光伏场站i进入LVRT；若Ui0-Ui.dip＞Uin时，光伏场站i未进入LVRT；将进入LVRT的光伏场站分在群G11，其余分在另外一群G12。其中，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群，其中采用以下方式计算两个光伏场站光伏场站i和光伏场站j的电压波动相似性距离：根据电压波动相似性距离，采用类平均法进行分群：其中，D表示等值光伏场站PVeq.m和PVeq.n间电压波动性相似性距离的均值，M和N分别表示等值光伏场站PVeq.m和PVeq.n内光伏电源的个数。在步骤4中，取2种分群结果的交集并根据交集获得光伏场站的最终分群结果，包括：根据电压跌落深度的分群结果的G11和G12，以及电压波动相似性距离的c个分群结果，从电压跌落深度的分群中的G11开始，将该群内的光伏机组逐个与电压波动相似性距离分群中的第1～c群内的所有光伏机组进行比较，将电压跌落深度分群与电压波动相似性分群中相同的机组分在新的一群，将该电压跌落深度分群与电压波动相似性分群中不同的机组则各自分在新的一群中；再从电压跌落深度分群中的G12开始，重复光伏机组的逐个步骤过程，得到最终的分群结果。其中，在步骤5中，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数，包括：以下述方式确定等值电源参数值xeq：其中，xi为第i个光伏场站内光伏电源的参数，r为同群内光伏场站的数目，Si为第i个光伏场站的容量，Seq为群内所有光伏电源的容量之和。下面我们将结合图2-图4所示对前述方法的示例性实施过程进行更加具体的说明。步骤1：基于仿真系统设置扰动，获得系统受扰后各光伏场站出口的电压受扰轨迹以图2所示的10机39节点的系统为例，在原系统中的负荷节点{4,7,8,12,21,24}增设光伏电站，为保持原节点的功率平衡，在相应节点上增设了功率相同的恒阻抗负荷；将同步发电机节点{33,35}改为相同有功出力的光伏电源，通过增设电容保证原节点的无功出力不变，将同步机节点{31,32}的PSS模块去除，其余保持不变。仿真平台可采用电力系统分析综合程序，光伏发电系统进入低压穿越的阈值取0.9pu。结合图2，其中虚线以上为内部系统，虚线以下为外部系统。扰动设置为t＝0.1s，节点39发生三相短路故障，故障接地电抗为0.02pu，故障持续0.2s后切除，仿真时长为5s，系统受扰后各光伏电源节点的母线电压见图3。步骤2：计算受扰期间光伏场站端口的电压跌落深度，将进入低电压穿越的光伏场站分在一群，其余分在另外一群设故障前节点i的稳态电压为Ui.0，则故障期间光伏场站i的电压跌落深度为Ui.0-Ui.dip。设光伏电源进入LVRT的电压跌落门槛值为Uin。判断如果Ui0-Ui.dip＜Uin时，光伏场站i进入LVRT；反之，当Ui0-Ui.dip＞Uin时，光伏场站i未进入LVRT。将进入LVRT的光伏场站分在一群，其余分在另外一群。从图3所示的各光伏电站在受扰期间的端口电压跌落程度可知：光伏电站{7,8}的电压跌落值大于0.1pu，进入低电压穿越状态，其余电站故障期间电压跌落都小于0.1pu，未进入低电压穿越状态。所以在当前设置的扰动下，根据电压跌落深度进行首次分群，可将光伏电站分为两群，分别为：群1{7,8}，群2{4,12,21,24,33,35}。步骤3：根据故障清除后各光伏场站端口的电压轨迹，计算电压波动的相似性距离，根据电压波动的相似性距离采用类平均法对光伏场站进行分群根据下式计算光伏场站i和场站j的电压波动相似性距离，根据上式的相似性距离，采用类平均法进行分群：其中，D表示等值光伏场站PVeq.m和PVeq.n间电压波动性相似性距离的均值，M和N分别表示等值光伏场站PVeq.m和PVeq.n内光伏电源的个数。首先计算分布式电站间的电压波动相似性距离，再根据相似性距离进行分群，分群聚类结果见图4。由图4可以得到，根据电压波动相似性的分群结果分别为：群1{4,7,8,12}，群2{21,24,33,35}。步骤4：分析上述2种分群结果的交集，根据该交集获得光伏场站的分群结果根据电压跌落深度的分群结果有2个，分别为群1{7,8}，群2{4,12,21,24,33,35}；根据电压波动相似性的分群结果有2个，分别为群1{4,7,8,12}，群2{21,24,33,35}。2种分群结果中的群1都有机组{7,8}，因此最终分群结果为{7,8}；{4,12}以及{21,24,33,35}。步骤5：将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数其中，等值场站中光伏电源的参数值xeq的计算如下：其中，xi为第i个光伏场站内光伏电源的参数，r为同群内光伏场站的数目，Si为第i个光伏场站的容量，Seq为群内所有光伏电源的容量之和。为比较通过本发明的方法获取的等值模型和仅根据电压跌落深度的分群方法获得的等值模型，表1给出了等值前后各边界节点和边界线路的均方误差见表1。图5中给出了边界节点27的电压波形，图5和中分别给出了边界线路17-27的有功功率和无功功率波形。其中，等值模型误差定义为：E2＝|y-y′|式中，K表示仿真时长内的总点数，y和y′分别表示等值前和等值后系统的受扰轨迹，E1和E2分别表示均方根误差和绝对值误差。表1两种等值方法下的均方根误差E1轨迹LVRT本发明方法U2/pu0.000090.00003U9/pu0.000150.00004U27/pu0.000100.00003P3-2/pu0.005610.00164P8-9/pu0.006090.00151P7-27/pu0.004650.00089Q3-2/pu0.003430.00075Q8-9/pu0.004570.00094Q7-27/pu0.003280.00042从表1和图5、和可以看出：本通过发明的等值建模方法的误差远小于仅根据LVRT的分群结果，因此进行光伏场群等值建模时，综合计及电压跌落深度与电压波动相似性的光伏场群动态等值建模，可提高模型的等值精度。实施例2相应地，结合图6，本发明还提出一种综合电压跌落深度与电压波动相似性的光伏场群动态等值建模系统，包括：用于基于仿真系统设置的扰动，获取受扰动后的各光伏场站出口的电压受扰轨迹的扰动仿真模块；用于计算受扰期间光伏场站端口的电压跌落深度，并依据电压跌落深度是否进入低电压穿越对光伏场站进行分群的第一分群模块；用于根据故障清除后各光伏场站端口的电压轨迹，计算电压波动的相似性距离，根据电压波动的相似性距离并采用类平均法对光伏场站进行分群的第二分群模块；用于结合第一分群模块的分群结果以及第二分群模块的分群结果，取2种分群结果的交集，根据交集获得光伏场站的最终分群结果的第三分群模块；以及用于前述最终分群结果，将分在同群内的光伏场站，采用加权平均法计算各等值光伏电源的参数的等值获取模块。本实施例的光伏场群动态等值建模系统的各个模块的具体实现方案参见上述方法的具体实现过程。实施例3相应地，本发明还提出一种用于综合电压跌落深度与电压波动相似性的光伏场群动态等值建模的计算机系统，包括：一个或多个处理器；存储器，存储可被操作的指令，所述指令在通过所述一个或多个处理器执行时使得所述一个或多个处理器执行操作，所述操作包括执行上述方法的过程。本领域内的技术人员应明白，在另外的实施例中，本发明的前述方法的实施还可以采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。虽然本发明已以较佳实施例揭露如上，然其并非用以限定本发明。本发明所属技术领域中具有通常知识者，在不脱离本发明的精神和范围内，当可作各种的更动与润饰。因此，本发明的保护范围当视权利要求书所界定者为准。
