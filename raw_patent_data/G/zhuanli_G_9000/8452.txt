标题title
一种基于改进粒子群优化算法的三维轨迹规划方法
摘要abst
本发明提供了一种基于改进粒子群优化算法的三维轨迹规划方法，粒子在航迹空间对最优三维轨迹进行搜索的过程中，在不同的粒子种群迭代进化阶段设置不同的惯性权重：在设定进化前期阶段使用最大惯性权重使全局收敛，在设定进化后期使用最小惯性权重使局部收敛；基于种群多样性在粒子的运动过程增加扰动变异操作；基于约束条件对不可行粒子的选择：比较不可行粒子的约束违反函数，保留约束违反函数小的不可行粒子。本发明根据群体进化情况对惯性权重进行自适应调整，在粒子的运动过程增加扰动变异操作，充分利用了所有粒子，使不可行解同样能够为群体整体寻优提供帮助，保证了轨迹规划的可靠性和效率。
权利要求书clms
1.一种基于改进粒子群优化算法的三维轨迹规划方法，其特征在于，粒子在航迹空间对最优三维轨迹进行搜索的过程中，执行如下步骤：在不同的粒子种群迭代进化阶段设置不同的惯性权重：在设定进化前期阶段使用最大惯性权重使全局收敛，在设定进化后期使用最小惯性权重使局部收敛；基于种群多样性在粒子的运动过程增加扰动变异操作：包括对粒子进行位置扰动、全局极值和个体极值的变异更新以及对粒子进行发散持续代数设置；基于约束条件对不可行粒子的选择：比较不可行粒子的约束违反函数，保留约束违反函数小的不可行粒子，并继续参与粒子种群迭代进化，而未胜出的粒子由于违反约束条件直接舍弃。2.根据权利要求1所述的基于改进粒子群优化算法的三维轨迹规划方法，其特征在于，航迹空间设置多优化参数，即多维度航迹空间，对不同维度采用不同的惯性权重：设置惯性权重按如下规律变化：式中：w0为惯性权重最小值，w1为惯性权重最大值，0≤Kw,j≤1，Kwj表示粒子i在第j维空间中与群体最优位置的接近程度，为迭代次数，为最大迭代次数。3.根据权利要求1所述的基于改进粒子群优化算法的三维轨迹规划方法，其特征在于，当粒子群体在设定进化前期阶段聚集在最优航迹空间位置时，对设定数量的粒子进行位置扰动；当粒子群优化算法的全局极值在设定的过去进化阶段内已经停滞，通过插值算法计算新的全局极值，判断其是否优于计算前的全局极值，若是则替换为新的全局极值；当粒子群优化算法的个体极值在设定的过去进化阶段内已经停滞，对粒子i进行反向变异计算新的个体极值，判断其是否优于变异前的个体极值，若是则替换为新的个体极值；当粒子群体在设定进化前期阶段的种群多样性趋于收敛时，选取设定数量的粒子，并设置所选取粒子的发散持续代数，使其在航迹空间中的搜索运动区域发散。4.根据权利要求1所述的基于改进粒子群优化算法的三维轨迹规划方法，其特征在于，不可行粒子为不满足终端高度约束、终端落脚约束、动压范围约束以及过载范围约束条件的粒子，定义约束违反函数：式中：Mv为群体中不可行粒子总数；uV,i表示背离约束值的程度评价；式中，Ψ1,Ψ2,Ψ3,Ψ4分别表示上述四种约束偏离程度归一化值。比较多个不可行粒子，保留fV,i小的不可行粒子。
说明书desc
技术领域本发明涉及无人机航迹规划技术领域，具体涉及一种基于改进粒子群优化算法的三维轨迹规划方法。背景技术自无人机诞生以来，它们主要用于军事作战侦查等方面。作为情报和信息的高科技武器，无人驾驶飞机在侦察，监视，通信和远程打击方面表现出卓越的性能。正是因为无人机各方面的卓越性能，所以无人机执行任务的能力对世界发展进步尤为重要。相对于有人驾驶飞机而言，无人机存在不畏死亡、生存能力强、机动性能好、研制和使用成本低、经济性好等优势。无人飞行器成为重要的战争和国土安全空中平台。假如有人驾驶飞机要突袭敌人由防空导弹组成的严密防空系统，有人飞机中驾驶员突袭无异于自杀，无人机最大的好处就是在执行任务时，不存在驾驶员伤亡的问题，这也是世界各国格外关注和重视无人机的原因。无人机可在核、生、化或其他危及生命的特殊条件下执行侦察、监视、目标定位、跟踪任务；可在突防中担任电子诱饵，充当开路先锋；反辐射无人机做自杀性攻击；可以摧毁雷达；拦截战术导弹和巡航导弹等。近年来，得益于各种新兴技术的发展和微型电子技术的发展，无人机开始变得结构简单、重量轻、尺寸小、成本低，已经成为了社会发展不可或缺的军事装备和民用辅助配备。无人机执行任务被称为任务规划，就是完成事先设定任务，随着研究的深度增加，无人机完成任务的危险度也逐渐增加，对无人机的要求也不断提高。从无人机任务规划层面来说，无人机的大量出现导致其与有人机之间的空域矛盾越来越严重，可供无人机进行规划和飞行的空域要求越来越严格，无人机感知和规避技术的发展成为解决这一问题的关键，且传统的粒子群算法虽然是一种基于群体智能的全局优化算法，具有易于实现和调制、精度高、稳定性好的特点，但到目前为止，基本PSO算法容易产生早熟收敛、局部寻优能力较差等，PSO算法陷入局部最小，主要归咎于种群在搜索空间中多样性的丢失。且现有的任务规划方法效率低，适应性差；任务自主执行能力不足，主要需要人的参与很多，规划的通用性和可靠性差，规划出的航迹并不是最优的。因此，如何提供一种轨迹规划效果优且效率高的基于改进粒子群优化算法的三维轨迹规划方法是本领域技术人员亟需解决的问题。发明内容有鉴于此，本发明提供了一种基于改进粒子群优化算法的三维轨迹规划方法，从PSO粒子运动机理出发，根据群体进化情况对惯性权重进行自适应调整，在粒子的运动过程增加扰动变异操作，借助粒子与可行域间的关系，充分利用了所有粒子，使不可行解同样能够为群体整体寻优提供帮助，保证了轨迹规划的可靠性和效率。为了实现上述目的，本发明采用如下技术方案：一种基于改进粒子群优化算法的三维轨迹规划方法，粒子在航迹空间对最优三维轨迹进行搜索的过程中，执行如下步骤：在不同的粒子种群迭代进化阶段设置不同的惯性权重：在设定进化前期阶段使用最大惯性权重使全局收敛，在设定进化后期使用最小惯性权重使局部收敛；基于种群多样性在粒子的运动过程增加扰动变异操作：包括对粒子进行位置扰动、全局极值和个体极值的变异更新以及对粒子进行发散持续代数设置；基于约束条件对不可行粒子的选择：比较不可行粒子的约束违反函数，保留约束违反函数小的不可行粒子，并继续参与粒子种群迭代进化。优选的，航迹空间设置多优化参数，即多维度航迹空间，对不同维度采用不同的惯性权重：设置惯性权重按如下规律变化：式中：w0为惯性权重最小值，w1为惯性权重最大值，0≤Kw,j≤1，Kwj表示粒子i在第j维空间中与群体最优位置的接近程度，l为迭代次数，lmax为最大迭代次数。优选的，当粒子群体在设定进化前期阶段聚集在最优航迹空间位置时，对设定数量的粒子进行位置扰动；当粒子群优化算法的全局极值在设定的过去进化阶段内已经停滞，通过插值算法计算新的全局极值，判断其是否优于计算前的全局极值，若是则替换为新的全局极值；当粒子群优化算法的个体极值在设定的过去进化阶段内已经停滞，对粒子i进行反向变异计算新的个体极值，判断其是否优于变异前的个体极值，若是则替换为新的个体极值；当粒子群体在设定进化前期阶段的种群多样性趋于收敛时，选取设定数量的粒子，并设置所选取粒子的发散持续代数，使其在航迹空间中的搜索运动区域发散。优选的，不可行粒子为不满足终端高度约束、终端落脚约束、动压范围约束以及过载范围约束条件的粒子，定义约束违反函数：式中：Mv为群体中不可行粒子总数；uV,i表示背离约束值的程度评价；式中，Ψ1,Ψ2,Ψ3,Ψ4分别表示上述四种约束偏离程度归一化值；比较多个不可行粒子，保留fV,i小的不可行粒子。经由上述的技术方案可知，与现有技术相比，本发明的有益效果包括：本发明从PSO粒子运动机理出发，根据群体进化情况对惯性权重进行自适应调整，在粒子的运动过程增加扰动变异操作，借助粒子与可行域间的关系，充分利用了所有粒子，使不可行解同样能够为群体整体寻优提供帮助，保证了轨迹规划的可靠性和效率。本发明方法相较传统PSO算法规划的三维轨迹更加平滑，运行时间更短，改进PSO算法的航迹规划对于飞行器规划效果更优。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图获得其他的附图；图1为本发明实施例提供的基于改进粒子群优化算法的三维轨迹规划方法中单个粒子运动机理示意图；图2是本发明实施例提供的基于改进粒子群优化算法的三维轨迹规划方法中对群体的扰动操作原理图；图3是本发明实施例提供的基于改进粒子群优化算法的三维轨迹规划方法中约束处理机制示意图；图4是本发明实施例提供的三维仿真场景示意图；图5是本发明实施例提供的基于改进PSO算法对无人飞行器轨迹进行优化的最优轨迹二维显示图；图6是本发明实施例提供的基于改进PSO算法对无人飞行器轨迹进行优化的最优轨迹三维显示图；图7是本发明实施例提供的基本PSO算法收敛时间与惯性权重的关系示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本实施例设计了一种基于改进PSO算法的自主性强，通用性高的可飞行航迹规划方法，首先对基本PSO算法流程进行介绍如下：PSO算法使用粒子在搜索空间中对最优解进行搜索，每个粒子都代表优化问题的一个潜在解，其对应的性能指标称为“适应度”。假设有Mpso个粒子在空间中对Dpso个优化参数进行搜索，则第i个粒子在Dpso维搜索空间中的位置矢量和速度矢量分别为：同时，记第i个粒子从算法开始至今搜索到的最佳位置为Pi，Pi对应的适应度为pbest；相应的，记所有粒子搜索到的最佳位置为Pg，Pg对应的适应度为gbest。在基本PSO算法中，整个群体按照如下方式进化：式中：上标“l”表示当前迭代次数；0＜w＜1称为惯性权重；c1和c2均称为学习因子，一般在0～4间取值；r1和r2是0～1间的随机数。各变量的意义如下：1.w表示粒子位置受速度的影响，使粒子保持与其它同伴不同的运动特性；2.c1决定了粒子受个体经验影响的程度，引导粒子向Pi靠近；3.c2决定了粒子受群体经验影响的程度，引导粒子向Pg靠近。在实际问题中，各优化参数均有各自的取值范围。因此，在应用PSO算法时，各个粒子的位置在搜索空间中应被限制在一定范围内，即xLj≤xi,j≤xUj 式中：xUj和xLj分别为第j维空间的上/下届。相应的，粒子在第j维空间中的速度也被限制在一定范围内，以防粒子在下一次迭代中跳出空间边界：xLj-xUj≤vi,j≤xUj-xLj本文定义在第l代时种群多样性为：式中：为所有粒子在第维j中的平均位置。的计算考虑到了不同优化参数在取值范围上的差异，设最大迭代次数为lmax，则当l＞lmax时PSO算法终止。基本PSO算法的收敛性如下：定义φ1＝c1r1+c2r2，φ2＝c1r1pi,j+c2r2pg,j，由PSO算法进化公式可得：将粒子的移动视为一个连续过程，则上式是一个不含速度项的经典非齐次二阶微分方程。上式说明PSO算法实际上并不需要速度的概念，因此可以避免设置速度边界，使种群进化过程更为简明。假设pi,j和pg,j为常值，分别记为p和g。用符号表示某变量的期望，设则根据式可得：当PSO算法收敛时，有因此故PSO算法某粒子在某维度中将收敛于如下位置：设式表示的二阶系统的阻尼为ξn，频率为ωn，则因此，当φ1-w-1＞0时，粒子在第j维空间中将渐进收敛于该结论是在pi,j和pg,j为常值的假设下获得的，但实际上pi,j和pg,j是动态变化的，故粒子的实际运动是由多个二阶微分方程共同描述的。当惯性权重为1时，粒子的位置将按正弦规律变化，粒子在进化过程中将不断从一个正弦波跳到另一个正弦波上；受随机数影响，实际上粒子在空间中将绕作螺旋运动。由式知，算法收敛的条件是φ1-w-1＞0。设算法在相对误差小于2％时收敛，令收敛时间为ts，则1.当0＜ξn＜1时，式是一个欠阻尼系统，收敛时间为：2.由于ξn中的φ1项具有随机性，故ξn＝1几乎不会发生，因此可认为不会出现临界阻尼系统。3.当ξn＞1时，式是一个过阻尼系统，收敛时间为：在PSO算法中，通常取c1＝c2＝2.0，因此取φ1＝2，将式分别代入式、并用惯性权重取代频率和阻尼，得到粒子收敛于所需时间与惯性权重间的关系如图7所示。从图7中可以看出，一般情况下粒子绕的运动基本上处于欠阻尼状态，且收敛时间随权重的减小而减小。当进入过阻尼状态时，收敛时间随权重的减小而增大。本文设置0.2≤w≤0.9，即粒子始终按欠阻尼状态运动。需要注意，在PSO算法中，粒子的运动是以迭代次数来描述的，并非时间；因此，图7中的结果并非实际收敛时间，仅为粒子收敛过程分析提供参考。阻尼对惯性权重的导数为：可以看出，阻尼随惯性权重的增大而减小。因此，当惯性权重很大时，粒子将以较大的震荡幅度向方向收敛，收敛时间自然会增加，这与上文中得出的结论一致。设整个搜索空间中由Pi和Pg构成的收敛中心为：随着群体进化的进行，将有Pi→Pg，在PSO算法的基本原理的基础上，本发明实施例提出了基于收敛性分析的改进PSO算法，PSO算法性能主要体现在收敛精度和收敛速度上。对于收敛精度，和诸多智能算法一样，基本PSO算法很容易陷入局部最优，即Pg仅在某非最优位置附近徘徊，导致获得的最终结果并非全局最优。设理论最优位置为则收敛精度为因此，为提高精度必须使尽可能地趋近于为提高收敛速度，一是要保证粒子快速“飞向”收敛中心二是要尽早发现粒子在航迹空间对最优三维轨迹进行搜索的过程中，执行如下步骤：在不同的粒子种群迭代进化阶段设置不同的惯性权重：在设定进化前期阶段使用最大惯性权重使全局收敛，在设定进化后期使用最小惯性权重使局部收敛；基于种群多样性在粒子的运动过程增加扰动变异操作：包括对粒子进行位置扰动、全局极值和个体极值的变异更新以及对粒子进行发散持续代数设置；基于约束条件对不可行粒子的选择：比较不可行粒子的约束违反函数，保留约束违反函数小的不可行粒子。在一个实施例中，航迹空间设置多优化参数，即多维度航迹空间，对不同维度采用不同的惯性权重：设置惯性权重按如下规律变化：式中：w0为惯性权重最小值，w1为惯性权重最大值，0≤Kw,j≤1，Kwj表示粒子i在第j维空间中与群体最优位置的接近程度，l为迭代次数，lmax为最大迭代次数。本实施例中，一旦所有粒子聚集于整个群体的搜索将逐渐停滞；因此，应避免在某非最优位置附近徘徊，而是要持续对空间进行搜索，增大发现的机会，减小误差εE。由PSO算法收敛性分析可知，较大的惯性权重将产生较小的阻尼，增加粒子震荡幅度，提高粒子发现的概率；与此同时，发现越早，则算法结束就越早，故大权重有利于减少群体进化代数，提高收敛速度。但从个体收敛速度的角度考虑，宜采用较小的惯性权重。因此，惯性权重对收敛精度和收敛速度的作用是相互矛盾的。采用随迭代次数动态变化的惯性权重较常值惯性权重而言，能够显著提高PSO算法性能。然而，诸多方法如线性权重、指数权重、随机权重、多项式权重、混沌权重等，并不能准确地控制全局收敛和局部收敛间的关系。同时，惯性权重不能兼顾全局收敛和局部收敛，因此单纯依靠惯性权重无法获得最佳搜索效果。如图1所示，根据群体进化情况对惯性权重进行自适应调整。主要原理为：在进化前期使用大惯性权重促进全局收敛，而在化后期使用小惯性权重促进局部收敛。另外，由于本实施例所研究的优化问题涉及较多优化参数，故搜索空间维数较高，需要针对不同维度采用不同的惯性权重。惯性权重规律变化公式中：显然0≤Kwj≤1。Kwj表示了粒子i在第j维空间中与群体最优位置的接近程度。Kwj越小，说明粒子在该维度的运动范围过小，应增大权重加剧该粒子的运动震荡，从而使其更全面地在该维度进行搜索。在一个实施例中，基于种群多样性的扰动变异操作包括如下具体内容：将式改写成如下形式：式中：r3和r4是0～1间的随机数。此时，二阶系统的收敛条件变为φ1-1-w+r3＞0。与式相比，式相当于在原二阶系统的频率和阻尼中分别增加了一个随机数，使粒子的运动过程受到随机扰动，从而更充分地在空间中进行搜索；同时能够提高种群多样性，有利于发现更好的Pi和Pg。上述方法实际上是让粒子在运动的过程中发现更好的位置，但这种方式在实际应用中效果并不明显。由于Pg是粒子的主要运动方向，粒子主要聚集在Pg周围；若随机初始化产生的Pg距较远，则群体将很难发现因此，为了使粒子充分搜索空间，必须改变粒子的运动规律。记在进化至第l代时，Pg的值为Pi的值为Pil。分别计算：式中：lg、li、lδ为计算Δg、Δi、Δδ所考虑的代数。1、如图2所示，当粒子群体在设定进化前期阶段聚集在最优航迹空间位置时，对设定数量的粒子进行位置扰动。选取前20％的粒子对其位置进行扰动：式中：r5是随机整数，等于2或-2。上式表明粒子变异幅度是随迭代次数的增加而逐渐降低的，这有利于在进化后期促进收敛于2、当粒子群优化算法的全局极值在设定的过去进化阶段内已经停滞，通过插值算法计算新的全局极值，判断其是否优于计算前的全局极值，若是则替换为新的全局极值。当Δg＜εg时，表明全局极值在过去lg代中已经停滞。此时，根据Pg的变化历史，通过插值求得新的全局极值式中：为f3三次样条插值函数。若优于Pg，则令否则保持Pg。3、当粒子群优化算法的个体极值在设定的过去进化阶段内已经停滞，对粒子i进行反向变异计算新的个体极值，判断其是否优于变异前的个体极值，若是则替换为新的个体极值。当Δi＜εi时，表明个体极值在过去li代中已经停滞。此时，对第i个粒子进行反向变异：若优于Pi，则用替换Pi；否则保持Pi。4、当粒子群体在设定进化前期阶段的种群多样性趋于收敛时，选取设定数量的粒子，并设置所选取粒子的发散持续代数，使其在航迹空间中的搜索运动区域发散。当Δδ＜εΔ且l＜lmax/2时，表明群体多样性并未得到改善。此时权重修改或位置扰动已无法有效提升算法搜索效率，需大幅改变粒子运动状态。选取前10％的粒子，通过调整r1和r2使φ1-w-1＜0，即令一部分粒子的运动趋于发散，发散持续代数按如下方式计算：式中：ND为被选取的粒子数量，lD,k为被选取的粒子中第k个粒子的发散持续代数，lD为最大发散持续代数。本实施例取lg＝lmax/4、li＝lmax/5、lδ＝lmax/4、lD＝lmax/6。在一个实施例中，记满足所有约束条件的粒子为可行粒子，反之为不可行粒子。通过简单的比较便可对约束条件进行处理。当比较两个粒子时：1.若二者均可行，则比较适应值，适应值小者胜出；2.若一个可行而另一个不可行，则可行粒子胜出；3.若二者均不可行：a)定义约束违反函数：式中：Mv为群体中不可行粒子总数；；uV,i表示背离约束值的程度评价；式中，Ψ1,Ψ2,Ψ3,Ψ4分别表示上述四种约束偏离程度归一化值；b)fV,i更小者胜出。上述比较原则用于在群体中选择Pg。如图3所示，当比较3个不可行粒子时，虽然粒子①违反的约束更多，但它离可行域更近，因此被认为更优。胜出的粒子继续参与优化迭代，而未胜出的粒子由于违反约束条件直接舍弃。不同于常用的罚函数法，本实施例提出的这种比较方法借助粒子与可行域间的关系，充分利用了所有粒子，使不可行解同样能够为群体整体寻优提供帮助，在解决约束条件的同时保证了算法效率。下面给出本发明方法在无人机航空轨迹分析的过程及结果：算法环境为：Windows764bit；Matlab R2017a；处理器IntelCorei5-5200U；主频2.2GHz；电脑内存8GB。为了验证算法求解在三维空间的有效性，区别于二维航迹规划，主要是考虑了飞行高度对于轨迹的影响建立了环境模型，随后进行了仿真，分别设计了两个地形图进行仿真验证。初始条件如下所示：1、本文设定的飞行器飞行能力约束参数如下：最大航程为40km；最小航路段距离为0.8km；最大航路点个数为20；最大的转弯角度为90°；飞行器平均飞行速度为200m/s；两条航路之间所允许的最短间隔为0.5km；飞行器起飞准备时间为10s；飞行器最小离地高度为200m。2、优化变量设置：取lmax＝20，c1＝c2＝2.0；式中，取w0＝0.1，w1＝0.9。三维仿真场景立体空间的长为30km，宽为30km，高为1km，由6个高低不同山峰和5个防御圈组成，将在此空间中进行飞行器的航路规划，如图4所示。采用基于改进PSO算法对无人飞行器轨迹进行优化，结果如图5-6所示，表一为基本PSO算法与本发明改进PSO算法对无人飞行器轨迹优化的评价标准仿真数据。表1三维环境仿真数据仿真结果分析如下：图5到图6分别为从起始点0到目标点30km的航迹规划效果图，本算例选用两种算法进行对比分析，分别为基本PSO算法与改进PSO算法进行对比分析。从图5到图6的航迹规划效果对比，可以明显看出规划后的航迹较为平滑，而且从，表一为基本PSO算法与本发明改进PSO算法对无人飞行器轨迹优化的评价标准仿真数据。表1可以看出本文改进PSO算法的航迹最短为43.94m，航迹平均值为44.10m。所以综合两种算法的对比，本发明改进PSO算法的航迹规划对于飞行器规划效果更优。以上对本发明所提供的基于改进粒子群优化算法的三维轨迹规划方法进行了详细介绍，本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处，综上，本说明书内容不应理解为对本发明的限制。对所公开的实施例的上述说明，使本领域专业技术人员能够实现或使用本发明。对这些实施例的多种修改对本领域的专业技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所示的这些实施例，而是要符合与本文所公开的原理和新颖特点相一致的最宽的范围。
