标题title
一种基于SIFT的变形目标定位算法
摘要abst
本发明属于计算机技术领域，且公开了一种基于SIFT的变形目标定位算法，具体步骤如下：S1、对图像和模板建立若干层金字塔；S2、对顶层模板和顶层图像采用SIFT算法得到若干对匹配点，并根据最近距离和次近距离的比值筛选出一部分匹配点对；S3、设置离群点距离阈值，采用RANSAC算法从上一步筛选出的匹配点对中挑出离群点最少的三对匹配点，并保存相应的仿射变换矩阵。本发明通过公开一种基于SIFT的变形目标定位算法，本发明能快速地定位出变形目标具有较好的实时性。
权利要求书clms
1.一种基于SIFT的变形目标定位算法，其特征在于，具体步骤如下：S1、对图像和模板建立若干层金字塔；S2、对顶层模板和顶层图像采用SIFT算法得到若干对匹配点，并根据最近距离和次近距离的比值筛选出一部分匹配点对；S3、设置离群点距离阈值，采用RANSAC算法从上一步筛选出的匹配点对中挑出离群点最少的三对匹配点，并保存相应的仿射变换矩阵；S4、从上一步保存的仿射变换矩阵中解析出旋转角度θ，x方向缩放系数scalex，y方向缩放系数scaley，模板的坐标系原点在图像上的位置，即得顶层模板在顶层图像上的定位结果；S5、将顶层定位结果中的定位坐标乘以某个放大倍数投影到底层图像上，得到底层模板的坐标系原点在底层图像上的大致定位坐标，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来；S6、采用和顶层同样的方法得到底层模板在子图像上的定位结果，再将该定位结果中的定位坐标加上子图像左上角在底层图像上的坐标即得到最终的定位结果。2.根据权利要求1所述的一种基于SIFT的变形目标定位算法，其特征在于：S2步骤中对顶层模板和顶层图像采用SIFT算法，分别检测特征点，计算特征点描述，对模板每一个特征点描述，在图像所有特征点描述中找出与之最匹配的两个特征点描述，并计算最近距离和次近距离的比值，如果比值小于设定的阈值，则将该模板特征点和与之最匹配的图像特征点作为一个匹配对。3.根据权利要求1所述的一种基于SIFT的变形目标定位算法，其特征在于：S3步骤中对上一步得到的匹配点对，进行若干次迭代，每次迭代从匹配点对中随机抽取三对匹配点，将它们的坐标代入如下所示的方程组中，其中，xi,yi是模板特征点在模板坐标系下的坐标，ui,vi是相应的匹配点在图像上的坐标，解该方程组，将解向量重组成如下所示的仿射变换矩阵，对每一对匹配点，将模板特征点进行仿射变换，如下所示，计算点和模板特征点匹配点的欧式距离，若距离超过设定的阈值，则该匹配点为离群点，如此，算出该仿射变换对应的离群点个数，并保存最少离群点所对应的仿射变换矩阵。4.根据权利要求1所述的一种基于SIFT的变形目标定位算法，其特征在于：S4步骤中将式所示的仿射变换矩阵和式所示的仿射变换矩阵对比，可求出x0＝tx y0＝ty 以上就是顶层模板在顶层图像上的定位结果。5.根据权利要求1所述的一种基于SIFT的变形目标定位算法，其特征在于：S5步骤中假设金字塔层数为nlevel，将顶层定位结果中的坐标乘以2nlevel-1，得到底层模板的坐标系原点在底层图像上的大致定位坐标，即＝2nlevel-1×，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来。6.根据权利要求1所述的一种基于SIFT的变形目标定位算法，其特征在于：S6步骤中对底层模板和子图像采用步骤2到步骤4的方法，得到底层模板在子图像上的定位结果，再将定位结果中的定位坐标加上子图像左上角在底层图像上的坐标，即得最终的定位结果。
说明书desc
技术领域本发明属于计算机技术领域，具体是一种基于SIFT的变形目标定位算法。背景技术现有模板匹配技术主要分为基于像素灰度值的方法和基于特征的方法。基于像素灰度值的方法大致步骤为：先将模板进行缩放旋转得到一系列模板，然后将每一个模板在图像上滑动，计算每个位置处的指标，比如sumthe absolute grayvalue differences between template and image或者sum the squared grayvalue differences between template and image或者normalized cross-correlation，得到指标图像，选取适当的阈值对指标图像进行阈值化，在阈值化后的指标图像中选取极小值点或者极大值点，即得定位结果。但基于灰度值的方法往往对光照敏感，当改变光照时，定位效果不理想。基于特征的方法，比如边缘特征。经典的算法有chamfer matching。大致步骤为：对图像进行边缘检测，对图像的边缘图进行距离变换，得到距离图像D。对模板进行缩放旋转得到一系列模板，对每一个模板，进行边缘检测得到模板边缘图T，然后将T在D上滑动，在每个位置处按下式计算chamfer distance其中，为T中的边缘点，n为T中边缘点个数，为T的左上角在D中的位置。选出最小chamfer distance所对应的模板和位置即为定位结果。但是当目标被部分遮挡时，chamfer distance会变得比较大，此时可能定位失败。基于SIFT的定位方法也广受应用，大致步骤为：分别对模板和图像提取特征点，计算每个特征点的特征，对模板的每个特征点在图像中找到与之最相似的两个特征点，再根据最近距离和次近距离的比值筛选出一部分质量好的匹配点，再将这些匹配点代入方程组解出缩放系数，旋转角度和位置，即得定位结果。但这种方法很难保证筛选出的匹配点对是正确的匹配点对。发明内容为解决上述背景技术中提出的问题，本发明提供了一种基于SIFT的变形目标定位算法，以解决背景技术中存在的问题。为实现上述目的，本发明提供如下技术方案：一种基于SIFT的变形目标定位算法，具体步骤如下：S1、对图像和模板建立若干层金字塔；S2、对顶层模板和顶层图像采用SIFT算法得到若干对匹配点，并根据最近距离和次近距离的比值筛选出一部分匹配点对；S3、设置离群点距离阈值，采用RANSAC算法从上一步筛选出的匹配点对中挑出离群点最少的三对匹配点，并保存相应的仿射变换矩阵；S4、从上一步保存的仿射变换矩阵中解析出旋转角度θ，x方向缩放系数scalex，y方向缩放系数scaley，模板的坐标系原点在图像上的位置，即得顶层模板在顶层图像上的定位结果；S5、将顶层定位结果中的定位坐标乘以某个放大倍数投影到底层图像上，得到底层模板的坐标系原点在底层图像上的大致定位坐标，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来；S6、采用和顶层同样的方法得到底层模板在子图像上的定位结果，再将该定位结果中的定位坐标加上子图像左上角在底层图像上的坐标即得到最终的定位结果。上述技术方案中，优选的，S2步骤中对顶层模板和顶层图像采用SIFT算法，分别检测特征点，计算特征点描述，对模板每一个特征点描述，在图像所有特征点描述中找出与之最匹配的两个特征点描述，并计算最近距离和次近距离的比值，如果比值小于设定的阈值，则将该模板特征点和与之最匹配的图像特征点作为一个匹配对。上述技术方案中，优选的，S3步骤中对上一步得到的匹配点对，进行若干次迭代，每次迭代从匹配点对中随机抽取三对匹配点，将它们的坐标代入如下所示的方程组中，其中，xi,yi是模板特征点在模板坐标系下的坐标，ui,vi是相应的匹配点在图像上的坐标。解该方程组，将解向量重组成如下所示的仿射变换矩阵，对每一对匹配点，将模板特征点进行仿射变换，如下所示，计算点和模板特征点匹配点的欧式距离，若距离超过设定的阈值，则该匹配点为离群点。如此，算出该仿射变换对应的离群点个数，并保存最少离群点所对应的仿射变换矩阵。上述技术方案中，优选的，S4步骤中将式所示的仿射变换矩阵和式所示的仿射变换矩阵对比，可求出x0＝txy0＝ty 以上就是顶层模板在顶层图像上的定位结果。上述技术方案中，优选的，S5步骤中假设金字塔层数为nlevel，将顶层定位结果中的坐标乘以2nlevel-1，得到底层模板的坐标系原点在底层图像上的大致定位坐标，即＝2nlevel-1×，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来。上述技术方案中，优选的，S6步骤中对底层模板和子图像采用步骤2到步骤4的方法，得到底层模板在子图像上的定位结果，再将定位结果中的定位坐标加上子图像左上角在底层图像上的坐标，即得最终的定位结果。与现有技术相比，本发明的有益效果如下：1、本发明通过公开一种基于SIFT的变形目标定位算法。为减少计算量，对图像和模板建立若干层金字塔，对顶层模板和顶层图像采用SIFT算法得到若干对匹配点，先根据最近距离和次近距离的比值筛选出一部分匹配点对，再设置好离群点距离阈值，采用RANSAC算法从上一步筛选出的匹配点对中挑出离群点最少的三对匹配点，并保存相应的仿射变换矩阵，再从仿射变换矩阵中解析出旋转角度θ，x方向缩放系数scalex,y方向缩放系数scaley，模板的坐标系原点在图像上的位置，即得顶层模板在顶层图像上的定位结果。将顶层定位结果中的定位坐标乘以某个放大倍数投影到底层图像上，得到底层模板的坐标系原点在底层图像上的大致定位坐标，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来，再采用和顶层同样的方法得到底层模板在子图像上的定位结果，再将该定位结果中的定位坐标加上子图像左上角在底层图像上的坐标即得到最终的定位结果。本发明能快速地定位出变形目标具有较好的实时性。附图说明图1为本发明的方法流程图；图2为本发明金字塔结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一如图1所示，本发明包括以下步骤：步骤1：对图像和模板建立若干层金字塔。步骤2：对顶层模板和顶层图像采用SIFT算法得到若干对匹配点，并根据最近距离和次近距离的比值筛选出一部分匹配点对。步骤3：设置离群点距离阈值，采用RANSAC算法从上一步筛选出的匹配点对中挑出离群点最少的三对匹配点，并保存相应的仿射变换矩阵。步骤4：从上一步保存的仿射变换矩阵中解析出旋转角度θ，x方向缩放系数scalex，y方向缩放系数scaley，模板的坐标系原点在图像上的位置，即得顶层模板在顶层图像上的定位结果。步骤5：将顶层定位结果中的定位坐标乘以某个放大倍数投影到底层图像上，得到底层模板的坐标系原点在底层图像上的大致定位坐标，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来。步骤6：采用和顶层同样的方法得到底层模板在子图像上的定位结果，再将该定位结果中的定位坐标加上子图像左上角在底层图像上的坐标即得到最终的定位结果；需要说明的是，图1中椭圆部分表示数据，矩形部分表示操作。下面对各步骤进行具体说明。1.对图像和模板建立若干层金字塔机器视觉领域中，图像分辨率一般都比较大，如果直接在原图上使用SIFT算法，计算量大，耗时长，不能满足实时性要求。为减少计算量，对模板和图像分别建立若干层金字塔，具体层数取决于实际情况，有一点需要注意：在顶层模板和顶层图像上，目标要清晰可见。建立金字塔的方法如附图2所示。以第二层处的像素为例，它是由第一层，，，处的像素相加取平均所得，其它以此类推。2.对顶层模板和顶层图像采用SIFT算法得到若干对匹配点，并根据最近距离和次近距离的比值筛选出一部分匹配点对对顶层模板和顶层图像采用SIFT算法，分别检测特征点，计算特征点描述，对模板每一个特征点描述，在图像所有特征点描述中找出与之最匹配的两个特征点描述，并计算最近距离和次近距离的比值，如果比值小于设定的阈值，则将该模板特征点和与之最匹配的图像特征点作为一个匹配对。3.设置离群点距离阈值，采用RANSAC算法从上一步筛选出的匹配点对中挑出离群点最少的三对匹配点，并保存相应的仿射变换矩阵对上一步得到的匹配点对，进行若干次迭代，每次迭代从匹配点对中随机抽取三对匹配点，将它们的坐标代入如下所示的方程组中，其中，xi,yi是模板特征点在模板坐标系下的坐标，ui,vi是相应的匹配点在图像上的坐标。解该方程组，将解向量重组成如下所示的仿射变换矩阵，对每一对匹配点，将模板特征点进行仿射变换，如下所示，计算点和模板特征点匹配点的欧式距离，若距离超过设定的阈值，则该匹配点为离群点。如此，算出该仿射变换对应的离群点个数，并保存最少离群点所对应的仿射变换矩阵。4.从上一步保存的仿射变换矩阵中解析出旋转角度θ，x方向缩放系数scalex,y方向缩放系数scaley，模板的坐标系原点在图像上的位置，即得顶层模板在顶层图像上的定位结果将式所示的仿射变换矩阵和式所示的仿射变换矩阵对比，可求出x0＝tx y0＝ty以上就是顶层模板在顶层图像上的定位结果。5.将顶层定位结果中的定位坐标乘以某个放大倍数投影到底层图像上，得到底层模板的坐标系原点在底层图像上的大致定位坐标，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来。假设金字塔层数为nlevel，将顶层定位结果中的坐标乘以2nlevel-1，得到底层模板的坐标系原点在底层图像上的大致定位坐标，即＝2nlevel-1×，再根据顶层定位结果中的θ,scalex,scaley和底层模板的宽高在底层图像上画出一个旋转矩形，将包含该旋转矩形的子图像截取出来。6采用和顶层同样的方法得到底层模板在子图像上的定位结果，再将该定位结果中的定位坐标加上子图像左上角在底层图像上的坐标即得到最终的定位结果。对底层模板和子图像采用步骤2到步骤4的方法，得到底层模板在子图像上的定位结果，再将定位结果中的定位坐标加上子图像左上角在底层图像上的坐标，即得最终的定位结果。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。
