标题title
同向双轴结构下双轴间的运动关系标定方法
摘要abst
本发明公开了一种同向双轴结构下双轴间的运动关系标定方法，双轴一定行程下分步做同时同步运动，根据运动产生的数据生成关系表达式，具体包括以下步骤：第1步骤、将标定板安装到贴装头上，调整标定板位置到图像中心处，配置标定参数，初始化关系表达式；第2步骤、创建匹配模板；第3步骤、执行同步运动并拍照取图；第4步骤、计算出关系表达式；第5步骤、判断偏移表中的每个偏移值是否都满足指标。该标定方法具有减小双轴间平行度和直线度不好而带来的相机Y轴到贴装头Y轴运动转换时的偏差、提升贴装精度的优点。
权利要求书clms
1.一种同向双轴结构下双轴间的运动关系标定方法，其特征在于，双轴一定行程下分步做同时同步运动，根据运动产生的数据生成关系表达式，具体包括以下步骤：第1步骤、将标定板安装到贴装头上，调整标定板位置到图像中心处，配置标定参数，初始化关系表达式：将标定板吸附至贴装头上，调整标定板特征区域位置到图像中心处并调整贴装头高度直至相机成像清晰，配置标定参数并初始化关系表达式；第2步骤、创建匹配模板：采集标定板图像，并在标定板图像上绘制视觉特征区域以此创建匹配模板；第3步骤、执行同步运动并拍照取图：根据第1步骤配置的标定参数和初始化的关系表达式，双轴在一定行程内分步做同时同步运动，并在每步运动停留间隔期间相机拍照取图，得到标定板图像；第4步骤、计算出关系表达式：对第3步骤采集到的标定板图像进行视觉模板匹配，得到模板区域中心点坐标，计算每步中心点相较于起始位置取图时模板区域中心点的偏移值，最后根据每步偏移值生成关系表达式，即得到偏移表；第5步骤、判断偏移表中的每个偏移值是否都满足指标：当偏移表中的每个偏移值都满足指标，则标定完成；当偏移表中的任意一个偏移值不满足指标，则回到第3步骤再次进行后续步骤直到满足指标为止。2.根据权利要求1所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：在所述第1步骤中，相机安装在贴装头的上方，标定板吸附在贴装头的底部，贴装头的电机中心开设有便于相机拍摄到标定板的圆孔。3.根据权利要求1所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：在所述第1步骤中，所述标定参数包括贴装头Y轴同步运动起始位置坐标值、相机Y轴同步运动起始位置坐标值和运动步长，其中，运动步长是同步运动中每步运动的长度。4.根据权利要求1所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：在所述第1步骤中，所述关系表达式反映了双轴一定行程下分步做同时同步运动时，相机Y轴坐标值与贴装头相较于相机发生的位置偏移之间的关系。5.根据权利要求1所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：在所述第1步骤中，由于同步运动贴装头在X、Y两个方向产生偏移，因此初始化的两个表达式为：，，其中，表示同步运动相机Y轴坐标值为时贴装头在X轴产生的偏移值的表达式；表示同步运动相机Y轴坐标值为时贴装头在Y轴产生的偏移值的表达式。6.根据权利要求1所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：在所述第2步骤中，在同步运动初始位置采集一张标定板图像，在此标定板图像上绘制匹配模板区域并创建模板，记录同步运动起始位置模板中心。7.根据权利要求1所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：在所述第3步骤中，所述同步运动中的每步包括以下步骤：第3.1步骤、相机和贴装头沿各自的Y轴按照设定的运动步长同时同步的运动一个步长，记录相机Y轴起点坐标值和相机Y轴终点坐标值；第3.2步骤、贴装头所在轴进行偏移补偿运动：计算贴装头X轴偏移值和贴装头Y轴偏移值；第3.3步骤、拍照取图；第3.4步骤、循环上述第3.1步骤、第3.2步骤和第3.3步骤，直到完成所设置的运动总步数。8.根据权利要求6所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：在所述第4步骤中，遍历第3步骤同步运动中每步拍照取图的标定板图像，计算出关系表达式，遍历过程包括以下步骤：第4.1步骤、取第步的标定板图像进行视觉模板匹配，得到匹配中心点坐标，求得匹配中心点坐标相较于同步运动起始位置模板中心的图像参考系下X、Y轴偏移值；第4.2步骤、将图像参考系下X、Y轴偏移值转到机械轴参考系下X、Y轴的偏移值；第4.3步骤、由于当前的同步运动是在已有关系表达式补偿下进行的，因此需要把当前偏移值加上已有的偏移值作为最终贴装头偏移值；第4.4步骤、将最终贴装头偏移值的X、Y轴的值分别代入表达式并求解表达式。9.根据权利要求1所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：贴装时，根据关系表达式计算出运动偏移值，补偿到贴装头上，再进行贴装，以实现同向双轴结构下双轴间的运动关系的变换。10.根据权利要求9所述的同向双轴结构下双轴间的运动关系标定方法，其特征在于：所述同向双轴结构下双轴间的运动关系的变换，具体包括以下步骤：第步骤、输入相机Y轴运动的起点坐标值和相机Y轴运动的终点坐标值；第步骤、将第步骤记录的相机Y轴运动的起点坐标值和相机Y轴运动的终点坐标值分别带入X和Y轴的关系表达式，计算最终贴装头需要运动的值；第步骤、发送贴装头的运动值到下位机执行运动。
说明书desc
技术领域本发明涉及智能贴装的技术领域，尤其是一种同向双轴结构下双轴间的运动关系标定方法。背景技术现有的一种智能贴装设备中，在其相机和贴装头各自的Y轴不共轴线的机械结构下，贴装算法中的其中一个过程是将相机Y轴方向的运动转换到贴装头所在Y轴方向的运动，理想状态下“机械轴安装相机和贴装头Y轴线绝对平行、Y轴线为绝对直线”相机Y移动量就是贴装头移动量，但在平行度和直线度上实际无法达到理想状态，因此使用上述理想状态下的转换方式就会带来偏差，影响最终贴装精度，即因双轴间平行度和直线度不好，带来相机Y轴到贴装头Y轴运动转换时的偏差，导致最终贴装精度不高。发明内容本发明旨在至少解决现有技术中存在的技术问题之一。为此，本发明提出一种同向双轴结构下双轴间的运动关系标定方法，具有减小双轴间平行度和直线度不好而带来的相机Y轴到贴装头Y轴运动转换时的偏差、提升贴装精度的优点。根据本发明实施例的同向双轴结构下双轴间的运动关系标定方法，双轴一定行程下分步做同时同步运动，根据运动产生的数据生成关系表达式，具体包括以下步骤：第1步骤、将标定板安装到贴装头上，调整标定板位置到图像中心处，配置标定参数，初始化关系表达式：将标定板吸附至贴装头上，调整标定板特征区域位置到图像中心处并调整贴装头高度直至相机成像清晰，配置标定参数并初始化关系表达式；第2步骤、创建匹配模板：采集标定板图像，并在标定板图像上绘制视觉特征区域以此创建匹配模板；第3步骤、执行同步运动并拍照取图：根据第1步骤配置的标定参数和初始化的关系表达式，双轴在一定行程内分步做同时同步运动，并在每步运动停留间隔期间相机拍照取图，得到标定板图像；第4步骤、计算出关系表达式：对第3步骤采集到的标定板图像进行视觉模板匹配，得到模板区域中心点坐标，计算每步中心点相较于起始位置取图时模板区域中心点的偏移值，最后根据每步偏移值生成关系表达式，即得到偏移表；第5步骤、判断偏移表中的每个偏移值是否都满足指标：当偏移表中的每个偏移值都满足指标，则标定完成；当偏移表中的任意一个偏移值不满足指标，则回到第3步骤再次进行后续步骤直到满足指标为止。本发明的有益效果是，减小因双轴间平行度和直线度不好而带来的相机Y轴到贴装头Y轴运动转换时的偏差，提升贴装精度。根据本发明一个实施例，在所述第1步骤中，相机安装在贴装头的上方，标定板吸附在贴装头的底部，贴装头的电机中心开设有便于相机拍摄到标定板的圆孔。根据本发明一个实施例，在所述第1步骤中，所述标定参数包括贴装头Y轴同步运动起始位置坐标值、相机Y轴同步运动起始位置坐标值和运动步长，其中，运动步长是同步运动中每步运动的长度。根据本发明一个实施例，在所述第1步骤中，所述关系表达式反映了双轴一定行程下分步做同时同步运动时，相机Y轴坐标值与贴装头相较于相机发生的位置偏移之间的关系。根据本发明一个实施例，在所述第1步骤中，由于同步运动贴装头在X、Y两个方向产生偏移，因此初始化的两个表达式为：，，其中，表示同步运动相机Y轴坐标值为时贴装头在X轴产生的偏移值的表达式；表示同步运动相机Y轴坐标值为时贴装头在Y轴产生的偏移值的表达式。根据本发明一个实施例，在所述第2步骤中，在同步运动初始位置采集一张标定板图像，在此标定板图像上绘制匹配模板区域并创建模板，记录同步运动起始位置模板中心。根据本发明一个实施例，在所述第3步骤中，所述同步运动中的每步包括以下步骤：第3.1步骤、相机和贴装头沿各自的Y轴按照设定的运动步长同时同步的运动一个步长，记录相机Y轴起点坐标值和相机Y轴终点坐标值；第3.2步骤、贴装头所在轴进行偏移补偿运动：计算贴装头X轴偏移值和贴装头Y轴偏移值；第3.3步骤、拍照取图；第3.4步骤、循环上述第3.1步骤、第3.2步骤和第3.3步骤，直到完成所设置的运动总步数。根据本发明一个实施例，在所述第4步骤中，遍历第3步骤同步运动中每步拍照取图的标定板图像，计算出关系表达式，遍历过程包括以下步骤：第4.1步骤、取第步的标定板图像进行视觉模板匹配，得到匹配中心点坐标，求得匹配中心点坐标相较于同步运动起始位置模板中心的图像参考系下X、Y轴偏移值；第4.2步骤、将图像参考系下X、Y轴偏移值转到机械轴参考系下X、Y轴的偏移值；第4.3步骤、由于当前的同步运动是在已有关系表达式补偿下进行的，因此需要把当前偏移值加上已有的偏移值作为最终贴装头偏移值；第4.4步骤、将最终贴装头偏移值的X、Y轴的值分别代入表达式并求解表达式。根据本发明一个实施例，贴装时，根据关系表达式计算出运动偏移值，补偿到贴装头上，再进行贴装，以实现同向双轴结构下双轴间的运动关系的变换。根据本发明一个实施例，所述同向双轴结构下双轴间的运动关系的变换，具体包括以下步骤：第步骤、输入相机Y轴运动的起点坐标值和相机Y轴运动的终点坐标值；第步骤、将第步骤记录的相机Y轴运动的起点坐标值和相机Y轴运动的终点坐标值分别带入X和Y轴的关系表达式，计算最终贴装头需要运动的值；第步骤、发送贴装头的运动值到下位机执行运动。本发明的其他特征和优点将在随后的说明书中阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点在说明书、权利要求书以及附图中所特别指出的结构来实现和获得。为使本发明的上述目的、特征和优点能更明显易懂，下文特举较佳实施例，并配合所附附图，作详细说明如下。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请中记载的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明同向双轴结构下双轴间的运动关系标定方法的流程图；图2是本发明同向双轴结构下双轴间的运动关系变换的流程图；图3是关系表达式的分段函数在坐标系下表现的折线示意图。具体实施方式为了使本发明所解决的技术问题、技术方案及有益效果更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。见图1，本发明的同向双轴结构下双轴间的运动关系标定方法，双轴一定行程下分步做同时同步运动，根据运动产生的数据生成关系表达式，具体包括以下步骤：第1步骤、将标定板安装到贴装头上，调整标定板位置到图像中心处，配置标定参数，初始化关系表达式：将标定板吸附至贴装头上，调整标定板特征区域位置到图像中心处并调整贴装头高度直至相机成像清晰，配置标定参数并初始化关系表达式。在第1步骤中，相机安装在贴装头的上方，标定板吸附在贴装头的底部，贴装头的电机中心开设有便于相机拍摄到标定板的圆孔。标定参数包括贴装头Y轴同步运动起始位置坐标值、相机Y轴同步运动起始位置坐标值和运动步长，其中，运动步长是同步运动中每步运动的长度，其单位是mm。关系表达式反映了双轴一定行程下分步做同时同步运动时，相机Y轴坐标值与贴装头相较于相机发生的位置偏移之间的关系，关系表达式如下：以上关系表达式为分段函数，在坐标系下表现为折线示意图，见图3所示，其中，折线的顶点代表同步运动各步终点时相机Y轴坐标值和对应的贴装头偏移值；表示相机Y轴坐标值；表示相机Y轴在位置的偏移值；表示同步运动标定的第几步；表示折线上第i步到第i-1步连线的直线函数表达式，使用斜截式确定的值；表达式表示在第i步上。见图3，当相机Y轴坐标值为1时，此时相机Y轴的偏移值为6；当相机Y轴坐标值为2时，此时相机Y轴的偏移值为13；当相机Y轴坐标值为3时，此时相机Y轴的偏移值为21；当相机Y轴坐标值为4时，此时相机Y轴的偏移值为30；当相机Y轴坐标值为5时，此时相机Y轴的偏移值为29；当相机Y轴坐标值为6时，此时相机Y轴的偏移值为35；当相机Y轴坐标值为7时，此时相机Y轴的偏移值为38；当相机Y轴坐标值为8时，此时相机Y轴的偏移值为40；当相机Y轴坐标值为9时，此时相机Y轴的偏移值为33；当相机Y轴坐标值为9.8时，此时相机Y轴的偏移值为10。由于同步运动贴装头在X、Y两个方向产生偏移，因此初始化的两个表达式为：其中，表示同步运动相机Y轴坐标值为时贴装头在X轴产生的偏移值；其中，表示同步运动相机Y轴坐标值为时贴装头在Y轴产生的偏移值。第2步骤、创建匹配模板：采集标定板图像，并在标定板图像上绘制视觉特征区域以此创建匹配模板。在第2步骤中，在同步运动初始位置采集一张标定板图像，在此标定板图像上绘制匹配模板区域并创建模板，记录同步运动起始位置模板中心。第3步骤、执行同步运动并拍照取图：根据第1步骤配置的标定参数和初始化的关系表达式，双轴在一定行程内分步做同时同步运动，并在每步运动停留间隔期间相机拍照取图，得到标定板图像。在第3步骤中，同步运动中的每步包括以下步骤：第3.1步骤、相机和贴装头沿各自的Y轴按照设定的运动步长同时同步的运动一个步长，记录相机Y轴起点坐标值和相机Y轴终点坐标值；第3.2步骤、计算贴装头X轴偏移值和贴装头Y轴偏移值，并在第3.1步骤同步运动后，贴装头X轴再次移动，贴装头Y轴再次移动；贴装头X轴偏移值的计算公式如下：其中，表示贴装头X轴偏移值；表示相机Y轴起点坐标值；表示相机Y轴终点坐标值；表示同步运动相机Y轴坐标值为时贴装头在X轴产生的偏移值；表示同步运动相机Y轴坐标值为时贴装头在X轴产生的偏移值；贴装头Y轴偏移值的计算公式如下：其中，表示贴装头Y轴偏移值；表示相机Y轴起点坐标值；表示相机Y轴终点坐标值；表示同步运动相机Y轴坐标值为时贴装头在Y轴产生的偏移值的表达式；表示同步运动相机Y轴坐标值为时贴装头在Y轴产生的偏移值的表达式；第3.3步骤、拍照取图；第3.4步骤、循环上述第3.1步骤、第3.2步骤和第3.3步骤，直到完成所设置的运动总步数。第4步骤、计算出关系表达式：对第3步骤采集到的标定板图像进行视觉模板匹配，得到模板区域中心点坐标，计算每步中心点相较于起始位置取图时模板区域中心点的偏移值，最后根据每步偏移值生成关系表达式，即得到偏移表。在所述第4步骤中，遍历第3步骤同步运动中每步拍照取图的标定板图像，计算出关系表达式，设为同步运动步数的下标，遍历过程包括以下步骤：第4.1步骤、取第步的标定板图像进行视觉模板匹配，得到匹配中心点坐标，则匹配中心点坐标相较于同步运动起始位置模板中心的图像参考系下X、Y轴偏移值的计算公式如下：其中，表示第步图像参考系下的X、Y轴的偏移值；表示第步匹配中心点坐标；表示同步运动起始位置模板中心；的单位为pixel。第4.2步骤、将图像参考系下X、Y轴偏移值转到机械轴参考系下X、Y轴的偏移值，该机械轴参考系下X、Y轴的偏移值的计算公式如下：其中，表示第步机械轴参考系下X、Y轴的偏移值；表示第步图像参考系下的X、Y轴的偏移值；表示图像参考系下的像素间距到机械轴参考系下的轴间距的转换矩阵，该矩阵通过设备执行手眼标定获得。第4.3步骤、由于当前的同步运动是在已有关系表达式补偿下进行的，因此需要把当前偏移值加上已有的偏移值作为最终贴装头偏移值，最终贴装头偏移值的计算公式如下：其中，表示第步同步运动最终贴装头起点偏移值；表示第步同步运动最终贴装头终点偏移值；表示第步同步运动机械轴参考系下X、Y轴的偏移值；表示相机Y轴第步同步运动起点坐标值；表示相机Y轴第步同步运动终点坐标值；表示相机Y轴为第步同步运动起点坐标值时的贴装头X轴偏移值表达式；表示相机Y轴为第步同步运动终点坐标值时的贴装头X轴偏移值表达式；表示相机Y轴为第步同步运动起点坐标值时的贴装头Y轴偏移值表达式；表示相机Y轴为第步同步运动终点坐标值时的贴装头Y轴偏移值表达式。第4.4步骤、将第步同步运动的相机Y轴起点坐标、同步运动的相机Y轴终点坐标和同步运动的相机Y轴起点最终贴装头偏移值、同步运动的相机Y轴终点最终贴装头偏移值，分别代入分段表达式并求解表达式，具体地：将第步同步运动的相机Y轴起点坐标、同步运动的相机Y轴终点坐标和同步运动的相机Y轴起点最终贴装头偏移值、同步运动的相机Y轴终点最终贴装头偏移值的X轴的值代入表达式中第步同步运动的直线函数，得到第同步运动起点到终点的直线方程组求解方程组得到；其中，表达式表示第步同步运动的直线函数；表达式表示在第i步上；上述求解表达式为求出的值；表示第步同步运动起点的X轴最终偏移值；表示第步同步运动终点的X轴最终偏移值。将第步同步运动的相机Y轴起点坐标、同步运动的相机Y轴终点坐标和同步运动的相机Y轴起点最终贴装头偏移值、同步运动的相机Y轴终点最终贴装头偏移值的Y轴表达式中第步同步运动的直线函数，得到第同步运动起点到终点的直线方程组求解方程组得到；其中，表达式表示第步同步运动的直线函数；表达式表示在第i步上；上述求解表达式为求出的值；表示第步同步运动起点的Y轴最终偏移值；表示第步同步运动终点的Y轴最终偏移值。第5步骤、判断偏移表中的每个偏移值是否都满足指标：当偏移表中的每个偏移值都满足指标，则标定完成；当偏移表中的任意一个偏移值不满足指标，则回到第3步骤再次进行后续步骤直到满足指标为止。见图2，贴装时，根据关系表达式计算出运动偏移值，补偿到贴装头上，再进行贴装，以实现同向双轴结构下双轴间的运动关系的变换。同向双轴结构下双轴间的运动关系的变换，具体包括以下步骤：第步骤、输入相机Y轴运动的起点坐标值和相机Y轴运动的终点坐标值，相机Y轴运动的起点坐标值记作Ps，相机Y轴运动的终点坐标值记作Pe；第步骤、将第步骤记录的相机Y轴运动的起点坐标值Ps和相机Y轴运动的终点坐标值Pe分别带入X和Y轴的关系表达式，计算最终贴装头需要运动的值：贴装头X轴的运动值的计算公式如下：其中，表示贴装头X轴的运动值；表示相机Y轴运动的终点坐标值；表示相机Y轴运动的起点坐标值；表示相机Y轴为时的贴装头X轴偏移值；表示相机Y轴为时的贴装头X轴偏移值。贴装头Y轴的运动值的计算公式如下： 其中，表示贴装头Y轴的运动值；表示相机Y轴运动的起点坐标值；表示相机Y轴运动的终点坐标值；表示相机Y轴为时的贴装头Y轴偏移值；表示相机Y轴为时的贴装头Y轴偏移值。第步骤、发送贴装头的运动值到下位机执行运动。以上，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，根据本发明的技术方案及其发明构思加以等同替换或改变，都应涵盖在本发明的保护范围之内。
