标题title
基于睡眠鼾声特征的OSAHS检测系统及方法
摘要abst
本发明公开了一种基于睡眠鼾声特征的OSAHS检测系统，包括：预处理模块，用于对睡眠鼾声信号进行预加重、分帧和加窗；特征提取模块，用于提取睡眠鼾声信号的声学特征，并根据睡眠鼾声信号的声学特征形成OSAHS患者特征矩阵和简单打鼾者特征矩阵；特征选择模块，用于计算睡眠鼾声信号声学特征的费雪比值进行特征选择；高斯学习模块，用于分别建立OSAHS患者高斯混合模型和简单打鼾者高斯混合模型，并形成OSAHS患者与简单打鼾者分类模型；OSAHS识别模块，用于分别计算OSAHS患者高斯混合模型和简单打鼾者高斯混合模型的高斯似然度，并将两个高斯混合模型的高斯似然度的差作为OSAHS患者与简单打鼾者分类模型的得分，将得分与设定的得分阈值进行比较，判断受试者是否为OSAHS患者。
权利要求书clms
1.一种基于睡眠鼾声特征的OSAHS检测系统，其特征在于，包括：预处理模块，用于对受试者的睡眠鼾声信号进行预加重、分帧和加窗；特征提取模块，用于提取受试者睡眠鼾声信号的声学特征，并根据受试者睡眠鼾声信号的声学特征形成OSAHS患者特征矩阵和简单打鼾者特征矩阵；特征选择模块，用于计算受试者睡眠鼾声信号声学特征的费雪比值进行特征选择；高斯学习模块，用于分别建立OSAHS患者高斯混合模型和简单打鼾者高斯混合模型，并形成OSAHS患者与简单打鼾者分类模型；OSAHS识别模块，用于分别计算OSAHS患者高斯混合模型和简单打鼾者高斯混合模型的高斯似然度，将两个高斯混合模型的高斯似然度的差作为OSAHS患者与简单打鼾者分类模型的得分，将得分与设定的得分阈值进行比较，判断受试者是否为OSAHS患者。2.如权利要求1的基于睡眠鼾声特征的OSAHS检测系统，其特征在于，预加重公式为y＝x-ax其中，a为预加重系数；加窗的窗函数采用汉明窗函数。3.如权利要求1的基于睡眠鼾声特征的OSAHS检测系统，其特征在于，鼾声信号的声学特征包括梅尔倒谱系数、Bark子带特征、梅尔倒谱系数、感知线性预测系数、共振峰、800Hz功率比、谱熵、gammatone倒谱系数、波峰因数、共振峰、频谱质心。4.如权利要求3的基于睡眠鼾声特征的OSAHS检测方法，其特征在于，Bark子带特征的计算公式为式中，为经过傅里叶变化之后第k帧的谱线幅度绝对值，Km为总帧数，fi为谱线对应的频率，BUj和BLj分别代表第j个Bark子带的下界与上界频率。5.如权利要求3的基于睡眠鼾声特征的OSAHS检测系统，其特征在于，800Hz功率比的计算公式为式中，fc是截止频率，表示傅里叶变化fi频率下第k帧的幅度绝对值。6.如权利要求1的基于睡眠鼾声特征的OSAHS检测系统，其特征在于，声学特征的费雪比值计算公式为其中，mk表示第k维度第i类的特征的均值，mk表示特征第k维度在所有类上的均值，ck表示第i类样本的第k维度特征，ni表示样本对应类别的个数。7.如权利要求1的基于睡眠鼾声特征的OSAHS检测系统，其特征在于，形成高斯混合模型的多个高斯分布叠加结果计算公式为其中，X表示特征矩阵，表示权重，∑k为协方差矩阵，μk为高斯模型的均值向量，高斯混合模型的参数λ由μk、∑k与φk组成。8.如权利要求1的基于睡眠鼾声特征的OSAHS检测系统，其特征在于，高斯似然度的计算公式为式中，Xj表示第j个样本特征，N表示样本总个数，λ表示高斯混合模型的参数，P表示Xj对应参数λ的高斯概率密度函数。9.如权利要求1的基于睡眠鼾声特征的OSAHS检测系统，其特征在于，计算OSAHS患者与简单打鼾者分类模型得分的公式为其中，xt表示测试集第t个鼾声样本特征，T表示样本总数，θOSAHS和θHealth分别表示GMM_OSAHS的模型参数和GMM_Health的模型参数。10.一种基于睡眠鼾声特征的OSAHS检测方法，其特征在于，采用权1至权9任一项的基于睡眠鼾声特征的OSAHS检测系统，包括以下步骤：S1.对受试者的睡眠鼾声信号进行预加重、分帧和加窗；S2.提取受试者睡眠鼾声信号的声学特征，根据受试者睡眠鼾声信号的声学特征形成OSAHS患者特征矩阵和简单打鼾者特征矩阵；S3.计算受试者睡眠鼾声信号声学特征的费雪比值进行特征选择，分别建立OSAHS患者高斯混合模型和简单打鼾者高斯混合模型，形成OSAHS患者与简单打鼾者分类模型；S4.分别计算OSAHS患者高斯混合模型和简单打鼾者高斯混合模型的高斯似然度，将两个高斯混合模型的高斯似然度的差作为OSAHS患者与简单打鼾者分类模型的得分，将得分与设定的得分阈值进行比较，判断受试者是否为OSAHS患者。
说明书desc
技术领域本发明属于音频信号处理技术领域，具体地说，涉及一种基于受试者睡眠鼾声的声学特 征的OSAHS患者检测系统及检测方法。背景技术阻塞性睡眠呼吸暂停低通气综合征 是一种普遍且危害大的睡眠呼吸障碍，其特点是在睡眠呼吸过程中容易发生的呼吸暂停与低 通气事件。呼吸紊乱事件中患者的气道阻塞，导致呼吸受阻。在医疗界多 以睡眠多导图作为诊断的金标准，PSG诊断具有费用昂贵、对检测环境要求高、需 要受试者穿戴众多传感器等缺点。由于鼾声信号携带了人呼吸道形状变化的信息，当发生呼吸紊乱事件时，呼吸道的形状发生变化，呼吸道的形状影响鼾声的特性。因此在呼吸紊乱 事件发生时以及发生前后，鼾声的性状也会发生变化，可以通过将普通鼾声与呼吸紊乱事件 相关鼾声进行分类。因此，针对受试者的整晚的鼾声声学特征分析以识别OSAHS患者与简 单打鼾者的研究是必要的。发明内容本发明的目的在于克服现有技术的缺陷，提出一种基于鼾声特征的OSAHS检测系统， 该系统辅助诊断OSAHS患者与简单打鼾者，减少了辅助诊断OSAHS患者的成本。为了实现上述目的，本发明所采用的技术方案如下：一种基于睡眠鼾声特征的OSAHS检测系统，包括：预处理模块，用于对受试者的睡眠鼾声信号进行预加重、分帧和加窗；特征提取模块，用于提取受试者睡眠鼾声信号的声学特征，并根据受试者睡眠鼾声信号 的声学特征形成OSAHS患者特征矩阵和简单打鼾者特征矩阵；特征选择模块，用于计算受试者睡眠鼾声信号声学特征的费雪比值进行特征选择；高斯学习模块，用于分别建立OSAHS患者高斯混合模型和简单打鼾者高斯混合模型， 并形成OSAHS患者与简单打鼾者分类模型；OSAHS识别模块，用于分别计算OSAHS患者高斯混合模型和简单打鼾者高斯混合模型 的高斯似然度，将两个高斯混合模型的高斯似然度的差作为OSAHS患者与简单打鼾者分类 模型的得分，将得分与设定的得分阈值进行比较，判断受试者是否为OSAHS患者。进一步地，预加重公式为y＝x-ax其中，a为预加重系数；加窗的窗函数采用汉明窗函数。进一步地，鼾声信号的声学特征包括梅尔倒谱系数、Bark子带特征、梅尔倒谱系数、感知线性预测系数、共振峰、800Hz功率比、谱熵、gammatone倒谱系数、波峰 因数、共振峰、频谱质心。进一步地，Bark子带特征的计算公式为式中，为经过傅里叶变化之后第k帧的谱线幅度绝对值，Km为总帧数，fi为谱线对 应的频率，BUj和BLj分别代表第j个Bark子带的下界与上界频率。进一步地，800Hz功率比的计算公式为式中，fc是截止频率，表示傅里叶变化fi频率下第k帧的幅度绝对值。进一步地，声学特征的费雪比值计算公式为其中，mk表示第k维度第i类的特征的均值，mk表示特征第k维度在所有类上的均值， ck表示第i类样本的第k维度特征，ni表示样本对应类别的个数进一步地，形成高斯混合模型的多个高斯分布叠加结果计算公式为其中，X表示特征矩阵，表示权重，∑k为协方差矩阵，μk为高斯模型的均值向量，高斯混合模型的参数λ由μk、∑k与φk组成。进一步地，高斯似然度的计算公式为式中，Xj表示第j个样本特征，N表示样本总个数，λ表示高斯混合模型的参数，P 表示Xj对应参数λ的高斯概率密度函数。进一步地，计算OSAHS患者与简单打鼾者分类模型得分的公式为其中，xt表示测试集第t个鼾声样本特征，T表示样本总数，θOSAHS和θHealth分别表示GMM_OSAHS的模型参数和GMM_Health的模型参数。一种基于睡眠鼾声特征的OSAHS检测方法，采用上述任一项的基于睡眠鼾声特征的 OSAHS检测系统，包括以下步骤：S1.对受试者的睡眠鼾声信号进行预加重、分帧和加窗；S2.提取受试者睡眠鼾声信号的声学特征，根据受试者睡眠鼾声信号的声学特征形成 OSAHS患者特征矩阵和简单打鼾者特征矩阵；S3.计算受试者睡眠鼾声信号声学特征的费雪比值进行特征选择，分别建立OSAHS患者 高斯混合模型和简单打鼾者高斯混合模型，形成OSAHS患者与简单打鼾者分类模型；S4.分别计算OSAHS患者高斯混合模型和简单打鼾者高斯混合模型的高斯似然度，将两 个高斯混合模型的高斯似然度的差作为OSAHS患者与简单打鼾者分类模型的得分，将得分 与设定的得分阈值进行比较，判断受试者是否为OSAHS患者。与现有技术相比，本发明通过对OSAHS患者与简单打鼾者的睡眠鼾声进行分析，提取 了受试者睡眠鼾声信号的声学特征，使用高斯混合模型对受试者睡眠鼾声进行建模，将两个 高斯混合模型的高斯似然度差作为OSAHS患者与简单打鼾者分类模型的得分，与设置的得 分阈值进行比较，辅助诊断OSAHS患者与简单打鼾者，减少了辅助诊断OSAHS患者的成本。附图说明图1为基于睡眠鼾声特征的OSAHS检测系统的结构示意图。图2为OSAHS患者与简单打鼾者分类模型的结构示意图。具体实施方式下面结合附图和具体实施例对本发明基于睡眠鼾声特征的OSAHS检测系统及方法作进 一步说明。请参阅图1，本发明公开了一种基于睡眠鼾声特征的OSAHS检测系统，基于睡眠鼾声特 征的OSAHS检测系统包括预处理模块、特征提取模块、特征选择模块、高斯学习模块和OSAHS识别模块。预处理模块用于对受试者的睡眠鼾声信号进行预加重、分帧和加窗；特征提取模块用于提取受试者睡眠鼾声信号的声学特征，并根据受试者睡眠鼾声信号的声学特征 形成OSAHS患者特征矩阵和简单打鼾者特征矩阵；特征选择模块用于计算受试者睡眠鼾声 信号声学特征的费雪比值进行特征选择；高斯学习模块用于分别建立OSAHS患者高斯混合 模型和简单打鼾者高斯混合模型，并形成OSAHS患者与简单打鼾者分类模型；OSAHS识别模块用于分别计算OSAHS患者高斯混合模型和简单打鼾者高斯混合模型的高斯似然度，将两个高斯混合模型的高斯似然度的差作为OSAHS患者与简单打鼾者分类模型的得分，将得分与设定的得分阈值进行比较，判断受试者是否为OSAHS患者。本发明还公开了一种基于睡眠鼾声特征的OSAHS检测方法，采用上述的OSAHS检测系 统，具体包括以下步骤：S1.对受试者的睡眠鼾声信号进行预加重、分帧和加窗。S2.提取受试者睡眠鼾声信号的声学特征，根据受试者睡眠鼾声信号的声学特征形成 OSAHS患者特征矩阵和简单打鼾者特征矩阵。S3.计算受试者睡眠鼾声信号声学特征的费雪比值进行特征选择，分别建立OSAHS患者 高斯混合模型和简单打鼾者高斯混合模型，形成OSAHS患者与简单打鼾者分类模型。S4.分别计算OSAHS患者高斯混合模型和简单打鼾者高斯混合模型的高斯似然度，将两 个高斯混合模型的高斯似然度的差作为OSAHS患者与简单打鼾者分类模型的得分，将得分 与设定的得分阈值进行比较，判断受试者是否为OSAHS患者。具体地，对受试者的睡眠鼾声信号进行预加重的公式为y＝x-ax其中，a为预加重系数，本发明中a取0.975，分帧时本发明中使用20ms帧长，加窗采用的 窗函数为汉明窗函数。提取受试者睡眠鼾声信号的声学特征，声学特征包括梅尔倒谱系数、Bark子带特征、感 知线性预测系数、基频、共振峰、800Hz功率比、谱熵、gammatone倒谱系数、波峰因数、共振峰、频谱质心。提取受试者睡眠鼾声信号的Bark子带特征时，Bark子带特征利用下式计算其中，为经过傅里叶变化之后第k帧的谱线幅度绝对值，Km为总帧数，fi为谱线对应的 频率，BUj和BLj分别代表第j个Bark子带的下界与上界频率。分别计算每个子带内能量特 征，共计17维度特征，考虑到BSF特征需要更高的频域分辨率，计算中使用50ms帧长，50％ 帧移。提取受试者睡眠鼾声信号的梅尔倒谱系数时，首先对鼾声信号进行预加重、 分帧和加窗，然后进行快速傅里叶变化，再对傅里叶变化后的信号计算谱线能量。将能量谱 通过梅尔滤波器组后取对数，进行离散反余弦变化获得MFCC系数，将13阶MFCC与13阶MFCC一阶差分、二阶差分合并作为最终的MFCC，本发明中按帧取均值作为特征。提取受试者睡眠鼾声信号的感知线性预测系数时，首先鼾声的音频信号经过分 帧加窗以及傅里叶变换取平方后获得短时功率谱，如式：P＝Re2+Im2然后将频谱的频率f映射到Bark频率Ω上，Bark频带的表达式为：Ω＝6ln{f/1200π+0.5}按照式临界频带对Ω进行临界带变化：通过式与短时功率谱卷积获得临界带功率谱：获得临界带功率谱后按照等响进行预加重，然后压缩幅值以近似模拟声音强度与人耳感受强 度的非线性关系，然后求线性预测系数得PLP特征，取13阶PLP特征与一阶差分和二阶差 分，共计39维度特征，按帧取均值作为特征。提取受试者睡眠鼾声信号的基频时，因为基频反映了声带开闭的时间，本发明中使用归 一化自相关函数法求基频，按帧取均值、最大值、最小值、方差作为特征。提取受试者睡眠鼾声信号的共振峰时，因为共振峰包含在音频信号的包络中，一般会提 取音频信号的前三个共振峰频率作为参数，分别为第一共振峰、第二共振峰与 第三共振峰，本发明中使用LPC法求共振峰，按帧提取均值作为特征。提取受试者睡眠鼾声信号的800Hz功率比时，800Hz功率比表示鼾声信号800Hz 以上与800Hz以下的功率比值，800Hz功率比利用下式计算：fc是截止频率，被设置为8000Hz，表示傅里叶变化fi频率下第k帧的幅度绝对值，本发 明中按帧提取均值、最大值、最小值、方差作为特征。提取受试者睡眠鼾声信号的谱熵时，谱熵利用下式计算：谱熵反映了鼾声的频域能量分布的混乱程度，f1与f2表示频率边界，本发明中按帧取均值、 最大值、最小值、方差作为特征。提取受试者睡眠鼾声信号的gammatone倒谱系数时，gammatone倒谱系数与MFCC类似，区别在与gammatone倒谱系数将频谱通过gammatone滤波器组而非梅尔滤波器组，gammatone滤波器组是一种模拟人耳听觉系统的滤波器，本发明中使用特征维度为20的GTCC作为特征，计算每帧GTCC，然后在每段音频内按帧求均值作为特征。提取受试者睡眠鼾声信号的波峰因数时，波峰因数反映了时域上声音信 号的变化幅度，波峰因数利用下式计算：其中，V90为一帧声音数据中幅度绝对值大小90％分位数，V为该段声音幅度绝对值片段中前 10％到90％之间的均方根值，本发明中按帧提取均值作为特征。提取受试者睡眠鼾声信号的频谱质心时，频谱质心利用下式计算：其中fi表示频率，fi表示频谱成分，f1和f2表示频率边界，本发明中按帧取均值、最大值、 最小值、方差作为特征。提取受试者睡眠鼾声信号的频谱其他相关特征，例如提取频谱分散度、频谱平坦度、频 谱通量、频谱波峰、频谱衰减、频谱峭度、频谱截止频率、频谱偏度、频谱斜率，并按帧计 算均值、最大值、最小值、方差作为特征。每名受试者的鼾声按照上述系统提取梅尔倒谱系数、Bark子带特征、感知线性预测系数、 基频、共振峰、800Hz功率比、谱熵、Gammatone倒谱系数特征组合为特征矩阵。计算受试者睡眠鼾声信号声学特征的费雪比值进行特征选择，按照式对上述特征 计算Fisher比值其中mk表示第k维度第i类的特征的均值，mk表示特征第k维度在所有类上的均值，ck表示第i类样本的第k维度特征，ni表示样本对应类别的个数，按照Fsiher比值从大到小的 顺序进行排列，选取前100维度特征作为最终特征子集。将OSAHS患者与简单打鼾者的特征矩阵分别组成总的OSAHS患者矩阵与简单打鼾者矩 阵，然后分别在OSAHS患者特征矩阵与简单打鼾者特征矩阵上建立两个高斯混合模型，高 斯混合模型阶数为32。高斯混合模型的核心为拟合高斯分布，多个高斯分布叠加结果如式其中，X表示特征矩阵，表示权重，∑k为协方差矩阵，μk为高斯模型的均值向量，高斯 混合模型的参数λ由μk、∑k与φk组成。通过多个高斯分布拟合样本的数据分布，而高斯混 合模型的学习就是求解高斯分布的参数。对高斯混合模型，对数似然函数为式中，Xj表示第j个样本特征，N表示样本总个数，λ表示高斯混合模型的参数，P表 示Xj对应参数λ的高斯概率密度函数。对于该似然函数，高斯混合模型利用EM算法进行迭 代求解最优参数。EM算法是一种迭代算法，首先需要初始化参数，从训练数据中随机抽取与GMM阶数相对应的特征矢量，求它们的均值与方差作为初始值，并让各分量具有相同的混合权重，随后是E-step：γjk为第j个样本属于第k个高斯模型的可能性。之后是M-step，根据式、式、式迭代模型参数：重复E-step与M-step两个步骤，直到收敛，估计得高斯混合模型的参数。分别在OSAHS患 者特征矩阵与简单打鼾者特征矩阵上建立两个高斯混合模型，记为GMM_OSAHS与GMM_Health，OSAHS患者与简单打鼾者分类模型由上述两个高斯混合模型组成。对于测试受试者，按照上述相同系统提取特征矩阵，并且与两个高斯混合模型计算对数 似然，并按照式计算OSAHS患者与简单打鼾者分类模型的受试者得分：其中，xt表示测试集第t个鼾声样本特征，T表示样本总数，θOSAHS与θHealth分别代表GMM_OSAHS与GMM_Health的模型参数。将每个受试者的得分与固定阈值进行比较，判 断受试者是否为OSAHS病人，本发明中选择的阈值为20。应用实施例11.选取经过PSG诊断的30名受试者，其中简单打鼾者6名、OSAHS 患者24名，一共识别出48767个鼾声片段，对鼾声片段进行预加重与分帧加窗。2.按照上述系统分别提取OSAHS患者与简单打鼾者的梅尔倒谱系数、Bark子带特征、感 知线性预测系数、基频、共振峰、800Hz功率比、谱熵、Gammatone倒谱系数，组成特征矩 阵。3.计算每个特征的Fisher比值，Fisher比值计算方法见式。按照Fisher比值大小进 行排序，选取前100维度作为最终特征子集。然后分别建立OSAHS患者与简单打鼾者的高 斯混合模型。按照式计算受试者得分，将得分与阈值进行比较，预测受试者是否为OSAHS 患者，阈值设置为20。具体流程如附图2所示，在OSAHS患者与简单打鼾者上建立两个GMM 模型，分别为GMM_OSAHS与GMM_Health，N与M分别为OSAHS患者与简单打鼾者鼾 声总数，Ni与Mi分别代表第i个OSAHS患者与第i个简单打鼾者的鼾声样本个数，k为特征 维度。对于测试者，按照式计算受试者得分，并与得分阈值比较判断是否为OSAHS 患者。本应用实施例采取留一交叉验证的方法进行验证，即每次选择一个受试者作为测试集， 剩余29名受试者作为训练集，并重复30次。结果显示本发明所示系统准确率达到90％，精 确度达到95.65％，召回率达到91.67％，特异性为83.33％。具有良好的效果。综上所述，本发明通过对OSAHS患者与简单打鼾者的睡眠鼾声进行分析，提取了受试者 睡眠鼾声信号的声学特征，使用高斯混合模型对受试者睡眠鼾声进行建模，将两个高斯混合 模型的高斯似然度差作为OSAHS患者与简单打鼾者分类模型的得分，与设置的得分阈值进 行比较，辅助诊断OSAHS患者与简单打鼾者，减少了辅助诊断OSAHS患者的成本。上述说明是针对本发明较佳可行实施例的详细说明，但实施例并非用以限定本发明的专 利申请范围，凡本发明所揭示的技术精神下所完成的同等变化或修饰变更，均应属于本发明 所涵盖专利范围。
