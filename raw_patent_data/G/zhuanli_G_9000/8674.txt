标题title
一种面向稳态视觉诱发电位的脑-机接口解码方法
摘要abst
本发明公开了一种面向稳态视觉诱发电位的脑‑机接口解码方法，包括：针对稳态视觉诱发电位数据集通过滑动时间窗获取不同刺激时长的数据，对数据进行带通滤波；根据数据的周期振荡特性，以循环位移为基本手段，设计了新型数据扩充技术，并将该数据扩充技术结合其他模式识别方法进行脑电解码。本发明通过扩充样本数据，充分挖掘样本的有效信息，能够提高算法的鲁棒性，缩短刺激时间和校准次数，减轻受试者的视觉疲劳感，提高BCI系统的信息传输效率。
权利要求书clms
1.一种面向稳态视觉诱发电位的脑-机接口解码方法，其特征在于，所述方法包括：针对稳态视觉诱发电位数据集通过滑动时间窗获取不同刺激时长的数据，对数据进行带通滤波；根据数据的周期振荡特性，以循环位移为基本手段，设计了新型数据扩充技术，并将该数据扩充技术结合其他模式识别方法进行脑电解码；其中，所述新型数据扩充技术具体为：1)训练数据按照标记频率进行循环位移，获得扩展后的训练数据；基于原始训练数据和扩展后的训练数据分别构建原始训练模板和扩展训练模板；2)由扩展后的训练数据构建基于扩展训练空间滤波器；待测样本按照潜在目标频率进行循环位移，获得测试样本的扩展数据；3)由测试样本的扩展数据构建扩展测试模板；由测试样本的扩展数据构建扩展测试空间滤波器；联合各个模板进行相关系数的匹配。2.根据权利要求1所述的一种面向稳态视觉诱发电位的脑-机接口解码方法，其特征在于，所述训练数据按照标记频率进行循环位移，获得扩展后的训练数据为：根据当前假设频率对训练数据进行周期划分，并将第一个周期按照末尾残缺周期划分为1A、1B两部分；依次按照周期顺序进行循环移位；对于第u次循环移位，将原始信号按照从低位周期到高位周期的方向进行移动，移位起始点为第u+1个周期的起点，移位长度为一个周期的采样点长度；末尾空缺的残缺周期由原始信号中第一个周期的1B部分进行补足，高位溢出的信号从第二个周期向末尾补足，最后将一个周期的1A部分补充至信号末端，生成一个新的长度为N的信号3.根据权利要求1所述的一种面向稳态视觉诱发电位的脑-机接口解码方法，其特征在于，所述扩展训练模板为：第k个频率的扩展训练模板其中，q为单试次样本的个数，ck为采样点长度；为执行第u次循环移位得到的扩展数据被命名为扩展训练数据；所述扩展测试模板为：对应第k个频率的扩展测试模板为对应第k个频率的第u次扩展样本，对第k个频率的扩展测试数据进行任务相关成分分析，可以得到扩展测试空间滤波器w′k；对上述数据进行联合模板匹配，待测样本和第k个待测频率的相关性用不同的方式测量：最终的相关系数rk由四个系数的加权和得到:目标频率按照下式检测：其中，a是权重向量。
说明书desc
技术领域本发明涉及脑-机接口领域，尤其涉及一种面向稳态视觉诱发电位的脑-机接口解码方法。背景技术脑-机接口是指将中枢神经系统活动直接转化为人工输出的系统，它能够替代、修复、增强、补充或改善中枢神经系统的正常输出，从而实现神经系统与外部设备的直接交互。BCI综合了多种工程技术，可以为运动能力有限的人提供闭环的交互途径，并为健康的人提供可替代的交互方法。根据信号采集方式的不同，可以将BCI分为侵入式BCI、部分侵入式BCI和非侵入式BCI。基于装置安全和成本低的特点，非侵入式BCI被广泛应用。BCI系统通常由信号采集、信号解码和输出控制等技术环节组成，最终实现大脑与外部设备的直接交流。SSVEP是大脑皮层对大于6Hz的重复视觉闪烁刺激所产生的电势，由刺激的基频和谐波的振荡活动组成。基于SSVEP的BCI将具有不同频率的闪烁视觉刺激与特定的命令关联起来，用户可以通过关注不同的刺激来选择输出命令。而且，基于SSVEP的BCI具有高信噪比和高信息传输速率的特点，因此被广泛关注和研究。目前。针对SSVEP的解码方法已经发展得比较成熟。基于典型相关分析和任务相关成分分析的算法被普遍用于SSVEP-BCIs的解码过程，极大地提高了SSVEP-BCIs的信息识别正确率和信息传输速率。目前基于稳态视觉诱发电位的BCI技术已经达到了376.58bits/min的信息传输速率，为将BCI技术进一步向应用成果转化奠定了有力基础。但是，上述解码方法也面临着单次刺激时间过长和训练次数较多的问题，容易造成用户视觉疲劳，不利于用户执行长时间关注和操作，降低了系统的用户友好度。为增加SSVEP-BCIs系统的可用性，研究人员提出了联合频率相位调制)方法，改进了刺激范式。另一方面，针对SSVEP-BCIs解码算法的研究趋势是在减少校准数据和刺激时间的情况下，提高算法的鲁棒性。SSVEP具有周期震荡的特性，这增加了数据的可利用性和可操作性。发明内容本发明提供了一种面向稳态视觉诱发电位的脑-机接口解码方法，本发明利用SSVEP的周期震荡特性，提出了循环位移单试次样本算法，该算法通过扩充样本数据，并且充分挖掘样本的有效信息，能够提高算法的鲁棒性，缩短刺激时间和校准次数，减轻受试者的视觉疲劳感，同时提高BCI系统的信息传输效率，详见下文描述：一种面向稳态视觉诱发电位的脑-机接口解码方法，所述方法包括：获取公开的基准数据集，并对所述基准数据集通过滑动时间窗获取不同刺激时长的数据，对数据进行带通滤波；根据基准数据集的周期振荡特性，以循环位移为基本手段，设计了适用于基准数据集的数据扩充技术，并采用数据扩充技术进行脑电解码；其中，所述适用于基准数据集的数据扩充技术具体为：1)训练数据按照标记频率进行循环位移，获得扩展后的训练数据；基于原始训练数据和扩展后的训练数据分别构建原始训练模板和扩展训练模板；2)由扩展后的训练数据构建基于扩展训练空间滤波器；待测样本按照潜在目标频率进行循环位移，获得测试样本的扩展数据；3)由测试样本的扩展数据构建扩展测试模板；由测试样本的扩展数据构建扩展测试空间滤波器；联合各个模板进行相关系数的匹配。其中，所述训练数据按照标记频率进行循环位移，获得扩展后的训练数据为：根据当前假设频率对训练数据进行周期划分，并将第一个周期按照末尾残缺周期划分为1A、1B两部分；依次按照周期顺序进行循环移位；对于第u次循环移位，将原始信号按照从低位周期到高位周期的方向进行移动，移位起始点为第u+1个周期的起点，移位长度为一个周期的采样点长度；末尾空缺的残缺周期由原始信号中第一个周期的1B部分进行补足，高位溢出的信号从第二个周期向末尾补足，最后将一个周期的1A部分补充至信号末端，生成一个新的长度为N的信号其中，所述扩展训练模板为：第k个频率的扩展训练模板其中，q为单试次样本的个数，ck为采样点长度；为执行第u次循环移位得到的扩展数据被命名为扩展训练数据。进一步地，所述扩展测试模板为：对应第k个频率的扩展测试模板为对应第k个频率的第u次扩展样本，对第k个频率的扩展测试数据进行任务相关成分分析，可以得到扩展测试空间滤波器w′k；对上述数据进行联合模板匹配，待测样本和第k个待测频率的相关性用不同的方式测量：最终的相关系数rk由四个系数的加权和得到:目标频率按照下式检测：其中，a是权重向量。本发明提供的技术方案的有益效果是：1、本发明利用了SSVEP的周期震荡特性，可以提高解码算法在校准数据减少、刺激时间变短的情况下的鲁棒性；本发明可以减少用户的视觉疲劳，增加系统的用户友好度，同时促进该技术向应用成果转化；2、本发明设计的CST是一种数据扩充技术，可以经过循环位移扩展出有效的数据，并且充分挖掘数据的有效信息，可以提高待测样本与目标频率的相关性，同时降低与非目标频率的相关性；3、本发明设计的解码算法证明在SSVEP中，待测样本包含有效的信息，而且这些信息经过合理的利用可以提高SSVEP-BCIs系统的性能；这为提升SSVEP-BCIs系统性能提供了一个创新且可行的研究方向；进一步研究可以得到完善的脑-机接口系统，有望获得可观的社会效益和经济效益。附图说明图1为一种面向稳态视觉诱发电位的脑-机接口解码的示意图；其中，该设计包括获取公开的SSVEP基准数据集，信号预处理和目标检测识别等。图2为第u次CST的示意图；图3为基于循环位移单试次样本和任务相关成分分析进行的SSVEP解码的示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面对本发明实施方式作进一步地详细描述。实施例1当人眼受到一个固定频率的视觉刺激时，人的大脑视觉皮层将产生一个连续的与刺激频率有关的响应，称为稳态视觉诱发电位。本方法根据SSVEP的周期振荡特性，设计了一种循环位移单试次样本的算法，并融合任务相关成分分析算法进行SSVEP分类识别。经离线测试实验结果表明，该方法有助于提高SSVEP-BCIs的信息识别正确率和信息传输速率。其技术流程是：获取公开的SSVEP基准数据集，进行一定的预处理、特征提取，使用CST-TRCA算法进行分类识别，计算判断的正确率和信息传输率。该项发明因为可以有效提高SSVEP-BCIs系统在小样本、短刺激时长时的性能，因而更具有市场应用场景，可以应用在残疾人康复、生活、娱乐等领域，有望获得可观的社会效益和经济效益。实施例2下面结合具体的计算公式、实例、图1-图3对实施例1中的方案进行进一步地介绍，详见下文描述：一、获取基准数据本发明实施例采用王义军等人2016年提出的SSVEP基准数据集，其中包含35名健康志愿者的数据。在实验中，受试者坐在离显示屏70cm远的椅子上，屏幕上以5×8矩阵显示40个视觉刺激。采用联合频率相位调制方法对刺激矩阵进行编码。所有刺激块的频率范围被设定为8-15.8Hz，相位为0-1.5π。二、信号预处理首先通过滑动时间窗获取不同刺激时长的数据。时间窗长为0.3s-1.0s，滑动步长为0.1s。滑动时间窗的目的是探究在不同刺激时长下，CST对信息识别率和信息传输速率的影响。之后，对数据进行合适的带通滤波。三、解码步骤本发明实施例的目标检测与识别基于循环位移单试次样本和任务相关成分分析展开。本发明实施例根据SSVEP的周期震荡特性，以循环位移为基本手段，设计了适用于SSVEP的数据扩充技术CST，并采用CST-TRCA算法进行脑电解码，主要包括以下七个步骤：训练数据按照标记频率进行循环位移，获得扩展后的训练数据；基于原始训练数据和扩展后的训练数据分别构建原始训练模板和扩展训练模板；由扩展后的训练数据构建基于TRCA的扩展训练空间滤波器；待测样本按照潜在目标频率进行循环位移，获得测试样本的扩展数据；由测试样本的扩展数据构建扩展测试模板；由测试样本的扩展数据构建基于TRCA的扩展测试空间滤波器；联合各个模板进行相关系数的匹配。1、循环位移测单试次样本假设采样频率为fs，理想情况下，对于一个频率是fk的SSVEP试验，信号的周期长度是fs/fk。对该试验执行一个fs/fk长度的循环移位，会产生一个新的试验。新的数据与最初的试验有同样的SSVEP特性。然而，如果该试验按照其它的长度进行循环移位，则在扩展的数据中原始的SSVEP特性将被打破。在此基础上，本发明实施例建议CST从单试次样本中产生一系列新的数据，并研究哪个位移长度更适合提取稳定的SSVEP。参见图2，对于采样点为N，采样频率为fs的单试次信号，假设其频率为fk，该信号包含个整数周期。如果信号包含不完整周期，计算对应当前周期数目的完整模拟周期信号，其采样点长度为ck：其中，表示对数字向正无穷取整。所以，当前信号残缺周期的采样点长度为lk：lk＝ck-N 根据当前假设频率对原始信号进行周期划分，并将第一个周期按照末尾残缺周期划分为1A、1B两部分。依次按照周期顺序进行循环移位。对于第u次循环移位，将原始信号按照从低位周期到高位周期的方向进行移动，移位起始点为第u+1个周期的起点，移位长度为一个周期的采样点长度。末尾空缺的残缺周期有原始信号中第一个周期的1B部分进行补足，高位溢出的信号从第二个周期向末尾补足，最后将一个周期的1A部分补充至信号末端，生成一个新的长度为N的信号2、解码流程在特征提取过程中，首先对训练样本进行处理。第k个刺激的原始训练样本集记为Xk，共有q个单试次样本。按照标记频率fk，执行第u次循环移位得到的扩展数据被命名为扩展训练数据由此，可以得到包括原始训练样本集Xk在内的Ck*q个单试次样本。将对应试次叠加平均后得到第k个频率的原始训练模板和扩展训练模板分别记为和对所有刺激的扩展训练数据进行任务相关成分分析，可以得到扩展后的集成空间滤波器W。3、对待测样本进行处理待测样本X按照所有潜在的目标频率执行CST。其中，对应第k个频率的第u次扩展样本记为由此，可以得到对应第k个频率的扩展测试模板对第k个频率的扩展测试数据进行任务相关成分分析，可以得到扩展测试空间滤波器w′k。参见图3，之后对上述数据进行联合模板匹配，待测样本和第k个待测频率的相关性可以用不同的方式测量：最终的相关系数rk由四个系数的加权和得到:其中，a是权重向量。目标频率按照公式检测：依上述解码算法可完成对目标频率诱发的脑电特征的解码。本发明实施例对各器件的型号除做特殊说明的以外，其他器件的型号不做限制，只要能完成上述功能的器件均可。本领域技术人员可以理解附图只是一个优选实施例的示意图，上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
