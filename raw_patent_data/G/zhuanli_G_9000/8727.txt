标题title
一种用于云背景下红外目标智能训练和检测方法
摘要abst
本发明公开了一种用于云背景下红外目标智能训练和检测方法，其技术方案主要包括：对红外目标和云背景进行参数化建模，按照特征参数随机生成小尺寸图像的初始化训练数据集；搭建基于小尺寸图像和改进锚框的深度卷积神经网络；在初始化数据集的基础上对神经网络进行增量式自学习训练；对训练得到的神经网络进行图像尺寸变换和去归一化层结构改造，得到可用于实际图像尺寸的神经网络。本方法相比传统方法，降低了对实际红外数据库的依赖，大幅减小数据集的规模，增加训练过程的智能性，提高神经网络的训练效率，解决了移动目标锚框交接不连续的问题，有效提高红外目标的检测概率、降低虚警率，实现了对云背景下红外目标的智能检测。
权利要求书clms
1.一种用于云背景下红外目标智能训练和检测方法，其特征在于，该方法包括以下步骤：步骤A：对红外目标和云背景进行参数化建模，按照特征参数随机生成小尺寸图像的初始化训练数据集；步骤B：搭建基于所述小尺寸图像和改进锚框的深度卷积神经网络，使所述深度卷积神经网络具备对红外目标和云背景的时间维、空间维以及幅度维特征进行提取的能力；步骤C：在初始化训练数据集的基础上对所述神经网络进行增量式自学习训练；步骤D：对经过步骤C训练得到的神经网络进行图像尺寸变换和去归一化层结构改造，得到可用于实际图像尺寸的神经网络；步骤E：将步骤D中得到可用于实际图像尺寸的神经网络部署到智能计算平台上，对输入的云背景下红外目标进行智能检测。2.如权利要求1所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：该方法还包括步骤F：提取实际图像中包含云背景下红外目标的小尺寸图像，添加到所述初始化训练数据集中进行补充训练，以提高神经网络对实际场景的适应能力。3.如权利要求1所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述步骤A中，采用特征参数区间随机分布方法随机生成红外目标以建立红外目标参数化模型。4.如权利要求3所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述红外目标的特征参数包括：目标的数量、大小、形态、强度、噪声、位置以及速度。5.如权利要求1所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述步骤A中，采用随机种子梯度分布方法随机生成云朵以建立云背景参数化模型。6.如权利要求5所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述云背景的特征参数包括：云的大小、强度、噪声、位置、速度以及随机种子。7.如权利要求1所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述步骤B中，所搭建的深度卷积神经网络包括输入层，中间层和输出层。8.如权利要求7所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述深度卷积神经网络的输入层使用小尺寸的时间序列图像加本底背景的多通道图像作为输入。9.如权利要求7所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述深度卷积神经网络的输入层使用差分算子对背景固定噪声进行抑制。10.如权利要求7所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述深度卷积神经网络的中间层使用1×1卷积层、深度可分离卷积层、归一化层或激活函数层的倒金字塔递推结构。11.如权利要求7所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述深度卷积神经网络的输出层包括输出特征变量、改进锚框和损失函数。12.如权利要求7所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述深度卷积神经网络输出层的输出特征变量包括连续变量和逻辑变量。13.如权利要求7所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述深度卷积神经网络输出层的输出特征变量包括目标的位置、大小、分类、概率。14.如权利要求11所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述损失函数由连续变量和逻辑变量两种类型的损失函数组合而成。15.如权利要求11所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述改进锚框是在基础锚框的基础上增加第二类锚框，第二类锚框的位置相比第一类锚框有50％的位移，确保同一目标被两类锚框同时检测，提高目标在锚框交接过程中的连续性。16.如权利要求11所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述增量式自学习训练的方式是在所述初始化训练数据集基础上训练神经网络并达到平均均值准确率阈值后，再采用步骤A所述方法随机生成新数据。17.如权利要求16所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述增量式自学习训练的方式进一步包括：随机生成所述新数据后，用训练得到的神经网络对新数据进行检测，若损失函数的值小于设定阈值则忽略该数据后继续用步骤A生成新数据，若损失函数的值大于设定阈值则将此数据加入至新训练集中继续训练，直到新生成的随机数据的平均均值检测率满足阈值条件。18.如权利要求1所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：步骤D中，对经过步骤C训练得到的神经网络进行图像尺寸变换为将输入层图像从小尺寸图像改变为实际全尺寸图像。19.如权利要求1所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：步骤D中，对经过步骤C训练得到的神经网络进行去归一化层结构改造包括：读取训练得到的神经网络卷积层的权重偏置参数和归一化层参数，然后更新卷积层的权重和偏置参数，删除归一化层，连接归一化层上下两层得到可用于实际图像尺寸的神经网络。20.如权利要求1所述的一种用于云背景下红外目标智能训练和检测方法，其特征在于：所述智能计算平台包括计算机、嵌入式设备和/或ASIC。
说明书desc
技术领域本发明属于红外技术领域，具体涉及一种云背景下红外目标智能训练和检测方法。背景技术云背景下红外目标检测是红外技术领域研究的热点之一。云是由大气中的水蒸气遇冷液化成的小水滴或凝结成的小冰晶所混合组成的漂浮在天空中的可见物，受大气条件等因素的影响，云始终处于运动变化状态。天空中的红外目标容易被复杂多变的云背景所淹没。传统的云背景红外目标检测方法，通过设计固定的模板或滤波器算子对目标和背景进行处理，抑制云杂波，突出目标，从而进行目标分割和检测。传统方法的检测效果依赖于固定模板或滤波器算子对目标和背景特性的准确提取，通常泛化能力较弱，当场景变化导致模板或滤波器算子失配，其检测效果将会大大降低。随着深度学习的发展，许多深度学习思想也被应用到红外目标探测中。常见的卷积神经网络检测方法，搭建具有强大特征提取能力的深度卷积神经网络，建立包括目标背景图像和标签的数据集，通过训练建立起复杂的非线性映射关系，使神经网络对红外目标和云背景具有一定的记忆能力和泛化能力，从而大幅度提高云背景下红外目标检测的准确性。但常规的卷积神经网络检测方法有如下弊端：1.公开的云背景红外目标数据集少，且现场采集的数据集不完备，导致网络泛化能力弱：深度神经网络的应用效果很大程度上取决于数据集的完备性。一方面目前公开的云背景下红外目标数据集少，另外一方面在实际应用中，受现场目标情况和天气条件等因素的限制，也难以获取目标和云背景的各种变化情况，造成数据集不完备，导致训练出来的网络泛化能力弱；2.全尺寸图像数据集庞大，导致训练速度慢、效率低：通常卷积神经网络按照原始图像尺寸构建训练数据库，对应生成的数据集十分庞大，网络训练所占用的硬件资源多、训练速度慢，且通常原始尺寸图像中目标所占比例大幅低于背景所占比例，训练效率低；3.常规的卷积神经网络存移动目标在连续检测过程中锚框交接不畅的问题：处于相邻两个锚框边界的临界目标的归属问题容易造成移动目标在锚框交接过程中检测不连续。发明内容鉴于上述背景，本发明提供一种用于云背景下红外目标智能训练和检测方法，主要解决卷积神经网络检测方法中红外目标与云背景数据集不完备、全尺寸数据集训练效率低以及目标跨锚框交接的问题。本发明的技术方案为：一种用于云背景下红外目标智能训练和检测方法，该方法包括以下步骤：步骤A：对红外目标和云背景进行参数化建模，按照特征参数随机生成小尺寸图像的初始化训练数据集；步骤B：搭建基于所述小尺寸图像和改进锚框的深度卷积神经网络，使所述深度卷积神经网络具备对红外目标和云背景的时间维、空间维以及幅度维特征进行提取的能力；步骤C：在初始化训练数据集的基础上对所述神经网络进行增量式自学习训练；步骤D：对经过步骤C训练得到的神经网络进行图像尺寸变换和去归一化层结构改造，得到可用于实际图像尺寸的神经网络；步骤E：将步骤D中得到可用于实际图像尺寸的神经网络部署到智能计算平台上，对输入的云背景下红外目标进行智能检测。该方法还可包括步骤F：提取实际图像中包含云背景下红外目标的小尺寸图像，添加到所述初始化训练数据集中进行补充训练，以提高神经网络对实际场景的适应能力。其中，本发明技术方案步骤A包括：1.建立基于小尺寸图像的红外目标参数化模型，其模型主要由以下参数决定：目标数量特征参数，在一定范围内随机取值；目标形状特征参数，在预定义结构元素之间随机选取；目标大小特征参数，在一定范围内随机取值；目标强度特征参数，在一定范围内随机取值；目标噪声特征参数，在一定范围内随机取值；目标位置特征参数，在一定范围内随机取值；目标速度特征参数，在一定范围内随机取值；目标图像的小尺寸和通道参数。通过对目标的各项特征参数进行随机组合生成仿真红外目标图像数据。2.建立基于小尺寸图像的云背景参数化模型，其模型主要由以下参数决定：云大小特征参数，在一定范围内随机取值；云强度特征参数，在一定范围内随机取值；云噪声特征参数，在一定范围内随机取值；云位置参数，在一定范围内随机取值。云速度参数，在一定范围内随机取值。用于生成随机梯度云背景图像的随机采样种子；云图像的小尺寸和通道参数；通过对云的各项特征参数进行随机组合生成仿真云背景图像数据。3.合成目标背景图像并生成初始训练数据集初始训练集由一定数量随机生成的目标图像和随机生成的云背景图像组合而成。本发明技术方案步骤B包括：搭建基于小尺寸图像和改进锚框的深度卷积神经网络，包括输入层、中间层和输出层。神经网络的输入层使用小尺寸的时间序列图像与本底图像作为输入，并使用差分算子对背景固定噪声进行抑制。神经网络的中间层使用1×1卷积层、深度可分离卷积层、归一化层、激活函数层的倒金字塔递推结构。神经网络的输出层包括输出特征变量、改进锚框和损失函数。神经网络输出层的输出特征变量包括连续变量和逻辑变量，包括目标的位置、大小、分类、概率等。神经网络输出层的损失函数由连续变量和逻辑变量两种类型的损失函数组合而成。神经网络输出层的锚框在基础锚框的基础上增加第二类锚框，第二类锚框的位置相比第一类锚框有50％的位移，同一目标被两类锚框同时检测。本发明技术方案步骤C包括：在初始化数据集的基础上对神经网络进行增量式自学习训练；具体地，采用步骤A所述方法在特征参数范围内随机生成一定数量的初始化数据集；在初始化训练数据集基础上训练并达到平均均值准确率阈值后，再采用步骤A所述方法随机生成新数据；用训练得到的神经网络对新数据进行检测，若损失值小于设定阈值则忽略该数据后继续用步骤A生成新数据；若损失函数大于设定阈值则将此数据加入至新训练集中继续训练，直到新生成的随机数据的平均均值检测率满足阈值条件。本发明技术方案步骤D包括：对训练得到的神经网络进行图像尺寸变换和去归一化层结构改造，得到可用于实际图像尺寸的神经网络；具体地，将输入层图像从小尺寸图像变换为实际全尺寸图像。对神经网络进行去归一化层结构改造在于读取训练得到的神经网络卷积层权重偏置参数和归一化层参数，然后用公式更新卷积层的权重和偏置参数，删除归一化层，连接归一化层上下两层得到可用于实际图像尺寸的卷积神经网络。其中，x为卷积层的输入张量；yconv为卷积层的输出张量；为更新后的偏置值，ω、b为原卷积层中的权重值与偏置值；μ、σ2、γ、β为归一化层参数，μ为批量均值，σ为批量标准差，ε为常数小量，用于避免除零错误，γ、β为归一化层训练时的学习参数，分别称为缩放系数和偏移。本发明技术方案步骤E包括：将训练好的神经网络模型部署在智能计算平台上，对输入的云背景红外目标进行智能检测，计算平台包括计算机、嵌入式设备、ASIC等。本发明技术方案步骤F包括：提取实际图像中云背景下红外目标的小尺寸图像，将其添加到数据集中进行补充训练，以提高神经网络对实际场景的适应能力。本发明与现有技术相比的优点在于：本发明提出一种智能的神经网络训练方式，通过建立红外目标和云背景的参数化模型，以增量式自学习的训练方式有选择地扩充仿真数据库，只向训练数据集添加网络检测精度较差的随机仿真图像，从而降低了重复或相似数据的冗余度，提高了数据库的效率，减少了网络对实际红外数据库的依赖；本发明使用小尺寸图像作为训练集，相比用大尺寸原始图像作为训练集，数据库的容量更小，网络训练所占用的硬件资源更少、训练速度更快，且小尺寸图像里有效目标相比背景的占比提高，提高了训练效率；本发明采用改进锚框方式，在基础锚框的基础上增加第二类锚框，确保同一目标被两类锚框同时检测，提高了移动目标在锚框交接过程中的连续性。附图说明图1为本发明实施例公开的一种用于云背景下红外目标智能训练和检测方法流程图；图2为本发明实施例公开的随机生成的仿真目标图示例；图3为本发明实施例公开的随机生成的仿真云背景图示例；图4为本发明实施例公开的神经网络模型示意图；图5为本发明实施例公开的改进锚框示意图；图5中，A图为原始锚框示意图，B图为重叠锚框示意图；图6为本发明实施例公开的神经网络训练数据集增量式自学习流程图。具体实施方式下面结合附图详细说明本发明的实施例。本发明一种用于云背景下红外目标的智能训练和检测方法的流程图如图1所示，具体实施步骤包括：步骤A，对红外目标和云背景进行参数化建模，按照特征参数随机生成小尺寸图像的初始化训练数据集；在此数据集中，训练集由仿真生成的红外目标和云背景图片组合成成。针对目标的数量、大小、形态、强度、噪声、位置以及速度等特征一般不是稳定值的这一特点，在参数化仿真过程中，采用特征参数区间随机分布算法对目标进行模拟仿真。随机生成的仿真目标能模拟出各项特征参数随机组合的情况，使目标数据覆盖各种变化情况，提高神经网络的泛化能力。图2为仿真生成的目标图示例。针对云背景一般为天空和云的情况，在参数化仿真过程中，采用随机种子梯度分布算法对云图进行模拟仿真，特征参数包括云的大小、强度、噪声、位置、速度以及随机种子等，随机生成的仿真云背景能模拟出各项特征参数随机组合的情况，使云背景数据覆盖各种变化情况，提高神经网络的泛化能力。图3为仿真生成的云背景图示例。此发明实施例中实际图像尺寸为640x512x3，为减少数据集容量、提高网络训练效率，上述步骤中所生成的训练图像尺寸为80x80x3的小尺寸图像。步骤B，神经网络模型示意图如附图4所示。整个神经网络共31层，包括多个卷积层，深度可分离卷积层，归一化层，激活函数层等。具体地，设置输入层参数，输入层大小为训练数据的长、宽、通道数为80x80x3。在实施例中构造神经网络时运用了1×1卷积层，其结构简单参数少，具有升高、降低特征维信息的能力，同时可以大幅度降低网络参数量，提高网络效率。同样地，在实施例中构造神经网络时运用了深度可分离卷积层。相比于普通卷积，深度可分离卷积所需要执行的卷积计算次数更少，参数量更少，且能对时间维特征和空间维特征进行解耦，提高神经网络的检测性能。除此之外，在实施例中构造神经网络时采用卷积池化，即通过设置卷积层步长和填充因子来代替池化层达到池化的目的，用特征维的扩展弥补空间维的减少，有利于保留目标的细节特征。在实施例中构造神经网络时输出层的损失函数的形式如下式所示。Loss＝Loss1+Loss2 其中，Loss1为连续量损失函数：Loss1＝)2；Loss2为逻辑量损失函数：Loss2＝-1*T2*log-)；Zn为网络的归一化输出值；Tn为标签真值。在实施例中构造神经网络时采用互补锚框以解决移动目标锚框交接不连续的问题。如图5中A图所示，常规锚框可以处理内部目标，但当目标移动到锚框的边界，如边界和所在的位置，会出现锚框目标交接的问题，即上一个锚框可能已经不输出目标，但下一个锚框还未检测出目标，造成目标连续检测过程中目标中断。为了解决这一问题，此发明提出互补双锚框技术，在第一类锚框的基础上增加第二类锚框，第二类锚框的位置相比第一类锚框有50％的位移，如图5中B图所示。经过实验验证，互补锚框技术可以大幅提高边界目标的检出概率，从而为目标连续跟踪提供技术保障。步骤C，在训练刚开始时初始数据集的数量较小，达到设定的训练精度后用训练得到的网络对随机生成的图像和标签进行检测并计算损失值，忽略损失值小于设定阈值的图像，将损失函数大于设定阈值的随机图像和标签添加到训练数据集中，如此不断迭代训练，最终得以仿真的云背景下红外目标训练集。本发明神经网络智能自学习的流程图如图6所示。步骤D，本发明实施例步骤C中使用的是小尺寸图像的训练集和神经网络，为了使网络能够应用到大图尺寸进行目标检测，需要对网络模型参数进行图像尺寸变换和去归一化层结构改造。因本发明的卷积神经网络学习到的网络参数主要是卷积层权重参数和归一化层参数，与输入图像尺寸大小无关，做图像尺寸变换主要是修改输入和输出层的数据维度，输入层的图像尺寸从80x80x3修改为640x512x3，输出层的特征尺度从5x5x40修改为40x32x40。批归一化层是一个主要包括数据平移与缩放的线性操作层，可以将神经网络中的批归一化层去掉，将此线性操作叠加到上一层的卷积层中。首先读取训练得到的神经网络卷积层权重偏置参数和归一化层参数，然后用公式更新卷积层的权重和偏置参数，删除归一化层，连接归一层上下两层，这样就得到可用于实际图像尺寸的卷积神经网络。步骤E，利用训练得到的深度神经网络进行目标检测。在本发明中，最后将训练好的神经网络模型部署到深度学习嵌入式处理单元上，这种设备因为底层硬件处理单元的优化，非常适用于深度学习网络模型的推理运算。步骤F，为可选步骤，提取实际图像中云背景下红外目标的小尺寸图像，将其添加到训练数据集中进行补充训练，以提高神经网络对实际场景的适应能力。本发明提供了一种用于云背景下红外目标的智能检测方法，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。本发明中涉及到的本领域公知技术未详细阐述。
