标题title
一种基于主动学习的退役电池剩余容量估计方法
摘要abst
本发明公开了一种基于主动学习的退役电池剩余容量估计方法，将主动学习策略和贝叶斯深度学习结合，从未循环至报废的电池中挑选出对模型性能提升最有帮助的电池，终止其余电池的退化，从而节省获得高精度退役电池剩余容量估计模型的代价。通过将主动学习技术应用于退役电池剩余容量估计领域，大大降低了退役电池剩余容量估计模型的构建成本。在使用少量退役电池失效样本的情况下，保证退役电池剩余容量模型估计的精度，减少需要退化完全的电池样本数量，节省了电力、人力等资源。
权利要求书clms
1.一种基于主动学习的退役电池剩余容量估计方法，其特征在于，该方法包括如下步骤：步骤1：采集少量循环至报废的电池退化数据，对有标签的电池退化数据进行预处理，将处理完毕的特征以及对应标签放入初始训练数据集；步骤2：将采集得到的大量未报废退役电池历史退化数据进行预处理，将提取得到的特征放入数据备选池；步骤3：根据所述初始训练数据集的特征类型选择贝叶斯神经网络架构，并使用初始训练集训练贝叶斯神经网络模型；步骤4：使用步骤3中预训练完成的贝叶斯神经网络模型对所述数据备选池中的数据进行测试，以获得数据备选池中每个退役电池的不确定性，挑选出少量不确定性大的电池；步骤5：将步骤4中挑选得到的少量电池循环至报废，将数据进行预处理后加入训练数据集；步骤6：使用步骤5中更新后的训练数据集，重新训练贝叶斯神经网络模型；步骤7：重复步骤4、5和6，直到模型估计退役电池剩余容量的精度符合要求。2.如权利要求1所述的一种基于主动学习的退役电池剩余容量估计方法，其特征在于：所述步骤1中所述的对少量循环至报废的电池退化数据进行预处理，所述数据预处理方法包括：对电池的充电以及放电过程中的电流电压曲线进行提取，提取电流电压曲线中和电池退化高度相关的特征，最后对提取的特征进行归一化处理；其中，所述电流电压曲线中和电池退化高度相关的特征至少包括充电至最高电压所需时间、放电至某个特定电压所需时间、某个特定电压的电流。3.如权利要求1所述的一种基于主动学习的退役电池剩余容量估计方法，其特征在于：所述步骤1中所述的将处理完毕的特征以及对应标签放入初始训练集，具体方法包括：将每个循环的特征和每个循环的剩余容量相匹配，标注完毕的电池退化数据划入训练集。4.如权利要求1所述的一种基于主动学习的退役电池剩余容量估计方法，其特征在于：所述步骤2中所述的对大量未报废退役电池历史退化数据进行预处理，所述数据预处理方法包括：提取电池充电以及放电过程中的电流电压曲线，提取步骤1中相同的特征，并对特征进行归一化处理。5.如权利要求1所述的一种基于主动学习的退役电池剩余容量估计方法，其特征在于：步骤3中所述的根据初始训练数据集的特征类型选择贝叶斯神经网络架构，具体方法为：根据初始训练数据集的特征，采用输入层个数为特征维数的贝叶斯全连接神经网络，网络有3个全连接层，每个全连接层中都使用Dropout层随机丢弃部分神经元的输出，输出层输出退役电池的剩余容量。6.如权利要求1所述的一种基于主动学习的退役电池剩余容量估计方法，其特征在于：步骤4中所述的预训练完成的贝叶斯神经网络模型对数据备选池中的数据进行测试，以获得数据备选池中每个退役电池的不确定性，其具体方法为：使用训练完毕的贝叶斯神经网络，输入备选池中每个电池的特征，在测试时将Dropout打开，使得每次的输出都是一次对剩余容量分布抽样的结果，测试N次以近似获得输出的分布，计算这N次测试结果的方差，用方差表示此退役电池剩余容量预测的不确定性，即a：式中，X为输入的电池特征，Y为模型输出，σ2为输出分布的方差，a为主动学习的挑选函数。7.如权利要求1所述的一种基于主动学习的退役电池剩余容量估计方法，其特征在于：所述步骤5中所述的挑选得到的少量电池循环至报废，将数据进行预处理后加入训练数据集，其具体方法为：挑选不确定性最大的少量退役电池，将退役电池循环至报废，获得退役电池的全部退化循环数据，提取数据中的特征，标注好剩余容量标签后加入训练集。
说明书desc
技术领域本发明涉及电池预测与健康管理技术领域，尤其涉及一种基于主动学习的退役电池剩余容量估计方法。背景技术随着新能源汽车领域的高速发展，电动汽车保有量正在逐年上升。作为电动汽车唯一的动力源，动力电池的容量会随着电动汽车的使用过程逐渐衰减，当电池的剩余容量衰退至其原本容量的80％时就已需要更换。而如何处理替换下来的电动汽车退役电池成为一大难题，这些退役电池还具备电池储电、放电的功能，为了最大化利用动力电池的生命周期，退役电池往往会应用在别的场景里，如储能场景，最大化利用了动力电池的周期价值。为了将退役电池应用于其它领域，需要对退役电池进行一致性分选，获取退役电池的剩余容量。而对于退役电池来说，在其生命周期的第一阶段中，缺少了单体电池的使用历史数据，为了全面评估单体退役电池的情况，在对退役电池的性能进行基准测试后，还需要准确估计退役电池的剩余容量。在以往的退役电池剩余容量估计中，往往是在实验室内先开展对于某一型号的新电池性能退化试验，以获得新电池完整的性能退化数据，基于数据进行建模，建立用于电池剩余容量估计的模型。为了满足退役电池剩余容量估计的需求，需要退化大量循环至报废的电池退化数据，才能获得一个能够精准估计退役电池剩余容量的深度学习模型。电池的容量衰退至额定容量的60％才认为其生命周期完全结束，这就意味着为了获得大量的电池退化数据，需要耗费大量的测试资源、人力，以及耗费大量的电，获得足够的退役电池样本的过程过于昂贵。发明内容有鉴于现有技术的上述缺陷，本发明所要解决的技术问题是提供一种基于主动学习的退役电池剩余容量估计方法，针对退役电池性能退化数据获取代价高、深度学习模型所需的训练样本多的问题，将主动学习策略和贝叶斯深度学习结合，从未循环至报废的电池中挑选出对模型性能提升最有帮助的电池，终止其余电池的退化，从而节省获得高精度退役电池剩余容量估计模型的代价。为实现上述目的，本发明提供了一种基于主动学习的退役电池剩余容量估计方法，该方法包括如下步骤：步骤1：采集少量循环至报废的电池退化数据，对有标签的电池退化数据进行预处理，将处理完毕的特征以及对应标签放入初始训练数据集；步骤2：将采集得到的大量未报废退役电池历史退化数据进行预处理，将提取得到的特征放入数据备选池；步骤3：根据所述初始训练数据集的特征类型选择贝叶斯神经网络架构，并使用初始训练集训练贝叶斯神经网络模型；步骤4：使用步骤3中预训练完成的贝叶斯神经网络模型对所述数据备选池中的数据进行测试，以获得数据备选池中每个退役电池的不确定性，挑选出少量不确定性大的电池；步骤5：将步骤4中挑选得到的少量电池循环至报废，将数据进行预处理后加入训练数据集；步骤6：使用步骤5中更新后的训练数据集，重新训练贝叶斯神经网络模型；步骤7：重复步骤4、5和6，直到模型估计退役电池剩余容量的精度符合要求。进一步的，所述步骤1中所述的对少量循环至报废的电池退化数据进行预处理，所述数据预处理方法包括：对电池的充电以及放电过程中的电流电压曲线进行提取，提取电流电压曲线中和电池退化高度相关的特征，最后对提取的特征进行归一化处理；其中，所述电流电压曲线中和电池退化高度相关的特征至少包括充电至最高电压所需时间、放电至某个特定电压所需时间、某个特定电压的电流。进一步的，所述步骤1中所述的将处理完毕的特征以及对应标签放入初始训练集，具体方法包括：将每个循环的特征和每个循环的剩余容量相匹配，标注完毕的电池退化数据划入训练集。进一步的，所述步骤2中所述的对大量未报废退役电池历史退化数据进行预处理，所述数据预处理方法包括：提取电池充电以及放电过程中的电流电压曲线，提取步骤1中相同的特征，并对特征进行归一化处理。进一步的，步骤3中所述的根据初始训练数据集的特征类型选择贝叶斯神经网络架构，具体方法为：根据初始训练数据集的特征，采用输入层个数为特征维数的贝叶斯全连接神经网络，网络有3个全连接层，每个全连接层中都使用Dropout层随机丢弃部分神经元的输出，输出层输出退役电池的剩余容量。进一步的，步骤4中所述的预训练完成的贝叶斯神经网络模型对数据备选池中的数据进行测试，以获得数据备选池中每个退役电池的不确定性，其具体方法为：使用训练完毕的贝叶斯神经网络，输入备选池中每个电池的特征，在测试时将Dropout打开，使得每次的输出都是一次对剩余容量分布抽样的结果，测试N次以近似获得输出的分布，计算这N次测试结果的方差，用方差表示此退役电池剩余容量预测的不确定性，即a：式中，X为输入的电池特征，Y为模型输出，σ2为输出分布的方差，a为主动学习的挑选函数。进一步的，所述步骤5中所述的挑选得到的少量电池循环至报废，将数据进行预处理后加入训练数据集，其具体方法为：挑选不确定性最大的少量退役电池，将退役电池循环至报废，获得退役电池的全部退化循环数据，提取数据中的特征，标注好剩余容量标签后加入训练集。本发明的有益效果是：1、本发明构建了一种基于主动学习的退役电池剩余容量估计方法，通过将主动学习技术应用于退役电池剩余容量估计领域，大大降低了退役电池剩余容量估计模型的构建成本。在使用少量退役电池失效样本的情况下，保证退役电池剩余容量模型估计的精度，减少需要退化完全的电池样本数量，节省了电力、人力等资源。2、本发明将贝叶斯定理应用于深度学习，在尽量保证退役电池剩余容量估计精度的同时，获得退役电池剩余容量估计的置信区间，为剩余容量估计结果的可靠度提供参考。具体地，如果贝叶斯神经网络输出的退役电池剩余容量估计不确定性较大，这个网络对这个电池的剩余容量的估计结果并不自信，这就表明这个退役电池的剩余容量估计结果可能并不准确。置信区间的存在为决策者提供了更多信息，决定这个退役电池是否需要更多的检测，这个退役电池的剩余容量需要注意。3、经过实验验证，使用本发明提出的基于主动学习的退役电池剩余容量估计方法，只需少部分电池的性能退化数据，就能和使用全部电池退化数据的效果相比。基于主动学习的退役电池剩余容量估计框架能在全部样本中，挑选最具有信息量的样本以供模型训练，以样本的质量补充样本的数量，在尽量减少样本数量的情况下获得高精度的退役电池剩余容量估计方法。以下将结合附图对本发明的构思、具体结构及产生的技术效果作进一步说明，以充分地了解本发明的目的、特征和效果。附图说明图1为本发明整体框架示意图，其中椭圆形框代表整体框架的输入输出，矩形框代表流程，箭头指向流程开展的顺序，菱形框代表判断，数据集框代表数据集。图2为本发明示例所采用的六个电池的循环至报废剩余容量示意图。图3为本发明所采用的贝叶斯全连接结构示意图。图4为以电池#1为测试数据集的主动学习策略下，训练电池数量增多的剩余容量估计效果。图5为六个电池分别为测试电池时，在主动学习策略下，训练电池数量增多时模型剩余容量估计效果。具体实施方式本发明提供了一种基于主动学习的退役电池剩余容量估计方法，该方法包括如下步骤：步骤1：采集少量循环至报废的电池退化数据，对有标签的电池退化数据进行预处理，将处理完毕的特征以及对应标签放入初始训练数据集；步骤2：将采集得到的大量未报废退役电池历史退化数据进行预处理，将提取得到的特征放入数据备选池；步骤3：根据所述初始训练数据集的特征类型选择贝叶斯神经网络架构，并使用初始训练集训练贝叶斯神经网络模型；步骤4：使用步骤3中预训练完成的贝叶斯神经网络模型对所述数据备选池中的数据进行测试，以获得数据备选池中每个退役电池的不确定性，挑选出少量不确定性大的电池；步骤5：将步骤4中挑选得到的少量电池循环至报废，将数据进行预处理后加入训练数据集；步骤6：使用步骤5中更新后的训练数据集，重新训练贝叶斯神经网络模型；步骤7：重复步骤4、5和6，直到模型估计退役电池剩余容量的精度符合要求。本实施例中，所述步骤1中所述的对少量循环至报废的电池退化数据进行预处理，所述数据预处理方法包括：对电池的充电以及放电过程中的电流电压曲线进行提取，提取电流电压曲线中和电池退化高度相关的特征，最后对提取的特征进行归一化处理；其中，所述电流电压曲线中和电池退化高度相关的特征至少包括充电至最高电压所需时间、放电至某个特定电压所需时间、某个特定电压的电流。本实施例中，所述步骤1中所述的将处理完毕的特征以及对应标签放入初始训练集，具体方法包括：将每个循环的特征和每个循环的剩余容量相匹配，标注完毕的电池退化数据划入训练集。本实施例中，所述步骤2中所述的对大量未报废退役电池历史退化数据进行预处理，所述数据预处理方法包括：提取电池充电以及放电过程中的电流电压曲线，提取步骤1中相同的特征，并对特征进行归一化处理。本实施例中，步骤3中所述的根据初始训练数据集的特征类型选择贝叶斯神经网络架构，具体方法为：根据初始训练数据集的特征，采用输入层个数为特征维数的贝叶斯全连接神经网络，网络有3个全连接层，每个全连接层中都使用Dropout层随机丢弃部分神经元的输出，输出层输出退役电池的剩余容量。本实施例中，步骤4中所述的预训练完成的贝叶斯神经网络模型对数据备选池中的数据进行测试，以获得数据备选池中每个退役电池的不确定性，其具体方法为：使用训练完毕的贝叶斯神经网络，输入备选池中每个电池的特征，在测试时将Dropout打开，使得每次的输出都是一次对剩余容量分布抽样的结果，测试N次以近似获得输出的分布，计算这N次测试结果的方差，用方差表示此退役电池剩余容量预测的不确定性，即a：式中，X为输入的电池特征，Y为模型输出，σ2为输出分布的方差，a为主动学习的挑选函数。本实施例中，所述步骤5中所述的挑选得到的少量电池循环至报废，将数据进行预处理后加入训练数据集，其具体方法为：挑选不确定性最大的少量退役电池，将退役电池循环至报废，获得退役电池的全部退化循环数据，提取数据中的特征，标注好剩余容量标签后加入训练集。图1展示了本发明提出的基于主动学习的退役电池剩余容量估计方法框架。本发明整体框架示意图中，椭圆形框代表整体框架的输入输出，矩形框代表流程，箭头指向流程开展的顺序，菱形框代表判断，数据集框代表不同的数据集。以下对框架内数据预处理方法、贝叶斯深度学习方法、主动学习挑选策略进行详细说明，并使用真实循环到报废电池退化数据集对主动学习方法进行实例。一、数据预处理方法对电池退化数据集进行预处理主要分为3个步骤：提取每个循环的充放电的电流、电压数据，提取出电流、电压数据的特征，对特征进行归一化处理。处理细节如下：对电池退化数据集进行预处理，首先是从电池的退化数据中提取出每个循环的充放电电流、电压数据。在本发明的实验过程中，为了确保电池退化至报废，6个容量为2Ah的实验电池进行了1000次的退化循环，确保电池在退化后的剩余容量达到报废的标准，每个电池实验后的剩余容量低至1.2Ah。6个实验电池的每个循环的剩余容量如图2所示，6个电池分别记为#1、#2、#3、#4、#5和#6。在提取出电池的充放电电流、电压数据后，从数据中提取特征。在本发明的实验中，对于6个实验电池的退化数据，提取了12个与电池退化高度相关的特征，如表1所示：表1提取的电池退化特征提取特征后，需要对电池的退化特征进行归一化处理，归一化处理后的特征处于同一量级，能提高模型剩余容量估计精度：式中，为归一化后的特征，x为归一化前的特征，min和max分别为特征中的最小值和最大值，归一化公式将特征压缩至-1到1之间。对于有标签数据预处理，需要提取每个循环数据中的特征，并提取每个循环的电池剩余容量，并与电池退化数据每个循环的特征相匹配；对于无标签数据预处理，需要提取每个循环数据中的特征，无需提取每个循环的电池剩余容量。二、贝叶斯深度学习贝叶斯深度学习和普通深度学习不同的地方在于，贝叶斯深度学习将神经网络中的每一个参数都视为随机变量，普通的神经网络输出的是值，而贝叶斯神经网络输出的是概率分布。本发明的贝叶斯深度学习采用贝叶斯全连接神经网络，神经网络的结构如图3所示。其中“Linear”全连接层，括号内的第一个数字12表示输入维度，括号内第二个数字100表示输出维度；“ReLu”为线性整流激活函数，当输入激活函数的值小于0时，激活函数未被激活，输出为0，当输入的值大于1时，激活函数激活，直接输出该值；“Dropout”为Dropout层，以0.2的概率随机丢弃神经元。为了训练贝叶斯全连接神经网络，本发明中采用的是近似变分推断方法，使用伯努利分布代替原有神经网络的权重。即训练时打开Dropout层，在测试时也打开Dropout层，测试N次，将获得N次不同的输出结果，N次结果的组合即为输出的概率分布。三、主动学习挑选策略主动学习是一种机器学习技术，通过设置的采样策略，从大量未标记的样本点中挑选出最值得被标记的少量样本，以减少模型的训练成本。在每次挑选出蕴含信息量最大的样本后，对这个样本进行标记，再将标记好的样本加入训练数据集，以此迭代进行数据的挑选以及模型的训练。由于主动学习中采样策略的设置，被挑选出来的样本往往是不确定性最大、信息含量最高的数据，可以大幅度提升模型的性能。本发明中主动学习策略采用“不确定性”挑选策略。对于贝叶斯神经网络的输出分布，采用输出概率分布的方差量化样本的不确定性衡量准则：其中，σ2为输出分布的方差，a为主动学习的挑选函数。方差越大，输出的不确定性越大，表明概率分布的范围越广，表示模型对这个电池的剩余容量的估计结果并不自信，这个电池退化情况模型不能掌控。此时需要将这个不确定性最大的电池挑出：式中，U表示数据备选池，X为数据备选池中的一个电池，X*表示从数据备选池中挑选出的一个不确定性最大的一个电池。将这个不确定性最大的电池循环至报废，再给每个循环打上剩余容量的标签，将这个电池每个循环的退化特征以及对于标签划入训练集，重新训练贝叶斯全连接神经网络。据图1基于主动学习的退役电池剩余容量估计框架所示，本发明的具体流程为：1、采集少量循环至报废的电池退化数据，对有标签的电池退化数据进行预处理，将处理完毕的特征以及对应标签放入初始训练数据集；2、将采集得到的大量未报废退役电池历史退化数据进行预处理，将提取得到的特征放入数据备选池；3、根据初始训练集的特征类型选择贝叶斯神经网络架构，并使用初始训练集训练贝叶斯神经网络模型；4、使用步骤3中预训练完成的贝叶斯神经网络模型对数据备选池中的数据进行测试，以获得数据备选池中每个退役电池的不确定性，挑选出少量不确定性大的电池；5、将步骤4中挑选得到的少量电池循环至报废，将数据进行预处理后加入训练数据集；6、使用步骤5中更新后的训练数据集，重新训练贝叶斯神经网络模型；7、重复步骤4、5和6，直到模型估计退役电池剩余容量的精度符合要求。在本发明的实验过程中，选取电池#6作为测试电池，测试模型效果。随机选择电池#6作为实验室同类型新电池循环至报废数据，将电池#1的性能退化数据进行有标签数据预处理后放入训练数据集内。剩余的4个电池#2、#3、#4、#5经无标签数据处理后放入数据备选池内。使用训练数据集训练3层的贝叶斯全连接神经网络，并使用网格搜索方法，将神经网络的超参数学习率设置为0.0005、迭代次数设置为500次。在贝叶斯神经网络训练完成后，使用数据备选池内的5个电池分别进行测试，挑选出不确定性最大的电池。将挑选出来的电池经过有标签数据预处理后，放入训练数据集，重新训练贝叶斯神经网络。每次模型更新后测试不同电池的不确定性如表2所示：表2模型更新后数据备选池内电池不确定性依据主动学习“不确定性”挑选规则，电池#2、#5、#4、#3依次加入训练集。每次训练结束后，电池#1的测试结果如图3所示。图中虚线代表剩余容量真实值，中间的实线代表剩余容量估计值，上下两条实线代表估计结果的95％置信区间。从图中就可以看到，第三次训练结果的模型估计精度已达到要求，与所有电池数据一起加入训练集的训练结果相当。仅用3个电池的效果已经可以和使用6个电池的效果相比，这代表着在第三次训练后剩余的3个电池即可不再循环老化，节约了3个电池循环老化所花费的电力、人力等资源，为同类型的电池退役电池的剩余容量估计提供一个高精度贝叶斯深度学习模型。此外，为了验证本发明的有效性，实验使用留一验证法。分别将每一个电池作为测试集，剩余所有电池放入数据备选池，进行了一共六组实验。实验结果如图5所示，采用均方误差和平均绝对值误差作为精度衡量标准，均方误差和平均绝对值误差越小代表模型进度越高。每个电池分别作为测试集时，采用主动学习“不确定性”挑选策略进行挑选，剩余5个电池加入数据备选池的顺序如表3所示。表3选入数据备选池电池顺序从实验结果可知，当采用主动学习策略训练电池剩余容量估计方法时，只采用50％至80％的电池样本就可以代替整体电池样本数据集，减少了所需的训练样本数量，为退役电池的剩余容量估计模型训练节省了成本。本发明提出了一种基于主动学习的退役电池剩余容量估计方法，以上所述仅为本发明的优选实施方案，并不用于限制本发明，在不脱离本发明的前提内作出的改进和润饰均包含在本发明的保护范围内。以上详细描述了本发明的较佳具体实施例。应当理解，本领域的普通技术人员无需创造性劳动就可以根据本发明的构思做出诸多修改和变化。因此，凡本技术领域中技术人员依本发明的构思在现有技术的基础上通过逻辑分析、推理或者有限的实验可以得到的技术方案，皆应在由权利要求书所确定的保护范围内。
