标题title
数据恢复方法、装置、电子设备及存储介质
摘要abst
本申请涉及一种数据恢复方法、装置、电子设备及存储介质，应用于数据存储技术领域，所述方法包括：监测源存储节点中的数据恢复任务，并获取目标数据恢复任务的第一任务数量；如果第一任务数量小于等于第一预设数量，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使第一目的存储节点根据第一恢复信息将第一磁盘中的所有待恢复数据恢复至第一目的存储节点；或者，如果第一任务数量大于第一预设数量，分多次向第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使第一目的存储节点根据单个第二恢复信息将第一磁盘中的部分待恢复数据恢复至第一目的存储节点。本申请可以提高数据存储服务的可靠性。
权利要求书clms
1.一种数据恢复方法，其特征在于，应用于控制节点，所述方法包括：监测源存储节点中的数据恢复任务，并获取目标数据恢复任务的第一任务数量；其中，所述目标数据恢复任务为所述源存储节点中针对单个第一磁盘的数据恢复任务；如果所述第一任务数量小于等于第一预设数量，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使所述第一目的存储节点根据所述第一恢复信息将所述第一磁盘中的所有待恢复数据恢复至所述第一目的存储节点；或者，如果所述第一任务数量大于所述第一预设数量，分多次向所述第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使所述第一目的存储节点根据单个所述第二恢复信息将所述第一磁盘中的部分待恢复数据恢复至所述第一目的存储节点；其中，所述第一磁盘在数据恢复的各个时刻对应的目标数据恢复任务的数量均小于所述第一预设数量。2.根据权利要求1所述的方法，其特征在于，所述方法还包括：获取所述源存储节点中数据恢复任务的第二任务数量；如果所述第二任务数量小于等于第二预设数量，执行所述获取目标数据恢复任务的第一任务数量的步骤；其中，所述第二预设数量大于等于所述第一预设数量，或者，如果所述第二任务数量大于所述第二预设数量，分多次向第二目的存储节点发送包含不同数据恢复任务的第三恢复信息，以使所述第二目的存储节点根据单个所述第三恢复信息将所述源存储节点中的部分待恢复数据恢复至所述第二目的存储节点；其中，所述源存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第二预设数量。3.根据权利要求1或2所述的方法，其特征在于，所述分多次向所述第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，包括：在向所述第一目的存储节点发送单个第二恢复信息后，如果监测到所述第一磁盘当前对应的目标数据恢复任务的数量小于所述第一预设数量，向所述第一目的存储节点发送下一个第二恢复信息。4.根据权利要求1所述的方法，其特征在于，所述方法还包括：监测所述第一目的存储节点中的数据恢复任务，获取所述第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量；如果所述第三任务数量小于等于第三预设数量，向所述第一目的存储节点发送包含针对所述第二磁盘的所有数据恢复任务的第四恢复信息，以使所述第一目的存储节点根据所述第四恢复信息将待恢复至所述第二磁盘中的所有数据恢复至所述第二磁盘；如果所述第三任务数量大于所述第三预设数量，分多次向所述第一目的存储节点发送包含针对所述第二磁盘的不同数据恢复任务的第五恢复信息，以使所述第一目的存储节点根据单个所述第五恢复信息将待恢复至所述第二磁盘中的部分数据恢复至所述第二磁盘；其中，所述第二磁盘在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第三预设数量。5.根据权利要求4所述的方法，其特征在于，所述方法还包括：获取所述第一目的存储节点中数据恢复任务的第四任务数量；如果所述第四任务数量小于等于第四预设数量，执行所述获取所述第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量的步骤；其中，所述第四预设数量大于等于所述第三预设数量；如果所述第四任务数量大于所述第四预设数量，分多次向所述第一目的存储节点发送包含针对所述第一目的存储节点中不同数据恢复任务的第六恢复信息，以使所述第一目的存储节点基于单个所述第六恢复信息，将待恢复至所述第一目的存储节点的部分数据恢复至所述第一目的存储节点；其中，所述第一目的存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第四预设数量。6.根据权利要求1所述的方法，其特征在于，所述方法还包括：获取多个候选存储节点分别对应的存储信息，其中，所述存储信息包括：存储空间信息和已存储数据的相关信息；根据所述存储空间信息和所述已存储数据的相关信息，从多个候选存储节点中选取所述第一目的存储节点。7.根据权利要求1所述的方法，其特征在于，所述源存储节点和所述第一目的存储节点中数据的存储方式包括：三副本的存储方式和/或纠删码的存储方式。8.一种数据恢复装置，其特征在于，应用于控制节点，所述装置包括：第一任务数量获取模块，用于监测源存储节点中的数据恢复任务，并获取目标数据恢复任务的第一任务数量；其中，所述目标数据恢复任务为所述源存储节点中针对单个第一磁盘的数据恢复任务；第一恢复信息发送模块，用于如果所述第一任务数量小于等于第一预设数量，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使所述第一目的存储节点根据所述第一恢复信息将所述第一磁盘中的所有待恢复数据恢复至所述第一目的存储节点；或者，第二恢复信息发送模块，用于如果所述第一任务数量大于所述第一预设数量，分多次向所述第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使所述第一目的存储节点根据单个所述第二恢复信息将所述第一磁盘中的部分待恢复数据恢复至所述第一目的存储节点；其中，所述第一磁盘在数据恢复的各个时刻对应的目标数据恢复任务的数量均小于所述第一预设数量。9.一种电子设备，其特征在于，包括：处理器，所述处理器用于执行存储于存储器的计算机程序，所述计算机程序被处理器执行时实现权利要求1-7任一项所述的数据恢复方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1-7任一项所述的数据恢复方法的步骤。
说明书desc
技术领域本申请涉及数据存储技术领域，尤其涉及一种数据恢复方法、装置、电子设备及存储介质。背景技术对象存储S3是一种高可靠的分布式云存储服务，可以为用户解决存储扩容、数据可靠安全以及分布式访问等相关复杂问题。用户可以使用S3，通过RESTful API便捷地存储和获取图片、音频、视频、文本等各类数据文件。为了保证分布式环境下数据存储的可靠性，可以对存储的数据进行备份，从而在发生数据缺失的情况下可以进行恢复。然而，随着恢复任务的增多，较多的数据恢复任务会影响存储服务，导致数据存储服务的可靠性较低。发明内容为了解决上述技术问题，本申请提供了一种数据恢复方法、装置、电子设备及存储介质。根据本申请的第一方面，提供了一种数据恢复方法，应用于控制节点，包括：监测源存储节点中的数据恢复任务，并获取目标数据恢复任务的第一任务数量；其中，所述目标数据恢复任务为所述源存储节点中针对单个第一磁盘的数据恢复任务；如果所述第一任务数量小于等于第一预设数量，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使所述第一目的存储节点根据所述第一恢复信息将所述第一磁盘中的所有待恢复数据恢复至所述第一目的存储节点；或者，如果所述第一任务数量大于所述第一预设数量，分多次向所述第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使所述第一目的存储节点根据单个所述第二恢复信息将所述第一磁盘中的部分待恢复数据恢复至所述第一目的存储节点；其中，所述第一磁盘在数据恢复的各个时刻对应的目标数据恢复任务的数量均小于所述第一预设数量。可选的，所述方法还包括：获取所述源存储节点中数据恢复任务的第二任务数量；如果所述第二任务数量小于等于第二预设数量，执行所述获取目标数据恢复任务的第一任务数量的步骤；其中，所述第二预设数量大于等于所述第一预设数量，或者，如果所述第二任务数量大于所述第二预设数量，分多次向第二目的存储节点发送包含不同数据恢复任务的第三恢复信息，以使所述第二目的存储节点根据单个所述第三恢复信息将所述源存储节点中的部分待恢复数据恢复至所述第二目的存储节点；其中，所述源存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第二预设数量。可选的，所述分多次向所述第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，包括：在向所述第一目的存储节点发送单个第二恢复信息后，如果监测到所述第一磁盘当前对应的目标数据恢复任务的数量小于所述第一预设数量，向所述第一目的存储节点发送下一个第二恢复信息。可选的，所述方法还包括：监测所述第一目的存储节点中的数据恢复任务，获取所述第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量；如果所述第三任务数量小于等于第三预设数量，向所述第一目的存储节点发送包含针对所述第二磁盘的所有数据恢复任务的第四恢复信息，以使所述第一目的存储节点根据所述第四恢复信息将待恢复至所述第二磁盘中的所有数据恢复至所述第二磁盘；如果所述第三任务数量大于所述第三预设数量，分多次向所述第一目的存储节点发送包含针对所述第二磁盘的不同数据恢复任务的第五恢复信息，以使所述第一目的存储节点根据单个所述第五恢复信息将待恢复至所述第二磁盘中的部分数据恢复至所述第二磁盘；其中，所述第二磁盘在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第三预设数量。可选的，所述方法还包括：获取所述第一目的存储节点中数据恢复任务的第四任务数量；如果所述第四任务数量小于等于第四预设数量，执行所述获取所述第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量的步骤；其中，所述第四预设数量大于等于所述第三预设数量；如果所述第四任务数量大于所述第四预设数量，分多次向所述第一目的存储节点发送包含针对所述第一目的存储节点中不同数据恢复任务的第六恢复信息，以使所述第一目的存储节点基于单个所述第六恢复信息，将待恢复至所述第一目的存储节点的部分数据恢复至所述第一目的存储节点；其中，所述第一目的存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第四预设数量。可选的，所述方法还包括：获取多个候选存储节点分别对应的存储信息，其中，所述存储信息包括：存储空间信息和已存储数据的相关信息；根据所述存储空间信息和所述已存储数据的相关信息，从多个候选存储节点中选取所述第一目的存储节点。可选的，所述源存储节点和所述第一目的存储节点中数据的存储方式包括：三副本的存储方式和/或纠删码的存储方式。根据本申请的第二方面，提供了一种数据恢复装置，应用于控制节点，包括：第一任务数量获取模块，用于监测源存储节点中的数据恢复任务，并获取目标数据恢复任务的第一任务数量；其中，所述目标数据恢复任务为所述源存储节点中针对单个第一磁盘的数据恢复任务；第一恢复信息发送模块，用于如果所述第一任务数量小于等于第一预设数量，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使所述第一目的存储节点根据所述第一恢复信息将所述第一磁盘中的所有待恢复数据恢复至所述第一目的存储节点；或者，第二恢复信息发送模块，用于如果所述第一任务数量大于所述第一预设数量，分多次向所述第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使所述第一目的存储节点根据单个所述第二恢复信息将所述第一磁盘中的部分待恢复数据恢复至所述第一目的存储节点；其中，所述第一磁盘在数据恢复的各个时刻对应的目标数据恢复任务的数量均小于所述第一预设数量。可选的，所述数据恢复装置，还包括：第二任务数量获取模块，用于获取所述源存储节点中数据恢复任务的第二任务数量；如果所述第二任务数量小于等于第二预设数量，通过第一任务数量获取模块执行所述获取目标数据恢复任务的第一任务数量的步骤；其中，所述第二预设数量大于等于所述第一预设数量，或者，第三恢复信息发送模块，用于如果所述第二任务数量大于所述第二预设数量，分多次向第二目的存储节点发送包含不同数据恢复任务的第三恢复信息，以使所述第二目的存储节点根据单个所述第三恢复信息将所述源存储节点中的部分待恢复数据恢复至所述第二目的存储节点；其中，所述源存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第二预设数量。可选的，所述第二恢复信息发送模块，具体用于如果所述第一任务数量大于所述第一预设数量，在向所述第一目的存储节点发送单个第二恢复信息后，如果监测到所述第一磁盘当前对应的目标数据恢复任务的数量小于所述第一预设数量，向所述第一目的存储节点发送下一个第二恢复信息。可选的，所述数据恢复装置，还包括：第三任务数量获取模块，用于监测所述第一目的存储节点中的数据恢复任务，获取所述第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量；第四恢复信息发送模块，用于如果所述第三任务数量小于等于第三预设数量，向所述第一目的存储节点发送包含针对所述第二磁盘的所有数据恢复任务的第四恢复信息，以使所述第一目的存储节点根据所述第四恢复信息将待恢复至所述第二磁盘中的所有数据恢复至所述第二磁盘；第五恢复信息发送模块，用于如果所述第三任务数量大于所述第三预设数量，分多次向所述第一目的存储节点发送包含针对所述第二磁盘的不同数据恢复任务的第五恢复信息，以使所述第一目的存储节点根据单个所述第五恢复信息将待恢复至所述第二磁盘中的部分数据恢复至所述第二磁盘；其中，所述第二磁盘在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第三预设数量。可选的，所述数据恢复装置，还包括：第四任务数量获取模块，用于获取所述第一目的存储节点中数据恢复任务的第四任务数量；如果所述第四任务数量小于等于第四预设数量，通过第三任务数量获取模块执行所述获取所述第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量的步骤；其中，所述第四预设数量大于等于所述第三预设数量；第六恢复信息发送模块，用于如果所述第四任务数量大于所述第四预设数量，分多次向所述第一目的存储节点发送包含针对所述第一目的存储节点中不同数据恢复任务的第六恢复信息，以使所述第一目的存储节点基于单个所述第六恢复信息，将待恢复至所述第一目的存储节点的部分数据恢复至所述第一目的存储节点；其中，所述第一目的存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于所述第四预设数量。可选的，所述数据恢复装置，还包括：存储信息获取模块，用于获取多个候选存储节点分别对应的存储信息，其中，所述存储信息包括：存储空间信息和已存储数据的相关信息；第一目的存储节点选取模块，用于根据所述存储空间信息和所述已存储数据的相关信息，从多个候选存储节点中选取所述第一目的存储节点。可选的，所述源存储节点和所述第一目的存储节点中数据的存储方式包括：三副本的存储方式和/或纠删码的存储方式。根据本申请的第三方面，提供了一种电子设备，包括：处理器，所述处理器用于执行存储于存储器的计算机程序，所述计算机程序被处理器执行时实现第一方面所述的方法。根据本申请的第四方面，提供了一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现第一方面所述的方法。根据本申请的第五方面，提供了一种计算机程序产品，当所述计算机程序产品在计算机上运行时，使得所述计算机执行第一方面所述的方法。本申请实施例提供的技术方案与现有技术相比具有如下优点：控制节点通过监测源存储节点中的数据恢复任务，获取源存储节点中单个第一磁盘中的数据恢复任务的第一任务数量，并根据第一任务数量来确定如何向第一目的存储节点发送恢复信息。例如，如果第一任务数量小于等于第一预设数量，可以发送第一恢复信息，从而使第一磁盘中的所有待恢复数据恢复至第一目的存储节点；如果第一任务数量大于第一预设数量，分多次向第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，也就是在数据恢复时限制第一磁盘中目标数据恢复任务的并发数量，从而避免在单个第一磁盘中出现大量的并发读请求，减小第一磁盘的处理压力，以保证正常的用户文件读取服务，提高系统的可用性。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本申请的实施例，并与说明书一起用于解释本申请的原理。为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，对于本领域普通技术人员而言，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1示出了可以应用于本申请实施例的数据恢复方法的示例性应用环境的系统架构的示意图；图2为本申请实施例中数据恢复方法的一种流程图；图3为本申请实施例中数据恢复方法的又一种流程图；图4为本申请实施例中数据恢复方法的又一种流程图；图5为本申请实施例中数据恢复装置的一种结构示意图；图6为本申请实施例中电子设备的一种结构示意图。具体实施方式为了能够更清楚地理解本申请的上述目的、特征和优点，下面将对本申请的方案进行进一步描述。需要说明的是，在不冲突的情况下，本申请的实施例及实施例中的特征可以相互组合。在下面的描述中阐述了很多具体细节以便于充分理解本申请，但本申请还可以采用其他不同于在此描述的方式来实施；显然，说明书中的实施例只是本申请的一部分实施例，而不是全部的实施例。图1示出了可以应用于本申请实施例的数据恢复方法的示例性应用环境的系统架构的示意图。如图1所示，系统架构100可以包括控制节点101、源存储节点102、源存储节点103、源存储节点104、目的存储节点105、目的存储节点106和目的存储节点107。网络用以在源存储节点102、源存储节点103、源存储节点104和控制节点101之间，以及控制节点101和目的存储节点105、目的存储节点106、目的存储节点107之间提供通信链路的介质。网络可以包括各种连接类型，例如有线、无线通信链路或者光纤电缆等等。源存储节点102、源存储节点103、源存储节点104、目的存储节点105、目的存储节点106和目的存储节点107可以提供存储服务，用于存储数据。控制节点101可以对源存储节点102、源存储节点103、源存储节点104、目的存储节点105、目的存储节点106和目的存储节点107进行控制管理。应该理解，图1中的源存储节点、目的存储节点和控制节点的数量仅仅是示意性的。根据实现需要，可以具有任意数量的源存储节点、目的存储节点和控制节点。本申请实施例所提供的数据恢复方法一般由控制节点101执行，相应地，数据恢复装置可以设置于控制节点101中。举例而言，控制节点101可以对源存储节点102、源存储节点103、源存储节点104中存储的数据进行监测，如果发现源存储节点103中的数据缺失，源存储节点102中包含对应的待恢复数据，可以获取源存储节点102中单个磁盘的数据恢复任务的数量。如果该数量小于等于第一预设数量，可以确定该磁盘上的并发读请求不会导致磁盘的处理压力较大，直接向目的存储节点105、目的存储节点106和目的存储节点107发送第一恢复消息，从而将该磁盘上的所有待恢复数据恢复至目的存储节点105、目的存储节点106和目的存储节点107。如果该数量大于第一预设数量，可以分多次向目的存储节点105、目的存储节点106和目的存储节点107发送第二恢复消息，从而分多次将该磁盘上的待恢复数据恢复至目的存储节点105、目的存储节点106和目的存储节点107。这样，可以避免针对源存储节点102中单个磁盘的数据读取压力过大，影响正常的用户文件读取服务，提高源存储节点102整体服务的可用性。以下首先对本申请实施例的数据恢复方法进行详细介绍。本申请实施例的数据恢复方法可以应用于控制节点，控制节点和存储节点属于两种不同类型的节点，控制节点可以对同一集群内的所有存储节点进行控制管理。例如，可以监测存储节点中的数据是否发生缺失，在监测到存储节点中的数据发生缺失的情况下，向目的存储节点发送恢复消息，以使目的存储节点将待恢复数据恢复至目的存储节点。参见图2，图2为本申请实施例中数据恢复方法的一种流程图，可以包括以下步骤：步骤S210，监测源存储节点中的数据恢复任务，并获取目标数据恢复任务的第一任务数量；其中，目标数据恢复任务为源存储节点中针对单个第一磁盘的数据恢复任务。本申请实施例中，源存储节点是集群内包含待恢复数据的存储节点。例如，控制节点监测到存储节点一中的数据发生缺失，而存储节点二中包含存储节点1中缺失的数据对应的待恢复数据，那么存储节点二即为源存储节点。源存储节点中数据的存储方式可以包括：三副本的存储方式和/或纠删码的存储方式等。源存储节点的数量可以是一个或多个，在此以一个源存储节点为例进行说明。可以理解的是，源存储节点中通常可以包含多个磁盘，每个磁盘中均存储有不同的数据。源存储节点中的待恢复数据可能位于多个磁盘，也可能位于同一个磁盘。本申请可以获取源存储节点中针对单个第一磁盘的数据恢复任务的第一任务数量。第一磁盘指源存储节点中包含待恢复数据的任一磁盘。通过获取第一任务数量，可以监测第一磁盘的数据读取压力，从而可以根据不同的数据读取压力，执行不同的数据恢复过程。步骤S220，判断第一任务数量是否小于等于第一预设数量。如果第一任务数量小于等于第一预设数量，表示在后续数据恢复时第一磁盘的数据读取压力较小，可以执行下述步骤S230；如果第一任务数量大于第一预设数量，表示在后续数据恢复时第一磁盘的数据读取压力较大，可以执行下述步骤S240。其中，第一预设数量可以是2或3等，可以根据实际业务情况进行调整，在此不做限定。步骤S230，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使第一目的存储节点根据第一恢复信息将第一磁盘中的所有待恢复数据恢复至第一目的存储节点。如果第一任务数量小于等于第一预设数量，控制节点可以向第一目的存储节点发送第一恢复信息，第一恢复信息中包含所有目标数据恢复任务。这样，第一目的存储节点可以根据第一恢复信息向源存储节点发送数据读请求，以读取第一磁盘中的所有待恢复数据，并将所有待恢复数据恢复至第一目的存储节点。第一目的存储节点的数量可以是一个或多个，即，可以将第一磁盘中的所有待恢复数据恢复至一个第一目的存储节点，也可以将第一磁盘中的所有待恢复数据分多个部分恢复至多个第一目的存储节点。第一目的存储节点中数据的存储方式包括：三副本的存储方式和/或纠删码的存储方式。可选的，可以通过以下方式选取第一目的存储节点：获取多个候选存储节点分别对应的存储信息，其中，存储信息包括：存储空间信息和已存储数据的相关信息；根据存储空间信息和已存储数据的相关信息，从多个候选存储节点中选取第一目的存储节点。本申请实施例中，候选存储节点是控制节点所在集群内的存储节点，存储空间信息可以是候选存储节点的逻辑空间，已存储数据的相关信息可以包括三副本的数量和纠删块的数量的配比等。这样，控制节点可以综合考虑各个候选存储节点的逻辑空间、三副本的数量和纠删块的数量的配比等，来选取合适的第一目的存储节点。例如，可以选取逻辑空间较大、三副本的数量配比较高的候选存储节点作为第一目的存储节点。步骤S240，分多次向第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使第一目的存储节点根据单个第二恢复信息将第一磁盘中的部分待恢复数据恢复至第一目的存储节点。如果第一任务数量大于第一预设数量，并且仍然按照步骤S230的方式发送第一恢复消息，那么将会导致第一磁盘的数据读取压力较大，在数据恢复过程中会影响用户正常的读取服务。为了解决该问题，本申请可以分多次向第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，使第一磁盘在数据恢复的各个时刻对应的目标数据恢复任务的数量均小于等于第一预设数量。也就是，在数据恢复过程中，第一磁盘中并发读请求的数量小于等于第一预设数量。在一种可选的实施方式中，控制节点可以每次发送包含第一预设数量的目标数据恢复任务的第二恢复信息，在该第一预设数量的目标数据恢复任务完成之后，再按照同样的方式发送包含剩余的目标数据恢复任务的第二恢复信息。例如，第一预设数量为3，第一磁盘对应的目标数据恢复任务的第一任务数量为5，此时可以先发送一个包含3个目标数据恢复任务的第二恢复信息，在该3个目标数据恢复任务完成之后，再发送包含剩余2个目标数据恢复任务的第二恢复信息。在又一种可选的实施方式中，控制节点在向第一目的存储节点发送单个第二恢复信息后，如果监测到第一磁盘当前对应的目标数据恢复任务的数量小于等于第一预设数量，向第一目的存储节点发送下一个第二恢复信息。例如，第一预设数量为3，第一磁盘对应的目标数据恢复任务的第一任务数量为5，此时可以先发送一个包含3个目标数据恢复任务的第二恢复信息，如果监测到完成其中一个目标数据恢复任务，那么可以再发送包含一个目标数据恢复任务的第二恢复信息，使第一磁盘中并发读请求的数量为3，直至不存在剩余的目标数据恢复任务。这样，通过并行的方式可以提高数据恢复的效率。本申请实施例的数据恢复方法，控制节点通过监测源存储节点中的数据恢复任务，获取源存储节点中单个第一磁盘中的数据恢复任务的第一任务数量，并根据第一任务数量来确定如何向第一目的存储节点发送恢复信息。例如，如果第一任务数量小于等于第一预设数量，可以发送第一恢复信息，从而使第一磁盘中的所有待恢复数据恢复至第一目的存储节点；如果第一任务数量大于第一预设数量，分多次向第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，也就是在数据恢复时限制第一磁盘中目标数据恢复任务的并发数量，从而避免在单个第一磁盘中出现大量的并发读请求，减小第一磁盘的处理压力，以保证正常的用户文件读取服务，提高系统的可用性。参见图3，图3为本申请实施例中数据恢复方法的又一种流程图，可以包括以下步骤：步骤S310，监测源存储节点中的数据恢复任务，并获取源存储节点中数据恢复任务的第二任务数量。本申请实施例中，控制节点监测源存储节点中的数据恢复任务时，可以先获取源存储节点中数据恢复任务的第二任务数量，也就是，获取源存储节点所有磁盘中数据恢复任务的总数量。基于该第二任务数量来判断针对源存储节点的数据读取压力，从而可以根据不同的数据读取压力，执行不同的数据恢复过程。步骤S320，判断第二任务数量是否小于等于第二预设数量。由于第二预设数量和源存储节点的数据读取压力相对应，第一预设数量与单个第一磁盘的数据读取压力相对应，因此，第二预设数量大于等于第一预设数量数据恢复任务的总数量。例如，第二预设数量为6、7或8等。如果第二任务数量小于等于第二预设数量，表示在后续数据恢复时源存储节点的数据读取压力较小，可以执行步骤S330，即进一步判断单个第一磁盘的数据读取压力，根据单个磁盘的数据读取压力，执行不同的数据恢复过程。如果第二任务数量大于第二预设数量，表示在后续数据恢复时源存储节点的数据读取压力较大，可以执行步骤S370。步骤S330，获取目标数据恢复任务的第一任务数量；其中，目标数据恢复任务为源存储节点中针对单个第一磁盘的数据恢复任务。步骤S340，判断第一任务数量是否小于等于第一预设数量。步骤S350，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使第一目的存储节点根据第一恢复信息将第一磁盘中的所有待恢复数据恢复至第一目的存储节点。步骤S360，分多次向第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使第一目的存储节点根据单个第二恢复信息将第一磁盘中的部分待恢复数据恢复至第一目的存储节点。上述步骤S330~步骤S360的处理过程已在图2实施例进行了详细描述，具体参见图2实施例中的描述即可，在此不再赘述。步骤S370，分多次向第二目的存储节点发送包含不同数据恢复任务的第三恢复信息，以使第二目的存储节点根据单个第三恢复信息将源存储节点中的部分待恢复数据恢复至第二目的存储节点。与单个第一磁盘的处理过程类似，如果第二任务数量大于第二预设数量，可以分多次第二目的存储节点发送包含不同数据恢复任务的第三恢复信息，使源存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于第二预设数量。当然，在发送第三恢复信息时，还可以同时考虑单个第一磁盘的数据读取压力，使单个第一磁盘对应的数据恢复任务小于等于第一预设数量。第二目的存储节点是源存储节点中的所有待恢复数据对应的目的存储节点，第一目的存储节点是源存储节点中单个第一磁盘中的所有待恢复数据对应的目的存储节点，因此，第二目的存储节点可以包含第一目的存储节点。本申请实施例的数据恢复方法，可以在数据恢复时限制源存储节点中数据恢复任务的并发数量，以及第一磁盘中目标数据恢复任务的并发数量，从而避免在源存储节点中以及单个第一磁盘中出现大量的并发读请求，减小源存储节点和源存储节点中单个第一磁盘的处理压力，以保证正常的用户文件读取服务，提高系统的可用性。前述图3实施例对源存储节点中数据恢复任务的并发数量以及源存储节点中单个第一磁盘中数据恢复任务的并发数量进行了限制。类似地，还可以对目的存储节点中数据恢复任务的并发数量以及目的存储节点中单个第二磁盘中数据恢复任务的并发数量进行了限制。在此以第一目的存储节点为例进行说明。参见图4，图4为本申请实施例中数据恢复方法的又一种流程图，可以包括以下步骤：步骤S410，监测第一目的存储节点中的数据恢复任务，获取第一目的存储节点中数据恢复任务的第四任务数量。本申请实施例中，第一目的存储节点中数据恢复任务的第四任务数量指第一目的存储节点中所有磁盘的数据恢复任务的总数量。基于该第四任务数量来判断针对第一目的存储节点的数据写入压力，从而可以根据不同的数据写入压力，执行不同的数据恢复过程。步骤S420，判断第四任务数量是否小于等于第四预设数量。如果第四任务数量小于等于第四预设数量，表示在后续数据恢复时第一目的存储节点的数据写入压力较小，可以执行步骤S430；如果第四任务数量大于第四预设数量，表示在后续数据恢复时第一目的存储节点的数据写入压力较大，可以执行步骤S470。步骤S430，获取第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量。第二磁盘指第一目的存储节点中用于存储待恢复数据的磁盘，第二磁盘的数量可以是一个或多个。通过获取第三任务数量，基于该第三任务数量来判断针对第二磁盘的数据写入压力，从而可以根据不同的数据写入压力，执行不同的数据恢复过程。步骤S440，判断第三任务数量是否小于等于第三预设数量。如果第三任务数量小于等于第三预设数量，表示在后续数据恢复时第二磁盘的数据写入压力较小，可以执行步骤S450，如果第三任务数量大于第三预设数量，表示在后续数据恢复时第二磁盘的数据写入压力较大，可以执行步骤S460。其中，第四预设数量大于等于第三预设数量。步骤S450，向第一目的存储节点发送包含针对第二磁盘的所有数据恢复任务的第四恢复信息，以使第一目的存储节点根据第四恢复信息将待恢复至第二磁盘中的所有数据恢复至第二磁盘。步骤S460，分多次向第一目的存储节点发送包含针对第二磁盘的不同数据恢复任务的第五恢复信息，以使第一目的存储节点根据单个第五恢复信息将待恢复至第二磁盘中的部分数据恢复至第二磁盘。与前述步骤S240类似，通过分多次发送第五恢复信息，可以使第二磁盘在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于第三预设数量。也就是，在数据恢复过程中，第二磁盘中并发写请求的数量小于等于第三预设数量。步骤S470，分多次向第一目的存储节点发送包含针对第一目的存储节点中不同数据恢复任务的第六恢复信息，以使第一目的存储节点基于单个第六恢复信息，将待恢复至第一目的存储节点的部分数据恢复至第一目的存储节点。通过分多次发送第五恢复信息，可以使第一目的存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于第四预设数量，即第一目的存储节点中并发写请求的数量小于等于第四预设数量。本申请实施例的数据恢复方法，可以在数据恢复时限制第一目的存储节点中数据恢复任务的并发数量，以及第二磁盘中数据恢复任务的并发数量，从而避免在第一目的存储节点中以及单个第二磁盘中出现大量的并发写请求，减小第一目的存储节点和第一目的存储节点中单个第二磁盘的处理压力，以保证正常的用户文件写入服务，提高系统的可用性。相应于上述方法实施例，本申请实施例还提供了一种数据恢复装置，应用于控制节点，参见图5，该数据恢复装置500包括：第一任务数量获取模块510，用于监测源存储节点中的数据恢复任务，并获取目标数据恢复任务的第一任务数量；其中，目标数据恢复任务为源存储节点中针对单个第一磁盘的数据恢复任务；第一恢复信息发送模块520，用于如果第一任务数量小于等于第一预设数量，向第一目的存储节点发送包含所有目标数据恢复任务的第一恢复信息，以使第一目的存储节点根据第一恢复信息将第一磁盘中的所有待恢复数据恢复至第一目的存储节点；或者，第二恢复信息发送模块530，用于如果第一任务数量大于第一预设数量，分多次向第一目的存储节点发送包含不同目标数据恢复任务的第二恢复信息，以使第一目的存储节点根据单个第二恢复信息将第一磁盘中的部分待恢复数据恢复至第一目的存储节点；其中，第一磁盘在数据恢复的各个时刻对应的目标数据恢复任务的数量均小于等于第一预设数量。可选的，数据恢复装置500，还包括：第二任务数量获取模块，用于获取源存储节点中数据恢复任务的第二任务数量；如果第二任务数量小于等于第二预设数量，通过第一任务数量获取模块执行获取目标数据恢复任务的第一任务数量的步骤；其中，第二预设数量大于等于第一预设数量，或者，第三恢复信息发送模块，用于如果第二任务数量大于第二预设数量，分多次向第二目的存储节点发送包含不同数据恢复任务的第三恢复信息，以使第二目的存储节点根据单个第三恢复信息将源存储节点中的部分待恢复数据恢复至第二目的存储节点；其中，源存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于第二预设数量。可选的，第二恢复信息发送模块530，具体用于如果第一任务数量大于第一预设数量，在向第一目的存储节点发送单个第二恢复信息后，如果监测到第一磁盘当前对应的目标数据恢复任务的数量小于第一预设数量，向第一目的存储节点发送下一个第二恢复信息。可选的，数据恢复装置500，还包括：第三任务数量获取模块，用于监测第一目的存储节点中的数据恢复任务，获取第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量；第四恢复信息发送模块，用于如果第三任务数量小于等于第三预设数量，向第一目的存储节点发送包含针对第二磁盘的所有数据恢复任务的第四恢复信息，以使第一目的存储节点根据第四恢复信息将待恢复至第二磁盘中的所有数据恢复至第二磁盘；第五恢复信息发送模块，用于如果第三任务数量大于第三预设数量，分多次向第一目的存储节点发送包含针对第二磁盘的不同数据恢复任务的第五恢复信息，以使第一目的存储节点根据单个第五恢复信息将待恢复至第二磁盘中的部分数据恢复至第二磁盘；其中，第二磁盘在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于第三预设数量。可选的，数据恢复装置500，还包括：第四任务数量获取模块，用于获取第一目的存储节点中数据恢复任务的第四任务数量；如果第四任务数量小于等于第四预设数量，通过第三任务数量获取模块执行获取第一目的存储节点中针对单个第二磁盘的数据恢复任务的第三任务数量的步骤；其中，第四预设数量大于等于第三预设数量；第六恢复信息发送模块，用于如果第四任务数量大于第四预设数量，分多次向第一目的存储节点发送包含针对第一目的存储节点中不同数据恢复任务的第六恢复信息，以使第一目的存储节点基于单个第六恢复信息，将待恢复至第一目的存储节点的部分数据恢复至第一目的存储节点；其中，第一目的存储节点在数据恢复的各个时刻对应的数据恢复任务的数量均小于等于第四预设数量。可选的，数据恢复装置500，还包括：存储信息获取模块，用于获取多个候选存储节点分别对应的存储信息，其中，存储信息包括：存储空间信息和已存储数据的相关信息；第一目的存储节点选取模块，用于根据存储空间信息和已存储数据的相关信息，从多个候选存储节点中选取第一目的存储节点。可选的，源存储节点和第一目的存储节点中数据的存储方式包括：三副本的存储方式和/或纠删码的存储方式。上述装置中各模块或单元的具体细节已经在对应的方法中进行了详细的描述，因此此处不再赘述。应当注意，尽管在上文详细描述中提及了用于动作执行的设备的若干模块或者单元，但是这种划分并非强制性的。实际上，根据本申请的实施方式，上文描述的两个或更多模块或者单元的特征和功能可以在一个模块或者单元中具体化。反之，上文描述的一个模块或者单元的特征和功能可以进一步划分为由多个模块或者单元来具体化。在本申请的示例性实施例中，还提供一种电子设备，包括：处理器；用于存储处理器可执行指令的存储器；其中，处理器被配置为执行本示例实施方式中上述数据恢复方法。图6为本申请实施例中电子设备的一种结构示意图。需要说明的是，图6示出的电子设备600仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图6所示，电子设备600包括中央处理单元601，其可以根据存储在只读存储器602中的程序或者从存储部分608加载到随机访问存储器603中的程序而执行各种适当的动作和处理。在RAM 603中，还存储有系统操作所需的各种程序和数据。中央处理单元601、ROM 602以及RAM 603通过总线604彼此相连。输入/输出接口605也连接至总线604。以下部件连接至I/O接口605：包括键盘、鼠标等的输入部分606；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分607；包括硬盘等的存储部分608；以及包括诸如局域网卡、调制解调器等的网络接口卡的通信部分609。通信部分609经由诸如因特网的网络执行通信处理。驱动器610也根据需要连接至I/O接口605。可拆卸介质611，诸如第一磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器610上，以便于从其上读出的计算机程序根据需要被安装入存储部分608。特别地，根据本申请的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本申请的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分609从网络上被下载和安装，和/或从可拆卸介质611被安装。在该计算机程序被中央处理单元601执行时，执行本申请的装置中限定的各种功能。本申请实施例中，还提供了一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述数据恢复方法。需要说明的是，本申请所示的计算机可读存储介质例如可以是—但不限于—电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机第一磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑第一磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本申请中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。计算机可读存储介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、电线、光缆、射频等等，或者上述的任意合适的组合。本申请实施例中，还提供了一种计算机程序产品，当计算机程序产品在计算机上运行时，使得计算机执行上述数据恢复方法。需要说明的是，在本文中，诸如“第一”和“第二”等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。以上所述仅是本申请的具体实施方式，使本领域技术人员能够理解或实现本申请。对这些实施例的多种修改对本领域的技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本申请的精神或范围的情况下，在其它实施例中实现。因此，本申请将不会被限制于本文所述的这些实施例，而是要符合与本文所公开的原理和新颖特点相一致的最宽的范围。
