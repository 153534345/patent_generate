标题title
用于含SPI通信协议与I2C通信协议封装电路的通信集成系统
摘要abst
本发明揭示了用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，包括封装集成通信单元与封装集成数据通讯单元，封装集成通信单元包括序列码检测模块、使能逻辑信号端、数据输出端、I2C数据输入端、SPI数据输入端，封装集成数据通讯单元包括输入输出模块和输入模块，输入输出模块包括使能信号判断端、通讯数据输出端、第一通讯数据输入端，输入模块包括第二通讯数据输入端。本发明能实现内含SPI和I2C通信协议的集成电路应用，节约芯片的流片面积和减少封装管脚，成本得到控制。具备通过检验序列串行码实现逻辑自动判断工作通信协议模式功能。通过原芯片封装管脚实现协议通讯集成，满足各工作模式兼容性及灵活转换需求。
权利要求书clms
1.用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，其特征在于：包括封装集成通信单元与封装集成数据通讯单元，所述封装集成通信单元包括用于工作协议模式判断的序列码检测模块、用于使能逻辑信号输出的使能逻辑信号端、用于SPI通信协议或I2C通信协议数据输出的数据输出端、用于所述I2C通信协议数据输入的I2C数据输入端、用于所述SPI通信协议数据输入的SPI数据输入端，所述封装集成数据通讯单元包括输入输出模块和输入模块，所述输入输出模块包括用于接收所述使能逻辑信号端使能逻辑信号进行输入或输出判断的使能信号判断端、与所述数据输出端相连的通讯数据输出端、与所述I2C数据输入端相连的第一通讯数据输入端，所述输入模块包括与所述SPI数据输入端相连的第二通讯数据输入端。2.根据权利要求1所述用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，其特征在于：所述SPI通信协议包括三线式SPI通信协议和四线式SPI通信协议，所述封装集成通信单元包括用于三线式SPI通信协议使能逻辑信号输出的第二使能逻辑信号端，所述三线式SPI通信协议、所述四线式SPI通信协议及所述I2C通信协议共用所述数据输出端，所述三线式SPI通信协议及所述I2C通信协议共用所述输入输出模块。3.根据权利要求1或2所述用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，其特征在于：所述序列码检测模块包括用于时钟指令输入的时钟输入端、用于根据时钟输入端进行输入码序列输入的输入码序列输入端、用产生rstb信号的模拟信号端、用于通信协议判断的初始端、用于与所述初始端相配合进行SPI通信协议和I2C通信协议判断的第一通信协议判断端。4.根据权利要求3所述用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，其特征在于：所述序列码检测模块包括用于与所述初始端相配合进行三线式SPI通信协议和四线式SPI通信协议判断的第二通信协议判断端。
说明书desc
技术领域本发明涉及用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，尤其涉及半导体集成电路及微电子专用电路中内部协议通信配置集成化，属于半导体封装电路的技术领域。背景技术半导体集成电路芯片需要进行封装，起着安放、固定、密封、保护芯片和增强电热性能的作用，而且还是沟通芯片内部世界与外部电路的桥梁，芯片上的接点用导线连接到封装外壳的引脚上，这些引脚又通过印制板上的导线与其他器件建立连接。因此，封装对CPU和其他LSI集成电路都起着重要的作用。随着集成电路低成本和高度集成技术的发展，需要进行节约芯片上封装管脚设计，从而实现节约集成电路芯片的面积和成本等需求。目前芯片通信存在SPI通信协议与I2C通信协议，其中SPI通信协议包括三线式SPI通信协议和四线式SPI通信协议，三线式SPI通信协议包括时钟输入端口SCL、片选使能信号输入端口SCSB、双向输入输出端SDI，四线式SPI通信协议包括时钟输入端口SCL、片选使能信号输入端口SCSB、输入端SDI、输出端SDO，I2C通信协议包括双向输入输出端SDA、时钟输入端口SCL。一般情况下，为了节约集成电路芯片的面积和成本，其通信协议单一，通过损失其兼容性来实现成本控制，而在一些要求兼容SPI通信协议与I2C通信协议的芯片设计中，存在独立地通信协议通讯设计，导致封装管脚数量非常多，电路流片面积较大。发明内容本发明的目的是解决上述现有技术的不足，针对传统集成电路芯片通信协议单一或多种通信协议独立导致封装管脚数量多电路流片面积大的问题，提出用于含SPI通信协议与I2C通信协议封装电路的通信集成系统。为了达到上述目的，本发明所采用的技术方案为：用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，包括封装集成通信单元与封装集成数据通讯单元，所述封装集成通信单元包括用于工作协议模式判断的序列码检测模块、用于使能逻辑信号输出的使能逻辑信号端、用于SPI通信协议或I2C通信协议数据输出的数据输出端、用于所述I2C通信协议数据输入的I2C数据输入端、用于所述SPI通信协议数据输入的SPI数据输入端，所述封装集成数据通讯单元包括输入输出模块和输入模块，所述输入输出模块包括用于接收所述使能逻辑信号端使能逻辑信号进行输入或输出判断的使能信号判断端、与所述数据输出端相连的通讯数据输出端、与所述I2C数据输入端相连的第一通讯数据输入端，所述输入模块包括与所述SPI数据输入端相连的第二通讯数据输入端。优选地，所述SPI通信协议包括三线式SPI通信协议和四线式SPI通信协议，所述封装集成通信单元包括用于三线式SPI通信协议使能逻辑信号输出的第二使能逻辑信号端，所述三线式SPI通信协议、所述四线式SPI通信协议及所述I2C通信协议共用所述数据输出端，所述三线式SPI通信协议及所述I2C通信协议共用所述输入输出模块。优选地，所述序列码检测模块包括用于时钟指令输入的时钟输入端、用于根据时钟输入端scl进行输入码序列输入的输入码序列输入端、用产生rstb信号的模拟信号端、用于通信协议判断的初始端、用于与所述初始端相配合进行SPI通信协议和I2C通信协议判断的第一通信协议判断端。优选地，所述序列码检测模块包括用于与所述初始端prob相配合进行三线式SPI通信协议和四线式SPI通信协议判断的第二通信协议判断端。本发明的有益效果主要体现在：1.能实现内含SPI和I2C通信协议的集成电路应用，节约芯片的流片面积和减少封装管脚，成本得到控制。2.具备通过检验序列串行码实现逻辑自动判断工作通信协议模式功能。3.通过原芯片封装管脚实现协议通讯集成，满足各工作模式兼容性及灵活转换需求。附图说明通过阅读参照以下附图所作的对非限制性实施例所作的详细描述，本申请的其它特征、目的和优点将会变得更明显：图1是本发明用于含SPI通信协议与I2C通信协议封装电路的通信集成系统的框架结构示意图。图2是本发明用于含SPI通信协议与I2C通信协议封装电路的通信集成系统实施例一的结构示意图。图3是本发明用于含SPI通信协议与I2C通信协议封装电路的通信集成系统实施例二的框架结构示意图。图4是本发明用于含SPI通信协议与I2C通信协议封装电路的通信集成系统中序列码检测模块的结构示意图。图5是本发明用于含SPI通信协议与I2C通信协议封装电路的通信集成系统中通用通讯协议时序图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。下面结合附图和实施例对本申请作进一步的详细说明。可以理解的是，此处所描述的具体实施例仅仅用于解释相关发明，而非对该发明的限定。另外还需要说明的是，为了便于描述，附图中仅示出了与有关发明相关的部分。需要说明的是，在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。本发明提供用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，其应用于内含SPI以及I2C通信协议的集成电路或专用电路中，并通过SPI或I2C接口进行相应的电路与其他芯片的通信，满足面积小、高集成度、节约流片成本等特性。集成电路内部设计通过原工作的通信协议即SPI及I2C工作的时钟信号、使能信号的输入或输出端口作为封装管脚于芯片上并通过相应管脚的输入序列码检测工作协议模式，另外传输数据的信号线作为输入和/或输出端口的封装管脚。对于特定内含SPI和I2C通信协议并工作在某一通信协议模式下与外部芯片实现通信协议，符合协议正确的数据输入输出的专用电路或集成电路设计中。实现节约电路设计面积和减少封装管脚。通过端口信号的逻辑串行输入序列判断工作协议模式，并实现可以通过协议原本的输入输出管脚进行串行码序列输入，由内部数字电路逻辑模块实现工作协议模式的判断，另外通过借助于SPI及I2C协议通信的封装端口管脚输入不同的串行序列码进行工作于三线式SPI、四线式SPI及I2C通信协议的互相切换，节约封装成本、减小芯片流片面积和费用，达到节约成本的目的。实施例一如图2所示，包括封装集成通信单元与封装集成数据通讯单元，封装集成通信单元包括用于工作协议模式判断的序列码检测模块seq_det、用于使能逻辑信号输出的使能逻辑信号端spi_miso_en、用于SPI通信协议或I2C通信协议数据输出的数据输出端spi_miso_o、用于所述I2C通信协议数据输入的I2C数据输入端spi_miso_i、用于所述SPI通信协议数据输入的SPI数据输入端。封装集成数据通讯单元包括输入输出模块和输入模块，输入输出模块包括用于接收使能逻辑信号端spi_miso_en使能逻辑信号进行输入或输出判断的使能信号判断端ien、与数据输出端spi_miso_o相连的通讯数据输出端dout、与I2C数据输入端spi_miso_i相连的第一通讯数据输入端din，输入模块包括与SPI数据输入端相连的第二通讯数据输入端din。具体地实现过程及原理说明：首先对序列码检测模块seq_det进行说明，如图5所示，其内部设计有SPI通信协议和I2C通信协议通用的通信协议，即共用SCL端口即为I2C或SPI工作的时钟的输入端口，共用片选SCSB端口作为I2C或SPI工作的片选使能信号的输入端口。通过输入序列码检测工作协议模式。输入输出模块SDO为双向输入输出端口，当ien使能为高电平逻辑，作为din输入特性，当ien使能为低电平逻辑，作为dout输出特性。该实施例一为兼容四线式SPI通信协议与I2C通信协议的连接方案。首先进行通过序列码检测模块seq_det进行四线式SPI通信协议与I2C通信协议的协议判断，从而实现匹配的协议通信连接。spi_miso_en逻辑信号为当I2C模式下由i2c通信协议内部的i2c_sda_en 信号控制即是内部I2C协议关于控制i2c通信的数据输入输出使能信号；而在四线式SPI通信协议模式下，spi_miso_en逻辑信号为SPI通信协议工作控制数据输入输出的使能信号控制产生。spi_miso_o逻辑信号为当工作I2C通信协议模式下，选择I2C的通信协议传输数据输出，而当工作在四线式SPI通信协议模式下，选择SPI的通信协议传输数据输出。spi_miso_i逻辑信号为当工作I2C通信协议模式下的数据输入信号，spi_mosi_i逻辑信号为四线式SPI通信协议模式下的数据输入信号。控制SDI端口的输入使能的ien信号，内部接高电平，即SDI为输入管脚。而控制SDO的输入输出使能信号和内部逻辑spi_miso_en相连，由spi_miso_en控制管脚I/O的输入输出特性。当工作为I2C协议下通信，spi_miso_en逻辑为控制I2C输入输出的数据使能信号，而spi_miso_o为I2C通信协议的数据输出逻辑到SDO，spi_miso_i为I2C通信协议的数据输入逻辑从SDO端口输入。当工作在四线式SPI通信协议下，即spi_miso_en为控制spi协议内部数据通过spi_miso_o逻辑输出到端口SDO的使能信号，spi_mosi_i为spi通信协议工作的数据输入通过端口SDI输入。实施例二如图3所示，为兼容三线式SPI通信协议、四线式SPI通信协议与I2C通信协议的连接方案。封装集成通信单元包括用于三线式SPI通信协议使能逻辑信号输出的第二使能逻辑信号端spi_out_en，三线式SPI通信协议、四线式SPI通信协议及I2C通信协议共用数据输出端spi_miso_o，三线式SPI通信协议及I2C通信协议共用输入输出模块。具体地说明，通过序列码检测模块seq_det进行三线式SPI通信协议、四线式SPI通信协议与I2C通信协议的协议判断，从而实现匹配的协议通信匹配。其四线式SPI通信协议与I2C通信协议的工作原理与实施例一相同。在进行三线式SPI通信作业时，内部数字逻辑在原四线式SPI通信协议内部设计增加了spi_out_en信号，spi_out_en控制三线式SPI协议的数据输入输出使能信号，根据原四线式SPI通信协议的内部逻辑的地址高位通过判断读或写spi操作，内部设计当在读操作，完成addr即第一个byte后，spi_out_en信号为高电平逻辑，其他时刻为低电平逻辑。spi_out_en控制SDO双向端口即实现SDIO端口进行写命令时为原SDI端口逻辑信号的输入，读命令时先作为原SDI端口逻辑的信号的输入，读取地址后，返回数据时作为SDO原逻辑信号的输出到SDIO端口。在一个具体实施例中，如图4所示，该序列码检测模块seq_det包括用于时钟指令输入的时钟输入端scl、用于根据时钟输入端scl进行输入码序列输入的输入码序列输入端scsb、用产生rstb信号的模拟信号端rstb、用于通信协议判断的初始端porb、用于与所述初始端prob相配合进行SPI通信协议和I2C通信协议判断的第一通信协议判断端i2c_select、用于与初始端prob相配合进行三线式SPI通信协议和四线式SPI通信协议判断的第二通信协议判断端spi_sel。此模块通过管脚直通输入信号scl和scsb，这样可以区别协议工作的输入码序列输入，可以减少错误识别成工作协议模式下的输入数据的几率。通过管脚直通输入信号scsb输入的串行码序列，使用scl用作时钟输入检测scl输入串行序列码，能产生内部需要的rstb；实现通过输入命令检测序列切换四线spi、三线spi功能；产生内部选择spi或i2c工作协议的信号i2c_select。节约额外的rstb管脚和判断spi还是i2c协议模式的管脚，其中seq_det模块输入信号porb为内部模拟电路POR信号直接输入，产生初始值。scl输入命令后，scsb作为时钟采样scl的输入序列，seq_det检测输入序列并且判断原码与补码正确后产生相应的信号。具体地，scl输入命令产生rstb信号：使用porb产生初始值，porb为0，rstb为初始化值为1，当scl 输入串行命令bit7~bit0为01011011；内部逻辑判断原码是01011011 并且判断补码为10100101，产生rstb为0的逻辑；当输入命令bit7~bit0：10100110；内部逻辑判断原码为10100110与判断补码为01011010，产生rstb为1的逻辑。scl输入命令产生四线式spi及三线式spi互相转换的信号：使用PORB产生初始值，porb为0，spi_sel初始化值为0，当输入命令bit7~bit0：00111010；内部逻辑判断原码为00111010 并且补码为11000110时，spi_sel为0，此时为四线式SPI；当输入命令bit7~bit0：11000111；内部逻辑判断原码11000111 与补码为00111001，spi_sel为1，此时为三线式SPI。scl输入命令产生spi与 i2c模式识别和转换的信号：使用PORB产生初始值，PORB为0，i2c_select初始化值为0，输入命令bit7~bit0：01101010；内部逻辑判断原码为01101010 与判断补码为10010110时即i2c_select为0，此时为spi 模式；输入命令bit7~bit0：10010111；内部逻辑判断原码为10010111 与判断补码为01101001，i2c_select为1，此时为i2c模式。所有命令检测后产生的信号一旦产生保持不变直到再检测到相应的改变其值的输入串行序列码使其改变。通过以上描述可以发现，本发明用于含SPI通信协议与I2C通信协议封装电路的通信集成系统，能实现内含SPI和I2C通信协议的集成电路应用，节约芯片的流片面积和减少封装管脚，成本得到控制。具备通过检验序列串行码实现逻辑自动判断工作通信协议模式功能。通过原芯片封装管脚实现协议通讯集成，满足各工作模式兼容性及灵活转换需求。术语“包括”或者任何其它类似用语旨在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备/装置不仅包括那些要素，而且还包括没有明确列出的其它要素，或者还包括这些过程、方法、物品或者设备/装置所固有的要素。至此，已经结合附图所示的优选实施方式描述了本发明的技术方案，但是，本领域技术人员容易理解的是，本发明的保护范围显然不局限于这些具体实施方式。在不偏离本发明的原理的前提下，本领域技术人员可以对相关技术特征作出等同的更改或替换，这些更改或替换之后的技术方案都将落入本发明的保护范围之内。
