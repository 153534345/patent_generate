标题title
一种基于正样本训练的人脸静默活体检测方法及装置
摘要abst
本发明公开了一种基于正样本训练的人脸静默活体检测方法及装置，所述方法包括：获取训练数据集；利用网络模型中的图像特征编码子网络，对输入正常人脸图像进行特征编码与分离，获得潜在人脸特征与潜在背景特征；利用图像重构子网络，对潜在人脸特征与潜在背景特征进行重构，得到重构清晰人脸图像与重构正常人脸图像；利用网络模型中的重构特征编码子网络对重构正常人脸图像进行特征提取，得到潜在重构人脸特征和潜在重构背景特征；根据正常人脸图像的训练数据集，利用网络模型中的判别网络和预训练人脸身份特征提取网络对所述重构人脸图像和输入人脸图像进行判别，结合损失函数，实现网络模型的收敛，得到训练好的网络模型；将待测的图像输入训练好的网络模型，确定输入人脸图像的活体性。
权利要求书clms
1.一种基于正样本训练的人脸静默活体检测方法，其特征在于，包括：获取训练数据集，训练数据集中的图像为高清高质量的正常人脸图像；利用网络模型中重构图像生成网络的图像特征编码子网络，对输入正常人脸图像进行特征编码与分离，获得潜在人脸特征与潜在背景特征；利用网络模型中重构图像生成网络的图像重构子网络，对潜在人脸特征与潜在背景特征分别进行重构，得到重构清晰人脸图像与重构正常人脸图像；利用网络模型中的重构特征编码子网络对重构正常人脸图像进行特征提取，得到潜在重构人脸特征和潜在重构背景特征；利用网络模型中的判别网络和预训练人脸身份特征提取网络对重构人脸图像和输入人脸图像进行判别，用于网络整体训练；根据高清高质量正常人脸图像的训练数据集，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型；将实际设备采集的待测人脸图像输入所述训练好的网络模型，通过比较潜在重构背景特征与潜在背景特征之间的差异程度，确定输入人脸图像的活体性。2.根据权利要求1所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述网络模型中重构图像生成网络的图像特征编码子网络包括第一特征编码器和特征分离模块，对输入正常人脸图像进行特征编码及分离，得到潜在人脸特征和潜在背景特征；具体包括：利用第一特征编码器对输入正常人脸图像进行特征提取，得到潜在整体特征利用第一特征分离模块对潜在整体特征进行特征分离，得到潜在人脸特征和潜在背景特征3.根据权利要求2所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述第一特征分离模块包括特征分离层和两个卷积层，两个卷积层分别为第一卷积层和第二卷积层，第一卷积层和第二卷积层中卷积核大小不同，具体包括：利用特征分离层将潜在整体特征分离为第一特征分量和第二特征分量；利用第一卷积层对第一特征分量进行处理，得到潜在人脸特征利用第二卷积层对第二特征分量进行处理，得到潜在背景特征4.根据权利要求1所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述图像重构子网络包括人脸特征解码器、背景特征解码器、特征重构模块以及特征重组重构模块；所述图像重构子网络对潜在人脸特征和潜在背景特征分别进行图像重构，得到重构清晰人脸图像Ic和重构正常人脸图像Ireal，具体为：利用人脸特征解码器对对潜在人脸特征进行特征重新解码，获得深度人脸特征利用背景特征解码器对潜在背景特征进行特征重新解码，获得对应的深层背景特征利用特征重构模块对深度人脸特征进行图像重构，获得仅关注人脸信息的重构清晰人脸图像Ic；利用特征重组重构模块对深度人脸特征和深层背景特征进行特征重组和图像重构，获得与输入正常人脸图像相似的重构正常人脸图像Ireal。5.根据权利要求4所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述特征重构模块包括卷积层和Tanh激活层；所述利用特征重构模块对深度人脸特征进行图像重构，获得仅关注人脸信息的重构清晰人脸图像Ic，具体包括：利用特征重构模块的卷积层处理深度人脸特征得到处理后特征；对处理后的特征利用Tanh激活层进行处理，得到对应的重构清晰人脸图像Ic；所述特征重组重构模块包括特征级联操作、卷积层和Tanh激活层；利用特征重组重构模块对深度人脸特征和深层背景特征进行特征重组和图像重构，获得与输入正常人脸图像相似的重构正常人脸图像Ireal具体包括：利用特征级联操作对深度人脸特征和深层背景特征进行处理，得到处理后特征；对处理后的特征利用卷积层和Tanh激活层进行处理，得到对应的重构正常人脸图像Ireal。6.根据权利要求1所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述重构特征编码子网络包括第二特征编码器与第二特征分离模块；其中，利用网络模型中的重构特征编码子网络对重构正常人脸图像Ireal进行特征提取，得到潜在重构人脸特征和潜在重构背景特征具体包括：对重构正常人脸图像，利用重构特征编码子网络中的第二特征编码器进行处理，得到潜在重构整体特征利用第二特征分离模块对潜在重构整体特征进行特征分离，得到潜在重构人脸特征和潜在重构背景特征7.根据权利要求1所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述判别网络包括六个卷积层和六个线性整流层，每个卷积层和每个线性整流层交替连接；并利用判别网络对输入正常人脸图像I和重构正常人脸图像Ireal进行判别，将输入正常人脸图像I判定为真，将重构正常人脸图像Ireal判别为假，并利用判别结果优化整体网络模型。8.根据权利要求1所述的基于正样本训练的人脸静默活体检测方法，其特征在于，根据正常人脸图像I优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型，具体包括：优化输入正常人脸图像I与重构正常人脸图像Ireal之间的像素差异，设置损失函数，如下所示：其中，H与W分别为输入正常人脸图像I的高度与宽度，||·||1为L1范数的度量形式；优化输入正常人脸图像I与重构正常人脸图像Ireal之间的对抗损失函数，设置对应的对抗损失函数如下所示：其中分别表示输入正常人脸图像和重构正常人脸图像所对应的样本分布；表示分布函数的期望值，D分别表示判别网络，log表示log函数；优化输入正常人脸图像I与重构清晰人脸图像Ic之间的身份信息差异，设置损失函数如下所示：其中f表示预训练人脸身份特征提取网络，M表示所提取的人脸身份信息特征长度，||·||2为L2范数的度量形式；分别优化所提取的潜在人脸特征与潜在重构人脸特征潜在背景特征与潜在重构背景特征之间的差异，设计损失函数如下所示：其中，Kface,KBG分别为潜在人脸特征潜在背景特征的特征长度，||·||1为L1范数的度量形式；通过交替优化以下所述整体损失函数，实现网络模型的收敛：其中G表示整体网络结构，包括重构图像生成网络与重构特征编码子网络；D分别表示判别网络。9.根据权利要求1所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述将待测的人脸图像输入所述训练好的网络模型，通过比较生成的潜在背景特征与潜在重构背景特征之间的差异，判断输入人脸图像的活体性，具体包括：获取需要处理的待检测人脸图像；将所述待检测人脸图像输入所述训练好的网络模型，生成对应的潜在背景特征与潜在重构背景特征计算特征差异通过判断Δ是否大于预设的阈值，判断输入人脸图像的静默活体检测；若大于阈值，则输入人脸图像为假人脸图像，反之，则为正常人脸图像。10.根据权利要求1所述的基于正样本训练的人脸静默活体检测方法，其特征在于，所述获取训练数据集具体包括：获取当前主流的人脸图像数据库；筛选高清高质量的正常人脸图像作为训练的正样本，无需收集假体人脸图像。11.一种计算机设备，包括处理器以及用于存储处理器可执行程序的存储器，其特征在于，所述处理器执行存储器存储的程序时，实现人脸静默活体检测方法。12.一种存储介质，存储有程序，其特征在于，所述程序被处理器执行时，实现权利要求1-10任一项所述的基于正样本训练的人脸静默活体检测方法。13.一种基于正样本训练的人脸静默活体检测装置，其特征在于，所述装置包括：获取模块，用于获取训练数据集；其中，所述训练数据集中的图像为高清高质量的正常人脸图像；图像特征编码模块，用于利用网络模型中的图像特征编码子网络对所述正常人脸图像进行特征编码和提取，得到潜在人脸特征和潜在背景特征；图像重构模块，用于利用网络模型中的图像重构子网络对所述潜在人脸特征和潜在背景特征分别进行图像重构深层特征提取，得到重构清晰人脸图像和重构正常人脸图像；重构特征编码模块，用于利用网络模型中的重构特征编码子网络对所述图重构正常人脸图像进行特征编码和提取，得到潜在重构人脸特征和潜在重构背景特征；判别模块，用于利用网络模型中的判别网络对所述输入正常人脸图像和重构正常人脸图像进行判别，得到图像差异；身份特征提取模块，用于利用预训练人脸身份特征提取网络对所述输入正常人脸图像和重构清晰人脸图像进行判别，得到身份差异；优化模块，用于根据所述训练数据集中的高清高质量正常人脸图像、图像差异以及身份差异，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型；活体检测模块，用于将待测的人脸图像输入所述训练好的网络模型，通过判断潜在重构背景特征和潜在背景特征之间的差异，确定输入人脸的活性。
说明书desc
技术领域本发明涉及深度学习应用技术领域，尤其涉及一种基于正样本训练的人脸静默活体检测方法及装置。背景技术人脸识别系统逐渐成为现有安防身份认证系统的重要组成部分，并广泛应用到各个安防领域中。但是，包含有人脸信息的照片和视频等资源容易对人脸识别系统进行攻击，造成系统安全性低。因此，需要加入人脸活体检测，以便于增强人脸识别系统的防御，抵御不同的人脸假体攻击，如照片攻击、视频攻击、面具攻击等。人脸活体检测主要是通过识别活体上的生理信息来进行判断该人脸是否为活体，活体检测技术可以把生理信息作为生命特征来区分用照片、硅胶、塑料等非生命物质假装的生物特征。目前,人脸活体检测方法可以分为基于用户协作式检测法、基于辅助设备检测法以及静默式检测法。但是，基于用户协作式检测法的其用户体验较差，且等待时间较长，效率低下，而基于辅助设备检测法虽准确度较高，但也提高了产品的成本，限制了其应用场景和推广进度。相反地，仅仅根据可见光下人脸图像进行的人脸静默活体检测能够大大提高用户体验，减低成本，并能够保护人脸识别系统的正确性。针对人脸静默活体检测问题，其关键的问题是人脸假体攻击的类型多种多样，难以在算法模型设计过程中考虑到每一种攻击类型，容易造成算法模型的泛化性不强。相反的，现有实际应用容易采集到大量正常、真实的人脸图像正样本数据，因此，如何设计相应合理的深度学习网络框架，结合大量正样本训练数据，利用高性能的计算机处理能力对网络进行训练，进而可以获得鲁棒性高、泛化性强的人脸静默活体检测网络，进而有效地确保真实人脸的准确判断，杜绝多种人脸假体攻击，为后续人脸识别的安全性提供保障。现有技术方案：有平台提供了多种活体检测SDK，包括交互式的APP活体检测、离线RGB活体检测、红外活体检测、在线图像活体检测等。使用者在拿到百度的授权后，调用SDK中的接口函数进行二次开发，输入合适的数据，如图片等，得到其计算的结果，再利用计算结果进行后续开发。现有技术存在的缺点：只有单独的活体人脸检测功能。不利于二次开发，平台搭建方面的自主性或兼容性不高；在训练模型时使用了超过十万张图片，在样本采集上存在困难。发明内容为解决上述技术问题，本发明的目的是提供一种基于正样本训练的人脸静默活体检测方法及装置，该方法利用深度学习网络框架构建网络模型，通过构建网络模型中的图像特征编码子网络与图像重构子网络，从而获得重构图像生成网络，结合判别网络和预训练人脸身份特征提取网络，实现了基于正样本数据的网络模型训练；将获得的人脸图像输入训练好的网络模型，通过比较输入人脸图像与重构人脸图像之间的编码特征差异，实现输入人脸图像的活体检测，为后续人脸识别的实际应用打下坚实基础。本发明的目的通过以下的技术方案来实现：一种基于正样本训练的人脸静默活体检测方法，包括：获取训练数据集，训练数据集中的图像为高清高质量的正常人脸图像；利用网络模型中重构图像生成网络的图像特征编码子网络，对输入正常人脸图像进行特征编码与分离，获得潜在人脸特征与潜在背景特征；利用网络模型中重构图像生成网络的图像重构子网络，对潜在人脸特征与潜在背景特征分别进行重构，得到重构清晰人脸图像与重构正常人脸图像；利用网络模型中的重构特征编码子网络对重构正常人脸图像进行特征提取，得到潜在重构人脸特征和潜在重构背景特征；利用网络模型中的判别网络和预训练人脸身份特征提取网络对重构人脸图像和输入人脸图像进行判别，用于网络整体训练；根据高清高质量正常人脸图像的训练数据集，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型；将实际设备采集的待测人脸图像输入所述训练好的网络模型，通过比较潜在重构背景特征与潜在背景特征之间的差异程度，确定输入人脸图像的活体性。一种计算机设备，包括处理器以及用于存储处理器可执行程序的存储器，其特征在于，所述处理器执行存储器存储的程序时，实现人脸静默活体检测方法。一种存储介质，存储有程序，所述程序被处理器执行时，实现所述的基于正样本训练的人脸静默活体检测方法。一种基于正样本训练的人脸静默活体检测装置，包括：获取模块，用于获取训练数据集；其中，所述训练数据集中的图像为高清高质量的正常人脸图像；图像特征编码模块，用于利用网络模型中的图像特征编码子网络对所述正常人脸图像进行特征编码和提取，得到潜在人脸特征和潜在背景特征；图像重构模块，用于利用网络模型中的图像重构子网络对所述潜在人脸特征和潜在背景特征分别进行图像重构深层特征提取，得到重构清晰人脸图像和重构正常人脸图像；重构特征编码模块，用于利用网络模型中的重构特征编码子网络对所述图重构正常人脸图像进行特征编码和提取，得到潜在重构人脸特征和潜在重构背景特征；判别模块，用于利用网络模型中的判别网络对所述输入正常人脸图像和重构正常人脸图像进行判别，得到图像差异；身份特征提取模块，用于利用预训练人脸身份特征提取网络对所述输入正常人脸图像和重构清晰人脸图像进行判别，得到身份差异；优化模块，用于根据所述训练数据集中的高清高质量正常人脸图像、图像差异以及身份差异，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型；活体检测模块，用于将待测的人脸图像输入所述训练好的网络模型，通过判断潜在重构背景特征和潜在背景特征之间的差异，确定输入人脸的活性。与现有技术相比，本发明的一个或多个实施例可以具有如下优点：本发明将深度学习网络技术应用到网络模型的构建，用来实现泛化能力强的静默人脸活体检测；通过利用网络模型中的重构图像生成网络，实现人脸图像一致性的重构；利用预训练人脸身份特征提取网络以及判别网络，实现整体网络的循环一致性训练；利用重构特征编码子网络提取重构图像的潜在重构背景特征，结合潜在背景特征，实现静默人脸活体的判别；利用构建的网络模型以及训练方式，仅需正常人脸图像的正样本作为训练数据，能够保证人脸活体检测的鲁棒性与泛化性，提高人脸假体攻击的有效性，为后续人脸识别的实际应用打下坚实基础。附图说明图1为实施例1提供的基于正样本训练的人脸静默活体检测方法流程图；图2为实施例1提供的网络模型的结构示意图；图3为实施例1提供的重构图像生成网络的结构示意图；图4为实施例1提供的图像特征编码子网络结构示意图；图5为实施例1提供的图像重构子网络的结构示意图；图6a、6b和6c为实施例1提供的重构特征编码子网络结构示意图；图7为实施例1提供的判别网络的结构示意图；图8为实施例2提供的基于正样本训练的人脸静默活体检测装置结构框图；图9实施例3提供的计算机设备结构框图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合实施例及附图对本发明作进一步详细的描述。实施例1：本实施例基于TensorFlow框架和Pycharm的开发环境。TensorFlow框架是基于python语言的开发架构，能够方便快捷地搭建合理的深度学习网络，同时具有很好的跨平台交互能力；能够提供深度学习架构中的众多封装函数和各类图像处理函数的接口，包括OpenCV相关的图像处理函数；同时能够使用GPU对模型进行训练和验证，提高了计算的效率。在Windows平台或者Linux平台下的Pycharm开发环境，是目前深度学习网络设计与开发的首选之一。Pycharm为客户提供了新的模板、设计工具以及测试和调试工具，同时能够为客户提供直接调用远程服务器的接口。如图1所示，为本实施例提供的基于正样本训练的人脸静默活体检测方法，主要包括以下步骤：S101、获取训练数据集；获取当前主流的人脸图像数据库；将图像数据库中的清晰人脸图像，作为训练所需的正样本。S102、利用网络模型中重构图像生成网络的图像特征编码子网络，对输入正常人脸图像进行特征编码与分离，获得潜在人脸特征与潜在背景特征。如图2所示，构建的网络模型包括三个子网络，分别为重构图像生成网络、判别网络、预训练人脸身份特征提取网络和重构特征编码子网络。如图3所示，重构图像生成网络中的图像特征编码子网络包括第一特征编码器和第一特征分离模块，用于生成潜在人脸特征和潜在背景特征。第一特征编码器包括9个卷积层、9个线性整流层ReLU以及两个池化层，所有卷积层的卷积核大小为3，步长为1，池化层的步长为2，最后生成256通道的潜在整体特征。第一特征分离模块包含有一个特征分离层和2个卷积层，特征分离层将256通道的图像特征分成128通道的第一分支特征和128通道的第二分支，由第一分支特征经过卷积核大小为1的卷积层生成64通道的潜在人脸特征，由第二分支特征经过卷积核大小为3，步长为1的卷积层生成64通道的潜在背景特征。在图像特征编码子网络中，通过特征提取与特征分离，将整体图像特征分解为对应的人脸特征与背景特征，使到网络对输入图像的不同成分进行各自表征，有利于后续图像重构与模型训练。将训练数据集中的正常人脸图像输入重构图像生成网络中的图像特征编码子网络，得到潜在人脸特征和潜在背景特征具体包括：输入正常人脸图像为I，通道数为3，利用第一特征编码器生成潜在整体特征为：其中，CRi,i＝1,...,9表示具有ReLU激活函数的卷积层，Pi,i＝1,2,3表示池化层；第一特征分离模块是将输入的潜在整体特征为两部分，分别对这两部分进行卷积层处理，获得潜在人脸特征和潜在背景特征如下所示：其中Half表示特征分离层，Cd1,Cd2分别表示第一分支和第二分支的卷积层。S103、利用网络模型中重构图像生成网络的图像重构子网络，对潜在人脸特征与潜在背景特征进行重构，得到重构清晰人脸图像与重构正常人脸图像。如图4所示，重构图像生成网络的图像重构子网络包括四个部分，分别为人脸特征解码器、背景特征解码器、特征重构模块和特征重组重构模块，具体如下：人脸特征解码器，包含有9个卷积层、9个线性整流层ReLU以及两个上采样层，所有卷积层的卷积核大小为3，步长为1，上采样层放大倍数为2，输入为潜在人脸特征，最后生成64通道的深层人脸特征。背景特征解码器与人脸特征解码器具有相同的网络结构，输入为潜在背景特征，最后生成64通道的深层背景特征。特征重构模块，包括有2个卷积层和1个Tanh激活函数层，输入为深层人脸特征最后生成3通道的重构清晰人脸图像。特征重组重构模块，包括1个特征叠加操作层、2个卷积层和1个Tanh激活函数层，卷积层的卷积核大小为3，步长为1，最后生成3通道的重构正常人脸图像。将潜在人脸特征与潜在背景特征输入图像重构子网络，得到重构清晰人脸图像与重构正常人脸图像，具体包括：人脸特征解码器是将通道数为64的潜在人脸特征解码为通道数为32的深层人脸特征为：其中CRi,i＝1,...,9表示具有ReLU激活函数的卷积层，Upi,i＝1,2,3表示上采样层；接着，特征重构模块，利用通道数为32的深层人脸特征生成重构清晰人脸图像Ic：其中C1,C2为卷积层，T表示Tanh激活函数层。背景特征解码器将通道数为64的潜在背景特征解码为通道数为32的深层背景特征为：其中CRi,i＝1,...,9表示具有ReLU激活函数的卷积层，Upi,i＝1,2,3表示上采样层；接着，特征重组重构模块将深层背景特征和深层人脸特征进行级联后，通过卷积层和Tanh激活层操作，获得通道数为3的重构正常人脸图像：其中，S表示特征级联操作，C1,C2表示卷积层，T表示Tanh激活函数层。S104、利用网络模型中的重构特征编码子网络对重构正常人脸图像进行特征提取，得到潜在重构人脸特征和潜在重构背景特征。如图6a、6b和6c所示，重构特征编码子网络与重构图像生成网络中的图像特征编码子网络结构相同，包括第二特征编码器和第二特征分离模块，用于生成潜在重构人脸特征和潜在重构背景特征第二特征编码器包括9个卷积层、9个线性整流层ReLU以及两个池化层，所有卷积层的卷积核大小为3，步长为1，池化层的步长为2，最后生成256通道的潜在整体特征。第二特征分离模块包含有一个特征分离层和两个卷积层，特征分离层将256通道的图像特征分成128通道的第一分支特征和128通道的第二分支，由第一分支特征经过卷积核大小为1的卷积层生成64通道的潜在人脸特征，由第二分支特征经过卷积核大小为3，步长为1的卷积层生成64通道的潜在背景特征。S105、利用网络模型中的判别网络和预训练人脸身份特征提取网络对所述重构人脸图像和输入人脸图像进行判别，用于网络整体训练。如图7所示，判别网络包括六个卷积层、一个全连接层以及一个Softmax操作层，卷积层的卷积核大小均为3×3，步长为1，最后生成0或1的判别结果。判别网络的目的是将输入正常人脸图像判定为1，而将重构正常人脸图像判定为0。所述预训练人脸身份特征提取网络是通过现有人脸识别网络VGGface改进而来，具体为：首先，利用大量人脸数据集对人脸识别网络VGGface进行网络模型训练，得到对应的人脸识别网络；接着，利用所述的人脸识别网络，通过去除最后一层全连接层，将剩下的网络结构作为人脸身份特征提取网络，并且其网络参数在训练所述的人脸静默活体检测网络时保持不变。S106、根据所述高清高质量正常人脸图像的训练数据集，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型。生成网络模型的训练在高性能的GPU上进行，具体的训练参数设计如下：使用Adam优化器，其参数设置为0.9/0.999；epoch设置为100，学习率初始值设置为0.0001；batch设置依据训练数据集以及GPU内存大小而定，当训练数据集样本大并且GPU内存大时，batch可以设置比较大，反之亦然。利用训练数据集对生成网络模型进行训练，具体包括：设计以下的损失函数：1)优化输入正常人脸图像I与重构正常人脸图像Ireal之间的像素差异，设置损失函数，如下所示：其中，H与W分别为输入正常人脸图像I的高度与宽度，||·||1为L1范数的度量形式；2)优化输入正常人脸图像I与重构正常人脸图像Ireal之间的对抗损失函数，设置对应的对抗损失函数如下所示：其中分别表示输入正常人脸图像和重构正常人脸图像所对应的样本分布；表示分布函数的期望值，D分别表示判别网络，log表示log函数；3)优化输入正常人脸图像I与重构清晰人脸图像Ic之间的身份信息差异，设置损失函数如下所示：其中f表示预训练人脸身份特征提取网络，M表示所提取的人脸身份信息特征长度，||·||2为L2范数的度量形式；4)分别优化所提取的潜在人脸特征与潜在重构人脸特征潜在背景特征与潜在重构背景特征之间的差异，设计损失函数如下所示：其中，Kface,KBG分别为潜在人脸特征潜在背景特征的特征长度，||·||1为L1范数的度量形式；通过交替优化以下所述整体损失函数，实现网络模型的收敛：其中G表示整体网络结构，包括重构图像生成网络与重构特征编码子网络；D分别表示判别网络。具体为：通过计算上述损失函数结果，采用随机梯度下降法进行后向传播计算，对网络模型的网络参数进行优化；为了使网络模型在训练过程中尽可能达到最优值，避免达到次优值，随着epoch增加，利用余弦退火策略将学习率而不断减小；当网络模型的epoch已达到预设的epoch值后时，则网络模型实现收敛，从而得到了训练好的网络模型。其中，网络模型的参数包括构成网络的各个卷积层、激化函数、正则化项等相关的参数，这些参数在网络训练过程中，不断优化迭代。S107、将实际设备采集的待测人脸图像输入所述训练好的网络模型，通过比较潜在重构背景特征与潜在背景特征之间的差异程度，确定输入人脸图像的活体性。具体包括：根据实际需求，获取实际输入的人脸图像；本实施例中，直接从人脸识别设备的前端机获取所采集的相关人脸图像。将所述待检测人脸图像输入所述训练好的网络模型，生成对应的潜在背景特征与潜在重构背景特征计算特征差异通过判断Δ是否大于预设的阈值，判断输入人脸图像的静默活体检测；若大于阈值，则输入人脸图像为假人脸图像，反之，则为正常人脸图像。综上所述，本实施例公开的一种基于正样本训练的人脸静默活体检测方法，主要过程包括获网络模型的建立、网络模型的训练和网络模型的运用三个阶段，其中：网络模型的建立：整体网络模型包括重构图像生成网络、重构特征编码子网络、判别网络和预训练人脸身份特征提取网络，利用重构图像生成网络对输入正常人脸图像进行潜在特征提取与图像重构，得到重构清晰人脸图像和重构正常人脸图像；利用重构特征编码子网络对重构正常人脸图像进行特征提取，得到潜在重构人脸特征和潜在重构背景特征；最后，利用判别网络和预训练人脸身份特征提取网络进行图像判断，辅助后续模型训练。网络模型的训练：云端服务器对网络模型进行训练，通过优化损失函数，并调整网络模型参数，直至网络模型的收敛。网络模型的运用：首先，通过实际设备采集对应的待测人脸图像；接着，将待测人脸图像输入所述训练好的网络模型；最后，通过比较潜在重构背景特征与潜在背景特征之间的差异程度，确定输入人脸图像的活体性。本领域技术人员可以理解，实现上述实施例的方法中的全部或部分步骤可以通过程序来指令相关的硬件来完成，相应的程序可以存储于计算机可读存储介质中。应当注意，尽管在附图中以特定顺序描述了上述实施例的方法操作，但是这并非要求或者暗示必须按照该特定顺序来执行这些操作，或是必须执行全部所示的操作才能实现期望的结果。相反，描绘的步骤可以改变执行顺序。附加地或备选地，可以省略某些步骤，将多个步骤合并为一个步骤执行，和/或将一个步骤分解为多个步骤执行。实施例2：如图8所示，本实施例提供了一种基于正样本训练的人脸静默活体检测装置，该装置包括获取模块601、图像特征编码模块602、图像重构模块603、重构特征编码模块604、判别模块605、身份特征提取模块606、优化模块607和活体检测模块608，其中：获取模块601，用于获取训练数据集；其中，所述训练数据集中的图像为高清高质量的正常人脸图像；图像特征编码模块602，用于利用网络模型中的图像特征编码子网络对所述正常人脸图像进行特征编码和提取，得到潜在人脸特征和潜在背景特征；图像重构模块603，用于利用网络模型中的图像重构子网络对所述潜在人脸特征和潜在背景特征分别进行图像重构深层特征提取，得到重构清晰人脸图像和重构正常人脸图像；重构特征编码模块604，用于利用网络模型中的重构特征编码子网络对所述图重构正常人脸图像进行特征编码和提取，得到潜在重构人脸特征和潜在重构背景特征；判别模块605，用于利用网络模型中的判别网络对所述输入正常人脸图像和重构正常人脸图像进行判别，得到图像差异；身份特征提取模块606，用于利用预训练人脸身份特征提取网络对所述输入正常人脸图像和重构清晰人脸图像进行判别，得到身份差异；优化模块607，用于根据所述训练数据集中的高清高质量正常人脸图像、图像差异以及身份差异，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型；活体检测模块608，用于将待测的人脸图像输入所述训练好的网络模型，通过判断潜在重构背景特征和潜在背景特征之间的差异，确定输入人脸的活性。本实施例中各个模块的具体实现可以参见上述实施例1，在此不再一一赘述；需要说明的是，本实施例提供的装置仅以上述各功能模块的划分进行举例说明，在实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能。实施例3：本实施例提供了一种计算机设备，该计算机设备可以为计算机，如图7所示，其通过系统总线701连接的处理器702、存储器、输入装置703、显示器704和网络接口705，该处理器用于提供计算和控制能力，该存储器包括非易失性存储介质706和内存储器707，该非易失性存储介质706存储有操作系统、计算机程序和数据库，该内存储器707为非易失性存储介质中的操作系统和计算机程序的运行提供环境，处理器702执行存储器存储的计算机程序时，实现上述实施例1的人脸静默活体检测方法，如下：获取训练数据集；其中，所述训练数据集中的图像为高清高质量的正常人脸图像；利用网络模型中重构图像生成网络的图像特征编码子网络，对输入正常人脸图像进行特征编码与分离，获得潜在人脸特征与潜在背景特征；利用网络模型中重构图像生成网络的图像重构子网络，对潜在人脸特征与潜在背景特征进行重构，得到重构清晰人脸图像与重构正常人脸图像；利用网络模型中的重构特征编码子网络对重构正常人脸图像进行特征提取，得到潜在重构人脸特征和潜在重构背景特征；利用网络模型中的判别网络和预训练人脸身份特征提取网络对所述重构人脸图像和输入人脸图像进行判别，用于网络整体训练；根据所述高清高质量正常人脸图像的训练数据集，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型；将实际设备采集的待测人脸图像输入所述训练好的网络模型，通过比较潜在重构背景特征与潜在背景特征之间的差异程度，确定输入人脸图像的活体性。实施例4：本实施例提供了一种存储介质，该存储介质为计算机可读存储介质，其存储有计算机程序，所述计算机程序被处理器执行时，实现上述实施例1的人脸静默活体检测方法，如下：获取训练数据集；其中，所述训练数据集中的图像为高清高质量的正常人脸图像；利用网络模型中重构图像生成网络的图像特征编码子网络，对输入正常人脸图像进行特征编码与分离，获得潜在人脸特征与潜在背景特征；利用网络模型中重构图像生成网络的图像重构子网络，对潜在人脸特征与潜在背景特征进行重构，得到重构清晰人脸图像与重构正常人脸图像；利用网络模型中的重构特征编码子网络对重构正常人脸图像进行特征提取，得到潜在重构人脸特征和潜在重构背景特征；利用网络模型中的判别网络和预训练人脸身份特征提取网络对所述重构人脸图像和输入人脸图像进行判别，用于网络整体训练；根据所述高清高质量正常人脸图像的训练数据集，优化网络模型的损失函数，实现网络模型的收敛，得到训练好的网络模型；将实际设备采集的待测人脸图像输入所述训练好的网络模型，通过比较潜在重构背景特征与潜在背景特征之间的差异程度，确定输入人脸图像的活体性。需要说明的是，本实施例的计算机可读存储介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是但不限于电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。虽然本发明所揭露的实施方式如上，但所述的内容只是为了便于理解本发明而采用的实施方式，并非用以限定本发明。任何本发明所属技术领域内的技术人员，在不脱离本发明所揭露的精神和范围的前提下，可以在实施的形式上及细节上作任何的修改与变化，但本发明的专利保护范围，仍须以所附的权利要求书所界定的范围为准。
