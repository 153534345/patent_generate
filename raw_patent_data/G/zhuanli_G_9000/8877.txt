标题title
基于能量最小化准则的椭球参数化算法及应用
摘要abst
本发明设计了一种基于能量最小化准则的椭球参数化算法及应用，旨在求解三维流形与其伴生椭球之间的保质量映射。主要步骤为：首先计算三维流形的伴生椭球，由能量最小化椭球共形参数化算法计算三维流形边界到其伴生椭球面的保角映射；其次，由拉伸能量最小化椭球面保质量算法确定三维流形边界到其伴生椭球面的保质量映射；最后，设定初始映射为恒等映射，建立最小化体拉伸能量模型，迭代求解优化模型以更新映射，最终得到三维流形与其伴生椭球之间的保质量映射。本发明针对目标区域为椭球，构建了一套较为完整的算法体系，是对流形参数化数值求解算法的进一步扩充。
权利要求书clms
1.基于能量最小化准则的椭球参数化算法，其特征在于，包含以下步骤：S1：计算三维流形的伴生椭球，由能量最小化椭球共形参数化算法计算三维流形边界到其伴生椭球面的保角映射；S2：由拉伸能量最小化椭球面保质量算法确定三维流形边界到其伴生椭球面的保质量映射；S3：设定初始映射为恒等映射，建立最小化体拉伸能量模型，迭代求解优化模型以更新映射，最终得到三维流形与其伴生椭球之间的保质量映射。2.根据权利要求1所述的基于能量最小化准则的椭球参数化算法，其特征在于，具体包含以下步骤：步骤1：确定三维流形的伴生椭球体；求解三维流形边界到伴生椭球面的调和映射，作为求解三维流形边界到伴生椭球面的保角映射g的初始值；建立最小化狄利克雷能量模型，并计算伴生椭球面的八个卦限上离散点的雅克比投影平面；设计迭代算法：依次拼接出三种投影平面Pa、Pb、Pc，划分内部点和外部点，并求解优化模型以更新相应的内部点位置；在椭球面上修正四个临界区域上的映射，即完成对映射g的一次迭代；当迭代终止时，得到三维流形边界到其伴生椭球面的保角映射g；步骤2：将步骤1得到的保角映射g作为求解三维流形边界到伴生椭球面的保质量映射fB的初始值；计算伴生椭球面的八个卦限上离散点的雅克比投影平面；设计迭代算法：建立映射fB对应的最小化拉伸能量模型；依次拼接出三种投影平面划分内部点和外部点，并求解优化模型以更新相应的内部点位置；在椭球面上修正四个临界区域上的映射，即完成对映射fB的一次迭代；当迭代终止时，得到三维流形边界到伴生椭球面的保质量映射fB；步骤3：将步骤2得到的fB作为三维流形到伴生椭球体的边界映射，将恒等映射作为内部映射fI的初始值；设计迭代算法：建立最小化体拉伸能量模型，求解该模型以更新fI，即完成一次迭代；当迭代终止时，得到三维流形与其伴生椭球之间的保质量映射f＝。3.根据权利要求2所述的基于能量最小化准则的椭球参数化算法，其特征在于，所述步骤1包含以下步骤：步骤1.1：选定三维流形上某一点为初始点，以最长测地线方向为初始方向，确定伴生椭球的几条主要测地线，根据测地线建立方程组求解伴生椭球的长半轴a、中半轴b和短半轴c；对三维流形进行网格剖分并建立最小化狄利克雷能量模型Lc；求解流形边界到伴生椭球面的调和映射，作为求解保角映射g的初始映射；计算伴生椭球的八个卦限上离散点的雅克比投影PJ；步骤1.2：将八个卦限的投影平面拼接成平面Pa，并区分Pa的内部点Ia和外部点Ba，用算法求解优化模型Lc以更新内部点的位置调整八个投影平面的拼接顺序，依次得到投影平面Pb,Pc，并重复上述步骤，得到Pc上的边界点位置和内部点位置步骤1.3：在遍历三种投影平面的过程中，存在四个临界区域内的点没有被更新，将这四个区域的中心点标记为临界点，并区分伴生椭球面上的点为内部点和外部点，求解优化模型LC以更新内部点的位置并由PJ将映射到投影平面的对应位置；步骤1.4：重复上述步骤1.2和1.3，当两步迭代的狄利克雷能量之差小于误差限时，通过得到对应的点即为三维流形边界到其伴生椭球面的保角映射。4.根据权利要求2所述的基于能量最小化准则的椭球参数化算法，其特征在于，所述步骤2包含以下步骤：步骤2.1：计算三维流形边界到伴生椭球面的保角映射，作为计算三维流形边界到伴生椭球面的保质量映射fB的初始映射；分别计算的八个卦限上离散点的雅克比投影步骤2.2：建立fB对应的最小化拉伸能量模型LS；将步骤2.1中的八个卦限的投影平面拼接成平面并区分的内部点和外部点用算法求解优化模型LS以更新内部点的位置调整八个投影平面的拼接顺序，依次得到投影平面并重复上述步骤，得到上的边界点位置和内部点位置步骤2.3：在遍历三种投影平面的过程中，存在四个临界区域内的点没有被更新，将这四个区域的中心点标记为临界点，并且区分伴生椭球面上的点为内部点和外部点，求解优化模型LS以更新内部点的位置并由PJ将映射到投影平面的对应位置；步骤2.4：重复上述步骤2.2和2.3，当两步迭代的拉伸能量之差小于误差限时，通过得到对应的点即为三维流形边界到其伴生椭球面的保质量映射。5.一种基于能量最小化准则的椭球参数化算法的应用，其特征在于，应用于医学影像分割、曲面配准领域。6.根据权利要求5所述的一种基于能量最小化准则的椭球参数化算法的应用，其特征在于，在医学影像分割领域，采用基于能量最小化准则的椭球参数化算法对大脑、肝脏器官的影像进行预处理，将原本的器官对应到其伴生椭球上，通过二阶段的处理方法实现器官与长方体之间的双射，借助基于神经网络的肿瘤分割方法，将预处理的数据导入神经网络模型，实现人体器官内部肿瘤的分割与识别。7.根据权利要求5所述的一种基于能量最小化准则的椭球参数化算法的应用，其特征在于，在曲面配准领域，通过分别求解两个曲面与椭球之间的保质量双射，实现两个曲面之间的保质量双射。
说明书desc
技术领域本发明涉及一种求解球面边界单连通三维单纯复形到其伴生椭球的保质量参数化算法，属于参数化算法技术领域，具体涉及一种基于能量最小化准则的椭球参数化算法及应用。背景技术流形参数化通过双射将一般流形映射为圆盘、球面等典型区域，把复杂的流形转化到便于计算研究的区域上。从数值计算的角度来讲，流形参数化就是寻找单纯复形与典型区域之间的映射，目前，针对目标区域为复平面、单位球等典型区域已有了较为完善的理论。参数化问题在计算机图形学、医学影像、曲面配准等领域有广泛的应用。发明内容发明目的：本发明提供了一种基于能量最小化准则的椭球参数化算法，针对目标区域为流形的伴生椭球，构建了一套较为完整的算法体系，是对流形参数化数值求解算法的进一步扩充。技术方案：一种基于能量最小化的椭球参数化算法，其特征在于，包括以下步骤：步骤1：确定三维流形的伴生椭球体；求解三维流形边界到伴生椭球面的调和映射，作为求解三维流形边界到伴生椭球面的保角映射g的初始值；建立最小化狄利克雷能量模型，并计算伴生椭球面的八个卦限上离散点的雅克比投影平面；设计迭代算法：依次拼接出三种投影平面Pa、Pb、Pc，划分内部点和外部点，并求解优化模型以更新相应的内部点位置；在椭球面上修正四个临界区域上的映射，即完成对映射g的一次迭代；当迭代终止时，得到三维流形边界到其伴生椭球面的保角映射g；步骤1.1：选定三维流形上某一点为初始点，以最长测地线方向为初始方向，确定伴生椭球的几条主要测地线，根据测地线建立方程组求解伴生椭球的长半轴a、中半轴b和短半轴c；对三维流形进行网格剖分并建立最小化狄利克雷能量模型Lc；求解流形边界到伴生椭球面的调和映射，作为求解保角映射g的初始映射；计算伴生椭球的八个卦限上离散点的雅克比投影PJ；步骤1.2：将八个卦限的投影平面拼接成平面Pa，并区分Pa的内部点Ia和外部点Ba，用算法求解优化模型Lc以更新内部点的位置调整八个投影平面的拼接顺序，依次得到投影平面Pb,Pc，并重复上述步骤，得到Pc上的边界点位置和内部点位置步骤1.3：在遍历三种投影平面的过程中，存在四个临界区域内的点没有被更新，将这四个区域的中心点标记为临界点，并区分上的点为内部点和外部点，求解优化模型LC以更新内部点的位置并由PJ将映射到投影平面的对应位置；步骤1.4：重复上述步骤1.2和1.3，当两步迭代的狄利克雷能量之差小于误差限时，通过得到对应的点即为三维流形边界到其伴生椭球面的保角映射。步骤2：将步骤1得到的保角映射g作为求解三维流形边界到伴生椭球面的保质量映射fB的初始值；计算伴生椭球面的八个卦限上离散点的雅克比投影平面；设计迭代算法：建立映射fB对应的最小化拉伸能量模型；依次拼接出三种投影平面划分内部点和外部点，并求解优化模型以更新相应的内部点位置；在椭球面上修正四个临界区域上的映射，即完成对映射fB的一次迭代；当迭代终止时，得到三维流形边界到伴生椭球面的保质量映射fB；步骤2.1：计算三维流形边界到伴生椭球面的保角映射g的诱导向量g，作为计算流形边界到伴生椭球面的保质量映射fB的初始映射；分别计算半生椭球面的八个卦限上离散点的雅克比投影步骤2.2：建立fB对应的最小化拉伸能量模型LS；将步骤2.1中的八个卦限的投影平面拼接成平面并区分的内部点和外部点用算法求解优化模型LS以更新内部点的位置调整八个投影平面的拼接顺序，依次得到投影平面并重复上述步骤，得到上的边界点位置和内部点位置步骤2.3：在遍历三种投影平面的过程中，存在四个临界区域内的点没有被更新，将这四个区域的中心点标记为临界点，并且区分伴生椭球面上的点为内部点和外部点，求解优化模型LS以更新内部点的位置并由PJ将映射到投影平面的对应位置；步骤2.4：重复上述步骤2.2和2.3，当两步迭代的拉伸能量之差小于误差限时，通过得到对应的点即为三维流形边界到其伴生椭球面的保质量映射。步骤3：将步骤2得到的fB作为三维流形到伴生椭球体的边界映射，将恒等映射作为内部映射fI的初始值；设计迭代算法：建立最小化体拉伸能量模型，求解该模型以更新内部映射fI，即完成一次迭代；当迭代终止时，得到三维流形与其伴生椭球之间的保质量映射f＝。一种基于能量最小化准则的椭球参数化算法的应用，其特征在于，应用于医学影像分割、曲面配准等领域。其中，在医学影像分割领域，采用基于能量最小化准则的椭球参数化算法对大脑、肝脏等器官的影像进行预处理，将原本的器官对应到其伴生椭球上，借助基于神经网络的肿瘤分割方法，将预处理的数据导入神经网络模型，实现人体器官内部肿瘤的分割与识别；在曲面配准领域，通过分别求解两个曲面与椭球之间的保质量双射，可以实现两个曲面之间的保质量双射。有益效果：1、本发明通过实现三维流形与椭球一对一的变换，使得复杂的流形转化到易于研究的椭球上，在实际应用中降低了分析的复杂度，便于快速计算；2、使用能量最小化模型，满足保质量的性质，保留了流形本身的特征；3、利用了雅克比投影的共形性质，有效地将流形上的问题转化到平面上分析。附图说明图1是本发明所述的算法流程图。图2是具体实施案例中第一卦限的伴生椭球体。图3是具体实施案例中第一卦限的雅克比投影。图4是具体实施案例中雅克比投影的一种分割，其中五角星标注了四个临界点的位置。图5是具体实施案例中建立肝脏与长方体之间一一对应关系的示意图。图6是具体实施案例中肝脏、长方体、立方体三角剖分得到的二面角的角度分布，其中横坐标表示角度，纵坐标表示个数。图7是具体实施案例中视网膜眼底组织的三角剖分，其中圆形点标注了特征点的位置。图8是具体实施案例中建立视网膜眼底与长方体之间一一对应关系的示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面结合本发明实施例中的附图，对发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。因此，以下对在附图中提供的本发明的实施例的详细描述并非旨在限制要求保护的发明的范围。实施例1如图1所示，本发明提供了一种基于体拉伸能量最小化的椭球保质量参数化算法，具体步骤如下：步骤1：计算三维流形的伴生椭球，由能量最小化椭球共形参数化算法计算三维流形边界到其伴生椭球面的保角映射；步骤1.1：借助网站http://medicaldecathlon.com/的医学影像数据，以肝脏医学影像为例进行实验。肝脏医学影像是一个离散的三维流形，首先确定输入肝脏影像的伴生椭球体；将肝脏影像边界到伴生椭球面的调和映射作为求解保角映射的初始映射；计算伴生椭球的八个卦限上离散点的雅克比投影PJ；步骤1.1.1：选定最左侧的点v1为初始点，计算上由v1到v2的最长测地线记其方向为d，计算上由v1到v2沿-d方向的测地线固定坐标轴并将由d方向旋转至方向，其中为肝脏医学影像，为的边界，为上的顶点集合，v2表示上与v1距离最远的顶点；记m1，n1分别为两测地线的中点，记测地线将分成的两部分分别为和上所有与m1,n1距离相等的点的连线为上所有与m1,n1距离相等的点的连线为分别计算上经过m1,m2和m2,n1沿方向的测地线上经过m1,n2和n2,n1沿方向的测地线其中m2,n2分别是的中点；解关于a,b,c的非线性方程组：其中a＞b＞c＞0，分别表示对应弧的长度；利用更新参数的值：a←a/V，b←b/V，c←c/V，即为肝脏医学影像的伴生椭球体的长半轴、中半轴和短半轴的值；步骤1.1.2：连接上的点，根据连接线段长度与l1的比值划分伴生椭球面的边界，记为令I1和I2分别为以为赤道的椭球的上下半球对应的上的点的指标集合，表示边界点的指标集合，迭代求解线性系统s＝1,2，矩阵L的表示如下：其中，表示矩阵L中对应索引集Is的行与Is的列一同构成的子矩阵，表示矩阵L中对应索引集Is的行与IB的列一同构成的子矩阵；表示三维流形剖分得到的四面体边界上边的集合，θij和θji表示与边上相对的两个角。令为通过点和的线段，对于i∈Is,s＝1,2，记为与的交集，则由向量诱导的映射即为到调和映射的离散数值结果，其中步骤1.1.3：将步骤1.1.2得到的调和映射作为求解到的保角映射的初始映射；求解到的保角映射的问题即寻找映射使得狄利克雷能量泛函达到最小；上的狄利克雷能量泛函表示为：其中的含义为m表示上顶点的个数，LC的定义同步骤1.1.2中矩阵L，表示三维流形剖分得到的四面体边界上边的集合，θij和θji表示与边上相对的两个角；确定曲面上点的椭圆坐标。求解关于λ的方程：得到两个非平凡解ui和vi，雅克比共形投影可以由上述两根表示：在复平面上表示为步骤1.2：将八个投影平面拼接成平面Pa，并区分Pa的内部点Ia和外部点Ba，用算法求解优化模型以更新内部点的位置调整拼接顺序，依次将八个投影平面拼接成Pb,Pc，并重复上述步骤，得到Pc上的边界点位置和内部点位置步骤1.2.1：椭球面共分为八个卦限，图2展示了当a＝3,b＝2,c＝1时第一卦限的伴生椭球体，图3为其雅克比投影，根据雅克比投影的对称性，其余七个卦限的投影平面可以由图3进行翻转得到，将八个卦限的投影平面拼接成一个平面，得到如下由表格所示拼接方式，其中数字分别代表卦限的编号，因此图4与表格相互对应：43124687令Ba＝{1,…,m}Ia分别表示内部点与边界点，迭代求解线性系统其中分别表示矩阵LC中对应索引集Ia的行与Ia的列以及对应索引集Ia的行与Ba的列一同构成的子矩阵；步骤1.2.2：调整八个投影平面的拼接顺序，得到如表格所示的拼接方式，其中数字分别代表卦限的编号：87431256令Bb＝{1,…,m}Ib分别表示内部点与边界点，迭代求解线性系统其中分别表示矩阵LC中对应索引集Ib的行与Ib的列以及对应索引集Ib的行与Bb的列一同构成的子矩阵；步骤1.2.3：再次调整八个投影平面的拼接顺序，得到如表格所示的拼接方式，其中数字分别代表卦限的编号：41238567令Bc＝{1,…,m}Ic分别表示内部点与边界点，迭代求解线性系统其中分别表示矩阵LC中对应索引集Ic的行与Ic的列以及对应索引集Ic的行与Bc的列一同构成的子矩阵；步骤1.2.4：遍历三种投影平面后，存在四个临界区域内的点的取值没有被更新，将这四个区域的中心点标记为临界点，图4中由五角星标注了这四个临界点,的位置，考虑与它们对应的曲面上的点Qj,j＝1,…4，令Id＝{i||pi-Qj|≤δ,j＝1,…4,Bd＝{1,…,m}Id分别为内部点和外部点；求解线性系统其中由步骤1.1.3得到，即为临界区域内的保角映射，其中分别表示矩阵LC中对应索引集Id的行与Id的列以及对应索引集Id的行与Bd的列一同构成的子矩阵，下面将其映射到椭球面上：考虑其雅克比投影，求解关于λ的方程得到令由PJ将映射到投影平面的对应位置，以进行迭代；步骤1.3：迭代步骤1.2.1-1.2.4，当两步迭代的狄利克雷能量之差小于误差限时，通过得到对应的点即为流形边界到其伴生椭球面的保角映射。步骤2：由拉伸能量最小化椭球面保质量算法确定肝脏影像边界到其伴生椭球面的保质量映射；步骤2.1：由步骤1所述步骤确定肝脏医学影像边界到伴生椭球面的保角映射g，作为计算肝脏医学影像边界到的保质量映射fB的初始映射；按照步骤1.1.3所述求解伴生椭球上离散点的雅克比投影；步骤2.2：建立保质量映射fB对应的最小化拉伸能量模型；将步骤2.1中的八个投影平面拼接成平面并区分的内部点和外部点用算法求解优化模型以更新内部点的位置调整拼接顺序，依次将八个投影平面拼接成并重复上述步骤，得到上的边界点位置和内部点位置步骤2.2.1：求解到的保质量映射的问题即寻找映射使得拉伸能量泛函达到最小；上关于映射q的拉伸能量泛函为：其中的含义如步骤1.1.3中的LS的定义如下：其中表示肝脏三角剖分得到的四面体边界上边的集合，表示由i,j两点连成的边，和都代表连接这三点的三角形，θij和θji表示与边q上相对的两个角，表示三角形的密度，||表示三角形的面积；步骤2.2.2：依据实施例1的步骤2，建立对应最小化拉伸能量模型的迭代算法，每次迭代完成后，重新计算面拉普拉斯矩阵以更新最小化拉伸能量模型；步骤2.3：当两步迭代的拉伸能量之差小于误差限时，通过得到对应的点即为肝脏边界到其伴生椭球面的保质量映射。步骤3：设定初始映射为恒等映射，建立最小化体拉伸能量模型，迭代求解优化模型以更新映射，最终得到肝脏与其伴生椭球之间的保质量映射；步骤3.1：由步骤2所述拉伸能量最小化椭球面保质量参数化算法计算流形边界到其伴生椭球面的保质量映射fB，作为肝脏医学影像到伴生椭球体的保质量映射的边界映射，将恒等映射作为初始内部映射fI；步骤3.2：建立最小化体拉伸能量模型，求解该模型以更新内部映射fI；步骤3.2.1：求解到的保质量映射的问题即寻找映射使得体拉伸能量泛函达到最小；上的体拉伸能量泛函为：其中的含义如步骤1.1.3中的LV的定义如下：其中，表示肝脏三角剖分得到的四面体的边的集合，表示由i,j两点连成的边，和分别代表连接这三点的三角形，表示边与上相对的两个角，表示四面体τ的密度，vi表示τ上的顶点，|f|表示四面体f的体积；步骤3.2.2：求解线性系统确定内部映射fI，其中I,I表示矩阵中对应索引集I的行与I的列一同构成的子矩阵，I,B表示矩阵中对应索引集I的行与B的列一同构成的子矩阵；由f＝更新最小化体拉伸能量模型；步骤3.2.3：迭代上述步骤3.2.1和3.2.2，当两步迭代的体拉伸能量之差小于误差限时，得到f＝即为肝脏到其伴生椭球的保质量映射。如图5所示，进一步建立伴生椭球与长、宽、高分别为a,b,c的长方体之间的一一对应关系，就能得到肝脏与长方体的保质量双射，再将长方体上的数据作为神经网络的输入数据，利用神经网络即可完成对肝脏内部组织的分割。以一个肝脏医学影像为例，图6展示了肝脏经伴生椭球得到长方体与经球体得到立方体的三角剖分中二面角的角度分布，从图中可以看出，原始的肝脏图像三角剖分得到的二面角角度分布的众数为59°，平均数为26.152°，与之相关的长方体的三角剖分得到的二面角角度分布的众数为54°，平均数为25.453°，而对应立方体的二面角角度分布的众数为45°，平均数为29.191°，从结果中可以看出，长方体更好地保留了肝脏的角度分布的特征。表1显示了将质量作为运输成本时，分别借助球与伴生椭球将肝脏映射到立方体与长方体上不同阶段的映射之间的对比，说明借助伴生椭球实现肝脏与长方体之间的保质量映射有效地减小了运输成本，在一定程度上提高了计算效率。肝脏→伴生椭球→长方体肝脏→伴生椭球伴生椭球→长方体肝脏→长方体运输成本0.03810.01250.0423肝脏→球→立方体肝脏→球球→正方体肝脏→立方体运输成本0.12070.01130.1277表1.分别借助椭球和球实现肝脏与长方体之间保质量映射的运输成本对比实施例2如图1所示，本发明提供了一种基于体拉伸能量最小化的椭球参数化算法，可以应用于视网膜眼底的配准、注册，具体步骤如下：步骤1：借助网站https://ieee-dataport.org/open-access/octa-500的视网膜眼底数据为例进行实验。视网膜眼底影像是一个离散的三维流形，以一个视网膜眼底图像为例，图7显示了其三角网格剖分，其中圆形点标注了特征点的位置。首先确定输入视网膜眼底影像的伴生椭球体，依据实施例1中的步骤，实现视网膜眼底到伴生椭球的保质量映射f；步骤2：如图8所示，进一步建立伴生椭球与长、宽、高分别为a,b,c的长方体之间的一一映射g，复合得到视网膜眼底与长方体的保质量双射同时实现眼底组织边缘的特征点注册，即完成视网膜眼底曲面与长方体的配准过程；步骤3：借助基于神经网络的视网膜分层方法，将长方体上的数据作为输入数据导入神经网络模型，即可进一步实现对视网膜眼底内部组织层的分割与病变区域的识别。保质量映射可以看作特殊测度空间下的最优传输映射，因此可以进一步研究运输成本最小的保测度映射。基于以上理论的参数化算法可以对医学影像进行数据处理，借助机器学习算法实现人体器官内部肿瘤的分割与识别，提高医生的诊断效率和准确率。本发明方案所公开的技术手段不仅限于上述实施方式所公开的技术手段，还包括由以上技术特征任意组合所组成的技术方案。应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干改进和润饰，这些改进和润饰也视为本发明的保护范围。
