标题title
对预测视网膜年龄的预测模型进行训练的方法和相关产品
摘要abst
本申请公开了一种对预测视网膜年龄的预测模型进行训练的方法和相关产品。所述方法包括：获取标注有真实年龄标签的眼底图像数据；使用眼底疾病分类器对所述眼底图像数据进行分类，以获得相对于所述真实年龄标签的年龄偏移量；以及基于所述眼底图像数据、所述真实年龄标签和所述年龄偏移量对所述预测模型进行训练。利用本申请的方法，可以使得获得的视网膜年龄的预测结果更具有可解释性和合理性。
权利要求书clms
1.一种用于对预测视网膜年龄的预测模型进行训练的方法，其特征在于，包括：获取标注有真实年龄标签的眼底图像数据；使用眼底疾病分类器对所述眼底图像数据进行分类，以获得相对于所述真实年龄标签的年龄偏移量；以及基于所述眼底图像数据、所述真实年龄标签和所述年龄偏移量对所述预测模型进行训练。2. 根据权利要求1所述的方法，其特征在于，使用眼底疾病分类器对所述眼底图像数据进行分类，以获得相对于所述真实年龄标签的年龄偏移量包括：使用所述眼底疾病分类器对所述眼底图像数据进行分类，以获得各真实年龄段的分类响应分布；以及根据所述各真实年龄段的分类响应分布获得相对于所述真实年龄标签的年龄偏移量。3.根据权利要求2所述的方法，其特征在于，根据所述各真实年龄段的分类响应分布获得相对于所述真实年龄标签的年龄偏移量包括：基于所述各真实年龄段的分类响应分布确定各真实年龄段的目标阈值；计算所述各真实年龄段的响应均值；以及根据所述各真实年龄中样本数据的响应值、所述各真实年龄段的目标阈值和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量。4. 根据权利要求3所述的方法，其特征在于，根据所述各真实年龄中样本数据的响应值、所述各真实年龄段的目标阈值和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量包括：将所述各真实年龄中样本数据的响应值与所述各真实年龄段的目标阈值进行比较；以及根据所述各真实年龄中样本数据的响应值与所述各真实年龄段的目标阈值的比较结果和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量。5. 根据权利要求4所述的方法，其特征在于，根据所述各真实年龄中样本数据的响应值与所述各真实年龄段的目标阈值的比较结果和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量包括：响应于所述各真实年龄中样本数据的响应值小于目标阈值，获得相对于所述真实年龄标签的年龄偏移量为零；或者响应于所述各真实年龄中样本数据的响应值大于等于目标阈值，向下一真实年龄段进行搜索并且将所述各真实年龄中样本数据的响应值与下一真实年龄段的响应均值进行比较，直至所述各真实年龄中样本数据的响应值小于下一真实年龄段的响应均值时停止，获得相对于所述真实年龄标签的年龄偏移量为所述真实年龄标签至下一真实年龄的增量。6. 根据权利要求1所述的方法，其特征在于，基于所述眼底图像数据、所述真实年龄标签和所述年龄偏移量对所述预测模型进行训练包括：将所述眼底图像数据输入至预测模型并基于所述真实年龄标签和增加所述年龄偏移量的年龄标签进行预测，获得预测视网膜年龄的预测结果；以及基于所述预测结果、所述真实年龄标签和增加所述年龄偏移量的年龄标签选择损失函数，以对所述预测模型进行训练。7. 根据权利要求6所述的方法，其特征在于，所述损失函数包括第一损失函数、第二损失函数和第三损失函数，并且基于所述预测结果、所述真实年龄标签和增加所述年龄偏移量的年龄标签选择损失函数，以对所述预测模型进行训练包括：比较所述预测结果、所述真实年龄标签和增加所述年龄偏移量的年龄标签彼此之间的大小关系；以及基于比较结果选择所述第一、第二或者第三损失函数对所述预测模型进行训练。8.根据权利要求7所述的方法，其特征在于，基于比较结果选择所述第一、第二和第三损失函数对所述预测模型进行训练包括：响应于所述预测结果小于所述真实年龄标签，选择所述第一损失函数对所述预测模型进行训练；响应于所述预测结果大于所述真实年龄标签并且小于增加所述年龄偏移量的年龄标签，选择所述第二损失函数对所述预测模型进行训练；或者响应于所述预测结果大于增加所述年龄偏移量的年龄标签，选择所述第三损失函数对所述预测模型进行训练。9. 一种用于对预测视网膜年龄的预测模型进行训练的设备，其特征在于，包括：处理器；以及存储器，其存储有用于对预测视网膜年龄的预测模型进行训练的程序指令，当所述程序指令由所述处理器执行时，使得所述设备实现根据权利要求1-8任意一项所述的方法。10.一种计算机可读存储介质，其上存储有用于对预测视网膜年龄的预测模型进行训练的计算机可读指令，该计算机可读指令被一个或多个处理器执行时，实现根据权利要求1-8任意一项所述的方法。11. 一种用于对视网膜年龄进行预测的方法，其特征在于，包括：获取待进行预测的眼底图像数据；以及将所述眼底图像数据输入至根据权利要求1-8任意一项所述的方法完成训练的预测模型中，以输出对视网膜年龄进行预测的预测结果。12. 一种用于对视网膜年龄进行预测的设备，其特征在于，包括：处理器；以及存储器，其存储有用于对视网膜年龄进行预测的程序指令，当所述程序指令由所述处理器执行时，使得所述设备实现根据权利要求11所述的方法。13.一种计算机可读存储介质，其上存储有用于对视网膜年龄进行预测的计算机可读指令，该计算机可读指令被一个或多个处理器执行时，实现根据权利要求11所述的方法。
说明书desc
技术领域本申请一般涉及预测视网膜年龄技术领域。更具体地，本申请涉及一种用于对预测视网膜年龄的预测模型进行训练的方法、设备和计算机可读存储介质。进一步地，本申请还涉及一种用于对视网膜年龄进行预测的方法、设备和计算机可读存储介质。背景技术人的生长发育一般可以使用生物年龄来评价，例如通过人类骨骼测算的骨龄。这是由于人类骨骼的发育基本相似且在不同时段具备不同的形态，所以在医学上通过被测者腕骨X光的形态可以判断骨龄，从而评价被测者发育情况，对儿科内分泌疾病的诊断有很大的帮助。类似地，人的眼底图像也具有相似的特性，从眼底图像中可以清晰观察到视神经、黄斑、血管、视网膜等组织。随着年龄的增长、身体的老化，眼底图像中的前述组织结构会发生细微变化。目前，已有研究证明，基于深度学习技术可以完成通过视网膜眼底图像预测真实年龄，并能达成不错的效果。同时，研究发现经预测得到的视网膜年龄与真实年龄的差值与人体的细胞老化有相关性，与死亡风险也具有相关性。然而，由于现有的视网膜年龄预测方法多转化为传统的分类、回归或排序的问题，这些方法有些忽略真实年龄本身的连续性，有些忽略了标签的模糊性，从而未能有效利用数据集中的标签信息，使得预测结果的可解释性和合理性较差。发明内容为了至少部分地解决背景技术中提到的技术问题，本申请的方案提供了用于对预测视网膜年龄的预测模型进行训练的方法和用于对视网膜年龄进行预测的方案。利用本申请的方案，可以使得获得的视网膜年龄的预测结果更具有可解释性和合理性，提高了基于该预测结果评价人的生长变化和老化程度的可信度。为此，本申请在如下的多个方面提供解决方案。在第一方面中，本申请提供一种用于对预测视网膜年龄的预测模型进行训练的方法，包括：获取标注有真实年龄标签的眼底图像数据；使用眼底疾病分类器对所述眼底图像数据进行分类，以获得相对于所述真实年龄标签的年龄偏移量；以及基于所述眼底图像数据、所述真实年龄标签和所述年龄偏移量对所述预测模型进行训练。在一个实施例中，其中使用眼底疾病分类器对所述眼底图像数据进行分类，以获得相对于所述真实年龄标签的年龄偏移量包括：使用所述眼底疾病分类器对所述眼底图像数据进行分类，以获得各真实年龄段的分类响应分布；以及根据所述各真实年龄段的分类响应分布获得相对于所述真实年龄标签的年龄偏移量。在另一个实施例中，其中根据所述各真实年龄段的分类响应分布获得相对于所述真实年龄标签的年龄偏移量包括：基于所述各真实年龄段的分类响应分布确定各真实年龄段的目标阈值；计算所述各真实年龄段的响应均值；以及根据所述各真实年龄中样本数据的响应值、所述各真实年龄段的目标阈值和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量。在又一个实施例中，其中根据所述各真实年龄中样本数据的响应值、所述各真实年龄段的目标阈值和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量包括：将所述各真实年龄中样本数据的响应值与所述各真实年龄段的目标阈值进行比较；以及根据所述各真实年龄中样本数据的响应值与所述各真实年龄段的目标阈值的比较结果和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量。在又一个实施例中，其中根据所述各真实年龄中样本数据的响应值与所述各真实年龄段的目标阈值的比较结果和所述各真实年龄段的响应均值获得相对于所述真实年龄标签的年龄偏移量包括：响应于所述各真实年龄中样本数据的响应值小于目标阈值，获得相对于所述真实年龄标签的年龄偏移量为零；或者响应于所述各真实年龄中样本数据的响应值大于等于目标阈值，向下一真实年龄段进行搜索并且将各真实年龄中样本数据的响应值与下一真实年龄段的响应均值进行比较，直至各真实年龄中样本数据的响应值小于下一真实年龄段的响应均值时停止，获得相对于所述真实年龄标签的年龄偏移量为所述真实年龄标签至下一真实年龄的增量。在又一个实施例中，其中基于所述眼底图像数据、所述真实年龄标签和所述年龄偏移量对所述预测模型进行训练包括：将所述眼底图像数据输入至预测模型并基于所述真实年龄标签和增加所述年龄偏移量的年龄标签进行预测，获得预测视网膜年龄的预测结果；以及基于所述预测结果、所述真实年龄标签和增加所述年龄偏移量的年龄标签选择损失函数，以对所述预测模型进行训练。在又一个实施例中，其中所述损失函数包括第一损失函数、第二损失函数和第三损失函数，并且基于所述预测结果、所述真实年龄标签和增加所述年龄偏移量的年龄标签选择损失函数，以对所述预测模型进行训练包括：比较所述预测结果、所述真实年龄标签和增加所述年龄偏移量的年龄标签彼此之间的大小关系；以及基于比较结果选择所述第一、第二或者第三损失函数对所述预测模型进行训练。在又一个实施例中，其中基于比较结果选择所述第一、第二或者第三损失函数对所述预测模型进行训练包括：响应于所述预测结果小于所述真实年龄标签，选择所述第一损失函数对所述预测模型进行训练；响应于所述预测结果大于所述真实年龄标签并且小于增加所述年龄偏移量的年龄标签，选择所述第二损失函数对所述预测模型进行训练；响应于所述预测结果大于增加所述年龄偏移量的年龄标签，选择所述第三损失函数对所述预测模型进行训练。在第二方面中，本申请还提供一种用于对预测视网膜年龄的预测模型进行训练的设备，包括：处理器；以及存储器，其存储有用于对预测视网膜年龄的预测模型进行训练的程序指令，当所述程序指令由所述处理器执行时，使得所述设备实现前述第一方面中所述的方法。在第三方面中，本申请还提供一种计算机可读存储介质，其上存储有用于对预测视网膜年龄的预测模型进行训练的计算机可读指令，该计算机可读指令被一个或多个处理器执行时，实现前述第一方面中所述的方法。在第四方面中，本申请还提供一种用于对视网膜年龄进行预测的方法，包括：获取待进行预测的眼底图像数据；以及将所述眼底图像数据输入至根据前述第一个方面所述多个实施例完成训练的预测模型中，以输出对视网膜年龄进行预测的预测结果。在第五方面中，本申请还提供一种用于对视网膜年龄进行预测的设备，包括：处理器；以及存储器，其存储有用于对视网膜年龄进行预测的程序指令，当所述程序指令由所述处理器执行时，使得所述设备实现前述第四方面中所述的方法。在第六方面中，本申请还提供一种计算机可读存储介质，其上存储有用于对视网膜年龄进行预测的计算机可读指令，该计算机可读指令被一个或多个处理器执行时，实现前述第四方面中所述的方法。通过本申请的方案，通过利用眼底疾病分类器对眼底图像数据进行分类，以获得年龄偏移量，并在训练预测模型时使用真实年龄标签和年龄偏移量。基于此，可以实现动态微调预测的年龄真实标签，使得视网膜年龄的预测结果更具有可解释性和合理性。由此，使得利用本申请的视网膜年龄的预测结果评价例如人的生长变化和老化程度的评价结果具有较高的可信度。附图说明通过参考附图阅读下文的详细描述，本申请示例性实施方式的上述以及其他目的、特征和优点将变得易于理解。在附图中，以示例性而非限制性的方式示出了本申请的若干实施方式，并且相同或对应的标号表示相同或对应的部分，其中：图1是示出根据本申请实施例的用于对预测视网膜年龄的预测模型进行训练的方法的示例性流程框图；图2是示出根据本申请实施例的真实年龄段的分类响应分布的示例性示意图；图3是示出根据本申请实施例的用于对预测视网膜年龄的预测模型进行训练的示例性示意图；图4是示出根据本申请实施例的用于对视网膜年龄进行预测的方法的示例性流程框图；以及图5是示出根据本申请实施例的用于对预测视网膜年龄的预测模型进行训练或用于对视网膜年龄进行预测的设备的示例性结构框图。具体实施方式下面将结合附图对本申请实施例中的技术方案进行清楚和完整地描述。应当理解的是本说明书所描述的实施例仅是本申请为了便于对方案的清晰理解和符合法律的要求而提供的部分实施例，而并非可以实现本申请的所有实施例。基于本说明书公开的实施例，本领域技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。如背景技术描述可知，已有研究证明，基于深度学习技术可以完成通过视网膜眼底图像预测真实年龄，并能达成不错的效果，例如现有的视网膜年龄预测方法多转化为传统的分类或回归等。其中，对于传统的回归方法而言，其是将例如眼底图像输入至深度学习网络，以真实年龄作为标签，并且使用例如MAE、MSE等损失函数对任务进行监督，从而使得模型学习后具备预测年龄的能力。对于传统的分类而言，其首先通过将年龄分段后划分为不同的类别，并且年龄分段的细粒程度可以进行控制，例如将每3岁为一分段或每5岁为一分段并化为不同类别。接着，使用深度学习中的分类的损失函数进行网络的训练，以便训练完成的模型在将同一分段的眼底图像在特征空间进行近似的表达，以达到分类的效果。然而，无论是传统的回归方法还是分类方法，亦或是排序方法，其会忽略真实年龄本身的连续性或者标签的模糊性，从而未能有效利用数据集中的标签信息，使得预测结果的可解释性和合理性较差。鉴于此，本申请实施例提供了一种用于对预测视网膜年龄的预测模型进行训练和用于对视网膜年龄进行预测的方案，通过将简单的分类任务转化为标签分布学习，通过约束标签分布和预测分布之间的相似性，以充分有效利用年龄标签模糊性和标签信息。进一步地，通过利用眼底疾病分类来动态调整年龄标签，使得视网膜年龄的预测结果更具有可解释性和合理性。图1是示出根据本申请实施例的用于对预测视网膜年龄的预测模型进行训练的方法100的示例性流程框图。如图1中所示，在步骤102处，获取标注有真实年龄标签的眼底图像数据。在一个实施例中，前述眼底图像数据可以采用例如眼底相机进行拍摄，在拍摄获得的眼底图像数据上分别标注每个被拍摄者的真实年龄，从而获得标注有真实年龄标签的眼底图像数据。在获得前述标注有真实年龄标签的眼底图像数据后，在步骤104处，使用眼底疾病分类器对眼底图像数据进行分类，以获得相对于真实年龄标签的年龄偏移量。具体而言，首先使用眼底疾病分类器对眼底图像数据进行分类，以获得各真实年龄段的分类响应分布，接着根据各真实年龄段的分类响应分布获得相对于真实年龄标签的年龄偏移量。在一个实施例中，上述眼底疾病分类器可以是已经训练好的二分类模型。其中，前述眼底疾病分类器分类的眼底疾病可以包括与老年化相关的静脉、玻璃膜疣、动脉硬化、糖网等眼底疾病。在应用场景中，每个被拍摄者对应的眼底图像数据经过前述眼底疾病分类器分类后，分别对应一个响应值，并且该响应值的范围在0至1之间，以表示被拍摄者是否有老年化眼底疾病。由于每个被拍摄者的眼底图像数据中对应标注有真实年龄，因此根据真实年龄进行划分，可以获得每个真实年龄段下对应的各个眼底图像数据分类的响应值，从而获得各真实年龄段的分类响应分布。进一步地，根据各真实年龄段的分类响应分布获得相对于真实年龄标签的年龄偏移量。在一个实现场景中，首先可以基于各真实年龄段的分类响应分布确定各真实年龄段的目标阈值，接着计算各真实年龄段的响应均值，以根据各真实年龄中样本数据的响应值、各真实年龄段的目标阈值和各真实年龄段的响应均值获得相对于真实年龄标签的年龄偏移量。其中，前述各真实年龄段的目标阈值可以根据各真实年龄段中目标样本的响应值来确定，而前述目标样本的选取可以根据各真实年龄段的分类响应分布进行选取。例如在一个示例性场景中，可以选择每个真实年龄段中前2.5%或前5%的人群作为目标样本。在该场景下，将前2.5%或者前5%中最后一个样本的眼底图像数据对应的响应值作为目标阈值。作为示例，假设一个真实年龄段中有10000个人，可以选取其前250个人或前500个人作为目标样本，并且将第250个人或者第500个人的眼底图像数据对应的响应值作为目标阈值。基于确定的目标阈值，可以将眼底疾病分成两类，包括有老年化眼底疾病和无老年化眼底疾病。例如，当各真实年龄段中样本数据的响应值大于等于目标阈值时，可以认为各真实年龄段中存在有老年化眼底疾病高风险的人群，其眼底图像数据中已存在异于相应真实年龄段的特征。在实现场景中，将有老年化眼底疾病人群对应的眼底图像数据上标注的真实年龄标签向上波动，其波动的值即为相对于真实年龄标签的年龄偏移量。在一个实施例中，首先可以通过将各真实年龄中样本数据的响应值与各真实年龄段的目标阈值进行比较，接着根据各真实年龄中样本数据的响应值与各真实年龄段的目标阈值的比较结果和各真实年龄段的响应均值获得相对于真实年龄标签的年龄偏移量。可以理解，在将各真实年龄中样本数据的响应值与目标阈值进行比较时，其是将各真实年龄段中每个样本的眼底图像数据对应的分类响应值分别与各真实年龄段对应的目标阈值进行比较，以确定每个样本是否有老年化眼底疾病，进而再与各真实年龄段的响应均值进行比较来确定相对于真实年龄标签的年龄偏移量。具体地，响应于各真实年龄中样本数据的响应值小于目标阈值，获得相对于真实年龄标签的年龄偏移量为零。响应于各真实年龄中样本数据的响应值大于等于目标阈值，向下一真实年龄段进行搜索并且将各真实年龄中样本数据的响应值与下一真实年龄段的响应均值进行比较，直至各真实年龄中样本数据的响应值小于下一真实年龄段的响应均值时停止，获得相对于真实年龄标签的年龄偏移量为真实年龄标签至下一真实年龄的增量。也就是说，当各真实年龄段中样本数据的响应值小于目标阈值时，意味着该相应样本无老年化眼底疾病，从而无需调整其眼底图像数据中的真实年龄标签，由此真实年龄标签的年龄偏移量为零。当各真实年龄段中样本数据的响应值大于等于目标阈值时，意味着该相应样本有老年化眼底疾病，由此在相应样本对应的眼底图像数据中的真实年龄标签上增加相应的年龄偏移量。在该情形下，将该样本数据的响应值与下一真实年龄段的响应均值进行比较，假如当前真实年龄段中相应样本的响应值大于下一真实年龄段的响应均值，表示在该年龄段仍然有老年化眼底疾病。进一步地，将当前真实年龄段中相应样本的响应值再与下一真实年龄段的响应均值进行比较，直至相应样本的响应值小于下一真实年龄段的响应均值时停止，其年龄偏移量为真实年龄标签至下一真实年龄的增量。以真实年龄为27岁作为示例，首先可以根据该年龄段内前2.5%或者前5%的人群的响应值来确定对应的目标阈值。接着，对于27岁年龄段内的每个样本数据来说，当相应样本数据的响应值小于目标阈值时，其对应的年龄偏移量为零。当相应样本数据的响应值大于等于目标阈值时，向下一真实年龄段28岁进行搜索，当相应样本数据的响应值大于下一真实年龄段28岁的响应均值时，继续向下一真实年龄段29岁进行搜索。假设搜索到真实年龄段30岁时，相应样本数据的响应值小于真实年龄段30岁的响应均值，获得相对于真实年龄标签的年龄偏移量为3。在应用场景中，可以限制年龄偏移量不超过10。即，当年龄偏移量为10时，相应样本数据的响应值仍大于下一真实年龄段的响应均值，此时停止搜索并且10为最终的年龄偏移量。进一步地，在步骤106处，基于眼底图像数据、真实年龄标签和年龄偏移量对预测模型进行训练。在一个实施例中，首先将眼底图像数据输入至预测模型并基于真实年龄标签和增加年龄偏移量的年龄标签进行预测，获得预测视网膜年龄的预测结果，接着基于预测结果、真实年龄标签和增加年龄偏移量的年龄标签选择损失函数，以对预测模型进行训练。也即，以眼底图像数据为预测模型的输入，以真实年龄和增加年龄偏移量后的年龄为标签获得预测结果，进而根据预测结果、真实年龄和增加年龄偏移量后的年龄选择损失函数来计算损失值，以完成对预测模型进行训练。其中，上述损失函数可以包括第一损失函数、第二损失函数和第三损失函数。在一个实施场景中，可以通过比较预测结果、真实年龄标签和增加年龄偏移量的年龄标签彼此之间的大小关系，以基于比较结果选择第一、第二或者第三损失函数对预测模型进行训练。具体地，响应于预测结果小于真实年龄标签，选择第一损失函数对预测模型进行训练。响应于预测结果大于真实年龄标签并且小于增加年龄偏移量的年龄标签，选择第二损失函数对预测模型进行训练。或者，响应于预测结果大于增加年龄偏移量的年龄标签，选择第三损失函数对预测模型进行训练。在一个实施例中，本申请实施例的损失函数可以通过以下式子表示：其中，、、分别表示真实年龄标签、预测结果和增加年龄偏移量的年龄标签，表示眼底图像数据i经眼底疾病分类器输出的响应值，表示方差损失，，和表示权重，N表示眼底图像数据的数量。进一步地，上述公式中的式子从上往下分别对应第一、第二或者第三损失函数。结合上述描述可知，本申请实施例通过利用眼底疾病分类器辅助训练预测模型，使得获得的视网膜年龄预测模型不仅关注眼底正常老化的眼底特征，同时也能关注到超出年龄区间的老年化眼底疾病的发生。具体地，本申请实施例通过已有的眼底疾病分类器基于表示标注有真实年龄标签的眼底图像数据进行分类，以获得各真实年龄段的分类响应分布，并根据真实年龄段的分类响应分布动态调整真实年龄标签。进一步地，基于真实年龄标签和动态调整后的年龄标签进行视网膜年龄的预测，并基于预测结果和真实年龄标签和动态调整后的年龄标签的大小关系选择相应的损失函数对预测模型进行训练。基于此，使得视网膜年龄的预测结果更具有可解释性和合理性，并且使得利用本申请的视网膜年龄的预测结果评价例如人的生长变化和老化程度的评价结果具有较高的可信度。图2是示出根据本申请实施例的真实年龄段的分类响应分布的示例性示意图。如图2中示例性示出一个真实年龄段的分类响应分布，其中横坐标表示响应值，纵坐标表示样本。在实现场景中，可以从该分类响应分布中选取前2.5%或前5%的人群作为目标样本，并且该前2.5%或者前5%中最后一个样本的眼底图像数据对应的响应值作为目标阈值。作为示例，假设图中示出的A点所对应的响应值为前2.5%中最后一个样本的眼底图像数据对应的响应值，则A点所对应的响应值即为目标阈值。在该场景下，当该年龄段中相应样本数据的响应值小于目标阈值时，可以认为无老年化眼底疾病，从而获得真实年龄标签的年龄偏移量为零。当该年龄段中相应样本数据的响应值大于等于目标阈值时，向下一真实年龄段进行搜索，直至相应样本数据的响应值小于下一真实年龄段的响应均值时停止，获得年龄偏移量为真实年龄标签至下一真实年龄的增量。例如，假设图2中示出真实年龄标签为的分类响应分布，选取其前2.5%的人群作为目标样本，并且确定目标阈值。进一步地，假设真实年龄段中相应样本数据的响应值为，当相应样本数据的响应值，年龄偏移量Δy =0。当相应样本数据的响应值，向下一真实年龄段…进行搜索，并将与下一真实年龄段的响应均值M相比较。当时，则Δy= x。例如，当真实年龄标签为27时，其相应样本数据的响应值，并且其时，Δy= 3。在一些实施例中，可以限制Δy≤10。图3是示出根据本申请实施例的用于对预测视网膜年龄的预测模型进行训练的示例性示意图。如图3中所示，眼底图像数据301可以经由已有的眼底疾病分类器302进行分类，以获得各真实年龄段的分类响应分布。其中，前述眼底疾病分类器302可以例如是已经训练好的二分类模型，并且其分类的眼底疾病可以包括与老年化相关的静脉、玻璃膜疣、动脉硬化、糖网等眼底疾病。接着，根据各真实年龄段的分类响应分布可以获得相对于真实年龄标签的年龄偏移量Δy。关于获取年龄偏移量的更多细节，可以参考上述图1-图2所描述的内容，本申请在此不再赘述。图中进一步示出，眼底图像数据301输入至预测模型303进行预测，可以输出预测结果。具体地，该预测模型303以眼底图像数据301为输入，并且以真实年龄标签和增加年龄偏移量Δy的年龄标签为标签进行预测，从而获得预测结果。进一步地，根据预测结果、真实年龄标签和增加年龄偏移量Δy的年龄标签选择相应的损失函数计算损失值，以对预测模型303进行训练。例如，当小于真实年龄标签时选择第一损失函数；当大于真实年龄标签且小于增加年龄偏移量的年龄标签时选择第二损失函数；当大于增加年龄偏移量的年龄标签时选择第三损失函数。其中，关于前述各损失函数的计算，可以参见上述公式，本申请在此不再赘述。在一个实施例中，本申请还提供了一种用于对视网膜年龄进行预测的方法，即通过利用上述训练完成的预测模型对视网膜年龄进行预测，从而获得视网膜年龄的预测结果。图4是示出根据本申请实施例的用于对视网膜年龄进行预测的方法400的示例性流程框图。如图4中所示，在步骤402处，获取待进行预测的眼底图像数据。在一个实施例中，该眼底图像数据可以由眼底相机进行拍摄。接着，在步骤404处，将眼底图像数据输入至完成训练的预测模型中，以输出对视网膜年龄进行预测的预测结果。即，预测模型完成训练后，将眼底图像数据输入至预测模型，可以直接输出预测结果。关于预测模型训练的更多细节，可参考上述图1-图3所描述的内容，本申请在此不再赘述。图5是示出根据本申请实施例的用于对预测视网膜年龄的预测模型进行训练或用于对视网膜年龄进行预测的设备500的示例性结构框图。可以理解的是，实现本申请方案的设备可以是单一的设备或包括各种外围设备的多功能设备。如图5中所示，本申请的设备可以包括中央处理器或中央处理单元511，其可以是通用CPU、专用CPU或者其他信息处理以及程序运行的执行单元。进一步，设备500还可以包括大容量存储器512和只读存储器513，其中大容量存储器512可以配置用于存储各类数据，包括各种与标注有真实年龄标签的眼底图像数据或者待进行预测的眼底图像数据、算法数据、中间结果和运行设备500所需要的各种程序。ROM 513可以配置成存储对于设备500的加电自检、系统中各功能模块的初始化、系统的基本输入/输出的驱动程序及引导操作系统所需的数据和指令。可选地，设备500还可以包括其他的硬件平台或组件，例如示出的张量处理单元514、图形处理单元515、现场可编程门阵列516和机器学习单元517。可以理解的是，尽管在设备500中示出了多种硬件平台或组件，但这里仅仅是示例性的而非限制性的，本领域技术人员可以根据实际需要增加或移除相应的硬件。例如，设备500可以仅包括CPU、相关存储设备和接口设备来实现本申请的用于对预测视网膜年龄的预测模型进行训练的方法或用于对视网膜年龄进行预测的方法。在一些实施例中，为了便于数据与外部网络的传递和交互，本申请的设备500还包括通信接口518，从而可以通过该通信接口518连接到局域网/无线局域网505，进而可以通过该LAN/WLAN连接到本地服务器506或连接到因特网507。替代地或附加地，本申请的设备500还可以通过通信接口518基于无线通信技术直接连接到因特网或蜂窝网络，例如基于第3代、第4代或第5代的无线通信技术。在一些应用场景中，本申请的设备500还可以根据需要访问外部网络的服务器508和数据库509，以便获得各种已知的算法、数据和模块，并且可以远程地存储各种数据，例如用于呈现例如眼底图像数据、分类响应分布、训练模型过程以及预测结果等的各类数据或指令。设备500的外围设备可以包括显示装置502、输入装置503和数据传输接口504。在一个实施例中，显示装置502可以例如包括一个或多个扬声器和/或一个或多个视觉显示器，其配置用于对本申请的对预测视网膜年龄的预测模型进行训练或预测视网膜年龄进行语音提示和/或图像视频显示。输入装置503可以包括例如键盘、鼠标、麦克风、姿势捕捉相机等其他输入按钮或控件，其配置用于接收眼底图像数据的输入和/或用户指令。数据传输接口504可以包括例如串行接口、并行接口或通用串行总线接口、小型计算机系统接口、串行ATA、火线、PCI Express和高清多媒体接口等，其配置用于与其他设备或系统的数据传输和交互。根据本申请的方案，该数据传输接口504可以接收来自于眼底相机拍摄的眼底图像数据，并且向设备500传送包括眼底图像数据或各种其他类型的数据或结果。本申请的设备500的上述CPU 511、大容量存储器512、ROM 513、TPU 514、GPU 515、FPGA 516、MLU 517和通信接口518可以通过总线519相互连接，并且通过该总线与外围设备实现数据交互。在一个实施例中，通过该总线519，CPU 511可以控制设备500中的其他硬件组件及其外围设备。以上结合图5描述了可以用于执行本申请的用于对预测视网膜年龄的预测模型进行训练或用于对视网膜年龄进行预测的设备。需要理解的是这里的设备结构或架构仅仅是示例性的，本申请的实现方式和实现实体并不受其限制，而是可以在不偏离本申请的精神下做出改变。根据上述结合附图的描述，本领域技术人员也可以理解本申请的实施例还可以通过软件程序来实现。由此本申请还提供了一种计算机程序产品。该计算机程序产品可以用于实现本申请结合附图1-图3所描述的用于对预测视网膜年龄的预测模型进行训练的方法或结合图4所描述的用于对视网膜年龄进行预测的方法。应当注意，尽管在附图中以特定顺序描述了本申请方法的操作，但是这并非要求或者暗示必须按照该特定顺序来执行这些操作，或是必须执行全部所示的操作才能实现期望的结果。相反，流程图中描绘的步骤可以改变执行顺序。附加地或备选地，可以省略某些步骤，将多个步骤合并为一个步骤执行，和/或将一个步骤分解为多个步骤执行。应当理解，当本申请的权利要求、当说明书及附图中使用到术语“第一”、“第二”、“第三”和“第四”等时，其仅用于区别不同对象，而不是用于描述特定顺序。本申请的说明书和权利要求书中使用的术语“包括”和“包含”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。还应当理解，在此本申请说明书中所使用的术语仅仅是出于描述特定实施例的目的，而并不意在限定本申请。如在本申请说明书和权利要求书中所使用的那样，除非上下文清楚地指明其它情况，否则单数形式的“一”、“一个”及“该”意在包括复数形式。还应当进一步理解，在本申请说明书和权利要求书中使用的术语“和/或”是指相关联列出的项中的一个或多个的任何组合以及所有可能组合，并且包括这些组合。虽然本申请的实施方式如上，但所述内容只是为便于理解本申请而采用的实施例，并非用以限定本申请的范围和应用场景。任何本申请所述技术领域内的技术人员，在不脱离本申请所揭露的精神和范围的前提下，可以在实施的形式上及细节上作任何的修改与变化，但本申请的专利保护范围，仍须以所附的权利要求书所界定的范围为准。
