标题title
一种基于优选小波基与多维深度特征融合的滚动轴承声发射智能诊断方法
摘要abst
本发明涉及基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法。本发明包括：采集滚动轴承声发射信号，用基于信噪比和布伦纳梯度的质量指标选择连续小波变换的最优小波基；用选择出的最佳小波基做连续小波变换，将一维声发射信号转换为二维时频图；划分训练集、验证集和测试集，定义故障类型；构建多维深度特征融合神经网络模型。滚动轴承声发射信号输入到一维卷积神经网络、时频图输入到二维卷积神经网络，通过特征金字塔结构来对卷积神经网络提取的不同维度和不同深度的特征进行融合；由训练集训练模型，验证集调整模型，并使用测试集检验。本发明有效防止了模型的过拟合，增加了滚动轴承尤其是复合故障诊断的精度。
权利要求书clms
1.一种基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，其特征在于：包括以下步骤：Step1、采集滚动轴承声发射信号；Step2、用基于信噪比和布伦纳梯度的质量指标选择连续小波变换的最优小波基；Step3、用选择出的最佳小波基做连续小波变换，将一维声发射信号转换为二维时频图；Step4、划分训练集、验证集和测试集，定义故障类型；Step5、构建基于一维卷积、二维卷积和特征金字塔结构的多维深度特征融合神经网络模型，其中，所述神经网络模型输入滚动轴承声发射信号到一维卷积神经网络1D-CNN、输入时频图到二维卷积神经网络2D-CNN，通过特征金字塔FPN结构来对提取的不同维度和不同深度的特征进行融合；Step6、对模型进行训练的同时用验证集调整模型，最后用测试数据集进行测试。2.根据权利要求1所述的基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，其特征在于：所述Step2中，用基于信噪比SNR和布伦纳梯度BG的质量指标选择连续小波变换的最优小波基包括：利用布伦纳梯度BG和信噪比SNR构建质量指标QI来评价经连续小波转换后的滚动轴承时频图，其中：QI＝/2SNR＝10lg式中，I表示灰度图像地i行、第j列像素的灰度值，m为时频图像素的宽度，n为时频图像素点的高度，S为时频图的能量，N为噪声的能量，lg表示以10为底的常用对数。3.根据权利要求1所述的基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，其特征在于：所述Step4中，将一维滚动轴承声发射信号、二维时频图和与之对应的故障标签作为一个样本对，将全部样本按照一定的比例划分为训练集、验证集和测试集，滚动轴承的故障类型包括滚圈故障、滚子故障和滚圈滚子复合故障。4.根据权利要求1所述的基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，其特征在于：所述Step5中，构建基于一维卷积、二维卷积和特征金字塔结构的多维深度特征融合神经网络模型包括：Step5.1、模型为多输入模型，同时输入一维滚动轴承声发射信号和二维时频图；Step5.2、分别采用普通CNN结构与线性瓶颈反向残差轻量化结构Bneck块构建一维卷积神经网络1D-CNN与二维卷积神经网络2D-CNN分支结构，Bneck块从MobileNetV3中引入；1D-CNN为三层卷积成和池化层的交替出现；2D-CNN为三层卷积层和Bneck块的交替出现；Step5.3、模型中2D-CNN的最后一个Bneck块使用h-swish激活函数，其余的层均用ReLU激活函数，其公式表示如下：ReLU＝max式中，ReLU6是把ReLU的最大输出值限制为6，x为卷积层输出的特征；Step5.4、特征融合需要特征的维度相同，将2D-CNN提取的特征使用Reshape层转换维度后和1D-CNN提取的特征进行融合，特征融合时采用FPN结构融合提取出的高维和低维特征，1D-CNN、2D-CNN和特征金字塔的最后一层均使用全局平均池化层，在全局平均池化层之后使用输出层进行分类；Step5.5、模型采用交叉熵损失函数，其公式表达如下：式中，N为待分类的类别总数，yi为第i个类别对应的真实标签，为对应的模型输出值，lg表示以10为底的常用对数；Step5.6、通过输出为故障类型的Softmax层来匹配滚动轴承声发射数据的标签，其算法表述如下：式中，b为输入批量的大小，表示输出的第k个样本，当目标类别是j时，pj＝1，否则为qj，L为输出分类类别，lg表示以10为底的常用对数。
说明书desc
技术领域本发明涉及一种基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，属于机械故障诊断技术领域。背景技术滚动轴承是旋转机械的核心部件，由于常在复杂而恶劣的环境中工作，导致滚动轴承更易损坏。因此，实时检测滚动轴承运行状态十分重要。大数据的出现为机械故障诊断的研究和应用提供了更多的机会。在故障诊断领域，深度学习被证明是一种突破传统方法固有局限性的有效方法，可不依赖于信号处理技术和专家先验知识而直接采用测量数据自动获取、挖掘机械数据有效特征，以准确识别故障。深度学习方法具有强大的自学习能力，可自动从测量数据中获取有价值信息。由于CNN 独特的结构，其对高维非线性数据有很好的特征提取能力。声发射技术是一种无损检测方法，可检测材料内部动态缺陷，相对于振动方法可更早获取滚动轴承内部损伤信息，目前常用的分析方法包括参数分析和波形分析，这两种分析方法高度依赖于现场诊断工程师的经验，难免受主观因素影响。在实际工业环境中，滚动轴承往往产生复合故障，与单一故障信号相比，复合故障信号并不是单一故障信号的简单叠加，而是不同元件故障特征相互耦合，彼此干扰，使得声发射信号更加复杂，因此，给滚动轴承复合故障诊断带来巨大困难。多维融合数据可以发挥数据间的互补性，以弥补单维数据信息不完整的缺点。现有故障诊断领域的特征融合方法大多是用不同的深层网络各自提取特征，然后把不同特征进行组合拼接，这些方法在处理复杂故障数据时没有充分利用多维信息的低层细节信息和高层的语义信息。多维信息融合需要不同维度的信息，因小波时频图非常适合对非平稳非线性信号分析及处理，而声发射信号正属于这类数据，因此本专利将一维滚动轴承声发射信号与连续小波变换二维时频图相融合。不同的小波基会导致后续数据处理精度的差异。因此，对小波基的选择也是小波分析的关键步骤。综上，为解决多维信息利用不充分问题，本发明引入特征金字塔结构，提出一种基于优选小波基的多维深度特征融合的滚动轴承声发射智能故障诊断方法。该方法能准确识别滚动轴承复合故障，模型有较好的鲁棒性和泛化能力。发明内容本发明提供了一种基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，以用于解决滚动轴承复合故障难以准确诊断的问题。本发明的技术方案是：一种基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，包括以下步骤：Step1、采集滚动轴承声发射信号；Step2、用基于信噪比和布伦纳梯度的质量指标选择连续小波变换的最优小波基；Step3、用选择出的最佳小波基做连续小波变换，将一维声发射信号转换为二维时频图；Step4、划分训练集、验证集和测试集，定义故障类型；Step5、构建基于一维卷积、二维卷积和特征金字塔结构的多维深度特征融合神经网络模型，其中，所述神经网络模型输入滚动轴承声发射信号到一维卷积神经网络、输入时频图到2D-CNN，通过特征金字塔结构来对提取的不同维度和不同深度的特征进行融合；Step6、对模型进行训练的同时用验证集调整模型，最后用测试数据集进行测试。作为本发明的进一步方案，所述Step2中，为连续小波变换提出一种基于信噪比和布伦纳梯度质量指标的小波基选择方法，信噪比是基于统计特征的客观评价方法，是对原图和处理图像的误差统计，反映了待评价图像的逼真度。布伦纳梯度用于评价图像的清晰度，因其以图像像素直接处理为基础，具有计算简单、计算量小和实时性好的特点。单一指标评价时频图存在片面性，SNR和BG的结合可对其进行更为全面的评价。信噪比越大图像越逼真，布伦纳梯度值越大图像越清晰，两个指标和图像质量都成正比关系，取两个指标的均值作为质量指标。综上，QI越大则时频图的质量越好，时频图质量越好则对应的小波基越好，进而确定最佳小波基；用基于信噪比SNR和布伦纳梯度BG的质量指标选择连续小波变换的最优小波基包括：利用布伦纳梯度BG和信噪比SNR构建质量指标QI来评价经连续小波转换后的滚动轴承时频图，其中：QI＝/2SNR＝10lg 式中，I表示灰度图像地i行、第j列像素的灰度值，m为时频图像素的宽度， n为时频图像素点的高度，S为时频图的能量，N为噪声的能量，lg表示以10为底的常用对数。作为本发明的进一步方案，所述Step4中，将一维滚动轴承声发射信号、二维时频图和与之对应的故障标签作为一个样本对，将全部样本按照一定的比例划分为训练集、验证集和测试集，滚动轴承的故障类型包括滚圈故障、滚子故障和滚圈滚子复合故障。作为本发明的进一步方案，所述Step5中，构建基于一维卷积、二维卷积和特征金字塔结构的多维深度特征融合神经网络模型包括：Step5.1、模型为多输入模型，同时输入一维滚动轴承声发射信号和二维时频图；Step5.2、分别采用普通CNN结构与线性瓶颈反向残差轻量化结构Bneck块构建一维卷积神经网络1D-CNN与二维卷积神经网络2D-CNN分支结构，Bneck块从 MobileNetV3中引入；1D-CNN为三层卷积成和池化层的交替出现；2D-CNN为三层卷积层和Bneck块的交替出现；Step5.3、模型中2D-CNN的最后一个Bneck块使用h-swish激活函数，其余的层均用ReLU激活函数，其公式表示如下：ReLU＝max式中，ReLU6是把ReLU的最大输出值限制为6；x为卷积层输出的特征；Step5.4、特征融合需要特征的维度相同，将2D-CNN提取的特征使用Reshape 层转换维度后和1D-CNN提取的特征进行融合，特征融合时采用FPN结构融合提取出的高维和低维特征，1D-CNN、2D-CNN和特征金字塔的最后一层均使用全局平均池化层，在全局平均池化层之后使用输出层进行分类；Step5.5、模型采用交叉熵损失函数，其公式表达如下：式中，N为待分类的类别总数，yi为第i个类别对应的真实标签，为对应的模型输出值，lg表示以10为底的常用对数；Step5.6、通过输出为故障类型的Softmax层来匹配滚动轴承声发射数据的标签，其算法表述如下：式中，b为输入批量的大小，表示输出的第k个样本，当目标类别是j时，pj＝1，否则为qj，L为输出分类类别，lg表示以10为底的常用对数。本发明的有益效果是：1、本发明提出一种基于信噪比和布伦纳梯度质量指标的小波基优选方法，该方法可准确的评估出适用于声发射信号连续小波变换的最佳小波基，为滚动轴承智能诊断模型提供高质量数据源；2、本发明提出了基于特征金字塔多维深度融合的滚动轴承声发射智能诊断模型，利用卷积神经网络将不同维度特征进行基于特征金字塔的深度融合，实现了不同维度、不同深度特征的整合。同时，利用线性瓶颈反向残差轻量化结构在很大程度上降低了模型的参数量，提升计算效率。采用本发明构建的模型对滚动轴承故障尤其是复合故障有很好的分类效果，分类精度高，不依赖于人工特征提取和专业知识积累，智能诊断模型的鲁棒性和泛化能力得到进一步增强。附图说明图1为本发明中的流程图；图2为本发明小波基质量指标示意图；图3为本发明多维深度特征融合模型示意图；图4为本发明测试集样本分类的混淆矩阵示意图。具体实施方式实施例1：如图1-图4所示，一种基于优选小波基与多维深度特征融合的滚动轴承声发射智能故障诊断方法，包括以下步骤：Step1、采集滚动轴承ZCFZ-51126在不同损坏情况下的声发射信号；采集到的数据包含有正常滚动轴承数据以及使用电火花损坏过的滚圈损伤数据、滚子损伤数据和滚圈滚子均损伤的复合故障数据，其损伤直径包含0.5mm和1mm；Step2、用基于信噪比和布伦纳梯度的质量指标选择连续小波变换的最优小波基，其中，在采集上述滚动轴承声发射信号后，为了确定连续小波变换的最佳小波基，将108种小波基作为候选，如表1所示；表1 108种候选小波基作为本发明的进一步方案，所述Step2中，用基于信噪比SNR和布伦纳梯度BG 的质量指标选择连续小波变换的最优小波基包括：作为本发明的进一步方案，所述Step2中，为连续小波变换提出一种基于信噪比SNR和布伦纳梯度BG质量指标QI的小波基选择方法，信噪比是基于统计特征的客观评价方法，是对原图和处理图像的误差统计，反映了待评价图像的逼真度。布伦纳梯度用于评价图像的清晰度，因其以图像像素直接处理为基础，具有计算简单、计算量小和实时性好的特点。单一指标评价时频图存在片面性，SNR和BG的结合可对其进行更为全面的评价。信噪比越大图像越逼真，布伦纳梯度值越大图像越清晰，两个指标和图像质量都成正比关系，取两个指标的均值作为质量指标。综上，QI越大则时频图的质量越好，时频图质量越好则对应的小波基越好，进而确定最佳小波基。质量指标计算结果如图2所示，最佳小波基标号为108即cmor3-3小波基；利用布伦纳梯度BG和信噪比SNR构建质量指标QI来评价经连续小波转换后的滚动轴承时频图，其中：QI＝/2 SNR＝10lg式中，I表示灰度图像地i行、第j列像素的灰度值，m为时频图像素的宽度，n为时频图像素点的高度，S为时频图的能量，N为噪声的能量，lg表示以10为底的常用对数。Step3、用选择出的最佳小波基做连续小波变换，将一维声发射信号转换为二维时频图；Step4、将上述采集到的一维滚动轴承声发射信号和转换后的二维时频图依据其损伤直径进行贴标签处理和与之对应的故障标签作为一个样本对划分训练集、验证集和测试集，定义故障类型，具体的可以将全部样本按照一定的比例划分为训练集、验证集和测试集，滚动轴承的故障类型包括滚圈故障、滚子故障和滚圈滚子复合故障。如表2所示为实验数据集；表2实验数据集上表将损伤状态分为7种，每个实验样本包含一维滚动轴承声发射信号和二维时频图，其中每种状态训练数据集为700组，验证数据集为200组，测试数据集为 100组；Step5、构建基于一维卷积、二维卷积和特征金字塔结构的多维深度特征融合神经网络模型；其中，所述神经网络模型输入滚动轴承一维声发射信号到1D-CNN、输入时频图到2D-CNN，通过FPN结构来对1D-CNN和2D-CNN提取的不同维度和不同深度的特征进行融合；构建基于一维卷积、二维卷积和特征金字塔结构的多维深度特征融合神经网络模型包括：Step5.1、模型为多输入模型，同时输入一维滚动轴承声发射信号和二维时频图；Step5.2、分别采用普通CNN结构与线性瓶颈反向残差轻量化结构Bneck块构建1D-CNN与2D-CNN分支结构，Bneck块从MobileNetV3中引入；1D-CNN为三层卷积层和池化层的交替出现；2D-CNN为三层卷积层和Bneck块的交替出现；Step5.3、模型中2D-CNN的最后一个Bneck块使用h-swish激活函数，其余的层均用ReLU激活函数，其公式表示如下：ReLU＝max 式中，ReLU6是把ReLU的最大输出值限制为6；x为卷积层输出的特征；Step5.4、特征融合需要特征的维度相同，将2D-CNN提取的特征使用Reshape 层转换维度后和1D-CNN提取的特征进行融合，特征融合时采用FPN结构融合提取出的高维和低维特征，1D-CNN、2D-CNN和特征金字塔的最后一层均使用全局平均池化，最后通过Softmax层输出分类结果，模型参数如表3所示；表3多维深度特征融合模型参数上表多维深度特征融合模型的参数与图3的模型结构对应，其中RE为ReLU激活函数，HS为h-swish激活函数；Step5.5、模型采用交叉熵损失函数，其公式表达如下：式中，N为待分类的类别总数，yi为第i个类别对应的真实标签，为对应的模型输出值，lg表示以10为底的常用对数；Step5.6、通过输出为故障类型的Softmax层来匹配轴承声发射数据的标签，其算法表述如下：式中，b为输入批量的大小，表示输出的第k个样本，当目标类别是j时，pj＝1，否则为qj，L为输出分类类别，lg表示以10为底的常用对数。Step6、将打好标签的不同损坏程度的训练集和验证集输入到多维深度特征融合卷积神经网络模型，训练集用于训练模型验证集用于调整模型，对模型进行训练后使用测试数据集进行测试，测试集的混淆矩阵如图4所示。上面结合附图对本发明的具体实施方式作了详细说明，但是本发明并不限于上述实施方式，在本领域普通技术人员所具备的知识范围内，还可以在不脱离本发明宗旨的前提下做出各种变化。
