标题title
基于光谱特征参量融合和概率分类的烟叶部位判别方法
摘要abst
本发明公开了一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法及装置。在近红外光谱仪上采集其样品光谱并标记烟叶部位类别；提取所采集的样本数据的光谱特征参量，将所述特征参量与原数据拼接融合；随机选取一定比例的融合数据作为概率分类器的训练数据集，通过验证曲线选择分类器的最佳参数并训练；对任一烟叶样本光谱数据，经特征参量融合后输入已训练好的分类器，输出烟叶样本属于上部烟、中部烟和下部烟的分类概率；根据分类概率得到归化矢量，根据归化矢量的值判别烟叶部位为确定性部位或过渡性部位。本发明利用近红外光谱分析技术，为烟叶部位无损判别提供了一种高效稳定的技术手段。
权利要求书clms
1.基于光谱特征参量融合和概率分类的烟叶部位判别方法；其特征在于，包括如下步骤：样本制作：提供K个烟叶样品，在近红外光谱仪上采集其样品光谱数据Vi，i＝1,2,…,N，并标记样品部位信息，上部记作U，中部记作C，下部记作D；光谱特征参量融合：提取原样本光谱数据的光谱特征参量；将所述光谱特征参量与原始数据拼接融合；概率分类器训练：从光谱特征参量融合后的样本数据中选取一定比例的样本作为训练集；用所述训练集训练概率分类器；所述概率分类器输出每个烟叶样本属于每个部位的概率；烟叶部位判别：对每个样本，基于烟叶样本属于每个部位的概率，采取适合的烟叶部位确定方法，实现烟叶部位判别。2.根据权利要求1所述的基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法，其特征在于步骤所属光谱特征参量包括光谱斜率和坡向、光谱二值编码、一阶微分光谱和二阶微分光谱；所述一阶微分光谱计算公式为所述二阶微分光谱计算公式为其中vij为Vi的第j个元素，为的第j个元素，L为光谱波段数。3.根据权利要求1所述的基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法，其特征在于步骤所述的将所述光谱特征参量与原始数据拼接融合能够选择一种特征参量或多种特征参量，归一化后与原始数据拼接融合。4.根据权利要求1所述的基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法，其特征在于步骤所述的概率分类器包括支持向量机多分类器、朴素贝叶斯分类器和Softmax概率分类器。5.根据权利要求1所述的基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法，其特征在于，步骤中不完全确定法具体包括：计算烟叶部位识别的归化矢量qi，i＝1,2,…,N所述p1i＝ui,p2i＝ci,p3i＝di,qij为归化矢量qi的第j列元素；根据归化矢量的值判断烟叶部位为确定性部位或过渡性部位其中Yi表示第i个样本的部位。6.根据权利要求1所述的一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法的实现装置，其特征在于，包括光谱特征参量融合模块、概率分类模块和烟叶部位判别模块；所述光谱特征参量融合模块，用于提取样本的光谱特征参量，并与原样本拼接融合；所述概率分类模块，用于训练概率分类器，输出烟叶样本属于上部烟、中部烟和下部烟的概率；所述的烟叶部位判别模块，用于根据概率分类器输出结果，判别烟叶样本的部位。7.根据权利要求6所述的一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法的实现装置，其特征在于所述光谱特征参量融合模块的光谱特征参量包括光谱斜率和坡向、光谱二值编码、一阶微分光谱和二阶微分光谱；所述一阶微分光谱计算公式为所述二阶微分光谱计算公式为其中vij为Vi的第j个元素，为的第j个元素，L为光谱波段数。8.根据权利要求6所述的一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法的实现装置，其特征在于所述光谱特征参量融合模块的数据融合能够选一种特征参量或多种特征参量，归一化后与原始数据拼接融合。9.根据权利要求6所述的一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法的实现装置，其特征在于烟叶部位的判别模块具体步骤包括：计算烟叶部位识别的归化矢量qi，i＝1,2,…,N其中p1i＝ui,p2i＝ci,p3i＝di,qij为归化矢量qi的第j列元素；根据归化矢量的值判断烟叶部位为确定性部位或过渡性部位其中Yi表示第i个样本的部位。
说明书desc
技术领域本发明属于近红外无损检测技术领域，具体涉及一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法及装置。背景技术因为不同产地不同部位的烟叶具有不同的烟气特征，在仓库存储时要对烟叶进行产地和部位标注，但在原料收购、烟叶复烤、醇化、投料或运输的过程中，均可能因各种原因导致无法判断烟叶的产地和部位，极大地影响了后续烟叶的加工和制造。传统的烟叶部位产地和识别主要依靠人工的感官评吸方法，即通过烟草行业中的专家利用其视觉、嗅觉、触觉和味觉等进行测定，这种方法会耗费极大的人力、物力和财力，并且具有很强的主观性，分析结果不够客观和精确。近年来，利用图像处理的方法则只是利用了器烟叶的几何和纹理特征，识别率不高。近红外光谱具有丰富的光谱信息，近红外光谱分析技术具有快速、准确和无接触等优点，近年来已经在烟草行业已经得到广泛的研究和应用，但目前主要用于烟叶化学成分分析和产地识别，鲜有利用近红外光谱直接进行烟叶部位判断的公开报道。利用近红外光谱分析技术实现烟叶部位判别的难点主要包括：数据中背景信息的干扰、严重的谱峰重叠、复杂的内部特征信息等。直接对原始光谱数据用传统的分类方法进行烟叶部位识别的识别率很低。支持向量机是传统机器学习的常用模型，在处理复杂高维数据方面有着较好的表现。因此，将近红外光谱和支持向量机结合，进而处理烟叶部位识别的难点。发明内容针对近红外光谱分析技术实现烟叶部位判断的难点问题，本发明的目的是提供一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法，实现对不同产地烟叶部位的智能识别，为烟叶品质判定提供依据，为提高产品质量提供保障。为实现上述目的，本发明提供了如下技术方案：样本制作：提供K个烟叶样品，在近红外光谱仪上采集其样品光谱数据Vi，i＝1,2,…,N，并标记样品部位信息，上部记作U，中部记作C，下部记作D；光谱特征参量融合：提取原样本光谱数据的光谱特征参量；将所述光谱特征参量与原始数据拼接融合。概率分类器训练：从光谱特征参量融合后的样本数据中选取一定比例的样本作为训练集；用所述训练集训练概率分类器；所述概率分类器输出每个烟叶样本属于每个部位的概率。烟叶部位判别：对每个样本，基于烟叶样本属于每个部位的概率，采取适合的烟叶部位确定方法，实现烟叶部位判别。优选的，所述烟叶部位判别方法包括完全确定法和不完全确定法。优选的，步骤所述光谱特征参量包括光谱斜率和坡向、光谱二值编码、一阶微分光谱和二阶微分光谱等。所述一阶微分光谱计算公式为所述二阶微分光谱计算公式为其中vij为Vi的第j个元素，为的第j个元素，L为光谱波段数；优选的，步骤所述的将所述光谱特征参量与原始数据拼接融合可以选一种特征参量或选多种参量，归一化后与原始数据拼接融合。优选的，步骤所述的所述概率分类器是指一大类可以实现概率分类的分类器，包括支持向量机多分类器、朴素贝叶斯分类器和 Softmax概率分类器等。进一步地，步骤所述的烟叶部位判别采用完全确定法，具体判别规则为：其中，ui,ci,di分别表示第i个烟叶样本被识别为上部烟、中部烟、下部烟的概率；Yi表示第i个样本的部位；进一步地，步骤所述的烟叶部位判别采用不完全确定法，具体判别步骤包括：根据分类概率得到归化矢量其中p1i＝ui,p2i＝ci,p3i＝di,qij为归化矢量qi的第j列元素。根据分类概率归化矢量的值判断烟叶部位为确定性部位或过渡性部位。所述的烟叶的确定性部位包括U、C 和D；所述的烟叶的过渡性部位包括UC和 CD。所述的根据分类概率归化矢量的值判断烟叶部位为确定性部位或过渡性部位，具体方法为：其中Yi表示第i个样本的部位。本发明还提供了一种基于近红外光谱特征参量融合和概率分类的烟叶部位判别装置，所述装置包括光谱特征参量融合模块、概率分类模块、和烟叶部位判别模块。所述光谱特征参量融合模块，用于提取样本的光谱特征参量，并与原样本拼接融合；所述概率分类模块，用于训练概率分类器，输出烟叶样本属于上部烟、中部烟和下部烟的概率；所述的烟叶部位判别模块，用于根据概率分类器输出结果，判别烟叶样本的部位。进一步地，所述基于近红外光谱特征参量融合和概率分类的烟叶部位判别装置还包括应用模块，所述应用模块使用烟叶部位判别结果计算成批烟叶的合格率，实现烟叶品质评价。进一步地，所述光谱特征参量融合模块的光谱特征参量包括光谱斜率和坡向、光谱二值编码、一阶微分光谱和二阶微分光谱等。所述一阶微分光谱计算公式为所述二阶微分光谱计算公式为其中vij为Vi的第j个元素，为的第j个元素，L为光谱波段数；进一步地，所述光谱特征参量融合模块的数据融合可以选一种特征参量或多种特征参量，归一化后与原始数据拼接融合。进一步地，烟叶部位的判别模块具体步骤包括：根据分类概率得到归化矢量所述p1i＝ui,p2i＝ci,p3i＝di,qij为归化矢量qi的第j列元素。根据分类概率归化矢量的值判断烟叶部位其中Yi表示第i个样本的部位。本发明的有益效果在于：通过光谱特征参量融合，可以增加不同部位数据的区分度，提高分类精度；提出过渡部位的概念，通过概率分类，便于实现烟叶部位的不完全确定，充分考虑人工标签的主观性，可以减少人工标签的主观性对分类结果的影响；相比人工识别、测量等方法，利用近红外光谱可以更快速的对大批次样本进行部位分析，从而能满足实际生产中对识别效率的要求。附图说明图1是本发明基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法实施例的基本步骤流程图图2为本发明基于近红外光谱特征参量融合和概率分类的烟叶部位判别转置的结构示意图。图3是部分原始样本光谱曲线图4是光谱特征参量融合后的部分样本光谱曲线图5原始数据和光谱特征参量融合后的数据基于SVM概率分类的烟叶部位识别率比较具体实施方式为了使本发明的目的、技术方案和优点更加清楚，下面结合具体的实施例详细说明本发明。下面描述了具体实施例以简化本发明。但是需要认识到，本发明不局限于所说明的实施例，并且在不脱离基本原理的前提下，本发明的各种修改是可能的，这些等价形式同样落于本申请所附权利要求书所限定的范围。下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。如图1所示，为所发明的基于近红外光谱特征参量融合和概率分类的烟叶部位判别方法实施例的基本步骤流程图。如图2所示，为所发明的基于近红外光谱特征参量融合和概率分类的烟叶部位判别转置的结构示意图。实施例一步骤1、样本制作采集云南、湖南、贵州三地2018-2020年的各等级原烟样本光谱数据共8511条，N＝8511。选取波段在892-1699nm的光谱数据，通过插值得到波段数L＝257。标记样品部位信息，上部记作U，中部记作C，下部记作D。图3给出了部分样本的光谱曲线。步骤2、光谱特征参量融合光谱特征参量取一阶微分光谱。对每个样本Vi，计算其一阶微分光谱其中vij为Vi的第j个元素，L为光谱波段数；经归一化得到再通过拼接得到1×512的样本矢量图4给出了光谱特征参量融合后的部分样本数据光谱曲线。步骤3、概率分类概率分类器选用一对多的支持向量机多分类器。SVM模型有三个关键参数：C核函数、kernal核函数、gamma 核函数参数。根据经验设定合适参数预选项，通过验证曲线找到SVM的最佳参数：C＝1，kernal＝‘rbf’,gamma＝10。从光谱特征参量融合后的样本数据中随机选取一定比例的样本作为训练集，对SVM模型进行训练，使用3折交叉验证验证模型的稳定性。每一个样本经光谱特征参量融合后的数据输入训练好的SVM概率分类器，输出样本属于上部烟的概率ui，属于中部烟的概率ci和下部烟的概率di，。步骤4、烟叶部位判别：烟叶部位判别采用完全确定法，具体判别规则为：其中，ui,ci,di分别表示第i个烟叶样本被识别为上部烟、中部烟、下部烟的概率；Yi表示第i个样本的部位；实施例二实施例二的步骤1至3与实施例一完全相同。步骤4、烟叶部位判别：烟叶部位判别采用不完全确定法，具体过程为：根据分类概率得到归化矢量所述p1i＝ui,p2i＝ci,p3i＝di,qij为归化矢量qi的第j列元素。根据分类概率归化矢量的值判断烟叶部位其中Yi表示第i个样本的部位。图5给出了原始数据和光谱特征参量融合后的数据基于SVM概率分类的烟叶部位识别率比较，其中图5烟叶部位判别采用不完全确定法，5烟叶部位判别采用完全确定法，实线表示用光谱特征参量融合，虚线表示用原始数据。从图5可以看出，同样的训练比例下，用不完全确定法，识别率略高于完全确定法，说明用概率分类器输出的结果实现不完全确定方法更优。相比用原始数据，用光谱特征参量融合，烟叶部位识别率可以提高约15-20％。
