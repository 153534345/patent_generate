标题title
一种具有故障自检功能的数显子钟
摘要abst
本发明公开了一种具有故障自检功能的数显子钟，包括电源处理电路、信号处理控制电路、RTC电路、电流检测电路、LED数码管驱动电路、LED数码管显示电路。电源处理电路进行AC‑DC、DC‑DC降压转换，为其他电路供电；电流检测电路负责检测LED数码管工作总电流；信号处理控制电路对LED数码管显示时间、故障判断、故障上报等功能进行控制；RTC电路为数显子钟提供实时时间；LED数码管驱动电路为LED数码管显示电路提供驱动；LED数码管显示电路负责最终的时间显示。本发明用于显示实时时间，同时可实时自检运行状态，当发现故障时，立即关闭时间显示并上报管理终端，提升其维护效率，防止显示的错误时间误导用户而造成损失。
权利要求书clms
1.一种具有故障自检功能的数显子钟，其特征在于，包括电源处理电路、电流检测电路、RTC电路、信号处理控制电路、LED数码管驱动电路、LED数码管显示电路；电源处理电路对220V市电进行处理，为电流检测电路、RTC电路、信号处理控制电路、LED数码管显示电路、LED数码管驱动电路供电；电流检测电路负责检测LED数码管显示电路中LED数码管工作总电流；信号处理控制电路根据RTC电路提供的实时时间，通过LED数码管驱动电路驱动LED数码管显示电路显示时间；根据电流检测电路的输出进行故障检测，并进行故障上报。2.根据权利要求1所述的一种具有故障自检功能的数显子钟，其特征在于，电源处理电路包括AC-DC降压模块、第一DC-DC开关稳压电路、第二DC-DC开关稳压电路、LDO线性稳压电路以及第一至第四滤波电路，220V市电依次经AC-DC降压模块、第一滤波电路转换为24V直流电；24V直流电依次经第一DC-DC开关稳压电路、第二滤波电路转换为12V，通过电流检测电路为LED数码管显示电路供电；24V直流电依次经第二DC-DC开关稳压电路、第三滤波电路转换为5V直流电，为LED数码管驱动电路供电；5V直流电依次经LDO线性稳压电路、第四滤波电路转换为3.3V直流电，为信号处理控制电路、RTC电路供电。3.根据权利要求1所述的一种具有故障自检功能的数显子钟，其特征在于，电流检测电路包括检流放大器和合金电阻，合金电阻跨接在检流放大器的RS+和RS-端口，合金电阻与RS-端口的公共端连接ED数码管显示电路；检流放大器将合金电阻两端的电压差放大后输出至信号处理控制电路。4.根据权利要求1所述的一种具有故障自检功能的数显子钟，其特征在于，信号处理控制电路通过SPI串行数据接口向LED数码管驱动电路发送包含时间信息和验证信息的串行数据。5.根据权利要求1所述的一种具有故障自检功能的数显子钟，其特征在于，RTC电路包括实时时钟RTC芯片和二次电池，实时时钟RTC芯片内部的充电电路对二次电池充电并对二次电池的电量进行检测。6.根据权利要求4所述的一种具有故障自检功能的数显子钟，其特征在于，LED数码管驱动电路包括驱动电路和串并转换电路，驱动电路为若干晶体管阵列，串并转换电路为级联的若干移位寄存器，晶体管阵列与移位寄存器一一对应连接，串并转换电路将信号处理控制电路发送的串行数据转换为并行数据，晶体管阵列将并行数据的电信号放大以驱动LED数码管显示电路中LED数码管。7.根据权利要求6所述的一种具有故障自检功能的数显子钟，其特征在于，LED数码管显示电路包括若干LED数码管和限流电阻组成，LED数码管选用共阳极八段数码管，控制每段数码管点亮状态的8个引脚通过限流电阻分别连接至驱动电路中晶体管阵列对应的引脚。8.根据权利要求7所述的一种具有故障自检功能的数显子钟，其特征在于，信号处理控制电路中故障检测的流程具体为：每次数显子钟接通电源后，持续点亮LED数码管显示电路中的所有LED数码管，待数显子钟稳定后，信号处理控制电路采集到电流检测电路输出的电压为VOUT_0，根据LED数码管总段数N，计算每段数码管点亮或熄灭变化在电流检测电路输出电压反映的变化为增加或降低V0，V0＝VOUT_0÷数码管点亮总段数N；数显子钟正常显示时间时，每次数码管显示电路“秒”时间变化后，待电路稳定0.3秒，立即采集电流检测电路输出的电压VOUT；当满足·V0＜VOUT＜·V0时，则无故障，n为数码管当前点亮总段数；当不满足·V0＜VOUT＜·V0时，则有故障，关闭LED数码管显示电路中的所有LED数码管，向母钟上报故障信息。9.根据权利要求4所述的一种具有故障自检功能的数显子钟，其特征在于，信号处理控制电路向LED数码管驱动电路发送包含检验数据和时间数据的串行数据，检验数据在时间数据之前，当串行数据全部发送后，信号处理控制电路接收到驱动电路输出的检验数据，将接收的检验数据与发送的检验数据进行对比，当两组数据一致时，进行下一个循环；当两组数据不一致时，则判断设备故障，关闭所有数码管显示，防止错误时间误导用户，工作状态指示灯变为红色，指示当前设备故障，最后向母钟上报故障信息，结束。10.一种子母钟系统，其特征在于，包括如权利要求1至9中任一所述的子钟。
说明书desc
技术领域本发明涉及一种具有故障自检功能的数显子钟，属于子母钟系统领域。背景技术随着基础建设迅速发展和生活节奏加快，各行业对子母钟系统的需求日益增加，目前已经广泛应用于车站、机场、医院、学校、政府办公大楼、国家电网等需要大范围、高精度显示统一时间的区域。子母钟系统中，子钟作为时间显示的终端，其准确性、可靠性至关重要，错误的时间可能为用时人、社会带来无法预计的经济损失，甚至间接地威胁到人们的生命安全，因此需要管理员定期对子钟的工作状态进行检查、维护。但是，由于子钟布局广、数量多，因此带来维护成本高、故障发现不及时的问题。发明内容针对上述问题，本发明提供一种具有故障自检功能的数显子钟。在显示实时时间的同时，可实时自检运行状态，当发现故障时，立即关闭时间显示并上报管理终端，提升其维护效率，防止显示的错误时间误导用户而造成损失。本发明为解决上述技术问题采用以下技术方案：一种具有故障自检功能的数显子钟，包括电源处理电路、电流检测电路、RTC电路、信号处理控制电路、LED数码管驱动电路、LED数码管显示电路；电源处理电路对220V市电进行处理，为电流检测电路、RTC电路、信号处理控制电路、LED数码管显示电路、LED数码管驱动电路供电；电流检测电路负责检测LED数码管显示电路中LED数码管工作总电流；信号处理控制电路根据RTC电路提供的实时时间，通过LED数码管驱动电路驱动LED数码管显示电路显示时间；根据电流检测电路的输出进行故障检测，并进行故障上报。进一步，电源处理电路包括AC-DC降压模块、第一DC-DC开关稳压电路、第二DC-DC开关稳压电路、LDO线性稳压电路以及第一至第四滤波电路，220V市电依次经AC-DC降压模块、第一滤波电路转换为24V直流电；24V直流电依次经第一DC-DC开关稳压电路、第二滤波电路转换为12V，通过电流检测电路为LED数码管显示电路供电；24V直流电依次经第二DC-DC开关稳压电路、第三滤波电路转换为5V直流电，为LED数码管驱动电路供电；5V直流电依次经LDO线性稳压电路、第四滤波电路转换为3.3V直流电，为信号处理控制电路、RTC电路供电。进一步，电流检测电路包括检流放大器和合金电阻，合金电阻跨接在检流放大器的RS+和RS-端口，合金电阻与RS-端口的公共端连接ED数码管显示电路；检流放大器将合金电阻两端的电压差放大后输出至信号处理控制电路。进一步，信号处理控制电路通过SPI串行数据接口向LED数码管驱动电路发送包含时间信息和验证信息的串行数据。进一步，RTC电路包括实时时钟RTC芯片和二次电池，实时时钟RTC芯片内部的充电电路对二次电池充电并对二次电池的电量进行检测。进一步，LED数码管驱动电路包括驱动电路和串并转换电路，驱动电路为若干晶体管阵列，串并转换电路为级联的若干移位寄存器，晶体管阵列与移位寄存器一一对应连接，串并转换电路将信号处理控制电路发送的串行数据转换为并行数据，晶体管阵列将并行数据的电信号放大以驱动LED数码管显示电路中LED数码管。进一步，LED数码管显示电路包括若干LED数码管和限流电阻组成，LED数码管选用共阳极八段数码管，控制每段数码管点亮状态的8个引脚通过限流电阻分别连接至驱动电路中晶体管阵列对应的引脚。进一步，信号处理控制电路中故障检测的流程具体为：每次数显子钟接通电源后，持续点亮LED数码管显示电路中的所有LED数码管，待数显子钟稳定1秒后，信号处理控制电路采集到电流检测电路输出的电压为VOUT_0，根据LED数码管总段数N，计算每段数码管点亮或熄灭变化在电流检测电路输出电压反映的变化为增加或降低V0，V0＝VOUT_0÷数码管点亮总段数N；数显子钟正常显示时间时，每次数码管显示电路“秒”时间变化后，待电路稳定0.3秒，立即采集电流检测电路输出的电压VOUT；当满足·V0＜VOUT＜·V0时，则无故障，n为数码管当前点亮总段数；当不满足·V0＜VOUT＜·V0时，则有故障，关闭LED数码管显示电路中的所有LED数码管，向母钟上报故障信息。进一步，信号处理控制电路向LED数码管驱动电路发送包含检验数据和时间数据的串行数据，检验数据在时间数据之前，当串行数据全部发送后，信号处理控制电路接收到驱动电路输出的检验数据，将接收的检验数据与发送的检验数据进行对比，当两组数据一致时，进行下一个循环；当两组数据不一致时，则判断设备故障，关闭所有数码管显示，防止错误时间误导用户，工作状态指示灯变为红色，指示当前设备故障，最后向母钟上报故障信息，结束。一种子母钟系统，包括如上所述的子钟。本发明采用以上技术方案与现有技术相比，具有以下技术效果：本发明的技术方案使数显子钟在不影响时间显示的情况下，实时检测设备工作状态。当数显子钟检测到设备故障时，无需维护人员在场，即可自动关闭时间显示功能，防止错误时间误导用户，同时，向母钟、管理中心上报故障，通知维护人员及时检修。本发明可有效降低子母钟系统的维护成本、提高子钟时间显示的可靠性。附图说明图1为数显子钟的硬件电路总体架构；图2为电源处理电路框图；图3为电流检测电路框图；图4为信号处理控制电路框图；图5为RTC电路框图；图6为LED数码管驱动电路框图；图7为LED数码管显示电路框图；图8为通过检测数码管电流自检故障的软件流程实施图；图9为通过对比发送、接收的串行数据自检故障的软件流程实施图。具体实施方式下面结合附图对本发明的技术方案做进一步的详细说明：本发明提供一种具有故障自检功能的数显子钟，由硬件电路架构和软件实施流程两部分组成。图1示出了本发明的硬件电路总体架构。该数显子钟包括电源处理电路、信号处理控制电路、RTC电路、电流检测电路、LED数码管驱动电路、LED数码管显示电路。电源处理电路进行AC-DC、DC-DC降压转换，为信号处理控制电路、RTC电路、LED数码管显示电路、LED数码管驱动电路、电流检测电路供电；电流检测电路负责检测LED数码管工作总电流；信号处理控制电路对LED数码管显示时间、故障判断、故障上报等功能进行控制；RTC电路为数显子钟提供实时时间；LED数码管驱动电路为LED数码管显示电路提供驱动；LED数码管显示电路负责最终的时间显示。图2示出了电源处理电路的简化实施方式。电源处理电路负责为数显子钟的所有用电模块、芯片提供高质量供电电源，将220V市电通过AC-DC降压模块转换为24V直流电；24V直流电经两路DC-DC开关稳压电路分别降压至VCC_LED、5V；5V直流电经LDO线性稳压电路降压至3.3V。VCC_LED专为LED数码管显示电路供电，电压可根据用户对数显子钟亮度、尺寸的需求进行调整，同时有利于提高LED数码管电流检测的可靠性；5V电源负责为LED数码管驱动电路供电；经LDO线性稳压输出的高质量3.3V电源负责为信号处理控制电路、RTC电路供电，以提高数显子钟运行的稳定性。图3示出了电流检测电路具体实施方式。电流检测电路采用高端电流检测方式，主要器件为检流放大器和合金电阻。检流放大器可将RSENSE两端的电压差放大60倍并输出至微控制器进行AD转换。图4示出了信号处理控制电路具体实施方式。信号处理控制电路主要由微控制器及外围电路构成。微控制器通过外接高精度电压基准参考，内置高精度AD转换器可对电流检测电路输出电压进行检测；采用8位拨码开关最多可对256台数显子钟进行地址分配，便于子母钟系统管理；具备对外显示的工作状态指示灯，当设备正常工作时为绿色，当设备故障时为红色；通过RS422或RS485通信接口实时获取统一的标准时间并向母钟上报工作状态；通过SPI串行数据接口向LED数码管驱动电路发送包含时间信息和验证信息的串行数据。图5示出了RTC电路具体实施方式，主要由实时时钟芯片和二次纽扣电池组成。实时时钟内部的充电电路可对外接二次电池充电并对电池电量进行检测。采用二次电池作后备电源可保证设备断电时，RTC时间在一定时间内不丢失。图6示出了LED数码管驱动电路的具体实施方式，主要由驱动电路和串并转换电路组成。驱动电路选用达林顿晶体管阵列；串并转换电路选用高速移位寄存器，采用级联的方式将多位数串行数据转换为并行数据输出，并通达林顿晶体管阵列将并行数据的电信号放大来驱动LED数码管。图7示出了LED数码管显示电路的简化实施方法，主要由LED数码管和限流电阻组成。数码管选用共阳极八段数码管，控制各段点亮状态的8个引脚通过限流电阻分别连接至驱动电路中晶体管阵列对应的引脚；限流电阻选用功率较大、精度高的贴片电阻。图8示出了通过检测数码管电流自检故障的软件流程实施图，主要对LED数码管的工作状态进行检测。开机时点亮所有LED数码管，待电路稳定1秒后，采集电流检测电路输出的电压VOUT_0，计算每段数码管状态变化在电流检测电路输出电压反映的变化为V0＝VOUT_0÷数码管点亮总段数N，在下次开机前记忆V0。之后，数显子钟正常显示时间，每次走秒后，间隔一定时间，待电路稳定后采集电流检测电路输出的电压VOUT。当满足·V0＜VOUT＜·V0时，则判断设备正常，结束。当不满足·V0＜VOUT＜·V0时，则判断设备故障，关闭所有数码管显示，防止错误时间误导用户，工作状态指示灯变为红色，指示当前设备故障，最后向母钟上报故障信息，结束。进一步，判断区间·V0＜VOUT＜·V0的范围可根据实际电路情况和电流检测精度适当增加或缩减。图9示出了通过对比发送、接收的串行数据自检故障的软件流程实施图，主要对LED数码管驱动电路的工作状态进行检测。微控制器向LED数码管驱动电路发送一段包含检验数据和时间数据的串行数据，检验数据在时间数据之前，当串行数据全部发送后，微控制器会接收到驱动电路输出的检验数据，将接收的检验数据与发送的检验数据进行对比。当两组数据一致时，进行下一个循环；当两组数据不一致时，则判断设备故障，关闭所有数码管显示，防止错误时间误导用户，工作状态指示灯变为红色，指示当前设备故障，最后向母钟上报故障信息，结束。以上所述，仅为本发明中的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉该技术的人在本发明所揭露的技术范围内，可理解想到的变换或替换，都应涵盖在本发明的包含范围之内，因此，本发明的保护范围应该以权利要求书的保护范围为准。
