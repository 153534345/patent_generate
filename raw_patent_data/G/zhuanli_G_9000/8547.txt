标题title
一种汽车后视镜影像重建方法及后视镜
摘要abst
本发明提供了一种汽车后视镜影像重建方法及后视镜，包括：通过获取汽车后方影像，得到初始后视镜影像场景动画；获取后视镜场景坐标，并将所述场景读入帧缓存并创建后视镜纹理；将所述后视镜纹理映射到后视镜模型上；获取摄像机的位置和参数，并确定真实车辆后视镜的显示状态；调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致，本发明提供了一直汽车后视镜影像重建方法，通过调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致，能够实现平面镜影像和凸透镜影像的转换。
权利要求书clms
1.一种汽车后视镜影像重建方法，其特征在于，包括：通过获取汽车后方影像，得到初始后视镜影像场景动画；获取后视镜场景坐标，将所述场景动画读入帧缓存，并创建后视镜纹理；将所述后视镜纹理映射到后视镜模型上；获取摄像机的位置和参数，并确定真实车辆后视镜的显示状态；其中，所述显示状态包括近景显示状态和远景显示状态；调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致。2.根据权利要求1所述的汽车后视镜影像重建方法，其特征在于，所述创建后视镜纹理，其包括：获取初始后视镜影像场景动画；对所述后视镜影像场景动画进行像素点分隔；计算获得后视镜纹理内存。3.根据权利要求1或2所述的汽车后视镜影像重建方法，其特征在于，将所述后视镜纹理映射到后视镜模型上，其包括：建立三维坐标模型；并确定后视镜模型的尺寸；根据所述后视镜模型的尺寸和车型，获取后视镜的虚拟场景坐标值和后视镜在虚拟场景中的旋转值；获取摄像机在虚拟场景中的坐标值和所述摄像机在虚拟场景中的旋转值；计算得到摄像机的视场角，进而得到后视镜模型。4.根据权利要求3所述的汽车后视镜影像重建方法，其特征在于，所述汽车后方影像包括摄像机的上下调整和左右旋转影像。5.根据权利要求4所述的汽车后视镜影像重建方法，其特征在于，所述摄像机的上下调整和左右旋转影像的视觉夹角均为17°。6.根据权利要求5所述的汽车后视镜影像重建方法，其特征在于，所述汽车后方影像的像分辨率为120～160m。7.根据权利要求6所述的汽车后视镜影像重建方法，其特征在于，所述摄像机的视场角计算公式为：其中L为摄像机与后视镜A点的距离，L为摄像机与后视镜B点的距离,|P′A|为摄像机相对于真实车辆后视镜A点所在地面坐标系的转置距离，|P′B|为摄像机相对于真实车辆后视镜B点所在地面坐标系的转置距离。8.根据权利要求7所述的汽车后视镜影像重建方法，其特征在于，调整所述摄像机的位置、参数和所述后视镜模型，其包括：调整所述后视镜A点的坐标值、后视镜B点的坐标值和摄像机的旋转值。9.根据权利要求8所述的汽车后视镜影像重建方法，其特征在于，还包括调整后视镜的上下左右旋转极值。10.一种后视镜装置，其特征在于，包括：存储器，用于存储计算机程序；处理器，用于执行所述计算机程序时实现如权利要求1至9任一项所述的汽车后视镜影像重建方法的步骤。
说明书desc
技术领域本发明涉及汽车零部件技术领域，尤其涉及一种汽车用汽车后视镜影像重建方法及后视镜。背景技术虚拟现实技术的发展使得计算机仿真在汽车模拟驾驶仪上成为可能。汽车模拟驾驶仪是一种能实时模拟驾驶行为，并在驾驶环境和驾驶感觉上跟真车相似的仿真设备。实际驾驶时，驾驶员通过车外后视镜观测车辆后方的驾驶环境以保证行车安全。模拟驾驶时，后视镜也必须提供这种能力并将变化后的视景连续地渲染到屏幕上。为了获得更好的视觉效果，增强驾驶仿真的沉浸感与真实感，实现车外后视镜仿真尤为必要。对于后视镜的虚拟仿真，传统的方法是通过多视口显示，这种方法的后视镜视野狭窄，清晰度差，不能观察车辆侧方和下方的情况。因此，亟需一种汽车后视镜影像重建方法,使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致，并实现远景和近景的切换。发明内容本发明提供了一直汽车后视镜影像重建方法，通过调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致，能够实现平面镜影像和凸透镜影像的转换，以实现近景远景的切换。本发明提供的技术方案为：一种汽车后视镜影像重建方法，包括：通过获取汽车后方影像，得到初始后视镜影像场景动画；获取后视镜场景坐标，将所述场景动画读入帧缓存，并创建后视镜纹理；将所述后视镜纹理映射到后视镜模型上；获取摄像机的位置和参数，并确定真实车辆后视镜的显示状态；其中，所述显示状态包括近景显示状态和远景显示状态；调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致。优选的是，所述创建后视镜纹理，其包括：获取初始后视镜影像场景动画；对所述后视镜影像场景动画进行像素点分隔；计算获得后视镜纹理内存。优选的是，将所述后视镜纹理映射到后视镜模型上，其包括：建立三维坐标模型；并确定后视镜模型的尺寸；根据所述后视镜模型的尺寸和车型，获取后视镜的虚拟场景坐标值和后视镜在虚拟场景中的旋转值；获取摄像机在虚拟场景中的坐标值和所述摄像机在虚拟场景中的旋转值；计算得到摄像机的视场角，进而得到后视镜模型。优选的是，所述汽车后方影像包括摄像机的上下调整和左右旋转影像。优选的是，所述摄像机的上下调整和左右旋转影像的视觉夹角均为17°。优选的是，所述汽车后方影像的像分辨率为120～160m。优选的是，所述摄像机的视场角计算公式为：其中L为摄像机与后视镜A点的距离，L为摄像机与后视镜B点的距离,|P′A|为摄像机相对于真实车辆后视镜A点所在地面坐标系的转置距离，|P′B|为摄像机相对于真实车辆后视镜B点所在地面坐标系的转置距离。优选的是，调整所述摄像机的位置、参数和所述后视镜模型，其包括：调整所述后视镜A点的坐标值、后视镜B点的坐标值和摄像机的旋转值。优选的是，还包括调整后视镜的上下左右旋转极值。本发明还提供了一种后视镜装置，包括：存储器，用于存储计算机程序；处理器，用于执行所述计算机程序时实现前述的汽车后视镜影像重建方法的步骤。有益效果本发明提供了一直汽车后视镜影像重建方法，通过调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致，能够实现平面镜影像和凸透镜影像的转换，即实现近景远景的切换。附图说明图1为本发明所述的汽车后视镜影像重建方法流程图。图2为本发明所述的摄像机的视场角的计算原理图。具体实施方式以下由特定的具体实施例说明本发明的实施方式，熟悉此技术的人士可由本说明书所揭露的内容轻易地了解本发明的其他优点及功效，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明的是，在本发明的描述中，术语“中”、“上”、“下”、“横”、“内”等指示的方向或位置关系的术语是基于附图所示的方向或位置关系，这仅仅是为了便于描述，而不是指示或暗示所述装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性。此外，还需要说明的是，在本发明的描述中，除非另有明确的规定和限定，术语“设置”、“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域技术人员而言，可根据具体情况理解上述术语在本发明中的具体含义。如图1所示，本发明提供了一种汽车后视镜影像重建方法，包括：步骤S110、通过获取汽车后方影像，得到初始后视镜影像场景动画；步骤S120、获取后视镜场景坐标，并将所述场景读入帧缓存并创建后视镜纹理；步骤S130、将所述后视镜纹理映射到后视镜模型上；步骤S140、获取摄像机的位置和参数，并确定真实车辆后视镜的显示状态，其中，所述显示状态包括近景显示状态和远景显示状态；步骤S150、调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致。需要特别说明的是，在一个优选实施例中，真实车辆后视镜包括凸透镜影像和平面镜影像，形成远景和近景两种显示状态，在通过调整摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致，相乘近景后视镜模型和远景后视镜模型量子模型，在使用时通过切换模型状态实现近景和远景两种场景的切换。在一个优选实施例中，创建后视镜纹理，其包括：获取初始后视镜影像场景动画；对所述后视镜影像场景动画进行像素点分隔，作为一种优选像素点分隔的大小为2的整数倍，以提高利用效率；计算获得后视镜纹理内存。K＝Xi×Yi×η；其中，K为纹理内存大小，Xi为横向像素点个数，Yi为纵向像素点个数，η为各像素分量。优选的是，将所述后视镜纹理映射到后视镜模型上，其包括：建立三维坐标模型；并确定后视镜模型的尺寸，作为一种优选，后视镜模型尺寸不大于后视镜纹理内存大小，通常后视镜模型尺寸为：D：|||根据所述后视镜模型的尺寸和车型，获取后视镜的虚拟场景坐标值和后视镜在虚拟场景中的旋转值；获取摄像机在虚拟场景中的坐标值和所述摄像机在虚拟场景中的旋转值；具体的实现过程为，在每一个驾驶步长内，计算当前后视镜的顶点数组所在坐标，并同步更新在后视镜相机的位置，连接各个顶点绘制后视镜场景，以完成后视镜影像的实时模拟；其中，后视镜的顶点数组所在坐标为后视镜真实应用场景时的显示顶点坐标，通过标记获得，通常在将后视镜真实应用场景分隔后相当于形成多个方形显示单元，为了标记准确，可以标记所有顶点坐标，考虑运算效率选择忽略中间的拼接点。然后，计算得到摄像机的视场角，进而得到后视镜模型。作为一种优选，所述汽车后方影像包括摄像机的上下调整和左右旋转影像。在一个优选实施例中，所述摄像机的上下调整和左右旋转影像的视觉夹角均为17°。优选的是，所述汽车后方影像的像分辨率为120～160m。优选的是，所述摄像机的视场角计算公式为：其中L为摄像机与后视镜A点的距离，L为摄像机与后视镜B点的距离,|P′A|为摄像机相对于真实车辆后视镜A点所在地面坐标系的转置距离，|P′B|为摄像机相对于真实车辆后视镜B点所在地面坐标系的转置距离。优选的是，调整所述摄像机的位置、参数和所述后视镜模型，其包括：调整所述后视镜A点的坐标值、后视镜B点的坐标值和摄像机的旋转值。如图2所示，具体的说，后视镜场景形成视觉模型后，需要进行二位变换，设置观察视点，根据人后视镜A点的坐标值、后视镜B点的坐标值和摄像机的旋转值，进行调整，使使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致。具体的说，在模型和参数调整过程中为单向调整，以调整摄像头位置为例做进一步说明：在绘制虚拟场景时，将摄像机作为观察这位置，作为坐标原点，建立三维坐标系，将车身方向作为x轴，水平垂直于车身方向为y轴，垂直于地面方向为z轴，摄像机坐标系中的任一点坐标和地面坐标系下的转换方式可以通过矩阵方程进行转换。首先，选取任一近景界面，标定其与摄像机之间的距离，获得其与视场角交点的坐标值，即A点、B点、C点和D点的坐标值，四点连线构成的平面即为影像显示区域，获取初始后视镜影像场景动画；对后视镜影像场景动画进行像素点分隔，选取并设置像素点的顶点作为观察视点，并计算坐标值。对车辆后视镜影像进行像素点分隔，作为一种优选，车辆后视镜的像素点个数与近景界面相同；分别对每个像素点进行二值化处理，并求解特征值；其中，特征值有灰度值进行插值计算或根据经验公式推导获得比对真实车辆影像与近景界面对应像素点的特征值，若二者特征值差值小于阈值，将当前的任一近景界面作为后视镜的近景界面输出，若大于或等于阈值，重新选择另一近景界面，直至二者特征值差值小于阈值。远景界面的选择与上述方法类似。具体的本领域技术人员可以根据不同的场景需求进行参数调整例如通过改变调整后视镜的上下左右旋转极值等方法，进行调整。本发明还提供了一种后视镜装置，包括：存储器，用于存储计算机程序；处理器，用于执行所述计算机程序时实现前述的汽车后视镜影像重建方法的步骤，通过调用存储器存储的操作指令，处理器，还用于执行种汽车后视镜影像重建方法的任一步骤，包括：通过获取汽车后方影像，得到初始后视镜影像场景动画；获取后视镜场景坐标，并将所述场景读入帧缓存并创建后视镜纹理；将所述后视镜纹理映射到后视镜模型上；获取摄像机的位置和参数，并确定真实车辆后视镜的显示状态，其中，所述显示状态包括近景显示状态和远景显示状态；调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致。本发明提供了一直汽车后视镜影像重建方法，通过调整所述摄像机的位置和所述后视镜模型，使最终显示的后视镜影像场景动画与真实车辆后视镜的显示状态一致，能够实现平面镜影像和凸透镜影像的转换。至此，已经结合附图所示的优选实施方式描述了本发明的技术方案，但是，本领域技术人员容易理解的是，本发明的保护范围显然不局限于这些具体实施方式。在不偏离本发明的原理的前提下，本领域技术人员可以对相关技术特征做出等同的更改或替换，这些更改或替换之后的技术方案都将落入本发明的保护范围之内。
