标题title
基于国密算法的车联网通信安全认证方法、系统及设备
摘要abst
本发明属于车联网安全技术领域，公开了一种基于国密算法的车联网通信安全认证方法、系统及设备。本发明的方法包括，车载终端构造身份认证请求消息发送至路侧设施；车载终端接收身份认证应答消息并验证签名；若验证成功，车载终端计算会话密钥及其哈希值并构造确认消息发送至路侧设施；用于路侧设施计算会话密钥及其哈希值进行对比验证；若哈希值相等，则安全认证成功并生成会话密钥，若不相等，则安全认证失败。本发明结合SM2数字签名算法、SM2公钥加密算法和SM3杂凑算法，确保该方法可应用于车载终端与路侧设施的通信过程中，能够以较低的总计算资源和较低的通信带宽抵御多种攻击。
权利要求书clms
1.一种基于国密算法的车联网通信车载终端安全认证方法，其特征在于，所述方法包括：车载终端构造身份认证请求消息发送至路侧设施；车载终端接收路侧设施所构造的身份认证应答消息，并验证签名；若验证失败，车载终端连接路侧设施的请求中断；若验证成功，则车载终端计算会话密钥及其哈希值并构造确认消息发送至路侧设施；所述身份认证应答消息由路侧设施根据接收的所述身份认证请求消息并验证签名成功后所构造；所述确认消息用于路侧设施计算会话密钥及其哈希值进行对比验证；若路侧设施计算的会话密钥的哈希值与车载终端计算的会话密钥的哈希值相等，则车载终端与路侧设施间安全认证成功并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败；所述车载终端构造身份认证请求消息的方法包括：车载终端生成临时序列号和随机数，利用SM2公钥加密算法使用路侧设施的公钥对随机数进行加密得，利用SM2数字签名算法使用车载终端的私钥对随机数的哈希值进行签名得，将临时序列号、身份标识符、加密随机数、签名哈希值组合所述身份认证请求消息；所述身份认证请求消息按照下式计算：其中，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法；所述车载终端接收路侧设施所构造的身份认证应答消息并验证签名的方法包括：车载终端接收路侧设施的身份认证应答消息，获取路侧设施的身份标识符，利用SM2公钥加密算法使用车载终端的私钥对加密随机数解密得随机数，利用SM2数字签名算法使用路侧设施的公钥验证签名哈希值。2.根据权利要求1所述的基于国密算法的车联网通信车载终端安全认证方法，其特征在于，所述车载终端计算会话密钥及其哈希值并构造确认消息的方法包括：车载终端计算会话密钥为随机数与随机数的异或值，并计算会话密钥的哈希值，将序列号、身份标识符、会话密钥哈希值组合确认消息；所述会话密钥、确认消息按照下式计算：其中，表示异或运算，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法。3.根据权利要求1所述的基于国密算法的车联网通信车载终端安全认证方法，其特征在于，在所述车载终端构造身份认证请求消息发送至路侧设施之前还包括：车载终端向CA发送证书请求文件，接收CA对车载终端的证书请求文件进行签发生成的数字证书，所述数字证书包括车载终端的公钥、路侧设施的公钥；所述CA对车载终端签发的数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值。4.一种基于国密算法的车联网车载终端，其特征在于，所述车载终端包括随机数生成模块、证书签发模块、身份认证消息构造模块、认证模块；实现根据权利要求1-3任一所述的基于国密算法的车联网通信车载终端安全认证方法，其中，所述随机数生成模块，通过所述车载终端中预置的安全芯片内随机数生成器生成私钥，并存储在安全芯片的存储单元中不能导出；所述证书签发模块，用于车载终端向CA发送证书请求文件，接收CA对车载终端的证书请求文件进行签发生成的数字证书；所述身份认证消息构造模块，用于构造身份认证请求并发送至路侧设施；所述认证模块，用于在接收到路侧设施的身份认证应答消息后，使用路侧设施数字证书的公钥验证签名，同时计算会话密钥及其哈希值。5.一种基于国密算法的车联网通信路侧设施安全认证方法，其特征在于，所述方法包括：路侧设施接收车载终端构造的身份认证请求消息并验证签名；若验证失败，车载终端连接路侧设施的请求中断；若验证成功，则路侧设施构造身份认证应答消息发送至车载终端；路侧设施接收车载终端构造的确认消息并计算会话密钥及其哈希值，与车载终端计算的会话密钥及其哈希值进行对比验证；若路侧设施计算的会话密钥的哈希值与车载终端计算的会话密钥的哈希值相等，则车载终端与路侧设施间安全认证成功并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败；所述确认消息由车载终端接收所述身份认证应答消息并验证签名验证成功，计算会话密钥及其哈希值后构造，并发送至路侧设施；所述路侧设施接收车载终端构造的身份认证请求消息并验证签名的方法包括：路侧设施接收车载终端的身份认证请求消息，获取车载终端的身份标识符，利用SM2公钥加密算法使用路侧设施的私钥对加密随机数解密得随机数，利用SM2数字签名算法使用车载终端的公钥验证签名哈希值；所述路侧设施构造身份认证应答消息的方法包括：路侧设施生成随机数，利用SM2公钥加密算法使用车载终端的公钥对随机数进行加密得，利用SM2数字签名算法使用路侧设施的私钥对随机数的哈希值进行签名得，将序列号、身份标识符、加密随机数、签名哈希值组合成所述身份认证应答消息；所述身份认证应答消息按照下式计算：其中，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法。6.根据权利要求5所述的基于国密算法的车联网通信路侧设施安全认证方法，其特征在于，所述路侧设施接收所述确认消息并计算会话密钥及其哈希值进行对比验证的方法包括：路侧设施接收所述确认消息，获取会话密钥哈希值，同时，计算会话密钥为随机数与随机数的异或值，并计算会话密钥的哈希值；将与进行对比，若相等则车载终端与路侧设施间安全认证成功，并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败。7.根据权利要求6所述的基于国密算法的车联网通信路侧设施安全认证方法，其特征在于，在所述路侧设施接收车载终端构造的身份认证请求消息之前还包括：路侧设施向CA发送证书请求文件，接收CA对路侧设施的证书请求文件进行签发生成的数字证书，所述数字证书包括车载终端的公钥、路侧设施的公钥；所述CA对路侧设施签发的数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值。8.一种基于国密算法的车联网路侧设施，其特征在于，所述路侧设施包括随机数生成模块、证书签发模块、身份认证消息构造模块、认证模块；实现根据权利要求5-7任一所述的基于国密算法的车联网通信路侧设施安全认证方法，其中，所述随机数生成模块，通过所述路侧设施中预置的安全芯片内随机数生成器生成私钥，并存储在安全芯片的存储单元中不能导出；所述证书签发模块，用于路侧设施向CA发送证书请求文件，接收CA对路侧设施的证书请求文件进行签发生成的数字证书；所述身份认证消息构造模块，用于构造身份认证应答消息并将消息发送至车载终端；所述认证模块，用于在接收到车载终端构造的确认消息后，使用车载终端数字证书的公钥验证签名，同时验证会话密钥的哈希值，如果签名或会话密钥的哈希值验证失败，则车载终端与路侧设施间安全认证失败。9.一种基于国密算法的车联网通信安全认证系统，其特征在于，所述系统包括；权利要求4所述的车载终端、权利要求8所述的路侧设施和CA；所述CA包括证书签发模块，用于分别对从车载终端或路侧设施接收的证书请求文件进行签发生成数字证书，所述数字证书包括车载终端的公钥、路侧设施的公钥；所述数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值。10.一种基于国密算法的车联网通信安全认证设备，其特征在于，所述设备包括存储器和处理；所述存储器存储有实现基于国密算法的车联网通信安全认证方法的计算机程序，所述处理器执行所述计算机程序，以实现根据权利要求1-3、5-7任一所述方法的步骤。
说明书desc
技术领域本发明属于车联网安全技术领域，具体涉及一种基于国密算法的车联网通信安全认证方法、系统及设备。背景技术传统汽车行业在现有计算机和通信技术的驱动下，通过搭载传感器设备和通信设备实现车辆之间、车与路侧设施之间的通信。但由于车联网通信环境的开放性和高速移动性的特点，车辆的用户身份、地理位置等隐私信息可能会暴露在网络中。如果用户身份没有进行合法认证，使得用户信息无法得到有效的保护，车联网通信将带给用户隐私泄露、身份欺诈、虚假信息传播等一系列安全问题，同时车辆和路侧设施等信息节点将面临重放攻击、假冒攻击、消息拦截、窃听或篡改等安全威胁。与传统的物联网不同，现阶段的车联网身份认证技术存在以下局限性：计算和存储资源有限：车辆中大部分资源用于汽车驾驶技术，较少的资源用于计算和通信技术；服务平台专业化：车辆用户需要在多个服务端认证信息以获得多样化的体验，服务端需要不同的身份验证操作；路侧设施不完善：能够接入车联网数据的路侧设施节点通用性不强，造成网络延迟或资源浪费。基于上述分析，如何实现以较低的计算资源和通信带宽对车联网信息节点的身份合法性进行认证，是目前需要解决的技术问题。发明内容本发明目的是：针对现有技术的不足，提供一种基于国密算法的车联网通信安全认证方法、系统及设备，用来解决如何实现以较低的计算资源和通信带宽对车联网信息节点的身份合法性进行认证问题。具体地说，本发明是采用以下技术方案实现的。一方面，本发明提供一种基于国密算法的车联网通信车载终端安全认证方法，所述方法包括：车载终端构造身份认证请求消息发送至路侧设施；车载终端接收路侧设施所构造的身份认证应答消息，并验证签名；若验证失败，车载终端连接路侧设施的请求中断；若验证成功，则车载终端计算会话密钥及其哈希值并构造确认消息发送至路侧设施；所述身份认证应答消息由路侧设施根据接收的所述身份认证请求消息并验证签名成功后所构造；所述确认消息用于路侧设施计算会话密钥及其哈希值进行对比验证；若路侧设施计算的会话密钥的哈希值与车载终端计算的会话密钥的哈希值相等，则车载终端与路侧设施间安全认证成功并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败；所述车载终端构造身份认证请求消息的方法包括：车载终端生成临时序列号和随机数，利用SM2公钥加密算法使用路侧设施的公钥对随机数进行加密得，利用SM2数字签名算法使用车载终端的私钥对随机数的哈希值进行签名得，将临时序列号、身份标识符、加密随机数、签名哈希值组合所述身份认证请求消息；所述身份认证请求消息按照下式计算：其中，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法；所述车载终端接收路侧设施所构造的身份认证应答消息并验证签名的方法包括：车载终端接收路侧设施的身份认证应答消息，获取路侧设施的身份标识符，利用SM2公钥加密算法使用车载终端的私钥对加密随机数解密得随机数，利用SM2数字签名算法使用路侧设施的公钥验证签名哈希值。进一步地，所述车载终端计算会话密钥及其哈希值并构造确认消息的方法包括：车载终端计算会话密钥为随机数与随机数的异或值，并计算会话密钥的哈希值，将序列号、身份标识符、会话密钥哈希值组合确认消息；所述会话密钥、确认消息按照下式计算：其中，表示异或运算，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法。进一步地，在所述车载终端构造身份认证请求消息发送至路侧设施之前还包括：车载终端向CA发送证书请求文件，接收CA对车载终端的证书请求文件进行签发生成的数字证书，所述数字证书包括车载终端的公钥、路侧设施的公钥；所述CA对车载终端签发的数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值。另一方面，本发明还提供一种基于国密算法的车联网车载终端，所述车载终端包括随机数生成模块、证书签发模块、身份认证消息构造模块、认证模块；实现根据权利要求上述基于国密算法的车联网通信车载终端安全认证方法，其中，所述随机数生成模块，通过所述车载终端中预置的安全芯片内随机数生成器生成私钥，并存储在安全芯片的存储单元中不能导出；所述证书签发模块，用于车载终端向CA发送证书请求文件，接收CA对车载终端的证书请求文件进行签发生成的数字证书；所述身份认证消息构造模块，用于构造身份认证请求并发送至路侧设施；所述认证模块，用于在接收到路侧设施的身份认证应答消息后，使用路侧设施数字证书的公钥验证签名，同时计算会话密钥及其哈希值。再一方面，本发明还提供一种基于国密算法的车联网通信路侧设施安全认证方法，所述方法包括：路侧设施接收车载终端构造的身份认证请求消息并验证签名；若验证失败，车载终端连接路侧设施的请求中断；若验证成功，则路侧设施构造身份认证应答消息发送至车载终端；路侧设施接收车载终端构造的确认消息并计算会话密钥及其哈希值，与车载终端计算的会话密钥及其哈希值进行对比验证；若路侧设施计算的会话密钥的哈希值与车载终端计算的会话密钥的哈希值相等，则车载终端与路侧设施间安全认证成功并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败；所述确认消息由车载终端接收所述身份认证应答消息并验证签名验证成功，计算会话密钥及其哈希值后构造，并发送至路侧设施；所述路侧设施接收车载终端构造的身份认证请求消息并验证签名的方法包括：路侧设施接收车载终端的身份认证请求消息，获取车载终端的身份标识符，利用SM2公钥加密算法使用路侧设施的私钥对加密随机数解密得随机数，利用SM2数字签名算法使用车载终端的公钥验证签名哈希值；所述路侧设施构造身份认证应答消息的方法包括：路侧设施生成随机数，利用SM2公钥加密算法使用车载终端的公钥对随机数进行加密得，利用SM2数字签名算法使用路侧设施的私钥对随机数的哈希值进行签名得，将序列号、身份标识符、加密随机数、签名哈希值组合成所述身份认证应答消息；所述身份认证应答消息按照下式计算：其中，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法。进一步地，所述路侧设施接收所述确认消息并计算会话密钥及其哈希值进行对比验证的方法包括：路侧设施接收所述确认消息，获取会话密钥哈希值，同时，计算会话密钥为随机数与随机数的异或值，并计算会话密钥的哈希值；将与进行对比，若相等则车载终端与路侧设施间安全认证成功，并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败。进一步地，在所述路侧设施接收车载终端构造的身份认证请求消息之前还包括：路侧设施向CA发送证书请求文件，接收CA对路侧设施的证书请求文件进行签发生成的数字证书，所述数字证书包括车载终端的公钥、路侧设施的公钥；所述CA对路侧设施签发的数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值。又一方面，本发明还提供一种基于国密算法的车联网路侧设施，所述路侧设施包括随机数生成模块、证书签发模块、身份认证消息构造模块、认证模块；实现根据权利要求5-7任一所述的基于国密算法的车联网通信路侧设施安全认证方法，其中，所述随机数生成模块，通过所述路侧设施中预置的安全芯片内随机数生成器生成私钥，并存储在安全芯片的存储单元中不能导出；所述证书签发模块，用于路侧设施向CA发送证书请求文件，接收CA对路侧设施的证书请求文件进行签发生成的数字证书；所述身份认证消息构造模块，用于构造身份认证应答消息并将消息发送至车载终端；所述认证模块，用于在接收到车载终端构造的确认消息后，使用车载终端数字证书的公钥验证签名，同时验证会话密钥的哈希值，如果签名或会话密钥的哈希值验证失败，则车载终端与路侧设施间安全认证失败。又一方面，本发明还提供一种基于国密算法的车联网通信安全认证系统，所述系统包括；上述车载终端、路侧设施和CA；所述CA包括证书签发模块，用于分别对从车载终端或路侧设施接收的证书请求文件进行签发生成数字证书，所述数字证书包括车载终端的公钥、路侧设施的公钥；所述数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值。又一方面，本发明还提供一种基于国密算法的车联网通信安全认证设备，所述设备包括存储器和处理；所述存储器存储有实现基于国密算法的车联网通信安全认证方法的计算机程序，所述处理器执行所述计算机程序，以实现上述方法的步骤。本发明的基于国密算法的车联网通信安全认证方法、系统及设备的有益效果如下：本发明结合SM2公钥加密算法、SM2数字签名算法和SM3杂凑算法为车联网通信节点设备进行双向身份认证，在保证车联网消息能够有效安全传输的前提下，能够减少复杂运算的次数，降低时间复杂度并节省车载终端内存。本发明完成对车载终端和路侧服务端基于国密算法的双向身份认证后，能够通过随机数生成器生成会话密钥，会话密钥可以作为对称密钥对后续车联网通信消息传输进行加密，确保之后车联网通信数据的保密性。本发明对每个节点连接进行身份认证，身份认证完成后，会生成新会话密钥，由于会话密钥的不断更新，攻击者无法及时获取新会话密钥，有效地确保消息无法被长期窃听的可能。本发明采用临时序列号、随机数及会话密钥散列值进行对比验证，若散列值不同，则用户消息在认证过程中产生变动无法通过认证，有效地防止消息重放攻击、假冒攻击、中间人攻击等多种安全威胁的发生。附图说明图1是本发明的车联网通信安全认证系统组成及流程图。图2是本发明CA签发的数字证书信息结构示意图。图3是本发明的车联网通信安全认证详细流程图。图4是本发明的方法中双向身份认证计算和通信开销示意图。图5是实施例2的车联网车载终端和实施例3的车联网路侧设施的结构示意图。图6是实施例6的结构示意图。具体实施方式下面结合实施例并参照附图对本发明作进一步详细描述。实施例1：本发明的一个实施例，为一种基于国密算法的车联网通信安全认证方法，基于SM2数字签名算法、SM2公钥加密算法和SM3杂凑算法，由车联网中车载终端、路侧设施实现车载终端、路侧设施间双向身份认证，如图1所示。车载终端与路侧设施出厂预置有安全芯片内的随机数生成器分别生成私钥、，并存储在安全芯片的存储单元中不能导出。在车载终端与路侧设施进行双向安全身份认证之前，车载终端和路侧设施分别向CA发送证书请求文件，CA分别对车载终端和路侧设施的证书请求文件进行签发生成数字证书，数字证书包括车载终端的公钥、路侧设施的公钥。该数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值，如图2所示。其中，版本号，用于标识该证书的X.509标准的版本；序列号，颁发证书的实体为证书指定序列号，用于区别该实体颁发的其他证书；签名算法，用于标识CA签发证书时所使用的算法；颁发者，用于标识证书签名和证书颁发的实体；有效期，用于标识证书在一个有限的时间段内有效，有效期以证书起始日期的时间和终止日期的时间表示；主体，用于标识证书可以识别主体公钥的实体名，主体名称使用X.500标准在网络中是唯一的；主体公钥，用于标识主体的公钥信息；主体公钥算法，用于标识主体相应的公钥算法；签名值，用于标识CA数字签名信息，有效验证数字证书的真伪。基于国密算法的车联网通信安全认证方法包括由车载终端实现的基于国密算法的车联网通信车载终端安全认证方法，和由路侧设施实现的基于国密算法的车联网通信路侧设施安全认证方法，具体流程如图3所示。包括以下步骤：一、车载终端构造身份认证请求消息发送至路侧设施。车载终端生成临时序列号和随机数，利用SM2公钥加密算法使用路侧设施的公钥对随机数进行加密得，利用SM2数字签名算法使用车载终端的私钥对随机数的哈希值进行签名得，将临时序列号、身份标识符、加密随机数、签名哈希值组合所述身份认证请求消息；身份认证请求消息按照下式计算：；其中，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法。二、路侧设施接收身份认证请求消息并验证签名；若验证失败，车载终端连接路侧设施的请求中断；若验证成功，则路侧设施构造身份认证应答消息发送至车载终端。路侧设施接收身份认证请求消息并验证签名具体包括：路侧设施接收车载终端的身份认证请求消息，获取车载终端的身份标识符，利用SM2公钥加密算法使用路侧设施的私钥对加密随机数解密得随机数，利用SM2数字签名算法使用车载终端的公钥验证签名哈希值。若验证成功，路侧设施构造身份认证应答消息，具体包括：路侧设施生成随机数，利用SM2公钥加密算法使用车载终端的公钥对随机数进行加密得，利用SM2数字签名算法使用路侧设施的私钥对随机数的哈希值进行签名得，将序列号、身份标识符、加密随机数、签名哈希值组合成所述身份认证应答消息；所述身份认证应答消息按照下式计算：其中，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法。三、车载终端接收所述身份认证应答消息并验证签名；若验证失败，车载终端连接路侧设施的请求中断；若验证成功，则车载终端计算会话密钥及其哈希值并构造确认消息发送至路侧设施。车载终端接收所述身份认证应答消息并验证签名具体包括：车载终端接收路侧设施的身份认证应答消息，获取路侧设施的身份标识符，利用SM2公钥加密算法使用车载终端的私钥对加密随机数解密得随机数，利用SM2数字签名算法使用路侧设施的公钥验证签名哈希值。若验证成功，车载终端计算会话密钥及其哈希值并构造确认消息，具体包括：车载终端计算会话密钥为随机数与随机数的异或值，并计算会话密钥的哈希值，将序列号、身份标识符、会话密钥哈希值组合确认消息；所述会话密钥、确认消息按照下式计算：其中，表示异或运算，表示数据连接符，计算哈希值使用的散列算法为SM3国密杂凑算法。四、路侧设施接收确认消息并计算会话密钥及其哈希值进行对比验证；若会话密钥的哈希值相等，则车载终端与路侧设施间安全认证成功并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败。具体包括：路侧设施接收确认消息，获取会话密钥哈希值，同时，计算会话密钥为随机数与随机数的异或值，并计算会话密钥的哈希值；将与进行对比，若相等则车载终端与路侧设施间安全认证成功，并生成会话密钥，若不相等，则车载终端与路侧设施间安全认证失败。本发明采用的SM2密钥长度为256bits，身份识别符为8字节的硬件编码，随机数长度为16字节。如图4所示，本发明与传统单一的基于ECC椭圆曲线、SM2密钥协商、RSA算法的认证方法相比，在保证车联网消息能够有效安全传输的前提下，能够减少复杂运算的次数，降低时间复杂度并节省车载终端内存，能够以较低的计算资源和通信带宽实现高效率的身份认证。对车载终端和路侧服务端基于国密算法的双向身份认证后能够通过随机数生成器生成的会话密钥，可以作为对称密钥对后续车联网通信消息传输进行加密，确保之后车联网通信数据的保密性。对每个节点连接进行身份认证，身份认证完成后生成新会话密钥，由于会话密钥的不断更新，攻击者无法及时获取新会话密钥，有效地确保消息无法被长期窃听的可能。双向身份认证过程中，采用临时序列号、随机数及会话密钥散列值进行对比验证，若散列值不同，则用户消息在认证过程中产生变动无法通过认证，有效地防止消息重放攻击、假冒攻击、中间人攻击等多种安全威胁的发生。实施例2：本发明的另一个实施例，为一种基于国密算法的车联网车载终端，包括随机数生成模块、证书签发模块、身份认证消息构造模块、认证模块，如图5所示。本实施例的车载终端实现如实施例1所述的基于国密算法的车联网通信车载终端安全认证方法，其中，随机数生成模块，通过所述车载终端中出厂预置的安全芯片内随机数生成器生成私钥，并存储在安全芯片的存储单元中不能导出；证书签发模块，用于车载终端向CA发送证书请求文件，接收CA对车载终端的证书请求文件进行签发生成的数字证书；身份认证消息构造模块，用于构造身份认证请求并发送至路侧设施；认证模块，用于在接收到路侧设施的身份认证应答消息后，使用路侧设施数字证书的公钥验证签名，同时计算会话密钥及其哈希值。实施例3：本发明的另一个实施例，为一种基于国密算法的车联网路侧设施，包括随机数生成模块、证书签发模块、身份认证消息构造模块、认证模块，如图5所示。本实施例的路侧设施实现如实施例1所述的基于国密算法的车联网通信路侧设施安全认证方法，其中，随机数生成模块，通过所述路侧设施中出厂预置的安全芯片内随机数生成器生成私钥，并存储在安全芯片的存储单元中不能导出；证书签发模块，用于路侧设施向CA发送证书请求文件，接收CA对路侧设施的证书请求文件进行签发生成的数字证书；身份认证消息构造模块，用于构造身份认证应答消息并将消息发送至车载终端；认证模块，用于在接收到车载终端构造的确认消息后，使用车载终端数字证书的公钥验证签名，同时验证会话密钥的哈希值，如果签名或会话密钥的哈希值验证失败，则车载终端与路侧设施间安全认证失败。实施例4：本发明的另一个实施例，为一种基于国密算法的车联网CA，包括证书签发模块，用于分别对从车载终端或路侧设施接收的证书请求文件进行签发生成数字证书，数字证书包括车载终端的公钥、路侧设施的公钥；数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值。该数字证书为X.509格式的CA根证书，数字证书信息包括版本号、序列号、签名算法、颁发者、有效期、主体、主体公钥、主体公钥算法、签名值，如图2所示。其中，版本号，用于标识该证书的X.509标准的版本；序列号，颁发证书的实体为证书指定序列号，用于区别该实体颁发的其他证书；签名算法，用于标识CA签发证书时所使用的算法；颁发者，用于标识证书签名和证书颁发的实体；有效期，用于标识证书在一个有限的时间段内有效，有效期以证书起始日期的时间和终止日期的时间表示；主体，用于标识证书可以识别主体公钥的实体名，主体名称使用X.500标准在网络中是唯一的；主体公钥，用于标识主体的公钥信息；主体公钥算法，用于标识主体相应的公钥算法；签名值，用于标识CA数字签名信息，有效验证数字证书的真伪。实施例5：本发明的另一个实施例，为一种基于国密算法的车联网通信安全认证系统，包括；至少一个如实施例2所述的基于国密算法的车联网车载终端、实施例3所述的基于国密算法的车联网路侧设施和实施例4所述的基于国密算法的车联网CA。车载终端与路侧设施出厂预置的安全芯片内的随机数生成器生成私钥，并存储在安全芯片的存储单元中不能导出；车载终端和路侧设施向CA发送证书请求文件，CA对车载终端和路侧设施的证书请求文件进行签发生成数字证书；车载终端构造身份认证请求消息发送至路侧设施，路侧设施接收请求消息并验证签名；路侧设施构造身份认证应答消息发送至车载终端，车载终端接收应答消息并验证签名；车载终端计算会话密钥及其哈希值并构造确认消息发送至路侧设施，路侧设施接收确认消息并计算会话密钥及其哈希值进行对比验证。实施例6：本发明的另一个实施例，为一种基于国密算法的车联网通信安全认证设备，所述设备包括存储器和处理，如图6所示。存储器存储有实现基于国密算法的车联网通信安全认证方法的计算机程序，处理器执行该计算机程序，以实现基于国密算法的车联网通信车载终端安全认证方法或基于国密算法的车联网通信路侧设施安全认证方法的步骤。本发明的基于国密算法的车联网通信安全认证方法、系统及设备，具有以下技术效果：本发明结合SM2公钥加密算法、SM2数字签名算法和SM3杂凑算法为车联网通信节点设备进行双向身份认证，在保证车联网消息能够有效安全传输的前提下，能够减少复杂运算的次数，降低时间复杂度并节省车载终端内存。本发明完成对车载终端和路侧服务端基于国密算法的双向身份认证后，能够通过随机数生成器生成会话密钥，会话密钥可以作为对称密钥对后续车联网通信消息传输进行加密，确保之后车联网通信数据的保密性。本发明对每个节点连接进行身份认证，身份认证完成后，会生成新会话密钥，由于会话密钥的不断更新，攻击者无法及时获取新会话密钥，有效地确保消息无法被长期窃听的可能。本发明采用临时序列号、随机数及会话密钥散列值进行对比验证，若散列值不同，则用户消息在认证过程中产生变动无法通过认证，有效地防止消息重放攻击、假冒攻击、中间人攻击等多种安全威胁的发生。在一些实施例中，上述技术的某些方面可以由执行软件的处理系统的一个或多个处理器来实现。该软件包括存储或以其他方式有形实施在非暂时性计算机可读存储介质上的一个或多个可执行指令集合。软件可以包括指令和某些数据，这些指令和某些数据在由一个或多个处理器执行时操纵一个或多个处理器以执行上述技术的一个或多个方面。非暂时性计算机可读存储介质可以包括例如磁或光盘存储设备，诸如闪存、高速缓存、随机存取存储器等的固态存储设备或其他非易失性存储器设备。存储在非临时性计算机可读存储介质上的可执行指令可以是源代码、汇编语言代码、目标代码或被一个或多个处理器解释或以其他方式执行的其他指令格式。计算机可读存储介质可以包括在使用期间可由计算机系统访问以向计算机系统提供指令和/或数据的任何存储介质或存储介质的组合。这样的存储介质可以包括但不限于光学介质、数字多功能光盘、蓝光光盘)、磁介质、易失性存储器或高速缓存)、非易失性存储器或闪存)或基于微机电系统的存储介质。计算机可读存储介质可以嵌入计算系统中，固定地附接到计算系统，可移除地附接到计算系统的闪存)，或者经由有线或无线网络)耦合到计算机系统。请注意，并非上述一般性描述中的所有活动或要素都是必需的，特定活动或设备的一部分可能不是必需的，并且除了描述的那些之外可以执行一个或多个进一步的活动或包括的要素。更进一步，活动列出的顺序不必是执行它们的顺序。而且，已经参考具体实施例描述了这些概念。然而，本领域的普通技术人员认识到，在不脱离如下权利要求书中阐述的本公开的范围的情况下，可以进行各种修改和改变。因此，说明书和附图被认为是说明性的而不是限制性的，并且所有这样的修改被包括在本公开的范围内。上面已经关于具体实施例描述了益处、其他优点和问题的解决方案。然而，可能导致任何益处、优点或解决方案发生或变得更明显的益处、优点、问题的解决方案以及任何特征都不应被解释为任何或其他方面的关键、必需或任何或所有权利要求的基本特征。此外，上面公开的特定实施例仅仅是说明性的，因为所公开的主题可以以受益于这里的教导的本领域技术人员显而易见的不同但等同的方式进行修改和实施。除了在权利要求书中描述的以外，没有意图限制在此示出的构造或设计的细节。因此明显的是，上面公开的特定实施例可以被改变或修改，并且所有这样的变化被认为在所公开的主题的范围内。
