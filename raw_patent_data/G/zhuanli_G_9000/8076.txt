标题title
基于未来网络的智慧影院系统
摘要abst
本申请公开了一种基于未来网络的智慧影院系统，包括：人流量检测模块，用于检测预设时间段内进出影院的人流量；喜好捕捉模块，用于根据面部表情和肢体动作识别出用户喜好；身份验证模块，用于验证用户身份，当身份验证通过时，自动打开闸机允许用户进入观影厅；服务器集群模块，用于根据预设的动态负载均衡算法进行服务器负载均衡，并校验、存储传输过来的影片；物联网模块，用于根据电子标签编码对系统中的各物联网设备进行编码寻址。本申请依托未来网络构建一个功能完善的智慧影院系统，推动了影院在智能化、信息化、自动化方面的进步，对影视行业的发展及功能拓展提供技术支持和保障，提升了影院观众的用户粘度。
权利要求书clms
1.一种基于未来网络的智慧影院系统，其特征在于，包括：人流量检测模块，用于检测预设时间段内进出影院的人流量；喜好捕捉模块，用于获取用户在影院广告屏幕前的面部表情和肢体动作，并根据所述面部表情和肢体动作识别出用户喜好；身份验证模块，用于验证用户身份，当身份验证通过时，自动打开闸机允许用户进入观影厅；服务器集群模块，用于根据预设的动态负载均衡算法进行服务器负载均衡，并校验、存储传输过来的影片；物联网模块，用于根据电子标签编码对系统中的各物联网设备进行编码寻址。2.根据权利要求1所述的系统，其特征在于，所述服务器集群模块，包括：负载均衡服务器，用于根据预设的动态负载均衡方法将服务请求分配到实际执行的服务器中；影院下载节点服务器，用于下载影片；文件存储服务器，用于接收、校验、存储影片，并向各个放映机分发影片。3.根据权利要求2所述的系统，其特征在于，所述预设的动态负载均衡方法，包括：计算预设反馈周期内目标服务器所有请求响应时间的平均值、方差以及偏离度；根据系统稳定运行时的第一个反馈周期内请求响应时间的平均值和方差的差值，得到平均响应时间最大值；若当前反馈周期内目标服务器所有请求响应时间的平均值小于所述平均响应时间最大值，且偏离度在相邻两反馈周期的变化幅度大于等于预设阈值，则更新目标服务器的各个性能指标的权重。4.根据权利要求3所述的系统，其特征在于，更新目标服务器的各个性能指标的权重，包括：计算服务器集群中所有服务器各个性能指标的当前占用率平均值；当目标服务器的目标性能指标的占用率大于等于对应的占用率平均值时，增大目标服务器的目标性能指标对应的权重；当目标服务器的目标性能指标的占用率小于对应的占用率平均值时，减小目标服务器的目标性能指标对应的权重。5.根据权利要求3所述的系统，其特征在于，还包括：若当前反馈周期内目标服务器所有请求响应时间的平均值大于等于所述平均响应时间最大值，则将目标服务器的权重设置为0；若当前反馈周期内目标服务器所有请求响应时间的平均值小于所述平均响应时间最大值，且偏离度在相邻两反馈周期的变化幅度小于预设阈值，则不更新目标服务器的权重。6.根据权利要求1所述的系统，其特征在于，所述物联网模块，包括：物联网单元，用于根据影院需求对影院设备进行电子标签编码，将电子标签编码按照预设的映射规则映射为未来网络IPV9可聚合全局单目地址，并直接路由到相应的服务器，从而完成对目标设备的寻址查询；数据库单元，用于进行数据存储和分析，得到管理员信息表、影院流量监控表、观众喜好捕捉记录表、影厅进出信息记录表、影厅温度记录表、下载服务器影片传输进度信息表以及设备故障信息表；前端界面单元，用于提供用户注册、用户登录、权限管理基础功能，用于对终端采集的数据进行模块化展示，并根据数据库中的数据进行实时更新，还用于实现系统内部组件间通信。7.根据权利要求6所述的系统，其特征在于，所述IPV9可聚合全局单目地址包含六个部分，各部分长度固定，依次为格式前缀、顶级聚合标识、保留域、二级聚合标识、站点级聚合标识以及网络接口标识。8.根据权利要求1所述的系统，其特征在于，所述人流量检测模块，包括：人体感应单元，用于通过红外探测方式检测进出影院的人流量；显示单元，用于显示当前的时间信息以及人流量信息；声光报警单元，用于当设备故障时，发出声光报警信息；通信单元，用于将检测的人流量信息发送到数据库。9.根据权利要求1所述的系统，其特征在于，所述喜好捕捉模块，包括：人体检测单元，用于检测用户距离影院广告屏幕的距离；光敏检测单元，用于检测环境光照强度；彩屏显示单元，用于显示票价、场次、电影预告片信息；声光报警单元，用于当设备故障时，发出声光报警信息；图像处理单元，用于拍摄用户在影院广告屏幕前的面部表情图像和肢体动作图像，并根据所述面部表情图像和肢体动作图像识别出用户喜好；通信单元，用于将用户喜好信息发送到数据库。10.根据权利要求1所述的系统，其特征在于，所述身份验证模块，包括：身份验证单元，用于通过头像识别、身份证刷卡、二维码识别中的一种或多种方式验证用户身份；闸机单元，用于当用户身份验证通过时，自动打开闸机，允许用户进入影厅；人体感应单元，用于当闸机打开时亮灯，并检测用户是否通过闸机；通信单元，用于当用户硬闯闸机时向管理人员发送提示信息；语音单元，用于当用户身份验证失败或硬闯闸机时发出语音提示。
说明书desc
技术领域本发明涉及智慧影院技术领域，特别涉及一种基于未来网络的智慧影院系统。背景技术影院作为电影产业的末端，其建设可直接推动电影市场的发展。目前，“智慧影院”紧跟时代需求，把科研实力转化为创新动能，运用现代信息技术手段，优化了影院经营模式、管理方法及观众的观影流程，助力影院优化管理方法，提升管理效益，实现降本增效，同时提升用户的购票观影体验。物联网作为智慧影院的基础和关键，可实现影院中各个设备可寻址、可通信、可控制。但是，由于物联网应用场景的不断拓展，全球物联网设备数量的高速增长带来IP地址的严重匮乏、服务器高并发、智能设备难以统一管理等问题。发明内容本申请实施例提供了一种基于未来网络的智慧影院系统。为了对披露的实施例的一些方面有一个基本的理解，下面给出了简单的概括。该概括部分不是泛泛评述，也不是要确定关键/重要组成元素或描绘这些实施例的保护范围。其唯一目的是用简单的形式呈现一些概念，以此作为后面的详细说明的序言。本申请实施例提供了一种基于未来网络的智慧影院系统，包括：人流量检测模块，用于检测预设时间段内进出影院的人流量；喜好捕捉模块，用于获取用户在影院广告屏幕前的面部表情和肢体动作，并根据面部表情和肢体动作识别出用户喜好；身份验证模块，用于验证用户身份，当身份验证通过时，自动打开闸机允许用户进入观影厅；服务器集群模块，用于根据预设的动态负载均衡算法进行服务器负载均衡，并校验、存储传输过来的影片；物联网模块，用于根据电子标签编码对系统中的各物联网设备进行编码寻址。在本申请的一些实施例中，服务器集群模块，包括：负载均衡服务器，用于根据预设的动态负载均衡方法将服务请求分配到实际执行的服务器中；影院下载节点服务器，用于下载影片；文件存储服务器，用于接收、校验、存储影片，并向各个放映机分发影片。在本申请的一些实施例中，预设的动态负载均衡方法，包括：计算预设反馈周期内目标服务器所有请求响应时间的平均值、方差以及偏离度；根据系统稳定运行时的第一个反馈周期内请求响应时间的平均值和方差的差值，得到平均响应时间最大值；若当前反馈周期内目标服务器所有请求响应时间的平均值小于平均响应时间最大值，且偏离度在相邻两反馈周期的变化幅度大于等于预设阈值，则更新目标服务器的各个性能指标的权重。在本申请的一些实施例中，更新目标服务器的各个性能指标的权重，包括：计算服务器集群中所有服务器各个性能指标的当前占用率平均值；当目标服务器的目标性能指标的占用率大于等于对应的占用率平均值时，增大目标服务器的目标性能指标对应的权重；当目标服务器的目标性能指标的占用率小于对应的占用率平均值时，减小目标服务器的目标性能指标对应的权重。在本申请的一些实施例中，还包括：若当前反馈周期内目标服务器所有请求响应时间的平均值大于等于平均响应时间最大值，则将目标服务器的权重设置为0；若当前反馈周期内目标服务器所有请求响应时间的平均值小于平均响应时间最大值，且偏离度在相邻两反馈周期的变化幅度小于预设阈值，则不更新目标服务器的权重。在本申请的一些实施例中，物联网模块，包括：物联网单元，用于根据影院需求对影院设备进行电子标签编码，将电子标签编码按照预设的映射规则映射为IPV9可聚合全局单目地址，并直接路由到相应的服务器，从而完成对目标设备的寻址查询；数据库单元，用于进行数据存储和分析，得到管理员信息表、影院流量监控表、观众喜好捕捉记录表、影厅进出信息记录表、影厅温度记录表、下载服务器影片传输进度信息表以及设备故障信息表；前端界面单元，用于提供用户注册、用户登录、权限管理基础功能，用于对终端采集的数据进行模块化展示，并根据数据库中的数据进行实时更新，还用于实现系统内部组件间通信。在本申请的一些实施例中，IPV9可聚合全局单目地址包含六个部分，各部分长度固定，依次为格式前缀、顶级聚合标识、保留域、二级聚合标识、站点级聚合标识以及网络接口标识。在本申请的一些实施例中，人流量检测模块，包括：人体感应单元，用于通过红外探测方式检测进出影院的人流量；显示单元，用于显示当前的时间信息以及人流量信息；声光报警单元，用于当设备故障时，发出声光报警信息；通信单元，用于将检测的人流量信息发送到数据库。在本申请的一些实施例中，喜好捕捉模块，包括：人体检测单元，用于检测用户距离影院广告屏幕的距离；光敏检测单元，用于检测环境光照强度；彩屏显示单元，用于显示票价、场次、电影预告片信息；声光报警单元，用于当设备故障时，发出声光报警信息；图像处理单元，用于拍摄用户在影院广告屏幕前的面部表情图像和肢体动作图像，并根据面部表情图像和肢体动作图像识别出用户喜好；通信单元，用于将用户喜好信息发送到数据库。在本申请的一些实施例中，身份验证模块，包括：身份验证单元，用于通过头像识别、身份证刷卡、二维码识别中的一种或多种方式验证用户身份；闸机单元，用于当用户身份验证通过时，自动打开闸机，允许用户进入影厅；人体感应单元，用于当闸机打开时亮灯，并检测用户是否通过闸机；通信单元，用于当用户硬闯闸机时向管理人员发送提示信息；语音单元，用于当用户身份验证失败或硬闯闸机时发出语音提示。本申请实施例提供的技术方案可以包括以下有益效果：本申请实施例提供了一种基于未来网络的物联网系统，业务面向智慧影院的设备监测和统一管理，主要工作成果有以下几点：针对物联网感知层终端接入数量激增、移动性需求、安全性需求及网络层寻址特点，提出一种基于未来网络的智慧影院系统。系统在各影院之间、城际服务器通信的数据接入部分使用未来网络IPV9进行组网，未来网络因其 2048位地址及42层地址结构而具有良好的伸缩性，能够切实解决路由寻址问题，可实现提供海量IP地址、简化地址自动配置过程、降低通信费用、提高传输安全等需求。针对用户访问总流量过大导致服务器过载性能下降问题，从服务器集群的负载均衡角度出发，提出一种动态负载均衡的优化算法。以服务器对网络请求的响应时间的平均值作为负载状态的评价标准，动态更新服务器在集群中的权值及单个服务器各性能指标的权重，从而避免出现单点过载问题，极大提升了服务器集群的负载能力。结合未来网络相关技术，本文对智慧影院进行全面分析和构思，通过各设备的IPv9地址及IPv9数字域名和DPC编码对影院设备进行统一十进制编码、寻址，识别各设备及进行设备管理，在实验网络中完成智慧影院后台管理系统的开发及测试，利用组网特点和未来网络相关设备验证该系统在未来网络中的可行性与发展潜力。该系统通过未来网络构建一个功能完善的智慧影院系统，以推动影院在智能化、信息化、自动化方面的进步为目标，对影视行业的发展及功能拓展提供技术支持和保障，提升影院观众的用户粘度，实时检测影院中停留的人数、用户喜好并为用户提供舒适的观影环境和服务。应当理解的是，以上的一般描述和后文的细节描述仅是示例性和解释性的，并不能限制本发明。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本发明的实施例，并与说明书一起用于解释本发明的原理。图1是根据一示例性实施例示出的一种基于未来网络的智慧影院系统的结构示意图；图2是根据一示例性实施例示出的一种服务器集群的示意图；图3是根据一示例性实施例示出的一种动态负载均衡方法的示意图；图4是根据一示例性实施例示出的一种智慧影院系统组网拓扑图；图5是根据一示例性实施例示出的一种DPC编码的标准格式图；图6是根据一示例性实施例示出的一种放映机信息编码图；图7是根据一示例性实施例示出的一种DPC编码与IPV9地址映射图。具体实施方式以下描述和附图充分地示出本发明的具体实施方案，以使本领域的技术人员能够实践它们。应当明确，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。以下示例性实施例中所描述的实施方式并不代表与本发明相一致的所有实施方式。相反，它们仅是如所附权利要求书中所详述的、本发明的一些方面相一致的系统和方法的例子。随着影院、银幕、数量的增加，观影爱好者对观影体验也提出了新的要求。影院在放映技术、放映设备等方面都不断改良，21世纪我国快步进入信息化时代，电子设备的研发提上日程，2D放映模式日渐被3D电影放映模式代替，影片内容放映管理从人工播放逐渐向自动化影院管理系统迁移。这些智能化设备的介入有效提升了观众的观影体验，刺激了用户的消费欲望，但与此同时也为影院运营、技术支持提出了新的挑战，完成影院全智能化、网络化的监控及集成影院放映质量的自动监控成为21世纪影院的技术目标。基于此，本申请在未来网络体系架构的基础上，依托物联网构建一个功能完善的智慧影院系统，以推动影院在智能化、信息化、自动化方面的进步为目标，对影视行业的发展及功能拓展提供技术支持和保障，提升影院观众的用户粘度，实时检测影院中停留的人数、用户喜好并为用户提供舒适的观影环境和服务。且本系统在各影院之间、城际服务器通信的数据接入部分使用未来网络组网。可提供海量IP地址、简化地址自动配置过程、降低通信费用、提高传输安全，可准确、及时、高效安全的实现影院智慧化。下面将结合附图对本申请实施例提供的基于未来网络的智慧影院系统进行详细介绍。如图1所示，该智慧影院系统包括人流量检测模块，用于检测预设时间段内进出影院的人流量。在一个可选地实施例中，人流量检测模块，包括：人体感应单元，用于通过红外探测方式检测进出影院的人流量。例如，通过DSS-050无线PIR人体感应传感器，作为数据输入端，由机械控制部分、透镜、感光电路、感光元件、机械部分组成，作为可探测人体的红外热释感应器，可用于检测人流进出方向，由主控芯片计数运算后显示。还包括显示单元，用于显示当前的时间信息以及人流量信息，例如，通过 OLED有机电激光显示屏，作为数据输出端，用于显示当前时间信息及人流量信息。还包括声光报警单元，用于当设备故障时，发出声光报警信息，例如，通过发光二极管、蜂鸣器组成声光报警器，作为数据输出端，当设备发生故障时，发出声光报警信息。还包括通信单元，用于将检测的人流量信息发送到数据库，例如，通过DL- 20无线串口透传模块，基于UART接口的全双工无线透明传输模块，作为数据输出端，用于与其他设备及核心服务器进行数据无线传输。通过人流量检测模块可以检测每半小时内的人流量，对进出影院的人数进行统计后上传至服务器，以此作为影厅热片电影放映的数据基础，减少空闲时刻和空闲座位的资源浪费。本申请实施例提供的智慧影院系统还包括喜好捕捉模块，用于获取用户在影院广告屏幕前的面部表情和肢体动作，并根据面部表情和肢体动作识别出用户喜好。该子系统使用目前成熟的单片机技术，对停留在影院走廊广告屏幕前超过半分钟的观众进行面部表情和肢体动作识别，将这部分数据回传后，通过机器学习进一步分析大数据，获得用户偏好，准确把握需求，提供有效服务从而增强用户黏度。在本申请的一些实施例中，喜好捕捉模块，包括：人体检测单元，用于检测用户距离影院广告屏幕的距离，人体检测单元可为超声波传感器。通过将超声波信号转换成电信号探测观众距离屏幕距离。光敏检测单元，用于检测环境光照强度，通过对外界光信号或光辐射有响应，将光信号转换为电信号，配合超声波传感器实现屏幕亮度调整。彩屏显示单元，用于显示票价、场次、电影预告片信息，播放用户可能感兴趣的票价咨询、电影预告片等。声光报警单元，用于当设备故障时，发出声光报警信息。图像处理单元，用于拍摄用户在影院广告屏幕前的面部表情图像和肢体动作图像，并采用预设的机器学习算法分析图像，根据面部表情和肢体动作识别出用户喜好。例如，通过用户感兴趣的图像集训练分类模型，将拍摄的用户图像输入分类模型，得到用户是否对广告中的影片感兴趣。通信单元，用于将用户喜好信息发送到数据库。例如，采用DL- 20无线串口透传，基于UART接口的全双工无线透明传输模块，作为数据输出端，用于与其他设备及核心服务器进行数据无线传输。在一个可选地实施例中，喜好捕捉模块通过在影厅等候区的广告屏幕中加入US-016超声波传感器和光敏传感器，用于检测观众和屏幕之间的距离，当距离小于阈值时，降低屏幕亮度提升观众阅读舒适感。当观众在一个广告前停留时间超过60s，则判断该观众对此时广告内容感兴趣，系统将观众感兴趣的广告内容以格式为“AA_002_1_2_080
”的字符串上报至数据处理服务器，其中 AA为头码；002是该系统在整个影院系统中的智能设备编号；1表示工作状态正常，2表示观众感兴趣的广告序号，080表示驻足的时间。当设备故障时，该系统可实现主动声光报警，并向服务器发送字符串“AA_002_0_0_000
”。通过设置用户喜好捕捉模块，可以分析用户喜好，根据用户喜好调整影片场次和场数等，增强用户粘度。本申请实施例提供的智慧影院系统还包括身份验证模块，用于验证用户身份，当身份验证通过时，自动打开闸机允许用户进入观影厅。该子系统主要是对观众能否进入某影厅进行权限限制和条件允许，取消人工检票功能，通过对观众的多元特征识别及对比，方便已购票用户快速进入影厅观影，对多次验证失败或直接硬闯用户通过短信向保安、影院管理者报警。在本申请的一些实施例中，身份验证模块，包括：身份验证单元，用于通过头像识别、身份证刷卡、二维码识别中的一种或多种方式验证用户身份。例如，在闸机布置人脸识别装置，通过将拍摄的人脸图像与服务器存储的购票人员身份证上的人脸图像进行对比，若一致，则身份验证通过。或者，用户买票后生成购票二维码，在进入影厅时，打开手机中的二维码进行扫码识别。也可以通过刷身份证进行身份验证。闸机单元，用于当用户身份验证通过时，自动打开闸机，允许用户进入影厅；人体感应单元，用于当闸机打开时亮灯，并检测用户是否通过闸机，当用户通过闸机后，控制闸机关闭。通信单元，用于当用户硬闯闸机时向管理人员发送提示信息，语音单元，用于当用户身份验证失败或硬闯闸机时发出语音提示。在一些可选地实施方式中，身份验证模块采用继电器模拟检票闸机，使用 RFID射频模块模拟购票观众的身份卡，当用户购票成功后在信息管理系统中激活该观众的身份卡，观众可刷卡通过闸机，该系统将观众身份信息以格式为“AA_004_1_16431649
”的字符串上报至数据处理服务器，其中其中AA为头码；002是该系统在整个影院系统中的智能设备编号；1表示工作状态正常， 16431649是该观众的身份编号。当某顾客没有买票闯入闸机时，该系统使用 Air724UG通信模块向影院保安和管理人员发送报警短信，并发起声光报警，内容为“非法闯入”，并向服务器发送字符串“AA_004_1_FFFFFFFF
”。当设备故障时，该系统可实现主动声光报警，并向服务器发送字符串“AA_004_ 0_00000000
”。通过设置身份验证模块，可以自主识别用户身份，取消人工检票，降低影院运营成本，提高客户体验度。可选地，本申请实施例中的智慧影院系统，还包括温湿度控制模块，该模块使用DHT11数字温湿度传感器实时测量空气温湿度，设置环境温度的阈值范围为18-25℃，相对湿度的阈值范围为40％-70％，当温湿度超出阈值时，启动温湿度调节系统。该系统每两小时将当前环境温湿度以格式为“AA_003_1_20_50
”的字符串上报至数据处理服务器，其中AA为头码；003 是该系统在整个影院系统中的智能设备编号；1表示工作状态正常，20表示当前温度，50表示当前相对湿度。当设备故障时，该系统可实现主动声光报警，并向服务器发送字符串“AA_003_0_00
”。通过设置温湿度调节模块，可以合理自动调控影厅温湿度，给用户提供舒适的观影环境，提高用户体验度。本申请实施例提供的基于未来网络的智慧影院系统，还包括服务器集群模块，用于根据预设的动态负载均衡算法进行服务器负载均衡，并校验、存储传输过来的影片。如图2所示，是目前北京邮电大学与苏州五洋影院正在合作开展的智慧影院建设试点的院线服务器集群网络图。主要由以下几个模块组成：负载均衡服务器，用于根据预设的动态负载均衡方法将服务请求分配到实际执行的服务器中，降低整体系统的响应时间。生产环境中的各个服务器因使用时长、硬件更替或软件升级等多方面原因导致服务器集群中的服务器硬件配置很难统一，因此绝大多数的服务器集群均为异构集群系统。一个由n台不同性能的服务器组成异构服务器集群系统S可以用集合表示为S＝{s1，s2，s3，s4，......，sn}。本申请以CPU频率、磁盘I/O速率、内存大小、网络带宽四项基础性能指标作为服务器负载状态评估参数，不同的业务中各性能指标的影响权重不同， CPU频率、磁盘I/O速率，内存大小、网络带宽对服务器性能影响程度的权重分别用wcpu，wdisk，wstorage，wtape来表示，其中：wcpu+wdisk+wstorage+wtape＝1节点服务器si的初始性能指标CPU频率、磁盘I/O速率，内存大小、网络带宽分别用来表示。那么，服务器si的初始性能可表示为：考虑服务器性能指标的占有率无法客观反应服务器的真实负载能力，存在高性能服务器A性能指标占有率小于低性能服务器B的占有率，但服务器A请求响应时间仍小于服务器B的情况，该负载评价模型使用服务器当前负载率进行评估，节点si的实际负载量为：其中，各性能指标的实际性能等于初始性能与其在生产环境中占有率的乘积。那么，节点服务器si的总剩余负载能力为：si的剩余负载率为：如图3所示，预设的动态负载均衡方法，包括：计算预设反馈周期内目标服务器所有请求响应时间的平均值、方差以及偏离度，根据系统稳定运行时的第一个反馈周期内请求响应时间的平均值和方差的差值，得到平均响应时间最大值。其中，预设反馈周期的具体取值本申请实施例不做具体限定，可根据实际情况自行设定。理想情况下，各节点对请求的响应时间相同，当各节点对请求响应时间的离散程度越大，服务器节点当前性能衰减速度越快，本申请选取服务器对请求响应时间T的方差来量化响应时间的离散程度。为准确获取服务器负载状态同时降低频繁调整权重导致服务器性能降低，本评价模型以60s为一个反馈周期，服务器记录每次请求响应时间，在每周期结束时，计算周期内所有请求响应时间的平均值、方差及偏离度。其中，根据如下公式计算反馈周期内所有请求响应时间的平均值：根据如下公式计算反馈周期内所有请求响应时间的方差：根据如下公式计算反馈周期内所有请求响应时间的偏离度：根据如下公式计算请求响应时间偏离度在相邻两反馈周期的变化幅度：其中，变量说明如下表所示：在权重修正完成且系统运行稳定后的第一组请求响应发生在服务器性能最佳状态，故以该组请求时间的平均值、方差作为参考标准值，记录为当集群数量较多且存在高并发请求时，服务器对单个请求的响应时间符合正态分布，所以设每组数据的平均响应时间最大值Max为服务器当前负载情况可根据上述阈值描述如下表所示：进一步地，根据服务器所处的状态更新权重。当服务器处于状态1，表明该服务器已严重过载，服务器集群失衡严重，若不及时调整可能对服务器硬件造成损坏，需在下一周期任务调度过程中，将该服务器权重设置为0，不再给该服务器分配新任务。当服务器处于状态2时，服务器性能下降严重，需查看服务器各项性能指标的占有率，及时调整各性能指标的影响程度。具体地，若当前反馈周期内目标服务器所有请求响应时间的平均值小于平均响应时间最大值，且偏离度在相邻两反馈周期的变化幅度大于等于预设阈值，则更新目标服务器的各个性能指标的权重。计算服务器集群中所有服务器各个性能指标的当前占用率平均值；当目标服务器的目标性能指标的占用率大于等于对应的占用率平均值时，增大目标服务器的目标性能指标对应的权重；当目标服务器的目标性能指标的占用率小于对应的占用率平均值时，减小目标服务器的目标性能指标对应的权重。对于单个服务器，可通过服务器单个节点si各个性能指标的占用率Psi和服务器集群所有服务器各性能指标的当前占用率平均值来调整单个服务器节点中各性能指标的所占权重，其中下面以CPU频率为例阐述更新算法：当时，则认为服务器节点si的CPU频率对该服务器的影响增大，此时应提高其对应的权重值wcpu，反之则认为服务器节点si的CPU频率对该服务器的影响减小，此时应减小其对应的权重值wcpu，权重改变量为：为使得各性能指标权重合为1，将权重修正为：此时，该节点负载能力更新为：该节点权重更新为：若当前反馈周期内目标服务器所有请求响应时间的平均值大于等于平均响应时间最大值，则将目标服务器的节点权重设置为0。若当前反馈周期内目标服务器所有请求响应时间的平均值小于平均响应时间最大值，且偏离度在相邻两反馈周期的变化幅度小于预设阈值，则不更新目标服务器的权重。服务器集群还包括影院下载节点服务器，用于下载中转节点下发的影片，还包括文件存储服务器，作为整个中影院线影片存储服务器，用于接收、校验、存储影片，并负责向各个放映机分发影片和节目。本申请实施例从中影智慧影视项目中电影分发和客户数据回传的业务角度出发，探究各业务场景对服务器的性能要求，构建服务器集群系统，并提出基于服务器各项性能指标进行负载均衡的算法。该算法以60s为一个反馈周期，根据周期内所有请求响应时间的平均值和阈值的关系判断服务器负载状态，并按照各服务器剩余负载量对服务器节点权重进行修正。经过仿真实验验证，当请求并发量达2000条/秒时，该算法仍可实现单条请求时间小于10ms，实际并发请求连接数大于1400的效果，有效提升服务器集群整体资源利用率。本申请实施例提供的智慧影院系统还包括物联网模块，用于根据电子标签编码对系统中的各物联网设备进行编码寻址。在本申请的一些实施例中，物联网模块，包括：物联网单元，用于根据影院需求对影院设备进行电子标签编码，将电子标签编码按照预设的映射规则映射为IPV9可聚合全局单目地址，并直接路由到相应的服务器，从而完成对目标设备的寻址查询。其中，IPV9可聚合全局单目地址包含六个部分，各部分长度固定，依次为格式前缀、顶级聚合标识、保留域、二级聚合标识、站点级聚合标识以及网络接口标识。IPV9是以十进制数字码为基础，地址空间高达2^256位，采用先验证后通信零信任安全机制的未来网络体系架构，并且兼容目前物联网所有功能。IPV9采用TCP/IP/M三、四层混合架构，虚实电路混合，完成安全高速大码流传输，零信任安全机制，可直接路由，具有分布式解析延时低、地址多、通信费用极低等优点。如图4所示，是本申请实施例中的智慧影院组网拓扑图，在智慧影院子系统设计中，例如喜好捕捉子系统、温湿度采集子系统、身份校验子系统，数据上传具备周期性，各子系统具有复制性和可移动性，且各子系统之间及各子系统和影院服务器物理距离不大于100米。基于802.15.4物理层协议的Zigbee 可实现自组网、多点中继，能够很好的满足影城内部组网的需求，因此本系统在影院系统感知层数据接入部分使用Zigbee组网。在整个院线系统中，数据传输内容以电影文件、整个城市客户数据为主。数据传输过程具有高码流、大带宽传输、多层次寻址的特征。因此本系统在各影院之间、城际服务器通信的数据接入部分使用未来网络组网。基于IPV9的未来网络具备2048位地址、42层寻址模型，可实现即时增加可寻址节点的数量、简化地址自动配置过程、降低通信费用、提高传输安全等需求。进一步地，未来网络为智慧影院物联网提供了新的命名和寻址方案，因未来网络的数字域名可以作为IP地址直接使用的特点，在智慧影院系统中将根据基于未来网络的电子标签编码体系对系统中各设备进行编码、寻址。电子标签编码，对应于未来网络的数字域名和IP地址，可实现设备可寻址、可通信的功能。DPC编码由八部分组成，其标准格式如图5所示，图中各字段的具体含义如下：码段0：该码段长度为十进制格式下两位，表示后续码段的组成和长度。 00代表十进制长度为256位。码段1：该码段长度为十进制格式下1-4位，表示国家码和地区码。码段2：该码段位长度为十进制格式下6位，表示某一国家的行政区码。码段3：该码段长度为十进制格式下4位，表示使用该编码方式的设备管理主题信息。码段4：该码段长度为十进制格式下14位，用于表示硬件制造商信息。码段5：该码段长度为十进制格式下20位，用于标识硬件商品信息。码段6：该码段长度为十进制格式下8-207位，8位用于标识该硬件本身的年代信息，最长199位用于标识商品单元的信息。DPC编码通过“-”将各码段连接成256位编码，在智慧影院按照定位编码以及影院需求对影院编码的设计方案如下表所示：以影厅放映机为例，如图6所示，是放映机信息编码图。位于中国海淀区万达影城编号23的影厅放映机的完整编码为：00-156-110108-425-001-003-20210617-00040023。通过上述编码方法可实现设备寻址查询，DPC编码应其独一无二的特性可作为网络中的唯一标识，实现产品编码、数字域名、未来网络地址的统一。设备的编码方式根据相应的映射关系映射为未来网络八段式地址保存在服务器中以便寻址。具体的映射关系图7所示。该映射过程由IPV9路由器来完成，将电子标签编码按照图中映射规则映射为IPV9全局单目地址，并直接路由到相应的服务器，即可完成某设备的寻址查询过程。还包括数据库单元，用于进行数据存储和分析，得到管理员信息表、影院流量监控表、观众喜好捕捉记录表、影厅进出信息记录表、影厅温度记录表、下载服务器影片传输进度信息表以及设备故障信息表。数据库将现实生活中的概念模型抽象化，通过表格的方式将多个数据项与主键的关系以表格的方式展示出来。使用的数据库中的关键信息表设计如下：管理员信息表，管理员信息表负责存储注册智慧影院管理平台的所有管理员的信息数据，方便对不同的管理员进行管理，如下表所示：影院流量监控表负责存储每半小时内影厅进入、出去、滞留人数，如下表所示。观众喜好捕捉记录表负责存储在观众某广告屏前驻足时间和对应广告内容，如下表所示：影厅进出信息记录表负责存储影厅进入人员信息，如下表所示：影厅温度记录表负责存储每两小时影厅的温度，如下表所示：下载服务器影片传输进度信息表负责存储下载服务器中影片接收进度、校验结果及派发进度，其中status记录下载服务器当前状态，0为非工作状态，1 为接受影片状态，2为派发影片状态，CheckResult为系统自动校验结果。如下表所示：设备故障表负责存储系统运行中发生故障的信息、解决方案等，其中status 记录设备当前状态，0为故障状态，1为维修中，2为已修复。FailureRanking 为故障等级，具体可参考下表所示：还包括前端界面单元，用于提供用户注册、用户登录、权限管理基础功能，用于对终端采集的数据进行模块化展示，并根据数据库中的数据进行实时更新，还用于实现系统内部组件间通信。随着影院智能化设备增加、智慧化业务增加，不同模块之间的信息交互也日益频繁，由于这种通信需求，本申请基于redux状态容器实现可预测的状态管理，高效便捷的实现页面数据的存储和刷新，并支持平台各个数据接口的统一调用。包括基础功能模块，该模块实现了认证登录、权限控制、用户注册等完善的基础功能。登录认证是前端应用中必不可少的基础性功能，该系统基于Token 登录认证流程并集成常见的验证码功能验证用户身份，若系统验证通过则跳转至系统首页，若用户未注册可点击注册按钮进入注册页面，注册成功后跳转进入个人信息页进行信息补全。包括组件功能模块，智慧影院系统在首页向管理员提供直观的影院数据展示，基于Echarts图表对终端系统中采集的数据进行模块化展示，并根据数据库中的数据进行实时更新，点击图标可实现数据内容拓展显示。例如，展示影院流量检测系统近三个月的数据，纵轴为流量数量，横轴为时间，折线趋势为每天流量变化，鼠标指向折线上任意一点时，可现实当天不同时间段的流量数量。展示票房监管系统所检测到的当日不同影院实际上座总数。展示影院观众喜好捕捉系统的结果，可以看出观众对于预售片的预告片更感兴趣，停留时间更长，关注人数更多，影院运营过程中可以加大对预售片的宣传吸引观众。包括通信功能模块，通信功能模块主要实现了系统内部组件间通信，包含了父子组件传值、兄弟组件传值、API接口的设计与实现与服务器交互的设计实现，Mock数据的引入。在本次前端页面开发过程中，有大量重复的方法、类、函数，为减少代码重复、促进模块化、提升代码可优化性，本次开发按照接口的设计规范对常用函数、类、方法、全局函数、数据类型、枚举类型和常量等进行继承封装。React中是单向数据流，数据只能从父组件通过属性的方式传给其子组件。父组件向子组件传值，通过props，将父组件的state传递给了子组件。子组件通过调用父组件传递到子组件的方法向父组件传递消息的，兄弟组件之间的传值，是通过父组件做的中转，流程为：组件A–传值--＞父组件–传值--＞ 组件B。这项工作在组件传值频率高数据量大的情况下会产生很多差错，因此本次开发使用Redux——一个面向JavaScript应用的可预测状态容器。整个应用的state被储存在一棵object tree中，并且这个object tree只存在于唯一一个store中。其主要优势是处理应用的共享状态。如果两个组件需要访问同一状态，即“数据共享状态”。只需要两个组件读取同一数据源store，store 中的数据为只读数据，唯一改变state的方法就是触发action，action是一个用于描述已发生事件的普通对象，通过调用reducer纯函数，接收先前的 state和action，并返回新的state。一个state修改后所有读取该state的变量值都将修改。本申请实施例提供的智慧影院系统主要利用未来网络作为网络支撑，利用寻址技术及动态负载均衡等方法提出基于未来网络的智慧影院系统设计方案。主要实现传输自动校验、智能排片、观众喜好捕捉、自动检票、影厅恒温、设备自检等功能。推动了影院在智能化、信息化、自动化方面的进步，对影视行业的发展及功能拓展提供技术支持和保障，提升了影院观众的用户粘度。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上实施例仅表达了本发明的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对本发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。因此，本发明专利的保护范围应以所附权利要求为准。
