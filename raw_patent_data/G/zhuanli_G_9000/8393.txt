标题title
用于园区火灾预警的人工智能明火探测方法及系统
摘要abst
本发明提供一种用于园区火灾预警的人工智能明火探测方法及系统，属于人工智能探测技术领域。该方法包括：园区环控监测模型获取视频图像；获取当前帧视频图像与参考帧视频图像之间的差分图像；统计差分图像中各个像素点的像素值的分布情况；若分布情况满足预设条件，则根据差分图像中的像素点的像素值确定判断阈值；从差分图像中确定出第一图像区域；根据第一图像区域在差分图像中的位置，确定当前帧视频图像中的第二图像区域；利用人工智能模型对第二图像区域进行明火识别。通过设计的园区环控监测模型，对环境管理状态进行监测，预测可燃情况。本发明能够提高人工智能明火探测的效率和效益，寻找到园区能控及环保漏洞，提高碳中和综合管理能力。
权利要求书clms
1.一种用于园区火灾预警的人工智能明火探测方法，其特征在于，包括以下步骤：获取园区内安装的图像采集装置采集到的视频图像；获取当前帧视频图像与参考帧视频图像之间的差分图像；参考帧视频图像为所述图像采集装置之前采集的视频帧图像；统计所述差分图像中各个像素点的像素值的分布情况；若所述分布情况满足预设条件，则根据所述差分图像中的像素点的像素值确定判断阈值；从所述差分图像中确定出第一图像区域，所述第一图像区域中包括所述差分图像中像素值大于所述判断阈值的全部像素点；根据所述第一图像区域在所述差分图像中的位置，确定所述当前帧视频图像中的第二图像区域；将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别。2.根据权利要求1所述的方法，其特征在于，所述预设条件为第一像素值和第二像素值之间的差值大于预设阈值，所述第一像素值为所述差分图像中各个像素点的像素值中的第三像素值的均值或中位值，所述第二像素值为所述差分图像中各个像素点的像素值中的第四像素值的均值或中位值，所述第三像素值为所述差分图像中各个像素点的像素值中最大的N个像素值，所述第四像素值为所述差分图像中各个像素点的像素值中最小的K个像素值，N、K为预设正整数或者按照所述差分图像中全部像素值的预设比例确定。3.根据权利要求2所述的方法，其特征在于，所述根据所述差分图像中的像素点的像素值确定判断阈值，包括：根据所述第一像素值和所述第二像素值确定所述判断阈值。4.根据权利要求1所述的方法，其特征在于，所述统计所述差分图像中各个像素点的像素值的分布情况之后，还包括：若所述分布情况不满足所述预设条件，则将所述参考帧视频图像更新为所述当前帧视频图像；若所述分布情况满足所述预设条件，则所述参考帧视频图像继续作为参考帧视频图像。5.根据权利要求1所述的方法，其特征在于，所述将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别，包括：分别从所述第二图像区域中提取多个方面的特征信息，所述多个方面的特征信息包括光谱特征信息、形状特征信息和纹理特征信息；针对所述多个方面的特征信息，分别与对应的、预先训练好的特征偏移矩阵进行运算；将经过运算后的所述多个方面的特征信息进行级联，得到级联的特征信息；利用概率标准化算法对所述级联的特征信息进行归一化处理，得到归一化的特征信息；利用差分运算对所述归一化的特征信息进行进一步特征提取，并去除冗余的特征信息，得到深层次特征信息；利用主成分分析算法对所述深层次特征信息进行处理，得到用于输入至人工智能模型进行明火识别的信息。6.根据权利要求5所述的方法，其特征在于，所述分别从所述第二图像区域中提取多个方面的特征信息，包括：利用预设大小的滑动窗口按照先列后行的顺序遍历所述第二图像区域，并计算每次滑动时滑动窗口内的图像区域的熵；其中，当前次滑动时滑动窗口内的图像区域的熵为上一次滑动时滑动窗口内的图像区域的灰度直方图减去第一行像素点的灰度值概率并加上当前次滑动时滑动窗口内的图像区域中最后一行像素点的灰度值概率；根据每次滑动时滑动窗口内的图像区域的熵，获取所述第二图像区域的纹理图像；从所述纹理图像中提取所述纹理特征信息。7.根据权利要求5所述的方法，其特征在于，所述分别从所述第二图像区域中提取多个方面的特征信息，还包括：使用VGG神经网络，提取所述第二图像区域的特征信息；采用自顶向下的方法构造特征金字塔，对具有强语义特征的深层特征图采用双线性插值的方式进行上采样，使其与下一层特征图的大小保持一致，并利用空洞卷积对上采样后的深层特征图进行特征提取之后与下一层特征图相加获得一新的特征图，并将获得的每一个新的特征图继续以同样的方式与下一层特征图相加，最后获得融合了浅层特征图和深层特征图的深度异构特征图作为其中一个方面的特征信息。8.根据权利要求1所述的方法，其特征在于，所述人工智能模型包括多层神经网络，所述多层神经网络f按照以下公式进行合成得到：其中，m＝1,2,3,…,M,gm为第m个神经网络，am为第m个神经网络的权重。9.根据权利要求8所述的方法，其特征在于，所述将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别之前，还包括：分别构建多个所述神经网络；针对多个所述神经网络，分别利用预先设置的训练样本进行训练；利用所述预先设置的训练样本训练所述人工智能模型中的权重am；其中，训练时所述权重am是按照以下公式进行迭代更新：其中，am、am分别表示第t+1、t次迭代更新后的所述权重am，E为第t次迭代更新时所述人工智能模型中的识别误差，bt是根据前t次迭代更新中所述人工智能模型中的最小识别误差确定的参数值,cl为第l个样本的权重值，是构建所述训练样本时人工标注的值，ol、yl为第l个样本的目标输出值、实际输出值。10.一种用于园区火灾预警的人工智能明火探测系统，其特征在于，包括：一个或多个处理器；存储装置，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现如权利要求1-9中任一所述的用于园区火灾预警的人工智能明火探测方法。
说明书desc
技术领域本发明涉及人工智能探测技术领域，具体涉及一种用于园区火灾预警的人工智能明火探测方法及系统。背景技术随着各个行业的快速发展，出现了各种工业园区，园区化已经成为重要的发展趋势。火灾预警是园区安全的重要内容之一是园区内企业安全生产的重要保障环节。目前，火灾安全预警主要有人工巡检和传感器识别报警两种方式。通常园区面积较大，火灾隐患较多且较为分散，采用人工巡检，对巡检人员的自身素质要求较高，当人在疲劳状态下容易做出错误判断，导致检查不到位或者遗漏安全隐患，同时巡检效率较低。传感器识别报警包括烟雾传感器识别报警和图像传感器识别报警等。对于烟雾传感器识别报警方式需要在烟雾报警器位置处存在一定浓度的烟雾才能触发报警，这对烟雾报警器的安装位置和密度有一定的要求，安装成本高，而且即使是密集安装，在烟雾较小或受风向影响的情况下，依然不能及时触发报警。图像传感器识别报警方式，由于图像信息量大，且需要实时处理才能实现及时报警，因此计算量大，对处理器的要求高，另外采集的图像受外界光照变化影响大，影响识别精度。发明内容因此，本发明实施例要解决的技术问题在于克服现有技术中的通过图像传感器识别火灾来进行火灾报警方式处理量大且识别精度受外界光照变化影响的缺陷，从而提供一种用于园区火灾预警的人工智能明火探测方法及系统。为此，本发明提供一种用于园区火灾预警的人工智能明火探测方法，包括以下步骤：获取园区内安装的图像采集装置采集到的视频图像；获取当前帧视频图像与参考帧视频图像之间的差分图像；参考帧视频图像为所述图像采集装置之前采集的视频帧图像；统计所述差分图像中各个像素点的像素值的分布情况；若所述分布情况满足预设条件，则根据所述差分图像中的像素点的像素值确定判断阈值；从所述差分图像中确定出第一图像区域，所述第一图像区域中包括所述差分图像中像素值大于所述判断阈值的全部像素点；根据所述第一图像区域在所述差分图像中的位置，确定所述当前帧视频图像中的第二图像区域；将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别。可选的，所述预设条件为第一像素值和第二像素值之间的差值大于预设阈值，所述第一像素值为所述差分图像中各个像素点的像素值中的第三像素值的均值或中位值，所述第二像素值为所述差分图像中各个像素点的像素值中的第四像素值的均值或中位值，所述第三像素值为所述差分图像中各个像素点的像素值中最大的N个像素值，所述第四像素值为所述差分图像中各个像素点的像素值中最小的K个像素值，N、K为预设正整数或者按照所述差分图像中全部像素值的预设比例确定。可选的，所述根据所述差分图像中的像素点的像素值确定判断阈值，包括：根据所述第一像素值和所述第二像素值确定所述判断阈值。可选的，所述统计所述差分图像中各个像素点的像素值的分布情况之后，还包括：若所述分布情况不满足所述预设条件，则将所述参考帧视频图像更新为所述当前帧视频图像；若所述分布情况满足所述预设条件，则所述参考帧视频图像继续作为参考帧视频图像。可选的，所述将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别，包括：分别从所述第二图像区域中提取多个方面的特征信息，所述多个方面的特征信息包括光谱特征信息、形状特征信息和纹理特征信息；针对所述多个方面的特征信息，分别与对应的、预先训练好的特征偏移矩阵进行运算；将经过运算后的所述多个方面的特征信息进行级联，得到级联的特征信息；利用概率标准化算法对所述级联的特征信息进行归一化处理，得到归一化的特征信息；利用差分运算对所述归一化的特征信息进行进一步特征提取，并去除冗余的特征信息，得到深层次特征信息；利用主成分分析算法对所述深层次特征信息进行处理，得到用于输入至人工智能模型进行明火识别的信息。可选的，所述分别从所述第二图像区域中提取多个方面的特征信息，包括：利用预设大小的滑动窗口按照先列后行的顺序遍历所述第二图像区域，并计算每次滑动时滑动窗口内的图像区域的熵；其中，当前次滑动时滑动窗口内的图像区域的熵为上一次滑动时滑动窗口内的图像区域的灰度直方图减去第一行像素点的灰度值概率并加上当前次滑动时滑动窗口内的图像区域中最后一行像素点的灰度值概率；根据每次滑动时滑动窗口内的图像区域的熵，获取所述第二图像区域的纹理图像；从所述纹理图像中提取所述纹理特征信息。可选的，所述分别从所述第二图像区域中提取多个方面的特征信息，还包括：使用VGG神经网络，提取所述第二图像区域的特征信息；采用自顶向下的方法构造特征金字塔，对具有强语义特征的深层特征图采用双线性插值的方式进行上采样，使其与下一层特征图的大小保持一致，并利用空洞卷积对上采样后的深层特征图进行特征提取之后与下一层特征图相加获得一新的特征图，并将获得的每一个新的特征图继续以同样的方式与下一层特征图相加，最后获得融合了浅层特征图和深层特征图的深度异构特征图作为其中一个方面的特征信息。可选的，所述人工智能模型包括多层神经网络，所述多层神经网络f按照以下公式进行合成得到：其中，m＝1,2,3,…,M,gm为第m个神经网络，am为第m个神经网络的权重。可选的，所述将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别之前，还包括：分别构建多个所述神经网络；针对多个所述神经网络，分别利用预先设置的训练样本进行训练；利用所述预先设置的训练样本训练所述人工智能模型中的权重am；其中，训练时所述权重am是按照以下公式进行迭代更新：其中，am、am分别表示第t+1、t次迭代更新后的所述权重am，E为第t次迭代更新时所述人工智能模型中的识别误差，bt是根据前t次迭代更新中所述人工智能模型中的最小识别误差确定的参数值,cl为第l个样本的权重值，是构建所述训练样本时人工标注的值，ol、yl为第l个样本的目标输出值、实际输出值。本发明还提供一种用于园区火灾预警的人工智能明火探测系统，包括：一个或多个处理器；存储装置，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现上述的任一种用于园区火灾预警的人工智能明火探测方法。本发明实施例的技术方案，具有如下优点：本发明实施例提供的用于园区火灾预警的人工智能明火探测方法及系统，先通过先后采集的视频帧图像之间的差分图像对图像变化进行检测，然后在利用人工智能模型对视频帧图像中发生变化的区域进行明火检测，与直接利用人工智能模型对采集的视频图像进行明火检测相比，既降低了人工智能明火检测的处理量，且可以避免间隔检测导致明火检测不及时的问题。另外，由于人工智能模型只针对视频图像中的变化区域进行检测，还可以提高明火检测的精度，降低误报的概率。另外，本发明实施例中，根据先后采集的视频帧图像之间的差分图像像素点的像素值分布情况确定用于判断变化区域的判断阈值，可以降低变化区域的判断受外界光照变化等因素的影响，提高变化区域判断的准确度。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例1中用于园区火灾预警的人工智能明火探测方法的一个具体示例的流程图；图2为本发明实施例1中用于进行明火识别的特征提取方法的一个具体示例的流程图；图3为本发明实施例1中用于进行明火识别的特征提取方法的另一个具体示例的流程图；图4为本发明实施例2中用于园区火灾预警的人工智能明火探测系统的一个具体示例的原理框图。具体实施方式下面将结合附图对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要说明的是，本文所用的术语仅用于描述特定实施例的目的，而并非旨在限制本发明。除非上下文明确指出，否则如本文中所使用的单数形式“一”、“一个”和“该”等意图也包括复数形式。使用“包括”和/或“包含”等术语时，是意图说明存在该特征、整数、步骤、操作、元素和/或组件，而不排除一个或多个其他特征、整数、步骤、操作、元素、组件、和/或其他组合的存在或增加。术语“和/或”包括一个或多个相关列出项目的任何和所有组合。术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。术语“第一”、“第二”、“第三”仅用于描述目的，而不能理解为指示或暗示相对重要性。术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，还可以是两个元件内部的连通；可以是无线连接，也可以是有线连接。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。此外，下面所描述的本发明不同实施方式中所涉及的技术特征只要彼此之间未构成冲突就可以相互结合。实施例1本实施例提供一种用于园区火灾预警的人工智能明火探测方法，如图1所示，包括以下步骤：S1：获取园区内安装的图像采集装置采集到的视频图像；S2：获取当前帧视频图像与参考帧视频图像之间的差分图像；参考帧视频图像为所述图像采集装置之前采集的视频帧图像；S3：统计所述差分图像中各个像素点的像素值的分布情况；S4：若所述分布情况满足预设条件，则根据所述差分图像中的像素点的像素值确定判断阈值；若所述分布情况满足不预设条件，则不对当前帧视频图像作进一步的明火识别。S5：从所述差分图像中确定出第一图像区域，所述第一图像区域中包括所述差分图像中像素值大于所述判断阈值的全部像素点；S6：根据所述第一图像区域在所述差分图像中的位置，确定所述当前帧视频图像中的第二图像区域；S7：将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别。本发明实施例提供的用于园区火灾预警的人工智能明火探测方法可以由园区环控监测模型实现，即上述步骤可由园区环控监测模型执行。本发明实施例中，先通过先后采集的视频帧图像之间的差分图像对图像变化进行检测，然后在利用人工智能模型对视频帧图像中发生变化的区域进行明火检测，与直接利用人工智能模型对采集的视频图像进行明火检测相比，既降低了人工智能明火检测的处理量，且可以避免间隔检测导致明火检测不及时的问题。另外，由于人工智能模型只针对视频图像中的变化区域进行检测，还可以提高明火检测的精度，降低误报的概率。另外，本发明实施例中，根据先后采集的视频帧图像之间的差分图像像素点的像素值分布情况确定用于判断变化区域的判断阈值，可以降低变化区域的判断受外界光照变化等因素的影响，提高变化区域判断的准确度。本发明实施例通过设计的园区环控监测模型，对环境管理状态进行监测，预测可燃情况，能够寻找到园区能控及环保漏洞，提高碳中和综合管理能力。可选的，所述预设条件为第一像素值和第二像素值之间的差值大于预设阈值，所述第一像素值为所述差分图像中各个像素点的像素值中的第三像素值的均值或中位值，所述第二像素值为所述差分图像中各个像素点的像素值中的第四像素值的均值或中位值，所述第三像素值为所述差分图像中各个像素点的像素值中最大的N个像素值，所述第四像素值为所述差分图像中各个像素点的像素值中最小的K个像素值，N、K为预设正整数或者按照所述差分图像中全部像素值的预设比例确定。本发明实施例中，根据先后采集的视频帧图像之间的差分图像的像素值情况确定是否需要进一步进行明火识别，判断准确度高。可选的，所述根据所述差分图像中的像素点的像素值确定判断阈值，包括：根据所述第一像素值和所述第二像素值确定所述判断阈值。具体的，可以取所述第一像素值和所述第二像素值的平均值为所述判断阈值。本发明实施例中，根据先后采集的视频帧图像之间的差分图像的像素值情况确定需要进一步进行明火识别的图像区域，判断准确度高。可选的，所述统计所述差分图像中各个像素点的像素值的分布情况之后，还包括：若所述分布情况不满足所述预设条件，则将所述参考帧视频图像更新为所述当前帧视频图像；若所述分布情况满足所述预设条件，则所述参考帧视频图像继续作为参考帧视频图像。本发明实施例中，根据视频帧图像之间的差分图像的像素值情况更新参考帧视频图像，使得后续的判断和识别更加准确。可选的，如图2所示，所述将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别，即步骤S7，包括：S71：分别从所述第二图像区域中提取多个方面的特征信息，所述多个方面的特征信息包括光谱特征信息、形状特征信息和纹理特征信息；S72：针对所述多个方面的特征信息，分别与对应的、预先训练好的特征偏移矩阵进行运算；S73：将经过运算后的所述多个方面的特征信息进行级联，得到级联的特征信息；S74：利用概率标准化算法对所述级联的特征信息进行归一化处理，得到归一化的特征信息；S75：利用差分运算对所述归一化的特征信息进行进一步特征提取，并去除冗余的特征信息，得到深层次特征信息；S76：利用主成分分析算法对所述深层次特征信息进行处理，得到用于输入至人工智能模型进行明火识别的信息。本发明实施例中，通过提取待识别图像区域多个方面的特征来进行明火识别，可以进一步提升识别的准确度，避免误判和漏判。进一步可选的，所述分别从所述第二图像区域中提取多个方面的特征信息，包括：利用预设大小的滑动窗口按照先列后行的顺序遍历所述第二图像区域，并计算每次滑动时滑动窗口内的图像区域的熵；其中，当前次滑动时滑动窗口内的图像区域的熵为上一次滑动时滑动窗口内的图像区域的灰度直方图减去第一行像素点的灰度值概率并加上当前次滑动时滑动窗口内的图像区域中最后一行像素点的灰度值概率；根据每次滑动时滑动窗口内的图像区域的熵，获取所述第二图像区域的纹理图像；从所述纹理图像中提取所述纹理特征信息。其他可选的具体实施方式中，可以利用多个不同的分类器分别从所述第二图像区域中提取多个方面的特征信息。可选的，所述利用主成分分析算法对所述深层次特征信息进行处理，得到用于输入至人工智能模型进行明火识别的信息，包括：对所述深层次特征信息中的每两个特征信息求协方差，构造协方差矩阵；获取所述协方差矩阵对应的特征值和特征向量；选取N个最大特征值对应的特征向量；将所述深层次特征信息投影到选取的N个特征向量上，完成对所述深层次特征信息的处理，N为大于1的整数。可选的，如图3所示，所述分别从所述第二图像区域中提取多个方面的特征信息，即步骤S71，还包括：S711：使用VGG神经网络，提取所述第二图像区域的特征信息；S712：采用自顶向下的方法构造特征金字塔，对具有强语义特征的深层特征图采用双线性插值的方式进行上采样，使其与下一层特征图的大小保持一致，并利用空洞卷积对上采样后的深层特征图进行特征提取之后与下一层特征图相加获得一新的特征图，并将获得的每一个新的特征图继续以同样的方式与下一层特征图相加，最后获得融合了浅层特征图和深层特征图的深度异构特征图作为其中一个方面的特征信息。可选的，所述人工智能模型包括多层神经网络，所述多层神经网络f按照以下公式进行合成得到：其中，m＝1,2,3,…,M,gm为第m个神经网络，am为第m个神经网络的权重。可选的，所述将根据所述第二图像区域得到的信息输入至人工智能模型进行明火识别之前，还包括：分别构建多个所述神经网络；针对多个所述神经网络，分别利用预先设置的训练样本进行训练；利用所述预先设置的训练样本训练所述人工智能模型中的权重am；其中，训练时所述权重am是按照以下公式进行迭代更新：其中，am、am分别表示第t+1、t次迭代更新后的所述权重am，E为第t次迭代更新时所述人工智能模型中的识别误差，bt是根据前t次迭代更新中所述人工智能模型中的最小识别误差确定的参数值,cl为第l个样本的权重值，是构建所述训练样本时人工标注的值，ol、yl为第l个样本的目标输出值、实际输出值。实施例2本实施例提供一种用于园区火灾预警的人工智能明火探测系统40，如图4所示，包括：一个或多个处理器401；存储装置402，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器401执行时，使得所述一个或多个处理器401实现上述的任一种用于园区火灾预警的人工智能明火探测方法。上述程序可以称为园区环控监测模型。本发明实施例提供的用于园区火灾预警的人工智能明火探测系统，先通过先后采集的视频帧图像之间的差分图像对图像变化进行检测，然后在利用人工智能模型对视频帧图像中发生变化的区域进行明火检测，与直接利用人工智能模型对采集的视频图像进行明火检测相比，既降低了人工智能明火检测的处理量，且可以避免间隔检测导致明火检测不及时的问题。另外，由于人工智能模型只针对视频图像中的变化区域进行检测，还可以提高明火检测的精度，降低误报的概率。另外，本发明实施例中，根据先后采集的视频帧图像之间的差分图像像素点的像素值分布情况确定用于判断变化区域的判断阈值，可以降低变化区域的判断受外界光照变化等因素的影响，提高变化区域判断的准确度。显然，上述实施例仅仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引伸出的显而易见的变化或变动仍处于本发明创造的保护范围之中。
