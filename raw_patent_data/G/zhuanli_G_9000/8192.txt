标题title
一种混合DNA图谱的分析方法
摘要abst
本发明提供了一种混合DNA图谱的分析方法，属于法医遗传学和法医物证学技术领域。本发明读取毛细管电泳产生的一代DNA STR图谱数据和相关参数；利用图谱数据和相关参数生成各个基因座的候选基因型集合；利用图谱数据和相关参数确定预设样本参数的先验分布的采样区间；根据确定的预设样本参数的先验分布的采样区间，使用MCMC算法对所述候选基因型集合和样本参数的后验分布进行采样；利用采样得到的候选基因型集合和样本参数的后验分布，统计预设的相关指标，进行混合DNA图谱分析，得到多种分析结果。本发明可以分析一代DNA STR图谱数据，使得图谱分析更客观，同时拆分所有输入的基因座，拆分准确率高。
权利要求书clms
1.一种混合DNA图谱的分析方法，其特征在于，包括如下步骤：读取毛细管电泳产生的一代混合DNA STR图谱数据，获取相关参数；所述的图谱数据包括由同一份DNA分成的多个小份DNA分别进行毛细管电泳得到多个STR电泳图谱数据，每个图谱数据称为一个重复样本；利用一代DNA STR图谱数据和相关参数，确定各个基因座的真峰集合，以真峰集合为基础生成各个基因座的候选基因型集合；所述真峰集合为个体真实的基因型产生的峰的集合；利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验分布的采样区间和分布函数；使用MCMC算法和相关参数对所述候选基因型集合和样本参数的联合后验分布进行采样；利用采样得到的候选基因型集合和样本参数的后验分布采样点，进行统计分析，得到统计分析结果。2.根据权利要求1所述的混合DNA图谱的分析方法，其特征在于，所述相关参数包括：影峰阈值参数；试剂盒相关的分析参数，具体包括基因座名称、基因座长度和基因座影峰率；MCMC算法相关参数，具体包括线程数、MCMC的采样链数、预烧期次数、采样接受次数和随机数种子。3.根据权利要求2所述的混合DNA图谱的分析方法，其特征在于，所述生成各个基因座的候选基因型集合包括如下步骤：S1：指定一个基因座，在一个重复样本中的指定基因座处生成一个候选基因型集合；S2：在每个重复样本中，重复步骤S1，得到所有重复样本在指定基因座的候选基因型集合；S3：对所有重复样本的候选基因型集合取并集，得到指定基因座的候选基因型集合；S4：对图谱数据的各个基因座重复步骤S1-S3，得到各个基因座的候选基因型集合。4.根据权利要求3所述的混合DNA图谱的分析方法，其特征在于，指定一个基因座，在一个重复样本中的指定基因座处生成候选基因型集合具体包括如下步骤：S10：读取混合人数N，确定候选基因型的长度为2N；S11：对一个重复样本中的指定基因座内的所有峰，逐个使用下面的原则进行筛选，得到真峰集合：如果当前峰的前向影峰位置存在峰，且当前峰与前向影峰位置峰的峰高比值小于第一影峰阈值，删除当前峰；如果当前峰的后向影峰位置存在峰，且当前峰与后向影峰位置峰的峰高比值小于第二影峰阈值，删除当前峰；筛选后保留得到的峰集合为真峰集合；S12：如果获得的真峰集合内真峰个数为2N个，无序候选基因型集合为2N个真峰对应的等位基因的集合；如果获得的真峰数量超过2N个，则按照各峰的高度排序，取前2N个真峰，无序候选基因型集合为2N个峰对应的等位基因的集合；如果获得的真峰数量少于2N，则在真峰集合对应等位基因集合的基础上，以基因座内所有的峰对应的等位基因以放回抽样的方式补齐2N个等位基因，获得多个无序候选基因型集合；S13：对无序的候选基因型按照两个一组进行分割排列，得到有序的候选基因型集合。5.根据权利要求3或4任一项所述的混合DNA图谱的分析方法，其特征在于，所述利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验的采样区间和分布函数，预设样本参数及采样区间和分布函数包括：模板量M、降解水平G、基因座特异性扩增效率K和重复样本扩增效率F以及各参数对应的采样区间和分布函数。6.根据权利要求5所述的混合DNA图谱的分析方法，其特征在于，所述利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验的采样区间和分布函数，包括如下步骤：S100：获得一个重复样本中的最高峰的峰高max_height；计算一个重复样本中的各个基因座的总峰高；计算各个重复样本的总峰高；S200：确定预设样本参数的先验分布的采样区间具体为：M＝，为N个贡献者的DNA模板量向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；G＝，为N个贡献者DNA的降解水平向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；K＝，为L个基因座的特异性扩增效率向量；其中，各基因座的总峰高最高的基因座的值固定为1，该向量中其余分量的采样区间，由下列规则决定：计算各基因座总峰高与各基因座的总峰高最高的基因座的总峰高的比值，基因座分量的采样区间为以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布；F＝，为C个重复样本的重复样本扩增效率向量；其中向量的第一个分量固定为1；其余分量的采样区间，由下列规则决定：计算该重复样本的总峰高与第一个重复样本数据的各个基因座的总峰高的比值，以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布。7.根据权利要求5所述的混合DNA图谱的分析方法，其特征在于，所述使用MCMC算法和相关参数对所述候选基因型集合和样本参数的后验分布进行采样包括：通过贝叶斯公式给出候选基因型集合和各个样本参数的联合后验分布，并采用MCMC算法进行采样。8.根据权利要求7所述的混合DNA图谱的分析方法，其特征在于，所述候选基因型集合和各个样本参数的联合后验分布公式为：候选基因型集合的先验和样本参数M,G,K,F的先验Pr为均匀分布或正态分布；为似然函数，似然函数的计算公式为：其中，O表示输入的图谱数据；表示重复样本f中基因座l的等位基因a处的观测峰高；Sj表示第j个包含所有基因座的候选基因型；表示第j个包含所有基因座的候选基因型在基因座l的基因型；表示重复样本f中基因座l的等位基因a处的期望峰高，在给定样本参数和候选基因型集合的条件下由峰高模型生成。9.根据权利要求7所述的混合DNA图谱的分析方法，其特征在于，采样MCMC算法进行采样的具体步骤包括：S1000：采样初始化：在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型，组成第一个包含全部基因座的候选基因型S1；在样本参数的先验采样区间中按照先验分布挑选一个值，获得模板量向量M＝、降解水平向量G＝、特异性扩增效率向量K＝和重复样本扩增效率向量F＝的一个初始值；在获得候选基因型集合S1和样本参数初值后，获得在第一次迭代中后验分布函数的对数值iter：其中，iter为第一次迭代中后验分布函数的对数值；为第r个重复样本中基因座l内等位基因a的高度；为基因型集合S1中基因座l的基因型；S2000：进行采样，采样点接受标准如下：在进行第y次迭代时，假设上一次接受的采样点的后验函数函数的对数值是iter；在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型集合，组成一个包含全部基因座的候选基因型集合Sy，其中，Sy是随机采样得到的包含所有基因座分型中的第y个基因型集合；以上一次接受的采样点对应的样本参数为基础，以随机游走的方式抽取第y次迭代的样本参数；在获得候选基因型集合Sy和样本参数初值后，获得在第y次迭代中后验分布函数的对数值iter：在之间选取随机数u，如果iter—iter＞log，接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；如果iter—iter≤log，不接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；S3000：当接受的采样点达到预设采样预烧期次数和采样接受次数的和时，采样结束。10.根据权利要求9所述的混合DNA图谱的分析方法，其特征在于，所述进行统计分析，得到统计分析结果中具体统计分析结果为各个贡献者的占比、各个贡献者的降解水平、各个基因座的特异性扩增效率、各个重复样本的重复样本扩增效率和各个贡献者的单人STR分型，以及目标个体包含在混合DNA中的似然比的分析结果；具体统计分析方法包括如下步骤：舍弃前预烧期个采样点，保留后接受次数个采样点；计算M＝的采样点的平均值，得到各个贡献者模板量的估计值；计算G＝的采样点的平均值，得到各个贡献者降解水平的估计值；计算K＝的采样点的平均值，得到基因座特异性扩增效率的估计值；计算F＝的采样点的平均值，得到重复样本扩增效率的估计值；计算各个基因座处各个候选基因型集合的采样个数占接受次数的比值，得到候选基因型集合后验概率的估计；采用如下公式计算目标个体包含在混合DNA中的似然值：其中其中，L：基因座个数；Ol：基因座l的观测峰高；H1：假设混合样本中包含嫌疑人和N-1个随机个体；H2：假设混合样本中包含N个随机个体；包含嫌疑人和N-1个随机个体的集合Sj在基因座l的基因型；包含N个随机个体的集合Sj′在基因座l的基因型。
说明书desc
技术领域本发明涉及法医遗传学和法医物证学技术领域，尤其涉及一种混合DNA图谱的分析方法。背景技术DNA检验由于具有高度个体特异性和客观性，已成为公安机关侦查破案、司法系统定罪量刑的重要依据。当前法医DNA实验室的物证学中的DNA图谱分析主流技术是基于PCR-CE平台对DNA样本进行STR遗传标记检验，如果DNA样本中包含了两人或者两人以上的DNA，就会得到混合DNA图谱。近年来，随着法医DNA检测仪器、试剂等的不断更新和发展，DNA检测灵敏度越来越高，在案件现场检材中检出混合DNA的数量也越来越多，特别是在性犯罪案件中的混合体液斑、群死群伤案件中的混合血迹、受害人或嫌疑人身上咬痕拭子及指甲擦拭物等生物检材，检出混合DNA的比例高达40％～60％。在混合DNA图谱中，多个基因座内包含了三个及三个以上的峰，导致难以直接从中获得单人的DNA图谱，也就没有办法直接录入全国公安机关DNA数据库进行检索和比对，另一方面混合DNA图谱的检验结果也难以作为直接认定嫌疑人的证据。为了提高混合DNA样本的利用率，需要对混合DNA图谱进行分析，主要有两个技术问题需要解决：1.从混合DNA图谱中拆分出混合DNA各个贡献者单人的DNA图谱，这样就可以将单人的DNA图谱入库检索比对，为案件侦查提供线索；2.制订量化的指标，判断指定的嫌疑个体是否包含在混合DNA中，为后续法庭诉讼提供科学的量化依据。目前我国分析混合DNA图谱的主流技术是人工分析。人工分析主要依赖有经验的法医工作者对混合DNA图谱的肉眼观察：通过观察混合DNA图谱中各个基因座的峰数量来判断混合人数；通过在图谱中寻找容易拆分的基因座，判断混合比例；通过观察不同基因型集合的杂合平衡，比较不同基因型集合是真实基因型集合的可能。现有技术至少存在以下不足：1.人工分析需要有经验丰富的法医DNA专家，分析速度慢，耗费人力；2.人工分析主观性很强，不同法医学实验室、同一法医学实验室的不同法医工作者、同一法医工作者在不同的时间，对于同一个混合DNA样本有可能会拆分出不同的单人样本，也有可能对一个指定个体是否包含在混合DNA中做出不同的判断，这严重损害了DNA物证的客观性；3.人工分析只能分析一些简单的二人混合样本，无法分析复杂的二人及以上的多人混合样本；4.人工分析只能使用混合DNA图谱中的部分信息，拆分的效能有限，多数情况下只能拆分出几个基因座。5.人工拆分无法提供量化的指标，用于衡量图谱中是否包含嫌疑人的DNA的可能性，从而无法用于法庭科学作为物证。发明内容为解决现有技术中存在的技术问题，本发明提供了一种混合DNA图谱的分析方法，读取毛细管电泳产生的一代DNA STR图谱数据，获取相关参数；利用一代DNA STR图谱数据和相关参数生成各个基因座的候选基因型集合；利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验分布的采样区间；预设样本参数包括DNA模板量M、DNA的降解水平G、基因座的特异性扩增效率K和重复样本扩增效率F；根据确定的预设样本参数的先验分布的采样区间，使用MCMC算法对所述候选基因型集合和样本参数的后验分布进行采样；利用采样得到的候选基因型集合和样本参数的后验分布，统计预设的相关指标，进行混合DNA图谱分析，得到包括混合DNA图谱数据中各个贡献者的占比、各个贡献者的降解水平、各个基因座的特异性扩增效率、各个重复样本的重复样本扩增效率和各个贡献者的STR分型，以及目标个体包含在混合DNA中的似然比的分析结果。本发明可以自动化分析一代DNA STR图谱数据，使得图谱分析更客观，可以同时拆分所有输入的基因座，且拆分准确率高，可以计算目标个体包含在混合DNA中的似然比，为法庭判案提供可靠的证据。本发明提供了一种混合DNA图谱的分析方法，包括如下步骤：读取毛细管电泳产生的一代混合DNA STR图谱数据，获取相关参数；所述的图谱数据包括由同一份DNA分成的多个小份DNA分别进行毛细管电泳得到多个STR电泳图谱数据，每个图谱数据称为一个重复样本；利用一代DNA STR图谱数据，使用人工判断、最大等位基因数量法或极大似然估计法确定混合人数N；利用一代DNA STR图谱数据和相关参数，确定各个基因座的真峰集合，以真峰集合为基础生成各个基因座的候选基因型集合；所述真峰集合为个体真实的基因型产生的峰的集合；利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验分布的采样区间和分布函数；使用MCMC算法和相关参数对所述候选基因型集合和样本参数的联合后验分布进行采样；利用采样得到的候选基因型集合和样本参数的后验分布采样点，进行统计分析，得到统计分析结果。优选地，所述相关参数包括：影峰阈值参数；试剂盒相关的分析参数，具体包括基因座名称、基因座长度和基因座影峰率；MCMC算法相关参数，具体包括线程数、MCMC的采样链数、预烧期次数、采样接受次数和随机数种子。优选地，所述生成各个基因座的候选基因型集合包括如下步骤：S1：指定一个基因座，在一个重复样本中的指定基因座处生成一个候选基因型集合；S2：在每个重复样本中，重复步骤S1，得到所有重复样本在指定基因座的候选基因型集合；S3：对所有重复样本的候选基因型集合取并集，得到指定基因座的候选基因型集合；S4：对图谱数据的各个基因座重复步骤S1-S3，得到各个基因座的候选基因型集合。优选地，指定一个基因座，在一个重复样本中的指定基因座处生成候选基因型集合具体包括如下步骤：S10：读取混合人数N，确定候选基因型的长度为2N；S11：对一个重复样本中的指定基因座内的所有峰，逐个使用下面的原则进行筛选，得到真峰集合：如果当前峰的前向影峰位置存在峰，且当前峰与前向影峰位置峰的峰高比值小于第一影峰阈值，删除当前峰；如果当前峰的后向影峰位置存在峰，且当前峰与后向影峰位置峰的峰高比值小于第二影峰阈值，删除当前峰；筛选后保留得到的峰集合为真峰集合；S12：如果获得的真峰集合内真峰个数为2N个，无序候选基因型集合为2N个真峰对应的等位基因的集合；如果获得的真峰数量超过2N个，则按照各峰的高度排序，取前2N个真峰，无序候选基因型集合为2N个峰对应的等位基因的集合；如果获得的真峰数量少于2N，则在真峰集合对应等位基因集合的基础上，以基因座内所有的峰对应的等位基因以放回抽样的方式补齐2N个等位基因，获得多个无序候选基因型集合；S13：对无序的候选基因型按照两个一组进行分割排列，得到有序的候选基因型集合。优选地，所述利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验的采样区间和分布函数，预设样本参数及采样区间和分布函数包括：模板量M、降解水平G、基因座特异性扩增效率K和重复样本扩增效率F以及各参数对应的采样区间和分布函数。优选地，所述利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验的采样区间和分布函数；包括如下步骤：S100：获得一个重复样本中的最高峰的峰高max_height；计算一个重复样本中的各个基因座的总峰高；计算各个重复样本的总峰高；S200：确定预设样本参数的先验分布的采样区间具体为：M＝，为N个贡献者的DNA模板量向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；G＝，为N个贡献者DNA的降解水平向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；K＝，为L个基因座的特异性扩增效率向量；其中，各基因座的总峰高最高的基因座的值固定为1，该向量中其余分量的采样区间，由下列规则决定：计算各基因座总峰高与各基因座的总峰高最高的基因座的总峰高的比值，基因座分量的采样区间为以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布；F＝，为C个重复样本的重复样本扩增效率向量；其中向量的第一个分量固定为1；其余分量的采样区间，由下列规则决定：计算该重复样本的总峰高与第一个重复样本数据的各个基因座的总峰高的比值，以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布。优选地，所述使用MCMC算法和相关参数对所述候选基因型集合和样本参数的后验分布进行采样包括：通过贝叶斯公式给出候选基因型集合和各个样本参数的联合后验分布，并采用MCMC算法进行采样。优选地，所述候选基因型集合和各个样本参数的联合后验分布公式为：候选基因型集合的先验和样本参数M,G,K,F的先验Pr为均匀分布或正态分布；为似然函数，似然函数的计算公式为：其中，O表示输入的图谱数据；表示重复样本f中基因座l的等位基因a处的观测峰高；Sj表示第j个包含所有基因座的候选基因型；表示第j个包含所有基因座的候选基因型在基因座l的基因型；表示重复样本f中基因座l的等位基因a处的期望峰高，在给定样本参数和候选基因型集合的条件下由峰高模型生成。优选地，采样MCMC算法进行采样的具体步骤包括：S1000：采样初始化：在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型，组成第一个包含全部基因座的候选基因型S1；在样本参数的先验采样区间中按照先验分布挑选一个值，获得模板量向量M＝、降解水平向量G＝、特异性扩增效率向量K＝和重复样本扩增效率向量F＝的一个初始值；在获得候选基因型集合S1和样本参数初值后，获得在第一次迭代中后验分布函数的对数值iter：其中，iter为第一次迭代中后验分布函数的对数值；为第r个重复样本中基因座l内等位基因a的高度；为基因型集合S1中基因座l的基因型；S2000：进行采样，采样点接受标准如下：在进行第y次迭代时，假设上一次接受的采样点的后验函数函数的对数值是iter；在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型集合，组成一个包含全部基因座的候选基因型集合Sy，其中，Sy是随机采样得到的包含所有基因座分型中的第y个基因型集合；以上一次接受的采样点对应的样本参数为基础，以随机游走的方式抽取第y次迭代的样本参数；即本次参数采样的分布函数是以上次采样点为均值，标准差为σ的正态分布，对于每个预设样本参数M、G、K和F，方差σ不同。在获得候选基因型集合Sy和样本参数初值后，获得在第y次迭代中后验分布函数的对数值iter：在之间选取随机数u，如果iter—iter＞log，接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；如果iter—iter≤log，不接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；S3000：当接受的采样点达到预设采样预烧期次数和采样接受次数的和时，采样结束。优选地，所述进行统计分析，得到统计分析结果中具体统计分析结果为各个贡献者的占比、各个贡献者的降解水平、各个基因座的特异性扩增效率、各个重复样本的重复样本扩增效率和各个贡献者的单人STR分型，以及目标个体包含在混合DNA中的似然比的分析结果；具体统计分析方法包括如下步骤：舍弃前预烧期个采样点，保留后接受次数个采样点；计算M＝的采样点的平均值，得到各个贡献者模板量的估计值；计算G＝的采样点的平均值，得到各个贡献者降解水平的估计值；计算K＝的采样点的平均值，得到基因座特异性扩增效率的估计值；计算F＝的采样点的平均值，得到重复样本扩增效率的估计值；计算各个基因座处各个候选基因型集合的采样个数占接受次数的比值，得到候选基因型集合后验概率的估计；采用如下公式计算目标个体包含在混合DNA中的似然值：其中其中，L：基因座个数；Ol：基因座l的观测峰高；H1：假设混合样本中包含嫌疑人和N-1个随机个体；H2：假设混合样本中包含N个随机个体；Pr：在H1假设下得到观测峰高的条件概率；Pr：在H2假设下得到观测峰高的条件概率；包含嫌疑人和N-1个随机个体的集合Sj在基因座l的基因型；包含N个随机个体的集合Sj′在基因座l的基因型；给定得到观测峰高的条件概率；给定得到观测峰高的条件概率；在H1假设下的得到候选基因型集合的概率；在H2假设下的得到候选基因型集合的概率。与现有技术相对比，本发明的有益效果如下：1.本发明提出了一套分析混合DNA图谱的技术方案，本发明可以编写为软件程序，使得分析混合DNA图谱可以自动化的进行。相比起人工分析，摆脱了法医DNA专家的限制和人主观因素的影响，分析速度更快，获得的分析结果更客观。2.本发明创新的提出了在判断真峰集合的基础上，生成候选基因型集合，首先判断出峰图中是真峰的基因型集合，然后再使用枚举法填补剩余的位置，最后进行排列组合。既没有遗漏真实的基因型集合，同时也大大缩减了候选基因型集合的数量，提高了计算效率。3.本发明原创的给出了候选基因型集合和样本参数的联合后验分布公式，并使用MCMC算法对四类参数和候选基因型集合的联合后验分布进行采样，解决了参数的后验分布没有显示表达式的问题，而使用了参数的后验分布的样本点去估计样本值，提高了计算效率。4.本发明对于混合DNA图谱中的峰高进行建模，提出使用DNA模板量M、DNA的降解水平G、特异性扩增效率K、和重复样本扩增效率F四类参数量化混合DNA图谱，明确了四类参数的采样区间和采样分布。建模表明期望峰高可以很好的解释DNA图谱的观测峰高数据，使得混合DNA图谱分析基础更加可靠。5.本发明得可以到包括混合DNA图谱数据中各个贡献者的占比，各个贡献者的降解水平，各个基因座的特异性扩增效率，各个重复样本的重复样本扩增效率，各个贡献者的STR分型的分析结果，和计算目标个体包含在混合DNA中的似然比。分析结果全面，满足多种分析需求。6.本发明可以计算目标个体包含在混合DNA中的似然比，为法庭判案提供可靠的证据。附图说明图1是本发明的一个实施例的一个重复样本中的一个基因座位点的峰图，图中有3个等位基因，分别为a，b，c，其中混合人数N＝2。图2是本发明的一个实施例的混合DNA图谱的分析方法流程图。图3是本发明的又一个实施例的混合DNA图谱的分析方法流程图。图4是本发明的一个实施例在一个重复样本中的一个基因座l处生成一个候选基因型集合方法的流程图。具体实施方式下面结合附图，对本发明的具体实施方式作详细的说明。本发明提供了一种混合DNA图谱的分析方法，包括如下步骤：读取毛细管电泳产生的一代混合DNA STR图谱数据，获取相关参数；所述的图谱数据包括由同一份DNA分成的多个小份DNA分别进行毛细管电泳得到多个STR电泳图谱数据，每个图谱数据称为一个重复样本；同一份DNA样本等量分成多个小份DNA样本，每小份DNA样本为一个重复样本，每小份DNA样本独立进行扩增操作，操作的流程相同一样，不同的是每个小份中的DNA样本不同。操作过程中因为机器或者人为可能会产生误差，产生重复数据可以消除误差；法医物证学中，主要获取DNA样本中STR的信息。STR是DNA序列中一部分特殊序列，由一个或几个重复单元串联而成，中文名称为短串联重复序列。依照获得STR所使用技术的不同，使用一代测序技术获得的STR信息，称为一代STR图谱。使用二代测序技术获得的STR信息，称为二代STR图谱。两种测序技术获得的STR信息有很大差别。本发明只针对一代测序技术，也就是毛细管电泳技术产生的STR图谱起作用。毛细管电泳是当前而且在未来几年内都会是法医学界的主流技术。利用一代DNA STR图谱数据，使用人工判断、最大等位基因数量法或极大似然估计法确定混合人数N；利用一代DNA STR图谱数据和相关参数，确定各个基因座的真峰集合，以真峰集合为基础生成各个基因座的候选基因型集合；所述真峰集合为个体真实的基因型产生的峰的集合；利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验分布的采样区间和分布函数；使用MCMC算法和相关参数对所述候选基因型集合和样本参数的联合后验分布进行采样；利用采样得到的候选基因型集合和样本参数的后验分布采样点，进行统计分析，得到统计分析结果。根据本发明的一个具体实施方案，所述相关参数包括：影峰阈值参数；试剂盒相关的分析参数，具体包括基因座名称、基因座长度和基因座影峰率；MCMC算法相关参数，具体包括线程数、MCMC的采样链数、预烧期次数、采样接受次数和随机数种子。根据本发明的一个具体实施方案，所述生成各个基因座的候选基因型集合包括如下步骤：S1：指定一个基因座，在一个重复样本中的指定基因座处生成一个候选基因型集合；S2：在每个重复样本中，重复步骤S1，得到所有重复样本在指定基因座的候选基因型集合；S3：对所有重复样本的候选基因型集合取并集，得到指定基因座的候选基因型集合；S4：对图谱数据的各个基因座重复步骤S1-S3，得到各个基因座的候选基因型集合。如图1展示了一个重复样本中的一个基因座位点的峰图，图中有3个等位基因，分别为a，b，c。其中已确定混合人数N＝2。首先使用真峰的筛选标准去产生真峰集合；然后补齐到长度为4的无序候选基因型集合；最后对无序候选基因型集合进行排序，得到这个基因座位点的候选基因型集合。根据本发明的一个具体实施方案，指定一个基因座，在一个重复样本中的指定基因座处生成候选基因型集合具体包括如下步骤：S10：读取混合人数N，确定候选基因型的长度为2N；S11：对一个重复样本中的指定基因座内的所有峰，逐个使用下面的原则进行筛选，得到真峰集合：如果当前峰的前向影峰位置存在峰，且当前峰与前向影峰位置峰的峰高比值小于第一影峰阈值，删除当前峰；如果当前峰的后向影峰位置存在峰，且当前峰与后向影峰位置峰的峰高比值小于第二影峰阈值，删除当前峰；筛选后保留得到的峰集合为真峰集合；S12：如果获得的真峰集合内真峰个数为2N个，无序候选基因型集合为2N个真峰对应的等位基因的集合；如果获得的真峰数量超过2N个，则按照各峰的高度排序，取前2N个真峰，无序候选基因型集合为2N个峰对应的等位基因的集合；如果获得的真峰数量少于2N，则在真峰集合对应等位基因集合的基础上，以基因座内所有的峰对应的等位基因以放回抽样的方式补齐2N个等位基因，获得多个无序候选基因型集合；S13：对无序的候选基因型按照两个一组进行分割排列，得到有序的候选基因型集合。如图1所示的峰图，经过上述处理，得到的真峰集合为{a，b，c}；补齐后的候选基因型集合为{a，a，b，c}，{a，b，b，c}，{a，b，c，c}；排序后的候选基因型集合为{a，a；b，c}，{b，c；a，a}，{a，b；a，c}，{a，c；a，b}，{b，b；a，c}，{a，c；b，b}，{a，b；b，c}，{b，c；a，b}，{c，c；a，b}，{a，b；c，c}，{a，c；b，c}，{b，c；a，c}。根据本发明的一个具体实施方案，所述利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验的采样区间和分布函数，预设样本参数及采样区间和分布函数包括：模板量M、降解水平G、基因座特异性扩增效率K和重复样本扩增效率F以及各参数对应的采样区间和分布函数。根据本发明的一个具体实施方案，所述利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验的采样区间和分布函数；包括如下步骤：S100：获得一个重复样本中的最高峰的峰高max_height；计算一个重复样本中的各个基因座的总峰高；计算各个重复样本的总峰高；S200：确定预设样本参数的先验分布的采样区间具体为：M＝，为N个贡献者的DNA模板量向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；G＝，为N个贡献者DNA的降解水平向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；K＝，为L个基因座的特异性扩增效率向量；其中，各基因座的总峰高最高的基因座的值固定为1，该向量中其余分量的采样区间，由下列规则决定：计算各基因座总峰高与各基因座的总峰高最高的基因座的总峰高的比值，基因座分量的采样区间为以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布；F＝，为C个重复样本的重复样本扩增效率向量；其中向量的第一个分量固定为1；其余分量的采样区间，由下列规则决定：计算该重复样本的总峰高与第一个重复样本数据的各个基因座的总峰高的比值，以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布。根据本发明的一个具体实施方案，所述使用MCMC算法和相关参数对所述候选基因型集合和样本参数的后验分布进行采样包括：通过贝叶斯公式给出候选基因型集合和各个样本参数的联合后验分布，并采用MCMC算法进行采样。根据本发明的一个具体实施方案，所述候选基因型集合和各个样本参数的联合后验分布公式为：候选基因型集合的先验和样本参数M,G,K,F的先验Pr为均匀分布或正态分布；为似然函数，似然函数的计算公式为：其中，O表示输入的图谱数据；表示重复样本f中基因座l的等位基因a处的观测峰高；Sj表示第j个包含所有基因座的候选基因型；表示第j个包含所有基因座的候选基因型在基因座l的基因型；表示重复样本f中基因座l的等位基因a处的期望峰高，在给定样本参数和候选基因型集合的条件下由峰高模型生成。根据本发明的一个具体实施方案，采样MCMC算法进行采样的具体步骤包括：S1000：采样初始化：在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型，组成第一个包含全部基因座的候选基因型S1；在样本参数的先验采样区间中按照先验分布挑选一个值，获得模板量向量M＝、降解水平向量G＝、特异性扩增效率向量K＝和重复样本扩增效率向量F＝的一个初始值；在获得候选基因型集合S1和样本参数初值后，获得在第一次迭代中后验分布函数的对数值iter：其中，iter为第一次迭代中后验分布函数的对数值；为第r个重复样本中基因座l内等位基因a的高度；为基因型集合S1中基因座l的基因型；S2000：进行采样，采样点接受标准如下：在进行第y次迭代时，假设上一次接受的采样点的后验函数函数的对数值是iter；在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型集合，组成一个包含全部基因座的候选基因型集合Sy，其中，Sy是随机采样得到的包含所有基因座分型中的第y个基因型集合；以上一次接受的采样点对应的样本参数为基础，以随机游走的方式抽取第y次迭代的样本参数；在获得候选基因型集合Sy和样本参数初值后，获得在第y次迭代中后验分布函数的对数值iter：在之间选取随机数u，如果iter—iter＞log，接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；如果iter—iter≤log，不接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；S3000：当接受的采样点达到预设采样预烧期次数和采样接受次数的和时，采样结束。根据本发明的一个具体实施方案，所述进行统计分析，得到统计分析结果中具体统计分析结果为各个贡献者的占比、各个贡献者的降解水平、各个基因座的特异性扩增效率、各个重复样本的重复样本扩增效率和各个贡献者的单人STR分型，以及目标个体包含在混合DNA中的似然比的分析结果；具体统计分析方法包括如下步骤：舍弃前预烧期个采样点，保留后接受次数个采样点；计算M＝的采样点的平均值，得到各个贡献者模板量的估计值；计算G＝的采样点的平均值，得到各个贡献者降解水平的估计值；计算K＝的采样点的平均值，得到基因座特异性扩增效率的估计值；计算F＝的采样点的平均值，得到重复样本扩增效率的估计值；计算各个基因座处各个候选基因型集合的采样个数占接受次数的比值，得到候选基因型集合后验概率的估计；采用如下公式计算目标个体包含在混合DNA中的似然值：其中其中，L：基因座个数；Ol：基因座l的观测峰高；H1：假设混合样本中包含嫌疑人和N-1个随机个体；H2：假设混合样本中包含N个随机个体；Pr：在H1假设下得到观测峰高的条件概率；Pr：在H2假设下得到观测峰高的条件概率；包含嫌疑人和N-1个随机个体的集合Sj在基因座l的基因型；包含N个随机个体的集合Sj′在基因座l的基因型；给定得到观测峰高的条件概率；给定得到观测峰高的条件概率；在H1假设下的得到候选基因型集合的概率；在H2假设下的得到候选基因型集合的概率。实施例1根据本发明的一个具体实施方案，下面对本发明提出的混合DNA图谱的分析方法进行详细说明。本发明提供了一种混合DNA图谱的分析方法，包括如下步骤：读取毛细管电泳产生的一代混合DNA STR图谱数据，获取相关参数；所述的图谱数据包括由同一份DNA分成的多个小份DNA分别进行毛细管电泳得到多个STR电泳图谱数据，每个图谱数据称为一个重复样本；所述相关参数包括：影峰阈值参数；试剂盒相关的分析参数，具体包括基因座名称、基因座长度和基因座影峰率；MCMC算法相关参数，具体包括线程数、MCMC的采样链数、预烧期次数、采样接受次数和随机数种子；利用一代DNA STR图谱数据，使用人工判断、最大等位基因数量法或极大似然估计法确定混合人数N；利用一代DNA STR图谱数据和相关参数，确定各个基因座的真峰集合，以真峰集合为基础生成各个基因座的候选基因型集合；所述真峰集合为个体真实的基因型产生的峰的集合；所述生成各个基因座的候选基因型集合包括如下步骤：S1：指定一个基因座，在一个重复样本中的指定基因座处生成一个候选基因型集合；S2：在每个重复样本中，重复步骤S1，得到所有重复样本在指定基因座的候选基因型集合；S3：对所有重复样本的候选基因型集合取并集，得到指定基因座的候选基因型集合；S4：对图谱数据的各个基因座重复步骤S1-S3，得到各个基因座的候选基因型集合。利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验分布的采样区间和分布函数；包括如下步骤：S100：获得一个重复样本中的最高峰的峰高max_height；计算一个重复样本中的各个基因座的总峰高；计算各个重复样本的总峰高；S200：确定预设样本参数的先验分布的采样区间具体为：M＝，为N个贡献者的DNA模板量向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；G＝，为N个贡献者DNA的降解水平向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；K＝，为L个基因座的特异性扩增效率向量；其中，各基因座的总峰高最高的基因座的值固定为1，该向量中其余分量的采样区间，由下列规则决定：计算各基因座总峰高与各基因座的总峰高最高的基因座的总峰高的比值，基因座分量的采样区间为以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布；F＝，为C个重复样本的重复样本扩增效率向量；其中向量的第一个分量固定为1；其余分量的采样区间，由下列规则决定：计算该重复样本的总峰高与第一个重复样本数据的各个基因座的总峰高的比值，以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布。使用MCMC算法和相关参数对所述候选基因型集合和样本参数的联合后验分布进行采样；预设样本参数包括DNA模板量M、DNA的降解水平G、基因座的特异性扩增效率K和重复样本扩增效率F；利用采样得到的候选基因型集合和样本参数的后验分布采样点，进行统计分析，得到统计分析结果。实施例2根据本发明的一个具体实施方案，下面对本发明提出的混合DNA图谱的分析方法进行详细说明。本发明提供了一种混合DNA图谱的分析方法，包括如下步骤：读取毛细管电泳产生的一代混合DNA STR图谱数据，获取相关参数；所述的图谱数据包括由同一份DNA分成的多个小份DNA分别进行毛细管电泳得到多个STR电泳图谱数据，每个图谱数据称为一个重复样本；所述相关参数包括：影峰阈值参数；试剂盒相关的分析参数，具体包括基因座名称、基因座长度和基因座影峰率；MCMC算法相关参数，具体包括线程数、MCMC的采样链数、预烧期次数、采样接受次数和随机数种子；利用一代DNA STR图谱数据，使用人工判断、最大等位基因数量法或极大似然估计法确定混合人数N；利用一代DNA STR图谱数据和相关参数，确定各个基因座的真峰集合，以真峰集合为基础生成各个基因座的候选基因型集合；所述真峰集合为个体真实的基因型产生的峰的集合；所述生成各个基因座的候选基因型集合包括如下步骤：S1：指定一个基因座，在一个重复样本中的指定基因座处生成一个候选基因型集合；具体包括如下步骤：S10：读取混合人数N，确定候选基因型的长度为2N；S11：对一个重复样本中的指定基因座内的所有峰，逐个使用下面的原则进行筛选，得到真峰集合：如果当前峰的前向影峰位置存在峰，且当前峰与前向影峰位置峰的峰高比值小于第一影峰阈值，删除当前峰；如果当前峰的后向影峰位置存在峰，且当前峰与后向影峰位置峰的峰高比值小于第二影峰阈值，删除当前峰；筛选后保留得到的峰集合为真峰集合；S12：如果获得的真峰集合内真峰个数为2N个，无序候选基因型集合为2N个真峰对应的等位基因的集合；如果获得的真峰数量超过2N个，则按照各峰的高度排序，取前2N个真峰，无序候选基因型集合为2N个峰对应的等位基因的集合；如果获得的真峰数量少于2N，则在真峰集合对应等位基因集合的基础上，以基因座内所有的峰对应的等位基因以放回抽样的方式补齐2N个等位基因，获得多个无序候选基因型集合；S13：对无序的候选基因型按照两个一组进行分割排列，得到有序的候选基因型集合。S2：在每个重复样本中，重复步骤S1，得到所有重复样本在指定基因座的候选基因型集合；S3：对所有重复样本的候选基因型集合取并集，得到指定基因座的候选基因型集合；S4：对图谱数据的各个基因座重复步骤S1-S3，得到各个基因座的候选基因型集合。利用一代DNA STR图谱数据和相关参数确定预设样本参数的先验分布的采样区间和分布函数；预设样本参数包括DNA模板量M、DNA的降解水平G、基因座的特异性扩增效率K和重复样本扩增效率F；具体包括如下步骤：S100：获得一个重复样本中的最高峰的峰高max_height；计算一个重复样本中的各个基因座的总峰高；计算各个重复样本的总峰高；S200：确定预设样本参数的先验分布的采样区间具体为：M＝，为N个贡献者的DNA模板量向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；G＝，为N个贡献者DNA的降解水平向量，该向量的每个分量的采样区间为，为均匀分布或者正态分布；K＝，为L个基因座的特异性扩增效率向量；其中，各基因座的总峰高最高的基因座的值固定为1，该向量中其余分量的采样区间，由下列规则决定：计算各基因座总峰高与各基因座的总峰高最高的基因座的总峰高的比值，基因座分量的采样区间为以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布；F＝，为C个重复样本的重复样本扩增效率向量；其中向量的第一个分量固定为1；其余分量的采样区间，由下列规则决定：计算该重复样本的总峰高与第一个重复样本数据的各个基因座的总峰高的比值，以该比值为采样区间的中心，采样区间长度为0.05，为均匀分布或者正态分布。国内现有技术是人工拆分，考虑的因素很少，只考虑有限的基因型组合以及一定范围内的杂合平衡。本发明采用的这四类参数，将产生峰高的因素进行量化，有利于对峰图的量化分析。使混合DNA图谱分析由定性的分析转变为定量的分析，分析结果更加丰富和可靠。使用MCMC算法和相关参数对所述候选基因型集合和样本参数的联合后验分布进行采样；采样所使用的不同的技术方法都应视为本方案的变体：如改变了候选基因型集合的数量和范围，改变了参数的采样区间，改变了参数的分布等，改变了似然函数的形式等。所述候选基因型集合和各个样本参数的联合后验分布公式为：候选基因型集合的先验和样本参数M,G,K,F的先验Pr为均匀分布或正态分布；为似然函数，似然函数的计算公式为：其中，O表示输入的图谱数据；表示重复样本f中基因座l的等位基因a处的观测峰高；Sj表示第j个包含所有基因座的候选基因型；表示第j个包含所有基因座的候选基因型在基因座l的基因型；表示重复样本f中基因座l的等位基因a处的期望峰高，在给定样本参数和候选基因型集合的条件下由峰高模型生成；采样MCMC算法进行采样的具体步骤包括：S1000：采样初始化：在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型，组成第一个包含全部基因座的候选基因型S1；在样本参数的先验采样区间中按照先验分布挑选一个值，获得模板量向量M＝、降解水平向量G＝、特异性扩增效率向量K＝和重复样本扩增效率向量F＝的一个初始值；在获得候选基因型集合S1和样本参数初值后，获得在第一次迭代中后验分布函数的对数值iter：其中，iter为第一次迭代中后验分布函数的值；为第r个重复样本中基因座l内等位基因a的高度；为基因型集合S1中基因座l的基因型；S2000：进行采样，采样点接受标准如下：在进行第y次迭代时，假设上一次接受的采样点的后验函数函数的对数值是iter；在各个基因座的各个候选基因型集合中，随机挑选一个候选基因型集合，组成一个包含全部基因座的候选基因型集合Sy，其中，Sy是随机采样得到的包含所有基因座分型中的第y个基因型集合；以上一次接受的采样点对应的样本参数为基础，以随机游走的方式抽取第y次迭代的样本参数；在获得候选基因型集合Sy和样本参数初值后，获得在第y次迭代中后验分布函数的对数值iter：在之间选取随机数u，如果iter—iter＞log，接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；如果iter—iter≤log，不接受当前的候选基因型集合的Sy和样本参数作为后验分布的一个采样；S3000：当接受的采样点达到预设采样预烧期次数和采样接受次数的和时，采样结束。利用采样得到的候选基因型集合和样本参数的后验分布采样点，进行统计分析，得到统计分析结果，具体统计分析结果为各个贡献者的占比、各个贡献者的降解水平、各个基因座的特异性扩增效率、各个重复样本的重复样本扩增效率和各个贡献者的单人STR分型，以及目标个体包含在混合DNA中的似然比的分析结果；具体统计分析方法包括如下步骤：舍弃前预烧期个采样点，保留后接受次数个采样点；计算M＝的采样点的平均值，得到各个贡献者模板量的估计值；计算G＝的采样点的平均值，得到各个贡献者降解水平的估计值；计算K＝的采样点的平均值，得到基因座特异性扩增效率的估计值；计算F＝的采样点的平均值，得到重复样本扩增效率的估计值；计算各个基因座处各个候选基因型集合的采样个数占接受次数的比值，得到候选基因型集合后验概率的估计；采用如下公式计算目标个体包含在混合DNA中的似然值：其中其中，L：基因座个数；Ol：基因座l的观测峰高；H1：假设混合样本中包含嫌疑人和N-1个随机个体；H2：假设混合样本中包含N个随机个体；Pr：在H1假设下得到观测峰高的条件概率；Pr：在H2假设下得到观测峰高的条件概率；包含嫌疑人和N-1个随机个体的集合Sj在基因座l的基因型；包含N个随机个体的集合Sj′在基因座l的基因型；给定得到观测峰高的条件概率；给定得到观测峰高的条件概率；在H1假设下的得到候选基因型集合的概率；在H2假设下的得到候选基因型集合的概率。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均包含在本发明的保护范围之内。
