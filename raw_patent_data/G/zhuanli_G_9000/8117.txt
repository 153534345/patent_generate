标题title
基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法
摘要abst
本发明涉及VHF瞬态信号探测技术领域，具体涉及基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，包括以下步骤：对VHF瞬态信号进行宽带采样，得到探测频段的原始时域波形，利用Goertzel算法，逐点滑动窗口实时计算多个频点的傅里叶分量，根据判别条件对信号进行判别；本发明在两个探测频带中，实时计算20个频点的傅里叶分量，并以阈值、过阈值持续时间等作为判别条件，当满足判别条件的频点数达到M，且具有高频先到的特征，可认为信号有效，本方法减少了硬件电路的复杂程度，增强了电路的抗干扰能力，还具有实时、高效、参数可调等优势，另外，还可以完成对原始时域信号波形的采集，为电离层传播群延时及波形特征分析提供信息。
权利要求书clms
1.基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，包括以下步骤：对VHF瞬态信号进行宽带采样，得到探测频段的原始时域波形；利用Goertzel算法，逐点滑动窗口实时计算多个频点的傅里叶分量；根据判别条件对信号进行判别。2.根据权利要求1所述的基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，在步骤中，利用两个带通滤波器筛选出两个探测频段的信号。3.根据权利要求2所述的基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，两个所述的探测频段分别为低频段25MHz-75MHz和高频段110MHz-150MHz。4.根据权利要求1所述的基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，在步骤，选取采样频率fS＝160MHz，并使用两个A/D芯片同时转换两个频段的信号，对低频段直接采样获得25MHz-75MHz的数字信号，对高频段欠采样获得10MHz-50MHz的数字信号。5.根据权利要求1所述的基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，在步骤中，选取采样时长为256us。6.根据权利要求1所述的基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，在步骤中，包括以下步骤：1)将通道数量设置为20；2)选取计算窗宽N＝101，101个时域信号采样点得到一个傅里叶分量频点幅值，每移动一个采样点计算一个傅里叶分量频点幅值；3)选定傅里叶分量频率；4)对Goertzel算法的迭代公式进行优化；5)逐点滑动窗口实时计算多个频点的傅里叶分量。7.根据权利要求6所述的基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，优化后的Goertzel算法的迭代公式为：式中，N为窗宽，X为采样值。8.根据权利要求1所述的基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，其特征在于，在步骤中，以阈值、过阈值持续时间作为判别条件，当满足判别条件的频点数达到M，且具有高频先到的特征，认为信号有效。
说明书desc
技术领域本发明涉及VHF瞬态信号探测技术领域，具体涉及基于Goertzel 算法的星载VHF瞬态信号逐点扫描实时处理方法。背景技术利用卫星平台实现对VHF瞬态信号的探测，主要用于捕捉地球表面以上自然或人为产生的电磁辐射信号。目前国内外现有的信号处理方法主要采用模拟技术，通过多个模拟滤波器将探测到的时域信号划分为多个通道，再利用混频下变频技术得到多个通道的中频信号，然后经数采后送入数字处理单元进行判定。如我国的XX卫星三号搭载的电磁辐射探测器设计使用了5个模拟通道，美国的FORTE卫星搭载的VHF频段电磁辐射探测器设计使用了8个窄带模拟通道。其不足之处表现为：1)采集的信息量较少，无时域信号原始波形，对电离层传播群延时及波形特征分析提供信息不足；2)非实时数据处理，存在丢失事件的可能性；3)多以混频下变频的方式实现，在复杂的电磁环境中易受干扰。综上所述，研发基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，仍是VHF瞬态信号探测技术领域中急需解决的关键问题。发明内容针对现有技术所存在的上述缺点，本发明在于提供基于 Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，本发明基于Goertzel算法，采用数字多通道短时傅立叶变换结合逐点滑动窗口扫描方式，固定计算窗宽，选择步长为一个采样点，对接收到的信号进行逐点多路窄带通道频谱分析，实现对穿过电离层的VHF 瞬态事件的捕捉，Goertzel算法可以在接收信号的同时进行计算，不必等待参与计算的所有数据都准备好，具有很好的实时性，利用滑动窗口递归计算，可以避免重复运算，进一步加快计算速度。为实现本发明的目的，本发明提供了如下技术方案：基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，包括以下步骤：对VHF瞬态信号进行宽带采样，得到探测频段的原始时域波形；利用Goertzel算法，逐点滑动窗口实时计算多个频点的傅里叶分量；根据判别条件对信号进行判别。本发明进一步设置为：在步骤中，利用两个带通滤波器筛选出两个探测频段的信号。本发明进一步设置为：两个所述的探测频段分别为低频段 25MHz-75MHz和高频段110MHz-150MHz。本发明进一步设置为：在步骤，选取采样频率 fS＝160MHz，并使用两个A/D芯片同时转换两个频段的信号，对低频段直接采样获得25MHz-75MHz的数字信号，对高频段欠采样获得 10MHz-50MHz的数字信号。本发明进一步设置为：在步骤中，选取采样时长为 256us。本发明进一步设置为：在步骤中，包括以下步骤：1)将通道数量设置为20；2)选取计算窗宽N＝101，101个时域信号采样点得到一个傅里叶分量频点幅值，每移动一个采样点计算一个傅里叶分量频点幅值；3)选定傅里叶分量频率；4)对Goertzel算法的迭代公式进行优化；5)逐点滑动窗口实时计算多个频点的傅里叶分量。本发明进一步设置为：优化后的Goertzel算法的迭代公式为：式中，N为窗宽，X为采样值。本发明进一步设置为：在步骤中，以阈值、过阈值持续时间作为判别条件，当满足判别条件的频点数达到M，且具有高频先到的特征，认为信号有效。有益效果采用本发明提供的技术方案，与已知的公有技术相比，具有如下有益效果：本发明在25MHz-75MHz和110MHz-150MHz两个探测频带中，实时计算20个频点的傅里叶分量，并以阈值、过阈值持续时间等作为判别条件，当满足判别条件的频点数达到M，且具有高频先到的特征，可认为信号有效，本方法减少了硬件电路的复杂程度，增强了电路的抗干扰能力，还具有实时、高效、参数可调等优势，另外，还可以完成对原始时域信号波形的采集，为电离层传播群延时及波形特征分析提供信息。附图说明图1为实施例1中的逐点滑动窗口扫描检波结果图；图2为实施例1中的信号触发判断示意图；图3为实施例1中的信号触发判断流程图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将对本发明实施例中的技术方案进行清楚、完整地描述。显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。为了实现本发明的效果，下面结合实施例对本发明作进一步的描述。实施例1：参照图1-3所示，基于Goertzel算法的星载VHF瞬态信号逐点扫描实时处理方法，包括以下步骤：对VHF瞬态信号进行宽带采样，得到探测频段的原始时域波形。在本实施例中，选用AD9642进行采样。1)选择采样频段：目标VHF瞬态信号频率主要分布在几十kHz 至数百MHz，由于电离层传播效应影响，大于20MHz的信号能够穿过电离层。受电离层TEC的影响，不同频率电磁波在电离层传播时的群延时有明显差异，频率越低延时越大。为尽量减小地面电台或其它自然信号的影响，探测频段定为低频段25MHz-75MHz和高频段110MHz-150MHz，采样前，先利用两个带通滤波器筛选出上述两个频段的信号。2)选择采样频率fS：针对探测频段，奈奎斯特频率应选择在探测频段最高探测频率之上或高频段和低频段之间，以便覆盖探测频段；同时奈奎斯特频率fN要尽量避免选择在探测频段的边缘，减少杂波干扰，因此选取采样频率fS＝160MHz。使用两个A/D芯片同时转换两个频段的信号，对低频段直接采样获得25MHz-75MHz的数字信号，对高频段欠采样获得10MH-50MHz的数字信号。3)选择一次事件的采样时长：根据电离层群延时特点，在TEC 为1×1017m-2时，30MHz和31MHz的电磁波时延差为1.62×103ns， 150MHz和151MHz的电磁波时延差为7.9ns，30MHz和150MHz的电磁波总时延差为1.43×104ns。考虑到电离层浓度变化较大，在本发明中一次事件的采样时长为256us，即40960个采样点。利用Goertzel算法，逐点滑动窗口实时计算多个频点的傅里叶分量。在本实施例中，包括以下步骤：1)设定通道数量：以往卫星载荷设定的通道数量为5通道、8通道，考虑到目标信号快速识别的可靠性，本发明中的通道数量定为20，即对数采信号进行处理时需要实时计算20个频点的傅里叶分量。2)窗口宽度N：窗口宽度N是在采集频率范围内分配N 个傅里叶变换频点，并进行N次迭代运算，以便获取窗宽范围内傅里叶变换频谱。傅里叶变换频点fk＝kfs/N，频点间隔fs/N，其中fS为系统的采样频率，N为窗口宽度，fS/N是频率分辨率。选取N越大，频谱分辨率越高，需要的计算量越大，因此N与计算累计误差和系统资源相关。对于实时判断信号性质，即要保证所选频点之间有相当的隔离度和适宜的频点带宽，避免所选频点间频率干扰及探测可靠性；又必须保证计算精度和资源的有效利用。经权衡，选取计算窗宽N＝101，即101个时域信号采样点得到一个傅里叶分量频点幅值，每移动一个采样点计算一个傅里叶分量频点幅值。3)选定傅里叶分量频率：采样频率fS为160MHz，因此傅里叶分量频率分辨率为1.58416MHz；本实施例选取傅里叶分量频率间隔为3.16832MHz，可人为设置2组傅里叶分量。在本实施例中，选取傅里叶分量频率如表1。表1傅里叶分量频率表4)对Goertzel算法的迭代公式进行优化：根据Goertzel递推算法迭代公式：Vk＝2cosVk-Vk+X，每输入一个采样值x，迭代计算出需要进行一次实数的乘法和两次实数加法，计算Vk，需要计算N次。当采样率较低时，迭代计算可在采样间隙进行，但是面对高速采样时，采样间隙不足以完成此规模的迭代计算，因此需要对 Goertzel算法的迭代公式进行优化。经过推导，上述迭代公式可转化为：式中，N为窗宽，X为采样值，这样，对于计算窗宽为N的Vk 计算，可以用Vk、Vk和X，直接计算 Vk，将N＝101代入上述转化后的公式，可得：式中，对于每个给定的k值，wk、是常数。5)逐点滑动窗口实时计算多个频点的傅里叶分量：在本实施例中，使用的是Zynq-7000系列芯片XC7z045ffg900- 2。为了实现流水线运算，需要4个乘法器和5个加法器，其中2个乘法器和2个加法器用2个DSP48的乘加器实现。FPGA采用查找表方式的乘法器的计算时间为4倍运算速度 ，fabric方式的加法器计算时间为2clk，DSP48s 的2个乘加器运算时间分别为乘法器1clk、加法器3clk和乘法器 1clk、加法器2clk。在FPGA计算速度fC＝2fS＝320MHz的情况下，可以采用流水线方式完成式的迭代计算。充分利用FPGA并行处理优势，在一个采样时钟周期内完成多路频点的频域分析，即每一个采样时钟同时生成一组20通道窄带多频点频域结果，实现对瞬态信号的实时捕捉，其中逐点滑动窗口扫描检波结果如图1所示根据判别条件对信号进行判别。以阈值、过阈值持续时间作为判别条件，当满足判别条件的频点数达到M，且具有高频先到的特征，认为信号有效。在本实施例中，如根据XX卫星三号电磁辐射探测器接收到的数据分析，一些特定区域经常会接收到某一单频信号，该信号持续时间很长，与目标信号区别很大。为了滤除这类信号，在电磁脉冲接收机综合处理单元增加了能量峰值维持时间判断，如果窄带信号连续过阈值超过tP，则不采信该信号，这样就滤除了大部分非目标信号。同时，目标源信号为脉冲信号，经电离层散射后其频谱会覆盖不同的探测频段，通过20路窄带通道判断，在一定的时间窗tW内只有M路满足条件，才进行采集，以减少单频脉冲信号对载荷探测信号的影响，其中信号触发判断示意图如图2所示。信号触发流程如下：在锁存器中写入数字化阈值，数字化的采集信号与设定阈值相比较，当采集信号大于设定阈值时，产生过阈值信号；当此信号通过峰值维持时间判断后进入20选M模块进行判别，在时间窗tW时间内当过阈值信号≥M时存储事件波形，并锁存事件触发时刻，其中信号触发判断流程如图3所示。实施例2：将本发明的方法与现有技术进行对比，其对比相关数据见表 2。表2对比数据表由表2可知，本发明减少了硬件电路的复杂程度，增强了电路的抗干扰能力，还具有实时、高效、参数可调等优势；另外，可以完成对原始时域信号波形的采集，为电离层传播群延时及波形特征分析提供信息。
