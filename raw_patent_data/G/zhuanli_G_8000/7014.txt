标题title
一种姿态与位置解耦的机器人视觉寻位方法
摘要abst
本发明属于机器人视觉领域，并具体公开了一种姿态与位置解耦的机器人视觉寻位方法，包括步骤：S1、通过靶标进行位置标定，得到靶标位置深度d0和标定深度下移动单位像素的实际偏移量；S2、根据目标物体所在平面的法向量调整机器人姿态，使机器人末端与目标物体所在平面平行；S3、获取相机图像，识别当前深度下目标物体像素坐标和深度值d1，得到找中补偿向量，调整机器人使目标物体位于相机图像正中；然后在深度方向移动机器人至标定高度d0；S4、再次获取相机图像，得到寻位补偿向量，根据寻位补偿向量调整机器人，使机器人到达目标物体处。本发明标定过程操作简单、定位准确性高，提升了机器人视觉寻位的可操作性和准确性。
权利要求书clms
1.一种姿态与位置解耦的机器人视觉寻位方法，其特征在于，包括如下步骤：S1、通过靶标进行位置标定，得到靶标位置深度作为标定深度d0，以及该标定深度下移动单位像素的实际偏移量S2、示教机器人，使机器人末端的相机面对目标物体，根据相机获取的目标物体点云信息，得到目标物体所在平面的法向量，根据该法向量调整机器人姿态，使机器人末端与目标物体所在平面平行；S3、获取相机图像，识别当前深度下目标物体像素坐标，以及目标物体平面到相机的深度值d1；根据标定深度d0及实际偏移量得到深度为d1时移动单位像素的实际偏移量进而根据实际偏移量和目标物体像素坐标得到找中补偿向量，根据该找中补偿向量在水平方向调整机器人，使目标物体位于相机图像正中；然后在深度方向移动机器人至标定高度d0；S4、再次获取相机图像，识别当前深度下目标物体像素坐标，进而得到寻位补偿向量，根据寻位补偿向量调整机器人，使机器人到达目标物体处，完成机器人视觉寻位。2.如权利要求1所述的姿态与位置解耦的机器人视觉寻位方法，其特征在于，步骤S2中，获取目标物体所在平面的法向量，具体包括如下步骤：使机器人末端的相机面对目标物体，根据相机获取的目标物体点云信息，根据点云信息划分点云凸包，并移动机器人末端使凸包包裹目标工件平面，然后由凸包分割出的点云拟合平面方程，进而得到目标物体所在平面的法向量3.如权利要求2所述的姿态与位置解耦的机器人视觉寻位方法，其特征在于，步骤S2中，根据法向量调整机器人姿态，具体包括如下步骤：先将法向量转换到机器人基座坐标系下表示为：其中，表示末端坐标系到基座坐标系的旋转矩阵，表示相机坐标系到末端坐标系的旋转矩阵；然后根据和向量为位置标定时，初始状态下的靶标像素坐标。7.如权利要求1-6任一项所述的姿态与位置解耦的机器人视觉寻位方法，其特征在于，步骤S1中，通过靶标进行位置标定，具体包括如下步骤：S11、在机器人末端安装相机和试触杆，并使相机视场内能看到试触杆末端；用示教的方式移动机器人，使试触杆末端与靶标重合，然后移开试触杆，得到靶标像素坐标，靶标位置深度值d0；S12、保持机器人姿态和高度不变，水平移动机器人，标定得到移动单位像素坐标引起x和y方向上的实际偏移量8.如权利要求7所述的姿态与位置解耦的机器人视觉寻位方法，其特征在于，步骤S12中，获取实际偏移量包括如下步骤：保持机器人姿态和高度不变，水平移动机器人，同时读取机器人在第一个位置上的末端坐标，识别到的靶标像素坐标；在第二个位置上的末端坐标，识别到的靶标像素坐标，得到该深度下移动单位像素坐标引起x和y方向上的实际偏移量
说明书desc
技术领域本发明属于机器人视觉领域，更具体地，涉及一种姿态与位置解耦的机器人视觉寻位方法。背景技术随着智能制造理念的提出与发展，机器人现已广泛的应用于自动化装配，数字柔性化制造等系统。而机器人视觉寻位技术是其中十分重要的一环，视觉寻位技术的好坏直接对后续工作位置的准确定位，方案合理性造成影响。机器人视觉寻位技术有很多应用的场景，比如飞机蒙皮自动钻铆系统、工业流水线上机器人识别目标和抓取，移动机器人视觉导航建图等多种领域，具有十分广泛的应用前景。根据相机的安装方式，机器人视觉定位方式可以分为两大类：眼在手上，即相机安装在机械臂末端，随机械臂的运动而运动；眼在手外，相机安装在机械臂之外，与机械臂的基座相对固定，不随机械臂的运动而运动。在视觉寻位之前，往往需要对视觉系统进行标定，主流的标定方法采用棋盘格作为标定工具，但棋盘格占据一定的空间，通常很难和工件同时放在相机视野内，所以标定只能在生产前进行。现有的机器人手眼标定尤其是高精度的标定往往都存在标定操作繁琐，计算原理复杂，时间成本过高的问题。发明内容针对现有技术的以上缺陷或改进需求，本发明提供了一种姿态与位置解耦的机器人视觉寻位方法，其目的在于，简化机器人视觉标定过程，提高机器人视觉定位的准确性和可靠性，解决目前标定效率不高和定位精度低的问题。为实现上述目的，本发明提出了一种姿态与位置解耦的机器人视觉寻位方法，包括如下步骤：S1、通过靶标进行位置标定，得到靶标位置深度作为标定深度d0，以及该标定深度下移动单位像素的实际偏移量S2、示教机器人，使机器人末端的相机面对目标物体，根据相机获取的目标物体点云信息，得到目标物体所在平面的法向量，根据该法向量调整机器人姿态，使机器人末端与目标物体所在平面平行；S3、获取相机图像，识别当前深度下目标物体像素坐标，以及目标物体平面到相机的深度值d1；根据标定深度d0及实际偏移量得到深度为d1时移动单位像素的实际偏移量进而根据实际偏移量和目标物体像素坐标得到找中补偿向量，根据该找中补偿向量在水平方向调整机器人，使目标物体位于相机图像正中；然后在深度方向移动机器人至标定高度d0；S4、再次获取相机图像，识别当前深度下目标物体像素坐标，进而得到寻位补偿向量，根据寻位补偿向量调整机器人，使机器人到达目标物体处，完成机器人视觉寻位。作为进一步优选的，步骤S2中，获取目标物体所在平面的法向量，具体包括如下步骤：使机器人末端的相机面对目标物体，根据相机获取的目标物体点云信息，根据点云信息划分点云凸包，并移动机器人末端使凸包包裹目标工件平面，然后由凸包分割出的点云拟合平面方程，进而得到目标物体所在平面的法向量作为进一步优选的，步骤S2中，根据法向量调整机器人姿态，具体包括如下步骤：先将法向量转换到机器人基座坐标系下表示为：其中，表示末端坐标系到基座坐标系的旋转矩阵，表示相机坐标系到末端坐标系的旋转矩阵；然后根据和向量为位置标定时，初始状态下的靶标像素坐标。作为进一步优选的，步骤S1中，通过靶标进行位置标定，具体包括如下步骤：S11、在机器人末端安装相机和试触杆，并使相机视场内能看到试触杆末端；用示教的方式移动机器人，使试触杆末端与靶标重合，然后移开试触杆，得到靶标像素坐标，靶标位置深度值d0；S12、保持机器人姿态和高度不变，水平移动机器人，标定得到移动单位像素坐标引起x和y方向上的实际偏移量作为进一步优选的，步骤S12中，获取实际偏移量包括如下步骤：保持机器人姿态和高度不变，水平移动机器人，同时读取机器人在第一个位置上的末端坐标，识别到的靶标像素坐标；在第二个位置上的末端坐标，识别到的靶标像素坐标，得到该深度下移动单位像素坐标引起x和y方向上的实际偏移量总体而言，通过本发明所构思的以上技术方案与现有技术相比，主要具备以下的技术优点：1.本发明通过只标定固定深度平面内单位像素点引起的实际偏移量，将机器人姿态和位置进行解耦，分步处理，并通过找中补偿、深度补偿、寻位补偿实现对目标的精确寻位，标定时间成本低，操作简单，适用于各种寻位和操作场景，大大提高了机器人视觉定位的准确性和可靠性。2.本发明在先进行姿态调整时，根据点云信息划分点云凸包，并移动机器人末端使凸包包裹目标工件平面，然后由凸包分割出的点云拟合平面方程，可以快速、准确得到与目标物体所在平面垂直的法向量，进而转换得到机器人末端姿态参数，实现对机器人姿态的调节。附图说明图1为本发明实施例姿态与位置解耦的机器人视觉寻位方法的环境应用示意图；图2为本发明实施例深度相机与试触装置一体化夹具示意图；图3为本发明实施例姿态与位置解耦的机器人视觉寻位方法流程图。在所有附图中，相同的附图标记用来表示相同的元件或结构，其中：1-机器人本体，2-深度相机，3-法向量，4-待加工平面，5-一体化夹具，6-试触杆。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。此外，下面所描述的本发明各个实施方式中所涉及到的技术特征只要彼此之间未构成冲突就可以相互组合。本发明实施例提供的一种姿态与位置解耦的机器人视觉寻位方法，如图3所示，包括如下步骤：S1、进行位置标定，如图1和图2所示，在机器人本体1末端安装一体化夹具5，将在深度相机2和试触杆6安装在一体化夹具5上，并使深度相机视场内能看到试触杆末端，标定试触杆末端的像素坐标，读取靶标位置深度值记为d0；具体包括步骤：S11、设计深度相机与试触装置的一体化夹具，深度相机平面与机器人末端平面平行，试触杆中心水平方向偏移末端dpole，其余方向无差，长度为lpole，安装夹具，控制机器人末端垂直水平面；S12、在水平面上放置一块标定板，标定板上贴有定位靶标，不改变机器人末端姿态，用示教的方式移动机器人，使试触杆末端刚好与靶标重合，移开试触杆，读取得到靶标像素坐标记为，靶标位置深度值记为d0。S2、保持机器人姿态和高度不变，水平移动机器人，标定得到该深度d0下移动单位像素坐标引起x和y方向上的实际偏移量计算相机视场角；具体包括步骤：S21：保持机器人姿态和高度不变，水平移动机器人，读取机器人在第一个位置上的末端坐标，识别到的靶标像素坐标；在第二个位置上的末端坐标，识别到的靶标像素坐标，得到该深度下移动单位像素坐标引起x和y方向上的实际偏移量S22、视场角由下式计算：水平视场角垂直视场角其中width和depth分别表示图像宽度和高度，用像素单位表示。S3、完成位置标定后拆除试触杆，工具端中心偏离机器人末端，该值由工具端夹具尺寸决定；示教机器人使相机面对工件，根据相机获取的点云信息，通过划分点云凸包，移动机器人末端使凸包区域内均为目标工件平面点云数据，由凸包分割出的点云拟合平面方程，得到法向量具体的，划分点云凸包形状可以是多边形，圆形等二维图形，要求面积小于目标工件平面点云成像区域大小；然后将法向量转为机器人末端姿态参数，将其输入机器人进行姿态调节，使得机器人末端与工件所在平面平行；具体包括：将法向量转换到机器人基座坐标系下表示为：其中，表示末端坐标系到基座坐标系的旋转矩阵，由机器人姿态得到，表示相机坐标系到末端坐标系的旋转矩阵，由相机安装方式决定；将正交化后与向量求点积和叉积得到机器人旋转轴和转角将旋转转换为四元数q0表示，作为机器人末端姿态调整的参数，输入机器人进行姿态调节，使得机器人末端与工件所在平面平行。S4、获取相机图像，识别当前深度下目标物体像素坐标，获取工件平面到相机的深度值d1，则在此深度d1下移动一个像素的实际偏移量可由下两式得到:x偏移量：y偏移量：据此计算机器人找中补偿向量，让目标物体位于相机图像正中；具体的，找中补偿向量为转换到基座坐标获取机器人当前位置则找中位置在机器人基座下坐标为根据此坐标在水平方向调整机器人，使目标物体位于相机图像正中；然后在深度方向移动机器人d1-d0距离，至标定高度d0，完成找中补偿与深度补偿。S5、再次识别目标像素坐标，得到机器人寻位补偿向量转换到工具端转换到基座坐标获取机器人当前位置则目标点在机器人基座下坐标为控制机器人到达目标点，完成机器人视觉寻位。本领域的技术人员容易理解，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
