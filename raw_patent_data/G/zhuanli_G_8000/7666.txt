标题title
基于神经网络的并网逆变器序阻抗计算方法
摘要abst
本发明提供了一种基于神经网络的并网逆变器序阻抗计算方法，属于并网逆变器序阻抗计算领域。该并网逆变器序阻抗计算方法首先在含有电网阻抗的并网逆变器基础上，测量不同短路比下的并网逆变器序阻抗，然后使用神经网络结合测量阻抗进行训练，其次经过验证后得到可用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，最后根据代理模型即可获得任一短路比下的并网逆变器序阻抗曲线。本发明的并网逆变器序阻抗计算方法考虑了电网阻抗对逆变器的影响，避免了电网阻抗改变重新进行实验测量逆变器阻抗的缺点，减少了工作的重复性，具有一定的可行性。
权利要求书clms
1.一种基于神经网络的并网逆变器序阻抗计算方法，所述并网逆变器序阻抗计算方法所涉及的拓扑结构包括并网逆变器、电网和序阻抗计算装置；所述序阻抗计算装置包括阻抗测量及计算单元和神经网络单元，所述阻抗测量及计算单元包括采样单元和计算单元，所述采样单元接入电网与并网逆变器相连接的公共耦合点PCC处，实现对公共耦合点PCC处电压和电流的采样，所述计算单元与采样单元的输出端相连接，所述神经网络单元与计算单元的输出端相连接；其特征在于，所述逆变器序阻抗计算方法在含有电网阻抗的并网逆变器基础上，测量不同短路比下的并网逆变器序阻抗，并进行神经网络结合测量阻抗进行训练，经过验证后得到用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，根据代理模型即可获得任一短路比下的并网逆变器序阻抗曲线，具体步骤如下：步骤1，记并网逆变器的基波频率为基频f1，设在阻抗测量过程中短路比测量范围为、频率测量范围为，其中Smin是短路比测量范围的下限，Smax是短路比测量范围的上限，fmin是频率测量范围的下限，fmax是频率测量范围的上限；在短路比测量范围内以s为等间隔进行测量短路比的设置，设共得到M个测量短路比，s为正整数，将M个测量短路比中的任一个测量短路比记为测量短路比SCRm，m为测量短路比的序号，m＝1,2,...,M，M为正整数；在频率测量范围内以f为等间隔进行测量采样频率点的设置，设共得到N个测量采样频率点，f为正整数，将N个测量采样频率点中的任一个记为测量采样频率点Γn，n为测量采样频率点的序号，n＝1,2,...,N，N为正整数；设在每个测量短路比SCRm下对每个测量采样频率点进行采样，即对M个测量短路比SCRm共进行了M×N次采样，将M×N次采样中的任意一次采样记为采样Υmn,与采样Υmn对应的频率记为阻抗测量频率fmn；将序阻抗计算装置接入公共耦合点PCC，并通过采样单元采样阻抗测量频率fmn时公共耦合点PCC处的三相线电压，并记为三相线电压Umn，采样阻抗测量频率fmn时公共耦合点PCC处的三相电流，并记为三相电流Imn；步骤2，将步骤1采样得到的三相线电压Umn，三相电流Imn送入计算单元，得到测量正序阻抗Ymn，并将测量正序阻抗Ymn的幅值记为正序阻抗幅值Fmn，将测量正序阻抗Ymn的相位记为正序阻抗相位θmn；步骤3，在短路比测量范围内以αs为等间隔进行训练短路比的设置，设共得到M'个训练短路比，α为正整数，将M'个训练短路比中的任一个记为训练短路比SCRo，o为训练短路比SCRo的序号，o＝1,2,...,M'，M'为正整数；将M个测量短路比SCRm中的M'个训练短路比以外的测量短路比SCRm重新命名为验证短路比SCRp，p为验证短路比SCRp的序号，p＝1,2,...,M-M'；在频率测量范围内以βf为间隔，进行训练采样频率点的设置，设共得到N'个训练采样频率点，β为正整数，将N'个训练采样频率点中的任一个记为训练采样频率点Γq，q为训练采样频率点的序号，q＝1,2,...,N',N'为正整数；将N个测量采样频率点Γn中的N'个训练采样频率点Γq以外的测量采样频率点Γn重新命名为验证采样频率点Γr，r为验证采样频率点Γr的序号，r＝1,2,...,N-N'；在M×N个采样Υmn中，将训练短路比SCRo下对训练采样频率点Γq的采样记为训练采样Υoq，与训练采样Υoq对应的阻抗测量频率fmn记为阻抗训练频率foq，阻抗训练频率foq对应的正序阻抗幅值Fmn记为训练正序阻抗幅值Foq，阻抗训练频率foq对应的正序阻抗相位θmn记为训练正序阻抗相位θoq；将M×N个阻抗测量频率fmn中的阻抗训练频率foq以外的阻抗测量频率fmn重新命名为阻抗验证频率fpr，阻抗验证频率fpr对应的正序阻抗幅值Fmn记为验证正序阻抗幅值Fpr，阻抗验证频率fpr对应的正序阻抗相位记为验证正序阻抗相位θpr；步骤4，将测量短路比SCRm、阻抗测量频率fmn、正序阻抗幅值Fmn，正序阻抗相位θmn输入神经网络单元，使用神经网络进行训练，经过验证后输出并网逆变器序阻抗代理模型，具体步骤如下：步骤4.1，初始化神经网络神经网络采用BP神经网络，由输入层，隐藏层和输出层三层构成，隐含层激活函数采用sigmoid函数其中v是隐含层的输入，令最大迭代次数为C，记C次迭代中任意一次迭代为第c次迭代，c＝1,2,...,C，C为正常数，初始化输入层到隐含层权值ωij，初始化隐含层阈值aj，初始化隐含层到输出层权值ωjk，初始化输出层阈值bk；步骤4.2，神经网络的训练将神经网络的输入记为神经网络输入x，神经网络输入x的第i个值记为xi，i＝1,2，可表示如下：x＝T其中x1为训练短路比SCRo，x2为阻抗训练频率foq；将神经网络的输出记为神经网络期望输出y，神经网络期望输出y的第k个值记为yk，k＝1,2，可表示如下：y＝T其中y1为训练正序阻抗幅值Foq，y2为训练正序阻抗相位θoq；对神经网络进行C次迭代，当迭代次数达到最大迭代次数C时结束迭代，得到待验证的神经网络，并记为神经网络G；步骤4.3，神经网络的验证将神经网络G的输入记为G验证输入h，验证输入h的第i个值记为hi，可表示如下：h＝T其中的h1为验证短路比SCRp，h2为阻抗验证频率fpr；神经网络G的输出为与验证短路比SCRp、阻抗验证频率fpr对应的正序阻抗幅值和正序阻抗相位，分别记为正序阻抗幅值预测输出F'pr和正序阻抗相位预测输出θ'pr；将神经网络G的相对误差记为相对误差REpr，相对误差REpr包括第一相对误差REpr1和第二相对误差REpr2，表达式分别如下：设定σ为验证阈值，σ为正常数，若|REpr1|和|REpr2|中的任一个大于σ％，重新设定学习速率η、隐含层的节点数l、最大迭代次数C，或者重新设置训练采样Υoq，然后重新执行步骤4；若|REpr1|和|REpr2|均小于σ％，该待验证的神经网络即为用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，并记为代理模型DL；步骤5，利用步骤4得到的代理模型DL，提取短路比测量范围内任一个短路比SCRε下的阻抗测量频率fmn、正序阻抗幅值Fmn、正序阻抗相位θmn的数据；以阻抗测量频率fmn为横轴，正序阻抗幅值Fmn为纵轴，在平面坐标系中绘制出一条Fmn-fmn曲线；以阻抗测量频率fmn为横轴，正序阻抗相位θmn为纵轴，在平面坐标系中绘制出一条θmn-fmn曲线。2.根据权利要求1所述的一种基于神经网络的并网逆变器序阻抗计算方法，其特征在于，步骤4.2中所述C次迭代中，第c次迭代的具体步骤如下：步骤4.2.1，根据神经网络的输入x，将第c次迭代的隐含层输出表示为：其中，j＝1,2,...,l且j是正整数，l是隐含层的节点数且l是正常数，为第c次迭代时输入层到隐含层的权值，为第c次迭代时输入层到隐含层的阈值；步骤4.2.2，根据第c次迭代的隐含层输出第c次迭代的输出层输出可表示为：其中，和分别是第c次迭代时隐含层到输出层权值和输出层阈值；步骤4.2.3，根据神经网络的期望输出y和第c次迭代的输出层输出第c次迭代的神经网络预测误差可表示为：步骤4.2.4，根据第c次迭代的神经网络预测误差得到第c+1次迭代的输入层到隐含层权值隐含层阈值隐含层到输出层权值和输出层阈值可表达如下：其中，η是学习速率，η是正常数；当迭代次数达到最大迭代次数C时结束迭代，得到待验证的神经网络。
说明书desc
技术领域本发明属于并网逆变器序阻抗计算领域，具体涉及一种基于神经网络对具有电网阻抗的并网逆变器进行序阻抗计算的方法。背景技术基于阻抗模型的并网系统稳定性分析，需要对并网逆变器进行阻抗建模获得其阻抗模型。但由于厂家出于商业技术保密的考虑，并网逆变器的内部结构、参数及控制方式等并没有直接给出。同时，随着光伏、风电等新能源大量的接入电网之中，电网呈现出高电网阻抗的弱电网特性。弱电网下，并网逆变器由于控制环节的作用，会在低频段产生明显的频率耦合现象。对于并网逆变器的阻抗模型辨识，目前已有大量文献进行了研究。例如：文献1“吴滨源,李建文,李永刚,王月,刘淇玉,孙伟.并网逆变器dq阻抗灰箱辨识方法与应用.中国电机工程学报,2022,42:1534-1546.”提出用递推最小二乘法对并网逆变器的dq阻抗进行辨识，并绘制辨识结果的回率矩阵特征函数奈奎斯特曲线进行谐波劣化风险评估，但是此方法应用于逆变器的dq阻抗辨识之中，也没有考虑电网阻抗改变对逆变器阻抗的影响。文献2“Zhang M,Wang X,Yang D,et al.Artificial Neural Network BasedIdentification of Multi-Operating-Point Impedance Model.IEEE Transactionson Power Electronics,2020:1-1.”提出用神经网络对采集的多个系统稳态工作点下的逆变器dq阻抗数据进行训练，建立起考虑工作点变化下的逆变器阻抗模型，但是没有考虑弱网下电网阻抗造成的频率耦合效应对逆变器阻抗模型的影响。综上所述，逆变器阻抗模型辨识方法的现有技术中存在以下不足：1、对并网逆变器的模型辨识是在dq坐标系下进行的，无法考虑电网阻抗对逆变器模型的影响。2、辨识出的模型没有考虑电网阻抗产生的频率耦合现象对逆变器的影响，而这一现象在低频段会尤为明显。发明内容针对上述逆变器阻抗模型辨识存在的不足，本发明提出基于神经网络的并网逆变器序阻抗计算方法。首先，在含有电网阻抗的并网逆变器基础上，测量不同短路比下的并网逆变器序阻抗，然后，使用神经网络结合测量阻抗进行训练，其次，经过验证后得到可用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，最后，根据代理模型即可获得任一短路比下的并网逆变器序阻抗曲线。为解决本发明的技术问题，本发明提供了一种基于神经网络的并网逆变器序阻抗计算方法，所述并网逆变器序阻抗计算方法所涉及的拓扑结构包括并网逆变器、电网和序阻抗计算装置；所述序阻抗计算装置包括阻抗测量及计算单元和神经网络单元，所述阻抗测量及计算单元包括采样单元和计算单元，所述采样单元接入电网与并网逆变器相连接的公共耦合点PCC处，实现对公共耦合点PCC处电压和电流的采样，所述计算单元与采样单元的输出端相连接，所述神经网络单元与计算单元的输出端相连接；所述逆变器序阻抗计算方法在含有电网阻抗的并网逆变器基础上，测量不同短路比下的并网逆变器序阻抗，并进行神经网络结合测量阻抗进行训练，经过验证后得到用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，根据代理模型即可获得任一短路比下的并网逆变器序阻抗曲线，具体步骤如下：步骤1，记并网逆变器的基波频率为基频f1，设在阻抗测量过程中短路比测量范围为、频率测量范围为，其中Smin是短路比测量范围的下限，Smax是短路比测量范围的上限，fmin是频率测量范围的下限，fmax是频率测量范围的上限；在短路比测量范围内以s为等间隔进行测量短路比的设置，设共得到M个测量短路比，s为正整数，将M个测量短路比中的任一个测量短路比记为测量短路比SCRm，m为测量短路比的序号，m＝1,2,...,M，M为正整数；在频率测量范围内以f为等间隔进行测量采样频率点的设置，设共得到N个测量采样频率点，f为正整数，将N个测量采样频率点中的任一个记为测量采样频率点Γn，n为测量采样频率点的序号，n＝1,2,...,N，N为正整数；设在每个测量短路比SCRm下对每个测量采样频率点进行采样，即对M个测量短路比SCRm共进行了M×N次采样，将M×N次采样中的任意一次采样记为采样Υmn,与采样Υmn对应的频率记为阻抗测量频率fmn；将序阻抗计算装置接入公共耦合点PCC，并通过采样单元采样阻抗测量频率fmn时公共耦合点PCC处的三相线电压，并记为三相线电压Umn，采样阻抗测量频率fmn时公共耦合点PCC处的三相电流，并记为三相电流Imn；步骤2，将步骤1采样得到的三相线电压Umn，三相电流Imn送入计算单元，得到测量正序阻抗Ymn，并将测量正序阻抗Ymn的幅值记为正序阻抗幅值Fmn，将测量正序阻抗Ymn的相位记为正序阻抗相位θmn；步骤3，在短路比测量范围内以αs为等间隔进行训练短路比的设置，设共得到M'个训练短路比，α为正整数，将M'个训练短路比中的任一个记为训练短路比SCRo，o为训练短路比SCRo的序号，o＝1,2,...,M'，M'为正整数；将M个测量短路比SCRm中的M'个训练短路比以外的测量短路比SCRm重新命名为验证短路比SCRp，p为验证短路比SCRp的序号，p＝1,2,...,M-M'；在频率测量范围内以βf为间隔，进行训练采样频率点的设置，设共得到N'个训练采样频率点，β为正整数，将N'个训练采样频率点中的任一个记为训练采样频率点Γq，q为训练采样频率点的序号，q＝1,2,...,N',N'为正整数；将N个测量采样频率点Γn中的N'个训练采样频率点Γq以外的测量采样频率点Γn重新命名为验证采样频率点Γr，r为验证采样频率点Γr的序号，r＝1,2,...,N-N'；在M×N个采样Υmn中，将训练短路比SCRo下对训练采样频率点Γq的采样记为训练采样Υoq，与训练采样Υoq对应的阻抗测量频率fmn记为阻抗训练频率foq，阻抗训练频率foq对应的正序阻抗幅值Fmn记为训练正序阻抗幅值Foq，阻抗训练频率foq对应的正序阻抗相位θmn记为训练正序阻抗相位θoq；将M×N个阻抗测量频率fmn中的阻抗训练频率foq以外的阻抗测量频率fmn重新命名为阻抗验证频率fpr，阻抗验证频率fpr对应的正序阻抗幅值Fmn记为验证正序阻抗幅值Fpr，阻抗验证频率fpr对应的正序阻抗相位记为验证正序阻抗相位θpr；步骤4，将测量短路比SCRm、阻抗测量频率fmn、正序阻抗幅值Fmn，正序阻抗相位θmn输入神经网络单元，使用神经网络进行训练，经过验证后输出并网逆变器序阻抗代理模型，具体步骤如下：步骤4.1，初始化神经网络神经网络采用BP神经网络，由输入层，隐藏层和输出层三层构成，隐含层激活函数采用sigmoid函数其中v是隐含层的输入，令最大迭代次数为C，记C次迭代中任意一次迭代为第c次迭代，c＝1,2,...,C，C为正常数，初始化输入层到隐含层权值ωij，初始化隐含层阈值aj，初始化隐含层到输出层权值ωjk，初始化输出层阈值bk；步骤4.2，神经网络的训练将神经网络的输入记为神经网络输入x，神经网络输入x的第i个值记为xi，i＝1,2，可表示如下：x＝T其中x1为训练短路比SCRo，x2为阻抗训练频率foq；将神经网络的输出记为神经网络期望输出y，神经网络期望输出y的第k个值记为yk，k＝1,2，可表示如下：y＝T其中y1为训练正序阻抗幅值Foq，y2为训练正序阻抗相位θoq；对神经网络进行C次迭代，当迭代次数达到最大迭代次数C时结束迭代，得到待验证的神经网络，并记为神经网络G；步骤4.3，神经网络的验证将神经网络G的输入记为G验证输入h，验证输入h的第i个值记为hi，可表示如下：h＝T其中的h1为验证短路比SCRp，h2为阻抗验证频率fpr；神经网络G的输出为与验证短路比SCRp、阻抗验证频率fpr对应的正序阻抗幅值和正序阻抗相位，分别记为正序阻抗幅值预测输出F'pr和正序阻抗相位预测输出θ'pr；将神经网络G的相对误差记为相对误差REpr，相对误差REpr包括第一相对误差REpr1和第二相对误差REpr2，表达式分别如下：设定σ为验证阈值，σ为正常数，若|REpr1|和|REpr2|中的任一个大于σ％，重新设定学习速率η、隐含层的节点数l、最大迭代次数C，或者重新设置训练采样Υoq，然后重新执行步骤4；若|REpr1|和|REpr2|均小于σ％，该待验证的神经网络即为用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，并记为代理模型DL；步骤5，利用步骤4得到的代理模型DL，提取短路比测量范围内任一个短路比SCRε下的阻抗测量频率fmn、正序阻抗幅值Fmn、正序阻抗相位θmn的数据；以阻抗测量频率fmn为横轴，正序阻抗幅值Fmn为纵轴，在平面坐标系中绘制出一条Fmn-fmn曲线；以阻抗测量频率fmn为横轴，正序阻抗相位θmn为纵轴，在平面坐标系中绘制出一条θmn-fmn曲线。优选地，步骤4.2中所述C次迭代中，第c次迭代的具体步骤如下：步骤4.2.1，根据神经网络的输入x，将第c次迭代的隐含层输出表示为：其中，j＝1,2,...,l且j是正整数，l是隐含层的节点数且l是正常数，为第c次迭代时输入层到隐含层的权值，为第c次迭代时输入层到隐含层的阈值；步骤4.2.2，根据第c次迭代的隐含层输出第c次迭代的输出层输出可表示为：其中，和分别是第c次迭代时隐含层到输出层权值和输出层阈值；步骤4.2.3，根据神经网络的期望输出y和第c次迭代的输出层输出第c次迭代的神经网络预测误差可表示为：步骤4.2.4，根据第c次迭代的神经网络预测误差得到第c+1次迭代的输入层到隐含层权值隐含层阈值隐含层到输出层权值和输出层阈值可表达如下：其中，η是学习速率，η是正常数；当迭代次数达到最大迭代次数C时结束迭代，得到待验证的神经网络。本发明的基于神经网络的并网逆变器序阻抗计算方法，其有益效果具体体现如下：1)考虑电网阻抗的逆变器序阻抗建模，将电网阻抗纳入序阻抗建模之中，能够反映电网阻抗变化对逆变器的影响。2)训练好的神经网络即代理模型可以获取训练范围内任意短路比任意频率的阻抗信息，避免了电网阻抗改变，重新进行实验测量逆变器阻抗的缺点，减少了工作的重复性。附图说明图1为本发明所涉及的拓扑图。图2为本发明方法的流程图。图3为本发明采用的BP神经网络结构图。图4为神经网络的正序阻抗幅值训练数据集示意图。图5为神经网络的正序阻抗相位训练数据集示意图。图6为代理模型中的正序阻抗幅值示意图。图7为代理模型中的正序阻抗相位示意图图8为第一相对误差示意图。图9为第二相对误差示意图。图10为短路比SCRε＝6的正序阻抗幅值示意图。图11为短路比SCRε＝6的正序阻抗相位示意图。具体实施方式以下结合附图，对本发明进行进一步详细说明。图1所示为本发明基于神经网络的并网逆变器序阻抗计算方法所涉及的拓扑图。由图1可见，所述并网逆变器序阻抗计算方法所涉及的拓扑结构包括并网逆变器10、电网40和序阻抗计算装置；所述序阻抗计算装置包括阻抗测量及计算单元20和神经网络单元30；所述阻抗测量及计算单元20包括采样单元201和计算单元202，所述采样单元201接入电网40与并网逆变器10相连接的公共耦合点PCC处，实现对公共耦合点PCC处电压和电流的采样，所述计算单元202与采样单元201的输出端相连接，所述神经网络单元30与计算单元202的输出端相连接。图2为本发明方法的流程图。由该图可见，本发明是一种基于神经网络的并网逆变器序阻抗计算方法，所述逆变器序阻抗计算方法在含有电网阻抗的并网逆变器基础上，测量不同短路比下的并网逆变器序阻抗，并进行神经网络结合测量阻抗进行训练，经过验证后得到用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，根据代理模型即可获得任一短路比下的并网逆变器序阻抗曲线，具体步骤如下：步骤1，记并网逆变器的基波频率为基频f1，设在阻抗测量过程中短路比测量范围为、频率测量范围为，其中Smin是短路比测量范围的下限，Smax是短路比测量范围的上限，fmin是频率测量范围的下限，fmax是频率测量范围的上限。在短路比测量范围内以s为等间隔进行测量短路比的设置，设共得到M个测量短路比，s为正整数，将M个测量短路比中的任一个测量短路比记为测量短路比SCRm，m为测量短路比的序号，m＝1,2,...,M，M为正整数；在频率测量范围内以f为等间隔进行测量采样频率点的设置，设共得到N个测量采样频率点，f为正整数，将N个测量采样频率点中的任一个记为测量采样频率点Γn，n为测量采样频率点的序号，n＝1,2,...,N，N为正整数。设在每个测量短路比SCRm下对每个测量采样频率点进行采样，即对M个测量短路比SCRm共进行了M×N次采样，将M×N次采样中的任意一次采样记为采样Υmn,与采样Υmn对应的频率记为阻抗测量频率fmn。将序阻抗计算装置接入公共耦合点PCC，并通过采样单元201采样阻抗测量频率fmn时公共耦合点PCC处的三相线电压，并记为三相线电压Umn，采样阻抗测量频率fmn时公共耦合点PCC处的三相电流，并记为三相电流Imn。在本实施例中，短路比测量范围为，取s＝0.05则M＝61，频率测量范围为，取f＝0.5则N＝299，基频f1＝50。步骤2，将步骤1采样得到的三相线电压Umn，三相电流Imn送入计算单元202，得到测量正序阻抗Ymn，并将测量正序阻抗Ymn的幅值记为正序阻抗幅值Fmn，将测量正序阻抗Ymn的相位记为正序阻抗相位θmn。步骤3，在短路比测量范围内以αs为等间隔进行训练短路比的设置，设共得到M'个训练短路比，α为正整数，将M'个训练短路比中的任一个记为训练短路比SCRo，o为训练短路比SCRo的序号，o＝1,2,...,M'，M'为正整数；将M个测量短路比SCRm中的M'个训练短路比以外的测量短路比SCRm重新命名为验证短路比SCRp，p为验证短路比SCRp的序号，p＝1,2,...,M-M'。在频率测量范围内以βf为间隔，进行训练采样频率点的设置，设共得到N'个训练采样频率点，β为正整数，将N'个训练采样频率点中的任一个记为训练采样频率点Γq，q为训练采样频率点的序号，q＝1,2,...,N',N'为正整数；将N个测量采样频率点Γn中的N'个训练采样频率点Γq以外的测量采样频率点Γn重新命名为验证采样频率点Γr，r为验证采样频率点Γr的序号，r＝1,2,...,N-N'。在M×N个采样Υmn中，将训练短路比SCRo下对训练采样频率点Γq的采样记为训练采样Υoq，与训练采样Υoq对应的阻抗测量频率fmn记为阻抗训练频率foq，阻抗训练频率foq对应的正序阻抗幅值Fmn记为训练正序阻抗幅值Foq，阻抗训练频率foq对应的正序阻抗相位θmn记为训练正序阻抗相位θoq；将M×N个阻抗测量频率fmn中的阻抗训练频率foq以外的阻抗测量频率fmn重新命名为阻抗验证频率fpr，阻抗验证频率fpr对应的正序阻抗幅值Fmn记为验证正序阻抗幅值Fpr，阻抗验证频率fpr对应的正序阻抗相位记为验证正序阻抗相位θpr。在本实施例中，α＝4，β＝4。步骤4，将测量短路比SCRm、阻抗测量频率fmn、正序阻抗幅值Fmn，正序阻抗相位θmn输入神经网络单元30，使用神经网络进行训练，经过验证后输出并网逆变器序阻抗代理模型，具体步骤如下：步骤4.1，初始化神经网络神经网络采用BP神经网络，由输入层，隐藏层和输出层三层构成，隐含层激活函数采用sigmoid函数其中v是隐含层的输入，令最大迭代次数为C，记C次迭代中任意一次迭代为第c次迭代，c＝1,2,...,C，C为正常数，初始化输入层到隐含层权值ωij，初始化隐含层阈值aj，初始化隐含层到输出层权值ωjk，初始化输出层阈值bk；在本实施例中，C＝1000。步骤4.2，神经网络的训练将神经网络的输入记为神经网络输入x，神经网络输入x的第i个值记为xi，i＝1,2，可表示如下：x＝T其中x1为训练短路比SCRo，x2为阻抗训练频率foq；将神经网络的输出记为神经网络期望输出y，神经网络期望输出y的第k个值记为yk，k＝1,2，可表示如下：y＝T其中y1为训练正序阻抗幅值Foq，y2为训练正序阻抗相位θoq；对神经网络进行C次迭代，当迭代次数达到最大迭代次数C时结束迭代，得到待验证的神经网络，并记为神经网络G；步骤4.3，神经网络的验证将神经网络G的输入记为G验证输入h，验证输入h的第i个值记为hi，可表示如下：h＝T其中的h1为验证短路比SCRp，h2为阻抗验证频率fpr；神经网络G的输出为与验证短路比SCRp、阻抗验证频率fpr对应的正序阻抗幅值和正序阻抗相位，分别记为正序阻抗幅值预测输出F'pr和正序阻抗相位预测输出θ'pr；将神经网络G的相对误差记为相对误差REpr，相对误差REpr包括第一相对误差REpr1和第二相对误差REpr2，表达式分别如下：设定σ为验证阈值，σ为正常数，若|REpr1|和|REpr2|中的任一个大于σ％，重新设定学习速率η、隐含层的节点数l、最大迭代次数C，或者重新设置训练采样Υoq，然后重新执行步骤4；若|REpr1|和|REpr2|均小于σ％，该待验证的神经网络即为用于获取电网阻抗连续变化下的逆变器序阻抗的代理模型，并记为代理模型DL；在本实施例中，取σ＝5。步骤5，利用步骤4得到的代理模型DL，提取短路比测量范围内任一个短路比SCRε下的阻抗测量频率fmn、正序阻抗幅值Fmn、正序阻抗相位θmn的数据；以阻抗测量频率fmn为横轴，正序阻抗幅值Fmn为纵轴，在平面坐标系中绘制出一条Fmn-fmn曲线；以阻抗测量频率fmn为横轴，正序阻抗相位θmn为纵轴，在平面坐标系中绘制出一条θmn-fmn曲线。在本实施例中，取SCRε＝6。在步骤4.2中所述C次迭代中，第c次迭代的具体步骤如下：步骤4.2.1，根据神经网络的输入x，将第c次迭代的隐含层输出表示为：其中，j＝1,2,...,l且j是正整数，l是隐含层的节点数且l是正常数，为第c次迭代时输入层到隐含层的权值，为第c次迭代时输入层到隐含层的阈值；步骤4.2.2，根据第c次迭代的隐含层输出第c次迭代的输出层输出可表示为：其中，和分别是第c次迭代时隐含层到输出层权值和输出层阈值；步骤4.2.3，根据神经网络的期望输出y和第c次迭代的输出层输出第c次迭代的神经网络预测误差可表示为：步骤4.2.4，根据第c次迭代的神经网络预测误差得到第c+1次迭代的输入层到隐含层权值隐含层阈值隐含层到输出层权值和输出层阈值可表达如下：其中，η是学习速率，η是正常数。当迭代次数达到最大迭代次数C时结束迭代，得到待验证的神经网络。在本实施例中，隐含层的节点数l＝5，学习速率η＝0.01。图3是本发明采用的BP神经网络结构图，x1和x2是神经网络的输入，y1和y2是神经网络的输出，ωij是输入层到隐含层的权值，aj是隐含层阈值，ωjk是隐含层到输出层的权值，bk是输出层阈值。图4是神经网络的正序阻抗幅值训练数据集示意图，横坐标是阻抗测量频率fmn，纵坐标是测量短路比SCRm，竖坐标是正序阻抗幅值Fmn。图5是神经网络的正序阻抗相位训练数据集示意图，横坐标是阻抗测量频率fmn，纵坐标是测量短路比SCRm，竖坐标是正序阻抗相位θmn。图6是代理模型中的正序阻抗幅值示意图，横坐标是阻抗测量频率fmn，纵坐标是测量短路比SCRm，竖坐标是正序阻抗幅值Fmn。图7是代理模型中的正序阻抗相位示意图，横坐标是阻抗测量频率fmn，纵坐标是测量短路比SCRm，竖坐标是正序阻抗相位θmn。图8是第一相对误差示意图，横坐标是阻抗测量频率fmn，纵坐标是测量短路比SCRm，竖坐标是第一相对误差REpr1。图9是第二相对误差示意图，横坐标是阻抗测量频率fmn，纵坐标是测量短路比SCRm，竖坐标是第二相位相对误差REpr2。从图8、图9可以看出，二个相对误差的绝对值均小于5％，满足预设要求。图10是短路比SCRε＝6的正序阻抗幅值示意图，横坐标是阻抗测量频率fmn，纵坐标是正序阻抗幅值Fmn，图11是短路比SCRε＝6的正序阻抗相位示意图，横坐标是阻抗测量频率fmn，纵坐标是正序阻抗相位θmn，代理模型可以用来获取电网阻抗连续变化下的逆变器序阻抗，具有一定的可行性。
