标题title
基于因果推断的多步攻击检测方法、装置及设备
摘要abst
本发明涉及攻击检测技术领域，其实施方式提供了一种基于因果推断的多步攻击检测方法、装置及设备。其中，一种基于因果推断的多步攻击检测方法，包括：将所述告警样本集合中满足时间聚合度的告警样本聚合为超级告警，并根据超级告警的时序进行分区；根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表；将检测事件与预设时间段内的历史事件组合后，在所述第一概率表和所述第二概率表中进行匹配，根据匹配结果得到所述检测事件的检测结果。本发明提供的实施方式能够提升多步攻击检测的效率和准确性。
权利要求书clms
1.一种基于因果推断的多步攻击检测方法，其特征在于，该方法包括：获取告警样本集合；将所述告警样本集合中满足时间聚合度的告警样本聚合为超级告警，并根据超级告警的时序进行分区；根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表；将检测事件与预设时间段内的历史事件组合后，在所述第一概率表和所述第二概率表中进行匹配，根据匹配结果得到所述检测事件的检测结果。2.根据权利要求1所述的方法，其特征在于，根据超级告警的时序进行分区，包括：判断默认分区数、预设时间窗口和所述告警样本集合的时间跨度是否满足预设关系；在满足预设关系时，以所述默认分区数对所述告警样本集合中的数据进行分区；在不满足预设关系时，调整所述默认分区数，以调整后的默认分区数对所述告警样本集合中的数据进行分区。3.根据权利要求2所述的方法，其特征在于，根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表，包括：对分区内的数据进行排序；计算所有攻击类型每个特征的值域；遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率；将根据所述发生概率确定出的攻击类型组合写入第一概率表；将所述第一概率表中的概率发生突变的攻击类型组合写入第二概率表。4.根据权利要求2所述的方法，其特征在于，所述方法还包括：计算分区平均数据量和每个分区的数据量；如果当前分区的数据量＞分区平均数据量*M，M为大于1的实数，则以分区平均数据量*M/当前分区数据量作为抽样比例，对当前分区进行无放回的抽样。5.根据权利要求3所述的方法，其特征在于，遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率，包括：获取第一攻击类型的所有特征组合，计算其在第二攻击类型的值域内发生的频率，记为AFdomain；其中F为某一特征组合；计算在预设时间段内，满足第一攻击类型和第二攻击类型的时序关系以及F满足相似度要求的第一攻击类型的事件个数，记为ABFdomain；以条件概率P)=ABFdomain/ AFdomain，作为第一攻击类型和第二攻击类型组成的攻击类型组合的发生概率。6.根据权利要求3所述的方法，其特征在于，将根据所述发生概率确定出的攻击类型组合写入第一概率表，包括：多轮迭代计算多个特征组合下的攻击类型组合；根据预设阈值筛选出每轮中的多个特征组合下的攻击类型组合；对得到的攻击类型组合进行合并，取特征组合个数最多的攻击类型组合写入第一概率表。7.根据权利要求6所述的方法，其特征在于，所述方法还包括：构建复合数据结构以标识匹配过程；所述复合数据结构中包括：事件标识、事件发生时间、序列内事件的最新时间以及是否对比标识。8.一种基于因果推断的多步攻击检测装置，其特征在于，该装置包括：样本获取模块，用于获取告警样本集合；聚合分区模块，用于将所述告警样本集合中满足时间聚合度的告警样本聚合为超级告警，并根据超级告警的时序进行分区；概率建立模块，用于根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表；以及事件检测模块，用于将检测事件与预设时间段内的历史事件组合后，在所述第一概率表和所述第二概率表中进行匹配，根据匹配结果得到所述检测事件的检测结果。9.一种电子设备，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至7中任一项权利要求所述的基于因果推断的多步攻击检测方法的步骤。10.一种计算机可读存储介质，所述存储介质中存储有指令，当其在计算机上运行时，使得计算机执行权利要求1至7中任一项权利要求所述的基于因果推断的多步攻击检测方法的步骤。
说明书desc
技术领域本发明涉及数据处理技术领域，具体地涉及一种基于因果推断的多步攻击检测方法、一种基于因果推断的多步攻击检测装置、一种电子设备以及一种计算机可读存储介质。背景技术网络攻击中，为到达攻击目的，通常采用一系列的多步攻击方式，例如ATT&amp;CK模型认为在不同的攻击阶段会采用不同的攻击手段，存在一定的时序和因果关系，触发不同的告警事件，针对此类威胁的检测形式称为事件关联。目前多步攻击行为检测方案通常有以下几种思路：基于属性的事件关联分析：基于属性特征的关联分析技术是指从事件自身的角度出发，分析属性之间的关联依赖关系，根据事件属性对其进行匹配检测。此类方法依赖于专家知识，无法对未知问题进行有效关联。基于逻辑推理的事件关联分析：从事件之间的关联关系出发，合理选择和有效运用相关知识，利用专家知识进行推断。但推理控制策略的设计对人要求太高，效率低。基于统计的事件关联分析：从事件发生概率和统计数据角度出发，对报警信息间的关系以概率形式进行刻画，揭示网络安全事件的时序和因果关系。但是事件之间统计需要大量的计算，且对未知的攻击方式和存在大量冗余报警的事件集合的关联效果较差。基于机器学习的事件关联分析：应用机器学习的方法训练数据集，生成事件关联规则。缺点在算法是黑箱的，需要大量的样本调试，无法评价对新类型攻击的效果。但是以上多种方案均存在不同的问题，例如：在不依赖于专家知识的基础上，同时不要求大量的线下样本，能够在线学习，识别新的多步攻击行为。基于统计的方案，需要对事件对大量对比计算，开销通常较大，在一定时限内，甚至是无法完成计算。超级告警：基于告警检测系统原始告警，对五元组相同的事件，将中断时间未超过时间窗口的事件合并为一个事件，即为超级告警。发明内容本发明实施例的目的是提供一种基于因果推断的多步攻击检测与解压方法、装置及设备，以提升多步攻击检测的识别效率和准确性。为了实现上述目的，本发明的第一方面提供了一种基于因果推断的多步攻击检测方法，包括：获取告警样本集合；将所述告警样本集合中满足时间聚合度的告警样本聚合为超级告警，并根据超级告警的时序进行分区；根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表；将检测事件与预设时间段内的历史事件组合后，在所述第一概率表和所述第二概率表中进行匹配，根据匹配结果得到所述检测事件的检测结果。优选的，根据超级告警的时序进行分区，包括：判断默认分区数、预设时间窗口和所述告警样本集合的时间跨度是否满足预设关系；在满足预设关系时，以所述默认分区数对所述告警样本集合中的数据进行分区；在不满足预设关系时，调整所述默认分区数，以调整后的默认分区数对所述告警样本集合中的数据进行分区。优选的，根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表，包括：对分区内的数据进行排序；计算所有攻击类型每个特征的值域；遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率；将根据所述发生概率确定出的攻击类型组合写入第一概率表；将所述第一概率表中的概率发生突变的攻击类型组合写入第二概率表。优选的，所述方法还包括：计算分区平均数据量和每个分区的数据量，如果当前分区的数据量＞分区平均数据量*M，M为大于1的实数；则以分区平均数据量*M/当前分区数据量作为抽样比例，对当前分区进行无放回的抽样。优选的，遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率，包括：获取第一攻击类型的所有特征组合，计算其在第二攻击类型的值域内发生的频率，记为AFdomain；其中F为某一特征组合；计算在预设时间段内，满足第一攻击类型和第二攻击类型的时序关系以及F满足相似度要求的第一攻击类型的事件个数，记为ABFdomain；以条件概率P) =ABFdomain/ AFdomain，作为第一攻击类型和第二攻击类型组成的攻击类型组合的发生概率。优选的，将根据所述发生概率确定出的攻击类型组合写入第一概率表，包括：多轮迭代计算多个特征组合下的攻击类型组合；根据预设阈值筛选出每轮中的多个特征组合下的攻击类型组合；对得到的攻击类型组合进行合并，取特征组合个数最多的攻击类型组合写入第一概率表。优选的，所述方法还包括：构建复合数据结构以标识匹配过程；所述复合数据结构中包括：事件标识、事件发生时间、序列内事件的最新时间以及是否对比标识。在本发明的第二方面，还提供了一种基于因果推断的多步攻击检测装置，该装置包括：样本获取模块，用于获取告警样本集合；聚合分区模块，用于将所述告警样本集合中满足时间聚合度的告警样本聚合为超级告警，并根据超级告警的时序进行分区；概率建立模块，用于根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表；以及事件检测模块，用于将检测事件与预设时间段内的历史事件组合后，在所述第一概率表和所述第二概率表中进行匹配，根据匹配结果得到所述检测事件的检测结果。在本发明的第三方面，还提供了一种电子设备，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现前述的基于因果推断的多步攻击检测方法的步骤。在本发明的第四方面，还提供了一种计算机可读存储介质，所述存储介质中存储有指令，当其在计算机上运行时，使得计算机执行前述的基于因果推断的多步攻击检测方法的步骤。本发明的第五方面提供一种计算机程序产品，包括计算机程序，该计算机程序在被处理器执行时实现前述的基于因果推断的多步攻击检测方法。上述技术方案至少具有以下有益效果：针对全部N特征，算法动态遍历1到N个特征数组合，选取了最大组合特征数的攻击模式，降低了误报概率；对于最大特征组合数，保留了对应的所有特征组合，最大程度减少了漏报。根据多步攻击的时序特点，同一告警事件集时间上是相近的，通过“分区+边界二次计算”的方式，实现算法的分布式计算；同时对密度过高的分区抽样，实现在大规模数据集快速并行计算。本发明实施例的其它特征和优点将在随后的具体实施方式部分予以详细说明。附图说明附图是用来提供对本发明实施例的进一步理解，并且构成说明书的一部分，与下面的具体实施方式一起用于解释本发明实施例，但并不构成对本发明实施例的限制。在附图中：图1示意性示出了根据本发明实施方式的基于因果推断的多步攻击检测方法的实施示意图；图2示意性示出了根据本发明实施方式的第一概率表的构建示意图；图3示意性示出了根据本发明实施方式的基于因果推断的多步攻击检测装置的结构示意图。具体实施方式以下结合附图对本发明实施例的具体实施方式进行详细说明。应当理解的是，此处所描述的具体实施方式仅用于说明和解释本发明实施例，并不用于限制本发明实施例。图1示意性示出了根据本发明实施方式的基于因果推断的多步攻击检测方法的实施示意图。如图1所示，一种基于因果推断的多步攻击检测方法，该方法包括：S01、获取告警样本集合；该告警样本集合中的告警为原始告警，数据来源包括但不限于大数据源、在线采集或海量数据分析结果。S02、将所述告警样本集合中满足时间聚合度的告警样本聚合为超级告警，并根据超级告警的时序进行分区；如果告警样本的属性相同，且间隔小于时间窗口T1，则合并为超级告警。告警样本集合中的第一个告警样本的发生时间记为start_time，最后一个超级告警时间记为end_time。S03、根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表；本步骤中的分布特征以及概率计算均根据因果关系，因果关系采用贝叶斯推断的思想。当时间窗内事件类型A发生的条件下类型B发生的条件概率满足一定阈值Threshold1，说明A是B发生的前置条件，以基于特征的相似度作为类型A是类型B发生原因的可信度。S04、将检测事件与预设时间段内的历史事件组合后，在所述第一概率表和所述第二概率表中进行匹配，根据匹配结果得到所述检测事件的检测结果。检测事件产生后，以流式或者定时读取方式，获取最近的时间窗口的相关事件，每次取新事件后按照事件窗口进行更新，同时标记新进入的事件；对于一个检测事件，将早于发生时间且在时间窗口内其他事件与该事件两两组合。以该组合分别在第一概率表和第二概率表找出其对应的所有特征规则组合，根据特征组合得到对应的检测结果。以上实施方式，采用统计的手段，基于贝叶斯推断挖掘告警类型的因果关系，同时通过属性相等或相似关系，选择最强的因果关系组合，此外通过概率突增的变化识别新的因果关系；在实现方面，基于分区方式，首先根据分区密度对样本抽样，然后将全局因果关系计算，转化为分区计算加二次边界分区计算两步完成，并进行N轮计算，得到不同强度的依赖条件，然后选择特征个数最大的依赖条件集，最后在线告警事件与攻击模式匹配，检测出多步攻击。在本发明提供的一些实施方式中，根据超级告警的时序进行分区，包括：判断默认分区数、预设时间窗口和所述告警样本集合的时间跨度是否满足预设关系；在满足预设关系时，以所述默认分区数对所述告警样本集合中的数据进行分区；在不满足预设关系时，调整所述默认分区数，以调整后的默认分区数对所述告警样本集合中的数据进行分区。具体的，设默认分区数为partition_num，数据的时间跨度为All_time，预设时间窗口为T2，执行以下判断：若预设时间窗口T2大于frac×，则减少分区数，使其满足T2≈frac*，其中partition_num_new为新的分区数；否则默认分区数不变，式中的frac为0-1之间的小数。在本发明提供的一些实施方式中，根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表，包括：对分区内的数据进行排序；计算所有攻击类型每个特征的值域；遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率；将根据所述发生概率确定出的攻击类型组合写入第一概率表；将所述第一概率表中的概率发生突变的攻击类型组合写入第二概率表。本实施方式采用了分区计算的方式。遍历每个分区数据，对每一条数据，针对其告警类型，判断是否在其他告警类型的每个特征的值域内，是则记为1，否则为0，最后全局数据汇总相加，得出所有攻击类型对的每个特征对应的AFdomain；基于事件时间窗口T2，首先计算各分区内的ABFdomain，其中各分区内的结果，先不统计数据，暂时记为集合，然后汇总分区结果，对集合union。计算分区ABFdomain时，分区尾部的数据无法确定是否计算完毕，将各分区尾部数据拿出来，广播出去，与相邻的下一个分区数据进行二次对比，同样用集合表示，计算完毕后汇总。汇总前述步骤中的结果，合并集合，计算集合数量，过滤出大于minMumOfABF的，得到最终的频率ABFdomain。结合前述步骤得到的结果，相同攻击类型组合AB的频率相除，得出P)，大于阈值Threshold1筛选后，得出特征组合个数为1情况下，攻击类型组合AB的攻击模式。在前述步骤的基础上，逐层迭代计算更多特征组合下的攻击模式，在第N次迭代中，用上一次概率大于等于阈值Threshold2的特征组合，攻击类型对相同情况下，与第一次所有大于等于阈值Threshold2的单特征组合，作为本轮中ABF的计算的所有特征组合，重复前述步骤得出N个特征组合下的攻击模式；当N达到最大特征组合个数maxNumOfFeaturesCombine时终止；然后对1至N轮的结果进行合并，对所有的AB攻击模式，取特征组合个数最多的攻击模式作为AB类型的攻击模式，存入第一概率表，可命名为alertTypeCorTable表，该表的关键字段包括：攻击类型A、攻击类型B、特征组合的集合和条件概率。图2示意性示出了根据本发明实施方式的第一概率表的构建示意图。如图2所示，通过以上方式能够得到第一概率表。在第一概率表alertTypeCorTable基础上，检测攻击类型概率是否发生突变，对突变的攻击类型A，重新计算攻击类型组合AX相关条件概率，X为其他任意攻击类型，具体如下：取最近时间段N内的超级告警，时间段N大于时间窗口T2，同时大于流程2的计算间隔；统计超级告警发生的概率；与alertTypeCorTable表对比，如果是攻击类型的概率增加超过J倍，重新计算以此攻击类型为条件的攻击对模式，同时加上新出现攻击模式与已知攻击模式组合，以攻击类型组合为范围，重新计算流程1，结果存入临时概率表TempAlertTypeCorTable，即第二概率表，每次计算只对此表进行更新或新增。为了使分区内的数据量保持均衡，在一些实施方式中，所述方法还包括：计算分区平均数据量和每个分区的数据量，如果当前分区的数据量＞分区平均数据量*M，M为大于1的实数；则以分区平均数据量*M/当前分区数据量作为抽样比例，对当前分区进行无放回的抽样。在本发明提供的一些实施方式中，遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率，包括：获取第一攻击类型的所有特征组合，计算其在第二攻击类型的值域内发生的频率，记为AFdomain；其中F为某一特征组合；计算在预设时间段内，满足第一攻击类型和第二攻击类型的时序关系以及F满足相似度要求的第一攻击类型的事件个数，记为ABFdomain；以条件概率P) =ABFdomain/ AFdomain，作为第一攻击类型和第二攻击类型组成的攻击类型组合的发生概率。本实施方式提供了前述的AFdomain等参数的计算方式。具体的，对攻击类型B，计算攻击类型的每个特征的值域，记为domain，fj代表第j个特征；对攻击类型A，关于所有特征组合，计算在攻击类型B值域domain内攻击类型A发生的频率，记为AFdomain，其中F为某一特征组合；计算在时间窗口T2内，当B＞=A，B＞=A+T2,且F中每个属性相等的类型A的事件个数，记为ABFdomain；条件概率P) =ABFdomain/ AFdomain，大于等于阈值Threshold1，则表示在特征组合F情况下，A是B的发生的原因，有序组合AB记为一对攻击类型组合。在本发明提供的一些实施方式中，所述方法还包括：构建复合数据结构以标识匹配过程；所述复合数据结构中包括：事件标识、事件发生时间、序列内事件的最新时间以及是否对比标识。具体的，多步攻击检测结果存储在复合数据结构中，其中每个元素为一个多步攻击结果，而每个多步攻击检测结果包含原始事件的攻击序列，序列中元素包括每个告警时间的唯一标识和发生时间、其中序列内告警的最新时间update_time、是否对比标识compare_flag。多步攻击生成过程：对第一概率表和第二概率表中匹配命中的攻击类型组合，记为ab，对比compare_flag==1的已知的攻击序列，如果攻击类型a是在已知的攻击序列，且ab在时间窗口T2内，在攻击类型b加入a所在的序列，如果不在，则新建多步攻击序列，新建compare_flag==1。本实施方式还包括更新compare_flag的步骤，每轮新数据计算前，如果update_time已经不在新数据最小告警时间的窗口T2内则失效，多步攻击序列将不再更新，compare_flag更新为0。基于同一发明构思，本发明还提供了一种基于因果推断的多步攻击检测装置。图3示意性示出了根据本发明实施方式的基于因果推断的多步攻击检测装置的结构示意图。如图3所示，一种基于因果推断的多步攻击检测装置，包括：样本获取模块，用于获取告警样本集合；聚合分区模块，用于将所述告警样本集合中满足时间聚合度的告警样本聚合为超级告警，并根据超级告警的时序进行分区；概率建立模块，用于根据分区、所述分区的下一分区以及两者的分区边界在时间窗口内与攻击类型的特征相关的数据的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表；以及事件检测模块，用于将检测事件与预设时间段内的历史事件组合后，在所述第一概率表和所述第二概率表中进行匹配，根据匹配结果得到所述检测事件的检测结果。在一些可选实施方式中，根据超级告警的时序进行分区，包括：判断默认分区数、预设时间窗口和所述告警样本集合的时间跨度是否满足预设关系；在满足预设关系时，以所述默认分区数对所述告警样本集合中的数据进行分区；在不满足预设关系时，调整所述默认分区数，以调整后的默认分区数对所述告警样本集合中的数据进行分区。在一些可选实施方式中，所根据分区内的与攻击类型的特征相关的告警样本的分布特征，构建攻击类型组合所对应的第一概率表和第二概率表，包括：对分区内的数据进行排序；计算所有攻击类型每个特征的值域；遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率；将根据所述发生概率确定出的攻击类型组合写入第一概率表；将所述第一概率表中的概率发生突变的攻击类型组合写入第二概率表。在一些可选实施方式中，所述方法还包括：计算分区平均数据量和每个分区的数据量，如果当前分区的数据量＞分区平均数据量*M，M为大于1的实数；则以分区平均数据量*M/当前分区数据量作为抽样比例，对当前分区进行无放回的抽样。在一些可选实施方式中，遍历每个分区数据，根据每条数据是否在其它告警类型的每个特征的值域内，得到攻击类型组合的每个特征对应的发生概率，包括：获取第一攻击类型的所有特征组合，计算其在第二攻击类型的值域内发生的频率，记为AFdomain；其中F为某一特征组合；计算在预设时间段内，满足第一攻击类型和第二攻击类型的时序关系以及F满足相似度要求的第一攻击类型的事件个数，记为ABFdomain；以条件概率P) =ABFdomain/ AFdomain，作为第一攻击类型和第二攻击类型组成的攻击类型组合的发生概率。在一些可选实施方式中，将根据所述发生概率确定出的攻击类型组合写入第一概率表，包括：多轮迭代计算多个特征组合下的攻击类型组合；根据预设阈值筛选出每轮中的多个特征组合下的攻击类型组合；对得到的攻击类型组合进行合并，取特征组合个数最多的攻击类型组合写入第一概率表。在一些可选实施方式中，所述方法还包括：构建复合数据结构以标识匹配过程；所述复合数据结构中包括：事件标识、事件发生时间、序列内事件的最新时间以及是否对比标识。上述的基于因果推断的多步攻击检测装置中的各个功能模块的具体限定可以参见上文中对于基于因果推断的多步攻击检测方法的限定，在此不再赘述。上述装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。在本发明提供的一些实施方式中，还提供了一种电子设备，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现前述的基于因果推断的多步攻击检测方法的步骤。此处的处理器具有数值计算和逻辑运算的功能，其至少具有数据处理能力的中央处理器CPU、随机存储器RAM、只读存储器ROM、多种I/O口和中断系统等。处理器中包含内核，由内核去存储器中调取相应的程序单元。内核可以设置一个或以上，通过调整内核参数来实现前述的方法。存储器可能包括计算机可读介质中的非永久性存储器，随机存取存储器和/或非易失性内存等形式，如只读存储器或闪存，存储器包括至少一个存储芯片。在本发明的一种实施方式中，还提供了一种计算机可读存储介质，所述存储介质中存储有指令，当其在计算机上运行时，该指令在被处理器执行时使得处理器被配置成执行上述的基于因果推断的多步攻击检测方法的步骤。在本发明提供的一种实施方式中，提供了一种计算机程序产品，包括计算机程序，该计算机程序在被处理器执行时实现上述的基于因果推断的多步攻击检测方法的步骤。以上多种实施方式适用于从网络设备的告警事件中挖掘出复杂的多步攻击行为。以上方法或装置运行于分布式平台，输入数据为结构化的告警事件，经过本方法计算，可以得到检测出复杂的多步攻击行为。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。在一个典型的配置中，计算设备包括一个或多个处理器 、输入/输出接口、网络接口和内存。存储器可能包括计算机可读介质中的非永久性存储器，随机存取存储器和/或非易失性内存等形式，如只读存储器或闪存。存储器是计算机可读介质的示例。计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存 、静态随机存取存储器 、动态随机存取存储器 、其他类型的随机存取存储器 、只读存储器 、电可擦除可编程只读存储器 、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘  或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体 ，如调制的数据信号和载波。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括要素的过程、方法、商品或者设备中还存在另外的相同要素。以上仅为本申请的实施例而已，并不用于限制本申请。对于本领域技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本申请的权利要求范围之内。
