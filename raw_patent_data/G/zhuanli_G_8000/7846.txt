标题title
车辆数据处理方法、车联网终端及计算机可读存储介质
摘要abst
本发明公开了一种车辆数据处理方法、车联网终端及计算机可读存储介质，所述车辆数据处理方法包括：接收车辆的电子控制单元ECU上传的节点报文数据；分析所述节点报文数据，确定存在故障的当前故障ECU；确定所述当前故障ECU的相关网段涉及的当前关联ECU；发送所述当前故障ECU和所述当前关联ECU上传的第一节点报文数据至预配对的云平台。本申请大幅减少了节点数据上传的数据量，避免造成大量的流量浪费，避免占用公共平台大量的存储空间，大大降低了节点数据的传输成本和存储成本。
权利要求书clms
1.一种车辆数据处理方法，其特征在于，所述车辆数据处理方法包括：接收车辆的电子控制单元ECU上传节点报文数据；分析所述节点报文数据，确定存在故障的当前故障ECU；确定所述当前故障ECU的相关网段涉及的当前关联ECU；发送所述当前故障ECU和所述当前关联ECU上传的第一节点报文数据至预配对的云平台。2.如权利要求1所述的车辆数据处理方法，其特征在于，所述车辆数据处理方法还包括：在确定存在故障的当前故障ECU之后，为所述当前故障ECU设置必上传时长；其中，所述当前故障ECU和当前关联ECU分别转为历史故障ECU和历史关联ECU；在所述必上传时长内，将所述历史故障ECU和所述历史关联ECU上传的第二节点报文数据，作为必上传报文数据以发送至所述云平台。3.如权利要求2所述的车辆数据处理方法，其特征在于，所述车辆数据处理方法还包括：在经历所述必上传时长之后，若所述历史故障ECU的故障未解除，则为所述历史故障ECU设置新的必上传时长。4.如权利要求1所述的车辆数据处理方法，其特征在于，所述接收车辆的电子控制单元ECU上传的节点报文数据的步骤包括：接收车辆的ECU上传的节点数据；将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节；将所述节点数据的数据参数部分和数据部分，设置为报文后续字节；将所述报文首字节和所述报文后续字节，封装为节点报文数据。5.如权利要求4所述的车辆数据处理方法，其特征在于，所述将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节的步骤包括：将所述节点数据的数据类型的第一标识设置为报文首字节的低三位，将所述节点数据的所属网段的第二标识设置为报文首字节的高五位；或者，将所述节点数据的数据类型的第一标识设置为报文首字节的高三位，将所述节点数据的所属网段的第二标识设置为报文首字节的低五位。6.如权利要求1所述的车辆数据处理方法，其特征在于，所述分析所述节点报文数据，确定存在故障的当前故障ECU的步骤包括：分析所述节点报文数据以获取所述车辆的ECU的诊断故障代码DTC报文；对各所述DTC报文进行解析，确定各所述DTC报文中的异常标志位的有效性；将上传所述异常标志位为有效的所述DTC报文的ECU，确定为存在故障的当前故障ECU。7.如权利要求1所述的车辆数据处理方法，其特征在于，所述确定所述当前故障ECU的相关网段涉及的当前关联ECU的步骤包括：将与所述当前故障ECU存在收发关系的网段所涉及的ECU作为当前关联ECU；将所述当前关联ECU所属网段的错误标志位设置为有效。8.如权利要求2所述的车辆数据处理方法，其特征在于，所述车辆数据处理方法还包括：在发送所述第一节点报文数据和所述第二节点报文数据至所述云平台时，同步提取所述节点报文数据中的必上传报文数据并发送所述必上传报文数据至所述云平台。9.如权利要求1至8中任一项所述的车辆数据处理方法，其特征在于，在所述接收车辆的电子控制单元ECU上传节点报文数据的步骤之前，还包括：根据车辆的整车通信矩阵，确定每个所述ECU的DTC报文的身份标识、DTC报文内信号的数据解析和相关网段。10.一种车联网终端，其特征在于，所述车联网终端包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述计算机程序配置为实现如权利要求1至9中任一项所述的车辆数据处理方法的步骤。11.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1至9任一项所述的车辆数据处理方法的步骤。
说明书desc
技术领域本发明涉及车联网技术领域，尤其涉及一种车辆数据处理方法、车联网终端及计算机可读存储介质。背景技术随着CAN、LIN等总线技术以及电子技术等的发展，汽车的电子化程度越来越高，各个ECU之间针对节点数据的报文交互也越来越多，特别是，近些年来智能电动汽车的飞速发展，使得整车的通信数据量成数十倍的增长。同时，随着汽车的节点数据越来越多，国家相关部门要求汽车，特别是新能源汽车，对汽车各ECU的节点数据上传至公共平台，以帮助政府对普通汽车或新能源汽车的质量、性能等进行监管；或者以帮助车企了解用户的实际需求并在汽车出现故障时及时对故障原因进行定位，提早发现问题、解决问题。但是，由于节点数据的数据量巨大，导致上传数据耗费流量巨大、占用公共平台存储空间巨大，造成传输成本和存储成本高的技术问题。发明内容本发明的主要目的在于提供一种车辆数据处理方法、车联网终端及计算机可读存储介质，旨在解决汽车节点数据上传传输成本和存储成本高的技术问题。为实现上述目的，第一方面，本申请提供一种车辆数据处理方法，所述车辆数据处理方法包括：接收车辆的电子控制单元ECU上传的节点报文数据；分析所述节点报文数据，确定存在故障的当前故障ECU；确定所述当前故障ECU的相关网段涉及的当前关联ECU；发送所述当前故障ECU和所述当前关联ECU上传的第一节点报文数据至预配对的云平台。基于以上技术方案，通过在接收车辆的ECU上传的节点报文数据之后，基于节点报文数据确定当前故障ECU，进而确定处于当前故障ECU相关网段的当前关联ECU，选择性发送所述节点报文数据中当前故障ECU和所述当前关联ECU上传的第一节点报文数据至云平台，实现根据ECU的节点报文数据进行网段筛选的数据上传动态配置，只上传当前故障ECU和当前关联ECU的节点报文数据，并不会把车辆的所有ECU的节点数据全部上传，在不影响车辆质量、性能监管和故障发现与定位的前提下，大幅减少了节点数据上传的数据量，避免造成大量的流量浪费，避免占用公共平台大量的存储空间，大大降低了节点数据的传输成本和存储成本。示例性的，所述车辆数据处理方法的执行主体为车联网终端。示例性的，所述车联网终端集成车辆的中央网关功能，所述车联网终端封装和打包各所述ECU上传的节点数据为节点报文数据。根据第一方面，所述车辆数据处理方法还包括：在确定存在故障的当前故障ECU之后，为所述当前故障ECU设置必上传时长；其中，所述当前故障ECU和当前关联ECU分别转为历史故障ECU和历史关联ECU；在所述必上传时长内，将所述历史故障ECU和所述历史关联ECU上传的第二节点报文数据，作为必上传报文数据以发送至所述云平台。基于以上技术方案，通过在确定当前故障ECU之后，为当前故障ECU设置必上传时长，在必上传时长内，依然将当前故障ECU和当前关联ECU转换为历史故障ECU和历史关联ECU之后的第二节点报文数据上传云平台，无论历史故障ECU和历史关联ECU的故障是否被清除，第二节点报文数据将被有序存储在云平台，实现了必上传时长的故障追踪机制，大大减少了不必要的流量和存储空间的浪费，同时大幅提升了针对ECU的节点故障的可追溯能力，大幅减少了技术人员对节点报文数据进行系统性分析所需查看的数据量，极大地提升了技术人员对车辆的故障追踪、定位、分析的能力和效率。根据第一方面，或者以上第一方面的任意一种实现方式，所述车辆数据处理方法还包括：在经历所述必上传时长之后，若所述历史故障ECU的故障未解除，则为所述历史故障ECU设置新的必上传时长。基于以上技术方案，通过在历史故障ECU经历必上传时长，若期间历史故障ECU的故障还是未解除，此时为历史故障ECU设置新的必上传时长，继续实施一个必上传时长的故障追踪机制，避免漏上传未清除故障的历史故障ECU的节点报文数据至云平台，确保在根据ECU的节点报文数据进行网段筛选的数据上传动态配置下，云平台实现对车辆质量、性能监管和故障发现与定位的功能可靠性。根据第一方面，或者以上第一方面的任意一种实现方式，所述接收车辆的电子控制单元ECU上传的节点报文数据的步骤包括：接收车辆的ECU上传的节点数据；将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节；将所述节点数据的数据参数部分和数据部分，设置为报文后续字节；将所述报文首字节和所述报文后续字节，封装为节点报文数据。基于以上技术方案，在接收车辆的ECU上传的节点数据之后，对节点数据进行拆分出数据部分、数据参数部分、数据类型和所属网段，由于数据类型一般不会超过8种，只需要3bit就可以表示；所属网段，对于车辆的整车而言，即使加上预留网段也一般不会超过32个，只需要5bit就足以表示；所以本实施例将节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节，而不必将数据类型的第一标识和所属网段的第二标识分别设置为一个字节，进而一个报文节省一个字节长度，有效提高了报文利用率。根据第一方面，或者以上第一方面的任意一种实现方式，所述将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节的步骤包括：将所述节点数据的数据类型的第一标识设置为报文首字节的低三位，将所述节点数据的所属网段的第二标识设置为报文首字节的高五位；或者，将所述节点数据的数据类型的第一标识设置为报文首字节的高三位，将所述节点数据的所属网段的第二标识设置为报文首字节的低五位。基于以上技术方案，节点报文数据的报文首字节可分配三位给数据类型的第一标识、分配五位给所属网段的第二标识，数据类型的第一标识为低三位或高三位均可，适应性的，所属网段的第二标识为高五位或低五位均可，拓展了节点报文数据的报文格式类型。根据第一方面，或者以上第一方面的任意一种实现方式，所述分析所述节点报文数据，确定存在故障的当前故障ECU的步骤包括：分析所述节点报文数据以获取所述车辆的ECU的诊断故障代码DTC报文；对各所述DTC报文进行解析，确定各所述DTC报文中的异常标志位的有效性；将上传所述异常标志位为有效的所述DTC报文的ECU，确定为存在故障的当前故障ECU。基于以上技术方案，通过分析和提取ECU上传的节点报文数据，获取各ECU周期性上传的DTC报文，将DTC报文中相应的异常标志位为有效的ECU确定为存在故障的ECU，实现对故障ECU和正常ECU的有效区分，进而动态筛选出故障ECU待上传云平台的节点数据报文。根据第一方面，或者以上第一方面的任意一种实现方式，所述确定所述当前故障ECU的相关网段涉及的当前关联ECU的步骤包括：将与所述当前故障ECU存在收发关系的网段所涉及的ECU作为当前关联ECU；将所述当前关联ECU所属网段的错误标志位设置为有效。基于以上技术方案，通过先确定与当前故障ECU存在收发关系的网段所相关的当前关联ECU，将所述当前关联ECU所属网段的错误标志位设置为有效，以供后续识别和上传关联ECU的节点数据报文至云平台，由于当前关联ECU与当前故障ECU数据交互密切，技术人员同时通过云平台知晓当前关联ECU与当前故障ECU的解释数据报文之后，对车辆的故障追踪、定位、分析的能力和效率将得到大幅提高。根据第一方面，或者以上第一方面的任意一种实现方式，所述车辆数据处理方法还包括：在发送所述第一节点报文数据和所述第二节点报文数据至所述云平台时，同步提取所述节点报文数据中的必上传报文数据并发送所述必上传报文数据至所述云平台。基于以上技术方案，每次向云平台上传报文数据时，将当前故障ECU和所述当前关联ECU上传的第一节点报文数据、历史故障ECU和历史关联ECU上传的第二节点报文数据以及必上传报文数据，全部上传云平台，从而上传至云平台的节点报文数据包括了当前故障相关、历史故障相关和国家规定必须上传的三类节点报文数据，在不过多增加节点数据的传输成本和存储成本的前提下，大幅增加了车辆质量、性能监管和故障发现与定位的能力和效率。根据第一方面，或者以上第一方面的任意一种实现方式，在所述接收车辆的电子控制单元ECU上传节点报文数据的步骤之前，还包括：根据车辆的整车通信矩阵，确定每个所述ECU的DTC报文的身份标识、DTC报文内信号的数据解析和相关网段。基于以上技术方案，提前部署车辆各ECU的DTC报文的身份标识、DTC报文内信号的数据解析和各ECU所处的相关网段，以供后续处理流程使用，以降低节点数据的传输成本和存储成本。第二方面，本申请提供了一种车联网终端，所述车联网终端包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述计算机程序配置为实现以下步骤：接收车辆的电子控制单元ECU上传的节点报文数据；分析所述节点报文数据，确定存在故障的当前故障ECU；确定所述当前故障ECU的相关网段涉及的当前关联ECU；发送所述当前故障ECU和所述当前关联ECU上传的第一节点报文数据至预配对的云平台。根据第二方面，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：在确定存在故障的当前故障ECU之后，为所述当前故障ECU设置必上传时长；其中，所述当前故障ECU和当前关联ECU分别转为历史故障ECU和历史关联ECU；在所述必上传时长内，将所述历史故障ECU和所述历史关联ECU上传的第二节点报文数据，作为必上传报文数据以发送至所述云平台。根据第二方面，或者以上第二方面的任意一种实现方式，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：在经历所述必上传时长之后，若所述历史故障ECU的故障未解除，则为所述历史故障ECU设置新的必上传时长。根据第二方面，或者以上第二方面的任意一种实现方式，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：所述接收车辆的电子控制单元ECU上传的节点报文数据的步骤包括：接收车辆的ECU上传的节点数据；将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节；将所述节点数据的数据参数部分和数据部分，设置为报文后续字节；将所述报文首字节和所述报文后续字节，封装为节点报文数据。根据第二方面，或者以上第二方面的任意一种实现方式，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：所述将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节的步骤包括：将所述节点数据的数据类型的第一标识设置为报文首字节的低三位，将所述节点数据的所属网段的第二标识设置为报文首字节的高五位；或者，将所述节点数据的数据类型的第一标识设置为报文首字节的高三位，将所述节点数据的所属网段的第二标识设置为报文首字节的低五位。根据第二方面，或者以上第二方面的任意一种实现方式，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：所述分析所述节点报文数据，确定存在故障的当前故障ECU的步骤包括：分析所述节点报文数据以获取所述车辆的ECU的诊断故障代码DTC报文；对各所述DTC报文进行解析，确定各所述DTC报文中的异常标志位的有效性；将上传所述异常标志位为有效的所述DTC报文的ECU，确定为存在故障的当前故障ECU。根据第二方面，或者以上第二方面的任意一种实现方式，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：所述确定所述当前故障ECU的相关网段涉及的当前关联ECU的步骤包括：将与所述当前故障ECU存在收发关系的网段所涉及的ECU作为当前关联ECU；将所述当前关联ECU所属网段的错误标志位设置为有效。根据第二方面，或者以上第二方面的任意一种实现方式，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：所述车辆数据处理方法还包括：在发送所述第一节点报文数据和所述第二节点报文数据至所述云平台时，同步提取所述节点报文数据中的必上传报文数据并发送所述必上传报文数据至所述云平台。根据第二方面，或者以上第二方面的任意一种实现方式，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：在所述接收车辆的电子控制单元ECU上传节点报文数据的步骤之前，还包括：根据车辆的整车通信矩阵，确定每个所述ECU的DTC报文的身份标识、DTC报文内信号的数据解析和相关网段。第二方面以及第二方面的任意一种实现方式分别与第一方面以及第一方面的任意一种实现方式相对应。第二方面以及第二方面的任意一种实现方式所对应的技术效果可参见上述第一方面以及第一方面的任意一种实现方式所对应的技术效果，此处不再赘述。第三方面，本申请提供了一种计算机可读存储介质，所述计算机可读存储介质中存储了计算机程序，当所述计算机程序被处理器执行时，使得处理器执行如上述第一方面或第一方面的可能的实现方式中任一项所述的车辆数据处理方法。第三方面以及第三方面的任意一种实现方式分别与第一方面以及第一方面的任意一种实现方式相对应。第三方面以及第三方面的任意一种实现方式所对应的技术效果可参见上述第一方面以及第一方面的任意一种实现方式所对应的技术效果，此处不再赘述。第四方面，本申请实施例提供了一种计算机程序，该计算机程序包括用于执行第一方面以及第一方面的任意可能的实现方式中的车辆数据处理方法的指令。第四方面以及第四方面的任意一种实现方式分别与第一方面以及第一方面的任意一种实现方式相对应。第四方面以及第四方面的任意一种实现方式所对应的技术效果可参见上述第一方面以及第一方面的任意一种实现方式所对应的技术效果，此处不再赘述。附图说明图1是本申请车辆数据处理方法一应用场景的框架结构示意图；图2是本申请实施例方案涉及的硬件运行环境的车联网终端的结构示意图；图3为本申请车辆数据处理方法一实施例的流程示意图；图4a为本申请中常规节点报文的报文结构示意图；图4b为常规节点报文数据一实施例的报文结构示意图。本发明目的的实现、功能特点及优点将结合实施例，参照附图做进一步说明。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。本文中术语“和/或”，仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。本申请实施例的说明书和权利要求书中的术语“第一”和“第二”等是用于区别不同的对象，而不是用于描述对象的特定顺序。例如，第一目标对象和第二目标对象等是用于区别不同的目标对象，而不是用于描述目标对象的特定顺序。在本申请实施例中，“示例性的”或者“例如”等词用于表示作例子、例证或说明。本申请实施例中被描述为“示例性的”或者“例如”的任何实施例或设计方案不应被解释为比其它实施例或设计方案更优选或更具优势。确切而言，使用“示例性的”或者“例如”等词旨在以具体方式呈现相关概念。在本申请实施例的描述中，除非另有说明，“多个”的含义是指两个或两个以上。例如，多个处理单元是指两个或两个以上的处理单元；多个系统是指两个或两个以上的系统。在对本申请实施例的技术方案说明之前，首先结合附图对本申请实施例的应用场景进行说明。为了便于描述，本申请实施例以汽车的车辆网络为例，在一些可实现的实施例中，参照图1，车辆的车辆网络包括多个ECU，每个ECU可以作为一个节点。可选地，车辆网络中包括多路CAN总线、分别设置于各路CAN总线上的ECU、与各ECU通信连接的中央网关、与中央网关通信连接的车联网终端，车联网终端通过中央网关侦听各路CAN总线上的ECU的节点数据，中央网关将ECU上传的节点数据打包和封装为节点报文数据发送至车联网终端；车联网终端通过网段错误标志位筛选接收的节点报文数据，将筛选后的节点报文数据上传至企业平台云端，筛选后的节点报文数据包括当前故障ECU、当前关联ECU、历史故障ECU、历史关联ECU上传的节点报文数据以及国家强制规定的必上传报文数据。在一些可实现的实施例中，上述车联网终端可集成中央网关功能，即车辆网络包括多路CAN总线、分别设置于各路CAN总线上的ECU、与各ECU通信连接的车联网终端，车联网终端直接对各ECU上传的节点数据进行打包和封装，获得节点报文数据，将筛选后的节点报文数据上传至企业平台云端，筛选后的节点报文数据包括当前故障ECU、当前关联ECU、历史故障ECU、历史关联ECU上传的节点报文数据以及国家强制规定的必上传报文数据。通过以上技术方案，云平台的技术人员能够通过车联网终端上传的节点报文数据了解车辆的每路CAN总线上存在故障的ECU和关联ECU的实时状况。实际应用中，在一些实施例中，每路CAN总线上设置多个ECU，ECU可以是ACM、SDM、EMS、TCM以及ESC等等车辆中常用的与CAN总线相连的ECU，本申请不做严格限定。为了下述各实施例的描述清楚简洁，首先给出一种车辆数据处理方法的实现方案的简要介绍：随着CAN、LIN等总线技术以及电子技术等的发展，汽车的电子化程度越来越高，各个ECU之间的报文交互也越来越多。近些年来智能电动汽车的飞速发展，使得整车的通信数据量成数十倍的增长。数据上传指的是将整车内各子系统连接到中央网关，再通过网络及相关设备将中央网关收集到的车辆数据上传到公共平台。数据上传是国家相关部门在新能源汽车技术规范里提出的要求，可以帮助政府对新能源汽车的质量、性能等进行监管；而对于企业来说，数据上传可以帮助车企了解用户的实际需求并在汽车出现故障时及时对故障原因进行定位，提早发现问题、解决问题。现在存在的数据上传方案主要有两个问题，一是对整车内所有的公共网段数据进行上传，包括CAN、CANFD、LIN、以太网等数据，造成了大量的流量浪费，且在企业平台云端造成了存储空间的浪费；二是打包传输的报文报头较长，导致报文利用率较低，传输成本增加。本发明设计了一种通过动态配置以减小数据上传流量浪费的方法，并通过精简报头来提高报文利用率，减小数据上传的成本。在一些实施例中，通过在接收车辆的ECU上传的节点报文数据之后，基于节点报文数据确定当前故障ECU，进而确定处于当前故障ECU相关网段的当前关联ECU，选择性发送所述节点报文数据中当前故障ECU和所述当前关联ECU上传的第一节点报文数据至云平台，实现根据ECU的节点报文数据进行网段筛选的数据上传动态配置，只上传与当前故障ECU和当前关联ECU的节点报文数据，并不会把车辆的所有ECU的节点数据全部上传，在不影响车辆质量、性能监管和故障发现与定位的前提下，大幅减少了节点数据上传的数据量，避免造成大量的流量浪费，避免占用公共平台大量的存储空间，大大降低了节点数据的传输成本和存储成本。在一些实施例中，在接收车辆的ECU上传的节点数据之后，通过对节点数据进行拆分出数据部分、数据参数部分、数据类型和所属网段，由于数据类型一般不会超过8种，只需要3bit就可以表示；所属网段，对于车辆的整车而言，即使加上预留网段也一般不会超过32个，只需要5bit就足以表示；所以本实施例将节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节，而不必将数据类型的第一标识和所属网段的第二标识分别设置为一个字节，进而一个报文节省一个字节长度，有效提高了报文利用率。参照图2，图2为本发明实施例方案涉及的硬件运行环境的车联网终端结构示意图。如图2所示，该车联网终端可以包括：处理器1001，例如中央处理器，通信总线1002、用户接口1003，网络接口1004，存储器1005。其中，通信总线1002用于实现这些组件之间的连接通信。用户接口1003可以包括显示屏、输入单元比如键盘，可选用户接口1003还可以包括标准的有线接口、无线接口。网络接口1004可选的可以包括标准的有线接口、无线接口接口)。存储器1005可以是高速的随机存取存储器存储器，也可以是稳定的非易失性存储器，例如磁盘存储器。存储器1005可选的还可以是独立于前述处理器1001的存储装置。本领域技术人员可以理解，图2中示出的结构并不构成对车联网终端的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。如图2所示，作为一种存储介质的存储器1005中可以包括操作系统、数据存储模块、网络通信模块、用户接口模块以及计算机程序。在图2所示的车联网终端中，网络接口1004主要用于与其他设备进行数据通信；用户接口1003主要用于与用户进行数据交互；本发明车联网终端中的处理器1001、存储器1005可以设置在车联网终端中，所述车联网终端通过处理器1001调用存储器1005中存储的计算机程序，并执行本申请实施例提供的车辆数据处理方法。应当理解的是，上述说明仅是为了更好的理解本实施例的技术方案而列举的示例，不作为对本实施例的唯一限制。下面结合图3所示的车辆数据处理方法一实施例的流程示意图，对车辆数据处理方法进行详细说明。参见图3，本申请的车辆数据处理方法一实施例具体包括：步骤S10，接收车辆的电子控制单元ECU上传节点报文数据；在一些实施例中，本申请的车辆数据处理方法的执行主体可以是车联网终端，此车联网终端可集成中央网关的功能，与车辆的各ECU直接通信连接；车联网终端直接接收各ECU上传的节点数据并将节点数据打包和封装为节点报文数据，并存储节点报文数据，车联网终端包括对节点数据的数据采集组包功能和对节点报文数据的本地数据存储功能。或者，车联网终端与中央网关分体设置，车辆的各ECU与中央网关通信连接，中央网关与车联网终端通信连接。中央网关接收各ECU上传的节点数据并将节点数据打包和封装为节点报文数据，并存储节点报文数据，参照图1，即中央网关包括对节点数据的数据采集组包功能和对节点报文数据的本地数据存储功能。中央网关将打包的节点报文数据发送给车联网终端。步骤S20，分析所述节点报文数据，确定存在故障的当前故障ECU；车辆的大部分ECU都会周期性发送DTC报文，以表明车辆自身的状态，如果车辆出现故障，ECU会修改DTC报文的异常标志位bit，如当车辆的电池管理系统检测到电池回路热管理异常后，会将DTC报文中相应的异常标志位置1。在车联网终端收到从中央网关传来的节点报文数据之后，基于中央网关对每个ECU上传的节点报文数据中DTC报文进行解析，确定这些DTC报文的异常标志位是否有效，如果有效，则将与该故障节点有收发关系的网段的节点报文数据进行上传。在一些实施例中，步骤S20分析所述节点报文数据，确定存在故障的当前故障ECU包括：步骤A1，分析所述节点报文数据以获取所述车辆的ECU的诊断故障代码DTC报文；在步骤S10之前，提前部署车辆各ECU的DTC报文的身份标识、各ECU的DTC报文内信号的数据解析和各ECU所处的相关网段，以供后续处理流程使用，以降低了节点数据的传输成本和存储成本。DTC报文的身份标识用于供中央网关知晓DTC报文是哪个ECU上传的，数据解析用于指引中央网关对ECU上传的节点故障进行解析，ECU所处的相关网段用于供中央网关在确定当前故障ECU之后确定当前关联ECU。步骤A2，对各所述DTC报文进行解析，确定各所述DTC报文中的异常标志位的有效性；可选地，若异常标志位为0，表明此DTC报文的源端ECU不存在故障，异常标志位无效；若异常标志位为1，表明此DTC报文的源端ECU存在故障，异常标志位有效。步骤A3，将上传所述异常标志位为有效的所述DTC报文的ECU，确定为存在故障的当前故障ECU。在本实施例中，通过分析和提取ECU上传的节点报文数据，获取各ECU周期性上传的DTC报文，将DTC报文中相应的异常标志位为有效的ECU确定为存在故障的ECU，实现对故障ECU和正常ECU的有效区分，进而动态筛选出故障ECU待上传云平台的节点数据报文。步骤S30，确定所述当前故障ECU的相关网段涉及的当前关联ECU；在确定当前故障ECU之后，将与当前故障ECU具有收发关系的网段之上的ECU确定为当前关联ECU，当前关联ECU上传的节点报文数据也将同步上传云平台。在一些实施例中，步骤S30确定所述当前故障ECU的相关网段涉及的当前关联ECU包括：步骤B1,将与所述当前故障ECU存在收发关系的网段所涉及的ECU作为当前关联ECU；收发关系指与当前故障ECU存在报文收发关系，如：为当前故障ECU的源地址网段、目的地址网段、报文转发路由地址网段等。步骤B2,将所述当前关联ECU所属网段的错误标志位设置为有效。车联网终端提取从中央网关接收到的节点报文数据中的DTC报文，并比较其中的异常标志位是否置为有效。若某个ECU的异常标志位有效，则该ECU的当前关联ECU所属网段的错误标志位置1。在本实施例中，通过先确定与当前故障ECU存在收发关系的网段所相关的当前关联ECU，并将网段的错误标志位设置为有效，以供后续识别和上传关联ECU的节点数据报文至云平台，由于当前关联ECU与当前故障ECU数据交互密切，技术人员同时通过云平台知晓当前关联ECU与当前故障ECU的解释数据报文之后，对车辆的故障追踪、定位、分析的能力和效率将得到大幅提高。步骤S40，发送所述当前故障ECU和所述当前关联ECU上传的第一节点报文数据至预配对的云平台。在确定当前关联ECU和当前故障ECU之后，车联网终端将第一节点报文数据按照车辆与云平台通信协议上传至预配对的云平台，以供云平台的技术人员分析和供云平台关联的国家监管部门调用。即使是由于车辆的整车某个ECU节点故障触发了高频数据上传，也不会有与故障数据无关的节点报文数据被上传，从而大大减少传输流量的浪费，同时针对ECU节点故障的可追溯能力大大提升，提高技术人员的分析效率。在本实施例中，通过在接收车辆的ECU上传的节点报文数据之后，基于节点报文数据确定当前故障ECU，进而确定处于当前故障ECU相关网段的当前关联ECU，选择性发送所述节点报文数据中当前故障ECU和所述当前关联ECU上传的第一节点报文数据至云平台，实现根据ECU的节点报文数据进行网段筛选的数据上传动态配置，只上传与当前故障ECU和当前关联ECU的节点报文数据，并不会把车辆的所有ECU的节点数据全部上传，在不影响车辆质量、性能监管和故障发现与定位的前提下，大幅减少了节点数据上传的数据量，避免造成大量的流量浪费，避免占用公共平台大量的存储空间，大大降低了节点数据的传输成本和存储成本。进一步地，在本申请车辆数据处理方法另一实施例中，所述车辆数据处理方法还包括：步骤C1，在确定存在故障的当前故障ECU之后，为所述当前故障ECU设置必上传时长；其中，所述当前故障ECU和当前关联ECU分别转为历史故障ECU和历史关联ECU；在确定存在故障的当前故障ECU之后，为了方便分析该故障的复现率、确认故障等级并准确分析故障根因，为当前故障ECU设置必上传时长，这些筛选出来的当前故障ECU和当前关联ECU所在网段的节点报文数据在以后的必上传时长内都会被上传，若必上传时长后该当前故障ECU的故障DTC报文清除，异常标志位不再有效，则停止此当前故障ECU和当前关联ECU所在网段的节点报文数据的数据上传。步骤C2，在所述必上传时长内，将所述历史故障ECU和所述历史关联ECU上传的第二节点报文数据，作为必上传报文数据以发送至所述云平台。在本实施例中，通过在确定当前故障ECU之后，为当前故障ECU设置必上传时长，在必上传时长内，依然将当前故障ECU和当前关联ECU转换为历史故障ECU和历史关联ECU之后的第二节点报文数据上传云平台，无论历史故障ECU和历史关联ECU的故障是否被清除，第二节点报文数据将被有序存储在云平台，实现了必上传时长的故障追踪机制，大大减少了不必要的流量和存储空间的浪费，同时大幅提升了针对ECU的节点故障的可追溯能力，大幅减少了技术人员对节点报文数据进行系统性分析所需查看的数据量，极大地提升了技术人员对车辆的故障追踪、定位、分析的能力和效率。在一些实施例中，所述车辆数据处理方法还包括：步骤D，在经历所述必上传时长之后，若所述历史故障ECU的故障未解除，则为所述历史故障ECU设置新的必上传时长。必上传时长可通过在车联网终端内设置变量ECUName_ErrorCounter，例如，ECUName_ErrorCounter＝30，在接下来30天内历史故障ECU和历史关联ECU上传的第二节点报文数据都被上传云平台。30天后终端检查该历史故障ECU的DTC报文的异常标志位是否有效，若仍有异常，ECUName_ErrorCounter重新置为30；若无异常，历史关联ECU所属网段的错误标志位ErrorFlag被置回0。在本实施例中，通过在历史故障ECU经历必上传时长，若期间历史故障ECU的故障还是未解除，此时为历史故障ECU设置新的必上传时长，继续实施一个必上传时长的故障追踪机制，避免漏上传未清除故障的历史故障ECU的节点报文数据至云平台，确保在根据ECU的节点报文数据进行网段筛选的数据上传动态配置下，云平台实现对车辆质量、性能监管和故障发现与定位的功能可靠性。在一些实施例中，所述车辆数据处理方法还包括：步骤E，在发送所述第一节点报文数据和所述第二节点报文数据至所述云平台时，同步提取所述节点报文数据中的必上传报文数据并发送所述必上传报文数据至所述云平台。在发送第一节点报文数据和第二节点报文数据至所述云平台时，同步确定所述节点报文数据中的必上传报文数据，必上传报文数据为国标规定的新能源汽车必须上传的数据，进而车联网终端同时将第一节点报文数据、第二节点报文数据和必上传报文数据一起上传至云平台，即只有与ECU故障相关的网段的节点报文数据和必上传报文数据会被上传，即使因故障触发了更高频率的数据上传，也不会有与故障数据无关的节点报文数据被上传，从而大大减少传输流量的浪费，同时针对节点故障的可追溯能力大大提升，提高技术人员的分析效率。在本实施例中，每次向云平台上传报文数据时，将当前故障ECU和所述当前关联ECU上传的第一节点报文数据、历史故障ECU和历史关联ECU上传的第二节点报文数据以及必上传报文数据，全部上传云平台，从而上传至云平台的节点报文数据包括了当前故障相关、历史故障相关和国家规定必须上传的三类节点报文数据，在不过多增加节点数据的传输成本和存储成本的前提下，大幅增加了车辆质量、性能监管和故障发现与定位的能力和效率。进一步地，在本申请车辆数据处理方法又一实施例中，步骤S10接收车辆的电子控制单元ECU上传的节点报文数据的步骤包括：步骤F1，接收车辆的ECU上传的节点数据；步骤F2，将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节；将所述节点数据的数据参数部分和数据部分，设置为报文后续字节；步骤F3，将所述报文首字节和所述报文后续字节，封装为节点报文数据。各ECU在进行节点数据上传时，中央网关会收集各个ECU传来的节点数据，并将其组合、打包成节点报文数据发送给车联网终端，为方便理解本申请技术方案，以下节点报文数据以TCP报文为例，但不限于TCP报文。在常规的方案中，中央网关会对ECU传来的节点数据进行解析，拆分出数据段，并添加相关报头作为TCP报文的数据部分，以用于数据上传，以数据类型为CAN报文为例，常规方法参照图4a，其中，数据类型和所属网段各占用一个Byte，而实际上数据类型包括CAN报文、CANFD报文、LIN报文、以太网报文等不会超过8种，只需要3bit就可以表示，而所属网段，对于整车来讲，即使加上预留网段也不会超过32个，只要5bit就足以表示。因此，本申请将数据类型和所属网段合并为一个Byte，具体参照图4b，低三位表示该报文的数据类型，高五位表示该数据所属的网段，如此便可以节省一个Byte的长度，有效提高报文利用率。如果网关打包一个TCP报文中包含200个CAN报文，则一个TCP报文可以节省200Byte。若一分钟上传3000个TCP报文，算下来一台车一天大约可以节省824M的数据量。在本实施例中，在接收车辆的ECU上传的节点数据之后，对节点数据进行拆分出数据部分、数据参数部分、数据类型和所属网段，由于数据类型一般不会超过8种，只需要3bit就可以表示；所属网段，对于车辆的整车而言，即使加上预留网段也一般不会超过32个，只需要5bit就足以表示；所以本实施例将节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节，即将每个节点报文数据报文的数据类型与所属网段进行合并，精简报头，而不必将数据类型的第一标识和所属网段的第二标识分别设置为一个字节，进而一个报文节省一个字节长度，有效提高了报文利用率。在一些实施例中，步骤F2中将所述节点数据的数据类型的第一标识和所属网段的第二标识，设置为报文首字节的步骤包括：将所述节点数据的数据类型的第一标识设置为报文首字节的低三位，将所述节点数据的所属网段的第二标识设置为报文首字节的高五位；或者，将所述节点数据的数据类型的第一标识设置为报文首字节的高三位，将所述节点数据的所属网段的第二标识设置为报文首字节的低五位。在本实施例中，节点报文数据的报文首字节可分配三位给数据类型的第一标识、分配五位给所属网段的第二标识，数据类型的第一标识为低三位或高三位均可，适应性的，所属网段的第二标识为高五位或低五位均可，拓展了节点报文数据的报文格式类型。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者系统不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者系统所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者系统中还存在另外的相同要素。上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在如上所述的一个存储介质中，包括若干指令用以使得一台终端设备执行本发明各个实施例所述的方法。以上仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
