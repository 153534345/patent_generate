标题title
文本生成模型训练方法和装置、文本生成方法和装置
摘要abst
本公开提供了一种文本生成模型训练方法和装置，涉及人工智能技术领域，具体涉及深度学习、自然语言处理等技术领域，可应用于OCR等场景。具体实现方案为：从预先构建的文本样本集中选取文本样本；将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果；基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度；计算文本生成网络的损失；基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。该实施方式提高了模型的精度和多样性。
权利要求书clms
1.一种文本生成模型训练方法，所述方法包括：从预先构建的文本样本集中选取文本样本；将所述文本样本输入预先构建的文本生成网络，得到所述文本生成网络输出的预测结果；基于所述预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，所述语义相关损失用于表征所述预测结果与所述文本样本的真值在字级别的相似程度，所述匹配程度损失用于表征所述预设结果与所述文本样本的真值在句级别的匹配程度；基于所述语义相关损失和所述匹配程度损失，计算所述文本生成网络的损失；基于所述文本生成网络的损失，训练得到对应所述文本生成网络的文本生成模型。2.根据权利要求1所述的方法，其中，所述基于所述语义相关损失和所述匹配程度损失，计算所述文本生成网络的损失，包括：基于所述预测结果，计算字粒度的交叉熵损失；将所述交叉熵损失、所述语义相关损失以及所述匹配程度损失进行加权求和，得到所述文本生成网络的损失。3.根据权利要求1所述的方法，其中，所述文本生成网络包括：依次连接的编码器和尾部解码器；所述文本样本包括：文字序列和文字序列的真值，所述将所述文本样本输入预先构建的文本生成网络，得到所述文本生成网络输出的预测结果，包括：将所述文字序列输入所述编码器，得到所述编码器输出的编码输出值；将所述真值和所述编码输出值输入所述解码器，得到所述编码器输出的预测结果。4.根据权利要求3所述的方法，其中，所述文本生成网络还包括：中间解码器，所述中间解码器连接在所述编码器和所述尾部编码器之间；所述将所述文本样本输入预先构建的文本生成网络，得到所述文本生成网络输出的预测结果，还包括：将所述编码输出值和所述真值输入所述中间编码器，得到所述中间解码器输出的中间输出值；基于所述文本生成网络的当前训练迭代次数，选取所述中间输出值或所述真值，得到选取值；将所述选取值和所述编码输出值输入所述尾部解码器，得到所述尾部编码器输出的预测结果。5.根据权利要求4所述的方法，其中，所述基于所述文本生成网络的当前训练迭代次数，选取所述中间输出值或所述真值，得到选取值，包括：确定所述文本生成网络的当前训练迭代次数；将当前训练迭代次数输入采样概率公式，得到概率值；基于所述概率值，选取所述中间输出值或所述真值，得到选取值。6.根据权利要求5所述的方法，其中，所述概率值为选取所述真值的采样概率，所述采样概率公式是与所述文本生成网络的训练迭代次数相关的概率值生成公式，在所述采样概率公式中，所述概率值与所述训练迭代次数呈反比。7.一种文本生成方法，所述方法包括：获取待处理素材；对所述待处理素材进行处理，得到待处理文本数据；将所述待处理文本数据输入采用权利要求1-6任一项所述的方法生成的文本生成模型中，得到所述文本生成模型输出的所述待处理文本数据的文本生成结果。8.根据权利要求7所述的方法，其中，所述文本生成结果包括所述待处理文本数据的标题、摘要以及标签中的至少一项。9.一种文本生成模型训练装置，所述装置包括：选取单元，被配置成从预先构建的文本样本集中选取文本样本；输入单元，被配置成将所述文本样本输入预先构建的文本生成网络，得到所述文本生成网络输出的预测结果；第一计算单元，被配置成基于所述预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，所述语义相关损失用于表征所述预测结果与所述文本样本的真值在字级别的相似程度，所述匹配程度损失用于表征所述预设结果与所述文本样本的真值在句级别的匹配程度；第二计算单元，被配置成基于所述语义相关损失和所述匹配程度损失，计算所述文本生成网络的损失；训练单元，被配置成基于所述文本生成网络的损失，训练得到对应所述文本生成网络的文本生成模型。10.根据权利要求9所述的装置，其中，所述第二计算单元进一步被配置成：基于所述预测结果，计算字粒度的交叉熵损失；将所述交叉熵损失、所述语义相关损失以及所述匹配程度损失进行加权求和，得到所述文本生成网络的损失。11.根据权利要求9所述的装置，其中，所述文本生成网络包括：依次连接的编码器和尾部解码器；所述文本样本包括：文字序列和文字序列的真值，所述输入单元进一步被配置成：将所述文字序列输入所述编码器，得到所述编码器输出的编码输出值；将所述真值和所述编码输出值输入所述解码器，得到所述编码器输出的预测结果。12.根据权利要求11所述的装置，其中，所述文本生成网络还包括：中间解码器，所述中间解码器连接在所述编码器和所述尾部编码器之间；所述输入单元进一步被配置成：将所述编码输出值和所述真值输入所述中间编码器，得到所述中间解码器输出的中间输出值；基于所述文本生成网络的当前训练迭代次数，选取所述中间输出值或所述真值，得到选取值；将所述选取值和所述编码输出值输入所述尾部解码器，得到所述尾部编码器输出的预测结果。13.根据权利要求12所述的装置，其中，所述输入单元进一步被配置成：确定所述文本生成网络的当前训练迭代次数；将当前训练迭代次数输入采样概率公式，得到概率值；基于所述概率值，选取所述中间输出值或所述真值，得到选取值。14.根据权利要求13所述的装置，其中，所述概率值为选取所述真值的采样概率，所述采样概率公式是与所述文本生成网络的训练迭代次数相关的概率值生成公式，在所述采样概率公式中，所述概率值与所述训练迭代次数呈反比。15.一种文本生成装置，所述装置包括：获取单元，被配置成获取待处理素材；处理单元，被配置成对所述待处理素材进行处理，得到待处理文本数据；得到单元，被配置成将所述待处理文本数据输入采用权利要求9-14任一项所述的装置生成的文本生成模型中，得到所述文本生成模型输出的所述待处理文本数据的文本生成结果。16.根据权利要求15所述的装置，其中，所述文本生成结果包括所述待处理文本数据的标题、摘要以及标签中的至少一项。17.一种电子设备，其特征在于，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-8中任一项所述的方法。18.一种存储有计算机指令的非瞬时计算机可读存储介质，其特征在于，所述计算机指令用于使所述计算机执行权利要求1-8中任一项所述的方法。19.一种计算机程序产品，包括计算机程序，所述计算机程序在被处理器执行时实现权利要求1-8中任一项所述的方法。
说明书desc
技术领域本公开涉及人工智能技术领域，具体涉及深度学习、自然语言处理等技术领域，可应用于OCR等场景，尤其涉及一种文本生成模型训练方法和装置、文本生成方法和装置、电子设备、计算机可读介质以及计算机程序产品。背景技术现有文本模型在训练时依赖样本真值的引导，训练效果较好，但在实际预测时没有真值指导，模型效果会变得较差，可能出现曝光偏差问题的出现。公开内容提供了一种文本生成模型训练方法和装置、电子设备、计算机可读介质以及计算机程序产品。根据第一方面，提供了一种文本生成模型训练方法，该方法包括：从预先构建的文本样本集中选取文本样本；将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果；基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度；基于语义相关损失和匹配程度损失，计算文本生成网络的损失；基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。根据第二方面，提供了一种文本生成方法，该方法包括：获取待处理素材；对待处理素材进行处理，得到待处理文本数据；将待处理文本数据输入如第一方面任一实现方式描述的方法生成的文本生成模型中，得到文本生成模型输出的待处理文本数据的文本生成结果。根据第三方面，提供了一种文本生成模型训练装置，该装置包括：选取单元，被配置成从预先构建的文本样本集中选取文本样本；输入单元，被配置成将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果；第一计算单元，被配置成基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度；第二计算单元，被配置成基于语义相关损失和匹配程度损失，计算文本生成网络的损失；训练单元，被配置成基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。根据第四方面，提供了一种文本生成装置，该装置包括：获取单元，被配置成获取待处理素材；处理单元，被配置成对待处理素材进行处理，得到待处理文本数据；得到单元，被配置成将待处理文本数据输入第三方面任一实现方式描述的装置生成的文本生成模型中，得到文本生成模型输出的待处理文本数据的文本生成结果。根据第五方面，提供了一种电子设备，该电子设备包括：至少一个处理器；以及与至少一个处理器通信连接的存储器，其中，存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行如第一方面或第二方面任一实现方式描述的方法。根据第六方面，提供了一种存储有计算机指令的非瞬时计算机可读存储介质，计算机指令用于使计算机执行如第一方面或第二方面任一实现方式描述的方法。根据第七方面，提供了一种计算机程序产品，包括计算机程序，计算机程序在被处理器执行时实现如第一方面或第二方面任一实现方式描述的方法。本公开的实施例提供的文本生成模型训练方法和装置，首先，从预先构建的文本样本集中选取文本样本；其次，将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果；再次，基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度；从次，基于语义相关损失和匹配程度损失，计算文本生成网络的损失；最后，基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。由此，使语义相关损失作用在文本生成模型的整个训练过程，可以使文本生成模型区分同义的词或句，而非过度纠正，提高了模型生成精度与多样性；同时使匹配程度损失作用在模型训练过程，可以缓解模型训练中单独字粒度的损失带来的问题，缓解了模型曝光偏差现象，提升了文本生成模型的鲁棒性。应当理解，本部分所描述的内容并非旨在标识本公开的实施例的关键或重要特征，也不用于限制本公开的范围。本公开的其它特征将通过以下的说明书而变得容易理解。附图说明附图用于更好地理解本方案，不构成对本公开的限定。其中：图1是根据本公开文本生成模型训练方法的一个实施例的流程图；图2是本公开实施例中文本生成网络的一种结构示意图；图3是本公开实施例中文本生成网络的另一种结构示意图；图4是根据本公开文本生成方法的一个实施例的流程图；图5是根据本公开文本生成模型训练装置的实施例的结构示意图；图6是根据本公开文本生成装置的实施例的结构示意图；图7是用来实现本公开实施例的文本生成模型训练方法、文本生成方法的电子设备的框图。具体实施方式以下结合附图对本公开的示范性实施例做出说明，其中包括本公开实施例的各种细节以助于理解，应当将它们认为仅仅是示范性的。因此，本领域普通技术人员应当认识到，可以对这里描述的实施例做出各种改变和修改，而不会背离本公开的范围和精神。同样，为了清楚和简明，以下的描述中省略了对公知功能和结构的描述。本实施例中，“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。目前生成模型主要有两个问题，第一个是训练阶段和预测阶段有无真值作参考引发的曝光偏差问题，在训练阶段对输入文字逐个计算并累加交叉熵损失，模型参数的更新是依据在字粒度的最小化预测输出和真值之间的差异，但模型最终评估是在句粒度，形成误导。第二个问题是过度矫正，交叉熵目标会使模型严格向真值靠拢，即使模型输出是同义词/句。一旦模型输出与真值不同，交叉熵就会惩罚使模型向真值学习，使模型丧失生成精度与多样性。本本公开文本生成模型训练方法，在训练文本生成模型时，引入句粒度损失计算，缓解曝光偏差，会使文本生成模型对真值的依赖逐渐降低；另外语义相关损失的训练目标鼓励模型生成同义词/句，缓解过度矫正。多种训练策略的结合，大大减少了两个问题的影响。图1示出了根据本公开文本生成模型训练方法的一个实施例的流程100，上述文本生成模型训练方法包括以下步骤：步骤101，从预先构建的文本样本集中选取文本样本。本实施例中，文本样本集为文本生成模型训练方法运行于其上的执行主体为了训练文本生成模型而获取的文本数据集。文本生成模型训练方法的执行主体可以通过多种方式来获取文本样本集。例如，执行主体可以通过有线连接方式或无线连接方式，从数据库服务器中获取存储于其中的文本样本集。再例如，执行主体也可以接收终端或其他设备实时采集的文本样本集。本实施例中，文本样本集包括至少一个文本样本，每个文本样本可以包括：自然语言序列对应的一段文本数据，该段文本数据中的每个字标注有相应的字真值。步骤102，将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果。本实施例中，文本生成网络是一种初始的文本生成网络，该文本生成网络通过训练在满足训练完成之后，得到文本生成模型，文本生成模型用于对文本序列中的内容进行识别，得到文本识别结果。本实施例中，文本生成网络的任务不同，得到的文本识别结果不同，例如，文本生成网络的任务是机器翻译，文本生成网络在得到文字序列之后，对该文字序列进行翻译，得到的文本生成结果，该文本生成结果即为文本生成网络的预测结果。步骤103，基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失。本实施例中，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度。针对传统的交叉熵损失完全是由每次预测字的概率计算得来，仅关心如何提高产生预测字的最大似然概率。即使生成同义字也会被惩罚。为此设计字粒度的语义相关损失的学习目标如式所示：在式中，emb表示字的特征向量，yi表示预测字，表示真值对应的字，N为真值中的字的数量。语义相关损失语义相关性目标有助于生成多样化，并缓解过度矫正。本实施例中，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度。传统的文本生成模型的生成任务中，往往使用n-gram匹配程度评估整个句子，即利用n-gram来预计或者评估句子是否合理。利用n-gram可以比较灵活的评估输出质量，缓解单纯字粒度的交叉熵带来的问题。但这些指标都不可微分，即使加到损失函数中也没有作用。为此，本公开了涉及了与n-gram相关的匹配程度损失函数，实现匹配程度损失计算，具体地匹配程度损失函数得到过程如下：在一个具体示例，使用基于n-gram的bleu指标进行评估，其中对于某个句子的出现次数用C表示。预测结果和真值的n-gram匹配程度用Cclip表示。其中1{·}表示指示函数生成模型中，存在一些字的置信度比较高也存在部分字的不确定性比较高，但Cy的计算并没有考虑到，所有字是被一致对待的而不论预测概率大小。为了充分利用模型预估的概率分布，同时考虑到bleu的不可微性质，不能直接在匹配程度损失函数中使用。因此，对上式做出修改，得到式：传统n-bleu计算方式是预测字在真值出现的个数除以字总数，但生成模型可以作弊，过度生成合法字。例如：预测：我我我我参考：我去学校传统bleu＝4/4＝1，bleu分数很高，但并不是一个合理的输出。因此对分子做出改进，得到式。改进后bleu＝min/4＝1/4。因此结合对Cy的改进，最终Cclip计算方法如式所示：因此，预测精度如式所示：最终，匹配程度损失函数如式所示：在式中，N为n-gram最大长度，ωn为每个长度的n-gram的权重，γ表示惩罚系数，惩罚系数如式所示：在式中，c为真值长度，r为预测结果长度。步骤104，基于语义相关损失和匹配程度损失，计算文本生成网络的损失。本实施例中，在得到语义相关损失和匹配程度损失各自的损失函数之后，将文本生成网络的预测结果和真值输入两个损失函数可以得到语义相关损失和匹配程度损失。为了更好训练文本生成网络，可以直接将语义相关损失和匹配程度损失相加，得到文本生成网络的损失，基于文本生成网络的损失调整文本生成网络的参数，直至文本生成网络满足训练完成条件，得到文本生成模型。步骤105，基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。本实施例中，文本生成模型的训练步骤包括：步骤一、在文本样本集中选取文本样本，如步骤101所示；步骤二、将选取的文本样本输入文本生成网络，使文本生成网络对该选取的文本样本进行编码和解码，预测对应该选取的文本样本的预测结果，如步骤102所示；步骤三、基于文本生成网络的预测结果和选取的文本样本中的真值计算文本生成网络的损失值，如步骤103-步骤104所示；步骤四、若文本生成网络不满足训练完成条件，则调整文本生成网络的参数，继续执行步骤一至步骤四，直至文本生成网络满足训练完成条件为止，将文本生成网络作为文本生成模型。本实施例中，训练完成条件包括：文本生成网络的损失达到一定损失阈值或者文本生成网络训练迭代次数达到预设次数，其中，训练迭代次数是指执行步骤一至步骤四的次数。本公开的实施例提供的文本生成模型训练方法，首先，从预先构建的文本样本集中选取文本样本；其次，将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果；再次，基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度；从次，基于语义相关损失和匹配程度损失，计算文本生成网络的损失；最后，基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。由此，使语义相关损失作用在文本生成模型的整个训练过程，可以使文本生成模型区分同义的词或句，而非过度纠正，提高了模型生成精度与多样性；同时使匹配程度损失作用在模型训练过程，可以缓解模型训练中单独字粒度的损失带来的问题，缓解了模型曝光偏差现象，提升了文本生成模型的鲁棒性。在本公开的一些实施例中，上述基于语义相关损失和匹配程度损失，计算文本生成网络的损失，包括：基于预测结果，计算字粒度的交叉熵损失；将交叉熵损失、语义相关损失以及匹配程度损失进行加权求和，得到文本生成网络的损失。本可选实现方式中，交叉熵损失是通过交叉熵函数得到的损失值，将文本生成网络的预设结果输入交叉熵函数对应的公式，如式所示的公式，得到交叉熵损失。在式中，р是概率，为超参数；yt是t时刻的输入文本生成网络的字；y＜t是t时刻之前文本生成网络预测得到的预测结果；x是输入文本生成网络的文本样本。本可选实现方式中，训练初期，文本生成网络的本身语义语法等刻画能力弱，文本生成网络的损失中交叉熵损失的加入可以使文本生成模型更快更好的具备初步的生成能力，提高效率。本可选实现方式提供的计算文本生成网络的损失的方法，基于预测结果，计算字粒度的交叉熵损失，将交叉熵损失添加到文本生成网络的损失计算中，提高了文本生成模型的训练效率，保证了文本生成模型训练的高效性。在本实施例的一些可选实现方式中，如图2所示，上述文本生成网络包括：依次连接的编码器和尾部解码器；文本样本包括：文字序列W和文字序列的真值T，将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果O1，包括：将文字序列W输入编码器，得到编码器输出的编码输出值；将真值T和编码输出值输入解码器，得到编码器输出的预测结果O1。本可选实现方式中，文本生成网络可以采用transformer模型结构，在transformer模型包括两大部分，分别是编码器和尾部解码器，其中编码器负责把自然语言序列映射成为隐藏层，隐藏层即为编码输出值，编码输出值包括自然语言序列的数学表达；然后尾部解码器将编码输出值再映射为自然语言序列，从而使文本生成网络可以解决各种问题,如情感分类、命名实体识别、语义关系抽取、摘要生成、机器翻译等等。本实施例中，上述将真值和编码输出值输入解码器，得到编码器输出的预测结果，包括：将编码输出值和起始符输入尾部解码器，得到尾部解码器输出的文字序列的首个字预测结果；将文字序列中首个字的真值输入尾部解码器，得到文字序列的第二个字预测结果；将首个字的真值以及第二字的真值同时输入尾部解码器，得到文字序列的第三个字预测结果，直至文字序列均预测完成，将终止符输入尾部解码器，从尾部解码器得到对应文字序列的预测结果。在文本生成网络基于文字序列的预测结果和文字序列的的真值进行文本生成网络的损失计算，基于文本生成网络的损失，调整文本生成网络的参数。下面采用一个具体示例解释文本生成网络的工作工程为：1)输入文本样本到编码器，例如文本样本为：Why do we work？，其中“为什么要工作”是自然语言的文字序列：Why do we work？的真值。2)编码器输出的输出值输入到尾部解码器。3)输入起始符到尾部解码器，得到尾部解码器输出的第一个字的预测结果。4)将“为”再输入尾部解码器，得到尾部解码器输出的第二个字的预测结果。5)将“为”和“什”再输入尾部解码器，直至文字序列中所有预测序列输入完，向尾部解码器输入终止符，得到尾部解码器输出的对文字序列的预测结果，通过预测结果计算文本生成网络的损失。本可选实现方式提供的文本生成网络预测方法，文本生成网络采用编码器和尾部解码器结构，采用编解码结构实现文本生成结果的实现，简化了预测结果实现过程，提高了预测效率。在本实施的一些可选实现方式中，在训练文本生成模型时会模拟预测时的输入，打平训练和预测阶段的差异，缓解曝光偏差，两阶段解码策略会使文本生成模型对真值的依赖逐渐降低，具体地，上述文本生成网络还包括：中间解码器，中间解码器连接在编码器和尾部编码器之间；文本样本包括：文字序列W和文字序列的真值T，如图3所示，文本生成网络包括：依次连接的编码器、中间解码器以及尾部解码器。上述将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果，包括：将文字序列W输入编码器，得到编码器输出的编码输出值；将编码输出值和真值T输入中间编码器，得到中间解码器输出的中间输出值Z；基于文本生成网络的当前训练迭代次数，选取中间输出值Z或真值T，得到选取值；将选取值和编码输出值输入尾部解码器，得到尾部编码器输出的预测结果O2。本实施例中，中间解码器输出的中间输出值是与文字序列对应的预测结果，即中间解码器输出的预测结果。参见图3，文本生成网络的训练过程如下：将编码输出值输入中间编码器，并基于真值得到中间解码器输出的中间输出值Z；在中间输出值Z和真值T之间进行动态采样，得到选取值，将选取值作为尾部解码器的输入，尾部解码器基于选取值进行预测，得到预测结果O2。在每次迭代训练过程中，基于尾部解码器的预测结果与真值进行文本生成网络的损失计算。本实施例中，在中间解码器输出中间输出值之后，选取中间输出值作为尾部解码器的一个输入，实现了在文本生成网络在训练阶段模拟预测阶段的行为，使最终生成的文本生成模型可以面对训练和预测两个不同场景更加鲁棒，从而文本生成模型中无论是在尾部解码器输入真值，还是真值不参与尾部解码器，文本生成模型总可以产生类似的输出。本可选实现方式中，文本生成网络的当前训练迭代次数是指从文本生成网络开始训练至当前所在的训练迭代过程，执行主体在进行一次迭代训练增加一，得到至当迭代训练的当前训练迭代次数。传统文本生成模型训练时，直接将样本真值输入到解码器作为参考，但文本模型在预测时没有样本真值所以会导致曝光偏差出现，本可选实现方式提供的得到预测结果的方法，对文本生成网络的结构进行修改，使文本生成网络包括：一个编码器和两个解码器，中间解码器仅是为了获取文本生成模型的本身预测结果输出o1，然后对尾部解码器的输入进行采样。如果输入是样本真值就和传统训练方法一样，如果输入是o1，即文本生成网络的训练不再依赖样本真值，模拟真实的生产环境，增强模型的生成能力。本可选实现方式提供的得到文本生成网络输出的预测结果的方法，通过在模型训练阶段模拟模型预测阶段的行为，使模型面对两个不同的场景更加鲁棒，缓解了预测阶段和训练阶段输入不一致造成的曝光偏差的问题，结合上述实施例提出的文本生成网络的损失，可以更进一步的缓解曝光偏差问题。可选地，文本生成网络包括：依次连接的编码器、中间解码器以及尾部解码器。上述将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果，还包括：将编码输出值输入中间编码器，并基于真值得到中间解码器输出的中间输出值；基于文本生成网络的训练时间，在向尾部解码器输入值时，选取中间输出值或真值，得到选取值；将选取值和编码输出值输入尾部解码器，得到尾部编码器输出的预测结果。在本实施例的一些可选实现方式中，上述基于文本生成网络的当前训练迭代次数，选取中间输出值或真值，得到选取值，包括：确定文本生成网络的当前训练迭代次数；将当前训练迭代次数输入采样概率公式，得到概率值；基于概率值，选取中间输出值或真值，得到选取值。本可选实现方式中，采样概率公式是与文本生成网络的训练迭代次数相关的概率值生成公式，而概率值可以是表示选取真值的采样概率，或者概率值是表示选取中间输出值的采样概率，例如，概率值可以用于表征真值输入尾部解码器的机率，则1-概率值用于表征中间输出值输入尾部解码器的机率，当文本生成网络的训练迭代次数越多，概率值越小，真值输入尾部解码器的次数越少，中间输出值输入尾部解码器的次数越多。本可选实现方式提供的确定选取值的方法，通过采样概率公式使概率值动态调整，文本生成网络的训练迭代次数的逐渐增加使概率值慢慢变小。随着时间会越来越多的使用模型本身输出作为参考，拟合模型的预测阶段的状态，从而缓解了文本生成模型的过度矫正问题，加强了文本生成模型的输出多样性。可选地，上述基于文本生成网络的当前训练迭代次数，选取中间输出值或真值，得到选取值，包括：响应于文本生成网络的当前训练迭代次数小于或等于预设次数，将真值作为选取值；响应于文本生成网络的当前训练迭代次数大于预设次数，将中间输出值作为选取值。在本实施例的一些可选实现方式，概率值为选取真值的采样概率，采样概率公式是与文本生成网络的训练迭代次数相关的概率值生成公式，在所述采样概率公式中，所述概率值与所述训练迭代次数呈反比。具体地，上述采样概率公式可以为式所示：其式中，β为超参数，epoch为当前训练迭代次数，p是选取真值的采样概率。本可选实现方式中，以p使用真值，1-p的概率使用中间输出值的作用是：p会随着训练时间越来越小，即初期会更多以真值作为输入，这样依靠真值更快学习到一定的生成能力，后面更多的以中间输出值做输入，摆脱对真值的依赖，缓解文本生成模型的曝光偏差。本可选实现方式提供的采样概率公式，将当前训练迭代次数输入采样概率公式，得到对应当前训练迭代次数的概率值，为概率值的得到提供了一个可靠实现方式。图4示出了本公开文本生成方法的一个实施例的流程图400，上述文本生成方法包括以下步骤：步骤401，获取待处理素材。在本实施例中，待处理素材是需要文本生成模型处理的原材料，该待处理素材的表现形式可以是文本、视频、音频、图像等，通过对不同表现形式的待处理素材进行相应处理，可以得到适于输入文本生成模型的文本。本实施例中，文本生成方法的执行主体可以通过多种方式来获取待处理素材。例如，执行主体可以通过有线连接方式或无线连接方式，从数据库服务器中获取存储于其中的待处理素材。再例如，执行主体也可以接收终端或其他设备实时采集的待处理素材。在本实施例中，待处理素材可以是一段文本的文本数据，也可能是多段文本的文本数据等，且该待纠错文本数据的格式在本公开中也不限制。步骤402，对待处理素材进行处理，得到待处理文本数据。本实施例中，在待处理素材为文本时，对待处理素材进行处理包括：对待处理素材进行数据清洗、筛选，得到待处理文本数据。在待处理素材为非文本时，上述待处理素材进行处理包括：对待处理素材进行文本识别，得到待处理素材中的文本数据，对文本数据进行数据清洗，得到待处理文本数据。步骤403，将待处理文本数据输入采用文本生成模型训练方法生成的文本生成模型中，得到文本生成模型输出的待处理文本数据的文本生成结果。在本实施例中，执行主体可以将步骤402中获取的待处理文本数据输入文本生成模型中，从而得到文本生成模型输出的待处理文本数据的文本生成结果。其中，文本生成结果是文本生成模型对待处理文本数据进行处理之后分析得到的结果，针对不同任务的文本生成模型，文本生成结果的表现形式不同，例如，文本生成模型为机器翻译模型，则文本生成结果可以是对应待处理文本数据的翻译文本。再如，文本生成模型为情感分类模型，则文本生成结果可以是对应待处理文本数据的正向情感识别结果，或负向情感识别结果。在本实施例中，文本生成模型可以是采用如上述图1实施例所描述的方法而生成的。具体生成过程可以参见图1实施例的相关描述，在此不再赘述。需要说明的是，本实施例文本生成方法可以用于测试上述各实施例所生成的文本生成模型。进而根据文本生成模型的文本生成结果可以不断地优化文本生成模型。该方法也可以是上述各实施例所生成的文本生成模型的实际应用方法。采用上述各实施例所生成的文本生成模型，来进行文本生成，有助于提高文本生成结果得到的准确性。本实施例提供的文本生成方法，获取待处理素材，对待处理素材进行处理得到待处理文本数，将待处理文本数据输入预训练完成的文本生成模型，有助于提高文本生成结果得到的准确性，提高了文本生成结果生成效率以及多样性。在本实施例的一些可选实现方式中，上述文本生成结果包括待处理文本数据的标题、摘要以及标签中的至少一项。本可选实现方式中，待处理文本数据可以一篇文档，为了对该文档进行文本生成，得到对应该文档的标题、摘要以及标签，将待处理文本数据输入文本生成模型，得到文本生成模型输出的对应该待处理文本数据的摘要、标题、标签中的至少一项。本可选实现方式中提供的文本生成结果，为文本生成模型的具体实现提供了一种实现方式，保证了文本生成模型实现的多样性。进一步参考图5，作为对上述各图所示方法的实现，本公开提供了文本生成模型训练装置的一个实施例，该装置实施例与图1所示的方法实施例相对应，该装置具体可应用于各种电子设备中。如图5所示，本实施例提供的文本生成模型训练装置500包括：选取单元501，输入单元502，第一计算单元503，第二计算单元504，训练单元505。其中，上述选取单元501，可以被配置成从预先构建的文本样本集中选取文本样本。上述输入单元502，可以被配置成将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果。上述第一计算单元503，可以被配置成基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度。上述第二计算单元504，可以被配置成基于语义相关损失和匹配程度损失，计算文本生成网络的损失。上述训练单元505，可以被配置成基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。在本实施例中，文本生成模型训练装置500中：选取单元501，输入单元502，第一计算单元503，第二计算单元504，训练单元505的具体处理及其所带来的技术效果可分别参考图1对应实施例中的步骤101、步骤102、步骤103、步骤104、步骤105的相关说明，在此不再赘述。在本实施例的一些可选的实现方式中，上述第二计算单元504进一步被配置成：基于预测结果，计算字粒度的交叉熵损失；将交叉熵损失、语义相关损失以及匹配程度损失进行加权求和，得到文本生成网络的损失。在本实施例的一些可选的实现方式中，上述文本生成网络包括：依次连接的编码器和尾部解码器；文本样本包括：文字序列和文字序列的真值，上述输入单元502进一步被配置成：将文字序列输入编码器，得到编码器输出的编码输出值；将真值和编码输出值输入解码器，得到尾部编码器输出的预测结果。在本实施例的一些可选的实现方式中，上述文本生成网络还包括：中间解码器，中间解码器连接在编码器和尾部编码器之间；上述输入单元502进一步被配置成：将编码输出值和真值输入中间编码器，得到中间解码器输出的中间输出值；基于文本生成网络的当前训练迭代次数，选取中间输出值或真值，得到选取值；将选取值和编码输出值输入尾部解码器，得到尾部编码器输出的预测结果。在本实施例的一些可选的实现方式中，上述输入单元502进一步被配置成：确定文本生成网络的当前训练迭代次数；将当前训练迭代次数输入采样概率公式，得到概率值；基于概率值，选取中间输出值或真值，得到选取值。在本实施例的一些可选的实现方式中，概率值为选取所述真值的采样概率，采样概率公式是与所述文本生成网络的训练迭代次数相关的概率值生成公式，在采样概率公式中，概率值与训练迭代次数呈反比，具体地，上述采样概率公式为：其中，β为超参数，epoch为当前训练迭代次数，p是选取真值的采样概率。本公开的实施例提供的文本生成模型训练装置，首先，选取单元501从预先构建的文本样本集中选取文本样本；其次，输入单元502将文本样本输入预先构建的文本生成网络，得到文本生成网络输出的预测结果；再次，第一计算单元503基于预测结果，分别计算字粒度的语义相关损失和句粒度的匹配程度损失，语义相关损失用于表征预测结果与文本样本的真值在字级别的相似程度，匹配程度损失用于表征预设结果与文本样本的真值在句级别的匹配程度；从次，第二计算单元504基于语义相关损失和匹配程度损失，计算文本生成网络的损失；最后，训练单元505基于文本生成网络的损失，训练得到对应文本生成网络的文本生成模型。由此，使语义相关损失作用在文本生成模型的整个训练过程，可以使文本生成模型区分同义的词或句，而非过度纠正，提高了模型生成精度与多样性；同时使匹配程度损失作用在模型训练过程，可以缓解模型训练中单独字粒度的损失带来的问题，缓解了模型曝光偏差现象，提升了文本生成模型的鲁棒性。继续参见图6，作为对上述图4所示方法的实现，本申请提供了一种文本生成装置的一个实施例。该装置实施例与图4所示的方法实施例相对应，该装置具体可以应用于各种电子设备中。如图6所示，本实施例的文本生成装置600可以包括：获取单元601，可以被配置成获取待处理素材。处理单元602，可以被配置成对待处理素材进行处理，得到待处理文本数据。得到单元603，可以被配置成将待处理文本数据输入如上述图5实施例所描述的装置生成的文本生成模型中，得到文本生成模型输出的待处理文本数据的文本生成结果。可以理解的是，该装置600中记载的诸单元与参考图4描述的方法中的各个步骤相对应。由此，上文针对方法描述的操作、特征以及产生的有益效果同样适用于装置600及其中包含的单元，在此不再赘述。在本实施例的一些可选实现方式中，文本生成结果包括待处理文本数据的标题、摘要以及标签中的至少一项。本公开的技术方案中，所涉及的用户个人信息的收集、存储、使用、加工、传输、提供和公开等处理，均符合相关法律法规的规定，且不违背公序良俗。根据本公开的实施例，本公开还提供了一种电子设备、一种可读存储介质和一种计算机程序产品。图7示出了可以用来实施本公开的实施例的示例电子设备700的示意性框图。电子设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本公开的实现。如图7所示，设备700包括计算单元701，其可以根据存储在只读存储器702中的计算机程序或者从存储单元708加载到随机访问存储器703中的计算机程序，来执行各种适当的动作和处理。在RAM703中，还可存储设备700操作所需的各种程序和数据。计算单元701、ROM 702以及RAM703通过总线704彼此相连。输入/输出接口705也连接至总线704。设备700中的多个部件连接至I/O接口705，包括：输入单元706，例如键盘、鼠标等；输出单元707，例如各种类型的显示器、扬声器等；存储单元708，例如磁盘、光盘等；以及通信单元709，例如网卡、调制解调器、无线通信收发机等。通信单元709允许设备700通过诸如因特网的计算机网络和/或各种电信网络与其他设备交换信息/数据。计算单元701可以是各种具有处理和计算能力的通用和/或专用处理组件。计算单元701的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的计算单元、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。计算单元701执行上文所描述的各个方法和处理，例如文本生成模型训练方法、文本生成方法。例如，在一些实施例中，文本生成模型训练方法、文本生成方法可被实现为计算机软件程序，其被有形地包含于机器可读介质，例如存储单元708。在一些实施例中，计算机程序的部分或者全部可以经由ROM702和/或通信单元709而被载入和/或安装到设备700上。当计算机程序加载到RAM 703并由计算单元701执行时，可以执行上文描述的文本生成模型训练方法、文本生成方法的一个或多个步骤。备选地，在其他实施例中，计算单元701可以通过其他任何适当的方式而被配置为执行文本生成模型训练方法、文本生成方法。本文中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、负载可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本公开的方法的程序代码可以采用一个或多个编程语言的任何组合来编写。这些程序代码可以提供给通用计算机、专用计算机或其他可编程文本生成模型训练装置、文本生成装置的处理器或控制器，使得程序代码当由处理器或控制器执行时使流程图和/或框图中所规定的功能/操作被实施。程序代码可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本公开的上下文中，机器可读介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的程序。机器可读介质可以是机器可读信号介质或机器可读储存介质。机器可读介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在计算机上实施此处描述的系统和技术，该计算机具有：用于向用户显示信息的显示装置或者LCD监视器)；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给计算机。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网和互联网。计算机系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本公开中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本公开公开的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本公开保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本公开的精神和原则之内所作的修改、等同替换和改进等，均应包含在本公开保护范围之内。
