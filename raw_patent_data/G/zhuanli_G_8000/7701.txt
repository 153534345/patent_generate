标题title
基于FY-3D MERSI-II数据的赤潮监测方法及装置
摘要abst
本发明属于环境监测技术领域，具体涉及基于FY‑3D MERSI‑II数据的赤潮监测方法及装置，本发明通过卫星地面分发系统获取实验区的光学遥感数据，并针对光学遥感数据进行数据预处理，根据现场采集的叶绿素a浓度和赤潮信息数据建立对应叶绿素a浓度反演模型和赤潮提取指数，进行实验海区叶绿素a浓度的反演和赤潮信息提取，并基于生产的叶绿素a浓度和对应的赤潮提取指数综合研判赤潮，形成叶绿素a浓度和赤潮监测结果图以及对应的专题产品，最终产品可以为海洋水质监测和赤潮生态灾害预警提供长期稳定的数据支撑和保障。
权利要求书clms
1.基于FY-3D MERSI-II数据的赤潮监测方法，其特征在于，包括以下步骤：通过卫星地面分发系统获取实验区光学遥感数据，选择覆盖海域为晴朗无云的数据；针对光学遥感数据进行数据预处理，预处理包括大气校正、几何校正、海陆掩膜和云检测，其中，MERSI-II大气校正利用辐射传输模型进行计算，从卫星影像获取的总遥感反射率中去除瑞利散射和气溶胶散射，几何校正通过经纬度数据集构建地理查找表，基于地理查找表进行几何校正，海陆掩膜利用官方发布的区域陆地矢量文件进行剔除，保留海洋区域数据，云检测通过构建的云掩膜指数进行剔除；根据现场采集的叶绿素a浓度和赤潮信息数据建立叶绿素a浓度反演模型和赤潮提取指数，结合现场实测数据，分析对叶绿素a浓度敏感的波段并结合MERSI-II数据的光谱响应函数构建叶绿素a浓度反演模型，结合赤潮藻类的特征，构建赤潮信息提取指数MRI；根据步骤的叶绿素a浓度反演模型反演叶绿素a浓度，同时利用对应的赤潮信息提取指数MRI进行赤潮信息提取，选取叶绿素a浓度大于1.3 mg/m3的阈值和MRI大于4阈值共同作用提取赤潮；将提取的叶绿素a浓度和赤潮信息快速批量专题制图。2.根据权利要求1所述的方法，其特征在于，所述步骤中，采用FY-3D MERSI-II L1B数据，选择图像中海域云覆盖率＜30%的遥感数据。3.根据权利要求1所述的方法，其特征在于，所述步骤中，卫星接收到的大气瑞利散射为： ，其中，为卫星接收到的瑞利散射，是MERSI-II L1B数据对应的第i波段，为瑞利光学厚度，为臭氧的透射率，为单次散射反照率，是太阳以三种不同的通道散射到卫星的概率因子，为太阳天顶角，为太阳天顶角余弦，为卫星天顶角，为卫星天顶角余弦；计算瑞利散射校正反射率：其中，为观测方向的大气漫透射率，为气溶胶散射反射率，是瑞利散射反射率，是卫星观测总的反射率，是离水反射率。4.根据权利要求1所述的方法，其特征在于，所述步骤中，基于GDAL库中GEOLOC校正算法进行几何校正，通过FY-3D MERSI-II数据对应的地理定位文件中经纬度数据集进行构建地理查找表，然后实现MERSI-II数据的几何校正。5.根据权利要求1所述的方法，其特征在于，所述步骤中，选取FY-3D MERSI-II数据中3个对云、地表比较敏感的波段进行云检测，将0.65 μm与0.94 μm云与各种地物波谱特征形成明显反差，将两者归一化处理，选择I-cloud指数判断某个像素是否是云，其中，B0.65为0.65 μm中心波长对应的波段，B0.94为0.94 μm中心波长对应的波段。6.根据权利要求1所述的方法，其特征在于，所述步骤中，利用改进三波段算法提取赤潮，通过现场实测的光谱数据结合FY-3D MERSI -II的光谱特性，选择中心波长555 nm、443 nm、490 nm组合进行赤潮提取，其中MRI如下式：，其中，MRI为赤潮信息提取指数，B555为中心波长555 nm对应的波段，B443为中心波长443 nm对应的波段，B490为中心波长490 nm对应的波段。7.根据权利要求1所述的方法，其特征在于，所述步骤中，将步骤提取的叶绿素a浓度和赤潮提取图增加信息后形成专题图。8.根据权利要求1-7任一项所述方法采用的装置，其特征在于，所述装置包括：遥感数据获取模块，用于获取遥感数据；遥感数据预处理模块，用于进行大气校正、几何校正、云检测及海陆掩膜处理；叶绿素a浓度反演模块，用于预处理后的FY-3D MERSI-II数据进行叶绿素a浓度反演；赤潮信息提取模块，用于赤潮信息提取；专题信息制图模块，用于赤潮专题制图，提供数据发布应用。
说明书desc
技术领域本发明属于环境监测技术领域，涉及海洋叶绿素a浓度反演和赤潮监测，具体涉及基于FY-3D MERSI-II数据的赤潮监测方法及装置。背景技术海洋叶绿素是海水中浮游植物含量的表征，通过叶绿素浓度的研究能够了解海水中浮游植物的生长情况，能够用来评价水体的富营养程度、水质和预测赤潮。相对于传统水质参数的现场观测，采用遥感手段通过获取海面光学经大气校正和定量反演得到叶绿素a等水体要素信息，进而实现对近海水体大范围动态监测，为近海初级生产力、赤潮生态灾害监测等提供了一种有效工具。发明内容本发明的目的在于解决传统现场观测手段无法实现近海二类水体大面积、高时间分辨率获取叶绿素a浓度和赤潮频发区快速监测响应的问题，提出了一种基于FY-3DMERSI-II数据的赤潮监测方法及装置，具体为基于FY-3D多光谱遥感数据进行二类水体的海表叶绿素a浓度反演和赤潮爆发区高频次监测方法，利用FY-3D MERSI-II遥感数据反演叶绿素浓度信息，为海洋初级生产力的遥感估算奠定了基础，同时有助于了解海洋碳循环，对渔业资源管理等具有重要意义；该方法还可以结合叶绿素a浓度进行赤潮的识别，能够对赤潮海洋生态灾害及时响应和处置。本发明的技术方案是：基于FY-3D MERSI-II数据的赤潮监测方法，其特征在于，包括以下步骤：通过卫星地面分发系统获取实验区光学遥感数据，选择覆盖海域为晴朗无云的数据；针对光学遥感数据进行数据预处理，预处理包括大气校正、几何校正、海陆掩膜和云检测，其中，MERSI-II大气校正利用辐射传输模型进行计算，从卫星影像获取的总遥感反射率中去除瑞利散射和气溶胶散射，几何校正通过经纬度数据集构建地理查找表，基于地理查找表进行几何校正，海陆掩膜利用官方发布的区域陆地矢量文件进行剔除，保留海洋区域数据，云检测通过构建的云掩膜指数进行剔除；根据现场采集的叶绿素a浓度和赤潮信息数据建立叶绿素a浓度反演模型和赤潮提取指数，结合现场实测数据，分析对叶绿素a浓度敏感的波段并结合MERSI-II数据的光谱响应函数构建叶绿素a浓度反演模型，结合赤潮藻类的特征，构建赤潮信息提取指数MRI；根据步骤的叶绿素a浓度反演模型反演叶绿素a浓度，同时利用对应的赤潮信息提取指数MRI进行赤潮信息提取，选取叶绿素a浓度大于1.3 mg/m3的阈值和MRI大于4阈值共同作用提取赤潮；将提取的叶绿素a浓度和赤潮信息快速批量专题制图。进一步的，所述步骤中，采用FY-3D MERSI-II L1B数据，选择图像中海域云覆盖率＜30%的遥感数据。进一步的，所述步骤中，卫星接收到的大气瑞利散射为： ，其中，为卫星接收到的瑞利散射，是MERSI-II L1B数据对应的第i波段，为瑞利光学厚度，为臭氧的透射率，为单次散射反照率，是太阳以三种不同的通道散射到卫星的概率因子，为太阳天顶角，为太阳天顶角余弦，为卫星天顶角，为卫星天顶角余弦；计算瑞利散射校正反射率：其中，为观测方向的大气漫透射率，为气溶胶散射反射率，是瑞利散射反射率，是卫星观测总的反射率，是离水反射率。进一步的，所述步骤中，基于GDAL库中GEOLOC校正算法进行几何校正，通过FY-3D MERSI-II数据对应的地理定位文件中经纬度数据集进行构建地理查找表，然后实现1KMMERSI-II数据的几何校正。进一步的，所述步骤中，选取FY-3D MERSI-II数据中3个对云、地表比较敏感的波段进行云检测，将0.65 μm与0.94 μm云与各种地物波谱特征形成明显反差，将两者归一化处理，选择I-cloud指数判断某个像素是否是云，其中，B0.65为0.65 μm中心波长对应的波段，B0.94为0.94 μm中心波长对应的波段。进一步的，所述步骤中，利用改进三波段算法提取赤潮，通过现场实测的光谱数据结合FY-3D MERSI -II的光谱特性，选择中心波长555 nm、443 nm、490 nm组合进行赤潮提取，其中MRI如下式：，其中，MRI为赤潮信息提取指数，B555为中心波长555 nm对应的波段，B443为中心波长443 nm对应的波段，B490为中心波长490 nm对应的波段。进一步的，所述步骤中，将步骤提取的叶绿素a浓度和赤潮提取图增加信息后形成专题图。本发明还包括一种基于FY-3D MERSI-II数据的赤潮监测方法的装置，所述装置包括：遥感数据获取模块，用于获取遥感数据；遥感数据预处理模块，用于进行大气校正、几何校正、云检测及海陆掩膜处理；叶绿素a浓度反演模块，用于预处理后的FY-3D MERSI-II数据进行叶绿素a浓度反演；赤潮信息提取模块，用于赤潮信息提取；专题信息制图模块，用于赤潮专题制图，提供数据发布应用。本发明通过卫星地面分发系统获取实验区的光学遥感数据并进行预处理，根据现场采集的叶绿素a浓度和赤潮信息数据建立对应叶绿素a浓度反演模型和赤潮提取指数进行实验海区叶绿素a浓度的反演和赤潮信息提取，基于生产的叶绿素a浓度和对应的赤潮提取指数综合研判赤潮，形成叶绿素a浓度和赤潮监测结果图以及对应的专题产品，最终产品可以为海洋水质监测和赤潮生态灾害预警提供长期稳定的数据支撑和保障。本发明的有益效果：本发明采用国产FY-3D MERSI-II数据的近海二类水体叶绿素a浓度反演和赤潮监测，可以实现每天研究区1-2次叶绿素a浓度和赤潮识别结果，对于和人类活动密切相关的海洋环境监测具有重要的意义。本发明克服传统现场观测手段无法实现近海二类水体大面积、高时间分辨率获取叶绿素a浓度和赤潮频发区快速监测响应的问题，提供一种利用高时空分辨率遥感数据进行中国东海海表叶绿素a浓度反演和赤潮快速监测流程，并提供一种基于FY-3DMERSI-II数据的赤潮监测装置，能够及时对赤潮海洋生态灾害作出响应和处置。本发明的算法基于Python语言开发已经实现工程化应用，形成了对应的批处理软件，基于FY-3D卫星接收的频次可以实现单一区域每天1-2次的专题制图，实现高效的海洋环境监测和生态灾害预警应用。附图说明图1为本发明实施例提供的基于FY-3D MERSI-II数据的赤潮监测方法的处理流程图；图2为本发明实施例提供的基于FY-3D MERSI-II数据的赤潮监测装置的结构示意图；图3为基于FY-3D MERSI-II数据的叶绿素a浓度反演流程图；图4为FY-3D MERSI-II几何校正处理流程图；图5为基于FY-3D MERSI-II进行赤潮监测流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。为了进一步理解本发明，将结合附图和实施例对本发明作进一步的说明。实施例1如图1所示，本发明提供了基于FY-3D MERSI-II数据的东海叶绿素a浓度反演和赤潮监测方法，该方法的处理流程包括：S1. 通过卫星地面分发系统获取实验区的光学遥感数据，选择覆盖海域为晴朗无云的数据，采用FY-3D MERSI-II L1B数据，选择图像中海域云覆盖率＜30%的遥感数据。S2. 针对光学遥感数据预处理算法进行数据预处理，MERSI-II大气校正利用辐射传输模型进行计算，从卫星影像获取的总遥感反射率中去除瑞利散射和气溶胶散射；几何校正通过经纬度数据集构建地理查找表，基于地理查找表进行几何校正；海陆掩膜利用官方发布的区域陆地矢量文件进行剔除；云检测通过构建云掩膜指数进行剔除；MERSI-II大气校正中瑞利散射在卫星海洋遥感观测时占传感器接收的总辐射的较大，在蓝光波段占80%~90%，卫星接收到的大气瑞利散射为：其中，是卫星接收到的瑞利散射，是MERSI-II L1B数据对应的第i波段，是瑞利光学厚度，是臭氧的透射率，是单次散射反照率，是太阳以三种不同的通道散射到卫星的概率因子，为太阳天顶角，为太阳天顶角余弦，为卫星天顶角，为卫星天顶角余弦；计算瑞利散射校正反射率：其中是观测方向的大气漫透射率，为气溶胶散射反射率，是瑞利散射反射率，是卫星观测总的反射率，是离水反射率。利用MERSI-II 412 nm波段作为暗像元，即假设，为412 nm的气溶胶散射反射率、为中心波长412 nm的瑞利散射校正反射率；计算865 nm气溶胶散射反射率：式中，为预估的NIR波段气溶胶发射比，即；为了避免应用在近海清洁水体时过校正，对于的像元，则；最后提取；其中，是离水反射率，是观测方向的大气漫透射率；最终按照公式求出作为叶绿素a浓度反演和赤潮提取的基础数据。如图4所示，基于国产FY-3D MERSI-II数据的几何校正是基于GDAL库中的GEOLOC校正算法，通过FY-3D MERSI-II数据对应的地理定位文件中经纬度数据集构建地理查找表进行几何校正，生成对应的几何校正影像。地理位置查找表文件是一个二维图像文件，文件中所包含两个波段：地理校正影像的行和列，文件对应的灰度值表示原始影像每个像素对应的地理位置坐标信息，用有符号整型储存，它的符号说明输出像元是对应于真实的输入像元，是由邻近像元生成的填实像元。输入longitude波段和latitude波段，输出GLT文件的投影信息Geographic Lat/Lon，然后利用GLT信息实现原始L1B级MERSI-II数据的几何校正，实现1KM MERSI-II数据的几何校正，将结果数据保持为TIFF文件。选取FY-3D/MERSI-II数据中3个对云、地表比较敏感的波段进行云检测。针对云及下垫面地物在可见光、红外波段的发射和辐射特性差异，综合考虑可见光、红外波段光谱特性进行阈值检测，在可见光0.65 μm波段处晴空数据一般具有较低的反射率，其值为0~0.3；而云的发射率则高于30%，因此可见光0.65 μm波段是进行云检测的首选波段，同时云在近红外波段0.94 μm处的波谱特征与大气中的含水量有关，可反映大气中的水汽特征，所以将0.65 μm与0.94 μm云与各种地物波谱特征形成明显反差，将两者归一化处理一方面可以突出云的信息，另一方面可以部分消除太阳高度角、卫星扫描角及大气程辐射的影响。选择I-cloud指数选择最后判断某个像素是否是云；其中，B0.65为0.65 μm中心波长对应的波段，B0.94为0.94 μm中心波长对应的波段。S3. 根据现场采集的叶绿素a浓度和赤潮信息数据建立对应叶绿素a浓度反演模型和赤潮提取指数，通过多个时相和卫星准同步的现场观测数据，结合现场采样点的实测光谱数据、叶绿素a浓度、赤潮爆发区域藻类密度，分析对叶绿素a浓度敏感的波段并结合MERSI-II数据的光谱响应函数构建叶绿素a浓度反演模型，结合赤潮藻类的特征，构建出适用于MERSI-II数据的近海区域赤潮提取指数。利用黄东海的叶绿素4波段算法进行叶绿素a浓度反演。其中：，c1= 0.342，c2 = 2.511，c3 = 0.277，c4 = -1.012；为叶绿素a浓度；为叶绿素反演中间量；为443 nm对应的遥感反射率；为412 nm对应的遥感反射率；为555 nm对应的遥感反射率；为490 nm对应的遥感反射率。构建适用于特定海区的赤潮指数是目前光学遥感数据提取赤潮比较有效的手段，通过对浙江省海洋灾害公报2011-2020年的数据分析发现东海原甲藻赤潮是东海潮爆发的优势藻，通过现场实测的光谱数据结合FY-3D MERSI -II的光谱特性，创新性的选择555 nm、443 nm、490 nm组合进行赤潮提取，可以消除二类水体高悬浮泥沙的影响，对于赤潮水域555 nm处的遥感反射率将会明显增大，而490 nm和443 nm处附近的遥感反射率将会降低，导致MRI值异常增大，通过多次试验尝试选取MRI ＞4提取的区域作为疑似赤潮发生区域，结合统计分析功能，实现区域分布面积和覆盖面积统计。其中MRI如下式：，其中，B555为中心波长555 nm对应的波段，B443为中心波长443 nm对应的波段，B490为中心波长490 nm对应的波段。S4. 基于FY-3D MERSI-II数据的叶绿素a浓度反演流程如图3所示，基于S2中大气校正、几何校正、云检测后的数据，结合现场实测数据或者同类卫星产品的数据，基于S3构建的叶绿素a模型进行实验海区叶绿素a浓度的反演，并利用现场实测数据进行精度评价。S5. 基于FY-3D MERSI-II数据的赤潮提取流程如图5所示，基于S2中大气校正、几何校正、云检测后的数据，并进行海陆掩膜，同时结合辅助的历史赤潮爆发区域赤潮爆发的MRI值，确定MRI 提取阈值，然后利用叶绿素a浓度反演结果结合赤潮指数进行赤潮信息提取，基于S4生产的叶绿素a浓度和对应的赤潮提取指数综合研判赤潮，形成赤潮结果图。结合叶绿素a浓度和MRI指数的东海赤潮提取，利用上述步骤中反演得出的叶绿素a浓度和获取的MRI图像，综合选取叶绿素a浓度大于1.3 mg/m3的阈值和MRI＞4阈值共同作用提取赤潮。S6. 叶绿素a浓度和赤潮信息快速批量专题制图，将S5提取的叶绿素a浓度和赤潮提取图增加图例、图名、制图单位等信息后形成专题图。从数据预处理到叶绿素a浓度产品和赤潮监测产品生产的一键式专题制图，针对业务化运行的需求，基于C++/Python混合编程方法实现大气校正、几何校正、云检测、海陆掩膜等预处理功能后，基于预处理后的FY-3D MERSI-II数据实现近海二类水体叶绿素a浓度反演和赤潮高效监测。实施例2本发明提供了基于FY-3D MERSI-II数据的赤潮监测装置，如图2所示，该装置包括：遥感数据获取模块S201，用于获取海域云覆盖率＜30%的遥感数据；遥感数据预处理模块S202，用于进行FY-3D/MERSI-II数据大气校正、几何校正、云检测、海陆掩膜处理；叶绿素a浓度反演模块S203，用于预处理之后的FY-3D/MERSI-II数据利用叶绿素a浓度反演算法生产叶绿素a浓度产品；赤潮信息提取模块S204，基于叶绿素a浓度反演模块生产的叶绿素a浓度产品，并结合赤潮提取算法阈值判断生产赤潮信息产品；专题信息制图模块S205，基于叶绿素a浓度反演产品和赤潮信息提取产品进行专题产品制图，提供数据发布应用。上述说明仅为本发明的优选实施例，并非是对本发明的限制，尽管参照前述实施例对本发明进行了详细的说明，对于本领域技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改型等，均应包含在本发明的保护范围之内。
