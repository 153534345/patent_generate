标题title
一种室内可见光定位校准方法
摘要abst
本发明涉及一种室内可见光定位校准方法，属于通信网络技术领域。校准方法的目标是精确测量确定接收端位置所需的环境参数。本发明使用移动机器人进行数据收集，获得具有光源信标位置及其身份的环境地图。在构建地图过程中，本发明根据光源的位置坐标和频率来过滤光源，只需要知道光源之间的最小间隔大致有多远，不再需要预先知道光源的数量。该地图可以在应用程序中使用，例如显示用户的位置。此外，本发明通过使用地图匹配来提高系统精度。本发明综合考虑了室内可见光定位校准方法的实现，弥补了室内可见光定位系统校准方法的空白。
权利要求书clms
1.一种室内可见光定位校准方法，其特征在于，包含以下步骤：步骤1：使用移动机器人进行数据收集，构建具有光源信标位置及其身份的环境地图；在构建地图过程中，根据光源的位置坐标和频率来过滤光源，故只需要知道光源之间的最小间隔大致有多远，不再需要预先知道光源的数量；步骤2：利用校准方法得到光源位置及其频率的环境地图；步骤3：为了保证构建地图过程中光源乃至系统的精确性，本发明根据光源的位置坐标和频率来过滤无用光源。2.根据权利要求1所述的一种室内可见光定位校准方法，其特征在于，所述步骤2具体为：首先，使用互补金属氧化物半导体相机捕获的调制光源；然后，对原始图像进行模糊处理，并计算出光源位置；再次，围绕光源的中心点裁剪原始图像，生成子图;接下来，通过Canny边缘检测子图中条纹的轮廓，计算从亮条纹到暗条纹的过渡之间的像素数；一条亮条纹和一条暗条纹对应于一个信号周期，得到调制频率；最后，利用激光扫描仪的测量数据重建跟踪轨迹，将机器人的运动轨迹与检测到的光源相结合，得到光源相对位置的环境地图。3.根据权利要求1所述的一种室内可见光定位校准方法，其特征在于，所述步骤3具体为：首先，将与平均位置的距离超过2个标准偏差的检测位置坐标定义为异常值，从每个频率的检测位置坐标中去除异常值；然后，移除只观察到几次的光源，将剩余光源的坐标按检测次数求平均；接下来，进行“空间滤波”机制，将相互靠近的光源组合在一起，根据光源的坐标进行滤波，当两个光源之间的距离低于一定阈值时，去掉检测次数最少的LED，如果两盏灯都有相同的检测次数，则将它们的位置和检测频率取平均，从而得到具有正确数量的光源地图。
说明书desc
技术领域本发明属于通信网络技术领域，涉及一种室内可见光定位校准方法。背景技术随着固态照明的发展，出现了一种新型的室内定位——可见光定位。可见光定位系统可以利用现有的照明基础设施实现定位，从而大大降低整体系统成本。由于光的传播特性，多径效应显著降低，进而实现高精度定位。然而，可见光室内定位系统需要某种形式的信标校准。例如，假设所有发射端的位置都是已知的，通过三角测量来确定接收端位置，手动测量发射器位置可能是一个繁琐的过程，因为发射器通常安装在天花板和墙壁上。在指纹识别系统中需要一个校准过程，以便建立一个基于信号强度的地图用于定位，但这些现场调查可能是漫长且繁杂的过程。此外，当环境发生变化时，可能需要更新上述RSS映射。然而，在可见光定位领域很少有校准方法的研究。因此，本发明提出了一种应用于室内可见光定位系统的改进的校准方法。该方法使用移动机器人进行数据收集，根据光源的坐标和频谱来过滤光源，使用校准的参数进行定位，从而闭合了校准和定位之间的环路，实现了易于部署的高性能可见光定位系统校正方法。综上，本发明涉及室内可见光定位校准方法。发明内容为解决上述问题，本发明公开了一种室内可见光定位校准方法，该方法使用移动机器人进行数据收集，获得具有光源位置及其身份的环境地图，利用环境地图匹配来提高系统精度。由于互补金属氧化物半导体相机的滚动快门，被捕获的调制光源在图像上以条纹图案形式可见，其中条纹的宽度与发射端调制频率成正比。首先，对原始图像进行模糊处理，并计算出光源位置。然后，围绕光源的中心点裁剪原始图像，生成子图。接下来，通过Canny边缘检测子图中条纹的轮廓，计算从亮条纹到暗条纹的过渡之间的像素数。一条亮条纹和一条暗条纹对应于一个信号周期，得到调制频率。最后，利用激光扫描仪的测量数据重建跟踪轨迹，将机器人的运动轨迹与检测到的光源相结合，得到光源相对位置的环境地图。然而，同一个LED每次被捕获也许会被标上不同的频率。其中，Canny边缘检测步骤可能会计算出比实际值大或小一个像素的条纹图案，从而在频谱中产生较小的扩展。此外，由于噪声的影响，检测到的光源的世界坐标也可能不是单点。因此，单点光源可能会在光源地图中显示一组坐标。本发明根据光源的位置坐标和频率来过滤无用光源。首先，本发明将与平均位置的距离超过2个标准偏差的检测位置坐标定义为异常值，从每个频率的检测位置坐标中去除异常值。然后，移除只观察到几次的光源，将剩余光源的坐标按检测次数求平均。接下来，进行“空间滤波”机制，将相互靠近的光源组合在一起，根据光源的坐标进行滤波，当两个光源之间的距离低于一定阈值时，去掉检测次数最少的LED。如果两盏灯都有相同的检测次数，则将它们的位置和检测频率取平均，从而得到具有正确数量的光源地图。因此，构建地图只需要知道光源之间的最小间隔有多远，不需要预先知道光源的数量。本发明提出的室内可见光定位校准方法具有如下优点：本发明提出的校准方法提高了室内可见光定位的定位精度;该方法使用移动机器人进行数据收集，并能够获得具有信标位置及其身份的环境地图。该地图可以在应用程序中使用，例如显示用户的位置;此外，可以通过使用地图匹配来提高系统精度;实现了易于部署的高性能可见光定位系统。附图说明图1为本发明室内可见光定位校准方法架构图；图2为本发明提出的校准方法流程图；图3a为本发明在两种运动轨迹实验期间记录数据构建的示例光源地图，其中图为“之”字形;图3b为本发明在两种运动轨迹实验期间记录数据构建的示例光源地图，其中图为“走走停停”；图4为本发明提出的系统校正方法在两种轨迹实验的累计误差分布图；图5为本发明校准两种轨迹实验的持续时间和处理时间；图6为本发明提出的系统矫正方法频率估计精度与发射端-接收端距离的关系图；图7a为本发明在1m距离拍摄的光源图像；图7b为本发明在3m距离拍摄的光源图像；图7c为本发明在5m距离拍摄的光源图像；图8为本发明光源位置误差累积分布误差图；图9a为扩展卡尔曼滤波器；图9b为粒子滤波器；图9c为混合粒子/卡尔曼滤波器。具体实施方式下面结合附图和具体实施方式，进一步阐明本发明，应理解下述具体实施方式仅用于说明本发明而不用于限制本发明的范围。需要说明的是，下面描述中使用的词语“前”、“后”、“左”、“右”、“上”和“下”指的是附图中的方向，词语“内”和“外”分别指的是朝向或远离特定部件几何中心的方向。本发明考虑室内可见光定位校准方法架构图，如图1所示。可见光定位系统由两个主要模块组成：经过不同的频率调制的多盏LED作为发射端，搭载激光扫描仪和摄像头的移动机器人作为接收端。校准方法可以得到光源位置及其频率的环境地图，如图2所示，具体步骤如下：步骤1：使用互补金属氧化物半导体相机捕获的调制光源，可以得到带有条纹的图像，其中条纹的宽度与发射器频率成正比；步骤2：对原始图像进行模糊处理，计算出光源位置；步骤3：围绕光源的中心点裁剪原始图像，生成子图；步骤4：通过Canny边缘检测子图中条纹的轮廓，并计算从亮条纹到暗条纹的过渡之间的像素数。一条亮条纹和一条暗条纹对应于一个信号周期，从而得到调制频率；步骤5：利用激光扫描仪的测量数据重建跟踪轨迹，将机器人的运动轨迹与检测到的光源相结合，得到光源地图。然而，因为每次捕获的图像不同，同一个LED也许会被标上不同的频率。Canny边缘检测步骤可能会计算出比实际值大或小一个像素的条纹图案，从而在频谱中产生较小的扩展。此外，由于质心检测和机器人定位的噪声，检测到的光源的世界坐标也可能不是单点。因此，单点光源可能会在光源地图中显示为一组坐标。本发明根据光源的位置坐标和频率来过滤无用光源。首先，本发明将与平均位置的距离超过2个标准偏差的检测位置坐标定义为异常值，从每个频率的检测位置坐标中去除异常值。然后，移除只观察到几次的光源，将剩余光源的坐标按检测次数求平均。接下来，进行“空间滤波”机制，将相互靠近的光源组合在一起，根据光源的坐标进行滤波，当两个光源之间的距离低于一定阈值时，去掉检测次数最少的LED。如果两盏灯都有相同的检测次数，则将它们的位置和检测频率取平均，从而得到具有正确数量的光源地图。因此，构建地图只需要知道光源之间的最小间隔有多远，不再需要预先知道光源的数量。校准方法可以得到光源位置及其频率的环境地图。本发明通过将信号发生器施加的频率与校准程序确定的频率进行比较来实现评估频率检测的精度，将校准方法确定的坐标与真实世界的坐标进行比较来实现评估LED的位置检测的精度。为了更好地理解所提出方法的优点和局限性，本发明研究许多因素对校准方法效果的影响。机器人的运动状态可能会影响校准结果。一方面，如果机器人保持一直运动状态，校准时间将会减少。另一方面，运动模糊可能会对结果产生负面影响。在实验过程中，测试了两种不同类型的轨迹：“之”字形和“走走停停”的轨迹。在第一种轨迹实验中，机器人持续运动，经过每一个光源，同时以“之”字形轨迹覆盖实验空间，图3a为根据“之”字形轨迹实验期间记录的数据构建的示例光源地图。从图中可以看出该种轨迹实验种系统性能很差，没有一个光源被映射。在第二种轨迹实验中，机器人按顺序向每个光源移动，一旦摄像头在LED正下方，花费几秒钟记录数据，再继续到下一盏LED下，图3b为根据“走走停停”轨迹实验期间记录的数据构建的示例光源地图，从图中可以看出该种轨迹实验种系统性能较好。图4为两种轨迹实验的累计误差分布图，可以看出“走走停停”轨迹下得到光源相对位置明显更加精确。图5为校准两种轨迹实验的持续时间和处理时间。可以观察到，使用“走走停停”的轨迹类型的实验执行校准并没有花费太多的时间。“之”字形轨迹类型的实验是一种穷举的搜索，因此需要很长时间。相比之下，“走走停停”轨迹类型的实验不是一个连续的运动，而是在收集真正需要的数据。与“之”字形相比，“走走停停”轨迹类型的实验的处理时间略有增加。由于在这种类型的实验中，更多的被检测光源靠近图像中心，因此被过滤的图像更少。因此，需要处理更多的图像，处理时间也增加了。然而，实际上大部分时间都花在了光源映射构建地图上。因此，图像处理的增加时间对所需的总时间只有很小的影响。此外，校准方法可以离线执行，因此不会造成阻塞。综合考虑许多其他类型的轨迹，可以得出结论，机器人应该在每个LED处短暂停留，以获得准确的结果。随着发射端和接收端之间的距离增加，捕获图像中LED感兴趣区域会变小，可见的条纹会变少，导致确定发射端光源的频率更具挑战性。发射端和接收端之间的距离从1米增加到5米，在每一个距离增量处记录图像并根据图像确定LED频率。计算真实频率和校准程序估计的频率之间的差异。图6为频率估计精度与发射端-接收端距离的关系图。对于短距离，精确度约为95%。然而，从2米的距离开始，不能检测到光源，因此精度为0%。图7a为本发明在1m距离拍摄的光源图像；图7b为本发明在3m距离拍摄的光源图像； 图7c为本发明在5m距离拍摄的光源图像； 在1米的距离，可以看到几个水平条纹，由此可以计算出发射端光源的频率；在3米的距离，只有一个条纹是可见的，发射端光源的频率无法确定。图8为光源位置误差的累积误差分布图。本发明对超过80%的光源可以实现10 cm的精度定位。随着频率的增加，条纹的宽度减小，像素的检测误差导致大的频率误差。低频和中频光源可以实现相对较高的精度。不同滤波器校准方法的累积定位误差分布图，如图，图9a为扩展卡尔曼滤波器；图9b为粒子滤波器；图9c为混合粒子/卡尔曼滤波器。校准方法的目标是精确测量确定接收器位置所需的环境参数。校准误差将可能导致定位误差，需要确定校准误差对可见光定位的影响，以验证本发明的校准方法是否提供令人满意的结果。本发明使用“走走停停”轨迹驱动机器人，并使用基于传感器融合的方法进行定位，其中包括三种滤波器，即扩展卡尔曼滤波器、粒子滤波器和混合粒子/卡尔曼滤波器。在这些定位方法中，均使用来自校准方法的参数。从图中可以看出，机器人校准更加精确，本发明的可以提高可见光定位系统的精度。本发明方案所公开的技术手段不仅限于上述实施方式所公开的技术手段，还包括由以上技术特征任意组合所组成的技术方案。
