标题title
一种基于深度学习行为序列的视频推荐方法及系统
摘要abst
本发明提供一种基于深度学习行为序列的视频推荐方法，包括：根据视频平台上用户的行为足迹，提取用户评价行为序列信息，构建视频序列并预处理，且将每一视频名作为一个词，通过词向量模型以负采样的方式训练，得到视频特征向量及组成的视频特征向量库；在视频特征向量库中，对用户评价行为序列进行词嵌入，并提取各视频特征向量的深度特征，捕捉潜在联系，且进一步预测出一系列视频来形成候选推荐视频集合；对候选推荐视频集合初步筛选，并结合用户对每类视频的兴趣得分进行二次筛选，得到向用户推荐的最终视频列表。实施本发明，解决了现有推荐方法中推荐精度较低及推荐效果有限的问题，使得推荐精度更加准确且推荐效果更加明显。
权利要求书clms
1.一种基于深度学习行为序列的视频推荐方法，其特征在于，所述方法包括以下步骤：步骤S1、根据视频平台上用户的行为足迹，提取用户评价行为序列信息，以构建视频序列，且将所述视频序列预处理之后，将每一视频名均作为一个词，通过预设的词向量模型以负采样的方式训练，得到与各视频名相对应的视频特征向量，并将各视频特征向量组成视频特征向量库；步骤S2、在所述视频特征向量库中，对用户评价行为序列进行词嵌入，并利用预设的深度学习网络，提取各视频特征向量的深度特征，以捕捉各视频特征向量之间的潜在联系，且进一步对用户的评价行为序列进行预测，预测出一系列视频来形成候选推荐视频集合；步骤S3、根据预定规则，对所述候选推荐视频集合中视频进行初步筛选，并结合预设用户兴趣模型所计算的用户对每类视频的兴趣得分，得到用户兴趣偏好分布，且进一步基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行二次筛选，得到向用户推荐的最终视频列表。2.如权利要求1所述的基于深度学习行为序列的视频推荐方法，其特征在于，所述步骤S1具体包括：基于用户在所述视频平台上产生的行为足迹，得到用户评价行为序列信息；其中，所述用户评价行为序列信息包括用户标识、视频标识、评价分数、评价时间戳及视频类型；根据所述用户评价行为序列信息中的评价时间戳，构建视频序列，并利用预设的间隔时间桶，将所述视频序列切分成若干个序列并类比成自然语言语料的词序列；将各切分的视频序列中每一视频名均作为一个词，通过预设的Word2Vec词向量模型采用负采样技术构建负样本，并结合所述视频序列中原有的各视频为正样本，形成训练样本；构建视频特征向量模型目标函数，并采用所述训练样本对所述视频特征向量模型目标函数进行训练，得到与各视频名相对应的视频特征向量，且进一步将所得到的各视频特征向量组合成视频特征向量库。3.如权利要求2所述的基于深度学习行为序列的视频推荐方法，其特征在于，所述方法进一步包括：在采用所述训练样本对所述视频特征向量模型目标函数进行训练时，通过设定窗口大小及视频特征向量维度，并采用随机梯度上升法和自适应学习率来优化所述视频特征向量模型目标函数，以得到与各视频名相对应的视频特征向量。4.如权利要求1所述的基于深度学习行为序列的视频推荐方法，其特征在于，所述步骤S2具体包括：在所述视频特征向量库中，将每部视频所对应视频特征向量进行特征向量嵌入，组成视频特征向量矩阵；采用深度学习技术对所述视频特征向量矩阵进行分析，通过卷积神经网络以及残差网络提取视频的深度特征，再通过基于长短期记忆网络以及注意力机制优化的Seq2Seq网络对深度特征序列进行深度提取特征，并预测出一系列视频为推荐候选视频来形成候选推荐视频集合。5.如权利要求1所述的基于深度学习行为序列的视频推荐方法，其特征在于，所述步骤S3具体包括：通过视频特征向量计算相似度，寻找候选视频的相似视频，以实现对所述候选推荐视频集合中视频进行初步筛选；融合时间函数与视频的评价来建立用户兴趣模型，并根据所述用户兴趣模型，计算出用户对每类视频的兴趣得分，得到用户兴趣偏好分布；基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行过滤及排序，得到向用户推荐的最终视频列表。6.如权利要求5所述的基于深度学习行为序列的视频推荐方法，其特征在于，所述相似度的计算通过公式来实现；其中，sim为视频N和视频M的余弦相似度；为中的元素，为第i个视频的特征向量，即视频i可记为d为视频特征向量矩阵。7.如权利要求5所述的基于深度学习行为序列的视频推荐方法，其特征在于，所述用户兴趣模型通过如下公式表示：其中，为时间效用函数；Q为用户的视频评价序列，即为Qu＝{v1,v2,v3,L,vμ}；λ为序列中视频vλ在序列中所对应的序列号；μ为序列的长度；G＝{g1,g2,g3,L,gβ}为预设视频平台中视频的类型；gλ为视频vλ所属的类型；β为视频类型数目；τ为用户对视频vλ的评价分数，分为五个等级对应1-5分；zi为用户对视频类型gi兴趣偏好分数。8.一种基于深度学习行为序列的视频推荐系统，其特征在于，包括：视频特征向量库形成单元，用于根据视频平台上用户的行为足迹，提取用户评价行为序列信息，以构建视频序列，且将所述视频序列预处理之后，将每一视频名均作为一个词，通过预设的词向量模型以负采样的方式训练，得到与各视频名相对应的视频特征向量，并将各视频特征向量组成视频特征向量库；候选推荐视频集合形成单元，用于在所述视频特征向量库中，对用户评价行为序列进行词嵌入，并利用预设的深度学习网络，提取各视频特征向量的深度特征，以捕捉各视频特征向量之间的潜在联系，且进一步对用户的评价行为序列进行预测，预测出一系列视频来形成候选推荐视频集合；最终推荐视频列表形成单元，用于根据预定规则，对所述候选推荐视频集合中视频进行初步筛选，并结合预设用户兴趣模型所计算的用户对每类视频的兴趣得分，得到用户兴趣偏好分布，且进一步基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行二次筛选，得到向用户推荐的最终视频列表。
说明书desc
技术领域本发明涉及计算机应用技术领域，尤其涉及一种基于深度学习行为序列的视频推荐方法及系统。背景技术移动互联网时代，人们观看视频的媒介渐渐地从电视转向了在线视频平台。比如，爱奇艺、腾讯视频以及优酷视频等平台已成为如今热门的在线视频平台，平台每月活跃人数多达3.85亿人。目前，在线视频平台因拥有的数量巨大、种类繁多、不断更新的视频资源，从而满足了用户日常的各种兴趣需求，深受用户的喜爱。然而，视频资源与日俱增以及用户规模不断剧增，导致出现数据信息过载和资源有效利用低等问题。因此，各大视频平台均投入大量人力物力对视频推荐技术进行深入研究，通过视频推荐系统来感知用户需求，个性化地为用户推荐视频资源，缩短了用户到所需视频资源的距离，提高了用户黏度以及增加了平台盈利。其中，视频推荐技术能够解决用户在视频搜索中检索时间长、推荐列表单一等问题，快速找到用户所想要观看的视频，并推荐符合用户兴趣的视频列表。现有技术中，基于协同过滤的推荐方法被大多数视频推荐系统所采用，该方法依据用户对视频、物品等的评价来匹配与其相似度高的用户，根据相似用户向其推荐项目，但是该方法在用户未对项目进行评价时，会出现数据稀疏和冷启动问题，导致推荐精度较低。另外，该方法仅关注于用户历史选择的项目偏好建模，但忽略了用户的序列行为信息，制约了推荐效果。因此，提出一种基于深度学习行为序列的视频推荐方法，利用深度学习的特征表示能力，对改善现有推荐方法是非常有必要的。发明内容本发明实施例所要解决的技术问题在于，提供一种基于深度学习行为序列的视频推荐方法及系统，解决了现有推荐方法中推荐精度较低及推荐效果有限的问题，使得推荐精度更加准确且推荐效果更加明显，还缓解了面临的数据稀疏问题。为了解决上述技术问题，本发明实施例提供了一种基于深度学习行为序列的视频推荐方法，所述方法包括以下步骤：步骤S1、根据视频平台上用户的行为足迹，提取用户评价行为序列信息，以构建视频序列，且将所述视频序列预处理之后，将每一视频名均作为一个词，通过预设的词向量模型以负采样的方式训练，得到与各视频名相对应的视频特征向量，并将各视频特征向量组成视频特征向量库；步骤S2、在所述视频特征向量库中，对用户评价行为序列进行词嵌入，并利用预设的深度学习网络，提取各视频特征向量的深度特征，以捕捉各视频特征向量之间的潜在联系，且进一步对用户的评价行为序列进行预测，预测出一系列视频来形成候选推荐视频集合；步骤S3、根据预定规则，对所述候选推荐视频集合中视频进行初步筛选，并结合预设用户兴趣模型所计算的用户对每类视频的兴趣得分，得到用户兴趣偏好分布，且进一步基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行二次筛选，得到向用户推荐的最终视频列表。其中，所述步骤S1具体包括：基于用户在所述预设视频平台上产生的行为足迹，得到用户评价行为序列信息；其中，所述用户评价行为序列信息包括用户标识、视频标识、评价分数、评价时间戳及视频类型；根据所述用户评价行为序列信息中的评价时间戳，构建视频序列，并利用预设的间隔时间桶，将所述视频序列切分成若干个序列并类比成自然语言语料的词序列；将各切分的视频序列中每一视频名均作为一个词，通过预设的Word2Vec词向量模型采用负采样技术构建负样本，并结合所述视频序列中原有的各视频为正样本，形成训练样本；构建视频特征向量模型目标函数，并采用所述训练样本对所述视频特征向量模型目标函数进行训练，得到与各视频名相对应的视频特征向量，且进一步将所得到的各视频特征向量组合成视频特征向量库。其中，所述方法进一步包括：在采用所述训练样本对所述视频特征向量模型目标函数进行训练时，通过设定窗口大小及视频特征向量维度，并采用随机梯度上升法和自适应学习率来优化所述视频特征向量模型目标函数，以得到与各视频名相对应的视频特征向量。其中，所述步骤S2具体包括：在所述视频特征向量库中，将每部视频所对应视频特征向量进行特征向量嵌入，组成视频特征向量矩阵；采用深度学习技术对所述视频特征向量矩阵进行分析，通过卷积神经网络以及残差网络提取视频的深度特征，再通过基于长短期记忆网络以及注意力机制优化的Seq2Seq网络对深度特征序列进行深度提取特征，并预测出一系列视频为推荐候选视频来形成候选推荐视频集合。其中，所述步骤S3具体包括：通过视频特征向量计算相似度，寻找候选视频的相似视频，以实现对所述候选推荐视频集合中视频进行初步筛选；融合时间函数与视频的评价来建立用户兴趣模型，并根据所述用户兴趣模型，计算出用户对每类视频的兴趣得分，得到用户兴趣偏好分布；基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行过滤及排序，得到向用户推荐的最终视频列表。其中，所述相似度的计算通过公式来实现；其中，sim为视频N和视频M的余弦相似度；为中的元素，为第i个视频的特征向量，即视频i可记为d为视频特征向量矩阵。其中，所述用户兴趣模型通过如下公式表示：其中，为时间效用函数；Q为用户的视频评价序列，即为Qu＝{v1,v2,v3,L,vμ}；λ为序列中视频vλ在序列中所对应的序列号；μ为序列的长度；G＝{g1,g2,g3,L,gβ}为预设视频平台中视频的类型；gλ为视频vλ所属的类型；β为视频类型数目；τ为用户对视频vλ的评价分数，分为五个等级对应1-5分；zi为用户对视频类型gi兴趣偏好分数。本发明实施例还提供了一种基于深度学习行为序列的视频推荐系统，包括：视频特征向量库形成单元，用于根据预设视频平台上用户的行为足迹，提取用户评价行为序列信息，以构建视频序列，且将所述视频序列预处理之后，将每一视频名均作为一个词，通过预设的词向量模型以负采样的方式训练，得到与各视频名相对应的视频特征向量，并将各视频特征向量组成视频特征向量库；候选推荐视频集合形成单元，用于在所述视频特征向量库中，对用户评价行为序列进行词嵌入，并利用预设的深度学习网络，提取各视频特征向量的深度特征，以捕捉各视频特征向量之间的潜在联系，且进一步对用户的评价行为序列进行预测，预测出一系列视频来形成候选推荐视频集合；最终推荐视频列表形成单元，用于根据预定规则，对所述候选推荐视频集合中视频进行初步筛选，并结合预设用户兴趣模型所计算的用户对每类视频的兴趣得分，得到用户兴趣偏好分布，且进一步基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行二次筛选，得到向用户推荐的最终视频列表。实施本发明实施例，具有如下有益效果：1、本发明采用深度学习和兴趣模型感知方法，提出了一种基于群体评价行为序列深度学习的视频推荐方法，通过将用户评价行为序列中的视频看作彼此有联系的个体，采用Word2Vec网络将每个视频用一个高维的向量来表示，以此来区分各视频的特征，相比普通的基于用户-视频矩阵分解来挖掘视频表示进行推荐的方法，推荐精度更加准确且推荐效果更加明显；2、本发明针对视频序列，利用改进的序列到序列的深度学习模型和视频特征向量相似获得到推荐候选列表，再根据用户对视频的评价序列构建用户的兴趣模型挖掘用户的兴趣偏好，对候选推荐列表进行精排序，从而在有限行为数据下考虑用户行为模式和动态兴趣来精确地预测候选视频，缓解了视频推荐面临的数据稀疏问题。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见，下面描述中的附图仅仅是本发明的一部分实施例。对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，根据这些附图获得其他的附图仍属于本发明的范畴。图1为本发明实施例提供的基于深度学习行为序列的视频推荐方法的流程图；图2为本发明实施例提供的基于深度学习行为序列的视频推荐方法中视频序列的模型结构图；图3为本发明实施例提供的基于深度学习行为序列的视频推荐方法中视频特征向量模型目标函数训练过程的流程图；图4为本发明实施例提供的基于深度学习行为序列的视频推荐方法中深度学习网络的网络结构示意图；图5为本发明实施例提供的基于深度学习行为序列的视频推荐方法的应用场景中视频特征向量降维可视化效果图；图6为本发明实施例提供的基于深度学习行为序列的视频推荐方法的应用场景中推荐视频Top-n数比较图；图7为本发明实施例提供的基于深度学习行为序列的视频推荐方法的应用场景中电影推荐评价结果对比图；图8为本发明实施例提供的基于深度学习行为序列的视频推荐方法的应用场景中所设计的Seq_5推荐算法与传统的四种算法的评价结果对比图；图9为本发明实施例提供的基于深度学习行为序列的视频推荐系统的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步地详细描述。如图1所示，为本发明实施例中，提出的一种基于深度学习行为序列的视频推荐方法，所述方法包括以下步骤：步骤S1、根据视频平台上用户的行为足迹，提取用户评价行为序列信息，以构建视频序列，且将所述视频序列预处理之后，将每一视频名均作为一个词，通过预设的词向量模型以负采样的方式训练，得到与各视频名相对应的视频特征向量，并将各视频特征向量组成视频特征向量库；具体过程为，首先，基于用户在视频平台上产生的行为足迹，得到用户评价行为序列信息；其中，该用户评价行为序列信息包括用户标识U、视频标识Md、评价分数R、评价时间戳T及视频类型G等。其次，根据用户评价行为序列信息中的评价时间戳T，构建视频序列，记为MD＝，并利用预设的间隔时间桶，将视频序列切分成若干个序列并类比成自然语言语料的词序列。然后，将各切分的视频序列中每一视频名均作为一个词，通过预设的Word2Vec词向量模型采用负采样技术构建负样本，并结合视频序列中原有的各视频为正样本，形成训练样本。例如，视频序列中的视频名xi和上下文context，context＝{xi-K,xi-K+1……xi-1,xi+1……xi+K-1,xi+K}，K为窗口大小。基于Word2Vec模型采用负采样技术构建负样本，只有视频序列中原有的各视频为正样本，即视频词为自身序列原来位置时为正样本，其余的都为负样本。此时，根据视频名在视频序列集合中出现的频率对给定的context进行负采样，负样本集合为NEG,{x}为正样本集合，给每一个样本集合赋予一个标签，定义式中，Lx表示中心视频词x的标签，即正样本的标签为1，负样本的标签为0。根据正样本{x}和负样本NEG，得到训练样本,x,NEG)。最后，构建视频特征向量模型目标函数，并采用训练样本对所述视频特征向量模型目标函数进行训练，得到与各视频名相对应的视频特征向量，且进一步将所得到的各视频特征向量组合成视频特征向量库。例如，对于一个给定的训练样本,x,NEG),利用极大似然估计，设视频特征向量模型目标函数为g式中，p)表示中心视频词δ在上下文为context时出现的概率。g表示中心视频词为正样本的似然概率。在训练准备阶段，将序列集合中的每个视频表示为一个m维的向量θδ，为上下文context的视频特征向量的累加，令其中，σ为Sigmoid函数，当Lx＝1时，表示中心视频词x的概率；当Lx＝0时，表示不是中心视频词x的概率。将式代入式中可得：对于视频序列集合SET,基于负采样的连续词袋模型作为整体的优化目标为γ。为方便计算，对γ取对数，最终目标γ可表示成H应当说明的是，在采用训练样本对所述视频特征向量模型目标函数进行训练时，通过设定窗口大小及视频特征向量维度，并采用随机梯度上升法和自适应学习率来优化视频特征向量模型目标函数，以得到与各视频名相对应的视频特征向量。在一个实施例中，视频特征向量模型目标函数训练过程，如图3所示。模型训练时，设定窗口大小为K、视频特征向量维度为m，采用随机梯度上升法和自适应学习率优化目标函数，以花费最少的训练时间来获取最大化的视频特征模型使模型达到最优，最终获得各视频名所应的视频特征向量，形成视频特征向量库。步骤S2、在所述视频特征向量库中，对用户评价行为序列进行词嵌入，并利用预设的深度学习网络，提取各视频特征向量的深度特征，以捕捉各视频特征向量之间的潜在联系，且进一步对用户的评价行为序列进行预测，预测出一系列视频来形成候选推荐视频集合；具体过程为，首先，在视频特征向量库中，将每部视频所对应视频特征向量进行特征向量嵌入，组成视频特征向量矩阵。例如，将视频序列最大长度设为n，每部视频嵌入的特征向量为m，组成视频特征向量矩阵如所示。其中：为第i个视频特征向量，即视频i记为d为视频特征向量矩阵。最后，采用深度学习技术对视频特征向量矩阵进行分析，通过卷积神经网络以及残差网络提取视频的深度特征，再通过基于长短期记忆网络以及注意力机制优化的Seq2Seq网络对深度特征序列进行深度提取特征，并预测出一系列视频为推荐候选视频来形成候选推荐视频集合。例如，将卷积神经网络以及注意力机制融入于传统的Seq2Seq模型中，提取出序列之间的上下文关系，其网络结构如图4所示。对视频特征向量矩阵d，利用卷积层提取其深度特征，实现卷积操作如公式所示。公式中，wj,k表示为卷积核的权重，bj,k为偏置，d为输入卷积层的视频特征向量，Relu为卷积层的激活函数；S表示为视频特征向量在卷积后的输出矩阵。同时，通过池化层对卷积输出的矩阵进行深度视频特征压缩，加快运行速度。本发明采用最大池化的方式池化，池化的窗口大小为B×B每一个卷积核得到一个池化值，将这些值拼接起来组成池化后的输出矩阵L，即此外，深度学习模型中常常随着网络深度增加出现梯度消失和梯度爆炸问题，导致网络训练无法收敛。残差神经网络中的残差结构恒等映射，将最初的视频特征向量矩阵传递到后面的卷积神经网络，解决了梯度问题，也使得网络的性能得到了提升。计算公式如式。式中，函数表示为待学习的残差映射,Re为残差结构输出矩阵。另外，编码器Encode中包含长短期记忆网络，能学习到各相邻视频特征向量的深度联系，将池化层输出的视频深度特征矩阵转化为对应的隐向量。该隐向量ht表示当前视频深度特征和其上下文的信息。编码器的上下文向量context vector c包含整个视频序列深度特征的隐向量。计算公式如式:。ht＝f其中，f为LSTM网络单元，ht为在t时刻编码LSTM的隐向量。接着，解码器是将蕴含丰富信息的视频深度上下文向量context vectorc通过LSTM网络单元来预测视频序列中的下一个视频。当输入编码器的视频序列过长，解码器不能很好的捕捉到视频序列的重要信息，导致预测准确性能降低。针对此问题，在Seq2Seq模型中增加注意力机制，利用注意力机制挖掘隐向量中重要的信息，提高了模型的预测精度。式:中，eti表示输入视频序列中每个视频深度特征中注意力得分，为对齐函数，其作用计算编码器中的每个视频xi的对应的隐向量hi与解码器中的隐向量st-1的匹配度，匹配度越高，注意力值也越高。αti表示注意力概率分布，用softmax函数对eti归一化而得。ci表示每个生成的视频名yi所对应的语义向量。qi＝f p＝g根据所得语义向量ci和隐向量si利用式和求得生成视频名yi的条件概率，以最大概率的视频名输出。可以理解的是，在深度学习网络模型的训练阶段，将平台中群体用户的评价行为序列作为输入，其序列末端后一时刻所评价的视频名作为目标值，并计算目标值与Decode端输出的loss值。不断优化loss值，使网络模型达到最佳效果。在候选视频的推荐阶段，一位用户的评价行为序列输入到训练好的模型中，Decode端输出来预测此用户将要观看的视频，再将预测出的视频名添加到序列的末端，再次进行预测。以此方法，预测出一系列的视频进行视频推荐。步骤S3、根据预定规则，对所述候选推荐视频集合中视频进行初步筛选，并结合预设用户兴趣模型所计算的用户对每类视频的兴趣得分，得到用户兴趣偏好分布，且进一步基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行二次筛选，得到向用户推荐的最终视频列表。具体过程为，首先，通过视频特征向量计算相似度，寻找候选视频的相似视频，以实现对所述候选推荐视频集合中视频进行初步筛选。例如，深度学习模型预测的视频数量有限，且预测的精度可能会随着预测视频数量的增加而降低，因此截取视频预测的前半部分作为视频推荐的粗列表。每个视频都有相应的特征向量，通过特征向量计算相似度，寻找粗列表中候选视频的相似视频，拓展推荐列表内容。相似度计算常用的方法有欧几里得距离、余弦相似度、杰卡德相似系数和皮尔逊相关系数。余弦相似度通过计算空间两个向量的夹角的余弦值，获得向量的相似度。考虑到视频训练得到的特征向量为高维向量且维度相同，本发明选用余弦相似度来计算视频之间的相似度，此时余弦相似度的计算公式如下：式中，sim为视频N和视频M的余弦相似度；为式中的元素。然后，融合时间函数与视频的评价来建立用户兴趣模型，并根据所述用户兴趣模型，计算出用户对每类视频的兴趣得分，得到用户兴趣偏好分布。例如，将时间函数和视频评价分数融入兴趣模型，计算用户评价行为序列中各类视频的综合兴趣偏好度，建立用户个性化兴趣模型，从而得到用户的兴趣偏好分布。其中，用户兴趣模型通过如下公式表示：式中，为时间效用函数；Q为用户的视频评价序列，即为Qu＝{v1,v2,v3,L,vμ}；λ为序列中视频vλ在序列中所对应的序列号；μ为序列的长度；G＝{g1,g2,g3,L,gβ}为预设视频平台中视频的类型；gλ为视频vλ所属的类型；β为视频类型数目；τ为用户对视频vλ的评价分数，分为五个等级对应1-5分；zi为用户对视频类型gi兴趣偏好分数。最后，基于用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行过滤及排序，得到向用户推荐的最终视频列表。例如，根据以上获得的用户视频类型兴趣偏好分数进行归一化，得到用户视频类型兴趣分布计算公式如下：最终，基于公式，将过滤后进行排序并生成的视频推荐列表呈现给用户。如图5至图8所示，为本发明实施例提供的基于深度学习行为序列的视频推荐方法的应用场景验证说明：通过在公开的视频数据集MovieLens-1M进行实验。该数据集由MovieLens用户所提供的电影评分数据组成，包括用户名、视频名、评价等级、评价时间、视频类型以及用户的人口统计学数据等。如今各大在线视频平台，用户年龄、邮编、性别和职业等都涉及到用户的隐私，无法从平台上爬取，通常可爬取到用户网名、视频评论、时间及分数和视频类型。因此，选用视频数据集MovieLens-1M中用户标识、视频名、评价等级、评价时间、视频类型作为本发明的数据来源。在离线的环境下，将本发明视频推荐方法与传统的协同过滤推荐算法、较热门的基于奇异值矩阵分解的推荐方法以及基于神经网络的推荐算法作比较。本发明对MovieLens-1M数据集进行预处理，删除有缺失、乱码的用户数据，对每个用户的评价行为数据按照时间轴发展进行排序，统计数据如表1所示。表1将上述筛选得到的实验数据按8：2的比例划分为训练集和验证集，在装有两张NVIDIA Tesla K30显卡、32GB内存以及56核的计算机工作站上进行实验，采用Tensorflow框架训练网络。从MovieLens-1M数据经筛选后，利用上述词向量模型对3554部视频名进行视频特征向量训练，获取向量维度为150的视频向量，通过t-SNE算法进行降维，映射至二维平面，如下图5所示。对视频数据中18种视频类型采用不同的颜色和图形进行标注。图中可以看出，每一类视频分布比较集中，可以很好的把每一类电影分开。其中出现多种电影类型集中在一起，是因为一部视频所属的类型包含两种或多种所导致的，这说明词向量模型具有较好的特征提取效果。为了有效、客观地评价本发明视频推荐方法的效果，选用推荐系统使用广泛的评价指标：准确率、召回率和F1指标。准确率是推荐视频列表在用户实际观看视频集合中的命中率，是推荐系统中的重要评价指标之一，如式所示，其中T为推荐系统向用户推荐的视频列表，N表示为用户实际观看视频的集合。召回率指推荐视频列表中有效推荐视频与用户实际观看视频集合的重合率，如式所示。随着向用户推荐视频列表长度的增加，准确率会随之降低，而召回率会随之增大。为了避免出现准确率很高，而召回率低的现象，引入综合指标作为此推荐系统的评价指标之一，如式所示。实验设置输入视频序列的长度为100。采用时间桶分割获得不同长度的视频序列，若序列的长度没有的达到100，用0将其补充序列长度为100。视频序列中的元素通过视频特征向量模型嵌入为150维的高维向量，输入到优化后的Seq2Seq模型。实验所设计的Seq2Seq模型的Encode结构中，共设置3个卷积网络单元和1个残差结构。先利用卷积窗口为3×1的卷积神经网络挖掘输入向量的深度特征，再将获得的特征通过LSTM网络学习序列中各视频特征间的潜在联系，所得的特征向量再通过注意力机制对其分配不同的权重进行Decode结构解码，预测出序列后续用户可能要观看的视频，进行视频推荐实验。Seq_5算法：根据本发明提出改进的Seq2Seq模型对用户视频观看记录进行预测出10部电影，其中每一部视频的向量寻找出最相近的5部电影，形成粗推荐列表。在构建融合视频评分和时间函数的用户兴趣模型，过滤和排序粗推荐列表，最后将Top-n部视频推荐给用户。本发明设定了三组实验，根据实际用户未来观看视频集合数目为20，推荐Top-10、Top-20、Top-30以及Top-40部视频于用户。实验中，当视频推荐列表中的视频，也存在于用户实际所观看视频集合中，即为这部视频命中。实验结果如表2，图6、7。表2从实验结果可看出，准确率随着推荐视频数目的增加而增加，而召回率呈减小的趋势。从F1值来看，向用户推荐视频数目为Top-30推荐效果最好。因此，选取视频推荐列表Top-30与其他算法进行比较。本发明所设计的Seq_5推荐算法与传统的协同过滤方法、热门的基于奇异值矩阵分解的推荐方法,本发明设计的seq_1方法，以及论文中所提出的基于递归神经网络的时间异质推荐算法进行比较，设定向用户视频推荐Top-n＝30。其中，Seq_1方法根据预测出的每部视频寻其最相似的视频，其余参数和Seq_5方法保持一致。DRLec利用递归神经网络分析用户每个反馈活动序列的变化趋势，估计用户在某一特定的反馈序列中的偏好某一特定的物品的概率。五种算法推荐结果，利用准确率、召回率、F1值三个推荐系统重要指标对结果进行评估。表3为五种算法评价结果，黑色加粗字体为一个指标下最好的结果,括号内的数字代表该方法至少提升率。表3从表3和图8可以明显的得出，在同一数据集下，本发明所提出的Seq_5推荐方法较其他四种推荐方法，不管在准确率、召回率还是F1值评价指标上，都具有很大的优势。基于视频的协同过滤推荐算法和基于奇异值矩阵分解的推荐算法，都需要构建用户-视频的评分矩阵进行推荐。当用户观看视频类型广泛且数量较多，极易造成矩阵稀疏、计算的时间复杂程度增加，导致推荐精度低。然而，基于奇异值矩阵分解的推荐算法通过矩阵分解的方式，一定程度上缓解了矩阵稀疏的问题。从推荐的实验结果也可以看出，SVD推荐算法优于CF推荐算法，但这两种算法都不能很好地捕捉到用户动态兴趣转移，推荐精度有待提升。本发明提出的推荐算法根据用户对所看视频评论序列，搭建深度学习网络模型进行预测，避免了协同过滤算法数据稀疏的问题。同时，本发明推荐算法可以从视频序列中感知用户兴趣变化，满足用户的个性化需求。如图9所示，为本发明实施例中，提供的一种基于深度学习行为序列的视频推荐系统，包括：视频特征向量库形成单元110，用于根据视频平台上用户的行为足迹，提取用户评价行为序列信息，以构建视频序列，且将所述视频序列预处理之后，将每一视频名均作为一个词，通过预设的词向量模型以负采样的方式训练，得到与各视频名相对应的视频特征向量，并将各视频特征向量组成视频特征向量库；候选推荐视频集合形成单元120，用于在所述视频特征向量库中，对用户评价行为序列进行词嵌入，并利用预设的深度学习网络，提取各视频特征向量的深度特征，以捕捉各视频特征向量之间的潜在联系，且进一步对用户的评价行为序列进行预测，预测出一系列视频来形成候选推荐视频集合；最终推荐视频列表形成单元130，用于根据预定规则，对所述候选推荐视频集合中视频进行初步筛选，并结合预设用户兴趣模型所计算的用户对每类视频的兴趣得分，得到用户兴趣偏好分布，且进一步基于所述用户兴趣偏好分布，对初步筛选后的候选推荐视频集合中视频进行二次筛选，得到向用户推荐的最终视频列表。实施本发明实施例，具有如下有益效果：1、本发明采用深度学习和兴趣模型感知方法，提出了一种基于群体评价行为序列深度学习的视频推荐方法，通过将用户评价行为序列中的视频被看作彼此有联系的个体，采用Word2Vec网络将每个视频用一个高维的向量来表示，以此来区分各视频的特征，相比普通的基于用户-视频矩阵分解来挖掘视频表示进行推荐的方法，推荐精度更加准确且推荐效果更加明显；2、本发明针对视频序列，利用改进的序列到序列的深度学习模型和视频特征向量相似获得到推荐候选列表，再根据用户对视频的评价序列构建用户的兴趣模型挖掘用户的兴趣偏好，对候选推荐列表进行精排序，从而在有限行为数据下考虑用户行为模式和动态兴趣来精确地预测候选视频，缓解了视频推荐面临的数据稀疏问题。值得注意的是，上述系统实施例中，所包括的各个单元只是按照功能逻辑进行划分的，但并不局限于上述的划分，只要能够实现相应的功能即可；另外，各功能单元的具体名称也只是为了便于相互区分，并不用于限制本发明的保护范围。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分步骤是可以通过程序来指令相关的硬件来完成，所述的程序可以存储于一计算机可读取存储介质中，所述的存储介质，如ROM/RAM、磁盘、光盘等。以上所揭露的仅为本发明一种较佳实施例而已，当然不能以此来限定本发明之权利范围，因此依本发明权利要求所作的等同变化，仍属本发明所涵盖的范围。
