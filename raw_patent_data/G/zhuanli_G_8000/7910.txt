标题title
一种微纳机器人集群的驱动控制系统
摘要abst
本申请公开了一种微纳机器人集群的驱动控制系统，涉及微纳机器人技术领域，该系统中上位机模组从视觉模组获取的实时图像中识别得到集群实时位置，基于集群实时位置、磁场方向角和磁场俯仰角通过扩展状态观测器得到系统状态向量的估计值，利用方向控制器和力控制器可以得到磁场方向角和磁场俯仰角进而控制三轴亥姆霍兹线圈产生的磁场，本申请将微纳器人集群的运动速度也作为状态量引入到ESO中，利用新设计的ESO可以实现微纳机器人集群更高精度的轨迹跟踪与定位。
权利要求书clms
1.一种微纳机器人集群的驱动控制系统，其特征在于，所述系统包括上位机模组、视觉模组、三轴亥姆霍兹线圈、功率放大器和电源，所述电源通过所述功率放大器给所述三轴亥姆霍兹线圈供电，所述上位机模组连接并控制所述视觉模组和所述功率放大器；所述三轴亥姆霍兹线圈布设在待驱动的微纳机器人集群的工作空间处，且所述三轴亥姆霍兹线圈产生覆盖微纳机器人集群的工作空间的磁场，所述视觉模组的视场范围覆盖微纳机器人集群的工作空间；所述上位机模组通过所述视觉模组获取微纳机器人集群的实时图像，并从所述实时图像中识别得到集群实时位置，基于当前采样时刻t的集群实时位置、磁场方向角α和磁场俯仰角γ通过扩展状态观测器得到系统状态向量的估计值，所述系统状态向量的估计值包括集群位置估计值、集群速度估计值和扰动估计值；所述上位机模组根据集群位置目标值和集群位置估计值利用方向控制器确定磁场方向角的更新值α，所述上位机模组根据集群位置估计值、集群速度估计值、扰动估计值和磁场方向角的更新值α确定磁场俯仰角的更新值γ；所述上位机模组根据磁场方向角的更新值α和磁场俯仰角的更新值γ控制所述功率放大器以调节所述三轴亥姆霍兹线圈中通入的电流，微纳机器人集群的运动状态与所述三轴亥姆霍兹线圈产生的匀强磁场的场强相关，所述三轴亥姆霍兹线圈产生的匀强磁场的场强与通入的电流相关。2.根据权利要求1所述的驱动控制系统，其特征在于，当前采样时刻t得到的系统状态向量的估计值为且：其中，为上一个采样时刻得到的系统状态向量的估计值，t＝1时Z为初始值，a0、ε分别为系数，β1、β2、β3、β4、β5、β6为观测器增益，qmx是x轴的集群实时位置，qmy是y轴的集群实时位置；是x轴的集群位置估计值，是y轴的集群位置估计值，是x轴的集群速度估计值，是y轴的集群速度估计值，是x轴的扰动估计值，是y轴的扰动估计值。3.根据权利要求1所述的驱动控制系统，其特征在于，所述方向控制器为PID控制器，所述上位机模组将集群位置目标值和集群位置估计值的跟踪误差作为PID控制器的输入，得到磁场方向角的更新值α。4.根据权利要求1所述的驱动控制系统，其特征在于，所述力控制器为MPC控制器，所述力控制器基于F-Fd1-Fd2+Δ＝ma的动力学方程设计，其中F为等效磁推力且与磁场频率f、磁场方向角的更新值α以及磁场俯仰角相关；粘性阻力Fd1与集群液体速度差的一次方相关，压差阻力Fd2与集群液体速度差的平方相关，集群液体速度差是集群速度估计值与液体速度估计值的矢量差，液体速度估计值基于集群位置估计值确定；Δ是干扰力且与扰动估计值相关；m是微纳机器人集群的质量；a是微纳机器人集群的加速度且是集群位置估计值的二次导数。5.根据权利要求1所述的驱动控制系统，其特征在于，所述上位机模组根据调节参数利用磁场电流模型生成放大器控制参数，并按照所述放大器控制参数控制所述功率放大器以调节所述三轴亥姆霍兹线圈中通入的电流，所述上位机模组存储有多个磁场电流模型，根据同一组调节参数利用不同的磁场电流模型得到的放大器控制参数不同，所述调节参数包括磁场方向角和磁场俯仰角。6.根据权利要求5所述的驱动控制系统，其特征在于，所述上位机模组根据调节参数利用第一磁场电流模型生成放大器控制参数控制所述功率放大器，使得所述三轴亥姆霍兹线圈生成旋转磁场，微纳机器人集群在旋转磁场的作用下形成旋涡状集群；所述上位机模组从所述实时图像中识别得到旋涡状集群的分布尺寸以及微纳机器人集群所在环境的目标通道的尺寸，当旋涡状集群的分布尺寸大于目标通道的尺寸而确定呈旋涡状集群的微纳机器人集群无法通过目标通道时，所述上位机模组根据所述调节参数利用第二磁场电流模型生成放大器控制参数控制所述功率放大器，使得所述三轴亥姆霍兹线圈生成振荡磁场，微纳机器人集群在振荡磁场的作用下形成条状集群。7.根据权利要求6所述的驱动控制系统，其特征在于，所述调节参数还包括磁场频率，当上位机模组确定旋涡状集群的分布尺寸大于目标通道的尺寸时，所述上位机模组改变所述调节参数中的磁场频率，并利用第一磁场电流模型生成放大器控制参数控制所述功率放大器、以改变所述三轴亥姆霍兹线圈生成的旋转磁场的场强，旋涡状集群的形态分布参数与所述三轴亥姆霍兹线圈生成的旋转磁场的场强相关；当通过调节磁场频率得到的旋涡状集群的最小的分布尺寸大于目标通道的尺寸时，确定呈旋涡状集群的微纳机器人集群无法通过目标通道。8.根据权利要求6所述的驱动控制系统，其特征在于，所述调节参数还包括磁场频率，所述上位机模组改变所述调节参数中的磁场频率，并利用第二磁场电流模型生成放大器控制参数控制所述功率放大器、以改变所述三轴亥姆霍兹线圈生成的振荡磁场的场强，条状集群的形态分布参数与所述三轴亥姆霍兹线圈生成的振荡磁场的场强相关。9.根据权利要求7所述的驱动控制系统，其特征在于，当所述上位机模组确定微纳机器人集群所在环境的目标通道的尺寸大于旋涡状集群的最小的分布尺寸时，所述上位机模组根据调节参数重新利用第一磁场电流模型生成放大器控制参数控制所述功率放大器，使得所述三轴亥姆霍兹线圈重新生成旋转磁场。10.根据权利要求1所述的驱动控制系统，其特征在于，在微纳机器人集群运动过程中，所述上位机模组从所述实时图像中识别得到微纳机器人集群的形态分布参数，当基于形态分布参数确定微纳机器人集群的聚集水平不满足目标聚集水平时，改变磁场频率，所述形态分布参数包括面积比、形状比、分布中心和分布半径中的至少一种。
说明书desc
技术领域本申请涉及微纳机器人技术领域，尤其是一种微纳机器人集群的驱动控制系统。背景技术微纳机器人是指尺寸在微纳米级别的机器人，在众多驱动类型中，磁场驱动式微纳机器人具有入侵性小、远程化、驱动力强等优点，故而在生物医疗领域具有极佳的应用前景。最近，微纳机器人在细胞甚至分子水平的体内诊断与治疗方面表现出巨大潜力，然而单个微纳机器人运载有限，体内成像与定位困难，这就限制了它在复杂体内环境中的应用，于是集群控制的观点应运而生。由数千个微纳机器人组成的集群不仅能克服上述缺点，而且有较强的任务执行能力和复杂环境适应能力。但是驱动微纳机器人集群运动相比于驱动单个微纳机器人要复杂的多，成为了现阶段亟待解决的任务。发明内容本申请人针对上述问题及技术需求，提出了一种微纳机器人集群的驱动控制系统，本申请的技术方案如下：一种微纳机器人集群的驱动控制系统，该系统包括上位机模组、视觉模组、三轴亥姆霍兹线圈、功率放大器和电源，电源通过功率放大器给三轴亥姆霍兹线圈供电，上位机模组连接并控制视觉模组和功率放大器；三轴亥姆霍兹线圈布设在待驱动的微纳机器人集群的工作空间处，且三轴亥姆霍兹线圈产生覆盖微纳机器人集群的工作空间的磁场，视觉模组的视场范围覆盖微纳机器人集群的工作空间；上位机模组通过视觉模组获取微纳机器人集群的实时图像，并从实时图像中识别得到集群实时位置，基于当前采样时刻t的集群实时位置、磁场方向角α和磁场俯仰角γ通过扩展状态观测器得到系统状态向量的估计值，系统状态向量的估计值包括集群位置估计值、集群速度估计值和扰动估计值；上位机模组根据集群位置目标值和集群位置估计值利用方向控制器确定磁场方向角的更新值α，上位机模组根据集群位置估计值、集群速度估计值、扰动估计值和磁场方向角的更新值α确定磁场俯仰角的更新值γ；上位机模组根据磁场方向角的更新值α和磁场俯仰角的更新值γ控制功率放大器以调节三轴亥姆霍兹线圈中通入的电流，微纳机器人集群的运动状态与三轴亥姆霍兹线圈产生的匀强磁场的场强相关，三轴亥姆霍兹线圈产生的匀强磁场的场强与通入的电流相关。其进一步的技术方案为，当前采样时刻t得到的系统状态向量的估计值为且：其中，为上一个采样时刻得到的系统状态向量的估计值，t＝1时Z为初始值，a0、ε分别为系数，β1、β2、β3、β4、β5、β6为观测器增益，qmx是x轴的集群实时位置，qmy是y轴的集群实时位置；是x轴的集群位置估计值，是y轴的集群位置估计值，是x轴的集群速度估计值，是y轴的集群速度估计值，是x轴的扰动估计值，是y轴的扰动估计值，其进一步的技术方案为，方向控制器为PID控制器，上位机模组将集群位置目标值和集群位置估计值的跟踪误差作为PID控制器的输入，得到磁场方向角的更新值α。其进一步的技术方案为，力控制器为MPC控制器，力控制器基于F-Fd1-Fd2+Δ＝ma的动力学方程设计，其中F为等效磁推力，Fd1是粘性阻力，Fd2是压差阻力，Δ是干扰力，m是微纳机器人集群的质量，a是微纳机器人集群的加速度。其进一步的技术方案为，上位机模组根据调节参数利用磁场电流模型生成放大器控制参数，并按照放大器控制参数控制功率放大器以调节三轴亥姆霍兹线圈中通入的电流，上位机模组存储有多个磁场电流模型，根据同一组调节参数利用不同的磁场电流模型得到的放大器控制参数不同，调节参数包括磁场方向角和磁场俯仰角。其进一步的技术方案为，上位机模组根据调节参数利用第一磁场电流模型生成放大器控制参数控制功率放大器，使得三轴亥姆霍兹线圈生成旋转磁场，微纳机器人集群在旋转磁场的作用下形成旋涡状集群；上位机模组从实时图像中识别得到旋涡状集群的分布尺寸以及微纳机器人集群所在环境的目标通道的尺寸，当旋涡状集群的分布尺寸大于目标通道的尺寸而确定呈旋涡状集群的微纳机器人集群无法通过目标通道时，上位机模组根据调节参数利用第二磁场电流模型生成放大器控制参数控制功率放大器，使得三轴亥姆霍兹线圈生成振荡磁场，微纳机器人集群在振荡磁场的作用下形成条状集群。其进一步的技术方案为，调节参数还包括磁场频率，当上位机模组确定旋涡状集群的分布尺寸大于目标通道的尺寸时，上位机模组改变调节参数中的磁场频率，并利用第一磁场电流模型生成放大器控制参数控制功率放大器、以改变三轴亥姆霍兹线圈生成的旋转磁场的场强，旋涡状集群的形态分布参数与三轴亥姆霍兹线圈生成的旋转磁场的场强相关；当通过调节磁场频率得到的旋涡状集群的最小的分布尺寸大于目标通道的尺寸时，确定呈旋涡状集群的微纳机器人集群无法通过目标通道。其进一步的技术方案为，调节参数还包括磁场频率，上位机模组改变调节参数中的磁场频率，并利用第二磁场电流模型生成放大器控制参数控制功率放大器、以改变三轴亥姆霍兹线圈生成的振荡磁场的场强，条状集群的形态分布参数与三轴亥姆霍兹线圈生成的振荡磁场的场强相关。其进一步的技术方案为，当上位机模组确定微纳机器人集群所在环境的目标通道的尺寸大于旋涡状集群的最小的分布尺寸时，上位机模组根据调节参数重新利用第一磁场电流模型生成放大器控制参数控制功率放大器，使得三轴亥姆霍兹线圈重新生成旋转磁场。其进一步的技术方案为，在微纳机器人集群运动过程中，上位机模组从实时图像中识别得到微纳机器人集群的形态分布参数，当基于形态分布参数确定微纳机器人集群的聚集水平不满足目标聚集水平时，改变磁场频率，形态分布参数包括面积比、形状比、分布中心和分布半径中的至少一种。本申请的有益技术效果是：本申请公开了一种微纳机器人集群的驱动控制系统，该系统将微纳机器人集群的运动速度也作为状态量引入到ESO中，利用新设计的扩展状态观测器ESO可以实现微纳机器人集群更高精度的轨迹跟踪与定位。上位机内置多个磁场电流模型，使用不同的磁场电流模型可以产生不同类型的磁场，可以实现集群形态的类型转换，满足不同场景的应用需要。另外结合调节磁场频率，还可以实现集群形态的参数转换，进一步满足不同场景的应用需要。通过调节磁场频率，可以实现微纳机器人集群的聚集优化控制，提高聚集水平，从而可在轨迹跟踪过程中将集群维持在稳定区间。附图说明图1是一个实施例中的驱动控制系统的结构示意图。图2是一个实施例的控制信息流向图。图3是扩展状态观测器对x轴相关的系统状态向量的控制逻辑图。图4是扩展状态观测器对y轴相关的系统状态向量的控制逻辑图。图5是一个实施例中的驱动控制方法流程图。图6是另一个实施例中的驱动控制方法流程图。具体实施方式下面结合附图对本申请的具体实施方式做进一步说明。本申请公开了一种微纳机器人集群的驱动控制系统，请参考图1所示的系统结构示意图，该系统包括上位机模组1、视觉模组2、三轴亥姆霍兹线圈3、功率放大器4和电源5。三轴亥姆霍兹线圈3布设在待驱动的微纳机器人集群6的工作空间处，且三轴亥姆霍兹线圈3产生覆盖微纳机器人集群6的工作空间的磁场，三轴亥姆霍兹线圈3具体的布设位置根据实际情况调节。电源5通过功率放大器4给三轴亥姆霍兹线圈3供电，上位机模组1连接功率放大器4，并向功率放大器4发送放大器控制参数进而控制功率放大器4输出驱动微纳机器人集群6的动态电流。视觉模组2的视场范围覆盖微纳机器人集群6的工作空间，从而获取微纳机器人集群6在工作空间内运动时的实时图像。上位机模组1连接并控制视觉模组2。在实际应用时，视觉模组2包括显微镜和高速摄像机，显微镜用于监控并放大微纳机器人集群6及其所在空间的区域，高速摄像机用于捕获微纳机器人集群6的实时图像。实际应用时上位机模组1可以包括相连的第一上位机和第二上位机，第一上位机连接视觉模组2，用于获取并处理视觉模组2采集到的实时图像后反馈图像信息给第二上位机，第二上位机根据第一上位机反馈的图像信息控制功率放大器4，本申请对此不做限定，后续统一以上位机模组1来执行所有处理控制功能进行描述。三轴亥姆霍兹线圈3通入电流后沿轴向产生的匀强磁场可以合成为旋转磁场，单轴亥姆霍兹线圈3坐标原点附近匀强磁场的磁场强度与通入的电流呈线性关系，t时刻匀强磁场的磁场强度μ0为真空磁导率，N为单个亥姆霍兹线圈的匝数，I为t时刻亥姆霍兹线圈中通入的电流，r为亥姆霍兹线圈的半径。由此，通过预先仿真计算，可以确定X、Y、Z三轴亥姆霍兹线圈的磁感应强度BHX、BHY、BHZ可以表示为IHX、IHY、IHZ分别是X、Y、Z三轴亥姆霍兹线圈中的电流，λHX、λHY、λHZ为预先仿真计算得到的定值的常数。绕方向n＝T旋转的旋转磁场可以表示为：其中，f是磁场频率，对于旋转磁场来说，该磁场频率f即为磁场旋转频率。T是磁场作用时间，B0为磁感应强度常量。nx、ny、nz可以转换为以方向角α和俯仰角γ表示结合旋转磁场的表达式，以及的关系，可以得到三轴亥姆霍兹线圈3中通入的电流可以表示为：由此可见，影响三轴亥姆霍兹线圈中通入的电流的调节参数主要包括方向角α和俯仰角γ，还包括磁场频率f。通过改变这些调节参数，就能改变三轴亥姆霍兹线圈中通入的电流，从而改变三轴亥姆霍兹线圈产生的磁场。基于上述控制关系，该驱动控制系统可以实现对微纳机器人集群6的精确跟踪，上位机模组1实现的控制过程包括如下步骤，请参考图2所示的信息流框图：步骤210，上位机模组通过视觉模组获取微纳机器人集群的实时图像，并从实时图像中识别得到集群实时位置。当前采样时刻t的集群实时位置包括x轴的集群实时位置qmx和y轴的集群实时位置qmy。步骤220，基于当前采样时刻t的集群实时位置qmx和qmy，结合磁场方向角α和磁场俯仰角γ通过扩展状态观测器得到系统状态向量的估计值。本申请将微纳机器人集群6的运动方程简化为线性函数加上x轴广义干扰Dx和y轴的广义干扰Dy表示为：分别由集群实时位置qmx和qmy求导得到，Dx和Dy包括系统模型不确定性、外部扰动、摩擦、净重力等干扰。x轴和y轴是预先建立的需要坐标系的相互正交的两个轴。本申请针对上述运动方程，创造性的将微纳机器人集群6的集群速度作为新的状态量引入到ESO中，由此本申请中的系统状态向量的估计值包括集群位置估计值、集群速度估计值和扰动估计值。当前采样时刻t的集群位置估计值包括x轴的集群位置估计值和y轴的集群位置估计值集群速度估计值包括x轴的集群速度估计值和y轴的集群速度估计值扰动估计值包括x轴的扰动估计值和y轴的扰动估计值则当前采样时刻t的系统状态向量的估计值可以表示为请参考图3和图4，图3是扩展状态观测器对x轴的相关状态向量进行观测的结构图，图4是扩展状态观测器对y轴的相关状态向量进行观测的结构图，本申请中的扩展状态观测器可以表示为：其中，为上一个采样时刻得到的系统状态向量的估计值。t＝1时Z为初始值，a0、ε分别为系数，β1、β2、β3、β4、β5、β6为观测器增益。其中，ε越小，则系统状态向量的估计值的收敛速度越快，估计误差越小，但对外部噪声的过滤性能将会减弱。步骤230，上位机模组根据集群位置目标值和集群位置估计值和利用方向控制器确定磁场方向角的更新值α。上位机模组1利用粒子群优化算法PSO可以得到微纳机器人集群6在全局地图中的最优避障路径，该最优避障路径上在当前采样时刻t的位置即为集群位置目标值。在一个实施例中，方向控制器为PID控制器，上位机模组1将集群位置目标值和集群位置估计值的跟踪误差作为PID控制器的输入，得到磁场方向角的更新值α。同样的，集群位置目标值也包括x轴的集群位置目标值qX和y轴的集群位置目标值qY，将qX与之间的跟踪误差以及qY与之间的跟踪误差作为PID控制器的输入。在减小计算量的同时可以时刻对微纳机器人集群6的运动方向进行修改，跟踪最优避障路径并减小点到点间的轨迹跟踪误差。步骤240，上位机模组1根据集群位置估计值和集群速度估计值和扰动估计值和以及磁场方向角的更新值α确定磁场俯仰角的更新值γ。考虑到微纳机器人集群6并不总是在静态空间内运动，在很多领域，微纳机器人集群6处于流动液体中，比如微纳机器人集群6在血管中运动时，此时微纳机器人集群6会受到流动液体的作用。因此在一个实施例中，考虑微纳机器人集群6来自于流动液体的阻力，力控制器基于F-Fd1-Fd2+Δ＝ma的动力学方程设计。旋涡状集群形成后，若旋转磁场有磁场俯仰角而导致的旋涡状集群的旋转平面有一定的倾斜，旋涡状集群旋转会带动周围流体运动，靠近基底处的流体与基底的相互作用会造成微纳机器人集群的整体移动，这种互相作用就是等效磁推力F，等效磁推力F与磁场频率f、磁场方向角以及磁场俯仰角相关，因此在磁场频率f已知，磁场方向角的更新值α也求得基础上，等效磁推力F受磁场俯仰角影响。粘性阻力Fd1和压差阻力Fd2是微纳机器人集群运动时受到的主要阻力，粘性阻力Fd1与集群液体速度差的一次方相关，压差阻力Fd2与集群液体速度差的平方相关，其中，集群液体速度差是集群速度估计值与液体速度估计值的矢量差，若微纳机器人集群6所在的流动液体使用匀速流动，则液体速度估计值即为流动液体匀速流动时的速度，但是更常见的，在血管等环境中，由于血管各部分尺寸不同，因此流动液体在各个位置处的速度不同，且位置与液体速度的关系可以预先拟合，则通过集群位置估计值和即能确定微纳机器人集群6当前所在位置的液体速度估计值。Δ是干扰力且由扰动估计值和得到。m是微纳机器人集群的质量，a是微纳机器人集群的加速度，通过集群位置估计值和求二阶导数得到。该动力学方程与系统状态向量的估计值以及磁场方向角的更新值α一起用于力控制器的设计，为了优化控制，力控制器、采用MPC控制器。MPC控制器能利用已有模型、估计的系统当前状态、参考轨迹来预测未来输出，并可通过减小代价函数的方法优化未来的控制输出，系统模型为：因此利用MPC控制器还可以对扰动估计值于跟踪误差有补偿作用。步骤250，上位机模组根据磁场方向角的更新值α和磁场俯仰角的更新值γ控制功率放大器以调节三轴亥姆霍兹线圈中通入的电流，微纳机器人集群的运动状态与三轴亥姆霍兹线圈产生的匀强磁场的场强相关，三轴亥姆霍兹线圈产生的匀强磁场的场强与通入的电流相关。如上所述，三轴亥姆霍兹线圈中通入的电流与方向角α和俯仰角γ存在相关关系，因此当磁场方向角和/或磁场俯仰角发生变化时，三轴亥姆霍兹线圈中通入的电流也相应变化，从而改变场强，实现微纳机器人集群6对最优避障路径的准确跟踪。微纳机器人集群6在实际工作时，比如如图1所示，微纳机器人集群6在血管7中运动时，时常会遇到狭窄段或遭遇血管分叉等，因此一定程度的形态变换也必不可少。所以在一个实施例中，三轴亥姆霍兹线圈可以生成多种类型的动态磁场，在生成不同类型的动态磁场时，对BHX、BHY、BHZ的矢量合成方式不同，上位机模组存储有多个磁场电流模型，每个磁场电流模型对应一种类型的动态磁场，且磁场电流模型指示生成该类型的动态磁场所需通入的电流，多种类型的动态磁场预先配置好存储在上位机模组中。在按照上述方法确定调节参数后，上位机模组根据调节参数利用其中一个磁场电流模型生成放大器控制参数Ctrl，并按照得到的放大器控制参数Ctrl控制功率放大器以调节三轴亥姆霍兹线圈中通入的电流。对于同一组调节参数，当利用不同的磁场电流模型时得到的放大器控制参数不同。在一个实施例中，三轴亥姆霍兹线圈可以生成两种类型的动态磁场，包括旋转磁场和振荡磁场。则请参考图5所示的流程图，上位机模组1根据调节参数利用旋转磁场对应的第一磁场电流模型生成放大器控制参数控制功率放大器，使得三轴亥姆霍兹线圈生成旋转磁场，微纳机器人集群6在旋转磁场的作用下形成旋涡状集群。上位机模组1从实时图像中识别得到旋涡状集群的分布尺寸以及微纳机器人集群6所在环境的目标通道的尺寸，当微纳机器人集群6在血管中运动时，目标通道的尺寸即为血管的尺寸。旋涡状集群的分布尺寸的分布半径指的是微纳机器人集群6经过粒子浓度及最优拟合后得到的椭圆的长轴和短轴或者拟合得到的圆的半径。目标通道的尺寸是目标通道的壁面之间的最小距离。旋涡状集群的分布尺寸以及目标通道的尺寸都可以通过现有的图像处理技术处理得到的，本申请不再赘述。当上位机模组1确认旋涡状集群的分布尺寸大于目标通道的尺寸而确定呈旋涡状集群的微纳机器人集群无法通过目标通道时，上位机模组1根据调节参数利用振荡磁场对应的第二磁场电流模型生成放大器控制参数控制功率放大器，使得三轴亥姆霍兹线圈生成振荡磁场，微纳机器人集群在振荡磁场的作用下形成条状集群，从而可以实现微纳机器人集群的形态变换，条状集群在剖面上呈长条状，其沿着目标通道长度方向的长度大于沿着目标通道的两壁面之间的宽度，条状集群相对于旋涡状集群来说分布尺寸更为狭长，更利于通过狭窄的目标通道。三轴亥姆霍兹线圈通入的电流会影响三轴亥姆霍兹线圈产生的磁场，而三轴亥姆霍兹线圈产生的磁场会影响微纳机器人集群6的形态分布类型和形态分布参数。形态分布类型是旋涡状集群或条状集群。形态分布参数包括面积比、形状比、分布中心和分布半径中的至少一种。其中，面积比是聚集体的面积与微纳机器人集群6的粒子群总面积之比，聚集体是微纳机器人集群6中除去孤立粒子之外的粒子群，孤立粒子是微纳机器人集群6中与其他粒子没有物理接触的粒子，每个粒子是一个微纳机器人。形状比主要针对条状集群，是指条状集群的长边和短边的长度之比。分布中心是微纳机器人集群6经过粒子浓度及最优拟合后得到的椭圆的形心或者拟合得到的圆的圆心。分布半径是微纳机器人集群6经过粒子浓度及最优拟合后得到的椭圆的长轴和短轴或者拟合得到的圆的半径。如上所述，上位机模组1通过改变使用的磁场电流模型可以调节形态分布类型，而在同一种形态分布类型下，上位机模组1也可以调节微纳机器人集群6的形态分布参数。三轴亥姆霍兹线圈通入电流不仅受到磁场方位角和磁场俯仰角的影响，还会受到磁场频率f的影响，因此实际上调节参数除了包含集群方位角和磁场俯仰角之外，还包括磁场频率f。因此通过磁场频率f就可以调整微纳机器人集群6的形态分布参数。在磁场方向角和磁场俯仰角已知的情况下，磁场频率f对形态分布参数的影响可以预先拟合确定。则在图5所示的实施例中，如图6的流程图所示，当上位机模组1确定实时的旋涡状集群的分布尺寸大于目标通道的尺寸时，并不直接切换磁场电流模型，而是先改变调节参数中的磁场频率f，并利用第一磁场电流模型生成放大器控制参数控制功率放大器、以改变三轴亥姆霍兹线圈生成的旋转磁场的场强，也即通过改变调节参数中的磁场频率f减小旋涡状集群的分布尺寸。当通过调节磁场频率f得到的旋涡状集群的最小的分布尺寸仍然大于目标通道的尺寸时，最终确定呈旋涡状集群的微纳机器人集群无法通过目标通道。继而改为使用第二磁场电流模型以生成振荡磁场。同样的，在切换至使用第二磁场电流模型生成振荡磁场后，上位机模组1也可以改变调节参数中的磁场频率f，对于振荡磁场来说，该磁场频率f即为磁场振荡频率，并利用第二磁场电流模型生成放大器控制参数控制功率放大器、以改变三轴亥姆霍兹线圈生成的振荡磁场的场强，从而调节条状集群的形态分布参数。另外，在切换至使用第二磁场电流模型生成振荡磁场，使得微纳机器人集群形成条状集群并通过目标通道后。当上位机模组1确定微纳机器人集群6所在环境的目标通道的尺寸又重新大于旋涡状集群的最小的分布尺寸时，上位机模组1根据调节参数重新利用第一磁场电流模型生成放大器控制参数控制功率放大器，使得三轴亥姆霍兹线圈重新生成旋转磁场，使得微纳机器人集群6恢复为旋涡状集群。也即由于旋涡状集群的稳定性和可操作性都较高，因此该系统在应用过程中，尽可能控制微纳机器人集群生成旋涡状集群，为了通过狭窄通道生成条状集群后，也应在尺寸允许范围内恢复旋涡状集群。考虑到微纳机器人集群在工作过程中，集群形态的稳定性也会受到环境的影响，比如微纳机器人集群在血管中运动时存在与血细胞碰撞的可能，会导致集群形态发生变化而不够稳定。但是实际又要求微纳机器人集群需要保持稳定的集群形态，因此在微纳机器人集群6整个运动过程中，上位机模组1还从实时图像中识别得到微纳机器人集群6的形态分布参数。上述各项形态分布参数都可以采用现有的图像处理技术得到，本申请对此不做赘述。当上位机模组1基于形态分布参数确定微纳机器人集群6的聚集水平不满足目标聚集水平时，改变调节参数中的磁场频率f，以动态调节微纳机器人集群6的形态分布参数，使得聚集水平在运动过程中动态满足目标聚集水平，有较好的稳定性。一般是使用面积比来衡量微纳机器人集群6的聚集水平，当面积比大于面积比阈值时确定满足目标聚集水平，否则不满足。对于条状集群来说，除了面积比还会考虑形状比，可以自定义设置。以上所述的仅是本申请的优选实施方式，本申请不限于以上实施例。可以理解，本领域技术人员在不脱离本申请的精神和构思的前提下直接导出或联想到的其他改进和变化，均应认为包含在本申请的保护范围之内。
