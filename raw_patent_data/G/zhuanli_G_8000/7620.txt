标题title
一种基于知识图谱的推荐流行度偏差自适应缓解方法
摘要abst
本发明提出了一种基于知识图谱的推荐流行度偏差自适应缓解方法，包括：根据物品的流行度对物品进行分组；创建与物品组数量相同的流行度节点；将流行度节点嵌入到关系为的知识图谱中，得到关系包括的流行度知识图谱，其中，i表示物品，pn表示用户对物品的偏好；创建用户偏好图；基于所述流行度知识图谱、所述用户偏好图构建异构图；基于图神经网络模型预测异构图中用户对物品的评分；通过用户对物品的评分以及流行度评分，得到最终评分并通过最终评分向用户推荐物品。本发明在处理推荐系统中的流行度偏差问题时，首次引入了知识图谱，这不仅有利于推荐，还能在有效缓解流行度问题的同时，利用用户对流行的偏好兼顾用户的使用体验。
权利要求书clms
1.一种基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，包括：根据物品的流行度对物品进行分组，得到多个物品组；其中，所述流行度表示物品的受欢迎程度；创建与物品组数量相同的流行度节点，并将所述物品组与所述流行度节点进行关联，其中，每一个物品组对应一个流行度节点；将所述流行度节点嵌入到关系为的知识图谱中，得到关系包括的流行度知识图谱，其中，i表示物品，pn表示用户对物品的偏好；分别以用户、物品作为实体节点，以用户对物品的偏好为边创建用户偏好图；基于所述流行度知识图谱、所述用户偏好图构建异构图；基于图神经网络模型预测异构图中用户对物品的评分；通过用户对物品的评分以及流行度评分，得到最终评分并通过最终评分向用户推荐物品。2.根据权利要求1所述的基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，聚合图神经网络模型中来自目标节点i的邻居节点的信息，包括：消息计算和消息聚合；所述消息计算包括：计算出源节点u经过边e的信息Message：所述消息聚合包括：计算源节点u和目标节点i之间的异构互注意力Attention：利用注意力向量作为权重平均来自源节点的对应消息，并对输出进行更新。3.根据权利要求2所述的基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，通过下式计算出源节点u经过边e的信息Message：其中，Mτ是节点类型τ的线性投影，表示消息矩阵，H表示异构图神经网络模型的第l-1层的输出。4.根据权利要求3所述的基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，通过下式计算源节点u和目标节点i之间的异构互注意力Attention：利用注意力向量作为权重平均来自源节点u的对应消息，并对输出进行更新；其中，N表示源节点u的一跳邻居节点，Qτ、Kτ为线性投影，φ为边的类型，为基于边的注意力矩阵。5.根据权利要求4所述的基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，还包括：采用欧几里德范数对所述流行度知识图谱中的关系嵌入与偏好图中的偏好嵌入进行对齐。6.根据权利要求5所述的基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，所述图神经网络模型的损失函数为：其中，LHGT表示图神经网络模型的损失函数，LBPR表示成对BPR损失，Lalign表示对齐损失，Θ表示模型参数集，α和λ分别用于约束对齐损失和欧几里德范数L2。7.根据权利要求6所述的基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，通过用户对物品的评分以及流行度评分，得到最终评分包括：通过以下函数计算得到最终评分：其中，为最终评分，表示用户对物品的评分，表示流行度评分，popularity表示流行度，w表示权重，w＝1-RP，RP为用户u的交互数据中受欢迎物品的比例。8.根据权利要求7所述的基于知识图谱的推荐流行度偏差自适应缓解方法，其特征在于，所述用户对物品的评分为：
说明书desc
技术领域本发明属于人工智能技术领域，具体涉及一种基于知识图谱的推荐流行度偏差自适应缓解方法。背景技术在互联网时代，用户可以在各种电子平台上享受各种服务。然而，随着用户数量的不断增加，信息过载的问题变得更加严重，这使得用户无法有效地搜索他们想要的内容。推荐系统则是人们解决信息过载的有力工具，它根据用户的信息需求、兴趣爱好等，帮助用户进行信息过滤，将用户感兴趣的信息、产品等推荐给用户。随着推荐技术的快速发展，个性化推荐系统正在不断完善，并成功应用于各个领域，与我们的生活已经息息相关，比如电子商务、影音视频、新闻资讯等等领域都存在着推荐系统的身影。其中，协同过滤作为推荐系统中最成功的方法之一，可以预测某用户对某物品的评分，并利用某用户群体的偏好生成推荐。所以准确地捕捉用户的兴趣是一个有效的推荐系统的核心，其面临的一大挑战就是流行度偏差问题：协同过滤通常偏向向用户推荐更受欢迎的物品。流行度偏差会导致著名的LastFM中的长尾效应：受欢迎程度在前20％的物品的累积评级比剩下80％的长尾物品要高得多。在对具有长尾效应的数据进行训练后，模型会继承这种偏差，并通过推荐流行的物品扩大了流行度偏差，进一步导致流行的物品越来越流行，而小众的物品不被推荐。虽然流行物品通常会被很好的推荐，但是由于流行物品是众所周知的，所以这样的推荐没有意义。对用户来说，从不流行物品中找出合适的进行推荐是最有价值的。推荐系统应该在流行和非流行物品之间寻求平衡。之前的研究主要聚焦于增加推荐的不受欢迎物品的数量。比如Jones提出了一种重新加权的方法来提高对小众物品的发掘性能。Chen Zhihong等人提出通过引入正则化术语来纠正流行度偏差的方法。除此之外，还有一些方法利用评分来降低流行物品的比例。现有的这些方法都增加了非流行物品的曝光率。但是它们很大程度上忽略了用户对流行物品的兴趣，会降低用户体验。发明内容鉴于以上所述现有技术的缺点，本发明提供一种基于知识图谱的推荐流行度偏差自适应缓解方法，以解决现有技术中的至少一个缺陷。为实现上述目的及其他相关目的，本发明提供一种基于知识图谱的推荐流行度偏差自适应缓解方法，包括：根据物品的流行度对物品进行分组，得到多个物品组；其中，所述流行度表示物品的受欢迎程度；创建与物品组数量相同的流行度节点，并将所述物品组与所述流行度节点进行关联，其中，每一个物品组对应一个流行度节点；将所述流行度节点嵌入到关系为的知识图谱中，得到关系包括的流行度知识图谱，其中，i表示物品，pn表示用户对物品的偏好；分别以用户、物品作为实体节点，以用户对物品的偏好为边创建用户偏好图；基于所述流行度知识图谱、所述用户偏好图构建异构图；基于图神经网络模型预测异构图中用户对物品的评分；通过用户对物品的评分以及流行度评分，得到最终评分并通过最终评分向用户推荐物品。可选地，聚合图神经网络模型中来自目标节点i的邻居节点的信息，包括：消息计算和消息聚合；所述消息计算包括：计算出源节点u经过边e的信息Message：所述消息聚合包括：计算源节点u和目标节点i之间的异构互注意力Attention：利用注意力向量作为权重平均来自源节点的对应消息，并对输出进行更新。可选地，通过下式计算出源节点u经过边e的信息Message：其中，Mτ是节点类型τ的线性投影，表示消息矩阵，H表示异构图神经网络模型的第l-1层的输出。可选地，通过下式计算源节点u和目标节点i之间的异构互注意力Attention：利用注意力向量作为权重平均来自源节点u的对应消息，并对输出进行更新；其中，N表示源节点u的一跳邻居节点，Qτ、Kτ为线性投影，φ为边的类型，为基于边的注意力矩阵。可选地，还包括：采用欧几里德范数对所述流行度知识图谱中的关系嵌入与偏好图中的偏好嵌入进行对齐。可选地，所述图神经网络模型的损失函数为：其中，LHGT表示图神经网络模型的损失函数，LBPR表示成对BPR损失，Lalign表示对齐损失，Θ表示模型参数集，α和λ分别用于约束对齐损失和欧几里德范数L2。可选地，通过用户对物品的评分以及流行度评分，得到最终评分包括：通过以下函数计算得到最终评分：其中，为最终评分，表示用户对物品的评分，表示流行度评分，popularity表示流行度，w表示权重，w＝1-RP，RP为用户u的交互数据中受欢迎物品的比例。可选地，所述用户对物品的评分为：如上所述，本发明的一种基于知识图谱的推荐流行度偏差自适应缓解方法，具有以下有益效果：本发明的一种基于知识图谱的推荐流行度偏差自适应缓解方法，包括：根据物品的流行度对物品进行分组，得到多个物品组；其中，所述流行度表示物品的受欢迎程度；创建与物品组数量相同的流行度节点，并将所述物品组与所述流行度节点进行关联，其中，每一个物品组对应一个流行度节点；将所述流行度节点嵌入到关系为的知识图谱中，得到关系包括的流行度知识图谱，其中，i表示物品，pn表示用户对物品的偏好；分别以用户、物品作为实体节点，以用户对物品的偏好为边创建用户偏好图；基于所述流行度知识图谱、所述用户偏好图构建异构图；基于图神经网络模型预测异构图中用户对物品的评分；通过用户对物品的评分以及流行度评分，得到最终评分并通过最终评分向用户推荐物品。本发明在处理推荐系统中的流行度偏差问题时，首次引入了知识图谱，这不仅有利于推荐，还能在有效缓解流行度问题的同时，利用用户对流行的偏好兼顾用户的使用体验。附图说明图1为本发明一实施例中一种基于知识图谱的推荐流行度偏差自适应缓解方法的原理框图；图2为本发明一实施例中一种基于知识图谱的推荐流行度偏差自适应缓解方法的流程图。具体实施方式以下通过特定的具体实例说明本发明的实施方式，本领域技术人员可由本说明书所揭露的内容轻易地了解本发明的其他优点与功效。本发明还可以通过另外不同的具体实施方式加以实施或应用，本说明书中的各项细节也可以基于不同观点与应用，在没有背离本发明的精神下进行各种修饰或改变。需说明的是，在不冲突的情况下，以下实施例及实施例中的特征可以相互组合。需要说明的是，以下实施例中所提供的图示仅以示意方式说明本发明的基本构想，遂图式中仅显示与本发明中有关的组件而非按照实际实施时的组件数目、形状及尺寸绘制，其实际实施时各组件的型态、数量及比例可为一种随意的改变，且其组件布局型态也可能更为复杂。在如何解决知识图谱缺乏流行度偏差知识和不同用户对流行物品有不同的偏好这两个问题时，本发明提出一种基于知识图谱的推荐流行度偏差自适应缓解方法，利用知识图谱针对用户对流行物品的偏好程度进行推荐，从而从用户的角度减少推荐系统中的流行度偏差问题，且能照顾到用户使用体验。本发明解决了推荐系统中流行度偏差的主要问题：即每个用户对流行物品的偏好程度是不一样的，不能不加分辨的减少流行物品或增加非流行物品的推荐。在解决推荐系统中流行度偏差的问题中，本发明提出的基于知识图谱的推荐流行度偏差自适应缓解方法，如图1所示，大概包括以下步骤：1)嵌入了流行节点的知识图谱的建立；其中，流行节点的作用是增强知识图谱中实体关系；2)构建用户偏好图，用于使用多偏好来刻画用户-物品之间的关系；需要说明的是，在用户偏好建模过程中，将每个偏好与嵌入流行度节点的知识图谱中的关系对齐；3)建立用于学习用户、物品和细粒度偏好表示的异构图转换模型；4)预测模型的建立；预测模型依据用户对流行物品的偏好，个性化生成每个用户去除流行度偏差后的推荐列表。如图2所示，一种基于知识图谱的推荐流行度偏差自适应缓解方法，包括：S100根据物品的流行度对物品进行分组，得到多个物品组；其中，所述流行度表示物品的受欢迎程度；S200创建与物品组数量相同的流行度节点，并将所述物品组与所述流行度节点进行关联，其中，每一个物品组对应一个流行度节点；S300将所述流行度节点嵌入到关系为的知识图谱中，得到关系包括的流行度知识图谱，其中，i表示物品，pn表示用户对物品的偏好；S400分别以用户、物品作为实体节点，以用户对物品的偏好为边创建用户偏好图；S500基于所述流行度知识图谱、所述用户偏好图构建异构图；S600基于图神经网络模型预测异构图中用户对物品的评分；S700通过用户对物品的评分以及流行度评分，得到最终评分并通过最终评分向用户推荐物品。在步骤S100～步骤S300中，首先根据物品的受欢迎程度将物品分为K组。再创建K个称为pi,i∈{1,...,K}的流行度节点来代表这些组并将物品，并连接到它们相对应的节点。在创建流行度节点之前，知识图谱中的关系为。创建流行节点之后，就向知识图谱引入了一个新的关系，从而将流行度信息整合到知识图谱中，如图1中所示。将这个整合了流行度信息的知识图谱表示为流行度知识图谱KGEPN。在步骤S400中，分别以用户、物品作为实体节点，以用户对物品的偏好为边创建用户偏好图。用户偏好图的目的是捕捉影响用户行为的多偏好直觉知识，其反映了用户所有行为的共性，以音乐推荐为例，可能的偏好是对音乐属性的不同考虑，如艺术家、流派或受欢迎程度；因此可以将偏好作为用户选择物品的原因。本实施例以偏好的粒度对用户u-物品i关系进行建模，假设P是所有用户共享的偏好集，将统一的用户u-物品i关系切分到|p|偏好中，并将每个三元组分解为{|p∈P}形式，如图1中所示，称为偏好图。在一实施例中，采用欧几里德范数对所述流行度知识图谱中的关系嵌入与偏好图中的偏好嵌入进行对齐。由于偏好表达为隐向量，对于更深入的理解是模糊的，将用户偏好图中的偏好的数量设置为流行度知识图谱KGEPN中的关系数量，并将KGEPN中的关系信息转换为偏好。具体来说，利用欧几里德范数来对齐KGEPN中的偏好嵌入和关系嵌入。在步骤S500～步骤S600中，基于所述流行度知识图谱、所述用户偏好图构建异构图；在本实施例中，将KGEPN和PG组合成一个新的异构图。在异构图的基础上，在HG的基础上开发了异构图转换器。HGT旨在聚合图神经网络模型中来自目标节点t的邻居节点的信息，这个过程包括：消息计算和消息聚合；所述消息计算包括：计算出源节点u经过边e的信息Message：所述消息聚合包括：计算源节点u和目标节点i之间的异构互注意力Attention：利用注意力向量作为权重平均来自源节点的对应消息，并对输出进行更新。具体地，将第-th HGT层的输出表示为H，将HGT的深度表示L。消息计算部分结合了消息矩阵以缓解不同类型节点和边的分布差异。给定一个源节点u和一个边e，HGT可以通过下列等式计算出节点u经过边e的信息：其中，Mτ是节点类型τ的独特线性投影。而在消息聚合部分，先利用HGT首先计算源节点u和目标节点i之间的异构互注意力，以控制源节点u对目标节点i的影响。HGT对每种类型的节点使用特定的线性投影Qτ或Kτ,并对每种边缘类型φ使用不同的基于边的矩阵来对分布进行差异最大化建模。用N表示源节点u的一跳邻居节点，进而算出异构图的异构互注意力Attention：HGT再用注意力向量作为权重来平均来自源节点的对应消息，并对输出进行更新：在本实施例中选择成对BPR损失来训练HGT，通过结合对齐损失和BPR损失，通过最小化学习模型参数，其中Θ代表模型参数集，再利用α和λ分别约束对齐损失和L2范数。在步骤S700中，通过用户对物品的评分以及流行度评分，得到最终评分并通过最终评分向用户推荐物品。具体地，利用每种边类型对应的基于边的独立矩阵，可以更精细地量化用户的偏好。如图1中所示，给定用户u和物品i的最终表示，对于用户u的偏好，计算u和i之间的相应分数，来判断u接受i的可能性。在这个计算中，通过一个权重w来控制流行度对推荐结果的影响，根据用户u的个人资料中流行物品的比例，针对性的对用户u移除一定比例的流行物品推荐。具体来说，通过以下函数来抑制流行物品的推荐其中，w＝1-RPRP为用户u的交互数据中热门物品的比例，如果用户对热门物品非常感兴趣，将很少删除该用户的热门项偏好，从而保证用户的体验，反之亦然。从而达到本发明根据用户对流行物品的偏好度不同，而针对性的减少流行度偏差问题且兼顾用户使用体验的目的。本发明的基于知识图谱的推荐流行度偏差自适应缓解方法与推荐算法BPRMF，LightGCN，KTUP，IPS-CN以及ESAM做对比，在实验中使用公开数据集LastFM和DBbook-2014。为了确保数据集的质量，使用5核设置，即保留至少5个交互的用户和物品，并为每个数据集构造物品知识。随机选择与每个用户相关的80％的物品来组成训练集，并使用所有剩余的20％作为测试集，并采用交叉验证方法。以下为数据集的属性和各个方法的实验结果。其中AWING-APS是AWING的变体，它在推荐时移除了一定比例的流行物品推荐。由实验结果可知，首先，BPRMF模型在两个数据集上表现最差，虽然LightGCN的表现比BPRMF好，但其长尾物品平均占比值也很低，说明在推荐系统中普遍存在流行偏差。其次，KTUP的性能在所有指标上都优于LightGCN和BPRMF模型，这表明引入知识图谱不仅有利于推荐，还有助于缓解流行度偏差。此外，与上述三种模型相比，IPS-CN和ESAM在APT上有很大的提高，但并没有保持流行与非流行物品的比例，这可能会影响用户体验。本方法AWING在召回率和归一化折损累计增益方面优于两个数据集上的所有比较方法，这表明识别细粒度偏好有助于推荐。此外，本方法AWING-APS在用户流行度偏好一致性、总体多样性和尾部项目的平均百分比中表现最好，验证了移除一定比例的流行物品推荐对缓解流行度偏差的意义，保持了流行和非流行物品的相似比例，保证了良好的用户体验。因此，本方法在合理缓解流行度偏差问题上具有一定的优势。本发明还提供一种存储介质，存储计算机程序，所述计算机程序被处理器运行时执行前述的视频数据处理方法。本发明还提供一种设备，包括：存储器，用于存储计算机程序；处理器，用于执行所述存储器存储的计算机程序，以使所述设备执行前述的视频数据处理方法。所述处理器可以是中央处理单元，还可以是其他通用处理器、数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。所述存储器可以是内部存储单元或外部存储设备，例如插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，所述存储器还可以既包括内部存储单元，也包括外部存储设备。所述存储器用于存储所述计算机程序以及其他程序和数据。所述存储器还可以用于暂时地存储已经输出或者将要输出的数据。所属领域的技术人员可以清楚地了解到，为了描述的方便和简洁，仅以上述各功能单元、模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能单元、模块完成，即将所述装置的内部结构划分成不同的功能单元或模块，以完成以上描述的全部或者部分功能。实施例中的各功能单元、模块可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中，上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。另外，各功能单元、模块的具体名称也只是为了便于相互区分，并不用于限制本申请的保护范围。上述系统中单元、模块的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述或记载的部分，可以参见其它实施例的相关描述。本领域普通技术人员可以意识到，结合本文中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、或者计算机软件和电子硬件的结合来实现。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本发明的范围。在本发明所提供的实施例中，应该理解到，所揭露的装置/终端设备和方法，可以通过其它的方式实现。例如，以上所描述的装置/终端设备实施例仅仅是示意性的，例如，所述模块或单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通讯连接可以是通过一些接口，装置或单元的间接耦合或通讯连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。所述集成的模块/单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明实现上述实施例方法中的全部或部分流程，也可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一计算机可读存储介质中，该计算机程序在被处理器执行时，可实现上述各个方法实施例的步骤。其中，所述计算机程序包括计算机程序代码，所述计算机程序代码可以为源代码形式、对象代码形式、可执行文件或某些中间形式等。所述计算机可读介质可以包括:能够携带所述计算机程序代码的任何实体或装置、记录介质、U盘、移动硬盘、磁碟、光盘、计算机存储器、只读存储器、随机存取存储器、电载波信号、电信信号以及软件分发介质等。上述实施例仅例示性说明本发明的原理及其功效，而非用于限制本发明。任何熟悉此技术的人士皆可在不违背本发明的精神及范畴下，对上述实施例进行修饰或改变。因此，举凡所属技术领域中具有通常知识者在未脱离本发明所揭示的精神与技术思想下所完成的一切等效修饰或改变，仍应由本发明的权利要求所涵盖。
