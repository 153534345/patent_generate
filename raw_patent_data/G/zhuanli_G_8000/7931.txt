标题title
一种激光焊接产品生产异常检测方法
摘要abst
本发明公开了一种激光焊接产品生产异常检测方法，属于图像处理技术领域；包括以下步骤：获取激光焊缝灰度图；获取每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值；获取准焊缝区域；获取灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点；获取待检测图像；通过对待检测图像边缘检测获取焊缝的纹理及边缘，并标记每道焊纹的两端端点，利用霍夫直线检测对焊缝两侧的端点进行检测对焊缝的异常进行判断。本发明在激光焊接产品的异常检测过程中首先对采集的图像进行自适应增强处理，大幅提高图像质量，为提高激光焊接异常实时检测系统的精度提供帮助。
权利要求书clms
1.一种激光焊接产品生产异常检测方法，其特征在于，包括以下步骤：获取激光焊缝灰度图；根据灰度图中每个像素点与其邻域像素点的灰度梯度，获取每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值；根据每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值获取所有疑似焊缝像素点；将所有疑似焊缝像素点经K-means聚类算法获取多个聚簇；根据每个聚簇中像素点的数量及聚簇密度获取准焊缝区域；获取准焊缝区域像素点的灰度区间；根据灰度区间内每个灰度级中像素点的数量，及准焊缝区域内像素点的总数，获取灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点；根据灰度中值点及灰度区间的下限值和上限值，获取调节准焊缝区域增加或降低的灰度级级数；根据调节准焊缝区域增加或降低的灰度级级数对准焊缝区域进行自适应增强，同时对准焊缝区域以外的其他区域进行平滑处理，获取待检测图像；通过对待检测图像边缘检测获取焊缝的纹理及边缘，并标记每道焊纹的两端端点，利用霍夫直线检测对焊缝两侧的端点进行检测对焊缝的异常进行判断。2.根据权利要求1所述的一种激光焊接产品生产异常检测方法，其特征在于，所述灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点，是将灰度区间内的像素点按灰度级由小到大的顺序对每个灰度级中像素点数量的累加和，等于准焊缝区域内像素点总数的一半时而获取的。3.根据权利要求2所述的一种激光焊接产品生产异常检测方法，其特征在于，所述调节准焊缝区域增加的灰度级级数是按照以下步骤获取：当灰度区间的下限值小于第一预设阈值时，其所述调节准焊缝区域增加的灰度级级数计算公式如下：式中，表示调节准焊缝区域增加的灰度级级数；，分别表示灰度区间的下限值和上限值；表示灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点。4.根据权利要求3所述的一种激光焊接产品生产异常检测方法，其特征在于，所述对准焊缝区域进行自适应增强按照以下步骤进行：当灰度区间的下限值小于第一预设阈值时，对准焊缝区域进行自适应增强的函数如下：式中，表示输入准焊缝区域图像；表示输出准焊缝区域自适应增强图像；，分别表示灰度区间的下限值和上限值；表示调节准焊缝区域增加的灰度级级数。5.根据权利要求2所述的一种激光焊接产品生产异常检测方法，其特征在于，所述调节准焊缝区域降低的灰度级级数是按照以下步骤获取：当灰度区间的上限值大于第二预设阈值时，其所述调节准焊缝区域降低的灰度级级数计算公式如下：式中，表示调节准焊缝区域降低的灰度级级数；，分别表示灰度区间的下限值和上限值；表示灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点。6.根据权利要求5所述的一种激光焊接产品生产异常检测方法，其特征在于，所述对准焊缝区域进行自适应增强按照以下步骤进行：当灰度区间的上限值大于第二预设阈值时，对准焊缝区域进行自适应增强的函数如下：式中，表示输入准焊缝区域图像；表示输出准焊缝区域自适应增强图像；，分别表示灰度区间的下限值和上限值；表示调节准焊缝区域降低的灰度级级数。7.根据权利要求1所述的一种激光焊接产品生产异常检测方法，其特征在于，所述所有疑似焊缝像素点是按照以下步骤获取：将每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值，记为；根据每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值将所述灰度图中的像素点划分为第一类像素点和第二类像素点；当时，将该像素点记为第一类像素点；当时，将该像素点记为第二类像素点；将第一类像素点记为疑似焊缝像素点。8.根据权利要求1所述的一种激光焊接产品生产异常检测方法，其特征在于，所述对焊缝的异常是按照以下步骤进行判断：利用霍夫直线检测对焊缝两侧的端点进行检测分别获取焊缝区域两侧的边缘平直度：当焊缝区域两侧边缘平直度均大于预设平直阈值时，则判断焊缝正常；当焊缝区域任一侧边缘平直度小于预设平直阈值时，则判断焊缝异常。
说明书desc
技术领域本发明涉及图像处理技术领域，具体涉及一种激光焊接产品生产异常检测方法。背景技术激光焊接技术与传统焊接技术相比，具有能量密度集中、残余应力和形变小、非接触式焊接、焊接效率高、焊接表面成形好等优点，广泛应用于电子零件、汽车制造、航空航天等装备制造业领域，当前新型电动车轻量化和电池的大量使用，也让激光焊接技术逐步涉及越来越多的铝合金焊接工艺中。由于受到焊接工艺、环境等因素的影响，会使焊缝部位产生形变、不均匀、焊偏等缺陷。而焊接过程中异常自动检测系统的拍摄环境比较复杂，环境光不够稳定，且CCD相机实时采集过程中图像传感器也容易过热，而采集图像上的焊缝纹理不够清晰，借助异常自动检测系统对不够清晰的焊缝图像进行处理时，由于图像质量问题会对焊缝异常的实时检测结果造成较大影响。而现有技术中对焊缝图像的处理，仅仅是对焊缝图像整体的亮度进行自适应调整，并未对焊缝区域图像进行自适应调整，这样对于焊接异常自动检测系统也很难对图像中的焊缝区域进行识别，难以对焊缝的异常情况做出精准的判断，为此，为了能够获取清晰的焊缝纹理图像，并对焊缝的异常做出精准的评估，本发明提供了一种激光焊接产品生产异常检测方法。发明内容为了解决现有技术中的不足，本发明提供一种激光焊接产品生产异常检测方法，该方法在激光焊接产品的异常检测过程中首先对采集的图像进行自适应增强处理，大幅提高图像质量，为提高激光焊接异常实时检测系统的精度提供帮助。本发明的目的是提供一种激光焊接产品生产异常检测方法，包括以下步骤：获取激光焊缝灰度图；根据灰度图中每个像素点与其邻域像素点的灰度梯度，获取每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值；根据每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值获取所有疑似焊缝像素点；将所有疑似焊缝像素点经K-means聚类算法获取多个聚簇；根据每个聚簇中像素点的数量及聚簇密度获取准焊缝区域；获取准焊缝区域像素点的灰度区间；根据灰度区间内每个灰度级中像素点的数量，及准焊缝区域内像素点的总数，获取灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点；根据灰度中值点及灰度区间的下限值和上限值，获取调节准焊缝区域增加或降低的灰度级级数；根据调节准焊缝区域增加或降低的灰度级级数对准焊缝区域进行自适应增强，同时对准焊缝区域以外的其他区域进行平滑处理，获取待检测图像；通过对待检测图像边缘检测获取焊缝的纹理及边缘，并标记每道焊纹的两端端点，利用霍夫直线检测对焊缝两侧的端点进行检测对焊缝的异常进行判断。在一实施例中，所述灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点，是将灰度区间内的像素点按灰度级由小到大的顺序对每个灰度级中像素点数量的累加和，等于准焊缝区域内像素点总数的一半时而获取的。在一实施例中，所述调节准焊缝区域增加的灰度级级数是按照以下步骤获取：当灰度区间的下限值小于第一预设阈值时，其所述调节准焊缝区域增加的灰度级级数计算公式如下：式中，表示调节准焊缝区域增加的灰度级级数；，分别表示灰度区间的下限值和上限值；表示灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点。在一实施例中，所述对准焊缝区域进行自适应增强按照以下步骤进行：当灰度区间的下限值小于第一预设阈值时，对准焊缝区域进行自适应增强的函数如下：式中，表示输入准焊缝区域图像；表示输出准焊缝区域自适应增强图像；，分别表示灰度区间的下限值和上限值；表示调节准焊缝区域增加的灰度级级数。在一实施例中，所述调节准焊缝区域降低的灰度级级数是按照以下步骤获取：当灰度区间的上限值大于第二预设阈值时，其所述调节准焊缝区域降低的灰度级级数计算公式如下：式中，表示调节准焊缝区域降低的灰度级级数；，分别表示灰度区间的下限值和上限值；表示灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点。在一实施例中，所述对准焊缝区域进行自适应增强按照以下步骤进行：当灰度区间的上限值大于第二预设阈值时，对准焊缝区域进行自适应增强的函数如下：式中，表示输入准焊缝区域图像；表示输出准焊缝区域自适应增强图像；，分别表示灰度区间的下限值和上限值；表示调节准焊缝区域降低的灰度级级数。在一实施例中，所述所有疑似焊缝像素点是按照以下步骤获取：将每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值，记为；根据每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值将所述灰度图中的像素点划分为第一类像素点和第二类像素点；当时，将该像素点记为第一类像素点；当时，将该像素点记为第二类像素点；将第一类像素点记为疑似焊缝像素点。在一实施例中，所述对焊缝的异常是按照以下步骤进行判断：利用霍夫直线检测对焊缝两侧的端点进行检测分别获取焊缝区域两侧的边缘平直度：当焊缝区域两侧边缘平直度均大于预设平直阈值时，则判断焊缝正常；当焊缝区域任一侧边缘平直度小于预设平直阈值时，则判断焊缝异常。本发明的有益效果是：本发明提供的一种激光焊接产品生产异常检测方法，该方法基于焊缝和背景的纹理，通过对图像中每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值将疑似焊缝区域的像素点进行归类，再通过聚类算法获取准焊缝区域，随后根据准焊缝区域像素点的灰度区间进行分析对准焊缝区域进行自适应增强，同时对准焊缝区域以外的其他区域进行均值滤波平滑，让其高频的边缘信息得到削弱，让焊缝区域相对于背景区域，亮度更适宜，对比度也更明显，从而使得焊缝区域与背景区域之间需要足够大的对比度，焊缝区域内部需要呈现较好的对比度，大幅提高图像质量，为提高激光焊接异常实时检测系统的精度提供帮助。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为本发明的一种激光焊接产品生产异常检测方法的实施例总体步骤的流程示意图。图2为采集的激光焊缝灰度图像。图3为待检测灰度图像。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明所针对的情景为：由于受到焊接工艺、环境等因素的影响，会使焊缝部位产生形变、不均匀、焊偏等缺陷。而焊接过程中异常自动检测系统的拍摄环境比较复杂，环境光不够稳定，且CCD相机实时采集过程中图像传感器也容易过热，因此图像质量问题会对焊缝异常的实时检测结果造成较大影响。基于此本发明提供一种激光焊接产品生产异常检测方法，在激光焊接产品的异常检测过程中首先对采集的图像进行自适应增强处理，大幅提高图像质量，为提高激光焊接异常实时检测系统的检测精度提供帮助。需要说明的是，本发明主要是针对合金铝板的焊缝进行异常检测。本发明提供的一种激光焊接产品生产异常检测方法，参见图1所示，包括以下步骤：S1、获取激光焊缝灰度图；在本实施例中，在激光焊接过程中为了实时监测焊缝的焊接质量，一般采用具有光纤激光高功率以及同轴CCD显示和照明功能的透射聚焦焊接头，获取连续激光焊接焊缝表面成型的激光焊缝图像，便于对图像的处理，将激光焊缝图像进行灰度化处理获取激光焊缝灰度图。需要说明的是，CCD相机的照明及补光系统在焊接过程中总会存在照明过高、过低的情况，导致所采集的焊缝图像边缘的对比度不够稳定，时而清晰，时而模糊。因此，要对采集的焊缝灰度图进行自适应增强，才能准确地识别出图像中焊缝的纹理。为了对焊缝灰度图的自适应增强，则需要利用合金焊缝图像上焊缝区域和背景区域的不同纹理特征，来定位焊缝区域，并针对焊缝区域进行自适应增强，对背景区域进行平滑处理。具体对图像的特征分析如下：参见图2所示，焊缝周围的图像呈现出密集的竖纹，这是由于合金铝板的成型依靠削切、塑形而成，这些密集的竖纹，作为噪声干扰着焊缝边缘的分割和提取。而连续激光焊接焊缝表面的形状则是横向弧状纹理，根据横纹的变化，即可对焊缝边缘及表面的异常进行评价，但在不同环境光下拍摄的焊缝图像，其纹理特征不够明显。在激光焊接过程中产生的弧光会间断性频闪，造成CCD相机拍摄的环境光忽明忽暗，相机补光不及时就会造成拍摄图像过暗。若是过暗的图像中，所有焊缝的边缘高频信息都会被严重削弱。补光过多又会造成图像过亮，无论过亮还是过暗，本质上来讲都是将原本的灰度梯度差距变小了，让高频信息难以表达，因此需要对采集到的图像进行亮度处理。调整亮度的方法即将图像整体灰度级增高或减少，但灰度图像上最大仅有255个灰度级，如果对过暗图像的灰度级整体增高，可能会导致图像局部亮白，丢失图像信息。对过亮图像减少灰度值也一样存在局部过暗的问题。因此采用多段线形增强处理，以灰度区间来限制图像发生局部高亮，过暗的问题。而调整亮度的过程中，对比度必然随之发生改变，如果仅仅根据灰度区间来分段进行亮度增强，在没有目标信息具体位置的情况下，又会导致无差别削弱部分原图像中的灰度梯度。那么就需要同时兼顾图像的亮度和对比度，罗列对图像的理想处理效果：焊缝区域与背景区域之间需要足够大的对比度；焊缝区域内部需要呈现较好的对比度；背景区域呈现较低的对比度，越平滑越好。通过上述分析，对其焊缝灰度图进行定位焊缝区域，并自适应增强，具体如下：S2、根据灰度图中每个像素点与其邻域像素点的灰度梯度，获取每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值；根据每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值获取所有疑似焊缝像素点；需要说明的是，对于焊缝区域，焊纹呈现密集的横向弧形边缘，背景区域呈现密集的竖状纹理。因此前者的灰度梯度几乎发生在竖直方向，后者的灰度梯度几乎发生在水平方向，尽管在未处理的图像上还不能获得准确的焊缝边缘梯度，但可以根据上述的梯度方向，来区分背景及焊缝区域。在本实施例中，对灰度图上每个像素点计算其上下左右4邻域的灰度梯度，计算对比该像素点横向上的灰度梯度与纵向上的灰度梯度，孰高孰低。则每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值计算公式如下：式中，表示第个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值；x，y分别代表第个像素点横、纵坐标；表示指数函数；表示第个像素点的灰度值；表示第个像素点的右邻域像素点的灰度值；表示第个像素点的左邻域像素点的灰度值；表示第个像素点的上邻域像素点的灰度值；表示第个像素点的下邻域像素点的灰度值；表示第个像素点与其右邻域像素点的灰度梯度；表示第个像素点与其左邻域像素点的灰度梯度；同理，，分别表示第个像素点与其上邻域、下邻域像素点的灰度梯度。表示第个像素点的横向综合灰度梯度；表示第个像素点的纵向综合灰度梯度；由于灰度梯度可能为0，也就是说分母可能为0，因此为了维护公式的严谨性，用指数函数对灰度梯度的取值进行矫正，在0-1之间取值。则表示第个像素点的横向综合灰度梯度与纵向综合灰度梯度求比值，因为第个像素点的横向、纵向相邻的像素点分别有两个，将各自方向上的两个灰度梯度平方后相加，再开根号，相当于进行了归一化处理。横向相邻灰度梯度越大，分子越小，同样也越小，因此为恢复公式正比例逻辑关系的计算。在本实施例中，的值，或大于0小于1，或等于1，或大于1；因此，所述所有疑似焊缝像素点是按照以下步骤获取：将每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值，记为；根据每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值将所述灰度图中的像素点划分为第一类像素点和第二类像素点；当1时，将该像素点记为第一类像素点；当1时，将该像素点记为第二类像素点；将第一类像素点记为疑似焊缝像素点。需要说明的是，若，则表示第个像素点的横向灰度梯度小于纵向灰度梯度，其更多存在于焊缝区域。若，则表示第个像素点的横向灰度梯度大于纵向灰度梯度，其存在于背景竖纹区域的概率更高。若，代表上下左右灰度梯度相同，像素周围为均匀区域，要么不存在灰度梯度，要么为孤立点。综上所述，将值求得的结果，按大于1或小于1，分为不同的两类，时，该像素点为疑似焊缝像素点；当1时，将该像素点为第二类像素点，记为疑似背景像素点。那么在图像上每个像素点都被分为了第一类像素点，第二类像素点，还有=1的像素点要么为孤立点，要么为无灰度梯度点，因此不做统计。S3、将所有疑似焊缝像素点经K-means聚类算法获取多个聚簇；根据每个聚簇中像素点的数量及聚簇密度获取准焊缝区域；需要说明的是，本实施例中采用的K-means聚类算法基于现有技术，在此不再赘述。在本实施例中，由于所有的焊缝区域焊纹上的像素点几乎都是疑似焊缝像素点，焊缝区域处的疑似焊缝像素点极为集中，而背景区域中也会存在疑似焊缝像素点的聚簇，但是分布少，且离散。与焊缝区域的疑似焊缝像素点聚簇差异极大。因此，基于argmax函数从多个聚簇中获取最大的聚簇，进而获取准焊缝区域，具体如下：式中，表示准焊缝区域，表示第个聚簇中像素点的数量，表示第个聚簇中聚簇密度；表示聚簇像素点数量和聚簇密度的乘积，用argmax函数选择取值最大的聚簇，认为该聚簇为准焊缝区域。该聚簇的边缘即得到的准焊缝区域的边界限，聚簇内的亮度、对比度增强程度，与聚簇外其他像素点不同。S4、获取准焊缝区域像素点的灰度区间；根据灰度区间内每个灰度级中像素点的数量，及准焊缝区域内像素点的总数，获取灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点；在本实施例中，通过统计准焊缝区域内所有像素点的灰度值，准焊缝区域内，除了疑似焊缝像素点存在灰度梯度的边缘像素点，还有不存在梯度的焊缝内部像素点，获得组成准焊缝区域的像素点的灰度区间，记为，在本实施例中，只需对灰度区间整体的亮度和对比度进行自适应调整即可，剩余的灰度级降低对比度，使图像模糊即可。所述灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点，是将灰度区间内的像素点按灰度级由小到大的顺序对每个灰度级中像素点数量的累加和，等于准焊缝区域内像素点总数的一半时而获取的；其计算公式如下：式中，表示准焊缝区域内含有疑似焊缝像素点的所有灰度级中的任意灰度级；表示第个灰度级的像素点的数量，表示准焊缝区域内像素点总数；表示当累加值到达时，，表示灰度中值点；需要说明的是，区间内既包含边缘疑似焊缝像素点，又包含其他非边缘像素点，疑似焊缝像素点在区间内的分布不同，若大部分疑似焊缝像素点在区间内偏高，整体增加灰度值后，会使很多疑似焊缝像素点亮度过高；若大部分疑似焊缝像素点在区间内偏低，整体降低灰度值后，又会使很多疑似焊缝像素点灰度值过低；类似灰度偏低、偏高的弱边缘疑似焊缝像素点调节过度的情况，需要先判断疑似焊缝像素点在区间内的位置，因此在区间内的位置决定了整体的亮度值调节程度，即以点为中心整体调高或者调低区间的灰度值。这样可以保证疑似焊缝像素点调节程度适中，不会出现过调。在本实施例中，具体调节实现为：若图像整体过暗，则需要调高区间的灰度级，若的位置在中偏向左侧，则代表疑似焊缝像素点的灰度级整体偏低，需要多调高一点。若的位置在中偏向右侧，则少调高一点。同理若图像整体偏亮，则调低区间的灰度级，的位置在中偏右，则多调低一点，偏左，则少调低一点。为了实现对图像中焊缝区域的自适应增强调节，具体如下：S5、根据灰度中值点及灰度区间的下限值和上限值，获取调节准焊缝区域增加或降低的灰度级级数；根据调节准焊缝区域增加或降低的灰度级级数对准焊缝区域进行自适应增强，同时对准焊缝区域以外的其他区域进行平滑处理，获取待检测图像；在本实施例中，所述调节准焊缝区域增加的灰度级级数是按照以下步骤获取：当灰度区间的下限值小于第一预设阈值时，其所述调节准焊缝区域增加的灰度级级数计算公式如下：式中，表示调节准焊缝区域增加的灰度级级数；，分别表示灰度区间的下限值和上限值；表示灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点。需要说明的是，当灰度区间的下限值小于第一预设阈值时，表示图像的亮度较低，也就是代表图像亮度较低，需要调高灰度级，则为区间可调高灰度级的最大级数，则是判断的位置，越大，则的比值越大，代表位置偏左，需要多调高一些灰度级，，则是本次调节增加的灰度级级数。所述对准焊缝区域进行自适应增强按照以下步骤进行：当灰度区间的下限值小于第一预设阈值时，则准焊缝区域自适应增强的函数如下：式中，表示输入准焊缝区域图像；表示输出准焊缝区域自适应增强图像；，分别表示灰度区间的下限值和上限值；表示调节准焊缝区域增加的灰度级级数。需要说明的是，准焊缝区域自适应增强的函数是线性增强函数。在本实施例中，所述调节准焊缝区域降低的灰度级级数是按照以下步骤获取：当灰度区间的上限值大于第二预设阈值时，其所述调节准焊缝区域降低的灰度级级数计算公式如下：式中，表示调节准焊缝区域降低的灰度级级数；，分别表示灰度区间的下限值和上限值；表示灰度区间中含有疑似焊缝像素点的所有灰度级的灰度中值点。需要说明的是，当灰度区间的上限值大于第二预设阈值时，图像的亮度较高，也就是，代表图像亮度较高，需要调低灰度级，则为区间可调低灰度级的最大级数，则是判断的位置，越大，则的比值越大，代表位置偏右，需要多调低一些灰度级，，则是本次调节降低的灰度级级数。所述对准焊缝区域进行自适应增强按照以下步骤进行：当灰度区间的上限值大于第二预设阈值时，则准焊缝区域的自适应增强函数如下：式中，表示输入准焊缝区域图像；表示输出准焊缝区域自适应增强图像；，分别表示灰度区间的下限值和上限值；表示调节准焊缝区域降低的灰度级级数。其中，表示的是获得焊缝区域像素点的线性增强函数，经过线性灰度变化，图像准焊缝区域亮度分量的线性范围从变化到了，或者；至此，完成了对准焊缝区域的自适应增强。需要说明的是，第一预设阈值和第二预设阈值时根据采集的图像的亮度根据实际情况进行设定。另外，对于准焊缝区域以外的其他区域，则认为其是背景区域，不进行任何增强处理，但是图像上的干扰信息过多，所有干扰焊缝区域检测的因素均为噪声，包括这些背景上的竖纹，那么对这些区域进行均值滤波平滑，让其高频的边缘信息得到削弱，这样一来，焊缝区域相对于背景区域，亮度更适宜，对比度也更明显。从而得到处理后的待检测图像，参见图3所示，其中，待检测图像是灰度图，即为待检测灰度图像。S6、通过对待检测图像边缘检测获取焊缝的纹理及边缘，并标记每道焊纹的两端端点，利用霍夫直线检测对焊缝两侧的端点进行检测对焊缝的异常进行判断。所述对焊缝的异常是按照以下步骤进行判断：利用霍夫直线检测对焊缝两侧的端点进行检测分别获取焊缝区域两侧的边缘平直度：当焊缝区域两侧边缘平直度均大于预设平直阈值时，则判断焊缝正常；当焊缝区域任一侧边缘平直度小于预设平直阈值时，则判断焊缝异常。其中，预设平直阈值根据焊缝的实际情况进行设定。另外，焊缝边缘异常包括平直度不够，边缘弯曲、凹陷、咬边，或者宽窄度不一，这些都可以简单通过焊缝边缘点进行特征提取，进行判断。综上，本发明提供的一种激光焊接产品生产异常检测方法，该方法基于焊缝和背景的纹理，通过对图像中每个像素点的横向综合灰度梯度与纵向综合灰度梯度的比值将疑似焊缝区域的像素点进行归类，再通过聚类算法获取准焊缝区域，随后根据准焊缝区域像素点的灰度区间进行分析对准焊缝区域进行自适应增强，同时对准焊缝区域以外的其他区域进行均值滤波平滑，让其高频的边缘信息得到削弱，让焊缝区域相对于背景区域，亮度更适宜，对比度也更明显，从而使得焊缝区域与背景区域之间需要足够大的对比度，焊缝区域内部需要呈现较好的对比度，大幅提高图像质量，为提高激光焊接异常实时检测系统的精度提供帮助。以上仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
