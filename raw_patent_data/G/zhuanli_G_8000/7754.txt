标题title
基于多尺度特征融合神经网络的井壁裂缝识别方法
摘要abst
本发明公开了基于多尺度特征融合神经网络的井壁裂缝识别方法，包括以下具体步骤：S1：使用浅层特征提取模块对输入的电阻率测井成像图进行浅层特征提取；S2：使用多尺度空洞卷积注意力模块对浅层特征进行深层特征提取；S3：采用特征融合上采样模块将浅层特征和深层特征拼接融合后特征还原至原始图像输入尺寸；S4：调整通道数为标签类别数，根据背景和前景特征图结合损失函数计算每个像素点属于背景和前景的概率，实现井壁裂缝区域的自动识别。本发明在确保裂缝智能识别精度和速度的前提下，减少了人工利用电阻率测井成像图进行裂缝检测的工作量，为钻井工作提供了强有力的安全保障，满足了当前钻井降本增效的迫切需求。
权利要求书clms
1.基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，包括以下具体步骤：S1：使用浅层特征提取模块对输入的电阻率测井成像图进行浅层特征提取；S2：使用多尺度空洞卷积注意力模块对浅层特征进行深层特征提取；S3：采用特征融合上采样模块将浅层特征和深层特征拼接融合后特征还原至原始图像输入尺寸；S4：调整通道数为标签类别数，根据背景和前景特征图结合损失函数计算每个像素点属于背景和前景的概率，实现井壁裂缝区域的自动识别。2.根据权利要求1所述的基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，所述步骤S1中浅层特征提取模块包括卷积层、BN层、激活函数和池化层；激活函数选用ReLU函数；浅层特征提取模块整体呈现下采样过程。3.根据权利要求1所述的基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，所述多尺度空洞卷积注意力模块包括多尺度空洞卷积和注意力机制模块。4.根据权利要求3所述的基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，所述多尺度空洞卷积由三个不同尺度的卷积并列组成，用于获取全局特征，另外两个为不同空洞率的空洞卷积。5.根据权利要求3所述的基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，所述注意力机制模块包括全局池化层、全连接层、ReLU函数和Sigmoid函数。6.根据权利要求1所述的基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，所述步骤S3具体包括以下步骤：S301：采用上采样操作将深层特征尺寸还原至与浅层特征尺寸一致；S302：使用直连方式对还原后的深层特征和浅层特征进行拼接操作，形成一个新的特征张量；S303：再次对新的特征张量连续使用3×3的卷积操作来提高其表征能力，对新特征张量进行上采样在将新特征张量还原至输入图像尺寸。7.根据权利要求1所述的基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，所述标签类别数为2，即通道为背景和前景特征图。8.根据权利要求1所述的基于多尺度特征融合神经网络的井壁裂缝识别方法，其特征在于，所述步骤S4具体包括以下步骤：S401：使用1×1卷积来调整通道数为标签类别数，标签类别数为2；S402：根据背景和前景特征图结合损失函数，计算每个像素点属于背景和前景的概率；S403：将背景像素点置为黑色，前景像素点置为标签颜色，实现井壁裂缝区域的自动识别。
说明书desc
技术领域本发明涉及深度学习技术领域，尤其基于多尺度特征融合神经网络的电阻率测井成像图井壁裂缝识别方法。背景技术近年来，随着大数据、人工智能、云计算等技术的快速发展，以人工智能为代表的第四次工业革命已经来到，油气勘探开发智能化也成为了全球油气行业发展的必然趋势。测井工程一直以来都是油气勘探开发领域内不可或缺的工程技术，是油气勘探安全、高效、经济开发的保障。目前我国油气行业也逐渐开始推进智能化测井分析的进程，结合大数据、人工智能等新兴理论及技术，有望实现复杂井况的准确分析及井筒稳定性智能闭环调控。针对目前基于人机交互的裂缝识别技术处理过程工作量巨大，且人为主观性强、稳定性差，难以达到稳定、准确表征分析裂缝的要求等问题，有必要使用深度学习框架构建多尺度特征融合裂缝智能识别网络模型，实现对电阻率测井成像图中井壁图像深层特征的提取，并将浅层特征与深层特征结合形成更具表征能力的新特征，以满足裂缝智能识别任务对高准确度、高速、强抗干扰能力的需求。并在确保裂缝智能识别精度和速度的前提下，减少人工裂缝检测的工作量，为钻井工作提供了强有力的安全保障，满足当前钻井降本增效的迫切需求，并能为后续井筒稳定性分析及调控提供了一个有益的参考方向。发明内容本发明的目的在于克服现有技术的不足，提供基于多尺度特征融合神经网络的井壁裂缝识别方法：针对电阻率成像测井数据集进行裂缝轮廓智能提取和识别的问题，对已有网络架构优化和改进，使其具有最佳实用性，保证其在样本数量较少的情况下，依然具有较高的识别精度。本发明的目的是通过以下技术方案来实现的：基于多尺度特征融合神经网络的井壁裂缝识别方法，包括以下具体步骤：S1：使用浅层特征提取模块对输入的图像进行浅层特征提取；S2：使用多尺度空洞卷积注意力模块对浅层特征进行深层特征提取；S3：采用特征融合上采样模块将浅层特征和深层特征拼接融合后特征还原至原始图像输入尺寸；S4：调整通道数为标签类别数，根据背景和前景特征图结合损失函数计算每个像素点属于背景和前景的概率，实现井壁裂缝区域的自动识别。所述步骤S1中浅层特征提取模块包括卷积层、BN层、激活函数和池化层，其中所有的卷积核大小均为3×3，步长为1，padding值为1；激活函数选用ReLU函数；最大池化层卷积核大小为2×2，步长为2；浅层特征提取模块整体呈现下采样过程。所述多尺度空洞卷积注意力模块包括多尺度空洞卷积和注意力机制模块。所述多尺度空洞卷积由三个不同尺度的卷积并列组成，其中一个为1×1卷积，用于获取全局特征，另外两个为不同空洞率的空洞卷积。所述注意力机制模块包括全局池化层、全连接层、ReLU函数和Sigmoid函数；注意力机制模块首先对输入的特征层进行全局平均池化，随后进行两次全连接操作，第一个全连接层神经元个数较少，第二个全连接层神经与个数与输入特征通道数相同；在完成两次全连接后，使用Sigmoid函数将输入固定在0～1之间，将输出值与原始输入权重相乘即完成了对各通道权重的学习。所述步骤S3具体包括以下步骤：S301：采用上采样操作将深层特征尺寸还原至与浅层特征尺寸一致；S302：使用直连方式对还原后的深层特征和千层特征进行拼接操作，形成一个新的特征张量；S303：再次对新的特征张量连续使用3×3的卷积操作来提高其表征能力，对新特征张量进行上采样在将新特征张量还原至输入图像尺寸。所述标签类别数为2，即通道为背景和前景特征图。所述步骤S4具体包括以下步骤：S401：使用1×1卷积来调整通道数为标签类别数，标签类别数为2；S402：根据背景和前景特征图结合损失函数，计算每个像素点属于背景和前景的概率；S403：将背景像素点置为黑色，前景像素点置为标签颜色，实现井壁裂缝区域的自动识别。本发明的有益效果：本发明利用多尺度空洞卷积注意力模块以及特征融合上采样模块，构建了井壁裂缝区域识别网络。对于给定的电阻率测井成像图，首先采用浅层特征提取模块对成像图中呈裂缝形态的图像纹理、形态、颜色等特征进行提取。在此之后对浅层特征使用多尺度空洞卷积模块，来获取该裂缝在不同尺度下的高级别语义信息，通过注意力机制对这些语义特征调整各通道的权重，形成最后的深层特征。最后使用上采样模块，将裂缝的深层特征还原至于浅层特征尺寸一致，将深层特征与浅层特征进行直连，再使用上采样模块将融合后特征还原至原始图像输入尺寸。为提高网络模型的泛化能力，本发明设计的网络模型不使用全连接层对最后的输出结果进行预测，此处使用1×1卷积来调整通道数为标签类别数。此时两个通道为背景和前景特征图，根据该特征结合损失函数计算每个像素点属于背景和前景的概率，最终将背景像素点置为黑色，前景像素点置为标签颜色。该操作减少了模型参数的数量，同时大大降低了过拟合的可能性。最终通过计算每个像素属于裂缝、背景的概率来实现井壁裂缝区域的自动识别。在确保裂缝智能识别精度和速度的前提下，减少了人工裂缝检测的工作量，为钻井工作提供了强有力的安全保障，满足了当前钻井降本增效的迫切需求。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见的，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图示出的结构获得其他的附图。图1是本发明的网络构成示意图；图2是本发明的浅层特征提取模块结构示意图；图3是本发明的多尺度空洞卷积模块结构示意图；图4是本发明的注意力机制模块处理流程框图；图5是本发明的特征融合上采样模块结构示意图。具体实施方式应当理解，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明。下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。另外，各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当人认为这种技术方案的结合不存在，也不在本发明要求的保护范围之内。本发明主要设计了一种基于多尺度特征的端到端的井壁裂缝区域识别方法，该方法主要由两个部分组成：第一部分是使用多尺度空洞卷积模块来获取电阻率成像测井图中裂缝区域更为全面的上下文特征，同时使用注意力机制调整各通道权重；第二部分是引入特征融合上采样模块，将第一部分提取的深层特征与浅层特征相融合，从多个层次维度重新组合，形成更具代表性的裂缝区域特征。基于多尺度特征融合神经网络的井壁裂缝识别方法，包括以下具体步骤：S1：使用浅层特征提取模块对输入的图像进行浅层特征提取；S2：使用多尺度空洞卷积注意力模块对浅层特征进行深层特征提取；S3：采用特征融合上采样模块将浅层特征和深层特征拼接融合后特征还原至原始图像输入尺寸；S4：调整通道数为标签类别数，根据背景和前景特征图结合损失函数计算每个像素点属于背景和前景的概率，实现井壁裂缝区域的自动识别。需要说明的是，浅层特征提取模块：一般来说，图像的浅层特征与输入的图像较为相近，浅层特征包含更多的像素点信息，例如：颜色、纹理、边缘等。目前人工识别裂缝在一定程度上也需要对裂缝的分布形态、填充情况等进行分析，而这些信息在电阻率成像测井图中的反应即为图像的纹理、颜色信息。因此，在对输入进行深层特征提取之前，需要设计一个模块对其浅层特征进行有效提取。人工智能技术在计算机视觉领域发展至今日，许多的图像检测、分类、分割网络都有不错的图像特征提取功能，这其中对于图像的浅层特征提取而言，大多是对Unet网络的改进。因此本文设计的浅层特征提取模块也是受Unet模型启发，模块具体结构图如图2所示。该模块由卷积层、BN层、激活函数以及池化层组成。其中所有的卷积核大小均为3×3，步长为1，padding值为1；激活函数选用ReLU函数；最大池化层卷积核大小为2×2，步长为2。模块整体呈现下采样过程，由于设置了BN层将卷积所得数据进行归一化处理，在防止过拟合、控制梯度爆炸防止梯度消失的前提下，加快网络的训练和收敛的速度。该模块的详细体系结构如表1所示。表中eps为当前学习率，padding为对图像矩阵外围补零数量。表1需要说明的是，多尺度空洞卷积注意力模块：1.多尺度空洞卷积在常规卷积网络中，通常使用卷积核由上至下地识别具有判别力的目标区域，但是对于判别力较弱的区域则会失去分类能力。在深度卷积网络中则是使用不同尺寸感受野的卷积核来获取目标区域周围信息进行叠加混合，从而达到提高分类能力的目的。空洞卷积是一种特殊形式的普通卷积，通过在卷积核的权重参数间插入零值来有效扩大卷积核的感受野。对于一个n×n大小的卷积核，其感受野计算公式如式所示：R＝n+×式中，Dn代表卷积核的空洞率，即在权重参数间添加的零值数量。由于整个卷积过程中依然只有n×n个参数进行计算，空洞卷积实现了在扩大感受野的同时不增加计算量，同时保留了原始分辨率。同时受DeepLab使用空洞空间金字塔来捕获多尺度信息的启发，设计本文网络中的多尺度空洞卷积模块。将原始输入数据经过普通卷积池化处理后形成浅层图像特征，再将浅层特征传入多尺度空洞卷积模块。该模块由三个不同尺度的卷积并列组成，其中，一个为1×1卷积用于获取全局特征，另外两个为不同空洞率的空洞卷积，具体结构如图3所示。2.注意力机制在经过三种不同尺度卷积提取特征后，采用直连方式将特征进行拼接，相较于传统特征融合采用权重相乘的方法，直连能够最大程度上保留各种尺度下的特征信息。由于经普通卷积处理后的浅层特征通道数较多，为提高网络训练质量，缩短网络每次训练的时间，在此之后加入注意力机制模块，主动学习各通道权重。该注意力机制模块首先对输入的特征层进行全局平均池化，随后进行两次全连接操作，第一个全连接层神经元个数较少，第二个全连接层神经与个数与输入特征通道数相同；在完成两次全连接后，使用Sigmoid函数将输入固定在0～1之间，将输出值与原始输入权重相乘即完成了对各通道权重的学习。在此之后通过1×1卷积核来调整通道数，使其与浅层特征通道数相等。至此，多尺度空洞卷积注意力模块设计完成，该模块具体框架结构如表2所示。表中dilation为空洞卷积的空洞率，conv_cat模块的输入为branch1、branch2、branch3模块的输出。由于注意力机制Selayer是对特征图的每个通道赋予权重，因此不改变输入、输出特征尺寸。表2在经过4.3.2节中设计的多尺度空洞卷积模块处理后，原始的输入图像已经转化成了丰富的语义视觉特征，由于这些特征的空间分辨率较为粗糙，不具备直接用于裂缝区域提取的可能性。而在前文中提及目前主要式通过人工结合计算机的人机交互方式来实现裂缝的识别，人工识别裂缝很大程度上需要参考裂缝的形态、颜色等信息，这类信息往往在计算机视觉中属于浅层特征，因此考虑将深层特征与浅层特征拼接的方式，以此来形成一个更具表征能力的特征张量。故而此处的上采样模块包含两个输入：一是经普通卷积提取到的图像浅层特征；二是经多尺度空洞卷积提取到的深层特征。由于卷积、池化操作会缩小图像数据尺寸，因此浅层特征与深层特征的尺寸不一致，因此无法直接将二者拼接，需要通过上采样操作将深层特征尺寸还原至与浅层特征尺寸一致。本文选用双线性插值的方式来实现上采样操作，该方法相比其他上采样方法而言计算简单且无需进行参数的学习。经上采样操作还原后的深层特征已具备和浅层特征一样的尺寸，此处使用直连方式对其进行拼接操作，形成一个新的特征张量。再次对新的特征张量连续使用3×3的卷积操作来提高其表征能力，此时的特征张量的尺寸相比于原始输入图像尺寸小得多，因此对其进行上采样在将其还原至输入图像尺寸。该模块具体框架结构如表3所示，表中p为暂时随机丢弃神经元概率，该操作能够在一定程度上减少网络过拟合概率，减少网络训练时间。其中cat_conv层输入为Shortcut_conv层输出以及SElayer层输出。经过训练后，该模块能够对电阻率成像测井图提取形成一个具有高度表征能力的特征。表3本发明构建了如图1所示的井壁裂缝区域识别网络。对于给定的井壁裂缝图像，首先采用浅层特征提取模块对图像的纹理、形态、颜色等特征进行提取。在此之后对浅层特征使用多尺度空洞卷积模块，来获取该裂缝在不同尺度下的高级别语义信息，通过注意力机制对这些语义特征调整各通道的权重，形成最后的深层特征。最后使用上采样模块，将裂缝的深层特征还原至于浅层特征尺寸一致，将深层特征与浅层特征进行直连，再使用上采样模块将融合后特征还原至原始图像输入尺寸。为提高网络模型的泛化能力，本文设计的网络模型不使用全连接层对最后的输出结果进行预测，此处使用1×1卷积来调整通道数为标签类别数。此时两个通道为背景和前景特征图，根据该特征结合损失函数计算每个像素点属于背景和前景的概率，最终将背景像素点置为黑色，前景像素点置为标签颜色。该操作减少了模型参数的数量，同时大大降低了过拟合的可能性。最终通过计算每个像素属于裂缝、背景的概率来实现井壁裂缝区域的自动识别。本文所设计的多尺度信息融合裂缝区域识别网络采用交叉熵函数作为网络的损失函数，选用自适应估计矩作为网络的优化器。Adam算法与传统的随机梯度下降算法的不同之处在于Adam算法通过计算梯度的一阶矩估计和二阶矩估计来为不同的权重参数设立独立的、具有自适应性的学习率。该方法计算效率高，所需内存少，适合解决大规模参数优化问题，因此本文设计的网络也选用该优化器。以上所述仅是本发明的优选实施方式，应当理解本发明并非局限于本文所披露的形式，不应看作是对其他实施例的排除，而可用于各种其他组合、修改和环境，并能够在本文所述构想范围内，通过上述教导或相关领域的技术或知识进行改动。而本领域人员所进行的改动和变化不脱离本发明的精神和范围，则都应在本发明所附权利要求的保护范围内。
