标题title
一种数据存储方法、存储器件和高空车
摘要abst
本发明提供一种数据存储方法、存储器件和高空车，属于工程机械领域。所述数据存储方法包括将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个存储扇区设置读出优选级和写入优先级，随后根据存储器件接收的操作指令类型执行相应的操作；当操作指令为读出指令时，比较不同存储扇区的读出优先级并将具有最高读出优先级的存储扇区内的待读出数据读出；当操作指令为写入指令时，比较不同存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级。本发明提供的数据存储方法能够提高存储器件的使用寿命以及使存储器件擦写均衡。
权利要求书clms
1.一种数据存储方法，其特征在于，包括以下步骤：S1：将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个所述存储扇区设置读出优选级和写入优先级；S2：根据所述存储器件接收的操作指令类型执行相应的操作：当所述操作指令为读出指令时，比较不同所述存储扇区的读出优先级并将具有最高读出优先级的所述存储扇区内的待读出数据读出；当所述操作指令为写入指令时，比较不同所述存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的所述存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级。2.如权利要求1所述的一种数据存储方法，其特征在于，步骤S1中所述将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个存储扇区设置读出优选级和写入优先级，包括：S11：将所述存储器件的存储空间划分为预设数量的存储扇区，其中，每个所述存储扇区包括数个字节；S12：设置每个所述存储扇区的第一个字节存储所述存储扇区的扇区ID；其中，所述扇区ID的取值范围为零至一预设最大阈值，且所述扇区ID的值越大，则读出优先级越高；所述扇区ID的值越小，则写入优先级越高；S13：按照优先级初始化规则，将每个所述存储扇区的扇区ID设置为0。3.如权利要求2所述的一种数据存储方法，其特征在于，步骤S2中所述当所述操作指令为读出指令时，比较不同所述存储扇区的读出优先级并将具有最高读出优先级的所述存储扇区内的待读出数据读出，包括：S211：比较不同的所述存储扇区的所述扇区ID，确定具有最大扇区ID的所述存储扇区；S212：将具有最大扇区ID的所述存储扇区内的所述待读出数据读出。4.如权利要求2所述的一种数据存储方法，其特征在于，步骤S2中所述当所述操作指令为写入指令时，比较不同所述存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的所述存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级，包括：S221：比较不同的所述存储扇区的所述扇区ID，确定具有最小扇区ID的所述存储扇区；S222：将所述待写入数据写入具有最小扇区ID的所述存储扇区；S223：将所述最小扇区ID更新为所述存储器件中最大扇区ID＋1。5.如权利要求4所述的一种数据存储方法，其特征在于，当所述存储器件内的最大扇区ID达到所述预设最大阈值时，对所述存储器件进行初始化；其中，所述初始化包括：将所有存储扇区的扇区ID设置为0。6.如权利要求5所述的一种数据存储方法，其特征在于，还包括：当对初始化后的所述存储器件进行首次数据写入时，任选一所述存储扇区作为第一扇区，并将首次待写入数据写入所述第一扇区，将所述第一扇区的扇区ID更新为1；当进行第二次数据写入时，将与所述第一扇区相邻的存储扇区作为第二扇区，将所述待写入数据写入所述第二扇区，并将所述第二扇区的扇区ID更新为2；以此类推，将每次写入的所述存储扇区的扇区ID设置为最大扇区ID+1，直至当前写入所述存储扇区的扇区ID达到所述预设最大阈值时，将再次对所述存储器件进行初始化。7.如权利要求1所述的一种数据存储方法，其特征在于，所述待写入数据包括：故障诊断数据、工作时间数据和系统状态数据。8.如权利要求1所述的一种数据存储方法，其特征在于，当进行故障诊断数据、工作时间数据或系统状态数据的写入时，所述写入指令与下一写入指令间具有一预设时间间隔。9.一种存储器件，其特征在于，包括采用权利要求1-8中任一项所述的数据存储方法进行数据读写。10.一种高空车，其特征在于，包括权利要求9所述的存储器件。
说明书desc
技术领域本发明涉及工程机械领域，尤其涉及一种数据存储方法、存储器件和高空车。背景技术在高空车的应用体系中，会有一些需要频繁进行存储更新的数据，如工作时间数据、故障诊断数据，以及系统状态等数据，这类数据在短时间内的频繁数据更新擦写，非常容易引起非易失性存储器件的功能失效，从而造成数据丢失和功能异常。同时现有的如EEPROM或FLASH等非易失性存储器件，都有一定擦写寿命，当擦写次数超过擦写寿命后，同样使得该非易失性存储器件会产生功能失效，无法正常存储数据。因此，如何提供一种数据存储方法，以克服现有技术中存在的上述缺陷，日益成为本领域技术人员亟待解决的技术问题之一。发明内容本发明的目的在于提供一种数据存储方法、存储器件和高空车，以解决现有技术存在的短时间内的频繁的数据更新擦写，而导致非易失性存储器件功能失效和数据丢失的问题。为了达到上述目的，本发明提供了一种数据存储方法，包括以下步骤：S1：将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个所述存储扇区设置读出优选级和写入优先级；S2：根据所述存储器件接收的操作指令类型执行相应的操作：当所述操作指令为读出指令时，比较不同所述存储扇区的读出优先级并将具有最高读出优先级的所述存储扇区内的待读出数据读出；当所述操作指令为写入指令时，比较不同所述存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的所述存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级。可选的，步骤S1中所述将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个存储扇区设置读出优选级和写入优先级，包括：S11：将所述存储器件的存储空间划分为预设数量的存储扇区，其中，每个所述存储扇区包括数个字节；S12：设置每个所述存储扇区的第一个字节存储所述存储扇区的扇区ID，其中，所述扇区ID的取值范围为零至一预设最大阈值，且所述扇区ID的值越大，则读出优先级越高；所述扇区ID的值越小，则写入优先级越高；S13：按照优先级初始化规则，将每个所述存储扇区的扇区ID设置为0。可选的，步骤S2中所述当所述操作指令为读出指令时，比较不同所述存储扇区的读出优先级并将具有最高读出优先级的所述存储扇区内的待读出数据读出，包括：S211：比较不同的所述存储扇区的所述扇区ID，确定具有最大扇区ID的所述存储扇区；S212：将具有最大扇区ID的所述存储扇区内的所述待读出数据读出。可选的，步骤S2中所述当所述操作指令为写入指令时，比较不同所述存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的所述存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级，包括：S221：比较不同的所述存储扇区的所述扇区ID，确定具有最小扇区ID的所述存储扇区；S222：将所述待写入数据写入具有最小扇区ID的所述存储扇区；S223：将所述最小扇区ID更新为所述存储器件中最大扇区ID＋1。可选的，当所述存储器件内的最大扇区ID达到所述预设最大阈值时，对所述存储器件进行初始化；其中，所述初始化包括：将所有存储扇区的扇区ID设置为0。可选的，还包括：当对初始化后的所述存储器件进行首次数据写入时，任选一所述存储扇区作为第一扇区，并将首次待写入数据写入所述第一扇区，将所述第一扇区的扇区ID更新为1；当进行第二次数据写入时，将与所述第一扇区相邻的存储扇区作为第二扇区，将所述待写入数据写入所述第二扇区，并将所述第二扇区的扇区ID更新为2；以此类推，将每次写入的所述存储扇区的扇区ID设置为最大扇区ID+1，直至当前写入所述存储扇区的扇区ID达到所述预设最大阈值时，将再次对所述存储器件进行初始化。可选的，所述待写入数据包括：故障诊断数据、工作时间数据和系统状态数据。可选的，当进行故障诊断数据、工作时间数据或系统状态数据的写入时，所述写入指令与下一写入指令间具有一预设时间间隔。为了实现上述目的，本发明还提供一种存储器件，包括采用上述任一项所述的数据存储方法进行数据读写。为了实现上述目的，本发明又提供一种高空车，包括上述的存储器件。与现有技术比，本发明提供的一种数据存储方法、存储器件和高空车具有以下有益效果：本发明提供的一种数据存储方法，包括将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个所述存储扇区设置读出优选级和写入优先级；随后根据所述存储器件接收的操作指令类型执行相应的操作；当所述操作指令为读出指令时，比较不同所述存储扇区的读出优先级并将具有最高读出优先级的所述存储扇区内的待读出数据读出；当所述操作指令为写入指令时，比较不同所述存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的所述存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级。本发明提供的数据存储方法通过将所述存储器件的存储空间划分为具有不同读出优选级和写入优先级的存储扇区，并在每一次进行写入操作后，改变进行过写入操作的所述存储扇区的写入优先级。由此，当对所述存储器件进行下一次的数据读写时，所述待写入数据按照将所述存储扇区新的写入优先级而被分配到不同的扇区中进行存储，从而达到擦写均衡的目的。同时，由于在进行数据存储时，每一次的所述待写入数据仅被写入其中一个所述存储扇区内，因此，所述存储器件能够进行更多频次的数据擦写操作，从而使得所述存储器件具有更长的使用寿命。由于本发明提供的存储器件采用的是上述数据存储方法，以及所述高空车内包括采用上述数据存储方法的存储器件，因此，至少具有相同的有益效果，在此不再一一赘述。附图说明图1为本发明一实施方式提供的数据存储方法的流程图；图2为本发明一实施方法提供的存储单元的分配图。具体实施方式下面将结合示意图对本发明的具体实施方式进行更详细的描述。根据下列描述，本发明的优点和特征将更清楚。需说明的是，附图均采用非常简化的形式且均使用非精准的比例，仅用以方便、明晰地辅助说明本发明实施例的目的。应当了解，说明书附图并不一定按比例的显示本发明的具体结构，并且在说明书附图中用于说明本发明某些原理的图示性特征也会采取略微简化的画法。本文所公开的本发明的具体设计特征包括例如具体尺寸、方向、位置和外形将部分地由具体所要应用和使用的环境来确定。以及，在以下说明的实施方式中，有时在不同的附图之间共同使用同一附图标记来表示相同部分或具有相同功能的部分，而省略其重复说明。在本说明书中，使用相似的标号和字母表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中不需要对其进行进一步讨论。实施例一本实施例提供了一种数据存储方法，具体地，请参见附图1和附图2，其中，图1为本发明一实施方式提供的数据存储方法的流程图；图2为本发明一实施方法提供的存储单元的分配图；结合图1和图2可以明显看出，所述数据存储方法包括将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个所述存储扇区设置读出优选级和写入优先级；随后根据所述存储器件接收的操作指令类型执行相应的操作：当所述操作指令为读出指令时，比较不同所述存储扇区的读出优先级并将具有最高读出优先级的所述存储扇区内的待读出数据读出；当所述操作指令为写入指令时，比较不同所述存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的所述存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级。如此设置，本发明提供的数据存储方法通过将所述存储器件的存储空间划分为具有不同读出优选级和写入优先级的存储扇区，并在每一次进行写入操作后，改变进行过写入操作的所述存储扇区的写入优先级。由此，当对所述存储器件进行下一次的数据读写时，所述待写入数据按照将所述存储扇区新的写入优先级而被分配到不同的扇区中进行存储，从而达到擦写均衡的目的。同时，由于在进行数据存储时，每一次的所述待写入数据仅被写入其中一个所述存储扇区内，因此，所述存储器件能够进行更多频次的数据擦写操作，从而使得所述存储器件具有更长的使用寿命。需要特别说明的是，如本领域技术人员可以理解地，本发明并不限制所述存储器件的类型，所述存储器件包括但不限于FLASH或EEPROM。优选的，步骤S1中所述将存储器件的存储空间划分为若干个存储扇区，并按照优先级初始化规则为每一个存储扇区设置读出优选级和写入优先级，包括：S11：将所述存储器件的存储空间划分为预设数量的存储扇区，其中，每个所述存储扇区包括数个字节；S12：设置每个所述存储扇区的第一个字节存储所述存储扇区的扇区ID，其中，所述扇区ID的取值范围为零至一预设最大阈值，且所述扇区ID的值越大，则读出优先级越高；所述扇区ID的值越小，则写入优先级越高；S13：按照优先级初始化规则，将每个所述存储扇区的扇区ID设置为0。由此，本发明提供的数据存储方法能够根据所述扇区ID的大小确定所述存储扇区的读出优先级和写入优先级，从而保障了所述待写入数据的顺利写入以及所述待读出数据的顺利读出。在其中一种优选实施方式中，所述预设最大阈值为255。优选的，步骤S2中所述当所述操作指令为读出指令时，比较不同所述存储扇区的读出优先级并将具有最高读出优先级的所述存储扇区内的待读出数据读出具体包括：S211：比较不同的所述存储扇区的所述扇区ID，确定具有最大扇区ID的所述存储扇区；S212：将具有最大扇区ID的所述存储扇区内的所述待读出数据读出。步骤S2中所述当所述操作指令为写入指令时，比较不同所述存储扇区的写入优先级并将待写入数据写入具有最高写入优先级的所述存储扇区，并按照优先级修改规则更新该存储扇区的读出优先级和写入优先级，包括：S221：比较不同的所述存储扇区的所述扇区ID，确定具有最小扇区ID的所述存储扇区；S222：将所述待写入数据写入具有最小扇区ID的所述存储扇区；S223：将所述最小扇区ID更新为所述存储器件中最大扇区ID＋1。由此，通过将所述待写入数据写入所述具有最小扇区ID的存储扇区内，并且将已写入所述待写入数据的所述存储扇区的扇区ID更新为所述存储器件中最大扇区ID＋1，从而使得所述存储器件内的最大扇区ID以及最小扇区ID改变，因此当进行下一次的数据读写操作时，所述下一待写入数据将被写入更新后新的最小扇区ID的存储扇区内，以及将更新后新的最大扇区ID的存储扇区内的数据读出。优选的，当所述存储器件内的最大扇区ID达到所述预设最大阈值时，对所述存储器件进行初始化，其中，所述初始化包括：将所有存储扇区的扇区ID设置为0，当对初始化后的所述存储器件进行首次数据写入时，任选一所述存储扇区作为第一扇区，并将首次待写入数据写入所述第一扇区，将所述第一扇区的扇区ID更新为1；当进行第二次数据写入时，将与所述第一扇区相邻的存储扇区作为第二扇区，将所述待写入数据写入所述第二扇区，并将所述第二扇区的扇区ID更新为2；以此类推，将每次写入的所述存储扇区的扇区ID设置为最大扇区ID+1，直至当前写入所述存储扇区的扇区ID达到所述预设最大阈值时，将再次对所述存储器件进行初始化。由此，当对所述存储器件进行写入操作时，随着所述扇区ID的更新，所述待写入数据将会被分配到不同的存储扇区中进行存储，从而达到擦写均衡的目的。并且由于在进行数据存储时，每一次的所述待写入数据仅被写入其中一个所述存储扇区内，因此，所述存储器件能够进行更多频次的数据擦写操作，从而使得所述存储器件具有更长的使用寿命。优选的，所述待写入数据包括：故障诊断数据、工作时间数据和系统状态数据。当进行故障诊断数据、工作时间数据或系统状态数据的写入时，所述写入指令与下一写入指令间具有一预设时间间隔。由此，所述存储器件只需在满足时间间隔的情况下进行下一次的数据读写，而不会频繁的进行数据的擦写更新，从而降低了所述存储器件的擦写频率，并因此提高了所述存储器件的使用寿命。在其中一种优选实施方式中，所述预设时间间隔为2小时，所述存储器件每天进行12次的故障诊断数据的更新操作。实施例二本实施例提供一种存储器件，包括采用上述任一项所述的数据存储方法进行数据读写。由于所述存储器件采用上述任一实施方式所述的数据存储方法，因此至少具有相同的有益效果，在此不再一一赘述。具体地，以具有2048字节存储空间的EEPROM为例对采用本发明提供的数据存储方法进行数据读写的存储器件进行说明。首先，将所述EEPROM划分为128个存储扇区，若按照每秒执行一次存储更新，一天工作6小时计算，一天需要进行21600次存储动作。所述未采用本发明提供的所述数据存储方法的存储器件的使用寿命为0.126839年。而本发明提供的所述存储器件的使用寿命将达到16.24年。相比于未采用本发明提供的所述数据存储方法的存储器件仅能进行100万次的擦写操作，本发明提供的划分为128个存储扇区后的所述存储器件，其使用寿命将提高128倍。实施例三本实施例提供一种高空车，所述高空车包括上述的存储器件。因此至少具有相同的有益效果，在此不再一一赘述。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。综上，本发明提供的数据存储方法，通过将所述存储器件的存储空间划分为具有不同读出优选级和写入优先级的存储扇区，并在每一次进行写入操作后，改变进行过写入操作的所述存储扇区的写入优先级。由此，当对所述存储器件进行下一次的数据读写时，所述待写入数据按照将所述存储扇区新的写入优先级而被分配到不同的扇区中进行存储，从而达到擦写均衡的目的。同时，由于在进行数据存储时，每一次的所述待写入数据仅被写入其中一个所述存储扇区内，因此，所述存储器件能够进行更多频次的数据擦写操作，从而使得所述存储器件具有更长的使用寿命。上述仅为本发明的优选实施例而已，并不对本发明起到任何限制作用。任何所属技术领域的技术人员，在不脱离本发明的技术方案的范围内，对本发明揭露的技术方案和技术内容做任何形式的等同替换或修改等变动，均属未脱离本发明的技术方案的内容，仍属于本发明的保护范围之内。
