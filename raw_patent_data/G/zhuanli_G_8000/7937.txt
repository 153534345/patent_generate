标题title
一种基于人工智能的目标物体地理坐标定位方法和装置
摘要abst
本发明适用于自然资源调查监测领域，提供一种基于人工智能的目标物体地理坐标定位方法和装置，所述方法包括：步骤S1、外业标定步骤；步骤S2、样本采集步骤；步骤S3、模型生成步骤；步骤S4、模型执行步骤。本发明通过采集摄像机水平方位角、垂直方位角、倍率、目标物体像素坐标与对应的标定地理坐标样本，迭代训练构建像素坐标与地理坐标转换模型，就可以计算出当前视野下画面上任意一像素点的地理坐标，从而对监测目标进行地理坐标定位，本发明相较于现有技术，减少了参数量、简化了作业流程、降低了安装难度和测量难度。
权利要求书clms
1.一种基于人工智能的目标物体地理坐标定位方法，其特征在于，所述方法包括下述步骤：步骤S1、外业标定步骤：在摄像机监测区域内布置外业标定点，每个点具有相应的地理坐标；步骤S2、样本采集步骤：通过样本采集工具预览摄像机画面，锁定外业标定点的地理坐标后，通过鼠标点击摄像机画面即可自动捕捉摄像机当前的水平方位角、垂直方位角、倍率、像素x坐标、像素y坐标，与锁定的地理坐标形成样本，进而完成样本采集；步骤S3、模型生成步骤：根据采集的样本，通过模型训练以及多次迭代，生成模型文件；步骤S4、模型执行步骤：获取摄像机当前的水平方位角、垂直方位角、倍率以及目标物体的像素坐标共五个参数，输入至模型，前向传播，计算得出该目标物体的真实地理坐标。2.如权利要求1所述基于人工智能的目标物体地理坐标定位方法，其特征在于，步骤S2中，所采集样本的样本格式为，式中，分别表示水平方位角、垂直方位角和倍率，分别表示屏幕坐标的像素x坐标和像素y坐标，分别表示地理坐标的x坐标和y坐标。3.如权利要求2所述基于人工智能的目标物体地理坐标定位方法，其特征在于，所述步骤S3具体过程如下：设置模型训练的神经元前向传播运算式以及激活函数；经过多级神经元运算后得到前向传播的结果以及平均损失函数；使用最小二乘法优化损失量，求最优解；使用链式求导法则更新权重；使用梯度下降法执行多次迭代，拟合后得到全局最优解，保存为模型文件。4.一种基于人工智能的目标物体地理坐标定位装置，其特征在于，所述装置包括：外业标定单元，用于在摄像机监测区域内布置外业标定点，每个点具有相应的地理坐标；样本采集单元，用于通过样本采集工具预览摄像机画面，锁定外业标定点的地理坐标后，通过鼠标点击摄像机画面即可自动捕捉摄像机当前的水平方位角、垂直方位角、倍率、像素x坐标、像素y坐标，与锁定的地理坐标形成样本，进而完成样本采集；模型生成单元：根据采集的样本，通过模型训练以及多次迭代，生成模型文件；模型执行单元，用于获取摄像机当前的水平方位角、垂直方位角、倍率以及目标物体的像素坐标共五个参数，输入至模型，前向传播，计算得出该目标物体的真实地理坐标。5.如权利要求4所述基于人工智能的目标物体地理坐标定位装置，其特征在于，所采集样本的样本格式为，式中，分别表示水平方位角、垂直方位角和倍率，分别表示屏幕坐标的像素x坐标和像素y坐标，分别表示地理坐标的x坐标和y坐标。6.如权利要求4所述基于人工智能的目标物体地理坐标定位装置，其特征在于，所述模型生成单元包括：设置模块，用于设置模型训练的神经元前向传播运算式以及激活函数；第一计算模块，用于经过多级神经元运算后得到前向传播的结果以及平均损失函数；第二计算模块，用于使用最小二乘法优化损失量，求最优解；权重更新模块，用于使用链式求导法则更新权重；迭代拟合模块，用于使用梯度下降法执行多次迭代，拟合后得到全局最优解，保存为模型文件。
说明书desc
技术领域本发明属于自然资源调查监测领域，尤其涉及一种基于人工智能的目标物体地理坐标定位方法和装置。背景技术随着自然资源调查监测行业的发展，人们对自然资源的监测要求日益提高，对于日常摄像机监测视频内容的需求，不再局限于视频画面，更需直接获取目标地物在真实世界的地理坐标。目前的技术方案是利用铁塔摄像机或视频杆来实时监控土地违法行为，在户外的铁塔和视频杆上一般都会设置监控摄像机，但是目前方案只能做到视频监控，无法实现目标物体的智能识别目标，更无法实现对目标物体进行准确地理定位，也无法做到实时预警和保护。为了解决此问题，公开号CN113223087B公开了一种基于视频监测的目标物体地理坐标定位技术，该专利阐述了一种像素坐标向大地坐标的转换方法，通过摄像机的大地坐标、高差、垂直方位角、水平方位角、垂直视野角和水平视野角，来解析监控对象像素坐标与大地坐标的映射关系，再根据方位角、像素坐标来计算地理坐标。此方法存在的问题的是构建映射关系的逻辑较为复杂，难以测量摄像机距地高差的准确值，且摄像机在空中难以调整至完全水平状态。另外，在具体应用时，会存在以下问题：计算参数多：须考虑摄像机X、Y、Z坐标、水平方位角、垂直方位角、水平视野角、垂直视野角，当摄像机安装未调平时，还需考虑俯仰角、侧倾角、翻转角等；逻辑复杂：一般实施人员难以掌握坐标映射关系；安装困难：在高空作业中，难以确保摄像机水平安装；测量困难：摄像机在空中，难以测量其距地高差。发明内容鉴于上述问题，本发明的目的在于提供一种基于人工智能的目标物体地理坐标定位方法和装置，旨在解决上述问题。本发明采用如下技术方案：一方面，所述基于人工智能的目标物体地理坐标定位方法，包括下述步骤：步骤S1、外业标定步骤：在摄像机监测区域内布置外业标定点，每个点具有相应的地理坐标；步骤S2、样本采集步骤：通过样本采集工具预览摄像机画面，锁定外业标定点的地理坐标后，通过鼠标点击摄像机画面即可自动捕捉摄像机当前的水平方位角、垂直方位角、倍率、像素x坐标、像素y坐标，与锁定的地理坐标形成样本，进而完成样本采集；步骤S3、模型生成步骤：根据采集的样本，通过模型训练以及多次迭代，生成模型文件；步骤S4、模型执行步骤：获取摄像机当前的水平方位角、垂直方位角、倍率以及目标物体的像素坐标共五个参数，输入至模型，前向传播，计算得出该目标物体的真实地理坐标。进一步的，步骤S2中，所采集样本的样本格式为，式中，分别表示水平方位角、垂直方位角和倍率，分别表示屏幕坐标的像素x坐标和像素y坐标，分别表示地理坐标的x坐标和y坐标。进一步的，所述步骤S3具体过程如下：设置模型训练的神经元前向传播运算式以及激活函数；经过多级神经元运算后得到前向传播的结果以及平均损失函数；使用最小二乘法优化损失量，求最优解；使用链式求导法则更新权重；使用梯度下降法执行多次迭代，拟合后得到全局最优解，保存为模型文件。另一方面，所述基于人工智能的目标物体地理坐标定位装置，其特征在于，所述装置包括：外业标定单元，用于在摄像机监测区域内布置外业标定点，每个点具有相应的地理坐标；样本采集单元，用于通过样本采集工具预览摄像机画面，锁定外业标定点的地理坐标后，通过鼠标点击摄像机画面即可自动捕捉摄像机当前的水平方位角、垂直方位角、倍率、像素x坐标、像素y坐标，与锁定的地理坐标形成样本，进而完成样本采集；模型生成单元：根据采集的样本，通过模型训练以及多次迭代，生成模型文件；模型执行单元，用于获取摄像机当前的水平方位角、垂直方位角、倍率以及目标物体的像素坐标共五个参数，输入至模型，前向传播，计算得出该目标物体的真实地理坐标。进一步的，所采集样本的样本格式为，式中，分别表示水平方位角、垂直方位角和倍率，分别表示屏幕坐标的像素x坐标和像素y坐标，分别表示地理坐标的x坐标和y坐标。进一步的，所述模型生成单元包括：设置模块，用于设置模型训练的神经元前向传播运算式以及激活函数；第一计算模块，用于经过多级神经元运算后得到前向传播的结果以及平均损失函数；第二计算模块，用于使用最小二乘法优化损失量，求最优解；权重更新模块，用于使用链式求导法则更新权重；迭代拟合模块，用于使用梯度下降法执行多次迭代，拟合后得到全局最优解，保存为模型文件。本发明的有益效果是：本发明采用人工智能技术，无需关心摄像机的X、Y、Z坐标和摄像机是否水平，在视频监控下，通过采集摄像机水平方位角、垂直方位角、倍率、目标物体像素坐标与对应的标定地理坐标样本，迭代训练构建像素坐标与地理坐标转换模型，就可以计算出当前视野下画面上任意一像素点的地理坐标，从而对监测目标进行地理坐标定位；因此本发明方法解决了现有技术中的问题，减少了参数量、简化了作业流程、降低了安装难度和测量难度。附图说明图1是本发明实施例提供的基于人工智能的目标物体地理坐标定位方法的流程图；图2是本发明实施例提供的基于人工智能的目标物体地理坐标定位装置的结构图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。为了说明本发明所述的技术方案，下面通过具体实施例来进行说明。实施例一：如图1所示，本实施例提供的基于人工智能的目标物体地理坐标定位方法，包括下述步骤：步骤S1、外业标定步骤：在摄像机监测区域内布置外业标定点，每个点具有相应的地理坐标。本步骤通过在摄像机监测区域内布置外业标定点，比如可以在区域内均匀布点，然后使用RTK测量标定点得到各外业标定点的地理坐标。RTK实时差分定位是一种能够在野外实时得到厘米级定位精度的测量方法，可极大提高了野外作业效率。本步骤的目的是得到各个外业标定点实际的地理坐标。步骤S2、样本采集步骤：通过样本采集工具预览摄像机画面，锁定外业标定点的地理坐标后，通过鼠标点击摄像机画面即可自动捕捉摄像机当前的水平方位角、垂直方位角、倍率、像素X坐标、像素Y坐标，与锁定的地理坐标形成样本，进而完成样本采集。通过样本采集工具可实时预览摄像机的画面，在画面中可以看到外业标定点。操作时，通过遥控器，可调整摄像机监测范围，也可以调整倍率，点击视频画面，可获取点击目标的像素坐标。当锁定某个外业标定点后，输入外业标定点的地理坐标，通过操作可以控制摄像机的方位角、倍率。摄像机调整后，然后鼠标点击摄像机画面即可自动捕捉摄像机当前的水平方位角、垂直方位角、倍率、像素x坐标、像素y坐标，与锁定的地理坐标形成样本。样本格式为，式中，分别表示水平方位角、垂直方位角和倍率，分别表示屏幕坐标的像素x坐标和像素y坐标，分别表示地理坐标的x坐标和y坐标。针对每个外业标定点，均可通过调整摄像机位于不同姿态，点击摄像机画面即可采集包含方位角、倍率、像素坐标和标定点地理坐标的样本。经过多次方位角调整、放大缩小倍率调整，即采集各个维度的样本。因此本步骤需要采集尽可能多的样本，以保证后续模型训练的准确度。步骤S3、模型生成步骤：根据采集的样本，通过模型训练以及多次迭代，生成模型文件。本发明通过标定制作样本，迭代训练的原理，快速建立像素坐标转换为地理坐标的计算模型。具体过程如下：S31、设置模型训练的神经元前向传播运算式以及激活函数。模型训练的神经元前向传播运算式如下：公式简化如下：式中，分别表示水平方位角、垂直方位角和倍率，分别表示屏幕坐标的像素x坐标和像素y坐标，表示权重，表示偏置量。激活函数使用sigmoid函数：式中，t表示神经元运算后的矩阵，表示激活后的矩阵。S32、经过多级神经元运算后得到前向传播的结果以及平均损失函数。经过多级神经元运算后，得到前向传播的结果为，设样本实际地理坐标为，得到平均损失函数：式中，m表示样本数量，i表示样本序号，分别代表预测值和真实值。S33、使用最小二乘法优化损失量，求最优解。求解最优解公式如下：式中，表示训练的损失量，表示样本真实坐标值，表示训练预测值。S34、使用链式求导法则更新权重。使用链式求导法则更新权重，公式如下：式中，表示训练的损失量，表示第i个神经元第j个权重值，表示第i个神经元运算时第j个样本值。S35、使用梯度下降法执行多次迭代，拟合后得到全局最优解，保存为模型文件。梯度下降法是一个一阶最优化算法。使用梯度下降法找到一个函数的局部极小值，必须向函数上当前点对应梯度的反方向的规定步长距离点进行迭代搜索。具体过程本步骤不再赘述。步骤S4、模型执行步骤：获取摄像机当前的水平方位角、垂直方位角、倍率以及目标物体的像素坐标共五个参数，输入至模型，前向传播，计算得出该目标物体的真实地理坐标。前述步骤S1-S3实现了通过训练建立一个像素坐标转换为地理坐标的计算模型。当实际应用时，根据该计算模型即可得到画面中各目标物体的实际地理坐标。具体的，首先通过调用摄像机的SDK，就可以获取摄像机当前的水平方位角、垂直方位角和倍率，为。然后从摄像机的成像画面中，可直接获取所需目标物体的像素坐标；最后将前水平方位角、垂直方位角、倍率和目标物体的像素坐标5个参数输入至模型，前向传播计算得出该目标物体的真实地理坐标。前向传播计算以及激活函数使用与前述步骤S3模型生成步骤一致。本实施例方法相较于现有方法，存在如下优势：减少了参数数量。实施过程无需关心摄像机的具体坐标和高程，减少了对应的参数。简化了流程。实施过程中，只需在摄像机监测区域标定部分特征地物坐标，在内业点击摄像机画面，即可采集样本，实施人员无需掌握复杂的数学知识即可开展工作。降低了安装难度。计算过程无需关心摄像机的俯仰、侧倾、旋转姿态，只需考虑摄像机是否能覆盖监测范围即可。 降低了测量难度。现有方法须计算摄像机高程，但摄像机一般安装在40米高空中，测量难度大，此方法计算过程无需关心摄像机的高程参数，无需高程测量即可完成坐标转换。实施例二：如图2所示，本实施例提供的基于人工智能的目标物体地理坐标定位装置，包括：外业标定单元1，用于在摄像机监测区域内布置外业标定点，每个点具有相应的地理坐标；样本采集单元2，用于通过样本采集工具预览摄像机画面，锁定外业标定点的地理坐标后，通过鼠标点击摄像机画面即可自动捕捉摄像机当前的水平方位角、垂直方位角、倍率、像素x坐标、像素y坐标，与锁定的地理坐标形成样本，进而完成样本采集；模型生成单元3：根据采集的样本，通过模型训练以及多次迭代，生成模型文件；模型执行单元4，用于获取摄像机当前的水平方位角、垂直方位角、倍率以及目标物体的像素坐标共五个参数，输入至模型，前向传播，计算得出该目标物体的真实地理坐标。所采集样本的样本格式为，式中，分别表示水平方位角、垂直方位角和倍率，分别表示屏幕坐标的像素x坐标和像素y坐标，分别表示地理坐标的x坐标和y坐标。本实施例各个功能单元对于实现了实施例一中的步骤S1-S4，通过外业标定单元进行坐标标定，然后通过样本采集单元采集样本，接着根据模型生成单元生成模型文件，最后通过模型执行单元完成目标物体的真实地理坐标计算。具体过程本实施例不再赘述。作为一种优选结构，所述模型生成单元4包括：设置模块，用于设置模型训练的神经元前向传播运算式以及激活函数；第一计算模块，用于经过多级神经元运算后得到前向传播的结果以及平均损失函数；第二计算模块，用于使用最小二乘法优化损失量，求最优解；权重更新模块，用于使用链式求导法则更新权重；迭代拟合模块，用于使用梯度下降法执行多次迭代，拟合后得到全局最优解，保存为模型文件。综上，本发明实施过程简单，实施人员无需掌握复杂的数学运算方法，通过点击视频画面的方法即可自动采集样本进行训练，即可简单、快速地构建像素坐标向地理坐标转换的关系。此外，本发明采用的人工智能技术模型无需关注摄像机的位置、高程，可以避免复杂的高程测量工作，从而降低了测量难度，又因模型无需关注摄像机的俯仰角、侧倾角和俯仰角，故而在安装时不必担心摄像机是否调平，从而降低了安装难度。因此，本发明在实施、测量、安装流程实现简化，使得本发明更易于工业应用。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
