标题title
基于红外图像的机油散热器检测方法
摘要abst
本发明涉及图像数据处理领域，具体涉及一种基于红外图像的机油散热器检测方法，包括：获取发动机区域红外灰度图；对灰度图进行滑窗，利用起始点对应的滑窗内像素点灰度值的方差得到每个像素点对应的滑窗；获取去噪后的灰度图：当像素点对应的滑窗未填满时，将滑窗内像素点的灰度值均值作为像素点去噪后的灰度值；当像素点对应的滑窗被填满时，且滑窗内有热传导方向线段时，利用滑窗内像素点灰度值的方差对像素点进行去噪；当滑窗内无热传导方向线段时，利用滑窗内正常像素点的灰度值对像素点进行去噪；对去噪后的灰度图进行阈值分割，利用得到的高温区域对机油散热器进行检测。上述方法用于检测机油散热器的散热效果，可提高检测准确度。
权利要求书clms
1.一种基于红外图像的机油散热器检测方法，其特征在于，包括：S1：获取汽车发动机区域红外灰度图；S2：得到灰度图中每个像素点对应的滑窗窗口：S201：设置滑窗，对灰度图进行滑窗遍历，利用起始点对应的滑窗窗口内所有像素点灰度值的方差得到第二个滑窗遍历的像素点对应的滑窗窗口；S202：利用第二个滑窗遍历的像素点对应的滑窗窗口内所有像素点灰度值的方差得到第三个滑窗遍历的像素点对应的滑窗窗口，依此类推，得到灰度图中每个像素点对应的滑窗窗口；S3：利用灰度图中每个像素点对应的滑窗窗口对灰度图进行去噪，获取去噪后的灰度图：S301：当每个像素点对应的滑窗窗口未被填充满时，则将该像素点对应的滑窗窗口内所有像素点的灰度值均值作为该像素点去噪后的灰度值；S302：当每个像素点对应的滑窗窗口被填充满时，则对该像素点对应的滑窗窗口内是否含有热传导方向线段进行判断：当该像素点对应的滑窗窗口内含有热传导方向线段时，则利用该像素点对应的滑窗窗口内所有像素点灰度值的方差对该像素点进行去噪；当该像素点对应的滑窗窗口内无热传导方向线段时，则利用该像素点对应的滑窗窗口内的正常像素点的灰度值对该像素点进行去噪；S4：对去噪后的灰度图进行阈值分割，获取去噪后的灰度图中的高温区域；S5：利用高温区域中所有像素点的灰度值均值对机油散热器的散热效果进行检测。2.根据权利要求1所述的一种基于红外图像的机油散热器检测方法，其特征在于，所述灰度图中每个像素点对应的滑窗窗口是按照如下方式得到：利用大津算法将汽车发动机区域红外灰度图分为高温区域和背景区域；分别计算高温区域和背景区域中所有像素点灰度值的方差，将两个方差中的最大值作为方差阈值；设置方形滑窗，该方形滑窗的尺寸为，且以汽车发动机区域红外灰度图中每个像素点为滑窗中心点；所述h的取值范围为正整数；将汽车发动机区域红外灰度图的左上角像素点作为起始点，利用方形滑窗对汽车发动机区域红外灰度图进行滑窗遍历，得到起始点对应的滑窗窗口；计算起始点对应的滑窗窗口内所有像素点灰度值的方差；利用方差阈值对起始点对应的滑窗窗口内所有像素点灰度值的方差进行判断：当起始点对应的滑窗窗口内所有像素点灰度值的方差小于方差阈值时，则将起始点对应的滑窗窗口的尺寸扩大为，得到扩大后的起始点对应的滑窗窗口，将扩大后的起始点对应的滑窗窗口作为第二个滑窗遍历的像素点对应的滑窗窗口；当起始点对应的滑窗窗口内所有像素点灰度值的方差大于等于方差阈值时，则将起始点对应的滑窗窗口的尺寸缩小为，得到缩小后的起始点对应的滑窗窗口，将缩小后的起始点对应的滑窗窗口作为第二个滑窗遍历的像素点对应的滑窗窗口；按照得到第二个滑窗遍历的像素点对应的滑窗窗口得到第三个滑窗遍历的像素点对应的滑窗窗口，依此类推，得到汽车发动机区域红外灰度图中每个像素点对应的滑窗窗口。3.根据权利要求1所述的一种基于红外图像的机油散热器检测方法，其特征在于，所述对该像素点对应的滑窗窗口内是否含有热传导方向线段进行判断的过程如下：获取每个像素点对应的滑窗窗口内中间行像素点的灰度值，从左至右依次计算相邻两像素点的灰度值差值，将大于0的灰度值差值标记为1，小于0的灰度值差值标记为-1，等于0的灰度值差值不做标记，得到中间行像素点灰度值差值序列；对中间行像素点灰度值差值序列进行判断：当中间行像素点灰度值差值序列只有1时，则说明中间行有热传导方向线段，且热传导方向线段为从左至右；当中间行像素点灰度值差值序列只有-1时，则说明中间行有热传导方向线段，且热传导方向线段为从右至左；当中间行像素点灰度值差值序列既有1又有-1时，则说明中间行没有热传导方向线段；按照对中间行是否含有热传导方向线段的判断方法对每个像素点对应的滑窗窗口内的中间列、两对角线上是否含有热传导方向线段进行判断；根据每个像素点对应的滑窗窗口内的中间行、中间列、两对角线上是否含有热传导方向线段对每个像素点对应的滑窗窗口进行判断：当中间行、中间列、两对角线上存在热传导方向线段时，则说明该像素点对应的滑窗窗口内含有热传导方向线段；当中间行、中间列、两对角线上均没有热传导方向线段时，则说明该像素点对应的滑窗窗口内无热传导方向线段。4.根据权利要求1所述的一种基于红外图像的机油散热器检测方法，其特征在于，所述利用该像素点对应的滑窗窗口内所有像素点灰度值的方差对该像素点进行去噪的过程具体如下：当像素点对应的滑窗窗口内含有热传导方向线段时，计算该像素点对应的滑窗窗口内所有像素点灰度值的方差；对像素点对应的滑窗窗口内所有像素点灰度值的方差进行判断：当像素点对应的滑窗窗口内所有像素点灰度值的方差小于方差阈值时，则计算该像素点对应的滑窗窗口内热传导方向线段上所有像素点的灰度值均值，将该像素点对应的滑窗窗口内热传导方向线段上所有像素点的灰度值均值作为该像素点去噪后的灰度值；当像素点对应的滑窗窗口内所有像素点灰度值的方差大于等于方差阈值时，则进行如下操作：获取该像素点对应的滑窗窗口内热传导方向线段上相邻两像素点的灰度值差值的最大值，将灰度值差值的最大值对应的相邻两像素点之间进行断开，将热传导方向线段分为两条分线段；获取该像素点所在的热传导方向线段分线段，计算该像素点所在的热传导方向线段分线段上所有像素点的灰度值均值，将该像素点所在的热传导方向线段分线段上所有像素点的灰度值均值作为该像素点去噪后的灰度值。5.根据权利要求1所述的一种基于红外图像的机油散热器检测方法，其特征在于，所述该像素点对应的滑窗窗口内的正常像素点是按照如下方式获取：计算每个像素点对应的滑窗窗口内所有像素点的灰度值均值，将滑窗窗口内灰度值异于灰度值均值的像素点进行去除，得到剩余像素点；获取每个剩余像素点在滑窗窗口内的八邻域像素点，将灰度值小于该剩余像素点灰度值的八邻域像素点作为第一像素点；将剩余像素点指向第一像素点的方向作为向量方向，将剩余像素点和第一像素点的灰度值差值作为向量值，得到每个剩余像素点的所有第一热传导向量；对每个剩余像素点的所有第一热传导向量进行求和，获取每个剩余像素点的热传导向量；计算每个剩余像素点的热传导向量与其他剩余像素点的热传导向量的夹角的和；计算所有剩余像素点的热传导向量与其他剩余像素点的热传导向量的夹角和的均值，将该均值作为夹角和阈值；将热传导向量与其他剩余像素点的热传导向量的夹角的和小于等于夹角和阈值的剩余像素点作为滑窗窗口内的正常像素点，获取滑窗窗口内的所有正常像素点。6.根据权利要求1所述的一种基于红外图像的机油散热器检测方法，其特征在于，所述利用该像素点对应的滑窗窗口内的正常像素点的灰度值对该像素点进行去噪的过程具体如下：当像素点对应的滑窗窗口内无热传导方向线段时，计算该像素点对应的滑窗窗口内所有像素点灰度值的方差；对像素点对应的滑窗窗口内所有像素点灰度值的方差进行判断：当该像素点对应的滑窗窗口内所有像素点灰度值的方差小于方差阈值时，则将该像素点对应的滑窗窗口内的所有正常像素点的灰度值均值作为该像素点去噪后的灰度值；当该像素点对应的滑窗窗口内所有像素点灰度值的方差大于等于方差阈值时，则进行如下步骤：将该像素点对应的滑窗窗口内的所有正常像素点的灰度值按照从大到小的方式进行排序，得到正常像素点灰度值序列；依次计算正常像素点灰度值序列中两两相邻像素点的灰度值差值，得到正常像素点灰度值差值序列；将正常像素点灰度值差值序列中最大值对应的相邻两像素点进行断开，将正常像素点灰度值序列分为高温序列和背景序列；对高温序列和背景序列中灰度值的数量进行判断：当高温序列中灰度值的数量大于等于背景序列中灰度值的数量时，则将高温序列中所有灰度值的均值作为该像素点去噪后的灰度值；当高温序列中灰度值的数量小于背景序列中灰度值的数量时，则将背景序列中所有灰度值的均值作为该像素点去噪后的灰度值。7.根据权利要求1所述的一种基于红外图像的机油散热器检测方法，其特征在于，所述对机油散热器的散热效果进行检测的过程具体如下：利用大津算法对去噪后的汽车发动机区域红外灰度图进行阈值分割，获取去噪后的灰度图中的高温区域，将去噪后的汽车发动机区域红外灰度图中的高温区域作为待测高温区域；按照获取待测高温区域的方法获取机油散热器存在故障时的汽车发动机区域红外灰度图中的高温区域，将机油散热器存在故障时的汽车发动机区域红外灰度图中的高温区域作为对比高温区域；计算对比高温区域中所有像素点的灰度值均值，将灰度值均值作为该对比高温区域的第一灰度值；将所有对比高温区域的第一灰度值的均值作为灰度值阈值，对待测高温区域进行判断：当待测高温区域中所有像素点的灰度值均值大于灰度值阈值时，则说明机油散热器存在故障。8.根据权利要求1所述的一种基于红外图像的机油散热器检测方法，其特征在于，所述汽车发动机区域红外灰度图是按照如下方式获取：采集工作状态下的汽车发动机红外图像；对汽车发动机红外图像进行语义分割，得到汽车发动机区域的红外图像；对汽车发动机区域的红外图像进行灰度化处理，获取汽车发动机区域红外灰度图。
说明书desc
技术领域本发明涉及图像数据处理领域，具体涉及一种基于红外图像的机油散热器检测方法。背景技术机油散热器又称油冷器，用于汽车发动机的机油冷却。机油散热器良好的散热效果对于提高设备或装置的工作效率、保障设备安全有着至关重要的作用。因此，对机油散热器的散热效果进行检测是很有必要的。目前，对机油散热器的散热效果进行检测的方法主要为热红外技术：首先采集工作状态下的汽车发动机的红外图像，然后对红外图像进行去噪处理，对去噪后的红外图像进行阈值分割，得到红外图像中的高温区域，最后根据高温区域对机油散热器的散热效果进行判断。然而，目前对机油散热器的散热效果进行检测时，主要采用空域法和频域法的去噪方法对红外图像进行去噪处理，这些去噪方法是对红外图像中所有像素点进行同样的去噪处理，会造成边缘细节丧失过多，使得去噪后的红外图像边缘模糊，容易导致阈值分割不准确，降低机油散热器的散热效果检测的准确性。发明内容本发明提供一种基于红外图像的机油散热器检测方法，以解决现有的机油散热器检测方法准确度低的问题。为达到上述目的，本发明采用如下技术方案，一种基于红外图像的机油散热器检测方法，包括：S1：获取汽车发动机区域红外灰度图；S2：得到灰度图中每个像素点对应的滑窗窗口：S201：设置滑窗，对灰度图进行滑窗遍历，利用起始点对应的滑窗窗口内所有像素点灰度值的方差得到第二个滑窗遍历的像素点对应的滑窗窗口；S202：利用第二个滑窗遍历的像素点对应的滑窗窗口内所有像素点灰度值的方差得到第三个滑窗遍历的像素点对应的滑窗窗口，依此类推，得到灰度图中每个像素点对应的滑窗窗口；S3：利用灰度图中每个像素点对应的滑窗窗口对灰度图进行去噪，获取去噪后的灰度图：S301：当每个像素点对应的滑窗窗口未被填充满时，则将该像素点对应的滑窗窗口内所有像素点的灰度值均值作为该像素点去噪后的灰度值；S302：当每个像素点对应的滑窗窗口被填充满时，则对该像素点对应的滑窗窗口内是否含有热传导方向线段进行判断：当该像素点对应的滑窗窗口内含有热传导方向线段时，则利用该像素点对应的滑窗窗口内所有像素点灰度值的方差对该像素点进行去噪；当该像素点对应的滑窗窗口内无热传导方向线段时，则利用该像素点对应的滑窗窗口内的正常像素点的灰度值对该像素点进行去噪；S4：对去噪后的灰度图进行阈值分割，获取去噪后的灰度图中的高温区域；S5：利用高温区域中所有像素点的灰度值均值对机油散热器的散热效果进行检测。所述一种基于红外图像的机油散热器检测方法，所述灰度图中每个像素点对应的滑窗窗口是按照如下方式得到：利用大津算法将汽车发动机区域红外灰度图分为高温区域和背景区域；分别计算高温区域和背景区域中所有像素点灰度值的方差，将两个方差中的最大值作为方差阈值；设置方形滑窗，该方形滑窗的尺寸为，且以汽车发动机区域红外灰度图中每个像素点为滑窗中心点；所述h的取值范围为正整数；将汽车发动机区域红外灰度图的左上角像素点作为起始点，利用方形滑窗对汽车发动机区域红外灰度图进行滑窗遍历，得到起始点对应的滑窗窗口；计算起始点对应的滑窗窗口内所有像素点灰度值的方差；利用方差阈值对起始点对应的滑窗窗口内所有像素点灰度值的方差进行判断：当起始点对应的滑窗窗口内所有像素点灰度值的方差小于方差阈值时，则将起始点对应的滑窗窗口的尺寸扩大为，得到扩大后的起始点对应的滑窗窗口，将扩大后的起始点对应的滑窗窗口作为第二个滑窗遍历的像素点对应的滑窗窗口；当起始点对应的滑窗窗口内所有像素点灰度值的方差大于等于方差阈值时，则将起始点对应的滑窗窗口的尺寸缩小为，得到缩小后的起始点对应的滑窗窗口，将缩小后的起始点对应的滑窗窗口作为第二个滑窗遍历的像素点对应的滑窗窗口；按照得到第二个滑窗遍历的像素点对应的滑窗窗口得到第三个滑窗遍历的像素点对应的滑窗窗口，依此类推，得到汽车发动机区域红外灰度图中每个像素点对应的滑窗窗口。所述一种基于红外图像的机油散热器检测方法，所述对该像素点对应的滑窗窗口内是否含有热传导方向线段进行判断的过程如下：获取每个像素点对应的滑窗窗口内中间行像素点的灰度值，从左至右依次计算相邻两像素点的灰度值差值，将大于0的灰度值差值标记为1，小于0的灰度值差值标记为-1，等于0的灰度值差值不做标记，得到中间行像素点灰度值差值序列；对中间行像素点灰度值差值序列进行判断：当中间行像素点灰度值差值序列只有1时，则说明中间行有热传导方向线段，且热传导方向线段为从左至右；当中间行像素点灰度值差值序列只有-1时，则说明中间行有热传导方向线段，且热传导方向线段为从右至左；当中间行像素点灰度值差值序列既有1又有-1时，则说明中间行没有热传导方向线段；按照对中间行是否含有热传导方向线段的判断方法对每个像素点对应的滑窗窗口内的中间列、两对角线上是否含有热传导方向线段进行判断；根据每个像素点对应的滑窗窗口内的中间行、中间列、两对角线上是否含有热传导方向线段对每个像素点对应的滑窗窗口进行判断：当中间行、中间列、两对角线上存在热传导方向线段时，则说明该像素点对应的滑窗窗口内含有热传导方向线段；当中间行、中间列、两对角线上均没有热传导方向线段时，则说明该像素点对应的滑窗窗口内无热传导方向线段。所述一种基于红外图像的机油散热器检测方法，所述利用该像素点对应的滑窗窗口内所有像素点灰度值的方差对该像素点进行去噪的过程具体如下：当像素点对应的滑窗窗口内含有热传导方向线段时，计算该像素点对应的滑窗窗口内所有像素点灰度值的方差；对像素点对应的滑窗窗口内所有像素点灰度值的方差进行判断：当像素点对应的滑窗窗口内所有像素点灰度值的方差小于方差阈值时，则计算该像素点对应的滑窗窗口内热传导方向线段上所有像素点的灰度值均值，将该像素点对应的滑窗窗口内热传导方向线段上所有像素点的灰度值均值作为该像素点去噪后的灰度值；当像素点对应的滑窗窗口内所有像素点灰度值的方差大于等于方差阈值时，则进行如下操作：获取该像素点对应的滑窗窗口内热传导方向线段上相邻两像素点的灰度值差值的最大值，将灰度值差值的最大值对应的相邻两像素点之间进行断开，将热传导方向线段分为两条分线段；获取该像素点所在的热传导方向线段分线段，计算该像素点所在的热传导方向线段分线段上所有像素点的灰度值均值，将该像素点所在的热传导方向线段分线段上所有像素点的灰度值均值作为该像素点去噪后的灰度值。所述一种基于红外图像的机油散热器检测方法，所述该像素点对应的滑窗窗口内的正常像素点是按照如下方式获取：计算每个像素点对应的滑窗窗口内所有像素点的灰度值均值，将滑窗窗口内灰度值异于灰度值均值的像素点进行去除，得到剩余像素点；获取每个剩余像素点在滑窗窗口内的八邻域像素点，将灰度值小于该剩余像素点灰度值的八邻域像素点作为第一像素点；将剩余像素点指向第一像素点的方向作为向量方向，将剩余像素点和第一像素点的灰度值差值作为向量值，得到每个剩余像素点的所有第一热传导向量；对每个剩余像素点的所有第一热传导向量进行求和，获取每个剩余像素点的热传导向量；计算每个剩余像素点的热传导向量与其他剩余像素点的热传导向量的夹角的和；计算所有剩余像素点的热传导向量与其他剩余像素点的热传导向量的夹角和的均值，将该均值作为夹角和阈值；将热传导向量与其他剩余像素点的热传导向量的夹角的和小于等于夹角和阈值的剩余像素点作为滑窗窗口内的正常像素点，获取滑窗窗口内的所有正常像素点。所述一种基于红外图像的机油散热器检测方法，所述利用该像素点对应的滑窗窗口内的正常像素点的灰度值对该像素点进行去噪的过程具体如下：当像素点对应的滑窗窗口内无热传导方向线段时，计算该像素点对应的滑窗窗口内所有像素点灰度值的方差；对像素点对应的滑窗窗口内所有像素点灰度值的方差进行判断：当该像素点对应的滑窗窗口内所有像素点灰度值的方差小于方差阈值时，则将该像素点对应的滑窗窗口内的所有正常像素点的灰度值均值作为该像素点去噪后的灰度值；当该像素点对应的滑窗窗口内所有像素点灰度值的方差大于等于方差阈值时，则进行如下步骤：将该像素点对应的滑窗窗口内的所有正常像素点的灰度值按照从大到小的方式进行排序，得到正常像素点灰度值序列；依次计算正常像素点灰度值序列中两两相邻像素点的灰度值差值，得到正常像素点灰度值差值序列；将正常像素点灰度值差值序列中最大值对应的相邻两像素点进行断开，将正常像素点灰度值序列分为高温序列和背景序列；对高温序列和背景序列中灰度值的数量进行判断：当高温序列中灰度值的数量大于等于背景序列中灰度值的数量时，则将高温序列中所有灰度值的均值作为该像素点去噪后的灰度值；当高温序列中灰度值的数量小于背景序列中灰度值的数量时，则将背景序列中所有灰度值的均值作为该像素点去噪后的灰度值。所述一种基于红外图像的机油散热器检测方法，所述对机油散热器的散热效果进行检测的过程具体如下：利用大津算法对去噪后的汽车发动机区域红外灰度图进行阈值分割，获取去噪后的灰度图中的高温区域，将去噪后的汽车发动机区域红外灰度图中的高温区域作为待测高温区域；按照获取待测高温区域的方法获取机油散热器存在故障时的汽车发动机区域红外灰度图中的高温区域，将机油散热器存在故障时的汽车发动机区域红外灰度图中的高温区域作为对比高温区域；计算对比高温区域中所有像素点的灰度值均值，将灰度值均值作为该对比高温区域的第一灰度值；将所有对比高温区域的第一灰度值的均值作为灰度值阈值，对待测高温区域进行判断：当待测高温区域中所有像素点的灰度值均值大于灰度值阈值时，则说明机油散热器存在故障。所述一种基于红外图像的机油散热器检测方法，所述汽车发动机区域红外灰度图是按照如下方式获取：采集工作状态下的汽车发动机红外图像；对汽车发动机红外图像进行语义分割，得到汽车发动机区域的红外图像；对汽车发动机区域的红外图像进行灰度化处理，获取汽车发动机区域红外灰度图。本发明的有益效果是：本发明对汽车发动机区域红外灰度图进行滑窗遍历，利用起始点对应的滑窗窗口内所有像素点灰度值的方差依次得到灰度图中每个像素点对应的滑窗窗口，通过得到汽车发动机区域红外灰度图中每个像素点的自适应滤波窗口，防止窗口尺寸过大或者过小，可以有效提高像素点去噪的效果。根据灰度图中每个像素点对应的滑窗窗口的特征，将灰度图中的像素点分为不同类型，对不同类型的像素点采用不同的去噪处理方法，可以在保护红外图像边缘的同时，提高红外图像的去噪效果。本发明通过提高红外图像的去噪效果来提高红外图像阈值分割的准确度，进而提高机油散热器的散热效果检测的准确性。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的一种基于红外图像的机油散热器检测方法流程示意图；图2为本发明实施例提供的一种基于红外图像的机油散热器检测方法中S2的流程示意图；图3为本发明实施例提供的一种基于红外图像的机油散热器检测方法中S3的流程示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的主要目的是：利用计算机视觉技术处理采集的发动机红外图像，设计自适应滤波窗口尺寸，对不同的窗口使用不同的方式进行去噪处理，实现发动机红外图像的去噪处理。最后阈值分割发动机红外图像中的高温区域，判断机油散热器是否出现故障。由于采集的发动机红外图像具有较高的噪声，现有的去噪方式没有考虑到图像的结构信息，会使图像的细节丧失过多，在去噪的同时造成图像过于模糊，影响后续故障检测的准确性。因此，本发明提供一种基于红外图像的机油散热器检测方法，用于提高红外图像的去噪效果来提高红外图像阈值分割的准确度，进而提高机油散热器的散热效果检测的准确性。本发明的一种基于红外图像的机油散热器检测方法的实施例，如图1所示，包括：S1：获取汽车发动机区域红外灰度图。本实施例需要发动机区域的红外图像，对图像进行去噪处理，阈值分割出高温区域，判断机油散热器是否有故障。所以需要利用红外热像仪采集汽车发电机红外图像，然后识别出图像中发动机的特征信息。本实施例采用DNN语义分割的方式来识别分割红外图像中的目标。该DNN网络的相关内容如下：使用的数据集为红外热成像仪采集的工作状态下的汽车发动机红外图像数据集。需要分割的像素点，共分为2类，即训练集对应标签标注过程为：单通道的语义标签，对应位置像素点属于背景类的标注为0，属于发动机区域的标注为1。网络的任务是分类，所以使用的loss函数为交叉熵损失函数。至此，通过DNN实现了汽车发动机红外图像的处理，获得汽车发动机区域的红外图像。对汽车发动机区域的红外图像进行灰度化处理，获取汽车发动机区域红外灰度图。S2：得到灰度图中每个像素点对应的滑窗窗口。需要说明的是：滤波窗口尺寸过大会造成图像边缘模糊，窗口尺寸过小会影响去噪效果。本实施例通过像素点灰度值的方差，设计了一种自适应尺寸的滤波窗口，然后对不同的窗口使用不同的方式进行去噪处理，保护图像边缘的同时，提高去噪效果，实现发动机红外图像的去噪处理。得到灰度图中每个像素点对应的滑窗窗口的过程如图2所示。S201：设置滑窗，对灰度图进行滑窗遍历，利用起始点对应的滑窗窗口内所有像素点灰度值的方差得到第二个滑窗遍历的像素点对应的滑窗窗口。大津算法的原理是将图像分为两类，使其类内方差最小，类间方差最大，获取最佳分割阈值。首先获取汽车发动机区域红外灰度图的灰度直方图，利用大津算法求取最佳分割阈值，将汽车发动机区域红外灰度图粗略的分为两类区域，分别为灰度值大于分割阈值的高温区域和灰度值小于分割阈值的背景区域。计算高温区域中所有像素点灰度值的方差和背景区域中所有像素点灰度值的方差，取两者的最大值为方差阈值。然后设计一个方形滑窗，其尺寸为奇数，尺寸为。以发动机红外图像的左上角像素点为起始点，从左至右，从上至下，逐像素点遍历。若遍历像素点处于图像边缘处，则只分析窗口内含有的图像像素点。方形窗口在逐像素点滑动时，后一个窗口内的像素点相较于其前一个窗口内的像素点，其最左侧列去除，最右侧列新增加一列。因此当方形窗口向灰度值均匀的类内区域滑动时，应扩大窗口，使其较好的抑制噪声、平滑同类区域。当方形窗口向灰度值不均匀的类间区域，即边缘区域滑动时，应缩小窗口，保护图像边缘。在本实施例中，窗口尺寸中h的取值范围为{1,2,3,4,5}。令起始像素点的窗口尺寸为，此时h为3，计算该窗口内的所有像素点灰度值的方差V。若V小于方差阈值时，说明该区域像素点为同一类像素点，其灰度值均匀，因此令下一个遍历像素点的窗口扩大，尺寸为，即令h’=h+1。其中h’的最大值为5，当h’=5时，窗口不再增大。若V大于等于方差阈值时，说明该区域像素点为两类像素点，其灰度值不均匀，因此令下一个遍历像素点的窗口缩小，尺寸为，即令=h-1。其中的最小值为1，当=1时，窗口不再减小。由此获取第二个遍历像素点的窗口尺寸，计算该窗口内的所有像素点灰度值的方差。S202：利用第二个滑窗遍历的像素点对应的滑窗窗口内所有像素点灰度值的方差得到第三个滑窗遍历的像素点对应的滑窗窗口，依此类推，得到灰度图中每个像素点对应的滑窗窗口。按照获取第二个遍历像素点的窗口尺寸的方法获取第三个遍历像素点的窗口尺寸，依此类推，获取汽车发动机区域红外灰度图中每个像素点对应的窗口尺寸。至此完成了滤波窗口尺寸的自适应选取。S3：利用灰度图中每个像素点对应的滑窗窗口对灰度图进行去噪，获取去噪后的灰度图。需要说明的是，红外图像是利用红外热像仪接收来自目标和景物的红外辐射，经过光电转换，将不可见的辐射转变成可见的图像，图像中各像素点的明暗变化对应着目标和景物的辐射能量强弱的变化。因此红外图像中从辐射能量强的高温区域至辐射能量弱的低温区域，其亮度由明至暗，其在灰度图上的表现为像素点的灰度值由大至小，即为灰度图中存在热传导方向线段。利用灰度图中每个像素点对应的滑窗窗口对灰度图进行去噪的过程如图3所示。S301：当每个像素点对应的滑窗窗口未被填充满时，则将该像素点对应的滑窗窗口内所有像素点的灰度值均值作为该像素点去噪后的灰度值。若自适应尺寸的窗口内未被发动机红外图像的像素点填充满，即窗口中心像素点在发动机红外图像的轮廓边缘处，根据热传导的特性，图像轮廓边缘处不可能含有高温区域，故此时中心像素点的灰度值由窗口内所有像素点的灰度值均值替换。S302：当每个像素点对应的滑窗窗口被填充满时，则对该像素点对应的滑窗窗口内是否含有热传导方向线段进行判断：当该像素点对应的滑窗窗口内含有热传导方向线段时，则利用该像素点对应的滑窗窗口内所有像素点灰度值的方差对该像素点进行去噪。若自适应尺寸的窗口完全处于发动机红外图像内，取任意滤波窗口为例。先分析窗口内中间行的相邻像素点的灰度值，从左至右依次求取相邻两像素点的灰度值差值，记差值为正的标记为1，差值为负的标记为-1，差值为0的不做标记，获得如下序列：当序列中只有1时，说明窗口内中间行热传导方向线段为从左至右，当序列中只有-1时，说明窗口内中间行热传导方向线段为从右至左，当序列中有1和-1时，说明窗口内中间行无热传导方向线段。同理判断该窗口内的中间列和两对角线上有无热传导方向线段。若该窗口内的中间行、列和两对角线，这四条线段中任意线段上有热传导方向线段，则说明该窗口内无噪声点或者噪声点不在热传导的方向线段上。再对窗口内所有像素点灰度值的方差V进行分析：若V小于方差阈值时，说明该窗口内像素点为同一类像素点，其像素点灰度值相对均匀，当只有一条热传导方向线段，计算线段上所有像素点的灰度值均值，以该均值替换窗口内中心像素点的灰度值。当有多条热传导方向线段，分别计算线段上所有像素点的灰度值均值，再求取均值进行替换。用以较好的对类内区域进行平滑去噪。若V大于等于方差阈值时，说明该窗口内含有两类像素点，其像素点灰度值不均匀，即窗口内含有边缘。当只有一条热传导方向线段，则按照热传导方向线段依次计算相邻两像素点的灰度值差值，从最大差值处将该线段分开，判断该窗口内中心像素点处于前段，还是处于后段。计算该窗口内中心像素点所处线段上的所有像素点的灰度值均值，以此替换该窗口中心像素点的灰度值。当有多条热传导方向线段，则同理分别计算灰度值均值，再求取均值进行替换。用以去噪的同时，保护类间边缘。当像素点对应的滑窗窗口内无热传导方向线段时，则利用该像素点对应的滑窗窗口内的正常像素点的灰度值对该像素点进行去噪。若窗口内的中间行、列和两对角线，这四条线段中无热传导方向线段。则说明该窗口内必含有噪声点，且噪声点为中心像素点或者噪声点在热传导方向线段上。再对窗口内所有像素点灰度值的方差V进行分析：若V小于方差阈值时，说明该窗口内像素点为同一类像素点，其像素点灰度值相对均匀。在该窗口内逐像素点遍历，分析遍历像素点与其8邻域像素点的灰度变化，若遍历像素点在窗口边缘，则只分析窗口内的相邻像素点。先去除该窗口内灰度值比其8邻域像素点都大或者都小的明显噪声点，然后计算剩余像素点的热传导向量：以像素点向其8邻域中灰度值减小的方向为向量方向、减小的灰度值为向量值得到向量，再取这些向量的和表示该像素点的热传导向量。获得热传导向量集合，其中m表示该窗口内剩余像素点的数量，即为热传导向量集合中向量的个数。已知噪声点的热传导方向线段无序，而正常像素点的热传导相似。故计算第一个热传导向量与剩余热传导向量的夹角的和为：其中表示集合中第一个热传导向量，表示集合中第x个热传导向量，x的取值范围为。表示集合中第一个热传导向量的向量值，表示集合中第x个热传导向量的向量值。m表示集合中向量的个数。表示反余弦函数。此处通过反余弦函数计算得到第一个热传导向量与剩余热传导向量之间的夹角，然后对所有夹角进行求和得到第一个热传导向量与剩余热传导向量的夹角的和，用于判断第一个热传导向量对应的剩余像素点是否为正常像素点。此处利用像素点的热传导向量来判断像素点是否为正常像素点，是因为正常像素点的热传导向量相似，而噪声点的热传导方向线段无序。在集合中依次计算一个热传导向量与剩余热传导向量的夹角，获得集合。当噪声点的热传导向量为主体时，其与大多数热传导向量的夹角较大，故其对应的热传导向量与剩余热传导向量的夹角的和较大。当正常像素点的热传导向量为主体时，其与大多数热传导向量的夹角较小，故其对应的热传导向量与剩余热传导向量的夹角的和较小。取集合的均值为，判断对应的像素点为正常像素点。计算这些正常像素点的灰度值均值，以此替换该窗口内中心像素点的灰度值。若V大于等于方差阈值时，说明该窗口内含有两类像素点，其像素点灰度值不均匀，即窗口内含有边缘。获取该窗口内的正常像素点，将正常像素点的灰度值按照从大到小的方式进行排序，获得灰度值序列，其中y表示该窗口内的正常像素点的数量。然后从左至右依次计算该序列中相邻两像素点的灰度值差值，获得灰度值差值序列G={}，取该序列的最大值。根据对应的相邻两像素点将序列分为灰度值大的高温序列{}和灰度值小的背景序列{}。已知高温区域为一类圆形连通域，当该窗口中心像素点属于高温区域时，则窗口内一半以上为高温区域的像素点，当该窗口中心像素点属于背景区域时，则窗口内一半以上为背景区域的像素点。故该窗口内中心像素点灰度值的替换值H为：其中q表示将灰度值序列分为两类的分割序列号，y表示该窗口内的正常像素点的数量。表示灰度值序列中的第i个灰度值。此处的含义为：当高温序列中灰度值的数量大于等于背景序列中灰度值的数量时，则将高温序列中所有灰度值的均值作为该像素点去噪后的灰度值；当高温序列中灰度值的数量小于背景序列中灰度值的数量时，则将背景序列中所有灰度值的均值作为该像素点去噪后的灰度值。此处根据中心像素点的邻域内像素点的灰度值分布情况，来对中心像素点进行去噪，去噪效果更好。由此完成该窗口内中心像素点灰度值的替换。完成对发动机红外图像的去噪处理。S4：对去噪后的灰度图进行阈值分割，获取去噪后的灰度图中的高温区域。获取去噪后的发动机红外图像，利用大津算法求取最佳分割阈值，根据灰度值大于最佳分割阈值的像素点得到高温区域，计算高温区域的灰度值均值P。S5：利用高温区域中所有像素点的灰度值均值对机油散热器的散热效果进行检测。取20张机油散热器含有故障的工作状态下的汽车发动机红外图像，按照获取去噪后的灰度图中的高温区域的方法获取高温区域的灰度值均值P’，取这组数据的均值为，以其为灰度值阈值，当去噪后的灰度图中的高温区域的灰度值均值P大于时，判断机油散热器散热效果较差，说明机油散热器出现了故障。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
