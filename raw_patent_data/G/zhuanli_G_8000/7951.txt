标题title
基于新安江与深度学习耦合模型的场次洪水预报方法和系统
摘要abst
本申请涉及一种基于新安江与深度学习耦合模型的场次洪水预报方法和系统，所述方法包括：采集并预处理预研究区域的地理信息数据和雨水情数据，构建新安江三水源小时尺度水文模型；基于所述地理信息数据和雨水情数据获得新安江三水源小时尺度水文模型的洪水初始参数，率定和检验新安江三水源小时尺度水文模型，并通过所述新安江三水源小时尺度水文模型筛选出预定数量的场次洪水，获得各场次洪水的输出变量和中间状态变量；构建与所述新安江三水源小时尺度水文模型适配的深度学习耦合模型，形成新安江与深度学习耦合模型并获得预报结果。本申请大大提高了场次洪水预报的准确性，同时神经网络的泛化能力得到增强，便于迁移应用。
权利要求书clms
1.基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，包括如下步骤：S1、采集并预处理预研究区域的地理信息数据和雨水情数据，构建新安江三水源小时尺度水文模型；S2、基于所述地理信息数据和雨水情数据获得新安江三水源小时尺度水文模型的洪水初始参数，率定和检验新安江三水源小时尺度水文模型，并通过所述新安江三水源小时尺度水文模型筛选出预定数量的场次洪水，获得各场次洪水的输出变量和中间状态变量；S3、构建与所述新安江三水源小时尺度水文模型适配的深度学习耦合模型，形成新安江与深度学习耦合模型；以各场次洪水的输出变量和中间状态变量作为深度学习模型的输入参数，对场次洪水进行预测，并输出场次洪水的相关参数，获得预报结果；所述深度学习耦合模型为CNN-LSTM耦合模型；S4、根据预报结果对新安江与深度学习耦合模型进行评价。2.如权利要求1所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，所述地理信息数据包括预研究区域下垫面的流向数据、汇流积累数据和河网拓扑数据，以及子流域集水区；将所述预研究区域划分成若干研究区块，并针对每一研究区块，基于所述流向数据、汇流积累数据和河网拓扑数据构建降水汇流有向图，并基于每一研究区块的降水汇流有向图构建研究区域的整体降水汇流有向图。3.如权利要求1所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，所述雨水情数据包括降雨数据、蒸发数据和径流数据；所述降雨数据的预处理过程包括：采集预研究区域各站点的日总降水数据，并判断是否存在小时尺度的强降水数据；若存在，计算强降水总量和总持续时间，并计算强降水量均值，分配至强降水持续时间的各个小时，计算日总降水量与当日强降水总量的差值，得到当日非强降水量，并计算当日非强降水的持续时间，最后计算当日非强降水量的均值，得到非强降水量均值；若不存在，计算日总降水量的均值，将日总降水量在当日平均分配，得到日降水平均值；采用反距离权重法将日降水平均值或当日强降水量均值和非强降水量均值按照集水范围进行分配，得到空间降水场；根据各个水文站的集水范围和空间降水场计算面平均降水；判断水文站的站点时间是否一致，若不一致，通过插值法补齐日平均降水数据。4.如权利要求3所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，所述蒸发数据的预处理过程如下：判断逐日蒸发数据是否连续，若不连续，按照预定年数的平均值对缺省值进行补齐；所述径流数据的预处理过程如下：判断径流数据是否连续，若不连续，采用三次样条插值法计算得到间断时段内的逐时净流量。5.如权利要求2所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，还包括基于评价指标判断各个场次洪水预报中，新安江与深度学习耦合模型的预报结果是否优于新安江三水源小时尺度水文模型的预报结果；若否，分析判断各个研究区块是否发生产汇流关系变化；若判断发生变化，采用插值法生成当前研究区块的水文参数，替换原有水文参数，并重新用新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，输出预报结果；所述评价指标包括洪峰相对误差、峰现时间误差、洪量相对误差和纳什效率系数。6.如权利要求5所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，若未判断出发生变化，则针对每一场次洪水执行如下过程：随机选择预研究区域内的一个研究区块，采用插值法生成当前研究区块的水文参数，替换该研究区块原有的水文参数，重新通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，并输出预报结果；重复上一过程，直至完成所有研究区块的重新预报，获得一组预报结果；基于评价指标构建综合评价指标值，并按照综合评价指标对预报结果进行降序排列，选择前N个预报结果作为标引项；查找前N个预报结果对应的各个研究区块，将其标记为参数待定区块，N为正整数。7.如权利要求6所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，查找参数待定区块参与的降雨过程和场次洪水过程，采用原有的水文参数和插值法替换后的水文参数，通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型分别对各个场次洪水进行预报，输出预报结果并进行降序排列，查找替换后的水文参数优于原有水文参数的洪水场次，并记录该洪水场次对应的初始时刻；按照该初始时刻，将该参数待定区块划分为第一时间区间和第二时间区间，在第一时间区间，采用原有的水文参数；在第二时间区间，重新测量标定水文参数或采用插值法生成水文参数。8.如权利要求7所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，率定新安江三水源小时尺度水文模型的过程如下：采集需要率定的各个参数，针对每一参数，以纳什效率系数为目标函数，采用SCE-UA方法对参数进行优选；在确定参数寻优空间时，对于预研究区域内的参数待定区块，按照时间段给予参数上限和参数下限。9.如权利要求5所述的基于新安江与深度学习耦合模型的场次洪水预报方法，其特征在于，当判断研究区块发生产汇流变化时，采用时间窗口法判断产汇流发生变化的时刻：按照新安江三水源小时尺度水文模型预报的洪水场次将研究时间分成若干个时间窗口，依序调整研究区块对应时间窗口内的水文参数，构建由现有水文参数与插值法产生的水文参数组成的对照组，然后通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，生成预报结果，通过评价指标对预报结果进行打分计算，并比较两组预报结果的得分值，根据得分值的对比结果判断产汇流发生变化的时刻。10.一种系统，其特征在于，包括：至少一个处理器；以及与至少一个所述处理器通信连接的存储器；其中，所述存储器存储有可被所述处理器执行的指令，所述指令用于被所述处理器执行以实现权利要求1-9任一项所述的基于新安江与深度学习耦合模型的场次洪水预报方法。
说明书desc
技术领域本发明涉及洪水预报技术，特别是一种新安江模型结合深度学习耦合模型的场次洪水预报方法。背景技术近年来，随着全球城市化进程的加快，洪水的危害性越来越大，洪涝灾害造成的财产损失正成显著增长的趋势。2021年，中国和德国的洪涝灾害，均造成巨大损失。为了防治洪涝灾害，建立实用的洪水预报模型是重要的任务和手段。目前常用的模型仍然是集总式水文模型，代表性的模型包括Stanford模型、Sacramento模型、tank模型、Xinanjiang模型、和ARNO模型。由于集总式水文模型将流域视为整体，不考虑降水等要素的空间分布，已经不能满足水库防洪作业、洪水预报的精度要求。尤其是在洪峰、洪水起涨阶段等局部位置处，相关模型的预报准确率尚不能达到期望值。为此，提出了分布式水文模型，主要有VIC模型、SHE模型、CASC2D模型、WetSpa模型和Vflo模型。基于物理机制的分布式水文模型预报结果看似合理，但是模型的实际预报结果并不可靠。研究表明分布式水文模型比集总水文模型和数据驱动模型具有优势，但其同样存在一些缺点，它们的计算效率低，需要高分辨率的复杂输入数据；同时仅适用于山区，而且较高分辨率的分布式水文模型可能会被小尺度上不断增加的不确定性所影响。除此以外，分布式水文模型的边界条件难以确定，也会对模型精度产生影响。随着计算机技术的进步，机器学习在水文学中得到了广泛的应用，但是，目前基于数据驱动的水文模型重点关注输出模拟结果的准确性，而忽视了输入、输出数据集之间的物理机制，同时存在计算过程较为模糊和不同流域之间与流域内模拟结果难以迁移等问题。总之，如何提高预测的准确性，减小预测值与观察值之间的误差，增强神经网络的泛化能力，是目前要解决的问题。发明内容发明目的：提供一种基于新安江与深度学习耦合模型的场次洪水预报方法，以解决现有技术存在的上述问题之一，例如解决在洪峰、洪水起涨阶段等局部位置处，相关模型的预报准确率较低的问题。技术方案：根据本申请的一个方面，基于新安江与深度学习耦合模型的场次洪水预报方法，包括如下步骤：S1、采集并预处理预研究区域的地理信息数据和雨水情数据，构建新安江三水源小时尺度水文模型；S2、基于所述地理信息数据和雨水情数据获得新安江三水源小时尺度水文模型的洪水初始参数，率定和检验新安江三水源小时尺度水文模型，并通过所述新安江三水源小时尺度水文模型筛选出预定数量的场次洪水，获得各场次洪水的输出变量和中间状态变量；S3、构建与所述新安江三水源小时尺度水文模型适配的深度学习耦合模型，形成新安江与深度学习耦合模型；以各场次洪水的输出变量和中间状态变量作为深度学习模型的输入参数，对场次洪水进行预测，并输出场次洪水的相关参数，获得预报结果；所述深度学习耦合模型为CNN-LSTM耦合模型；S4、根据预报结果对新安江与深度学习耦合模型进行评价。根据本申请的一个方面，所述地理信息数据包括预研究区域下垫面的流向数据、汇流积累数据和河网拓扑数据，以及子流域集水区；将所述预研究区域划分成若干研究区块，并针对每一研究区块，基于所述流向数据、汇流积累数据和河网拓扑数据构建降水汇流有向图，并基于每一研究区块的降水汇流有向图构建研究区域的整体降水汇流有向图。根据本申请的一个方面，所述雨水情数据包括降雨数据、蒸发数据和径流数据；所述降雨数据的预处理过程包括：采集预研究区域各站点的日总降水数据，并判断是否存在小时尺度的强降水数据；若存在，计算强降水总量和总持续时间，并计算强降水量均值，分配至强降水持续时间的各个小时，计算日总降水量与当日强降水总量的差值，得到当日非强降水量，并计算当日非强降水的持续时间，最后计算当日非强降水量的均值，得到非强降水量均值；若不存在，计算日总降水量的均值，将日总降水量在当日平均分配，得到日降水平均值；采用反距离权重法将日降水平均值或当日强降水量均值和非强降水量均值按照集水范围进行分配，得到空间降水场；根据各个水文站的集水范围和空间降水场计算面平均降水；判断水文站的站点时间是否一致，若不一致，通过插值法补齐日平均降水数据。根据本申请的一个方面，所述蒸发数据的预处理过程如下：判断逐日蒸发数据是否连续，若不连续，按照预定年数的平均值对缺省值进行补齐；所述径流数据的预处理过程如下：判断径流数据是否连续，若不连续，采用三次样条插值法计算得到间断时段内的逐时净流量。根据本申请的一个方面，基于评价指标判断各个场次洪水预报中，新安江与深度学习耦合模型的预报结果是否优于新安江三水源小时尺度水文模型的预报结果；若否，分析判断各个研究区块是否发生产汇流关系变化；若判断发生变化，采用插值法生成当前研究区块的水文参数，替换原有水文参数，并重新用新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，输出预报结果；所述评价指标包括洪峰相对误差、峰现时间误差、洪量相对误差和纳什效率系数。根据本申请的一个方面，若未判断出发生变化，则针对每一场次洪水执行如下过程：随机选择预研究区域内的一个研究区块，采用插值法生成当前研究区块的水文参数，替换该研究区块原有的水文参数，重新通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，并输出预报结果；重复上一过程，直至完成所有研究区块的重新预报，获得一组预报结果；基于评价指标构建综合评价指标值，并按照综合评价指标对预报结果进行降序排列，选择前N个预报结果作为标引项；查找前N个预报结果对应的各个研究区块，将其标记为参数待定区块，N为正整数。根据本申请的一个方面，查找参数待定区块参与的降雨过程和场次洪水过程，采用原有的水文参数和插值法替换后的水文参数，通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型分别对各个场次洪水进行预报，输出预报结果并进行降序排列，查找替换后的水文参数优于原有水文参数的洪水场次，并记录该洪水场次对应的初始时刻；按照该初始时刻，将该参数待定区块划分为第一时间区间和第二时间区间，在第一时间区间，采用原有的水文参数；在第二时间区间，重新测量标定水文参数或采用插值法生成水文参数。根据本申请的一个方面，率定新安江三水源小时尺度水文模型的过程如下：采集需要率定的各个参数，针对每一参数，以纳什效率系数为目标函数，采用SCE-UA方法对参数进行优选；在确定参数寻优空间时，对于预研究区域内的参数待定区块，按照时间段给予参数上限和参数下限。根据本申请的一个方面，当判断研究区块发生产汇流变化时，采用时间窗口法判断产汇流发生变化的时刻：按照新安江三水源小时尺度水文模型预报的洪水场次将研究时间分成若干个时间窗口，依序调整研究区块对应时间窗口内的水文参数，构建由现有水文参数与插值法产生的水文参数组成的对照组，然后通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，生成预报结果，通过评价指标对预报结果进行打分计算，并比较两组预报结果的得分值，根据得分值的对比结果判断产汇流发生变化的时刻。还提供一种系统，包括：至少一个处理器；以及与至少一个所述处理器通信连接的存储器；其中，所述存储器存储有可被所述处理器执行的指令，所述指令用于被所述处理器执行以实现上述任一项实施例所述的基于新安江深度学习耦合模型的场次洪水预报方法。有益效果：对于场次洪水的预报准确率大大提高，综合性能相较单独使用传统水文模型或单独使用神经网络模型而言，具有明显的优势，尤其是明显提升了在洪峰、洪水起涨阶段等局部位置处的预测精度。而且发现本申请的泛化能力得到增强。附图说明图1是本申请的流程总图。图2是本申请的CNN-LSTM耦合模型的拓扑结构图。图3是本申请的总体架构拓扑图。图4是本申请与现有技术的两组预测结果对比图。具体实施方式如图1所示，详细描述本申请的技术原理和技术细节。需要说明的是，由于技术方案过于庞杂，对于本领域技术人员已经知晓的技术内容进行略写。本领域的技术人员能够按照本申请的技术方案解决相关问题，获得相应的技术效果。提供一种基于新安江与深度学习耦合模型的场次洪水预报方法，包括如下步骤：S1、采集并预处理预研究区域的地理信息数据和雨水情数据，构建新安江三水源小时尺度水文模型。传统水文模型通常存在预热期、率定期和验证期，其中预热期的目的是确定前期的初始状态，但是在场次洪水预报中不存在预热期，因此首先建立小时尺度长系列水文模型，将各个步长的状态输出，作为每场洪水的启动项。S2、基于所述地理信息数据和雨水情数据获得新安江三水源小时尺度水文模型的洪水初始参数，率定和检验新安江三水源小时尺度水文模型，并通过所述新安江三水源小时尺度水文模型筛选出预定数量的场次洪水，获得各场次洪水的输出变量和中间状态变量。S3、构建与所述新安江三水源小时尺度水文模型适配的深度学习耦合模型，形成新安江与深度学习耦合模型；以各场次洪水的输出变量和中间状态变量作为深度学习模型的输入参数，对场次洪水进行预测，并输出场次洪水的相关参数，获得预报结果；所述深度学习耦合模型为CNN-LSTM耦合模型。S4、根据预报结果对新安江与深度学习耦合模型进行评价。简而言之，在本申请的技术中，首先通过三水源新安江模型XAJ3对场次洪水进行预报，然后将预报结果、初始水文参数和中间结果等作为神经网络耦合模型的输入参数，通过神经网络耦合模型进行预报，从而能够克服传统水文模型精度不足，而现有基于数据驱动的神经网络模型过度依赖训练数据，忽视物理机制的问题。本申请增强了水文模拟精度和效果。通过新安江水文模型进行率定和预报，解决了深度神经网络无法解决的物理机制问题，因此对于后续神经网络预报准确率的提高有所助益。从实验结果看，整体的预报精确度和各个场次洪水预报的精确度，均有不同程度的提高。接着，描述本申请的数据采集和处理过程。由于预研究区域的数据并不是理想数据，因此需要进行预处理。首先，地理信息数据包括预研究区域下垫面的流向数据、汇流积累数据和河网拓扑数据，以及子流域集水区；将预研究区域划分成若干研究区块，并针对每一研究区块，基于流向数据、汇流积累数据和河网拓扑数据构建降水汇流有向图，并基于每一研究区块的降水汇流有向图构建研究区域的整体降水汇流有向图。在本实施例中，通过将预研究区域划分成若干个研究区域，便于对各个区域的水文参数，即包括上述流向数据、汇流积累数据和河网拓扑数据在内的下垫面各种数据进行分区。同时，通过构建降水汇流有向图，并通过数据计算，判断是否会引起产汇流关系的变化。为了提高输入数据的准确性，进而提高预报的准确率，需要对相关数据进行补充和对齐处理。具体如下：在进一步的实施例中，雨水情数据包括降雨数据、蒸发数据和径流数据；降雨数据的预处理过程包括：采集预研究区域各站点的日总降水数据，并判断是否存在小时尺度的强降水数据；若存在，计算强降水总量和总持续时间，并计算强降水量均值，分配至强降水持续时间的各个小时，计算日总降水量与当日强降水总量的差值，得到当日非强降水量，并计算当日非强降水的持续时间，最后计算当日非强降水量的均值，得到非强降水量均值；若不存在，计算日总降水量的均值，将日总降水量在当日平均分配，得到日降水平均值；采用反距离权重法将日降水平均值或当日强降水量均值和非强降水量均值按照集水范围进行分配，得到空间降水场；根据各个水文站的集水范围和空间降水场计算面平均降水；判断水文站的站点时间是否一致，若不一致，通过插值法补齐日平均降水数据。在实际情景下，各个站点的数据可能存在缺失或没有给出模型所需的标准数据，因此需要进行调整。以下仅作为示例，为了便于计算，对数据做出了调整，本领域的技术人员能够知晓并了解相关过程即可。如果某个站点，给出了2012年7月6日当日的日降水总量a和当日强降水总量b，并给出了强降水发生于14时00分至15时00分，则当日非强降水量为a-b，强降水量的均值为b/3，非强降水量的均值为/21。2012年7月10日的日降水总量为c，没有给出强降水量的相关数据，则日降水平均值为c/24。又如，站点A的数据为2008年1月1日至2010年12月31日，而站点B的数据为2008年1月1日至2010年5月20日。则通过相邻站点的降雨数据结合插值法进行补齐。可以通过筛选部分均有数据的雨量站点作为待插值站点降水数据，格式如下：80841540 雨量站m600167.50 2606119.27。在进一步的实施例中，蒸发数据的预处理过程如下：判断逐日蒸发数据是否连续，若不连续，按照预定年数的平均值对缺省值进行补齐。例如，蒸发数据时段间隔大于雨情水情数据时段，对缺数据时段按多年平均值进行推求。日蒸发量的数据结构包括序号、字段名、字段标识和计量单位，字段名包括时间和日蒸发量，对应的字段标识分别为TM、DYE，蒸发量的单位为mm。径流数据的预处理过程如下：判断径流数据是否连续，若不连续，采用三次样条插值法计算得到间断时段内的逐时净流量。例如某个实施例中，径流数据不连续，为获得时间间隔较为一致和完整的径流过程，可对径流数据采用三次样条插值，计算得到每日8时至次日8时站点的逐时径流量。河道水情结构表的数据格式包括序号、字段名和标识符，字段名包括测站编码、时间和流量，标识符分别为STCD、TM和Q。在进一步的实施例中，基于评价指标判断各个场次洪水预报中，新安江与深度学习耦合模型的预报结果是否优于新安江三水源小时尺度水文模型的预报结果；在上述步骤S2和S3中，已经获得了预定数量的场次洪水数据，在步骤S3中，给出了XAJ-CNN-LSTM的预报结果。可以对比预报结果，判断是否发生了变化。这个过程可以是独立的，并行的，即分别通过XAJ和XAJ-CNN-LSTM来预测洪水，进行对比。若否，分析判断各个研究区块是否发生产汇流关系变化；若判断发生变化，采用插值法生成当前研究区块的水文参数，替换原有水文参数，并重新用新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，输出预报结果；评价指标包括洪峰相对误差、峰现时间误差、洪量相对误差和纳什效率系数。在现有的预测方法中，有个基本的假设，即稳定性假设，相关产汇流的参数，在相当长的时间内，是保持稳定的，因此，可以通过仿真模拟对各个环节、各个区域的参数进行拟合优选，从而获得相对准确的参数，为后续准确预报提供基础条件。但是受限于输入数据、概化物理过程的不确定性，尤其是人类剧烈活动导致产汇流关系发生变化。例如对农田山地的改造，新建水库橡胶坝等水利设施，对河流的疏浚等等。都会影响产汇流关系。因此，对于某一区域而言，在产汇流关系在某一时间之前，相关参数是一组，在之后，又变化成另一组，如果默认没有变化，将该时间前后的数据都作为训练数据，则会导致参数被错误估计，从而后续的预报不准确。为了解决这一问题，申请人提供了一种方法，即通过预报结果判断是否存在产汇流关系变化的可能性。按照统计结果。耦合模型的预报结果比传统水文模型更加准确，如果发生不准确的情况，有可能是产汇流关系发生了变化，导致在神经网络训练时，变化前后的参数不一致，导致神经网络训练失准，从而预报结果不够好。因此，通过这一情况，可以做出标记，为后续更加准确地训练和预报提供依据。如果发生变化，则通过插值法替换相关数据，通过数据替换的方式，以周围站点的数据作为插值数据的基础数据，对相关区域重新进行模拟，判断是否确实发生变化。还可以通过人工对相关区域进行研究，判断相关区域是否发生变化。在进一步的实施例中，如果在预报结果上没法判断出是否发生变化，则可以通过空间滑动窗口的方法进行判断。具体如下：在进一步的实施例中，若未判断出发生变化，则针对每一场次洪水执行如下过程：随机选择预研究区域内的一个研究区块，采用插值法生成当前研究区块的水文参数，替换该研究区块原有的水文参数，重新通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，并输出预报结果；重复上一过程，直至完成所有研究区块的重新预报，获得一组预报结果；基于评价指标构建综合评价指标值，并按照综合评价指标对预报结果进行降序排列，选择前N个预报结果作为标引项；查找前N个预报结果对应的各个研究区块，将其标记为参数待定区块，N为正整数。例如在某场次洪水中，有十个研究区域参与了汇流过程，但是其中有1个研究区域的产汇流关系发生了变化，为了查找出哪一研究区域发生了汇流变化，从第一个到第十个研究区域依次通过更换水文参数的方式，然后以新的参数结合其他研究区域的参数进行预报，并对预报结果进行排序。假如是第5个研究区域的水文参数被替换后，整体预报结果提高了，排序第一，则将其标记为产汇流关系已经发生了变化。通过人工对该区域进行二次甄别，判断是否发生了产汇流变化。同样，如果是多个研究区域发生了变化，则会产生多组预报结果明显变化的选项。在其他实施例中，也可能是一个研究区域发生变化，导致出现多组预报结果发生变化。通过人工的二次审核，可以更加准确的判断研究区域是否发生了变化，以及哪些研究区域可能已经发生了变化。也有可能是某个变化的区域被划分到多个研究区域。在上述过程中，通过一些技术方案，对产汇流发生变化的空间位置进行大致定位，但是对于某一已经发生了变化的研究区域，如何判断其何时发生了变化，对于变化前后的参数进行分类处理，从而提高预报的准确性，是非常重要的课题。为此，提供了一种如下方案。在进一步的实施例中，查找参数待定区块参与的降雨过程和场次洪水过程，采用原有的水文参数和插值法替换后的水文参数，通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型分别对各个场次洪水进行预报，输出预报结果并进行降序排列，查找替换后的水文参数优于原有水文参数的洪水场次，并记录该洪水场次对应的初始时刻；按照该初始时刻，将该参数待定区块划分为第一时间区间和第二时间区间，在第一时间区间，采用原有的水文参数；在第二时间区间，重新测量标定水文参数或采用插值法生成水文参数。通过时间窗口滑动的方法，按照洪水场次对时间进行分段，通过替换数据，然后进行预报，判断在何时发生了变化。从而为不同时间段内的参数分类提供基础。为后续的预报提供更为坚实的数据基础。除了上述方法外，还可以通过时间窗口法判断相关区域发生产汇流变化的时刻。具体如下：在进一步的实施例中，当判断研究区块发生产汇流变化时，采用时间窗口法判断产汇流发生变化的时刻：按照新安江三水源小时尺度水文模型预报的洪水场次将研究时间分成若干个时间窗口，依序调整研究区块对应时间窗口内的水文参数，构建由现有水文参数与插值法产生的水文参数组成的对照组，然后通过新安江三水源小时尺度水文模型和新安江与深度学习耦合模型进行预报，生成预报结果，通过评价指标对预报结果进行打分计算，并比较两组预报结果的得分值，根据得分值的对比结果判断产汇流发生变化的时刻。有了上述数据后，在率定新安江三水源小时尺度水文模型时，可以对优化方法进行调整，从而获得更好的效果。在进一步的实施例中，率定新安江三水源小时尺度水文模型的过程如下：采集需要率定的各个参数，针对每一参数，以纳什效率系数为目标函数，采用SCE-UA方法对参数进行优选；在确定参数寻优空间时，对于预研究区域内的参数待定区块，按照时间段给予参数上限和参数下限。显然，上述仿真预报方法是可以做成软件的，这种软件可以与硬件结合，形成一种系统。具体如下：提供一种系统，包括：至少一个处理器；以及与至少一个处理器通信连接的存储器；其中，存储器存储有可被处理器执行的指令，指令用于被处理器执行以实现上述任一项实施例的基于新安江与深度学习耦合模型的场次洪水预报方法。由于形成计算机系统的方法和拓扑架构是现有技术，在此不再详述。总之：与采用神经网络模型直接预测洪水相比，本申请先通过新安江模型进行预报，并将输出结果作为神经网络耦合模型的输入数据之一，具有如下好处：能够在提升精度的同时依然保留传统水文模型的物理机制。神经网络模型重点关注输出模拟结果的准确性，而忽视了输入、输出数据集之间的物理机制，同时存在计算过程较为模糊和不同流域之间与流域内模拟结果难以迁移等问题。而本申请的优势主要是在新安江模型模拟结果的基础上修正局部洪水过程，而不改变新安江模型具备的物理机制。因此，与神经网络模型直接预测洪水相比，耦合模型的优势在于不仅具有较高的模拟精度，还可以保留传统水文模型模拟洪水过程线的基本结构，保留传统水文模型的物理机制。用新安江-CNN-LSTM耦合模型来预测场次洪水，相比用神经网络模型来预测区域降水，其应用场景不同之处及优势有二：第一，新安江-CNN-LSTM耦合模型的输入条件更为复杂，包含降水、水面蒸发以及下垫面参数等，而采用神经网络模型预测降水或洪水的输入主要是降水数据；第二，新安江-CNN-LSTM耦合模型的预测结果不仅关注预测精度，且可以使得预测结果保持实测洪水过程线基本结构，比仅仅采用神经网络模型预测更为可靠。如果先用CNN-LSTM模型来校正新安江模型中的参数，然后将校正后的参数作为新安江模型的输入参数并开展洪水预测，本申请的优势在于：先采用CNN-LSTM模型校正参数的作用仅仅是停留在新安江模型的参数率定层面，但对于新安江模型在洪峰、洪水起涨阶段预测精度不佳的固有弊端并无改进效果，而本申请则可以在保留新安江模型物理机制的前提下明显提升模型在洪峰、洪水起涨阶段等局部位置处的预测精度，这是本耦合方法的一大提升。如果通过XAJ-LSTM来预测，本申请与之相比具有如下好处：本申请在深度学习模块采用的是混合深度学习算法CNN-LSTM，相比于单一的LSTM算法，本申请的优势在于该深度学习模块同时兼具CNN和LSTM的优点，使得洪水预测精度更加稳定，特别是在洪峰、洪水起涨阶段等局部位置处的预测精度。以上详细描述了本发明的优选实施方式，但是，本发明并不限于上述实施方式中的具体细节，在本发明的技术构思范围内，可以对本发明的技术方案进行多种等同变换，这些等同变换均属于本发明的保护范围。
