标题title
一种基于时空超图神经网络的交通流预测方法
摘要abst
一种基于时空超图神经网络的交通流预测方法，包括：1)数据收集：采用真实交通数据集，经预处理，得到实验所需的数据；2)超图构造，将交通数据在空间维度上展现的局部相关性与跨路网同构性进行统一；3)空间特征提取，设计基于超图的双通道超图卷积算法，在捕捉节点间高阶空间关系的同时，学习到超边与节点之间的关系，实现对交通数据空间特征的提取；4)时间特征提取：使用LSTM进行时间特征提取；5)模型构建：联合时间和空间特征，构建用于交通流预测的时空超图神经网络模型；6)数据集验证：采用真实世界的交通数据集对时空超图神经网络模型进行性能评估，最终确定时空超图神经网络模型的有效性，并用于交通流预测。
权利要求书clms
1.一种基于时空超图神经网络的交通流预测方法，包括如下步骤：将道路传感器节点视为图节点，传感器上的交通信息视为节点属性，对交通信息进行超图结构数据表示，并进行问题定义；将交通数据在空间维度呈现出的局部相关性和跨路网同构性利用超图统一起，并基于超图的双通道超图卷积来捕获交通数据中的高阶空间关系，获得交通数据的空间特征表示；联合步骤所得的空间特征，利用一个带有卷积模块的长短时记忆网络来处理交通数据在时间维度呈现出的周期性漂移和随机干扰，从而获得交通数据的时空特征表示；联合步骤所得的时空特征，确定用于交通流预测的时空超图神经网络模型，并在两个不同地区的真实交通数据集进行实验验证，最终确定时空超图神经网络模型的有效性；采用步骤确定的时空超图神经网络模型，用于交通流量预测。2.根据权利要求1所述的一种基于时空超图神经网络的交通流预测方法，其特征在于：所述步骤具体包括如下步骤：1a).将原始交通数据进行标准化处理，将路网进行图表示G＝,V表示所有道路集合，E表示边集合，W是权重邻接矩阵，表示节点之间的连接，矩阵中的元素取值范围在0到1之间；1b).将不同道路的交通数据按五分钟为单元进行统计，表示为节点的特征矩阵h表示历史时间长度，N表示节点个数。首先利用K-Means聚类算法对特征矩阵进行聚类，实现从全局上捕捉高相关性的节点构建超图H，进而根据W所表示的节点连接关系将超图进行扩展，充分统一交通数据在空间上呈现的局部相关性与跨路网同构性；1c).联合步骤1b)中得到的超图，构建基于超图的线图L，捕捉超图中多个超边之间的关系，对交通节点之间多对多的空间关系进行表示；1d).给定道路网路网G，特征矩阵旨在找到一个能够从历史交通信息学习时空特征的映射函数使之能够预测接下来的交通信息。3.根据权利要求1所述的一种基于时空超图神经网络的交通流预测方法，其特征在于：所述步骤具体包括如下步骤：2a).按照步骤统计所得到的交通数据以及图结构数据进行特征提取，通过研究表征超图与线图的拉普拉斯矩阵，将图卷积神经网络公式扩展到超图卷积神经网络与线图卷积神经网络中；2b).联合步骤得到的超图H＝，其中VH是一个包含N个顶点的有限集，EH是一个包含M个超边的有限集，每个超边被赋予一个非负权值w，所有权值构成一个对角矩阵WH∈RM×M。超图的结构可以用相关矩阵H∈RN×M来描述，其中h＝1，如果超边e包含顶点v，否则为0。对于每个顶点v∈VH和每个超边e∈EH，它们的度可以被定义为和DV表示每个顶点的对角矩阵和De表示每个超图的对角矩阵。定义超图拉普拉斯矩阵Δ为：其中I表示单位矩阵；根据分层图卷积的思想，超图卷积可以被定义为：其中P和是第l层的可学习的参数矩阵。2c).联合步骤得到的线图，给定一个超图H＝超图的线图L＝是一个简单图，L的每一个节点是超图中的一条超边，如果相应的超边在超图中至少共享一个共同的顶点，则L的两个节点有连接。对于L中的每两个节点ei和ej，权值矩阵WLij＝|ei∩ej|/|ei∪ej|。线图中的节点数与超图中的超边数相同。因此，在提取节点多对多关系的同时，达到融合关键流量节点影响的目的。有必要将线形图中的节点与超图中的节点关联起来。因此，本发明设计了一个自学习注意矩阵WA∈RN×M来学习超边与道路节点的映射关系。进一步地，线图卷积可以表示为：其中为自环线图的权重矩阵，为对角矩阵，为第l层的可学习参数矩阵；2d).联合步骤和得到的泛化图卷积公式，一种双层双通道超图卷积来嵌入交通数据的空间特征。特征矩阵X经过第一层超图卷积和线图卷积后，可以得到同维的嵌入向量。然后将第一层的线/超图卷积结果输入到第二层的超图/线图卷积，可以表示为：其中通过交换两个卷积学习到的信息，在提取交通节点之间的多对多关系的同时得到关键流量节点之间的影响，对交通数据的空间特征进行充分表征。4.根据权利要求1所述的一种基于时空超图神经网络的交通流预测方法，其特征在于：所述步骤具体包括如下步骤：3a).结合步骤中所得到的空间特征表示，首先采用线性投影构建空间特征输出层，使其能够输入到带有卷积模块的LSTM网络中；Z＝ZWO其中WO是可学习的网络参数；3b).本发明可以通过双通道超图卷积得到完整的空间特征，而传统的LSTM只能处理单个节点的时间序列变量。因此，直接将空间特征输入到LSTM中会失去空间关系。CNN可以通过卷积核增加感知视场，进而捕获局部空间特征。在LSTM中嵌入CNN使得LSTM可以同时考虑多个节点的时间信息，从而提取时间特征，可以表示为：其中表示阿达玛积，表示矩阵对应元素相乘，*表示CNN卷积操作，σ表示sigmoid激活函数。输入X1…Xt,cell输出C1…Ct，隐藏状态H1…Ht三维张量，可以直接进行卷积运算。Wh、Wx、Wc、和b为各层的可学习参数；3c).结合步骤所得空间特征和步骤提取时间特征的方法，构建出交通数据时空特征。5.根据权利要求1所述的一种基于时空超图神经网络的交通流预测方法，其特征在于：所述步骤具体包括如下步骤：4a).结合步骤所提取的交通数据时空特征，确定用于交通流预测的时空超图神经网络模型，构建出损失函数，进行时空超图神经网络模型的训练和参数的优化。其中N表示采样个数，Yi和表示真实交通信息值和预测交通信息值；4b).为了评估时空超图神经网络模型的预测性能，选择平均绝对误差、平均绝对百分比误差和均方根误差作为指标。对于MAE、RMSE和MAPE指标，值越小表示预测性能越好；4c).为了验证双通道超图卷积的有效性，本发明设计了三个消融实验，将双通道超图卷积模块替换为图卷积模块的GSTHNN,将双通道超图卷积模块替换为超图卷积模块的HSTHNN和将双通道超图卷积模块替换为线图卷积模块的LSTHNN，并进行实验验证。4d).将两个不同地区的真实交通数据集输入模型，并采用批处理的方式进行训练，观察模型的表现性能。最终，可以得到具有表征交通数据空间特征和时间趋势的时空超图神经网络模型，并应用于交通流预测。
说明书desc
技术领域本发明涉及人工智能、图神经网络、数据挖掘领域，尤其是一种针对交通时空数据建模、实现交通流预测的方法。背景技术随着经济的不断发展，城市居民的汽车保有量逐年增加。因此，智能交通系统的建设迫在眉睫。而交通流预测是提高城市道路有效通行能力、提升城市居民出行体验最简单、最可行的方法。一方面，随着工业技术的不断成熟，道路传感器能够有效地提供高质量的道路信息，另一方面，随着图神经网络的不断发展，图神经网络展现出强大的数据特征提取能力，结合数据挖掘技术，对海量的、杂乱无章的、不清晰的并且随机性很大的数据进行挖掘，找到其中蕴含的有规律并且有价值和能够理解应用的知识，为解决交通预测问题带来了新的机遇。交通流预测问题是一个典型的时空数据建模问题，良好的交通流预测方法可以为城市居民提供准确的预测信息，从而更好地建设智能交通系统，迄今为止，交通预测已经取得了显著的成果。这些方法可以分为三类:统计方法、基于机器学习的方法和基于深度学习的方法。统计方法，如历史平均，自回归综合移动平均，向量自回归。基于机器学习的方法，如支持向量回归和随机森林回归。这些方法都将交通预测问题视为时间序列预测问题。随着深度学习的发展，循环神经网络及其变体长短期记忆网络和卷积神经网络也被应用到交通流预测中。然而，CNN不能充分地模拟道路网络。受到图卷积神经网络的启发，很多的工作开始研究如何在交通预测中对时空图进行建模。然而，简单图的主要缺点是它们只能描述节点对之间的关系，在这种情况下，无法在空间维度上分析跨路网的多个关键交通交叉口之间的关联关系。因此，如何构建基于交通信息的超图，提取高阶交通特征仍然是一个值得研究的领域。发明内容本发明要克服现有技术的上述缺点，提供一种基于时空超图神经网络的交通流预测方法。本发明正是结合大数据与人工智能的方法对城市路网中多个道路包含的交通信息数据进行时空建模，并实现城市的交通流预测，从而可以掌握城市路网中道路未来一段时间的变化，了解整个城市的脉搏，对建设智能交通系统具有重要的实际意义。本发明是通过以下技术方案达到上述目的：一种基于时空超图神经网络的交通流预测方法，其特征在于包括如下步骤：将道路传感器节点视为图节点，传感器上的交通信息视为节点属性，对交通信息进行超图结构数据表示，并进行问题定义；将交通数据在空间维度呈现出的局部相关性和跨路网同构性利用超图统一起，并基于超图的双通道超图卷积来捕获交通数据中的高阶空间关系，获得交通数据的空间特征表示；联合步骤所得的空间特征，利用一个带有卷积模块的长短时记忆网络来处理交通数据在时间维度呈现出的周期性漂移和随机干扰，从而获得交通数据的时空特征表示；联合步骤所得的时空特征，确定用于交通流预测的时空超图神经网络模型，并在两个不同地区的真实交通数据集进行实验验证，最终确定时空超图神经网络模型的有效性；采用步骤确定的时空超图神经网络模型，用于交通流量预测。进一步，所述步骤具体包括如下步骤：1a).将原始交通数据进行标准化处理，将路网进行图表示G＝,V表示所有道路集合，E表示边集合，W是权重邻接矩阵，表示节点之间的连接，矩阵中的元素取值范围在0到1之间；1b).将不同道路的交通数据按五分钟为单元进行统计，表示为节点的特征矩阵h表示历史时间长度，N表示节点个数。首先利用K-Means聚类算法对特征矩阵进行聚类，实现从全局上捕捉高相关性的节点构建超图H，进而根据W所表示的节点连接关系将超图进行扩展，充分统一交通数据在空间上呈现的局部相关性与跨路网同构性；1c).联合步骤1b)中得到的超图，构建基于超图的线图L，捕捉超图中多个超边之间的关系，对交通节点之间多对多的空间关系进行表示；1d).给定道路网路网G，特征矩阵旨在找到一个能够从历史交通信息学习时空特征的映射函数使之能够预测接下来的交通信息。进一步，所述步骤具体包括如下步骤：2a).按照步骤统计所得到的交通数据以及图结构数据进行特征提取，通过研究表征超图与线图的拉普拉斯矩阵，将图卷积神经网络公式扩展到超图卷积神经网络与线图卷积神经网络中；2b).联合步骤得到的超图H＝，其中VH是一个包含N个顶点的有限集，EH是一个包含M个超边的有限集，每个超边被赋予一个非负权值w，所有权值构成一个对角矩阵WH∈RM×M。超图的结构可以用相关矩阵H∈RN×M来描述，其中h＝1，如果超边e包含顶点v，否则为0。对于每个顶点v∈VH和每个超边e∈EH，它们的度可以被定义为和DV表示每个顶点的对角矩阵和De表示每个超图的对角矩阵。定义超图拉普拉斯矩阵Δ为：其中I表示单位矩阵；根据分层图卷积的思想，超图卷积可以被定义为：其中P和是第l层的可学习的参数矩阵。2c).联合步骤得到的线图，给定一个超图H＝超图的线图L＝是一个简单图，L的每一个节点是超图中的一条超边，如果相应的超边在超图中至少共享一个共同的顶点，则L的两个节点有连接。对于L中的每两个节点ei和ej，权值矩阵线图中的节点数与超图中的超边数相同。因此，在提取节点多对多关系的同时，达到融合关键流量节点影响的目的。有必要将线形图中的节点与超图中的节点关联起来。因此，本发明设计了一个自学习注意矩阵WA∈RN×M来学习超边与道路节点的映射关系。进一步地，线图卷积可以表示为：其中为自环线图的权重矩阵，为对角矩阵，为第l层的可学习参数矩阵；2d).联合步骤和得到的泛化图卷积公式，一种双层双通道超图卷积来嵌入交通数据的空间特征。特征矩阵X经过第一层超图卷积和线图卷积后，可以得到同维的嵌入向量。然后将第一层的线/超图卷积结果输入到第二层的超图/线图卷积，可以表示为：其中通过交换两个卷积学习到的信息，在提取交通节点之间的多对多关系的同时得到关键流量节点之间的影响，对交通数据的空间特征进行充分表征。进一步，所述步骤具体包括如下步骤：3a).结合步骤中所得到的空间特征表示，首先采用线性投影构建空间特征输出层，使其能够输入到带有卷积模块的LSTM网络中；Z＝ZWO 其中WO是可学习的网络参数；3b).本发明可以通过双通道超图卷积得到完整的空间特征，而传统的LSTM只能处理单个节点的时间序列变量。因此，直接将空间特征输入到LSTM中会失去空间关系。CNN可以通过卷积核增加感知视场，进而捕获局部空间特征。在LSTM中嵌入CNN使得LSTM可以同时考虑多个节点的时间信息，从而提取时间特征，可以表示为：其中表示阿达玛积，表示矩阵对应元素相乘，*表示CNN卷积操作，σ表示sigmoid激活函数。输入X1…Xt,cell输出C1…Ct，隐藏状态H1…Ht三维张量，可以直接进行卷积运算。Wh、Wx、Wc、和b为各层的可学习参数；3c).结合步骤所得空间特征和步骤提取时间特征的方法，构建出交通数据时空特征。进一步，所述步骤具体包括如下步骤：4a).结合步骤所提取的交通数据时空特征，确定用于交通流预测的时空超图神经网络模型，构建出损失函数，进行时空超图神经网络模型的训练和参数的优化。其中N表示采样个数，Yi和表示真实交通信息值和预测交通信息值；4b).为了评估时空超图神经网络模型的预测性能，选择平均绝对误差、平均绝对百分比误差和均方根误差作为指标。对于MAE、RMSE和MAPE指标，值越小表示预测性能越好；4c).为了验证双通道超图卷积的有效性，本发明设计了三个消融实验，将双通道超图卷积模块替换为图卷积模块的GSTHNN,将双通道超图卷积模块替换为超图卷积模块的HSTHNN和将双通道超图卷积模块替换为线图卷积模块的LSTHNN，并进行实验验证。4d).将两个不同地区的真实交通数据集输入模型，并采用批处理的方式进行训练，观察模型的表现性能。最终，可以得到具有表征交通数据空间特征和时间趋势的时空超图神经网络模型，并应用于交通流预测；本发明的创新之处在于：提出了一种交通数据的超图构造方法。它可以从全局到局部建模空间关系，发现隐藏在交通数据中的复杂的跨路网同构关系。提出了一种双通道超图卷积方法。超图研究节点之间的高阶关系，线图研究超边之间的关系。线形图与超图卷积的融合可以充分表征路网中多对多的空间关系。在美国两个真实的交通数据集上验证模型的有效性。本发明的优点是：将交通数据空间维度上表现的局部相关性与跨路网同构性通过超图统一起来，进行直接建模。利用基于超图的双通道卷积，模型在提取节点间高阶空间关系的同时，还能够学习到超边与节点之间的关系。附图说明图1是本发明的整体流程图。图2～图2是不同的K值下时空超图神经网络模型在PEMSM数据集实例中评价指标变化的结果图，其中图2是不同的K值下时空超图神经网络模型的评价指标MAE的变化，图2是不同的K值下时空超图神经网络模型的评价指标MAPE的变化，图2是不同的K值下时空超图神经网络模型的评价指标RMSE的变化。图3～图3是不同的K值下时空超图神经网络模型在PEMSBAY数据集实例中评价指标变化的结果图，其中图3是不同的K值下时空超图神经网络模型的评价指标MAE的变化，图3是不同的K值下时空超图神经网络模型的评价指标MAPE的变化，图3是不同的K值下时空超图神经网络模型的评价指标RMSE的变化。图4～图4是本发明在PEMSBAY数据集实例中的实验结果图，其中图4是不同卷积通道下的时空超图神经网络模型在训练集损失函数的变化，图4是不同卷积通道下的时空超图神经网络模型验证集损失函数的变化，图5～图5是本发明在PEMSM数据集实例中的实验结果图,其中，图5是是不同卷积通道下的时空超图神经网络模型在训练集损失函数的变化，图5是不同卷积通道下的时空超图神经网络模型验证集损失函数的变化。图6～图6是本发明在两个数据集实例中的实验结果图。图6是不同卷积通道下的时空超图神经网络模型在PEMSM数据集上三种评价指标的柱状图。图6是不同卷积通道下的时空超图神经网络模型在PEMSBAY数据集上三种评价指标的柱状图，具体实施方式下面结合交通流预测实例对本发明进行进一步描述。本实例中的交通流预测方法整体框架如图1所示，具体包括以下步骤：本发明所用到的数据集统计如下：两个交通数据集均来自加利福尼亚交通部性能测量系统PEMSM它包含了加州第七区228个道路传感器上的交通速度。此外，所有部署在道路上的传感器的读数被汇总成5分钟的窗口。本发明使用的是2012年5月1日至2012年6月30日的工作日数据。PEMSBAY。它包含了海湾地区325个道路传感器的交通速度。此外，所有部署在道路上的传感器的读数也被聚合成5分钟窗口。本发明使用的是2017年3月6日至2017年5月5日的工作日数据。以交通速度为例，利用两个地区的特征矩阵和路网连接关系构建出超图和线图：a).超图构造：超图H＝，其中VH是一个包含N个顶点的有限集，EH是一个包含M个超边的有限集，每个超边被赋予一个非负权值w，所有权值构成一个对角矩阵WH∈RM×M。超图的结构可以用相关矩阵H∈RN×M来描述，其中h＝1，如果超边e包含顶点v，否则为0。对于每个顶点v∈VH和每个超边e∈EH，它们的度可以被定义为和DV表示每个顶点的对角矩阵和De表示每个超图的对角矩阵。首先利用K-Means聚类算法对特征矩阵进行聚类，实现从全局上捕捉高相关性的节点构建超图H，进而根据W所表示的节点连接关系将超图进行扩展，充分统一交通数据在空间上呈现的局部相关性与跨路网同构性，路网中道路按照关联性强弱被分为多类，最终得到表征节点之间关系的超图，随后利用邻接关系超图进行扩展，K-Means聚类算法中一个比较重要的步骤是确定K值，本发明根据实验效果确定最后的K值。b).线图构造：给定一个超图H＝超图的线图L＝是一个简单图，L的每一个节点是超图中的一条超边，如果相应的超边在超图中至少共享一个共同的顶点，则L的两个节点有连接。对于L中的每两个节点ei和ej，权值矩阵在构建超图和线图以后，需要采用双通道超图卷积算法进行空间特征提取，定义超图拉普拉斯矩阵Δ为：其中I表示单位矩阵；根据分层图卷积的思想，超图卷积可以被定义为：其中P和是第l层的可学习的参数矩阵；线图卷积可以表示为：其中为自环线图的权重矩阵，为对角矩阵，Q、为第l层的可学习参数矩阵；特征矩阵X经过第一层超图卷积和线图卷积后，可以得到同维的嵌入向量。然后将第一层的线/超图卷积结果输入到第二层的超图/线图卷积，可以表示为：其中通过交换两个卷积学习到的信息，在提取交通节点之间的多对多关系的同时得到关键流量节点之间的影响，对交通数据的空间特征进行充分表征。将超图学习到的特征与线图学习到的特征进行交换，捕捉道路节点之间高阶的空间特征关系，对于捕捉交通数据在空间维度上表现的局部相关性和跨路网同构性具有重要意义。在双通道超图卷积提取空间特征之后，采用带有卷积模块的LSTM网络提取时间特征，具体包括如下步骤：a).首先采用线性投影构建空间特征输出层，使其能够输入到带有卷积模块的LSTM网络中；Z＝ZWO 其中WO是可学习的网络参数；b).本发明可以通过双通道超图卷积得到完整的空间特征，而传统的LSTM只能处理单个节点的时间序列变量。因此，直接将空间特征输入到LSTM中会失去空间关系。CNN可以通过卷积核增加感知视场，进而捕获局部空间特征。在LSTM中嵌入CNN使得LSTM可以同时考虑多个节点的时间信息，从而提取时间特征，可以表示为：其中表示阿达玛积，表示矩阵对应元素相乘，*表示CNN卷积操作，σ表示sigmoid激活函数。输入X1…Xt,cell输出C1…Ct，隐藏状态H1…Ht三维张量，可以直接进行卷积运算。Wh、Wx、Wc、和b为各层的可学习参数；c).结合步骤所得空间特征和步骤提取时间特征的方法，构建出交通数据时空特征。d)结合步骤所提取的交通数据时空特征，确定用于交通流预测的时空超图神经网络模型，构建出损失函数，进行时空超图神经网络模型的训练和参数的优化。其中N表示采样个数，Yi和表示真实交通信息值和预测交通信息值；在两个真实的交通数据集上进行时空超图神经网络模型性能评估：a).不同的K值，在构造超图的过程中，确定K-means聚类算法中的K值是一个关键步骤。一个重要的共识是，K-means算法中的K值不能超过道路节点的数量。因此，对于PEMSM数据集和PEMSBAY数据集，本发明分别从和中选取K的个数来分析预测精度的变化。结果如图2和图3所示。随着K值的增加，预测精度增加，这意味着本发明的想法的有效性。然而，当拐点出现时，随着K值的不断增大，预测精度反而下降。一种可能的解释是，过多的超边会逐渐将超图转换成一个简单的图。举个最直观的例子，本发明选择K值作为道路节点的数量。在此条件下，每个节点都包含在超边中。然后利用路网的物理连接对超边进行扩展，得到一个简单的图。因此，对于PEMSM和PEMSBAY数据集，本发明分别选择K＝16和K＝128。b).不同的卷积通道，为了证明双通道超图卷积的效果，本发明设计了三个消融实验。三个消融实验的训练过程如图4和图5所示。随着训练历元数目的增加，训练集损失和验证集损失继续减少，说明模型正在从数据中学习时空特征，没有出现过拟合或欠拟合现象。同时，各变体的预测效果如图6所示。对于PEMSM数据集来说，简单的图卷积也可以取得很好的效果，这是因为在设计该数据集的带权值的邻接矩阵时，需要筛选大量的流量节点，以保证邻接矩阵的最大特征值约为2。这样可以保证分层图卷积的高效性。对于PEMSM和PEMSBAY这两个数据集，仅使用超图卷积的效果不明显。这是因为在提取节点间高阶空间关系时，本发明需要保证模型能够学习到超边与节点之间的关系。只有这样，本发明才能充分发现隐藏在交通数据空间维度上的复杂局部相关性和跨路网同构性。两种方法的性能都不如STHNN，说明了双通道超图卷积的有效性。本发明采用真实世界的交通数据集对时空超图神经网络模型进行性能评估，最终确定时空超图神经网络模型的有效性，并用于交通流预测。实验表明本发明对于处理类似问题具有出色表现。
