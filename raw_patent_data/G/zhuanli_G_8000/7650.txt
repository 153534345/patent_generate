标题title
一种基于movebase的路径循迹方法及终端
摘要abst
本发明提供的一种基于movebase的路径循迹方法及终端，包括步骤：获取循迹轨迹点；对每个所述循迹轨迹点逐一分析，得到每个所述循迹轨迹点的状态，所述状态包括直道、弯道和入弯；根据车辆当前的所在位置点，计算与所有所述循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；向movebase发送目标点Pt，由movebase根据上述步骤得到的各所述循迹轨迹点的状态，规划Pc到Pt的路径。本发明通过确定循迹路径上每个轨迹点是直道、入弯还是弯道的不同状态，结合车辆当前不断变化的位置点，得到车辆当前所在的最近轨迹点Pc，并随着车辆的移动向movebase不停发送不同的目标点Pt，从而得到Pc与Pt间的实时路径，实现精准的路径循迹，有效解决非直线的轨迹点路径循迹。
权利要求书clms
1.一种基于movebase的路径循迹方法，其特征在于，包括步骤：S1、获取循迹轨迹点；S2、对每个所述循迹轨迹点逐一分析，得到每个所述循迹轨迹点的状态，所述状态包括直道、弯道和入弯；S3、根据车辆当前的所在位置点，计算与所有所述循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；S4、向movebase发送目标点Pt，由movebase根据步骤S2中得到的各所述循迹轨迹点的状态，规划Pc到Pt的路径。2.根据权利要求1所述的一种基于movebase的路径循迹方法，其特征在于，所述步骤S1还包括：为获取的每个所述循迹轨迹点标号{P1，…，Pi-1，Pi，Pi+1，…，Pn}，下标数字增加为向前，下表数字减少为向后；所述步骤S2具体为：S21、设置P1点和Pn点为弯道；对除P1点和Pn点以外的任一点Pi向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于第一门限值m的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的向前点Px，若Pi向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于第一门限值m的条件时，则直接将Pn作为Pi的向前点Px；对Pi向后依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于所述第一门限值m的条件时，确定此时最后一个向后进行欧氏距离计算的所述循迹轨迹点为Pi的向后点Py，若Pi后前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于所述第一门限值m的条件时，则直接将P1作为Pi的向后点Py；根据Py、Pi和Px三点确定Pi的曲率半径Ri；S22、对Pi点向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于预设的第二门限值d的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的邻近点Pj，其中所述第一门限值m大于所述第二门限值d；S23、对Pj重复步骤S21中对Pi的操作，得到Pj的向前点Px'和向后点Py'，根据Px'、Pj和Py'三点确定Pj的曲率半径Rj；S24、根据Ri和Rj确定Pi点的状态。3.根据权利要求2所述的一种基于movebase的路径循迹方法，其特征在于，所述步骤S24具体为：S241、若Ri大于预设的门限半径r，则记Ri为直，否则为曲，若Rj大于门限半径r，则记Rj为直，否则为曲；S242、若Ri为曲、Rj为曲，则Pi为弯道；若Ri为曲、Rj为直，则Pi为直道；若Ri为直、Rj为直，则Pi为直道；若Ri为直、Rj为曲，则Pi为入弯。4.根据权利要求1所述的一种基于movebase的路径循迹方法，其特征在于，所述步骤S3和步骤S4之间还包括：获取目标点Pt，具体为：从Pc开始向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，直到累加的欧氏距离达到大于或等于门限参数的条件时，则确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为目标点Pt，所述门限参数包括直道参数a、入弯参数b和弯道参数c，所述门限参数的选取根据Pc的状态而定，其中a＞b＞c。5.根据权利要求4述的一种基于movebase的路径循迹方法，其特征在于，所述步骤S3和步骤S4之间还包括：若存在从Pc向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍不满足任一所述门限参数的情况时，则直接将所述循迹轨迹点中的最后一个点Pn作为目标点Pt。6.一种基于movebase的路径循迹终端，其特征在于，包括存储器、处理器和存储在存储器上并可在处理器上运行的计算机程序，所述处理器在执行所述计算机程序时实现以下步骤：S1、获取循迹轨迹点；S2、对每个所述循迹轨迹点逐一分析，得到每个所述循迹轨迹点的状态，所述状态包括直道、弯道和入弯；S3、根据车辆当前的所在位置点，计算与所有所述循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；S4、向movebase发送目标点Pt，由movebase根据步骤S2中得到的各所述循迹轨迹点的状态，规划Pc到Pt的路径。7.根据权利要求6所述的一种基于movebase的路径循迹终端，其特征在于，所述步骤S1还包括：为获取的每个所述循迹轨迹点标号{P1，…，Pi-1，Pi，Pi+1，…，Pn}，下标数字增加为向前，下表数字减少为向后；所述步骤S2具体为：S21、设置P1点和Pn点为弯道；对除P1点和Pn点以外的任一点Pi向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于第一门限值m的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的向前点Px，若Pi向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于第一门限值m的条件时，则直接将Pn作为Pi的向前点Px；对Pi向后依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于所述第一门限值m的条件时，确定此时最后一个向后进行欧氏距离计算的所述循迹轨迹点为Pi的向后点Py，若Pi后前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于所述第一门限值m的条件时，则直接将P1作为Pi的向后点Py；根据Py、Pi和Px三点确定Pi的曲率半径Ri；S22、对Pi点向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于预设的第二门限值d的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的邻近点Pj，其中所述第一门限值m大于所述第二门限值d；S23、对Pj重复步骤S21中对Pi的操作，得到Pj的向前点Px'和向后点Py'，根据Px'、Pj和Py'三点确定Pj的曲率半径Rj；S24、根据Ri和Rj确定Pi点的状态。8.根据权利要求7所述的一种基于movebase的路径循迹终端，其特征在于，所述步骤S24具体为：S241、若Ri大于预设的门限半径r，则记Ri为直，否则为曲，若Rj大于门限半径r，则记Rj为直，否则为曲；S242、若Ri为曲、Rj为曲，则Pi为弯道；若Ri为曲、Rj为直，则Pi为直道；若Ri为直、Rj为直，则Pi为直道；若Ri为直、Rj为曲，则Pi为入弯。9.根据权利要求6所述的一种基于movebase的路径循迹终端，其特征在于，所述步骤S3和步骤S4之间还包括：获取目标点Pt，具体为：从Pc开始向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，直到累加的欧氏距离达到大于或等于门限参数的条件时，则确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为目标点Pt，所述门限参数包括直道参数a、入弯参数b和弯道参数c，所述门限参数的选取根据Pc的状态而定，其中a＞b＞c。10.根据权利要求9所述的一种基于movebase的路径循迹终端，其特征在于，所述步骤S3和步骤S4之间还包括：若存在从Pc向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍不满足任一所述门限参数的情况时，则直接将所述循迹轨迹点中的最后一个点Pn作为目标点Pt。
说明书desc
技术领域本发明涉及路径规划技术领域，具体涉及一种基于movebase的路径循迹方法及终端。背景技术基于movebase做路径规划过程中，对于已经取好的循迹轨迹点，可能呈现不同的形状，若是一条直线，则将直线末端作为目标点即可完成本地循迹，但是如果循迹轨迹点的轨迹路径是蜿蜒曲折或者存在交叉，则目标点不能简单的直接用最后的位置作为目标点，否则无法完成轨迹的循迹。发明内容本发明所要解决的技术问题是：提供一种基于movebase的路径循迹方法及终端，解决非直线的轨迹点路径循迹。为了解决上述技术问题，本发明采用的技术方案为：一种基于movebase的路径循迹方法，包括步骤：S1、获取循迹轨迹点；S2、对每个所述循迹轨迹点逐一分析，得到每个所述循迹轨迹点的状态，所述状态包括直道、弯道和入弯；S3、根据车辆当前的所在位置点，计算与所有所述循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；S4、向movebase发送目标点Pt，由movebase根据步骤S2中得到的各所述循迹轨迹点的状态，规划Pc到Pt的路径。为了解决上述技术问题，本发明提供的另一个技术方案为：一种基于movebase的路径循迹终端，包括存储器、处理器以及存储在存储器上并可在处理器上执行的计算机程序，所述处理器执行所述计算机程序时实现以下步骤：S1、获取循迹轨迹点；S2、对每个所述循迹轨迹点逐一分析，得到每个所述循迹轨迹点的状态，所述状态包括直道、弯道和入弯；S3、根据车辆当前的所在位置点，计算与所有所述循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；S4、向movebase发送目标点Pt，由movebase根据步骤S2中得到的各所述循迹轨迹点的状态，规划Pc到Pt的路径。本发明的有益效果在于：本发明提供一种基于movebase的路径循迹方法及终端，通过确定循迹路径上每个轨迹点是直道、入弯还是弯道的不同状态，结合车辆当前不断变化的位置点，得到车辆当前所在的最近轨迹点Pc，并随着车辆的移动向movebase不停发送不同的目标点Pt，从而得到Pc与Pt间的实时路径，实现精准的路径循迹，有效解决非直线的轨迹点路径循迹。附图说明图1为本发明实施例的一种基于movebase的路径循迹方法的流程图；图2为本发明实施例的一种基于movebase的路径循迹终端的结构示意图。标号说明：1、一种基于movebase的路径循迹终端；2、存储器；3、处理器。具体实施方式为详细说明本发明的技术内容、所实现目的及效果，以下结合实施方式并配合附图予以说明。请参照图1，一种基于movebase的路径循迹方法，包括步骤：S1、获取循迹轨迹点；S2、对每个所述循迹轨迹点逐一分析，得到每个所述循迹轨迹点的状态，所述状态包括直道、弯道和入弯；S3、根据车辆当前的所在位置点，计算与所有所述循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；S4、向movebase发送目标点Pt，由movebase根据步骤S2中得到的各所述循迹轨迹点的状态，规划Pc到Pt的路径。由上述描述可知，本发明的有益效果在于：通过确定循迹路径上每个轨迹点是直道、入弯还是弯道的不同状态，结合车辆当前不断变化的位置点，得到车辆当前所在的最近轨迹点Pc，并随着车辆的移动向movebase不停发送不同的目标点Pt，从而得到Pc与Pt间的实时路径，实现精准的路径循迹，有效解决非直线的轨迹点路径循迹。进一步地，所述步骤S1还包括：为获取的每个所述循迹轨迹点标号{P1，…，Pi-1，Pi，Pi+1，…，Pn}，下标数字增加为向前，下表数字减少为向后；所述步骤S2具体为：S21、设置P1点和Pn点为弯道；对除P1点和Pn点以外的任一点Pi向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于第一门限值m的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的向前点Px，若Pi向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于第一门限值m的条件时，则直接将Pn作为Pi的向前点Px；对Pi向后依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于所述第一门限值m的条件时，确定此时最后一个向后进行欧氏距离计算的所述循迹轨迹点为Pi的向后点Py，若Pi后前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于所述第一门限值m的条件时，则直接将P1作为Pi的向后点Py；根据Py、Pi和Px三点确定Pi的曲率半径Ri；S22、对Pi点向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于预设的第二门限值d的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的邻近点Pj，其中所述第一门限值m大于所述第二门限值d；S23、对Pj重复步骤S21中对Pi的操作，得到Pj的向前点Px'和向后点Py'，根据Px'、Pj和Py'三点确定Pj的曲率半径Rj；S24、根据Ri和Rj确定Pi点的状态。由上述描述可知，对轨迹点进行顺序标号，便于后续分析每个轨迹点；对于任一轨迹点Pi的状态，可以通过其与向前点、向后点三点确定曲率半径后，由曲率半径确定该点的状态，但是仅通过一个曲率半径确定某个位置的状态不太可靠，因此再取与该点比较靠近的邻近点，计算邻近点的曲率半径，通过两个曲率半径确定Pi点的状态，更为精准。进一步地，所述步骤S24具体为：S241、若Ri大于预设的门限半径r，则记Ri为直，否则为曲，若Rj大于门限半径r，则记Rj为直，否则为曲；S242、若Ri为曲、Rj为曲，则Pi为弯道；若Ri为曲、Rj为直，则Pi为直道；若Ri为直、Rj为直，则Pi为直道；若Ri为直、Rj为曲，则Pi为入弯。由上述描述可知，由两个曲率半径的关系确定得到Pi点的状态是直道、入弯还是弯道，更为精准，进一步减少后续路径规划误差。进一步地，所述步骤S3和步骤S4之间还包括：获取目标点Pt，具体为：从Pc开始向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，直到累加的欧氏距离达到大于或等于门限参数的条件时，则确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为目标点Pt，所述门限参数包括直道参数a、入弯参数b和弯道参数c，所述门限参数的选取根据Pc的状态而定，其中a＞b＞c。由上述描述可知，由于循迹轨迹点是在事先的车辆行驶过程中记录下的路径轨迹点，因此当车辆此刻再次沿着先前的轨迹行驶时，根据车辆当前行进到的位置匹配最近的轨迹点Pc后，即可针对具体的Pc点的状态来选择不同的门限参数，随着车辆的行进也会不断地确定不同的目标点Pt发送给movebase，以便movebase实时规划出Pc到Pt的路径。进一步地，所述步骤S3和步骤S4之间还包括：若存在从Pc向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍不满足任一所述门限参数的情况时，则直接将所述循迹轨迹点中的最后一个点Pn作为目标点Pt。由上述描述可知，Pc点向前累加的欧氏距离不满足任一门限参数，即表示此刻车辆接近终点，因此可直接将最后一个点Pn作为目标点Pt。请参照图2，一种基于movebase的路径循迹终端，包括存储器、处理器和存储在存储器上并可在处理器上运行的计算机程序，所述处理器在执行所述计算机程序时实现以下步骤：S1、获取循迹轨迹点；S2、对每个所述循迹轨迹点逐一分析，得到每个所述循迹轨迹点的状态，所述状态包括直道、弯道和入弯；S3、根据车辆当前的所在位置点，计算与所有所述循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；S4、向movebase发送目标点Pt，由movebase根据步骤S2中得到的各所述循迹轨迹点的状态，规划Pc到Pt的路径。由上述描述可知，本发明的有益效果在于：基于同一技术构思，配合上述的一种基于movebase的路径循迹方法，提供一种基于movebase的路径循迹终端，通过确定循迹路径上每个轨迹点是直道、入弯还是弯道的不同状态，结合车辆当前不断变化的位置点，得到车辆当前所在的最近轨迹点Pc，并随着车辆的移动向movebase不停发送不同的目标点Pt，从而得到Pc与Pt间的实时路径，实现精准的路径循迹，有效解决非直线的轨迹点路径循迹。进一步地，所述步骤S1还包括：为获取的每个所述循迹轨迹点标号{P1，…，Pi-1，Pi，Pi+1，…，Pn}，下标数字增加为向前，下表数字减少为向后；所述步骤S2具体为：S21、设置P1点和Pn点为弯道；对除P1点和Pn点以外的任一点Pi向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于第一门限值m的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的向前点Px，若Pi向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于第一门限值m的条件时，则直接将Pn作为Pi的向前点Px；对Pi向后依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于所述第一门限值m的条件时，确定此时最后一个向后进行欧氏距离计算的所述循迹轨迹点为Pi的向后点Py，若Pi后前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍未达到大于或等于所述第一门限值m的条件时，则直接将P1作为Pi的向后点Py；根据Py、Pi和Px三点确定Pi的曲率半径Ri；S22、对Pi点向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于预设的第二门限值d的条件时，确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为Pi的邻近点Pj，其中所述第一门限值m大于所述第二门限值d；S23、对Pj重复步骤S21中对Pi的操作，得到Pj的向前点Px'和向后点Py'，根据Px'、Pj和Py'三点确定Pj的曲率半径Rj；S24、根据Ri和Rj确定Pi点的状态。由上述描述可知，对轨迹点进行顺序标号，便于后续分析每个轨迹点；对于任一轨迹点Pi的状态，可以通过其与向前点、向后点三点确定曲率半径后，由曲率半径确定该点的状态，但是仅通过一个曲率半径确定某个位置的状态不太可靠，因此再取与该点比较靠近的邻近点，计算邻近点的曲率半径，通过两个曲率半径确定Pi点的状态，更为精准。进一步地，所述步骤S24具体为：S241、若Ri大于预设的门限半径r，则记Ri为直，否则为曲，若Rj大于门限半径r，则记Rj为直，否则为曲；S242、若Ri为曲、Rj为曲，则Pi为弯道；若Ri为曲、Rj为直，则Pi为直道；若Ri为直、Rj为直，则Pi为直道；若Ri为直、Rj为曲，则Pi为入弯。由上述描述可知，由两个曲率半径的关系确定得到Pi点的状态是直道、入弯还是弯道，更为精准，进一步减少后续路径规划误差。进一步地，所述步骤S3和步骤S4之间还包括：获取目标点Pt，具体为：从Pc开始向前依次计算每相邻的两个所述循迹轨迹点的欧氏距离并累加，直到累加的欧氏距离达到大于或等于门限参数的条件时，则确定此时最后一个向前进行欧氏距离计算的所述循迹轨迹点为目标点Pt，所述门限参数包括直道参数a、入弯参数b和弯道参数c，所述门限参数的选取根据Pc的状态而定，其中a＞b＞c。由上述描述可知，由于循迹轨迹点是在事先的车辆行驶过程中记录下的路径轨迹点，因此当车辆此刻再次沿着先前的轨迹行驶时，根据车辆当前行进到的位置匹配最近的轨迹点Pc后，即可针对具体的Pc点的状态来选择不同的门限参数，随着车辆的行进也会不断地确定不同的目标点Pt发送给movebase，以便movebase实时规划出Pc到Pt的路径。进一步地，所述步骤S3和步骤S4之间还包括：若存在从Pc向前依次计算的所有相邻的所述循迹轨迹点的欧式距离累加后仍不满足任一所述门限参数的情况时，则直接将所述循迹轨迹点中的最后一个点Pn作为目标点Pt。由上述描述可知，Pc点向前累加的欧氏距离不满足任一门限参数，即表示此刻车辆接近终点，因此可直接将最后一个点Pn作为目标点Pt。本发明的一种基于movebase的路径循迹方法及终端，适用于车辆行进过程中对目标点的循迹路径规划，以下结合具体实施例进行说明：请参照图1，本发明的实施例一为：一种基于movebase的路径循迹方法，包括步骤：S1、获取循迹轨迹点；S2、对每个循迹轨迹点逐一分析，得到每个循迹轨迹点的状态，状态包括直道、弯道和入弯；S3、根据车辆当前的所在位置点，计算与所有循迹轨迹点的欧氏距离，得到距离最近的循迹轨迹点Pc；S4、向movebase发送目标点Pt，由movebase根据步骤S2中得到的各循迹轨迹点的状态，规划Pc到Pt的路径。即在本实施例中，通过确定循迹路径上每个轨迹点是直道、入弯还是弯道的不同状态，结合车辆当前不断变化的位置点，得到车辆当前所在的最近轨迹点Pc，并随着车辆的移动向movebase不停发送不同的目标点Pt，从而得到Pc与Pt间的实时路径，实现精准的路径循迹，有效解决非直线的轨迹点路径循迹。本发明的实施例二为：一种基于movebase的路径循迹方法，在上述实施例一的基础上，在本实施例中，所述步骤S1还包括：为获取的每个循迹轨迹点标号{P1，…，Pi-1，Pi，Pi+1，…，Pn}，下标数字增加为向前，下表数字减少为向后，即对轨迹点进行顺序标号，便于后续分析每个轨迹点。其中，在本实施例中，步骤S2具体为：S21、设置P1点和Pn点为弯道；对除P1点和Pn点以外的任一点Pi向前依次计算每相邻的两个循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于第一门限值m的条件时，确定此时最后一个向前进行欧氏距离计算的循迹轨迹点为Pi的向前点Px，若Pi向前依次计算的所有相邻的循迹轨迹点的欧式距离累加后仍未达到大于或等于第一门限值m的条件时，则直接将Pn作为Pi的向前点Px；对Pi向后依次计算每相邻的两个循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于第一门限值m的条件时，确定此时最后一个向后进行欧氏距离计算的循迹轨迹点为Pi的向后点Py，若Pi后前依次计算的所有相邻的循迹轨迹点的欧式距离累加后仍未达到大于或等于第一门限值m的条件时，则直接将P1作为Pi的向后点Py；根据Py、Pi和Px三点确定Pi的曲率半径Ri。即将第一个点和最后一个点直接设置为弯道状态，而对于其他任一点可通过寻找向前点和向后点，由三点确定该点的曲率半径，从而根据曲率半径确定该点是直道、入弯还是弯道状态，较为精准。其中，第一门限值m为可调参数，具体的值可根据不同环境下多次的测试经验设置。在本实施例中，累加欧式距离的计算具体描述如下：1.假设当前Pi点向前为Pi、Pi+1、Pi+2……，分别计算Pi与Pi+1、Pi+1与Pi+2、……的欧式距离，并将这些欧式距离相加的总和记为SumDis，当SumDis累加的值大于第一门限值m时，停止累加，此时截止的向前轨迹点即为向前点Px；同理向后点Py的确定也是如此。同时，在本实施例中，若在累加欧式距离的过程中未达到第一门限值m时就已经没有更多的向前轨迹点或向后轨迹点了，则直接将最后一个点Pn或第一个点P1作为向前点Px或向后点Py。S22、对Pi点向前依次计算每相邻的两个循迹轨迹点的欧氏距离并累加，当累加的欧氏距离达到大于或等于预设的第二门限值d的条件时，确定此时最后一个向前进行欧氏距离计算的循迹轨迹点为Pi的邻近点Pj，其中第一门限值m大于第二门限值d；S23、对Pj重复步骤S21中对Pi的操作，得到Pj的向前点Px'和向后点Py'，根据Px'、Pj和Py'三点确定Pj的曲率半径Rj。由于仅通过一个曲率半径判断任一点Pi的状态不太可靠，因此再取与Pi点邻近的邻近点Pj，重复上述步骤得到Pj点的曲率半径Rj，后续即可通过两个曲率半径确定Pi点的状态，更为精准，可进一步减少后续路径规划误差。其中，第二门限值d的值与第一门限值m一样，均为可调参数，可根据不同环境下多次的测试经验设置。S24、根据Ri和Rj确定Pi点的状态，在本实施例中，具体为：S241、若Ri大于预设的门限半径r，则记Ri为直，否则为曲，若Rj大于门限半径r，则记Rj为直，否则为曲；S242、若Ri为曲、Rj为曲，则Pi为弯道；若Ri为曲、Rj为直，则Pi为直道；若Ri为直、Rj为直，则Pi为直道；若Ri为直、Rj为曲，则Pi为入弯。即通过两个曲率半径来确定最终的Pi状态，得到的结果更为准确。其中门限半径r与第一门限值m和第二门限值d一样，均为根据不同环境下多次的测试经验设置的可调参数，在本实施例中，第一门限值m、第二门限值d和门限半径r的值可参考设置m为4米、d为3米以及r为80米。其中，在本实施例中，步骤S3和步骤S4之间还包括：获取目标点Pt，具体为：从Pc开始向前依次计算每相邻的两个循迹轨迹点的欧氏距离并累加，直到累加的欧氏距离达到大于或等于门限参数的条件时，则确定此时最后一个向前进行欧氏距离计算的循迹轨迹点为目标点Pt，门限参数包括直道参数a、入弯参数b和弯道参数c，门限参数的选取根据Pc的状态而定，其中a＞b＞c。即由于循迹轨迹点是在事先的车辆行驶过程中记录下的路径轨迹点，因此当车辆此刻再次沿着先前的轨迹行驶时，根据车辆当前行进到的位置匹配最近的轨迹点Pc后，即可针对具体的Pc点的状态来选择不同的门限参数，随着车辆的行进也会不断地确定不同的目标点Pt发送给movebase，以便movebase实时规划出Pc到Pt的路径。在本实施例中，门限参数选择的是直道参数a、入弯参数b还是弯道参数c具体是根据先前步骤S2中确定的循迹轨迹点中每个轨迹点的状态来决定的，例如若Pc点的状态为直道，则门限参数选择直道参数a，从而根据Pc点向前依次计算的累加欧氏距离是否大于直道参数a的来选取目标点Pt。另外，在本实施例中，步骤S3和步骤S4之间还包括：若存在从Pc向前依次计算的所有相邻的循迹轨迹点的欧式距离累加后仍不满足任一门限参数的情况时，则直接将循迹轨迹点中的最后一个点Pn作为目标点Pt。即累加的欧氏距离不满足任一门限参数，表示此刻车辆接近终点，因此可直接将最后一个点Pn作为目标点Pt，提高路径规划的效率。请参照图2，本发明的实施例三为：一种基于movebase的路径循迹终端1，包括存储器2、处理器3以及存储在存储器2上并可在处理器3上运行的计算机程序，处理器3在执行计算机程序时实现如上述实施例一或实施例二中的一种基于movebase的路径循迹方法中的步骤。综上所述，本发明提供的一种基于movebase的路径循迹方法及终端，可对不同的目标循迹轨迹点，判断其是直道、入弯或是弯道的区别状态，自动不停的发送不同的目标点给movebase，实现当前的到目标点的路径规划，减小循迹误差的同时提高路径规划效率。以上所述仅为本发明的实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等同变换，或直接或间接运用在相关的技术领域，均同理包括在本发明的专利保护范围内。
