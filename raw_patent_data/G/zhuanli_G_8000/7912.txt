标题title
兼顾精密和高效的力控运动控制方法及系统
摘要abst
本发明公开一种兼顾精密和高效的力控运动控制方法及系统，方法应用于具有PC端和总线伺服驱动器的执行机构；实现在不同精度要求下，分别使用软件运动控制器或者总线伺服驱动器来实现对力控运动的控制；方法包括以下步骤：对力控参数进行配置；根据力控精度要求选定执行机构的主要控制方式；当选定为总线伺服驱动器进行控制时，根据力控参数进行控制，能够以高精密水平完成对执行机构的力控过程，并且由软件运动控制器协同监控；当选定由PC端的软件运动控制器进行控制时，由PC端的软件运动控制器根据力控参数进行力控运动的控制，实现高效率完成对执行机构的力控过程，大大提升了动作的实时性和效率。
权利要求书clms
1.一种兼顾精密和高效的力控运动控制方法，其特征在于，应用于具有PC端和总线伺服驱动器的执行机构；包括以下步骤：对力控参数进行配置；获取配置中的力控精度要求，根据力控精度要求选定执行机构的主要控制方式；当选定为总线伺服驱动器进行控制时，根据所述力控参数进行控制；当选定为PC端进行控制时，由所述PC端的软件运动控制器根据所述力控参数进行力控运动控制。2.根据权利要求1所述的兼顾精密和高效的力控运动控制方法，其特征在于，设定力控精度的第一阈值为n牛；当所述力控精度属于区间时，选定所述总线伺服驱动器进行控制；当所述力控精度不属于区间时，选定所述软件运动控制器进行力控运动控制。3.根据权利要求2所述的兼顾精密和高效的力控运动控制方法，其特征在于，当选定为总线伺服驱动器进行力控运动控制时，所述软件运动控制器对所述力控运动以外的运动阶段进行监测。4.根据权利要求3所述的兼顾精密和高效的力控运动控制方法，其特征在于，在所述总线伺服驱动器进行力控运动控制时，循环读取执行机构上的力传感器的力反馈，并根据力反馈在电流控制器中进行精密控制。5.根据权利要求4所述的兼顾精密和高效的力控运动控制方法，其特征在于，在所述总线伺服驱动器进行力控运动控制时发生错误后，所述PC端的软件运动控制器对错误进行处理。6.根据权利要求1所述的兼顾精密和高效的力控运动控制方法，其特征在于，当所述软件运动控制器进行力控运动控制时，在实时API缓存区中录制力控程序，同时将电流限制值输入所述总线伺服驱动器；所述总线伺服驱动器循环读取电流反馈，并与所述电流限制值进行比较，以在电流控制器中进行力控限制。7.根据权利要求6所述的兼顾精密和高效的力控运动控制方法，其特征在于，在所述软件运行控制器进行力控运动控制时发生错误后，所述软件运行控制器对错误进行修正，并执行力控运动控制。8.根据权利要求6所述的兼顾精密和高效的力控运动控制方法，其特征在于，在获取电流限制值时，通过以下方法获得：在实时API缓存区中录制用户应用程序，执行机构根据第一位置指令从起始点运行到减速点，开始速度为0，命令速度为V0，结束速度为V1；执行机构再根据第二位置指令从起始点运行到减速点，开始速度为V1，命令速度为V1，结束速度为0；再将预设电流限制值写入所述总线伺服驱动器中，等待所述执行机构执行完成所述第二位置指令，则将所述预设电流限制值作为目标电流限制值写入所述总线伺服驱动器，并将所述执行结构返回起始点。9.一种兼顾精密和高效的力控运动控制系统，其特征在于，采用权利要求1-8任一项所述的方法；PC端的软件运动控制器包括共享内存的非实时操作系统和实时操作系统，所述非实时操作系统设置有控制接口模块、通讯接口模块，且力控参数的位置在所述非实时操作系统完成；所述实时操作系统包括电连接的实时控制内核、实时API缓存区和力控处理单元，所述实时API缓存区用于写入力控程序，所述力控处理单元用于执行力控控制；所述实时控制内核通过实时通讯内核连接总线伺服驱动器的实时总线接口；当选定为总线伺服驱动器进行控制时，所述总线伺服驱动器自主接收所述力控参数进行控制；当选定为软件运动控制器进行控制时，由所述API缓存区的力控程序进行力控运动控制。10.根据权利要求9所述的兼顾精密和高效的力控运动控制系统，其特征在于，所述总线伺服驱动器包括依次电连接的MCU微处理器、FPGA可编程逻辑处理单元，驱动逆变单元、电机动力接口；所述电机动力接口用于与伺服电机连接以驱动所述执行机构；所述总线伺服驱动器还包括力反馈单元和编码器反馈接口；所述力反馈单元用于接收所述执行机构上的力传感器的力反馈，所述编码器反馈接口用于接收伺服电机的位置编码器模块的返回信息。
说明书desc
技术领域本发明涉及精密自动化控制技术领域，尤其涉及一种兼顾精密和高效的力控运动控制方法及系统。背景技术在精密自动化控制领域，除了要对位置和速度进行控制之外，越来越多的半导体和3C电子组装场合要求对元件和芯片进行力的精密控制以实现良好的接触、安装精度和保护元件的作用。在现在的机器换人的自动化时代，机器已经可以在位置精度和速度上媲美人工，但是要想实现越来越多的精密装配应用场景，必须要找到非常好的力控解决方案。目前常用的方案一般有两种，一是在总线控制器上编程控制对电机的电流进行限制从而实现力控；二是伺服驱动器自行控制力控的整个动作流程，在其内部程序通过对电流反馈或者外部力传感器信号进行闭环处理来实现力控。这两个方案都有各自的应用场景和不足。一、在总线控制器上编程控制电机的电流，虽然控制流程很灵活，效率也很高，但是因为受制于总线控制周期不能太小，因此一般应用于对力控精度要求不是太高的场合，而且无法对力控在执行机构上的结果进行实时监控。此外，在总线控制器上一般在Windows系统上编程和运行，对精密力控的整个动作流程的实时性无法进行很好的保证，也就进一步影响到了力控的效果。二、由伺服驱动器自行控制力控的整个动作流程，在伺服驱动器内部程序通过对电流反馈或者外部力传感器信号进行闭环处理来实现力控的方案中，因为驱动器的电流环等算法周期短运行频率高，因此可以实现很高精度的力控，但是由于其整个控制流程对于外部控制器来说是黑盒子，难以灵活调整和修改，在流程中出了问题也很难同控制器端的程序进行即时的协同处理，在力控过程完成后又将控制权交回给控制器，因此增加了很多控制流程的复杂性和降低了控制效率。所以精密制备时如何适应多种不同工况要求进行控制是亟需解决的。发明内容针对上述技术中存在的现有技术中，对于不同工况要求如何达到最适合的控制方式的问题；本申请提供一种技术方案进行解决。为实现上述目的，本发明提供一种兼顾精密和高效的力控运动控制方法，应用于具有PC端和总线伺服驱动器的执行机构；包括以下步骤：对力控参数进行配置；获取配置中的力控精度要求，根据力控精度要求选定执行机构的主要控制方式；当选定为总线伺服驱动器进行控制时，根据所述力控参数进行控制；当选定为PC端进行控制时，由所述PC端的软件运动控制器根据所述力控参数进行力控运动控制。作为优选，设定力控精度的第一阈值为n牛；当所述力控精度属于区间时，选定所述总线伺服驱动器进行控制；当所述力控精度不属于区间时，选定所述软件运动控制器进行力控运动控制。作为优选，当选定为总线伺服驱动器进行力控运动控制时，所述PC端对所述力控运动以外的运动阶段进行监测。作为优选，在所述总线伺服驱动器进行力控运动控制时，循环读取执行机构上的力传感器的力反馈，并根据力反馈在电流控制器中进行精密控制。作为优选，在所述总线伺服驱动器进行力控运动控制时发生错误后，所述PC端的软件运动控制器对错误进行处理。作为优选，当所述软件运动控制器进行力控运动控制时，在实时API缓存区中录制力控程序，同时将电流限制值输入所述总线伺服驱动器；所述总线伺服驱动器循环读取电流反馈，并与所述电流限制值进行比较，以在电流控制器中进行力控限制。作为优选，在所述软件运行控制器进行力控运动控制时发生错误后，所述软件运行控制器对错误进行修正，并执行力控运动控制。作为优选，在获取电流限制值时，通过以下方法获得：在实时API缓存区中录制用户应用程序，执行机构根据第一位置指令从起始点运行到减速点，开始速度为0，命令速度为V0，结束速度为V1；执行机构再根据第二位置指令从起始点运行到减速点，开始速度为V1，命令速度为V1，结束速度为0；再将预设电流限制值写入所述总线伺服驱动器中，等待所述执行机构执行完成所述第二位置指令，则将所述预设电流限制值作为目标电流限制值写入所述总线伺服驱动器，并将所述执行结构返回起始点。还公开一种兼顾精密和高效的力控运动控制系统，采用上述的方法；PC端的软件运动控制器包括共享内存的非实时操作系统和实时操作系统，所述非实时操作系统设置有控制接口模块、通讯接口模块，且力控参数的位置在所述非实时操作系统完成；所述实时操作系统包括电连接的实时控制内核、实时API缓存区和力控处理单元，所述实时API缓存区用于写入力控程序，所述力控处理单元用于执行力控控制；所述实时控制内核通过实时通讯内核连接总线伺服驱动器的实时总线接口；当选定为总线伺服驱动器进行控制时，所述总线伺服驱动器自主接收所述力控参数进行控制；当选定为软件运动控制器进行控制时，由所述API缓存区的力控程序进行力控运动控制。作为优选，所述总线伺服驱动器包括依次电连接的MCU微处理器、FPGA可编程逻辑处理单元，驱动逆变单元、电机动力接口；所述电机动力接口用于与伺服电机连接以驱动所述执行机构；所述总线伺服驱动器还包括力反馈单元和编码器反馈接口；所述力反馈单元用于接收所述执行机构上的力传感器的力反馈，所述编码器反馈接口用于接收伺服电机的位置编码器模块的返回信息。本发明的有益效果是：本发明公开一种兼顾精密和高效的力控运动控制方法及系统，方法应用于具有PC端和总线伺服驱动器的执行机构；通过对力控精度要求高低不同的应用场景，分别使用PC端的软件运动控制器或者总线伺服驱动器来实现对力控运动运动的控制，以兼顾精密和高效；方法包括以下步骤：对力控参数进行配置；获取配置中的力控精度要求，根据力控精度要求选定执行机构的主要控制方式；当选定为总线伺服驱动器进行控制时，根据力控参数进行控制；该状态中，PC端的软件运动控制器虽然不参与控制过程，但是仍然实时监控所有流程，并可对外部力传感器的反馈信号进行监控和结果确认；当选定为PC端进行控制时，由PC端的软件运动控制器根据力控参数进行力控运动的控制，包含力控处理的用户应用程序在实时API缓存区中进行录制，且运行在实时操作系统中；由PC端的软件运动控制器根据力控参数进行力控运动的控制，实现高效率完成对执行机构的力控过程，大大提升了动作的实时性和效率。附图说明图1为本发明的方法流程图；图2为本发明的力控方法流程示意图；图3为本发明的总线伺服器内部原理架构图；图4为本发明的力控速度时间图；图5为本发明的力控控制过程示意图；图6为本发明系统架构图。具体实施方式为了更清楚地表述本发明，下面结合附图对本发明作进一步地描述。在下文描述中，给出了普选实例细节以便提供对本发明更为深入的理解。显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部实施例。应当理解所述具体实施例仅用以解释本发明，并不用于限定本发明。应当理解的是，当在本说明书中使用术语“包含”和/或“包括”时，其指明存在所述特征、整体、步骤、操作、元件或组件，但不排除存在或附加一个或多个其他特征、整体、步骤、操作、元件、组件或它们的组合。本发明公开一种兼顾精密和高效的力控运动控制方法，请参阅图1；应用于具有PC端和总线伺服驱动器的执行机构；包括以下步骤：对力控参数进行配置；获取配置中的力控精度要求，根据力控精度要求选定执行机构的主要控制方式；当选定为总线伺服驱动器进行控制时，根据力控参数进行控制；当选定为PC端进行控制时，由PC端的软件运动控制器根据力控参数进行力控运动控制。通过对力控精度要求高低不同的场合，分别使用PC端的软件运动控制器或者总线伺服驱动器来实现对力控运动的控制。值得说明的是，所谓PC端是具有运行、处理程序能力的一个终端，其可以是电脑PC或者是工控机。在本实施例中，设定力控精度的第一阈值为n牛，牛代表牛顿力学的单位，其力控精度要求可以用牛顿力进行表征；当力控精度属于区间时，选定总线伺服驱动器进行控制；当力控精度不属于区间时，选定软件运动控制器进行力控运动控制。在整个系统实施过程，总线伺服驱动器是直连执行结构的，PC端是连接总线伺服驱动器的，那么总线伺服驱动器直接进行力控运动控制时，其主要参数和信号处理直接在总线伺服驱动器上完成，其可以达到精密控制，并在力控过程完成后或者出现错误时将控制交回PC端的软件运动控制器处理。而PC端的软件运动控制器控制除力控之外的其它运动阶段，并对力控的运动过程进行实时监控，可对外部力传感器的力信号进行监控和结果确认。在本实施例中，当选定为总线伺服驱动器进行力控运动控制时，PC端对力控运动的运动过程以外的运动阶段进行监测，在总线伺服驱动器进行力控运动控制时，循环读取执行机构上的力传感器的力反馈，并根据力反馈在电流控制器中进行精密控制。在本实施例中，在总线伺服驱动器进行力控运动控制时发生错误后，执行机构的力控运动控制转由PC端的软件运动控制器进行错误处理。由于总线伺服驱动器不对错误进行处理和矫正，因此在发生运动错误时直接由软件运动控制器进行错误发生时的协调处理，例如控制执行机构中止运动或者快速复位，并发出警报。在本实施例中，当软件运动控制器进行力控运动控制时，在实时API缓存区中录制力控程序，同时将电流限制值输入总线伺服驱动器；总线伺服驱动器循环读取电流反馈，并与电流限制值进行比较，以在电流控制器中进行力控限制。当力控精度要求不是很高时，使用PC端的软件运动控制器在实时API缓存区中录制和运行用户应用程序，并将电流限制值写入总线伺服驱动器，来实现对包含力控的所有运动进行控制。因为追求高效率以及力控精度不是很高，因此力控过程只需要利用电流反馈来进行力控的限制，外部力传感器只是用来做力控效果的监控。在本实施例中，在软件运行控制器进行力控运动控制时发生错误后，软件运行控制器对错误进行修正，并执行力控运动控制。由于总线伺服驱动器循环读取电流反馈并在电流控制器中进行力的精密限制，如果在力控过程中发生错误，由用户应用程序进行动作流程的实时错误处理，并可对外部力传感器的力信号进行监控和结果确认。在整个过程中，用户应用程序运行于PC端的软件运动控制器的实时API缓存区中，所有的动作流程和过程都运行在实时操作系统中，没有不必要的延时，很好的保证了动作的实时性。此外，用户可以在应用程序中控制包含力控的全动作流程，不用在控制器和驱动器之间进行控制的切换，因此非常灵活，效率很高，在遇上错误时也可以做到和别的程序的即时的协同处理。在本实施例中，请参阅图4-图5；在获取电流限制值时，通过以下方法获得：在实时API缓存区中录制用户应用程序，执行机构根据第一位置指令从起始点运行到减速点，开始速度为0，命令速度为V0，结束速度为V1；执行机构再根据第二位置指令从起始点运行到减速点，开始速度为V1，命令速度为V1，结束速度为0；再将预设电流限制值写入总线伺服驱动器中，等待执行机构执行完成第二位置指令，则将预设电流限制值作为目标电流限制值写入总线伺服驱动器，然后解除电流限制值，使得执行结构能够快速返回起始点。还公开一种兼顾精密和高效的力控运动控制系统，请参阅图6；采用上述的方法；PC端的软件运动控制器包括共享内存的非实时操作系统和实时操作系统，非实时操作系统设置有控制接口模块、通讯接口模块，且力控参数的位置在非实时操作系统完成；实时操作系统包括电连接的实时控制内核、实时API缓存区和力控处理单元，实时API缓存区用于写入力控程序，力控处理单元用于执行力控控制；实时控制内核通过实时通讯内核连接总线伺服驱动器的实时总线接口；当选定为总线伺服驱动器进行控制时，总线伺服驱动器自主接收力控参数进行控制；当选定为软件运动控制器进行控制时，由所述API缓存区的力控程序进行力控运动控制；可以知道的，其余过程控制和报错时处理也由软件控制器进行相应处理。作为优选的，总线伺服驱动器包括依次电连接的MCU微处理器、FPGA可编程逻辑处理单元，驱动逆变单元、电机动力接口；电机动力接口用于与伺服电机连接以驱动执行机构；总线伺服驱动器还包括力反馈单元和编码器反馈接口；力反馈单元用于接收执行机构上的力传感器的力反馈，编码器反馈接口用于接收伺服电机的位置编码器模块的返回信息。本发明的优势在于：1. 通过对力控精度要求高低不同的场合，分别使用PC端的软件运动控制器或者总线伺服驱动器来实现对力控运动运动的控制。2. 当PC端的软件运动控制器进行力控运动运动的控制时，包含力控处理的用户应用程序在实时API缓存区中进行录制，以及运行在实时操作系统中。3. 当总线伺服驱动器进行力控时，PC端的软件运动控制器虽然不参与控制过程，但是仍然实时监控所有流程，并可对外部力传感器的力控信号进行监控和结果确认。以上公开的仅为本发明的几个具体实施例，但是本发明并非局限于此，任何本领域的技术人员能思之的变化都应落入本发明的保护范围。
