标题title
数据处理方法、计算机设备、数据处理系统及存储介质
摘要abst
本申请提供一种数据处理方法、计算机设备、数据处理系统及存储介质，应用于计算技术领域，该方法包括如下步骤：封装并发送MSI报文，MSI报文中包括指示报文的安全属性的第一字段，通过第一字段确定MSI报文相应的安全属性，进而可以通过安全属性实现不同中断请求的差异化处理，因此，本方法通过第一字段指示MSI报文的安全属性，不仅可以实现不同中断报文的针对性设计，同时还可实现对不同中断请求的差异化处理，有助于提高中断处理的安全性。
权利要求书clms
1.一种数据处理方法，其特征在于，应用于端点EP设备，所述方法包括：封装消息信号中断MSI报文；其中，所述MSI报文包括第一字段，所述第一字段指示所述MSI报文的安全属性；发送所述MSI报文。2.根据权利要求1所述的方法，其特征在于，所述第一字段包括第一码值和第二码值中的一种，其中，所述第一码值指示所述MSI报文的安全属性为第一安全属性；所述第二码值指示所述MSI报文的安全属性为第二安全属性。3.根据权利要求2所述的方法，其特征在于，在所述MSI报文的安全属性为所述第一安全属性的情况下，所述MSI报文用于触发第一共享外设中断SPI中断；在所述MSI报文的安全属性为所述第二安全属性的情况下，所述MSI报文用于触发第二SPI中断。4.根据权利要求1所述的方法，其特征在于，所述第一字段包括所述MSI报文中的TC字段。5.根据权利要求1-4任一项所述的方法，其特征在于，所述封装MSI报文，包括：获取原始中断报文；其中，所述原始中断报文包括第二字段，所述第二字段指示所述原始中断报文的安全属性；确定与所述第二字段的码值对应的所述第一字段的码值；基于所述第一字段的码值对所述原始中断报文进行重新封装，得到MSI报文。6.根据权利要求5所述的方法，其特征在于，所述获取原始中断报文，包括：获取中断请求；根据所述中断请求的类型，确定所述原始中断报文中所述第二字段的码值；封装包括所述第二字段的码值的中断报文，得到所述原始中断报文。7.根据权利要求5所述的方法，其特征在于，所述原始中断报文为AXI类型的报文，所述第二字段为AXI类型报文中的AxPROT字段；所述确定与所述第二字段的码值对应的所述第一字段的码值，包括：基于预设映射关系，将所述AxPROT字段映射到所述第一字段，得到所述AxPROT字段的码值所对应的所述第一字段的码值。8.一种数据处理方法，其特征在于，应用于根复合体RC设备，所述方法包括：接收消息信号中断MSI报文；其中，所述MSI报文包括第一字段，所述第一字段指示所述MSI报文的安全属性；基于安全属性与共享外设中断SPI中断之间的预设对应关系，触发与所述MSI报文的安全属性对应的SPI中断。9.根据权利要求8所述的方法，其特征在于，所述第一字段包括第一码值和第二码值中的一种，其中，所述第一码值指示所述MSI报文的安全属性为第一安全属性，所述MSI报文用于触发第一SPI中断；所述第二码值指示所述MSI报文的安全属性为第二安全属性，所述MSI报文用于触发第二SPI中断。10.根据权利要求8所述的方法，其特征在于，所述基于安全属性与共享外设中断SPI中断之间的预设对应关系，触发与所述MSI报文的安全属性对应的SPI中断，包括：提取所述MSI报文中所述第一字段的码值；基于预设映射关系，将所述第一字段映射到原始中断报文的AxPROT字段，得到所述第一字段的码值所对应的所述AxPROT字段的码值；其中，所述原始中断报文为AXI类型的报文，所述AxPROT字段指示所述原始中断报文的安全属性；基于所述安全属性与SPI中断之间的预设对应关系，触发与所述原始中断报文的安全属性对应的SPI中断。11.一种计算机设备，其特征在于，包括：存储器，用于存储指令；处理器，用于根据所述存储器中存储的指令，执行如权利要求1-7或8-10任一项所述的数据处理方法。12.一种数据处理系统，其特征在于，包括：端点EP设备和根复合体RC设备，其中，所述EP设备经所述RC设备与处理器通信连接；所述EP设备执行如权利要求1-7任一项所述的数据处理方法；所述RC设备执行如权利要求8-10任一项所述的数据处理方法。13.一种计算机可读存储介质，其特征在于，存储有计算机程序，所述计算机程序被执行时实现权利要求1-7或8-10任一项所述的数据处理方法。
说明书desc
技术领域本申请涉及计算机技术领域，具体涉及一种数据处理方法、计算机设备、数据处理系统及存储介质。背景技术PCIe是一种高速串行计算机扩展总线标准，广泛应用于计算机系统中。PCIe总线属于高速串行点对点双通道高带宽传输总线，其所连接的设备分配独享通道带宽，不共享总线带宽，具有高传输速率的特点。PCIe总线系统一般由RC设备、交换设备、EP设备等类型的PCIe节点组成。其中，RC设备是总线的根，通过RC设备可以把内存、处理器等连接到总线上；EP设备是多种类型的外部设备的总称，比如PCIe网卡、PCIe显卡等，EP设备可以根据需求实现某些特定功能；Switch是PCIe交换机，用于扩展PCIe接口。在实际应用中，EP设备发起MSI中断的机制是通过执行内存写操作实现的，因此，MSI报文在PCIe总线系统中的传输过程与TLP报文在PCIe总线系统中的传输过程类似。发明人研究发现，PCIe总线标准中并未对通信过程中的数据安全进行针对性的设计，因此，当涉及到EP设备与CPU之间的中断处理时，存在安全问题。发明内容有鉴于此，本申请致力于提供一种数据处理方法、计算机设备、数据处理系统及存储介质，MSI报文中包括指示报文安全属性的第一字段，通过第一字段实现中断报文的针对性设计，提高中断处理的安全性。第一方面，本申请提供一种数据处理方法，应用于端点EP设备，所述方法包括：封装消息信号中断MSI报文；其中，所述MSI报文包括第一字段，所述第一字段指示所述MSI报文的安全属性；发送所述MSI报文。在本申请中，MSI报文中包括指示报文的安全属性的第一字段，通过第一字段确定访问PCIe节点时相应的安全属性，进而可以通过安全属性实现不同中断请求的差异化处理，因此，本方法通过第一字段指示MSI报文的安全属性，不仅可以实现不同中断报文的针对性设计，同时还可实现对不同中断请求的差异化处理，有助于提高中断处理的安全性。在一种可能的实施方式中，所述第一字段包括第一码值和第二码值中的一种，其中，所述第一码值指示所述MSI报文的安全属性为第一安全属性；所述第二码值指示所述MSI报文的安全属性为第二安全属性。在本申请中，第一字段的码值可以是第一码值和第二码值中的任意一种，从而通过不同码值来指示MSI报文所对应的不同的安全属性，能够通过简单、清晰的方式指示MSI报文的安全属性，有助于提高数据处理的效率。在一种可能的实施方式中，在所述MSI报文的安全属性为所述第一安全属性的情况下，所述MSI报文用于触发第一共享外设中断SPI中断；在所述MSI报文的安全属性为所述第二安全属性的情况下，所述MSI报文用于触发第二SPI中断。在本申请中，不同安全属性的MSI报文，可以触发不同的SPI中断，进而可以使得处理器基于SPI中断选择匹配的执行环境处理中断请求，实现中断请求的差异化处理，提高数据处理的安全性。在一种可能的实施方式中，所述第一字段包括所述MSI报文中的TC字段。在本申请中，选择MSI报文结构中的现有字段，即TC字段承载报文的安全属性，由于并未对PCIe协议规范中定义的MSI报文结构做出改进，按照本申请扩展后的PCIe协议依然能够兼容标准的PCIe协议，有利于数据处理方法的推广应用。在一种可能的实施方式中，所述封装MSI报文，包括：获取原始中断报文；其中，所述原始中断报文包括第二字段，所述第二字段指示所述原始中断报文的安全属性；确定与所述第二字段的码值对应的所述第一字段的码值；基于所述第一字段的码值对所述原始中断报文进行重新封装，得到MSI报文。在本申请中，给出封装MSI报文的具体实现方法，经过原始中断报文的第二字段与MSI报文第一字段之间的转换，使得第一字段携带原始中断报文的安全属性，从而实现安全属性在PCIe总线系统内的有效传输、提高数据传输的安全性。在一种可能的实施方式中，所述获取原始中断报文，包括：获取中断请求；根据所述中断请求的类型，确定所述原始中断报文中所述第二字段的码值；封装包括所述第二字段的码值的中断报文，得到所述原始中断报文。在本申请中，给出封装原始中断报文的具体实现方法，在原始中断报文封装过程中，即根据中断请求的类型配置原始中断报文中第二字段的码值，从而使得原始中断报文中携带相应的安全属性。在一种可能的实施方式中，所述原始中断报文为AXI类型的报文，所述第二字段为AXI类型报文中的AxPROT字段；所述确定与所述第二字段的码值对应的所述第一字段的码值，包括：基于预设映射关系，将所述AxPROT字段映射到所述第一字段，得到所述AxPROT字段的码值所对应的所述第一字段的码值。在本申请提供的数据处理方法中，充分利用AXI报文结构中的现有字段，通过AxPROT字段携带安全属性，进一步基于AxPROT字段与预设映射关系，将AxPROT字段携带安全属性重载于MSI报文中的第一字段，实现安全属性在原始中断报文与MSI报文之间的传递，并进一步通过MSI报文实现安全属性在PCIe总线系统内的传递。第二方面，本发明提供一种数据处理方法，应用于根复合体RC设备，所述方法包括：接收消息信号中断MSI报文；其中，所述MSI报文包括第一字段，所述第一字段指示所述MSI报文的安全属性；基于安全属性与共享外设中断SPI中断之间的预设对应关系，触发与所述MSI报文的安全属性对应的SPI中断。在本申请中，MSI报文中包括指示报文的安全属性的第一字段，通过第一字段确定所得MSI报文的安全属性，进而可以通过携带不同安全属性的MSI报文触发不同的SPI中断，进而使得处理器可以基于通过与所得SPI中断匹配的执行环境处理所得中断，因此，本方法通过第一字段指示MSI报文的安全属性，不仅可以实现不同中断报文的针对性设计，同时还可实现对不同中断请求的差异化处理，有助于提高中断处理的安全性。在一种可能的实施方式中，所述第一字段包括第一码值和第二码值中的一种，其中，所述第一码值指示所述MSI报文的安全属性为第一安全属性，所述MSI报文用于触发第一SPI中断；所述第二码值指示所述MSI报文的安全属性为第二安全属性，所述MSI报文用于触发第二SPI中断。在本申请中，第一字段的码值可以是第一码值和第二码值中的任意一种，从而通过不同码值来指示MSI报文所对应的不同的安全属性，能够通过简单、清晰的方式指示MSI报文的安全属性，有助于提高数据处理的效率，进一步的，不同安全属性的MSI报文，可以触发不同的SPI中断，进而可以使得处理器基于SPI中断选择匹配的执行环境处理中断请求，实现中断请求的差异化处理，提高数据处理的安全性。在一种可能的实施方式中，所述基于安全属性与共享外设中断SPI中断之间的预设对应关系，触发与所述MSI报文的安全属性对应的SPI中断，包括：提取所述MSI报文中所述第一字段的码值；基于预设映射关系，将所述第一字段映射到原始中断报文的AxPROT字段，得到所述第一字段的码值所对应的所述AxPROT字段的码值；其中，所述原始中断报文为AXI类型的报文，所述AxPROT字段指示所述原始中断报文的安全属性；基于所述安全属性与SPI中断之间的预设对应关系，触发与所述原始中断报文的安全属性对应的SPI中断。在本申请提供的数据处理方法中，通过MSI报文中的第一字段携带安全属性，通过预设映射关系，确定与第一字段码值对应的原始中断报文中的AxPROT字段的码值，进而恢复出原始中断报文的安全属性，确保最终触发的SPI中断与原始中断报文的安全属性对应，实现安全属性在原始中断报文与MSI报文之间的传递，有助于提高中断处理的安全性。第三方面，本申请提供一种计算机设备，包括：存储器，用于存储指令；处理器，用于根据所述存储器中存储的指令，执行如本申请第一方面或第二方面任一项所述的数据处理方法。第四方面，本申请提供一种数据处理系统，包括：端点EP设备和根复合体RC设备，其中，所述EP设备经所述RC设备与处理器通信连接；所述EP设备执行如本申请第一方面任一项所述的数据处理方法；所述RC设备执行如本申请第二方面任一项所述的数据处理方法。第五方面，本申请提供一种计算机可读存储介质，存储有计算机程序，所述计算机程序被执行时实现本申请第一方面或本申请第二方面任一项所述的数据处理方法。基于上述内容，通过本申请提供的数据处理方法，MSI报文中包括指示报文的安全属性的第一字段，通过第一字段确定MSI报文相应的安全属性，进而可以通过安全属性实现不同中断请求的差异化处理，因此，本方法通过第一字段指示MSI报文的安全属性，不仅可以实现不同中断报文的针对性设计，同时还可实现对不同中断请求的差异化处理，有助于提高中断处理的安全性。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1所示为一种PCIe总线系统的拓扑结构图。图2所示为一种PCIe总线系统的应用场景示意图。图3所示为本发明实施例提供的一种数据处理方法的流程图。图4所示为TLP报文中TLP头的结构示意图。图5所示为本发明实施例提供的另一种数据处理方法的流程图。图6所示为本发明实施例提供的PCIe总线分层结构示意图。图7所示为本发明实施例提供的再一种数据处理方法的流程图。图8所示为本发明实施例提供的又一种数据处理方法的流程图。图9所示为本发明实施例提供的一种数据处理系统的结构框图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。PCIe是一种高速串行计算机扩展总线标准，普遍应用于处理器与高速外设之间的通信，实际应用中，PCIe总线系统包括多个点对点相互连接的组件。参考图1所示的PCIe总线系统的拓扑结构图，PCIe总线系统通常采用树形拓扑结构，前述相互连接的组件主要包括CPU、根复合体设备、交换设备、PCIe-PCI桥和端点设备等类型的PCIe节点，此外，PCIe总线系统中还可能包括内存。在典型的CPU+加速器异构计算系统中，RC设备位于CPU和PCIe拓扑结构之间，往上与CPU通过总线相连，往下管理各PCIe树形拓扑中的节点。如图1所示，PCIe节点包括交换设备、EP设备等。RC设备和CPU核通过AXI总线互连。RC设备的主要功能是完成存储器域到PCIe总线域的地址转换，同时也是PCIe总线系统的根，PCIe总线系统和外设的接口都能够集成于RC设备，它能够引出若干个PCIe接口，各接口都能够与PCIe节点进行衔接。RC设备能够获取PCIe节点传输的请求信息，从而对内存进行访问，相应的，RC设备也可以把处理器的请求信息发送至系统上挂载的EP设备，进而实现处理器与EP设备之间的通信。交换设备的主要作用是对PCIe链路进行扩展，PCIe总线的各数据链路只涵盖两个设备，这必然无法符合需求，因此可通过交换设备对其进行扩展。EP设备，可以理解为PCIe总线系统中实现独立功能的设备，不同的EP设备往往支持不同的功能，使得PCIe总线系统整体上能够支持多样性的应用功能。在实际应用中，比较具有典型意义的EP设备包括显卡、网卡等，同时，EP设备也是PCIe事务的发起方和响应方。PCIe-PCI桥的主要作用是对第二代外部部件互连标准进行有效兼容，其能够支持两个功能：一、能够对PCIe总线系统进行转换，从而得到PCI总线，并与PCI设备进行稳定连接。二、它能够对PCI总线进行有效转换，从而得到PCIe总线，并与PCIe节点进行衔接。可以理解的是，图1仅是一种片上系统的结构示例，在另一些示例中，片上系统也可以包括交换设备，或者说，交换设备也可以设置在片上系统内部，在此不再赘述。基于上述内容，参见图2所示的PCIe总线系统的应用场景，处理器可以同时与多个RC设备连接，RC设备之间可以根据顺序预先编号，与便于区分和管理， RC设备与EP设备点对点的直接相连。在图2所示应用场景的基础上，还可以参考图1，通过设置交换设备挂载更多EP设备，此处不再详细展开。在实际应用中，处理器通常使用深度优先算法 遍历PCIe总线系统的树形结构。枚举时，首先扫描总线0上的设备；如图2所示，首先会扫描到RC0，例如通过读取身份标识号，比如Vendor ID等标识，来确定当前是否有设备存在，如果存在，再通过读取配置空间中指定寄存器确定此设备的类型，即确定当前PCIe节点是EP设备还是RC设备，当确定是RC设备后，将RC0设备的下游总线号设置为总线1；继续向下扫描，再扫描发现EP0设备，因为EP设备为终端设备，此分支的枚举扫描结束，将退回到上一级总线上继续扫描；如此往复，直到发现PCIe总线系统上挂载的所有PCIe节点。在经历上述PCIe节点识别的标准流程之后， PCIe总线系统中的任一EP设备均可以和处理器进行通信，完成数据传输，当然，EP设备还可以根据自身情况向处理器发起中断请求。在PCIe总线系统中，EP设备向处理器发起中断请求是通过发送MSI报文实现的。与PCIe总线系统进行普通数据传输时的TLP报文相比，MSI报文在报文结构方面与TLP报文是一致的，MSI报文在PCIe总线系统中的传输与TLP报文在系统中的传输过程也是类似的。由于PCIe总线标准中并未对通信过程中的数据安全进行针对性的设计，即不支持安全属性的传递，导致同一总线系统下挂载的所有PCIe节点的安全属性是相同的，相应的，不同EP设备发起的中断请求之间同样不存在安全属性的区分，因此，当涉及到EP设备与处理器之间的中断数据处理时，存在数据处理的安全性问题。为解决这一问题，本发明提供一种数据处理方法，应用于PCIe总线系统中的EP设备，EP设备封装的MSI报文中，包括指示报文的安全属性的第一字段，通过第一字段确定MSI报文相应的安全属性，进而可以通过安全属性实现不同中断请求的差异化处理，因此，本方法通过第一字段指示MSI报文的安全属性，不仅可以实现不同中断报文的针对性设计，同时还可实现对不同中断请求的差异化处理，有助于提高数据处理的安全性。具体的，参见图3，本实施例提供的数据处理方法的流程可以包括：S100、封装MSI报文。如前所述，MSI报文与PCIe总线系统中用于数据传输的TLP报文在报文结构方面是相同的。TLP报文主要包括三部分，即TLP头、数据和循环冗余校验字段。其中，TLP头在TLP报文实现中起到极为关键的作用，TLP头主要用于记载发送者的相关信息、报文接收方的目的地址、TLP类型以及数据长度等信息，典型的TLP头的结构可以参见图4所示。需要说明的是，MSI报文与TLP报文的不同之处在于，MSI报文中记录有预定义地址，以及向该预定义地址中写入的预定义数据，当RC设备接收到报文时，如果识别到所得报文中记录有该预定义地址和预定义数据，即可确认所得报文为MSI报文。因此，MSI报文的本质也可以理解为记录有预定义数据的TLP报文。结合图1所示的PCIe总线系统架构，处理器和RC设备往往集成于片上系统内，并由该片上系统响应EP设备发起的中断请求。在一种可能的实施方式中，该片上系统可以搭载有普通执行环境和可信执行环境，这两个执行环境相互独立设置；在另一种可能的实施方式中，该片上系统可以仅搭载有普通执行环境；在另一种可能的实施方式中，该片上系统可以搭载有普通执行环境、可信执行环境和安全元件执行环境，这三个执行环境相互独立设置。其中，安全元件执行环境的安全级别高于可信执行环境，也高于普通执行环境。对于仅搭载一种执行环境的片上系统而言，响应任何中断请求时所能够调动的硬件资源是相同的，或者说，片上系统通过相同的执行环境响应全部中断请求，并不会对中断请求进行差异化处理，相反的，对于搭载两种或三种执行环境的片上系统而言，不同中断请求需要通过不同的执行环境来处理。通常，安全性要求高的中断请求需要通过可信执行环境来响应，安全性要求低的中断请求则可以通过普通执行环境来响应。基于上述内容，由于MSI报文承载于EP设备发起的访问请求中，因此，本实施例提供的数据处理方法，可通过设置MSI报文的安全属性来实现对于响应访问请求的执行环境的选择。具体的，与相关技术中的MSI报文不同的是，本实施例提供的MSI报文中，包括用于指示MSI报文的安全属性的第一字段。在实际应用中，第一字段的码值可以是第一码值和第二码值中的任意一个，至于第一字段的实际码值，具体需要结合实际的数据处理需求选择。其中，第一码值指示MSI报文的安全属性为第一安全属性，在此情况下，MSI报文用于触发第一SPI中断，相应的，第二码值指示MSI报文的安全属性为第二安全属性，在此情况下，MSI报文用于触发第二SPI中断。基于上述内容以及相关技术中关于REE、TEE的划分，前述第一安全属性为安全，第二安全属性为非安全。进一步的，结合图4所示，在一种可选的实施例中，第一字段可以选择MSI报文中的TC字段实现。基于PCIe总线标准的相关规定可知，在现有应用中，MSI报文中的TC字段用于表征报文的传输等级，包括3个比特位，即能够表示8种不同的传输等级，分别为TC0-TC7，字段的码值越大，表示报文的传输等级越高。本实施例提供的数据处理方法，在兼容现有PCIe规范的基础上，通过TC字段来实现安全属性的传递，具体的实现过程将在后续内容中展开，此处暂不详述。S110、发送MSI报文。在得到MSI报文之后，EP设备即可将MSI报文发送至相应的RC设备。对于EP设备发送MSI报文至RC设备的具体过程，将在后续内容中结合PCIe总线的分层结构具体展开，此处暂不详述。综上所述，本实施例提供的数据处理方法，MSI报文中包括指示报文的安全属性的第一字段，通过第一字段确定MSI报文相应的安全属性，进而可以通过安全属性实现不同中断请求的差异化处理，因此，本方法通过第一字段指示MSI报文的安全属性，不仅可以实现不同中断报文的针对性设计，同时还可实现对不同中断请求的差异化处理，有助于提高中断数据处理的安全性。可选的，参见图5，图5所示为本发明实施例提供的另一种数据处理方法的流程图，在本实施例中，数据处理的流程可以包括：S200、获取原始中断报文。在一些可能的实施方式中，当EP设备内部发生中断事件后，会产生相应的中断请求，EP设备响应于该中断请求，进一步根据中断请求的类型，确定原始中断报文中第二字段的码值，其中，原始中断报文的第二字段指示原始中断报文的安全属性，即EP设备首先会根据中断请求的类型确定原始中断报文的安全属性，而本方法的目的就是要保证RC设备在获取到相应的MSI报文时，仍然能够按照原始中断报文的安全属性响应中断请求。与MSI报文中的第一字段类似，原始中断报文中的第二字段可以是第一码值和第二码值中的任意一个，具体需要结合实际的数据传输需求选择。其中，第一码值指示原始中断报文的安全属性为第一安全属性，相应的，第二码值指示原始中断报文的安全属性为第二安全属性。可以理解的是，在实际应用中，需要预先确定不同类型的中断请求所对应的安全属性，即对设备运行过程中所有可能出现的中断请求进行分类，为需要在更为安全的执行环境响应的中断请求，匹配第一安全属性，相应的，为对于执行环境没有严格要求的中断请求，匹配第二安全属性。当然，作为一种可选的实现方式，也可以建立中断请求与安全属性之间的对应关系，在获取中断请求后，直接根据该对应关系确定与所得中断请求相对应的安全属性即可。在一些可能的实施方式中，原始中断报文通常选用AXI类型的报文，基于AXI总线规范的设定，AXI报文可以通过AxPROT字段指示安全属性为安全或非安全，因此，可以选择AXI报文中的AxPROT字段作为第二字段，承载原始中断报文的安全属性。AxPROT字段的定义可参照如下表1所示：表1结合上述表1内容可以看出，在AXI总线规范中，AxPROT字段共包括三个比特位，其中一个比特位用于指示安全属性。作为一种可选的实现方式，在需要指示的安全属性比较多的情况下，也可以通过原始报文中的其他字段的多个比特位来指示，在不超出本发明核心思想的情况下，同样属于本发明保护的范围内。基于上述内容，EP设备根据所得中断请求的类型，确定与中断请求匹配的安全属性，并进一步根据表1设置AXI报文中AxPROT字段的码值，即确定第二字段的码值，在确定第二字段的码值之后，封装包括第二字段的码值的中断报文，即得到携带安全属性的原始中断报文。S210、确定与第二字段的码值对应的第一字段的码值。如前所述，现有技术中的MSI报文中没有和安全属性相关的字段，因此，在得到原始中断报文中第二字段的码值之后，需要确定与第二字段的码值对应的第一字段的码值，通过在MSI报文中设置与原始中断报文第二字段的码值匹配的第一字段的码值，使得MSI报文携带安全属性。在一些可能的实施方式中，原始中断报文为AXI报文，相应的，原始中断报文中的第二字段为AxPROT字段，通过设置AxPROT字段中指定比特位的码值来指示相应报文的安全属性，具体的，参见表1所示。进一步的，本实施例提供预设映射关系，该预设映射关系中记录AxPROT字段与第一字段不同码值之间的对应关系，EP设备可以基于预设映射关系确定与AxPROT字段任一码值对应的第一字段的码值，同样，也可以基于预设映射关系确定与第一字段任一码值对应的AxPROT字段的码值。结合上述内容可知，原始中断报文中用于指示安全属性的AxPROT字段可以选择多个码值中的任意一个，通过配置不同的码值携带不同的安全属性，对于MSI报文而言亦是如此，其中的第一字段同样可以配置为多个码值中的任意一个。为了实现前述预设映射关系的作用，可以根据需求建立AxPROT字段的各码值与MSI报文中第一字段的各码值之间的一一对应关系，并进一步通过预设映射关系记录、体现两个字段间不同码值之间的对应关系。可以理解的是，AxPROT字段的各码值与MSI报文中第一字段的各码值之间的一一对应关系，通常是在应用本实施例提供的数据处理方法之前，根据传输需求确定并建立的。基于此，在经过前述步骤获取原始中断报文中AxPROT字段的码值之后，即可根据该预设映射关系，将AxPROT字段映射到第一字段，确定与AxPROT字段的码值对应的第一字段的码值，即TC字段的码值。S220、基于第一字段的码值对原始中断报文进行重新封装，得到MSI报文。经过前述转换，可以将原始中断报文中的安全属性重载于MSI报文的第一字段，可以理解的是，为了实现数据的有效传输，还需要同步获取原始中断报文中其他的相关信息，至少包括待传输数据、目的地址、校验数据、用于识别MSI报文的中断信息等必需的信息，将第一字段的码值以及前述其他信息进行重新封装，即可得到MSI报文。可以理解的是，第一字段本身即MSI报文中原有的字段，本方法并未对MSI报文结构做出改进，即能够兼容现有的PCIe总线规范，因此，重新封装原始中断报文以得到MSI报文的具体实现过程，可以参照相关技术中MSI报文的封装方法，本发明对此不做具体限定。S230、发送MSI报文。参见图6，图6所示为本发明实施例提供的一种PCIe总线分层结构的示意图，对于两个通过PCIe总线进行数据传输的PCIe节点，数据在这两个PCIe节点之间的传输需要通过若干个协议层，其中比较具有代表性的协议层包括事务层、数据链路层和物理层等。在PCIe总线中，MSI报文和TLP报文都需要经过设备的事务层、数据链路层和物理层，最终发送出去。而接收端接收到的数据报文需要经过物理层、数据链路层和事务层，最终获取相关数据。事务层定义PCIe总线使用总线事务，这些总线事务可通过交换设备等传输到RC设备或者其他PCIe节点。事务层接收来自PCIe节点应用层的数据，并将其封装为报文后，发向数据链路层。此外事务层还可以从数据链路层中接收数据报文，然后转发至PCIe节点的应用层。数据链路层保证来自发送端事务层的数据报文可以可靠、完整地发送到接收端的数据链路层。来自事务层的报文在通过数据链路层时，将被添加Sequence Number前缀和CRC后缀，以形成数据链路层数据包。物理层是PCIe总线系统的最底层，其PCIe物理接口的具体实现决定了PCIe链路只能使用端到端的连接方式。PCIe总线的物理层为PCIe节点间的数据通信提供传送介质，为数据传送提供可靠的物理环境。PCIe总线定义了LTSSM状态机，PCIe链路使用该状态机管理物理层的链路状态，并进行链路训练、链路恢复和电源管理。基于上述PCIe节点的分层结构以及各分层的基本功能，在一些可选的实施方式中，可以在EP设备中设置相应的知识产权核，比如，封装IP核，封装IP核通过执行前述方法封装得到MSI报文，进一步的，按照相关技术中PCIe节点传输报文的过程发送MSI报文至RC设备，本发明对于MSI报文的具体发送过程不做限定。相应的，RC设备中还可以设置解包IP核，读取MSI报文中携带的安全属性以及中断信息等相关信息，对于RC设备接收MSI报文以及解析MSI报文的过程，将在后续内容中展开，此处暂不详述。综上所述，本实施例提供的数据处理方法中，EP设备通过AXI报文中的AxPROT字段携带安全属性，在经过前述步骤后，将原始中断报文中安全属性重载于MSI报文的第一字段，使得MSI报文同样可以携带安全属性，将报文传输的优先等级进行安全等级的划分，赋予特定传输等级报文的安全属性，进而实现在PCIe总线系统中进行安全属性的传输，同时，通过是否包括安全属性还可以对MSI报文进行区分，从而实现中断请求的差异化处理，实现不同EP设备之间的安全隔离，提高中断响应过程的安全性。下面结合图7所示流程图，对RC设备在DMA通路下处理MSI中断报文的过程进行介绍，该数据处理流程包括：S300、接收MSI报文。在本申请实施例提供的数据处理方法中，RC设备所接收的MSI报文通常来自于EP设备，根据前述内容可知，MSI报文中包括用于指示MSI报文的安全属性的第一字段。其中，第一字段的码值可以是第一码值和第二码值中的任意一个，其中，第一码值指示MSI报文的安全属性为第一安全属性，此种情况下，MSI报文用于触发第一SPI中断，相应的，第二码值指示MSI报文的安全属性为第二安全属性，此种情况下，MSI报文用于触发第二SPI中断。进一步的，结合图4所示，在一种可选的实施例中，第一字段可以选择MSI报文中的TC字段实现。结合图6所示，接收MSI报文的过程，需要依次经过RC设备的物理层、数据链路层以及事务层，最终得到MSI报文中的相关信息。接收MSI报文的具体过程，可参照相关技术实现，本发明对此不做限定。S310、基于安全属性与SPI中断之间的预设对应关系，触发与MSI报文的安全属性对应的SPI中断。在相关技术中，MSI报文通常承载于内存写请求，MSI报文中的预定义地址即RC设备中的指定寄存器，比如中断寄存器的地址，同时，MSI报文中还包括预定义数据，RC设备响应于该内存写请求，向该预定义地址中写入该预定义数据，这一写操作会触发SPI中断。当然，在现有技术中，由于MSI报文并未携带安全属性，对于RC设备所触发的SPI中断，处理器是通过相同的执行环境响应的。基于上述内容，本实施例提供的MSI报文中的第一字段可以指示MSI报文的安全属性，并且，本实施例提供安全属性与SPI中断之间的预设对应关系。可选的，MSI报文的安全属性与SPI中断之间的预设对应关系可以采用如下方式：如果MSI报文的安全属性为第一安全属性，触发第一SPI中断；相应的，如果MSI报文的安全属性为第二安全属性，则触发第二SPI中断。至于预设对应关系，在实际应用中，可以有多种实现方式，本发明对于预设对应关系的具体实现不做限定。在一种可能的实现方式中， MSI报文触发SPI中断的具体过程，可以包括图8所示的如下步骤：S400、提取MSI报文中第一字段的码值。如前所述，为了保证与现有技术中PCIe总线标准相兼容，本申请提供的任一数据处理方法，均未对MSI报文的具体结构做出改进，因此，RC设备在得到EP设备发送的MSI报文后，可以基于相关技术中关于报文结构的定义，确定第一字段位置，进而提取第一字段的码值。在第一字段选择TC字段的情况下，即提取TC字段的码值。S410、基于预设映射关系，将第一字段映射到原始中断报文的AxPROT字段，得到第一字段的码值所对应的AxPROT字段的码值。在本实施例中，原始中断报文是由与RC设备通信连接的EP设备提供的。结合图1所示系统架构，封装原始中断报文的EP设备，包括直接与RC设备相连的EP设备，以及经交换设备与RC设备相连的EP设备。也就是说，原始中断报文可以由直接或间接与RC设备相连的EP设备生成。进一步的，在通常情况下，原始中断报文为AXI类型的报文，在此情况下，原始中断报文中的AxPROT字段中携带有原始中断报文的安全属性。如前所述，预设映射关系中记录AxPROT字段与第一字段不同码值之间的对应关系，可以基于预设映射关系确定与AxPROT字段任一码值对应的第一字段的码值，同样，也可以基于预设映射关系确定与第一字段任一码值对应的AxPROT字段的码值。作为一种可选的实现方式，预设映射关系存储于RC设备的转换寄存器中，通过访问转换寄存器，即可获得该预设映射关系，并进一步基于预设映射关系，将第一字段映射到原始中断报文的AxPROT字段，得到第一字段的码值所对应的AxPROT字段的码值。作为一种可选的实现方式，转换寄存器中还包括至少一个预设比特位，该至少一个比特位作为使能位使用。具体的，通过转换寄存器中至少一个预设比特位可以对是否进行前述转换过程进行设置，即转换寄存器中的至少一个比特位可通过第一码值表示需要进行前述第一字段与AxPROT字段之间的转换过程，或者，通过第二码值标识不需要进行第一字段与AxPROT字段之间的转换过程。在实际应用中，RC设备可以根据实际应用需求对转换寄存器进行配置。如前所述，在AXI总线标准中，AxPROT字段用来表征AXI报文，即原始中断报文的安全属性，因此，在还原出AxPROT字段的码值之后，即可确定原始中断报文携带的安全属性，当然，可以理解的是，原始中断报文的安全属性即MSI报文的安全属性。S420、基于安全属性与SPI中断之间的预设对应关系，触发与原始中断报文的安全属性对应的SPI中断。如前所述，恢复得到的原始中断报文的安全属性，即MSI报文的安全属性。基于此，如果AxPROT字段对应的安全属性，即恢复得到的原始中断报文的安全属性为第一安全属性，触发第一SPI中断，相应的，如果PROT字段对应的安全属性，即恢复得到的原始中断报文的安全属性为第二安全属性，则触发第二SPI中断。进一步的，基于相关技术可知，SPI是处理器可以直接支持的中断类型，并且可以被中断线触发，也可以通过写特殊的寄存器触发，将MSI报文转换为SPI中断，可以使得处理器直接响应该中断，简化中断的处理过程。综上所述，通过本申请提供的数据处理方法，MSI报文中包括指示报文的安全属性的第一字段，通过第一字段指示的安全属性，确定与MSI报文安全属性匹配的SPI中断，由于针对不同类型的SPI中断，处理器会通过不同的执行环境进行响应，即实现通过安全属性的设置实现不同MSI报文的差异化处理，因此，本方法通过第一字段指示报文的安全属性，可以实现中断响应的针对性设计，实现PCIe总线系统中不同EP设备的安全隔离，有助于提高中断请求处理过程的安全性。可选的，RC设备在触发与所得MSI报文的安全属性对应的SPI中断之后，该SPI中断直接反馈至处理器，处理器中的中断控制器自然可以根据SPI中断的不同类型来区分安全中断请求和非安全中断请求，进而决定通过TEE或REE来响应所得SPI中断。例如，可以通过TEE来响应安全中断请求，可以通过REE来响应非安全中断请求。又例如，在特殊场景下，可以通过SE来响应安全中断请求，可以通过REE来响应非安全中断请求。可以理解的是，挂载于PCIe总线系统上的各个PCIe节点，只有在支持相同协议规范的情况下，才能进行相互通信，因此，在实际应用中，同一PCIe总线系统中的任一PCIe节点均应能够执行上述数据处理方法，才能够有效提高数据处理的安全性。也就是说，PCIe总线系统中所有的PCIe节点，都应支持基于上述数据处理方法实现的安全属性传递过程，才能够确保安全属性在PCIe总线系统内可靠传递，建立一个统一的安全视图，进而实现传输报文以及相应中断的差异化设计，实现不同PCIe节点之间的安全隔离，管理粒度更细。在一些实施例中，本申请还提供一种数据处理系统，其系统结构可参见图9所示，该数据处理系统至少包括： EP设备10和RC设备20，其中，EP设备10经RC设备20与处理器30通信连接；EP设备执行如前述任一项实施例提供的数据处理方法中有关封装MSI报文的部分；RC设备执行如前述任一项实施例提供的数据处理方法中有关解包MSI报文的部分。可以理解的是，在实际应用中，本实施例提供的数据处理系统，同样可以采用如图1所示的系统架构。在一些实施例中，本实施例还提供一种计算机设备，包括：存储器，用于存储指令；处理器，用于根据所述存储器中存储的指令，执行如前述任一项实施例提供的数据处理方法。在一些实施例中，本实施例还提供了一种计算机可读存储介质，如软盘、光盘、硬盘、闪存、U盘、SD卡、MMC卡等，在该计算机可读存储介质中存储有实现上述各个步骤的一个或者多个指令，这一个或者多个指令被一个或者多个处理器执行时，使得所述处理器执行前文描述的数据处理方法。相关具体实现请参考前述描述，此处不过多赘述。除了上述方法和设备以外，本申请的实施例还可以是计算机程序产品，其包括计算机程序指令，计算机程序指令在被处理器运行时使得处理器执行本说明书上述内容中描述的根据本申请各种实施例的数据处理方法中的步骤。计算机程序产品可以以一种或多种程序设计语言的任意组合来编写用于执行本申请实施例操作的程序代码，程序设计语言包括面向对象的程序设计语言，诸如Java、C++等，还包括常规的过程式程序设计语言，诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、作为一个独立的软件包执行、部分在用户计算设备上部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。本领域技术人员能够理解，本公开所披露的内容可以出现多种变型和改进。例如，以上所描述的各种设备或组件可以通过硬件实现，也可以通过软件、固件、或者三者中的一些或全部的组合实现。此外，虽然本公开对根据本公开的实施例的系统中的某些单元做出了各种引用，然而，任何数量的不同单元可以被使用并运行在客户端和/或服务器上。单元仅是说明性的，并且系统和方法的不同方面可以使用不同单元。本公开中使用了流程图用来说明根据本公开的实施例的方法的步骤。应当理解的是，前面或后面的步骤不一定按照顺序来精确的进行。相反，可以按照倒序或同时处理各种步骤。同时，也可以将其他操作添加到这些过程中。本领域普通技术人员可以理解上述方法中的全部或部分的步骤可通过计算机程序来指令相关硬件完成，程序可以存储于计算机可读存储介质中，如只读存储器等。可选地，上述实施例的全部或部分步骤也可以使用一个或多个集成电路来实现。相应地，上述实施例中的各模块/单元可以采用硬件的形式实现，也可以采用软件功能模块的形式实现。本公开并不限制于任何特定形式的硬件和软件的结合。除非另有定义，这里使用的所有术语具有与本公开所属领域的普通技术人员共同理解的相同含义。还应当理解，诸如在通常字典里定义的那些术语应当被解释为具有与它们在相关技术的上下文中的含义相一致的含义，而不应用理想化或极度形式化的意义来解释，除非这里明确地这样定义。以上是对本公开的说明，而不应被认为是对其的限制。尽管描述了本公开的若干示例性实施例，但本领域技术人员将容易地理解，在不背离本公开的新颖教学和优点的前提下可以对示例性实施例进行许多修改。因此，所有这些修改都意图包含在权利要求书所限定的本公开范围内。应当理解，上面是对本公开的说明，而不应被认为是限于所公开的特定实施例，并且对所公开的实施例以及其他实施例的修改意图包含在所附权利要求书的范围内。本公开由权利要求书及其等效物限定。
