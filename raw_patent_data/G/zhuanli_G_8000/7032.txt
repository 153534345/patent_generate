标题title
一种文档自动化生成方法和系统
摘要abst
本发明提供了一种文档自动化生成方法和系统，涉及数据处理的技术领域，包括：获取样本文档模板，并对样本文档模板中的内容进行分类，并对为分类添加动态标识数据，得到适配文件，其中，分类的类型包括：段落，表格和可视化图例；提取适配文件中的目标文件，其中，目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含段落和/或表格的文件，第二目标文件为包含可视化图例的id的文件；对目标文件中的动态标识数据进行动态转置，得到目标适配文件；在获取到用户发送的需求文件之后，确定出需求文件对应的目标适配文件，并基于目标适配文件构建目标文档，解决了现有的文档自动化生成的方法和系统的开发成本较高的技术问题。
权利要求书clms
1.一种文档自动化生成方法，其特征在于，包括：获取样本文档模板，并对所述样本文档模板中的内容进行分类，对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档。2.根据权利要求1所述的方法，其特征在于，提取所述适配文件中的目标文件，包括：将所述适配文件的格式修改为压缩文件格式，得到目标适配文件；从所述目标适配文件中提取出所述目标文件。3.根据权利要求1所述的方法，其特征在于，基于所述适配文件，对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件，包括：对所述目标文件中的动态标识数据进行动态转置，得到转置标识；基于所述转置标识，得到所述目标适配文件。4.根据权利要求1所述的方法，其特征在于，在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档，包括：在获取到用户发送的需求文件之后，确定出所述需求文件对应的转置标识；基于所述需求文件对应的转置标识进行仿真，得到仿真文件；将所述需求文件转换为sql文件，并基于所述sql文件，确定出所述需求文件对应的目标适配文件；利用所述仿真文件和所述需求文件对应的目标适配文件，构建所述目标文档。5.一种文档自动化生成系统，其特征在于，包括：文档处理模块，数台配置模块和业务服务模块，其中，所述文档处理模块，用于获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；所述文档处理模块，用于提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；所述数台配置模块，用于对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；所述业务服务模块，用于在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档。6.根据权利要求5所述的系统，其特征在于，所述文档处理模块，包括：文件衍生单元和动态转置单元，其中，所述文件衍生单元，用于获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，以及将所述适配文件的格式修改为压缩文件格式，得到目标适配文件，并从所述目标适配文件中提取出所述目标文件；所述动态转置单元，用于对所述目标文件中的动态标识数据进行动态转置，得到转置标识；以及基于所述转置标识，得到所述目标适配文件。7.根据权利要求6所述的系统，其特征在于，所述业务服务模块，包括：虚拟埋点模块，数据仿真模块和数据量化模块，其中，所述数据仿真模块，用于在获取到用户发送的需求文件之后，确定出所述需求文件对应的转置标识；基于所述需求文件对应的转置标识进行仿真，得到仿真文件；所述数据量化模块，用于将所述需求文件转换为sql文件，并基于所述sql文件，确定出所述需求文件对应的目标适配文件；所述虚拟埋点模块，用于利用所述仿真文件和所述需求文件对应的目标适配文件，构建所述目标文档。8.根据权利要求7所述的系统，其特征在于，所述系统还包括：载质模块，用于根据所述sql文件查询所述需求文件对应的目标适配文件，并将所述需求文件对应的目标适配文件发送至所述虚拟埋点模块。9.根据权利要求5所述的系统，其特征在于，所述系统还包括：可视化装配模块，用于在所述需求文件为包含可视化图例需求的文件时，对所述需求文件对应的可视化图例进行适配，并将适配后的可视化图例映射至所述目标文档；产品输出模块，用于对所述数台配置模块发送的压缩格式的目标文档进行解析，并将解析后的目标文档发送给所述用户。10.根据权利要求5所述的系统，其特征在于，所述数台配置模块，还用于将目标文档转换为其他格式的文本。
说明书desc
技术领域本发明涉及数据处理的技术领域，尤其是涉及一种文档自动化生成方法和系统。背景技术目前诸多公司或者是leader普遍常态化需要一些工作的汇报总结并以word文档书面形式或者是电子档呈现。而且这些文档的模板样式复杂、内容篇幅大、模板的样式改动频繁，对于开发这来讲无疑是一件繁琐的问题，需要花费大量的时间在编写模板样式和配置模板上，在整个过程中配置模板的成本最高，几乎是整个开发过程中五分之三，并且在配置模板过程中配置数据的占位符容易出错，再则一个就是写一些复杂表单样式也耗费成本。针对上述问题，还未提出有效的解决方案。发明内容有鉴于此，本发明的目的在于提供一种文档自动化生成方法和系统，以缓解了现有的文档自动化生成的方法和系统的开发成本较高的技术问题。第一方面，本发明实施例提供了一种文档自动化生成方法，获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档。进一步地，提取所述适配文件中的目标文件，包括：将所述适配文件的格式修改为压缩文件格式，得到目标适配文件；从所述目标适配文件中提取出所述目标文件。进一步地，基于所述适配文件，对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件，包括：对所述目标文件中的动态标识数据进行动态转置，得到转置标识；基于所述转置标识，得到所述目标适配文件。进一步地，在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档，包括：在获取到用户发送的需求文件之后，确定出所述需求文件对应的转置标识；基于所述需求文件对应的转置标识进行仿真，得到仿真文件；将所述需求文件转换为sql文件，并基于所述sql文件，确定出所述需求文件对应的目标适配文件；利用所述仿真文件和所述需求文件对应的目标适配文件，构建所述目标文档。在本发明实施例中，还提供了一种文档自动化生成系统包括：文档处理模块，数台配置模块和业务服务模块，其中，所述文档处理模块，用于获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；所述文档处理模块，用于提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；所述数台配置模块，用于对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；所述业务服务模块，用于在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档。进一步地，所述文档处理模块，包括：文件衍生单元和动态转置单元，其中，所述文件衍生单元，用于获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，以及将所述适配文件的格式修改为压缩文件格式，得到目标适配文件，并从所述目标适配文件中提取出所述目标文件；所述动态转置单元，用于对所述目标文件中的动态标识数据进行动态转置，得到转置标识；以及基于所述转置标识，得到所述目标适配文件。进一步地，所述业务服务模块，包括：虚拟埋点模块，数据仿真模块和数据量化模块，其中，所述数据仿真模块，用于在获取到用户发送的需求文件之后，确定出所述需求文件对应的转置标识；基于所述需求文件对应的转置标识进行仿真，得到仿真文件；所述数据量化模块，用于将所述需求文件转换为sql文件，并基于所述sql文件，确定出所述需求文件对应的目标适配文件；所述虚拟埋点模块，用于利用所述仿真文件和所述需求文件对应的目标适配文件，构建所述目标文档。进一步地，所述系统还包括：载质模块，用于根据所述sql文件查询所述需求文件对应的目标适配文件，并将所述需求文件对应的目标适配文件发送至所述虚拟埋点模块。进一步地，所述系统还包括：可视化装配模块，用于在所述需求文件为包含可视化图例需求的文件时，对所述需求文件对应的可视化图例进行适配，并将适配后的可视化图例映射至所述目标文档；产品输出模块，用于对所述数台配置模块发送的压缩格式的目标文档进行解析，并将解析后的目标文档发送给所述用户。进一步地，所述数台配置模块，还用于将目标文档转换为其他格式的文本。在本发明实施例中，通过获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档，达到能够渐变高效生成文档的目的，进而解决了现有的文档自动化生成的方法和系统的开发成本较高的技术问题，从而实现了降低研发成本的技术效果。本发明的其他特征和优点将在随后的说明书中阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点在说明书、权利要求书以及附图中所特别指出的结构来实现和获得。为使本发明的上述目的、特征和优点能更明显易懂，下文特举较佳实施例，并配合所附附图，作详细说明如下。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的一种文档自动化生成系统的示意图；图2为本发明实施例提供的一种文档自动化生成方法的流程图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合附图对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。现有技术中，由于word的生成需要手动配置大量的模板文件和复杂的编码工作，因此word文档的自动化存在很大的技术缺陷，但为企业和leader提供报表服务是不可或缺部分。据目前的统计，有6种方式可以实现word的自动化生成，但是这些方式都无法完全解决对模板文档大量的配置以及编写复杂表格样式的工作，无法做到只专注于业务层面的工作。以下是6种方式各自的优缺点：. Jacob是Java-COM Bridge的缩写，它在Java与微软的COM组件之间构建一座桥梁。通过Jacob实现了在Java平台上对微软Office的COM接口进行调用。优点：调用微软office的COM接口，生成的word文件格式规范；缺点：服务器只能是windows平台，不支持unix和linux，而且服务器上必须安装office软件，因此无法满足跨平台的问题。. Apache POI包括一系列的API，它们可以操作基于MicroSoft OLE 2 CompoundDocument Format的各种格式文件，可以通过这些API在Java中读写Excel、Word等文件。优点：可以跨平台支持windows、unix和linux;缺点：相对于word文件的处理来说，POI更适合excel的处理，而对于word可以实现一些简单的文件操作，不能设置样式且生成的word文件格式不够规范，因此无法满足操作复杂的表格样式。. Java2word是另一个在java程序中调用MS Office Word文档的组件，该组件提供一组简单的接口，以便java程序调用它的服务操作word文档。服务中包括：打开文档、新建文档、查找文字、替换文字，插入文字、插入可视化图例、插入表格，在书签处插入文字、插入可视化图例、插入表格等。该技术的优点：足够简单，操作起来要比FreeMarker简单的多；缺点：没有FreeMarker强大，不能够根据模板生成word文档，word文档的样式信息都不能够很好的操作，因此无法满足简单易用的原则。. FreeMarker生成word文档的功能是由XML+FreeMarker来实现的。先把word文件另存为xml，在xml文件中插入特殊的字符串占位符，将xml翻译成FreeMarker模板，最后用java来解析FreeMarker模板，编码调用FreeMarker实现文本替换并输出doc。优点：比java2word功能更强大，也是纯java编程；缺点：生成的文件本质上是xml，不是真正的word文件格式，有很多常用的word格式无法处理或表现怪异，比如：超链接、换行、乱码、部分生成的文件打不开等问题并且生成的看文档内存占用比较大以及繁琐的模板配置，因此无法满足部分文档无法打开以及内存占用大的看问题。. FreeMarker改良版生成word文档是由zip中的xml+FreeMarker来实现的。先将模板文件的后缀名docx改为zip，然后将zip压缩文件中的document.xml文档以及_rels文件夹下的document.xml.rels提取出来，在document.xml中插入特殊的占位符以及将可视化图例的配置信息填充到document.xml.rels文档中，将填充之后的document.xml和document.xml.rels用流的方式写入到zip中，并输出docx。优点：解决了不是真正word文件的格式、文档打开异常的问题以及文档占用内存大的问题；缺点：繁琐的模板配置，因此无法解决繁琐的模板配置问题。. PageOffice生成word文件，PageOffice封装了微软Office繁琐的vba接口，提供简洁易用的java编程对象，支持生成word文件，同时实现了在线编辑word文档和读取word文档内容，目前PageOffice支持java、php以及c#语言。优点：跨平台支持windows、unix和linux，生成word文件格式标准，支持文本、可视化图例、表格、字体、段落、颜色、超链接、页眉等各种格式操作，支持多word合并，无需处理并发，不耗费服务器资源，运行稳定；缺点：必须在客户端生成文件，不支持服务器端生成文件。因此无法实现java纯后端的问题以及只需要关注业务而不需要关注生成文档的问题。由上可知，非常有必要设计一款跨平台、多样式、多数据源、存储占比低、结构配置简单以及以业务为核心的自动化word文档生成工具。因此，在本申请中提出以下实施例。实施例一：根据本发明实施例，提供了一种文档自动化生成系统的实施例，图1是根据本发明实施例的一种文档自动化生成系统的示意图，如图1所示，该系统包括：文档处理模块10，数台配置模块20和业务服务模块30。所述文档处理模块10，用于获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；所述文档处理模块10，用于提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；所述数台配置模块20，用于对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；所述业务服务模块30，用于在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档。需要说明的是，数台配置模块可以选择性的将word文档转换成其它类型的文本格式，包括html、pdf、ppt等。在本发明实施例中，通过获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档，达到能够渐变高效生成文档的目的，进而解决了现有的文档自动化生成的方法和系统的开发成本较高的技术问题，从而实现了降低研发成本的技术效果。在本发明实施例中，述文档处理模块，包括：文件衍生单元和动态转置单元。所述文件衍生单元，用于获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，以及将所述适配文件的格式修改为压缩文件格式，得到目标适配文件，并从所述目标适配文件中提取出所述目标文件；所述动态转置单元，用于对所述目标文件中的动态标识数据进行动态转置，得到转置标识；以及基于所述转置标识，得到所述目标适配文件。在本发明实施例中，将样本文档模板中不同类别模块按照唯一类别标识适配到数台模块服务中，如果是表格则需要将原始表格中行列的标识分别适配到数台行列对应的字段中，并按照原始表格的顺序；如果是段落文字则需要手动在样本文档模板中动态数据的位置进行适配；如果是可视化图例，需要在可视化图例的字段中适配可视化图例业务的标识。而后执行文件衍生模块，将docx文件后缀文档中的数据适配文件和可视化图例可适配文件从压缩文件中提取，如果不是首次执行，后续无需执行。当文件衍生单元中适配文件提取之后，对数据整体的适配文件格式化，将数据按照行的形式编排。根据数台中的适配对格式化之后的动态标识转置。如果不是首次执行，后续无需重复。在本发明实施例中，所述业务服务模块，包括：虚拟埋点模块，数据仿真模块和数据量化模块。所述数据仿真模块，用于在获取到用户发送的需求文件之后，确定出所述需求文件对应的转置标识；基于所述需求文件对应的转置标识进行仿真，得到仿真文件；所述数据量化模块，用于将所述需求文件转换为sql文件，并基于所述sql文件，确定出所述需求文件对应的目标适配文件；所述虚拟埋点模块，用于利用所述仿真文件和所述需求文件对应的目标适配文件，构建所述目标文档。在本发明实施例中，数据仿真单元从数台中获取适配的数据并添加默认数据；虚拟埋点单元通过数据量化单元从载质单元中抽取数据，将抽取的真实数据和数据仿真单元中默认数据做关联做映射；数据量化单元会根据业务的需求将查询sql量化成对应数据源组件的查询条件并加载数据源，将结果返回虚拟埋点单元做数据后续处理。在本发明实施例中，所述系统还包括：载质模块，用于根据所述sql文件查询所述需求文件对应的目标适配文件，并将所述需求文件对应的目标适配文件发送至所述虚拟埋点模块。在本发明实施例中，载质单元主要是数据源，包括关系型数据库、非关系型数据库、本地文件、远程文件、excel、csv等形式，根据数据量化单元中业务需求提供业务查询支持。在本发明实施例中，所述系统还包括：可视化装配模块，用于在所述需求文件为包含可视化图例需求的文件时，对所述需求文件对应的可视化图例进行适配，并将适配后的可视化图例映射至所述目标文档；产品输出模块，用于对所述数台配置模块发送的压缩格式的目标文档进行解析，并将解析后的目标文档发送给所述用户。在本发明实施例中，可视化装配模块主要是在数台中对文档可视化图例进行适配，适配之后会直接映射到目标文档的可视化样式。在可视化衍射模块中，引用前端中的echarts组件实现对可视化数据的渲染效果，在文档中是否需要可视化装配和可视化衍射模块可直接在数台中直接适配。数据准备完毕之后，FreeMarker将适配完成的配置文件进行解析，解析会将文档的原始数据文件、动态数据和可视化图例的适配文件一并加载。解析完成之后将动态数据以及可视化数据加载到zip流，在产品输出模块中输出目标文档。下面对上述系统进行详细说明：首先需要提供一个docx文档模板，其次对文档中内容进行梳理，无任何异常之后，便对文档中段落、表格以及可视化内容分类。如果是段落，需要手动对段落中的动态数据部分使用${+唯一标识}转置，因为段落无法确定值的确切位置，标识的字段不能以数字开头，如果是多字符串联的标识位，最好通过记事本预先编译好之后再复制到对应的位置，如果直接在文档中编辑，xml可能会将唯一标识拆解，系统无法识别关键字；如果是表格，需要将表格中的行列值按照自然顺序别分填充到数台字段中，假如是多个表格用多个类别区分，每一个表格都需要另起新行做适配，确保每一个表格之间互不干扰；如果是可视化部分，需要在数台中适配可视化的唯一标识，以区分每张不同的可视化图例。如果是同一文档中，均需要把段落、表格、可视化的项目编号适配一致，确保数据一致。 当数台中对文档的适配完成之后，需要通过文件衍生模块衍生出文档中数据和可视化配置文件并提取。由于docx文件的本质就是zip文件，所以将docx的后缀更正为zip格式，并用压缩软件打开，在word文件夹中有一个document.xml，这是数据文件，文档中的段落和表格数据都存储在此区域，可视化数据并不在此，在该区域只存储了可视化数据的id，通过id到_rels文件夹中查找document.xml.rels文件，该文件中保存跟document.xml一样的id，并且在它的可视化图例路径中指向可视化样例的相对路径，具体路径是media/+可视化样例名字，由此可见两个适配文件之间是一个映射关系，提取两个适配文件和原始docx文件指定到项目中。 适配文件提取完成之后需要通过动态转置模块对动态数据处理，需要对document.xml和document.xml.rels文件中的动态标识数据进行动态转置。在转置之前还需要将document.xml文件进行格式化，如果是段落，唯一标识已经定义过，无需考虑；如果是表格，表格是按照横列的组合来确定唯一的单元格，需要读取数台中表格的适配目录，根据读取到适配环境中行列的组合加上表格的标识构建唯一键，如果是格式化之后的数据适配文件则表格中每一行只有唯一的单元格，所以转置不会出现异常；如果是可视化document.xml.rels文件，对适配文件带有“/＞”的标识符进行切割，可视化的初始化id是6，依次按照顺序递增并用数台中的唯一标识转置即可。如果表格中存在动态数据文字描述，此种数据的唯一标识需在中去适配，转置完成之后覆盖之前的适配文件。 在执行数据量化模块之前，数据仿真模块会从数台中抽取该文档表格的行列键，并组装默认的标识，这个标识与中转置的标识保持一致，完成之后根据业务的需求将查询的数据转变成sql的方式，然后在适配文件适配需要数据库的信息，系统会将执行的sql信息量化成具体的数据源查询信息，将量化结果返回虚拟埋点模块。 根据业务需求是否需要可视化支持，如果需要，则在数台中装配可视化的对应id的样式，调用可视化衍射模块会将动态可视化动态数据衍射成真实的可视化实例；在核心业务模块中数据仿真模块与虚拟埋点模块中的真实数据组合，将仿真数据和真实数据做映射，以键值对key-value的形式，生成动态数据集； 生成数据集后调用文件解析模块，通过FreeMarker对数据适配和可视化适配文件解析，将最新的动态数据加载到模板文件中； 解析完成之后通过终端输出模块将段落、表格和可视化文件分别加载到压缩文件流中，生成docx文档； 如果业务需要其它类型的文件，可以调用文件派生模块，并在数台中配置需要派生其它类型的文件，即可将docx文件转换成需要的文件格式。实施例二：本发明实施例还提供了一种文档自动化生成方法，如图2所示，图2为上述文档自动化生成的方法的流程图，该文档自动化生成的方法包括：步骤S102，获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；步骤S104，提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；步骤S106，对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；步骤S108，在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档。在本发明实施例中，通过获取样本文档模板，并对所述样本文档模板中的内容进行分类，并对为所述分类添加动态标识数据，得到适配文件，其中，所述分类的类型包括：段落，表格和可视化图例；提取所述适配文件中的目标文件，其中，所述目标文件包括：第一目标文件和第二目标文件，其中，第一目标为文件为包含所述段落和/或所述表格的文件，第二目标文件为包含所述可视化图例的id的文件；对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件；在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档，达到能够渐变高效生成文档的目的，进而解决了现有的文档自动化生成的方法和系统的开发成本较高的技术问题，从而实现了降低研发成本的技术效果。优选的，提取所述适配文件中的目标文件，包括：将所述适配文件的格式修改为压缩文件格式，得到目标适配文件；从所述目标适配文件中提取出所述目标文件。优选的，基于所述适配文件，对所述目标文件中的所述动态标识数据进行动态转置，得到目标适配文件，包括：对所述目标文件中的动态标识数据进行动态转置，得到转置标识；基于所述转置标识，得到所述目标适配文件。优选的，在获取到用户发送的需求文件之后，确定出所述需求文件对应的目标适配文件，并基于所述目标适配文件构建目标文档，包括：在获取到用户发送的需求文件之后，确定出所述需求文件对应的转置标识；基于所述需求文件对应的转置标识进行仿真，得到仿真文件；将所述需求文件转换为sql文件，并基于所述sql文件，确定出所述需求文件对应的目标适配文件；利用所述仿真文件和所述需求文件对应的目标适配文件，构建所述目标文档。另外，在本发明实施例的描述中，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。在本发明的描述中，需要说明的是，术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”、“第三”仅用于描述目的，而不能理解为指示或暗示相对重要性。在本申请所提供的几个实施例中，应该理解到，所揭露的系统、装置和方法，可以通过其它的方式实现。以上所描述的装置实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，又例如，多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些通信接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。最后应说明的是：以上所述实施例，仅为本发明的具体实施方式，用以说明本发明的技术方案，而非对其限制，本发明的保护范围并不局限于此，尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，其依然可以对前述实施例所记载的技术方案进行修改或可轻易想到变化，或者对其中部分技术特征进行等同替换；而这些修改、变化或者替换，并不使相应技术方案的本质脱离本发明实施例技术方案的精神和范围，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应所述以权利要求的保护范围为准。
