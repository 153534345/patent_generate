标题title
用于目标跟踪的面向高光谱视频的三通道视频输出方法
摘要abst
本发明公开了用于目标跟踪的面向高光谱视频的三通道视频输出方法，由以下步骤组成：计算输入的高光谱视频每个通道的输入图像的每个像素与其相邻像素之间的像素值差值得到对比度差异，计算输入的高光谱视频的每个通道的每帧图像的信息熵根据高光谱视频给定的地表真值，将输入图像分为目标区域和背景区域，计算目标区域和背景区域的对比度差异和像素均值差异，根据对比度差异和像素均值差异计算得到目标背景差异指标，将对比度差异、信息熵、目标背景差异指标输入评价算法得到质量评价指标Pm，取三个最大的Pm值对应的三个通道作为三通道输出视频F；本发明在保证精度的前提下，有效的解决了高光谱目标跟踪速度慢的问题，提升方法的实用性。
权利要求书clms
1.用于目标跟踪的面向高光谱视频的三通道视频输出方法，其特征在于，由以下步骤组成：计算输入的高光谱视频每个通道的输入图像的每个像素与其相邻像素之间的像素值差值得到对比度差异计算输入的高光谱视频的每个通道的每帧图像的信息熵根据高光谱视频给定的地表真值，将输入图像分为目标区域和背景区域，计算目标区域和背景区域的对比度差异和像素均值差异，根据对比度差异和像素均值差异计算得到目标背景差异指标将对比度差异信息熵目标背景差异指标输入评价算法得到质量评价指标Pm，取三个最大的Pm值对应的三个通道作为三通道输出视频F。2.根据权利要求1所述的用于目标跟踪的面向高光谱视频的三通道视频输出方法，其特征在于，所述对比度差异的计算方法为：其中，为第m个通道第n帧的图像，表示图像中位置i处的像素值，wi表示以i为中心的上、下、左、右的四近邻，j表示四近邻wi中的点，S表示公式分子部分的求和次数。3.根据权利要求1所述的用于目标跟踪的面向高光谱视频的三通道视频输出方法，其特征在于，所述信息熵的计算方法为：其中，表示为图像的信息熵，k表示图像中像素值为a出现的概率，a的取值范围为0到255。4.根据权利要求1所述的用于目标跟踪的面向高光谱视频的三通道视频输出方法，其特征在于，所述目标背景差异指标的计算方法为：其中，和分别代表图像中目标区域和背景区域的像素均值，和分别代表图像中目标区域和背景区域的对比度。5.根据权利要求1所述的用于目标跟踪的面向高光谱视频的三通道视频输出方法，其特征在于，所述质量评价指标Pm的评价算法为：其中，Pm为第m通道Clm的质量评价指标，和分别表示图像的对比度差异、信息熵和目标背景差异指标，n表示第n帧，n为从1到N取整数值，α、β和γ分别表示和的权重系数，取值范围为正整数，m为从1到M取整数值。6.根据权利要求1-5任一所述的用于目标跟踪的面向高光谱视频的三通道视频输出方法，其特征在于，取三个最大的Pm值对应的三个通道作为三通道输出视频F，即：F＝{Clmax1，Clmax2，Clmax3} 其中，Clmax1、Clmax2、Clmax3分别代表三个最大的Pm值对应的三个通道，F为三通道视频。
说明书desc
技术领域本发明属于多通道视频的目标跟踪技术领域，尤其涉及用于目标跟踪的面向高光谱视频的三通道视频输出方法。背景技术基于高光谱视频的目标跟踪是通过高光谱图像光谱特征提取，从而有效降低在复杂环境中由于伪装、遮挡等原因造成的目标丢失概率。基于高光谱视频的目标跟踪在遥感、计算机视觉等领域有着潜在应用。现有的高光谱目标跟踪方法有两种：一是将高光谱视频的各个通道送进卷积网络来获取各通道的权重，然后将所有的通道按照权重大小组合成多组三通道视频，再将这些三通道视频送入传统彩色视频目标跟踪器中进行跟踪，代表有BAE-Net方法；二是针对高光谱视频中不同通道内目标的材料信息不同，提出的高光谱视频中基于材质的目标跟踪方法。现有的高光谱视频目标跟踪方法大多使用多层卷积网络来保证目标跟踪的精度，而卷积网络的缺点之一就是计算量巨大，从而导致跟踪速度缓慢，实时性差。发明内容本发明的目的是提供用于目标跟踪的面向高光谱视频的三通道视频输出方法，以解决现有的跟踪方法计算量巨大，从而导致跟踪速度缓慢，实时性差的问题。本发明采用以下技术方案：用于目标跟踪的面向高光谱视频的三通道视频输出方法，由以下步骤组成：计算输入的高光谱视频每个通道的输入图像的每个像素与其相邻像素之间的像素值差值得到对比度差异计算输入的高光谱视频的每个通道的每帧图像的信息熵根据高光谱视频给定的地表真值，将输入图像分为目标区域和背景区域，计算目标区域和背景区域的对比度差异和像素均值差异，根据对比度差异和像素均值差异计算得到目标背景差异指标将对比度差异信息熵目标背景差异指标输入评价算法得到质量评价指标Pm，取三个最大的Pm值对应的三个通道作为三通道输出视频F。进一步地，所述对比度差异的计算方法为：其中，为第m个通道第n帧的图像，表示图像中位置i处的像素值，wi表示以i为中心的上、下、左、右的四近邻，j表示四近邻wi中的点，S表示公式分子部分的求和次数。进一步地，所述信息熵的计算方法为：其中，表示为图像的信息熵，k表示图像中像素值为a出现的概率，a的取值范围为0到255。进一步地，所述目标背景差异指标的计算方法为：其中，和分别代表图像中目标区域和背景区域的像素均值，和分别代表图像中目标区域和背景区域的对比度。进一步地，所述质量评价指标Pm的评价算法为：其中，Pm为第m通道Clm的质量评价指标，和分别表示图像的对比度差异、信息熵和目标背景差异指标，n表示第n帧，n从1到N取整数值，α、β和γ分别表示和的权重系数，取值范围为正整数，m为从1到M取整数值。进一步地，取三个最大的Pm值对应的三个通道作为三通道输出视频F，即：F＝{Clmax1,Clmax2,Clmax3} 其中，Clmax1、Clmax2、Clmax3分别代表三个最大的Pm值对应的三个通道，F为三通道视频。本发明的有益效果是：将本发明获得的三通道视频作为目标跟踪器的输入，根据输入视频当前帧的目标框进行初始化，然后进行正常操作得到高光谱视频目标跟踪的结果；本发明在保证精度的前提下，有效的解决了高光谱目标跟踪速度慢的问题，提升方法的实用性。附图说明图1为本发明的流程图；图2为本发明实施例1的效果展示图。具体实施方式下面结合附图和具体实施方式对本发明进行详细说明。本发明公开了用于目标跟踪的面向高光谱视频的三通道视频输出方法，如图1所示，由以下步骤组成：首先假设高光谱视频包含M个通道，第m个通道用Clm表示，第m个通道Clm的通道质量用该通道前N帧图像各指标的总和表示。步骤1：计算输入的高光谱视频每个通道的输入图像的每个像素与其相邻像素之间的像素值差值得到对比度差异步骤2：计算输入的高光谱视频的每帧图像的信息熵步骤3：根据高光谱视频给定的地表真值，将输入图像分为目标区域和背景区域，计算目标区域和背景区域的对比度差异和像素均值差异，根据对比度差异和像素均值差异计算得到目标背景差异指标步骤4：将对比度信息熵目标背景差异指标输入评价算法得到质量评价指标Pm，步骤5：取三个最大的Pm值对应的三个通道作为三通道输出视频F，将三通道输出视频F送入目标跟踪器中，通过学习和迭代，得到目标跟踪结果。其中，步骤1中：计算第m个通道第n帧的图像的每个像素与其相邻像素之间的像素值差异，即对比度差异，其定义如下：其中，表示图像中位置i处的像素值，wi表示以i为中心的四近邻。j为四近邻wi中的点，S表示公式分子部分的求和次数，为第m通道在第n帧的图像，通常为八比特图像，其中m的取值范围为1到M，n的取值范围为1到N。其中，步骤2中的信息熵由下式计算：其中，表示为图像的信息熵，k表示图像中像素值为a出现的概率，a的取值范围为0到255。其中，步骤3中的目标背景差异指标由以下方法计算：首先根据高光谱视频给定的地表真值将输入图像分为目标区域和背景区域，其中定义背景区域的宽和高为目标区域的宽和高的k倍，k的取值为实数1到5，然后分别计算两个区域之间的对比度差异和像素均值差异。对比度差异的绝对值和像素均值差异的绝对值相加为差异指标的最终值目标背景差异指标的定义如下：其中，和分别代表图像中目标区域和背景区域的像素均值。和分别代表图像中目标区域和背景区域的对比度。步骤4是基于步骤1、2、3的3个指标，利用综合评价指标Pm来确定最终要输出的三个通道，第m通道Clm的质量评价指标Pm的定义如下：其中，和分别表示图像的对比度差异、信息熵和目标背景差异指标，n表示第n帧，n从1到N取整数值，α、β和γ分别表示和的权重系数，取值范围为正整数，m为从1到M取整数值，α、β是用来计算图像整体的质量，γ是计算图像内目标区域与背景区域的差异。步骤5是选择三个最大的Pm值对应的三个通道作为输出F：F＝{Clmax1,Clmax2,Clmax3}其中Clmax1、Clmax2、Clmax3分别代表三个最大的Pm值对应的三个通道，F为三通道视频。基于步骤5和现有的相关滤波的目标跟踪器，例如KCF、BACF等来进行目标跟踪。将步骤5得到的三通道视频F作为目标跟踪器的输入，根据输入视频当前帧的目标框进行初始化，然后在视频的下一帧中产生众多候选框，即运动模型部分，提取这些候选框的特征，即特征提取部分，然后对这些候选框评分，即观测模型部分，最后在这些评分中找一个得分最高的候选框作为预测的目标作为输出，得到高光谱视频目标跟踪的结果。实施例1本实施例中，高光谱视频包含16个波段，M＝16，第m个通道Clm的通道质量用该通道前5帧图像各指标的加权总和表示。对于公式、公式和公式中的对比度指标信息熵指标和目标背景差异指标m的取值范围为1到16，n的取值范围为1到5。在目标背景差异指标中，首先根据高光谱视频给定的地表真值将输入通道图像分为目标区域和背景区域，在本实施例中定义背景区域的宽和高为目标区域的宽和高的2.6倍，然后分别计算两个区域之间的对比度差异和像素均值差异，这两个绝对值相加为目标背景差异指标利用公式的综合评价指标Pm来确定最终要输出的三个通道，α、β和γ是权重系数，分别取α＝1、β＝1、γ＝2。最后，选择最大的三个Pm值所对应的通道作为三通道视频F输出。本实施例选择的目标跟踪器为背景感知相关滤波器，BACF的滤波器的训练如下：其中，Fk和hk分别指步骤5通道选择得到的三通道视频F和BACF滤波器的第k个通道，k的取值为1到3。是循环移位运算符，Fk表示将第t步的离散循环移位应用于通道Fk。T是Fk的边长，k是特征通道的数量。y是所需的相关响应。y是y的第t个元素。λ是正则化参数。P是一个D×T二元矩阵，用于裁剪通道Fk的中间D个元素。代表两个范数的平方。将步骤5得到的三通道视频F作为输入送入BACF目标跟踪器中，根据输入视频当前帧的目标框进行初始化，然后在下一帧中产生众多候选框，提取这些候选框的特征，然后对这些候选框评分，最后在这些评分中找一个得分最高的候选框作为预测的结果输出，从而得到高光谱视频目标跟踪的结果，输出结果为带有目标框的三通道视频。其中，BACF滤波器的学习率为0.0023。本实施例与其他高光谱目标跟踪器的性能对比实验如表1和图2所示，本实施例选取具有代表性的三个高光谱视频目标跟踪方法MHT、DeepHKCF和CNHT来验证本实施例的性能。所有实验均在Matlab2021下进行，电脑CPU为IntelCorei9-10900K，GPU为NVIDIA GeForce RTX 3060。表1各高光谱目标跟踪器性能对比实验从表1中可以看出，在精度方面，本实施例与目前最先进的高光谱目标跟踪器MHT相近，远超DeepHKCF和CNHT；在速度方面，本实施例达到了11.5FPS，是其他高光谱目标跟踪器的五倍以上。这是因为MHT、DeepHKCF和CNHT都大量使用了卷积网络，而卷积网络的计算量巨大，从而导致目标跟踪的速度很慢。本发明舍弃了当前应用最多的多层卷积网络方法，使用传统的图像处理方法来评估每个通道的质量，有效的避免了卷积带来的大量计算。实验证明，本发明可以在保证跟踪精度的同时有效地提高跟踪速度。本发明使用对比度指标、信息熵指标和目标背景差异指标来选择高光谱视频中通道质量最好的三个通道进行目标跟踪，可以在保证目标跟踪精度的同时有效的提升速度。经过试验可知，本发明的跟踪速度优于其他现有的高光谱目标跟踪方法。本发明的目标背景指标通过计算目标区域和背景区域的差异，选择目标与背景差异最大的通道，有效的保证了目标跟踪的精度。本发明舍弃了当前应用最多的多层卷积网络方法，使用传统的图像处理方法来评估每个通道的质量，在保证通道质量的同时有效的避免了卷积带来的大量计算。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
