标题title
采用神经网络模型的护眼灯智能调节方法
摘要abst
本发明涉及智能调节技术领域，具体涉及一种采用神经网络模型的护眼灯智能调节方法，该方法对护眼灯未打开时的光线环境图像设置标签值，得到标签图像，利用标签图像训练神经网络得到对应光线环境图像的关注图像；构建K‑SVD算法的损失函数以分别得到光线环境图像和个人数据图像的稀疏向量；基于稀疏向量计算光线环境图像和个人数据图像之间的相关性指标，以对光线环境图像的标签值进行调整，得到对应的新标签图像，利用由新标签图像重新训练好的神经网络对护眼灯进行调节。通过分析个人数据与训练集中的各数据之间的关系以对训练集中的各数据进行调整，使得由调整后的训练集所训练的神经网络能够更好适用于各用户的个性需求。
权利要求书clms
1.一种采用神经网络模型的护眼灯智能调节方法，其特征在于，该方法包括以下步骤：采集护眼灯未打开时的多张光线环境图像，分别对每张光线环境图像设置标签值，得到对应的标签图像，所述标签值为多组由光线强度和色温值组成的结构单元灯组；利用所述标签图像对神经网络进行训练，利用训练好的神经网络得到每张光线环境图像的关注图像；基于所述关注图像构建K-SVD算法的损失函数，利用EM算法对所述损失函数进行训练，以得到每张光线环境图像的稀疏向量；获取个人数据图像的稀疏向量，所述个人数据图像是指由个人需求手动调节护眼灯后所采集的光线环境图像；计算当前光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标，利用相关性指标对当前光线环境图像的标签值进行调整，得到新标签值；根据每张光线环境图像的新标签值得到对应的新标签图像，利用所述新标签图像对所述神经网络进行重新训练，以通过重新训练好的所述神经网络对护眼灯进行调节。2.如权利要求1所述的一种采用神经网络模型的护眼灯智能调节方法，其特征在于，所述神经网络的训练过程包括：基于构建的损失函数，将所述标签图像输入到神经网络中，通过第一卷积层得到第一特征图，将第一特征图与第一遮罩图像相乘得到第一处理图像，所述第一处理图像通过第二卷积层得到第二特征图，将第二特征图与第二遮罩图像相乘得到第二处理图像，所述第二处理图像通过全连接层输出特征向量。3.如权利要求2所述的一种采用神经网络模型的护眼灯智能调节方法，其特征在于，所述损失函数的构建方法为：根据第一遮罩图像和第二遮罩图像构建第一损失函数，其中，为第个遮罩图像中第个像素点的像素值，为第个遮罩图像中像素点的数量；将所述第一损失函数和均方差损失函数进行相加，相加结果即为神经网络的损失函数。4.如权利要求2所述的一种采用神经网络模型的护眼灯智能调节方法，其特征在于，所述利用训练好的神经网络得到每张光线环境的关注图像的方法，包括：根据训练好的神经网络获取每个光线环境图像的第一遮罩图像和第二遮罩图像，对第一遮罩图像和第二遮罩图像分别进行上采样，得到与光线环境图像相同大小的图像，将上采样得到的两个图像中相同位置的像素值进行相加求均值，得到综合遮罩图像，将所述综合遮罩图像作为对应光线环境图像的关注图像。5.如权利要求1所述的一种采用神经网络模型的护眼灯智能调节方法，其特征在于，所述构建K-SVD算法的损失函数的方法，包括：对第K张光线环境图像的关注图像中的像素值进行统计得到关注直方图，对所述关注直方图进行k-means聚类，得到低关注度类别和高关注度类别；获取高关注度类别中的最小像素值，以所述最小像素值为界限，将关注图像中大于所述最小像素值的像素点划分为高关注度像素点，得到高关注度遮罩图，将所述高关注度遮罩图与第K张光线环境图像相乘得到高关注度图像；所述K-SVD算法为的结构，其中，表示输入图像，表示字典矩阵，表示输入图像的稀疏向量；基于稀疏向量中每个稀疏值，将字典矩阵中维度至维度的字典向量所对应的稀疏值置0，得到第一稀疏向量，其中，N为字典矩阵的偶数列的列数；结合第一稀疏向量、字典矩阵和所述高关注度图像构建第二损失函数；将第二损失函数和所述K-SVD算法的原始损失函数进行相加，相加结果即为所述K-SVD算法的改进的损失函数，则所述原始损失函数，其中，为稀疏向量的L2范数。6.如权利要求5所述的一种采用神经网络模型的护眼灯智能调节方法，其特征在于，所述计算当前光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标的方法，包括：获取个人数据图像的稀疏向量中1维度至维度的子稀疏向量L1和个人数据图像的稀疏向量中维度至维度的子稀疏向量L2；令当前光线环境图像为第K张光线环境图像，获取第K张光线环境图像的稀疏向量中1维度至维度的子稀疏向量和第K张光线环境图像的稀疏向量中维度至维度的子稀疏向量；计算第K张光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标，则相关性指标的计算公式为：其中，为欧式距离；为第K张光线环境图像的关注图像对应高关注度类别的像素值均值；为第K张光线环境图像的关注图像对应低关注度类别的像素值均值。7.如权利要求6所述的一种采用神经网络模型的护眼灯智能调节方法，其特征在于，所述利用相关性指标对当前光线环境图像的标签值进行调整，得到新标签值的方法，包括：利用相关性指标对第K张光线环境图像的标签值中每个元素值进行调整，将调整后的元素值组成新标签值，其中调整公式为：其中，为第K张光线环境图像的标签值中调整后的第个元素值；为第K张光线环境图像的标签值中第个元素值；表示个人数据图像的标签值中调整后的第个元素值；表示个人数据图像的标签值中第个元素值。
说明书desc
技术领域本发明涉及智能调节技术领域，具体涉及一种采用神经网络模型的护眼灯智能调节方法。背景技术随着社会经济的发展和人们生活水平的提高，人们的学习需求也随之提高。护眼灯作为学习伴侣，其调控不好时会造成人眼疲劳，甚至会造成视力不良，因而需要根据环境和个人需求对护眼灯进行智能调控。为了实现对护眼灯进行准确的智能调控一般采用神经网络进行控制调整，而神经网络一般采用通用数据集进行训练来得到护眼灯的控制参数，但是由于每个人对护眼灯的需求不同，例如有些人需求光亮强度相对高的环境下学习，而有些人需求光温相对高一些的环境，因此传统情况下采用通用数据集训练得到神经网络，其得到的护眼灯的调控方式只能满足大众化需求，对于每个人的个性化需求不能满足。发明内容为了解决上述技术问题，本发明的目的在于提供一种采用神经网络模型的护眼灯智能调节方法，所采用的技术方案具体如下：采集护眼灯未打开时的多张光线环境图像，分别对每张光线环境图像设置标签值，得到对应的标签图像，所述标签值为多组由光线强度和色温值组成的结构单元灯组；利用所述标签图像对神经网络进行训练，利用训练好的神经网络得到每张光线环境图像的关注图像；基于所述关注图像构建K-SVD算法的损失函数，利用EM算法对所述损失函数进行训练，以得到每张光线环境图像的稀疏向量；获取个人数据图像的稀疏向量，所述个人数据图像是指由个人需求手动调节护眼灯后所采集的光线环境图像；计算当前光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标，利用相关性指标对当前光线环境图像的标签值进行调整，得到新标签值；根据每张光线环境图像的新标签值得到对应的新标签图像，利用所述新标签图像对所述神经网络进行重新训练，以通过重新训练好的所述神经网络对护眼灯进行调节。进一步的，所述神经网络的训练过程包括：基于构建的损失函数，将所述标签图像输入到神经网络中，通过第一卷积层得到第一特征图，将第一特征图与第一遮罩图像相乘得到第一处理图像，所述第一处理图像通过第二卷积层得到第二特征图，将第二特征图与第二遮罩图像相乘得到第二处理图像，所述第二处理图像通过全连接层输出特征向量。进一步的，所述损失函数的构建方法为：根据第一遮罩图像和第二遮罩图像构建第一损失函数，其中，为第个遮罩图像中第个像素点的像素值，为第个遮罩图像中像素点的数量；将所述第一损失函数和均方差损失函数进行相加，相加结果即为神经网络的损失函数。进一步的，所述利用训练好的神经网络得到每张光线环境的关注图像的方法，包括：根据训练好的神经网络获取每个光线环境图像的第一遮罩图像和第二遮罩图像，对第一遮罩图像和第二遮罩图像分别进行上采样，得到与光线环境图像相同大小的图像，将上采样得到的两个图像中相同位置的像素值进行相加求均值，得到综合遮罩图像，将所述综合遮罩图像作为对应光线环境图像的关注图像。进一步的，所述构建K-SVD算法的损失函数的方法，包括：对第K张光线环境图像的关注图像中的像素值进行统计得到关注直方图，对所述关注直方图进行k-means聚类，得到低关注度类别和高关注度类别；获取高关注度类别中的最小像素值，以所述最小像素值为界限，将关注图像中大于所述最小像素值的像素点划分为高关注度像素点，得到高关注度遮罩图，将所述高关注度遮罩图与第K张光线环境图像相乘得到高关注度图像；所述K-SVD算法为的结构，其中，表示输入图像，表示字典矩阵，表示输入图像的稀疏向量；基于稀疏向量中每个稀疏值，将字典矩阵中维度至维度的字典向量所对应的稀疏值置0，得到第一稀疏向量，其中，N为字典矩阵的偶数列的列数；结合第一稀疏向量、字典矩阵和所述高关注度图像构建第二损失函数；将第二损失函数和所述K-SVD算法的原始损失函数进行相加，相加结果即为所述K-SVD算法的改进的损失函数，所述原始损失函数，其中，为稀疏向量的L2范数。进一步的，所述计算当前光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标的方法，包括：获取个人数据图像的稀疏向量中1维度至维度的子稀疏向量L1和个人数据图像的稀疏向量中维度至维度的子稀疏向量L2；令当前光线环境图像为第K张光线环境图像，获取第K张光线环境图像的稀疏向量中1维度至维度的子稀疏向量和第K张光线环境图像的稀疏向量中维度至维度的子稀疏向量；计算第K张光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标，则相关性指标的计算公式为：其中，为欧式距离；为第K张光线环境图像的关注图像对应高关注度类别的像素值均值；为第K张光线环境图像的关注图像对应低关注度类别的像素值均值。进一步的，所述利用相关性指标对当前光线环境图像的标签值进行调整，得到新标签值的方法，包括：利用相关性指标对第K张光线环境图像的标签值中每个元素值进行调整，将调整后的元素值组成新标签值，其中调整公式为：其中，为第K张光线环境图像的标签值中调整后的第个元素值；为第K张光线环境图像的标签值中第个元素值；表示个人数据图像的标签值中调整后的第个元素值；表示个人数据图像的标签值中第个元素值。本发明实施例至少具有如下有益效果：基于个人用灯习惯采集个人数据，通过分析个人数据与神经网络的训练集中的各通用数据之间的相关性，基于相关性对神经网络的训练集中的各通用数据进行调整，利用调整后的训练集对神经网络重新训练，使得重新训练好的神经网络能够更好的自适应调控，以满足各用户的个性需求。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明一个实施例提供的一种采用神经网络模型的护眼灯智能调节方法的步骤流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种采用神经网络模型的护眼灯智能调节方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一个或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种采用神经网络模型的护眼灯智能调节方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种采用神经网络模型的护眼灯智能调节方法的步骤流程图，该方法包括以下步骤：步骤S001，采集护眼灯未打开时的多张光线环境图像，分别对每张光线环境图像设置标签值，得到对应的标签图像；利用标签图像对神经网络进行训练，利用训练好的神经网络得到每张光线环境图像的关注图像。具体的，由于护眼灯需要根据其周围的光线环境数据来进行智能调控，所以需要采集护眼灯未打开时周围的光线环境图像：在护眼灯上安装相机，利用该相机拍摄得到护眼灯周围的光线环境图像。需要说明的是，护眼灯是在一个大环境下单独使用的小灯，且大环境中存在大灯，因此利用护眼灯上的相机能够采集护眼灯周围的光线环境图像。由于护眼灯存在10个结构单元灯组，也即是10个不同档位的开关，每个结构单元灯组都是由光线强度和色温值组成的，每个结构单元灯组是不一样的，因此根据护眼灯的结构单元灯组，对每张光线环境图像设置标签值，则标签值为10组结构单元灯组，也即是标签值中包含20个元素值。需要说明的是，结构单元灯组的数量10是本发明实施例中给出的示例值，实施者可根据需求进行调整。构建神经网络，神经网络的网络结构为：2个卷积层和1个全连接层，每个卷积层包含分组卷积操作、池化操作和激活函数等，且每个卷积层采用ResNet网络结构，由于ResNet网络是常用的神经网络，本发明实施例中不再对该网络进行详细叙述。将标签图像输入到神经网络中，标签图像通过第一卷积层得到第一特征图，将第一特征图与第一遮罩图像相乘得到第一处理图像，第一处理图像通过第二卷积层得到第二特征图，将第二特征图与第二遮罩图像相乘得到第二处理图像，第二处理图像通过全连接层输出特征向量，该特征向量表征输入图像的标签值，则特征向量是一个20维向量。需要说明的是，第一遮罩图像和第二遮罩图像都是单通道图像，每个遮罩图像的大小都与相乘对象的图像大小一样，且神经网络训练前每个遮罩图像中的数据都是随机初始化得到的，会随着神经网络的训练一起进行数据更新。构建神经网络的损失函数，为了使得每个遮罩图像都为关注度图像，应保障第一遮罩图像和第二遮罩图像中的数据尽可能稀疏，故构建遮罩图像的第一损失函数，则第一损失函数的计算公式为：，其中，为第个遮罩图像中第个像素点的像素值，为第个遮罩图像中像素点的数量；令第一损失函数和均方差损失函数进行相加，相加结果即为神经网络的损失函数。将各个标签图像输入到神经网络中，利用随机梯度下降法进行训练，直至神经网络的损失函数收敛得到训练好的神经网络，进而根据训练好的神经网络获取每个光线环境图像的第一遮罩图像和第二遮罩图像，对第一遮罩图像和第二遮罩图像分别进行上采样，得到与光线环境图像相同大小的图像，将上采样得到的两个图像中相同位置的像素值进行相加求均值，得到综合遮罩图像，且综合遮罩图像中的每个像素值为均值，进而将综合遮罩图像作为对应光线环境图像的关注图像。步骤S002，基于关注图像构建K-SVD算法的损失函数，利用EM算法对损失函数进行训练，以得到每张光线环境图像的稀疏向量。具体的，由于K-SVD算法对于特征提取与控制有较好的表现，因而利用K-SVD算法对关注图像进行特征提取及隔离。首先，K-SVD算法为的结构，其中，表示输入图像，表示字典矩阵，表示输入图像的稀疏向量，为了便于说明，则将稀疏向量中每个维度上的值称为稀疏值，每个稀疏值对应字典矩阵中的一个字典向量，即一列对应一个字典向量。本发明实施例构建K-SVD算法的损失函数以将关注图像的高关注特征隔离在字典矩阵的维度至维度之间的字典向量中，N是指字典矩阵的列数，且为偶数列，则具体过程为：筛选关注图像的高关注特征。具体的，为了便于分析，以第K张光线环境图像的关注图像为例来说明：关注图像的各像素值为关注度值，对关注图像基于其关注度值进行统计得到关注直方图，对关注直方图进行k-means聚类分析，聚类类别数为两类，将每个类别中所有像素点的关注度值求均值得到每个类别的关注度均值，关注度均值大的那个类别为高关注度类别，关注度均值小的那个类别为低关注度类别；获取高关注度类别中的最小关注度值，以最小关注度值为界限，将大于最小关注度值的像素点划分为高关注度像素点，则得到高关注度遮罩图,将高关注度遮罩图与第K张光线环境图像相乘得到高关注度图像。构建K-SVD算法的损失函数。具体的，为了使高关注像素对应的特征分隔在维度至维度的字典向量中，将维度至维度的字典向量集合记为D2，获取第K张光线环境图像的稀疏向量，基于稀疏向量中的每个稀疏值，将字典向量集合对应在稀疏向量中的各稀疏值置零得到第一稀疏向量，通过该方式就会将第K张光线环境图像的字典向量集合对应的特征信息去除，因而对应的图像信息为只包含字典向量集合外的特征图像，而要使字典向量集合外尽可能多的包含高关注度图像特征，则应使对应的图像与高关注图像尽可能相同，则第K张光线环境图像对应高关注度图像的第二损失函数的公式如下：需要说明的是，通过使第二损失函数尽可能小，进而使只包含维度至维度的字典向量的图像与高关注度图像尽可能相同，从而实现将第K张光线环境图像的高关注特征隔离在字典矩阵的维度至维度之间的字典向量中。将第二损失函数和K-SVD算法的原始损失函数进行相加，将相加结果作为K-SVD算法的综合损失函数，也即是改进的损失函数，其中，原始损失函数的计算公式为：其中，为稀疏向量的L2范数。进一步的，利用K-SVD算法的综合损失函数，通过EM算法进行训练，直至综合损失函数收敛训练完成，获取训练完成时每张光线环境的稀疏向量。步骤S003，获取个人数据图像的稀疏向量，个人数据图像是指由个人需求手动调节护眼灯后所采集的光线环境图像；计算当前光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标，利用相关性指标对当前光线环境图像的标签值进行调整，得到新标签值。具体的，采集个人数据图像，其中，个人数据图像是指由个人需求手动调节护眼灯后所采集的光线环境图像，并利用步骤S002的方法得到个人数据图像的稀疏向量。分别获取个人数据图像的稀疏向量中1维度至维度的子稀疏向量L1、个人数据图像的稀疏向量中维度至维度的子稀疏向量L2、第K张光线环境图像的稀疏向量中1维度至维度的子稀疏向量、第K张光线环境图像的稀疏向量中维度至维度的子稀疏向量，则计算第K张光线环境图像的稀疏向量与个人数据图像的稀疏向量之间的相关性指标，则相关性指标的计算公式为：其中，为欧式距离；为第K张光线环境图像的关注图像对应高关注度类别的关注度均值；为第K张光线环境图像的关注图像对应低关注度类别的关注度均值。利用第K张光线环境图像对应的相关性指标对第K张光线环境图像的标签值进行调整，得到新标签值，则标签值的调整公式为：其中，为第K张光线环境图像的标签值中调整后的第个元素值；为第K张光线环境图像的标签值中第个元素值；表示个人数据图像的标签值中调整后的第个元素值，也即是用户手动调节后的元素值；表示个人数据图像的标签值中第个元素值，也即是用户没有调整时元素值。利用标签值的调整公式对第K张光线环境图像的标签值中每个元素值进行调整，将调整后的元素值组成新标签值。同理，分别计算每张光线环境图像与个人数据图像之间的相关性指标，利用光线环境图像的相关性指标对光线环境图像的标签值中每个元素值进行调整，得到对应的新标签值，一张光线环境图像对应一个新标签值。步骤S004，根据每张光线环境图像的新标签值得到对应的新标签图像，利用新标签图像对神经网络进行重新训练，以通过重新训练好的神经网络对护眼灯进行调节。具体的，利用步骤S003得到每张光线环境图像的新标签值，对光线环境图像设置新标签值得到对应的新标签图像，将新标签图像输入到神经网络中，通过梯度下降法进行重新训练得到重新训练好的神经网络，进而利用重新训练好的神经网络对护眼灯进行智能调节。综上所述，本发明实施例提供了一种采用神经网络模型的护眼灯智能调节方法，该方法对护眼灯未打开时的光线环境图像设置标签值，得到标签图像，利用标签图像训练神经网络得到对应光线环境图像的关注图像；构建K-SVD算法的损失函数，分别得到光线环境图像和个人数据图像的稀疏向量，基于稀疏向量计算光线环境图像和个人数据图像之间的相关性指标，利用相关性指标对标签值进行调整，得到新标签值；根据新标签值对应的新标签图像对神经网络重新训练，以通过重新训练好的神经网络对护眼灯进行调节。通过分析个人数据与训练集中的各数据之间的关系以对训练集中的各数据进行调整，使得由调整后的训练集所训练的神经网络能够更好适用于各用户的个性需求。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。且上述对本说明书特定实施例进行了描述。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
