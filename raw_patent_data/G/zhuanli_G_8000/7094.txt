标题title
一种基于空间相关性和监测数据的精细风场模拟方法
摘要abst
本发明公开一种基于空间相关性和监测数据的精细风场模拟方法。步骤1：获得空间相关性系数场，其通过不结合观测资料的WRF模拟获得；步骤2：获得传统观测及非传统观测得到的观测资料；步骤3：结合步骤2的观测资料的数值模拟模块考虑流体力学控制方程和多物理过程，通过运行步骤1的WRF核心模块ARW进而求得准确的空间场资料。本发明对现有方法中忽略地形、风向和大气环流等因素的影响的表述，其精度不准确的问题。
权利要求书clms
1.一种基于空间相关性和监测数据的精细风场模拟方法，其特征在于，所述精细风场模拟方法包括以下步骤：步骤1：获得空间相关性系数场，其通过不结合观测资料的WRF模拟获得；步骤2：获得传统观测及非传统观测得到的观测资料；步骤3：结合步骤2的观测资料的数值模拟模块考虑流体力学控制方程和多物理过程，通过运行步骤1的WRF核心模块ARW进而求得准确的空间场资料。2.根据权利要求1所述一种基于空间相关性和监测数据的精细风场模拟方法，其特征在于，所述步骤1具体包括以下步骤：步骤1.1：WRF前处理模块WPS，进行地形和初始资料场的处理；步骤1.2：WRF核心计算模块ARW数值模拟，包含时间相关项、区域相关项、物理模型相关项、动力模型相关项和边界条件的设置。3.根据权利要求1所述一种基于空间相关性和监测数据的精细风场模拟方法，其特征在于，所述步骤1.1地形和初始资料场具体包含嵌套层数、模拟起始和结束时间、数据存储时间间隔、Netcdf数据存储格式、母区域编号、母区域水平网络间距比值、子区域水平网络间距比值、各区域起始坐标、各区域结束坐标、地形数据精度、地表数据精度、最外层区域水平网格尺度投影坐标系、参考坐标、地形数据存储位置和地表数据存储位置。4.根据权利要求1所述一种基于空间相关性和监测数据的精细风场模拟方法，其特征在于，所述步骤1.2时间相关项具体为：模拟的天、小时、分钟和秒数；模拟起始的年、月、日、小时；模拟结束的年、月、日、小时及模拟数据存储时间间隔；所述步骤1.2区域相关项具体为：最外层时间步长；嵌套层数；内层嵌套起始和结束坐标；竖向层数；计算域顶层气压；对应于WPS最终生成文件的大气层熟和土壤层数；隔层水平网格间距；嵌套隔层编号；母区域编号；各层起始坐标；母区域空间和时间比例及子区域对母区域是否有反馈；所述步骤1.2物理模型相关项具体为：微物理过程方案；积云参数化方案；长波辐射方案；短波辐射方案；行星边界层方案；表层物理方案；上述方案的启用时间间隔及是否考虑城市影响；所述步骤1.2动力模型相关项具体为：扩散系数；涡粘系数；数值算法；基准温度；顶层重力波沾性耗散高度及系数及动量和热量扩散系数；所述步骤1.2边界条件具体为边界松弛网格数和边界条件设置。5.根据权利要求1所述一种基于空间相关性和监测数据的精细风场模拟方法，其特征在于，所述步骤1中基于空间相关性的WRF模拟具体为：考虑局部地形影响，将加权函数W替换为观测值与空间各点的风速空间相关函数R；相关函数表示如式-所示：其中，a为观测点和计算网格点处的同化变量，为空间坐标，Cov为协方差，E为期望，R为相关函数。6.根据权利要求1所述一种基于空间相关性和监测数据的精细风场模拟方法，其特征在于，所述步骤2传统观测包括探空仪、船舶/浮标和气象塔站；所述步骤2非传统观测包括飞机探测、廓线仪和雷达卫星。7.根据权利要求1所述一种基于空间相关性和监测数据的精细风场模拟方法，其特征在于，所述步骤3具体为采用nudging方法观测值数量；起始和结束时间；是否同化风速、温度和湿度数据设置；是否同化强度设置；同化水平、数值和时间窗口大小及其他相关误差、频率参数设置。
说明书desc
技术领域本发明属于气象学和风工程领域；具体涉及一种基于空间相关性和监测数据的精细风场模拟方法。背景技术如何获得准确的风场信息对于评估大土木工程重大基础设施的风效应具有重要的影响。中尺度数值模式WRF可以考虑多物理过程来模拟真实大气和地形下的区域风场。WRF模型的优点是多物理场，可以获取局部空间风场；缺点是风速的模拟结果与观测数据存在一定偏差。相反，观测数据的优点是可靠性高；但观测点位数量有限。如果将WRF模型与观测数据各自的优势相结合，则可以更准确的改善模拟风场。WRF中的observation-nudging方法具有实现观测资料与中尺度数值模式相结合的功能。但是，WRF中原始observation-nudging方法的主要缺点是，观测点对周围空间计算点的影响在时间和空间上是完全数学表达的。此外，它忽略了地形、风向和大气环流等因素的影响，这在物理上是不合理的且精度不准确。发明内容本发明提供一种基于空间相关性和监测数据的精细风场模拟方法，针对现有方法中忽略地形、风向和大气环流等因素的影响的表述，其精度不准确的问题。既可以提高单点的风速准确度，也可显著改善空间风场模拟结果。更具物理意义的结合观测资料以使得数值模拟结果更准确、更适用于工程领域。本发明通过以下技术方案实现：一种基于空间相关性和监测数据的精细风场模拟方法，所述精细风场模拟方法包括以下步骤：步骤1：获得空间相关性系数场，其通过不结合观测资料的WRF模拟获得；步骤2：获得传统观测及非传统观测得到的观测资料；步骤3：结合步骤2的观测资料的数值模拟模块考虑流体力学控制方程和多物理过程，通过运行步骤1的WRF核心模块ARW进而求得准确的空间场资料。进一步的，所述步骤1具体包括以下步骤：步骤1.1：WRF前处理模块WPS，进行地形和初始资料场的处理；步骤1.2：WRF核心计算模块ARW数值模拟，包含时间相关项、区域相关项、物理模型相关项、动力模型相关项和边界条件的设置。进一步的，所述步骤1.1地形和初始资料场具体包含嵌套层数、模拟起始和结束时间、数据存储时间间隔、Netcdf数据存储格式、母区域编号、母区域水平网络间距比值、子区域水平网络间距比值、各区域起始坐标、各区域结束坐标、地形数据精度、地表数据精度、最外层区域水平网格尺度投影坐标系、参考坐标、地形数据存储位置和地表数据存储位置。进一步的，所述步骤1.2时间相关项具体为：模拟的天、小时、分钟和秒数；模拟起始的年、月、日、小时；模拟结束的年、月、日、小时及模拟数据存储时间间隔；所述步骤1.2区域相关项具体为：最外层时间步长；嵌套层数；内层嵌套起始和结束坐标；竖向层数；计算域顶层气压；对应于WPS最终生成文件的大气层熟和土壤层数；隔层水平网格间距；嵌套隔层编号；母区域编号；各层起始坐标；母区域空间和时间比例及子区域对母区域是否有反馈；所述步骤1.2物理模型相关项具体为：微物理过程方案；积云参数化方案；长波辐射方案；短波辐射方案；行星边界层方案；表层物理方案；上述方案的启用时间间隔及是否考虑城市影响；所述步骤1.2动力模型相关项具体为：扩散系数；涡粘系数；数值算法；基准温度；顶层重力波沾性耗散高度及系数及动量和热量扩散系数；所述步骤1.2边界条件具体为边界松弛网格数和边界条件设置。进一步的，所述步骤1中基于空间相关性的WRF模拟具体为：考虑局部地形影响，将加权函数W替换为观测值与空间各点的风速空间相关函数R；相关函数表示如式-所示：其中，a为观测点和计算网格点处的同化变量，为空间坐标，Cov为协方差，E为期望，R为相关函数。进一步的，所述步骤2传统观测包括探空仪、船舶/浮标和气象塔站；所述步骤2非传统观测包括飞机探测、廓线仪和雷达卫星。进一步的，所述步骤3具体为采用nudging方法观测值数量；起始和结束时间；是否同化风速、温度和湿度数据设置；是否同化强度设置；同化水平、数值和时间窗口大小及其他相关误差、频率参数设置。本发明的有益效果是：本发明既可以提高单点的风速准确度，也可显著改善空间风场模拟结果。本发明更具物理意义的结合观测资料以使得数值模拟结果更准确、更适用于工程领域。本发明通过结合少量观测资料，实现区域空间风场更具物理意义的准确模拟。附图说明图1是本发明的功能结构图。图2是本发明的WRF前处理模块WPS生成计算所需初始和边界条件过程图，其中为参数设置，为参数说明。图3是本发明的WRF核心计算模块ARW数值模拟参数设置图，其中为参数设置，为参数说明。图4是本发明的数值模式WRF结合观测资料数值模拟参数设置图，其中为参数设置，为参数说明。图5是不同方法得出的风速等值云图对比图，其中Case-0，不采用observation-nudging方法的WRF模拟，Case-1，原始WRF observation-nudging方法，基于空间相关性的WRF observation-nudging方法。具体实施方式下面将结合本发明实施例中的附图对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明针对WRF中原始observation-nudging方法存在的主要缺点为观测点对周围空间计算点的影响在时间和空间上是完全数学表达的，这对气象领域关注大尺度区域是有效的。但是，它忽略了地形、风向和大气环流等因素的影响，这在物理上是不合理的，对工程应用领域中复杂地形情况是不准确的。因此，考虑上述因素的影响，提出一种基于空间相关性的observation-nudging方法，更好的结合WRF模型与观测数据各自的优势，获得更准确的模拟风场资料。实施例1如图1所示，一种基于空间相关性和监测数据的精细风场模拟方法，所述精细风场模拟方法包括以下步骤：步骤1：获得空间相关性系数场，其通过不结合观测资料的WRF模拟获得；步骤2：获得传统观测及非传统观测得到的观测资料；步骤3：结合步骤2的观测资料的数值模拟模块考虑流体力学控制方程和多物理过程，通过运行步骤1的WRF核心模块ARW进而求得准确的空间场资料。同时需考虑影响空间尺度和时间尺度。进一步的，所述步骤1具体包括以下步骤：步骤1.1：WRF前处理模块WPS，进行地形和初始资料场的处理；步骤1.2：WRF核心计算模块ARW数值模拟，包含时间相关项、区域相关项、物理模型相关项、动力模型相关项和边界条件的设置。进一步的，所述步骤1.1地形和初始资料场具体包含嵌套层数、模拟起始和结束时间、数据存储时间间隔、Netcdf数据存储格式、母区域编号、母区域水平网络间距比值、子区域水平网络间距比值、各区域起始坐标、各区域结束坐标、地形数据精度、地表数据精度、最外层区域水平网格尺度投影坐标系、参考坐标、地形数据存储位置和地表数据存储位置。如图2所示。进一步的，所述步骤1.2时间相关项具体为：模拟的天、小时、分钟和秒数；模拟起始的年、月、日、小时；模拟结束的年、月、日、小时及模拟数据存储时间间隔；所述步骤1.2区域相关项具体为：最外层时间步长；嵌套层数；内层嵌套起始和结束坐标；竖向层数；计算域顶层气压；对应于WPS最终生成文件的大气层熟和土壤层数；隔层水平网格间距；嵌套隔层编号；母区域编号；各层起始坐标；母区域空间和时间比例及子区域对母区域是否有反馈；所述步骤1.2物理模型相关项具体为：微物理过程方案；积云参数化方案；长波辐射方案；短波辐射方案；行星边界层方案；表层物理方案；上述方案的启用时间间隔及是否考虑城市影响；所述步骤1.2动力模型相关项具体为：扩散系数；涡粘系数；数值算法；基准温度；顶层重力波沾性耗散高度及系数及动量和热量扩散系数；所述步骤1.2边界条件具体为边界松弛网格数和边界条件设置。如图3所示。进一步的，所述步骤1中基于空间相关性的WRF模拟具体为：考虑局部地形影响，将加权函数W替换为观测值与空间各点的风速空间相关函数R；相关函数表示如式-所示：其中，a为观测点和计算网格点处的同化变量，为空间坐标，Cov为协方差，E为期望，R为相关函数。进一步的，所述步骤2传统观测包括探空仪、船舶/浮标和气象塔站；所述步骤2非传统观测包括飞机探测、廓线仪和雷达卫星。进一步的，所述步骤3具体为采用nudging方法观测值数量；起始和结束时间；是否同化风速、温度和湿度数据设置；是否同化强度设置；同化水平、数值和时间窗口大小及其他相关误差、频率参数设置。如图4所示。实施例2基于空间相关性的WRF observation-nudging方法简介：WRF的基本控制方程如式-所示：μ＝phs-pht原有的observation-nudging方法中权重函数表达如式所示：在物理上，observation-nudging方法中权重函数代表观测资料对周围空间点的影响强度，或者可以看作是观测资料与周围空间点的相关性。从这个观点出发，可以发现当前WRF中权重函数对于模拟复杂地形风场是不合理的。具体原因是对气象领域，首先考虑的尺度较大，至少几公里量级，所以山体影响不大；另外，一般同化的雷达、卫星等数据，距地表有一定距离；所以权重函数比较合适。但是对于工程领域来说，关注的尺度相对较小，需要考虑边界层内山体等的影响；观测资料对周围空间点的影响程度不仅仅是距离的函数；那么这个权重函数对于复杂地形来说，过于理想化，未考虑大气湍流的物理特性，是不合理的。在式-，可以看到权重函数在WRF原有observation-nudging方法中仅仅是距离的函数，说明只要是与观测值具有相同距离的空间点均具有相同的权重系数。显然，对于大气边界层而言并非如此，权重函数会受到地形的严重影响。众所周知，两个位置上变量的相互影响可以用空间相关函数来表示。因此，考虑到局部地形影响，在本软件中将加权函数W替换为观测值与空间各点的风速空间相关函数R。相关函数表示如式-所示。本实例在FORTRAN和C语言环境下开发，采用面向对象方式开发设计。具体采用算法但无界面架构，在命令窗口进行输入参数设定，通过窗口调用计算程序、观测资料及相关性场资料等；进而进行模拟计算输出结果。从功能角度来讲，本发明可以结合现场实测数据与数值模拟结果各自的优点，同时考虑地形、风向和大气环流等因素的影响，实现更准确的风场模拟。从使用角度来讲，本发明主要包括相关性信息获得、观测资料信息、数值模拟模块。相关性信息获得主要通过不加入观测资料的数值模拟结果获得；观测资料可以涵盖各观测平台，包括传统观测以及非传统观测等；数值模拟模块考虑流体力学控制方程和多物理过程。实施例3为了验证所提出的基于空间相关性的WRF observation-nudging方法的优势，本发明开展三种方法的比较研究。Case-0，不采用observation-nudging方法的WRF模拟；Case-1，原始WRF observation-nudging方法，采用10分钟时间间隔观测数据和1分钟的时间窗；Case-2，基于空间相关性的WRF observation-nudging方法，采用10分钟时间间隔观测数据和1分钟的时间窗。对于所有模拟算例，标准参数化方案如下：Yonsei University边界层方案，WRF Single-Moment 5-class微物理方案，Grell-Freitas ensemble积云方案，Rapid Radiative Transfer Model长波辐射方案，Rapid Radiative TransferModel for General Circulation Models短波辐射方案，以及UnifiedNoah地表模型。表1和表2分别显示了WRF模拟基本参数和observation-nudging方法基本参数。在WRF observation-nudging方法模拟中，仅将跨1/4处的观测入流风速同化到WRF模型，而选择跨中1/2和3/4处的观测入流风速作为验证数据，表3列出了观测位置的详细信息。表1 WRF模拟基本参数表2 observation-nudging方法基本参数表3观测点和验证点基本信息图5为高度54.5m在时间2014_09_22_20:50:00的风速等值云图。如图5所示，observation-nudging方法可以很好的校正观测位置周围的风场。在桥梁位置处，风吹到两座山之间的山谷中。然而，在不采用observation-nudging方法的WRF模拟方法模拟中，波谷引起的风速转向和加速效果并未得到充分体现。在原始的WRF observation-nudging方法模拟中，虽然观测值风速引导了模拟结果，但是影响仅取决于距离，即在距观测点相同距离处，观测数据对周围风场的影响相同。因此，其影响效果随着刚性盘的移动而扩散，显然，这在复杂地形上模拟风场是不合理的。因为众所周知，自然风会受到大气边界层的影响，基于空间相关性的WRF observation-nudging方法模拟可以清晰的反映出地形和大气环流随时间的变化对风场的影响。因此，从风场的角度来看，基于空间相关性的WRF observation-nudging方法具有更强的物理意义。
