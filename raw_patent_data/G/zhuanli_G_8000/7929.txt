标题title
服饰生成模型的训练、生成服饰图像的方法和装置
摘要abst
本公开提供了服饰生成模型的训练、生成服饰图像的方法和装置，涉及人工智能技术领域，具体为增强现实AR、虚拟现实、计算机视觉、深度学习等技术领域，可应用于元宇宙等场景。具体实现方案为：分别将形状掩码图像和纹理图像输入形状编码器和纹理编码器，得到预定层数的形状特征和纹理特征；将每层形状特征和每层的纹理特征对应相加，得到预定层数的融合特征后输入预训练模型，输出虚拟服饰图像；基于原始图像和虚拟服饰图像之间的差异调整形状编码器和纹理编码器的相关参数；基于调整后的形状编码器、纹理编码器和预训练模型获得服饰生成模型。通过该实施方式能够得到一种可以生成指定款式的服饰图像的模型。
权利要求书clms
1.一种服饰生成模型的训练方法，包括：获取服饰的样本图像，其中，所述样本图像包括原始图像、形状掩码图像和纹理图像；将所述形状掩码图像输入形状编码器，得到预定层数的形状特征；将所述纹理图像输入纹理编码器，得到预定层数的纹理特征；将每层形状特征和每层的纹理特征对应相加，得到预定层数的融合特征后输入预训练模型，输出虚拟服饰图像；基于所述原始图像和所述虚拟服饰图像之间的差异调整所述形状编码器和所述纹理编码器的相关参数；基于调整后的形状编码器、纹理编码器和所述预训练模型获得服饰生成模型。2.根据权利要求1所述的方法，其特征在于，所述基于所述原始图像和所述虚拟服饰图像之间的差异调整所述形状编码器和所述纹理编码器的相关参数，包括：计算所述原始图像和所述虚拟服饰图像之间的2D二维距离损失；计算所述原始图像和所述虚拟服饰图像之间的感知损失；将所述2D距离损失和所述感知损失的加权和作为第一损失值；若第一损失值大于等于第一预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。3.根据权利要求2所述的方法，其特征在于，所述方法还包括：对所述虚拟服饰图像进行图像语义分割，得到分割掩码图；计算所述分割掩码图和所述形状掩码图像之间的距离L1损失；将所述距离L1损失、所述2D距离损失和所述感知损失的加权和作为第二损失值；若第二损失值大于等于第二预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。4.根据权利要求1所述的方法，其特征在于，所述获取服饰的样本图像，包括：获取服饰的原始图像；将所述原始图像进行图像语义分割，得到形状掩码图像；将所述原始图像进行随机遮挡，得到纹理图像；将所述原始图像与对应的形状掩码图像和纹理图像组合成一个样本图像。5.根据权利要求1-4中任一项所述的方法，其特征在于，所述预训练模型为生成式对抗网络的生成器，所述形状编码器和所述纹理编码器为层数相同的卷积神经网络。6.一种生成服饰图像的方法，包括：获取指定款式的服饰的形状图像和纹理图像；将所述形状图像和所述纹理图像输入采用如权利要求1-5之一所述的方法生成的服饰生成模型中，生成指定款式的服饰图像。7.一种服饰生成模型的训练装置，包括：获取单元，被配置成获取服饰的样本图像，其中，所述样本图像包括原始图像、形状掩码图像和纹理图像；形状编码单元，被配置成将所述形状掩码图像输入形状编码器，得到预定层数的形状特征；纹理编码单元，被配置成将所述纹理图像输入纹理编码器，得到预定层数的纹理特征；融合单元，被配置成将每层形状特征和每层的纹理特征对应相加，得到预定层数的融合特征后输入预训练模型，输出虚拟服饰图像；调整单元，被配置成基于所述原始图像和所述虚拟服饰图像之间的差异调整所述形状编码器和所述纹理编码器的相关参数；输出单元，被配置成基于调整后的形状编码器、纹理编码器和所述预训练模型获得服饰生成模型。8.根据权利要求7所述的装置，其特征在于，所述调整单元进一步被配置成：计算所述原始图像和所述虚拟服饰图像之间的2D距离损失；计算所述原始图像和所述虚拟服饰图像之间的感知损失；将所述2D距离损失和所述感知损失的加权和作为第一损失值；若第一损失值大于等于第一预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。9.根据权利要求8所述的装置，其特征在于，所述调整单元进一步被配置成：对所述虚拟服饰图像进行图像语义分割，得到分割掩码图；计算所述分割掩码图和所述形状掩码图像之间的距离L1损失；将所述距离L1损失、所述2D距离损失和所述感知损失的加权和作为第二损失值；若第二损失值大于等于第二预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。10.根据权利要求7所述的装置，其特征在于，所述获取单元进一步被配置成：获取服饰的原始图像；将所述原始图像进行图像语义分割，得到形状掩码图像；将所述原始图像进行随机遮挡，得到纹理图像；将所述原始图像与对应的形状掩码图像和纹理图像组合成一个样本图像。11.根据权利要求7-10中任一项所述的装置，其特征在于，所述预训练模型为生成式对抗网络的生成器，所述形状编码器和所述纹理编码器为层数相同的卷积神经网络。12.一种生成服饰图像的装置，包括：获取单元，被配置成获取指定款式的服饰的形状图像和纹理图像；生成单元，被配置成将所述形状图像和所述纹理图像输入采用如权利要求7-11之一所述的装置生成的服饰生成模型中，生成指定款式的服饰图像。13.一种电子设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-6中任一项所述的方法。14.一种存储有计算机指令的非瞬时计算机可读存储介质，其特征在于，所述计算机指令用于使所述计算机执行根据权利要求1-6中任一项所述的方法。15.一种计算机程序产品，包括计算机程序，所述计算机程序在被处理器执行时实现根据权利要求1-6中任一项所述的方法。
说明书desc
技术领域本公开涉及人工智能技术领域，具体为增强现实AR、虚拟现实、计算机视觉、深度学习等技术领域，可应用于元宇宙等场景，具体为一种服饰生成模型的训练、生成服饰图像的方法和装置。背景技术近年来，随着计算机技术的迅速发展，图像处理技术应用于各方面。例如，卡通虚拟形象衣服个性化重建。需要根据拍摄的真人照片生成2D卡通虚拟形象衣服部件，要求生成的衣服满足给定模板形状，并且和原照片衣服保持较高相似度。相关技术生成的服饰图像形状和纹理不受控制，无法实现特定款式形状和纹理的服饰图像高相似度重建。发明内容本公开提供了一种服饰生成模型的训练、生成服饰图像的方法、装置、设备、存储介质以及计算机程序产品。根据本公开的第一方面，提供了一种服饰生成模型的训练的方法，包括：获取服饰的样本图像，其中，所述样本图像包括原始图像、形状掩码图像和纹理图像；将所述形状掩码图像输入形状编码器，得到预定层数的形状特征；将所述纹理图像输入纹理编码器，得到预定层数的纹理特征；将每层形状特征和每层的纹理特征对应相加，得到预定层数的融合特征后输入预训练模型，输出虚拟服饰图像；基于所述原始图像和所述虚拟服饰图像之间的差异调整所述形状编码器和所述纹理编码器的相关参数；基于调整后的形状编码器、纹理编码器和所述预训练模型获得服饰生成模型。根据本公开的第二方面，提供了一种生成服饰图像的方法，包括：获取指定款式的服饰的形状图像和纹理图像；将所述形状图像和所述纹理图像输入采用如第一方面所述的方法生成的服饰生成模型中，生成指定款式的服饰图像。根据本公开的第三方面，提供了一种服饰生成模型的训练装置，包括：获取单元，被配置成获取服饰的样本图像，其中，所述样本包括原始图像、形状掩码图像和纹理图像；形状编码单元，被配置成将所述形状掩码图像输入形状编码器，得到预定层数的形状特征；纹理编码单元，被配置成将所述纹理图像输入纹理编码器，得到预定层数的纹理特征；融合单元，被配置成将每层形状特征和每层的纹理特征对应相加，得到预定层数的融合特征后输入预训练模型，输出虚拟服饰图像；调整单元，被配置成基于所述原始图像和所述虚拟服饰图像之间的差异调整所述形状编码器和所述纹理编码器的相关参数；输出单元，被配置成基于调整后的形状编码器、纹理编码器和所述预训练模型获得服饰生成模型。根据本公开的第四方面，提供了一种生成服饰图像的装置，包括：获取单元，被配置成获取指定款式的服饰的形状图像和纹理图像；生成单元，被配置成将所述形状图像和所述纹理图像输入采用如第三方面所述的装置生成的服饰生成模型中，生成指定款式的服饰图像。根据本公开的第五方面，提供了一种电子设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行第一方面和第二方面中任一项所述的方法。根据本公开的第六方面，提供了一种存储有计算机指令的非瞬时计算机可读存储介质，其中，所述计算机指令用于使所述计算机执行第一方面和第二方面中任一项所述的方法。根据本公开的第七方面，提供了一种计算机程序产品，包括计算机程序，所述计算机程序在被处理器执行时实现第一方面和第二方面中任一项所述的方法。本申请提出了一种基于形状和纹理独立编码的2D服饰图像生成技术，给定衣服款式形状和纹理图像可以重建出给定款式形状的、和输入的纹理高相似度的、高质量且整齐的服饰图像，实现了衣服款式形状和纹理可控制的2D服饰图像编辑生成。本文提出的技术可以用于2D虚拟形象的衣服部件高质量重建生成，以及批量2D衣服设计和创作。另外，本文提出的技术可以用于2D虚拟试衣解决方案中，可以把衣服穿在任意姿态模特身体上，具有广泛的应用场景和商业价值。应当理解，本部分所描述的内容并非旨在标识本公开的实施例的关键或重要特征，也不用于限制本公开的范围。本公开的其它特征将通过以下的说明书而变得容易理解。附图说明附图用于更好地理解本方案，不构成对本公开的限定。其中：图1是本申请的一个实施例可以应用于其中的示例性系统架构图；图2是根据本申请的服饰生成模型的训练方法的一个实施例的流程图；图3是根据本申请的服饰生成模型的训练方法的应用场景的示意图；图4是根据本申请的生成服饰图像的方法的一个实施例的流程图；图5是根据本申请的服饰生成模型的训练装置的一个实施例的结构示意图；图6是根据本申请的生成服饰图像的装置的一个实施例的结构示意图；图7是根据本申请实施例的服饰生成模型的训练方法和生成服饰图像的方法的电子设备的框图。具体实施方式以下结合附图对本公开的示范性实施例做出说明，其中包括本公开实施例的各种细节以助于理解，应当将它们认为仅仅是示范性的。因此，本领域普通技术人员应当认识到，可以对这里描述的实施例做出各种改变和修改，而不会背离本公开的范围和精神。同样，为了清楚和简明，以下的描述中省略了对公知功能和结构的描述。图1示出了可以应用本申请实施例的服饰生成模型的训练方法、服饰生成模型的训练装置、生成服饰图像的方法或生成服饰图像的装置的示例性系统架构100。如图1所示，系统架构100可以包括终端101、102，网络103、数据库服务器104和服务器105。网络103用以在终端101、102，数据库服务器104与服务器105之间提供通信链路的介质。网络103可以包括各种连接类型，例如有线、无线通信链路或者光纤电缆等等。用户110可以使用终端101、102通过网络103与服务器105进行交互，以接收或发送消息等。终端101、102上可以安装有各种客户端应用，例如模型训练类应用、服饰图像编辑类应用、虚拟试衣类应用、购物类应用、支付类应用、网页浏览器和即时通讯工具等。这里的终端101、102可以是硬件，也可以是软件。当终端101、102为硬件时，可以是具有显示屏的各种电子设备，包括但不限于智能手机、平板电脑、电子书阅读器、MP3播放器、膝上型便携计算机和台式计算机等等。当终端101、102为软件时，可以安装在上述所列举的电子设备中。其可以实现成多个软件或软件模块，也可以实现成单个软件或软件模块。在此不做具体限定。当终端101、102为硬件时，其上还可以安装有图像采集设备。图像采集设备可以是各种能实现采集图像功能的设备，如摄像头、传感器等等。用户110可以利用终端101、102上的图像采集设备，来采集一些服饰图像。数据库服务器104可以是提供各种服务的数据库服务器。例如数据库服务器中可以存储有样本集。样本集中包含有大量的样本。其中，样本可以包括原始图像、形状掩码图像和纹理图像。这样，用户110也可以通过终端101、102，从数据库服务器104所存储的样本集中选取样本。服务器105也可以是提供各种服务的服务器，例如对终端101、102上显示的各种应用提供支持的后台服务器。后台服务器可以利用终端101、102发送的样本集中的样本，对初始模型进行训练，并可以将训练结果发送给终端101、102。这样，用户可以应用生成的服饰生成模型进行衣服设计，生成指定形状和纹理的服饰图像。这里的数据库服务器104和服务器105同样可以是硬件，也可以是软件。当它们为硬件时，可以实现成多个服务器组成的分布式服务器集群，也可以实现成单个服务器。当它们为软件时，可以实现成多个软件或软件模块，也可以实现成单个软件或软件模块。在此不做具体限定。需要说明的是，本申请实施例所提供的服饰生成模型的训练方法或生成服饰图像的方法一般由服务器105执行。相应地，服饰生成模型的训练装置或生成服饰图像的装置一般也设置于服务器105中。需要指出的是，在服务器105可以实现数据库服务器104的相关功能的情况下，系统架构100中可以不设置数据库服务器104。应该理解，图1中的终端、网络、数据库服务器和服务器的数目仅仅是示意性的。根据实现需要，可以具有任意数目的终端、网络、数据库服务器和服务器。继续参见图2，其示出了根据本申请的服饰生成模型的训练方法的一个实施例的流程200。该服饰生成模型的训练方法可以包括以下步骤：步骤201，获取服饰的样本图像。在本实施例中，服饰生成模型的训练方法的执行主体可以通过多种方式来获取样本图像集。例如，执行主体可以通过有线连接方式或无线连接方式，从数据库服务器中获取存储于其中的现有的样本图像集。再例如，用户可以通过终端来收集样本。这样，执行主体可以接收终端所收集的样本图像，并将这些样本图像存储在本地，从而生成样本图像集。在这里，样本图像集中可以包括至少一个样本图像。其中，样本图像包括原始图像、形状掩码图像和纹理图像。从样本图像集中选取样本图像，执行步骤202-206，其中，样本图像的选取方式和选取数量在本申请中并不限制。例如可以是随机选取至少一个样本图像，也可以是从中选取清晰度较好的样本图像。原始图像是包括服饰的彩色图像。形状掩码图像是服饰轮廓的黑白图像，也称作形状mask。可通过图像语义分割等算法从原始图像中提取服饰形状mask。纹理图像是包括服饰纹理和颜色的彩色图像，例如白底蓝花的纹理图像。纹理图像可以是从原始图像中随意裁剪出的服饰片段，纹理图像的形状可以是任意的形状。纹理图像也可以是将原始图像随意遮挡后的图像，用于模拟用户手臂遮挡服饰纹理，形成了残缺纹理图像。步骤202，将形状掩码图像输入形状编码器，得到预定层数的形状特征。在本实施例中，形状编码器是一种卷积神经网络，用于提取图像的形状特征。形状编码器的每一层都输出形状特征。步骤203，将纹理图像输入纹理编码器，得到预定层数的纹理特征。在本实施例中，纹理编码器是一种卷积神经网络，用于提取图像的纹理特征。纹理编码器的每一层都输出纹理特征。纹理编码器和形状编码器的层数相同。步骤204，将每层形状特征和每层的纹理特征对应相加，得到预定层数的融合特征后输入预训练模型，输出虚拟服饰图像。在本实施例中，纹理编码器和形状编码器的层数相同，纹理编码器的第一层输出的纹理特征和形状编码器的第一层输出的形状特征相加，得到第一层融合特征，同理，纹理编码器的第N层输出的纹理特征和形状编码器的第N层输出的形状特征相加，得到第N层融合特征。将得到的N层融合特征输入预训练模型。预训练模型用于生成虚拟服饰图像。预训练模型可以是GAN的生成器。预训练模型的训练过程如下：获取服饰真图作为真值标签；随机生成一些向量，输入生成器，输出预测图像，然后由判别器判断预测图像和服饰真图的真假，交替调整生成器和判别器的参数，最终得到生成器作为预训练模型。步骤205，基于原始图像和虚拟服饰图像之间的差异调整形状编码器和纹理编码器的相关参数。在本实施例中，可通过多种方式计算样本的原始图像和虚拟服饰图像之间的差异，可通过常见计算图像相似度的方法计算相似度。若相似度小于预定相似度阈值，则调整形状编码器和纹理编码器的相关参数，使得原始图像和虚拟服饰图像之间的差异变小，直到收敛到预定相似度阈值。其中预训练模型在该阶段训练中权重是冻结的，即不参与该阶段训练，只用于训练形状编码器和纹理生成器步骤206，基于调整后的形状编码器、纹理编码器和预训练模型获得服饰生成模型。在本实施例中，若样本的原始图像和虚拟服饰图像之间的差异小于预定值，或相似度大于预定相似度阈值，则表明形状编码器、纹理编码器训练完成。可以与预训练模型一起组成服饰图像生成模型。可将服饰图像生成模型发布到服务器或终端设备中。本申请提供的实施例，提出了服饰形状和服饰纹理独立编码部分结构，并设计了一套损失函数对生成服饰形状和纹理加以监督训练，能够生成指定形状和纹理的服饰生成模型，从而可针对用户的需求生成定制的服饰图像，可应用于虚拟试衣等场景。在本实施例的一些可选的实现方式中，基于所述样本的原始图像和所述虚拟服饰图像之间的差异调整所述形状编码器和所述纹理编码器的相关参数，包括：计算所述样本的原始图像和所述虚拟服饰图像之间的2D距离损失；计算所述样本的原始图像和所述虚拟服饰图像之间的感知损失；将所述2D距离损失和所述感知损失的加权和作为第一损失值；若第一损失值大于等于第一预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。2D距离损失即L2损失。学习感知图像块相似度也称为“感知损失”，用于度量两张图像之间的差别。通过引入感知损失能够提高计算图像差异性的准确性，从而生成更加准确的服饰图像生成模型。在本实施例的一些可选的实现方式中，所述方法还包括：对所述虚拟服饰图像进行图像语义分割，得到分割掩码图；计算所述分割掩码图和所述样本的形状掩码图像之间的距离L1损失；将所述距离L1损失、所述2D距离损失和所述感知损失的加权和作为第二损失值；若第二损失值大于等于第二预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。图像语义分割是图像处理和是机器视觉技术中关于图像理解的重要一环，也是AI领域中一个重要的分支。语义分割即是对图像中每一个像素点进行分类，确定每个点的类别，从而进行区域划分。可通过现有技术常见的语义分割模型对虚拟服饰图像进行图像语义分割，得到的分割掩码图中可显示出服饰的轮廓，但显示不了颜色、纹理。这里的距离L1损失即形状损失，从而可以提高训练出的模型生成的服饰的形状和纹理的准确性。在本实施例的一些可选的实现方式中，所述获取服饰图像的样本，包括：获取服饰图像的原始图像；将所述原始图像进行图像语义分割，得到形状掩码图像；将所述原始图像进行随机遮挡，得到纹理图像；将所述原始图像与对应的形状掩码图像和纹理图像组合成一个样本。这种方式获得的纹理图像是残缺纹理图像，因此生成的服饰图像生成模型可以修复残缺纹理，得到完整的服饰图像，例如，训练样本中的纹理图像被胳膊遮住了一部分纽扣，则通过服饰图像生成模型可以生成全部纽扣的服饰图像。在本实施例的一些可选的实现方式中，所述预训练模型为生成式对抗网络的生成器，所述形状编码器和所述纹理编码器为层数相同的卷积神经网络。可采用StyleGAN中的生成器作为预训练模型。这样的网络结构方便构建和训练，并且性能良好。继续参见图3，图3是根据本实施例的服饰生成模型的训练的方法的应用场景的一个示意图。在图3的应用场景中，服饰图像生成模型包括形状编码器、纹理编码器、生成器。其中生成器是基于StyleGAN网络在服饰数据集训练得到一个预训练模型。具体训练过程如下：1、首先，收集大量的2D服饰图像数据，并进行尺度对齐处理；2、然后，对对齐后的2D服饰图像进行服饰图像分割，提取服饰形状Mask，得到形状掩码图像；3、第一阶段训练：基于大量对齐处理的服饰图片训练一个StyleGAN服饰图像生成器，得到一个预训练模型；4、第二阶段训练：加入形状编码器和纹理编码器，并把两个编码器输出对应层进行相加，作为StyleGAN生成器输入，进行端到端的训练；5、第一阶段训练损失函数是通用的StyleGAN相应的GAN损失函数，第二阶段训练中，损失函数包括三个，一个是形状损失，第二个是像素级损失，第三个是LPIPS服饰感知损失。6、待第二阶段训练完毕后，在预测时，输入目标形状Mask和部分残缺的服饰纹理，即可得到和输入形状一致并且纹理和输入纹理相似的2D服饰图像。继续参见图4，其示出了根据本申请的生成服饰图像的方法的又一个实施例的流程400。该生成服饰图像的方法可以包括以下步骤：步骤401，获取指定款式的服饰的形状图像和纹理图像。在本实施例中，生成服饰图像的方法的执行主体可以通过多种方式来指定款式的服饰的形状图像和纹理图像。例如，执行主体可以通过有线连接方式或无线连接方式，从数据库服务器中获取存储于其中的指定款式的服饰的形状图像和纹理图像。再例如，执行主体也可以接收终端或其他设备采集的指定款式的服饰的形状图像和纹理图像。例如，指定款式为长袖风衣的形状，黄色小星星图案的短袖T恤的纹理图像。步骤402，将形状图像和纹理图像输入服饰生成模型中，生成指定款式的服饰图像。在本实施例中，执行主体可以将步骤401中获取的图像输入服饰生成模型中，从而生成指定款式的服饰图像，例如，黄色小星星图案的长袖风衣。在本实施例中，服饰生成模型可以是采用如上述图2实施例所描述的方法而生成的。具体生成过程可以参见图2实施例的相关描述，在此不再赘述。需要说明的是，本实施例生成服饰图像的方法可以用于测试上述各实施例所生成的服饰生成模型。进而根据生成的服饰图像可以不断地优化服饰生成模型。该方法也可以是上述各实施例所生成的服饰生成模型的实际应用方法。采用上述各实施例所生成的服饰生成模型，来进行生成服饰图像，能生成指定形状和纹理的服饰图像。继续参见图5，作为对上述图2所示方法的实现，本申请提供了一种服饰生成模型的训练的装置的一个实施例。该装置实施例与图2所示的方法实施例相对应，该装置具体可以应用于各种电子设备中。如图5所示，本实施例的服饰生成模型的训练的装置500可以包括：获取单元501、形状编码单元502、纹理编码单元503、融合单元504、调整单元505和输出单元506。其中，获取单元501，被配置成获取服饰的样本图像，其中，所述样本图像包括原始图像、形状掩码图像和纹理图像；形状编码单元502，被配置成将所述形状掩码图像输入形状编码器，得到预定层数的形状特征；纹理编码单元503，被配置成将所述纹理图像输入纹理编码器，得到预定层数的纹理特征；融合单元504，被配置成将每层形状特征和每层的纹理特征对应相加，得到预定层数的融合特征后输入预训练模型，输出虚拟服饰图像；调整单元505，被配置成基于所述原始图像和所述虚拟服饰图像之间的差异调整所述形状编码器和所述纹理编码器的相关参数；输出单元506，被配置成基于调整后的形状编码器、纹理编码器和所述预训练模型获得服饰生成模型。在本实施例的一些可选的实现方式中，调整单元505进一步被配置成：计算所述原始图像和所述虚拟服饰图像之间的2D距离损失；计算所述原始图像和所述虚拟服饰图像之间的感知损失；将所述2D距离损失和所述感知损失的加权和作为第一损失值；若第一损失值大于等于第一预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。在本实施例的一些可选的实现方式中，调整单元505进一步被配置成：对所述虚拟服饰图像进行图像语义分割，得到分割掩码图；计算所述分割掩码图和所述形状掩码图像之间的距离L1损失；将所述距离L1损失、所述2D距离损失和所述感知损失的加权和作为第二损失值；若第二损失值大于等于第二预定阈值，则调整所述形状编码器和所述纹理编码器的相关参数。在本实施例的一些可选的实现方式中，获取单元501进一步被配置成：获取服饰的原始图像；将所述原始图像进行图像语义分割，得到形状掩码图像；将所述原始图像进行随机遮挡，得到纹理图像；将所述原始图像与对应的形状掩码图像和纹理图像组合成一个样本图像。在本实施例的一些可选的实现方式中，所述预训练模型为生成式对抗网络的生成器，所述形状编码器和所述纹理编码器为层数相同的卷积神经网络。继续参见图6，作为对上述图4所示方法的实现，本申请提供了一种生成服饰图像的装置的一个实施例。该装置实施例与图4所示的方法实施例相对应，该装置具体可以应用于各种电子设备中。如图6所示，本实施例的生成服饰图像的装置600可以包括：获取单元601和生成单元602。其中，获取单元601被配置成获取指定款式的服饰的形状图像和纹理图像；生成单元602被配置成将所述形状图像和所述纹理图像输入采用装置500生成的服饰生成模型中，生成指定款式的服饰图像。本公开的技术方案中，所涉及的用户个人信息的收集、存储、使用、加工、传输、提供和公开等处理，均符合相关法律法规的规定，且不违背公序良俗。根据本公开的实施例，本公开还提供了一种电子设备、一种可读存储介质和一种计算机程序产品。一种电子设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行流程200或400所述的方法。一种存储有计算机指令的非瞬时计算机可读存储介质，其中，所述计算机指令用于使所述计算机执行流程200或400所述的方法。一种计算机程序产品，包括计算机程序，所述计算机程序在被处理器执行时实现流程200或400所述的方法。图7示出了可以用来实施本公开的实施例的示例电子设备700的示意性框图。电子设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本公开的实现。如图7所示，设备700包括计算单元701，其可以根据存储在只读存储器702中的计算机程序或者从存储单元708加载到随机访问存储器703中的计算机程序，来执行各种适当的动作和处理。在RAM703中，还可存储设备700操作所需的各种程序和数据。计算单元701、ROM 702以及RAM 703通过总线704彼此相连。输入/输出接口705也连接至总线704。设备700中的多个部件连接至I/O接口705，包括：输入单元706，例如键盘、鼠标等；输出单元707，例如各种类型的显示器、扬声器等；存储单元708，例如磁盘、光盘等；以及通信单元709，例如网卡、调制解调器、无线通信收发机等。通信单元709允许设备700通过诸如因特网的计算机网络和/或各种电信网络与其他设备交换信息/数据。计算单元701可以是各种具有处理和计算能力的通用和/或专用处理组件。计算单元701的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的计算单元、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。计算单元701执行上文所描述的各个方法和处理，例如服饰生成模型的训练方法。例如，在一些实施例中，服饰生成模型的训练方法可被实现为计算机软件程序，其被有形地包含于机器可读介质，例如存储单元708。在一些实施例中，计算机程序的部分或者全部可以经由ROM 702和/或通信单元709而被载入和/或安装到设备700上。当计算机程序加载到RAM 703并由计算单元701执行时，可以执行上文描述的服饰生成模型的训练方法的一个或多个步骤。备选地，在其他实施例中，计算单元701可以通过其他任何适当的方式而被配置为执行服饰生成模型的训练方法。本文中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、负载可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本公开的方法的程序代码可以采用一个或多个编程语言的任何组合来编写。这些程序代码可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器或控制器，使得程序代码当由处理器或控制器执行时使流程图和/或框图中所规定的功能/操作被实施。程序代码可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本公开的上下文中，机器可读介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的程序。机器可读介质可以是机器可读信号介质或机器可读储存介质。机器可读介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在计算机上实施此处描述的系统和技术，该计算机具有：用于向用户显示信息的显示装置或者LCD监视器)；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给计算机。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网和互联网。计算机系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，也可以为分布式系统的服务器，或者是结合了区块链的服务器。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发公开中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本公开公开的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本公开保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本公开的精神和原则之内所作的修改、等同替换和改进等，均应包含在本公开保护范围之内。
