标题title
一种海量电网调度数据采集与存储系统
摘要abst
本发明涉及一种海量电网调度数据采集与存储系统，包括数据采集模块、数据处理模块、数据解析模块、数据存储模块、数据读取模块；其中，数据采集模块实现调度数据的采集；数据处理模块实现数据的预处理；数据识别模块实现数据功能的识别；数据存储模块实现数据的分类存储；数据读取模块实现数据的快速读取。本发明实现了海量电网调度数据的高效采集与存储，同时解决了数据读取低效的问题。
权利要求书clms
1.一种海量电网调度数据采集与存储系统，其特征在于：包括数据采集模块、数据处理模块、数据解析模块、数据存储模块和数据读取模块；其中，数据采集模块实现调度数据的采集；数据处理模块实现数据的预处理；数据识别模块实现数据功能的识别；数据存储模块实现数据的分类存储；数据读取模块实现数据的快速读取。2.根据权利要求1所述的海量电网调度数据采集与存储系统，其特征在于：所述数据采集模块用于采集电网中的报文数据，数据采集模块包括：主网数据采集模块和配网数据采集模块；其中，主网数据采集模块用于对厂站远动装置上送至主站前置机上的海量报文数据进行采集；配网数据采集模块用于对厂站配电自动化终端上送的海量报文数据进行采集。3.根据权利要求1所述的海量电网调度数据采集与存储系统，其特征在于：数据处理模块对采集的报文数据五元组进行解析，判断报文是否符合104规约格式；具体步骤如下：步骤A1，查找解析后报文中是否有“0x68”字节，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则进入步骤A2；步骤A2，截取从“0x68”字节开始的后续报文数据；步骤A3，判断截取的报文的应用层协议数据单元长度是否介于4到253以内，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则进入步骤A4；步骤A4，判断截取的报文总长度是否比应用层协议数据单元长度多2个字节，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则判定为符合104规约格式。4.根据权利要求1所述的海量电网调度数据采集与存储系统，其特征在于：所述数据识别模块利用深度学习网络对报文应用服务数据进行识别，具体步骤如下：步骤B1，提取报文中的应用服务数据，将十六进制的应用数据转换成十进制；步骤B2，将进制转换后的十进制数据中前784个数进行截取，多余的部分进行丢弃，不足的部分则用0进行补全，再进行归一化操作；步骤B3，将归一化后的784个数进行转换成行数和列数都是28的矩阵；步骤B4，将矩阵传入已经训练好的深度卷积神经网络中，进行应用功能分类，判断应用功能类型。5.根据权利要求4所述的海量电网调度数据采集与存储系统，其特征在于：所述训练好的深度卷积神经网络是利用迁移学习将LeNet-5网络最后的分类数改为6类而得到的。6.根据权利要求4所述的海量电网调度数据采集与存储系统，其特征在于：所述应用功能类型包括：总召唤功能、对时功能、循环数据传输功能、事件搜集功能、命令传输功能和累积量传输功能。7.根据权利要求1所述的海量电网调度数据采集与存储系统，其特征在于：所述数据存储模块实现对不同应用功能数据的存储，通过应用服务数据的类别将数据进行分类压缩存储，在存储的同时给数据打上时间戳，具体步骤如下：步骤C1，将16进制的104报文数据S转换为2进制数据，得到2进制报文数据S1；步骤C2，将2进制报文数据S1通过BWT算法进行报文变换，得到报文数据S2；步骤C3，利用计数法将报文数据S2转换为报文数据S3；所述计数法的具体计数方法为：用大写字母A~Z表示S2种数字1连续的个数，其中A表示1，Z表示26，如果有超过26的部分，则重新从A开始计数；用小写字母a~z表示S2种数字0连续的个数，其中a表示1个，z表示26个，如果有超过26的部分，则重新从a开始计数；步骤C4，利用LZW算法将报文S3进行压缩；步骤C5，对压缩后的报文数据打上时间戳进行保存。8.根据权利要求1所述的海量电网调度数据采集与存储系统，其特征在于：所述数据存储模块具有优先存储控制功能，根据用户设定的优先存储类别对不同类别的数据存储优先级进行限制。9.根据权利要求1所述的海量电网调度数据采集与存储系统，其特征在于：所述数据读取模块根据用户设定的应用服务数据类别及数据存储时间戳区间对数据进行快速读取。
说明书desc
技术领域本发明涉及电网调度数据采集与存储领域，尤其涉及一种海量电网调度数据采集与存储系统。背景技术随着国民用电量的大幅度增长，电网设备也投入的越来越多，因此电力调度数据量呈现出指数级的增长，这就宣告了电力调度数据网的大数据时代的来临。目前，电力调度业务中的数据每天都在快速增长，现有的技术已经很难满足海量调度业务数据的采集和存储。主要表现为无法将海量的数据进行完整采集，同时，单一的存储功能使得数据调阅时难以开展数据分析，数据读取困难，严重制约了电网的快速发展和推广新业务的速度。由于电力调度数据网的进一步发展，使得信息数据量也不断增加，这就需要有更高能力的数据采集和存储的方式，而传统的电网采集和存储方式已经很难满足这种需求。发明内容为了克服现有技术的不足，本发明提供了一种海量电网调度数据采集与存储系统，实现了海量电网调度数据的高效采集与存储，同时解决了数据读取低效的问题。为解决以上技术问题，本发明的技术方案为：一种海量电网调度数据采集与存储系统，包括数据采集模块、数据处理模块、数据解析模块、数据存储模块和数据读取模块；其中，数据采集模块实现调度数据的采集；数据处理模块实现数据的预处理；数据识别模块实现数据功能的识别；数据存储模块实现数据的分类存储；数据读取模块实现数据的快速读取。优选地，所述数据采集模块用于采集电网中的报文数据，数据采集模块包括：主网数据采集模块和配网数据采集模块；其中，主网数据采集模块用于对厂站远动装置上送至主站前置机上的海量报文数据进行采集；配网数据采集模块用于对厂站配电自动化终端上送的海量报文数据进行采集。优选地，数据处理模块对采集的报文数据五元组进行解析，判断报文是否符合104规约格式；具体步骤如下：步骤A1，查找解析后报文中是否有“0x68”字节，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则进入步骤A2；步骤A2，截取从“0x68”字节开始的后续报文数据；步骤A3，判断截取的报文的应用层协议数据单元长度是否介于4到253以内，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则进入步骤A4；步骤A4，判断截取的报文总长度是否比应用层协议数据单元长度多2个字节，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则判定为符合104规约格式。优选地，所述数据识别模块利用深度学习网络对报文应用服务数据进行识别，具体步骤如下：步骤B1，提取报文中的应用服务数据，将十六进制的应用数据转换成十进制；步骤B2，将进制转换后的十进制数据中前784个数进行截取，多余的部分进行丢弃，不足的部分则用0进行补全，再进行归一化操作；步骤B3，将归一化后的784个数进行转换成行数和列数都是28的矩阵；步骤B4，将矩阵传入已经训练好的深度卷积神经网络中，进行应用功能分类，判断应用功能类型。优选地，所述训练好的深度卷积神经网络是利用迁移学习将LeNet-5网络最后的分类数改为6类而得到的。优选地，所述应用功能类型包括：总召唤功能、对时功能、循环数据传输功能、事件搜集功能、命令传输功能和累积量传输功能。优选地，所述数据存储模块实现对不同应用功能数据的存储，通过应用服务数据的类别将数据进行分类压缩存储，在存储的同时给数据打上时间戳，具体步骤如下：步骤C1，将16进制的104报文数据S转换为2进制数据，得到2进制报文数据S1；步骤C2，将2进制报文数据S1通过BWT算法进行报文变换，得到报文数据S2；步骤C3，利用计数法将报文数据S2转换为报文数据S3；所述计数法的具体计数方法为：用大写字母A~Z表示S2种数字1连续的个数，其中A表示1，Z表示26，如果有超过26的部分，则重新从A开始计数；用小写字母a~z表示S2种数字0连续的个数，其中a表示1个，z表示26个，如果有超过26的部分，则重新从a开始计数；所述计数法将连续重复的1或0用一个字母来表示，可以初步减少原来文本数据的大小；步骤C4，利用LZW算法将报文S3进行压缩；所述LZW算法是一种无损压缩算法，压缩率最高可以达到3：1，且具有稳定的压缩过程，其压缩和解压缩速度较快；步骤C5，对压缩后的报文数据打上时间戳进行保存。优选地，所述数据存储模块具有优先存储控制功能，根据用户设定的优先存储类别对不同类别的数据存储优先级进行限制。优选地，所述数据读取模块根据用户设定的应用服务数据类别及数据存储时间戳区间对数据进行快速读取。本发明具有如下有益效果：一、本发明将采集方式分为两种采集方式同时进行，采集效率较单一的采集方式高；二、本发明识别出其中的104报文，只存储其中的104报文，实现高效存储；三、本发明将104报文进行类别识别，当网络拥堵的时候，可以有选择性地存储相关报文，效率比不分类的存储高；四、本发明由于存储的时候是按类别存储的，并且打上了时间戳，因此在读取的时候只需要确定读取的时间范围以及读取的类型，就可以精准的读取想要的报文数据，而相较于以前不区分类别的报文数据读取具有更高的效率。附图说明图1为本发明海量电网调度数据采集与存储系统的示意图；图2为本发明系统中数据处理模块的104报文获取及识别的流程示意图；图3为本发明系统中数据识别模块的报文应用功能分类流程示意图；图4为本发明系统中数据存储模块的压缩存储流程示意图；图5为本发明系统中数据存储模块的报文转换流程示意图；图6为本发明系统中数据存储模块的计数法示意图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，下面结合附图和具体实施例对本发明作进一步详细说明。请参考图1，本发明为一种海量电网调度数据采集与存储系统，其包括：数据采集模块、数据处理模块、数据解析模块、数据存储模块和数据读取模块；其中，数据采集模块实现调度数据的采集；数据处理模块实现数据的预处理；数据识别模块实现数据功能的识别；数据存储模块实现数据的分类存储；数据读取模块实现数据的快速读取；具体的，数据采集模块用于采集电网中的报文数据，数据采集模块包括：主网数据采集模块和配网数据采集模块；其中，主网数据采集模块用于对厂站远动装置上送至主站前置机上的海量报文数据进行采集；配网数据采集模块用于对厂站配电自动化终端上送的海量报文数据进行采集。具体的，数据处理模块对采集的报文数据五元组进行解析，判断报文是否符合104规约格式；具体的，数据识别模块利用深度学习网络对报文应用服务数据进行识别；具体的，数据存储模块实现对不同应用功能数据的存储，通过应用服务数据的类别将数据进行分类压缩存储，在存储的同时给数据打上时间戳；具体的，所述数据存储模块具有优先存储控制功能，根据用户设定的优先存储类别对不同类别的数据存储优先级进行限制；具体的，数据读取模块根据用户设定的应用服务数据类别及数据存储时间戳区间对数据进行快速读取。进一步的，参阅图2，数据处理模块对采集的报文数据五元组进行解析，判断报文是否符合104规约格式，具体步骤如下：步骤A1，查找解析后报文中是否有“0x68”字节，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则进入步骤A2；步骤A2，截取从“0x68”字节开始的后续报文数据；步骤A3，判断截取的报文的应用层协议数据单元长度是否介于4到253以内，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则进入步骤A4；步骤A4，判断截取的报文总长度是否比应用层协议数据单元长度多2个字节，如果不是，则判定为不符合104规约格式，然后将其丢弃，否则判定为符合104规约格式；如果是104规约格式，那“0x68”字节后一位就是应用层协议数据单元的长度。参阅图3，数据识别模块利用深度学习网络对报文应用服务数据进行识别，具体步骤如下：步骤B1，提取报文中的应用服务数据，将十六进制的应用数据转换成十进制；步骤B2，将进制转换后的十进制数据中前784个数进行截取，多余的部分进行丢弃，不足的部分则用0进行补全，再进行归一化操作；步骤B3，将归一化后的784个数进行转换成行数和列数都是28的矩阵；步骤B4，将矩阵传入已经训练好的深度卷积神经网络中，进行应用功能分类，判断应用功能类型；本实施例中，训练好的深度卷积神经网络是利用迁移学习将LeNet-5网络最后的分类数改为6类而得到的；本实施例中，应用功能类型包括：总召唤功能、对时功能、循环数据传输功能、事件搜集功能、命令传输功能和累积量传输功能。参阅图4，数据存储模块实现对不同应用功能数据的存储，通过应用服务数据的类别将数据进行分类压缩存储，在存储的同时给数据打上时间戳，具体步骤如下：步骤C1，将16进制的104报文数据S转换为2进制数据，得到2进制报文数据S1；步骤C2，将2进制报文数据S1通过BWT算法进行报文变换，得到报文数据S2；步骤C3，利用计数法将报文数据S2转换为报文数据S3；本实施例中，所述计数法为一种特殊计数法，具体计数方法为：用大写字母A~Z表示S2种数字1连续的个数，其中A表示1，Z表示26，如果有超过26的部分，则重新从A开始计数；用小写字母a~z表示S2种数字0连续的个数，其中a表示1个，z表示26个，如果有超过26的部分，则重新从a开始计数；步骤C4，利用LZW算法将报文S3进行压缩；步骤C5，对压缩后的报文数据打上时间戳进行保存。参阅图5，针对上述步骤C1和C2的报文转换方法进行举例：原有的16进制报文是：68 07 b6 dc d8 20 09，通过二进制转换后，则变成了1101 0000 0000 1111 0110 11011011 1001 1011 0000 0100 0000 0001 001，在经过BWT转换后则得到1111 0000 00000111 1111 1110 0000 0000 0011 1111 1110 0000 0000 000，这样就将一些相似的字符排在了一起，方便后续的压缩操作。上述步骤C3的计数方法是通过大小写字母分别对报文中连续排列的数字1和数字0的技术，大写字母A表示一个数字1，大写字母Z则表示二十六个连着的数字1，同理，小写字母则表示数字0的连续个数。参阅图6，上述经过BWT转换后则得到1111 0000 0000 01111111 1110 0000 0000 0011 1111 1110 0000 0000 000，通过步骤C3的计数法后转换为DiJkIl。本发明未涉及部分均与现有技术相同或采用现有技术加以实现。以上内容是结合具体的实施方式对本发明所作的进一步详细说明，不能认定本发明的具体实施只局限于这些说明。对于本发明所属技术领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干简单推演或替换，都应当视为属于本发明的保护范围。
