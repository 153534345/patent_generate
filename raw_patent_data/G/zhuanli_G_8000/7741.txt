标题title
计及时序相关性的数据驱动电-气综合能源系统态势感知方法与模型
摘要abst
计及时序相关性的数据驱动电‑气综合能源系统态势感知方法与模型，该方法包括采集电‑气综合能源系统中量测装置与设备的历史数据；利用状态估计对量测噪声滤波处理，计算电‑气综合能源系统偏离量，将系统偏离量划分为历史偏离与未来偏离，基于偏离量在时域上的变化得到特征图像以及分类标签；构建卷积神经网络模型，使用得到的特征图像和分类标签对卷积神经网络模型进行训练；采集并处理电‑气综合能源系统中量测装置与设备在当前时段的量测数据，得到当前时段偏离量对应的图像特征，将该图像特征输入训练好的卷积神经网络模型中，得到系统未来运行趋势的分类标签。本发明所涉方法可有效挖掘历史数据的隐含信息，提高未来运行态势感知准确率。
权利要求书clms
1.计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，包括：S1、采集数据：采集电-气综合能源系统中量测装置与设备的历史数据；S2、处理数据：利用状态估计对步骤S1中采集的量测噪声滤波处理，进行电-气综合能源系统状态量的求解并察觉系统偏离量，将得到的系统偏离量划分为历史偏离与未来偏离，基于偏离量在时域上的变化情况得到历史时段偏离量对应的特征图像以及未来时段偏离量对应的分类标签；S3、构建并训练模型：构建卷积神经网络模型，使用步骤S2中得到的特征图像和分类标签对所述卷积神经网络模型进行训练，以得到模型输入-输出的映射关系；S4、预测当前时段的未来运行趋势：采用步骤S1-S2中的方法采集并处理电-气综合能源系统中量测装置与设备在当前时段的量测数据，以得到当前时段偏离量对应的图像特征，将该图像特征输入训练好的卷积神经网络模型中，得到系统未来运行趋势的分类标签。2.根据权利要求1所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S1中，采集数据时：采集电-气综合能源系统中相量测量单元、广域测量系统、压力变送计器、涡轮流量计等量测装置与设备的量测数据，所述量测数据包括：电网电压幅值Ui、电网电压相角θ、电网节点有功功率Pi、电网节点无功功率Qi、电网线路有功负荷Pij、电网线路无功负荷Qij、气网节点压强pi、气网节点流量fi、气网管道流量fij。3.根据权利要求2所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S2中：采用基于加权最小二乘法建立的电-气综合能源系统状态估计模型对量测噪声滤波处理，该状态估计模型如下：式中：ze与zg分别为电网与气网量测量向量；he与hg分别为电网与气网量测模型；xe与xg分别为电网与气网状态量向量；Re与Rg分别为电网与气网量测协方差矩阵；c为零注入节点伪量测约束。采用电-气综合能源系统偏离量计算模型计算电-气综合能源系统偏离量，该偏离量计算模型如下：式中：d为电-气综合能源系统状态偏离量；ρ为权重系数；Me与Mg分别为电网与气网节点数；Ui与Pj分别为电网节点i电压幅值与气网节点j压强；UN与PN分别为电网额定电压与气网额定压强。4.根据权利要求3所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S2中，将得到的系统偏离量划分为历史偏离与未来偏离时：假设所述系统偏离量为p～f时段内获取的系统偏离量，t为当前时刻，t∈，则p～t时段偏离量dp～t为历史偏离，t～f时段偏离量dt～f为未来偏离。5.根据权利要求4所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S2中，利用格拉姆角差场理论对历史偏离量时序相关性进行分析得到历史时段偏离量对应的特征图像，利用格拉姆角差场理论对未来偏离量运行趋势进行定性分类分析得到未来时段偏离量对应的分类标签。6.根据权利要求5所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S2中，得到历史时段偏离量对应的特征图像的具体方法如下：1)p～t时段系统偏离量归一化：对p～t时段偏离量dp～t进行归一化操作，将数据区间缩放至，如下式：式中：为n时刻归一化系统偏离量；dn为n时刻系统偏离量；max与min分别为p～t时段系统偏离量最大值与最小值；2)极坐标系形式转换：将归一化处理后的系统状态偏离量数值通过反余弦计算变换为角度，对应时间戳变换为半径，实现系统偏离从直角坐标系到极坐标系的转换与表达，如下式：式中：θn为偏离量在极坐标系中角度编码；rn为偏离量在极坐标系中半径编码；3)格拉姆角差场矩阵生成：在得到偏离量时间序列的极坐标系形式后，利用各时间断面偏离量角度差的正弦运算生成格拉姆角差场矩阵，以识别多时间断面间时序自相关性，如下式：式中：G为p～t时段偏离量dp～t对应格拉姆角差场矩阵；4)将格拉姆角差场变换所得格拉姆角差场矩阵G进行图像编码，得到p～t时段偏离量dp～t对应的特征图像。7.根据权利要求6所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S2中，得到未来时段偏离量对应的分类标签的具体方法如下：依据未来系统偏离量变化将系统未来运行趋势划分为健康、恢复、临界、紧急四种状态：1)判断max≤dh是否成立，其中，dh为健康状态偏离量阈值，若是，则未来运行趋势为健康状态；若否，转到2)；2)判断dh＜max≤dc是否成立，其中，dc为临界状态偏离量阈值，若是，转到3)；若否，转到4)；3)判断是否成立，若是，则未来运行趋势为临界状态；若否，则未来运行趋势为恢复状态；4)判断是否成立，若是，则未来运行趋势为紧急状态；若否，则未来运行趋势为恢复状态；经分类所得的未来运行趋势即为t～f时段偏离量dt～f对应的分类标签。8.根据权利要求7所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S3中构建的卷积神经网络模型包括1层输入层、2层卷积层、2层池化层、2层激活层、1层扁平层、1层全连接层与1层输出层，所述卷积神经网络模型的卷积公式如下：式中：x为卷积计算输入矩阵；w代表大小为M×N的卷积核；y为卷积计算输出矩阵。9.根据权利要求8所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法，其特征在于，在步骤S4中，将当前时段偏离量对应的图像特征输入至卷积神经网络模型中以预测未来运行趋势时：所述卷积神经网络模型先利用其输入层输入当前时段格拉姆角差场图像并将其转换为32×32×3的像素矩阵；再通过两次“卷积-激活-池化”处理得到5×5大小的128个特征图，其中激活层均采用ReLU作为激活函数，池化层均采用最大池化方式；接着利用扁平层将三维特征图压缩得到长度为3200一维数组；最后通过全连接层将扁平层信息传递至输出层，利用softmax分类器得出当前时段的未来运行趋势的分类标签。10.一种计及时序相关性的数据驱动电-气综合能源系统态势感知模型，其特征在于：包括前述权利要求1-9中任意一项所述的计及时序相关性的数据驱动电-气综合能源系统态势感知方法中的卷积神经网络模型。
说明书desc
技术领域本发明涉及综合能源系统态势感知技术领域，尤其指一种计及时序相关性的 数据驱动电-气综合能源系统态势感知方法。背景技术电-气综合能源系统的多源异构特性为系统经济、高效、安全、可靠运行带 来了问题与挑战，如何对电-气综合能源系统进行高效准确态势感知，对于保障 系统安全可靠运行具有重大意义。近年来，出于电力系统可靠性与安全性需求，国内外专家学者对态势感知技 术在电力领域的应用进行了探索与研究。LIN Jin等人对主动配电网中态势感知 的路线、技术与瓶颈进行了分析与展望。李大虎等人建立了元件级与系统级的运 行风险态势指标，对台风气象下的电网运行风险进行了评估与预测。肖白等人通 过降噪自编码器对电力负荷噪声进行处理，基于奇异谱分析方法对电力负荷高/ 低频分量进行分解，最后利用长短期记忆神经网络实现了空间电力负荷的准确感 知与预测。WANG Weikang等人提出了一种基于相角转移量与频率变化率的电力 系统频率扰动感知识别方法。JING Hongyan等人提出了一种基于深度Q网络的 电、热、冷负荷态势感知方法。刘柳等人针对以能量枢纽为多能供应源的区域综 合能源系统，提出了安全域概念与模型，实现了系统安全区间准确感知。以上研 究促进了态势感知技术在电力领域的推广与应用。但是电-气综合能源系统场景 下的态势感知技术研究仍较少且不够深入，缺乏对于海量多源异构运行量测数据 隐含信息的有效挖掘，为电-气综合能源系统的安全可靠运行带来了问题与挑战。发明内容本发明所要解决的技术问题是提供一种计及时序相关性的数据驱动电-气综 合能源系统态势感知方法，该方法考虑到偏离量的时序相关性特征，并基于数据 驱动理论建模，可有效挖掘历史数据的隐含信息，提高系统态势感知准确率。为了解决上述技术问题，本发明采用如下技术方法：一种计及时序相关性的 数据驱动电-气综合能源系统态势感知方法，包括以下步骤：S1、采集数据：采集电-气综合能源系统中量测装置与设备的历史数据；S2、处理数据：利用状态估计对步骤S1中采集的量测噪声滤波处理，进行 电-气综合能源系统状态量的求解并察觉系统偏离量，将得到的系统偏离量划分 为历史偏离与未来偏离，基于偏离量在时域上的变化情况得到历史时段偏离量对 应的特征图像以及未来时段偏离量对应的分类标签；S3、构建并训练模型：构建卷积神经网络模型，使用步骤S2中得到的特征 图像和分类标签对所述卷积神经网络模型进行训练，以得到模型输入-输出的映 射关系；S4、预测当前时段的未来运行趋势：采用步骤S1-S2中的方法采集并处理电 -气综合能源系统中量测装置与设备在当前时段的量测数据，以得到当前时段偏 离量对应的图像特征，将该图像特征输入训练好的卷积神经网络模型中，得到系 统未来运行趋势的分类标签。进一步地，在步骤S1中，采集数据时：采集电-气综合能源系统中相量测量单元、广域测量系统、压力变送计器、 涡轮流量计等量测装置与设备的量测数据，所述量测数据包括：电网电压幅值 Ui、电网电压相角θ、电网节点有功功率Pi、电网节点无功功率Qi、电网线路有 功负荷Pij、电网线路无功负荷Qij、气网节点压强pi、气网节点流量fi、气网管 道流量fij。进一步地，在步骤S2中：采用基于加权最小二乘法建立的电-气综合能源系统状态估计模型对量测噪 声滤波处理，该状态估计模型如下：式中：ze与zg分别为电网与气网量测量向量；he与hg分别为电网与气网量 测模型；xe与xg分别为电网与气网状态量向量；Re与Rg分别为电网与气网量测协 方差矩阵；c为零注入节点伪量测约束。采用电-气综合能源系统偏离量计算模型计算电-气综合能源系统偏离量，该 偏离量计算模型如下：式中：d为电-气综合能源系统状态偏离量；ρ为权重系数；Me与Mg分 别为电网与气网节点数；Ui与Pj分别为电网节点i电压幅值与气网节点j压 强；UN与PN分别为电网额定电压与气网额定压强。更进一步地，在步骤S2中，将得到的系统偏离量划分为历史偏离与未来偏 离时：假设所述系统偏离量为p～f时段内获取的系统偏离量，t为当前时刻， t∈，则p～t时段偏离量dp～t为历史偏离，t～f时段偏离量dt～f为未来偏 离。更进一步地，在步骤S2中，利用格拉姆角差场理论对历史偏离量时序相关 性进行分析得到历史时段偏离量对应的特征图像，利用格拉姆角差场理论对未来 偏离量运行趋势进行定性分类分析得到未来时段偏离量对应的分类标签。再进一步地，在步骤S2中，得到历史时段偏离量对应的特征图像的具体方 法如下：1)p～t时段系统偏离量归一化：对p～t时段偏离量dp～t进行归一化操作， 将数据区间缩放至，如下式：式中：为n时刻归一化系统偏离量；dn为n时刻系统偏离量；max 与min分别为p～t时段系统偏离量最大值与最小值；2)极坐标系形式转换：将归一化处理后的系统状态偏离量数值通过反 余弦计算变换为角度，对应时间戳变换为半径，实现系统偏离从直角坐标系 到极坐标系的转换与表达，如下式：式中：θn为偏离量在极坐标系中角度编码；rn为偏离量在极坐标系中半 径编码；3)格拉姆角差场矩阵生成：在得到偏离量时间序列的极坐标系形式后， 利用各时间断面偏离量角度差的正弦运算生成格拉姆角差场矩阵，以识别多 时间断面间时序自相关性，如下式：式中：G为p～t时段偏离量dp～t对应格拉姆角差场矩阵；4)将格拉姆角差场变换所得格拉姆角差场矩阵G进行图像编码，得到 p～t时段偏离量dp～t对应的特征图像。再进一步地，在步骤S2中，得到未来时段偏离量对应的分类标签的具体方 法如下：依据未来系统偏离量变化将系统未来运行趋势划分为健康、恢复、临界、 紧急四种状态：1)判断max≤dh是否成立，其中，dh为健康状态偏离量阈值，若是， 则未来运行趋势为健康状态；若否，转到2)；2)判断dh＜max≤dc是否成立，其中，dc为临界状态偏离量阈值，若 是，转到3)；若否，转到4)；3)判断是否成立，若是，则未来运行趋势为临界状态；若 否，则未来运行趋势为恢复状态；4)判断是否成立，若是，则未来运行趋势为紧急状态；若 否，则未来运行趋势为恢复状态；经分类所得的未来运行趋势即为t～f时段偏离量dt～f对应的分类标签。优选地，在步骤S3中构建的卷积神经网络模型包括1层输入层、2层卷积 层、2层池化层、2层激活层、1层扁平层、1层全连接层与1层输出层，所述卷 积神经网络模型的卷积公式如下：式中：x为卷积计算输入矩阵；w代表大小为M×N的卷积核；y为卷积计算 输出矩阵。优选地，在步骤S4中，将当前时段偏离量对应的图像特征输入至卷积神经 网络模型中以预测未来运行趋势时：所述卷积神经网络模型先利用其输入层输入当前时段格拉姆角差场图像并 将其转换为32×32×3的像素矩阵；再通过两次“卷积-激活-池化”处理得到5×5 大小的128个特征图，其中激活层均采用ReLU作为激活函数，池化层均采用最 大池化方式；接着利用扁平层将三维特征图压缩得到长度为3200一维数组；最 后通过全连接层将扁平层信息传递至输出层，利用softmax分类器得出当前时段 的未来运行趋势的分类标签。作为本发明的另一面，一种计及时序相关性的数据驱动电-气综合能源系统 态势感知模型，包括前述计及时序相关性的数据驱动电-气综合能源系统态势感 知方法中的卷积神经网络模型。本发明提供的计及时序相关性的数据驱动电-气综合能源系统态势感知方法 与模型是态势感知技术在多源异构数据系统中的一次突破，促进了态势感知技术 的发展，也实现了电-气综合能源系统运行态势感知准确率的提高。具体而言， 本发明通过巧妙的运用偏离量在时域上的自相关性，并基于数据驱动理论建立态 势预测模型，可有效挖掘电-气综合能源系统中隐含的信息，提高电-气综合能源 系统运行态势感知准确率，为电-气综合能源系统提供更高效准确的风险预警信 息，保障系统安全可靠的运行。附图说明图1为本发明所涉计及时序相关性的数据驱动电-气综合能源系统态势感知 方法的流程图；图2是本发明所涉计及时序相关性的数据驱动电-气综合能源系统态势感知 方法中格拉姆角差场变化示意图；图3是本发明所涉计及时序相关性的数据驱动电-气综合能源系统态势感知 方法与模型中的卷积神经网络模型架构图；图4是本发明实施例中电-气综合能源系统气网节点1-7的压强状态数据图；图5是本发明实施例中电-气综合能源系统电网节点1-14的电压状态数据图。具体实施方式为了便于本领域技术人员的理解，下面结合实施例与附图对本发明作进一步 的说明，实施方式提及的内容并非对本发明的限定。如图1所示，一种计及时序相关性的数据驱动电-气综合能源系统态势感知 方法，包括四大步骤，具体如下。步骤S1、采集历史量测数据；采集电-气综合能源系统中相量测量单元、广域测量系统、压力变送计器、 涡轮流量计等量测装置与设备在p～f时段的历史量测数据，该历史量测数据包 括：电网电压幅值Ui、电网电压相角θ、电网节点有功功率Pi、电网节点无功功 率Qi、电网线路有功负荷Pij、电网线路无功负荷Qij、气网节点压强pi、气网节 点流量fi、气网管道流量fij。步骤S2、处理历史量测数据；S21，采用基于加权最小二乘法建立的电-气综合能源系统状态估计模型对量 测噪声滤波处理，该状态估计模型如下：式中：ze与zg分别为电网与气网量测量向量；he与hg分别为电网与气网量 测模型；xe与xg分别为电网与气网状态量向量；Re与Rg分别为电网与气网量测协 方差矩阵；c为零注入节点伪量测约束。S22，采用电-气综合能源系统偏离量计算模型计算电-气综合能源系统在p～f 时段的偏离量，该偏离量计算模型如下：式中：d为电-气综合能源系统状态偏离量；ρ为权重系数；Me与Mg分 别为电网与气网节点数；Ui与Pj分别为电网节点i电压幅值与气网节点j压 强；UN与PN分别为电网额定电压与气网额定压强。S23，基于步骤S23获取了系统p～f时段偏离量，假设t为当前时刻，t∈， 则电-气综合能源系统在p～t时段偏离量dp～t为历史偏离，在t～f时段偏离量 dt～f为未来偏离。S24，利用格拉姆角差场理论对历史偏离量时序相关性进行分析得到历史时 段偏离量对应的特征图像，利用格拉姆角差场理论对未来偏离量运行趋势进行定 性分类分析得到未来时段偏离量对应的分类标签，具体步骤如下：S241，获取历史时段偏离量对应的特征图像；1)如图2所示，p～t时段系统偏离量归一化：对p～t时段偏离量dp～t进 行归一化操作，将数据区间缩放至，如下式：式中：为n时刻归一化系统偏离量；dn为n时刻系统偏离量；max 与min分别为p～t时段系统偏离量最大值与最小值；2)如图2所示，极坐标系形式转换：将归一化处理后的系统状态偏离 量数值通过反余弦计算变换为角度，对应时间戳变换为半径，实现系统偏离 从直角坐标系到极坐标系的转换与表达，如下式：式中：θn为偏离量在极坐标系中角度编码；rn为偏离量在极坐标系中半 径编码；3)如图2所示，格拉姆角差场矩阵生成：在得到偏离量时间序列的极 坐标系形式后，利用各时间断面偏离量角度差的正弦运算生成格拉姆角差场 矩阵，以识别多时间断面间时序自相关性，如下式：式中：G为p～t时段偏离量dp～t对应格拉姆角差场矩阵；4)如图2所示，将格拉姆角差场变换所得格拉姆角差场矩阵G进行图 像编码，得到p～t时段偏离量dp～t对应的特征图像。S242，确定未来时段偏离量对应的分类标签；采取定量与定性相结合的方式，依据未来系统偏离量变化将系统未来运行 趋势划分为健康、恢复、临界、紧急四种状态：1)判断max≤dh是否成立，其中，dh为健康状态偏离量阈值，若是， 则未来运行趋势为健康状态；若否，转到2)；2)判断dh＜max≤dc是否成立，其中，dc为临界状态偏离量阈值，若 是，转到3)；若否，转到4)；3)判断是否成立，若是，则未来运行趋势为临界状态；若 否，则未来运行趋势为恢复状态；4)判断是否成立，若是，则未来运行趋势为紧急状态；若 否，则未来运行趋势为恢复状态；经分类所得的未来运行趋势即为t～f时段偏离量dt～f对应的分类标签。步骤S3、构建并训练模型；S31，构建卷积神经网络模型；如图3所示，构建包括1层输入层、2层卷积层、2层池化层、2层激活层、 1层扁平层、1层全连接层与1层输出层的卷积神经网络模型，该卷积神经网络 模型的卷积公式如下：式中：x为卷积计算输入矩阵；w代表大小为M×N的卷积核；y为卷积计算 输出矩阵。S32，将步骤S241中得到的特征图像和步骤S242中得到的分类标签作为样 本集对卷积神经网络模型进行训练，具体而言，将步骤S241中得到的特征图像 作为卷积神经网络模型的输入，将步骤S242中得到的分类标签作为卷积神经网 络模型的输出，训练得到卷积神经网络模型输入-输出的映射关系。步骤S4，预测当前时段的未来运行趋势；S41，参照步骤S1，采集电-气综合能源系统a-b时段的量测数据。S42，参照步骤S21对步骤S41中得到的量测数据噪声滤波处理。S43，参照步骤S22，计算电-气综合能源系统a-b时段偏离量。S44，参照步骤S24，得到a-b时段偏离量对应的特征图像。S45，将步骤S44中得到的图像特征输入训练好的卷积神经网络模型中，卷 积神经网络模型先利用其输入层输入该某时段格拉姆角差场图像并将其转换为 32×32×3的像素矩阵；再通过两次“卷积-激活-池化”处理得到5×5大小的128 个特征图，其中激活层均采用ReLU作为激活函数，池化层均采用最大池化方式； 接着利用扁平层将三维特征图压缩得到长度为3200一维数组；最后通过全连接 层将扁平层信息传递至输出层，利用softmax分类器得出系统未来运行趋势的分 类标签。作为本发明的另一面，一种计及时序相关性的数据驱动电-气综合能源系统 态势感知模型，包括前述计及时序相关性的数据驱动电-气综合能源系统态势感 知方法中的卷积神经网络模型。为测试本发明所涉计及时序相关性的数据驱动电-气综合能源系统态势感知 方法的性能，下面以14节点电力系统与7节点天然气系统耦合的电-气综合能源 系统为例进行说明。在本实施例中，电-气综合能源系统的参数如表1、表2所示， 卷积神经网络各层级参数与操作如表3所示。表1电力系统参数表表2天然气系统参数表表3卷积神经网络各层级参数、操作与输入输出以上述电-气综合能源系统为例，采用本发明所涉计及时序相关性的数据驱 动电-气综合能源系统态势感知方法开展系统运行趋势态势感知，在该过程中， 量测数据一共采集2000组90分钟尺度数据，采集时间尺度设置为5分钟，p～t 间隔设置为6，t～f间隔设置为3。卷积神经网络模型训练时样本集中的训练集与 验证集比值设置为7：3。最终本实施例得到的态势感知方法的性能指标如表4 所示。表4态势感知性能指标另外，在本实施例中，图1与图2展示了单次态势感知对应的状态量数据， 此次预测的未来运行趋势为健康状态，与实际相符。由表4以及图4、5展示的结果看，本发明所涉计及时序相关性的数据驱动 电-气综合能源系统态势感知方法在态势感知方面的准确率很高，这可有力证明 本发明的可行性与准确性。上述实施例为本发明较佳的实现方案，除此之外，本发明还可以其它方式现 实，在不脱离本技术方案构思的前提下任何显而易见的替换均在本发明的保护范 围之内。为了让本领域普通技术人员更方便地理解本发明相对于现有技术的改进之 处，本发明的一些附图和描述已经被简化，并且为了清楚起见，本申请文件还省 略了一些其他元素，本领域普通技术人员应该意识到这些省略的元素也可构成本 发明的内容。
