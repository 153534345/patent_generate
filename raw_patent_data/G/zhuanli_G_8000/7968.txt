标题title
太赫兹大规模MIMO系统的深度学习混合预编码方法
摘要abst
本发明公开一种太赫兹大规模MIMO系统的深度学习混合预编码方法。所述方法包括：创建太赫兹大规模MIMO系统模型，采用TTD混合预编码硬件结构进行太赫兹大规模MIMO系统下的混合预编码工作；根据数字预编码矩阵和模拟波束形成矩阵建立最大化可达速率的优化问题；采用基于无监督学习的深度学习模型，求解优化问题，将损失函数被设计为可达速率的负数，经过离线训练最小化损失函数后，得到最大的系统可达速率性能。采用本发明技术方案，在完美CSI的情况下，所提算法可以达到和TTD方案相近的可达速率性能，在不完美CSI的情况下仍然保持较优的性能，具有拥有良好的鲁棒性和更低的运行的时间。
权利要求书clms
1.一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，包括：创建太赫兹大规模MIMO系统模型，采用TTD混合预编码硬件结构进行太赫兹大规模MIMO系统下的混合预编码工作；根据数字预编码矩阵和模拟波束形成矩阵建立最大化可达速率的优化问题；采用基于无监督学习的深度学习模型，求解优化问题，将损失函数被设计为可达速率的负数，经过离线训练最小化损失函数后，得到最大的系统可达速率性能。2.如权利要求1所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，创建一种单用户太赫兹大规模MIMO系统，在基站端配备一个具有Nt根天线的均匀线性阵列，服务于一个具有Nr根天线的用户，射频链路数量为NRF，Ns数据流由BS架构同时传输；其中，太赫兹大规模MIMO系统具有M个子载波的正交频分复用。3.如权利要求2所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，在第m个子载波的下行链路接收信号表示为：其中表示第m个子载波的频域信道，是在所有M个子载波上相同的模拟波束形成矩阵，表示在满足传输功率约束的基础上的第m个子载波上的数字预编码器，表示为在第m个子载波处具有归一化功率的发射信号，E表示期望值，是Nr维单位矩阵，ρ表示平均接收功率，表示遵循高斯分布的第m个子载波处的加性高斯白噪声，其中σ2为噪声功率。4.如权利要求3所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，通过最大化可达速率R来设计基于DNN的TTD混合预编码，在上述系统和信道模型的基础上，首先对于具有M个子载波的宽带THz大规模MIMO系统，其可达速率R可表示为：其中，Rm表示在第m个子载波处的可达速率。5.如权利要求4所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，通过设计最优的数字预编码矩阵和模拟波束形成矩阵Aopt来最大化可达速率R，则优化问题表示为：s.t.其中第一个约束是来自于用移相器实现的模拟波束成形具有的恒模约束，第二个约束表示具有归一化功率的传输功率约束。6.如权利要求5所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，基于无监督学习的深度学习模型，求解优化问题，具体包括如下子步骤：将信道矩阵输入神经网络，对信道矩阵进行数据处理，确保神经网络输出的模拟预编码器A满足恒模约束和混合预编码矩阵满足总功率约束；构建DNN模型；采用无监督学习的方法，并采用与可达速率目标优化函数直接相关的损失函数进行无监督学习。7.如权利要求6所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，进行数据处理，具体包括：提取相位信息，将相位矩阵作为神经网络的可训练参数，并在其上施加复指数函数exp以间接满足约束。8.如权利要求6所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，一个具有M个子载波的Nt×Nr的MIMO宽带系统，构建的DNN模型由输入层，输出层和四层全连接层组成；输入的信道信息被平坦化为一维向量，并与噪声功率σ2级联，采用两个分别具有C1和C2个神经元的隐藏全连接层，并且激活函数设为ReLU激活函数，来提取估计的具有不完美CSI的信道信息，然后再进入两个全连接层，分别具有NtNRF和2NsNRF个神经元；在每个全连接层之前都设置了一个批量归一化层，最后分别连接到两个定义的Lambda层完成模拟预编码矩阵和数字预编码矩阵的输出。9.如权利要求6所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其特征在于，损失函数表示为：其中，N为用于估计损失函数的训练样本数。
说明书desc
技术领域本发明涉及数据处理技术领域，尤其涉及基于太赫兹大规模MIMO系统的混合预编码方法。背景技术太赫兹频段由于其丰富的频谱资源和超高的传输速率使它在未来的宽带无线通信领域中具有巨大的优势。为了补偿路径损失且提高系统的频谱效率，大规模MIMO天线阵列被广泛应用于太赫兹系统中。此外，由于全数字阵列存在令人望而却步的高复杂度和高功耗问题，混合预编码技术作为一种可以在硬件消耗和性能之间进行权衡的技术，已经成为大规模MIMO系统的一种有吸引力的解决方案。然而，由于混合预编码结构使用了与频率无关的移相器，不同子载波频率上的波束将指向不同的物理方向，并且由于THz大规模MIMO系统的超大带宽和过多的天线数目，不同子载波上的波束所对准的物理方向与目标物理方向之间的物理方向偏差将显著增大，可能完全分裂成独立的物理方向，这种现象被称为波束分裂效应，会发生不可接受的阵列增益损失，导致系统可达速率降低，这种效应不可忽视。而经典的基于移相器的混合预编码结构所提出的方案不能解决这种严重的波束分裂现象。目前有几种现有的解决方案可以降低波束分裂的影响：1、利用一种虚拟子阵列划分方案以得到更宽的波束并为所有子载波的用户提供均匀分布的阵列增益，该方法可以在波束分裂效应较弱的情况下提高可达速率。然而，它们在太赫兹MIMO系统中的性能变得很差，因为太赫兹系统中的信号带宽更大、基站配备的天线数量更多，波束分裂的影响非常严重。2、利用一种用于均匀线阵的波束追踪算法，该算法使用真实时间延迟器缓解了波束分裂效应；一种适用于THz大规模MIMO的延迟相位混合预编码算法，利用TTD提供时延来实现与频率相关的相移；一种利用划分虚拟子阵产生更宽的波束的方法和利用TTD的模拟波束成形方案，以在整个工作频段内提供均匀分布的阵列增益来实现全宽带的波束形成；一种使用TTD和虚拟阵列划分的波束分裂补偿策略，其中虚拟阵列划分有效减少了为缓解波束分裂效应所需的TTD元件的数量；一种将波束分裂效应产生的相位变化转化到与频率相关的数字预编码器上以实现波束的相位校正。然而，以上所述方案设计仅限于基于完美信道状态信息的情况，而完美的CSI在现实中获取非常困难，因此，在不完美CSI的情况下研究减轻波束分裂效应的太赫兹大规模MIMO系统下的混合预编码至关重要。3、利用一种基于卷积神经网络的下行链路框架，用于毫米波混合预编码设计，它接受不完美的信道矩阵作为输入，并在输出端给出模拟预编码器和组合器。一种两阶段的深度学习方法，通过训练DNN网络学习最佳模拟波束形成器，来解决在硬件限制和CSI不完美的情况下最大化频谱效率的非凸问题。然而，这些方案都是基于监督学习的，需要大量的标签数据，并且性能受到传统优化算法的限制很难再获得提升。因此，无监督学习吸引了学者们的注意。4、利用一种基于无监督学习的深度学习方案，将和速率的负数作为损失函数，在不设标签的情况下学习最优模拟预编码矩阵。一种基于深度学习的混合预编码方法，设计以频谱效率为优化目标的损耗函数，并且用信道协方差矩阵来代替CSI，降低了系统开销。一种基于深度学习的可重构智能表面辅助的波束形成设计方法，其中深度神经网络使用无监督学习机制离线训练，在线部署时能够做出实时预测。然而，以上算法都是在毫米波系统中实现的，没有考虑太赫兹频段的信道特性，在太赫兹大规模MIMO系统中基于深度学习方法来进行混合预编码的设计仍值得进一步探索。基于现有的各种方案存在的不同问题，本申请提出一种能够解决上述技术问题的基于太赫兹大规模MIMO系统的深度学习的混合预编码方法。发明内容本发明提供了一种太赫兹大规模MIMO系统的深度学习混合预编码方法，包括：创建太赫兹大规模MIMO系统模型，采用TTD混合预编码硬件结构进行太赫兹大规模MIMO系统下的混合预编码工作；根据数字预编码矩阵和模拟波束形成矩阵建立最大化可达速率的优化问题；采用基于无监督学习的深度学习模型，求解优化问题，将损失函数被设计为可达速率的负数，经过离线训练最小化损失函数后，得到最大的系统可达速率性能。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，创建一种单用户太赫兹大规模MIMO系统，在基站端配备一个具有Nt根天线的均匀线性阵列，服务于一个具有Nr根天线的用户，射频链路数量为NRF，Ns数据流由BS架构同时传输；其中，太赫兹大规模MIMO系统具有M个子载波的正交频分复用。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，在第m个子载波的下行链路接收信号表示为：其中表示第m个子载波的频域信道，是在所有M个子载波上相同的模拟波束形成矩阵，表示在满足传输功率约束的基础上的第m个子载波上的数字预编码器，表示为在第m个子载波处具有归一化功率的发射信号，E表示期望值，是Nr维单位矩阵，ρ表示平均接收功率，表示遵循高斯分布的第m个子载波处的加性高斯白噪声，其中σ2为噪声功率。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，通过最大化可达速率R来设计基于DNN的TTD混合预编码，在上述系统和信道模型的基础上，首先对于具有M个子载波的宽带THz大规模MIMO系统，其可达速率R可表示为：其中，Rm表示在第m个子载波处的可达速率。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，通过设计最优的数字预编码矩阵和模拟波束形成矩阵Aopt来最大化可达速率R，则优化问题表示为：其中第一个约束是来自于用移相器实现的模拟波束成形具有的恒模约束，第二个约束表示具有归一化功率的传输功率约束。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，基于无监督学习的深度学习模型，求解优化问题，具体包括如下子步骤：将信道矩阵输入神经网络，对信道矩阵进行数据处理，确保神经网络输出的模拟预编码器A满足恒模约束和混合预编码矩阵满足总功率约束；构建DNN模型；采用无监督学习的方法，并采用与可达速率目标优化函数直接相关的损失函数进行无监督学习。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，进行数据处理，具体包括：提取相位信息，将相位矩阵作为神经网络的可训练参数，并在其上施加复指数函数exp以间接满足约束。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，一个具有M个子载波的Nt×Nr的MIMO宽带系统，构建的DNN模型由输入层，输出层和四层全连接层组成；输入的信道信息被平坦化为一维向量，并与噪声功率σ2级联，采用两个分别具有C1和C2个神经元的隐藏全连接层，并且激活函数设为ReLU激活函数，来提取估计的具有不完美CSI的信道信息，然后再进入两个全连接层，分别具有NtNRF和2NsNRF个神经元；在每个全连接层之前都设置了一个批量归一化层，最后分别连接到两个定义的Lambda层完成模拟预编码矩阵和数字预编码矩阵的输出。如上所述的一种太赫兹大规模MIMO系统的深度学习混合预编码方法，其中，损失函数表示为：其中，N为用于估计损失函数的训练样本数。本发明实现的有益效果如下：采用本发明技术方案，在完美CSI的情况下，所提算法可以达到和TTD方案相近的可达速率性能，在不完美CSI的情况下仍然保持较优的性能，具有拥有良好的鲁棒性和更低的运行的时间。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明中记载的一些实施例，对于本领域普通技术人员来讲，还可以根据这些附图获得其他的附图。图1是本发明实施例一提供的一种基于太赫兹大规模MIMO系统的混合预编码方法流程图；图2是相位校正混合预编码结构图；图3是DNN方案的离线和在线阶段过程图；图4是不同批量大小对可达速率性能的影响仿真图；图5是不同算法随训练周期变化的可达速率性能对比图；图6是不同算法在不同发送天线数下的可达速率性能对比图；图7是不同算法随SNR变化的可达速率性能图；图8是不同算法在不完美CSI情况下的鲁棒性示意图。具体实施方式下面结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一如图1所示，本发明实施例一提供一种基于太赫兹大规模MIMO系统的混合预编码方法，包括：步骤110、创建太赫兹大规模MIMO系统模型，采用TTD混合预编码硬件结构进行太赫兹大规模MIMO系统下的混合预编码工作；本申请实施例中，创建一种单用户太赫兹大规模MIMO系统，在基站端配备一个具有Nt根天线的均匀线性阵列，服务于一个具有Nr根天线的用户，射频链路数量为NRF，Ns数据流由BS架构同时传输。其中，太赫兹大规模MIMO系统具有M个子载波的正交频分复用。在第m个子载波的下行链路接收信号可以表示为：其中，为Hm的转置矩阵，表示第m个子载波的频域信道，C是组合符号；是在所有M个子载波上相同的模拟波束形成矩阵，且由于使用的是移相器，模拟波束形成矩阵具有恒模约束表示在满足传输功率约束的基础上的第m个子载波上的数字预编码器，表示为在第m个子载波处具有归一化功率的发射信号，INs为单位矩阵，ρ表示平均接收功率，表示遵循高斯分布的第m个子载波处的加性高斯白噪声，其中σ2为噪声功率。采用基于射线的宽带太赫兹通信信道模型，将fc表示为中心频率，B表示为带宽，对于第m个子载波上的频率fm，频域信道Hm可以表示为：其中，L表示路径数目，gl和τl表示第l条路径上的路径增益和时间延迟，和分别表示第m个子载波的第l条路径分量上的BS端和用户处的空间方向，空间方向是由物理传播方向和子载波频率确定的空间域中路径的方向，和分别是BS端和用户处的阵列响应向量，其形式如下公式所示：设第l条路径在BS侧和用户侧的与频率无关的物理方向为别为则空间方向可以通过对物理方向做DFT得到，公式表达如下：其中，d是通常根据fc设置的天线间距，可以表示为λ表示波长，c表示自由空间中的光速。为简化起见，本申请用和来表示物理方向，取值范围为。图2为相位校正混合预编码结构图，基于TTD结构的混合预编码系统，模拟波束形成器分为两个部分组成，即其中由与频率无关的移相器来实现，表示由在第l条RF链通过TTDs连接的PSs实现的模拟波束形成向量，表示与第k个TDD元件相连的PSs所实现的模拟波束形成向量，由于具有恒模约束，满足表示的是由TTDs实现的随频率变化的相移。那么，第m个子载波处的接收信号ym从公式变为：步骤120、根据数字预编码矩阵和模拟波束形成矩阵建立最大化可达速率的优化问题；本实施例通过最大化可达速率R来设计基于DNN的TTD混合预编码，在上述系统和信道模型的基础上，首先对于具有M个子载波的宽带THz大规模MIMO系统，其可达速率R可表示为：其中，Rm表示在第m个子载波处的可达速率，是Nr维单位矩阵。通过设计最优的数字预编码矩阵和模拟波束形成矩阵Aopt来最大化可达速率R，则优化问题可以表示为：其中第一个约束是来自于用移相器实现的模拟波束成形具有的恒模约束，第二个约束表示具有归一化功率的传输功率约束。由于模拟波束成形满足的恒模约束是非凸的，上式展示的优化问题也是非凸的，因此本申请采用一种基于无监督学习的DNN混合预编码方案，可以获得较优的可达速率性能，并且拥有良好的鲁棒性。步骤130、采用基于无监督学习的深度学习模型，求解优化问题，将损失函数被设计为可达速率的负数，经过离线训练最小化损失函数后，得到最大的系统可达速率性能。具体地，基于无监督学习的深度学习模型，求解优化问题，具体包括如下子步骤：步骤131、将信道矩阵输入神经网络，对信道矩阵进行数据处理，确保神经网络输出的模拟预编码器A满足恒模约束和混合预编码矩阵满足总功率约束；由于在实际的通信系统中通常不能得到具有完美的CSI的信道Hm，因此将估计的具有不完美CSI的信道矩阵设置为神经网络的输入，由于输入的信道矩阵的元素为复数，而神经网络是一个实值网络，因此将估计的信道矩阵的实部和虚部连接起来，输入的被重塑为一个2×Nt×Nr大小的实值张量。为了实现网络对各种信噪比的一般化，当发射功率被归一化时，将噪声功率输入DNN网络。为了确保DNN输出的模拟预编码器A满足恒模约束和混合预编码矩阵满足总功率约束，需要进行数据处理，具体包括：提取相位信息，将相位矩阵作为神经网络的可训练参数，并在其上施加复指数函数exp以间接满足约束。具体地，在深度学习训练阶段学习和确定每个元素的相位信息，为一个NtNRF×1的实值向量，同时也是一个全连接层的输出。将此实值向量整形为相位矩阵，用Φ表示，是一个Nt×NRF矩阵，最后，在DNN中设置了一个自定义Lambda层来表示从Φ到模拟预编码器A的变换，通过用欧拉公式重构模拟预编码器。所需的模拟预编码器A由如下公式所示：A＝exp＝cos+j·sin 其中，虚数单位j2＝-1。对于数字预编码器Dm，需要进行整形将一个2NsNRF×1的实值向量转换为一个维度大小为Ns×NRF的复值矩阵，记为最后，需要对数字预编码器执行功率归一化操作得到Dm，同样将此过程设置为一个自定义的Lambda层，所需的数字预编码器由如下公式所示：步骤132、构建DNN模型；DNN模型是由多个层组成的网络，包括输入层、输出层和多个隐藏层。更多层的DNN模型可以使用更少的参数来获得较优的性能，其中每一层由多个神经元组成，每个神经元的输出是其前一层神经元之间的权重矩阵的加权和，然后在神经元内部进行非线性运算。非线性运算可以由激活函数来实现，可以是Sigmoid函数或者是ReLU函数。首先考虑一个具有M个子载波的Nt×Nr的MIMO宽带系统，构建的DNN模型由输入层，输出层和四层全连接层组成。为了增强DNN模型对不同信噪比的泛化能力，输入的信道信息被平坦化为一维向量，并与噪声功率σ2级联，采用两个分别具有C1和C2个神经元的隐藏全连接层，并且激活函数设为ReLU激活函数，来提取估计的具有不完美CSI的信道信息，然后再进入两个全连接层，分别具有NtNRF和2NsNRF个神经元，对应上文所述的Nt×NRF大小的相位矩阵和Ns×NRF大小的数字预编码矩阵。此外，为了增强收敛，在每个全连接层之前都设置了一个批量归一化层，每层的丢弃概率被选择设置为0.05，它防止了由于噪声注入效应而导致的过拟合。最后分别连接到两个定义的Lambda层完成模拟预编码矩阵和数字预编码矩阵的输出。所提出的DNN模型的主要层的输出维度在表1中列出，其中省略了批量归一化层：表1 DNN模型的主要层的输出维度步骤133、采用无监督学习的方法，并采用与可达速率目标优化函数直接相关的损失函数进行无监督学习；该损失函数表示为：其中N为用于估计损失函数的训练样本数。从上式中可以清楚地看出，定义的损失函数的物理意义恰好对应于所有训练样本上的平均可达速率的负数值。损失函数的值越小，平均每个子载波上的可达速率就越高。此外，将具有完美CSI的信道矩阵作为损失函数的输入，所提出的DNN模型可以被训练成尽可能接近理想的可达速率。所提出的基于无监督学习的DNN混合预编码算法的离线和在线阶段过程如图3所示。在离线训练DNN的过程中，将足够数量的分别具有完美CSI的信道样本和不完美CSI的信道样本作为DNN的输入，将105个训练样本作为训练集，其中90％的数据样本分配给训练样本集，10％分配给验证样本集。此外，本申请使用Adam优化器和学习率衰减策略，如果经过20个周期的训练后损失没有减小，则学习率乘以0.2，其中学习率的初始值和最小值分别被设置为1×10-3和5×105。为了增强网络的抗噪鲁棒性，使用带有不同噪声功率的带噪数据样本来训练DNN，其中噪声功率是在-20dB到20dB之间随机产生的。由于在离线训练模式下通过将不完美CSI作为DNN的输入，并使用完美的CSI来计算损失函数，DNN已经学会如何尽可能地逼近在完美CSI情况下的最大可达速率。因此在在线测试阶段，将不完美CSI作为DNN的输入时，DNN对信道估计误差具有鲁棒性，可以输出最优的模拟预编码矩阵和数字预编码矩阵，从而最大化可达速率。实施例二本发明实施例二提供基于太赫兹大规模MIMO系统的混合预编码方法的仿真分析示例，通过仿真结果来评估所提出的基于DNN的混合预编码方案在太赫兹大规模MIMO系统中的性能。系统主要的参数设置为：散射路径数：L＝4，中心频率fc＝300GHz，信道带宽fs＝15GHz，发送天线数Nt，接收天线Nr＝2，子载波数M＝128，射频链路数NRF＝4。其中fs＝15GHz是太赫兹系统在未来6G通信中达到1Tbit/s传输速率的合理设置。发射机和接收机的物理方向被随机生成为U。DNN的前两层全连接网络的神经元数目通过实验被设置为C1＝1024，C2＝512，每层使用的激活函数设为ReLU函数。具体的DNN参数设置如表2所示：表2 DNN网络参数设置图4比较了不同批量大小对神经网络性能的影响。批量大小决定着单次送进神经网络中的样本规模，合理的批量大小可以充分的利用并行计算能力，对网络的训练是非常重要的。从图4中可以看出，较大的批量值和较小的批量值都会导致性能的下降，这是因为较小的批量值会导致每次修正方向是以各自样本的梯度方向修正，对其他样本不一定是有效的，难以达到收敛。盲目增大批量值大小，会需要更多的迭代次数，会降低模型的泛化能力，因此造成性能下降。所以在合理范围内增大批量值，其确定的下降方向越准，引起训练震荡越小，当批量值设定为1024时，系统表现出良好的性能。将基于TTD的相位校正混合预编码算法、传统宽带混合预编码算法这两种算法作为对比算法，全数字预编码算法作为最优算法被绘作系统可达速率的上限。图5比较的是在不同的训练周期下，不同混合预编码算法的系统可达速率性能。其中设置发送天线Nt＝128，接收天线Nr＝2，SNR＝20dB，由于基于TTD的混合预编码算法和传统宽带混合预编码算法不受训练周期的影响，因此将其在以上设置的信道情况下得到的最优可达速率数据进行对比。从图5中可以看出，当训练次数约大于500次时，所提算法性能优于基于TTD的混合预编码方案。这是因为基于深度学习的混合预编码算法根据优化算法Adam更新神经网络的权值，并通过迭代直到网络对输入的响应达到预定的目标范围为止。又由于所提出的算法是基于无监督深度学习的，因此输出的可达速率就是损失函数的负值，这也可以说明在1000次训练周期前，损失函数已经收敛，因此，网络的训练回合数设为1000是合理的，且可以达到一个较优的可达速率性能。图6展现了在不同发送天线数的情况下，不同算法之间的可达速率性能对比，其中，设置接收天线Nr＝2，子载波数M＝128，SNR＝20dB。从图6中可以看出，随着发送天线数量的增加，所提出的基于DNN的TTD混合预编码方案的可达速率性能在逐渐增加，并且优于传统的宽带混合预编码方案，且接近于最优的全数字混合预编码方案和基于TTD的相位校正混合预编码方案，说明了在太赫兹大规模MIMO宽带系统中所提出的算法可以很好的克服波束分裂效应，达到较优的可达速率。图7展示了在具有完美CSI的情况下不同算法随SNR变化的可达速率性能，其中的三个实验分别为在天线数64、128和256的情况下进行的性能对比。随着SNR的增多，各个混合预编码方案的系统可达速率性能也在逐渐提高。TTD混合预编码算法已经被验证在完美CSI的情况下可以实现非常优秀的可达速率性能，从图中可以看出所提出的基于DNN的混合预编码方案可以达到和全数字预编码方案和基于TTD的混合预编码算法相近的性能，而且当天线数增大时，传统的宽带混合预编码方案和所提出的DNN方案与基于TTD的混合预编码方案的可达速率差值越来越大，在天线数为64时是3.363bps/Hz和0.220bps/Hz，在天线数为256时差值分别为9.833bps/Hz和1.704bps/Hz，这是因为天线越多波束分裂效应越严重，传统的宽带混合预编码方案由于不能克服波束分裂效应所以性能下降，而所提出的DNN方案在天线数增多的情况下也可以保持一个较优的可达速率性能，说明了所提出的算法可以克服由于波束分裂效应导致的可达速率下降问题，验证了所提出方案在太赫兹信道下的有效性。图8展示了在具有不完美CSI的情况下不同算法随SNR变化的可达速率性能，其中的三个实验分别为在天线数64、128和256的情况下进行的性能对比。在实际生活中，具有完美CSI的信道数据获取是非常困难的，而基于TTD的混合预编码方案和传统的宽带混合预编码方案由于是在假设了已知完美的CSI的前提下设计的，因此当信噪比失配很大时，这些算法的性能退化可能非常严重。首先获取具有不完美CSI的信道矩阵，此算法基于TTD混合预编码结构，通过基于波束变焦机制可以灵活地控制与频率相关的波束在整个带宽上的角度覆盖，从而获得准确的物理方向。将导频噪声功率比定义为信道估计水平的指标。将信道估计算法产生的PNR＝0dB的估计信道数据样本作为不完美信道矩阵，在图8中可以看出，所提出的基于DNN的混合预编码方案在不完美CSI的情况下仍然拥有较优的性能，而其他两种算法性能都有所损失，且随着天线数量的增多，所提算法与其他两种方案的可达速率性能差距越来越大。这是因为在离线训练阶段把具有完美CSI的信道信息作为损失函数的输入，在测试阶段时网络所有的参数都已固定，因此DNN可以在具有不完美CSI的情况下输出最优模拟预编码矩阵和数字预编码矩阵，说明了所提出的算法具有良好的鲁棒性。为了进一步验证所提出的基于DNN混合预编码方案的高效性，表3和表4分别给出了在Nt＝64,Nt＝128,Nr＝2和M＝128的情况下的所提出的DNN-based混合预编码算法、基于TTD的相位矫正混合预编码方案和传统宽带混合预编码方案的运行时间比较，其中后两个混合预编码方案需要在MATLAB中进行迭代优化，根据仿真实验确定了迭代次数为200时可以运行平滑。此外，需要注意的是，虽然用大量的数据样本训练神经网络需要耗费大量的时间，但由于训练阶段一般都是离线实现的，因此可以不算在运行时间内。而且，一旦神经网络得到很好的训练，再测试训练好的神经网络的性能时运行时间要远远小于离线训练时间，且比需要迭代计算的其他两个混合预编码方案的运行时间要少得多。从表中可以看出，所提出的DNN混合预编码方案的运行时间显著减少，并且测试样本数越少，运行时间越短。需要注意的是，此仿真实验是在Inteli5-5200U CPU的硬件条件下运行的，不同设备运行时间也会不同。表3天线数为64时不同算法的运行时间比较表4天线数为128时不同算法的运行时间比较以上所述的具体实施方式，对本发明的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上所述仅为本发明的具体实施方式而已，并不用于限定本发明的保护范围，凡在本发明的技术方案的基础之上，所做的任何修改、等同替换、改进等，均应包括在本发明的保护范围之内。
