标题title
基于域自适应深度迁移网络的钢表面缺陷检测方法及系统
摘要abst
本发明提供一种基于域自适应深度迁移网络的钢表面缺陷检测方法及系统，方法包括：获取带钢表面典型缺陷图像样本，并对样本进行预处理；构建对抗域分离与自适应网络模型；将新样本特征嵌入到源域图像样本的共享特征中，并计算任务分类损失和嵌入分类损失；通过将多个损失添加权重，动态地优化动态分类损失与动态适应损失，并更新模型参数；当迭代次数达最优时，保存所述模型参数，并输入所述目标领域测试集，得到所述目标领域中钢表面缺陷检测的精度。本发明在对抗域分离与自适应深度迁移网络的基础上引入自适应挖掘样本隐藏信息和添加动态权重优化损失算法，提高了网络模型的泛化能力，最终实现更加精确的钢表面缺陷检测。
权利要求书clms
1.一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，包括：S1：获取带钢表面典型缺陷图像样本，并对样本进行预处理；S2：根据预处理后样本构建对抗域分离与自适应网络模型；S3：将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中，并输入至所述对抗域分离与自适应网络模型，计算任务分类损失和嵌入分类损失；S4：通过对多个损失添加权重，动态地优化动态分类损失与动态适应损失，其中所述动态分类损失包括任务分类损失和嵌入分类损失，所述动态适应损失包括域适应损失与域分离损失，并更新所述对抗域分离与自适应网络模型的参数；S5：判断更新中迭代次数是否达到最优迭代次数，若达到，则执行步骤S6，否则，返回执行步骤S3；S6：保存所述参数，得到优化好的对抗域分离与自适应网络模型，并检测目标领域样本测试集，得到钢表面缺陷检测精度。2.根据权利要求1所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述步骤S1中对样本进行预处理的方法为：首先，对所有图像样本进行分割并统一尺寸，选取N个源域图像样本与N个目标域图像样本，其中，所述源域图像样本与所述目标域图像样本均包括合格图像样本与缺陷图像样本，N为正整数；然后，将所述源域图像样本与所述目标域图像样本按照相同的比例各分为训练集与测试集；最后，将所述源域图像样本输入深度提取网络模型中，训练所述深度提取网络模型，得到训练好的模型参数。3.根据权利要求2所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述步骤S2中根据预处理后样本构建对抗域分离与自适应网络模型的方法为：首先，将源域图像样本与目标域图像样本训练集输入基于深度卷积神经网络的多个编码器网络模型，基于所述多个编码器网络模型分离源域与目标域各自的私有部分以及源域和目标域之间的共享部分，实现域信息分离，所述多个编码器网络模型包括共享编码器、源域私有编码器和目标域私有编码器网络模型；然后，利用所述源域图像样本训练好的模型参数初始化所述多个编码器网络模型；最后，将初始化后多个编码器网络模型的输出通过多层全连接网络输入到任务分类器、域适应鉴别器和域分离鉴别器中。4.根据权利要求1所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述步骤S3中将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中的方法为：根据对抗域分离与自适应网络模型的训练状态来自适应调整新样本特征的类间距离，并采用空间线性插值方法实现新样本的嵌入，所述对抗域分离与自适应模型的训练状态是通过训练过程中任务分类器的分类损失衡量；其中，所述新样本特征表示如下：其中，为嵌入的新样本特征，其标签对应相应的异类样本标签，X为同类样本特征，X-为异类样本特征，Ltask为任务分类损失，λ为调整嵌入新样本特征类间距离的参数；对所述新特征进行优化，其表达式如下：DE＝||X，X+||2DE＜DE其中，为嵌入的新样本特征，其标签对应相应的异类样本标签，X为同类样本特征，X-为异类样本特征，X+为原始样本特征，Ltask为任务分类损失，λ为调整嵌入新样本特征类间距离的参数，DE为同类样本之间的距离，DE为同类样本与异类样本之间的距离。5.根据权利要求1所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述步骤S4中通过对多个损失添加权重，动态地优化动态分类损失与动态适应损失，具体包括：所述动态分类损失是通过动态地调整任务分类损失和嵌入分类损失的权重的结果，表示如下：其中，Ldynamic-class为动态分类损失，Ltask为任务分类损失，Lembedded为嵌入分类损失；所述动态适应损失是通过动态地调整所述域适应损失与所述域分离损失的权重的结果，表示如下：其中，Ldynamic-ad为动态适应损失，Ladapt为域适应损失，Lsep为域分离损失。6.根据权利要求5所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述任务分类损失Ltask根据交叉熵计算得到，表示如下：其中，Ctask为任务分类器，Enj为共享编码器，为任务分类器的权值参数，为共享编码器的权值参数，xs为源域图像样本。7.根据权利要求5所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述域适应损失Ladapt根据域适应鉴别器混淆域特征产生，表示如下：其中，Enj为共享编码器，Dadapt为域适应鉴别器，为共享编码器的权值参数，为域适应鉴别器的权值参数，xs为源域图像样本，xt为目标域图像样本，Ex图像样本数学期望。8.根据权利要求5所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述域分离损失Lsep根据域分离鉴别器分离域特征产生，表示如下：其中，Enj为共享编码器，为源域私有编码器，为目标域私有编码器，Dsep为域分离鉴别器，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数，为域分离鉴别器的权值参数，xs为源域图像样本，xt为目标域图像样本，Ex图像样本数学期望。9.根据权利要求1或5所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，其特征在于，所述步骤S4中更新所述对抗域分离与自适应网络模型的参数的方法为：通过动态分类损失、域适应损失和域分离损失进行反向传播迭代更新多个编码器、域适应鉴别器和域分离鉴别器的模型参数，具体包括：初始化参数θ：其中，为域适应鉴别器的权值参数，为域分离鉴别器的权值参数，为任务分类器的权值参数，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数；动态分类损失更新各网络参数如下：其中，Enj为共享编码器，Ctask为任务分类器，为共享编码器的权值参数，为任务分类器的权值参数，Ldynamic-class为动态分类损失，η为学习率，为微分运算符；域适应损失更新各网络模型参数如下：其中，Dadapt为域适应鉴别器，Enj为共享编码器，为域适应鉴别器的权值参数，为共享编码器的权值参数，Ladapt为域适应损失，η为学习率，为微分运算符；域分离损失更新各网络模型参数如下：其中，Enj为共享编码器，为源域私有编码器，为目标域私有编码器，Dsep为域分离鉴别器，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数，为域分离鉴别器的权值参数，Ladapt为域适应损失，Lsep为域分离损失，η为学习率，为微分运算符。10.一种基于域自适应深度迁移网络的钢表面缺陷检测系统，其特征在于包括：样本预处理模块，用于获取带钢表面典型缺陷图像样本，并对样本进行预处理；构建网络模型模块，用于根据预处理后样本构建对抗域分离与自适应网络模型；优化网络模型模块，用于将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中，并输入至所述对抗域分离与自适应网络模型，计算任务分类损失和嵌入分类损失；通过对多个损失添加权重，动态地优化动态分类损失与动态适应损失，其中所述动态分类损失包括任务分类损失和嵌入分类损失，所述动态适应损失包括域适应损失与域分离损失，并更新所述对抗域分离与自适应网络模型的参数；判断更新中迭代次数是否达到最优迭代次数，若达到，则将优化结果输入样本检测模块，否则，继续进行迭代计算；样本检测模块，用于保存所述参数，得到优化好的对抗域分离与自适应网络模型，并检测目标领域样本测试集，得到钢表面缺陷检测精度。
说明书desc
技术领域本发明属于图像检测技术领域，尤其涉及一种基于域自适应深度迁移网络的钢表面缺陷检测方法及系统。背景技术钢材广泛应用于汽车制造、航空航天、日常生活用品等域，是国民经济发展中不可缺少的重要原材料。随着社会的快速发展，其质量要求越来越严格。在生产加工过程中，由于受到环境、设备性能、加工工艺等因素的影响，钢材表面会产生各种缺陷，如孔洞、划痕等。这些可观察到的缺陷会导致钢材性能发生变化，极大地降低了产品质量，从而对制造企业造成很大的负面影响和经济损失。因此钢表面缺陷检测作为钢材质量监测的重要环节受到了广泛的关注。钢材表面检测的首要目标是准确预测缺陷类型，由于早期主要采用人工检测，存在成本高、效率低、主观判断等不足。为此机器学习技术提供了一种高效、客观的图像检测方法，在一定程度上提高了缺陷识别的精度与效率。然而这种传统的机器学习需要专业人士具有丰富的经验及域知识才能提取出更加合适的特征，检测性能很大程度上依赖于特征的选择。与传统的机器学习不同，深度学习无需人工提取特征，可避免大量特征与分类器结合的试错实验，深层次、多角度地实现对图像特征的刻画。但深度学习在实际应用中仍存在许多待解决的问题，如计算量庞大、标注样本获取难、训练样本耗时费力等。随着人工智能技术的发展，迁移学习成为当前基于机器视觉的表面缺陷检测方法较为重要的研究内容之一，迁移学习的目标是将源任务获得的知识迁移到目标任务中辅助目标任务进行学习，解决深度学习中存在的样本量不足、训练效率低等问题。然而由于域差异的存在，直接迁移将降低模型性能。域自适应可以通过特征变换对齐源域与目标域的特征信息，解决域差异带来的问题。深度域自适应学习通过迁移特征信息打破了传统深度学习中样本同分布的局限性，加快了模型的收敛速度，但在实际应用中深度域自适应网络仍然存在图像特征提取能力弱、模型稳定性差且不易收敛等问题。因此，有必要优化深度域自适应网络，以进一步提高模型的训练性能。发明内容本发明实施例提供一种基于域自适应深度迁移网络的钢表面缺陷检测方法及系统，用于解决现有技术中检测模型的泛化能力差，甚至存在较低识别率的技术缺陷的问题。本发明实施例提供一种基于域自适应深度迁移网络的钢表面缺陷检测方法，该方法包括：S1：获取带钢表面典型缺陷图像样本，并对样本进行预处理；S2：根据预处理后样本构建对抗域分离与自适应网络模型；S3：将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中，并输入至所述对抗域分离与自适应网络模型，计算任务分类损失和嵌入分类损失；S4：通过对多个损失添加权重，动态地优化动态分类损失与动态适应损失，其中所述动态分类损失包括任务分类损失和嵌入分类损失，所述动态适应损失包括域适应损失与域分离损失，并更新所述对抗域分离与自适应网络模型的参数；S5：判断更新中迭代次数是否达到最优迭代次数，若达到，则执行步骤S6，否则，返回执行步骤S3；S6：保存所述参数，得到优化好的对抗域分离与自适应网络模型，并检测目标领域样本测试集，得到钢表面缺陷检测精度。优选地，所述步骤S1中对样本进行预处理的方法为：首先，对所有图像样本进行分割并统一尺寸，选取N个源域图像样本与N个目标域图像样本，其中，所述源域图像样本与所述目标域图像样本均包括合格图像样本与缺陷图像样本，N为正整数；然后，将所述源域图像样本与所述目标域图像样本按照相同的比例各分为训练集与测试集；最后，将所述源域图像样本输入深度提取网络模型中，训练所述深度提取网络模型，得到训练好的模型参数。优选地，所述步骤S2中根据预处理后样本构建对抗域分离与自适应网络模型的方法为：首先，将源域图像样本与目标域图像样本训练集输入基于深度卷积神经网络的多个编码器网络模型，基于所述多个编码器网络模型分离源域与目标域各自的私有部分以及源域和目标域之间的共享部分，实现域信息分离，所述多个编码器网络模型包括共享编码器、源域私有编码器和目标域私有编码器网络模型；然后，利用所述源域图像样本训练好的模型参数初始化所述多个编码器网络模型；最后，将初始化后多个编码器网络模型的输出通过多层全连接网络输入到任务分类器、域适应鉴别器和域分离鉴别器中。优选地，所述步骤S3中将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中的方法为：根据对抗域分离与自适应网络模型的训练状态来自适应调整新样本特征的类间距离，并采用空间线性插值方法实现新样本的嵌入，所述对抗域分离与自适应模型的训练状态是通过训练过程中任务分类器的分类损失衡量；其中，所述新样本特征表示如下：其中，为嵌入的新样本特征，其标签对应相应的异类样本标签，X为同类样本特征，X-为异类样本特征，Ltask为任务分类损失，λ为调整嵌入新样本特征类间距离的参数；对所述新特征进行优化，其表达式如下：DE＝‖X，X+‖2DE＜DE其中，为嵌入的新样本特征，其标签对应相应的异类样本标签，X为同类样本特征，X-为异类样本特征，X+为原始样本特征，Ltask为任务分类损失，λ为调整嵌入新样本特征类间距离的参数，DE为同类样本之间的距离，DE为同类样本与异类样本之间的距离。优选地，所述步骤S4中通过将多个损失添加权重，动态地优化动态分类损失与动态适应损失，具体包括：所述动态分类损失是通过动态地调整任务分类损失和嵌入分类损失的权重的结果，表示如下：其中，Ldynamic-class为动态分类损失，Ltask为任务分类损失，Lembedded为嵌入分类损失；所述动态适应损失是通过动态地调整所述域适应损失与所述域分离损失的权重的结果，表示如下：其中，Ldynamic-ad为动态适应损失，Ladapt为域适应损失，Lsep为域分离损失。优选地，所述任务分类损失Ltask根据交叉熵计算得到，表示如下：其中，Ctask为任务分类器，Enj为共享编码器，为任务分类器的权值参数，为共享编码器的权值参数，xs为源域图像样本。优选地，所述域适应损失Ladapt根据域适应鉴别器混淆域特征产生，表示如下：其中，Enj为共享编码器，Dadapt为域适应鉴别器，为共享编码器的权值参数，为域适应鉴别器的权值参数，xs为源域图像样本，xt为目标域图像样本，Ex图像样本数学期望。优选地，所述域分离损失Lsep根据域分离鉴别器分离域特征产生，表示如下：其中，Enj为共享编码器，为源域私有编码器，为目标域私有编码器，Dsep为域分离鉴别器，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数，为域分离鉴别器的权值参数，xs为源域图像样本，xt为目标域图像样本，Ex图像样本数学期望。优选地，所述步骤S4中更新所述对抗域分离与自适应网络模型的的方法为：通过动态分类损失、域适应损失和域分离损失进行反向传播迭代更新多个编码器、域适应鉴别器和域分离鉴别器的模型参数，具体包括：初始化参数θ：其中，为域适应鉴别器的权值参数，为域分离鉴别器的权值参数，为任务分类器的权值参数，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数；动态分类损失更新各网络参数如下：其中，Enj为共享编码器，Ctask为任务分类器，为共享编码器的权值参数，为任务分类器的权值参数，Ldynamic-class为动态分类损失，η为学习率，为微分运算符；域适应损失更新各网络模型参数如下：其中，Dadapt为域适应鉴别器，Enj为共享编码器，为域适应鉴别器的权值参数，为共享编码器的权值参数，Ladapt为域适应损失，η为学习率，为微分运算符；域分离损失更新各网络模型参数如下：其中，Enj为共享编码器，为源域私有编码器，为目标域私有编码器，Dsep为域分离鉴别器，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数，为域分离鉴别器的权值参数，Ladapt为域适应损失，Lsep为域分离损失，η为学习率，为微分运算符。本发明实施例提供一种基于域自适应深度迁移网络的钢表面缺陷检测系统，该系统包括：样本预处理模块，用于获取带钢表面典型缺陷图像样本，并对样本进行预处理；构建网络模型模块，用于根据预处理后样本构建对抗域分离与自适应网络模型；优化网络模型模块，用于将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中，并输入至所述对抗域分离与自适应网络模型，计算任务分类损失和嵌入分类损失；通过对多个损失添加权重，动态地优化动态分类损失与动态适应损失，其中所述动态分类损失包括任务分类损失和嵌入分类损失，所述动态适应损失包括域适应损失与域分离损失，并更新所述对抗域分离与自适应网络模型的参数；判断更新中迭代次数是否达到最优迭代次数，若达到，则将优化结果输入样本检测模块，否则，继续进行迭代计算；样本检测模块，用于保存所述参数，得到优化好的对抗域分离与自适应网络模型，并检测目标领域样本测试集，得到钢表面缺陷检测精度。所述系统用以实现上述所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法。与现有技术相比，本发明具有如下的有益效果：本发明提供一种基于域自适应深度迁移网络的钢表面缺陷检测方法及系统，本发明在对抗域分离与自适应深度迁移网络的基础上引入自适应挖掘样本隐藏信息和添加动态权重优化损失算法。自适应挖掘样本隐藏信息可以提高网络模型训练过程中的收敛速度与识别精度，而添加动态权重优化损失可以使在源领域上训练好的网络模型在目标领域上表现良好，使得网络模型自适应领域的变化，提高网络模型的泛化能力，最终实现更加精确的钢表面缺陷检测。附图说明为了更清楚地说明本发明实施案例或现有技术中的技术方案，下边将对实施例中所需要使用的附图做简单介绍，通过参考附图会更清楚的理解本发明的特征和优点，附图是示意性的而不应该理解为对本发明进行任何限制，对于本域普通技术人员来讲，在不付出创造性劳动的前提下，可以根据这些附图获得其他的附图。其中：图1是根据本发明实施例的一种基于域自适应深度迁移网络的钢表面缺陷检测方法的流程图；图2是根据本发明实施例的一种基于对抗域分离与自适应深度迁移网络模型的结构图；图3是根据本发明实施例的嵌入新样本特征原理示意图；图4是根据本发明实施例的一种基于域自适应深度迁移网络的钢表面缺陷检测系统的框图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一本发明实施例提供一种基于域自适应深度迁移网络的钢表面缺陷检测方法，如图1所示，本实施例的方法包括：S101：获取带钢表面典型缺陷图像样本，并对样本进行预处理；S102：根据预处理后样本构建对抗域分离与自适应网络模型；S103：将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中，并输入至所述对抗域分离与自适应网络模型，计算任务分类损失和嵌入分类损失；S104：通过对多个损失添加权重，动态地优化动态分类损失与动态适应损失，其中所述动态分类损失包括任务分类损失和嵌入分类损失，所述动态适应损失包括域适应损失与域分离损失，并更新所述对抗域分离与自适应网络模型的参数；S105：判断更新中迭代次数是否达到最优迭代次数，若达到，则执行步骤S106，否则，返回执行步骤S103；S106：保存所述参数，得到优化好的对抗域分离与自适应网络模型，并检测目标领域样本测试集，得到钢表面缺陷检测精度。本发明提供一种基于域自适应深度迁移网络的钢表面缺陷检测方法，本发明通过建立基于分类损失的对抗域分离与自适应模型性能评价机制；同时利用空间线性插值方法自适应挖掘迁移空间隐藏的样本信息，将挖掘的新样本的分类结果作为衡量其对网络贡献性能的主要度量指标，并将贡献性能作为权重应用在分类损失上，旨在消除噪声样本对模型造成的影响；在对抗训练过程中，通过添加动态权重优化对抗损失、平滑网络参数，提高模型的判别性能。本发明能够提高网络模型的训练性能，很大程度地提高了领域偏移环境下钢表面缺陷检测的准确性。进一步地，在步骤S101中对样本进行预处理的方法为：首先，对所有图像样本进行分割并统一尺寸，选取N个源域图像样本{Xs}与N个目标域图像样本{Xt}，其中，所述源域图像样本与所述目标域图像样本均包括合格图像样本与缺陷图像样本，N为正整数；然后，将所述源域图像样本与所述目标域图像样本按照相同的比例各分为训练集与测试集；最后，将所述源域图像样本输入深度提取网络模型中，训练所述深度提取网络模型，得到训练好的模型参数。图2为发明实施例的一种基于对抗域分离与自适应深度迁移网络模型的结构图，如图2所示，网络模型由三个部分组成：特征提取部分、特征迁移部分和任务分类部分。其中，特征提取部分包括共享编码器Enj、源域私有编码器和目标域私有编码器特征迁移部分包括域适应鉴别器Dadapt和域分离鉴别器Dsep，任务分类部分包括任务分类器Ctask。所述共享编码器Enj、源域私有编码器和目标域私有编码器采用AlexNet网络的特征提取结构，提取源域和目标域的共享特征以及各自的私有特征所述任务分类器Ctask由由一个全连接层构成，用于预测任务标签；所述域适应鉴别器Dadapt由两个全连接层组成，用于预测共享特征的域标签，域分离鉴别器Dsep同样由两个全连接层组成，用于预测特征标签。进一步地，在步骤S102中构建对抗域分离与自适应网络模型的方法为：首先，将源域图像样本{Xs}与目标域图像样本{Xt}训练集输入基于深度卷积神经网络的多个编码器网络模型，基于所述多个编码器网络模型分离源域与目标域各自的私有部分以及源域和目标域之间的共享部分，实现域信息分离，所述多个编码器网络模型包括共享编码器Enj、源域私有编码器和目标域私有编码器网络模型；然后，利用所述源域图像样本训练好的模型参数初始化所述多个编码器网络模型；最后，将初始化后多个编码器网络模型的输出通过多层全连接网络输入到任务分类器Ctask、域适应鉴别器Dadapt和域分离鉴别器Dsep中。图3为本发明实施例的嵌入新样本特征原理示意图，如图3所示，X+表示原始样本特征，X表示同类样本特征表示嵌入的新样本特征X-表示异类样本特征。进一步地，在步骤S103中将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中的方法为：根据对抗域分离与自适应网络模型的训练状态来自适应调整新样本特征的类间距离，并采用空间线性插值方法实现新样本的嵌入，所述对抗域分离与自适应模型的训练状态是通过训练过程中任务分类器Ctask的分类损失衡量；其中，新样本特征表示如下：其中，为嵌入新样本特征，其标签对应相应的异类样本标签，X为同类样本特征，X-为异类样本特征，Ltask为任务分类损失，λ为调整嵌入新样本特征类间距离的参数；为避免嵌入的新样本特征和同类样本特征X的类间距离接近零的情况出现，对所述新样本特征进行优化，其表达式如下：DE＝‖X，X+‖2DE＜DE其中，为嵌入的新样本特征，其标签对应相应的异类样本标签，X为同类样本特征，X-为异类样本特征，X+为原始样本特征，Ltask为任务分类损失，λ为调整嵌入新样本特征类间距离的参数，DE为同类样本之间的距离，DE为同类样本与异类样本之间的距离。进一步地，在步骤S104中通过将多个损失添加权重，动态地优化动态分类损失与动态适应损失，具体包括：所述动态分类损失是通过动态地调整任务分类损失和嵌入分类损失的权重的结果，表示如下：其中，Ldynamic-class为动态分类损失，Ltask为任务分类损失，Lembedded为嵌入分类损失；所述动态适应损失是通过动态地调整所述域适应损失与所述域分离损失的权重的结果，表示如下：其中，Ldynamic-ad为动态适应损失，Ladapt为域适应损失，Lsep为域分离损失。进一步地，所述任务分类损失Ltask根据交叉熵计算得到，表示如下：其中，Ctask为任务分类器，Enj为共享编码器，为任务分类器的权值参数，为共享编码器的权值参数，xs为源域图像样本。进一步地，所述域适应损失Ladapt根据域适应鉴别器混淆域特征产生，表示如下：其中，Enj为共享编码器，Dadapt为域适应鉴别器，为共享编码器的权值参数，为域适应鉴别器的权值参数，xs为源域图像样本，xt为目标域图像样本，Ex图像样本数学期望。进一步地，所述域分离损失Lsep根据域分离鉴别器分离域特征产生，表示如下：其中，Enj为共享编码器，为源域私有编码器，为目标域私有编码器，Dsep为域分离鉴别器，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数，为域分离鉴别器的权值参数，xs为源域图像样本，xt为目标域图像样本，Ex图像样本数学期望。再进一步地，更新所述对抗域分离与自适应网络模型的参数的方法为：通过动态分类损失、域适应损失和域分离损失进行反向传播迭代更新多个编码器、域适应鉴别器和域分离鉴别器的模型参数，具体包括：初始化参数θ：其中，为域适应鉴别器的权值参数，为域分离鉴别器的权值参数，为任务分类器的权值参数，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数；动态分类损失更新各网络参数如下：其中，Enj为共享编码器，Ctask为任务分类器，为共享编码器的权值参数，为任务分类器的权值参数，Ldynamic-class为动态分类损失，η为学习率，为微分运算符；域适应损失更新各网络模型参数如下：其中，Dadapt为域适应鉴别器，Enj为共享编码器，为域适应鉴别器的权值参数，为共享编码器的权值参数，Ladapt为域适应损失，η为学习率，为微分运算符；域分离损失更新各网络模型参数如下：其中，Enj为共享编码器，为源域私有编码器，为目标域私有编码器，Dsep为域分离鉴别器，为共享编码器的权值参数，为源域私有编码器的权值参数，为目标域私有编码器的权值参数，为域分离鉴别器的权值参数，Ladapt为域适应损失，Lsep为域分离损失，η为学习率，为微分运算符。实施例二本发明实施例提供一种基于域自适应深度迁移网络的钢表面缺陷检测系统，如图4所示，包括：样本预处理模块401，用于获取带钢表面典型缺陷图像样本，并对样本进行预处理；构建网络模型模块402，用于根据预处理后样本构建对抗域分离与自适应网络模型；优化网络模型模块403，用于将新样本特征嵌入到预处理后得到的源域图像样本的共享特征中，并输入至所述对抗域分离与自适应网络模型，计算任务分类损失和嵌入分类损失；通过对多个损失添加权重，动态地优化动态分类损失与动态适应损失，其中所述动态分类损失包括任务分类损失和嵌入分类损失，所述动态适应损失包括域适应损失与域分离损失，并更新所述对抗域分离与自适应网络模型的参数；判断更新中迭代次数是否达到最优迭代次数，若达到，则将优化结果输入样本检测模块，否则，继续进行迭代计算；样本检测模块404，用于保存所述参数，得到优化好的对抗域分离与自适应网络模型，并检测目标领域样本测试集，得到钢表面缺陷检测精度。所述系统，用以实现上述实施例一所述的一种基于域自适应深度迁移网络的钢表面缺陷检测方法，在此不再赘述。本域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。显然，上述实施例仅仅是为清楚地说明所作的举例，并非对实施方式的限定。对于所属域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引申出的显而易见的变化或变动仍处于本发明创造的保护范围之中。
