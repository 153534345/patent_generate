标题title
分布式锁移交方法、装置、电子设备和计算机可读介质
摘要abst
本公开的实施例公开了分布式锁移交方法、装置、电子设备和计算机可读介质。该方法的一具体实施方式包括：根据目标临界资源的分布式锁的值确定是否持有令牌；响应于确定持有令牌，利用目标临界资源执行业务操作；响应于确定利用目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定分布式锁是否满足移交条件；响应于确定分布式锁满足移交条件，将分布式锁的值更新为目标令牌环中下一应用节点的节点标识，其中，目标令牌环由竞争目标临界资源的各个应用节点组成。该实施方式实现了各个应用节点对临界资源进行竞争时的负载均衡。
权利要求书clms
1.一种分布式锁移交方法，包括：根据目标临界资源的分布式锁的值确定是否持有令牌；响应于确定持有令牌，利用所述目标临界资源执行业务操作；响应于确定利用所述目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定所述分布式锁是否满足移交条件；响应于确定所述分布式锁满足所述移交条件，将所述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，其中，所述目标令牌环由竞争所述目标临界资源的各个应用节点组成。2.根据权利要求1所述的方法，其中，所述方法还包括：响应于确定所述分布式锁不满足所述移交条件，再次利用所述目标临界资源执行业务操作。3.根据权利要求1所述的方法，其中，所述将所述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，还包括：为所述分布式锁设置过期时间段。4.根据权利要求3所述的方法，其中，所述方法还包括：响应于确定所述分布式锁被删除，对所述目标临界资源进行分布式锁抢占，其中，所述分布式锁在满足锁持有验证条件时被删除，所述锁持有验证条件是所述下一应用节点在所述过期时间段内未对所述分布式锁进行锁持有验证。5.根据权利要求1所述的方法，其中，所述分布式锁的生存时间大于所述令牌可持有时间。6.根据权利要求1所述的方法，其中，所述分布式锁通过以下步骤续约：响应于确定所述分布式锁不满足所述移交条件、且所述分布式锁的生存时间失效，对所述分布式锁续约。7.根据权利要求1所述的方法，其中，所述根据目标临界资源的分布式锁的值确定是否持有令牌，包括：响应于确定所述目标临界资源未进行分布式锁初始化，对所述目标临界资源进行分布式锁抢占；根据针对所述分布式锁抢占返回的令牌持有判断值，确定是否持有令牌。8.根据权利要求1所述的方法，其中，所述根据目标临界资源的分布式锁的值确定是否持有令牌，包括：利用当前应用节点的节点标识对所述目标临界资源的分布式锁的值进行验证；响应于确定所述当前应用节点的节点标识与所述目标临界资源的分布式锁的值相匹配，确定持有令牌。9.根据权利要求1所述的方法，其中，所述将所述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，包括：根据预先确定的节点标识序列确定所述目标令牌环中下一应用节点的节点标识；将所述分布式锁的值更新为所述下一应用节点的节点标识。10.根据权利要求9所述的方法，其中，所述节点标识序列通过以下步骤确定：从缓存数据库中加载目标令牌环列表，其中，所述目标令牌环列表包括节点标识，所述目标令牌环列表中的节点标识是竞争所述目标临界资源的各个应用节点在初始化时写入的；利用所述目标令牌环列表确定所述目标令牌环中各个应用节点的节点标识，得到节点标识序列。11.根据权利要求1所述的方法，其中，所述令牌可持有时间是当前应用节点在初始化时设置的。12.根据权利要求10所述的方法，其中，所述目标令牌环列表通过以下步骤更新：响应于确定所述目标令牌环中的任一应用节点退出所述目标令牌环，从所述目标令牌环列表中删除所述任一应用节点的节点标识。13.一种分布式锁移交装置，包括：第一确定单元，被配置成根据目标临界资源的分布式锁的值确定是否持有令牌；业务操作执行单元，被配置成响应于确定持有令牌，利用所述目标临界资源执行业务操作；第二确定单元，被配置成响应于确定利用所述目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定所述分布式锁是否满足移交条件；更新单元，被配置成响应于确定所述分布式锁满足所述移交条件，将所述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，其中，所述目标令牌环由竞争所述目标临界资源的各个应用节点组成。14.一种电子设备，包括：一个或多个处理器；存储装置，其上存储有一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如权利要求1-12中任一所述的方法。15.一种计算机可读介质，其上存储有计算机程序，其中，所述程序被处理器执行时实现如权利要求1-12中任一所述的方法。
说明书desc
技术领域本公开的实施例涉及计算机技术领域，具体涉及分布式锁移交方法、装置、电子设备和计算机可读介质。背景技术在分布式环境下，当多个应用节点同时操作临界资源时，会利用分布式锁协调各个应用节点，使得其中只有一个应用节点会获得分布式锁和临界资源的访问权限。目前，在实现分布式锁时，通常采用的方式为：基于关系型数据库实现分布式锁、或基于分布式缓存实现分布式锁。然而，当采用上述方式实现分布式锁时，经常会存在如下技术问题：基于关系型数据库实现分布式锁、或基于分布式缓存实现分布式锁时，各个应用节点对分布式锁的获取具有随机性，无法合理的控制各个应用节点对分布式锁公平的轮流获取，进而难以实现各个节点的负载均衡。发明内容本公开的内容部分用于以简要的形式介绍构思，这些构思将在后面的具体实施方式部分被详细描述。本公开的内容部分并不旨在标识要求保护的技术方案的关键特征或必要特征，也不旨在用于限制所要求的保护的技术方案的范围。本公开的一些实施例提出了分布式锁移交方法、装置、电子设备和计算机可读介质，来解决以上背景技术部分提到的技术问题。第一方面，本公开的一些实施例提供了一种分布式锁移交方法，该方法包括：根据目标临界资源的分布式锁的值确定是否持有令牌；响应于确定持有令牌，利用上述目标临界资源执行业务操作；响应于确定利用上述目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定上述分布式锁是否满足移交条件；响应于确定上述分布式锁满足上述移交条件，将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，其中，上述目标令牌环由竞争上述目标临界资源的各个应用节点组成。可选的，上述方法还包括：响应于确定上述分布式锁不满足上述移交条件，再次利用上述目标临界资源执行业务操作。可选的，上述将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，还包括：为上述分布式锁设置过期时间段。可选的，上述方法还包括：响应于确定上述分布式锁被删除，对上述目标临界资源进行分布式锁抢占，其中，上述分布式锁在满足锁持有验证条件时被删除，上述锁持有验证条件是上述下一应用节点在上述过期时间段内未对上述分布式锁进行锁持有验证。可选的，上述分布式锁的生存时间大于上述令牌可持有时间。可选的，上述分布式锁通过以下步骤续约：响应于确定上述分布式锁不满足上述移交条件、且上述分布式锁的生存时间失效，对上述分布式锁续约。可选的，上述根据目标临界资源的分布式锁的值确定是否持有令牌，包括：响应于确定上述目标临界资源未进行分布式锁初始化，对上述目标临界资源进行分布式锁抢占；根据针对上述分布式锁抢占返回的令牌持有判断值，确定是否持有令牌。可选的，上述根据目标临界资源的分布式锁的值确定是否持有令牌，包括：利用当前应用节点的节点标识对上述目标临界资源的分布式锁的值进行验证；响应于确定上述当前应用节点的节点标识与上述目标临界资源的分布式锁的值相匹配，确定持有令牌。可选的，上述将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，包括：根据预先确定的节点标识序列确定上述目标令牌环中下一应用节点的节点标识；将上述分布式锁的值更新为上述下一应用节点的节点标识。可选的，上述节点标识序列通过以下步骤确定：从缓存数据库中加载目标令牌环列表，其中，上述目标令牌环列表包括节点标识，上述目标令牌环列表中的节点标识是竞争上述目标临界资源的各个应用节点在初始化时写入的；利用上述目标令牌环列表确定上述目标令牌环中各个应用节点的节点标识，得到节点标识序列。可选的，上述令牌可持有时间是当前应用节点在初始化时设置的。可选的，上述目标令牌环列表通过以下步骤更新：响应于确定上述目标令牌环中的任一应用节点退出上述目标令牌环，从上述目标令牌环列表中删除上述任一应用节点的节点标识。第二方面，本公开的一些实施例提供了一种分布式锁移交装置，装置包括：第一确定单元，被配置成根据目标临界资源的分布式锁的值确定是否持有令牌；业务操作执行单元，被配置成响应于确定持有令牌，利用上述目标临界资源执行业务操作；第二确定单元，被配置成响应于确定利用上述目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定上述分布式锁是否满足移交条件；更新单元，被配置成响应于确定上述分布式锁满足上述移交条件，将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，其中，上述目标令牌环由竞争上述目标临界资源的各个应用节点组成。可选的，上述装置还包括业务操作再次执行单元，被配置成响应于确定上述分布式锁不满足上述移交条件，再次利用上述目标临界资源执行业务操作。可选的，上述更新单元还被进一步配置成为上述分布式锁设置过期时间段。可选的，上述装置还包括分布式锁抢占单元，被配置成响应于确定上述分布式锁被删除，对上述目标临界资源进行分布式锁抢占，其中，上述分布式锁在满足锁持有验证条件时被删除，上述锁持有验证条件是上述下一应用节点在上述过期时间段内未对上述分布式锁进行锁持有验证。可选的，上述分布式锁的生存时间大于上述令牌可持有时间。可选的，上述分布式锁通过以下步骤续约：响应于确定上述分布式锁不满足上述移交条件、且上述分布式锁的生存时间失效，对上述分布式锁续约。可选的，上述第一确定单元包括分布式锁抢占子单元和第一令牌持有确定子单元。其中，分布式锁抢占子单元，被配置成响应于确定上述目标临界资源未进行分布式锁初始化，对上述目标临界资源进行分布式锁抢占；第一令牌持有确定子单元，被配置成根据针对上述分布式锁抢占返回的令牌持有判断值，确定是否持有令牌。可选的，上述第一确定单元包括验证子单元和第二令牌持有确定子单元。其中，验证子单元，被配置成利用当前应用节点的节点标识对上述目标临界资源的分布式锁的值进行验证；第二令牌持有确定子单元，被配置成响应于确定上述当前应用节点的节点标识与上述目标临界资源的分布式锁的值相匹配，确定持有令牌。可选的，上述更新单元包括第一确定子单元和更新子单元。其中，第一确定子单元，被配置成根据预先确定的节点标识序列确定上述目标令牌环中下一应用节点的节点标识；更新子单元，被配置成将上述分布式锁的值更新为上述下一应用节点的节点标识。可选的，上述节点标识序列通过以下步骤确定：从缓存数据库中加载目标令牌环列表，其中，上述目标令牌环列表包括节点标识，上述目标令牌环列表中的节点标识是竞争上述目标临界资源的各个应用节点在初始化时写入的；利用上述目标令牌环列表确定上述目标令牌环中各个应用节点的节点标识，得到节点标识序列。可选的，上述令牌可持有时间是当前应用节点在初始化时设置的。可选的，上述目标令牌环列表通过以下步骤更新：响应于确定上述目标令牌环中的任一应用节点退出上述目标令牌环，从上述目标令牌环列表中删除上述任一应用节点的节点标识。第三方面，本公开的一些实施例提供了一种电子设备，包括：一个或多个处理器；存储装置，其上存储有一个或多个程序，当一个或多个程序被一个或多个处理器执行，使得一个或多个处理器实现上述第一方面任一实现方式所描述的方法。第四方面，本公开的一些实施例提供了一种计算机可读介质，其上存储有计算机程序，其中，程序被处理器执行时实现上述第一方面任一实现方式所描述的方法。本公开的上述各个实施例具有如下有益效果：通过本公开的一些实施例的分布式锁移交方法，将分布式锁与令牌环算法结合，可以提供高性能的锁获取机制、平衡分布式锁调度策略。具体来说，造成相关的分布式锁实现方式难以实现各个应用节点之间的负载均衡的原因在于：基于关系型数据库实现分布式锁、或基于分布式缓存实现分布式锁时，各个应用节点对分布式锁的获取具有随机性，无法合理的控制各个应用节点对分布式锁公平的轮流获取。基于此，本公开的一些实施例的分布式锁移交方法将分布式锁与令牌环算法进行结合，利用令牌环算法在竞争同一临界资源的各个应用节点之间有序的传递令牌，获得令牌的应用节点即获得该临界资源的分布式锁，即享有对该临界资源的访问权限。从而，通过令牌的传递，使得各个应用节点可公平的轮流获取分布式锁，并对临界资源进行访问。由此，可以实现各个应用节点对临界资源的均衡获取，实现负载均衡。附图说明结合附图并参考以下具体实施方式，本公开各实施例的上述和其他特征、优点及方面将变得更加明显。贯穿附图中，相同或相似的附图标记表示相同或相似的元素。应当理解附图是示意性的，元件和元素不一定按照比例绘制。图1是本公开的一些实施例的分布式锁移交方法的一个应用场景的示意图；图2是根据本公开的分布式锁移交方法的一些实施例的流程图；图3是根据本公开的分布式锁移交方法的一些实施例中的确定是否持有令牌的示意图；图4是根据本公开的分布式锁移交方法的另一些实施例的流程图；图5是本公开的分布式锁移交装置的一些实施例的结构示意图；图6是适于用来实现本公开的一些实施例的电子设备的结构示意图。具体实施方式下面将参照附图更详细地描述本公开的实施例。虽然附图中显示了本公开的某些实施例，然而应当理解的是，本公开可以通过各种形式来实现，而且不应该被解释为限于这里阐述的实施例。相反，提供这些实施例是为了更加透彻和完整地理解本公开。应当理解的是，本公开的附图及实施例仅用于示例性作用，并非用于限制本公开的保护范围。另外还需要说明的是，为了便于描述，附图中仅示出了与有关发明相关的部分。在不冲突的情况下，本公开中的实施例及实施例中的特征可以相互组合。需要注意，本公开中提及的“第一”、“第二”等概念仅用于对不同的装置、模块或单元进行区分，并非用于限定这些装置、模块或单元所执行的功能的顺序或者相互依存关系。需要注意，本公开中提及的“一个”、“多个”的修饰是示意性而非限制性的，本领域技术人员应当理解，除非在上下文另有明确指出，否则应该理解为“一个或多个”。本公开实施方式中的多个装置之间所交互的消息或者信息的名称仅用于说明性的目的，而并不是用于对这些消息或信息的范围进行限制。下面将参考附图并结合实施例来详细说明本公开。图1是本公开的一些实施例的分布式锁移交方法的一个应用场景的示意图。在图1的应用场景中，首先，计算设备101可以根据目标临界资源102的分布式锁103的值确定是否持有令牌104。然后，计算设备101可以响应于确定持有令牌104，利用上述目标临界资源102执行业务操作。接着，计算设备101可以响应于确定利用上述目标临界资源102执行业务操作完毕，根据预先设置的令牌可持有时间105确定上述分布式锁103是否满足移交条件106。最后，计算设备101可以响应于确定上述分布式锁103满足上述移交条件106，将上述分布式锁103的值更新为目标令牌环107中下一应用节点108的节点标识，其中，上述目标令牌环107由竞争上述目标临界资源102的各个应用节点组成。需要说明的是，上述计算设备101可以是硬件，也可以是软件。当计算设备为硬件时，可以实现成多个服务器或终端设备组成的分布式集群，也可以实现成单个服务器或单个终端设备。当计算设备体现为软件时，可以安装在上述所列举的硬件设备中。其可以实现成例如用来提供分布式服务的多个软件或软件模块，也可以实现成单个软件或软件模块。在此不做具体限定。应该理解，图1中的计算设备的数目仅仅是示意性的。根据实现需要，可以具有任意数目的计算设备。继续参考图2，示出了根据本公开的分布式锁移交方法的一些实施例的流程200。该分布式锁移交方法，包括以下步骤：步骤201，根据目标临界资源的分布式锁的值确定是否持有令牌。在一些实施例中，分布式锁移交方法的执行主体可以根据目标临界资源的分布式锁的值确定是否持有令牌。其中，上述执行主体可以是如图1所示的计算设备101。实践中，上述执行主体还可以是目标令牌环中的任一应用节点。上述目标令牌环由竞争同一临界资源的各个应用节点组成。可以将上述各个应用节点所竞争的临界资源确定为目标临界资源。临界资源是一次仅能被一个应用节点访问的资源。上述分布式锁可以由键值对表示。上述分布式锁的值可以是目标令牌环中任一应用节点的应用标识。可以将上述目标令牌环中应用标识与上述分布式锁的值相同的应用节点确定为持有令牌的应用节点。因此，上述执行主体可以对上述临界资源的分布式锁的值进行验证，若上述分布式锁的值与上述执行主体的节点标识相同，则可以确定上述执行主体持有令牌，具有访问上述目标临界资源的权限。若上述分布式锁的值与上述执行主体的节点标识不同，则可以确定上述执行主体未持有令牌，不具有访问上述目标临界资源的权限。在一些实施例的一些可选的实现方式中，上述执行主体确定是否持有令牌，可以包括以下步骤：第一步，响应于确定上述目标临界资源未进行分布式锁初始化，对上述目标临界资源进行分布式锁抢占。其中，上述目标临界资源未进行分布式锁初始化可以是上述目标临界资源还不存在分布式锁。上述目标临界资源未进行分布式锁初始化还可以是上述目标临界资源存在分布式锁，但分布式锁的值为初始值。上述初始值与上述目标令牌环中任一应用节点的节点标识均不相同。对上述目标临界资源进行分布式锁抢占可以是将执行主体将自身的节点标识写入上述目标临界资源的分布式锁的值中。目标令牌环中成功将节点标识写入上述目标临界资源的分布式锁的值中的应用节点为持有令牌的应用节点。在进行分布式锁抢占时，若上述目标临界资源不存在分布式锁，则为上述目标临界资源创建分布式锁，并对创建的分布式锁进行抢占。第二步，根据针对上述分布式锁抢占返回的令牌持有判断值，确定是否持有令牌。在对上述目标临界资源的分布式锁的值进行抢占后，目标令牌环中的每个应用节点都会收到返回的令牌持有判断值。令牌持有判断值可以为表征持有令牌的值或表征未持有令牌的值。目标令牌环中的各个应用节点所收到的令牌持有判断值中只有一个令牌持有判断值是表征持有令牌的值。实践中，表征持有令牌的值可以是true，表征未持有令牌的值false。作为示例，参考图3，首先，上述执行主体301可以响应于确定上述目标临界资源302未进行分布式锁初始化，对上述目标临界资源302进行分布式锁抢占。然后，可以根据针对上述分布式锁抢占返回的令牌持有判断值303，确定是否持有令牌304。由此，可以通过分布式锁的值控制令牌在目标令牌环中的传递。目标令牌环中的各个应用节点无需联通，且无需实现网络通信。避免了令牌环算法实现过程中复杂的消息协商通讯机制，降低了令牌环算法的实现成本。步骤202，响应于确定持有令牌，利用目标临界资源执行业务操作。在一些实施例中，上述执行主体可以响应于确定持有令牌，利用目标临界资源执行业务操作。其中，上述业务操作可以是针对上述目标临界资源的调度操作或消费操作。步骤203，响应于确定利用目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定分布式锁是否满足移交条件。在一些实施例中，上述执行主体可以响应于确定利用上述目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定上述分布式锁是否满足移交条件。其中，可以针对目标令牌环中的每个应用节点分别设置对应的令牌可持有时间。还可以针对目标令牌环中的各个应用节点设置统一的令牌可持有时间。上述移交条件可是当前持有令牌的应用节点的令牌持有时间大于等于上述令牌可持有时间。若当前持有令牌的应用节点的令牌持有时间大于等于上述令牌可持有时间，则上述分布式锁满足上述移交条件。若当前持有令牌的应用节点的令牌持有时间小于上述令牌可持有时间，则上述分布式锁不满足上述移交条件。可选的，上述令牌可持有时间是当前应用节点在初始化时设置的。在一些实施例的一些可选的实现方式中，上述分布式锁的生存时间大于上述令牌可持有时间。由此，通过将上述分布式锁的生存时间设置的大于上述令牌可持有时间，可以避免由于分布式锁在过生存时间而失效被删除后，目标令牌环中的各个应用节点已重新发起对目标临界资源的竞争，但原先因获取分布式锁而持有令牌的应用节点仍在消费目标临界资源而出现的分布式脑裂问题。可选的，上述分布式锁可以通过以下步骤续约：响应于确定上述分布式锁不满足上述移交条件、且上述分布式锁的生存时间失效，对上述分布式锁续约。由此，可以通过对上述分布式锁续约，避免由于分布式锁在过生存时间而失效被删除，进而避免出现分布式脑裂问题。步骤204，响应于确定分布式锁满足移交条件，将分布式锁的值更新为目标令牌环中下一应用节点的节点标识。在一些实施例中，上述执行主体可以响应于确定上述分布式锁满足上述移交条件，将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识。其中，目标令牌环中的每个应用节点可以预先存储记录目标令牌环中与自身相邻的下一应用节点的节点标识。由此，可以根据目标令牌环中各个应用节点的先后次序传递令牌，从而。可以实现各个应用节点对临界资源的均衡获取，实现负载均衡。在一些实施例的一些可选的实现方式中，上述执行主体还可以响应于确定上述分布式锁不满足上述移交条件，再次利用上述目标临界资源执行业务操作。可选的，上述执行在将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识时，还可以为上述分布式锁设置过期时间段。以及响应于确定上述分布式锁被删除，对上述目标临界资源进行分布式锁抢占。其中，上述分布式锁可以在满足锁持有验证条件时被删除。上述锁持有验证条件可以是上述下一应用节点在上述过期时间段内未对上述分布式锁进行锁持有验证。由此，可以通过为上述分布式锁设置的过期时间段，可以防止下一应用节点死亡而一直未对上述分布式锁进行验证而出现的死锁。本公开的上述各个实施例具有如下有益效果：通过本公开的一些实施例的分布式锁移交方法，将分布式锁与令牌环算法结合，可以提供高性能的锁获取机制、平衡分布式锁调度策略。具体来说，造成相关的分布式锁实现方式难以实现各个应用节点之间的负载均衡的原因在于：基于关系型数据库实现分布式锁、或基于分布式缓存实现分布式锁时，各个应用节点对分布式锁的获取具有随机性，无法合理的控制各个应用节点对分布式锁公平的轮流获取。基于此，本公开的一些实施例的分布式锁移交方法将分布式锁与令牌环算法进行结合，利用令牌环算法在竞争同一临界资源的各个应用节点之间有序的传递令牌，获得令牌的应用节点即获得该临界资源的分布式锁，即享有对该临界资源的访问权限。从而，通过令牌的传递，使得各个应用节点可公平的轮流获取分布式锁，并对临界资源进行访问。由此，可以实现各个应用节点对临界资源的均衡获取，实现负载均衡。进一步参考图4，其示出了分布式锁移交方法的另一些实施例的流程400。该分布式锁移交方法的流程400，包括以下步骤：步骤401，利用当前应用节点的节点标识对目标临界资源的分布式锁的值进行验证。在一些实施例中，分布式锁移交方法的执行主体可以利用当前应用节点的节点标识对上述目标临界资源的分布式锁的值进行验证。其中。上述分布式锁可以由键值对表示。上述分布式锁的值可以是目标令牌环中任一应用节点的应用标识。上述执行主体可以是当前应用节点。则可以确定当前应用节点的节点标识与上述目标临界资源的分布式锁的值是否匹配，从而实现对上述目标临界资源的分布式锁的值进行验证。匹配可以指当前应用节点的节点标识与上述目标临界资源的分布式锁的值相同。若当前应用节点的节点标识与上述目标临界资源的分布式锁的值相同，则可以确定持有令牌。若当前应用节点的节点标识与上述目标临界资源的分布式锁的值不同，则可以确定未持有令牌。步骤402，响应于确定当前应用节点的节点标识与目标临界资源的分布式锁的值相匹配，确定持有令牌。在一些实施例中，上述执行主体可以响应于确定上述当前应用节点的节点标识与上述目标临界资源的分布式锁的值相匹配，确定持有令牌。其中，当上述当前应用节点的节点标识与上述目标临界资源的分布式锁的值相同时，可以确定上述执行主体持有令牌、并获取对目标临界资源的访问权限。步骤403，响应于确定持有令牌，利用目标临界资源执行业务操作。步骤404，响应于确定利用目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定分布式锁是否满足移交条件。在一些实施例中，步骤403-404的具体实现方式及所带来的技术效果可以参考图2对应的那些实施例中的步骤202-203，在此不再赘述。步骤405，响应于确定分布式锁满足移交条件，将分布式锁的值更新为目标令牌环中下一应用节点的节点标识。在一些实施例中，上述执行主体可以响应于确定分布式锁满足移交条件，将分布式锁的值更新为目标令牌环中下一应用节点的节点标识，可以包括以下步骤：步骤4051，根据预先确定的节点标识序列确定目标令牌环中下一应用节点的节点标识。其中，上述节点标识序列中的节点标识可以是预先存储在分布式缓存中的、目标令牌环中各个应用节点的节点标识。上述节点标识序列中各个节点标识的顺序与上述目标令牌环中令牌在各个应用节点之间传递的顺序相同。可选的，上述节点标识序列通过以下步骤确定：第一步，从缓存数据库中加载目标令牌环列表。其中，上述目标令牌环列表可以包括节点标识。上述目标令牌环列表包括的各个节点标识的排列顺序与上述目标令牌环中令牌在各个应用节点之间传递的顺序相同。上述目标令牌环列表中的节点标识可以是竞争上述目标临界资源的各个应用节点在初始化时写入的。上述缓存数据库可以是分布式缓存数据库。第二步，利用上述目标令牌环列表确定上述目标令牌环中各个应用节点的节点标识，得到节点标识序列。上述执行主体可以利用缓存数据库中的令牌环列表，确定上述目标令牌环中各个应用节点的节点标识，得到节点标识序列。并对上述节点标识序列进行本地存储。可选的，上述目标令牌环列表可以通过以下步骤更新：响应于确定上述目标令牌环中的任一应用节点退出上述目标令牌环，从上述目标令牌环列表中删除上述任一应用节点的节点标识。以及，上述执行主体可以根据更新后的目标令牌环列表更新节点标识序列。可选的，上述目标令牌环列表还可以通过以下步骤更新：响应于确定任一应用节点加入上述目标令牌环，在上述目标令牌环列表中增加上述任一应用节点的节点标识。以及，上述执行主体可以根据更新后的目标令牌环列表更新节点标识序列。步骤4052，将分布式锁的值更新为下一应用节点的节点标识。可以将上述节点标识序列中与当前应用节点标识紧邻的下一应用节点标识确定为下一应用节点的节点标识。由此，可以利用第三方缓存数据库对目标令牌环中各个应用节点的次序进行维护，可以降低令牌环算法实现过程中令牌传输路径的通讯实现成本及系统实现复杂度。从图4中可以看出，与图2对应的一些实施例的描述相比，图4对应的一些实施例中的分布式锁移交方法的流程400体现了令牌在目标令牌环中的传递的具体步骤，由此，节点标识序列确定下一应用节点，并将分布式锁的值更新为下一应用节点的节点标识。从而，降低了令牌传输路径的通讯实现成本及系统实现复杂度，有利于系统维护。进一步参考图5，作为对上述各图所示方法的实现，本公开提供了一种分布式锁移交装置的一些实施例，这些装置实施例与图2所示的那些方法实施例相对应，该装置具体可以应用于各种电子设备中。如图5所示，一些实施例的分布式锁移交装置500包括：第一确定单元501、业务操作执行单元502、第二确定单元503和更新单元504。其中，第一确定单元501，被配置成根据目标临界资源的分布式锁的值确定是否持有令牌；业务操作执行单元502，被配置成响应于确定持有令牌，利用上述目标临界资源执行业务操作；第二确定单元503，被配置成响应于确定利用上述目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定上述分布式锁是否满足移交条件；更新单元504，被配置成响应于确定上述分布式锁满足上述移交条件，将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，其中，上述目标令牌环由竞争上述目标临界资源的各个应用节点组成。在一些实施例的可选实现方式中，上述装置500还包括业务操作再次执行单元，被配置成响应于确定上述分布式锁不满足上述移交条件，再次利用上述目标临界资源执行业务操作。在一些实施例的可选实现方式中，上述更新单元504还被进一步配置成为上述分布式锁设置过期时间段。在一些实施例的可选实现方式中，上述装置500还包括分布式锁抢占单元，被配置成响应于确定上述分布式锁被删除，对上述目标临界资源进行分布式锁抢占，其中，上述分布式锁在满足锁持有验证条件时被删除，上述锁持有验证条件是上述下一应用节点在上述过期时间段内未对上述分布式锁进行锁持有验证。在一些实施例的可选实现方式中，上述分布式锁的生存时间大于上述令牌可持有时间。在一些实施例的可选实现方式中，上述分布式锁通过以下步骤续约：响应于确定上述分布式锁不满足上述移交条件、且上述分布式锁的生存时间失效，对上述分布式锁续约。在一些实施例的可选实现方式中，上述第一确定单元501包括分布式锁抢占子单元和第一令牌持有确定子单元。其中，分布式锁抢占子单元，被配置成响应于确定上述目标临界资源未进行分布式锁初始化，对上述目标临界资源进行分布式锁抢占；第一令牌持有确定子单元，被配置成根据针对上述分布式锁抢占返回的令牌持有判断值，确定是否持有令牌。在一些实施例的可选实现方式中，上述第一确定单元501包括验证子单元和第二令牌持有确定子单元。其中，验证子单元，被配置成利用当前应用节点的节点标识对上述目标临界资源的分布式锁的值进行验证；第二令牌持有确定子单元，被配置成响应于确定上述当前应用节点的节点标识与上述目标临界资源的分布式锁的值相匹配，确定持有令牌。在一些实施例的可选实现方式中，上述更新单元504包括第一确定子单元和更新子单元。其中，第一确定子单元，被配置成根据预先确定的节点标识序列确定上述目标令牌环中下一应用节点的节点标识；更新子单元，被配置成将上述分布式锁的值更新为上述下一应用节点的节点标识。在一些实施例的可选实现方式中，上述节点标识序列通过以下步骤确定：从缓存数据库中加载目标令牌环列表，其中，上述目标令牌环列表包括节点标识，上述目标令牌环列表中的节点标识是竞争上述目标临界资源的各个应用节点在初始化时写入的；利用上述目标令牌环列表确定上述目标令牌环中各个应用节点的节点标识，得到节点标识序列。在一些实施例的可选实现方式中，上述令牌可持有时间是当前应用节点在初始化时设置的。在一些实施例的可选实现方式中，上述目标令牌环列表通过以下步骤更新：响应于确定上述目标令牌环中的任一应用节点退出上述目标令牌环，从上述目标令牌环列表中删除上述任一应用节点的节点标识。可以理解的是，该装置500中记载的诸单元与参考图2描述的方法中的各个步骤相对应。由此，上文针对方法描述的操作、特征以及产生的有益效果同样适用于装置500及其中包含的单元，在此不再赘述。下面参考图6，其示出了适于用来实现本公开的一些实施例的电子设备600的结构示意图。图6示出的电子设备仅仅是一个示例，不应对本公开的实施例的功能和使用范围带来任何限制。如图6所示，电子设备600可以包括处理装置601，其可以根据存储在只读存储器602中的程序或者从存储装置608加载到随机访问存储器603中的程序而执行各种适当的动作和处理。在RAM 603中，还存储有电子设备600操作所需的各种程序和数据。处理装置601、ROM 602以及RAM 603通过总线604彼此相连。输入/输出接口605也连接至总线604。通常，以下装置可以连接至I/O接口605：包括例如触摸屏、触摸板、键盘、鼠标、摄像头、麦克风、加速度计、陀螺仪等的输入装置606；包括例如液晶显示器、扬声器、振动器等的输出装置607；以及通信装置609。通信装置609可以允许电子设备600与其他设备进行无线或有线通信以交换数据。虽然图6示出了具有各种装置的电子设备600，但是应理解的是，并不要求实施或具备所有示出的装置。可以替代地实施或具备更多或更少的装置。图6中示出的每个方框可以代表一个装置，也可以根据需要代表多个装置。特别地，根据本公开的一些实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本公开的一些实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的一些实施例中，该计算机程序可以通过通信装置609从网络上被下载和安装，或者从存储装置608被安装，或者从ROM 602被安装。在该计算机程序被处理装置601执行时，执行本公开的一些实施例的方法中限定的上述功能。需要说明的是，本公开的一些实施例中记载的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本公开的一些实施例中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本公开的一些实施例中，计算机可读信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读信号介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：电线、光缆、RF等等，或者上述的任意合适的组合。在一些实施方式中，客户端、服务器可以利用诸如HTTP之类的任何当前已知或未来研发的网络协议进行通信，并且可以与任意形式或介质的数字数据通信互连。通信网络的示例包括局域网，广域网，网际网以及端对端网络，以及任何当前已知或未来研发的网络。上述计算机可读介质可以是上述电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被该电子设备执行时，使得该电子设备：根据目标临界资源的分布式锁的值确定是否持有令牌；响应于确定持有令牌，利用上述目标临界资源执行业务操作；响应于确定利用上述目标临界资源执行业务操作完毕，根据预先设置的令牌可持有时间确定上述分布式锁是否满足移交条件；响应于确定上述分布式锁满足上述移交条件，将上述分布式锁的值更新为目标令牌环中下一应用节点的节点标识，其中，上述目标令牌环由竞争上述目标临界资源的各个应用节点组成。可以以一种或多种程序设计语言或其组合来编写用于执行本公开的一些实施例的操作的计算机程序代码，上述程序设计语言包括面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网——连接到用户计算机，或者，可以连接到外部计算机。附图中的流程图和框图，图示了按照本公开各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，该模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本公开的一些实施例中的单元可以通过软件的方式实现，也可以通过硬件的方式来实现。所描述的单元也可以设置在处理器中，例如，可以描述为：一种处理器包括第一确定单元、业务操作执行单元、第二确定单元和更新单元。其中，这些单元的名称在某种情况下并不构成对该单元本身的限定，例如，第一确定单元还可以被描述为“锁持有确定单元”。本文中以上描述的功能可以至少部分地由一个或多个硬件逻辑部件来执行。例如，非限制性地，可以使用的示范类型的硬件逻辑部件包括：现场可编程门阵列、专用集成电路、专用标准产品、片上系统、复杂可编程逻辑设备等等。
