标题title
一种肺部病变识别方法及系统
摘要abst
本发明提出一种肺部病变识别方法及系统。通过目标检测和实例分割算法对肺部医学影像中的磨玻璃区域和支气管伴扩张区域进行检测，从而用于肺部病变的识别。本方法使用多尺度多深度的卷积神经网络结构提取肺部医学影像的基础视觉特征，通过特征金字塔网络来融合不同尺度和深度的特征。通过病变候选区域识别网络来提取可能是目标的区域的特征，同时过滤掉无用的背景信息。然后将提取出的目标区域特征通过分类头网络，检测头网络以及分割头网络得到检测分割的结果，最后通过非极大值抑制后处理得到最终预测结果。整体网络结构采用端到端的多任务模型，使得网络可以有效的学习医学影像的特征信息，增强算法的鲁棒性和泛化能力。
权利要求书clms
1.一种肺部病变识别方法，其特征在于，包括：步骤1、构建包括卷积神经网络、特征金字塔网络、病变候选区提取网络和联合识别网络的病变识别模型，其中该联合识别网络包括分类头网络、检测头网络和分割头网络三个网络；获取肺部医学影像作为训练数据，且该训练数据已标注病变区域和病变类别；步骤2、通过该卷积神经网络提取该训练数据多尺度的影像特征；该特征金字塔网络对该影像特征中相邻特征进行上采样和求和，融合不同尺度深度的特征，得到增强特征；将该增强特征输入该病变候选区提取网络，得到该增强特征中所有包含病变的候选区域特征；步骤3、将所有该候选区域特征输入该联合识别网络中，得到该训练数据的病变类别和病变区域，并结合该训练数据已标注的病变区域和病变类别构建损失函数，通过该损失函数迭代训练该病变识别模型，直到该损失函数收敛或达到预设迭代次数，使用当前病变识别模型识别得到指定肺部医学影像的病变区域。2.如权利要求1所述的肺部病变识别方法，其特征在于，该肺部医学影像为CT图像。3.如权利要求1所述的肺部病变识别方法，其特征在于，该步骤2包括：通过多尺度的特征金字塔网络，对该影像特征中不同尺度或深度的特征进行信息交互融合。4.如权利要求1所述的肺部病变识别方法，其特征在于，该病变类别包括磨玻璃和伴支气管扩张；该步骤3包括：通过该联合识别网络中分类头、检测头和分割头网络分别执行对应的分类、坐标框回归和语义分割任务，得到肺部医学影像中磨玻璃和伴支气管扩张区域识别结果。5.一种肺部病变识别系统，其特征在于，包括：模型构建模块，用于构建包括卷积神经网络、特征金字塔网络、病变候选区提取网络和联合识别网络的病变识别模型，其中该联合识别网络包括分类头网络、检测头网络和分割头网络三个网络；获取肺部医学影像作为训练数据，且该训练数据已标注病变区域和病变类别；影像特征提取模块，用于通过该卷积神经网络提取该训练数据多尺度的影像特征；该特征金字塔网络对该影像特征中相邻特征进行上采样和求和，融合不同尺度深度的特征，得到增强特征；将该增强特征输入该病变候选区提取网络，得到该增强特征中所有包含病变的候选区域特征；病变区域识别模块，用于将所有该候选区域特征输入该联合识别网络中，得到该训练数据的病变类别和病变区域，并结合该训练数据已标注的病变区域和病变类别构建损失函数，通过该损失函数迭代训练该病变识别模型，直到该损失函数收敛或达到预设迭代次数，使用当前病变识别模型识别得到指定肺部医学影像的病变区域。6.如权利要求1所述的肺部病变识别系统，其特征在于，该肺部医学影像为CT图像。7.如权利要求1所述的肺部病变识别系统，其特征在于，该影像特征提取模块包括：通过多尺度的特征金字塔网络，对该影像特征中不同尺度或深度的特征进行信息交互融合。8.如权利要求1所述的肺部病变识别系统，其特征在于，该病变类别包括磨玻璃和伴支气管扩张；该病变区域识别模块包括：通过该联合识别网络中分类头、检测头和分割头网络分别执行对应的分类、坐标框回归和语义分割任务，得到肺部医学影像中磨玻璃和伴支气管扩张区域识别结果。9.一种存储介质，用于存储执行权利要求1到4所述任意一种肺部病变识别方法的程序。10.一种客户端，用于权利要求5至8中任意一种肺部病变识别系统。
说明书desc
技术领域本发明属于图像处理中目标分类技术领域，结合医学影像的目标检测实例分割网络结构用于肺部病变区域的识别，并特别涉及一种肺部病变识别方法及系统。背景技术近年来，深度学习在医学领域慢慢的火热了起来。由于深度学习网络强大的非线性建模能力以及医学图像本身信息量大，特征丰富，模态种类多的特点，深度学习网络在医学图像上的应用越来越广泛。基于深度学习的两阶段目标检测结构最早是在2015年NIPS上发表的《Faster R-CNN:Towards Real-Time Object Detection with Region Proposal Networks》用于MS-COCO自然图片上常见类别的检测，即同时分类和定位人，车，动物等目标。在2017年ICCV上Kaiming He基于Faster R-CNN进行改进，发表了论文《MASK R-CNN》用于对自然图像中预定义类别目标进行实例分割，取得了当时的最优结果。其原理主要是采用先检测后分割的流程，先检测出每个目标实例，然后对每个实例再进行分割，另外一个重要的贡献就是通过实验表明加入分割任务对检测精度提升有很大帮助。随着深度学习的不断进步与发展，目标检测和实例分割算法也开始慢慢出现在各种行业的应用中，如工业瑕疵检测，行人检测等，但是在医学影像领域的应用还有很大的潜力待挖掘。发明内容本发明旨在解决以上现有技术的问题。提出了一种结合医学影像多任务学习的目标检测及实例分割网络结构方法。针对现有技术的不足，本发明提出一种肺部病变识别方法，其中包括：步骤1、构建包括卷积神经网络、特征金字塔网络、病变候选区提取网络和联合识别网络的病变识别模型，其中该联合识别网络包括分类头网络、检测头网络和分割头网络三个网络；获取肺部医学影像作为训练数据，且该训练数据已标注病变区域和病变类别；步骤2、通过该卷积神经网络提取该训练数据多尺度的影像特征；该特征金字塔网络对该影像特征中相邻特征进行上采样和求和，融合不同尺度深度的特征，得到增强特征；将该增强特征输入该病变候选区提取网络，得到该增强特征中所有包含病变的候选区域特征；步骤3、将所有该候选区域特征输入该联合识别网络中，得到该训练数据的病变类别和病变区域，并结合该训练数据已标注的病变区域和病变类别构建损失函数，通过该损失函数迭代训练该病变识别模型，直到该损失函数收敛或达到预设迭代次数，使用当前病变识别模型识别得到指定肺部医学影像的病变区域。所述的肺部病变识别方法，其中该肺部医学影像为CT图像。所述的肺部病变识别方法，其中该步骤2包括：通过多尺度的特征金字塔网络，对该影像特征中不同尺度或深度的特征进行信息交互融合。所述的肺部病变识别方法，其中该病变类别包括磨玻璃和伴支气管扩张；该步骤3包括：通过该联合识别网络中分类头、检测头和分割头网络分别执行对应的分类、坐标框回归和语义分割任务，得到肺部医学影像中磨玻璃和伴支气管扩张区域识别结果。本发明还提出了一种肺部病变识别系统，其中包括：模型构建模块，用于构建包括卷积神经网络、特征金字塔网络、病变候选区提取网络和联合识别网络的病变识别模型，其中该联合识别网络包括分类头网络、检测头网络和分割头网络三个网络；获取肺部医学影像作为训练数据，且该训练数据已标注病变区域和病变类别；影像特征提取模块，用于通过该卷积神经网络提取该训练数据多尺度的影像特征；该特征金字塔网络对该影像特征中相邻特征进行上采样和求和，融合不同尺度深度的特征，得到增强特征；将该增强特征输入该病变候选区提取网络，得到该增强特征中所有包含病变的候选区域特征；病变区域识别模块，用于将所有该候选区域特征输入该联合识别网络中，得到该训练数据的病变类别和病变区域，并结合该训练数据已标注的病变区域和病变类别构建损失函数，通过该损失函数迭代训练该病变识别模型，直到该损失函数收敛或达到预设迭代次数，使用当前病变识别模型识别得到指定肺部医学影像的病变区域。所述的肺部病变识别系统，其中该肺部医学影像为CT图像。所述的肺部病变识别系统，其中该影像特征提取模块包括：通过多尺度的特征金字塔网络，对该影像特征中不同尺度或深度的特征进行信息交互融合。所述的肺部病变识别系统，其中该病变类别包括磨玻璃和伴支气管扩张；该病变区域识别模块包括：通过该联合识别网络中分类头、检测头和分割头网络分别执行对应的分类、坐标框回归和语义分割任务，得到肺部医学影像中磨玻璃和伴支气管扩张区域识别结果。本发明还提出了一种存储介质，用于存储执行所述肺部病变识别方法的程序。本发明还提出了一种客户端，用于所述肺部病变识别系统。由以上方案可知，本发明的优点在于：本发明通过目标检测实例分割网络结构使用医学影像识别肺部病变。使用多尺度多深度的卷积神经网络结构提取肺部医学影像的基础视觉特征，通过特征金字塔网络来融合不同尺度和深度的特征。通过病变候选区域识别网络来提取可能是目标的区域的特征，同时过滤掉无用的背景信息。然后将提取出的目标区域特征通过分类头网络、检测网络、分割网络得到检测分割的结果，最后通过非极大值抑制后处理得到最终预测结果。整体网络结构采用端到端的多任务模型，使得网络可以有效的学习医学影像的特征信息，增强算法的鲁棒性和泛化能力。附图说明图1是本发明提供优选实施例方法的流程图；图2是整体的网络结构。具体实施方式为让本发明的上述特征和效果能阐述的更明确易懂，下文特举实施例，并配合说明书附图作详细说明如下。本发明的核心技术在于首先通过特征金字塔网络融合多尺度的医学影像的特征，有效检测不同大小的目标。同时采用分类、检测、分割三个任务联合学习的方式提升整体的识别效果。因此使用特征金字塔网络结构有效提取医学影像特征，通过多任务学习提升最终的识别效果，在医学领域具有广泛的应用前景。本发明提出了一种结合医学影像的肺部病变识别方法，包括：S1、获取医学影像的原始图像，然后将图片使用固定的均值和方差进行相应的归一化。S2、将归一化处理之后的医学影像输入到基础网络里面来提取基础特征图。S3、将基础特征图输入到特征金字塔网络，来提取并融合多尺度的医学影像特征图，该特征图可以用于同时识别不同大小的病变目标。S4、将上一步得到的多尺度特征输入病变候选区域提取网络中得到若干可能是病变的特征。S5、将所有病变候选特征送入分类头网络、检测头网络、分割头网络三个网络进行对应的分类，坐标框回归和语义分割任务，采用联合学习方式互相提升效果。这里的联合学习指的是分类，检测和分割三个网络有各自对应的损失函数，训练的时候它们三个同时进行优化。为让本发明的上述特征和效果能阐述的更明确易懂，下文特举实施例，并配合说明书附图作详细说明如下。本发明解决上述技术问题的技术方案是：本发明的方法流程如图1所示。本发明涉及了特征注意力网络结构示例如图2。具体步骤：步骤S1：首先获取待测试者的肺部医学影像。由于医学影像图片较多，需要对医学影像图片进行筛选，选择肺部病变特征比较明显的医学影像图片作为训练集。由于影像图像的数值分布范围不同，为了更好的训练网络需要将影像图像采用固定的均值方差进行归一化处理，再放到网络里面进行训练与测试。步骤S2：将归一化之后的医学影像传输到基础特征提取网络中来提取基础特征图。医学影像一般是单通道的灰度图像，由于器官本身结构固定和语义信息没有特别丰富，所以高级语义信息和低级特征都显得很重要，因此采用ResNet-50作为基础网络结构来提取图像的语义信息。步骤S3：将医学影像基础特征图传到特征金字塔网络结构中，通过对相邻尺度的特征图上采样求和，来有效地融合不同尺度的特征信息，便于同时识别不同大小的病变区域。步骤S4：将S3中得到的多尺度医学影像特征图输入病变候选区提取网络，获得若干病变候选区域的特征，这一步可以初步筛选出潜在的病变区域，过滤掉无关的背景。步骤S5：将S4中得到的潜在病变的医学影像特征图输入分类头网络、检测网络、分割网络，获得对磨玻璃区域和知支气管扩张区域的识别结果。其中，分类是区分是磨玻璃还是背景，是支气管还是背景，检测是得到磨玻璃和支气管具体的位置，分割是在得到的具体位置里面进行细致的像素级区分。以下为与上述方法实施例对应的系统实施例，本实施方式可与上述实施方式互相配合实施。上述实施方式中提到的相关技术细节在本实施方式中依然有效，为了减少重复，这里不再赘述。相应地，本实施方式中提到的相关技术细节也可应用在上述实施方式中。本发明还提出了一种肺部病变识别系统，其中包括：模型构建模块，用于构建包括卷积神经网络、特征金字塔网络、病变候选区提取网络和联合识别网络的病变识别模型，其中该联合识别网络包括分类头网络、检测头网络和分割头网络三个网络；获取肺部医学影像作为训练数据，且该训练数据已标注病变区域和病变类别；影像特征提取模块，用于通过该卷积神经网络提取该训练数据多尺度的影像特征；该特征金字塔网络对该影像特征中相邻特征进行上采样和求和，融合不同尺度深度的特征，得到增强特征；将该增强特征输入该病变候选区提取网络，得到该增强特征中所有包含病变的候选区域特征；病变区域识别模块，用于将所有该候选区域特征输入该联合识别网络中，得到该训练数据的病变类别和病变区域，并结合该训练数据已标注的病变区域和病变类别构建损失函数，通过该损失函数迭代训练该病变识别模型，直到该损失函数收敛或达到预设迭代次数，使用当前病变识别模型识别得到指定肺部医学影像的病变区域。所述的肺部病变识别系统，其中该肺部医学影像为CT图像。所述的肺部病变识别系统，其中该影像特征提取模块包括：通过多尺度的特征金字塔网络，对该影像特征中不同尺度或深度的特征进行信息交互融合。所述的肺部病变识别系统，其中该病变类别包括磨玻璃和伴支气管扩张；该病变区域识别模块包括：通过该联合识别网络中分类头、检测头和分割头网络分别执行对应的分类、坐标框回归和语义分割任务，得到肺部医学影像中磨玻璃和伴支气管扩张区域识别结果。本发明还提出了一种存储介质，用于存储执行所述肺部病变识别方法的程序。本发明还提出了一种客户端，用于所述肺部病变识别系统。
