标题title
一种锂电池充放电设备组件升级方法
摘要abst
本发明提供了锂电池测试技术领域的一种锂电池充放电设备组件升级方法，包括：步骤S10、中位机创建升级进程，获取升级配置表、升级数据包；步骤S20、中位机通过升级进程解析升级配置表得到组件信息以及组件类型，基于组件类型为各组件生成对应的通信协议；步骤S30、中位机基于通信协议以组件为单位分别创建业务子线程，通过业务子线程将升级数据包按通信协议封装后发送给对应的组件；步骤S40、各组件基于升级数据包执行升级操作，向中位机反馈升级结果；步骤S50、中位机基于升级结果向上位机发送升级完成的通知，或者执行故障修复操作。本发明的优点在于：极大的提升了锂电池充放电设备组件升级的便捷性、稳定性以及兼容性，有效降低了组件升级成本。
权利要求书clms
1.一种锂电池充放电设备组件升级方法，其特征在于：包括如下步骤：步骤S10、中位机创建一升级进程，获取升级配置表以及升级数据包；步骤S20、中位机通过所述升级进程解析升级配置表得到本次升级业务的组件信息以及组件类型，基于所述组件类型为本次升级业务的各组件生成对应的通信协议；步骤S30、中位机基于所述通信协议以组件为单位分别创建一业务子线程，通过所述业务子线程将升级数据包按通信协议封装后发送给对应的组件；步骤S40、各组件基于接收的所述升级数据包执行升级操作，并向中位机反馈升级结果；步骤S50、中位机基于接收的所述升级结果向上位机发送升级完成的通知，或者执行故障修复操作。2.如权利要求1所述的一种锂电池充放电设备组件升级方法，其特征在于：所述步骤S10具体为：中位机创建一升级进程，通过所述升级进程从预设路径获取升级配置表以及升级数据包；所述升级对象表至少包括组件信息以及组件类型；所述组件信息至少包括IP地址、端口以及通道。3.如权利要求1所述的一种锂电池充放电设备组件升级方法，其特征在于：所述步骤S20具体为：中位机预先存储一XML格式的协议模板，所述协议模板存储有各组件类型对应的协议参数；中位机通过所述升级进程解析升级配置表得到本次升级业务的组件信息以及组件类型，基于所述组件类型从协议模板匹配映射对应的协议参数，基于所述协议参数为本次升级业务的各组件生成对应的XML格式的通信协议，并将所述通信协议存储至存储器中。4.如权利要求3所述的一种锂电池充放电设备组件升级方法，其特征在于：所述协议参数至少包括协议类型、校验方法、发送内容、接收内容以及内容项目。5.如权利要求1所述的一种锂电池充放电设备组件升级方法，其特征在于：所述步骤S30具体包括：步骤S31、中位机基于所述通信协议为各组件分别创建一业务子线程，通过所述业务子线程以及升级配置表向各待升级的组件发送启动升级指令；步骤S32、中位机判断预设时长内是否接收到各组件反馈的允许升级应答，若是，则进入步骤S33；若否，则结束流程；步骤S33、中位机通过所述业务子线程以及升级配置表，将升级数据包按预设大小分批循环发送给对应的组件，直至完成所述升级数据包的发送。6.如权利要求1所述的一种锂电池充放电设备组件升级方法，其特征在于：所述步骤S40具体为：各组件解析接收的所述升级数据包，基于所述升级数据包实时执行升级操作，并向中位机实时反馈升级进度以及升级结果；所述升级结果为升级成功或者升级失败；升级失败的所述升级结果携带故障代码。7.如权利要求1所述的一种锂电池充放电设备组件升级方法，其特征在于：所述步骤S50具体包括：步骤S51、中位机接收组件反馈的所述升级结果，解析所述升级结果，若为升级成功，则进入步骤S52；若为升级失败，则进入步骤S53；步骤S52、中位机向上位机发送升级完成的通知，依次退出所述业务子线程以及升级进程；步骤S53、中位机基于所述升级结果携带的故障代码，从存储器中匹配预先存储的故障修复包，并将所述故障修复包通过业务子线程发送给对应的组件执行故障修复操作，并接收组件反馈的升级结果，判断升级是否成功，若是，则进入步骤S52；若否，则进入步骤S54；步骤S54、中位机对升级失败的组件进行电源的复位，重新执行升级操作，并接收组件反馈的升级结果，判断升级是否成功，若是，则进入步骤S52；若否，则向上位机发送升级失败的通知，依次退出所述业务子线程以及升级进程。8.如权利要求1所述的一种锂电池充放电设备组件升级方法，其特征在于：还包括：步骤S60、在锂电池充放电设备新增组件时，基于组件的组件类型修改对应的协议参数，以生成对应的通信协议，进而与已有的通信协议进行协议隔离。
说明书desc
技术领域本发明涉及锂电池测试技术领域，特别指一种锂电池充放电设备组件升级方法。背景技术随着新能源的兴起和发展，锂电池作为绿色高能化学电源，具有高能量、高功率、低成本等优点，在新能源行业中得到广泛的应用。为了保障锂电池使用的安全性，出厂前需要对锂电池进行一系列的测试，测试需要使用到锂电池充放电设备。由于要对锂电池进行一系列的测试，因此锂电池充放电设备集成了若干个具有不同测试功能的组件，各组件需要进行有机协同操作以完成具体的充放电测试。当出现新的市场需求或者功能需求时，需要对各组件进行升级，但由于组件的数量繁多，所承担的功能也不同，且采用的的芯片方案和工作方案也不尽相同，传统上需要对各组件进行拆机，再使用不同芯片厂商所提供的特定工具进行烧片，存在如下缺点：1、需要拆机升级，升级过程繁琐且出现故障概率高；2、不同芯片的升级需使用不同的工具，维护成本高昂；3、升级出现故障需将组件寄回原厂，并等待原厂回复，时效性差，并可能导致整个锂电池充放电设备无法使用；4、组件的协议众多，无法兼容。因此，如何提供一种锂电池充放电设备组件升级方法，实现提升锂电池充放电设备组件升级的便捷性、稳定性以及兼容性，降低升级成本，成为一个亟待解决的技术问题。发明内容本发明要解决的技术问题，在于提供一种锂电池充放电设备组件升级方法，实现提升锂电池充放电设备组件升级的便捷性、稳定性以及兼容性，降低升级成本。本发明是这样实现的：一种锂电池充放电设备组件升级方法，包括如下步骤：步骤S10、中位机创建一升级进程，获取升级配置表以及升级数据包；步骤S20、中位机通过所述升级进程解析升级配置表得到本次升级业务的组件信息以及组件类型，基于所述组件类型为本次升级业务的各组件生成对应的通信协议；步骤S30、中位机基于所述通信协议以组件为单位分别创建一业务子线程，通过所述业务子线程将升级数据包按通信协议封装后发送给对应的组件；步骤S40、各组件基于接收的所述升级数据包执行升级操作，并向中位机反馈升级结果；步骤S50、中位机基于接收的所述升级结果向上位机发送升级完成的通知，或者执行故障修复操作。进一步地，所述步骤S10具体为：中位机创建一升级进程，通过所述升级进程从预设路径获取升级配置表以及升级数据包；所述升级对象表至少包括组件信息以及组件类型；所述组件信息至少包括IP地址、端口以及通道。进一步地，所述步骤S20具体为：中位机预先存储一XML格式的协议模板，所述协议模板存储有各组件类型对应的协议参数；中位机通过所述升级进程解析升级配置表得到本次升级业务的组件信息以及组件类型，基于所述组件类型从协议模板匹配映射对应的协议参数，基于所述协议参数为本次升级业务的各组件生成对应的XML格式的通信协议，并将所述通信协议存储至存储器中。进一步地，所述协议参数至少包括协议类型、校验方法、发送内容、接收内容以及内容项目。进一步地，所述步骤S30具体包括：步骤S31、中位机基于所述通信协议为各组件分别创建一业务子线程，通过所述业务子线程以及升级配置表向各待升级的组件发送启动升级指令；步骤S32、中位机判断预设时长内是否接收到各组件反馈的允许升级应答，若是，则进入步骤S33；若否，则结束流程；步骤S33、中位机通过所述业务子线程以及升级配置表，将升级数据包按预设大小分批循环发送给对应的组件，直至完成所述升级数据包的发送。进一步地，所述步骤S40具体为：各组件解析接收的所述升级数据包，基于所述升级数据包实时执行升级操作，并向中位机实时反馈升级进度以及升级结果；所述升级结果为升级成功或者升级失败；升级失败的所述升级结果携带故障代码。进一步地，所述步骤S50具体包括：步骤S51、中位机接收组件反馈的所述升级结果，解析所述升级结果，若为升级成功，则进入步骤S52；若为升级失败，则进入步骤S53；步骤S52、中位机向上位机发送升级完成的通知，依次退出所述业务子线程以及升级进程；步骤S53、中位机基于所述升级结果携带的故障代码，从存储器中匹配预先存储的故障修复包，并将所述故障修复包通过业务子线程发送给对应的组件执行故障修复操作，并接收组件反馈的升级结果，判断升级是否成功，若是，则进入步骤S52；若否，则进入步骤S54；步骤S54、中位机对升级失败的组件进行电源的复位，重新执行升级操作，并接收组件反馈的升级结果，判断升级是否成功，若是，则进入步骤S52；若否，则向上位机发送升级失败的通知，依次退出所述业务子线程以及升级进程。进一步地，还包括：步骤S60、在锂电池充放电设备新增组件时，基于组件的组件类型修改对应的协议参数，以生成对应的通信协议，进而与已有的通信协议进行协议隔离。本发明的优点在于：通过在中位机创建升级进程，通过升级进程获取升级配置表以及升级数据包，通过升级配置表获取组件类型进而生成对应的通信协议，再基于通信协议创建业务子线程以将升级数据包发送给对应的组件执行升级操作，无需像传统上进行拆机升级，也无需专用的升级工具，避免因拆机而导致的意外，进而极大的提升了锂电池充放电设备组件升级的便捷性以及稳定性，并极大的降低了锂电池充放电设备组件升级成本；由于针对各组件类型的组件分别生成对应的通信协议，保证各组件均能正常进行升级，进而极大的提升了锂电池充放电设备组件升级的兼容性；在升级失败时，先基于故障代码匹配对应的故障修复包执行故障修复操作，若还失败，则对组件的电源进行复位，以应对大部分升级失败的情况，相对于传统上直接寄回原厂，进一步保障了升级稳定性，并降低升级成本。附图说明下面参照附图结合实施例对本发明作进一步的说明。图1是本发明一种锂电池充放电设备组件升级方法的流程图。图2是本发明的硬件架构图。具体实施方式本申请实施例中的技术方案，总体思路如下：中位机通过升级配置表获取组件类型进而生成对应的通信协议，再基于通信协议创建业务子线程以将升级数据包发送给对应的组件执行升级操作，无需进行拆机升级，无需专用的升级工具；针对各组件类型的组件分别生成对应的通信协议，保证各组件均能正常进行升级；在升级失败时，先尝试通过故障修复包执行故障修复操作，再尝试对组件的电源进行复位，以应对大部分升级失败的情况，以提升锂电池充放电设备组件升级的便捷性、稳定性以及兼容性，降低升级成本。请参照图1至图2所示，本发明一种锂电池充放电设备组件升级方法的较佳实施例，包括如下步骤：步骤S10、中位机创建一升级进程，获取升级配置表以及升级数据包；步骤S20、中位机通过所述升级进程解析升级配置表得到本次升级业务的组件信息以及组件类型，基于所述组件类型为本次升级业务的各组件生成对应的通信协议；步骤S30、中位机基于所述通信协议以组件为单位分别创建一业务子线程，通过所述业务子线程将升级数据包按通信协议封装后发送给对应的组件；中位机与组件通过以太网进行通信；步骤S40、各组件基于接收的所述升级数据包执行升级操作，并向中位机反馈升级结果；各组件均设有DSP和MCU，对组件执行升级操作，即对组件的DSP和MCU执行升级操作；步骤S50、中位机基于接收的所述升级结果向上位机发送升级完成的通知，或者执行故障修复操作。所述步骤S10具体为：中位机创建一升级进程，通过所述升级进程从预设路径获取升级配置表以及升级数据包；所述升级对象表至少包括组件信息以及组件类型；所述组件信息至少包括IP地址、端口以及通道。所述步骤S20具体为：中位机预先存储一XML格式的协议模板，所述协议模板存储有各组件类型对应的协议参数；中位机通过所述升级进程解析升级配置表得到本次升级业务的组件信息以及组件类型，基于所述组件类型从协议模板匹配映射对应的协议参数，基于所述协议参数为本次升级业务的各组件生成对应的XML格式的通信协议，并将所述通信协议存储至存储器中。所述协议参数至少包括协议类型、校验方法、发送内容、接收内容以及内容项目。所述步骤S30具体包括：步骤S31、中位机基于所述通信协议为各组件分别创建一业务子线程，通过所述业务子线程以及升级配置表向各待升级的组件发送启动升级指令；步骤S32、中位机判断预设时长内是否接收到各组件反馈的允许升级应答，若是，则进入步骤S33；若否，则结束流程；步骤S33、中位机通过所述业务子线程以及升级配置表，将升级数据包按预设大小分批循环发送给对应的组件，直至完成所述升级数据包的发送。通过将所述升级数据包分批发送，当某个批次发送失败时，直接重新发送对应批次的数据即可，不用重新发送整个所述升级数据包，进而极大的提升了所述升级数据包的传输效率。所述步骤S40具体为：各组件解析接收的所述升级数据包，基于所述升级数据包实时执行升级操作，并向中位机实时反馈升级进度以及升级结果；所述升级结果为升级成功或者升级失败；升级失败的所述升级结果携带故障代码。所述步骤S50具体包括：步骤S51、中位机接收组件反馈的所述升级结果，解析所述升级结果，若为升级成功，则进入步骤S52；若为升级失败，则进入步骤S53；步骤S52、中位机向上位机发送升级完成的通知，依次退出所述业务子线程以及升级进程；步骤S53、中位机基于所述升级结果携带的故障代码，从存储器中匹配预先存储的故障修复包，并将所述故障修复包通过业务子线程发送给对应的组件执行故障修复操作，并接收组件反馈的升级结果，判断升级是否成功，若是，则进入步骤S52；若否，则进入步骤S54；步骤S54、中位机对升级失败的组件进行电源的复位，重新执行升级操作，并接收组件反馈的升级结果，判断升级是否成功，若是，则进入步骤S52；若否，则向上位机发送升级失败的通知，依次退出所述业务子线程以及升级进程。在升级失败时，先尝试通过故障修复包执行故障修复操作，再尝试对组件的电源进行复位，以应对大部分升级失败的情况，极大的降低了组件返厂的概率。还包括：步骤S60、在锂电池充放电设备新增组件时，基于组件的组件类型修改对应的协议参数，以生成对应的通信协议，进而与已有的通信协议进行协议隔离，保障新旧组件不会冲突，即实现向后兼容的升级协议。综上所述，本发明的优点在于：通过在中位机创建升级进程，通过升级进程获取升级配置表以及升级数据包，通过升级配置表获取组件类型进而生成对应的通信协议，再基于通信协议创建业务子线程以将升级数据包发送给对应的组件执行升级操作，无需像传统上进行拆机升级，也无需专用的升级工具，避免因拆机而导致的意外，进而极大的提升了锂电池充放电设备组件升级的便捷性以及稳定性，并极大的降低了锂电池充放电设备组件升级成本；由于针对各组件类型的组件分别生成对应的通信协议，保证各组件均能正常进行升级，进而极大的提升了锂电池充放电设备组件升级的兼容性；在升级失败时，先基于故障代码匹配对应的故障修复包执行故障修复操作，若还失败，则对组件的电源进行复位，以应对大部分升级失败的情况，相对于传统上直接寄回原厂，进一步保障了升级稳定性，并降低升级成本。虽然以上描述了本发明的具体实施方式，但是熟悉本技术领域的技术人员应当理解，我们所描述的具体的实施例只是说明性的，而不是用于对本发明的范围的限定，熟悉本领域的技术人员在依照本发明的精神所作的等效的修饰以及变化，都应当涵盖在本发明的权利要求所保护的范围内。
