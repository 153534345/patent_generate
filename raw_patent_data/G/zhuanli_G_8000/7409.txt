标题title
一种基于BIM与GIS的建筑环境智能分析方法
摘要abst
本发明公开了一种基于BIM与GIS的建筑环境智能分析方法，该方法包括以下步骤：S1、获取城市基础地理信息数据，构建地理信息系统模型；S2、获取建筑结构信息数据，构建建筑信息模型；S3、将建筑信息模型合并至地理信息系统模型，并进行配准，生成建筑地理信息模型；S4、获取格点化城市气象数据，并导入建筑地理信息模型；S5、对建筑地理信息模型进行简化，并根据待分析建筑实际地理位置进行分割；S6、对区域建筑模型的建筑环境进行采集获取及模拟分析；S7、根据模拟分析结果，构建分析模型。通过对建筑环境有关的相关数据进行组合建模，有效避免了模拟环境下出现的无效或偏差数据，便于对建筑环境实现全面精确地分析。
权利要求书clms
1.一种基于BIM与GIS的建筑环境智能分析方法，其特征在于，该方法包括以下步骤：S1、获取城市基础地理信息数据，构建地理信息系统模型；S2、获取建筑结构信息数据，构建建筑信息模型；S3、将所述建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型；S4、获取格点化城市气象数据，并导入所述建筑地理信息模型；S5、对所述建筑地理信息模型进行简化，并根据待分析建筑实际地理位置进行分割，划分为区域建筑模型；S6、对所述区域建筑模型的建筑环境进行采集获取及模拟分析；S7、根据所述模拟分析结果，构建分析模型，并输出分析结果。2.根据权利要求1所述的一种基于BIM与GIS的建筑环境智能分析方法，其特征在于，所述将所述建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型，包括以下步骤：S31、提取所述建筑信息模型的纹理信息并进行精简；S32、将所述建筑信息模型网格化成所述地理信息系统模型；S33、利用八叉树原理对转换后的所述地理信息系统模型进行优化；S34、将所述纹理信息映射到所述地理信息系统模型的三角平面上；S35、分别提取所述建筑信息模型与所述地理信息系统模型的特征点，分别形成两组特征点集合，并进行多个特征点之间的二次曲面拟合及曲率计算；S36、将两组特征点集合进行初步匹配，建立所述建筑信息模型与所述地理信息系统模型之间的点对关系；S37、对初步匹配后的特征点进行精准匹配，形成建筑地理信息模型。3.根据权利要求2所述的一种基于BIM与GIS的建筑环境智能分析方法，其特征在于，所述特征点包括所述建筑信息模型与所述地理信息系统模型内的任一网格点以及任一网格点为中心的多个领域网格点；所述多个特征点之间的二次曲面拟合及曲率计算的计算步骤为：；；其中，x，y，z分别表示所述建筑信息模型与所述地理信息系统模型内的任一网格点的横坐标、纵坐标及竖坐标，a1，a2，a3，a4，a5，a6均表示参数并通过多个网格点计算得出，k表示网格点的曲率。4.根据权利要求3所述的一种基于BIM与GIS的建筑环境智能分析方法，其特征在于，所述对所述建筑地理信息模型进行简化，并根据待分析建筑实际地理位置进行分割，划分为区域建筑模型，包括以下步骤：S51、合并所述建筑地理信息模型内共面属性相同的面，并采用三角剖分算法进行最简剖分；S52、将各网格点形成的三角格网集合进行聚合，得到新的建筑地理信息模型；S53、采用八叉树区域划分法，对待检测分析的局部建筑模型进行划分并保存到子区域中；S54、对所述局部建筑模型进行碰撞检测，生成区域建筑模型。5.根据权利要求3所述的一种基于BIM与GIS的建筑环境智能分析方法，其特征在于，所述对所述区域建筑模型的建筑环境进行采集获取及模拟分析，包括以下步骤：S61、根据城市日照数据，对所述区域建筑模型进行仿真，构建建筑采光模型；S611、采集近一年内所在城市的太阳辐射数据，形成日照数据库；S612、将所述区域建筑模型导入采光分析软件，根据所述日照数据库进行三维仿真，构建建筑采光模型；S613、进行建筑的光环境分析，输出采光分析结果；S62、对所述区域建筑模型进行风环境的模拟计算；S621、将所述区域建筑模型导入环境系统分析软件；S622、根据所述区域建筑模型的高度计算不同参数下的风速比，获取风环境分析结果，计算公式为：；其中，Ri表示建筑物之间的风速比值，H表示建筑高度，L表示建筑长度，W表示建筑宽度，D表示建筑物之间的距离。6.根据权利要求3所述的一种基于BIM与GIS的建筑环境智能分析方法，其特征在于，所述根据所述模拟分析结果，构建分析模型，并输出分析结果，包括以下步骤：S71、获取模拟分析结果，通过计算加权移动平均值确定相关范围；S72、根据范围进行数据筛选，建立判断数据趋势的曲线模型；S73、根据曲线计算弹性变化值，并计算变化弹性范围；S74、根据变换弹性范围判断数据模拟后的分析数据；S75、计算模拟数据的滞后情况，输出最终的模拟数据。7.根据权利要求6所述的一种基于BIM与GIS的建筑环境智能分析方法，其特征在于，所述通过计算加权移动平均值的计算公式为：；其中，Q表示加权移动平均值，n表示输入的数据数量，Qn表示输入的数据；所述弹性变化值的计算公式为：；其中，T表示弹性变化值，Q表示加权移动平均值，i表示差值区间的两个端点值的平均值。8.一种建筑物全景图像建模方法，使用权利要求1-7中任意一项所述的建筑环境智能分析方法，其特征在于，包括以下步骤：步骤a，将建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型，打开所述建筑地理信息模型所对应的地理信息系统地图，根据配准后的位置信息打开该位置的地理信息系统地图，选定当前路段的起点和终点，并对该路段进行格式化命名；步骤b，载入所述建筑物处的全景视频，与所述地理信息系统地图关联并设置参数，选择指定的所述全景视频的起始位置与选择的地理信息系统模型的对应的所述路段的起始点关联，设定全景视频起始帧的视角方向，之后以同样的步骤定位所述全景视频结束位置与选定的所述地理信息系统模型的所述路段的终点关联，保存编辑记录；步骤c，通过关系数据模型表达并存储步骤b中所编辑的地理信息系统模型的数据空间位置与所述全景视频的关系，编辑关联工作完成以后，将所述的地理信息系统模型的数据空间位置与所述全景视频的关系存储到数据库中；步骤d，通过以下方式调取全景图像信息，载入编辑过的所述路段的视频信息，选择与视频关联的地理信息系统模型的该路段，根据选定的路段上选定点计算出与路段起始点的距离，通过查询数据库载入关联的全景视频，初始化视频的起始和结束时序位置，起始视点位置，通过输入设备变换全景视频视点位置，浏览视频中任意角度的景物。9.根据权利要求8所述的建筑物全景图像建模方法，其特征在于，在进行所述全景视频拍摄时，拍摄一张模板图像，所述图像中包括了多条经过全景相机投影的直线，在图像平面成二次曲线像，根据系统中设定的投影模型计算所述直线在所述模板图像上的对应二次曲线的解析模型，计算线簇中每条直线在图像上对应的二次曲线的数学表达式，根据线簇的表达式和垂直约束优化全景相机内参。10.根据权利要求9所述的建筑物全景图像建模方法，其特征在于，根据以下方式对所述全景相机拍摄到的图像进行拼接，实时获取当前的建筑物的全景图像及当前的建筑地理信息模型的GPS信息，根据所述GPS信息将当前的全景图像与已拼接的全景图像进行匹配处理，根据匹配结果对当前的全景相机的参数进行标定，根据光束平差法优化全景相机参数，根据优化后的相机参数对所述全景图像进行映射处理，将映射后的全景图像进行融合拼接处理。
说明书desc
技术领域本发明涉及建筑环境分析领域，具体来说，涉及一种基于BIM与GIS的建筑环境智能分析方法。背景技术BIM模型是由充足信息构成以支持新产品开发管理，并可由计算机应用程序直接解释的建筑或建筑工程信息模型，即数字技术支撑的对建筑环境的生命周期管理。BIM模型的核心是通过建立虚拟的建筑工程三维模型，利用数字化技术，为这个模型提供完整的、与实际情况一致的建筑工程信息库。该信息库不仅包含描述建筑物构件的几何信息、专业属性及状态信息，还包含了非构件对象的状态信息。GIS模型作为空间决策支持系统，对应用模型分析、模拟能力的依赖表现得越来越明显。GIS模型是通过适当筛选，将系统各要素用一定的表现规则所描写出来的简明映像，是对现实世界的简化表达，模型通常表达了某个系统的发展过程或结果。地学模型是用来描述地理系统各要素之间相互关系和规律的语言的、数学的或其他的表达形式。建筑环境是指任何建筑物都不是孤立存在的，它存在于各种自然的、人为的环境之中，人们建造建筑物的目的就在于为人们的社会、经济、政治和文化等活动提供理想的场所。建筑物与周围环境密切相关，周围环境对于建筑物而言既是一种制约条件又是一种促进因数。因此，人们必须认真考虑建筑物周围的环境所能发挥的作用。而影响建筑物内的热湿环境、空气品质环境、光环境和声环境的扰量很多，同前述热湿环境分析相同，都可以把它们分为内扰和外扰。在进行建筑环境的综合分析时，不仅要考虑内扰、外扰对建筑内环境的作用力，同时还应考虑建筑内环境的建设也会对建筑外环境施加一个反作用力，从而影响甚至破坏外环境，建筑内外环境之间既相互促进又相互干扰，因此建筑环境的综合评价不仅应该考虑建筑内环境各因素对人们的影响，还应考虑由于建筑环境的建设对建筑外环境、自然环境的影响和作用。如今通过BIM与GIS模型的运用，能够将建筑及建筑群构建成三维模型，并在各种仿真模拟软件的作用下，进行定向的精确的模拟仿真，来实现具体环境的变化对建筑本身所造成的影响，从而大大提高了建筑自身的安全性、可靠性。但在具体的三维场景环境下，近距离观察、漫游时，需要切换到BIM模型，在城市级或全球三维场景时，需要切换的BIM模型众多，迫切需要能够粗安置、精配准的方法，以保证BIM模型安置后，与原有GIS模型的场景位置、方位协调不冲突，这就需要将BIM模型和GIS模型进行配准。目前，针对BIM模型和GIS模型进行合并及配准的需求，基本由人工完成，效率较慢，配准的准确率也较低；另外，由于BIM模型中的数据量和GIS模型中的数据量非常大，采用人工安置的方法几乎无法实现。而另外再配置环境模拟仿真则需要增加更大的运算量，影响建筑环境分析的效率，并且现有的软件也没有提供相应配套的应用，导致每次计算的时间变得很长，历史经验数据也无法得到充分的利用。针对相关技术中的问题，目前尚未提出有效的解决方案。发明内容针对相关技术中的问题，本发明提出一种基于BIM与GIS的建筑环境智能分析方法，以克服现有相关技术所存在的上述技术问题。为此，本发明采用的具体技术方案如下：一种基于BIM与GIS的建筑环境智能分析方法，该方法包括以下步骤：S1、获取城市基础地理信息数据，构建地理信息系统模型；S2、获取建筑结构信息数据，构建建筑信息模型；S3、将所述建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型；S4、获取格点化城市气象数据，并导入所述建筑地理信息模型；S5、对所述建筑地理信息模型进行简化，并根据待分析建筑实际地理位置进行分割，划分为区域建筑模型；S6、对所述区域建筑模型的建筑环境进行采集获取及模拟分析；S7、根据所述模拟分析结果，构建分析模型，并输出分析结果。进一步的，所述将所述建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型，包括以下步骤：S31、提取所述建筑信息模型的纹理信息并进行精简；S32、将所述建筑信息模型网格化成所述地理信息系统模型；S33、利用八叉树原理对转换后的所述地理信息系统模型进行优化；S34、将所述纹理信息映射到所述地理信息系统模型的三角平面上；S35、分别提取所述建筑信息模型与所述地理信息系统模型的特征点，分别形成两组特征点集合，并进行多个特征点之间的二次曲面拟合及曲率计算；S36、将两组特征点集合进行初步匹配，建立所述建筑信息模型与所述地理信息系统模型之间的点对关系；S37、对初步匹配后的特征点进行精准匹配，形成建筑地理信息模型。进一步的，所述特征点包括所述建筑信息模型与所述地理信息系统模型内的任一网格点以及任一网格点为中心的多个领域网格点；所述多个特征点之间的二次曲面拟合及曲率计算的计算步骤为：；；其中，x，y，z分别表示所述建筑信息模型与所述地理信息系统模型内的任一网格点的横坐标、纵坐标及竖坐标，a1，a2，a3，a4，a5，a6均表示参数并通过多个网格点计算得出，k表示网格点的曲率。进一步的，所述对所述建筑地理信息模型进行简化，并根据待分析建筑实际地理位置进行分割，划分为区域建筑模型，包括以下步骤：S51、合并所述建筑地理信息模型内共面属性相同的面，并采用三角剖分算法进行最简剖分；S52、将各网格点形成的三角格网集合进行聚合，得到新的建筑地理信息模型；S53、采用八叉树区域划分法，对待检测分析的局部建筑模型进行划分并保存到子区域中；S54、对所述局部建筑模型进行碰撞检测，生成区域建筑模型。进一步的，所述对所述区域建筑模型的建筑环境进行采集获取及模拟分析，包括以下步骤：S61、根据城市日照数据，对所述区域建筑模型进行仿真，构建建筑采光模型；S62、对所述区域建筑模型进行风环境的模拟计算。进一步的，所述根据城市日照数据，对所述区域建筑模型进行仿真，构建建筑采光模型，包括以下步骤：S611、采集近一年内所在城市的太阳辐射数据，形成日照数据库；S612、将所述区域建筑模型导入采光分析软件，根据所述日照数据库进行三维仿真，构建建筑采光模型；S613、进行建筑的光环境分析，输出采光分析结果。进一步的，所述对所述区域建筑模型进行风环境的模拟计算，包括以下步骤：S621、将所述区域建筑模型导入环境系统分析软件；S622、根据所述区域建筑模型的高度计算不同参数下的风速比，获取风环境分析结果，计算公式为：；其中，Ri表示建筑物之间的风速比值，H表示建筑高度，L表示建筑长度，W表示建筑宽度，D表示建筑物之间的距离。进一步的，所述根据所述模拟分析结果，构建分析模型，并输出分析结果，包括以下步骤：S71、获取模拟分析结果，通过计算加权移动平均值确定相关范围；S72、根据范围进行数据筛选，建立判断数据趋势的曲线模型；S73、根据曲线计算弹性变化值，并计算变化弹性范围；S74、根据变换弹性范围判断数据模拟后的分析数据；S75、计算模拟数据的滞后情况，输出最终的模拟数据。进一步的，所述通过计算加权移动平均值的计算公式为：；其中，Q表示加权移动平均值，n表示输入的数据数量，Qn表示输入的数据。进一步的，所述弹性变化值的计算公式为：;其中，T表示弹性变化值，Q表示加权移动平均值，i表示差值区间的两个端点值的平均值。本发明的有益效果为：通过对BIM与GIS之间的转换与配准，实现了两个模型之间的自动精准匹配，从而保证了BIM与GIS模型中场景、方位的协调统一，即保证了建筑及建筑群与城市地理信息位置之间统一性与位置的精确性，减轻人工干预强度，保证效率，提高自动智能化；再通过将格点化气象数据与三维建筑模型的结合，能够实现各区域建筑气象的精确预报与监测，有利于进行建筑环境的综合评估与模拟，大大提高三维建筑模型的真实有效性。通过将转换配准完毕后的三维模型进行简化分割，能够大大降低三维模型本身的资源占用，降低系统处理的难度与复杂程度，从而提高单个建筑或建筑群环境模拟与仿真的效率，减少计算时间。最终通过对建筑环境有关的相关数据进行组合建模，有效避免了模拟环境下出现的无效或偏差数据，大大提高了分析模型的准确性，便于对建筑环境实现全面精确地分析，实现精确掌握监测。一种建筑物全景图像建模方法，使用上述的建筑环境智能分析方法，包括以下步骤：步骤a，将建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型，打开所述建筑地理信息模型所对应的地理信息系统地图，根据配准后的位置信息打开该位置的地理信息系统地图，选定当前路段的起点和终点，并对该路段进行格式化命名；步骤b，载入所述建筑物处的全景视频，与所述地理信息系统地图关联并设置参数，选择指定的所述全景视频的起始位置与选择的地理信息系统模型的对应的所述路段的起始点关联，设定全景视频起始帧的视角方向，之后以同样的步骤定位所述全景视频结束位置与选定的所述地理信息系统模型的所述路段的终点关联，保存编辑记录；步骤c，通过关系数据模型表达并存储步骤b中所编辑的地理信息系统模型的数据空间位置与所述全景视频的关系，编辑关联工作完成以后，将所述的地理信息系统模型的数据空间位置与所述全景视频的关系存储到数据库中；步骤d，通过以下方式调取全景图像信息，载入编辑过的所述路段的视频信息，选择与视频关联的地理信息系统模型的该路段，根据选定的路段上选定点计算出与路段起始点的距离，通过查询数据库载入关联的全景视频，初始化视频的起始和结束时序位置，起始视点位置，通过输入设备变换全景视频视点位置，浏览视频中任意角度的景物。进一步的，在进行所述全景视频拍摄时，拍摄一张模板图像，所述图像中包括了多条经过全景相机投影的直线，在图像平面成二次曲线像，根据系统中设定的投影模型计算所述直线在所述模板图像上的对应二次曲线的解析模型，计算线簇中每条直线在图像上对应的二次曲线的数学表达式，根据线簇的表达式和垂直约束优化全景相机内参。进一步的，根据以下方式对所述全景相机拍摄到的图像进行拼接，实时获取当前的建筑物的全景图像及当前的建筑地理信息模型的GPS信息，根据所述GPS信息将当前的全景图像与已拼接的全景图像进行匹配处理，根据匹配结果对当前的全景相机的参数进行标定，根据光束平差法优化全景相机参数，根据优化后的相机参数对所述全景图像进行映射处理，将映射后的全景图像进行融合拼接处理。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是根据本发明实施例的一种基于BIM与GIS的建筑环境智能分析方法的流程图。具体实施方式根据本发明的实施例，提供了一种基于BIM与GIS的建筑环境智能分析方法。现结合附图和具体实施方式对本发明进一步说明，如图1所示，根据本发明实施例的基于BIM与GIS的建筑环境智能分析方法，该方法包括以下步骤：S1、获取城市基础地理信息数据，构建地理信息系统模型；S2、获取建筑结构信息数据，构建建筑信息模型；S3、将所述建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型；其中，步骤S3包括以下步骤：S31、提取所述建筑信息模型的纹理信息并进行精简；S32、将所述建筑信息模型网格化成所述地理信息系统模型；S33、利用八叉树原理对转换后的所述地理信息系统模型进行优化；S34、将所述纹理信息映射到所述地理信息系统模型的三角平面上；S35、分别提取所述建筑信息模型与所述地理信息系统模型的特征点，分别形成两组特征点集合，并进行多个特征点之间的二次曲面拟合及曲率计算；S36、将两组特征点集合进行初步匹配，建立所述建筑信息模型与所述地理信息系统模型之间的点对关系；S37、对初步匹配后的特征点进行精准匹配，形成建筑地理信息模型。其中，所述特征点包括所述建筑信息模型与所述地理信息系统模型内的任一网格点以及任一网格点为中心的多个领域网格点；所述多个特征点之间的二次曲面拟合及曲率计算的计算步骤为：；；其中，x，y，z分别表示所述建筑信息模型与所述地理信息系统模型内的任一网格点的横坐标、纵坐标及竖坐标，a1，a2，a3，a4，a5，a6均表示参数并通过多个网格点计算得出，k表示网格点的曲率。S4、获取格点化城市气象数据，并导入所述建筑地理信息模型；S5、对所述建筑地理信息模型进行简化，并根据待分析建筑实际地理位置进行分割，划分为区域建筑模型；其中，步骤S5包括以下步骤：S51、合并所述建筑地理信息模型内共面属性相同的面，并采用三角剖分算法进行最简剖分；S52、将各网格点形成的三角格网集合进行聚合，得到新的建筑地理信息模型；S53、采用八叉树区域划分法，对待检测分析的局部建筑模型进行划分并保存到子区域中；S54、对所述局部建筑模型进行碰撞检测，生成区域建筑模型。S6、对所述区域建筑模型的建筑环境进行采集获取及模拟分析；其中，步骤S6包括以下步骤：S61、根据城市日照数据，对所述区域建筑模型进行仿真，构建建筑采光模型；所述根据城市日照数据，对所述区域建筑模型进行仿真，构建建筑采光模型，包括以下步骤：S611、采集近一年内所在城市的太阳辐射数据，形成日照数据库；S612、将所述区域建筑模型导入采光分析软件，根据所述日照数据库进行三维仿真，构建建筑采光模型；S613、进行建筑的光环境分析，输出采光分析结果。S62、对所述区域建筑模型进行风环境的模拟计算。所述对所述区域建筑模型进行风环境的模拟计算，包括以下步骤：S621、将所述区域建筑模型导入环境系统分析软件；S622、根据所述区域建筑模型的高度计算不同参数下的风速比，获取风环境分析结果，计算公式为：；其中，Ri表示建筑物之间的风速比值，H表示建筑高度，L表示建筑长度，W表示建筑宽度，D表示建筑物之间的距离。S7、根据所述模拟分析结果，构建分析模型，并输出分析结果。其中，步骤S7包括以下步骤：S71、获取模拟分析结果，通过计算加权移动平均值确定相关范围；所述通过计算加权移动平均值的计算公式为：；其中，Q表示加权移动平均值，n表示输入的数据数量，Qn表示输入的数据。S72、根据范围进行数据筛选，建立判断数据趋势的曲线模型；S73、根据曲线计算弹性变化值，并计算变化弹性范围；其中，所述弹性变化值的计算公式为：;其中，T表示弹性变化值，Q表示加权移动平均值，i表示差值区间的两个端点值的平均值。根据确定的弹性变化值T，对每一个差值区间划定弹性的波动范围，即得到的数据在弹性变化值T上浮动，即在Q±H的数值之间上下浮动，从而确定后续模拟数据的波动范围，避免后续模拟过程出现不合理的数据。S74、根据变换弹性范围判断数据模拟后的分析数据；S75、计算模拟数据的滞后情况，输出最终的模拟数据。综上所述，借助于本发明的上述技术方案，通过对BIM与GIS之间的转换与配准，实现了两个模型之间的自动精准匹配，从而保证了BIM与GIS模型中场景、方位的协调统一，即保证了建筑及建筑群与城市地理信息位置之间统一性与位置的精确性，减轻人工干预强度，保证效率，提高自动智能化；再通过将格点化气象数据与三维建筑模型的结合，能够实现各区域建筑气象的精确预报与监测，有利于进行建筑环境的综合评估与模拟，大大提高三维建筑模型的真实有效性。通过将转换配准完毕后的三维模型进行简化分割，能够大大降低三维模型本身的资源占用，降低系统处理的难度与复杂程度，从而提高单个建筑或建筑群环境模拟与仿真的效率，减少计算时间。最终通过对建筑环境有关的相关数据进行组合建模，有效避免了模拟环境下出现的无效或偏差数据，大大提高了分析模型的准确性，便于对建筑环境实现全面精确地分析，实现精确掌握监测。一种建筑物全景图像建模方法，使用上述的建筑环境智能分析方法，包括以下步骤：步骤a，将建筑信息模型合并至所述地理信息系统模型，并进行配准，生成建筑地理信息模型，打开所述建筑地理信息模型所对应的地理信息系统地图，根据配准后的位置信息打开该位置的地理信息系统地图，选定当前路段的起点和终点，并对该路段进行格式化命名；步骤b，载入所述建筑物处的全景视频，与所述地理信息系统地图关联并设置参数，选择指定的所述全景视频的起始位置与选择的地理信息系统模型的对应的所述路段的起始点关联，设定全景视频起始帧的视角方向，之后以同样的步骤定位所述全景视频结束位置与选定的所述地理信息系统模型的所述路段的终点关联，保存编辑记录；步骤c，通过关系数据模型表达并存储步骤b中所编辑的地理信息系统模型的数据空间位置与所述全景视频的关系，编辑关联工作完成以后，将所述的地理信息系统模型的数据空间位置与所述全景视频的关系存储到数据库中；步骤d，通过以下方式调取全景图像信息，载入编辑过的所述路段的视频信息，选择与视频关联的地理信息系统模型的该路段，根据选定的路段上选定点计算出与路段起始点的距离，通过查询数据库载入关联的全景视频，初始化视频的起始和结束时序位置，起始视点位置，通过输入设备变换全景视频视点位置，浏览视频中任意角度的景物。进一步的，在进行所述全景视频拍摄时，拍摄一张模板图像，所述图像中包括了多条经过全景相机投影的直线，在图像平面成二次曲线像，根据系统中设定的投影模型计算所述直线在所述模板图像上的对应二次曲线的解析模型，计算线簇中每条直线在图像上对应的二次曲线的数学表达式，根据线簇的表达式和垂直约束优化全景相机内参。进一步的，根据以下方式对所述全景相机拍摄到的图像进行拼接，实时获取当前的建筑物的全景图像及当前的建筑地理信息模型的GPS信息，根据所述GPS信息将当前的全景图像与已拼接的全景图像进行匹配处理，根据匹配结果对当前的全景相机的参数进行标定，根据光束平差法优化全景相机参数，根据优化后的相机参数对所述全景图像进行映射处理，将映射后的全景图像进行融合拼接处理。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
