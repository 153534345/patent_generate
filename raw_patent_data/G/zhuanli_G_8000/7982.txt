标题title
一种适用于芯片电路板的生产质量检测方法
摘要abst
本发明涉及图像处理技术领域，具体涉及一种适用于芯片电路板的生产质量检测方法。该方法获得焊点图像的灰度直方图，根据灰度直方图中灰度级的分布及对应的频数获得多个灰度级类别。根据灰度级类别对应的梯度直方图获得参考梯度，在参考梯度对应的像素点中筛选出边缘点，进而获得边缘线围成的区域，获得该区域的最小外接正方形，以最小的最小外接正方形的尺寸作为参考尺寸对焊点图像进行超像素分割，根据分割后超像素块的平均像素值检测出缺陷超像素块。本发明通过自适应获取超像素块的尺寸对芯片电路板中的焊点图像进行分割，实现了准确的质量检测。
权利要求书clms
1.一种适用于芯片电路板的生产质量检测方法，其特征在于，所述方法包括：获得芯片电路板的焊点图像；获得所述焊点图像的灰度直方图；将所述灰度直方图中具有连续性的灰度级作为可分类灰度级；根据所述可分类灰度级与相邻灰度级之间的第一频数差异获得分组指标，若所述分组指标大于预设指标阈值则将所述可分类灰度级与其相邻灰度级分为一类，获得多个灰度级类别；获得每个所述灰度级类别对应的像素点的梯度直方图；根据所述梯度直方图中的梯度值和第二频数选取参考梯度；以所述灰度级类别的参考梯度对应的像素点作为待检测点；获得待检测点邻域范围内与所述待检测点为同一所述灰度级类别的其他像素点的梯度分布，根据所述梯度分布在所述待检测点中筛选出边缘点，所述边缘点构成边缘线；获取所述焊点图像中每条所述边缘线围成的区域的最小外接正方形，以最小的最小外接正方形的尺寸作为参考尺寸；根据所述参考尺寸对所述焊点图像进行超像素分割，获得多个超像素块；根据每个超像素块内的平均像素值筛选出缺陷超像素块；根据所述缺陷超像素块的位置和数量获得缺陷位置和缺陷程度。2.根据权利要求1所述的一种适用于芯片电路板的生产质量检测方法，其特征在于，所述获得芯片电路板的焊点图像包括：采集芯片电路板的表面图像，将所述表面图像输入预先训练好的焊点区域分割网络中，获得所述焊点图像。3.根据权利要求1所述的一种适用于芯片电路板的生产质量检测方法，其特征在于，所述将所述灰度直方图中具有连续性的灰度级作为可分类灰度级包括：获得所述灰度直方图中每个所述灰度级对应柱体的预设邻域范围内其他柱体的柱体数量；若所述柱体数量大于预设柱体数量阈值，则认为对应的所述灰度级具有连续性。4.根据权利要求3所述的一种适用于芯片电路板的生产质量检测方法，其特征在于，所述根据所述可分类灰度级与相邻灰度级之间的第一频数差异获得分组指标包括：根据分组指标公式获得所述分组指标，所述分组指标公式包括：其中，为所述分组指标，为以自然常数为底的指数函数，为第个灰度级对应的第一频数，为所述相邻灰度级对应的第一频数，为所述柱体数量。5.根据权利要求1所述的一种适用于芯片电路板的生产质量检测方法，其特征在于，所述根据所述梯度直方图中的梯度值和第二频数选取参考梯度包括：统计所述梯度直方图中所有存在所述第二频数的梯度级，获得平均梯度；统计所述梯度直方图中所有存在的所述第二频数，获得平均频数；以梯度级大于所述平均梯度且第二频数小于所述平均频数的梯度级作为所述参考梯度。6.根据权利要求1所述的一种适用于芯片电路板的生产质量检测方法，其特征在于，所述获得待检测点邻域范围内与所述待检测点为同一所述灰度级类别的其他像素点的梯度分布，根据所述梯度分布在所述待检测点中筛选出边缘点包括：统计所述待检测点邻域范围内所有过所述待检测点的直线；若所述直线上存在一点与所述待检测点的梯度差异小于预设梯度阈值，且该点与所述待检测点为同一所述灰度级类别，则认为该点是所述待检测点的梯度相似点；统计每个所述直线上的所述梯度相似点的数量，若所述梯度相似点的数量大于预设数量阈值，则认为对应的所述直线为小段边缘线；若所述待检测点邻域范围内存在所述小段边缘线，则认为所述待检测点为所述边缘点。7.根据权利要求1所述的一种适用于芯片电路板的生产质量检测方法，其特征在于，所述根据每个超像素块内的平均像素值筛选出缺陷超像素块包括：以所述平均像素值最小的K个所述超像素块作为所述缺陷超像素块，K为正整数。
说明书desc
技术领域本发明涉及图像处理技术领域，具体涉及一种适用于芯片电路板的生产质量检测方法。背景技术电子烟的核心部件为其中的芯片电路板，在芯片电路板的生产过程中包含多种工艺，其中焊接工艺需要将LED灯、开关、电池等电子元器件焊接到电路板中。在焊接过程中会因为焊接工艺和环境的影响，导致出现焊接缺陷，其中波峰焊锡洞缺陷会导致元器件与电路板焊接不彻底，从而形成断路或者短路的隐患，影响电子烟芯片质量，因此在芯片的生产过程对于焊接缺陷的检测必不可少。因为焊接缺陷位置与正常焊接位置存在较大的视觉差异，因此可通过计算机视觉技术提取图像的特征，根据图像特征将正常焊接区域和缺陷焊接区域分割出来。在现有技术中常用的分割方法为超像素分割方法，超像素分割方法需要预先设置分割区域的尺寸，无法做到对不同图像进行自适应的调整分割参数，导致分割效果参差不齐，影响了对焊接质量的检测和评估。发明内容为了解决上述技术问题，本发明的目的在于提供一种适用于芯片电路板的生产质量检测方法，所采用的技术方案具体如下：本发明提出了一种适用于芯片电路板的生产质量检测方法，所述方法包括：获得芯片电路板的焊点图像；获得所述焊点图像的灰度直方图；将所述灰度直方图中具有连续性的灰度级作为可分类灰度级；根据所述可分类灰度级与相邻灰度级之间的第一频数差异获得分组指标，若所述分组指标大于预设指标阈值则将所述可分类灰度级与其相邻灰度级分为一类，获得多个灰度级类别；获得每个所述灰度级类别对应的像素点的梯度直方图；根据所述梯度直方图中的梯度值和第二频数选取参考梯度；以所述灰度级类别的参考梯度对应的像素点作为待检测点；获得待检测点邻域范围内与所述待检测点为同一所述灰度级类别的其他像素点的梯度分布，根据所述梯度分布在所述待检测点中筛选出边缘点，所述边缘点构成边缘线；获取所述焊点图像中每条所述边缘线围成的区域的最小外接正方形，以最小的最小外接正方形的尺寸作为参考尺寸；根据所述参考尺寸对所述焊点图像进行超像素分割，获得多个超像素块；根据每个超像素块内的平均像素值筛选出缺陷超像素块；根据所述缺陷超像素块的位置和数量获得缺陷位置和缺陷程度。进一步地，所述获得芯片电路板的焊点图像包括：采集芯片电路板的表面图像，将所述表面图像输入预先训练好的焊点区域分割网络中，获得所述焊点图像。进一步地，所述将所述灰度直方图中具有连续性的灰度级作为可分类灰度级包括：获得所述灰度直方图中每个所述灰度级对应柱体的预设邻域范围内其他柱体的柱体数量；若所述柱体数量大于预设柱体数量阈值，则认为对应的所述灰度级具有连续性。进一步地，所述根据所述可分类灰度级与相邻灰度级之间的第一频数差异获得分组指标包括：根据分组指标公式获得所述分组指标，所述分组指标公式包括：其中，为所述分组指标，为以自然常数为底的指数函数，为第个灰度级对应的第一频数，为所述相邻灰度级对应的第一频数，为所述柱体数量。进一步地，所述根据所述梯度直方图中的梯度值和第二频数选取参考梯度包括：统计所述梯度直方图中所有存在所述第二频数的梯度级，获得平均梯度；统计所述梯度直方图中所有存在的所述第二频数，获得平均频数；以梯度级大于所述平均梯度且第二频数小于所述平均频数的梯度级作为所述参考梯度。进一步地，所述获得待检测点邻域范围内与所述待检测点为同一所述灰度级类别的其他像素点的梯度分布，根据所述梯度分布在所述待检测点中筛选出边缘点包括：统计所述待检测点邻域范围内所有过所述待检测点的直线；若所述直线上存在一点与所述待检测点的梯度差异小于预设梯度阈值，且该点与所述待检测点为同一所述灰度级类别，则认为该点是所述待检测点的梯度相似点；统计每个所述直线上的所述梯度相似点的数量，若所述梯度相似点的数量大于预设数量阈值，则认为对应的所述直线为小段边缘线；若所述待检测点邻域范围内存在所述小段边缘线，则认为所述待检测点为所述边缘点。进一步地，所述根据每个超像素块内的平均像素值筛选出缺陷超像素块包括：以所述平均像素值最小的K个所述超像素块作为所述缺陷超像素块，K为正整数。本发明具有如下有益效果：本发明实施例首先根据灰度直方图中灰度级的分布进行粗分类，获得多个灰度级类别。进一步根据灰度级类别中的梯度直方图选取合适的梯度值作为参考梯度。根据参考梯度对应像素点邻域范围内的梯度分布获得边缘点，进而获得多个边缘区域。通过边缘区域选取参考尺寸，避免了超像素分割时对尺寸的选取不当导致分割效果变差，利用超像素块中的像素值即可快速准确的筛选出缺陷信息，实现了准确快速的芯片电路板的生产质量检测。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明一个实施例所提供的一种适用于芯片电路板的生产质量检测方法流程图；图2为本发明一个实施例所提供的一种焊点图像示意图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种适用于芯片电路板的生产质量检测方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种适用于芯片电路板的生产质量检测方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种适用于芯片电路板的生产质量检测方法流程图，该方法包括：步骤S1：获得芯片电路板的焊点图像；获得所述焊点图像的灰度直方图。在本发明实施例中，将焊接完成的芯片电路板水平放置在检测台上，部署相机从正上方采集芯片电路板的表面图像，考虑到图像采集和图像传输过程中会受到噪声的影响，将表面图像利用高斯滤波算法进行降噪。在表面图像中存在除焊点之外的其他图像信息，例如板材、电子元器件等。为了对焊点缺陷进行针对性的检测，在获得表面图像后将表面图像输入预先训练好的焊点区域分割网络中，获得焊点图像。需要说明的是，焊点区域分割网络为常见的语义分割网络，具体训练方法及实现手段为本领域技术人员熟知的技术手段，在此仅对该网络进行简要说明：以包含焊点区域的图像作为训练数据。将焊点区域像素标注为1，其他像素标注为0，获得标签数据。语义分割网络采用编码-解码结构，将训练数据和标签数据归一化后输入至网络中。语义分割编码器用于提取输入数据的特征，获得特征图。语义分割解码器将特征图进行采样变换，输出语义分割结果。采用交叉熵损失函数对网络进行训练。灰度直方图的横坐标为灰度级，纵坐标为对应灰度级在图像中出现频数。利用灰度直方图可表征焊点图像中的灰度分布。需要说明的是，获得灰度直方图的方法为本领域技术人员熟知的技术手段，在此不做赘述。步骤S2：将灰度直方图中具有连续性的灰度级作为可分类灰度级；根据可分类灰度级与相邻灰度级之间的第一频数差异获得分组指标，若分组指标大于预设指标阈值则将可分类灰度级与其相邻灰度级分为一类，获得多个灰度级类别。灰度直方图能够表征图像中的灰度分布，对于超像素分割而言，本质是将像素值相近的像素点分割为一个区域，如果超像素块的尺寸过大，会导致图像中缺陷区域和正常区域并未有效分割开来；如果超像素块的尺寸过小，会使得超像素块之间边缘贴合度不好，边界不清晰，影响缺陷识别准确度。因此步骤S2同时考虑了像素点的灰度值和分布特征将灰度级进行初始粗分类，获得多个灰度级类别供后续步骤处理。在灰度级分类过程中需要优先考虑将相似灰度级大小的灰度级分为一类，若在灰度直方图中某个灰度级具有连续性，即邻域范围内存在多个其他灰度级分布，则说明存在与该灰度级大小相似的灰度级，该灰度级可用于分类分析。因此将灰度直方图中具有连续性的灰度级作为可分类灰度级，具体判断灰度级存在连续性的方法包括：灰度直方图中的每个柱体对应一个灰度级，若在一个灰度级对应位置不存在柱体，则说明在图像中不存在该灰度级的像素点分布。获得灰度直方图中每个灰度级对应柱体的预设邻域范围内其他柱体的柱体数量，柱体数量越多说明与该灰度级相似的灰度级越多，该灰度级连续性越好。若柱体数量大于预设柱体数量阈值，则认为对应的灰度级具有连续性。在本发明实施例中，灰度级的邻域范围半径设置为5，即邻域范围为，其中a为目标灰度级的大小。柱体数量阈值设置为0，即在本发明实施例中认为目标灰度级在邻域范围内只有存在其他灰度级，就说明该目标灰度级存在连续性。可分类灰度级表示对应灰度级能够与相邻的其他灰度级合并，合并时还需要考虑两个灰度级之间的频数差异，频数差异越小，说明两种灰度级对应的像素点在图像中的信息量越接近，越为一类像素。请参阅图2，其示出了本发明一个实施例所提供的一种焊点图像示意图，图2中箭头指向位置即为锡洞缺陷位置。由图2可知，焊点图像中存在多个相同像素值的区域分布，分类的目的在于认为灰度级相似且频数相同的像素点为同类像素点。例如焊点图像中的正常类别的不同区域的灰度级存在相似性且信息量较多，通过分类可将其分为一类，缺陷区域同理。其中具体根据可分类灰度级与相邻灰度级之间的第一频数差异获得分组指标的方法包括：根据分组指标公式获得分组指标，分组指标公式包括：其中，为分组指标，为以自然常数为底的指数函数，为第个灰度级对应的第一频数，为相邻灰度级对应的第一频数，为柱体数量。由分组指标公式可知，若目标灰度级的连续性较强，且与相邻灰度级的频数差异较小，则说明两个灰度级越可能为同类像素。若分组指标大于预设指标阈值，则将可分类灰度级与相邻灰度级分为一类，通过不断的分类可获得多个灰度级类别。步骤S3：获得每个灰度级类别对应的像素点的梯度直方图；根据梯度直方图中的梯度值和第二频数选取参考梯度；以灰度级类别的参考梯度对应的像素点作为待检测点；获得待检测点邻域范围内与待检测点为同一灰度级类别的其他像素点的梯度分布，根据梯度分布在待检测点中筛选出边缘点，边缘点构成边缘线；获取焊点图像中每条边缘线围成的区域的最小外接正方形，以最小的最小外接正方形的尺寸作为参考尺寸。因为步骤S2中的分类为粗分类，因此每个灰度级类别对应的像素点在图像中构成的区域并非一个有效的区域，在该区域中可能存在由不同边缘构成的子区域。因为本发明实施例旨在提供一种自适应获得焊点图像中超像素块尺寸的方法，因此需要获得图像中的所有边缘及其构成的区域以供后续超像素块尺寸的筛选。边缘最明显的特征就是梯度较大，在焊点图像中，边缘信息应为信息量较少梯度幅值较为明显的信息，获得每个灰度级类别对应像素点的梯度直方图，梯度直方图中的信息能够表现梯度的大小以及分布，因此根据梯度直方图中的梯度值和对应的第二频数可选取参考梯度。认为参考梯度为边缘点所对应的梯度，因此可对参考梯度对应的像素点进行边缘分析，判断是否为边缘点，其中参考梯度的具体获取方法包括：统计梯度直方图中所有存在第二频数的梯度级，获得平均梯度。统计梯度直方图中所有存在的第二频数，获得平均频数。以梯度级大于平均梯度且第二频数小于平均频数的梯度级作为参考梯度。将灰度级类别中的参考梯度对应的像素点作为待检测点，因为本发明实施例希望寻找出能够形成一条完整边缘的边缘点，因此在对待检测点进行筛选时，需要考虑待检测点邻域范围内其他像素点的梯度分布，即梯度分布越与待检测点相似，则说明越容易构成一条边缘线，该待检测点越为所需要的边缘点。具体获得待检测点邻域范围内与待检测点为同一灰度级类别的其他像素点的梯度分布，根据梯度分布在待检测点中筛选出边缘点的方法包括：统计待检测点邻域范围内所有过待检测点的直线。若直线上存在一点与待检测点的梯度差异小于预设梯度阈值，且该点与待检测点为同一灰度级类别，则认为该点是待检测点的梯度相似点。统计每个直线上的梯度相似点的数量，若梯度相似点的数量大于预设数量阈值，则认为对应的直线为小段边缘线。若待检测点邻域范围内存在小段边缘线，则认为待检测点为边缘点。在本发明实施例中待检测的邻域范围的尺寸设置为5*5，即每条直线的长度为5个像素点，将梯度阈值设置为5，数量阈值设置为3。连续的边缘点可构成一条完整的边缘线，获取焊点图像中每条边缘线围成的区域的最小外接正方形，以最小的最小外接正方形的尺寸作为参考尺寸。步骤S4：根据参考尺寸对焊点图像进行超像素分割，获得多个超像素块；根据每个超像素块内的平均像素值筛选出缺陷超像素块；根据缺陷超像素块的位置和数量获得缺陷位置和缺陷程度。参考尺寸为根据焊点图像中的像素分布自适应获得的尺寸信息，根据参考尺寸对焊点图像进行超像素分割不会存在尺寸过大或者过小的缺陷。需要说明的是，根据参考尺寸进行超像素分割是本领域技术人员熟知的技术手段，具体分割过程不再赘述。焊点图像在进行超像素分割后会获得多个超像素块，每个超像素块中的像素信息相近，因为锡洞缺陷在图像中为明显的黑色，与其他区域呈现较为明显的像素差异，因此可根据每个超像素块的平均像素值筛选出缺陷超像素块，具体包括：以平均像素值最小的K个超像素块作为缺陷超像素块，K为正整数。在本发明实施例中，K取5。根据缺陷超像素块的位置即可实现对缺陷定位，缺陷超像素块的数量可获得缺陷程度，即数量越大缺陷程度越大。通过缺陷位置和缺陷程度可在生产质量检测过程中为工作人员提供参考，工作人员可根据缺陷信息对工艺进行排查，提高产品的良品率。综上所述，本发明实施例获得焊点图像的灰度直方图，根据灰度直方图中灰度级的分布及对应的频数获得多个灰度级类别。根据灰度级类别对应的梯度直方图获得参考梯度，在参考梯度对应的像素点中筛选出边缘点，进而获得边缘线围成的区域，获得该区域的最小外接正方形，以最小的最小外接正方形的尺寸作为参考尺寸对焊点图像进行超像素分割，根据分割后超像素块的平均像素值检测出缺陷超像素块。本发明实施例通过自适应获取超像素块的尺寸对芯片电路板中的焊点图像进行分割，实现了准确的质量检测。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
