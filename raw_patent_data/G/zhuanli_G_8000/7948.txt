标题title
基于多任务的断层智能识别方法
摘要abst
本发明公开一种基于多任务的断层智能识别方法，应用于地质勘探与解释领域，针对现有的三维断层识别网络中模型泛化性不足，在不同工区中识别效果差异较大的问题，本发明引入倾角方位角检测这两个辅助任务，利用主任务以及辅助任务间的相关性以及公共特征的提取，提高了模型的泛化性，使得模型在不同分布，不同特征的地震数据中都有较好的表现。同时也提出了数据预测的改进方法，从断层建模的角度，对断层的预测过程进行相应的优化。本文所提出的方法有效的解决了断层识别问题中模型泛化性较差的问题。网络效果在理论数据以及真实数据集上都表现出了较好的效果，充分证明了本文方法的有效性与实用性。
权利要求书clms
1.基于多任务的断层智能识别方法，其特征在于，包括：S1、构建理论数据集：通过正演模型构建理论数据集，所述理论数据集中包括若干组理论数据，每一组理论数据中包括四个数据样本，具体为：地震振幅数据、断层标签数据、倾角体数据、方位角体数据；S2、对理论数据集中的理论数据进行增强处理；S3、构建网络模型：对3D U-Net网络进行改进，将其扩展为多任务网络，得到多任务的U-Net网络；S4、对网络进行训练：将步骤S2增强后的理论数据输入多任务的U-Net网络中进行训练；S5、断层解释阶段：将实际工区数据经过数据预处理之后送入到训练好的多任务的U-Net网络中进行预测，得到断层属性体、断层倾角体、断层方位角体。2.根据权利要求1所述的基于多任务的断层智能识别方法，其特征在于，步骤S2所述的增强处理包括：S21、对三维数据体进行旋转变换；S22、采取对应角度间隔分别对倾角体数据、方位角体数据进行分类取整。3.根据权利要求1所述的基于多任务的断层智能识别方法，其特征在于，步骤S3所述多任务的U-Net网络结构为：包括编码器部分与解码器部分；所述编码器部分包括四个编码器层，所述解码器部分包括四个解码器层；编码部分相邻的2个编码器层，通过个2×2×2大小、步长为2的池化层将上一层编码器层的输出进行下采样后输入下一层的编码器层，下一层的编码器层中卷积层的通道数是上一层编码器层中卷积层通道数的2倍；解码部分相邻的2个解码器层，通过一个2×2×2的上采样层将上一层解码器层的输出进行上采样后输入下一层的解码器层，下一层的解码器层中卷积层的通道数是上一层解码器层中卷积层通道数的一半；每个编码器层包括：两个3×3×3的卷积层，每个卷积层使用Relu作为激活函数；每个解码器层包括：一个与对应编码层相连的拼接层，以及两个3×3×3的卷积层，每个卷积层均使用Relu作为激活函数。4.根据权利要求1所述的基于多任务的断层智能识别方法，其特征在于，采用基于滑动窗口的方法进行断层预测，具体的：将窗口的大小设置为基本单位的大小，同时将滑动窗口的步长设置为窗口大小的一半，在对地震体数据进行预测时不断移动窗口，并对窗口内的地震数据进行预测，并将预测结果最中心的1/2部分保留赋权值为1，边缘部分线性降低其权值，将每个点的值累加，待整个数据体完成预测之后除以每个点的权值得到最后的预测结果。5.根据权利要求1所述的基于多任务的断层智能识别方法，其特征在于，还包括以下处理过程：将预测数据的外层宽度为模型宽度1/2的数据进行镜像的扩展；再将扩展之后的数据作为预测数据进行预测，最后将扩展后的地震数据进行切割，获得原始地震数据的断层识别结果。6.根据权利要求5所述的基于多任务的断层智能识别方法，其特征在于，设置三个阈值：高阈值h，低阈值l，总和阈值s，h＞l＞s，将预测结果中值低于低阈值l的部分直接进行去除，高于高阈值h部分的结果直接予以保留；计算出当前保留的值的总和，如果总和大于总和阈值s则返回预测结果，否则按预测值大小由高到低从高阈值h和低阈值l间的数据进行保留直至保留数据总和大于总和阈值s。
说明书desc
技术领域本发明属于地质勘探与解释领域，特别涉及一种断层的识别技术。背景技术断层的识别解释是地质勘探与解释中重要的组成部分。长期以来，断层解释通过应用图像分析，图像增强的方法对相应的断层属性进行增强。按照这种思路发展而来的断层解释方法，有着计算步骤冗长，流程复杂，参数众多难以调整，导致断层解释的自动化，智能化程度不高的缺点。随着深度学习的兴起，其凭借着强大的高维复杂特征提取能力，以及端到端智能化的特点被快速引入到断层识别的领域中，并取得了不错的成绩。在断层解释领域，最开始是由地质专家对地震数据中的断层结构进行人工解释。人工解释将三维地震数据进行二维切片，依靠专家相关地学经验对地震数据中反射层的不连续特征进行分析，最后得到断层解释的结果。使用人工解释的方法大量消耗人力资源，费时费力，且断层解释结果依赖于解释人员的主观判断。基于人工进行断层识别在断层交错等复杂结构下难以实现准确的识别。因此人工识别的方法越来越难以适应规模越来越大的断层识别任务的需求，学术界也在一直探究使用自动方法高效的对断层进行识别。其中相干体属性，方差体属性，基于地震数据的倾角体和方位角体属性，以及利用蚂蚁追踪得到的蚂蚁体属性等多种的属性体增强数据能够有效的对断层进行识别。这些技术中以相干体数据与蚂蚁体数据影响较大。随着卷积神经网络的提出，深度学习网络被广泛应用于计算机视觉领域，并在自然图像，医学图像的分类，目标检测，语义分割，实例分割等领域取得较大突破。各个学科与图像处理相关交叉领域中也开始应用深度学习技术，并取得巨大成功。断层识别依靠识别地震图像中由于断层构造所产生的不连续信息，非常适合深度学习中计算机视觉相关技术，对断层进行识别类似于深度学习中的语义分割任务。K.M.Tingdahl,M.de Rooij等在2005年提出了一种基于多属性数据的断层半自动算法。该网络将人为挑选的属性作为输入输入到多层感知机中，最终输出断层识别结果。该算法需要人工选择属性无法做到自动的断层识别，并且断层的识别结果依赖于人为经验。2017年，L.Huang,X.Dong将理论正演数据作为训练数据，使用卷积神经网络对分块后的多种断层属性数据进行逻辑回归运算，得到断层识别结果。2017年W.Xiong等在地震属性数据中选取一个待分类点，并以该点为中心inline，xline，timeline三个方向进行切片，将切片数据作为神经网络的输入数据利用分类网络对中心点是否为断层进行分类。该方法使用相干体数据作为输入，在实际工区数据中也取得了一定的效果。上述的两种方法都需要将原始数据进行分块或切片，且每次预测仅预测原始数据中一个点的类别，会有大量的重复计算以及存储的额外开销，时间成本较高。2019年，X.M.Wu将3D U-Net应用于断层识别任务并对原始的网络进行简化以及改进提出了faultSeg3D模型，该模型充分利用了地震数据中的三维空间信息，在识别的效果以及精度上达到了较高水平，并在实际的工区数据中得到了较好的效果，该网络以一定大小的三维地震数据作为输入，输出断层的语义分割结果。该算法使用原始的地震数据作为输入，做到了对断层数据端到端的识别。虽然目前基于faultSeg3D的网络取得了较好的效果但是其仍然存在一定的问题：首先地震数据随着工区的不同，以及地质结构的不同具有较大的差异，在分布上具有较大的不同，而现阶段使用的训练数据大多数是基于正演模型的理论数据，使用faultSeg3D容易造成模型的过拟合，降低模型的泛化性。在实际不同工区中识别结果表现出较大差异。发明内容为解决上述技术问题，本发明提出一种基于多任务的断层智能识别方法，过引入倾角方位角检测这两个辅助任务，利用主任务以及辅助任务任务间的相关性以及公共特征的提取，提高了模型的泛化性，使得模型在不同分布，不同特征的地震数据中都有较好的表现。本发明采用的技术方案为：基于多任务的断层智能识别方法，包括：S1、构建理论数据集：通过正演模型构建理论数据集，所述理论数据集中包括若干组理论数据，每一组理论数据中包括四个数据样本，具体为：地震振幅数据、断层标签数据、倾角体数据、方位角体数据；S2、对理论数据集中的理论数据进行增强处理；S3、构建网络模型：对3D U-Net网络进行改进，将其扩展为多任务网络，得到多任务的U-Net网络；S4、对网络进行训练：将步骤S2增强后的理论数据输入多任务的U-Net网络中进行训练；S5、断层解释阶段：将实际工区数据经过数据预处理之后送入到训练好的多任务的U-Net网络中进行预测，得到断层属性体、断层倾角体、断层方位角体。步骤S2所述的增强处理包括：S21、对三维数据体进行旋转变换；S22、采取对应角度间隔分别对倾角体数据、方位角体数据进行分类取整。步骤S3所述多任务的U-Net网络结构为：包括编码器部分与解码器部分；所述编码器部分包括四个编码器层，所述解码器部分包括四个解码器层；编码部分相邻的2个编码器层，通过个2×2×2大小、步长为2的池化层将上一层编码器层的输出进行下采样后输入下一层的编码器层，下一层的编码器层中卷积层的通道数是上一层编码器层中卷积层通道数的2倍；解码部分相邻的2个解码器层，通过一个2×2×2的上采样层将上一层解码器层的输出进行上采样后输入下一层的解码器层，下一层的解码器层中卷积层的通道数是上一层解码器层中卷积层通道数的一半；每个编码器层包括：两个3×3×3的卷积层，每个卷积层使用Relu作为激活函数；每个解码器层包括：一个与对应编码层相连的拼接层，以及两个3×3×3的卷积层，每个卷积层均使用Relu作为激活函数。在断层解释任务中将第四个解码器层输出的特征图进行两次残差模块的卷积后将特征图的通道数量减少到16个，得到用于断层识别任务的特征。在倾角检测任务中，将第三个解码器层输出的特征图和第四个解码器层输出的特征图进行拼接，再将拼接后的特征图进行三次残差卷积块的卷积后得到最终的倾角检测结果。在方位角体检测任务中，将第三个解码器层输出的特征图和第四个解码器层输出的特征图进行拼接，再将拼接后的特征图进行三次残差卷积块的卷积后得到最终的方位角体检测结果。本发明的有益效果：本发明基于三维地震振幅，提出了一种基于3D U-Net多任务网络的断层识别方法。该网络以三维的理论地震数据作为输入，以断层识别，倾角检测，方位角检测作为网络输出的任务。该算法能够对断层进行准确的分割，并有效的检测断层所对应的倾角和方位角。在该算法下，引入了基于滑动窗口的断层预测拼接方法对传统的断层预测进行优化，解决了断层预测中不连续过渡不自然的缺点。通过多任务学习的方式提高了模型的鲁棒性，使其在不同特征分布的实际工区数据的表现上有较大的进步。附图说明图1为本发明的方法流程图；图2为地震数据及相关属性示意图；其中，为地震振幅数据，为断层标签数据，为方位角体，为倾角体；图3为基于多任务的U-Net网络示意图；图4为基于滑动窗口的断层预测流程图；图5为基于多任务的断层识别网络分割结果；其中，为原始地震振幅数据，为断层标签数据，为倾角体标签数据，为倾角体预测数据，为方位角标签数据，为方位角预测数据；图6为断层建模结果；图7为断层预测结果对比；其中，为原始地震数据，为断层标签数据，为3D U-Net预测结果，为多任务网络预测结果；图8为在不同频率下的预测结果对比；其中，为地震振幅数据，为断层标签数据，为3D U-Net预测数据，为多任务网络预测数据；图9为F3数据断层分割对比；其中，为原始地震数据，为3D U-Net预测结果，为多任务网络识别结果；图10为西南某地区地震数据断层分割对比；其中，为原始地震数据，为3D U-Net预测结果，为多任务网络识别结果；图11为三重阈值预测示意图；图12为地震振幅数据及信噪比测试结果；其中，为地震振幅数据，为信噪比测试结果；图13为断层分割结果对比图；其中，为直接预测结果，为三重阈值过滤结果。具体实施方式为便于本领域技术人员理解本发明的技术内容，下面结合附图对本发明内容进一步阐释。实施例1本发明使用基于3D U-Net网络的多任务学习网络同时对断层属性体以及倾角体和方位角体进行预测。针对使用传统的扫描法对断层倾角方位角体的计算时间复杂度大，计算时间长且依赖于断层属性体提取结果的缺点，本发明提出了一种基于3D U-Net网络的多任务学习网络。该网络以三维地震振幅数据作为输入，输出断层识别结果以及倾角体和方位角体。针对训练的地震数据不同工区之间的数据分布差异，使用多任务学习网络，提取不同相关任务中的公共特征，减少模型过拟合的风险，提高模型在不同工区数据之间的泛化性。如图1所示，本发明的方法包括以下步骤：1.构建理论数据集：通过正演模型构建理论数据集的模型，共包含四个部分，地震振幅数据，断层标签数据，理论倾角体数据，理论方位角体数据。2.构建网络模型：对3D U-Net网络进行改进，并将其扩展为多任务网络。3.对网络进行训练：对理论数据进行数据增强之后送入到多任务学习网络中进行训练。4.断层解释阶段：将实际工区数据送入到多任务学习网络中进行预测，得到断层属性体，断层倾角体，断层方位角体，三个属性体。步骤1还包括对理论数据集进行处理，在断层智能识别任务中使用人工标注的方法受标注者自身主观影响较大，很难对数据中的断层标签进行准确的标注。在真实地震振幅数据中求解倾角体和方位角工作量大，计算精度较差，无法获得足够且准确的训练数据对网络进行训练。因此使用理论地震数据是一种更合理的选择。本发明使用正演模型构建了220个128×128×128的理论地震数据。使用其中的前200个数据作为训练数据，后20个数据作为测试数据。每一组训练数据中包含四个数据样本，地震振幅数据，断层标签数据，倾角体数据，方位角体数据。在本发明中断层的倾角范围为，方位角范围为，其训练样本如图2所示。数据集具体处理过程为：数据旋转处理对一个三维数据体进行旋转变换即选定一个旋转点，并将数据体中所有的样本点围绕旋转点旋转一个角度。本步骤应用于地震振幅数据、断层标签数据、倾角体以及方位角体数据的数据旋转处理。其中C是旋转点，θ是旋转角，样本数据中的任意点为P1，其旋转后的数据为P2，x0、y0是旋转点的横纵坐标，x、y是样本数据的横纵坐标，其中x是地震振幅数据，y是断层标签数据，倾角体旋转公式为：P2＝M+C其中，M为旋转矩阵，旋转矩阵如下式所示：由于在本实施例中使用的数据集均为正方体数据，为了避免旋转任意角度所带来的插值问题，以及数据空缺问题，本实施例仅仅使用90°，180°，270°，三个角度对数据体进行旋转。并且由于地震数据在x轴与y轴进行旋转之后其分布不具有实际的物理意义，所以旋转的方向仅限于z轴方向。在沿z轴方向旋转之后倾角方向没有变化，方位角会相应的增加旋转的角度。方位角体经过旋转变换后的表达式如下所示：P2＝M+C+θ 对倾角体和方位角体数据的处理对三维地震数据进行断层识别可以看作是一个分割问题，同时也可以看作是在原始数据大小的结果图中对每一个像素点的分类问题。而对倾角体，方位角体的检测问题可以看作是在原始数据大小的结果图上的回归问题。使用回归问题对断层的倾角方位角体进行训练波动大，并且由于回归问题与分类问题相似度不高，使用同一主干网络对数据进行公共特征提取会导致后续不同任务间相互干扰，导致网络训练不收敛，无法达到预期的效果。因此本发明将倾角体与方位角体的识别转换为分类问题。在本发明构建的地震数据中断层的倾角范围为，本实施例采取2°为间隔，对断层倾角数据进行分类取整，最终将断层的倾角体分为32类。同理，本发明所构建地震数据中方位角的范围是，本实施例采取5°为间隔将其进行分类取整，将方位角体分为74类。将原有的倾角体方位角体的有回归任务转换为分类任务，增加了不同任务之间的相似性，有利于公共特征的提取同时加速了模型的训练和收敛。步骤2所述的基于多任务的U-Net网络如图3所示，该网络基于U-Net网络演化而来，包括两个部分，第一个部分是网络的编码器部分，网络输入为128×128×128的三维地震数据，编码器的第一层包括两个3×3×3的卷积层，每个卷积层均使用Relu作为激活函数，然后采用2×2×2大小，步长为2的池化层对网络进行下采样。在编码器部分每向下一层就会将该层卷积层的通道数翻倍。该网络一共包括四层这样的编码器层。另一个部分为解码器部分，每个解码层都包括一个2×2×2的上采样层，一个与左边的编码层相连的拼接层，以及两个3×3×3的卷积层，每个卷积层均使用Relu作为激活函数。在解码器部分每向下一层就会将该层卷积层的通道数减少一半。该网络一共包含四层这样的解码器层。本发明采取这样简化的3D U-Net网络作为断层识别的主干网络对多个任务间公共特征进行提取。使用这样的3D U-Net网络在断层识别任务中取得过良好的效果。在特征提取中通过对上采样和下采样的使用可以使得特征提取器能够提取到不同尺度上的断层图像特征。在断层解释任务中将骨干网络的特征图进行两次残差模块的卷积后将特征图的通道数量减少到16个，得到用于断层识别任务的特征。在倾角检测任务中，将骨干网络的特征图和断层识别的特征图进行拼接，在将拼接后的特征图进行三次残差卷积块的卷积后得到最终的倾角检测结果。同理使用类似的网络结构得到方位角体的检测结果。相较于倾角体和方位角体的检测任务，断层的识别任务是相对更简单的任务。因此在对断层进行识别的时候使用了相对较少的卷积层数。而对于倾角体和方位角体的识别使用相对较多的卷积网络。为了避免过深的网络导致网络退化，本发明使用残差块代替传统卷积网络缓解网络过深带来的模型退化问题。在传统的倾角方位角检测算法中，为了提高检测效果，往往在断层属性体上进行计算。因此在本发明的断层网络结构构建中将断层识别的特征作为输入提供到倾角与方位角的检测任务中。断层识别特征与骨干网络的公共特征共同作为输入，为倾角与方位角的检测任务提供了不同尺度下的特征以及部分先验信息，减小了后续网络学习的难度。步骤3训练过程中所涉及的损失函数具体为：断层识别任务三维的断层识别任务与二维断层识别任务具有相似的特点。在损失函数的选择上需要考虑到断层与非断层间类别不均衡问题以及从整体图像相似性上描述断层识别结果。因此在本发明网络训练中选取BCE Dice损失函数。方位角体的检测任务断层的方位角检测问题转换为了对像素点的分类问题。由于断层在方位角上的分布较为均匀，没有明显的分布不均匀的情况，并且在数据增强中使用了旋转的增强方式进一步缓解了类别不均衡问题，因此在方位角检测任务中使用交叉熵函数作为损失函数，其数学表达式如下所示：其中S示方位角数据总类别数，yic表示样本i的类别是否是类别c，pic表示方位角体样本i属于类别c的概率值，N代表类别总数。倾角体检测任务同方位角检测任务不同，在理论数据中倾角范围被限制在了30°～90°。其中大部分断层位于60°～90°，有明显的类别不均衡问题。且不同于断层分割这类的二分类问题，方位角检测问题中一共有32个类别，较多的分类类别使得平衡交叉熵损失函数效果欠佳，因此本发明使用focal loss作为倾角检测的损失函数，其数学表达式如下：其中α代表该类别的权重，γ代表该样本分类的难易程度，y代表标签的类别。总体上来讲，focal loss能够有效的缓解分类问题中类别问题不均衡，不同样本间难易程度不均衡的情况。实施例2针对传统预测方法在对实际数据进行预测时，模型的边界会出现不连续，过渡不自然的情况，本发明中提出了一种基于滑动窗口的断层预测方法，最终有效提高了断层识别的连续性。具体包括：1、测试时增强对预测数据进行测试时增强。本发明选取的测试时增强算法如下：11.将数据在水平方向上随机旋转90°，180°，270°；12.将原始地震振幅数据分别在xline,inline,timeline方向上随机平移5像素以内。2、基于滑动窗口的断层预测方法由于U-Net网络的在进行卷积，下采样以及上采样操作时图像边缘信息相较于中心位置信息会有较大程度上的损失，因此U-Net网络的预测结果边缘的效果相较于中心的效果较差。使用传统方法将地震数据进行简单分块后再拼接容易在拼接边缘产生较多的噪声，且不同分块之间的断层识别不连续，断层属性数据间的过渡不自然的缺点。本发明采用如图4所示的基于滑动窗口的方法，将窗口的大小设置为基本单位的大小，同时将滑动窗口的步长设置为窗口大小的一半，在对地震体数据进行预测时不断移动窗口，并对窗口内的地震数据进行预测，并将预测结果最中心的1/2部分保留赋权值为1，边缘部分线性降低其权值，将每个点的值累加，待整个数据体完成预测之后除以每个点的权值得到最后的预测结果。实施例3在使用基于滑动窗口的断层智能预测方法后位于预测图图像居中位置的断层分割结果具有了良好的连续性和自然的过渡，但是在分割结果的最外层效果依然不理想。本发明在对地震数据进行预测时首先需要将预测数据的外层宽度为模型宽度1/2的数据进行镜像的扩展。在将扩展之后的数据作为预测数据进行预测，最后将扩展后的地震数据进行切割，获得原始地震数据的断层识别结果。实施例4以下结合理论数据对本发明的效果进行说明本发明将综合基于3D U-Net的多任务网络在理论数据上的断层预测效果和其在实际工区数据上的断层识别效果进行多方面的验证。为了验证本发明提出的基于3D U-Net的多任务网络在断层分割任务中的对模型泛化性能的改进，本发明选取两组不同特征，不同频率的数据集对网络对断层分割结果进行测试。其中一组数据集的频率与训练数据一致，而另一组数据在地震波频率，以及断层的分布规律上与训练数据不同。首先分析模型在三维理论数据的效果。首先选择一组理论数据，该理论数据与训练数据的频率以及数据分布特征相同，如图5为其对应的辅助任务，倾角体检测结果，以及方位角检测结果。理论地震数据的网络输出结果如图5所示。图中表示原始理论地震振幅数据；是理论地震振幅数据对应的断层标签数据；是倾角体的标签数据。是倾角体预测数据。方位角的标签数据。方位角的预测数据。从该数据可以看出使用基于多任务的断层分割网络能够有效的提取出断层相关任务的公共特征。利用该公共特征，后续的倾角体检测网络以及方位角体的检测网络能够对该地震数据的倾角体以及方位角体做出有效的预测。从该理论数据来看本发明提出的基于多任务的断层分割网络在断层的倾角识别以及方位角识别上能够做到较为准确的识别，识别效果能够有效的表征断层的走向以及趋势。倾角方位角属性以及断层的预测结果是地质建模中重要的属性数据。利用这些属性数据能够完成断层的细化，追踪，重建等地质建模工作。网络中的倾角，以及方位角解释结果能否用于地质建模并得出正确的建模结果是判断网络识别效果的重要标准之一。因此，此处选取上述理论数据标签结果对数据进行断层追踪建模，其三维断层建模结果如图6所示，可以看出根据网络输出的断层建模结果能够准确追踪出不同的断层以及断层间的位置关系。多任务学习中更重要的是利用辅助任务和主任务之间的相关性提取公共特征进一步改善主任务效果。在本发明网络中倾角方位角检测任务的公共特征有利于促进断层分割的效果，使网络对断层对识别效果优于单一任务的断层识别任务。首先选取一与训练数据属于同一频率以及分布规律的地震数据进行断层的分割预测。并于使用传统3D U-Net的网络进行对比。图7为基于多任务的断层分割模型在该数据集中验证集的断层分割结果。从图中断层的分割结果可以看出，3D U-Net网络与本发明网络都能够准确的对地震数据中的断层进行准确的提取，断层分割的位置准确。该网络能够较好识别理论数据中的断层结构，在断层结构简单的区域识别结果准确，精细，断层边缘清晰，背景干净，而在一些断层构造较为复杂的区域，例如断层的交汇处，可以看出网络能够基本准确的识别断层的位置，但是其识别的精细程度会有所下降。同样选取数据的三个剖面对断层的分割结果进行对比，可以发现，就理论数据的分割效果来看两个模型的断层分割结果都很准确，在一些断层的结合处，3D U-Net的精细程度，以及连续性会略差一些，连续性以及边缘的清晰度，锐利度不如本发明提出网络，在地震数据的边缘，3D U-Net的断层识别结果会产生一定的噪声。多个任务共享一个主要特征，能够有利于主干网络提取到各个任务之间更本质的特征，可以减小网络的过拟合现象，有利于模型泛化性的提升。在地震数据中不同的工区地质结构分布有较大的不同，同时由于地质勘探方式的不同，地质数据中地震波的频率也不相同，模型在不同频率范围地震数据的断层解释结果是衡量模型泛化性的关键指标，因此，这里选取了与训练数据不同频率下的理论数据进行测试，测试结果如图8所示。除地震数据频率之外，该数据集在断层分布上与训练数据也有较大的差异。相较于训练数据集，该数据集中断层的结构更加复杂，断层分布密度较大，有较多的交叉断层结构，断层识别难度也更大。从预测结果来看，3D U-Net网络预测结果有较多的噪声，在断层识别的边缘位置较为模糊，断层的连续性较差，且在断层密集位置出现了断层识别错误，将非断层区域错误的识别为断层区域。本发明提出的基于多任务的断层识别网络则能够更加准确的识别断层，断层识别结果边缘清晰，背景干净，识别的准确度相较于3D U-Net网络有较大的提升。从该组对照样本中可以看出在与训练数据频率不同的数据中，本发明提出的网络具有更好的分割性能。实施例5以下结合真实数据对本发明的效果进行说明本实施例使用真实数据对基于多任务的断层分割网络的分割效果进行分析，对断层的有效性和实用性进行验证。本实施例共选取两个不同工区的数据作为对照样本：1.荷兰地区F3的某实际工区三维地震数据。2.我国西南某地区三维地震数据。F3数据是位于荷兰北海的某实际工区数据，该数据大小为384×512×128。F3地震数据断层发育良好，在inline方向和xline方向上都有跨度较大的断层结构。且该工区数据质量较高，细碎的地质结构较少，数据的信噪比较高，且该地震数据的频率与网路训练数据频率较为接近。从该组样本的断层识别结果上来看，3D U-Net网络与多任务网络都能够对断层进行准确的识别。识别结果能够准确的反应断层的位置以及趋势。3D U-Net网络在断层分割的连续性上不足。图9中提供了原始地震数据，如图9中所示，从xline-inline方向上来看，3DU-Net网络在横向断层的分割结果中断层的连续性不足，在xline，inline范围内未能够将断层进行有效分割，出现了遗漏的现象。同时在断层间的交叉位置，以及断层数据的边缘位置上断层分割结果的连续性较差。而如图9中所示的本发明提出的多任务网络的识别结果中，则能够对断层进行准确的识别以及分割，在xline-inline方向上以及inline-timeline方向上断层分割的连续性都优于3D U-Net网络的识别结果。如图10所示为西南某地区的原始地震数据以及不同模型的断层识别结果对比。西南某地区工区实际数据大小为521×581×1000，具有良好的断层发育以及复杂的地质构造，其中包含了正断层，逆断层，溶洞以及褶皱等地质构造，其中溶洞与断层具有相似的特征对断层的识别造成较大的难度。在该地震数据中，地质结构较为复杂产生较大的相干噪声对断层的识别也会造成较大的影响。且该工区数据的数据频率与网络训练数据集中的数据频率不同对断层的预测的影响也较大。从断层预测的结果上来看基于多任务网络的断层识别结果明显优于3D U-Net，3DU-Net网络丢失了大量的断层识别结果，仅仅完整的识别出了一条主要断层。而本发明提出的网络则能够对断层进行准确的识别，保留了较多的断层细节。3D U-Net网络的断层识别结果边缘较为模糊，断层识别宽度较大，在大跨度断层的连续性上表现不佳，总体上较为粗造。本发明提出的网络分割结果较为细致，边缘相对清晰，连续性较好。在timeline的范围内，地质结构较为复杂，存在较多细碎的地质结构，地震数据噪声偏大断层识别难度较高。3D U-Net网络在该地区的识别效果欠佳，出现大量的识别错误以及遗漏。本发明网络则能较为准确的对主要断层进行分割，识别错误以及噪声相对较少。综上可以看出多任务学习网络相较于传统的3D U-Net网络在断层的识别结果以及模型的泛化性上都优于传统的3D U-Net网络。同时在西南某地区数据集上可以看出深度学习网络在地质结构较为复杂的区域预测结果不佳。复杂地质结构产生较大的相干噪声，影响断层识别效果，预测结果产生较多的噪声以及细碎的结构，这样的断层识别结果会对后续的地质建模工作产生不利影响。因此本发明在下一节中提出了一种基于地震数据信噪比估算的预测改良方法，该方法对复杂区域内的地质结构进行过滤，过滤细碎结构，保留主要断层，缓解噪声对断层建模的影响。实施例6针对网络预测结果在地质结构复杂区域内产生较多细碎结果，对断层建模产生不利影响的情况，本发明提出一种基于地震数据信噪比估算的预测改良，能够从细碎结构提取出主要断层结构。具体包括：1、相关平移法估算地震数据信噪比在对地震数据进行信噪比估算时，首先选取一定大小的估算时窗，时窗范围内地震记录的总道数为N道，其中每道共有M个采样点。其中任意地震道记录Xi由有效信号Si和数据噪声Ni组成。Xi＝Si+Ni 将道间的最大的互相关值Qi,i+1作为功率谱：Qi,i+1＝max{Qi,i+1} 其中i为第i道地震道，τ为最大互相关时的时偏移量，T为一道时间序列。以相关值作为地震信号的总功率谱。则平均信号能量为：噪音能量为：则信噪比为：2、复杂区域预测方法按照上述理论在对复杂区域的预测结果进行处理时应该适度降低该区域内的置信度。传统的做法是在该区域内设定阈值，将高于阈值水平的点进行保留，低于该阈值的数据进行去除。该方法具有较大的局限性，受噪声，复杂结构等多种因素的影响，在同一窗口内可以出现预测值整体较高，或者整体偏低的情况，简单的使用单一阈值无法满足在面对不同预测窗口时将主要断层结构进行有效的提取。例如，使用较高的阈值，会导致整体预测值偏低的窗口的主要断层被过滤，使用较低的阈值会导致在整体预测值偏高的窗口保留过多的细碎结构。针对单一阈值的上述问题本发明提出了基于三重阈值的预测方法，在该方法中共包含三个阈值：高阈值h，低阈值l，总和阈值s。当预测结果中值低于低阈值的部分直接进行去除，高于高阈值部分的结果直接予以保留。计算出当前保留的值的总和，如果总和大于总和阈值s则返回预测结果，否则按预测值大小由高到低从高阈值和低阈值间的数据进行保留直至保留数据总和大于总和阈值s，或者没有数据满足条件。具体算法如下所示：如图11为该算法的简单示例，选择大小为3*3，l＝0.3，h＝0.6，s＝2对该算法进行演示。最后将复杂区域预测结果中的离散点进行过滤得到最终的结果图。经过三重阈值预测方法的过滤后，能够将该区域内的地质结构进行有效的筛选，得到主要的断层结构。3、实际数据仿真结果如图12所示为某真实工区的地震数据,该数据在Inline范围间存在两条跨度较大的断层，在该地震振幅数据的上半部分的其他区域地质结构较为简单，除主要断层外无其他复杂地质结构的影响。在timeline范围存在着一系列的地质破碎带，在该范围内存在这一系列复杂，细小的地质结构。这些地质结构产生较多的相干噪声，不利于模型对断层的预测。对该数据从timeline进行划分，每间隔100单位进行划分，对不同的划分区域使用相关时移法进行信噪比测试。从信噪比测试结果来看，在数据timeline范围内的信噪比较高，地质结构较为复杂的timeline范围内的信噪比较低，在信噪比较低的区域地质结构也较为复杂与上文的分析结果相符合。如图13所示，直接使用模型对该地震数据进行预测，在结构复杂的范围内产生大量的细碎的断层分割结果。在主要断层之间的也出现了若干细碎的断层影响，这些细碎断层会对后续的断层建模造成干扰，影响主要断层的走向以及趋势。在该区域内使用三重阈值对断层数据的预测结果进行过滤之后在该区域范围内的细碎断层预测结果显著减少，在该范围内主要断层的周围的干扰显著减少分割结果也较为清晰，相较于直接预测的结果更有利于断层的建模。图12、13中的Inline表示主测线，Timeline表示时间，Fault probability表示断层概率.本领域的普通技术人员将会意识到，这里所述的实施例是为了帮助读者理解本发明的原理，应被理解为本发明的保护范围并不局限于这样的特别陈述和实施例。对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的权利要求范围之内。
