标题title
一种基于大数据分析的模式切换的方法及系统
摘要abst
本发明公开了一种基于大数据分析的模式切换的系统，所述系统包括大数据分析平台及智能家居控制模块，所述大数据分析平台包括大数据分析数据源、数据处理模块及数据接口模块，所述大数据分析数据源与数据处理模块连接，所述数据处理模块与所述数据接口模块连接，智能家居控制模块通过所述数据接口模块与所述大数据分析平台进行通信，所述智能家居控制模块包括存储单元，用于存储从所述大数据分析平台获取的相关信息，所述智能家居控制模块作为用户智能家居的智能路由与全部的智能家居设备连接，所述智能家居设备在获取到用户的环境参数后将所述环境参数发送至所述智能家居控制模块。
权利要求书clms
1.一种基于大数据分析的模式切换的系统，其特征在于，所述系统包括大数据分析平台及智能家居控制模块，所述大数据分析平台包括大数据分析数据源、数据处理模块及数据接口模块，所述大数据分析数据源与数据处理模块连接，所述数据处理模块与所述数据接口模块连接，智能家居控制模块通过所述数据接口模块与所述大数据分析平台进行通信，所述智能家居控制模块包括存储单元，用于存储从所述大数据分析平台获取的相关信息，所述智能家居控制模块作为用户智能家居的智能路由与全部的智能家居设备连接，所述智能家居设备在获取到用户的环境参数后将所述环境参数发送至所述智能家居控制模块，所述系统包括：大数据分析数据源，所述大数据分析数据源为通过大数据爬取及用户数据上传导入、和应用环境监控自动采集的相关数据，对所述大数据分析数据源进行存取优化，根据数据产生和调用的频率不同可以分为冷数据、温数据和热数据，其中，所述冷数据用于存储用户中智能家居设备的网络拓扑结构、用户签订合约文件，温数据存储对于不同智能家居设备的模拟控制方案、用户在不同的环境参数下对于所述智能家居设备的历史控制数据，热数据存储用户的实时环境参数；数据处理模块，通过所述数据处理模块对大数据分析数据源的数据进行处理，通过基于大数据技术的ETL对所述大数据分析数据源的数据进行处理和转换，对于不同类型的数据根据数据的特点选择存储方式，其中所述存储方式包括关系型数据库存储或基于Hadoop的大数据分布式存储；数据接口模块，大数据分析平台通过将所述数据处理模块中的数据通过封装成接口统一为智能家居应用模块提供数据，智能家居通过传感器记录当前用户的环境参数，根据所述环境参数的变化速率决定查询相关数据的方式，其中所述查询相关数据的方式为通过指标、二维表的查询访问或者是基于Hadoop的实时查询引擎进行查询，当所述环境参数的变化速率小于第一预设值时，采用指标、二维表的查询访问进行数据查询，当所述环境参数的变化速率大于等于第一预设值时，采用基于Hadoop的实时查询引擎进行查询；智能家居控制模块，所述智能家居控制模块根据接收到的智能家居通过传感器采集到的环境数据，根据由环境变化速率决定的查询方式，查询对当前环境参数的智能家居建议控制方式，所述建议控制方式为大数据分析平台根据采集的针对于不同环境参数的大量用户控制数据及对于不同环境生成的模拟控制方案中挑选出符合当前用户采集到的环境数据中的方案；终端控制模块，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，以问询的形式向用户进行语音推荐控制方案，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，直接通过针对于当前用户行为习惯构建的知识图谱对提供的方案进行挑选并直接执行。2.如权利要求1所述的一种基于大数据分析的模式切换的系统，其特征在于，所述数据处理模块进一步包括：将调用频率高的部分温数据及热数据通过关系型数据库进行存储，根据不同的环境参数进行条目存储，对应于不同智能家居设备的模拟控制方案及用户的历史控制数据进行清洗、转换和存储。3.如权利要求1所述的一种基于大数据分析的模式切换的系统，其特征在于，所述数据处理模块进一步包括：将调用频率低的冷数据及部分温数据采用基于Hadoop的分布式数据仓库进行存储，通过基于Hadoop的分布式数据仓库定期对热数据进行备份。4.如权利要求1所述的一种基于大数据分析的模式切换的系统，其特征在于，所述构建的知识图谱进一步包括：统计相应的知识要素，所述相应知识要素包括用户控制智能设备的参数和环境参数的关系及概率，利用可追溯马尔科夫逻辑来构建相应的推理网，通过分布相似度法计算多个所述智能家居设备的控制参数和环境参数之间的关联度，利用K-Means聚类算法确定主要生成针对于该用户的相关标签，将所述标签进行标定后完善知识图谱。5.如权利要求1所述的一种基于大数据分析的模式切换的系统，其特征在于，所述智能家居设备的拓扑网络包括传感器节点、汇聚节点和管理节点，其中，所述传感器节点根据测量目的和测量需求，分布于监测对象区域内采集所述环境参数，各个节点通过网络的自适应功能自动组织成网络，同时各个节点都具备收发数据的功能，并且采用路由方式将数据传输到汇聚节点，通过汇聚节点可以通过Internet互联网来实现远程管理节点或者与节点进行通信，管理节点则是负责将用户与网络连接起来，用户可以通过对管理节点的控制，来对整个网络进行配置，设定相关的监测任务或者查看相关监测数据，其中，所述智能家居控制模块作为网络拓扑结构中的汇聚节点和管理节点，当用户所处环境网络信号不好时，所述智能家居控制模块选择网络拓扑结构相似的其他用户的控制方案进行直接推荐。6.一种基于大数据分析的模式切换的方法，其特征在于，所述方法应用于基于大数据分析的模式切换的系统中，其中，所述系统包括大数据分析平台及智能家居控制模块，所述大数据分析平台包括大数据分析数据源、数据处理模块及数据接口模块，所述大数据分析数据源与数据处理模块连接，所述数据处理模块与所述数据接口模块连接，智能家居控制模块通过所述数据接口模块与所述大数据分析平台进行通信，所述智能家居控制模块包括存储单元，用于存储从所述大数据分析平台获取的相关信息，所述智能家居控制模块作为用户智能家居的智能路由与全部的智能家居设备连接，所述智能家居设备在获取到用户的环境参数后将所述环境参数发送至所述智能家居控制模块，所述方法包括如下步骤：步骤1，通过大数据爬取及用户数据上传导入、和应用环境监控自动采集的相关数据，对所述大数据分析数据源进行存取优化，根据数据产生和调用的频率不同可以分为冷数据、温数据和热数据，其中，所述冷数据用于存储用户中智能家居设备的网络拓扑结构、用户签订合约文件，温数据存储对于不同智能家居设备的模拟控制方案、用户在不同的环境参数下对于所述智能家居设备的历史控制数据，热数据存储用户的实时环境参数；步骤2，对大数据分析数据源的数据进行处理，通过基于大数据技术的ETL对所述大数据分析数据源的数据进行处理和转换，对于不同类型的数据根据数据的特点选择存储方式，其中所述存储方式包括关系型数据库存储或基于Hadoop的大数据分布式存储；步骤3，大数据分析平台通过将所述数据处理模块中的数据通过封装成接口统一为智能家居应用模块提供数据，智能家居通过传感器记录当前用户的环境参数，根据所述环境参数的变化速率决定查询相关数据的方式，其中所述查询相关数据的方式为通过指标、二维表的查询访问或者是基于Hadoop的实时查询引擎进行查询，当所述环境参数的变化速率小于第一预设值时，采用指标、二维表的查询访问进行数据查询，当所述环境参数的变化速率大于等于第一预设值时，采用基于Hadoop的实时查询引擎进行查询；步骤4，根据接收到的智能家居通过传感器采集到的环境数据，根据由环境变化速率决定的查询方式，查询对当前环境参数的智能家居建议控制方式，所述建议控制方式为大数据分析平台根据采集的针对于不同环境参数的大量用户控制数据及对于不同环境生成的模拟控制方案中挑选出符合当前用户采集到的环境数据中的方案；步骤5，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，以问询的形式向用户进行语音推荐控制方案，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，直接通过针对于当前用户行为习惯构建的知识图谱对提供的方案进行挑选并直接执行。7.如权利要求6所述的一种基于大数据分析的模式切换的方法，其特征在于，所述步骤2进一步包括：将调用频率高的部分温数据及热数据通过关系型数据库进行存储，根据不同的环境参数进行条目存储，对应于不同智能家居设备的模拟控制方案及用户的历史控制数据进行清洗、转换和存储。8.如权利要求6所述的一种基于大数据分析的模式切换的方法，其特征在于，所述步骤2进一步包括：将调用频率低的冷数据及部分温数据采用基于Hadoop的分布式数据仓库进行存储。9.如权利要求6所述的一种基于大数据分析的模式切换的方法，其特征在于，所述构建的知识图谱进一步包括：统计相应的知识要素，所述相应知识要素包括用户控制智能设备的参数和环境参数的关系及概率，利用可追溯马尔科夫逻辑来构建相应的推理网，通过分布相似度法计算多个所述智能家居设备的控制参数和环境参数之间的关联度，利用K-Means聚类算法确定主要生成针对于该用户的相关标签，将所述标签进行标定后完善知识图谱。10.如权利要求6所述的一种基于大数据分析的模式切换的方法，其特征在于，所述智能家居设备的拓扑网络包括传感器节点、汇聚节点和管理节点，其中，所述传感器节点根据测量目的和测量需求，分布于监测对象区域内采集所述环境参数，各个节点通过网络的自适应功能自动组织成网络，同时各个节点都具备收发数据的功能，并且采用路由方式将数据传输到汇聚节点，通过汇聚节点可以通过Internet互联网来实现远程管理节点或者与节点进行通信，管理节点则是负责将用户与网络连接起来，用户可以通过对管理节点的控制，来对整个网络进行配置，设定相关的监测任务或者查看相关监测数据，其中，所述智能家居控制模块作为网络拓扑结构中的汇聚节点和管理节点，当用户所处环境网络信号不好时，所述智能家居控制模块选择网络拓扑结构相似的其他用户的控制方案进行直接推荐。
说明书desc
技术领域本发明涉及计算机分析控制技术领域，尤其涉及一种基于大数据分析的模式切换的方法及系统。背景技术随着计算机技术的迅速发展，在计算机上处理的业务也由基于单机的数学运算、文件处理，基于简单连接的内部网络的内部业务处理、办公自动化等发展到基于复杂的内部网、企业外部网、全球互联网的企业级计算机处理系统和世界范围内的信息共享和业务处理。在系统处理能力提高的同时，系统的连接能力也在不断的提高。但在连接能力信息、流通能力提高的同时，基于网络连接的安全问题也日益突出，整体的网络安全主要表现在以下几个方面：网络的物理安全、网络拓扑结构安全、网络系统安全、应用系统安全和网络管理的安全等。大数据包括结构化、半结构化和非结构化数据，非结构化数据越来越成为数据的主要部分。据IDC的调查报告显示：企业中80％的数据都是非结构化数据，这些数据每年都按指数增长60％。大数据就是互联网发展到现今阶段的一种表象或特征而已，没有必要神话它或对它保持敬畏之心，在以云计算为代表的技术创新大幕的衬托下，这些原本看起来很难收集和使用的数据开始容易被利用起来了，通过各行各业的不断创新，大数据会逐步为人类创造更多的价值。大数据分析是指用适当的统计分析方法对收集来的大量数据进行分析，提取有用信息和形成结论而对数据加以详细研究和概括总结的过程。这一过程也是质量管理体系的支持过程。在实用中，大数据分析可帮助人们做出判断，以便采取适当行动。大数据分析的数学基础在20世纪早期就已确立，但直到计算机的出现才使得实际操作成为可能，并使得大数据分析得以推广。大数据分析是数学与计算机科学相结合的产物。同时随着科学技术的发展，智能家居越来越受到人们的重视。在好莱坞的科幻影片里我们经常看到，一个控制器，控制整个家庭的家电。现实生活中，也存在很多智能家居。现有技术的智能家居实现模式，一般都是借用于计算机进行控制，利用控制网络布线，控制信号通过有线电缆进行传输，或者依赖于2.4G无线网络，每个家电增加一个无线接受模块，这两种方式实现的智能家居成本较高，需要计算机辅助控制，结构较复杂，耗能高，使用不方便，同时这种家居构造必须在家庭房屋设计初期就必须进行布线或者进行无线网络布置，无法实现家庭智能化改造。然而现有的智能家具与网络连接的控制方式仅仅是基于无线或者优先网络传输用户的控制命令，而不能很好的应用网络上的强大的分析能力解决一般的家庭智能家具的控制。同时，现有技术中在设备处于离线时，控制效果也会大大下降。并且，智能家居设备受限于自身的处理单元的性能，不能更快的查询网络上的信息，即使做出调整，对用户造成诸多不便使得用户常常感觉到智能设备不够智能。发明内容本发明旨在至少解决现有技术中存在的技术问题之一。为此，本发明公开一种基于大数据分析的模式切换的系统，其特征在于，所述系统包括大数据分析平台及智能家居控制模块，所述大数据分析平台包括大数据分析数据源、数据处理模块及数据接口模块，所述大数据分析数据源与数据处理模块连接，所述数据处理模块与所述数据接口模块连接，智能家居控制模块通过所述数据接口模块与所述大数据分析平台进行通信，所述智能家居控制模块包括存储单元，用于存储从所述大数据分析平台获取的相关信息，所述智能家居控制模块作为用户智能家居的智能路由与全部的智能家居设备连接，所述智能家居设备在获取到用户的环境参数后将所述环境参数发送至所述智能家居控制模块，所述系统包括：大数据分析数据源，所述大数据分析数据源为通过大数据爬取及用户数据上传导入、和应用环境监控自动采集的相关数据，对所述大数据分析数据源进行存取优化，根据数据产生和调用的频率不同可以分为冷数据、温数据和热数据，其中，所述冷数据用于存储用户中智能家居设备的网络拓扑结构、用户签订合约文件，温数据存储对于不同智能家居设备的模拟控制方案、用户在不同的环境参数下对于所述智能家居设备的历史控制数据，热数据存储用户的实时环境参数；数据处理模块，通过所述数据处理模块对大数据分析数据源的数据进行处理，通过基于大数据技术的ETL对所述大数据分析数据源的数据进行处理和转换，对于不同类型的数据根据数据的特点选择存储方式，其中所述存储方式包括关系型数据库存储或基于Hadoop的大数据分布式存储；数据接口模块，大数据分析平台通过将所述数据处理模块中的数据通过封装成接口统一为智能家居应用模块提供数据，智能家居通过传感器记录当前用户的环境参数，根据所述环境参数的变化速率决定查询相关数据的方式，其中所述查询相关数据的方式为通过指标、二维表的查询访问或者是基于Hadoop的实时查询引擎进行查询，当所述环境参数的变化速率小于第一预设值时，采用指标、二维表的查询访问进行数据查询，当所述环境参数的变化速率大于等于第一预设值时，采用基于Hadoop的实时查询引擎进行查询；智能家居控制模块，所述智能家居控制模块根据接收到的智能家居通过传感器采集到的环境数据，根据由环境变化速率决定的查询方式，查询对当前环境参数的智能家居建议控制方式，所述建议控制方式为大数据分析平台根据采集的针对于不同环境参数的大量用户控制数据及对于不同环境生成的模拟控制方案中挑选出符合当前用户采集到的环境数据中的方案；终端控制模块，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，以问询的形式向用户进行语音推荐控制方案，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，直接通过针对于当前用户行为习惯构建的知识图谱对提供的方案进行挑选并直接执行。更进一步地，所述数据处理模块进一步包括：将调用频率高的部分温数据及热数据通过关系型数据库进行存储，根据不同的环境参数进行条目存储，对应于不同智能家居设备的模拟控制方案及用户的历史控制数据进行清洗、转换和存储。更进一步地，所述数据处理模块进一步包括：将调用频率低的冷数据及部分温数据采用基于Hadoop的分布式数据仓库进行存储，通过基于Hadoop的分布式数据仓库定期对热数据进行备份。更进一步地，所述构建的知识图谱进一步包括：统计相应的知识要素，所述相应知识要素包括用户控制智能设备的参数和环境参数的关系及概率，利用可追溯马尔科夫逻辑来构建相应的推理网，通过分布相似度法计算多个所述智能家居设备的控制参数和环境参数之间的关联度，利用K-Means聚类算法确定主要生成针对于该用户的相关标签，将所述标签进行标定后完善知识图谱。更进一步地，所述智能家居设备的拓扑网络包括传感器节点、汇聚节点和管理节点，其中，所述传感器节点根据测量目的和测量需求，分布于监测对象区域内采集所述环境参数，各个节点通过网络的自适应功能自动组织成网络，同时各个节点都具备收发数据的功能，并且采用路由方式将数据传输到汇聚节点，通过汇聚节点可以通过Internet互联网来实现远程管理节点或者与节点进行通信，管理节点则是负责将用户与网络连接起来，用户可以通过对管理节点的控制，来对整个网络进行配置，设定相关的监测任务或者查看相关监测数据，其中，所述智能家居控制模块作为网络拓扑结构中的汇聚节点和管理节点，当用户所处环境网络信号不好时，所述智能家居控制模块选择网络拓扑结构相似的其他用户的控制方案进行直接推荐。本发明还公开了一种基于大数据分析的模式切换的方法，所述方法应用于基于大数据分析的模式切换的系统中，其中，所述系统包括大数据分析平台及智能家居控制模块，所述大数据分析平台包括大数据分析数据源、数据处理模块及数据接口模块，所述大数据分析数据源与数据处理模块连接，所述数据处理模块与所述数据接口模块连接，智能家居控制模块通过所述数据接口模块与所述大数据分析平台进行通信，所述智能家居控制模块包括存储单元，用于存储从所述大数据分析平台获取的相关信息，所述智能家居控制模块作为用户智能家居的智能路由与全部的智能家居设备连接，所述智能家居设备在获取到用户的环境参数后将所述环境参数发送至所述智能家居控制模块，所述方法包括如下步骤：步骤1，通过大数据爬取及用户数据上传导入、和应用环境监控自动采集的相关数据，对所述大数据分析数据源进行存取优化，根据数据产生和调用的频率不同可以分为冷数据、温数据和热数据，其中，所述冷数据用于存储用户中智能家居设备的网络拓扑结构、用户签订合约文件，温数据存储对于不同智能家居设备的模拟控制方案、用户在不同的环境参数下对于所述智能家居设备的历史控制数据，热数据存储用户的实时环境参数；步骤2，对大数据分析数据源的数据进行处理，通过基于大数据技术的ETL对所述大数据分析数据源的数据进行处理和转换，对于不同类型的数据根据数据的特点选择存储方式，其中所述存储方式包括关系型数据库存储或基于Hadoop的大数据分布式存储；步骤3，大数据分析平台通过将所述数据处理模块中的数据通过封装成接口统一为智能家居应用模块提供数据，智能家居通过传感器记录当前用户的环境参数，根据所述环境参数的变化速率决定查询相关数据的方式，其中所述查询相关数据的方式为通过指标、二维表的查询访问或者是基于Hadoop的实时查询引擎进行查询，当所述环境参数的变化速率小于第一预设值时，采用指标、二维表的查询访问进行数据查询，当所述环境参数的变化速率大于等于第一预设值时，采用基于Hadoop的实时查询引擎进行查询；步骤4，根据接收到的智能家居通过传感器采集到的环境数据，根据由环境变化速率决定的查询方式，查询对当前环境参数的智能家居建议控制方式，所述建议控制方式为大数据分析平台根据采集的针对于不同环境参数的大量用户控制数据及对于不同环境生成的模拟控制方案中挑选出符合当前用户采集到的环境数据中的方案；步骤5，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，以问询的形式向用户进行语音推荐控制方案，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，直接通过针对于当前用户行为习惯构建的知识图谱对提供的方案进行挑选并直接执行。更进一步地，所述步骤2进一步包括：将调用频率高的部分温数据及热数据通过关系型数据库进行存储，根据不同的环境参数进行条目存储，对应于不同智能家居设备的模拟控制方案及用户的历史控制数据进行清洗、转换和存储。更进一步地，所述步骤2进一步包括：将调用频率低的冷数据及部分温数据采用基于Hadoop的分布式数据仓库进行存储。更进一步地，所述构建的知识图谱进一步包括：统计相应的知识要素，所述相应知识要素包括用户控制智能设备的参数和环境参数的关系及概率，利用可追溯马尔科夫逻辑来构建相应的推理网，通过分布相似度法计算多个所述智能家居设备的控制参数和环境参数之间的关联度，利用K-Means聚类算法确定主要生成针对于该用户的相关标签，将所述标签进行标定后完善知识图谱。更进一步地，所述智能家居设备的拓扑网络包括传感器节点、汇聚节点和管理节点，其中，所述传感器节点根据测量目的和测量需求，分布于监测对象区域内采集所述环境参数，各个节点通过网络的自适应功能自动组织成网络，同时各个节点都具备收发数据的功能，并且采用路由方式将数据传输到汇聚节点，通过汇聚节点可以通过Internet互联网来实现远程管理节点或者与节点进行通信，管理节点则是负责将用户与网络连接起来，用户可以通过对管理节点的控制，来对整个网络进行配置，设定相关的监测任务或者查看相关监测数据，其中，所述智能家居控制模块作为网络拓扑结构中的汇聚节点和管理节点，当用户所处环境网络信号不好时，所述智能家居控制模块选择网络拓扑结构相似的其他用户的控制方案进行直接推荐。本发明与现有技术相比，本发明的有益效果是：现有的智能家居控制方法较为简单，通常采用针对于环境参数的直接控制，而不能对不同用户进行区分，同时，如果进行网络控制分析时，查询方案的方式单一，不能针对于不同的环境参数变化采用不同的查询方式，导致调整智能家居的速度不尽如人意，本发明则改进了上述的问题，通过对使用者进行了区分，同时设置大数据分析的方式获取较佳的控制方案，同时设置了多种速度的控制方法，使得用户不会认为智能家居控制千篇一律，控制方式单一。附图说明从以下结合附图的描述可以进一步理解本发明。图中的部件不一定按比例绘制，而是将重点放在示出实施例的原理上。在图中，在不同的视图中，相同的附图标记指定对应的部分。图1是本发明的一种基于大数据分析的模式切换的方法的流程图。具体实施方式下面将结合附图及实施例对本发明的技术方案进行更详细的说明。现在将参考附图描述实现本发明各个实施例的移动终端。在后续的描述中，使用用于表示元件的诸如“模块”、“部件”或“单元”的后缀仅为了有利于本发明的说明，其本身并没有特定的意义。因此，"模块"与"部件"可以混合地使用。移动终端可以以各种形式来实施。例如，本发明中描述的终端可以包括诸如移动电话、智能电话、笔记本电脑、数字广播接收器、PDA、PAD、PMP、导航装置等等的移动终端以及诸如数字TV、台式计算机等等的固定终端。下面，假设终端是移动终端。然而，本领域技术人员将理解的是，除了特别用于移动目的的元件之外，根据本发明的实施方式的构造也能够应用于固定类型的终端。实施例一本实施例中，对于智能家居的控制方式具有多种模式，如图1所示的一种基于大数据分析的模式切换的方法，所述方法应用于基于大数据分析的模式切换的系统中，其中，所述系统包括大数据分析平台及智能家居控制模块，所述大数据分析平台包括大数据分析数据源、数据处理模块及数据接口模块，所述大数据分析数据源与数据处理模块连接，所述数据处理模块与所述数据接口模块连接，智能家居控制模块通过所述数据接口模块与所述大数据分析平台进行通信，所述智能家居控制模块包括存储单元，用于存储从所述大数据分析平台获取的相关信息，所述智能家居控制模块作为用户智能家居的智能路由与全部的智能家居设备连接，所述智能家居设备在获取到用户的环境参数后将所述环境参数发送至所述智能家居控制模块，所述方法包括如下步骤：步骤1，通过大数据爬取及用户数据上传导入、和应用环境监控自动采集的相关数据，对所述大数据分析数据源进行存取优化，根据数据产生和调用的频率不同可以分为冷数据、温数据和热数据，其中，所述冷数据用于存储用户中智能家居设备的网络拓扑结构、用户签订合约文件，温数据存储对于不同智能家居设备的模拟控制方案、用户在不同的环境参数下对于所述智能家居设备的历史控制数据，热数据存储用户的实时环境参数；步骤2，对大数据分析数据源的数据进行处理，通过基于大数据技术的ETL对所述大数据分析数据源的数据进行处理和转换，对于不同类型的数据根据数据的特点选择存储方式，其中所述存储方式包括关系型数据库存储或基于Hadoop的大数据分布式存储；步骤3，大数据分析平台通过将所述数据处理模块中的数据通过封装成接口统一为智能家居应用模块提供数据，智能家居通过传感器记录当前用户的环境参数，根据所述环境参数的变化速率决定查询相关数据的方式，其中所述查询相关数据的方式为通过指标、二维表的查询访问或者是基于Hadoop的实时查询引擎进行查询，当所述环境参数的变化速率小于第一预设值时，采用指标、二维表的查询访问进行数据查询，当所述环境参数的变化速率大于等于第一预设值时，采用基于Hadoop的实时查询引擎进行查询；步骤4，根据接收到的智能家居通过传感器采集到的环境数据，根据由环境变化速率决定的查询方式，查询对当前环境参数的智能家居建议控制方式，所述建议控制方式为大数据分析平台根据采集的针对于不同环境参数的大量用户控制数据及对于不同环境生成的模拟控制方案中挑选出符合当前用户采集到的环境数据中的方案；步骤5，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，以问询的形式向用户进行语音推荐控制方案，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，直接通过针对于当前用户行为习惯构建的知识图谱对提供的方案进行挑选并直接执行。更进一步地，所述步骤2进一步包括：将调用频率高的部分温数据及热数据通过关系型数据库进行存储，根据不同的环境参数进行条目存储，对应于不同智能家居设备的模拟控制方案及用户的历史控制数据进行清洗、转换和存储。更进一步地，所述步骤2进一步包括：将调用频率低的冷数据及部分温数据采用基于Hadoop的分布式数据仓库进行存储。更进一步地，所述构建的知识图谱进一步包括：统计相应的知识要素，所述相应知识要素包括用户控制智能设备的参数和环境参数的关系及概率，利用可追溯马尔科夫逻辑来构建相应的推理网，通过分布相似度法计算多个所述智能家居设备的控制参数和环境参数之间的关联度，利用K-Means聚类算法确定主要生成针对于该用户的相关标签，将所述标签进行标定后完善知识图谱。更进一步地，所述智能家居设备的拓扑网络包括传感器节点、汇聚节点和管理节点，其中，所述传感器节点根据测量目的和测量需求，分布于监测对象区域内采集所述环境参数，各个节点通过网络的自适应功能自动组织成网络，同时各个节点都具备收发数据的功能，并且采用路由方式将数据传输到汇聚节点，通过汇聚节点可以通过Internet互联网来实现远程管理节点或者与节点进行通信，管理节点则是负责将用户与网络连接起来，用户可以通过对管理节点的控制，来对整个网络进行配置，设定相关的监测任务或者查看相关监测数据，其中，所述智能家居控制模块作为网络拓扑结构中的汇聚节点和管理节点，当用户所处环境网络信号不好时，所述智能家居控制模块选择网络拓扑结构相似的其他用户的控制方案进行直接推荐。实施例二本实施例从硬件角度对本发明构思进行阐述，一种基于大数据分析的模式切换的系统，其特征在于，所述系统包括大数据分析平台及智能家居控制模块，所述大数据分析平台包括大数据分析数据源、数据处理模块及数据接口模块，所述大数据分析数据源与数据处理模块连接，所述数据处理模块与所述数据接口模块连接，智能家居控制模块通过所述数据接口模块与所述大数据分析平台进行通信，所述智能家居控制模块包括存储单元，用于存储从所述大数据分析平台获取的相关信息，所述智能家居控制模块作为用户智能家居的智能路由与全部的智能家居设备连接，所述智能家居设备在获取到用户的环境参数后将所述环境参数发送至所述智能家居控制模块，所述系统包括：大数据分析数据源，所述大数据分析数据源为通过大数据爬取及用户数据上传导入、和应用环境监控自动采集的相关数据，对所述大数据分析数据源进行存取优化，根据数据产生和调用的频率不同可以分为冷数据、温数据和热数据，其中，所述冷数据用于存储用户中智能家居设备的网络拓扑结构、用户签订合约文件，温数据存储对于不同智能家居设备的模拟控制方案、用户在不同的环境参数下对于所述智能家居设备的历史控制数据，热数据存储用户的实时环境参数；数据处理模块，通过所述数据处理模块对大数据分析数据源的数据进行处理，通过基于大数据技术的ETL对所述大数据分析数据源的数据进行处理和转换，对于不同类型的数据根据数据的特点选择存储方式，其中所述存储方式包括关系型数据库存储或基于Hadoop的大数据分布式存储；数据接口模块，大数据分析平台通过将所述数据处理模块中的数据通过封装成接口统一为智能家居应用模块提供数据，智能家居通过传感器记录当前用户的环境参数，根据所述环境参数的变化速率决定查询相关数据的方式，其中所述查询相关数据的方式为通过指标、二维表的查询访问或者是基于Hadoop的实时查询引擎进行查询，当所述环境参数的变化速率小于第一预设值时，采用指标、二维表的查询访问进行数据查询，当所述环境参数的变化速率大于等于第一预设值时，采用基于Hadoop的实时查询引擎进行查询；智能家居控制模块，所述智能家居控制模块根据接收到的智能家居通过传感器采集到的环境数据，根据由环境变化速率决定的查询方式，查询对当前环境参数的智能家居建议控制方式，所述建议控制方式为大数据分析平台根据采集的针对于不同环境参数的大量用户控制数据及对于不同环境生成的模拟控制方案中挑选出符合当前用户采集到的环境数据中的方案；终端控制模块，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，以问询的形式向用户进行语音推荐控制方案，当监测到环境参数的变化速率小于第一预设值且无用户控制行为时，直接通过针对于当前用户行为习惯构建的知识图谱对提供的方案进行挑选并直接执行。更进一步地，所述数据处理模块进一步包括：将调用频率高的部分温数据及热数据通过关系型数据库进行存储，根据不同的环境参数进行条目存储，对应于不同智能家居设备的模拟控制方案及用户的历史控制数据进行清洗、转换和存储。更进一步地，所述数据处理模块进一步包括：将调用频率低的冷数据及部分温数据采用基于Hadoop的分布式数据仓库进行存储，通过基于Hadoop的分布式数据仓库定期对热数据进行备份。更进一步地，所述构建的知识图谱进一步包括：统计相应的知识要素，所述相应知识要素包括用户控制智能设备的参数和环境参数的关系及概率，利用可追溯马尔科夫逻辑来构建相应的推理网，通过分布相似度法计算多个所述智能家居设备的控制参数和环境参数之间的关联度，利用K-Means聚类算法确定主要生成针对于该用户的相关标签，将所述标签进行标定后完善知识图谱。更进一步地，所述智能家居设备的拓扑网络包括传感器节点、汇聚节点和管理节点，其中，所述传感器节点根据测量目的和测量需求，分布于监测对象区域内采集所述环境参数，各个节点通过网络的自适应功能自动组织成网络，同时各个节点都具备收发数据的功能，并且采用路由方式将数据传输到汇聚节点，通过汇聚节点可以通过Internet互联网来实现远程管理节点或者与节点进行通信，管理节点则是负责将用户与网络连接起来，用户可以通过对管理节点的控制，来对整个网络进行配置，设定相关的监测任务或者查看相关监测数据，其中，所述智能家居控制模块作为网络拓扑结构中的汇聚节点和管理节点，当用户所处环境网络信号不好时，所述智能家居控制模块选择网络拓扑结构相似的其他用户的控制方案进行直接推荐。在本实施例中，使用无线通信技术和以太网通信代替有线连接的组合。智能家居系统根据数据传输的不同可以分为两类：高速传输大量数据和低速少量的数据传输。其中，报警信号、控制命令、环境信息和其他数据传输的频率较低，不要求速度，如果你使用以太网通信技术会造成浪费带宽和能源的浪费，节能无线技术是一种无线通信技术的智能家居系统；视频监控、多媒体娱乐等服务需要高速传输大量的数据，普通家庭使用以太网电缆传输，同时，以太网的无线互联网接入接口，可以确保实现远程监控功能，因为以太网带宽特性满足智能家居系统数据传输需求，不会形成障碍。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。本领域技术人员应明白，本申请的实施例可提供为方法、系统或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。虽然上面已经参考各种实施例描述了本发明，但是应当理解，在不脱离本发明的范围的情况下，可以进行许多改变和修改。因此，其旨在上述详细描述被认为是例示性的而非限制性的，并且应当理解，以下权利要求旨在限定本发明的精神和范围。以上这些实施例应理解为仅用于说明本发明而不用于限制本发明的保护范围。在阅读了本发明的记载的内容之后，技术人员可以对本发明作各种改动或修改，这些等效变化和修饰同样落入本发明权利要求所限定的范围。
