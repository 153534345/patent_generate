标题title
屏幕隐形水印嵌入程序测试样本制作方法以及测试方法
摘要abst
本发明特别涉及一种屏幕隐形水印嵌入程序测试样本制作方法以及测试方法，该制作方法包括如下步骤：在屏幕上显示待拍摄内容，并为其添加上隐形水印；拍摄屏幕显示内容得到拍屏图；提取拍屏图中屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签；拍屏图及其标签即构成一个样本。通过引入最小内角这个概念，使得样本在拍摄时，无需关注拍摄角度，直接根据拍屏图去计算该四边形的最小内角，并以此最小内角作为拍屏图的标签，每个最小内角分别对应一个拍摄角度，最小内角越接近90度，拍摄角度越接近于0；当采用最小内角作为标签，拍摄屏幕图像时不用刻意的去调整拍摄角度，也无需记录，减少了样本制作步骤和时间。
权利要求书clms
1.一种屏幕隐形水印嵌入程序测试样本制作方法，其特征在于：包括如下步骤：在屏幕上显示待拍摄内容，并为其添加上隐形水印；拍摄屏幕显示内容得到拍屏图；提取拍屏图中屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签；拍屏图及其标签即构成一个样本。2.如权利要求1所述的屏幕隐形水印嵌入程序测试样本制作方法，其特征在于：所述的提取拍屏图中的屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签包括如下步骤：提取拍屏图中屏幕区域的四个顶角或四条直边或屏幕热图；根据四个顶角或四条直边或屏幕热图确定屏幕区域构成的四边形；计算该四边形的最小内角；计算该四边形的面积与拍屏图面积的比值得到屏占比；将最小内角和屏占比作为拍屏图的标签。3.如权利要求1所述的屏幕隐形水印嵌入程序测试样本制作方法，其特征在于：所述的在屏幕上显示待拍摄内容包括如下步骤：从文件库中打开一个文件使其显示在屏幕上，文件库中包括网页、文档、图片、视频、设计图纸中的一项或多项；自动调节屏幕分辨率、屏幕亮度以及屏幕对比度；将文件种类、显示器型号、屏幕分辨率、屏幕亮度以及屏幕对比度作为第一标签保存；当前时刻记为T1，至下一次文件种类、显示器型号、屏幕分辨率、屏幕亮度以及屏幕对比度任一项参数发生改变的时刻记为T2；得到拍屏图后，为拍摄时间在T1至T2之间的拍屏图添加第一标签。4.如权利要求1所述的屏幕隐形水印嵌入程序测试样本制作方法，其特征在于：所述的拍摄屏幕显示内容得到拍屏图包括如下步骤：将手机通过手机支架固定安装在屏幕前方；调节手机的拍摄参数；通过控制手机支架调节手机与屏幕的距离和角度；自动控制手机拍摄屏幕显示内容得到拍屏图；将手机型号、手机拍摄参数作为拍屏图的标签。5.如权利要求1所述的屏幕隐形水印嵌入程序测试样本制作方法，其特征在于：所述的拍屏图及其标签即构成一个样本包括如下步骤：拍屏图及其标签构成原始样本；对原始样本进行格式转换、鲁棒性攻击后得到新的样本，并将转换后的格式、鲁棒性攻击参数添加到新的样本的标签中。6.一种屏幕隐形水印嵌入程序测试样本制作系统，其特征在于：包括客户端和手机，所述的客户端为安装在计算机或工控机上的程序，客户端包括屏幕显示控制模块、水印添加模块、图像处理模块以及样本存储模块；屏幕显示控制模块用于控制屏幕上显示的待拍摄内容；水印添加模块用于在屏幕上添加隐形水印；手机用于拍摄屏幕显示内容得到拍屏图并将拍屏图发送给图像处理模块，图像处理模块用于提取拍屏图中屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签；样本存储模块，用于保存拍屏图及其标签。7.如权利要求6所述的屏幕隐形水印嵌入程序测试样本制作系统，其特征在于：所述的图像处理模块包括屏幕识别单元、角度计算单元、屏占比计算单元；屏幕识别单元用于提取拍屏图中屏幕区域的四个顶角或四条直边或屏幕热图，并根据四个顶角或四条直边或屏幕热图确定屏幕区域构成的四边形；角度计算单元用于计算该四边形的最小内角，屏占比计算单元用于计算该四边形的屏占比并将屏占比作为拍屏图的标签，其中屏占比等于该四边形的面积与拍屏图面积的比值。8.如权利要求6所述的屏幕隐形水印嵌入程序测试样本制作系统，其特征在于：包括用于安放手机的手机支架，所述的客户端中设置有支架调节模块、自动拍照模块以及图像增强模块；支架调节模块发出指令控制手机支架动作用于调节手机与屏幕的距离和角度；自动拍照模块用于控制手机按照指定的拍照参数进行拍照，并将手机型号、手机拍摄参数作为拍屏图的标签；图像增强模块用于对已存储的原始样本进行格式转换、鲁棒性攻击后得到新的样本，并将转换后的格式、鲁棒性攻击参数作为新的样本的标签，图像增强模块还将新的样本及其标签发送至样本存储模块；所述的屏幕显示控制模块包括文件库、文件选择单元、屏幕分辨率调节单元、屏幕亮度调节单元、屏幕对比度调节单元；文件库用于保存网页、文档、图片、视频、设计图纸中的一项或多项；文件选择单元用于从文件库中打开一个文件使其显示在屏幕上并将所选的文件种类作为拍屏图标签发送至样本存储模块；屏幕分辨率调节单元、屏幕亮度调节单元、屏幕对比度调节单元分别用于调节计算机屏幕的分辨率、亮度、对比度，并将分辨率、亮度、对比度作为拍屏图标签。9.一种屏幕隐形水印嵌入程序测试方法，其特征在于：包括如下步骤：根据权利要求1中的步骤生成多个样本，选择满足测试要求的标签所对应的拍屏图得到测试集；对测试集进行隐形水印提取并根据提取结果计算该隐形水印的溯源成功率。10.如权利要求9所述的屏幕隐形水印嵌入程序测试方法，其特征在于：所述根据权利要求1中的步骤生成多个样本的步骤中，每个样本的标签还包括：屏占比、文件种类、显示器型号、屏幕分辨率、屏幕亮度、屏幕对比度、手机型号、手机拍摄参数中的一种或多种；所述的屏占比即四边形的面积与拍屏图面积的比值，文件种类即显示器上所显示内容的类别，文件种类为网页、文档、图片、视频、设计图纸中的任一项。
说明书desc
技术领域本发明涉及样本制作技术领域，特别涉及一种屏幕隐形水印嵌入程序测试样本制作方法、系统以及测试方法。背景技术随着各种智能设备的普及，拍摄屏幕和录制屏幕变得非常的便捷，因此个人和企事业单位办公电脑的资产安全面临着严峻的挑战，对于拍摄屏幕或者录制屏幕造成的泄密问题，相关单位不易察觉，并且无法追踪溯源，给失泄密的个人及企事业单位带来难以估计的损失。因此，一种稳定可靠的失泄密防护追溯系统就变得愈加重要，屏幕隐形水印技术的出现为上述问题的解决带来了可能，其通过在屏幕上添加不可见的跨媒介隐形水印，当出现拍摄屏幕或者录制屏幕造成的泄密时，能够从拍屏图或录制的视频中提取出相应的溯源信息。隐形水印嵌入程序在开发或升级时，都需要进行测试，以准确的判断其性能指标，比如溯源成功率、准确率等。由于该程序的特殊性，针对每一个待测试的隐形水印嵌入程序，都需要重新制造样本集，同时，拍摄角度对其性能指标影响较大，因此需要在制造样本的时候需要记录下所拍摄屏幕图片的拍摄角度。当前，我们一般按照如下步骤来制造样本：打开计算机，在屏幕上显示待拍摄内容；启动隐形水印嵌入程序，让屏幕上铺设有隐形水印；通过支架让手机位于指定的角度上，拍摄屏幕图像，并记录下当前角度和图像名称；调整屏幕内容，完成多张图片拍摄；调整手机角度，完成其他角度的多个样本采集。该步骤中，需要不停的调节拍摄角度，并且还需要人工记录，操作起来非常繁琐，样本采集速度很慢。发明内容本发明的首要目的在于提供一种屏幕隐形水印嵌入程序测试样本制作方法，能够快速的制作测试样本。为实现以上目的，本发明采用的技术方案为：一种屏幕隐形水印嵌入程序测试样本制作方法，包括如下步骤：在屏幕上显示待拍摄内容，并为其添加上隐形水印；拍摄屏幕显示内容得到拍屏图；提取拍屏图中屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签；拍屏图及其标签即构成一个样本。本发明的另一个目的在于提供一种屏幕隐形水印嵌入程序测试样本制作系统，能够快速的制作测试样本。为实现以上目的，本发明采用的技术方案为：一种屏幕隐形水印嵌入程序测试样本制作系统，包括客户端和手机，所述的客户端为安装在计算机或工控机上的程序，客户端包括屏幕显示控制模块、水印添加模块、图像处理模块以及样本存储模块；屏幕显示控制模块用于控制屏幕上显示的待拍摄内容；水印添加模块用于在屏幕上添加隐形水印；手机用于拍摄屏幕显示内容得到拍屏图并将拍屏图发送给图像处理模块，图像处理模块用于提取拍屏图中屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签；样本存储模块，用于保存拍屏图及其标签。与现有技术相比，本发明存在以下技术效果：通过引入最小内角这个概念，使得样本在拍摄时，无需关注拍摄角度，直接根据拍屏图中屏幕区域构成的四边形去计算该四边形的最小内角，并以此最小内角作为拍屏图的标签，每个最小内角分别对应一个拍摄角度，最小内角越接近90度，拍摄角度越接近于0；当采用最小内角作为标签，拍摄屏幕图像时不用刻意的去调整拍摄角度，也无需记录，减少了样本制作步骤和时间。本发明的另一个目的在于提供一种屏幕隐形水印嵌入程序测试方法，能够方便、快速的按照测试要求对隐形水印嵌入程序进行测试。为实现以上目的，本发明采用的技术方案为：一种屏幕隐形水印嵌入程序测试方法，包括如下步骤：根据屏幕隐形水印嵌入程序测试样本制作方法生成多个样本，选择满足测试要求的标签所对应的拍屏图得到测试集；对测试集进行隐形水印提取并根据提取结果计算该隐形水印的溯源成功率。与现有技术相比，本发明存在以下技术效果：通过标签来管理所有样本，这样在测试时，就能根据测试要求选择出合适的样本，针对多种不同的测试需求，通过标签快速的筛选出可用于测试的样本，进而可以快速的实现隐形水印嵌入程序的测试。附图说明图1是本发明的流程示意图；图2是以最小内角和屏占比作为标签的流程示意图；图3是以文件种类和屏幕参数作为标签的流程示意图；图4是以手机型号和拍摄参数作为标签的流程示意图；图5是对原始样本进行数据增强的流程示意图；图6是本发明的结构示意图。具体实施方式下面结合图1至图6，对本发明做进一步详细叙述。参阅图1，本发明公开了一种屏幕隐形水印嵌入程序测试样本制作方法，包括如下步骤：在屏幕上显示待拍摄内容，并为其添加上隐形水印；拍摄屏幕显示内容得到拍屏图；提取拍屏图中屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签；拍屏图及其标签即构成一个样本。通过引入最小内角这个概念，使得样本在拍摄时，无需关注拍摄角度，直接根据拍屏图中屏幕区域构成的四边形去计算该四边形的最小内角，并以此最小内角作为拍屏图的标签，每个最小内角分别对应一个拍摄角度，最小内角越接近90度，拍摄角度越接近于0；当采用最小内角作为标签，拍摄屏幕图像时不用刻意的去调整拍摄角度，也无需记录，减少了样本制作步骤和时间。参阅图2，进一步地，所述的提取拍屏图中的屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签包括如下步骤：提取拍屏图中屏幕区域的四个顶角或四条直边或屏幕热图，屏幕区域的提取，根据不同的算法有不同的提取方式，有的是提取屏幕的四个顶角坐标，有的是提取屏幕的四个边框，还有的直接生成热力图，让屏幕区域和背景区域区别开，这些都是较为成熟的算法，我们只需要根据他们的输出确定屏幕区域即可。根据四个顶角或四条直边或屏幕热图确定屏幕区域构成的四边形，即：如果一开始提取的是四个顶角，就以这四个顶角作为四边形的四个顶角，如果一开始提取的是四条直边，就以这四条直边作为四边形的四条边，如果一开始提取的是屏幕热图，就根据热图计算四条直边，然后再根据四条直边确定四边形。计算该四边形的最小内角，四边形有四个内角，取其最小值即为最小内角；计算该四边形的面积与拍屏图面积的比值得到屏占比；将最小内角和屏占比作为拍屏图的标签。最小内角可以代替之前的拍摄角度，屏占比可以代替之前的拍摄距离，之所以不使用拍摄距离和拍摄角度这两个参数作为标签是因为在拍摄的时候，这两个参数需要精确的测量并还需要和拍摄的图片进行绑定，需要耗费更多的人力和时间成本；当使用最小内角和屏占比来作为标签时，这两个参数可以通过对拍屏图处理得到，无需拍摄时进行调节和记录，提高了样本制作的速度。并且，通过最小内角和屏占比的数值范围，也可以挑选出所需拍摄角度和拍摄距离的样本，因为最小内角和拍摄角度是一一对应的、屏占比和拍摄距离也是一一对应的。参阅图3，所述的在屏幕上显示待拍摄内容包括如下步骤：从文件库中打开一个文件使其显示在屏幕上，文件库中包括网页、文档、图片、视频、设计图纸中的一项或多项；自动调节屏幕分辨率、屏幕亮度以及屏幕对比度；将文件种类、显示器型号、屏幕分辨率、屏幕亮度以及屏幕对比度作为第一标签保存；当前时刻记为T1，至下一次文件种类、显示器型号、屏幕分辨率、屏幕亮度以及屏幕对比度任一项参数发生改变的时刻记为T2；得到拍屏图后，为拍摄时间在T1至T2之间的拍屏图添加第一标签。通过调节屏幕显示内容，可以测试不同文件格式、不同显示器以及不同的显示参数下隐形水印嵌入程序的溯源成功率，并且更多的标签，可以丰富样本数量。在实际的实施过程中，考虑到屏幕显示内容的设置出现在拍屏图出现之前，因此我们在屏幕上显示待拍摄内容并调节好显示参数后，记录下当前时刻T1，并将当前设置的文件种类、显示器型号、屏幕分辨率、屏幕亮度以及屏幕对比度作为第一标签存储起来，至这些内容发生改变时记录下时刻T2。如果拍屏图是在时刻T1至T2的时间段内拍摄的，那么说明这期间拍摄的屏幕图片，对应的文件种类、显示器型号、屏幕分辨率、屏幕亮度以及屏幕对比度就是第一标签中所记录的内容。参阅图4，所述的拍摄屏幕显示内容得到拍屏图包括如下步骤：将手机通过手机支架固定安装在屏幕前方；调节手机的拍摄参数；通过控制手机支架调节手机与屏幕的距离和角度；自动控制手机拍摄屏幕显示内容得到拍屏图；将手机型号、手机拍摄参数作为拍屏图的标签。在前面的方案中，我们可以手持相机不断调整角度和距离来拍摄屏幕图像，但这个过程需要人员的参与，为了进一步提高本方法的自动化，这里通过设置可调节角度和距离的手机支架，然后实现自动拍摄。通过设置控制程序，自动变换屏幕显示内容、自动变换手机位置、自动拍摄从而实现更多样本的自动获取，整个过程全自动，不再需要人员的参与。同时，这里对手机支架的调节，无需很高的精确度，因为我们不记录手机支架的拍摄角度和拍摄距离，而是直接根据拍屏图求取最小内角和屏占比，因此固定手机支架后，无需对支架和手机进行校准。参阅图5，进一步地，所述的拍屏图及其标签即构成一个样本包括如下步骤：拍屏图及其标签构成原始样本；对原始样本进行格式转换、鲁棒性攻击后得到新的样本，常见的图片格式有jpeg、bmp、png等，常见的鲁棒性攻击有压缩、下采样、旋转、变形等，并将转换后的格式、鲁棒性攻击参数添加到新的样本的标签中。这里添加了格式转换和鲁棒性攻击，就相当于对原始样本进行数据增强，以获得更多的样本，并且在实际进行溯源时，图片很可能不是原始的拍屏图了，都是经过格式转换或鲁棒性攻击处理的。参阅图6，本发明还公开了一种屏幕隐形水印嵌入程序测试样本制作系统，包括客户端和手机，所述的客户端为安装在计算机或工控机上的程序，客户端包括屏幕显示控制模块、水印添加模块、图像处理模块以及样本存储模块；屏幕显示控制模块用于控制屏幕上显示的待拍摄内容；水印添加模块用于在屏幕上添加隐形水印；手机用于拍摄屏幕显示内容得到拍屏图并将拍屏图发送给图像处理模块，图像处理模块用于提取拍屏图中屏幕区域构成的四边形，并将该四边形的最小内角作为拍屏图的标签；样本存储模块，用于保存拍屏图及其标签。这里的水印添加模块不一定非要集成在客户端中，也可以是其他独立的程序，本系统中的客户端可以通过接口直接调用。图像处理模块主要用于从拍屏图中提取最小内角，样本存储模块主要用于保存拍屏图及其标签。通过设置上述各模块，可以方便的实现样本的制作。进一步地，所述的图像处理模块包括屏幕识别单元、角度计算单元、屏占比计算单元；屏幕识别单元用于提取拍屏图中屏幕区域的四个顶角或四条直边或屏幕热图，并根据四个顶角或四条直边或屏幕热图确定屏幕区域构成的四边形；角度计算单元用于计算该四边形的最小内角，屏占比计算单元用于计算该四边形的屏占比并将屏占比作为拍屏图的标签，其中屏占比等于该四边形的面积与拍屏图面积的比值。设置多个单元，分别进行屏幕识别、角度计算、屏占比计算，可以更加方便的实现各个功能，当有部分功能需要升级时，比如有更好的屏幕识别算法，我们只需要调整屏幕识别单元即可，其他单元不受影响。进一步地，包括用于安放手机的手机支架，所述的客户端中设置有支架调节模块、自动拍照模块以及图像增强模块；支架调节模块发出指令控制手机支架动作用于调节手机与屏幕的距离和角度；自动拍照模块用于控制手机按照指定的拍照参数进行拍照，并将手机型号、手机拍摄参数作为拍屏图的标签；图像增强模块用于对已存储的原始样本进行格式转换、鲁棒性攻击后得到新的样本，并将转换后的格式、鲁棒性攻击参数作为新的样本的标签，图像增强模块还将新的样本及其标签发送至样本存储模块；所述的屏幕显示控制模块包括文件库、文件选择单元、屏幕分辨率调节单元、屏幕亮度调节单元、屏幕对比度调节单元；文件库用于保存网页、文档、图片、视频、设计图纸中的一项或多项；文件选择单元用于从文件库中打开一个文件使其显示在屏幕上并将所选的文件种类作为拍屏图标签发送至样本存储模块；屏幕分辨率调节单元、屏幕亮度调节单元、屏幕对比度调节单元分别用于调节计算机屏幕的分辨率、亮度、对比度，并将分辨率、亮度、对比度作为拍屏图标签。这里的优选方案，是将前述的方法进行模块化，设置各模块的目的和优点与前述关于方法的描述一致，这里就不再重复赘述。由于这里设置了样本存储模块对拍屏图及其标签进行了存储，我们还可以对其进行样本可视化管理，方便用户对存储的样本进行查看、筛选和修改。本发明还公开了一种屏幕隐形水印嵌入程序测试方法，包括如下步骤：根据前述的屏幕隐形水印嵌入程序测试样本制作方法生成多个样本，选择满足测试要求的标签所对应的拍屏图得到测试集；对测试集进行隐形水印提取并根据提取结果计算该隐形水印的溯源成功率。根据标签自动选择样本得到样本集，可以方便的对隐形水印嵌入程序进行测试。进一步地，所述根据前述的屏幕隐形水印嵌入程序测试样本制作方法生成多个样本的步骤中，每个样本的标签还包括：屏占比、文件种类、显示器型号、屏幕分辨率、屏幕亮度、屏幕对比度、手机型号、手机拍摄参数中的一种或多种；所述的屏占比即四边形的面积与拍屏图面积的比值，文件种类即显示器上所显示内容的类别，文件种类为网页、文档、图片、视频、设计图纸中的任一项。设置更多的标签，可以更精细化的按照测试要求选择测试样本，比如：我们需要检测屏幕上显示文档、屏幕分辨率高于800*600的情况下，隐形水印嵌入程序的溯源效果，我们就可以直接根据标签挑选出所有文件种类为文档、屏幕分辨率高于800*600的样本，然后利用这些样本进行测试，验证隐形水印嵌入程序的溯源效果。并且在验证以后，我们还能以样本的ID、标签、是否溯源成功作为表头建立表格，通过对表格中标签的筛选，快速得到满足其他条件下的溯源成功率，使得对屏幕隐形水印嵌入程序的检测变得更简单、更快速。
