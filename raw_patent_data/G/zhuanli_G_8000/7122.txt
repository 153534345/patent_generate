标题title
一种NFC防伪溯源方法及服务端
摘要abst
本发明公开了一种NFC防伪溯源方法及服务端，新增商品类别，为商品类别添加对应的客户并为客户绑定对应的商品，对商品建立对应的防伪界面，便于后续基于各关联关系进行商品溯源；将客户信息和防伪地址分别进行加密，能够得到密钥和NDEF格式链接，并将其写入NFC标签；在读取NFC标签时，对NFC标签中的密钥进行双向验证，若验证通过则通过所述NDEF格式链接展示防伪页面，因此对防伪地址进行加密并写入标签，后续不用专门登录验伪系统查询，提高防伪溯源的便捷性，并且读取NFC标签时需要对标签中的密钥进行双向验证，从而提高防伪溯源的安全性。
权利要求书clms
1.一种NFC防伪溯源方法，其特征在于，包括步骤：新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品；为所述商品建立对应的防伪页面，所述防伪页面中包括商品信息、客户信息和鉴伪信息；将所述客户信息进行加密得到密钥，将所述防伪页面的防伪地址进行加密得到NDEF格式链接；将所述密钥和所述NDEF格式链接写入NFC标签；读取所述NFC标签，对所述NFC标签中的密钥进行双向验证，判断所述密钥是否验证通过，若是，则通过所述NDEF格式链接展示防伪页面，否则返回错误页面。2.根据权利要求1所述的一种NFC防伪溯源方法，其特征在于，所述新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品包括：根据商品属性新增商品类别；为所述商品类别添加客户信息，为所述客户绑定对应的商品类别；为所述客户添加商品系列信息，并在每一个所述商品系列信息中添加对应的商品。3.根据权利要求1所述的一种NFC防伪溯源方法，其特征在于，将所述密钥和所述NDEF格式链接写入NFC标签包括：为NFC标签导入唯一标识码，为已导入所述唯一标识码的NFC标签写入所述密钥和所述NDEF格式链接；或者，限制NFC标签的数量，为预设个数的NFC标签写入所述密钥和所述NDEF格式链接。4.根据权利要求1所述的一种NFC防伪溯源方法，其特征在于，对所述NFC标签中的密钥进行双向验证包括：向所述NFC标签发送双向验证请求；接收所述NFC标签发送的唯一标识码和第一随机数；根据所述唯一标识码获取所述NFC标签对应的密钥，并使用所述密钥对所述第一随机数进行加密，得到第一加密随机数；生成第二随机数，将所述第一加密随机数和所述第二随机数经过所述密钥加密后得到的待验证数据发送至所述NFC标签；接收所述NFC标签对服务端认证通过后使用所述密钥对所述第二随机数加密得到的第二加密随机数，所述NFC标签对所述服务端认证通过为所述NFC标签使用所述密钥对第一随机数加密后得到的第一待验证随机数与解密所述待验证数据后得到的第一加密随机数的比对结果相同时，通过对所述服务端的认证；通过所述密钥将所述第二加密随机数解密后得到第二待验证随机数，将所述第二待验证随机数与所述第二随机数进行比对，若所述比对结果为相同，则对所述NFC标签的认证通过。5.根据权利要求1所述的一种NFC防伪溯源方法，其特征在于，通过所述NDEF格式链接展示防伪页面包括：获取NDEF格式链接，通过浏览器展示所述防伪页面。6.一种NFC防伪溯源服务端，包括存储器、处理器以及存储在所述存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现以下步骤：新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品；为所述商品建立对应的防伪页面，所述防伪页面中包括商品信息、客户信息和鉴伪信息；将所述客户信息进行加密得到密钥，将所述防伪页面的防伪地址进行加密得到NDEF格式链接；将所述密钥和所述NDEF格式链接写入NFC标签；读取所述NFC标签，对所述NFC标签中的密钥进行双向验证，判断所述密钥是否验证通过，若是，则通过所述NDEF格式链接展示防伪页面，否则返回错误页面。7.根据权利要求6所述的一种NFC防伪溯源服务端，其特征在于，所述新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品包括：根据商品属性新增商品类别；为所述商品类别添加客户信息，为所述客户绑定对应的商品类别；为所述客户添加商品系列信息，并在每一个所述商品系列信息中添加对应的商品。8.根据权利要求6所述的一种NFC防伪溯源服务端，其特征在于，将所述密钥和所述NDEF格式链接写入NFC标签包括：为NFC标签导入唯一标识码，为已导入所述唯一标识码的NFC标签写入所述密钥和所述NDEF格式链接；或者，限制NFC标签的数量，为预设个数的NFC标签写入所述密钥和所述NDEF格式链接。9.根据权利要求6所述的一种NFC防伪溯源服务端，其特征在于，对所述NFC标签中的密钥进行双向验证包括：向所述NFC标签发送双向验证请求；接收所述NFC标签发送的唯一标识码和第一随机数；根据所述唯一标识码获取所述NFC标签对应的密钥，并使用所述密钥对所述第一随机数进行加密，得到第一加密随机数；生成第二随机数，将所述第一加密随机数和所述第二随机数经过所述密钥加密后得到的待验证数据发送至所述NFC标签；接收所述NFC标签对服务端认证通过后使用所述密钥对所述第二随机数加密得到的第二加密随机数，所述NFC标签对所述服务端认证通过为所述NFC标签使用所述密钥对第一随机数加密后得到的第一待验证随机数与解密所述待验证数据后得到的第一加密随机数的比对结果相同时，通过对所述服务端的认证；通过所述密钥将所述第二加密随机数解密后得到第二待验证随机数，将所述第二待验证随机数与所述第二随机数进行比对，若所述比对结果为相同，则对所述NFC标签的认证通过。10.根据权利要求6所述的一种NFC防伪溯源服务端，其特征在于，通过所述NDEF格式链接展示防伪页面包括：获取NDEF格式链接，通过浏览器展示所述防伪页面。
说明书desc
技术领域本发明涉及商品防伪溯源技术领域，特别涉及一种NFC防伪溯源方法及服 务端。背景技术中国经济在飞速发展，老百姓的收入水平也在稳步提高，因此老百姓对生 活质量的追求也越来越高。但是近年来商品质量问题时有发生，其中食品安全 问题比如过期牛奶或者毒奶粉等，因其关系到老百姓切身的身体健康引起社会 各界的广泛关注，一度成为头条新闻和人们讨论的热点。中国经济的快速发展 在很大的程度上得益于越来越倾向市场化，但是由于市场各行业的竞争日趋激 烈，以及目前大量商品的质量良莠不齐，甚至有假冒伪劣商品在市场上流通， 这对老百姓的人身和财产安全造成了很大的威胁。政府和相关行业开始意识到对商品进行防伪溯源的重要性，各种各样的防 伪溯源技术陆续在市场上出现，例如：指纹防伪、激光防伪、数码防伪、印刷防伪和RFID防伪等。市场证明，这些技术的 使用之初是为了鉴别商品真伪的准确度，并在一定程度上稳定了市场经济秩序， 但是这些技术也存在明显的应用痛点。如表1所示的防伪技术优缺点对比。表1防伪技术优缺点对比因此目前使用上述防伪溯源技术，防伪溯源的安全性仍然较低。发明内容本发明所要解决的技术问题是：提供一种NFC防伪溯源方法及服务端，能 够提高防伪溯源的安全性。为了解决上述技术问题，本发明采用的技术方案为：一种NFC防伪溯源方法，包括步骤：新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品；为所述商品建立对应的防伪页面，所述防伪页面中包括商品信息、客户信 息和鉴伪信息；将所述客户信息进行加密得到密钥，将所述防伪页面的防伪地址进行加密 得到NDEF格式链接；将所述密钥和所述NDEF格式链接写入NFC标签；读取所述NFC标签，对所述NFC标签中的密钥进行双向验证，判断所述密 钥是否验证通过，若是，则通过所述NDEF格式链接展示防伪页面，否则返回 错误页面。为了解决上述技术问题，本发明采用的另一种技术方案为：一种NFC防伪溯源服务端，包括存储器、处理器以及存储在所述存储器上 并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现以 下步骤：新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品；为所述商品建立对应的防伪页面，所述防伪页面中包括商品信息、客户信 息和鉴伪信息；将所述客户信息进行加密得到密钥，将所述防伪页面的防伪地址进行加密 得到NDEF格式链接；将所述密钥和所述NDEF格式链接写入NFC标签；读取所述NFC标签，对所述NFC标签中的密钥进行双向验证，判断所述密 钥是否验证通过，若是，则通过所述NDEF格式链接展示防伪页面，否则返回 错误页面。本发明的有益效果在于：新增商品类别后，为商品类别添加对应的客户并 为客户绑定对应的商品，对商品建立对应的防伪界面，便于后续基于各关联关 系进行商品溯源；将客户信息和防伪地址分别进行加密，能够得到密钥和NDEF 格式链接，并将其写入NFC标签；在读取NFC标签时，对NFC标签中的密钥 进行双向验证，若验证通过则通过所述NDEF格式链接展示防伪页面，因此对 防伪地址进行加密并写入标签，后续不用专门登录验伪系统查询，提高防伪溯 源的便捷性，并且读取NFC标签时需要对标签中的密钥进行双向验证，从而提 高防伪溯源的安全性。附图说明图1为本发明实施例的一种NFC防伪溯源方法的流程图；图2为本发明实施例的一种NFC防伪溯源服务端的示意图；图3为本发明实施例的一种NFC防伪溯源方法的商品数据管理示意图。具体实施方式为详细说明本发明的技术内容、所实现目的及效果，以下结合实施方式并 配合附图予以说明。请参照图1和图3，本发明实施例提供了一种NFC防伪溯源方法，包括步 骤：新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品；为所述商品建立对应的防伪页面，所述防伪页面中包括商品信息、客户信 息和鉴伪信息；将所述客户信息进行加密得到密钥，将所述防伪页面的防伪地址进行加密 得到NDEF格式链接；将所述密钥和所述NDEF格式链接写入NFC标签；读取所述NFC标签，对所述NFC标签中的密钥进行双向验证，判断所述密 钥是否验证通过，若是，则通过所述NDEF格式链接展示防伪页面，否则返回 错误页面。从上述描述可知，本发明的有益效果在于：新增商品类别后，为商品类别 添加对应的客户并为客户绑定对应的商品，对商品建立对应的防伪界面，便于 后续基于各关联关系进行商品溯源；将客户信息和防伪地址分别进行加密，能 够得到密钥和NDEF格式链接，并将其写入NFC标签；在读取NFC标签时， 对NFC标签中的密钥进行双向验证，若验证通过则通过所述NDEF格式链接展 示防伪页面，因此对防伪地址进行加密并写入标签，后续不用专门登录验伪系 统查询，提高防伪溯源的便捷性，并且读取NFC标签时需要对标签中的密钥进 行双向验证，从而提高防伪溯源的安全性。进一步地，所述新增商品类别，为所述商品类别添加客户，并为所述客户 绑定对应的商品包括：根据商品属性新增商品类别；为所述商品类别添加客户信息，为所述客户绑定对应的商品类别；为所述客户添加商品系列信息，并在每一个所述商品系列信息中添加对应 的商品。由上述描述可知，在商品数据管理中，新增商品类别，并根据商品类别添 加对应的客户、商品系列和具体的商品信息，能够关联商品的各项信息，便于 商品信息的维护和溯源工作。进一步地，将所述密钥和所述NDEF格式链接写入NFC标签包括：为NFC标签导入唯一标识码，为已导入所述唯一标识码的NFC标签写入所 述密钥和所述NDEF格式链接；或者，限制NFC标签的数量，为预设个数的NFC标签写入所述密钥和所述 NDEF格式链接。由上述描述可知，在NFC标签发行前创建标签发行的规则，能够通过导入 NFC标签的唯一标识码，或者通过限制发行标签的数量，限制客户使用其他途 径购买的标签，保证标签发行的安全性。进一步地，对所述NFC标签中的密钥进行双向验证包括：向所述NFC标签发送双向验证请求；接收所述NFC标签发送的唯一标识码和第一随机数；根据所述唯一标识码获取所述NFC标签对应的密钥，并使用所述密钥对所 述第一随机数进行加密，得到第一加密随机数；生成第二随机数，将所述第一加密随机数和所述第二随机数经过所述密钥 加密后得到的待验证数据发送至所述NFC标签；接收所述NFC标签对服务端认证通过后使用所述密钥对所述第二随机数加 密得到的第二加密随机数，所述NFC标签对所述服务端认证通过为所述NFC 标签使用所述密钥对第一随机数加密后得到的第一待验证随机数与解密所述待 验证数据后得到的第一加密随机数的比对结果相同时，通过对所述服务端的认 证；通过所述密钥将所述第二加密随机数解密后得到第二待验证随机数，将所 述第二待验证随机数与所述第二随机数进行比对，若所述比对结果为相同，则 对所述NFC标签的认证通过。由上述描述可知，在服务端和NFC标签都是合法对应关系时，基于在NFC 标签上使用所述密钥对第一随机数加密后得到的第一待验证随机数与从服务端 获取到的待验证数据中的第一加密随机数实质上是相同的，因此，两者相同则 表示NFC标签对服务端的认证通过，同理，服务端上生成的第二随机数与从NFC 标签上得到的第二加密随机数所解密的第二待验证随机数对比相同时，则服务 端对NFC标签的认证通过，从而使得NFC标签和服务端之间建立双向验证，基 于双方对随机数进行加密和比对，能够提高防伪溯源的安全性能，使得数据的 安全性更高。进一步地，通过所述NDEF格式链接展示防伪页面包括：获取NDEF格式链接，通过浏览器展示所述防伪页面。由上述描述可知，通过浏览器展示NDEF格式链接对应的防伪页面，可直 接使用手机NFC功能，借助浏览器直接显示防伪信息，提高鉴伪的便捷性。请参照图2，本发明另一实施例提供了一种NFC防伪溯源服务端，包括存 储器、处理器以及存储在所述存储器上并可在处理器上运行的计算机程序，所 述处理器执行所述计算机程序时实现以下步骤：新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的商品；为所述商品建立对应的防伪页面，所述防伪页面中包括商品信息、客户信 息和鉴伪信息；将所述客户信息进行加密得到密钥，将所述防伪页面的防伪地址进行加密 得到NDEF格式链接；将所述密钥和所述NDEF格式链接写入NFC标签；读取所述NFC标签，对所述NFC标签中的密钥进行双向验证，判断所述密 钥是否验证通过，若是，则通过所述NDEF格式链接展示防伪页面，否则返回 错误页面。由上述描述可知，新增商品类别后，为商品类别添加对应的客户并为客户 绑定对应的商品，对商品建立对应的防伪界面，便于后续基于各关联关系进行 商品溯源；将客户信息和防伪地址分别进行加密，能够得到密钥和NDEF格式 链接，并将其写入NFC标签；在读取NFC标签时，对NFC标签中的密钥进行 双向验证，若验证通过则通过所述NDEF格式链接展示防伪页面，因此对防伪 地址进行加密并写入标签，后续不用专门登录验伪系统查询，提高防伪溯源的 便捷性，并且读取NFC标签时需要对标签中的密钥进行双向验证，从而提高防 伪溯源的安全性。进一步地，所述新增商品类别，为所述商品类别添加客户，并为所述客户 绑定对应的商品包括：根据商品属性新增商品类别；为所述商品类别添加客户信息，为所述客户绑定对应的商品类别；为所述客户添加商品系列信息，并在每一个所述商品系列信息中添加对应 的商品。由上述描述可知，在商品数据管理中，新增商品类别，并根据商品类别添 加对应的客户、商品系列和具体的商品信息，能够关联商品的各项信息，便于 商品信息的维护和溯源工作。进一步地，将所述密钥和所述NDEF格式链接写入NFC标签包括：为NFC标签导入唯一标识码，为已导入所述唯一标识码的NFC标签写入所 述密钥和所述NDEF格式链接；或者，限制NFC标签的数量，为预设个数的NFC标签写入所述密钥和所述 NDEF格式链接。由上述描述可知，在NFC标签发行前创建标签发行的规则，能够通过导入 NFC标签的唯一标识码，或者通过限制发行标签的数量，限制客户使用其他途 径购买的标签，保证标签发行的安全性。进一步地，对所述NFC标签中的密钥进行双向验证包括：向所述NFC标签发送双向验证请求；接收所述NFC标签发送的唯一标识码和第一随机数；根据所述唯一标识码获取所述NFC标签对应的密钥，并使用所述密钥对所 述第一随机数进行加密，得到第一加密随机数；生成第二随机数，将所述第一加密随机数和所述第二随机数经过所述密钥 加密后得到的待验证数据发送至所述NFC标签；接收所述NFC标签对服务端认证通过后使用所述密钥对所述第二随机数加 密得到的第二加密随机数，所述NFC标签对所述服务端认证通过为所述NFC 标签使用所述密钥对第一随机数加密后得到的第一待验证随机数与解密所述待 验证数据后得到的第一加密随机数的比对结果相同时，通过对所述服务端的认 证；通过所述密钥将所述第二加密随机数解密后得到第二待验证随机数，将所 述第二待验证随机数与所述第二随机数进行比对，若所述比对结果为相同，则 对所述NFC标签的认证通过。由上述描述可知，在服务端和NFC标签都是合法对应关系时，基于在NFC 标签上使用所述密钥对第一随机数加密后得到的第一待验证随机数与从服务端 获取到的待验证数据中的第一加密随机数实质上是相同的，因此，两者相同则 表示NFC标签对服务端的认证通过，同理，服务端上生成的第二随机数与从NFC 标签上得到的第二加密随机数所解密的第二待验证随机数对比相同时，则服务 端对NFC标签的认证通过，从而使得NFC标签和服务端之间建立双向验证，基 于双方对随机数进行加密和比对，能够提高防伪溯源的安全性能，使得数据的 安全性更高。进一步地，通过所述NDEF格式链接展示防伪页面包括：获取NDEF格式链接，通过浏览器展示所述防伪页面。由上述描述可知，通过浏览器展示NDEF格式链接对应的防伪页面，可直 接使用手机NFC功能，借助浏览器直接显示防伪信息，提高鉴伪的便捷性。本发明的一种NFC防伪溯源方法及服务端，适用于对商品进行防伪溯源， 提高防伪溯源的安全性，以下通过具体的实施方式进行说明：实施例一请参照图1和图3，一种NFC防伪溯源方法，包括步骤：S1、新增商品类别，为所述商品类别添加客户，并为所述客户绑定对应的 商品。其中，所述S1包括以下步骤：根据商品属性新增商品类别；为所述商品类别添加客户信息，为所述客户绑定对应的商品类别；为所述客户添加商品系列信息，并在每一个所述商品系列信息中添加对应 的商品。具体的，请参照图3，用户登录云数据管理端后，先判断输入的账号密码是 否正确，若正确则进入云数据管理端，否则返回错误页面；根据商品自身的属性新增商品类别，例如:白茶的类别为茶，绿茶的类别为 茶等；新增客户信息，为商品添加客户信息，并为客户绑定商品类别，其中，客 户信息包括厂家信息或者经销商的工商信息；为客户添加对应的发行账号和商品的系列信息，一个客户可以多个系列的 商品；因此，在本实施例的云数据管理端中，一个商品类别下有多个客户，一个 客户有多个商品系列，一个商品系列有多个商品。S2、为所述商品建立对应的防伪页面，所述防伪页面中包括商品信息、客 户信息和鉴伪信息。具体的，为商品建立防伪溯源模板，即防伪页面，防伪页面中包含商品信 息、客户信息和鉴伪信息，其中鉴伪信息是一张该商品为真品或赝品的图示， 并且能够在防伪页面中新增供货批次和导入供货标签。S3、将所述客户信息进行加密得到密钥，将所述防伪页面的防伪地址进行 加密得到NDEF格式链接。具体的，通过加密机对防伪地址进行加密，然后将加密得到的NDEF格式 链接写入到芯片中；同时还需要将经过加密的客户ID编码写入NFC芯片中， 因此用户不需要专门登录验伪系统查询，即可直接使用手机NFC功能，借助浏 览器直接出来防伪信息；在本实施例中，标签经过防撕处理，芯片里的ID与地址都是通过加密机国 密处理，在系统中有相应的记录，客户其他途径所买的标签是不可以使用的。S4、将所述密钥和所述NDEF格式链接写入NFC标签。其中，所述S4包括以下步骤：为NFC标签导入唯一标识码，为已导入所述唯一标识码的NFC标签写入所 述密钥和所述NDEF格式链接；或者，限制NFC标签的数量，为预设个数的NFC标签写入所述密钥和所述 NDEF格式链接。具体的，在本实施例中，创建标签发行规则，即通过导入NFC标签的UID 编码，限制客户使用其他途径购买的标签；当无法获取标签编码时，通过限制发行标签数量，限制客户使用其他途径 购买的标签。标签发行的具体流程为：登录标签发行端，判断输入的账号密码是否正确，如正确则进入标签发行 端，反之返回错误页面；获取客户的商品信息，根据客户信息从加密机获取KEY密钥；为NFC标签写入KEY密钥以及NDEF链接，并受标签发行规则限制。S5、读取所述NFC标签，对所述NFC标签中的密钥进行双向验证，判断 所述密钥是否验证通过，若是，则通过所述NDEF格式链接展示防伪页面，否 则返回错误页面。其中，为了防止标签被批量复制，安全认证采用了标签与防伪系统服务器 端相互认证的机制，只有由防伪系统平台商提供的防伪标签才能通过与系统服 务器端的相互认证，也只有合法的服务器端才能通过防伪标签的相互认证。NFC标签作为防伪系统不可或缺的组成部分，从应用的功能逻辑上看，芯 片中主要包含的信息有UID、EPC、产品信息、count、会话密钥、访问密文、 签名。1.UID是NFC芯片的unique ID，即芯片的唯一标识码，在出厂后不可更改。2.EPC是防伪标签对应的具体商品的唯一标示号。3.产品信息是指商品的详细描述信息。4.count是芯片中内置的计数器，每当被NFC设备扫描一次，count值加1。5.会话密钥被写入到NFC防伪标签内，用来加密要传输的数据和标签信 息。6.访问密文由会话密钥对通信两端要发送的信息加密得来。7.签名用来表示这个防伪标签是属于谁所有。其中，对所述NFC标签中的密钥进行双向验证包括：S51、向所述NFC标签发送双向验证请求；具体的，使用NFC手机向防伪标签发送相互认证请求。S52、接收所述NFC标签发送的唯一标识码和第一随机数；具体的，防伪标签接收到请求后，生成随机数RA，将RA与标签UID一起 发给服务器端。S53、根据所述唯一标识码获取所述NFC标签对应的密钥，并使用所述密 钥对所述第一随机数进行加密，得到第一加密随机数；具体的，服务器端根据UID和对应的主控密钥计算出会话密钥K，用K对 RA经加密算法E加密得出RA’。S54、生成第二随机数，将所述第一加密随机数和所述第二随机数经过所述 密钥加密后得到的待验证数据发送至所述NFC标签；具体的，服务端另外生成随机数RB，用会话密钥K经加密算法E对RA’ 和RB加密后得到待验证数据，将待验证数据发送给NFC标签。S55、接收所述NFC标签对服务端认证通过后使用所述密钥对所述第二随 机数加密得到的第二加密随机数，所述NFC标签对所述服务端认证通过为所述 NFC标签使用所述密钥对第一随机数加密后得到的第一待验证随机数与解密所 述待验证数据后得到的第一加密随机数的比对结果相同时，通过对所述服务端 的认证；具体的，标签收到密文后解码得出RA’和RB，用K和E对自己的RA进 行加密得到RA2，接收的RA’与自己加密得到的RA2比对，若相等则通过对 服务器端的认证；标签对收到的RB进行加密得出RB’，发送给服务器端。S56、通过所述密钥将所述第二加密随机数解密后得到第二待验证随机数， 将所述第二待验证随机数与所述第二随机数进行比对，若所述比对结果为相同， 则对所述NFC标签的认证通过。具体的，服务器端收到RB’后进行解密得出RB2，RB2与自己的RB比较， 若相同则通过服务器端对防伪标签的认证。在整个系统的应用场景中，由于NFC手机不是系统专门的NFC读写设备， 所以它只作为防伪标签和服务器端数据传输的媒介，所以认证过程是在NFC防 伪标签与系统服务器端进行。进行认证的某个NFC标签与服务器两端使用同一 个会话密钥K和相同的加密算法E，会话密钥K由加密算法对两端约定好的主 控密钥进行加密后得来，会话密钥K存储在标签中，用来对信息明文进行加密。其中，通过所述NDEF格式链接展示防伪页面包括：获取NDEF格式链接，通过浏览器展示所述防伪页面。具体的，在本实施例中，可通过带有NFC功能的Android设备近距离与NFC 标签进行配对，因为Android提供了底层NFC硬件与设备的协作支持，当用 带有NFC功能的Android设备靠近NFC标签时，平台会以一个Intent通知的方 式通知应用程序，并附带上标签的NDEF格式的信息。消费者用装有Android 防伪客户端的NFC手机扫描NFC标签对商品进行真伪鉴别。除了NDEF之外进行真伪鉴别之外，消费者主要使用标签验伪APP对商品 进行验伪，标签验伪APP有Android和iOS两个版本。实施例二请参照图2，一种NFC防伪溯源服务端，包括存储器、处理器以及存储在 所述存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机 程序时实现实施例一的一种NFC防伪溯源方法的各个步骤。综上所述，本发明提供的一种NFC防伪溯源方法及服务端，新增商品类别 后，为商品类别添加对应的客户并为客户绑定对应的商品，对商品建立对应的 防伪界面，其中，根据商品类别添加对应的客户、商品系列和具体的商品信息， 能够关联商品的各项信息，便于商品信息的维护和溯源工作；将客户信息和防 伪地址分别进行加密，能够得到密钥和NDEF格式链接，并将其写入NFC标签， 其中，通过导入NFC标签的唯一标识码，或者通过限制发行标签的数量，限制 客户使用其他途径购买的标签，保证标签发行的安全性；在读取NFC标签时， 对NFC标签中的密钥进行双向验证，若验证通过则通过所述NDEF格式链接展 示防伪页面，因此对防伪地址进行加密并写入标签，后续不用专门登录验伪系 统查询，提高防伪溯源的便捷性，并且读取NFC标签时需要对标签中的密钥进 行双向验证，从而提高防伪溯源的安全性。以上所述仅为本发明的实施例，并非因此限制本发明的专利范围，凡是利 用本发明说明书及附图内容所作的等同变换，或直接或间接运用在相关的技术 领域，均同理包括在本发明的专利保护范围内。
