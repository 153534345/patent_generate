标题title
小样本条件下的飞行器姿态控制数据增强和模型训练方法
摘要abst
本发明涉及一种小样本条件下的飞行器姿态控制数据增强和模型训练方法，包括：将飞行器姿态控制的训练集分解成多份子训练集；随机选取一份子训练集，训练第一生成器、第二生成器和第三生成器的神经网络参数；第一生成器、第二生成器和第三生成器分别依据各自的数据增强方式在神经网络模型中进行数据增强；计算出第一生成器、第二生成器和第三生成器在神经网络模型中的重要性权值；根据第一生成器、第二生成器和第三生成器的重要性权值，设置神经网络模型的目标函数；进行神经网络模型参数的训练；判断训练的迭代次数超过给定阈值；是，则终止训练；否，则重新选择子训练集进行训练。本发明提升了种小样本条件下神经网络模型的分类任务性能。
权利要求书clms
1.一种小样本条件下的飞行器姿态控制数据增强和模型训练方法，其特征在于，包括以下步骤：步骤S1、将飞行器姿态控制的训练集分解成多份子训练集；步骤S2、随机选取一份子训练集，训练第一生成器、第二生成器和第三生成器的神经网络参数；所述第一生成器、第二生成器和第三生成器分别依据各自的数据增强方式在神经网络模型中进行数据增强；步骤S3、计算出第一生成器、第二生成器和第三生成器在神经网络模型中的重要性权值；步骤S4、根据第一生成器、第二生成器和第三生成器的重要性权值，设置神经网络模型的目标函数；进行神经网络模型参数的训练；步骤S5、判断训练的迭代次数超过给定阈值；是，则终止训练；否，则返回到步骤S2。2.根据权利要求1所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，所述飞行器姿态控制的训练集其中n为训练集中数据个数，xi表示飞行器受力状态的6维向量，包括升力矢量、阻力矢量、法向过载、飞行器目前的偏航角、俯仰角和滚转角；yi为表示飞行器下一时刻姿态预测结果的6维向量，包括下一个时刻的偏航角、俯仰角和滚转角、PID控制中的比例增益P、积分时间常数Ti和微分时间常数Pd。3.根据权利要求2所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，对所述飞行器姿态控制的训练集采用平均分解的方式，分解成nt份子训练集；子训练集的形式为{}k,k＝1…nt。4.根据权利要求2所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，用于姿态预测的所述神经网络模型为f；神经网络模型中间层的输出是f′，其中θ为神经网络的参数；所述神经网络模型的分类任务训练过程等价于求解的优化问题；其中l,yi)为分类任务的交叉熵损失函数。5.根据权利要求4所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，训练所述第一生成器，用于使得生成器生成数据在原始空间中与真实数据距离较大；同时在神经网络模型中间层的输出与真实数据距离较小的数据；训练所述第二生成器，用于使得生成器生成数据在原始空间中与真实数据距离较小，同时关于神经网络的损失函数的梯度较大；训练所述第三生成器，用于使得生成器生成数据在与原始数据相近的前提下，使得神经网络模型输出的结果与理想数据结果距离较远。6.根据权利要求5所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，所述第一生成器G1的目标函数为；其中，α1为给定的权值参数；φ1为第一生成器的网络参数。7.根据权利要求5所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，所述第二生成器G2目标函数为:其中，Jl，y)为损失函数l，y)关于θ的Jacobian矩阵,α2为给定的权值参数，φ2为第二生成器的网络参数。8.根据权利要求5所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，所述第三生成器G3目标函数为:其中，l，y)为损失函数,α3为给定的权值参数，φ3为第三生成器的网络参数。9.根据权利要求6-8任一项所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，第一生成器G1、第二生成器G3和第三生成器G2的重要性权值w1i、w2i和w3i为：其中，Jl，y)为损失函数l，y)关于θ的Jacobian矩阵；i＝nk-1...nk。10.根据权利要求9所述的飞行器姿态控制数据增强和模型训练方法，其特征在于，训练神经网络模型f的参数θ，其目标函数如下:其中，c是给定的权值系数。
说明书desc
技术领域本发明涉及飞行器姿态控制技术领域及神经网络技术领域，尤其涉及一种小样本条件下的飞行器姿态控制数据增强和模型训练方法。背景技术随着航天技术的不断发展，飞行器己在众多领域得到越来越广泛的应用。飞行器姿态控制系统是飞行器控制中的重要组成部分，它关系着入轨后的飞行器能否较好的发挥效能。飞行器姿态控制系统是一个多变量、非线性、时变的复杂系统。传统飞行器姿态预测方法主要基于PID控制，PID控制虽然可以解决一般条件下的姿态控制问题，但是在飞行器受到较大干扰时会导致控制系统不稳定，需要较长的时间达到最优控制。把传统的控制与神经网络技术相结合，可以通过人工智能模型的优化提高对飞行器姿态的控制。但目前飞行器的飞行数据较为有限，尤其对于一些特殊用途飞行器，其飞行试验及实际应用数据更是不足以支撑现有的人工智能模型学习，使得人工智能模型的任务性能受到限制。但目前，基于数据增强的小样本学习方法缺乏有效的数据增强和模型训练准则。基于人工准则的数据增强方式虽然融合先验知识和数据结构信息，但是由于人工准则与机器学习模型结构的相容性具有不确定性，所以增强数据对人工智能模型性能提升效果受到限制。基于生成模型的数据增强方法利用变分自编码器与对抗生成网络等深度生成模型生成数据对源数据集进行数据增强。但是由于深度生成模型缺乏可解释性，因此生成的数据与人工智能模型结构的优化缺乏关联，因此对提升人工智能模型的任务性能具有不确定性。发明内容鉴于上述的分析，本发明旨在提供一种小样本条件下的飞行器姿态控制数据增强和模型训练方法，解决当人工智能模型的训练数据不足时，飞行器姿态控制任务性能受到限制问题。本发明提供的技术方案是：本发明公开了一种小样本条件下的飞行器姿态控制数据增强和模型训练方法，包括以下步骤：步骤S1、将飞行器姿态控制的训练集分解成多份子训练集；步骤S2、随机选取一份子训练集，训练第一生成器、第二生成器和第三生成器的神经网络参数；所述第一生成器、第二生成器和第三生成器分别依据各自的数据增强方式在神经网络模型中进行数据增强；步骤S3、计算出第一生成器、第二生成器和第三生成器在神经网络模型中的重要性权值；步骤S4、根据第一生成器、第二生成器和第三生成器的重要性权值，设置神经网络模型的目标函数；进行神经网络模型参数的训练；步骤S5、判断训练的迭代次数超过给定阈值；是，则终止训练；否，则返回到步骤S2。进一步地，所述飞行器姿态控制的训练集其中n为训练集中数据个数，xi表示飞行器受力状态的6维向量，包括升力矢量、阻力矢量、法向过载、飞行器目前的偏航角、俯仰角和滚转角；yi为表示飞行器下一时刻姿态预测结果的6维向量，包括下一个时刻的偏航角、俯仰角和滚转角、PID控制中的比例增益P、积分时间常数Ti和微分时间常数Pd。进一步地，对所述飞行器姿态控制的训练集采用平均分解的方式，分解成nt份子训练集；子训练集的形式为{}k,k＝1...nt。进一步地，用于姿态预测的所述神经网络模型为f；神经网络模型中间层的输出是f′，其中θ为神经网络的参数；所述神经网络模型的分类任务训练过程等价于求解的优化问题；其中l，yi)为分类任务的交叉熵损失函数。进一步地，训练所述第一生成器，用于使得生成器生成数据在原始空间中与真实数据距离较大；同时在神经网络模型中间层的输出与真实数据距离较小的数据；训练所述第二生成器，用于使得生成器生成数据在原始空间中与真实数据距离较小，同时关于神经网络的损失函数的梯度较大；训练所述第三生成器，用于使得生成器生成数据在与原始数据相近的前提下，使得神经网络模型输出的结果与理想数据结果距离较远。进一步地，所述第一生成器G1的目标函数为；其中，α1为给定的权值参数；φ1为第一生成器的网络参数。进一步地，所述第二生成器G2目标函数为：其中，Jl，y)为损失函数l，y)关于θ的Jacobian矩阵，α2为给定的权值参数，φ2为第二生成器的网络参数。进一步地，所述第三生成器G3目标函数为：其中，l，y)为损失函数，α3为给定的权值参数，φ3为第三生成器的网络参数。进一步地，第一生成器G1、第二生成器G3和第三生成器G2的重要性权值w1i、w2i和w3i为：其中，Jl，y)为损失函数l，y)关于θ的Jacobian矩阵；i＝nk-1...nk。进一步地，训练神经网络模型f的参数θ，其目标函数如下：其中，c是给定的权值系数。本发明的有益效果：本发明改进了基于生成模型的小样本数据增强方法。传统的生成模型生成的数据与神经网络模型结构的相容性具有不确定性，因此生成的增强数据对模型的影响性能有限。提出结合深度神经网络模型结构特点的三种数据增强方法和神经网络模型对增强数据的对抗训练方式，从不同角度克服神经网络模型在小样本条件下模型结构性能的退化现象，提升神经网络模型的分类任务性能。附图说明附图仅用于示出具体实施例的目的，而并不认为是对本发明的限制，在整个附图中，相同的参考符号表示相同的部件。图1为本发明实施例中飞行器姿态控制数据增强和模型训练方法流程图。具体实施方式下面结合附图来具体描述本发明的优选实施例，其中，附图构成本申请一部分，并与本发明的实施例一起用于阐释本发明的原理。本实施例公开了一种小样本条件下的飞行器姿态控制数据增强和模型训练方法，如图1所示，包括以下步骤：步骤S1、将飞行器姿态控制的训练集分解成多份子训练集；步骤S2、随机选取一份子训练集，训练第一生成器、第二生成器和第三生成器的神经网络参数；所述第一生成器、第二生成器和第三生成器中采用不同的增强数据的数据增强方式；步骤S3、通过训练计算出第一生成器、第二生成器和第三生成器在神经网络模型中的重要性权值；步骤S4、根据第一生成器、第二生成器和第三生成器的重要性权值，设置神经网络模型的目标函数；进行神经网络模型参数的训练；步骤S5、判断训练的迭代次数超过给定阈值；是，则终止；否，则返回到步骤S2。具体的，给定训练数据其中n为数据个数，xi表示飞行器受力状态的6维向量，主要包括升力矢量、阻力矢量、法向过载、飞行器目前的偏航角、俯仰角和滚转角，yi为表示飞行器下一时刻姿态预测结果的6维向量，主要包括下一个时刻的偏航角、俯仰角和滚转角、PID控制中的比例增益P、积分时间常数Ti和微分时间常数Pd。本实施例中，将训练集采用平均分解的方式，分解成nt份子训练集，子训练集的形式为：{}k,k＝1…nt。具体的，用于姿态预测的神经网络模型为f,神经网络中间特征层的输出是f′,其中θ为神经网络的参数；神经网络的分类任务训练过程等价于求解的优化问题；其中l，yi)为分类任务的交叉熵损失函数。基于本实施例的神经网络模型，当数据个数n较小时，f可能趋近于函数而导致模型性能的退化。因此，在训练数据较少时，需进行数据增强。具体的，步骤S2中，包括以下子步骤：步骤S2.1、训练所述第一生成器，用于使得生成器生成数据在原始空间中与真实数据距离较大；同时在神经网络模型中间层的输出与真实数据距离较小；优选的，所述第一生成器G1的目标函数为：其中，α1为给定的权值参数；φ1为第一生成器的网络参数。训练数据为随机选取的子训练集中所有数据。步骤S2.2、训练所述第二生成器，用于使得生成器生成数据在原始空间中与真实数据距离较小，同时神经网络的损失函数的梯度较大；通过增强数据可以减少神经网络在小样本条件下结构光滑性的退化现象和神经网络过度学习小样本数据冗余特征的缺点。所述第二生成器G2目标函数为：其中，Jl，y)为损失函数l，y)关于θ的Jacobian矩阵，α2为给定的权值参数，φ2为第二生成器的网络参数。训练数据为随机选取的子训练集中所有数据。步骤S2.3、所述第三生成器，用于使得生成器生成数据在与原始数据相近的前提下，使得神经网络模型输出的结果与理想数据结果距离较远。所述第三生成器G3目标函数为：其中，l，y)为损失函数，α3为给定的权值参数，φ3为第三生成器的网络参数。训练数据为随机选取的子训练集中所有数据。具体的，在步骤S3中根据所选训练子集中的训练数据，计算第一生成器G1、第二生成器G3和第三生成器G2的重要性权值w1i、w2i和w3i为：其中，Jl，y)为损失函数l，y)关于θ的Jacobian矩阵。在本步骤中，利用生成器生成增强数据，然后对增强数据进行重要性评分，得到利用评分加权的增强数据；通过这些增强数据对神经网络模型进行对抗训练可以让神经网络模型更加有效的针对具有良好训练效果的数据进行训练。具体的，在步骤S4中，利用增强数据对神经网络模型进行训练的，训练神经网络模型f的参数θ，其目标函数如下：其中c是给定的权值系数。在所述目标函数中，通过第一项主要让神经网络模型进行分类任务，通过第二项使得数据之间的特征距离变大，通过第三、四项是让神经网络模型在增强数据中的分类正确率增强。因此，在本实施例的神经网络模型对三个生成器生成的数据都进行训练后，通过不同生成器生成的数据提升了神经网络模型的效果。具体的，在步骤S5中，如果迭代次数超过给定阈值ε，则终止；否则回到步骤S2。综上所述，本实施例针对深度神经网络模型结构由于小样本条件而引起的分类任务性能退化机理，设计面向神经网络模型结构的数据增强方法和模型训练方法，提升基于传统生成模型的数据增强方法对神经网络结构的任务性能提升效果，通过深度神经网络应用于飞行器自动姿态预测，从而更好的完成姿态预测控制，实现在复杂环境条件下对飞行器姿态控制做出最佳决策,以达到飞行器姿态最有效率控制的目的。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。
