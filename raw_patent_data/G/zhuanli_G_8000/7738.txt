标题title
一种基于目标跟踪算法的智慧工厂监控系统
摘要abst
一种基于目标跟踪算法的智慧工厂监控系统，包括终端服务器、视频图像采集模块和视频图像处理模块；所述的视频图像采集模块包含多个监控摄像头；所述视频图像处理模块实时检测工厂环境中是否出现可疑目标并设计了一种查询引导的目标跟踪方法持续性跟踪可疑目标，所述查询引导的目标跟踪方法解决了离线训练时样本不平衡的问题，有效提高了跟踪的准确性，同时解决了在线跟踪时使用的位置惩罚在目标快速运动时容易跟踪失败的问题，有效提高了跟踪的鲁棒性，即有效解决了可疑目标准确及鲁棒的定位问题，进而保障了工厂环境的安全性。
权利要求书clms
1.一种基于目标跟踪算法的智慧工厂监控系统，其特征在于，包括终端服务器、视频图像采集模块和视频图像处理模块；所述的视频图像采集模块包含多个监控摄像头，用于实时采集工厂不同区域的环境视频图像数据，然后将采集到的工厂环境视频图像数据输出至图像处理模块；所述视频图像处理模块用于实时读取视频图像数据并进行处理，首先实时检测工厂环境中是否出现可疑目标，当出现可疑目标时生成报警信号输出值终端服务器，终端服务器接收到报警信号后进行报警；同时，根据检测到的目标位置信息利用设计的查询引导的目标跟踪方法跟踪可疑目标，当跟踪的可疑目标从当前摄像头的拍摄范围内消失时，利用设计的查询引导的目标跟踪方法在下一个摄像头的拍摄范围内找到同一个可疑目标进行持续性跟踪。2.根据权利要求1所述的图像采集模块，其特征在于，相邻摄像头之间的拍摄范围有一定重合，会出现可疑目标在两个摄像头拍摄范围内的情况。3.根据权利要求1所述的视频图像处理模块，其特征在于，在检测出工厂环境处出现可疑目标的同时给出可疑目标的位置信息。4.根据权利要求1所述的视频图像处理模块，其特征在于，所述设计的查询引导的目标跟踪方法包括两个部分，第一部分是利用设计的重要性感知损失函数离线训练跟踪网络，第二部分是利用离线训练的网络进行在线跟踪。5.根据权利要求4所述的第一部分利用设计的重要性感知损失函数离线训练跟踪网络，其特征在于，离线训练的网络选择的是SiamRPN的主干网络，网络尾部有两个分支，分别是分类分支和回归分支。6.根据权利要求4所述的第一部分利用设计的重要性感知损失函数离线训练跟踪网络，其特征在于，离线训练跟踪网络使用的数据是ImageNet数据集和在工厂采集的视频图像数据制作成的数据集，在工厂采集的视频图像数据是先由每个摄像头拍摄得到视频图像数据，然后将视频图像数据分成一系列图像在进行人工标注，标注完成即完成了将工厂视频数图像数据集制作成数据集；离线训练网络所使用的损失是设计的重要性感知损失：Lrc＝T+T该损失由Lcls是分类分支的损失函数和回归分支的损失函数Lreg组成，T是用于调整损失大小的函数，其作用是当损失较小时，进一步减小其影响，当损失较大时，进一步增大其影响，网络前向传播时网络尾部的分类分支和回归分支分别计算损失，再利用T调整两分支损失大小，最后分类分支和回归分支的损失相加即为最终的损失，将最终的损失送入网络一学习网络参数；用于调整损失大小的函数T的表达式为：其中，th是一个阈值，用于根据当前损失L的大小判断其对应的训练样本是否为简单负样本，若L大于阈值th，说明其对应的训练样本是困难负样本或正样本，通过函数e|L|将当前损失L增大，若L小于阈值th，说明其对应的训练样本是简单负样本，通过将当前损失L减小，c是一个超参数；Lreg是回归分支的损失函数，采用归一化坐标的smooth L1损失进行回归，设Ax、Ay表示锚盒的中心点坐标，Aw和Ah表示锚盒的形状，即宽和高，Tx、Ty表示真实目标坐标的中心点坐标，Tw和Th表示真实目标的形状，即宽和高，然后将各中心点及形状之间的距离进行归一化：δ和δ是锚盒和真实目标坐标的中心点坐标归一化后的距离，δ和δ是锚盒和真实目标宽和高归一化后的距离，将这些归一化后的距离送入smooth L1损失函数中进行回归，经过smooth L1损失回归后各归一化后的距离可以写为：其中，x是上述归一化后的各点及形状之间的距离δ、δ、δ和δ，σ是一个超参数，最终采用归一化坐标的smooth L1损失进行回归后的回归损失定义为：Lcls是分类分支的损失函数，为交叉熵损失：其中，n为样本的个数，yi是设定的标签值，y′是网络的分类分支的输出值，即网络的分类分支的预测值。7.根据权利要求3所述的第二部分利用离线训练的网络进行在线跟踪，其特征在于，在线跟踪步骤如下：S71：利用权利要求3中所获取的可疑目标的位置信息，截取出可疑目标图像作为目标模板Z1，设置给出可疑目标位置的那一帧图像为第一帧；S72：在后续帧中截取出搜索区域图像Xt，t为视频图像的帧索引，将目标模板图像和搜索区域图像分别输入离线训练到的网络分别提取特征图，然后将两个特征图分别输入到离线训练得到的网络的分类分支与回归分支中；S73：在分类分支输出得分图后，将设计的一个目标查询的惩罚与分类分支的输出得分图相结合得到最终的分类得分图；S74：通过分类得分图与回归分支的输出相结合，筛选找到目标位置。8.根据权利要求7所述的目标查询的惩罚，其特征在于，目标查询的惩罚是两种惩罚的结合，一种是考虑到目标运动信息的目标速度指导的位置惩罚，一种是考虑到目标自身颜色信息的目标颜色指导的位置惩罚，目标速度指导的位置惩罚定义为：其中coswindow是余弦窗，使用余弦窗是基于目标距离上一帧目标位置更近的可能性更大的假设，余弦窗能将远离上一帧目标中心区域的区域赋予较低的权值，d是前两帧目标中心位置的距离：其中，xt-1与yt-1是上一帧预测的目标中心点坐标，xt-2与yt-2是隔上一帧的预测的目标中心点坐标，d越大说明两帧之间目标的距离越远，则证明目标移动越快，目标距离上一帧目标位置更近的可能性更大的假设就会被打破，随着d的增大ed越大，余弦窗的权值被降低，进而其的位置惩罚能力就越弱，相反，d越小说明两帧之间目标的距离越近，目标距离上一帧目标位置更近的可能性更大的假设就不会被打破，余弦窗的权值越强，进而其的位置惩罚能力就越强；目标颜色指导的位置惩罚由目标颜色直方图提供得到颜色信息所决定，目标颜色指导的位置惩罚定义为：CF＝w*Xt其中*表示互相关操作，Xt是当前搜索图像的颜色直方图，w是利用目标颜色直方图学习到的相关滤波器，相关滤波器的学习公式如下：其中Zt是利用预测得到的跟踪结果提取到的新的目标颜色直方图，λ是一个正则化参数，y是标签，该公式可以通过快速傅里叶变换进行加速计算，可求得最终的相关滤波器如下：其中是元素积，符号^表示傅里叶变换，是的复共轭；将目标速度指导的位置惩罚CP与目标颜色指导的位置惩罚CF加权融合得到目标查询的惩罚：C＝αCF+CP其中，α是一个超参数用于平衡目标速度指导的位置惩罚CP与目标颜色指导的位置惩罚CF，最终将目标查询的惩罚与分类分支的分类得分图相乘便得到最终的分类得分图。9.根据权利要求1所述的利用设计的查询引导的目标跟踪方法在下一个摄像头的拍摄范围内找到同一个可疑目标，其特征在于，在下一个摄像头内寻找目标所使用的模板图像发生了改变，变成了从上一个摄像头拍到的视频图像中跟踪方法在最后一帧定位到的目标图像，在下一个摄像头内开始寻找目标是将查询引导的目标跟踪方法中的搜索图像设置为下一个摄像头拍摄的整张图片，即全局搜索目标，找到目标后根据预测的目标位置再缩小搜索图像，在局部搜索目标。
说明书desc
技术领域本发明涉及智能监控技术领域，特别涉及一种基于目标跟踪算法的智慧工厂监控系统。背景技术高度重视制造业的发展，工厂作为其中一重要组成部分，对安全防范提出了非常高的要求。工厂面积大，仓储地点分散与环境复杂，人车混流、车辆移动频繁，仅靠人力进行监控，无法实时掌握工厂环境情况，同时效率低、出现问题无法及时处理。智慧工厂无疑是现代工业、制造业的大势所趋，将智能监控作为一种高效便捷的安防措施已被部分工厂所采用的，一方面它能实时的获取工厂各个重要监控区域的情况，更有利于工厂的安全管理，另一方面又能够减少不必要的人力、物力，更高效实时地监控工厂环境，便于即使应付出现的紧急情况。在智慧工厂的实时监控中，当面对紧急情况时需要对出现的可疑目标进行实时的跟踪，跟踪的鲁棒性与准确定是智能监控高效运行的重要因素，现如今流行的目标跟踪方法SiamRPN不仅满足实时性的要求，同时具有不错的准确性，但面对工厂如此复杂的环境仍存在一些局限性：一是SiamRPN的网络在离线训练时所使用的损失没有关注到数据不平衡的问题，导致了跟踪的准确性难以提升，因此面对工厂复杂的环境难以准确跟踪是一个需要解决的问题；二是利用了余弦窗作为位置惩罚去筛选目标，这是基于目标距离上一帧目标距离较近的可能性比较大的假设，在工厂环境中待跟踪的可疑目标运动难以确定，有很大的可能运动较快，那么就打破了目标距离上一帧目标距离较近的可能性比较大的这一假设，这时跟踪容易出现丢失，因此面对可疑目标运动较快容易跟踪失败是第二个需要解决的问题，些问题影响着跟踪的鲁棒性，进而影响着工厂的安全。发明内容本发明针对上述问题，提出了一种基于目标跟踪算法的智慧工厂监控系统，并提出一种查询引导的目标跟踪方法，该跟踪方法通过对损失函数的改进以提高跟踪的准确性，同时改进了原跟踪算法的约束以提高跟踪的鲁棒性，通过该跟踪方法可以有效的定位可疑目标，进而进一步保证了工厂的安全。为了解决上述技术问题，本发明提供如下技术方案：一种基于目标跟踪算法的智慧工厂监控系统，包括终端服务器、视频图像采集模块和视频图像处理模块；所述的视频图像采集模块包含多个监控摄像头，用于实时采集工厂不同区域的环境视频图像数据，然后将采集到的工厂环境视频图像数据输出至图像处理模块；所述视频图像处理模块用于实时读取视频图像数据并进行处理，首先实时检测工厂环境中是否出现可疑目标，当出现可疑目标时生成报警信号输出值终端服务器，终端服务器接收到报警信号后进行报警；同时，根据检测到的目标位置信息利用设计的查询引导的目标跟踪方法跟踪可疑目标，当跟踪的可疑目标从当前摄像头的拍摄范围内消失时，利用设计的查询引导的目标跟踪方法在下一个摄像头的拍摄范围内找到同一个可疑目标进行持续性跟踪。进一步地，所述的图像采集模块，相邻摄像头之间的拍摄范围有一定重合，会出现可疑目标在两个摄像头拍摄范围内的情况。进一步地，所述的视频图像处理模块，在检测出工厂环境处出现可疑目标的同时给出可疑目标的位置信息。进一步地，所述的视频图像处理模块，所述设计的查询引导的目标跟踪方法包括两个部分，第一部分是利用设计的重要性感知损失函数离线训练跟踪网络，第二部分是利用离线训练的网络进行在线跟踪。进一步地，所述的第一部分利用设计的重要性感知损失函数离线训练跟踪网络，其特征在于，离线训练的网络选择的是SiamRPN的主干网络，网络尾部有两个分支，分别是分类分支和回归分支。进一步地，所述的第一部分利用设计的重要性感知损失函数离线训练跟踪网络，离线训练跟踪网络使用的数据是ImageNet数据集和在工厂采集的视频图像数据制作成的数据集，在工厂采集的视频图像数据是先由每个摄像头拍摄得到视频图像数据，然后将视频图像数据分成一系列图像在进行人工标注，标注完成即完成了将工厂视频数图像数据集制作成数据集；离线训练网络所使用的损失是设计的重要性感知损失：Lrc＝T+T该损失由Lcls是分类分支的损失函数和回归分支的损失函数Lreg组成，T是用于调整损失大小的函数，其作用是当损失较小时，进一步减小其影响，当损失较大时，进一步增大其影响，网络前向传播时网络尾部的分类分支和回归分支分别计算损失，再利用T调整两分支损失大小，最后分类分支和回归分支的损失相加即为最终的损失将最终的损失送入网络一学习网络参数；用于调整损失大小的函数T的表达式为：其中，th是一个阈值，用于根据当前损失L的大小判断其对应的训练样本是否为简单负样本，若L大于阈值th，说明其对应的训练样本是困难负样本或正样本，通过函数eL将当前损失L增大，若L小于阈值th，说明其对应的训练样本是简单负样本，通过将当前损失L减小，c是一个超参数；Lreg是回归分支的损失函数，采用归一化坐标的smooth L1损失进行回归，设Ax、Ay表示锚盒的中心点坐标，Aw和Ah表示锚盒的形状，即宽和高，Tx、Ty表示真实目标坐标的中心点坐标，Tw和Th表示真实目标的形状，即宽和高，然后将各中心点及形状之间的距离进行归一化：δ和δ是锚盒和真实目标坐标的中心点坐标归一化后的距离，δ和δ是锚盒和真实目标宽和高归一化后的距离，将这些归一化后的距离送入smooth L1损失函数中进行回归，经过smooth L1损失回归后各归一化后的距离可以写为：其中，x是上述归一化后的各点及形状之间的距离δ、δ、δ和δ，σ是一个超参数，最终采用归一化坐标的smooth L1损失进行回归后的回归损失定义为：Lcls是分类分支的损失函数，为交叉熵损失：其中，n为样本的个数，yi是设定的标签值，y′是网络的分类分支的输出值，即网络的分类分支的预测值。进一步地，所述的第二部分利用离线训练的网络进行在线跟踪，在线跟踪步骤如下：步骤一：利用检测所获取的可疑目标的位置信息，截取出可疑目标图像作为目标模板Z1，设置给出可疑目标位置的那一帧图像为第一帧；步骤二：在后续帧中截取出搜索区域图像Xt，t为视频图像的帧索引，将目标模板图像和搜索区域图像分别输入离线训练到的网络分别提取特征图，然后将两个特征图分别输入到离线训练得到的网络的分类分支与回归分支中；步骤三：在分类分支输出得分图后，将设计的一个目标查询的惩罚与分类分支的输出得分图相结合得到最终的分类得分图；步骤四：通过分类得分图与回归分支的输出相结合，筛选找到目标位置。进一步地，所述的目标查询的惩罚，目标查询的惩罚是两种惩罚的结合，一种是考虑到目标运动信息的目标速度指导的位置惩罚，一种是考虑到目标自身颜色信息的目标颜色指导的位置惩罚，目标速度指导的位置惩罚定义为：其中coswindow是余弦窗，使用余弦窗是基于目标距离上一帧目标位置更近的可能性更大的假设，余弦窗能将远离上一帧目标中心区域的区域赋予较低的权值，d是前两帧目标中心位置的距离：其中，xt-1与yt-1是上一帧预测的目标中心点坐标，xt-2与yt-2是隔上一帧的预测的目标中心点坐标，d越大说明两帧之间目标的距离越远，则证明目标移动越快，目标距离上一帧目标位置更近的可能性更大的假设就会被打破，随着d的增大ed越大，余弦窗的权值被降低，进而其的位置惩罚能力就越弱，相反，d越小说明两帧之间目标的距离越近，目标距离上一帧目标位置更近的可能性更大的假设就不会被打破，余弦窗的权值越强，进而其的位置惩罚能力就越强；目标颜色指导的位置惩罚由目标颜色直方图提供得到颜色信息所决定，目标颜色指导的位置惩罚定义为：CF＝w*Xt其中*表示互相关操作，Xt是当前搜索图像的颜色直方图，w是利用目标颜色直方图学习到的相关滤波器，相关滤波器的学习公式如下：其中Zt是利用预测得到的跟踪结果提取到的新的目标颜色直方图，λ是一个正则化参数，y是标签，该公式可以通过快速傅里叶变换进行加速计算，可求得最终的相关滤波器如下：其中是元素积，符号^表示傅里叶变换，是的复共轭；将目标速度指导的位置惩罚CP与目标颜色指导的位置惩罚CF加权融合得到目标查询的惩罚：C＝αCF+CP其中α是一个超参数用于平衡目标速度指导的位置惩罚CP与目标颜色指导的位置惩罚CF，最终将目标查询的惩罚与分类分支的分类得分图相乘便得到最终的分类得分图。进一步地，所述的利用设计的查询引导的目标跟踪方法在下一个摄像头的拍摄范围内找到同一个可疑目标，在下一个摄像头内寻找目标所使用的模板图像发生了改变，变成了从上一个摄像头拍到的视频图像中跟踪方法在最后一帧定位到的目标图像，在下一个摄像头内开始寻找目标是将查询引导的目标跟踪方法中的搜索图像设置为下一个摄像头拍摄的整张图片，即全局搜索目标，找到目标后根据预测的目标位置再缩小搜索图像，在局部搜索目标。本发明的有益效果在于，提出了一种基于目标跟踪算法的智慧工厂监控系统，在智慧工厂的监控系统中引入了设计的查询引导的目标跟踪方法，该跟踪方法设计了一个重要性感知损失函数，压缩简单负样本的损失，增大正样本的损失，使得跟踪方法的网络更有效的识别出待跟踪的可疑目标，此外设计了一个目标查询的惩罚，利用目标运动信息与颜色信息防止目标距离上一帧目标距离较近的可能性比较大的这一假设带来的跟踪失败问题，提高了跟踪的鲁棒性，进而提高了智慧工厂监控系统的高效性，保证了工厂的安全运行。附图说明利用附图对发明创造作进一步说明，但附图中的实施例不构成对本发明创造的任何限制，对于本领域的普通技术人员，在不付出创造性劳动的前提下，还可以根据以下附图获得其它的附图。图1是本发明监控系统工作流程图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例；基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。参见图1，一种基于目标跟踪算法的智慧工厂监控系统，包括终端服务器、视频图像采集模块和视频图像处理模块；所述的视频图像采集模块包含多个监控摄像头，用于实时采集工厂不同区域的环境视频图像数据，然后将采集到的工厂环境视频图像数据输出至图像处理模块；所述视频图像处理模块用于实时读取视频图像数据并进行处理，首先实时检测工厂环境中是否出现可疑目标，当出现可疑目标时生成报警信号输出值终端服务器，终端服务器接收到报警信号后进行报警；同时，根据检测到的目标位置信息利用设计的查询引导的目标跟踪方法跟踪可疑目标，当跟踪的可疑目标从当前摄像头的拍摄范围内消失时，利用设计的查询引导的目标跟踪方法在下一个摄像头的拍摄范围内找到同一个可疑目标进行持续性跟踪。优选地，所述的图像采集模块，相邻摄像头之间的拍摄范围有一定重合，会出现可疑目标在两个摄像头拍摄范围内的情况。优选地，所述的视频图像处理模块，在检测出工厂环境处出现可疑目标的同时给出可疑目标的位置信息。优选地，所述的视频图像处理模块，所述设计的查询引导的目标跟踪方法包括两个部分，第一部分是利用设计的重要性感知损失函数离线训练跟踪网络，第二部分是利用离线训练的网络进行在线跟踪。优选地，所述的第一部分利用设计的重要性感知损失函数离线训练跟踪网络，其特征在于，离线训练的网络选择的是SiamRPN的主干网络，网络尾部有两个分支，分别是分类分支和回归分支。现有的基于孪生网络的跟踪方法SiamRPN离线训练主干网络，在线跟踪时不更新网络，因此具有较高的实时性，同时创新的引入区域建议网络提高了跟踪的准确性，兼具跟踪的准确性与实时性，因此满足智慧工厂监控系统的基本要求，但SiamRPN在离线训练主干网络时会面临样本不均衡的问题，大量的简单负样本起主要贡献作用，会主导梯度的更新方向，网络很难有效学到有用的信息，因此跟踪的准确性有待提高，针对这个问题提出了一个重要性感知损失函数，在网络上的离线训练阶段，压缩简单负样本的损失，增大正样本的损失，使得跟踪方法的网络更有效的识别出待跟踪的可疑目标，具体为：离线训练跟踪网络使用的数据是ImageNet数据集和在工厂采集的视频图像数据制作成的数据集，在工厂采集的视频图像数据是先由每个摄像头拍摄得到视频图像数据，然后将视频图像数据分成一系列图像在进行人工标注，标注完成即完成了将工厂视频数图像数据集制作成数据集；离线训练网络所使用的损失是设计的重要性感知损失：Lrc＝T+T该损失由Lcls是分类分支的损失函数和回归分支的损失函数Lreg组成，T是用于调整损失大小的函数，其作用是当损失较小时，进一步减小其影响，当损失较大时，进一步增大其影响，网络前向传播时网络尾部的分类分支和回归分支分别计算损失，再利用T调整两分支损失大小，最后分类分支和回归分支的损失相加即为最终的损失，最终的损失送入网络一学习网络参数；用于调整损失大小的函数T的表达式为：其中，th是一个阈值，用于根据当前损失L的大小判断其对应的训练样本是否为简单负样本，若L大于阈值th，说明其对应的训练样本是困难负样本或正样本，通过函数e|L|将当前损失L增大，若L小于阈值th，说明其对应的训练样本是简单负样本，通过将当前损失L减小，c是一个超参数；Lreg是回归分支的损失函数，采用归一化坐标的smooth L1损失进行回归，设Ax、Ay表示锚盒的中心点坐标，Aw和Ah表示锚盒的形状，即宽和高，Tx、Ty表示真实目标坐标的中心点坐标，Tw和Th表示真实目标的形状，即宽和高，然后将各中心点及形状之间的距离进行归一化：δ和δ是锚盒和真实目标坐标的中心点坐标归一化后的距离，δ和δ是锚盒和真实目标宽和高归一化后的距离，将这些归一化后的距离送入smooth L1损失函数中进行回归，经过smooth L1损失回归后各归一化后的距离可以写为：其中，x是上述归一化后的各点及形状之间的距离δ、δ、δ和δ，σ是一个超参数，最终采用归一化坐标的smooth L1损失进行回归后的回归损失定义为：Lcls是分类分支的损失函数，为交叉熵损失：其中，n为样本的个数，yi是设定的标签值，y′是网络的分类分支的输出值，即网络的分类分支的预测值。优选地，所述的第二部分利用离线训练的网络进行在线跟踪，在线跟踪步骤如下：步骤一：利用检测所获取的可疑目标的位置信息，截取出可疑目标图像作为目标模板Z1，设置给出可疑目标位置的那一帧图像为第一帧；步骤二：在后续帧中截取出搜索区域图像Xt，t为视频图像的帧索引，将目标模板图像和搜索区域图像分别输入离线训练到的网络分别提取特征图，然后将两个特征图分别输入到离线训练得到的网络的分类分支与回归分支中；步骤三：在分类分支输出得分图后，将设计的一个目标查询的惩罚与分类分支的输出得分图相结合得到最终的分类得分图；步骤四：通过分类得分图与回归分支的输出相结合，筛选找到目标位置。SiamRPN在线跟踪时会在分类分支上增加一个基于目标距离上一帧目标位置更近的假设的余弦窗作为位置惩罚，当待跟踪的可疑目标运动过快会打破这个假设，那么基于目标距离上一帧目标位置更近的假设的余弦窗反而会造成跟踪失败，针对这个问题设计了一个目标查询的惩罚，不同于原始余弦窗作为位置惩罚，设计的惩罚利用目标运动信息与颜色信息防止目标距离上一帧目标距离较近的可能性比较大的这一假设带来的跟踪失败问题，提高了跟踪的鲁棒性，具体为：所述的目标查询的惩罚，目标查询的惩罚是两种惩罚的结合，一种是考虑到目标运动信息的目标速度指导的位置惩罚，一种是考虑到目标自身颜色信息的目标颜色指导的位置惩罚，目标速度指导的位置惩罚定义为：其中coswindow是余弦窗，使用余弦窗是基于目标距离上一帧目标位置更近的可能性更大的假设，余弦窗能将远离上一帧目标中心区域的区域赋予较低的权值，d是前两帧目标中心位置的距离：其中，xt-1与yt-1是上一帧预测的目标中心点坐标，xt-2与yt-2是隔上一帧的预测的目标中心点坐标，d越大说明两帧之间目标的距离越远，则证明目标移动越快，目标距离上一帧目标位置更近的可能性更大的假设就会被打破，随着d的增大ed越大，余弦窗的权值被降低，进而其的位置惩罚能力就越弱，相反，d越小说明两帧之间目标的距离越近，目标距离上一帧目标位置更近的可能性更大的假设就不会被打破，，余弦窗的权值越强，进而其的位置惩罚能力就越强；目标颜色指导的位置惩罚由目标颜色直方图提供得到颜色信息所决定，目标颜色指导的位置惩罚定义为：CF＝w*Xt其中*表示互相关操作，Xt是当前搜索图像的颜色直方图，w是利用目标颜色直方图学习到的相关滤波器，相关滤波器的学习公式如下：其中Zt是利用预测得到的跟踪结果提取到的新的目标颜色直方图，λ是一个正则化参数，y是标签，该公式可以通过快速傅里叶变换进行加速计算，可求得最终的相关滤波器如下：其中是元素积，符号^表示傅里叶变换，是的复共轭；将目标速度指导的位置惩罚CP与目标颜色指导的位置惩罚CF加权融合得到目标查询的惩罚：C＝αCF+CP其中α是一个超参数用于平衡目标速度指导的位置惩罚CP与目标颜色指导的位置惩罚CF，最终将目标查询的惩罚与分类分支的分类得分图相乘便得到最终的分类得分图。优选地，所述的利用设计的查询引导的目标跟踪方法在下一个摄像头的拍摄范围内找到同一个可疑目标，其特征在于，在下一个摄像头内寻找目标所使用的模板图像发生了改变，变成了从上一个摄像头拍到的视频图像中跟踪方法在最后一帧定位到的目标图像，在下一个摄像头内开始寻找目标是将查询引导的目标跟踪方法中的搜索图像设置为下一个摄像头拍摄的整张图片，即全局搜索目标，找到目标后根据预测的目标位置再缩小搜索图像，在局部搜索目标。本优选实例视频图像处理模块采用了目标跟踪方法对视频图像数据进行了分析处理，设计了一种查询引导的目标跟踪方法，提高跟踪的准确性的同时提高了跟踪的鲁棒性，进而提供智慧工厂监控系统的高效性以保障工厂环境的安全；现有的基于孪生网络的跟踪方法SiamRPN离线训练主干网络，在线跟踪时不更新网络，因此具有较高的实时性，同时创新的引入区域建议网络提高了跟踪的准确性，兼具跟踪的准确性与实时性，因此满足智慧工厂监控系统的基本要求，但SiamRPN仍然存在一些局限性，一是在离线训练主干网络时会面临样本不均衡的问题，大量的简单负样本起主要贡献作用，会主导梯度的更新方向，网络很难有效学到有用的信息，因此跟踪的准确性有待提高，二是在线跟踪时会在分类分支上增加一个基于目标距离上一帧目标位置更近的假设的余弦窗作为位置惩罚，当待跟踪的可疑目标运动过快会打破这个假设，那么基于目标距离上一帧目标位置更近的假设的余弦窗反而会造成跟踪失败；针对以上第一个问题，设计了一种查询引导的目标跟踪方法，该方法提出了一个重要性感知损失函数，在网络上的离线训练阶段，当网络前向传播输出预测值时，利用回归损失函数与分类损失函数分别计算出各自的损失值，然后将计算后的损失值送入调整损失大小的函数中进行调整，调整损失大小的函数将简单负样本的损失进一步减小，困难负样本及正样本的损失进一步增大，然后利用调整后的损失进行反向传播学习网络参数。设计后的损失可以有效减少简单负样本起主要贡献作用，增强困难负样本及正样本的贡献，防止了样本不均衡带来的网络难以有效学习到有用信息的问题，提高了跟踪的准确性。针对以上第二个问题，设计了一个目标查询的惩罚，将考虑到目标运动信息的目标速度指导的位置惩罚和考虑到目标自身颜色信息的目标颜色指导的位置惩罚相结合，目标速度指导的位置惩罚首先计算出上一帧目标中心位置与隔上一帧目标中心位置之间的距离，该距离反映了目标运动的快慢，然后利用该距离与余弦窗相结合获得最终的目标速度指导的位置惩罚，目标颜色指导的位置惩罚利用目标颜色直方图学习一滤波器，滤波器与搜索图像的颜色直方图进行互相关获得目标颜色指导的位置惩罚，目标速度指导的位置惩罚与目标颜色指导的位置惩罚加权融合得到最终的目标查询的惩罚，将目标查询的惩罚与分类分支的得分图相乘，便得到了最终的分类得分图，设计的目标查询的惩罚通过目标运动信息和目标颜色信息的相结合来替代原始的余弦窗，打破了目标距离上一帧目标距离较近的可能性比较大的这一假设，在目标运动快速时能够有效定位目标，提高了跟踪的鲁棒性。最后应当说明的是，以上实施例仅用以说明本发明的技术方案，而非对本发明保护范围的限制，尽管参照较佳实施例对本发明作了详细地说明，本领域的普通技术人员应当理解，可以对本发明的技术方案进行修改或者等同替换，而不脱离本发明技术方案的实质和范围。
