标题title
基于随机梯度下降优化算法的球面全息再现质量提升方法
摘要abst
本发明提出一种基于随机梯度下降优化算法的球面全息再现质量提升方法。该方法包括全息图生成和全息图重建两个部分。该方法的生成过程中，首先利用本发明提出的球面遮挡剔除衍射算法，将随机初始化的全息图进行重建，并计算与目标图像之间的损失值，再得到其梯度，根据反向传播公式，对全息图进行更新，将更新的全息图重复上述操作，满足设定的阈值，最终得到优化之后的全息图；相比传统的球面自衍射迭代方法，本发明方法获得全息图可以重建更高质量的图像，通过随机梯度下降方法，其收敛的峰值信噪比远远高于传统的自衍射方法，能够在球面360°显示中具有良好的应用前景。
权利要求书clms
1.基于随机梯度下降优化算法的球面全息再现质量提升方法，其特征在于，该方法包括全息图生成和全息图重建两个部分；所述的全息图生成过程具体描述为：步骤一，利用随机函数生成一个随机的0-2π范围内的相位分布，作为初始的球面全息图Ho；步骤二，将球面全息图Ho利用球面衍射算法进行重建，其中，球面衍射算法采用遮挡剔除的球面卷积算法，表示为Ur=IFFT，Us为源场复振幅，Ur为衍射场复振幅，θ和φ分别表示为俯仰角和偏航角， h’为采用遮挡剔除关系的点扩散函数；步骤三，将重建的复振幅图像与目标图像代入损失函数中，进行计算，得到损失值loss；步骤四，将计算的loss值对全息图Ho的相位进行梯度的计算，得到其梯度Grad=∂loss/∂Ho=∂loss/∂Ur*∂Ur/∂Ho，并根据反向传播公式Hi=Ho-lr*Grad，得到更新后的全息图相位Hi，其中lr为学习率；步骤五，将更新后相位后的全息图Hi利用去遮挡的球面卷积算法进行重建，并继续前两步操作，计算损失值loss和梯度，并进行反向传播，不断地优化全息图相位；步骤六，优化的次数满足设定的次数，或者重建质量达到设定的阈值时，停止优化过程，保留上一次迭代的全息图，作为最终优化好的全息图；所述的全息图重建过程具体描述为：步骤一，将全息图加载到对应的调制器上；步骤二，在相应的衍射距离处，接收球面全息图重建像。2.权利要求1中生成过程中所述的遮挡剔除的球面卷积算法，其特征在于，该方法对点扩散函数h=exp/cosa进行限制，其中j为虚数单位，k为波矢，cosa为倾斜因子，d为源点和目标点之间的距离, 等于sqrtcos)，R和r为内外球半径，对于距离d小于sqrt，h’表示为h，当距离d＞sqrt时，点扩散函数h’为0，因此遮挡剔除的球面卷积算法表示为Ur=IFFT，该方法不仅适用于随机梯度下降优化算法，同时也适用于其他各种迭代优化算法。
说明书desc
技术领域本发明涉及一种全息显示技术，特别是球面全息再现质量提升方法。背景技术全息显示作为一种最理想的真三维显示技术，一直受到极大的关注。然而，当前平面型全息图受限于空间光调制器过大的像素尺寸，无法重建出足够大的视场角，观看者只能在一个狭小的角度范围内观看全息再现图像。为了能够让观看者在不同方向上看到全息再现图像，研究者提出球面型全息图。可是在当前的球面全息生成算法中，其再现质量却不令人满意。相比平面型全息图中已有的大量再现质量提升算法，球面全息再现质量提升方法并未广泛研究。因此，针对球面全息的质量提升问题，仍有很大的研究潜力。发明内容本方法针对上述球面全息再现质量低下的问题，提出了一种基于随机梯度下降优化算法的球面全息再现质量提升方法。所提出的方法将球面全息图生成过程当做一个优化过程，利用随机梯度下降进行全息图优化，是一种新颖的球面全息图质量提升算法，并结合遮挡剔除方法，抑制球面再现时的重影现象。相比传统的质量提升方法，该方法得到的球面全息图，能够重建出无散斑噪声的高质量图像。所述的球面全息再现提升方法流程如图1所示，该过程具体分为六个步骤：①初始化一个随机相位作为球面全息图Ho，②将该初始化的球面全息图Ho利用球面衍射算法进行重建，获得再现图像Ur，③将再现图像Ur与目标图像Uo进行损失函数的计算，④将计算的损失进行梯度的计算，并进行反向传播，更新全息图的相位，⑤将更新后的全息图Hi再一次重建，重复③-④操作，进行优化，⑥满足设定优化次数或者得到满意的重建质量时，获得最终的全息图。重建过程分为两个步骤，①加载全息图，②接收全息重建图像。所述的初始化一个随机相位作为球面全息图Ho是指利用随机函数生成一个随机的0-2π范围内的相位分布，作为初始的球面全息图Ho。所述的将该初始化的球面全息图Ho利用球面衍射算法进行重建，获得再现图像Ur是指将球面全息图Ho利用球面衍射算法进行重建，其中，球面衍射算法采用遮挡剔除的球面卷积算法，表示为Ur=IFFT，Us为源场复振幅，Ur为衍射场复振幅，θ和φ分别表示为俯仰角和偏航角，遮挡剔除关系如图2所示，对点扩散函数h=exp/cosa进行限制，其中j为虚数单位，k为波矢，cosa为倾斜因子，d为源点和目标点之间的距离, 等于sqrtcos)，R和r为内外球半径，对于距离d小于sqrt，h’表示为h，当距离d＞sqrt时，点扩散函数h’为0。所述的将再现图像Ur与目标图像Uo进行损失函数的计算是指将重建的复振幅图像与目标图像代入损失函数中，进行计算，得到损失值loss。所述的将计算的损失进行梯度的计算，并进行反向传播，更新全息图的相位是指将计算的loss值对全息图Ho的相位进行梯度的计算，得到其梯度Grad=∂loss/∂Ho=∂loss/∂Ur *∂Ur/∂Ho，根据反向传播公式Hi=Ho-lr*Grad，得到更新后的全息图相位Hi，其中lr为学习率。所述的将更新后的全息图Hi再一次重建，重复③-④操作，进行优化是指将更新后相位后的全息图Hi利用去遮挡的球面卷积算法进行重建，并继续前两步操作，计算损失值loss和梯度，并进行反向传播，不断地优化全息图相位。所述的满足设定优化次数或者得到满意的重建质量时，获得最终的全息图是指优化的次数满足设定的次数，或者重建质量达到设定的阈值时，停止优化过程，保留上一次迭代的全息图，作为最终优化好的全息图。所述的加载全息图是指将全息图加载到对应的调制器上。所述的接收全息重建图像是指在相应的衍射距离处，接收球面全息图重建像。该方法的有益效果在于：所提出的球面全息图生成算法是一种基于随机梯度下降的迭代算法，该方法相比传统的球面GS迭代算法，收敛效果更好，其获得的球面全息图能够再现出质量更佳的图像，峰值信噪比保持较高的数值；结合提出的球面去遮挡卷积算法，能够让传播过程更加符合真实物理过程，解决全息图重建过程中的伪影现象，提出的去遮挡算法并未增加额外的计算量，并不会降低衍射过程的计算速度。附图说明附图1为提出方法的流程图。附图2为本发明的去遮挡卷积算法原理图,从内向外传播模型,从外向内传播模型。附图3为本发明的去遮挡模拟重建结果。附图4为本发明提出的基于随机梯度下降的模拟结果,使用传统的随机相位方法,使用本发明的双向补偿方法。附图5为本发明与其它方法的模拟重建结果，100,1000, 5000,10000次迭代次数下球面自衍射迭代和本发明的模拟重建结果。附图6为本发明重建不同分辨率图像的结果，256x256,512x512,1024x1024。附图7为本发明优化时间与再现质量的曲面图。附图8为本发明与球面自衍射迭代方法中迭代次数与再现质量的曲线图。附图9为本发明的不同深度重建结果, R=100mm,R=110mm，R=120mm，R=130mm。具体实施方式下面详细说明本发明一种基于随机梯度下降优化算法的球面全息再现质量提升方法的一个典型实施例，对该方法进行进一步的具体描述。有必要在此指出的是，以下实施例只用于该方法做进一步的说明，不能理解为对该方法保护范围的限制，该领域技术熟练人员根据上述该方法内容对该方法做出一些非本质的改进和调整，仍属于本发明的保护范围。本发明提出一种基于随机梯度下降优化算法的球面全息再现质量提升方法，该方法包括全息图生成和全息图重建两个部分。所述的球面全息再现提升方法流程如图1所示，该过程具体分为六个步骤：①初始化一个随机相位作为球面全息图Ho，②将该初始化的球面全息图Ho利用球面衍射算法进行重建，获得再现图像Ur，③将再现图像Ur与目标图像Uo进行损失函数的计算，④将计算的损失进行梯度的计算，并进行反向传播，更新全息图的相位，⑤将更新后的全息图Hi再一次重建，重复③-④操作，进行优化，⑥满足设定优化次数或者得到满意的重建质量时，获得最终的全息图。重建过程分为两个步骤，①加载全息图，②接收全息重建图像。所述的初始化一个随机相位作为球面全息图Ho是指利用随机函数生成一个随机的0-2π范围内的相位分布，作为初始的球面全息图Ho。所述的将该初始化的球面全息图Ho利用球面衍射算法进行重建，获得再现图像Ur是指将球面全息图Ho利用球面衍射算法进行重建，其中，球面衍射算法采用遮挡剔除的球面卷积算法，表示为Ur=IFFT，Us为源场复振幅，Ur为衍射场复振幅，θ和φ分别表示为俯仰角和偏航角，遮挡剔除关系如图2所示，对点扩散函数h=exp/cosa进行限制，其中j为虚数单位，k为波矢，cosa为倾斜因子，d为源点和目标点之间的距离, 等于sqrtcos)，R和r为内外球半径，对于距离d小于sqrt，h’表示为h，当距离d＞sqrt时，点扩散函数h’为0。所述的将再现图像Ur与目标图像Uo进行损失函数的计算是指将重建的复振幅图像与目标图像代入损失函数中，进行计算，得到损失值loss。所述的将计算的损失进行梯度的计算，并进行反向传播，更新全息图的相位是指将计算的loss值对全息图Ho的相位进行梯度的计算，得到其梯度Grad=∂loss/∂Ho=∂loss/∂Ur *∂Ur/∂Ho，根据反向传播公式Hi=Ho-lr*Grad，得到更新后的全息图相位Hi，其中lr为学习率。所述的将更新后的全息图Hi再一次重建，重复③-④操作，进行优化是指将更新后相位后的全息图Hi利用去遮挡的球面卷积算法进行重建，并继续前两步操作，计算损失值loss和梯度，并进行反向传播，不断地优化全息图相位。所述的满足设定优化次数或者得到满意的重建质量时，获得最终的全息图是指优化的次数满足设定的次数，或者重建质量达到设定的阈值时，停止优化过程，保留上一次迭代的全息图，作为最终优化好的全息图。所述的加载全息图是指将全息图加载到对应的调制器上。所述的接收全息重建图像是指在相应的衍射距离处，接收球面全息图重建像。在本发明的实例中，利用图2示意的球面遮挡剔除方法，目标图像分辨率设定为512x512，内球半径设定为10mm，外球半径设定为100mm，波长设定为260um。本发明提出的遮挡剔除模拟结果如图3，从第二行和第三行的结果对比来看，经过遮挡剔除的全息图能够重建出无重影干扰的图像，验证了遮挡剔除方法的有效性。将上述的遮挡剔除算法应用在图1所示的优化方法流程图中，内外半球半径依旧设定为10mm和100mm，波长为260um，损失函数采用均方根误差，其优化结果如图4所示。图4为传统的随机相位方法，并未优化的重建结果，相比之下，图4中采用本发明方法的重建图像具有更高的质量，其峰值信噪比更高。图5结果为传统球面自衍射迭代和本发明方法的对比结果，其迭代次数分别设定为100，1000，5000，10000次，图5第一行为传统球面自衍射迭代结果，虽然随着迭代次数的增加，其重建质量得到提高，但是仍然具有明显的散斑噪声，相比之下，本发明方法经过多次优化后，其重建质量得到了明显的提高。图6为本发明对不同分辨率目标图像的优化结果，从256x256到1024x1024，均可以重建高质量的图像。图7展示了重建质量与优化时间的变化结果，可以看到，随着优化次数和时间的增加，其重建质量也会不断上升，从图8中不同方法的对比结果中可以看出，传统自衍射迭代方法达到一定的迭代次数以后，其重建图像的峰值信噪比将不会再继续上升，而本发明的方法能够保证重建图像质量能随着优化次数增加而不断上升，其收敛的峰值信噪比将会更高。图9则是本发明重建在不同外球半径下的结果，A、B、C、D分别对应半径为100mm，110mm，120mm和130mm的距离下，其重建质量都可以得到有效的提高，因此本发明方法能够运用在三维显示中。
