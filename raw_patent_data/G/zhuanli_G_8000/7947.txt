标题title
一种基于张量网络和量子线路的混合计算方法及装置
摘要abst
一种基于张量网络和量子线路的混合计算方法及装置，方法包括：获取哈密顿量，将测量哈密顿量能量的线路表示为经典‑量子混合的形式；经典部分包括经典参数，量子部分包括量子参数；经典部分计算通过张量网络进行，量子部分计算通过变分量子线路进行；将经典参数和量子参数初始化；根据经典参数和量子参数，循环执行目标操作；目标操作中的第i次操作包括：固定经典参数和量子参数其中之一，调节另一参数，i为大于0的整数；当第i次和第i‑1次目标操作得到的能量值之差低至阈值时，第i次的能量值作为量子系统的基态能量。本申请将张量网络引入经典处理流程，增加了算法能够表达的纠缠特性，能够更加效率，精度更高的完成目标任务。
权利要求书clms
1.一种基于张量网络和量子线路的混合计算方法，其特征在于，包括：获取目标量子系统待求解最小本征值的哈密顿量，将测量哈密顿量的线路表示为包括经典部分及量子部分的形式；所述经典部分包括经典参数，所述量子部分包括量子参数；所述经典部分计算通过张量网络进行，所述量子部分计算通过变分量子线路进行；将所述经典参数和所述量子参数初始化；根据所述经典参数和所述量子参数，循环执行目标操作，其中，所述目标操作中的第i次操作包括：固定第一参数，调节第二参数，固定调节后的第二参数，调节第一参数；其中，第一参数为所述经典参数和所述量子参数其中之一，第二参数为另一参数；其中，i为大于0的整数；当第i次目标操作得到的所述目标量子系统的能量值与第i-1次目标操作得到的能量值之差低至预设阈值时，将第i次目标操作得到的所述目标量子系统的能量值作为所述哈密顿量所代表的量子系统的基态能量。2.根据权利要求1所述的方法，其特征在于，当i值为1时，当前第一参数为初始化的第一参数，当前第二参数为初始化的第二参数；当i值大于1时，当前的第一参数为第i-1次目标操作调节后的第一参数，第二参数为i-1次目标操作调节后的第二参数。3.根据权利要求1所述的方法，其特征在于，所述第一参数为所述经典参数，所述第二参数为所述量子参数。4.根据权利要求3所述的方法，其特征在于，所述固定第一参数，调节第二参数包括：将当前张量网络作为第二测量算符，固定所述第一参数，通过参数转移规则优化所述第二参数，其中，所述参数转移规则的输入为所述第二测量算符。5.根据权利要求3所述的方法，其特征在于，所述固定调节后的第二参数，调节第一参数包括：将张量网络对所述第一参数的梯度作为第一测量算符，对所述第一测量算符进行多次量子测量，得到对应的多个第一测量结果；将多个第一测量结果取平均值得到的值作为梯度值；固定调节后的第二参数，根据所述梯度值，通过梯度下降的方法调节所述第一参数。6.根据权利要求3所述的方法，其特征在于，所述张量网络包括：初始哈密顿量、一个相似变换矩阵及其共轭；其中，所述相似变换矩阵包括至少两个张量。7.根据权利要求6所述的方法，其特征在于，所述张量中包括一个或多个所述第一参数。8.根据权利要求1所述的方法，其特征在于，所述变分量子线路包括：一个或多个对量子比特进行操作的线路，所述线路包括单量子门和多量子门；其中，所述单量子门为用于操控单个量子比特的逻辑门，所述多量子门为操控多个量子比特的逻辑门。9.根据权利要求1所述的方法，其特征在于，所述哈密顿量公式表示为：式中，θ表征经典参数，φ表征量子参数，＜ψ0|表征左矢，U表征相似变换矩阵，表征U的复共轭，H表征哈密顿量，|ψ0＞表征右矢。10.一种基于张量网络和量子线路的混合计算装置，其特征在于，所述装置包括：获取模块，用于：获取目标量子系统待求解最小本征值的哈密顿量，将所述哈密顿量表示为包括经典部分及量子部分的形式；所述经典部分包括经典参数，所述量子部分包括量子参数；所述经典部分计算通过张量网络进行，所述量子部分计算通过变分量子线路进行；初始化模块，用于将所述经典参数和所述量子参数初始化；调节模块，用于根据所述经典参数和所述量子参数，循环执行目标操作，其中，所述目标操作包括：固定经典参数，调节量子参数，固定调节后的量子参数，调节经典参数；其中，第一参数为所述经典参数和所述量子参数其中之一，第二参数为另一参数；确定模块，用于当第i次目标操作得到的所述目标量子系统的能量值与第i-1次目标操作得到的能量值之差低至预设阈值时，将第i次目标操作得到的所述目标量子系统的能量值作为所述哈密顿量所代表的量子系统的基态能量。
说明书desc
技术领域本发明涉及量子计算技术领域，尤其涉及一种基于张量网络和量子线路的混合计算方法及装置。背景技术近年来，量子计算技术不断取得重大进展，这种遵循量子力学规律的新型计算机拥有巨大的潜力。由于量子力学的叠加性质，量子计算机处理任务时天然拥有并行性质，在许多关键问题上可以设计出优于经典计算的算法，例如大数分解算法，例如搜索算法。然而，由于硬件性能的限制，这些算法仅仅表明了这种计算框架的潜力，与具体应用仍然存在距离。当前可用的量子计算芯片是中等规模，含噪声，无纠错芯片。当前最基础最迫切的问题就是充分发挥有限计算资源的潜能。在含噪声的中型量子算法实现过程中，我们要面对两方面的问题，一是突破硬件条件带来的技术限制，二是找到一个有意义有价值的实际应用，展现出真正的量子优势。中等规模量子计算芯片的主要限制之一就是线路深度浅，能够实现的多量子比特纠缠操作数目有限。相比经典计算机中的经典比特，量子比特对噪声更加敏感，容错率更低，而量子线路上的们操作就是噪声来源之一。故而，为了将量子比特的保真度限制在一个合理的范围内，我们不得不将量子线路的深度限制在一个较浅的范围内。特别地，双比特纠缠门操作的保真度通常更低，这导致双比特纠缠门的数目也受到限制。这导致的问题是，有限的纠缠操作只能实现受限的纠缠态，这大大限制了NISQ算法的设计和具体应用。在诸多技术条件的限制下，当前量子算法设计存在困难，要想展现出相对经典计算机的优势更加困难。而目前已有的，例如波色随机采样算法，与现实的，商业或者工业的应用场景脱离较远。解决上述问题的有效方案是经典-量子混合算法，即联合使用量子计算机和经典计算机，同一个算法中既有经典CPU，又有量子比特，取长补短，发挥两者优势。在现有技术中，已有的相关算法是变分量子特征值求解算法，VQE旨在找到给定哈密顿量的最低特征上限。图1示出了VQE算法的过程示意图，如图1所示，首先确定一个待求的哈密顿量，由于哈密顿量的最小本征值等于其在量子态上平均值的最小值，可以将哈密顿量在量子态上的期望作为损失函数，而这个期望值可以通过量子测量得到，再经过经典计算机运行最小化算法，即可得到最小本征值。但是，现有的经典-量子混合算法例如VQE，着眼于调参，利用经典量子计算机作为反馈回路，将含参量子线路中的参数调整到一个最优值。这仅仅是对固定线路结构的优化，并未改变结构本身，也未能增加纠缠操作的数目或者改变线路所能表达的纠缠特性，故仍然受到现有量子芯片纠缠操作的限制。对于较复杂的哈密顿量，例如关联性较强的体系，这种方法不能很好地处理。因此需要有一种新的本征值的查找方法发明内容有鉴于此，本申请实施例提供了一种基于张量网络和量子线路的混合计算方法及装置。第一方面，本申请提供一种基于张量网络和量子线路的混合计算方法，包括：获取目标量子系统待求解最小本征值的哈密顿量，将测量哈密顿量的线路表示为包括经典部分及量子部分的形式；所述经典部分包括经典参数，所述量子部分包括量子参数；所述经典部分计算通过张量网络进行，所述量子部分计算通过变分量子线路进行；将所述经典参数和所述量子参数初始化；根据所述经典参数和所述量子参数，循环执行目标操作，其中，所述目标操作中的第i次操作包括：固定第一参数，调节第二参数，固定调节后的第二参数，调节第一参数；其中，第一参数为所述经典参数和所述量子参数其中之一，第二参数为另一参数；其中，i为大于0的整数；当第i次目标操作得到的所述目标量子系统的能量值与第i-1次目标操作得到的能量值之差低至预设阈值时，将第i次目标操作得到的所述目标量子系统的能量值作为所述哈密顿量所代表的量子系统的基态能量。优选地，当i值为1时，当前第一参数为初始化的第一参数，当前第二参数为初始化的第二参数；当i值大于1时，当前的第一参数为第i-1次目标操作调节后的第一参数，第二参数为i-1次目标操作调节后的第二参数。优选地，所述第一参数为所述经典参数，所述第二参数为所述量子参数。优选地，所述固定第一参数，调节第二参数包括：将当前张量网络作为第二测量算符，固定所述第一参数，通过参数转移规则优化所述第二参数，其中，所述参数转移规则的输入为所述第二测量算符。优选地，所述固定调节后的第二参数，调节第一参数包括：将张量网络对所述第一参数的梯度作为第一测量算符，对所述第一测量算符进行多次量子测量，得到对应的多个第一测量结果；将多个第一测量结果取平均值得到的值作为梯度值；固定调节后的第二参数，根据所述梯度值，通过梯度下降的方法调节所述第一参数。优选地，所述张量网络包括：初始哈密顿量、一个相似变换矩阵及其共轭；其中，所述相似变换矩阵包括至少两个张量。优选地，所述张量中包括一个或多个所述第一参数。优选地，所述变分量子线路包括：一个或多个对量子比特进行操作的线路，所述线路包括单量子门和多量子门；其中，所述单量子门为用于操控单个量子比特的逻辑门，所述多量子门为操控多个量子比特的逻辑门。优选地，所述哈密顿量公式表示为：式中，θ表征经典参数，φ表征量子参数，＜ψ0|表征左矢，U表征相似变换矩阵，表征U的复共轭，H表征哈密顿量，|ψ0＞表征右矢。第二方面，本申请提供一种基于张量网络和量子线路的混合计算装置，包括：获取模块，用于：获取目标量子系统待求解最小本征值的哈密顿量，将所述哈密顿量表示为包括经典部分及量子部分的形式；所述经典部分包括经典参数，所述量子部分包括量子参数；所述经典部分计算通过张量网络进行，所述量子部分计算通过变分量子线路进行；初始化模块，用于将所述经典参数和所述量子参数初始化；调节模块，用于根据所述经典参数和所述量子参数，循环执行目标操作，其中，所述目标操作包括：固定经典参数，调节量子参数，固定调节后的量子参数，调节经典参数；其中，第一参数为所述经典参数和所述量子参数其中之一，第二参数为另一参数；确定模块，用于当第i次目标操作得到的所述目标量子系统的能量值与第i-1次目标操作得到的能量值之差低至预设阈值时，将第i次目标操作得到的所述目标量子系统的能量值作为所述哈密顿量所代表的量子系统的基态能量。本申请将张量网络加入经典处理流程，改变了经典-量子混合线路能够表达的纠缠特性，可以更好的完成本征值求解任务。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1为现有VQE算法的过程示意图；图2为本申请实施例提供的技术方案应用场景示意图；图3为本申请实施例提供的方法步骤示意图；图4为本申请实施例提供的张量网络结构示意图；图5为本申请实施例提供的方法流程示意图；图6为本申请实施例提供的装置示意图；具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。为便于对本发明实施例的理解，下面将结合附图以具体实施例做进一步的解释说明，实施例并不构成对本发明实施例的限定。图2为本申请实施例提供的技术方案应用场景示意图。如图2所示，若干粒子的哈密顿量，通过本申请技术方案提供的方法，可以完成量子系统的基态能量的求解任务。量子系统的基态能量可以认为是求解哈密顿量的最小本征值的任务。本征值是线性代数中的一个重要概念，假设A是n阶方阵，如果存在数m和非零n维列向量x，使得Ax＝mx成立，则称m是A的一个特征值或本征值。在量子力学中，设A是是向量空间的一个线性变换，如果空间中某一非零向量通过A变换后所得到的向量和X仅差一个常数因子，即AX＝kX，则称k为A的特征值。图3为本申请实施例提供的方法步骤示意图。如图3所示，基于张量网络和量子线路的混合计算方法包括：S301：获取目标量子系统待求解最小本征值的哈密顿量，将测量哈密顿量的线路表示为包括经典部分及量子部分的形式；所述经典部分包括经典参数，所述量子部分包括量子参数；所述经典部分计算通过张量网络进行，所述量子部分计算通过变分量子线路进行。在本申请中，采用经典-量子混合算法求解哈密顿量的最小本征值，哈密顿量的最小本征值用于表示量子系统的基态能量。其中，经典部分是采用张量网络的形式，通过经典计算机辅助做的后处理。张量网络，是指把一个高阶张量写成多个低阶张量缩并的形式。张量是一个可以用来可以用来表示在一些矢量、标量和其它张量之间的线性关系的多线性函数。量子部分是通过变分量子线路的算法对参数进行处理，变分量子线路是一种依赖于可调参数的量子算法。其中，变分量子线路包括：一个或多个对量子比特进行操作的线路，所述线路包括单量子门和多量子门。所述单量子门为用于操控单个量子比特的逻辑门，所述多量子门为操控多个量子比特的逻辑门。在一种可能的实施例中，张量网络包括：初始哈密顿量、一个相似变换矩阵及其共轭；其中，所述相似变换矩阵包括至少两个张量。图4为本申请实施例提供的一种张量网络结构示意图。张量网络是经典计算机里的一种表示方法，通常用来做经典后处理。请参考图4，在本申请中的张量网络中的多个张量的连接方式参考了张量链的设计。U表示一个相似变换矩阵，表示U的共轭。U和下的每个长方块表示一个张量，每一条横实线表示张量收缩。H表示初始哈密顿量，即待求解问题的哈密顿量。L表示层数，层数和H所对应的量子比特的数目共同决定了张量网络中张量的个数，张量的个数和每个张量中的参数个数共同决定了整个张量网络中的参数数目。在一种可能的实施例中，每个张量中包括一个或多个所述经典参数。示例性地，可以设置一个张量包含3个参数，L为3层，则一个U中包含8个张量，则共包含3*8＝24个参数。此处一个张量中包含的参数个数以3为例，但不构成对本申请的限定，可以理解，此处每个张量中的参数个数可以根据实际需要设置为不同的数目。本申请中，需要求解的问题是求解哈密顿量的最小本征值，将哈密顿量记为H，将哈密顿量的最小本征值等价转化为＜ψ|H|ψ＞的最小值。即哈密顿量的最小本征值就是＜ψ|H|ψ＞的最小值。其中，|ψ＞表征右矢，表现形式为一个列向量。＜ψ|表征左矢，左矢是相对右矢而言的，在矩阵上体现为右矢的厄米共轭。将哈密顿量的最小本征值的问题通过经典-量子混合算法求解，则＜ψ|H|ψ＞的最小值可以等价表示为上式等价于式中，|ψ0＞表征一个固定的量子态，θ表征张量网络参数，φ表征变分量子线路的参数，U表征一个相似变换矩阵，表征U的复共轭。其中，表示张量网络，U|ψ0＞表示变分量子线路，表示U|ψ0＞的转置，同样为变分量子线路。相似变换矩阵U是几个张量的结合。其中，相似变换矩阵的相关解释为：设A,B都是n阶矩阵，若有可逆矩阵P，使得P-1AP＝B，则矩阵A与B相似，可逆矩阵P为将A变换成B的相似变换矩阵，对A进行运算P-1AP称为对A进行相似变换。参数θ和参数φ的每一次优化，都会使得量子系统离本征值靠近一点。随着参数的不断优化，直到得到一组符合需求的参数θ和参数φ，完成目标问题的求解。S302：将所述经典参数和所述量子参数初始化。将经典部分的参数θ和量子部分的参数φ随机赋予一个值，完成经典部分和量子部分的初始化。在一些可能的实施方式中，量子部分可以利用Hatree-Fock的估算结果进行初始化。经典部分可以先将需要求解的的哈密顿量H分解为矩阵乘积算符，然后将张量网络中相似变换矩阵部分所含的参数随机初始化。S303：根据所述经典参数和所述量子参数，循环执行目标操作，其中，所述目标操作中的第i次操作包括：固定第一参数，调节第二参数，固定调节后的第二参数，调节第一参数；其中，第一参数为所述经典参数和所述量子参数其中之一，第二参数为经典参数和量子参数中确定第一参数之外的另一参数；其中，i为大于0的整数；。在一种较为具体的实施例中，当i值为1时，当前第一参数为初始化的第一参数，当前第二参数为初始化的第二参数；当i值大于1时，当前的第一参数为第i-1次目标操作调节后的第一参数，第二参数为i-1次目标操作调节后的第二参数。第一参数为所述经典参数和所述量子参数其中之一，第二参数为经典参数和量子参数中确定第一参数之外的另一参数。可以理解，在本申请中，循环执行的目标操作中的第i次操作，可以通过先固定变分量子线路的参数，对张量网络部分的参数进行调节，也可以先固定神经网络部分的参数，对变分量子线路的参数进行调节，即，固定经典参数，调节量子参数，固定调节后的量子参数，调节经典参数；也可以是固定量子参数，调节经典参数，固定调节后的经典参数，调节量子参数。在一个较为具体的示例中，所述第一参数为所述经典参数，所述第二参数为所述量子参数。在一种较为具体的实施例中，所述固定第一参数，调节第二参数包括：将当前张量网络作为第二测量算符，固定所述第一参数，通过参数转移规则优化所述第二参数，其中，所述参数转移规则的输入为所述第二测量算符。parameter-shiftrule方法是将梯度下降的计算转化为了两个转移了参数的量子线路来完成计算，经过多个单比特或者多比特的带参量子门，最后对每个量子比特进行测量，以关于泡利算子的期望值作为输出。具体地，将经典计算部分的参数θ固定，根据parameter shift rule优化变分量子线路的参数φ。表示为如下公式：其中，parametershiftrule方法的输入为第二测量算符。在一种较为具体的实施例中，所述固定调节后的第二参数，调节第一参数包括：将张量网络对所述第一参数的梯度作为第一测量算符，对所述第一测量算符进行多次量子测量，得到对应的多个第一测量结果；将多个第一测量结果取平均值得到的值作为梯度值；固定调节后的第二参数，根据所述梯度值，通过梯度下降的方法调节所述第一参数。具体地，将量子部分的参数φ固定，根据梯度下降的方法调节经典计算部分的参数θ。表示为如下公式：S304：当第i次目标操作得到的所述目标量子系统的能量值与第i-1次目标操作得到的能量值之差低至预设阈值时，将第i次目标操作得到的所述目标量子系统的能量值作为所述哈密顿量所代表的量子系统的基态能量。将当前张量网络作为第二测量算符，对第二测量算符进行多次量子测量，得到若干对应的第二测量结果。对得到的若干第二测量结果求平均值，得到当前系统的能量值。计算当前系统的能量值与上一轮优化得到的系统能量值的差得到能量的差值，判断得到的能量差值是否已经低至预先设定的阈值。当能量的差值达到设定的阈值时，跳出循环。因为最小本征值和最终的能量值是相等的，因此第二测量算符的平均值为待求解的哈密顿量的最小本征值。变分量子算法本身包含待优化的损失函数，包含哈密顿量和量子态两部分，同时将哈密顿量和量子态两部分进行参数化。本发明将张量网络加入现有的经典-量子混合方法，更为具体地，将张量网络加入现有的经典-量子混合方法中的经典处理流程，使得方法中不仅要对变分量子线路中的参数φ进行处理，还要对张量网络中的参数θ进行处理，改善了通过混合线路表示的量子态的纠缠特性，可以更好的完成本征值求解的任务。图5为本申请实施例提供的方法流程示意图。在本申请中，采用经典-量子混合算法，其中，经典部分是采用张量网络的形式，通过经典计算机辅助做的后处理。量子部分是通过变分量子线路的算法对参数进行处理。经典计算部分包括参数θ，量子计算部分包括参数φ，参数θ和参数φ的每一次优化，都会使得量子系统离本征值靠近一点。随着参数的不断优化，直到得到一组符合需求的参数θ和参数φ，完成目标问题的求解。将经典部分的参数θ和量子部分的参数φ初始化。在对经典部分和量子部分要处理的参数进行初始化后，将经典部分的参数固定，只调节量子部分的参数。将当前张量网络作为测量算符，通过参数转移规则，对量子部分进行优化。其中，parametershiftrule的输入就是张量网络。将量子部分的参数进行固定，调节经典部分的参数，根据固定的参数做量子测量。将张量网络对参数的梯度作为测量算符，通过对测量算符进行多次量子测量取平均值，得到梯度值。将调节参数后的张量网络本身作为测量算符，进行多次量子测量取平均值，得到一个期望值，将这个期望值作为量子系统的能量值。将得到的能量值与上一次的能量值比较，得到能量误差，判断得到的能量误差是否低到设定的阈值。当误差低到设定的阈值时，将得到的本征值作为最终结果。其中，测量算符的平均值就是要求的本征值。基于上述实施例中提供的基于张量网络和量子线路的混合计算方法，本实施例中提供一种基于张量网络和量子线路的混合计算装置，具体地，图6示出了该基于张量网络和量子线路的混合计算装置的可选的结构框图，该装置被分割成一个或多个程序模块，一个或者多个程序模块被存储于存储介质中，并由一个或多个处理器所执行，以完成本发明。本发明所称的程序模块是指能够完成特定功能的一系列计算机程序指令段，比程序本身更适合描述基于张量网络和量子线路的混合计算装置在存储介质中的执行过程，以下描述将具体介绍本实施例各程序模块的功能。该装置具体包括：获取模块601，用于：获取目标量子系统待求解最小本征值的哈密顿量，将所述哈密顿量表示为包括经典部分及量子部分的形式；所述经典部分包括经典参数，所述量子部分包括量子参数；所述经典部分计算通过张量网络进行，所述量子部分计算通过变分量子线路进行；初始化模块602，用于将所述经典参数和所述量子参数初始化；调节模块603，用于根据所述经典参数和所述量子参数，循环执行目标操作，其中，所述目标操作包括：固定经典参数，调节量子参数，固定调节后的量子参数，调节经典参数；其中，第一参数为所述经典参数和所述量子参数其中之一，第二参数为另一参数；确定模块604，用于当第i次目标操作得到的所述目标量子系统的能量值与第i-1次目标操作得到的能量值之差低至预设阈值时，将第i次目标操作得到的所述目标量子系统的能量值作为所述哈密顿量所代表的量子系统的基态能量。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括要素的过程、方法、物品或者装置中还存在另外的相同要素。本领域普通技术人员可以理解实现上述实施例的全部或部分步骤可以通过硬件来完成，也可以通过程序来指令相关的硬件完成，程序可以存储于一种计算机可读存储介质中，上述提到的存储介质可以是只读存储器，磁盘或光盘等。以上的具体实施方式，对本发明的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上仅为本发明的具体实施方式而已，并不用于限定本发明的保护范围，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
