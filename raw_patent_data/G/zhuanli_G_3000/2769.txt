标题title
一种数字虚拟对象的装饰物处理方法、装置及存储介质
摘要abst
本发明涉及一种数字虚拟对象的装饰物处理方法、装置及存储介质，数字虚拟对象的装饰物依附在依托物上，其中，该方法包括：根据所述装饰物与依托物的粒子的位置关系确定出目标粒子；根据所述目标粒子确定出目标位置；根据所述目标位置渲染处理所述装饰物。本发明实施例通过装饰物与依托物的粒子的位置关系找出目标粒子，继而根据目标粒子确定出目标位置，根据目标位置渲染处理所述装饰物，可以使装饰物跟随虚拟对象的依托物进行物理运动，并保持装饰物的位置、旋转朝向与依托物的一致性。
权利要求书clms
1.一种数字虚拟对象的装饰物处理方法，其特征在于，数字虚拟对象的装饰物依附在依托物上，所述方法包括：根据所述装饰物与依托物的粒子的位置关系确定出目标粒子；根据所述目标粒子确定出目标位置；根据所述目标位置渲染处理所述装饰物。2.根据权利要求1所述的方法，其特征在于，所述目标粒子为所述依托物的一个粒子；所述根据所述目标粒子确定出目标位置，包括：将所述目标粒子的位置作为所述目标位置；将所述目标粒子的属性修改为可见；将所述依托物的所有粒子中除所述目标粒子之外的其它粒子的属性修改为不可见。3.根据权利要求1所述的方法，其特征在于，所述目标粒子为所述依托物的引导线路径上的两个粒子，该两个粒子距离装饰物最近，所述装饰物位于所述目标粒子之间；所述根据所述目标粒子确定出目标位置，包括：通过利用所述装饰物与目标粒子的距离对粒子位置进行插值，得到目标位置。4.根据权利要求1所述的方法，其特征在于，所述根据所述目标位置渲染处理所述装饰物，包括：根据所述目标位置对应的位置信息和旋转朝向信息渲染处理所述装饰物。5.一种数字虚拟对象的装饰物处理装置，其特征在于，用于数字虚拟对象的装饰物依附在依托物上的虚拟对象处理系统中，所述装置包括：第一确定单元，用于根据所述装饰物与依托物的粒子的位置关系确定出目标粒子；第二确定单元，用于根据所述目标粒子确定出目标位置；渲染单元，用于根据所述目标位置渲染处理所述装饰物。6.根据权利要求5所述的装置，其特征在于，所述目标粒子为所述依托物的一个粒子；所述第二确定单元，用于：将所述目标粒子的位置作为所述目标位置；将所述目标粒子的属性修改为可见；将所述依托物的所有粒子中除所述目标粒子之外的其它粒子的属性修改为不可见。7.根据权利要求5所述的装置，其特征在于，所述目标粒子为所述依托物的引导线路径上的两个粒子，该两个粒子距离装饰物最近，所述装饰物位于所述目标粒子之间；所述第二确定单元，用于：通过利用所述装饰物与目标粒子的距离对粒子位置进行插值，得到目标位置。8.根据权利要求5所述的装置，其特征在于，所述渲染单元，用于：根据所述目标位置对应的位置信息和旋转朝向信息渲染处理所述装饰物。9.一种电子设备，其特征在于，所述电子设备包括：一个或多个处理器；存储器，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器读取并执行，使得所述一个或多个处理器实现如权利要求1-4中任意一项所述的数字虚拟对象的装饰物处理方法。10.一种非暂态计算机可读存储介质，其上存储有计算机程序或指令，其特征在于，该程序或指令被处理器执行时实现如权利要求1-4中任意一项所述的数字虚拟对象的装饰物处理方法。
说明书desc
技术领域本发明涉及云计算技术领域，具体涉及一种数字虚拟对象的装饰物处理方法、装置及存储介质。背景技术目前，随着游戏引擎的发展，虚幻引擎4.27版本中已经提供了真实感更强的Groom毛发渲染和基于Niagara的毛发动力学模拟。为了丰富数字虚拟对象头部的装饰效果，需要使发卡、发带等装饰物能够跟随数字虚拟对象的发丝进行物理运动，但虚幻引擎4.27版本未内置相关功能。发明内容因此，本发明提供一种数字虚拟对象的装饰物处理方法、装置、设备及存储介质，可以使装饰物跟随依托物进行物理运动，并保持装饰物的位置、旋转朝向与依托物的一致性。第一方面，本发明提供了一种数字虚拟对象的装饰物处理方法，数字虚拟对象的装饰物依附在依托物上，所述方法包括：根据所述装饰物与依托物的粒子的位置关系确定出目标粒子；根据所述目标粒子确定出目标位置；根据所述目标位置渲染处理所述装饰物。第二方面，本发明实施例还提供一种数字虚拟对象的装饰物处理装置，用于数字虚拟对象的装饰物依附在依托物上的虚拟对象处理系统中，所述装置包括：第一确定单元，用于根据所述装饰物与依托物的粒子的位置关系确定出目标粒子；第二确定单元，用于根据所述目标粒子确定出目标位置；渲染单元，用于根据所述目标位置渲染处理所述装饰物。第三方面，本发明实施例还提供一种电子设备，所述电子设备包括：一个或多个处理器；存储器，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器读取并执行，使得所述一个或多个处理器实现如上述的数字虚拟对象的装饰物处理方法。第四方面，本发明实施例还提供一种非暂态计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现上述的数字虚拟对象的装饰物处理方法。由上述技术方案可知，本发明实施例提供的本发明实施例提供的数字虚拟对象的装饰物处理方法、装置、设备及存储介质，与现有技术相比，通过装饰物与依托物的粒子的位置关系找出目标粒子，继而根据目标粒子确定出目标位置，根据目标位置渲染处理装饰物，可以使装饰物跟随虚拟对象的依托物进行物理运动，并保持装饰物的位置、旋转朝向与依托物的一致性，并且可以使用原生的粒子系统的网格渲染器渲染发饰模型，在粒子系统内部直接完成，位置数据同步更快，改善了数据同步的延迟问题。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作一简单的介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一个实施例中数字虚拟对象的装饰物处理方法流程示意图；图2为本发明一个实施例数字虚拟对象的装饰物处理装置结构示意图；图3为本发明一个实施例中运行本说明书实施例的数字虚拟对象的装饰物处理方法的电子设备一种硬件结构示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。除非另有定义，本文所使用的所有的技术和科学术语与属于本申请的技术领域的技术人员通常理解的含义相同。本文中所使用的术语只是为了描述本申请实施例的目的，不是旨在限制本申请。1）数字虚拟对象，指人或动物的三维虚拟模型，可应用于直播、游戏等应用中。2）依托物，数字虚拟对象中的部分部件或者附着物。该依托物可以是虚拟人物、虚拟动物的毛发、服装等。3）装饰物，数字虚拟对象的依托物上的装饰物。该装饰物可以是毛发上的发饰，服装上的配饰、扣子等。本申请实施例提供一种数字虚拟对象的装饰物处理方法、装置、设备及存储介质，通过对虚幻引擎4.27中的毛发系统组件GroomComponent和内置毛发解算器进行研究，修改扩展了新功能。具体是利用虚幻引擎的粒子系统NiagaraSystem在粒子模拟毛发进行物理运动的基础上，利用粒子位置信息使用虚幻引擎原生的NiagaraSystem的网格渲染器MeshRenderer渲染发饰模型，来使数字虚拟对象的装饰物跟随依托物进行物理运动，并保持装饰物的位置、旋转朝向与依托物的一致性。本申请实施例提供的数字虚拟对象的装饰物处理方法可以由各种电子设备实施，例如，可以由终端单独实施，也可以由云服务器单独实施，也可以由终端和云服务器协同实施。例如云服务器独自执行本申请实施例提供的数字虚拟对象的装饰物处理方法，或者，终端向云服务器发送针对虚拟对象的装饰物处理请求，云服务器根据接收的装饰物处理请求执行本申请实施例提供的数字虚拟对象的装饰物处理方法。本申请实施例可应用于各种场景，包括但不限于云技术、人工智能、智慧交通、辅助驾驶等。参见图1，数字虚拟对象的装饰物依附在依托物上，本发明实施例提供的数字虚拟对象的装饰物处理方法如下：首先，介绍S11根据所述装饰物与依托物的粒子的位置关系确定出目标粒子的步骤。在执行本步骤之前，可以利用外部DCC软件例如maya制作获得Groom毛发资产作为虚幻引擎中的毛发数据，并使用虚幻引擎内置的Niagara毛发解算器为毛发添加动力学模拟效果。之后需要对引擎内置毛发解算器进行修改和完善，添加装饰物跟随依托物的具体实现。下面以StableSpringsSystem毛发解算器为例的位置信息，将装饰物位置传给负责毛发动力学模拟的粒子系统NiagaraSystem，例如，可以使用插件StableSpringsSystem传给负责毛发动力学模拟的粒子系统NiagaraSystem。之后查询所述依托物的所有粒子，找出目标粒子。具体可以在StableSpringsSystem内部通过传入装饰物的位置来查询距离此位置最近的粒子作为目标粒子。目标粒子的确定包括两种情形：一、装饰物的位置与依托物的一个粒子的位置相同，此时目标粒子即为该依托物粒子；二、装饰物的位置与依托物的所有粒子的位置均不相同，装饰物位于依托物的引导线路径上的两个粒子之间，该两个粒子距离装饰物最近，此时目标粒子即为该两个粒子。然后，介绍S12根据所述目标粒子确定出目标位置的步骤。本发明实施例中，如果装饰物的位置与依托物的一个粒子的位置相同，也就是目标粒子唯一，则该依托物的粒子即是目标粒子，目标粒子的位置即是目标位置，后续可以使用目标位置和目标粒子的旋转朝向信息渲染装饰物；而如果装饰物的位置与依托物的所有粒子的位置均不相同，则目标粒子是依托物的引导线路径上距离装饰物最近的两个粒子，装饰物位于目标粒子之间，此时需要利用装饰物与目标粒子的距离对粒子位置进行插值，确定出目标位置，在插值过程中不仅需要对位置信息进行插值，还需要对旋转朝向信息进行插值，后续可以使用目标位置对应的位置信息和旋转朝向信息渲染装饰物。如果目标粒子是第一种情形，也即只有一个的情形，在根据所述目标位置渲染处理所述装饰物之前，还包括修改所述目标粒子的属性信息的步骤，具体包括：将所述目标粒子的属性修改为可见；将所述依托物的所有粒子中除所述目标粒子之外的其它粒子的属性修改为不可见。例如，将目标粒子的Particles.VisibilityTag属性设置为1，将所述目标粒子之外的其它粒子的Particles.VisibilityTag属性设置为0。在修改完属性之后，即实现用装饰物替换目标粒子，之后可以按照目标粒子的位置信息、旋转朝向信息渲染处理所述装饰物。具体可以通过粒子ID设置目标粒子显示模式，通过使用目标粒子的位置信息、旋转朝向信息来渲染装饰物模型，具体实现时可以在粒子发射器中使用网格渲染器MeshRenderer直接渲染装饰物Mesh。使用原生的粒子系统的网格渲染器渲染装饰物模型，在粒子系统内部直接完成，因此位置数据同步更快，改善了数据同步的延迟问题。最后，介绍S3根据所述目标位置渲染处理所述装饰物的步骤。不管目标粒子是第一种情形，还是第二种情形，均可以确定出对应的位置信息和旋转朝向信息，只不过第一种情形下的位置信息是目标粒子的位置信息，第一种情形下的旋转朝向信息是目标粒子的旋转朝向信息；而第二种情形下的位置信息和旋转朝向信息均是通过差值获得。综上所述，本发明实施例提供的数字虚拟对象的装饰物处理方法，通过装饰物与依托物的粒子的位置关系找出目标粒子，继而根据目标粒子确定出目标位置，根据目标位置渲染处理装饰物，可以使装饰物跟随虚拟对象的依托物进行物理运动，并保持装饰物的位置、旋转朝向与依托物的一致性，同时使用原生的粒子系统的网格渲染器渲染装饰物模型，在粒子系统内部直接完成，因此位置数据同步更快，改善了数据同步的延迟问题。为进一步体现本发明提供的一种数字虚拟对象的装饰物处理方法的优越性，本发明还提供一种数字虚拟对象的装饰物处理装置，如图2所示，用于数字虚拟对象的装饰物依附在依托物上的虚拟对象处理系统中，所述装置包括：第一确定单元21，用于根据所述装饰物与依托物的粒子的位置关系确定出目标粒子；第二确定单元22，用于根据所述目标粒子确定出目标位置；渲染单元23，用于根据所述目标位置渲染处理所述装饰物。在前述装置实施例的基础上，所述目标粒子可以为所述依托物的一个粒子；所述第二确定单元，可以用于：将所述目标粒子的位置作为所述目标位置；将所述目标粒子的属性修改为可见；将所述依托物的所有粒子中除所述目标粒子之外的其它粒子的属性修改为不可见。在前述装置实施例的基础上，所述目标粒子可以为所述依托物的引导线路径上的两个粒子，该两个粒子距离装饰物最近，所述装饰物位于所述目标粒子之间；所述第二确定单元，可以用于：通过利用所述装饰物与目标粒子的距离对粒子位置进行插值，得到目标位置。在前述装置实施例的基础上，所述渲染单元，可以用于：通过利用所述装饰物与目标粒子的距离对粒子位置进行插值，得到目标位置。本说明书实施例提供的数字虚拟对象的装饰物处理装置，其实现过程与本申请实施例提供的数字虚拟对象的装饰物处理方法一致，所能达到的效果也与本申请实施例提供的数字虚拟对象的装饰物处理方法相同，在此不再赘述。本发明实施例还提供一种电子设备，如图3所示，所述电子设备包括：一个或多个处理器；存储器，用于存储一个或多个程序；当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现本说明书实施例中上述数字虚拟对象的装饰物处理方法的各个步骤。本说明书实施例提供的电子设备，其实现过程与本申请实施例提供的数字虚拟对象的装饰物处理方法一致，所能达到的效果也与本申请实施例提供的数字虚拟对象的装饰物处理方法相同，在此不再赘述。本说明书的实施例提供了一种计算机可读存储介质，该存储介质上存储有计算机程序，这些计算机程序在被处理器运行时，执行本说明书实施例中上述数字虚拟对象的装饰物处理方法的各个步骤。本说明书实施例提供的计算机可读存储介质，其实现过程与本申请实施例提供的数字虚拟对象的装饰物处理方法一致，所能达到的效果也与本申请实施例提供的数字虚拟对象的装饰物处理方法相同，在此不再赘述。以上所述仅为本申请的可选实施例，并不用以限制本申请，凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
