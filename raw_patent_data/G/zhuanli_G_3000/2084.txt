标题title
基于机器学习的碳排放量预测模型的训练方法及装置
摘要abst
本申请涉及碳排放量预测技术领域，提供了基于机器学习的碳排放量预测模型的训练方法及装置，该方法在获取各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集；针对任一初始训练集，基于初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集；基于预设的图卷积网络，对当前训练集中的各企业训练样本进行特征提取，得到当前训练集对应的图特征向量；采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型。该方法提升了碳排放预测方法的预测精度。
权利要求书clms
1.一种基于机器学习的碳排放量预测模型的训练方法，其特征在于，所述方法包括：获取包括各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集；所述初始企业训练样本为包括企业经营数据、企业生产数据、企业工艺数据和企业周围环境数据的历史企业数据；所述初始企业训练样本包括样本数量大于第一数量的多数类初始样本和样本数量小于第一数量的少数类初始样本；针对任一初始训练集，基于所述初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集；以及，基于预设的图卷积网络，对所述当前训练集中的各企业训练样本进行特征提取，得到所述当前训练集对应的图特征向量；所述图卷积网络的输入层包括预先引入与碳排放相关的先验知识；采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型，所述多任务预测模型用于预测碳排放量的任务和与所述预测碳排放量相关的环境指标的任务。2.如权利要求1所述的方法，其特征在于，基于所述初始训练集中的各少数类初始样本以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集，包括：针对任一少数类初始样本，计算所述少数类初始样本与其相邻的第二数量个多数类初始样本间的欧氏距离；基于预设随机森林分类器对所述初始训练集进行分类得到的各初始企业训练样本的分类准确率，以及所述少数类初始样本的权重因子，确定样本调节系数，所述权重因子是基于所述第二数量个的欧氏距离确定的；基于所述少数类初始样本、所述第二数量个欧氏距离和所述样本调节系数，生成所述少数类初始样本对应的少数类新样本；利用模糊聚类算法，对少数类初始样本、少数类新样本和多数类样本进行聚类，确定不同聚集类的聚类中心和聚类半径；基于不同聚集类的聚类中心和聚类半径，获取当前训练集。3.如权利要求2所述的方法，其特征在于，基于不同聚集类的聚类中心和聚类半径，获取当前训练集，包括：基于不同聚集类的聚类中心和聚类半径，获取新训练集；对所述新训练集中的各企业训练样本进行最大最小归一化；归一化后的企业训练样本进行冗余数据和异常值的去除，得到当前训练集。4.如权利要求1所述的方法，其特征在于，基于预设的图卷积网络，对所述当前训练集中的各企业训练样本进行特征提取，得到所述当前训练集对应的图特征向量，包括：以所述当前训练集中的各企业训练样本作为节点，以各企业训练样本间的相似度作为节点关系，确定所述当前训练集对应的图数据；将所述图数据输入预设的图卷积网络，所述图卷积网络基于所述节点关系的连接强度，确定各企业训练样本的样本权重，之后，采用自注意力机制，对所述各企业训练样本和相应样本权重进行加权聚合，得到所述当前训练集对应的图特征向量。5.如权利要求1所述的方法，其特征在于，采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型，包括：针对任一迭代，采用预设的损失函数，对多层神经网络分类器输出的各当前训练集对应的多任务预测值与所述标签数据的真实值进行计算，得到当前迭代的梯度；采用预设学习率调整算法，基于所述当前迭代的梯度，对当前迭代的学习率进行动态调整，得到新学习率和所述新学习率对应的模型参数，并进行下一迭代，直到达到预设的迭代终止条件，将最后得到的模型参数作为训练完成的多层神经网络分类器的模型参数。6.如权利要求5所述的方法，其特征在于，所述预设的损失函数表示为：其中，是任务权重，/＞是第i个任务的损失函数，m为任务总数；第i个任务的损失函数表示为：其中，是任务/＞的真实值，/＞是任务/＞的预测值，/＞为改进损失函数，为任务相关性损失项，/＞是任务相关性损失项的权重；任务相关性损失项表示为：其中，是任务/＞和任务/＞之间的相关性系数，任务/＞的预测值为/＞，任务/＞的预测值为；改进损失函数表示为：其中，是任务/＞的真实值，/＞是任务/＞的预测值，/＞是控制平滑范围的参数。7.如权利要求5所述的方法，其特征在于，所述预设学习率调整算法，包括：其中，表示第t步迭代时的学习率，/＞表示第t-1步迭代时的学习率，/＞表示在第t步迭代时的模型参数，/＞表示在第t-1步迭代时的模型参数，/＞表示在第t步迭代时损失函数关于参数/＞的梯度，/＞表示在第t步迭代时梯度的一阶矩估计值，/＞表示在第t-1步迭代时梯度的一阶矩估计值，/＞表示在第t步迭代时梯度的二阶矩估计值，/＞表示在第t-1步迭代时梯度的二阶矩估计值，/＞表示一阶动量衰减系数，取值范围为本申请涉及碳排放量预测技术领域，具体而言，涉及一种基于机器学习的碳排放量预测模型的训练方法及装置。背景技术随着全球经济和人口的增长，环境问题变得越来越严重。其中，碳排放问题是环境问题的重要组成部分之一。为了有效控制和减少碳排放量，科学家和政府部门需要对碳排放量进行准确的预测和分析，以制定相应的环境政策和行动计划。机器学习作为一种新兴的技术手段，具有自动化、高效率、可靠性等优点，因此在环境保护领域得到了广泛的应用。机器学习技术可以通过处理大量的历史数据，从中学习到环境数据的内在规律和趋势，进而进行精准的预测和分析。在碳排放量预测方面，机器学习技术可以通过构建碳排放量预测模型，对未来碳排放量进行预测。同时，机器学习技术还可以对碳排放量进行分析，找出对碳排放量影响最大的因素，为制定环境政策和行动计划提供科学依据。传统的碳排放量预测方法基于历史排放数据，首先进行二氧化碳排放量历史数据的变化趋势分析，然后推测未来二氧化碳排放量的变化，推测模型的本质是选择合理的函数类型拟合历史数据的变化走向，拟合函数的选择的依据为历史数据的变化趋势，二次函数、对数函数和指数函数等为此类方法常选择的拟合函数，所以此类方法适用于历史数据变化规律较为明显的预测问题，但对于历史数据变化规律不明显的多影响因素预测问题的预测效果不理想。基于机器学习的碳排放量预测方法通常利用训练样本进行模型的训练，但难以解决对训练样本依赖性强等问题，尤其是在训练样本不足的情况下训练的模型十分容易产生过拟合的问题。发明内容本申请实施例的目的在于提供一种基于机器学习的碳排放量预测模型的训练方法及装置，用以解决现有技术存在的上述问题，通过深度学习网络算法对待预测碳排放数据进行预测，提升了碳排放预测方法的预测精度。第一方面，提供了一种基于机器学习的碳排放量预测模型的训练方法，该方法可以包括：获取包括各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集；所述初始企业训练样本为包括企业经营数据、企业生产数据、企业工艺数据和企业周围环境数据的历史企业数据；所述初始企业训练样本包括样本数量大于第一数量的多数类初始样本和样本数量小于第一数量的少数类初始样本；针对任一初始训练集，基于所述初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集；以及，基于预设的图卷积网络，对所述当前训练集中的各企业训练样本进行特征提取，得到所述当前训练集对应的图特征向量；所述图卷积网络的输入层包括预先引入与碳排放相关的先验知识；采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型，所述多任务预测模型用于预测碳排放量的任务和与所述预测碳排放量相关的环境指标的任务。第二方面，提供了一种基于机器学习的碳排放量预测模型的训练装置，该装置可以包括：获取单元，用于获取包括各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集；所述初始企业训练样本为包括企业经营数据、企业生产数据、企业工艺数据和企业周围环境数据的历史企业数据；所述初始企业训练样本包括样本数量大于第一数量的多数类初始样本和样本数量小于第一数量的少数类初始样本；以及，针对任一初始训练集，基于所述初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集；提取单元，用于基于预设的图卷积网络，对所述当前训练集中的各企业训练样本进行特征提取，得到所述当前训练集对应的图特征向量；所述图卷积网络的输入层包括预先引入与碳排放相关的先验知识；训练单元，用于采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型，所述多任务预测模型用于预测碳排放量的任务和与所述预测碳排放量相关的环境指标的任务。第三方面，提供了一种电子设备，该电子设备包括处理器、通信接口、存储器和通信总线，其中，处理器，通信接口，存储器通过通信总线完成相互间的通信；存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现上述第一方面中任一所述的方法步骤。第四方面，提供了一种计算机可读存储介质，该计算机可读存储介质内存储有计算机程序，所述计算机程序被处理器执行时实现上述第一方面中任一所述的方法步骤。本申请提供的基于机器学习的碳排放量预测模型的训练方法可以在获取各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集；初始企业训练样本为包括企业经营数据、企业生产数据、企业工艺数据和企业周围环境数据的历史企业数据；初始企业训练样本包括样本数量大于第一数量的多数类初始样本和样本数量小于第一数量的少数类初始样本；针对任一初始训练集，基于初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集；以及，基于预设的图卷积网络，对当前训练集中的各企业训练样本进行特征提取，得到当前训练集对应的图特征向量；图卷积网络的输入层包括预先引入与碳排放相关的先验知识；采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型，多任务预测模型用于预测碳排放量的任务和与预测碳排放量相关的环境指标的任务。该方法提升了碳排放预测方法的预测精度。附图说明为了更清楚地说明本申请实施例的技术方案，下面将对本申请实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本申请的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1为本申请实施例提供的一种基于机器学习的碳排放量预测模型的训练方法的流程示意图；图2为本申请实施例提供的一种基于机器学习的碳排放量预测模型的训练装置的结构示意图；图3为本申请实施例提供的一种电子设备的结构示意图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本申请一部分实施例，并不是全部的实施例。基于本申请实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。为了方便理解，下面对本申请实施例中涉及的名词进行解释：SMOTE是一种经典的样本扩充算法，主要用于处理不平衡数据集。SMOTE算法的基本思想是通过插值的方式生成新的样本，以达到样本平衡的目的。GCN是一种神经网络模型，它可以在图结构数据上进行卷积操作，从而捕捉节点之间的相互作用和依赖关系。GCN中的每个卷积层都可以表示为：其中，是第/＞层的节点特征矩阵，/＞是第/＞层的节点特征矩阵，/＞是第/＞层的权重矩阵，/＞是邻接矩阵加上自连接的结果，/＞是/＞的单位矩阵，/＞是度矩阵，用于描述图中每个节点与该节点相连的边的数量。/＞表示ReLU非线性激活函数。在本算法中，使用GCN对图进行多层卷积，得到更丰富的节点特征表示/＞，其中是GCN的层数。然后，对每个节点/＞提取其对应的特征向量/＞，作为样本的特征表示。具体地，使用节点特征矩阵/＞的每一行作为对应节点的特征向量，即/＞，其中，为节点/＞的特征矩阵。最终，将多个自适应卷积层堆叠起来，得到多层GCN模型。然后，将最后一层卷积的输出作为整个图的特征表示。Fisher准则是一种经典的分类性能评估方法，它基于类别内方差和类别间方差的比值进行评估。在这里，假设分类结果中有个类别，每个类别的样本数量分别为，则整个数据集的方差可以表示为：其中，表示总样本数量，/＞表示第/＞类中的第/＞个样本的真实标签值，/＞表示第/＞类样本的平均标签值。类别内方差表示为：；类别间方差表示为：；其中，表示整个数据集的平均标签值。根据Fisher准则，分类器的整体准确率可以用类别内方差和类别间方差的比值来衡量：Fisher准则的值越大，表示分类器的整体准确率越高。对于每个类别的准确率，使用KS检验进行评估。KS检验是一种经典的统计学方法，用于比较两个样本的分布是否相同。在这里，使用KS检验来比较分类结果中每个类别的分布是否符合真实分布。假设一个类别中有个样本，将其按照真实标签进行排序，并计算其累计分布函数/＞，其中/＞表示真实标签。本申请实施例提供的基于机器学习的碳排放量预测模型的训练方法可以应用在服务器或终端中。该服务器可以是物理服务器，也可以是多个物理服务器构成的服务器集群或者分布式系统，还可以是提供云服务、云数据库、云计算、云函数、云存储、网络服务、云通信、中间件服务、域名服务、安全服务、内容分发网络，以及大数据和人工智能平台等基础云计算服务的云服务器。终端可以是移动电话、智能电话、笔记本电脑、数字广播接收器、个人数字助理、平板电脑等用户设备、手持设备、车载设备、可穿戴设备、计算设备或连接到无线调制解调器的其它处理设备、移动台、移动终端等。以下结合说明书附图对本申请的优选实施例进行说明，应当理解，此处所描述的优选实施例仅用于说明和解释本申请，并不用于限定本申请，并且在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。图1为本申请实施例提供的一种基于机器学习的碳排放量预测模型的训练方法的流程示意图。如图1所示，该方法可以包括：步骤S110、获取包括各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集。初始训练集中的初始企业训练样本为包括企业经营数据、企业生产数据、企业工艺数据和企业周围环境数据的历史企业数据。初始训练集中的标签数据为所述历史企业数据对应的历史碳排放量区间的序号标识和与所述预测碳排放量相关的环境指标的序号标识。以历史碳排放量区间为例，历史碳排放量区间与相应序号标识间的对应关系可以包括：序号标识1代表碳排放量为其中，初始企业训练样本包括样本数量大于第一数量的多数类初始样本和样本数量小于第一数量的少数类初始样本。可以理解的是，企业训练样本可以表示为包括不同数据属性的属性值构成的向量。步骤S120、针对任一初始训练集，基于初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集。SMOTE算法存在一个问题，即它只考虑了少数类样本之间的插值，而忽略了少数类样本和多数类样本之间的关系，导致生成的新样本可能会偏向于某些多数类样本，从而影响了算法的泛化性能。针对上述问题，本发明提出了一种改进的SMOTE算法，称为MSMOTE算法。MSMOTE算法在生成新样本时，考虑了少数类样本和多数类样本之间的关系，从而生成更加逼近真实分布的新样本。具体算法步骤如下：针对任一少数类初始样本，计算该少数类初始样本与其相邻的第二数量个多数类初始样本间的欧氏距离；采用预设随机森林分类器，对初始训练集进行分类，得到的各初始企业训练样本的分类准确率，该预设随机森林分类器可以是基于不同初始训练集训练得到的；基于得到的各初始企业训练样本的分类准确率和少数类初始样本的权重因子α，确定样本调节系数。其中，该少数类初始样本的权重因子α是基于第二数量个欧氏距离确定的；基于少数类初始样本、第二数量个欧氏距离和样本调节系数，生成少数类初始样本对应的少数类新样本；在一个例子中，少数类新样本的生成过程包括：1）利用不同初始训练集训练一个随机森林分类器，得到该分类器对各个类别的分类准确率。2）在初始训练集中随机选择一个少数类样本，记为样本Ei；3）对于Ei的k个最近邻样本中的每个样本，计算Ei与该样本的欧氏距离，记为diff，diff为k个欧氏距离中的任一一个；4）计算样本权重。对于少数类样本，其少数类样本权重/＞通过以下公式计算得到：其中，为随机森林分类器对样本Ei类别的分类准确率，k为选取的最近邻数目，为一个很小的正数，用于避免分母为0的情况。5）计算权重因子α，通过调整权重因子α的大小，可以控制新样本的相似度和多样性。权重因子α可以通过以下公式计算得到：其中，表示少数类样本Ei和它的第/＞个最近邻多数类样本的欧式距离，为k个最近邻多数类样本中的最大距离。6）生成少数类新样本x'，生成方式为：需要说明的是，新样本x'的样本标签的生成过程与上述相同，本申请实施例在此不做赘述。之后，利用模糊聚类算法，对少数类初始样本、少数类新样本和多数类样本进行聚类，确定不同聚集类的聚类中心和聚类半径；基于不同聚集类的聚类中心和聚类半径，生成新的企业训练样本，该新的企业训练样本可以是少数类的新样本，也可以是多数类的新样本。在一个例子中，新的企业训练样本的生成过程包括：1）利用模糊聚类算法，将少数类样本和多数类样本聚类到不同的聚集类中，得到ks个聚集类。2）对于每个聚集类，计算并找到其聚类中心ci，并计算其聚类半径ri。3）对于每个聚集类，根据其聚类中心ci和聚类半径ri，生成新的企业训练样本。其中，新的企业训练样本的生成算法包括：a.随机生成一个影响因子Se，且Se∈。b.生成新样本，其中Δ为一个随机向量，服从高斯分布或均匀分布；进一步的，将生成的新的企业训练样本添加至初始训练集中。按照执行顺序，重复执行上述的少数类新样本的生成过程和新的企业训练样本的生成过程，直到分类性能满足预设要求或达到最大循环次数为止。由此，获取到新训练集，记为。需要说明的是，由于模糊聚类算法是对每个聚集类里扩充，故扩充出的样本的标签数据，与该聚集类所属的类别相同。为了提高预测准确性，需要对新训练集中的企业训练样本进行预处理，以得到当前训练集。具体的，基于不同聚集类的聚类中心和聚类半径获取新训练集之后，对新训练集中的各企业训练样本进行最大最小归一化；归一化后的企业训练样本进行冗余数据和异常值的去除，得到当前训练集。在一个例子中，首先，对扩充后的平衡样本数据集进行最大最小归一化，公示如下：/＞其中为/＞数据集中的样本数据的最大值，/＞为样本数据的最小值，/＞为归一化前的样本数据，/＞为归一化后的样本数据。经过最大最小归一化后，得到数据集/＞。在数据归一化后，对冗余数据进行去除，并对异常值进行去除，得到预处理后的数据集。步骤S130、基于预设的图卷积网络，对当前训练集中的各企业训练样本进行特征提取，得到当前训练集对应的图特征向量。其中，图卷积网络的输入层包括预先引入与碳排放相关的先验知识，包括行业、城市、企业规模等信息。这些先验特征可以提供更丰富的信息，帮助模型更好地区分不同样本之间的差异。为了解决碳排放量预测任务中的特征提取问题，本申请提出了一种基于图卷积网络的创新性特征提取算法。该算法结合了GCN的优势和针对碳排放量预测任务的特点，能够更好地挖掘训练样本数据中的特征信息。将数据集中的数据表示为一个图/＞，其中/＞是节点集合，/＞是边集合。每个节点/＞代表一个样本，每个边/＞表示节点/＞与节点/＞之间存在一定的关系，可以通过相似性或距离度量进行定义。使用邻接矩阵/＞表示图/＞的连接关系，其中/＞是节点数。邻接矩阵的元素/＞表示节点/＞和节点/＞之间的连接强度。具体实施中，以当前训练集中的各企业训练样本作为节点，以各企业训练样本间的相似度作为节点关系，确定当前训练集对应的图数据；将图数据输入预设的图卷积网络，图卷积网络基于节点关系的连接强度，确定各企业训练样本的样本权重；采用自注意力机制，对各企业训练样本和相应样本权重进行加权聚合，得到当前训练集对应的图特征向量。其中，自注意力机制可以表示为：其中，,/＞,/＞分别是查询、键、值的特征向量矩阵，/＞是特征向量的维度。在本算法中，将节点特征矩阵/＞作为/＞、/＞和/＞的输入，得到聚合后的节点特征向量：/＞其中，是节点数，/＞是第个/＞节点，/＞是节点/＞的权重，定义为：最终的节点特征向量可以作为图特征表示。该改进的优点在于，它不需要像传统的图卷积网络算法一样进行多次卷积操作，因此计算效率更高，能够处理大规模的图结构数据。另外，自注意力机制还可以对不同节点之间的依赖关系进行建模，提高模型的性能。步骤S140、采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型。其中，多任务预测模型用于预测碳排放量的任务和与预测碳排放量相关的环境指标的任务。在多任务学习框架下，算法同时学习多个相关任务，以提高模型的泛化能力。在碳排放量预测任务中，除了预测碳排放量外，还预测其他相关环境指标，如能源消耗、温室气体排放等。具体的，针对任一迭代，采用预设的损失函数，对多层神经网络分类器输出的各当前训练集对应的多任务预测值与标签数据的真实值进行计算，得到当前迭代的梯度；采用预设学习率调整算法，基于当前迭代的梯度，对当前迭代的学习率进行动态调整，得到新学习率和新学习率对应的模型参数，并进行下一迭代，直到达到预设的迭代终止条件，将最后得到的模型参数作为训练完成的多层神经网络分类器的模型参数。其中，预设的损失函数可以表示为：其中，是任务权重，用于平衡各任务的重要性。/＞是第i个任务的损失函数，m为任务总数。第i个任务的损失函数可以表示为：其中，为改进损失函数，/＞为任务相关性损失项，/＞是任务相关性损失项的权重；任务相关性损失项可以表示为：其中，m为任务总数，是任务/＞和任务/＞之间的相关性系数，任务/＞的预测值为，任务/＞的预测值为/＞；改进损失函数表示为：其中，是任务/＞的真实值，/＞是任务/＞的预测值，/＞是控制平滑范围的参数。预设学习率调整算法可以包括：其中：初始的学习率在区间随机取一个值。：表示第t步迭代时的学习率；：表示第t-1步迭代时的学习率；：表示在第t步迭代时的模型参数；：表示在第t-1步迭代时的模型参数；：表示在第t步迭代时，损失函数关于参数/＞的梯度；：表示在第t步迭代时，梯度的一阶矩估计值；：表示在第t-1步迭代时，梯度的一阶矩估计值；：表示在第t步迭代时，梯度的二阶矩估计值；：表示在第t-1步迭代时，梯度的二阶矩估计值；：表示一阶动量衰减系数，通常取值范围为进一步的，在利用训练好的多任务预测模型对待预测数据进行预测得到预测结果后，可以对得到的预测结果进行准确性校验。为了校验分类结果的准确性，从两个方面对结果进行评估：一是评估模型的整体准确率，二是评估模型在每个类别中的准确率。对于模型的整体准确率，可以使用Fisher准则进行评估。传统的KS检验中，计算该类别的KS统计量，它表示分类结果与真实分布之间的最大差异：其中，表示分类结果的累计分布函数。如果/＞较小，则说明分类结果与真实分布较为接近，即分类结果较为准确。在本申请中，在KS检验中引入分类边界信息，使机器学习模型在分类时不仅需要判断每个样本所属的类别，还需要确定分类边界。因此，在KS检验中引入分类边界信息可以更全面地评估分类结果的准确性。具体而言，将分类边界信息转化为一个二进制变量，它表示一个样本是否位于分类边界上。假设一个样本的真实标签为/＞，模型预测的标签为/＞，则该样本的/＞可以表示为：在KS检验中，将每个类别的样本按照其值进行排序，并计算累计分布函数：其中，表示第i个样本的二进制变量，/＞表示输入样本，/＞表示第/＞个边界样本，/＞表示该类别的样本数量，/＞是一个指示函数，当/＞时，其值为1，否则为0。通过比较两个类别的累计分布函数，可以计算它们的KS统计量，即两个类别的KS统计量：其中，和/＞分别是两个类别的累计分布函数。最后，将根据Fisher准则得到的分类器的整体准确率和每个类别的准确率综合起来，得到一个综合评估指标：其中，F为分类器的整体准确率，表示第/＞个类别的KS统计量，/＞表示类别数量。该指标综合考虑了整体准确率和每个类别的准确率，并且考虑了分类边界信息，因此更加全面和准确。其中，/＞是两个类别的KS统计量，每个类别与其余所有类别都计算一次KS统计量，取最大值作为该类别的KS统计量，由此每个类别都有一个KS统计量，/＞表示第/＞个类别的KS统计量。评估完后，如果综合评估指标不满足预设期望值时，则调整训练策略，如增加训练样本等。如果综合评估指标/＞满足预设期望值，则输出分类结果。与上述方法对应的，本申请实施例还提供一种基于机器学习的碳排放量预测模型的训练装置，如图2所示，该装置包括：获取单元210，用于获取包括各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集；所述初始企业训练样本为包括企业经营数据、企业生产数据、企业工艺数据和企业周围环境数据的历史企业数据；所述初始企业训练样本包括样本数量大于第一数量的多数类初始样本和样本数量小于第一数量的少数类初始样本；以及，针对任一初始训练集，基于所述初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集；提取单元220，用于基于预设的图卷积网络，对所述当前训练集中的各企业训练样本进行特征提取，得到所述当前训练集对应的图特征向量；所述图卷积网络的输入层包括预先引入与碳排放相关的先验知识；训练单元230，用于采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型，所述多任务预测模型用于预测碳排放量的任务和与所述预测碳排放量相关的环境指标的任务。本申请上述实施例提供的基于机器学习的碳排放量预测模型的训练装置的各功能单元的功能，可以通过上述各方法步骤来实现，因此，本申请实施例提供的装置中的各个单元的具体工作过程和有益效果，在此不复赘述。本申请实施例还提供了一种电子设备，如图3所示，包括处理器310、通信接口320、存储器330和通信总线340，其中，处理器310，通信接口320，存储器330通过通信总线340完成相互间的通信。存储器330，用于存放计算机程序；处理器310，用于执行存储器330上所存放的程序时，实现如下步骤：获取包括各企业与碳排放量相关的初始企业训练样本和相应标签数据的多个初始训练集；所述初始企业训练样本为包括企业经营数据、企业生产数据、企业工艺数据和企业周围环境数据的历史企业数据；所述初始企业训练样本包括样本数量大于第一数量的多数类初始样本和样本数量小于第一数量的少数类初始样本；针对任一初始训练集，基于所述初始训练集中的各少数类初始样本，以及各少数类初始样本分别与各多数类初始样本间的欧氏距离，获取当前训练集；以及，基于预设的图卷积网络，对所述当前训练集中的各企业训练样本进行特征提取，得到所述当前训练集对应的图特征向量；所述图卷积网络的输入层包括预先引入与碳排放相关的先验知识；采用预设的损失函数，将不同当前训练集对应的图特征向量输入待训练的多层神经网络分类器进行训练，得到训练完成的多任务预测模型，所述多任务预测模型用于预测碳排放量的任务和与所述预测碳排放量相关的环境指标的任务。上述提到的通信总线可以是外设部件互连标准总线或扩展工业标准结构总线等。该通信总线可以分为地址总线、数据总线、控制总线等。为便于表示，图中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。通信接口用于上述电子设备与其他设备之间的通信。存储器可以包括随机存取存储器，也可以包括非易失性存储器，例如至少一个磁盘存储器。可选的，存储器还可以是至少一个位于远离前述处理器的存储装置。上述的处理器可以是通用处理器，包括中央处理器、网络处理器等；还可以是数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。由于上述实施例中电子设备的各器件解决问题的实施方式以及有益效果可以参见图1所示的实施例中的各步骤来实现，因此，本申请实施例提供的电子设备的具体工作过程和有益效果，在此不复赘述。在本申请提供的又一实施例中，还提供了一种计算机可读存储介质，该计算机可读存储介质中存储有指令，当其在计算机上运行时，使得计算机执行上述实施例中任一所述的基于机器学习的碳排放量预测模型的训练方法。在本申请提供的又一实施例中，还提供了一种包含指令的计算机程序产品，当其在计算机上运行时，使得计算机执行上述实施例中任一所述的基于机器学习的碳排放量预测模型的训练方法。本领域内的技术人员应明白，本申请实施例中的实施例可提供为方法、系统、或计算机程序产品。因此，本申请实施例中可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请实施例中可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请实施例中是参照根据本申请实施例中实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。尽管已描述了本申请实施例中的优选实施例，但本领域内的技术人员一旦得知了基本创造性概念，则可对这些实施例作出另外的变更和修改。所以，所附权利要求意欲解释为包括优选实施例以及落入本申请实施例中范围的所有变更和修改。显然，本领域的技术人员可以对本申请实施例中实施例进行各种改动和变型而不脱离本申请实施例中实施例的精神和范围。这样，倘若本申请实施例中实施例的这些修改和变型属于本申请实施例中权利要求及其等同技术的范围之内，则本申请实施例中也意图包含这些改动和变型在内。
