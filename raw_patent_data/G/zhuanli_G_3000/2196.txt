标题title
基于对比学习的汉-老、泰平行句对抽取方法及装置
摘要abst
本发明涉及基于对比学习的汉‑老、泰平行句对抽取方法及装置，属自然语言处理领域。汉‑泰和汉‑老平行句对数据稀缺，从可比语料中抽取平行句对是提升低资源神经机器翻译质量的有效手段。针对现有的平行句对抽取方法应用到汉‑泰、汉‑老上时，泰语和老挝语训练数据稀缺导致模型对泰语和老挝语的表征能力弱、抽取效果不好的问题，本发明方法包括文本数据预处理、训练基于对比学习的汉语‑老挝语、泰语平行句对抽取模型、进行汉语‑老挝语、泰语平行句对抽取三部分。根据这三个功能模块化制成基于对比学习的平行句对抽取装置，从汉语‑泰语及汉语‑老挝语可比语料中抽取平行句对，本发明有效提升了汉‑泰和汉‑老平行句对抽取效果。
权利要求书clms
1.基于对比学习的汉-老、泰平行句对抽取方法，其特征在于：所述方法的具体步骤如下：Step1、进行文本数据预处理：首先从OPUS和亚洲语言树库上获取了汉语-泰语和汉语-老挝语平行语料，并使用爬虫技术从双语网站上获取汉语-泰语，汉语-老挝语可比语料，以此为基准进行数据集构建，构建方法为融合句法特点的汉语-老挝语、汉语-泰语训练数据集构建方法及基于泰语、老挝语发音相似性引导的泰语-老挝语双语词典构建方法；Step2、训练基于对比学习的汉语-老挝语、泰语平行句对抽取模型：首先，通过XLM-R预训练模型对文本进行编码，获得更丰富的语义表征，并引入多语言联合训练的方式缓解汉语-老挝语、泰语抽取模型训练数据稀缺问题，其次，引入对比学习方法训练模型，增强模型对泰语和老挝语的表征能力；Step3、进行汉语-老挝语、泰语平行句对抽取：将训练好的汉语-老挝语、泰语平行句对抽取模型部署为平行句对抽取系统，从汉语-老挝语和汉语-泰语可比语料中抽取平行句对。2.根据权利要求1所述的基于对比学习的汉-老、泰平行句对抽取方法，其特征在于：所述Step1的具体步骤为：Step1.1、首先从OPUS和亚洲语言树库上获取了汉语-泰语和汉语-老挝语平行语料，构建汉语、老挝语、泰语语法解析工具，并使用爬虫技术从泰语-汉语和老挝语-汉语双语网站获取汉语-泰语，汉语-老挝语可比语料；融合句法特点的汉语-老挝语、汉语-泰语训练数据集构建方法包括：通过正则匹配、网页标签清除，长度筛查方式对可比语料进行清洗，然后使用构建的语法解析工具进行句法分析，选取句法结构相似的汉语-泰语，汉语-老挝语语料为伪平行语料，结合人工筛查，从中构建了汉语-老挝语、泰语平行句对抽取模型训练数据集，并划分训练集、验证集和测试集；Step1.2、构建泰语-老挝语双语词典，构建方法为基于泰语、老挝语发音相似性引导的泰语-老挝语双语词典构建方法，包括：利用泰语和老挝语的互译词具有发音相似性的特点，使用泰语、老挝语转音标工具构建泰语词、老挝语词-音标映射，通过词语发音相似度匹配，即音标的编辑距离匹配结合人工标注的方式构建泰语-老挝语双语词典。3.根据权利要求1所述的基于对比学习的汉-老、泰平行句对抽取方法，其特征在于：所述Step2的具体步骤为：Step2.1、在孪生网络模型的基础上引入XLM-R预训练语言模型对文本进行编码，提高模型的跨语言编码表征能力；Step2.2、在基于XLM-R的孪生网络模型基础上引入对比学习方法训练模型，对比学习的关键在于正负样例的构建，对于给定的汉语-泰语或老挝语的训练句对样本，采用了两种方式从现有训练数据中构建样例，第一种是利用各个句子和同批次的其他句子配对构建负样本/＞，第二种是利用泰语和老挝语的句法相似性根据多语言同义词替换的方式构建一部分伪数据作为正样本/＞，并通过第一种方法对该部分数据同样构造一部分负样本/＞；其中，表示第i个中文句子，/＞表示第i个泰语或老挝语句子，/＞表示配对后的第i个泰语或老挝语句子，/＞表示第i个经过词替换处理的新的泰语或老挝语句子，/＞表示配对后第i个经过词替换处理的新的泰语或老挝语句子。4.根据权利要求3所述的基于对比学习的汉-老、泰平行句对抽取方法，其特征在于：所述Step2.1的具体步骤为：Step2.1.1、在孪生网络模型的基础上引入XLM-R预训练模型对文本进行编码，每一段文本序列分别利用一个768维的向量进行表示；对于给定的中文文本序列，其中n为中文文本序列长度，将其输入XLM-R预训练模型进行编码，得到一个稠密的隐向量表示u，计算如下：/＞；其中，/＞表示XLM-R模型编码层；Step2.1.2、对于给定的泰语或老挝语文本序列，其中b为泰语或老挝语文本序列长度，其处理过程与中文文本序列一致，利用XLM-R预训练模型对其进行编码，计算如下：/＞；Step2.1.3、使用了多层感知机，将u、v以及二者的差u-v和按位相乘进行拼接，并将拼接结果输入一个线性变换层，最后利用tanh激活函数提高模型表征能力，以期更好地捕获文本隐向量表示中的匹配关系，文本隐向量计算过程如下：；Step2.1.4、将匹配关系表示输入一个线性变换层，对齐进行特征压缩，最后通过一个Sigmoid层对文本匹配关系进行打分，计算过程如下：；Step2.1.5、使用双语交叉熵损失对基础的孪生网络模型进行优化训练，其损失如下：；其中，a为文本隐向量h对应的输入文本标签，u为中文编码后的隐向量，v为老挝语或泰语编码后的隐向量，h为文本隐向量，s为中文与泰语或老挝语的相似度得分，、/＞为可训练参数矩阵。5.根据权利要求3所述的基于对比学习的汉-老、泰平行句对抽取方法，其特征在于：所述Step2.2的具体步骤为：Step2.2.1、利用各个句子同批次的其他句子构造负样本，核心思想是将中文句子和同批次的其他任意泰语和老挝语句子配对作为负样本，并且在训练过程中使得该句对的语义差距大；具体的，随机从所有的训练数据中随机采样n个句对作为一个批次的训练数据，表示为，对于其中的任意一个训练句对样本/＞的中文句子/＞，将同批次的其他N-1个泰语或老挝语句子和/＞进行配对，得到句子对/＞作为实验的负样本；利用/＞表示负样本句子对/＞的语义相似度，上述方式构造的负样本训练的对比损失计算如下：；Step2.2.2、使用多语言同义词替换的方法构造一部分的新的正样本训练数据；首先，步骤Step1获取的泰语-老挝语的双语词典，作为后续多语言同义词替换的数据基础；对于任意一个训练句对样本中的泰语或老挝语句子/＞，首先对其进行分词，然后对每个词在泰语-老挝语的双语词典中进行检索，如果能找到对应的同义词，就在原句子中进行替换，得到新的泰语或老挝语句子/＞，并和原句对中的中文句子/＞构成一个新的正样本训练数据/＞，然后通过第一种方法对该部分数据同时构造一部分负样本/＞，同时，在多语言同义词替换构造的伪数据中也使用了同批次数据构造更多的负样本数据，上述方式构造的正样本数据训练时的损失计算如下：；其中和/＞的计算方式可参考/＞和/＞的计算方式，其区别只在于训练数据不同，需要将/＞更换为/＞；/＞表示在原始数据下计算的对比损失，/＞为在原始数据下使用双语交叉熵损失对基础的孪生网络模型进行优化训练的损失，/＞表示在词替换后数据下计算的对比损失，/＞为在词替换后数据下使用双语交叉熵损失对基础的孪生网络模型进行优化训练的损失；Step2.2.3、模型训练时在交叉熵损失的基础上引入了对比损失，因此，基于对比学习的汉语-老挝语、泰语平行句对抽取模型训练时的总损失函数计算如下：。6.根据权利要求1所述的基于对比学习的汉-老、泰平行句对抽取方法，其特征在于：所述Step3的具体步骤为：Step3.1、输入数据处理：将输入的中文文本以及泰语或老挝语文本分别根据对应的词表进行分子词操作，并分别将文本对应的子词序列转化为id，以便对其进行向量表示；Step3.2、搭建平行句对抽取服务：搭建平行句对抽取服务端，将训练出的“.bin”格式模型部署到服务器端上；搭建Web端汉语-老挝语、泰语平行句对抽取系统，实现通过Web多用户并发请求的功能；Step3.3、平行句对抽取业务实现：将待进行平行句对判定的汉语-老挝语、泰语双语文本输入Web端并通过API传输到服务端，调用平行句对抽取模型；具体地，将汉语数据输入汉语编码器中得到汉语句子编码表征，将老挝语或泰语数据输入老挝语、泰语共享编码器得到老挝语、泰语句子编码表征，然后对两个句子编码表征进行语义相似度计算，将相似度高于判定阈值的汉语-泰语、汉语-老挝语句对判定为平行句对。7.基于对比学习的汉-老、泰平行句对抽取装置，其特征在于，包括用于执行如权利要求1-6任一权利要求所述的方法的模块。
说明书desc
技术领域本发明涉及基于对比学习的汉-老、泰平行句对抽取方法及装置，属于自然语言处理技术领域。背景技术神经机器翻译模型的训练依赖于大规模的平行语料，语料的数量及质量直接决定了神经机器翻译模型的翻译质量。泰语和老挝语都属于低资源语言，开源的汉泰及汉老平行语料稀缺，其语料库的构建是当前急需解决的问题。随着中国与东南亚国家交流的日益密切，互联网上出现了一些内容相同或相近的双语网站，从该类网站上爬取大量可比句对，并训练平行句对抽取模型从中抽取平行语料，是缓解汉泰和汉老语料稀缺的有效手段。平行句对抽取主要是通过计算跨语言句子相似度实现的。早期句子特征的抽取依赖于特征工程，该类方法受限于先验知识的构建，且可扩展性较差。随着深度学习的发展，基于神经网络的平行句对抽取方法逐渐出现。现有双语平行句对抽取方法主要利用孪生网络分别对双语句子进行特征提取并计算其语义相似度，该类方法需要部分基础数据，通过联合训练的方式利用资源较丰富的汉泰语料提升汉老平行句对抽取模型的效果是缓解汉老资源稀缺问题的有效方式，但直接联合训练汉泰和汉老语料会导致泰语和老挝语语义空间不一致。泰语和老挝语书写体系完全不同，语义空间差异较大，但二者句法相似度较高，都遵循主语+谓语+宾语的语序规则，且形容词都是后置的，现有方法未充分利用其句法相似性拉近语义空间距离。同时，现有方法在进行相似度计算时易出现相似不平行句对的误判，本发明认为这是由于模型对句子的表征能力弱，导致对句子的语义平行关系判定困难。针对以上问题，本发明提出了基于对比学习的汉-老、泰平行句对抽取方法。发明内容本发明提供了基于对比学习的汉-老、泰平行句对抽取方法及装置，以缓解现有方法在进行相似度计算时易出现相似不平行句对的误判的问题。本发明的技术方案是：第一方面，本发明提供基于对比学习的汉-老、泰平行句对抽取方法，所述方法的具体步骤如下：Step1、进行文本数据预处理：首先从OPUS和亚洲语言树库上获取了汉语-泰语和汉语-老挝语平行语料，并使用爬虫技术从双语网站上获取汉语-泰语，汉语-老挝语可比语料，以此为基准进行数据集构建，构建方法为融合句法特点的汉语-老挝语、汉语-泰语训练数据集构建方法及基于泰语、老挝语发音相似性引导的泰语-老挝语双语词典构建方法；Step2、训练基于对比学习的汉语-老挝语、泰语平行句对抽取模型：首先，通过XLM-R预训练模型对文本进行编码，获得更丰富的语义表征，并引入多语言联合训练的方式缓解汉语-老挝语、泰语抽取模型训练数据稀缺问题，其次，引入对比学习方法训练模型，增强模型对泰语和老挝语的表征能力；Step3、进行汉语-老挝语、泰语平行句对抽取：将训练好的汉语-老挝语、泰语平行句对抽取模型部署为平行句对抽取系统，从汉语-老挝语和汉语-泰语可比语料中抽取平行句对。进一步地，所述Step1的具体步骤为：Step1.1、首先从OPUS和亚洲语言树库上获取了汉语-泰语和汉语-老挝语平行语料，构建汉语、老挝语、泰语语法解析工具，并使用爬虫技术从泰语-汉语和老挝语-汉语双语网站获取汉语-泰语，汉语-老挝语可比语料；融合句法特点的汉语-老挝语、汉语-泰语训练数据集构建方法包括：通过正则匹配、网页标签清除，长度筛查方式对可比语料进行清洗，然后使用构建的语法解析工具进行句法分析，选取句法结构相似的汉语-泰语，汉语-老挝语语料为伪平行语料，结合人工筛查，从中构建了汉语-老挝语、泰语平行句对抽取模型训练数据集，并划分训练集、验证集和测试集；Step1.2、构建泰语-老挝语双语词典，构建方法为基于泰语、老挝语发音相似性引导的泰语-老挝语双语词典构建方法，包括：利用泰语和老挝语的互译词具有发音相似性的特点，使用泰语、老挝语转音标工具构建泰语词、老挝语词-音标映射，通过词语发音相似度匹配，即音标的编辑距离匹配结合人工标注的方式构建泰语-老挝语双语词典。进一步地，所述Step2的具体步骤为：Step2.1、在孪生网络模型的基础上引入XLM-R预训练语言模型对文本进行编码，提高模型的跨语言编码表征能力；Step2.2、为了进一步拉近相似文本在语义空间中的距离，同时拉开不相似文本的语义差距，在基于XLM-R的孪生网络模型基础上引入对比学习方法训练模型，对比学习的关键在于正负样例的构建，对于给定的汉语-泰语或老挝语的训练句对样本，采用了两种方式从现有训练数据中构建样例，第一种是利用各个句子和同批次的其他句子配对构建负样本，第二种是利用泰语和老挝语的句法相似性根据多语言同义词替换的方式构建一部分伪数据作为正样本，并通过第一种方法对该部分数据同样构造一部分负样本；其中，表示第i个中文句子，表示第i个泰语或老挝语句子，表示配对后的第i个泰语或老挝语句子，表示第i个经过词替换处理的新的泰语或老挝语句子，表示配对后第i个经过词替换处理的新的泰语或老挝语句子。进一步地，所述Step2.1的具体步骤为：Step2.1.1、在孪生网络模型的基础上引入XLM-R预训练模型对文本进行编码，每一段文本序列分别利用一个768维的向量进行表示；XLM-R的全称是XLM-RoBERTa，该模型的训练方法于XLM预训练模型基本一致，并且思想借鉴了RoBERTa预训练模型，将两种预训练模型的优势进行结合，利用100个语种上的2.5TB语料进行训练，在多项跨语言理解基准任务上取得了最优；对于给定的中文文本序列，其中n为中文文本序列长度，将其输入XLM-R预训练模型进行编码，得到一个稠密的隐向量表示u，计算如下：；其中，表示XLM-R模型编码层；Step2.1.2、对于给定的泰语或老挝语文本序列，其中b为泰语或老挝语文本序列长度，其处理过程与中文文本序列一致，利用XLM-R预训练模型对其进行编码，计算如下：；Step2.1.3、为了对两段文本的语义表示进行特征匹配，计算其语义相似度，使用了多层感知机；将u、v以及二者的差u-v和按位相乘进行拼接，并将拼接结果输入一个线性变换层，最后利用tanh激活函数提高模型表征能力，以期更好地捕获文本隐向量表示中的匹配关系，文本隐向量计算过程如下：；Step2.1.4、为了对包含文本匹配关系的文本隐向量进行分类，将其匹配关系表示输入一个线性变换层，对齐进行特征压缩，最后通过一个Sigmoid层对文本匹配关系进行打分，计算过程如下：；Step2.1.5、使用双语交叉熵损失对基础的孪生网络模型进行优化训练，其损失如下：；其中，a为文本隐向量h对应的输入文本标签，u为中文编码后的隐向量，v为老挝语或泰语编码后的隐向量，h为文本隐向量，s为中文与泰语或老挝语的相似度得分，、为可训练参数矩阵。进一步地，所述Step2.2的具体步骤为：Step2.2.1、利用各个句子同批次的其他句子构造负样本，核心思想是将中文句子和同批次的其他任意泰语和老挝语句子配对作为负样本，并且在训练过程中使得该句对的语义差距尽可能大；具体的，随机从所有的训练数据中随机采样n个句对作为一个批次的训练数据，表示为，对于其中的任意一个训练句对样本的中文句子，将同批次的其他N-1个泰语或老挝语句子和进行配对，得到句子对作为实验的负样本；利用表示负样本句子对的语义相似度，上述方式构造的负样本训练的对比损失计算如下：；Step2.2.2、使用多语言同义词替换的方法构造一部分的新的正样本训练数据；首先，步骤Step1获取的泰语-老挝语的双语词典，作为后续多语言同义词替换的数据基础；对于任意一个训练句对样本中的泰语或老挝语句子，首先对其进行分词，然后对每个词在泰语-老挝语的双语词典中进行检索，如果能找到对应的同义词，就在原句子中进行替换，得到新的泰语或老挝语句子，并和原句对中的中文句子构成一个新的正样本训练数据，然后通过第一种方法对该部分数据同时构造一部分负样本，同时，在多语言同义词替换构造的伪数据中也使用了同批次数据构造更多的负样本数据，上述方式构造的正样本数据训练时的损失计算如下：；其中和的计算方式可参考和的计算方式，其区别只在于训练数据不同，需要将更换为；表示在原始数据下计算的对比损失，为在原始数据下使用双语交叉熵损失对基础的孪生网络模型进行优化训练的损失，表示在词替换后数据下计算的对比损失，为在词替换后数据下使用双语交叉熵损失对基础的孪生网络模型进行优化训练的损失；Step2.2.3、因为将孪生网络和对比学习方法进行了融合，并针对对比学习方法提出了同批次数据构造样例和多语言同义词替换方法构造样例这两种样例数据构造方法。该模型训练时在交叉熵损失的基础上引入了对比损失，因此，基于对比学习的汉语-老挝语、泰语平行句对抽取模型训练时的总损失函数计算如下：。进一步地，所述Step3的具体步骤为：Step3.1、输入数据处理：将输入的中文文本以及泰语或老挝语文本分别根据对应的词表进行分子词操作，并分别将文本对应的子词序列转化为id，以便对其进行向量表示；Step3.2、搭建平行句对抽取服务：搭建平行句对抽取服务端，将训练出的“.bin”格式模型部署到服务器端上；搭建Web端汉语-老挝语、泰语平行句对抽取系统，实现通过Web多用户并发请求的功能；Step3.3、平行句对抽取业务实现：将待进行平行句对判定的汉语-老挝语、泰语双语文本输入Web端并通过API传输到服务端，调用平行句对抽取模型；具体地，将汉语数据输入汉语编码器中得到汉语句子编码表征，将老挝语或泰语数据输入老挝语、泰语共享编码器得到老挝语、泰语句子编码表征，然后对两个句子编码表征进行语义相似度计算，将相似度高于判定阈值的汉语-泰语、汉语-老挝语句对判定为平行句对。第二方面，本发明还提供基于对比学习的汉-老、泰平行句对抽取装置，包括用于执行上述第一方面所述的方法的模块。本发明的有益效果是：1、本发明为了获得更好的句子级表征，基于孪生网络思想，利用XLM-R预训练模型对句子进行表征，并在训练过程中微调预训练模型；2、本发明在平行句对抽取模型中引入对比学习方法增强模型对相似不平行句对的判别能力，一方面利用同批次样本构建负样例，另一方面利用泰语和老挝语的句法相似性通过词典替换的方式构建正负样例，拉近平行句对在语义空间中距离的同时使不平行句对在语义空间中的距离更远；3、从汉语-泰语及汉语-老挝语可比语料中抽取平行句对，本发明有效提升了汉-泰和汉-老平行句对抽取效果。附图说明图1为本发明中基于XLM-R的孪生网络架构图；图2为本发明中基于对比学习的网络架构图；图3为本发明中基于对比学习的汉-老、泰平行句对抽取方法整体流程图；具体实施方式下面结合附图，对本发明的实施例进行描述。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明的是，本发明实施例的执行主体可以为各种类型的终端，终端例如可以是计算机、智能手机、平板电脑、可穿戴设备、个人数字助理、移动互联网设备等可进行文本处理的终端，本发明对此不作任何限制。如图3所示，是本发明中基于对比学习的汉-老、泰平行句对抽取方法整体流程图，第一方面，本发明提供的基于对比学习的汉-老、泰平行句对抽取方法的具体步骤如下：Step1、进行文本数据预处理：泰语和老挝语都属于低资源语言，网络上开源的汉语-泰语和汉语-老挝语平行数据集稀缺；本发明首先从OPUS和亚洲语言树库上获取了汉语-泰语和汉语-老挝语平行语料，并使用爬虫技术从双语网站上获取汉语-泰语，汉语-老挝语可比语料，以此为基准进行数据集构建，构建方法为融合句法特点的汉语-老挝语、汉语-泰语训练数据集构建方法及基于泰语、老挝语发音相似性引导的泰语-老挝语双语词典构建方法；Step2、训练基于对比学习的汉语-老挝语、泰语平行句对抽取模型：针对现有的平行句对抽取方法应用到汉语-泰语、汉语-老挝语上时，泰语和老挝语训练数据稀缺导致模型对泰语和老挝语的表征能力弱，使得抽取效果不好的问题，训练基于对比学习的汉语-老挝语、泰语平行句对抽取模型。首先，通过XLM-R预训练模型对文本进行编码，获得更丰富的语义表征，并引入多语言联合训练的方式缓解汉语-老挝语、泰语抽取模型训练数据稀缺问题，其次，引入对比学习方法训练模型，增强模型对泰语和老挝语的表征能力；Step3、进行汉语-老挝语、泰语平行句对抽取：将训练好的汉语-老挝语、泰语平行句对抽取模型部署为平行句对抽取系统，从汉语-老挝语和汉语-泰语可比语料中抽取平行句对。进一步地，所述Step1的具体步骤为：Step1.1、首先从OPUS和亚洲语言树库上获取了汉语-泰语和汉语-老挝语平行语料，构建汉语、老挝语、泰语语法解析工具，并使用爬虫技术从泰语-汉语和老挝语-汉语双语网站获取汉语-泰语，汉语-老挝语可比语料；融合句法特点的汉语-老挝语、汉语-泰语训练数据集构建方法包括：通过正则匹配、网页标签清除，长度筛查方式对可比语料进行清洗，然后使用构建的语法解析工具进行句法分析，选取句法结构相似的汉语-泰语，汉语-老挝语语料为伪平行语料，结合人工筛查，从中构建了汉语-老挝语、泰语平行句对抽取模型训练数据集，并划分训练集、验证集和测试集；构建的模型训练数据集包含20万汉-泰平行数据以及10万汉-老平行数据；本发明选取汉-泰和汉-老数据各2000条作为验证集，各取2000条作为测试集，剩余数据作为训练集；Step1.2、构建泰语-老挝语双语词典，构建方法为基于泰语、老挝语发音相似性引导的泰语-老挝语双语词典构建方法，包括：利用泰语和老挝语的互译词具有发音相似性的特点，使用泰语、老挝语转音标工具构建泰语词、老挝语词-音标映射，通过词语发音相似度匹配，即音标的编辑距离匹配结合人工标注的方式构建泰语-老挝语双语词典。进一步地，所述Step2的具体步骤为：Step2.1、在孪生网络模型的基础上引入XLM-R预训练语言模型对文本进行编码，提高模型的跨语言编码表征能力；Step2.2、为了进一步拉近相似文本在语义空间中的距离，同时拉开不相似文本的语义差距，在基于XLM-R的孪生网络模型基础上引入对比学习方法训练模型，对比学习的关键在于正负样例的构建，对于给定的汉语-泰语或老挝语的训练句对样本，采用了两种方式从现有训练数据中构建样例，第一种是利用各个句子和同批次的其他句子配对构建负样本，第二种是利用泰语和老挝语的句法相似性根据多语言同义词替换的方式构建一部分伪数据作为正样本，并通过第一种方法对该部分数据同样构造一部分负样本；其中，表示第i个中文句子，表示第i个泰语或老挝语句子，表示配对后的第i个泰语或老挝语句子，表示第i个经过词替换处理的新的泰语或老挝语句子，表示配对后第i个经过词替换处理的新的泰语或老挝语句子。进一步地，所述Step2.1的具体步骤为：Step2.1.1、为了更有效地对文本进行语义表示，在孪生网络模型的基础上引入XLM-R预训练模型对文本进行编码，每一段文本序列分别利用一个768维的向量进行表示；XLM-R的全称是XLM-RoBERTa，该模型的训练方法于XLM预训练模型基本一致，并且思想借鉴了RoBERTa预训练模型，将两种预训练模型的优势进行结合，利用100个语种上的2.5TB语料进行训练，在多项跨语言理解基准任务上取得了最优；对于给定的中文文本序列，其中n为中文文本序列长度，将其输入XLM-R预训练模型进行编码，得到一个稠密的隐向量表示u，计算如下：；其中，表示XLM-R模型编码层；Step2.1.2、对于给定的泰语或老挝语文本序列，其中b为泰语或老挝语文本序列长度，其处理过程与中文文本序列一致，利用XLM-R预训练模型对其进行编码，计算如下：；Step2.1.3、为了对两段文本的语义表示进行特征匹配，计算其语义相似度，使用了多层感知机；将u、v以及二者的差u-v和按位相乘进行拼接，并将拼接结果输入一个线性变换层，最后利用tanh激活函数提高模型表征能力，以期更好地捕获文本隐向量表示中的匹配关系，文本隐向量计算过程如下：；Step2.1.4、为了对包含文本匹配关系的文本隐向量进行分类，将其匹配关系表示输入一个线性变换层，对齐进行特征压缩，最后通过一个Sigmoid层对文本匹配关系进行打分，计算过程如下：；Step2.1.5、使用双语交叉熵损失对基础的孪生网络模型进行优化训练，其损失如下：；其中，a为文本隐向量h对应的输入文本标签，u为中文编码后的隐向量，v为老挝语或泰语编码后的隐向量，h为文本隐向量，s为中文与泰语或老挝语的相似度得分，、为可训练参数矩阵。进一步地，所述Step2.2的具体步骤为：Step2.2.1、利用各个句子同批次的其他句子构造负样本，核心思想是将中文句子和同批次的其他任意泰语和老挝语句子配对作为负样本，并且在训练过程中使得该句对的语义差距尽可能大；具体的，随机从所有的训练数据中随机采样n个句对作为一个批次的训练数据，表示为，对于其中的任意一个训练句对样本的中文句子，将同批次的其他N-1个泰语或老挝语句子和进行配对，得到句子对作为实验的负样本；利用表示负样本句子对的语义相似度，上述方式构造的负样本训练的对比损失计算如下：；Step2.2.2、上述利用同批次数据构造样例的方法只能构造负样例，不能从现有训练数据中构造出一些新的正样例。为此，考虑到泰语和老挝语在句法层面上有较高的相似性，本发明使用多语言词替换的方法构造一部分的新的正样例训练数据。使用多语言同义词替换的方法构造一部分的新的正样本训练数据；首先，步骤Step1获取的31960个泰语-老挝语的双语词典，作为后续多语言同义词替换的数据基础；对于任意一个训练句对样本中的泰语或老挝语句子，首先对其进行分词，然后对每个词在泰语-老挝语的双语词典中进行检索，如果能找到对应的同义词，就在原句子中进行替换，得到新的泰语或老挝语句子，并和原句对中的中文句子构成一个新的正样本训练数据，然后通过第一种方法对该部分数据同时构造一部分负样本，由于泰语和老挝语在句法上有较高的相似性，多语言词替换的方式并不会对泰语和老挝语的词汇在句子中的位置信息造成干扰，从而保证模型在对新构造的伪数据进行编码时获得正确的语义信息。同时，为了构造更多的样例数据，提升模型训练效果，本发明在多语言同义词替换构造的伪数据中也使用了同批次数据构造更多的负样本数据，上述方式构造的正样本数据训练时的损失计算如下：；其中和的计算方式可参考和的计算方式，其区别只在于训练数据不同，需要将更换为；表示在原始数据下计算的对比损失，为在原始数据下使用双语交叉熵损失对基础的孪生网络模型进行优化训练的损失，表示在词替换后数据下计算的对比损失，为在词替换后数据下使用双语交叉熵损失对基础的孪生网络模型进行优化训练的损失；Step2.2.3、因为将孪生网络和对比学习方法进行了融合，并针对对比学习方法提出了同批次数据构造样例和多语言同义词替换方法构造样例这两种样例数据构造方法。该模型训练时在交叉熵损失的基础上引入了对比损失，因此，基于对比学习的汉语-老挝语、泰语平行句对抽取模型训练时的总损失函数计算如下：。进一步地，所述Step3的具体步骤为：Step3.1、输入数据处理：将输入的中文文本以及泰语或老挝语文本分别根据对应的词表进行分子词操作，并分别将文本对应的子词序列转化为id，以便对其进行向量表示；Step3.2、搭建平行句对抽取服务：搭建平行句对抽取服务端，将训练出的“.bin”格式模型部署到服务器端上；搭建Web端汉语-老挝语、泰语平行句对抽取系统，实现通过Web多用户并发请求的功能；Step3.3、平行句对抽取业务实现：将待进行平行句对判定的汉语-老挝语、泰语双语文本输入Web端并通过API传输到服务端，调用平行句对抽取模型；具体地，将汉语数据输入汉语编码器中得到汉语句子编码表征，将老挝语或泰语数据输入老挝语、泰语共享编码器得到老挝语、泰语句子编码表征，然后对两个句子编码表征进行语义相似度计算，将相似度高于判定阈值的汉语-泰语、汉语-老挝语句对判定为平行句对。下面为本发明装置实施例，本发明装置实施例用于执行本发明方法第一实施例实现的方法，为了便于说明，仅示出了本发明实施例相关的部分，具体未揭示的部分，请参照本发明第一实施例。本发明实施例提供基于对比学习的汉-老、泰平行句对抽取装置，该装置包括：预处理模块：用于进行文本数据预处理，具体用于首先从OPUS和亚洲语言树库上获取了汉语-泰语和汉语-老挝语平行语料，并使用爬虫技术从双语网站上获取汉语-泰语，汉语-老挝语可比语料，以此为基准进行数据集构建，构建方法为融合句法特点的汉语-老挝语、汉语-泰语训练数据集构建方法及基于泰语、老挝语发音相似性引导的泰语-老挝语双语词典构建方法；训练模块：用于训练基于对比学习的汉语-老挝语、泰语平行句对抽取模型，具体的，首先，用于通过XLM-R预训练模型对文本进行编码，获得更丰富的语义表征，并引入多语言联合训练的方式缓解汉语-老挝语、泰语抽取模型训练数据稀缺问题，其次，引入对比学习方法训练模型，增强模型对泰语和老挝语的表征能力；抽取模块：用于进行汉语-老挝语、泰语平行句对抽取，具体的用于将训练好的汉语-老挝语、泰语平行句对抽取模型部署为平行句对抽取系统，从汉语-老挝语和汉语-泰语可比语料中抽取平行句对。为了验证本发明提出的基于对比学习的汉-老、泰平行句对抽取方法的效果，设计了对比实验和消融实验。对比实验的实验结果如表1所示，相比传统的机器学习方法SVM和LR，本发明提出的基于对比学习的平行句对抽取方法在汉语泰语平行数据和汉语老语平行数据两个测试集的抽取效果上都取得了飞跃式的提升，这说明基于的对比学习的方法可以更好地从现有训练数据中学习语言的语义特征，并扩展到其他的数据集；而传统的基于机器学习的方法依赖于训练数据中的特征，泛化能力较差，泰语和老挝语都属于低资源语言，无法为模型训练提供充足的数据，从而导致模型性能不佳。同时，本发明发现汉泰数据集上的实验效果远超汉老数据集上的实验效果，这个主要是受到数据规模的影响，汉泰的数据规模相比于汉老的数据规模较大。相比现有的基于深度学习的平行句对抽取方法，本发明提出的基于对比学习的平行句对抽取方法在汉语泰语平行数据和汉语老语平行数据两个测试集的抽取效果上都达到了最优值。相比Bi-LSTM模型，本发明方法引入了预训练模型，并对其微调，实验结果表明了该方法的有效性。相比Bert预训练模型，XLM-R预训练模型拥有更强大的语义表征能力，能使模型在编码时获得更准确的跨语言表征。将Bi-LSTM模型和Bert预训练模型进行融合可以进一步提升模型性能，但在相同训练数据下模型的抽取效果相比本发明提出方法仍有差距。表1 与其他模型对比实验的实验结果通过在本发明提出方法的基础上使用不同的数据集进行训练，本发明观察到汉泰和汉老数据联合训练的模型效果远超汉泰和汉老单独训练的模型效果，在汉泰和汉老测试集上的F1值分别达到了91.80%和96.27%，这表明汉泰和汉老模型中的参数有较高的相似性，可通过模型参数的共享实现数据增强及跨语言知识迁移，提升模型性能。为了探究在平行句对抽取模型中引入对比学习方法及设置的正负样例构造方法的有效性，本发明设置了消融实验，分别在提出方法的基础上消除两种样例构造方法并进行实验。实验结果如表2、表3所示；表2是各模型在汉泰测试集上的实验结果，表3是各模型在汉老测试集上的实验结果，采用精确率、召回率和F1-Score值衡量实验结果。表2 测试集为泰语时消融实验结果表3 测试集为老挝语时消融实验结果根据实验结果可以看出，对比学习方法可以有效提升平行句对抽取模型效果，且利用同批次构造样本和利用多语言词替换方式构造样本都能有效提升模型效果，当一起使用两种样本构造方法时，模型性能达到最优。同时，本发明进一步发现相比于利用同批次构造样本的方法，利用多语言词替换方式构造样本的方法对模型性能提升贡献更大，这主要是由于泰语和老挝语在句法上有较高的相似性，导致构造的伪数据质量较高，且有效地拉近了泰语和老挝语语义空间距离。上面结合附图对本发明的具体实施方式作了详细说明，但是本发明并不限于上述实施方式，在本领域普通技术人员所具备的知识范围内，还可以在不脱离本发明宗旨的前提下作出各种变化。
