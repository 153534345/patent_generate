标题title
基于虚拟仪器的园区电力谐波分布与识别方法
摘要abst
本发明提供了一种基于虚拟仪器的园区电力谐波分布与识别方法，该方法通过将信号采集终端配置于园区配电用电系统关键节点，同步采集节点电压、节点注入电流以及支路电流信号，再由基于谐波分布与识别应用程序的虚拟仪器系统完成园区整体性谐波分布状态估计、谐波源定位、谐波成因识别以及谐波类型辩识等功能，为工业/产业园区提供一个本地化、整体性、智能化、透明化的谐波监测与识别方案，该方案硬件结构简单，自主可控、成本低、软件开发和运行便利，扩展性强，能够实时动态的监测园区配电系统谐波电压/电流相量，进而估计出整个园区的谐波分布状态，实现谐波源的定位以及责任划分，辨别谐波的成因以及谐波类型，是园区谐波监测的有效方案。
权利要求书clms
1.一种基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，包括以下步骤：步骤一：依据拓扑可观性原则和方法在待测园区用电系统的关键节点配置信号采集终端，所述信号采集终端同步采集各关键节点的电气信号，并将所采集的信号数据传输至电脑主机；步骤二：所述电脑主机与虚拟仪器系统相连，所述虚拟仪器系统包括采用LabVIEW编程的谐波分布与识别应用程序，所述谐波分布与识别应用程序包括以下功能模块：数据接收与处理模块，用于依据采集节点和时标对接收到的信号数据进行分组，并对每一组信号数据分别进行整形滤波，将处理好的信号送至谐波分析模块；谐波分析模块，用于对处理后的每一组波形信号进行傅里叶变换，得到各次谐波的幅度谱和相位谱并将其转化为同步相量值，同时进行谐波基本特征参数和统计参数的计算；谐波分布状态估计模块，以量测节点谐波电压、量测节点相连的支路谐波电流以及值为0的零注入节点谐波注入电流作为量测量，以各节点各次谐波电压作为状态量，列出量测方程，并利用最小二乘法求解所述量测方程，获取各节点的电压估计值、注入电流值、谐波的复功率，最终得到状态估计结果，所述状态估计结果包括节点谐波电压估计表、节点注入谐波电流估计表、节点注入谐波功率估计表、节点-幅值-谐波次数三维分布图谱和节点-相位-谐波次数三维分布图谱；谐波源定位模块，用于计算各节点的功率，依据计算的功率值定位谐波源的位置，并给出划分谐波责任结果；谐波识别模块，用于根据谐波基本特征参数判断谐波源的成因，以及根据时频特征判断电力系统中存在的谐波类型；显示模块，用于实时显示所述状态估计结果以及谐波源成因和谐波类型识别的相关信息，同时设置交互选项；记录存储模块，用于将以上模块中计算的结果和原始信号储存在数据库中。2.根据权利要求1所述的基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，所述信号采集终端包括信号采集单元、数据处理单元和信号发射单元；所述信号采集单元包括电压电流互感器、模数转换器和同步信号发生器，所述电压电流互感器获取采样节点的电气信号，经由所述模数转换器转换为数字信号后传输至微处理器，其中所述模数转换器的采样信号以所述同步信号发生器生成的BDS信号为基准；所述数据处理单元包括微处理器、BDS信号接收器和存储单元，所述BDS信号接收器用于接收BDS时钟信号并分别传输给所述微处理器和所述同步信号发生器，所述微处理器持续不断的接收来自所述模数转换器的数字信号并暂时存储，以BDS时钟信号为基准，以固定时长截取数字信号并打上精确的时标一同打包送至所述存储单元；所述信号发射单元包括通信接口，所述通信接口由所述微处理器生成的发射信号控制，用于将所述存储单元中的数据包发送至电脑主机。3.根据权利要求2所述的基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，所述信号发射单元与所述电脑主机之间采用光纤或者无线网络进行数据传输。4.根据权利要求1所述的基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，所述量测方程包括：量测节点谐波电压方程：，其中，/＞为节点/＞的/＞次谐波电压量测量，/＞为节点/＞的/＞次谐波电压状态量；量测节点相连的支路谐波电流方程：，其中，为节点/＞和节点/＞之间支路的/＞次谐波电流量测量，/＞为节点/＞的/＞次谐波电压状态量，/＞为节点导纳矩阵中节点/＞和节点/＞对应的导纳矩阵元素；零注入节点谐波注入电流方程：，其中，/＞为节点/＞的/＞次谐波注入电流，其值为0，/＞为电力网络节点个数。5.根据权利要求4所述的基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，将所述量测方程写为矩阵形式：，其中，/＞为量测量组成的列向量，/＞为状态量组成的列向量，/＞是关系矩阵；在矩阵形式的量测方程中引入估计误差，将矩阵形式的量测方程改写为：，其中，/＞为估计误差；利用最小二乘法求解改写后的量测方程。6.根据权利要求1所述的基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，所述谐波识别模块根据谐波基本特征参数判断谐波源的成因的过程包括以下步骤：a.若电压等级在1000V以下，频率f小于100Hz，间谐波电压含有率大于0.16且电阻符合电弧电阻的伏安特性曲线，或者电压等级在1000V以上，频率f小于100Hz，间谐波电压含有率大于0.13且电阻符合电弧电阻的伏安特性曲线，则所述谐波识别模块判断谐波源的成因为电弧型成因，否则进行下一步判断；b.若支路负载电流的谐波电流次数为其中，/＞，/＞，且不含有偶次谐波，则所述谐波识别模块判断谐波源的成因为电力电子开关型成因，否则进行下一步判断；c.若支路电流主要谐波为3次、5次和7次谐波，其余谐波含有率极小，并且谐波含量随着电压的升高而增加，则所述谐波识别模块判断谐波源的成因为铁磁饱和型成因，否则判定谐波源的成因为其它类型成因。7.根据权利要求1所述的基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，时频特征的提取方式为以复数Morlet小波为小波基进行连续小波变换，获取量测支路电流信号在时域以及频域上幅值和相位的变化。8.根据权利要求7所述的基于虚拟仪器的园区电力谐波分布与识别方法，其特征在于，在小波变换过程中，对信号进行小波变换时接上相邻的信号/＞和信号/＞，对合并信号进行小波变换，截取中间对应信号/＞的一段结果作为信号/＞小波变换的结果。/＞
说明书desc
技术领域本发明属于电气测量技术领域，特别涉及一种基于虚拟仪器的园区电力谐波分布与识别方法。背景技术电力谐波主要由用电负荷引起，工业园、产业园是电力系统配电网的延伸，是配电台区的末端，负荷众多、种类繁杂，其中不乏各类谐波源。电力谐波对园区制造系统的安全、稳定和经济运行造成重大威胁和隐患，同时也波及全网。相较于输变电系统，产业园区具有明显的独立性特点和整体性特征，需要谐波监测的区内实时、同步和整体性。现有的各类谐波测量仪器以参数测量为主要功能，不具有实时同步的整体性监测能力，难以满足园区电网整体谐波分布状态刻画和成因及类型识别的需要。WAMS是电力系统广域相量监测系统，由布设在母线节点上的系统子站采集同步相量数据，由系统主站完成数据存储和应用分析，具有实时、动态的优势，但其面向输变电网络，结构复杂、规模庞大，成本高，由电力调度中心集中统一管控，园区无权访问WAMS主站。产业园区谐波监测具有其自身具体明确需求，一方面需要实时同步掌控园区整体性谐波分布状态，也就是所有电气节点的各次谐波幅值和谐波相位，同时要明确找出谐波的负荷来源，从而精确的划分出责任，另一方面希望具有谐波成因与类型识别的功能，从而为谐波治理找到病源。为解决上述问题，需要一种面向产业园区的整体性、创造性解决方案，这一方案需要一套切实有效的方法和支撑这套方法实施的软硬件平台。基于以上需求，本发明提出了一种基于虚拟仪器的园区电力谐波分布与识别方法。发明内容实现上述目的，本发明提供一种基于虚拟仪器的园区电力谐波分布与识别方法，该方法采用“同步相量信号采集终端+虚拟仪器系统”的组建方案和运行模式，信号采集终端承担园区配电网关键节点电气量的实时信号采集，虚拟仪器系统作为测试系统的软件基础平台，利用LabVIEW进行谐波分布与识别应用程序编程，依据关键节点的电气量测量进行园区内全部节点的谐波分布状态估计和类型识别。本发明采取如下的技术方案：一种基于虚拟仪器的园区电力谐波分布与识别方法，包括以下步骤：步骤一：依据拓扑可观性原则和方法在待测园区用电系统的关键节点配置信号采集终端，所述信号采集终端同步采集各关键节点的电气信号，并将所采集的信号数据传输至电脑主机；步骤二：所述电脑主机与虚拟仪器系统相连，所述虚拟仪器系统包括采用LabVIEW编程的谐波分布与识别应用程序，所述谐波分布与识别应用程序包括以下功能模块：数据接收与处理模块，用于依据采集节点和时标对接收到的信号数据进行分组，并对每一组信号数据分别进行整形滤波，将处理好的信号送至谐波分析模块；谐波分析模块，用于对处理后的每一组波形信号进行傅里叶变换，得到各次谐波的幅度谱和相位谱并将其转化为同步相量值，同时进行谐波基本特征参数和统计参数的计算；谐波分布状态估计模块，用于以量测节点谐波电压、量测节点相连的支路谐波电流以及零注入节点谐波注入电流为0作为量测量，以各节点各次谐波电压作为状态量，列出量测方程，并利用最小二乘法求解所述量测方程，获取各节点的电压估计值、注入电流值、谐波的复功率，最终得到状态估计结果，所述状态估计结果包括节点谐波电压估计表、节点注入谐波电流估计表、节点注入谐波功率估计表、节点-幅值-谐波次数三维分布图谱和节点-相位-谐波次数三维分布图谱；谐波源定位模块，用于计算各节点的功率，依据计算的功率值定位谐波源的位置，并给出划分谐波责任结果；谐波识别模块，用于根据谐波基本特征参数判断谐波源的成因，以及根据时频特征判断电力系统中存在的谐波类型；显示模块，用于实时显示所述状态估计结果以及谐波源成因和谐波类型识别的相关信息，同时设置交互选项；记录存储模块，用于将以上模块中计算的结果和原始信号储存在数据库中。本发明具有以下有益效果：本发明提供了一种面向产业园区，基于虚拟仪器技术的电力谐波分布与识别方法，该方法通过将信号采集终端配置于园区配电用电系统关键节点，同步采集节点电压、节点注入电流以及支路电流信号，再由基于谐波分布与识别应用程序的虚拟仪器系统完成园区整体性谐波分布状态估计、谐波源定位、谐波成因识别以及谐波类型辩识等功能，为工业/产业园区提供一个本地化、整体性、智能化、透明化的谐波监测与识别方案，该方案硬件结构简单，自主可控、成本低、软件开发和运行便利，扩展性强，能够实时动态的监测园区配电系统谐波电压/电流相量，进而估计出整个园区的谐波分布状态，实现谐波源的定位以及责任划分，辨别谐波的成因以及谐波类型，是园区谐波监测的有效方案。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明中记载的一些实施例，对于本领域普通技术人员来讲，还可以根据这些附图获得其他的附图。图1为信号采集终端的结构与运行示意图；图2为虚拟仪器系统所使用的谐波分布与识别应用程序的结构与运行示意图；图3为本发明基于虚拟仪器的园区电力谐波分布与识别方法的流程逻辑图。具体实施方式为了使本领域的技术人员更好地理解本发明的技术方案，下面将结合附图及实施例对本发明作进一步的详细介绍。本发明提供一种基于虚拟仪器的园区电力谐波分布与识别方法，该方法首先依据拓扑可观性原则和方法在待测园区用电系统优化配置信号采集终端，也就是在部分关键节点配置信号采集终端，信号采集终端感知和采集园区内这些关键节点的节点电压、支路电流，BDS时钟信号控制信号采集终端对电气信号的同步采集，所采集的数据经通信接口传输至电脑主机，由于电脑主机相连的虚拟仪器系统进行必要的数据存储，然后将原始数据转换为“实部＋虚部”的相量表示数据，再由虚拟仪器系统的谐波分布与识别应用程序进行数据处理和分析，进一步谐波分布状态估计、谐波成因识别、谐波类型识别等等。虚拟仪器系统是本发明整体性解决方案的核心与关键，通过LabVIEW进行谐波分布与识别应用程序编程，包括数据接收与处理模块、谐波分析模块、谐波分布状态估计模块、谐波源定位模块、谐波识别模块、显示模块和记录存储模块等多个单元模块。在虚拟仪器接收到数据后对信号依据时标和节点进行分组，滤波整形后进行傅里叶变换得到各次谐波的同步相量值，以此进行谐波分布状态估计，得到各个时标下的谐波状态，进一步计算各节点功率，依据具体的功率值定位谐波源并划分谐波责任，在谐波源处计算谐波基本参数判别其成因；通过小波变换获取信号时频特征判别其谐波类别，是否为电弧型、电力电子开关型、铁磁饱和型；将结果显示于交互界面。参见图1-图3，一种基于虚拟仪器的园区电力谐波分布与识别方法，包括以下步骤：步骤一：依据拓扑可观性原则和方法在待测园区用电系统的关键节点配置信号采集终端，信号采集终端同步采集各关键节点的电气信号，并将所采集的信号数据传输至电脑主机。进一步地，用于进行同步信号采集的信号采集终端，具体包括：信号采集单元，其包括电压电流互感器、模数转换器ADC和同步信号发生器，电压电流互感器获取采样节点的电气信号，经由模数转换器ADC转换为数字信号，并传输至微处理器等待进行下一步处理，其中，模数转换器ADC的采样信号以BDS信号为基准，BDS信号则由同步信号发生器生成，保证信号采集的同步性；数据处理单元，其包括BDS信号接收器、微处理器和存储单元，BDS信号接收器用于接收BDS时钟信号并分别传输给微处理器和同步信号发生器，微处理器持续不断的接收来自模数转换器ADC的数字信号并暂时存储，以BDS时钟信号为基准，以固定时长截取数字信号并打上精确的时标一同打包送至存储单元，准备发送至电脑主机；信号发射单元，其主要包括通信接口，该通信接口由微处理器生成的发射信号进行控制，用于将存储单元中的数据包发送至电脑主机进行处理。其中，在条件允许的情况下，信号发射单元与电脑主机之间通过布置光纤进行数据传输，保证通信的可靠性；在条件有限的情况下，信号发射单元与电脑主机之间通过无线网络进行数据传输，保证系统的正常运行。步骤二：电脑主机与虚拟仪器系统相连，虚拟仪器系统采用LabVIEW进行谐波分布与识别应用程序编程，其中谐波分布与识别应用程序具体包括数据接收与处理模块、谐波分析模块、谐波分布状态估计模块、谐波源定位模块、谐波识别模块、显示模块以及记录存储模块等功能模块，下面对各个功能模块逐一进行说明。数据接收与处理模块，用于接收来自信号采集终端的数据，并依据采集节点和时标对接收到的信号数据进行数据分组；对每一组信号数据分别进行整形滤波，然后将处理好的信号送至谐波分析模块。谐波分析模块，用于对处理后的每一组波形信号进行傅里叶变换，得到各次谐波的幅度谱和相位谱，并将其转化为便于计算的复数形式即同步相量，为分布状态估计、成因和类型识别等模块提供基础数据，同时进行谐波基本特征参数和统计参数的计算。谐波分布状态估计模块，用于进行园区内电力系统谐波分布状态的整体性估计。谐波分布状态估计模块以量测节点谐波电压、量测节点相连的支路谐波电流以及值为0的零注入节点谐波注入电流作为量测量，以各节点各次谐波电压作为状态量，列出量测方程，并利用最小二乘法求解量测方程，获取各节点的电压估计值、注入电流值、谐波的复功率，最终得到状态估计结果，其中状态估计结果包括谐波分布状态图谱和谐波分布状态估计表，谐波分布状态图谱又包括节点-幅值-谐波次数三维分布图谱和节点-相位-谐波次数三维分布图谱，谐波分布状态估计表又包括节点谐波电压估计表、节点注入谐波电流估计表和节点注入谐波功率估计表。具体地，根据园区配电网络的拓扑结构以及线路和设备参数建立谐波分布状态估计的数学模型，计算节点各次谐波导纳矩阵并以此列出量测方程，量测方程以量测节点谐波电压、量测节点相连的支路谐波电流以及值为0的零注入节点谐波注入电流作为量测量，以各节点各次谐波电压作为状态量，分别列出三种方程，三种方程共同组成量测方程，其中量测节点谐波电压方程为：，其中，为节点的次谐波电压量测量，为节点的次谐波电压状态量。量测节点相连的支路谐波电流方程为：，其中，为节点和节点之间支路的次谐波电流量测量，、分别为节点和节点的次谐波电压状态量，为节点导纳矩阵中节点和节点对应的导纳矩阵元素。零注入节点谐波注入电流方程为：，其中，为节点的次谐波注入电流，其值为0，为电力网络节点个数。因为上述所列方程皆为线性方程，因此量测方程总体可写为矩阵形式，即，其中，为量测量组成的列向量，为状态量组成的列向量，是由所列线性方程生成的关系矩阵。因为电力系统运行过程中可能会受到扰动，并且测量过程中不可避免的会有误差,无论量测量取何值上述等式均几乎不可能成立，因此这里在矩阵形式的量测方程中引入估计误差，将矩阵形式的量测方程改写为：其中，为估计误差。为使误差趋近于0，利用最小二乘法对改写后的量测方程进行求解，获取各节点电压估计值，可列方程：，其中。同样的，因为是线性方程，，方程可以改写为，则。向量各元素的值即为各节点电压估计值，根据节点电流方程计算各节点注入电流：，其中，为次谐波节点注入电流列向量，为次谐波情况下节点导纳矩阵，为次谐波节点电压列向量。通过谐波分布状态估计得到的电压电流相量值，计算出各个节点谐波的复功率：，其中，为节点次谐波复功率，为节点次谐波电压相量值，为节点次谐波注入电流相量值的共轭。复功率的实部为有功功率，虚部为无功功率，模值为视在功率，相位为功率角。上述估计值均为复数形式，并以此生成节点谐波电压估计表、节点谐波电流估计表、节点谐波功率估计表、节点-幅值-谐波次数三维分布图谱和节点-相位-谐波次数三维分布图谱。谐波源定位模块，用于计算各节点的功率，依据计算的功率值定位谐波源的位置，例如支路、负荷设备，并给出划分谐波责任结果。以三相功率和为基准，在视在功率的条件下，排除50Hz分量的功率和趋近于0的功率，剩余的即谐波功率，以此定位到谐波源的位置和存在的谐波频率，依据其复功率实部虚部数值及正负确定该节点是吸收谐波功率还是发射谐波功率，是无功功率还是有功功率，并根据发射和吸收功率的大小来划分谐波责任，同时计算出谐波源处相关谐波的基本参数。谐波识别模块，包括谐波成因识别模块，用于根据谐波基本特征参数判断谐波源的成因，以及谐波类型识别模块，用于根据时频特征判断电力系统中存在的谐波类型。谐波识别模块根据谐波基本特征参数判断谐波源成因的过程具体为：a.若电压等级在1000V以下，频率f小于100Hz，间谐波电压含有率大于0.16且电阻符合电弧电阻的伏安特性曲线，或者电压等级在1000V以上，频率f小于100Hz，间谐波电压含有率大于0.13且电阻符合电弧电阻的伏安特性曲线，则所述谐波识别模块判断谐波源的成因为电弧型成因，否则进行下一步判断；b.若支路负载电流的谐波电流次数为其中，，，且不含有偶次谐波，则所述谐波识别模块判断谐波源的成因为电力电子开关型成因，否则进行下一步判断；c.若支路电流主要谐波为3次、5次和7次谐波，其余谐波含有率极小，并且谐波含量随着电压的升高而增加，则所述谐波识别模块判断谐波源的成因为铁磁饱和型成因，否则判定谐波源的成因为其它类型成因。谐波识别模块根据时频特征判断谐波类型的过程具体为：提取时频特征：时频特征的提取方式为以复数Morlet小波为小波基进行连续小波变换，获取量测支路电流信号在时域以及频域上幅值和相位的变化，以此辨别电力系统中存在的谐波类型，如平稳谐波、时变谐波、扰动谐波等，其中小波变换是通过调用函数生成的dll文件实现的混合编程来完成的。因为在选择的节点上配置信号采集终端后全局可观测，所以依靠终端采集到的支路电流足以表现出整个电力网络中存在的谐波类型。当观察某一支路电流在某一时刻的暂态时，先读取记录起来的波形数据，然后对其进行小波变换，通过频率分解出单一频率的波形，观察其幅值的变化；剩余的频率分量相叠加作为频率变化的分量，寻找其变化时间点。同时以时间-频率-幅值三维分布图形式输出以便观察全局。在小波变换过程中，为了避免小波变换在信号起点和终点处仍处于过渡状态数值不准确，对信号进行小波变换时接上相邻的信号和信号，对合并信号进行小波变换，截取中间对应信号的一段结果作为信号小波变换的结果。显示模块，用于实时显示上述谐波分布状态估计表、谐波分布状态图谱、趋势图和谐波成因、谐波类型分析等的相关信息，同时设置交互选项。记录存储模块，由于内存有限，因此需要将以上模块中计算的结果和原始信号储存在数据库中，方便后期趋势性、周期性的观察以及进行一些数据的计算。本发明还具有以下有益效果：本发明提供了一种园区级整体性解决方案，以园区配电网及其用电负荷设备为一个独立目标单元，明确园区电力谐波的问题体系，对其所有节点的谐波发射水平和分布状态进行求解，同时完成谐波源定位、谐波成因和谐波类型识别，从而在线、连续、透明化实时掌控园区谐波状态；只需在园区内部分关键节点配置若干个信号采集终端，无需在全区所有电气节点布设，而且能够通过分布状态估计算法达到园区整体谐波分布状态估计的目的，达到了便利性、整体性和经济性的高度统一；信号采集终端采用北斗BDS信号同步，统一时间基准，虚拟仪器计算出的数据作为园区内动态同步电压电流相量信号，包含幅值信息和相位信息，具有完整意义上的整体性和真正意义上的实时性，满足后续谐波分布状态估计和谐波源定位的方法需求，数据价值高；量测系统基于虚拟仪器的体系架构，简单、便捷、低成本，本地化，有利于产业园区独立自主构建监测系统，摆脱广域电力监测系统的大规模、高门槛和行业壁垒；基于虚拟仪器技术的平台和方案进行整个园区的谐波状态估计，估计算法和识别方法的软件化实施，具有软件化和平台化特征；软件化具体表现为硬件最小化、软件最大化，将园区谐波分布与识别问题的目标任务移交到虚拟仪器软件，所有节点、各次谐波的幅值、相位整体性呈现，谐波的负荷来源清晰明了；平台化具体表现为基于一代硬件可以实现多代软件升级，开放兼容与可持续发展。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本发明的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。因此，本发明专利的保护范围应以所附权利要求为准。
