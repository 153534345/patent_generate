标题title
一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法
摘要abst
本发明公开了一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，属于仿生机器鱼的控制技术领域。首先建立多胸鳍拍动式机器鱼通信场景，设计多胸鳍拍动式机器鱼之间的作用拓扑关系图，并建立单个胸鳍拍动式机器鱼的运动学模型；然后采用最近邻连接方式对每个胸鳍拍动式机器鱼构建CPG拓扑网络，采用模糊闭环控制策略实现各机器鱼的航向和速度的定量控制；最后根据虚拟领导者‑跟随者编队跟踪算法，设计多胸鳍拍动式机器鱼在有向固定拓扑条件下的编队跟踪控制协议，并结合单个胸鳍拍动式机器鱼的动力学方程和运动学方程，实现胸鳍拍动式机器鱼编队切换控制。本发明有效适应不同的编队队形，且通信负载小，实现了队形之间的优势互补。
权利要求书clms
1.一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，其特征在于，具体步骤如下：步骤一，建立多胸鳍拍动式机器鱼通信场景，设计多胸鳍拍动式机器鱼之间的作用拓扑关系图，表明各胸鳍拍动式机器鱼之间的相互作用关系；步骤二，建立单个胸鳍拍动式机器鱼的运动学模型；基于胸鳍拍动式机器鱼胸鳍拍动过程中的空间和时间非对称性特征、尾部拍动的空间和时间非对称性特征以及胸鳍与尾部的运动关系，建立胸鳍拍动式机器鱼的运动学模型；步骤三，基于单个胸鳍拍动式机器鱼的运动学模型，采用最近邻连接方式对每个胸鳍拍动式机器鱼构建CPG拓扑网络，确定每个机器鱼各CPG单元间的耦合关系；步骤四，针对单个机器鱼S，采用模糊闭环控制策略实现该机器鱼S的航向和速度的定量控制，并将航向参数和速度参数输入该机器鱼S的CPG拓扑网络，生成该机器鱼S控制舵机的PWM信号；具体为：首先，根据当前机器鱼S中的传感器反馈的实际航向，以及控制指令中心确定的期望航向，计算实际航向与期望航向的差作为航向模糊控制器的偏差输入；然后，将偏差输入通过航向模糊控制器进行查表运算，生成航向参数δY的值；最后，通过航向参数转换将δY转换为期望相位差，并作为当前机器鱼S的CPG拓扑网络的参数输入，经CPG拓扑网络生成控制舵机的PWM信号；航向参数转换方程表示为：其中，为序号I单元与序号J单元之间的期望相位差极大值，为非负数；当δY小于0，机器鱼左转弯，此时随着δY从0变到-1，右侧胸鳍鳍条间的期望相位差维持/＞不变，左侧胸鳍鳍条间的相位差由/＞变到/＞δY绝对值越大，转弯速度越大半径越小；当δY大于0，机器鱼右转弯，此时随着δY从0变到1，左侧胸鳍鳍条间的期望相位差维持不变，右侧胸鳍鳍条间的相位差由/＞变到/＞同理，利用相应的模糊控制器和参数转换，得到速度参数δV和深度参数，并输入当前机器鱼S的拓扑网络，生成控制舵机的PWM信号；速度参数转换方程表示为：/＞其中，当δV小于0，表示机器鱼倒游；当δV大于0，表示机器鱼前游；δV的绝对值越大，速度绝对值越大；为振幅系数，kT为周期系数，T0为机器鱼胸鳍摆动周期；步骤五，将胸鳍拍动式机器鱼编队的动力学方程转化为积分器动态模型，根据有向切换通信拓扑的虚拟领导者-跟随者编队跟踪算法，设计多胸鳍拍动式机器鱼在有向固定拓扑条件下的编队跟踪控制协议；所述的有向切换通信拓扑的虚拟领导者-跟随者编队跟踪算法，具体设计流程如下：步骤501，建立虚拟领导者-跟随者的系统模型，设计虚拟领导者与各跟随者之间的通信作用拓扑图，对于每个跟随者，存在一棵以虚拟领导者为根节点的生成树；所述的系统模型包含一个虚拟领导者和N个跟随者；虚拟领导者的状态模型表示为其中表示虚拟领导者的状态，/＞表示虚拟领导者的输入；各跟随者的状态模型表示为其中表示跟随者集合，/＞表示跟随者i对应的状态，/＞表示跟随者i对应的控制输入；/＞和/＞表示系统矩阵，且B为列满秩矩阵，即rank＝m；步骤502，设计不同拓扑切换的通信作用拓扑图，使切换的通信拓扑均包含有向生成树，编队队形在拓扑切换时刻重新组成目标编队进行运动；令切换拓扑集合为p≥1表示所有的有向通信拓扑图集合；定义切换拓扑关系信号指数为σ，其中/＞定义t0＝0为初始时刻，0＝t0＜t1＜t2＜…＜tp表示切换拓扑关系信号指数的切换时刻；/＞为t时刻的拓扑图；整个系统的通信拓扑关系在时间区间N×N，如果∈ε，则aij＝1；否则，aij＝0；不考虑节点自身之间的作用，即邻接矩阵的对角元素满足aii＝0；节点vi的邻居集合定义为Ni＝{vj|∈ε}，即有信息流向节点vi的其它节点集合；将入度矩阵定义为对角矩阵D＝diag，其中di为节点i的入度，即邻接矩阵A的第i行之和；定义通信图的拉普拉斯矩阵为L＝D-A，它的所有行的行和都等于零。3.根据权利要求1所述的一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，其特征在于，所述的胸鳍拍动式机器鱼的运动学模型表示为：式中，I和J表示控制机器鱼胸鳍拍动的CPG单元序号，取值为1-8，对应于驱动机器鱼胸鳍拍动的舵机编号；νI表示序号I的CPG单元频率输出，φI表示序号I的CPG单元相位输出，rI表示序号I的CPG单元振幅输出，xI表示序号I的CPG单元偏置输出，θI表示序号I的CPG单元角度输出，βI为序号I的CPG单元空间非对称系数，αI为序号I的CPG单元时间非对称系数；TI表示序号I的CPG单元周期，ωIJ表示序号I单元与序号J单元间的连接权重，表示序号I单元与序号J单元的期望相位差，RI为机器鱼胸鳍序号I的CPG单元的期望振幅，XI为机器鱼胸鳍序号I的CPG单元的期望偏置，k、aI和bI为正值常数。4.根据权利要求1所述的一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，其特征在于，步骤三中所述的CPG拓扑网络的相关参数是当前机器鱼中各CPG单元的期望相位差矩阵和耦合权重矩阵ω；拓扑网络的期望相位差矩阵表示为：耦合权重矩阵ω确定CPG单元的拓扑连接形式，表示为：5.根据权利要求1所述的一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，其特征在于，胸鳍拍动式机器鱼的游动速度与所述的速度参数δV为线性正比关系；胸鳍拍动式机器鱼的转弯速度与所述的速度参数δV相关，当δY不变时，δV越大，拍动振幅RI和频率ν更大，单侧胸鳍产生的推力更大，从而两侧胸鳍推力形成的转弯扭矩更大；同时，转弯速度与所述的航向参数δY近似线性关系。6.根据权利要求1所述的一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，其特征在于，所述的编队跟踪算法相关的参数包括：存在一个非奇异矩阵满足/＞其中/＞计算/＞和/＞选定κ＞0，求解下述线性矩阵不等式，得到可行解P＞0；ATP+PA-αPBBTP+κP＜0选择α＞0，使其满足通过计算正定对称矩阵Qσ；通过K＝-BTP，计算常数增益矩阵选择切换拓扑的最小驻留时间τ0满足lnh0-κτ0＜0；其中7.根据权利要求1所述的一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，其特征在于，步骤六中所述的胸鳍拍动式机器鱼的动力学方程的具体计算过程为：理想条件下，建立机器鱼在二阶积分器形式的下的动态模型为：其中，γi和τi分别表示第i个机器鱼在二维平面下坐标系中的位置信息，θi表示第i个机器鱼在二维平面下的航向信息，ωi表示转动角速度；将速度积分控制模型表示为：其中ui为编队跟踪控制算法对应的控制输入；进一步，将速度控制项表示为：其中，qi为中间变量；基于反馈线性化方法设计控制律为：则，单个机器鱼的编队控制算法非线性动力学方程可线性化为：/＞其中，ξi＝T，ui＝T；矩阵A、B表示如下：/＞
说明书desc
技术领域本发明属于仿生机器鱼的控制技术领域，涉及一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，包括胸鳍拍动式机器鱼编队的生成和保持，实现胸鳍拍动式机器鱼编队队形的协调切换控制。背景技术水下机器人通过搭载各种不同类型的传感器可以完成水下环境的搜索、搜救、监测、资源勘探和水雷检测等任务，在民用和军用领域发挥了重要作用。随着水下机器人技术的发展，各种任务对水下机器人的需求越来越大，也越来越高，单个水下机器人存在工作范围小、执行任务单一、效率低下以及容错性较差等问题。为了解决上述问题，多水下机器人的协同作业成为了研究的重点方向。多水下机器人系统具有分布式、自适应和鲁棒性等优良特性，避免了单个机器人携带多种传感器造成的系统复杂冗余等问题，有效提高了作业的效率，降低了执行任务的成本。从仿生学的观点来看，水下机器人又分为螺旋桨推进的鱼雷型机器人和师法自然的仿生机器鱼。仿生机器鱼与螺旋桨推进的水下机器人相比具有噪音小、隐蔽性好、机动性好、能量利用效率高等优点，仿生机器鱼的编队协同控制将是下一步的发展方向，具有广阔的应用前景。近些年来，众多研究人员提出了使用于不同模型的编队控制方法，较为成熟的是移动机器人和空中机器人的编队，这些控制方法将目标对象的动力学模型抽象为一阶、二阶积分器模型，从而实现预期的编队队形控制。许多科研人员通过结合观测器理论、自适应理论及滑模控制理论等现代控制方法构造多自主水下航行器的分布式编队协同控制算法。文献针对欠驱动的水下机器人编队问题，提出了一种基于位置信息的领航者-跟随者自适应编队控制算法。文献针对欠驱动水下机器人在不确定动力学和海洋扰动下的编队控制问题，提出了一种仅依赖领航者位置测量的鲁棒滑模控制策略。文献针对欠驱动水下机器人在海流干扰下的编队控制问题，提出了一种虚拟领航者-跟随者的控制策略。通过建立水下机器人的动力学模型，设计鲁棒控制器，利用跟随者对虚拟领航者的距离和角度观测信息生成和维持水下机器人编队。文献针对在三维水下空间运动的欠驱动自主水下航行器，提出了一种分布式编队跟踪算法。文献分析了一阶多智能体系统的编队跟踪控制。文献将分布式编队控制策略应用于基于局部邻居到邻居的信息交换的一组二阶集群系统。文献提出了一种用于二阶多智能体系统的有限时间编队控制协议，该协议在有限时间内实现了时不变编队跟踪。文献针对鱼类的集群游动行为，设计了大量的仿生鱼体游动实验，分析了鱼群内部结对巡游的两条鱼的游动特定，，提出了一种鱼类群体游动采用的涡流相位匹配的策略，对于集群节能控制算法的设计具有启发意义。文献研究了三条仿生机器鱼之间保持给定圆周距离的绕圆圈游动行为，对研究多仿生机器鱼具有一定的借鉴意义。综合上述所有参考文献可知，现有方法多是对螺旋桨推进的多自主水下机器人的协同控制方面的研究，但在仿生机器鱼群体的协同控制上尚无有效可行的编队队形切换控制方法。发明内容本发明为了解决当前胸鳍拍动式机器鱼的编队队形切换控制方法存在的技术空白，提出一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法。所述有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，具体步骤如下：步骤一，建立多胸鳍拍动式机器鱼通信场景，设计多胸鳍拍动式机器鱼之间的作用拓扑关系图，表明各胸鳍拍动式机器鱼之间的相互作用关系。以各胸鳍拍动式机器鱼作为通信节点，设计不同拓扑切换的通信图，使切换的通信拓扑均包含有向生成树，编队队形在拓扑切换时刻重新组成目标编队进行运动。具体为：将机器鱼之间的信息流建模为一个通信图该通信图中具有N个节点的非空有限集合/＞表示机器鱼的状态，N代表机器鱼的数量；通信图中一组边代表机器鱼之间的通信信息传输流向。表示节点vi到节点vj的信息传播流向，即节点vj接收节点vi的信息。通信图中没有重复的边或自循环，即/＞在多胸鳍拍动式机器鱼通信场景中，信息沿着有向边通过通信图传播。将邻接矩阵表示为A＝N×N，如果则aij＝1；否则，aij＝0。不考虑节点自身之间的作用，即邻接矩阵的对角元素满足aii＝0。节点vi的邻居集合定义为即有信息流向节点vi的其它节点集合。将入度矩阵定义为对角矩阵D＝diag，其中di为节点i的入度，即邻接矩阵A的第i行之和。定义通信图的拉普拉斯矩阵为L＝D-A，它的所有行的行和都等于零。步骤二，建立单个胸鳍拍动式机器鱼的运动学模型；具体过程为：基于胸鳍拍动式机器鱼胸鳍拍动过程中的空间和时间非对称性特征、尾部拍动的空间和时间非对称性特征以及胸鳍与尾部的运动关系，建立胸鳍拍动式机器鱼的运动学模型。机器鱼的运动学模型表示为：式中，I和J表示控制机器鱼胸鳍拍动的CPG单元序号，取值为1-8，对应于驱动机器鱼胸鳍拍动的舵机编号；νI表示序号I的CPG单元频率输出，φI表示序号I的CPG单元相位输出，rI表示序号I的CPG单元振幅输出，xI表示序号I的CPG单元偏置输出，θI表示序号I的CPG单元角度输出，βI为序号I的CPG单元空间非对称系数，αI为序号I的CPG单元时间非对称系数；TI表示序号I的CPG单元周期，ωIJ表示序号I单元与序号J单元间的连接权重，表示序号I单元与序号J单元的期望相位差，RI为机器鱼胸鳍序号I的CPG单元的期望振幅，XI为机器鱼胸鳍序号I的CPG单元的期望偏置，k、aI和bI为正值常数。步骤三，基于单个胸鳍拍动式机器鱼的运动学模型，采用最近邻连接方式对每个胸鳍拍动式机器鱼构建CPG拓扑网络，确定每个机器鱼各CPG单元间的耦合关系；构建拓扑网络时，相关参数是当前机器鱼中各CPG单元的期望相位差矩阵和耦合权重矩阵ω。拓扑网络的期望相位差矩阵表示为：耦合权重矩阵ω确定CPG单元的拓扑连接形式，表示为：步骤四，针对单个机器鱼S，采用模糊闭环控制策略实现该机器鱼S的航向和速度的定量控制，并将航向参数和速度参数输入该机器鱼S的CPG拓扑网络，生成该机器鱼S控制舵机的PWM信号；具体为：首先，根据当前机器鱼S中的传感器反馈的实际航向，以及控制指令中心确定的期望航向，计算实际航向与期望航向的差作为航向模糊控制器的偏差输入；然后，将偏差输入通过航向模糊控制器进行查表运算，生成航向参数δY的值；最后，通过航向参数转换将δY转换为期望相位差，并作为当前机器鱼S的CPG拓扑网络的参数输入，经CPG拓扑网络生成控制舵机的PWM信号。航向参数转换方程表示为：其中，为序号I单元与序号J单元之间的期望相位差极大值，为非负数。当δY小于0，机器鱼左转弯，此时随着δY从0变到-1，右侧胸鳍鳍条间的期望相位差维持/＞不变，左侧胸鳍鳍条间的相位差由/＞变到/＞δY绝对值越大，转弯速度越大半径越小；当δY大于0，机器鱼右转弯，此时随着δY从0变到1，左侧胸鳍鳍条间的期望相位差维持不变，右侧胸鳍鳍条间的相位差由/＞变到/＞同理，利用相应的模糊控制器和参数转换，得到速度参数δV和深度参数，并输入当前机器鱼S的拓扑网络，生成控制舵机的PWM信号。速度参数转换方程表示为：其中，当δV小于0，表示机器鱼倒游；当δV大于0，表示机器鱼前游；δV的绝对值越大，速度绝对值越大。kRI为振幅系数，kT为周期系数，T0为机器鱼胸鳍摆动周期。游动速度与速度参数δV近似线性正比关系。此外，转弯速度与速度参数δV相关，当δY不变时，δV越大，拍动振幅RI和频率ν更大，单侧胸鳍产生的推力更大，从而两侧胸鳍推力形成的转弯扭矩更大。同时，转弯速度与航向参数δY近似线性关系。步骤五，将胸鳍拍动式机器鱼编队的动力学方程转化为积分器动态模型，根据有向切换通信拓扑的虚拟领导者-跟随者编队跟踪算法，设计多胸鳍拍动式机器鱼在有向固定拓扑条件下的编队跟踪控制协议；所述的有向切换通信拓扑的虚拟领导者-跟随者编队跟踪算法，具体设计流程如下：步骤501，建立虚拟领导者-跟随者的系统模型，设计虚拟领导者与各跟随者之间的通信作用拓扑图，对于每个跟随者，存在一棵以虚拟领导者为根节点的生成树。所述的系统模型包含一个虚拟领导者和N个跟随者。虚拟领导者的状态模型表示为其中表示虚拟领导者的状态，/＞表示虚拟领导者的输入。各跟随者的状态模型表示为其中表示跟随者集合，/＞表示跟随者i对应的状态，表示跟随者i对应的控制输入。/＞和/＞表示系统矩阵，且B为列满秩矩阵，即rank＝m。步骤502，设计不同拓扑切换的通信作用拓扑图，使切换的通信拓扑均包含有向生成树，编队队形在拓扑切换时刻重新组成目标编队进行运动。令切换拓扑集合为p≥1表示所有的有向通信拓扑图集合。定义切换拓扑关系信号指数为σ，其中/＞定义t0＝0为初始时刻，0＝t0＜t1＜t2＜…＜tp表示切换拓扑关系信号指数的切换时刻。/＞为t时刻的拓扑图。整个系统的通信拓扑关系在时间区间根据虚拟领导者和跟随者的通信拓扑关系，虚拟领导者不接收来自跟随者的状态信息，因此，虚拟领导者-跟随者编队跟踪系统的拉普拉斯矩阵为：其中表示t时刻跟随者内部之间的通信拓扑关系，/＞表示虚拟领导者与跟随者之间的通信拓扑关系。步骤503，为跟随者设计编队参考函数，并判断其是否满足编队可行性条件，若是，则执行步骤504；否则，则重新选取跟随者的编队参考函数，直至满足编队可行性条件；跟随者的编队参考函数为为第i个跟随者的期望编队。编队可行性条件为：其中步骤504，基于编队可行性条件，对编队跟踪算法相关的参数进行求解；编队跟踪算法相关的参数包括：存在一个非奇异矩阵满足其中/＞计算/＞和/＞选定κ＞0，求解下述线性矩阵不等式，得到可行解P＞0；ATP+PA-αPBBTP+κP＜0选择α＞0，使其满足通过计算正定对称矩阵Qσ；通过K＝-BTP，计算常数增益矩阵选择切换拓扑的最小驻留时间τ0满足lnh0-κτ0＜0。其中步骤505，基于编队跟踪算法的相关参数，得到编队跟踪控制协议；设计状态反馈的编队跟踪控制协议为：其中为常数增益矩阵，/＞是由编队参考函数h决定的外部指令信号。步骤六，基于编队跟踪控制协议得到单个胸鳍拍动式机器鱼的动力学方程，并结合单个胸鳍拍动式机器鱼的运动学方程，使得跟随者机器鱼按照设计的编队队形跟随虚拟领导者轨迹进行编队跟踪运动，实现胸鳍拍动式机器鱼编队切换控制。胸鳍拍动式机器鱼的动力学方程的具体计算过程为：理想条件下，建立机器鱼在二阶积分器形式的下的动态模型为：其中，γi和τi分别表示第i个机器鱼在二维平面下坐标系中的位置信息，θi表示第i个机器鱼在二维平面下的航向信息，ωi表示转动角速度。将速度积分控制模型表示为：其中ui为编队跟踪控制算法对应的控制输入。进一步，将速度控制项表示为：其中，qi为中间变量。基于反馈线性化方法设计控制律为：则，单个机器鱼的编队控制算法非线性动力学方程可线性化为：其中，ξi＝T，ui＝T。矩阵A、B表示如下：将单个胸鳍拍动式机器鱼的动力学方程与步骤二中的运动学方程相结合，实现多胸鳍拍动式机器鱼场景在运动过程中的编队队形控制。本发明的优点在于：本发明在胸鳍拍动式机器鱼有向通信作用拓扑编队队形切换情况下，通过将机器鱼的前向、俯仰和转向的运动学模型和动力学模型转化为积分器模型，并在控制算法中加入基于机器鱼领域位置信息感知的控制协议，形成每个机器鱼的编队队形控制律，有效适应不同的编队队形，并实现期望的编队队形。本发明设计了基于胸鳍拍动式机器鱼之间的有向通信作用拓扑，对于不同的切换作用拓扑，只需保证存在以虚拟领导者机器鱼作为根节点的生成树即可，减少了机器鱼在水下恶劣环境通信过程中的负载量。附图说明图1为本发明有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法的整体流程图；图2为本发明单个胸鳍拍动式机器鱼运动坐标系和前游姿态示意图；图3为本发明胸鳍拍动式仿生机器鱼切换编队队形示意图；图4为本发明胸鳍拍动式仿生机器鱼切换编队对应的有向切换作用拓扑图；图5为本发明单个胸鳍拍动式机器鱼中各CPG单元的示意图；图6为本发明胸鳍拍动式仿生机器鱼采用模糊闭环控制策略实现航向和速度控制的流程图；图7为本发明胸鳍拍动式仿生机器鱼编队控制算法与机器鱼个体控制的转换关系图；图8为本发明实施例胸鳍拍动式仿生机器鱼编队起始位置分布图；图9为本发明实施例胸鳍拍动式仿生机器鱼三角形编队队形生成过程；图10为本发明实施例胸鳍拍动式仿生机器鱼三角形编队队形运动保持；图11为本发明实施例胸鳍拍动式仿生机器鱼三角形编队队形切换为六边形队形；图12为本发明实施例胸鳍拍动式仿生机器鱼六边形编队队形生成过程；图13为本发明实施例胸鳍拍动式仿生机器鱼六边形编队运动队形保持；图14为本发明实施例胸鳍拍动式仿生机器鱼编队过程运动轨迹；图15为本发明实施例胸鳍拍动式仿生机器鱼跟随者机器鱼编队运动过程中实际位置与队形理论位置的偏差。具体实施方式下面将结合附图和实施例对本发明作进一步的详细说明。本发明提出一种结合代数图论、矩阵理论与基于胸鳍拍动式机器鱼相对位移的控制策略，采用了虚拟领导者机器鱼-跟随者机器鱼的编队跟踪策略，通过为虚拟领导者机器鱼设计期望的运动轨迹，并为跟随者机器鱼设计基于领导者的期望目标队形，使跟随者机器鱼在跟随领导者机器鱼运动的过程中生成期望的目标队形，控制跟随者机器鱼与领导者机器鱼之间相对位置的具体变化，达到了胸鳍拍动式机器鱼运动过程中保持编队队形的效果。同时，本发明设计相应的切换队形，编队队形切换控制方法能控制机器鱼实现队形之间的顺利切换，增强了机器鱼协同编队的适应能力，同时采用有向通信作用拓扑简单，基于分布式控制架构，减小了机器鱼之间的通信量，通信负载小，实现了队形之间的优势互补。一种有向切换拓扑胸鳍拍动式机器鱼编队切换控制方法，如图1所示，具体步骤如下：步骤一，建立多胸鳍拍动式机器鱼通信场景，设计多胸鳍拍动式机器鱼之间的作用拓扑关系图，表明胸鳍拍动式机器鱼之间的相互作用关系，描述多胸鳍拍动式机器鱼之间的信息传输。以各胸鳍拍动式机器鱼作为通信节点，设计不同拓扑切换的通信图，使切换的通信拓扑均包含有向生成树，编队队形在拓扑切换时刻重新组成目标编队进行运动。具体过程为：将机器鱼之间的信息流建模为一个通信图。考虑一个图具有N个节点的非空有限集合/＞表示机器鱼的状态，N代表机器鱼的数量；通信图中一组边代表机器鱼之间的通信信息传输流向。表示节点vi到节点vj的信息传播流向，即节点vj接收节点vi的信息。图中没有重复的边或自循环，即/＞考虑一般有向图，并认为信息沿着有向边通过图传播。将邻接矩阵表示为A＝N×N，如果则aij＝1；否则，aij＝0。不考虑节点自身之间的作用，即邻接矩阵的对角元素满足aii＝0。节点vi的邻居集合定义为即有信息流向节点vi的其它节点集合。将入度矩阵定义为对角矩阵D＝diag，其中为节点i的入度。定义图拉普拉斯矩阵为L＝D-A，它的所有行的行和都等于零。步骤二，建立单个胸鳍拍动式机器鱼的运动学模型。单个胸鳍拍动式机器鱼如图2所示，基于胸鳍拍动式机器鱼胸鳍拍动过程中空间非对称性特征和时间非对称性特征，尾部拍动的空间和时间非对称性特征，以及胸鳍与尾部的运动关系，建立胸鳍拍动式机器鱼的运动学模型，构建特殊结构形式的CPG网络，确定CPG单元间的耦合关系，提出空间和时间非对称性特征的实现方式。具体过程为：机器鱼的运动学模型表示为：式中，I和J表示控制机器鱼胸鳍拍动的CPG单元序号，取值为1-8，对应于驱动机器鱼胸鳍拍动的舵机编号；νI表示序号I的CPG单元频率输出，φI表示序号I的CPG单元相位输出，rI表示序号I的CPG单元振幅输出，xI表示序号I的CPG单元偏置输出，θI表示序号I的CPG单元角度输出，βI为序号I的CPG单元空间非对称系数，αI为序号I的CPG单元时间非对称系数；TI表示序号I的CPG单元周期，ωIJ表示序号I单元与序号J单元间的连接权重，表示序号I单元与序号J单元的期望相位差，RI为机器鱼胸鳍序号I的CPG单元的期望振幅，XI为机器鱼胸鳍序号I的CPG单元的期望偏置，k、aI和bI为正值常数。步骤三，基于单个胸鳍拍动式机器鱼的运动学模型，采用最近邻连接方式对每个胸鳍拍动式机器鱼构建CPG拓扑网络，确定每个机器鱼各CPG单元间的耦合关系；针对各种形式的拓扑网络，由于全连接网络复杂且计算量较大，而单片机系统计算速度有限，因此本方法排除全连接网络形式。由于各单元在机器鱼胸鳍拍动过程中作用基本均等，且单侧胸鳍相邻单元联系紧密，胸鳍和尾鳍联合摆动的游动姿态，本方法采用最近邻连接和最简连接方式构建的CPG拓扑网络，单个胸鳍拍动式机器鱼中的各CPG单元如5所示。构建拓扑网络时，相关参数是当前机器鱼中各CPG单元的期望相位差矩阵和耦合权重矩阵ω。拓扑网络的期望相位差矩阵表示为：耦合权重矩阵ω确定CPG单元的拓扑连接形式，表示为：步骤四，针对单个机器鱼S，采用模糊闭环控制策略实现该机器鱼S的航向和速度的定量控制，并将航向参数和速度参数输入该机器鱼S的CPG拓扑网络，生成该机器鱼S控制舵机的PWM信号；具体为：首先，根据当前机器鱼S中的传感器反馈实际航向，以及控制指令中心确定的期望航向，计算实际航向与期望航向的差作为航向模糊控制器的偏差输入；然后，将偏差输入通过航向模糊控制器进行查表运算，生成航向参数δY的值；最后，通过航向参数转换将δY转换为期望相位差，并作为当前机器鱼S拓扑网络的参数输入，经拓扑网络生成控制舵机的PWM信号。航向参数转换方程表示为：其中，为序号I单元与序号J单元之间的期望相位差极大值，为非负数。当δY小于0，机器鱼左转弯，此时随着δY从0变到-1，右侧胸鳍鳍条间的期望相位差维持/＞不变，左侧胸鳍鳍条间的相位差由/＞变到/＞δY绝对值越大，转弯速度越大半径越小；当δY大于0，机器鱼右转弯，此时随着δY从0变到1，左侧胸鳍鳍条间的期望相位差维持不变，右侧胸鳍鳍条间的相位差由/＞变到/＞同理，利用相应的模糊控制器和参数转换，得到速度参数δV和深度参数，并输入当前机器鱼S的拓扑网络，生成控制舵机的PWM信号。速度参数转换方程表示为：其中，当δV小于0，表示机器鱼倒游；当δV大于0，表示机器鱼前游；δV的绝对值越大，速度绝对值越大。kRI为振幅系数，kT为周期系数，T0为机器鱼胸鳍摆动周期。游动速度与速度参数δV近似线性正比关系。此外，转弯速度与速度参数δV相关，当δY不变时，δV越大，拍动振幅RI和频率ν更大，单侧胸鳍产生的推力更大，从而两侧胸鳍推力形成的转弯扭矩更大。此外，转弯速度与航向参数δY近似线性关系。理想条件下，通过输入简单的速度、航向角和深度等指令，机器鱼便可以按照该指令实现稳定的游动状态。由于胸鳍拍动仿生鱼类的水动力模型研究还处于极不成熟的阶段，因此本发明采用模糊控制策略实现航向和速度的定量控制，模糊控制鲁棒性强，对非线性系统具有较强的适应性，在无法获得控制对象精确数学模型的情况下，依然能够达到较好的控制效果。模糊闭环控制如图6所示，传感器反馈回实际航向，控制指令中心确定期望航向，二者之差作为航向模糊控制器的偏差输入，通过模糊控制器进行查表运算，生成航向参数δY的值，再将δY转换为期望相位差作为CPG网络的参数输入，经CPG网络生成控制舵机的PWM信号。速度模糊闭环控制原理与航向类似，故不在赘述。步骤五，将胸鳍拍动式机器鱼编队的动力学方程转化为积分器动态模型，根据有向切换通信拓扑的虚拟领导者-跟随者编队跟踪算法，设计多胸鳍拍动式机器鱼在有向固定拓扑条件下的编队跟踪控制协议；所述的有向切换通信拓扑的虚拟领导者-跟随者编队跟踪算法，具体设计流程如下：步骤501，建立虚拟领导者-跟随者的系统模型，设计虚拟领导者与各跟随者之间的通信作用拓扑图，满足虚拟领导者与跟随者之间为单向通信，且所有跟随者与虚拟领导者之间都有一条以虚拟领导者为根节点的有向通信路径，即对于每个跟随者，存在一棵以虚拟领导者为根节点的生成树。所述的系统模型设计为两层架构，包含一个虚拟领导者和N个跟随者。虚拟领导者的状态模型可根据实际任务需求进行设计，可表示为：其中表示虚拟领导者的状态，/＞表示虚拟领导者的输入。各跟随者的模型表示为其中表示跟随者集合，/＞表示跟随者i对应的状态，表示跟随者i对应的控制输入。/＞和/＞表示系统矩阵，且B为列满秩矩阵，即rank＝m；则由矩阵理论知识可得到：存在一个非奇异矩阵/＞满足/＞其中/＞步骤502，设计不同拓扑切换的通信作用拓扑图，使切换的通信拓扑均包含有向生成树，编队队形在拓扑切换时刻重新组成目标编队进行运动。在机器鱼编队跟踪控制过程中，个体之间的通信拓扑是随时间变化的，即切换拓扑。令切换拓扑集合为p≥1表示所有的有向通信拓扑图集合。定义切换拓扑关系信号指数为σ，其中/＞定义t0＝0为初始时刻，0＝t0＜t1＜t2＜…＜tp表示切换拓扑关系信号指数的切换时刻。/＞为t时刻的拓扑图。整个系统的通信拓扑关系在时间区间根据虚拟领导者和跟随者的通信拓扑关系，虚拟领导者不接收来自跟随者的状态信息，因此，虚拟领导者-跟随者编队跟踪系统的拉普拉斯矩阵为：其中表示t时刻跟随者内部之间的通信拓扑关系，/＞表示虚拟领导者与跟随者之间的通信拓扑关系。步骤503，为跟随者设计编队参考函数，并判断其是否满足编队可行性条件，若是，则执行步骤504；否则，则重新选取跟随者的编队参考函数，直至满足编队可行性条件；跟随者的编队参考函数为为第i个跟随者的期望编队。编队可行性条件为：其中步骤504，基于编队可行性条件，对编队跟踪算法相关的参数进行求解，具体包括：存在一个非奇异矩阵满足/＞/＞计算/＞和/＞选定κ＞0，求解下述线性矩阵不等式，得到可行解P＞0；ATP+PA-αPBBTP+κP＜0选择α＞0，使其满足通过计算正定对称矩阵Qσ；对于非奇异M矩阵存在一个正定对称矩阵Qσ和一个正标量参数α，使得下述不等式成立：其中，证明：由于可得因此，存在一个正定对称矩阵Qσ使得即证明完毕。通过K＝-BTP，计算常数增益矩阵选择切换拓扑的最小驻留时间τ0满足lnh0-κτ0＜0。其中步骤505，基于编队跟踪算法的相关参数，得到编队跟踪控制协议；如果跟随者实现对虚拟领导者的编队跟踪，则有下式成立进一步地，可以表示为其中虚拟领导者到每个跟随者都存在一条有向路径矩阵，即领导者作为作用拓扑图的根节点，则的所有特征值均具有正实部，/＞的每个元素均非负并且所有行和均等于1，即/＞显然，/＞为非奇异M矩阵。/＞对每个跟随者，令εi＝xi-hi-xN+1，其中i＝1,2,…,N。对虚拟领导者，定义dN+1＝0，εN+1＝0。令可得则可知式等价于设计状态反馈的编队跟踪控制协议为：其中为常数增益矩阵，/＞是由编队参考函数h决定的外部指令信号。下面采用Lyapunov直接法证明编队跟踪控制协议的稳定性。证明：将控制协议代入式中，可得由εi＝xi-hi-xN+1，根据式可得将式带入式，可得到由则由为非奇异矩阵和编队可行性条件，可得/＞因此，式可写为由为非奇异矩阵和/＞式左右同时乘上/＞可得令由式和式可得构造如下Lyapunov函数其中t∈式中的V按t求导可得由式和K＝-BTP，结合式可得由式可知，显然，切换拓扑在时刻t＝tj处切换，则有其中进一步，可以得到进行递归运算，可得因为t-t0＝t-tj++…+≥t-tj+jτ0，所以注意到lnh0-κτ0＜0，所以因而可得/＞根据定义可知，该虚拟领导者-跟随者编队跟踪系统实现了拓扑切换情况下的编队跟踪控制。步骤六，基于编队跟踪控制协议得到各胸鳍拍动式机器鱼的运动控制方程，并结合单个机器鱼的运动学方程，使得跟随者机器鱼按照设计的编队队形跟随虚拟领导者轨迹进行编队跟踪运动，实现多胸鳍拍动式机器鱼场景的编队切换控制。胸鳍拍动式机器鱼的运动控制方程的具体计算过程为：将胸鳍拍动式机器鱼的游动环境简化为理想条件，建立机器鱼在二阶积分器形式的下的动态模型为：其中，γi和τi分别表示第i个机器鱼在二维平面下坐标系中的位置信息，θi表示第i个机器鱼在二维平面下的航向信息，ωi表示转动角速度。将速度积分控制模型表示为：其中ui为编队跟踪控制算法对应的控制输入。进一步，将速度控制项表示为：其中，qi为中间变量。基于反馈线性化方法设计控制律为：则，单个机器鱼的编队控制算法非线性动力学方程可线性化为：其中，ξi＝T，ui＝T。矩阵A、B表示如下：如图7所示，将动力学方程与步骤二中的运动学方程相结合，则可实现胸鳍拍动式机器鱼运动过程中的编队队形控制。实施例如图3和图4所示，本实施例以6个胸鳍拍动式机器鱼为例，对其运动过程中的切换拓扑编队队形进行设计，机器鱼的队形从三角形变换为六边形，在此过程中，将机器鱼的期望编队设置为相距虚拟领导者的相对位置，其值如下：编队队形与通信拓扑切换/＞对应的通信拓扑拉普拉斯矩阵为：编队队形与通信拓扑切换对应的通信拓扑拉普拉斯矩阵为：初始位置选择为：仿真结果表示：图8表示胸鳍拍动式机器鱼初始时刻的位置分布和有向通信作用拓扑，虚线圆圈为第一种队形对应的理论位置编队分布；图9为胸鳍拍动式机器鱼在编队运动过程中逐渐生成理论三角形编队队形；图10为胸鳍拍动式机器鱼编队达到预期三角形编队队形，并保持该队形运动；图11为胸鳍拍动式机器鱼编队第一种三角形编队队形切换为六边形编队队形，虚线圆圈为设定的理论编队队形的位置分布；图12为胸鳍拍动式机器鱼切换为六边形编队队形和相应的有向通信作用拓扑，在此过程中进行队形生成；图13表示胸鳍拍动式机器鱼编队达到预期六边形编队队形，并进行编队保持运动；图14为胸鳍拍动式机器鱼编队在跟随虚拟领导者运动过程中的运动轨迹曲线；图15表示六个跟随者机器鱼在形成编队过程中距离期望编队的位置偏差的变化，从图中可以看出中途时刻实际位置与理论位置偏差存在一个突变，这是因为该时刻为三角形队形向六边形队形的切换时刻，后续位置偏差逐渐收敛，机器鱼实现理论编队队形。仿真结果表明，胸鳍拍动式机器鱼编队队形收敛速度较好，形成稳定的编队队形的速度较快，具有很好的队形完成度，同时对于编队队形切换的情况，在一定的实际内可以达到新的编队队形，控制器具有很好的稳定性，胸鳍拍动式机器鱼编队中的个体能够收敛到期望的目标队形位置。本发明提出了一种有向通信切换作用拓扑条件下基于虚拟领导者-跟随者的编队队形切换控制算法，利用Lyapunov函数以及矩阵论知识数学方法证明，得出了使多胸鳍拍动式机器鱼编队系统实现不同编队切换的充分条件，并采用matlab仿真验证了编队算法的有效性和稳定性。
