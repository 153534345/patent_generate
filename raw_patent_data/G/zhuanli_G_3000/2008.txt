标题title
一种地震数据重建方法
摘要abst
本发明公开一种地震数据重建方法，属于地球物理技术领域，用于对地震数据进行重建，包括：构建训练集、验证集和数据集，构建扩散模型神经网络，使用流行约束梯度方法进行地震数据重建；将训练集中的地震数据输入构建好的扩散模型神经网络中，同时计算误差，如果误差大于设置的阈值，反向传播更新参数，反复迭代直至误差小于设置的阈值，停止更新参数并保存网络参数。本发明更有效地利用数据的局部信息和全局信息学习训练集的数据分布，重建后的地震数据语义、纹理更加和谐，重建质量更高。
权利要求书clms
1.一种地震数据重建方法，其特征在于，包括：S1.构建训练集、验证集和数据集；验证集和训练集的构建方法为：从地震数据中截取多块具有相同维度的地震数据块，每块地震数据块的行数为h、列数为w，h和w大于256，验证集和训练集所截取的地震数据块数值不同，测试集为地震数据中除训练集和验证集之外的数据块；S2.构建扩散模型神经网络，扩散模型神经网络的主干网络为U-Net，U-Net的解码器部分包含多个解码器模块，所述解码器模块包含两个并联的模块：局部特征提取模块和全局特征提取模块；其中一个解码器模块有一个输入路径，其局部特征提取模块没有上采样分支，仅对唯一的输入特征图进行特征提取，其他解码器模块都有两个输入；S3.将训练集中的地震数据输入S2构建好的扩散模型神经网络中，扩散模型神经网络的输出为给定方差后加噪的地震数据，把经过扩散神经网络加噪后的地震数据的分数与直接加噪后的地震数据的分数进行比对，同时计算二者的误差，如果误差大于设置的阈值，反向传播更新参数，反复迭代直至误差小于设置的阈值，停止更新参数并保存网络参数；S4.将验证集中的地震数据输入S2构建好的扩散模型神经网络中，网络的输出为网络重建后的地震数据，将重建后的地震数据和完整地震数据进行误差计算，如果误差大于设置的阈值，返回S4，如果误差小于设置的阈值，执行S6；S5.把测试集中的缺损地震数据输入S2构建好的扩散模型神经网络中，使用流行约束梯度方法进行地震数据重建，网络的输出为扩散模型神经网络重建后的地震数据。2.根据权利要求1所述的一种地震数据重建方法，其特征在于，扩散模型神经网络中，地震数据为x，与地震数据对应的连续可微的概率密度为，称/＞为地震数据的分数，给定步长/＞、迭代总数/＞和来自任意先验分布/＞的初始样本/＞，朗之万动力学迭代采样过程为：；其中、/＞为第/＞轮迭代的地震数据， /＞表示中间变量，/＞为公式中的分数函数；扩散模型神经网络通过损失函数为：；进行分数估计，其中代表训练过程第i轮加噪的噪声水平，/＞代表噪声序列的长度，噪声序列/＞满足/＞，/＞代表向地震数据加入噪声水平为/＞的噪声，/＞代表向地震数据分布/＞加入噪声，则表示相应的扰动数据分布/＞为：。3.根据权利要求2所述的一种地震数据重建方法，其特征在于，局部特征提取模块包括： 局部特征提取模块中，首先对低分辨率特征图进行卷积和上采样操作，然后与高分辨率特征图进行融合，融合之后的特征图通过残差卷积模块进行局部特征提取，每个残差卷积模块由两组卷积和ReLU激活函数组成；全局特征提取模块中，高分辨率特征图经过两个快速傅里叶卷积残差块进行全局特征提取，之后与经过上采样的低分辨率输入进行融合形成融合特征图。4.根据权利要求3所述的一种地震数据重建方法，其特征在于，融合特征图分出三个分支，每个分支分别进行一次单独的卷积、深度可分离卷积后得到Q、K、V，Q、K、V是来自融合特征图的三个映射矩阵，K、Q首先在自注意力模块中进行点积运算，得到注意力特征图，然后将注意力特征图再与V进行一次点积运算和卷积运算得到特征提取后的特征图，最后将融合特征图与特征提取后的特征图进行相加，再次经过一个快速傅里叶卷积残差块输出，快速傅里叶卷积残差块对多路径融合的特征图采用非线性运算来生成用于进一步处理或用于最终预测的特征。5.根据权利要求4所述的一种地震数据重建方法，其特征在于，神经网络中的卷积块替换为快速傅里叶卷积块，快速傅里叶卷积块包含两个并联的分支，分别为局部分支和全局分支，当数据融合特征图X进入快速傅里叶卷积块时，按照通道维度分为两部分，其中/＞为数据输入到局部分支的部分，/＞为数据输入到全局分支的部分；全局分支数据为，局部分支数据为/＞，/＞代表特征通道数分配给局部分支和全局分支的比例，X的通道数为C、行数为H、列数为W，局部分支/＞包含两个并联的/＞卷积层，分别称为局部与局部分支/＞和局部与全局分支/＞，全局分支/＞包含并联的一个信号变换器与一个/＞卷积层，分别称为全局与全局分支/＞与全局与局部分支/＞。6.根据权利要求5所述的一种地震数据重建方法，其特征在于，快速傅里叶卷积块的更新过程为：；式中，分别代表对不同分支输入数据的操作，/＞为普通卷积操作，/＞为信号变换操作。7.根据权利要求6所述的一种地震数据重建方法，其特征在于，信号变换器中，开始时进行通道缩减，使用卷积将数据的通道数减半，在最后使用通道恢复，用另一个1×1卷积来重建特征通道维度，我们称这两个卷积操作分别为通道缩减与通道恢复；在这通道缩减与通道恢复之间，有一个具有全局感受野的傅里叶单元FU，一个用于捕获半全局信息并在四分之一的特征通道上操作的局部傅里叶单元LFU，以及一个残差连接。8.根据权利要求7所述的一种地震数据重建方法，其特征在于，傅里叶单元将输入数据的空间特征转换到谱域，对谱数据进行有效提取后再将数据转换回空间格式；当输入到傅里叶单元的张量为实数张量时，其结果是共轭对称的，此时只保留一半的结果，并通过使用共轭对称性简单地重建另一半，将虚部和实部沿通道维度进行拼接，然后在傅里叶单元中进行1x1卷积、归一化和ReLU激活，通过沿着通道维度将结果分解为实数部分和虚数部分并将结果转换回复数。9.根据权利要求8所述的一种地震数据重建方法，其特征在于，局部傅里叶单元提取全局信息中的局部信息，局部傅里叶单元含有额外的拆分和连接步骤，局部傅里叶单元对输入的特征图进行拆分，将特征图的长和宽减半，分成四个较小的特征图，将傅里叶单元应用于拆分后的特征图。10.根据权利要求9所述的一种地震数据重建方法，其特征在于，流形约束梯度方法包含：B1.将迭代中的地震数据通过神经网络，依照朗之万动力学进行一次采样，得到中间结果/＞，根据迭代中的地震数据/＞对最终的结果/＞进行预测，预测公式为：；式中，为采样过程中迭代的地震数据，/＞为第i-1轮的水平的噪声，/＞为的分数，/＞为根据/＞预测出的最终重建结果；B2.根据流形约束梯度方法对进行进一步的处理，计算流形约束梯度/＞：；B3.将缺损地震数据加入对应迭代步骤水平的噪声：；式中为缺损地震数据，/＞为第i轮的水平的噪声；对中间结果与加噪后的缺损地震数据进行计算得重建地震数据/＞：；式中为单位矩阵，/＞，代表大小为/＞的标志缺损数据缺损区域的掩膜矩阵，数值为0的部分标志着数据的缺损部分，数值为1的部分标志着数据的未缺损部分。
说明书desc
技术领域本发明公开一种地震数据重建方法，属于地球物理技术领域。背景技术地震数据插值是对地震数据中缺失数据进行重建的方法，在考虑到地震数据结构特点的基础上，利用算法将缺失数据恢复，从而填补缺失值，使数据的分辨率得到提高。在野外勘探中，常常出现由于地形、设备、天气等原因导致部分位置的地震记录无法采集的情况，这就需要用插值方法来补全这些空缺。传统的地震数据插值方法大致可以分为三类：基于波动方程的插值算法，基于信号处理的插值算法和基于地震数据处理的插值方法。它们基于某种预先建立的模型，需要根据数据集估计参数。但这种模型对于现场数据而言往往是不恰当的，而且估计参数需要大量的人机交互，尤其是对于大量的数据而言其自动化程度较低。发明内容本发明的目的在于提供一种地震数据重建方法，以解决现有技术中，地震数据重建方法没有充分挖掘和利用地震数据的局部信息和全局信息，重建效果不佳的问题。一种地震数据重建方法，包括：S1.构建训练集、验证集和数据集；验证集和训练集的构建方法为：从地震数据中截取多块具有相同维度的地震数据块，每块地震数据块的行数为h、列数为w，h和w大于256，验证集和训练集所截取的地震数据块数值不同，测试集为地震数据中除训练集和验证集之外的数据块；S2.构建扩散模型神经网络，扩散模型神经网络的主干网络为U-Net，U-Net的解码器部分包含多个解码器模块，所述解码器模块包含两个并联的模块：局部特征提取模块和全局特征提取模块；其中一个解码器模块有一个输入路径，其局部特征提取模块没有上采样分支，仅对唯一的输入特征图进行特征提取，其他解码器模块都有两个输入；S3.将训练集中的地震数据输入S2构建好的扩散模型神经网络中，扩散模型神经网络的输出为给定方差后加噪的地震数据，把经过扩散神经网络加噪后的地震数据的分数与直接加噪后的地震数据的分数进行比对，同时计算二者的误差，如果误差大于设置的阈值，反向传播更新参数，反复迭代直至误差小于设置的阈值，停止更新参数并保存网络参数；S4.将验证集中的地震数据输入S2构建好的扩散模型神经网络中，网络的输出为网络重建后的地震数据，将重建后的地震数据和完整地震数据进行误差计算，如果误差大于设置的阈值，返回S4，如果误差小于设置的阈值，执行S6；S5.把测试集中的缺损地震数据输入S2构建好的扩散模型神经网络中，使用流行约束梯度方法进行地震数据重建，网络的输出为扩散模型神经网络重建后的地震数据。扩散模型神经网络中，地震数据为x，与地震数据对应的连续可微的概率密度为，称/＞为地震数据的分数，给定步长/＞、迭代总数/＞和来自任意先验分布/＞的初始样本/＞，朗之万动力学迭代采样过程为：；其中、/＞为第/＞轮迭代的地震数据， /＞表示中间变量，/＞为公式中的分数函数；扩散模型神经网络通过损失函数为：；进行分数估计，其中代表训练过程第i轮加噪的噪声水平，/＞代表噪声序列的长度，噪声序列/＞满足/＞，/＞代表向地震数据加入噪声水平为的噪声，/＞代表向地震数据分布/＞加入噪声，则表示相应的扰动数据分布/＞为：。局部特征提取模块包括： 局部特征提取模块中，首先对低分辨率特征图进行卷积和上采样操作，然后与高分辨率特征图进行融合，融合之后的特征图通过残差卷积模块进行局部特征提取，每个残差卷积模块由两组卷积和ReLU激活函数组成；全局特征提取模块中，高分辨率特征图经过两个快速傅里叶卷积残差块进行全局特征提取，之后与经过上采样的低分辨率输入进行融合形成融合特征图。融合特征图分出三个分支，每个分支分别进行一次单独的卷积、深度可分离卷积后得到Q、K、V，Q、K、V是来自融合特征图的三个映射矩阵，K、Q首先在自注意力模块中进行点积运算，得到注意力特征图，然后将注意力特征图再与V进行一次点积运算和卷积运算得到特征提取后的特征图，最后将融合特征图与特征提取后的特征图进行相加，再次经过一个快速傅里叶卷积残差块输出，快速傅里叶卷积残差块对多路径融合的特征图采用非线性运算来生成用于进一步处理或用于最终预测的特征。神经网络中的卷积块替换为快速傅里叶卷积块，快速傅里叶卷积块包含两个并联的分支，分别为局部分支和全局分支，当数据融合特征图X进入快速傅里叶卷积块时，按照通道维度分为两部分，其中/＞为数据输入到局部分支的部分，/＞为数据输入到全局分支的部分；全局分支数据为，局部分支数据为/＞，/＞代表特征通道数分配给局部分支和全局分支的比例，X的通道数为C、行数为H、列数为W，局部分支/＞包含两个并联的/＞卷积层，分别称为局部与局部分支/＞和局部与全局分支/＞，全局分支/＞包含并联的一个信号变换器与一个/＞卷积层，分别称为全局与全局分支/＞与全局与局部分支/＞。快速傅里叶卷积块的更新过程为：；式中，分别代表对不同分支输入数据的操作，/＞为普通卷积操作，/＞为信号变换操作。信号变换器中，开始时进行通道缩减，使用卷积将数据的通道数减半，在最后使用通道恢复，用另一个1×1卷积来重建特征通道维度，我们称这两个卷积操作分别为通道缩减与通道恢复；在这通道缩减与通道恢复之间，有一个具有全局感受野的傅里叶单元FU，一个用于捕获半全局信息并在四分之一的特征通道上操作的局部傅里叶单元LFU，以及一个残差连接。傅里叶单元将输入数据的空间特征转换到谱域，对谱数据进行有效提取后再将数据转换回空间格式；当输入到傅里叶单元的张量为实数张量时，其结果是共轭对称的，此时只保留一半的结果，并通过使用共轭对称性简单地重建另一半，将虚部和实部沿通道维度进行拼接，然后在傅里叶单元中进行1x1卷积、归一化和ReLU激活，通过沿着通道维度将结果分解为实数部分和虚数部分并将结果转换回复数。局部傅里叶单元提取全局信息中的局部信息，局部傅里叶单元含有额外的拆分和连接步骤，局部傅里叶单元对输入的特征图进行拆分，将特征图的长和宽减半，分成四个较小的特征图，将傅里叶单元应用于拆分后的特征图。流形约束梯度方法包含：B1.将迭代中的地震数据通过神经网络，依照朗之万动力学进行一次采样，得到中间结果/＞，根据迭代中的地震数据/＞对最终的结果/＞进行预测，预测公式为：；式中，为采样过程中迭代的地震数据，/＞为第i-1轮的水平的噪声，为/＞的分数，/＞为根据/＞预测出的最终重建结果；B2.根据流形约束梯度方法对进行进一步的处理，计算流形约束梯度/＞：；B3.将缺损地震数据加入对应迭代步骤水平的噪声：；式中为缺损地震数据，/＞为第i轮的水平的噪声；对中间结果与加噪后的缺损地震数据进行计算得重建地震数据/＞：；式中为单位矩阵，/＞，代表大小为/＞的标志缺损数据缺损区域的掩膜矩阵，数值为0的部分标志着数据的缺损部分，数值为1的部分标志着数据的未缺损部分。相对比现有技术，本发明具有以下有益效果：本发明更有效地利用数据的局部信息和全局信息学习训练集的数据分布，重建后的地震数据语义、纹理更加和谐，重建质量更高。附图说明图1为信号变换器结构图；图2为傅里叶单元结构图；图3为快速傅里叶卷积残差块结构图；图4为地震数据重建总体流程图；图5为训练步骤流程图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。一种地震数据重建方法，包括：S1.构建训练集、验证集和数据集；验证集和训练集的构建方法为：从地震数据中截取多块具有相同维度的地震数据块，每块地震数据块的行数为h、列数为w，h和w大于256，验证集和训练集所截取的地震数据块数值不同，测试集为地震数据中除训练集和验证集之外的数据块；S2.构建扩散模型神经网络，扩散模型神经网络的主干网络为U-Net，U-Net的解码器部分包含多个解码器模块，所述解码器模块包含两个并联的模块：局部特征提取模块和全局特征提取模块；其中一个解码器模块有一个输入路径，其局部特征提取模块没有上采样分支，仅对唯一的输入特征图进行特征提取，其他解码器模块都有两个输入；S3.将训练集中的地震数据输入S2构建好的扩散模型神经网络中，扩散模型神经网络的输出为给定方差后加噪的地震数据，把经过扩散神经网络加噪后的地震数据的分数与直接加噪后的地震数据的分数进行比对，同时计算二者的误差，如果误差大于设置的阈值，反向传播更新参数，反复迭代直至误差小于设置的阈值，停止更新参数并保存网络参数；S4.将验证集中的地震数据输入S2构建好的扩散模型神经网络中，网络的输出为网络重建后的地震数据，将重建后的地震数据和完整地震数据进行误差计算，如果误差大于设置的阈值，返回S4，如果误差小于设置的阈值，执行S6；S5.把测试集中的缺损地震数据输入S2构建好的扩散模型神经网络中，使用流行约束梯度方法进行地震数据重建，网络的输出为扩散模型神经网络重建后的地震数据。扩散模型神经网络中，地震数据为x，与地震数据对应的连续可微的概率密度为，称/＞为地震数据的分数，给定步长/＞、迭代总数/＞和来自任意先验分布/＞的初始样本/＞，朗之万动力学迭代采样过程为：；其中、/＞为第/＞轮迭代的地震数据， /＞表示中间变量，/＞为公式中的分数函数；扩散模型神经网络通过损失函数为：；进行分数估计，其中代表训练过程第i轮加噪的噪声水平，/＞代表噪声序列的长度，噪声序列/＞满足/＞，/＞代表向地震数据加入噪声水平为/＞的噪声，/＞代表向地震数据分布/＞加入噪声，则表示相应的扰动数据分布/＞为：。局部特征提取模块包括： 局部特征提取模块中，首先对低分辨率特征图进行卷积和上采样操作，然后与高分辨率特征图进行融合，融合之后的特征图通过残差卷积模块进行局部特征提取，每个残差卷积模块由两组卷积和ReLU激活函数组成；全局特征提取模块中，高分辨率特征图经过两个快速傅里叶卷积残差块进行全局特征提取，之后与经过上采样的低分辨率输入进行融合形成融合特征图。融合特征图分出三个分支，每个分支分别进行一次单独的卷积、深度可分离卷积后得到Q、K、V，Q、K、V是来自融合特征图的三个映射矩阵，K、Q首先在自注意力模块中进行点积运算，得到注意力特征图，然后将注意力特征图再与V进行一次点积运算和卷积运算得到特征提取后的特征图，最后将融合特征图与特征提取后的特征图进行相加，再次经过一个快速傅里叶卷积残差块输出，快速傅里叶卷积残差块对多路径融合的特征图采用非线性运算来生成用于进一步处理或用于最终预测的特征。神经网络中的卷积块替换为快速傅里叶卷积块，快速傅里叶卷积块包含两个并联的分支，分别为局部分支和全局分支，当数据融合特征图X进入快速傅里叶卷积块时，按照通道维度分为两部分，其中/＞为数据输入到局部分支的部分，/＞为数据输入到全局分支的部分；全局分支数据为，局部分支数据为/＞，/＞代表特征通道数分配给局部分支和全局分支的比例，X的通道数为C、行数为H、列数为W，局部分支/＞包含两个并联的/＞卷积层，分别称为局部与局部分支/＞和局部与全局分支/＞，全局分支/＞包含并联的一个信号变换器与一个/＞卷积层，分别称为全局与全局分支/＞与全局与局部分支/＞。快速傅里叶卷积块的更新过程为：；式中，分别代表对不同分支输入数据的操作，/＞为普通卷积操作，/＞为信号变换操作。信号变换器中，开始时进行通道缩减，使用卷积将数据的通道数减半，在最后使用通道恢复，用另一个1×1卷积来重建特征通道维度，我们称这两个卷积操作分别为通道缩减与通道恢复；在这通道缩减与通道恢复之间，有一个具有全局感受野的傅里叶单元FU，一个用于捕获半全局信息并在四分之一的特征通道上操作的局部傅里叶单元LFU，以及一个残差连接。傅里叶单元将输入数据的空间特征转换到谱域，对谱数据进行有效提取后再将数据转换回空间格式；当输入到傅里叶单元的张量为实数张量时，其结果是共轭对称的，此时只保留一半的结果，并通过使用共轭对称性简单地重建另一半，将虚部和实部沿通道维度进行拼接，然后在傅里叶单元中进行1x1卷积、归一化和ReLU激活，通过沿着通道维度将结果分解为实数部分和虚数部分并将结果转换回复数。局部傅里叶单元提取全局信息中的局部信息，局部傅里叶单元含有额外的拆分和连接步骤，局部傅里叶单元对输入的特征图进行拆分，将特征图的长和宽减半，分成四个较小的特征图，将傅里叶单元应用于拆分后的特征图。流形约束梯度方法包含：B1.将迭代中的地震数据通过神经网络，依照朗之万动力学进行一次采样，得到中间结果/＞，根据迭代中的地震数据/＞对最终的结果/＞进行预测，预测公式为：；式中，为采样过程中迭代的地震数据，/＞为第i-1轮的水平的噪声，为/＞的分数，/＞为根据/＞预测出的最终重建结果；B2.根据流形约束梯度方法对进行进一步的处理，计算流形约束梯度/＞：；B3.将缺损地震数据加入对应迭代步骤水平的噪声：；式中为缺损地震数据，/＞为第i轮的水平的噪声；对中间结果与加噪后的缺损地震数据进行计算得重建地震数据/＞：；式中为单位矩阵，/＞，代表大小为/＞的标志缺损数据缺损区域的掩膜矩阵，数值为0的部分标志着数据的缺损部分，数值为1的部分标志着数据的未缺损部分。近年来，随着深度学习的发展，基于卷积神经网络的插值方法也受到了广泛关注。这种方法能够自动学习数据的特征和规律，不需要预先建立模型或手动调整参数，深度学习技术通过构建神经网络进行低层特征组合，通过网络训练对数据进行不同阶段的特征提取逐渐形成更加抽象的高层特征，运用提取得到的高层特征进行地震数据插值，从而使插值结果更加真实可靠。扩散模型是一种在计算机视觉领域中新兴的生成模型，核心思想是使用神经网络学习图像的梯度信息来估计训练集的数据分布，然后通过朗之万动力学逐步从噪声中生成服从于该数据分布的新样本。扩散模型不仅可以生成新的样本，同样可以应用在图像超分辨率、图像修复等任务中。在图像修复任务中，具体而言，我们可以将缺损图像作为约束条件，融入到扩散模型随机采样生成的噪声中。在迭代过程中，通过在缺损图像上逐级加入从大到小的噪声，神经网络会根据训练集中学习到的梯度信息，逐步在缺损部分生成新的信息。当最后一级噪声趋近于无穷小，图像重建完成。扩散模型可以通过偏微分方程来描述图像中噪声的扩散和传播过程，利用图像中已有的纹理等先验信息来对缺失区域进行重建，从而提高图像的视觉质量和感知效果。流形约束梯度方法是一种优化扩散模型重建图像的方法。数据流形是拓扑空间中的概念，用来描述数据在高维空间中的分布和结构。扩散模型在对缺损图像进行重建的过程中，尽管可以有效利用图像的纹理等先验信息，但是，随着图像语义复杂程度的增加，重建图像修复区域与相邻区域的语义可能会出现一定程度的不匹配。出现这种问题的原因是，扩散模型的采样方法逐步进行反向扩散的过程会使样本采样路径偏离数据流形，从而导致误差累积，重建图像修复区域与相邻区域的语义出现不和谐。流形约束方法的关键思想在于引入额外的修正项，通过将这种约束融入到现有方法中，可以使迭代过程更加接近数据流形。如果分数函数是全局最优的，流形约束梯度的修正项就会使样本路径保持在数据流形的切平面上，从而提高重建图像采样过程的稳定性和准确性。快速傅里叶卷积是一种新型卷积算子，具有非局部感受野和跨尺度融合的特点。传统卷积操作局限于固定尺度和局部感受野，难以使神经网络中两个较远位置的信息得到关联。快速傅里叶卷积是根据傅里叶理论中的谱卷积定理：谱域中的逐点更新会全局影响所有参与傅里叶变换的输入特征而设计的新型神经网络卷积模块。快速傅里叶卷积会将三种不同的计算方式集成到单个卷积模块中：局部分支用于进行普通的小卷积核卷积，半全局分支处理完整图像四分之一大小图像块的谱信息，全局分支处理完整图像的谱信息。不同分支分别处理不同尺度的特征，之后进行融合。快速傅里叶卷积是一个通用的卷积模块，可以直接替换现有网络中的传统卷积操作，无需任何调整，并且复杂度指标相当。本发明将扩散模型、快速傅里叶卷积和流形约束梯度方法相结合，利用扩散模型学习数据的梯度分布，使用局部特征提取模块和全局特征提取模块分别提取数据的局部信息和全局信息，在全局特征提取模块中加入快速傅里叶卷积，加强扩散模型神经网络提取数据全局信息的能力，之后融合这两种信息用于地震数据重建，以提升对地震数据的重建性能。最后在数据重建过程中结合流形约束梯度方法，优化扩散模型重建地震数据的语义。相对于其他方法，可以通过更有效地利用数据的局部信息和全局信息学习训练集的数据分布，重建后的地震数据语义、纹理更加和谐，重建质量更高。在全局特征提取模块中，部分传统卷积被替换为快速傅里叶卷积，通过处理数据的频域信息实现对全局特征的有效提取。信号变换器结构如图1所示，信号变换器的目标是以有效的方式将卷积的感受野扩大到整张输入特征图。傅里叶单元结构如图2所示，傅里叶单元目的是将输入数据的空间特征转换到谱域，对谱数据进行有效提取后再将数据转换回空间格式。由于傅里叶变换处理的数据类型为复数，因此需要确保傅里叶单元的输入和输出都是实数，这样快速傅里叶卷积才能与神经网络的其他模块兼容。当将二维快速傅里叶变换应用于实际信号时，会产生完全共轭对称的埃尔米特矩阵，在埃尔米特矩阵上应用逆二维傅里叶运算会产生只有实元素的矩阵。傅里叶变换的这种特性可以用来确保与其他神经层的兼容性。局部傅里叶单元的作用是提取全局信息中的局部信息。局部傅里叶单元与傅里叶单元的区别在于局部傅里叶单元含有额外的拆分和连接步骤，局部傅里叶单元会对输入的特征图进行拆分，将特征图的长和宽减半，分成四个较小的特征图。然后将傅里叶单元应用于拆分后的特征图。快速傅里叶卷积残差块结构如图3所示。本发明中，地震数据重建总体流程如图4所示，训练集的训练步骤流程如图5所示。流行约束梯度方法是一种采样过程中优化扩散模型重建地震数据的方法，通过引入额外的修正项，将这种约束融入到现有方法中，可以使迭代过程中的数据更加接近数据流形，从而提高重建地震数据采样过程的稳定性和准确性。以上实施例仅用于说明本发明的技术方案，而非对其限制，尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换，而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围。
