标题title
一种数控机床加工时间预测方法
摘要abst
本发明公开了一种数控机床加工时间预测方法，针对采集的数据的特征，利用相关分析方法剔除特征间的相关性过高的特征；然后，通过主成分分析对训练集的数据样本的高维输入特征降维，对采集到数据的特征进行主成分分析，按一定比例剔除贡献率较低的特征。将数据集划分为训练集、验证集和测试集，利用GBRT梯度提升回归树算法基于训练集对数控加工时间预测模型进行训练，在训练过程中使用验证集对模型的参数进行调优，通过测试集对模型性能进行评估，得到最终的预测模型，用于预测数控机床加工时间。本发明利用机器学习算法对数控加工时间进行了高准确的预测，为排产提供了可靠的依据，实现了精准排产，具有较好的实用性。
权利要求书clms
1.一种数控机床加工时间预测方法，其特征在于，包括以下步骤：步骤S100：数据采集：采集零件数模加工特征、加工参数、机床信息、环境信息、理论的数控加工总时间以及真实的数控加工总时间的工况信息数据，并形成数据集；将采集到的所有数据进行清洗、标准化，填充空白值、剔除异常值，建立数控加工时间预测模型；步骤S200：针对采集的数据的特征，利用相关分析方法剔除特征间的相关性过高的特征，保证模型的泛化性能；然后，通过主成分分析对训练集的数据样本的高维输入特征降维，对采集到数据的特征进行主成分分析，计算主成分贡献率及累计贡献率，剔除贡献率低于阈值的特征；步骤S300：将数据集划分为训练集、验证集和测试集；利用GBRT梯度提升回归树算法基于训练集对数控加工时间预测模型进行训练，在训练过程中使用验证集对模型的参数进行调优，通过测试集对模型性能进行评估，得到最终的预测模型；步骤S400：采集待加工零件的零件特征信息、加工参数、机床信息、环境信息以及计算得到的数控加工总时间，并输入步骤S300中得到的预测模型，预测得到零件数控加工时间。2.根据权利要求1所述的一种数控机床加工时间预测方法，其特征在于，所述步骤S100包括以下步骤：步骤S110：利用软件对零件数模进行分析，根据加工特征将其分为N种特征类型，即零件数模加工特征；步骤S120：根据特征类型将NC程序进行分段，并从NC指令中获取每个程序段的转速、进给、切深、切宽的加工参数；步骤S130：根据NC程序段和加工参数计算每个程序段的理想加工时间，计算得到理论的数控加工总时间；步骤S140：根据机床采集的DNC数据中获取每个程序段的真实加工时间，计算得到真实的数控加工总时间；步骤S150：获取机床信息和环境信息，并采集步骤S110-步骤S140中的工况信息数据，形成数据集。3.根据权利要求2所述的一种数控机床加工时间预测方法，其特征在于，所述步骤S100中，所述零件数模加工特征包括腹板、筋条、缘条转角、孔的特征；所述机床信息包括主轴类型、设备类型、设备型号，所述主轴类型包括机械主轴、电主轴；所述环境信息包括温度、湿度、振动。4.根据权利要求1所述的一种数控机床加工时间预测方法，其特征在于，所述步骤S100中，对数据中缺失的特征值采用K最近距离法进行填补，进一步对数据进行转换，采用直线法实现统一数据量纲和数量级：最大值化：最小值化：逆向化：其中，xi为第i个数据x，max为最大值数据x，min为最小值数据x。5.根据权利要求1所述的一种数控机床加工时间预测方法，其特征在于，所述步骤S200中，所述相关分析方法包括二元变量相关性分析、偏相关分析和距离相关分析中的任意一种或者多种。6.根据权利要求5所述的一种数控机床加工时间预测方法，其特征在于，所述步骤S200中，对于两个特征均为有序分类的，采用Kendall相关系数R来评价相关性，计算公式如下：R=等方法进行数据间的相关性分析，剔除重复因素；通过主成分分析对高维输入特征降维；利用GBRT梯度提升回归树算法对训练集进行训练生成模型，在训练过程中使用验证集对模型进行“人工调参”，通过测试集对模型性能进行评估。采集零件加工中的加工特征、加工参数、机床信息、环境信息等数据作为模型的输入，使用机器学习中的梯度提升决策树算法来对初始数据进行训练生成模型，该算法通过M次迭代，每次迭代产生一个模型，让每次迭代产生的模型对训练集的损失函数最小，采用梯度下降的方法，在每次迭代时向损失函数的负梯度方向移动使得损失函数越来越小，最后将每阶段模型相加得到最终预测结果。优选地，如图1所示，本发明主要包括以下步骤：S1：利用快速程编软件对零件数模进行分析，根据加工特征将其分为腹板段、筋条段、孔段等N种特征类型，Feature:{F1,F2,……,FN}；S2：根据特征类型将NC程序进行分段：{F1{S1,S2,S3,……,Sa}，F2{S1,S2,S3,……,Sb}，……，FN{S1,S2,S3,……,Sm}}并从NC指令中获取每个程序段的转速、进给、切深、切宽等加工参数；S3:根据NC程序段和加工参数计算每个程序段的理想加工时间{T1,T2,……,TN}，并求出零件数控加工时间，Ttotal=T1+T2+……+TN；S4：根据机床采集的DNC数据中获取每个程序段的真实加工时间，计算得到零件数控加工的总时间；S5：获取机床信息和环境信息，并采集以上工况的所有参数；将零件加工采集的特征信息、加工参数、机床信息、环境信息以及计算得到的加工总时间等信息作为一条记录，整理相关工况特征作为输入，数控机床加工时间作为输出；S6：将采集的数据按照6:2:2比例分为训练集、验证集和测试集，对采集到的所有数据进行标准化，填充空白值、异常值；S7：对采集的数据列进行二元变量相关性分析、偏相关分析和距离相关分析，剔除特征间的相关性过高的特征，保证模型的泛化性能；S8：对采集到数据的特征进行主成分分析，计算主成分贡献率及累计贡献率，按一定比例剔除贡献率较低的特征；S9：使用GBRT梯度提升回归树对训练集进行训练；S10：对训练模型中的参数进行调优，根据测试集评估模型并计算模型准确率；S11：采集需要加工零件的以上工况特征作为模型输入，预测零件数控加工时间。本发明将待加工零件的加工特征、加工参数、机床信息以及环境信息等采集到的工况数据作为模型输入，综合考虑了数控加工中至关重要的多影响因素，较为精细地评估了机床加工中所用的时间。本发明根据特征类型对应采用Kendall相关系数R、皮尔逊相关系数r来评价相关性，产生了优势互补的协同作用，且删除特征间的相关性达到0.9至1的特征，有效避免了存在较多信息重复而导致模型存在较大误差，保证了模型的泛化性能。本发明进一步的通过贡献率筛选了数据，提高了后期模型训练的准确性。通过大量的实践证明，本发明利用机器学习算法对数控加工时间进行了高准确的预测，为计划人员进行排产提供了可靠的依据，实现了精准排产，提升企业的管理水平，具有较好的实用性。实施例2：一种数控机床加工时间预测方法，如图1所示，主要包括以下步骤：步骤1：通过对CATIA进行二次开发得到快速程编软件，该软件可识别到零件数模中的加工特征，得到零件包含的腹板、筋条、缘条转角、孔等N种类型。步骤2：基于步骤1中的加工特征将NC程序进行分段，并从NC指令中获取每个程序段的工艺参数，工艺参数主要包括转速、进给、切深、切宽等。步骤3：根据NC指令中加工的坐标以及步骤2中获取到的工艺参数，计算得出每个程序加工段的理论加工时间，累加得到零件的总数控加工时间。步骤4：从机床监控采集的DNC数据中获取零件数控加工的总时间。步骤5：获取机床信息和环境信息。机床信息主要包括：主轴类型、设备类型、设备型号等。主轴类型主要包括机械主轴、电主轴等。环境信息包括：温度、湿度、振动等，对分析的可能影响数控机床加工时间的因素进行收集，将所有特征作为一条记录。将所有收集的数据按照比例6:2:2分为训练集、验证集和测试集。步骤6：对数据中缺失的特征值采用K最近距离法进行填补，进一步对数据进行转换，采用直线法实现统一数据量纲和数量级：最大值化：最小值化：逆向化：其中，xi为第i个数据x，max为最大值数据x，min为最小值数据x，并剔除数据的异常值。步骤7：对数据特征进行相关性分析，对于两个特征均为有序分类的采用Kendall相关系数来评价相关性，计算公式如下：其中n为统计对象，P为两个特征值排列大小关系一致的统计对象数。其他特征的相关性采用皮尔逊相关系数，计算公式如下：其中、/＞及σX分别是对Xi样本的标准分数、样本平均值和样本你标准差。该协方差的取值范围为，|r|值越小则相关性越小。如果r值是0，则说明两个变量不相关，删除特征间的相关性达到0.9至1的特征，避免存在较多信息重复而导致模型存在较大误差，保证模型的泛化性能。步骤8：对数据中P个特征进行主成分分析，计算主成分贡献率及累计贡献率。主成分Zi的贡献率计算公式为：累计贡献率：其中α1i,α2i,…,αpi为X的协方差阵∑的特征值所对应的特征向量，Zx1,Zx2,…,Zxp是原始变量经过标准化处理的值。累计贡献率Fp表示主成分特征占据总特征的比例，其值越大，包含的信息越多，通常取值在0.8-0.9之间。步骤9：使用GBRT梯度提升回归树对训练集进行训练。该算法主要由两个部分组成：回归树和梯度提升。其中回归树是通过信息增益进行节点分割和建树：假设我们前一轮迭代得到的学习器是ft-1,损失函数是L)，我们本轮迭代的目标是找到一个CART回归树模型的弱学习器ht。GBRT由多棵决策树组成，所有树的结论累加起来做最终答案。步骤10：参数调优，优化并评估模型。GBRT框架参数主要包括n_estimators、learning_rate、subsample、init、loss等。在训练过程中不断使用验证集对模型进行“人工调参”，优化模型。利用测试集对模型的泛化能力进行测试。步骤11：当新零件需要加工前，采集模型中确定的主要因素信息，将其整合成一条记录作为模型的输入值，预测本次零件数控加工时间以上所述，仅是本发明的较佳实施例，并非对本发明做任何形式上的限制，凡是依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化，均落入本发明的保护范围之内。
