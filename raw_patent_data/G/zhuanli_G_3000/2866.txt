标题title
基于非对称多层分解的ISAR与VIS图像融合方法
摘要abst
本发明公开了一种基于非对称多层分解的ISAR与VIS图像融合方法，载入空间分辨率相同的逆合成孔径雷达图像与可见光图像，比较逆合成孔径雷达图像与可见光图像的加权空间频率方差的大小，将两幅图像分为细节图像Ia和粗糙图像Ib；使用多层高斯边窗滤波器分解框架对Ia和Ib分别进行分解，获得Ia的细节保留层Sda、边缘保留层Sea、基本能量层Sga、Ib的细节保留层Sdb、边缘保留层Seb和基本能量层Sgb；通过获得的Sda对Sdb进行引导融合策略获得Ib最终的非对称细节保留融合层Sfb；使用局部方差与空间频率构造判别标准对Sda和Sfb进行融合，获得最终的细节保留融合层Sfd；利用ω对Sea和Seb进行融合，获得最终的边缘保留融合层Sfe；将Sga与Sgb融合，获得最终的基本能量层Sfg；将Sfd，Sfe和Sfg相加获得最终的融合图像If。
权利要求书clms
1.一种基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，该方法为：步骤一、载入空间分辨率相同的逆合成孔径雷达图像I1和可见光图像I2；步骤二、确定I1的空间频率F1，并且通过F1确定I1的加权空间频率方差σ1；确定I2的空间频率F2，并且通过F2确定I2的加权空间频率方差σ2；步骤三、比较σ1与σ2的大小，如果σ1大于等于σ2，则将I1记为细节图像Ia，I2记为粗糙图像Ib；如果σ1小于σ2，则将I2记为细节图像Ia，I1记为粗糙图像Ib；步骤四、通过多层高斯边窗滤波器分解框架对Ia和Ib分别进行多层分解，获得Ia的细节保留层Sda、Ia的边缘保留层Sea、Ia的基本能量层Sga、Ib的细节保留层Sdb、Ib的边缘保留层Seb和Ib的基本能量层Sgb；步骤五、通过Sda对Sdb进行引导融合，获得Ib的细节保留融合层Sfb；步骤六、确定Sda的局部方差Lda和空间频率Fda，确定Sfb的局部方差Lfb和空间频率Ffb，通过Lda、Lfb、Fda和Ffb构造判别标准对Sda和Sfb进行融合，获得最终的细节保留融合层Sfd；步骤七、确定Sea的加权空间频率方差σea和Seb的加权空间频率方差σeb，通过σea和σeb确定权重系数ω，通过ω对Sea和Seb进行加权融合，获得最终的边缘保留融合层Sfe；步骤八、将Sga与Sgb融合，获得最终的基本能量融合层Sfg；步骤九、通过Sfd、Sfe和Sfg相加的和确定最终的融合图像If。2.根据权利要求1所述的基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，所述步骤二，具体通过以下步骤实现：按照下式确定I1的行频率R1和I1的列频率C1为其中，M和N分别表示I1的长度和宽度，I1表示I1在第x行第y列像素点的灰度值，x∈{1,...,M},y∈{1,...,N}，∑表示求和操作；按照下式确定I2的行频率R2和I2的列频率C2为其中，M和N分别表示I2的长度和宽度，I2表示I2在第x行第y列像素点的灰度值，x∈{1,...,M},y∈{1,...,N}；按照下式确定I1的空间频率F1和I2的空间频率F2为/＞利用步骤～，即可完成一幅图像的求空间频率操作；按照下式确定I1的灰度平均值A1和I2的灰度平均值A2为按照下式确定I1的灰度值方差V1和I2的灰度值方差V2为按照下式确定I1的加权空间频率方差σ1和I2的加权空间频率方差σ2为3.根据权利要求1或2所述的基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，所述步骤四，具体通过以下步骤实现：使用多层高斯边窗滤波器分解框架中的高斯高频提取方法对Ia和Ib分别进行分解，按照下式确定Ia通过高斯滤波器的第i个低频信息Igi，Ib通过高斯滤波器的第m个低频信息Ifm为其中，i∈{1,2,3}，m∈{1,2,3}，Ig0＝Ia，If0＝Ib，GF表示进行高斯滤波操作；使用多层高斯边窗滤波器分解框架中的边窗高频提取方法对Ia和Ib分别进行分解，按照下式确定Ia通过边窗滤波器的第j个低频信息Idj，和Ib通过边窗滤波器的第n个低频信息Ihn为其中，j∈{1,2,3}，n∈{1,2,3}，Id0＝Ia，Ih0＝Ib，SWF表示进行边窗滤波操作，r表示滤波窗口的半径，e表示滤波器迭代的次数；按照下式确定Ia的细节保留层Sda和Ib的细节保留层Sdb为按照下式确定Ia的边缘保留层Sea和Ib的边缘保留层Seb为按照下式确定Ia的基本能量层Sga和Ib的基本能量层Sgb为4.根据权利要求3所述的基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，所述步骤五，具体通过以下步骤实现：使用引导滤波操作，利用Sda对Sdb进行引导获得非对称引导加强层G为G＝GUF其中，GUF表示进行引导滤波操作；按照下式确定Ib的非对称细节保留融合层Sfb为Sfb＝Sdb+G。5.根据权利要求4所述的基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，所述步骤六，具体通过以下步骤实现：按照下式确定Sda的局部方差Lda和Sfb的局部方差Lfb为其中，在Sda中随机生成一个长度为P，宽度为Q的大小的区域，在Sfb的相同位置处也生成一个长度为P，宽度为Q的大小的区域，k表示区域中心位置的横坐标，o表示区域中心位置的纵坐标，w表示区域中的横坐标像素索引，z表示区域中的纵坐标像素索引，μda表示Sda在此区域中像素灰度值的平均值，μfb表示Sfb在此区域中像素灰度值的平均值；按照下式确定Sda的空间频率Fda和Sfb的空间频率Ffb为其中，Cda表示Sda的列频率，Rda表示Sda的行频率，Cfb表示Sfb的列频率，Rfb表示Sfb的行频率；按照下式确定最终的细节保留融合层Sfd为6.根据权利要求5所述的基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，所述步骤七，具体通过以下步骤实现：按照下式确定Sea的加权空间频率方差σea和Seb的加权空间频率方差σeb为其中，Fea表示Sea的空间频率，Vea表示Sea的灰度值方差，Feb表示Seb的空间频率，Veb表示Seb的灰度值方差；按照下式确定权重系数ω为按照下式确定最终的边缘保留融合层Sfe为Sfe＝ω×Sea+×Seb。7.根据权利要求6所述的基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，所述步骤八，具体为：按照下式，确定最终的基本能量融合层Sfg为8.根据权利要求7所述的基于非对称多层分解的ISAR与VIS图像融合方法，其特征在于，所述步骤九，具体为：按照下式，确定最终的融合图像If为If＝Sfd+Sfe+Sfg 。
说明书desc
技术领域本发明属于图像处理领域，具体涉及一种基于非对称多层分解的ISAR与VIS图像融合方法。背景技术图像融合是图像处理领域的一个重要分支，在医疗诊断、多源数据决策、多景深成像等诸多民用和军事领域中得到了广泛应用。由于传感器物理特性和环境因素的限制，从一种来源获得的图像只能获取到场景中的部分信息。由于可见光传感器的局限性，所得图像无法在一帧内获得目标的运动状态和材料信息。逆合成孔径雷达图像根据其成像原理可以接收到目标的运动信息，但这类图像获得相对静止物体的信息的能力较差，从而导致图像有大面积的暗区。因此，有必要融合来自不同类型传感器的各种关键信息以更好地理解场景。常见的图像融合方法大体上分为三大类，多尺度变换方法、稀疏表示方法和混合模型。这些方法试图通过将图像转换到一个具有独立特征的转换空间来融合两个源图像。基于稀疏表示的方法试图通过稀疏系数来表示源图像中的不同分量，混合模型试图以其他方式重新表示图像特征，多尺度变换方法试图将图像分解成包含不同细节的不同层。在大多数图像源中，信息量是不同的，传统的图像分解方法通常采用同样的方法，这会导致特征层的不匹配，影响最终的融合性能。发明内容有鉴于此，本发明的主要目的在于提供一种基于非对称多层分解的ISAR与VIS图像融合方法。为达到上述目的，本发明的技术方案是这样实现的：本发明实施例提供一种基于非对称多层分解的ISAR与VIS图像融合方法，该方法为：步骤一、载入空间分辨率相同的逆合成孔径雷达图像I1和可见光图像I2；步骤二、确定I1的空间频率F1，并且通过F1确定I1的加权空间频率方差σ1；确定I2的空间频率F2，并且通过F2确定I2的加权空间频率方差σ2；步骤三、比较σ1与σ2的大小，如果σ1大于等于σ2，则将I1记为细节图像Ia，I2记为粗糙图像Ib；如果σ1小于σ2，则将I2记为细节图像Ia，I1记为粗糙图像Ib；步骤四、通过多层高斯边窗滤波器分解框架对Ia和Ib分别进行多层分解，获得Ia的细节保留层Sda、Ia的边缘保留层Sea、Ia的基本能量层Sga、Ib的细节保留层Sdb、Ib的边缘保留层Seb和Ib的基本能量层Sgb；步骤五、通过Sda对Sdb进行引导融合，获得Ib的细节保留融合层Sfb；步骤六、确定Sda的局部方差Lda和空间频率Fda，确定Sfb的局部方差Lfb和空间频率Ffb，通过Lda、Lfb、Fda和Ffb构造判别标准对Sda和Sfb进行融合，获得最终的细节保留融合层Sfd；步骤七、确定Sea的加权空间频率方差σea和Seb的加权空间频率方差σeb，通过σea和σeb确定权重系数ω，通过ω对Sea和Seb进行加权融合，获得最终的边缘保留融合层Sfe；步骤八、将Sga与Sgb融合，获得最终的基本能量融合层Sfg；步骤九、通过Sfd、Sfe和Sfg相加的和确定最终的融合图像If。上述方案中，所述步骤二，具体通过以下步骤实现：按照下式确定I1的行频率R1和I1的列频率C1为其中，M和N分别表示I1的长度和宽度，I1表示I1在第x行第y列像素点的灰度值，x∈{1,...,M},y∈{1,...,N}，∑表示求和操作；按照下式确定I2的行频率R2和I2的列频率C2为其中，M和N分别表示I2的长度和宽度，I2表示I2在第x行第y列像素点的灰度值，x∈{1,...,M},y∈{1,...,N}；按照下式确定I1的空间频率F1和I2的空间频率F2为利用步骤～，即可完成一幅图像的求空间频率操作；按照下式确定I1的灰度平均值A1和I2的灰度平均值A2为按照下式确定I1的灰度值方差V1和I2的灰度值方差V2为/＞按照下式确定I1的加权空间频率方差σ1和I2的加权空间频率方差σ2为上述方案中，所述步骤四，具体通过以下步骤实现：使用多层高斯边窗滤波器分解框架中的高斯高频提取方法对Ia和Ib分别进行分解，按照下式确定Ia通过高斯滤波器的第i个低频信息Igi，Ib通过高斯滤波器的第m个低频信息Ifm为其中，i∈{1,2,3}，m∈{1,2,3}，Ig0＝Ia，If0＝Ib，GF表示进行高斯滤波操作；使用多层高斯边窗滤波器分解框架中的边窗高频提取方法对Ia和Ib分别进行分解，按照下式确定Ia通过边窗滤波器的第j个低频信息Idj，和Ib通过边窗滤波器的第n个低频信息Ihn为其中，j∈{1,2,3}，n∈{1,2,3}，Id0＝Ia，Ih0＝Ib，SWF表示进行边窗滤波操作，r表示滤波窗口的半径，e表示滤波器迭代的次数；按照下式确定Ia的细节保留层Sda和Ib的细节保留层Sdb为按照下式确定Ia的边缘保留层Sea和Ib的边缘保留层Seb为按照下式确定Ia的基本能量层Sga和Ib的基本能量层Sgb为上述方案中，所述步骤五，具体通过以下步骤实现：使用引导滤波操作，利用Sda对Sdb进行引导获得非对称引导加强层G为G＝GUF其中，GUF表示进行引导滤波操作；按照下式确定Ib的非对称细节保留融合层Sfb为Sfb＝Sdb+G。上述方案中，所述步骤六，具体通过以下步骤实现：按照下式确定Sda的局部方差Lda和Sfb的局部方差Lfb为其中，在Sda中随机生成一个长度为P，宽度为Q的大小的区域，在Sfb的相同位置处也生成一个长度为P，宽度为Q的大小的区域，k表示区域中心位置的横坐标，o表示区域中心位置的纵坐标，w表示区域中的横坐标像素索引，z表示区域中的纵坐标像素索引，μda表示Sda在此区域中像素灰度值的平均值，μfb表示Sfb在此区域中像素灰度值的平均值；按照下式确定Sda的空间频率Fda和Sfb的空间频率Ffb为其中，Cda表示Sda的列频率，Rda表示Sda的行频率，Cfb表示Sfb的列频率，Rfb表示Sfb的行频率；按照下式确定最终的细节保留融合层Sfd为上述方案中，所述步骤七，具体通过以下步骤实现：按照下式确定Sea的加权空间频率方差σea和Seb的加权空间频率方差σeb为其中，Fea表示Sea的空间频率，Vea表示Sea的灰度值方差，Feb表示Seb的空间频率，Veb表示Seb的灰度值方差；按照下式确定权重系数ω为按照下式确定最终的边缘保留融合层Sfe为Sfe＝ω×Sea+×Seb。上述方案中，所述步骤八，具体为：按照下式，确定最终的基本能量融合层Sfg为上述方案中，所述步骤九，具体为：按照下式，确定最终的融合图像If为If＝Sfd+Sfe+Sfg。与现有技术相比，本发明采用加权空间频率方差作为图像信息丰富度辨别标准将两幅图像分为细节图像和粗糙图像，为防止图像信息的丢失采用了非对称的分解方法对两幅图像进行分解，利用细节图像的细节保留层对粗糙图像的细节保留层进行引导融合以对粗糙图像的细节保留层的细节加以强化；然后采用三种不同的融合策略对不同类型的层进行融合，最后将不同的融合结果相加获得最终融合结果。附图说明图1为本发明的流程图；图2为本发明输入的逆合成孔径雷达图像；图3为本发明输入的可见光图像；图4为本发明中粗糙图像的细节保留层；图5为本发明中的引导加强层；图6为本发明中的粗糙图像的非对称细节保留融合层；图7为本发明中的最终的细节保留融合层；图8为本发明中的最终的边缘保留融合层；图9为本发明中的最终的基本能量融合层；图10为本发明中的最终融合结果图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。本发明实施例提供一种基于非对称多层分解的ISAR与VIS图像融合方法，如图1所示，该方法为：步骤一、载入空间分辨率相同的逆合成孔径雷达图像I1和可见光图像I2；具体地，图2为载入的逆合成孔径雷达图像I1，包含了一定的飞机速度信息，图3为载入的可见光图像I2，包含了一定的场景信息。步骤二、确定逆合成孔径雷达图像I1的空间频率F1，利用F1确定I1的加权空间频率方差σ1；确定可见光图像I2的空间频率F2，利用F2确定I2的加权空间频率方差σ2；按照下式确定I1的行频率R1和I1的列频率C1为其中，M和N分别表示I1的长度和宽度，I1表示I1在第x行第y列像素点的灰度值，x∈{1,...,M},y∈{1,...,N},∑表示求和操作；具体地，I1的长度M为100，I1的宽度N为100，I1的行频率R1为0.0456，I1列频率C1为0.0275。按照下式确定I2的行频率R2和I2的列频率C2为其中，M和N分别表示I2的长度和宽度，I2表示I2在第x行第y列像素点的灰度值，x∈{1,...,M},y∈{1,...,N}；具体地，I2的长度M为100，I2的宽度N为100，I2的行频率R2为0.0572，I2的列频率C2为0.0684。按照下式确定I1的空间频率F1和I2的空间频率F2为利用步骤～，即可完成一幅图像的求空间频率操作；具体地，I1的空间频率F1为0.0533，I2的空间频率F2为0.0892。按照下式确定I1的灰度平均值A1和I2的灰度平均值A2为具体地，I1的灰度平均值A1为0.0463，I2的灰度平均值A2为0.0459。按照下式确定I1的灰度值方差V1和I2的灰度值方差V2为具体地，I1的灰度值方差V1为0.000107，I2的灰度值方差V2为0.000269。按照下式确定I1的加权空间频率方差σ1和I2的加权空间频率方差σ2为具体地，I1的加权空间频率方差σ1为0.000107，I2的加权空间频率方差σ2为0.000268，加权空间频率方差是一个全局评价参数，加权空间频率方差越大，表明图像携带的信息越丰富。步骤三、比较σ1与σ2的大小，如果σ1大于等于σ2，则将I1记为细节图像Ia，I2记为粗糙图像Ib；如果σ1小于σ2，则将I2记为细节图像Ia，I1记为粗糙图像Ib；具体地，由于σ1为0.000107，σ2为0.000268，σ1小于σ2，所以将I2记为细节图像Ia，I1记为粗糙图像Ib。步骤四、使用多层高斯边窗滤波器分解框架对Ia和Ib分别进行多层分解，获得Ia的细节保留层Sda、Ia的边缘保留层Sea、Ia的基本能量层Sga、Ib的细节保留层Sdb、Ib的边缘保留层Seb和Ib的基本能量层Sgb；使用多层高斯边窗滤波器分解框架中的高斯高频提取方法对Ia和Ib分别进行分解，按照下式确定Ia通过高斯滤波器的第i个低频信息Igi，和Ib通过高斯滤波器的第m个低频信息Ifm为其中，i∈{1,2,3}，m∈{1,2,3}，Ig0＝Ia，If0＝Ib，GF表示进行高斯滤波操作；使用多层高斯边窗滤波器分解框架中的边窗高频提取方法对Ia和Ib分别进行分解，按照下式确定Ia通过边窗滤波器的第j个低频信息Idj，和Ib通过边窗滤波器的第n个低频信息Ihn为其中，j∈{1,2,3}，n∈{1,2,3}，Id0＝Ia，Ih0＝Ib，SWF表示进行边窗滤波操作，r表示滤波窗口的半径，e表示滤波器迭代的次数；具体地，滤波窗口的半径r为1，滤波器迭代的次数e为7。按照下式确定Ia的细节保留层Sda和Ib的细节保留层Sdb为按照下式确定Ia的边缘保留层Sea和Ib的边缘保留层Seb为按照下式确定Ia的基本能量层Sga和Ib的基本能量层Sgb为步骤五、使用引导滤波器，利用Sda对Sdb进行引导融合，获得Ib的细节保留融合层Sfb；使用引导滤波操作，利用Sda对Sdb进行引导获得非对称引导加强层G为G＝GUF其中，GUF表示进行引导滤波操作；按照下式确定Ib的非对称细节保留融合层Sfb为Sfb＝Sdb+G。具体地，图4为Ib的细节保留层Sdb，图5为通过引导滤波操作，利用Sda对Sdb进行引导获得引导加强层G，图6为Ib最终的细节保留融合层Sfb。步骤六、确定Sda的局部方差Lda和Sda的空间频率Fda，确定Sfb的局部方差Lfb和Sfb的空间频率Ffb，利用Lda、Lfb、Fda和Ffb构造判别标准对Sda和Sfb进行融合，获得最终的细节保留融合层Sfd；按照下式确定Sda的局部方差Lda和Sfb的局部方差Lfb为其中，在Sda中随机生成一个长度为P，宽度为Q的大小的区域，在Sfb的相同位置处也生成一个长度为P，宽度为Q的大小的区域，k表示区域中心位置的横坐标，o表示区域中心位置的纵坐标，w表示区域中的横坐标像素索引，z表示区域中的纵坐标像素索引，μda表示Sda在此区域中像素灰度值的平均值，μfb表示Sfb在此区域中像素灰度值的平均值；具体地，随机生成的区域的长度P为3，宽度Q为3，k的值为25，o的值为37，μda的值为0.0215，μfb的值为0.0201，Lda的值为0.000175，Lfb的值为00.000154。按照下式确定Sda的空间频率Fda和Sfb的空间频率Ffb为其中，Cda表示Sda的列频率，Rda表示Sda的行频率，Cfb表示Sfb的列频率，Rfb表示Sfb的行频率；具体地，Cda的值为0.0472，Rda的值为0.0602，Cfb的值为0.0432，Rfb的值为0.0253，Fda的值为0.0765，Ffb的值为0.0501。按照下式确定最终的细节保留融合层Sfd为具体地，Ffb小于Fda，Lfb小于Lda，所以Sfd等于Sda，图7为最终的细节保留融合层Sfd。步骤七、确定Sea的加权空间频率方差σea和Seb的加权空间频率方差σeb，利用σea和σeb确定权重系数ω，使用ω对Sea和Seb进行加权融合，获得最终的边缘保留融合层Sfe；按照下式确定Sea的加权空间频率方差σea和Seb的加权空间频率方差σeb为其中，Fea表示Sea的空间频率，Vea表示Sea的灰度值方差，Feb表示Seb的空间频率，Veb表示Seb的灰度值方差；具体地，Fea的值为0.0762，Vea的值为0.000246，Feb的值为0.0489，Veb的值为0.000101，σea的值为0.000245，σeb的值为0.0001。按照下式确定权重系数ω为具体地，ω的值为0.71。按照下式确定最终的边缘保留融合层Sfe为Sfe＝ω×Sea+×Seb。具体地，图8为最终的边缘保留融合层Sfd。步骤八、按照下式将Sga与Sgb融合，获得最终的基本能量融合层Sfg为具体地，图9为最终的基本能量融合层。步骤九、利用Sfd、Sfe和Sfg相加的和确定最终的融合图像If为If＝Sfd+Sfe+Sfg具体地，图10为最终的融合结果图，红色框标记的为ISAR与VIS融合后的细节，蓝色框标记的为可见背景区域，红色框区域越清晰并且蓝色框越明亮，表明融合结果越好。以上所述，仅为本发明的较佳实施例而已，并非用于限定本发明的保护范围。
