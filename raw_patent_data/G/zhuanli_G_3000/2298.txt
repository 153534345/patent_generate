标题title
一种基于聚类的肝脏CT影像的图像分割方法
摘要abst
本发明公开了一种基于聚类的肝脏CT影像的图像分割方法，涉及医疗图像处理技术领域，包括获取腹部CT原始图像；获取CT原始图像的灰度直方图和灰度梯度直方图；将CT原始图像中的像素点灰度值分为多个灰度值区间；获取CT原始图像中的边缘特征像素点；获取每个灰度值区间的聚类匹配程度；获取每个灰度值区间的像素点聚集度；获取每个目标灰度值区间的聚类起始像素点；根据CT原始图像中每个目标灰度值区间中的聚类起始像素点对CT原始图像中的像素点进行聚类，完成对CT原始图像的分割；本发明解决了相关技术中，在使用K‑means聚类法对肝脏CT图像进行分割时分割效果差，以及计算冗余度大的技术问题。
权利要求书clms
1.一种基于聚类的肝脏CT影像的图像分割方法，其特征在于，包括以下步骤：获取腹部CT原始图像；获取所述CT原始图像的灰度直方图和灰度梯度直方图；在所述灰度直方图中从最大灰度梯度值开始，向灰度梯度值减小的方向逐级进行像素点数量累加，每累加一次后获取累加像素点数量与CT原始图像中像素点数量的比值，根据当前累加后的比值与上一次累加后的比值获取比值的变化率，根据所述比值的变化率获取所述CT原始图像中的边缘特征像素点；根据所述灰度直方图中像素点的灰度级分布将所述CT原始图像中的灰度值分为多个灰度值区间；根据每个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值，获取每个灰度值区间的聚类匹配程度；根据每个灰度值区间中每个像素点与该灰度值区间中其余像素点在所述CT原始图像中的距离的平均值，获取每个灰度值区间中的像素点的聚集度；根据灰度值区间的聚类匹配程度和聚集度从多个灰度值区间中选取目标灰度值区间；获取目标灰度值区间的像素点形成的区域中每个像素点与该区域中其余像素点的灰度值的差值平方和；根据差值平方和获取该区域中的聚类起始像素点；依次获取每个目标灰度值区间的像素点形成区域的聚类起始像素点；根据所述聚类起始像素点对每个目标灰度值区间的像素点形成区域进行聚类，获得多个聚类区域，得到分割后的CT原始图像。2.根据权利要求1所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，根据所述比值的变化率获取所述CT原始图像中的边缘特征像素点的过程中，还包括设定变化率阈值，当所述比值的变化率大于所述变化率阈值时，停止像素点数量的累加，并将已经累加的像素点确定为所述CT原始图像中的边缘特征像素点。3.根据权利要求2所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述变化率阈值为0.3，当所述比值的变化率大于0.3时，停止像素点数量的累加，并将已经累加的像素点确定为所述CT原始图像中的边缘特征像素点。4.根据权利要求1所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述灰度值区间的聚类匹配程度通过下式确定：式中，为第/＞个灰度值区间的聚类匹配程度；/＞为第/＞个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值；/＞为第/＞个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值；/＞为灰度值区间个数；/＞表示以自然常数e为底的指数函数。5.根据权利要求1所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述灰度值区间中的像素点的聚集度通过所述距离的平均值与所述CT原始图像中全部像素点灰度值和的比值得到。6.根据权利要求1所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述获取每个目标灰度值区间的像素点形成区域的聚类起始像素点的过程为：获取所述目标灰度值区间的像素点形成的区域中每个像素点与该区域中其余像素点灰度值的差值平方和；获取所述差值平方和中的最大值，并将所述差值平方和中的最大值对应的像素点作为该区域的聚类起始像素点；依次获取每个目标灰度值区间的像素点形成的每个区域的聚类起始像素点。7.根据权利要求6所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述根据灰度值区间的聚类匹配程度和聚集度从多个灰度值区间中选取目标灰度值区间的过程中，还包括：根据每个灰度值区间的聚类匹配程度从多个灰度值区间中选取非必要灰度值区间；将所述非必要灰度值区间相邻的灰度值区间的范围进行调整，获取调整后的灰度值区间的聚类匹配程度和聚集度；当调整后的灰度值区间的聚类匹配程度和聚集度均不再增大时，停止对灰度值区间的调整，并将剩余的全部灰度值区间确定为目标灰度值区间。8.根据权利要求7所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述灰度值区间的聚类匹配程度小于0.3时，该灰度值区间为非必要灰度值区间。9.根据权利要求1所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述获取腹部CT原始图像后，还包括对所述CT原始图像进行降噪处理。10.根据权利要求9所述的基于聚类的肝脏CT影像的图像分割方法，其特征在于，所述降噪处理采用高斯滤波降噪。
说明书desc
技术领域本发明涉及医疗图像处理技术领域，具体涉及一种基于聚类的肝脏CT影像的图像分割方法。背景技术腹部CT图像则是目前医疗人员获取肝脏状态的最重要的手段之一，通过对腹部CT图像中肝脏区域的分割提取能够用于医学教学等多种领域。因此，从腹部CT图像中完整、精确的进行肝脏的分割，就显得尤为重要。但是，肝脏具有与周围毗邻器官的低对比度、弱边界以及病例间肝脏形态差异较大等特点，腹部CT图像中肝脏的精确分割仍面临较大困难。现有的基于腹部CT序列图像的肝脏分割方法包括基于传统图像分析的方法、基于机器学习的方法和K-means聚类方法。基于传统图像分析的方法，分割流程复杂、耗时长、且需要人工干预，难以实现全自动分割，而且分割结果不理想。基于机器学习的方法，对判别性特征的设计要求非常高，而医学图像的复杂性高，判别特征设计难以得到理想结果；现有的K-means聚类方法在对肝脏CT图像进行分割时，由于类中心点处于一个均衡区域，会导致图像分割效果没有发生变化，同时在的K-means聚类迭代过程中，类中心点在灰度轴中的移动是无限制的，由此会增大K-means聚类过程中的计算冗余度。发明内容为了解决相关技术中，在使用K-means聚类法对肝脏CT图像进行分割时分割效果无法满足要求，以及计算冗余度大的技术问题，本发明提供了一种基于聚类的肝脏CT影像的图像分割方法，该方法通过获取CT图像的灰度直方图和灰度梯度直方图确定多个灰度值区间，并通过每个灰度值区间的聚类匹配程度和像素点聚集度确定多个目标灰度值区间，获取每个目标灰度值区间的初始聚类像素点，并根据每个目标灰度值区间的初始聚类像素点对CT图像中的像素点进行K-means聚类，完成对肝脏CT图像的分割；有鉴于此，本发明通过以下技术方案予以实现。一种基于聚类的肝脏CT影像的图像分割方法，包括以下步骤：获取腹部CT原始图像；获取所述CT原始图像的灰度直方图和灰度梯度直方图；在所述灰度直方图中从最大灰度梯度值开始，向灰度梯度值减小的方向逐级进行像素点数量累加，每累加一次后获取累加像素点数量与CT原始图像中像素点数量的比值，根据当前累加后的比值与上一次累加后的比值获取比值的变化率，根据所述比值的变化率获取所述CT原始图像中的边缘特征像素点；根据所述灰度直方图中像素点的灰度级分布将所述CT原始图像中的灰度值分为多个灰度值区间；根据每个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值，获取每个灰度值区间的聚类匹配程度；根据每个灰度值区间中每个像素点与该灰度值区间中其余像素点在所述CT原始图像中的距离的平均值，获取每个灰度值区间中的像素点的聚集度；根据灰度值区间的聚类匹配程度和聚集度从多个灰度值区间中选取目标灰度值区间；获取目标灰度值区间的像素点形成的区域中每个像素点与该区域中其余像素点的灰度值的差值平方和；根据差值平方和获取该区域中的聚类起始像素点；依次获取每个目标灰度值区间的像素点形成区域的聚类起始像素点；根据所述聚类起始像素点对每个目标灰度值区间的像素点形成区域进行聚类，获得多个聚类区域，得到分割后的CT影像图像。进一步地，根据所述比值的变化率获取所述CT原始图像中的边缘特征像素点的过程中，还包括设定变化率阈值，当所述比值的变化率大于所述变化率阈值时，停止像素点数量的累加，并将已经累加的像素点确定为所述CT原始图像中的边缘特征像素点。进一步地，所述变化率阈值为0.3，当所述比值的变化率大于0.3时，停止像素点数量的累加，并将已经累加的像素点确定为所述CT原始图像中的边缘特征像素点。进一步地，所述灰度值区间的聚类匹配程度通过下式确定：式中，为第/＞个灰度值区间的聚类匹配程度；/＞为第/＞个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值；/＞为第/＞个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值；/＞为灰度值区间个数；/＞表示以自然常数e为底的指数函数。进一步地，所述灰度值区间中的像素点的聚集度通过所述距离的平均值与所述CT原始图像中全部像素点灰度值和的比值得到。进一步地，所述获取每个目标灰度值区间的像素点形成区域的聚类起始像素点的过程为：获取所述目标灰度值区间的像素点形成的区域中每个像素点与该区域中其余像素点灰度值的差值平方和；获取所述差值平方和中的最大值，并将所述差值平方和中的最大值对应的像素点作为该区域的聚类起始像素点；依次获取每个目标灰度值区间的像素点形成的每个区域的聚类起始像素点。进一步地，所述根据灰度值区间的聚类匹配程度和聚集度从多个灰度值区间中选取目标灰度值区间的过程中，还包括：根据每个灰度值区间的聚类匹配程度从多个灰度值区间中选取非必要灰度值区间；将所述非必要灰度值区间相邻的灰度值区间的范围进行调整，获取调整后的灰度值区间的聚类匹配程度和聚集度；当调整后的灰度值区间的聚类匹配程度和聚集度均不再增大时，停止对灰度值区间的调整，并将剩余的全部灰度值区间确定为目标灰度值区间。进一步地，所述灰度值区间的聚类匹配程度小于0.3时，该灰度值区间为非必要灰度值区间。进一步地，所述获取腹部CT原始图像后，还包括对所述CT原始图像进行降噪处理。进一步地，所述降噪处理采用高斯滤波降噪。与现有技术相比，本发明的有益效果是：本发明提供了一种基于聚类的肝脏CT影像的图像分割方法，该方法通过获取腹部CT原始图像；获取CT原始图像的灰度直方图和灰度梯度直方图；由此可根据灰度直方图中灰度值分布确定多个灰度值区间，灰度梯度直方图用于获取CT原始图像中的边缘特征像素点；在灰度直方图中从最大灰度梯度值开始，向灰度梯度值减小的方向逐级进行像素点数量累加，每累加一次后获取累加像素点数量与CT原始图像中像素点数量的比值，根据当前累加后的比值与上一次累加后的比值获取比值的变化率，根据比值的变化率获取CT原始图像中的边缘特征像素点；本发明之所以根据当前累加后的比值与上一次累加后的比值获取比值的变化率获取边缘特征像素点，是因为在腹部CT原始图像中边缘像素点灰度值与其他区域的灰度值特征较大，当比值的变化率较大时，说明边缘像素点与其余区域有明显的分界线；根据灰度直方图中像素点的灰度级分布将CT原始图像中的灰度值分为多个灰度值区间；根据每个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值，获取每个灰度值区间的聚类匹配程度；根据每个灰度值区间中每个像素点与该灰度值区间中其余像素点在CT原始图像中的距离的平均值，获取每个灰度值区间中的像素点的聚集度；获取每个灰度值区间的像素点聚集度是为了确定每个灰度值区间中的起始聚类像素点；在获得每个灰度值区间中的起始聚类像素点后可对CT原始图像中每个目标灰度值区间的像素点进行K-means聚类，可实现对CT原始图像中像素点的分类和对CT原始图像的分割；通过本发明的技术方案实现了对CT原始图像中每个目标灰度值区间的像素点进行K-means聚类，解决了相关技术中，在使用K-means聚类法对肝脏CT图像进行分割时分割效果差，以及计算冗余度大的技术问题。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为一种基于聚类的肝脏CT影像的图像分割方法的流程示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本实施例提供了一种基于聚类的肝脏CT影像的图像分割方法，如图1所示，包括：S101，获取腹部CT原始图像；获取CT原始图像的灰度直方图和灰度梯度直方图；本实施例中，根据腹部CT原始图像获得了灰度直方图和灰度梯度直方图；在灰度直方图中，横轴是灰度值，纵轴是CT原始图像中每个灰度值对应的像素点数量；在灰度梯度直方图中，横轴是灰度梯度值，纵轴是每个灰度梯度值对应的像素点数量；获取腹部CT原始图像后，还包括对所述CT原始图像进行降噪处理；在本发明一个实施例中选择高斯滤波降噪。S102，获取CT原始图像中的边缘特征像素点；在所述灰度直方图中从最大灰度梯度值开始，向灰度梯度值减小的方向逐级进行像素点数量累加，每累加一次后获取累加像素点数量与CT原始图像中像素点数量的比值，根据当前累加后的比值与上一次累加后的比值获取比值的变化率，根据所述比值的变化率获取所述CT原始图像中的边缘特征像素点；需要说明的是，本实施例中根据灰度直方图中像素点灰度值分布将CT原始图像中的像素点灰度值分为多个灰度值区间；获取根据灰度直方图中像素点灰度值分布将CT原始图像中的像素点灰度值分为多个灰度值区间的过程为，将灰度直方图拟合成灰度曲线，获取灰度曲线中的极小值点，根据极小值点可将灰度曲线划分为多个灰度值区间；在灰度梯度直方图中从最大灰度级开始，向灰度级减小的方向逐级进行像素点数量累加，每累加一次获取累加值与CT原始图像中像素点数量的比值，比较相邻像素点数量比值的变化率，设定变化率阈值，当相邻像素点数量比值的变化率大于变化率阈值时，停止像素点数量累加，并将已经进行累加的像素点确定为边缘特征像素点；需要说明的是，本实施例中根据具体实施条件设定变化率阈值为0.3，当相邻像素点数量比值的变化率大于0.3时，停止像素点数量累加，并将已经进行累加的像素点确定为边缘特征像素点，实施者可根据具体实施条件设定其它的数值作为变化率阈值；S103，将CT原始图像中的灰度值分为多个灰度值区间，并获取目标灰度值区间，获取每个目标灰度值区间的聚类起始像素点；本实施例中，根据所述灰度直方图中像素点的灰度级分布将所述CT原始图像中的灰度值分为多个灰度值区间；根据每个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值，获取每个灰度值区间的聚类匹配程度；根据每个灰度值区间中每个像素点与该灰度值区间中其余像素点在所述CT原始图像中的距离的平均值，获取每个灰度值区间中的像素点的聚集度；根据灰度值区间的聚类匹配程度和聚集度从多个灰度值区间中选取目标灰度值区间；获取目标灰度值区间的像素点形成的区域中每个像素点与该区域中其余像素点的灰度值的差值平方和；根据差值平方和获取该区域中的聚类起始像素点；依次获取每个目标灰度值区间的像素点形成区域的聚类起始像素点；需要说明的是，本实施例在中获取每个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值；根据每个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值获取每个灰度值区间的聚类匹配程度；灰度值区间的聚类匹配程度通过下式确定：式中，为第/＞个灰度值区间的聚类匹配程度；/＞为第/＞个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值；/＞为第/＞个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值；/＞为灰度值区间个数；/＞表示以自然常数e为底的指数函数；获取每个灰度值区间中单个像素点与其余像素点在CT原始图像中的平均距离；根据单个像素点与其余像素点在CT原始图像中的平均距离获取每个灰度值区间的像素点聚集度；灰度值区间的像素点聚集度为该灰度值区间中单个像素点与其余像素点在CT原始图像中的平均距离之和，与该灰度值区间中全部像素点灰度值之和的比值；灰度值区间的像素点聚集度通过下式确定：式中，为第/＞个灰度值区间的像素点聚集度；/＞为CT原始图像中第/＞个灰度值区间的像素点/＞与第/＞个像素点/＞之间的距离；/＞为第/＞个灰度值区间中像素点个数；/＞为第个灰度值区间中第/＞个像素点的灰度值；本实施例中，根据灰度值区间的聚类匹配程度和像素点聚集度从多个灰度值区间中获取多个目标灰度值区间；根据灰度值区间的聚类匹配程度和像素点聚集度从多个灰度值区间中获取多个目标灰度值区间的过程为，根据灰度值区间的聚类匹配程度获取非必要灰度值区间；将与非必要灰度值区间相邻的灰度值区间范围进行调整，获取调整后的灰度值区间的聚类匹配程度和聚集度均不再增大时，停止对灰度值区间的调整，获得多个目标灰度值区间；目标灰度值区间的像素点形成的区域中每个像素点与该区域中其余像素点的灰度值的差值平方和通过下式确定：式中，为目标灰度值区间的像素点形成的区域中第/＞个像素点与该区域中其余像素点灰度值的差值平方和；/＞为目标灰度值区间的像素点形成的区域中第/＞个像素点的灰度值；/＞为目标灰度值区间的像素点形成的区域中第/＞个像素点的灰度值；/＞为目标灰度值区间的像素点形成的区域中像素点的个数；S104，根据所述聚类起始像素点对每个目标灰度值区间的像素点形成区域进行聚类，获得多个聚类区域，得到分割后的CT原始图像；本实施例中，根据CT原始图像中每个目标灰度值区间中的聚类起始像素点对CT原始图像中的像素点进行K-means聚类，得到多个聚类区域，完成对CT原始图像的分割；需要说明的是，在对CT原始图像中的像素点进行K-means聚类后，可对每个聚类区域用不同的颜色进行标记，以增强CT原始图像中每个聚簇区域的区分度；对于每个目标灰度值区间聚类起始像素点的选取也就是K-means聚类中k值的选取；对于目标灰度值区间的选取是通过对非必要灰度值区间的相邻的灰度值区间的调整来实现的；相较于传统的聚类中心点选取方法，如手肘法，轮廓系数法，本实施例的结合CT原始图像中像素点的灰度值和灰度梯度值分布获得的目标区间更适合于在单一灰度轴上找到最优的聚类中心点，本实施例的方法更符合CT原始图像中像素点的分布特点。综上，本实施例提供了一种基于聚类的肝脏CT影像的图像分割方法，该方法通过获取腹部CT原始图像；获取CT原始图像的灰度直方图和灰度梯度直方图；由此可根据灰度直方图中灰度值分布确定多个灰度值区间，灰度梯度直方图用于获取CT原始图像中的边缘特征像素点；在灰度直方图中从最大灰度梯度值开始，向灰度梯度值减小的方向逐级进行像素点数量累加，每累加一次后获取累加像素点数量与CT原始图像中像素点数量的比值，根据当前累加后的比值与上一次累加后的比值获取比值的变化率，根据比值的变化率获取CT原始图像中的边缘特征像素点；本发明之所以根据当前累加后的比值与上一次累加后的比值获取比值的变化率获取边缘特征像素点，是因为在腹部CT原始图像中边缘像素点灰度值与其他区域的灰度值特征较大，当比值的变化率较大时，说明边缘像素点与其余区域有明显的分界线；根据灰度直方图中像素点的灰度级分布将CT原始图像中的灰度值分为多个灰度值区间；根据每个灰度值区间中像素点数量与该灰度值区间中边缘特征像素点数量的比值，获取每个灰度值区间的聚类匹配程度；根据每个灰度值区间中每个像素点与该灰度值区间中其余像素点在CT原始图像中的距离的平均值，获取每个灰度值区间中的像素点的聚集度；获取每个灰度值区间的像素点聚集度是为了确定每个灰度值区间中的起始聚类像素点；在获得每个灰度值区间中的起始聚类像素点后可对CT原始图像中每个目标灰度值区间的像素点进行K-means聚类，可实现对CT原始图像中像素点的分类和对CT原始图像的分割；通过本实施例的技术方案实现了对CT原始图像中每个目标灰度值区间的像素点进行K-means聚类，解决了相关技术中，在使用K-means聚类法对肝脏CT图像进行分割时分割效果差，以及计算冗余度大的技术问题。以上仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
