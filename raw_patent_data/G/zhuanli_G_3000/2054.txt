标题title
基于微型CT-高光谱双模式成像的样本4D重建方法及系统
摘要abst
本发明涉及机器视觉表型检测技术领域，尤其涉及基于微型CT‑高光谱双模式成像的样本4D重建方法及系统，重建方法包括如下步骤：平板探测器组件采集待测样本在旋转一圈范围的不同旋转角度的多张X射线投影图，以及高光谱相机拍摄待测样本旋转一圈范围的环形高光谱投影图；工作站根据接收到的待测样本的多张X射线投影图和环形高光谱投影图生成待测样本的4D模型。本发明通过射线投影图与环形高光谱投影图的同步采集，可以提高基于CT成像和高光谱成像的表型数据的获取效率，以及通过CT三维模型与高光谱图像的配准，能够获得具有内部结构与外部纹理信息的高精度4D样本模型，以提高表型数据获取的维度与广度。
权利要求书clms
1.一种基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，包括：工作站向PLC控制器发送控制指令，以使放置有待测样本的载物旋转台按照预设时间间隔旋转；微焦斑射线源发出X射线，以使X射线穿透所述待测样本到达平板探测器组件；所述平板探测器组件接收所述X射线，以采集所述待测样本在旋转一圈范围的不同旋转角度的多张X射线投影图，以及高光谱相机拍摄所述待测样本旋转一圈范围的环形高光谱投影图；所述平板探测器组件和所述高光谱相机分别将采集到的多张X射线投影图和拍摄到的环形高光谱投影图传输至工作站；所述工作站根据接收到的所述待测样本的所述多张X射线投影图和所述环形高光谱投影图生成所述待测样本的4D模型。2.如权利要求1所述的基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，在所述微焦斑射线源发出X射线的步骤之前，所述方法还包括：通过采用参照物上的铅垂线对所述待测样本的旋转轴进行定位，使所述铅垂线与所述旋转轴重合；调节所述高光谱相机的方位，以使所述高光谱相机的狭缝对准所述旋转轴。3.如权利要求2所述的基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，通过采用所述参照物上的铅垂线对所述旋转轴进行定位，使所述铅垂线与所述旋转轴重合的步骤，包括：将可见光相机固定于所述参照物的特征图案的正上方，通过所述可见光相机对所述参照物的特征图案进行拍摄，计算所述参照物的特征图案的中心点位置；沿水平方向平移所述参照物，使得所述参照物的特征图案的中心点漂移量达到最小，使所述参照物上的铅垂线与所述旋转轴重合。4.如权利要求2或3所述的基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，在所述调节高光谱相机的方位的步骤之后，所述方法还包括：将标定物的底板的回转中心移动到所述旋转轴上，在所述标定物旋转一圈的过程中，拍摄所述标定物的标定环形高光谱投影图；基于所述标定环形高光谱投影图，根据所述标定物上的特征点的实际坐标与投影像素坐标之间的对应关系，计算所述高光谱相机的内外参数。5.如权利要求4所述的基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，所述将标定物的底板的回转中心移动到所述旋转轴上，在所述标定物旋转一圈的过程中，拍摄所述标定物的标定环形高光谱投影图的步骤，包括：将标定物放置于所述载物旋转台上，使所述标定物匀速旋转，其中，所述标定物包括底板和垂直固定于所述底板的细杆组成，在所述底板上形成有不同颜色相间的圆环，在所述细杆上形成不同颜色相间的纹理，所述细杆的底端与所述底板的中心点的连线等角度分布，且所述细杆的底端与所述底板的中心点的距离依次增加；将所述标定物的底板正中心移至所述旋转轴重合；在所述标定物旋转一圈的过程中，拍摄所述标定物的标定环形高光谱投影图。6.如权利要求4所述的基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，所述基于所述标定环形高光谱投影图，根据所述标定物上的特征点的实际坐标与投影像素坐标之间的对应关系，计算所述高光谱相机的内外参数的步骤，包括：基于所述底板上的相间圆环的交界及细杆的纹理边缘建立所述标定物的特征点；基于所述标定环形高光谱投影图，根据所述标定物的特征点的实际坐标与投影像素坐标之间的对应关系，计算高光谱相机的内外参数；其中，所述高光谱相机的内外参数包括等效焦距、主点坐标、世界坐标系到相机坐标系的旋转角度以及世界坐标系到相机坐标系的平移分量。7.如权利要求6所述的基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，所述基于所述底板上的相间圆环的交界及细杆的纹理边缘建立所述标定物的特征点的步骤，包括：测量所述底板上每个圆环外边缘半径，得到第一组特征点平面坐标；测量每根细杆纹理的边缘相对于所述底板的高度，得到第二组特征点平面坐标。8.如权利要求1所述的基于微型CT-高光谱双模式成像的样本4D重建方法，其特征在于，所述工作站根据接收到的所述待测样本的所述多张X射线投影图和所述环形高光谱投影图生成所述待测样本的4D模型的步骤，包括：所述工作站采用FDK算法，根据所述待测样本的多张X射线投影图的序列重建，得到待测样本各高度的断层图；所述工作站对所述待测样本各高度的断层图进行前景分割，生成所述待测样本的CT三维模型；所述工作站根据所述待测样本的CT三维模型和所述环形高光谱投影图进行配准，生成所述待测样本的4D模型。9.一种基于微型CT-高光谱双模式成像的样本4D重建系统，其特征在于，所述系统包括：载物旋转台，用于放置待测样本，并带动所述待测样本进行旋转；微焦斑射线源，用于向所述待测样本发射X射线；平板探测器组件，用于接收穿透所述待测样本后受到衰减的X射线，在所述待测样本旋转一圈后，得到所述待测样本的不同旋转角度的多张X射线投影图；高光谱相机，所述高光谱相机位于所述待测样本的一侧，所述高光谱相机的狭缝与所述待测样本的旋转轴对齐，所述高光谱相机用于对所述待测样本进行拍摄，在所述待测样本旋转一圈后，得到所述待测样本的环形高光谱投影图；工作站，用于控制所述载物旋转台的启停、所述射线投影图的采集、所述环形高光谱投影图的采集、CT三维模型的重建，以及基于CT三维模型与所述环形高光谱投影图完成对所述待测样本的4D模型重建；PLC控制器，用于实现工作站与伺服电机及驱动器之间的通信，进而控制载物旋转台的启停。10.如权利要求9所述的基于微型CT-高光谱双模式成像的样本4D重建系统，其特征在于，所述工作站包括至少一个处理器；以及与所述至少一个处理器通信连接的存储器；所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1至8中任一项所述的样本4D重建方法。
说明书desc
技术领域本发明涉及机器视觉表型检测技术领域，尤其涉及一种基于微型CT-高光谱双模式成像的样本4D重建方法及系统。背景技术近年来，遥感技术与计算机视觉技术极大地促进了表型研究领域的发展，表型数据的获取逐步由低效、有损的传统人工方式转向高通量、无损的自动化表型测量。现代化的表型检测方法主要借助可见光、红外、荧光、高光谱、X射线/CT等成像方式获取样本图像，随后采用传统或基于深度学习的图像处理方法从样本图像中提取样本表型形状参数。可见光、红外、荧光等成像方法仅能获取样本表面信息而不能探测内部结构，CT成像能够重建样本内部结构但不能获取表面纹理，单一的成像方式所能获取的表型信息较为有限，现有的表型检测方法在测量广度与维度上具有较大的提升空间。将反射光成像与透射成像进行整合，可同时获取样本的外部纹理信息及内部结构，能有效地拓展表型数据获取的维度，提升数据挖掘潜力。CT与高光谱成像作为透射光与反射光两类成像技术中的典型，目前已在表型研究中取得了广泛的应用，但这些研究通常仅通过单一的CT设备或高光谱设备进行拍摄，所能获取的数据维度较低。此外，现有的CT-高光谱双模式成像系统操作过程较为复杂，射线投影图与高光谱图像不能同时拍摄，表型数据的获取效率较低。发明内容鉴于单一成像方式所能获取的表型数据较为有限，本发明提出基于微型CT-高光谱双模式成像的样本4D重建方法及系统，在重建样本内部断层结构的同时，实现高光谱信息的精确空间定位，得到同时具有内部结构与外部纹理信息的4D样本模型。本发明提供一种基于微型CT-高光谱双模式成像的样本4D重建方法，包括如下步骤：工作站向PLC控制器发送控制指令，以使放置有待测样本的载物旋转台等间隔旋转；当放置有待测样本的载物旋转台等间隔旋转时，微焦斑射线源发出X射线，以使X射线穿透待测样本到达平板探测器组件；平板探测器组件接收X射线，以采集待测样本在旋转一圈范围的不同旋转角度的多张X射线投影图，以及高光谱相机拍摄待测样本旋转一圈范围的环形高光谱投影图；平板探测器组件和高光谱相机分别将采集到的多张X射线投影图和拍摄到的环形高光谱投影图传输至工作站；工作站根据接收到的待测样本的多张X射线投影图和环形高光谱投影图生成待测样本的4D模型。优选的，在微焦斑射线源发出X射线的步骤之前，方法还包括：通过采用参照物上的铅垂线对待测样本的旋转轴进行定位，使参照物的铅垂线与待测样本的旋转轴重合；调节高光谱相机的方位，以使高光谱相机的狭缝对准待测样本的旋转轴。优选的，通过采用参照物上的铅垂线对待测样本的旋转轴进行定位，使参照物的铅垂线与待测样本的旋转轴重合的步骤，包括：将可见光相机固定于参照物的特征图案的正上方，通过可见光相机对参照物的特征图案进行拍摄，计算参照物的特征图案的中心点位置；沿水平方向平移参照物，使得参照物的特征图案的中心点漂移量达到最小，使参照物上的铅垂线与待测样本的旋转轴重合。优选的，在调节高光谱相机的方位的步骤之后，方法还包括：将标定物的底板的回转中心移动到待测样本的旋转轴上，在标定物旋转一圈的过程中，拍摄标定物的标定环形高光谱投影图；基于标定环形高光谱投影图，根据标定物上的特征点的实际坐标与投影像素坐标之间的对应关系，计算高光谱相机的内外参数。优选的，将标定物的底板的回转中心移动到待测样本的旋转轴上，在标定物旋转一圈的过程中，拍摄标定物的标定环形高光谱投影图的步骤，包括：将标定物放置于载物旋转台上，使标定物匀速旋转，其中，标定物包括底板和垂直固定于底板的细杆组成，在底板上形成有不同颜色相间的圆环，在细杆上形成不同颜色相间的纹理，细杆的底端与底板的中心点的连线等角度分布，且细杆的底端与底板的中心点的距离依次增加；将标定物的底板正中心移至待测样本的旋转轴重合；在标定物旋转一圈的过程中，拍摄标定物的标定环形高光谱投影图。优选的，基于标定环形高光谱投影图，根据标定物上的特征点的实际坐标与投影像素坐标之间的对应关系，计算高光谱相机的内外参数的步骤，包括：基于底板上的相间圆环的交界及细杆的纹理边缘建立标定物的特征点；基于标定环形高光谱投影图，根据标定物上的特征点的实际坐标与投影像素坐标之间的对应关系，计算高光谱相机的内外参数；其中，高光谱相机的内外参数包括等效焦距、主点坐标、世界坐标系到相机坐标系的旋转角度以及世界坐标系到相机坐标系的平移分量。优选的，基于底板上的相间圆环的交界及细杆的纹理边缘建立标定物的特征点的步骤，包括：测量底板上每个圆环外边缘半径，得到第一组特征点平面坐标；测量每根细杆纹理的边缘相对于底板的高度，得到第二组特征点平面坐标。优选的，工作站根据接收到的待测样本的多张X射线投影图和环形高光谱投影图生成待测样本的4D模型的步骤，包括：工作站采用FDK算法，根据待测样本的多张X射线投影图的序列重建，得到待测样本各高度的断层图；工作站对待测样本各高度的断层图进行前景分割，生成待测样本的CT三维模型；工作站根据待测样本的CT三维模型和环形高光谱投影图进行配准，生成待测样本的4D模型。本发明还提供一种基于微型CT-高光谱双模式成像的样本4D重建系统，系统包括：载物旋转台，用于放置待测样本，并带动待测样本进行旋转；微焦斑射线源，用于向待测样本发射X射线；平板探测器组件，用于接收穿透待测样本后受到衰减的X射线，在待测样本旋转一圈后，得到待测样本的不同旋转角度的多张X射线投影图；高光谱相机，高光谱相机位于待测样本的一侧，高光谱相机的狭缝与待测样本的旋转轴对齐，高光谱相机用于对待测样本进行拍摄，在待测样本旋转一圈后，得到待测样本的环形高光谱投影图；工作站，用于控制载物旋转台的启停、射线投影图的采集、环形高光谱投影图的采集、CT三维模型的重建，以及基于CT三维模型与环形高光谱投影图完成对待测样本的4D模型重建；PLC控制器，用于实现工作站与伺服电机及驱动器之间的通信，进而控制载物旋转台的启停。优选的，工作站包括至少一个处理器；以及与至少一个处理器通信连接的存储器；存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行本发明提到的基于微型CT-高光谱双模式成像的样本4D重建方法。与现有技术相比，本发明能够取得如下有益效果：本发明通过射线投影图与环形高光谱投影图的同步采集，可以提高基于CT-高光谱双模式成像的表型数据的获取效率，以及通过CT成像数据与高光谱数据的配准，能够获得具有内部结构与外部纹理信息的高精度4D样本模型，以提高表型数据获取的维度与广度。附图说明图1是根据本发明实施例提供的基于微型CT-高光谱双模式成像的样本4D重建系统的结构示意图；图2是根据本发明实施例提供的参照物的结构示意图；图3是根据本发明实施例提供的参照物的特征图案示意图；图4是根据本发明实施例提供的调节支架的结构示意图；图5是根据本发明实施例提供的标定物的结构示意图；图6是图5俯视角度的结构示意图；图7是根据本发明实施例提供的基于微型CT-高光谱双模式成像的样本4D重建方法的流程示意图；图7a是根据本发明实施例提供的狭缝与待测样本旋转轴对准方法的流程示意图；图7b是根据本发明实施例提供的高光谱相机内外参数的计算方法的流程示意图；图8是根据本发明实施例提供的高光谱相机的单帧成像模型示意图。附图标记：平板探测器组件1、升降台2、平移台3、载物旋转台4、待测样本5、微焦斑射线源6、射线源冷却装置7、高光谱相机8、调节支架9、卤素光源10、工作站11、PLC控制器12、双轴平移底座13-1、平板13-2、平板支撑13-3、特征图案13-4、铅垂线13-5、铅锤13-6、转接板14-1、升降支柱14-2、旋转台14-3、直线平移台14-4、底板15-1、细杆15-2。具体实施方式在下文中，将参考附图描述本发明的实施例。在下面的描述中，相同的模块使用相同的附图标记表示。在相同的附图标记的情况下，它们的名称和功能也相同。因此，将不重复其详细描述为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及具体实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅用以解释本发明，而不构成对本发明的限制。图1示出了根据本发明实施例提供的基于微型CT-高光谱双模式成像的样本4D重建系统的结构。如图1所示，本发明实施例一提供的基于微型CT-高光谱双模式成像的样本4D重建系统，包括平板探测器组件1、升降台2、平移台3、载物旋转台4、微焦斑射线源6、射线源冷却装置7、高光谱相机8、调节支架9、卤素光源10、工作站11、PLC控制器12、参照物和标定物。待测样本5放置在载物旋转台4上，通过载物旋转台4带动待测样本5等间隔旋转。微焦斑射线源6位于载物旋转台4的一侧，用于向待测样本5发射X射线。微焦斑射线源6主要由阴极灯丝、真空加压腔阳极靶等部分组成，用于向待测样本发出稳定的X射线束，其射线能量分布以及总能量由加压腔两端的电压及灯丝两端通过的电流决定。需要说明的是，微焦斑射线源6独立放置在射线源冷却装置7旁边，通过射线源冷却装置7为微焦斑射线源6进行冷却，防止微焦斑射线源6因过热而损毁。平板探测器组件1位于载物旋转台4的另一侧，通过平板探测器组件1采集待测样本5在不同旋转角度的多张X射线投影图，基于X射线投影图重建CT三维模型。平板探测器组件1包括平板探测器、闪烁体和CCD，平板探测器用于接收穿透待测样本后受到衰减的X射线，通过闪烁体将X射线能量转换为光信号，再通过CCD将光信号转化为图像数据。载物旋转台4放置在平移台3上，通过平移台3实现载物旋转台4的移动，以调节载物旋转台4与平板探测器组件1的距离。平移台3通过任何实现直线运动的机构实现，载物旋转台4通过任何实现转动的机构实现，平移台3与载物旋转台4的具体结构不在本发明具体限定，但都属于现有技术。平板探测器组件1放置在升降台2上，通过升降台2调节平板探测器组件1的高度，以及通过调节平移台3实现载物旋转台4的移动，调节载物旋转台4与平板探测器组件1的距离，使待测样本5在各个旋转角度下都能在X射线拍摄视野内。升降台2通过任何实现升降运动的机构实现，属于现有技术。高光谱相机8位于待测样本5的一侧，高光谱相机8的狭缝与待测样本5的旋转轴对齐。当待测样本5旋转完一圈后，高光谱相机8能够拍摄得到待测样本5的环形高光谱投影图。高光谱相机8放置在调节支架9上，调节支架9能够保证高光谱相机8可以绕三个不共面的轴转动及沿某一固定方向平移，通过调节支架9调节高光谱相机8的方位使高光谱相机8的狭缝对准待测样本5的旋转轴。卤素光源10位于高光谱相机8的一侧，卤素光源10为高光谱相机8提供高光谱成像所需的稳定光源。工作站11用于控制载物旋转台4的启停、射线投影图的采集、环形高光谱投影图的采集、CT三维模型的重建，以及基于CT三维模型与环形高光谱投影图的配准完成对待测样本的4D模型重建。工作站11包括至少一个处理器，以及与至少一个处理器通信连接的存储器；其中，存储器存储有可被至少一个处理器执行的指令，指令被至少一个处理器执行，以使至少一个处理器能够执行待测样本5的4D模型重建方法。工作站11以通用计算设备的形式表现。工作站11旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本发明的实现。PLC控制器12用于实现工作站11与伺服电机及驱动器之间的通信，进而控制载物旋转台4的启停。通过参照物与调节支架9的配合实现高光谱相机8的狭缝与待测样本5的旋转轴的对准。图2示出了根据本发明实施例提供的参照物的结构。如图2所示，参照物包括双轴平移底座13-1、平板13-2、平板支撑13-3、特征图案13-4、铅垂线13-5和铅锤13-6，平板13-2通过平板支撑13-3固定在双轴平移底座13-1的上层移动部分，在平板13-2的上表面形成有特征图案13-4，在平板13-2的下表面对应于特征图案13-4的中心点位置通过铅垂线13-5释放铅锤13-6，在铅垂线13-5上形成有不同颜色相间的纹理。双轴平移底座13-1为现有技术，其具体结构在此不再赘述。图3示出了根据本发明实施例提供的参照物的特征图案。如图3所示，特征图案包括两组不同颜色的圆形，每组包括两个相对的相同颜色的圆形，例如，两个相对的蓝色圆形和两个相对的绿色圆形，在两个蓝色圆形的质心连线与两个绿色圆形的质心连线的交点位置向下释放铅锤13-6，另外，外面的圆环为红色，其余线条为黑色。当然，本发明也可以通过不同的形状来进行特征图案13-4中心点的寻找。例如将两个绿色圆形替换为两个蓝色三角形。需要说明的是，本发明可以通过颜色或形状来进行特征图案中心点的检测，需要说明的是，如果特征图案不是圆形，而是其他形状，释放铅锤线的位置必须是两组相对形状的质心连线的交点。还需要说明的是，若换成其他不对称的图案配置，“中心点”这一说法可能不再是字面意思，因为两组质心连线的交点极可能不在整个特征图案的正中心。图4示出了根据本发明实施例提供的调节支架的结构。如图4所示，调节支架9包括转接板14-1、升降支柱14-2、旋转台14-3和直线平移台14-4，旋转台14-3与直线平移台14-4的移动部分固定连接，升降支柱14-2的底端固定在旋转台14-3上，升降支柱14-2的顶端支撑转接板14-1，高光谱相机8安放在转接板14-1上。升降支柱14-2、旋转台14-3与直线平移台14-4均为现有技术，具体结构在此不再赘述。在通过高光谱相机8进行采集环形高光谱投影图之前，需要对高光谱相机8的内外参数进行标定，本发明通过标定物来实现高光谱相机8内外参数的标定。图5和图6分别示出了根据本发明实施例提供的不同视角的标定物的结构。如图5和图6所示，标定物由底板15-1和垂直固定于底板的多根细杆15-2组成，在底板15-1上形成有不同颜色相间的圆环，在每根细杆15-2上形成不同颜色相间的纹理，每根细杆15-2的底端与底板15-1的中心点的连线等角度分布，且细杆15-2的底端与底板15-1的中心点的距离依次增加。上述内容详细说明了本发明实施例提供的基于微型CT-高光谱双模式成像的样本4D重建系统，与上述样本4D重建系统相对应，本发明实施例二还提供一种利用基于微型CT-高光谱双模式成像的样本4D重建系统实现的样本4D重建方法。图7示出了根据本发明实施例提供的基于微型CT-高光谱双模式成像的样本4D重建方法的流程。如图7所示，基于微型CT-高光谱双模式成像的样本4D重建方法，主要包括如下步骤：步骤701、工作站向PLC控制器发送控制指令，以使载物旋转台4等间隔旋转，载物旋转台上放置有待测样本。在本步骤中，首先，可以将待测样本5放置在预先准备好的载物旋转台4上，然后，通过工作站11向PLC控制器12发送指令，以实现载物旋转台4等间隔旋转，以便在后续步骤中实现在待测样本5旋转一圈时间内通过平板探测器组件1与高光谱相机8实现射线投影图与环形高光谱投影图的同步采集，以大幅提高基于CT-高光谱双模式成像的表型数据的获取效率。需要说明的是，在首次使用基于微型CT-高光谱双模式成像的样本4D重建系统进行双模式图像拍摄之前，还需要先将高光谱相机8的狭缝与待测样本5的旋转轴进行对准，再对高光谱相机的内外参数进行标定，需要说明的是，在本发明中，对高光谱相机的内外参数进行标定和计算高光谱相机的内外参数可以理解为一个意思。可以理解的，在对准和标定之后，对同一套基于微型CT-高光谱双模式成像的样本4D重建系统且系统没有改变的前提下，再次使用无需再进行对准和标定。具体的，将高光谱相机8的狭缝与待测样本5的旋转轴进行对准是为了使高光谱相机8最大化获取待测样本5的表面信息。将高光谱相机8的狭缝对准待测样本5的旋转轴，也就是使待测样本5的旋转轴落在高光谱相机8的成像平面以内。由于仅通过人眼观测调节高光谱相机的方位不能使狭缝对准达到数据配准所需的精度，对此，本发明采用图2所示的参照物，以及图4所示的调节支架9进行高光谱相机8的狭缝与待测样本5的旋转轴的对准。图7a示出了本发明中对准方法的流程。如图7a所示，对准方法包括如下步骤：步骤11、采用参照物上的铅垂线对旋转轴进行定位，也就是使参照物的铅垂线与旋转轴重合。在具体实施过程中，第一，可以将可见光相机固定于参照物的特征图案的正上方，通过可见光相机对参照物的特征图案进行拍摄，计算参照物的特征图案的中心点位置。具体的操作步骤如下：采用水平仪将载物旋转台4的顶面调节至完全水平，此时待测样本5的旋转轴为竖直方向。将参照物放置于调平的载物旋转台4上，通过工作站11发送指令使载物旋转台4匀速旋转。将一台可见光相机固定于参照物的特征图案13-4的正上方，以及采用该可见光相机拍摄该特征图案13-4，此时，工作站11的控制台终端实时显示可见光相机所拍摄到的特征图案13-4。第二、可以沿水平方向平移参照物，使得参照物的特征图案的中心点漂移量达到最小，使参照物上的铅垂线与待测样本的旋转轴重合。具体的操作步骤如下：计算特征图案13-4上两个相对图形质心连线与另外两个相对图形质心连线的交点，得到特征图案13-4正中心的像素坐标。对特征图案13-4的中心点运动轨迹进行追踪，并沿X或Y方向平移参照物，使得参照物的中心点漂移量达到最小。需要说明的是，在进行对准时，参照物放在载物旋转台4上转动，特征图案的中心点没有移到旋转轴上时，该中心点的运动轨迹是一个圆，其中，该圆的圆心位于旋转轴上，中心点越靠近旋转轴，运动轨迹的圆半径就越小，移到旋转轴上以后，中心点将保持在一个点不动，即所谓的“漂移量达到最小。由于铅垂线13-5的顶点与特征图案13-4的中心点位置重合，当特征图案13-4的中心点在旋转运动过程中漂移量达到最小时，铅垂线13-5与待测样本5的旋转轴重合。撤离可见光相机。可以理解的，本发明通过对特征图案13-4的中心点运动轨迹进行追踪，沿X或Y方向平移参照物，实现采用参照物上的铅垂线对旋转轴进行定位，使参照物的铅垂线与旋转轴重合。步骤12、当参照物的铅垂线与旋转轴重合时，调节高光谱相机的方位，以使高光谱相机的狭缝对准旋转轴。在本步骤中，首先，可以在高光谱相机采集控制软件中实时显示狭缝单帧成像结果，通过调节支架9平移高光谱相机8，使高光谱相机8的狭缝可观测到铅垂线13-5；然后，对高光谱相机8的方位进一步微调，当狭缝所能观测到的铅垂线13-5范围达到最大时，表明高光谱相机8的狭缝已对准待测样本5的旋转轴。可见，在本步骤中，可以通过调节高光谱相机的方位，使高光谱相机狭缝对准铅垂线，也就间接使得高光谱相机8的狭缝对准待测样本5的旋转轴。接下来，可以对高光谱相机8的内外参数进行计算。对高光谱相机8的内外参数进行计算是为了后续CT三维模型与环形高光谱投影图的配准。本发明将高光谱相机8的单帧成像模型简化为图8所示的二维情形小孔成像，基于简化后的成像模型，采用一种特殊的标定物对高光谱相机8的内外参数进行计算。如图8所示，记世界坐标系为，相机坐标系为/＞，图像坐标系为OX，像素坐标系为/＞，/＞为高光谱相机8的光轴，指定世界坐标系/＞轴与待测样本5的旋转轴重合，由于高光谱相机8的狭缝对准待测样本5的旋转轴，因此/＞与/＞为两条共面直线，将/＞与/＞所在平面定义为高光谱相机成像平面，指定世界坐标系/＞轴在高光谱相机成像平面以内且垂直于/＞。世界坐标系中的一点到该点的像点m的投影公式为：；在公式中，为相机内参矩阵，/＞为外参矩阵，/＞为等效焦距，，f为相机焦距，dx为相机CCD单个像元尺寸，/＞为主点坐标，/＞为世界坐标系到相机坐标系的旋转角度，/＞和/＞为世界坐标系到相机坐标系的平移分量。可将公式写为：；记，其中/＞，/＞，/＞，，/＞，/＞；若已知N个成像平面内二维点与其像点间的对应关系，则有：；将上式简记AP=0，其中：等式AP=0包括共6个未知数，由于仅有未知数之间的比值是有效的，不妨令/＞，则该等式的解为矩阵/＞的最小特征值所对应的特征向量。求解使得AP=0的向量P，令：；根据计算出高光谱相机8的内外参数：由式最少需要5个已知的平面点与像素点对应关系，才能求解出高光谱相机8的内外参数。已知的对应关系数量越多，求解误差越小。需要说明的是，对于每一个特征点，可以测量得到它的实际坐标，同时可以从环形高光谱投影图中找到其投影点的坐标/＞，由实际坐标/＞及其投影点的坐标/＞可以列出一个等式/＞N个特征点可以列出N个以上形式的等式，将这N个等式写为矩阵的形式就是公式。在公式中，是与相机内、外参数相关的向量，相机的标定等价于求得使等式成立的向量/＞，求解方法如公式到公式之间的具体说明。采用图5所示的标定物对高光谱相机8的内外参数进行标定。记第i根细杆底端与底板中心的连线为/＞，/＞与/＞的夹角为/＞；第i根细杆底端位于第i+1个圆环的外边缘上，标定物的俯视图如图6所示。图7b示出了根据本发明实施例提供的高光谱相机内外参数的计算方法的流程。如图7b所示，高光谱相机8内外参数的计算方法包括如下步骤：步骤21、将标定物底板的回转中心移动到待测样本的旋转轴上，在标定物旋转一圈的过程中，拍摄标定物的标定环形高光谱投影图。在具体实施过程中，第一、将标定物放置于载物旋转台上，使标定物匀速旋转；其中，标定物包括底板和垂直固定于底板的细杆组成，在底板上形成有不同颜色相间的圆环，在细杆上形成不同颜色相间的纹理，细杆的底端与底板的中心点的连线等角度分布，且细杆的底端与底板的中心点的距离依次增加，详细说明可以参考实施例一中图5和图6对应的相关说明，在此不再赘述。具体的操作步骤如下：采用水平仪将载物旋转台4的顶面调节至完全水平，此时待测样本的旋转轴为竖直方向，将标定物放置于调平的载物旋转台4上。通过工作站11发送指令使载物旋转台4匀速旋转。第二、将标定物的底板正中心移至待测样本的旋转轴重合。具体的操作步骤如下：将一台可见光相机固定于标定物的正上方。采用可见光相机拍摄标定物的底板15-1。工作站11的控制台终端实时显示可见光相机所拍摄到的底板15-1中心的圆环。计算圆环的质心，得到底板15-1的中心点位置。对底板15-1的中心点运动轨迹进行追踪，沿X或Y方向平移标定物，使得底板15-1的中心点漂移量达到最小，此时，底板15-1的中心点位于待测样本5的旋转轴上，底板15-1上固定的所有细杆15-2与待测样本5的旋转轴平行。在底板15-1的中心点移至待测样本5的旋转轴上之后，撤离可见光相机。第三、在标定物旋转一圈的过程中，拍摄标定物的标定环形高光谱投影图。步骤22、基于标定环形高光谱投影图，根据标定物上的特征点的实际坐标与投影像素坐标之间的对应关系，计算高光谱相机的内外参数。在具体实施过程中，第一、基于底板上的相间圆环的交界及细杆的纹理边缘建立标定物的特征点。具体的操作步骤如下：测量底板上每个圆环外边缘半径，得到第一组特征点平面坐标。具体的，测量底板15-1上每个圆环的外边缘半径得到第一组特征点平面坐标/＞。测量每根细杆纹理的边缘相对于底板的高度，得到第二组特征点平面坐标。具体的，操作步骤为：A.测量每根细杆15-2纹理的边缘相对于底板15-1的高度，第i根细杆15-2的第j个纹理边缘相对于底板15-1的高度记为，得到第二组特征点平面坐标。B.从环形高光谱投影图中得到底板15-1各圆环边缘所成像的坐标，记为第一组特征点投影像素坐标，第一组特征点投影像素坐标与第一组特征点平面坐标相对应。C.从环形高光谱投影图中得到各细杆15-2各纹理的边缘所成像的坐标，记为第二组特征点投影像素坐标，第二组特征点投影像素坐标与第二组特征点平面坐标相对应。第二、基于标定环形高光谱投影图，根据标定物上的特征点平面坐标与投影像素坐标之间的对应关系，计算高光谱相机的内外参数；其中，高光谱相机的内外参数包括等效焦距、主点坐标、世界坐标系到相机坐标系的旋转角度以及世界坐标系到相机坐标系的平移分量。具体的，可以根据第一组特征点投影像素坐标与第一组特征点平面坐标的对应关系、第二组特征点投影像素坐标与第二组特征点平面坐标的对应关系以及公式和公式，求解高光谱相机8的内外参数。步骤702、当放置有待测样本的载物旋转台等间隔旋转时，微焦斑射线源发出X射线，以使X射线穿透待测样本到达平板探测器组件1。步骤703、平板探测器组件接收X射线，以采集待测样本在旋转一圈范围的不同旋转角度的多张X射线投影图，高光谱相机拍摄待测样本旋转一圈范围的环形高光谱投影图，平板探测器组件1和高光谱相机分别将采集到的多张X射线投影图和拍摄到的环形高光谱投影图传输至工作站。步骤704、工作站根据接收到的待测样本的多张X射线投影图和环形高光谱投影图生成待测样本的4D模型。在本步骤中，首先，工作站11可以通过待测样本5的多张X射线投影图生成CT三维模型，接下来，根据CT三维模型中的空间点与环形高光谱投影图中像素点的对应关系，将三维点坐标与光谱信息合起来输出得到待测样本5的4D模型。具体的操作步骤如下：采用FDK算法，根据待测样本5的多张X射线投影图的序列重建得到待测样本5各高度的断层图，对所有断层图进行前景分割，对于第张断层图中的前景点可得到一个三维点坐标，所有断层图的前景点所对应的三维点坐标的集合即为待测样本5的CT三维模型。/＞工作站11根据步骤生成的待测样本的CT三维模型，以及拍摄到的待测样本的环形高光谱投影图进行配准，生成待测样本的4D模型。在步骤中，CT三维模型与环形高光谱投影图的具体配准方法如下：对待测样本5的环形高光谱投影图进行遍历，对于环形高光谱投影图上任意一列，根据坐标/＞判断高光谱相机8拍摄第v帧图像时成像平面与待测样本5的相交部分I，对于第列上任意一点，当该点为前景点时，根据公式对该点进行反投影计算，判断点的反投影光线与I距离/＞最近的交点，该交点即为像素点所对应的空间点。判断高光谱相机8拍摄第v帧图像时成像平面与待测样本5的相交部分I的方法为：A、对待测样本5进行拍摄时，在载物旋转台4上随待测样本5一同放置一根竖直细杆。B、在断层图中对细杆进行定位，记细杆横截面形心与断层图中心点连线为。C、在环形高光谱投影图中对细杆进行定位，记细杆所在列为。D、假定从俯视角度观测待测样本5为顺时针旋转，并假定高光谱相机8拍摄第v帧图像与拍摄第帧图像时待测样本5的旋转角度为/＞，记/＞沿断层图中心点逆时针方向旋转/＞后得到的直线为l，对于环形高光谱投影图第v列，其对应的I为所有断层图中直线l与前景点相交部分的集合。可见，本发明提出的利用基于微型CT-高光谱双模式成像的样本4D重建系统实现的样本4D重建方法，能够在待测样本旋转一圈时间内，通过平板探测器组件1和高光谱相机8，完成对待测样本的不同旋转角度的多张X射线投影图，以及待测样本的环形高光谱投影图的同步采集。相比现有技术中，需独立使用CT设备和高光谱设备分别对待测样本进行至少两次拍摄，才能获取到X射线投影图和高光谱投影图，本发明能够通过一次操作同时获取待测样本5的不同旋转角度的多张X射线投影图与环形高光谱投影图，不仅能够大幅提高操作效率，而且通过环形高光谱投影图与基于多张X射线投影图生成的CT三维模型的高效配准，可以有效提高基于CT成像和高光谱成像所能获取的表型数据维度。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发明公开中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本发明公开的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
