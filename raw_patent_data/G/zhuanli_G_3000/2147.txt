标题title
一种运动舰船检测方法、系统、存储介质和电子设备
摘要abst
本发明公开了一种运动舰船检测方法、系统、存储介质和电子设备，包括：对每个包含运动舰船的第一视频帧分别进行增强处理，得到多个第二视频帧，并利用混合高斯模型，获取每个第二视频帧的伪标签样本；将每个第二视频帧的伪标签样本分别作为相应第一视频帧的伪标签样本，并基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络；将待检测视频帧输入至所述训练好的目标检测网络，得到所述待检测视频帧的目标检测结果。本发明通过利用生成的伪标签样本，进行目标检测网络的模型训练，提高了在弱监督条件下的运动舰船的检测效率的同时，还提高了运动舰船检测精度。
权利要求书clms
1.一种运动舰船检测方法，其特征在于，包括：对每个包含运动舰船的第一视频帧分别进行增强处理，得到多个第二视频帧，并利用混合高斯模型，获取每个第二视频帧的伪标签样本；将每个第二视频帧的伪标签样本分别作为相应第一视频帧的伪标签样本，并基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络；将待检测视频帧输入至所述训练好的目标检测网络，得到所述待检测视频帧的目标检测结果。2.根据权利要求1所述的运动舰船检测方法，其特征在于，对任一第一视频帧进行增强处理，得到该第一视频帧对应的第二视频帧的步骤包括：对所述任一第一视频帧进行线性平滑滤波处理，得到该第一视频帧的第一特征数据；对所述任一第一视频帧进行Gabor特征提取，得到该第一视频帧的第二特征数据；对所述任一第一视频帧进行灰度处理，得到该第一视频帧的第三特征数据；对所述任一第一视频帧的第一特征数据、第二特征数据和第三特征数据进行通道拼接，得到该第一视频帧对应的第二视频帧。3.根据权利要求1所述的运动舰船检测方法，其特征在于，基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络的步骤，包括：将每个第一视频帧及相应的伪标签样本分别输入至所述预设目标检测网络，得到每个第一视频帧的训练损失值；基于所有的训练损失值，对所述预设目标检测网络进行优化，得到优化后的目标检测网络，并将所述优化后的目标检测网络作为所述预设目标检测网络并返回执行所述将每个第一视频帧及相应的伪标签样本分别输入至所述预设目标检测网络的步骤，直至满足预设训练条件时，将所述优化后的目标检测网络确定为所述训练好的目标检测网络。4.根据权利要求3所述的运动舰船检测方法，其特征在于，所述预设目标检测网络包括：骨干网络、特征金字塔网络、区域生成网络、感兴趣区域对齐模块、感兴趣区域特征提取器、目标分类分支、目标回归分支和目标掩码分支；将所述任一第一视频帧及相应的伪标签样本输入至所述预设目标检测网络，得到该第一视频帧的训练损失值的步骤，包括：将所述任一第一视频帧输入至所述骨干网络进行处理，得到该第一视频帧的多个不同层级的特征图；将所述任一第一视频帧的多个不同层级的特征图输入至所述特征金字塔网络进行多尺度特征融合，得到该第一视频帧的融合特征图；将所述任一第一视频帧的融合特征图输入至所述区域生成网络，得到该第一视频帧的包含运动舰船所在区域的目标建议框；将所述任一视频帧的融合特征图和目标建议框输入至所述感兴趣区域对齐模块，并依次通过所述感兴趣区域对齐模块和所述感兴趣区域特征提取器进行处理，得到该视频帧的目标建议框特征图；将所述任一视频帧的目标建议框特征图输入至所述目标分类分支，得到该视频帧的预测分类概率；将所述任一视频帧的目标建议框特征图输入至所述目标回归分支，得到该视频帧的目标建议框的参数化坐标预测值；将所述任一视频帧的目标建议框特征图输入至所述目标掩码分支，得到该视频帧的包含运动舰船的目标预测掩码；基于所述任一第一视频帧的伪标签样本、预测分类概率、参数化坐标预测值和目标预测掩码，得到该第一视频帧的训练损失值。5.根据权利要求4所述的运动舰船检测方法，其特征在于，所述目标掩码分支包括：改进的Mask Head分支和目标边界保持映射模块；其中，所述改进的Mask Head分支的构建过程为：在包含有多个高分辨率掩码分支的原始Mask Head分支上添加至少一个低分辨率掩码分支，得到所述改进的Mask Head分支；所述目标边界保持映射模块用于：基于边界保持映射关系，对所述改进的Mask Head分支输出的原始预测掩码进行处理，得到目标预测掩码；所述边界保持映射关系为：BPM表示所述目标边界保持映射的目标预测掩码，pij表示每个像素对应的掩码概率输出值，表示对pij进行sigmoid激活运算，/＞表示拉普拉斯算子运算。6.根据权利要求4或5所述的运动舰船检测方法，其特征在于，基于所述任一第一视频帧的伪标签样本、预测分类概率、参数化坐标预测值和目标预测掩码，得到该第一视频帧的训练损失值的步骤，包括：获取所述任一第一视频帧的伪标签样本的参数化坐标伪标签值和伪标签掩码，并将该第一视频帧的参数化坐标伪标签值、伪标签掩码、预测分类概率、参数化坐标预测值和目标预测掩码代入目标损失函数，得到该第一视频帧的训练损失值；其中，所述目标损失函数为：L＝Lcls+Lreg+Lmask；L表示该第一视频帧的训练损失值，Lcls表示该第一视频帧的分类损失值，Lreg表示该第一视频帧的回归损失值，Lmask表示该第一视频帧的掩码损失值；ki为该第一视频帧的第i个目标建议框的预测分类概率，当第i个目标建议框是正样本时，/＞当第i个目标建议框是负样本时，Ncls为mini-batch size，/＞表示对/＞的二分类log损失；σj为该第一视频帧的伪标签样本的标注框回归一致性判别，/＞j表示该第一视频帧的伪标签样本的目标框的索引，/＞表示该第一视频帧的第i个目标建议框与索引为j的伪标签样本的目标框之间的IoU值，N表示该第一视频帧的正例候选框的数量，reg表示目标建议框的参数化坐标预测值，REG表示伪标签样本的参数化坐标伪标签值，m2为预测掩码的尺寸，ypq为该第一视频帧的像素对应的伪标签样本的伪标签掩码，/＞为该第一视频帧的像素对应的目标预测掩码。7.一种运动舰船检测系统，其特征在于，包括：处理单元、训练单元和检测单元；所述处理单元用于：对每个包含运动舰船的第一视频帧分别进行增强处理，得到多个第二视频帧，并利用混合高斯模型，获取每个第二视频帧的伪标签样本；所述训练单元用于：将每个第二视频帧的伪标签样本分别作为相应第一视频帧的伪标签样本，并基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络；所述检测单元用于：将待检测视频帧输入至所述训练好的目标检测网络，得到所述待检测视频帧的目标检测结果。8.根据权利要求7所述的运动舰船检测系统，其特征在于，所述处理单元具体用于：对所述任一第一视频帧进行线性平滑滤波处理，得到所述任一第一视频帧的第一特征数据；对所述任一第一视频帧进行Gabor特征提取，得到所述任一第一视频帧的第二特征数据；对所述任一第一视频帧进行灰度处理，得到所述任一的第三特征数据；对所述任一第一视频帧的第一特征数据、第二特征数据和第三特征数据进行通道拼接，得到所述任一第一视频帧对应的第二视频帧。9.一种存储介质，其特征在于，所述存储介质中存储有指令，当计算机读取所述指令时，使所述计算机执行如权利要求1至6中任一项所述的运动舰船检测方法。10.一种电子设备，包括存储器、处理器及存储在所述存储器上并在所述处理器上运行的程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至6任一项所述的运动舰船检测方法的步骤。
说明书desc
技术领域本发明设计视频处理技术领域，尤其涉及一种运动舰船检测方法、系统、存储介质和电子设备。背景技术卫星视频可以对大范围区域连续成像，实现对热点区域和目标的动态实时监测，围绕卫星视频的智能处理与分析成为遥感领域的研究热点。在目标检测领域，以深度学习为代表的先进智能算法取得了远超传统方法的效果，逐渐成为主流。而深度学习这类数据驱动型算法，其检测效果严重依赖于标注数据的数量和质量。受限卫星视频公开数据少，运动目标稀疏，特征不显著，逐帧实例标注代价大等原因，难以大规模标注，无法支撑训练获取泛化性的检测器，模型容易存在过拟合或者欠拟合的问题。因此，对于卫星视频运动目标检测，基于弱监督学习等低标注成本的方法具有更强的实用性。基于弱监督学习的卫星视频目标检测是指仅借助视频中存在何种运动目标类别这一先验信息，无需依赖运动目标的实例级标注，利用视频中运动目标位置及特征连续性的特点，实现对目标的定位和识别。目前弱监督学习的卫星视频运动目标检测主要分为基于传统的方法和基于深度学习的方法。由于公开的卫星视频数据量少，难以满足深度学习模型训练的样本需求。因此，当前面向卫星视频的目标检测仍以传统方法为主，基于深度学习的方法尤其面向弱监督的方法极其有限。从检测方法上，传统的卫星视频运动目标检测采用非端到端的方式，需要在提取卫星视频运动前景的基础上进行复杂的处理或规则判断，计算过程耗费时间较长，无法做到卫星视频的实时性检测。基于深度学习的方法虽然可以直接利用训练后的模型进行快速推理应用，但受限弱监督条件下的伪标签样本质量问题，难以保证检测结果的准确度。弱监督条件下的卫星视频运动舰船检测存在的挑战和困难主要体现在目标类内差异大、外观视觉特征复杂，并且基于视频运动信息提取的目标前景包含大量的噪声干扰，现有的技术方案较难同时兼顾检测精度与效率，以满足卫星视频运动舰船有效、实时检测的应用需求。因此，亟需提供一种技术方案解决上述问题。发明内容为解决上述技术问题，本发明提供了一种运动舰船检测方法、系统、存储介质和电子设备。本发明的一种运动舰船检测方法的技术方案如下：对每个包含运动舰船的第一视频帧分别进行增强处理，得到多个第二视频帧，并利用混合高斯模型，获取每个第二视频帧的伪标签样本；将每个第二视频帧的伪标签样本分别作为相应第一视频帧的伪标签样本，并基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络；将待检测视频帧输入至所述训练好的目标检测网络，得到所述待检测视频帧的目标检测结果。本发明的一种运动舰船检测方法的有益效果如下：本发明的方法通过利用生成的伪标签样本，进行目标检测网络的模型训练，提高了在弱监督条件下的运动舰船的检测效率的同时，还提高了运动舰船检测精度。在上述方案的基础上，本发明的一种运动舰船检测方法还可以做如下改进。进一步，对任一第一视频帧进行增强处理，得到该第一视频帧对应的第二视频帧的步骤包括：对所述任一第一视频帧进行线性平滑滤波处理，得到该第一视频帧的第一特征数据；对所述任一第一视频帧进行Gabor特征提取，得到该第一视频帧的第二特征数据；对所述任一第一视频帧进行灰度处理，得到该第一视频帧的第三特征数据；对所述任一第一视频帧的第一特征数据、第二特征数据和第三特征数据进行通道拼接，得到该第一视频帧对应的第二视频帧。采用上述进一步技术方案的有益效果是：通过提取卫星视频帧中的运动舰船的显著融合特征，提升了伪标签样本的质量。进一步，基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络的步骤，包括：将每个第一视频帧及相应的伪标签样本分别输入至所述预设目标检测网络，得到每个第一视频帧的训练损失值；基于所有的训练损失值，对所述预设目标检测网络进行优化，得到优化后的目标检测网络，并将所述优化后的目标检测网络作为所述预设目标检测网络并返回执行所述将每个第一视频帧及相应的伪标签样本分别输入至所述预设目标检测网络的步骤，直至满足预设训练条件时，将所述优化后的目标检测网络确定为所述训练好的目标检测网络。进一步，所述预设目标检测网络包括：骨干网络、特征金字塔网络、区域生成网络、感兴趣区域对齐模块、感兴趣区域特征提取器、目标分类分支、目标回归分支和目标掩码分支；将所述任一第一视频帧及相应的伪标签样本输入至所述预设目标检测网络，得到该第一视频帧的训练损失值的步骤，包括：将所述任一第一视频帧输入至所述骨干网络进行处理，得到该第一视频帧的多个不同层级的特征图；将所述任一第一视频帧的多个不同层级的特征图输入至所述特征金字塔网络进行多尺度特征融合，得到该第一视频帧的融合特征图；将所述任一第一视频帧的融合特征图输入至所述区域生成网络，得到该第一视频帧的包含运动舰船所在区域的目标建议框；将所述任一视频帧的融合特征图和目标建议框输入至所述感兴趣区域对齐模块，并依次通过所述感兴趣区域对齐模块和所述感兴趣区域特征提取器进行处理，得到该视频帧的目标建议框特征图；将所述任一视频帧的目标建议框特征图输入至所述目标分类分支，得到该视频帧的预测分类概率；将所述任一视频帧的目标建议框特征图输入至所述目标回归分支，得到该视频帧的目标建议框的参数化坐标预测值；将所述任一视频帧的目标建议框特征图输入至所述目标掩码分支，得到该视频帧的包含运动舰船的目标预测掩码；基于所述任一第一视频帧的伪标签样本、预测分类概率、参数化坐标预测值和目标预测掩码，得到该第一视频帧的训练损失值。进一步，所述目标掩码分支包括：改进的Mask Head分支和目标边界保持映射模块；其中，所述改进的Mask Head分支的构建过程为：在包含有多个高分辨率掩码分支的原始Mask Head分支上添加至少一个低分辨率掩码分支，得到所述改进的Mask Head分支；所述目标边界保持映射模块用于：基于边界保持映射关系，对所述改进的Mask Head分支输出的原始预测掩码进行处理，得到目标预测掩码；所述边界保持映射关系为：BPM＝▽2，BPM表示所述目标边界保持映射的目标预测掩码，pij表示每个像素对应的掩码概率输出值，表示对pij进行sigmoid激活运算，▽2表示拉普拉斯算子运算。进一步，基于所述任一第一视频帧的伪标签样本、预测分类概率、参数化坐标预测值和目标预测掩码，得到该第一视频帧的训练损失值的步骤，包括：获取所述任一第一视频帧的伪标签样本的参数化坐标伪标签值和伪标签掩码，并将该第一视频帧的参数化坐标伪标签值、伪标签掩码、预测分类概率、参数化坐标预测值和目标预测掩码代入目标损失函数，得到该第一视频帧的训练损失值；其中，所述目标损失函数为：L＝Lcls+Lreg+Lmask；L表示该第一视频帧的训练损失值，Lcls表示该第一视频帧的分类损失值，Lreg表示该第一视频帧的回归损失值，Lmask表示该第一视频帧的掩码损失值；ki为该第一视频帧的第i个目标建议框的预测分类概率，当第i个目标建议框是正样本时，/＞当第i个目标建议框是负样本时，Ncls为mini-batch size，/＞表示对/＞的二分类log损失；σj为该第一视频帧的伪标签样本的标注框回归一致性判别，/＞j表示该第一视频帧的伪标签样本的目标框的索引，/＞表示该第一视频帧的第i个目标建议框与索引为j的伪标签样本的目标框之间的IoU值，N表示该第一视频帧的正例候选框的数量，reg表示目标建议框的参数化坐标预测值，REG表示伪标签样本的参数化坐标伪标签值，m2为预测掩码的尺寸，ypq为该第一视频帧的像素对应的伪标签样本的伪标签掩码，/＞为该第一视频帧的像素对应的目标预测掩码。本发明的一种运动舰船检测系统的技术方案如下：包括：处理单元、训练单元和检测单元；所述处理单元用于：对每个包含运动舰船的第一视频帧分别进行增强处理，得到多个第二视频帧，并利用混合高斯模型，获取每个第二视频帧的伪标签样本；所述训练单元用于：将每个第二视频帧的伪标签样本分别作为相应第一视频帧的伪标签样本，并基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络；所述检测单元用于：将待检测视频帧输入至所述训练好的目标检测网络，得到所述待检测视频帧的目标检测结果。本发明的一种运动舰船检测系统的有益效果如下：本发明的系统通过利用生成的伪标签样本，进行目标检测网络的模型训练，提高了在弱监督条件下的运动舰船的检测效率的同时，还提高了运动舰船检测精度。在上述方案的基础上，本发明的一种运动舰船检测系统还可以做如下改进。进一步，所述处理单元具体用于：对所述任一第一视频帧进行线性平滑滤波处理，得到所述任一第一视频帧的第一特征数据；对所述任一第一视频帧进行Gabor特征提取，得到所述任一第一视频帧的第二特征数据；对所述任一第一视频帧进行灰度处理，得到所述任一的第三特征数据；对所述任一第一视频帧的第一特征数据、第二特征数据和第三特征数据进行通道拼接，得到所述任一第一视频帧对应的第二视频帧。采用上述进一步技术方案的有益效果是：通过提取卫星视频帧中的运动舰船的显著融合特征，提升了伪标签样本的质量。本发明的一种存储介质的技术方案如下：存储介质中存储有指令，当计算机读取所述指令时，使所述计算机执行如本发明的一种运动舰船检测方法的步骤。本发明的一种电子设备的技术方案如下：包括存储器、处理器及存储在所述存储器上并在所述处理器上运行的程序，其特征在于，所述处理器执行所述程序时实现如本发明的一种运动舰船检测方法的步骤。附图说明图1示出了本发明提供的一种运动舰船检测方法的实施例的流程示意图；图2示出了本发明提供的一种运动舰船检测方法的实施例的整体框架图；图3示出了本发明提供的一种运动舰船检测方法的实施例中的目标回归分支的原理示意图；图4示出了本发明提供的一种运动舰船检测方法的实施例中的改进的Mask Head分支的结构示意图；图5示出了本发明提供的一种运动舰船检测系统的实施例的结构示意图。具体实施方式图1示出了本发明提供的一种运动舰船检测方法的实施例的流程示意图。如图1所示，包括如下步骤：步骤110：对每个包含运动舰船的第一视频帧分别进行增强处理，得到多个第二视频帧，并利用混合高斯模型，获取每个第二视频帧的伪标签样本。其中，①第一视频帧为：包含运动舰船的卫星视频的原始视频帧。②第二视频帧为：经过不同尺度的增强处理并经过特征融合后所得到的视频帧。③混合高斯模型用于生成视频帧对应的伪标签样本。④伪标签样本为：包含运动舰船的伪标签样本。需要说明的是，①利用高斯混合模型构建每个第二视频帧的伪标签样本的具体过程为现有技术，在此不过多赘述。②由于卫星视频存在背景移动、海面碎浪与光照变化等伪运动影响，且运动舰船的目标外轮廓与尾迹混淆难以分离，直接对原始卫星视频帧进行运动前景提取，获取的运动舰船的伪标签样本的质量较差，无法引导后续网络学习准确的运动舰船目标特征。因此通过对第一视频帧进行多种不同尺度的增强处理，突出表达卫星视频帧中的运动舰船的显著融合特征。步骤120：将每个第二视频帧的伪标签样本分别作为相应第一视频帧的伪标签样本，并基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络。其中，①第一视频帧、第二视频帧和伪标签样本的对应关系为：第一视频帧→第二视频帧→伪标签样本，且均为一对一。当获取到任一第二视频帧的伪标签样本时，该伪标签样本同样作为第二视频帧对应的第一视频帧的样本。②预设目标检测网络为：用于对运动舰船进行目标检测的深度学习网络。③训练好的目标检测网络为：经过大量第一视频帧和相应伪标签进行训练所得到的用于对运动舰船进行目标检测的深度学习网络。步骤130：将待检测视频帧输入至所述训练好的目标检测网络，得到所述待检测视频帧的目标检测结果。其中，待检测视频帧为：任意选取的卫星视频帧，该视频帧可以是包含运动舰船的视频帧，也可以是不包含运动舰船的视频帧。②目标检测结果为：待检测视频帧中是否包含运动舰船的检测结果。较优地，对任一第一视频帧进行增强处理，得到该第一视频帧对应的第二视频帧的步骤包括：对所述任一第一视频帧进行线性平滑滤波处理，得到该第一视频帧的第一特征数据。具体地，为了在视频场景级尺度上过滤背景移动、光照变化等带来的影响，利用高斯函数对任一第一视频帧进行卷积运算，通过对该第一视频帧进行线性平滑滤波处理，以缓解该第一视频帧的背景干扰，突出移动舰船目标运动变化的区域，得到该第一视频帧的第一特征数据。该第一视频帧的每个像素点的具体计算如下：表示该第一视频帧的像素点的横纵坐标，σ为标准差)；通过对该第一视频帧的每个像素点进行计算，得到该第一视频帧的第一特征数据。对所述任一第一视频帧进行Gabor特征提取，得到该第一视频帧的第二特征数据。具体地，为了在运动舰船的局部尺度上突出表达舰船的纹理特征和边缘信息，采用Gabor滤波器对任一第一视频帧进行逐帧处理，获取该第一视频帧中的运动舰船的最优局部特征：其中，λ表示余弦因子的波长，θ表示Gabor函数法线到平行条纹的方向，ψ表示相位偏移，σ为高斯滤波器的方差，γ为空间横纵比。对所述任一第一视频帧进行灰度处理，得到该第一视频帧的第三特征数据。具体地，为了避免经过线性平滑滤波和Gabor特征提取过程中对原始信卫星视频信息的破坏，对所述任一第一视频帧的RGB图像进行灰度处理，以保留该第一视频帧中的像素级细节信息，得到该第一视频帧的第三特征数据。对所述任一第一视频帧的第一特征数据、第二特征数据和第三特征数据进行通道拼接，得到该第一视频帧对应的第二视频帧。具体地，对所述任一第一视频帧进行上述不同尺度信息处理，将处理后的三种特征进行通道拼接，替换原始的第一视频帧的RGB三通道，合成得到该第一视频帧对应的第二视频帧。较优地，基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络的步骤，包括：将每个第一视频帧及相应的伪标签样本分别输入至所述预设目标检测网络，得到每个第一视频帧的训练损失值。基于所有的训练损失值，对所述预设目标检测网络进行优化，得到优化后的目标检测网络，并将所述优化后的目标检测网络作为所述预设目标检测网络并返回执行所述将每个第一视频帧及相应的伪标签样本分别输入至所述预设目标检测网络的步骤，直至满足预设训练条件时，将所述优化后的目标检测网络确定为所述训练好的目标检测网络。其中，预设训练条件为：达到最大训练迭代次数或损失值收敛。较优地，所述预设目标检测网络包括：骨干网络、特征金字塔网络、区域生成网络、感兴趣区域对齐模块、感兴趣区域特征提取器、目标分类分支、目标回归分支和目标掩码分支。具体地，如图2所示，预设目标检测网络以Mask R-CNN为基础框架，主要由骨干网络、特征金字塔网络、区域生成网络、感兴趣区域对齐模块、感兴趣区域特征提取器、目标分类分支、目标回归分支以及目标掩码分支组成。将所述任一第一视频帧及相应的伪标签样本输入至所述预设目标检测网络，得到该第一视频帧的训练损失值的步骤，包括：将所述任一第一视频帧输入至所述骨干网络进行处理，得到该第一视频帧的多个不同层级的特征图。其中，采用ResNet-50作为骨干网络，用于对第一视频帧进行卷积、激活、池化等操作。具体地，以ResNet-50作为骨干网络，任一第一视频帧经过特征提取后，可得到4个不同层级的特征图，对应特征图的分辨率依次为原始图片的1/4,1/8,1/16,1/32，通道数依次为256，512，1024，2048。以网络输入尺寸为224×224×3为例，对应多个不同层级的特征图尺寸分别为56×56×256、28×28×512、14×14×1024、7×7×2048。将所述任一第一视频帧的多个不同层级的特征图输入至所述特征金字塔网络进行多尺度特征融合，得到该第一视频帧的融合特征图。具体地，将任一第一视频帧的多个不同层级的特征图输入至所述特征金字塔网络，多个不同层级的特征图先通过自下而上的方式组成特征金字塔，再自上而下依次对金字塔各层的特征图进行2倍的上采样，最后对金字塔网络各层特征进行横向连接，以完成特征融合，得到该第一视频帧的融合特征图。需要说明的是，多尺度融合后的特征不仅具有高分辨率的浅层特征，还具有丰富语义信息的深层特征。将所述任一第一视频帧的融合特征图输入至所述区域生成网络，得到该第一视频帧的包含运动舰船所在区域的目标建议框。具体地，将任一第一视频帧的融合特征图输入至区域生成网络，区域生成网络通过一个3×3的卷积对融合特征图进行滑窗，通过计算每个滑窗的9个不同尺寸和比例的Anchor和标注样本的相对关系来确定候选区域的类别和位置。将所述任一视频帧的融合特征图和目标建议框输入至所述感兴趣区域对齐模块，并依次通过所述感兴趣区域对齐模块和所述感兴趣区域特征提取器进行处理，得到该视频帧的目标建议框特征图。具体地，将任一视频帧的融合特征图和目标建议框输入值感兴趣区域对其模块，特征金字塔网络的每一特征层都会添加一个区域生成网络的输出头。因为RPN的输出头有多个尺度，而FPN的每一层的特征图都有其自己的感受野，所以这里是为FPN的每一个输出都固定一个尺度，每个尺度有3个不同的比例。网络中Anchor的面积依次为32×32、64×64、128×128、256×256、512×512，每个Anchor有三组比例，分别是1:1，1:2和2:1。感兴趣区域对齐模块通过双线性内插的方法获得坐标为浮点数的像素点上的图像数值，从而使得每个RoI取得的特征能更好的对齐原图上的RoI区域，RoI Align通过将任意大小的RoI对齐到固定大小的特征图上，以保证感兴趣区域特征提取器提取的目标建议框特征图尽可能精确。将所述任一视频帧的目标建议框特征图输入至所述目标分类分支，得到该视频帧的预测分类概率。具体地，将任一视频帧的目标建议框特征图至目标分类分支，以通过目标分类分支的全连接层和Softmax函数，计算该第一视频帧的各个目标建议框具体是否属于移动舰船，输出为预测分类概率，以实现对移动舰船的判断。、将所述任一视频帧的目标建议框特征图输入至所述目标回归分支，得到该视频帧的目标建议框的参数化坐标预测值。具体地，为保证设定的目标建议框能以最佳的形态框住目标，将任一视频帧的目标建议框特征图输入至目标回归分支，以通过目标回归分支对目标建议框位置进行回归，得到目标建议框的位置偏移量，并根据位置偏移量对伪标签样本的目标框进行修正，得到该视频帧的目标建议框的参数化坐标预测值。以图3为例，Anchor为目标建议框，计算Anchor与伪标签样本的目标框的中心点偏移量、宽和高调整比例，并以此偏移量为监督信息进行回归训练，以此得到该视频帧的修正后的目标建议框的参数化坐标预测值。将所述任一视频帧的目标建议框特征图输入至所述目标掩码分支，得到该视频帧的包含运动舰船的目标预测掩码。具体地，将任一视频帧的目标建议框特征图输入至目标掩码分支，通过一系列的卷积和转置卷积操作，对RoI特征进行非线性变换，同时将特征映射到更高分辨率的特征空间尺寸上，最终输出该视频帧的包含运动舰船的目标预测掩码。需要说明的是，目标预测掩码是由浮点数表示的软掩码，相对于二进制的掩码有更多的细节。基于所述任一第一视频帧的伪标签样本、预测分类概率、参数化坐标预测值和目标预测掩码，得到该第一视频帧的训练损失值。较优地，所述目标掩码分支包括：改进的Mask Head分支和目标边界保持映射模块；所述改进的Mask Head分支的构建过程为：在包含有多个高分辨率掩码分支的原始Mask Head分支上添加至少一个低分辨率掩码分支，得到所述改进的Mask Head分支。具体地，如图4所示，展示了RoI特征在改进的Mask Head分支上的具体计算流程，每个特征均用数字表示其空间分辨率和通道数。不同特征间的运算主要有卷积和反卷积两种操作，图中以不同箭头标识。其中，卷积运算均采用3×3的卷积核，反卷积操作的则为2×2的卷积核。高分辨率和低分辨率两个分支上的特征变换到尺寸为28×28的相同空间分辨率下进行特征拼接，最终输出为28×28×1的掩码。通过在Mask R-CNN的原始Mask Head分支上添加更低分辨率的掩码预测分支，以更小尺寸的目标掩码为监督信息，鉴于更小的尺寸和更低的分辨率，其包含的特征更为纯净，可获取到关于目标更准确的信息，受伪标签的边界噪声干扰也更少，相比原始Mask R-CNN网络更适用于基于弱监督学习的卫星视频运动目标检测任务。然而，由于该分支的特征分辨率较低，导致预测的分割结果会比较粗糙，难以获取目标的特征细节，因此原网络中的高分辨率Mask Head依然保留。需要说明的是，①对于Mask R-CNN，目标掩码的真值通常被降尺度到28×28大小，当尺寸进一步缩小时，由于分辨率更低，其细节特征就会被掩盖，而噪声就主要存在于这些细节中。随着样本掩码在网络逐级特征提取过程中不断缩减尺寸，样本掩码与目标区域的IoU会明显提升，因此缩小掩码的尺寸可提升伪标签的质量，尤其可以降低靠近目标边界区域的噪声影响。②高分辨率掩码分支更容易受到噪声的影响，但可用于学习目标的细节信息，而低分辨率掩码分支可以学习目标粗糙但纯净的特征信息，因此设计的改进的MaskHead分支，通过融合纯净的粗糙特征和带噪声的细节信息，能够让网络实现更耐噪声的目标特征学习。对于模型推理测试阶段，网络仅保留高分辨率掩码分支。所述目标边界保持映射模块用于：基于边界保持映射关系，对所述改进的MaskHead分支输出的原始预测掩码进行处理，得到目标预测掩码。其中，所述边界保持映射关系为：BPM＝▽2，BPM表示所述目标边界保持映射的目标预测掩码，pij表示每个像素对应的掩码概率输出值，表示对pij进行sigmoid激活运算，▽2表示拉普拉斯算子运算。需要说明的是，目标边界保持映射模块通过二阶微分推导出的目标边界增强后的结果。当邻域的中心像素灰度低于它所在邻域内的其他像素的平均灰度时，此中心像素的灰度应该进一步降低；当高于时进一步提高中心像素的灰度，从而保持目标边界的完整性。在算法实现过程中，通过对邻域中心像素的四方向或八方向求梯度，并将梯度和相加来判断中心像素灰度与邻域内其他像素灰度的关系，并用梯度运算的结果对像素灰度进行调整。当邻域内像素灰度相同时，模板的卷积运算结果为0；当中心像素灰度高于邻域内其他像素的平均灰度时，模板的卷积运算结果为正数；当中心像素的灰度低于邻域内其他像素的平均灰度时，模板的卷积的负数。对卷积运算的结果用适当的衰弱因子处理并加在原中心像素上，就可以实现过滤目标特征中错误定位的背景。较优地，基于所述任一第一视频帧的伪标签样本、预测分类概率、参数化坐标预测值和目标预测掩码，得到该第一视频帧的训练损失值的步骤，包括：获取所述任一第一视频帧的伪标签样本的参数化坐标伪标签值和伪标签掩码，并将该第一视频帧的参数化坐标伪标签值、伪标签掩码、预测分类概率、参数化坐标预测值和目标预测掩码代入目标损失函数，得到该第一视频帧的训练损失值。其中，所述目标损失函数为：L＝Lcls+Lreg+Lmask；L表示该第一视频帧的训练损失值，Lcls表示该第一视频帧的分类损失值，Lreg表示该第一视频帧的回归损失值，Lmask表示该第一视频帧的掩码损失值；ki为该第一视频帧的第i个目标建议框的预测分类概率，当第i个目标建议框是正样本时，/＞当第i个目标建议框是负样本时，Ncls为mini-batch size，/＞表示对/＞的二分类log损失；σj为该第一视频帧的伪标签样本的标注框回归一致性判别，/＞j表示该第一视频帧的伪标签样本的目标框的索引，/＞表示该第一视频帧的第i个目标建议框与索引为j的伪标签样本的目标框之间的IoU值，N表示该第一视频帧的正例候选框的数量，reg表示目标建议框的参数化坐标预测值，REG表示伪标签样本的参数化坐标伪标签值，m2为预测掩码的尺寸，ypq为该第一视频帧的像素对应的伪标签样本的伪标签掩码，/＞为该第一视频帧的像素对应的目标预测掩码。需要说明的是，①在基于两阶段的深度学习目标检测算法中，正负样本匹配只由网络的候选框和目标真实标注框之间的IoU来决定，大于高阈值的被分配为正样本，小于低阈值的被匹配为负样本。这种分配方式的前提是目标真实标注框一定是准确的。然而在本方案的弱监督检测任务中，伪标签定位信息的准确度是不能得到保证的，对于不精确的伪标签标注框定位信息导致候选框的正负样本匹配错误。由于伪标签的目标框距离真实目标存在定位偏差，因此沿用通用网络的候选框分配策略，会带来较大的累积误差，干扰网络对目标检测框的回归，导致检测框的位置定位不准确。针对该问题，本实施例的技术方案设计候选框一致性判别，基于回归结果的一致性来反映伪标签目标框的定位质量，通过对伪标签目标框的定位精度做出判断，为定位准确的目标框会被分配较大的回归损失权重，反之，就分配小的回归损失权重。从而提高伪标签样本下，检测算法的定位精度。本实施例的目标框回归一致性判别可以得到用于调节检测网络回归分支的一致性因子，可反映每个目标真实框对未知目标回归损失的贡献程度。拥有较低的一致性因子说明伪标签目标框的定位信息可能并不准确，需要降低其对损失计算的贡献值。为更好地说明本实施例的技术方案，采用以下实验过程进行验证：实验数据集：本实施例的技术方案在卫星视频多任务基准数据集SAT-MTB上进行实验，该数据集支持目标检测、目标追踪、目标分割等多个任务，我们抽取数据集中包含运动舰船目标的数据部分开展实验，实验数据包含38段视频，帧率均为10帧/秒，平均时长约22秒，共计8415个第一视频帧，共计包含有23509个移动舰船实例。评价方法：本实施例的技术方案中用于检验算法性能的评价指标精度指标和效率指标。其中精度指标包括：召回率、准确率、F1值、推理时长，具体计算方式如下：其中，TP表示正确检测到的船只的数量，FN和FP分别表示误检和漏检的舰船数量。由于卫星视频中运动舰船的尺寸较小，预测边界框有限的偏移都会导致IoU分数的较大波动，因此本实施例以IoU＝0.5作为目标评测精度的阈值条件。推理时长则统计计算不同算法在相同算力条件下，对于卫星视频测试集进行运动舰船检测推理时总共耗费时长，统计单位为秒。本发明技术方案与现有技术方案进行卫星视频运动检测检测精度实验对比。实验结果如表1所示,本发明技术方案在SAT-MTB数据集上的Precision为0.409，Recall为0.554，F1值为0.471，精度指标上均优于现有的两种技术方案，这说明通过融合运动舰船的显著性特征能够获取更高质量的伪标签样本，基于抗噪声干扰的目标检测网络，模型训练学习过程中，可以抵抗舰船的伪标签样本中边界噪声带来的干扰，实现对运动舰船更准确和精细特征描述。最后通过候选区一致性回归进一步提升目标定位精度。表1：本实施例的技术方案与现有技术方案一的不同在于，本发明技术方案采用端到端的方式，对卫星视频序列帧的显著融合特征构建、运动前景提取等仅用于获取训练阶段的伪标签样本。完成网络训练后，模型可直接面向待测试的原始卫星视频进行快速推理，具有更高的推理效率。因此统计对比运动舰船检测效率实验，比较本发明技术方案和现有技术方案在SAT-MTB测试集上的模型推理时长，定量地分析对卫星视频运动舰船的检测效率，实验结果如表2所示。实验结果表明，本发明技术方案在取得更好的运动舰船检测效果的同时，模型推理耗时更短，检测速度不仅大幅领先于现有技术方案一，也优于现有技术方案二。表2：为验证本发明技术方案中各步骤、模块的作用，设计一组消融实验，通过逐级添加显著融合特征增强、边界耐噪模块以及候选框一致性判别来分析各步骤对卫星视频运动舰船检测精度的影响。消融实验结果见表3。表3：显著特征融合增强处理可以从多种尺度缓解卫星视频背景噪声的干扰，并突出舰船的纹理和边缘信息，对算法检测性能指标的提升帮助最为突出，尤其在过滤伪运动目标误检表现上，Precision提升8.7％，效果显著。目标边界耐噪模块能够优化网络对噪声掩码有效信息的学习，获取更为准确和精细的目标分割表示，进一步提升网络检测结果的Recall和Precision。而候选区一致回归的引入，能够对生成的伪标签目标框的定位精度做出判断，增大定位准确目标框对应的回归损失，进一步提升卫星视频运动舰船的检测精度。其中边界耐噪模块和目标候选区一致性判别对于检测结果F1指标的贡献相当。本实施例的技术方案通过提取卫星视频帧中的运动舰船的显著融合特征，提升了伪标签样本的质量；并通过利用生成的伪标签样本，进行目标检测网络的模型训练，提高了在弱监督条件下的运动舰船的检测效率的同时，还提高了运动舰船检测精度。图5示出了本发明提供的一种运动舰船检测系统的实施例的结构示意图。如图5所示，该系统200包括：处理单元210、训练单元220和检测单元230。所述处理单元210用于：对每个包含运动舰船的第一视频帧分别进行增强处理，得到多个第二视频帧，并利用混合高斯模型，获取每个第二视频帧的伪标签样本；所述训练单元220用于：将每个第二视频帧的伪标签样本分别作为相应第一视频帧的伪标签样本，并基于每个第一视频帧及相应的伪标签样本，对用于运动舰船检测的预设目标检测网络进行训练，得到训练好的目标检测网络；所述检测单元230用于：将待检测视频帧输入至所述训练好的目标检测网络，得到所述待检测视频帧的目标检测结果。较优地，所述处理单元210具体用于：对所述任一第一视频帧进行线性平滑滤波处理，得到所述任一第一视频帧的第一特征数据；对所述任一第一视频帧进行Gabor特征提取，得到所述任一第一视频帧的第二特征数据；对所述任一第一视频帧进行灰度处理，得到所述任一的第三特征数据；对所述任一第一视频帧的第一特征数据、第二特征数据和第三特征数据进行通道拼接，得到所述任一第一视频帧对应的第二视频帧。本实施例的技术方案通过提取卫星视频帧中的运动舰船的显著融合特征，提升了伪标签样本的质量；并通过利用生成的伪标签样本，进行目标检测网络的模型训练，提高了在弱监督条件下的运动舰船的检测效率的同时，还提高了运动舰船检测精度。上述关于本实施例的一种运动舰船检测系统200中的各参数和各个模块实现相应功能的步骤，可参考上文中关于一种运动舰船检测方法的实施例中的各参数和步骤，在此不做赘述。本发明实施例提供的一种存储介质，包括：存储介质中存储有指令，当计算机读取所述指令时，使所述计算机执行如一种运动舰船检测方法的步骤，具体可参考上文中的一种运动舰船检测方法的实施例中的各参数和步骤，在此不做赘述。计算机存储介质例如：优盘、移动硬盘等。本发明实施例提供的一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时，使所述计算机执行如一种运动舰船检测方法的步骤，具体可参考上文中的一种运动舰船检测方法的实施例中的各参数和步骤，在此不做赘述。所属技术领域的技术人员知道，本发明可以实现为方法、系统、存储介质和电子设备。因此，本发明可以具体实现为以下形式，即：可以是完全的硬件、也可以是完全的软件，还可以是硬件和软件结合的形式，本文一般称为“电路”、“模块”或“系统”。此外，在一些实施例中，本发明还可以实现为在一个或多个计算机可读介质中的计算机程序产品的形式，该计算机可读介质中包含计算机可读的程序代码。可以采用一个或多个计算机可读的介质的任意组合。计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质。计算机可读存储介质例如可以是但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机存取存储器，只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本文件中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。尽管上面已经示出和描述了本发明的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本发明的限制，本领域的普通技术人员在本发明的范围内可以对上述实施例进行变化、修改、替换和变型。
