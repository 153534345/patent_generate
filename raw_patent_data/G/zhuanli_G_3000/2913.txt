标题title
一种基于多模态特征融合的乳腺结节分类方法、设备及存储介质
摘要abst
本发明涉及图像处理技术领域，具体涉及一种基于多模态特征融合的乳腺结节分类方法、设备及存储介质，包括如下步骤：将需要处理的原始乳腺全容积图像，包括横断面、矢状面、冠状面图像统一处理成512*512大小的图像，并送入分割网络对乳腺结节进行分割；将分割后的图片使用图像处理算法调整至原始图像大小，并使用图像处理算法识别乳腺结节与正常组织的边界并将乳腺结节轮廓外接矩形图像进行裁剪和保存；将得到的图像以原始图像的宽高比统一处理为224*224大小的图像，并送入多模态特征融合网络进行特征提取并计算特征相似度；经过Softmax函数输出每个类别的概率，本发明有效提高了乳腺结节图像分类预测的准确性和鲁棒性。
权利要求书clms
1.一种基于多模态特征融合的乳腺结节分类方法，其特征在于，包括如下步骤：S1.将需要处理的原始乳腺全容积图像，包括横断面、矢状面、冠状面图像统一处理成512*512大小的图像，并统一送入分割网络对乳腺结节进行分割；S2.基于步骤S1，将分割后的图片使用图像处理算法调整至原始图像大小，并使用图像处理算法识别乳腺结节与正常组织的边界并将乳腺结节轮廓外接矩形图像进行裁剪和保存得到横断面、矢状面和冠状面的乳腺结节图像；S3.基于步骤S2，将得到的横断面、矢状面和冠状面的乳腺结节图像以原始图像的宽高比统一处理为224*224大小的图像，并送入多模态特征融合网络进行特征提取并计算特征相似度；S4.基于步骤S3，根据得出的特征相似度经过Softmax函数输出每个类别的概率，公式为：其中，C为要分类的个数，i为第i个类别，zi表示这个类别的概率值，e为自然指数，其值约为2.7182818459，表示对zi做指数运算。2.根据权利要求1所述的一种基于多模态特征融合的乳腺结节分类方法，其特征在于：步骤S1中的分割网络为以efficientnet-b0网络作为特征提取的U-net分割网络。3.根据权利要求1所述的一种基于多模态特征融合的乳腺结节分类方法，其特征在于：步骤S3中多模态特征融合网络进行特征提取的方法为：S31.将处理后的横断面、矢状面和冠状面的乳腺结节图像分别送入对应的Resnet50网络进行特征提取，分别得到横断面、矢状面和冠状面的乳腺结节特征图；S32.基于步骤S31，将横断面和矢状面的特征图采用add方式进行融合，公式为：其中，Zadd为横断面和矢状面融合之后的特征图，n为特征图第n个通道，m为特征图的通道数，X为横断面的特征，Y为矢状面的特征图，K为特征融合之后要进行的卷积运算；S33.基于步骤S32，将横断面与矢状面融合后的特征图再与冠状面的特征图采用concat方式进行融合，公式为：其中，Zconcat为Zadd和冠状面特征融合后的特征图，n为特征图第n个通道，m为特征图的通道数，G为冠状面的特征图，K为特征融合之后要进行的卷积运算。4.根据权利要求3所述的一种基于多模态特征融合的乳腺结节分类方法，其特征在于：三个Resnet50网络之间权重不共享。5.根据权利要求1所述的一种基于多模态特征融合的乳腺结节分类方法，其特征在于：计算特征相似度的步骤为：在分类网络中设置两个全连接网络，将提取后的特征依次送入第一个全连接网络和第二个全连接网络，第一个特征网络用于将不同的特征组合输出，第二个全连接网络进一步对特征进行选择组合并计算特征相似度。6.根据权利要求1所述的一种基于多模态特征融合的乳腺结节分类方法，其特征在于：步骤还包括：使用同一乳腺结节不同面的多张图片均执行步骤S1至步骤S4，分别得出多张图片中每张图片对应的多个类别的概率，对得到的类别概率进行相加并得出每个类别的平均值，选定概率均值最大的类别为最终分类预测结果。7.一种电子设备，其特征在于，包括处理器、存储器及存储在所述存储器上并可用在所述处理器上运行的控制程序，所述控制程序被所述处理器执行时实现如权利要求1-6中任一项所述的乳腺结节分类方法。8.一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如权利要求1-6任一项所述的乳腺结节分类方法。
说明书desc
技术领域本发明涉及图像处理技术领域，具体涉及一种基于多模态特征融合的乳腺结节分类方法、设备及存储介质。背景技术在世界范围内，乳腺癌以其高发病率、高死亡率严重威胁女性身体健康，且近年来乳腺癌新增病例持续上升。因其发病机理不确定性和病情隐匿，使得早期乳腺癌很难被发现。在城市中，乳腺癌已经成为女性死亡率增长速度最快的癌症之一。2020年全球女性癌症死亡442.9万例，占总数的44％，其中乳腺癌症68万，占女性癌症死亡总数15.5％。目前有关乳腺癌的发病原因尚没有统一的认识，所以全面综合地对乳腺癌进行了解和研究已经成为医工学界急需解决的问题。近些年也有大量学者就乳腺癌领域进行了大量的工作，取得了相当重要的研究成果，同时根据相关研究数据表明，乳腺癌早期发现，早期治疗对降低乳腺癌的发病率和死亡率具有十分重要的意义。而随着机器学习的发展，近年来通过深度学习进行病灶图片分类帮助医生决策，也成为了机器学习研究领域的一大热点，而现有技术中对超声乳腺结节的检测方法大多基于单模态图像，这使得在进行图片处理分类预测时出现准确性较低的问题。发明内容本发明的目的是提供一种基于多模态特征融合的乳腺结节分类方法、设备及存储介质，通过深度学习技术对乳腺自动全容积图像的结节进行分割，并提取乳腺结节图像，再使用多模态分类网络对横断面、矢状面、冠状面进行特征提取和特征融合，有效提高了乳腺结节图像分类预测的准确性、鲁棒性和泛化能力。为实现上述目的，本发明提供了如下的技术方案：第一方面，本发明提供了一种基于多模态特征融合的乳腺结节分类方法，包括如下步骤：S1.将需要处理的原始乳腺全容积图像，包括横断面、矢状面、冠状面图像统一处理成512*512大小的图像，并统一送入分割网络对乳腺结节进行分割；S2.基于步骤S1，将分割后的图片使用图像处理算法调整至原始图像大小，并使用图像处理算法识别乳腺结节与正常组织的边界并将乳腺结节轮廓外接矩形图像进行裁剪和保存得到横断面、矢状面和冠状面的乳腺结节图像；S3.基于步骤S2，将得到的横断面、矢状面和冠状面的乳腺结节图像以原始图像的宽高比统一处理为224*224大小的图像，并送入多模态特征融合网络进行特征提取并计算特征相似度；S4.基于步骤S3，根据得出的特征相似度经过Softmax函数输出每个类别的概率，公式为：其中，C为要分类的个数，i为第i个类别，zi表示这个类别的概率值，e为自然指数，其值约为2.7182818459，表示对zi做指数运算。优选的，为了避免网络层数扩增导致模型拟合能力的退化，分割网络为以efficientnet-b0网络作为特征提取的U-net分割网络。进一步的，步骤S3中多模态特征融合网络进行特征提取并计算特征相似度的方法为：S31.将处理后的横断面、矢状面和冠状面的乳腺结节图像分别送入对应的Resnet50网络进行特征提取，分别得到横断面、矢状面和冠状面的乳腺结节特征图；S32.基于步骤S31，将横断面和矢状面的特征图采用add方式进行融合，公式为：其中，Zadd为横断面和矢状面融合之后的特征图，n为特征图第n个通道，m为特征图的通道数，X为横断面的特征，Y为矢状面的特征图，K为特征融合之后要进行的卷积运算；S33.基于步骤S32，将横断面与矢状面融合后的特征图再与冠状面的特征图采用concat方式进行融合，公式为：其中，Zconcat为Zadd和冠状面特征融合后的特征图，n为特征图第n个通道，m为特征图的通道数，G为冠状面的特征图，K为特征融合之后要进行的卷积运算。优选的，为了使每个网络都可以充分学习每一个面的乳腺结节特征，三个Resnet50网络之间权重不共享。优选的，为了避免一个全连接网络不能有效处理特征向量的问题，计算特征相似度的步骤为：在分类网络中设置两个全连接网络，将提取后的特征依次送入第一个全连接网络和第二个全连接网络，第一个特征网络用于将不同的特征组合输出，第二个全连接网络进一步对特征进行选择组合并计算特征相似度。优选的，为了进一步提高预测的准确性，步骤还包括：使用同一乳腺结节不同面的多张图片均执行步骤S1至步骤S4，分别得出多张图片中每张图片对应的多个类别的概率，对得到的类别概率进行相加并得出每个类别的平均值，选定概率均值最大的类别为最终分类预测结果。第二方面，本发明提供一种电子设备，包括处理器、存储器及存储在所述存储器上并可用在所述处理器上运行的控制程序，所述控制程序被所述处理器执行时实现如第一方面中任一项所述的步骤。第三方面，一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如第一方面中任一项所述的步骤。本发明的有益效果是：1)采用add和concat不同的组合方式对横断面、矢状面、冠状面的特征进行融合，充分有效利用了三个面乳腺结节特征，提高Resnet50网络模型对乳腺结节图像的分类预测能力，有效提高了乳腺结节图像分类预测的准确性。2)通过对乳腺结节下多张图片的预测类别概率采用相加并取平均值，平均值最大的类别则为该结节的类别，有效增加了模型的鲁棒性和泛化能力。3)本发明在分类网络设计了两个全连接网络，以concat方式特征融合后，乳腺结节特征图的通道数增加一倍，原有一个全连接网络不能有效对这些特征向量进行处理，第一个全连层网络可以在一定成程度上将不同的特征组合输出，第二个全连接网络则进一步对特征进行选择组合并计算特征相似度。附图说明附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。在附图中：图1是本发明步骤流程图；图2是本发明乳腺结节分割网络图；图3是本发明乳腺结节多模态特征融合分类网络图。具体实施方式实施例1如图1-3所示，本发明提供了一种基于多模态特征融合的乳腺结节分类方法，包括如下步骤：S1.将需要处理的原始乳腺全容积图像，包括横断面、矢状面、冠状面图像统一处理成512*512大小的图像，并统一送入分割网络对乳腺结节进行分割，分割图片中，白色表示乳腺结节，其余黑色表示正常组织，为了避免网络层数扩增导致模型拟合能力的退化，分割网络为以efficientnet-b0网络作为特征提取的U-net分割网络。S2.基于步骤S1，将分割后的图片使用图像处理算法调整至原始图像大小，并使用图像处理算法识别乳腺结节与正常组织的边界并将乳腺结节轮廓外接矩形图像进行裁剪和保存得到横断面、矢状面和冠状面的乳腺结节图像。S3.基于步骤S2，将得到的横断面、矢状面和冠状面的乳腺结节图像以原始图像的宽高比统一处理为224*224大小的图像，并送入多模态特征融合网络进行特征提取并计算特征相似度；如图3所示，多模态特征融合网络进行特征提取并计算特征相似度的具体方法为：S31.将处理后的横断面、矢状面和冠状面的乳腺结节图像分别送入对应的Resnet50网络进行特征提取，分别得到横断面、矢状面和冠状面的乳腺结节特征图，为了使每个网络都可以充分学习每一个面的乳腺结节特征，三个Resnet50网络之间权重不共享；S32.基于步骤S31，由于乳腺结节横断面和矢状面在成像和语义特征上类似，因此将横断面和矢状面的特征图采用add方式进行融合，在特征通道不变的情况下，将特征图权重加起来，相当于增加了每个维度下的描述信息，提高了多模态特征融合分类网络实时处理的能力，公式为：其中，Zadd为横断面和矢状面融合之后的特征图，n为特征图第n个通道，m为特征图的通道数，X为横断面的特征，Y为矢状面的特征图，K为特征融合之后要进行的卷积运算；S33.基于步骤S32，乳腺全容积的冠状面成像方式不同于横断面和矢状面，且在语义特征上有较为明显的差异，因此将横断面与矢状面融合后的特征图再与冠状面的特征图采用concat方式进行融合，使得每个特征下的信息不增加但通道数翻倍，有助于后续分类网络更好的进行特征选择和组合计算，有效解决乳腺结节单个面语义特征低、高层特征少的问题，提高多模态特征融合分类网络的分类能力，公式为：其中，Zconcat为Zadd和冠状面特征融合后的特征图，n为特征图第n个通道，m为特征图的通道数，G为冠状面的特征图，K为特征融合之后要进行的卷积运算；将concat方式融合后的特征送入分类网络，在分类网络中设置两个全连接网络，将提取后的特征依次送入第一个全连接网络和第二个全连接网络，第一个特征网络用于将不同的特征组合输出，第二个全连接网络进一步对特征进行选择组合并计算特征相似度，使用concat方式进行特征融合之后，乳腺结节特征图的通道数增加一倍，设置两个全连接网络可有效处理特征向量。S4.基于步骤S3，根据得出的特征相似度经过Softmax函数输出每个类别的概率，公式为：其中，C为要分类的个数，i为第i个类别，zi表示这个类别的概率值，e为自然指数，其值约为2.7182818459，表示对zi做指数运算。为了进一步提高预测的准确性，步骤还包括：使用同一乳腺结节不同面的多张图片均执行步骤S1至步骤S4，分别得出多张图片中每张图片对应的多个类别的概率，对得到的类别概率进行相加并得出每个类别的平均值，选定概率均值最大的类别为最终分类预测结果。实施例2本发明提供一种电子设备，包括处理器、存储器及存储在所述存储器上并可用在所述处理器上运行的控制程序，所述控制程序被所述处理器执行时实现如实施例1中任一项所述的步骤。实施例3本发明提供一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如实施例1中任一项所述的步骤。本领域内的技术人员应明白，本发明实施例的实施例可提供为方法、装置、或计算机程序产品。因此，本发明实施例可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明实施例可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
