标题title
一种基于条件概率的水文干旱恢复预估方法
摘要abst
本发明公开了一种基于条件概率的水文干旱恢复预估方法，包括如下步骤：收集统计流域预研究期的水文数据，构建水文干旱异常指数，识别水文干旱事件；确定水文干旱事件恢复时刻，划定水文干旱事件的发展期和恢复期；提取水文干旱事件的发展期时间、缺水量、恢复期时间和恢复水量；选取边缘分布函数计算水文干旱恢复到正常状态时的恢复期时间和恢复水量。本发明的有益效果：通过确定干旱恢复时刻，划分干旱过程，提出水文干旱恢复预估方案，定量给出水文干旱事件恢复所需的时间和水量，提出的以时间和水量作为水文干旱恢复的阈值指标，方便监测并预警预报，具有更强的实用性和可操作性，为实际应用提供便利。
权利要求书clms
1.一种基于条件概率的水文干旱恢复预估方法，其特征在于：包括如下步骤：步骤S1，收集统计流域预研究期的水文数据，构建水文干旱异常指数，识别水文干旱事件；步骤S2，确定水文干旱事件恢复时刻，划定水文干旱事件的发展期和恢复期；步骤S3，基于步骤S2划定的水文干旱事件的发展期和恢复期，提取水文干旱事件的发展期时间、缺水量、恢复期时间和恢复水量；步骤S4，选取边缘分布函数拟合水文干旱特征，建立水文干旱恢复条件概率模型，计算水文干旱恢复到正常状态时的恢复期时间和恢复水量；步骤S2具体为：基于时间的一致性得到水文干旱事件和气象要素序列匹配数据，利用相关性分析对水文干旱事件和气象要素的相关性进行诊断，得到相关性统计量序列，获得相关性统计量序列中统计值最小时刻，见公式所示；；式中：为相关性统计量序列中统计值最小时刻，Hij为第j个水文干旱事件第1时刻到第i时刻的数据序列，Mij为第j个水文干旱事件第1时刻到第i时刻的数据序列Hij对应的气象要素序列，corr表示为求数据序列和气象要素序列的相关性统计量；步骤S3，具体为：基于步骤S2划定的水文干旱事件的发展期和恢复期，统计水文干旱事件的干旱发展期时间和干旱恢复期时间如公式、所示；；；式中：D1为水文干旱事件的干旱发展期时间，D2为水文干旱事件的干旱恢复期时间，t1为水文干旱事件开始时刻，te为水文干旱事件结束时刻。2.根据权利要求1所述的一种基于条件概率的水文干旱恢复预估方法，其特征在于：步骤S2中，判断并标识每一次水文干旱事件的相关性统计量序列中统计值最小时刻，划定发展期和恢复期的时间点，将相关性统计量序列中统计值最小时刻/＞干旱过程前定义为干旱发展期，将相关性统计量序列中统计值最小时刻/＞干旱过程后定义为干旱恢复期，其中数据序列为水文干旱期间不同时期干旱强度组成的序列，气象要素序列为水文干旱期间不同时期气象要素组成的序列。3.根据权利要求2所述的一种基于条件概率的水文干旱恢复预估方法，其特征在于：步骤S3中，当时，水文干旱事件的发展期缺水量如公式所示；；式中，WD为水文干旱事件的发展期缺水量，Si为i时刻干旱强度，Si-1为i-1时刻干旱强度；当时，水文干旱事件的恢复期恢复水量如公式所示； ；式中，RW为水文干旱事件的恢复期恢复水量，为水文干旱事件结束时刻te的干旱强度，/＞为水文干旱事件截取阈值。4.根据权利要求1所述的一种基于条件概率的水文干旱恢复预估方法，其特征在于：步骤S1中收集统计流域预研究期的水文数据，构建水文干旱异常指数，具体为：收集统计流域预研究期的长时间序列n年的水文数据，剔除闰年2月29日径流量数据，将每年径流量数据从1到365依次排列，计算日时间尺度的水文干旱异常指数如公式所示；；式中：为第n年的水文干旱异常指数，/＞为第1年第1日径流量，/＞为第2年第1日径流量，依次的/＞为第n年第1日径流量，/＞为第1年第2日径流量，依次的/＞为第1年第365日径流量，/＞为流域预研究期n年第1日平均径流量，/＞为流域预研究期n年第2日平均径流量，依次的/＞为流域预研究期n年第365日平均径流量。5.根据权利要求1所述的一种基于条件概率的水文干旱恢复预估方法，其特征在于：步骤S1中识别水文干旱事件，具体为：设置水文干旱事件截取阈值，对流域预研究期的长时间序列n年上的水文干旱指数进行逐日判断，若日水文干旱强度S大于等于0的连续天数大于等于15天则认定发生一次水文干旱事件，依次识别出流域预研究期的长时间序列n年内所有的水文干旱事件；日水文干旱强度的计算如公式所示；；式中，为第n年第i日的干旱强度，/＞为水文干旱事件截取阈值，/＞为第n年第i日的水文干旱异常指数。6.根据权利要求1所述的一种基于条件概率的水文干旱恢复预估方法，其特征在于：步骤S4中选取边缘分布函数拟合水文干旱特征，建立水文干旱恢复条件概率模型，计算水文干旱恢复到正常状态时的恢复期时间和恢复水量；具体为：使用备选的边缘分布函数分别拟合水文干旱发展期时间和缺水量、恢复期时间和恢复水量数据序列，采用最大似然法估计边缘分布函数参数，并根据拟合评估效果选出最佳的边缘分布函数，选用Frank、Gumbel、Clayton copula函数类型分别构建水文干旱发展期时间和恢复期时间、缺水量和恢复水量的联合分布，使用最大似然法估计copula函数参数，采用赤池信息量准则和平方欧式距离评选最优联合分布函数；基于Copula的联合分布和条件概率公式，以水文干旱发展期时间和缺水量为条件，水文干旱恢复期时间和恢复水量为目标，建立水文干旱恢复条件概率模型如公式所示； ；式中，为/＞条件下/＞事件发生的概率，u为水文干旱发展期时间，v为水文干旱恢复期时间，X为水文干旱发展期时间的边缘分布累积概率，Y为水文干旱恢复期时间的边缘分布累积概率；x和y分别为X≤u和Y≤v的累积概率；C，y)为X≤u和Y≤v的联合累积概率；确定水文干旱恢复的置信水平为95%，即当水文干旱事件恢复概率大于或等于0.95时，水文干旱恢复的置信水平为95%相应的恢复期时间和恢复水量被视为恢复该水文干旱事件的基础，计算水文干旱恢复所需的时间和水量。
说明书desc
技术领域本发明涉及一种灾害风险预估领域，特别涉及一种基于条件概率的水文干旱恢复预估方法。背景技术水文干旱事件发生后，由于气象条件变化影响造成干旱过程的变化，其过程变化包括为发展期和恢复期。目前，判定干旱发展和恢复期使用最广泛的方法是将干旱过程线简化为“三点一线”，即确定干旱开始、最严重和结束的三个时间点，把三点用光滑曲线连接，寻找干旱最严重时刻，将干旱恢复时刻与最严重时刻等同，根据干旱最严重时刻划分干旱过程为发展期和恢复期，该方法虽然简单，但考虑到实际干旱过程受气象条件影响，其过程存在明显的波动性和一定的滞后性，简化的干旱过程与真实过程存在较大差异，发展期和恢复期判定主观性较强，精度难免受到影响。实际上，气象条件波动影响着干旱过程，即干旱的不同过程反映了气象条件的变化，干旱发展期和恢复期也存在不同的气象条件特征，判定干旱发展期和恢复期本质上是确定气象条件与干旱过程之间的关系。此外，目前关于水文干旱的恢复状态判断方法主要通过分析气象水文干旱与水文干旱之间的关系实现，这种方法考虑到不同类型水文干旱间的外在联系，而忽略水文干旱事件自身发展过程的内在联系，且干旱恢复以烈度等无量纲指标判定为主，难以监测，实际操作性不足。发明内容针对现有技术存在的不足，本发明提供了一种基于条件概率的水文干旱恢复预估方法。为了解决上述技术问题，本发明采用的技术方案如下：一种基于条件概率的水文干旱恢复预估方法，包括如下步骤：步骤S1，收集统计流域预研究期的水文数据，构建水文干旱异常指数，识别水文干旱事件；步骤S2，确定水文干旱事件恢复时刻，划定水文干旱事件的发展期和恢复期；步骤S3，基于步骤S2划定的水文干旱事件的发展期和恢复期，提取水文干旱事件的发展期时间、缺水量、恢复期时间和恢复水量；步骤S4，选取边缘分布函数拟合水文干旱特征，建立水文干旱恢复条件概率模型，计算水文干旱恢复到正常状态时的恢复期时间和恢复水量；步骤S2具体为：基于时间的一致性得到水文干旱事件和气象要素序列匹配数据，利用相关性分析对水文干旱事件和气象要素的相关性进行诊断，得到相关性统计量序列，获得相关性统计量序列中统计值最小时刻，见公式所示；；式中：为相关性统计量序列中统计值最小时刻，Hij为第j个水文干旱事件第1时刻到第i时刻的数据序列，Mij为第j个水文干旱事件第1时刻到第i时刻的数据序列Hij对应的气象要素序列，corr表示为求数据序列和气象要素序列的相关性统计量；步骤S3，具体为：基于步骤S2划定的水文干旱事件的发展期和恢复期，统计水文干旱事件的干旱发展期时间和干旱恢复期时间；如公式、所示； ； ；式中：D1为水文干旱事件的干旱发展期时间，D2为水文干旱事件的干旱恢复期时间，t1为水文干旱事件开始时刻，te为水文干旱事件结束时刻。进一步的，步骤S2中，判断并标识每一次水文干旱事件的相关性统计量序列中统计值最小时刻，划定发展期和恢复期的时间点，将相关性统计量序列中统计值最小时刻/＞干旱过程前定义为干旱发展期，将相关性统计量序列中统计值最小时刻/＞干旱过程后定义为干旱恢复期，其中数据序列为水文干旱期间不同时期干旱强度组成的序列，气象要素序列为水文干旱期间不同时期气象要素组成的序列，常见的有蒸散发量序列、气温序列等。进一步的，步骤S3中，当时，水文干旱事件的发展期缺水量如公式所示； ；式中，WD为水文干旱事件的发展期缺水量，Si为i时刻干旱强度，Si-1为i-1时刻干旱强度；当时，水文干旱事件的恢复期恢复水量如公式所示；；式中，RW为水文干旱事件的恢复期恢复水量，为水文干旱事件结束时刻te的干旱强度，/＞为水文干旱事件截取阈值。进一步的，步骤S1中收集统计流域预研究期的水文数据，构建水文干旱异常指数，具体为：收集统计流域预研究期的长时间序列n年的水文数据，为保持年水文数据量一致性，剔除闰年2月29日径流量数据，将每年径流量数据从1到365依次排列，计算日时间尺度的水文干旱异常指数如公式所示；；式中：为第n年的水文干旱异常指数，/＞为第1年第1日径流量，/＞为第2年第1日径流量，依次的/＞为第n年第1日径流量，/＞为第1年第2日径流量，依次的/＞为第1年第365日径流量，/＞为流域预研究期n年第1日平均径流量，/＞为流域预研究期n年第2日平均径流量，依次的/＞为流域预研究期n年第365日平均径流量。进一步的，步骤S1中识别水文干旱事件，具体为：设置水文干旱事件截取阈值，对流域预研究期的长时间序列n年上的水文干旱指数进行逐日判断，若日水文干旱强度S大于等于0的连续天数大于等于15天则认定发生一次水文干旱事件，依次识别出流域预研究期的长时间序列n年内所有的水文干旱事件；日水文干旱强度的计算如公式所示；；式中，为第n年第i日的干旱强度，/＞为水文干旱事件截取阈值，/＞为第n年第i日的水文干旱异常指数。进一步的，步骤S4中选取边缘分布函数拟合水文干旱特征，建立水文干旱恢复条件概率模型，计算水文干旱恢复到正常状态时的恢复期时间和恢复水量；具体为：使用备选的边缘分布函数分别拟合水文干旱发展期时间和缺水量、恢复期时间和恢复水量数据序列，采用最大似然法估计边缘分布函数参数，并根据拟合评估效果选出最佳的边缘分布函数，选用Frank、Gumbel、Clayton copula函数类型分别构建水文干旱发展期时间和恢复期时间、缺水量和恢复水量的联合分布，使用最大似然法估计copula函数参数，采用赤池信息量准则和平方欧式距离评选最优联合分布函数；基于Copula的联合分布和条件概率公式，以水文干旱发展期时间和缺水量为条件，水文干旱恢复期时间和恢复水量为目标，建立水文干旱恢复条件概率模型如公式所示； ；式中，为/＞条件下/＞事件发生的概率，u为水文干旱发展期时间，v为水文干旱恢复期时间，X为水文干旱发展期时间的边缘分布累积概率，Y为水文干旱恢复期时间的边缘分布累积概率；x和y分别为X≤u和Y≤v的累积概率；C，y)为X≤u和Y≤v的联合累积概率；确定水文干旱恢复的置信水平为95%，即当水文干旱事件恢复概率大于或等于0.95时，水文干旱恢复的置信水平为95%相应的恢复期时间和恢复水量被视为恢复该水文干旱事件的基础，计算水文干旱恢复所需的时间和水量。本发明通过识别水文干旱事件，提取水文干旱发展期时间和缺水量、恢复期时间和恢复水量，构建水文干旱恢复条件概率模型，在此基础上，计算水文干旱恢复到正常状态时的恢复期时间和恢复水量。本发明的有益效果在于：本发明基于相关性分析划定干旱过程，确定干旱发展期和恢复期特征，利用条件概率方法定量的给出了水文干旱事件恢复的时间和恢复水量，与现有主观划定干旱过程相比，更具有理论性，能够更加客观的反映干旱过程，可以更精确的预估水文干旱事件恢复所需要的时间和水量。同时，本发明提出的以时间和水量作为水文干旱恢复的阈值指标，相较于通过水文干旱特征，如历时和烈度进行判断，方便监测并预警预报，具有更强的实用性和可操作性，为实际应用提供便利。附图说明图1为本发明方法流程图。图2为水文干旱事件恢复时刻判定案例图一。图3为水文干旱事件恢复时刻判定案例图二。具体实施方式下面结合实施例详述本发明，但本发明并不局限于这些实施例。如图1所示，一种基于条件概率的水文干旱恢复预估方法，其方法为：步骤S1，收集统计流域预研究期的水文数据，构建水文干旱异常指数，识别水文干旱事件；以抚河临水流域为例，选取流域1985—2019年共35年期间的逐日水文数据和逐日气象数据，为保持年数据量一致性，剔除闰年2月29日径流量数据，共得到12775个逐日径流量数据，再将每年径流量序列从1到365依次排列，计算日时间尺度的水文干旱指数，识别水文干旱事件；设置水文干旱事件截取阈值，将研究期水文干旱指数序列排序，本案例选取40分位数的径流量作为截取阈值，即/＞为-636万m3，对时间序列上的水文干旱指数进行逐日判断，若日水文干旱强度大于等于0的连续天数大于等于15天则认定发生一次水文干旱事件，依次的识别出研究期内所有的水文干旱事件；日水文干旱强度的计算如公式所示；；式中，为第n年第i日的干旱强度，/＞为水文干旱事件截取阈值，/＞为第n年第i日的水文干旱异常指数。通过对研究期内水文干旱逐一识别，共计识别出72次水文干旱事件。步骤S2，确定水文干旱事件恢复时刻，划定水文干旱事件的发展期和恢复期；基于时间的一致性得到水文干旱事件和气象要素序列匹配数据，利用相关性分析对水文干旱事件和气象要素的相关性进行诊断，得到相关性统计量序列，获得相关性统计量序列中统计值最小时刻，判断并标识每一次水文干旱事件的相关性统计量序列中统计值最小时刻/＞，划定发展期和恢复期的时间点，将相关性统计量序列中统计值最小时刻/＞干旱过程前定义为干旱发展期，将相关性统计量序列中统计值最小时刻/＞干旱过程后定义为干旱恢复期；见公式所示；；式中：为相关性统计量序列中统计值最小时刻，Hij为第j个水文干旱事件第1时刻到第i时刻的数据序列，Mij为第j个水文干旱事件第1时刻到第i时刻的数据序列Hij对应的气象要素序列，corr表示为求数据序列和气象要素序列的相关性统计量。本实施例中以第30水文干旱事件和第57号水文干旱事件恢复时刻判定为例，其过程如图2和图3所示。图2、图3中，依次计算干旱过程与蒸散发量过程之间的相关性，计算第1到3日数据间的相关性，第1到4日数据间的相关性，直至计算到第1日到最后一日数据间的相关性。步骤S3，基于步骤S2划定的水文干旱发展期和恢复期，提取水文干旱事件的发展期时间、缺水量、恢复时间和恢复水量。具体为：基于步骤S2划定的水文干旱事件的发展期和恢复期，统计水文干旱事件的干旱发展期时间和干旱恢复期时间；如公式、所示；；；式中：D1为水文干旱事件的干旱发展期时间，D2为水文干旱事件的干旱恢复期时间，t1为水文干旱事件开始时刻，te为水文干旱事件结束时刻；当时，水文干旱事件的发展期缺水量如公式所示；；式中，WD为水文干旱事件的发展期缺水量，Si为i时刻干旱强度，Si-1为i-1时刻干旱强度；当时，水文干旱事件的恢复期恢复水量如公式所示； ；式中，RW为水文干旱事件的恢复期恢复水量，为水文干旱事件结束时刻te的干旱强度，/＞为水文干旱事件截取阈值。步骤S4，选取边缘分布函数拟合水文干旱特征，建立水文干旱恢复条件概率模型，计算水文干旱恢复到正常状态时的恢复期时间和恢复水量；使用威布尔分布、伽玛分布、广义极值分布、对数正态分布和指数分布分别拟合水文干旱发展期时间和缺水量、恢复期时间和恢复水量序列，结果表明：恢复期时间序列最优边缘分布为伽玛分布，恢复期时间序列最优边缘分布为威布尔分布，缺水量和恢复水量序列最优边缘分布为广义极值分布。选用Frank、Gumbel、Clayton copula函数类型分别构建水文干旱发展期时间和恢复期时间、缺水量和恢复水量的联合分布，使用最大似然法估计copula函数参数，采用赤池信息量准则评选最优联合分布函数。结果表明：发展期时间和恢复期时间、缺水量和恢复水量之间的最优联合分布函数类型均为Clayton copula。本次实例中将水文干旱发展期时间和缺水量划分为轻中重三个等级，其累积概率临界值分别0.5，0.7和0.9。例如，计算得到轻度水文干旱恢复所需的恢复水量为2937.05m3，即当恢复水量达到2937.05万m3时轻度缺水状态恢复到正常情况的概率超过95%，中度水文干旱恢复所需的恢复水量为5530.94万m3，重度水文干旱恢复所需的恢复水量为9289.32万m3。综上，本发明通过计算日时间尺度的水文干旱指数，识别水文干旱事件，计算事件的发展期时间、缺水量、恢复期时间和恢复水量，基于条件概率模型计算水文干旱恢复到正常状态时的恢复期时间和恢复水量。本发明提出从水文干旱过程的内在联系出发，以水文干旱恢复期时间和恢复水量为指标的水文干旱恢复预估计算方法，与现有技术相比可以更好的描述水文干旱恢复到正常状态所需的时间和水量，方便监测并预警预报，具有更强的实用性和可操作性，为实际应用提供便利。
