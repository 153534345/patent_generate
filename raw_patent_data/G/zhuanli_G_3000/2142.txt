标题title
一种考虑空域态势和局部优化的航迹补全预测方法及装置
摘要abst
本发明涉及空中交通管理技术领域，具体涉及一种考虑空域态势和局部优化的航迹补全预测方法及装置。包括以下步骤：步骤1：获取航迹数据，构建数据集；步骤2：构建航迹嵌入预训练模型；步骤3：构建航迹补全与预测模；步骤4：构建损失函数，采用数据集对航迹嵌入预训练模型和航迹补全与预测模型进行训练；步骤5：采用训练后的航迹嵌入预训练模型和航迹补全与预测模型进行航迹补全预测；本发明不仅考虑缺失航迹点前后的轨迹信息，同时考察局部空域内其它航空器对缺失航迹点的影响，并使用区域池化方法将局部空域内其它航空器的飞行态势信息进行融合、降维，更加符合实际情况；对具有复杂飞行模式的航迹片段进行补全，具有较高的补全精度。
权利要求书clms
1.一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，包括以下步骤：步骤1：获取航迹数据，构建数据集；步骤2：构建航迹嵌入预训练模型，用于提取航迹片段中的航迹点属性映射为多维特征向量；对多维特征向量进行时序建模得到包括航迹点特征的航迹嵌入向量；将航迹嵌入向量映射为航迹点属性得到航迹点属性的估计值；步骤3：构建航迹补全与预测模型，用于将空域态势表示嵌入融合，得到局部空域态势信息；根据局部空域态势信息和航迹嵌入向量获取航迹片段，对航迹片段进行时序建模得到预测缺失航迹点特征的隐含向量；将隐含向量进行线性映射得到补全后的航迹点属性；步骤4：构建损失函数，采用数据集对航迹嵌入预训练模型和航迹补全与预测模型进行训练；步骤5：采用训练后的航迹嵌入预训练模型和航迹补全与预测模型进行航迹补全预测。2.根据权利要求1所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述航迹嵌入预训练模型包括编码器模块和解码器模块；编码器模块包括输入映射层和第一Transformer模块；输入映射层为全连接层，用于将航迹片段中的航迹点属性映射为多维特征向量；第一Transformer模块包括依次连接的多头自注意力模块、层标准化层、前馈神经网络和层标准层；用于对多维特征向量进行时序建模，输出包括航迹点特征的航迹嵌入向量；解码器模块为输出映射层，用于将航迹嵌入向量映射为航迹点属性，得到航迹点属性的估计值。3.根据权利要求2所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述航迹补全与预测模型包括区域池化模块、第二Transformer模块和输出嵌入层；区域池化模块包括区域池化向量和第一全连接层和第二全连接层；区域池化向量用于存放空域态势表示嵌入；第一全连接层用于将空域态势嵌入进行融合得到局部空域态势信息；第二全连接层用于根据航迹嵌入向量和局部空域态势信息获取航迹片段；第二Transformer模块包括依次连接的Masked多头自注意力模块、层标准化层、前馈神经网络、层标准层；用于对区域池化模块输出的航迹片段进行时序建模，提取预测缺失航迹点特征的隐含向量；输出嵌入层为全连接层用于将第二Transformer模块输出的隐含向量进行线性映射输出补全后的航迹点属性。4.根据权利要求3所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述步骤3训练过程根据不同场景采用三种训练模式训练航迹补全与预测模型；模式一：采用前序F个航迹点和后序B个航迹点对中间N个航迹点进行航迹补全与预测；若后序B个航迹点缺失，则采用模式二：采用前序F个航迹点对中间N个航迹点进行航迹补全与预测；若前序F个航迹点缺失，则采用模式三：采用后序B个航迹点对中间N个航迹点进行航迹补全与预测。5.根据权利要求4所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述第一Transformer模块对每个多维特征向量进行随机Mask操作，过程如下：式中：U为采样范围为0到1的均匀分布，u为进行采样后的随机标量，α是随机Mask概率；I是输入到所述第一Transformer模块的高维特征向量；Imasked是经过随机Mask操作后的高维特征向量；sgn为符号函数；第二Transformer模块中Masked多头自注意力模块的Mask矩阵三种不同的模式分别满足下述公式：模式一：模式二：模式三：式中：Mask为Masked多头自注意力模块的Mask矩阵，triu算子为取矩阵的上三角区域，diag算子为取矩阵的对角线区域，i为航迹点序号，inf为无穷大数；F为前序航点数，N为中间航点数，B为后续航点数。6.根据权利要求3所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述区域池化模块处理过程满足下式：式中：Pa为航迹点a的区域池化张量，为包括在航迹点a局部空域的第i个扇区块，第j个簇，第k个区域内其他航空器的航迹点集合，hr是航迹点r的航迹嵌入向量，Sa为第一全连接层的输出，W1和b1分别为第一全连接层的权重矩阵和偏置向量，Ca和Ia分别为第二个全连接层的输入和输出，W2和b2分别为第二全连接层的权重矩阵和偏置向量，flatten算子为将张量沿各维度平铺为一个向量；concat算子为将两个向量进行首尾相连，T为向量的转置。7.根据权利要求1所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述航迹数据经过预处理，然后构建数据集，预处理过程如下：根据航迹数据的采样间隔，将航迹数据中存在缺失值的片段剔除；对航迹点属性进行最小最大值归一化；航迹数据为包括每条航线中各个时刻的航迹点属性和飞行器的运动趋势；航迹点属性包括时间戳、经度、纬度、海拔、经度方向速度、纬度方向速度和垂直速度；采取最小最大值归一化的航迹点属性不包括时间戳；飞行器的运动趋势包括爬升、保持、转弯、下降。8.根据权利要求1所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述损失函数如下：式中：pi为第i个航迹点的属性损失，ai,j为第i个航迹点的第j个属性的真实值，为第i个航迹点的第j个属性的预测值，Nt为航迹嵌入预训练模型或航迹补全与预测模型输出的航迹点个数，Na为每个航迹点的属性个数，L为损失函数。9.根据权利要求3所述的一种考虑空域态势和局部优化的航迹补全预测方法，其特征在于，所述局部空域指的是半径为R，垂直高度偏差为H的圆柱体空间；区域池化方法如下：将局部空域依圆心等角度切分为D1个扇区块，每个扇区块依半径等分为D2个簇，每个簇依高度等分为D3个区域，将处于同一区域内航空器的航迹嵌入向量进行相加得到当前时刻的空域态势表示嵌入，再使用线性映射对所有区域的空域态势表示嵌入进行融合，得到区域池化结果。10.采用如权利要求1～9所述任一种考虑空域态势和局部优化的航迹补全预测方法的装置，其特征在于，包括至少一个处理器、至少一个存储器、输入输出设备和电源；存储器用存储权利要求1～9所述任一种方法的指令；处理器用于执行权利要求1～9所述任一种方法；输入输出设备用于进行数据交互；电源用于为设备提供电源。
说明书desc
技术领域本发明涉及空中交通管理技术领域，具体涉及一种考虑空域态势和局部优化的航迹补全预测方法及装置。背景技术在空中交通控制系统中，ADS-B系统常以一定的频率采集航空器广播的信息，包括位置、航向、呼号等。在这些信息中，若将位置信息依时间维度整合起来就能够得到航空器的飞行轨迹信息，大量的历史飞行轨迹为飞行计划制定、空中交通流控制、空中轨迹预测等空管应用提供了重要的经验信息。但由于存在广播信号干扰、存储介质故障、错误测量等因素的影响，ADS-B系统捕获的飞行轨迹信息会出现缺失值或离群值。为了对其进行航迹补齐，现有方法大多采用插值的方法，虽然此类方法简单高效，但实际的飞行轨迹需要考虑碰撞及冲突的避免，而受到局部空域内其他航空器的制约，因此现有方法缺乏对局部空域内其他航空器影响的建模。发明内容本发明根据现有技术存在的问题提供一种考虑空域态势和局部优化的航迹补全预测方法及装置。本发明采用的技术方案是：一种考虑空域态势和局部优化的航迹补全预测方法，包括以下步骤：步骤1：获取航迹数据，构建数据集；步骤2：构建航迹嵌入预训练模型，用于提取航迹片段中的航迹点属性映射为多维特征向量；对多维特征向量进行时序建模得到包括航迹点特征的航迹嵌入向量；将航迹嵌入向量映射为航迹点属性得到航迹点属性的估计值；步骤3：构建航迹补全与预测模型，用于将空域态势表示嵌入融合，得到局部空域态势信息；根据局部空域态势信息和航迹嵌入向量获取航迹片段，对航迹片段进行时序建模得到预测缺失航迹点特征的隐含向量；将隐含向量进行线性映射得到补全后的航迹点属性；步骤4：构建损失函数，采用数据集对航迹嵌入预训练模型和航迹补全与预测模型进行训练；步骤5：采用训练后的航迹嵌入预训练模型和航迹补全与预测模型进行航迹补全预测。进一步的，所述航迹嵌入预训练模型包括编码器模块和解码器模块；编码器模块包括输入映射层和第一Transformer模块；输入映射层为全连接层，用于将航迹片段中的航迹点属性映射为多维特征向量；第一Transformer模块包括依次连接的多头自注意力模块、层标准化层、前馈神经网络和层标准层，用于对多维特征向量进行时序建模，输出包括航迹点特征的航迹嵌入向量；解码器模块为输出映射层，用于将航迹嵌入向量映射为航迹点属性，得到航迹点属性的估计值。进一步的，所述航迹补全与预测模型包括区域池化模块、第二Transformer模块和输出嵌入层；区域池化模块包括区域池化向量和第一全连接层和第二全连接层；区域池化向量用于存放空域态势表示嵌入；第一全连接层用于将空域态势嵌入进行融合得到局部空域态势信息；第二全连接层用于根据航迹嵌入向量和局部空域态势信息获取航迹片段；第二Transformer模块包括依次连接的Masked多头自注意力模块、层标准化层、前馈神经网络、层标准层；用于对区域池化模块输出的航迹片段进行时序建模，提取预测缺失航迹点特征的隐含向量；输出嵌入层为全连接层用于将第二Transformer模块输出的隐含向量进行线性映射输出补全后的航迹点属性。进一步的，所述步骤3训练过程根据不同场景采用三种训练模式训练航迹补全与预测模型；模式一：采用前序F个航迹点和后序B个航迹点对中间N个航迹点进行航迹补全与预测；若后序B个航迹点缺失，则采用模式二：采用前序F个航迹点对中间N个航迹点进行航迹补全与预测；若前序F个航迹点缺失，则采用模式三：采用后序B个航迹点对中间N个航迹点进行航迹补全与预测。进一步的，所述第一Transformer模块对每个多维特征向量进行随机Mask操作，过程如下：式中：U为采样范围为0到1的均匀分布，u为进行采样后的随机标量，α是随机Mask概率；I是输入到所述第一Transformer模块的高维特征向量；Imasked是经过随机Mask操作后的高维特征向量；sgn为符号函数；第二Transformer模块中Masked多头自注意力模块的Mask矩阵三种不同的模式分别满足下述公式：模式一：模式二：模式三：式中：Mask为Masked多头自注意力模块的Mask矩阵，triu算子为取矩阵的上三角区域，diag算子为取矩阵的对角线区域，i为航迹点序号，inf为无穷大数，F为前序航点数，N为中间航点数，B为后续航点数。进一步的，所述区域池化模块处理过程满足下式：式中：Pa为航迹点a的区域池化张量，为包括在航迹点a局部空域的第i个扇区块，第j个簇，第k个区域内其他航空器的航迹点集合，hr是航迹点r的航迹嵌入向量，Sa为第一全连接层的输出，W1和b1分别为第一全连接层的权重矩阵和偏置向量，Ca和Ia分别为第二个全连接层的输入和输出，W2和b2分别为第二全连接层的权重矩阵和偏置向量，flatten算子为将张量沿各维度平铺为一个向量；concat算子为将两个向量进行首尾相连，T为向量的转置。进一步的，所述航迹数据经过预处理，然后构建数据集，预处理过程如下：根据航迹数据的采样间隔，将航迹数据中存在缺失值的片段剔除；对航迹点属性进行最小最大值归一化；航迹数据为包括每条航线中各个时刻的航迹点属性和飞行器的运动趋势；航迹点属性包括时间戳、经度、纬度、海拔、经度方向速度、纬度方向速度和垂直速度；采取最小最大值归一化的航迹点属性不包括时间戳；飞行器的运动趋势包括爬升、保持、转弯、下降。进一步的，所述损失函数如下：式中：pi为第i个航迹点的属性损失，ai,j为第i个航迹点的第j个属性的真实值，为第i个航迹点的第j个属性的预测值，Nt为航迹嵌入预训练模型或航迹补全与预测模型输出的航迹点个数，Na为每个航迹点的属性个数，L为损失函数。进一步的，所述局部空域指的是半径为R，垂直高度偏差为H的圆柱体空间；区域池化方法如下：将局部空域依圆心等角度切分为D1个扇区块，每个扇区块依半径等分为D2个簇，每个簇依高度等分为D3个区域，将处于同一区域内航空器的航迹嵌入向量进行相加得到当前时刻的空域态势表示嵌入，再使用线性映射对所有区域的空域态势表示嵌入进行融合，得到区域池化结果。一种考虑空域态势和局部优化的航迹补全预测的装置，包括至少一个处理器、至少一个存储器、输入输出设备和电源；存储器用于存储考虑空域态势和局部优化的航迹补全预测方法的指令；处理器用于执行考虑空域态势和局部优化的航迹补全预测方法；输入输出设备用于进行数据交互；电源用于为设备提供电源。本发明的有益效果是：本发明对缺失航迹点进行估计时，不仅考虑缺失航迹点前后的轨迹信息，同时考察局部空域内其它航空器对缺失航迹点的影响，并使用区域池化方法将局部空域内其它航空器的飞行态势信息进行融合、降维，更加符合实际情况；本发明对具有复杂飞行模式的航迹片段进行补全，具有较高的补全精度。附图说明图1为本发明方法流程示意图。图2为本发明实施例中航迹嵌入预训练模型示意图。图3为本发明实施例中航迹补全与预测模型示意图。图4为本发明实施例中航迹补全与预测模型不同训练模式的适用场景。图5为本发明实施例中区域池化方法对局部空域划分的示意图。图6为本发明实施例中航迹嵌入预训练模型的第一Transformer模块示意图。图7为本发明实施例中航迹补全与预测模型的第二Transformer模块示意图。图8为本发明实施例中装置结构示意图。具体实施方式下面结合附图和具体实施例对本发明做进一步说明。如图1所示，一种考虑空域态势和局部优化的航迹补全预测方法，包括以下步骤：步骤1：从ATC系统中获取航迹数据，经解码后，进行数据预处理并构建数据集；解码后的航迹数据包括每条航线中各个时刻的航迹点属性：时间戳、经度、纬度、海拔、经度方向速度、纬度方向速度以及垂直速度；航迹数据包括飞行器各种运动趋势，包括爬升、保持、转弯以及下降。数据预处理过程包括以下步骤：S1：根据航迹数据的采样间隔，将航迹数据中存在缺失值的片段剔除；S2：对航迹点除时间戳以外的六个属性进行最小最大值归一化，满足以下公式：式中：为航迹点第i个属性值，/＞为所有航迹点第i个属性的最小值，为所有航迹点第i个属性的最大值，/＞为经过归一化后的航迹点第i个属性值。构建数据集的过程包括如下步骤：若使用M个航迹点训练所述航迹嵌入预训练模型，则使用窗口大小为M的滑动窗口以一个航迹点为步长，在航迹数据上不断截取数据对，并使用7:1:2的比例从所有数据对中划分出训练集、验证集和测试集。若需要进行航迹补全与预测的目标片段的航迹点个数为K，则使用窗口大小为K的滑动窗口以一个航迹点为步长，在航迹数据上不断截取数据对，并使用7:1:2的比例从所述数据对中划分出训练集、验证集和测试集。步骤2：如图2所示，构建航迹嵌入预训练模型，用于提取航迹片段中的航迹点属性映射为多维特征向量；对多维特征向量进行时序建模得到包括航迹点特征的航迹嵌入向量；将航迹嵌入向量映射为航迹点属性得到航迹点属性的估计值。通过该模型构建航迹点特征的多维表达向量，增强数据的表征能力，提高航迹补全与预测模型的学习效果。航迹嵌入预训练模型包括编码器模块和解码器模块；编码器模块包括输入映射层和第一Transformer模块；输入映射层为全连接层，用于将航迹片段中的航迹点属性映射为多维特征向量，提升航迹点特征的表征能力。如图6所示，第一Transformer模块包括依次连接的多头自注意力模块、层标准化层、前馈神经网络和层标准层；用于对多维特征向量进行时序建模，输出包括航迹点特征的航迹嵌入向量，提取了不同时刻航迹点特征之间的相似性和差异性；解码器模块为输出映射层，用于将航迹嵌入向量映射为航迹点属性。输出映射层包括两个全连接层，将航迹嵌入向量映射为航迹点的六个属性：经度、纬度、海拔、经度方向速度、纬度方向速度和垂直速度。这六个属性值应当与输入到航迹嵌入预训练模型的编码器模块的对应航迹点属性相同。第一Transformer模块对每个多维特征向量进行随机Mask操作，过程如下：式中：U为采样范围为0到1的均匀分布，u为进行采样后的随机标量，α是随机Mask概率；I是输入到所述第一Transformer模块的高维特征向量；Imasked是经过随机Mask操作后的高维特征向量；sgn为符号函数。步骤3：如图3所示，构建航迹补全与预测模型，用于将空域态势表示嵌入融合，得到局部空域态势信息；根据局部空域态势信息和航迹嵌入向量获取航迹片段，对航迹片段进行时序建模得到预测缺失航迹点特征的隐含向量；将隐含向量进行线性映射得到补全后的航迹点属性。在考虑局部空域内其他航空器位置信息的情况下，对具有缺失值的航迹片段进行补全任务。航迹补全与预测模型包括区域池化模块、第二Transformer模块和输出嵌入层；区域池化模块包括区域池化向量和第一全连接层和第二全连接层；区域池化向量用于存放空域态势表示嵌入；第一全连接层用于将空域态势嵌入进行融合得到局部空域态势信息；第二全连接层用于根据航迹嵌入向量和局部空域态势信息获取航迹片段，进一步提取当前时刻航迹点航迹嵌入向量和局部空域态势信息的相关性与差异性。区域池化模块处理过程满足下式：式中：Pa为航迹点a的区域池化张量，维度为4，初始化为全0张量，为包括在航迹点a局部空域的第i个扇区块，第j个簇，第k个区域内其他航空器的航迹点集合，hr是航迹点r的航迹嵌入向量，Sa为第一全连接层的输出，W1和b1分别为第一全连接层的权重矩阵和偏置向量，Ca和Ia分别为第二个全连接层的输入和输出，W2和b2分别为第二全连接层的权重矩阵和偏置向量，flatten算子为将张量沿各维度平铺为一个向量；concat算子为将两个向量进行首尾相连，T为向量的转置。如图7所示，第二Transformer模块包括依次连接的Masked多头自注意力模块、层标准化层、前馈神经网络、层标准层；用于对区域池化模块输出的航迹片段进行时序建模，提取预测缺失航迹点特征的隐含向量；不同训练模式对应不同的Masked多头自注意力模块的Mask矩阵：模式一：模式二：模式三：式中：Mask为Masked多头自注意力模块的Mask矩阵，triu算子为取矩阵的上三角区域，diag算子为取矩阵的对角线区域，i为航迹点序号，inf为无穷大数，F为前序航点数，N为中间航点数，B为后续航点数。对于每个模式，Mask经过初始化后，依次进行对应式中从上到下的操作完成Mask矩阵的构建。输出嵌入层为全连接层用于将第二Transformer模块输出的隐含向量进行线性映射输出补全后的航迹点属性，实现航迹补全与预测。步骤4：构建损失函数，采用数据集对航迹嵌入预训练模型和航迹补全与预测模型进行训练；损失函数L满足以下公式：式中：pi为第i个航迹点的属性损失，ai,j为第i个航迹点的第j个属性的真实值，为第i个航迹点的第j个属性的预测值，Nt为航迹嵌入预训练模型或航迹补全与预测模型输出的航迹点个数，Na为每个航迹点的属性个数，L为损失函数。训练航迹补全与预测模型时，根据不同的训练模式训练，调整超参数，得到训练后的航迹补全与预测模型，不同的训练模式对应不同的航迹补全与预测场景。如图4所示：模式一：采用前序F个航迹点和后序B个航迹点对中间N个航迹点进行航迹补全与预测；若后序B个航迹点缺失，则采用模式二：采用前序F个航迹点对中间N个航迹点进行航迹补全与预测；若前序F个航迹点缺失，则采用模式三：采用后序B个航迹点对中间N个航迹点进行航迹补全与预测。需要进行航迹补全与预测的目标片段中，缺失航迹点的个数可以是一个或多个，缺失航迹点的位置可以是所述目标片段中的任意一个或多个位置。若后续B个航迹点全部缺失采用模式二，若前序F个航迹点全部缺失采用模式三。针对所述目标片段中的每个航迹点，使用其航迹嵌入向量和局部空域态势信息对当前航迹点属性进行估计，对于缺失航迹点，令其航迹嵌入向量为全0向量；所述局部空域态势信息是前一个或后一个时刻航迹点为中心的局部空域内其他航空器当前时刻航迹嵌入向量的区域池化结果。根据不同的训练模式确定使用哪个时刻的航迹点作为中心，模式一、二选择前一个时刻，模式三选择后一个时刻；如图5所示，局部空域指的是半径为R，垂直高度偏差为H的圆柱体空间；区域池化的方法为：将所述局部空域依圆心等角度切分为D1个扇区块，每个扇区块依半径等分为D2个簇，每个簇依高度等分为D3个区域，将处于同一区域内航空器的航迹嵌入向量进行相加得到当前时刻的空域态势表示嵌入，再使用线性映射对所有区域的空域态势表示嵌入进行融合，得到区域池化结果。步骤5：采用训练后的航迹嵌入预训练模型和航迹补全与预测模型进行航迹补全预测。针对某一条具有缺失航迹点的航迹片段，捕获缺失航迹点一定范围内其他航空器的飞行轨迹，一并输入训练完成的航迹嵌入预训练模型，取编码器模块输出的航迹高维表达向量，输入对应训练模式下训练完备的航迹补全与预测模型，得到缺失片段的估计值。如图8所示，一种考虑空域态势和局部优化的航迹补全预测方法的装置，包括至少一个处理器、至少一个存储器、输入输出设备和电源；存储器用于存储考虑空域态势和局部优化的航迹补全预测方法的指令；处理器用于执行考虑空域态势和局部优化的航迹补全预测方法；输入输出设备用于进行数据交互，包括显示器、键盘、鼠标、USB接口、RJ45接口等；电源用于为设备提供电源，可以为外置电源也可以为内置电源。
