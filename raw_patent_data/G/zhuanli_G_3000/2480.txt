标题title
一种多模式电离层相位闪烁指数建模方法
摘要abst
本发明公开了一种多模式电离层相位闪烁指数建模方法，适用于采样率1~50hz的接收机，包含原始数据接受和识别、数据预处理、周跳探测和校正，根据采样频率自适应调整滑动窗口，具有TEC‑L4和巴特沃斯h滤波器两种算法计算相位闪烁，具有较高适用性。
权利要求书clms
1.一种多模式电离层相位闪烁指数建模方法，其特征在于，包括如下步骤：步骤1、接收机获取观测数据和星历数据，并输入基准站的三维坐标；步骤2、对观测数据和星历数据进行预处理；步骤3、利用广播星历计算当前卫星的三维位置，并根据接收机三维位置计算接收机方位角、高度角；步骤4、选择工作模式，模式=0为L4-TEC方法计算相位闪烁指数，模式=1为巴特沃斯滤波器方法计算相位闪烁指数。2.根据权利要求1所述的一种多模式电离层相位闪烁指数建模方法，其特征在于，所述步骤2的预处理包括检测周跳；检测周跳的方法采用无几何距离相位组合，消除接收机钟差、卫星钟差、对流层延迟以及几何距离项：，式中，、/＞为波长，/＞、/＞为整周模糊度，/＞、/＞为伪距。3.根据权利要求1所述的一种多模式电离层相位闪烁指数建模方法，其特征在于，所述步骤4中的L4-TEC方法包括：采用预处理后的伪距和相位值得到绝对TEC、相对TEC，所述绝对TEC表示伪距电离层总含量，所述相对TEC表示相位电离层总含量，然后计算TEC起伏和相位TEC，从而计算相位闪烁指数；其中，绝对TEC为伪距电离层总含量、相对TEC为相位电离层总含量；绝对TEC和相对TEC计算如下：， ，其中，、/＞分别为绝对、相对TEC，/＞分别为/＞频段伪距观测值，/＞为/＞频段载波频率，/＞ 分别为/＞频段相位观测值，/＞分别为卫星、接收机硬件延迟；所述TEC起伏为瞬时的绝对TEC与绝对TEC平均值之差： ，其中，为瞬时的绝对TEC，/＞为绝对TEC平均值，/＞表示时间，/＞为TEC起伏；相位起伏表示为：，式中，c为光速，为载波频率。4.根据权利要求1所述的一种多模式电离层相位闪烁指数建模方法，其特征在于，所述步骤4中的巴特沃斯滤波器方法为：，式中，s是滤波器的输入值，，/＞是滤波器的拐点频率，即截止频率为输入值；/＞是巴特沃斯系数，从巴特沃斯系数表获得，其中，i=1、2、3；/＞分别为单个巴特沃斯二阶滤波器，共同构成一个六阶高通巴特沃斯滤波器，其中i=1、2、3；通过巴特沃斯滤波器得到去除趋势项后的相位值。5.根据权利要求3或4所述的一种多模式电离层相位闪烁指数建模方法，其特征在于，相位闪烁指数计算公式为： ，式中，表示的是平均值，以一分钟历元个数为滑动窗口计算，/＞为通过L4-TEC方法或者巴特沃斯滤波器方法去除趋势项后的载波相位；通过式得到每个历元的相位闪烁指数。
说明书desc
技术领域本发明属于GNSS卫星电离层技术领域，具体涉及一种多模式电离层相位闪烁指数建模方法。背景技术电离层对全球导航卫星系统信号的影响可以大致分为良性或引起干扰的组成部分。良性部分为是电离层延迟，该延迟基本上可以通过使用双频或三频测量的无电离层组合技术削弱。干扰部分称为电离层闪烁，被定义为GNSS信号的振幅S4和相位的快速和随机波动。这些波动很难缓解，需要专门的信号处理技术，以防止接收机的信号跟踪丢失。电离层闪烁可能导致电波传播时间、到达角和传播路径等改变，导致信息质量的急剧恶化、精度降低。因此电离层闪烁研究和预测重要性不言而喻。通过电离层相位闪烁指数建模方法可以实时监测到站点周边地区电离层闪烁现象的发生规律，协助解决低空信号传播受到电离层不规则结构引起的信号误码问题。目前，传统电离层闪烁算采用50hz高频采样数据计算振幅闪烁指数和相位闪烁指数，对设备内存容量和经费支出要求更高。不能通过其他采样频率的普通接收机计算，缺乏适用性。相位闪烁计算方式单一，不能针对不同地区调整。发明内容传统电离层相位闪烁在计算相位闪烁指数时采用50hz数据，通过巴特沃斯高通滤波器去除趋势项，传统算法只适合高采样接收机，对设备内存、经费等要求较高，不能适应普通接收机数据，缺乏适用性。为解决上述技术问题，本发明提供一种多模式电离层相位闪烁指数建模方法，其为一种采样多模式方法，TEC-L4算法采样伪距和相位数据求取相对TEC，从而计算相位闪烁指数适用于低采样率数据。巴特沃斯三级二阶次联滤波器在原来基础上修改成自适应算法，可根据采样率大小，调整滤波器系数，适用于1~50hz采样率，解决了传统滤波器问题，同时结果更高，更稳定。为达到上述目的，本发明采用如下技术方案：本发明实现其目的所采取的技术方案是：一种多模式电离层相位闪烁指数建模方法，包括如下步骤：步骤1、接收机获取观测数据和星历数据，并输入基准站的三维坐标；步骤2、对观测数据和星历数据进行预处理；步骤3、利用广播星历计算当前卫星的三维位置，并根据接收机三维位置计算接收机方位角、高度角；步骤4、选择工作模式，模式=0为L4-TEC方法计算相位闪烁指数，模式=1为巴特沃斯滤波器方法计算相位闪烁指数。进一步地，所述步骤2的预处理包括检测周跳；检测周跳的方法采用无几何距离相位组合，消除接收机钟差、卫星钟差、对流层延迟以及几何距离项：，式中，、/＞为波长，/＞、/＞为整周模糊度，/＞、/＞为伪距。进一步地，所述步骤4中的L4-TEC方法包括：采用预处理后的伪距和相位值得到绝对TEC、相对TEC，然后计算TEC起伏和相位TEC，从而计算相位闪烁指数；其中，绝对TEC为伪距电离层总含量、相对TEC为相位电离层总含量；绝对TEC和相对TEC计算如下： ，，其中，、/＞分别为绝对、相对TEC，/＞分别为/＞频段伪距观测值，/＞为/＞频段载波频率，/＞ 分别为/＞频段相位观测值，/＞分别为卫星、接收机硬件延迟；所述TEC起伏为瞬时的绝对TEC与绝对TEC平均值之差： ，其中，为瞬时的绝对TEC，/＞为绝对TEC平均值，/＞表示时间，为TEC起伏；相位起伏表示为：，式中，c为光速，为载波频率。进一步地，所述步骤4中的巴特沃斯滤波器方法为： ，式中，s是滤波器的输入值，，/＞是滤波器的拐点频率，即截止频率为输入值；/＞是巴特沃斯系数，从巴特沃斯系数表获得，其中，i=1、2、3；/＞分别为单个巴特沃斯二阶滤波器，共同构成一个六阶高通巴特沃斯滤波器，其中i=1、2、3；通过巴特沃斯滤波器得到去除趋势项后的相位值。进一步地，相位闪烁指数计算公式为： ，式中，表示的是平均值，以一分钟历元个数为滑动窗口计算，/＞为通过L4-TEC方法或者巴特沃斯滤波器方法去除趋势项后的载波相位；通过式得到每个历元的相位闪烁指数。与传统电离层相位闪烁指数算法相比，本发明的优点在于：针对传统电离层相位闪烁算法存在的问题，本发明提出了一种多模式电离层相位闪烁指数建模方法，该方法包含周跳探测和校正，采用根据采样频率自适应调整滑动窗口，具有TEC-L4和巴特沃斯滤波器两种算法计算相位闪烁，提高了该发明的适用性。本发明涉及的相位闪烁指数计算方法支持1~50hz不同采样率的数据自适应解算，不需要手动更改参数。另外，该方法较传统电离层相位闪烁方法，相同采样率下提高了精度，计算方式更广，适用性更好。附图说明图1为本发明的一种多模式电离层相位闪烁指数建模方法流程示意图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。此外，下面所描述的本发明各个实施方式中所涉及到的技术特征只要彼此之间未构成冲突就可以相互组合。本发明提供一种多模式电离层相位闪烁指数建模方法，以采样率1~50HZ任意值输入接收机原始数据，采用周跳探测与校正预处理模块、绝对TEC和相对TEC计算模块、相位闪烁指数计算模块，得到计算结果。其中相位闪烁指数计算模块采用多方式计算，包括TEC-L4计算方法、巴特沃斯三级二阶次联滤波器计算，可针对不同模式选择最优结果。如图1所示，本发明的一种多模式电离层相位闪烁指数建模方法，具体包括如下步骤：步骤1、接收机获取观测数据和星历数据，并输入基准站的三维坐标；步骤2、对观测数据和星历数据进行预处理，所述预处理包括检测周跳。检测周跳的方法采用无几何距离相位组合，消除接收机钟差、卫星钟差、对流层延迟以几何距离项：，式中，、/＞为波长，/＞、/＞为整周模糊度，/＞、/＞为伪距。步骤3、利用广播星历计算当前卫星的三维位置，并根据接收机三维位置计算接收机方位角、高度角；步骤4、选择工作模式，模式=0为L4-TEC方法计算相位闪烁模式，模式=1为巴特沃斯滤波器方法计算相位闪烁模式：相位闪烁指数通过预处理后的载波相位计算得到，包含两种方法：一、L4-TEC方法；二、巴特沃斯滤波器方法。其主要目的为去除相位数据中的趋势项。一、L4-TEC方法采用预处理后的伪距和相位值得到绝对TEC、相对TEC，然后以120个历元为滑动窗口计算TEC起伏和相位起伏，以3000个历元为滑动窗口计算相位闪烁指数。绝对TEC和相对TEC计算如下： ， ，其中，、/＞分别为绝对、相对TEC，/＞分别为/＞频段伪距观测值，/＞为/＞频段载波频率，/＞ 分别为/＞频段相位观测值，/＞分别为卫星、接收机硬件延迟。所述TEC起伏为瞬时绝对TEC与绝对TEC平均值之差： ，相位起伏可表示为：，式中，c为光速，为载波频率。二、巴特沃斯滤波器方法为：，式中，s是滤波器的输入值，，/＞是滤波器的拐点频率也就是截止频率为输入值，/＞是巴特沃斯系数，从巴特沃斯系数表获得，/＞分别为单个巴特沃斯二阶滤波器，共同构成一个六阶高通巴特沃斯滤波器，通过滤波器得到去趋势项后的相位值。相位闪烁指数计算公式为： ，式中，表示的是平均值，以一分钟历元个数为滑动窗口计算，/＞为通过L4-TEC方法或者巴特沃斯滤波器去除趋势项后的载波相位。通过式即可得到每个历元的相位闪烁指数。本领域的技术人员容易理解，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
