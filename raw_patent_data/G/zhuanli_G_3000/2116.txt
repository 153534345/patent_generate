标题title
一种用于三维形貌测量的自适应多重曝光方法
摘要abst
本发明公开了一种用于三维形貌测量的自适应多重曝光方法，属于光学三维重建技术领域。首先，根据直方图累计函数计算基准曝光时间，将基准曝光时间下条纹图序列融合为基准图像；其次，根据相机响应曲线和不同曝光时间下基准图像高信噪比的像素数，以迭代方式估计多次曝光时间序列，最后，将多次曝光时间下的图像融合成新条纹图像序列，以进行三维重建。本发明分别从整体和局部进行考虑，能对具有高动态反射率表面物体自动三维重建，有效提高了条纹投影轮廓术的应用范围。
权利要求书clms
1.一种用于三维形貌测量的自适应多重曝光方法，其特征在于，所述方法包括：步骤一：获取相机的标定参数，通过一次标定得到相机线性响应截距、灰度响应线性区间/＞；步骤二：基于所述步骤一得到的相机线性响应截距和最大的期望像素灰度值/＞计算基准曝光时间；步骤三：对所述基准曝光时间下采集的条纹图序列融合得到基准图像，基于所述基准图像直方图划分集群，计算每个集群的最佳曝光时间，得到最佳多重曝光时间序列；步骤四：在所述最佳多重曝光时间序列下分别采集条纹图，并对条纹图进行合成得到新的条纹图像序列；所述步骤三包括：步骤31：对所述基准曝光时间下采集的条纹图像进行融合；其中，表示第i幅条纹图在坐标/＞处的灰度值，k表示单个曝光采集的条纹图数量，/＞表示基准图在坐标/＞处的灰度值；步骤32：计算融合图像的直方图，对直方图进行细化处理：其中，为灰度直方图不同灰度值/＞对应的像素数，/＞为细化间隔；步骤33：计算细化直方图的累计函数：不断增大，/＞每增加/＞划分为一个集群；步骤34：对集群直方图的每个灰度值计算预测曝光时间，并以此作为全局最佳曝光时间对集群所有像素进行灰度预测，统计达到区间/＞的像素数/＞，其中/＞为集群不同灰度值；步骤35：单个集群的最佳曝光时间为满足区间像素数最多的曝光时间：步骤36：将所述累计函数的/＞初始化为步骤35中最佳曝光时间对应的灰度值，重复步骤33-35，直到新增的集群占比/＞小于/＞。2.根据权利要求1所述的用于三维形貌测量的自适应多重曝光方法，其特征在于，所述基准曝光时间的计算方法为：其中，表示像素在初始曝光下的灰度值，/＞表示初始曝光时间，/＞表示设置的最大的期望像素灰度值。3.根据权利要求2所述的用于三维形貌测量的自适应多重曝光方法，其特征在于，所述步骤四包括：将不同曝光时间采集的条纹图存储到序列中，为了生成掩模，将同一曝光时间的条纹图合成基准图序列/＞，定义合成方法所需的掩模为/＞，其计算公式为：式中：和/＞分别为基准图序列/＞中第/＞幅图像、第/＞幅图像在坐标/＞处的像素灰度值，/＞为曝光次数，最亮不饱和阈值设置为相机线性响应最大值/＞；定义合成的条纹图案序列为，其计算公式为：式中：为掩模图像序列/＞中第/＞幅图像在坐标/＞处的像素灰度值,为条纹图序列/＞第/＞幅图像在坐标/＞处的像素灰度值。4.根据权利要求2所述的用于三维形貌测量的自适应多重曝光方法，其特征在于，如果，那么所述基准曝光时间计算简化为：。5.根据权利要求1所述的用于三维形貌测量的自适应多重曝光方法，其特征在于，所述细化间隔。6.根据权利要求1所述的用于三维形貌测量的自适应多重曝光方法，其特征在于，所述步骤33中取/＞。7.一种三维形貌测量方法，其特征在于，所述三维形貌测量方法首先采用权利要求1-6任一项所述的用于三维形貌测量的自适应多重曝光方法得到合成的条纹图，然后通过所述合成的条纹图计算绝对相位信息，联合标定参数得到三维点云数据。8.一种三维形貌测量系统，其特征在于，所述系统采用权利要求7所述的三维形貌测量方法进行测量，所述系统包括：数字投影仪，用于对待测物体进行条纹投影；工业相机，用于采集条纹图像；计算机，基于采集的条纹图像，采用权利要求7所述的三维形貌测量方法对所述待测物体进行三维形貌测量。9.根据权利要求8所述的三维形貌测量系统，其特征在于，所述工业相机和数字投影仪两者的光轴平行且垂直于工作平面。
说明书desc
技术领域本发明涉及一种用于三维形貌测量的自适应多重曝光方法，属于光学三维重建技术领域。背景技术随着科技的发展，三维形貌测量技术在汽车制造、缺陷检测、虚拟现实、医疗美容、文物保护和记录等领域不同行业得到了广泛应用。其中条纹投影轮廓术因非接触式、精度高、检测灵活等优势而发展迅速，其原理是将计算机计算出的光栅条纹通过投影仪投影在被测物体的表面，然后通过相机采集获取被测物表面因高度变化而发生形变的光栅图像，从这些捕获的图像中，采用相关算法来获得绝对相位图，最后联合标定参数计算三维数据。然而，该技术面对弱反射或强反射表面时，采集的图像会出现局部过饱和或过暗的现象，无论是过饱和引起的信息失真，还是过暗导致的低信噪比，都会增大绝对相位的计算误差，最终影响被测物的测量精度。针对这个问题，国内外学者提出了许多不同的解决方法：文献“FENG S, ZHANG Y,CHEN Q, et al. General solution for high dynamic range three-dimensionalshape measurement using the fringe projection technique . Optics&amp;Lasers inEngineering, 2014, 59: 56-71.”利用灰度直方图的波谷把不同反射率的像素分割成不同簇群，分别计算不同簇群曝光时间，一定程度上提高曝光时间选择的合理性，但选择方式仍需人工选择，同时当被测物的直方图没有明显波峰和波谷呈现相对均匀的分布时，方法不太适用。文献“李兆杰, 崔海华, 刘长毅, et al. 一种基于自动多次曝光面结构光的形貌测量方法简 . 光学学报, 2018”提出了一种自动预测曝光时间方法，根据相机响应曲线和基准图像计算当前场景测量所需的曝光时间和次数，此方法能适应不同反射率被测物，但预测过程需要拍摄大量纯白图，整个过程相对复杂费时。文献“LI S, DA F, RAO L.Adaptive fringe projection technique for high-dynamic range three-dimensionalshape measurement using binary search . Optical Engineering, 2017, 56:1.”提出了一种自适应条纹投影技术，采集正交条纹获取相机和投影仪的坐标匹配，接着利用最小二乘自适应的生成新条纹图。该方法匹配精度受初次投影的正交条纹影响，同时二分法阈值的选取不够准确。文献“LIN H. Automatic optimal projected lightintensity control for digital fringe projection technique . OpticsCommunications: A Journal Devoted to the Rapid Publication of ShortContributions in the Field of Optics and Interaction of Light with Matter,2021, 484.”提出了一种自动确定条纹图投影的最佳光强数及相应光强值的方法，根据被测物体表面反射率利用聚类方法得到不同投影条纹强度值，该方法可以不用预先进行相机和投影仪的坐标匹配，能较好测量反射率变化范围较大的物体，但其最佳光强数的选择不够智能。文献“CHUFAN, JIANG, TYLER, et al. High dynamic range real-time 3Dshape measurement . Optics Express, 2016.”增加投射一组倒置的条纹，对未饱和的像素值参与绝对相位计算，其方法对曝光不严重的区域有良好的效果，但不适合于强烈反光以及过暗的区域。文献“贺嘉伟, 许新科, 孔明, et al. 基于面结构光的金属表面高光抑制方法研究 . 中国测试, 2021, : 047”通过增加偏振滤光片方法，有效去除强烈高光，但需要根据光路调整偏振滤光片的角度，同时降低了整个图像的强度导致部分区域的信噪比过低。文献“陈超文, 薛俊鹏, 张启灿, et al. 基于多视方程的高反光物体表面三维形貌测量 . 光学学报, 2021, : 041.”将投影仪和双目组成多视系统，通过增加视角以及相应的像素匹配处理，解决过曝问题，但其增加了硬件的复杂性。发明内容为了解决上述问题，本发明基于多重曝光技术，提出了一种用于三维形貌测量的自适应多重曝光方法，该方法可以适用于高动态范围表面的三维形貌自动重建。首先通过根据空白图的直方图累计函数计算基准曝光时间。将基准曝光采集的条纹图序列逐像素筛选出同一像素位置最大灰度值作为基准图，以基准图像中低反射率像素作为初始集群，设定高信噪比像素最低灰度值，按一定步长不断增大曝光时间，统计不同曝光时间预测下集群达到高信噪比的像素数，最佳曝光时间为满足条件的最多像素数对应的曝光时间，更新参与计算的集群，通过迭代得到多个曝光时间序列。最后，在相机响应的线性区间内将不同曝光时间获取的条纹图进行合成，得到新的条纹图像序列，图像合成后可进行三维形貌测量。该方法分别从整体和局部进行考虑，能对具有高动态反射率表面物体自动三维重建，有效提高了条纹投影轮廓术的应用范围。本发明的第一个目的在于提供一种用于三维形貌测量的自适应多重曝光方法，方法包括：步骤一：获取相机的标定参数，通过一次标定得到相机线性响应截距、灰度响应线性区间/＞；步骤二：基于所述步骤一得到的相机线性响应截距和最大的期望像素灰度值计算基准曝光时间；步骤三：对所述基准曝光时间下采集的条纹图序列融合得到基准图像，基于所述基准图像直方图划分集群，计算每个集群的最佳曝光时间，得到最佳多重曝光时间序列；步骤四：在所述最佳多重曝光时间序列下分别采集条纹图，并对条纹图进行合成得到新的条纹图像序列；所述步骤三包括：步骤31：对所述基准曝光时间下采集的条纹图像进行融合；其中，表示第i幅条纹图在坐标/＞处的灰度值，k表示单个曝光采集的条纹图数量，/＞表示基准图在坐标/＞处的灰度值；步骤32：计算融合图像的直方图，对直方图进行细化处理：其中，为灰度直方图不同灰度值/＞对应的像素数，/＞为细化间隔；步骤33：计算细化直方图的累计函数：不断增大，/＞每增加/＞划分为一个集群；步骤34：对集群直方图的每个灰度值计算预测曝光时间，并以此作为全局最佳曝光时间对集群所有像素进行灰度预测，统计达到区间/＞的像素数/＞，其中/＞为集群不同灰度值；步骤35：单个集群的最佳曝光时间为满足区间像素数最多的曝光时间：步骤36：将所述累计函数的/＞初始化为步骤35中最佳曝光时间对应的灰度值，重复步骤33-35，直到新增的集群占比/＞小于/＞。可选的，所述基准曝光时间的计算方法为：其中，表示像素在初始曝光下的灰度值，/＞表示初始曝光时间，/＞表示设置的最大的期望像素灰度值。可选的，所述步骤四包括：将不同曝光时间采集的条纹图存储到序列中，为了生成掩模，将同一曝光时间的条纹图合成基准图序列/＞，定义合成方法所需的掩模为/＞，其计算公式为：式中：和/＞分别为基准图序列/＞中第/＞幅图像、第/＞幅图像在坐标处的像素灰度值，/＞为曝光次数，最亮不饱和阈值设置为相机线性响应最大值/＞；定义合成的条纹图案序列为，其计算公式为：式中：为掩模图像序列/＞中第/＞幅图像在坐标/＞处的像素灰度值,为条纹图序列/＞第/＞幅图像在坐标/＞处的像素灰度值。可选的，如果，那么所述基准曝光时间计算简化为：。可选的，所述细化间隔。可选的，所述步骤33中取/＞。本发明的第二个目的在于提供一种三维形貌测量方法，首先采用上述任一项所述的自适应多重曝光方法得到合成的条纹图，然后通过所述合成的条纹图计算绝对相位信息，联合标定参数得到三维点云数据。本发明的第三个目的在于提供一种三维形貌测量系统，采用上述的三维形貌测量方法进行测量，所述系统包括：数字投影仪，用于对待测物体进行条纹投影；工业相机，用于采集条纹图像；计算机，基于采集的条纹图像，采用上述的三维形貌测量方法对所述待测物体进行三维形貌测量。可选的，所述工业相机和数字投影仪两者的光轴平行且垂直于工作平面。本发明有益效果是：本发明提出了一种用于三维形貌测量的自适应多重曝光方法，对于具有大范围的反射率变化的物体，本发明方法可以自动预测多个最佳曝光时间，确保物体不同反射率区域能被捕获且具有良好的对比度。与手动选择多个曝光相比，本发明方法减少人工干预，自动化程度高。实验结果表明本发明方法能适应反射率相差较大场景，可以较好重建出高动态范围物体的三维形貌，且相较于现有方法，本发明方法的重建点云更加完整且精度更高。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明的条纹生成与采集系统结构图。图2本发明的用于三维形貌测量的自适应多重曝光方法的流程图。图3本发明实施例的相机响应实验结果图。图4本发明实施例的预测准确性验证图。图5本发明实施例的美工刀和石膏像实物图。图6本发明实施例的基准曝光时间预测图。图7本发明实施例的不同曝光时间获取的图像。图8传统方法与本发明方法测量结果对比图。图9传统方法与本发明方法误差分析图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明实施方式作进一步地详细描述。实施例一：本实施例提供一种用于三维形貌测量的自适应多重曝光方法，包括：步骤一：获取相机的标定参数，通过一次标定得到相机线性响应截距、灰度响应线性区间/＞；步骤二：基于步骤一得到的相机线性响应截距和最大的期望像素灰度值/＞计算基准曝光时间；步骤三：对基准曝光时间下采集的条纹图序列融合得到基准图像，基于基准图像直方图划分集群，计算每个集群的最佳曝光时间，得到最佳多重曝光时间序列；步骤四：在最佳多重曝光时间序列下分别采集条纹图，并对条纹图进行合成得到新的条纹图像序列。实施例二：本实施例提供一种用于三维形貌测量的自适应多重曝光方法，本实施例设计的结构光传感系统由工业相机和数字投影仪组成。相机和投影仪两者的光轴平行且垂直于工作平面，水平间距为70mm，工作距离为480mm。为了减少环境光的影响，投影仪投影蓝光正弦条纹。投影仪投射预先烧录的正弦条纹图，相机采集由物体高度调制而产生变形的条纹图，通过解相、相位展开等处理，可以计算出与像素坐标严格对应的绝对相位信息，联合系统标定参数计算出物体的三维坐标。给定一个具有未知表面反射率的任意物体，能够预测多个最佳曝光时间。为了能达到未知物体最佳曝光时间预测，需要对相机响应函数进一步分析。条纹投影系统的条纹图案形成过程如图1所示，编码条纹由计算机生成并发送到指定投影仪，投影仪接收后投影图案到被测物体表面，相机捕获被测量物体反射的投影仪光强以及周围环境光强。通常相机具有良好的线性光度响应，相机捕获的图像可以表示为：式中：是与相机增益、光圈大小等相关的参数，/＞是相机曝光时间，/＞为相机噪声，/＞表示被测物反射投影仪的光强。假设投影仪的光随着时间的推移大致恒定，环境光以及物体间相互反射光/＞相对不变，实际直接进入相机的环境光/＞远小于/＞，可以忽略不计，令/＞，对于不同反射率的被测物而言，/＞保持相对恒定，所以：其中，、/＞、/＞分别表示图像列、行、曝光时间，/＞表示在曝光时间/＞下相机采集的图像中像素坐标/＞处的光强，/＞表示坐标/＞处与反射率和投影光强相关的参数，/＞表示坐标/＞处与噪声相关的参数，/＞表示相机线性响应截距。整理公式可以得到：表示相机采集光强。本实施例方法的整体流程如图2所示。首先获取标定参数，通过一次标定得到相机线性响应截距、灰度响应线性区间/＞。其次计算基准曝光时间，基准曝光时间采集的条纹图序列融合得到基准图像，基于基准图像直方图划分集群，计算局部最佳曝光时间，通过更新参与计算的像素集群动态得到多个最佳曝光时间；最后输出由基准曝光时间和迭代计算的局部最佳曝光时间共同组成的曝光时间序列。1）获取标定参数实际相机并不是严格线性响应，需要对相机响应函数进行拟合，根据线性区间设置测量范围，具体流程如下：投影仪投射空白图，将具有不同反射率的色条放置在相机视野中，相机曝光时间以一定步长不断增大，每个曝光时间下采集一张图像，直到所有区域都过曝停止采集。对每个不同反射率像素区域取灰度均值作为当前曝光时间下的灰度响应，拟合相机响应曲线，如图3所示，不同曲线代表不同反射率的相机响应，相机响应在灰度区间内表现出良好线性，不同反射率的响应曲线与/＞轴截距为/＞，通过拟合曲线可以得到四个不同反射率的截距分别为0.3、0.2、0.1、0.08，均远小于255，所以本实施例的截距/＞的影响可以忽略。2）计算基准曝光时间基准曝光时间主要考虑的是尽可能提高采集图像整体灰度值且绝大多数像素灰度值不会过饱和。从公式可以看出，随着曝光时间的增加，图像整体灰度值在不断提高，而最先达到饱和的像素是值较大的区域所对应的像素。对于单个曝光时间而言，/＞值较大的区域对应像素点的灰度值较高，所以基准曝光时间可以通过给定像素点中最大的灰度值计算确认。为了实现基准曝光时间确认，本实施例统计采集图像灰度累积分布百分比，通过设置百分比阈值从全局图像中得到给定像素点，从给定的像素点中找到最大灰度值。首先计算累积函数：其中为像素总数，/＞为图像灰度直方图，在8位相机图像中/＞。然后，通过设置百分比阈值使，设置最大的期望像素灰度值为/＞，初始曝光时间/＞，基准曝光时间/＞可以由下式确定：表示像素在初始曝光下的灰度值，/＞表示初始曝光时间，由手动设置，/＞表示设置的最大的期望像素灰度值。不断降低相机曝光时间直到绝大部分像素不过曝，此时曝光时间为初始曝光时间，为了得到基准曝光时间，需要以初始曝光时间采集的图像为基础计算基准曝光时间，基准曝光时间就是考虑全局，作为全局最佳曝光时间。进一步，如果，那么基准曝光时间计算可以简化为：3）迭代计算多个曝光时间在基准曝光的基础上，对基准曝光时间捕获的图像进行条纹图融合，基于融合图自动确定多个最佳曝光时间。对于公式，如果提前获取参数以及每个像素对应的，就可以预测每个像素在不同曝光时间下的强度值。然而，在实际应用过程中，无法分别对每个像素的最佳曝光进行采集。考虑到单个曝光时间是可以满足一部分反射区域达到低误差灰度区间，所以对于通常测量场景，通过多个曝光时间能够满足测量需求。实际计算过程中，对于反射率变化较大且分布均匀的物体需要的曝光次数过多，降低了效率。本实施例从重建效率和质量考虑，提出了一种动态计算多重最佳曝光的策略：首先，对基准曝光时间捕获的条纹图像进行融合得到基准图像，对基准图像进行直方图降维。考虑到相机采集是离散的，对直方图进行细化处理以降低离散采集带来的量化误差，使得曝光时间预测更加准确。计算细化直方图的累计函数，以灰度值作为特征，每增加一定比例的像素数划分为一个集群，每个集群计算不同曝光时间预测的灰度值，设定灰度下限=150，统计达到灰度下限/＞和最大灰度值/＞之间的像素数，其中使得满足区间的像素数量最多的曝光时间是最佳曝光时间，最终迭代得到多重最佳曝光时间序列。具体的步骤总结如下：step1：对基准曝光采集的条纹图像进行融合；其中，表示第i幅条纹图在坐标/＞处的灰度值，k表示单个曝光采集的条纹图数量，/＞表示基准图在坐标/＞处的灰度值。step2：计算融合图像的直方图，由于相机采样是离散的，为了缓解离散采样带来的最佳曝光时间预测不准确问题，对直方图进行细化处理，其中为灰度直方图不同灰度值/＞对应的像素数，/＞为细化间隔。step3：根据公式，计算细化直方图的累计函数，不断增大/＞，/＞每增加划分为一个集群，/＞人为定义，/＞越小，曝光次数就越多。step4：对集群直方图的每个灰度值计算预测曝光时间，并以此作为全局最佳曝光时间对集群所有像素进行灰度预测，统计达到区间/＞的像素数/＞，其中为集群不同灰度值；step5：单个集群的最佳曝光时间为满足区间像素数最多的曝光时间：step6：累计函数的初始化为step 5中最佳曝光时间对应的灰度值，重复step3-5，直到新增的集群占比/＞小于/＞。4）多次曝光图像合成对于高动态范围物体，高曝光时间下低反射区域条纹对比度更高，而高反射率区域采用低曝光采集，图像可以保留更多的细节。通过多次曝光条纹合成，充分利用相移算法逐像素三维重建的优点，得到细节更丰富、对比度更高的条纹合成图。条纹合成的核心思想是选择不同曝光时间下每个像素位置的最亮不饱和像素。将不同曝光时间采集的条纹图存储到序列中，为了生成掩模，需要将同一曝光时间的条纹图融合成基准图序列/＞，定义合成方法所需的掩模为/＞，其计算公式为：式中：和/＞分别为基准图序列/＞中第/＞幅图像、第/＞幅图像在坐标处的像素灰度值，/＞为曝光次数，最亮不饱和阈值设置为相机线性响应最大值/＞。定义合成的条纹图案序列为，其计算公式为式中：为掩模图像序列/＞中第/＞幅图像在坐标/＞处的像素灰度值,为条纹图序列/＞第/＞幅图像在坐标/＞处的像素灰度值。最终可以通过合成的条纹图计算绝对相位信息，联合标定参数得到三维点云数据，从而得到三维形貌测量结果，重建的计算过程如下：以横向条纹图进行分析，对于N步相移，相机采集图像上任一像素满足以下表达式式中：为第/＞幅图像中像素点/＞的灰度值；/＞为像素点/＞处背景灰度值；/＞为像素点/＞的灰度调制；/＞为像素点/＞需要求解的相位主值。利用最小二乘求解可以求出N步相移的相位主值：由于公式使用反正切函数计算相位，所以计算的相位值是在值域区间内，称为包裹相位，包裹相位损失了周期信息，所以对包裹相位进行展开就是为了得到实际相位的周期数，本实施例通过多频外差法计算出每个像素相位主值以及展开后全场唯一的绝对相位，通过相位展开可以得到完整的相位值为：其中：表示条纹相移求解的相位主值，/＞为当前像素实际的周期数。为了进一步说明本发明的有益效果，进行了实验，实验过程和结果如下：使用搭建的三维形貌测量系统来验证所提方法的正确性，该系统由大恒灰度相机MER-1070-14U3M、焦距为35mm的Computar镜头、数字投影仪和一台处理器为 i7-10700， 显卡为英伟达GeForce RTX 3060和 32 GB 内存的计算机组成。采用四步相移和多频外差方法进行测量，自适应预测多重曝光方法共需投射1张空白图和12张条纹图。为了保证测量的准确性，本实验测量本发明发方法直方图预测与实际的灰度直方图对比。如图4所示，分别采集5000us、10000us曝光时间采集的图像并对其直方图分析，以5000us为基准图像利用本发明方法对10000us曝光时间采集的图像进行直方图预测，结果显示本发明方法灰度预测与实际较为接近，考虑到传感器噪声以及离散采样误差等因素，预测与实际的偏差可以接受。为了验证本发明方法的有效性，选择具有反射率相差较大的石膏像和美工刀作为测量对象，实物图如图5所示，石膏像具有较高的反射率，为了使得采集的图像不过曝，降低相机曝光时间，高反射率区域的像素能很好的被相机捕获而不会过饱和，但是低反射区域的像素光强过低导致其信噪比过低，相位解包裹存在错误。如果逐渐增大曝光时间，能提高低反射区域的亮度，提高其信噪比，但是高曝光会导致高反射率区域过亮，采集的图像光强超过了相机捕获的强度范围，造成相机过饱和问题。显然，单一曝光时间无法同时满足不同反射率工件的重建要求。因此，本发明自动预测多个不同曝光时间，以适应被测物表面不同的反射率。第一步获取基准曝光时间：调低相机曝光时间至10使得采集的空白图不出现过曝现象，计算空白图的累积函数，如图6，设置百分比阈值使/＞，计算得到，设置最大的期望像素灰度值为240，根据公式可计算得基准曝光时间为19.83。第二步自动确定多个最佳曝光时间：对基准曝光采集的条纹图进行融合得到基准图像，对基准图像进行直方图降维，并以为间隔进行直方图细化，以/＞像素数为一个集群，设置灰度下限/＞为150，迭代计算最佳曝光时间序列，分别得到以下几个最佳曝光时间：13.60、3.62、2.75、2.38、1.98/＞。按几个最佳曝光时间进行图像采集，图7-图7所示为不同曝光时间采集的条纹图，图7为不同曝光采集条纹图的融合图，从图7中可以看出，不同反射率区域以不同曝光时间采集，低反射区域亮度得到了提升，而高反射区域也没有过曝，整体的亮度和对比度都得到了提升。图8显示了传统方法与本发明方法测量结果对比，其中图8是在石膏像条纹未过曝前提下进行三维重建的点云图，石膏像重建质量较好，但美工刀因为单一曝光时间过低出现点云与实际不符问题，如图8所示，可以发现刀柄上方出现漂浮的错误点云。图8是在图8的基础上提高了曝光时间，减少美工刀低反射区域解相错误问题，但从图8的石膏像放大细节图可以看出面部点云呈现水波纹形状误差，所以传统方法无法对高动态范围物体高质量重建。图8显示了本发明方法的3D重建效果斜视图，为了更好的显示数据的质量，图8和图8分别显示了美工刀和石膏像的特写图，从图中可以看出，美工刀重建完整没有出现错误点云，同时重建细节清晰，石膏像面部3D重建没有出现水波纹现象，整体重建质量较好。在没有人工干预的情况下，可以高质量重建出高动态范围的物体。实验表明，本发明方法可以自动预测多重最佳曝光，并且3D重建结果是令人满意的。为了进一步验证本发明三维形貌测量方法的有效性，将本发明应用到曲率变化较大的叶片和金属平板，如图9所示，叶片曲率变化大，曲面中间采集的光强大于曲面边缘，分别采用传统方法和本发明方法进行绝对相位求解，以20步相移计算的绝对相位作为理想相位计算相位误差，从图9 可以看出，曲面边缘部分是低反射率区域，传统方法计算得到的相位误差较大，图9为本发明方法计算的相位误差，除了边界和阴影区误差较大，其余区域相位误差都比较小。图9为采集的被测金属平板的图像，分别采用传统方法和本发明方法进行三维重建，生成的点云导入到Geomagic中，图9和图9为待测金属平板和Geomagic拟合平面之间的偏差，其中图9代表传统方法的重建偏差表示，图9代表本发明方法的重建偏差表示，可以看出图9中，金属平板右侧的高反光位置分布了很多深色斑点，颜色越深代表偏差越大，而图9中并没有出现这些深色斑点，因此与传统方法相比，本发明所提方法可以有效地减少重建偏差，能较好的完成高反光工件的三维形貌测量。本发明实施例中的部分步骤，可以利用软件实现，相应的软件程序可以存储在可读取的存储介质中，如光盘或硬盘等。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
