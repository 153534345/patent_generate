标题title
停车场场景下融合预测算法的车辆行为决策方法及装置
摘要abst
本发明公开了一种停车场场景下融合预测算法的车辆行为决策方法及装置，该方法包括：利用预测算法对目标车辆的行为进行预测；根据不同的预测结果对目标车辆的轨迹分别进行预测；包括：当预测行为为沿本车道直线行驶行为时，使用匀速运动模型对目标车辆的轨迹进行预测；当预测行为为驶离本车道驶入空闲停车位行为时，使用五次多项式模型对目标车辆的轨迹进行预测；将目标车辆的预测轨迹、目标车辆的当前状态和智能车辆的当前状态作为输入信息输入行为树决策算法中，输出智能车辆行为。
权利要求书clms
1.一种停车场场景下融合预测算法的车辆行为决策方法，应用于智能车辆，其特征在于，包括：利用预测算法对目标车辆的行为进行预测；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括目标车辆执行沿本车道直线行驶行为和驶离本车道驶入空闲停车位行为；根据不同的预测结果对目标车辆的轨迹分别进行预测；包括：当预测行为为沿本车道直线行驶行为时，使用匀速运动模型对目标车辆的轨迹进行预测；当预测行为为驶离本车道驶入空闲停车位行为时，使用五次多项式模型对目标车辆的轨迹进行预测；将目标车辆的预测轨迹、目标车辆的当前状态和智能车辆的当前状态作为输入信息输入行为树决策算法中，输出智能车辆行为。2.根据权利要求1所述的方法，其特征在于，预测算法为：当检测到目标车辆连续多个坐标点的航向角大于前一个坐标点的航向角且离车道线的距离小于阈值，则预测目标车辆在执行驶离本车道驶入空闲停车位行为。3.根据权利要求1所述的方法，其特征在于，利用预测算法对目标车辆的行为进行预测之前，还包括：建立停车场场景下车辆行驶的数据集；数据集中包括车道中心线的坐标、停车位中心点的坐标、车辆的坐标、车辆的速度和车辆正在执行的行为；其中，车辆正在执行的行为包括继续沿本车道直线行驶、驶离本车道驶入侧方停车位；构建基于长短时记忆网络LSTM的行为预测模型，模型的输入为预设时间长度内目标车辆历史轨迹数据信息，模型的输出为车辆行为的预测概率；车辆行为包括继续沿本车道直线行驶和驶离本车道驶入侧方停车位；从数据集中获取用来训练车辆行为预测模型的信息，包括：目标车辆具有时间序列的状态向量和预测结果的行为动作集；其中，状态向量包括目标车辆的历史轨迹、横向速度、纵向速度和与车道中心线的距离，预测结果的行为动作集包括沿着本车道直线行驶、驶离本车道驶入侧方停车位；使用从数据集中获取的信息对车辆行为预测模型进行训练，得到基于LSTM的预测算法；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括车辆继续沿本车道直线行驶、或者驶离本车道驶入侧方停车位。4.根据权利要求1所述的方法，其特征在于，使用五次多项式模型对目标车辆的轨迹进行预测包括：使用下列多项式对目标车辆的轨迹进行预测：y＝c0+c1x+c2x2+c3x3+c4x4+c5x5y'＝c1+2c2x+3c3x2+4c4x3+5c5x4y”＝2c2+6c3x+12c4x2+20c5x3其中，y表示车辆的纵坐标与横坐标的函数关系式，y'表示y对x的一阶导数，y”表示y对x的二阶导数，为车辆的坐标，c0～c5为五次多项式的系数，通过起始点的车辆坐标、起始点处y关于x的一阶、二阶导数、终点的车辆坐标、终点处y关于x的一阶、二阶导数，求出五次多项式的系数c0～c5；其中，起始点的车辆坐标为车辆当前点的坐标，终点的车辆坐标为目标停车位的中心点坐标；根据五次多项式的系数c0～c5得到公式，计算得到从起始点到终点的预测轨迹。5.根据权利要求1所述的方法，其特征在于，当目标车辆的行为预测结果为沿本车道直线行驶行为时，通过下式和使用匀速运动模型对目标车辆的轨迹进行预测：其中，X为车辆状态矩阵，为车辆的位置坐标，为车辆沿x方向的速度，/＞为车辆沿y方向的速度，Xk为第k次车辆状态矩阵，Xk为k+1次车辆状态矩阵，t为预测时间，Wk为取固定值的高斯噪声。6.根据权利要求1所述的方法，其特征在于，输出智能车辆行为包括：判断目标车辆与智能车辆的当前距离是否小于安全距离Ds；如果是，执行以最大减速度紧急刹车的行为；如果否，判断当目标车辆与智能车辆分别以当前状态行驶t秒后的距离是否小于安全距离Ds，如果是：执行减速行驶的行为。7.根据权利要求6所述的方法，其特征在于，通过下式计算安全距离Ds：其中，v表示智能车辆的速度，th表示车辆执行延时，amax表示智能车辆最大的减速度。8.一种停车场场景下融合预测算法的车辆行为决策装置，其特征在于，用于执行根据权利要求1-7中任一项所述的方法，该装置包括：收发模块，用于接收目标车辆的当前状态和智能车辆的当前状态；处理模块，用于：利用预测算法对目标车辆的行为进行预测；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括目标车辆执行沿本车道直线行驶行为和驶离本车道驶入空闲停车位行为；根据不同的预测结果对目标车辆的轨迹分别进行预测；包括：当预测行为为沿本车道直线行驶行为时，使用匀速运动模型对目标车辆的轨迹进行预测；当预测行为为驶离本车道驶入空闲停车位行为时，使用五次多项式模型对目标车辆的轨迹进行预测；将目标车辆的预测轨迹、目标车辆的当前状态和智能车辆的当前状态作为输入信息输入行为树决策算法中，输出智能车辆行为。
说明书desc
技术领域本发明涉及自动驾驶技术领域，特别是关于一种停车场场景下融合预测算法的车辆行为决策方法及装置。背景技术随着经济水平的快速增长和城镇化水平的不断提高，人们对汽车的需求量日益提高，汽车的保有量也持续增加。随之而来的是交通环境的拥挤，城市停车位资源紧张，停车位空间小等问题。自主泊车技术的出现和发展为解决泊车问题提供了新的思路，将有效解决泊车困难等痛点。在智能化发展的前期，基于资源、成本等因素，自主泊车系统出现了三种技术路线：单车智能方案、场端方案和车场协同方案。基于单车智能方案可以避免对停车场进行大规模改造，适用于各类停车场，技术上更接近低速L4自动驾驶场景，具备场景迁移能力。所以单车智能方案被众多主机厂所采纳。基于单车智能的自主泊车系统完全通过车端的软硬件技术进行感知、定位、决策、规划和控制。目前很多厂商对自主泊车的决策部分研究较少，使得该自主泊车系统决策部分智能化程度较弱，迫使很多场景需要驾驶员协同参与处理，导致泊车系统智能化程度低、停车效率较低。目前自主泊车系统中的决策方法主要有有限状态机、行为树等基于规则的方法，行为树是停车场场景下车辆行为决策较为流行的方法。该方法是一种基于规则的树状结构的决策方法，将智能车辆在停车场场景下所遇到的不同场景进行划分，建立不同的决策规则，从而保证车辆在停车场场景下的行驶安全性。但是，由于停车场场景存在空间狭小、车辆较多、视野不开阔等问题，受到有交互的车辆的影响，可能会存在智能车辆执行紧急停车等危险驾驶行为，不仅存在一定的安全性，还会影响乘坐的舒适性。因此，亟待提供一种停车场场景下考虑会车时对向车辆行驶轨迹的车辆行为决策方案。发明内容本发明的目的在于提供一种停车场场景下融合预测算法的车辆行为决策方法及装置来克服或至少减轻现有技术的上述缺陷中的至少一个。为实现上述目的，本发明提供一种停车场场景下融合预测算法的车辆行为决策方法，应用于智能车辆，包括：利用预测算法对目标车辆的行为进行预测；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括目标车辆执行沿本车道直线行驶行为和驶离本车道驶入空闲停车位行为；根据不同的预测结果对目标车辆的轨迹分别进行预测；包括：当预测行为为沿本车道直线行驶行为时，使用匀速运动模型对目标车辆的轨迹进行预测；当预测行为为驶离本车道驶入空闲停车位行为时，使用五次多项式模型对目标车辆的轨迹进行预测；将目标车辆的预测轨迹、目标车辆的当前状态和智能车辆的当前状态作为输入信息输入行为树决策算法中，输出智能车辆行为。优选的，预测算法为：当检测到目标车辆连续多个坐标点的航向角大于前一个坐标点的航向角且离车道线的距离小于阈值，则预测目标车辆在执行驶离本车道驶入空闲停车位行为。优选的，利用预测算法对目标车辆的行为进行预测之前，还包括：建立停车场场景下车辆行驶的数据集；数据集中包括车道中心线的坐标、停车位中心点的坐标、车辆的坐标、车辆的速度和车辆正在执行的行为；其中，车辆正在执行的行为包括继续沿本车道直线行驶、驶离本车道驶入侧方停车位；构建基于长短时记忆网络LSTM的行为预测模型，模型的输入为预设时间长度内目标车辆历史轨迹数据信息，模型的输出为车辆行为的预测概率；车辆行为包括继续沿本车道直线行驶和驶离本车道驶入侧方停车位；从数据集中获取用来训练车辆行为预测模型的信息，包括：目标车辆具有时间序列的状态向量和预测结果的行为动作集；其中，状态向量包括目标车辆的历史轨迹、横向速度、纵向速度和与车道中心线的距离，预测结果的行为动作集包括沿着本车道直线行驶、驶离本车道驶入侧方停车位；使用从数据集中获取的信息对车辆行为预测模型进行训练，得到基于LSTM的预测算法；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括车辆继续沿本车道直线行驶、或者驶离本车道驶入侧方停车位。优选的，使用五次多项式模型对目标车辆的轨迹进行预测包括：使用下列多项式对目标车辆的轨迹进行预测：y＝c0+c1x+c2x2+c3x3+c4x4+c5x5 y'＝c1+2c2x+3c3x2+4c4x3+5c5x4 y”＝2c2+6c3x+12c4x2+20c5x3 其中，y表示车辆的纵坐标与横坐标的函数关系式，y'表示y对x的一阶导数，y”表示y对x的二阶导数，为车辆的坐标，c0～c5为五次多项式的系数，通过起始点的车辆坐标、起始点处y关于x的一阶、二阶导数、终点的车辆坐标、终点处y关于x的一阶、二阶导数，求出五次多项式的系数c0～c5；其中，起始点的车辆坐标为车辆当前点的坐标，终点的车辆坐标为目标停车位的中心点坐标；根据五次多项式的系数c0～c5得到公式，计算得到从起始点到终点的预测轨迹。优选的，当目标车辆的行为预测结果为沿本车道直线行驶行为时，通过下式和使用匀速运动模型对目标车辆的轨迹进行预测：/＞其中，X为车辆状态矩阵，为车辆的位置坐标，为车辆沿x方向的速度，/＞为车辆沿y方向的速度，Xk为第k次车辆状态矩阵，Xk为k+1次车辆状态矩阵，t为预测时间，Wk为取固定值的高斯噪声。优选的，输出智能车辆行为包括：判断目标车辆与智能车辆的当前距离是否小于安全距离Ds；如果是，执行以最大减速度紧急刹车的行为；如果否，判断当目标车辆与智能车辆分别以当前状态行驶t秒后的距离是否小于安全距离Ds，如果是：执行减速行驶的行为。优选的，通过下式计算安全距离Ds：其中，v表示智能车辆的速度，th表示车辆执行延时，amax表示智能车辆最大的减速度。本发明实施例还提供一种停车场场景下融合预测算法的车辆行为决策装置，用于执行上述方法，该装置包括：收发模块，用于接收目标车辆的当前状态和智能车辆的当前状态；处理模块，用于：利用预测算法对目标车辆的行为进行预测；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括目标车辆执行沿本车道直线行驶行为和驶离本车道驶入空闲停车位行为；根据不同的预测结果对目标车辆的轨迹分别进行预测；包括：当预测行为为沿本车道直线行驶行为时，使用匀速运动模型对目标车辆的轨迹进行预测；当预测行为为驶离本车道驶入空闲停车位行为时，使用五次多项式模型对目标车辆的轨迹进行预测；将目标车辆的预测轨迹、目标车辆的当前状态和智能车辆的当前状态作为输入信息输入行为树决策算法中，输出智能车辆行为。本发明由于采取以上技术方案，其具有以下优点：本发明实施例中，在对目标车辆的轨迹进行预测时，首先对目标车辆的行为进行预测，然后对不同的预测行为使用不同的轨迹预测方法对目标车辆的未来轨迹进行预测。将目标车辆的预测轨迹输入决策方法中，智能车辆可以根据目标车辆的预测轨迹和当前状态信息进行更合理的决策，从而提高智能车辆在停车场场景下行驶的安全性和舒适性。附图说明图1为本发明提供的停车场场景下融合预测算法的车辆行为决策方法的流程示意图。图2为本发明提供的停车场场景下融合预测算法的车辆行为决策方法中判断目标车辆执行驶离本车道驶入空闲停车位行为的示意图。图3为本发明提供的停车场场景下融合预测算法的车辆行为决策方法所应用的停车场特定场景示意图。图4为本发明实施例提供的一种停车场场景下融合预测算法的车辆行为决策装置的结构示意图。图5为本发明实施例提供的一种停车场场景下融合预测算法的车辆行为决策装置的另一结构示意图。具体实施方式在附图中，使用相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面结合附图对本发明的实施例进行详细说明。在本发明的描述中，术语“中心”、“纵向”、“横向”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明保护范围的限制。在不冲突的情况下，本发明各实施例及各实施方式中的技术特征可以相互组合，并不局限于该技术特征所在的实施例或实施方式中。下面结合附图以及具体实施例对本发明做进一步的说明，需要指出的是，下面仅以一种最优化的技术方案对本发明的技术方案以及设计原理进行详细阐述，但本发明的保护范围并不仅限于此。本文涉及下列术语，为便于理解，对其含义说明如下。本领域技术人员应当理解，下列术语也可能有其它名称，但在不脱离其含义的情形下，其它任何名称都应当被认为与本文所列术语一致。本发明提供一种停车场场景下融合预测算法的车辆行为决策方法，应用于智能车辆，如图1所示，该方法包括：步骤11，利用预测算法对目标车辆的行为进行预测；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括目标车辆执行沿本车道直线行驶行为和驶离本车道驶入空闲停车位行为。其中，预测算法可以为：当检测到目标车辆连续多个坐标点的航向角大于前一个坐标点的航向角且离车道线的距离小于阈值，则预测目标车辆在执行驶离本车道驶入空闲停车位行为。例如，如图2所示，当检测到目标车辆连续三个坐标点的航向角大于前一个点的航向角θ1且离车道线的距离小于一定的阈值，则将目标车辆的行为认定为在执行驶离本车道驶入空闲停车位行为，将其余行为认定为继续沿本车道直线行驶行为。步骤12，根据不同的预测结果对目标车辆的轨迹分别进行预测；包括：当预测行为为沿本车道直线行驶行为时，使用匀速运动模型对目标车辆的轨迹进行预测；当预测行为为驶离本车道驶入空闲停车位行为时，使用五次多项式模型对目标车辆的轨迹进行预测。其中，使用五次多项式模型对目标车辆的轨迹进行预测包括：使用下列多项式对目标车辆的轨迹进行预测：y＝c0+c1x+c2x2+c3x3+c4x4+c5x5y'＝c1+2c2x+3c3x2+4c4x3+5c5x4y”＝2c2+6c3x+12c4x2+20c5x3 其中，y表示车辆的纵坐标与横坐标的函数关系式，y'表示y对x的一阶导数，y”表示y对x的二阶导数，为车辆的坐标，c0～c5为五次多项式的系数，通过起始点的车辆坐标、起始点处y关于x的一阶、二阶导数、终点的车辆坐标、终点处y关于x的一阶、二阶导数，求出五次多项式的系数c0～c5；其中，起始点的车辆坐标为车辆当前点的坐标，终点的车辆坐标为目标停车位的中心点坐标；根据五次多项式的系数c0～c5得到公式，计算得到从起始点到终点的预测轨迹。在一种实施方式中，目标停车位根据驶入左右侧不同停车位进行判断，当预测结果为驶入左侧停车位时，将距离车辆最近的左侧空闲停车位作为目标停车位，当预测结果为驶入右侧停车位时，将距离车辆最近的右侧空闲停车位作为目标停车位。起始点处y关于x的一阶、二阶导数可以通过起始点、起始点前第一个点和起始点前第两个点共三个点求出。终点处y关于x的一阶、二阶导数可以通过经验获得，即可以为预设经验值。而且，可以把停车行为简化为匀减速运动，到达终点的速度为0，从而可以求出目标车辆在执行驶离本车道驶入空闲停车位所需的总时间。其中，当目标车辆的行为预测结果为沿本车道直线行驶行为时，通过下式和使用匀速运动模型对目标车辆的轨迹进行预测：其中，X为车辆状态矩阵，为车辆的位置坐标，为车辆沿x方向的速度，/＞为车辆沿y方向的速度，Xk为第k次车辆状态矩阵，Xk为k+1次车辆状态矩阵，t为预测时间，Wk为取固定值的高斯噪声。在一种实施方式中，可以设置Wk为零，进一步简化计算过程。在一种实施方式中，可以p秒为单位对公式进行迭代计算，X是车辆状态矩阵，也就是每p秒对车辆的状态进行迭代更新。在一个示例中，可以设置t为2秒，p为0.1秒。步骤13，将目标车辆的预测轨迹、目标车辆的当前状态和智能车辆的当前状态作为输入信息输入行为树决策算法中，输出智能车辆行为。其中，输出智能车辆行为可以包括：判断目标车辆与智能车辆的当前距离是否小于安全距离Ds；如果是，执行以最大减速度紧急刹车的行为；如果否，判断当目标车辆与智能车辆分别以当前状态行驶t秒后的距离是否小于安全距离Ds，如果是：执行减速行驶的行为。可以通过下式计算安全距离Ds：其中，v表示智能车辆的速度，th表示车辆执行延时，amax表示智能车辆最大的减速度。本发明中，考虑到预测算法的精度存在一定的误差，并不只依赖于目标车辆的预测轨迹对智能车辆的行为进行决策，还对智能车辆的决策判断条件增加一定的约束。例如，上文考虑了目标车辆与智能车辆之间的安全距离，当目标车辆与智能车辆的当前距离大于安全距离，而且目标车辆与智能车辆分别以当前状态行驶t秒后的距离仍然大于安全距离时，才会根据目标车辆的预测轨迹对智能车辆的行为进行决策，输出车辆跟随、自由行驶、减速行驶等。其中，输出的智能车辆行为还可以包括下述行为的一种：路径跟随、换道避障、车辆停车，可以根据实际情形灵活设置。本发明可以应用于停车场特定场景下，如图3所示，该特定场景下的目标车辆包括在对向车道内行驶且与智能车辆有交互的其他车辆，此时目标车辆的行为有两种，一种为沿本车道继续直线行驶，这种行为不会对智能车辆的决策造成影响；另一种为驶离本车道驶入空闲停车位，这种行为对智能车辆的决策可能会产生一定的影响。所以在此场景下，对目标车辆的轨迹进行预测，会提高智能车辆决策的合理性。在一种实施方式中，利用预测算法对目标车辆的行为进行预测之前，还可以包括：建立停车场场景下车辆行驶的数据集；数据集中包括车道中心线的坐标、停车位中心点的坐标、车辆的坐标、车辆的速度和车辆正在执行的行为；其中，车辆正在执行的行为包括继续沿本车道直线行驶、驶离本车道驶入侧方停车位；构建基于LSTM的行为预测模型，模型的输入为预设时间长度内目标车辆历史轨迹数据信息，模型的输出为车辆行为的预测概率；车辆行为包括继续沿本车道直线行驶和驶离本车道驶入侧方停车位；从数据集中获取用来训练车辆行为预测模型的信息，包括：目标车辆具有时间序列的状态向量和预测结果的行为动作集；其中，状态向量包括目标车辆的历史轨迹、横向速度、纵向速度和与车道中心线的距离，预测结果的行为动作集包括沿着本车道直线行驶、驶离本车道驶入侧方停车位；使用从数据集中获取的信息对车辆行为预测模型进行训练，得到基于LSTM的预测算法；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括车辆继续沿本车道直线行驶、或者驶离本车道驶入侧方停车位。本发明实施例中，基于停车场场景的特殊性，可以将数据集分为沿本车道行驶数据集和驶离本车道数据集，其中驶离本车道数据集中可以包含驶入左侧停车位数据集和驶入右侧停车位数据集。使用上述数据集对基于LSTM的行为预测模型进行训练，提升该基于LSTM的行为预测模型对目标车辆驾驶行为预测的准确性。在一个示例中，数据集中包括车道中心线的坐标、停车位中心点的坐标、车辆的坐标、车辆的速度、车辆正在执行的行为。对基于LSTM的行为预测模型进行训练时，首先从数据集中获取用来训练基于LSTM的行为预测模型的信息，包括以下内容：目标车辆具有时间序列的状态向量St＝，其中包含目标车辆的历史轨迹、横向速度vx、纵向速度vy、与车道中心线的距离d；预测结果的行为动作集A＝，其中包含沿着本车道直线行驶LK，驶离本车道驶入左侧空闲停车位DLP，驶离本车道驶入右侧空闲停车位DRP。进一步地，基于LSTM的行为预测模型为由三层多个LSTM神经网络组成的网络结构；设置该模型的输入为时间长度为L的目标车辆历史轨迹数据信息，表示为ST1＝，其中包括该时间长度内50个采样的状态向量；并设置模型的输出为行为动作集A中的各动作的预测概率矩阵Φ＝。其中，θ1、θ2和θ3分别表示继续沿本车道直线行驶、驶离本车道驶入左侧停车位、驶离本车道驶入右侧停车位。容易理解，预测概率矩阵也可以只包含两个元素，即继续沿本车道直线行驶、以及驶离本车道驶入侧方停车位。LSTM网络为现有技术中封装好的算法。本示例中的LSTM算法包含三层网络，每一层网络包含多个LSTM单元，将车辆的历史轨迹数据信息和当前车辆状态输入到LSTM算法中，会以向量的方式依次通过多个LSTM单元和三层网络，不断改变网络的一些参数，将LSTM网络输出结果再输入到softmax函数中，得到车辆的不同行驶行为的概率。在三层的LSTM网络中，将目标车辆的历史轨迹数据和当前车辆状态输入到第一层LSTM网络中，第一层LSTM网络包含LSTM单元，该单元包括遗忘门、输入门和输出门。将上述这些信息输入该层LSTM单元之后得到输出向量，并作为同一层下一个LSTM单元和下一层LSTM的输入向量，再采用Softmax函数对数值特征进行归一化处理，从而输出三个行为动作的概率，进而完成对车辆行为的预测。本发明实施例中，在对目标车辆的轨迹进行预测时，首先使用基于学习的方法例如长短时记忆网络对目标车辆的行为进行预测，然后对不同的预测行为使用不同的轨迹预测方法对目标车辆的未来轨迹进行预测。当预测的行为为沿本车道直线行驶时，可使用基于物理模型的方法——匀速运动模型对目标车辆的轨迹进行预测；当预测的行为为驶离本车道驶入空闲停车位时，可使用五次多项式对目标车辆的轨迹进行预测。将目标车辆的预测轨迹输入决策方法中，智能车辆可以根据目标车辆的预测轨迹和当前状态信息进行更合理的决策，从而提高智能车辆在停车场场景下行驶的安全性和舒适性。本发明实施例提供一种停车场场景下融合预测算法的车辆行为决策装置，用于执行上述任一实施例、实施方式或示例中提供的方法，如图4所示，该装置包括：收发模块41，用于接收目标车辆的当前状态和智能车辆的当前状态；处理模块42，用于：利用预测算法对目标车辆的行为进行预测；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括目标车辆执行沿本车道直线行驶行为和驶离本车道驶入空闲停车位行为；根据不同的预测结果对目标车辆的轨迹分别进行预测；包括：当预测行为为沿本车道直线行驶行为时，使用匀速运动模型对目标车辆的轨迹进行预测；当预测行为为驶离本车道驶入空闲停车位行为时，使用五次多项式模型对目标车辆的轨迹进行预测；将目标车辆的预测轨迹、目标车辆的当前状态和智能车辆的当前状态作为输入信息输入行为树决策算法中，输出智能车辆行为。在一种实施方式中，预测算法可以为：当检测到目标车辆连续多个坐标点的航向角大于前一个坐标点的航向角且离车道线的距离小于阈值，则预测目标车辆在执行驶离本车道驶入空闲停车位行为。在一种实施方式中，处理模块42利用预测算法对目标车辆的行为进行预测之前，还可以用于：建立停车场场景下车辆行驶的数据集；数据集中包括车道中心线的坐标、停车位中心点的坐标、车辆的坐标、车辆的速度和车辆正在执行的行为；其中，车辆正在执行的行为包括继续沿本车道直线行驶、驶离本车道驶入侧方停车位；构建基于长短时记忆网络LSTM的行为预测模型，模型的输入为预设时间长度内目标车辆历史轨迹数据信息，模型的输出为车辆行为的预测概率；车辆行为包括继续沿本车道直线行驶和驶离本车道驶入侧方停车位；从数据集中获取用来训练车辆行为预测模型的信息，包括：目标车辆具有时间序列的状态向量和预测结果的行为动作集；其中，状态向量包括目标车辆的历史轨迹、横向速度、纵向速度和与车道中心线的距离，预测结果的行为动作集包括沿着本车道直线行驶、驶离本车道驶入侧方停车位；使用从数据集中获取的信息对车辆行为预测模型进行训练，得到基于LSTM的预测算法；预测算法的输入为目标车辆的历史轨迹信息和目标车辆的当前状态信息，输出为目标车辆的预测行为，包括车辆继续沿本车道直线行驶、或者驶离本车道驶入侧方停车位。在一种实施方式中，处理模块42使用五次多项式模型对目标车辆的轨迹进行预测包括：使用下列多项式对目标车辆的轨迹进行预测：y＝c0+c1x+c2x2+c3x3+c4x4+c5x5y'＝c1+2c2x+3c3x2+4c4x3+5c5x4y”＝2c2+6c3x+12c4x2+20c5x3其中，y表示车辆的纵坐标与横坐标的函数关系式，y'表示y对x的一阶导数，y”表示y对x的二阶导数，为车辆的坐标，c0～c5为五次多项式的系数，通过起始点的车辆坐标、起始点处y关于x的一阶、二阶导数、终点的车辆坐标、终点处y关于x的一阶、二阶导数，求出五次多项式的系数c0～c5；其中，起始点的车辆坐标为车辆当前点的坐标，终点的车辆坐标为目标停车位的中心点坐标；根据五次多项式的系数c0～c5得到公式，计算得到从起始点到终点的预测轨迹。在一种实施方式中，处理模块42用于：当目标车辆的行为预测结果为沿本车道直线行驶行为时，通过下式和使用匀速运动模型对目标车辆的轨迹进行预测：/＞其中，X为车辆状态矩阵，为车辆的位置坐标，为车辆沿x方向的速度，/＞为车辆沿y方向的速度，Xk为第k次车辆状态矩阵，Xk为k+1次车辆状态矩阵，t为预测时间，Wk为取固定值的高斯噪声。其中，处理模块42输出智能车辆行为包括：判断目标车辆与智能车辆的当前距离是否小于安全距离Ds；如果是，执行以最大减速度紧急刹车的行为；如果否，判断当目标车辆与智能车辆分别以当前状态行驶t秒后的距离是否小于安全距离Ds，如果是：执行减速行驶的行为。其中，通过下式计算安全距离Ds：其中，v表示智能车辆的速度，th表示车辆执行延时，amax表示智能车辆最大的减速度。需要说明，该装置的收发模块41和处理模块42可以执行上述方法实现中的任意对应操作，此处不再一一赘述。本发明实施例还提供一种停车场场景下融合预测算法的车辆行为决策装置，如图5所示，包括感知模块51、决策模块52、规划模块53和控制模块54，其中决策模块52包括行为预测子模块521、轨迹预测子模块522和行为决策子模块523三部分。其中感知模块51将感知到的目标车辆信息和智能车辆状态信息传输给决策模块52，决策模块52首先将目标车辆的信息输入到行为预测子模块521中，对目标车辆未来一段时间的行为进行预测，然后将预测结果和目标车辆的信息输入到轨迹预测子模块522中，该子模块根据以上信息对目标车辆的未来一段时间的轨迹进行预测，再将预测的目标车辆轨迹信息、目标车辆的信息和智能车辆状态信息输入到行为决策子模块523中，对车辆的行为进行合理且安全的决策。将决策结果输入到规划模块53中，生成智能车辆的行驶轨迹，再将行驶轨迹输入到控制模块54中，使智能车辆在停车场场景中安全且合理的行驶。本发明实施例中，在对目标车辆的轨迹进行预测时，首先对目标车辆的行为进行预测，然后对不同的预测行为使用不同的轨迹预测方法对目标车辆的未来轨迹进行预测。当预测的行为为沿本车道直线行驶时，可使用基于物理模型的方法——匀速运动模型对目标车辆的轨迹进行预测；当预测的行为为驶离本车道驶入空闲停车位时，可使用五次多项式对目标车辆的轨迹进行预测。将目标车辆的预测轨迹输入决策方法中，智能车辆可以根据目标车辆的预测轨迹和当前状态信息进行更合理的决策，从而提高智能车辆在停车场场景下行驶的安全性和舒适性。最后需要指出的是：以上实施例仅用以说明本发明的技术方案，而非对其限制。本领域的普通技术人员应当理解：可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
