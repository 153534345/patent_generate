标题title
基于RFID的数据采集及双重加密解密数据保护方法和装置
摘要abst
本发明提供一种基于RFID的数据采集及双重加密解密数据保护方法及装置，包括RFID溯源数据云平台生成公私钥对为品牌商业务平台颁发公钥，品牌商业务平台对RFID标签写入与TID相对应的标签密钥并组装数据，通过对称加密算法加密得到第一次加密数据，RFID溯源数据云平台对第一次加密数据使用私钥进行加密得到第二次加密数据；用户发送溯源请求，品牌商业务平台根据TID从RFID溯源数据云平台索引数据，使用公钥进行第一次解密获得第一次加密数据，使用对称算法进行第二次解密获得组装数据然后发送给用户。其实现溯源数据不被窃取，提高数据的安全性。
权利要求书clms
1.一种基于RFID的数据采集及双重加密解密数据保护方法，其特征在于，包括：构建RFID溯源数据云平台生成公私钥对，RFID溯源数据云平台为品牌商业务平台颁发公钥证书，品牌商业务平台对RFID标签进行初始化操作，并写入与标签唯一识别码TID相对应的标签密钥；品牌商业务平台读取RFID标签内的标签密钥并进行组装数据，根据标签密钥使用对称加密算法对组装数据进行第一次加密得到第一加密数据，将第一加密数据传输给RFID溯源数据云平台；RFID溯源数据云平台使用私钥进行第二次加密得到第二次加密数据，然后将第二次加密数据以标签唯一识别码TID为唯一索引凭证，聚合多个业务流程节点产生的数据存储在平台数据库中；用户读取RFID标签内的标签密钥和标签唯一识别码TID发送溯源请求，品牌商业务平台验证用户发送的标签密钥和标签唯一识别码TID，在RFID溯源数据云平台索引相应的数据，并使用公钥进行第一次解密获得第一次加密数据，再根据标签密钥使用对称算法进行第二次解密获得组装数据，然后发送给用户。2.根据权利要求1所述的基于RFID的数据采集及双重加密解密数据保护方法，其特征在于，所述RFID溯源数据云平台对RFID标签进行初始化操作包括：所述品牌商业务平台打印RFID电子标签表面条码，将标签秘钥写入EPC区域，并设置EPC锁定密码。3.根据权利要求2所述的基于RFID的数据采集及双重加密解密数据保护方法，其特征在于，所述与标签唯一识别码TID相对应的标签密钥生成流程包括：根据RFID 标签的TID计算出ShortTID；计算种子数，通过算法计算随机数，使用时间戳作为种子数；设置版本号；通过算法打散ShortTID、种子数和版本号的顺序；通过校验和算法计算校验和。4.根据权利要求3所述的基于RFID的数据采集及双重加密解密数据保护方法，其特征在于，所述品牌商业务平台使用对称加密算法进行第一次加密包括：通过RFID读写设备读取RFID标签的标签秘钥K3，并传输到所述品牌商业务平台；所述品牌商业务平台组装业务数据data，使用MD5散列函数对标签秘钥进行运算:K5=MD5；第一次加密使用対称加密算法AES=data1；所述品牌商业务平台通过HTTP接口将第一加密后的数据data1传输到所述RFID溯源数据云平台。5.根据权利要求4所述的基于RFID的数据采集及双重加密解密数据保护方法，其特征在于， 所述RFID溯源数据云平台使用非对称加密算法进行第二次加密包括：所述RFID溯源数据云平台使用非对称加密算法：RSA =data2；所述私钥与所述品牌商业务平台的公钥证书相对应；所述RFID溯源数据云平台将第二次加密数据data2存储到数据库中。6.根据权利要求5所述的基于RFID的数据采集及双重加密解密数据保护方法，其特征在于,所述品牌商业务平台从RFID溯源数据云平台获取相应的数据，并使用公钥进行第一次解密，获得第二次加密数据，通过对称算法进行第二次解密获得第一次加密数据包括：用户采集RFID标签的数据，并上传至品牌商业务平台；品牌商业务平台接收请求参数，向RFID溯源数据云平台发送获取第二次加密数据的请求，第一次数据解密：RSA=data1；品牌商业务平台使用MD5散列函数对标签密钥K3进行运算，获取秘钥K5=MD5；第二次数据解密：使用对称性加密算法：AES=data；将组装数据的明文信息data返回给用户进行数据展示或数据查阅。7.根据权利要求1所述的基于RFID的数据采集及双重加密解密数据保护方法，其特征在于,所述组装数据包括TID、时间、位置、事件描述及流程。8.一种应用如权利要求1-6任一项所述的基于RFID的数据采集及双重加密解密数据保护方法的装置，其特征在于，该装置包括：RFID溯源数据云平台，用于RFID存储的数据溯源，数据展示和数据查阅；品牌商业务平台，用于对RFID写入数据和锁定密码，并与所述RFID溯源数据云平台通信进行数据反馈；数据采集与传输模块，用于对RFID标签内存储的数据进行读取操作，并将读取的数据发送到所述品牌商业务平台；数据加密模块，用于将RFID标签内的数据进行加密解密操作；RFID标签，用于存储数据及参与加解密操作。9.一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1至6任一项所述基于RFID的数据采集及双重加密解密数据保护方法的步骤。10.一种计算机终端，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1至6任一项所述基于RFID的数据采集及双重加密解密数据保护方法的步骤。
说明书desc
技术领域本发明涉及数据加密技术领域，尤其涉及一种基于RFID的数据采集及双重加密解密数据保护方法和装置。背景技术目前RFID芯片在真实项目的使用过程中，EPC区域更多的是存储业务数据，根据一定的编码规则，解析出物品数字信息，可以在离线环境下实现数据的读取和解析，如国际通用事实上的GS1标准。但是在实际项目中很少在RFID可写区域内写入秘钥信息，来保证基于该RFID芯片所产生业务数据的安全，系统数据安全基本依靠上层软件实现数据加密，数据存储，数据解密。使用加密技术保障业务数据安全，并对加密秘钥进行管理，但是仍然存在秘钥丢失的风险，秘钥丢失后，数据库数据存在全量丢失的风险，危害性极大。因此，有必要提供一种新型的基于RFID的数据采集及双重加密解密数据保护方法及装置，以克服上述缺陷。发明内容本发明的目的在于提供一种新型的基于RFID的数据采集及双重加密解密数据保护方法及装置，其提高数据安全性，防止系统信息乱窜，保证数据真实可靠。为了达到上述目的， 本发明提供一种基于RFID的数据采集及双重加密解密数据保护方法，包括：构建RFID溯源数据云平台生成公私钥对，RFID溯源数据云平台为品牌商业务平台颁发公钥证书，品牌商业务平台对RFID标签进行初始化操作，并写入与标签唯一识别码TID相对应的标签密钥；品牌商业务平台读取RFID标签内的标签密钥并进行组装数据，根据标签密钥使用对称加密算法对组装数据进行第一次加密得到第一加密数据，将第一加密数据传输给RFID溯源数据云平台；RFID溯源数据云平台使用私钥进行第二次加密得到第二次加密数据，然后将第二次加密数据以标签唯一识别码TID为唯一索引凭证，聚合多个业务流程节点产生的数据存储在平台数据库中；用户读取RFID标签内的标签密钥和标签唯一识别码TID发送溯源请求，品牌商业务平台验证用户发送的标签密钥和标签唯一识别码TID，在RFID溯源数据云平台索引相应的数据，并使用公钥进行第一次解密获得第一次加密数据，再根据标签密钥使用对称算法进行第二次解密获得组装数据，然后发送给用户。本发明还提供一种基于RFID的数据采集及双重加密解密数据保护方法的装置，该装置包括：RFID溯源数据云平台，用于RFID存储的数据溯源，数据展示和数据查阅；品牌商业务平台，用于对RFID写入数据和锁定密码，并与所述RFID溯源数据云平台通信进行数据反馈；数据采集与传输模块，用于对RFID标签内存储的数据进行读取操作，并将读取的数据发送到所述品牌商业务平台；数据加密模块，用于将RFID标签内的数据进行加密解密操作；RFID电子标签，用于存储数据及参与加解密操作。本发明还提供一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现所述基于RFID的数据采集及双重加密解密数据保护方法的步骤。本发明还提供一种计算机终端，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现所述基于RFID的数据采集及双重加密解密数据保护方法的步骤。与相关技术相比较，本发明通过在UHF RFID芯片结合数字加密技术，在上层软件系统上实现数据双重加密，保护企业数据安全。双重加密技术采用对称性加密技术跟非对称性加密技术相结合，提高加密的复杂度，增加数据破译难度和破译成本，从而提高数据加密的安全性。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图，其中：图1为本发明基于RFID的数据采集及双重加密解密数据保护方法的流程图；图2为本发明基于RFID的数据采集及双重加密解密数据保护的加密流程图；图3为本发明基于RFID的数据采集及双重加密解密数据保护的解密流程图。具体实施方式下面将对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。请参阅图1，本发明提供一种基于RFID的数据采集及双重加密解密数据保护方法，包括：S1、构建RFID溯源数据云平台根据非对称加密算法生成公私钥对，RFID溯源数据云平台为品牌商业务平台颁发公钥证书，品牌商业务平台对RFID标签进行初始化操作，初始化操作包括：写入与标签唯一识别码TID相对应的标签密钥，打印RFID电子标签表面条码，将标签秘钥写入EPC区域，并设置EPC锁定密码。S2、品牌商业务平台读取RFID标签内的标签密钥并进行组装数据，组装数据包括但是不限于TID、IP地址、时间、位置、事件描述、地理位置信息及流程等需要以密文形式形成的数据。具体的，组装数据的方法可以为：品牌商业务平台从RFID读写设备中数据选择需要执行的指令数据生成MCU指令；其中，MCU指令包括MCU指令头数据和MCU指令参数数据；将MCU指令头数据作为所述指令头数据，将MCU指令参数数据做为所述指令参数数据段，并根据品牌商业务平台对数据的要求进行指令体数据组装处理生成所述指令体数据，再根据所述指令头数据和所述指令体数据进行RFID指令数据组装处理生成组装数据。如此，可以显著提高组装数据的效率。根据标签密钥使用对称加密算法对组装数据进行第一次加密得到第一加密数据，将第一加密数据传输给RFID溯源数据云平台；RFID溯源数据云平台使用私钥对第一次加密数据进行第二次加密得到第二次加密数据，然后将第二次加密数据以标签唯一识别码TID为唯一索引凭证，聚合多个业务流程节点产生的数据存储在平台数据库中；聚合多个业务流程节点产生的数据是指在RFID标签流通过程中产生的业务数据，都将以上述加密形式上传到RFID溯源数据云平台，并且都以标签唯一识别码TID为唯一索引凭证而形成同组数据。S3、用户读取RFID标签内的标签密钥和标签唯一识别码TID发送溯源请求，品牌商业务平台验证用户发送的标签密钥和标签唯一识别码TID，并验证数据是否一致，是，则进行业务处理，在RFID溯源数据云平台索引相应的数据，并使用公钥进行第一次解密获得第一次加密数据，再根据标签密钥使用对称算法进行第二次解密获得组装数据，然后发送给用户；否，则发送锁定命令给RFID标签禁止读写。下面将结合图2和图3进行详细描述，双重加密机制的整体解决方案包含四大部分，从下而上分别为：A、RFID电子标签，TID作为物品的电子身份证；EPC 数据作为标签秘钥，参与加密、解密操作。B、RFID读写设备；C、品牌商业务系统，处理业务逻辑，对业务数据进行加密、解密，将业务数据传输到溯源数据云平台；D、RFID溯源数据平台，中心化的数据平台，为品牌方颁发公钥证书，及使用非对称性加密算法进行二次加密。所述RFID溯源数据云平台为所述品牌商业务平台颁发公钥证书，公钥证书用于与所述RFID溯源数据平台进行真实性身份验证和加解密操作。所述品牌商业务平台打印RFID电子标签表面条码，将标签秘钥写入EPC区域，并设置EPC锁定密码。EPC  区域是 RFID 芯片中用来存储产品信息和识别产品的关键区域，存储在该区域的数据可读可写。它可以包含由GS1机构颁发的全球唯一标识码 ，以及厂商指定的批次号、序列号等信息，说明了唯一性和可追溯性。EPC区域的作用在于提高产品管理的可视性、自动化和准确性，有助于发掘新的应用和解决实际问题，进而为创新提供技术基础和发展空间。本发明中EPC区域写入的是与标签唯一识别码相对应的标签密钥，标签密钥生成流程如下：根据RFID 标签的标签唯一识别码TID计算出ShortTID；计算种子数，通过算法计算随机数，使用时间戳作为种子数；设置版本号；通过算法打散ShortTID、种子数和版本号的顺序；通过校验和算法计算校验和。Reserved 区域是 RFID 芯片中的保留区域，它用来存储访问/灭活口令信息。Reserved区域的作用在于预留灵活的创新和拓展空间，有助于应对未来不断变化的技术需求和创新机遇，进而为创新提供技术升级和拓展的可能性。利用Reserved区域功能可以实现RFID芯片的锁定功能，锁定后，改写EPC、User区数据需要访问密码，否则无权进行改写，提高了芯片的数据安全；实现RFID灭活功能，有效使用Kill命令后标签永远不会产生调制信号以激活射频场，从而使芯片永久失效。标签密钥指在RFID芯片可写区域EPC或User 区域写入跟TID对应的唯一秘钥信息，同时利用芯片锁定功能，对芯片写入设置访问权限，防止RFID芯片在市场流通过程中被恶意改写，造成秘钥丢失，引发数据安全问题。在实际项目应用中为了确保RFID标签秘钥的唯一性，需要根据一定的算法规则生成秘钥并通过RFID读写设备写入芯片内部。考虑到不同标签的芯片EPC区域长度不一致，不同的项目设置的唯一秘钥的长度并不固定，AES算法仅支持固定长度秘钥:128bit、192bit、256bit, 因此使用MD5信息摘要算法将不同长度的芯片秘钥转换成固定128bit，满足AES算法要求。当完成上述操作后就可以进行加密，操作如下：通过RFID读写设备读取标签秘钥K3，上传至品牌商业务平台；品牌商业务平台组装业务数据data；品牌商业务平台使用MD5散列函数对K3进行运算，获取秘钥K5=MD5；第一次加密，使用对称性加密算法：AES=data1；品牌商业务平台通过传输接口将数据data1传输至RFID溯源数据云平台；第二次加密，使用非对称性加密算法的私钥：RSA=data2；将数据data2存储到数据库。当第三方用户需要进行溯源时进行解密，操作如下：用户使用RFID读写器采集标签的数据，包含标签秘钥K3和TID，上传至品牌商业务平台；品牌商业务平台接收读写器请求数据进行业务处理；品牌商业务平台向RFID溯源数据云平台发送请求传输标签唯一识别码TID；品牌商业务平台根据TID在数据库查询密文数据 data2，第一次数据解密使用公钥证书：RSA=data1；使用MD5散列函数对K3进行运算，获取秘钥K5=MD5；第二次数据解密：使用对称性加密算法：AES=data；将明文信息data返回给第三方用户进行数据展示或数据查阅。数据解密通过两次解密操作保证标签秘钥不被第三个系统获取，提高系统安全等级；数据加密、解密操作需要RFID芯片的直接参与，提高了数据的安全性。数据加密技术是数据安全的核心技术，尤其是在当下万物互联的信息化时代。使得如何保护数据安全：数据不被窃取、不被篡改、不被破坏等问题越来越受到人们的重视。使用多种加密技术，利用一定的规则进行算法集成，使算法复杂化，提高破译难度和破译成本，因此数据就越安全。基于UHF RFID双重加密技术集成无线射频技术、数字加密技术、数据存储技术，属于基础性的技术研究，适用于所有使用RFID技术做信息化管理，并且对数据安全有严格要求的地方。在高度信息化的当前，做好数字化、信息化的管理往往需要集成不同场景、不同设备、不同应用、不同技术信息才能避免信息孤岛，实现数据互联互通，打造一体化的数字管理平台。本发明还提供一种基于RFID的数据采集及双重加密解密数据保护装置，该装置包括：RFID溯源数据云平台，用于RFID存储的数据溯源，数据展示和数据查阅；品牌商业务平台，用于对RFID写入数据和锁定密码，并与所述RFID溯源数据云平台通信进行数据反馈；数据采集与传输模块，用于对RFID标签内存储的数据进行读取操作，并将读取的数据发送到所述品牌商业务平台；数据加密模块，用于将RFID标签内的数据进行加密解密操作；RFID电子标签，用于存储数据及参与加解密操作。与相关技术相比较，本发明在RFID芯片可写区域写入跟TID对应的唯一秘钥信息，实现一个芯片一个秘钥，每一个芯片产生的业务数据只能根据该芯片对应的秘钥才能进行加密、解密。商品在供应链的流通过程中，难以收集所有的RFID秘钥信息，因此即使云平台数据泄露，黑客也无法进行数据解析，提高了平台数据的安全等级，保障了平台数据的安全。基于一个芯片一个秘钥这种动态性的秘钥，在数据消费端实现单物品的数据解密、数据展示、数据查看。该秘钥只能解密自己的数据，无法对其他数据进行解密，防止系统信息乱窜，保证数据真实可靠。使用非对称性算法对数据进行加解密，在加解密过程中确认通信双方的身份，确保数据合法有效。本发明另一方面还提供一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现上述基于RFID的数据采集及双重加密解密数据保护方法的步骤。作为本发明另一方面的延伸还提供一种计算机终端，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述基于RFID的数据采集及双重加密解密数据保护方法的步骤。所述处理器执行所述计算机程序时实现上述各装置实施例中各模块/单元的功能。示例性的，所述计算机程序可以被分割成一个或多个模块/单元，所述一个或者多个模块/单元被存储在所述存储器中，并由所述处理器执行，以完成本发明。所述一个或多个模块/单元可以是能够完成特定功能的一系列计算机程序指令段，该指令段用于描述所述计算机程序在终端设备中的执行过程。所述计算机终端可以是桌上型计算机、笔记本、掌上电脑及云端服务器等计算设备。可包括但不仅限于，处理器、存储器。可以包括更多或更少的部件，或者组合某些部件，或者不同的部件，例如还可以包括输入输出设备、网络接入设备、总线等。所述处理器可以是中央处理单元，还可以是其他通用处理器、数字信号处理器 、专用集成电路、现成可编程门阵列  或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。所述存储器可以是内部存储单元，例如硬盘或内存。所述存储器也可以是外部存储设备，例如插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，所述存储器还可以既包括内部存储单元也包括外部存储设备。所述存储器用于存储所述计算机程序以及其他程序和数据。所述存储器还可以用于暂时地存储已经输出或者将要输出的数据。所属领域的技术人员可以清楚地了解到，为了描述的方便和简洁，仅以上述各功能单元、模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能单元、模块完成，即将所述装置的内部结构划分成不同的功能单元或模块，以完成以上描述的全部或者部分功能。实施例中的各功能单元、模块可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中，上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。另外，各功能单元、模块的具体名称也只是为了便于相互区分，并不用于限制本申请的保护范围。上述系统中单元、模块的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述或记载的部分，可以参见其它实施例的相关描述。本领域普通技术人员可以意识到，结合本文中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、或者计算机软件和电子硬件的结合来实现。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本发明的范围。在本发明所提供的实施例中，应该理解到，所揭露的装置/终端设备和方法，可以通过其它的方式实现。例如，以上所描述的装置/终端设备实施例仅仅是示意性的，例如，所述模块或单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通讯连接可以是通过一些接口，装置或单元的间接耦合或通讯连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。所述集成的模块/单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明实现上述实施例方法中的全部或部分流程，也可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一计算机可读存储介质中，该计算机程序在被处理器执行时，可实现上述各个方法实施例的步骤。其中，所述计算机程序包括计算机程序代码，所述计算机程序代码可以为源代码形式、对象代码形式、可执行文件或某些中间形式等。所述计算机可读介质可以包括：能够携带所述计算机程序代码的任何实体或装置、记录介质、U盘、移动硬盘、磁碟、光盘、计算机存储器、只读存储器、随机存取存储器、电载波信号、电信信号以及软件分发介质等。需要说明的是，所述计算机可读介质包含的内容可以根据司法管辖区内立法和专利实践的要求进行适当的增减，例如在某些司法管辖区，根据立法和专利实践，计算机可读介质不包括电载波信号和电信信号。以上所述仅为本发明的实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其它相关的技术领域，均同理包括在本发明的专利保护范围内。
