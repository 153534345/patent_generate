标题title
髋关节实际位置配准方法、装置、电子设备及存储介质
摘要abst
本发明实施例提供了一种髋关节实际位置配准方法、装置、电子设备及存储介质，涉及图像处理技术领域。髋关节实际位置配准方法包括：确定三维模型上的第一配准位置以及第一配准区域；确定各第一配准位置在目标髋关节上对应的第二配准位置；对第一配准位置和第二配准位置进行配准，确定第一变换关系；获得在对应于第一配准区域的第二配准区域内采集的多个第三配准位置；根据三维模型表面各个点的位置、各第三配准位置与第一变换关系，确定第二变换关系；根据第一变换关系与第二变换关系，对目标髋关节上的实际位置进行位置配准。应用本发明实施例提供的方案可以准确地对髋关节的实际位置进行位置配准。
权利要求书clms
1.一种髋关节实际位置配准方法，其特征在于，所述方法包括：确定三维模型上的多个第一配准位置以及第一配准区域，其中，所述三维模型为与目标髋关节对应的三维模型；确定各第一配准位置在所述目标髋关节上对应的第二配准位置；对第一配准位置和第二配准位置进行位置配准，确定所述目标髋关节上的点与所述三维模型表面的点间位置的第一变换关系；获得在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的多个第三配准位置；根据所述三维模型表面各个点的位置、各第三配准位置与所述第一变换关系，确定所述目标髋关节上的点与所述三维模型表面的点间位置的第二变换关系；根据所述第一变换关系与所述第二变换关系，对所述目标髋关节上的实际位置进行变换，完成位置配准。2.根据权利要求1所述的方法，其特征在于，所述根据所述三维模型表面各个点的位置、第三配准位置与所述第一变换关系，确定所述目标髋关节上的点与所述三维模型表面的点间位置的第二变换关系，包括：根据所述第一变换关系对各第三配准位置进行位置变换，得到第四配准位置；针对每一第四配准位置，根据该第四配准位置与所述三维模型表面各个点的位置，确定所述三维模型表面上与该第四配准位置距离最近的第五配准位置；根据各第三配准位置以及与其对应的第五配准位置，确定所述目标髋关节与所述三维模型间的第二变换关系。3.根据权利要求1所述的方法，其特征在于，所述方法还包括：获得采集配准位置的工具在所述目标髋关节上采集的属于髋关节配准区域的第二区域更新位置；根据所述目标髋关节上采集的第二区域更新位置与所述第一变换关系，确定所述三维模型表面上与所述目标髋关节上采集的第二区域更新位置对应的第一区域更新位置；根据所确定的第一区域更新位置，更新所述第一配准区域。4.根据权利要求1所述的方法，其特征在于，所述获得在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的多个第三配准位置，包括：实时获得用于在所述目标髋关节上采集配准位置的工具的第一候选位置；根据所述第一变换关系，对所述第一候选位置进行位置变换，得到第二候选位置；判断所述第二候选位置是否位于所述第一配准区域内；当所述第二候选位置位于所述第一配准区域内时，响应于位置获得指令，获得所述工具的当前位置，并确定所述当前位置为第三配准位置。5.根据权利要求4所述的方法，其特征在于，在所述响应于位置获得指令，获得所述工具的当前位置，并确定所述当前位置为第三配准位置前，还包括：获得所述第二候选位置与所述三维模型表面间的最短距离；判断所述最短距离是否小于预设误差距离；若为是，则执行所述响应于位置获得指令，获得所述工具的当前位置，并确定所述当前位置为第三配准位置的步骤。6.根据权利要求1-5任一项所述的方法，其特征在于，所述确定三维模型上的多个第一配准位置以及第一配准区域，包括：获得用户在三维模型上选择的多个第一配准位置和髋关节的表征性位置，并获得各表征性位置的描述信息；根据所获得的表征性位置与描述信息，确定第一配准区域；和/或获得用户在所述三维模型上选择的多个第一配准位置以及框选区域；将所述框选区域确定为第一配准区域。7.根据权利要求1-5任一项所述的方法，其特征在于，所述确定各第一配准位置在所述目标髋关节上对应的第二配准位置，包括：获得第一髋关节参考架上凹槽的位置，作为第二配准位置，其中，所述第一髋关节参考架用于固定于所述目标髋关节上，所述第一髋关节参考架设置有多个凹槽，且多个凹槽连线构成不等边三角形，所述凹槽的位置由与双目相机相连的带有光学示踪球的手术探针采集得到；和/或获得第二髋关节参考架设置的示踪器的位置，作为第二配准位置，其中，所述示踪器的位置由双目相机采集得到；和/或获得与双目相机相连的带有反光阵列的手术探针在所述目标髋关节上采集的位置，作为第二配准位置；和/或所述获得在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的多个第三配准位置，包括：获得与双目相机相连的带有反光阵列的手术探针在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的位置，作为第三配准位置。8.一种髋关节实际位置配准装置，其特征在于，所述装置包括：三维模型重建模块，用于对目标髋关节的二维图像进行图像重建，得到所述目标髋关节的三维模型，并提取所述三维模型表面各个点的位置；第一配准位置确定模块，用于确定三维模型上的多个第一配准位置以及第一配准区域；第二配准位置确定模块，用于确定各第一配准位置在所述目标髋关节上对应的第二配准位置；第一变换关系确定模块，用于对第一配准位置和第二配准位置进行位置配准，确定所述目标髋关节上的点与所述三维模型表面的点间位置的第一变换关系；第三配准位置获得模块，用于获得在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的多个第三配准位置；第二变换关系确定模块，用于根据所述三维模型表面各个点的位置、各第三配准位置与所述第一变换关系，确定述目标髋关节上的点与所述三维模型表面的点间位置的第二变换关系；目标髋关节位置配准模块，用于根据所述第一变换关系与所述第二变换关系，对所述目标髋关节上的实际位置进行变换，完成位置配准。9.根据权利要求8所述的装置，其特征在于，所述第二变换关系确定模块，包括：第四配准位置变换子模块，用于根据所述第一变换关系对各第三配准位置进行位置变换，得到第四配准位置；第五配准位置确定子模块，用于针对每一第四配准位置，根据该第四配准位置与所述三维模型表面各个点的位置，确定所述三维模型表面上与该第四配准位置距离最近的第五配准位置；第二变换关系确定子模块，用于根据各第三配准位置以及与其对应的第五配准位置，确定所述目标髋关节与所述三维模型间的第二变换关系。10.根据权利要求8所述的装置，其特征在于，所述装置还包括：区域更新位置获得模块，用于获得采集配准位置的工具在所述目标髋关节上采集的属于髋关节配准区域的第二区域更新位置；区域更新位置确定模块，用于根据所述第二区域更新位置与所述第一变换关系，确定所述三维模型表面上与所述第二区域更新位置对应的第一区域更新位置；区域更新模块，用于根据所确定的第一区域更新位置，更新第一配准区域。11.根据权利要求8所述的装置，其特征在于，所述第三配准位置获得模块，包括：第一候选位置获得单元，用于实时获得用于在所述目标髋关节上采集配准位置的工具的第一候选位置；第二候选位置获得单元，用于根据所述第一变换关系，对所述第一候选位置进行位置变换，得到第二候选位置；位置判断单元，用于判断所述第二候选位置是否位于所述第一配准区域内；第三配准位置确定单元，用于当所述第二候选位置位于所述第一配准区域内时，响应于位置获得指令，获得所述工具的当前位置，并确定所述当前位置为第三配准位置。12.根据权利要求11所述的装置，其特征在于，所述第三配准位置获得模块还包括：最短距离获得单元，用于在所述第三配准位置确定单元触发前，获得所述第二候选位置与所述三维模型表面间的最短距离；最短距离判断单元，用于判断所述最短距离是否小于预设误差距离；若为是，则触发所述第三配准位置确定单元。13.根据权利要求8-12任一项所述的装置，其特征在于，所述第一配准位置确定模块，具体用于：获得用户在三维模型上选择的多个第一配准位置和髋关节的表征性位置，并获得各表征性位置的描述信息；根据所获得的表征性位置与描述信息，确定第一配准区域；和/或获得用户在所述三维模型上选择的多个第一配准位置以及框选区域；将所述框选区域确定为第一配准区域。14.根据权利要求8-12任一项所述的装置，其特征在于，所述第二配准位置确定模块，具体用于：获得第一髋关节参考架上凹槽的位置，作为第二配准位置，其中，所述第一髋关节参考架用于固定于所述目标髋关节上，所述第一髋关节参考架设置有多个凹槽，且多个凹槽连线构成不等边三角形，所述凹槽的位置由与双目相机相连的带有光学示踪球的手术探针采集得到；和/或获得第二髋关节参考架设置的示踪器的位置，作为第二配准位置，其中，所述示踪器的位置由双目相机采集得到；和/或获得与双目相机相连的带有反光阵列的手术探针在所述目标髋关节上采集的位置，作为第二配准位置；所述第三配准位置获得模块，具体用于获得与双目相机相连的带有反光阵列的手术探针在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的位置，作为第三配准位置。15.一种电子设备，其特征在于，包括处理器、通信接口、存储器和通信总线，其中，处理器，通信接口，存储器通过通信总线完成相互间的通信；存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现权利要求1-7任一所述的方法。16.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质内存储有计算机程序，所述计算机程序被处理器执行时实现权利要求1-7任一所述的方法。
说明书desc
技术领域本发明涉及图像处理技术领域，特别是涉及一种髋关节实际位置配准方法、装置、电子设备及存储介质。背景技术髋关节置换手术是一种常见的人工关节置换术，用于重建患者髋关节的正常功能。目前，医生需要根据患者的髋关节CT图像规划手术路径，然后手术机器人根据医生规划好的手术路径控制机械臂移动，从而协助医生进行髋关节置换手术。由于手术过程中髋关节的位置和形态与采集髋关节CT图像时髋关节的位置和形态往往不同，这样容易导致手术机器人难以精准地按照医生规划好的手术路径控制机械臂移动，控制准确度低。为了提高手术机器人控制机械臂移动的准确度，需要对髋关节这一实体进行位置配准。发明内容本发明实施例的目的在于提供一种髋关节实际位置配准方法、装置、电子设备及存储介质，以实现准确地对患者髋关节的实际位置进行位置配准。具体技术方案如下：根据本发明实施例的第一方面，提供了一种髋关节实际位置配准方法，所述方法包括：确定三维模型上的多个第一配准位置以及第一配准区域；确定各第一配准位置在所述目标髋关节上对应的第二配准位置；对第一配准位置和第二配准位置进行位置配准，确定所述目标髋关节上的点与所述三维模型表面的点间位置的第一变换关系；获得在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的多个第三配准位置；根据所述三维模型表面各个点的位置、各第三配准位置与所述第一变换关系，确定述目标髋关节上的点与所述三维模型表面的点间位置的第二变换关系；根据所述第一变换关系与所述第二变换关系，对所述目标髋关节上的实际位置进行变换，完成位置配准。根据本发明实施例的第二方面，提供了一种髋关节实际位置配准装置，所述装置包括：第一配准位置确定模块，用于确定三维模型上的多个第一配准位置以及第一配准区域；第二配准位置确定模块，用于确定各第一配准位置在所述目标髋关节上对应的第二配准位置；第一变换关系确定模块，用于对第一配准位置和第二配准位置进行位置配准，确定所述目标髋关节上的点与所述三维模型表面的点间位置的第一变换关系；第三配准位置获得模块，用于获得在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的多个第三配准位置；第二变换关系确定模块，用于根据所述三维模型表面各个点的位置、各第三配准位置与所述第一变换关系，确定述目标髋关节上的点与所述三维模型表面的点间位置的第二变换关系；目标髋关节位置配准模块，用于根据所述第一变换关系与所述第二变换关系，对所述目标髋关节上的实际位置进行变换，完成位置配准。根据本发明实施例的第三方面，提供了一种电子设备，包括处理器、通信接口、存储器和通信总线，其中，处理器，通信接口，存储器通过通信总线完成相互间的通信；存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现上述第一方面所述的髋关节实际位置配准方法。根据本发明实施例的第四方面，提供了一种计算机可读存储介质，所述计算机可读存储介质内存储有计算机程序，所述计算机程序被处理器执行时实现上述第一方面所述的髋关节实际位置配准方法。本发明实施例有益效果：本发明实施例提供的髋关节实际位置配准方案，可以对目标髋关节的二维图像进行图像重建，得到三维模型，并在重建得到的三维模型上确定第一配准位置；根据第一配准位置在目标髋关节上确定第二配准位置。这样，根据第一配准位置与第二配准位置，可以确定第一变换关系。电子设备根据所确定的第一变换关系与第三配准位置确定第二变换关系。由于第二变换关系是在第一变换关系基础上确定的，第二变换关系比第一变换关系更准确。这样，根据第一变换关系与第二变换关系对目标髋关节上的实际位置进行变换，可以结合第一变换关系与第二变换关系，进行位置配准的结果的准确度比只使用第一变换关系或第二变换关系更高。因此，应用本发明实施例提供的方案可以准确地对髋关节的实际位置进行位置配准。当然，实施本发明的任一产品或方法并不一定需要同时达到以上所述的所有优点。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，还可以根据这些附图获得其他的实施例。图1为本发明实施例提供的第一种髋关节实际位置配准方法的流程示意图；图2为本发明实施例提供的第一配准位置示意图；图3a为本发明实施例提供的三维模型上对应于目标髋关节上髋臼窝内侧的第一配准位置示意图；图3b为本发明实施例提供的三维模型上对应于目标髋关节上髋臼窝外侧的第一配准位置示意图；图4a为本发明实施例提供的第一种骨盆参考架示意图；图4b为本发明实施例提供的股骨参考架示意图；图4c为本发明实施例提供的第二种骨盆参考架示意图；图4d为本发明实施例提供的第三种骨盆参考架示意图；图5为本发明实施例提供的第二种髋关节实际位置配准方法的流程示意图；图6为本发明实施例提供的第三种髋关节实际位置配准方法的流程示意图；图7为本发明实施例提供的髋关节实际位置配准的整体流程示意图；图8为本发明实施例提供的一种髋关节实际位置配准装置的结构示意图；图9为本发明实施例提供的一种电子设备的结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员基于本申请所获得的所有其他实施例，都属于本发明保护的范围。髋关节置换手术是一种常见的人工关节置换术。目前，可以使用手术机器人辅助医生进行髋关节置换手术。手术机器人可以根据医生规划好的路径控制机械臂移动，从而帮助医生完成手术。由于手术过程中髋关节的位置和形态与采集髋关节CT图像时髋关节的位置和形态往往不同，手术机器人难以精准地按照医生规划的手术路径控制机械臂移动。鉴于此，本发明实施例提供了一种髋关节实际位置配准方法，实现准确地对髋关节的实际位置进行位置配准。下面对本发明实施例的执行主体进行说明。本发明实施例的执行主体可以是电子设备，具体的，可以为与手术机器人相连接的电子设备，例如台式机等。下面通过具体实施例对本发明实施例提供的髋关节实际位置配准方法进行说明。参见图1，提供了第一种髋关节实际位置配准方法的流程示意图，该方法包括以下步骤S101-步骤S106。步骤S101：确定三维模型上的多个第一配准位置以及第一配准区域。其中，三维模型为与目标髋关节对应的三维模型，目标髋关节为患者术侧髋关节。电子设备可以遍历并保存三维模型表面各个点的数据来提取三维模型表面各个点的位置。例如，在使用MC算法进行图像重建时，电子设备可以遍历并保存三角面片的顶点数据，从而提取得到三维模型表面各个点的位置。一种情况下，提取的三维模型表面的各个点的位置可以为三维模型表面的各个点在模型坐标系下的模型坐标。例如，各个点的CT坐标。下面对第一配准位置进行说明。第一配准位置为三维模型表面上点的位置。具体的，第一配准位置可以为三维模型表面的点在三维模型对应的模型坐标系下的坐标。由于存在多个第一配准位置，因此，可以给各第一配准位置设置序号。序号可以为从1开始的连续正整数。如1、2、3……等。上述第一配准位置可以是粗配准点对应的三维模型上规划的点的模型坐标。例如，各个点的CT坐标。下面对电子设备确定第一配准位置的方式进行说明。一种实现方式中，可以预设髋关节上第一配准位置对应的形状参数，这样，电子设备可以分析计算三维模型表面各个位置的形状参数，从而确定三维模型上形状参数与预设的形状参数最接近的位置为第一配准位置。例如，预设的形状参数可以为曲率向量，电子设备可以分析计算三维模型上各个位置的曲率向量，并确定三维模型上曲率向量与预设的曲率向量最接近的位置为第一配准位置。另一种实现方式中，电子设备可以在通信连接的显示设备上显示三维模型，这样使用者可以对三维模型进行观察，使用输入设备向电子设备输入其选择的位置，电子设备将输入设备输入的位置确定为第一配准位置。具体的，上述输入设备可以是鼠标、触控板、键盘等等。使用者可以使用鼠标、触控板等输入设备以点选的方式确定其所选择的位置，还可以使用键盘、触控板等输入数值的方式确定其所选择的位置。第一配准位置的数量可以为预设数量，如3个、5个等。如图2所示，提供了第一配准位置示意图。图2中黑色圆点标记的位置即为所确定的第一配准位置。下面对第一配准区域进行说明。第一配准区域为三维模型表面的区域，可以包括三维模型上髋臼窝内侧区域与髋臼窝外侧区域两部分区域。如图3a与图3b中的黑色区域所示，第一配准区域为三维模型上的对应于目标髋关节上髋臼窝内侧与外侧的区域。其中，图3a提供了三维模型上对应于目标髋关节上髋臼窝内侧的第一配准位置示意图，图3b提供了三维模型上对应于目标髋关节上髋臼窝外侧的第一配准位置示意图。上述第一配准区域可以是在三维模型上规划的精配准区域。下面对电子设备确定第一配准区域的方式进行说明。第一种实现方式中，电子设备可以获得用户在三维模型上选择的多个髋关节的表征性位置，并获得各表征性位置的描述信息；根据所获得的表征性位置与描述信息，确定第一配准区域。其中，髋关节的表征性位置是使用者根据医学知识确定的用于描述髋关节结构的位置，各表征性位置的信息用于表示各表征性位置所描述的髋关节结构。具体的，电子设备可以在通信连接的显示设备上显示三维模型，这样使用者可以对三维模型进行观察，并使用输入设备向电子设备输入其选择的目标髋关节的表征性位置。一种情况下，电子设备可以预设各表征性位置的获得顺序以及各表征性位置的描述信息，这样，使用者可以按预设的顺序向电子设备输入其选择的髋关节的表征性位置，电子设备根据获得顺序，确定各表征性位置对应的描述信息。另一种情况下，使用者可以在输入其选择的目标髋关节的表征性位置时，也输入各表征性位置的描述信息。这样，电子设备可以获得各表征性位置与各表征性位置的描述信息。第二种实现方式中，电子设备可以获得用户在三维模型上选择的框选区域；将框选区域确定为第一配准区域。具体的，电子设备可以在通信连接的显示设备上显示三维模型，这样使用者可以对三维模型进行观察，使用输入设备向电子设备输入其选择的区域，电子设备将输入设备输入的区域确定为第一配准区域。具体的，上述输入设备可以是鼠标。触控板等等。使用者可以使用鼠标、触控板等输入设备以框选的方式确定其所选择的区域。一种情况下，使用者可以选择三维模型上对应目标髋关节的实际暴露区域的区域作为框选区域。这样，电子设备可以根据髋关节在医学上的结构特点，高效而准确地确定第一配准区域；也可以根据目标髋关节的实际暴露情况，确定能够实际用于配准的第一配准区域。通过上述方式，可以提高第一配准区域确定的效率和准确性。第三种实现方式中，电子设备内可以预设髋关节上第一配准区域内的位置对应的形状参数，这样，电子设备可以分析计算三维模型表面各个位置的形状参数，并确定形状参数符合预设的第一配准区域内的位置对应的形状参数的位置属于第一配准区域，从而确定第一配准区域。例如，预设的形状参数可以为髋臼窝的内侧区域的曲率向量与外侧区域的曲率向量，电子设备可以通过分析计算各个位置的曲率向量，确定属于髋臼窝内侧区域的位置与属于髋臼窝外侧区域的位置，从而确定包括髋臼窝内侧区域与髋臼窝外侧区域在内的第一配准区域。步骤S102：确定各第一配准位置在目标髋关节上对应的第二配准位置。其中，第二配准位置为目标髋关节上对应于第一配准位置的点的位置。由于目标髋关节存在于实际空间中，第二配准位置为这些点在实际空间中的位置。具体的，第二配准位置可以为这些点在实际空间对应的空间坐标系下的坐标。根据前文对步骤S101的说明，存在多个第一配准位置。为了确定每一第一配准位置对应的第二配准位置，可以按第一配准位置的序号顺序确定第二配准位置。上述第二配准位置可以是粗配准点对应的目标髋关节上的点的光学坐标。下面对第二配准位置的确定方式进行说明。第一种实现方式中，电子设备可以获得第一髋关节参考架上凹槽的位置，作为第二配准位置。其中，第一髋关节参考架用于固定于目标髋关节上，第一髋关节参考架设置有多个凹槽，且多个凹槽连线构成不等边三角形，凹槽的位置由与双目相机相连的带有光学示踪球的手术探针采集得到。上述第一髋关节参考架可以包括骨盆参考架与股骨参考架，如图4a、图4b所示，图4a提供了第一种骨盆参考架示意图，图4b提供了股骨参考架示意图。可以看出，骨盆参考架与股骨参考架通过夹具中夹持的骨针，固定于目标髋关节上。一种情况下，可以将凹槽设置在第一髋关节参考架的夹具上。参见图4c，图4c提供了第二种骨盆参考架示意图。图4c中左侧立方体结构为第一款关键参考架的夹具，夹具上表面的左下角设置有凹槽1，上沿设置有凹槽2，右下角设置有凹槽3。图4c中右侧放大部分显示了该骨盆参考架与所固定的骨盆的连接处。具体的，可以由使用者控制与双目相机相连的带有光学示踪球的手术探针的位置，按顺序将手术探针针尖移动到凹槽位置，并按下采集按钮。此时双目相机将针尖所在的位置发送至电子设备，电子设备将接收到的位置信息依次确定为各第一配准位置对应的第二配准位置。电子设备获得凹槽位置作为第二配准位置时，使用者采集时无需判断髋臼窝的方向，降低了对使用者的操作要求。此外，凹槽在第一髋关节参考架上的位置相对固定，第一髋关节参考架相对于髋关节的位置相对固定，因此，凹槽位置是相对固定的，以凹槽位置作为第二配准位置，获得的第二配准位置准确度高。第二种实现方式中，电子设备可以获得第二髋关节参考架设置的示踪器的位置，作为第二配准位置。其中，示踪器的位置由双目相机采集得到。上述第二髋关节参考架与第一髋关节参考架类似，包括骨盆参考架与股骨参考架，并通过夹具中夹持的骨针，固定于目标髋关节上。此外，在第二髋关节参考架上，固定有四边形框架，四边形框架的四个角上固定有示踪器。在第二髋关节参考架的夹具上设置有位置调节装置，用于调节在四边形框架上的四个示踪器与参考架的相对位置。以骨盆参考架为例，参见图4d，提供了第三种骨盆参考架示意图。在调整示踪器与参考架的相对位置时，示踪器的朝向只能在x轴进行调整，无法在y轴、z轴方向上进行调整。电子设备获得示踪器位置作为第二配准位置时，使用者无需判断髋臼窝的方向，降低了对使用者的操作要求。此外，示踪器在第二髋关节参考架上的位置相对固定，因此以示踪器位置作为第二配准位置，获得的第二配准位置准确度高。第三种实现方式中，电子设备可以获得与双目相机相连的带有反光阵列的手术探针在目标髋关节上采集的位置，作为第二配准位置。其中，反光阵列由有特定几何关系的反光球构成，双目相机可以通过反光球的几何关系，确定探针针尖所在的位置，并将该位置发送至电子设备。具体的，可以由使用者控制与双目相机相连的带有反光阵列的手术探针的位置，按顺序将手术探针针尖移动到目标髋关节上与各第一配准位置对应的位置，并按下采集按钮。此时双目相机将针尖所在的位置发送至电子设备，电子设备将接收到的位置信息依次确定为各第一配准位置对应的第二配准位置。这样，电子设备获得手术探针在目标髋关节上采集的位置作为第二配准位置时，可以通过反光阵列的特定结构确定手术探针针尖所在的位置，准确地获得第二配准位置。此时，上述空间坐标系可以为双目相机采集的图像对应的光学坐标系，第二配准位置可以为对应于目标髋关节上对应于第一配准位置的点在光学坐标系下的坐标。第四种实现方式中，第二配准位置可以通过与带有深度传感器的相机相连的手术探针采集得到。其采集原理与第一种实现方式类似，带有深度传感器的相机可以确定探针针尖所在的位置，并将该位置发送至电子设备。这样，使用者按顺序将手术探针针尖移动到目标髋关节上与各第一配准位置对应的位置，并按下采集按钮，相机会将确定的位置发送至电子设备，电子设备将接收到的位置信息依次确定为各第一配准位置对应的第二配准位置。此时，上述空间坐标系可以为带有深度传感器的相机采集的图像对应的光学坐标系，第二配准位置可以为对应于目标髋关节上对应于第一配准位置的点在光学坐标系下的坐标。第五种实现方式中，电子设备可以将相机采集得到的目标髋关节的二维图像与三维模型进行内容匹配，根据内容匹配结果，结合目标髋关节的二维图像，确定目标髋关节上对应于第一配准位置的位置为第二配准位置。步骤S103：对第一配准位置和第二配准位置进行位置配准，确定目标髋关节上的点与三维模型表面的点间位置的第一变换关系。对第一配准位置和第二配准位置进行位置配准可以认为是粗配准过程，第一配准位置是粗配准点的模型坐标，第二配准位置是粗配准点的光学坐标。三维模型与目标髋关节对应，可以认为三维模型上的点与目标髋关节上的点之间只发生了刚体变换。一种情况下，所确定的第一变换关系可以以表达式进行表示，由于三维模型上的点与目标髋关节上的点之间发生了刚体变换，因此，表达式参数包括平移矩阵与旋转矩阵。假设目标髋关节上的点的坐标为P，该点对应的三维模型上的点的坐标为Q，为第一变换关系对应的第一旋转矩阵，/＞为第一变换关系对应的第一平移矩阵，那么，使用表达式表示第一变换关系时，该表达式为：；另一种情况下，所确定的第一变换关系也可以由平移矩阵与旋转矩阵确定的变换矩阵表示。同样假设目标髋关节上的点的坐标为P，该点对应的三维模型上的点的坐标为Q，为第一变换关系对应的第一旋转矩阵，/＞为第一变换关系对应的第一平移矩阵，使用变换矩阵表示第一变换关系时，该变换矩阵为：/＞。为便于使用，可以记。此时，。上述确定第一变换关系的过程可以被称为粗配准过程，所确定的用于表示第一变换关系的变换矩阵可以被称为粗配准矩阵。下面对电子设备确定第一变换关系的实现方式进行说明。一种实现方式中，电子设备可以使用四点法进行位置配准，从而确定第一变换关系。此时，需要确定的第一配准位置的数量为4个，并且4个第一配准位置不共面。此时，确定的第二配准位置也为4个不共面的位置。由于不共面四点的仿射不变性，电子设备可以根据4个第一配准位置与对应的4个第二配准位置，计算得到变换矩阵，从而获得基于该变换矩阵确定的第一变换关系。另一种实现方式中，电子设备可以对第一配准位置与第二配准位置使用SVD法进行位置配准，从而确定第一变换关系。具体的，电子设备可以根据以下关系式对第一配准位置与第二配准位置使用SVD法进行位置配准，求取平移矩阵与旋转矩阵。;;;;;;;;其中，n表示确定的第一配准位置的数量，由于第一配准位置与第二配准位置一一对应，n也表示第二配准位置的数量；p表示第二配准位置对应的第二质心位置，表示第一配准位置对应的第一质心位置；/＞表示第i个第二配准位置，/＞表示第i个第一配准位置；/＞表示第i个第二配准位置相对于第二质心位置的第二质心位移向量，/＞表示第i个第一配准位置相对于第一质心位置的第一质心位移向量；H为构造的中间矩阵，/＞表示对中间矩阵进行奇异值分解的过程，U为第一分解矩阵，V为第二分解矩阵；R表示解得的旋转矩阵，T表示解得的平移矩阵。这样，电子设备可以基于上述解得的旋转矩阵与平移矩阵，确定第一变换关系。步骤S104：获得在目标髋关节上对应于第一配准区域的第二配准区域内采集的多个第三配准位置。其中，第二配准区域为目标髋关节上对应于第一配准区域的区域。由于第一配准区域包括三维模型上髋臼窝内侧区域与髋臼窝外侧区域两部分区域，因此第二配准区域也包括目标髋关节上髋臼窝内侧区域与髋臼窝外侧区域两部分区域。上述第二配准区域可以是所规划的精配准区域对应的目标髋关节上的区域。第三配准位置为在第二配准区域内采集的目标髋关节上的点的位置，并且这些点位于第二配准区域内。与前文对步骤S102的说明相类似，由于目标髋关节存在于实际空间中，第三配准位置为这些点在实际空间中的位置。具体的，第三配准位置可以为这些点实际空间对应的空间坐标系下的坐标。由于第二配准区域也包括目标髋关节上髋臼窝内侧区域与髋臼窝外侧区域两部分区域，第三配准位置可以包括在髋臼窝内侧与髋臼窝外侧采集的点的位置，其数量可以为预设数量，例如在目标髋关节上的髋臼窝内侧对应于第一配准区域的区域与髋臼窝外侧对应于第一配准区域的区域各采集15个点、20个点等。与前文对步骤S101的说明相类似，由于存在多个第三配准位置，因此，可以给各第三配准位置设置序号。序号可以为从1开始的连续正整数。如1、2、3……等。上述第三配准位置可以是获得的目标髋关节上精配准点的光学坐标。与前文对步骤S102的说明中第二配准位置的确定方式相类似，可以通过以下方式确定第三配准位置。第一种实现方式中，电子设备可以获得与双目相机相连的带有反光阵列的手术探针在目标髋关节上对应于第一配准区域的第二配准区域内采集的位置，作为第三配准位置。具体的，可以由使用者将手术探针针尖移动至第二配准区域内的位置，并按下采集按钮，此时双目相机将针尖所在的位置发送至电子设备，电子设备将接收到的位置信息确定为第三配准位置。此时，上述空间坐标系可以为双目相机采集的图像对应的光学坐标系，第三配准位置可以为在第二配准区域内采集的目标髋关节上的点在光学坐标系下的坐标。这样，双目相机通过反光阵列的特定结构确定手术探针针尖所在的位置，可以准确地获得第三配准位置。第二种实现方式中，电子设备可以获得与带有深度传感器的相机相连的手术探针采集的位置，作为第三配准位置。具体的，使用者将手术探针针尖移动至第二配准区域内的位置，并按下采集按钮，相机会将确定的位置发送至电子设备，电子设备将接收到的位置信息依次确定为第三配准位置。上述与双目相机相连的带有反光阵列的手术探针与带有深度传感器的相机相连的手术探针都属于采集配准位置的工具。一种情况下，为了保证获得的第三配准位置的精确度，可以判断采集配准位置的工具的第一候选位置对应的在模型坐标系下的第二候选位置是否位于第一配准区域内，当第二候选位置位于第一配准区域内时，才获得采集配准位置的工具采集的位置作为第三配准位置。这种情况将在后文进一步说明，此处暂不详述。第三种实现方式中，电子设备可以将相机采集得到的目标髋关节的图像与三维模型进行内容匹配，根据内容匹配结果，结合目标髋关节的图像，在目标髋关节上第二配准区域内确定第三配准位置。步骤S105：根据三维模型表面各个点的位置、各第三配准位置与第一变换关系，确定目标髋关节上的点与三维模型表面的点间位置的第二变换关系。与前文对步骤S103的说明相类似，步骤S105可以认为是精配准过程，第三配准位置是精配准点的光学坐标。三维模型与目标髋关节对应，可以认为三维模型上的点与目标髋关节上的点之间只发生了刚体变换。一种情况下，所确定的第二变换关系可以以表达式进行表示，由于三维模型上的点与目标髋关节上的点之间发生了刚体变换，因此，表达式参数包括平移矩阵与旋转矩阵。假设目标髋关节上的点的坐标为P，该点对应的三维模型上的点的坐标为Q，为第二变换关系对应的第二旋转矩阵，/＞为第二变换关系对应的第二平移矩阵，那么，使用表达式表示第二变换关系时，该表达式为：；另一种情况下，所确定的第二变换关系也可以以平移矩阵与旋转矩阵确定的变换矩阵表示。同样假设目标髋关节上的点的坐标为P，该点对应的三维模型上的点的坐标为Q，为第二变换关系对应的第二旋转矩阵，/＞为第二变换关系对应的第二平移矩阵，使用变换矩阵表示第二变换关系时，该变换矩阵为：/＞。为便于使用，可以记。此时，。上述确定第二变换关系的过程可以被称为精配准过程，所确定的用于表示第二变换关系的变换矩阵可以被称为精配准矩阵。下面对电子设备确定第二变换关系的实现方式进行说明。第一种实现方式中，可以根据第一变换关系，从三维模型表面各个点中确定对应于各第三配准位置的位置，从而根据各第三配准位置与三维模型表面对应的位置确定第二变换关系。具体的实现方式将在后文图5对应的实施例中进一步说明，此处暂不详述。第二种实现方式中，可以每采集第一预设数量个第三配准位置，就根据三维模型表面各个点的位置、已获得的第三配准位置与目标变换关系，确定第二变换关系。具体的实现方式与目标变换关系的获得方式将在后文进一步说明，此处暂不详述。第三种实现方式中，可以根据第一变换关系，从三维模型表面各个点中确定与第三配准位置相对应的位置的点的位置，并对第三配准位置与第三配准位置对应的点的位置使用NDT算法，确定第二变换关系。步骤S106：根据第一变换关系与第二变换关系，对目标髋关节上的实际位置进行变换，完成位置配准。具体的，如前文的说明，获得的第一变换关系可以为变换矩阵matrixC，第二变换关系可以为变换矩阵matrixP。电子设备可以根据以下关系式得到最终配准矩阵matrix：。这样，电子设备可以基于最终变换矩阵确定最终变换关系，从而根据最终变换关系对目标髋关节上的实际位置进行变换。假设目标髋关节上的实际位置为，配准后对应在三维模型上的位置为/＞，那么，电子设备可以根据以下关系式对目标髋关节上的实际位置进行变换：。应用本实施例提供的方案，可以在目标髋关节的三维模型上确定第一配准位置，并根据第一配准位置在目标髋关节上确定第二配准位置。这样，根据第一配准位置与第二配准位置，可以得到第一变换关系。此外，根据在目标髋关节上对应于三维模型上第一配准区域的第二配准区域内采集的第三配准位置、三维模型表面的各个点与第一变换关系，可以得到第二变换关系。由于第二变换关系是在第一变换关系基础上得到的，第二变换关系比第一变换关系更准确。这样，根据第一变换关系与第二变换关系对目标髋关节上的实际位置进行变换，可以结合第一变换关系与第二变换关系进行位置配准，配准的准确性比只使用第一变换关系或第二变换关系更高。因此，应用本发明实施例提供的方案可以准确地对髋关节的实际位置进行位置配准。本发明的一个实施例中，参见图5，提供了第二种髋关节实际位置配准方法的流程示意图。如前文对步骤S105的说明，本实施例中，步骤S105可以通过以下步骤S105A-步骤S105C实现。步骤S105A：根据第一变换关系对各第三配准位置进行位置变换，得到第四配准位置。其中，第四配准位置为第三配准位置变换后得到的位置，为三维模型上的位置。当第三配准位置为空间坐标系下的坐标时，第四配准位置为模型坐标系下的坐标。第三配准位置与第四配准位置一一对应。一种情况下，上述第四配准位置为精配准点的光学坐标经位置变换后得到的模型坐标，例如，精配准点的光学坐标经位置变换后得到的CT坐标。一种实现方式中，如前文所述，第一变换关系可以为变换矩阵matrixC，假设第三配准位置，变换得到的第四配准位置为/＞，那么，电子设备可以通过以下关系式对第三配准位置进行位置变换：。步骤S105B：针对每一第四配准位置，根据该第四配准位置与三维模型表面各个点的位置，确定三维模型表面上与该第四配准位置距离最近的第五配准位置。如对步骤S105A的说明，第四配准位置可以为模型坐标系下的坐标。而三维模型表面各个点的位置也可以为模型坐标系下的坐标。这样，可以通过坐标之间的关系确定三维模型表面上与该第四配准位置距离最近的第五配准位置。第四配准位置与第五配准位置一一对应。上述第五配准位置为距离精配准点的光学坐标经位置变换后得到的模型坐标最近的点的模型坐标，可以认为每一第五配准位置对应的点是该第五配准位置对应的第四配准位置对应的点的对应近点。下面对电子设备确定第五配准位置的实现方式进行说明。一种实现方式中，针对每一第四配准位置，可以计算模型表面各个点的位置与该第四配准位置之间的距离，并从计算得到距离中确定与该第四配准位置最近的距离，将该距离对应的位置确定为第五配准位置。另一种实现方式中，可以使用kd-tree方法确定第五配准位置。具体的，可以将三维模型所在的空间分割成多个子空间，每个子空间中只存在一个提取到的三维模型表面的点。这样，电子设备可以根据第四配准位置所对应的子空间，确定该子空间中存在的三维模型表面的点为与该第四配准位置距离最近的点，该三维模型表面的点的位置为第五配准位置。步骤S105C：根据各第三配准位置以及与其对应的第五配准位置，确定目标髋关节与三维模型间的第二变换关系。其中，由于第三配准位置与第四配准位置一一对应，第四配准位置又与第五配准位置一一对应，因此第三配准位置与第五配准位置一一对应。下面对电子设备确定第二变换关系的实现方式进行说明。一种实现方式中，电子设备可以对第三配准位置与第五配准位置使用前文所述的SVD法确定第二变换关系。该配准方式与前文对步骤S103的说明中对第一配准位置与第二配准位置使用SVD法进行位置配准相类似，此处不再详细说明。另一种实现方式中，电子设备可以基于预设的刚体变换约束条件与预设变换调整结束条件，对各第三配准位置以及与其对应的第五配准位置进行迭代计算，从而确定第二变换关系。具体的实现方式将在后文图6对应的实施例中进一步说明，此处暂不详述。应用上述方式，可以使用第一变换关系对第三配准位置进行变换，得到第四配准位置，并确定三维模型表面上与每一第四配准位置距离最近的第五配准位置，从而根据第三配准位置与对应的第五配准位置确定第二变换关系。这样确定的第二变换关系是在第一变换关系的基础上进一步确定的，因此，确定的第二变换关系比第一变换关系更准确，基于第二变换关系进行位置配准，可以提高配准的准确度。本发明的一个实施例中，参见图6，提供了第三种髋关节实际位置配准方法的流程示意图。如前文对步骤S105C的说明，本实施例中，步骤S105C可以通过以下步骤S105C1-步骤S105C3实现。步骤S105C1：基于每一配准位置对中两位置间的距离，确定满足预设的刚体变换约束条件的旋转参数和平移参数，并获得基于该旋转参数和平移参数确定的目标髋关节与三维模型间的第二变换关系。其中，每一配准位置对中包括：一个第三配准位置和与该第三配准位置对应的第四配准位置距离最近的第五配准位置。具体的，上述旋转参数可以以旋转矩阵进行表示，上述平移参数可以以平移矩阵进行表示。这样，与前文对步骤S105的说明相同，可以根据旋转矩阵与平移矩阵确定第二变换关系。上述预设的刚体变换约束条件可以有多种情况。一种情况下，预设的刚体变换约束条件可以为：使得对各第三配准位置进行刚体变换后的位置与各第三配准位置对应的第五配准位置间平均距离最小的约束条件。这种情况下，通过上述预设的刚体变换约束条件确定第二变换关系，可以使各第三配准位置进行刚体变换后的位置与各第三配准位置对应的第五配准位置间平均距离最小，也就使第二变换关系精确，基于第二变换关系进行位置配准，可以提高配准的准确度。具体的，可以根据以下表达式确定旋转参数和平移参数。;其中，表示预设的刚体变换约束条件，m表示第三配准位置的数量，由于第三配准位置与第五配准位置一一对应，m也表示第五配准位置的数量；/＞表示确定的旋转参数，/＞表示确定的平移参数；/＞表示第j个第五配准位置，/＞表示第j个第三配准位置。另一种情况下，预设的刚体变换约束条件可以为：使得对各第三配准位置进行刚体变换后的位置与各第三配准位置对应的第五配准位置间最大距离最小的约束条件。步骤S105C2：采用上述平移参数和旋转参数对各第三配准位置进行刚体变换，得到各第三配准位置对应的新的第四配准位置。此处得到新的第四配准位置的方式与前文对步骤S105A的说明相类似，因此不再详细说明。步骤S105C3：针对每一第三配准位置，计算该第三配准位置对应的新的第四配准位置与该第三配准位置对应的第五配准位置的距离。当上述距离不满足预设变换调整结束条件时，返回执行步骤S105B。对应于对步骤S105C1的说明中预设的刚体变换约束条件的有多种情况，上述预设变换调整结束条件也存在多种情况。一种情况下，预设变换调整结束条件为：各第三配准位置对应的新的第四配准位置与该第三配准位置对应的第五配准位置的平均距离小于预设的距离阈值。这种情况下，通过上述预设变换调整结束条件调整第二变换关系，可以使各第三配准位置进行刚体变换后的位置与各第三配准位置对应的第五配准位置间平均距离小于预设的距离阈值，也就使第二变换关系精确，基于第二变换关系进行位置配准，可以提高配准的准确度。另一种情况下，预设变换调整结束条件为：各第三配准位置对应的新的第四配准位置与该第三配准位置对应的第五配准位置的最大距离小于预设的距离阈值。通过以上方式，基于预设的刚体变换约束条件与预设变换调整结束条件确定并调整第二变换关系，可以使第二变换关系的准确度不断提高，从而得到的最终确定的第二变换关系具有高准确度。这样，基于第二变换关系进行位置配准，可以提高配准的准确度。本发明的一个实施例中，如前文对步骤S105的说明，可以根据三维模型表面各个点的位置、已获得的第三配准位置与目标变换关系，确定第二变换关系。具体的，步骤S104-步骤S105可以通过以下步骤A-步骤B实现。步骤A：获得在目标髋关节上对应于第一配准区域的第二配准区域内采集的第一预设数量个第三配准位置。其中，第一预设数量可以为1、3、5等，本发明实施例对此并不进行限定。一种情况下，电子设备可以将所有获得的位置确定为第三配准位置。另一种情况下，电子设备可以筛选获得的位置，从中确定精度符合要求的位置为第三配准位置。本实现方式将在后文进一步说明，此处暂不详述。步骤B：根据三维模型表面各个点的位置、已获得的第三配准位置与目标变换关系，确定目标髋关节上的点与三维模型表面的点间位置的第二变换关系，若已获得的第三配准位置的数量未达到第二预设数量，将目标变换关系更新为第二变换关系，并返回执行步骤A。其中，目标变换关系的初始关系为第一变换关系。第二预设数量可以为15、20等，本发明实施例对此并不进行限定。电子设备可以在通信连接的显示设备上显示已获得的第三配准位置数量，也可以显示还需要获得的第三配准位置的数量，即第二预设数量与已获得的第三配准位置数量的差值。当已获得的第三配准位置的数量达到第二预设数量时，电子设备可以在通信连接的显示设备上显示提醒结束采集信息，提醒使用者结束采集。此外，一种实现方式中，在每次更新目标变换关系后，电子设备可以计算使用目标变换关系对目标髋关节进行配准时存在的误差，并根据计算所得的误差，调整第一预设数量。具体的，可以设置上述误差与第一预设数量的对应关系。例如，当计算所得误差为5mm时，第一预设数量为6；当计算所得误差为4mm时，第一预设数量为3。下面对第二变换关系的确定方式进行说明。一种情况下，可以根据目标变换关系，从三维模型表面各个点中确定对应于各第三配准位置的位置，从而根据各第三配准位置与三维模型表面对应的位置确定第二变换关系。另一种情况下，可以根据目标变换关系，从三维模型表面各个点中确定与第三配准位置相对应的位置的点的位置，并对第三配准位置与第三配准位置对应的点的位置使用NDT算法，确定第二变换关系。通过上述方式，可以在获得第一预设数量个第三配准位置后，根据初始关系为第一变换关系的目标变换关系更新第二变换关系，并将第二变换关系确定为目标变换关系。这样，随着已获得的第三配准位置数量增加，第二变换关系会不断迭代更新，从而提高确定的第二变换关系的准确度。基于第二变换关系进行位置配准，可以提高配准的准确度。本发明的一个实施例中，上述步骤S104可以通过以下步骤C-步骤F完成。步骤C：实时获得用于在目标髋关节上采集配准位置的工具的第一候选位置。上述第一候选位置为采集配准位置的工具的位置。一种情况下，可以为电子设备获得的采集配准位置的工具的位置的光学坐标。步骤D：根据第一变换关系，对第一候选位置进行位置变换，得到第二候选位置。其中，第二候选位置为第一候选位置变换后得到的位置，为三维模型上的位置。当第一候选位置为空间坐标系下的坐标时，第二候选位置为模型坐标系下的坐标。第一候选位置与第二候选位置一一对应。一种情况下，第二候选位置为电子设备获得的采集配准位置的工具的位置的光学坐标经位置变换后得到的模型坐标。步骤E：判断第二候选位置是否位于第一配准区域内。具体的，可以通过以下方式判断第二候选位置是否位于第一配准区域内。一种实现方式中，可以判断第二候选位置是否为第一配准区域包含的点的位置。若是，则第二候选位置位于第一配准区域内；若不是，则第二候选位置位于第一配准区域外。另一种实现方式中，如前文对步骤S104的说明，由于采集配准位置的工具可以为手术探针，此时可以根据第二候选位置以及采集配准位置的工具的几何形状，确定采集配准位置的工具，即手术探针在三维模型上对应的直线，并判断该直线是否与第一配准区域相交。若是，则第二候选位置位于第一配准区域内；若不是，则第二候选位置位于第一配准区域外。步骤F：当第二候选位置位于第一配准区域内时，响应于位置获得指令，获得工具的当前位置，并确定当前位置为第三配准位置。上述工具的当前位置即为对应于位置获得指令的工具的第一候选位置。这样获得第三配准位置，可以保证第三配准位置经过位置变换后的位置在第一配准区域内，保证了获得的第三配准位置的准确度。由于获得的第三配准位置准确度高，因此，使用第三配准位置进行配准时，达到同样的配准精度需要的第三配准位置的数量少；使用同样数量的第三配准位置进行配准时，达到满足要求的配准精度的成功率高。进一步的，在上述步骤F之前，还可以存在以下步骤G-步骤H。步骤G：获得第二候选位置与三维模型表面间的最短距离。上述第二候选位置与三维模型表面间的最短距离可以为第二候选位置到三维模型表面的最近距离，该距离是三维模型表面法线方向的距离。具体的，电子设备可以确定三维模型表面上法线经过第二候选位置的点，从而确定该点与第二候选位置之间的距离，作为第二候选位置与三维模型表面间的最短距离。步骤H：判断最短距离是否小于预设误差距离。若最短距离小于预设误差距离，说明第二候选位置的准确度能够满足配准需要，第二候选位置对应的第一候选位置的准确度能够满足配准的需要。此时，执行步骤F。另外，电子设备还可以提示使用者第一候选位置的准确度能够满足配准的需要。例如，在与其通信连接的显示设备上显示满足配准需要的信号提示使用者第一候选位置的准确度能够满足配准的需要；又例如，发出提示声音信号提示使用者第一候选位置的准确度能够满足配准的需要。上述预设误差距离可以为5mm、10mm等，本发明实施例对此并不进行限定。这样，可以在确保第三配准位置经过位置变换后的位置在第一配准区域内的前提下，进一步保证第三配准位置经过位置变换后的位置与三维模型表面间的最短距离小于预设误差距离，也就保证了获得的第三配准位置的准确度。由于获得的第三配准位置准确度高，因此，使用第三配准位置进行配准时，达到同样的配准精度需要的第三配准位置的数量少；使用同样数量的第三配准位置进行配准时，达到满足要求的配准精度的成功率高。将第一候选位置作为第三配准位置，所获得的第三配准位置的准确度能够满足配准的需要。当第二候选位置与三维模型表面间的最短距离不小于预设误差距离时，说明第二候选位置的准确度不能满足配准需要，第二候选位置对应的第一候选位置的准确度也不能满足配准的需要。此时，不能将第一候选位置作为第三配准位置。如前文对步骤S104的说明，电子设备可以获得与带有深度传感器的相机相连的手术探针采集的位置，作为第三配准位置。具体的，使用者将将手术探针针尖移动至第二配准区域内的位置，并按下采集按钮，此时双目相机将针尖所在的位置发送至电子设备，电子设备将接收到的位置信息确定为第三配准位置。这样，可以提高获得的第三配准位置的准确度，根据第三配准位置确定第二变换关系的准确度高。基于这样确定的第二变换关系进行位置配准，可以提高配准的准确度。本发明的一个实施例中，可以根据目标髋关节的实际情况，更新第一配准区域。具体的，可以通过以下步骤I-步骤K完成。步骤I：获得采集配准位置的工具在目标髋关节上采集的属于髋关节配准区域的第二区域更新位置。上述第二区域更新位置为采集配准位置的工具的位置。一种情况下，可以为电子设备获得的采集配准位置的工具的位置的光学坐标。步骤J：根据目标髋关节上采集的第二区域更新位置与第一变换关系，确定三维模型表面上与目标髋关节上采集的第二区域更新位置对应的第一区域更新位置。其中，第一区域更新位置为第二区域更新位置变换后得到的位置，为三维模型上的位置。当第二区域更新位置为空间坐标系下的坐标时，第一区域更新位置为模型坐标系下的坐标。第一区域更新位置与第二区域更新位置一一对应。步骤K：根据所确定的第一区域更新位置，更新第一配准区域。具体的，电子设备可以将所确定的第一区域更新位置作为更新后的第一配准区域的边界位置，从而依据边界位置确定更新后的第一配准区域，完成对第一配准区域的更新。由于第一配准区域与第二配准区域相对应，而第二配准区域在目标髋关节上，可以认为，步骤I-步骤K是根据更新后的第二配准区域更新第一配准区域。步骤I获得的第二区域更新位置是更新后的第二配准区域的边界位置，因此，第二区域更新位置经位置变换后，得到的第一区域更新位置，是更新后的第一配准区域的边界位置。这样，电子设备可以根据第一区域更新位置更新第一配准区域。上述步骤I-步骤K可以在步骤S104，即获得多个第三配准位置之前进行，也可以在获得第三配准位置中进行，还可以在获得多个第三配准位置后进行，本发明对此并不进行限定。这样，可以根据目标髋关节的实际情况，更新第一配准区域，从而保证第一配准区域内的点可以被采集获得，也就保证了获得的第三配准位置的准确度。下面对髋关节实际位置配准的整体流程进行说明。参见图7，图7提供了髋关节实际位置配准的整体流程示意图。具体的，包括以下步骤S701-步骤S714。步骤S701：获取目标髋关节的三维模型。步骤S702：确定三维上的第一配准区域和多个第一配准位置。步骤S703：获取在目标髋关节上采集的与三维模型上的第一配准位置对应的第二配准位置。步骤S704：对第一配准位置和第二配准位置进行配准，得到三维模型与目标髋关节之间的第一变换关系。步骤S705：使用者在目标髋关节上移动采集配准位置的工具。步骤S706：根据第一变换关系，实时获得采集配准位置的工具在三维模型中的位置。步骤S707：判断采集配准位置的工具在三维模型中的对应位置是否在第一配准区域内，若是，执行步骤S708；若否，执行步骤S713。步骤S708：判断采集配准位置的工具在三维模型中的对应位置与三维模型表面的最短距离是否小于预设误差距离。若是，执行步骤S709；若否，执行步骤S714。步骤S709：通过声光信息，提醒使用者在目标髋关节上对应于第一配准区域的第二配准区域内采集第三配准位置，获得采集得到的第三配准位置。步骤S710：判断在第二配准区域内获得的第三配准位置数量是否不小于预设数量。若是，执行步骤S711；若否，执行步骤S705。步骤S711；根据第一变换关系与第三配准位置，确定三维模型与目标髋关节之间的第二变换关系。步骤S712：根据第一变换关系与第二变换关系，对目标髋关节上的实际位置进行变换。步骤S713：移动采集配准位置的工具，使采集配准位置的工具在三维模型中的对应位置位于第一配准区域内，并执行步骤S706。步骤S714：移动采集配准位置的工具接近目标髋关节，并执行步骤S706。一种情况下，上述步骤S713可以通过以下步骤S713A-步骤S713D完成。S713A：判断采集配准位置的工具能否移动到第一配准区域对应的第二配准区域。若是，执行步骤S713D；若否，执行步骤S713B。步骤S713B：使用采集配准位置的工具获取第二区域更新位置。步骤S713C：根据第一变换关系与第二区域更新位置，确定第一区域更新位置，并基于第一区域更新位置更新第一配准区域。步骤S713D：移动采集配准位置的工具，使采集配准位置的工具在三维模型中的对应位置位于第一配准区域内，并执行步骤S706。与上述髋关节实际位置配准方法相对应，本发明实施例还提供了一种髋关节实际位置配准装置。参见图8，提供了一种髋关节实际位置配准装置的结构示意图，所述装置包括：第一配准位置确定模块801，用于确定所述三维模型上的多个第一配准位置以及第一配准区域；第二配准位置确定模块802，用于确定各第一配准位置在所述目标髋关节上对应的第二配准位置；第一变换关系确定模块803，用于对第一配准位置和第二配准位置进行位置配准，确定所述目标髋关节上的点与所述三维模型表面的点间位置的第一变换关系；第三配准位置获得模块804，用于获得在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的多个第三配准位置；第二变换关系确定模块805，用于根据所述三维模型表面各个点的位置、各第三配准位置与所述第一变换关系，确定述目标髋关节上的点与所述三维模型表面的点间位置的第二变换关系；目标髋关节位置配准模块806，用于根据所述第一变换关系与所述第二变换关系，对所述目标髋关节上的实际位置进行变换，完成位置配准。应用本实施例提供的方案，可以在目标髋关节的三维模型上确定第一配准位置，并根据第一配准位置在目标髋关节上确定第二配准位置。这样，根据第一配准位置与第二配准位置，可以得到第一变换关系。此外，根据在目标髋关节上对应于三维模型上第一配准区域的第二配准区域内采集的第三配准位置、三维模型表面的各个点与第一变换关系，可以得到第二变换关系。由于第二变换关系是在第一变换关系基础上得到的，第二变换关系比第一变换关系更准确。这样，根据第一变换关系与第二变换关系对目标髋关节上的实际位置进行变换，可以结合第一变换关系与第二变换关系进行位置配准，配准的准确性比只使用第一变换关系或第二变换关系更高。因此，应用本发明实施例提供的方案可以准确地对髋关节的实际位置进行位置配准。本发明的一个实施例中，所述第二变换关系确定模块805，包括：第四配准位置变换子模块，用于根据所述第一变换关系对各第三配准位置进行位置变换，得到第四配准位置；第五配准位置确定子模块，用于针对每一第四配准位置，根据该第四配准位置与所述三维模型表面各个点的位置，确定所述三维模型表面上与该第四配准位置距离最近的第五配准位置；第二变换关系确定子模块，用于根据各第三配准位置以及与其对应的第五配准位置，确定所述目标髋关节与所述三维模型间的第二变换关系。应用上述方式，可以使用第一变换关系对第三配准位置进行变换，得到第四配准位置，并确定三维模型表面上与每一第四配准位置距离最近的第五配准位置，从而根据第三配准位置与对应的第五配准位置确定第二变换关系。这样确定的第二变换关系是在第一变换关系的基础上进一步确定的，因此，确定的第二变换关系比第一变换关系更准确，基于第二变换关系进行位置配准，可以提高配准的准确度。本发明的一个实施例中，所述装置还包括：区域更新位置获得模块，用于获得采集配准位置的工具在所述目标髋关节上采集的属于髋关节配准区域的第二区域更新位置；区域更新位置确定模块，用于根据所述第二区域更新位置与所述第一变换关系，确定所述三维模型表面上与所述第二区域更新位置对应的第一区域更新位置；区域更新模块，用于根据所确定的第一区域更新位置，更新第一配准区域。这样，可以根据目标髋关节的实际情况，更新第一配准区域，从而保证第一配准区域内的点可以被采集获得，也就保证了获得的第三配准位置的准确度。通过以上方式，基于预设的刚体变换约束条件与预设变换调整结束条件确定并调整第二变换关系，可以使第二变换关系的准确度不断提高，从而得到的最终确定的第二变换关系具有高准确度。这样，基于第二变换关系进行位置配准，可以提高配准的准确度。本发明的一个实施例中，所述第三配准位置获得模块804，包括：第一候选位置获得单元，用于实时获得用于在所述目标髋关节上采集配准位置的工具的第一候选位置；第二候选位置获得单元，用于根据所述第一变换关系，对所述第一候选位置进行位置变换，得到第二候选位置；位置判断单元，用于判断所述第二候选位置是否位于所述第一配准区域内；第三配准位置确定单元，用于当所述第二候选位置位于所述第一配准区域内时，响应于位置获得指令，获得所述工具的当前位置，并确定所述当前位置为第三配准位置。这样获得第三配准位置，可以保证第三配准位置经过位置变换后的位置在第一配准区域内，保证了获得的第三配准位置的准确度。本发明的一个实施例中，所述第三配准位置获得模块804还包括：最短距离获得单元，用于在所述第三配准位置确定单元触发前，获得所述第二候选位置与所述三维模型表面间的最短距离；最短距离判断单元，用于判断所述最短距离是否小于预设误差距离；若为是，则触发所述第三配准位置确定单元。这样，可以在确保第三配准位置经过位置变换后的位置在第一配准区域内的前提下，进一步保证第三配准位置经过位置变换后的位置与三维模型表面间的最短距离小于预设误差距离，也就保证了获得的第三配准位置的准确度。本发明的一个实施例中，所述第一配准位置确定模块801，具体用于获得用户在所述三维模型上选择的多个第一配准位置和髋关节的表征性位置，并获得各表征性位置的描述信息；根据所获得的表征性位置与描述信息，确定第一配准区域；和/或 获得用户在所述三维模型上选择的多个第一配准位置以及框选区域；将所述框选区域确定为第一配准区域。这样，电子设备可以根据髋关节在医学上的结构特点，高效而准确地确定第一配准区域；也可以根据目标髋关节的实际暴露情况，确定能够实际用于配准的第一配准区域。通过上述方式，可以提高第一配准区域确定的效率和准确性。本发明的一个实施例中，所述第二配准位置确定模块802，具体用于：获得第一髋关节参考架上凹槽的位置，作为第二配准位置，其中，所述第一髋关节参考架用于固定于所述目标髋关节上，所述第一髋关节参考架设置有多个凹槽，且多个凹槽连线构成不等边三角形，所述凹槽的位置由与双目相机相连的带有光学示踪球的手术探针采集得到；和/或 获得第二髋关节参考架设置的示踪器的位置，作为第二配准位置，其中，所述示踪器的位置由双目相机采集得到；和/或 获得与双目相机相连的带有反光阵列的手术探针在所述目标髋关节上采集的位置，作为第二配准位置；所述第三配准位置获得模块804，具体用于获得与双目相机相连的带有反光阵列的手术探针在所述目标髋关节上对应于所述第一配准区域的第二配准区域内采集的位置，作为第三配准位置。这样，电子设备可以通过多种方式获得第二配准位置，可以保证获得的第二配准位置的准确度。当获得凹槽位置或示踪器位置作为第二配准位置时，使用者无需判断髋臼窝的方向，降低了对使用者的操作要求；当获得手术探针在目标髋关节上采集的位置作为第二配准位置时，可以通过反光阵列的特定结构确定手术探针针尖所在的位置。此外，电子设备还可以获得手术探针在目标髋关节上采集的位置作为第三配准位置，通过反光阵列的特定结构确定手术探针针尖所在的位置，能够准确地获得第三配准位置。本发明实施例还提供了一种电子设备，如图9所示，包括处理器901、通信接口902、存储器903和通信总线904，其中，处理器901，通信接口902，存储器903通过通信总线904完成相互间的通信，存储器903，用于存放计算机程序；处理器901，用于执行存储器903上所存放的程序时，实现前述方法实施例所述的髋关节实际位置配准方法。上述电子设备提到的通信总线可以是外设部件互连标准总线或扩展工业标准结构总线等。该通信总线可以分为地址总线、数据总线、控制总线等。为便于表示，图中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。通信接口用于上述电子设备与其他设备之间的通信。存储器可以包括随机存取存储器，也可以包括非易失性存储器，例如至少一个磁盘存储器。可选的，存储器还可以是至少一个位于远离前述处理器的存储装置。上述的处理器可以是通用处理器，包括中央处理器、网络处理器等；还可以是数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。在本发明提供的又一实施例中，还提供了一种计算机可读存储介质，该计算机可读存储介质内存储有计算机程序，所述计算机程序被处理器执行时实现前述方法实施例所述的髋关节实际位置配准方法。在上述实施例中，可以全部或部分地通过软件、硬件、固件或者其任意组合来实现。当使用软件实现时，可以全部或部分地以计算机程序产品的形式实现。所述计算机程序产品包括一个或多个计算机指令。在计算机上加载和执行所述计算机程序指令时，全部或部分地产生按照本发明实施例所述的流程或功能。所述计算机可以是通用计算机、专用计算机、计算机网络、或者其他可编程装置。所述计算机指令可以存储在计算机可读存储介质中，或者从一个计算机可读存储介质向另一个计算机可读存储介质传输，例如，所述计算机指令可以从一个网站站点、计算机、服务器或数据中心通过有线）或无线方式向另一个网站站点、计算机、服务器或数据中心进行传输。所述计算机可读存储介质可以是计算机能够存取的任何可用介质或者是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。所述可用介质可以是磁性介质，、光介质、或者半导体介质等。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。本说明书中的各个实施例均采用相关的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于装置、电子设备及存储介质实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。以上所述仅为本发明的较佳实施例，并非用于限定本发明的保护范围。凡在本发明的精神和原则之内所作的任何修改、等同替换、改进等，均包含在本发明的保护范围内。
