标题title
基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法
摘要abst
基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，属于雷达数据处理及目标跟踪技术领域。本发明针对由于舰载平台存在测量噪声导致现有天发舰收高频雷达目标状态估计方法滤波性能差的问题。首先在滤波器上加载天发舰收量测模型、目标运动模型和舰船运动模型并进行初始化；设定N个舰载平台测量误差模型；构造先验状态转移矩阵与初始概率矩阵；舰船运动模型用交互式多模型卡尔曼方法计算各滤波器输入并进行下一时刻状态预测后更新舰船运动模型；采用目标运动模型进行目标状态的预测并更新目标运动模型；结合舰载平台测量误差模型可能性与概率得到目标下一时刻状态估计值。本发明基于顺序多模型EKF实现混合体制雷达状态估计，提高了航迹跟踪精度。
权利要求书clms
1.一种基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于包括，步骤一：根据天发舰收雷达体制建立天发舰收量测模型、目标运动模型和舰船运动模型；第k时刻在地理坐标系下，目标运动模型包括目标状态Xt、目标误差协方差Pt、目标量测误差协方差Rt和目标过程噪声协方差Qt；舰船运动模型包括舰载平台状态Xr、舰载平台误差协方差Pr和舰载平台过程噪声协方差Qr；步骤二：设定n个位置测量误差和m个速度测量误差，形成m*n＝N个舰载平台测量误差模型；采用第f个舰载平台测量误差模型，在第k时刻地理坐标系下初始化目标运动模型和舰船运动模型，得到目标状态Xtf、目标误差协方差Ptf、舰载平台状态Xrf和舰载平台误差协方差Prf，f＝1，2，3，……，N；步骤三：设定由第q个舰载平台测量误差模型到第f个舰载平台测量误差模型的转移概率为Pqf，q＝1，2，3，……，N，根据转移概率构造先验状态转移矩阵P与初始概率矩阵u；步骤四：将N个舰载平台测量误差模型经过交互作用器进行交互计算，得到第f个舰载平台测量误差模型的第k时刻舰载平台状态和舰载平台误差协方差Pr0f；步骤五：采用舰船运动模型基于舰载平台过程噪声协方差Qr进行舰载平台状态预测，得到第k+1时刻的舰载平台状态预测值和舰载平台误差协方差预测值Prf；步骤六：根据第k+1时刻的舰载平台状态预测值得到第k+1时刻天发舰收量测模型的舰载平台量测预测值/＞和舰载平台新息协方差/＞步骤七：基于第f个舰载平台测量误差模型进行舰船运动模型状态更新，得到第k+1时刻舰载平台状态和舰载平台误差协方差Prf；步骤八：基于第f个舰载平台测量误差模型计算目标运动模型的第k时刻目标状态和目标误差协方差Pt0f；再基于步骤七中舰船运动模型状态更新值进行预测，得到第k+1时刻目标状态预测值和目标误差协方差预测值Ptf；步骤九：将第k+1时刻舰载平台状态带入天发舰收量测模型中，根据目标状态预测值/＞进行预测，得到基于第f个舰载平台测量误差模型的目标在雷达坐标系下量测预测值/＞并计算得到第k+1时刻基于第f个舰载平台测量误差模型的目标量测转换矩阵/＞步骤十：基于第f个舰载平台测量误差模型进行目标运动模型状态更新，得到第k+1时刻目标状态和目标误差协方差Ptf；步骤十一：计算第f个舰载平台测量误差模型的可能性Λf，并计算根据可能性Λf更新第f个舰载平台测量误差模型的概率uf；步骤十二：基于N个舰载平台测量误差模型的计算结果，利用状态混合估计器进行目标状态估计，得到第k+1时刻目标状态估计值Xt和目标误差协方差估计值Pt。2.根据权利要求1所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤二中，舰载平台测量误差模型进行初始化的方法为单点初始化；舰载平台误差协方差Prf设定为：式中为舰载平台第i个位置测量误差，i＝1,2,3……n；/＞为舰载平台第j个速度测量误差，j＝1,2,3……m；步骤三中先验状态转移矩阵P为：初始概率矩阵u为：u＝， 式中uN为第N个舰载平台测量误差模型第k时刻的初始概率。3.根据权利要求2所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤四中，第k时刻舰载平台状态为：式中uqf为第f个舰载平台测量误差模型来自第q个舰载平台测量误差模型的概率：为概率归一化值；第k时刻舰载平台误差协方差Pr0f为：4.根据权利要求3所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤五中，舰载平台状态预测值为：舰载平台误差协方差预测值Prf为：Prf＝FPr0fF+Qr， 式中F为状态转移矩阵：式中T为扫描周期；步骤六中，舰载平台量测预测值为：式中Hr为舰载平台量测转换矩阵：舰载平台新息协方差为：为第k+1时刻的舰载平台量测误差协方差；5.根据权利要求4所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤七中，第k+1时刻舰载平台状态和舰载平台误差协方差Prf为：式中为舰载平台增益：Zr为第k+1时刻舰载平台量测值，表示为变量'，依次表示雷达接收射距、多普勒速度与方位角。6.根据权利要求5所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤八中，第k时刻目标状态和目标误差协方差Pt0f为：第k+1时刻目标状态预测值和目标误差协方差预测值Ptf为：Ptf＝FPtfF+Qt。7.根据权利要求6所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤九中，目标在雷达坐标系下量测预测值的获得方法为：将目标状态预测值代入公式中计算得到目标在雷达坐标系下量测预测值/＞目标状态Xt表示为'，依次表示目标在X轴上的位置和速度、目标在Y轴上的位置和速度；变量'表示舰载平台状态Xr，依次表示舰载平台在X轴上的位置和速度、舰载平台在Y轴上的位置和速度；θvR为舰船船头方向与X轴正方向之间的夹角，θTR为X轴正方向与之间的夹角，/＞为目标与发射机的之间的向量，r0为天波路径距离，r1为地波路径距离；h为电离层虚高；目标量测转换矩阵为：式中的矩阵元素为：8.根据权利要求7所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤十中，第k+1时刻目标状态和目标误差协方差Ptf为：Zt为第k+1时刻目标在雷达坐标系下量测值；为目标增益：为运动目标新息协方差：Rt为第k+1时刻目标量测误差协方差。9.根据权利要求8所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤十一中，第f个舰载平台测量误差模型的可能性Λf为：式中为第k+1时刻新息：概率uf为：10.根据权利要求9所述的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，其特征在于，步骤十二中，第k+1时刻目标状态估计值Xt和目标误差协方差估计值Pt为：
说明书desc
技术领域本发明涉及基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，属于雷达数据处理及目标跟踪技术领域。背景技术雷达数据处理及目标跟踪技术在军事和民用方面一直都有着广泛的需求及应用，其中多目标跟踪问题受到重点关注。目标状态估计属于雷达数据处理目标跟踪中的关键构成部分，目标下一时刻状态估计的精度会对目标跟踪以及数据关联造成影响。采用混合传播模式的高频雷达是近年来发展起来的一种新型超视距雷达。其发射站在内陆，发射的电磁波在经过电离层反射后，照射到目标，目标散射的电磁波以地波绕射的传播模式沿着海面传播到达接收站被接收。该类型的雷达的相关技术建立于现有的天波超视距雷达技术、地波超视距雷达技术和舰载雷达技术上，集成了三者的优点，对目标的探测及跟踪能力有明显的提升，根据接收机搭载的平台不同分为天发地收高频雷达与天发舰收高频雷达。天发舰收高频雷达采用天波传播和地波接收，同时具有二者的优点，但混合传播信道比较复杂，包含有时变电离层反射和海面绕射两个传播信道，雷达回波谱特性较单一传播模式复杂。在进行雷达目标状态估计时，涵盖有天波、地波雷达与舰载雷达各自的难题，也包含着两者交叉而引入的新问题：1)由于舰载接收机运动，岸基发射机静止，使得天发舰收高频雷达的系统模型具有复杂的非线性特性。传统固定收发站雷达可以通过坐标配准将雷达坐标中量测值转换为地面坐标下量测值；舰载收发雷达通常以船平台为中心建立坐标系，通过速度补偿可以获得精确的目标状态估计值；但对于天发舰收雷达，雷达量测值中径向速度与径向距离与发射站位置相关，同时接收站在运动，使得地面坐标系与雷达量测之间的转换非线性更强且计算雅可比矩阵更为复杂，使传统的状态估计方法滤波性能变差。2)由于舰载接收机运动，使得天发舰收高频雷达的回波电离层杂波谱和海杂波谱出现展宽和频移，且其与单模式舰载雷达下杂波谱展宽有所区别。我们通常探测的舰船等慢速运动目标，其经常出现于海杂波严重展宽的区域，此时量测误差将会变大；同时测量舰载平台运动参数的自动识别系统也存在误差。如果不采取措施使得这二者对量测误差的影响减小，最终目标状态估计结果将会变差。目前雷达目标跟踪或状态估计算法中卡尔曼滤波器、扩展卡尔曼滤波器工程使用较多，此外还有强跟踪滤波器、不敏卡尔曼滤波器、容积卡尔曼滤波器等诸多改进方法。随着混合体制雷达的发展，这些跟踪算法已经不能够很好的处理目标回波数据，因此需要一种新的方法来进行目标状态估计。发明内容针对由于舰载平台存在测量噪声导致现有天发舰收高频雷达的目标状态估计方法滤波性能差的问题，本发明提供一种基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法。本发明的一种基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，包括，步骤一：根据天发舰收雷达体制建立天发舰收量测模型、目标运动模型和舰船运动模型；第k时刻在地理坐标系下，目标运动模型包括目标状态Xt、目标误差协方差Pt、目标量测误差协方差Rt和目标过程噪声协方差Qt；舰船运动模型包括舰载平台状态Xr、舰载平台误差协方差Pr和舰载平台过程噪声协方差Qr；步骤二：设定n个位置测量误差和m个速度测量误差，形成m*n＝N个舰载平台测量误差模型；采用第f个舰载平台测量误差模型，在第k时刻地理坐标系下初始化目标运动模型和舰船运动模型，得到目标状态Xtf、目标误差协方差Ptf、舰载平台状态Xrf和舰载平台误差协方差Prf，f＝1，2，3，……，N；步骤三：设定由第q个舰载平台测量误差模型到第f个舰载平台测量误差模型的转移概率为Pqf，q＝1，2，3，……，N，根据转移概率构造先验状态转移矩阵P与初始概率矩阵u；步骤四：将N个舰载平台测量误差模型经过交互作用器进行交互计算，得到第f个舰载平台测量误差模型的第k时刻舰载平台状态和舰载平台误差协方差步骤五：采用舰船运动模型基于舰载平台过程噪声协方差Qr进行舰载平台状态预测，得到第k+1时刻的舰载平台状态预测值和舰载平台误差协方差预测值步骤六：根据第k+1时刻的舰载平台状态预测值得到第k+1时刻天发舰收量测模型的舰载平台量测预测值/＞和舰载平台新息协方差/＞步骤七：基于第f个舰载平台测量误差模型进行舰船运动模型状态更新，得到第k+1时刻舰载平台状态和舰载平台误差协方差/＞步骤八：基于第f个舰载平台测量误差模型计算目标运动模型的第k时刻目标状态和目标误差协方差/＞再基于步骤七中舰船运动模型状态更新值进行预测，得到第k+1时刻目标状态预测值和目标误差协方差预测值/＞步骤九：将第k+1时刻舰载平台状态带入天发舰收量测模型中，根据目标状态预测值/＞进行预测，得到基于第f个舰载平台测量误差模型的目标在雷达坐标系下量测预测值/＞并计算得到第k+1时刻基于第f个舰载平台测量误差模型的目标量测转换矩阵/＞步骤十：基于第f个舰载平台测量误差模型进行目标运动模型状态更新，得到第k+1时刻目标状态和目标误差协方差/＞步骤十一：计算第f个舰载平台测量误差模型的可能性Λf，并计算根据可能性Λf更新第f个舰载平台测量误差模型的概率uf；步骤十二：基于N个舰载平台测量误差模型的计算结果，利用状态混合估计器进行目标状态估计，得到第k+1时刻目标状态估计值Xt和目标误差协方差估计值Pt。根据本发明的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，步骤二中，舰载平台测量误差模型进行初始化的方法为单点初始化；舰载平台误差协方差Prf设定为：式中σshipRi为舰载平台第i个位置测量误差，i＝1,2,3……n；σshipVj为舰载平台第j个速度测量误差，j＝1,2,3……m；步骤三中先验状态转移矩阵P为：初始概率矩阵u为：u＝，式中uN为第N个舰载平台测量误差模型第k时刻的初始概率。根据本发明的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，步骤四中，第k时刻舰载平台状态为：式中uqf为第f个舰载平台测量误差模型来自第q个舰载平台测量误差模型的概率：为概率归一化值；第k时刻舰载平台误差协方差为：根据本发明的基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，步骤五中，舰载平台状态预测值为：舰载平台误差协方差预测值为：式中F为状态转移矩阵：式中T为扫描周期；步骤六中，舰载平台量测预测值为：式中Hr为舰载平台量测转换矩阵：舰载平台新息协方差为：为第k+1时刻的舰载平台量测误差协方差；本发明的有益效果：本发明方法根据天发舰收雷达工作原理构造系统模型，进行数据处理和目标状态估计。在构造的混合体制高频雷达量测模型基础上，实现了基于顺序多模型EKF的天发舰收高频雷达联合状态估计。本发明利用多模型思想将舰载平台测量噪声设定多组模型，在模型中利用顺序处理思想，首先对舰载平台状态利用卡尔曼方法进行滤波，将滤波后更为精准的舰载平台状态引入量测模型中利用扩展卡尔曼方法对目标状态进行精准估计，与传统算法相比航迹跟踪精度提升10％以上，与采取单模型时的航迹跟踪精度相比最大可提升5％以上。经实验验证，本发明方法与现有算法相比可以提升在舰载平台测量噪声未知时目标状态估计精度，实现在舰载平台测量噪声未知时的精准状态估计，提高了航迹跟踪精度。附图说明图1是本发明所述基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法的单步执行流程图；图2是仿真实验中进行100次蒙特卡洛仿真，X轴位置均方根误差曲线图；图3是仿真实验中进行100次蒙特卡洛仿真，Y轴位置均方根误差曲线图；图4是仿真实验中进行100次蒙特卡洛仿真，X轴速度均方根误差曲线图；图5是仿真实验中进行100次蒙特卡洛仿真，Y轴速度均方根误差曲线图；图6是天发舰收量测模型示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其它实施例，都属于本发明保护的范围。需要说明的是，在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。下面结合附图和具体实施例对本发明作进一步说明，但不作为本发明的限定。具体实施方式一、结合图1所示，本发明提供了一种基于顺序多模扩展卡尔曼的混合体制雷达状态估计方法，包括，步骤一：根据天发舰收雷达体制建立天发舰收量测模型、目标运动模型和舰船运动模型；第k时刻在地理坐标系下，目标运动模型包括目标状态Xt、目标误差协方差Pt、目标量测误差协方差Rt和目标过程噪声协方差Qt；舰船运动模型包括舰载平台状态Xr、舰载平台误差协方差Pr和舰载平台过程噪声协方差Qr；步骤二：设定n个位置测量误差和m个速度测量误差，形成m*n＝N个舰载平台测量误差模型；采用第f个舰载平台测量误差模型，在第k时刻地理坐标系下初始化目标运动模型和舰船运动模型，得到目标状态Xtf、目标误差协方差Ptf、舰载平台状态Xrf和舰载平台误差协方差Prf，f＝1，2，3，……，N；步骤三：设定由第q个舰载平台测量误差模型到第f个舰载平台测量误差模型的转移概率为Pqf，q＝1，2，3，……，N，根据转移概率构造先验状态转移矩阵P与初始概率矩阵u；步骤四：将N个舰载平台测量误差模型经过交互作用器进行交互计算，得到第f个舰载平台测量误差模型的第k时刻舰载平台状态和舰载平台误差协方差步骤五：采用舰船运动模型基于舰载平台过程噪声协方差Qr进行舰载平台状态预测，得到第k+1时刻的舰载平台状态预测值和舰载平台误差协方差预测值步骤六：根据第k+1时刻的舰载平台状态预测值得到第k+1时刻天发舰收量测模型的舰载平台量测预测值/＞和舰载平台新息协方差/＞步骤七：基于第f个舰载平台测量误差模型进行舰船运动模型状态更新，得到第k+1时刻舰载平台状态和舰载平台误差协方差/＞步骤八：基于第f个舰载平台测量误差模型计算目标运动模型的第k时刻目标状态和目标误差协方差/＞再基于步骤七中舰船运动模型状态更新值进行预测，得到第k+1时刻目标状态预测值和目标误差协方差预测值/＞步骤九：将第k+1时刻舰载平台状态带入天发舰收量测模型中，根据目标状态预测值/＞进行预测，得到基于第f个舰载平台测量误差模型的目标在雷达坐标系下量测预测值/＞并计算得到第k+1时刻基于第f个舰载平台测量误差模型的目标量测转换矩阵/＞步骤十：基于第f个舰载平台测量误差模型进行目标运动模型状态更新，得到第k+1时刻目标状态和目标误差协方差/＞步骤十一：计算第f个舰载平台测量误差模型的可能性Λf，并计算根据可能性Λf更新第f个舰载平台测量误差模型的概率uf；步骤十二：基于N个舰载平台测量误差模型的计算结果，利用状态混合估计器进行目标状态估计，得到第k+1时刻目标状态估计值Xt和目标误差协方差估计值Pt。进一步，步骤二中，舰载平台测量误差模型进行初始化的方法为单点初始化；舰载平台误差协方差Prf设定为：式中为舰载平台第i个位置测量误差，i＝1,2,3……n；/＞为舰载平台第j个速度测量误差，j＝1,2,3……m；步骤三中先验状态转移矩阵P为：初始概率矩阵u为：u＝，式中uN为第N个舰载平台测量误差模型第k时刻的初始概率。再进一步，步骤四中，第k时刻舰载平台状态为：式中uqf为第f个舰载平台测量误差模型来自第q个舰载平台测量误差模型的概率：为概率归一化值；第k时刻舰载平台误差协方差Pr0f为：本实施方式的步骤五中，舰载平台状态预测值为：舰载平台误差协方差预测值Prf为：式中F为状态转移矩阵：式中T为扫描周期；步骤六中，舰载平台量测预测值为：式中Hr为舰载平台量测转换矩阵：舰载平台新息协方差为：为第k+1时刻的舰载平台量测误差协方差；步骤七中，第k+1时刻舰载平台状态和舰载平台误差协方差为：式中为舰载平台增益：Zr为第k+1时刻舰载平台量测值，表示为变量'，依次表示雷达接收射距、多普勒速度与方位角。步骤八中，第k时刻目标状态和目标误差协方差Pt0f为：对第k时刻第f种目标状态和误差协方差进行一步预测，得到第k+1时刻目标状态预测值和目标误差协方差预测值/＞为：步骤九中，目标在雷达坐标系下量测预测值的获得方法为：将目标状态预测值代入公式中计算得到目标在雷达坐标系下量测预测值/＞目标状态Xt表示为'，依次表示目标在X轴上的位置和速度、目标在Y轴上的位置和速度；变量'表示舰载平台状态Xr，依次表示舰载平台在X轴上的位置和速度、舰载平台在Y轴上的位置和速度；θvR为舰船船头方向与X轴正方向之间的夹角，θTR为X轴正方向与之间的夹角，/＞为目标与发射机的之间的向量，r0为天波路径距离，r1为地波路径距离；h为电离层虚高；目标量测转换矩阵式中的矩阵元素为：步骤十中，对第f个滤波器目标运动状态更新可得第k+1时刻目标状态和目标误差协方差/＞为：Zt为第k+1时刻目标在雷达坐标系下量测值；为目标增益：为运动目标新息协方差：Rt为第k+1时刻目标量测误差协方差。步骤十一中，进行模型可能性计算，第k+1时刻第f个舰载平台测量误差模型的可能性Λf为：式中为第k+1时刻新息：概率uf为：步骤十二中，将各个模型输出的状态估计和误差协方差、更新后的模型概率输入状态混合估计器中，进行交互式输出，得到第k+1时刻目标状态估计值Xt和目标误差协方差估计值Pt为：仿真实验：雷达目标状态估计算法仿真参数配置：天发舰收高频雷达发射站设为坐标原点，接收站在舰船上，舰船起始位置为X轴10km，速度为3m/s，Y轴10km，速度3m/s；对于舰载平台与目标，由于运动状态的不稳定性导致的噪声以X轴加速度与Y轴加速度的形式给出，二者均符合均方差为0.0001m/s2的高斯分布，每个探测周期积累时间为40s，共仿真产生100个探测周期。将方位角测量误差设置为0.5°，射距测量误差设置为2km，多普勒速度测量误差为0.1m/s，GPS测位置误差为1m，测速误差为0.05m/s，模型中设置位置测量误差分别为0.5m，1.5m，速度测量误差分别为0.025m/s和0.075m/s，对应舰载平台测量误差模型1为，模型2为，模型3为，模型4为。目标采用匀速直线运动舰船目标，该匀速直线运动目标起始位置为X轴200km，速度为3m/s，Y轴1000km，速度4m/s。在上述参数下进行100次蒙特卡洛仿真，计算均方根误差，如图2至图5所示。对于第w次仿真，第t个目标的第v维的滤波误差为：/＞式中Xt为k时刻目标真实状态；则W次蒙特卡洛仿真第t个目标第v维的航迹跟踪精度计算公式为：由图2至图5可知，参考算法EKF在混合体制雷达的情况下，目标跟踪精度小于本发明方法跟踪精度。表1给出了本发明方法200个探测周期不同模型及融合模型对应目标位置与速度估计的平均RMSE。表1 200扫描周期平均RMSE表1中ED-EKF表示本发明的顺序多摸扩展卡尔曼滤波方法。由表1可以看出本发明方法在X轴位置跟踪精度提升约167m，速度上提升0.21m/s，Y轴位置跟踪精度上提升186m，Y轴速度上提升0.23m/s，表明本发明方法与现有方法相比较可以提升混合体制下目标状态估计精度，实现更好的目标跟踪。具体实施例：1)构造天发舰收量测模型如图6所示，图中b为短时方位角，θ为目标与原点的连线与Y轴之间的角度，ρ为目标与发射机之间的距离，d1为接收机与发射机之间的距离，为发射机和目标之间的途径与接收机和目标之间的途径的夹角，ψ2为发射机和接收机之间的途径与接收机和目标的途径的夹角，R1为舰载平台。根据天发舰收量测模型的几何关系可推导出量测与状态之间的数学关系式，即根据图中角度关系以及坐标系转换公式，建立以目标在地理坐标系下的状态Xt为自变量，目标在雷达坐标系下的状态Zt为因变量的量测转换方程，进一步推导得到第k+1时刻量测转换矩阵H表达式。根据目标运动规律建立状态方程。2)多模型EKF构造，设置n种舰载位置测量误差和m种舰载速度测量误差，不同的位置误差与速度误差构成一个EKF模型，共n*m个模型；利用已知先验信息设置每个模型的初始值：舰船状态向量目标状态向量/＞舰船误差协方差/＞目标误差协方差矩阵/＞采取单点初始化方法进行从初始化。3)构造先验状态转移矩阵P，确定模型q到模型f之间的转换概率Pqf，用于表示模型之间的关系程度，可通过转换矩阵计算每个滤波器模型输入的加权系数，初始概率矩阵u。4)首先对舰船平台采用交互式多模型EKF卡尔曼滤波方法，将所有模型通过一个交互器计算每个滤波器k时刻的输入即每个模型下一时刻的输入是所有模型当前时刻的状态向量/＞加权求和；加权系数与前一时刻以及当前时刻的模型转换概率相关；由此可以推导出每个模型误差协方差的输入表达式。5)从地理坐标系中舰载平台的运动规律出发，假设舰船运动规律为匀速直线运动，加速度以噪声形式出现，在k时刻，对每个EKF模型舰船的状态向量Xrf进行一步外推预测k+1时刻目标状态Xrf，计算每个模型舰载平台的误差协方差预测值。6)根据构造的舰船量测方程，对每个模型的舰船平台运动信息进行一步外推预测得到舰船量测预测值计算舰载平台每个模型的新息协方差/＞和增益7)根据式、对舰载平台在地理坐标系下的状态与状态误差协方差进行更新，得到在k+1时刻的舰载平台状态与状态误差协方差。同步骤4)相似，利用式、计算每个滤波器目标状态与误差协方差的输入值。8)从地理坐标系目标的运动规律出发，假设目标运动规律为匀速直线运动，加速度以噪声形式出现，在k时刻，用状态方程对每个EKF模型目标的状态向量Xtf进行一步外推预测k+1时刻目标状态Xtf，计算每个模型舰载平台的误差协方差预测值。9)从图6构建的模型分析，可根据第f个滤波器舰载平台在k+1时刻的更新估计状态以及步骤8)中目标状态的一步预测结果，带入量测转换方程中，得到k+1时刻雷达坐标系下目标的预测值，并由此计算k+1时刻的量测转换矩阵、运动目标新息协方差、增益、新息。10)根据式、对运动目标在地理坐标系下的状态与状态误差协方差进行更新，得到在k+1时刻的目标状态与状态误差协方差。11)计算各模型的可能性，即更新k+1时刻模型f对应的概率或加权系数uf。12)将各模型输出的目标状态估计和误差协方差估计，用步骤11)中计算的概率进行加权融合，得到各模型的交互式输出，即得到最终顺序多模型EKF雷达目标状态Xt估计的结果，同时更新误差协方差。本发明方法中，变量含的为变量的第k时刻对应值，变量含的为对应变量由第k时刻到第k+1时刻的预测值，变量含的为变量第k+1时刻对应更新值。虽然在本文中参照了特定的实施方式来描述本发明，但是应该理解的是，这些实施例仅仅是本发明的原理和应用的示例。因此应该理解的是，可以对示例性的实施例进行许多修改，并且可以设计出其他的布置，只要不偏离所附权利要求所限定的本发明的精神和范围。应该理解的是，可以通过不同于原始权利要求所描述的方式来结合不同的从属权利要求和本文中所述的特征。还可以理解的是，结合单独实施例所描述的特征可以使用在其它所述实施例中。
