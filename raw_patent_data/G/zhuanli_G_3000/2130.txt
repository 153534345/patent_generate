标题title
一种风力发电系统的阻抗优化方法
摘要abst
本发明公开了一种风力发电系统的阻抗优化方法，属于电力系统稳定性领域，双馈风机主电路从左至右包括：双馈风机、转子侧变压器T、转子侧滤波电感Lr、机侧变流器MSC、变流器电容、网侧变流器GSC、网侧滤波电感Lg、网侧电容以及电网，基于双馈风机转子侧控制环节虚拟电阻的控制环节、双馈网侧变流器附加带通滤波器控制环节和基于本发明的优化调试方法，以实现双馈风机系统的阻抗优化。本发明提出了小风工况阻抗优化方案和对应的优化调试方法，可以针对性解决小风工况下次超同步振荡问题，并实现双馈风机的阻抗优化，技术效果好、实用价值高。
权利要求书clms
1.一种风力发电系统的阻抗优化方法，双馈风机主电路从左至右包括：双馈风机、转子侧变压器T、转子侧滤波电感Lr、机侧变流器MSC、变流器电容、网侧变流器GSC、网侧滤波电感Lg、网侧电容以及电网，其特征在于：DFIG转子侧引入虚拟阻抗，由转子侧线路中采集到的转子侧电流d轴分量idr和转子侧电流q轴分量iqr为输入分量，通过虚拟阻抗得到附加信号，加入到PI调节器输出环节，起到阻抗优化的作用；同时在网侧控制环节加入带通滤波器，由网侧线路中采集到的网侧电压d轴分量ugd和网侧电压q轴分量ugq为输入分量，经带通滤波器后，作为负反馈输入PI调节器。2.根据权利要求1所述的一种风力发电系统的阻抗优化方法，其特征在于：转子侧电感电流ir_abc由转子侧线路中采集到，经坐标变换后得到转子侧电感电流d轴分量idr和转子侧电感电流q轴分量iqr；网侧电感电流ig_abc由网侧线路中采集到，经坐标变换后得到网侧电感电流d轴分量igd和网侧电感电流q轴分量igq；网侧电容电压ug_abc由网侧线路中采集到，经坐标变换后得到网侧电容电压d轴分量ugd和网侧电容电压q轴分量ugq；转子侧相角θr及频率ωr经由光电编码器得到，网侧相角θg及频率ωg经由锁相环得到。3.根据权利要求1所述的一种风力发电系统的阻抗优化方法，其特征在于：虚拟阻抗包括电阻、电感或电容，虚拟阻抗控制器的传递函数Z表达式为：其中，R表示电阻，L表示电感，C表示电容；带通滤波器传递函数表达式为：其中，m为增益，k为阻尼系数，取0.707，ω为中心角频率＝2πf，f为中心频率。4.根据权利要求1所述的一种风力发电系统的阻抗优化方法，其特征在于：MSC及GSC的调制方式为空间矢量调制，MSC的q轴分量控制方式为转矩外环-电流内环双闭环控制，d轴分量控制方式为电压外环—电流内环双闭环控制；GSC的q轴分量控制方式为电流闭环控制，d轴分量控制方式为电压外环—电流内环双闭环控制。5.根据权利要求1所述的一种风力发电系统的阻抗优化方法，其特征在于：参考电流iqr_ref由转子侧参考转矩Te_ref经调节后得到，调节器表达式为：K*ωg，K为由转矩计算的有功电流系数，ωg为网侧频率；参考电流idr_ref由网侧电容电压q轴分量ugq经调节后得到，调节器表达式为：1/Xm，Xm为50Hz时的励磁电抗；参考电流id_ref由变流器电容电压udc及变流器电容参考电压udc_ref经PI调节器后得到。6.根据权利要求1-5任一项所述的一种风力发电系统的阻抗优化方法，其特征在于优化调试方法包括以下步骤：步骤S1、利用蜻蜓算法，调试带通滤波增益m、中心频率f参数；步骤S2、判断系统是否能够稳定运行，若是，则执行步骤S3，若否，则返回执行S1；步骤S3、判断系统在0～H1频段内阻抗相位是否满足要求，若是，则执行步骤S4，若否，则返回执行步骤S1；步骤S4、利用蜻蜓算法，调试虚拟阻抗参数，包括虚拟电阻、电容或电感；步骤S5、判断判断系统是否能够稳定运行，若是，则执行步骤S6，若否，则返回执行S4；步骤S6、判断系统在全部频段内阻抗相位是否满足要求，若是，则优化调试结束，若否，则返回执行步骤S4。7.根据权利要求6所述的一种风力发电系统的阻抗优化方法，其特征在于包括以下步骤：所述应用蜻蜓算法调试参数的步骤如下：步骤1、进行相关参数设置，随机初始化算法中单体位置向量和步长向量；步骤2、判断当前迭代次数t是否小于最大迭代次数M，若是，则进行步骤S3；若否，则输出参数调试结果，调试结束；步骤3、更新权重和领域半径，计算个体适应度，更新分离权重s，对齐权重a，内聚权重c，食物因子f，敌人因子e；步骤4、判断是否有领域，即在该领域内是否存在目标解，若是，则先用步长向量以及位置向量的数学模型表达式更新步长向量和位置向量，再进行步骤5；若否，则直接进行步骤5；其中，步长向量的数学模型表达式为：ΔXt+1＝+ωΔXt式中，ω为惯性权重；ΔXt为迭代次数t时的步长向量；Si为第i个个体分离，其表达式为：X为当前个体位置；Xj为第j个相邻个体位置；N为种群相邻个体数量；Ai为第i个个体对齐，其表达式为：Vj为种群中第j个相邻个体的速度；Ci为第i个个体内聚，其表达式为：Fi为第个i个体食物来源，其表达式为：Fi＝X+-XX+为食物当前位置；Ei为第i个个体敌人位置，其表达式为：Ei＝X--XX-为敌人当前位置；位置向量的数学模型表达式为：Xt+1＝Xt+ΔXt+1步骤5、用步骤4中所述步长向量的数学模型表达式更新步长向量，并用Levy飞行更新位置向量后，返回步骤2；Levy飞行更新位置向量表达式为：Xt+1＝Xt+Levy×Xt式中，d为位置向量维数；其中，r1、r2为中的2个随机数；β为常数；σ的计算公式为：式中：Γ＝！。
说明书desc
技术领域本发明属于电力系统稳定性领域，具体涉及一种风力发电系统的阻抗优化方法。背景技术“碳达峰、碳中和”目标下，加快以风能、太阳能为代表的新能源大规模开发利用，有助于能源电力低碳转型，2021年，全国风电新增并网装机4757万kW，同比增长16.6％。截至2021年底，风电累计装机容量3.28亿kW，其中陆上风机累计装机3.02亿kW。在风电方面已形成大功率、高电压、远距离输送格局。风电经串联补偿电容送出在实际工程中得到了广泛的应用。然而，双馈风机系统存在次超同步振荡问题，通过对双馈风机进行阻抗优化可以有效地抑制系统次超同步振荡。因此，对双馈风机进行阻抗优化，抑制双馈风机系统次超同步振荡具有重要意义。李鹏瀚等人在文献《双馈风电机组次同步控制相互作用的反馈线性化滑模变结构抑制》中提出双馈风机转子侧控制环节利用滑模变结构的控制策略，对双馈风电机组并网次同步控制相互作用引发的次同步振荡进行抑制；苏田宇等人在文献《并网双馈风电场次/超同步混合振荡现象及阻尼控制方案》中针对双馈风机经串补并网引发的次/超同步振荡，在双馈风机转子侧控制环节附加阻尼器对其抑制；单碧涵等人在文献《基于定子侧模拟电阻的双馈风电场次同步振荡抑制策略研究》中提出在转子侧控制环节中采用附加阻尼控制策略来实现对次同步谐振抑制。在小风工况下，即有功最小出力工况下，双馈风机系统阻抗难以满足新能源场站阻抗特性技术要求。目前针对双馈风机阻抗优化问题已提出许多方案，但是大多为基于额定功率工况的阻抗优化方案，在小风工况优化效果差，不适合于小风条件下的双馈风机阻抗优化，并暂未针对于小风工况阻抗优化进行设计；另外，目前已有方案暂未在机侧添加虚拟电阻，在网侧控制添加带通滤波器阻抗优化方案。发明内容本发明的目的是提供一种风力发电系统的阻抗优化方法，能够对处于小风工况下的双馈风机进行阻抗优化，解决小风工况下次超同步振荡问题。为了实现上述目的，本发明采用的技术方案是：一种风力发电系统的阻抗优化方法，双馈风机系统主电路从左至右包括：双馈风机、转子侧变压器T、转子侧滤波电感Lr、机侧变流器、变流器电容、网侧变流器、网侧滤波电感Lg、网侧电容及电网。转子侧电感电流ir_abc由转子侧线路中采集到，经坐标变换后得到转子侧电感电流d轴分量idr和转子侧电感电流q轴分量iqr；网侧电感电流ig_abc由网侧线路中采集到，经坐标变换后得到网侧电感电流d轴分量igd和网侧电感电流q轴分量igq；网侧电容电压ug_abc由网侧线路中采集到，经坐标变换后得到网侧电容电压d轴分量ugd和网侧电容电压q轴分量ugq；转子侧相角θr及频率ωr经由光电编码器得到，网侧相角θg及频率ωg经由锁相环得到。MSC及GSC的调制方式为空间矢量调制，MSC的q轴分量控制方式为转矩外环-电流内环双闭环控制，d轴分量控制方式为电压外环—电流内环双闭环控制；GSC的q轴分量控制方式为电流闭环控制，d轴分量控制方式为电压外环—电流内环双闭环控制。其中，参考电流iqr_ref由转子侧参考转矩Te_ref经调节后得到，调节器表达式为：K*ωg，K为由转矩计算的有功电流系数，ωg为网侧频率；参考电流idr_ref由网侧电容电压q轴分量ugq经调节后得到，调节器表达式为：1/Xm，Xm为50Hz时的励磁电抗；参考电流id_ref由变流器电容电压udc及变流器电容参考电压udc_ref经PI调节器后得到。DFIG转子侧引入虚拟阻抗，由转子侧线路中采集到的转子侧电感电流d轴分量idr和转子侧电感电流q轴分量iqr为输入分量，通过虚拟阻抗得到附加信号，加入到PI调节器输出环节，起到阻抗优化的作用。其中虚拟阻抗包括电阻、电感或电容，虚拟阻抗控制器的传递函数Z表达式为：其中，R表示电阻，L表示电感，C表示电容。同时在网侧控制环节加入带通滤波器，由网侧线路中采集到的网侧电容电压d轴分量ugd和网侧电容电压q轴分量ugq为输入分量，经带通滤波器后，作为负反馈输入PI调节器，起到滤除谐波及阻抗优化的作用。带通滤波器传递函数表达式为：其中，m为增益，k为阻尼系数，取0.707，ω为中心角频率＝2πf，f为中心频率。风机的阻抗优化调试方法，包括以下步骤：步骤S1、利用蜻蜓算法，调试带通滤波增益m、中心频率f参数；步骤S2、判断系统是否能够稳定运行，若是，则执行步骤S3，若否，则返回执行S1；步骤S3、判断系统在0～H1频段内阻抗相位是否满足要求，若是，则执行步骤S4，若否，则返回执行步骤S1；步骤S4、利用蜻蜓算法，调试虚拟阻抗参数，包括虚拟电阻、电容或电感；步骤S5、判断系统是否能够稳定运行，若是，则执行步骤S6，若否，则返回执行S4；步骤S6、判断系统在全部频段内阻抗相位是否满足要求，若是，则优化调试结束，若否，则返回执行步骤S4。上述优化调试方法中所述的蜻蜓算法，包括以下步骤：步骤1、进行相关参数设置，随机初始化算法中单体位置向量和步长向量；步骤2、判断当前迭代次数t是否小于最大迭代次数M，若是，则进行步骤3；若否，则输出参数调试结果，调试结束；步骤3、更新权重和领域半径，计算个体适应度，更新分离权重s，对齐权重a，内聚权重c，食物因子f，敌人因子e；步骤4、判断是否有领域，即在该领域内是否存在目标解，若是，则先用步长向量以及位置向量的数学模型表达式更新步长向量和位置向量，再进行步骤5；若否，则直接进行步骤5；其中，步长向量的数学模型表达式为：ΔXt+1＝+ωΔXt式中，ω为惯性权重；ΔXt为迭代次数t时的步长向量；Si为第i个个体分离，其表达式为：X为当前个体位置；Xj为第j个相邻个体位置；N为种群相邻个体数量；Ai为第i个个体对齐，其表达式为：Vj为种群中第j个相邻个体的速度；Ci为第i个个体内聚，其表达式为：Fi为第个i个体食物来源，其表达式为：Fi＝X+-XX+为食物当前位置；Ei为第i个个体敌人位置，其表达式为：Ei＝X--XX-为敌人当前位置；位置向量的数学模型表达式为：Xt+1＝Xt+ΔXt+1步骤5、用步骤4中所述步长向量的数学模型表达式更新步长向量，并用Levy飞行更新位置向量后，返回步骤2；Levy飞行更新位置向量表达式为：Xt+1＝Xt+Levy×Ht式中，d为位置向量维数；其中，r1、r2为中的2个随机数；β为常数；σ的计算公式为：式中：Γ＝！。由于采用了上述技术方案，本发明取得的技术效果有：本发明提出了小风工况阻抗优化方案和对应的优化调试方法，可以针对性解决小风工况下次超同步振荡问题，并实现双馈风机的阻抗优化，技术效果好、实用价值高。附图说明图1是本发明系统电路及控制总示意图；图2是本发明转子侧变流器电流环控制图；图3是本发明网侧变流器电流环控制图；图4是本发明优化调试方法流程图；图5是本发明全频段阻抗相位要求图；图6是优化前后阻抗曲线的对比。具体实施方式下面结合附图对本发明技术方案做进一步详细说明：如图1所示，一种风力发电系统的阻抗优化方法，双馈风机系统主电路从左至右包括：双馈风机、转子侧变压器T、转子侧滤波电感Lr、机侧变流器、变流器电容、网侧变流器、网侧滤波电感Lg、网侧电容及电网。图中K：由转矩计算的有功电流系数；Xm：50Hz时的励磁电抗；K1r：电机漏抗系数；ls：定子绕组自感；lm定转子绕组互感。转子侧电感电流ir_abc由转子侧线路中采集到，经坐标变换后得到转子侧电感电流d轴分量idr和转子侧电感电流q轴分量iqr；网侧电感电流ig_abc由网侧线路中采集到，经坐标变换后得到网侧电感电流d轴分量igd和网侧电感电流q轴分量igq；网侧电容电压ug_abc由网侧线路中采集到，经坐标变换后得到网侧电容电压d轴分量ugd和网侧电容电压q轴分量ugq；转子侧相角θr及频率ωr经由光电编码器得到，网侧相角θg及频率ωg经由锁相环得到。MSC及GSC的调制方式为空间矢量调制，MSC的q轴分量控制方式为转矩外环-电流内环双闭环控制，d轴分量控制方式为电压外环—电流内环双闭环控制；GSC的q轴分量控制方式为电流闭环控制，d轴分量控制方式为电压外环—电流内环双闭环控制。其中，参考电流iqr_ref由转子侧参考转矩Te_ref经调节后得到，调节器表达式为：K*ωg，K为由转矩计算的有功电流系数，ωg为网侧频率；参考电流idr_ref由网侧电容电压q轴分量ugq经调节后得到，调节器表达式为：1/Xm，Xm为50Hz时的励磁电抗；参考电流id_ref由变流器电容电压udc及变流器电容参考电压udc_ref经PI调节器后得到。MSC及GSC的电流环控制过程为：MSC电流环控制过程为：如图2所示，参考电流iqr_ref/idr_ref与转子侧电感电流q/d轴分量iqr/idr作差后经PI调节，其输出信号与iqr/idr通过虚拟阻抗得到的信号相加，从而得到调制波。其中，调制波相角为θg-θr，θg为网侧相角，θr为转子侧相角；虚拟阻抗包括电阻、电感或电容，虚拟阻抗控制器的传递函数Z表达式为：其中，R表示电阻，L表示电感，C表示电容。GSC电流环控制过程为：如图3所示，参考电流0/id_ref与网侧电感电流q/d轴分量igq/igd作差后，减去反馈回来的滤波信号，经PI调节后得到输出信号，由网侧电容电压q/d轴分量ugq/ugd减去其输出信号，从而得到调制波。其中，调制波相角为θg，θg为网侧相角；负反馈信号为由网侧线路中采集到的网侧电容电压d轴分量ugd和网侧电容电压q轴分量ugq为输入分量经带通滤波器后得到的，带通滤波器传递函数表达式为：其中，m为增益，k为阻尼系数，取0.707，ω为中心角频率＝2πf，f为中心频率。如图4所示，本发明风机的阻抗优化调试方法为：步骤S1、利用蜻蜓算法，调试带通滤波增益m、中心频率f参数；步骤S2、判断系统是否能够稳定运行，若是，则执行步骤S3，若否，则返回执行S1；步骤S3、判断系统在0～H1频段内阻抗相位是否满足要求，若是，则执行步骤S4，若否，则返回执行步骤S1，其中，H1的取值为100，全频段取值范围为0～2000，全频段阻抗相位要求如图5所示；步骤S4、利用蜻蜓算法，调试虚拟阻抗参数，包括虚拟电阻、电容或电感；步骤S5、判断判断系统是否能够稳定运行，若是，则执行步骤S6，若否，则返回执行S4；步骤S6、判断系统在全部频段内阻抗相位是否满足要求，若是，则优化调试结束，若否，则返回执行步骤S4。其中，应用蜻蜓算法调试参数包括以下步骤：步骤1、进行相关参数设置，随机初始化算法中单体位置向量和步长向量；步骤2、判断当前迭代次数t是否小于最大迭代次数M，若是，则进行步骤3；若否，则输出参数调试结果，调试结束；步骤3、更新权重和领域半径，计算个体适应度，更新分离权重s，对齐权重a，内聚权重c，食物因子f，敌人因子e；步骤4、判断是否有领域，即在该领域内是否存在目标解，若是，则先用步长向量以及位置向量的数学模型表达式更新步长向量和位置向量，再进行步骤5；若否，则直接进行步骤5；其中，步长向量的数学模型表达式为：ΔXt+1＝+ωΔXt式中，ω为惯性权重；ΔXt为迭代次数t时的步长向量；Si为第i个个体分离，其表达式为：X为当前个体位置；Xj为第j个相邻个体位置；N为种群相邻个体数量；Ai为第i个个体对齐，其表达式为：Vj为种群中第j个相邻个体的速度；Ci为第i个个体内聚，其表达式为：Fi为第个i个体食物来源，其表达式为：Fi＝X+-XX+为食物当前位置；Ei为第i个个体敌人位置，其表达式为：Ei＝X--XX-为敌人当前位置；位置向量的数学模型表达式为：Xt+1＝Xt+ΔXt+1步骤5、用步骤4中所述步长向量的数学模型表达式更新步长向量，并用Levy飞行更新位置向量后，返回步骤2；Levy飞行更新位置向量表达式为：Xt+1＝Xt+Levy×Xt式中，d为位置向量维数；其中，r1、r2为中的2个随机数；β为常数；σ的计算公式为：式中：Γ＝！。对比结果如图6所示，图6中蓝色线条为优化之前结果，紫色线为优化后的结果，红色虚线内为0-100Hz阻抗相位要求，可以看出通过该方案优化后的阻抗曲线更多的在红色虚线之中，更加满足阻抗相位要求。
