标题title
一种基于物联网的智慧交通大数据分析系统
摘要abst
本发明公开了一种基于物联网的智慧交通大数据分析系统，所述智慧交通大数据分析系统包括相互连接的数据中台、多个边缘计算子系统和多个智慧道路监测子系统；多个边缘计算子系统分别对应设置在不同区域，所述区域内设置有至少一个智慧道路监测子系统；所述智慧道路监测子系统将采集数据发送至所述边缘计算子系统；各个所述多个边缘计算子系统用于对其对应的区域进行数据处理，并将数据处理结果发送至所述数据中台；所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备，所述边缘计算子系统被配置为执行非机动车监测步骤。基于物联网和人工智能分析等技术，实现辅助非机动车交通违法违规的管控，具有较高的推广应用价值。
权利要求书clms
1.一种基于物联网的智慧交通大数据分析系统，其特征在于，所述智慧交通大数据分析系统包括相互连接的数据中台、多个边缘计算子系统和多个智慧道路监测子系统；多个边缘计算子系统分别对应设置在不同区域，所述区域内设置有至少一个智慧道路监测子系统；所述智慧道路监测子系统将采集数据发送至所述边缘计算子系统；各个所述多个边缘计算子系统用于对其对应的区域进行数据处理，并将数据处理结果发送至所述数据中台；所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备，所述边缘计算子系统被配置为执行如下非机动车监测步骤：获取由交通信号机发送至交通信号灯的控制指令；当控制指令为红灯指令时，获取由所述摄像设备采集的交通信号灯所在道路的图像数据；识别所述图像数据中是否存在闯红灯的非机动车；当识别到存在闯红灯的非机动车，生成非机动车违规结果；将非机动车违规结果和对应的图像数据上传至数据中台。2.根据权利要求1所述的一种基于物联网的智慧交通大数据分析系统，其特征在于，所述边缘计算子系统被配置为执行如下道路事故监测步骤：获取由所述摄像设备采集其所在道路的图像数据；检测图像数据中的第一目标对象、第二目标对象和第三目标对象，生成对应的目标检测框；其中，所述第一目标对象为人，所述第二目标对象为非机动车，所述第三目标对象为机动车；采用多目标追踪算法分别对第一目标对象、第二目标对象和第三目标对象进行追踪；采用轨迹预测模型分别预测第一目标对象、第二目标对象和第三目标对象的轨迹，得到第一预测规则、第二预测轨迹和第三预测轨迹；计算所述第一预测规则、第二预测轨迹和第三预测轨迹中的任意两个预测轨迹之间是否存在事故冲突点；当存在事故冲突点时，生成道路事故预警信息；将道路事故预警信息、图像数据、第一预测规则、第二预测轨迹和第三预测轨迹上传至数据中台。3.根据权利要求1所述的一种基于物联网的智慧交通大数据分析系统，其特征在于，所述边缘计算子系统被配置为执行如下交通信号灯调控步骤：获取由交通信号机发送至交通信号灯的控制指令；当控制指令为红灯指令时，获取由所述智慧道路监测子系统发送的交通信号机所在道路的应采集数据；对采集数据进行识别，得到各行车道对应的机动车数量和非机动车数量；根据机动车数量和非机动车数量，按预设调控规则生成调控指令；所述调控指令用于调整交通信号灯的信号灯的亮灯时间；将调控指令发送至交通信号机，通过交通信号机对交通信号灯进行控制。4.根据权利要求3所述的一种基于物联网的智慧交通大数据分析系统，其特征在于：所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备和雷达设备，所述摄像设备和雷达设备对应设置在同一道路上，用于检测该道路上的目标对象；其中，所述对采集数据进行识别，得到各行车道对应的机动车数量和非机动车数量，具体包括以下步骤：获取由所述摄像设备采集其所在道路的RGB图像数据；获取由所述雷达设备采集其所在道路的点云数据；所述RGB图像数据和点云数据在时间上相对应；对RGB图像数据进行目标对象检测，得到目标对象为非机动车的若干第一2D候选检测框，以及目标对象为机动车的若干第二2D候选检测框；对点云数据进行目标对象检测，得到目标对象为非机动车的若干第一3D候选检测框，以及目标对象为机动车的若干第二3D候选检测框；采用决策融合算法将点云数据中的若干第一3D候选检测框和若干第二3D候选检测框，与RGB图像数据中的若干第一2D候选检测框和若干第二2D候选检测框进行拼接，输出3D检测结果；获取道路的行车道信息，根据行车道和3D检测结果的位置，对各行车道上的3D检测结果进行计数，得到各行车道对应的机动车数量和非机动车数量。5.根据权利要求1所述的一种基于物联网的智慧交通大数据分析系统，其特征在于：所述智慧道路监测子系统还包括多个智慧路灯和多个测速设备，多个智慧路灯沿着城市边缘区域的道路依次间隔布设；所述智慧路灯设置有抓拍摄像设备，多个测速设备对应智慧路灯设置在道路上，所述测速设备和智慧路灯连接；其中，所述边缘计算子系统被配置为执行如下偏僻道路监测步骤：获取由当前智慧路灯所发送的第一抓拍图像数据和机动车的第一测速数据；对第一抓拍图像数据进行目标识别，生成多个对应第一目标对象、第二目标对象和第三目标对象的目标检测框；所述第一目标对象为人，所述第二目标对象为非机动车，所述第三目标对象为机动车；分别对第一抓拍图像数据的第一目标对象、第二目标对象和第三目标对象进行计数，得到经过当前智慧路灯的第一目标对象、第二目标对象和第三目标对象的第一总数；获取由下一智慧路灯所发送的第二抓拍图像数据和机动车的第二测速数据；对第二抓拍图像数据进行目标识别，生成多个对应第一目标对象、第二目标对象和第三目标对象的目标检测框；对第二抓拍图像数据的第一目标对象、第二目标对象和第三目标对象进行计数，分别得到经过当前智慧路灯的第一目标对象、第二目标对象和第三目标对象的第二总数；按预设规则，比较第一目标对象、第二目标对象和第三目标对象的第一总数和第二总数；当比较结果不一致时，生成预警信息，和/或，当第一测速数据和第二测速数据超出预设速度值时，生成车辆违规信息；将预警信息和/或车辆违规信息、以及对应的第一抓拍图像数据、第一测速数据、第二抓拍图像数据和第一测速数据上传至数据中台。6.根据权利要求5所述的一种基于物联网的智慧交通大数据分析系统，其特征在于，所述按预设规则，比较第一目标对象、第二目标对象和第三目标对象的第一总数和第二总数，具体包括以下步骤：在第一预设时间内，若第一目标对象的第一总数与第二总数不匹配，则生成第一目标对象的预警信息；在第二预设时间内，若第三目标对象的第一总数与第二总数不匹配，则生成第二目标对象的预警信息；在第三预设时间内，若第三目标对象的第一总数与第二总数不匹配，则生成第三目标对象的预警信息；其中，所述第三预设时间的时长＜第二预设时间的时长＜第一预设时间的时长。7.根据权利要求5所述的一种基于物联网的智慧交通大数据分析系统，其特征在于：所述智慧灯杆设置有一键求助设备，所述一键求助设备设置有紧急报警按钮、高清摄像头和支持双向语音对讲的通信器。8.根据权利要求1至7任意一所述的一种基于物联网的智慧交通大数据分析系统，其特征在于，所述数据中台包括：交通数据接入子系统，其用于至少获取多个区域内的车联网数据，所述车联网数据包括多个车辆轨迹数据；GIS引擎子系统，其用于提供包括多个所述区域的城市路网数据；交通数据预处理子系统，其用于对车联网数据进行数据清洗；交通数据服务子系统，其用于评估城市路网交通状态；其中，所述交通数据服务子系统评估城市路网交通状态，具体包括如下步骤：通过地图匹配算法将多个车辆轨据数据映射到所述城市路网中，构建城市路网的稀疏状态矩阵；采样矩阵补全算法，对所述城市路网的稀疏状态矩阵进行补全，得到补全后的稀疏状态矩阵；基于稀疏状态矩阵，估计城市路网的速度矩阵，得到城市路网交通状态估计结果；基于城市路网交通状态估计结果，在城市路网数据上绘制拥堵概率图。9.根据权利要求8所述的一种基于物联网的智慧交通大数据分析系统，其特征在于：所述边缘计算子系统按预设周期与其所在区域内的车辆进行通信，获得区域内车辆的车联网数据；所述边缘计算子系统将所述车联网数据上传至数据中台；其中，所述边缘计算子系统和数据中台之间采样以下数据传输方法进行传输，所述数据传输方法包括：建立一个双线性映射e：C1×C2→GT，密钥生成中心KGC随机选择整数ks，ke∈作为主私钥秘密保存，计算主密钥Ppub-s＝P2和Ppub-e＝P1,将、作为签名和加密算法的系统主公钥对；KGC选取边缘计算子系统的字节hid生成用户的私钥dii＝P2；其中，G1，G2，GT，P1，P2，Ppub-s，Ppub-e，hid均为系统公开参数；边缘计算子系统发起挑战和身份认证，数据中台对消息MB通过身份认证信息产生算法进行签名产生身份认证信息σB,将σB作为应答、RB作为质询发送至边缘计算子系统；边缘计算子系统收到数据中台的σB后,通过身份认证信息验证算法对云端进行身份认证；若认证通过,边缘计算子系统通过身份认证信息产生算法对消息MA进行签名产生身份认证信息σA,并向数据中台发送σA和认证通过信息；数据中台收到σA后,利用身份认证信息验证算法检验边缘计算子系统身份的合法性；若验证通过，数据中台向边缘计算子系统返回认证通过信息并执行会话密钥协商；否则，向边缘计算子系统返回错误信息且终止认证；若认证不通过，边缘计算子系统返回错误信息且终止认证；密钥协商：数据中台通过密钥封装算法产生会话密钥K、封装密钥的密文C和问候消息密文cb，并向边缘计算子系统发送C和cb；边缘计算子系统收到C和cb后，通过密钥解封装算法得到会话密钥K′、数据中台的问候消息明文mb和边边缘计算子系统问候消息密文ca，然后向云端发送ca；当双方完成对话密钥的协商后,创建安全通信，传输数据。
说明书desc
技术领域本发明属于智慧交通的技术领域，具体涉及一种基于物联网的智慧交通大数据分析系统。背景技术近几年，物联网、大数据、云计算、移动互联网等信息技术相继出现，这些技术被不断的运用在各行各业中，也应用在了交通管理中，提出了新一代综合交通体系的概念—智慧交通。智慧交通与智能交通，都是信息技术、传感器技术、通信技术在交通运输领域进行应用的产物。与智能交通相比，智慧交通融入了物联网、大数据等高新IT技术来汇集交通信息，大量的使用了数据模型、数据挖掘等数据处理技术，为出行者提供出行信息服务，甚至能与人们进行人机互动，充分满足了现代人的个性化需求。而随着城市的发展，外卖配送等行业的迅速发展，城市道路上的非机动车也急速增多。在交通管理中，非机动车交通具有违法行为复杂多样、出行数量庞大和违法行为从众性强等特点，非机动车的交通违法行为一直是巨大的交通安全隐患和交通管控的痛点、死角，整体治理效果不理想，成为影响道路交通安全的主要因素之一。而现有智慧交通分析系统在非机动车管理中尚未有较好的解决方案。发明内容本发明的目的是要解决上述的技术问题，提供一种基于物联网的智慧交通大数据分析系统。为了解决上述问题，本发明按以下技术方案予以实现的：本发明提供了一种基于物联网的智慧交通大数据分析系统，所述智慧交通大数据分析系统包括相互连接的数据中台、多个边缘计算子系统和多个智慧道路监测子系统；多个边缘计算子系统分别对应设置在不同区域，所述区域内设置有至少一个智慧道路监测子系统；所述智慧道路监测子系统将采集数据发送至所述边缘计算子系统；各个所述多个边缘计算子系统用于对其对应的区域进行数据处理，并将数据处理结果发送至所述数据中台；所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备，所述边缘计算子系统被配置为执行如下非机动车监测步骤：获取由交通信号机发送至交通信号灯的控制指令；当控制指令为红灯指令时，获取由所述摄像设备采集的交通信号灯所在道路的图像数据；识别所述图像数据中是否存在闯红灯的非机动车；当识别到存在闯红灯的非机动车，生成非机动车违规结果；将非机动车违规结果和对应的图像数据上传至数据中台。进一步优选地，所述边缘计算子系统被配置为执行如下道路事故监测步骤：获取由所述摄像设备采集其所在道路的图像数据；检测图像数据中的第一目标对象、第二目标对象和第三目标对象，生成对应的目标检测框；其中，所述第一目标对象为人，所述第二目标对象为非机动车，所述第三目标对象为机动车；采用多目标追踪算法分别对第一目标对象、第二目标对象和第三目标对象进行追踪；采用轨迹预测模型分别预测第一目标对象、第二目标对象和第三目标对象的轨迹，得到第一预测规则、第二预测轨迹和第三预测轨迹；计算所述第一预测规则、第二预测轨迹和第三预测轨迹中的任意两个预测轨迹之间是否存在事故冲突点；当存在事故冲突点时，生成道路事故预警信息；将道路事故预警信息、图像数据、第一预测规则、第二预测轨迹和第三预测轨迹上传至数据中台。进一步优选地，所述边缘计算子系统被配置为执行如下交通信号灯调控步骤：获取由交通信号机发送至交通信号灯的控制指令；当控制指令为红灯指令时，获取由所述智慧道路监测子系统发送的交通信号机所在道路的应采集数据；对采集数据进行识别，得到各行车道对应的机动车数量和非机动车数量；根据机动车数量和非机动车数量，按预设调控规则生成调控指令；所述调控指令用于调整交通信号灯的信号灯的亮灯时间；将调控指令发送至交通信号机，通过交通信号机对交通信号灯进行控制。进一步优选地，所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备和雷达设备，所述摄像设备和雷达设备对应设置在同一道路上，用于检测该道路上的目标对象；其中，所述对采集数据进行识别，得到各行车道对应的机动车数量和非机动车数量，具体包括以下步骤：获取由所述摄像设备采集其所在道路的RGB图像数据；获取由所述雷达设备采集其所在道路的点云数据；所述RGB图像数据和点云数据在时间上相对应；对RGB图像数据进行目标对象检测，得到目标对象为非机动车的若干第一2D候选检测框，以及目标对象为机动车的若干第二2D候选检测框；对点云数据进行目标对象检测，得到目标对象为非机动车的若干第一3D候选检测框，以及目标对象为机动车的若干第二3D候选检测框；采用决策融合算法将点云数据中的若干第一3D候选检测框和若干第二3D候选检测框，与RGB图像数据中的若干第一2D候选检测框和若干第二2D候选检测框进行拼接，输出3D检测结果；获取道路的行车道信息，根据行车道和3D检测结果的位置，对各行车道上的3D检测结果进行计数，得到各行车道对应的机动车数量和非机动车数量。进一步优选地，所述智慧道路监测子系统还包括多个智慧路灯和多个测速设备，多个智慧路灯沿着城市边缘区域的道路依次间隔布设；所述智慧路灯设置有抓拍摄像设备，多个测速设备对应智慧路灯设置在道路上，所述测速设备和智慧路灯连接；其中，所述边缘计算子系统被配置为执行如下偏僻道路监测步骤：获取由当前智慧路灯所发送的第一抓拍图像数据和机动车的第一测速数据；对第一抓拍图像数据进行目标识别，生成多个对应第一目标对象、第二目标对象和第三目标对象的目标检测框；所述第一目标对象为人，所述第二目标对象为非机动车，所述第三目标对象为机动车；分别对第一抓拍图像数据的第一目标对象、第二目标对象和第三目标对象进行计数，得到经过当前智慧路灯的第一目标对象、第二目标对象和第三目标对象的第一总数；获取由下一智慧路灯所发送的第二抓拍图像数据和机动车的第二测速数据；对第二抓拍图像数据进行目标识别，生成多个对应第一目标对象、第二目标对象和第三目标对象的目标检测框；对第二抓拍图像数据的第一目标对象、第二目标对象和第三目标对象进行计数，分别得到经过当前智慧路灯的第一目标对象、第二目标对象和第三目标对象的第二总数；按预设规则，比较第一目标对象、第二目标对象和第三目标对象的第一总数和第二总数；当比较结果不一致时，生成预警信息，和/或，当第一测速数据和第二测速数据超出预设速度值时，生成车辆违规信息；将预警信息和/或车辆违规信息、以及对应的第一抓拍图像数据、第一测速数据、第二抓拍图像数据和第一测速数据上传至数据中台。进一步优选地，所述按预设规则，比较第一目标对象、第二目标对象和第三目标对象的第一总数和第二总数，具体包括以下步骤：在第一预设时间内，若第一目标对象的第一总数与第二总数不匹配，则生成第一目标对象的预警信息；在第二预设时间内，若第三目标对象的第一总数与第二总数不匹配，则生成第二目标对象的预警信息；在第三预设时间内，若第三目标对象的第一总数与第二总数不匹配，则生成第三目标对象的预警信息；其中，所述第三预设时间的时长＜第二预设时间的时长＜第一预设时间的时长。进一步优选地，所述智慧灯杆设置有一键求助设备，所述一键求助设备设置有紧急报警按钮、高清摄像头和支持双向语音对讲的通信器。进一步优选地，所述数据中台包括：交通数据接入子系统，其用于至少获取多个区域内的车联网数据，所述车联网数据包括多个车辆轨迹数据；GIS引擎子系统，其用于提供包括多个所述区域的城市路网数据；交通数据预处理子系统，其用于对车联网数据进行数据清洗；交通数据服务子系统，其用于评估城市路网交通状态；其中，所述交通数据服务子系统评估城市路网交通状态，具体包括如下步骤：通过地图匹配算法将多个车辆轨据数据映射到所述城市路网中，构建城市路网的稀疏状态矩阵；采样矩阵补全算法，对所述城市路网的稀疏状态矩阵进行补全，得到补全后的稀疏状态矩阵；基于稀疏状态矩阵，估计城市路网的速度矩阵，得到城市路网交通状态估计结果；基于城市路网交通状态估计结果，在城市路网数据上绘制拥堵概率图。进一步优选地，所述边缘计算子系统按预设周期与其所在区域内的车辆进行通信，获得区域内车辆的车联网数据；所述边缘计算子系统将所述车联网数据上传至数据中台；其中，所述边缘计算子系统和数据中台之间采样以下数据传输方法进行传输，所述数据传输方法包括：建立一个双线性映射e：G1×G2→GT，密钥生成中心KGC随机选择整数ks，ke∈作为主私钥秘密保存，计算主密钥Ppub-s＝P2和Ppub-e＝P1，将作为签名和加密算法的系统主公钥对；KGC选取边缘计算子系统的字节hid生成用户的私钥dii＝P2；其中，G1，G2，GT，P1，P2，Ppub-s，Ppub-e，hid均为系统公开参数；边缘计算子系统发起挑战和身份认证，数据中台对消息MB通过身份认证信息产生算法进行签名产生身份认证信息σB，将σB作为应答、RB作为质询发送至边缘计算子系统；边缘计算子系统收到数据中台的σB后，通过身份认证信息验证算法对云端进行身份认证；若认证通过，边缘计算子系统通过身份认证信息产生算法对消息MA进行签名产生身份认证信息σA，并向数据中台发送σA和认证通过信息；数据中台收到σA后，利用身份认证信息验证算法检验边缘计算子系统身份的合法性；若验证通过，数据中台向边缘计算子系统返回认证通过信息并执行会话密钥协商；否则，向边缘计算子系统返回错误信息且终止认证；若认证不通过，边缘计算子系统返回错误信息且终止认证；密钥协商：数据中台通过密钥封装算法产生会话密钥K、封装密钥的密文C和问候消息密文cb，并向边缘计算子系统发送C和cb；边缘计算子系统收到C和cb后，通过密钥解封装算法得到会话密钥K′、数据中台的问候消息明文mb和边缘计算子系统问候消息密文ca，然后向云端发送ca；当双方完成对话密钥的协商后，创建安全通信，传输数据。与现有技术相比，本发明的有益效果是：本发明提供了一种基于物联网的智慧交通大数据分析系统，所述智慧交通大数据分析系统包括相互连接的数据中台、多个边缘计算子系统和多个智慧道路监测子系统；多个边缘计算子系统分别对应设置在不同区域，所述区域内设置有至少一个智慧道路监测子系统；所述智慧道路监测子系统将采集数据发送至所述边缘计算子系统；各个所述多个边缘计算子系统用于对其对应的区域进行数据处理，并将数据处理结果发送至所述数据中台；所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备，所述边缘计算子系统被配置为执行如下非机动车监测步骤：获取由交通信号机发送至交通信号灯的控制指令；当控制指令为红灯指令时，获取由所述摄像设备采集的交通信号灯所在道路的图像数据；识别所述图像数据中是否存在闯红灯的非机动车；当识别到存在闯红灯的非机动车，生成非机动车违规结果；将非机动车违规结果和对应的图像数据上传至数据中台。通过本发明的智慧交通大数据分析系统，能够对非机动车违法违规行为进行有效管控。智慧交通大数据分析系统基于物联网和人工智能分析等技术，实现辅助非机动车交通违法违规的管控，不仅能够有效遏制非机动车交通违法违规行为，还能减少现场违法违规查处警力的投入，减轻警务工作压力，具有较高的推广应用价值。附图说明下面结合附图对本发明的具体实施方式作进一步详细的说明，其中：图1是本发明的一种基于物联网的智慧交通大数据分析系统的组成示意图；图2是本发明的采用决策融合算法的3D目标检测原理示意图；图3是本发明的车辆网数据的城市路网交通拥堵估计算法示意图。具体实施方式以下结合附图对本发明的优选实施例进行说明，应当理解，此处所描述的优选实施例仅用于说明和解释本发明，并不用于限定本发明。由于缺乏有效管控，非机动车违法违规行为导致的事故数量逐年增长，加强对非机动车的依法管理是预防和减少交通事故的具体措施之一。现阶段，主要通过在高发事故地段，在相应时段安排警力现场监管，受制于警力不足的现状；另一方面，传统技术中，针对交通管理广泛采用基于交通技术监控相机为主的非现场执法手段，但传统的交通摄像机针对非机动车无法进行有效管控。为此，本发明提供了一种基于物联网的智慧交通大数据分析系统，所述智慧交通大数据分析系统包括相互连接的数据中台、多个边缘计算子系统和多个智慧道路监测子系统；多个边缘计算子系统分别对应设置在不同区域，所述区域内设置有至少一个智慧道路监测子系统；所述智慧道路监测子系统将采集数据发送至所述边缘计算子系统；各个所述多个边缘计算子系统用于对其对应的区域进行数据处理，并将数据处理结果发送至所述数据中台；所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备，所述边缘计算子系统被配置为执行如下非机动车监测步骤：获取由交通信号机发送至交通信号灯的控制指令；当控制指令为红灯指令时，获取由所述摄像设备采集的交通信号灯所在道路的图像数据；识别所述图像数据中是否存在闯红灯的非机动车；当识别到存在闯红灯的非机动车，生成非机动车违规结果；将非机动车违规结果和对应的图像数据上传至数据中台。通过本发明的智慧交通大数据分析系统，能够对非机动车违法违规行为进行有效管控。智慧交通大数据分析系统基于物联网和人工智能分析等技术，实现辅助非机动车交通违法违规的管控，不仅能够有效遏制非机动车交通违法违规行为，还能减少现场违法违规查处警力的投入，减轻警务工作压力，具有较高的推广应用价值。实施例一如图1～图3所示，本发明所述的一种基于物联网的智慧交通大数据分析系统，所述智慧交通大数据分析系统包括相互连接的数据中台、多个边缘计算子系统和多个智慧道路监测子系统。在本发明中，智慧交通大数据分析系统是基于物联网、大数据、云计算、移动互联网等技术的基础上，把人、车、路、环境四者智能的连接起来；同时，综合运用云计算、大数据、计算机视觉等技术对交通信息进行全面的处理分析，从而提高了系统对道路交通状态的感知能力，实现决策和控制的智慧型交通系统。具体的，智慧交通大数据分析系统在现有智慧交通系统基础上，至少实现如下技术效果：电子地图显示。电子地图是用于实现对预测路况的展示，通过该功能及时监测到未来时刻路网中每条路段的可能拥堵情况。路网视频监控。在实际路网中，通过对每条不同路段的交通情况进行视频实时监控，可以及时观察到路网中出现的异常情况，同时也可以监测网络摄像头工作状态。信号灯智能调控。信号灯作为路口车流通行控制器，直接影响着路网交通情况，通过智能分析道路信息，智能调控交通信号机的信号灯。在本发明中，如图1所示，智慧交通大数据分析系统的平台架构由五个层级组成，分别为感知层、网络层、边缘层、数据中台层和应用层。其中，感知层：主要依赖多个智慧道路监测子系统的硬件设备实现。数据采集是信息化的基础,感知层是智慧交通建设的基石。智慧交通中的交通信息分为静态与动态2类，由于交通情况的时变性，动态交通信息采集尤为重要。例如，气象传感器、视频摄像传感器、激光传感器和雷达传感器等对气象信息、交通流信息、交通事件信息、自然灾害信息等进行全方位的信息采集与存储，以此反映环境状态、设施状态及交通状态。网络层。信息传输是信息化的前提，网络层是信息共享的纽带。网络层作为传输数据的平台，主要分为有线网络及无线网络2种，如有线的光纤通信及无线的卫星通信等。其作用是将感知层采集的数据通过现有通信网络上传给边缘层，或直接与数据中台的服务器建立连接，完成高效可靠的信息传输交互。不同通信网络负责不同对象间的数据传输，例如:5G提供大范围内的无线通信、DSRC负责车-路、车-车之间的短距离通信.RFID通信技术用来自动识别车辆标签等。网络层的可靠传输是连接智慧交通各层功能的重要保障。在本发明中，边缘层由多个边缘计算子系统组成，硬件架构示意图。边缘计算子系统的硬件架构可以包括物理机集群层、虚拟化层、数据库层、数栈平台与运行环境层。具体地：物理机集群层是最底层硬件，由多台物理机组成。具体可以由4台、5台或者其他数量的物理机组成，本申请对此不作限制。虚拟化层用于将物理机虚拟化成若干虚拟机。示例性地，虚拟化层可以是ZStack虚拟化层。数据库层作为边缘计算子系统的存储和计算引擎，用于存储和加工业务数据。示例性地，数据库层可以包括AdbPostgreSQL、DbStack。数栈平台与运行环境层用于为数据库层提供数据加工和数据任务的运行环境。示例性地，数栈平台与运行环境层可以包括FlinkStandalone、数栈、k8s。另一方面，边缘计算子系统还包括应用层，用于面向客户端，实现与用户的交互；具体用于根据客户端的业务需求从数据库层中获取对应的数据，并将数据反馈至客户端。示例性地，应用层可以包括IData.Edge和其他SaaS应用。数据中台层的功能架构按照从下到上的顺序，依次包括IaaS层、存储&amp;计算层、调度层、PaaS层以及SaaS层。可以理解，功能架构中的下层是上层的基础设施，上层实现的服务需要依赖下层来实现。在一种具体实施中，数据中台采用公有云VPC部署，即在公有云购买一个ECS集群，可以提高数据平台系统的稳定性和扩容能力，同时也有利于运维支持。例如，阿里云交通数据中台，提供复杂网络环境下异构数据源、端之间同步异步数据的融合转换，支持长链路数据的传输加速，是数据源和云上引擎间数据传输的桥梁。管理数据汇聚、治理、分析、决策全命周期，打通从数据生产到数据消费完整链路，统一消费侧的逻辑访问层，屏蔽物理存储结构、异构数据存储的差异，降低数据应用的门槛。腾讯智慧交通数据中台，腾讯智慧交通数据中台通过融合感知，充分挖掘传统机器学习和前沿深度学习的算法能力，根据实际场景提供富传感、可插拔、低时延、全天候感知解决方案。数据中台数字底座基于微观全要素融合的二三维高精路网地图服务，包含全国最大规模的互联网交通大数据，实现高时效、高可靠、智能化交通业务洞察的强大引擎。数据中台时空计算通过全栈计算体系结合时空计算引擎，具备全球领先的离线计算规模，提供高安全、高弹性、毫秒级时空计算服务。在本发明中，多个边缘计算子系统分别对应设置在不同区域，所述区域内设置有至少一个智慧道路监测子系统；所述智慧道路监测子系统将采集数据发送至所述边缘计算子系统；各个所述多个边缘计算子系统用于对其对应的区域进行数据处理，并将数据处理结果发送至所述数据中台。具体的，所述区域可以是按行政区域中的街道进行划分的。例如，广州市海珠区共有18个行政街道，按街道的行政边界范围划分出18个区域。通过区域内的多个智慧道路监测子系统，对道路的静态数据和动态数据进行采集，实现道路感知。多个边缘计算子系统对应设置在不同区域，各个边缘计算子系统用于对其对应的区域进行局部的数据处理和分析，然后将对应的数据结果发送至数据中台。数据中台用于对各个边缘计算子系统发送的数据结果以及上传的数据，进行全面分析、全面决策等。可以理解的是，边缘节点负责收集、分析与处理终端设备数据,并将处理后的数据发送到云端,由云端对海量的数据进行存储、分析以及价值挖掘。边缘层可依靠部署大量边缘节点解决数据就近处理的问题，通过将边缘服务器部署在基站、路侧单元、智能网关等处。这样一来,感知层采集的海量数据不必全部传输至数据中台，边缘计算子系统就可对其进行处理，实现局部数据计算、存储及分析，减少设备响应时间与传输到数据中台的数据流量,大幅提高对数据处理、交通事件分析等的处理效率。数据中台依靠其中部署的高性能服务器集群与搭建的计算环境,利用人工智能、机器学习、卷积神经网络等技术对上传数据进行整合,为各智慧应用的数据融合提供支撑。另一方面，在此基础上，利用大数据技术对GPS信息、视频信息、路网信息、基础设施信息等进行分析挖掘，将数据潜藏的交通信息发送给应用层，同时根据不同的交通业务需求，与边缘计算子系统协同合作，进一步提高交通数据处理系统的先进性。本发明通过边缘计算的分布式、低时延、高效率、智能化等特点可以有效解决数据中台计算存在的高延迟、网络不稳定和低带宽的问题，与智慧交通的结合将进一步实现海量数据实时处理，达到提高事件反应速度的目的。实施例二本实施例二提供了一种基于物联网的智慧交通大数据分析系统，其技术方案、架构和技术原理均与实施例一的完全相同。本实施例二提供了基于物联网的智慧交通大数据分析系统的具体应用场景及相关技术方案。在本发明中，所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备。其中，所述摄像设备可以是安装在交通信号灯的信号杆上，也可以直接通过单独的立杆安装，也可以安装在智慧道路监测子系统的智慧路灯上。本发明的技术方案一：所述边缘计算子系统被配置为执行如下非机动车监测步骤：S100：获取由交通信号机发送至交通信号灯的控制指令。在本发明中，交通信号机是现代城市交通系统的重要组成之一，主要用于城市道路交通信号的控制与管理。其中，交通信号灯是指挥交通运行的信号灯，一般由红灯、绿灯、黄灯组成。红灯表示禁止通行，绿灯表示准许通行，黄灯表示警示。交通信号机通过发送控制指令以控制交通信号灯在红灯、绿灯和黄灯进行切换。在一种具体实施中，边缘计算子系统通过网络层获取到交通信号机发送至交通信号灯的控制指令，具体的，该控制指令是指示交通信号灯切换红灯的指令。S200：当控制指令为红灯指令时，获取由所述摄像设备采集的交通信号灯所在道路的图像数据。通过摄像设备采集所在道路的图像，具体的，图像数据的背景环境，是红绿灯路口处，识别非机动车闯红灯的问题。S300：识别所述图像数据中是否存在闯红灯的非机动车。在具体实施中，可以采用深度学习算法实现对非机动车的识别。物品识别算法，是本领域技术人员很容易实施的，且属于较为常见的现有技术。S400：当识别到存在闯红灯的非机动车，生成非机动车违规结果。在具体实施中，边缘计算子系统首先使用深度学习目标检测算法来寻找图像中非机动车的位置，然后使用深度学习语义分割算法来获取图像中不同目标的具体语义信息及范围，最终来判断是否存在非机动车是否闯红灯的违规行为。在具体实施中，使用在Pascal VOC2012数据集上训练的目标检测模型得到图像中非机动车的具体位置信息，使用在城市场景数据集Cityscapes上训练的语义分割模型得到图像的像素级语义信息，待检测的图像首先经过目标检测模型得到图像中非机动车的具体位置信息，如果存在非机动车，则使用语义分割模型得到图像的像素级语义标签，在获取到非机动车附近位置的语义信息后，通过是否越过实线，以判断非机动车是否位于红绿灯路口的禁行区域内，如果是，说明非机动车违规闯红灯，输出非机动违规结果；如果不是，输出未检测到非机动车违规结果。其中，目标检测模型为Yolov5s模型，图像在输入端经过Mosiac数据增强图像增强技术及自适应锚框计算和图片缩放后，被送入主干网络中进行多尺度特征提取，提取得到的特征经过Neck模块的处理进行多尺度特征融合后，输入到预测模块中，最终得到在多个尺度上的目标检测结果。为了实现对非机动车闯红灯违规检测流程中，对存在非机动车图像的语义分割，选择使用深度学习语义分割模型对图像进行分割。由于分割的精度对于最终非机动车是否越过实线闯红灯至关重要，因此选择使用目前常用的分割效果较好的DeepLabv3plus模型。在一种具体实施中，所述边缘计算子系统还执行如下步骤：识别图像数据中，存在违规行为的非机动车车牌信息。通过采用多种式样的非机动车车牌识别算法，对非机动车的车牌信息进行识别，将多个结果比对，输出高准确率的车牌信息。具体的，包括基于模板匹配、特征提取、神经网络三种方法，先对定位出的车牌进行单个字符分割，然后提取字符特征，最后送入字符识别分类器。算法的效果依赖于字符分割好坏和人工设计出好的判别性的字符特征。非机动车的车牌尺寸比常规机动车车牌要小，多为双层牌，车牌普遍较脏，在上下班高峰期道路拥挤，相互间产生遮挡干扰，这些因素给非机动车车牌的高精度识别带来了很大困难。为此本文提出了基于深度学习的车牌识别一体化方法，从车辆检测、车牌检测到字符识别的各个环节都进行了较好设计，有效提高了非机动车车牌的识别率和鲁棒性，且系统达到实时性要求。通过本发明，基于边缘计算能力保证系统能够在单一场景下完成更多违法行为的检测、取证，助力相关部门在重要的交通管理节点进行高效管控。S500：将非机动车违规结果和对应的图像数据上传至数据中台。在一种优选实施中，将非机动车违规结果、违规非机动车的车牌信息和对应的图像数据上传至数据中台。通过本发明的智慧交通大数据分析系统，能够对非机动车违法违规行为进行有效管控。智慧交通大数据分析系统基于物联网和人工智能分析等技术，实现辅助非机动车交通违法违规的管控，不仅能够有效遏制非机动车交通违法违规行为，还能减少现场违法违规查处警力的投入，减轻警务工作压力，具有较高的推广应用价值。实施例三本实施例三提供了一种基于物联网的智慧交通大数据分析系统，其技术方案、架构和技术原理均与实施例一/二的完全相同。本实施例三提供了基于物联网的智慧交通大数据分析系统的具体应用场景及相关技术方案。在本发明中，所述边缘计算子系统被配置为执行如下道路事故监测步骤：S100：获取由所述摄像设备采集其所在道路的图像数据。在一种具体实施中，在本实施例的应用场景中，所述道路可以是设置有红绿灯的交叉路口，也可以是没有设置红绿灯的交叉路口，也可以是其他区域内的事故频发的常规路段。S200：检测图像数据中的第一目标对象、第二目标对象和第三目标对象，生成对应的目标检测框；其中，所述第一目标对象为人，所述第二目标对象为非机动车，所述第三目标对象为机动车。在具体实施中，目标检测模型为Yolov5s模型，已对第一目标对象、第二目标对象和第三目标对象进行识别。S300：采用多目标追踪算法分别对第一目标对象、第二目标对象和第三目标对象进行追踪。在一种具体实施中，在目标检测过程中，每一帧的行人、非机动车和机动车都会被检测出来，为了将同一目标的信息统一起来，需要在不同帧中赋予同一目标一个不变的ID。使用DeepSORT多目标跟踪算法，其在原有的Sort算法的目标追踪基础上增加DeepAssociationMetric和外观图像信息以解决较长时间内对被遮挡目标的跟踪，是一个基于深度外观特征模型和运动信息模型的跟踪框架。S400：采用轨迹预测模型分别预测第一目标对象、第二目标对象和第三目标对象的轨迹，得到第一预测规则、第二预测轨迹和第三预测轨迹。其中，轨迹预测模型采用卡尔曼滤波器，也可以采用扩展卡尔曼滤波预测器。在一种具体实施中，基于步骤S300，当检测到目标对象后，通过卡尔曼滤波器预测物体的轨迹，再使用匈牙利算法将预测帧的轨迹数据与当前帧的轨迹detections组合匹配，然后进行卡尔曼滤波器的更新。具体的，DeepSORT算法将YOLO算法得到的目标检测框与之前预测得到的目标跟踪框的交互比作为组合传入匈牙利算法中，利用线性分配来关联各帧的ID，还可以在帧间匹配计算的过程中加入目标的外观和位置信息，以实现目标物体被遮挡但之后又出现情况下的正确匹配，减少了目标ID的频繁跳动，完成持续跟踪的目的。S500：计算所述第一预测规则、第二预测轨迹和第三预测轨迹中的任意两个预测轨迹之间是否存在事故冲突点。在具体实施中，以无交通信号的道路交叉口为例，行人与非机动车、行人与机动车、非机动车与机动车之间等的动态交互过程中，可能会产生碰撞的问题。通过预测轨迹之间的是否存在事故冲突点。具体的，可以将目标对象的预测轨迹，匹配到图像数据的背景中，然后判断预测轨迹之间是否存在重合相交点，以判断是否存在事故冲突点。S600：当存在事故冲突点时，生成道路事故预警信息。在一种具体实施中，所述道路事故预警信息包括事故冲突等级、道路的位置信息、摄像设备的定位信息、以及最近警力信息。具体的，事故冲突等级可以根据目标对象之间冲突关系的进行标定的，如行人与非机动车为一级事故冲突等级；行人与非机动车、非机动车与非机动车为二级事故冲突等级；人与机动车、非机动车与机动车、机动车与机动车为三级事故冲突等级。S700：将道路事故预警信息、图像数据、第一预测规则、第二预测轨迹和第三预测轨迹上传至数据中台。而数据中台在收到道路事故预警信息、图像数据、第一预测规则、第二预测轨迹和第三预测轨迹上传至数据中台后，做进一步的数据分析，以判断道路事故预警信息是否准确。若是，则调取对应的摄像设备的实时图像数据，并通过弹窗的方式在应用层向交通管理人员进行展示，提示交通管理人员密切留意预测事故发生地。实施例四本实施例四提供了一种基于物联网的智慧交通大数据分析系统，其技术方案、架构和技术原理均与实施例一/二/三的完全相同。本实施例四提供了基于物联网的智慧交通大数据分析系统的具体应用场景及相关技术方案。在本发明中，所述边缘计算子系统被配置为执行如下交通信号灯调控步骤：S100：获取由交通信号机发送至交通信号灯的控制指令。S200：当控制指令为红灯指令时，获取由所述智慧道路监测子系统发送的交通信号机所在道路的应采集数据。S300：对采集数据进行识别，得到各行车道对应的机动车数量和非机动车数量。在一种具体实施中，所述智慧道路监测子系统包括设置于对应区域道路上的摄像设备和雷达设备，所述摄像设备和雷达设备对应设置在同一道路上，用于检测该道路上的目标对象。具体的，所述摄像设备和雷达设备均对应着道路进行数据的采集。其中，所述对采集数据进行识别，得到各行车道对应的机动车数量和非机动车数量，具体包括以下步骤：S310：获取由所述摄像设备采集其所在道路的RGB图像数据。在一种具体实施中，视觉图像通常由R、G、B三通道像素值组成，每一个像素点位置包含Red、Green、Blue三个颜色通道的像素值。基于图像的处理，本质是对R、G、B三通道像素值的处理。S320：获取由所述雷达设备采集其所在道路的点云数据；所述RGB图像数据和点云数据在时间上相对应。在本发明中，利用激光雷达传感器采集到的点云数据，由大量的空间三维坐标点组成，与相机获取的图像数据不同，三维点云数据能够更加准确地描述物体的表面几何特征和空间位置信息。随着多线激光雷达制造技术的不断提升，激光雷达获取的点云数据精度也越来越高。经过申请人研究发现，使用点云数据进行3D目标检测任务具有独特的优势。点云本质上是空间3D坐标系中的一组点，通常由x、y、z坐标和反射强度定义。点云能够提供精确的空间深度测量信息，同时可以缓解相机图像常见的遮挡问题。S330：对RGB图像数据进行目标对象检测，得到目标对象为非机动车的若干第一2D候选检测框，以及目标对象为机动车的若干第二2D候选检测框。在具体实施中，采用基于图像的2D目标检测算法，输出第一2D候选检测框和第二2D候选检测框，采用现有的目标检测算法即可实现的，目标检测模型可以采用Yolov5s模型。S340：对点云数据进行目标对象检测，得到目标对象为非机动车的若干第一3D候选检测框，以及目标对象为机动车的若干第二3D候选检测框。在具体实施中，采用基于点云数据的3D目标检测算法即可实现，是自动驾驶技术中普遍使用的现有技术。其中，这类基于点云数据的3D目标检测算法普遍使用预编码框机制，在进行目标检测时，首先会生成区域候选框，在生成区域候选框之前，首先对输入数据进行特征分析以及特征提取工作，然后根据不同区域数据特征的特点，被赋予不同的置信度，大大降低了最终3D物体对象检测框的检测难度，并且在接下来的处理步骤中，单阶段目标检测利用区域分类得分，根据区域置信度得分，来确定高质量的目标候选框。降低重叠边界框的生成数量，对提升模型性能效果明显。S350：采用决策融合算法将点云数据中的若干第一3D候选检测框和若干第二3D候选检测框，与RGB图像数据中的若干第一2D候选检测框和若干第二2D候选检测框进行拼接，输出3D检测结果。在本发明中，如图2所示，采用决策级融合算法，也被称作目标级融合算法，是一种在较高语义层次基础上的融合体系结构，其主要是在各类传感器采集的数据并经过3D目标检测识别判定后，再将其识别后的结果作为输入传到融合算法的网络中进行对齐筛选、拼接、判定等一系列处理，从而输入3D目标检测的最终结果。最终目的，将所有单独的2D和3D检测候框从各自的检测空间，转换为一组联合检测候选框。在一种具体实施中，因激光设备与相机设备在数据采集范围与采集频率上也存在明显差异，因此在进行融合之前，需要先对二者的数据进行时空匹配处理，保证两种传感器数据能够实现精确的时空匹配，为数据融合提供必要的前提条件。在理想状态下，点云数据与图像数据的采集与传输是在时间轴上可以是完全同步的。然而在真实场景应用的过程中，这种理想状态难以保证。因两个传感器获取的数据存在时间差异，在一种典型的误差场景中，不同传感器在工作的过程中，一般拥有不同的采样频率，如常见的激光雷达传感器采样周期为0.1s，其每秒钟对周围环境扫描10圈，对应的输出10帧点云数据。摄像设备的工作频率可达15帧每秒。虽然可以通过调节相应的参数使得摄像设备采用与激光雷达同样的频率，但是受电压及电流脉冲相位的影响，无法通过调节采样频率，使得两种数据在时间上完全匹配。为此，本发明通过如下技术方案实现：S351：根据摄像设备的采样频率，对RGB图像数据进行时间戳写入；在一种具体实施中，假设摄像设备的采样频率为10帧/1s，在某个时间段内共采集了15张图像数据，然后将时间段平均分成10个相同的时间段，生成每个图像数据的时间戳。S352：根据雷达设备的采样频率，对点云数据进行时间戳写入。在一种具体实施中，假设雷达设备的采样频率为10帧/1s，在某个时间段内共采集了15张图像数据，然后将时间段平均分成10个相同的时间段，生成每个图像数据的时间戳。S353：根据RGB图像数据的时间戳和点云数据的时间戳，将时间戳相对应的RGB图像数据和点云数据输出。在具体实施中，时间戳相对应可以是时间戳完全相同，或者，在同一采样时间段内，二者时间戳最为接近的若干组RGB图像数据和点云数据。S354：将点云数据中的三维点，映射到RGB图像数据的二维点上。在一种具体实施中，雷达设备采集的数据是基于极坐标系进行检测，由三维点云阵组成，用表示，而摄像设备采集的是基于直角坐标系RGB图像数据，数据由像素点表示。由于摄像设备与雷达设备的三维坐标方向是不同的，联合配准的目标是建立一个转移矩阵M，经M将三维点映射到二维点上。具体的，转移矩阵M的公式如下所示：其中，fu，fv为相机传感器在水平方向与垂直方向的焦距长度；u0，v0为图像中心点的坐标；R为旋转矩阵；T为平移矢量。S354：将点云数据中的若干第一3D候选检测框和若干第二3D候选检测框，与RGB图像数据中的若干第一2D候选检测框和若干第二2D候选检测框进行拼接，输出3D检测结果。在步骤S353的基础上，才能将2D与3D候选框进行匹配融合。假设RGB图像数据中拥有k个第一2D候选检测框，点云数据中拥有n个第一3D候选检测框，构建一个k×n×4张量T。对应每个元素Ti，j，有4个通道，表示如下：其中，IoUi，j是第i个第一2D候选检测框和第j个第一3D候选检测框投影之间的IoU值。和/＞分别是第i个第一2D候选检测框和第j个第一3D候选检测框的检测置信度得分。dj表示第j个第一3D候选检测框的边界框与激光雷达传感器之间在xy平面上的标准化距离。通过上述方法，将2D候选检测框与对应的3D候选检测框进行匹配融合。S360：获取道路的行车道信息，根据行车道和3D检测结果的位置，对各行车道上的3D检测结果进行计数，得到各行车道对应的机动车数量和非机动车数量。传统方法中，基于RGB图像的3D目标检测领域，相比于前人的工作均取得一定幅度的进步，提供了多种创新性的解决思路。然而这些方法都需要复杂的预处理过程，而且由于图像数据无法直接获取空间信息，对于空间位置信息均是通过网络估计或者双目相机几何视差的方法进行获取，误差往往比较高，难以准确识别出当前的车流量，更难以应用于交通信号灯的调控中。为此，本发明通过点云与图像数据融合技术，实现3D目标检测。将图像数据特有的语义信息和纹理信息与点云数据特有的空间信息融合，进行3D目标检测任务，能够使得检测算法在准确检测目标物体空间位置的同时捕获到更丰富的道路场景特征信息，为交通信号灯的控制提供更为可靠的数据支持，以更合理的进行调控。S400：根据机动车数量和非机动车数量，按预设调控规则生成调控指令；所述调控指令用于调整交通信号灯的信号灯的亮灯时间。在具体实施中，交通信号机按着系统预设的默认亮灯规则，对交通信号灯进行控制以进行亮灯操作，以对道路交通进行管控。而调控指令是优先级高于默认亮灯规则的调控规则，当交通信号机接收到调控指令时，则按着。当车道的相应数量超出预设值时，可以相应的增加对应车道的信号灯的亮灯时间。例如，当直行车道的车辆数量超出预设值时，则相应增加制成对应车道的信号灯的亮灯时间S500：将调控指令发送至交通信号机，通过交通信号机对交通信号灯进行控制。在一种具体实施中，调控指令具有执行有效次数或时效性，时效性是指交通信号机在某个时间段内，均采用调控指令的优选规则。另一方面，有效次数是指交通信号机在有效次数内连续执行调控指令。交通信号机会预先识别调控指令的有效次数或时效性。在一种具体实施中，调控指令的配置中，包括在不同颜色灯切换之前都设置了3s的黄灯作为缓冲时间。且为保证车辆与行人的安全通行，避免因为时间长而闯红灯，设置交通灯时间最长不超过120s。实施例五本实施例五提供了一种基于物联网的智慧交通大数据分析系统，其技术方案、架构和技术原理均与实施例一/二/三/四的完全相同。本实施例五提供了基于物联网的智慧交通大数据分析系统的具体应用场景及相关技术方案。在本实施例中，所述智慧道路监测子系统还包括多个智慧路灯和多个测速设备，多个智慧路灯沿着城市边缘区域的道路依次间隔布设；所述智慧路灯设置有抓拍摄像设备，多个测速设备对应智慧路灯设置在道路上，所述测速设备和智慧路灯连接。需要说明的是，针对城市郊区的一些偏僻道路，如行政区域之间、乡镇之间上的偏僻路段，又或者是靠山而建的道路等，这些道路通常没有红绿灯，也没有监测设备，这些道路当发生交通事故时，往往需要当事人自行求助或依赖路过的人/车进行救助，若发生重大事故时，当事人可能已经昏迷等，且道路偏僻，车辆路过是概率事件，这很不利于对事故进行应急救援。为此，可以在上述道路，或者事故频发道路进行本实施例五的偏僻道路监测步骤。其中，所述边缘计算子系统被配置为执行如下偏僻道路监测步骤：S100：获取由当前智慧路灯所发送的第一抓拍图像数据和机动车的第一测速数据。在一种具体实施中，本发明采用NDC350拍照摄像一体机进行抓拍，得到第一抓拍图像数据。车辆检测采用地面感应线圈检测器，地面感应线圈检测器提供NDC350触动信号，触动信号用来启动NDC350的抓拍动作。每条车道埋设双线圈用来测速和分辨车型。通讯协议采用TFTP和FTP，前端信息透过网络光纤收/发器和光纤线路以大于10M的速率与智慧路灯通讯。现场的供电电源就近引取。具体的，地面感应线圈检测器可以参考高速公路使用的地面感应线圈检测器。S200：对第一抓拍图像数据进行目标识别，生成多个对应第一目标对象、第二目标对象和第三目标对象的目标检测框；所述第一目标对象为人，所述第二目标对象为非机动车，所述第三目标对象为机动车。在一种具体实施中，目标检测模型为Yolov5s模型，以输出人、非机动车、机动车的目标检测框。S300：分别对第一抓拍图像数据的第一目标对象、第二目标对象和第三目标对象进行计数，得到经过当前智慧路灯的第一目标对象、第二目标对象和第三目标对象的第一总数。在目标检测过程中，每一帧的行人、非机动车和机动车都会被检测出来，为了将同一目标的信息统一起来，需要在不同帧中赋予同一目标一个不变的ID。然后通过计算ID数量，能得到经过当前智慧路灯的第一目标对象、第二目标对象和第三目标对象的第一总数。S400：获取由下一智慧路灯所发送的第二抓拍图像数据和机动车的第二测速数据。S500：对第二抓拍图像数据进行目标识别，生成多个对应第一目标对象、第二目标对象和第三目标对象的目标检测框。S600：对第二抓拍图像数据的第一目标对象、第二目标对象和第三目标对象进行计数，分别得到经过当前智慧路灯的第一目标对象、第二目标对象和第三目标对象的第二总数。在本实施例中，步骤S400-S600中，具体的技术参见本实施例步骤S100-S300中的记载。S700：按预设规则，比较第一目标对象、第二目标对象和第三目标对象的第一总数和第二总数。在具体实施中，所述按预设规则，比较第一目标对象、第二目标对象和第三目标对象的第一总数和第二总数，具体包括以下步骤：S710：在第一预设时间内，若第一目标对象的第一总数与第二总数不匹配，则生成第一目标对象的预警信息。S720：在第二预设时间内，若第三目标对象的第一总数与第二总数不匹配，则生成第二目标对象的预警信息。S730：在第三预设时间内，若第三目标对象的第一总数与第二总数不匹配，则生成第三目标对象的预警信息。其中，所述第三预设时间的时长＜第二预设时间的时长＜第一预设时间的时长。在一种具体实施中，第一预设时间是基于人的步行平均速度和前一智慧路灯与下一智慧路灯之间的距离，可以确定的。第二预设时间是基于非机动车的行驶速度和前一智慧路灯与下一智慧路灯之间的距离，可以确定的。第三预设时间是基于机动车的行驶速度、道路限速信息和前一智慧路灯与下一智慧路灯之间的距离，可以确定的。在一种具体实施中，未考虑到其他因素，可以在第一预设时间/第二预设时间/第三预设时间中相应的增加容错时间，例如1～2分钟等。在现实场景中，针对偏僻的道路，行人/非机动车/机动车，在正常情况下，是连续通过的，一般不会在道路中停留；为此，通过在相邻智慧灯杆之间，对行人/非机动车/机动车的通过数量是否匹配来判断是否发生异常。另一方面，这些道路的行人/非机动车/机动车是相对较少的，能够避免大流量行人/非机动车/机动车使上述方案的无效检测，通过上述简单的方案即可实现。S800：当比较结果不一致时，生成预警信息，和/或，当第一测速数据和第二测速数据超出预设速度值时，生成车辆违规信息。S900：将预警信息和/或车辆违规信息、以及对应的道路信息、第一抓拍图像数据、第一测速数据、第二抓拍图像数据和第一测速数据上传至数据中台。在具体实施中，因前期的在目标检测过程中，每一帧的行人、非机动车和机动车都会被检测出来，且在不同帧中赋予同一目标一个不变的ID。为此，数据中台可以通过比对前后抓拍图像数据的ID，能得到出现事故的具体的第一目标对象、第二目标对象和第三目标对象的外形特征，并且可以进一步的识别非机动车、机动车的信息。在一种实施中，所述数据中台接收到预警信息、以及对应的道路信息、第一抓拍图像数据、第一测速数据、第二抓拍图像数据和第一测速数据后。实时获取全路段的智慧灯杆所拍摄的抓拍图像数据，在预设时间内，根据所述目标对象的外形特征对所述抓拍图像数据进行识别，以对目标对象进行再次识别。另一方面，当在预设时间内，数据中台没有识别出所述目标对象，则将目标对象的外形特征和预警信息通过应用层向交通管理人员进行展示，以供交通管理人员调取对应道路的实时监控，对该目标对象进行查看，并可以讨论相应的应对措施。实施例六本实施例五提供了一种基于物联网的智慧交通大数据分析系统，其技术方案、架构和技术原理均与实施例一/二/三/四/五的完全相同。本实施例六提供了基于物联网的智慧交通大数据分析系统的具体应用场景及相关技术方案。在本实施例中，本发明数据中台包括交通数据接入模块、GIS引擎子系统、交通数据预处理子系统和交通数据服务子系统。其中，所述交通数据接入模块用于对接城市交通管理部门业务系统、与交通相关部门的对应业务系统、电信运营商数据、移动互联网数据、车联网数据等，并进行交通领域多源异构数据的接入。在进行交通数据存储时，按照使用频度、重要性、交通数据类型，在各数据中心、云存储数据中心分级存储；并对低频使用交通数据进行冷存储，以及高频使用交通数据进行热存储。在一种具体实施中，移动互联网数据信息资源：包括互联网出行平台数据，譬如滴滴、Uber的快车/专车/顺风车的行车轨迹、用户出行线路信息；地图平台数据，譬如百度、高德的地图数据、实时的交通路况信息、实时拥堵报警等。在一种具体实施中，车联网数据信息资源：采集并整合包括RFID数据库、车联网监控系统数据库、车辆运行及交互数据库，道路监测数据库、车载终端数据等。在本发明中，所述GIS引擎子系统，能够提供多源数据接入与处理能力，场景可视化能力以及位置服务能力。在场景可视化方面，基于三维GIS渲染引擎为交警行业提供精细化、低成本、可复用的三维场景可视化方案。可结合高精度地图，实现城市路网长度、宽度、车道数、标志标牌标线、护栏、公交港湾等静态数据和动态数据的可视化展示，应用于城市交通精细化管理、事故违法分析、拥堵分析、大型活动指挥调度等场景。在位置服务方面，通过地点检索、POI搜索、路径规划、地理/逆地理编码、地图匹配等位置服务，为交警地址库服务、警力资源可视化、全流程可视化调度等业务提供基础技术支撑，实现警情快速定位，提高接处警效率，提升接处警工作的科学性和规范性。在本发明中，交通数据处理模块用于在交通数据接入模块汇集的交通领域多源异构数据之后，城市智慧交通管理大数据平台的数据处理模块将按照分布式ETL模式，进行交通数据抽取、数据清洗、数据关联、数据比对、数据标识及规范化的处理，建立标准化的数据处理模式，支撑智慧交通管理的各类应用。在一种具体实施中，交通数据处理模块实现如下功能：交通数据抽取：对原始的交通领域多源异构数据进行规范化处理，将所有的结构化交通数据和非结构化交通数据抽取转化为结构化交通数据。结构化交通数据：交通数据抽取功能实现结构化交通数据的全量抽取和增量抽取。全量抽取类将完整抽取交通数据源中的交通数据表、交通数据视图。增量抽取将提取新增、修改、删除的交通数据。非结构交通数据：主要是从交通监控视频、交通图片、遥感等多媒体文件、文本内容等非结构化数据中提取车辆、车主、轨迹、位置、状态等信息，形成结构化交通数据，一般采取全量抽取。交通数据清洗：过滤不合规的交通数据，删除重复的交通数据，纠正错误数据，完成格式转换，并进行清洗前后的交通数据一致性检查，保证交通数据结果集的质量，将“脏数据”清洗掉。针对缺失值，采用删除法、替换法、插补法等方式进行清洗。针对格式内容清洗，可采用逻辑错误清洗、箱型图分析、基于聚类的离群点等方式去除不合理值，并修正矛盾内容。交通数据关联：数据关联是将来源于不同的业务系统、不同的数据通过关键字段关联在一起。关联的过程包括关联键值的生成、组内关联、组间关联、并行关联等处理逻辑。城市智慧交通管理大数据平台的交通数据关联包括离线数据的批处理和流式数据的实时处理。交通数据对比：实现结构化数据比对，关键词比对，图像语音文本相似度比对，二进制比对以及生物特征比对等。通过交通数据对比功能，可以协助交通管理及政府相关部门快速定位出交通信息来源，提高对比效率和准确率。交通数据标识：城市智慧交通管理大数据平台将通过直观事实、统计加工、模型挖掘、组合定义等方法进行交通数据标识。在交通数据标识模块基础上，对交通拥堵及交通事故等按照类型和性质进行分类统计，可以帮助交通管理部门进行舆情分析、高拥堵区域车辆监控、交通事故车辆及人员追踪分析等。在进一步的，还包括交通数据管理模块，所述交通数据管理模块用于梳理整合元数据、主数据、数据模型、数据仓库。通过交通数据资源目录构建、交通数据分级分类、交通数据血缘关系管理、交通数据质量管控、交通数据运维，构建质量保障体系，使用规则校验和源头管控等多种数据检查模式保障数据质量。在具体实施中，当数据中台用于评估评估城市路网交通状态时，所述交通数据接入子系统用于至少获取多个区域内的车联网数据，所述车联网数据包括多个车辆轨迹数据。所述GIS引擎子系统用于提供包括多个所述区域的城市路网数据。所述交通数据预处理子系统用于对车联网数据进行数据清洗。所述交通数据服务子系统用于评估城市路网交通状态。其中，如图3所示，所述交通数据服务子系统评估城市路网交通状态，具体包括如下步骤：S100：通过地图匹配算法将多个车辆轨据数据映射到所述城市路网中，构建城市路网的稀疏状态矩阵。在一种具体实施中，车联网数据中包括了车辆轨据数据，这些车辆轨据数据包括轨迹点，是由车载GPS轨迹记录仪采集的一系列户外活动的位置点，每个点至少包括日期、时间、经度、纬度、海拔信息、速度等信息。在本发明中，基于地图匹配算法将高频的车辆轨迹数据映射到城市路网的路段上，在具体实施中，采用基于网格的地图匹配算法，其能够在城市路网中密集道路布局和交叉口实现高效的车辆轨迹映射，进而构造稀疏的时空速度矩阵。其中，网格的地图匹配算法包括四个步骤：1、初始化：计算每条GPS记录的瞬时速度和航向角，删除无效记录，然后计算每个路段的方向。在具体实施中，由表示一辆车的GPS记录序列；瞬时速度通过GPS序列中相邻轨迹点的位置差分计算得到，轨迹速度的航向角也可以通过GPS数据获得。地图数据给出了每条道路的基本位置信息，即每条道路的位置序列包含道路每个节点的纬度/经度。2、轨迹到网格的映射：根据每个网格的空间范围，使用纬度和经度信息为所有GPS记录构建网格索引。为了简化地图匹配过程，GPS记录被分配到各个网格，网格索引表示为row*100+col，其中rowi和col是网格所在的行和列。3、候选路段确定：将网格映射到路段，根据道路的位置序列中路段的位置信息，记录每个路段穿过的网格索引。4、匹配候选路段：采用应用K-means聚类算法匹配候选路段。应用K-means算法对GPS轨迹进行聚类，该算法还可以解决GPS偏移问题。K-means算法的输入包括经纬度、K值和初始化聚类中心，K值由网格中候选路段的数量确定，初始化聚类中心将从候选路段上的点中随机选择，该算法计算欧几里德距离，输出结果是GPS记录与路段的匹配结果。5、匹配结果生成：根据算法的输出生成每条轨迹记录与路段的匹配结果，即为每条轨迹记录新增路段ID字段。S200：采样矩阵补全算法，对所述城市路网的稀疏状态矩阵进行补全，得到补全后的稀疏状态矩阵。在一种具体实施中，采用矩阵补全方法对稀疏速度矩阵进行补全，该算法采用低秩矩阵补全技术并考虑城市路网交通状态时空相关性，实现缺失数据恢复和路网交通状态估计。在具体实施中，基于Schattenp-范数最小化的矩阵补全方法补全稀疏状态矩阵。由于城市路网的交通状态具有时空相关性，因此补全稀疏时空速度矩阵属于低秩矩阵恢复问题。Schatten范数是一种特殊的范数，定义在矩阵奇异值上，可用于解决各类低秩问题，例如低秩矩阵/张量恢复。基于Schattenp-范数最小化矩阵补全方法来恢复大规模城市路网的交通速度矩阵，并采用快速收敛的算法进行求解。另一方面，将网格地图匹配算法应用于网约车轨迹数据，可以得到路段和轨迹点之间的映射关系，由于网约车轨迹数据不能覆盖全路网和全时刻，进而构造存在数据缺失的原始稀疏速度矩阵。本节采用路段上轨迹点的速度调和平均值估计该路段上车辆运行速度，速度调和平均值优于算术平均值，因为它消除了速度过高异常值的影响，从而更准确地估计路段速度。经申请人研究发现，交通数据通常表现出很强的时空相关性，例如时间上相邻的矩阵元素具有相似的值，空间相关性是指路段和路段之间的相似性。为此，本发明采用Schatten p-范数最小化算法实现缺失数据补全。S300：基于稀疏状态矩阵，估计城市路网的速度矩阵，得到城市路网交通状态估计结果。通过上述步骤，通过稀疏状态矩阵，得知在不同时段的网格平均速度，通过平均速度可以确定拥堵区域，拥堵位置。S400：基于城市路网交通状态估计结果，在城市路网数据上绘制拥堵概率图。在本发明中，利用GIS引擎子系统结合城市路网交通状态估计结果，在城市路网数据上绘制拥堵概率图。在一种优选实施中，所述边缘计算子系统按预设周期与其所在区域内的车辆进行通信，获得区域内车辆的车联网数据；所述边缘计算子系统将所述车联网数据上传至数据中台。其中，所述边缘计算子系统和数据中台之间采样以下数据传输方法进行传输，所述数据传输方法包括：S1000：建立一个双线性映射e：G1×G2→GT，密钥生成中心KGC随机选择整数ks，ke∈作为主私钥秘密保存，计算主密钥Ppub-s＝P2和Ppub-e＝P1，将、作为签名和加密算法的系统主公钥对；KGC选取边缘计算子系统的字节hid生成用户的私钥dii＝P2；其中，G1，G2，GT，P1，P2，Ppub-s，Ppub-e，hid均为系统公开参数；S2000：边缘计算子系统发起挑战和身份认证，数据中台对消息MB通过身份认证信息产生算法进行签名产生身份认证信息σB，将σB作为应答、RB作为质询发送至边缘计算子系统；S3000：边缘计算子系统收到数据中台的σB后，通过身份认证信息验证算法对云端进行身份认证；S3100：若认证通过，边缘计算子系统通过身份认证信息产生算法对消息MA进行签名产生身份认证信息σA,并向数据中台发送σA和认证通过信息；数据中台收到σA后,利用身份认证信息验证算法检验边缘计算子系统身份的合法性；若验证通过，数据中台向边缘计算子系统返回认证通过信息并执行会话密钥协商；否则，向边缘计算子系统返回错误信息且终止认证；S3200：若认证不通过，边缘计算子系统返回错误信息且终止认证；S4000：密钥协商：数据中台通过密钥封装算法产生会话密钥K、封装密钥的密文C和问候消息密文cb，并向边缘计算子系统发送C和cb；边缘计算子系统收到C和cb后，通过密钥解封装算法得到会话密钥K′、数据中台的问候消息明文mb和边边缘计算子系统问候消息密文ca，然后向云端发送ca；S5000：当双方完成对话密钥的协商后,创建安全通信，传输数据。在网络数据传输安全方面,边缘节点向云端传输数据的过程可能会面临数据泄露、数据篡改、入侵者恶意攻击等风险。为保障本智慧交通大数据分析系统的安全性，采用上述的传输协议，不仅可以保证完整性、消息来源的真实性，还可以防止恶意验证者发起的选择文本攻击，并具有已知密钥安全的特性。本实施例所述一种基于物联网的智慧交通大数据分析系统的其它结构参见现有技术。以上所述，仅是本发明的较佳实施例而已，并非对本发明作任何形式上的限制，故凡是未脱离本发明技术方案内容，依据本发明的技术实质对以上实施例所作的任何修改、等同变化与修饰,均仍属于本发明技术方案的范围内。
