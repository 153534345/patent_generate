标题title
地震数据的反演方法、装置及电子设备
摘要abst
本申请提供了一种地震数据的反演方法、装置及电子设备，涉及地质探测技术领域，方法包括：获取地震数据；该地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；将地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；多频反射系数包括：多种目标频率下分别对应的反射系数；将多频反射系数输入至第二神经网络进行弹性参数反演，得到地震数据对应的弹性参数。本申请能够基于深度学习的两阶段神经网络预测算法，提高薄夹层的分辨率，准确反演弹性参数。
权利要求书clms
1.一种地震数据的反演方法，其特征在于，所述方法包括：获取地震数据；所述地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；将所述地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；所述多频反射系数包括：多种所述目标频率下分别对应的反射系数；将所述多频反射系数输入至第二神经网络进行弹性参数反演，得到所述地震数据对应的弹性参数。2.根据权利要求1所述的方法，其特征在于，所述第一神经网络包括四个全连接层；激活函数为tanh函数；所述第一神经网络的损失函数定义如下：其中，Llearn为目标函数，ts表示地震数据的长度，tr表示单个频率下的反射系数序列，地震反射率的长度,n是频率的数量,λ为正则化参数；mpre表示预训练的反射系数；mtrue表示真实的反射系数；D是具有维度ts×的小波卷积矩阵库,由不同频率的雷克小波组成。3.根据权利要求1所述的方法，其特征在于，所述第一神经网络对应的训练数据集的获取过程如下：获取预设薄层厚度范围内的多个随机薄夹层模型；所述薄夹层模型的参数包括：薄夹层的P波速度、S波速度和密度；根据Brekhovskikh方程，计算多个随机薄夹层模型在不同频率下的反射系数；基于多个随机薄夹层模型分别对应的不同频率下的反射系数合成地震数据，得到所述第一神经网络对应的训练数据集。4.根据权利要求1所述的方法，其特征在于，所述第二神经网络包括：多通道卷积神经网络；所述多通道卷积神经网络包括建立有多频反射系数与弹性参数之间的非线性映射关系的模型。5.根据权利要求4所述的方法，其特征在于，所述第二神经网络包括三个通道；每个所述通道包括三个卷积层、三个最大池化层和压平层。6.根据权利要求5所述的方法，其特征在于，所述第二神经网络还包括与每个压平层分别连接的第一完全连接层，以及与三个第一完全连接层均连接的第二完全连接层；所述第一完全连接层对应的激活函数为Softmax函数；所述第二完全连接层对应的激活函数为ReLU函数。7.根据权利要求4所述的方法，其特征在于，所述多通道卷积神经网络的训练数据集的获取过程如下：生成多个随机的薄夹层模型；针对每个薄夹层模型，利用Brekhovskikh方程计算所述薄夹层模型对应的多频反射系数，利用底部界面的反射系数填充薄夹层模型内部，得到所述薄夹层模型对应的多频反射系数与弹性参数之间的非线性映射关系；基于多个薄夹层模型分别对应的非线性映射关系，得到所述多通道卷积神经网络的训练数据集。8.一种地震数据的反演装置，其特征在于，所述装置包括：数据获取模块，用于获取地震数据；所述地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；反演谱模块，用于将所述地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；所述多频反射系数包括：多种所述目标频率下分别对应的反射系数；参数反演模块，用于将所述多频反射系数输入至第二神经网络进行弹性参数反演，得到所述地震数据对应的弹性参数。9.一种电子设备，其特征在于，包括处理器和存储器，所述存储器存储有能够被所述处理器执行的计算机可执行指令，所述处理器执行所述计算机可执行指令以实现权利要求1至7任一项所述的方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机可执行指令，所述计算机可执行指令在被处理器调用和执行时，计算机可执行指令促使处理器实现权利要求1至7任一项所述的方法。
说明书desc
技术领域本申请涉及地质探测技术领域，尤其是涉及一种地震数据的反演方法、装置及电子设备。背景技术传统的基于叠前数据振幅属性的AVO反演方法，通过幅值随偏移的变化计算地下介质的弹性参数。但是，当地下介质是薄夹层时，会发生调谐效应，这是反射界面处幅值的混叠现象。调谐效应使得传统的基于幅值属性的AVO反演方法无法解决薄层间识别的问题。此外，相同的反射界面在不同频率下会具有不同的AVO特性，而传统的AVO反演方法中不包括频率因子。发明内容本申请的目的在于提供一种地震数据的反演方法、装置及电子设备，基于深度学习的两阶段神经网络预测算法，提高薄夹层的分辨率，准确反演弹性参数。第一方面，本申请实施例提供一种地震数据的反演方法，方法包括：获取地震数据；地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；将地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；多频反射系数包括：多种目标频率下分别对应的反射系数；将多频反射系数输入至第二神经网络进行弹性参数反演，得到地震数据对应的弹性参数。在本申请较佳的实施方式中，上述第一神经网络包括四个全连接层；激活函数为tanh函数；第一神经网络的损失函数定义如下：其中，Llearn为目标函数，ts表示地震数据的长度，tr表示单个频率下的反射系数序列，地震反射率的长度,n是频率的数量,λ为正则化参数；mpre表示预训练的反射系数；mtrue表示真实的反射系数；D是具有维度ts×的小波卷积矩阵库,由不同频率的雷克小波组成。在本申请较佳的实施方式中，上述第一神经网络对应的训练数据集的获取过程如下：获取预设薄层厚度范围内的多个随机薄夹层模型；薄夹层模型的参数包括：薄夹层的P波速度、S波速度和密度；根据Brekhovskikh方程，计算多个随机薄夹层模型在不同频率下的反射系数；基于多个随机薄夹层模型分别对应的不同频率下的反射系数合成地震数据，得到第一神经网络对应的训练数据集。在本申请较佳的实施方式中，上述第二神经网络包括：多通道卷积神经网络；多通道卷积神经网络包括建立有多频反射系数与弹性参数之间的非线性映射关系的模型。在本申请较佳的实施方式中，上述第二神经网络包括三个通道；每个通道包括三个卷积层、三个最大池化层和压平层。在本申请较佳的实施方式中，上述第二神经网络还包括与每个压平层分别连接的第一完全连接层，以及与三个第一完全连接层均连接的第二完全连接层；第一完全连接层对应的激活函数为Softmax函数；第二完全连接层对应的激活函数为ReLU函数。在本申请较佳的实施方式中，上述多通道卷积神经网络的训练数据集的获取过程如下：生成多个随机的薄夹层模型；针对每个薄夹层模型，利用Brekhovskikh方程计算薄夹层模型对应的多频反射系数，利用底部界面的反射系数填充薄夹层模型内部，得到薄夹层模型对应的多频反射系数与弹性参数之间的非线性映射关系；基于多个薄夹层模型分别对应的非线性映射关系，得到多通道卷积神经网络的训练数据集。第二方面，本申请实施例还提供一种地震数据的反演装置，装置包括：数据获取模块，用于获取地震数据；地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；反演谱模块，用于将地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；多频反射系数包括：多种目标频率下分别对应的反射系数；参数反演模块，用于将多频反射系数输入至第二神经网络进行弹性参数反演，得到地震数据对应的弹性参数。第三方面，本申请实施例还提供一种电子设备，包括处理器和存储器，存储器存储有能够被处理器执行的计算机可执行指令，处理器执行计算机可执行指令以实现上述第一方面所述的方法。第四方面，本申请实施例还提供一种计算机可读存储介质，计算机可读存储介质存储有计算机可执行指令，计算机可执行指令在被处理器调用和执行时，计算机可执行指令促使处理器实现上述第一方面所述的方法。本申请实施例提供的地震数据的反演方法、装置及电子设备中，首先获取地震数据；该地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；将地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；多频反射系数包括：多种目标频率下分别对应的反射系数；将多频反射系数输入至第二神经网络进行弹性参数反演，得到地震数据对应的弹性参数。基于深度学习的两阶段神经网络预测算法，提高薄夹层的分辨率，准确反演弹性参数。附图说明为了更清楚地说明本申请具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本申请的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本申请实施例提供的一种地震数据的反演方法的流程图；图2为本申请实施例提供的一种第一神经网络架构图；图3为本申请实施例提供的一种均方根误差随训练集大小的变化示意图；图4为本申请实施例提供的一种地震数据示意图；图5为本申请实施例提供的一种模型预测得到的不同频率的反射系数的示意图；图6为本申请实施例提供的一种传统谱投影梯度法得到的不同频率的反射系数的示意图；图7为本申请实施例提供的一种多通道卷积神经网络架构示意图；图8为本申请实施例提供的一种弹性参数的均方根误差随训练集的大小的变化趋势示意图；图9为本申请实施例提供的一种有噪声和无噪声的地震数据的示意图；图10为本申请实施例提供的一种无噪声地震数据中反演得到的反射系数的示意图；图11为本申请实施例提供的一种带噪声地震数据中反演得到的反射系数的示意图；图12为本申请实施例提供的一种P波速度、S波速度和密度与真实参数比较结果示意图；图13为本申请实施例提供的一种单通道神经网络架构示意图；图14为本申请实施例提供的一种无噪声地震数据输入网络模型的预测弹性参数结果示意图；图15为本申请实施例提供的一种传统的梯度下降方法与两阶段神经网络的结果比较示意图；图16为本申请实施例提供的一种地震数据的反演装置的结构框图；图17为本申请实施例提供的一种电子设备的结构示意图。具体实施方式下面将结合实施例对本申请的技术方案进行清楚、完整地描述，显然，所描述的实施例是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。传统的AVO反演方法包括以下缺点：物理上，调谐效应使得传统的基于幅值属性的AVO反演方法无法解决薄层间识别的问题。此外，相同的反射界面在不同频率下会具有不同的AVO特性，而传统的AVO反演方法中不包括频率因子。数值上，传统的弹性参数AVO反演通常采用梯度法，如最速下降法，牛顿法和共轭梯度法。这些算法对地球物理反问题的早期发展做出了巨大贡献，但存在计算复杂、容易陷入局部优化的缺陷。此外，具有全局优化特性的智能优化算法被应用于弹性参数反演，如遗传算法，粒子群优化和模拟退火算法。当这些算法应用于弹性参数反演时，一个好的初始模型尤为重要。然而，在地球物理界获得初始模型是困难的。而且，这些算法在地球物理反问题中收敛缓慢，大大降低了反演的效率。下面介绍一种传统反演求解方式：经典的卷积模型使用恒定的地震小波和反射系数卷积来获得地震记录：s＝w*r＝Wgr； 在公式中,r是地震反射率，长度为tr,w是地震小波，长度为tw,s是地震数据，长度为ts,满足ts＝tr+tw-1,*表示卷积运算；方程也可以写成矩阵-向量形式,其中,g表示乘法运算,W是由小波w生成的卷积矩阵并具有托普利茨矩阵的形式,其维数为tｓ×tr。根据Brekhovskikh方程,不同频率的小波对应不同的反射系数，即r＝Brekhovskikh（VP1,VS1,ρ1,VP２,Vｓ２,ρ２,VP3,VS3,ρ3,ω,d,θ1,θ2,θ3,γ1,γ2,γ3)；其矩阵形式如下：其中,VP1,VP2和VP3分别是三个地层的P波速度；VS1,VS2和VS3分别是三个地层的S波速度；ρ1,ρ2和ρ3分别是三个地层的密度；d是地下介质第二层的厚度；ω是角频率；θ1,θ2,θ3和γ1,γ2,γ3分别是三个地层的P波和S波的入射角。因此，地震卷积模型可以写成多个频率的小波及其相应的反射系数的卷积，即：s＝Wf1*rf1+Wf2*rf2+...+Wfn*rfn； 在公式中,Wf1是具有长度为tｗ的单个频率的小波；rf1是具有长度为tr的单个频率下的反射系数序列,n是频率的数量。方程可以写成矩阵-向量形式的线性系统：在等式中,Wf是单频小波对应的卷积矩阵，维数为tｓ×tｗ,D是具有维度ts×的小波卷积矩阵库,它由不同频率的雷克小波组成；m是具有长度tr×n的反射系数矢量。由于地震数据s的长度为tｗ+tr-1,反射系数向量的长度为tr×n,方程Dm＝s将是欠定的,因而求解m也是很困难的。为了解决这个难题，通常采用引入m的p范数的稀疏解。对于p＝1,该稀疏解指的是求解如下的不等式约束最小化问题其中，参数σ是赋范残差平方的边界。传统的梯度求解方法，例如L1最小化的谱投影梯度法，可以用于求解此问题。但由于数据是带噪声的，上述问题的采用梯度法的解对参数σ的选择很敏感。基于此，本申请实施例提供一种地震数据的反演方法、装置及电子设备，基于深度学习的两阶段神经网络预测算法，提高薄夹层的分辨率，准确反演弹性参数。为便于对本实施例进行理解，首先对本申请实施例所公开的一种地震数据的反演方法进行详细介绍。图1为本申请实施例提供的一种地震数据的反演方法的流程图，该方法具体包括以下步骤：步骤S102，获取地震数据；地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；步骤S104，将地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；多频反射系数包括：多种目标频率下分别对应的反射系数。上述第一神经网络，使用全连接网络来解决反演谱分解问题。它可以消除薄层间调谐效应，有效提高分辨率，并获得不同频率的反射系数。步骤S106，将多频反射系数输入至第二神经网络进行弹性参数反演，得到地震数据对应的弹性参数。第二神经网络，采用多通道卷积神经网络建立多频反射系数与弹性参数之间的映射关系，从而实现弹性参数的多频联合反演。数据结果比对：将上述过程应用于合成数据，以显示深度学习方法的抗噪声能力。与利用地震资料直接预测弹性参数的方法和传统的AVO反演方法相比，两阶段深度学习方法可以更准确地描述薄夹层的弹性参数。因此，该方法有望用于实际应用。本申请实施例提供的地震数据的反演方法中，首先获取地震数据；该地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；将地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；多频反射系数包括：多种目标频率下分别对应的反射系数；将多频反射系数输入至第二神经网络进行弹性参数反演，得到地震数据对应的弹性参数。基于深度学习的两阶段神经网络预测算法，提高薄夹层的分辨率，准确反演弹性参数。本申请实施例还提供另一种地震数据的反演方法，该方法在上述实施例的基础上实现；本实施例重点描述两个神经网络的构建过程和应用过程。一种较佳的实施方式中，上述第一神经网络包括四个全连接层；激活函数为tanh函数；第一神经网络的损失函数定义如下：其中，Llearn为目标函数，ts表示地震数据的长度，tr表示单个频率下的反射系数序列，地震反射率的长度,n是频率的数量,λ为正则化参数；mpre表示预训练的反射系数；mtrue表示真实的反射系数；D是具有维度ts*tr*n)的小波卷积矩阵库,由不同频率的雷克小波组成。参见图2所示的第一神经网络架构图，该网络由四个完全连接的层组成。输入的是归一化地震记录，取值范围为，长度为151，采样间隔为4ms。分别使用长度为32，采样间隔为4ms，频率为10Hz、20Hz和30Hz的Ricker小波。输出的是由三个频率反射系数组成的向量，长度为360，采样间隔为4ms，取值范围为。由于输入和输出值的范围都在之间，因此选择全连接层中的激活函数取做tanh函数。此函数在范围值为和的两个空间之间建立映射关系在深度学习中，预测值和真值之间的均方根误差用作网络训练的损失函数：整个网络的损失函数定义如下：上述目标函数的最小化通过梯度下降法解决。在本申请较佳的实施方式中，上述第一神经网络对应的训练数据集的获取过程如下：获取预设薄层厚度范围内的多个随机薄夹层模型；薄夹层模型的参数包括：薄夹层的P波速度、S波速度和密度；根据Brekhovskikh方程，计算多个随机薄夹层模型在不同频率下的反射系数；基于多个随机薄夹层模型分别对应的不同频率下的反射系数合成地震数据合成地震数据，得到第一神经网络对应的训练数据集。具体实施时，训练数据集通过方程和生成。设最小薄层厚度为4ms，最大厚度为20ms，则可以生成许多随机薄夹层模型。薄夹层的P波速度Vp、S波速度Vs和密度ρ都预先设定，并假设这三个参数之间的关系服从Gardner的经验公式：Vs＝-0.055×Vp2+1.017×Vp-1.031ρ＝1.74×Vp0.25； 利用Brekhovskikh方程计算薄夹层在不同频率下的反射系数，并通过方程合成地震数据。此外，为了训练网络的抗噪声能力，在合成地震记录s中增加了5dB至15dB的高斯噪声。训练集的大小不是先验给定的，因此会生成多个具有不同大小的训练集。对上述网络进行训练，同样可以生成相同的验证集。均方根误差随训练集大小的变化如图3所示。当训练集大小大于40000时，验证集的均方根误差将变得稳定。为了保证训练集中样本的多样性，使用大小为100000的训练集对网络模型进行训练和存储。为了验证所提网络的可行性和准确性，利用训练好的模型对无噪声和带噪声的合成地震数据进行测试，并将结果与传统的谱投影梯度方法进行对比。给定薄夹层模型，由公式Brekhovskikh方程计算的不同频率的反射系数如图4所示，由公式合成的地震数据如图4所示，信噪比为5dB的噪声地震数据如图4所示。将上述地震数据输入到训练好的网络模型中，得到不同频率下的反射系数，如图5所示，其中，表示无噪声地震数据的反射系数；表示带噪声的地震数据的反射系数。参见图6所示的传统谱投影梯度法得到的不同频率的反射系数，其中，表示无噪声地震数据的反射系数。表示带噪声的地震数据的反射系数。可以发现，本申请实施例所提出的机器学习方法在无噪声和带噪声情况下都获得了相对满意的结果。而传统的谱投影梯度方法产生的结果其幅度和位置不准确。基于第一阶段的深度学习，得到了不同频率地震数据的反射系数；接着，详细阐述第二神经网络的构建过程和应用过程：在本申请较佳的实施方式中，上述第二神经网络包括：多通道卷积神经网络；多通道卷积神经网络包括建立有多频反射系数与弹性参数之间的非线性映射关系的模型。上述第二神经网络包括三个通道；每个通道包括三个卷积层、三个最大池化层和压平层。上述第二神经网络还包括与每个压平层分别连接的第一完全连接层，以及与三个第一完全连接层均连接的第二完全连接层；第一完全连接层对应的激活函数为Softmax函数；第二完全连接层对应的激活函数为ReLU函数。也就是说，上述第二神经网络为多通道卷积神经网络，即建立了多频反射系数与弹性参数之间的非线性映射关系；其中，基于Brekhovskikh方程中给出)的AVO正向建模，使得神经网络具有物理约束，从而问题的求解过程具有物理意义。本申请实施例中使用的多通道卷积神经网络架构如图7所示。在该网络中，输入部分是谱分解后地震数据的多频反射系数。每个通道有三个卷积层，每个卷积层的卷积核大小是1×1。第一卷积层有8个随机核，第二和第三卷积层有32个随机核。卷积运算后，数据维度增加，每个通道经过三次池化操作，压缩数据维度并提取数据特征。每个池化层都采用最大池化，池化接收窗口的大小为2×3,步长为2。为避免输入过大或过小导致梯度弥散，采用批量范数层将输入映射到趋于0的小区间，以获得更理想的优化轨迹。在最后一次池化操作后，数据变成一维的，并通过压平层进行处理，为全连接层做准备。在第一个完全连接层中，激活函数是下面给出的Softmax函数：三个通道的输出使用连接函数Concatenate连接。将三个一维向量拼接成一个一维向量，并导入到最终的全连接层中。在第二个全连接层中，激活函数是下面给出的ReLU函数：R＝max；ReLU函数将抑制所有小于0并趋于0的值，并直接输出正数。至此，整个网络训练过程完成。训练完成后，利用Brekhovskikh方程对预测数据进行多频AVO正演建模，然后与输入反射系数进行比较。其中，Brekhovskikh方程是该神经网络的物理约束条件，从而使得学习过程是有物理意义的。在本申请较佳的实施方式中，上述多通道卷积神经网络的训练数据集的获取过程如下：生成多个随机的薄夹层模型；针对每个薄夹层模型，利用Brekhovskikh方程计算薄夹层模型对应的多频反射系数，利用底部界面的反射系数填充薄夹层模型内部，得到薄夹层模型对应的多频反射系数与弹性参数之间的非线性映射关系；基于多个薄夹层模型分别对应的非线性映射关系，得到多通道卷积神经网络的训练数据集。具体实施时，为了获得更好的训练结果，需要大量的训练集。生成训练集分为三个步骤：生成许多随机的薄夹层模型，与第一阶段一样，构建相同的神经网络；利用Brekhovskikh方程计算不同频率下的反射系数，由于反射系数的稀疏性和弹性参数的非稀疏性，利用各底部界面的反射系数来填充薄层内部，从而很好地建立映射关系；与第一阶段深度学习相同，使用多个不同大小的训练集来训练网络，并验证相同的验证集。弹性参数的均方根误差随训练集的大小的变化趋势如图8所示。可以看出，当训练集大小大于30000时，验证集的均方根误差趋于稳定。最后，采用大小为50000的训练集对网络进行训练和存储。与常规的AVO技术相比，本申请实施例提出的网络模型和数据双驱动的深度学习技术具有以下优势：传统AVO技术的缺点：只是基于模型驱动。基于叠前聚集振幅属性的AVO反演方法，通过幅值随偏移的变化计算地下介质的弹性参数。但是，当地下介质是薄的夹层时，会发生调谐效应，这是反射界面处幅值的混叠现象。调谐效果使得传统的基于幅值属性的AVO反演方法无法解决薄层间识别的问题。本方案的优势：提出了模型和数据双驱动的深度学习技术。首先，将全连接的神经网络应用于反演谱分解。该技术可以消除薄层间调谐效应，有效提高分辨率。其次，利用多通道卷积神经网络建立多频反射系数与弹性参数的映射关系，实现弹性参数的反演。本发明技术效果为人工合成实例模拟：本发明的合成地震数据是使用公式和为给定的随机薄层间模型生成的。图9中表示无噪声地震数据；图9中表示带高斯噪声地震数据。其中，时间采样间隔为4ms，入射角分别为10°、20°和30°。将上述地震记录输入上述第一阶段训练好的反演谱分解网络，得到图10和图11所示不同频率下的反射系数。图10为无噪声地震数据中反演得到的反射系数，表示10Hz时的反射系数；表示20Hz时的反射系数；表示30Hz时的反射系数。图11为带噪声地震数据中反演得到的反射系数，表示10Hz时的反射系数；表示20Hz时的反射系数；表示30Hz时的反射系数。在第二阶段，将得到的反射系数馈送到训练好的多通道卷积神经网络中进行弹性参数反演，并将恢复得到的P波速度，S波速度和密度与真实参数进行比较，如图12所示。在图12中，实线曲线表示真弹性参数，虚线曲线是无噪声数据的反演结果，点状曲线是带噪声数据的反演结果。从图12可以看出，即使对于带噪声的数据，所提出的深度学习技术仍然可以产生良好的预测结果。再提及一下，本发明实施例提出的深度学习技术是分两个阶段实现的。为了展示其良好的性能，本方案还构建了另一个单通道神经网络，仅用叠前地震数据来预测弹性参数，架构如图13所示。其目的是对比单通道神经网络和多通道神经网络的学习能力，得出多通道神经网络的优越性。网络的输入是入射角为10°、20°和30°的叠前地震数据。时间采样间隔为4ms。类似于生成反演谱分解网络的训练集的操作，生成该网络的训练集。网络模型使用大小为50000的训练集进行训练和保存。将图9中的无噪声地震数据输入到经过训练的网络模型中以预测弹性参数，结果如图14所示。图14中的实线曲线表示真实弹性参数，虚线曲线是使用两阶段神经网络的结果，点状曲线是来自单通道神经网络的结果。从图14可以明显看出，两阶段神经网络在准确性方面产生了更好的结果。此外，本方案还使用传统的梯度下降方法与提出的两阶段神经网络的结果进行比较，如图15所示。同样，在图15中，实线曲线表示真实值，虚线和点状曲线分别是使用所提出的两阶段神经网络和梯度下降法的反演结果。很明显，两阶段神经网络比梯度下降法产生更准确的结果。我们还想指出的是，梯度下降方法依赖于弹性参数的良好的初始值，否则结果会更差。需要说明的是，本申请实施例两个网络模型所涉及的CNN架构也可以采用其它网络架构，在此不做具体限定，本方案的重点在于两种神经网络实现的数据双驱动两步骤。在传统的AVO反演中，薄夹层识别和弹性参数反演都很困难。本申请实施例分别应用两阶段神经网络深度学习方法进行反演谱分解和具有联合多频反射系数的弹性参数反演。第一阶段深度学习技术，消除调谐效果，有效提高薄夹层的分辨率，得到不同频率下的反射系数。第二阶段深度学习技术，基于多通道卷积神经网络的多频联合弹性参数反演可以更准确地描述薄夹层的P波速度、S波速度和密度。本申请实施例提出的工作流程具有实际应用价值，为非常规油气稀薄储层勘探提供了新思路。基于上述方法实施例，本申请实施例还提供一种地震数据的反演装置，参见图16所示，该装置包括：数据获取模块162，用于获取地震数据；地震数据包括多种目标频率下的Ricker小波与对应的反射系数卷积生成的数据；反演谱模块164，用于将地震数据输入至第一神经网络进行反演谱分解，得到多频反射系数；多频反射系数包括：多种目标频率下分别对应的反射系数；参数反演模块166，用于将多频反射系数输入至第二神经网络进行弹性参数反演，得到地震数据对应的弹性参数。在本申请较佳的实施方式中，上述第一神经网络包括四个全连接层；激活函数为tanh函数；第一神经网络的损失函数定义如下：其中，Llearn为目标函数，ts表示地震数据的长度，tr表示单个频率下的反射系数序列，地震反射率的长度,n是频率的数量,λ为正则化参数；mpre表示预训练的反射系数；mtrue表示真实的反射系数；D是具有维度ts*tr*n)的小波卷积矩阵库,由不同频率的雷克小波组成。在本申请较佳的实施方式中，上述装置还包括训练集获取模块，用于执行以下第一神经网络对应的训练数据集的获取过程：获取预设薄层厚度范围内的多个随机薄夹层模型；薄夹层模型的参数包括：薄夹层的P波速度、S波速度和密度；根据Brekhovskikh方程，计算多个随机薄夹层模型在不同频率下的反射系数；基于多个随机薄夹层模型分别对应的不同频率下的反射系数，得到第一神经网络对应的训练数据集。在本申请较佳的实施方式中，上述第二神经网络包括：多通道卷积神经网络；多通道卷积神经网络包括建立有多频反射系数与弹性参数之间的非线性映射关系的模型。在本申请较佳的实施方式中，上述第二神经网络包括三个通道；每个通道包括三个卷积层、三个最大池化层和压平层。在本申请较佳的实施方式中，上述第二神经网络还包括与每个压平层分别连接的第一完全连接层，以及与三个第一完全连接层均连接的第二完全连接层；第一完全连接层对应的激活函数为Softmax函数；第二完全连接层对应的激活函数为ReLU函数。在本申请较佳的实施方式中，上述训练集获取模块，还用于执行以下多通道卷积神经网络的训练数据集的获取过程：生成多个随机的薄夹层模型；针对每个薄夹层模型，利用Brekhovskikh方程计算薄夹层模型对应的多频反射系数，利用底部界面的反射系数填充薄夹层模型内部，得到薄夹层模型对应的多频反射系数与弹性参数之间的非线性映射关系；基于多个薄夹层模型分别对应的非线性映射关系，得到多通道卷积神经网络的训练数据集。本申请实施例提供的装置，其实现原理及产生的技术效果和前述方法实施例相同，为简要描述，装置的实施例部分未提及之处，可参考前述方法实施例中相应内容。本申请实施例还提供了一种电子设备，如图17所示，为该电子设备的结构示意图，其中，该电子设备包括处理器171和存储器170，该存储器170存储有能够被该处理器171执行的计算机可执行指令，该处理器171执行该计算机可执行指令以实现上述方法。在图17示出的实施方式中，该电子设备还包括总线172和通信接口173，其中，处理器171、通信接口173和存储器170通过总线172连接。其中，存储器170可能包含高速随机存取存储器，也可能还包括非不稳定的存储器，例如至少一个磁盘存储器。通过至少一个通信接口173实现该系统网元与至少一个其他网元之间的通信连接，可以使用互联网，广域网，本地网，城域网等。总线172可以是ISA总线、PCI总线或EISA总线等。所述总线172可以分为地址总线、数据总线、控制总线等。为便于表示，图17中仅用一个双向箭头表示，但并不表示仅有一根总线或一种类型的总线。处理器171可能是一种集成电路芯片，具有信号的处理能力。在实现过程中，上述方法的各步骤可以通过处理器171中的硬件的集成逻辑电路或者软件形式的指令完成。上述的处理器171可以是通用处理器，包括中央处理器、网络处理器等；还可以是数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。结合本申请实施例所公开的方法的步骤可以直接体现为硬件译码处理器执行完成，或者用译码处理器中的硬件及软件模块组合执行完成。软件模块可以位于随机存储器，闪存、只读存储器，可编程只读存储器或者电可擦写可编程存储器、寄存器等本领域成熟的存储介质中。该存储介质位于存储器，处理器171读取存储器中的信息，结合其硬件完成前述实施例的方法的步骤。本申请实施例还提供了一种计算机可读存储介质，该计算机可读存储介质存储有计算机可执行指令，该计算机可执行指令在被处理器调用和执行时，该计算机可执行指令促使处理器实现上述方法，具体实现可参见前述方法实施例，在此不再赘述。本申请实施例所提供的方法、装置和电子设备的计算机程序产品，包括存储了程序代码的计算机可读存储介质，所述程序代码包括的指令可用于执行前面方法实施例中所述的方法，具体实现可参见方法实施例，在此不再赘述。除非另外具体说明，否则在这些实施例中阐述的部件和步骤的相对步骤、数字表达式和数值并不限制本申请的范围。所述功能如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个处理器可执行的非易失的计算机可读取存储介质中。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本申请各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。在本申请的描述中，需要说明的是，术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本申请和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本申请的限制。此外，术语“第一”、“第二”、“第三”仅用于描述目的，而不能理解为指示或暗示相对重要性。最后应说明的是：以上所述实施例，仅为本申请的具体实施方式，用以说明本申请的技术方案，而非对其限制，本申请的保护范围并不局限于此，尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，其依然可以对前述实施例所记载的技术方案进行修改或可轻易想到变化，或者对其中部分技术特征进行等同替换；而这些修改、变化或者替换，并不使相应技术方案的本质脱离本申请实施例技术方案的精神和范围，都应涵盖在本申请的保护范围之内。因此，本申请的保护范围应所述以权利要求的保护范围为准。
