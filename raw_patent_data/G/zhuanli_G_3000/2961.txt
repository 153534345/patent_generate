标题title
目标检测方法、装置、设备和存储介质
摘要abst
本发明公开了一种目标检测方法，包括：通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和标注分类信息，确定分类损失；根据教师预测框、学生预测框和标注框，分别确定指导损失函数和被指导损失函数，并确定指导目标和被指导目标，提取指导特征和被指导特征；根据指导特征和被指导特征，确定蒸馏损失；根据分类损失和蒸馏损失，确定对待检测图像进行目标检测的目标检测模型；目标检测模型用于对待检测图像进行目标检测。提高了目标检测模型的模型准确度。
权利要求书clms
1.一种目标检测方法，其特征在于，包括：通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；根据所述教师预测框、所述学生预测框、所述教师预测分类信息、所述学生预测分类信息、所述样本图像的标注框和所述样本图像的标注分类信息，确定分类损失；根据教师预测框、学生预测框和所述样本图像的标注框，分别确定指导损失函数和被指导损失函数；根据所述指导损失函数确定指导目标，提取所述指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取所述被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；根据所述指导特征和所述被指导特征，确定蒸馏损失；根据所述分类损失和所述蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；所述目标检测模型用于对待检测图像进行目标检测，以从所述待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定所述违禁物目标的类别信息和位置信息。2.根据权利要求1所述的方法，其特征在于，还包括：若所述目标检测模型对应的待训练学生模型的模型准确率大于准确率阈值，则将所述目标检测模型对应的待训练学生模型作为下一轮模型训练过程中的待训练教师模型。3.根据权利要求1所述的方法，其特征在于，根据所述教师预测框、所述学生预测框、所述教师预测分类信息、所述学生预测分类信息、所述样本图像的标注框和所述样本图像的标注分类信息，确定分类损失，包括：根据所述教师预测分类信息、所述学生预测分类信息、所述教师预测框和所述样本图像的标注框的第一交并比，以及所述学生预测框和所述样本图像的标注框的第二交并比，对所述样本图像的标注分类信息进行调整，得到调整后的标注分类信息；根据调整后的标注分类信息，确定分类损失。4.根据权利要求3所述的方法，其特征在于，根据所述教师预测分类信息、所述学生预测分类信息、所述教师预测框和所述样本图像的标注框的第一交并比，以及所述学生预测框和所述样本图像的标注框的第二交并比，对所述样本图像的标注分类信息进行调整，得到调整后的标注分类信息，包括：若所述教师预测类别和所述学生预测类别一致，且所述教师置信度和所述学生置信度均大于置信度阈值，则确定所述教师预测框和所述学生预测框的预测框交并比；若所述预测框交并比大于第一阈值，且所述教师预测框和样本图像的标注框的第一交并比以及所述学生预测框和所述样本图像的标注框的第二交并比均大于或等于第二阈值，则根据所述教师预测分类信息和所述学生预测分类信息，对所述样本图像的标注分类信息进行调整，得到调整后的标注分类信息。5.根据权利要求1所述的方法，其特征在于，根据所述指导特征和所述被指导特征，确定蒸馏损失，包括：确定所述指导特征的特征损失函数和被指导特征的特征损失函数之间的特征损失函数，以及所述指导特征的特征相关性和所述被指导特征的特征相关性之间的相关性差值；根据所述特征损失函数和所述相关性差值，确定蒸馏损失。6.根据权利要求1所述的方法，其特征在于，根据教师预测框、学生预测框和所述样本图像的标注框，分别确定指导损失函数和被指导损失函数，包括：根据教师预测框、学生预测框和样本图像的标注框，分别确定教师预测框损失函数和学生预测框损失函数；根据教师预测框损失函数和学生预测框损失函数的比较结果，从所述教师预测框损失函数和所述学生预测框损失函数中确定指导损失函数和被指导损失函数。7.根据权利要求1所述的方法，其特征在于，通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息之前，还包括：根据候选模型的检出率、推理速度、网络结构和模型参数量，从所述候选模型中确定原始教师模型和原始学生模型；对原始教师模型的教师模型参数进行初始化，确定待训练教师模型；从公开数据预训练模型的训练模型参数中提取与所述教师模型参数一致的公共模型参数，对所述公共模型参数赋值，根据赋值后的公共模型参数和所述原始学生模型确定待训练学生模型。8.根据权利要求7所述的方法，对原始教师模型的教师模型参数进行初始化，确定待训练教师模型，包括：对原始教师模型进行模型迭代训练，根据模型迭代训练的结果确定所述原始教师模型的原始模型损失函数；当所述原始损失函数的稳定性满足函数稳定条件时，结束对所述原始教师模型的模型迭代训练；对完成模型迭代训练的原始教师模型的教师模型参数进行初始化，确定待训练教师模型。9.一种目标检测装置，其特征在于，包括：目标检测模块，用于通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；分类损失确定模块，用于根据所述教师预测框、所述学生预测框、所述教师预测分类信息、所述学生预测分类信息、所述样本图像的标注框和所述样本图像的标注分类信息，确定分类损失；损失函数确定模块，用于根据教师预测框、学生预测框和所述样本图像的标注框，分别确定指导损失函数和被指导损失函数；指导特征确定模块，用于根据所述指导损失函数确定指导目标，提取所述指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取所述被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；蒸馏损失确定模块，用于根据所述指导特征和所述被指导特征，确定蒸馏损失；目标检测模型确定模块，用于根据所述分类损失和所述蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；所述目标检测模型用于对待检测图像进行目标检测，以从所述待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定所述违禁物目标的类别信息和位置信息。10.一种电子设备，其特征在于，所述电子设备包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的计算机程序，所述计算机程序被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-8中任一项所述的目标检测方法。11.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机指令，所述计算机指令用于使处理器执行时实现权利要求1-8中任一项所述的目标检测方法。
说明书desc
技术领域本发明实施例涉及计算机领域，尤其涉及目标检测方法、装置、设备和存储介质。背景技术目前随着深度学习目标检测方法在各个工业领域被广泛应用，目标检测网络也得到迅速发展，目标检测网络的网络结构逐渐复杂，且网络参数逐渐变大，使得目标检测网络对硬件设备的要求不断提高。因此，衍生出知识蒸馏方法，知识蒸馏方法采用复杂的目标检测网络作为教师模型，引导简单的目标检测网络即学生模型进行模型训练。但是在模型训练过程中，教师模型不参与训练过程，且教师模型和学生模型的在训练过程中的引导角色和被引导角色固定不变，导致学生模型检测能力在训练过程中不断提高，而教师模型的模型检测能力在训练过程中不会产生变化。因此，如何在通过知识蒸馏方法进行模型训练时，使学生模型和教师模型的模型检测能力均能够在模型训练过程中得到提升，是需要解决的问题。发明内容本发明提供了目标检测方法、装置、设备和存储介质，可以使待训练教师模型和待训练学生模型同时进行模型训练，使得待训练教师模型和待训练学生模型的检测能力在训练过程中均能够不断提高。根据本发明的一方面，提供了一种目标检测方法，包括：通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；根据所述教师预测框、所述学生预测框、所述教师预测分类信息、所述学生预测分类信息、所述样本图像的标注框和所述样本图像的标注分类信息，确定分类损失；根据教师预测框、学生预测框和所述样本图像的标注框，分别确定指导损失函数和被指导损失函数；根据所述指导损失函数确定指导目标，提取所述指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取所述被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；根据所述指导特征和所述被指导特征，确定蒸馏损失；根据所述分类损失和所述蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；所述目标检测模型用于对待检测图像进行目标检测，以从所述待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定所述违禁物目标的类别信息和位置信息。根据本发明的另一方面，提供了一种目标检测装置，该装置包括：目标检测模块，用于通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；分类损失确定模块，用于根据所述教师预测框、所述学生预测框、所述教师预测分类信息、所述学生预测分类信息、所述样本图像的标注框和所述样本图像的标注分类信息，确定分类损失；损失函数确定模块，用于根据教师预测框、学生预测框和所述样本图像的标注框，分别确定指导损失函数和被指导损失函数；指导特征确定模块，用于根据所述指导损失函数确定指导目标，提取所述指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取所述被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；蒸馏损失确定模块，用于根据所述指导特征和所述被指导特征，确定蒸馏损失；目标检测模型确定模块，用于根据所述分类损失和所述蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；所述目标检测模型用于对待检测图像进行目标检测，以从所述待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定所述违禁物目标的类别信息和位置信息。根据本发明的另一方面，提供了一种电子设备，所述电子设备包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的计算机程序，所述计算机程序被所述至少一个处理器执行，以使所述至少一个处理器能够执行本发明任一实施例所述的目标检测方法。根据本发明的另一方面，提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机指令，所述计算机指令用于使处理器执行时实现本发明任一实施例所述的目标检测方法。本发明实施例的技术方案，通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和样本图像的标注分类信息，确定分类损失；根据教师预测框、学生预测框和样本图像的标注框，分别确定指导损失函数和被指导损失函数；根据指导损失函数确定指导目标，提取指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；根据指导特征和被指导特征，确定蒸馏损失；根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；目标检测模型用于对待检测图像进行目标检测，以从待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定违禁物目标的类别信息和位置信息。解决了在教师模型和学生模型的训练过程中，只有学生模型参与训练，导致教师模型的检测能力无法在训练过程中得到提高的问题。上述方案，实现了在训练目标检测模型时，使待训练教师模型和待训练学生模型同时进行模型训练，使得待训练教师模型和待训练学生模型的检测能力在训练过程中均能够不断提高，提高了对待训练教师模型和待训练学生模型进行模型训练的灵活性，以及待训练学生模型的鲁棒性，同时提高了目标检测模型的模型精确度。采用目标检测模型对待检测图像进行目标检测，可以提高对待检测图像的检测效率，同时提高获取的违禁物目标的类别信息和位置信息的准确性。应当理解，本部分所描述的内容并非旨在标识本发明的实施例的关键或重要特征，也不用于限制本发明的范围。本发明的其它特征将通过以下的说明书而变得容易理解。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例一提供的一种目标检测方法的流程图；图2为本发明实施例二提供的一种目标检测方法的流程图；图3为本发明实施例三提供的一种目标检测方法的流程图；图4为本发明实施例四提供的一种目标检测装置的结构示意图；图5为本发明实施例五提供的一种电子设备的结构示意图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分的实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本发明保护的范围。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语 “第一”和“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“等”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。实施例一图1为本发明实施例一提供的一种目标检测方法的流程图，本实施例可适用于对教师模型和学生模型进行训练，并根据训练结果确定目标检测模型，以根据目标检测模型对待检测图像进行目标检测的情况。该方法可以由目标检测装置来执行，该目标检测装置可以采用硬件和/或软件的形式实现，该目标检测装置可配置于电子设备中。如图1所示，该方法包括：S110、通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息。需要说明的是，大模型往往是单个复杂网络或者是若干网络的集合，拥有良好的性能和泛化能力，而小模型因为网络规模较小，表达能力有限。因此，可以利用大模型学习到的知识去指导小模型训练，使得小模型具有与大模型相当的性能，但是参数数量大幅降低，从而实现模型压缩与加速，这就是知识蒸馏与迁移学习在模型优化中的应用。知识蒸馏采取教师-学生模式：将复杂且大的模型作为教师模型，而学生模型结构较为简单，用教师模型来辅助学生模型的训练，教师模型学习能力强，可以将教师模型学到的知识迁移给学习能力相对弱的学生模型，以此来增强学生模型的泛化能力。在本实施例中，样本图像为X光图像。X光图像是指通过X光对物体进行扫描拍摄后获取到的图像。待检测目标是指某一区域中可以被X光扫描并可以被检测到的物体。在物流领域，待检测目标可以是违禁品。教师预测框是指通过待训练教师模型对样本图像中的待检测目标进行目标检测，得到的样本图像的预测框。教师预测框是指通过待训练教师模型预测获得的样本图像的空间位置；学生预测框是指通过待训练学生模型预测获得的样本图像的空间位置。教师预测分类信息包括待训练教师模型对样本图像中的待检测目标进行目标检测，得到的待检测目标的类别信息和类别信息对应的类别权重。学生预测框是指通过待训练学生模型对样本图像中的待检测目标进行目标检测，得到的样本图像的预测框。学生预测分类信息包括待训练学生模型对样本图像中的待检测目标进行目标检测，得到的待检测目标的类别信息和类别信息对应的类别权重。具体的，从候选检测模型中选择结构复杂且参数量较多的模型，作为待训练教师模型，并从候选检测模型中选择结构简单和参数量较少的模型作为待训练学生模型。分别通过知识蒸馏算法对应的待训练教师模型和待训练学生模型对样本图像进行图像预处理，确定教师模型预处理图像和学生模型预处理图像；教师模型预处理图像和学生模型预处理图像的尺寸一致。通过待训练教师模型对教师模型预处理图像中的待检测目标进行目标检测，得到教师预测框和教师预测分类信息；通过待训练学生模型对学生模型预处理图像中的待检测目标进行目标检测，得到学生预测框和学生预测分类信息。S120、根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和样本图像的标注分类信息，确定分类损失。其中，样本图像的标注分类信息是指人工标定的待检测目标的类别信息和类别信息对应的类别权重。分类损失是指目标检测的分类损失函数。具体的，根据教师预测分类信息和样本图像的标注分类信息，确定待训练教师模型对样本图像进行目标检测时的分类损失函数，即教师分类损失函数。根据学生预测分类信息和样本图像的标注分类信息，确定待训练学生模型对样本图像进行目标检测时的分类损失函数，即学生分类损失函数。将教师分类损失函数和学生分类损失函数的和，作为本步骤中的分类损失。S130、根据教师预测框、学生预测框和样本图像的标注框，分别确定指导损失函数和被指导损失函数。具体的，根据教师预测框和样本图像的标注框，确定待训练教师模型的教师预测框损失函数；根据学生预测框和样本图像的标注框，确定待训练学生模型的学生预测框损失函数。教师预测框损失函数是指通过待训练教师模型对样本图像的空间位置进行预测时产生的损失函数；学生预测框损失函数是指通过待训练学生模型对样本图像的空间位置进行预测时产生的损失函数。根据预先设置的指导损失函数和被指导损失函数的选择条件，从教师预测框损失函数和学生预测框损失函数中分别确定指导损失函数和被指导损失函数。指导损失函数和被指导损失函数不一致。示例性的，可以通过如下子步骤分别确定指导损失函数和被指导损失函数：S1301、根据教师预测框、学生预测框和样本图像的标注框，分别确定教师预测框损失函数和学生预测框损失函数。具体的，将教师预测框和样本图像的标注框进行交并比计算，确定教师预测框和标注框的交并比。确定教师预测框和标注框的交并比的最小值为第一最小交并比，并确定第一最小交并比对应的样本图像的标注框作为第一目标框，根据第一目标框和公式，确定教师预测框损失函数。其中，losst为教师预测框损失函数；p为第n个检测目标的分类误差；表示教师预测框中第n个检测目标的中心位置； /＞表示第一目标框中第n个检测目标的中心位置。将学生预测框和样本图像的标注框进行交并比计算，确定学生预测框和标注框的交并比。确定学生预测框和标注框的交并比的最小值为第二最小交并比，并确定第二最小交并比对应的样本图像的标注框作为第二目标框，根据第二目标框和公式，确定学生预测框损失函数。 其中，losss为学生预测框损失函数； 表示学生预测框中第n个检测目标的中心位置；/＞表示第二目标框中第n个检测目标的中心位置。S1302、根据教师预测框损失函数和学生预测框损失函数的比较结果，从教师预测框损失函数和学生预测框损失函数中确定指导损失函数和被指导损失函数。具体的，根据教师预测框损失函数和学生预测框损失函数的比较结果，从教师预测框损失函数和学生预测框损失函数中确定最小值作为指导损失函数；从教师预测框损失函数和学生预测框损失函数中确定最大值作为被指导损失函数。可以理解的是，根据教师预测框损失函数和学生预测框损失函数的比较结果，确定指导损失函数和被指导损失函数，可以提高指导损失函数和被指导损失函数的确定效率。S140、根据指导损失函数确定指导目标，提取指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取被指导目标的被指导特征。指导目标和被指导目标为不同的待检测目标。其中，指导目标是指导损失函数对应的待检测目标。被指导目标是指被指导损失函数对应的待检测目标。指导特征是指待检测目标的特征信息；被指导特征是指被指导目标的特征信息。具体的，确定指导损失函数对应的待检测目标为指导目标，并从待训练教师模型和待训练学生模型中确定指导目标对应的指导训练模型，通过指导训练模型对指导目标的特征信息提取结果确定指导目标的指导特征。确定被指导损失函数对应的待检测目标为被指导目标，并从待训练教师模型和待训练学生模型中确定被指导目标对应的被指导训练模型，通过被指导训练模型对被指导目标的特征信息提取结果确定被指导目标的被指导特征。示例性的，对待训练教师模型的教师模型瓶颈层和待训练学生模型的学生模型瓶颈层进行缩放，以使缩放后的教师模型瓶颈层和缩放后的学生模型瓶颈层尺寸一致。从缩放后的教师模型瓶颈层和缩放后的学生模型瓶颈层中确定指导损失函数对应的待检测目标的最小目标瓶颈层，以及被指导损失函数对应的待检测目标的最大目标瓶颈层。根据最小目标瓶颈层对样本图像中待检测目标的特征信息提取结果确定指导特征，并根据最大目标瓶颈层对样本图像中待检测目标的特征信息提取结果确定被指导特征。S150、根据指导特征和被指导特征，确定蒸馏损失。示例性的，确定蒸馏损失的方法可以是：确定指导特征的特征损失函数和被指导特征的特征损失函数之间的特征损失函数，以及指导特征的特征相关性和被指导特征的特征相关性之间的相关性差值；根据特征损失函数和相关性差值，确定蒸馏损失。具体的，通过公式确定待训练教师模型和待训练学生模型对待检测目标进行目标检测时的类别损失函数。其中，为类别损失函数；sigmoid函数可以将类别损失函数控制在；N表示待检测目标的总类别；n表示第n个类别；X表示特征信息，例如特征图；x表示特征信息上的特征值；/＞表示待训练教师模型对待检测目标进行目标检测时确定的类别概率；/＞表示待训练学生模型对待检测目标进行目标检测时确定的类别概率。类别可以包括违禁类和非违禁类。通过公式确定指导特征的特征值和被指导特征的特征值的绝对差值。 其中，为指导特征的特征值和被指导特征的特征值的绝对差值；xt为指导特征的特征值；xs为被指导特征的特征值。通过公式确定指导特征的特征相关性和被指导特征的特征相关性之间的相关性差值。 其中，为指导特征的特征相关性和被指导特征的特征相关性之间的相关性差值；/＞为指导特征的特征相关性；/＞为被指导特征的特征相关性。/＞根据公式确定蒸馏损失。其中，lossdistil表示蒸馏损失。a、λ和β为超参。S160、根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；目标检测模型用于对待检测图像进行目标检测，以从待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定违禁物目标的类别信息和位置信息。其中，待检测图像为X光扫描图像。具体的，根据教师预测框和样本图像的标注框之间的差异性，确定待训练教师模型的教师模型回归损失；根据学生预测框与样本图像的标注框之间的差异性，确定待训练学生模型的学生模型回归损失。将教师模型回归损失和学生模型回归损失之和作为模型回归损失。将分类损失、蒸馏损失和模型回归损失之和作为检测模型损失。根据检测模型损失，确定待训练教师模型和待训练学生模型是否完成训练。若检测模型损失的稳定性符合预设的稳定性条件，则确定待训练教师模型和待训练学生模型完成训练，则将训练完成后的待训练学生模型作为目标检测模型。当需要对待检测图像进行目标检测时，将待检测图像输入目标检测模型，以使目标检测模型根据待检测图像确定待检测图像中的候选检测目标。根据目标检测模型对待检测图像进行目标检测，可以获得目标检测模型的输出数据。根据目标检测模型的输出数据确定候选检测目标中是否具有违禁物品对应的违禁物目标，若是，则根据目标检测模型的输出数据进一步确定违禁物目标的类别信息和位置信息。以使工作人员根据违禁物目标的类别信息和位置信息对违禁物目标进行处理。可选的，若目标检测模型对应的待训练学生模型的模型准确率大于准确率阈值，则将目标检测模型对应的待训练学生模型作为下一轮模型训练过程中的待训练教师模型。具体的，若当前模型训练结束后，目标检测模型对应的待训练学生模型的模型准确率大于准确率阈值，则将目标检测模型对应的待训练学生模型作为下一轮模型训练过程中的待训练教师模型，并从候选检测模型中确定下一轮模型训练过程中的待训练学生模型。在下一轮模型训练过程中，根据下一轮模型训练过程中的待训练教师模型和待训练学生模型的分类损失和蒸馏损失，对模型更新后的待训练教师模型和待训练学生模型进行训练。需要说明的是，待训练教师模型采用弱监督数据处理方式对样本图像进行图像处理，但不改变样本图像的像素布局。例如弱监督数据处理方式可以是改变光线强度等，但不改变图像像素布局。待训练学生模型采用强数据处理方式对样本图像进行图像处理。例如，强数据处理方式包括掩码和涂黑等操作。分类损失和蒸馏损失的确定方法和上文中的分类损失和蒸馏损失的确定方法一致，此处不再赘述。上述方案解决了教师模型和学生模型在目标检测模型的训练过程中，教师模型和学生模型的角色固定，无法随着模型的检测能力的提高，进行角色转换的问题。可以提高目标检测模型的鲁棒性。本实施例提供的技术方案，通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和样本图像的标注分类信息，确定分类损失；根据教师预测框、学生预测框和样本图像的标注框，分别确定指导损失函数和被指导损失函数；根据指导损失函数确定指导目标，提取指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；根据指导特征和被指导特征，确定蒸馏损失；根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；目标检测模型用于对待检测图像进行目标检测，以从待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定违禁物目标的类别信息和位置信息。解决了在教师模型和学生模型的训练过程中，只有学生模型参与训练，导致教师模型的检测能力无法在训练过程中得到提高的问题。上述方案，实现了在训练目标检测模型时，使待训练教师模型和待训练学生模型同时进行模型训练，使得待训练教师模型和待训练学生模型的检测能力在训练过程中均能够不断提高，提高了对待训练教师模型和待训练学生模型进行模型训练的灵活性，以及待训练学生模型的鲁棒性，同时提高了目标检测模型的模型精确度。采用目标检测模型对待检测图像进行目标检测，可以提高对待检测图像的检测效率，同时提高获取的违禁物目标的类别信息和位置信息的准确性。实施例二图2为本发明实施例二提供的一种目标检测方法的流程图，本实施例在上述实施例的基础上进行了优化，给出了一种根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和样本图像的标注分类信息，确定分类损失的优选实施方案。具体的，如图2所示，该方法包括：S210、通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息。S220、根据教师预测分类信息、学生预测分类信息、教师预测框和样本图像的标注框的第一交并比，以及学生预测框和样本图像的标注框的第二交并比，对样本图像的标注分类信息进行调整，得到调整后的标注分类信息。其中，第一交并比是指教师预测框和样本图像的标注框之间的交集和并集的比值。第二交并比是指学生预测框和样本图像的标注框之间的交集和并集的比值。具体的，若教师预测框和样本图像的标注框的第一交并比，以及学生预测框和样本图像的标注框的第二交并比均大于预设的交并比阈值，且教师预测分类信息和学生预测分类信息一致，则根据教师预测分类信息对样本图像的标注分类信息进行调整，得到调整后的标注分类信息。示例性的，若教师预测类别和学生预测类别一致，且教师置信度和学生置信度均大于置信度阈值，则确定教师预测框和学生预测框的预测框交并比；若预测框交并比大于第一阈值，且教师预测框和样本图像的标注框的第一交并比以及学生预测框和样本图像的标注框的第二交并比均大于或等于第二阈值，则根据教师预测分类信息和学生预测分类信息，对样本图像的标注分类信息进行调整，得到调整后的标注分类信息。示例性的，置信度阈值可以是0.75；第一阈值可以是0.75；第二阈值可以是0.65。上述方案，可以根据待训练教师模型对样本图像的预测结果，以及待训练学生模型对样本图像的预测结果，对样本图像的标注分类信息进行调整，保证了样本图像标注分类信息的准确性，从而提高了后续计算获得的分类损失的准确性。S230、根据调整后的标注分类信息，确定分类损失。示例性的，可以根据公式确定分类损失。其中，IOU为第一交并比和第二交并比；λij为1-IOU值；yij是指调整后的标注分类信息中的类别权重；M表示目标的数量；i表示第i个目标；N表示类别的数量；j表示第j个目标；λij为第i个目标第j个类别1-IOU值；表示第i个目标第j个类别是否为目标；pij表示i个目标第j个类别置信度。S240、根据教师预测框、学生预测框和样本图像的标注框，分别确定指导损失函数和被指导损失函数。S250、根据指导损失函数确定指导目标，提取指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取被指导目标的被指导特征。指导目标和被指导目标为不同的待检测目标。S260、根据指导特征和被指导特征，确定蒸馏损失。S270、根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；目标检测模型用于对待检测图像进行目标检测，以从待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定违禁物目标的类别信息和位置信息。本实施例的技术方案，在通过样本图像的标注分类信息和标注框对待训练教师模型和待训练学生模型进行训练时，根据教师预测分类信息、学生预测分类信息、教师预测框和样本图像的标注框的第一交并比，以及学生预测框和样本图像的标注框的第二交并比，对样本图像的标注分类信息进行调整，得到调整后的标注分类信息，根据调整后的标注分类信息，确定分类损失，以根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，确定用于对待检测图像中的违禁物品进行检测的目标检测模型。解决了样本图像的标注分类信息存在错误的情况下，导致的后续训练获得的目标检测模型的模型准确度较低的问题。提高了分类损失的精确度，从而提高了目标检测模型的模型精确度。实施例三图3为本发明实施例三提供的一种目标检测方法的流程图，本实施例在上述实施例的基础上进行了优化，给出了一种确定待训练教师模型和待训练学生模型的优选实施方式。具体的，如图3所示，该方法包括：S310、根据候选模型的检出率、推理速度、网络结构和模型参数量，从候选模型中确定原始教师模型和原始学生模型。其中，检出率是指候选模型对违禁物品检查出来的比例。可以根据编译器获取候选模型的推理速度。具体的，选择检出率高，推理速度慢，网络结构复杂和模型参数量多的候选模型作为原始教师模型；选择检出率一般或者偏差、推理速度快，网络结构简单和模型参数少的候选模型作为原始学生模型。S320、对原始教师模型的教师模型参数进行初始化，确定待训练教师模型。示例性的，可以对原始教师模型进行模型迭代训练，根据模型迭代训练的结果确定原始教师模型的原始模型损失函数；当原始损失函数的稳定性满足函数稳定条件时，结束对原始教师模型的模型迭代训练；对完成模型迭代训练的原始教师模型的教师模型参数进行初始化，确定待训练教师模型。具体的，对原始教师模型进行模型迭代训练，并根据每次模型迭代训练的训练结果确定原始教师模型的模型损失函数的稳定性，当模型损失函数的稳定性满足预设的函数稳定条件时，确定原始教师模型收敛，停止对原始教师模型的模型迭代训练。对完成模型迭代训练的原始教师模型的教师模型参数进行初始化，确定待训练教师模型。可以理解的是，在原始教师模型的原始损失函数的稳定性满足函数稳定性条件时，原始教师模型收敛，再根据满足函数稳定条件的原始教师模型确定待训练教师模型，可以提高待训练教师模型的稳定性。S330、从公开数据预训练模型的训练模型参数中提取与教师模型参数一致的公共模型参数，对公共模型参数赋值，根据赋值后的公共模型参数和原始学生模型，确定待训练学生模型。其中，公开数据预训练模型是指现有的目标检测模型或分类模型。具体的，从公开数据预训练模型的训练模型参数中确定并提取出与待训练教师模型的教师模型参数一致的公共模型参数，并基于教师模型参数对公共模型参数进行赋值，根据赋值后的公共模型参数和原始学生模型，确定待训练学生模型，以完成对原始学生模型的初始化。S340、通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息。S350、根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和样本图像的标注分类信息，确定分类损失。S360、根据教师预测框、学生预测框和样本图像的标注框，分别确定指导损失函数和被指导损失函数。S370、根据指导损失函数确定指导目标，提取指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取被指导目标的被指导特征。指导目标和被指导目标为不同的待检测目标。S380、根据指导特征和被指导特征，确定蒸馏损失。S390、根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；目标检测模型用于对待检测图像进行目标检测，以从待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定违禁物目标的类别信息和位置信息。本实施例的技术方案，提供了一种从候选模型中确定原始教师模型和原始学生模型，并对原始教师模型和原始学生模型进行初始化，确定待训练教师模型和待训练学生模型的方法。上述方案，可以保证待训练教师模型和待训练学生模型的模型稳定性，从而提高目标检测模型的模型稳定性。实施例四图4为本发明实施例四提供的一种目标检测装置的结构示意图。本实施例可适用于对教师模型和学生模型进行训练，并根据训练结果确定目标检测模型，以根据目标检测模型对待检测图像进行目标检测的情况。如图4所示，该目标检测装置包括：目标检测模块410、分类损失确定模块420、损失函数确定模块430、指导特征确定模块440、蒸馏损失确定模块450和目标检测模型确定模块460。其中，目标检测模块410，用于通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；分类损失确定模块420，用于根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和样本图像的标注分类信息，确定分类损失；损失函数确定模块430，用于根据教师预测框、学生预测框和样本图像的标注框，分别确定指导损失函数和被指导损失函数；指导特征确定模块440，用于根据指导损失函数确定指导目标，提取指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；蒸馏损失确定模块450，用于根据指导特征和被指导特征，确定蒸馏损失；目标检测模型确定模块460，用于根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；目标检测模型用于对待检测图像进行目标检测，以从待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定违禁物目标的类别信息和位置信息。本实施例提供的技术方案，通过待训练教师模型和待训练学生模型，分别对样本图像中的待检测目标进行目标检测，得到教师预测框、教师预测分类信息、学生预测框和学生预测分类信息；根据教师预测框、学生预测框、教师预测分类信息、学生预测分类信息、样本图像的标注框和样本图像的标注分类信息，确定分类损失；根据教师预测框、学生预测框和样本图像的标注框，分别确定指导损失函数和被指导损失函数；根据指导损失函数确定指导目标，提取指导目标的指导特征，且根据被指导损失函数确定被指导目标，提取被指导目标的被指导特征；指导目标和被指导目标为不同的待检测目标；根据指导特征和被指导特征，确定蒸馏损失；根据分类损失和蒸馏损失，对待训练教师模型和待训练学生模型进行训练，根据训练结果确定目标检测模型；目标检测模型用于对待检测图像进行目标检测，以从待检测图像的候选检测目标中确定违禁物品对应的违禁物目标，并确定违禁物目标的类别信息和位置信息。解决了在教师模型和学生模型的训练过程中，只有学生模型参与训练，导致教师模型的检测能力无法在训练过程中得到提高的问题。上述方案，实现了在训练目标检测模型时，使待训练教师模型和待训练学生模型同时进行模型训练，使得待训练教师模型和待训练学生模型的检测能力在训练过程中均能够不断提高，提高了对待训练教师模型和待训练学生模型进行模型训练的灵活性，以及待训练学生模型的鲁棒性，同时提高了目标检测模型的模型精确度。采用目标检测模型对待检测图像进行目标检测，可以提高对待检测图像的检测效率，同时提高获取的违禁物目标的类别信息和位置信息的准确性。示例性的，上述目标检测装置，还包括：教师模型更新模块，用于若目标检测模型对应的待训练学生模型的模型准确率大于准确率阈值，则将目标检测模型对应的待训练学生模型作为下一轮模型训练过程中的待训练教师模型。示例性的，分类损失确定模块420包括：标注分类信息调整单元，用于根据教师预测分类信息、学生预测分类信息、教师预测框和样本图像的标注框的第一交并比，以及学生预测框和样本图像的标注框的第二交并比，对样本图像的标注分类信息进行调整，得到调整后的标注分类信息；分类损失确定单元，用于根据调整后的标注分类信息，确定分类损失。示例性的，标注分类信息调整单元具体用于：若教师预测类别和学生预测类别一致，且教师置信度和学生置信度均大于置信度阈值，则确定教师预测框和学生预测框的预测框交并比若预测框交并比大于第一阈值，且教师预测框和样本图像的标注框的第一交并比以及学生预测框和样本图像的标注框的第二交并比均大于或等于第二阈值，则根据教师预测分类信息和学生预测分类信息，对样本图像的标注分类信息进行调整，得到调整后的标注分类信息。示例性的，蒸馏损失确定模块450，具体用于：确定指导特征的特征损失函数和被指导特征的特征损失函数之间的特征损失函数，以及指导特征的特征相关性和被指导特征的特征相关性之间的相关性差值；根据特征损失函数和相关性差值，确定蒸馏损失。示例性的，损失函数确定模块430，具体用于：根据教师预测框、学生预测框和样本图像的标注框，分别确定教师预测框损失函数和学生预测框损失函数；根据教师预测框损失函数和学生预测框损失函数的比较结果，从教师预测框损失函数和学生预测框损失函数中确定指导损失函数和被指导损失函数。示例性的，上述目标检测装置还包括：原始模型确定模块，用于根据候选模型的检出率、推理速度、网络结构和模型参数量，从候选模型中确定原始教师模型和原始学生模型；教师模型确定模块，用于对原始教师模型的教师模型参数进行初始化，确定待训练教师模型；学生模型确定模块，用于从公开数据预训练模型的训练模型参数中提取与教师模型参数一致的公共模型参数，对公共模型参数赋值，根据赋值后的公共模型参数和原始学生模型确定待训练学生模型。示例性的，教师模型确定模块具体用于：对原始教师模型进行模型迭代训练，根据模型迭代训练的结果确定原始教师模型的原始模型损失函数；当原始损失函数的稳定性满足函数稳定条件时，结束对原始教师模型的模型迭代训练；对完成模型迭代训练的原始教师模型的教师模型参数进行初始化，确定待训练教师模型。本实施例提供的目标检测装置可适用于上述任意实施例提供的模型训练方法，具备相应的功能和有益效果。实施例五图5示出了可以用来实施本发明的实施例的电子设备10的结构示意图。电子设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本发明的实现。如图5所示，电子设备10包括至少一个处理器11，以及与至少一个处理器11通信连接的存储器，如只读存储器12、随机访问存储器13等，其中，存储器存储有可被至少一个处理器执行的计算机程序，处理器11可以根据存储在只读存储器12中的计算机程序或者从存储单元18加载到随机访问存储器13中的计算机程序，来执行各种适当的动作和处理。在RAM 13中，还可存储电子设备10操作所需的各种程序和数据。处理器11、ROM 12以及RAM 13通过总线14彼此相连。输入/输出接口15也连接至总线14。电子设备10中的多个部件连接至I/O接口15，包括：输入单元16，例如键盘、鼠标等；输出单元17，例如各种类型的显示器、扬声器等；存储单元18，例如磁盘、光盘等；以及通信单元19，例如网卡、调制解调器、无线通信收发机等。通信单元19允许电子设备10通过诸如因特网的计算机网络和/或各种电信网络与其他设备交换信息/数据。处理器11可以是各种具有处理和计算能力的通用和/或专用处理组件。处理器11的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的处理器、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。处理器11执行上文所描述的各个方法和处理，例如目标检测方法。在一些实施例中，目标检测方法可被实现为计算机程序，其被有形地包含于计算机可读存储介质，例如存储单元18。在一些实施例中，计算机程序的部分或者全部可以经由ROM 12和/或通信单元19而被载入和/或安装到电子设备10上。当计算机程序加载到RAM 13并由处理器11执行时，可以执行上文描述的目标检测方法的一个或多个步骤。备选地，在其他实施例中，处理器11可以通过其他任何适当的方式而被配置为执行目标检测方法。本文中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、负载可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本发明的方法的计算机程序可以采用一个或多个编程语言的任何组合来编写。这些计算机程序可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器，使得计算机程序当由处理器执行时使流程图和/或框图中所规定的功能/操作被实施。计算机程序可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本发明的上下文中，计算机可读存储介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的计算机程序。计算机可读存储介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。备选地，计算机可读存储介质可以是机器可读信号介质。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在电子设备上实施此处描述的系统和技术，该电子设备具有：用于向用户显示信息的显示装置或者LCD监视器）；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给电子设备。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网、区块链网络和互联网。计算系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，又称为云计算服务器或云主机，是云计算服务体系中的一项主机产品，以解决了传统物理主机与VPS服务中，存在的管理难度大，业务扩展性弱的缺陷。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发明中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本发明的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
