标题title
一种城市地面沉降自动识别和分类方法
摘要abst
本发明属于地质灾害领域，公开了一种城市地面沉降自动识别和分类方法，包括以下步骤：构建二层混合网络，利用多重点提取技术识别SAR图像中的高相干点和低相干点；对高相干点和低相干点进行克里金插值，获得InSAR形变速度图，并从中分离出局部沉降及对应的InSAR局部形变速度图；基于InSAR局部形变速度图，构建基于多源数据的局部沉降样本集；基于多通道金字塔结构对InSAR形变速度和局部沉降样本集进行特征提取，获得特征图像；构建地面沉降识别分类模型，将特征图像输入到所述地面沉降识别分类模型中进行特征提取，实现地面沉降的识别和分类。本发明为构建智能化、现代化地质灾害分析预警提供了技术支持。
权利要求书clms
1.一种城市地面沉降自动识别和分类方法，其特征在于，包括以下步骤：构建二层混合网络，基于所述二层混合网络，利用多重点提取技术识别SAR图像中的高相干点和低相干点；对所述高相干点和低相干点进行克里金插值，获得InSAR形变速度图，并从中分离出局部沉降及对应的InSAR局部形变速度图；基于所述InSAR局部形变速度图，构建基于多源数据的局部沉降样本集；基于多通道金字塔结构对所述局部沉降样本集和InSAR形变速度进行特征提取，获得特征图像，所述InSAR形变速度基于所述InSAR形变速度图获得；构建初始地面沉降识别分类模型，基于所述局部沉降样本集对所述初始地面沉降识别分类模型进行训练，获得目标地面沉降识别分类模型；将所述特征图像输入到所述目标地面沉降识别分类模型中进行特征提取，实现地面沉降的识别和分类。2.根据权利要求1所述的城市地面沉降自动识别和分类方法，其特征在于，获得SAR图像的过程包括：对多基线SLC图像进行配准，并对配准后的图像进行差分干涉测量，获得SAR图像。3.根据权利要求1所述的城市地面沉降自动识别和分类方法，其特征在于，利用多重点提取技术识别高相干点和低相干点的过程包括：在所述二层混合网络的第一层网络中，设定初始振幅离差阈值，获取高质量高相干点；基于所述高质量高相干点，构建Delaunay三角网和自适应加密网，进而对相邻的高质量高相干点进行相位差分处理，获得差分干涉图，进而获得所述高质量相干点的高度和形变速度信息；在所述二层混合网络的第二层网络中，以第一层网络探测的高质量高相干点为参考点，从SAR影像四个角点作为起始点多方向构建局部星网；基于所述局部星网拓展剩余的高相干点和全部低相干点，并基于坡度运动的方向获得全部高相干点和低相干点垂直向下方向的高度和形变速度信息。4.根据权利要求3所述的城市地面沉降自动识别和分类方法，其特征在于，获得差分干涉图的过程包括：采用M估计器和岭估计器对待估计的高度和形变速度信息的传感矩阵进行参数估计，并结合重建的后向散射系数，获得所述差分干涉图。5.根据权利要求3所述的城市地面沉降自动识别和分类方法，其特征在于，识别全部低相干点的过程包括：在所述二层混合网络的第二层网络中，基于KS检验方法识别同质点，并利用权重因子对协方差矩阵进行估计，进而基于相干系数的Phase-Linking方法估计相位，获得全部低相干点；其中，权重因子的获取过程包括：引入SAR影像中的第一像素点和第二像素点，并获取两个像素点的统计距离和空间距离，利用核函数将所述统计距离和空间距离相结合，获得权重因子；其中，所述统计距离即两个像素点最大的经验分布函数绝对差值，所述空间距离即两个像素点的欧氏距离。6.根据权利要求1所述的城市地面沉降自动识别和分类方法，其特征在于，分离出局部沉降的过程包括：基于二维快速傅里叶变换将所述InSAR形变速度图从空间域转化到频率域，进而利用带通滤波分离区域沉降和局部沉降。7.根据权利要求1所述的城市地面沉降自动识别和分类方法，其特征在于，构建基于多源数据的局部沉降样本集的过程包括：预设局部沉降的满足条件，在所述InSAR局部形变速度图中筛选局部沉降样本，并基于沉降的空间特征及辅助数据的相关性，对所述局部沉降样本附上类别标签。8.根据权利要求1所述的城市地面沉降自动识别和分类方法，其特征在于，构建初始地面沉降识别分类模型的过程包括：引入预测的候选区域的中心坐标、预测的有向候选区域的外接矩形的高度和宽度以及外接矩形顶部和右侧中点的偏移量，对有向区域预测网络进行描述，进而生成高质量的旋转候选框；基于所述旋转候选框和所述特征图像，对所述旋转候选框的位置进行修正，获得准确的位置和类别，进而完成初始地面沉降识别分类模型的构建。9.根据权利要求1所述的城市地面沉降自动识别和分类方法，其特征在于，基于所述局部沉降样本集对所述地面沉降识别分类模型进行训练的过程包括：在所述InSAR形变速度图设置检测框和标注框，当一个检测框与任何一个标注框的交叉联合重叠超过第一预设阈值，或所述检测框与一个标注框有最高的面积重叠且所述面积重叠高于第二预设阈值，则所述检测框为沉降目标；否则，所述检测框为背景；其中，所述面积阈值为检测框和标注框的并集的面积与检测框和标注框的交集的面积的比值。10.根据权利要求1所述的城市地面沉降自动识别和分类方法，其特征在于，所述目标地面沉降识别分类模型的损失函数L1定义为：其中，N是样本个数，Fcls是交叉熵损失，衡量标注的标签和网络预测的标签pi之间的差异，Freg是平滑L1损失，衡量网络输出的检测框δi和标注框/＞之间的偏移。/＞
说明书desc
技术领域本发明属于地质灾害领域，特别是涉及一种城市地面沉降自动识别和分类方法。背景技术地面沉降是由地下固体或流体开采引起的地球表面缓慢下沉的现象，严重时可能会引发地面开裂、高楼倒塌、海水倒灌等地质灾害。因此，实现大范围地面沉降的自动识别和分类对于评估潜在的地质灾害和提高区域的抗灾能力至关重要。近年来，在地面沉降监测方面，DSInSAR技术显著提高了形变监测的时空分辨率和数据处理精度。但是，随着InSAR监测点密度的增加，当应用到大尺度形变监测时，人工分析往往耗时耗力。目前，多数研究仍依赖传统的阈值、聚类、hot-spot-like等方法对InSAR结果进行分析，但是可行度不高而且效率低下。因此，如何高效智能地对InSAR结果进行后处理和分析迫在眉睫。发明内容本发明的目的是提供一种城市地面沉降自动识别和分类方法，结合InSAR形变监测结果和多源辅助数据，实现对地面沉降的自动识别和分类，大大提高了地质灾害早期识别的可行性和效率，以解决上述现有技术存在的问题。为实现上述目的，本发明提供了一种城市地面沉降自动识别和分类方法，包括以下步骤：构建二层混合网络，基于所述二层混合网络，利用多重点提取技术识别SAR图像中的高相干点和低相干点；对所述高相干点和低相干点进行克里金插值，获得InSAR形变速度图，并从中分离出局部沉降及对应的InSAR局部形变速度图；基于所述InSAR局部形变速度图，构建基于多源数据的局部沉降样本集；基于多通道金字塔结构对InSAR形变速度和所述局部沉降样本集进行特征提取，获得特征图像；构建初始地面沉降识别分类模型，基于所述局部沉降样本集对所述地面沉降识别分类模型进行训练，获得目标地面沉降识别分类模型；将所述特征图像输入到所述目标地面沉降识别分类模型中进行特征提取，实现地面沉降的识别和分类。可选的，获得SAR图像的过程包括：对多基线SLC影像进行配准，并对配准后的图像进行差分干涉测量，获得SAR图像。可选的，利用多重点提取技术识别高相干点和低相干点的过程包括：在第一层网络中，设定初始振幅离差阈值，获取高质量高相干点；基于所述高质量高相干点，构建Delaunay三角网和自适应加密网，进而对相邻的高质量高相干点进行相位差分处理，获得差分干涉图，进而获得所述高质量相干点的高度和形变速度信息；在第二层网络中，以第一层网络探测的高质量高相干点为参考点，从SAR影像四个角点作为起始点多方向构建局部星网；基于所述局部星网拓展剩余的高相干点和全部低相干点，并基于坡度运动的方向获得全部高相干点和低相干点垂直向下方向的高度和形变速度信息。可选的，获得差分干涉图的过程包括：采用M估计器和岭估计器对待估计的高度和形变速度信息的传感矩阵进行参数估计，并结合重建的后向散射系数，获得所述差分干涉图。可选的，识别全部低相干点的过程包括：在第二层网络中，基于KS检验方法识别同质点，并利用权重因子对协方差矩阵进行估计，进而基于相干系数的Phase-Linking方法估计相位，获得全部低相干点；其中，权重因子的获取过程包括：引入第一像素点和第二像素点，并获取两个像素点的统计距离和空间距离，利用核函数将所述统计距离和空间距离相结合，获得权重因子；所述统计距离即两个像素点最大的经验分布函数绝对差值，所述空间距离即两个像素点的欧氏距离。可选的，分离出局部沉降的过程包括：基于二维快速傅里叶变换将所述InSAR形变速度图从空间域转化到频率域，进而利用带通滤波分离区域沉降和局部沉降。可选的，构建基于多源数据的局部沉降样本集的过程包括：预设局部沉降区域满足条件，在所述InSAR局部形变速度图中筛选局部沉降样本，并基于沉降的空间特征及辅助数据的相关性，对所述局部沉降样本附上类别标签。可选的，构建初始地面沉降识别分类模型的过程包括：引入预测的候选区域的中心坐标、预测的有向候选区域的外接矩形的高度和宽度以及外接矩形顶部和右侧中点的偏移量，对有向区域预测网络进行描述，进而生成高质量的旋转候选框；基于所述旋转候选框和所述特征图像，对所述旋转候选框的位置进行修正，进而获得准确的位置和类别。可选的，基于所述局部沉降样本集对所述地面沉降识别分类模型进行训练的过程包括：当一个检测框与任何一个标注框的交叉联合重叠超过第一预设阈值，或所述检测框与一个标注框有最高的面积重叠且所述面积重叠高于第二预设阈值，则所述检测框为沉降目标；否则，所述检测框为背景；其中，所述面积阈值为检测框和标注框的并集的面积与检测框和标注框的交集的面积的比值。可选的，所述目标地面沉降识别分类模型的损失函数L1定义为：其中，N是样本个数，Fcls是交叉熵损失，衡量标注的标签和网络预测的标签pi之间的差异，Freg是平滑L1损失，衡量网络输出的检测框δi和标注框/＞之间的偏移。本发明的技术效果为：InSAR技术的进步可以生成大量形变测量点，这使得进行地质灾害评估非常耗时耗力，因此本发明提出了一种基于多尺度旋转检测框的多通道深度卷积神经网络模型，该模型集成了InSAR测量和多源辅助数据，实现了对区域沉降和局部沉降的分离和局部沉降的自动识别、分类，为大数据技术构建智能化、现代化地质灾害分析预警提供了技术支持。附图说明构成本申请的一部分的附图用来提供对本申请的进一步理解，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。在附图中：图1为本发明实施例中的InSAR多重点提取技术的提取流程图；图2为本发明实施例中的基于尺度旋转框深度卷积神经网络的地面沉降识别分类模型结构示意图。具体实施方式需要说明的是，在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。下面将参考附图并结合实施例来详细说明本申请。需要说明的是，在附图的流程图示出的步骤可以在诸如一组计算机可执行指令的计算机系统中执行，并且，虽然在流程图中示出了逻辑顺序，但是在某些情况下，可以以不同于此处的顺序执行所示出或描述的步骤。实施例一如图1所示，本实施例中提供一种城市地面沉降自动识别和分类方法，包括：步骤一：适用于大范围形变稳健监测的InSAR多重点提取技术考虑到沉降区域大气相位时空分布复杂的情况，本实施例通过构建二层网络和引入稳健估计器提高形变估计的精度和稳定性。另外，为了解决大范围探测时非城区失相干导致的测量点缺失问题，本实施例采用多重点提取技术联合探测高相干PS点和低相干DS点，通过基于相干系数的Phase-Linking算法重建相位和CPU/GPU并行解算参数，在保证估计精度和稳健性的前提下快速反演精细化形变信息。具体而言，在SRTM DEM图像的辅助下，对多基线的哨兵一号单视复合体图像进行严格配准，接着采用8×2的多视对配准后的图像进行差分干涉测量。为了减轻干涉图中的分层大气效应，本实施例使用了通用大气校正产品GACOS的数据在干涉处理时进行相位补偿。针对大范围形变的监测，本实施例设计了一种基于二层混合网络的InSAR多重点提取方法来识别PS和DS点，它无需在整个研究区域进行预先的大气信号移除。在第一层网络中，设定初始振幅离差阈值选取高质量PS候选点，然后将其连接在密集的Delaunay三角网中。对两个相邻的PS候选点进行相位差分后，信号模型可以表示为：y＝AΥ其中，y＝T表示差分干涉图，Υ是重建的后向散射系数，A代表包含待估计的高度和形变速度信息的传感矩阵。为了减小相位解缠的误差，采用鲁棒的M估计器对高度和形变速度信息进行参数估计，构网时弧段是否保留由时间相干系数PSt1＝0.72决定。然后本实施例通过网络调整来整合相对参数，采用了岭估计器减少平差矩阵的条件数，从而提高平差运算的稳定性。第二层网络利用第一层网络探测的PS点作为参考，构建局部星网以扩展剩余的PS点和所有的DS点。为了保证最大限度探测相干目标点，第二层网络扩展将分别从SAR影像四个角点作为起始点进行多方向扩展，此外，新识别的PS点将及时更新为参考点以实现空间连续扩展。对于DS点的探测，本实施例采用简单的KS检验方法识别同质点，传统协方差矩阵估计时只考虑了统计信息没有考虑空间信息，为了提高协方差矩阵估计的准确性，本实施例引入两个像素点的统计距离和空间距离作为权重估计协方差矩阵。统计距离表示两个像素点最大的经验分布函数绝对差值，空间距离表示两个像素点的欧氏距离，利用核函数将两者结合计算出一个权重因子用于协方差矩阵C的估计：其中，Ω为同质点集合；Z为复数观测值向量；Ψ为包含两两影像干涉相位的复矩阵；w为权重因子；d为空间距离；σ为统计距离；rd和rσ为尺度因子。在获得加权协方差矩阵后，SqueeSAR使用Broyden-Fletcher-Goldfarb-Shanno算法对相位进行最大似然估计。但这种算法需要对协方差矩阵求逆，但协方差矩阵有可能不是正定矩阵，它保证不了矩阵可逆。为了解决这个问题，本实施例利用更高效的基于相干系数的Phase-Linking方法估计相位。用于识别其他PS点和DS点的时间相干性阈值分别设定为PSt2＝0.7和DSt2＝0.65。最后，本实施例计算了所有PS点和DS点沿视线方向的形变速度和时间序列形变。假定地表形变是由土地沉降主导的，本实施例将LOS向形变除以cosθ将其转化为垂直形变。在陡峭地区，本实施例假定坡度运动沿垂直向下的方向，通过坡度将LOS向形变转换为垂直向下的形变。步骤二：分离叠加存在的区域型沉降和局部型沉降在沉积物固结和人类活动的共同作用下，沿海的三角洲地区往往更容易受到区域和局部沉降的共同影响。区域型沉降可以从InSAR形变速度图中直接识别；然而，局部沉降的探测非常耗时，因为它们分布广泛，形状多样。此外，区域型沉降往往和局部型沉降叠加存在，这会使局部型沉降被掩盖，潜在的地质灾害无法被及时发现。为了便于识别局部沉降，本实施例在形变速度图中将区域沉降和局部沉降分开。本实施例对PS/DS点进行克里金插值，并输出空间分辨率为60米的InSAR形变速度图。为避免插值的不确定性，本实施例只保留了与PS/DS点相邻的像素，缓冲区为100米，用于后续处理。基于区域性沉降具有低频率，而局部沉降具有高频率的性质，本实施例使用二维快速傅里叶变换将InSAR形变速度图从空间域转化到频率域，接着通过带通滤波来分离区域和局部沉降。此外，考虑到严重的对流层影响会引起具有极高频率的尖峰噪声，本实施例在FFT处理中剔除了极高频率的信号。考虑到Sentinel-1图像的空间分辨率，算法在频域图像中使用了20×20像素和300×300像素的两个窗口来分解长、中、短波长的信号。得出的信号的空间波长分别为＞3570米、238-3570米、＜238米，对应于区域沉降、局部沉降和噪声。步骤三：构建基于多源数据的局部沉降样本集除了InSAR形变监测结果，本实施例还收集了其他四类与沉降相关的辅助数据，包括地质岩性数据，土地覆盖数据，地形数据和气候数据。这些数据将共同用于网络的训练。考虑到InSAR形变速度图上局部沉降区域的大小、方向、形状均变化各异，本实施例使用了旋转检测框来更准确地标识沉降样本的范围。此外，本实施例还为每一个沉降样本分配了一个类别，总共有七个类别：沉积物固结、填海沉降、建筑沉降、农田沉降、鱼塘沉降、滑坡运动和未分类，如表1所示：表1具体而言，标注局部沉降样本的步骤为：①以InSAR形变速度图为参考，将所有数据投影到同一坐标系WGS84_50N，并重新进行采样；②在分离出的InSAR局部形变速度图中，进行局部沉降样本的筛选，若某个区域满足以下条件：a)呈现“沉降碗”特征，即从中心到四周沉降速度由大变小，且最大沉降速度大于25毫米/年；b)最小外接矩形的面积介于0.05-5.5平方千米之间；c)在多源辅助数据中可找到沉降的驱动因子，则该区域被认为是局部沉降区；③对标注的局部沉降样本附上类别标签，其类别的确定主要取决于沉降的空间特征及其与辅助数据的相关性。例如，如果标注出的沉降同时位于软土沉积区域和人工地表，而其边界与人工地表高度相关，则将其标定为建筑沉降。步骤四：融合InSAR和多源辅助数据的多通道金字塔结构提取特征如上文所述，本实施例共涉及11个数据集，包括InSAR形变速度、地质岩性数据，土地覆盖数据，地形数据和气候数据，在自然图像处理中输入通常为三通道，为了使各个数据集、包含的特征可以实现有效融合，本实施例设计了多通道金字塔结构提取特征，网络的每个输入通道对应一个特定数据集。考虑到不同数据集包含不同的语义特征，本实施例中的多通道金字塔结构通过连续上采样和跨层融合机制使输出的特征兼具底层的视觉信息和高层的语义信息。步骤五：构建基于多尺度旋转框深度卷积神经网络的地面沉降识别分类模型如图2所示，模型分为两个阶段，第一阶段主要生成高质量的旋转候选框，第二个阶段用于对旋转候选框的位置进行修正，得到准确的位置和类别。第一阶段有向区域预测网络中采用六个参数用于对一个候选区域进行有效描述。是预测的候选区域的中心坐标，是预测的有向候选区域的外接矩形的高度和宽度，：是外接矩形顶部和右侧中点的偏移量。通过在步骤四中得到的特征图上的每个位置，有向区域预测网络均生成了3个旋转候选框，因此其回归分支包含6×3＝18个输出，这些回归输出将被进一步解码。通过这六个参数，本实施例可以不引入多余的网络结构，生成高质量的旋转候选框。第二阶段将采用在步骤四中生成的特征图和第一阶段生成的一系列候选框作为输入，通过对旋转候选框的位置进行修正，得到准确的位置和类别。具体而言，使用旋转RoI对齐方法从匹配的特征图中提取旋转不变的固定尺寸的特征向量，每个特征向量均被输入两个完全连接层，最终输出该候选框属于K+1类的概率，以及其对K类对象的位置偏移量。步骤六：利用步骤三中构建的沉降监测多源数据样本集对步骤五中的识别模型进行训练，将步骤四中的融合特征输入步骤五中的识别模型中进行特征提取，从而实现地面沉降的大范围识别和分类。为了训练网络，本实施例对沉降目标和背景分别进行了定义。当一个检测出的旋转框与任何一个标注框的交叉联合重叠超过0.5，或者它与一个标注框有最高的IoU重叠且IoU高于0.3，则该检测框被认为是一个沉降目标；否则，它被认为是背景。此外，如果检测到的旋转框没有对应任何标注框，这个沉降目标就被认为是漏检。area代表检测框和标注框的并集的面积，rea代表检测框和标注框的交集的面积。基于此，目标地面沉降识别分类模型的损失函数L1定义为：其中，N是样本个数，Fcls是交叉熵损失，衡量标注的标签和网络预测的标签pi之间的差异，Freg是平滑L1损失，衡量网络输出的检测框δi和标注框/＞之间的偏移。模型以端对端的方式进行训练，使用随机梯度下降同时优化步骤五中的第一和第二阶段网络。在推理过程中，网络倾向于生成高度重叠的有向候选框。在第一阶段，本发明保留了特征金字塔每层的2000个候选框，并通过非极大值抑制以减少冗余。在第二阶段，多边形NMS中IoU的阈值设定为0.1。步骤七：网络训练完成后，输入一组多通道图像，即可检测出局部沉降的位置和类别作为输出。InSAR技术的进步可以生成大量形变测量点，这使得对其进行地质灾害评估非常耗时耗力。本实施例提出的一种基于多尺度旋转检测框的多通道深度卷积神经网络模型，该模型集成了InSAR测量和多源辅助数据，实现了对区域沉降和局部沉降的分离和局部沉降的自动识别、分类，为大数据技术构建智能化、现代化地质灾害分析预警提供了技术支持。以上所述，仅为本申请较佳的具体实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本申请的保护范围之内。因此，本申请的保护范围应该以权利要求的保护范围为准。
