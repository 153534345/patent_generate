标题title
一种电子印章快速溯源管理方法
摘要abst
本发明涉及电子数字数据处理技术领域，具体涉及一种电子印章快速溯源管理方法，包括：根据目标文档中的词汇获取秘密数据序列，获取电子印章二值矩阵的每个二值分块矩阵的异或矩阵，对秘密数据序列进行分割获取每个二值分块矩阵的待嵌入数据序列以及目标余数，根据权重值以及异或矩阵获取目标余数与二值分块矩阵的差异度，进而获取权重矩阵中每个位置的权重优选度，根据权重优选度为权重矩阵中每个位置分配权重值，根据权重矩阵对电子印章图像进行秘密数据序列嵌入，进而进行文档用印，对电子文档中的电子印章进行验证溯源。本发明嵌入秘密数据序列之后的电子印章图像中的变化非常小，嵌入效果好，确保了电子印章可溯源。
权利要求书clms
1.一种电子印章快速溯源管理方法，其特征在于，该方法包括以下步骤：获取电子印章二值矩阵；根据目标文档中的词汇获取秘密数据序列；预设密钥，将电子印章二值矩阵分割为多个与密钥/＞大小相同的二值分块矩阵；将每个二值分块矩阵与密钥/＞进行异或操作，得到每个二值分块矩阵的异或矩阵；对秘密数据序列进行分割获取每个二值分块矩阵的待嵌入数据序列；将待嵌入数据序列转换为十进制数，作为目标余数；根据待嵌入数据序列的长度以及二值分块矩阵的大小获取所有权重值，根据权重值以及每个二值分块矩阵的异或矩阵获取每个二值分块矩阵的目标余数与二值分块矩阵的差异度；初始化权重矩阵，根据每个二值分块矩阵的目标余数与二值分块矩阵的差异度以及每个分块二值矩阵的异或矩阵，获取权重矩阵中每个位置的权重优选度；根据权重优选度为权重矩阵中每个位置分配权重值，得到最终的权重矩阵；利用密钥以及最终的权重矩阵向电子印章二值矩阵的每个二值分块矩阵中嵌入对应的待嵌入数据序列，得到嵌入秘密数据序列的电子印章图像；将嵌入秘密数据序列的电子印章图像加盖在目标文档上，实现目标文档用印；对电子文档中的电子印章进行验证溯源。2.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述获取电子印章二值矩阵，包括的具体步骤如下：获取电子印章图像的R通道的图像，将R通道的图像中的像素值255置为1，像素值0保持不变，得到一个二维的二值矩阵，作为电子印章二值矩阵。3.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述根据目标文档中的词汇获取秘密数据序列，包括的具体步骤如下：利用TF-IDF算法获取目标文档中每个词汇的TF-IDF值，作为每个词汇的关键指标，将关键指标最大的若干个词汇作为秘密消息；将秘密消息编码成二进制形式，得到秘密数据序列。4.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述对秘密数据序列进行分割获取每个二值分块矩阵的待嵌入数据序列，包括的具体步骤如下：将秘密数据序列分割为若干个长度为的二进制序列，其中为二值分块矩阵的大小，/＞为向下取整符号；将每个二进制序列依次作为每个二值分块矩阵的待嵌入数据序列。5.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述根据待嵌入数据序列的长度以及二值分块矩阵的大小获取所有权重值，包括的具体步骤如下：将待嵌入数据序列的长度记为，将/＞中的每个整数分别作为一种权重值；将二值分块矩阵的大小记为/＞，获取每种权重值出现的次数：第1种到第种权重值出现的次数分别为/＞，其余每种权重值出现的次数分别为/＞，其中/＞为取余符号，/＞为向下取整符号；根据每种权重值出现的次数获取所有权重值。6.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述根据权重值以及每个二值分块矩阵的异或矩阵获取每个二值分块矩阵的目标余数与二值分块矩阵的差异度，包括的具体步骤如下：其中，为第/＞个二值分块矩阵的目标余数与二值分块矩阵的差异度；/＞为第/＞个二值分块矩阵的目标余数；/＞为二值分块矩阵的待嵌入数据序列的长度；/＞为所有权重值的平均权重值大小；/＞为第/＞个二值分块矩阵的异或矩阵中值为1的元素数量；/＞为取余符号。7.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述获取权重矩阵中每个位置的权重优选度，包括的具体步骤如下：获取每个二值分块矩阵的每个位置的权重系数：其中，为第/＞个二值分块矩阵的第/＞个位置的权重系数；/＞为第/＞个二值分块矩阵的目标余数与二值分块矩阵的差异度；/＞为二值分块矩阵的待嵌入数据序列的长度；/＞为第/＞个二值分块矩阵的异或矩阵中的第/＞个位置的元素值；/＞为以自然常数为底的指数函数，/＞为绝对值符号；将所有二值分块矩阵的同一个位置的权重系数相加作为权重矩阵中对应位置的权重优选度。8.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述根据权重优选度为权重矩阵中每个位置分配权重值，得到最终的权重矩阵，包括的具体步骤如下：按照权重优选度从大到小的顺序，将所有权重值从大到小依次分配给权重矩阵中每个位置，得到最终的权重矩阵。9.根据权利要求2所述的一种电子印章快速溯源管理方法，其特征在于，所述利用密钥以及最终的权重矩阵向电子印章二值矩阵的每个二值分块矩阵中嵌入对应的待嵌入数据序列，得到嵌入秘密数据序列的电子印章图像，包括的具体步骤如下：根据分块隐藏算法，利用密钥以及最终的权重矩阵，向电子印章二值矩阵的每个二值分块矩阵中嵌入对应的待嵌入数据序列，将嵌入待嵌入数据序列之后的二值分块矩阵作为嵌入矩阵，将所有嵌入矩阵合并成的大矩阵作为嵌入图像；将嵌入图像中的像素值1置为255，像素值0保持不变，利用得到的图像替换电子印章图像中的R通道的图像，得到嵌入秘密数据序列的电子印章图像。10.根据权利要求1所述的一种电子印章快速溯源管理方法，其特征在于，所述对电子文档中的电子印章进行验证溯源，包括的具体步骤如下：获取电子文档中电子印章图像的R通道的图像，将R通道的图像中的像素值255置为1，像素值0保持不变，得到一个二值矩阵，作为验证图像；根据电子文档中的词汇获取电子文档对应的秘密数据序列；获取权重矩阵，根据权重矩阵以及密钥利用分块隐藏算法提取验证图像中的嵌入信息；将秘密数据序列调整为与嵌入信息长度相同的序列；若调整后的秘密数据序列与嵌入信息相同，电子文档中的电子印章为电子印章持有方加盖，若调整后的秘密数据序列与嵌入信息不相同，电子文档中的电子印章为盗用的其他电子文档中的电子印章。
说明书desc
技术领域本发明涉及电子数字数据处理技术领域，具体涉及一种电子印章快速溯源管理方法。背景技术电子印章是电子文档的签章方式，用于确认文件的真实性和完整性。通过电子印章溯源技术，可以跟踪和验证电子印章的合法性，防止伪造和篡改行为，确保签署的文件的真实性和完整性，提升信任度和安全性，规范管理和操作。目前通常通过向电子印章嵌入水印来实现电子印章的溯源。由于电子印章仅包含两个颜色，向电子印章嵌入水印通常会改变较多的位置的颜色，会引起视觉上的警觉，会对原始内容产生一定的干扰或影响，会降低电子印章的可视化质量或辨识度，同时易被攻击者察觉，进行水印破解，从而导致电子印章的泄露或伪造，影响电子印章溯源的准确性。发明内容本发明提供一种电子印章快速溯源管理方法，以解决现有的问题。本发明的一种电子印章快速溯源管理方法采用如下技术方案：本发明一个实施例提供了一种电子印章快速溯源管理方法，该方法包括以下步骤：获取电子印章二值矩阵；根据目标文档中的词汇获取秘密数据序列；预设密钥，将电子印章二值矩阵分割为多个与密钥/＞大小相同的二值分块矩阵；将每个二值分块矩阵与密钥/＞进行异或操作，得到每个二值分块矩阵的异或矩阵；对秘密数据序列进行分割获取每个二值分块矩阵的待嵌入数据序列；将待嵌入数据序列转换为十进制数，作为目标余数；根据待嵌入数据序列的长度以及二值分块矩阵的大小获取所有权重值，根据权重值以及每个二值分块矩阵的异或矩阵获取每个二值分块矩阵的目标余数与二值分块矩阵的差异度；初始化权重矩阵，根据每个二值分块矩阵的目标余数与二值分块矩阵的差异度以及每个分块二值矩阵的异或矩阵，获取权重矩阵中每个位置的权重优选度；根据权重优选度为权重矩阵中每个位置分配权重值，得到最终的权重矩阵；利用密钥以及最终的权重矩阵向电子印章二值矩阵的每个二值分块矩阵中嵌入对应的待嵌入数据序列，得到嵌入秘密数据序列的电子印章图像；将嵌入秘密数据序列的电子印章图像加盖在目标文档上，实现目标文档用印；对电子文档中的电子印章进行验证溯源。优选的，所述获取电子印章二值矩阵，包括的具体步骤如下：获取电子印章图像的R通道的图像，将R通道的图像中的像素值255置为1，像素值0保持不变，得到一个二维的二值矩阵，作为电子印章二值矩阵。优选的，所述根据目标文档中的词汇获取秘密数据序列，包括的具体步骤如下：利用TF-IDF算法获取目标文档中每个词汇的TF-IDF值，作为每个词汇的关键指标，将关键指标最大的若干个词汇作为秘密消息；将秘密消息编码成二进制形式，得到秘密数据序列。优选的，所述对秘密数据序列进行分割获取每个二值分块矩阵的待嵌入数据序列，包括的具体步骤如下：将秘密数据序列分割为若干个长度为的二进制序列，其中为二值分块矩阵的大小，/＞为向下取整符号；将每个二进制序列依次作为每个二值分块矩阵的待嵌入数据序列。优选的，所述根据待嵌入数据序列的长度以及二值分块矩阵的大小获取所有权重值，包括的具体步骤如下：将待嵌入数据序列的长度记为，将/＞中的每个整数分别作为一种权重值；将二值分块矩阵的大小记为/＞，获取每种权重值出现的次数：第1种到第种权重值出现的次数分别为/＞，其余每种权重值出现的次数分别为/＞，其中/＞为取余符号，/＞为向下取整符号；根据每种权重值出现的次数获取所有权重值。优选的，所述根据权重值以及每个二值分块矩阵的异或矩阵获取每个二值分块矩阵的目标余数与二值分块矩阵的差异度，包括的具体步骤如下：其中，为第/＞个二值分块矩阵的目标余数与二值分块矩阵的差异度；/＞为第/＞个二值分块矩阵的目标余数；/＞为二值分块矩阵的待嵌入数据序列的长度；/＞为所有权重值的平均权重值大小；/＞为第/＞个二值分块矩阵的异或矩阵中值为1的元素数量；/＞为取余符号。优选的，所述获取权重矩阵中每个位置的权重优选度，包括的具体步骤如下：获取每个二值分块矩阵的每个位置的权重系数：其中，为第/＞个二值分块矩阵的第/＞个位置的权重系数；/＞为第/＞个二值分块矩阵的目标余数与二值分块矩阵的差异度；/＞为二值分块矩阵的待嵌入数据序列的长度；/＞为第/＞个二值分块矩阵的异或矩阵中的第/＞个位置的元素值；/＞为以自然常数为底的指数函数，/＞为绝对值符号；将所有二值分块矩阵的同一个位置的权重系数相加作为权重矩阵中对应位置的权重优选度。优选的，所述根据权重优选度为权重矩阵中每个位置分配权重值，得到最终的权重矩阵，包括的具体步骤如下：按照权重优选度从大到小的顺序，将所有权重值从大到小依次分配给权重矩阵中每个位置，得到最终的权重矩阵。优选的，所述利用密钥以及最终的权重矩阵向电子印章二值矩阵的每个二值分块矩阵中嵌入对应的待嵌入数据序列，得到嵌入秘密数据序列的电子印章图像，包括的具体步骤如下：根据分块隐藏算法，利用密钥以及最终的权重矩阵，向电子印章二值矩阵的每个二值分块矩阵中嵌入对应的待嵌入数据序列，将嵌入待嵌入数据序列之后的二值分块矩阵作为嵌入矩阵，将所有嵌入矩阵合并成的大矩阵作为嵌入图像；将嵌入图像中的像素值1置为255，像素值0保持不变，利用得到的图像替换电子印章图像中的R通道的图像，得到嵌入秘密数据序列的电子印章图像。优选的，所述对电子文档中的电子印章进行验证溯源，包括的具体步骤如下：获取电子文档中电子印章图像的R通道的图像，将R通道的图像中的像素值255置为1，像素值0保持不变，得到一个二值矩阵，作为验证图像；根据电子文档中的词汇获取电子文档对应的秘密数据序列；获取权重矩阵，根据权重矩阵以及密钥利用分块隐藏算法提取验证图像中的嵌入信息；将秘密数据序列调整为与嵌入信息长度相同的序列；若调整后的秘密数据序列与嵌入信息相同，电子文档中的电子印章为电子印章持有方加盖，若调整后的秘密数据序列与嵌入信息不相同，电子文档中的电子印章为盗用的其他电子文档中的电子印章。本发明的技术方案的有益效果是：由于电子印章仅包含两个颜色，向电子印章嵌入水印通常会改变较多的位置的颜色，会引起视觉上的警觉，会对原始内容产生一定的干扰或影响，会降低电子印章的可视化质量或辨识度，同时易被攻击者察觉，进行水印破解，从而导致电子印章的泄露或伪造，影响电子印章溯源的准确性。本发明根据目标文档中的词汇获取秘密数据序列，获取电子印章二值矩阵的每个二值分块矩阵的异或矩阵，对秘密数据序列进行分割获取每个二值分块矩阵的待嵌入数据序列以及目标余数，根据权重值以及异或矩阵获取目标余数与二值分块矩阵的差异度，进而获取权重矩阵中每个位置的权重优选度，根据权重优选度为权重矩阵中每个位置分配权重值，根据权重矩阵对电子印章图像进行秘密数据序列嵌入，进而进行文档用印，本发明通过在获取目标余数与二值分块矩阵的差异度的过程中，比较利用权重值分布均匀的权重矩阵获取的近似余数和目标余数之间的差异，来调整权重矩阵中权重值的分布，使得根据权重矩阵得到的近似余数与目标余数的差异尽可能小，以此获取最终的权重矩阵，使得根据最终的权重矩阵对待嵌入数据序列进行嵌入时，对每个二值分块矩阵的元素值改变尽可能少，使得电子印章的改变在视觉上难以察觉，对电子印章的可视化质量或辨识度的影响降到最低，同时不易被攻击者察觉，攻击者在不掌握密钥的情况下，无法对电子印章中的水印进行破解和还原，确保了电子印章溯源的准确性。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明的一种电子印章快速溯源管理方法的步骤流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种电子印章快速溯源管理方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种电子印章快速溯源管理方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种电子印章快速溯源管理方法的步骤流程图，该方法包括以下步骤：S001．获取电子印章二值矩阵。需要说明的是，电子印章为红色，因此电子印章图像为RGB图像，电子印章图像的R通道中所有像素点的像素值为0或者255，G通道和B通道中所有像素点的像素值都为0。本发明实施例在电子印章图像的R通道嵌入秘密消息，将秘密消息隐藏在正常的像素值之后，以便后续根据秘密消息进行电子印章的溯源。在本发明实施例中，获取电子印章图像的R通道的图像，为了便于后续秘密消息的嵌入，将R通道的图像中的像素值255置为1，像素值0保持不变，得到一个二维的二值矩阵，作为电子印章二值矩阵。至此，获取了电子印章二值矩阵。S002．根据需要用印的电子文档获取秘密数据序列。需要说明的是，为了确保电子印章可溯源，对于每个需要用印的电子文档，加盖的电子印章中嵌入的秘密消息需要不同。因此可根据每个需要用印的电子文档来自适应获取用印时电子印章嵌入的秘密消息。在本发明实施例中，将需要用印的电子文档作为目标文档。利用TF-IDF算法获取目标文档中每个词汇的TF-IDF值，作为每个词汇的关键指标。需要说明的是，TF-IDF算法为公知技术，在本发明实施例不再详细赘述。需要说明的是，当关键指标越大时，说明该词汇在目标文档中为关键词汇，该词汇越能反映目标文档与其他文档区别的关键信息。因此可根据目标文档中词汇的关键指标获取用印时电子印章进行嵌入的秘密消息，以确保每个电子文档加盖的电子印章中嵌入的秘密消息不同。在本发明实施例中，预设一个词汇量阈值N，在本实施例中以N=20为例进行叙述，具体不做限定，实施人员可根据实际实施情况设置词汇量阈值。对目标文档中所有词汇按照关键指标从大到小的顺序排序，将关键指标最大的N个词汇作为秘密消息。利用现有的编码算法将秘密消息编码成二进制形式，得到秘密数据序列，本发明实施例对编码算法不做限定，实施人员可根据实际实施情况选择编码算法。至此，获取了目标文档对应的秘密数据序列。需要说明的是，本发明实施例根据需要用印的电子文档中每个词汇的TF-IDF值获取需要用印的电子文档对应的秘密消息，确保了每个电子文档加盖的电子印章中嵌入的秘密消息不同，使得电子印章可溯源。S003．根据秘密数据序列获取嵌入参数。需要说明的是，Tseng等人提出了一种针对二值矩阵的分块隐藏算法，该算法通过对二值矩阵进行分块，对每个分块矩阵嵌入数据。算法的具体流程为：若将需要嵌入分块矩阵的数据的长度记为，将分块矩阵与密钥/＞进行异或操作，将异或操作结果与权重矩阵进行相乘，将相乘的结果除以/＞进行取余，并将取余的结果与需要嵌入分块矩阵的数据的十进制数值进行比较，当不相同时，通过改变分块矩阵中的元素值，使得取余的结果与需要嵌入分块矩阵的数据的十进制数值相同，从而达到嵌入数据的目的。需要进一步说明的是，在分块隐藏算法中，若权重矩阵设置不当，则会导致根据分块矩阵得到的取余的结果与需要嵌入分块矩阵的数据的十进制数值相差较大，进而导致需要对分块矩阵中较多的像素点的像素值进行改变，才能达到嵌入数据的目的。若改变的像素点越多，则越可能引起视觉异常，影响二值矩阵中原本的信息的展现。因此，本发明实施例根据目标文档的秘密数据序列自适应获取权重矩阵，确保目标文档加盖的电子印章嵌入秘密数据序列之后改变的数据量非常小，实现秘密数据的隐藏。在本发明实施例中，由电子印章持有方预先设置一个大小的二维矩阵，矩阵中的元素的值为0或1，将该二维矩阵作为密钥/＞。后续使用该电子印章对不同的电子文档进行加盖时，均采用同一个密钥/＞。需要说明的是，本发明实施例对于密钥/＞的大小不做限定，后续以/＞，/＞为例进行叙述，实施人员可根据具体实施情况设置。将电子印章二值矩阵分割为多个小矩阵，作为二值分块矩阵，每个二值分块矩阵的大小需与密钥的大小相同，即为/＞。将每个二值分块矩阵与密钥/＞进行异或操作，将得到的矩阵，记为每个二值分块矩阵的异或矩阵。大小的二值分块矩阵中最多可隐藏/＞比特的信息，其中/＞为向下取整符号。将秘密数据序列分割为若干个长度为/＞的二进制序列。将每个二进制序列依次作为每个二值分块矩阵的待嵌入数据序列，当二进制序列的数量小于二值分块矩阵的数量时，对二进制序列进行重复嵌入，即为多出的二值分块矩阵从第一个二进制序列开始，重新为多出的每个二值分块矩阵赋予待嵌入数据序列。当二进制序列的数量大于二值分块矩阵的数量时，对于多出的二进制序列不进行嵌入。至此，每个二值分块矩阵均得到了一个待嵌入数据序列。需要说明的是，权重矩阵的大小与密钥的大小相同，权重矩阵中包含的权重值与二值分块矩阵的待嵌入数据序列的长度相关，待嵌入数据序列的长度为，则权重矩阵包含的权重值为/＞至/＞。每种权重值出现的次数权重矩阵的大小相关，密钥/＞的大小为/＞，即权重矩阵的大小为/＞，对应的前种权重值分别出现/＞次，其余权重值分别出现/＞次，根据每种权重值出现的次数获取所有权重值，其中/＞为取余符号，/＞为向下取整符号。在本发明实施例中，获取所有权重值的平均大小，记为平均权重值大小。将每个二值分块矩阵的待嵌入数据序列转换为十进制数，作为每个二值分块矩阵的目标余数。获取每个二值分块矩阵的目标余数与二值分块矩阵的差异度：其中，为第/＞个二值分块矩阵的目标余数与二值分块矩阵的差异度；/＞为第/＞个二值分块矩阵的目标余数；/＞为二值分块矩阵的待嵌入数据序列的长度；/＞为平均权重值大小；/＞为第/＞个二值分块矩阵的异或矩阵中值为1的元素数量；/＞为取余符号；当根据第/＞个二值分块矩阵的异或矩阵中0和1的分布，为权重矩阵中对应位置均匀分配权重值时，表示第/＞个二值分块矩阵的异或矩阵与权重矩阵相乘之后的近似结果；表示第/＞个二值分块矩阵的异或矩阵与权重矩阵相乘并除以/＞进行取余的近似余数；/＞为近似余数与目标余数之间的差异，当差异越小，根据异或矩阵中0和1的分布为权重矩阵中对应位置均匀分配权重值得到的权重矩阵的效果越好，可使得第/＞个二值分块矩阵嵌入待嵌入数据序列时尽可能少的元素值改变，使得第/＞个二值分块矩阵的改变视觉上难以察觉；当近似余数与目标余数之间的差异越大，根据异或矩阵中0和1的分布为权重矩阵中对应位置均匀分配权重值得到的权重矩阵的效果越差，后续为权重矩阵分配权重值时不能根据异或矩阵中0和1的分布均匀分配。权重矩阵的大小需与密钥以及二值分块矩阵的大小相同，即为/＞。初始化一个大小为/＞的二维矩阵，作为权重矩阵。根据每个二值分块矩阵的目标余数与二值分块矩阵的差异度，获取权重矩阵中每个位置的权重优选度：其中，为权重矩阵中第/＞个位置的权重优选度；/＞为第/＞个二值分块矩阵的第/＞个位置的权重系数；/＞为二值分块矩阵的数量；/＞为第/＞个二值分块矩阵的目标余数与二值分块矩阵的差异度；/＞为二值分块矩阵的待嵌入数据序列的长度；/＞为第/＞个二值分块矩阵的异或矩阵中第/＞个位置的元素值；/＞为以自然常数为底的指数函数；二值分块矩阵的目标余数与二值分块矩阵的差异度最大/＞，因此用/＞对差异度/＞进行归一化，当时，根据异或矩阵中0和1的分布为权重矩阵中对应位置均匀分配权重值得到的权重矩阵的效果越差，此时得到的近似余数较目标余数大，为了使得二者尽可能相同，应该为异或矩阵中0在权重矩阵中对应的位置赋予较大的权重，为异或矩阵中1在权重矩阵中对应的位置赋予较小的权重，从而达到减小近似余数的目的，此时若权重矩阵中第/＞个位置在第个二值分块矩阵的异或矩阵中对应的位置的元素值为0，即/＞时，将/＞作为第/＞个二值分块矩阵的第/＞个位置的权重系数，当/＞越大，权重系数越大，此时若权重矩阵中第/＞个位置在第/＞个二值分块矩阵的异或矩阵中对应的位置的元素值为1，即/＞时，将作为第/＞个二值分块矩阵的第/＞个位置的权重系数，当/＞越大，权重系数越小；同理，当/＞时，根据异或矩阵中0和1的分布为权重矩阵中对应位置均匀分配权重值得到的权重矩阵的效果越差，此时得到的近似余数较目标余数小，为了使得二者尽可能相同，应该为异或矩阵中1在权重矩阵中对应的位置赋予较大的权重，为异或矩阵中0在权重矩阵中对应的位置赋予较小的权重，从而达到增大近似余数的目的，此时若权重矩阵中第/＞个位置在第/＞个二值分块矩阵的异或矩阵中对应的位置的元素值为0，即/＞时，将作为第/＞个二值分块矩阵的第/＞个位置的权重系数，当/＞越大，权重系数越小，此时若权重矩阵中第/＞个位置在第/＞个二值分块矩阵的异或矩阵中对应的位置的元素值为1，即/＞时，将/＞作为第/＞个二值分块矩阵的第/＞个位置的权重系数，当/＞越大，权重系数越大；当/＞时，此时得到的近似余数与目标余数相同，根据异或矩阵中0和1的分布为权重矩阵中对应位置均匀分配权重值得到的权重矩阵的效果最好，此时为了均匀分配权重值，无论权重矩阵中第/＞个位置在第/＞个二值分块矩阵的异或矩阵中对应的位置的元素值为0或为1，都将0.5作为第/＞个二值分块矩阵的第/＞个位置的权重系数；将所有二值分块矩阵的同一个位置的权重系数相加作为权重矩阵中对应位置的权重优选度。权重矩阵中权重优选度大的位置应分配较大的权重值，权重优选度小的位置应分配较小的权重值。按照权重优选度从大到小的顺序，将所有权重值从大到小依次分配给权重矩阵中每个位置，得到最终的权重矩阵。至此，获取了目标文档的嵌入参数，包括密钥以及权重矩阵。S004．根据嵌入参数对电子印章图像嵌入秘密数据序列，进行文档用印。根据分块隐藏算法，利用密钥以及权重矩阵，向电子印章二值矩阵的每个二值分块矩阵中嵌入对应的待嵌入数据序列，将嵌入待嵌入数据序列之后的二值分块矩阵作为嵌入矩阵，将所有嵌入矩阵合并成的大矩阵作为嵌入图像。将嵌入图像中的像素值1置为255，像素值0保持不变，利用得到的图像替换电子印章图像中的R通道的图像，得到嵌入秘密数据序列的电子印章图像。将嵌入秘密数据序列的电子印章图像加盖在目标文档上，实现目标文档用印。至此，实现了文档用印。需要说明的是，对于不同的电子文档，获取的秘密数据序列不同，电子印章图像嵌入秘密数据序列包含的秘密消息不同，确保了每个电子文档加盖的电子印章图像存在区别，可防止电子印章挪用。S005．对电子文档中的电子印章进行溯源。电子印章持有方对电子文档中的电子印章进行验证，具体为：获取电子文档中电子印章图像中R通道的图像，将R通道的图像中的像素值255置为1，像素值0保持不变，得到一个二值矩阵，作为验证图像。利用步骤S002中的方法获取电子文档的秘密数据序列。根据电子印章持有方持有的电子印章二值矩阵以及电子文档的秘密数据序列利用步骤S003中的方法获取权重矩阵，根据权重矩阵以及电子印章持有方保存的密钥利用分块隐藏算法提取验证图像中的嵌入信息。需要说明的是，在向电子印章二值矩阵的二值分块矩阵嵌入数据时，进行了截取或重复嵌入，因此，需要对电子文档的秘密数据序列进行补充或截取，使其和提取出的嵌入信息的长度相同，再进行二者的比较。在本发明实施例中，当电子文档的秘密数据序列比提取出的嵌入信息的长度更长时，从秘密数据序列的末尾开始，依次向前删除，使得秘密数据序列的长度与提取出的嵌入信息的长度相同。当电子文档的秘密数据序列比提取出的嵌入信息的长度更短时，从秘密数据序列中的第一个数值开始，依次将数值添加到秘密数据序列的末尾，使得秘密数据序列的长度与提取出的嵌入信息的长度相同。比较秘密数据序列与提取出的嵌入信息，若二者相同，则表示该电子文档可信，该电子文档中的电子印章为电子印章持有方加盖。若二者不相同，则表示该电子文档不可信，该电子文档中的电子印章为盗用的其他可信电子文档中的电子印章。至此，完成了电子文档中电子印章的验证溯源。本发明实施例根据目标文档中的词汇获取秘密数据序列，获取电子印章二值矩阵的每个二值分块矩阵的异或矩阵，对秘密数据序列进行分割获取每个二值分块矩阵的待嵌入数据序列以及目标余数，根据权重值以及异或矩阵获取目标余数与二值分块矩阵的差异度，进而获取权重矩阵中每个位置的权重优选度，根据权重优选度为权重矩阵中每个位置分配权重值，根据权重矩阵对电子印章图像进行秘密数据序列嵌入，进而进行文档用印，本发明通过在获取目标余数与二值分块矩阵的差异度的过程中，比较利用权重值分布均匀的权重矩阵获取的近似余数和目标余数之间的差异，来调整权重矩阵中权重值的分布，使得根据权重矩阵得到的近似余数与目标余数的差异尽可能小，以此获取最终的权重矩阵，使得根据最终的权重矩阵对待嵌入数据序列进行嵌入时，对每个二值分块矩阵的元素值改变尽可能少，使得电子印章的改变在视觉上难以察觉，对电子印章的可视化质量或辨识度的影响降到最低，同时不易被攻击者察觉，攻击者在不掌握密钥的情况下，无法对电子印章中的水印进行破解和还原，确保了电子印章溯源的准确性。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
