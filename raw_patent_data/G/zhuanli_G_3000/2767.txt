标题title
一种基于线性优化封闭子图编码的链路符号预测方法
摘要abst
本发明公开了一种基于线性优化封闭子图编码的链路符号预测方法，获取待预测网络并预处理，得到训练集样本和测试集样本；从训练集样本或测试集样本中任取一条边作为待预测边并提取相应的封闭子图，对封闭子图进行粗粒度加权，得到预加权邻接矩阵，再进行细粒度的线性优化加权，得到三个似然矩阵，对三个似然矩阵进行处理和拼接，得到待预测边对应的向量；遍历训练集样本和测试集样本中的所有边，重复上述方法，相应得到多个向量；将多个向量输入至训练后的全连接神经网络二分类器，经过处理，输出链路符号预测得分，从而得到待预测边的符号预测结果。该方法可以直接、简单地对封闭子图中的节点排序，链路符号预测效果更好。
权利要求书clms
1.一种基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述方法包括：S1、获取待预测网络，对所述待预测网络进行预处理，得到不包含孤立节点的有向符号网络，从所述有向符号网络中分别取边构成训练集样本和测试集样本；S2、从所述训练集样本或测试集样本中任取一条边作为待预测边，提取包含所述待预测边的封闭子图，根据边预加权策略对所述封闭子图中的每条边进行粗粒度加权，得到预加权邻接矩阵，将所述预加权邻接矩阵输入至线性优化模型进行细粒度的线性优化加权，得到三个似然矩阵；S3、对三个所述似然矩阵进行处理，相应得到三个排序后的似然矩阵，将三个所述排序后的似然矩阵进行拼接，得到所述待预测边对应的向量；S4、从所述训练集样本或测试集样本中另取一条边作为待预测边直至训练集样本或测试集样本中的所有边均被提取，重复步骤S2至S3，相应得到多个向量；S5、预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个所述向量输入至所述训练后的全连接神经网络二分类器，经过处理，输出链路符号预测得分，根据所述链路符号预测得分得到所述待预测边对应的符号预测结果。2.如权利要求1所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S1包括：S11、获取待预测网络，消除待预测网络中边的权重，得到不包含孤立节点的有向符号网络；S12、从所述不包含孤立节点的有向符号网络中删除预设比例的正边和负边，由此得到训练网络；S13、将所述训练网络中的正边作为训练集正样本，将所述训练网络中的负边作为训练集负样本，将所述不包含孤立节点的有向符号网络中删除的正边作为测试集正样本，将所述不包含孤立节点的有向符号网络中删除的负边作为测试集负样本；S14、将所述训练集正样本和所述训练集负样本组成训练集样本，将所述测试集正样本和所述测试集负样本组成测试集样本。3.如权利要求2所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S2中从所述训练集样本或测试集样本中任取一条边作为待预测边，提取包含所述待预测边的封闭子图，具体包括：S21、预设节点阈值，从所述训练集样本或测试集样本中任取一条边作为待预测边，提取组成所述待预测边的节点vi、vj及其h阶邻居节点Γh、Γh组成节点集；S22、计算所述节点集中包含的节点数，将所述节点数和所述预设节点阈值进行比较，若所述节点数小于所述预设节点阈值，执行步骤S23，否则，若所述节点数大于等于所述预设节点阈值，或者再无新的邻居节点可以添加，执行步骤S24；S23、将组成所述待预测边的节点vi、vj的h+1阶邻居Γh+1、Γh+1加到所述节点集中，执行步骤S22；S24、结束添加邻居节点，得到所述待预测边对应的封闭子图。4.如权利要求3所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述封闭子图中的边包括正边和负边，所述S2中根据边预加权策略对所述封闭子图中的每条边进行粗粒度加权，得到预加权邻接矩阵，所述边预加权策略具体为：若所述封闭子图中的边为正边，则对应的边预加权策略为：若所述封闭子图中的边为负边，则对应的边预加权策略为：式中，Wxy为封闭子图中的边的权重，d,)是封闭子图中的待预测边到边的最短路径长度，β是负边权值因子。5.如权利要求4所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S2中的线性优化模型具体为：式中，Z为第一贡献矩阵，Z为第二贡献矩阵，Z为第三贡献矩阵，W为预加权邻接矩阵，α1，α2，α3为大于零的自由参数，|| ||为范数符号。6.如权利要求5所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S2中得到三个似然矩阵，三个所述似然矩阵具体为：S＝α1W-1WTWS＝α2WT-1WWS＝α3WW-1WT式中，S为第一似然矩阵，S为第二似然矩阵，S为第三似然矩阵，W为预加权邻接矩阵，α1，α2，α3为大于零的自由参数，I为单位矩阵。7.如权利要求6所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S3中对三个所述似然矩阵进行处理，相应得到三个排序后的似然矩阵，具体包括：S31、从三个所述似然矩阵中任取一个似然矩阵，基于所述似然矩阵，对所述封闭子图中的非中心节点计算重要性得分，并根据所述重要性分数对非中心节点进行降序排序；S32、计算所述封闭子图中的节点数，将所述节点数与所述预设节点阈值进行比较，若所述节点数小于所述预设节点阈值，即|V|＜K，执行步骤S33，否则，若所述节点数大于等于所述预设节点阈值，即|V|≥K，执行步骤S34；S33、将所述似然矩阵用0填充至K维方阵，由此得到排序后的似然矩阵；S34、将排序靠后的|V|-K个节点将从所述封闭子图中删除，将删除的节点对应的似然值从所述似然矩阵中删除，由此得到排序后的似然矩阵。S35、从三个所述似然矩阵中再取另一个似然矩阵，直至三个所述似然矩阵均被提取，经过步骤S31至S34处理，相应得到三个排序后的似然矩阵。8.如权利要求7所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S31中对所述封闭子图中的非中心节点计算重要性得分，所述重要性得分的具体计算公式为：式中，为封闭子图中编码为第x个节点基于第k个似然矩阵的重要性得分，k＝1,2,3，||代表绝对值，/＞为第k个似然矩阵中第1行第x列的似然值，/＞为第k个似然矩阵中第x行第1列的似然值,/＞为第k个似然矩阵中第2行第x列的似然值，/＞为第k个似然矩阵中第x行第2列的似然值。9.如权利要求8所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S3中将三个排序后的似然矩阵进行拼接，得到所述待预测边对应的向量，具体包括：S36、分别删除三个所述排序后的似然矩阵对角线上的元素，将排序后的似然矩阵中的剩余元素摊平，得到所述排序后的似然矩阵对应的三个向量；S37、将三个所述排序后的似然矩阵对应的向量进行拼接，得到所述待预测边对应的向量。10.如权利要求2所述的基于线性优化封闭子图编码的链路符号预测方法，其特征在于，所述S12中从所述不包含孤立节点的有向符号网络中删除预设比例的正边和负边，所述预设比例为20％。
说明书desc
技术领域本发明涉及数据挖掘技术领域，尤其是涉及一种基于线性优化封闭子图编码的链路符号预测方法。背景技术随着自媒体的兴起，互联网的进步以及云计算的发展，促使社交媒体互动，如订阅、关注、评论和转发等大量涌现。在过去几十年中，由于能够有效地分析网络结构，链路预测领域日趋成熟，产生了大量易于理解的方法和算法来挖掘潜在的网络交互信息。然而，一般链路预测侧重于积极互动，忽略了具有明显冲突的交互关系，如不信任和反对。因此，链路预测的一个重要的子领域，链路符号预测，考虑了社交媒体链接中的负面互动信息，具有巨大的商业价值。链路符号预测的目的是在社交网络中进行好友推荐，它可以从两个相反的交互关系中挖掘潜在信息。链路符号预测类似于链路预测问题，是基于网络已知的链路符号来判断目标链路的符号。由于链路预测和链路符号预测都基于图结构数据来对边进行二分类，因此某些链路预测算法可以直接用于链路符号预测。当前大多数链路预测方法使用图嵌入。图嵌入将每个节点映射为一个表示向量用于具体的下游任务，如节点分类、链路预测和社区检测。图嵌入方法的优势是可以利用深度神经网络的强大拟合能力达到较高的预测精度。最近有许多专门应用于符号网络的图嵌入方法，但普遍存在两个缺点。第一，符号图的连边存在符号和方向等多种类型，因此符号图的邻域结构更加复杂，一般的图嵌入方法不能聚合不同邻域的信息。第二，目前关于符号和方向的演化机制研究较少，因此大部分图嵌入方法依赖于基于平衡理论和状态理论的假设设来计图上的信息传递机制，不能自动从邻域中学习合适的网络演化机制，泛化能力较差。发明内容针对有向符号图子图模式编码方法的空白，本发明实现了一种基于线性优化封闭子图编码的链路符号预测方法。它假设链路存在的可能性是它们共同近邻贡献的线性和。由于经典的线性优化方法是为无符号设计的，因此要将其应用于有符号有向图必须克服两个限制。一方面，经典的线性优化方法关注于全局图结构，因此无法在目标节点周围的封闭子图中编码层次结构。例如，在确定目标链路的符号时，封闭子图中的一阶邻居通常比二阶邻居更重要，而线性优化方法无法区分一阶和二阶邻域。此外，封闭子图中正负链接的贡献也可能不同。为了解决这一问题，本发明提出了一种新的权重分配策略，根据每个边到目标边的距离及其符号重新分配每个边的权重。通过这个权重分配策略可以赋予封闭子图一个层次结构。另一方面，经典的线性优化方法只考虑了出邻居的贡献。本发明将此假设推广到有向符号网络中两个目标节点的出邻居和入邻居的贡献。在此基础上，本发明提出了一种改进的线性优化方法来推导出封闭子图的似然矩阵。得到似然矩阵后，可以直接、简单地对节点排序。在线性优化编码邻接矩阵后，可以得到封闭子图中一个节点对两个目标节点的贡献，贡献可以作为重要分数来对封闭子图中的节点进行排序。本发明的目的在于提供一种基于线性优化封闭子图编码的链路符号预测方法，包括如下步骤：S1、获取待预测网络，对待预测网络进行预处理，得到不包含孤立节点的有向符号网络，从有向符号网络中分别取边构成训练集样本和测试集样本；S2、从训练集样本或测试集样本中任取一条边作为待预测边，提取包含待预测边的封闭子图，根据边预加权策略对封闭子图中的每条边进行粗粒度加权，得到预加权邻接矩阵，将预加权邻接矩阵输入至线性优化模型进行细粒度的线性优化加权，得到三个似然矩阵；S3、对三个似然矩阵进行处理，相应得到三个排序后的似然矩阵，将三个排序后的似然矩阵进行拼接，得到待预测边对应的向量；S4、从训练集样本或测试集样本中另取一条边作为待预测边直至训练集样本或测试集样本中的所有边均被提取，重复步骤S2至S3，相应得到多个向量；S5、预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个向量输入至训练后的全连接神经网络二分类器，经过处理，输出链路符号预测得分，根据链路符号预测得分得到待预测边对应的符号预测结果。优选地，S1包括：S11、获取待预测网络，消除待预测网络中边的权重，得到不包含孤立节点的有向符号网络；S12、从不包含孤立节点的有向符号网络中删除预设比例的正边和负边，由此得到训练网络；S13、将训练网络中的正边作为训练集正样本，将训练网络中的负边作为训练集负样本，将不包含孤立节点的有向符号网络中删除的正边作为测试集正样本，将不包含孤立节点的有向符号网络中删除的负边作为测试集负样本；S14、将训练集正样本和训练集负样本组成训练集样本，将测试集正样本和测试集负样本组成测试集样本。优选地，S2中从训练集样本或测试集样本中任取一条边作为待预测边，提取包含待预测边的封闭子图，具体包括：S21、预设节点阈值，从训练集样本或测试集样本中任取一条边作为待预测边，提取组成待预测边的节点vi、vj及其h阶邻居节点Γh、Γh组成节点集；S22、计算节点集中包含的节点数，将节点数和预设节点阈值进行比较，若节点数小于预设节点阈值，执行步骤S23，否则，若节点数大于等于预设节点阈值，或者再无新的邻居节点可以添加，执行步骤S24；S23、将组成待预测边的节点vi、vj的h+1阶邻居Γh+1、Γh+1加到节点集中，执行步骤S22；S24、结束添加邻居节点，得到待预测边对应的封闭子图。优选地，封闭子图中的边包括正边和负边，S2中根据边预加权策略对封闭子图中的每条边进行粗粒度加权，得到预加权邻接矩阵，边预加权策略具体为：若封闭子图中的边为正边，则对应的边预加权策略为：若封闭子图中的边为负边，则对应的边预加权策略为：式中，Wxy为封闭子图中的边的权重，d,)是封闭子图中的待预测边到边的最短路径长度，β是负边权值因子。优选地，S2中的线性优化模型具体为：式中，Z为第一贡献矩阵，Z为第二贡献矩阵，Z为第三贡献矩阵，W为预加权邻接矩阵，α1，α2，α3为大于零的自由参数，║║为范数符号。优选地，S2中得到三个似然矩阵，三个似然矩阵具体为：S＝α1W-1WTWS＝α2WT-1WWS＝α3WW-1WT式中，S为第一似然矩阵，S为第二似然矩阵，S为第三似然矩阵，W为预加权邻接矩阵，α1，α2，α3为大于零的自由参数，I为单位矩阵。优选地，S3中对三个似然矩阵进行处理，相应得到三个排序后的似然矩阵，具体包括：S31、从三个似然矩阵中任取一个似然矩阵，基于似然矩阵，对封闭子图中的非中心节点计算重要性得分，并根据重要性分数对非中心节点进行降序排序；S32、计算封闭子图中的节点数，将节点数与预设节点阈值进行比较，若节点数小于预设节点阈值，即|V|＜K，执行步骤S33，否则，若节点数大于等于预设节点阈值，即|V|≥K，执行步骤S34；S33、将似然矩阵用0填充至K维方阵，由此得到排序后的似然矩阵；S34、将排序靠后的|V|-K个节点将从封闭子图中删除，将删除的节点对应的似然值从似然矩阵中删除，由此得到排序后的似然矩阵。S35、从三个似然矩阵中再取另一个似然矩阵，直至三个似然矩阵均被提取，经过步骤S31至S34处理，相应得到三个排序后的似然矩阵。优选地，S31中对封闭子图中的非中心节点计算重要性得分，重要性得分的具体计算公式为：/＞式中，为封闭子图中编码为第x个节点基于第k个似然矩阵的重要性得分，k＝1,2,3，| |代表绝对值，/＞为第k个似然矩阵中第1行第x列的似然值，/＞为第k个似然矩阵中第x行第1列的似然值,/＞为第k个似然矩阵中第2行第x列的似然值，/＞为第k个似然矩阵中第x行第2列的似然值。优选地，S3中将三个排序后的似然矩阵进行拼接，得到待预测边对应的向量，具体包括：S36、分别删除三个排序后的似然矩阵对角线上的元素，将排序后的似然矩阵中的剩余元素摊平，得到排序后的似然矩阵对应的三个向量；S37、将三个排序后的似然矩阵对应的向量进行拼接，得到待预测边对应的向量。优选地，S12中从不包含孤立节点的有向符号网络中删除预设比例的正边和负边，预设比例为20％。上述一种基于线性优化封闭子图编码的链路符号预测方法，通过边预加权策略和线性优化模型对子图的边进行两阶段的加权得到似然矩阵，再依据似然值对节点排序，得到排序后的似然矩阵，使得排序后的似然矩阵包含子图丰富拓扑信息，利用排序后的似然矩阵代替预加权邻接矩阵作为子图编码器，排序后的似然矩阵加强了封闭子图的层次结构和负边的重要性。附图说明图1是本发明一实施例中一种基于线性优化封闭子图编码的链路符号预测方法的流程图；图2是本发明一实施例中通过一个封闭子图得到对应向量的过程示意图；图3为本发明一实施例中提取待预测边的封闭子图的示意图；图4为本发明另一实施例中提取待预测边的封闭子图的示意图；具体实施方式为了使本技术领域的人员更好地理解本发明的技术方案，下面结合附图对本发明作进一步的详细说明。一种基于线性优化封闭子图编码的链路符号预测方法，具体包括：S1、获取待预测网络，对待预测网络进行预处理，得到不包含孤立节点的有向符号网络，从有向符号网络中分别取边构成训练集样本和测试集样本；S2、从训练集样本或测试集样本中任取一条边作为待预测边，提取包含待预测边的封闭子图，根据边预加权策略对封闭子图中的每条边进行粗粒度加权，得到预加权邻接矩阵，将预加权邻接矩阵输入至线性优化模型进行细粒度的线性优化加权，得到三个似然矩阵；S3、对三个似然矩阵进行处理，相应得到三个排序后的似然矩阵，将三个排序后的似然矩阵进行拼接，得到待预测边对应的向量；S4、从训练集样本或测试集样本中另取一条边作为待预测边直至训练集样本或测试集样本中的所有边均被提取，重复步骤S2至S3，相应得到多个向量；S5、预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个向量输入至训练后的全连接神经网络二分类器，经过处理，输出链路符号预测得分，根据链路符号预测得分得到待预测边对应的符号预测结果。具体地，参见图1和图2，图1是本发明一实施例中一种基于线性优化封闭子图编码的链路符号预测方法的流程图，图2是本发明一实施例中本发明一实施例中通过一个封闭子图得到对应向量的过程示意图。首先获取待预测网络，对待预测网络进行预处理，得到不包含孤立节点的有向符号网络，从有向符号网络中分别取边构成训练集样本和测试集样本；然后从训练集样本或测试集样本中任取一条边作为待预测边，提取包含待预测边的封闭子图，根据边预加权策略对封闭子图中的每条边进行粗粒度加权，得到预加权邻接矩阵，将预加权邻接矩阵输入至线性优化模型进行细粒度的线性优化加权，得到三个似然矩阵；接着对三个似然矩阵进行处理并拼接，得到待预测边对应的向量；从训练集样本或测试集样本中另取一条边作为待预测边直至训练集样本或测试集样本中的所有边均被提取，重复步骤S2至S3，相应得到多个向量；最后预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个向量输入至训练后的全连接神经网络二分类器，经过处理，输出链路符号预测得分，根据链路符号预测得分进行判断，得到待预测边对应的符号预测结果。例如，如果链路预测得分大于等于0.5，表示待预测边为正边，否则，如果链路预测得分小于0.5，表示待预测边为负边。在一个实施例中，S1包括：S11、获取待预测网络，消除待预测网络中边的权重，得到不包含孤立节点的有向符号网络；S12、从不包含孤立节点的有向符号网络中删除预设比例的正边和负边，由此得到训练网络；S13、将训练网络中的正边作为训练集正样本，将训练网络中的负边作为训练集负样本，将不包含孤立节点的有向符号网络中删除的正边作为测试集正样本，将不包含孤立节点的有向符号网络中删除的负边作为测试集负样本；S14、将训练集正样本和训练集负样本组成训练集样本，将测试集正样本和测试集负样本组成测试集样本。具体地，消除待预测网络中边的权重后，得到不包含孤立节点的有向符号网络，并从该有向符号网络中删除预设比例的边，将有向符号网络中未删除的正边和负边分别作为训练集正样本和训练集负样本，将有向符号网络中已删除的正边和负边分别作为测试集正样本和负样本。进一步地，删除预设比例的边，预设比例为20％，也可以是10％，或30％等，预设比例越低，删除的边越少，预测精度会越高。在一个实施例中，S2中从训练集样本或测试集样本中任取一条待预测边，提取待预测边的封闭子图，具体包括：S21、预设节点阈值，从训练集样本或测试集样本中任取一条边作为待预测边，提取组成待预测边的节点vi、vj及其h阶邻居节点Γh、Γh组成节点集；S22、计算节点集中包含的节点数，将节点数和预设节点阈值进行比较，若节点数小于预设节点阈值，执行步骤S23，否则，若节点数大于等于预设节点阈值，或者再无新的邻居节点可以添加，执行步骤S24；S23、将组成待预测边的节点vi、vj的h+1阶邻居Γh+1、Γh+1加到节点集中，执行步骤S22；S24、结束添加邻居节点，得到待预测边对应的封闭子图。以训练集样本为例，将训练集样本对应的有向符号网络表示为G＝，其中表示有向符号网络中的节点集合，也就是训练集样本所有边对应的节点的集合，E+表示有向符号网络中的正边集合，E-表示有向符号网络中的负边集合，由此可知E＝E+∪E-表示有向符号网络中的所有边的集合，/＞即每条边要么属于训练集正样本集合，要么属于训练集负样本集合。对于训练集样本中的任一节点vi∈V，定义其一阶邻居节点的集合为：Γ＝Γout∪Γin其中，式中，Γ为节点vi的一阶邻居节点的集合，V为训练集中所有边对应的节点集合，Γout为节点vi到节点vj形成的边对应的一阶邻居节点集合，Γin为节点vj到节点vi形成的边对应的一阶邻居节点集合，E为训练集中所有边的集合。对于训练集样本中的任一节点vi∈V，定义其二阶邻居节点的集合为：式中，Γ2为节点vi的二阶邻居节点的集合，vk为任意一个邻居节点，表示vk是节点vi的任意一个一阶邻居节点，vj∈Γ表示vj是节点vk的某个邻居节点，因此，vj是vi的邻居节点的邻居节点，即vj和vi可以通过两条边构成一个通路。同样地，可以得到节点vi∈V的h阶邻居节点的集合为Γh，此处不再赘述。封闭子图的提取方法：预设节点阈值K，将构成待预测边的节点vi、vj和及其的1阶邻居节点Γ、Γ加到封闭子图G的节点集V中，然后计算节点集V中的节点数|V|，如果此时的节点数小于预设节点阈值，即|V|＜K，再将其2阶邻居节点Γ2、Γ2加到封闭子图G的节点集V中，以此类推添加节点，直到得到的节点数大于等于预设节点阈值，即|V|≥K，或者不再有新的邻居节点可以添加时结束，由此得到待预测边的封闭子图。具体地，参见图3和图4，图3为本发明一实施例中提取待预测边的封闭子图的示意图，图4为本发明另一实施例中提取待预测边的封闭子图的示意图。在图3中，若预设节点阈值K为6，在提取了待预测边的一阶邻域中的1阶邻居节点后，计算此时得到的节点数为7，大于预设节点阈值，结束添加新的邻居节点，得到待预测边对应的封闭子图。在图4中，若预设节点阈值K为6，在提取了待预测边的一阶邻域中的1阶邻居节点后，计算此时得到的节点数为5，小于预设节点阈值，因此还需要提取其二阶邻域中的2阶邻居节点，此时得到的节点数为8，大于预设节点阈值，结束添加新的邻居节点，得到待预测边对应的封闭子图。在一个实施例中，封闭子图中的边包括正边和负边，S2中根据边预加权策略对封闭子图中的每条边进行粗粒度加权，得到预加权邻接矩阵，边预加权策略具体为：若封闭子图中的边为正边，则对应的边预加权策略为：若封闭子图中的边为负边，则对应的边预加权策略为：式中，Wxy为封闭子图中的边的权重，d,)是封闭子图中的待预测边到边的最短路径长度，β是负边权值因子。具体地，边预加权策略就是为封闭子图G中的每个边取一个合适的权重，以区分封闭子图中的每条边对待预测边为正或为负的贡献。用A表示邻接矩阵，Aij＝1表示存在一条从节点vi指向节点vj的有向正边，Aij＝-1表示存在一条从节点vi指向节点vj的有向负边，Aij＝0表示不存在节点vi指向节点vj的有向边。提取封闭子图G后，将封闭子图G表示为一个仅包含1、0、-1三种取值的邻接矩阵A，使得链路符号预测问题转化为对邻接矩阵A进行分类的问题。根据邻接矩阵A，计算待预测边的封闭子图G中每条边的权重，由此得到预加权邻接矩阵W，权重的计算方式如下：设为待预测边的封闭子图G里的任意一条边，若为正边，则边的权重计算方式如下：若为负边，则边的权重计算方式如下：其中，式中，d,)是封闭子图中的边到边的最短路径长度，即若两个节点之间有连边，则将这两个节点间的距离d记为1，d,)是d、d、d、d这四个距离中的最小值，β是负边权值因子，n+为有向符号网络中正边的数量，n-为有向符号网络中负边的数量。在一个实施例中，S2中的线性优化模型具体为：/＞式中，Z为第一贡献矩阵，Z为第二贡献矩阵，Z为第三贡献矩阵，W为预加权邻接矩阵，α1，α2，α3为大于零的自由参数，║ ║为范数符号。在一个实施例中，S2中得到三个似然矩阵，三个似然矩阵具体为：S＝α1W-1WTWS＝α2WT-1WWS＝α3WW-1WT式中，S为第一似然矩阵，S为第二似然矩阵，S为第三似然矩阵，W为预加权邻接矩阵，α1，α2，α3为大于零的自由参数，I为单位矩阵。具体地，采用一致的节点排序方法来对封闭子图中的节点进行编码，以方便后续操作，具体方法如下：1)针对待预测边的封闭子图G，将构成待预测边的节点vi、vj作为中心节点，分别编码为1和2；2)封闭子图中的所有其他节点被随机编码为3到|V|。通过上述方法编码后，可以确定待预测边的封闭子图G对应的一个唯一邻接矩阵A，再通过边预加权策略得到封闭子图G对应的预加权邻接矩阵W。根据预加权邻接矩阵W推导出封闭子图G的似然矩阵，具体公式为：S＝WZS＝WZS＝WZ式中，W预加权邻接矩阵，S为第一似然的矩阵，S为第二似然矩阵，S第三似然矩阵，Z为第一贡献矩阵，Z为第二贡献矩阵，Z为第三贡献矩阵，Z、Z和Z的取值基于下面的线性优化模型，线性优化模型的解即为对应的贡献矩阵：式中，α1、α2、α3是大于零的自由参数，║║为范数符号，将2次幂的Frobenius范数作为矩阵范数，可以求得上述优化模型的解Z、Z和Z。将贡献矩阵Z、Z和Z的取值分别带入到对应似然矩阵的计算公式，由此得到似然矩阵的计算公式：S＝α1W-1WTWS＝α2WT-1WWS＝α3WW-1WT对于不同大小的封闭子图，S、S、S的大小可能是不同的，此外，即使对同一封闭子图，由于封闭子图中节点的随机标记，导致似然矩阵的每个元素也可能是不固定的，因此采用一致的节点排序方法来为每个封闭子图中的节点进行编码，最终得到三个似然矩阵，可以方便神经网络的训练。在一个实施例中，S3中对三个似然矩阵进行处理，相应得到三个排序后的似然矩阵，具体包括：S31、从三个似然矩阵中任取一个似然矩阵，基于似然矩阵，对封闭子图中的非中心节点计算重要性得分，并根据重要性分数对非中心节点进行降序排序；S32、计算封闭子图中的节点数，将节点数与预设节点阈值进行比较，若节点数小于预设节点阈值，即|V|＜K，执行步骤S33，否则，若节点数大于等于预设节点阈值，即|V|≥K，执行步骤S34；S33、将似然矩阵用0填充至K维方阵，由此得到排序后的似然矩阵；S34、将排序靠后的|V|-K个节点将从封闭子图中删除，将删除的节点对应的似然值从似然矩阵中删除，由此得到排序后的似然矩阵。S35、从三个似然矩阵中再取另一个似然矩阵，直至三个似然矩阵均被提取，经过步骤S31至S34处理，相应得到三个排序后的似然矩阵。在一个实施例中，S31中对封闭子图中的非中心节点计算重要性得分，重要性得分的具体计算公式为：式中，为封闭子图中编码为第x个节点基于第k个似然矩阵的重要性得分，k＝1,2,3，| |代表绝对值，/＞为第k个似然矩阵中第1行第x列的似然值，/＞为第k个似然矩阵中第x行第1列的似然值,/＞为第k个似然矩阵中第2行第x列的似然值，/＞为第k个似然矩阵中第x行第2列的似然值。参见图2，图2为本发明一实施例中通过一个封闭子图得到对应向量的过程示意图。以得到的三个似然矩阵中的任一个为例，对似然矩阵进行处理，相应得到排序后的似然矩阵，具体过程如下：1)计算封闭子图中的非中心节点的重要性得分，并根据重要性得分对似然矩阵中的节点进行降序排序，用非中心节点对中心节点的似然值之和作为重要性得分，以此来衡量该节点对待预测边的符号预测的重要性：式中，| |代表绝对值，为封闭子图中编码为第x个节点基于第k个似然矩阵的重要性得分，k＝1,2,3，/＞为第k个似然矩阵中第1行第x列的似然值，也就是封闭子图中编码为1的节点到编码为x的节点形成的边的似然值，/＞为第k个似然矩阵中第x行第1列的似然值，也就是封闭子图中编码为x的节点到编码为1的节点形成的边的似然值,/＞为第k个似然矩阵中第2行第x列的似然值，也就是封闭子图中编码为2的节点到编码为x的节点形成的边的似然值,/＞为第k个似然矩阵中第x行第2列的似然值,也就是封闭子图中编码为x的节点到编码为2的节点形成的边的似然值。2)计算重要性得分后，封闭子图中节点的顺序可以按重要性得分降序排列|位)。3)计算封闭子图中的节点数|V|，将计算得到的节点数|V|与预设节点阈值K比较，若节点数小于预设节点阈值，则将对应的似然矩阵用0填充至K维方阵，以此作为排序后的似然矩阵；反之，若计算得到的节点数大于等于预设节点阈值，此时将排序靠后的|V|-K个节点删除，将删除的节点对应的似然值从似然矩阵中删除，得到处理后的K维矩阵，以此作为排序后的似然矩阵。在一个实施例中，S3中将三个排序后的似然矩阵进行拼接，得到待预测边对应的向量，具体包括：S36、分别删除三个排序后的似然矩阵对角线上的元素，将排序后的似然矩阵中的剩余元素摊平，得到排序后的似然矩阵对应的三个向量；S37、将三个排序后的似然矩阵对应的向量进行拼接，得到待预测边对应的向量。具体地，假设三个排序后的似然矩阵均为5*5维方阵，删除每个似然矩阵对角线元素后，并将剩余元素摊平为一个20维的向量，由此得到三个20维的向量，把三个20维向量拼接为一个60维向量，以此作为待预测边对应的向量，将60维向量输入至训练后的全连接神经网络二分类器，经过处理，输出链路符号预测得分，根据链路符号预测得分得到待预测边对应的符号预测结果。进一步地，对上述一种基于线性优化封闭子图编码的链路符号预测方法的预测效果进行实验验证。参见表1，表1中列举了基于不同网络的链路预测方法。表1链路预测方法在表1中，采用五个真实世界的网络，包括Bitcoin-Alpha、Bitcoin-OTC、WikiRfA、Slashdot和Epinions作为实验数据集。其中，Bitcoin-Alpha、Bitcoin-OTC是两个刻画信任关系的用户网络；WikiRfA是维基百科用户的投票网络，每个用户可以通过投票支持或反对其他用户的推广；Slashdot是一个技术相关的新闻网站，它推出了SlashdotZoo，允许用户互相标记为朋友或敌人；Epinions是一个综合性的消费者评论网站，它根据消费者对他人评论的信任或不信任，建立起一个刻画信任关系的在线社交网络。为了比较本申请中的方法以及现有方法的性能，我们将本申请中的方法与特征工程和符号图嵌入两类常用链路符号预测方法对比。本申请中设置封闭子图的节点阈值K＝5，自由参数α1＝0.005、α2＝0.005、α3＝0.005。采用了一个由3个隐层和softmax输出层组成的全连接的神经网络。所有隐藏层的激活函数均采用ReLU，更新规则采用Adam优化，batch大小为512，学习率为0.001，epoch的数量设置为100。上述一种基于线性优化封闭子图编码的链路符号预测方法，通过边预加权策略和线性优化模型对待预测边的封闭子图的中的边进行两阶段的加权得到似然矩阵，再依据似然值对节点排序，得到排序后的似然矩阵，使得排序后的似然矩阵包含子图丰富拓扑信息。利用排序后的似然矩阵代替预加权邻接矩阵作为子图编码器，排序后的似然矩阵加强了封闭子图的层次结构和负边的重要性。实验结果表明，本申请所提出的SELO模型在所有6个真实网络和4个评价指标上都优于现有的特征工程方法和图嵌入方法。以上对本发明所提供的一种基于线性优化封闭子图编码的链路符号预测方法进行了详细介绍。本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的核心思想。应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以对本发明进行若干改进和修饰，这些改进和修饰也落入本发明权利要求的保护范围内。
