标题title
一种脑卒中风险预测方法和系统
摘要abst
本申请涉及一种脑卒中风险预测方法和系统。系统包括：信息收集模块，用于获取脑卒中高危人群的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据；信息处理分析模块，用于对信息收集模块的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据进行特征提取和分析；脑卒中风险预测模块，用于根据信息处理分析模块得到的特征进行脑卒中风险预测；交互模块，用于显示脑卒中风险预测模块预测出的脑卒中风险等级，根据脑卒中风险预测结果的变化情况，经医生调整确认后，及时告知用户。
权利要求书clms
1.一种脑卒中风险预测方法，其特征在于，包括以下步骤：获取脑卒中高危人群的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据；对所述脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据进行特征提取和分析；根据分析得到的特征进行脑卒中风险预测，其中，对静息态下的血压和脑氧数据进行耦合计算，以得到用户的脑血流调节数据指数，对静息态下的脉搏波和脑氧数据通过功率谱计算方法，以得到用户的脑血流压力数据指数，对采集的脉搏波数据和皮肤电数据通过提取两个信号的时域和频域特征，建立脉搏-皮电的情绪数据指数，并且对采集的睡眠体动次数和深睡时间、心率和呼吸的数据计算得出睡眠质量指数。2.根据权利要求1所述的脑卒中风险预测方法，其特征在于，根据以下公式计算所述脑血流调节数据指数：其中Dnp为脑血流调节数据指数，BRLC为用户的血压数据与左侧脑区脑氧数据的耦合值，BRRC为用户的血压数据与右侧脑区脑氧数据的耦合值，λ为校正系数。3.根据权利要求2所述的脑卒中风险预测方法，其特征在于，所述血压数据与左侧脑区脑氧数据的耦合值BRLC以及所述血压数据与右侧脑区脑氧数据的耦合值BRRC分别计算如下：其中，N为左侧脑区的通道数量，BRi为血压连续时间序列与左侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLi为左侧脑区中通道i的脑氧信号的自功率谱；其中，M为右侧脑区的通道数量，BRj为血压连续时间序列与右侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLj为右侧脑区中通道j的脑氧信号的自功率谱。4.根据权利要求1所述的脑卒中风险预测方法，其特征在于，对静息态下的脉搏波和脑氧数据通过功率谱计算方法，得到用户的脑血流压力数据指数：其中，MRbp为脑血流压力数据指数，即不同通道的脑血氧信号与脉搏波的耦合强度，N+M为用户左右两侧脑区的脑氧通道数量，MRi为脉搏波时间序列与不同通道的脑氧信号的功率谱，Pu为脉搏波时间序列的自功率谱，NRi为通道i的脑氧信号的自功率谱。5.根据权利要求1所述的脑卒中风险预测方法，其特征在于，如下提取脉搏波信号的时域和频域特征，以建立脉搏-皮电的情绪数据指数：通过长短时记忆网络对脉搏波信号进行时频域特征提取，输出脉搏波特征向量PuLSTM：PuLSTM＝σ+tanh其中,σ为激活函数，WLSTM1、WLSTM2为长短时记忆网络输入门和遗忘门的权重，BLSTM1、BLSTM2为长短时记忆网络输入门和遗忘门的偏置，Pu为输入的脉搏波信号。6.根据权利要求5所述的脑卒中风险预测方法，其特征在于，如下提取皮肤电信号的时域和频域特征，以输出皮肤电特征向量GSRLSTM：GSRLSTM＝σ+tanh其中,σ为激活函数，WLSTM3、WLSTM4为长短时记忆网络输入门和遗忘门的权重，BLSTM3、BLSTM4为长短时记忆网络输入门和遗忘门的偏置，GSR为输入的皮肤电信号。7.根据权利要求6所述的脑卒中风险预测方法，其特征在于，基于多粒度双向注意力机制对脉搏波特征向量和皮肤电特征向量进行特征融合，其中，脉搏波特征向量多粒度双向注意力机制的权重公式为：其中wPuj为脉搏波特征向量第j个特征的权重值，ρj为脉搏波特征向量第j个特征的波动值，PuLSTMj为脉搏波特征向量的第j个特征，n为脉搏波特征向量的第n个特征；其中，皮肤电特征向量多粒度双向注意力机制的权重公式为：其中wGSRj为皮肤电特征向量第j个特征的权重值，为皮肤电特征向量第j个特征的波动值，GSRLSTMj为皮肤电特征向量的第j个特征，n为皮肤电特征向量的第n个特征，将以上的各个特征进行耦合，融合后的特征向量为：8.根据权利要求7所述的脑卒中风险预测方法，其特征在于，将融合后的特征向量PuGSRLSTM输入到softmax分类器中进行情感识别，E＝softmax其中，E为情绪分类结果，Wk、Bk是分类器softmax的参数，统计一天中用户消极情绪的次数所占的比重作为情绪数据指数：其中，P为情绪数据指数，sort为一天中用户消极情绪的次数。9.根据权利要求1所述的脑卒中风险预测方法，其特征在于，根据以下公式计算睡眠质量指数：S＝GCNN-LSTM其中，Cm、T、HR、LC为用户睡眠后的体动次数和深睡时间、心率和呼吸参数，GCNN-LSTM为训练好卷积-长短时记忆神经网络模型，S为用户的睡眠质量指数。10.一种脑卒中风险预测系统，其特征在于，包括：信息收集模块，用于获取脑卒中高危人群的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据；信息处理分析模块，用于对信息收集模块所收集的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据进行特征提取和分析；脑卒中风险预测模块，用于根据由信息处理分析模块分析得到的特征进行脑卒中风险预测；交互模块，用于显示脑卒中风险预测模块预测出的脑卒中风险等级，其中，所述信息处理分析模块包括血压-脑氧耦合指标模块、脉搏-脑氧耦合指标模块、情绪指标模块和睡眠质量指标模块，其中所述血压-脑氧耦合模块是对静息态下的血压和脑氧数据进行耦合计算，以得到用户的脑血流调节数据指数，其中所述脉搏-脑氧耦合模块是对静息态下的脉搏波和脑氧数据通过功率谱计算方法，以得到用户的脑血流压力数据指数，其中所述情绪指标模块是对采集的脉搏波数据和皮肤电数据通过提取两个信号的时域和频域特征，建立脉搏-皮电的情绪数据指数，其中所述睡眠质量指标模块是对采集的睡眠体动次数和深睡时间、心率和呼吸的数据计算得出睡眠质量指数。
说明书desc
技术领域本发明涉及健康管理领域，特别涉及一种脑卒中风险预测方法和系统。背景技术脑卒中具有高发病率、高致残率、高死亡率、高复发率、高经济负担五大特点，给家庭和社会造成了巨大负担。现阶段，主要是通过对临床生化数据指标、影像学等信息进行计算和分析，进行脑卒中早期风险预测，但是基于生化和影像学的脑卒中风险预测需要到医疗机构进行专业检查，依赖大型的临床医疗设备，实际推广应用存在一定的局限性，并未能高效、简便、及时的对脑卒中风险进行预测。为此，本发明研究设计脑卒中风险预测方法及系统，能够较为方便、准确的对脑卒中的风险进行预测，及早发现，在健康管理领域具有非常广泛的应用前景。发明内容为实现本发明之目的，采用以下技术方案予以实现：本发明的一个方面提供了一种脑卒中风险预测方法，包括以下步骤：获取脑卒中高危人群的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据；对所述脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据进行特征提取和分析；根据分析得到的特征进行脑卒中风险预测，其中，对静息态下的血压和脑氧数据进行耦合计算，以得到用户的脑血流调节数据指数，对静息态下的脉搏波和脑氧数据通过功率谱计算方法，以得到用户的脑血流压力数据指数，对采集的脉搏波数据和皮肤电数据通过提取两个信号的时域和频域特征，建立脉搏-皮电的情绪数据指数，并且对采集的睡眠体动次数和深睡时间、心率和呼吸的数据计算得出睡眠质量指数。在一个有利实施例中，根据以下公式计算所述脑血流调节数据指数：其中Dnp为脑血流调节数据指数，BRLC为用户的血压数据与左侧脑区脑氧数据的耦合值，BRRC为用户的血压数据与右侧脑区脑氧数据的耦合值，λ为校正系数。优选地，所述血压数据与左侧脑区脑氧数据的耦合值BRLC以及所述血压数据与右侧脑区脑氧数据的耦合值BRRC分别计算如下：其中，N为左侧脑区的通道数量，BRi为血压连续时间序列与左侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLi为左侧脑区中通道i的脑氧信号的自功率谱；其中，M为右侧脑区的通道数量，BRj为血压连续时间序列与右侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLj为右侧脑区中通道j的脑氧信号的自功率谱。在另一个有利实施例中，对静息态下的脉搏波和脑氧数据通过功率谱计算方法，得到用户的脑血流压力数据指数：其中，MRbp为脑血流压力数据指数，即不同通道的脑血氧信号与脉搏波的耦合强度，N+M为用户左右两侧脑区的脑氧通道数量，MRi为脉搏波时间序列与不同通道的脑氧信号的功率谱，Pu为脉搏波时间序列的自功率谱，NRi为通道i的脑氧信号的自功率谱。在又一个有利实施例中，如下提取脉搏波信号的时域和频域特征，以建立脉搏-皮电的情绪数据指数：通过长短时记忆网络对脉搏波信号进行时频域特征提取，输出脉搏波特征向量PuLSTM：PuLSTM＝σ+tanh其中,σ为激活函数，WLSTM1、WLSTM2为长短时记忆网络输入门和遗忘门的权重，BLSTM1、BLSTM2为长短时记忆网络输入门和遗忘门的偏置，Pu为输入的脉搏波信号。优选地，如下提取皮肤电信号的时域和频域特征，以输出皮肤电特征向量GSRLSTM：GSRLSTM＝σ+tanh其中,σ为激活函数，WLSTM3、WLSTM4为长短时记忆网络输入门和遗忘门的权重，BLSTM3、BLSTM4为长短时记忆网络输入门和遗忘门的偏置，GSR为输入的皮肤电信号。进一步优选地，基于多粒度双向注意力机制对脉搏波特征向量和皮肤电特征向量进行特征融合，其中，脉搏波特征向量多粒度双向注意力机制的权重公式为：其中wPuj为脉搏波特征向量第j个特征的权重值，ρj为脉搏波特征向量第j个特征的波动值，PuLSTMj为脉搏波特征向量的第j个特征，n为脉搏波特征向量的第n个特征；其中，皮肤电特征向量多粒度双向注意力机制的权重公式为：其中wGSRj为皮肤电特征向量第j个特征的权重值，为皮肤电特征向量第j个特征的波动值，GSRLSTMj为皮肤电特征向量的第j个特征，n为皮肤电特征向量的第n个特征，将以上的各个特征进行耦合，融合后的特征向量为：PuGSRLSTM＝。有利地，将融合后的特征向量PuGSRLSTM输入到softmax分类器中进行情感识别，E＝softmax其中，E为情绪分类结果，Wk、Bk是分类器softmax的参数，统计一天中用户消极情绪的次数所占的比重作为情绪数据指数：其中，P为情绪数据指数，sort为一天中用户消极情绪的次数。在一个有利实施例中，根据以下公式计算睡眠质量指数：S＝GCNN-LSTM其中，Cm、T、HR、LC为用户睡眠后的体动次数和深睡时间、心率和呼吸参数，GCNN-LSTM为训练好卷积-长短时记忆神经网络模型，S为用户的睡眠质量指数。本发明的另一方面提供了一种脑卒中风险预测系统，包括：信息收集模块，用于获取脑卒中高危人群的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据；信息处理分析模块，用于对信息收集模块所收集的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据进行特征提取和分析；脑卒中风险预测模块，用于根据由信息处理分析模块分析得到的特征进行脑卒中风险预测；交互模块，用于显示脑卒中风险预测模块预测出的脑卒中风险等级，其中，所述信息处理分析模块包括血压-脑氧耦合指标模块、脉搏-脑氧耦合指标模块、情绪指标模块和睡眠质量指标模块，其中所述血压-脑氧耦合模块是对静息态下的血压和脑氧数据进行耦合计算，以得到用户的脑血流调节数据指数，其中所述脉搏-脑氧耦合模块是对静息态下的脉搏波和脑氧数据通过功率谱计算方法，以得到用户的脑血流压力数据指数，其中所述情绪指标模块是对采集的脉搏波数据和皮肤电数据通过提取两个信号的时域和频域特征，建立脉搏-皮电的情绪数据指数，其中所述睡眠质量指标模块是对采集的睡眠体动次数和深睡时间、心率和呼吸的数据计算得出睡眠质量指数。在一个有利实施例中，所述血压-脑氧耦合模块根据以下公式计算所述脑血流调节数据指数：其中Dnp为脑血流调节数据指数，BRLC为用户的血压数据与左侧脑区脑氧数据的耦合值，BRRC为用户的血压数据与右侧脑区脑氧数据的耦合值，λ为校正系数。在另一个有利实施例中，所述血压数据与左侧脑区脑氧数据的耦合值BRLC以及所述血压数据与右侧脑区脑氧数据的耦合值BRRC分别计算如下：其中，N为左侧脑区的通道数量，BRi为血压连续时间序列与左侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLi为左侧脑区中通道i的脑氧信号的自功率谱；其中，M为右侧脑区的通道数量，BRj为血压连续时间序列与右侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLj为右侧脑区中通道j的脑氧信号的自功率谱。优选地，所述脉搏-脑氧耦合模块根据以下公式计算用户的脑血流压力数据指数：其中，MRbp为脑血流压力数据指数，即不同通道的脑血氧信号与脉搏波的耦合强度，N+M为用户左右两侧脑区的脑氧通道数量，MRi为脉搏波时间序列与不同通道的脑氧信号的功率谱，Pu为脉搏波时间序列的自功率谱，NRi为通道i的脑氧信号的自功率谱。在另一个有利实施例中，所述情绪指标模块如下提取脉搏波信号的时域和频域特征：通过长短时记忆网络对脉搏波信号进行时频域特征提取，输出脉搏波特征向量PuLSTM：PuLSTM＝σ+tanh其中,σ为激活函数，WLSTM1、WLSTM2为长短时记忆网络输入门和遗忘门的权重，BLSTM1、BLSTM2为长短时记忆网络输入门和遗忘门的偏置，Pu为输入的脉搏波信号。优选地，所述情绪指标模块如下提取皮肤电信号的时域和频域特征：GSRLSTM＝σ+tanh其中,σ为激活函数，WLSTM3、WLSTM4为长短时记忆网络输入门和遗忘门的权重，BLSTM3、BLSTM4为长短时记忆网络输入门和遗忘门的偏置，GSR为输入的皮肤电信号。在又一个有利实施例中，基于多粒度双向注意力机制对脉搏波特征向量和皮肤电特征向量进行特征融合，其中，脉搏波特征向量多粒度双向注意力机制的权重公式为：其中，wPuj为脉搏波特征向量第j个特征的权重值，ρj为脉搏波特征向量第j个特征的波动值，PuLSTMj为脉搏波特征向量的第j个特征，n为脉搏波特征向量的第n个特征，其中，皮肤电特征向量多粒度双向注意力机制的权重公式为：其中，wGSRj为皮肤电特征向量第j个特征的权重值，为皮肤电特征向量第j个特征的波动值，GSRLSTMj为皮肤电特征向量的第j个特征，n为皮肤电特征向量的第n个特征，将以上的各个特征进行耦合，融合后的特征向量为：PuGSRLSTM＝。在又一个有利实施例中，将融合特征PuGSRLSTM输入到softmax分类器中进行情感识别，E＝softmax其中，E为情绪分类结果，Wk、Bk是分类器softmax的参数。所述睡眠质量指标模块根据以下公式计算睡眠质量指数：S＝GCNN-LSTM其中，Cm、T、HR、LC为用户睡眠后的体动次数和深睡时间、心率和呼吸参数，GCNN-LSTM为训练好卷积-长短时记忆神经网络模型，S为用户的睡眠质量指数。与现有技术相对比，本发明的有益效果是：通过建立血压-脑氧耦合模型、脉搏-脑氧耦合模型、情绪模型和睡眠质量模型等4中模型，综合分析脑卒中高危人群的脑血流调节数据指数、脑血流压力数据指数、情绪数据指数、睡眠质量指数，进行脑卒中风险预测，充分发挥多源异构数据的关联性和互补性。通过采集低成本、易监测的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据等对脑卒中高危人群进行高效、简便、及时的风险预测，使脑卒中风险预测更具有操作性和实际应用价值。利用该方法和系统，能够通过收集脑卒中脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据，进行定期的脑卒中风险预测，能够使脑卒中高危人群人群获得更加精准的脑卒中风险预测结果，从而提醒脑卒中高危人群人群根据预测的结果及时采取干预措施，降低脑卒中发病风险。附图说明在附图中，除非另外规定，否则贯穿多个附图相同的附图标记表示相同或相似的部件或元素。这些附图不一定是按照比例绘制的。应该理解，这些附图仅描绘了根据本发明公开的一些实施方式，而不应将其视为是对本发明范围的限制。图1为本发明脑卒中风险预测系统示意图；图2为根据本发明的脑卒中风险预方法的流程图。具体实施方式在下文中，仅简单地描述了某些示例性实施例。正如本领域技术人员可认识到的那样，在不脱离本发明的精神或范围的情况下，可通过各种不同方式修改所描述的实施例。因此，附图和描述被认为本质上是示例性的而非限制性的。下面结合附图1和2对本发明的具体实施方式进行详细说明。如图1所示，本发明的脑卒中风险预测系统包括信息收集模块、信息处理分析模块、脑卒中风险预测模块、交互模块。信息收集模块用于获取脑卒中高危人群的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据。脑氧数据是利用便携式近红外光谱仪连续监测用户15分钟静息态下的脑氧信息。血压数据是利用连续血压监测仪连续监测用户15分钟的血压信息，并且与脑氧数据进行同步监测。脉搏波数据和皮肤电数据是利用智能手环连续监测用户的脉搏波和皮肤电信息。睡眠数据是利用智能床垫连续监测睡眠体动次数和深睡时间、心率和呼吸等数据信息。信息处理分析模块用于对信息收集模块的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据进行特征提取和分析。脑卒中风险预测模块用于根据信息处理分析模块得到的特征进行脑卒中风险预测。交互模块用于显示脑卒中风险预测模块预测出的脑卒中风险等级，根据脑卒中风险预测结果的变化情况，经医生调整确认后，及时告知用户。如图2所示，在脑卒中风险预测系统中，信息处理分析模块包括血压-脑氧耦合指标模块、脉搏-脑氧耦合指标模块、情绪指标模块和睡眠质量指标模块。血压-脑氧耦合模块是对静息态下的血压和脑氧数据进行耦合计算，得到用户的脑血流调节数据指数。情绪指标模块是对采集的脉搏波数据和皮肤电数据通过提取两个信号时域和频域特征，建立脉搏-皮电的情绪数据指数。脉搏-脑氧耦合模块是对静息态下的脉搏波和脑氧数据通过功率谱计算方法，得到用户的脑血流压力数据指数。睡眠质量指标模块是对采集的睡眠体动次数和深睡时间、心率和呼吸等数据计算得出睡眠质量指数。血压-脑氧耦合模块根据以下公式计算所述脑血流调节数据指数：其中Dnp为脑血流调节数据指数，BRLC为用户的血压数据与左侧脑区脑氧数据的耦合值，BRRC为用户的血压数据与右侧脑区脑氧数据的耦合值，λ为校正系数。血压数据与左侧脑区脑氧数据的耦合值BRLC以及所述血压数据与右侧脑区脑氧数据的耦合值BRRC分别计算如下：其中，N为左侧脑区的通道数量，BRi为血压连续时间序列与左侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLi为左侧脑区中通道i的脑氧信号的自功率谱；其中，M为右侧脑区的通道数量，BRj为血压连续时间序列与右侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLj为右侧脑区中通道j的脑氧信号的自功率谱。脉搏-脑氧耦合模块根据以下公式计算用户的脑血流压力数据指数：其中，MRbp为脑血流压力数据指数，即不同通道的脑血氧信号与脉搏波的耦合强度，N+M为用户左右两侧脑区的脑氧通道数量，MRi为脉搏波时间序列与不同通道的脑氧信号的功率谱，Pu为脉搏波时间序列的自功率谱，NRi为通道i的脑氧信号的自功率谱。情绪指标模块如下提取脉搏波信号的时域和频域特征：通过长短时记忆网络对脉搏波信号进行时频域特征提取，输出脉搏波特征向量PuLSTM：PuLSTM＝σ+tanh其中,σ为激活函数，WLSTM1、WLSTM2为长短时记忆网络输入门和遗忘门的权重，BLSTM1、BLSTM2为长短时记忆网络输入门和遗忘门的偏置，Pu为输入的脉搏波信号。情绪指标模块如下提取皮肤电信号的时域和频域特征：GSRLSTM＝σ+tanh其中,σ为激活函数，WLSTM3、WLSTM4为长短时记忆网络输入门和遗忘门的权重，BLSTM3、BLSTM4为长短时记忆网络输入门和遗忘门的偏置，GSR为输入的皮肤电信号。基于多粒度双向注意力机制对脉搏波特征向量和皮肤电特征向量进行特征融合，其中，脉搏波特征向量多粒度双向注意力机制的权重公式为：其中，wPuj为脉搏波特征向量第j个特征的权重值，ρj为脉搏波特征向量第j个特征的波动值，PuLSTMj为脉搏波特征向量的第j个特征，n为脉搏波特征向量的第n个特征，其中，皮肤电特征向量多粒度双向注意力机制的权重公式为：其中，wGSRj为皮肤电特征向量第j个特征的权重值，为皮肤电特征向量第j个特征的波动值，GSRLSTMj为皮肤电特征向量的第j个特征，n为皮肤电特征向量的第n个特征，将以上的各个特征进行耦合，融合后的特征向量为：PuGSRLSTM＝。在又一个有利实施例中，将融合特征PuGSRLSTM输入到softmax分类器中进行情感识别，E＝softmax其中，E为情绪分类结果，Wk、Bk是分类器softmax的参数。睡眠质量指标模块根据以下公式计算睡眠质量指数：S＝GCNN-LSTM其中，Cm、T、HR、LC为用户睡眠后的体动次数和深睡时间、心率和呼吸参数，GCNN-LSTM为训练好卷积-长短时记忆神经网络模型，S为用户的睡眠质量指数。以下接合图2描述利用根据本发明的脑卒中风险预测模块进行脑卒中风险预测的方法。该方法包括以下步骤：获取脑卒中高危人群的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据；对所述脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据进行特征提取和分析；根据分析得到的特征进行脑卒中风险预测，其中，对静息态下的血压和脑氧数据进行耦合计算，以得到用户的脑血流调节数据指数，对静息态下的脉搏波和脑氧数据通过功率谱计算方法，以得到用户的脑血流压力数据指数，对采集的脉搏波数据和皮肤电数据通过提取两个信号的时域和频域特征，建立脉搏-皮电的情绪数据指数，并且对采集的睡眠体动次数和深睡时间、心率和呼吸的数据计算得出睡眠质量指数。血压-脑氧耦合模块根据以下公式计算用户的脑血流调节数据指数：其中Dnp为脑血流调节数据指数，BRLC为用户的血压数据与左侧脑区脑氧数据的耦合值，BRRC为用户的血压数据与右侧脑区脑氧数据的耦合值，λ为校正系数。血压数据与左侧脑区脑氧数据的耦合值BRLC计算如下：其中，N为左侧脑区的通道数量，BRi为血压连续时间序列与左侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLi为左侧脑区中通道i的脑氧信号的自功率谱。血压数据与右侧脑区脑氧数据的耦合值BRRC计算如下：其中，M为右侧脑区的通道数量，BRj为血压连续时间序列与右侧脑区不同通道的脑氧信号的功率谱，BP为血压连续时间序列的自功率谱，NRLj为右侧脑区中通道j的脑氧信号的自功率谱。脉搏-脑氧耦合模块根据以下公式计算用户的脑血流压力数据指数：其中，MRbp为脑血流压力数据指数，即不同通道的脑血氧信号与脉搏波的耦合强度，N+M为用户左右两侧脑区的脑氧通道数量，MRi为脉搏波时间序列与不同通道的脑氧信号的功率谱，Pu为脉搏波时间序列的自功率谱，NRi为通道i的脑氧信号的自功率谱。情绪指标模块根据以下步骤建立脉搏-皮电的情绪数据指数：S1：利用巴特沃斯低通滤波器去除脉搏波信号的噪声干扰，基于样条插值和标准差的方法去除伪迹，得到预处理后的脉搏波信号Pu；利用2s的时间窗作为基线值去除皮肤电信号中的噪声干扰，保持信号的原始特性，得到预处理后的皮肤电信号GSR。S2：通过长短时记忆网络对脉搏波信号进行时频域特征提取，输出脉搏波特征向量PuLSTM：PuLSTM＝σ+tanh其中,σ为激活函数，WLSTM1、WLSTM2为长短时记忆网络输入门和遗忘门的权重，BLSTM1、BLSTM2为长短时记忆网络输入门和遗忘门的偏置，Pu为输入的脉搏波信号。S3：通过长短时记忆网络对皮肤电信号进行时频域特征提取，输出皮肤电特征向量GSRLSTM。GSRLSTM＝σ+tanh其中,σ为激活函数，WLSTM3、WLSTM4为长短时记忆网络输入门和遗忘门的权重，BLSTM3、BLSTM4为长短时记忆网络输入门和遗忘门的偏置，GSR为输入的皮肤电信号。S4：基于多粒度双向注意力机制对脉搏波特征向量和皮肤电特征向进行特征融合。脉搏波特征向量多粒度双向注意力机制的权重公式为：其中，wPuj为步骤2得到的脉搏波特征向量第j个特征的权重值，ρj为脉搏波特征向量第j个特征的波动值，PuLSTMj为脉搏波特征向量的第j个特征，n为脉搏波特征向量的第n个特征。皮肤电特征向量多粒度双向注意力机制的权重公式为：其中，wGSRj为步骤3得到的皮肤电特征向量第j个特征的权重值，为皮肤电特征向量第j个特征的波动值，GSRLSTMj为皮肤电特征向量的第j个特征，n为皮肤电特征向量的第n个特征。融合后的特征向量为：PuGSRLSTM＝。S5：将步骤4中得到的融合特征PuGSRLSTM输入到softmax分类器中进行情感识别，并将情绪识别结果分为：消极、中性、积极。E＝softmax其中，E为情绪分类结果，Wk、Bk是分类器softmax的参数。优选地，当E取值为为消极情绪。S6：提取用户每天早上6点到晚上10点之间的脉搏波和皮肤电数据，将每隔10分钟的数据按照步骤S1-S5进行处理，得到每隔10分钟的情绪结果，统计一天中用户消极情绪的次数所占的比重作为情绪数据指数。其中，P为情绪数据指数，sort为一天中用户消极情绪的次数。睡眠质量指标模块根据以下公式计算睡眠质量指数：S＝GCNN-LSTM其中，Cm、T、HR、LC为用户睡眠后的体动次数和深睡时间、心率和呼吸参数，GCNN-LSTM为训练好卷积-长短时记忆神经网络模型，S为用户的睡眠质量指数。进一步地，睡眠质量指数主要是通过分析智能床垫晚上10点到第二天早上6点之间用户处于睡眠状态期间的体动次数和深睡时间、心率和呼吸等数据。在脑卒中风险预测系统中，脑卒中风险预测模块用于根据信息处理分析模块得到的特征进行脑卒中风险预测，预测结果如下：K＝A1*Dnp+A2*MRbp+A3*P+A4*S其中，K为脑卒中风险等级，高危一级、高危二级、高危三级，A1、A2、A3、A4分别为系数。当脑血流调节数据指数和压力指数两周内任一个连续3次及以上分别超过各自阈值，情绪指数和睡眠质量指数连续7天均未超过各自阈值，则A1＝1或A2＝1，A3＝A4＝0，此时脑卒中风险等级为高危一级；当脑血流调节数据指数和压力指数两周内连续3次均超过阈值，情绪指数和睡眠质量指数连续7天均未超过各自阈值，则A1＝A2＝1，A3＝A4＝0，此时脑卒中风险等级为高危二级，当脑血流调节数据指数和压力指数两周内任一个连续3次及以上分别超过各自阈值，情绪指数和睡眠质量指数连续7天超过阈值，A1＝A2＝1，A3＝A4＝1则为高危三级。最后，显示脑卒中风险预测模块预测出的脑卒中风险等级，根据脑卒中风险预测结果的变化情况，经医生调整确认后，及时告知用户。根据本申请，对某用户的脑卒中风险进行预测，首先对该用户最近2个周的脑氧数据、血压数据、脉搏波数据、皮肤电数据以及睡眠数据等进行连续采集、监测、预处理，然后计算用户的血压-脑氧耦合指标模块、脉搏-脑氧耦合指标模块、情绪指标模块和睡眠质量指标模块，获取用户每天的脑血流调节数据指数、脑血流压力指数、情绪指数和睡眠质量指数，再判断用户每天脑血流调节数据指数、脑血流压力指数、情绪指数和睡眠质量指数是否超过阈值，最后根据用户近2周内的脑血流调节数据指数、脑血流压力指数、情绪指数和睡眠质量指数超过阈值的情况，综合判断得出用户的脑卒中风险结果。例如若得出的用户的脑卒中风险等级为高危三级，则用户即可及时进行就医，从而降低脑卒中发病风险。上述概述仅仅是为了说明的目的，并不意图以任何方式进行限制。除上述描述的示意性的方面、实施方式和特征之外，通过参考附图和以下的详细描述，本发明进一步的方面、实施方式和特征将会是容易明白的。
