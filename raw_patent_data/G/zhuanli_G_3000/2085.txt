标题title
一种基于消息传递的非线性动态系统状态估计方法和装置
摘要abst
本发明提供一种基于消息传递的非线性动态系统状态估计方法和装置，首先建立非线性动态系统并转换为因子图；获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点中正向和反向传递的消息对应的均值和方差并进行消息初始化；最后利用消息传递算法对正向和反向传递过程中产生的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计；本发明不需要转移矩阵，可以应用于更广泛的非线性动态系统状态估计，同时也可以降低非高斯测量噪声对系统性能的影响，能够提高状态信号重构的精度。
权利要求书clms
1.一种基于消息传递的非线性动态系统状态估计方法，其特征在于，包括以下步骤：S1：建立非线性动态系统并转换为因子图；所述非线性动态系统用于根据观测信号对状态信号进行状态估计；所述因子图包括若干个变量节点和因子节点；S2：获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；S3：利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。2.根据权利要求1所述的一种基于消息传递的非线性动态系统状态估计方法，其特征在于，所述步骤S1中建立的非线性动态系统的状态空间方程具体为：其中，为第k时刻的状态信号，满足：/＞，/＞；/＞为转移矩阵，满足/＞；/＞为第k时刻的状态噪声，满足/＞；/＞为第k时刻的观测矩阵，满足：；/＞为第k时刻的观测信号，满足：/＞；/＞为第k时刻的观测噪声，满足：/＞；Q为非线性分式函数；K、M和N均为正整数；将转移矩阵的第i行的元素记为/＞，并对应引入第一中间变量/＞，其中，/＞，得到如下方程：其中，为第k时刻的状态信号/＞中的第i个元素，/＞为第k时刻的状态噪声/＞中的第i个元素。3.根据权利要求2所述的一种基于消息传递的非线性动态系统状态估计方法，其特征在于，所述步骤S1中因子图的变量节点和因子节点具体为：所述变量节点包括：节点、/＞节点、/＞节点、/＞节点、/＞节点、/＞节点、/＞节点和/＞节点；其中，为第二中间变量，/＞为第三中间变量，/＞为第四中间变量，/＞为第五中间变量；所述因子节点包括：节点集、/＞节点、/＞节点、节点、/＞节点、/＞节点、/＞节点、/＞节点和/＞节点，且满足/＞，/＞；所述节点集包括并列设置的/＞~/＞共N个节点；其中，为第一脉冲，/＞为第二脉冲，/＞为第三脉冲，为第四脉冲，/＞为第五脉冲；/＞节点为第六脉冲，/＞为/＞对的条件概率，/＞为/＞的概率，/＞为/＞对/＞的条件概率；在所述因子图中，包括结构相同且依次连接的个基本结构；在第个基本结构中，与/＞节点连接的一个分支为：依次连接的/＞节点、/＞节点和/＞节点；与/＞节点连接的另一个分支为：依次连接的/＞节点和/＞节点；节点的另一端分别连接/＞节点集中的所有/＞节点；每个节点包括两个分支，其中一个分支为：依次连接的/＞节点、节点、/＞节点和/＞节点；另一个分支为：依次连接的/＞节点、/＞节点、/＞节点和/＞节点；每个节点分别与/＞节点连接，/＞节点的另一端依次连接节点和/＞节点；按照从1~/＞重复基本结构并依次连接，且/＞节点还分别与每个基本结构中的节点集连接，获取所述因子图。4.根据权利要求3所述的一种基于消息传递的非线性动态系统状态估计方法，其特征在于，所述步骤S2中，根据以下公式计算消息在高斯投影下对应的均值和方差：其中，为因子图中的任意节点，/＞为对应的消息，/＞为对应消息的均值，/＞为对应消息的方差。5.根据权利要求4所述的一种基于消息传递的非线性动态系统状态估计方法，其特征在于，所述步骤S2中，在因子图各节点之间正向和反向传递的消息及其在高斯投影下对应的均值和方差具体为：将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；/＞为取向量/＞第i个元素；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞。6.根据权利要求5所述的一种基于消息传递的非线性动态系统状态估计方法，其特征在于，所述步骤S2中的先验消息包括：第k时刻的观测矩阵、第k时刻的观测信号、状态信号的先验分布/＞、转移矩阵每一行元素的先验分布/＞，以及第k时刻的状态噪声/＞和观测噪声/＞的转移概率/＞和/＞。7.根据权利要求6所述的一种基于消息传递的非线性动态系统状态估计方法，其特征在于，所述步骤S2中的消息初始化具体为：初始化所有正向传递的消息对应的均值和方差，包括：，/＞，/＞，/＞，， /＞，/＞，/＞；所述初始化还包括：初始化，/＞，/＞，；其中，表示对应元素相除，/＞表示生成以列向量a为对角线元素的对角矩阵。8.根据权利要求7所述的一种基于消息传递的非线性动态系统状态估计方法，其特征在于，所述步骤S3的具体方法为：利用消息传递算法，令，依次进行以下迭代：的具体计算过程为：其中，表示/＞的后验分布均值以及方差，其后验分布为/＞；在公式中，/＞，/＞；在公式中，/＞，/＞；表示LMMSE估计器的后验分布均值和协方差，和/＞；迭代完成后，获取并输出最后一次迭代状态信号对应的均值和方差/＞，完成非线性动态系统的状态估计。9.一种基于消息传递的非线性动态系统状态估计装置，应用权利要求1~8任意一项中所述的基于消息传递的非线性动态系统状态估计方法，其特征在于，包括：系统建立单元：用于建立非线性动态系统并转换为因子图；所述非线性动态系统用于根据观测信号对状态信号进行状态估计；所述因子图包括若干个变量节点和因子节点；初始化单元：用于获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；循环迭代单元：用于利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。10.一种计算机可读的存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1~8任意一项所述方法中的步骤。
说明书desc
技术领域本发明涉及非线性动态系统和滤波器技术领域，更具体地，涉及一种基于消息传递的非线性动态系统状态估计方法和装置。背景技术近年来，非线性动态系统的状态估计问题越来越发挥出了重要的作用，其在目标跟踪、信息处理、参数估计及定位等领域都具有重要意义。通常，使用给定的噪声测量信号来提取或推断所期望的动态系统状态可以视为一个贝叶斯框架下的序惯滤波问题。作为状态估计的核心技术，滤波技术已得到了充分的发展。滤波技术将其应用领域从频域扩展到时域，从一维平稳过程到状态空间中描述的多维动态过程，以及从线型高斯模型到非线性动态过程中的非高斯模型。目前，几种流行的滤波技术常用于状态估计问题，诸如数字滤波、卡尔曼滤波、扩展卡尔曼滤波、容积卡尔曼滤波、无迹卡尔曼滤波和粒子滤波等多种非线性滤波方法。上述各种常用的滤波器都可到从噪声测量中估计系统的状态，但它们各自具备不同的特点。数字滤波技术稳定性高，滤波参数易于修改，对于一些简单的数字处理问题普遍使用；然而，其参数需要不断地调整，并且在滤波的过程中可能存在时间的延迟或滞后。现代滤波技术更加注重系统的动态性能，并进行实时的优化，KF不仅适用于平稳随机过程，而且对非平稳的动态过程也有很好的效果；然而其应用限制于高斯噪声的线性系统。UKF通过近似概率密度分布来替代非线性函数的线性化过程，这使得UKF能够处理更复杂的非线性系统，并且实现较高的计算精度；但其参数的选取仍是一个尚未解决的问题，同时其应用也限于高斯噪声。PF摆脱了噪声分布的限制，因此，更广泛的系统模型得以描述和应用；然而，它是以计算成本为代价提高准确性，更重要的是，粒子的多样性可能在重采样的过程中丧失。尽管不适用于非高斯噪声，EKF在计算速度和资源消耗方面具有明显的优势，因此，它被广泛地应用于现代工业系统中的非线性动力学状态估计问题；当所测量的变量仅受到随机噪声污染时，它们一般遵循高斯分布，在这种情况下，大多数的基于EKF的方法都展现出良好的性能，并获得准确的状态估计；然而，在实践中，粗大误差，特别是异常值，时常出现在测量数据中，粗大误差的存在使得高斯测量分布的假设不再满足，同时错误的信息也被引入，其结果是，基于EKF的方法将不能准确地估计状态，工艺优化和控制的性能也会显著恶化。针对上述问题，现有技术公开了一种基于贝叶斯序贯重要性积分的卡尔曼滤波方法，包括建立离散多模型参数非线性高斯系统模型、软约束构建截断先验、融合截断先验和状态后验反馈构建混合高斯重要性分布、修正综合积分点进行预测更新、融合多模参数下目标后验分布；尽管现有技术中的方法能够在无需牺牲计算复杂度的情况下大幅降低平均误差，但在状态估计时仍需要已知转移矩阵，因此非线性动态系统的状态估计存在范围限制。发明内容本发明为克服上述现有技术在状态估计时仍需要已知转移矩阵导致估计范围存在限制的缺陷，提供一种基于消息传递的非线性动态系统状态估计方法和装置，不需要转移矩阵，可以应用于更广泛的非线性动态系统状态估计，同时也可以降低非高斯测量噪声对系统性能的影响，能够提高状态信号重构的精度。为解决上述技术问题，本发明的技术方案如下：一种基于消息传递的非线性动态系统状态估计方法，包括以下步骤：S1：建立非线性动态系统并转换为因子图；所述非线性动态系统用于根据观测信号对状态信号进行状态估计；所述因子图包括若干个变量节点和因子节点；S2：获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；S3：利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。优选地，所述步骤S1中建立的非线性动态系统的状态空间方程具体为：其中，为第k时刻的状态信号，满足：/＞，/＞；/＞为转移矩阵，满足/＞；/＞为第k时刻的状态噪声，满足/＞；/＞为第k时刻的观测矩阵，满足：/＞；/＞为第k时刻的观测信号，满足：/＞；/＞为第k时刻的观测噪声，满足：/＞；Q为非线性分式函数；K、M和N均为正整数；将转移矩阵的第i行的元素记为/＞，并对应引入第一中间变量/＞，其中，，得到如下方程：其中，为第k时刻的状态信号/＞中的第i个元素，/＞为第k时刻的状态噪声/＞中的第i个元素。优选地，所述步骤S1中因子图的变量节点和因子节点具体为：所述变量节点包括：节点、/＞节点、/＞节点、/＞节点、/＞节点、/＞节点、/＞节点和/＞节点；其中，为第二中间变量，/＞为第三中间变量，/＞为第四中间变量，/＞为第五中间变量；所述因子节点包括：节点集、/＞节点、/＞节点、节点、/＞节点、/＞节点、/＞节点、/＞节点和/＞节点，且满足/＞，/＞；所述节点集包括并列设置的/＞~/＞共N个/＞节点；其中，为第一脉冲，/＞为第二脉冲，/＞为第三脉冲，/＞为第四脉冲，/＞为第五脉冲；/＞节点为第六脉冲，/＞为对/＞的条件概率，/＞为/＞的概率，/＞为/＞对/＞的条件概率；在所述因子图中，包括结构相同且依次连接的个基本结构；在第个基本结构中，与/＞节点连接的一个分支为：依次连接的/＞节点、节点和/＞节点；与/＞节点连接的另一个分支为：依次连接的/＞节点和/＞节点；节点的另一端分别连接/＞节点集中的所有/＞节点；每个节点包括两个分支，其中一个分支为：依次连接的/＞节点、节点、/＞节点和/＞节点；另一个分支为：依次连接的/＞节点、/＞节点、/＞节点和/＞节点；每个节点分别与/＞节点连接，/＞节点的另一端依次连接节点和/＞节点；按照从1~/＞重复基本结构并依次连接，且/＞节点还分别与每个基本结构中的节点集连接，获取所述因子图。优选地，所述步骤S2中，根据以下公式计算消息在高斯投影下对应的均值和方差：其中，为因子图中的任意节点，/＞为对应的消息，/＞为对应消息的均值，/＞为对应消息的方差。优选地，所述步骤S2中，在因子图各节点之间正向和反向传递的消息及其对应的均值和方差具体为：将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；/＞为取向量/＞第i个元素；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞。优选地，所述步骤S2中的先验消息包括：第k时刻的观测矩阵、第k时刻的观测信号/＞、状态信号的先验分布/＞、转移矩阵每一行元素的先验分布/＞，以及第k时刻的状态噪声/＞和观测噪声/＞的转移概率/＞和。优选地，所述步骤S2中的消息初始化具体为：初始化所有正向传递的消息对应的均值和方差，包括：，/＞，/＞，/＞，，/＞，/＞，/＞；所述初始化还包括：初始化，/＞，，/＞；其中，表示对应元素相除，/＞表示生成以列向量a为对角线元素的对角矩阵。优选地，所述步骤S3的具体方法为：利用消息传递算法，令，依次进行以下迭代：的具体计算过程为：其中，表示/＞的后验分布均值以及方差，其后验分布为；在公式中，/＞，；在公式中，/＞，；表示LMMSE估计器的后验分布均值和协方差，和/＞；迭代完成后，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。本发明还提供一种基于消息传递的非线性动态系统状态估计装置，应用上述的基于消息传递的非线性动态系统状态估计方法，包括：系统建立单元：用于建立非线性动态系统并转换为因子图；所述非线性动态系统用于根据观测信号对状态信号进行状态估计；所述因子图包括若干个变量节点和因子节点；初始化单元：用于获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；循环迭代单元：用于利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。本发明还提供一种计算机可读的存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述方法中的步骤。与现有技术相比，本发明技术方案的有益效果是：本发明提供一种基于消息传递的非线性动态系统状态估计方法和装置，首先建立非线性动态系统并转换为因子图；获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计；本发明由观测信号去估计状态信号，不需要已知转移矩阵，可以应用于更广泛的非线性动态系统状态估计；同时，本发明可以克服现有技术中非线性动态系统可能存在的非高斯测量噪声对系统性能的影响和滤波技术的不足，且有利于提高状态信号重构的精度。附图说明图1为实施例1所提供的一种基于消息传递的非线性动态系统状态估计方法流程图。图2为实施例2所提供的因子图中各因子连接图。图3为实施例2所提供的因子图中各因子消息传递示意图。图4为实施例3所提供的一种基于消息传递的非线性动态系统状态估计装置结构图。具体实施方式附图仅用于示例性说明，不能理解为对本申请的限制；为了更好说明本实施例，附图某些部件会有省略、放大或缩小，并不代表实际产品的尺寸；对于本领域技术人员来说，附图中某些公知结构及其说明可能省略是可以理解的。下面结合附图和实施例对本发明的技术方案做进一步的说明。实施例1如图1所示，本发明提供一种基于消息传递的非线性动态系统状态估计方法，包括以下步骤：S1：建立非线性动态系统并转换为因子图；所述非线性动态系统用于根据观测信号对状态信号进行状态估计；所述因子图包括若干个变量节点和因子节点；S2：获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；S3：利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。在具体实施过程中，首先建立非线性动态系统并转换为因子图；获取先验消息，将先验消息输入所述非线性动态系统的因子图中，计算在因子图各节点中正向和反向传递过程中产生的消息对应的均值和方差并进行初始化；最后利用消息传递算法对正向和反向传递过程中产生的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计；本方法由观测信号去估计状态信号，不需要已知转移矩阵，可以应用于更广泛的非线性动态系统状态估计；同时，本方法可以克服现有技术中非线性动态系统可能存在的非高斯测量噪声对系统性能的影响和滤波技术的不足，且有利于提高状态信号重构的精度。实施例2本实施例提供一种基于消息传递的非线性动态系统状态估计方法，包括以下步骤：S1：建立非线性动态系统并转换为因子图；所述非线性动态系统用于根据观测信号对状态信号进行状态估计；所述因子图包括若干个变量节点和因子节点；S2：获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；S3：利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计；所述步骤S1中建立的非线性动态系统的状态空间方程具体为：其中，为第k时刻的状态信号，满足：/＞，/＞；/＞为转移矩阵，满足/＞；/＞为第k时刻的状态噪声，满足/＞；/＞为第k时刻的观测矩阵，满足：/＞；/＞为第k时刻的观测信号，满足：/＞；/＞为第k时刻的观测噪声，满足：/＞；Q为非线性分式函数；K、M和N均为正整数；将转移矩阵的第i行的元素记为/＞，并对应引入第一中间变量/＞，其中，，得到如下方程：其中，为第k时刻的状态信号/＞中的第i个元素，/＞为第k时刻的状态噪声/＞中的第i个元素；所述步骤S1中因子图的变量节点和因子节点具体为：所述变量节点包括：节点、/＞节点、/＞节点、/＞节点、/＞节点、/＞节点、/＞节点和/＞节点；其中，为第二中间变量，/＞为第三中间变量，/＞为第四中间变量，/＞为第五中间变量；所述因子节点包括：节点集、/＞节点、/＞节点、节点、/＞节点、/＞节点、/＞节点、/＞节点和/＞节点，且满足/＞，/＞；所述节点集包括并列设置的/＞~/＞共N个/＞节点；其中，为第一脉冲，/＞为第二脉冲，/＞为第三脉冲，/＞为第四脉冲，/＞为第五脉冲；/＞节点为第六脉冲，/＞为对/＞的条件概率，/＞为/＞的概率，/＞为/＞对/＞的条件概率；如图2所示，在所述因子图中，包括结构相同且依次连接的个基本结构；/＞在第个基本结构中，与/＞节点连接的一个分支为：依次连接的/＞节点、节点和/＞节点；与/＞节点连接的另一个分支为：依次连接的/＞节点和/＞节点；节点的另一端分别连接/＞节点集中的所有/＞节点；每个节点包括两个分支，其中一个分支为：依次连接的/＞节点、节点、/＞节点和/＞节点；另一个分支为：依次连接的/＞节点、/＞节点、/＞节点和/＞节点；每个节点分别与/＞节点连接，/＞节点的另一端依次连接节点和/＞节点；按照从1~/＞重复基本结构并依次连接，且/＞节点还分别与每个基本结构中的节点集连接，获取所述因子图；所述步骤S2中，根据以下公式计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差：其中，为因子图中的任意节点，/＞为对应的消息，/＞为对应消息的均值，/＞为对应消息的方差；如图3所示，所述步骤S2中，在因子图各节点中正向和反向传递过程中产生的消息对应的均值和方差具体为：将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应均值和方差为将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；/＞为取向量/＞第i个元素；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为/＞；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将从节点到/＞节点的消息记为/＞，/＞对应的均值和方差为；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；/＞将节点到/＞节点的消息对应的高斯分布的精度矩阵记为/＞，高斯分布指数内的一次项系数向量记为/＞；所述步骤S2中的先验消息包括：第k时刻的观测矩阵、第k时刻的观测信号、状态信号的先验分布/＞、转移矩阵每一行元素的先验分布/＞，以及第k时刻的状态噪声/＞和观测噪声/＞的转移概率/＞和/＞；所述步骤S2中的消息初始化具体为：初始化所有正向传递的消息对应的均值和方差，包括：，/＞，/＞，/＞，，/＞，/＞，/＞；所述初始化还包括：初始化，/＞，，/＞；其中，表示对应元素相除，/＞表示生成以列向量a为对角线元素的对角矩阵；所述步骤S3的具体方法为：利用消息传递算法，令，依次进行以下迭代：/＞/＞的具体计算过程为：其中，表示/＞的后验分布均值以及方差，其后验分布为；在公式中，/＞，；在公式中，/＞，；表示LMMSE估计器的后验分布均值和协方差，和/＞；/＞迭代完成后，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。在具体实施过程中，首先建立非线性动态系统并转换为因子图；获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点中正向和反向传递过程中产生的消息对应的均值和方差并进行初始化；最后利用消息传递算法对正向和反向传递过程中产生的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计；本实施例中的方法还可用于实时相位估计，假设k时刻的状态信号有实部虚部，其中/＞为信号的实部，/＞为信号的虚部；一般只能通过测量得到观测信号/＞，而/＞为标量，即只能测量到状态信号的实部，其中：/＞，为观测噪声；利用本方法可以通过观测信号来估计状态信号的相位，即估计真实信号/＞；其中从k-1时刻信号/＞到k时刻信号/＞相位会经历一个旋转的过程，即，/＞为2×2的旋转矩阵，/＞为转移过程的噪声；构建以下模型并转换为因子图：应用本实施例中的估计方法，观测矩阵，不同时候观测到的信号为/＞；先验分布为/＞；旋转矩阵的先验分布/＞，其中，/＞为高斯分布，/＞矩阵服从以/＞为均值、/＞为方差的高斯分布，/＞为可调参数，/＞为阻尼参数，且；可通过下式求得：其中，为信号旋转频率，/＞为信号采样频率，单位为Hz；转移概率，即方差为/＞均值为/＞的高斯分布，/＞；初始化：,/＞,/＞,/＞,,/＞；利用消息传递算法进行算法迭代，迭代预设次数后输出，就可以得到对状态信号/＞不同时刻的均值和方差的估计，从而做到实时相位估计；本方法由观测信号去估计状态信号，不需要已知转移矩阵，可以应用于更广泛的非线性动态系统状态估计；同时，本方法可以克服现有技术中非线性动态系统可能存在的非高斯测量噪声对系统性能的影响和滤波技术的不足，且有利于提高状态信号重构的精度。实施例3如图4所示，本实施例提供一种基于消息传递的非线性动态系统状态估计装置，应用实施例1或2中所述的基于消息传递的非线性动态系统状态估计方法，包括：系统建立单元301：用于建立非线性动态系统并转换为因子图；所述非线性动态系统用于根据观测信号对状态信号进行状态估计；所述因子图包括若干个变量节点和因子节点；初始化单元302：用于获取先验消息并输入所述非线性动态系统的因子图中，计算在因子图各节点之间正向和反向传递的消息在高斯投影下对应的均值和方差，并进行消息初始化；循环迭代单元303：用于利用消息传递算法对正向和反向传递的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计。在具体实施过程中，首先系统建立单元301建立非线性动态系统并转换为因子图；初始化单元302获取先验消息，将先验消息输入所述非线性动态系统的因子图中，将第一次迭代的正向消息进行初始化；最后循环迭代单元303利用消息传递算法对正向和反向传递过程中产生的消息对应的均值和方差进行循环迭代更新，获取并输出最后一次迭代状态信号对应的均值和方差，完成非线性动态系统的状态估计；本装置由观测信号去估计状态信号，不需要已知转移矩阵，可以应用于更广泛的非线性动态系统状态估计；同时，本装置可以克服现有技术中非线性动态系统可能存在的非高斯测量噪声对系统性能的影响和滤波技术的不足，且有利于提高状态信号重构的精度。相同或相似的标号对应相同或相似的部件；附图中描述位置关系的用语仅用于示例性说明，不能理解为对本申请的限制；显然，本发明的上述实施例仅仅是为清楚地说明本发明所作的举例，而并非是对本发明的实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明权利要求的保护范围之内。
