标题title
基于配置即时触发任务的解耦方法、系统及装置
摘要abst
本发明公开了一种基于配置即时触发任务的解耦方法、系统及装置，包括：添加实体元数据表和字段元数据表，基于DAO，根据实体元数据表和字段元数据表中存储的映射关系对数据库进行增删改操作得到修改数据；DAO发送与修改数据相同格式的消息给消息队列；将不同的业务行为抽象成通用动作，添加动作表；添加任务表，当消息被消费时，在任务表中找到相应的动作表中的多条数据，按照顺序依次执行；添加消息队列消费服务，根据消息的内容去触发任务表，获取任务列表，依次判断当前业务数据是否符合任务上配置的筛选条件，如果符合条件则根据动作类型从动作表中获取对应的实现类来执行动作。本发明可以实现基于配置即时触发任务的解耦。
权利要求书clms
1.一种基于配置即时触发任务的解耦方法，其特征在于，包括：S1、添加实体元数据表和字段元数据表，基于统一的DAO，根据实体元数据表和字段元数据表中存储的映射关系对数据库进行增删改操作得到修改数据；S2、DAO发送与修改数据相同格式的消息给消息队列；S3、将不同的业务行为抽象成通用动作，添加到动作表，所述动作表包括多种动作类型和动作类型对应的实现类；S4、添加任务表，触发任务的数据要符合筛选条件、执行动作、启停用和序号等列，当所述消息被消费时，在任务表中找到相应的动作表中的多条数据，按照顺序依次执行；S5、添加消息队列消费服务，根据消息的内容去触发任务表，获取相应的任务列表，再依次判断当前业务数据是否符合任务上配置的筛选条件，如果符合筛选条件则根据当前业务数据的动作类型从动作表中获取动作类型对应的实现类来执行动作。2.根据权利要求1所述的方法，其特征在于，所述S1具体包括：实体元数据表用来定义不同业务实体与数据库表的映射关系，字段元数据表用来定义字段的类型、字段的基本属性及与数据库列之间的映射关系，添加统一的业务对象类，包含实体名称和字段的键值对集合，基于统一的DAO，通过两张元数据表中存储的映射关系对数据库进行增删改操作。3.根据权利要求2所述的方法，其特征在于，所述S2具体包括：在DAO增删改业务数据后发送相同格式的消息给同一个消息队列，消息内容包括：操作人、操作时间、操作端、操作类型、操作对象、操作数据和其他信息。4.根据权利要求3所述的方法，其特征在于，所述S4具体包括：添加任务表，包括任务名称，执行对象和触发时机，执行数据需要符合的筛选条件、执行动作、启停用和序号等列，当数据操作消息被消费时在任务表中找到相应的动作表中的多条数据，按照顺序依次执行。5.一种基于配置即时触发任务的解耦系统，其特征在于，包括：增删改模块:用于添加实体元数据表和字段元数据表，基于统一的DAO，根据实体元数据表和字段元数据表中存储的映射关系对数据库进行增删改操作得到修改数据；发送模块:用于DAO发送与修改数据相同格式的消息给消息队列；动作表模块：用于将不同的业务行为抽象成通用动作，添加动作表，所述动作表包括多种动作类型和动作类型对应的实现类；任务表模块：用于添加任务表，触发任务的数据要符合筛选条件、执行动作、启停用和序号等列，当所述消息被消费时，在任务表中找到相应的动作表中的多条数据，按照顺序依次执行；消息队列消费服务模块：用于添加消息队列消费服务，根据消息的内容去触发任务表，获取相应的任务列表，再依次判断当前业务数据是否符合任务上配置的筛选条件，如果筛选条件则根据当前业务数据的动作类型从动作表中获取对应的实现类来执行动作。6.根据权利要求5所述的系统，其特征在于，所述增删改模块具体用于：实体元数据表用来定义不同业务实体与数据库表的映射关系，字段元数据表用来定义字段的类型、字段的基本属性及与数据库列之间的映射关系，添加统一的业务对象类，包含实体名称和字段的键值对集合，基于统一的DAO，通过两张元数据表中存储的映射关系对数据库进行增删改操作。7.根据权利要求6所述的系统，其特征在于，所述发送模块具体用于：在DAO增删改业务数据后发送相同格式的消息给同一个消息队列，消息内容包括：操作人、操作时间、操作端、操作类型、操作对象、操作数据和其他信息。8.根据权利要求7所述的系统，其特征在于，所述任务表模块具体用于：添加任务表，包括任务名称、执行对象和触发时机，执行数据需要符合的筛选条件、执行动作、启停用和序号等列，当数据操作消息被消费时在任务表中找到相应的动作表中的多条数据，按照顺序依次执行。9.一种基于配置即时触发任务的解耦装置，其特征在于，包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述计算机程序被所述处理器执行时实现如权利要求1至4中任一项所述的基于配置即时触发任务的解耦方法的步骤。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有信息传递的实现程序，所述程序被处理器执行时实现如权利要求1至4中任一项所述的基于配置即时触发任务的解耦方法的步骤。
说明书desc
技术领域本发明涉及触发任务解耦领域，尤其是涉及一种基于配置即时触发任务的解耦方法、系统及装置。背景技术随着客户业务的不断变化，客户对于相同业务单据的变化也有着不同诉求，例如：产生一条合同数据后，A客户希望合同金额大于10W的可以自动提交审批，而B客户希望合同金额大于10W的自动转交给XX负责。对于此种场景只能通过定制化来完成，从代码主干切两个分支，分别针对两个客户不同的部分写两套不同的代码，只要客户的业务一发生变化就需要修改对应分支代码，增加了研发和维护成本。发明内容本发明的目的在于提供一种基于配置即时触发任务的解耦方法，旨在解决基于配置即时触发任务的解耦方法、系统及装置。本发明实施例提供了一种基于配置即时触发任务的解耦方法，包括：S1、添加实体元数据表和字段元数据表，基于统一的DAO，根据实体元数据表和字段元数据表中存储的映射关系对数据库进行增删改操作得到修改数据；S2、DAO发送与修改数据相同格式的消息给消息队列；S3、将不同的业务行为抽象成通用动作，添加动作表，所述动作表包括多种动作类型和动作类型对应的实现类；S4、添加任务表，触发任务的数据要符合筛选条件、执行动作、启停用和序号等列，当所述消息被消费时，在任务表中找到相应的动作表中的多条数据，按照顺序依次执行；S5、添加消息队列消费服务，根据消息的内容去触发任务表，获取相应的任务列表，再依次判断当前业务数据是否符合任务上配置的筛选条件，如果符合条件则根据动作类型从动作表中获取对应的实现类来执行动作。本发明还提供一种基于配置即时触发任务的解耦系统，包括：增删改模块:用于添加实体元数据表和字段元数据表，基于统一的DAO，根据实体元数据表和字段元数据表中存储的映射关系对数据库进行增删改操作得到修改数据；发送模块:用于DAO发送与修改数据相同格式的消息给消息队列；动作表模块：用于将不同的业务行为抽象成通用动作，添加动作表，所述动作表包括多种动作类型和动作类型对应的实现类；任务表模块：用于添加任务表，触发任务的数据要符合筛选条件、执行动作、启停用和序号等列，当所述消息被消费时，在任务表中找到相应的动作表中的多条数据，按照顺序依次执行；消息队列消费服务模块：用于添加消息队列消费服务，根据消息的内容去触发任务表，获取相应的任务列表，再依次判断当前业务数据是否符合任务上配置的筛选条件，如果符合条件则根据动作类型从动作表中获取对应的实现类来执行动作。本发明实施例还提供一种基于配置即时触发任务的解耦装置，包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述计算机程序被所述处理器执行时实现上述方法的步骤。本发明实施例还提供一种计算机可读存储介质，所述计算机可读存储介质上存储有信息传递的实现程序，所述程序被处理器执行时实现上述方法的步骤。采用本发明实施例，基于配置即时触发任务的解耦。上述说明仅是本发明技术方案的概述，为了能够更清楚了解本发明的技术手段，依照说明书的内容予以实施，并且为了让本发明的上述和其它目的、特征和优点能够更明显易懂，以下特举本发明的具体实施方式。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例的基于配置即时触发任务的解耦方法流程图；图2是本发明实施例的基于配置即时触发任务的解耦方法的具体流程图；图3是本发明实施例的一种基于配置即时触发任务的解耦系统示意图；图4是本发明实施例的基于配置即时触发任务的解耦装置示意图。具体实施方式下面将结合实施例对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。方法实施例根据本发明实施例，提供了一种基于配置即时触发任务的解耦方法，图1是本发明实施例的基于配置即时触发任务的解耦方法流程图，如图1所示，具体包括：S1、添加实体元数据表和字段元数据表，基于统一的DAO，根据实体元数据表和字段元数据表中存储的映射关系对数据库进行增删改操作得到修改数据；S1具体包括：实体元数据表用来定义不同业务实体与数据库表的映射关系，字段元数据表用来定义字段的类型、字段的基本属性及与数据库列之间的映射关系，添加统一的业务对象类，包含实体名称和字段的键值对集合，基于统一的DAO，通过两张元数据表中存储的映射关系对数据库进行增删改操作。S2、DAO发送与修改数据相同格式的消息给消息队列；S2具体包括：在DAO增删改业务数据后发送相同格式的消息给同一个消息队列，消息内容包括：操作人、操作时间、操作端、操作类型、操作对象、操作数据和其他信息。S3、将不同的业务行为抽象成通用动作，添加动作表，所述动作表包括多种动作类型和动作类型对应的实现类；S4、添加任务表，触发任务的数据要符合筛选条件、执行动作、启停用和序号等列，当所述消息被消费时，在任务表中找到相应的动作表中的多条数据，按照顺序依次执行；S4具体包括：添加任务表，包括任务名称，执行对象和触发时机，执行数据需要符合的筛选条件，执行动作，启停用，序号等列，当数据操作消息被消费时在任务表中找到相应的动作表中的多条数据，按照顺序依次执行。S5、添加消息队列消费服务，根据消息的内容去触发任务表，获取相应的任务列表，再依次判断当前业务数据是否符合任务上配置的筛选条件，如果符合条件则根据动作类型从动作表中获取对应的实现类来执行动作。具体实施方法如下：图2是本发明实施例的基于配置即时触发任务的解耦方法的具体流程图；1.添加两张元数据定义表：实体元数据表用来定义不同业务实体与数据库表的映射关系，字段元数据表用来定义字段的类型、字段的基本属性及与数据库列之间的映射关系。添加统一的BO，包含实体名称、字段的键值对集合，使用统一的DAO通过两张元数据表中存储的映射关系对数据库进行增删改操作。2.在DAO增删改业务数据后发送相同格式的消息给同一个消息队列，消息内容包括：操作人，操作时间，操作端，操作类型，操作对象，操作数据，其他信息。3.添加动作表，将不同的业务行为抽象成动作，例如：将发送通知，字段变更，数据锁定，提交审批等业务行为抽象成通用动作，将客户的特殊业务逻辑抽象成特殊动作。所有类型的动作都实现统一的接口，在队列消费服务启动时注册所有类型的动作以备调用。4.添加即时触发任务表，包括任务名称，执行对象，触发时机，执行数据需要符合的筛选条件，执行动作，启停用，序号等列。当数据操作消息被消费时可以在该表中找到相应的动作列表，按照顺序依次执行。5.添加消息队列消费服务，根据解析消息内容获取的操作类型和操作对象去即时触发任务表中获取相应的任务列表，再依次判断当前业务数据是否符合任务上配置的筛选条件，如果符合条件则根据动作类型从动作执行池中获取对应的动作执行者来执行动作。有益效果：本发明不用定制化软件，不需要客户的业务发生变化就修改对应的分支代码，减少了研发和维护成本。系统实施例根据本发明实施例，提供了一种基于配置即时触发任务的解耦系统，图3是本发明实施例的一种基于配置即时触发任务的解耦系统示意图，如图3所示，具体包括：增删改模块:用于添加实体元数据表和字段元数据表，基于统一的DAO，根据实体元数据表和字段元数据表中存储的映射关系对数据库进行增删改操作得到修改数据；增删改模块具体用于：实体元数据表用来定义不同业务实体与数据库表的映射关系，字段元数据表用来定义字段的类型、字段的基本属性及与数据库列之间的映射关系，添加统一的业务对象类，包含实体名称和字段的键值对集合，基于统一的DAO，通过两张元数据表中存储的映射关系对数据库进行增删改操作。发送模块:用于DAO发送与修改数据相同格式的消息给消息队列；发送模块具体用于：在DAO增删改业务数据后发送相同格式的消息给同一个消息队列，消息内容包括：操作人、操作时间、操作端、操作类型、操作对象、操作数据和其他信息。动作表模块：用于将不同的业务行为抽象成通用动作，添加动作表，所述动作表包括多种动作类型和动作类型对应的实现类；任务表模块：用于添加任务表，触发任务的数据要符合筛选条件、执行动作、启停用和序号等列，当所述消息被消费时，在任务表中找到相应的动作表中的多条数据，按照顺序依次执行；任务表模块具体用于：添加任务表，包括任务名称，执行对象和触发时机，执行数据需要符合的筛选条件，执行动作，启停用，序号等列，当数据操作消息被消费时在任务表中找到相应的动作表中的多条数据，按照顺序依次执行。消息队列消费服务模块：用于添加消息队列消费服务，根据消息的内容去触发任务表，获取相应的任务列表，再依次判断当前业务数据是否符合任务上配置的筛选条件，如果符合条件则根据动作类型从动作表中获取对应的实现类来执行动作。本发明实施例是与上述方法实施例对应的系统实施例，各个模块的具体操作可以参照方法实施例的描述进行理解，在此不再赘述。装置实施例一本发明实施例提供一种基于配置即时触发任务的解耦装置，如图4所示，包括：存储器40、处理器42及存储在存储器40上并可在处理器42上运行的计算机程序，计算机程序被处理器执行时实现上述方法实施例中的步骤。装置实施例二本发明实施例提供一种计算机可读存储介质，计算机可读存储介质上存储有信息传输的实现程序，程序被处理器42执行时实现上述方法实施例中的步骤。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换本发明各实施例技术方案，并不使相应技术方案的本质脱离本方案的范围。
