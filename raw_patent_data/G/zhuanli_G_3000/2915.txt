标题title
一种虚拟电厂出力控制方法
摘要abst
本发明公开了一种虚拟电厂出力控制方法，具体包括：获取历史运行信息；获取虚拟电厂日前光伏发电功率、日内光伏发电功率、基础负荷用能需求、储能系统的最大充电能力；建立日前运行优化模型，采用粒子群算法，获取日前供能总输出计划及日前用能总需求计划，生成初步日前优化运行计划；设计供能影响因子、供能影响因子权重、用能影响因子以及用能影响因子权重，生成日前优化运行计划；对日内系统元素进行突变性判别；纠偏日前优化运行计划，实现日内各时间片内的最优调度；将历史数据上传反馈至数据分析平台；该控制方法能实现虚拟电厂清洁能源最大化消纳，提升制氢环节能效，平抑虚拟电厂与电网间的联络线功率波动。
权利要求书clms
1.一种虚拟电厂出力控制方法，其特征在于，所述出力控制方法包括以下几个步骤：S1：观测若干个日期的虚拟电厂运行信息，获取历史运行信息；S2：构建光伏预测模型，获取虚拟电厂日前光伏预测发电功率以及日内光伏预测发电功率；构建负荷预测模型，获取虚拟电厂基础负荷用能需求；根据电厂排班计划、单位设备能耗获取可调负荷用能需求，根据储能单体电压、储能SOC等约束条件得到储能系统的最大充放电能力；S3：建立日前运行优化模型，分析虚拟电厂自身运行优化目标，以虚拟电厂供能设备供能以及虚拟电厂负荷用能动态平衡以及经济性需求为约束，采用粒子群算法，获取日前供能总输出计划及日前用能总需求计划，生成初步日前优化运行计划；S4：根据实时运行反馈数据，结合历史运行数据，设计供能影响因子、供能影响因子权重、用能影响因子以及用能影响因子权重，得到日前新供能总输出计划及日前新用能总需求计划，生成日前优化运行计划；S5：在线获取日内光伏发电功率、日内负荷功率、日内负荷需求、系统故障状态、储能单体电压以及储能SOC，实时监测虚拟电厂日内系统元素，对所述日内系统元素进行突变性判别；S6：根据突变性判别结果以及日内电网调度需求，考虑日前负荷需求与临时性制氢生产要求的偏差，通过动态调整虚拟电厂供用能需求，纠偏日前优化运行计划，实现日内各时间片内的最优调度；S7：将虚拟电厂日前数据与日内运行数据作为历史数据上传反馈至数据分析平台，返回S1。2.根据权利要求1所述虚拟电厂出力控制方法，其特征在于，所述历史运行信息包括日前数据与日内实时存储数据，所述日前数据包括日前最优运行计划；所述日内实时存储数据包括当日实际调度运行曲线、当日光伏实时运行发电功率、当日电网调度指令、当日运行负荷、当日系统运行故障状态、当日储能运行SOC以及各元素在日内变化时对调度产生的权重值；所述虚拟电厂供能设备包括光伏发电设备、储能充电及放电设备；所述虚拟电厂负荷包括运行基础负荷、制氢负荷、可调负荷以及储能充电需求；所述虚拟电厂自身运行优化目标包括日前网侧调度、清洁能源最大化消纳、制氢环节能效提升以及联络线功率平滑。3.根据权利要求2所述虚拟电厂出力控制方法，其特征在于，所述清洁能源至少包括光伏，所述清洁能源最大化消纳的约束条件如式：式中，表示d日t时间片的光伏出力目标，/＞表示d日t时间片的系统负荷总需求，/＞表示d日t时间片的储能系统最大充电能力；当日前光伏预测功率完全满足系统总负荷与储能系统充电需求时，计算如式：/＞当日前光伏预测功率完全满足系统总负荷需求，光伏余电为储能系统充电时，计算如式：式中，表示d日t时间片储能系统实际充电下发目标，/＞表示d日t时间片光伏实际发电功率；当日前光伏预测功率无法满足系统总负荷需求时，储能系统优先进行弥补负荷缺额，计算如式：式中，表示d日t时间片储能系统实际放电下发目标；所述制氢环节能效提升的约束条件如式：式中，表示d日t时间片的制氢需求，/＞表示d日t时间片的电网供能目标；当制氢环节中新能源用能占比时，按正常生产需求进行制氢；当制氢环节中新能源用能占比时，优先降低系统内可调负荷；当制氢环节中新能源用能占比且系统内无可调负荷可降低时，根据制氢生产时的电价、单位能耗及单位效益进行合理化的调整排班，错峰生产；所述联络线功率平滑的约束条件如式：式中，表示时间片t与其上一时间片t-1的变化斜率， /＞分别表示上一时间片t-1的联络线功率以及时间片t的联络线功率，/＞表示联络线功率波动设定阈值；比较的大小，采用联络线功率平滑策略进行联络线功率平滑，具体步骤包括：S31：当时，根据储能系统充电能力选择平抑联络线功率波动的方式；S32：当时，根据光伏发电功率选择平抑联络线功率波动的方式；若无法通过调节光伏系统和储能系统平抑联络线功率波动时，优先选择对虚拟电厂冗余负荷进行降需控制或者合理化错峰制氢负荷。4.根据权利要求3所述虚拟电厂出力控制方法，其特征在于，所述光伏预测模型如式：式中，表示d日t时间片的光伏预测输出功率，/＞表示d日t时间片的光伏额定输出功率，/＞表示d日t时间片的天气影响因子，天气影响根据晴天、阴天、雨天分别取不同值，/＞表示d日t时间片的实际光照强度，/＞表示d日t时间片的额定光照强度。5.根据权利要求4所述虚拟电厂出力控制方法，其特征在于，采用粒子群算法，获取初步日前优化运行计划的具体步骤包括：S51：将供能输出目标及用能需求目标定义为粒子群算法中的两个粒子，均以二维属性进行标定，所述二维属性包括功率阶跃步长及功率阶跃方向；S52：设置包括日前网侧调度、清洁能源最大化消纳、制氢环节能效提升以及联络线功率平滑的多目标优化任务，采用粒子群算法，获取日前供能总输出计划及日前用能总需求计划，构成初步日前优化运行计划。6.根据权利要求5所述虚拟电厂出力控制方法，其特征在于，生成日前优化运行计划的具体步骤包括：S61：根据运行反馈数据、历史备份数据，设计供能影响因子以及用能影响因子；S62：对所述供能影响因子和用能影响因子分别设置供能影响因子权重以及用能影响因子权重；S63：根据所述供能影响因子以及供能影响因子权重，获取供能影响值，根据所述用能影响因子以及用能影响因子权重，获取用能影响值；S64：根据所述日前供能总输出计划以及供能影响值，得到日前新供能总输出计划，根据所述日前用能总需求计划以及用能影响值，得到日前新用能总需求计划；S65：根据日前新供能总输出计划以及日前新用能总需求计划，生成日前优化运行计划。7.根据权利要求6所述虚拟电厂出力控制方法，其特征在于，对所述日内系统元素进行突变性判别的具体步骤包括：S71：将一天24小时设定若干个时间片；S72：实时监测每一个时间片内变化元素，包括源、荷、设备工况以及调度计划，计算每一个时间片内各变化元素的实时监测值与日前预设值的绝对差值；S73：若绝对差差值超过设定阈值，则启动纠偏机制，否则按日前优化运行计划运行。8.根据权利要求7所述虚拟电厂出力控制方法，其特征在于，根据日内电网调度需求，纠偏日前优化运行计划的具体步骤包括：S81：当日内电网调度需求为填谷型需求响应时，优先考虑错峰生产计划，包括加大制氢功率、扩大制氢产能以及提升用能负荷；若无法提升用能负荷，则根据储能系统充电空间情况，进一步选择对储能系统或光伏系统进行功率优化分配；S82：当日内电网调度需求为削峰型需求响应时，根据光伏系统预测功率以及储能系统放电能力，选择对光伏系统和储能系统进行优化调度；若光伏系统和储能系统联合调度也无法满足电网需求响应时，对虚拟电厂用能负荷按需进行优化分配，优先选择对系统冗余负荷降负荷或切除冗余负荷；S83：日内调度需求响应结束后，恢复日前优化运行计划；根据突变性判别结果，纠偏日前优化运行计划的具体包括：根据光伏日前计划调度指令与光伏实际输出功率偏差，建立光伏调度纠偏机制以及光伏调度纠偏策略；以及根据日前储能调度需求与实时储能充放电能力的偏差，建立储能充放电出力纠偏机制以及储能充放电出力纠偏策略。9.根据权利要求8所述虚拟电厂出力控制方法，其特征在于，所述光伏调度纠偏机制包括根据光伏日前计划调度指令与光伏实际输出功率偏差设定光伏优化调度权重；所述光伏调度纠偏策略具体步骤包括：S91：获取光伏初次调度指令、储能初次调度指令、制氢需求以及可调负荷需求；S92：根据峰谷电价、储能系统SOC荷电状态、储能系统放电能力、冗余负荷调节空间进行综合调配，具体包括：S921：当处于谷时电价时间片，光伏调度偏差由电网承担；S922：当处于峰时电价时间片，考虑储能系统SOC荷电状态、储能系统放电能力弥补光伏调度偏差；若储能系统具备弥补光伏调度偏差的能力，优先由储能系统响应，此时储能系统的迭代更新指令如式：式中，表示d日t时间片更新后的储能调度指令，/＞表示d日t时间片储能初次调度指令，/＞表示由储能系统响应时， d日t时间片光伏日前调度指令与光伏实际输出功率偏差，计算方法如式：若储能系统不具备弥补光伏调度偏差的能力，则选择由储能系统和可调负荷联合调配满足运行需求，储能修正指令与可调负荷需求分别计算如式：式中，表示由储能系统和可调负荷联合响应时， d日t时间片光伏日前调度指令与光伏实际输出功率偏差，/＞表示d日t时间片储能系统弥补光伏调度的部分偏差，/＞表示d日t时间片可调负荷弥补光伏调度的部分偏差，/＞表示d日t时间片储能系统实时修正指令，/＞表示d日t时间片可调负荷日内修正值，/＞表示d日t时间片可调负荷需求。10.根据权利要求9所述虚拟电厂出力控制方法，其特征在于，所述储能充放电出力纠偏机制包括：统筹储能SOC与充放电能力，通过储能SOC变化实时修正储能充放电能力；统筹储能单体电压与储能充放电能力，通过储能单体电压变化实时修正储能充放电能力；所述储能充放电出力纠偏策略包括：S101：计算储能系统能力值与日前生产的调度计划的偏差，如式：式中，表示d日t时间片储能系统能力值；S102：根据峰谷电价、储能系统SOC荷电状态、储能系统放电能力、冗余负荷容量进行综合调配，具体包括：S1021：当储能初次调度指令为充电指令时，判断储能充电调度需求与实际充电能力的偏差以及设定阈值的大小，若偏差＜=设定阈值，优先通过调j节光伏功率满足目标要求；储能修正指令如式：当时，更新后的d日t时间片制氢需求/＞计算如式：式中，表示d日t时间片制氢需求；当时，光伏修正指令如式：S1022：当储能初次调度指令为放电指令时，判断储能放电调度需求与实际充电能力的偏差以及设定阈值的大小，若偏差＞设定阈值，优先通过提升光伏发电功率满足目标要求，若偏差＜=设定阈值，优先通过调节光伏功率满足目标要求；/＞储能修正指令如式；当时，更新后的d日t时间片光伏修正指令计算如式；当时，更新后的d日t时间片可调负荷需求如式：。/＞
说明书desc
技术领域本发明涉及虚拟电厂控制技术领域，具体涉及一种虚拟电厂出力控制方法。背景技术为了解决分布式新能源发电因间歇性、波动性和地域性造成的诸如电网电力波动，弃风弃电等问题， 虚拟电厂的概念应运而生。区别于传统的实体电厂， 虚拟电厂通过分布式能源管理系统和先进的通信手段将配电网中分散安装的新能源、可控负荷和储能系统等合并管理，以实现电力系统内部各种分布式能源设备的协调调度和优化运行，同时，作为一个特殊的电源、负荷综合协调管理单元参与电网的运行和电力市场的交易。虚拟电厂高精度的出力控制是平抑虚拟电厂与大电网间联络线功率波动的重要方式，也是衡量虚拟电厂经济价值的重要指标。典型的虚拟电厂一般是各类分布式新能源发电系统、各类储能系统以及各类可调、可控负荷的聚合。以光-储-氢-荷系统为例，新能源光伏发电存在间歇性发电的问题，制氢能耗大；另外，发电指标、峰谷电价、排班计划等诸多因素都对虚拟电厂的精准性出力产生了较大影响；此外，目前虚拟电厂的日前调度计划是基于历史运行数据、气象预测数据以及负荷预测数据等数据资料的，因此，研究如何对日内运行计划进行修正，以匹配日内实际的运行情况，从而应对运行过程中的实际出力变化与计划出力偏差带来的冲击是非常有必要的。发明内容为克服现有技术的不足，本发明提出一种虚拟电厂出力控制方法，该方法首先根据虚拟电厂自身运行目标以及日前调度计划，结合历史运行数据，考虑用能动态平衡，得到日前运行计划曲线；其次，依据日前运行计划，接收日内变化元素，通过动态调整虚拟电厂供能用能需求，纠偏日前运行计划曲线，来达到日内各时间片内的最优调度。本发明的目的可以通过以下技术方案来实现：一种虚拟电厂出力控制方法，该出力控制方法包括以下几个步骤：S1：观测若干个日期的虚拟电厂运行信息，获取历史运行信息；S2：构建光伏预测模型，获取虚拟电厂日前光伏预测发电功率以及日内光伏预测发电功率；构建负荷预测模型，获取虚拟电厂基础负荷用能需求；根据电厂排班计划、单位设备能耗获取可调负荷用能需求，根据储能单体电压、储能SOC等约束条件得到储能系统的最大充放电能力；S3：建立日前运行优化模型，分析虚拟电厂自身运行优化目标，以虚拟电厂供能设备供能以及虚拟电厂负荷用能动态平衡以及经济性需求为约束，采用粒子群算法，获取日前供能总输出计划及日前用能总需求计划，生成初步日前优化运行计划；S4：根据实时运行反馈数据，结合历史运行数据，设计供能影响因子、供能影响因子权重、用能影响因子以及用能影响因子权重，得到日前新供能总输出计划及日前新用能总需求计划，生成日前优化运行计划；S5：在线获取日内光伏发电功率、日内负荷功率、日内负荷需求、系统故障状态、储能单体电压以及储能SOC，实时监测虚拟电厂日内系统元素，对所述日内系统元素进行突变性判别；S6：根据突变性判别结果以及日内电网调度需求，考虑日前负荷需求与临时性制氢生产要求的偏差，通过动态调整虚拟电厂供用能需求，纠偏日前优化运行计划，实现日内各时间片内的最优调度；S7：将虚拟电厂日前数据与日内运行数据作为历史数据上传反馈至数据分析平台，返回S1，用于提升后续对日前运行计划进行优化的精准度以及排班计划的精确度。进一步的，所述历史运行信息包括日前数据与日内实时存储数据，所述日前数据包括日前最优运行计划；所述日内实时存储数据包括当日实际调度运行曲线、当日光伏实时运行发电功率、当日电网调度指令、当日运行负荷、当日系统运行故障状态、当日储能运行SOC以及各元素在日内变化时对调度产生的权重值。进一步的，所述虚拟电厂供能设备包括光伏发电设备、储能充电及放电设备；所述虚拟电厂负荷包括运行基础负荷、制氢负荷、可调负荷以及储能充电需求。进一步的，所述虚拟电厂自身运行优化目标包括日前网侧调度、清洁能源最大化消纳、制氢环节能效提升以及联络线功率平滑；所述清洁能源最大化消纳的原则包括虚拟电厂负荷总需求应尽可能由系统内供能设施承担，所述虚拟电厂负荷总需求是虚拟电厂基础负荷用能需求以及可调负荷用能需求之和；所述制氢环节能效提升的原则包括统筹制氢过程中单位能耗与效益以及优先从虚拟电厂供能设备获取电能；所述制氢环节能效提升的方式包括优先在电价谷时段、光伏发电量充足、以及储能SOC充足的时间段合理安排生产计划；在清洁能源无法有效满足制氢需求时，依据峰谷电价结合制氢成本与效益优先考虑对系统内其他可调负荷进行精准性降需或切除，以满足制氢用能需求；所述联络线功率平滑的原则包括根据联络线功率在相邻时间片的变化率，与设定波动斜率阈值进行比较，通过动态调整虚拟电厂的供能用能需求来达到设定目标；所述联络线功率平滑的方式包括：当联络线功率波动超限后，通过优化分配光伏出力、储能充电放电功率来平抑因虚拟电厂负荷或光伏间歇性导致的联络线功率波动。进一步的，所述清洁能源至少包括光伏，所述清洁能源最大化消纳的约束条件如式：式中，表示d日t时间片的光伏出力目标，/＞表示d日t时间片的系统负荷总需求，/＞表示d日t时间片的储能系统最大充电能力；当日前光伏预测功率完全满足系统总负荷与储能系统充电需求时，计算如式：/＞当日前光伏预测功率完全满足系统总负荷需求，光伏余电为储能系统充电时，计算如式：式中，表示d日t时间片储能系统实际充电下发目标，/＞表示d日t时间片光伏实际发电功率；当日前光伏预测功率无法满足系统总负荷需求时，储能系统优先进行弥补负荷缺额，计算如式：式中，表示d日t时间片储能系统实际放电下发目标；进一步的，所述制氢环节能效提升的约束条件如式：式中，表示d日t时间片的制氢需求，/＞表示d日t时间片的电网供能目标；当制氢环节中新能源用能占比时，按正常生产需求进行制氢；当制氢环节中新能源用能占比时，优先降低系统内可调负荷；当制氢环节中新能源用能占比且系统内无可调负荷可降低时，根据制氢生产时的电价、单位能耗及单位效益进行合理化的调整排班，错峰生产。进一步的，所述联络线功率平滑的约束条件如式：(6）式中，表示时间片t与其上一时间片t-1的变化斜率， /＞分别表示上一时间片t-1的联络线功率以及时间片t的联络线功率，/＞表示联络线功率波动设定阈值；比较与/＞的大小，采用联络线功率平滑策略进行联络线功率平滑，具体步骤包括：S31：当时，根据储能系统充电能力选择平抑联络线功率波动的方式：若储能系统具备足够的充电能力平抑联络线功率波动时，优先选择对储能系统进行充电控制的方式；若储能系统不具备足够的充电能力平抑联络线功率波动时，优先选择限定光伏发电功率的方式；若无法通过调节储能系统平抑联络线功率波动时，优先选择合理化提升虚拟电厂内生产用能需求；S32：当时，根据光伏发电功率选择平抑联络线功率波动的方式：若通过提升光伏发电功率能够平抑联络线功率波动时，优先选择调节光伏功率；若通过提升光伏发电功率不能够平抑联络线功率波动时，优先选择结合储能放电能力对储能系统进行放电控制消弭系统波动；若无法通过调节储能系统平抑联络线功率波动时，优先选择对虚拟电厂冗余负荷进行降需控制或者合理化错峰制氢负荷。进一步的，所述光伏预测模型如式：式中，表示d日t时间片的光伏预测输出功率，/＞表示d日t时间片的光伏额定输出功率，/＞表示d日t时间片的天气影响因子，天气影响根据晴天、阴天、雨天分别取不同值，/＞表示d日t时间片的实际光照强度，/＞表示d日t时间片的额定光照强度；所述负荷预测模型中基础负荷是虚拟电厂系统中固定能耗，通过历史运行数据进行预测；可调负荷包括生产负荷、制氢能耗、照明负荷，通过历史负荷数据、前一天的排班计划、工作时间、单位设备能耗进行预测。进一步的，采用粒子群算法，获取初步日前优化运行计划的具体步骤包括：S51：将供能输出目标及用能需求目标定义为粒子群算法中的两个粒子，均以二维属性进行标定，所述二维属性包括功率阶跃步长及功率阶跃方向；S52：设置包括日前网侧调度、清洁能源最大化消纳、制氢环节能效提升以及联络线功率平滑的多目标优化任务，采用粒子群算法，获取日前供能总输出计划及日前用能总需求计划，构成初步日前优化运行计划。进一步的，生成日前优化运行计划的具体步骤包括：S61：根据运行反馈数据、历史备份数据，设计供能影响因子以及用能影响因子，所述供能影响因子包括设备故障因子、天气突变因子以及调度变化因子，所述用能影响因子包括生产排班因子以及季节因子；S62：对所述供能影响因子和用能影响因子分别设置供能影响因子权重以及用能影响因子权重；S63：根据所述供能影响因子以及供能影响因子权重，获取供能影响值，根据所述用能影响因子以及用能影响因子权重，获取用能影响值；S64：根据所述日前供能总输出计划以及供能影响值，得到日前新供能总输出计划，根据所述日前用能总需求计划以及用能影响值，得到日前新用能总需求计划；S65：根据日前新供能总输出计划以及日前新用能总需求计划，生成日前优化运行计划。进一步的，对所述日内系统元素进行突变性判别的具体步骤包括：S71：将一天24小时设定若干个时间片；S72：实时监测每一个时间片内变化元素，包括源、荷、设备工况以及调度计划，计算每一个时间片内各变化元素的实时监测值与日前预设值的绝对差值；S73：若绝对差差值超过设定阈值，则启动纠偏机制，否则按日前优化运行计划运行。进一步的，根据日内电网调度需求，纠偏日前优化运行计划的具体步骤包括：S81：当日内电网调度需求为填谷型需求响应时，优先考虑错峰生产计划，包括加大制氢功率、扩大制氢产能以及提升用能负荷；若无法提升用能负荷，则根据储能系统充电空间情况，进一步选择对储能系统或光伏系统进行功率优化分配；S82：当日内电网调度需求为削峰型需求响应时，根据光伏系统预测功率以及储能系统放电能力，选择对光伏系统和储能系统进行优化调度；若光伏系统和储能系统联合调度也无法满足电网需求响应时，对虚拟电厂用能负荷按需进行优化分配，优先选择对系统冗余负荷降负荷或切除冗余负荷；S83：日内调度需求响应结束后，恢复日前优化运行计划。进一步的，根据突变性判别结果，纠偏日前优化运行计划的具体包括：根据光伏日前计划调度指令与光伏实际输出功率偏差，建立光伏调度纠偏机制以及光伏调度纠偏策略；以及根据日前储能调度需求与实时储能充放电能力的偏差，建立储能充放电出力纠偏机制以及储能充放电出力纠偏策略。进一步的，所述光伏调度纠偏机制包括根据光伏日前计划调度指令与光伏实际输出功率偏差设定光伏优化调度权重；所述光伏调度纠偏策略具体步骤包括：S91：获取光伏初次调度指令、储能初次调度指令、制氢需求以及可调负荷需求；S92：根据峰谷电价、储能系统SOC荷电状态、储能系统放电能力、冗余负荷调节空间进行综合调配，具体包括：S921：当处于谷时电价时间片，光伏调度偏差由电网承担；S922：当处于峰时电价时间片，考虑储能系统SOC荷电状态、储能系统放电能力弥补光伏调度偏差；若储能系统具备弥补光伏调度偏差的能力，优先由储能系统响应，此时储能系统的迭代更新指令如式：式中，表示d日t时间片更新后的储能调度指令，/＞表示d日t时间片储能初次调度指令，/＞表示由储能系统响应时，d日t时间片光伏日前调度指令与光伏实际输出功率偏差，计算方法如式：若储能系统不具备弥补光伏调度偏差的能力，则选择由储能系统和可调负荷联合调配满足运行需求，储能修正指令与可调负荷需求分别计算如式：式中，表示由储能系统和可调负荷联合响应时，d日t时间片光伏日前调度指令与光伏实际输出功率偏差，/＞表示d日t时间片储能系统弥补光伏调度的部分偏差，/＞表示d日t时间片可调负荷弥补光伏调度的部分偏差，/＞表示d日t时间片储能系统实时修正指令，/＞表示d日t时间片可调负荷日内修正值，/＞表示d日t时间片可调负荷需求。进一步的，所述储能充放电出力纠偏机制包括：统筹储能SOC与充放电能力，通过储能SOC变化实时修正储能充放电能力；以及统筹储能单体电压与储能充放电能力，通过储能单体电压变化实时修正储能充放电能力；所述储能充放电出力纠偏策略包括：S101：计算储能系统能力值与日前生产的调度计划的偏差，如式：式中，表示d日t时间片储能系统能力值；S102：根据峰谷电价、储能系统SOC荷电状态、储能系统放电能力、冗余负荷容量进行综合调配，具体包括：S1021：当储能初次调度指令为充电指令时，判断储能充电调度需求与实际充电能力的偏差以及设定阈值的大小，若偏差＜=设定阈值，优先通过调节光伏功率满足目标要求；储能修正指令如式：当时，更新后的d日t时间片制氢需求/＞计算如式：式中，表示d日t时间片制氢需求；/＞当时，光伏修正指令如式：S1022：当储能初次调度指令为放电指令时，判断储能放电调度需求与实际充电能力的偏差以及设定阈值的大小，若偏差＞设定阈值，优先通过提升光伏发电功率满足目标要求，若偏差＜=设定阈值，优先通过调节光伏功率满足目标要求；储能修正指令如式；当时，更新后的d日t时间片光伏修正指令计算如式；当时，更新后的d日t时间片可调负荷需求如式：。进一步的，还包括考虑日前负荷需求与临时性制氢生产要求的偏差，建立负荷需求纠偏机制以及负荷需求纠偏策略，纠偏日前优化运行计划；当日前负荷需求与临时性制氢生产要求的偏差处于设定阈值区间内，即，保持日前最优曲线运行；当日前负荷需求与临时性制氢生产要求的偏差大于设定阈值区间，即，启动光储联动调节机制满足目标需求，具体包括：优先提升光伏发电功率；当光伏发电功率无法满足需求时，再根据峰谷电价、储能充放电能力进行综合调节储能系统；当光伏发电功率以及光储系统均无法满足需求时，通过优化系统内的冗余负荷进行响应，缺额部分由电网承担；根据日内供能设备突发性故障的偏差，调度系统进行闭锁保护，优先通过调节光伏系统，消弭因储能故障带来的系统不稳定，纠偏日前优化运行计划；当光伏系统出现故障时，优先结合当前储能充放电能力调节储能调度指令，消弭因光伏系统故障带来的系统不稳定，若储能无法弥补，缺额由电网承担；当储能系统出现故障时，优先通过调节光伏系统，消弭因储能系统故障带来的系统不稳定。与现有技术相比，本发明具有以下技术效果：采用本发明所提出的出力控制方法，能实现虚拟电厂清洁能源最大化消纳，提升制氢环节能效，平抑虚拟电厂与电网间的联络线功率波动。附图说明图1为本发明总体流程图；具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本发明一部分实施例，而不是全部的实施例。基于发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。如图1所示，一种虚拟电厂出力控制方法，该出力控制方法包括以下几个步骤：S1：观测若干个日期的虚拟电厂运行信息，获取历史运行信息，所述历史运行信息包括日前数据与日内实时存储数据，所述日前数据包括日前最优运行计划；所述日内实时存储数据包括当日实际调度运行曲线、当日光伏实时运行发电功率、当日电网调度指令、当日运行负荷、当日系统运行故障状态、当日储能运行SOC以及各元素在日内变化时对调度产生的权重值；S2：构建光伏预测模型，获取虚拟电厂日前光伏预测发电功率以及日内光伏预测发电功率；构建负荷预测模型，获取虚拟电厂基础负荷用能需求；根据电厂排班计划、单位设备能耗获取可调负荷用能需求，根据储能单体电压、储能SOC等约束条件得到储能系统的最大充电能力；S3：建立日前运行优化模型，分析虚拟电厂自身运行优化目标，包括日前网侧调度、清洁能源最大化消纳、制氢环节能效提升以及联络线功率平滑，以虚拟电厂供能设备以及虚拟电厂负荷用能动态平衡以及经济性需求为约束，采用粒子群算法，获取日前供能总输出计划及日前用能总需求计划，生成初步日前优化运行计划；S4：根据实时运行反馈数据，结合历史运行数据，设计供能影响因子、供能影响因子权重、用能影响因子以及用能影响因子权重，得到日前新供能总输出计划及日前新用能总需求计划，生成日前优化运行计划；S5：在线获取日内光伏发电功率、日内负荷功率、日内负荷需求、系统故障状态、储能单体电压以及储能SOC，实时监测虚拟电厂日内系统元素，对所述日内系统元素进行突变性判别；S6：根据突变性判别结果以及日内电网调度需求，考虑日前负荷需求与临时性制氢生产要求的偏差，通过动态调整虚拟电厂供用能需求，纠偏日前优化运行计划，实现日内各时间片内的最优调度；S7：将虚拟电厂日前数据与日内运行数据作为历史数据上传反馈至数据分析平台，返回S1，用于提升后续对日前运行计划进行优化的精准度以及排班计划的精确度；采用监视网与控制网分离的方式，监视网采用MMS，控制网采用GOOSE，用于提升响应速度、增强控制精度。虚拟电厂供能设备包括光伏发电设备、储能充电及放电设备；虚拟电厂负荷包括运行基础负荷、制氢负荷、可调负荷以及储能充电需求。本发明清洁能源至少包括光伏，光伏最大化消纳的约束条件如式：式中，表示d日t时间片的光伏出力目标，/＞表示d日t时间片的系统负荷总需求，/＞表示d日t时间片的储能系统最大充电能力；当日前光伏预测功率完全满足系统总负荷与储能系统充电需求时，计算如式：/＞当日前光伏预测功率完全满足系统总负荷需求，光伏余电为储能系统充电时，计算如式：式中，表示d日t时间片储能系统实际充电下发目标，/＞表示d日t时间片光伏实际发电功率；当日前光伏预测功率无法满足系统总负荷需求时，储能系统优先进行弥补负荷缺额，计算如式：式中，表示d日t时间片储能系统实际放电下发目标。所述制氢环节能效提升的约束条件如式：式中，表示d日t时间片的制氢需求，/＞表示d日t时间片的电网供能目标；当制氢环节中新能源用能占比时，按正常生产需求进行制氢；当制氢环节中新能源用能占比时，优先降低系统内可调负荷；当制氢环节中新能源用能占比且系统内无可调负荷可降低时，根据制氢生产时的电价、单位能耗及单位效益进行合理化的调整排班，错峰生产。所述联络线功率平滑的约束条件如式：式中，表示时间片t与其上一时间片t-1的变化斜率， /＞分别表示上一时间片t-1的联络线功率以及时间片t的联络线功率，/＞表示联络线功率波动设定阈值；比较的大小，采用联络线功率平滑策略进行联络线功率平滑，具体步骤包括：/＞S31：当时，根据储能系统充电能力选择平抑联络线功率波动的方式：若储能系统具备足够的充电能力平抑联络线功率波动时，优先选择对储能系统进行充电控制的方式；若储能系统不具备足够的充电能力平抑联络线功率波动时，优先选择限定光伏发电功率的方式；若无法通过调节光伏系统和储能系统平抑联络线功率波动时，优先选择合理化提升虚拟电厂内生产用能需求；S32：当时，根据光伏发电功率选择平抑联络线功率波动的方式：若通过提升光伏发电功率能够平抑联络线功率波动时，优先选择调节光伏功率；若通过提升光伏发电功率不能够平抑联络线功率波动时，优先选择结合储能放电能力对储能系统进行放电控制消弭系统波动；若无法通过调节光伏系统和储能系统平抑联络线功率波动时，优先选择对虚拟电厂冗余负荷进行降需控制或者合理化错峰制氢负荷。所述光伏预测模型如式：式中，表示d日t时间片的光伏预测输出功率，/＞表示d日t时间片的光伏额定输出功率，/＞表示d日t时间片的天气影响因子，天气影响根据晴天、阴天、雨天分别取不同值，/＞表示d日t时间片的实际光照强度，/＞表示d日t时间片的额定光照强度；所述负荷预测模型中基础负荷是虚拟电厂系统中固定能耗，通过历史运行数据进行预测；可调负荷包括生产负荷、制氢能耗、照明负荷，通过历史负荷数据、前一天的排班计划、工作时间、单位设备能耗进行预测。采用粒子群算法，获取初步日前优化运行计划的具体步骤包括：S51：将供能输出目标及用能需求目标定义为粒子群算法中的两个粒子，均以二维属性进行标定，所述二维属性包括功率阶跃步长及功率阶跃方向；S52：设置包括日前网侧调度、清洁能源最大化消纳、制氢环节能效提升以及联络线功率平滑的多目标优化任务，采用粒子群算法，获取日前供能总输出计划及日前用能总需求计划，构成初步日前优化运行计划。生成日前优化运行计划的具体步骤包括：S61：根据运行反馈数据、历史备份数据，设计供能影响因子以及用能影响因子；所述供能影响因子至少包括设备故障因子、天气突变因子/＞以及调度变化因子/＞，所述用能影响因子包括生产排班因子/＞以及季节因子/＞；S62：对所述供能影响因子和用能影响因子分别设置供能影响因子权重、/＞、以及用能影响因子权重/＞、/＞；S63：根据所述供能影响因子以及供能影响因子权重，获取供能影响值，计算如式：式中，以及/＞分别表示除设备故障因子/＞、天气突变因子/＞以及调度变化因子/＞外的其他用能影响因子和对应的供能影响因子权重；根据所述用能影响因子以及用能影响因子权重，获取用能影响值，计算如式：式中，以及/＞分别表示除生产排班因子/＞以及季节因子/＞外的其他用能影响因子和对应的用能能影响因子权重；S64：根据所述日前供能总输出计划以及供能影响值，得到日前新供能总输出计划，计算如式：根据所述日前用能总需求计划以及用能影响值，得到日前新用能总需求计划，计算如式：S65：根据日前新供能总输出计划以及日前新用能总需求计划，生成日前优化运行计划。对所述日内系统元素进行突变性判别的具体步骤包括：S71：将一天24小时设定若干个时间片，优选的，以每10min为单位时间片，将一天划为144个时间片；S72：实时监测每一个时间片内变化元素，包括源、荷、设备工况以及调度计划，计算每一个时间片内各变化元素的实时监测值与日前预设值的绝对差值；S73：若绝对差差值超过设定阈值，则启动纠偏机制，否则按日前优化运行计划运行。根据日内电网调度需求，纠偏日前优化运行计划的具体步骤包括：S81：当日内电网调度需求为填谷型需求响应时，优先考虑错峰生产计划，包括加大制氢功率、扩大制氢产能以及提升用能负荷；若无法提升用能负荷，则根据储能系统充电空间情况，进一步选择对储能系统或光伏系统进行功率优化分配；S82：当日内电网调度需求为削峰型需求响应时，根据光伏系统预测功率以及储能系统放电能力，选择对光伏系统和储能系统进行优化调度；若光伏系统和储能系统联合调度也无法满足电网需求响应时，对虚拟电厂用能负荷按需进行优化分配，优先选择对系统冗余负荷降负荷或切除冗余负荷；S83：日内调度需求响应结束后，恢复日前优化运行计划。根据突变性判别结果，纠偏日前优化运行计划的具体包括：根据光伏日前计划调度指令与光伏实际输出功率偏差，建立光伏调度纠偏机制以及光伏调度纠偏策略；以及根据日前储能调度需求与实时储能充放电能力的偏差，建立储能充放电出力纠偏机制以及储能充放电出力纠偏策略。所述光伏调度纠偏机制包括根据光伏日前计划调度指令与光伏实际输出功率偏差设定光伏优化调度权重，具体包括：监视网以每5s的采样间隔进行实时监测，若光伏实际输出功率不足调度指令的50%，此时光伏优化调度权重设置为1，表示立即响应优化调度；若光伏实际输出功率占调度指令的50%~90%时，光伏优化调度权重设为0.5，表示等待下一个时间片，若出现类似情况则需优化调度，否则仍按原先日前计划运行；若光伏实际输出功率占调度指令的90%以上时，调度权重为0，表示忽略变化，仍按原先计划曲线运行；所述光伏调度纠偏策略具体步骤包括：S91：获取光伏初次调度指令、储能初次调度指令、制氢需求以及可调负荷需求，初次分配时，光伏初次调度指令的影响因素包括日前光伏预测发电功率，储能初次调度指令的影响因素包括储能SOC荷电状态、储能单体电压、储能端口电压以及储能充放电能力，制氢需求的影响因素包括制氢任务、排班计划以及峰谷电价，可调负荷需求的影响因素包括生产需求、调度需求以及虚拟电厂考核指标；S92：根据峰谷电价、储能系统SOC荷电状态、储能系统放电能力、冗余负荷调节空间进行综合调配，具体包括：S921：当处于谷时电价时间片，光伏调度偏差由电网承担；S922：当处于峰时电价时间片，考虑储能系统SOC荷电状态、储能系统放电能力弥补光伏调度偏差；若储能系统具备弥补光伏调度偏差的能力，优先由储能系统响应，此时储能系统的迭代更新指令如式：式中，表示d日t时间片更新后的储能调度指令，/＞表示d日t时间片储能初次调度指令，/＞表示由储能系统响应时，d日t时间片光伏日前调度指令与光伏实际输出功率偏差，计算方法如式：若储能系统不具备弥补光伏调度偏差的能力，则选择由储能系统和可调负荷联合调配满足运行需求，储能修正指令与可调负荷需求分别计算如式：式中，表示由储能系统和可调负荷联合响应时，d日t时间片光伏日前调度指令与光伏实际输出功率偏差，/＞表示d日t时间片储能系统弥补光伏调度的部分偏差，/＞表示d日t时间片可调负荷弥补光伏调度的部分偏差，/＞表示d日t时间片储能系统实时修正指令，/＞表示d日t时间片可调负荷日内修正值，/＞表示d日t时间片可调负荷需求。所述储能充放电出力纠偏机制包括：统筹储能SOC与充放电能力，通过储能SOC变化实时修正储能充放电能力，具体包括：当储能SOC大于等于其最大允许值时，优先将储能充电能力设置为0，放电能力保持不变；当储能SOC小于等于其最小允许值时，优先将储能放电能力设置为0，充电能力保持不变；以及统筹储能单体电压与储能充放电能力，通过储能单体电压变化实时修正储能充放电能力，具体包括：当储能SOC大于等于其最小允许值且小于等于其最大允许值时，通过实时单体电压与设定的最大单体电压阈值以及最小单体电压阈值和均值单体电压阈值的算数平均值来判定，进一步修正充放电能力值；当实体单体电压小于等于其最小允许值时，将储能放电能力设置为0，充电能力保持不变；当实体单体电压大于等于其最大允许值时，将储能充电能力设置为0，放电能力保持不变；当实体单体电压大于等于其最小允许值且小于等于其最大允许值时，将储能充电能力设置为0.5倍，放电能力保持不变；所述储能充放电出力纠偏策略包括：S101：计算储能系统能力值与日前生产的调度计划的偏差，如式：式中，表示d日t时间片储能系统能力值；S102：根据峰谷电价、储能系统SOC荷电状态、储能系统放电能力、冗余负荷容量进行综合调配，具体包括：S1021：当储能初次调度指令为充电指令时，判断储能充电调度需求与实际充电能力的偏差以及设定阈值的大小，若偏差＜=设定阈值，优先通过调节光伏功率满足目标要求；储能修正指令如式：当时，更新后的d日t时间片制氢需求/＞计算如式： 式中，表示d日t时间片制氢需求；/＞当时，光伏修正指令如式：S1022：当储能初次调度指令为放电指令时，判断储能放电调度需求与实际充电能力的偏差以及设定阈值的大小，若偏差＞设定阈值，优先通过提升光伏发电功率满足目标要求，若偏差＜=设定阈值，优先通过调节光伏功率满足目标要求；储能修正指令如式；当时，更新后的d日t时间片光伏修正指令计算如式；当时，更新后的d日t时间片可调负荷需求如式：。另外，还包括考虑日前负荷需求与临时性制氢生产要求的偏差，建立负荷需求纠偏机制以及负荷需求纠偏策略，纠偏日前优化运行计划；当日前负荷需求与临时性制氢生产要求的偏差处于设定阈值区间内，即，保持日前最优曲线运行；当日前负荷需求与临时性制氢生产要求的偏差大于设定阈值区间，即，启动光储联动调节机制满足目标需求，具体包括：优先提升光伏发电功率；当光伏发电功率无法满足需求时，再根据峰谷电价、储能充放电能力进行综合调节储能系统；当光伏发电功率以及光储系统均无法满足需求时，通过优化系统内的冗余负荷进行响应，缺额部分由电网承担；根据日内供能设备突发性故障的偏差，调度系统进行闭锁保护，优先通过调节光伏系统，消弭因储能故障带来的系统不稳定，纠偏日前优化运行计划；当光伏系统出现故障时，优先结合当前储能充放电能力调节储能调度指令，消弭因光伏系统故障带来的系统不稳定，若储能无法弥补，缺额由电网承担；当储能系统出现故障时，优先通过调节光伏系统，消弭因储能系统故障带来的系统不稳定。将虚拟电厂日前数据与日内运行数据作为历史数据上传反馈至数据分析平台的实施步骤具体包括：将运行日的日前计划调度曲线、实际调度曲线以及日内电网调度需求、日内突变元素，包括光伏实际发电功率偏差、负荷偏差、系统故障状态偏差、储能充放电能力偏差等作为历史运行数据，以每5min的时间间隔上送至监视网，一方面为粒子群算法提供数据作为参考，用于提升日前运行计划的精准度，一方面也为更加合理的排班任务做数据指导。本技术方案采用监控分离的方式，通过独立的监视网与控制网有效配合，提升响应速度，增强控制精度；另外，可根据具体项目的实际需求，设定监视网与控制网的时间间隔，满足项目快速监测、快速控制的目标。
