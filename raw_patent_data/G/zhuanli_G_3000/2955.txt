标题title
一种皮肤烟酸反应分类设备
摘要abst
本发明公开了一种皮肤烟酸反应分类设备，包括：红外图像采集装置，用于采集检测对象的皮肤浅层红外图像；可见光图像采集装置，用于对检测对象的烟酸皮试区域进行视频拍摄，得到视频图像数据；处理模块，用于根据皮肤浅层红外图像确定检测对象的烟酸皮试区域；还用于从视频图像数据中提取S特征和G特征，以及根据S特征和G特征确定检测对象的皮肤烟酸反应分类结果；S特征用于表征检测对象的烟酸反应皮肤的面积随时间变化的规律，G特征用于表征视频图像数据中的烟酸反应皮肤的绿色分量随时间变化的规律。利用本发明的皮肤烟酸反应分类设备能够有效利用皮肤烟酸反应来准确、量化地开展心理疾病检测。
权利要求书clms
1.一种皮肤烟酸反应分类设备，其特征在于，包括：红外图像采集装置，用于采集检测对象的皮肤浅层红外图像；处理模块，用于根据所述红外图像采集装置所采集的皮肤浅层红外图像确定所述检测对象的烟酸皮试区域；可见光图像采集装置，用于对所述烟酸皮试区域进行视频拍摄，得到视频图像数据；所述处理模块，还用于从所述视频图像数据中提取S特征和G特征，以及根据所述S特征和所述G特征确定所述检测对象的皮肤烟酸反应分类结果；其中，所述S特征用于表征所述检测对象的烟酸反应皮肤的面积随时间变化的规律，所述G特征用于表征所述视频图像数据中的烟酸反应皮肤的绿色分量随时间变化的规律。2.根据权利要求1所述的皮肤烟酸反应分类设备，其特征在于，所述处理模块，从所述视频图像数据中提取S特征和G特征，包括：对所述视频图像数据中的每一帧图像均按照预处理流程进行预处理，得到各帧预处理后的图像；针对每帧预处理后的图像，将该图像输入至预先训练完成的神经网络模型，以使所述神经网络模型输出该图像对应的烟酸反应皮肤分割结果；分别从每个烟酸反应皮肤分割结果中提取烟酸反应皮肤的面积以及绿色分量；按照时间顺序组合所提取的面积得到所述S特征，并按照时间顺序组合所提取的绿色分量得到所述G特征。3.根据权利要求2所述的皮肤烟酸反应分类设备，其特征在于，所述神经网络模型，包括：特征提取模块，用于从图像中提取浅层烟酸反应皮肤特征和深层烟酸反应皮肤特征；ASPP模块，用于对所述深层烟酸反应皮肤特征进行多感受野特征的提取以及通道拼接，得到第一ASPP特征；第一上采样模块，用于对所述第一ASPP特征进行上采样，得到第二ASPP特征；特征融合模块，用于融合所述浅层烟酸反应皮肤特征和所述第二ASPP特征，得到融合烟酸反应皮肤特征；第二上采样模块，用于对所述融合烟酸反应皮肤特征进行上采样，得到待分割烟酸反应皮肤特征；分割头，用于对所述待分割烟酸反应皮肤特征进行关于烟酸反应皮肤的图像分割，得到烟酸反应皮肤分割结果。4.根据权利要求3所述的皮肤烟酸反应分类设备，其特征在于，所述特征提取模块是将Resnet50网络中的瓶颈层替换为ResNext网络中的瓶颈层，并为替换后的瓶颈层引入通道注意力机制得到的；并且，所述特征提取模块中，Resnet50网络中位于中后期的stage中的卷积操作被配置为空洞卷积。5.根据权利要求2所述的皮肤烟酸反应分类设备，其特征在于，所述神经网络模型是基于多个烟酸反应皮肤图像以及所述烟酸反应皮肤图像对应的烟酸反应皮肤分割数据进行训练得到的；其中，所述烟酸反应皮肤图像包括原始拍摄的烟酸反应皮肤图像以及对原始拍摄的烟酸反应皮肤图像进行图像增广得到的烟酸反应皮肤图像。6.根据权利要求2所述的皮肤烟酸反应分类设备，其特征在于，所述预处理包括：对图像进行大小调整、亮度和色彩的直方图均衡化以及标准化处理。7.根据权利要求2所述的皮肤烟酸反应分类设备，其特征在于，从烟酸反应皮肤分割结果中提取烟酸反应皮肤的绿色分量的方式，包括：确定烟酸反应皮肤分割结果中对应烟酸反应皮肤的目标像素块，并求取目标像素块的绿色分量均值；确定烟酸反应皮肤分割结果中非对应烟酸反应皮肤的背景像素块，并求取背景像素块的绿色分量均值；用所述背景像素块的绿色分量均值对所述目标像素块的绿色分量均值进行调整，得到所提取的烟酸反应皮肤的绿色分量。8.根据权利要求2所述的皮肤烟酸反应分类设备，其特征在于，从烟酸反应皮肤分割结果中提取烟酸反应皮肤的绿色分量的方式，包括：确定烟酸反应皮肤分割结果中对应烟酸反应皮肤的目标像素块的边缘；根据所述边缘圈出所述烟酸反应皮肤分割结果中位于烟酸反应皮肤附近的背景像素块；求取所述目标像素块的绿色分量均值，并求取所述背景像素块的绿色分量均值；用所述背景像素块的绿色分量均值对所述目标像素块的绿色分量均值进行调整，得到所提取的烟酸反应皮肤的绿色分量。9.根据权利要求7或8所述的皮肤烟酸反应分类设备，其特征在于，所述用所述背景像素块的绿色分量均值对所述目标像素块的绿色分量均值进行调整，包括：将所述目标像素块的绿色分量均值减去所述背景像素块的绿色分量均值。10.根据权利要求1所述的皮肤烟酸反应分类设备，其特征在于，所述处理模块，根据所述S特征和所述G特征确定所述检测对象的皮肤烟酸反应分类结果，包括：将所述S特征和所述G特征进行组合，得到组合特征；利用预先训练完成的、用于皮肤烟酸反应分类结果分类的分类器对所述组合特征进行分类，得到皮肤烟酸反应分类结果。
说明书desc
技术领域本发明属于医疗设备领域，具体涉及一种皮肤烟酸反应分类设备。背景技术烟酸是一种水溶性维生素，通过接触人体皮肤可引起皮肤潮红反应。相关研究表面，存在心理疾病的人往往有烟酸皮肤反应钝化的生物现象；因此，通过在皮肤上涂抹烟酸试剂进行烟酸皮试，并观察皮肤烟酸反应，可以诊断检测对象是否有心理疾病。现有技术中，利用烟酸皮试开展心理疾病诊断的方式主要包括观察评估法和激光多普勒法两种；其中，观察评估法通过人为观察皮肤潮红的程度并给予打分，从而用主观打分实现诊断；激光多普勒法则是利用激光多普勒仪检测烟酸皮试点处的皮肤下的血流速度，从而利用血流速度来量化烟酸反应的程度，以根据反应程度的轻重来判断检测对象是否有心理疾病。然而，观察评估法存在主观性强、准确性不高的问题；激光多普勒法中由于烟酸皮试点处的皮肤下的血流速度与烟酸反应的程度并不十分线性相关，其准确性也有待商榷。因此，急需一种能够有效利用皮肤烟酸反应来准确、量化地开展心理疾病检测的方案。发明内容为了解决现有技术中所存在的上述问题，本发明提供了一种皮肤烟酸反应分类设备。本发明要解决的技术问题通过以下技术方案实现：一种皮肤烟酸反应分类设备，包括：红外图像采集装置，用于采集检测对象的皮肤浅层红外图像；处理模块，用于根据所述红外图像采集装置所采集的皮肤浅层红外图像确定所述检测对象的烟酸皮试区域；可见光图像采集装置，用于对所述烟酸皮试区域进行视频拍摄，得到视频图像数据；所述处理模块，还用于从所述视频图像数据中提取S特征和G特征，以及根据所述S特征和所述G特征确定所述检测对象的皮肤烟酸反应分类结果；其中，所述S特征用于表征所述检测对象的烟酸反应皮肤的面积随时间变化的规律，所述G特征用于表征所述视频图像数据中的烟酸反应皮肤的绿色分量随时间变化的规律。可选地，所述处理模块，从所述视频图像数据中提取S特征和G特征，包括：对所述视频图像数据中的每一帧图像均按照预处理流程进行预处理，得到各帧预处理后的图像；针对每帧预处理后的图像，将该图像输入至预先训练完成的神经网络模型，以使所述神经网络模型输出该图像对应的烟酸反应皮肤分割结果；分别从每个烟酸反应皮肤分割结果中提取烟酸反应皮肤的面积以及绿色分量；按照时间顺序组合所提取的面积得到所述S特征，并按照时间顺序组合所提取的绿色分量得到所述G特征。可选地，所述神经网络模型，包括：特征提取模块，用于从图像中提取浅层烟酸反应皮肤特征和深层烟酸反应皮肤特征；ASPP模块，用于对所述深层烟酸反应皮肤特征进行多感受野特征的提取以及通道拼接，得到第一ASPP特征；第一上采样模块，用于对所述第一ASPP特征进行上采样，得到第二ASPP特征；特征融合模块，用于融合所述浅层烟酸反应皮肤特征和所述第二ASPP特征，得到融合烟酸反应皮肤特征；第二上采样模块，用于对所述融合烟酸反应皮肤特征进行上采样，得到待分割烟酸反应皮肤特征；分割头，用于对所述待分割烟酸反应皮肤特征进行关于烟酸反应皮肤的图像分割，得到烟酸反应皮肤分割结果。可选地，所述特征提取模块是将Resnet50网络中的瓶颈层替换为ResNext网络中的瓶颈层，并为替换后的瓶颈层引入通道注意力机制得到的；并且，所述特征提取模块中，Resnet50网络中位于中后期的stage中的卷积操作被配置为空洞卷积。可选地，所述神经网络模型是基于多个烟酸反应皮肤图像以及所述烟酸反应皮肤图像对应的烟酸反应皮肤分割数据进行训练得到的；其中，所述烟酸反应皮肤图像包括原始拍摄的烟酸反应皮肤图像以及对原始拍摄的烟酸反应皮肤图像进行图像增广得到的烟酸反应皮肤图像。可选地，所述预处理包括：对图像进行大小调整、亮度和色彩的直方图均衡化以及标准化处理。可选地，从烟酸反应皮肤分割结果中提取烟酸反应皮肤的绿色分量的方式，包括：确定烟酸反应皮肤分割结果中对应烟酸反应皮肤的目标像素块，并求取目标像素块的绿色分量均值；确定烟酸反应皮肤分割结果中非对应烟酸反应皮肤的背景像素块，并求取背景像素块的绿色分量均值；用所述背景像素块的绿色分量均值对所述目标像素块的绿色分量均值进行调整，得到所提取的烟酸反应皮肤的绿色分量。可选地，从烟酸反应皮肤分割结果中提取烟酸反应皮肤的绿色分量的方式，包括：确定烟酸反应皮肤分割结果中对应烟酸反应皮肤的目标像素块的边缘；根据所述边缘圈出所述烟酸反应皮肤分割结果中位于烟酸反应皮肤附近的背景像素块；求取所述目标像素块的绿色分量均值，并求取所述背景像素块的绿色分量均值；用所述背景像素块的绿色分量均值对所述目标像素块的绿色分量均值进行调整，得到所提取的烟酸反应皮肤的绿色分量。可选地，所述用所述背景像素块的绿色分量均值对所述目标像素块的绿色分量均值进行调整，包括：将所述目标像素块的绿色分量均值减去所述背景像素块的绿色分量均值。可选地，所述处理模块，根据所述S特征和所述G特征确定所述检测对象的皮肤烟酸反应分类结果，包括：将所述S特征和所述G特征进行组合，得到组合特征；利用预先训练完成的、用于皮肤烟酸反应分类结果分类的分类器对所述组合特征进行分类，得到皮肤烟酸反应分类结果。本发明提供的皮肤烟酸反应分类设备中，红外图像采集装置可以采集检测对象的皮肤浅层红外图像，处理模块根据红外图像采集装置所采集的皮肤浅层红外图像可以确定检测对象的毛细血管分布稠密程度，从而选择烟酸皮试区域。可见光图像采集装置对检测对象的烟酸皮试区域进行视频拍摄，得到视频图像数据；处理模块从视频图像数据中提取S特征和G特征，并根据S特征和G特征确定检测对象的皮肤烟酸反应分类结果。其中，S特征用于表征检测对象的烟酸反应皮肤的面积随时间变化的规律，G特征用于表征视频图像数据中的烟酸反应皮肤的绿色分量随时间变化的规律；烟酸反应皮肤的面积体现了检测对象的烟酸反应皮肤在空间维度的特性，烟酸反应皮肤的绿色分量体现了检测对象的烟酸反应皮肤在颜色维度的特性，烟酸反应皮肤的面积随时间变化的规律以及烟酸反应皮肤的绿色分量随时间变化的规律则体现了检测对象的烟酸反应皮肤在时间维度的特性。因此，本发明在得到皮肤烟酸反应分类结果的过程中综合考虑了烟酸反应皮肤在时间、空间以及颜色三种维度上的特点，从而可以得到更为准确的皮肤烟酸反应分类结果；因此利用本发明的皮肤烟酸反应分类设备能够有效利用皮肤烟酸反应来准确、量化地开展心理疾病检测，且检测结果具有较强的客观性和较高的准确性；此外由于设备是自动化运行，因此本发明还具有较高的执行效率，实用性较强的特点。以下将结合附图及对本发明做进一步详细说明。附图说明图1是本发明实施例提供的一种皮肤烟酸反应分类设备的结构示意图；图2中示出了本发明实施例中的红外图像采集装置所采集的皮肤浅层红外图像；图3是本发明实施例中的处理模块从视频图像数据中提取S特征和G特征的流程图；图4中是本发明实施例中从烟酸反应皮肤分割结果中提取烟酸反应皮肤的绿色分量的示意图；图5是本发明实施例中提出的一种用于烟酸反应皮肤分割的神经网络模型的结构示意图；图6中示出了Resnet50网络的结构示意图。具体实施方式下面结合具体实施例对本发明做进一步详细的描述，但本发明的实施方式不限于此。为了有效利用皮肤烟酸反应来准确、量化地开展心理疾病检测，本发明实施例提供了一种皮肤烟酸反应分类设备，参见图1所示，该设备包括：红外图像采集装置10、可见光图像采集装置20以及处理模块30，此外还包括这些装置之间通信所需的通信总线40。红外图像采集装置10，用于采集检测对象的皮肤浅层红外图像。图2中示出了一个皮肤浅层红外图像。可见光图像采集装置20，用于对检测对象的烟酸皮试区域进行视频拍摄，得到视频图像数据。在拍摄时，可见光图像采集装置20可以借助于辅助的机械结构来确保烟酸皮试区域相对于自身的位置不产生大的位移，还可以借助于补光组件来保证整个拍摄过程中的光照条件的一致性。在实际应用中，为了更好的用视频图像数据记录检测对象的皮肤烟酸反应过程，可以通过预先进行数据统计，来确定适用整体人群的烟酸反应所需时长，从而拍摄相应时长的视频图像数据。处理模块30，用于根据红外图像采集装置10所采集的皮肤浅层红外图像确定检测对象的烟酸皮试区域。可以理解的是，处理模块根据红外图像采集装置10所采集的皮肤浅层红外图像可以确定检测对象的毛细血管分布稠密程度，从而根据毛细血管分布稠密程度选择烟酸皮试区域。具体的，基于红外图像采集装置10所采集的皮肤浅层红外图像，处理模块30首先可以生成每张皮肤浅层红外图像的灰度直方图，然后根据各张灰度直方图来选择检测对象的烟酸皮试区域。其中，针对每张灰度直方图，统计其中位于预设的灰度阈值以上的像素分布情况，并从中选择像素数量更多且分布更为均匀的灰度直方图，被选中的该灰度直方图所对应的皮肤浅层红外图像中拍摄的烟酸皮试区域，即可以优选作为检测对象的烟酸皮试区域。可以理解的是，上述的灰度阈值用于区分像素对应血管或血管以外的皮肤。处理模块30，还用于从可见光图像采集装置20拍摄的视频图像数据中提取S特征和G特征，以及根据S特征和G特征确定检测对象的皮肤烟酸反应分类结果。其中，S特征用于表征检测对象的烟酸反应皮肤的面积随时间变化的规律，G特征用于表征视频图像数据中的烟酸反应皮肤的绿色分量随时间变化的规律。具体的，参见图3所示，处理模块30从视频图像数据中提取S特征和G特征的过程包括：步骤一、对视频图像数据中的每一帧图像均按照预处理流程进行预处理，得到各帧预处理后的图像。这里，预处理可以包括：对图像进行大小调整、亮度和色彩的直方图均衡化以及标准化处理，当然并不局限于此。其中，大小调整是为了便于对图像进行后续的处理；直方图均衡化可以增强图像中的烟酸反应皮肤与非烟酸反应皮肤的对比度；标准化可以降低针对具有不同肤色的检测对象所拍摄的图像的特异性，标准化所采用的标准差和均值可以预先指定。步骤二、针对每帧预处理后的图像，将该图像输入至预先训练完成的神经网络模型，以使神经网络模型输出该图像对应的烟酸反应皮肤分割结果。其中，神经网络模型是基于多个烟酸反应皮肤图像以及烟酸反应皮肤图像对应的烟酸反应皮肤分割数据进行训练得到的。可以理解的是，这里说的神经网络模型是一种图像分割模型，相关技术中可用于进行图像分割的神经网络模型存在多种，例如U-Net、SegNet、DeepLab、Patch-basedTansformer以及Query-based Transformer等。在一种优选实现方式中，为了提高烟酸反应皮肤的分割准确性，也可以自行搭建适用于烟酸反应皮肤分割的神经网络模型，这都是可以的。步骤三、分别从每个烟酸反应皮肤分割结果中提取烟酸反应皮肤的面积以及绿色分量。可以理解的是，烟酸反应皮肤分割结果包括了图像中的像素对应烟酸反应皮肤或非对应烟酸反应皮肤的数据，因此通过统计烟酸反应皮肤分割结果中对应烟酸反应皮肤的像素点数量，便可以得到烟酸反应皮肤的精确面积。另外，如果视频图像数据中的烟酸皮试点包括多处，则每处烟酸皮试点分别对应一块烟酸反应皮肤，通过分别统计对应单块烟酸反应皮肤的连续像素点的数量，可以得到各块烟酸反应皮肤的面积。相应的，最终提取的烟酸反应皮肤的面积可以包括各块烟酸反应皮肤的面积，还可以包括一个总面积。相关研究表面，存在心理疾病的人与健康人的皮肤烟酸反应在颜色上有着明显差异。发明人通过进一步研究发现，这两类人的烟酸反应皮肤的颜色差异更多的体现在图像RGB颜色空间的绿色分量上的显著差异。因此，本发明实施例从图像中提取的烟酸反应皮肤的绿色分量具有更高的参考价值。可以理解的是，根据烟酸反应皮肤分割结果可以确定图像中的哪些像素对应烟酸反应皮肤，相应的根据这些像素的绿色分量便可以得到烟酸反应皮肤的绿色分量。示例性的，在一种实现方式中，参见图4中的子图所示，从烟酸反应皮肤分割结果中提取烟酸反应皮肤的绿色分量的方式，可以包括：确定烟酸反应皮肤分割结果中对应烟酸反应皮肤的目标像素块，并求取目标像素块的绿色分量均值；确定烟酸反应皮肤分割结果中非对应烟酸反应皮肤的背景像素块，并求取背景像素块的绿色分量均值；用背景像素块的绿色分量均值对目标像素块的绿色分量均值进行调整，得到所提取的烟酸反应皮肤的绿色分量。在另一种实现方式中，参见图4中的子图所示，从烟酸反应皮肤分割结果中提取烟酸反应皮肤的绿色分量的方式，可以包括：确定烟酸反应皮肤分割结果中对应烟酸反应皮肤的目标像素块的边缘；根据该边缘圈出烟酸反应皮肤分割结果中位于烟酸反应皮肤附近的背景像素块；求取目标像素块的绿色分量均值，并求取背景像素块的绿色分量均值；用背景像素块的绿色分量均值对目标像素块的绿色分量均值进行调整，得到所提取的烟酸反应皮肤的绿色分量。可以理解的是，第二种提取绿色分量的实现方式中，排除了烟酸反应皮肤以外的大部分背景区域，由此可排除背景区域中所可能存在的光斑、噪声或者其他干扰目标的影响，从而更进一步地提高了所提取绿色分量的准确度。上述两种提取绿色分量的实现方式中，用背景像素块的绿色分量均值对目标像素块的绿色分量均值进行调整，包括：用目标像素块的绿色分量均值减去背景像素块的绿色分量均值。这里，用背景像素块的绿色分量均值对目标像素块的绿色分量均值进行调整，一方面能够保留烟酸反应皮肤本身的特征属性，另一方面还可以消除皮肤差别造成的影响。具体来说，由于不同人的肤色存在差别，因此分割出的烟酸反应皮肤中其实是包含有检测对象本身的肤色信息在内的。这样一来，不同肤色的人的烟酸反应皮肤的绿色分量便不能对应统一的生成标准。因此，通过用背景像素块的绿色分量均值对目标像素块的绿色分量均值进行调整，可以消除该不利影响，从而使提取的绿色分量能够更加准确地表征检测对象的烟酸反应皮肤本身的特征属性。另外，对于烟酸皮试点包括多处的情况而言，目标像素块包括多块，求取目标像素块的绿色分量均值时直接求取多块目标像素块的绿色分量均值即可；其中，对于第二种实现方式而言，由于背景像素块也包括多块，因此求取背景像素块的绿色分量均值时同样是直接求取多块背景像素块的绿色分量均值即可。步骤四、按照时间顺序组合所提取的面积得到S特征，并按照时间顺序组合所提取的绿色分量得到G特征。具体的，按照时间顺序，用向量或者数组的形式来组合提取的面积得到S特征；同理，按照时间顺序，用向量或者数组的形式来组合提取的面积得到G特征。处理模块30提取到S特征和G特征后，便可以根据S特征和G特征确定检测对象的皮肤烟酸反应分类结果。具体的，将S特征和G特征进行组合，得到组合特征；利用预先训练完成的、用于皮肤烟酸反应分类的分类器对组合特征进行分类，得到皮肤烟酸反应分类结果。这里，分类器可选的类型存在多种，相关技术中的决策树、朴素贝叶斯以及全连接层分类器均可以应用在本发明实施例中。其中，全连接层分类器即是神经网络中常用的全连接层，这种分类器具有超强的学习能力，且网络结构更为简单。在实际应用中，可以预先对大量的人群进行烟酸皮试，并按照上文所示的S特征和G特征的提取过程进行特征的提取和组合，并为得到的组合特征标注出其对应的真实分类。然后，利用这些组合特征来训练分类器，即可得到用于皮肤烟酸反应分类的分类器。可以理解的是，最终得到的皮肤烟酸反应分类结果的呈现形式与训练分类器时为参与训练的组合特征标注真实分类的方式一致。举例而言，如果标注时的真实分类包括有心理疾病或无心理疾病，则处理模块30最终得到的皮肤烟酸反应分类结果即是检测对象是否有心理疾病的分类结果。如果标注时的真实分类包括：无心理疾病、轻度心理疾病、中度心理疾病或重度心理疾病；则处理模块30最终得到的皮肤烟酸反应分类结果即是检测对象是否有心理疾病以及当其有心理疾病时的严重等级。本发明实施例提供的皮肤烟酸反应分类设备中，红外图像采集装置可以采集检测对象的皮肤浅层红外图像，处理模块根据红外图像采集装置采集的皮肤浅层红外图像测量血管分布稠密程度确定烟酸皮试区域。可见光图像采集装置对检测对象的烟酸皮试区域进行视频拍摄，得到视频图像数据；处理模块从视频图像数据中提取S特征和G特征，并根据S特征和G特征确定检测对象的皮肤烟酸反应分类结果。其中，S特征用于表征检测对象的烟酸反应皮肤的面积随时间变化的规律，G特征用于表征视频图像数据中的烟酸反应皮肤的绿色分量随时间变化的规律；烟酸反应皮肤的面积体现了检测对象的烟酸反应皮肤在空间维度的特性，烟酸反应皮肤的绿色分量体现了检测对象的烟酸反应皮肤在颜色维度的特性，烟酸反应皮肤的面积随时间变化的规律以及烟酸反应皮肤的绿色分量随时间变化的规律则体现了检测对象的烟酸反应皮肤在时间维度的特性。因此，本发明实施例在得到皮肤烟酸反应分类结果的过程中综合考虑了烟酸反应皮肤在时间、空间以及颜色三种维度上的特点，从而可以得到更为准确的皮肤烟酸反应分类结果；因此利用本发明实施例的皮肤烟酸反应分类设备能够有效利用皮肤烟酸反应来准确、量化地开展心理疾病检测，且检测结果具有较强的客观性和较高的准确性；此外由于设备是自动化运行，因此本发明还具有较高的执行效率，实用性较强的特点。在一个实施例中，参见图5所示，处理模块30中所使用的神经网络模型，可以包括：特征提取模块，用于从图像中提取浅层烟酸反应皮肤特征L和深层烟酸反应皮肤特征H；ASPP模块，用于对深层烟酸反应皮肤特征H进行多感受野特征的提取以及通道拼接，得到第一ASPP特征，图5中用ASPP-1表示。第一上采样模块，用于对第一ASPP特征进行上采样，得到第二ASPP特征，图5中用ASPP-2表示；这里，对第一ASPP特征进行上采样的目的是为了使第二ASPP特征与浅层烟酸反应皮肤特征L的分辨率相等。特征融合模块，用于融合浅层烟酸反应皮肤特征L和第二ASPP特征ASPP-2，得到融合烟酸反应皮肤特征M；该融合烟酸反应皮肤特征M既包含细粒度图像信息又包含高层次语义信息；第二上采样模块，用于对融合烟酸反应皮肤特征M进行上采样，得到待分割烟酸反应皮肤特征；分割头，用于对待分割烟酸反应皮肤特征M进行关于烟酸反应皮肤的图像分割，得到烟酸反应皮肤分割结果。其中，特征提取模块的具体类型可以存在多种。示例性的，在一种实现方式中，该特征提取模块可以包括：Xception网络。在另一种实现方式中，该特征提取模块可以是将Resnet50网络中的瓶颈层替换为ResNext网络中的瓶颈层，并为替换后的瓶颈层引入通道注意力机制得到的，这样可以使网络能够重点关注与烟酸反应皮肤分割任务相关的有用信息，忽略无关信息。并且，该特征提取模块中，Resnet50网络中位于中后期的stage中的卷积操作被配置为空洞卷积，这样可以在增加感受野的同时，尽可能地保留与分割烟酸反应皮肤有关的图像细节信息。这里，使用空洞卷积的操作在一定程度上可以代替下采样操作，弥补了特征图缩小再放大的过程中所造成的精度上的损失。可以理解的是，相较于Resnet50网络来说，ResNext网络中的bottleneck采用了一种平行堆叠相同拓扑的结构，能够在不明显增加参数量级的情况下提升模型的准确率。图6中示出了Resnet50网络的详细结构，其中stage1～stage4中均包含有bottleneck，将这些bottleneck替换为ResNext网络中的bottleneck，再为替换后的bottleneck加载通道注意力机制。具体而言，假设在未引入通道注意力机制时，进入到bottleneck的特征为X，bottleneck内部对特征X进行处理后输出一个W×H×C的特征X’。则针对该bottleneck引入通道注意力机制的方式如下：将X’首先通过一个全局池化层获得一个1×1×C的一维向量，再依次通过一个全连接层、ReLU激活层、另一个全连接层后通过Sigmoid函数层；将Sigmoid函数层输出的特征与X’进行广播点对点相乘，即将Sigmoid函数层输出的特征中的每一个值作为X’的通道权值赋予到X’中，得到X”。然后，将X”与X进行相加得到将该/＞送入原本X’要进入的后续网络。可以理解的是，对于图6所示结构而言，中后期的stage指的是stage3和stage4，即将stage3和stage4中的卷积转换为空洞卷积。可选地，在一种实现方式中，训练神经网络模型时使用的烟酸反应皮肤图像包括原始拍摄的烟酸反应皮肤图像以及对原始拍摄的烟酸反应皮肤图像进行图像增广得到的烟酸反应皮肤图像。可以理解的是，通过数据增广的方式对数据进行扩充，可以让训练数据集尽可能的丰富，使数据集中各类图像的数量尽可能的均衡，这样可以防止在训练过程中因训练样本数量不足而产生过拟合现象，并增强模型的稳健性。其中，图像增广方式包括但不限于水平翻转、平移、旋转、缩放、随机裁剪、高斯噪声、4点透视变换、随机亮度对比度增强、图像锐化、图像模糊、动态模糊以及随机改变HSV值。另外，还可以对烟酸反应皮肤图像进行预处理；这里对烟酸反应皮肤图像进行预处理的方式可以与处理模块30对视频图像数据中的图像进行预处理的方式相同。并且，处理模块30对视频图像数据中的图像进行标准化时使用的标准差和均值可以借鉴参与训练的多个烟酸反应皮肤图像的标准差和均值，这样还能消除模型在训练和使用两个阶段的性能差异。当构建好了神经网络模型的网络结构、并获取了足够的用于训练的烟酸反应皮肤图像并之后，便可以对模型展开训练；训练过程中可以计算DiceLoss作为模型损失，DiceLoss的基本思想是将需要优化的目标指标直接作为损失函数，本发明实施例中神经网络模型的训练目标正是最大化其所分割的烟酸反应皮肤与对应标注的烟酸反应皮肤的交并比，因此采用作为模型损失是较为合适的。另外，在训练过程中，可以采用IOU交并比来评估模型的准确度，并计算每个Epoch的IOU标准差来评估模型的稳定性。以上是对本发明实施例中使用的神经网络模型的举例说明。本发明实施例提供的皮肤烟酸反应分类设备，采用神经网络模型进行皮肤烟酸反应分类的方式充分利用了烟酸皮试真实数据，具备完整的数学理论体系；并且，本发明实施例中给出了适用于烟酸反应皮肤分割场景的自创神经网络模型，极大地提高了分割准确性和可靠性；在此基础上，本发明实施例综合考虑了烟酸反应皮肤在时间、空间以及颜色三种维度上的特点，提取了S特征和G特征两种特征来进行皮肤烟酸反应分类，从而得到准确的皮肤烟酸反应分类结果。综上，利用本发明实施例提供的皮肤烟酸反应分类设备能够有效利用皮肤烟酸反应来准确、量化地开展心理疾病检测，解决了现有技术开展心理健康评估时所存在的评估效率低下，主观性强，误诊率高，操作流程复杂，时效性短以及人工成本高的诸多技术缺陷与技术问题。需要说明的是，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个特征。在本发明的描述中，“多个”的含义是两个或两个以上，除非另有明确具体的限定。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征或者特点可以在任何的一个或多个实施例或示例中以合适的方式结合。此外，本领域的技术人员可以将本说明书中描述的不同实施例或示例进行接合和组合。尽管在此结合各实施例对本发明进行了描述，然而，在实施所要求保护的本发明过程中，本领域技术人员通过查看所述附图以及公开内容，可理解并实现所述公开实施例的其他变化。以上内容是结合具体的优选实施方式对本发明所作的进一步详细说明，不能认定本发明的具体实施只局限于这些说明。对于本发明所属技术领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干简单推演或替换，都应当视为属于本发明的保护范围。
