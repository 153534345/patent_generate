标题title
色谱仪
摘要abst
本发明涉及一种色谱仪，包括进样口、色谱柱、检测器和信号处理模块，信号处理模块用于对检测器检测的电信号进行处理，得到色谱图；信号分解及滤波模块，用于对待测目标样品的色谱图的色谱信号进行经验模态分解，得到待测目标样品的本征模函数和高频信号，并对高频信号进行贝叶斯小波滤波，得到小波重构后的信号；还用于对标准样品的色谱图的色谱信号进行经验模态分解，得到标准本征基模函数；还用于利用标准本征基模函数对待测目标样品的本征模函数进行拟合，得到拟合后本征模函数；信号重构模块，用于对小波重构后的信号与拟合后本征模函数进行信号重构，得到去噪色谱图。本发明有利于消除异常峰的影响，提升检测精度。
权利要求书clms
1.一种色谱仪，其特征在于，包括：进样口，用于对检测样品进行进样；其中，待测样品为标准样品或者待测目标样品；色谱柱，用于对检测样品进行组分分离；检测器，用于对分离后的组分进行检测，输出电信号；信号处理模块，用于对电信号进行处理，得到色谱图；信号分解及滤波模块，用于对待测目标样品的色谱图的色谱信号进行经验模态分解，得到待测目标样品的本征模函数和高频信号，并对高频信号进行贝叶斯小波滤波，得到小波重构后的信号；还用于对标准样品的色谱图的色谱信号进行经验模态分解，得到标准本征基模函数；还用于利用标准本征基模函数对待测目标样品的本征模函数进行拟合，得到拟合后本征模函数；信号重构模块，用于对小波重构后的信号与拟合后本征模函数进行信号重构，得到去噪色谱图；计算模块，用于根据去噪色谱图计算得到待测目标样品中各组分的浓度。2.根据权利要求1所述的色谱仪，其特征在于，还包括：区间划分模块，用于根据目标特征峰对标准样品的色谱图划分为M个区间，各区间包括至少一个目标特征峰；各区间对应的标准本征基模函数为：；其中，为第m个区间对应的高斯函数，am为第m个区间对应的高斯函数的函数系数，T1、T2分别为第m个区间的起点和终点对应的时间，t为时间，m∈，M为正整数。3.根据权利要求2所述的色谱仪，其特征在于，对高频信号进行贝叶斯小波滤波的过程包括：分别对各区间对应的高频信号进行多级小波分解；其中，对每级小波分解得到的高频信号，利用贝叶斯阈值作为小波阈值进行去噪，得到的去燥高频信号进行下一级小波分解；将每级小波分解得到的低频信号以及去燥高频信号进行小波重构，得到小波重构后的信号。4.根据权利要求3所述的色谱仪，其特征在于，小波分解的级数Z取值为3～8之间的整数。5.根据权利要求4所述的色谱仪，其特征在于，第z级小波分解后去噪对应的贝叶斯阈值为：；/＞；；其中，分别为第m个区间对应的第z级小波分解得到的高频信号和低频信号，/＞分别为第m个区间对应的第z+1级小波分解得到的高频信号和低频信号，th1和th2分别为预设的下限阈值和上限阈值，/＞为/＞的正态偏差，μ为加权系数，sign为符号函数，median为中值函数，z∈。6.根据权利要求5所述的色谱仪，其特征在于，所述th1和th2分别取值为和，μ取值为0.5。7.根据权利要求5所述的色谱仪，其特征在于，根据去噪色谱图计算得到待测目标样品中各组分的浓度的过程包括：基于去噪色谱图，利用预设的阈值th3、斜率k、线宽Lw确定组分的色谱峰；根据色谱峰计算峰面积；根据峰面积计算组分的浓度。8.根据权利要求7所述的色谱仪，其特征在于，根据去噪色谱图确定组分的色谱峰的过程包括：根据采样频率将去噪色谱图的横坐标由时间转换为采样点数量i，对应的色谱图为/＞；i从零开始，当出现，且/＞之后的数个采样点形成的斜率大于斜率k时，则/＞作为色谱峰的左起点，其在去噪色谱图的对应坐标为；随着i继续增大，当出现，且/＞之后的数个采样点形成的斜率小于斜率k的负值时，则/＞作为色谱峰的右终点，其在去噪色谱图的对应坐标为；判断R1-L1是否不小于线宽Lw；若是，则第一个色谱峰确定，并以左起点前后预设数量的采样点以及右终点前后预设数量的采样点进行最小二乘法拟合，得到第一个色谱峰的基线函数；在确定第一个色谱峰之后，随着i继续增大，剩余色谱峰的确定以此类推，得到所有色谱峰的左起点、右终点和基线函数。9.根据权利要求8所述的色谱仪，其特征在于，根据色谱峰计算峰面积为：；其中，Ln、Rn分别为第n个色谱峰的左起点、右终点在去噪色谱图的横坐标，为第n个色谱峰的基线函数，n∈，N为色谱峰的总数量；根据峰面积计算组分的浓度为：；其中，F为关于压力P、温度T和采样流速V的拟合系数，β为修正系数。10.根据权利要求1-9任一项所述的色谱仪，其特征在于，所述检测器为FID检测器或MS检测器。
说明书desc
技术领域本发明属于检测分析技术领域，具体涉及一种色谱仪。背景技术色谱仪通过对待测物质进行组分分离，从而获得对应物质在不同位置的色谱图，并基于色谱峰面积或高度进行定量分析。近年来，随着色谱技术和匹配检测器的发展，其检测的准确性、灵敏性不断提高，被广泛的运用于各行业的检测以及研究分析。色谱峰的峰型和基线的确定是准确定量分析的关键，传统的峰面积计算，通常根据设定的阈值以及高于阈值的次数确定色谱峰的上升起点，同时以低于相应阈值的次数确定色谱峰的下降终点，从而确定基线以及得到对应峰型；其中，阈值的设定根据经验值确定。但对于低浓度样本分析，以及液-质或气-质串联系统，传统方法对基线和峰型的确定会出现偏差，进而导致计算峰面积实现定量计算的误差较大，后期需要依靠经验丰富的操作人员进行手动计算，然而操作人员的处理习惯依然会导致计算差异较大，无法保证定量结果的准确性，且降低了检测效率。此外，不同工况下被测物质的背景组分复杂，以及随着仪器使用时间过长或维护不当，导致杂峰或异常噪声存在叠加到被测色谱峰上的情况，出现肩峰或色谱峰两边基线起伏过大，传统的方法确定基线和峰型会导致峰面积计算偏差，从而影响定量分析的准确性。发明内容基于现有技术中存在的上述缺点和不足，本发明的目的之一是至少解决现有技术中存在的上述问题之一或多个，换言之，本发明的目的之一是提供满足前述需求之一或多个的一种色谱仪。为了达到上述发明目的，本发明采用以下技术方案：一种色谱仪，包括：进样口，用于对检测样品进行进样；其中，待测样品为标准样品或者待测目标样品；色谱柱，用于对检测样品进行组分分离；检测器，用于对分离后的组分进行检测，输出电信号；信号处理模块，用于对电信号进行处理，得到色谱图；信号分解及滤波模块，用于对待测目标样品的色谱图的色谱信号进行经验模态分解，得到待测目标样品的本征模函数和高频信号，并对高频信号进行贝叶斯小波滤波，得到小波重构后的信号；还用于对标准样品的色谱图的色谱信号进行经验模态分解，得到标准本征基模函数；还用于利用标准本征基模函数对待测目标样品的本征模函数进行拟合，得到拟合后本征模函数；信号重构模块，用于对小波重构后的信号与拟合后本征模函数进行信号重构，得到去噪色谱图；计算模块，用于根据去噪色谱图计算得到待测目标样品中各组分的浓度。作为优选方案，色谱仪，还包括：区间划分模块，用于根据目标特征峰对标准样品的色谱图划分为M个区间，各区间包括至少一个目标特征峰；各区间对应的标准本征基模函数为：；其中，为第m个区间对应的高斯函数，am为第m个区间对应的高斯函数的函数系数，T1、T2分别为第m个区间的起点和终点对应的时间，t为时间，m∈，M为正整数。作为优选方案，对高频信号进行贝叶斯小波滤波的过程包括：分别对各区间对应的高频信号进行多级小波分解；其中，对每级小波分解得到的高频信号，利用贝叶斯阈值作为小波阈值进行去噪，得到的去燥高频信号进行下一级小波分解；将每级小波分解得到的低频信号以及去燥高频信号进行小波重构，得到小波重构后的信号。作为优选方案，小波分解的级数Z取值为3～8之间的整数。作为优选方案，第z级小波分解后去噪对应的贝叶斯阈值为：；；；其中，分别为第m个区间对应的第z级小波分解得到的高频信号和低频信号，/＞分别为第m个区间对应的第z+1级小波分解得到的高频信号和低频信号，th1和th2分别为预设的下限阈值和上限阈值，/＞为/＞的正态偏差，μ为加权系数，sign为符号函数，median为中值函数，z∈。作为优选方案，所述th1和th2分别取值为和/＞，μ取值为0.5。作为优选方案，根据去噪色谱图计算得到待测目标样品中各组分的浓度的过程包括：基于去噪色谱图，利用预设的阈值th3、斜率k、线宽Lw确定组分的色谱峰；根据色谱峰计算峰面积；根据峰面积计算组分的浓度。作为优选方案，根据去噪色谱图确定组分的色谱峰的过程包括：根据采样频率将去噪色谱图的横坐标由时间转换为采样点数量i，对应的色谱图为/＞；i从零开始，当出现，且/＞之后的数个采样点形成的斜率大于斜率k时，则/＞作为色谱峰的左起点，其在去噪色谱图的对应坐标为；随着i继续增大，当出现，且/＞之后的数个采样点形成的斜率小于斜率k的负值时，则/＞作为色谱峰的右终点，其在去噪色谱图的对应坐标为；判断R1-L1是否不小于线宽Lw；若是，则第一个色谱峰确定，并以左起点前后预设数量的采样点以及右终点前后预设数量的采样点进行最小二乘法拟合，得到第一个色谱峰的基线函数；在确定第一个色谱峰之后，随着i继续增大，剩余色谱峰的确定以此类推，得到所有色谱峰的左起点、右终点和基线函数。作为优选方案，根据色谱峰计算峰面积为：；其中，Ln、Rn分别为第n个色谱峰的左起点、右终点在去噪色谱图的横坐标，为第n个色谱峰的基线函数，n∈，N为色谱峰的总数量；根据峰面积计算组分的浓度为：；其中，F为关于压力P、温度T和采样流速V的拟合系数，β为修正系数。作为优选方案，所述检测器为FID检测器或MS检测器。本发明与现有技术相比，有益效果是：本发明的色谱仪利用标准样品的色谱图的色谱信号进行经验模态分解得到的标准本征基模函数对待测目标样品的本征模函数进行拟合得到拟合后本征模函数，并利用拟合后本征模函数与待测目标样品进行贝叶斯小波滤波得到的小波重构后的信号进行信号重构，有利于消除异常峰的影响；本发明的色谱仪，利用改进的贝叶斯阈值进行多级小波分解，具有消除肩峰、降噪效果好、实时性高、易实现等优点；本发明的色谱仪利用阈值、斜率和线宽三要素判断法确定每个待测组分的色谱峰，有利于剔除异常峰和消除噪声引起的肩峰的影响。附图说明图1是本发明实施例1的色谱仪的构架图；图2是本发明实施例1的色谱仪的色谱信号滤波及重构的流程图；图3是本发明实施例1的利用改进贝叶斯阈值进行小波滤波处理得到的去噪色谱图与原始色谱图以及利用通用贝叶斯阈值进行小波滤波处理得到的色谱图的对比图；图4是本发明实施例1的去噪色谱图与采用现有去噪方法处理得到的对比色谱图的对比图。具体实施方式为了更清楚地说明本发明实施例，下面将对照附图说明本发明的具体实施方式。显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图，并获得其他的实施方式。实施例1：如图1所示，本实施例的色谱仪包括进样口、色谱柱、检测器、信号处理模块、信号分解及滤波模块、信号重构模块、区间划分模块和计算模块。上述进样口、色谱柱、检测器、信号处理模块均为常规色谱仪的基础部件，其具体结构在此不赘述。本实施例的进样口用于对检测样品进行进样；其中，待测样品为标准样品或者待测目标样品，标准样品根据待测目标样品中所需检测的所有目标组分构成。本实施例的色谱柱用于对检测样品进行组分分离，之后进入检测器，对分离后的组分进行检测，得到相应的电信号；电信号输入信号处理模块，对电信号进行处理得到色谱图。其中，检测器为FID检测器。本实施例的色谱仪，首先对标准样品进行色谱检测，得到标准样品的色谱图；之后对待测目标样品进行色谱检测，得到待测目标样品的色谱图。本实施例的信号分解及滤波模块用于对标准样品的色谱图的色谱信号进行经验模态分解，得到标准本征基模函数。具体地，本实施例的区间划分模块用于根据目标特征峰对标准样品的色谱图划分为M个区间，各区间包括至少一个目标特征峰。其中，色谱图的横坐标为时间，根据采样频率可将时间转换为采样点数量，各区间的采样点数量为非等分，具体根据目标特征峰的实际分布情况进行确定。相应地，各区间对应的标准本征基模函数为：；其中，为第m个区间对应的高斯函数，am为第m个区间对应的高斯函数的函数系数，T1、T2分别为第m个区间的起点和终点对应的时间，t为时间，m∈，M为正整数。如图2所示，本实施例的信号分解及滤波模块还用于对待测目标样品的色谱图的色谱信号进行经验模态分解，得到待测目标样品的本征模函数和高频信号，并对高频信号进行贝叶斯小波滤波，得到小波重构后的信号。具体地，本实施例的区间划分模块也对待测目标样品的色谱图对应于标准样品的色谱图的M个区间一一对应划分，得到各区间的色谱信号。分别对各区间的色谱信号/＞进行经验模态分解得到：/＞，/＞为第m个区间的色谱信号/＞对应的本征模函数，/＞为第m个区间的色谱信号/＞对应的高频信号。另外，本实施例的信号分解及滤波模块还用于利用标准本征基模函数对待测目标样品的本征模函数/＞进行拟合，得到拟合后本征模函数，利用拟合后本征模函数进行后续的信号重构，有利于消除异常峰的影响。本实施例对高频信号进行贝叶斯小波滤波的过程包括：分别对各区间对应的高频信号进行多级小波分解；其中，对每级小波分解得到的高频信号，利用贝叶斯阈值作为小波阈值进行去噪，得到的去燥高频信号进行下一级小波分解；本实施例的小波分解的级数Z取值为3～8之间的整数，具体可根据实际应用工况进行确定，本实施例以Z取值为3为例，如图2所示，即阈值1、阈值2和阈值3。另外，小波分解的具体过程可参考现有技术，在此不赘述。本实施例对去噪采用的小波阈值进行了改进，具体地，第z级小波分解后去噪对应的贝叶斯阈值为：；；；其中，分别为第m个区间对应的第z级小波分解得到的高频信号和低频信号，/＞分别为第m个区间对应的第z+1级小波分解得到的高频信号和低频信号，th1和th2分别为预设的下限阈值和上限阈值，/＞为/＞的正态偏差，μ为加权系数，sign为符号函数，median为中值函数，z∈；作为示例，本实施例的th1和th2分别取值为/＞和/＞，μ取值为0.5；将每级小波分解得到的低频信号以及去燥高频信号进行小波重构，得到小波重构后的信号。本实施例的信号重构模块用于对小波重构后的信号与拟合后本征模函数进行信号重构，得到去噪色谱图。采用本实施例的贝叶斯小波滤波进行去噪，具有消除肩峰、降噪效果好、实时性高、易实现等优点。如图3所示，在低量程样本测量时，本实施例的贝叶斯小波滤波处理对噪声有明显的压制，核心在于贝叶斯小波阈值的选取对噪声压制程度完全不同，采用本实施例的改进贝叶斯阈值替代通用贝叶斯阈值/＞，能够有效压制噪声引起的波动和异常峰，有效提升基线判断的准确性，从而提高峰面积计算的精度和自动化程度。另外，如图4所示，对于噪声叠加在色谱峰上导致的凹坑，采用现有技术中的公开号为CN115700544A的文献公开的去噪方法，无法消除凹坑；而本实施例采用高斯基模能够有效消除凹坑，有利于提升检测精度。本实施例的计算模块用于根据去噪色谱图计算得到待测目标样品中各组分的浓度。具体地，根据去噪色谱图计算得到待测目标样品中各组分的浓度的过程包括：基于去噪色谱图，利用预设的阈值th3、斜率k、线宽Lw确定组分的色谱峰；根据色谱峰计算峰面积；根据峰面积计算组分的浓度。本实施例利用th3、斜率k、线宽Lw三要素判断法确定每个待测组分的色谱峰，得到色谱峰的起点、终点，剔除异常峰和消除噪声引起的肩峰的影响。具体地，根据去噪色谱图确定组分的色谱峰的过程包括：根据采样频率将去噪色谱图将去噪色谱图的横坐标由时间转换为采样点数量i，对应的色谱图为/＞；i从零开始，当出现，且/＞之后的六个采样点形成的斜率大于斜率k时，则/＞作为色谱峰的左起点，其在去噪色谱图的对应坐标为；随着i继续增大，当出现，且/＞之后的六个采样点形成的斜率小于斜率k的负值时，则/＞作为色谱峰的右终点，其在去噪色谱图的对应坐标为；判断R1-L1是否不小于线宽Lw；若是，则第一个色谱峰确定，并以左起点前后三个采样点以及右终点前后三个采样点进行最小二乘法拟合，得到第一个色谱峰的基线函数；若否，则为杂峰或异常峰，不做峰记录和计算，继续进行寻找色谱峰；在确定第一个色谱峰之后，随着i继续增大，剩余色谱峰的确定以此类推，得到所有色谱峰的左起点、右终点和基线函数。本实施例根据色谱峰计算峰面积为：；其中，Ln、Rn分别为第n个色谱峰的左起点、右终点在去噪色谱图的横坐标，为第n个色谱峰的基线函数，n∈，N为色谱峰的总数量。本实施例根据峰面积计算组分的浓度为：；其中，F为关于压力P、温度T和采样流速V的拟合系数，β为修正系数，拟合系数和修正系数的确定，具体可参考现有技术。本实施例的色谱仪对改进的贝叶斯小波滤波处理得到的去噪色谱图进行寻峰和确定基线，降低了误判概率，峰面积和浓度计算更准确，满足自动化、实时在线的监测需求。实施例2：本实施例的色谱仪与实施例1的不同之处在于：检测器采用MS检测器，适用于气相色谱与质谱联用，满足不同应用的需求；其他结构可以参考实施例1。以上所述仅是对本发明的优选实施例及原理进行了详细说明，对本领域的普通技术人员而言，依据本发明提供的思想，在具体实施方式上会有改变之处，而这些改变也应视为本发明的保护范围。
