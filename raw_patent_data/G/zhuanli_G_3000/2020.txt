标题title
一种时钟芯片内部时钟精度校正方法
摘要abst
本发明涉及数据处理技术领域，具体涉及一种时钟芯片内部时钟精度校正方法，该方法包括：获取时钟芯片内的时钟每个时间周期的时钟误差指标；根据所述时钟误差指标和标准时钟频率确定每个时间周期的校正系数；确定校正系数的理想波动范围；根据历史时间段后每个待调整的时间周期的校正系数与理想波动范围之间的差异，对理想波动范围进行调整，并更新待调整的时间周期的校正系数；根据更新后的时间周期的校正系数与历史时间段内时间周期的校正系数之间的差异情况，对时间周期进行更新；根据更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正。本发明使得时钟芯片的全局时钟校正的准确度较高。
权利要求书clms
1.一种时钟芯片内部时钟精度校正方法，其特征在于，该方法包括以下步骤：获取时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差异，计算每个时间周期内时钟芯片内的时钟误差指标；根据所述时钟误差指标和标准时钟频率确定每个时间周期的校正系数；根据历史时间段内每个时间周期的校正系数，确定校正系数的理想波动范围；根据历史时间段后每个待调整的时间周期的校正系数与理想波动范围之间的差异，对理想波动范围进行调整，并更新待调整的时间周期的校正系数；根据更新后的时间周期的校正系数与历史时间段内时间周期的校正系数之间的差异情况，对时间周期进行更新；根据更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正。2.根据权利要求1所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述根据所述时钟误差指标和标准时钟频率确定每个时间周期的校正系数，具体包括：对于任意一个时间周期，将时间周期内时钟芯片内的时钟误差指标与标准时钟频率之间的和值作为时间周期的校正系数。3.根据权利要求1所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述根据历史时间段内每个时间周期的校正系数，确定校正系数的理想波动范围，具体包括：在历史时间段所有时间周期的校正系数中，将大于特征校正系数的最小的校正系数作为理想波动范围的上限值，将小于特征校正系数的最大的校正系数作为理想波动范围的下限值。4.根据权利要求3所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述特征校正系数的获取方法具体为：将历史时间段内所有时间周期的校正系数的均值作为特征校正系数。5.根据权利要求3所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述根据历史时间段后每个待调整的时间周期的校正系数与理想波动范围之间的差异，对理想波动范围进行调整，并更新待调整的时间周期的校正系数，具体包括：将在历史时间段后的第一个待调整的时间周期记为第一调整周期；当第一调整周期的校正系数的取值在理想波动范围内时，第一调整周期更新后的校正系数与更新前的校正系数的取值相等，判断第一调整周期的校正系数是否大于特征调整系数，对理想波动范围进行调整，若是，则将第一调整周期的校正系数作为第一次调整后理想波动范围的上限值；若否，则将第一调整周期的校正系数作为第一次调整后理想波动范围的下限值；当第一调整周期的校正系数的取值不在理想波动范围内时，不对理想波动范围进行调整，根据第一调整周期的校正系数、理想波动范围以及特征校正系数，确定第一调整周期更新后的校正系数。6.根据权利要求5所述的一种时钟芯片内部时钟精度校正方法，其特征在于，按照相同的方法对历史时间段后的每个待调整的时间周期的校正系数进行更新时，若理想波动范围进行过调整操作，则利用调整后的理想波动范围对每个待调整的时间周期的校正系数进行更新。7.根据权利要求5所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述根据第一调整周期的校正系数、理想波动范围以及特征校正系数，确定第一调整周期更新后的校正系数，具体包括：；其中，表示第一调整周期更新后的校正系数，n1表示第一调整周期的校正系数，Nr1表示理想波动范围的上限值，Nl1表示理想波动范围的下限值，/＞表示特征校正系数。8.根据权利要求3所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述根据更新后的时间周期的校正系数与历史时间段内时间周期的校正系数之间的差异情况，对时间周期进行更新，具体包括：当历史时间段后连续预设数量个待调整的时间周期的校正系数均在对应的理想波动范围内时，将所述连续预设数量个待调整的时间周期后的第一个待调整的时间周期记为目标时间周期，计算目标时间周期更新后的校正系数与特征校正系数之间的差值记为第一差值；计算目标时间周期相邻的上一个时间周期的校正系数与特征校正系数之间的差值记为第二差值；当第一差值小于或等于第二差值时，将第二差值与第一差值的比值的绝对值作为更新系数，将更新系数与时间周期的乘积作为目标时间周期对应的更新后的时间周期；当第一差值大于第二差值时，不对目标时间周期进行更新。9.根据权利要求1所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述获取时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差异，计算每个时间周期内时钟芯片内的时钟误差指标，具体包括：计算时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差值，将差值与时间周期长度的比值作为每个时间周期内时钟芯片内的时钟误差指标。10.根据权利要求1所述的一种时钟芯片内部时钟精度校正方法，其特征在于，所述根据更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正，具体包括：将更新后的待调整的时间周期的校正系数与时钟芯片内的时钟频率的乘积作为校正后的时钟频率；从调整后的第一个时间周期开始，重新获取历史时间段内的时间周期，对时钟芯片内部时钟精度进行监测校正。
说明书desc
技术领域本发明涉及数据处理技术领域，具体涉及一种时钟芯片内部时钟精度校正方法。背景技术时钟芯片是一种非常重要的电子元件，它在计算机、手机、电视等各种电子设备中都有广泛的应用。时钟芯片是一种能够生成稳定的、精确的时钟信号的电子元件。它通常由一个晶体振荡器、一个频率分频器和一个计数器组成。时钟芯片的输出信号可以用来同步各种数字电路的运行，确保它们能够以正确的速度和顺序进行操作，因此，对时钟芯片的精度要求较高，当时钟芯片存在误差时需要对其及时进行校正。现有技术通过校正寄存器进行时钟频率的校正，首先读取校正寄存器的数值，根据校正寄存器的数值和预设的校正规则计算校正量，根据校正量对时钟频率进行调整，再更新校正寄存器内缓存的校正值。传统的校正寄存器是基于一次性的校正操作，即仅根据一个校正周期内的时钟误差获取校正量，用于全局时钟校正的准确度较低。发明内容为了解决现有的校正方法用于全局时钟校正的准确度较低的技术问题，本发明的目的在于提供一种时钟芯片内部时钟精度校正方法，所采用的技术方案具体如下：获取时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差异，计算每个时间周期内时钟芯片内的时钟误差指标；根据所述时钟误差指标和标准时钟频率确定每个时间周期的校正系数；根据历史时间段内每个时间周期的校正系数，确定校正系数的理想波动范围；根据历史时间段后每个待调整的时间周期的校正系数与理想波动范围之间的差异，对理想波动范围进行调整，并更新待调整的时间周期的校正系数；根据更新后的时间周期的校正系数与历史时间段内时间周期的校正系数之间的差异情况，对时间周期进行更新；根据更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正。优选地，所述根据所述时钟误差指标和标准时钟频率确定每个时间周期的校正系数，具体包括：对于任意一个时间周期，将时间周期内时钟芯片内的时钟误差指标与标准时钟频率之间的和值作为时间周期的校正系数。优选地，所述根据历史时间段内每个时间周期的校正系数，确定校正系数的理想波动范围，具体包括：在历史时间段所有时间周期的校正系数中，将大于特征校正系数的最小的校正系数作为理想波动范围的上限值，将小于特征校正系数的最大的校正系数作为理想波动范围的下限值。优选地，所述特征校正系数的获取方法具体为：将历史时间段内所有时间周期的校正系数的均值作为特征校正系数。优选地，所述根据历史时间段后每个待调整的时间周期的校正系数与理想波动范围之间的差异，对理想波动范围进行调整，并更新待调整的时间周期的校正系数，具体包括：将在历史时间段后的第一个待调整的时间周期记为第一调整周期；当第一调整周期的校正系数的取值在理想波动范围内时，第一调整周期更新后的校正系数与更新前的校正系数的取值相等，判断第一调整周期的校正系数是否大于特征调整系数，对理想波动范围进行调整，若是，则将第一调整周期的校正系数作为第一次调整后理想波动范围的上限值；若否，则将第一调整周期的校正系数作为第一次调整后理想波动范围的下限值；当第一调整周期的校正系数的取值不在理想波动范围内时，不对理想波动范围进行调整，根据第一调整周期的校正系数、理想波动范围以及特征校正系数，确定第一调整周期更新后的校正系数。优选地，按照相同的方法对历史时间段后的每个待调整的时间周期的校正系数进行更新时，若理想波动范围进行过调整操作，则利用调整后的理想波动范围对每个待调整的时间周期的校正系数进行更新。优选地，所述根据第一调整周期的校正系数、理想波动范围以及特征校正系数，确定第一调整周期更新后的校正系数，具体包括：；其中，表示第一调整周期更新后的校正系数，n1表示第一调整周期的校正系数，Nr1表示理想波动范围的上限值，Nl1表示理想波动范围的下限值，/＞表示特征校正系数。优选地，所述根据更新后的时间周期的校正系数与历史时间段内时间周期的校正系数之间的差异情况，对时间周期进行更新，具体包括：当历史时间段后连续预设数量个待调整的时间周期的校正系数均在对应的理想波动范围内时，将所述连续预设数量个待调整的时间周期后的第一个待调整的时间周期记为目标时间周期，计算目标时间周期更新后的校正系数与特征校正系数之间的差值记为第一差值；计算目标时间周期相邻的上一个时间周期的校正系数与特征校正系数之间的差值记为第二差值；当第一差值小于或等于第二差值时，将第二差值与第一差值的比值的绝对值作为更新系数，将更新系数与时间周期的乘积作为目标时间周期对应的更新后的时间周期；当第一差值大于第二差值时，不对目标时间周期进行更新。优选地，所述获取时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差异，计算每个时间周期内时钟芯片内的时钟误差指标，具体包括：计算时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差值，将差值与时间周期长度的比值作为每个时间周期内时钟芯片内的时钟误差指标。优选地，所述根据更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正，具体包括：将更新后的待调整的时间周期的校正系数与时钟芯片内的时钟频率的乘积作为校正后的时钟频率；从调整后的第一个时间周期开始，重新获取历史时间段内的时间周期，对时钟芯片内部时钟精度进行监测校正。本发明实施例至少具有如下有益效果：本发明首先通过比较时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差异，获取每个时间周期的时钟误差指标，利用时钟误差指标反映了时钟芯片内时钟的误差发生情况，使得能够根据所述时钟误差指标和标准时钟频率确定每个时间周期的校正系数，即利用误差发生情况和标准时钟频率初步确定每个时间周期对时钟芯片进行校正的校正系数。然后，通过对历史时间段内每个时间周期的校正系数进行分析，确定校正系数的理想波动范围，即利用理想波动范围反映校正系数较为正常的取值范围。进一步的，对历史时间段后的待调整的时间周期的校正系数与理想波动范围之间的差异情况进行分析，对理想波动范围进行调整，同时更新校正系数，通过误差分析校正可能存在误差的校正系数，使得后续利用校正系数对时钟芯片进行校正的精度更高。最后，通过对校正周期进行调整，提高时钟芯片准确度的同时也减少了多次校正可能带来的计算时间损失，利用更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正，使得时钟芯片的全局时钟校正的准确度较高。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1是本发明的一种时钟芯片内部时钟精度校正方法的方法流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种时钟芯片内部时钟精度校正方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种时钟芯片内部时钟精度校正方法的具体方案。实施例：本发明的主要目的是：本发明通过计算历史时间内较大时间范围内时钟芯片内时钟频率历史误差产生速度表征值，进而计算时钟校正系数，使得后续基于历史数据对时钟运行过程的误差分析较为准确，基于时钟历史运行数据依次对每个校正周期的时钟频率进行调整，并在达到一定条件后对视频频率的动态调整中的校正周期尽可能大，减少了频繁进行校正系数的计算而带来的消耗，保证了时钟的精准度。本发明所针对的具体场景为：通过外接标准时间源，获取当前的标准时间值，将当前时钟芯片的内部时间值与标准时间值进行比较，计算出时钟芯片内部时间值与标准时间值之间的误差，获取相应的校正系数，并将其存储在时钟芯片内部的校正寄存器中；在后续的使用过程中，根据校正寄存器中存储的校正系数，对时钟芯片内部的时钟频率进行动态调整，以实现高精度的时间计量。请参阅图1，其示出了本发明一个实施例提供的一种时钟芯片内部时钟精度校正方法的方法流程图，该方法包括以下步骤：步骤一，获取时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差异，计算每个时间周期内时钟芯片内的时钟误差指标；根据所述时钟误差指标和标准时钟频率确定每个时间周期的校正系数。首先，在本实施例中，时钟芯片由一个晶体振荡器、一个频率分频器和一个计数器组成，为了能够获取时钟芯片内部时间产生的误差，需要获取一个外接标准时间源，即标准时钟。在对时钟进行校正的过程中，需要以标准时钟为基准，获取同一时间长度内时钟芯片内部时间长度，进而根据每个时间长度范围内时钟芯片内部时间与标准时钟的时间之间的差异情况，进行校正分析。在本实施例中，以一个小时为一个时间单位，以三个时间单位的时间长度作为一个时间周期，以一个时间单位为基准更新获取的时间周期，例如，以十二点为时间起始点，则十二点到十五点为第一个时间周期，十二点到十三点为第一个时间单位，则十三点到十六点为第二个时间周期，以此类推，随着时间的推移可以获得多个时间周期。同时，实施者可根据具体实施场景对时间单位和时间周期进行设置。需要说明的是，可以根据时钟芯片的实际运行情况获取较为精细的时间单位，时间单位越精细，能够读取到的时间差异也就较为精确。由于时间单位的时间长度可能较短，芯片时钟可能存在频率大小的差异导致的相位错位，相位差异会在芯片时钟运行的过程中逐渐变大，若只根据较短的时间长度内一个时间单位进行频率差异的判断，很难获得准确的差异分析结果，故在本实施例中选择多个时间单位构成的时间周期进行差异分析。时钟芯片在使用过程中产生的误差主要是由于其内部频率相较于标准频率存在较小的偏差，而较小的偏差一般需要较长的使用时间后才能更好的在时钟时间上显现出来，故需要分析多个时间周期内芯片时钟的差异情况，通过后续不断对校正系数进行修正，以获得较为准确的校正结果。基于此，获取时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差异，计算每个时间周期内时钟芯片内的时钟误差指标。具体地，计算时钟芯片内的时钟在预设的每个时间周期内时间长度与标准时钟在时间周期内的时间长度之间的差值，将差值与时间周期长度的比值作为每个时间周期内时钟芯片内的时钟误差指标。举例说明，以标准时钟为基准，在一个时间周期下，即当标准时钟从十二点到十五点时，记录时钟芯片内从十二点开始经过的时间长度，通过计算时钟芯片内的时间长度与时间周期之间的差值，表征时钟芯片内在一个时间周期内与标准时间之间的差异情况，再将该差值与时间周期的长度之间的比值作为一个周期内的时钟误差指标，表征了时钟芯片内的时间在一个时间周期内的误差产生速度，每秒产生的误差量即为芯片时钟频率与标准时间频率的偏差。需要说明的是，由于标准时钟走过的时间为标准时间，一个时间周期内标准时钟的时间长度即为一个时间周期的时间长度。在本实施例中，计算时间长度均以秒为单位进行计算。在每个时间周期内对时钟芯片内的时钟通过计算校正系数，利用校正系数对时钟频率进行校正，保证了时钟局部准确率，可以实现更加精准的时钟校正。时钟芯片内的时钟在每个时间周期对应的时钟误差指标表示了时钟芯片频率与标准时钟频率之间的差异，基于此计算调整差异的校正系数。由于标准时钟频率为1Hz，即每秒振动一次，而时钟芯片内的时钟频率存在误差，即利用每个时间周期内对应的时钟误差指标表征时钟在每秒产生的误差量，基于此根据每个时间周期内对应的时钟误差指标和标准时钟频率确定每个时间周期的校正系数。具体地，对于任意一个时间周期，将时间周期内时钟芯片内的时钟误差指标与标准时钟频率之间的和值作为时间周期的校正系数。当时钟误差指标的取值大于0时，时钟误差指标的取值越大，说明时钟芯片内部的时间与标准时间的差异越大，且在相同的时间周期，时钟芯片内的时钟与标准时钟相比走的时间越长，说明时钟芯片的频率越慢，故利用校正系数对时钟芯片频率进行调整，能够使得调整后的频率相对变快，以达到校正的目的。当时钟误差指标的取值小于0时，时钟误差指标的取值越小，说明时钟芯片内部的时间与标准时间的差异越大，且在相同的时间周期，时钟芯片内的时钟与标准时钟相比走的时间越短，说明时钟芯片的频率越快，故利用校正系数对时钟芯片频率进行调整，能够使得调整后的频率相对变慢，以达到校正的目的。步骤二，根据历史时间段内每个时间周期的校正系数，确定校正系数的理想波动范围；根据历史时间段后每个待调整的时间周期的校正系数与理想波动范围之间的差异，对理想波动范围进行调整，并更新待调整的时间周期的校正系数。由于时钟误差的程度一般较为精细，在较短的时间长度内无法准确获取误差的情况，故在本实施例中，通过观察一段时间段内误差的发生情况，对后续逐渐产生的误差进行校正。即需要获取时钟芯片内的时钟在一定时间段内包含的时间周期对应的校正系数，进而对该时间段内每个时间周期对应的校正系数的取值分布情况进行分析。在本实施例中，将历史时间段的时间长度设置为24小时，例如，从十二点开始后的24个小时的时间长度内为历史时间段，进而可以对历史时间段内包含的各个时间周期的误差情况进行分析，再从第二天的十二点开始逐个分析每个时间周期进行误差情况，进而将这些时间周期记为待调整的时间周期，具体地，将历史时间段后第一个时间周期开始的每一个时间周期记为待调整的时间周期，例如，第二天的十二点开始十二点到十五点为第一个待调整的周期，十三点到十六点为第二个待调整的时间周期，以此类推，按照时间发生的先后顺序进行误差分析。基于此，根据历史时间段内每个时间周期的校正系数，确定校正系数的理想波动范围。具体地，将历史时间段内所有时间周期的校正系数的均值作为特征校正系数。在历史时间段所有时间周期的校正系数中，将大于特征校正系数的最小的校正系数作为理想波动范围的上限值，将小于特征校正系数的最大的校正系数作为理想波动范围的下限值。在本实施例中，将历史时间段内所有时间周期的校正系数的均值作为整个历史时间段内所有校正系数的表征值，即特征校正系数表征了历史时间段内所有时间周期的误差校正程度。由于随着时间的推移，误差分析逐渐准确的情况下，对应的校正系数也会逐渐准确，进而会逐渐收敛在一定的取值范围内，故在历史时间段内将与校正系数的特征值之间的差异最小的两个时间周期的校正系数构成的数据范围作为校正系数的理想波动范围。进一步的，在对每个待调整的时间周期的校正系数进行逐个调整更新的过程中，还需要比较待调整的时间周期的校正系数与理想波动范围之间的差异情况，利用与历史时间段内特征校正系数之间的差异更小的校正系数，对理想波动范围进行更新，使得最终的理想波动范围逐渐收敛在一定的取值范围内。根据历史时间段后每个待调整的时间周期的校正系数与理想波动范围之间的差异，对理想波动范围进行调整，并更新待调整的时间周期的校正系数，具体地，将在历史时间段后的第一个待调整的时间周期记为第一调整周期，将在历史时间段后的第二个待调整的时间周期记为第二调整周期，以此类推，将需要进行调整的时间周期按照时间的先后顺序进行标记。当第一调整周期的校正系数的取值在理想波动范围内时，第一调整周期更新后的校正系数与更新前的校正系数的取值相等，判断第一调整周期的校正系数是否大于特征调整系数，对理想波动范围进行调整，若是，则将第一调整周期的校正系数作为第一次调整后理想波动范围的上限值；若否，则将第一调整周期的校正系数作为第一次调整后理想波动范围的下限值。具体地，首先判断第一调整周期的校正系数的取值是否在理想波动范围内，若在，则需要根据第一调整周期的校正系数的取值对理想波动范围进行更新，即位于理想波动范围内第一调整周期的校正系数一定会比现有的理想波动范围的上限值或者下限值更加接近特征校正系数。进一步的，通过比较第一调整周期的校正系数与特征校正系数之间的大小情况，判断是需要对理想波动范围的上限值进行更新，还是需要对理想波动范围的下限值进行更新。由于此时第一调整周期的校正系数位于理想波动范围内，说明第一调整周期的校正系数处于一个较为正常的范围内，故此时不对第一调整周期的校正系数进行调整更新，仅对理想波动范围进行调整更新。当第一调整周期的校正系数的取值不在理想波动范围内时，不对理想波动范围进行调整，根据第一调整周期的校正系数、理想波动范围以及特征校正系数，确定第一调整周期更新后的校正系数。具体地，判断第一调整周期的校正系数的取值不在理想波动范围内时，说明不存在新的校正系数与特征校正系数之间的差异更小，故此时不需要对理想波动范围进行调整更新。进一步的，由于第一调整周期的校正系数不在理想波动范围内，说明第一调整周期的校正系数可能存在异常情况，故需要对第一调整周期的校正系数进行调整更新，进而通过分析第一调整周期的校正系数距离理想波动范围的上限值或者下限值之间的差异大小情况，对第一调整周期的校正系数进行调整更新。在本实施例中，以第一调整周期为例进行说明，则第一调整周期更新后的校正系数的计算公式可以表示为：；其中，表示第一调整周期更新后的校正系数，n1表示第一调整周期的校正系数，即第一调整周期更新前的校正系数，Nr0表示理想波动范围的上限值，Nl0表示理想波动范围的下限值，/＞表示特征校正系数。需要说明的是，在对第一调整周期的校正系数进行更新的过程中，理想波动范围并未被调整更新过，故在计算第一调整周期更新后的校正系数的过程中所使用的理想波动范围是未进行更新的理想波动范围。当n1＞Nr0时，说明第一调整周期的校正系数的取值较大，故需要对第一调整周期的校正系数进行删减，使其取值较为接近理想波动范围，即n1-Nr0表示第一调整周期的校正系数与理想波动范围的上限值之间的差异，该差异越大，对第一调整周期的校正系数的调整程度越大，表示差异占比，/＞表示对第一调整周期的校正系数n1进行删减的调整量。当n1＜Nl0时，说明第一调整周期的校正系数的取值较小，故需要对第一调整周期的校正系数进行增加，使其取值较为接近理想波动范围，Nl0-n1表示理想波动范围的下限值与第一调整周期的校正系数之间的差异，该差异越大，对第一调整周期的校正系数的调整程度越大，表示差异占比，/＞表示对第一调整周期的校正系数n1进行增加的调整量。在历史时间段后，每一个待调整的时间周期的校正系数的更新方法均与第一调整周期的校正系数的更新方法相同，需要说明的是，按照相同的方法对历史时间段后的每个待调整的时间周期的校正系数进行更新时，若理想波动范围进行过调整操作，则利用调整后的理想波动范围对每个待调整的时间周期的校正系数进行更新。例如，若第一调整周期的校正系数取值在理想波动范围内，则需要根据第一调整周期的校正系数的取值对理想波动范围进行调整更新，假设第一调整周期的校正系数大于特征调整系数，则将第一调整周期的校正系数作为第一次调整后理想波动范围的上限值，记为Nr1，进而第一次调整后的理想波动范围可以表示为。进一步的，判断第二调整周期的校正系数是否需要进行更新，首先，判断第二调整周期的校正系数是否在第一次调整后的理想波动范围内，然后判断是否需要对第二调整周期的校正系数进行更新，并判断是否需要对理想波动范围进行调整。需要说明的是，由于芯片时钟的频率误差往往是特别小的，采用较小的校正周期会使表现出来的时钟误差过小，难以根据有限位宽的校正寄存器进行精细的调整，而校正周期过大的话会导致时钟短时间内出现较大的误差，虽然降低了校正系数的计算难度，但也会使时钟周期性的出现读数不准确的情况，导致时钟读数的失真。故在进行时钟校正时，计算校正系数使通过分析历史多个校正周期中的误差大小获取芯片时钟产生的平均误差情况，由此计算时钟频率的校正系数，并在后续校正周期中对校正系数进行修正，使校正系数逐渐收敛以获取更加精准的校正系数。步骤三，根据更新后的时间周期的校正系数与历史时间段内时间周期的校正系数之间的差异情况，对时间周期进行更新；根据更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正。在获取到历史时间段后每个待调整的时间周期的校正系数后，可以利用校正系数对对应的时间周期内时钟芯片频率进行调节，需要说明的是，对于每个待调整的时间周期的校正系数，可能是经过更新后的也可能是未经过更新后的。当待调整的时间周期的校正系数的取值位于对应的理想波动范围内时，说明校正系数在该时间周期内处于较为正常的范围内，进而说明在该时间周期内时钟芯片的误差波动较小。当在历史时间段后连续出现多个待调整的时间周期的校正系数均处于较为正常的范围内时，在对待调整的时间周期的误差进行调节的同时，可以考虑将观察误差发生情况的校正周期适当调大，使得在更长的时间长度内，能够更加精准的获取到时钟芯片误差的发生情况。基于此，根据更新后的时间周期的校正系数与历史时间段内时间周期的校正系数之间的差异情况，对时间周期进行更新。具体地，当历史时间段后连续预设数量个待调整的时间周期的校正系数均在对应的理想波动范围内时，将所述连续预设数量个待调整的时间周期后的第一个待调整的时间周期记为目标时间周期。在本实施例中，预设数量的取值为3，即在历史时间段后连续3个待调整的时间周期的校正系数均在对应的理想波动范围内时，假设在历史时间段后第一个、第二个和第三个待调整的时间周期的校正系数均在对应的理想波动范围内，则将历史时间段后第四个待调整的时间周期记为目标时间周期，进而可以根据目标时间周期的校正系数进行分析，判断是否需要从目标时间周期开始对时间周期的长度进行调整。需要说明的是，在进行时间周期长度的调整分析时，每个待调整的时间周期的校正系数均为更新后的校正系数，但是，更新后的校正系数可能是与更新前的校正系数的取值相等。计算目标时间周期更新后的校正系数与特征校正系数之间的差值记为第一差值；计算目标时间周期相邻的上一个时间周期的校正系数与特征校正系数之间的差值记为第二差值；当第一差值小于或等于第二差值时，将第二差值与第一差值的比值的绝对值作为更新系数，将更新系数与时间周期的乘积作为目标时间周期的更新后的时间周期。进一步的，当第一差值大于第二差值时，不对时间周期的时间长度进行调整，进而可以对目标时间周期继续进行判断其校正系数是否在对应的理想波动范围内，若是，则对目标时间周期下一个待调整的时间周期进行判断是否需要对时间周期的时间长度进行调整。在本实施例中，将历史时间段后第t个待调整的时间周期作为目标时间周期，则当第一差值小于或等于第二差值时，目标时间周期的更新后的时间周期的计算公式可以表示为：；其中，表示第t个待调整的时间周期的更新后的时间周期，/＞表示第t个待调整的时间周期更新后的校正系数，nt-1表示第t-1个待调整的时间周期的校正系数，/＞表示特征校正系数，/＞为第一差值，/＞为第二差值，/＞为更新系数。第一差值表示目标时间周期的校正系数与特征校正系数之间的差异情况，第二差值表示与目标时间周期相邻的上一个时间周期的校正系数与特征校正系数之间的差异情况。由于在目标时间周期之前，连续预设数量个的待调整的时间周期的校正系数均在对应的理想波动范围内，故通过比较目标时间周期对应的校正系数的差异情况与其相邻上一个时间周期对应的校正系数的差异情况，判断是否需要对当前的目标时间周期的时间长度进行调整更新。当时，说明目标时间周期更新后的校正系数对应的差异较小，进而说明目标时间周期更新后的校正系数的精度较高，故可以通过增大时间周期的时间长度，经过更长时间的校正周期对时钟芯片的误差发生情况进行分析，使得时钟芯片能够在更大的校正周期内进行校正，且校正精度较高。当时，即第一差值大于第二差值，说明目标时间周期更新后的校正系数对应的差异较大，故不需要对时间周期的时间长度进行调大处理，即仍采用原始的时间周期进行误差分析，进一步的逐个判断待调整的时间周期是否需要进行时间长度的更新操作。通过对校正周期进行调整，使时钟芯片的校正可以在更大的周期内进行，提高时钟芯片准确度的同时也减少了多次校正可能带来的计算时间损失。最后，根据更新后的时间周期和更新后的待调整的时间周期的校正系数对时钟芯片内部时钟进行校正。具体地，将更新后的待调整的时间周期的校正系数与时钟芯片内的时钟频率的乘积作为校正后的时钟频率。本发明能够在经过较长一段时间后时钟芯片出现较为稳定的误差时，根据更新后的校正系数进行时钟频率的校正操作，使得时钟校正的精度较高，从而能够在较长的时钟运行时间后依然保证时钟较高的准确度。从调整后的第一个时间周期开始，重新获取历史时间段内的时间周期，对时钟芯片内部时钟精度进行监测校正。例如，在历史时间段后，若对第t个待调整的时间周期进行了调整，则第t+1待调整的时间周期即为调整后的第一个时间周期，即从第t+1待调整的时间周期开始，重新获取一个历史时间段，在本实施例中，历史时间段的长度为24小时，即从第t+1待调整的时间周期的初始时间点开始经过24小时的时间段为历史时间段，进而可以按照步骤一和步骤二、步骤三的方法对时钟芯片内部的时钟精度进行监测校正。以上所述实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围，均应包含在本申请的保护范围之内。
