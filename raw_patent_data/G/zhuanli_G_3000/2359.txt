标题title
基于深度算子网络的电离层电子总含量的四维估计方法
摘要abst
本发明公开了一种基于深度算子网络的电离层电子总含量的四维估计方法。其包括：确定反演STEC区域以及可利用的接收机站点分布；提取选择的接收机‑卫星对应的历史STEC观测数据；构建历史STEC仿真数据集；将历史观测数据和仿真数据集划分成训练集、验证集；构建DeepONet‑TEC模型，训练获得最优估计模型；确定待估STEC对应的射线信息；利用最优估计模型获得对应的估计值STEC。本发明通过构建一个统一的电离层四维估计框架，融合实测数据、仿真数据、含有物理信息的基函数，根据选择模式提供STEC估计值。该四维估计框架能够对给定区域任意射线上STEC估计，具有推广应用前景。
权利要求书clms
1.一种基于深度算子网络的电离层电子总含量的四维估计方法，其特征在于，其是导航信号、统计模型以及机器学习结合的方法，分为两个部分：离线步骤和在线步骤；离线步骤包括：确定反演STEC的区域以及利用的接收机站点分布；利用定位算法提取选择的接收机-卫星对应的历史STEC观测数据；利用电离层物理模型以及经验模型构建历史STEC仿真数据集；将历史STEC观测数据以及历史STEC仿真数据集划分成训练集、验证集；构建DeepONet-TEC模型，DeepONet-TEC模型利用训练集和验证集训练和评估，获得最优估计模型；在线步骤包括：构建用户数据，即确定待估STEC对应的射线信息；利用最优估计模型获得对应的STEC估计值；其中：步骤中，构建DeepONet-TEC模型的步骤如下：①构建权重函数用于描述两个向量之间的关系f1＝||xi-xj||2其中xi表示第i条射线对应的卫星和站点在ECEF坐标系中的坐标以及时间的正余弦变化获得的编码值，共8维数据，xj表示第j条射线对应的卫星和站点在ECEF坐标系中的坐标以及时间的正余弦变换获得的编码值，f1表示xi和xj之间距离的平方，为中间函数，σ和τ表示模型函数的超参数，其下角标为对应的函数名称，fout表示最终的权重函数；②构建映射函数用于获得STEC初步待估计值u＝fout+λI)-1S其中u为构建的映射函数，S表示已知射线集合X对应STEC观测值，λ表示正则化超参数，I表示单位矩阵，Xi表示待估计STEC对应的射线集合；③利用公式在历史STEC观测数据和历史STEC仿真数据集上获得不同的映射函数u1，u2，其中表示任意输入；④利用Sobol准随机采样方式，在给定的空间中获得m条均匀分布的射线，其中xm表示第m条射线的路径信息；⑤利用u1，u2获得初步估计值、；⑥基于仿真数据STEC数据，利用本征正交分解POD提取出数据中的基函数fbase1；⑦选取电离层物理模型以及经验模型中的核心函数，构建基函数fbase2，并构建物理网络学习fbase2中的超参数；⑧构建噪声估计网络，估计射线路径上的伪距中噪声fnoise；⑨构建DeepONet-TEC模型框架，通过构建神经网络近似获得函数g和f，从而构建估计函数G：使其能够提供真实的STEC估计值，其中θ为DeepONet-TEC模型的超参数。2.根据权利要求1所述的基于深度算子网络的电离层电子总含量的四维估计方法，其特征在于，步骤中，采用精密单点定位算法结合精密的轨道、钟差提取选择的接收机-卫星对应的历史STEC观测数据，计算周边站点和用户站的STEC。3.根据权利要求1所述的基于深度算子网络的电离层电子总含量的四维估计方法，其特征在于，步骤利用电离层物理模型以及经验模型构建历史STEC仿真数据集，具体如下：①从精密星历中确定当前时刻的卫星坐标；②利用NeQuick2或IRI2016经验模型根据接收机站点和卫星坐标确定STEC值。4.根据权利要求1所述的基于深度算子网络的电离层电子总含量的四维估计方法，其特征在于，步骤将历史观测数据和仿真数据划分成训练集、验证集，具体如下：①将历史TEC观测数据中接收机站点、卫星坐标以及时间组成7维输入特征数据，将STEC观测数据作为标签，构成数据集A；②将历史TEC仿真数据中的接收机站点、卫星坐标以及时间组成7维输入特征数据，将STEC仿真数据作为标签，构成数据集B；③对数据集A、B中的时间进行正余弦编码，对接收机站点和卫星坐标进行标准正态化处理；④对数据集A进行随机打乱，并将其中80％用于训练，20％用于验证。5.根据权利要求1所述的基于深度算子网络的电离层电子总含量的四维估计方法，其特征在于，步骤中，DeepONet-TEC模型的损失函数由两部分组成，一部分是利用TEC标签进行约束，另一部分是利用观测方程进行约束：loss＝loss1+λ·loss2其中p表示射线xi上的伪距观测值，si表示射线xi上STEC观测值，λ为超参数。6.根据权利要求1所述的基于深度算子网络的电离层电子总含量的四维估计方法，其特征在于，步骤中，DeepONet-TEC模型训练时，采用Adam优化器。7.根据权利要求1所述的基于深度算子网络的电离层电子总含量的四维估计方法，其特征在于，步骤中，待估STEC对应的射线信息包括卫星坐标、接收机坐标和时间。
说明书desc
技术领域本发明属于导航技术领域，具体涉及一种基于深度算子网络的电离层电子总含量的四维估计方法。背景技术电离层通常指距地表60km-1000km的部分大气层，是日地空间的重要组成部分。由于受到太阳辐射以及地磁活动等外部因素影响，电离层存在大量自由移动的中性成分以及离子，性质复杂多变。由于电磁波在电离层中传播时会产生群延迟、法拉第旋转等效应，对长距离通信、高精度定位等领域产生重大影响。比如在实际应用中，电离层导致的定位误差在垂直方向为2-10m，在斜向方向上甚至超过100m。同时在精密单点定位算法中存在未知量个数大于方程个数问题，是一个欠定问题，通常采用最小二乘法或者卡尔曼滤波算法对方程进行求解。尽管采用有上述方法以及利用现有的精密轨道以及钟差等产品，由于电离层性质复杂，较难估计，使得PPP算法求解误差收敛较慢，精度较低。对于用户来说，定位算法需要做到收敛时间快，定位精度高。要想同时做到上面两点，需要降低方程的未知个数，同时需要有较为精确的电离层产品。而现有的精确产品大多存在时延，因此我们需要对电离层改正量进行时空估计。现有的电离层改正估计产品，大多都是从垂直方向的电子浓度总含量VTEC出发建立区域或者全球的电离层VTEC模型得到VTEC图，主要的方法有：多项式拟合，球谐函数拟合，神经网络插值等。但是上述方法，都是基于VTEC数据进行操作，由于电离层不是严格服从单层薄壳假设，在从斜向电子总含量到VTEC，从VTEC再到STEC转换，存在精度损失。STEC指的是站点和卫星连线上的电子密度积分。因此直接对STEC进行插值，直接计算用户处的STEC将很大程度上提高用户的定位精度。同时，现有的方法大多停留在空间维度插值，在实现时间上预测时还需要利用神经网络等方法对现有方法进行扩展。缺少一个统一的框架实现STEC四维的估计，即利用过去的STEC观测值构建模型对当前及未来时刻当前空间任意射线的STEC进行估计。发明内容针对现有技术的不足，本发明的目的是提出一种基于深度算子网络的电离层电子总含量的四维估计方法，它构建一个统一的电离层四维估计框架，融合实测数据、仿真数据、含有物理信息的基函数，能够以统一的方式获得未来时刻给定空间中任意射线上的STEC估计值，具有推广应用前景。本发明的技术方案具体介绍如下。一种基于深度算子网络的电离层电子总含量的四维估计方法，其是导航信号、统计模型以及机器学习结合的方法，分为两个部分：离线步骤和在线步骤；离线步骤包括：确定反演STEC的区域以及利用的接收机站点分布；利用定位算法提取选择的接收机-卫星对应的历史STEC观测数据；利用电离层物理模型以及经验模型构建历史STEC仿真数据集；将历史STEC观测数据以及历史STEC仿真数据集划分成训练集、验证集；构建DeepONet-TEC模型，DeepONet-TEC模型利用训练集和验证集训练和评估，获得最优估计模型；在线步骤包括：构建用户数据，即确定待估STEC对应的射线信息；利用最优估计模型获得对应的STEC估计值；其中：步骤中，构建DeepONet-TEC模型的步骤如下：①构建权重函数用于描述两个向量之间的关系f1＝||xi-xj||2其中xi表示第i条射线对应的卫星和站点在ECEF坐标系中的坐标以及时间的正余弦变化获得的编码值，共8维数据，xj表示第j条射线对应的卫星和站点在ECEF坐标系中的坐标以及时间的正余弦变换获得的编码值。f1表示xi和xj之间距离的平方，为中间函数。σ和τ表示模型函数的超参数，其下角标为对应的函数名称。fout表示最终的权重函数；；②构建映射函数用于获得STEC初步待估计值u＝fout+λI)-1S其中u为构建的映射函数，S表示已知射线集合X对应STEC观测值，λ表示正则化超参数，I表示单位矩阵，Xi表示待估计STEC对应的射线集合；③利用公式在历史STEC观测数据和历史STEC仿真数据集上获得不同的映射函数u1，u2，其中表示任意输入；④利用Sobol准随机采样方式，在给定的空间中获得m条均匀分布的射线，其中xm表示第m条射线的路径信息；⑤利用u1，u2获得初步估计值、；⑥基于仿真数据STEC数据，利用本征正交分解POD提取出数据中的基函数fbase1；⑦选取电离层物理模型以及经验模型中的核心函数，构建基函数fbase2，并构建物理网络学习fbase2中的超参数；⑧构建噪声估计网络，估计射线路径上的伪距中噪声fnoise；⑨构建DeepONet-TEC模型框架，通过构建神经网络近似获得函数g和f，从而构建估计函数G：使其能够提供真实的STEC估计值，其中θ为DeepONet-TEC模型的超参数。上述步骤中，根据给定的区域，选择的站点尽可能的均匀分布在选择的区域内。上述步骤中，采用精密单点定位算法PPP提取选择的接收机-卫星对应的历史STEC观测数据，并将提取的STEC数据以TECU为单位。上述步骤中，利用电离层物理模型以及经验模型构建历史TEC仿真数据集是为了弥补观测数据的稀疏性，能够保证在获得m条射线上的TEC估计值时满足内插性质。上述步骤中，将历史观测数据以及仿真数据集划分成训练集、验证集。采用8:2方式进行划分，但是不仅限于该划分比例。上述步骤中，构建DeepONet-TEC模型，其中利用全连接网络构建支网络和主网络、物理网络、以及噪声估计网络。但是不仅限于全连接网络。和现有技术相比，本发明的有益效果在于：本发明提供一个统一的框架实现STEC四维的估计，其利用过去的STEC观测值构建模型，对输入当前及未来时刻当天空间任意射线的起始坐标和时刻，本发明构建的模型都能给出高精度的该射线上的STEC估计值。和现有方法相比，本发明充分利用了仿真数据和物理模型的信息，以及网络对函数的万能逼近能力，构建的模型能够有效逼近空间中STEC真实分布的函数，从而能够对当前以及未来空间中的射线进行估计。其中仿真数据和物理信息保证了模型解空间的分布，能够有效弥补实测数据中射线分布不均匀问题，同时保证解空间服务一定的物理规律。此外噪声网络的估计，以及观测方程的约束，能够提高模型对噪声的容忍能力。附图说明图1：本发明的基于深度算子网络的电离层电子总含量的四维估计方法的流程图。图2：本发明的DeepONet-TEC模型示意图。图3：本发明方法在中国云南区域以及北美局部区域的仿真STEC预测结果。具体实施方式下面结合附图对本发明的实施例作详细说明。本实施例在以本发明技术方案为前提下进行实施，给出了详细的实施方式和具体的操作过程，但本发明的保护范围不限于下述的实施例。本实例采用的NeQuick2经验模型构建的仿真数据。由于构建时采用和实际相同分布的站点和卫星坐标，因此仿真数据能够体现实际的部分特性。图1是本发明的算法流程图，分为两个部分：离线和在线。其中离线步骤为：确定反演STEC的区域以及可利用的接收机站点分布；利用定位算法提取选择的接收机-卫星对应的历史STEC观测数据；利用电离层物理模型以及经验模型构建历史STEC仿真数据集；将历史观测数据以及仿真数据集划分成训练集、验证集；构建DeepONet-TEC模型，并利用训练集和验证集训练和评估模型获得最优估计模型。在线步骤为：构建用户数据，即确定待估STEC对应的射线信息；利用最优估计模型获得对应的估计值STEC。上述步骤利用定位算法提取选择的接收机-卫星对应的历史STEC观测数据。即采用精密单点定位算法结合精密的轨道、钟差等产品计算周边站点和用户站的STEC，其计算如公式-所示：其中：上标Q表示当前系统，s表示Q导航系统中的第s颗卫星；下标r表示第r个接收机，j表示当前频段；其中P表示伪距观测量；表示载波观测量；ρ表示卫星和接收机的几何距离；c表示光速；dt表示钟差；ZWD表示天顶对流层延迟量，Mw表示对流程转为斜向的比例因子；γ表示电离层延迟量的频率比例因子，I表示电离层延迟量，d表示伪距硬件延迟，b表示载波相位硬件延迟；N表示载波相位模糊度；λ表示载波相位波长；ε，ξ分别表示伪距和载波相位其他误差；DCB表示码间偏差。上述步骤利用电离层物理模型以及经验模型构建历史STEC仿真数据集，具体如下：①从精密星历中确定当前时刻的卫星坐标②利用NeQuick2/IRI2016等经验模型根据接收机站点和卫星坐标确定STEC值。上述步骤将历史观测数据和仿真数据划分成训练集、验证集，具体内容如下：①将历史TEC观测数据中接收机站点、卫星坐标以及时间组成7维输入特征数据，将STEC观测数据作为标签，构成数据集A；②将历史TEC仿真数据中的接收机站点、卫星坐标以及时间组成7维输入特征数据，将STEC仿真数据作为标签，构成数据集B；③对数据集A、B中的时间进行正余弦编码，对接收机站点和卫星坐标进行标准正态化处理；④对数据集A进行随机打乱，并将其中80％用于训练，20％用于验证，分别命名为：Atrain,Avalidation。其中数据集A除了用于构建映射函数u，还用于训练模型，而数据集B仅用于构建映射函数u。上述步骤构建DeepONet-TEC模型，并利用训练集和验证集训练和评估模型获得最优估计模型。其中构建DeepONet-TEC模型步骤如下：①构建权重函数用于描述两个向量之间的关系f1＝||xi-xj||2其中xi以及表示第i条射线对应的卫星和站点在ECEF坐标中的坐标以及时间的正余弦编码，共8维数据，σ和τ分别表示模型函数的超参数，使用不同的下标来区别，fout表示最终的权重函数。②构建映射函数用于获得STEC初步待估计值u＝fout+λI)-1S其中u为构建的映射函数，S表示已知射线集合X对应STEC观测值，λ表示正则化超参数，I表示单位矩阵。Xi表示待估计STEC对应的射线集合。③利用公式在数据集A和B上获得不同的映射函数u1，u2，其中表示任意输入。④利用Sobol准随机采样方式，在给定的空间中获得m条均匀分布的射线，其中xm表示第m条射线的路径信息。⑤利用u1，u2获得初步估计值、。⑥提取仿真数据中的基函数。基于NeQuick2/IRI2016等经验模型提供的仿真数据STEC数据，利用本征正交分解提取出数据中的基函数fbase1。⑦选取经验模型以及物理模型中的核心函数，构建基函数fbase2，并构建物理网络进行学习fbase2中的超参数。⑧构建噪声估计模块。搭建神经网络，不仅限于全连接网络，估计射线路径上的伪距中噪声fnoise。⑨构建DeepONet-TEC模型框架。通过构建神经网络近似获得函数g和f，从而构建估计函数G使其能够提供真实的STEC估计值。其中θ为DeepONet-TEC模型的超参数⑩构建DeepONet-TEC损失函数。DeepONet-TEC损失函数有两部分组成，一部分是利用TEC标签进行约束，另一部分是利用观测方程进行约束。loss＝loss1+λ·loss2其中p表示射线xi上的伪距观测值，si表示射线xi上STEC观测值，λ为超参数。上述DeepONet-TEC模型训练步骤如下：①在数据集A_t上采用Adam优化器优化损失函数，获得模型1②在数据集A_v上评估模型1的性能，如果模型1在数据集Atrain和Avalidation上的性能相近，且loss低于一定的阈值，认为当前模型1就是所要构建的最优估计模型。上述步骤中，构建用户数据，即确定待估STEC对应的射线信息，具体步骤如下：①采用标准单点定位获得用户的初步位置②从精密星历中获得当前卫星的位置③将用户和卫星的坐标、以及时刻按照步骤5中的方式进行处理。上述步骤利用最优估计模型获得对应的STEC估计值。利用步骤中得到的最优估计模型，在用户数据中得到STEC估计值其中θ*通过训练得到的最优参数。结合实例说明本发明的具体实施过程如下：步骤1：确定反演STEC的区域以及可利用的接收机站点分布。在本实例中采用采用的中国云南区域陆态网站点分布，以及北美连续运营参考站部分站点。步骤2：利用定位算法提取选择的接收机-卫星对应的历史STEC观测数据。下载导航观测等产品，采用定位算法提取2021年1月1日-2021年1月5日的STEC观测值。步骤3：利用电离层物理模型以及经验模型构建历史STEC仿真数据集。利用实际站点坐标、以及卫星坐标和时间，采用NeQuick2模型构建2021年1月2021年1月1日-2021年1月5日的STEC仿真值。步骤4：将历史观测数据以及仿真数据集划分成训练集、验证集。步骤5：构建DeepONet-TEC模型，并利用训练集和验证集训练和评估模型获得最优估计模型。步骤6：构建用户数据，即确定待估STEC对应的射线信息。即采用确定站点的坐标，卫星的坐标，以及待估的时刻。利用精密星历确定2021年1月5日的卫星坐标。步骤7：利用最优估计模型获得对应的估计值STEC，如图3所示。从图3中可以发现构建的四维模型在中国云南区域和北美局部表现良好，均方根误差分别为1.4624TECU和0.4936TECU，相关系数R2分别达到0.9900和0.9946。由于构建的模型仅利用过去4天的数据进行训练，同时测试站站点的从未在训练集中出现，因此结果可以表明构建的四维模型空间插值和时间预测能力，能够对于当前空间给定射线进行STEC估计。
