标题title
一种LED显示系统电源自适应控制方法
摘要abst
本发明公开了一种LED显示系统电源自适应控制方法，包括获取LED驱动芯片的端口电压信息；根据预设的端口电压标准值判断获取的端口电压信息的相对高低情况，若存在有相对高低的情况，则相应产生一用于调节端口电压的参考电流；LED驱动芯片将产生的参考电流反馈至电源管理系统的FB端口对电源管理系统的输出电压进行调整，从而调整LED驱动芯片的端口电压值。本发明只需在LED驱动芯片上增加一个电流输出端口连接电源管理系统的反馈控制端口，通过LED驱动芯片对产生的参考电流的控制调节，即可实现自适应的LED驱动芯片的功耗管理，使得LED显示控制系统更加简单，控制功能更加完善，成本更低，功耗管理效果更优。
权利要求书clms
1.一种LED显示系统电源自适应控制方法，其特征在于，包括以下步骤：S10、获取LED驱动芯片的端口电压信息；S20、根据预设的端口电压标准值判断获取的端口电压信息的相对高低情况，若存在有相对高低的情况，则相应产生一用于调节端口电压的参考电流；S30、LED驱动芯片将产生的参考电流反馈至电源管理系统的FB端口对电源管理系统的输出电压进行调整，从而调整LED驱动芯片的端口电压值；其中，当获取的端口电压存在低于端口电压标准值的情况时，控制反馈的参考电流流出电源管理系统的FB端口，以提高电源管理系统的输出电压VLED；当获取的端口电压均不低于端口电压标准值且存在高于端口电压标准值的情况时，控制反馈的参考电流流入电源管理系统的FB端口，以降低电源管理系统的输出电压VLED。2.根据权利要求1所述的LED显示系统电源自适应控制方法，其特征在于，所述LED驱动芯片配置有一与电源管理系统的FB端口连接的电流调节端IFB，用于传输反馈的参考电流。3.根据权利要求2所述的LED显示系统电源自适应控制方法，其特征在于，所述步骤S10中LED驱动芯片根据来自控制器的检测指令，通过逻辑处理电路使能检测电路在输出PWM电流时逐个扫描行检测输出端口的电压，基于预设的端口电压标准值获得端口电压的检测结果，并传输至逻辑处理电路处理和暂存，其中检测电路根据端口电压标准值判断检测到的输出端口电压的相对高低情况得到端口电压的检测结果。4.根据权利要求3所述的LED显示系统电源自适应控制方法，其特征在于，所述步骤S20中LED驱动芯片配置的逻辑处理电路处理各输出端口的电压检测结果，若存在有输出端口的电压检测结果偏低的情况，则控制电流计数器进行加1操作，若没有输出端口的电压检测结果偏低且存在有输出端口的电压检测结果偏高的情况，则控制电流计数器进行减1操作。5.根据权利要求4所述的LED显示系统电源自适应控制方法，其特征在于，所述步骤S20中LED驱动芯片根据电流计数器的当前数值向配置的参考电流选择电路输出控制信号，使参考电流选择电路产生与电流计数器当前数值对应大小和方向的参考电流，其中，当电流计数器当前数值为正时，参考电流的方向为从电流调节端IFB流入，当电流计数器当前数值为负时，参考电流的方向为从电流调节端IFB流出。6.根据权利要求5所述的LED显示系统电源自适应控制方法，其特征在于，所述参考电流选择电路内配置有两组具有倍数关系的参考电流源Ib、2*Ib、…、2n*Ib，以及用于分别控制一组中每个参考电流源的开关场效应管P3、P4、…、Pn+3和用于分别控制另一组中每个参考电流源的开关场效应管N3、N4、…、Nn+3，其中n为一组中参考电流源的数量，开关场效应管N3、N4、…、Nn+3使相应的参考电流源形成从电流调节端IFB流入的参考电流，开关场效应管P3、P4、…、Pn+3使相应的参考电流源形成从电流调节端IFB流出的参考电流。7.根据权利要求3-6任一项所述的LED显示系统电源自适应控制方法，其特征在于，当所述LED显示系统配置有多颗LED驱动芯片时，每颗LED驱动芯片之间级联连接，第一级LED驱动芯片的电流调节端IFB与电源管理系统的FB端口连接，由控制器分别为各LED驱动芯片配置扫描初始值和扫描行数，后级LED驱动芯片的输出端口的电压检测结果通过数据下传和回传电路回传至前级LED驱动芯片的数据寄存器，直至第一级LED驱动芯片获得所有输出端口的电压检测结果。8.根据权利要求7所述的LED显示系统电源自适应控制方法，其特征在于，当所述LED显示系统配置有多个电源管理系统时，电源管理系统的数量不超过LED驱动芯片的数量，不同电源管理系统为不同扫描行的LED阵列供电，不同LED驱动芯片的电流调节端IFB连接不同的电源管理系统的FB端口，各LED驱动芯片的输出端口的电压检测结果通过数据下传和回传电路下传或回传给其他LED驱动芯片，直至所有连接电源管理系统FB端口的LED驱动芯片均获得所有输出端口的电压检测结果，各LED驱动芯片分别为其对应的电源管理系统反馈参考电流。
说明书desc
技术领域本发明涉及LED驱动集成电路技术领域，具体地讲，是涉及一种LED显示系统电源自适应控制方法。背景技术LED具有寿命长、发光效率高、亮度高、快速开关、高动态对比显示、色域广等优点被广泛应用在显示领域。近年来LED显示得到快速发展，由原来单色显示，到彩色显示再到小间距彩色显示，使得LED显示逐渐由远距离观看向近距离观看发展，最近mini LED还被用来做液晶显示的矩阵式背光驱动。LED间距越来越小，LED的密度随之越来越高，驱动芯片的需求也越来越多，高密度的LED也要求着驱动芯片集成度更高，功耗更低。然而，LED是恒流驱动，LED电源减去LED压降，剩余的电压会落在驱动芯片端口上，如果剩余的电压较大，则会使LED驱动芯片产生较大的损耗。特别是使用mini LED做液晶显示的矩阵式背光时，由于LED驱动芯片集成度很高，通常被动矩阵式LED驱动芯片单颗芯片集成32个输出通道或48个输出通道，如果驱动芯片输出端口的剩余电压较大，则驱动芯片会产生较大功耗，导致功耗浪费和驱动芯片发热严重。如图1所示为现有技术中无电源自适应控制的传统LED显示系统的电路示意图，电源管理系统将交流或直流输入电压转换为稳定的直流输出电压VLED，经过行扫描驱动电路将电压VLED分别输送给LED阵列各个扫描行，再配合LED驱动芯片O1-On输出端口的恒流PWM驱动，即可实现LED逐行灰度点亮控制。其中LED电源电压VLED经过扫描驱动管和LED阵列的压降后，剩余压降全部落在LED驱动芯片输出端口上，导致LED驱动芯片功耗较大。申请号为202110271179.4的现有技术文献提出了一种电流驱动装置，通过增加牵引端口FDC和牵引电路，判断是否将一共同接点上的电压拉至一第一逻辑准位。这不仅需要增加牵引端口和牵引电路，其控制方案还存在不完善的缺陷，尤其是在多阵列、多驱动电路的情况下，例如第一驱动电路接到第一发光阵列和第三发光阵列中，第二驱动电路接到第二发光阵列和第四发光阵列中，但是第一驱动电路只能根据第一发光阵列来调整共同接点的逻辑准位，而不能根据第三发光阵列来调整逻辑准位，同样的第二驱动电路只能根据第四发光阵列来调整共同接点的逻辑准位，而不能根据第二发光阵列来调整逻辑准位。这会导致第二发光阵列和第三发光阵列有可能失控，或者需要人工调整介入。而且常规电源系统的共同接点的逻辑准位为一定值，由电源系统自动调整，不能额外调整。因此设计一种可以自适应控制LED显示系统电源输出以实现LED驱动芯片低功耗管理的控制方法及结构为本领域所亟需。发明内容针对上述现有技术存在的问题，本发明提供一种LED显示系统电源自适应控制方法，在不额外增加驱动芯片外围电路的基础上实现更完善的控制功能、更优的功耗管理。为了实现上述目的，本发明采用的技术方案如下：一种LED显示系统电源自适应控制方法，包括以下步骤：S10、获取LED驱动芯片的端口电压信息；S20、根据预设的端口电压标准值判断获取的端口电压信息的相对高低情况，若存在有相对高低的情况，则相应产生一用于调节端口电压的参考电流；S30、LED驱动芯片将产生的参考电流反馈至电源管理系统的FB端口对电源管理系统的输出电压进行调整，从而调整LED驱动芯片的端口电压值；其中，当获取的端口电压存在低于端口电压标准值的情况时，控制反馈的参考电流流出电源管理系统的FB端口，以提高电源管理系统的输出电压VLED；当获取的端口电压均不低于端口电压标准值且存在高于端口电压标准值的情况时，控制反馈的参考电流流入电源管理系统的FB端口，以降低电源管理系统的输出电压VLED。具体地，所述LED驱动芯片配置有一与电源管理系统的FB端口连接的电流调节端IFB，用于传输反馈的参考电流。进一步地，所述步骤S10中LED驱动芯片根据来自控制器的检测指令，通过逻辑处理电路使能检测电路在输出PWM电流时逐个扫描行检测输出端口的电压，基于预设的端口电压标准值获得端口电压的检测结果，并传输至逻辑处理电路处理和暂存，其中检测电路根据端口电压标准值判断检测到的输出端口电压的相对高低情况得到端口电压的检测结果。进一步地，所述步骤S20中LED驱动芯片配置的逻辑处理电路处理各输出端口的电压检测结果，若存在有输出端口的电压检测结果偏低的情况，则控制电流计数器进行加1操作，若没有输出端口的电压检测结果偏低且存在有输出端口的电压检测结果偏高的情况，则控制电流计数器进行减1操作。进一步地，所述步骤S20中LED驱动芯片根据电流计数器的当前数值向配置的参考电流选择电路输出控制信号，使参考电流选择电路产生与电流计数器当前数值对应大小和方向的参考电流，其中，当电流计数器当前数值为正时，参考电流的方向为从电流调节端IFB流入，当电流计数器当前数值为负时，参考电流的方向为从电流调节端IFB流出。具体地，所述参考电流选择电路内配置有两组具有倍数关系的参考电流源Ib、2*Ib、…、2n*Ib，以及用于分别控制一组中每个参考电流源的开关场效应管P3、P4、…、Pn+3和用于分别控制另一组中每个参考电流源的开关场效应管N3、N4、…、Nn+3，其中n为一组中参考电流源的数量，开关场效应管N3、N4、…、Nn+3使相应的参考电流源形成从电流调节端IFB流入的参考电流，开关场效应管P3、P4、…、Pn+3使相应的参考电流源形成从电流调节端IFB流出的参考电流。具体地，所述步骤S30中参考电流对电源管理系统的输出电压进行调整的过程为：输出电压VLED通过电源管理系统配置的定值电阻R1和R2来确定，公式为VLED=VFB*，其中VFB是电源管理系统的反馈控制端口FB的参考电源，为一定值，由电源管理系统设定，电源管理系统正常工作时流过电阻R1的电流为IR1=/R1，流过电阻R2的电流为一定值IR2= VFB/R2；当参考电流IFB反馈至端口FB时，根据吉尔霍夫电流定律有IR2=IR1+IFB，即VFB/R2=/R1+IFB，求解可得VLED= VFB* - IFB*R1；当参考电流IFB流入至端口FB时，IFB为正值，电源管理系统的输出电压VLED会降低一电压值IFB*R1，当参考电流IFB流出至端口FB时，IFB为负值，电源管理系统的输出电压VLED会升高一电压值|IFB*R1|，因此通过调整LED驱动芯片产生的参考电流的大小和方向即可实现电源管理系统的输出电压VLED的调整，从而调整LED驱动芯片输出端口O1-On的电压值。更进一步地，当所述LED显示系统配置有多颗LED驱动芯片时，每颗LED驱动芯片之间级联连接，第一级LED驱动芯片的电流调节端IFB与电源管理系统的FB端口连接，由控制器分别为各LED驱动芯片配置扫描初始值和扫描行数，后级LED驱动芯片的输出端口的电压检测结果通过数据下传和回传电路回传至前级LED驱动芯片的数据寄存器，直至第一级LED驱动芯片获得所有输出端口的电压检测结果。更进一步地，当所述LED显示系统配置有多个电源管理系统时，电源管理系统的数量不超过LED驱动芯片的数量，不同电源管理系统为不同扫描行的LED阵列供电，不同LED驱动芯片的电流调节端IFB连接不同的电源管理系统的FB端口，各LED驱动芯片的输出端口的电压检测结果通过数据下传和回传电路下传或回传给其他LED驱动芯片，直至所有连接电源管理系统FB端口的LED驱动芯片均获得所有输出端口的电压检测结果，各LED驱动芯片分别为其对应的电源管理系统反馈参考电流。与现有技术相比，本发明具有以下有益效果：本发明只需在LED驱动芯片上增加一个电流输出端口连接电源管理系统的反馈控制端口，通过LED驱动芯片对产生的参考电流的控制调节，即可实现自适应的LED驱动芯片的功耗管理，使得LED显示控制系统更加简单，控制功能更加完善，成本更低，功耗管理效果更优。尤其在大型的LED显示系统如8k显示屏上降低功耗、提高能效的效果更佳。附图说明图1为现有技术的LED显示系统的电路原理示意图。图2为本发明-实施例的实现流程示意图。图3为本发明-实施例1中LED显示系统的电源自适应控制电路示意图。图4为本发明-实施例1中的控制方法流程示意图。图5为本发明-实施例中LED驱动芯片产生参考电流的电路示意图。图6为本发明-实施例中产生参考电流的流程示意图。图7为本发明-实施例2中配置多颗LED驱动芯片的电路示意图。图8为本发明-实施例2中的控制方法流程示意图。图9为本发明-实施例3中配置多颗LED驱动芯片和多个电源管理系统的电路原理示意图。图10为本发明-实施例3中的控制方法流程示意图。具体实施方式下面结合附图和实施例对本发明作进一步说明，本发明的实施方式包括但不限于下列实施例。本发明提出的LED显示系统电源自适应控制方法，包括LED驱动芯片通过检测端口电压信息，通过设定的指令和运算处理产生对应的参考电流IFB反馈给电源管理系统，使得电源管理系统相应的升高或降低LED阵列的电源电压，实现了LED驱动芯片在工作过程中自动调整LED电源电压的功能，在保证正常恒流工作的前提下，LED驱动芯片的端口压降最小，LED驱动芯片的功耗最低，实现了LED显示系统的功耗最优化。在本发明方法匹配的LED显示系统电源自适应控制电路方面，本发明只在LED驱动芯片上增加了一电流调节端IFB与电源管理系统的反馈控制端口FB连接，外围电路简单，成本低，LED驱动芯片的该电流调节端IFB可以向FB端口流出或使FB端口向芯片流入一通过芯片设定和调整的参考电流，实现对电源管理系统的输出电压VLED的调整，从而调整LED驱动芯片的输出端口O1-On的电压值。如图2所示，该LED显示系统电源自适应控制方法，包括以下步骤：S10、获取LED驱动芯片的端口电压信息；S20、根据预设的端口电压标准值判断获取的端口电压信息的相对高低情况，若存在有相对高低的情况，则相应产生一用于调节端口电压的参考电流；S30、LED驱动芯片将产生的参考电流反馈至电源管理系统的FB端口对电源管理系统的输出电压进行调整，从而调整LED驱动芯片的端口电压值；其中，当获取的端口电压存在低于端口电压标准值的情况时，控制反馈的参考电流流出电源管理系统的FB端口，以提高电源管理系统的输出电压VLED；当获取的端口电压均不低于端口电压标准值且存在高于端口电压标准值的情况时，控制反馈的参考电流流入电源管理系统的FB端口，以降低电源管理系统的输出电压VLED。实施例1本实施例提供的LED显示系统电源自适应控制方法中LED显示系统包含一个电源管理系统和一颗LED驱动芯片，电路原理示意图如图3所示，相比图1所示的现有技术LED显示系统只在LED驱动芯片上增加一电流调节端IFB，使之与电源管理系统的FB端口连接，用于传输反馈的参考电流。LED驱动芯片产生参考电流的相关电路如图5所示，电路包含数据下传和回传电路、第二状态寄存器、数据寄存器、逻辑处理电路、检测电路、电流计数器和参考电流选择电路。其中数据下传和回传电路主要用于存在多颗LED驱动芯片时各LED驱动芯片之间传输数据，由于本实施例只涉及一颗LED驱动芯片，该数据下传和回传电路主要是处理来自控制器的指令和数据，其具体构造本实施例不做赘述。第二状态寄存器用于存储电路状态信息，数据寄存器用于存储检测数据信息，逻辑处理电路用于处理检测数据信息，检测电路用于检测LED驱动芯片的端口电压信息，电流计数器用于处理参考电流控制信息，参考电流选择电路用于产生相应的参考电流，其中参考电流选择电路具体配置为两组具有倍数关系的参考电流源Ib、2*Ib、…、2n*Ib，以及用于分别控制一组中每个参考电流源的开关场效应管P3、P4、…、Pn+3和用于分别控制另一组中每个参考电流源的开关场效应管N3、N4、…、Nn+3，其中n为一组参考电流源中参考电流源的数量，开关场效应管N3、N4、…、Nn+3使相应的参考电流源形成从电流调节端IFB流入的参考电流，开关场效应管P3、P4、…、Pn+3使相应的参考电流源形成从电流调节端IFB流出的参考电流。首先LED驱动芯片通过串行数据输入SDI端口、数据时钟信号DCLK端口和锁存信号LE端口接收来自控制器的指令和数据，分别将初始值如扫描初始值和扫描行数等参数配置和数据写入第一状态寄存器、第二状态寄存器和数据寄存器。当LED驱动芯片接收到来自控制器的检测指令后，将第二状态寄存器的检测使能值置为1，通过逻辑处理电路使能检测电路在输出PWM电流时逐个扫描行检测输出端口O1-On的电压，并将基于预设的端口电压标准值获得端口电压的检测结果送往逻辑处理电路处理和暂存。然后根据具体电路需求向LED驱动芯片发送数据下传和回传指令，LED驱动芯片接收到指令后将数据下传和回传电路中的选择器U15的输出切换为逻辑处理电路的输出，逻辑处理电路根据指令将暂存的检测结果通过选择器U15输送到串行数据输入SDI端口或串行数据输出SDO端口进行数据的回传和下传，同时接收后级芯片的回传或下传数据暂存于数据寄存器。然后逻辑处理电路根据扫描初始值和扫描行数对应的检测结果进行判断处理，输出相应的+1或-1指令到电流计数器。最后根据电流计数器的数据控制参考电流选择电路产生相应的参考电流，其中，当电流计数器为负数时，控制场效应管P3-Pn+3选择对应的参考电流输出，参考电流由IFB端口流出，当电流计数器为正数时，控制场效应管N3-Nn+3选择对应的参考电流输出，参考电流由IFB端口流入，用于调节电源管理系统的输出电压。如图4所示的控制方法过程，首先上电时由控制器发送指令和数据对LED驱动芯片参数进行配置，如配置芯片扫描初始值和扫描行数等。LED驱动芯片只对设定的扫描行的数据进行处理，如设定扫描初始值为0，扫描行数为2，则芯片只对扫描行0和扫描行1的端口电压检测数据进行运算处理，其余扫描行的数据进行回传或下传至其他LED驱动芯片，本实施例中只有一颗LED驱动芯片，通常是由其处理所有扫描行的数据。当LED驱动芯片接收到检测指令，使能检测电路在输出PWM电流时检测输出端口O1-On的电压，基于预设的端口电压标准值获得端口电压的检测结果送往逻辑处理电路处理和暂存。其中检测指令为非必须，也可以上电后一直使能检测电路进行检测。由于本实施例中无LED驱动芯片级联，则无需进行数据回传和下传处理，逻辑处理电路将检测电路的检测结果直接运算得到相应的电流计数器的值，从而得到当前LED驱动芯片的电流调节端IFB的参考电流输出。如图6所示的产生参考电流的过程，LED驱动芯片需要对扫描初始值和扫描行数进行初始值配置，以限定LED驱动芯片的控制范围。同时在存在多颗LED驱动芯片时通过芯片间的数据下传和回传通信得到后级芯片的端口电压数据，加上本芯片的端口电压检测结果数据送进逻辑处理电路处理。逻辑处理电路判断设定扫描行的所有端口的检测结果是否存在端口电压偏低，如果存在端口电压偏低，需要提高LED电源电压，则逻辑处理电路控制电流计数器进行加1操作，需要增加从电源管理系统的FB端口抽取电流或减少流进FB端口的电流，即LED驱动芯片的电流调节端IFB流进电流增大。电流计数器进行加1操作后电流计数器的值会增加或变为正数，这时电流计数器输出控制对应场效应管N3-Nn+3打开，和相应的场效应管P3-Pn+3关闭，从而流进LED驱动芯片的电流调节端IFB的电流增大，抬高LED电源电压VLED。如果没有存在端口电压偏低，且存在设定扫描行的至少一个端口电压偏高，需要降低LED电源电压，则逻辑处理电路控制电流计数器进行减1操作，需要增加流进电源管理系统的FB端口的电流或减少从FB端口抽取电流，即LED驱动芯片的电流调节端IFB流出电流加大。电流计数器进行减1操作后电流计数器的值会减小或变为负数，这是电流计数器输出控制对应场效应管P3-Pn+3打开，和相应的场效应管N3-Nn+3关闭，从而LED驱动芯片的电流调节端IFB流出的电流增大，降低LED电源电压VLED。从而实现LED显示系统的电源电压的自适应控制。参考电流对电源管理系统的输出电压进行调整的具体原理为：输出电压VLED通过电源管理系统配置的定值电阻R1和R2来确定，公式为VLED=VFB*，其中VFB是电源管理系统的反馈控制端口FB的参考电源，为一定值，由电源管理系统设定，电源管理系统正常工作时流过电阻R1的电流为IR1=/R1，流过电阻R2的电流为一定值IR2= VFB/R2；当参考电流IFB反馈至端口FB时，根据吉尔霍夫电流定律有IR2=IR1+IFB，即VFB/R2=/R1+IFB，求解可得VLED= VFB* - IFB*R1；当参考电流IFB流入至端口FB时，IFB为正值，电源管理系统的输出电压VLED会降低一电压值IFB*R1，当参考电流IFB流出至端口FB时，IFB为负值，电源管理系统的输出电压VLED会升高一电压值|IFB*R1|，因此通过调整LED驱动芯片产生的参考电流的大小和方向即可实现电源管理系统的输出电压VLED的调整，从而调整LED驱动芯片输出端口O1-On的电压值。实施例2本实施例提供的LED显示系统电源自适应控制方法中LED显示系统包含一个电源管理系统和两颗LED驱动芯片，电路原理示意图如图7所示，控制方法的过程如图8所示，并且两颗以上LED驱动芯片同理。两颗及两颗以上LED驱动芯片之间级联连接，级联时前级LED驱动芯片的串行数据输出SDO端口与后级LED驱动芯片的串行数据输入SDI端口连接，如图7中LED驱动芯片1的SDO端口连接LED驱动芯片2的SDI端口。只有第一级LED驱动芯片的电流调节端IFB连接电源管理系统的FB端口，其他级LED驱动芯片的电流调节端IFB空置，第一级LED驱动芯片的SDI端口和所有LED驱动芯片的DCLK端口和LE端口连接控制器。电源管理系统的输出电压VLED通过扫描驱动连接所有LED阵列的行，不同LED驱动芯片的输出端口O1-On连接相应LED阵列的列。在系统电路上电开始工作时，LED驱动芯片通过SDI端口、DCLK端口和LE端口的信号接收指令和数据，如配置LED驱动芯片1的扫描初始值为0、扫描行数为n，不允许数据进行回传，LED驱动芯片2的扫描初始值为0、扫描行数为0，允许数据进行回传，因此LED驱动芯片1对所有扫描行数的端口电压信息进行运算处理，而LED驱动信号2则对所有扫描行数的端口电压信息不处理，上传给LED驱动芯片1进行处理。然后LED驱动芯片接收到端口电压检测指令，所有LED驱动芯片逐行的对各自输出端口的电压进行检测，基于预设的端口电压标准值获得端口电压的检测结果，并将检测结果进行运算暂存。当有两颗以上LED驱动芯片时，需要控制器发送数据回传指令，各LED驱动芯片接收到数据回传指令后，LED驱动芯片1不回传数据，但接收后级芯片的数据回传；LED驱动芯片2对暂存的检测结果进行数据回传，若有多颗LED驱动芯片时同理；LED驱动芯片1接收后级回传过来的数据后，暂存于数据寄存器。本实施例中对图5所示的LED驱动芯片产生参考电流的相关电路中数据下传和回传电路进行说明。其中输入端口有数据时钟DCLK和锁存信号LE，可切换的输入输出端口有串行数据输入SDI和串行数据输出SDO，前级芯片的SDO端口连接后级芯片的SDI端口，第一级芯片的SDI端口连接控制器。其中U1、U2、U4和U13为施密特输入缓冲器，数据时钟DCLK和锁存信号LE经过输入缓冲器U2和U13后输出到指令解码器，指令解码器输出到第一状态寄存器，第一状态寄存器输出数据回传使能ENa、数据上传使能EN1和数据回传控制EN2。其作用分别为在芯片上电后先配置芯片的工作状态，如允许数据回传，则使能ENa为逻辑1，否则使能ENa为默认值逻辑0。并且根据需求分别设置各个芯片是否允许数据上传，如允许数据上传则使能EN1为逻辑1，否则使能EN1为默认值逻辑0。芯片在工作过程中也可以调整数据回传使能ENa和数据上传使能EN1的逻辑值。芯片在工作过程中如果接收到数据回传指令，则将数据回传控制EN2设为逻辑1，这时由于芯片数据回传使能ENa已提前为逻辑1，ENa和和EN2经过与逻辑门U8后输出逻辑1电平到二选一选择器U3，选择缓冲器U4的输出作为选择器U3的输出。同时与逻辑门U8的输出接到或逻辑门U7和反相器U6，或逻辑门U7输出高电平关闭P型场效应管P1，反相器U6输出低电平到与逻辑门U5，与逻辑门U5输出低电平关闭N型场效应管N1。即ENa和EN2都为逻辑1电平后输出管P1和N1关闭，SDO输出处于高阻态的输入状态。即ENa和EN2都为逻辑1电平后输出管P1和N1关闭，SDO输出处于高阻态的输入状态。SDO的输入经过缓冲器U4后，输出到选择器U3，再输出到D触发器D1的输入端D端，每一个DCLK脉冲到来都会将SDO的数据移入D触发器。其中D触发器D1、D2到Dn的时钟信号统一接到缓冲器U2的输出端，而输入输出依次连接起来，组成n位移位寄存器，每来一时钟信号DCLK，数据在n位移位寄存器中移动一位，如此实现将SDO上传回来的数据移入n位移位寄存器，实现后级芯片数据回传的接收功能。同时的，如果数据上传使能EN1为逻辑1电平，则与非门U9输出逻辑0电平到或逻辑门U12和反相器U10，反相器U10输出高电平到与逻辑门U11，与逻辑门U11输出低电平关闭N型场效应管N2。或逻辑门U12和与逻辑门U11都允许D触发器Dn的数据通过，如Dn的Q端输出逻辑1电平，经过反相器U14后输出逻辑0电平，则反相器U14输出到或逻辑门U12和与逻辑门U11后，使其都输出逻辑0电平，或逻辑门U12输出的逻辑0电平打开P型场效应管P2，与逻辑门U5输出的逻辑0电平关闭N型场效应管N2，如此P2将SDI拉到逻辑1电平。如Dn输出逻辑0电平，经过反相器U14后输出逻辑1电平，则或逻辑门U12和与逻辑门U11都输出逻辑1电平。或逻辑门U12输出的逻辑1电平关闭P型场效应管P2，与逻辑门U11输出的逻辑1电平打开N型场效应管N2，如此N2将SDI拉到逻辑0电平。因此ENa和EN1信号都为逻辑1电平会使能D触发器Dn的数据从SDI输出，而当前芯片的SDI接到上一级LED驱动芯片的SDO，从而实现数据向上一级芯片传输，实现数据回传功能。当不允许数据上传时，EN1为逻辑0电平，与非门U9输出逻辑1电平，使得或门U12输出高电平关闭P型场效应管P2，与门U11输出逻辑0电平关闭N型场效应管N2，这样SDI仍然处于高阻态的输入状态。但是这时选择器U3选择缓冲器U4的输入作为输出，处于接收数据回传状态，SDI经过缓冲器U1的输入无效。然后逻辑处理电路计算处理数据寄存器的数据和本芯片的端口电压检测结果，判断设定扫描行的所有端口的端口电压的检测结果相对高低情况。在电源电压调整功能使能后，LED驱动芯片1的逻辑处理电路判断出的检测结果，对电流计数器进行加法或减法处理，如设定扫描行的所有端口的检测结果存在至少一个端口电压偏低，则逻辑处理电路控制电流计数器进行加1操作，如设定扫描行没有存在端口电压偏低、且存在设定扫描行的至少一个端口电压偏高，则逻辑处理电路控制电流计数器进行减1操作。最后根据电流计数器的数据控制参考电流选择电路产生相应的参考电流，其中，当电流计数器为负数时，控制场效应管P3-Pn+3选择对应的参考电流输出，参考电流由IFB端口流出，当电流计数器为正数时，控制场效应管N3-Nn+3选择对应的参考电流输出，参考电流由IFB端口流入，用于调节电源管理系统的输出电压。实施例3本实施例提供的LED显示系统电源自适应控制方法中，当所述LED显示系统配置有多个电源管理系统时，电源管理系统的数量不超过LED驱动芯片的数量，不同电源管理系统为不同扫描行的LED阵列供电，不同LED驱动芯片的电流调节端IFB连接不同的电源管理系统的FB端口，各LED驱动芯片的输出端口的电压检测结果通过数据下传和回传电路下传或回传给其他LED驱动芯片，直至所有连接电源管理系统FB端口的LED驱动芯片均获得所有输出端口的电压检测结果，各LED驱动芯片分别为其对应的电源管理系统反馈参考电流。其所面临的情况是一个电源管理系统不能完全满足LED阵列的供电需求，就需要增加一个或多个电源管理系统，这时多个电源管理系统的输出电压都需要调节到适合的电压上，以保证每个LED驱动芯片的功耗最小。此处以配置两个电源管理系统和两颗LED驱动芯片为例进行说明，电路原理示意图如图9所示，控制方法的过程如图10所示，并且两个以上电源管理系统和两颗以上LED驱动芯片同理。LED驱动芯片1的电流调节端IFB连接到电源管理系统1的FB端口上，LED驱动芯片2的电流调节端IFB连接到电源管理系统2的FB端口上，LED驱动芯片1的串行数据输出SDO端口与LED驱动芯片2的串行数据输入SDI端口级联连接。电源管理系统1 输出电源电压VLED1通过扫描驱动1给扫描行W0-Wk的LED阵列供电，电源管理系统2输出电源电压VLED2通过扫描驱动2给扫描行Wk+1-Wn-1的LED阵列供电。本实施例为方便描述，将整个LED阵列具体分为4个阵列，其中VLED1供电、LED驱动芯片1驱动的阵列定义为LED11阵列，VLED1供电、LED驱动芯片2驱动的阵列定义为LED12阵列，VLED2供电、LED驱动芯片1驱动的阵列定义为LED21阵列，VLED2供电、LED驱动芯片2驱动的阵列定义为LED22阵列。在系统电路上电开始工作时，LED驱动芯片通过SDI、DCLK和LE信号接收控制器的指令和数据，如配置LED驱动芯片1的扫描初始值为0，扫描行数为k+1，不允许数据进行回传，允许数据下传，LED驱动芯片2的扫描初始值为k+1，扫描行数为n-k-1，允许数据进行回传。因此LED驱动芯片1对W0-Wk扫描行数的LED11阵列的端口电压信息进行运算处理，而对Wk+1-Wn-1扫描行数的LED21阵列的端口电压信息进行数据下传，LED驱动芯片2则对W0-Wk扫描行数的LED12阵列的端口电压信息回传给LED驱动芯片1处理，而对Wk+1-Wn-1扫描行数的LED22阵列的端口电压信息进行运算处理。然后LED驱动芯片接收到端口电压检测指令，所有LED驱动芯片逐行的对各自输出端口的电压进行检测，将检测结果进行运算暂存。当LED驱动芯片接收到数据下传和回传指令后，LED驱动芯片1下传Wk+1 - Wn-1扫描行数的LED21阵列的端口电压信息数据，同时接收LED驱动芯片2的W0 -Wk扫描行数的LED12阵列的端口电压信息数据回传；LED驱动芯片2接收LED驱动芯片1下传的Wk+1 - Wn-1扫描行数的LED21阵列的端口电压信息数据，对暂存的W0 -Wk扫描行数的LED12阵列的端口电压信息进行数据回传。如此经过数据下传和回传指令后LED驱动芯片1的数据寄存器存有W0-Wk扫描行LED11和LED12阵列的每个端口的电压信息数据，LED驱动芯片2的数据寄存器存有Wk+1-Wn-1扫描行LED21和LED22阵列的每个端口的电压信息数据。逻辑处理电路计算处理数据寄存器的数据和本芯片端口电压检测结果，判断设定扫描行的所有端口的端口电压的相对高低情况。在电源电压调整功能使能后，LED驱动芯片1会运算数据寄存器的值和本芯片W0-Wk扫描行端口电压检测结果，最终产生参考电流IFB输出，调整电源管理系统1的电压输出VLED1；LED驱动芯片2会运算数据寄存器的值和本芯片Wk+1-Wn-1扫描行端口电压检测结果，最终产生参考电流IFB输出，调整电源管理系统2的电压输出VLED2，全方面的实现LED驱动芯片电流输出端口的电压优化调整。上述实施例仅为本发明的优选实施例，并非对本发明保护范围的限制，但凡采用本发明的设计原理，以及在此基础上进行非创造性劳动而做出的变化，均应属于本发明的保护范围之内。
