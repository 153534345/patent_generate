标题title
一种格兰杰因果关系发现方法、设备及存储设备
摘要abst
本发明提供了一种格兰杰因果关系发现方法、设备及存储设备，通过设置滑动窗口对时序数据进行预处理并采用关联规则挖掘算法计算得到Support、Confidence和Lift；分别计算具备因果先验信息指标；设定初始因果图初始边数量并结合因果强度值构造初始因果图；结合Hawkes点过程进行删边操作得到具有最大似然函数的因果图；结合增益分数值和上述得到的因果图进行增边和删边操作获取具有最大似然函数值的最终因果图。一种格兰杰因果关系发现设备及存储设备，用于实现所述的格兰杰因果关系发现方法。本发明的有益效果是：能够提升因果结构发现的精度并降低算法资源的消耗。
权利要求书clms
1.一种格兰杰因果关系发现方法，其特征在于：包括：S1：根据移动基站的时序数据采用关联规则挖掘算法计算Support、Confidence和Lift；S2：根据Support、Confidence和Lift计算具备先验信息的指标：因果强度值和增益分数/＞值；S3：根据因果强度值，构造初始因果图/＞；S4：采用Hawkes点过程对步骤S3生成的初始因果图进行删边操作，得到因果图/＞；S5：根据增益分数值，采用Hawkes点过程对步骤S4生成的因果图/＞进行增边或删边操作，得到最终因果图。2.如权利要求1所述的一种格兰杰因果关系发现方法，其特征在于：步骤S1中的实现过程为：S1.1：对时序数据进行预处理，即设定滑动窗口大小为k1，将时序数据分成若干个窗口，每个窗口中包含k个时刻的数据；S1.2：针对每个窗口中的子序列，构造“basketdataset”，即将每个子序列看作一个“basket”，将所有“basket”组成一个“basketdataset”；S1.3：根据构造出的“basketdataset”，计算每个关联规则的Support、Confidence和Lift。3.如权利要求1所述的一种格兰杰因果关系发现方法，其特征在于：步骤S2中的实现过程为：S2.1：定义能够反应事件和事件/＞之间潜在因果关系指标/＞，具体计算公式为：其中，表示事件/＞到事件/＞的提升度，/＞表示事件/＞到事件/＞的置信度，/＞表示随机噪声；S2.2：定义能够反应事件和事件/＞之间因果关系对似然函数的潜在增益指标/＞，具体计算公式为：其中，表示事件/＞到事件/＞的支持度，/＞表示超参数，分别用于设定控制/＞和/＞的比例值；S2.3：根据上述两个公式及步骤S1中计算得到的Support、Confidence和Lift指标，计算所有潜在事件的因果强度值和增益分数/＞值。4.如权利要求1所述的一种格兰杰因果关系发现方法，其特征在于：步骤S3中的实现过程为：S3.1：设定初始因果图的因果边的数量m，并将所有的事件对按照因果强度/＞值从大到小排序；S3.2：从排序后的事件对中，逐次选取前m个事件对作为初始因果边，在无环约束情况下生成初始因果图。5.如权利要求1所述的一种格兰杰因果关系发现方法，其特征在于：步骤S4中的实现过程为：S4.1：将初始因果图作为当前因果图，根据Hawkes点过程计算其似然函数值/＞；S4.2：对于当前因果图中的每条因果边分别移除，得到新的邻居因果图，采用Hawkes点过程分别计算其似然函数值/＞；S4.3：根据似然函数值的大小，选取邻居因果图中最大似然函数值/＞，若其似然函数值/＞大于初始因果图/＞的似然函数值/＞，则将该邻居因果图作为当前因果图，否则继续保留原因果图；如果所有邻居因果图的似然函数值都小于或等于当前因果图的似然函数值，则停止移除因果边操作，返回当前因果图作为最终结果；S4.4：重复步骤S4.1-4.3，直到无法再移除因果边为止，得到因果图。6.如权利要求5所述的一种格兰杰因果关系发现方法，其特征在于：步骤S5中的实现过程为：S5.1：根据因果图，并根据增益分数/＞值定义了如下要添加和删除的潜在边的集合：式中，满足/＞和/＞；其中，表示需要添加的潜在边集合，/＞表示需要删除的潜在边集合，/＞表示第i个需要添加的潜在边，/＞表示第j个需要删除的潜在边，/＞表示第i个需要添加的潜在边的增益分数，/＞表示第j个需要删除的潜在边的增益分数，i=1,2,…,/＞，j=1,2,…,/＞，/＞表示时间类型的数量，/＞表示因果图中边的总数；S5.2：引入超参数控制添加或删除边的概率；S5.3：采取与步骤S4相同的方法，迭代地选择似然函数值最高的邻居因果图作为下一个因果图，如果所有邻居因果图的似然函数值都小于或等于当前因果图的似然函数值，则停止增/删边操作，返回当前因果图作为最终结果；S5.4：重复步骤S5.1-S5.3，直到无法再增/删边为止，得到最终因果图。7.一种存储设备，其特征在于：所述存储设备存储指令及数据用于实现权利要求1~6任一项所述的格兰杰因果关系发现方法。8.一种格兰杰因果关系发现设备，其特征在于：包括：处理器及存储设备；所述处理器加载并执行所述存储设备中的指令及数据用于实现权利要求1~6任一项所述的格兰杰因果关系发现方法。
说明书desc
技术领域本发明涉及故障发现及修复领域，尤其涉及一种格兰杰因果关系发现方法、设备及存储设备。背景技术格兰杰因果关系是一种广泛采用的统计学概念，用于检查一个时间序列是否可用于预测另一个。在时间序列数据中发现事件类型之间的格兰杰因果关系具有重要的意义，在多个领域都有应用。例如在通信网络中，一个故障事件可能在特定的时间范围内引发另一个故障事件，故障的影响可以通过网络中连接的设备传播。发现各种故障事件之间的格兰杰因果关系，这可以用于识别故障的根本原因，促进快速修复故障。如何针对时间序列数据，发现各个变量之间的格兰杰因果关系成为当下的一个研究热点问题。格兰杰因果发现是一种用于识别两个变量之间是否具有因果关系的方法。现有的方法主要以统计学方法为主，通过对变量间的依赖关系进行独立性测试从而判断一个变量是否对另外一个变量的影响是否显著。同时也有一些基于时序点过程的方法通过强度函数恢复变量间的格兰杰因果关系。但是现有的方法往往忽略先验信息对格兰杰因果关系发现的重要性，先验信息一方面能够加速格兰杰因果发现的速度，另一方面先验信息能够指导现有算法发现更准确的格兰杰因果关系。发明内容目前时序数据中格兰杰因果关系算法中的忽略了因果结构先验信息，导致格兰杰因果关系算法复杂性增加，效率不高，识别的因果效应精度较低，成本较高，针对这些问题，本发明提供了一种格兰杰因果关系发现方法、设备及存储设备，可以提高故障识别准确度和识别速度，降低了成本。一种格兰杰因果关系发现方法，主要包括：S1：根据移动基站的时序数据采用关联规则挖掘算法计算支持度、置信度和提升度；S2：根据Support、Confidence和Lift计算具备先验信息的指标：因果强度值和增益分数/＞值；S3：根据因果强度值，构造初始因果图/＞；S4：采用Hawkes点过程对步骤S3生成的初始因果图进行删边操作，得到因果图/＞；S5：根据增益分数值，采用Hawkes点过程对步骤S4生成的因果图/＞进行增边或删边操作，得到最终因果图。进一步地，步骤S1中的实现过程为：S1.1：对时序数据进行预处理，即设定滑动窗口大小为k1，将时序数据分成若干个窗口，每个窗口中包含k个时刻的数据；S1.2：针对每个窗口中的子序列，构造“basketdataset”，即将每个子序列看作一个“basket”，并将所有“basket”组成一个“basketdataset”；S1.3：根据构造出的“basket dataset”，计算每个关联规则的Support、Confidence和Lift。进一步地，步骤S2中的实现过程为：S2.1：定义能够反应事件和事件/＞之间潜在因果关系指标/＞，具体计算公式为其中，表示事件/＞到事件/＞的提升度，/＞表示事件/＞到事件的置信度，/＞表示随机噪声；S2.2：定义能够反应事件和事件/＞之间因果关系对似然函数的潜在增益指标，具体计算公式为其中，表示事件/＞到事件/＞的支持度，/＞表示超参数，分别用于设定控制/＞和/＞的比例值；S2.3：根据上述两个公式定义及步骤S1中Support、Confidence和Lift指标，分别计算所有潜在事件的因果强度值和增益分数/＞值。进一步地，步骤S3中的实现过程为：S3.1：设定初始因果图的因果边的数量m，并将所有的事件对按照因果强度值从大到小排序；S3.2：从排序后的事件对中，逐次选取前m个事件对作为初始因果边，在无环约束情况下生成初始因果图。进一步地，步骤S4中的实现过程为：S4.1：将初始因果图作为当前因果图，根据Hawkes点过程计算其似然函数值；S4.2：对于当前因果图中的每条因果边分别移除，得到新的邻居因果图，根据Hawkes点过程分别计算其似然函数值/＞；S4.3：根据似然函数值的大小，选取邻居因果图中最大似然函数值/＞，若其似然函数值/＞大于初始因果图/＞的似然函数值/＞，则将该邻居因果图作为当前因果图，否则继续保留原因果图；如果所有邻居因果图的似然函数值都小于或等于当前因果图的似然函数值，则停止移除因果边操作，即停止删边操作，返回当前因果图作为最终结果；S4.4：重复步骤S4.1-4.3，直到无法再移除因果边为止，得到因果图。进一步地，步骤S5中的实现过程为：S5.1：根据因果图，并根据增益分数/＞值定义了要添加和删除的潜在边的集合如下：式中满足/＞和/＞；其中，表示需要添加的潜在边集合，/＞表示需要删除的潜在边集合，/＞表示第i个需要添加的潜在边，/＞表示第j个需要删除的潜在边，/＞表示第i个需要添加的潜在边的增益分数，/＞表示第j个需要删除的潜在边的增益分数，i=1,2,…,/＞，j=1,2,…,/＞，/＞表示时间类型的数量，/＞表示因果图中边的总数；S5.2：引入超参数控制添加或删除边的概率，具体来说，在初始搜索时希望更多地尝试添加边，设置一个较高的/＞，随着搜索的进行，添加和删除边的概率趋于平衡，因此/＞的值会逐渐降低，直到得到趋于平衡的/＞；S5.3：采取与步骤S4相同的方法，迭代地选择似然函数值最高的邻居因果图作为下一个因果图，如果所有邻居因果图的似然函数值都小于或等于当前因果图的似然函数值，则停止增/删边操作，返回当前因果图作为最终结果；S5.4：重复步骤S5.1-S5.3，直到无法再增/删边为止，得到最终因果图。一种存储设备，所述存储设备存储指令及数据用于实现一种格兰杰因果关系发现方法。一种格兰杰因果关系发现设备，包括：处理器及所述存储设备；所述处理器加载并执行所述存储设备中的指令及数据用于实现一种格兰杰因果关系发现方法。本发明提供的技术方案带来的有益效果是：本发明根据时序数据采用关联规则挖掘算法计算Support、Confidence和Lift；然后根据Support、Confidence和Lift分别计算具备先验信息的指标：因果强度值和增益分数/＞值；接着根据因果强度/＞值，构造初始因果图/＞；然后根据步骤S3生成初始因果图/＞并结合Hawkes点过程进行删边操作得到因果图/＞；最后结合Hawkes点过程并根据增益分数/＞值对生成的因果图/＞进行增边或删边操作得到最终因果图。基于关联规则和Hawkes点过程的格兰杰因果发现方法，能有效利用关联规则所挖掘信息实现更准确地因果关系发现；关联规则信息指导下进行因果关系发现，能够加速因果结构发现效率，降低算法对处理器资源消耗；基于关联规则和Hawkes点过程的方法具有因果结构发现精度高和资源消耗低的特点，方便扩展处理更复杂场景下的因果关系发现需求。附图说明图1是本发明实施例中一种格兰杰因果关系发现方法的总体框架图；图2是本发明实施例中硬件设备工作的示意图。具体实施方式为了对本发明的技术特征、目的和效果有更加清楚的理解，现对照附图详细说明本发明的具体实施方式。本发明的实施例提供了一种格兰杰因果关系发现方法、设备及存储设备，通过设置滑动窗口对时序数据进行预处理并采用关联规则挖掘算法计算Support、Confidence和Lift这些常用指标；根据Support、Confidence和Lift分别计算具备因果先验信息的因果强度值和增益分数/＞值；设定初始因果图初始边数量并结合因果强度/＞值构造初始因果图；针对初始因果图并结合Hawkes点过程进行删边操作得到具有最大似然函数的因果图；结合增益分数/＞值和上述得到的因果图进行增边和删边操作获取具有最大似然函数值的最终因果图。基于关联规则挖掘和Hawkes点过程的格兰杰因果发现能够提升因果结构发现的精度并降低算法资源的消耗。请参考图1，图1是本发明实施例中一种格兰杰因果关系发现方法的流程图，具体包括：S1：根据移动基站的时序数据采用关联规则挖掘算法计算支持度、置信度和提升度；所述时序数据是指，什么时间点，移动基站的哪个节点出现了什么故障；而本发明所述的因果关系发现算法是指，根据这个故障时序数据推导各个故障的因果关系；S2：根据Support、Confidence和Lift计算具备先验信息的指标：因果强度值和增益分数/＞值；S3：根据因果强度值，构造初始因果图/＞；S4：采用Hawkes点过程对步骤S3生成的初始因果图进行删边操作，得到因果图/＞；本实施例中的Hawkes点过程为拓扑多维Hawkes点过程；S5：根据增益分数值，采用Hawkes点过程对步骤S4生成的因果图/＞进行增边或删边操作，得到最终因果图。步骤S1中的实现过程为：S1.1：如图1所示，拓扑结构为n1、n0、…，时序数据为t0、t1、t2、t3、t4、…、tm；对时序数据进行预处理，即设定滑动窗口大小为k1，将时序数据分成若干个窗口，每个窗口中包含k个时刻的数据；S1.2：针对每个窗口中的子序列，构造“basketdataset”，即将每个子序列看作一个“basket”，并将所有“basket”组成一个“basketdataset”；S1.3：根据构造出的“basketdataset”，计算每个关联规则的Support、Confidence和Lift。步骤S2中的实现过程为：S2.1：定义能够反应事件和事件/＞之间潜在因果关系指标/＞，具体计算公式为其中，表示事件/＞到事件/＞的提升度，/＞表示事件/＞到事件的置信度，/＞表示随机噪声；S2.2：定义能够反应事件和事件/＞之间因果关系对似然函数的潜在增益指标，具体计算公式为其中，表示事件/＞到事件/＞的支持度，/＞表示超参数，分别用于设定控制/＞和/＞的比例值；S2.3：根据上述两个公式定义及步骤S1中Support、Confidence和Lift指标，分别计算所有潜在事件的因果强度值和增益分数/＞值。步骤S3中的实现过程为：S3.1：设定初始因果图的因果边的数量m，并将所有的事件对按照因果强度值从大到小排序；S3.2：从排序后的事件对中，逐次选取前m个事件对作为初始因果边，在无环约束情况下生成初始因果图。步骤S4中的实现过程为：S4.1：将初始因果图作为当前因果图，根据Hawkes点过程计算其似然函数值；S4.2：对于当前因果图中的每条因果边分别移除，得到新的邻居因果图，根据Hawkes点过程分别计算其似然函数值/＞；S4.3：根据似然函数值的大小，选取邻居因果图中最大似然函数值/＞，若其似然函数值/＞大于初始因果图/＞的似然函数值/＞，则将该邻居因果图作为当前因果图，否则继续保留原因果图；如果所有邻居因果图的似然函数值都小于或等于当前因果图的似然函数值，则停止移除因果边操作，即停止删边操作，返回当前因果图作为最终结果；S4.4：重复步骤S4.1-4.3，直到无法再移除因果边为止，得到因果图。步骤S5中的实现过程为：S5.1：根据因果图，并根据增益分数/＞值定义了要添加和删除的潜在边的集合如下：式中满足和/＞；其中，表示需要添加的潜在边集合，/＞表示需要删除的潜在边集合，/＞表示第i个需要添加的潜在边，/＞表示第j个需要删除的潜在边，/＞表示第i个需要添加的潜在边的增益分数，/＞表示第j个需要删除的潜在边的增益分数，i=1,2,…,/＞，j=1,2,…,/＞，/＞表示时间类型的数量，/＞表示因果图中边的总数；得到当前需要添加边和删除边的集合后对齐进行排序，然后选择最应该删除或添加的边进行操作；S5.2：引入超参数控制添加或删除边的概率，具体来说，在初始搜索时希望更多地尝试添加边，设置一个较高的/＞，随着搜索的进行，添加和删除边的概率趋于平衡，因此/＞的值会逐渐降低，直到得到趋于平衡的/＞；S5.3：类似步骤S4，迭代地选择似然函数值最高的邻居因果图作为下一个因果图，如果所有邻居因果图的似然函数值都小于或等于当前因果图的似然函数值，则停止增/删边操作，返回当前因果图作为最终结果；S5.4：重复步骤S5.1-S5.3，直到无法再增/删边为止，得到最终因果图。例如，将本发明公开的方法应用在电信网络基站进行故障因果结构发现，可以更加方便、更加快速地进行故障修复，降低了成本。本实施例中，基于合成数据进行，对比了在具有不同事件类型的时间序列中，表1为各方法所得因果图与真实因果图比较后的F1-score值。其中PC、PCMCI和TTPM为三类格兰杰因果关系算法，将其作为与所述方法作对比的baseline算法。表1 所述方法与典型格兰杰因果关系发现算法实验对比结果通过表1可知，不论事件类型数量为多少，本发明所述方法都优于PC、PCMCI和TTPM算法。请参见图2，图2是本发明实施例的硬件设备工作示意图，所述硬件设备具体包括：一种格兰杰因果关系发现设备401、处理器402及存储设备403。一种格兰杰因果关系发现设备401：所述一种格兰杰因果关系发现设备401实现所述一种格兰杰因果关系发现方法。处理器402：所述处理器402加载并执行所述存储设备403中的指令及数据用于实现所述一种格兰杰因果关系发现方法。存储设备403：所述存储设备403存储指令及数据；所述存储设备403用于实现所述一种格兰杰因果关系发现方法。本发明的有益效果是：本发明根据时序数据采用关联规则挖掘算法计算Support、Confidence和Lift；然后根据Support、Confidence和Lift分别计算具备先验信息的指标：因果强度值和增益分数/＞值；接着根据因果强度/＞值，构造初始因果图/＞；然后根据步骤S3生成初始因果图/＞并结合Hawkes点过程进行删边操作得到因果图/＞；最后结合Hawkes点过程并根据增益分数/＞值对生成的因果图/＞进行增边或删边操作得到最终因果图。基于关联规则和Hawkes点过程的格兰杰因果发现方法，能有效利用关联规则所挖掘信息实现更准确地因果关系发现；关联规则信息指导下进行因果关系发现，能够加速因果结构发现效率，降低算法对处理器资源消耗；基于关联规则和Hawkes点过程的方法具有因果结构发现精度高和资源消耗低的特点，方便扩展处理更复杂场景下的因果关系发现需求。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
