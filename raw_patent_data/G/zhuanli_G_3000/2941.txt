标题title
一种CBCT图像截断伪影抑制方法
摘要abst
本发明涉及一种CBCT图像截断伪影抑制方法，包括如下步骤：步骤1、通过两次锥形束CT利用大小不同的视野扫描采集同一扫描对象，获得大小视野两组投影数据，其中大视野投影数据覆盖扫描对象的部分投影区域，小视野投影数据对应扫描对象内部的ROI区域；步骤2、对大视野投影数据使用重建算法得到重建图像；步骤3、对重建图像进行前向投影得到覆盖扫描对象的完整投影；步骤4、通过两次扫描区域的几何位置关系计算出小视野区域在大视野投影图上的投影位置，结合大视野重建图像的前向完整投影实现投影图像补全；步骤5、最后对图像补全位置进行后处理，重建得到最终图像。
权利要求书clms
1.一种CBCT图像截断伪影抑制方法，其特征在于，包括如下步骤：步骤1、通过两次锥形束CT利用大小不同的视野扫描采集同一扫描对象，获得大小视野两组投影数据，其中大视野投影数据覆盖扫描对象的部分投影区域，小视野投影数据对应扫描对象内部ROI区域的投影；步骤2、对大视野投影数据使用重建算法得到重建图像；步骤3、对重建图像进行前向投影得到覆盖扫描对象的完整投影图像；步骤4、通过两次扫描区域的几何位置关系计算出小视野区域在大视野投影上的投影位置，结合大视野重建图像的前向完整投影图像对小视野投影图像进行补全；步骤5、最后对小视野投影图像补全位置进行后处理，重建得到最终图像。2.根据权利要求1所述的一种CBCT图像截断伪影抑制方法，其特征在于：所述步骤1包括：通过两次锥形束CT利用大小不同的视野扫描采集同一患者身体上的同一扫描对象，获得大小视野两组投影数据。3.根据权利要求1所述的一种CBCT图像截断伪影抑制方法，其特征在于：所述步骤4包括：利用前向投影的几何关系计算ROI区域在大视野投影域的分布区域，计算ROI投影区域外接矩形，并记录ROI投影区域起始点位置P、以及分布区域的宽度w和高度h，用于图像的配准。4.根据权利要求1所述的一种CBCT图像截断伪影抑制方法，其特征在于：所述步骤4中，结合大视野重建图像的前向完整投影图像对小视野投影图像进行补全，包括：对大视野完整投影数据缩放处理，使其与小视野投影图像上相同结构影像大小一致，并用缩放后的大视野完整投影数据补全小视野投影数据。5.根据权利要求4所述的一种CBCT图像截断伪影抑制方法，其特征在于：CBCT成像过程中，探测器与射线源绕着被扫对象旋转一周，旋转过程中探测器到ROI区域的距离一直在变，而探测器到射线源的距离不变；根据投影高度h与实际获取的小视野投影图像高度H计算缩放比R＝H/h，然后基于该缩放比对大视野投影数据进行缩放处理，然后用缩放后的大视野投影图像数据补全小视野投影图像数据。6.根据权利要求1所述的一种CBCT图像截断伪影抑制方法，其特征在于：所述的步骤5包括：对补全后小视野投影图像进行补全数据灰度值调整，与补全位置像素融合处理得到最后的投影数据补全图像，使补全位置灰度值平滑过度。7.根据权利要求1所述的一种CBCT图像截断伪影抑制方法，其特征在于：所述步骤1包括：所述扫描对象为患者的头部。8.根据权利要求7所述的一种CBCT图像截断伪影抑制方法，其特征在于：所述步骤3中，利用前向投影对大视野扫描重建获取的CBCT图像进行计算得到准确的完整投影数据，其中大视野的重建视野在轴向面能完整覆盖患者头部。9.根据权利要求1所述的一种CBCT图像截断伪影抑制方法，其特征在于：所述步骤2的重建算法包括FDK重建算法、迭代重建算法。
说明书desc
技术领域本发明涉及图像处理领域，尤其是一种CBCT图像截断伪影抑制方法。背景技术CBCT成像技术因其快速、精确、三维可视化等优点广泛应用于医学领域，临床应用中常采用小视野扫描模式完成高分辨率成像，但由扫描视野不够大，无法覆盖患者的整个横截面，导致采集的投影数据被截断。CBCT重建过程中涉及滤波步骤，信号强度的突变将被放大，这种放大的信号强度变化将错误地传播到有效视野内边界附近的像素，并提升其灰度值。反投影后，投影数据中的信号突变将被传输到重建的CBCT图像，导致有效视野外边界附近的CT值激增，即图像外围出现高亮伪影，不仅影响外边界结构信息的诊断，还降低了CT值的准确性。如何有效地去除截断伪影成为亟待解决的问题。为了减少重建图像截断伪影，目前已经开发了各种投影数据补全方法，以使投影数据在现视野边界上更平滑地过渡。如数据外推方法，其原理是利用投影图像边界像素作为指导，用余弦函数或者线性递减等方法生成数据替换视野外丢失的投影数据，以便投影数据可以平滑地降到零。这类伪影去除方法能一定程度改善伪影，但因补全的数据与真实结构信息相差太大导致重建图像靠近边缘的CT值与实际组织结构的密度相差较大。有相关技术提出直接使用获取的真实投影数据补全小视野投影数据，以实现截断伪影抑制。但在临床应用中为了扩大成像视野常使用探测器偏置设计，获取的大视野投影数据不能完全覆盖被扫描对象，又因共轭补全的几何关系计算只有在锥形束CT中心层才完全准确，非中心层补全位置计算误差会导致组织结构发生错开现象，因此利用真实投影数据的共轭数据补全小视野投影数据依然存在不准确问题。也有专利提出的双源双探CT系统的小视野重建方法利用图像配准算法进行数据补全，会受到投影图像质量及结构特征清晰度的制约，需进一步提高算法在临床应用中的适应性与稳定性。发明内容本发明需要解决问题为：1)探测器偏置设计获取的锥形束扫描数据用共轭补全法得到的完整投影并不准确；2)用图像配准方法计算数据补全位置受限于投影图像质量，适应性、稳定性有待提升。本发明针对以上的问题给出了合理可行的解决方案。本发明的技术方案为：一种CBCT图像截断伪影抑制方法，包括如下步骤：步骤1、通过两次锥形束CT利用大小不同的视野扫描采集同一扫描对象，获得大小视野两组投影数据，大视野投影数据覆盖扫描对象的部分投影区域，小视野投影数据对应扫描对象内部ROI区域的投影；其中，由于探测器偏置设计，采集的大视野投影数据覆盖扫描对象的部分投影区域，其中ROI区域位于扫描对象内部；步骤2、对大视野投影数据使用重建算法得到重建图像，重建图像覆盖扫描对象；所述重建算法包括FDK重建算法、迭代重建算法；步骤3、对重建图像进行前向投影得到覆盖扫描对象的完整投影图像；步骤4、通过两次扫描区域的几何位置关系计算出小视野区域在大视野投影上的投影位置，结合大视野重建图像的前向完整投影图像对小视野投影图像进行补全；步骤5、最后对小视野投影图像补全位置进行后处理，重建得到最终图像。进一步的，所述步骤1包括：通过两次锥形束CT利用大小不同的视野扫描采集同一患者身体上的同一扫描对象，获得大小视野两组投影数据。进一步的，所述步骤4包括：利用前向投影的几何关系计算ROI区域在大视野投影域的分布区域，计算ROI投影区域外接矩形，并记录ROI投影区域起始点位置P、以及分布区域的宽度w和高度h，用于图像的配准。进一步的，CBCT成像过程中，探测器与射线源绕着被扫对象旋转一周，旋转过程中探测器到ROI区域的距离一直在变，而探测器到射线源的距离不变；所述步骤4中结合大视野重建图像的前向完整投影图像对小视野投影图像进行补全，包括：对大视野完整投影数据缩放处理，使其与小视野投影图像上相同结构影像大小一致，并用缩放后的大视野完整投影数据补全小视野投影数据。根据投影高度h与实际获取的小视野投影图像高度H计算缩放比R＝H/h，然后基于该缩放比对大视野投影数据进行缩放处理，然后用缩放后的大视野投影图像数据补全小视野投影图像数据。进一步的，所述的步骤5包括：对补全后小视野投影图像进行补全数据灰度值调整，与补全位置像素融合处理得到最后的投影数据补全图像，使补全位置灰度值平滑过度。进一步的，所述步骤1包括：所述扫描对象为患者的头部。进一步的，所述步骤3中，利用前向投影对大视野扫描重建获取的CBCT图像进行计算得到准确的完整投影数据，其中大视野的重建视野在轴向面能完整覆盖患者头部。有益效果：本发明提出了一种全投影数据获取方法，即设置大视野系统的重建视野在轴向面能完整覆盖患者头部，然后进行大视野扫描并重建得到三维重建图像，再利用前向投影法获取准确的完整投影数据用以小视野的补全；本发明提出用几何位置关系计算更准确的投影数据配准位置，实现用携带真实结构完整信息的数据与小视野投影数据的补全，且不受获取投影数据质量的影响，本发明使重建图像截断伪影的抑制取得了更优的效果。附图说明图1截断数据重建方法流程图；图2ROI区域在大视野投影域的位置关系及分布区域；图3ROI在投影域的实际分布区域；图4旋转扫描过程中ROI区域在大视野投影域的分布；图5大视野投影数据补全小视野投影数据示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整的描述，显然，所描述的实施例仅为本发明的一部分实施例，而不是全部的实施例，基于本发明中的实施例，本领域的普通技术人员在不付出创造性劳动的前提下所获得的所有其他实施例，都属于本发明的保护范围。本发明的实施例提出一种CBCT图像截断伪影抑制方法，流程图如图1所示，包括：步骤1、通过两次锥形束CT利用大小不同的视野扫描采集同一扫描对象，获得大小视野两组投影数据，大视野投影数据覆盖扫描对象的部分投影区域或全部，小视野投影数据对应扫描对象内部ROI区域的投影；其中，由于探测器偏置设计，采集的大视野投影数据覆盖扫描对象的部分投影区域，其中ROI区域位于该扫描对象内部；步骤2、对大视野投影数据使用重建算法得到重建图像，重建图像覆盖扫描对象；所述重建算法包括FDK重建算法、迭代重建算法等；步骤3、对重建图像进行前向投影得到覆盖扫描对象的完整投影图像；步骤4、通过两次扫描区域的几何位置关系计算出小视野区域在大视野投影上的投影位置，结合大视野重建图像的前向完整投影图像对小视野投影图像进行补全；步骤5、最后对小视野投影图像补全位置进行后处理，重建得到最终图像。所述的步骤1中、通过两次锥形束CT利用大小不同的视野扫描采集同一患者身体上的同一扫描对象，获得大小视野两组投影数据。所述的扫描对象例如为患者的头部，大视野的视野范围较大，大于小视野的视野范围，大视野的视野范围需要在轴向面能完整覆盖患者头部，而小视野范围只需要覆盖头部内一感兴趣的ROI区域即可，然后，通过锥形束CT扫描先后采集同一患者大视野与小视野两组投影数据，得到两组大小视野的图像；所述步骤2、对大视野投影数据使用重建算法得到大视野投影数据对应的重建图像；大视野完整投影数据获取包括:对大视野重建图像进行前向投影得到覆盖患者头部的完整投影。进一步的，如图2所示，所述步骤4包括：利用前向投影的几何关系计算ROI投影区域，所述ROI投影区域对应于小视野的重建区域在大视野投影域的分布区域，计算ROI投影区域外接矩形，并记录ROI投影区域起始点位置P、以及分布区域的宽度w和高度h，用于图像的配准。如图2，ROI投影区域计算，是利用前向投影的几何关系计算ROI在大视野投影域的分布区域，由于分布区域并不属于规则的矩形，因此需计算ROI投影区域外接矩形并记录ROI投影起始点位置P与分布区域大小，宽度w和高度h，用于图像的配准。所述步骤4中结合大视野重建图像的前向完整投影图像对小视野投影图像进行补全包括：对大视野完整投影数据缩放处理，使其与小视野投影图像上相同结构影像大小一致，并用缩放后的大视野完整投影数据补全小视野投影数据。结合大视野重建图像的前向完整投影图像对小视野投影图像进行补全，具体如下：CBCT成像过程中，探测器与射线源绕着被扫对象旋转一周，如图4所示，旋转过程中探测器到ROI区域的距离一直在变，而探测器到射线源的距离不变，因此同一个ROI区域的组织结构在不同分度位置的投影放大比例不同，导致其在投影域上的影像大小不同。如图4中的两个分度位置，ROI区域的投影位置从投影位置1变化到投影位置2，对应的投影区域大小也会发生变化。因此需对大视野完整投影数据缩放处理，使其与小视野图像上相同结构影像大小一致。具体的，可以根据投影高度h与实际获取的小视野投影图像高度H计算缩放比R＝H/h，然后基于该缩放比对大视野投影数据进行缩放处理，缩放过程中的像素值计算使用最近邻插值、双线性插值等插值方法均可。然后用缩放后的大视野投影数据补全小视野投影数据，如图5所示，由于小视野投影数据重建不需要高度方向超出视野高度H的数据，因此将超出视野上边缘与下边缘的数据丢弃，保留小视野高度H范围以内的数据，小视野投影数据的左边、右边区域均使用携带真实结构信息的缩放后的大视野投影数据进行了补全，解决了数据截断问题。进一步的，为了使补全位置灰度值平滑过度，对补全后图像进行补全数据灰度值调整与补全位置像素融合处理得到最后的投影数据补全图像。进一步的，用重建方法重建处理后的小视野投影图像的补全图像，得到最终的小视野重建图像。尽管上面对本发明说明性的具体实施方式进行了描述，以便于本技术领域的技术人员理解本发明，且应该清楚，本发明不限于具体实施方式的范围，对本技术领域的普通技术人员来讲，只要各种变化在所附的权利要求限定和确定的本发明的精神和范围内，这些变化是显而易见的，一切利用本发明构思的发明创造均在保护之列。
