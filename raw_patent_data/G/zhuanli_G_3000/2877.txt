标题title
预测帕金森病危险等级的预测模型进行训练的方法及装置
摘要abst
本申请公开了一种预测帕金森病危险等级的预测模型进行训练的方法及装置。所述方法包括：获取反映被检者的脑区间差异的扩散峰度成像，并且从扩散峰度成像中提取与帕金森病相关的目标参数图像；对目标参数图像执行随机赋值操作，以获得随机参数图像；基于目标参数图像和所述随机参数图像，使用第一子模型进行特征提取，以构建正例样本和反例样本；根据正例样本和反例样本计算所述预测模型的第一损失函数；至少基于目标参数图像，使用第二子模型进行分类操作并且计算预测模型的第二损失函数；以及利用第一损失函数和第二损失函数训练预测模型，以对预测帕金森病危险等级的预测模型进行训练。利用本申请的方案，可以提高预测结果的准确性。
权利要求书clms
1.一种用于对预测帕金森病危险等级的预测模型进行训练的方法，其特征在于，所述预测模型包括第一子模型和第二子模型，并且所述方法包括：获取反映被检者的脑区间差异的扩散峰度成像，并且从所述扩散峰度成像中提取与帕金森病相关的目标参数图像；对所述目标参数图像执行随机赋值操作，以获得随机参数图像；基于所述目标参数图像和所述随机参数图像，使用所述第一子模型进行特征提取，以构建正例样本和反例样本；根据所述正例样本和所述反例样本计算所述预测模型的第一损失函数；至少基于所述目标参数图像，使用所述第二子模型进行分类操作并且计算所述预测模型的第二损失函数；以及利用所述第一损失函数和所述第二损失函数训练所述预测模型，以对预测帕金森病危险等级的预测模型进行训练。2.根据权利要求1所述的方法，其特征在于，所述目标参数图像和所述随机参数图像包括平均峰度图像、轴向峰度图像和径向峰度图像中的至少两种类型图像。3. 根据权利要求2所述的方法，其特征在于，基于所述目标参数图像和所述随机参数图像，使用所述第一子模型进行特征提取，以构建正例样本和反例样本包括：使用所述第一子模型分别对所述目标参数图像和所述随机参数图像进行特征提取，以获得各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量；以及基于所述各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量构建所述正例样本和所述反例样本。4. 根据权利要求3所述的方法，其特征在于，基于所述各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量提取所述正例样本和所述反例样本包括：将所述目标参数图像对应的第一特征量与所述随机参数图像中的同种类型图像对应的第二特征量组成集合，以构建所述正例样本；以及将所述目标参数图像对应的第一特征量与所述随机参数图像中其他类型图像对应的第二特征量组成集合，以构建所述反例样本。5. 根据权利要求4所述的方法，其特征在于，根据所述正例样本和所述反例样本计算所述预测模型的第一损失函数包括：基于所述正例样本和所述反例样本计算相似性；以及根据相似性结果计算所述预测模型的第一损失函数。6. 根据权利要求2所述的方法，其特征在于，还包括：获取与帕金森病相关的认知量表信息；以及基于所述目标参数图像和所述认知量表信息，使用所述第二子模型进行分类操作并且计算所述预测模型的第二损失函数。7. 根据权利要求2所述的方法，其特征在于，利用所述第一损失函数和所述第二损失函数训练所述预测模型，以对预测帕金森病危险等级的预测模型进行训练包括：对所述第一损失函数和所述第二损失函数执行加权和操作，以获得总损失函数；以及利用所述总损失函数训练所述预测模型，以对预测帕金森病危险等级的预测模型进行训练。8.一种用于对预测帕金森病危险等级进行预测的装置，其特征在于，包括：处理器；存储器，其存储有用于对预测帕金森病危险等级进行预测的程序指令，当所述程序指令由所述处理器执行时，使得所述装置实现以下操作：获取反映被检者的脑区间差异的扩散峰度成像，并且从所述扩散峰度成像中提取与帕金森病相关的目标参数图像；以及将所述目标参数图像输入至根据权利要求1-7任意一项所述的方法训练完成的预测模型进行预测，以输出对预测帕金森病危险等级的预测结果。9.一种用于对预测帕金森病危险等级的预测模型进行训练的设备，其特征在于，包括：处理器；存储器，其存储有用于对预测帕金森病危险等级的预测模型进行训练的程序指令，当所述程序指令由所述处理器执行时，使得所述设备实现根据权利要求1-7任意一项所述的方法。10.一种计算机可读存储介质，其特征在于，其上存储有用于对预测帕金森病危险等级进行预测以及用于对预测帕金森病危险等级的预测模型进行训练的计算机可读指令，该计算机可读指令被一个或多个处理器执行时，实现如权利要求8所述的装置所执行的操作以及实现如权利要求1-7任意一项所述的方法。
说明书desc
技术领域本申请一般涉及人工智能技术领域。更具体地，本申请涉及一种用于对预测帕金森病危险等级的预测模型进行训练的方法和设备。进一步地，本申请还涉及一种用于对预测帕金森病危险等级进行预测的装置以及一种计算机可读存储介质。背景技术帕金森病是中老年人常见的中枢神经系统退行性疾病，其临床表现主要包括静止性震颤、运动迟缓、肌强直和姿势步态障碍，同时还伴有认知障碍等症状。研究表明，患帕金森病的患者其大脑的脑功能连接也会有所变化。目前，已有通过采集帕金森病患者的脑部影像，通过将脑部影像输入至神经网络模型中进行特征提取，以预测帕金森病的风险。然而，现有的方式仅靠卷积神经网络，从而难以提取到帕金森病患者的脑功能连接中的鉴别性特征，使得预测结果不准确。另外，在对卷积神经网络进行训练时，现有的方式往往是先进行监督训练，再对卷积神经网络进行训练，从而无法兼顾前、后训练阶段的损失，使得训练的卷积神经网络的精度不高。有鉴于此，亟需提供一种用于对预测帕金森病危险等级的预测模型进行训练的方案，以便提升预测模型的精度，从而充分地提取帕金森病患者的脑功能连接中的鉴别性特征，提高预测结果的准确性。发明内容为了至少解决如上所提到的一个或多个技术问题，本申请在多个方面中提出了用于对预测帕金森病危险等级的预测模型进行训练的方案。在第一方面中，本申请提供一种用于对预测帕金森病危险等级的预测模型进行训练的方法，其中所述预测模型包括第一子模型和第二子模型，并且所述方法包括：获取反映被检者的脑区间差异的扩散峰度成像，并且从所述扩散峰度成像中提取与帕金森病相关的目标参数图像；对所述目标参数图像执行随机赋值操作，以获得随机参数图像；基于所述目标参数图像和所述随机参数图像，使用所述第一子模型进行特征提取，以构建正例样本和反例样本；根据所述正例样本和所述反例样本计算所述预测模型的第一损失函数；至少基于所述目标参数图像，使用所述第二子模型进行分类操作并且计算所述预测模型的第二损失函数；以及利用所述第一损失函数和所述第二损失函数训练所述预测模型，以对预测帕金森病危险等级的预测模型进行训练。在一个实施例中，其中所述目标参数图像和所述随机参数图像包括平均峰度图像、轴向峰度图像和径向峰度图像中的至少两种类型图像。在另一个实施例中，其中基于所述目标参数图像和所述随机参数图像，使用所述第一子模型进行特征提取，以构建正例样本和反例样本包括：使用所述第一子模型分别对所述目标参数图像和所述随机参数图像进行特征提取，以获得各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量；以及基于所述各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量构建所述正例样本和所述反例样本。在又一个实施例中，其中基于所述各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量提取所述正例样本和所述反例样本包括：将所述目标参数图像对应的第一特征量与所述随机参数图像中的同种类型图像对应的第二特征量组成集合，以构建所述正例样本；以及将所述目标参数图像对应的第一特征量与所述随机参数图像中其他类型图像对应的第二特征量组成集合，以构建所述反例样本。在又一个实施例中，其中根据所述正例样本和所述反例样本计算所述预测模型的第一损失函数包括：基于所述正例样本和所述反例样本计算相似性；以及根据相似性结果计算所述预测模型的第一损失函数。在又一个实施例中，所述方法还包括：获取与帕金森病相关的认知量表信息；以及基于所述目标参数图像和所述认知量表信息，使用所述第二子模型进行分类操作并且计算所述预测模型的第二损失函数。在又一个实施例中，其中利用所述第一损失函数和所述第二损失函数训练所述预测模型，以对预测帕金森病危险等级的预测模型进行训练包括：对所述第一损失函数和所述第二损失函数执行加权和操作，以获得总损失函数；以及利用所述总损失函数训练所述预测模型，以对预测帕金森病危险等级的预测模型进行训练。在第二方面中，本申请提供一种用于对预测帕金森病危险等级进行预测的装置，包括：处理器；存储器，其存储有用于对预测帕金森病危险等级进行预测的程序指令，当所述程序指令由所述处理器执行时，使得所述装置实现以下操作：获取反映被检者的脑区间差异的扩散峰度成像，并且从所述扩散峰度成像中提取与帕金森病相关的目标参数图像；以及将所述目标参数图像输入至根据前述第一方面中的多个实施例训练完成的预测模型进行预测，以输出对预测帕金森病危险等级的预测结果。在第三方面中，本申请提供一种用于对预测帕金森病危险等级的预测模型进行训练的设备，包括：处理器；存储器，其存储有用于对预测帕金森病危险等级的预测模型进行训练的程序指令，当所述程序指令由所述处理器执行时，使得所述设备实现前述第一方面中的多个实施例。在第四方面中，本申请提供一种计算机可读存储介质，其上存储有用于对预测帕金森病危险等级进行预测以及用于对预测帕金森病危险等级的预测模型进行训练的计算机可读指令，该计算机可读指令被一个或多个处理器执行时，实现前述第一方面中的多个实施例以及前述第二方面中的所述的装置所执行的操作。通过如上所提供的用于对预测帕金森病危险等级的预测模型进行训练的方案，本申请实施例通过从扩散峰度成像中提取与帕金森病相关的目标参数图像，并对目标参数图像执行随机赋值操作，以获得随机参数图像，接着使用第一子模型对目标参数图像和随机参数图像进行特征提取，以构建正例样本和反例样本。通过正例样本和反例样本计算预测模型的第一损失函数，再结合第二子模型基于目标参数图像计算第二损失函数，进而利用第一损失函数和第二损失函数训练所述预测模型。也即，本申请实施例通过基于目标参数图像和随机参数图像构建正、反样本进行对比监督学习并获得第一损失，同时结合第二损失训练预测模型，以同时兼顾第一、第二损失，从而提升预测模型的精度，以便充分提取与帕金森病相关的鉴别性信息，提高预测模型的准确性。进一步，本申请实施例还通过获取与帕金森病相关的认知量表信息，以基于目标参数图像和认知量表信息进行第二损失函数，即结合两种类型数据，以进一步提供预测模型的精度。基于此，后续通过利用本申请实施例方案训练的预测模型对帕金森病危险等级进行预测，能够获得准确的预测结果。附图说明通过参考附图阅读下文的详细描述，本申请示例性实施方式的上述以及其他目的、特征和优点将变得易于理解。在附图中，以示例性而非限制性的方式示出了本申请的若干实施方式，并且相同或对应的标号表示相同或对应的部分，其中：图1是示出根据本申请实施例的用于对预测帕金森病危险等级的预测模型进行训练的方法的示例性流程框图；图2是示出根据本申请实施例的用于对预测帕金森病危险等级的预测模型进行训练的示例性示意图；图3是示出根据本申请实施例的用于对预测帕金森病危险等级的预测模型进行训练的又一示例性示意图；图4是示出根据本申请实施例的用于对预测帕金森病危险等级进行预测的装置的示例性结构框图；以及图5是示出根据本申请实施例的用于对预测帕金森病危险等级的预测模型进行训练的设备的示例性结构框图。具体实施方式下面将结合附图对本申请实施例中的技术方案进行清楚和完整地描述。应当理解的是本说明书所描述的实施例仅是本申请为了便于对方案的清晰理解和符合法律的要求而提供的部分实施例，而并非可以实现本申请的所有实施例。基于本说明书公开的实施例，本领域技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。图1是示出根据本申请实施例的用于对预测帕金森病危险等级的预测模型进行训练的方法100的示例性流程框图。其中，该预测模型可以包括第一子模型和第二子模型。如图1中所示，在步骤101处，获取反映被检者的脑区间差异的扩散峰度成像，并且从扩散峰度成像中提取与帕金森病相关的目标参数图像。如本领域技术人员所知，扩散峰度成像是一种反映脑区间差异的磁共振成像技术，通过DKI技术对PD患者脑部结构进行量化分析，提取扩散峰度成像中与帕金森病相关的目标参数图像，以反应脑部功能连接的特征信息，从而对帕金森病危险等级进行预测。在一些实施例中，上述目标参数图像可以包括但不仅限于平均峰度图像、轴向峰度图像和径向峰度图像中至少两种。例如，前述目标参数图像还可以例如是平均弥散值或者部分各向异性值等，本申请在此方面不作限制。优选地，本申请的目标图像参数可以包括MK图像、AK图像和RK图像。基于上述获得的目标参数图像，在步骤102处，对目标参数图像执行随机赋值操作，以获得随机参数图像。在一个实现场景中，可以通过随机将目标参数图像中的一个或者多个像素点的灰度值赋值为0，以对目标参数图像执行随机赋值操作，从而获得随机参数图像。由此，获得的随机参数图像也相应的包括MK图像、AK图像和RK图像中的至少两种。接着，在步骤103处，基于目标参数图像和随机参数图像，使用第一子模型进行特征提取，以构建正例样本和反例样本。在一个实施例中，首先可以使用第一子模型分别对目标参数图像和随机参数图像进行特征提取，以获得各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量；接着基于各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量构建正例样本和反例样本。在一个实现场景中，前述第一子模型可以例如是卷积神经网络。以目标参数图像和随机参数图像为MK图像、AK图像和RK图像为例，在该场景下，通过目标参数图像和随机参数图像分别输入至卷积神经网络中进行特征提取，可以获得随机赋值操作前的MK图像、AK图像和RK图像各自对应的第一特征量以及经随机赋值操作后的MK图像、AK图像和RK图像各自对应的第二特征量。在一些实施例中，在将目标参数图像和随机参数图像输入第一子模型之前，可以对目标参数图像和随机参数图像进行预处理操作，以将每类图像处理成图像尺寸大小相同的图像。以MK图像为例，可以理解，MK指标存在于246个基于人类脑网络组划分的脑区中，对于每个脑区，可以计算MK的分布的前500阶的原点矩和中心矩。其中，任意一个分布的一阶中心矩为0，而0阶任意矩相等，即实际有意义的数据只有1000个，由此MK图像可以形成的矩阵。另外，MK指标还存在于150个基于解剖学自动标定模板划分的脑区中，由此MK图像还可以形成/＞的矩阵。结合前述两种划分方式，最终可以将MK图像处理成/＞的矩阵。与前述MK图像类似地，可以将AK图像和RK图像处理成/＞的矩阵，从而经预处理后的MK图像、AK图像和RK图像形成/＞的三通道数据。在获得各类目标参数图像和各类随机参数图像对应的第一特征量和第二特征量后，可以构建正例样本和反例样本。具体地，将目标参数图像对应的第一特征量与随机参数图像中的同种类型图像对应的第二特征量组成集合，以构建正例样本，将目标参数图像对应的第一特征量与随机参数图像中其他类型图像对应的第二特征量组成集合，以构建反例样本。也就是说，本申请实施例将目标参数图像和随机参数图像的同种类型图像对应的第一特征量和第二特征量作为正例样本，将目标参数图像对应的第一特征量与随机参数图像的不同类型图像对应的第二特征量作为反例样本。例如在一个示例性场景中，假设目标参数图像中的MK图像、AK图像和RK图像所对应的第一特征量分别记为、/＞和/＞，随机参数图像中的MK图像、AK图像和RK图像所对应的第二特征量分别记为/＞、/＞和/＞。对于MK图像而言，目标参数图像中的MK图像对应的第一特征量/＞和随机参数图像中的MK图像对应的第二特征量/＞作为正例样本；目标参数图像中的MK图像对应的第一特征量/＞和随机参数图像中的AK图像以及RK图像所对应的第二特征量、/＞作为反例样本。/＞类似地，目标参数图像中的AK图像对应的第一特征量和随机参数图像中的AK图像对应的第二特征量/＞作为正例样本；目标参数图像中的AK图像对应的第一特征量/＞和随机参数图像中的MK图像以及RK图像所对应的第二特征量/＞、/＞作为反例样本。目标参数图像中的RK图像对应的第一特征量/＞和随机参数图像中的RK图像对应的第二特征量/＞作为正例样本；目标参数图像中的RK图像对应的第一特征量/＞和随机参数图像中的MK图像以及AK图像所对应的第二特征量/＞、/＞作为反例样本。在构建上述正例样本和反例样本后，在步骤104处，根据正例样本和反例样本计算预测模型的第一损失函数。在一个实施例中，首先基于正例样本和反例样本计算相似性，以根据相似性结果计算预测模型的第一损失函数。具体而言，首先可以计算正例样本之间的相似性，例如记为；接着计算反例样本之间的相似性，例如记为sim或专用图形处理器，前述存储器402中存储有可在所述处理器上执行的程序指令。在一些实施例中，前述存储器402可以包括但不仅限于阻变式存储器RRAM、动态随机存取存储器DRAM、静态随机存取存储器SRAM、增强动态随机存取存储器EDRAM。进一步地，上述存储器402可以存储有用于对预测帕金森病危险等级进行预测的程序指令，当前述程序指令由处理器401执行时，使得装置400实现以下操作：获取反映被检者的脑区间差异的扩散峰度成像，并且从扩散峰度成像中提取与帕金森病相关的目标参数图像，以将目标参数图像输入至根据本申请实施例训练完成的预测模型进行预测，以输出对预测帕金森病危险等级的预测结果。在一个实施场景中，经预测模型可以输出帕金森病危险等级为低级、中级和高级所对应的概率，通过将概率值最大的一类确定为对预测帕金森病危险等级的预测结果。图5是示出根据本申请实施例的用于对预测帕金森病危险等级的预测模型进行训练的设备500的示例性结构框图。如图5中所示，本申请的设备可以包括中央处理器或中央处理单元511，其可以是通用CPU、专用CPU或者其他信息处理以及程序运行的执行单元。进一步，设备500还可以包括大容量存储器512和只读存储器513，其中大容量存储器512可以配置用于存储各类数据，包括各种与扩散峰度成像、目标参数图像、随机参数图像、算法数据、中间结果和运行设备500所需要的各种程序。ROM 513可以配置成存储对于设备500的加电自检、系统中各功能模块的初始化、系统的基本输入/输出的驱动程序及引导操作系统所需的数据和指令。可选地，设备500还可以包括其他的硬件平台或组件，例如示出的张量处理单元514、图形处理单元515、现场可编程门阵列516和机器学习单元517。可以理解的是，尽管在设备500中示出了多种硬件平台或组件，但这里仅仅是示例性的而非限制性的，本领域技术人员可以根据实际需要增加或移除相应的硬件。例如，设备500可以仅包括CPU、相关存储设备和接口设备来实现本申请的用于对预测帕金森病危险等级的预测模型进行训练的方法。在一些实施例中，为了便于数据与外部网络的传递和交互，本申请的设备500还包括通信接口518，从而可以通过该通信接口518连接到局域网/无线局域网505，进而可以通过该LAN/WLAN连接到本地服务器506或连接到因特网507。替代地或附加地，本申请的设备500还可以通过通信接口518基于无线通信技术直接连接到因特网或蜂窝网络，例如基于第3代、第4代或第5代的无线通信技术。在一些应用场景中，本申请的设备500还可以根据需要访问外部网络的服务器508和数据库509，以便获得各种已知的算法、数据和模块，并且可以远程地存储各种数据，例如用于呈现例如扩散峰度成像、目标参数图像、随机参数图像等的各类数据或指令。设备500的外围设备可以包括显示装置502、输入装置503和数据传输接口504。在一个实施例中，显示装置502可以例如包括一个或多个扬声器和/或一个或多个视觉显示器，其配置用于对本申请的训练预测帕金森病危险等级的预测模型进行语音提示和/或图像视频显示。输入装置503可以包括例如键盘、鼠标、麦克风、姿势捕捉相机等其他输入按钮或控件，其配置用于接收音频数据的输入和/或用户指令。数据传输接口504可以包括例如串行接口、并行接口或通用串行总线接口、小型计算机系统接口、串行ATA、火线、PCI Express和高清多媒体接口等，其配置用于与其他设备或系统的数据传输和交互。根据本申请的方案，该数据传输接口504可以接收来自于例如磁共振采集的扩散峰度成像，并且向设备500传送包括扩散峰度成像或各种其他类型的数据或结果。本申请的设备500的上述CPU 511、大容量存储器512、ROM 513、TPU 514、GPU 515、FPGA 516、MLU 517和通信接口518可以通过总线519相互连接，并且通过该总线与外围设备实现数据交互。在一个实施例中，通过该总线519，CPU 511可以控制设备500中的其他硬件组件及其外围设备。以上结合图5描述了可以用于执行本申请的用于对预测帕金森病危险等级的预测模型进行训练的设备。需要理解的是这里的设备结构或架构仅仅是示例性的，本申请的实现方式和实现实体并不受其限制，而是可以在不偏离本申请的精神下做出改变。根据上述结合附图的描述，本领域技术人员也可以理解本申请的实施例还可以通过软件程序来实现。由此本申请还提供了一种计算机可读存储介质。该计算机可读存储介质可以用于实现本申请结合附图1所描述的用于对预测帕金森病危险等级的预测模型进行训练的方法以及结合图4所描述的用于对预测帕金森病危险等级进行预测的装置所执行的操作。应当注意，尽管在附图中以特定顺序描述了本申请方法的操作，但是这并非要求或者暗示必须按照该特定顺序来执行这些操作，或是必须执行全部所示的操作才能实现期望的结果。相反，流程图中描绘的步骤可以改变执行顺序。附加地或备选地，可以省略某些步骤，将多个步骤合并为一个步骤执行，和/或将一个步骤分解为多个步骤执行。应当理解，当本申请的权利要求、当说明书及附图中使用到术语“第一”、“第二”、“第三”和“第四”等时，其仅用于区别不同对象，而不是用于描述特定顺序。本申请的说明书和权利要求书中使用的术语“包括”和“包含”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。还应当理解，在此本申请说明书中所使用的术语仅仅是出于描述特定实施例的目的，而并不意在限定本申请。如在本申请说明书和权利要求书中所使用的那样，除非上下文清楚地指明其它情况，否则单数形式的“一”、“一个”及“该”意在包括复数形式。还应当进一步理解，在本申请说明书和权利要求书中使用的术语“和/或”是指相关联列出的项中的一个或多个的任何组合以及所有可能组合，并且包括这些组合。虽然本申请的实施方式如上，但所述内容只是为便于理解本申请而采用的实施例，并非用以限定本申请的范围和应用场景。任何本申请所述技术领域内的技术人员，在不脱离本申请所揭露的精神和范围的前提下，可以在实施的形式上及细节上作任何的修改与变化，但本申请的专利保护范围，仍须以所附的权利要求书所界定的范围为准。
