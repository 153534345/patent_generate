标题title
融入测地线投票算法的深度学习网络的血管分割方法
摘要abst
一种融入测地线投票算法的深度学习网络的血管分割方法，将增强后的数据集输入到编码器中进行特征提取，同时通过测地线投票算法计算测地线密度，得到测地线密度特征权重，将测地线密度特征权重与编码器提取的特征进行特征融合，通过解码器解码，最终完成冠状动脉血管的分割。结合了深度学习模型与测地线投票算法的优点，即克服了使用测地线投票算法进行血管分割时的阴影域问题，又克服了深度学习网络分割血管时血管不连续、缺乏几何信息等问题，提高了血管分割的准确性与鲁棒性。在使用深度学习网络进行血管分割时，通过融合测地线投票算法进行特征补偿，有效地克服深度学习网络分割中存在的不准确和漏检部分，得到更准确的血管分割结果。
权利要求书clms
1.一种融入测地线投票算法的深度学习网络的血管分割方法，其特征在于，包括如下步骤：a)收集n张冠状动脉造影图像，得到数据集D′，D′＝{D′1,D′2,...,D′i,...,D′n}，D′i为第i张冠状动脉造影图像，i∈{1,2,...,n}；b)对数据集D′进行数据集增强操作，得到增强后的数据集D，D＝{D1,D2,...,Di,...,Dn}，Di为第i张增强后的冠状动脉造影图像；c)将增强后的数据集D划分为训练集train、验证集val、测试集test；d)建立血管分割网络模型，血管分割网络模型由编码器、中间结构层、解码器构成；e)将训练集train中第i张增强后的冠状动脉造影图像Di输入到血管分割网络模型的编码器，输出得到特征图及特征图/＞f)将特征图输入到血管分割网络模型的中间结构层中，输出得到特征图Dc；g)将特征图及特征图Dc输入到血管分割网络模型的解码器中，输出得到分割图像IEND；h)利用SGD优化器通过反向传播法，使用损失函数L优化血管分割网络模型，得到训练后的血管分割网络模型；i)将测试集test中第i张增强后的冠状动脉造影图像Di输入到训练后的血管分割网络模型中，输出得到分割图像I′END。2.根据权利要求1所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于：步骤a)中从ARCADE公开挑战赛中收集300名患者的冠状动脉造影图像，得到数据集D′。3.根据权利要求1所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于：步骤b)中在python中导入Albumentations工具包，对数据集D′中的冠状动脉造影图像依次进行翻转、随机仿射变换、增强饱和度操作，得到增强后的数据集D。4.根据权利要求1所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于：步骤c)中将增强后的数据集D按7:1:2的比例划分为训练集train、验证集val、测试集test。5.根据权利要求1所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于，步骤e)包括如下步骤：e-1)血管分割网络模型的编码器由第一卷积单元、第二卷积单元、第一最大池化层、第三卷积单元、第四卷积单元、第二最大池化层、第五卷积单元、第六卷积单元、第三最大池化层、第七卷积单元、第八卷积单元、第四最大池化层构成；e-2)编码器的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将训练集train中第i张增强后的冠状动脉造影图像Di输入到第一卷积单元中，输出得到特征图e-3)编码器的第二卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第二卷积单元中，输出得到特征图/＞e-4)将特征图输入到编码器的第一最大池化层中，输出得到特征图/＞将训练集train中第i张增强后的冠状动脉造影图像Di输入到编码器的第一最大池化层中，输出得到特征图/＞e-5)编码器的第三卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第三卷积单元中，输出得到特征图/＞e-6)编码器的第四卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第四卷积单元中，输出得到特征图/＞e-7)将特征图输入到编码器的第二最大池化层中，输出得到特征图/＞将特征图输入到编码器的第二最大池化层中，输出得到特征图/＞e-8)编码器的第五卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第五卷积单元中，输出得到特征图/＞e-9)编码器的第六卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第六卷积单元中，输出得到特征图/＞e-10)将特征图输入到编码器的第三最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第三最大池化层中，输出得到特征图/＞e-11)编码器的第七卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第七卷积单元中，输出得到特征图/＞e-12)编码器的第八卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第八卷积单元中，输出得到特征图/＞e-13)将特征图输入到编码器的第四最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第四最大池化层中，输出得到特征图/＞6.根据权利要求5所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于，步骤f)包括如下步骤：f-1)血管分割网络模型的中间结构层由第一卷积单元、第二卷积单元构成；f-2)中间结构层的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第一卷积单元中，输出得到特征图/＞f-3)中间结构层的第二卷积单元依次由卷积层、BatchNorm层、Dropout层构成，将特征图输入到第二卷积单元中，输出得到特征图Dc。7.根据权利要求6所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于，步骤g)包括如下步骤：g-1)血管分割网络模型的解码器由第一测地线投票算法模块、第一上采样层、第一特征融合层、第一卷积单元、第二卷积单元、第二测地线投票算法模块、第二上采样层、第二特征融合层、第三卷积单元、第四卷积单元、第三测地线投票算法模块、第三上采样层、第三特征融合层、第五卷积单元、第六卷积单元、第四测地线投票算法模块、第四上采样层、第四特征融合层、第七卷积单元、第八卷积单元、第九卷积单元构成；g-2)解码器的第一测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图剪裁至与特征图Dc同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图选取特征点图/＞边界上所有的点生成点集S1，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x1作为测地线投票算法的源点，将特征点x1与点集S1利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图/＞输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图与特征图Dc输入到特征融合层中，将测地线密度系数特征图/＞与特征图Dc采用对应像素相乘的方式进行特征融合，得到特征图/＞g-3)将特征图/＞输入到解码器的第一上采样层中，输出得到特征图/＞g-4)将特征图/＞与特征图/＞输入到第一特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-5)解码器的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第一卷积单元中，输出得到特征图/＞g-6)解码器的第二卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第二卷积单元中，输出得到特征图/＞g-7)解码器的第二测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S2，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x2作为测地线投票算法的源点，将特征点x2与点集S2利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图采用对应像素相乘的方式进行特征融合，得到特征图/＞g-8)将特征图/＞输入到解码器的第二上采样层中，输出得到特征图/＞g-9)将特征图/＞与特征图/＞输入到第二特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图g-10)解码器的第三卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第三卷积单元中，输出得到特征图/＞g-11)解码器的第四卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第四卷积单元中，输出得到特征图/＞g-12)解码器的第三测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S3，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x3作为测地线投票算法的源点，将特征点x3与点集S3利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图/＞采用对应像素相乘的方式进行特征融合，得到特征图/＞g-13)将特征图/＞输入到解码器的第三上采样层中，输出得到特征图/＞g-14)将特征图/＞与特征图/＞输入到第三特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-15)解码器的第五卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第五卷积单元中，输出得到特征图/＞g-16)解码器的第六卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第四卷积单元中，输出得到特征图/＞g-17)解码器的第四测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S4，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x4作为测地线投票算法的源点，将特征点x4与点集S4利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图采用对应像素相乘的方式进行特征融合，得到特征图/＞g-18)将特征图/＞输入到解码器的第四上采样层中，输出得到特征图/＞g-19)将特征图/＞与特征图/＞输入到第四特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图g-20)解码器的第七卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第七卷积单元中，输出得到特征图/＞g-21)解码器的第八卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第八卷积单元中，输出得到特征图/＞g-22)解码器的第九卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第九卷积单元中，输出得到分割图像IEND。8.根据权利要求7所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于：步骤e-2)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-3)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-4)中第一最大池化层的池化窗口为2×2；步骤e-5)中第三卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-6)中第四卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-7)中第二最大池化层的池化窗口为2×2；步骤e-8)中第五卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-9)中第六卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-10)中第三最大池化层的池化窗口为2×2；步骤e-11)中第七卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-12)中第八卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-13)中第四最大池化层的池化窗口为2×2；步骤f-2)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤f-3)中第二卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-3)中第一上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-5)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-6)中第二卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-8)中第二上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-10)中第三卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-11)中第四卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-13)中第三上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-15)中第五卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-16)中第六卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-18)中第四上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-20)中第七卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-21)中第八卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-22)中第八卷积单元的卷积层的卷积核大小为1×1、stride为1×1、padding为0。9.根据权利要求1所述的融入测地线投票算法的深度学习网络的血管分割方法，其特征在于：步骤h)中通过公式L＝LDice+LBCE计算得到损失函数L，式中，LDice为Dice损失，LBCE为交叉熵损失。
说明书desc
技术领域本发明设计医学图像处理领域，具体涉及一种融入测地线投票算法的深度学习网络的血管分割方法。背景技术医学影像处理中的血管分割任务对疾病的诊断和治疗具有重要意义，可分为传统方法和基于深度学习的方法传统方法包括基于阈值、基于滤波器、基于形态学和基于机器学习等方法。这些方法通常基于先验知识或手工设计的特征，如血管的亮度、形状、纹理等，以及一些图像处理技术，如边缘检测、区域生长、二值化等，来提取血管并进行分割。如Chen等人使用最小路径模型对血管分割取得了不错的效果。然而，传统方法的效果通常受到图像噪声、伪影等干扰因素的影响，且对于复杂的血管结构和形态变化较大的图像效果较差。深度学习在医学影像分析领域的应用取得了重要进展，利用深度神经网络模型自动学习特征并实现血管分割。深度学习方法通常可以处理更加复杂的血管结构，且在噪声和伪影等干扰因素存在的情况下，仍能保持较好的分割效果。如Mishra等人,Nice,France,2021,pp.453-457,doi:10.1109/ISBI48211.2021.9433774.)使用CNN网络对眼底图像微血管进行分割，得到了良好的效果。深度学习已经成为血管分割领域的主流方法之一，但其黑盒模型难以解释决策过程，可能带来医学诊断等应用上的风险因此，在选择血管分割方法时需要权衡各种因素，并根据具体应用场景选择适合的方法。发明内容本发明为了克服以上技术的不足，提供了一种从质量差、复杂度高的XRA图像中提取连续、完整的血管轮廓的方法。本发明克服其技术问题所采用的技术方案是：一种融入测地线投票算法的深度学习网络的血管分割方法，包括如下步骤：a)收集n张冠状动脉造影图像，得到数据集D′，D′＝{D′1,D′2,...,D′i,...,D′n}，D′i为第i张冠状动脉造影图像，i∈{1,2,...,n}；b)对数据集D′进行数据集增强操作，得到增强后的数据集D，D＝{D1,D2,...,Di,...,Dn}，Di为第i张增强后的冠状动脉造影图像；c)将增强后的数据集D划分为训练集train、验证集val、测试集test；d)建立血管分割网络模型，血管分割网络模型由编码器、中间结构层、解码器构成；e)将训练集train中第i张增强后的冠状动脉造影图像Di输入到血管分割网络模型的编码器，输出得到特征图及特征图/＞f)将特征图输入到血管分割网络模型的中间结构层中，输出得到特征图Dc；g)将特征图及特征图Dc输入到血管分割网络模型的解码器中，输出得到分割图像IEND；h)利用SGD优化器通过反向传播法，使用损失函数L优化血管分割网络模型，得到训练后的血管分割网络模型；i)将测试集test中第i张增强后的冠状动脉造影图像Di输入到训练后的血管分割网络模型中，输出得到分割图像I′END。进一步的，步骤a)中从ARCADE公开挑战赛中收集300名患者的冠状动脉造影图像，得到数据集D′。进一步的，步骤b)中在python中导入Albumentations工具包，对数据集D′中的冠状动脉造影图像依次进行翻转、随机仿射变换、增强饱和度操作，得到增强后的数据集D。优选的，步骤c)中将增强后的数据集D按7:1:2的比例划分为训练集train、验证集val、测试集test。进一步的，步骤e)包括如下步骤：e-1)血管分割网络模型的编码器由第一卷积单元、第二卷积单元、第一最大池化层、第三卷积单元、第四卷积单元、第二最大池化层、第五卷积单元、第六卷积单元、第三最大池化层、第七卷积单元、第八卷积单元、第四最大池化层构成；e-2)编码器的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将训练集train中第i张增强后的冠状动脉造影图像Di输入到第一卷积单元中，输出得到特征图e-3)编码器的第二卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第二卷积单元中，输出得到特征图/＞e-4)将特征图/＞输入到编码器的第一最大池化层中，输出得到特征图/＞将训练集train中第i张增强后的冠状动脉造影图像Di输入到编码器的第一最大池化层中，输出得到特征图/＞e-5)编码器的第三卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第三卷积单元中，输出得到特征图/＞e-6)编码器的第四卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第四卷积单元中，输出得到特征图/＞e-7)将特征图/＞输入到编码器的第二最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第二最大池化层中，输出得到特征图/＞e-8)编码器的第五卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第五卷积单元中，输出得到特征图/＞e-9)编码器的第六卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第六卷积单元中，输出得到特征图/＞e-10)将特征图/＞输入到编码器的第三最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第三最大池化层中，输出得到特征图/＞e-11)编码器的第七卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第七卷积单元中，输出得到特征图/＞e-12)编码器的第八卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第八卷积单元中，输出得到特征图/＞e-13)将特征图/＞输入到编码器的第四最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第四最大池化层中，输出得到特征图/＞进一步的，步骤f)包括如下步骤：f-1)血管分割网络模型的中间结构层由第一卷积单元、第二卷积单元构成；f-2)中间结构层的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第一卷积单元中，输出得到特征图/＞f-3)中间结构层的第二卷积单元依次由卷积层、BatchNorm层、Dropout层构成，将特征图/＞输入到第二卷积单元中，输出得到特征图Dc。进一步的，步骤g)包括如下步骤：g-1)血管分割网络模型的解码器由第一测地线投票算法模块、第一上采样层、第一特征融合层、第一卷积单元、第二卷积单元、第二测地线投票算法模块、第二上采样层、第二特征融合层、第三卷积单元、第四卷积单元、第三测地线投票算法模块、第三上采样层、第三特征融合层、第五卷积单元、第六卷积单元、第四测地线投票算法模块、第四上采样层、第四特征融合层、第七卷积单元、第八卷积单元、第九卷积单元构成；g-2)解码器的第一测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图剪裁至与特征图Dc同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S1，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x1作为测地线投票算法的源点，将特征点x1与点集S1利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图Dc输入到特征融合层中，将测地线密度系数特征图/＞与特征图Dc采用对应像素相乘的方式进行特征融合，得到特征图/＞g-3)将特征图/＞输入到解码器的第一上采样层中，输出得到特征图/＞g-4)将特征图/＞与特征图/＞输入到第一特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-5)解码器的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第一卷积单元中，输出得到特征图/＞g-6)解码器的第二卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第二卷积单元中，输出得到特征图/＞g-7)解码器的第二测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图/＞剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S2，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x2作为测地线投票算法的源点，将特征点x2与点集S2利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图/＞输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图/＞采用对应像素相乘的方式进行特征融合，得到特征图/＞g-8)将特征图输入到解码器的第二上采样层中，输出得到特征图/＞g-9)将特征图/＞与特征图输入到第二特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-10)解码器的第三卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第三卷积单元中，输出得到特征图/＞g-11)解码器的第四卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第四卷积单元中，输出得到特征图/＞g-12)解码器的第三测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图/＞剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S3，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x3作为测地线投票算法的源点，将特征点x3与点集S3利用测地线投票算法计算生成测地线密度特征图将测地线密度特征图/＞输入到Sigmoid函数中，输出得到测地线密度系数特征图将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图/＞采用对应像素相乘的方式进行特征融合，得到特征图g-13)将特征图/＞输入到解码器的第三上采样层中，输出得到特征图/＞g-14)将特征图/＞与特征图/＞输入到第三特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-15)解码器的第五卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第五卷积单元中，输出得到特征图g-16)解码器的第六卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第四卷积单元中，输出得到特征图/＞g-17)解码器的第四测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图/＞剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S4，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x4作为测地线投票算法的源点，将特征点x4与点集S4利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图/＞输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图/＞采用对应像素相乘的方式进行特征融合，得到特征图/＞g-18)将特征图/＞输入到解码器的第四上采样层中，输出得到特征图/＞g-19)将特征图/＞与特征图/＞输入到第四特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-20)解码器的第七卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第七卷积单元中，输出得到特征图/＞g-21)解码器的第八卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第八卷积单元中，输出得到特征图/＞g-22)解码器的第九卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第九卷积单元中，输出得到分割图像IEND。优选的，步骤e-2)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-3)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-4)中第一最大池化层的池化窗口为2×2；步骤e-5)中第三卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-6)中第四卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-7)中第二最大池化层的池化窗口为2×2；步骤e-8)中第五卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-9)中第六卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-10)中第三最大池化层的池化窗口为2×2；步骤e-11)中第七卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-12)中第八卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-13)中第四最大池化层的池化窗口为2×2；步骤f-2)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤f-3)中第二卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-3)中第一上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-5)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-6)中第二卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-8)中第二上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-10)中第三卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-11)中第四卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-13)中第三上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-15)中第五卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-16)中第六卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-18)中第四上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-20)中第七卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-21)中第八卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-22)中第八卷积单元的卷积层的卷积核大小为1×1、stride为1×1、padding为0。进一步的，步骤h)中通过公式L＝LDice+LBCE计算得到损失函数L，式中，LDice为Dice损失，LBCE为交叉熵损失。本发明的有益效果是：提供了一种融合测地线投票算法的类U-Net网络，通过将测地线投票算法得到的测地线密度转换为特征权重，融入到编码器提取到的特征中，使得传统血管分割方法与深度学习方法得到了充分的融合。首先，将增强后的数据集输入到编码器中进行特征提取，同时通过测地线投票算法计算测地线密度，得到测地线密度特征权重，将测地线密度特征权重与编码器提取的特征进行特征融合，通过解码器解码，最终完成冠状动脉血管的分割。结合了深度学习模型与测地线投票算法的优点，即克服了使用测地线投票算法进行血管分割时的阴影域问题，又克服了深度学习网络分割血管时血管不连续、缺乏几何信息等问题，提高了血管分割的准确性与鲁棒性。在使用深度学习网络进行血管分割时，通过融合测地线投票算法进行特征补偿，有效地克服深度学习网络分割中存在的不准确和漏检部分，得到更准确的血管分割结果。附图说明图1为本发明的血管分割网络模型的结构图；图2为本发明的测地线投票算法模块的结构图。具体实施方式下面结合附图1、附图2对本发明做进一步说明。一种融入测地线投票算法的深度学习网络的血管分割方法，包括如下步骤：a)收集n张冠状动脉造影图像，得到数据集D′，D′＝{D′1,D′2,...,D′i,...,D′n}，D′i为第i张冠状动脉造影图像，i∈{1,2,...,n}。b)对数据集D′进行数据集增强操作，得到增强后的数据集D，D＝{D1,D2,...,Di,...,Dn}，Di为第i张增强后的冠状动脉造影图像。c)将增强后的数据集D划分为训练集train、验证集val、测试集test。d)建立血管分割网络模型，血管分割网络模型由编码器、中间结构层、解码器构成。e)将训练集train中第i张增强后的冠状动脉造影图像Di输入到血管分割网络模型的编码器，输出得到特征图及特征图/＞f)将特征图输入到血管分割网络模型的中间结构层中，输出得到特征图Dc。g)将特征图/＞及特征图Dc输入到血管分割网络模型的解码器中，输出得到分割图像IEND。h)利用SGD优化器通过反向传播法，使用损失函数L优化血管分割网络模型，得到训练后的血管分割网络模型。i)将测试集test中第i张增强后的冠状动脉造影图像Di输入到训练后的血管分割网络模型中，完成冠状动脉血管的分割，输出得到分割图像I′END，可以将分割图像保存为jpg格式的文件。本发明结合了几何模型中的测地线投票算法与深度学习网络，从质量差、复杂度高的XRA图像中提取出连续、完整的血管轮廓。其中，使用Harris角点检测器生成角点特征图，计算测地线密度权重特征图。XRA图像在类U-Net网络中进行特征提取。然后将测地线密度权重特征图与类U-Net网络提取到的特征进行特征融合，最后完成血管的分割。本发明结合了深度学习模型与测地线投票算法的优点，即克服了使用测地线投票算法进行血管分割时的阴影域问题，又克服深度学习网络分割血管时血管不连续、缺乏几何信息等问题，提高了血管分割的准确性与鲁棒性。在使用深度学习网络进行血管分割时，通过融合测地线投票算法进行特征补偿，有效地克服深度学习网络分割中存在的不准确和漏检部分，得到更准确的血管分割结果。实施例1：步骤a)中从ARCADE公开挑战赛中收集300名患者的冠状动脉造影图像，得到数据集D′。:步骤b)中在python中导入Albumentations工具包，对数据集D′中的冠状动脉造影图像依次进行翻转、随机仿射变换、增强饱和度操作，得到增强后的数据集D。步骤c)中将增强后的数据集D按7:1:2的比例划分为训练集train、验证集val、测试集test。实施例2：步骤e)包括如下步骤：e-1)血管分割网络模型的编码器由第一卷积单元、第二卷积单元、第一最大池化层、第三卷积单元、第四卷积单元、第二最大池化层、第五卷积单元、第六卷积单元、第三最大池化层、第七卷积单元、第八卷积单元、第四最大池化层构成。e-2)编码器的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将训练集train中第i张增强后的冠状动脉造影图像Di输入到第一卷积单元中，输出得到特征图e-3)编码器的第二卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第二卷积单元中，输出得到特征图/＞e-4)将特征图/＞输入到编码器的第一最大池化层中，输出得到特征图/＞将训练集train中第i张增强后的冠状动脉造影图像Di输入到编码器的第一最大池化层中，输出得到特征图/＞e-5)编码器的第三卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第三卷积单元中，输出得到特征图/＞e-6)编码器的第四卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第四卷积单元中，输出得到特征图/＞e-7)将特征图/＞输入到编码器的第二最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第二最大池化层中，输出得到特征图/＞e-8)编码器的第五卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第五卷积单元中，输出得到特征图/＞e-9)编码器的第六卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第六卷积单元中，输出得到特征图/＞e-10)将特征图/＞输入到编码器的第三最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第三最大池化层中，输出得到特征图/＞e-11)编码器的第七卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第七卷积单元中，输出得到特征图/＞e-12)编码器的第八卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第八卷积单元中，输出得到特征图/＞e-13)将特征图/＞输入到编码器的第四最大池化层中，输出得到特征图/＞将特征图/＞输入到编码器的第四最大池化层中，输出得到特征图/＞实施例3：步骤f)包括如下步骤：f-1)血管分割网络模型的中间结构层由第一卷积单元、第二卷积单元构成。f-2)中间结构层的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第一卷积单元中，输出得到特征图/＞f-3)中间结构层的第二卷积单元依次由卷积层、BatchNorm层、Dropout层构成，将特征图/＞输入到第二卷积单元中，输出得到特征图Dc。实施例4：步骤g)包括如下步骤：g-1)血管分割网络模型的解码器由第一测地线投票算法模块、第一上采样层、第一特征融合层、第一卷积单元、第二卷积单元、第二测地线投票算法模块、第二上采样层、第二特征融合层、第三卷积单元、第四卷积单元、第三测地线投票算法模块、第三上采样层、第三特征融合层、第五卷积单元、第六卷积单元、第四测地线投票算法模块、第四上采样层、第四特征融合层、第七卷积单元、第八卷积单元、第九卷积单元构成。g-2)解码器的第一测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图剪裁至与特征图Dc同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S1，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x1作为测地线投票算法的源点，将特征点x1与点集S1利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图Dc输入到特征融合层中，将测地线密度系数特征图/＞与特征图Dc采用对应像素相乘的方式进行特征融合，得到特征图/＞g-3)将特征图/＞输入到解码器的第一上采样层中，输出得到特征图/＞g-4)将特征图/＞与特征图/＞输入到第一特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-5)解码器的第一卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图输入到第一卷积单元中，输出得到特征图/＞g-6)解码器的第二卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第二卷积单元中，输出得到特征图/＞g-7)解码器的第二测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图/＞剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S2，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x2作为测地线投票算法的源点，将特征点x2与点集S2利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图/＞输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图/＞采用对应像素相乘的方式进行特征融合，得到特征图/＞g-8)将特征图输入到解码器的第二上采样层中，输出得到特征图/＞g-9)将特征图/＞与特征图输入到第二特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-10)解码器的第三卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第三卷积单元中，输出得到特征图/＞g-11)解码器的第四卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第四卷积单元中，输出得到特征图/＞g-12)解码器的第三测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图/＞剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S3，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x3作为测地线投票算法的源点，将特征点x3与点集S3利用测地线投票算法计算生成测地线密度特征图将测地线密度特征图/＞输入到Sigmoid函数中，输出得到测地线密度系数特征图将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图/＞采用对应像素相乘的方式进行特征融合，得到特征图/＞g-13)将特征图/＞输入到解码器的第三上采样层中，输出得到特征图/＞g-14)将特征图/＞与特征图/＞输入到第三特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-15)解码器的第五卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第五卷积单元中，输出得到特征图g-16)解码器的第六卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第四卷积单元中，输出得到特征图/＞g-17)解码器的第四测地线投票算法模块由特征点检测层、测地线密度计算层、特征融合层构成，将特征图/＞剪裁至与特征图/＞同等大小，得到特征图/＞将特征图/＞输入到特征点检测层中，特征图/＞通过Harris角点检测器检测其中的特征点，得到特征点图/＞选取特征点图/＞边界上所有的点生成点集S4，将特征点图/＞输入到测地线密度计算层中，从特征点图/＞中随机选取一特征点x4作为测地线投票算法的源点，将特征点x4与点集S4利用测地线投票算法计算生成测地线密度特征图/＞将测地线密度特征图/＞输入到Sigmoid函数中，输出得到测地线密度系数特征图/＞将测地线密度系数特征图/＞与特征图/＞输入到特征融合层中，将测地线密度系数特征图/＞与特征图/＞采用对应像素相乘的方式进行特征融合，得到特征图/＞g-18)将特征图/＞输入到解码器的第四上采样层中，输出得到特征图/＞g-19)将特征图/＞与特征图/＞输入到第四特征融合层中，特征图/＞与特征图/＞以通道叠加的方式进行特征融合，得到特征图/＞g-20)解码器的第七卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第七卷积单元中，输出得到特征图/＞g-21)解码器的第八卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第八卷积单元中，输出得到特征图/＞g-22)解码器的第九卷积单元依次由卷积层、BatchNorm层、Relu激活函数构成，将特征图/＞输入到第九卷积单元中，输出得到分割图像IEND。优选的，步骤e-2)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-3)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-4)中第一最大池化层的池化窗口为2×2；步骤e-5)中第三卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-6)中第四卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-7)中第二最大池化层的池化窗口为2×2；步骤e-8)中第五卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-9)中第六卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-10)中第三最大池化层的池化窗口为2×2；步骤e-11)中第七卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-12)中第八卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤e-13)中第四最大池化层的池化窗口为2×2；步骤f-2)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤f-3)中第二卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-3)中第一上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-5)中第一卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-6)中第二卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-8)中第二上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-10)中第三卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-11)中第四卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-13)中第三上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-15)中第五卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-16)中第六卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-18)中第四上采样层的反卷积核大小为2×2、stride为2×2、padding为0；步骤g-20)中第七卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-21)中第八卷积单元的卷积层的卷积核大小为3×3、stride为1×1、padding为0；步骤g-22)中第八卷积单元的卷积层的卷积核大小为1×1、stride为1×1、padding为0。实施例5：步骤h)中通过公式L＝LDice+LBCE计算得到损失函数L，式中，LDice为Dice损失，LBCE为交叉熵损失。最后应说明的是：以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
