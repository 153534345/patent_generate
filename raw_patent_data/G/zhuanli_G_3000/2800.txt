标题title
3C金属加工中圆弧与圆弧平滑过渡的方法及系统
摘要abst
本发明提供了3C金属加工中圆弧与圆弧平滑过渡的方法及系统，该方法包括：步骤1：获取相连的两条圆弧插补指令；步骤2：判断相连的两条圆弧插补指令首尾偏转角的大小是否在预设的范围内，若首尾偏转角的大小在预设的范围内，则执行步骤3；步骤3：构造贝塞尔过渡曲线；步骤4：将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列。本发明通过对相连的两条圆弧指令的首尾偏转角进行判断，对需要进行平滑过渡的相连的圆弧，构造贝塞尔过渡曲线，保证圆弧与圆弧之间能够平滑过渡，达到提高工件表面光洁度的效果，提高产品的加工质量和加工精度；在加工过程中无需进行频繁的降速，保证良好的加工速度。
权利要求书clms
1.3C金属加工中圆弧与圆弧平滑过渡的方法，其特征在于，包括以下步骤：步骤1：获取相连的两条圆弧插补指令；步骤2：判断相连的两条圆弧插补指令首尾偏转角的大小是否在预设的范围内，若首尾偏转角的大小在预设的范围内，则执行步骤3；步骤3：构造贝塞尔过渡曲线；步骤4：将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列。2.根据权利要求1所述的3C金属加工中圆弧与圆弧平滑过渡的方法，其特征在于，所述步骤1中，获取相连的两条圆弧插补指令包括以下步骤：步骤1.1：读取第i条运动指令，i＝1、2、3……；步骤1.2：判断当前运动指令是否为圆弧插补指令，若当前运动指令是圆弧插补命令，则执行步骤1.3；若当前运动指令不是圆弧插补命令，则执行步骤1.6；步骤1.3：将当前运动指令存入缓存；步骤1.4：判断缓存中的指令数量，若当前缓存中指令数量为一，则返回执行步骤1.1，此时i＝i+1，若当前缓存中指令数量为二，则执行步骤1.5；步骤1.5：得到相连的两条圆弧插补指令；步骤1.6：判断缓存中是否已存在运动指令，若已存在运动指令，执行步骤1.7，若不存在运动指令，执行步骤1.8；步骤1.7：将缓存中已存在的运动指令与当前运动指令依次输出到运动队列；步骤1.8：将当前运动指令输出到运动队列。3.根据权利要求1所述的3C金属加工中圆弧与圆弧平滑过渡的方法，其特征在于，所述步骤2中，首尾偏转角是指相连的两条圆弧插补指令形成的拐角，首尾偏转角的预设范围为0-90°。4.根据权利要求1所述的3C金属加工中圆弧与圆弧平滑过渡的方法，其特征在于，所述步骤3中，构造贝塞尔过渡曲线包括以下步骤：设在先的圆弧插补指令起点为F，终点为B，圆弧FB的圆心为D，在后的圆弧插补指令起点为B，终点为C，圆弧BC的圆心为A；步骤3.1：在圆弧FB上确定点H，在圆弧BC上确定点E，使∠HDB＝∠BAE＝预设初始值；步骤3.2：过点H做圆弧FB的切线，过点B做圆弧FB的切线，确定两条切线的交点I；过点E做圆弧BC的切线，过点B做圆弧BC的切线，确定两条切线的交点G；步骤3.3：以点H、点I、点B、点G和点E作为贝塞尔曲线的五个控制点，计算贝塞尔过渡曲线a；步骤3.4：计算贝塞尔过渡曲线与原始轨迹之间的最大误差；步骤3.5：判断最大误差与预设的误差阈值之间的大小关系，若最大误差等于预设的误差阈值，则无需对贝塞尔曲线进行处理，若最大误差不等于预设的误差阈值，则返回执行步骤3.1，并调整∠HDB和∠BAE的大小。5.根据权利要求4所述的3C金属加工中圆弧与圆弧平滑过渡的方法，其特征在于，当最大误差小于预设的误差阈值时，返回执行步骤3.1时，∠HDB＝∠BAE＞预设初始值；当最大误差大于预设的误差阈值时，返回执行步骤3.1时，∠HDB＝∠BAE＜预设初始值。6.根据权利要求4所述的3C金属加工中圆弧与圆弧平滑过渡的方法，其特征在于，所述步骤4中，将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列包括以下步骤：步骤4.1：用贝塞尔过渡曲线替代圆弧HB和圆弧BE；步骤4.2：依次将圆弧FH、贝塞尔过渡曲线a和圆弧EC输出到运动队列。7.3C金属加工中圆弧与圆弧平滑过渡的系统，用于执行权利要求1-6任一所述的3C金属加工中圆弧与圆弧平滑过渡的方法，其特征在于，包括，圆弧指令获取模块，用于获取相连的两条圆弧插补指令；首尾偏转角判断模块，用于判断相连的两条圆弧插补指令首尾偏转角的大小是否在预设的范围内；贝塞尔过渡曲线构造模块，用于构造贝塞尔过渡曲线；运动指令输出模块，用于将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列。8.根据权利要求7所述的3C金属加工中圆弧与圆弧平滑过渡的系统，其特征在于，在贝塞尔过渡曲线构造模块中包括：控制点确定单元，用于确定贝塞尔曲线中的五个控制点；贝塞尔过渡曲线计算单元，用于根据确定的五个控制点计算贝塞尔过渡曲线；最大误差计算单元，用于计算贝塞尔过渡曲线与原始轨迹之间的最大误差；圆心角调整单元，用于判断最大误差与预设的误差阈值之间的大小关系，若最大误差不等于预设的误差阈值，调整∠HDB和∠BAE的大小。9.一种3C金属加工中圆弧与圆弧平滑过渡的设备，其特征在于，所述设备包括处理器和存储器，所述存储器中存储有至少一条指令、至少一段程序、代码集或指令集，所述至少一条指令、所述至少一段程序、代码集或指令集由所述处理器加载并执行以实现如权利要求1-6任一所述的3C金属加工中圆弧与圆弧平滑过渡的方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有至少一条指令、至少一段程序、代码集或指令集，所述至少一条指令、所述至少一段程序、所述代码集或指令集由处理器加载并执行以实现权利要求1-6任一所述的3C金属加工中圆弧与圆弧平滑过渡的方法。
说明书desc
技术领域本发明涉及数控加工技术领域，尤其涉及3C金属加工中圆弧与圆弧平滑过渡的方法及系统。背景技术目前，在3C金属加工中，关于G01和G01直线之间平滑过渡，可以采用的方法有抛物线、贝塞尔曲线和样条曲线等等，其目的是提高加工路径的几何连续性，从而减小单轴速度的波动，抑制了单轴加速度的大小，以达到提高工件表面光洁度的目的。然而，以上方法都无法解决圆弧与圆弧之间的平滑过渡。目前在加工中常使用的圆弧与圆弧之间的过渡方法是，在圆弧与圆弧转角的时候，根据角度降速，这会导致加工速度变慢，加工效果变差。发明内容本发明针对上述问题，提出3C金属加工中圆弧与圆弧平滑过渡的方法及系统。为了解决上述技术问题中的至少一个，本发明提出如下技术方案：第一方面，提供了3C金属加工中圆弧与圆弧平滑过渡的方法，该方法包括以下步骤：步骤1：获取相连的两条圆弧插补指令；步骤2：判断相连的两条圆弧插补指令首尾偏转角的大小是否在预设的范围内，若首尾偏转角的大小在预设的范围内，则执行步骤3；步骤3：构造贝塞尔过渡曲线；步骤4：将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列。第二方面，提供了3C金属加工中圆弧与圆弧平滑过渡的系统，用于执行上述任一3C金属加工中圆弧与圆弧平滑过渡的方法，该系统包括：圆弧指令获取模块，用于获取相连的两条圆弧插补指令；首尾偏转角判断模块，用于判断相连的两条圆弧插补指令首尾偏转角的大小是否在预设的范围内；贝塞尔过渡曲线构造模块，用于构造贝塞尔过渡曲线；运动指令输出模块，用于将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列。第三方面，提供了一种3C金属加工中圆弧与圆弧平滑过渡的设备，该设备包括至少一个处理器，以及与至少一个处理器通信连接的存储器，其中，存储器中存储有至少一条指令、至少一段程序、代码集或指令集，至少一条指令、至少一段程序、代码集或指令集由处理器加载并执行本发明上述任一的3C金属加工中圆弧与圆弧平滑过渡的方法。第四方面，提供了一种计算机可读存储介质，该计算机可读存储介质中存储有至少一条指令、至少一段程序、代码集或指令集，至少一条指令、至少一段程序、代码集或指令集由处理器加载并执行本发明上述任一的3C金属加工中圆弧与圆弧平滑过渡的方法。本发明的有益效果是，通过对相连的两条圆弧指令的首尾偏转角进行判断，对需要进行平滑过渡的相连的圆弧，构造贝塞尔过渡曲线，保证圆弧与圆弧之间能够平滑过渡，达到提高工件表面光洁度的效果，提高产品的加工质量和加工精度；在加工过程中无需进行频繁的降速，保证良好的加工速度。另外，在本发明技术方案中，凡未作特别说明的，均可通过采用本领域中的常规手段来实现本技术方案。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一个实施例提供的3C金属加工中圆弧与圆弧平滑过渡的方法的流程图。图2为本发明一个实施例提供的步骤3中构造贝塞尔过渡曲线的方法的示例图。图3为本发明一个实施例提供的3C金属加工中圆弧与圆弧平滑过渡的系统的结构示意图。图4为本发明一个实施例提供的3C金属加工中圆弧与圆弧平滑过渡的设备的结构示意图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例是本发明一部分实施例，而不是全部的实施例，仅用以解释本发明，并不用于限定本发明。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明的是，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或服务器不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其他步骤或单元。实施例1：参考说明书附图1，示出了本发明一个实施例提供的3C金属加工中圆弧与圆弧平滑过渡的方法，该方法可以包括以下步骤：步骤1：获取相连的两条圆弧插补指令；步骤2：判断相连的两条圆弧插补指令首尾偏转角的大小是否在预设的范围内，若首尾偏转角的大小在预设的范围内，则执行步骤3；步骤3：构造贝塞尔过渡曲线；步骤4：将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列。在可选的实施例中，在步骤1中，获取相连的两条圆弧插补指令可以包括以下步骤：步骤1.1：读取第i条运动指令，i＝1、2、3……，步骤1.2：判断当前运动指令是否为圆弧插补指令，若当前运动指令是圆弧插补命令，则执行步骤1.3；若当前运动指令不是圆弧插补命令，则执行步骤1.6；步骤1.3：将当前运动指令存入缓存；步骤1.4：判断缓存中的指令数量，若当前缓存中指令数量为一，则返回执行步骤1.1，此时i＝i+1，若当前缓存中指令数量为二，则执行步骤1.5；步骤1.5：得到相连的两条圆弧插补指令；步骤1.6：判断缓存中是否已存在运动指令，若已存在运动指令，执行步骤1.7，若不存在运动指令，执行步骤1.8；步骤1.7：将缓存中已存在的运动指令与当前运动指令依次输出到运动队列；步骤1.8：将当前运动指令输出到运动队列。由此，通过设置缓存，结合对圆弧插补指令的判断，能够高效的筛选出相连的两条圆弧插补指令，为后续的首尾偏转角大小的判断进行前期准备。具体的，圆弧插补指令可以是顺时针圆弧插补指令G02或逆时针圆弧插补指令G03。以下参考说明书附图2所示的圆弧插补指令为例，对3C金属加工中圆弧和圆弧平滑过渡的方法进行说明。说明书附图2示出了相连的两条圆弧插补指令。在先的圆弧插补指令d，起点为F，终点为B，圆弧FB的圆心为D；在后的圆弧插补指令c，起点为B，终点为C，圆弧BC的圆心为A；原始的加工路径为F-B-C。在可选的实施例中，在步骤2中，若首尾偏转角的大小不在预设的范围内，则将相连的两条圆弧插补指令依次输出到运动队列。在可选的实施例中，步骤2中，首尾偏转角是指相连的两条圆弧插补指令形成的拐角，首尾偏转角的预设范围为0-90°。说明书附图2中圆弧FB和圆弧BC的首尾偏转角为90°。由此，通过对首尾偏转角的大小进行一定的限制，有效筛选出需要进行平滑过渡的运动指令。由于在实际加工过程中，当首尾偏转角超过一定范围时，往往是由于需要特定的加工轨迹而进行的设置，这类加工轨迹是无需进行平滑过渡的，通过对首尾偏转角的大小进行限制可以避免对这类加工轨迹进行多余操作。在可选的实施例中，在步骤3中，构造贝塞尔过渡曲线具体可以包括以下步骤：步骤3.1：在圆弧FB上确定点H，在圆弧BC上确定点E，使∠HDB＝∠BAE＝预设初始值；步骤3.2：过点H做圆弧FB的切线，过点B做圆弧FB的切线，确定两条切线的交点I；过点E做圆弧BC的切线，过点B做圆弧BC的切线，确定两条切线的交点G；步骤3.3：以点H、点I、点B、点G和点E作为贝塞尔曲线的五个控制点，计算贝塞尔过渡曲线a；步骤3.4：计算贝塞尔过渡曲线a与原始轨迹之间的最大误差；步骤3.5：判断最大误差与预设的误差阈值之间的大小关系，若最大误差等于预设的误差阈值，则无需对贝塞尔曲线进行处理，若最大误差不等于预设的误差阈值，则返回执行步骤3.1，并调整∠HDB和∠BAE的大小。在可选的实施例中，在步骤3.1中，预设初始值可以是45°。在步骤3.2中，贝塞尔过渡曲线a在H点的切线是HI，HI也是圆弧FH在H点的切线，所以贝塞尔过渡曲线a在H点和圆弧FH相切，在E点和圆弧EC相切。因此贝塞尔过渡曲线a分别与圆弧FH和圆弧EC相切，在H和E点是符合G1的几何连续性，能够实现圆弧与圆弧之间的平滑过渡。以说明书附图2所示的圆弧插补指令为例，B点的误差值是最大的，因此步骤3.4中，贝塞尔过渡曲线a与原始轨迹之间的最大误差即贝塞尔过渡曲线a上所有点到B点之间的距离的最小值。具体的，预设的误差阈值可以是在CNC加工中，根据实际需求确定的实际加工轨迹和原始轨迹的控制误差，一般实际加工轨迹和原始轨迹之间的误差的最大值不应当超过控制误差。在可选的实施例中，在步骤3.5中，调整∠HDB和∠BAE的大小的方法具体可以包括：当最大误差小于预设的误差阈值时，返回执行步骤3.1时，∠HDB＝∠BAE＞预设初始值；当最大误差大于预设的误差阈值时，返回执行步骤3.1时，∠HDB＝∠BAE＜预设初始值。由于误差是随着圆心角的变小而变小的，因此，通过逐步调整圆心角∠HDB和∠BAE的大小，最终使最大误差等于预设的误差阈值。由此，既能够符合加工的控制误差的需求，使最终拟合的曲线不过分偏离原始轨迹，又能够在最大程度上使轨迹更加平滑。在可选的实施例中，在步骤4中，将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列包括以下步骤：步骤4.1：用贝塞尔过渡曲线替代圆弧HB和圆弧BE；步骤4.2：依次将圆弧FH、贝塞尔过渡曲线a和圆弧EC输出到运动队列。本发明的有益效果是，通过对相连的两条圆弧指令的首尾偏转角进行判断，对需要进行平滑过渡的相连的圆弧，构造贝塞尔过渡曲线，保证圆弧与圆弧之间能够平滑过渡，达到提高工件表面光洁度的效果，提高产品的加工质量和加工精度；在加工过程中无需进行频繁的降速，保证良好的加工速度。实施例2：参考说明书附图3，示出了本发明一个实施例提供的3C金属加工中圆弧与圆弧平滑过渡的系统，用于执行前述任一的3C金属加工中圆弧与圆弧平滑过渡的方法，包括，圆弧指令获取模块11，用于获取相连的两条圆弧插补指令；首尾偏转角判断模块12，用于判断相连的两条圆弧插补指令首尾偏转角的大小是否在预设的范围内；贝塞尔过渡曲线构造模块13，用于构造贝塞尔过渡曲线；运动指令输出模块14，用于将贝塞尔过渡曲线插入两条运动指令之间，并依次输出到运动队列。在可选的实施例中，在贝塞尔过渡曲线构造模块13中包括：控制点确定单元，用于确定贝塞尔曲线计算中需要的五个控制点；贝塞尔过渡曲线计算单元，用于根据确定的五个控制点计算贝塞尔过渡曲线；最大误差计算单元，用于计算贝塞尔过渡曲线与原始轨迹之间的最大误差；圆心角调整单元，用于判断最大误差与预设的误差阈值之间的大小关系，若最大误差不等于预设的误差阈值，调整∠HDB和∠BAE的大小。由此，在圆心角调整单元调整∠HDB和∠BAE的大小后，控制点确定单元重新确定控制点，根据新确定的控制点计算贝塞尔过渡曲线，根据新的贝塞尔过渡曲线计算最大误差后，再对最大误差与预设的误差阈值进行比较，重复以上过程，直至计算出的最大误差等于预设的误差阈值。由此，既能够符合加工的控制误差的需求，使最终拟合的曲线不过分偏离原始轨迹，又能够在最大程度上使轨迹更加平滑。本发明的有益效果是，通过对相连的两条圆弧指令的首尾偏转角进行判断，对需要进行平滑过渡的相连的圆弧，构造贝塞尔过渡曲线，保证圆弧与圆弧之间能够平滑过渡，达到提高工件表面光洁度的效果，提高产品的加工质量和加工精度；在加工过程中无需进行频繁的降速，保证良好的加工速度。上述实施例提供的系统，在实现其功能时，仅以上述各功能模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将设备内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能。另外，上述实施例提供的系统与方法实施例属于同一种构思，其具体实现过程详见方法实施例，这里不再赘述。实施例3：参考说明书附图4，提供了一种3C金属加工中圆弧与圆弧平滑过渡的设备，该设备包括：一个或多个处理器31以及存储器32，说明书附图4中以一个处理器31为例。3C金属加工中圆弧与圆弧平滑过渡的设备还可以包括：输入装置33和输出装置34。存储器32作为一种非易失性计算机可读存储介质，可用于存储非易失性软件程序、非易失性计算机可执行程序以及模块，如本发明实施例中的3C金属加工中圆弧与圆弧平滑过渡的方法对应的程序指令/模块。处理器31通过运行存储在存储器32中的非易失性软件程序、指令以及模块，从而执行服务器的各种功能应用以及数据处理，即实现上述方法实施例的3C金属加工中圆弧与圆弧平滑过渡的方法。存储器32可以包括存储程序区和存储数据区，其中，存储程序区可存储操作系统、至少一个功能所需要的应用程序；存储数据区可存储根据3C金属加工中圆弧与圆弧平滑过渡的系统的使用所创建的数据等。此外，存储器32可以包括高速随机存取存储器，还可以包括非易失性存储器，例如至少一个磁盘存储器件、闪存器件或其他非易失性固态存储器件。在一些实施例中，存储器32可选包括相对于处理器31远程设置的存储器，这些远程存储器可以通过网络连接至3C金属加工中圆弧与圆弧平滑过渡的系统。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。输入装置33可接收输入的数字或字符信息，以及产生与用户设置以及功能控制有关的信号输入。输出装置34可包括显示屏等显示设备。一个或多个模块处处在存储器32中，当被一个或者多个处理器31执行时，执行上述任意方法实施例中的3C金属加工中圆弧与圆弧平滑过渡的方法。上述设备可执行本发明实施例所提供的方法，具备执行方法相应的功能模块和有益效果。未在本实施例中详尽描述的技术细节，可参见本发明实施例所提供的方法。实施例4：另一方面，本发明实施例4提供一种计算机可读存储介质，存储介质中存储有一个或多个包括执行指令的程序，执行指令能够被设备读取并执行，以用于执行上述方法实施例中的相关步骤。以上所描述的实施例仅仅是示意性的，其中作为分离部件说明的单元或模块可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或也可以不是物理单元，既可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到各实施方式可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式表现出来，该计算机软件产品可以存储在计算机可读存储介质中，如ROM/RAM、磁碟、光盘等，包括若干指令用以使得一台计算机设备执行各个实施例或者实施例的某些部分的方法。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应的技术方案本质脱离本发明各实施例技术方案的精神和范围。
