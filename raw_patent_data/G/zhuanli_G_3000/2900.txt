标题title
一种标测导管的拟合方法、装置及电子设备
摘要abst
本发明公开了三维标测技术领域内的一种标测导管的拟合方法、装置及电子设备。该方法包括以下步骤：步骤S1：获取多个电磁定位传感器的三维坐标点；步骤S2：根据多个三维坐标点进行B样条曲线插值计算，获取B样条曲线；步骤S3：分别以B样条曲线上的多个点为中心拟合出多组圆，每组圆均由多个均匀分布的点组成，每个点根据其空间坐标设定ID；步骤S4：依次将多组圆上的点连接成三角带并形成管腔的侧面片元，拟合出导管；步骤S5：根据多个三维坐标点从所有点中筛选出多组点云环，根据多组点云环拟合出电磁定位传感器贴片。该方法在拟合导管的基础上进一步拟合传感器贴片，从而更准确的实时拟合，将导管真实地显现，降低了三维标测难度。
权利要求书clms
1.一种标测导管的拟合方法，其特征在于，包括以下步骤：步骤S1：获取多个电磁定位传感器的三维坐标点；步骤S2：根据多个所述三维坐标点进行B样条曲线插值计算，获取B样条曲线；步骤S3：分别以所述B样条曲线上的多个点为中心拟合出多组圆，每组所述圆均由多个均匀分布的点组成，每个点根据其空间坐标设定ID；步骤S4：依次将多组所述圆上的点连接成三角带并形成管腔的侧面片元，拟合出导管；步骤S5：根据多个所述三维坐标点从所有点中筛选出多组点云环，根据多组点云环拟合出电磁定位传感器贴片。2.根据权利要求1所述的拟合方法，其特征在于，所述步骤S2具体为：设最终t值在所述B样条曲线的对应位置为C，则B样条曲线计算公式为：，其中Bi,deg是贝塞尔曲线的计算公式，deg表示阶数，Pi表示第i个控制点。3.根据权利要求1所述的拟合方法，其特征在于，所述步骤S4具体为：步骤S4.1：依次一一将每组所述圆上的单个点与相邻所述圆中相近的两个点连接成一条三角带，形成管腔的所述侧面片元；步骤S4.2：所有所述侧面片元共同组成管腔，封闭所述管腔，拟合出所述导管。4.根据权利要求1所述的拟合方法，其特征在于，步骤S5具体为：步骤S5.1：根据多个所述三维坐标点从所有点中筛选出多组所述点云环，多组所述点云环为多个所述电磁定位传感器贴合导管处；步骤S5.2：根据多组所述点云环拟合出多个所述电磁定位传感器的外侧圆，根据所述外侧圆拟合出传感器贴片管腔并封闭；步骤S5.3：删除重复的点和面片，拟合出所述电磁定位传感器贴片。5.根据权利要求4所述的拟合方法，其特征在于，所述步骤S5.1中多组点云环筛选方式如下：以多个三维坐标点为多个圆心坐标，通过各点ID分别检索出对应圆心坐标中的x、y、z的最大最小值，从而筛选出多组点云环。6.根据权利要求5所述的拟合方法，其特征在于，所述步骤S5.2中，根据所述点云环拟合所述外侧圆方式如下：每组点云环均由多个圆组成，计算出每组圆的平面法向量，设定新的半径，新的半径参照传感器贴片半径外径，依次拟合出多个外侧圆。7.根据权利要求6所述的拟合方法，其特征在于，所述步骤S5.2中，根据所述外侧圆拟合出所述传感器贴片管腔具体如下：依次一一将每组外侧圆上的单个点与相邻外侧圆中相近的两个点连接成一条三角带，形成贴片的侧面片元一；所有侧面片元一共同组成所述传感器贴片管腔。8.一种标测导管的拟合装置，其特征在于，包括：坐标点获取模块，所述坐标点获取模块用以获取多个电磁定位传感器的三维坐标点；样条曲线获取模块，所述样条曲线获取模块用以根据多个所述三维坐标点进行B样条曲线插值计算，获取B样条曲线；圆拟合模块，所述圆拟合模块用以分别以所述B样条曲线上的多个点为中心拟合出多组圆，每组所述圆均由多个均匀分布的点组成，每个点根据其空间坐标设定ID；导管拟合模块，所述导管拟合模块用以依次将多组所述圆上的点连接成三角带并形成管腔的侧面片元，拟合出导管；贴片拟合模块，所述贴片拟合模块用以根据多个所述三维坐标点从所有点中筛选出多组点云环，根据多组点云环拟合出电磁定位传感器贴片。9.根据权利要求8所述的拟合装置，其特征在于，所述贴片拟合模块具体用以：根据多个所述三维坐标点从所有点中筛选出多组所述点云环，多组所述点云环为多个所述电磁定位传感器贴合导管处；根据多组所述点云环拟合出多个所述电磁定位传感器的外侧圆，根据所述外侧圆拟合出传感器贴片管腔并封闭；删除重复的点和面片，拟合出所述电磁定位传感器贴片。10.一种电子设备，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至7任一项所述拟合方法的步骤。
说明书desc
技术领域本发明涉及三维标测技术领域，特别涉及一种标测导管的拟合方法、装置及电子设备。背景技术在三维标测过程中，导管作为辅助成像和消融的器材，成像和导航技术十分重要，因此在三维模型中，直观准确的观测到导管的真实形态也显得尤为重要；在复杂环境中工作时，三维标测需要使用者的精确操作，依赖使用者的经验与能力，因此，如果能获取到导管在目标内的实时真实形态即可大幅度降低使用者的工作压力。现有导管的拟合形态显示中实时性并不是很高，且并不能很准确的拟合出导管形态，很依赖于导管顶端的压力传感器，在触壁时才会对导管进行轻微幅度的弯曲，存在着不能把导管真实性显现的缺陷。发明内容本申请通过提供一种标测导管的拟合方法、装置及电子设备，解决了现有技术中不能把导管真实性显现的问题，实现了更准确的导管实时拟合显示，降低三维标测难度。第一方面，本申请实施例提供了一种标测导管的拟合方法，包括以下步骤：步骤S1：获取多个电磁定位传感器的三维坐标点；步骤S2：根据多个所述三维坐标点进行B样条曲线插值计算，获取B样条曲线；步骤S3：分别以所述B样条曲线上的多个点为中心拟合出多组圆，每组所述圆均由多个均匀分布的点组成，每个点根据其空间坐标设定ID；步骤S4：依次将多组所述圆上的点连接成三角带并形成管腔的侧面片元，拟合出导管；步骤S5：根据多个所述三维坐标点从所有点中筛选出多组点云环，根据多组点云环拟合出电磁定位传感器贴片。上述实施例的有益效果在于：该方法可以更准确的实时拟合导管，从而将导管真实地显现，降低了三维标测难度。在上述实施例基础上，本申请可进一步改进，具体如下：根据本发明实施例的一种具体实现方式，步骤S2具体为：设最终t值在所述B样条曲线的对应位置为C，则B样条曲线计算公式为：，其中Bi,deg是贝塞尔曲线的计算公式，deg表示阶数，Pi表示第i个控制点。根据本发明实施例的一种具体实现方式，步骤S4具体为：步骤S4.1：依次一一将每组所述圆上的单个点与相邻所述圆中相近的两个点连接成一条三角带，形成管腔的所述侧面片元；步骤S4.2：所有所述侧面片元共同组成管腔，封闭所述管腔，拟合出所述导管。根据本发明实施例的一种具体实现方式，步骤S5具体为：步骤S5.1：根据多个所述三维坐标点从所有点中筛选出多组所述点云环，多组所述点云环为多个所述电磁定位传感器贴合导管处；步骤S5.2：根据多组所述点云环拟合出多个所述电磁定位传感器的外侧圆，根据所述外侧圆拟合出传感器贴片管腔并封闭；步骤S5.3：删除重复的点和面片，拟合出所述电磁定位传感器贴片。根据本发明实施例的一种具体实现方式，所述步骤S5.1中多组点云环筛选方式如下：以多个三维坐标点为多个圆心坐标，通过各点ID分别检索出对应圆心坐标中的x、y、z的最大最小值，从而筛选出多组点云环。根据本发明实施例的一种具体实现方式，所述步骤S5.2中，根据所述点云环拟合所述外侧圆方式如下：每组点云环均由多个圆组成，计算出每组圆的平面法向量，设定新的半径，新的半径参照传感器贴片半径外径，依次拟合出多个外侧圆。根据本发明实施例的一种具体实现方式，所述步骤S5.2中，根据所述外侧圆拟合出所述传感器贴片管腔具体如下：依次一一将每组外侧圆上的单个点与相邻外侧圆中相近的两个点连接成一条三角带，形成贴片的侧面片元一；所有侧面片元一共同组成所述传感器贴片管腔。本申请实施例中提供的一个或多个技术方案，至少具有如下技术效果或优点：1.该方法在拟合导管的基础上进一步拟合传感器贴片，从而更准确的实时拟合，将导管真实地显现，降低了三维标测难度；2.该方法缩短了导管拟合及传感器贴片拟合的时间和繁琐过程，缩减非必要数据量，保证了拟合的实时性；3.该方法的拟合效果更接近现实，更美观，符合当下实验和三维标测的需求。第二方面，本发明实施例提供了一种标测导管的拟合装置，包括：坐标点获取模块，所述坐标点获取模块用以获取多个电磁定位传感器的三维坐标点；样条曲线获取模块，所述样条曲线获取模块用以根据多个所述三维坐标点进行B样条曲线插值计算，获取B样条曲线；圆拟合模块，所述圆拟合模块用以分别以所述B样条曲线上的多个点为中心拟合出多组圆，每组所述圆均由多个均匀分布的点组成，每个点根据其空间坐标设定ID；导管拟合模块，所述导管拟合模块用以依次将多组所述圆上的点连接成三角带并形成管腔的侧面片元，拟合出导管；贴片拟合模块，所述贴片拟合模块用以根据多个所述三维坐标点从所有点中筛选出多组点云环，根据多组点云环拟合出电磁定位传感器贴片。根据本发明实施例的一种具体实现方式，所述贴片拟合模块具体用以：根据多个所述三维坐标点从所有点中筛选出多组所述点云环，多组所述点云环为多个所述电磁定位传感器贴合导管处；根据多组所述点云环拟合出多个所述电磁定位传感器的外侧圆，根据所述外侧圆拟合出传感器贴片管腔并封闭；删除重复的点和面片，拟合出所述电磁定位传感器贴片。第三方面，本发明实施例还提供了一种电子设备，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现前述第一方面或第一方面的任一实现方式中的拟合方法的步骤。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍。在所有附图中，类似的元件或部分一般由类似的附图标记标识。附图中，各元件或部分并不一定按照实际的比例绘制。图1为本发明一种标测导管的拟合方法的步骤流程图；图2为实施例1中步骤S3示意图；图3为实施例1中步骤S4.1示意图；图4为实施例1中步骤S5.3示意图；图5为一种标测导管的拟合装置的结构框图；图6示出了本发明实施例所提供的一种电子设备的结构示意图。其中，1.B样条曲线，2.圆，3.三角带，4.导管，5.传感器贴片。具体实施方式下面结合具体实施方式，进一步阐明本发明，应理解这些实施方式仅用于说明本发明而不用于限制本发明的范围，在阅读了本发明之后，本领域技术人员对本发明的各种等价形式的修改均落于本申请所附权利要求所限定的范围。本申请实施例通过提供一种标测导管的拟合方法、装置及电子设备，解决了现有技术中不能把导管真实性显现的问题，实现了更准确的导管实时拟合显示，降低三维标测难度。本申请实施例中的技术方案为解决上述问题，总体思路如下：实施例1：如图1所示，本申请实施例提供了一种标测导管的拟合方法，包括以下步骤：以4个电磁定位传感器为例。步骤S1：获取4个电磁定位传感器的三维坐标点。电磁定位传感器也称为空间磁场定位装置。4个位于导管内部且分布均匀的传感器可以得到4个在实时变化的三维坐标。步骤S2：根据4个三维坐标点进行B样条曲线插值计算，获取B样条曲线1。设最终t值在B样条曲线的对应位置为C，则最终B样条曲线计算公式为：；其中Bi,deg是贝塞尔曲线的计算公式，deg表示阶数，此专利中deg为3，Pi表示第i个控制点，在本实施例中为4空间电磁定位传感器分别提供的4个空间坐标：P0、P1、P2、P3；同时，i的取值范围是;求和符号上的n表示控制点的总数，即 n=3；t的取值范围是。Bi,deg是基本函数表中第 deg 阶下所有元素的权重值，公式为：；其中，knot代表节点，knoti代表节点表中的第i个元素，节点表的大小等于控制点数量+阶数+1，节点表的参数设置通过顺序方法设置，顺序列表只需要从0-1线性递增设置即可，本实施例中中曲线有4个控制点，阶数是3阶，那么节点表大小=8，按顺序设置为：0，1/8，2/8，3/8....7/8，1。步骤S3：分别以B样条曲线1上的多个点为中心拟合出多组圆2，每组圆2均由多个均匀分布的点组成，每个点根据其空间坐标设定ID。如图2所示。圆半径为待拟合导管半径外径。步骤S4：依次将多组圆上的点连接成三角带并形成管腔侧面片元，拟合出导管。具体为：步骤S4.1：如图3所示；依次一一将每组圆2上的单个点与相邻圆2中相近的两个点连接成一条三角带3，形成管腔的侧面片元。步骤S4.2：所有侧面片元共同组成管腔，封闭管腔，即首尾圆加面封闭，从而拟合出导管4。如图4所示。步骤S5：根据4个三维坐标点从所有点中筛选出4组点云环，根据4组点云环拟合出电磁定位传感器贴片。步骤S5.1：根据4个三维坐标点从所有点中筛选出4组点云环，4组点云环为4个电磁定位传感器贴合导管处；4组点云环筛选方式如下：以4个三维坐标点为4个圆心坐标，通过各点ID分别检索出对应圆心坐标中的x、y、z的最大最小值，从而筛选出4组点云环。步骤S5.2：根据4组点云环拟合出4个电磁定位传感器的外侧圆，根据外侧圆拟合出传感器贴片管腔并封闭管腔；根据点云环拟合外侧圆方式如下：每组点云环均由多个圆组成，计算出每组圆的平面法向量，设定新的半径，新的半径参照传感器贴片半径外径，依次拟合出多个外侧圆。根据外侧圆拟合出传感器贴片管腔具体如下：依次一一将每组外侧圆上的单个点与相邻外侧圆中相近的两个点连接成一条三角带，形成贴片的侧面片元一；所有侧面片元一共同组成贴片管腔。步骤S5.3：删除重复的点和面片，拟合出导管外的电磁定位传感器贴片5。如图4所示。实施例2：如图5所示，一种标测导管的拟合装置，包括：坐标点获取模块，用以获取多个电磁定位传感器的三维坐标点；样条曲线获取模块，用以根据多个三维坐标点进行B样条曲线插值计算，获取B样条曲线；圆拟合模块，用以分别以B样条曲线上的多个点为中心拟合出多组圆，每组圆均由多个均匀分布的点组成，每个点根据其空间坐标设定ID；导管拟合模块，用以依次将多组圆上的点连接成三角带并形成管腔的侧面片元，拟合出导管；贴片拟合模块，用以根据多个三维坐标点从所有点中筛选出多组点云环，根据多组点云环拟合出电磁定位传感器贴片。实施例2中各模块的功能与其对应的实施例1方法中的内容相对应，在此不再赘述。实施例3：图6示出了本发明实施例提供的电子设备60的结构示意图，电子设备60包括至少一个处理器601，至少一个输入输出接口604，存储器602，和至少一个通信总线603，用于实现这些部件之间的连接通信。至少一个处理器601用于执行存储器602中存储的计算机指令，以使所述至少一个处理器601能够执行前述任一拟合方法的实施例。存储器602为非暂态存储器，其可以包含易失性存储器，例如高速随机存取存储器，也可以包括非易失性存储器，例如至少一个磁盘存储器。通过至少一个输入输出接口604实现与至少一个其他设备或单元之间的通信连接。在一些实施方式中，存储器602存储了程序6021，处理器601执行程序 6021，用于执行前述任一拟合方法实施例中的内容。该电子设备可以以多种形式存在，包括但不限于： 移动通信设备：这类设备的特点是具备移动通信功能，并且以提供话音、数据通信为主要目标。这类终端包括：智能手机（例如iPhone)、多媒体手机、功能性手机，以及低端手机等。 超移动个人计算机设备：这类设备属于个人计算机的范畴，有计算和处理功能，一般也具备移动上网特性。这类终端包括：PDA、MID和UMPC设备等，例如iPad。 便携式娱乐设备：这类设备可以显示和播放多媒体内容。该类设备包括：音频、视频播放器（例如iPod)，掌上游戏机，电子书，以及智能玩具和便携式车载导航设备。 特定服务器：提供计算服务的设备，服务器的构成包括处理器、硬盘、内存、系统总线等，服务器和通用的计算机架构类似，但是由于需要提供高可靠的服务，因此在处理能力、稳定性、可靠性、安全性、可扩展性、可管理性等方面要求较高。 其他具有数据交互功能的电子设备。尽管上面已经示出和描述了本发明的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本发明的限制，本领域的普通技术人员在本发明的范围内可以对上述实施例进行变化、修改、替换和变型。
