标题title
基于版式数据流文件底板将效果工具投影到OFD文件的方法
摘要abst
本发明公开基于版式数据流文件底板将效果工具投影到OFD文件的方法，包括创建版式数据流文件底板，将OFD文件和效果工具分别注册到文件底板上；在OFD文件上选择投影的区域，将区域信息送到文件底板上；计算中枢获取区域信息和效果工具基本信息，将效果工具计算生成特定的效果投影到对应的OFD文件的区域上；对于文件受限或者不存在获取信息的条件，或者使用者不愿意信息获取的方法，将渲染目标截取成图片进行处理，将处理之后的信息进行加工，生成对应效果，本发明不仅可以利用文件底板将效果工具的特性效果动态投影到OFD文件上，还可以将渲染的目标截取成图片后再进行处理，将处理后的效果投影到OFD文件上，提供了多样化的选择突出阅读效果的方法。
权利要求书clms
1.基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于，包括以下步骤：步骤S1：创建版式数据流文件底板，利用文件底板上的计算中枢的附着注册功能将OFD文件注册到版式数据流文件底板上；步骤S2：建立效果工具的资源标识，将效果工具，资源标识注册到文件底板上；步骤S3：解析效果工具的基本信息，并将基本信息存储在文件底板上；步骤S4：在OFD文件上选择需要投影的区域，将选择区域的信息送到文件底板上；步骤S5：计算中枢获取上述步骤S4中的区域信息和S3中的效果工具基本信息，将效果工具计算生成特定的效果，生成后的效果投影到对应的OFD文件上的区域上；步骤S6：对于文件受限或者不存在获取信息的条件，或者使用者不愿意信息获取的方式，将投影目标截取成图片，并在效果工具中预设效果，将图片进行OCR识别，识别之后，将处理的信息进行加工。2.根据权利要求1所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于：所述步骤S2中所述资源标识用于识别对应的效果工具，每个所述资源标识与文件底板相互绑定关联，所述资源标识与文件底板建立路由关系。3.根据权利要求1所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于：所述效果工具的基本信息包括效果工具在文件底板上的初始位置，效果工具的初始大小，效果工具的展现效果；所述效果工具的展现形式包括水印，背景，放大，矢量标注，正投，背投，阴影，斑块，灰阶，抖动，跳动，飞翔，发光，忽闪，着火，淹没，喷墨，弹幕；所述效果工具的投影位置包括文件底板，OFD文件页面上文字本身，悬浮于OFD文件页面文字上方。4.根据权利要求1所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于，所述步骤S5的具体过程如下：S51：根据用户要求确定效果工具的资源标识；S52：根据上述效果工具的资源标识查找对应的效果工具，提取效果工具的属性；S53：计算中枢对OFD文件投影区域的原始内容进行分析，确定投影区域的元素、效果工具的应用区域；S54：将效果工具计算生成相应的大小，颜色，范围，效果特征；S55：计算生成后的效果工具投影到OFD文件应用的位置，应用的元素上。5.根据权利要求4所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于：所述效果工具的信息以xml标签嵌入在OFD文件中，所述xml标签用于描述效果工具的类型，属性，范围。6.根据权利要求1所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于：所述效果工具的基本信息以json数据格式存储在文件底板上。7.根据权利要求1所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于：所述步骤S6的具体过程如下：S61：动态选择OFD文件中需要渲染的区域，获取渲染区域的位置坐标；S62：将选择的区域截取成图片；S63：利用OCR识别上述步骤S62图片中的内容；S64：利用效果工具预设效果；S65：计算中枢获取预设后的效果和上述S63中识别的内容，将识别出的内容按照预设的字体形式输出特定的输出效果；S66：利用文件底板的映射功能将输出效果投影到OFD文件上。8.根据权利要求7所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于：所述动态选择可通过手动选择范围区域进行选择。9.根据权利要求1所述的基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于：所述效果工具的投影适用于单个文件中的单个页面、多个页面、整个文件，多种合并文件中的单个页面、多个页面、整个文件，多文件组合展现中的单个页面、多个页面、整个文件。
说明书desc
技术领域本发明属于文档处理技术领域，具体为基于版式数据流文件底板将效果工具投影到OFD文件的方法。背景技术在OFD文档应用和流转的过程中，在对OFD文档进行阅读同时，经常需要对OFD文档添加阅读效果，比如需要对OFD文档中的文字加粗，倾斜或者添加水印，背景之类的，现有技术中OFD文档在添加效果通常是在指定的固定位置上进行添加，而不能将使用的效果工具动态关联投影到OFD文档上，且投影方法较为单一。发明内容本发明的目的在于提供基于版式数据流文件底板讲效果工具投影到OFD文件上的方法，以解决上述背景技术中提出的问题。为实现上述目的，本发明提供如下技术方案：基于版式数据流文件底板将效果工具投影到OFD文件上的方法，包括以下步骤：基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于，包括以下步骤：步骤S1：创建版式数据流文件底板，利用文件底板上的计算中枢的附着注册功能将OFD文件注册到版式数据流文件底板上；步骤S2：建立效果工具的资源标识，将效果工具，资源标识注册到文件底板上；步骤S3：解析效果工具的基本信息，并将基本信息存储在文件底板上；步骤S4：在OFD文件上选择需要投影的区域，将区域信息送到文件底板上；步骤S5：计算中枢获取上述步骤S4中的区域信息和S3中的效果工具基本信息，将效果工具计算生成特定的效果，生成后的效果投影到对应的OFD文件上的区域上；步骤S6：对于文件受限或者不存在获取信息的条件，或者使用者不愿意信息获取的方式，将投影目标截取成图片，并在效果工具中预设效果，将图片进行OCR识别，识别之后，将处理的信息进行加工。优选的，所述步骤S2中所述资源标识用于识别对应的效果工具，每个所述资源标识与文件底板相互绑定关联，所述资源标识与文件底板建立路由关系。优选的，所述效果工具的基本信息包括效果工具在文件底板上的初始位置，效果工具的初始大小，效果工具的展现效果；所述效果工具的展现形式包括水印，背景，放大，矢量标注，正投，背投，阴影，斑块，灰阶，抖动，跳动，飞翔，发光，忽闪，着火，淹没，喷墨，弹幕；所述效果工具的投影位置包括文件底板，OFD文件页面上文字本身，悬浮于OFD文件页面文字上方。优选的，所述步骤S5的具体过程如下：S51：根据用户要求确定效果工具的资源标识；S52：根据上述效果工具的资源标识查找对应的效果工具，提取效果工具的属性；S53：计算中枢对OFD文件投影区域的原始内容进行分析，确定投影区域的元素、效果工具的应用区域；S54：将效果工具计算生成相应的大小，颜色，范围，效果特征；S55：计算生成后的效果工具投影到OFD文件应用的位置，应用的元素上。优选的，所述效果工具以xml标签嵌入在OFD文件中，所述xml标签用于描述效果工具的类型，属性，范围。优选的，所述效果工具的基本信息以json数据格式存储在文件底板上。优选的，所述步骤S6的具体过程如下：S61：动态选择OFD文件中需要渲染的区域，获取渲染区域的位置坐标；S62：将选择的区域截取成图片；S63：利用OCR识别上述步骤S62图片中的内容；S64：利用效果工具预设效果；S65：计算中枢获取预设后的效果和上述S63中识别的内容，将识别出的内容按照预设的字体形式输出特定的输出效果；S66：利用文件底板的映射功能将输出效果投影到OFD文件上。优选的，所述动态选择可通过手动选择范围区域进行选择。优选的，所述效果工具的投影适用于单个文件中的单个页面、多个页面、整个文件，多种合并文件中的单个页面、多个页面、整个文件，多文件组合展现中的单个页面、多个页面、整个文件。与现有技术相比，本发明的有益效果是：本发明分别在版式数据流文件底板上注册OFD文件，效果工具，可以将效果工具的特性效果动态投影到OFD文件的指定页面上，多样化地进行动态投影，更好地突出了阅读效果。本发明中OFD的每个页面均单独与文件底板关联，在投影过程中可以进行绑定渲染。本发明不仅可以根据投影要求，通过文件底板将效果工具输出的特定效果直接投影到OFD文件投影的区域上，还可以将需要投影的区域截取成图片，按照投影要求对图片上的内容进行处理，然后将处理后的图片投影到OFD文件指定的位置上，提供了多样化的投影方法，提供了OFD文件多样化的阅读效果。附图说明图1为本发明中的流程图；具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一结合图1所示，本发明提供基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于，包括以下步骤：S1：创建版式数据流文件底板，利用文件底板上的计算中枢的附着注册功能将OFD文件注册到版式数据流文件底板上；S2：建立效果工具的资源标识，将效果工具，资源标识注册到文件底板上；S3：解析效果工具的基本信息，并将基本信息存储在文件底板上；S4：在OFD文件上选择需要投影的区域，将区域信息送到文件底板上；S5：计算中枢获取上述步骤S4中的区域信息和S3中的效果工具基本信息，将效果工具计算生成特定的效果，生成后的效果投影到对应的OFD文件上的区域上；S6：对于文件受限或者不存在获取信息的条件，或者使用者不愿意信息获取的方式，将投影目标截取成图片，并在效果工具中预设效果，将图片进行OCR识别，识别之后，将处理的信息进行加工。本发明不仅可以根据投影要求，通过文件底板将效果工具输出的特定效果直接投影到OFD文件投影的区域上，还可以将需要投影的区域截取成图片，按照投影要求对图片上的内容进行处理，然后将处理后的图片投影到OFD文件指定的位置上，提供了多样化的投影方法，提供了OFD文件多样化的阅读效果。实施例二如图1所示，本发明提供基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于，包括以下步骤：S1：创建版式数据流文件底板，利用文件底板上的计算中枢的附着注册功能将OFD文件注册到版式数据流文件底板上，具体为将OFD文件的每个页面渲染注册到文件底板上，并将源文件中的每个页面上的页面数据与文件底板进行绑定，每一个单独的页面为滚动视图底板上的子视图，页面数据包括元素、元素对应的内容、渲染数据；S2：建立效果工具的资源标识，将效果工具，资源标识注册到文件底板上，资源标识是绑定效果工具的key，即效果工具的唯一性标识，用于识别对应的效果工具，每个资源标识与文件底板相互绑定关联，并且资源标识与文件底板建立路由关系，便于通过反向关联查找；S3：解析效果工具的基本信息，并将基本信息存储在文件底板上，其中效果工具的基本信息以json数据格式存储在文件底板上，便于利用文件底板查找到效果工具，效果工具的基本信息包括效果工具投影在文件底板上的初始位置，效果工具的初始大小，效果工具的展现形式；效果工具的投影位置可以在文件底板上即展现在文字背后，例如水印，背景，喷墨，着火，淹没等等这些展现形式，或者在OFD文件页面上的文字本身，例如文字加粗，文字倾斜，字体抖动，跳动，飞翔，在文字上加阴影，或者产生渐进的效果等等，或者悬浮于OFD文件页面文字上方，例如弹幕；S4：用户在OFD文件上可以通过手动拖框选择需要投影的区域，然后将区域信息送到文件底板上；S5：计算中枢获取上述步骤S4中的区域信息和S3中的效果工具基本信息，将效果工具计算生成特定的效果，生成后的效果投影到对应的OFD文件上的区域上；其中步骤S5的具体过程为：S51：根据用户要求确定效果工具的资源标识，用户的要求可以为在OFD文件中某个具体位置对文字本身或者对文件的底板或者文字上方添加加粗，倾斜，阴影，背景等等效果，或者对阴影占据的范围，字体的大小等等都有一定的要求；S52：根据上述效果工具的资源标识查找对应的效果工具，提取效果工具的属性，效果工具的属性包括颜色，大小，位置；S53：计算中枢对OFD文件投影区域的原始内容进行分析，确定投影区域的元素、效果工具的应用区域，从而可以确定投影区域中的文字以及投影区域用在的位置上；S54：结合效果工具的基本信息将效果工具计算生成相应的大小，颜色，范围，效果特征，例如需要对选中的文字进行放大时，计算中枢将效果工具指定的文字按照对应的放大字体号进行放大；若需要添加阴影时，确定阴影添加的大小范围，阴影的使用位置。S55：计算生成后的效果工具投影到OFD文件应用的位置，应用的元素上，其中效果工具以xml标签嵌入在OFD文件中，xml标签用于描述效果工具的类型，属性，范围。用户在使用的时候，若要对文字进行投影，用户在阅读器中打开OFD文件，在OFD文件上添加文字投影标签，投影标签以xml格式插入到OFD文件中，投影标签内容包括字体颜色，字体大小，字体样式，字体位置，页面样式，阅读器根据标签对OFD文件中文本块添加投影。本发明将OFD的每个页面均单独与文件底板关联，在投影过程中可以进行绑定渲染，文件底板将效果工具输出的特定效果直接投影到OFD文件投影的区域上，提供了便利化的投影方法。实施例三如图1所示，本发明提供基于版式数据流文件底板将效果工具投影到OFD文件的方法，其特征在于，包括以下步骤：S1：创建版式数据流文件底板，利用文件底板上的计算中枢的附着注册功能将OFD文件注册到版式数据流文件底板上；S2：建立效果工具的资源标识，将效果工具，资源标识注册到文件底板上；S3：解析效果工具的基本信息，并将基本信息存储在文件底板上；S4：在OFD文件上选择需要投影的区域，将区域信息送到文件底板上；S5：计算中枢获取上述步骤S4中的区域信息和S3中的效果工具基本信息，将效果工具计算生成特定的效果，生成后的效果投影到对应的OFD文件上的区域上；S6：对于文件受限或者不存在获取信息的条件，或者使用者不愿意信息获取的方式，将投影目标截取成图片，并在效果工具中预设效果，将图片进行OCR识别，识别之后，将处理的信息进行加工。其中S6的具体过程为S61：动态选择OFD文件中需要渲染的区域，获取渲染区域的位置坐标，可以通过手动拉框选择渲染的区域，拉动框形的形状可以是圆形，矩形，椭圆形，多边形等等，选中之后，计算中枢获取渲染区域的位置坐标，渲染区域的长宽，从而确定渲染的区域；S62：将选择的区域截取成图片；S63：利用OCR识别上述步骤S62图片中的内容；S64：利用效果工具预设效果；S65：计算中枢获取预设后的效果和上述S63中识别的内容，将识别出的内容按照预设的效果输出，其中图片的内容为在OFD文件上一切显示的内容，包括字体，符号之类的，当对图片上的字体进行改变的时候，利用效果工具可以预设字体的形式，其中字体形式改变包括字体颜色的改变，字体的大小改变，在字体上添加特定的效果等等；具体地，当对字体进行放大的时候，首先利用效果工具预设将字体放大，然后放大的字体按照设定的形式展现在OFD文件上指定的位置，当对字体颜色改变的时候，利用效果工具将图片上的字体颜色进行改变，然后改变颜色后的字体投影在选择区域的字体上，其中字体上的特定效果包括加粗，渐变，阴影，抖动，跳动，飞翔等等，计算中枢在加工处理过程中，将识别出的内容按照预设字体形式的改变进行处理，形成特定的输出效果；S66：利用文件底板的映射功能将输出效果投影到OFD文件上，其中根据效果的特性要求进行投影，若要对文件底板进行效果投影，则可将背景投影到选择区域的那部分文件底板上；若对文字本身进行效果投影，可将阴影，加粗，渐变这些效果应用到选择区域上的指定文字上，其中当对选择区域的文字进行放大时，放大的文字以图片的形式投影到OFD文件上拉框选择的区域的上方或下方或左侧或右侧，并且投影的地方不会阻挡OFD文件上的其他内容；若对选择区域的文字上方进行投影时，可对选择区域的文字上方投影弹幕的应用效果，从而实现OFD文件的投影效果。本发明将需要投影的区域截取成图片，按照用户的投影要求对图片上的内容进行处理，然后将处理后的图片投影到OFD文件指定的位置上，便于更好的突出阅读效果。对于本领域技术人员而言，显然本发明不限于上述示范性实施例的细节，而且在不背离本发明的精神或基本特征的情况下，能够以其他的具体形式实现本发明。因此，无论从哪一点来看，均将实施例看作是示范性的，而且是非限制性的，本发明的范围由所附权利要求而不是上述说明限定，因此旨在将落在权利要求的等同要件的含义和范围内的所有变化囊括在本发明内。不应将权利要求中的任何附图标记视为限制所涉及的权利要求。
