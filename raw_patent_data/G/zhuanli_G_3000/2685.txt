标题title
一种动物器官分割模型训练方法、分割方法及相关产品
摘要abst
本发明提供一种动物器官分割模型训练方法、分割方法及相关产品。该训练方法包括：基于预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型；获取未标注动物器官的第二动物医学图像，并基于初始动物器官分割模型得到第二动物医学图像中动物器官预标注数据；基于第一动物医学图像和第二动物医学图像及相应的动物器官标注数据，训练初始动物器官分割模型得到优化的动物器官分割模型，第二动物医学图像相应的动物器官标注数据是基于动物器官预标注数据修正得到。既实现了基于迁移学习对动物器官分割模型与数据训练，又解决了数据量不足的情况下将人类器官分割模型参数迁移到动物器官分割模型中难以适配和分割不准确的问题。
权利要求书clms
1.一种动物器官分割模型训练方法，其特征在于，包括：获取已标注动物器官的第一动物医学图像及相应的动物器官标注数据，基于所述第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型；获取未标注动物器官的第二动物医学图像，并基于所述初始动物器官分割模型得到所述第二动物医学图像的动物器官预标注数据；基于所述第一动物医学图像及相应的动物器官标注数据，和第二动物医学图像及相应的动物器官标注数据，训练所述初始动物器官分割模型，得到优化的动物器官分割模型，所述第二动物医学图像相应的动物器官标注数据是基于所述动物器官预标注数据修正得到。2.根据权利要求1所述的动物器官分割模型训练方法，其特征在于，还包括：使用强化学习方法对所述优化的动物器官分割模型进行微调训练。3. 根据权利要求1所述的动物器官分割模型训练方法，其特征在于，所述人体器官分割模型包括Efficient Net神经网络，所述Efficient Net神经网络包括依次连接的第一卷积模块，Efficient Net模块和第一分割头；所述初始动物器官分割模型包括依次连接的第一卷积模块，Efficient Net模块，上采样层，第二卷积模块，轻量化卷积神经网络模块和第二分割头，其中，所述第一卷积模块和所述Efficient Net模块是从所述Efficient Net神经网络迁移而来的。4. 根据权利要求3所述的动物器官分割模型训练方法，其特征在于，所述轻量化卷积神经网络模块包括scSE Mobile Net V3模块，所述scSE Mobile Net V3模块是将MobileNet V3模块中的cSE注意力机制模块全部替换为scSE注意力机制模块得到的。5.根据权利要求3所述的动物器官分割模型训练方法，其特征在于，所述基于所述第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型，包括执行第二预设轮数对所述初始动物器官分割模型的预设训练过程，所述预设训练过程包括：基于输入的所述第一动物医学图像，经过所述第一卷积模块、所述Efficient Net模块和所述上采样层，计算得到第一特征图；基于输入的所述第一动物医学图像，利用所述第一卷积模块计算得到第二特征图；将所述第一特征图和所述第二特征图融合，得到第三特征图；所述第三特征图输入所述第二卷积模块进行计算得到第四特征图；将所述第四特征图输入所述轻量化卷积神经网络模块计算得到第五特征图；将所述第五特征图输入所述第二分割头进行解码，得到动物器官标注数据。6.根据权利要求5所述的动物器官分割模型训练方法，其特征在于，在前N次训练过程中，将所述Efficient Net模块的所有参数固定；在后M次训练过程中，将所述Efficient Net模块的所有参数开放，以允许所述所有参数与所述轻量化卷积神经网络模块的参数同时参与反馈调节；其中，N与M之和等于所述第二预设轮数。7.根据权利要求1所述的动物器官分割模型训练方法，其特征在于，训练所述人体器官分割模型和所述初始动物器官分割模型所采用的损失函数为BCE损失函数和Tversky损失函数之和；其中，在训练所述人体器官分割模型所用的Tversky损失函数中，参数α和参数β均为0.5；训练所述初始动物器官分割模型所用的Tversky损失函数中，参数α取值范围是0.2~0.35，参数β的取值范围是0.6~0.75。8.根据权利要求2所述的动物器官分割模型训练方法，其特征在于，所述使用强化学习方法对所述优化的动物器官分割模型进行微调训练，包括：将所述优化的动物器官分割模型复制为两份，分别为第一动物器官分割模型和第二动物器官分割模型；将所述第一动物医学图像和所述第二动物医学图像作为输入数据，输入所述第一动物器官分割模型和所述第二动物器官分割模型，分别得到第一动物器官标注结果和第二动物器官标注结果；分别计算所述第一动物器官标注结果与所述第一动物医学图像相应的动物器官标注数据之间的第一Dice精度值，和所述第二动物器官标注结果与所述第二动物医学图像相应的动物器官标注数据之间的第二Dice精度值；基于所述第一Dice精度值和所述第二Dice精度值计算惩罚项；将所述第二Dice精度作为得分，基于所述得分和所述惩罚项计算强化学习的奖励，将所述奖励反馈给所述第二动物器官分割模型进行参数更新；每训练一定周期，复制最新一次更新的所述第二动物器官分割模型的参数来覆盖上一次更新的所述第一动物器官分割模型的参数。9.根据权利要求8所述的动物器官分割模型训练方法，其特征在于，所述基于所述第一Dice精度值和所述第二Dice精度值计算惩罚项，采用如下计算式：，式中，λ表示惩罚项，表示第一Dice精度值，/＞表示第二Dice精度值。10.根据权利要求8所述的动物器官分割模型训练方法，其特征在于，所述使用强化学习方法对所述优化的动物器官分割模型进行微调训练，还包括：基于上一次更新参数的所述第一动物器官分割模型生成的动物器官标注结果，最新一次更新参数的所述第二动物器官分割模型生成的动物器官标注结果和最终奖励，构建强化学习经验池，用于离线学习使用。11.一种动物器官分割方法，其特征在于，包括：获取未标注动物器官的待分割动物医学图像；利用基于权利要求1至10中任一项所述的动物器官分割模型训练方法预先训练得到的动物器官分割模型，对所述待分割动物医学图像进行动物器官分割，得到动物器官分割结果。12.一种动物器官分割模型训练装置，其特征在于，包括：第一训练模块，用于获取已标注动物器官的第一动物医学图像及相应的动物器官标注数据，基于所述第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型；预标注模块，用于获取未标注动物器官的第二动物医学图像，并基于所述初始动物器官分割模型得到所述第二动物医学图像的动物器官预标注数据；第二训练模块，用于基于所述第一动物医学图像及相应的动物器官标注数据，和第二动物医学图像及相应的动物器官标注数据，训练所述初始动物器官分割模型，得到优化的动物器官分割模型，所述第二动物医学图像相应的动物器官标注数据是基于所述动物器官预标注数据修正得到。13.一种动物器官分割装置，其特征在于，包括：获取模块，用于获取未标注动物器官的待分割动物医学图像；分割模块，用于利用基于权利要求12所述的动物器官分割模型训练装置预先训练得到的动物器官分割模型，对所述待分割动物医学图像进行动物器官分割，得到动物器官分割结果。14.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被至少一个处理器执行时，实现如权利要求1至11中任一项所述的方法。15.一种电子设备，其特征在于，包括存储器和至少一个处理器，所述存储器上存储有计算机程序，所述计算机程序被所述至少一个处理器执行时实现如权利要求1至11中任一项所述的方法。16.一种计算机程序产品，其特征在于，所述计算机程序产品在处理器上运行时执行如权利要求1至11中任一项所述的方法。
说明书desc
技术领域本发明涉及医学图像分割技术领域，尤其涉及一种动物器官分割模型训练方法、分割方法及相关产品。背景技术本部分旨在为权利要求书中陈述的实施方式提供背景或上下文。此处的描述不因为包括在本部分中就承认是现有技术。随着人们生活水平的不断提高，饲养宠物越来越成为人们生活中不可或缺的一部分。然而宠物也会面临生病的困扰，如肿瘤、骨折、肺部感染等，除此以外，还有大量的动物实验也需要用到术前规划，因此，动物CT重建技术也变得尤为重要。由于动物器官标注数据非常有限，相比人类的器官庞大的标注数据量，根本无法使用传统监督训练方法进行动物器官分割模型训练。发明内容本发明提供一种动物器官分割模型训练方法、分割方法及相关产品。第一方面，本发明实施例提供一种动物器官分割模型训练方法，包括：获取已标注动物器官的第一动物医学图像及相应的动物器官标注数据，基于所述第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型；获取未标注动物器官的第二动物医学图像，并基于所述初始动物器官分割模型得到所述第二动物医学图像的动物器官预标注数据；基于所述第一动物医学图像及相应的动物器官标注数据，和第二动物医学图像及相应的动物器官标注数据，训练所述初始动物器官分割模型，得到优化的动物器官分割模型，所述第二动物医学图像相应的动物器官标注数据是基于所述动物器官预标注数据修正得到。在一些实现方式中，所述的动物器官分割模型训练方法，还包括：使用强化学习方法对所述优化的动物器官分割模型进行微调训练。在一些实现方式中，所述人体器官分割模型包括Efficient Net神经网络，所述Efficient Net神经网络包括依次连接的第一卷积模块，Efficient Net模块和第一分割头；所述初始动物器官分割模型包括依次连接的第一卷积模块，Efficient Net模块，上采样层，第二卷积模块，轻量化卷积神经网络模块和第二分割头，其中，所述第一卷积模块和所述Efficient Net模块是从所述Efficient Net神经网络迁移而来的。在一些实现方式中，所述轻量化卷积神经网络模块包括scSE Mobile Net V3模块，所述scSE Mobile Net V3模块是将Mobile Net V3模块中的cSE注意力机制模块全部替换为scSE注意力机制模块得到的。在一些实现方式中，所述基于所述第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型，包括执行第二预设轮数对所述初始动物器官分割模型的预设训练过程；所述预设训练过程包括：输入所述第一动物医学图像，经过所述第一卷积模块、所述Efficient Net模块和所述上采样层，计算得到第一特征图；输入所述第一动物医学图像及相应的动物器官标注数据，利用所述第一卷积模块计算得到第二特征图；将所述第一特征图和所述第二特征图融合，得到第三特征图；所述第三特征图输入所述第二卷积模块进行计算得到第四特征图；将所述第四特征图输入所述轻量化卷积神经网络模块计算得到第五特征图；将所述第五特征图输入所述第二分割头进行解码，得到动物器官标注数据。在一些实现方式中，在前N次训练过程中，将所述Efficient Net模块的所有参数固定；在后M次训练过程中，将所述Efficient Net模块的所有参数开放，以允许所述所有参数与所述轻量化卷积神经网络模块的参数同时参与反馈调节；其中，N与M之和等于所述第二预设轮数。在一些实现方式中，训练所述人体器官分割模型和所述初始动物器官分割模型所采用的损失函数为BCE损失函数和Tversky损失函数之和；其中，在训练所述人体器官分割模型所用的Tversky损失函数中，参数α和参数β均为0.5；训练所述初始动物器官分割模型所用的Tversky损失函数中，参数α取值范围是0.2~0.35，参数β的取值范围是0.6~0.75。在一些实现方式中，所述使用强化学习方法对所述优化的动物器官分割模型进行微调训练，包括：将所述优化的动物器官分割模型复制为两份，分别为第一动物器官分割模型和第二动物器官分割模型；将所述第一动物医学图像和所述第二动物医学图像作为输入数据，输入所述第一动物器官分割模型和所述第二动物器官分割模型，分别得到第一动物器官标注结果和第二动物器官标注结果；分别计算所述第一动物器官标注结果与所述第一动物医学图像相应的动物器官标注数据之间的第一Dice精度值，和所述第二动物器官标注结果与所述第二动物医学图像相应的动物器官标注数据之间的第二Dice精度值；基于所述第一Dice精度值和所述第二Dice精度值计算惩罚项；将所述第二Dice精度作为得分，基于所述得分和所述惩罚项计算强化学习的奖励，将所述奖励反馈给所述第二动物器官分割模型进行参数更新；每训练一定周期，复制最新一次更新的所述第二动物器官分割模型的参数来覆盖上一次更新的所述第一动物器官分割模型的参数。在一些实现方式中，所述基于所述第一Dice精度值和所述第二Dice精度值计算惩罚项，采用如下计算式：，式中，λ表示惩罚项，表示第一Dice精度值，/＞表示第二Dice精度值。/＞在一些实现方式中，所述使用强化学习方法对所述优化的动物器官分割模型进行微调训练，还包括：基于上一次更新参数的所述第一动物器官分割模型生成的动物器官标注结果，最新一次更新参数的所述第二动物器官分割模型生成的动物器官标注结果和最终奖励，构建强化学习经验池，用于离线学习使用。第二方面，本发明实施例提供一种动物器官分割方法，包括：获取未标注动物器官的待分割动物医学图像；利用基于第一方面所述的动物器官分割模型训练方法预先训练得到的动物器官分割模型，对所述待分割动物医学图像进行动物器官分割，得到动物器官分割结果。第三方面，本发明实施例提供一种动物器官分割模型训练装置，包括：第一训练模块，用于获取已标注动物器官的第一动物医学图像及相应的动物器官标注数据，基于所述第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型；预标注模块，用于获取未标注动物器官的第二动物医学图像，并基于所述初始动物器官分割模型得到所述第二动物医学图像的动物器官预标注数据；第二训练模块，用于基于所述第一动物医学图像及相应的动物器官标注数据，和第二动物医学图像及相应的动物器官标注数据，训练所述初始动物器官分割模型，得到优化的动物器官分割模型，所述第二动物医学图像相应的动物器官标注数据是基于所述动物器官预标注数据修正得到。第四方面，本发明实施例提供一种动物器官分割装置，包括：获取模块，用于获取未标注动物器官的待分割动物医学图像；分割模块，用于利用基于第三方面所述的动物器官分割模型训练装置预先训练得到的动物器官分割模型，对所述待分割动物医学图像进行动物器官分割，得到动物器官分割结果。第五方面，本发明实施例提供一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被至少一个处理器执行时，实现如第一方面或第二方面所述的方法。第六方面，本发明实施例提供一种电子设备，包括存储器和至少一个处理器，所述存储器上存储有计算机程序，所述计算机程序被所述至少一个处理器执行时实现如第一方面或第二方面所述的方法。第七方面，本发明实施例提供一种计算机程序产品，所述计算机程序产品在处理器上运行时执行如第一方面或第二方面所述的方法。本发明的一个或多个实施例至少能够带来如下有益效果：先训练人体器官分割模型，利用迁移学习方法训练得到初始动物器官分割模型；引入新的未标注动物器官的第二动物医学图像，并基于初始动物器官分割模型得到第二动物医学图像中动物器官的动物器官预标注数据并由医生修正得到标注数据，基于两部分数据再次训练初始动物器官分割模型以优化初始动物器官分割模型，既实现了基于迁移学习对动物器官分割模型与数据训练，又解决了在数据量不足的情况下，将人类器官分割模型参数迁移到动物器官分割模型中难以适配和分割不准确的问题。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定。图1是本发明实施例提供的动物器官分割模型训练方法流程图；图2是本发明实施例提供的人体器官分割模型架构示意图；图3是本发明实施例提供的初始动物器官分割模型架构示意图；图4是本发明实施例提供的cSE注意力机制模块架构示意图；图5是本发明实施例提供的sSE注意力机制模块的架构示意图；图6是本发明实施例提供的scSE注意力机制模块的架构示意图；图7是本发明实施例提供的使用强化学习方法对优化的动物器官分割模型进行微调训练的流程示意图；图8是本发明实施例提供的动物器官分割模型训练流程示例；图9是本发明实施例提供的动物器官分割方法流程图；图10是本发明实施例提供的动物器官分割模型训练装置框图；图11是本发明实施例提供的动物器官分割装置框图。具体实施方式下面将结合本发明实施例中附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。通常在此处附图中描述和展示出的本发明实施例的组件可以以各种不同的配置来布置和设计。因此，以下对在附图中提供的本发明的实施例的详细描述并非旨在限制要求保护的本发明的范围，而是仅仅表示本发明的选定实施例。基于本发明的实施例，本领域技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。随着数字化技术与医学相融合，深度学习在处理医学影像中起到了越来越重要的作用。深度学习需要标注数据集，数据集质量越高，数量越大，模型效果越好。CV界的代表例是ImageNet，NLP界的代表例是BERT。在医学影像处理领域中，往往采用有监督的学习方法，通过医生标注的金标准来做训练集。由于数据标注成本太高，各种弱标注和无标注方法诞生，例如对比学习、能量模型方法，从而产生了大量弱监督、无监督模型和方法。CV界的代表例是DC-GAN，NLP界的代表例是GPT-2。对比学习等方法仍需要进行大量数据的训练，选择数据的成本甚至比有监督学习更高，因此不需要任何数据就能在新任务上实现功能的泛化性愈发显得重要。因此近年来迁移学习技术得到了高速的发展。迁移学习在CV和NLP界的方法基本一致，都没有专门的模型，而是使用各种调优技巧对原有模型进行调整，从而适应新的任务、领域、模态、数据或语言等。相关技术中，迁移学习在医学影像处理中的应用主要包括：1）肿瘤检测：利用迁移学习技术，可以从其他数据集中学习到有用的特征，从而提高肿瘤检测的准确性；2）病理图像分析：利用迁移学习技术，可以从其他数据集中学习到有用的特征，从而提高病理图像分析的准确性；3）脑部磁共振成像：利用迁移学习技术，可以从其他数据集中学习到有用的特征，从而提高脑部磁共振成像的准确性。然而，动物器官标记数据量通常较少，无法单独训练分割模型而达到分割的准确性要求，在现有动物器官标记数据量不足的情况下，即使直接将人类器官模型参数迁移到动物器官分割模型中，也会出现模型难以适配动物器官分割且分割不准确的情况。实施例一本实施例提供一种动物器官分割模型训练方法，如图1所示，至少包括步骤S101~步骤S103：步骤S101、获取已标注动物器官的第一动物医学图像及相应的动物器官标注数据，基于第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型。其中，动物例如是兔子。步骤S102、获取未标注动物器官的第二动物医学图像，并基于初始动物分割模型得到第二动物医学图像的动物器官预标注数据。步骤S103、基于第一动物医学图像及相应的动物器官标注数据，和第二动物医学图像及相应的动物器官标注数据，训练初始动物器官分割模型，得到优化的动物器官分割模型，第二动物医学图像相应的动物器官标注数据是基于动物器官预标注数据修正得到。在一些实现方式中，人体器官分割模型包括Efficient Net神经网络，例如Efficient Net b1神经网络。人体器官分割模型所采用的Efficient Net神经网络包括依次连接的第一卷积模块，Efficient Net模块和第一分割头。在步骤S101之前，本实施例的方法还包括：步骤S100、训练人体器官分割模型。本实施例中采用Efficient Net神经网络作为骨干网络进行人体器官分割模型训练，其架构如图2所示。该人体器官分割模型的训练过程可以如下：步骤S100a、对输入图像做零均值化处理。步骤S100b、对均值化处理后的数据进行数据增强处理。在一些示例中，数据增强处理中的运动模糊的概率为0.04~0.1，图像水平翻转的概率为0.1~0.3，图像垂直翻转的概率为0.1~0.3，图像的随机平移、尺寸和旋转变换的概率是0.2~0.4，图像产生网格畸变、光学畸变或弹性变换的概率是0.1~0.3，图像产生高斯噪声的概率为0.05~0.1。步骤S100c、将不少于第一预设数量的CT图像以预设比例划分为训练集、验证集和测试集，训练第一预设轮数，进而根据模型在验证集中得到的Dice值选出最终模型。在一个具体示例中，第一预设数量可以为500套，预设比例可以为8:1:1，第一预设轮数可以为10。将不少于500套CT图像以8:1:1的比例分为训练集、验证集和测试集，训练10轮，根据模型在验证集中得到的Dice结果选出最终模型。在一些实现方式中，训练第一预设轮数后，若Dice值大于0.95，则选出Dice值最大时对应的模型作为训练好的人体器官分割模型；若Dice值小于0.95，可以继续训练1~2轮，在继续训练1~2轮后，若Dice值仍然小于0.95，则直接选出Dice最大时对应的模型即可。其中的0.95也可以根据实际需求设置为其他阈值，本实施例对此阈值不作唯一限定。在一些示例中，可以使用Adam优化器进行模型训练，Adam优化器的学习率设置为10-4~10-5，权重衰减设置为10-4~10-6。在一些实现方式中，训练人体器官分割模型所采用的损失函数为BCE损失函数BCEloss和Tversky损失函数Tversky loss之和；损失函数的表达式为：BCE loss + Tversky loss，其中，Tversky loss的参数α=0.5，β=0.5，且当参数α和参数β均为0.5时，Tverskyloss相当于Dice loss。BCE损失函数lossBCE的计算式为：其中，n表示样本总数，x表示样本，集合A 表示医生绘制的标注数据，集合B表示模型生成的标注数据。Tversky损失函数具有两个参数α和β，其优势是通过调整α和β两个参数，可以控制假阳性FP和假阴性FN之间的平衡，进而影响较小分割区域和较大分割区域的分割准确度。Tversky损失函数的计算式为：其中，集合表示模型生成的标注数据，集合/＞表示医生绘制的标注数据；表示假阳性FP，/＞表示假阴性FN，/＞表示平滑系数，优选地，取值为时计算较为准确。Dice损失函数的计算式为：其中，表示样本总数，/＞表示样本，集合/＞为真实标签，即医生绘制的标注数据，集合/＞为生成器分割得到的预测标签，即模型生成的标注数据，/＞表示集合和集合/＞之间的共同元素，/＞表示A中的元素个数，/＞表示B中的元素个数，/＞表示平滑系数，优选地，取值为/＞时计算较为准确。由于现有的已由医生标注动物器官的动物医学图像数量非常有限，相比人类器官庞大的标注数据量，无法使用传统监督训练方法进行动物器官分割模型的训练。本实施例基于迁移学习方法，基于人体器官分割模型训练出初始动物器官分割模型，以初步获得动物器官分割模型。上述步骤S101中获取现有的少量已经过医生标注动物器官的第一动物医学图像及相应的动物器官标注数据，再使用这些数据进行迁移学习，应当说明的是，动物器官种类与人体器官种类一一对应。在利用迁移学习方法训练得到初始动物器官分割模型时，需要构建初始动物器官分割模型框架，如图3所示，初始动物器官分割模型包括依次连接的第一卷积模块，Efficient Net模块，上采样层，第二卷积模块，轻量化卷积神经网络模块和第二分割头，其中，第一卷积模块和Efficient Net模块是从Efficient Net神经网络迁移而来的。在初始动物器官分割模型的神经网络构建时，首先，去除Efficient Net神经网络的第一分割头，保留其第一卷积模块合Efficient Net模块，在Efficient Net模块后加入上采样层，用于将图像恢复到1*16*512*512的大小，基于输入的第一动物医学图像先后经过第一卷积模块、Efficient Net模块合上采样层后能够输出第一特征图，将第一特征图与第一卷积模块输出的与第二特征图的通道数维度连接起来，能够得到1*32*512*512的第三特征图，实现特征的融合，能够丰富动物器官特征。将第三特征图放入第二卷积模块中进行计算，能够得到1*16*512*512的第四特征图。将轻量化卷积神经网络模块接入第二卷积模块后，并加入第二分割头，能够基于第四特征图进一步计算得到最终的输出图像。在一些实现方式中，轻量化卷积神经网络模块可以包括scSE Mobile Net V3模块。具体的，scSE Mobile Net V3模块是将Mobile Net V3模块中的cSE注意力机制模块全部替换为scSE注意力机制模块得到的。scSE Mobile Net V3模块是改进的Mobile Net V3模块，只需要将Mobile Net V3模块中的cSE注意力机制模块全部替换为scSE注意力机制模块即可。其中，scSE注意力机制模块的输出结果为cSE注意力机制模块和sSE注意力机制模块结果之和。cSE注意力机制模块和sSE注意力机制模块的架构分别如图4和图5所示，scSE注意力机制模块的架构如图6所示。cSE注意力机制模块有较好的抗干扰性，例如对于高斯噪声有良好的抗性，但是其收敛速度较为缓慢，不容易快速聚焦感兴趣区域。sSE注意力机制对重点关注的感兴趣区域非常敏感，但同时对噪声也较为敏感，容易受到噪声干扰，出现分割区域不集中的现象，例如加入高斯噪声后的图像，sSE注意力机制无法正确识别图像中的感兴趣区域，往往会产生一盘散点，无法聚焦。因此，将Mobile Net V3模块中原有的cSE注意力机制模块替换为scSE注意力机制模块，能在提升模型抗干扰性的同时提高模型的收敛速度，使其对感兴趣区域更加敏感。Mobile Net V3模块的参数少，在数据量较小的情况下通过改进Mobile Net V3模块能够很容易实现快速拟合。基于第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练得到初始动物器官分割模型，包括：步骤S101a、对输入图像做零均值化处理。步骤S101b、对零均值化处理后的数据进行数据增强处理。在一些示例中，数据增强处理中的运动模糊的概率为0.04~0.1，图像水平翻转的概率为0.1~0.3，图像垂直翻转的概率为0.1~0.3，图像的随机平移、尺寸和旋转变换的概率是0.2~0.4，图像产生网格畸变、光学畸变或弹性变换的概率是0.1~0.3，图像产生高斯噪声的概率为0.05~0.1。步骤S101c、将不少于第二预设数量的CT图像以预设比例分为训练集、验证集和测试集。步骤S101d、执行第二预设轮数对初始动物器官分割模型的预设训练过程。在一些示例中，此处的第二预设数量可以取30套，此处的预设比例可以取8:1:1，第二预设轮数可以是100轮。在一些示例中，可以使用Adam优化器进行模型训练，学习率为，权重衰减为/＞。其中，预设训练过程包括：基于输入的第一动物医学图像，经过第一卷积模块、Efficient Net模块和上采样层，计算得到第一特征图；基于输入的第一动物医学图像，利用第一卷积模块计算得到第二特征图；将第一特征图和第二特征图融合，得到第三特征图；第三特征图输入第二卷积模块进行计算得到第四特征图；将第四特征图输入轻量化卷积神经网络模块计算得到第五特征图；以及将第五特征图输入第二分割头进行解码，得到动物器官标注数据。Efficient Net模块是在人体器官分割模型训练好的模块，其学习了人体器官的特征，在一些实现方式中，在第二预设轮数的初始动物器官分割模型训练中，前N次训练过程中，将Efficient Net模块的所有参数固定，不允许其参数参与反馈调节；后M次训练过程中，将Efficient Net模块的所有参数开放，以允许其所有参数与轻量化卷积神经网络模块的参数同时参与反馈调节；其中，N与M之和等于第二预设轮数。以训练100轮为例，在最初的1~50轮训练中，固定Efficient Net模块的所有参数，不允许其参数参与反馈调节。在51~100轮训练中，开放Efficient Net模块的所有参数，允许其参数和Mobile Net模块的参数同时调节。在训练51~100轮期间，根据模型在验证集中得到的Dice值，确定训练好的初始动物器官分割模型，具体而言，可以是选出Dice值最高的模型作为初始动物器官分割模型。Mobile Net小模型的嵌入大大提高了整体模型的收敛速度，提高了动物器官分割模型对人体器官分割模型参数的迁移效果。在一些实现方式中，训练初始动物器官分割模型所采用的损失函数为BCE损失函数和Tversky损失函数之和；损失函数的表达式为：BCE loss + Tversky loss，其中，Tversky loss的参数α取值范围是0.2~0.35，β的取值范围是0.6~0.75，在一个示例中，α=0.3，β=0.7。参数α和参数β的设置增加了图像分割灵敏度的权重，有利于动物脏器和骨骼等小区域的分割。从人体器官分割模型迁移到初始动物器官分割模型，所得的分割效果仍然不够理想，通过继续获得新的动物医学图像数据，使用动物器官初始模型进行预标注，医生对预标注结果进行修改后，再次训练得到优化的动物器官分割模型，有效改善分割效果。在本实施例中，可以引入未标注动物器官的第二动物医学图像继续训练动物器官分割模型，具体来说，先使用初始动物器官分割模型计算第二动物医学图像的动物器官预标注数据，再由医生修改预标注数据后，基于第一动物医学图像及相应的动物器官标注数据，和第二动物医学图像及相应的动物器官标注数据，训练前述迁移学习得到的初始动物器官分割模型，得到优化的动物器官分割模型，有效补充了训练所需数据，且第二动物医学图像相应的动物器官标注数据是医生基于动物器官预标注数据修正后得到的，将医生修正过的数据与原有的第一动物医学图像及相应的动物器官标注数据整理在一起，再次训练初始动物器官分割模型，有利于提升动物器官分割模型的分割效果。优化的动物器官分割模型既可以作为初始动物器官分割模型，在后续模型训练中继续为医生提供预标注数据，也可以在后续步骤中利用强化学习方法进行模型微调，形成最终的动物器官分割模型，还可以直接作为最终的动物器官分割模型进行部署，以进行未标注动物医学图像的动物器官分割。优化的动物器官分割模型相较于初始的动物器官分割模型的模型架构不变，如图3所示。在一些实现方式中，优化的动物器官分割模型的训练，包括：步骤S103a、对输入图像做零均值化处理。步骤S103b、对零均值化处理后的数据进行数据增强处理。在数据增强处理中运动模糊的概率为0.04~0.1，图像水平翻转的概率为0.1~0.3，图像垂直翻转的概率为0.1~0.3，图像的随机平移、尺寸和旋转变换的概率是0.2~0.4，图像产生网格畸变、光学畸变或弹性变换的概率是0.1~0.3，图像产生高斯噪声的概率为0.05~0.1。可以使用Adam优化器进行模型训练，学习率为，权重衰减为/＞。同样地，损失函数为：BCE loss + Tversky loss，其中，Tversky loss的参数α取值范围是0.2~0.35，β的取值范围是0.6~0.75，在一个示例中，α=0.3，β=0.7。损失函数BCE loss和损失函数Tversky loss的表达式同前。步骤S103c、将第一动物医学图像及相应的动物器官标注数据和第二动物医学图像及相应的动物器官标注数据，划分为训练集、验证集和测试集。假设数据库中原始数据的数量为m，其中训练集数量为mtr，验证集的数量为mv，测试集的数量为mts，新引入的数据的数量为n。因此，再次对初始动物器官分割模型进行再次训练时的全部数据包括m+n套CT图像，将全部m+n套CT图像分为mtr+套训练集、mv+套验证集和mts+套测试集。针对优化的动物器官分割模型的训练，需要执行第三预设轮数的前述预设训练过程，预设训练过程的具体内容参考前述，此处不再赘述，应当理解的是，此次训练新引入了医生修订标注后的第二动物医学图像与已有的第一动物医学图像作为输入图像。在一个示例中，第三预设轮数例是30轮。类似地，在第三预设轮数的初始动物器官分割模型再次优化训练中，前N’次训练过程中，将Efficient Net模块的所有参数固定，不允许其参数参与反馈调节；后M’次训练过程中，将Efficient Net模块的所有参数开放，以允许其所有参数与轻量化卷积神经网络模块的参数同时参与反馈调节；其中，N’与M’之和等于第三预设轮数。以训练30轮为例，在最初的1~20轮训练中，固定Efficient Net模块的所有参数，不允许其参数参与反馈调节。在21~30轮训练中，开放Efficient Net模块的所有参数，允许其参数和Mobile Net模块的参数同时调节。在训练21~30轮期间，根据模型在验证集中得到的Dice值，确定训练好的初始动物器官分割模型。当Dice值大于0.95时，选出Dice值最大时对应的模型作为动物器官优化模型；当Dice值小于0.95时，可以继续延后训练5~10轮；如果Dice值仍然小于0.95，那么直接选出Dice最大时对应的模型即可。在一些情况下，判断阈值也可以为0.9，并不限于0.95，判断阈值的具体设定可以根据实际模型精度需求设置，本实施例对具体数值不做唯一限定。在实际应用中，如果当前优化的模型其分割效果不能达到要求，还可以将优化的动物器官分割模型作为初始动物器官分割模型，引入新的数据进行新一轮的训练，这里，新的数据可以是指基于新的未标注动物器官的第二动物医学图像和初始动物器官分割模型得到预标注数据，并由医生修正后与第一动物医学图像及相应动物器官标注数据整理而成的数据。在一些情况下，仅仅依靠有限的数据量，模型可能无法学习到分割任务中的更多特征，因此，还可以借助强化学习方法进行优化的动物器官分割模型的进一步微调。在一些实现方式中，本实施例的动物器官分割模型训练方法还包括：步骤S104、使用强化学习方法对优化的动物器官分割模型进行微调训练。在一些实现方式中，步骤S104可以进一步包括：步骤S104a、将优化的动物器官分割模型复制为两份，分别为第一动物器官分割模型和第二动物器官分割模型；步骤S104b、将第一动物医学图像和第二动物医学图像作为输入数据，输入第一动物器官分割模型和第二动物器官分割模型，分别得到第一动物器官标注结果和第二动物器官标注结果；步骤S104c、分别计算第一动物器官标注结果与第一动物医学图像相应的动物器官标注数据之间的第一Dice精度值，和第二动物器官标注结果与第二动物医学图像相应的动物器官标注数据之间的第二Dice精度值；步骤S104d、基于第一Dice精度值和第二Dice精度值计算惩罚项。在一些实现方式中，计算惩罚项采用如下计算式：，式中，λ表示惩罚项，表示第一Dice精度值，/＞表示第二Dice精度值。在实际应用中，Dice系数的表达式可以如下：其中，表示样本总数；/＞表示样本；集合/＞为医生绘制的标注结果；集和合/＞为模型生成的标注结果；/＞表示集合/＞和集/＞之间的共同元素；/＞表示A中的元素个数，/＞表示B中的元素个数；/＞表示平滑系数，优选地，取值为/＞时计算的Dice值较为准确。步骤S104e、将第二Dice精度作为得分，基于得分和惩罚项计算强化学习的奖励，将奖励反馈给第二动物器官分割模型进行参数更新。基于得分和惩罚项计算强化学习的奖励的计算式如下：步骤S104f、每训练一定周期，复制最新一次更新的第二动物器官分割模型的参数来覆盖上一次更新的第一动物器官分割模型的参数。采用上述两个相同模型的异步更新策略，可以加快模型的训练速度，控制模型优化的速度和方向，每一个阶段都能稳定的调节。其中的惩罚项λ是控制更新幅度的一种方式，通过比较两个模型输出结果的差异，来评价更新幅度的大小，从而控制模型的更新幅度，保证不剧烈更新，从而提高训练稳定性。通过不断的奖励反馈，模型可以学习到比监督学习更加丰富的特征，这些都是模型自己探索的结果，有利于在数据不足的情况下提高标注的多样性，使得模型达到更好的效果。在一些实现方式中，使用强化学习方法对优化的动物器官分割模型进行微调训练，还可以包括：基于上一次更新参数的第一动物器官分割模型生成的动物器官标注结果，最新一次更新参数的第二动物器官分割模型生成的动物器官标注结果和最终奖励，构建强化学习经验池，用于离线学习使用。本实施例中，通过上一次更新参数的第一动物器官分割生成的数据标注、新一次更新参数的第二动物器官分割模型生成的数据标注和最终奖励reward构建强化学习经验池，用于离线学习，这些经验的回放有利于提高样本利用率，增加训练稳定性；减少样本之间的相关性，避免模型学习出现偏差，同时减少模型遗忘；允许模型进行离线学习，可以避免在线训练时的样本浪费；支持多任务学习，提高模型的泛化能力。在实际应用中，强化学习方法可以采用PPO架构。通过强化学习微调最终形成的动物器官分割模型，可以作为最终模型进行部署。如图7所示，在模型微调过程中，先将动物器官优化模型复制两份，分别为上一次更新的模型和最新一次更新的模型，这里的更新指的是模型参数的更新。将第一动物医学图像及相应的标注数据和第二动物医学图像及相应的标注数据作为输入数据，分别输入上一次更新的模型和最新一次更新的模型中，上一次更新的模型会生成和最新一次更新的模型分别会生成各自输出的标注数据。使用两个模型生成的标注数据，与对应的医生绘制的动物器官标注数据计算惩罚项λ，再根据最新一次更新的模型的标注结果和医生绘制的标注数据来计算最新一次更新的模型标注数据的Dice精度，作为得分score，最终反馈给强化学习的奖励reward，保持上一次更新的模型参数固定不变，只更新最新一次更新的模型的参数。在训练一定周期后，复制最新一次更新的模型的参数覆盖上一次更新的模型参数，即可实现模型的更新。模型更新的周期视具体训练情况而定。在上一次更新的模型参数更新后，继续保持上一次更新的模型参数不变，不断训练和调节最新一次更新的模型参数，进一步实现模型优化，如此实现模型的微调。图8示出了一种动物器官分割模型训练流程示例。首先通过少量的已标注动物器官的图像数据，将人体器官分割模型迁移学习成初始动物器官分割模型。再引入未标注的图像数据，使用初始动物器官分割模型计算得到预标注结果。医生在预标注结果上继续修改，形成医生绘制的动物器官标注数据。将这部分新的动物器官标注数据与服务器中原有的旧数据整理在一起，再次训练初始动物器官分割模型，得到优化的动物器官分割模型。该优化的动物器官分割模型可以作为初始动物器官分割模型为医生继续提供预标注数据，也可以利用强化学习方法进行模型微调，最终形成微调后的动物器官分割模型，作为最终模型进行部署。实施例二本实施例提供一种动物器官分割方法，如图9所示，包括：步骤S201、获取未标注动物器官的待分割动物医学图像；步骤S202、利用基于实施例一的动物器官分割模型训练方法预先训练得到的动物器官分割模型，对待分割动物医学图像进行动物器官分割，得到动物器官分割结果。本实施例中，利用基于实施例一的动物器官分割模型训练方法预先训练得到的动物器官分割模型，对待分割动物医学图像进行动物器官分割，能够得到准确的动物器官分割结果，有利于动物实验的术前规划。实施例三本实施例提供一种动物器官分割模型训练装置，如图10所示，包括：第一训练模块301，用于获取已标注动物器官的第一动物医学图像及相应的动物器官标注数据，基于第一动物医学图像及相应的动物器官标注数据和预先训练的人体器官分割模型，利用迁移学习方法训练初始动物器官分割模型；预标注模块302，用于获取未标注动物器官的第二动物医学图像，并基于初始动物器官分割模型得到第二动物医学图像的动物器官预标注数据；第二训练模块303，用于基于第一动物医学图像及相应的动物器官标注数据，和第二动物医学图像及相应的动物器官标注数据，训练初始动物器官分割模型，得到优化的动物器官分割模型，第二动物医学图像相应的动物器官标注数据是基于动物器官预标注数据修正得到。各模块的具体实现方式可参见实施例一，本实施例中不再赘述。应当说明的是，本实施例装置具有实施例一的全部有益效果。实施例四本实施例提供一种动物器官分割装置，如图11所示，包括：获取模块401，用于获取未标注动物器官的待分割动物医学图像；分割模块402，用于利用基于实施例三的动物器官分割模型训练装置预先训练得到的动物器官分割模型，对待分割动物医学图像进行动物器官分割，得到动物器官分割结果。各模块的具体实现方式可参见实施例二，本实施例中不再赘述。应当说明的是，本实施例装置具有实施例二的全部有益效果。实施例五本实施例提供一种计算机可读存储介质，计算机可读存储介质上存储有计算机程序，计算机程序被至少一个处理器执行时，实现实施例一或实施例二的方法。应当说明的是，本实施例具有实施例一或实施例二的全部有益效果。实施例六本实施例提供一种电子设备，包括存储器和至少一个处理器，存储器上存储有计算机程序，计算机程序被至少一个处理器执行时实现实施例一或实施例二的方法。应当说明的是，本实施例具有实施例一或实施例的全部有益效果。实施例七本实施例提供一种计算机程序产品，计算机程序产品在处理器上运行时执行实施例一或实施例二的方法。应当说明的是，本实施例具有实施例一或实施例的全部有益效果。前述处理器可以是专用集成电路、数字信号处理器、数字信号处理设备、可编程逻辑器件、现场可编程门阵列、控制器、微控制器 、微处理器或其他电子元件实现，用于执行上述实施例中的走滑断裂应变类型判识方法。前述计算机可读存储介质可以由任何类型的易失性或非易失性存储设备或者它们的组合实现，例如静态随机存取存储器，电可擦除可编程只读存储器，可擦除可编程只读存储器，可编程只读存储器，只读存储器，磁存储器，快闪存储器，磁盘或光盘。在本发明实施例所提供的几个实施例中，应该理解到，所揭露的装置和方法，也可以通过其它的方式实现。以上所描述的装置和方法实施例仅仅是示意性的。需要说明的是，在本文中，本申请的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。虽然本发明所揭露的实施方式如上，但所述的内容只是为了便于理解本发明而采用的实施方式，并非用以限定本发明。任何本发明所属技术领域内的技术人员，在不脱离本发明所揭露的精神和范围的前提下，可以在实施的形式上及细节上作任何的修改与变化，但本发明的专利保护范围，仍须以所附的权利要求书所界定的范围为准。
