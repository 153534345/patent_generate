标题title
一种风光储氢联合发电系统的协同优化控制方法及系统
摘要abst
本发明提出了一种风光储氢联合发电系统的协同优化控制方法及系统，属于电网优化调度技术领域，解决了电力系统的安全稳定运行、实现新能源的深度消纳的问题，包括：根据风光储氢联合发电系统的参数信息建立日前全局优化模型；求解所述日前全局优化模型，得到多个最优方案并从多个最优方案中选出所需的风光储氢计划出力方案；根据超短期气象预测数据估算风电场和光伏电站的可调容量，平衡风电场和光伏电站的出力差额，输出调整后的优化风光储氢计划出力方案，并交由风电场和光伏电站执行；根据风电场和光伏电站执行的实时出力数据、混合储能电站的容量数据，获得混合储能电站的优化出力方案。
权利要求书clms
1.一种风光储氢联合发电系统的协同优化控制方法，其特征是，包括：根据风光储氢联合发电系统的参数信息建立日前全局优化模型；求解所述日前全局优化模型，得到多个最优方案并从多个最优方案中选出所需的风光储氢计划出力方案；根据超短期气象预测数据估算风电场和光伏电站的可调容量，平衡风电场和光伏电站的出力差额，输出调整后的优化风光储氢计划出力方案，并交由风电场和光伏电站执行；根据风电场和光伏电站执行的实时出力数据、混合储能电站的容量数据，获得混合储能电站的优化出力方案。2.如权利要求1所述的一种风光储氢联合发电系统的协同优化控制方法，其特征是，所述日前全局优化模型中目标函数包括：风光储氢联合发电系统总的平均功率偏差最小；混合储能电站的总充放电切换次数最小；混合储能电站平均剩余等效电量最大；以及联合发电系统的总净产氢量最大；所述日前全局优化模型中约束条件包括：混合储能电站容量约束、联合发电系统制氢约束、混合储能电站功率约束、风电场出力约束以及光伏电站出力约束；所述风电场出力约束包括风电场的出力功率约束和出力功率调节速度约束；所述光伏电站出力约束包括光伏电站的出力功率约束和出力功率调节速度约束。3.如权利要求1所述的一种风光储氢联合发电系统的协同优化控制方法，其特征是，根据超短期气象预测数据估算风电场和光伏电站的可调容量，平衡风电场和光伏电站的出力差额，具体步骤为：令风速、光照和温度预测值与实际气象条件相同，根据超短期气象预测数据估算的风电场和光伏电站的可捕获功率上限分别减去对应的风电场和光伏电站的计划出力值得到风电场和光伏电站的可调裕量；当风电场和光伏电站的可调裕量符号相异时，对风电场和光伏电站的计划出力进行优化微调；若风电场的可调裕量为正，光伏电站的可调裕量为负，则风电场将承担一部分光伏电站的计划出力，获得调整后的风电场和光伏电站优化出力；若光伏电站的可调裕量为正，风电场的可调裕量为负，则光伏电站将承担一部分风电场的计划出力，获得调整后的风电场和光伏电站优化出力；将上述优化出力方案交由风电场和光伏电站执行，并采集风电场和光伏电站的实时出力数据。4.如权利要求1所述的一种风光储氢联合发电系统的协同优化控制方法，其特征是，获得混合储能电站的优化出力方案时，包括考虑电、氢混合储能的出力配合模式以及氢储能的短时过载模式；基于采集风电场和光伏电站的实时出力数据、联合发电系统总的计划出力得到联合发电系统风光出力的差额；考虑该差额，当电储能处在正常运行模式时，混合储能电站的实时控制策略根据电储能的剩余电量决定；当识别到风电场和光伏电站的下爬坡幅度超过设定的启动阈值时，氢储能进入短时过载模式。5.如权利要求4所述的一种风光储氢联合发电系统的协同优化控制方法，其特征是，电储能处于低电量区间时，若联合发电系统功率偏差为正，混合储能电站需要吸纳一部分风电场和光伏电站的出力裕量，降低联合发电系统功率偏差；当联合发电系统功率偏差大于等于电储和氢储能的最小充电功率时，调用混合储能电站吸收盈余功率；当处在低电量区间的电储能以最大充电功率依然无法消纳新能源的发电量时，剩余部分由氢储能消纳；若联合发电系统功率偏差为负，混合储能电站需要弥补一部分风电场和光伏电站的出力缺额，降低联合发电系统功率偏差；电储能处于低电量区，优先由氢储能供给电量；当氢储能以最大放电功率依然无法达到联合发电系统计划出力时，再由处于低电量区的电储能供应电量。6.如权利要求5所述的一种风光储氢联合发电系统的协同优化控制方法，其特征是，电储能处于正常电量区间时，使用氢储能弥补风光出力与联合发电系统计划出力的差值，缺失部分再由电储能进行弥补；若联合发电系统功率偏差为正，则混合储能电站需要吸纳一部分风电场和光伏电站的发电裕量；若联合发电系统功率偏差大于氢储能的功率，调用电储能吸纳剩余的风电场和光伏电站出力；联合发电系统功率偏差为负时，此时风电场和光伏电站出力小于联合发电系统计划出力，混合储能电站需要放电；联合发电系统功率偏差大于氢储能的功率时，则调用电储能弥补风电场和光伏电站的出力。7.如权利要求6所述的一种风光储氢联合发电系统的协同优化控制方法，其特征是，电储能处于高电量区间时，需要对其充电功率进行限制；若联合发电系统功率偏差为正，混合储能电站需要吸纳一部分风电场和光伏电站的发电裕量；若联合发电系统功率偏差大于等于电储和氢储能的最小充电功率时，调用混合储能电站吸收盈余功率；调用混合储能电站吸收盈余功率时，混合储能电站优先给氢储能充电；当氢储能以最大充电功率依然无法达到联合发电系统计划出力时，再由处于高电量区的电储能吸纳部分电量；若联合发电系统功率偏差为负，混合储能电站需要弥补一部分风电场和光伏电站的出力缺额，降低联合发电系统功率偏差；若联合发电系统功率偏差为负，优先由处于高电量区的电储能进行放电；当处在高电量区间的电储能以最大充电功率依然无法满足计划出力，剩余部分由氢储能消纳。8.一种风光储氢联合发电系统的协同优化控制系统，其特征是，包括：日前全局优化模型建立模块，被配置为：根据风光储氢联合发电系统的参数信息建立日前全局优化模型；日前全局优化模块，被配置为：求解所述日前全局优化模型，得到多个最优方案并从多个最优方案中选出所需的风光储氢计划出力方案；根据联合发电系统的整体计划出力、风电场和光伏电站的预测出力以及混合储能电站容量信息，得到风光储氢的计划出力方案；日内滚动优化模块，用于综合考虑风光互补、混合储能电站使用寿命和氢储能短时过载能力三个因素，调整日前全局优化模块输出的计划出力方案，依次得到风电场和光伏电站、混合储能电站的优化出力方案；其中，日内滚动优化模块包括：风光互补实时控制子模块，用于根据气象信息实时优化风电场和光伏电站的计划出力方案；混合储能实时控制子模块，用于根据混合储能电站容量状态和风电场和光伏电站的优化出力方案，制定混合储能电站的优化出力方案。9.一种计算机装置,包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征是，所述处理器执行所述程序时实现上述权利要求1-7任一所述的方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征是，该程序被处理器执行时执行上述权利要求1-7任一所述的方法的步骤。
说明书desc
技术领域本发明属于电网优化调度技术领域，尤其涉及一种风光储氢联合发电系统的协同优化控制方法及系统。背景技术本部分的陈述仅仅是提供了与本发明相关的背景技术信息，不必然构成在先技术。随着全球能源需求的不断增长和气候变化问题的愈加明显，新能源逐渐受到世界各国青睐。风能和太阳能作为新能源的代表，近年来得到了长足的发展。新能源的发电量占全社会用电量比例逐步升高。然而，新能源的随机性给电力系统安全运行带来了新的挑战。正是在这一背景下，风光储氢联合发电系统崭露头角，成为应对新能源随机性问题的有力手段。目前已对风光储氢联合发电系统开展了一系列的研究工作，包括采用蓄电池分组分次充放电策略、分时段优化策略以及利用复合储能技术来平抑功率波动等。但现有针对风光储氢联合发电系统协调控制的研究主要集中在储能的优化控制上，未考虑与风电、光伏的协调配合，也未考虑混合储能的配合以及氢储能的短时过载能力对平抑风光波动的影响，极大地限制了优化调度的决策空间。氢储能中将氢气转化为电能的部件为燃料电池，其短时间的过载能力可以达到额定功率的200%，在面对偶发性较强的新能源出力爬坡事件的时候， 短时间内可以提供更多的有功支撑。随着氢储能近年的大力发展，氢储能的短时过载能力对电力系统的影响愈发深远，因此需要考虑氢储能的短时过载能力对风光波动特别是爬坡事件的影响。现有的论文文献“大规模风电爬坡有限度控制研究”没有将单一电储能扩展为电、氢混合储能，没有结合电化学储能高体积能量密度和氢储能循环寿命更高的优势，制定混合储能电站的协调调度策略，无法达到在保持储能电站响应维持一致的同时，最大程度的提高储能电站的使用寿命，提高联合发电系统的经济性与实用性。没有实现：在改善新能源并网稳定性的同时，额外引入目前国家大力发展的新能源制氢的方式，没有实现采用“优先上网，余电制氢”的调度策略，将多余的新能源出力转换成氢气，参与工业生产，无法实现对新能源的消纳，存在目前由于新能源波动引发的弃风弃光的问题。因此，如何综合考虑风光互补特性以及电氢混合储能的动态响应特性，进而改善新能源并网稳定性，对电力系统的安全稳定运行、实现新能源的深度消纳具有重要意义。发明内容为克服上述现有技术的不足，本发明提供了一种风光储氢联合发电系统的协同优化控制方法，在保证联合发电系统稳定运行的同时提高联合发电系统对新能源的消纳。为实现上述目的，本发明的一个或多个实施例提供了如下技术方案：第一方面，公开了一种风光储氢联合发电系统的协同优化控制方法，包括：根据风光储氢联合发电系统的参数信息建立日前全局优化模型；求解所述日前全局优化模型，得到多个最优方案并从多个最优方案中选出所需的风光储氢计划出力方案；根据超短期气象预测数据估算风电场和光伏电站的可调容量，平衡风电场和光伏电站的出力差额，输出调整后的优化风光储氢计划出力方案，并交由风电场和光伏电站执行；根据风电场和光伏电站执行的实时出力数据、混合储能电站的容量数据，获得混合储能电站的优化出力方案。作为进一步的技术方案，所述日前全局优化模型中目标函数包括：风光储氢联合发电系统总的平均功率偏差最小；混合储能电站的总充放电切换次数最小；混合储能电站平均剩余等效电量最大；以及联合发电系统的总净产氢量最大。作为进一步的技术方案，所述日前全局优化模型中约束条件包括：混合储能电站容量约束、联合发电系统制氢约束、混合储能电站功率约束、风电场出力约束以及光伏电站出力约束；优选的，所述风电场出力约束包括风电场的出力功率约束和出力功率调节速度约束；优选的，所述光伏电站出力约束包括光伏电站的出力功率约束和出力功率调节速度约束。作为进一步的技术方案，求解所述日前全局优化模型时，以联合发电系统总的计划出力、风电场和光伏的预测出力以及混合储能容量信息作为输入，以设定的时间为优化时段，采用NSGA-Ⅱ算法求解建立的日前全局优化模型，得到含有多个Pareto最优方案的初始集合。作为进一步的技术方案，从多个最优方案中选出所需的风光储氢计划出力方案，筛选时目标函数的优先级具体为：依次以联合发电系统总功率偏差最小、混合储能电站的总充放电切换次数最小、混合储能电站平均剩余等效电量最大以及联合发电系统的氢气净产量最大为偏好优先级，对最优方案进行筛选。作为进一步的技术方案，对最优方案进行筛选，筛选过程为：步骤一：将NSGA-Ⅱ算法求解得到的解集作为初始方案集合，根据实际场景的应用要求设置联合发电系统总功率偏差的期望值/＞，筛选出总功率偏差小于/＞的方案作为方案集合/＞，若/＞为空集，则需要增加/＞，重复执行本步骤；步骤二：从方案集合中筛选出单个时段内电储能和氢储能总充放电次数小于或等于设定值的方案作为方案集合/＞，若/＞为空集，则需要返回步骤一，增加/＞并重新筛选方案集合/＞；步骤三：设置混合储能电站平均剩余等效电量的期望值，从方案集合/＞中筛选出平均剩余等效电量大于/＞的方案作为方案集合/＞，若集合/＞为空集，则增加/＞并重新筛选方案集合/＞；步骤四：从方案集合中选择氢气净产量最大的方案作为最终方案。作为进一步的技术方案，根据超短期气象预测数据估算风电场和光伏电站的可调容量，平衡风电场和光伏电站的出力差额，具体步骤为：令风速、光照和温度预测值与实际气象条件相同，根据超短期气象预测数据估算的风电场和光伏电站的可捕获功率上限分别减去对应的风电场和光伏电站的计划出力值得到风电场和光伏电站的可调裕量；当风电场和光伏电站的可调裕量符号相异时，对风电场和光伏电站的计划出力进行优化微调。作为进一步的技术方案，若风电场的可调裕量为正，光伏电站的可调裕量为负，则风电场将承担一部分光伏电站的计划出力，获得调整后的风电场和光伏电站优化出力；若光伏电站的可调裕量为正，风电场的可调裕量为负，则光伏电站将承担一部分风电场的计划出力，获得调整后的风电场和光伏电站优化出力；将上述优化出力方案交由风电场和光伏电站执行，并采集风电场和光伏电站的实时出力数据。作为进一步的技术方案，获得混合储能电站的优化出力方案时，包括考虑电、氢混合储能的出力配合模式以及氢储能的短时过载模式；基于采集风电场和光伏电站的实时出力数据、联合发电系统总的计划出力得到联合发电系统风光出力的差额；考虑该差额，当电储能处在正常运行模式时，混合储能电站的实时控制策略根据电储能的剩余电量决定；当识别到风电场和光伏电站的下爬坡幅度超过设定的启动阈值时，氢储能进入短时过载模式。作为进一步的技术方案，电储能处于低电量区间时，若联合发电系统功率偏差为正，混合储能电站需要吸纳一部分风电场和光伏电站的出力裕量，降低联合发电系统功率偏差；优选的，当联合发电系统功率偏差大于等于电储和氢储能的最小充电功率时，调用混合储能电站吸收盈余功率；优选的，当处在低电量区间的电储能以最大充电功率依然无法消纳新能源的发电量时，剩余部分由氢储能消纳；优选的，若联合发电系统功率偏差为负，混合储能电站需要弥补一部分风电场和光伏电站的出力缺额，降低联合发电系统功率偏差；优选的，电储能处于低电量区，优先由氢储能供给电量；优选的，当氢储能以最大放电功率依然无法达到联合发电系统计划出力时，再由处于低电量区的电储能供应电量。作为进一步的技术方案，电储能处于正常电量区间时，使用氢储能弥补风光出力与联合发电系统计划出力的差值，缺失部分再由电储能进行弥补；优选的，若联合发电系统功率偏差为正，则混合储能电站需要吸纳一部分风电场和光伏电站的发电裕量；优选的，若联合发电系统功率偏差大于氢储能的功率，调用电储能吸纳剩余的风电场和光伏电站出力；优选的，联合发电系统功率偏差为负时，此时风电场和光伏电站出力小于联合发电系统计划出力，混合储能电站需要放电；优选的，联合发电系统功率偏差大于氢储能的功率时，则调用电储能弥补风电场和光伏电站的出力。作为进一步的技术方案，电储能处于高电量区间时，需要对其充电功率进行限制；优选的，若联合发电系统功率偏差为正，混合储能电站需要吸纳一部分风电场和光伏电站的发电裕量；优选的，若联合发电系统功率偏差大于等于电储和氢储能的最小充电功率时，调用混合储能电站吸收盈余功率；优选的，调用混合储能电站吸收盈余功率时，混合储能电站优先给氢储能充电；优选的，当氢储能以最大充电功率依然无法达到联合发电系统计划出力时，再由处于高电量区的电储能吸纳部分电量；若联合发电系统功率偏差为负，混合储能电站需要弥补一部分风电场和光伏电站的出力缺额，降低联合发电系统功率偏差；优选的，若联合发电系统功率偏差为负，优先由处于高电量区的电储能进行放电；优选的，当处在高电量区间的电储能以最大充电功率依然无法满足计划出力，剩余部分由氢储能消纳。作为进一步的技术方案，氢储能短时过载模式的触发条件可以表示为：；其中，和/＞分别为风电场与光伏电站上一时刻和当前时刻总的实时出力，/＞和/＞分别为风电场与光伏电站上一时刻和当前时刻的优化计划出力，/＞为启动阈值。第二方面，公开了一种风光储氢联合发电系统的协同优化控制系统，包括：日前全局优化模型建立模块，被配置为：根据风光储氢联合发电系统的参数信息建立日前全局优化模型；日前全局优化模块，被配置为：求解所述日前全局优化模型，得到多个最优方案并从多个最优方案中选出所需的风光储氢计划出力方案；根据联合发电系统的整体计划出力、风电场和光伏电站的预测出力以及混合储能电站容量信息，得到风光储氢的计划出力方案；日内滚动优化模块，用于综合考虑风光互补、混合储能电站使用寿命和氢储能短时过载能力三个因素，调整日前全局优化模块输出的计划出力方案，依次得到风电场和光伏电站、混合储能电站的优化出力方案；其中，日内滚动优化模块包括：风光互补实时控制子模块，用于根据气象信息实时优化风电场和光伏电站的计划出力方案；混合储能实时控制子模块，用于根据混合储能电站容量状态和风电场和光伏电站的优化出力方案，制定混合储能电站的优化出力方案。以上一个或多个技术方案存在以下有益效果：本发明技术方案提供了一种风光储氢联合发电系统的协同优化控制方法及系统，在所述方法中构建了日前全局优化模型和日内滚动优化控制策略，日前全局优化模型采用NSGA-Ⅱ算法和应用场景筛选方法制定计划出力方案，日内滚动优化控制策略调整计划出力方案得到最优的出力方案，该方法综合考虑风光互补、混合储能电站使用寿命和氢储能短时过载能力三个因素，在不增加储能容量的基础上，增强功率补偿能力，以应对风电场和光伏电站可能出现的快速爬坡事件，在此基础上盈余的新能源发电量被用于生产氢气，在保证联合发电系统稳定运行的同时提高联合发电系统对新能源的消纳。本发明技术方案采用日前全局优化和日内滚动优化相结合的方式，计算需求大的日前全局优化模型离线计算计划出力方案，计算需求小的日内混动优化控制策略根据实时出力情况对计划出力进行在线调整优化，大大提高了系统的在线响应速度。其中，日前全局优化模型中公开了一种动态限制储能充放电功率的方法，能够有效避免电储能的过充和过放，延长电储能的使用寿命。本发明技术方案混合储能电站结合了电储能和氢储能的优势，在保证联合发电系统稳定运行的同时，盈余的新能源发电量被用于生产氢气，提高新能源的消纳水平。本发明附加方面的优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明构成本发明的一部分的说明书附图用来提供对本发明的进一步理解，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。图1为本发明实施例所述风光储氢联合发电系统的架构图；图2为本发明实施例所述风光储氢联合发电系统的协同优化控制方法的系统控制模型；图3为本发明实施例一中的应用场景筛选方法流程图；图4为新能源出力的预测数据以及电网下发的计划出力示意图；图5为联合发电系统各部分的功率输出示意图；图6为向外界供应氢气的详细调度策略示意图；图7为考虑氢气产出及不考虑氢气产出对应的新能源消纳率对比示意图。具体实施方式应该指出，以下详细说明都是示例性的，旨在对本发明提供进一步的说明。除非另有指明，本文使用的所有技术和科学术语具有与本发明所属技术领域的普通技术人员通常理解的相同含义。需要注意的是，这里所使用的术语仅是为了描述具体实施方式，而非意图限制根据本发明的示例性实施方式。在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。实施例一为改善风光储氢联合发电系统输出特性和降低混合储能电站功率补偿压力，本实施例提供了一种结合日前全局优化和日内滚动优化的协调优化控制方法，日前全局优化建立了联合发电系统总的平均有功功率偏差最小、混合储能电站充放电次数最少、优化末段混合储能电站剩余电量最大和联合发电系统总净产氢量最大的优化模型，以15分钟为优化时段，通过NSGA-Ⅱ算法求解，给出风光储氢的计划出力曲线。日内滚动优化主要包含风光互补实时控制方法和混合储能实时控制方法。风光互补实时控制方法根据超短期气象预测数据，利用风光互补平衡计划超额；混合储能实时控制方法动态给出电储能功率上限，并考虑了氢储能的短时过载能力，提高了混合储能电站的使用寿命以及应对快速爬坡事件的能力；在此基础上盈余的新能源发电量被用于生产氢气，在保证联合发电系统稳定运行的同时提高对新能源的消纳。上述方案中，利用电氢互补的方式平衡风电场和光伏电站的出力差额，延长混合储能电站的使用寿命，采用制备氢气提高对新能源的消纳。具体的，通过NSGA-Ⅱ算法求解后 ，利用应用场景筛选方法，从多个Pareto最优方案中筛选出最优计划出力方案；通过日内滚动优化控制策略，根据风电场和光伏电站估算的可调容量，对计划出力进行调整，得到风光互补后的优化出力方案；在此基础上，根据新能源的实际出力和对联合发电系统下达的总的计划出力，考虑混合储能电站的出力配合策略以及氢储能的短时过载能力，制定混合储能电站的优化出力方案。本实施例所提出风光储氢联合发电系统的架构如图1所示，其协同优化控制方法如图2所示，具体步骤包括：步骤S1、根据联合发电系统的参数信息建立日前全局优化模型；步骤S2、以15分钟为优化时段，采用NSGA-Ⅱ算法求解所述日前全局优化模型，得到多个Pareto最优方案，利用本实施例子提出的应用场景筛选方法选择出最终方案作为风光储氢独立的计划出力方案；步骤S3、将步骤S2中得到的计划出力方案作为输入，输入至风光互补实时控制子模块，根据超短期气象预测数据估算风电场和光伏电站的可调容量，平衡风电场和光伏电站的出力差额，输出调整后的优化出力方案，并交由风电场和光伏电站执行；步骤S4、将风电场和光伏电站执行的实时出力数据作为输入，输入至混合储能实时控制子模块，根据混合储能电站的容量数据，制定混合储能电站的优化出力方案，改善风光储氢联合发电系统输出特性，并提升对新能源的消纳。上述算法具体为：首先，步骤S1中，建立风光储氢联合发电系统的日前全局优化模型。在本实施例中，包含对目标函数和约束条件的建模。该模型综合考虑了风、光、电储能和氢储能四种供电方式，采用“优先并网，余电制氢”的调度策略，在保证电力系统稳定的同时，通过制氢的方式提高对新能源的消纳。将总的功率偏差最小作为目标函数之一，给予调度决策员更多的方案选择空间，可以根据实际的应用场景选择功率偏差阈值，具有更高的灵活性。针对目标函数建模：日前全局优化模型计及了风电场和光伏电站的容量和响应速度约束、混合储能电站容量和功率约束以及制氢约束，建立了联合发电系统总的有功功率偏差最小、混合储能电站充放电次数最少、优化末段混合储能电站剩余的等效电量最大和联合发电系统的总净产氢量最大的优化模型。目标函数如下所示：联合发电系统总的平均功率偏差最小，则目标函数可以表示为如下公式：；其中，为在线滚动目标时段内总的时段数，时段/＞取/＞，/＞为时段/＞内联合发电系统总的计划出力，/＞和/＞分别为风电场和光伏电站在时段/＞的计划出力，/＞为混合储能电站在时段/＞内的计划出力，包括电储能/＞和氢储能/＞两项，充电时为正值，放电时为负值。混合储能电站的总充放电切换次数最小，则目标函数可以表示为如下公式：；其中，和/＞分别为电储能和氢储能的总的充放电次数，当电储能或氢储能的运行状态发生变化时，充放电次数加1。混合储能电站平均剩余等效电量最大，以提高下个目标时段储能的功率补偿能力，其目标函数需满足如下公式：；其中，和/＞分别为时段/＞内电储能和氢储能的剩余容量占比，/＞和分别为电储能和氢储能的放电效率，/＞和/＞分别为电储能和氢储能的总容量。联合发电系统的总净产氢量最大；针对约束条件建模：混合储能电站容量约束混合储能电站包括电储能和氢储能两部分。其中，电储能的容量约束可以表示为：；其中，为时段/＞内电储能的荷电状态，用百分数表示，/＞和/＞分别为电储能荷电状态的上、下限，/＞为电储能的总容量，/＞和/＞分别为电储能的充、放电效率，/＞为电储能的自放电率。氢储能的结构如图1所示，其结构可以分为电解槽、储氢罐以及氢燃料电池三部分。为统一描述，类比于电储能的荷电状态以及充放电功率，引入氢储能的氢气容量状态来描述储氢罐的工作状态，对电解槽和燃料电池的工作状态描述可以采用等效的充放电功率实现，采用充放电效率来模拟压缩机等设备对氢气生产过程的影响。则氢储能的容量约束可以表示为：；其中，为时段/＞内氢储能的容量状态，同样用百分数表示，/＞和分别为氢储能容量状态的上、下限，/＞为氢储能的总容量，/＞为时段/＞内在满足氢储能的基础上氢气制备的净产量，可运输至其他工业生产环节进行利用，/＞和/＞分别为氢储能的等效充、放电效率，/＞为氢储能的自损率。联合发电系统制氢约束联合发电系统只有在优先保证电储能和氢储能的容量能够满足整个联合发电系统计划出力的情况下，盈余的新能源出力才被用来制备氢气。考虑到联合发电系统的经济性和实际情况，工业生产不再向联合发电系统供应氢气，则联合发电系统的制氢约束可以表示为：；混合储能电站功率约束电储能需要考虑高低电量阈值来一定程度上避免混合储能电站的过充和过放，则其功率约束可以描述为：；其中，和/＞分别为时段/＞内电储能的计划出力和荷电状态，/＞和分别为电储能的额定充、放电功率，/＞和/＞分别为动态给出的电储能充、放电功率限定系数，/＞和/＞分别为防止电储能过充和过放的高、低电量阈值。该式通过电储能的实时荷电状态动态约束电站的出力功率，当电储能荷电状态/＞处于/＞或者/＞时，分别动态调整电储能的放电功率和充电功率限值，在一定程度上缓解电储能过充和过放的情况。氢储能不需要考虑过充和过放的问题，其功率约束可以描述为：；其中，和/＞分别为氢储能的额定充、放功率。风电场出力约束包括风电场的出力功率约束和出力功率调节速度约束，具体可以描述为：；其中，和/＞分别为时段/＞内风电功率的预测值和实时出力调节速度，和/＞分别为向下、向上出力调节速度的上限。光伏电站出力约束同样包括光伏电站的出力功率约束和出力功率调节速度约束，具体可以描述为：；其中，和/＞分别为时段/＞内光伏功率的预测值和实时出力调节速度，和/＞分别为向下、向上出力调节速度的上限。步骤S2中，以联合发电系统总的计划出力、风电场和光伏的预测出力以及混合储能容量信息作为输入，以15分钟为优化时段，采用NSGA-Ⅱ算法求解步骤S1中建立的日前全局优化模型，得到含有多个Pareto最优方案的初始集合。初始集合/＞中包括：每个时段的风电、光伏、电储能和氢储能的计划出力，电、氢储能的充放电控制策略，电、氢储能的荷电/储氢状态以及净产氢量。在此基础上，结合联合发电系统运行的实际情况，本公开给出了一种应用场景筛选方法，具体选择过程如图3所示。该方法依次以联合发电系统总功率偏差最小、混合储能电站的总充放电切换次数最小、混合储能电站平均剩余等效电量最大以及联合发电系统的氢气净产量最大为偏好优先级，对方案进行筛选，筛选过程如图3所示。具体原则如下：首先将NSGA-Ⅱ算法求解得到的解集作为初始方案集合，根据实际场景的应用要求设置联合发电系统总功率偏差的期望值/＞，筛选出总功率偏差小于/＞的方案作为方案集合/＞，若/＞为空集，则需要增加/＞，重复执行本步骤；从方案集合中筛选出单个时段内电储能和氢储能总充放电次数小于或等于2的方案作为方案集合/＞，若/＞为空集，则需要返回第一步，增加/＞并重新筛选方案集合；设置混合储能电站平均剩余等效电量的期望值，从方案集合/＞中筛选出平均剩余等效电量大于/＞的方案作为方案集合/＞，若集合/＞为空集，则增加/＞并重新筛选方案集合/＞；从方案集合中选择氢气净产量最大的方案作为最终方案。上述优先级依次以电网安全性、经济性以及新能源消纳的顺序排列，重要性从高到低。首先保证电网的稳定运行，即总功率偏差最小和混合储能电站平均剩余等效电量最大；其次考虑经济性，尽量减少储能电站的开关切换，延长使用寿命；最后考虑新能源消纳，即多余的新能源出力用于制氢，选择制氢量最大的方案。其中，前三项将总功率偏差、充放电次数以及剩余等效电量交叉排列，平衡联合系统的安全性和经济性。步骤S3中，以超短期气象预测数据作为输入，输入至日内滚动优化控制策略中的风光互补实时控制子模块，对计划出力方案中的风光计划出力方案进行调整，利用风电场和光伏电站之间的缺额和裕量相互平衡，提高新能源的计划出力完成度，通过风光互补提高联合发电系统的新能源出力韧性，降低预测误差对混合储能电站的功率补偿压力。风光互补实时控制子模块采用的超短期气象预测数据，可以认为风速、光照和温度等预测值与实际气象条件相同，则风电场和光伏电站的可调裕量可表示为下式：；其中，和/＞分别为风电场和光伏电站的可调裕量，/＞和/＞分别为日前全局优化模块给出的风电场和光伏电站的计划出力值，/＞和/＞分别为根据超短期气象预测数据估算的风电场和光伏电站的可捕获功率上限。当风电场和光伏电站的可调裕量符号相异时，风光互补实时控制子模块对风电场和光伏电站的计划出力进行优化微调，具体分为两种情况：若风电场的可调裕量为正，光伏电站的可调裕量为负，则风电场将承担一部分光伏电站的计划出力，调整后的风电场和光伏电站优化出力如下式所示：；其中，和/＞分别为调整后风电场和光伏电站的优化出力。若光伏电站的可调裕量为正，风电场的可调裕量为负，则光伏电站将承担一部分风电场的计划出力，调整后的风电场和光伏电站优化出力如下式所示：；将上述优化出力方案交由风电场和光伏电站执行，并采集风电场和光伏电站的实时出力数据。步骤S4中，将步骤S3中得到的风电场和光伏电站执行的实时出力数据作为输入，输入至混合储能实时控制子模块，根据混合储能电站的容量数据，制定混合储能电站的优化出力方案，改善风光储氢联合发电系统输出特性。混合储能实时控制子模块同时考虑电、氢混合储能的出力配合以及氢储能的短时过载模式。当电储能和氢储能的正常运行模式已经弥补不了风电场和光伏电站发生快速爬坡造成的出力缺额时，启用氢储能的短时过载模式。正常运行模式经过风光互补实时控制子模块优化后，联合发电系统风光出力的差额可以表示为：；其中，和/＞分别为风电场和光伏电站的实时出力，/＞为联合发电系统总的计划出力。混合储能电站的总出力可以表示为：；其中，和/＞分别为电储能和氢储能出力。则当电储能处在正常运行模式时，混合储能电站的实时控制策略根据电储能的剩余电量决定，具体可以分为下述三种状态：a．当时，/＞和/＞分别为防止电储能过充和过放的高、低电量阈值：此时电储能处于低电量区间。为了避免过度放电，需要对其放电功率进行限制。则最大放电功率可以动态表示为：；若联合发电系统功率偏差为正，说明混合储能电站需要吸纳一部分风电场和光伏电站的出力裕量，降低联合发电系统功率偏差。为了避免混合储能电站的小电流充电，只有当/＞时，其中/＞和/＞分别为电储能和氢储能的最小充电功率，才考虑调用混合储能电站吸收盈余功率。为了尽快使电储能恢复到正常电量区/＞，此时优先由处于低电量区的电储能充电，其功率可以表示为：；其中，为电储能的优化计划出力，/＞为电储能最小出力限值。当处在低电量区间的电储能以最大充电功率依然无法消纳新能源的发电量，即时，剩余部分由氢储能消纳，其功率可以表示为：/＞；其中，为氢储能的优化计划出力，/＞为氢储能最小出力限值。若联合发电系统功率偏差为负，说明混合储能电站需要弥补一部分风电场和光伏电站的出力缺额，降低联合发电系统功率偏差。由于电储能处于低电量区，因此优先由氢储能供给电量，其功率可以表示为：；当氢储能以最大放电功率依然无法达到联合发电系统计划出力时，即时，再由处于低电量区的电储能供应电量，其功率可以表示为：；b. 当时，即电储能处于正常电量区间：由于氢储能的循环寿命更高，因此在电储能的正常电量区间优先使用氢储能弥补风光出力与联合发电系统计划出力的差值，缺失部分再由电储能进行弥补。若联合发电系统功率偏差为正，说明混合储能电站需要吸纳一部分风电场和光伏电站的发电裕量。氢储能的功率可以表示为：；若，则调用电储能吸纳剩余的风电场和光伏电站出力，其功率可以表示为：；联合发电系统功率偏差为负时，说明风电场和光伏电站出力小于联合发电系统计划出力，混合储能电站需要放电，氢储能的功率可以表示为：；若，则调用电储能弥补风电场和光伏电站的出力，其功率可以表示为：；/＞c. 当时，即电储能处于高电量区间：此时电储能处于高电量区间。为了避免过度充电，需要对其充电功率进行限制。则最大充电功率可以动态表示为：；若联合发电系统功率偏差为正，说明混合储能电站需要吸纳一部分风电场和光伏电站的发电裕量。为了避免混合储能电站的小电流充电，只有当/＞时，才考虑调用混合储能电站吸收盈余功率。为了避免电储能过充，混合储能电站优先给氢储能充电，氢储能的功率可以表示为：；当氢储能以最大充电功率依然无法达到联合发电系统计划出力时，即时，再由处于高电量区的电储能吸纳部分电量，其功率可以表示为：；若联合发电系统功率偏差为负，说明混合储能电站需要弥补一部分风电场和光伏电站的出力缺额，降低联合发电系统功率偏差。为了尽快使电储能恢复到正常电量区，此时优先由处于高电量区的电储能进行放电，其功率可以表示为：；当处在高电量区间的电储能以最大充电功率依然无法满足计划出力，即时，剩余部分由氢储能消纳，此时氢储能的功率可以表示为：；氢储能的短时过载模式本实施例考虑到常规的氢燃料电池均具备一定的短时过载能力，其过载能力视工艺的不同能够达到200%甚至更大。因此本公开引入了氢储能的短时过载工作模式，在识别到风电场和光伏电站出力发生爬坡事件的时候，通过氢燃料电池的短时过载能力在一定程度上限制爬坡事件的爬坡率和爬坡幅度，提高了联合发电系统应对爬坡事件的能力以及系统总出力的确定性。氢储能短时过载模式的触发条件可以表示为：；/＞其中，和/＞分别为风电场与光伏电站上一时刻和当前时刻总的实时出力，/＞和/＞分别为风电场与光伏电站上一时刻和当前时刻的优化计划出力，/＞为启动阈值。当系统识别到风电场和光伏电站的下爬坡幅度超过设定的启动阈值时，氢储能进入短时过载模式，其最大充、放电功率可以表示为如下公式：；其中，和/＞分别为氢储能在短时过载状态下的最大充、放电功率，/＞和/＞分别为充、放电过载系数，由氢储能的实际过载能力决定，/＞和/＞分别为氢储能的额定充、放电功率，/＞和/＞分别为充、放电过载时间系数。为了对比本专利所提的协同优化控制方法与传统不考虑氢气产出的控制方法，本专利以山东省北部某地区的风光基地为算例对方案进行对比验证。其中，风电场容量为2400MW，光伏电站容量为10400MW，储能配置为新能源装机容量的30%、2小时，即3840MW/7680MWh，电储能和氢储能分别占50%和50%。采用某日24小时的风电、光伏以及负载的预测数据对本专利所提的的协同优化控制方法进行验证。其中，新能源出力的预测数据以及电网下发的计划出力如图4所示。基于上述预测数据，采用NSGA-Ⅱ算法求解日前全局优化模型，初始种群设置为500，遗传代数设置为600，求解得到的部分调度方案如下表所示：从表中可以看出，方案一利用储能电站的频繁充放电来最小化平均功率偏差，但该方案极大地减少了储能装置的使用寿命。相反，方案三限制了储能电站的充放电切换次数，但代价是平均功率偏差高达2%。方案二平衡了平均功率偏差最小和储能电站开关切换次数最小之间的矛盾，更具实用性。基于应用场景筛选方法，将平均功率偏差的阈值设置为0.5%，将优化时间段内的平均剩余等效电量的阈值设置为5800MWh，从而确定方案2为全局优化模型的最终方案。联合发电系统各部分的功率输出如图5所示。由图5可知，5:15以前，新能源的发电量不足以达到电网要求的计划出力，因此采用电储能和氢储能弥补新能源出力的缺额。随着风力发电量的逐渐增长，计划出力可以由风力发电独自承担，并且日出后光伏发电量快速增长，盈余的新能源出力首先用于弥补混合储能电站的容量缺失。待混合储能电站的蓄电量达到上限，即7:00之后，剩余的新能源出力用于制备向外界供应的氢气，实现新能源的深度消纳。图6给出了向外界供应氢气的详细调度策略。从图6中可以看出，新能源发电功率出现盈余后，联合发电系统并未直接开始制备向外界供应的氢气，而是首先弥补混合储能电站的容量缺失；7:00以后，混合储能电站的缺失容量已经基本补充完成，联合发电系统才开始制备向外界供应的氢气。图7比较了联合发电系统是否考虑向外界供应氢气对新能源消纳的影响。从图7中可以看出，在混合储能电站弥补新能源出力缺额以及新能源给混合储能电站充电的两个阶段，即0:00-5:15和5:15-7:00两个时段，由于没有多余的新能源出力，是否考虑制备向外界供应氢气对于新能源的消纳率没有显著影响。7:00之后，由于新能源出力存在盈余且混合储能电站容量已经到达上限，本专利所提出的调度策略通过制备氢气有效提升了对新能源的消纳率，特别是随着光伏发电量的提升，本专利所提出的调度策略相较于传统调度策略最大可提升50%以上的新能源消纳率。因此，针对高比例新能源的供电区域、特别是针对光伏装机容量巨大的新能源应用场景，本专利所提出的调度策略能够在保证联合发电系统完成计划出力的前提下，有效提升对新能源的消纳率。实施例二本实施例的目的是提供一种计算机装置,包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现上述方法的步骤。实施例三本实施例的目的是提供一种计算机可读存储介质。一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时执行上述方法的步骤。实施例四本实施例的目的是提供了一种风光储氢联合发电系统的协同优化控制系统，包括：日前全局优化模型建立模块，被配置为：根据风光储氢联合发电系统的参数信息建立日前全局优化模型；日前全局优化模块，被配置为：求解所述日前全局优化模型，得到多个最优方案并从多个最优方案中选出所需的风光储氢计划出力方案；根据联合发电系统的整体计划出力、风电场和光伏电站的预测出力以及混合储能电站容量信息，以15分钟为优化时段，基于NSGA-Ⅱ算法和应用场景筛选方法，得到风光储氢的计划出力方案；日内滚动优化模块，用于综合考虑风光互补、混合储能电站使用寿命和氢储能短时过载能力三个因素，调整日前全局优化模块输出的计划出力方案，依次得到风电场和光伏电站、混合储能电站的优化出力方案；其中，日内滚动优化模块包括：风光互补实时控制子模块，用于根据气象信息实时优化风电场和光伏电站的计划出力方案；混合储能实时控制子模块，用于根据混合储能电站容量状态和风电场和光伏电站的优化出力方案，制定混合储能电站的优化出力方案。根据超短期气象预测数据估算风电场和光伏电站的可调容量，平衡风电场和光伏电站的出力差额，输出调整后的优化风光储氢计划出力方案，并交由风电场和光伏电站执行。在日内滚动优化模块中，综合考虑风光互补、混合储能电站使用寿命和氢储能短时过载能力三个因素，调整日前全局优化模块输出的计划出力方案，依次得到风电场和光伏电站、混合储能电站的优化出力方案。日前全局优化模型求解模块中，为了进行求解先进性采集混合储能电站的实时容量状态，超短期气象预测数据，以及风电场和光伏的实时出力数据。本实施例子中技术方案采用日前全局优化和日内滚动优化相结合的方式改善风光储氢联合发电系统的输出特性。日前全局优化模型综合考虑计划出力完成度和混合储能电站使用寿命，以15分钟为优化时段，采用NSGA-Ⅱ算法求解风光储氢的日前计划出力。日内滚动优化控制策略根据超短期气象预测数据对风电场和光伏电站的日前计划出力进行优化，实现风光互补。采用混合储能电站的电储能和氢储能平衡风电场和光伏电站的出力差额，并考虑氢储能的短时过载特性提高应对新能源爬坡事件的能力，在此基础上盈余的新能源发电量被用于生产氢气，在保证联合发电系统稳定运行的同时实现对新能源的深度消纳。以上实施例二、三和四的装置中涉及的各步骤与方法实施例一相对应，具体实施方式可参见实施例一的相关说明部分。术语“计算机可读存储介质”应该理解为包括一个或多个指令集的单个介质或多个介质；还应当被理解为包括任何介质，所述任何介质能够存储、编码或承载用于由处理器执行的指令集并使处理器执行本发明中的任一方法。本领域技术人员应该明白，上述本发明的各模块或各步骤可以用通用的计算机装置来实现，可选地，它们可以用计算装置可执行的程序代码来实现，从而，可以将它们存储在存储装置中由计算装置来执行，或者将它们分别制作成各个集成电路模块，或者将它们中的多个模块或步骤制作成单个集成电路模块来实现。本发明不限制于任何特定的硬件和软件的结合。上述虽然结合附图对本发明的具体实施方式进行了描述，但并非对本发明保护范围的限制，所属领域技术人员应该明白，在本发明的技术方案的基础上，本领域技术人员不需要付出创造性劳动即可做出的各种修改或变形仍在本发明的保护范围以内。
