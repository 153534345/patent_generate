标题title
一种用于复杂心律失常的整体心脏三维标测方法及系统
摘要abst
本发明提供一种用于复杂心律失常的整体心脏三维标测的方法及系统，包括：获取标准心脏三维模型，所述标准心脏三维模型为根据心脏解剖学建立的模型；所述标准心脏三维模型包括心脏内模数据；将所述标准心脏三维模型读取至标测系统；对患者心脏进行初步标测，获取局部内膜模型；以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合；将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面；根据所述标准心脏三维模型操作导管的移动，对患者心脏进行标测。通过上述方案解决了现有技术中新手医生标测困难的技术问题。
权利要求书clms
1.一种用于复杂心律失常的整体心脏三维标测的方法，其特征在于所述方法包括如下步骤：获取标准心脏三维模型，所述标准心脏三维模型为根据心脏解剖学建立的模型；所述标准心脏三维模型包括心脏内模数据；将所述标准心脏三维模型读取至标测系统；对患者心脏进行初步标测，获取局部内膜模型；以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合；将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面；根据所述标准心脏三维模型操作导管的移动，对患者心脏进行标测。2.根据权利要求1所述的一种用于复杂心律失常的整体心脏三维标测的方法，其特征在于：以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合包括：使用角点检测算法提取所述局部内膜模型以及所述标准心脏三维模型的特征点；计算所述局部内膜模型以及所述标准心脏三维模型的特征点的相似度，将相似度大于第一阈值的特征点对确定为对应点对；基于所述对应点对使用特征点匹配算法计算变换矩阵；基于所述变换矩阵确定出所述标准心脏三维模型相对于所述局部内膜模型的缩放、平移、旋转参数；基于所述缩放、平移、旋转参数对所述标准心脏三维模型进行缩放、平移、旋转以将所述标准心脏三维模型叠加于所述局部内膜模型上。3.根据权利要求1所述的一种用于复杂心律失常的整体心脏三维标测的方法，其特征在于：将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面后还包括：将所述标准心脏三维模型的透明度调至低于50%，和/或 以点阵、虚线重绘所述标准心脏三维模型。4.根据权利要求1所述的一种用于复杂心律失常的整体心脏三维标测的方法，其特征在于：当患者产生位移之后，对已标测出的心脏模型和标准心脏模型重新进行匹配。5.根据权利要求1所述的一种用于复杂心律失常的整体心脏三维标测的方法，其特征在于：在显示界面上从标准心脏模型中删除已标测的部分。6.一种用于复杂心律失常的整体心脏三维标测的系统，其特征在于所述系统包括如下模块：获取模块，用于获取标准心脏三维模型，所述标准心脏三维模型为根据心脏解剖学建立的模型，所述标准心脏三维模型包括心脏内模数据；读取模块，用于将所述标准心脏三维模型读取至标测系统；标测模块，用于对患者心脏进行初步标测，获取局部内膜模型；匹配模块，用于以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合；显示模块，用于将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面；第二标测模块，用于根据所述标准心脏三维模型操作导管的移动，对患者心脏进行标测。7.根据权利要求6所述的一种用于复杂心律失常的整体心脏三维标测的系统，其特征在于：所述匹配模块，还用于：使用角点检测算法提取所述局部内膜模型以及所述标准心脏三维模型的特征点；计算所述局部内膜模型以及所述标准心脏三维模型的特征点的相似度，将相似度大于第一阈值的特征点对确定为对应点对；基于所述对应点对使用特征点匹配算法计算变换矩阵；基于所述变换矩阵确定出所述标准心脏三维模型相对于所述局部内膜模型的缩放、平移、旋转参数；基于所述缩放、平移、旋转参数对所述标准心脏三维模型进行缩放、平移、旋转以将所述标准心脏三维模型叠加于所述局部内膜模型上。8.根据权利要求6所述的一种用于复杂心律失常的整体心脏三维标测的系统，其特征在于：所述显示模块，还用于将所述标准心脏三维模型的透明度调至低于50%，和/或 以点阵、虚线重绘所述标准心脏三维模型。9.根据权利要求6所述的一种用于复杂心律失常的整体心脏三维标测的系统，其特征在于：所述匹配模块，还用于当患者产生位移之后，对已标测出的心脏模型和标准心脏模型重新进行匹配。10.根据权利要求6所述的一种用于复杂心律失常的整体心脏三维标测的系统，其特征在于：所述显示模块，还用于在显示界面上从标准心脏模型中删除已标测的部分。
说明书desc
技术领域本发明涉及医学数据处理领域，具体而言涉及用于复杂心律失常的整体心脏三维标测方法及系统。背景技术心律失常是临床常见心血管病，房颤、室速、室颤等复杂心律失常严重危害人类健康，为了对复杂心律失常进行定位和治疗，需要了解患者的心脏结构以及心脏各部位的电活动情况，对心脏的各类电生理指标进行测量。心脏指标测量通常分为常规心电图和标测心电图。标测心电图和常规心电图的区别在于标测心电图展示的是三维模式下的电传导，常规心电图展示的是二维模式下的电传导。标测心电图可以体现正常或心动速率异常的三维标测下的电传导，同时能够结合解剖信息，全面地解释正常及异常心电图的形成，直接全面的展示心脏电传导信息，更好地展现心电图的成图原理；房颤等复杂的心律失常病症以脏电位、心脏结构更加复杂，常规心电图通常难以达到预期效果，因此通常需要整体心脏三维标测。标测的常见方法包括光学标测和电位标测，心脏光学标测借助电压敏感染料和数字成像技术，用光信号记录细胞膜电位，其最大的优点是空间分辨率高，同时其为非接触的，免去了标测电极与测量设备之间的复杂连线，但目前使用的电压敏感染料是有毒的，无法实现在体标测。电位标测是目前主要应用的标测方法，现有应用中如Carto3系统等，其基本原理是将三对空间位置正交的电极放置在患者的体表上，通常的位置是前胸-后背、左腋-右腋、脖子后面-大腿内侧，这三对电极在空间是形成一个三维空间，类似三维坐标的xyz三轴。在进行标测时，将导管通过大腿的静脉送至心脏，导管头部有采集心电信号的装置。如图1所示，在进行标测时，医师操作导管头部前进、后退、弯曲、旋转，使得导管头部能够测量得到心脏内膜的电信号，并确定导管头在三对电极形成的坐标系中的位置，从而对心脏进行测量建模。使用现有技术中的导管对心脏进行标测时，类似于人在黑暗的房间内通过手触摸墙壁来确定房间的结构，当触摸到有特点的位置时即可确定出一个特殊位置，从特殊点出发找到更多的其它位置，因此需要对房间的结构非常的熟悉。在进行标测时，心脏即可看成房间，通过导管头触碰不同的位置，产生不同的电测信号，通过电信号的特征不断地进行探索标测，因此现有技术中的标测方法无全局导航，在进行标测时有如盲人摸象，由于心脏内腔结构复杂，无全局导航的标测技术非常考验医生的经验水平。发明内容为了解决现有技术中心脏标测无全局导航的问题，本发明提供一种用于复杂心律失常的整体心脏三维标测方法及系统。在本发明的一个方面，提供一种用于复杂心律失常的整体心脏三维标测的方法，其特征在于所述方法包括如下步骤：获取标准心脏三维模型，所述标准心脏三维模型为根据心脏解剖学建立的模型；所述标准心脏三维模型包括心脏内模数据；将所述标准心脏三维模型读取至标测系统；对患者心脏进行初步标测，获取局部内膜模型；以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合；将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面；根据所述标准心脏三维模型操作导管的移动，对患者心脏进行标测。进一步地，以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合包括：使用角点检测算法提取所述局部内膜模型以及所述标准心脏三维模型的特征点；计算所述局部内膜模型以及所述标准心脏三维模型的特征点的相似度，将相似度大于第一阈值的特征点对确定为对应点对；基于所述对应点对使用特征点匹配算法计算变换矩阵；基于所述变换矩阵确定出所述标准心脏三维模型相对于所述局部内膜模型的缩放、平移、旋转参数；基于所述缩放、平移、旋转参数对所述标准心脏三维模型进行缩放、平移、旋转以将所述标准心脏三维模型叠加于所述局部内膜模型上。进一步地，将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面后还包括：将所述标准心脏三维模型的透明度调至低于50%，和/或 以点阵、虚线重绘所述标准心脏三维模型。进一步地，当患者产生位移之后，对已标测出的心脏模型和标准心脏模型重新进行匹配。进一步地，在显示界面上从标准心脏模型中删除已标测的部分。另一方面，本发明还提供一种用于复杂心律失常的整体心脏三维标测的系统，其特征在于所述系统包括如下模块：获取模块，用于获取标准心脏三维模型，所述标准心脏三维模型为根据心脏解剖学建立的模型，所述标准心脏三维模型包括心脏内模数据；读取模块，用于将所述标准心脏三维模型读取至标测系统；标测模块，用于对患者心脏进行初步标测，获取局部内膜模型；匹配模块，用于以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合；显示模块，用于将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面；第二标测模块，用于根据所述标准心脏三维模型操作导管的移动，对患者心脏进行标测。进一步地，所述匹配模块，还用于：使用角点检测算法提取所述局部内膜模型以及所述标准心脏三维模型的特征点；计算所述局部内膜模型以及所述标准心脏三维模型的特征点的相似度，将相似度大于第一阈值的特征点对确定为对应点对；基于所述对应点对使用特征点匹配算法计算变换矩阵；基于所述变换矩阵确定出所述标准心脏三维模型相对于所述局部内膜模型的缩放、平移、旋转参数；基于所述缩放、平移、旋转参数对所述标准心脏三维模型进行缩放、平移、旋转以将所述标准心脏三维模型叠加于所述局部内膜模型上。进一步地，所述显示模块，还用于将所述标准心脏三维模型的透明度调至低于50%，和/或 以点阵、虚线重绘所述标准心脏三维模型。进一步地，所述匹配模块，还用于当患者产生位移之后，对已标测出的心脏模型和标准心脏模型重新进行匹配。进一步地，所述显示模块，还用于在显示界面上从标准心脏模型中删除已标测的部分。本发明通过上述技术方案，在获取到一部分心脏的内膜模型后，将获取到的局部心脏内膜模型与标准心脏三维模型进行对比，确定局部的心脏内膜模型在标准心脏三维模型中的位置，进而将标准心脏三维模型进行绽放和旋转，并且标准心脏三维模型叠加在正在进行标测的局部心脏内膜模型上，标准心脏三维模型虽然不精确，无法将其应用于实际的医疗，但标准心脏三维模型可以提供一个心脏整体的大概结构，在进行标测时提供一个全局的导航，可以从标准心脏三维模型上看出当前正进行到心脏的哪一位置，有助于医生进收入导管时绕过一些复杂的结构，提高心脏整体标测的效率。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为现有技术中的标测系统示意图；图2为本发明方法示意图。具体实施方式下面，结合附图以及具体实施方式，对发明做出优选的描述。本实施例通过如下步骤解决上术问题:在一个实施例中，参考图2，本发明提供用于复杂心律失常的整体心脏三维标测方法。本实施例的方法是对现有的标测系统的进一步改进，可以通过修改现有标测系统的源代码实现，也可通过系统提供的接口或外挂程序等实现，本实施例所述的标测系统均是指根据本实施例方法改进后的标测系统。获取标准心脏三维模型，所述标准心脏三维模型为根据心脏解剖学建立的模型；所述标准心脏三维模型包括心脏内模数据。本实施例所述的标准心脏模型是指用医学影像学和计算机辅助诊断确定出的心脏解剖学模型。它是通过对大量的人类心脏影像数据以及解剖数据进行分析和统计得到的，可以作为一种代表性的心脏解剖结构的模型。根据现有的解剖资料确定出心脏的统计学参数，如心脏的大小、各部分的比例、心脏内膜的弧度等。标准心脏三维模型是统计意义上的，其不能直接应用于病症的诊断与治疗，但其结构与患者的心脏结构类似，因此在对心脏腔体进行标测时可以提供一个大致的结构参考。进一步地，由于采用导管技术进行三维标测主要是对心脏的内膜进行测量，标测软件得到的模型均为内膜模型，因此标准心脏三维模型至少应当包括心脏内模模型。标准心脏三维模型可以通过现有技术中任意方式获取，如自建模型、购买商业模型等，本实施对标准心脏三维模型的来源不做任何的限定。标准心脏三维模型的表现方式可以是现有技术中的任意方式，如通过点云等进行表达，可以通过STL文件、OBJ文件、FBX文件等形式存储，只要能够体现内膜结构即可，本实施例不做进一步的限定。将所述标准心脏三维模型读取至标测系统。为了使用得标测系统能够调用标准心脏三维模，需要将已有的标准心脏三维模型转换成标测系统能够识别的数据格式，如通过Asiiimp、Open3D等，读取以OBJ格式存储的三维模型，并对数据进行转换。在转换成功后，使用标测系统提供的API或使用外挂程序，将标准心脏三维模型读取至标测系统以供后续的步骤使用。对患者心脏进行初步标测，获取局部内膜模型。在对患者的心脏进行标测时，将导管通过静脉送入心脏，当导管头与心脏内膜接触后，根据电位的变化，即可得到导管头相对于各电极的绝对坐标，从而建立起导管头接触部分的三维模型。示例性地，以Carto3为例，导管通常先进入到下腔，通过对导管的弯曲、旋转操作，可以建立下腔部分的三维模型，首先建立的下腔部分的模型即为局部内膜模型，从Carto3系统的界面可以看到一个下腔曲面三维图像，则下腔曲面三维模型即为局部内膜模型。局部内膜模型的大小可由操作医生自由确定，可以知道的是局部内膜模型越大，在局部内膜模型三维模型进行匹配时匹配结果越准确。局部内膜模型是标测系统实时建立的模型，其坐标系是根据各电极的位置确定，因此局部内膜模型的坐标是相对于各电极位置的。局部内膜模型的获取可以实时的，在内膜模型每一次变化后，之前获取的内膜模型均可看成是局部内膜模型，在内膜模型每一次变化后均执行后续的步骤。局部内膜模型也可是根据用户主动确定的，如当医生获取到初步的内膜模型后，判断通过该内膜模型即可匹配标准心脏模型，则在操作界面上确认已获取到的内膜模型为局部内膜模型。以所述局部内膜模型为基准，自动对所述标准心脏三维模型的内模模型进行旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内模模型重合。局部内膜模型为标测系统上显示的实时模型，是真实心脏的真实反应，因此需要将局部内膜模型做为基准，将标准心脏三维模型加载至与局部内膜模型相同的坐标系上，并且与局部内膜模型有相同的旋转以及缩放水平。例如，当使用标测系统确定出心脏上腔的模型后，心脏上腔显示于操作界面，此时将标准心脏三维模型进行旋转、缩放以及平移，使得标准心脏三维模型的上腔与局部内膜模型的上腔重合。示例性地，自动对所述标准心脏三维模型的内模模型进行旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内模模型重合可以采用如下方法实现：由于心脏结构复杂，内膜曲率变化大，因此可以将曲度做为特征，首先使用角点检测算法提取所述局部内膜模型以及标准心脏三维模型的特征点。计算所述局部内膜模型以及标准心脏三维模型的特征点的相似度，将相似度大于一定阈值的特征点对确定为对应点对。在获取了两个模型的特征点对后，可以使用特征点匹配算法来计算变换矩阵；可以使用现有技术中任意的匹配算法来确定变换矩阵，如RANSAC 算法、Iterative Closest Point 算法、最小二乘法算法等，具体的算法本实施例不做具体的限定，也可以采用除上述示例外的任意其它算法，只要能够计算出变换矩阵即可。基于变换矩阵可以确定出标准心脏三维模型相对于局部内膜模型的缩放、平移、旋转参数；对标准心脏三维模型进行相应的缩放、平移、旋转可以将标准心脏三维模型叠加于局部内膜模型上。需要说明的是，上述操作均基于标测系统由程序自动化完成，可通过修改标测系统的源代码、调用标测系统的API或使用外挂程序等实现。将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面。标准心脏三维模型与局部内膜模型叠加后，为了区分出两个模型，将所述标准心脏三维模型的内模模型以区别于所述局部内膜模型的颜色显示于操作界面，例如将真实的局部内膜模型以深颜色进行显示，然则将标准心脏三维模型以浅颜色进行显示。为了进一步区别两种模型，将标准心脏三维模型的透明度调至低于50%，和/或以点阵、虚线等绘制标准心脏三维模型。根据所述标准心脏三维模型操作导管的移动，对患者心脏进行标测。界面上显示出的标准心脏三维模型指示出了心脏的大致结构，当医生操作导管在心房腔室内移动时，可以观察标准心脏三维模型，根据标准心脏三维模型确定下一步要检测的区域以及导管的行进方法。例如，医生要从下腔进入心耳，在无标准心脏三维模型时只能根据经验判断心耳的大致位置，对导管进行弯折和旋转，以找到心耳入口；通过本实施例加载标准心脏三维模型后，医生可以在操作界面上直观地看到心耳的入口，因此可以更加简单快捷地确定出后续的操作。进一步地，当患者产生位移之后，对已标测出的心脏模型和标准心脏模型重新进行匹配，并重复上述步骤。进一步地，为了避免标准心脏模型对已标测区域的影响，在显示界面上从所述标准心脏模型中删除已标测的部分。在另一种实施中，本发明还提供一种用于复杂心律失常的整体心脏三维标测的系统，其特征在于所述系统包括如下模块：获取模块，用于获取标准心脏三维模型，所述标准心脏三维模型为根据心脏解剖学建立的模型，所述标准心脏三维模型包括心脏内模数据；读取模块，用于将所述标准心脏三维模型读取至标测系统；标测模块，用于对患者心脏进行初步标测，获取局部内膜模型；匹配模块，用于以所述局部内膜模型为基准，自动对所述标准心脏三维模型进行平移、旋转和缩放，使得所述局部内膜模型与所述标准心脏三维模型的内膜重合；显示模块，用于将所述标准心脏三维模型以区别于所述局部内膜模型的颜色显示于操作界面；第二标测模块，用于根据所述标准心脏三维模型操作导管的移动，对患者心脏进行标测。需要说明的是上述用于复杂心律失常的整体心脏三维标测系统的详细实现原理以及进一步的改进措施都与前述的用于复杂心律失常的整体心脏三维标测方法相同，本实施例中不再进行详细描述，本领域技术人员可以根据现有技术基于用于复杂心律失常的整体心脏三维标测在用于复杂心律失常的整体心脏三维标测系统中进行具体实现。最后应当说明的是：以上实施例仅用以说明本发明的技术方案而非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等同替换，其均应涵盖在本发明的权利要求保护范围之内。本发明未特别明确的部分模块结构，以现有技术记载的内容为准。本发明在前述背景技术部分以及具体实施例部分提及的现有技术可作为本发明的一部分，用于理解部分技术特征或者参数的含义。本发明的保护范围以权利要求实际记载的内容为准。
