标题title
动作电位的分解方法、分解模型、信号分析设备
摘要abst
本发明公开了一种动作电位的分解方法、分解模型、信号分析设备，分解方法包括：S1、对峰电位进行峰值对齐，S2、获取至少一个信号模板，S3、选定信号模板。本发明通过对峰电位进行降噪重构，对重构信号进行聚类处理，得到多个信号模板，在从多个信号模板中选定一个信号模板作为分解的信号模板Y，将信号X中的峰电位与信号模板Y进行匹配，将匹配的峰电位时刻减去信号模板Y从而剥离出峰电位波形，以此进行迭代，将信号X中的所有峰电位分解出来。本发明基于信号本身构建信号模板，可以提高峰电位分解的精度。
权利要求书clms
1.一种动作电位的分解方法，其特征在于，包括：S1、对峰电位进行峰值对齐；S2、对所述峰电位进行空间变换得到对应的基向量，根据基向量的贡献率进行信号重构得到重构信号；对所述重构信号进行空间聚类处理以获取至少一个信号模板；S3、选定所述信号模板，记为信号模板Y；S4、根据所述信号模板Y逐层分解峰电位，具体包括：S41、将信号匹配信号模板Y，以从信号中剥离出与所述信号模板Y对应的信号电位；S42、迭代进行步骤S1至S3以及步骤S41，以进行峰电位的逐层分解。2.如权利要求1所述的分解方法，其特征在于，将提取的峰电位从特征空间变换到投影空间，得到每个所述峰电位对应的基向量；计算每个基向量的贡献率，所述基向量的贡献率表示基向量的特征值在所有基向量的特征值之和中所占的比例；将所有的基向量的贡献率从大到小排序，设定阈值thd_c，按照从大到小的顺序选取若干个基向量的贡献率，当若干个基向量的贡献率之和大于或等于阈值thd_c时，进行信号重构；其中，所述阈值thd_c的取值通过对所有基向量的贡献率进行高斯拟合，根据3σ原则确定。3.如权利要求2所述的分解方法，其特征在于，所述空间聚类包括：根据离散度确定聚类数量，以获取信号模板的波形和数量；其中，获取所有基向量的特征值，将所述特征值进行从大到小排列；每次去除一个最大的特征值后，计算剩余的特征值的离散度CoV；若当前离散度CoVK小于上一个离散度CoVK-1且当前离散度CoVK小于下一个离散度CoVK+1，则表明离散度逐渐递减后出现第一个拐点，K表示离散度的序列；此时，若K小于阈值nb，则聚类个数M=nb；若K大于或等于阈值nb，则聚类个数M=K。4.如权利要求1所述的分解方法，其特征在于，所述选定信号模板包括：在所有信号模板中，先按峰电位数量排序，再选取峰峰值最大的信号模板记为聚类后的信号模板Y。5.如权利要求1所述的分解方法，其特征在于，所述匹配信号模板Y包括：计算所述信号中的所有峰电位与信号模板Y之间的相关系数R；当某一峰电位对应的相关系数R大于等于阈值thd0时，认为该峰电位与所述信号模板Y匹配。6.如权利要求1所述的分解方法，其特征在于，所述步骤迭代的终止条件包括：当迭代次数大于迭代阈值时，终止迭代；或者，当当前迭代得到的峰电位的峰值小于阈值thd1时，终止迭代；或者，当当前迭代得到的信号模板Y的持续时长小于阈值thd2时，终止迭代；其中，阈值thd1=0.5*rms，X表示信号；阈值thd2为一次单元放电的最小持续时长。7.如权利要求1所述的分解方法，其特征在于，还包括：S5、选取所需的峰电位波形，即，对达到迭代终止条件的全部迭代的峰电位波形，选取峰电位波形的发放频率大于发放频率统计量的峰电位波形作为有效的峰电位波形。8.一种如权利要求1-7任一项所述的动作电位的分解方法的分解模型，其特征在于，包括：对齐模块，用于提取信号中的峰电位并进行峰值对齐；获取模块，用于获取至少一个信号模板；选定模块，用于选定信号模板；分解模块，用于逐层分解峰电位。9.一种信号分析设备，其特征在于，包括：采集模块，用于采集信号；处理器，用于执行如权利要求1-7任一项所述的分解方法；显示模块，用于显示信号分解结果。
说明书desc
技术领域本发明涉及信号处理技术领域，尤其涉及一种动作电位的分解方法、分解模型、信号分析设备。背景技术动作电位是指可兴奋细胞受到刺激时在静息电位的基础上产生的可扩布的电位变化过程。动作电位由峰电位和后电位组成。峰电位是动作电位的主要组成成分，因此通常意义的动作电位主要指峰电位。神经元产生的电信号可以通过微电极细胞外记录方式得到，这种方式采集到的信号往往是同一脑区内多个神经元电信号的叠加。神经元电信号可以分别响应不同的生理活动，因此知道哪种电信号对应哪种生理活动至关重要。每种神经元电信号都有自己独特的锋电位信号，因此锋电位信号作为神经元电信号的一部分，可以根据其特征对神经元电信号进行区分。由于每个神经元都有自己独特的峰电位的形状，有效检测每个峰电位的形态，具有重大的意义。现有的峰电位检测方法主要是根据人工经验确定聚类的个数，仅一次空间聚类实现峰电位分解，误差较大。发明内容本发明要解决的技术问题是：如何有效进行峰电位的分解。本发明解决其技术问题所采用的技术方案是：一种动作电位的分解方法，包括：S1、对峰电位进行峰值对齐；S2、对所述峰电位进行空间变换得到对应的基向量，根据基向量的贡献率进行信号重构得到重构信号；对所述重构信号进行空间聚类处理以获取至少一个信号模板；S3、选定所述信号模板，记为信号模板Y；S4、根据所述信号模板Y逐层分解峰电位，具体包括：S41、将信号匹配信号模板Y，以从信号中剥离出与所述信号模板Y对应的信号电位；S42、迭代进行步骤S1至S3以及步骤S41，以进行峰电位的逐层分解。进一步的，将提取的峰电位从特征空间变换到投影空间，得到每个所述峰电位对应的基向量；计算每个基向量的贡献率，所述基向量的贡献率表示基向量的特征值在所有基向量的特征值之和中所占的比例；将所有的基向量的贡献率从大到小排序，设定阈值thd_c，按照从大到小的顺序选取若干个基向量的贡献率，当若干个基向量的贡献率之和大于或等于阈值thd_c时，进行信号重构；其中，所述阈值thd_c的取值通过对所有基向量的贡献率进行高斯拟合，根据3σ原则确定。进一步的，所述空间聚类包括：根据离散度确定聚类数量，以获取信号模板的波形和数量；其中，获取所有基向量的特征值，将所述特征值进行从大到小排列；每次去除一个最大的特征值后，计算剩余的特征值的离散度CoV；若当前离散度CoVK小于上一个离散度CoVK-1且当前离散度CoVK小于下一个离散度CoVK+1，则表明离散度逐渐递减后出现第一个拐点，K表示离散度的序列；此时，若K小于阈值nb，则聚类个数M=nb；若K大于或等于阈值nb，则聚类个数M=K。进一步的，所述选定信号模板包括：在所有信号模板中，先按峰电位数量排序，再选取峰峰值最大的信号模板记为聚类后的信号模板Y。进一步的，所述匹配信号模板Y包括：计算所述信号中的所有峰电位与信号模板Y之间的相关系数R；当某一峰电位对应的相关系数R大于等于阈值thd0时，认为该峰电位与所述信号模板Y匹配。进一步的，所述步骤迭代的终止条件包括：当迭代次数大于迭代阈值时，终止迭代；或者，当当前迭代得到的峰电位的峰值小于阈值thd1时，终止迭代；或者，当当前迭代得到的信号模板Y的持续时长小于阈值thd2时，终止迭代；其中，阈值thd1=0.5*rms，X表示信号；阈值thd2为一次单元放电的最小持续时长。进一步的，S5、选取所需的峰电位波形，即，对达到迭代终止条件的全部迭代的峰电位波形，选取峰电位波形的发放频率大于发放频率统计量的峰电位波形作为有效的峰电位波形。本发明还提供一种所述的动作电位的分解方法的分解模型，包括：对齐模块，用于提取信号中的峰电位并进行峰值对齐；获取模块，用于获取至少一个信号模板；选定模块，用于选定信号模板；分解模块，用于逐层分解峰电位。本发明还提供一种信号分析设备，包括：采集模块，用于采集脑电/肌电信号；处理器，用于执行所述的分解方法的步骤；显示模块，用于显示信号分解结果。本发明的有益效果是，本发明的动作电位的分解方法、分解模型、信号分析设备，通过对峰电位进行降噪重构，对重构信号进行聚类处理，得到多个信号模板，在从多个信号模板中选定一个信号模板作为分解的信号模板Y，将信号X中的峰电位与信号模板Y进行匹配，将匹配的峰电位时刻减去信号模板Y从而剥离出峰电位波形，以此进行迭代，将信号X中的所有峰电位分解出来。本发明基于信号本身构建信号模板，可以提高峰电位分解的精度。附图说明下面结合附图和实施例对本发明进一步说明。图1是本发明的分解方法的流程图。图2是本发明的分解方法的具体工作过程。图3是本发明的离散度的变化曲线。图4是本发明聚类处理后的结果示意图。图5a是本发明的信号模板的第一种示意图。图5b是本发明的信号模板的第二种示意图。图5c是本发明的信号模板的第三种示意图。图5d是本发明的信号模板的第四种示意图。图5e是本发明的信号模板的第五种示意图。图6是本发明的信号X的波形图。图7是本发明的信号X一次迭代后的波形图。图8是本发明的信号X三次迭代后的波形图。图9是本发明的信号X五次迭代后的波形图。图10是本发明一具体实施例的波形图。图11是本发明的分解的峰电位波形与实际峰电位波形之间的相关系数。图12是本发明的分解的峰电位波形与实际峰电位波形之间的幅值误差。具体实施方式现在结合附图对本发明作进一步详细的说明。这些附图均为简化的示意图，仅以示意方式说明本发明的基本结构，因此其仅显示与本发明有关的构成。在本发明的描述中，需要理解的是，术语“中心”、“纵向”、“横向”、“长度”、“宽度”、“厚度”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”“内”、“外”、“顺时针”、“逆时针”、“轴向”、“径向”、“周向”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本发明的描述中，除非另有说明，“多个”的含义是两个或两个以上。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。如图1所示，本发明的动作电位的分解方法，包括：S1、对峰电位进行峰值对齐。S2、对峰电位进行空间变换得到对应的基向量，根据基向量的贡献率进行信号重构得到重构信号；对重构信号进行空间聚类处理以获取至少一个信号模板。S3、选定信号模板，记为信号模板Y。S4、根据信号模板Y逐层分解峰电位，具体包括：S41、将信号匹配信号模板Y，以从信号中剥离出与信号模板Y对应的信号电位；S42、迭代进行步骤S1至S3以及步骤S41，以进行峰电位的逐层分解。需要说明的是，一段原始信号中可以包含一个或多个峰电位，对原始信号进行预处理后，提取出该原始信号中的所有峰电位，每个峰电位包含的样本点数量相同。步骤S1-S5中所提到的“信号”均是指对原始信号进行预处理后得到的信号，记为信号X，计算信号X的所有峰值点后，对每个峰值点的信号X向前和向后选取一段时长，将所有的峰电位进行峰值对齐，以便对不同的峰电位的特征进行比较。对每个峰电位进行降噪处理，可以得到多个重构信号，对所有的重构信号进行聚类处理，可以得到多个聚类簇；聚类后，对每个聚类簇下的所有峰电位进行平均得到该聚类簇下的信号模板；每个聚类簇可以包含多个相似的重构信号，根据聚类簇可以得到多个信号模板，该信号模板用于后续峰电位的分解使用。选定信号模板包括：在所有信号模板中，先按峰电位数量排序，再选取峰峰值最大的信号模板记为聚类后的信号模板Y。例如，对重构信号进行聚类处理后，可以得到N个类别，每个类别中包含的重构信号数量相同或不同。根据峰电位的数量将N个信号模板从大到小进行排序，将峰电位数量排名前两位的信号模板记为信号模板MU1和信号模板MU2，分别计算信号模板MU1和信号模板MU2的峰峰值，其中，PPV=Pmax-Pmin，Pmax表示信号模板中峰电位的最大值，Pmin表示信号模板中峰电位的最小值，选取信号模板MU1、信号模板MU2的峰峰值较大的一者作为信号模板Y。本发明的信号模板选定方法，有别于采用Hermite-Rodriguez函数进行归一化和变形来表示每种峰电位的波形的传统经验模板，通过聚类得到的N个信号模板均来自信号本身，跟随信号特征的变化而变化，信号模板的选择更加精准贴近信号本身。并且， 根据神经元募集遵从“大小原则”，挑选出空间聚类的峰电位模板中排名靠前的幅值最大的信号模板，可以有效凸显出一次空间聚类差异最大的可靠的信号模板。在步骤S4中，选定信号模板Y后，需要将信号X与信号模板Y进行匹配，从信号X中筛选出与信号模板Y对应的信号电位，即，可以得到一类峰电位。将剥离后的信号X重复步骤S1至S3以及步骤S41，以此循环，可以将信号X中的不同峰电位分解出来。由于神经元募集服从“大小原则”，采集的电压信号通常表现为幅值大的峰电位和幅值较小的峰电位的相互叠加，根据本发明的模板选定策略，按照“从大到小”的顺序可以有效、自动地对混叠的信号进行逐个剥离，渐进完成对峰电位的分解。本发明采用模板匹配法，在最大程度上保留了同一峰电位的形态，对不同峰电位分解采用渐进递归方法，通过不断减去信号模板，增加聚类的可分性，避免同一峰电位模板被重复计算，可以提高峰电位分解的准确性。具体的，进行信号重构的过程包括：将提取的峰电位从特征空间变换到投影空间，得到峰电位对应的基向量。计算每个基向量的贡献率，基向量的贡献率表示基向量的特征值在所有基向量的特征值之和中所占的比例；由此获取在投影空间下的所有基向量的贡献率。将所有的基向量的贡献率从大至小排序，设定阈值thd_c，按照从大到小的顺序选取若干个基向量的贡献率，当若干个基向量的贡献率之和大于或等于阈值thd_c时，进行信号重构。其中，阈值thd_c的取值通过对所有基向量的贡献率进行高斯拟合，根据3σ原则确定。例如，设信号X的样本矩阵x的维度为m*n，表示具有m个n维度的样本点，对样本矩阵x去中心化处理，即x′=x-μ，表示第j维的均值，x′表示去中心化后的样本矩阵。计算信号X的协方差矩阵/＞，对协方差矩阵C进行奇异值分解得到在特征空间下的特征值λ和正交特征向量P，将信号X投影到以正交特征向量P为基的新空间，得到基向量Z=xP。对特征值λ进行从大到小排序，特征值λ越大，表明对应的投影空间下的基向量的差异越大。计算投影空间下的所有基向量的方差，并将方差从大到小进行排列，每个基向量的贡献率的计算公式为。例如，一共获得10个贡献率，分别记为Rate1～Rate2，假设按照从大到小排序为：Rate2、Rate3、Rate1、Rate4、Rate5、Rate7、Rate6、Rate8、Rate9、Rate10，假设阈值thd_c=0.8，Rate2、Rate3、Rate1、Rate4、Rate5、Rate7、Rate6的贡献率之和已大于或等于0.8，那么可以排除Rate8、Rate9、Rate10，对贡献率Rate2、Rate3、Rate1、Rate4、Rate5、Rate7、Rate6对应的基向量进行信号重构。例如，阈值thd_c的取值范围为0～1，例如可以设置为0.5、0.8、0.9、0.95，当至少三个基向量的贡献率之和大于或等于阈值thd_c时，可以进行信号重构.具体的，空间聚类处理包括：根据离散度确定聚类数量，以获取信号模板的波形和数量；其中，获取所有基向量的特征值，将特征值进行从大到小排列；每次去除一个最大的特征值后，计算剩余的特征值的离散度CoV；若当前离散度CoVK小于上一个离散度CoVK-1且当前离散度CoVK小于下一个离散度CoVK+1，则表明离散度逐渐递减后出现第一拐点；K表示离散度的序列，此时，若K小于阈值nb，则聚类个数M=nb；若K大于或等于阈值nb，则聚类个数M=K。例如，可以采用k均值聚类算法对重构信号进行聚类，初始时，随机选择T个样本点作为聚类中心O1～OT，计算每个样本点与不同的聚类中心之间的欧式距离，根据欧式距离的大小将样本点归类到距离最近的簇群中，得到聚类结果。计算每个簇群的样本点的均值并将均值作为新的聚类中心。需要说明的是，聚类中心的个数根据基向量的离散度来确定。对投影空间下的基向量的方差按照从大到小的顺序进行排列，每次去除最大的第一个的方差，计算剩余的方差的离散度CoV，例如，方差序列为，第一个最大的方差为/＞，则CoV1表示的离散度，在剩余的方差序列中，第一个最大的方差为/＞，则CoV2表示的离散度，等等。离散度的计算公式为：/＞，/＞表示方差的标准差，/＞表示方差的平均值。如果当前离散度CoVK小于上一个离散度CoVK-1且当前离散度CoVK小于下一个离散度CoVK+1，则表明离散度逐渐递减后出现了第一个拐点，记为基向量差异减小变陡的位置，对应投影空间下差异最大的基向量。如果此时，K＜nb，则确定聚类个数M=nb；如果此时K≥nb，则确定聚类个数M=K，例如，阈值nb=5。如图3所示，横坐标表示排除的方差的个数，纵坐标表示离散度，在CoV5的时候出现了第一个拐点，则K=5=nb，设聚类个数M=5，因此，聚类处理后可以获得5个簇群。投影空间的方差的离散度反映了各个基向量在整体分布中的偏离程度，方差的偏离程度越大，说明基向量在投影空间的差异越大，这样，有利于表现观察样本的差异性和空间划分的类别。获得聚类结果后，将每个簇群内的峰电位呈现在同一张图上，计算每个簇群的所有峰电位的信号点的平均值，可以获得该簇群对应的信号模板。例如图5a至图5e所示，横坐标表示样本点，纵坐标表示电压幅值，曲线H表示峰电位的原始波形，曲线H′表示该簇群的信号模板，例如，每一条峰电位波形包含700个样本点，共有20条峰电位波形，将每个样本点对应的20个电压值取平均值，再将所有的平均值连成曲线，即可得到曲线H′。这样，一共可以获得5个信号模板，再从这5个信号模板中选出信号模板Y。将信号X匹配信号模板Y包括：计算信号中的所有峰电位与信号模板Y之间的相关系数R，当某一峰电位对应的相关系数R大于等于阈值thd0时，认为该峰电位与信号模板Y匹配。相关系数R的计算公式为：，/＞表示信号X与信号模板Y之间的协方差，/＞表示信号X的方差，/＞表示信号模板Y的方差，相关系数R越大，表明信号X的峰电位与信号模板Y之间越相似。当相关系数R＞thd0时，判定峰电位与信号模板Y匹配，阈值thd0为皮尔逊相关系数，越接近1代表相关性越高，意味着信号模板Y和峰电位越相似， 阈值thd0的取值为0.95～1。此时，在分解信号X的峰电位时，将信号X中与信号模板Y匹配的峰电位时刻减去该信号模板Y。例如，步骤S1至S3以及步骤S41的迭代终止条件为：当迭代次数大于迭代阈值时，终止迭代；或者，当当前迭代得到的峰电位的峰值小于阈值thd1时，终止迭代；或者，当当前迭代得到的信号模板Y的持续时长小于阈值thd2时，终止迭代。其中，迭代阈值例如可以设为大于20的正整数，阈值thd1=0.5*rms，X表示信号，rms表示信号X的均方根，阈值thd2为一次单元放电的最小持续时长，例如取5ms。换言之，终止迭代条件可以有三种，达到任意一种终止条件均可以终止迭代。换言之，本发明的分解方法，通过对信号X进行重构，对重构信号进行聚类处理，获得聚类个数，从而得到多个信号模板；从多个信号模板中选定一个信号模板Y对一类峰电位进行剥离；将剥离后的信号X重复重构、聚类、选定、剥离等步骤，以将不同的峰电位逐层分解出来。本发明通过重构信号可以提高信号的信噪比，根据离散度确定聚类个数，可以提高分类的准确率，量化峰电位的类别；采用模板匹配的方式，可以最大程度保留同一峰电位的形态，通过不断减去信号模板Y，剥离出不同的峰电位，能够增加聚类的可分性，避免同一峰电位被重复计算。本发明还包括：S5、选取所需的峰电位波形，即，对达到迭代终止条件的全部迭代的峰电位波形，选取峰电位波形的发放频率大于发放频率统计量的峰电位波形作为有效的峰电位波形。需要说明的是，发放频率是指当神经或肌肉兴奋时，采用针电极记录到的峰电位在一秒内重复出现的次数，发放频率统计量是指发放频率的中位数、均值等统计量；根据提前设定好的发放频率统计量来选取符合要求的峰电位波形。例如，经过测量，峰电位波形一、峰电位波形二、峰电位波形三在一秒钟内分别出现10次、8次、4次，发放频率统计量为7.3次，那么只有峰电位波形一、峰电位波形二满足要求，即选取峰电位波形一、峰电位波形二为有效的峰电位波形。将不同的峰电位从信号X中分解出来后，可以根据需求进行选取，便于后续分析神经元信号所传达的信息。例如，信号X的波形如图6所示，经过一次迭代后的波形如图7所示，经过三次迭代后的波形如图8所示，经过五次迭代后的波形如图9所示，从图中可以看出，每一次迭代后，信号X中的峰电位会减少。由此可以说明本方法的有效性。例如，信号X的波形如图10所示，采用本方法对信号X进行重构、聚类后，可以获得六个信号模板～），在六个信号模板中选定信号模板Y进行峰电位分解。如图11至图12所示，横坐标均表示被试数据的编号，纵坐标分别表示相关系数和均方误差，将通过本方法分解出来的峰电位波形与实际的峰电位波形进行比较，两者的相关系数的平均值为0.99，两者均方误差为17mV，由此可以说明，采用本方法得到的峰电位波形与实际的峰电位波形基本相同，本方法可以有效引应用于峰电位分解。本发明还提供一种动作电位的分解方法的分解模型，包括：对齐模块，用于提取信号中的峰电位并进行峰值对齐；获取模块，用于获取至少一个信号模板；选定模块，用于选定信号模板；分解模块，用于逐层分解峰电位。对齐模块、获取模块、选定模块均可以通过处理器运行相应的算法，实施分解模型。本发明还提供一种信号分析设备，包括：采集模块，用于采集脑电/肌电信号，例如但不限于电极或信号传输接口、信号导入设备等；处理器，用于执行分解方法的步骤，例如但不限于电脑；显示模块，用于显示信号分解结果，例如但不限于显示器。该信号分析设备可用于脑电、肌电信号的分解，提取动作电位波形，可以用于神经元疾病、肌源性疾病的评估；也可用于神经元放电的风电为分类，具有很高的应用价值。所述信号分析设备例如但不限于肌电诱发电位仪、高频高导数字脑电图机。综上所述，本发明的动作电位的分解方法、分解模型、信号分析设备，通过对峰电位进行降噪重构，对重构信号进行聚类处理，得到多个信号模板，在从多个信号模板中选定一个信号模板作为分解的信号模板Y，将信号X中的峰电位与信号模板Y进行匹配，将匹配的峰电位时刻减去信号模板Y从而剥离出峰电位波形，以此进行迭代，将信号X中的所有峰电位分解出来。本发明基于信号本身构建信号模板，可以提高峰电位分解的精度。以上述依据本发明的理想实施例为启示，通过上述的说明内容，相关工作人员完全可以在不偏离本项发明技术思想的范围内，进行多样的变更以及修改。本项发明的技术性范围并不局限于说明书上的内容，必须要如权利要求范围来确定其技术性范围。
