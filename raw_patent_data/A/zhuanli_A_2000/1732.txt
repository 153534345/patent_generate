标题title
一种基于波形证据回归的血糖浓度检测方法及装置
摘要abst
本发明公开了一种基于波形证据回归的血糖浓度检测方法及装置，属于光声信号处理及人体血糖检测应用等领域。本发明提出一种新的波形特征，结合证据回归算法，根据血糖光声信号的特点，对待测浓度的血糖光声信号进行血糖浓度检测。本发明利用二阶微分方程对血糖光声信号进行建模，同时使用最优化方法计算出信号的波形特征；由于波形特征与血糖浓度之间的存在非线性关联，因此采用证据回归算法拟合特征向量与血糖浓度，通过大量的数据测试表明，血糖浓度与波形特征之间存在非线性关系，同时证据回归算法具有很强的非线性回归能力，最终本方法较于传统方法检测准确率较高，且可以在低信噪比下依旧保证较高的准确率。
权利要求书clms
1.一种基于波形证据回归的血糖浓度检测方法，其特征在于，包括如下的步骤：步骤1、输入待检测的血糖光声信号f；步骤2、初始化波形特征V＝＝，其中ω、Mp、ts分别表示血糖光声信号的自然频率、最大超调量和调节时间；步骤3、根据步骤2中得到的波形特征和二阶微分方程模型进行数值求解，得到模型输出f′；步骤4、使用步骤3中得到的模型输出f′和步骤1中的光声信号f计算误差，并记为err；步骤5、判断误差err是否收敛，如果收敛则保留波形特征，并且进入步骤6；否则，调整波形特征，并进入步骤3；步骤6、使用证据回归模型对步骤5得到的波形特征，进行预测，得到检测结果，并输出。2.根据权利要求1所述的一种基于波形证据回归的血糖浓度检测方法，其特征在于，所述的步骤3具体流程为：将步骤2中得到的波形特征，代入到下面的二阶微分方程中计算模型输出，其公式为：其中，f′为公式的求解结果，而ξ,ω分别为2个模型参数，并且ξ＝1为经验值，ω＝0为初始值，随着迭代不断变化直到误差值收敛；而F为高斯函数，其均值和方差分别通过步骤1中得到的血糖光声信号f的最大值位置和信号均值确定，而波形特征的其余两个参数通过如下公式计算：其中，f′可以使用求解结果f′的均值进行近似，max表示最大值运算。3.根据权利要求1所述的一种基于波形证据回归的血糖浓度检测方法，其特征在于，所述的步骤4具体流程为：将步骤3中得到的模型输出f′与待检测的血糖光声信号f，分别进行希尔伯特变换，后计算幅度值之差作为误差值err。4.根据权利要求1所述的一种基于波形证据回归的血糖浓度检测方法，其特征在于，所述的步骤6具体流程：对步骤5中得到的待测血糖光声信号的波形特征，使用证据回归模型进行预测，并得到血糖浓度预测值，即为最终输出结果。5.根据权利要求4所述的一种基于波形证据回归的血糖浓度检测方法，其特征在于，在使用证据回归模型之前需要事先对证据回归模型进行参数训练；其中，证据回归模型训练方法具体如下：先选择已知浓度的血糖光声信号N组，第i个血糖光声信号记为fi，而对应的血糖浓度为ni；对每一个血糖光声信号fi按照步骤1到步骤5进行处理，得到相对应的波形特征向量，记为Vi；最终利用梯度下降法，对N组血糖浓度ni和相对应的波形特征向量Vi使用证据回归模型进行数据拟合，得到模型参数。6.一种基于波形证据回归的血糖浓度检测装置，其特征在于，包括：输入模块：输入待检测的血糖光声信号f；波形特征初始化模块：初始化波形特征V＝＝，其中ω、Mp、ts分别表示血糖光声信号的自然频率、最大超调量和调节时间；模型输出模块：根据波形特征和二阶微分方程模型进行数值求解，得到模型输出f′；误差计算模块：使用得到的模型输出f′和输入模块中的光声信号f计算误差，并记为err；收敛判断模块：判断误差err是否收敛，如果收敛则保留波形特征，并且进入预测模块；否则，调整波形特征，并进入模型输出模块；预测模块：使用证据回归模型对收敛判断模块得到的波形特征，进行预测，得到检测结果，并输出。7.根据权利要求6所述的一种基于波形证据回归的血糖浓度检测装置，其特征在于，模型输出模块实现如下：所述的模型输出模块实现具体流程为：将波形特征初始化模块中得到的波形特征，代入到下面的二阶微分方程中计算模型输出，其公式为：其中，f′为公式的求解结果，而ξ,ω分别为2个模型参数，并且ξ＝1为经验值，ω＝0为初始值，随着迭代不断变化直到误差值收敛；而F为高斯函数，其均值和方差分别通过输入模块中得到的血糖光声信号f的最大值位置和信号均值确定，而波形特征的其余两个参数通过如下公式计算：其中，f′可以使用求解结果f′的均值进行近似，max表示最大值运算。8.根据权利要求6所述的一种基于波形证据回归的血糖浓度检测方法，其特征在于，所述的误差计算模块具体实现如下：将模型输出模块中得到的模型输出f′与待检测的血糖光声信号f，分别进行希尔伯特变换，后计算幅度值之差作为误差值err。9.根据权利要求6所述的一种基于波形证据回归的血糖浓度检测装置，其特征在于，所述的预测模块具体实现流程：对收敛判断模块中得到的待测血糖光声信号的波形特征，使用证据回归模型进行预测，并得到血糖浓度预测值，即为最终输出结果。10.根据权利要求9所述的一种基于波形证据回归的血糖浓度检测装置，其特征在于，在使用证据回归模型之前需要事先对证据回归模型进行参数训练；其中，证据回归模型训练方法具体如下：先选择已知浓度的血糖光声信号N组，第i个血糖光声信号记为fi，而对应的血糖浓度为ni；对每一个血糖光声信号fi按照输入模块到收敛判断模块进行处理，得到相对应的波形特征向量，记为Vi；最终利用梯度下降法，对N组血糖浓度ni和相对应的波形特征向量Vi使用证据回归模型进行数据拟合，得到模型参数。
说明书desc
技术领域本发明涉及光声信号处理、光电测量及光声医学探测应用领域，具体涉及到血糖浓度的实时检测与测量技术，和光声信号的波形特征提取技术等。背景技术糖尿病已经成为危害人类健康的主要疾病之一。截止到2019年，全球的糖尿病患者已经达到4.63亿，并且预计到2045年会达到7亿人。同时，全球为治疗糖尿病患者，每年需要花费7600多亿美元。但直到目前，国际上针对糖尿病依旧没有有效的根治手段，因此准确的检测患者的血糖水平，并进行恰当的管理成为保证患者健康的重要手段。目前检测血糖的手段主要分为微创检测和无创检测两种。其中，微创血糖检测技术作为一种近些年发展起来的有创检测技术，需要刺破患者的皮肤并直接采集血液；而无创血糖检测则不需要采集血液，转而通过使用微波、光谱、光声等技术来间接测量血液中血糖浓度。由于多次有创采血存在伤口感染等风险，所以无创血糖检测技术成为研究热点，也是目前血糖检测技术的重要研究方向。无创血糖检测技术的测量方式多元，常见的有：基于微波传感器的血糖检测技术、基于红外光谱的血糖检测技术和基于光声光谱的血糖检测技术等等。这些测量技术各有各的优势，也有各自的不足，并不存在哪一种技术明显优于其余方法。其中，基于微波的血糖检测技术由于血液中的葡萄糖分子对微波的吸收率不高，导致整体信噪比较低，测量精度较低；而基于红外光谱的血糖检测技术则会因为水对红外光吸收较高，而无法测量皮肤深下血液的浓度，因此测量精度不高；同时皮肤等组织对光的散射也会对测量产生巨大的干扰；相较于其他的测量方法，基于光声光谱的血糖检测技术虽然不受光散射的影响，但是信号本身微弱，需要昂贵的测量设备才能实现较高的测量精度。目前对血糖光声信号的采集和测量系统已有大量且详细的研究，但针对血糖光声信号的信号处理算法却少有探索，尤其是在血糖光声信号的特征建模方面，相关研究较少。本发明主要针对已经获取的血糖信号，进行后续的数据处理；根据血糖光声信号自身特点，设计一种新的波形特征，并提出一套新的信号处理算法，实现对血糖浓度的准确预测。发明内容本发明的主旨在于针对基于血糖光声信号检测中血糖浓度与信号特征之间是否存在关联的问题，提出一种检测精度高、抗干扰能力强的血糖浓度检测算法，为无创血糖检测技术在算法设计上提供一种可行思路。为了解决上述技术问题，达到上述的目标，本发明采用如下技术方案：一种基于波形证据回归的血糖浓度检测方法，包括如下的步骤：步骤1、输入待检测的血糖光声信号f；步骤2、初始化波形特征V＝＝，其中ω、Mp、ts分别表示血糖光声信号的自然频率、最大超调量和调节时间；步骤3、根据步骤2中得到的波形特征和二阶微分方程模型进行数值求解，得到模型输出f′；步骤4、使用步骤3中得到的模型输出f′和步骤1中的光声信号f计算误差，并记为err；步骤5、判断误差err是否收敛，如果收敛则保留波形特征，并且进入步骤6；否则，调整波形特征，并进入步骤3；步骤6、使用证据回归模型对步骤5得到的波形特征，进行预测，得到检测结果，并输出；上述技术方案中，所述步骤2具体流程为：对波形特征进行初始化，具体为V＝＝。上述技术方案中，所述步骤3具体流程为：将步骤2中得到的波形特征，代入到下面的二阶微分方程中计算模型输出，其公式为：其中，f′为公式的求解结果，而ξ,ω分别为2个模型参数，并且ξ＝1为经验值，ω＝0为初始值，随着迭代不断变化直到误差值收敛。而F为高斯函数，其均值和方差分别通过步骤1中得到的血糖光声信号f的最大值位置和信号均值确定。而波形特征的其余两个参数通过如下公式计算：其中，f′可以使用求解结果f′的均值进行近似，max表示最大值运算。上述技术方案中，所述步骤4具体流程为：将步骤3中得到的模型输出f′与待检测的血糖光声信号f，分别进行希尔伯特变换，后计算幅度值之差作为误差值err。具体公式表达如下：err＝|||H|-|H|||2其中，H表示希尔伯特变换，|·|表示取模运算。上述技术方案中，所述步骤6具体流程：对步骤5中得到的待测血糖光声信号的波形特征，使用证据回归模型进行预测，并得到血糖浓度预测值，即为最终输出结果。值得注意的是，在使用证据回归模型之前需要事先对证据回归模型进行参数训练；其中，证据回归模型训练方法具体如下：先选择已知浓度的血糖光声信号N组，第i个血糖光声信号记为fi，而对应的血糖浓度为ni。对每一个血糖光声信号fi按照步骤1到步骤5进行处理，得到相对应的波形特征向量，记为Vi。最终利用梯度下降法，对N组血糖浓度ni和相对应的波形特征使用证据回归模型进行数据拟合，得到模型参数。本发明还提供了一种基于波形证据回归的血糖浓度检测装置，包括：输入模块：输入待检测的血糖光声信号f；波形特征初始化模块：初始化波形特征V＝＝，其中ω、Mp、ts分别表示血糖光声信号的自然频率、最大超调量和调节时间；模型输出模块：根据波形特征和二阶微分方程模型进行数值求解，得到模型输出f′；误差计算模块：使用得到的模型输出f′和输入模块中的光声信号f计算误差，并记为err；收敛判断模块：判断误差err是否收敛，如果收敛则保留波形特征，并且进入预测模块；否则，调整波形特征，并进入模型输出模块；预测模块：使用证据回归模型对收敛判断模块得到的波形特征，进行预测，得到检测结果，并输出。上述技术方案中，模型输出模块实现如下：所述的模型输出模块实现具体流程为：将波形特征初始化模块中得到的波形特征，代入到下面的二阶微分方程中计算模型输出，其公式为：其中，f′为公式的求解结果，而ξ,ω分别为2个模型参数，并且ξ＝1为经验值，ω＝0为初始值，随着迭代不断变化直到误差值收敛；而F为高斯函数，其均值和方差分别通过输入模块中得到的血糖光声信号f的最大值位置和信号均值确定，而波形特征的其余两个参数通过如下公式计算：其中，f′可以使用求解结果f′的均值进行近似，max表示最大值运算。上述技术方案中，所述的误差计算模块具体实现如下：将模型输出模块中得到的模型输出f′与待检测的血糖光声信号f，分别进行希尔伯特变换，后计算幅度值之差作为误差值err。上述技术方案中，所述的预测模块具体实现流程：对收敛判断模块中得到的待测血糖光声信号的波形特征，使用证据回归模型进行预测，并得到血糖浓度预测值，即为最终输出结果。上述技术方案中，在使用证据回归模型之前需要事先对证据回归模型进行参数训练；其中，证据回归模型训练方法具体如下：先选择已知浓度的血糖光声信号N组，第i个血糖光声信号记为fi，而对应的血糖浓度为ni；对每一个血糖光声信号fi按照输入模块到收敛判断模块进行处理，得到相对应的波形特征向量，记为Vi；最终利用梯度下降法，对N组血糖浓度ni和相对应的波形特征向量Vi使用证据回归模型进行数据拟合，得到模型参数。与现有技术相比，本发明具有如下有益效果：本发明对血糖光声信号运用二阶微分方程分析血糖光声信号的振荡特点，并提取一种新的波形特征用于描述信号衰减速率；同时利用证据回归算法，建模波形特征和血糖浓度之间的非线性关系，；最终结合波形证据回归模型提出一套血糖浓度检测算法，在实测数据下取得比传统方法更低的预测误差，更高的预测精度。本发明使用二阶微分方程刻画血糖光声信号连续振荡的特点，相较于传统方法提出一种新颖的特征，同时基于证据回归模型可以在非线性强烈的情况下准确建模特征向量与血糖浓度之间的非线性联系，并获得更高的测量精度。附图说明图1：算法设计流程图；图2：血糖光声信号和高斯脉冲函数图；图3：血糖光声信号和模型输出图；图4：预测误差均值曲线图；图5：预测误差方差曲线图。具体实施方式下面将结合附图及具体实施方式对本发明作进一步的描述。②输入待检测的血糖光声信号f；②初始化波形特征V＝＝，其中ω、Mp、ts分别表示血糖光声信号的自然频率、最大超调量和调节时间；③根据步骤2中得到的波形特征和二阶微分方程模型进行数值求解，得到模型输出f′；④使用步骤3中得到的模型输出f′和步骤1中的光声信号f计算误差，并记为err；⑤判断误差err是否收敛，如果收敛则保留波形特征，并且进入步骤6；否则，调整波形特征，并进入步骤3；⑥使用证据回归模型对步骤5得到的波形特征，进行预测，得到检测结果，并输出；在本发明中，所述步骤③具体流程为：将步骤②中得到的波形特征，代入到下面的二阶微分方程中计算模型输出，其公式为：其中，f′为公式的求解结果，而ξ,ω分别为2个模型参数，并且ξ＝1为经验值，ω＝0为初始值，随着迭代不断变化直到误差值收敛。而F为高斯函数，其均值和方差分别通过步骤①中得到的血糖光声信号f的最大值位置和信号均值确定。而波形特征的其余两个参数通过如下公式计算：其中，f′可以使用求解结果f′的均值进行近似，max表示最大值运算。在本发明中，所述步骤④具体流程为：将步骤③中得到的模型输出f′与待检测的血糖光声信号f，分别进行希尔伯特变换，后计算幅度值之差作为误差值err。具体公式表达如下：err＝|||H|-|H|||2其中，H表示希尔伯特变换，|·|表示取模运算。在本发明中，所述步骤⑥具体流程为：对步骤5中得到的待测血糖光声信号的波形特征，使用证据回归模型进行预测，并得到血糖浓度预测值，即为最终输出结果。值得注意的是，在使用证据回归模型之前需要事先对证据回归模型进行参数训练；其中，证据回归模型训练方法具体如下：先选择已知浓度的血糖光声信号N组，第i个血糖光声信号记为fi，而对应的血糖浓度为ni。对每一个血糖光声信号fi按照步骤1到步骤5进行处理，得到相对应的波形特征向量，记为Vi。最终利用梯度下降法，对N组血糖浓度ni和相对应的波形特征使用证据回归模型进行数据拟合，得到模型参数。
