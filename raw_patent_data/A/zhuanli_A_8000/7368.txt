标题title
一种穿刺方位解算方法以及穿刺作业执行系统
摘要abst
本申请医疗器械运动控制技术领域，特别是涉及一种穿刺方位解算方法以及穿刺作业执行系统。获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系；获取目标对象的影像数据，根据所述影像数据确定待处理目标的环境约束关系；基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量；根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息，所述轨迹规划信息用于控制所述执行设备在所述穿刺方位向量上执行穿刺。采用本方法能够根据感知参数确定穿刺方位，提高穿刺安全性。
权利要求书clms
1.一种穿刺方位解算方法，其特征在于，所述方法包括：获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系；获取目标对象的影像数据，根据所述影像数据确定待处理目标的环境约束关系，所述环境约束关系基于所述影像数据中的非相关目标确定；基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系；根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息，所述轨迹规划信息用于控制所述执行设备在所述穿刺方位向量上执行穿刺。2.根据权利要求1所述的方法，其特征在于，所述基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系包括：基于所述运动约束关系以及所述环境约束关系，得到与所述非相关目标距离最大化的所述执行设备的穿刺方位向量，所述穿刺方位向量包括约束向量，所述约束向量如下式所示：式中，和q均为关节位置信息，/＞为对应于环境约束关系的第一代价函数，所述第一代价函数还表示所述穿刺方位向量与所述非相关目标距离最大化的距离约束关系，为对应于运动约束关系的第二代价函数。3.根据权利要求2所述的方法，其特征在于，所述基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量包括：获取对所述第一代价函数的第一权重系数，以及对所述第二代价函数的第二权重系数，基于所述第一权重系数以及所述第二权重系数确定所述约束向量，所述约束向量如下式所示：式中，为所述第一代价函数的第一权重系数，/＞为所述第二代价函数的第二权重系数。4.根据权利要求1所述的方法，其特征在于，所述获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系包括：基于所述结构参数构建用于描述所述执行设备运动规律的数字结构模型，所述数字结构模型包括主动关节、被动关节以及末端执行器；根据所述数字结构模型对所述末端执行器的运动轨迹进行仿真模拟，得到所述运动约束关系，所述运动约束关系为所述执行设备的关节位置与末端位置的约束关系，如下式所示：式中，为所述末端位置信息，/＞为穿刺方向的旋转矩阵，/＞为所述数字结构模型中的关节位置信息。5.根据权利要求4所述的方法，其特征在于，所述根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息包括：基于对所述执行设备的结构约束关系的微分处理，得到所述执行设备的微分运动约束关系，所述微分运动约束关系为所述执行设备的期望运动参数与关节运动参数的约束关系，如下式所示：式中，v为所述执行设备的末端速度向量，为根据所述执行设备的所述主动关节位置确定的雅克比矩阵，/＞为所述执行设备的所述主动关节速度向量；在得到所述主动关节速度向量之后，对所述微分运动约束关系进行积分处理，得到所述关节运动参数。6.根据权利要求4所述的方法，其特征在于，所述根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息包括：若通过所述逆向运动求解得到所述关节位置信息超过了所述数字结构模型的关节限位，则缩小所述运动约束关系以及所述环境约束关系对应的约束空间，直至所述关节位置信息符合所述关节限位。7.一种穿刺方位解算装置，其特征在于，所述装置包括：运动约束模块，用于获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系；环境约束模块，用于获取目标对象的影像数据，根据所述影像数据确定待处理目标的环境约束关系，所述环境约束关系基于所述影像数据中的非相关目标确定；方位向量模块，用于基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系；逆向求解模块，用于根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息，所述轨迹规划信息用于控制所述执行设备在所述穿刺方位向量上执行穿刺。8.一种穿刺作业执行系统，其特征在于，所述系统包括：图像处理模块，用于接收并处理目标对象的影像数据；穿刺控制模块，用于接收所述目标对象的影像数据，并根据如权利要求1至6中任意一项所述的一种穿刺方位解算方法生成并输出轨迹规划信息；执行设备模块，用于接收所述轨迹规划信息，并根据所述轨迹规划信息指示的穿刺路径完成穿刺作业。9.一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至6中任一项所述的方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1至6中任一项所述的方法的步骤。11.一种计算机程序产品，包括计算机程序，其特征在于，该计算机程序被处理器执行时实现权利要求1至6中任一项所述的方法的步骤。
说明书desc
技术领域本申请涉及医疗器械运动控制技术领域，特别是涉及一种穿刺方位解算穿刺方法、装置、计算机设备、存储介质和计算机程序产品以及穿刺作业执行系统。背景技术传统的经皮介入穿刺手术是医生在CT机设备引导下，将小型手术器械，如穿刺针送入患者体内，对病变部位进行检测或治疗的一种微创手术。经皮介入微创穿刺手术与其他微创手术一样，具有创面小。康复快和术后并发症少等优点。在进行经皮穿刺时，医生通过病灶附近的二维或三维扫描图像判断合适的入针点和入针方向，然后凭借经验通过手动调整穿刺通道完成穿刺操作，常规的X射线透视下穿刺需要医生根据CT机X射线的图像反复多次手动调整操作才能将穿刺针准确穿刺患者体内。穿刺诊疗针对不同的部位其需要解决的问题相对来说是一致的，目前常用的治疗手段是基于体外图像引导的微创穿刺手术，如穿刺活检、消融等，该方法具有创伤小、疼痛轻、恢复快等优点，也是恶性肿瘤诊断与治疗的重要手段之一。但该方法存在徒手穿刺精度低、不可视、遭受辐射时间长、易引发并发症等问题，手术效果严重依赖医生的经验。因此希望借助机器人技术解决穿刺诊疗中的痛点问题。相关技术中，随着现代工业技术的发展，已经出现了能够辅助医师进行穿刺处理的机器人，通过机器人的辅助效果，提高穿刺手术的流程完成效率，并降低在手术过程中医职人员的介入时间，从而在保证手术效果的基础上降低对医职人员的伤害。然而，目前的应用穿刺机器人辅助实现穿刺手术的方法，存在如下的技术问题：穿刺机器人所需要执行的穿刺定位的对象存在个体差异性较强的特征，常规的运动控制算法倾向于确定穿刺方位的范围，难以给出具体的优选穿刺方案。发明内容基于此，有必要针对上述技术问题，提供一种能够根据感知参数确定穿刺方位，提高穿刺安全性的一种穿刺方位解算方法、装置、计算机设备、计算机可读存储介质和计算机程序产品。第一方面，本申请提供了一种穿刺方位解算方法。所述方法包括：获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系；获取目标对象的影像数据，根据所述影像数据确定待处理目标的环境约束关系，所述环境约束关系基于所述影像数据中的非相关目标确定；基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系；根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息，所述轨迹规划信息用于控制所述执行设备在所述穿刺方位向量上执行穿刺。在其中一个实施例中，所述基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系包括：基于所述运动约束关系以及所述环境约束关系，得到与所述非相关目标距离最大化的所述执行设备的穿刺方位向量，所述穿刺方位向量包括约束向量，所述约束向量如下式所示：式中，和q均为关节位置信息，/＞为对应于环境约束关系的第一代价函数，所述第一代价函数还表示所述穿刺方位向量与所述非相关目标距离最大化的距离约束关系，/＞为对应于运动约束关系的第二代价函数。在其中一个实施例中，所述基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量包括：获取对所述第一代价函数的第一权重系数，以及对所述第二代价函数的第二权重系数，基于所述第一权重系数以及所述第二权重系数确定所述约束向量，所述约束向量如下式所示：式中，为所述第一代价函数的第一权重系数，/＞为所述第二代价函数的第二权重系数。在其中一个实施例中，所述获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系包括：基于所述结构参数构建用于描述所述执行设备运动规律的数字结构模型，所述数字结构模型包括主动关节、被动关节以及末端执行器；根据所述数字结构模型对所述末端执行器的运动轨迹进行仿真模拟，得到所述运动约束关系，所述运动约束关系为所述执行设备的关节位置与末端位置的约束关系，如下式所示：式中，为所述末端位置信息，/＞为穿刺方向的旋转矩阵，/＞为所述数字结构模型中的关节位置信息。在其中一个实施例中，所述根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息包括：基于对所述执行设备的结构约束关系的微分处理，得到所述执行设备的微分运动约束关系，所述微分运动约束关系为所述执行设备的期望运动参数与关节运动参数的约束关系，如下式所示：式中，v为所述执行设备的末端速度向量，为根据所述执行设备的所述主动关节位置确定的雅克比矩阵，为所述执行设备的所述主动关节速度向量；在得到所述主动关节速度向量之后，对所述微分运动约束关系进行积分处理，得到所述关节运动参数。在其中一个实施例中，所述根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息包括：若通过所述逆向运动求解得到所述关节位置信息超过了所述数字结构模型的关节限位，则缩小所述运动约束关系以及所述环境约束关系对应的约束空间，直至所述关节位置信息符合所述关节限位。第二方面，本申请还提供了一种穿刺方位解算装置。所述装置包括：运动约束模块，用于获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系；环境约束模块，用于获取目标对象的影像数据，根据所述影像数据确定待处理目标的环境约束关系，所述环境约束关系基于所述影像数据中的非相关目标确定；方位向量模块，用于基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系；逆向求解模块，用于根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息，所述轨迹规划信息用于控制所述执行设备在所述穿刺方位向量上执行穿刺。在其中一个实施例中，所述方位向量模块包括：约束向量模块，用于基于所述运动约束关系以及所述环境约束关系，得到与所述非相关目标距离最大化的所述执行设备的穿刺方位向量，所述穿刺方位向量包括约束向量，所述约束向量如下式所示：式中，和q均为关节位置信息，/＞为对应于环境约束关系的第一代价函数，所述第一代价函数还表示所述穿刺方位向量与所述非相关目标距离最大化的距离约束关系，/＞为对应于运动约束关系的第二代价函数。在其中一个实施例中，所述方位向量模块包括：权重系数模块，用于获取对所述第一代价函数的第一权重系数，以及对所述第二代价函数的第二权重系数，基于所述第一权重系数以及所述第二权重系数确定所述约束向量，所述约束向量如下式所示：式中，为所述第一代价函数的第一权重系数，/＞为所述第二代价函数的第二权重系数。在其中一个实施例中，所述运动约束模块包括：数字结构模型模块，用于基于所述结构参数构建用于描述所述执行设备运动规律的数字结构模型，所述数字结构模型包括主动关节、被动关节以及末端执行器；运动仿真模块，用于根据所述数字结构模型对所述末端执行器的运动轨迹进行仿真模拟，得到所述运动约束关系，所述运动约束关系为所述执行设备的关节位置与末端位置的约束关系，如下式所示：式中，为所述末端位置信息，/＞为穿刺方向的旋转矩阵，/＞为所述数字结构模型中的关节位置信息。在其中一个实施例中，所述逆向求解模块包括：约束关系模块，用于基于对所述结构约束关系的微分处理，得到所述执行设备的微分运动约束关系，所述微分运动约束关系为所述执行设备的期望运动参数与关节运动参数的约束关系，如下式所示：式中，v为所述执行设备的末端速度向量，为根据所述执行设备的所述主动关节位置确定的雅克比矩阵，为所述执行设备的所述主动关节速度向量；积分求解模块，用于在得到所述主动关节速度向量之后，对所述微分运动约束关系进行积分处理，得到所述关节运动参数。在其中一个实施例中，所述逆向求解模块包括：关节限位模块，用于若通过所述逆向运动求解得到所述关节位置信息超过了所述数字结构模型的关节限位，则缩小所述运动约束关系以及所述环境约束关系对应的约束空间，直至所述关节位置信息符合所述关节限位。第三方面，本申请还提供了一种穿刺作业执行系统，所述系统包括：图像处理模块，用于接收并处理目标对象的影像数据；穿刺控制模块，用于接收所述目标对象的影像数据，并根据如第一方面中任意一项实施例所述的一种穿刺方位解算方法生成并输出轨迹规划信息；执行设备模块，用于接收所述轨迹规划信息，并根据所述轨迹规划信息指示的穿刺路径完成穿刺作业。第四方面，本申请还提供了一种计算机设备。所述计算机设备包括存储器和处理器，所述存储器存储有计算机程序，所述处理器执行所述计算机程序时实现如第一方面中任意一项实施例所述的一种穿刺方位解算方法中的步骤。第五方面，本申请还提供了一种计算机可读存储介质。所述计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现如第一方面中任意一项实施例所述的一种穿刺方位解算方法中的步骤。第六方面，本申请还提供了一种计算机程序产品。所述计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现如第一方面中任意一项实施例所述的一种穿刺方位解算方法中的步骤。上述一种穿刺方位解算方法、装置、计算机设备、存储介质和计算机程序产品，通过独权中的技术特征进行推导，能够达到对应背景技术中的技术问题的如下有益效果：在进行穿刺方位控制时，根据执行设备的结构参数构建数字结构模型，从而有助于通过数字结构模型对执行设备的运动范围进行计算，得到运动约束关系。随后，获取目标对象的影像数据，通过对影像数据的识别分析确定目标位置信息以及非相关目标的位置，从而得以根据非相关目标的位置信息确定环境约束关系，通过环境约束关系对穿刺方位的约束，有助于降低在穿刺中穿刺针对对象的非相关的器官造成接触的可能性。最终以环境约束关系以及运动约束关系进行限制，得到穿刺方位向量，并在穿刺方位向量中设置穿刺方位与肺血管目标的距离约束关系，进而由目标位置信息逆向运动求解得到轨迹规划信息，最终利用轨迹规划信息控制执行设备的穿刺方位，此时得到的穿刺方位不仅能够规避血管脏器等障碍，还可以与其保持距离最大化的特征，同时能够满足穿刺机器人的运动范围。在实施中，通过影像数据以及执行设备的结构参数对穿刺方位进行多维度地约束，并由目标位置结合数字结构模型进行逆向求解，从而得到最终的轨迹规划信息，有助于使得轨迹规划信息一方面符合执行设备的运动规律、另一方面符合目标对象的影像数据，在保证轨迹规划信息可行性的同时，降低了对目标对象造成非预期的损伤的可能性，从而提高了穿刺设备的控制精确度以及安全性。附图说明图1为一个实施例中一种穿刺作业执行系统的系统架构示意图；图2为一个实施例中一种穿刺方位解算方法的第一流程示意图；图3为一个实施例中环境约束关系的模型示意图；图4为一个实施例中穿刺方位向量的算法原理图；图5为另一个实施例中一种穿刺方位解算方法的第二流程示意图；图6为另一个实施例中一种穿刺方位解算方法的第三流程示意图；图7为另一个实施例中一种穿刺方位解算方法的第四流程示意图；图8为一个实施例中执行设备的数字结构模型示意图；图9为另一个实施例中一种穿刺方位解算方法的第五流程示意图；图10为一个实施例中逆向运行学求解的算法原理示意图；图11为另一个实施例中一种穿刺方位解算方法的第六流程示意图；图12为一个实施例中一种穿刺方位解算装置的结构框图；图13为一个实施例中计算机设备的内部结构图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。相关技术中，随着现代工业技术的发展，已经出现了能够辅助医师进行穿刺处理的机器人，通过机器人的辅助效果，提高穿刺手术的流程完成效率，并降低在手术过程中医职人员的介入时间，从而在保证手术效果的基础上降低对医职人员的伤害。然而，目前的应用穿刺机器人辅助实现穿刺手术的方法，存在如下的技术问题：穿刺机器人所需要执行的穿刺定位的对象存在个体差异性较强的特征，常规的运动控制算法倾向于确定穿刺方位的范围，难以给出具体的优选穿刺方案。基于此，本申请实施例提供了一种穿刺方位解算方法。本申请实施例提供的一种穿刺方位解算方法，可以应用于如图1所示的应用环境中。一种穿刺作业执行系统中。示例性地，穿刺作业执行系统可以包括图像处理模块102、穿刺控制模块104以及执行设备模块106，其中：图像处理模块102可以用于接收并处理目标对象的影像数据。具体地，图像处理模块102可以接收CT图像，并实现对CT图像的处理功能，从而完成CT图像到穿刺机器人坐标系的空间转换。穿刺控制模块104可以用于接收目标对象的影像数据，并根据对影像数据的分析结构生成并输出轨迹规划信息。具体地，穿刺控制模块104可以包括穿刺方位限制求解器模块、穿刺机器人数字结构模型模块以及轨迹规划模块。其中：穿刺机器人数字结构模型模块主要功能为建立穿刺机器人运动学模型，从而根据穿刺机器人的正逆运动学，根据实际需求对运动控制参数进行求解。穿刺方位限制求解器模块可以根据穿刺机器人运动学模型，结合接收到的CT图像，应用实施例中公开的穿刺方位控制方法实现基于目标病灶位置的穿刺方位限制。轨迹规划模块可以在穿刺手术的实施过程中，根据预先接收的轨迹规划信息，在关节空间或笛卡尔空间中规划穿刺机器人各关节的运动轨迹，实现穿刺机器人的驱动。执行设备模块106可以用于接收轨迹规划信息，并根据轨迹规划信息指示的穿刺路径完成穿刺作业。具体地，执行设备模块106可以包括穿刺机器人结构主体、驱动模块、反馈模块以及对象固定装置，其中：穿刺机器人结构主体可以包括串并联混合型机器人，其包括的自由度数量可以根据实际的穿刺手术需求设定。在本实施例中，可以以穿刺机器人结构主体具有五个自由度为例进行说明，其他情况与之类似不做赘述。示例性地，穿刺机器人结构主体的五个自由度中，可以包括两个主要控制穿刺机器人的穿刺针末端位置的自由度，也即移动关节，还可以包括两个主要控制穿刺机器人穿刺方位的自由度，也即方向调节关节，还可以包括主要控制穿刺机器人的穿刺针入针与退针的自由度，也即穿刺关节。此外，除了能够通过驱动模块进行控制的主动关节，还可以包括由于结构之间的关联、约束关系，被动跟随主动关节运动的被动关节。本实施例中五个自由度均可以具有单向解耦的特性，具体可以表现为控制穿刺机器人的穿刺针末端位置以及穿刺针入针、退针的三个自由度不影响穿刺方向，但是控制穿刺方向的两个自由度会小范围影响穿刺针末端位置。驱动模块可以用于控制穿刺机器人结构主体的运动，可以包括伺服电机以及伺服驱动器，驱动模块可以安装于穿刺机器人结构主体的五个自由度的主动关节位置处，从而接收并执行运动控制指令，驱动穿刺机器人各主动关节运动。反馈模块可以为位置传感器，能够实时测量并反馈上述五个主动关节的位置。对象固定装置可以用于将穿刺机器人进行固定，以使穿刺机器人与手术对象之前保持相对稳定的位置关系。在一个实施例中，如图2所示，提供了一种穿刺方位解算方法，以该方法应用于图1中的穿刺控制模块为例进行说明，包括以下步骤：步骤202：获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系。其中，执行设备可以指用于执行穿刺作业的装置，可以为穿刺机器人。结构参数可以指用于描述执行设备的结构信息的参数，结构参数可以包括执行设备的关节数量、关节尺寸、关节运动范围等。运动约束关系可以指执行设备的运动范围以及在运动中不同关节之前的约束情况。示例性地，穿刺控制模块可以在获取充分的授权和许可的前提下，获取执行设备的结构参数，并根据对结构参数的建模运算，得到执行设备的运动约束关系。步骤204：获取目标对象的影像数据，根据所述影像数据确定待处理目标的环境约束关系，所述环境约束关系基于所述影像数据中的非相关目标确定。其中，影像数据可以指对目标对象通过不同的成像技术获取的对象内部构造和功能信息的医学诊断工具，可以显示出对象的身体构造、生理功能和病变情况。影像数据可以包括器官信息、血管信息、组织信息、骨骼信息以及病灶信息等。环境约束关系可以指用于根据影像数据对穿刺方向进行约束的条件。非相关目标可以指病灶位置以外的器官、血管等对象。示例性地，穿刺控制模块可以获取图像处理模块对目标对象扫描成像得到的影像数据，从而根据影像数据确定待处理目标的目标位置信息以及非相关目标的位置信息。其中，待处理目标可以指在本实施例中需要进行穿刺处理的病灶区域。这样，可以如图3所示，穿刺控制模块可以根据影像数据确定在穿刺方位控制中的环境约束关系。环境约束关系可以如图所示，其中可以包括待处理目标302、非相关目标中的非相关器官304以及非相关血管306。步骤206：基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系。其中，距离约束关系可以指穿刺方位对应的穿刺方位向量与非相关目标之间的距离关系，例如距离最大化、距离最小化等。示例性地，在获取环境约束关系以及运动约束关系后，此时穿刺控制模块掌握了执行设备可以实施穿刺的约束空间以及执行设备自身能够支持的运动维度的约束空间。可以如图3所示，运动约束关系可以指向图3中的运动约束空间308。在此基础上，为了避免穿刺手术中对对象的其他器官、血管等非相关目标造成伤害，可以根据环境约束关系对运动约束关系进行进一步限制，从而约束空间由308缩减至约束空间为3010的穿刺控制约束关系。此时，在得到的穿刺控制约束关系以任意角度，例如3012进行穿刺针的入针，都能一方面满足执行设备的运行性能，一方面避免损伤目标对象的非相关器官304以及非相关血管306。在此基础上，穿刺方位向量还需要满足与非相关目标的距离约束关系。步骤208：根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息，所述轨迹规划信息用于控制所述执行设备在所述穿刺方位向量上执行穿刺。其中，逆向运动求解可以指根据目标位置或执行设备的期望位置，反向计算出穿刺执行设备或物体的关节角度或关节位置的过程。轨迹规划信息可以指用于进行执行设备的穿刺方位控制的信息。示例性地，穿刺控制模块可以通过逆向运动求解，解算出执行设备在运动中连续的关节控制、角度控制等的驱动指令，从而生成轨迹规划信息。具体地，可以选确定穿刺方位向量对应的穿刺方向的旋转矩阵。旋转矩阵可以指用于描述二维或三维空间中物体旋转的数学工具。它是一个正交矩阵，表示了一个向量绕某个轴旋转一定角度的变换。在二维空间中，旋转矩阵可以表示为：式中，θ表示旋转角度，cosθ和sinθ分别是旋转角度的余弦和正弦。在三维空间中，旋转矩阵可以表示为：式中，θ表示旋转角度，cosθ和sinθ分别是旋转角度的余弦和正弦。穿刺控制模块可以通过穿刺方位向量确定所述末端执行器的穿刺方向的旋转矩阵。具体地，可以设定穿刺方向的旋转矩阵如下式所示：其中，/＞，/＞为旋转矩阵的方向向量。此时，穿刺方位向量与关节运动参数的逆向求解中，可以根据末端执行器的末端位置信息以及旋转矩阵通过逆向运动求解得到执行设备的关节关节运动参数，逆向运动求解的约束方程可以如下式所示：式中，为所述末端位置信息，/＞为穿刺方向的旋转矩阵，/＞为所述数字结构模型中的关节位置信息。进一步地，穿刺控制模块在确定目标位置信息以及结构参数后，可以形成穿刺方位约束模型。具体地，穿刺方位约束模型可以如图4所示，可以以待处理对象为模型的顶点，同时作为空间坐标系的原点。穿刺方位约束模型可以精简为圆锥体。需要注意地，穿刺机器人的工作范围并非为严格的圆形，而是与穿刺机器人结构主体的参数设定相关，因此穿刺方位约束模型也不会是一个严格标准的圆锥体，本实施例中为便于算法分析，精简为圆锥体，以便于理解。此时，可以根据穿刺方位约束模型对穿刺方向的旋转矩阵的方向向量进行求解，得到旋转矩阵，旋转矩阵可以如下式所示：其中，/＞，/＞为旋转矩阵的方向向量。示例性地，当得到如图4所示的穿刺方位约束模型时，在穿刺方位约束模型408中，圆锥角θ是一个重要的已知参数，它能够直接设定穿刺机器人穿刺方位的极限值，圆锥角θ与执行设备的结构参数相关，不同的结构参数会得到不同的圆锥角θ。在算法推理中，可以在穿刺方位约束模型的底面圆902中，将底面圆902平均分成若干等分，以分得的每个块作为采样点。本实施例中可以以将该底面圆902均分为3600等分，此时该底面圆902上所有采样点的坐标均可以如下式所示：式中，，，i=1,2,…3600。此时，可以进一步得到穿刺方向的旋转矩阵中的方向向量/＞，可以如下式所示：由于穿刺机器人结构主体的运动约束关系，穿刺机器人的穿刺方向可以分解为绕固定轴X旋转α角度，再绕固定轴Y旋转β角度，因此穿刺方向的旋转矩阵可以如下式所示：在得到方向向量后，通过反三角函数便可以得到和的值，同时也得到了穿刺方向的旋转矩阵。此时，已知了目标病灶位置，即穿刺针末端Pt的位置，以及穿刺方向的旋转矩阵后，利用穿刺机器人的数字结构模型中的逆向运动学便能够计算得到穿刺机器人各主动关节位置。在穿刺方位约束模型408中的直角三角形904上，可以将圆锥角θ均分为若干等分，为了获取足够的分辨率以及精确性，本实施例中可以将圆锥角θ均分为450等分，此时每个均分的圆锥角对应的射线都会在直角三角形904位于底面圆902内的直角边相交，相交点906也同样为450个，相应的底面圆902平面上相交点的坐标可以如下式所示：式中，，，j=1,2,…450。在遍历推算中，j的取值不断增加，直到根据穿刺方位利用穿刺机器人的数字结构模型的逆向运动学计算得到的各主动关节位置均在其关节限位内。当遍历完所有i的取值后，便能得到如图4所示新的穿刺方位约束3012。最终，在遍历求解的过程中，可以施加距离约束关系，对求解结果进行筛选，从而选取得到最终采用的穿刺方位向量，从而进一步得到对应的轨迹规划信息。上述一种穿刺方位解算方法中，结合实施例中的技术特征进行合理推导，能够实现解决背景技术中所提出的技术问题的如下有益效果：在进行穿刺方位控制时，根据执行设备的结构参数构建数字结构模型，从而有助于通过数字结构模型对执行设备的运动范围进行计算，得到运动约束关系。随后，获取目标对象的影像数据，通过对影像数据的识别分析确定目标位置信息以及非相关目标的位置，从而得以根据非相关目标的位置信息确定环境约束关系，通过环境约束关系对穿刺方位的约束，有助于降低在穿刺中穿刺针对对象的非相关的器官造成接触的可能性。最终以环境约束关系以及运动约束关系进行限制，得到穿刺方位向量，并在穿刺方位向量中设置穿刺方位与肺血管目标的距离约束关系，进而由目标位置信息逆向运动求解得到轨迹规划信息，最终利用轨迹规划信息控制执行设备的穿刺方位，此时得到的穿刺方位不仅能够规避血管脏器等障碍，还可以与其保持距离最大化的特征，同时能够满足穿刺机器人的运动范围。在实施中，通过影像数据以及执行设备的结构参数对穿刺方位进行多维度地约束，并由目标位置结合数字结构模型进行逆向求解，从而得到最终的轨迹规划信息，有助于使得轨迹规划信息一方面符合执行设备的运动规律、另一方面符合目标对象的影像数据，在保证轨迹规划信息可行性的同时，降低了对目标对象造成非预期的损伤的可能性，从而提高了穿刺设备的控制精确度以及安全性。在一个实施例中，可以如图5所示，步骤206包括：步骤502：基于所述运动约束关系以及所述环境约束关系，得到与所述非相关目标距离最大化的所述执行设备的穿刺方位向量。其中，穿刺方位向量可以包括约束向量。示例性地，约束向量可以为笛卡尔空间坐标系中的五维向量，所述约束向量可以如下式所示：式中，为第一旋转关节与第二旋转关节位置，q为其他主动关节位置信息，为对应于环境约束关系的第一代价函数，所述第一代价函数还表示所述穿刺方位向量与所述非相关目标距离最大化的距离约束关系，/＞为对应于运动约束关系的第二代价函数。具体地，约束向量可以由两部分组成，一部分为保证优选穿刺方位不会经过脏器304以及血管306，另一部分为保证优选穿刺方位被约束在运动约束关系内，同时优选穿刺方位能够保持预设的距离约束关系，即位于与脏器304以及血管306的距离最大化的方位上。示例性地，第一代价函数为表示穿刺机器人的第一旋转关节与第二旋转关节位置与设定值之间的距离，其中设定值与结构参数相关，是已知量，因此一般情况下可以表示为穿刺方位竖直方向上平行于Z轴时第一旋转关节与第二旋转关节位置。因此可以表示为：式中，表示第一旋转关节或第二旋转关机的位置值，i=3时表示第一旋转关节，i=4时表示第二旋转关节，/＞表示穿刺方位竖直向上平行于Z轴时对应的旋转关节位置，/＞表示关节位置最大值，/＞表示关节位置最小值。通过最大化距离，可以使得关节变量尽可能接近设定值/＞。示例性地，第二代价函数为表示运动约束关系的代价函数，第二代价函数可以表示为：式中，o为障碍物上某个适当点的位置向量，而p为末端执行器方位向量。通过最大化距离，可以避免穿刺方位与障碍物碰撞。本实施例中，对穿刺方位向量的组成元素进行限定，并具体公开了穿刺方位向量的计算中，存在约束向量，有助于进一步提高穿刺方位计算的准确度。在一个实施例中，可以如图6所示，步骤206包括：步骤602：获取对所述第一代价函数的第一权重系数，以及对所述第二代价函数的第二权重系数，基于所述第一权重系数以及所述第二权重系数确定所述约束向量。示例性地，约束向量可以如下式所示：式中，为所述第一代价函数的第一权重系数，/＞为所述第二代价函数的第二权重系数。一般情况下，两者可以取相等的正整数，例如/＞=/＞=1。若有其他策略上的需求，例如为保证穿刺过程的安全性，需要保证穿刺方位离障碍物的距离越远越好，那么则需要增加该权重系数，如/＞=5，/＞=1。本实施例中，在约束向量的设定中，增加权重因素，从而得以根据实际的手术需求进行方位计算，能够提高穿刺方位计算的灵活性。在一个实施例中，可以如图7所示，步骤202包括：步骤702：基于所述结构参数确定所述执行设备的数字结构模型，所述数字结构模型包括主动关节、被动关节以及末端执行器。其中，主动关节可以指能够通过驱动模块进行控制的关节，被动关节可以指由于结构之间的关联、约束关系，被动跟随主动关节运动的关节，末端执行器可以指执行设备中用于进行穿刺的穿刺针等部分。示例性地，可以如图8所示，穿刺控制模块可以基于结构参数确定执行设备的数字结构模型，数字结构模型可以包括主动关节、被动关节以及末端执行器。在本实施例中，可以以执行设备具有五个自由度为例进行说明，穿刺机器人结构主体的五个自由度中，可以包括两个主要控制穿刺机器人的穿刺针末端位置的自由度，也即移动关节，还可以包括两个主要控制穿刺机器人穿刺方位的自由度，也即方向调节关节，还可以包括主要控制穿刺机器人的穿刺针入针与退针的自由度，也即穿刺关节。这样，可以得到如图8所示的数字结构模型，数字结构模型可以抽象为包括五个主动关节和八个被动关节的串并联混合结构的连杆模型，主动关节可以分别为第一平移关节Z1、第二平移关节Z2、第一旋转关节Z3、第二旋转关节Z4以及穿刺关节Z5，八个被动关节分别为B1、B2、B3、B4、B5、B6、B7、B8。在本实施例的数字结构模型中，第一旋转关节Z3、第二旋转关节Z4和被动旋转关节B1、B2、B3构成了一个经典的平面自由度并联五连杆模型802，该模型与被动旋转关节B4、B5、B6、B7以及被动移动关节B8共同构成了穿刺机器人姿态调节机构804。第一移动关节Z1、第二移动关节Z2、姿态调节机构804与穿刺关节Z5共同组成了数字结构模型。数字结构模型中，可以通过箭头等方向性标识表示该关节的正向运动方向，例如第一移动关节Z1的正向运动方向平行于X轴；被动旋转关节B5的正向运动方向平行于Y轴等。数字结构模型中，由于被动关节B4、B5、B6、B7、B8的结构约束，线段P5P6平行于Y轴，点P5、点P6、点P0、点P7、点P8、点P9和点Pt在同一平面内，线段P7Pv垂直于线段P8P9且Pv为交点，线段P7Pv为结构参数，因此长度已知且固定不变，Pt为穿刺针末端位置。步骤704：根据所述数字结构模型对所述末端执行器的运动轨迹进行仿真模拟，得到所述运动约束关系。其中，所述运动约束关系为所述执行设备的关节位置与末端位置的约束关系。示例性地，穿刺控制模块可以根据数字结构模型对末端执行器的运动轨迹进行仿真模拟，从而得到运动约束关系。具体地，以如图8所述的数字结构模型为例，在平面两自由度并联五连杆模型中，连杆P1P3长度为l13，连杆P2P4长度为l24，连杆P3P5长度为l35，连杆P4P5长度为l45。为了保证平面两自由度并联五连杆模型802的工作空间关节在Y轴对称，可以设定l13和l24，相等均为r1，l35和l45相等均为r2，线段P1P2长度的一半为r3。仅考虑XOY平面，可以假设P5的坐标为，而P3和P4的坐标能够用第一旋转关节Z3和第二旋转关节Z4的值来表示，可以如下式所示：式中，q3和q4分别为第一旋转关节Z3和第二旋转关节Z4的关节位置值。这样，平面两自由度并联五连杆模型802内存在如下的运动约束关系，由于连杆P3P5和连杆P4P5的长度已知且固定，可以如下式所示：因此，当已知q3和q4时，便能够通过上述约束方程求解得到P5的坐标，即平面两自由度并联五连杆模型602的正向运动学；当已知P5的坐标时，也能通过上述约束方程求解得到q3和q4的值，即平面两自由度并联五连杆模型602的逆向运动学。本实施例中，通过数字结构模型以及设备参数中的已知条件，可以形成正向运动学或逆向运动学的推算框架，从而得到运动约束关系的计算，有助于提高穿刺方位控制的精确度和稳定性。在一个实施例中，可以如图9所示，步骤208包括：步骤902：基于对所述结构约束关系的微分处理，得到所述执行设备的微分运动约束关系。其中，微分运动约束关系为所述执行设备的期望运动参数与关节运动参数的约束关系，在得到结构约束关系可以如下式：在上式的前提下。经过对等式两侧的微分处理，微分运动约束关系可以如下式所示：式中，v为所述执行设备的末端速度向量，为根据所述执行设备的所述主动关节位置确定的雅克比矩阵，为所述执行设备的所述主动关节速度向量。其中，雅可比矩阵是一个将一个向量值函数的导数向量化的矩阵。它描述了一个向量函数在某一点的局部线性近似。设有一个向量值函数f：Rn-＞Rm，其中x是一个n维向量，f是一个m维向量。那么雅可比矩阵J是一个m×n的矩阵，其元素由函数的偏导数组成。雅可比矩阵的第i行第j列的元素表示函数f的第i个输出分量对于第j个输入分量的偏导数。换句话说，雅可比矩阵的每一行都是函数的梯度向量。在本实施例中，向量v可以表示穿刺机器人的线速度和角速度，是六维向量，表示穿刺机器人的雅克比矩阵，则是一个6x5的矩阵，由穿刺机器人各主动关节位置决定，是穿刺机器人各主动关节速度，是五维向量。这样便建立了穿刺机器人笛卡尔空间速度与关节速度之间的映射。在一个具体实施例中，在求解过程中，求解算法流程可以如图10所示，该算法的输入数据是穿刺针5末端期望位置和期望线速度，两者都是三维向量，所述穿刺针5末端期望位置和期望线速度由轨迹规划模块规划的轨迹定义。为穿刺针5末端实际位置，也是三维向量，可由穿刺机器人数学模型中的正向运动学求解得到，穿刺针5末端期望位置与穿刺针5末端实际位置为穿刺针5末端的位置误差e，与误差增益K的乘积加上穿刺针5末端期望线速度为指令线速度，此时穿刺机器人主动关节速度可由下式求解得到：这样，能够通过求解，得到穿刺机器人关节运动参数中的主动关节速度。步骤904：在得到所述主动关节速度向量之后，对所述微分运动约束关系进行积分处理，得到所述关节运动参数。示例性地，在得到主动关节速度之后，可以通过积分将速度参数处理为位置参数，从而得到穿刺机器人各主动关节位置q。具体地，穿刺机器人主动关节速度求解的公式中，为雅克比矩阵的伪逆，与雅克比矩阵的关系为：本实施例中，通过微分处理得到运动学关系，在计算后再通过反向的积分运算，就可以得到关节运动参数，有助于提高关节运动参数计算的精确度。在一个实施例中，可以如图11所示，步骤208包括：步骤1102：若通过所述逆向运动求解得到所述关节位置信息超过了所述数字结构模型的关节限位，则缩小所述运动约束关系以及所述环境约束关系对应的约束空间，直至所述关节位置信息符合所述关节限位。示例性地，若通过所述逆向运动求解得到所述关节位置信息超过了所述数字结构模型的关节限位，则缩小所述运动约束关系以及所述环境约束关系对应的约束空间，直至所述关节位置信息符合所述关节限位。本实施例中，通过缩小约束空间克服关节限位与求解结果的冲突，有助于提高穿刺方位控制的稳定性。应该理解的是，虽然如上所述的各实施例所涉及的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，如上所述的各实施例所涉及的流程图中的至少一部分步骤可以包括多个步骤或者多个阶段，这些步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤中的步骤或者阶段的至少一部分轮流或者交替地执行。基于同样的发明构思，本申请实施例还提供了一种用于实现上述所涉及的一种穿刺方位解算方法的一种穿刺方位解算装置。该装置所提供的解决问题的实现方案与上述方法中所记载的实现方案相似，故下面所提供的一个或多个一种穿刺方位解算装置实施例中的具体限定可以参见上文中对于一种穿刺方位解算方法的限定，在此不再赘述。在一个实施例中，如图12所示，提供了一种穿刺方位解算装置，包括：运动约束模块、环境约束模块、方位向量模块和逆向求解模块，其中：运动约束模块，用于获取执行设备的结构参数，根据所述结构参数得到所述执行设备的运动约束关系；环境约束模块，用于获取目标对象的影像数据，根据所述影像数据确定待处理目标的环境约束关系，所述环境约束关系基于所述影像数据中的非相关目标确定；方位向量模块，用于基于所述运动约束关系以及所述环境约束关系得到所述执行设备的穿刺方位向量，所述穿刺方位向量还包括与所述非相关目标的距离约束关系；逆向求解模块，用于根据所述穿刺方位向量以及所述运动约束关系对关节运动参数进行逆向运动求解，得到轨迹规划信息，所述轨迹规划信息用于控制所述执行设备在所述穿刺方位向量上执行穿刺。在其中一个实施例中，所述方位向量模块包括：约束向量模块，用于基于所述运动约束关系以及所述环境约束关系，得到与所述非相关目标距离最大化的所述执行设备的穿刺方位向量，所述穿刺方位向量包括约束向量，所述约束向量如下式所示：式中，和q均为关节位置信息，/＞为对应于环境约束关系的第一代价函数，所述第一代价函数还表示所述穿刺方位向量与所述非相关目标距离最大化的距离约束关系，/＞为对应于运动约束关系的第二代价函数。在其中一个实施例中，所述方位向量模块包括：权重系数模块，用于获取对所述第一代价函数的第一权重系数，以及对所述第二代价函数的第二权重系数，基于所述第一权重系数以及所述第二权重系数确定所述约束向量，所述约束向量如下式所示：式中，为所述第一代价函数的第一权重系数，/＞为所述第二代价函数的第二权重系数。在其中一个实施例中，所述运动约束模块包括：数字结构模型模块，用于基于所述结构参数构建用于描述所述执行设备运动规律的数字结构模型，所述数字结构模型包括主动关节、被动关节以及末端执行器；运动仿真模块，用于根据所述数字结构模型对所述末端执行器的运动轨迹进行仿真模拟，得到所述运动约束关系，所述运动约束关系为所述执行设备的关节位置与末端位置的约束关系，如下式所示：式中，为所述末端位置信息，/＞为穿刺方向的旋转矩阵，/＞为所述数字结构模型中的关节位置信息。在其中一个实施例中，所述逆向求解模块包括：约束关系模块，用于基于对所述结构约束关系的微分处理，得到所述执行设备的微分运动约束关系，所述微分运动约束关系为所述执行设备的期望运动参数与关节运动参数的约束关系，如下式所示：式中，v为所述执行设备的末端速度向量，为根据所述执行设备的所述主动关节位置确定的雅克比矩阵，为所述执行设备的所述主动关节速度向量；积分求解模块，用于在得到所述主动关节速度向量之后，对所述微分运动约束关系进行积分处理，得到所述关节运动参数。在其中一个实施例中，所述逆向求解模块包括：关节限位模块，用于若通过所述逆向运动求解得到所述关节位置信息超过了所述数字结构模型的关节限位，则缩小所述运动约束关系以及所述环境约束关系对应的约束空间，直至所述关节位置信息符合所述关节限位。上述一种穿刺方位解算装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。在一个实施例中，提供了一种计算机设备，该计算机设备可以是终端，其内部结构图可以如图13所示。该计算机设备包括处理器、存储器、输入/输出接口、通信接口、显示单元和输入装置。其中，处理器、存储器和输入/输出接口通过系统总线连接，通信接口、显示单元和输入装置通过输入/输出接口连接到系统总线。其中，该计算机设备的处理器用于提供计算和控制能力。该计算机设备的存储器包括非易失性存储介质和内存储器。该非易失性存储介质存储有操作系统和计算机程序。该内存储器为非易失性存储介质中的操作系统和计算机程序的运行提供环境。该计算机设备的输入/输出接口用于处理器与外部设备之间交换信息。该计算机设备的通信接口用于与外部的终端进行有线或无线方式的通信，无线方式可通过WIFI、移动蜂窝网络、NFC或其他技术实现。该计算机程序被处理器执行时以实现一种穿刺方位解算方法。该计算机设备的显示单元用于形成视觉可见的画面，可以是显示屏、投影装置或虚拟现实成像装置。显示屏可以是液晶显示屏或者电子墨水显示屏，该计算机设备的输入装置可以是显示屏上覆盖的触摸层，也可以是计算机设备外壳上设置的按键、轨迹球或触控板，还可以是外接的键盘、触控板或鼠标等。本领域技术人员可以理解，图13中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备的限定，具体的计算机设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。在一个实施例中，还提供了一种计算机设备，包括存储器和处理器，存储器中存储有计算机程序，该处理器执行计算机程序时实现上述各方法实施例中的步骤。在一个实施例中，提供了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现上述各方法实施例中的步骤。在一个实施例中，提供了一种计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现上述各方法实施例中的步骤。需要说明的是，本申请所涉及的用户信息和数据，均为经用户授权或者经过各方充分授权的信息和数据，且相关数据的收集、使用和处理需要遵守相关国家和地区的相关法律法规和标准。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一非易失性计算机可读取存储介质中，该计算机程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、数据库或其它介质的任何引用，均可包括非易失性和易失性存储器中的至少一种。非易失性存储器可包括只读存储器、磁带、软盘、闪存、光存储器、高密度嵌入式非易失性存储器、阻变存储器、磁变存储器、铁电存储器、相变存储器、石墨烯存储器等。易失性存储器可包括随机存取存储器或外部高速缓冲存储器等。作为说明而非局限，RAM可以是多种形式，比如静态随机存取存储器或动态随机存取存储器等。本申请所提供的各实施例中所涉及的数据库可包括关系型数据库和非关系型数据库中至少一种。非关系型数据库可包括基于区块链的分布式数据库等，不限于此。本申请所提供的各实施例中所涉及的处理器可为通用处理器、中央处理器、图形处理器、数字信号处理器、可编程逻辑器、基于量子计算的数据处理逻辑器等，不限于此。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对本申请专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请的保护范围应以所附权利要求为准。
