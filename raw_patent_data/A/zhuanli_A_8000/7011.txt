标题title
一种基于奇异值分解滤波的超声矢量流速成像方法及系统
摘要abst
本发明公开一种基于奇异值分解滤波的超声矢量流速成像方法及系统，可用于微血管流速检测技术领域。本发明先采集目标区域的微血管超声造影动态图像，对每帧超声图像进行奇异值分解滤波处理，再对处理后的超声造影图像进行矢量流速成像处理，利用造影微泡对超声具有强烈反射这一特性，采集奇异值分解滤波处理后的造影数据集连续两帧的超声造影图像，利用互相关算法计算相邻图像之间搜索窗口内的相关气泡信号，获取目标区域内微血管的速度矢量信息。本发明通过将奇异值分解滤波技术、超声矢量流速成像技术结合检测微血管流速，有效解决现有血流检测技术因成像深度无法对深部微血管进行准确检测、对深部微血管检测质量差等问题。
权利要求书clms
1.一种基于奇异值分解滤波的超声矢量流速成像方法，可用于检测微血管流速，其特征在于：包括以下过程，对于目标区域的微血管进行超声检测，采集目标区域的微血管超声造影动态图像；对每帧超声图像进行奇异值分解滤波处理；将进行奇异值分解滤波处理后的超声造影图像进行矢量流速成像处理，利用造影微泡对超声具有强烈反射这一特性，采集奇异值分解滤波处理后的造影数据集连续两帧的超声造影图像，利用互相关算法计算相邻图像之间搜索窗口内的最佳相关气泡信号，获取目标区域内微血管的速度矢量信息。2.根据权利要求1所述的一种基于奇异值分解滤波的超声矢量流速成像方法，其特征在于：对每帧图像进行奇异值分解滤波处理包括以下过程：第一步，选取已采集的超声造影原始数据中不受呼吸运动干扰的N帧超声图像；第二步，将造影数据中的时间及空间信息组合以构建Casorati矩阵，并记为S，使每一帧图像变形成矩阵S的一列，矩阵S同时包含空间信息和时间信息，在Casorati矩阵的形成过程中，每一帧超声图像的空间信息被重组成Casorati矩阵的列向量；第三步，对S进行奇异值分解，将S分解成3个矩阵乘积的表示形式，处理公式可表示为S＝UΔV*，其中，U和V是正交矩阵，U为空间奇异向量；V为空间奇异向量所对应的时间向量；Δ为一个奇异值矩阵，*代表转置矩阵；第四步，图像中存在组织信号、噪声信号及微泡信号，选取相对较低的奇异值阈值用以滤除不需要的组织背景信号；选取相对较高的奇异值阈值用以有效的滤除杂乱的背景噪声信号，以此对奇异值阈值进行选取；根据图像对奇异值阈值选取后，将经奇异值分解的3个矩阵重新转化为Casorati矩阵，记为S’；第五步，将S’重组为具有时空信息的造影数据，称为奇异值分解滤波后造影数据；第六步，被进行重新排序为Nz行及Nx列的空间奇异向量被视作1个从数据中提取出的虚拟图片，将所有数据进行求和，得到经奇异值分解滤波处理后的超声造影图像。3.根据权利要求1所述的一种基于奇异值分解滤波的超声矢量流速成像方法，其特征在于：对经过奇异值分解滤波处理后的超声造影图像进行矢量流速成像，包括以下步骤：第一步，选取经奇异值分解滤波处理后的造影数据集中连续两帧的超声图像，在第一帧图像上选取一个大小为n×n像素的参考窗f，由互相关函数：Rfg＝∫f·gdxdy确定第二帧图像搜索区域内与之匹配的同样大小的目标窗的位置，记为g；第二步，对两幅图像进行互相关分析，根据互相关平面上最高峰值的位置得出Δt内微泡的最大位移；第三步，依据U＝ΔX/Δt及V＝ΔY/Δt获得该流场的速度矢量信息；第四步，利用上述步骤对多个造影微泡进行分析，实现整个流场速度信息的检测，得到目标区域的微血管速度矢量信息；其中∫为两个变量的函数积分，U与V为造影微泡沿x、y方向的瞬时速度，ΔX与ΔY分别为造影微泡沿x、y方向的位移；Δt为连续两帧超声图像之间的间隔时间；f、g分别为参考窗及目标窗在位置处的灰度分布函数。4.一种基于奇异值分解滤波检测微血管流速的矢量流速成像系统，其特征在于：包括图像导入模块，将超声诊断仪采集到的微血管超声造影动态图像逐帧导入奇异值分解滤波模块；奇异值分解滤波模块，用于对超声图像序列进行矩阵重置和奇异值分解滤波；矢量流速成像处理模块，采集奇异值分解滤波处理后的造影数据集连续两帧的超声造影图像，利用互相关算法计算相邻图像之间搜索窗口内的最佳相关气泡信号，获取目标区域内微血管的速度矢量信息；结果分析模块，用于分析展示目标区域内微血管的血流方向和血流速度，将结果进行动态播放、数据可视化展示。
说明书desc
技术领域本发明涉及一种基于奇异值分解滤波的超声矢量流速成像方法及系统，可用于微血管流速检测技术领域。背景技术微循环障碍与疾病发生、发展密切相关，其发生可早于病理及血清等相关指标的变化。血流速度作为反映微循环功能的重要参数可为疾病的早期诊断提供依据，因此准确监测微血管流速对临床早期诊断相关疾病至关重要。目前监测血管流速主要采用传统彩色多普勒血流检测技术。传统彩色多普勒血流检测技术对于微血管特别是深部微血管的检测能力存在局限且成像具有角度依赖性。超声矢量流速成像是利用平面波发射的快速超声成像技术，无角度依赖性且可直观地获取感兴趣区域内的血流速度大小及方向信息。但随着成像深度的增加，低信噪比及红细胞检测灵敏度的下降导致深部血管血流速度被低估。奇异值分解是基于已采集数据的图像后处理技术，可根据声学反馈的空间与时间特征分离出微泡造影信号和组织背景信号，通过将获取的图像数据的空间和时间信息放入Casorati矩阵并进行重新组合，从而提高图像的信噪比及对比组织比。因此，基于奇异值分解滤波后处理的超声矢量流速成像可克服传统血流检测技术因图像的低信噪比及红细胞检测灵敏度下降无法对深部微血管进行准确检测的缺点，通过改善矢量流速成像所显示微血管的原始图像质量，有效弥补现有血流速度检测技术对深部微血管血流速度的低估，精准检测微血管流速，为临床早期检测相关疾病提供参考价值。发明内容本发明的目的在于提供一种基于奇异值分解滤波的超声矢量流速成像方法及系统，旨在解决所述背景技术中现有血流检测技术对于微血管特别是深部微血管的检测能力存在局限且成像具有角度依赖性、因成像深度增加无法对深部微血管进行准确检测的问题。为实现所述目的，本发明采用的技术方案是：一种基于奇异值分解滤波的超声矢量流速成像方法，包括以下过程，对于目标区域的微血管进行超声检测，采集目标区域的微血管超声造影动态图像；对每帧超声图像进行奇异值分解滤波处理；将进行奇异值分解滤波处理后的超声造影图像进行矢量流速成像处理，利用造影微泡对超声具有强烈反射这一特性，采集奇异值分解滤波处理后的造影数据集连续两帧的超声造影图像，利用互相关算法计算相邻图像之间搜索窗口内的最佳相关气泡信号，获取目标区域内微血管的速度矢量信息。对前述方案的进一步描述，对每帧图像进行奇异值分解滤波处理包括以下过程：第一步，选取已采集的超声造影原始数据中不受呼吸运动干扰的N帧超声图像；第二步，提取造影数据中的时间及空间信息进行组合以构建Casorati矩阵，并记为S，使每一帧图像变形成矩阵S的一列，矩阵S同时包含空间信息和时间信息，在Casorati矩阵的形成过程中，每一帧超声图像的空间信息被重组成Casorati矩阵的列向量；第三步，对S进行奇异值分解，将S分解成3个矩阵乘积的表示形式，处理公式可表示为S＝UΔV*，其中，U和V是正交矩阵，U为空间奇异向量；V为空间奇异向量所对应的时间向量；Δ为一个奇异值矩阵，*代表转置矩阵；第四步，图像中存在组织信号、噪声信号及微泡信号，选取相对较低的奇异值阈值用以滤除不需要的组织背景信号；选取相对较高的奇异值阈值用以有效的滤除杂乱的背景噪声信号，以此对奇异值阈值进行选取；根据图像对奇异值阈值选取后，将经奇异值分解的3个矩阵重新转化为Casorati矩阵，记为S’；第五步，将S’重组为具有时空信息的造影数据，称为奇异值分解滤波后造影数据；第六步，被进行重新排序为Nz行及Nx列的空间奇异向量被视作1个从数据中提取出的虚拟图片，将所有数据进行求和，得到经奇异值分解滤波处理后的超声造影图像。对前述方案的进一步描述，对经过奇异值分解滤波处理后的超声造影图像进行矢量流速成像，包括以下步骤：第一步，选取经奇异值分解滤波处理后的造影数据集中连续两帧的超声图像，在第一帧图像上选取一个大小为n×n像素的参考窗f，由互相关函数：Rfg＝∫f·gdxdy确定第二帧图像搜索区域内与之匹配的同样大小的目标窗的位置，记为g；第二步，对两幅图像进行互相关分析，根据互相关平面上最高峰值的位置得出Δt内微泡的最大位移；第三步，依据U＝ΔX/Δt及V＝ΔY/Δt获得该流场的速度矢量信息；第四步，利用上述步骤对多个造影微泡进行分析，实现整个流场速度信息的检测，得到目标区域的微血管速度矢量信息；其中∫为两个变量的函数积分，U与V为造影微泡沿x、y方向的瞬时速度，ΔX与ΔY分别为造影微泡沿x、y方向的位移；Δt为连续两帧超声图像之间的间隔时间；f、g分别为参考窗及目标窗在位置处的灰度分布函数。本发明还提供一种基于奇异值分解滤波的超声矢量流速成像系统，包括图像导入模块，将超声诊断仪采集到的微血管超声造影动态图像逐帧导入奇异值分解滤波模块；奇异值分解滤波模块，用于对超声图像序列进行矩阵重置和奇异值分解滤波；矢量流速成像处理模块，采集奇异值分解滤波处理后的造影数据集连续两帧的超声造影图像，利用互相关算法计算相邻图像之间搜索窗口内的最佳相关气泡信号，获取目标区域内微血管的速度矢量信息；结果分析模块，用于分析展示目标区域内微血管的血流方向和血流速度，将结果进行动态播放、数据可视化展示。与现有技术相比，本发明有以下有益效果：本发明通过将奇异值分解滤波技术、超声矢量流速成像技术结合用于检测微血管流速，有效解决现有血流技术因成像深度增加无法对深部微血管进行准确检测的问题，利用奇异值分解滤波改善矢量流速成像的原始图像质量，提升传统矢量流速成像对深部微血管检测的价值，有效弥补现有血流速度检测技术对深部微血管血流速度的低估不足。本发明为临床早期精准无创诊断相关疾病提供新方法和思路，为临床个性化调整治疗方案提供科学依据，对改善患者治疗及预后具有重要价值。也进一步拓展了超声在因微循环障碍导致的相关疾病中的诊断应用，并有望推广至因微循环障碍导致的各个系统疾病的早期诊断。临床转化前景广阔，符合我国人民健康的重要需求，同时具有很好的经济和社会效益。附图说明图1为本发明实施例提供的奇异值分解原理图；图2为本发明实施例提供的矢量流速成像原理图；图3为本发明实施例提供的肝脏奇异值分解后超声图像；图4为本发明实施例提供的基于灰阶、超声造影、经奇异值分解滤波处理后的超声造影的矢量流速成像的超声图像；图5为本发明实施例提供的肝脏矢量流速成像原理图；图6为本发明实施例提供整体流程示意图。具体实施方式为了便于理解本发明，下面将参照相关附图对本发明进行更全面的描述。附图中给出了本发明的较佳实施方式。但是，本发明可以以许多不同的形式来实现，并不限于本文所描述的实施方式。相反地，提供这些实施方式的目的是使对本发明的公开内容理解得更加透彻全面。如图1-6所示，本发明实施例提供了一种基于奇异值分解滤波的超声矢量流速成像方法，可用于微血管流速的检测，包括以下过程，对于目标区域的微血管进行超声检测，采集目标区域的微血管超声造影动态图像；对每帧超声图像进行奇异值分解滤波处理；将进行奇异值分解滤波处理后的超声造影图像进行矢量流速成像处理，利用造影微泡对超声具有强烈反射这一特性，采集奇异值分解滤波处理后的造影数据集连续两帧的超声造影图像，利用互相关算法计算相邻图像之间搜索窗口内的最佳相关气泡信号，获取目标区域内微血管的速度矢量信息。如图1所示，对每帧图像进行奇异值分解滤波处理包括以下过程：第一步，选取已采集的超声造影原始数据中不受呼吸运动干扰的N帧超声图像；第二步，提取造影数据中的时间及空间信息进行组合以构建Casorati矩阵，并记为S，使每一帧图像变形成矩阵S的一列，矩阵S同时包含空间信息和时间信息，在Casorati矩阵的形成过程中，每一帧超声图像的空间信息被重组成Casorati矩阵的列向量；第三步，对S进行奇异值分解，将S分解成3个矩阵乘积的表示形式，处理公式可表示为S＝UΔV*，其中，U和V是正交矩阵，U为空间奇异向量；V为空间奇异向量所对应的时间向量；Δ为一个奇异值矩阵，*代表转置矩阵；第四步，图像中存在组织信号、噪声信号及微泡信号，选取相对较低的奇异值阈值用以滤除不需要的组织背景信号；选取相对较高的奇异值阈值用以有效的滤除杂乱的背景噪声信号，以此对奇异值阈值进行选取；根据图像对奇异值阈值选取后，将经奇异值分解的3个矩阵重新转化为Casorati矩阵，记为S’，此时的图像中的组织信号及噪声信号已经被滤除；第五步，将S’重组为具有时空信息的造影数据，称为奇异值分解滤波后造影数据；第六步，被进行重新排序为Nz行及Nx列的空间奇异向量被视作1个从数据中提取出的虚拟图片，将所有数据进行求和，得到经奇异值分解滤波处理后的超声造影图像。如图2所示，对经过奇异值分解滤波处理后的超声造影图像进行矢量流速成像，包括以下步骤：第一步，选取经奇异值分解滤波处理后的造影数据集中连续两帧的超声图像，在第一帧图像上选取一个大小为n×n像素的参考窗f，由互相关函数：Rfg＝∫f·gdxdy确定第二帧图像搜索区域内与之匹配的同样大小的目标窗的位置，记为g；第二步，对两幅图像进行互相关分析，根据互相关平面上最高峰值的位置得出Δt内微泡的最大位移；第三步，依据U＝ΔX/Δt及V＝ΔY/Δt获得该流场的速度矢量信息；第四步，利用上述步骤对多个造影微泡进行分析，实现整个流场速度信息的检测，得到目标区域的微血管速度矢量信息。其中∫∫为两个变量的函数积分，U与V为造影微泡沿x、y方向的瞬时速度，ΔX与ΔY分别为造影微泡沿x、y方向的位移；Δt为连续两帧超声图像之间的间隔时间；f、g分别为参考窗及目标窗在位置处的灰度分布函数。本发明还提供一种基于奇异值分解滤波的超声矢量流速成像系统，包括图像导入模块，将超声诊断仪采集到的微血管超声造影动态图像逐帧导入奇异值分解滤波模块；奇异值分解滤波模块，用于对超声图像序列进行矩阵重置和奇异值分解滤波；矢量流速成像处理模块，采集奇异值分解滤波处理后的造影数据集连续两帧的超声造影图像，利用互相关算法计算相邻图像之间搜索窗口内的最佳相关气泡信号，获取目标区域内微血管的速度矢量信息；结果分析模块，用于分析展示目标区域内微血管的血流方向和血流速度，将结果进行动态播放、数据可视化展示。在另一实施例中，还包括用于采集超声造影动态图像的超声诊断仪、探头，实现多模块系统化。本发明通过对肝脏微血管流速检测以对本发明的公开内容理解得更加透彻全面。使用Mindray Resona R9T超声诊断仪及频率范围为1.2-6.0MHz凸阵探头对人体肝脏进行超声检测。在扫描过程中，为了避免胃肠道胀气对结果造成的影响，建议患者最好空腹8小时。患者取平卧位或侧卧位扫查肝脏，成像深度为10cm。二维模式观察肝脏内血管走向后选取固定切面切到造影模式，将诊断仪切换至高帧率造影模式，使超声仪器处于低机械指数状态，帧频为41Hz，经肘静脉团注2.4mL声诺维造影剂，随即推注5ml生理盐水后立即采集肝脏动脉期、门脉期及延迟期高帧频超声造影动态图像。其他成像参数设置如下：增益47dB，动态范围105。使用MATLAB离线进行奇异值分解滤波处理。将超声诊断仪中的超声造影图像数据以DICOM格式导出以用于进一步的奇异值分解滤波处理。对于肝脏超声造影数据集中每一帧图像进行奇异值分解处理，采用时空域奇异值分解滤波去除图像背景组织及噪声信号，处理公式可表示为S＝UΔV*，其中，U和V是正交矩阵，U为空间奇异向量；V为空间奇异向量所对应的时间向量；Δ为一个奇异值矩阵。被重新排序形成的Nz行Nx列的空间奇异向量可以被看作为是一个从数据当中获取的虚拟图片。将所有数据进行求和，最终得到经奇异值分解滤波处理后的超声造影图像，如图3所示。为了计算肝脏感兴趣区域内微血管流速，将经SVD滤波处理后的超声造影图像数据集以AVI格式导入MATLAB离线进行矢量流速成像处理。通过利用造影微泡对超声具有强烈反射这一特性，采集奇异值分解滤波处理后的肝脏造影数据集连续两帧的超声图像，利用互相关算法计算相邻图像之间搜索窗口内的最佳相关气泡信号。简而言之，在第N帧图像中选取一个大小为32×32像素的参考窗f，其采集时间为t；利用互相关函数得到在第N+1帧图像中一个大小为32×32像素的目标窗g，则连续两帧超声图像之间的间隔时间为Δt，因此其采集时间为t+Δt。通过对两幅图像中目标窗及参考窗内的每个造影微泡信号进行互相关分析，根据互相关平面上最高峰值的位置得出Δt内造影微泡的最大位移，依据公式U＝ΔX/Δt及V＝ΔY/Δt计算出造影微泡沿x、y方向的瞬时速度，从而获取肝脏感兴趣区域内微血管的速度矢量信息，如图4所示。如图5所示，通过比较奇异值分解滤波处理对超声造影图像信噪比、对比组织比、矢量流速成像的图像中目标区域内微血管血流方向和血流速度大小的影响。评估奇异值分解滤波处理改善图像原始质量后，提升矢量流速成像检测微血管流速的价值。利用超声矢量流速成像结合奇异值分解滤波技术，弥补现有血流速度检测技术对因图像的低信噪比及红细胞检测灵敏度下降深部微血管流速低估的不足，为临床早期诊断肝脏相关疾病提供新方法。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。本文中在本发明的说明书中所使用的术语只是为了描述具体的实施方式的目的，不是旨在于限制本发明。本文所使用的术语“及/或”包括一个或多个相关的所列项目的任意的和所有的组合。以上实施方式仅用于说明本发明，而并非对本发明的限制，有关技术领域的普通技术人员，在不脱离本发明的精神和范围的情况下，还可以做出各种变化和变型，因此所有等同的技术方案也属于本发明的范畴，本发明的专利保护范围应由权利要求限定。
