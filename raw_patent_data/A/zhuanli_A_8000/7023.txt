标题title
基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法
摘要abst
本发明公开了基于双输入‑单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，CELST重建问题可以建模为一个非线性的最优化问题，但是由于测量信号的个数远小于待求解信号的个数，因此在数学上是一个高度的不适定问题,通常采用基于L2范数约束的正则化迭代求解。然而，传统正则化方法求出的荧光量子产额服从高斯分布，反映到图像上过于平滑，导致重建伪影严重。为了解决这一问题，本发明提出一种双输入‑单输出深度学习模型结构，该方法同时将采集的荧光信号和传统方法重建的低质量荧光量子产额图像作为网络输入，直接输出高质量的荧光量子产额图像。实验结果表明，本方法能够实现CELST的准确重建。
权利要求书clms
1.基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，其特征在于，本发明设计的深度学习网络同时将采集的荧光信号和传统方法重建的低质量荧光量子产额图像作为输入，直接输出高质量的荧光量子产额图像。2.根据权利要求1所述的基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，其特征在于，首先将采集得到的一维荧光信号映射到二维空间，其次用卷积核为3*3、步长为1的三层卷积层对映射后的二维信号进行编码，最后用转置卷积conv.T上采样得到数据特征图datafeature：datafeature＝conv.T，ω1，b1)，ω2，b2))其中fn包含批量归一化层和激活层，激活层使用LeakyReLU激活函数，ωn和bn分别为第n个卷积层的权重和偏置，φ为一维荧光信号。3.根据权利要求1所述的基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，其特征在于，在传统算法重建的低质量荧光量子产额图像的基础上，对图像编码降采样得到深层信息，然后在此基础上通过解码升采样恢复图像特征图imgfeature：imgfeature＝U2))))) 其中Dn为对图像进行降采样的编码层，Un为对图像进行升采样的解码层。4.根据权利要求1所述的基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，其特征在于，先将数据特征图datafeature和图像特征图imgfeature进行融合，其次通过卷积核大小为3*3的卷积层得到大小为128*128*1的高质量荧光量子产额图像out：out＝conv其中conv为卷积输出层，imgfeature和datafeature分别表示图像特征图和数据特征图。
说明书desc
技术领域本发明属于医学图像处理领域，涉及一种基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法。背景技术世界上大约一半的癌症患者都接受放射治疗，最常见的方式是外照射疗法，它利用医用直线加速器产生的高能射线照射人体病变的肿瘤组织进行治疗。在治疗过程中，放射治疗医师根据肿瘤细胞不同的状态采取不同的照射方案。因此，放疗过程中监测肿瘤细胞的生理状态具有重要研究意义。切伦可夫激发的荧光扫描断层成像是一种新型医学成像方式，该成像方式利用LINAC产生的高能射线在组织中引起的切伦可夫辐射做为内部光源，二次激发分布在生物组织内被荧光探针标记的分组织或细胞并产生荧光，荧光经过散射、折射、反射后穿透组织表面达到外部，最终被CCD相机探测到。根据采集到的荧光信号，通过重建算法重建出组织内部的荧光量子产额图像。由于在测量过程中生物组织边界数据有限以及测量的荧光信号中不可避免的混有噪声，导致CELST的重建问题在数学上是一个高度病态且不适定的问题，如外界引入微小的测量扰动都会给重建结果带来很大的变化。为了降低CELST重建问题的病态性，在重建时可以使用正则化的求解方法将CELST的重建问题转变成一个非线性最优化问题。最常用的重建算法是Tikhonov正则化，由于Tikhonov正则化求解是基于L2范数，因此最终重建出来的荧光量子产额图像边缘过于平滑，进而导致图像伪影严重，CELST的成像质量仍然受到限制。为克服上述问题，本发明首次提出了基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，提高了CELST的成像质量。发明内容本发明设计了一种基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，深度学习网络部分输入采集到的荧光信号和传统重建方法得到的低质量荧光量子产额图像，输出高质量的荧光量子产额图像。本发明设计的基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，首先将采集到的一维荧光信号φ作为输入映射到二维空间，其次用卷积核为3*3、步长为1的三层卷积层对映射后的二维信号进行编码，最后用转置卷积conv.T上采样得到数据特征图datafeature，整个过程可由下式表示：datafeature＝conv.T，ωi，b1)，ω2，b2)) 其中fn包含批量归一化层和激活层，激活层使用LeakyReLU作为激活函数，ωn和bn分别为第n个卷积层的权重和偏置，φ为采集到的荧光信号。本发明设计的基于双输入-单输出深度学习的切伦可夫激发荧光扫描断层成像重建方法，将传统算法重建出的低质量荧光量子产额图像作为输入，首先使用卷积核为3*3，步长为1的卷积层对低质量图像进行特征提取得到特征图，然后使用最大池化层对特征图降采样得到深层信息，最后用转置卷积conv.T升采样得到图像特征图imgfeature，整个过程可由下式表示：imgfeature＝U2))))) 其中Dn为对图像进行降采样的最大池化层，Un为对图像进行升采样的转置卷积层，x为低质量荧光量子产额图像。本发明设计的基于双输入-单输出深度学习的切伦可夫激发荧光扫描断层成像重建方法，深度学习网络将数据特征图datafeature和图像特征图imgfeature进行融合，通过卷积核大小为3*3的卷积层得到大小为128*128*1的高质量荧光量子产额图像out：out＝conv 其中，conv为卷积输出层，imgfeature和datafeature分别表示图像特征图和数据特征图。有益效果本发明设计了一种基于双输入-单输出深度学习的切伦可夫激发的荧光扫描断层成像重建方法，该方法同时输入采集到的荧光信号和传统方法重建的低质量荧光量子产额图像，直接输出高质量的荧光量子产额图像。深度学习模型经过训练，最终能够用于改善传统方法重建出的荧光量子产额图像伪影严重，边缘模糊的问题。附图说明图1为仿体的形状，其中颜色较亮的圆形区域为真实异常区。图2为双输入网络模型结构，上部分为图像编码网络，下部分为信号编码网络，图3为网络输入的荧光信号和传统方法重建的荧光量子产额图像。图4为本文提出的网络模型输出的荧光量子产额分布。具体实施方式为使本发明的目的、技术方案和优点更加清楚，以下结合具体实施例，并参照附图，对本发明实施方式作进一步地详细描述。步骤1：建立光在组织中传输的数学模型。CELST包括两个过程，第一个是激发过程，即通过LINAC扫描生物组织产生切伦可夫辐射，切伦可夫辐射二次激发被标记的组织产生荧光的过程；第二个是发射过程，即二次激发的荧光光子到达组织表面，通过CCD相机探测得到。整个过程可以通过耦合连续波扩散近似方程进行数学建模，可以表示为下式其中，式是切伦可夫激发域，式是荧光发射域，D、μ的下表x和m分别表示激发过程和发射过程，为梯度计算算子，激发域公式中Φx是位置r处切伦可夫激发光的光强，发射域公式中Φm是位置r处发射荧光的光强，μax和μam分别代表位置r处组织吸收系数，Dx、m代表光学扩散系数，式方程右边η为荧光探针的量子效率，ημaf是最终需要重建的荧光量子产额。步骤2：扩散近似方程的离散数值求解。将CELST的求解分为前向模型和逆向模型。前向模型获得组织表面测量的发射荧光信号，逆向模型根据测量的荧光信号，通过传统方法重建出组织内部的荧光量子产额。1)：CELST前向模型将扩散方程，近似转化为线性矩阵方程，即在生物组织内部的光学属性与切伦可夫激发光已知的情况下，求得二次激发产生的荧光在组织边界处的光强，即CCD相机测量到的荧光信号，前向模型可由下面的线性方程组表示φ＝Ax其中，A是通过有限元法构建的系统矩阵，φ为表面测量的荧光信号，x为组织内部真实的荧光量子产额。2)：CELST逆向模型的实质是在荧光测量值已知的情况下，重建出组织内部的荧光量子产额，由于公式中测量值φ的个数远小于x。因此，求解上式是一个严重的不适定问题，可以使用Tikhonov正则化方法求解，由下式表示式第一部分是荧光量子产额的拟合项，第二部分是正则项，λ用于平衡数据拟合部分和正则化强度，求解上式可以初步得到荧光量子产额分布。步骤3：训练数据集的生成。本发明使用的数值仿体大小设置为100mm*60mm，通过有限元法共分割为2747个有限元节点和5280个三角形网格单元，真实异常区如图1所示。模拟LINAC产生的X射线等间距扫描32次，仿体的上端放置64个探测器来采集荧光信号，通过传统重建方法迭代一次得到低质量荧光量子产额图像，同时，为了扩充训练样本，产生随机深度以及随机个数的异常区，总计生成20000对数据，其中训练阶段用18000对数据，测试阶段用2000对数据，每个训练样本包含2个输入和1个输出。步骤4：双输入-单输出深度学习模型的训练。在模型训练阶段，把CELST前向模型得到的荧光信号和传统方法迭代重建出的低质量图像做为网络的输入，输出为真实荧光量子产额图像，采用GTX2080 GPU 16G训练，框架采用Pytorch1.4.0，初始学习率设为1e-4，正则化参数设为0.001，训练epoch设为1000。1)：输入的一维荧光信号φ经过特征提取，得到信号特征图datafeature。datafeature＝conv.T，ω1，b1)，ω2，b2)) 2)：输入的低质量图像x1经过特征提取，得到图像特征图imgfeature。imgfeature＝U2))))) 3)：将datafeature和imgfeature进行通道融合，得到单输出out。out＝conv 步骤5：双输入-单输出深度学习模型的测试。在模型测试阶段，从测试集中选择荧光信号和对应的传统方法重建结果做为输入，可由图4看出异常区的重建结果。实验证明，本发明提出的方法有效的去除了重建图像的伪影，提高了重建质量。
