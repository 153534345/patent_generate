标题title
导管头端控制方法、装置、设备和存储介质
摘要abst
本发明实施例提供一种导管头端控制方法、装置、设备和存储介质，应用于与电动内窥镜通信连接的控制设备，该方法包括：控制设备获取电动控制手柄控制导管头端弯曲时产生的电机行程和对应的弯曲状态；根据电机行程和弯曲状态，确定导管头端的弯曲控制模型；响应于电机控制指令在电动控制手柄的输入，根据当前采样时刻对应的电机行程和弯曲控制模型，确定导管头端的目标弯曲状态；根据导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在当前采样时刻导管头端的实际弯曲状态；确定目标弯曲状态与实际弯曲状态之间的差异值；根据弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，补偿控制指令用于使得差异值减小至设定阈值。
权利要求书clms
1.一种导管头端控制方法，其特征在于，应用于与电动内窥镜通信连接的控制设备，所述电动内窥镜包括导管和控制所述导管弯折的电动控制手柄，所述方法包括：获取所述电动控制手柄控制所述导管头端弯曲时产生的电机行程和对应的弯曲状态；根据所述电机行程和所述弯曲状态，确定所述导管头端的弯曲控制模型；响应于电机控制指令在所述电动控制手柄的输入，根据当前采样时刻对应的电机行程和所述弯曲控制模型，确定所述导管头端的目标弯曲状态；根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态；确定所述目标弯曲状态与所述实际弯曲状态之间的差异值；根据所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，所述补偿控制指令用于使得所述差异值减小至设定阈值。2.根据权利要求1所述的方法，其特征在于，所述导管头端安装有具有定位功能的传感器，所述导管头端的实时运动轨迹记录，是根据所述传感器回传的定位信号确定的。3.根据权利要求2所述的方法，其特征在于，所述获取所述电动控制手柄控制所述导管头端弯曲时产生的电机行程和对应的弯曲状态，包括：获取所述电动控制手柄通过拉动至少一根驱动丝控制所述导管头端弯曲时，至少一个电机的电机行程；根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态；其中，所述驱动丝与所述电机一一对应，所述弯曲状态包括弯曲角度和弯曲方向。4.根据权利要求3所述的方法，其特征在于，所述根据所述导管头端在气管内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态，包括：根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态，以及目标段导管与所述电机行程对应的整体弯曲形态，所述目标段导管是指已进入所述模拟人体自然腔道的导管；所述根据所述电机行程和所述弯曲状态，确定所述导管头端的弯曲控制模型，包括：根据所述电机行程，所述弯曲状态以及所述整体弯曲形态，确定所述导管头端的弯曲控制模型。5.根据权利要求1所述的方法，其特征在于，所述根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态，包括：根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态，以及已进入所述目标人体自然腔道的导管的整体形态；在确定所述目标弯曲状态与所述实际弯曲状态之间的差异值之后，所述方法还包括：若所述差异值大于设定阈值，则获取所述电动控制手柄反馈的电机状态控制参数；所述根据所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，包括：根据所述差异值，所述电机状态控制参数，所述整体形态和所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令。6.一种导管头端控制装置，其特征在于，应用于与电动内窥镜通信连接的控制设备，所述电动内窥镜包括导管和控制所述导管弯折的电动控制手柄，所述装置包括：获取模块，用于获取所述电动控制手柄控制所述导管头端弯曲时产生的电机行程和对应的弯曲状态；处理模块，用于根据所述电机行程和所述弯曲状态，确定所述导管头端的弯曲控制模型；响应于电机控制指令在所述电动控制手柄的输入，根据当前采样时刻对应的电机行程和所述弯曲控制模型，确定所述导管头端的目标弯曲状态；根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态；确定所述目标弯曲状态与所述实际弯曲状态之间的差异值；根据所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，所述补偿控制指令用于使得所述差异值减小至设定阈值。7.根据权利要求6所述的装置，其特征在于，所述获取模块，还用于获取所述电动控制手柄通过拉动至少一根驱动丝控制所述导管头端弯曲时，至少一个电机的电机行程；所述处理模块，还用于根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态；其中，所述驱动丝与所述电机一一对应，所述弯曲状态包括弯曲角度和弯曲方向。8.根据权利要求7所述的装置，其特征在于，所述处理模块，还用于根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态，以及目标段导管与所述电机行程对应的整体弯曲形态，所述目标段导管是指已进入所述模拟人体自然腔道的导管；根据所述电机行程，所述弯曲状态以及所述整体弯曲形态，确定所述导管头端的弯曲控制模型。9.一种电子设备，其特征在于，包括：存储器、处理器、通信接口；其中，所述存储器上存储有可执行代码，当所述可执行代码被所述处理器执行时，使所述处理器执行如权利要求1至5中任一项所述的导管头端控制方法。10.一种非暂时性机器可读存储介质，其特征在于，所述非暂时性机器可读存储介质上存储有可执行代码，当所述可执行代码被电子设备的处理器执行时，使所述处理器执行如权利要求1至5中任一项所述的导管头端控制方法。
说明书desc
技术领域本发明涉及医疗器械技术领域，尤其涉及一种导管头端控制方法、装置、设备和存储介质。背景技术内窥镜，作为一种医疗设备，可以经过人体的自然腔道，比如支气管道等，直接到达病灶位置，从而使医务人员能够直接对相关部位进行病变情况的观察、手术等。内窥镜通常由导管和控制手柄两部分组成，其中，导管的一端直接与控制手柄相连，另一端通过驱动丝与控制手柄相连，使用控制手柄拉动驱动丝可以调整导管头端的弯曲状态，进而能够使导管头端带动整根导管，经过弯曲复杂的人体自然腔道道到达病灶所在位置。与手动控制手柄相比，电动控制手柄能够将操作者的操作信号转化为电信号，通过电机和相关的传导结构拉动驱动丝，可以提高对导管头端的弯曲状态的控制精度。但是，由于导管的材料及结构等原因，在经历多次弯折之后导管头端可能发生形变，形变会使导管头端在初始时刻就具有一定的弯曲状态，或者已进入人体自然腔道的导管发生了一些扭转及弯曲，那么在实际使用时，通过电机拉动驱动丝控制导管头端的弯曲状态，其发生的实际弯曲状态往往与想要达到的目标弯曲状态之间存在较大的偏差，若不能及时的发现和调整偏差，可能会产生难以预料的后果。发明内容本发明实施例提供一种导管头端控制方法、装置、设备和存储介质，用以实时矫正电动内窥镜电动控制手柄对导管头端弯曲状态的控制，减小导管头端的实际弯曲状态与目标弯曲状态之间的偏差，稳定、精细的控制导管头端的弯折。第一方面，本发明实施例提供一种导管头端控制方法，应用于与电动内窥镜通信连接的控制设备，所述电动内窥镜包括导管和控制所述导管弯折的电动控制手柄，所述方法包括：获取所述电动控制手柄控制所述导管头端弯曲时产生的电机行程和对应的弯曲状态；根据所述电机行程和所述弯曲状态，确定所述导管头端的弯曲控制模型；响应于电机控制指令在所述电动控制手柄的输入，根据当前采样时刻对应的电机行程和所述弯曲控制模型，确定所述导管头端的目标弯曲状态；根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态；确定所述目标弯曲状态与所述实际弯曲状态之间的差异值；根据所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，所述补偿控制指令用于使得所述差异值减小至设定阈值。可选地，所述导管头端安装有具有定位功能的传感器，所述导管头端的实时运动轨迹记录，是根据所述传感器回传的定位信号确定的。可选地，所述获取所述电动控制手柄控制所述导管头端弯曲时产生的电机行程和对应的弯曲状态，包括：获取所述电动控制手柄通过拉动至少一根驱动丝控制所述导管头端弯曲时，至少一个电机的电机行程；根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态；其中，所述驱动丝与所述电机一一对应，所述弯曲状态包括弯曲角度和弯曲方向。可选地，所述根据所述导管头端在气管内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态，包括：根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态，以及目标段导管与所述电机行程对应的整体弯曲形态，所述目标段导管是指已进入所述模拟人体自然腔道的导管。可选地，所述根据所述电机行程和所述弯曲状态，确定所述导管头端的弯曲控制模型，包括：根据所述电机行程，所述弯曲状态以及所述整体弯曲形态，确定所述导管头端的弯曲控制模型。可选地，所述根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态，包括：根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态，以及已进入所述目标人体自然腔道的导管的整体形态。可选地，在确定所述目标弯曲状态与所述实际弯曲状态之间的差异值之后，所述方法还包括：若所述差异值大于设定阈值，则获取所述电动控制手柄反馈的电机状态控制参数。可选地，所述根据所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，包括：根据所述差异值，所述电机状态控制参数，所述整体形态和所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令。第二方面，本发明实施例提供一种导管头端控制装置，应用于与电动内窥镜通信连接的控制设备，所述电动内窥镜包括导管和控制所述导管弯折的电动控制手柄，所述装置包括：获取模块，用于获取所述电动控制手柄控制所述导管头端弯曲时产生的电机行程和对应的弯曲状态；处理模块，用于根据所述电机行程和所述弯曲状态，确定所述导管头端的弯曲控制模型；响应于电机控制指令在所述电动控制手柄的输入，根据当前采样时刻对应的电机行程和所述弯曲控制模型，确定所述导管头端的目标弯曲状态；根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态；确定所述目标弯曲状态与所述实际弯曲状态之间的差异值；根据所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，所述补偿控制指令用于使得所述差异值减小至设定阈值。可选地，所述获取模块，还用于获取所述电动控制手柄通过拉动至少一根驱动丝控制所述导管头端弯曲时，至少一个电机的电机行程。相应地，所述处理模块，还用于根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态；其中，所述驱动丝与所述电机一一对应，所述弯曲状态包括弯曲角度和弯曲方向。可选地，所述处理模块，还用于根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态，以及目标段导管与所述电机行程对应的整体弯曲形态，所述目标段导管是指已进入所述模拟人体自然腔道的导管；根据所述电机行程，所述弯曲状态以及所述整体弯曲形态，确定所述导管头端的弯曲控制模型。可选地，所述处理模块，还用于根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态，以及已进入所述目标人体自然腔道的导管的整体形态。可选地，所述获取模块，还用于若所述差异值大于设定阈值，则获取所述电动控制手柄反馈的电机状态控制参数。可选地，所述处理模块，还用于根据所述差异值，所述电机状态控制参数，所述整体形态和所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令。第三方面，本发明实施例提供一种电子设备，包括：存储器、处理器、通信接口；其中，所述存储器上存储有可执行代码，当所述可执行代码被所述处理器执行时，使所述处理器至少可以实现如第一方面所述的导管头端控制方法。第四方面，本发明实施例提供了一种非暂时性机器可读存储介质，所述非暂时性机器可读存储介质上存储有可执行代码，当所述可执行代码被电子设备的处理器执行时，使所述处理器至少可以实现如第一方面所述的导管头端控制方法。在本发明实施例提供的方案中，在电动内窥镜的导管进入患者的目标人体自然腔道之前，与电动内窥镜通信连接的控制设备，先获取电动控制手柄控制导管头端弯曲时产生的电机行程和对应的弯曲状态；然后，根据该电机行程和弯曲状态，确定导管头端的弯曲控制模型。在电动内窥镜的导管进入患者的目标人体自然腔道之后，与电动内窥镜通信连接的控制设备，响应于电机控制指令在所述电动控制手柄的输入，按照预先设定的采样间隔，对导管头端的弯曲状态进行采样分析，具体地，首先，根据当前采样时刻对应的电机行程和弯曲控制模型，确定导管头端的目标弯曲状态；根据导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在当前采样时刻导管头端的实际弯曲状态；然后，确定目标弯曲状态与实际弯曲状态之间的差异值；最后，根据弯曲控制模型，确定用于补偿差异值的补偿控制指令，该补偿控制指令用于使得前述差异值减小至设定阈值。基于本方案，当到达采样时刻时，确定当前采样时刻导管头端对应的目标弯曲状态和实际弯曲状态之间的差异值，然后，根据弯曲控制模型确定用于补偿该差异值的补偿控制指令，基于该补偿控制指令，调整导管头端的实际弯曲状态向目标弯曲状态趋近，在经过及几个采样和补偿周期后，导管头端的实际弯曲状态与目标弯曲状态之间的差异值减小至设定阈值，即导管头端的实际弯曲状态与目标弯曲状态基本一致；当相邻两个采样时刻之间的采样间隔足够小时，通过本方案，可实现实时矫正电动内窥镜电动控制手柄对导管头端弯曲状态的控制，稳定、精细的控制导管头端的弯折。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的一种导管头端形变示意图；图2为本发明实施例提供的一种导管头端控制方法的流程图；图3为本发明实施例提供的一种导管在模拟人体自然腔道内的示意图；图4为本发明实施例提供的一种导管头端控制装置的结构示意图；图5为与图4所示实施例提供的导管头端控制装置对应的电子设备的结构示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。另外，下述各方法实施例中的步骤时序仅为一种举例，而非严格限定。在现代的介入医学中，电动内窥镜是一种比较重要的医疗设备。通常电动内窥镜由导管和控制导管移动的电动控制手柄组成，其中，导管的一端直接与电动控制手柄相连，另一端通过驱动丝与电动控制手柄相连，使用电动控制手柄拉动驱动丝可以调整导管头端的弯曲状态，进而能够使导管头端带动整根导管，经过弯曲复杂的人体自然腔道到达病灶所在位置。在使用电动控制手柄拉动驱动丝时，能够将操作者的操作信号转化为电信号，通过这些电信号驱动电动控制手柄中的电机和相关的传导结构拉动驱动丝，从而提高对导管头端的弯曲状态的控制精度。但是，由于导管的材料及结构等原因，在经历多次弯折之后导管头端可能发生形变，形变会使导管头端在初始时刻就具有一定的弯曲状态，如图1所示，图1为本发明实施例提供的一种导管头端形变示意图，或者，已进入人体自然腔道的导管发生了一些扭转及弯曲，那么在实际使用时，通过电机拉动驱动丝控制导管头端的弯曲状态，其发生的实际弯曲状态往往与想要达到的目标弯曲状态之间存在较大的偏差，若不能及时的发现和调整偏差，可能会产生难以预料的后果。为解决上述至少一个技术问题，本发明实施例提供了一种导管头端控制方法，该方法由与电动内窥镜通信连接的控制设备来执行，该控制设备可以是诸如PC机、笔记本电脑、智能手机等终端设备，也可以是服务器。该服务器可以是包含一独立主机的物理服务器，或者也可以为虚拟服务器，或者也可以为云端服务器或服务器集群。图2为本发明实施例提供的一种导管头端控制方法的流程图，如图2所示，可以包括如下步骤：201、获取电动控制手柄控制导管头端弯曲时产生的电机行程和对应的弯曲状态。202、根据电机行程和弯曲状态，确定导管头端的弯曲控制模型。203、响应于电机控制指令在电动控制手柄的输入，根据当前采样时刻对应的电机行程和弯曲控制模型，确定导管头端的目标弯曲状态。204、根据导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在当前采样时刻导管头端的实际弯曲状态。205、确定目标弯曲状态与实际弯曲状态之间的差异值。206、根据弯曲控制模型，确定用于补偿差异值的补偿控制指令，该补偿控制指令用于使得差异值减小至设定阈值。在本发明实施例提供的方案中，为了确定导管头端在患者人体自然腔道内的实时位置，导管头端安装有具有定位功能的传感器，这些传感器包括但不限于光学传感器、电磁定位传感器等。容易理解的是，这些传感器在实现其定位功能时，通常与其对应的参照系共同构成一个具有定位功能的系统。控制设备若想要通过传感器的定位信号确定导管头端的位置信息，电动内窥镜的操作需要基于一个带有定位功能的系统中，可以理解为，一方面电动内窥镜的导管头端需要安装有具有定位功能的传感器，另一方面，电动内窥镜在操作时，需要处于与传感器对应的参考系中。为了便于理解，在本发明实施例中以电磁定位传感器为例进行说明，具体实施过程中，并不以此为限。假设本发明实施例中电动内窥镜的导管头端安装的具有定位功能的传感器为电磁定位传感器，电磁定位传感器在工作时，需要处于与其对应的磁场发生器产生的电磁场中，在操作电动内窥镜时，需要位于磁场发生器产生的电磁场范围内。当通过电动控制手柄控制导管头端在人体自然腔道内发生移动时，电磁定位传感器跟随导管头端同时在磁场中发生移动，电磁定位传感器在磁场发生器产生的磁场中移动时，根据电磁定位传感器回传给控制设备的电磁信号，可以确定电磁定位传感器在磁场中的位置。为了描述导管头端在患者气管内对应的位置，一种可实现的方式是，建立电磁定位传感器所在的磁场空间坐标系，与导管头端所在的人体自然腔道对应的自然空间坐标系之间对应关系，根据建立的对应关系对两个坐标系做映射处理，通过一个映射处理后得到的目标坐标系，实现用电磁定位传感器的位置描述导管头端在患者人体自然腔道内的位置。控制设备还可以记录导管头端在不同时刻对应的实时位置，确定导管头端的在患者人体自然腔道内的实时运动轨迹。如上文所述，由于导管的材料及结构等原因，在经历多次弯折之后导管头端可能发生形变，形变会使导管头端在初始时刻就具有一定的弯曲状态。在导管头端已经具有了一定的初始弯曲状态的情况下，如果仍按照其在正常状态下建立的弯曲控制模型，对输入电机控制指令控制导管头端弯曲后，导管头端的实际弯曲状态进行调整，则可能由于根据弯曲控制模型预测的目标弯曲状态不准确，导致调整后的实际弯曲状态与目标弯曲状态之间存在较大差异。为此，在本发明实施例中，在电动内窥镜的导管进入患者人体自然腔道之前，会先在患者体外，预先通过电动控制手柄控制导管头端弯曲，同时，控制设备记录控制导管头端弯曲时产生的电机行程和对应的弯曲状态，之后，根据电机行程和导管头端弯曲状态的对应关系，确定导管头端的弯曲控制模型。可以理解的是，人体自然腔道的弯曲情况是较为复杂的，为了保证电动内窥镜的导管头端能够带动导管到达患者病灶所在的位置，导管头端需要能够实现在多个不同的方向上产生不同角度弯曲，从而，导管头端可能不止有一根驱动丝与导管头端和电动控制手柄相连。因此，在患者体外，通过电动控制手柄在磁场中控制导管头端弯曲，根据电机行程和导管头端弯曲状态的对应关系，确定导管头端的弯曲控制模型时，一种可实现的方式是，控制设备获取电动控制手柄通过拉动至少一根驱动丝控制导管头端弯曲时，产生的至少一个电机的电机行程；以及导管头端在模拟人体自然腔道内的实时运动轨迹记录，并根据该实时运动轨迹记录，确定导管头端与电机行程对应的弯曲状态；其中，驱动丝与电机一一对应，弯曲状态包括弯曲角度和弯曲方向，模拟人体自然腔道是指具有人体自然腔道结构的实物模型。容易理解的是，导管头端在模拟人体自然腔道内移动时，导管头端的位置会不断发生变化，导管头端在移动过程中经过的一系列的位置点和当前时刻所处的实时位置点，共同构成了导管头端在模拟人体自然腔道内的实时运动轨迹记录；根据该实时运动轨迹记录，可以确定导管头端在当前位置的弯曲形态；另外，导管头端在模拟人体自然腔道中移动时，会带动整根导管进入模拟人体自然腔道，已进入模拟人体自然腔道的导管会受到气管形状的约束，从而具有一定的弯曲形态，其弯曲形态与导管头端的实时运动轨迹记录基本吻合。为了便于理解，本发明实施例提供了一种导管在模拟人体自然腔道内的示意图，如图3所示，假设已进入模拟人体自然腔道的导管为目标段导管，目标段导管是电动内窥镜导管的一部分，包含有导管头端，目标段导管的整体弯曲形态，基本和运动轨迹温吻合。可选地，在根据导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定导管头端与电机行程对应的弯曲状态时，还可以根据该实时运动轨迹记录，确定目标段导管与电机行程对应的整体弯曲形态；然后，根据电机行程，导管头端的弯曲状态以及目标段导管的整体弯曲形态，确定导管头端的弯曲控制模型。在具体实施过程中，该弯曲控制模型中，可以包含有电机行程与导管头端弯曲方向和弯曲角度对应的函数关系，目标段导管的整体弯曲形态对该函数关系的影响程度以及对应的调整参数等；特别地，当需要通过多个电机产生相应的电机行程，拉动不同的驱动丝，来调整导管头端的弯曲状态时，不同的电机驱动顺序，可能会产生不同的弯曲结果，对此在确定导管头端的弯曲状态模型时，可以将电机的驱动顺序也考虑在内。在使用电动内窥镜对患者进行介入手术之前，通常会预先获取患者的目标人体自然腔道的医学图像，比如：CT图像等，通过该医学图像，重建出患者的目标人体自然腔道的三维模型，基于该三维模型，预先规划出一条经过各级人体自然腔道到达患者病灶所在位置的路径。为了方便医务人员的操作，可以在前述经过映射处理得到的目标坐标系中，示意出该预先规划的导管头端的移动路径。在电动内窥镜的导管进入患者气管之后，医务人员根据目标坐标系中显示的导管头端在患者的人体自然腔道内的实时位置，以及预先规划的导管头端的移动路径，确定输入到电动控制手柄的电机控制指令。在具体实施过程中，电动控制手柄连接有控制器，医务人员可通过操作控制器面板上的控制按钮，输入该电机控制指令，该电机控制指令用于使得导管头端延预先规划的移动路径进行移动，或者，在人体自然腔道的某些地方产生一定角度的弯折，以方便延人体自然腔道到达病灶所在位置。可以理解的是，医务人员通过输入的电机控制指令控制导管头端弯曲时，想要达到的目标弯曲状态往往与其发生的实际弯曲状态之间存在一定偏差，在对这些偏差进行修正时，如果每次都等偏差修正结束后，才输入下一个电机控制指令，那么无疑会增加很多等待偏差修正的时间，对应的会延长患者的手术时间，给患者造成不适。并且，在电动内窥镜的实际使用过程中，医务人员输入电机控制指令时，通常是一个指令接着一个指令，连续输入的，导管头端的弯曲状态也是随着控制指令的输入动态变化的。针对上述实际应用场景，在本发明实施例中，在通过电动控制手柄控制导管头端弯曲时，导管头端控制的核心思路是：响应于电机控制指令在电动控制手柄的输入，首先，根据当前采样时刻对应的电机行程和弯曲控制模型，确定导管头端的目标弯曲状态；根据导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在当前采样时刻导管头端的实际弯曲状态；然后，确定目标弯曲状态与实际弯曲状态之间的差异值；之后，根据弯曲控制模型，确定用于补偿该差异值的补偿控制指令；最后，通过该补偿控制指令使得上述差异值减小至设定阈值。在具体实施过程中，一种可实现的确定采样时刻的方法是，在控制设备中添加一个计时器，每经过一个预设的时间间隔，就触发控制设备获取当前采样时刻，电动控制手柄中的电机行程，以及导管头端在目标人体自然腔道内的实时运动轨迹记录。控制设备在获取电机行程后，将该电机行程输入弯曲控制模型中，根据弯曲控制模型的输出结果确定导管头端的目标弯曲状态。控制设备在根据导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在当前采样时刻导管头端的实际弯曲状态时，可选地，还可以确定已进入目标人体自然腔道的导管的整体形态。可选地，控制设备在确定目标弯曲状态与实际弯曲状态之间的差异值之后，还可以判断该差异值是否大于设定阈值。设定阈值是指目标弯曲状态与实际弯曲状态之间可接受的误差值，即在设定阈值内并不会对导管头端在人体自然腔道内的移动产生较大影响，设定阈值可以在电动内窥镜进入人体前，通过电动控制手柄控制导管头端弯曲时确定。若当前采样时刻的目标弯曲状态与实际弯曲状态之间的差异值小于等于该设定阈值，则表明当前采样时刻导管头端的目标弯曲状态与实际弯曲状态基本一致，无需对当前采样时刻的差异值进行补偿。若当前采样时刻的目标弯曲状态与实际弯曲状态之间的差异值大于该设定阈值，则控制设备电动控制手柄反馈的电机状态控制参数，比如：位移、拉力、电流和速度等。之后将差异值、电机状态控制参数和已进入目标人体自然腔道的导管的整体形态，输入弯曲控制模型；弯曲控制模型根据输入信息，确定用于补偿当前采样时刻对应的差异值的补偿控制指令；最后，将该补偿控制指令输入电动控制手柄的控制器，以使导管头端向目标弯曲状态弯曲，使差异值减小至设定阈值。在本发明实施例提供的方案中，通过输入电机控制指令控制导管头端弯折时，控制设备会按照预先设定的时间间隔，不断的对导管头端的弯曲状态尽行采样分析，并在导管头端的目标弯曲状态与实际弯曲状态之间的差异值大于设定阈值时，对该差异值进行补偿处理，以减小该差异值。容易理解的是，如果在当前采样时刻确定的补偿控制指令，没有将当前采样时刻对应的差异值减小至设定阈值，则可以在下一采样时刻到来时，重新确定差异值和对应的补偿控制指令，来对导管头端的实际弯曲状态再次进行补偿，重新确定的差异值中，包含有上一采样时刻未补偿到的差异。在经过及几个采样和补偿周期后，导管头端的实际弯曲状态与目标弯曲状态之间的差异值能够减小至设定阈值。为了便于理解，举例来说，假设t1，t2，t3，t4…tn,为用户自定义的采样时刻，任意两个相邻的采样时刻之间的时间间隔相同，差异值的设定阈值为1度。响应于电机控制指令在电动控制手柄的输入，触发控制设备在到达采样时刻时，获取当前采样时刻，电动控制手柄中的电机行程，以及导管头端在目标人体自然腔道内的实时运动轨迹记录。假设t1时刻，控制设备获取了电机行程1和实时运动轨迹记录1，根据弯曲控制模型确定导管头端的目标弯曲状态为向左弯曲10度；根据实时运动轨迹记录1，确定t1时刻导管头端的实际弯曲状态为向左弯曲7度，已进入目标人体自然腔道的导管的整体形态为“S”型。在确定t1时刻导管头端目标弯曲状态与实际弯状态之间的差异值为3度，大于设定阈值后，获取电动控制手柄反馈的电机状态控制参数；然后将差异值3度、电机状态控制参数、整体形态“S”型输入到弯曲控制模型，以确定用于补偿t1时刻的差异值的补偿控制指令1；最后，将该补偿控制指令1输入电动控制手柄的控制器，以使导管头端向目标弯曲状态弯曲。假设补偿控制指令1，并没有使导管头端在t1时刻的差异值减小至设定阈值，比如：补偿控制指令只使得导管头端的实际弯曲状态改变为向左弯曲8度，仍存在2度的差异值未被补偿。面对这种情况，可以在t2时刻，重新确定差异值和对应的补偿控制指令，来对导管头端的实际弯曲状态再次进行补偿。在t1时刻和t2时刻之间，如果医务人员未输入新的电机控制指令，那么控制设备在t2时刻，重新获取电动控制手柄中的电机行程，以及导管头端在目标人体自然腔道内的实时运动轨迹记录后，确定的t2时刻的差异值为2度，参照上述过程，重新确定补偿控制指令，补偿这2度的差异值既可。在t1时刻和t2时刻之间，如果医务人员输入了新的电机控制指令，那么响应于该电机控制指令的输入，电机行程也会发生一定的改变，当到达t2时刻时，控制设备重新获取电动控制手柄中的电机行程，以及导管头端在目标人体自然腔道内的实时运动轨迹记录。假设在t2时刻，控制设备获取了电机行程2和实时运动轨迹记录2，根据弯曲控制模型确定导管头端的目标弯曲状态为向左弯曲15度；根据实时运动轨迹记录2，确定t2时刻导管头端的实际弯曲状态为向左弯曲11度，已进入目标人体自然腔道的导管的整体形态仍为“S”型。在确定t2时刻导管头端目标弯曲状态与实际弯状态之间的差异值为4度，大于设定阈值后，获取电动控制手柄反馈的电机状态控制参数；然后将差异值4度、电机状态控制参数、整体形态“S”型输入到弯曲控制模型，以确定用于补偿t2时刻的差异值的补偿控制指令2；最后，将该补偿控制指令2输入电动控制手柄的控制器，以使导管头端向目标弯曲状态弯曲。容易理解的是，t2时刻的差异值中，实际上包含有t1时刻未被补偿的差异值。如果t2时刻存在未被补偿的差异值，则可以在t3时刻重新进行补偿，具体过程可参照上述过程，在此不再赘述。容易理解是，经过几个采样时刻的补偿，能够使导管头端的实际弯曲状态与目标弯曲状态基本一致。在上述过程中，由于电机控制指令在不断的被输入，导管头端的实际弯曲状态也在不断发生变化，相应的，在每个采样时刻导管头端对应的目标弯曲状态与实际弯曲状态之间的差异值也在不断发生变化，因此，本发明实施例提供的导管头端的控制方案，实际上是在一个导管头端弯曲状态动态更新的过程中，将导管头端的实际弯曲状态调整至与目标弯曲状态趋近，两者之间的差异值小于设定阈值。特别地，当相邻两个采样时刻之间的时间足够小时，可实现实时矫正电动内窥镜电动控制手柄对导管头端弯曲状态的控制，实现对导管头端弯折的柔性控制。在本发明实施例提供的方案中，在电动内窥镜的导管进入患者的目标人体自然腔道之前，与电动内窥镜通信连接的控制设备，先获取电动控制手柄控制导管头端弯曲时产生的电机行程和对应的弯曲状态；然后，根据该电机行程和弯曲状态，确定导管头端的弯曲控制模型。在电动内窥镜的导管进入患者的目标人体自然腔道之后，与电动内窥镜通信连接的控制设备，响应于电机控制指令在所述电动控制手柄的输入，按照预先设定的采样间隔，对导管头端的弯曲状态进行采样分析，具体地，首先，根据当前采样时刻对应的电机行程和弯曲控制模型，确定导管头端的目标弯曲状态；根据导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在当前采样时刻导管头端的实际弯曲状态；然后，确定目标弯曲状态与实际弯曲状态之间的差异值；最后，根据弯曲控制模型，确定用于补偿差异值的补偿控制指令，该补偿控制指令用于使得前述差异值减小至设定阈值。基于本方案，当到达采样时刻时，确定当前采样时刻导管头端对应的目标弯曲状态和实际弯曲状态之间的差异值，然后，根据弯曲控制模型确定用于补偿该差异值的补偿控制指令，基于该补偿控制指令，导管头端调整其实际弯曲状态向目标弯曲状态趋近，在经过及几个采样和补偿周期后，导管头端的实际弯曲状态与目标弯曲状态之间的差异值减小至设定阈值，即导管头端的实际弯曲状态与目标弯曲状态基本一致；当相邻两个采样时刻之间的采样间隔足够小时，通过本方案，可实现实时矫正电动内窥镜电动控制手柄对导管头端弯曲状态的控制，稳定、精细的控制导管头端的弯折。以下将详细描述本发明的一个或多个实施例的导管头端控制装置。本领域技术人员可以理解，这些装置均可使用市售的硬件组件通过本方案所教导的步骤进行配置来构成。图4为本发明实施例提供的一种导管头端控制装置的结构示意图，应用于与电动内窥镜通信连接的控制设备，电动内窥镜包括导管和控制所述导管移动的电动控制手柄，如图4所示，该装置包括：获取模块11、处理模块12。获取模块11，用于获取所述电动控制手柄控制所述导管头端弯曲时产生的电机行程和对应的弯曲状态。处理模块12，用于根据所述电机行程和所述弯曲状态，确定所述导管头端的弯曲控制模型；响应于电机控制指令在所述电动控制手柄的输入，根据当前采样时刻对应的电机行程和所述弯曲控制模型，确定所述导管头端的目标弯曲状态；根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态；确定所述目标弯曲状态与所述实际弯曲状态之间的差异值；根据所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令，所述补偿控制指令用于使得所述差异值减小至设定阈值。可选地，所述获取模块11，还用于获取所述电动控制手柄通过拉动至少一根驱动丝控制所述导管头端弯曲时，至少一个电机的电机行程。相应地，所述处理模块12，还用于根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态；其中，所述驱动丝与所述电机一一对应，所述弯曲状态包括弯曲角度和弯曲方向。可选地，所述处理模块12，还用于根据所述导管头端在模拟人体自然腔道内的实时运动轨迹记录，确定所述导管头端与所述电机行程对应的弯曲状态，以及目标段导管与所述电机行程对应的整体弯曲形态，所述目标段导管是指已进入所述模拟人体自然腔道的导管；根据所述电机行程，所述弯曲状态以及所述整体弯曲形态，确定所述导管头端的弯曲控制模型。可选地，所述处理模块12，还用于根据所述导管头端在目标人体自然腔道内的实时运动轨迹记录，确定在所述当前采样时刻所述导管头端的实际弯曲状态，以及已进入所述目标人体自然腔道的导管的整体形态。可选地，所述获取模块11，还用于若所述差异值大于设定阈值，则获取所述电动控制手柄反馈的电机状态控制参数。可选地，所述处理模块12，还用于根据所述差异值，所述电机状态控制参数，所述整体形态和所述弯曲控制模型，确定用于补偿所述差异值的补偿控制指令。图4所示装置可以执行前述实施例中介绍的步骤，详细的执行过程和技术效果参见前述实施例中的描述，在此不再赘述。在一个可能的设计中，上述图4所示导管头端控制装置的结构可实现为一电子设备，如图5所示，该电子设备可以包括：存储器21、处理器22、通信接口23。其中，存储器21上存储有可执行代码，当所述可执行代码被处理器22执行时，使处理器22至少可以实现如前述实施例中提供的导管头端控制方法。另外，本发明实施例提供了一种非暂时性机器可读存储介质，所述非暂时性机器可读存储介质上存储有可执行代码，当所述可执行代码被电子设备的处理器执行时，使所述处理器至少可以实现如前述实施例中提供的导管头端控制方法。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到各实施方式可借助加必需的通用硬件平台的方式来实现，当然也可以通过硬件和软件结合的方式来实现。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以计算机产品的形式体现出来，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
