标题title
一种基于智能移动设备的多参数生理信息检测系统和方法
摘要abst
本发明提供了一种基于智能移动设备的多参数生理信息检测系统和方法，所述智能移动设备包括位于所述智能移动设备同一侧的照明设备和摄像设备，所述检测系统包括：信号采集模块和信号处理模块。本发明利用智能终端摄像头和灯光采集的指端视频预测心率，血氧，血压。本发明系统利用视频取帧，图像分通道，像素点加权求和从指端连续视频帧中合成PPG信号；在PPG基础上利用Unet网络提取特征，由多层卷积神经网络组成的多个支路的分支网络分别预测心率，血氧，血压值。
权利要求书clms
1.一种基于智能移动设备的多参数生理信息检测系统，其特征在于，所述智能移动设备包括位于所述智能移动设备同一侧的照明设备和摄像设备，所述检测系统包括：信号采集模块和信号处理模块，所述照明设备用于对待测个体的身体特定部位进行照射；所述摄像设备用于采集被照射部位的视频图像；所述信号采集模块用于获取所述摄像设备获得的预定时间内的多帧图像，并基于所述图像提取PPG信号；所述信号处理模块中包含有UNet-ANN多支路反馈加强模型，所述UNet-ANN多支路反馈加强模型基于所述PPG信号进行多参数生理信息检测。根据权利要求1所述的多参数生理信息检测系统，其特征在于，还包括数据处理模块，所述数据处理模块用于将所采集的视频图像进行分帧处理，将每一帧图像的R通道像素值加权求和，最后组合成一段连续的“PPG信号”。2.根据权利要求1所述的多参数生理信息检测系统，其特征在于，所述UNet-ANN多支路反馈加强模型包括非对称的UNet主干网络和多分支ANN网络，所述多分支ANN网络中的每个分支分别用于进行一种生理信息参数的检测。3.根据权利要求1所述的多参数生理信息检测系统，其特征在于，所述UNet主干网络中输入信号的通道数小于采样点数，输出信号的通道数大于采样点数。4.根据权利要求3所述的多参数生理信息检测系统，其特征在于，所述生理信息参数包括心率、血氧、收缩压以及舒张压中的一种或多种。5.根据权利要求4所述的多参数生理信息检测系统，其特征在于，所述UNet-ANN多支路反馈加强模型基于待测个体的心率和血氧的真实值与检测值之差作为反馈条件进行UNet主干网络的参数调整。6.根据权利要求1所述的多参数生理信息检测系统，其特征在于，所述摄像设备还用于拍摄待测个体的人脸视频，并且基于所述人脸视频进行待测个体的性别判定。7.根据权利要求1所述的多参数生理信息检测系统，其特征在于，所述数据处理模块用于将指端“PPG信号”进行0.5-8HZ椭圆带通滤波处理，检测异常点并清洗；将30秒的“PPG信号”中进行分窗，窗宽256采样点，步长150采样点；判断清洗分窗过后的数据是否有符合数据质量要求的数据段，并提取相应数据段。8.一种多参数生理信息检测模型构建方法，其特征在于，所述方法包括：步骤1)、利用智能移动设备的闪光灯对待测个体的身体部位末端进行照射；步骤2)、利用所述智能移动设备的摄像头采集待测个体的多帧连续图像；步骤3)、基于所述图像提取末端PPG信号并对所述末端PPG信号进行处理；步骤4)、构建UNet-ANN多支路反馈加强模型；步骤5)、利用经标注的指端PPG信号对所述加强模型进行训练。9.根据权利要求8所述的方法，其特征在于，对所述末端PPG信号进行处理的步骤包括：步骤2.1:将所获得的视频分帧，将每一帧图像的R通道像素值加权求和，组合成一段连续的“PPG信号”；步骤2.2:将PPG信号进行0.5-8HZ椭圆带通滤波处理，检测异常点并清洗；步骤2.3:将PPG信号进行分窗；步骤2.4:判断清洗分窗过后的数据进行数据段提取并按照步骤S3进行检验，若校验合格则进行下一步，否则重新采集数据；步骤S3：PPG信号的提取，该步骤包括：步骤3.1:对处理后的PPG信号查找峰值点，找到PPG信号中的峰值点和谷值点；步骤3.2：由步骤3.1找出的峰值点、谷值点的最大值max，最小值min通过公式d＝/min分别计算表征峰值点的波动情况的d_peak和表征谷值点的波动情况的d_valley，若d_peak＜0.05且d_valley＜0.08，则保留该段PPG数据；步骤3.3：基于峰值点、谷值点的数量，判断当前信号窗口内包含的周期数是否少于预定值，若少于则采用第二提取方案；第二提取方案：步骤3.4将处理后的PPG信号划分成单个周期的窗口步骤3.5：计算相邻周期波形的相关系数r，若r＞相关系数预阈值，则保留该段PPG信号；步骤3.6：若步骤2处理后的PPG信号对于两种提取标准皆不满足，则直接删除该段PPG信号。
说明书desc
技术领域本发明涉及医疗仪器领域，具体涉及一种生理信息检测系统。背景技术面对人口老龄化及上班族日常工作高强度趋势，常规生理指标的随时随地监测，成为迫切需求。以上需求中，血压的精确测量是一个难点。血压作为人体生理信号的重要指标，可以反应人体心血管功能，异常的血压值对人体最大的危害在于可能引起心，脑，肾等重要器官的损害，如脑梗，肾动脉狭窄，心肌梗死等。所以日常对血压的监测，充分了解个体自身的血压实时情况及动态变化情况对于个体的健康监护有十分重要的意义。1.目前市面上用于生理指标检测的设备大多功能独立，比如用于血氧检测的指夹式脉搏血氧仪，用于血压检测的血压计。很少有集成的一站式的多生理参数检测的综合设备。2.目前市面上对血压的检测设备分机械式和电子式两大类。机械的指水银血压计，通过袖带加压，听诊器分辨脉波音测量血压值。该方法需要专业人员操作，这种测量方式可能会引发白大褂效应，即测量时因为面对医生血压和正常情况有差异，袖带的加压会使得受试者不适。电子类又可以分为电子血压计和带有血压测量功能的智能手表。电子血压计与水银血压计相对，只是用电子听音代替的人的听音，没有了医生白大褂影响，也更加客观稳定。但是基于袖带加压的方式还是没有改变，基于体积问题也不方便携带。虽说现在有集成微型气泵、双层窄气囊的血压测量手表，但其整体重量偏重，加上表带下气囊设计会不透气，也不适合日常长期佩戴。而其他带有血压测量功能的智能手表，不论是基于两路PPG信号或是PPG与ECG信号的结合方案测量血压对于硬件要求都比较高，必须搭载在智能手表上。综上所述，现有血压测量方案部分基于袖带加压的测量方式，此种方法一方面不够便捷，另一方面会给被测者带来一定的不适感；部分利用PPG光电信号，该方法依赖于光电传感器等硬件设备。发明内容针对上述问题，本发明希望提供一种既不需要袖带等常规的加压设备，也不依赖于单独的光电传感器等硬件设备的多参数生理信息检测方法及系统。具体而言，本发明提供一种基于智能移动设备的多参数生理信息检测系统，其特征在于，所述智能移动设备包括位于所述智能移动设备同一侧的照明设备和摄像设备，所述检测系统包括：信号采集模块和信号处理模块，所述照明设备用于对待测个体的身体特定部位进行照射；所述摄像设备用于采集被照射部位的视频图像；所述信号采集模块用于获取所述摄像设备获得的预定时间内的多帧图像，并基于所述图像提取PPG信号；所述信号处理模块中包含有UNet-ANN多支路反馈加强模型，所述UNet-ANN多支路反馈加强模型基于所述PPG信号进行多参数生理信息检测。优选地，该系统还包括数据处理模块，所述数据处理模块用于将所采集的视频图像进行分帧处理，将每一帧图像的R通道像素值加权求和，最后组合成一段连续的“PPG信号”。优选地，所述UNet-ANN多支路反馈加强模型包括非对称的UNet主干网络和多分支ANN网络，所述多分支ANN网络中的每个分支分别用于进行一种生理信息参数的检测。优选地，所述UNet主干网络中输入信号的通道数小于采样点数，输出信号的通道数大于采样点数。优选地，所述生理信息参数包括心率、血氧、收缩压以及舒张压中的一种或多种。优选地，所述UNet-ANN多支路反馈加强模型基于待测个体的心率和血氧的真实值与检测值之差作为反馈条件进行UNet主干网络的参数调整。优选地，所述摄像设备还用于拍摄待测个体的人脸视频，并且基于所述人脸视频进行待测个体的性别判定。优选地，所述数据处理模块用于将指端“PPG信号”进行0.5-8HZ椭圆带通滤波处理，检测异常点并清洗；将30秒的“PPG信号”中进行分窗，窗宽256采样点，步长150采样点；判断清洗分窗过后的数据是否有符合数据质量要求的数据段，并提取相应数据段。另一方面，本发明提供一种多参数生理信息检测模型构建方法，其特征在于，所述方法包括：步骤1)、利用智能移动设备的闪光灯对待测个体的身体部位末端进行照射；步骤2)、利用所述智能移动设备的摄像头采集待测个体的多帧连续图像；步骤3)、基于所述图像提取末端PPG信号并对所述末端PPG信号进行处理；步骤4)、构建UNet-ANN多支路反馈加强模型；步骤5)、利用经标注的指端PPG信号对所述加强模型进行训练。优选地，对所述末端PPG信号进行处理的步骤包括：步骤2.1:将所获得的视频分帧，将每一帧图像的R通道像素值加权求和，组合成一段连续的“PPG信号”；步骤2.2:将PPG信号进行0.5-8HZ椭圆带通滤波处理，检测异常点并清洗；步骤2.3:将PPG信号进行分窗；步骤2.4:判断清洗分窗过后的数据进行数据段提取并按照步骤S3进行检验，若校验合格则进行下一步，否则重新采集数据；步骤S3：PPG信号的提取，该步骤包括：步骤3.1:对处理后的PPG信号查找峰值点，找到PPG信号中的峰值点和谷值点；步骤3.2：由步骤3.1找出的峰值点、谷值点的最大值max，最小值min通过公式d＝/min分别计算表征峰值点的波动情况的d_peak和表征谷值点的波动情况的d_valley，若d_peak＜0.05且d_valley＜0.08，则保留该段PPG数据；步骤3.3：基于峰值点、谷值点的数量，判断当前信号窗口内包含的周期数是否少于预定值，若少于则采用第二提取方案；第二提取方案：步骤3.4将处理后的PPG信号划分成单个周期的窗口步骤3.5：计算相邻周期波形的相关系数r，若r＞相关系数预阈值，则保留该段PPG信号；步骤3.6：若步骤2处理后的PPG信号对于两种提取标准皆不满足，则直接删除该段PPG信号。需要说明的是，本发明中所提到的“身体特定部位”“身体末端”指的是能够进行血液相关信息采集的身体部位，比如，手指尖、耳垂或者脚趾尖等。有益效果本发明开创性的提出了利用手机、平板灯智能移动终端的摄像头和灯光的组合获取待测个体末端的视频图像，并从中提取光电容积描记信号，对所获取的视频帧进行加权求和转换为PPG信号采样点。本发明利用获取的PPG信号利用多支路反馈加强模型获取多生理参数指标，可以同时实现基于手机的、无需专业设备的多种生理参数的同步测量。相比于指夹式脉搏血氧仪这种固定在指端，有定波长段发射光和对应光电传感器获取的PPG信号，从手机后置摄像头中获取的PPG信号较为不稳定，所以，目前现有设备和方法中都无法基于从手机后置摄像头中获取指端连续视频帧中提取的PPG进行有效的血氧、血压等参数进行测定。但是，本发明通过对数据的处理和模型的设计调整，实现了基于手机采集的PPG信号的提取和利用，并且经实验验证，具有较高的准确率。本发明的多支路反馈加强模型由Unet主干网络配合多个ANN支路共同预测心率，血氧，血压值。在模型的预训练阶段，先利用心率，血氧两支路的反馈优化Unet主干网络。然后固定主干网络，在此基础上训练血压预测支路。此外，本发明利用前置摄像头获取的人像预测的性别，年龄信号修正模型预测结果注：虽说血压是一个个体差异较大的生理指标，但在大样本下其与个体年龄，性别等信号还是有一定统计学意义的。结合从人像中获取的个体信息，如果模型预测生理指标与统计学预测结果差异过大，可以提示受试者进行二次测量。三次测量结果依旧没有太大波动即可。本发明的系统和方法一定程度上避免了一些偶然误差和极端结果。附图说明图1是本发明的系统进行参数检测的流程图图2是本发明中重构指端PPG信号的过程示意图图3是本发明中模型的整体框架的示意图图4是本发明中模型的主干网络Unet详细框架图图5是本发明中模型的分支网络详细框架图具体实施方式本实施例的基于智能移动设备的多参数生理信息检测系统以智能手机为例进行描述，当然，也可以采用平板电脑等其他智能移动设备来实现本发明的系统。智能移动设备需要具有位于同一侧的照明设备和摄像设备，目前主要采用其后置摄像头，这样才能够在同一侧既实现照明，又实现图像的采集。当然，对于一些特殊情况，也可以采用辅助光源进行照明，然后利用移动设备的摄像头进行图像采集。本实施例的检测系统包括：信号采集模块和信号处理模块。本实施例中，信息采集硬件设备包括：手机闪光灯，手机后置摄像头。闪光灯用于对人体的指端或耳端进行照射；摄像头用于采集被照射部位的视频图像；信号采集模块用于获取所述摄像设备获得的20-40s，比如30s内的多帧图像，并基于所述图像提取PPG信号；所述信号处理模块中包含有UNet-ANN多支路反馈加强模型，所述UNet-ANN多支路反馈加强模型基于所述PPG信号进行多参数生理信息检测。信号处理模块搭载多支路反馈加强算法网络的应用程序，在移动设备的处理器内运行。本发明可以利用手机摄像头，灯光和应用程序实现人体生理指标的测量，保存与分析系统。具体模型训练及参数测量如下：S1：数据采集步骤1.1:另被测人员稍作休息，确保自身各项生理指标处于平稳状态；步骤1.2:将手机视频录制设置为60fps或根据精度进行调整。步骤1.3:用手机前置摄像头采集人脸视频并保存。需要说明的是，步骤1.1-1.3可以在系统中单独设置登录设置模块来实现，为可选模块，主要用于进行人员信息登录确认以及手机参数调整。步骤1.4:将手指按于手机灯光及与其相连的后置摄像头，保持安静平稳的状态，采集指端连续图像帧30秒。S2：数据处理步骤2.1:将步骤1.3中得到的指端视频分帧，将每一帧图像的R通道像素值加权求和，最后组合成一段连续的指端“PPG信号”。步骤2.2:将指端“PPG信号”进行0.5-8HZ椭圆带通滤波处理，检测异常点并清洗。步骤2.3:将30秒的“PPG信号”中进行分窗，窗宽256采样点，步长150采样点。步骤2.4:判断清洗分窗过后的数据进行数据段提取并按照步骤S3进行检验，若有则进行下一步，否则返回1.3重新采集数据S3：PPG信号的提取第一提取方案步骤3.1:将处理后的PPG信号通过查找峰值点，谷值点算法找到PPG信号中的峰值点和谷值点。步骤3.2：由步骤3.1找出的峰值点、谷值点的最大值，最小值通过公式d＝/min分别计算d_peak和d_valley，若d_peak＜0.05且d_valley＜0.08，则保留该段PPG数据；步骤3.3：基于峰值点、谷值点的数量，判断当前信号窗口内包含的周期数是否少于预定值，则采用第二提取方案。第二提取方案：3.4将预处理后的PPG信号划分成多个单周期的窗口。步骤3.5：计算相邻周期波形的相关系数r，若r＞0.85则保留该段PPG信号。步骤3.6：若步骤2处理后的PPG信号对于以上两种提取标准皆不满足，则直接删除该段PPG信号。S4：模型预测步骤4.1:调用openCV库从步骤1.2中获取的人脸视频中判断受试者的性别、年龄信息。步骤4.2:将预处理后的指端“PPG信号”输入预训练好的UNet-ANN多支路反馈加强模型得到预测心率，血氧，血压值。该模型的具体结构在下面进一步详细论述。步骤4.3:结合4.1获取的受试者信息调整3.2模型。S5：结果保存步骤5.1:选择是否保存已测量结果步骤5.2:若5.1选择保存，则将结果保存至个人数据中并进行一个统计分析。注：心率，血氧，血压预测模型详细的介绍本实施例中的UNet-ANN多支路反馈加强模型分主干网络和分支网络两大部分。主干网络采用Unet网络，分支网络采用ANN分支网络，本实施例中采用单Unet网络，四ANN分支网络的结构构型。1.Unet网络结构：原始的Unet是一个对称结构，本发明中的Unet作为特征提取模块对其进行了调整，采用了非对称结构。Unet网络最初是为了解决医学图像分割问题而创建的，Unet网络利用U型网络结构获取上下文信息和位置信息。本实施例中，该非对称Unet主干网络主要分左右两个模块。左边模块包括四层，每层主要由4个两级3*1的卷积核加2*1下采样子模块组成。右边模块也包括四层，每层由4个两级3*1的卷积核加2*1上采样子模块组成，左右模块之间每层通过拼接相连，从最右侧进行输出。而非对称性体现在输入层与输出层的差别，输入层是1通道256采样点长度的PPG信号，而输出层是1024通道2采样点长度的多特征信号。本发明中的改进型Unet结构用一维卷积代替了图像的二维卷积，在最后一层用多个输出通道代替原Unet中单通道以获取多个特征值，分别送入到各个ANN分支网络。如图4所示，以1通道256采样点长度的PPG信号作为输入，将其输入主干网络Unet，在两级3*1的卷积网络下变为64通道256采样点长度的信号；该信号经2*1下采样网络变为64通道128采样点长度的信号；在两级3*1的卷积网络下变为128通道128采样点长度的信号；经2*1下采样网络变为128通道64采样点长度的信号；在两级3*1的卷积网络下变为256通道64采样点长度的信号；经2*1下采样网络变为256通道32采样点长度的信号；在两级3*1的卷积网络下变为512通道32采样点长度的信号；经2*1下采样网络变为512通道16采样点长度的信号；在两级3*1的卷积网络下变为1024通道16采样点长度的信号；经2*1上采样网络变为512通道32采样点长度的信号；该512通道32采样点长度的信号与左侧512通道32采样点长度的信号拼接形成1024通道32采样点长度的信号；在两级3*1的卷积网络下变为512通道32采样点长度的信号；经2*1上采样网络变为256通道64采样点长度的信号；该256通道64采样点长度的信号与左侧256通道64采样点长度的信号拼接形成512通道64采样点长度的信号；在两级3*1的卷积网络下变为256通道64采样点长度的信号；经2*1上采样网络变为128通道128采样点长度的信号；该128通道128采样点长度的信号与左侧128通道128采样点长度的信号拼接形成256通道128采样点长度的信号；在两级3*1的卷积网络下变为128通道128采样点长度的信号；经2*1上采样网络变为64通道256采样点长度的信号；该64通道256采样点长度的信号与左侧64通道256采样点长度的信号拼接形成128通道256采样点长度的信号；经4*1下采样网络变为128通道64采样点长度的信号；在5*1，步长为3的卷积网络下变为256通道20采样点长度的信号；又在5*1，步长为3的卷积网络下变为512通道6采样点长度的信号；最后在3*1，步长为2的卷积网络下变为1024通道2采样点长度的信号。2.ANN分支网络：分支网络的处理主要是基于主干网络输出层1024通道2采样点长度的多特征信号进行特征组合处理。对于心率和血氧饱和度而言，经过多层卷积的特征处理得到预测值。血压值的高压低压值是一个相关联的数据，他们分别由1024通道2采样点长度的特征信号的一个维度进过卷积处理得到预测值。1024通道2采样点长度的信号经过2*1的卷积网络变为1024通道1采样点长度的信号；1024通道1采样点长度的信号经过1*1的卷积网络变为64通道1采样点长度的信号；64通道1采样点长度的信号经过1*1的卷积网络变为1通道1采样点长度的信号，即预测的心率值。2.1Unet主干网络最后输出的1024通道2采样点长度的信号用于预测血氧1024通道2采样点长度的信号经过2*1的卷积网络变为1024通道1采样点长度的信号；1024通道1采样点长度的信号经过1*1的卷积网络变为256通道1采样点长度的信号；256通道1采样点长度的信号经过1*1的卷积网络变为64通道1采样点长度的信号；64通道1采样点长度的信号经过1*1的卷积网络变为1通道1采样点长度的信号，即预测的血氧值。2.2Unet主干网络最后输出的1024通道2采样点长度的信号用于预测血压取第一维数据1024通道1采样点长度的信号经过1*1的卷积网络变为256通道1采样点长度的信号；256通道1采样点长度的信号经过1*1的卷积网络变为64通道1采样点长度的信号；64通道1采样点长度的信号经过1*1的卷积网络变为1通道1采样点长度的信号，即预测的收缩压。取第二维数据1024通道1采样点长度的信号经过1*1的卷积网络变为256通道1采样点长度的信号；256通道1采样点长度的信号经过1*1的卷积网络变为64通道1采样点长度的信号；64通道1采样点长度的信号经过1*1的卷积网络变为1通道1采样点长度的信号，即预测的舒张压。需要说明的是，虽然上述给出了通道、采样点的具体数目，但是本领域技术人员在实际使用中，可以根据需要调整通道数目和采样点数目，这里不作限制。实验测试，通过本发明所构建的模型，发明人实际测试，选取训练集100人，验证集50人，测试集50人，最终测试效果证明可以应用于实际应用中。心率准确率：90％以上的概率落在+/-3bpm的范围内血氧饱和度准确率：90％以上的概率落在+/-2％的范围内血压准确率：高压SBP85％以上的概率落在+/-10bpm的范围内低压DBP95％以上的概率落在+/-10bpm的范围内。
