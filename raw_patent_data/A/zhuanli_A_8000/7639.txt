标题title
一种基于高光谱图像的中药型益生菌制剂的生产方法及系统
摘要abst
本发明属于高光谱分析、中药型益生菌生产技术领域，提出了一种基于高光谱图像的中药型益生菌制剂的生产方法及系统，具体为：先将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵，然后通过成像光谱仪采集混合液的光谱数据，再对光谱数据进行预处理，获得处理图，最后根据处理图进行实时酵阶分析并计算酵阶水平，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制。对中药型益生菌发酵环境中发酵随时间变化的阶段性进行量化，从而提高了原料的利用率，高效地确保了产品的品质和药效。尤其在批量生产时，能够有效地避免因主观经验判断所引起的大量中药材有效组分酵阶水平低下问题，从而高效地避免了中药材和生产资源的浪费。
权利要求书clms
1.一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，所述方法包括以下步骤：S100，将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵；S200，通过成像光谱仪采集混合液的光谱数据；S300，对光谱数据进行预处理，获得处理图；S400，根据处理图进行实时酵阶分析并计算酵阶水平；S500，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制；其中在步骤S400中，根据处理图进行实时酵阶分析并计算酵阶水平的方法是，将处理图分割成若干划析区，根据划析区内各个像素的灰度值定义灰极像素和灰贫像素，通过灰极像素和灰贫像素的相连直线定位析区中心，再根据析区中心选取参位域，参位域内灰度值的平均值为参位灰析水平；结合各个参位域的参位灰析水平形成参位灰析序列，通过参位灰析序列计算灰析偏移，最后根据参位灰析水平和灰析偏移计算酵阶水平。2.根据权利要求1所述的一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，在步骤S100中，所述将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵的方法是：将中药材进行预处理制成中药粉剂，中药材包括黄柏、黄参、板蓝根、蒲公英中的一种或多种，预处理包括洗净、切碎以及研磨工艺；菌种原液即包含乳杆菌、肠球菌、酵母菌、双歧杆菌、芽孢杆菌属中的一种或多种菌种原液；将中药粉剂与菌种原液充分混合，所形成的混合液放入发酵罐中进行发酵。3.根据权利要求1所述的一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，在步骤S200中，所述通过成像光谱仪采集混合液的光谱数据的方法是：发酵罐侧壁上设有透明采集窗，采集窗材质为石英片或者熔凝硅石中的一种；将高光谱相机固定于采集窗外侧；设立一个时间段作为测量间隔Tgap，Tgap∈分钟，高光谱相机每隔Tgap进行实时测量并获得混合液的光谱数据，并将获得的光谱数据上传至服务器。4.根据权利要求1所述的一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，在步骤S300中，所述对光谱数据进行预处理，获得处理图的方法是：在服务器中，对光谱数据进行预处理，预处理步骤包括进行归一化处理、强度校正和偏移校正，最后通过移动平均法进行图像平滑滤波处理获得处理图。5.根据权利要求1所述的一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，在步骤S400中，根据处理图进行实时酵阶分析并计算酵阶水平的方法是，通过边缘识别算法将光谱数据预处理图像分割成若干个区域，以各个区域分别作为划析区，把划析区的数量记作Ncat；将一个划析区中灰度值最大的像素点和灰度值最小的像素点分别记作灰极像素和灰贫像素，把灰极像素与灰贫像素相连的直线记为灰渐线，灰渐线的距离记为灰渐距离，灰渐线的中点对应的像素点记作析区中心；以析区中心为中心点，灰渐距离为边长形成一个圆形区域作为参位域；将参位域中各个像素点灰度值的算术平均值记作参位灰析水平Cgpl，在一个划析区中各个像素点灰度值的平均值与参位灰析水平的比值记作节向比PAPV；将各个划析区的参位灰析水平构建一个序列记作参位灰析序列Cp_Ls；在参位灰析序列中最大值元素与最小值元素的比值记作灰析偏移CPVT；根据参位灰析水平和节向比计算酵阶水平。6.根据权利要求1所述的一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，在步骤S400中，根据处理图进行实时酵阶分析并计算酵阶水平的方法是，通过超像素分割算法对处理图进行区域划分，将各个所得到的区域分别记作划析区，计算任一划析区内各个像素点的灰度值的平均值记作对应划析区的灰征值；将各个划析区的灰征值按从小到大的顺序构建成序列记作灰征值序列，计算获得灰征值序列中各个元素的平均值记作E_DAPL；灰征值序列中任一元素的第一敏析元素为该元素在灰征值序列中的前一个元素；灰征值序列中任一元素的第二敏析元素为该元素在灰征值序列中的后一个元素； 则任一划析区对应的敏析区为该划析区的敏析元素所对应的划析区；若一个划析区的灰征值小于E_DAPL，则该划析区对应的敏析区为该划析区的第一敏析元素所对应的划析区，否则该划析区对应的敏析区为该划析区的第二敏析元素所对应的划析区；将该划析区的灰征值与敏析区的灰征值的比值记为敏算水平；将划析区内灰度值拥有最大值的像素点记作该划析区的敏析位点；将划析区的敏析位点到其敏析区的敏析位点之间的连线记作敏析紧凑线， 敏析紧凑线的长度作为该划析区的敏析紧凑距离DSA；通过灰征值、敏算水平和敏析紧凑距离计算获得任一划析区的敏抗指标，将与划析区对应敏析紧凑线存在重合像素的各个其他划析区作为该划析区的敏析通道；以一个划析区的敏析通道内各个敏析位点的灰度值对应的最小值作为该划析区的灰征下限FPRZ，获取该敏析通道内灰度值大于FPRZ且不属于该划析区的全部像素点的灰度值形成一个序列记作其子析序列ARV_Ls；通过敏抗指标和子析序列计算获得酵阶水平。7.根据权利要求1所述的一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，在步骤S500中，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制的方法是，预先设定酵阶水平阈值，实时地计算获得酵阶水平，设定一个时间段作为时间段为监测窗TRef，TRef∈分钟，以最近TRef时段内酵阶水平的中位值作为第一酵阶水平；当第一酵阶水平大于酵阶水平阈值，则判断反应终止，并停止发酵进程。8.根据权利要求7所述的一种基于高光谱图像的中药型益生菌制剂的生产方法，其特征在于，在步骤S500中，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制的替代方法是，实时地获取酵阶水平并进行记录；将一个时刻与其前一个时刻获得的酵阶水平的差值作为该时刻的酵阶溢出值；将反发酵进程的最小反应时间长度记作DurBs；发酵进程开始直到其后DurBs时段内各个时刻的酵阶溢出值构成溢出值参考序列；溢出值参考序列的下四分位值记为酵阶溢出阈值；如果当前时刻的酵阶溢出值小于酵阶溢出阈值，则定义当前时刻满足溢出条件；设定一个时间段为监测窗TRef，TRef∈分钟，TRef＜0.5DurBs；在最近TRef内各个酵阶水平中拥有极大值或者极小值的频次占比为震荡比率ExRt；设定一个比率阈值为QRt，QRt∈；若当前时刻的震荡比率大于比率阈值，则定义当前时刻满足震荡条件；如果当前时刻反发酵进程反应时间长度超过DurBs，且满足溢出条件和震荡条件，则判断反应终止，并停止发酵进程。9.一种基于高光谱图像的中药型益生菌制剂的生产系统，其特征在于，所述一种基于高光谱图像的中药型益生菌制剂的生产系统包括：处理器、存储器及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现权利要求1-8中任一项所述的一种基于高光谱图像的中药型益生菌制剂的生产方法中的步骤，所述一种基于高光谱图像的中药型益生菌制剂的生产系统运行于桌上型计算机、笔记本电脑、掌上电脑及云端数据中心的计算设备中。
说明书desc
技术领域本发明属于高光谱分析、中药型益生菌生产技术领域，具体涉及一种基于高光谱图像的中药型益生菌制剂的生产方法及系统。背景技术中草药因其具有促进动物生长发育、提高免疫力以及预防疾病等多种功效，逐渐引起养殖业的广泛关注。为了最大限度地发挥中草药的药理作用，人们引进了生物转化技术，通过微生物发酵能使中草药产生新的活性物质，增强药效，同时降低毒副作用，达到增效减毒的目的。目前，此类中药型益生菌产品已被认为是抗生素的最佳替代品之一。然而，目前的发酵工艺通常依赖于主观经验，通常人为规定中草药在某个特定环境下通过特定菌种的作用发酵若干个小时，就认为工艺完成。事实上，中草药本身组分复杂，在中药型益生菌的生产过程中，益生菌的种类、质量、数量和环境的温度、酸碱度等多种因素都可能对发酵进程有所影响，因此每个批次的中草药所需的发酵时间并不相同。依赖经验的生产方法，一方面经常导致发酵不完全或过度发酵，导致中草药的有效酵阶水平低，影响产品的品质和药效；另一方面，只能在工艺结束后取样进行生化实验来进行产品质量评估，如果质量不合格则浪费了药材和生产资源，变相提高了生产成本和降低了生产效率。因此，需要开发可以实时监控发酵进度的生产方法。发明内容本发明的目的在于提出一种基于高光谱图像的中药型益生菌制剂的生产方法及系统，以解决现有技术中所存在的一个或多个技术问题，至少提供一种有益的选择或创造条件。为了实现上述目的，根据本发明的一方面，提供一种基于高光谱图像的中药型益生菌制剂的生产方法，所述方法包括以下步骤：S100，将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵；S200，通过成像光谱仪采集混合液的光谱数据；S300，对光谱数据进行预处理，获得处理图；S400，根据处理图进行实时酵阶分析并计算酵阶水平；S500，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制。进一步地，在步骤S100中，所述将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵的方法是：将中药材进行预处理制成中药粉剂，中药材包括黄柏、黄参、板蓝根、蒲公英等，预处理包括洗净、切碎以及研磨工艺；菌种原液即包含乳杆菌、肠球菌、酵母菌、双歧杆菌、芽孢杆菌属中的一种或多种菌种原液，其中菌种原液可替换为益生菌培养液；将中药粉剂与菌种原液充分混合，所形成的混合液放入发酵罐中进行发酵。进一步地，在步骤S200中，所述通过成像光谱仪采集混合液的光谱数据的方法是：发酵罐侧壁上设有透明采集窗，采集窗材质为石英片或者熔凝硅石中的一种；将高光谱相机固定于采集窗外侧；设立一个时间段作为测量间隔Tgap，Tgap∈分钟，高光谱相机每隔Tgap进行实时测量并获得混合液的光谱数据，并将获得的光谱数据上传至服务器。进一步地，在步骤S300中，所述对光谱数据进行预处理，获得处理图的方法是：在服务器中，对光谱数据进行预处理，预处理步骤包括进行归一化处理、强度校正和偏移校正，最后通过移动平均法进行图像平滑滤波处理获得处理图，将处理图的像素值记为灰度值。通过预处理使不同时刻的混合液光谱数据更具可比性，再进行散射校正，避免细小中药颗粒散射引起的干扰。进一步地，在步骤S400中，根据处理图进行实时酵阶分析并计算酵阶水平的方法是，通过边缘识别算法将光谱数据预处理图像分割成若干个区域，以各个区域分别作为划析区，把划析区的数量记作Ncat；将一个划析区中灰度值最大的像素点和灰度值最小的像素点分别记作灰极像素和灰贫像素，把灰极像素与灰贫像素相连的直线记为灰渐线，灰渐线的距离记为灰渐距离，灰渐线的中点对应的像素点记作析区中心；以析区中心为中心点，灰渐距离为边长形成一个圆形区域作为参位域；将参位域中各个像素点灰度值的算术平均值记作参位灰析水平Cgpl，在一个划析区中各个像素点灰度值的平均值与参位灰析水平的比值记作节向比PAPV；将各个划析区的参位灰析水平构建一个序列记作参位灰析序列Cp_Ls；在参位灰析序列中最大值元素与最小值元素的比值记作灰析偏移CPVT；根据参位灰析水平和节向比计算酵阶水平CVR：；其中j1为累加变量，Cp_Ls表示参位灰析序列的第j1个元素，ECgpl为参位灰析序列的中位数，exp为自然常数e为底数的指数函数，hs＜＞为调和平均值函数。由于上述酵阶水平是结合参位灰析水平计算获得，有效的获取预处理图像中具有高效特征的灰度值信息，并且对获取的各个灰度值数据进行分层量化分析，然而这种的收集信息方式会出现缺少了部分有效信息参与量化的现象，尤其是当区域内各个像素的灰度值水平相似的情况，这会导致计算出的酵阶水平在判断发酵进程上不够精确，但是现有技术无法解决酵阶水平在判断上的延迟性和识别不够精确的问题，为了使参位灰析水平信息更加全面，对酵阶水平的应用上适应性更强，所以本发明提出了一个更优选的方案。优选地，在步骤S400中，根据处理图进行实时酵阶分析并计算酵阶水平的方法是，通过超像素分割算法对处理图进行区域划分，将各个所得到的区域分别记作划析区，计算任一划析区内各个像素点的灰度值的平均值记作对应划析区的灰征值DAPL；将各个划析区的灰征值按从小到大的顺序构建成序列记作灰征值序列，计算获得灰征值序列中各个元素的平均值记作E_DAPL；灰征值序列中任一元素的第一敏析元素为该元素在灰征值序列中的前一个元素；灰征值序列中任一元素的第二敏析元素为该元素在灰征值序列中的后一个元素； 则任一划析区对应的敏析区为该划析区的敏析元素所对应的划析区；若一个划析区的灰征值小于E_DAPL，则该划析区对应的敏析区为该划析区的第一敏析元素所对应的划析区，否则该划析区对应的敏析区为该划析区的第二敏析元素所对应的划析区；将该划析区的灰征值与敏析区的灰征值的比值记为敏算水平SAPL；其中灰征值序列中的首个或者末尾的元素存在无法识别形成敏析区的情况，则后续运算将该划析区忽略。将划析区内灰度值拥有最大值的像素点记作该划析区的敏析位点；将划析区的敏析位点到其敏析区的敏析位点之间的连线记作敏析紧凑线， 敏析紧凑线的长度作为该划析区的敏析紧凑距离DSA；通过灰征值、敏算水平和敏析紧凑距离计算获得任一划析区的敏抗指标SRI，其计算方法为：；其中exp为自然常数e为底数的指数函数；将与划析区对应敏析紧凑线存在重合像素的各个其他划析区作为该划析区的敏析通道；其中与划析区对应敏析紧凑线存在重合像素的各个其他划析区指的是，如果一个划析区中任一个元素为敏析紧凑线所在的直线上，则定义该划析区与敏析紧凑线存在重合。以一个划析区的敏析通道内各个敏析位点的灰度值对应的最小值作为该划析区的灰征下限FPRZ，获取该敏析通道内灰度值大于FPRZ且不属于该划析区的全部像素点的灰度值形成一个序列记作其子析序列ARV_Ls；通过敏抗指标、灰征下限和子析序列计算获得酵阶水平CVR，其计算方法为：；其中，i1为累加变量，NEA为划析区的总数量，FPRZi1为第i1个划析区的灰征下限，ARV_Ls为第i1个划析区的子析序列，rds＜＞为极差比例函数，通过极差函数极差比例函数，分别对调用序列中各个元素与调用序列中的最小值形成比值，并返回这些比值的平均值。有益效果：实时根据高光谱图像对中草药的酵阶水平进行计算并根据量化结果判断发酵进程，对中药型益生菌发酵环境中进程或发酵随时间变化的阶段性进行量化，从而使中药材中的有效组分在发酵过程中能最大程度上转化成活性物质，并有效降低了活性物质因发酵过度而失活的风险，从而大大提高了原料的利用率，高效地确保了产品的品质和药效。尤其在批量生产时，能够有效地避免因主观经验判断所引起的大量中药材有效组分酵阶水平低下问题，从而极大程度上避免了中药材和生产资源的浪费，大大降低了生产成本，为中药型益生菌制剂批量生产提供有力的技术支持。进一步地，在步骤S500中，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制的方法是，预先设定酵阶水平阈值，实时地计算获得酵阶水平，设定一个时间段作为时间段为监测窗TRef，TRef∈分钟，以最近TRef时段内酵阶水平的中位值作为第一酵阶水平；当第一酵阶水平大于酵阶水平阈值，则判断反应终止，并停止发酵进程。由于上述方法对预先设定的阈值具有一定的依赖性，使得实际操作的过程动态识别性或者应变能力不足，对调试人员的人员要求较高，因此本发明提出了一个更优选的方案如下：优选地，在步骤S500中，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制的替代方法是，实时地获取酵阶水平并进行记录；将一个时刻与其前一个时刻获得的酵阶水平的差值作为该时刻的酵阶溢出值；将反发酵进程的最小反应时间长度记作DurBs；发酵进程开始直到其后DurBs时段内各个时刻的酵阶溢出值构成溢出值参考序列；溢出值参考序列的下四分位值记为酵阶溢出阈值；如果当前时刻的酵阶溢出值小于酵阶溢出阈值，则定义当前时刻满足溢出条件；设定一个时间段为监测窗TRef，TRef∈分钟，TRef＜0.5DurBs；在最近TRef内各个酵阶水平中拥有极大值或者极小值的频次占比为震荡比率ExRt；设定一个比率阈值为QRt，QRt∈，设定QRt的默认值为0.4。若当前时刻的震荡比率大于比率阈值，则定义当前时刻满足震荡条件；如果当前时刻反发酵进程反应时间长度超过DurBs，且满足溢出条件和震荡条件，则判断反应终止，并停止发酵进程。震荡比率的具体计算方法是：将最近TRef内各个酵阶水平按计算获得的顺序形成酵阶水平序列，若酵阶水平序列中任一个元素较其前一个元素和后一个元素都大，或者较其前一个元素和后一个元素都小，则定义这样的元素为极值元素，酵阶水平序列中极值元素的数量与酵阶水平序列中元素的总数量的比值记作ExRt。优选地，其中，本发明中所有未定义的变量，若未有明确定义，均可为人工设置的阈值。本发明还提供了一种基于高光谱图像的中药型益生菌制剂的生产系统，所述一种基于高光谱图像的中药型益生菌制剂的生产系统包括：处理器、存储器及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现所述一种基于高光谱图像的中药型益生菌制剂的生产方法中的步骤，所述一种基于高光谱图像的中药型益生菌制剂的生产系统可以运行于桌上型计算机、笔记本电脑、掌上电脑及云端数据中心等计算设备中，可运行的系统可包括，但不仅限于，处理器、存储器、服务器集群，所述处理器执行所述计算机程序运行在以下系统的单元中：发酵初始触发单元，用于将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵；数据采集单元，用于通过成像光谱仪采集混合液的光谱数据；图形预处理单元，用于对光谱数据进行预处理，获得处理图；酵阶分析单元，用于根据处理图进行实时酵阶分析并计算酵阶水平；动态判别控制单元，用于通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制。本发明的有益效果为：本发明提供一种基于高光谱图像的中药型益生菌制剂的生产方法及系统，通过近红外光谱分析技术获取光谱数据，对中药型益生菌发酵环境中进程或发酵随时间变化的阶段性进行量化，从而使中药材中的有效组分在发酵过程中能更大程度上转化成活性物质，同时有效降低了活性物质因发酵过度而失活的风险，从而大大提高了原料的利用率，高效地确保了产品的品质和药效。尤其在批量生产时，能够有效地避免因主观经验判断所引起的大量中药材有效组分酵阶水平低下问题，从而高效地避免了中药材和生产资源的浪费，大大降低了生产成本，为中药型益生菌批量生产提供有力的技术支持。附图说明通过对结合附图所示出的实施方式进行详细说明，本发明的上述以及其他特征将更加明显，本发明附图中相同的参考标号表示相同或相似的元素，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图，在附图中：图1所示为一种基于高光谱图像的中药型益生菌制剂的生产方法的流程图；图2所示为一种基于高光谱图像的中药型益生菌制剂的生产系统结构图。具体实施方式以下将结合实施例和附图对本发明的构思、具体结构及产生的技术效果进行清楚、完整的描述，以充分地理解本发明的目的、方案和效果。需要说明的是，在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。如图1所示为一种基于高光谱图像的中药型益生菌制剂的生产方法的流程图，下面结合图1来阐述根据本发明的实施方式的一种基于高光谱图像的中药型益生菌制剂的生产方法，所述方法包括以下步骤：实施例1，S100，将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵；S200，通过成像光谱仪采集混合液的光谱数据；S300，对光谱数据进行预处理，获得处理图；S400，根据处理图进行实时酵阶分析并计算酵阶水平；S500，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制。进一步地，在步骤S100中，所述将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵的方法是：将中药材进行预处理制成中药粉剂，中药材包括黄柏、黄参、板蓝根以及蒲公英，预处理包括洗净、切碎以及研磨工艺；菌种原液即包含乳杆菌、肠球菌、酵母菌、双歧杆菌以及芽孢杆菌属的菌种原液；将中药粉剂与菌种原液充分混合，所形成的混合液放入发酵罐中进行发酵。进一步地，在步骤S200中，所述通过成像光谱仪采集混合液的光谱数据的方法是：发酵罐侧壁上设有透明采集窗，采集窗材质为石英片；将高光谱相机固定于采集窗外侧；设立一个时间段作为测量间隔Tgap，其取值为10分钟，高光谱相机每隔Tgap进行实时测量并获得混合液的光谱数据，并将获得的光谱数据上传至服务器。进一步地，在步骤S300中，所述对光谱数据进行预处理，获得处理图的方法是：在服务器中，对光谱数据进行预处理，预处理步骤包括进行归一化处理、强度校正和偏移校正，最后通过移动平均法进行图像平滑滤波处理获得处理图，将处理图的像素值记为灰度值。进一步地，在步骤S400中，根据处理图进行实时酵阶分析并计算酵阶水平的方法是，通过边缘识别算法将光谱数据预处理图像分割成若干个区域，以各个区域分别作为划析区，把划析区的数量记作Ncat；将一个划析区中灰度值最大的像素点和灰度值最小的像素点分别记作灰极像素和灰贫像素，把灰极像素与灰贫像素相连的直线记为灰渐线，灰渐线的距离记为灰渐距离，灰渐线的中点对应的像素点记作析区中心；以析区中心为中心点，灰渐距离为边长形成一个圆形区域作为参位域；将参位域中各个像素点灰度值的算术平均值记作参位灰析水平Cgpl，在一个划析区中各个像素点灰度值的平均值与参位灰析水平的比值记作节向比PAPV；将各个划析区的参位灰析水平构建一个序列记作参位灰析序列Cp_Ls；在参位灰析序列中最大值元素与最小值元素的比值记作灰析偏移CPVT；根据参位灰析水平和节向比计算酵阶水平CVR：；其中j1为累加变量，Cp_Ls表示参位灰析序列的第j1个元素，ECgpl为参位灰析序列的中位数，exp为自然常数e为底数的指数函数，hs＜＞为调和平均值函数。优选地，在步骤S500中，通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制的替代方法是，实时地获取酵阶水平并进行记录；将一个时刻与其前一个时刻获得的酵阶水平的差值作为该时刻的酵阶溢出值；将反发酵进程的最小反应时间长度记作DurBs；发酵进程开始直到其后DurBs时段内各个时刻的酵阶溢出值构成溢出值参考序列；溢出值参考序列的下四分位值记为酵阶溢出阈值；如果当前时刻的酵阶溢出值小于酵阶溢出阈值，则定义当前时刻满足溢出条件；设定一个时间段为监测窗TRef为30分钟；在最近TRef内各个酵阶水平中拥有极大值或者极小值的频次占比为震荡比率ExRt；设定一个比率阈值为QRt，QRt，设定QRt的值为0.4。若当前时刻的震荡比率大于比率阈值，则定义当前时刻满足震荡条件；如果当前时刻反发酵进程反应时间长度超过DurBs，且满足溢出条件和震荡条件，则判断反应终止，并停止发酵进程。实施例2，采用在实施例1的方法制备中药型益生菌，实施例2与实施例1的区别在于，在步骤S400中，根据处理图进行实时酵阶分析并计算酵阶水平的方法是，通过超像素分割算法对处理图进行区域划分，将各个所得到的区域分别记作划析区，计算任一划析区内各个像素点的灰度值的平均值记作对应划析区的灰征值DAPL；将各个划析区的灰征值按从小到大的顺序构建成序列记作灰征值序列，计算获得灰征值序列中各个元素的平均值记作E_DAPL；灰征值序列中任一元素的第一敏析元素为该元素在灰征值序列中的前一个元素；灰征值序列中任一元素的第二敏析元素为该元素在灰征值序列中的后一个元素； 则任一划析区对应的敏析区为该划析区的敏析元素所对应的划析区；若一个划析区的灰征值小于E_DAPL，则该划析区对应的敏析区为该划析区的第一敏析元素所对应的划析区，否则该划析区对应的敏析区为该划析区的第二敏析元素所对应的划析区；将该划析区的灰征值与敏析区的灰征值的比值记为敏算水平SAPL；将划析区内灰度值拥有最大值的像素点记作该划析区的敏析位点；将划析区的敏析位点到其敏析区的敏析位点之间的连线记作敏析紧凑线， 敏析紧凑线的长度作为该划析区的敏析紧凑距离DSA；通过灰征值、敏算水平和敏析紧凑距离计算获得任一划析区的敏抗指标SRI，其计算方法为：；其中exp为自然常数e为底数的指数函数； 将与划析区对应敏析紧凑线存在重合像素的各个其他划析区作为该划析区的敏析通道；以一个划析区的敏析通道内各个敏析位点的灰度值对应的最小值作为该划析区的灰征下限FPRZ，获取该敏析通道内灰度值大于FPRZ且不属于该划析区的全部像素点的灰度值形成一个序列记作其子析序列ARV_Ls；通过敏抗指标、灰征下限和子析序列计算获得酵阶水平CVR，其计算方法为：；其中，i1为累加变量，NEA为划析区的总数量，FPRZi1为第i1个划析区的灰征下限，ARV_Ls为第i1个划析区的子析序列，rds＜＞为极差比例函数，通过极差函数极差比例函数，分别对调用序列中各个元素与调用序列中的最小值形成比值，并返回这些比值的平均值，其中ln为自然常数e为底数的对数函数。对比例与实施例1的区别是，将发酵时长设定为5×24小时。表1 活性成分获取对比*总多糖、生物碱、类黄酮及总皂苷是中草药的主要活性成分。表2 中药型益生菌制剂分别作为鸡饲料辅料的效果对比*免疫器官指数=×1000。如上所示，表1为中草药的主要活性成分在不同发酵终止过程中的制备效果，可见通过本方法生产中药型益生菌制剂的实施例1和实施例2，其获取活成成分的效果均有不同程度的提升，对生产率和制备效果达到更优效果。表2为应用不同发酵终止方法形成中药型益生菌制剂分别作为鸡饲料辅料的效果对比，进一步可见本方法在发酵进程实行智能判别的提升效果。本发明的实施例提供的一种基于高光谱图像的中药型益生菌制剂的生产系统，如图2所示为本发明的一种基于高光谱图像的中药型益生菌制剂的生产系统结构图，该实施例的一种基于高光谱图像的中药型益生菌制剂的生产系统包括：处理器、存储器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述一种基于高光谱图像的中药型益生菌制剂的生产系统实施例中的步骤。所述系统包括：存储器、处理器以饲料辅料吧及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序运行在以下系统的单元中：发酵初始触发单元，用于将中药粉剂与菌种原液组成的混合液加入发酵罐中进行发酵；数据采集单元，用于通过成像光谱仪采集混合液的光谱数据；图形预处理单元，用于对光谱数据进行预处理，获得处理图；酵阶分析单元，用于根据处理图进行实时酵阶分析并计算酵阶水平；动态判别控制单元，用于通过实时获得的酵阶水平与其历史数据对发酵进程进行动态判别和控制。所述一种基于高光谱图像的中药型益生菌制剂的生产系统可以运行于桌上型计算机、笔记本电脑、掌上电脑及云端服务器等计算设备中。所述一种基于高光谱图像的中药型益生菌制剂的生产系统，可运行的系统可包括，但不仅限于，处理器、存储器。本领域技术人员可以理解，所述例子仅仅是一种基于高光谱图像的中药型益生菌制剂的生产系统的示例，并不构成对一种基于高光谱图像的中药型益生菌制剂的生产系统的限定，可以包括比例子更多或更少的部件，或者组合某些部件，或者不同的部件，例如所述一种基于高光谱图像的中药型益生菌制剂的生产系统还可以包括输入输出设备、网络接入设备、总线等。所称处理器可以是中央处理单元，还可以是其他通用处理器、数字信号处理器 、专用集成电路、现场可编程门阵列  或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等，所述处理器是所述一种基于高光谱图像的中药型益生菌制剂的生产系统运行系统的控制中心，利用各种接口和线路连接整个一种基于高光谱图像的中药型益生菌制剂的生产系统可运行系统的各个部分。所述存储器可用于存储所述计算机程序和/或模块，所述处理器通过运行或执行存储在所述存储器内的计算机程序和/或模块，以及调用存储在存储器内的数据，实现所述一种基于高光谱图像的中药型益生菌制剂的生产系统的各种功能。所述存储器可主要包括存储程序区和存储数据区，其中，存储程序区可存储操作系统、至少一个功能所需的应用程序等；存储数据区可存储根据手机的使用所创建的数据等。此外，存储器可以包括高速随机存取存储器，还可以包括非易失性存储器，例如硬盘、内存、插接式硬盘，智能存储卡，安全数字卡，闪存卡、至少一个磁盘存储器件、闪存器件、或其他易失性固态存储器件。尽管本发明的描述已经相当详尽且特别对几个所述实施例进行了描述，但其并非旨在局限于任何这些细节或实施例或任何特殊实施例，从而有效地涵盖本发明的预定范围。此外，上文以发明人可预见的实施例对本发明进行描述，其目的是为了提供有用的描述，而那些目前尚未预见的对本发明的非实质性改动仍可代表本发明的等效改动。
