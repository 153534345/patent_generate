标题title
一种基于人工智能的动态干眼预警方法与系统
摘要abst
本发明公开了一种基于人工智能的动态干眼预警方法与系统，利用一种智能装置获取眼表RGB图片，采集用户主诉信息和眼表代谢数据；数据处理模块对图像数据进行预处理；算法模块基于预处理后的训练数据集，利用DenseNet121、ARIMA、Softmax回归模型等分别建立短期预测模型和长期预测模型，动态干眼预警系统基于人工智能算法自动分析出用户未来出现干眼体征异常和患干眼症的概率，并提供实时的可视化图，当用户有较大可能出现干眼体征异常或患干眼症时发出预警。本发明能够实时预测用户未来一定时期内的干眼概率，解决传统方法中不能动态预测未来干眼的问题，降低用户干眼发病率。
权利要求书clms
1.一种基于人工智能的动态干眼预警方法，其特征在于，所述系统包括：建立短期预测模型和长期预测模型；短期预测是指对出现泪膜破裂时间异常、泪河高度异、脂质层异常、腺体开口异常、结膜异常等干眼体征异常概率的预测；长期预常测是指对患干眼症疾病概率的预测；所述动态干眼预警系统，通过检测短期预测模型结合主诉及代谢物数据进一步实现长期预测模型，步骤如下：步骤1：进行数据采集包括图像采集即眼表视频及RGB图片、主诉信息采集和眼表代谢数据采集；步骤2：将采集的眼表视频及RGB图片进行数据增强处理、并结合主诉信息、眼表代谢数据进行数据预处理；步骤3：基于经过数据处理模块处理后的眼表RGB图片，用DenseNet121模型构建四个干眼体征分类模型，分别计算用户出现泪膜破裂时间异常、泪河高度异常、脂质层异常、腺体开口异常、眼红异常的概率；其中在检测泪膜破裂时间异常后，进一步分析所述泪膜破裂时间异常与泪河高度异常、脂质层异常、腺体开口异常、眼红异常的关联性，并通过关联挖掘算法，预测泪河高度异常、脂质层异常、腺体开口异常、眼红异常的异常值，所述关联规则采用Apriori算法对这四种异常进行关联挖掘；通过计算泪河破裂时间异常程度，并与其他四类病例异常共现的频率，作为支持度和置信度的判定条件；并验证深度学习算法预测出来的泪河高度异常、脂质层异常、腺体开口异常、眼红异常的概率值；所述检测检测泪膜破裂时间异常的方法包括，对泪膜所在区域进行图像裁剪；基于卷积神经网络，对泪河区域图像进行分割和泪膜层特征进行聚类；通过颜色和粘稠度识别黏蛋白层、中间水液层和脂质层的厚度，采用聚类修正模块，对聚类边缘进行提取，然后在黏蛋白层、中间水液层竖直方向0.1微米内寻找最大梯度的位置并更新原来的边缘位置；判别泪膜层中各层的厚度；基于黏蛋白层、中间水液层和脂质层三层的厚度比例，预测泪膜破裂时间，并与正常破裂时间进行比较，获得异常程度；步骤4：对出现干眼体征异常进行预测分析；所述出现干眼体征异常进行预测，利用差分整合移动平均自回归模型建立短期预测模型，预测用户在预设时期内出现干眼体征异常的概率；所述概率的预测采用动态检测方式，持续动态检测；步骤5：填写OSDI干眼问卷，根据动态检测中间过程的结果，调整OSDI干眼问卷的内容；步骤6：对患干眼症进行预测分析；所述患干眼症概率的预测，基于ARIMA模型、OSDI评分指数和Softmax回归模型的长期预测模型，模型公式为：其中，是在未来预测患干眼症的概率x1为图像数据，fARIMAj为ARIMA模型输出的出现泪膜破裂时间异常、泪河高度异常、脂质层异常、腺体开口异常、眼红异常的概率；x2为主诉信息数据，fOSDI为OSDI最终评分；x3为代谢数据，fSoftmax为Softmax模型预测的患干眼症的概率；0＜θ1，...，θ6＜1，θ1+…+θ6＝1；步骤7：基于步骤4至步骤6的预测结果实时绘制用户出现干眼体征异常的概率和患干眼症的概率可视化图，实时标注异常点，在异常点可视化拐点，调整干眼体征动态检测频率；步骤8：用户通过智能终端实时查看自己眼部健康状态。2.根据权利要求1所述的一种基于人工智能的动态干眼预警系统，其特征在于：所述图像采集设备是一个带有微型高清RGB面阵相机的拍摄装置，所述装置左右移动，以便更精准捕捉左右眼的图像装置上的RGB面阵相机精巧且轻便，避免遮挡用户用眼或造成佩戴负担；所述微型高清RGB面阵相机在距离用户双眼连线中点10～13cm；当用户戴上带有高清RGB面阵相机的拍摄装置时，相机自动按照设定的程序实时拍摄眼表视频；由于人们在用眼疲劳的情况下可造成干眼，因此在用户阅读书籍、使用手机和电脑等智能设备的情景下佩戴带图像采集设备；图像采集设备实时将RGB图像进行传输和进行数据处理。3.根据权利要求1所述的一种基于人工智能的动态干眼预警系统，其特征在于：所述主诉信息数据通过采集OSDI干眼问卷得到，眼表代谢数据通过气相色谱法和质谱法进行检测；所述数据预处理对采集的RGB图像进行预处理和数据扩增，剔除有强烈伪影的图像数据，标记图像样本是否出现干眼体征异常，并对代谢数据样本标注是否患干眼症。4.根据权利要求1所述的一种基于人工智能的动态干眼预警系统，其特征在于，所述根据动态检测中间过程的结果，调整OSDI干眼问卷的内容，识别假性干眼症，包括：根据动态检测中出现干眼症概率的结果，调整OSDI干眼问卷的题目内容，当动态检测到干眼概率不断增大时，提供针对该眼干问题更加具有细节性的问题题目，当干眼概率减小时，提供宽泛的题目。5.根据权利要求1所述的一种基于人工智能的动态干眼预警系统，其特征在于：在图像预处理过程，首先用平均值法将RGB图像转化为灰度图，再用高斯滤波保留图像边缘，同时消除噪声，之后利用自适应直方图均衡化算法增强图像对比度，最后对图像进行归一化处理，减小环境光线不均匀等因素对图像的影响；图像数据扩增，使用随机裁剪、像素填充、随机仿射变换、随机水平翻转、随机旋转、随机垂直翻转、添加噪声、图像对比度、亮度、色度调整等方法增加数据量，提高模型泛化能力。6.根据权利要求1所述的一种基于人工智能的动态干眼预警系统，其特征在于：所述步骤5中基于ARIMA模型、OSDI评分指数和Softmax回归模型的长期预测模型，是三者输出的加权求和；所述长期预测模型为：其中，是在未来预测患干眼症的概率x1为图像数据，fARIMAj为ARIMA模型输出的出现泪膜破裂时间异常、泪河高度异常、脂质层异常、腺体开口异常、眼红异常的概率；x2为主诉信息数据，fOSDI为OSDI最终评分；x3为代谢数据，fSoftmax为Softmax模型预测的患干眼症的概率。0＜θ1，...，θ6＜1，θ1+…+θ6=1。7.根据权利要求6所述的一种基于人工智能的动态干眼预警系统，其特征在于：根据用户主诉信息计算OSDI评分，计算公式如下：OSDI评分＝所有得分总和x100/；OSDI评分在0～100之间，为了将OSDI评分转换到0-1之间，fOSDI＝OSDI评分/1008.根据权利要求6所述的一种基于人工智能的动态干眼预警系统，其特征在于：用于构建长期预测模型的Softmax模型为：9.根据权利要求1所述的一种基于人工智能的动态干眼预警系统，其特征在于：所述步骤6中用户出现干眼体征异常概率的实时可视化图，经过短期预测模型对图像的预测，实时得到连续时间下每一时间点样本属于干眼的概率，即获得时间序列数据；短期预测模型实时预测未来一定时期内用户出现干眼体征异常的概率，基于该时间序列数据以及不断更新的用户患干眼症的概率，绘制横坐标为时间，纵坐标为概率的可视化图；根据可视化图绘制内容，动态监测拐点，在数据拐点触动动态检测频率调整机制，当出现干眼体征异常概率增大时，增加动态检测频率；当用户出现干眼体征异常概率大于预设阈值时，应提醒用户停止用眼，注意休息；当用户患干眼症的概率大于等于预设阈值时，提醒用户调整用眼习惯，采取干眼预防措施。10.一种基于人工智能的动态干眼预警系统，其特征在于，所述系统包括：数据采集模块，用于采用干眼信息；数据处理模块，用于对数据进行预处理；干眼算法预测模块，用于对干眼数据进行短期预测和长期预测；应用模块，用于进行可视化展示和预警提醒。
说明书desc
【技术领域】本发明涉及一种基于人工智能的动态干眼预警方法与系统，属于人工智能和医疗健康技术领域。【背景技术】根据2017年第二次国际干眼工作小组报告，干眼是以泪膜稳态失衡为主要特征并伴有眼部不适体征的多因素眼表疾病，泪膜不稳定、泪液渗透性升高、眼表炎症与损伤以及神经感觉异常是其主要病理生理机制。在2007年国际干眼症研讨会指南中，指出干眼可分为泪液分泌不足型、蒸发过强型和混合型三种。我国的干眼发病率为21％-30％，随着发病率的增加，干眼逐渐成为社会关注的重要健康问题。干眼症影响着全球各地5％-50％的成年人。干眼患者通常会出现视力波动、眼疲劳、异物感和干涩感等，早期干眼会轻度影响视力，同时降低患者的工作效率和生活质量，而重度干眼可使患者出现视力障碍，甚至导致患者失明。关于干眼相关的危险因素分析已开展了大量的研究并取得一系列成果，相关研究表明，年龄、性别、睑板腺功能障碍、骨髓移植、空气污染、干燥气候、视频终端的使用、饮食、糖尿病、精神因素和遗传因素等都可成为干眼的诱发因素。2020年中国干眼专家共识也指出，干眼可以由多种因素造成，包括全身性疾病、局部感染及免疫疾病、环境因素、生活方式、手术、全身及局部用药和情绪等。其中，随着视频终端使用者的日益增多，干眼问题越来越普遍。有学者指出，当我们的眼睛高度集中于使用视频终端、学习或开车时，每分钟瞬目次数会明显减少，进而加快了泪液的蒸发；此外，屏幕光中的短波蓝光会使得眼表氧化损伤。以上因素都会引起视疲劳，并诱发干眼。我国临床研究表明，经常使用视频终端的人群中患干眼症的概率高达93％，51.4％的视疲劳病人有干眼体征，71.3％的干眼病人有视疲劳体征。可见，在人们长期需要集中用眼时容易出现干眼体征异常，因此亟需构建一个干眼预警系统，在用户长时间用眼并即将出现干眼体征异常时发出预警，提醒用户注意用眼，达到预防干眼的目的。而目前，在针对干眼的人工智能领域，主要是基于单一的某种人工智能算法对干眼症进行分级或检测，目的主要是辅助人工判断，提高诊断的准确性和客观性，减轻临床医生的负担。但上述辅助诊断系统是在患者出现干眼后作出疾病诊断，不能起到预防干眼的作用。如《皇帝内经》所说，“上工治未病”，我们希望在干眼发生前就采取措施，防止疾病的发展。因此，迫切需要建立一个实时预测干眼的系统，在用户用眼时间较长并可能出现干眼时，对用户发出预警，从而帮助用户预防干眼。从干眼症的症状产生到发展成为干眼症患者，有着漫长的演变过程。当前的技术大部分只是对病变进行判断，而不能对演变的动态过程进行检测，以及判断哪种情况的症状可能会演变成干眼症哪种情况，有的时候虽然产生症状，但后面患干眼症概率很小。干眼演变监测预警需要一个动态检测与深度学习预测结合的过程，这是当前很多技术没有提到的。另外，目前很多分析干眼症状的方式是，静态短期检测是一次性检查之后就出结果。有的时候这样的检测是不精准的，因为只有长期动态而稳定检测，才能真正的识别泪膜破裂时间异常、泪河高度异常、脂质层异常、腺体开口异常、结膜异常的以及演变成干眼症疾病的概率。最后，很多检测还会融合用户的问答信息做问卷调查。但是问卷信息如何根据检测信息动态变化，并且最终如何跟检测信息融合进行共同预测，都是当前现有技术还没有解决的，因为两者是两个维度的不同信息。因此本发明对这些内容进行了更多有效的解决。【发明内容】本发明要解决的技术问题在于，针对现有干眼预警的缺失以及诊断的不足，提供一种干眼预警系统，基于卷积神经网络、关联规则Apriori算法、时间序列、Softmax等模型分别构建短期和长期预测模型，使预警系统在用户未来可能出现干眼体征异常和患干眼症时提前发出预警，最终降低干眼发病率。一种基于人工智能的动态干眼预警系统，包括数据采集模块、数据处理模块、算法模块和应用模块，所述算法模块包括可视化模块和预警模块。其中，干眼预测模块又包括建立短期预测模型和长期预测模型。短期预测是指对出现泪膜破裂时间异常、泪河高度异常、脂质层异常、腺体开口异常、结膜异常等干眼体征异常概率的预测，长期预测是指对患干眼症疾病概率的预测。所述动态的智能干眼预警系统实现步骤如下：所述数据采集模块包括图像采集、主诉信息采集和眼表代谢数据采集。将采集的眼表RGB图片、主诉信息数据、眼表代谢数据传输到数据处理模块，数据处理模块对采集的数据进行处理；在算法模块中，基于经过数据处理模块处理后的眼表RGB图片，用DenseNet121模型构建干眼体征分类模型，计算用户出现干眼体征异常的概率；所述出现干眼体征异常概率的预测，利用差分整合移动平均自回归模型建立短期预测模型，预测用户在未来一定时期内出现干眼体征异常的概率；在算法模块中，对干眼症进行预测分析。所述患干眼症概率的预测，基于ARIMA模型的输出概率、主诉信息数据和眼表代谢数据，结合OSDI评分和Softmax回归模型建立长期预测模型，预测用户在未来患干眼症的概率；基于长期和短期预测结果实时绘制用户出现干眼体征异常的概率和患干眼症的概率可视化图；用户通过智能终端实时查看自己眼部健康状态。一种基于人工智能的动态干眼预警系统，其中，所述数据采集模块要求待检者没有患严重眼病，能够根据自己感官正常填写问卷。一种基于人工智能的动态干眼预警系统，其中，所述图像采集设备是一个带有微型高清RGB面阵相机的拍摄装置，装置上的RGB面阵相机精巧且轻便，避免遮挡用户用眼或造成佩戴负担。另外，所述微型高清RGB面阵相机在距离用户双眼连线中点10～13cm。当用户戴上带有高清RGB面阵相机的拍摄装置时，相机自动按照设定的程序实时拍摄眼表图片，每张图片拍摄间隔1s。由于人们在用眼疲劳的情况下可能造成干眼，因此规定用户在阅读书籍、使用手机和电脑等智能设备的情景下佩戴带图像采集设备。图像采集设备与所述动态的智能干眼预警系统的数据处理模块连接，并实时将RGB图像传输到数据处理模块。一种动态的智能干眼预警系统，其中，所述主诉信息数据通过采集OSDI干眼问卷得到，眼表代谢数据通过色谱法和光谱法等检测。一种基于人工智能的动态干眼预警系统，其中，所述数据处理模块对采集的RGB图像进行预处理和数据扩增，剔除有强烈伪影的图像数据，标记图像样本是否出现干眼体征异常，并对代谢数据样本标注是否患干眼症。所述动态的智能干眼预警系统，其中，在图像预处理过程，首先用平均值法将RGB图像转化为灰度图，再用高斯滤波保留图像边缘，同时消除噪声，之后利用自适应直方图均衡化算法增强图像对比度，最后对图像进行标准化处理，减小环境光线不均匀等因素对图像的影响。关于图像数据扩增，使用随机裁剪、像素填充、随机仿射变换、随机水平翻转、随机旋转、随机垂直翻转、添加噪声、图像对比度、亮度、色度调整等方法增加数据量，提高模型泛化能力。一种基于人工智能的动态干眼预警系统，其中，所述基于卷积神经网络DenseNet121的干眼体征分类模型，其优点是减轻了梯度消失问题、能融合各个通道的特征和减少了参数数量。所述动态的智能干眼预警系统，使用最有效的ARIMA模型预测未来一定时期内用户出现干眼体征异常的概率；所述动态的智能干眼预警系统，其中，所述基于ARIMA模型、OSDI评分指数和Softmax回归模型的长期预测模型，是三者输出的加权求和。因此所述长期预测模型为：其中，是在未来预测患干眼症的概率。x1为图像数据，fARIMAj为ARIMA模型输出的出现泪河高度异常、脂质层异常、腺体开口异常、结膜异常的概率；x2为主诉信息数据，fOSDI为OSDI最终评分；x3为代谢数据，fsof tmax为Softmax模型预测的患干眼症的概率。0＜θ1，...，θ6＜1，θ1+...+θ6＝1。。所述动态的智能干眼预警系统，根据主诉信息计算标准化OSDI评分，计算公式如下：OSDI评分＝所有得分总和x100/；OSDI评分在0～100之间，为了将OSDI评分转换到0-1之间，则标准化OSDI评分fOSDI＝OSDI评分/100。所述动态的智能干眼预警系统，其中，所述用于构建长期预测模型的Softmax模型为：一种基于人工智能的动态干眼预警系统，其中，所述用户出现干眼体征异常概率的实时可视化图，经过短期预测模型对图像的预测，实时得到连续时间下每一时间点样本属于干眼的概率，即获得时间序列数据。短期预测模型实时预测未来一定时期内用户出现干眼体征异常的概率，基于该时间序列数据以及不断更新的用户患干眼症的概率，绘制横坐标为时间，纵坐标为概率的可视化图。另外，当用户出现干眼体征异常概率大于等于0.5时，应提醒用户停止用眼，注意休息。当用户患干眼症的概率大于等于0.5时，提醒用户调整用眼习惯，采取干眼预防措施。本发明的有益效果：本发明通过建立卷积神经网络模型、时间序列模型、Softmax模型等，实时预测用户出现干眼体征异常和患干眼症的概率。它比其他算法更加精准的识别干眼病；另一方面，能够将问卷信息跟检测信息融合，达到更加精准的预测效果。用户佩戴拍摄装置后可通过智能终端实时查看未来出现干眼体征异常甚至患干眼症的可能性，智能终端也会在用户出现干眼体征异常及患干眼症的可能性较大时发出预警，提高用户合理用眼的意识。【附图说明】图1是本发明的建立智能干眼预警系统的流程图；图2是本发明的智能干眼预警系统使用流程图；图3是本发明的智能干眼预警系统的功能原理图；图4是DenseNet121卷积神经网络的结构示意图；图5是用户佩戴本发明拍摄装置的示意图；图6是本发明拍摄装置结构示意图。【具体实施方式】为了更清晰地描述本发明的技术方案和目标，下面结合附图和实施例对本发明做进一步详细描述。需要指出的是，以下所述实施例旨在便于对本发明的理解，而对其不起任何限定作用。本发明的系统包括数据采集模块、数据处理模块、算法模块和应用模块，所述算法模块包括可视化模块和预警模块。如图1所示，该动态的智能干眼预警系统工作时实现以下步骤：获取若干眼表RGB图像，采集代谢数据，用户填写问卷；对图像进行灰度预处理、高斯滤波、直方图均衡化和归一化处理；将一系列处理后的图像输入干眼体征分类模型，得到所有图像出现干眼体征异常的概率，再输入短期预测模型，得到未来短时间内出现干眼体征异常的概率；将代谢数据输入Softmax回归模型，得到干眼症概率，并根据主诉信息计算标准化OSDI评分；将短期预测模型输出、干眼症概率和标准化OSDI评分输入长期预测模型，得到在未来患干眼症的概率；绘制可视化图，用户通过智能终端查看干眼体征和干眼症预测结果。建立用于预测干眼体征异常概率的短期预测模型详细步骤如下：步骤1，采集图像数据；步骤1.1：招募平时经常使用视频终端的志愿者，其中包含曾经出现泪膜破裂时间异常、泪河高度异常、脂质层异常、腺体开口异常和结膜异常中的其中一种或多种体征异常，以及未出现过任何体征异常的志愿者。步骤1.2：用户在阅读、使用电子设备等场景下佩戴带有高清RGB面阵相机的拍摄装置；步骤1.3：拍摄装置持续拍摄眼表视频，每隔0.5s从视频中抽取一帧存入图像数据集；步骤2，对步骤1采集的原始图像进行预处理；步骤2.1：对图像数据进行脱敏处理，删除受检者姓名、联系电话等基本信息，对所有样本按时间顺序赋予数字编号；步骤2.2：先用平均值法将RGB图像转化为灰度图，即R＝G＝B＝/3；步骤2.3：接着用高斯滤波保留图像边缘，消除噪声，平滑图像；步骤2.4：之后利用AHE算法增强图像对比度；步骤2.5：接着将图像数据归一化为，减小环境光线不均匀对图像的影响；步骤2.6：最后将图像数据进行标准化，提高模型泛化性能；步骤3，对预处理后的图像数据集进行标注；步骤3.1：请若干名眼科医生使用Image J软件对所有图片的泪河、脂质层、腺体开口和结膜标注是否出现体征异常，当图片同时出现k种异常体征时，将该图片处理为分别具有不同异常体征标注的k张图片；步骤3.2：请3-5名专家对所有图片进行交叉验证，当判断出现分歧时请具有十年以上临床经验的主任医师进行仲裁；步骤3.3：分别保存标注前和标注后的图像数据集；步骤4，对标注图像数据进行扩增，使用随机裁剪、像素填充、随机仿射变换、随机水平翻转、随机旋转、随机垂直翻转、添加噪声、图像对比度、亮度、色度调整等方法增加数据量；获取标注图像后，首先，检测检测泪膜破裂时间异常，包括对泪膜所在区域进行图像裁剪；基于卷积神经网络，对泪河区域图像进行分割和泪膜层特征进行聚类；通过颜色和粘稠度识别黏蛋白层、中间水液层和脂质层的厚度，采用聚类修正模块，对聚类边缘进行提取，然后在黏蛋白层、中间水液层竖直方向0.1微米内寻找最大梯度的位置并更新原来的边缘位置；判别泪膜层中各层的厚度；基于黏蛋白层、中间水液层和脂质层三层的厚度比例，预测泪膜破裂时间，并与正常破裂时间进行比较，获得异常程度；在检测泪膜破裂时间异常后，进一步分析所述泪膜破裂时间异常与泪河高度异常、脂质层异常、腺体开口异常、结膜异常的关联性，并预测泪河高度异常、脂质层异常、腺体开口异常、结膜异常的异常值；因为泪膜破裂时间经常与泪河高度异常、脂质层异常、腺体开口异常、结膜异常具有病理学的关联性。本发明采用关联规则Apriori算法对这四种异常进行关联挖掘。通过获取泪河破裂时间异常程度，与其他四类病例异常是否经常同时出现，做为支持度判定条件：另一方面，通过获取泪膜破裂出现后，另外四种异常作为下一个异常出现的概率：作为置信度，并计算出四种异常相互之间的关联关系，用于验证深度学习预测的可信度，做二次的验证。所述验证深度学习预测的可信度还包括：步骤5，基于标注图像数据集分别训练四个DenseNet121二分类模型，分别用于预测样本是否出现泪河高度异常、脂质层异常、腺体开口异常和结膜异常；将标注图像数据集分成用于建立不同体征异常预测模型的四种数据集，如用于建立泪河高度异常预测的数据集，应包含泪河高度异常和泪河高度正常的样本，其他类型的体征同理；四个二分类模型的训练过程相同，具体步骤如下：步骤5.1：将图像数据集中出现干眼体征异常的样本视为正类，将未出现干眼体征异常的样本视为负类；步骤5.2：在图像数据集中按照原始数据集类别比例随机挑选60％的样本作为训练集，20％的样本作为验证集，剩余20％的样本作为测试集。其中，训练集用于拟合模型，验证集用于调整模型超参数以及初步评估模型性能，测试集用于评估最终模型的泛化性能；步骤5.3：利用PyTorch框架搭建DenseNet121卷积神经网络网络，该网络主要由稠密块和过渡块两个部分组成，稠密块用于定义输入和输出之间的连接关系，过渡块用于控制通道数。过渡块都包括1x1的卷积核，以及步长为2，2x2的平均池化层。将预处理后的图片输入模型，先经过步长为2，7x7的卷积核，再经过步长为2，3x3的最大池化层，随后经过一个{1x1卷积，3x3卷积}x6的稠密块，再经过一个过渡块，接着经过一个{1x1卷积，3x3卷积}x12的稠密块，再经过一个过渡块，然后经过一个{1x1卷积，3x3卷积}x24的稠密块，再经过一个过渡块，之后经过一个{1x1卷积，3x3卷积}x16的稠密块，再经过7x7的全局平均池化层，最后经过一个全连接层，并用softmax函数预测，得到二分类结果，即样本出现或未出现干眼体征异常的概率。步骤5.4：使用交叉熵函数作为训练DenseNet121模型的损失函数，因此算法的优化目标为：其中，C是类别个数，pi表示分类模型对图像属于第i类的预测概率，yi表示人工标注的类别标记；优化目标第二项为正则化项，用于防止过拟合；步骤5.5：卷积层中偏置项初始化为0，参数权重采用随机正交矩阵初始化，全连接层中参数采用随机正态分布初始化，偏置项初始化为0。使用反向传播算法训练模型，并由Adam优化算法更新参数，其中学习率learning_rate＝0.001，第一次估计的指数衰减率beta1＝0.9，第二次估计的指数衰次减率beta2＝0.999，epsilon＝1e-08；步骤5.6：当模型损失函数在训练集和验证集都收敛时停止训练，得到训练好的DenseNet121模型；步骤5.7：在测试集中检验DenseNet121模型的性能，计算其正确率、敏感度、特异度和AUC值；步骤6：得到分别用于检测是否出现泪河高度异常、脂质层异常、腺体开口异常和结膜异常的四个二分类模型，使用训练好的DenseNet121模型对图像数据进行预测，得到按时间顺序排列的出现干眼体征异常的预测概率，即得到了时间序列；我们基于不同的二分类模型分别建立不同的ARIMA模型，模型输出记为fARIMAj，j＝1，...，4，表示在未来一定时期内用户出现某种干眼体征异常的概率，ARIMA模型建模步骤如下：步骤6.1：使用ADF检验测试数据的平稳性，对于非平稳时间序列进行d阶差分的平稳化处理，再进行零均值化处理；步骤6.2：分析预处理后的时间序列自相关图和偏自相关图，结合计算预处理后序列的自相关函数和偏自相关函数来进行模型识别；步骤6.3：利用极大似然法或最小二乘法估计ARMA的未知参数，并利用AIC准则和BIC准则确定模型最佳阶数p和q；步骤6.4：对模型残差序列进行白噪声检验，若模型残差序列不是白噪声，则重新拟合模型。当模型残差序列是白噪声的，则得到了最有效的ARIMA时间序列预测模型；步骤6.5:使用ARIMA时间序列预测模型预测用户在未来一段时间内出现干眼体征异常的概率为：建立预测干眼症概率的长期预测模型的详细步骤如下：步骤1，采集代谢数据和主诉信息；步骤1.1：招募患干眼症和未患干眼症的志愿者，其中要求干眼症患者为轻症患者。步骤1.2：使用高效液相色谱法、气相色谱法、核磁共振光谱法、质谱法等检测睑脂、角膜、泪膜中各代谢指标含量,如泪液乳铁蛋白、白介素、基质金属蛋白酶、饱和脂肪酸、胆固醇酯、黏蛋白等，将采集到的数据存储到代谢数据集中；步骤1.3：用户使用系统时填写OSDI干眼问卷；根据动态检测中间过程的结果，调整OSDI干眼问卷的内容，避免机器提供了错误的问题引导，而产生错误的干眼症识别结论。根据动态检测中出现干眼症概率的结果，调整OSDI干眼问卷的题目内容，当动态检测到干眼概率不断增大时，提供针对该眼干问题更加具有细节性的问题题目，当干眼概率减小时，提供宽泛的题目。例如，当用户回答眼睛是否影响了电脑工作，他的回答是大部分时间都影响时，下一个问题，不再是再问是否影响看电视。而是进一步问，是影响了看电脑上的文字内容，还是影响了看看电脑视频。这样更加细致的问题。当他以前看文字才受影响，现在连看视频都受到影响时，说明他是越来越严重的。应该调整检测频率，或者应该判别他有更高概率的患病可能。步骤2，对代谢数据进行预处理；步骤2.1：对代谢数据进行脱敏处理，删除受检者姓名、联系电话等基本信息，对所有样本随机赋予数字编号；步骤2.2：对代谢数据进行归一化处理；步骤3，对代谢数据集样本进行标注；步骤3.1：请若干名医师根据中国干眼专家共识：定义和分类将样本分为患干眼症和未患干眼症两类；步骤3.2：请3-5名专家对所有样本进行交叉验证，当判断出现分歧时请具有十年以上临床经验的主任医师进行仲裁；步骤3.3：分别保存标注前和标注后的代谢数据集；步骤4，基于标注代谢数据集建立Softmax模型，预测用户患干眼症的概率；步骤4.1：将标注代谢数据集中患干眼症的样本视为正类，将未患干眼症的样本视为负类；步骤4.2：在标注代谢数据集中按照原始数据集类别比例随机挑选60％的样本作为训练集，20％的样本作为验证集，剩余20％的样本作为测试集；步骤4.3：同样地，使用交叉熵函数作为训练Softmax模型的损失函数，因此优化目标是在训练集中最小化交叉熵损失函数。首先随机初始化模型参数，再用梯度下降法更新参数，当损失函数收敛时停止迭代；在验证集中初步检验模型性能，当训练集和验证集中模型都得到较好的效果时，保存训练该Softmax回归模型；Softmax回归模型的训练过程基于PyTorch框架进行。步骤4.4：在测试集中检验Softmax回归模型的性能，计算其正确率、敏感度、特异度和AUC值；步骤5，根据眼表疾病指数问卷计算标准化OSDI评分，问卷包含12个问题，分别是请患者回答上周是否有畏光、异物感、眼痛眼酸、视物模糊、视力下降，上周在阅读、夜间开车、电脑或ATM机前、看电视时眼部是否不适，上周在有风时、干燥环境、空调环境中眼部是否不适；其中每个问题有五个选项，分别是“一直、经常、一半时间、有时、无”，五个选项得分分别为4、3、2、1、0。基于问卷问题及其选项，标准化OSDI评分计算如下：OSDI评分＝所有得分总和x100/；标准化OSDI评分fOSDI＝OSDI评分/100；可以发现，标准化OSDI评分越高代表干眼程度越严重。步骤6，基于ARIMA模型输出、Softmax回归模型输出和标准化OSDI评分建立长期预测模型：可见，模型预测未来患干眼症的概率可随ARIMA模型输出实时发生改变，即当在未来用户出现干眼体征异常的概率增大或减小时，则模型预测其在未来患干眼症的概率也会增大或减小。同时，Softmax回归模型输出的是患干眼症的概率，概率越大代表越有可能患干眼症，OSDI评分越高也代表干眼程度越严重。因此，最终长期预测模型输出值越大，表示用户患干眼症可能性越大，且模型输出值在之间。此外，模型中的参数θ1，...，θ6根据经验设置。步骤7，基于短期预测模型和长期预测模型绘制可视化图，给出用户的OSDI评分。四个短期预测模型分别实时输出用户在未来一段时间内出现泪河高度异常、脂质层异常、腺体开口异常和结膜异常的概率，短期预测模型绘制的可视化图横坐标为时间，纵坐标为时间点对应出现四种异常体征的概率，该可视化图以实时更新的折线图呈现。由于长期预测模型会随短期预测模型输出发生改变，因此其可视化图与短期预测模型一样，横坐标为时间，并以实时更新的折线图呈现。通过实时绘制用户出现干眼体征异常的概率和患干眼症的概率可视化图，实时标注异常点，在异常点可视化拐点，调整干眼体征动态检测频率；步骤8，用户通过智能终端实时查看自己眼部健康状态，且可以查看出现不同的干眼体征异常、患干眼症概率的实时变化，以及OSDI问卷评分。同时，智能终端根据预测结果提供相应的健康意见。用于实现本发明进行信息控制的程序，可以以一种或多种程序设计语言或其组合来编写用于执行本发明操作的计算机程序代码，所述程序设计语言包括面向对象的高级程序设计语言—诸如Java、python、C++，还包括常规的过程式程序设计语言—诸如C语言或类似的程序设计语言。程序代码可以完全在独立嵌入式设备或用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，可以连接到外部计算机。在本发明所提供的几个实施例中，应该理解到，所揭露的系统，装置和方法，可以通过其它的方式实现。例如，以上所描述的装置实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用硬件加软件功能单元的形式实现。上述以软件功能单元的形式实现的集成的单元，可以存储在一个计算机可读取存储介质中。上述软件功能单元存储在一个存储介质中，包括若干指令用以使得一台计算机设备或处理器执行本发明各个实施例所述方法的部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明保护的范围之内。
