标题title
一种心电信号心房扑动的检测方法及检测装置
摘要abst
本发明涉及生物医学工程技术领域，具体公开了一种房扑动检测准确率和可靠性较高的心电信号心房扑动的检测方法，包括步骤S1：获取心电数据并进行预处理；步骤S2：对预处理后的心电数据进行QRS波检测，并对每个QRS波进行匹配聚类，获取心电信号的主导模板；步骤S3：根据步骤S2中的匹配聚类结果，判断当前心拍与主导模板的关系并对QRS波进行对消或者线性插值；步骤S4：所有QRS波的判断处理作业结束后，利用步骤S3处理得到的心电数据进行重采样及时‑频变换，得到信号能量图谱，并根据能量图谱的峰值判断心电信号是否为心房扑动。还公开了一种心电信号心房扑动的检测装置。
权利要求书clms
1.一种心电信号心房扑动的检测方法，其特征在于，包括以下步骤：步骤S1：获取心电数据，并对所述心电数据进行预处理；步骤S2：对预处理后的心电数据进行QRS波检测，并对每个QRS波进行匹配聚类，获取心电信号的主导模板；步骤S3：根据步骤S2中的匹配聚类结果，对每个所述QRS波进行判断处理：若所述QRS波属于主导模板，则进行QRS波对消，利用当前QRS波心拍数据减去主导模板的QRS波数据，并进入下一个所述QRS波的判断处理作业；若所述QRS波不属于主导模板，则求取所述QRS波的起始点和终止点，在所述起始点和所述终止点之间进行线性插值，并进入下一个所述QRS波的判断处理作业；步骤S4：所有所述QRS波的判断处理作业结束后，利用步骤S3处理得到的心电数据进行重采样，对重采样后的心电信号进行时-频变换，得到信号能量图谱，并根据能量图谱的峰值判断心电信号是否为心房扑动。2.根据权利要求1所述的检测方法，其特征在于，所述预处理包括基线滤波、工频滤波及肌电滤波。3.根据权利要求1所述的检测方法，其特征在于，采用差分阈值方法进行QRS波检测。4.根据权利要求1所述的检测方法，其特征在于，所述主导模板的选取方法为：选取所有模板中包含心拍个数最多的模板作为主导模板；若存在多个心拍个数相同的模板，则在这些模板数据上分别进行QRS波起始点和终止点的检测，并用终止点减去起始点，获取各模板QRS波的宽度，选取宽度最小的模板作为主导模板。5.根据权利要求1所述的检测方法，其特征在于，所述线性插值的坐标公式如下：其中，i为插值点的位置坐标，on和off分别为QRS波的起始位置坐标和终止位置坐标，x和x为起始点和终止点的幅度值。6.根据权利要求1所述的检测方法，其特征在于，所述重采样的采样率为125Hz。7.一种心电信号心房扑动的检测装置，其特征在于，包括：预处理模块，用于获取心电数据并对心电数据进行预处理；QRS波检测及聚类模块，用于接收所述预处理模块处理后的心电信号，依序进行QRS波检测及QRS波匹配聚类，以获得主导心拍；QRS波消除模块，用于在所述预处理模块得到的心电信号上，遍历所述QRS波检测及聚类模块检测到的QRS波，并根据当前心拍与主导模板的关系对QRS波进行对消或者线性插值；以及心电判断模块，用于对所述QRS波消除模块处理后的信号进行重采样，经时-频变换获得信号能量图谱，并对心电信号的种类进行判断。8.根据权利要求7所述的检测装置，其特征在于，所述预处理模块包括A/D转换单元、基线滤波单元、工频滤波单元以及肌电滤波单元。
说明书desc
技术领域本发明涉及生物医学工程技术领域，特别是涉及一种心电信号心房扑动的检测方法及检测装置。背景技术心房扑动是介于房性心动过速与心房颤动之间的快速规则的房性心律失常，其在心电图上表现为P波消失，代之以快速而规则的心房扑动的F波，F波的频率250到350次/分钟，为临床上较为常见的心律失常之一。传统的心电信号自动分析主要通过检测P波进行分析实现房扑检测，但由于P波本身幅度相对较小，容易受到噪声干扰，导致房扑检测结果不可靠。其他的一些算法通过检测F波进行房扑的判断，但在实际中，房扑的F波形态多样，难以通过直接检测F波获得有效的信息，进而影响最后的诊断结果。发明内容基于此，有必要针对房扑检测结果准确率较低、可靠性较差的技术问题，提供一种房扑动检测准确率和可靠性较高的心电信号心房扑动的检测方法及检测装置。一种心电信号心房扑动的检测方法，包括以下步骤：步骤S1：获取心电数据，并对所述心电数据进行预处理；步骤S2：对预处理后的心电数据进行QRS波检测，并对每个QRS波进行匹配聚类，获取心电信号的主导模板；步骤S3：根据步骤S2中的匹配聚类结果，对每个所述QRS波进行判断处理：若所述QRS波属于主导模板，则进行QRS波对消，利用当前QRS波心拍数据减去主导模板的QRS波数据，并进入下一个所述QRS波的判断处理作业；若所述QRS波不属于主导模板，则求取所述QRS波的起始点和终止点，在所述起始点和所述终止点之间进行线性插值，并进入下一个所述QRS波的判断处理作业；步骤S4：所有所述QRS波的判断处理作业结束后，利用步骤S3处理得到的心电数据进行重采样，对重采样后的心电信号进行时-频变换，得到信号能量图谱，并根据能量图谱的峰值判断心电信号是否为心房扑动。在其中一个实施例中，所述预处理包括基线滤波、工频滤波及肌电滤波。在其中一个实施例中，采用差分阈值方法进行QRS波检测。在其中一个实施例中，所述主导模板的选取方法为：选取所有模板中包含心拍个数最多的模板作为主导模板；若存在多个心拍个数相同的模板，则在这些模板数据上分别进行QRS波起始点和终止点的检测，并用终止点减去起始点，获取各模板QRS波的宽度，选取宽度最小的模板作为主导模板。在其中一个实施例中，所述线性插值的坐标公式如下：其中，i为插值点的位置坐标，on和off分别为QRS波的起始位置坐标和终止位置坐标，x和x为起始点和终止点的幅度值。在其中一个实施例中，所述重采样的采样率为125Hz。本发明还公开了一种心电信号心房扑动的检测装置，包括：预处理模块，用于获取心电数据并对心电数据进行预处理；QRS波检测及聚类模块，用于接收所述预处理模块处理后的心电信号，依序进行QRS波检测及QRS波匹配聚类，以获得主导心拍；QRS波消除模块，用于在所述预处理模块得到的心电信号上，遍历所述QRS波检测及聚类模块检测到的QRS波，并根据当前心拍与主导模板的关系对QRS波进行对消或者线性插值；以及心电判断模块，用于对所述QRS波消除模块处理后的信号进行重采样，经时-频变换获得信号能量图谱，并对心电信号的种类进行判断。在其中一个实施例中，所述预处理模块包括A/D转换单元、基线滤波单元、工频滤波单元以及肌电滤波单元。实施本发明的心电信号心房扑动的检测方法及检测装置，通过心电信号预处理，消除噪声干扰；利用QRS波检测算法并结合心拍匹配，获取信号的主导心拍，进行QRS波对消，消除了QRS波对心房扑动检测的影响；通过重采样降低运算次数，并利用F波在频域特征明显的特点，通过时-频变换，在频域的相应位置点上通过F波能量的大小，进行房扑的判断。本发明实施例能有效提高房扑诊断的准确性，进而提高心电图诊断结果的可靠性。附图说明图1为本发明的一个实施例中心电信号心房扑动的检测方法的流程图；图2为本发明的一个实施例中心电信号预处理的流程图；图3为本发明的一个实施例中QRS波检测的流程图；图4为本发明的一个实施例中QRS波与模板匹配的流程图；图5为本发明的一个实施例中模板数据的示意图；图6为本发明的一个实施例中QRS波对消的流程图；图7为本发明的一个实施例中房扑信号处理结果的示意图；图8为本发明的一个实施例中非房扑信号处理结果的示意图；图9为本发明的一个实施例中心电信号心房扑动的检测装置的结构示意图；图10为本发明的一个实施例中预处理模块的结构示意图。具体实施方式为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图对本发明的具体实施方式做详细的说明。在下面的描述中阐述了很多具体细节以便于充分理解本发明。但是本发明能够以很多不同于在此描述的其它方式来实施，本领域技术人员可以在不违背本发明内涵的情况下做类似改进，因此本发明不受下面公开的具体实施例的限制。请参阅图1，本发明提供了一种房扑动检测准确率和可靠性较高的心电信号心房扑动的检测方法，包括以下步骤：步骤S1：获取心电数据，并对心电数据进行预处理。具体的，请参阅图2，通过心电采集盒等采集设备，获取经A/D转换后的心电数据，即将模拟的心电信号转换为量化的数字信号。在心电信号的采集过程中，受限于采集设备的性能及受检者的活动，心电信号中不可避免的存在噪声干扰，因此需对心电数据进行预处理。一实施例中，预处理包括基线滤波、工频滤波和肌电滤波等处理作业，基线滤波用于滤除基线漂移等低频噪声的干扰，工频滤波用于滤除50/60Hz的工频干扰，肌电滤波用于滤除心电信号中的高频噪声，预处理后，得到不含噪声的心电信号x。步骤S2：对预处理后的心电数据进行QRS波检测，并对每个QRS波进行匹配聚类，获取心电信号的主导模板。请参阅图3，一实施例中，采用差分阈值方法进行QRS波检测。具体的，对心电信号x进行滤波后，依次进行差分、平方和移动平均处理，然后寻找峰值，获取峰值后，将该峰值与阈值进行比较，若峰值大于阈值，则认为检测到QRS波，否则将检测到的QRS波当作噪声处理，最后更新阈值，例如，使更新后的阈值为前一阈值的一半，随后再次指向上述差分、平方和移动平均处理，寻找新的峰值并重新进行比较。需要说明的是，本实施例的QRS波检测属于现有技术，具体可参阅中国发明专利“一种心电信号实时心率检测方法及系统”中关于差分、平方、移动平均处理、寻找峰值及阈值比较等流程的相关描述，当然，本发明还可采用其他方式对动态心电数据进行QRS波检测，于此不再赘述。请参阅图4，在每检测到一个QRS波时，都需要进行QRS波的模板匹配。此处以单个QRS波的模板匹配作业进行举例说明，具体的，以当前QRS波的位置为中心，分别往前和往后取80ms，即取160ms数据作为心拍QRS波数据，然后从第一个模板开始到最后一个模板结束，依次进行心拍QRS波数据和模板QRS波数据的匹配。若发生匹配，则表示当前心拍QRS波与模板的QRS形态相似，将心拍加入模板，并更新当前模板数据；若到最后一个模板均未发生匹配，则新建模板。模板数据如图5所示，包含4部分内容：包含的心拍数量、包含心拍的序号、模板QRS波数据和最后一个心拍时间。模板数据的更新遵循以下原则：若当前QRS波为第一个心拍，则不存在模板，以当前心拍为基础，新建模板，新模板包含的心拍数量为1，将当前QRS波的心拍序号加入包含心拍的序号里，新模板的QRS波数据为当前心拍的QRS波数据，新模板最后一个心拍时间为当前心拍时间。若模板存在，则取第一个模板，比较模板数据与QRS波数据是否匹配，若发生匹配，则更新模板，将当前模板包含心拍数量加1，将当前QRS波的心拍序号加入模板的包含心拍序号里，更新最后一个心拍时间为当前心拍时间，同时更新模板的QRS波数据，更新方法如下：其中TDnew为更新后的模板数据，TDTDold为更新前的模板数，据x为心拍数据，n表示由0到160ms的数据下标。若当前模板与QRS波数据不匹配，则检查当前模板是否为最后一个模板。若当前模板不是最后一个模板，则取下一个模板，继续进行模板与QRS波数据的匹配比较；若当前模板为最后一个模板，则需要新建模板。为了加快匹配速度，防止由于模板数量过多导致匹配速度变慢的问题，需要对模板数量进行限制。若新建模板之前，模板的数量达已到最大模板数量MAX_TEMP_NUM，表示模板数量已满，此时需要删除一个无效的模板，以保证新建模板之后，模板的总数量不超过最大模板数量。无效模板的选择逻辑为：选取所有模板中包含心拍数量最少的模板作为无效模板；若存在多个模板中包含的心拍数量均为最少，比较模板的最后一个心拍时间，将时间最早的模板作为无效模板。QRS波检测和模板匹配完成后，在模板数据中选择主导模板，选择的逻辑为：选取所有模板中包含心拍个数最多的模板作为主导模板；若存在多个心拍个数相同的模板，则在这些模板数据上分别进行QRS波起始点和终止点的检测，并用终止点减去起始点，获取各模板QRS波的宽度，选取宽度最小的模板作为主导模板。步骤S3：根据步骤S2中的匹配聚类结果，判断当前心拍与主导模板的关系并对QRS波进行对消或者线性插值。具体而言，根据步骤S2中的匹配聚类结果，对每个QRS波进行判断处理：若QRS波属于主导模板，则进行QRS波对消，利用当前QRS波心拍数据减去主导模板的QRS波数据，并进入下一个QRS波的判断处理作业；若QRS波不属于主导模板，则求取QRS波的起始点和终止点，在起始点和终止点之间进行线性插值，并进入下一个QRS波的判断处理作业。具体的，请参阅图6，在步骤S1得到的心电信号x上，遍历步骤S2检测的QRS波，若当前QRS波的心拍序号在主导模板的包含心拍序号里，则表示当前心拍属于主导模板，用当前QRS波数据减去主导心拍的QRS波数据，即用当前QRS波数据减去主导模板的QRS波数据，实现QRS波对消。若当前QRS波的心拍序号不在主导模板的包含心拍序号里，表示当前心拍不属于主导模板，求取当前心拍的QRS波起始点和终止点。在起始点和终止点之间进行线性插值。线性插值的坐标公式如下：其中，i为插值点的位置坐标，on和off分别为QRS波的起始位置坐标和终止位置坐标，x和x为起始点和终止点的幅度值。步骤S4：对消后对信号进行重采样及时-频变换，包括利用步骤S3处理得到的心电数据进行重采样，对重采样后的心电信号进行时-频变换，得到信号能量图谱，并根据能量图谱的峰值判断心电信号是否为心房扑动。具体的，所有QRS波的判断处理作业结束后，即QRS波对消完成后，由于可能存在阈值不位于采样点上的原始函数的数值，因此，需要利用已采样点进行内插，即对数据进行重采样。在实际处理中，为了兼顾运算速度，信号降采样的采样率取125Hz，125Hz采样率为满足最小分辨率的最低采样率，如此，可以减小系统的整体计算量，以加快运算速度。例如若原始信号的采样率为500Hz，则可以通过在数据上每隔3个点取一个数据，得到的数据重新组成的信号即为125Hz采样率。重采样后，将处理后的心电信号进行时-频变换，把信号由时间域映射到复频域，换言之，就是把时域的信号变成频域的信号进行分析，以降低数据的处理难度。时-频变换时，将数据按N＝1024点进行快速傅里叶变换，变换后取绝对值获取信号的能量谱线图。若降采样的信号数据长度较大，可以分段成多段长度为1024的子段，每个子段分别进行FFT变换，然后再取绝对值进行累加获取信号的能量谱线图。由于步骤S3中QRS波对消时消除了QRS波的能量，通过时-频变换获取的能量谱线主要包含P波、T波或是F波的能量。若是非房扑的P波或是T波，由于其重复频率较低，因而其能量谱线大多在较低频率上；而房扑数据的F波，其对应的心率大多在250到350之间。因此，根据频率与心率的关系，当一个能量图谱的峰值对应的频率乘以60，其值落在250到350之间，且该峰值为能量图谱中的最大峰值时，则认为所分析的信号为房扑。请参阅图7，图7示出了房扑心电图判断流程中不同状态下的信号，其中，图7a为一个房扑的原始信号，信号长度为10s，采样率为500Hz。通过预处理后，获得图7b所示的较为干净的信号。依序通过QRS波检测和对消，即通过步骤S2和步骤S3处理后，得到QRS波对消后的信号，如图7c所示，此时信号的采样率为500。通过对图7c中的心电信号进行降采样处理，获得采样率为125的心电信号，如图7d所示。利用时-频变换，获得降采样后的能量图谱，如图7e所示。由7e图可以看出，在频率4.883处为能量图谱的峰值，对应的心率为4.833*60＝290，与房扑发生的心率范围一致，说明该信号为房扑信号。与图7的流程一致，图8示出了窦性心律，即非房扑心电图判断流程中不同状态下的信号，在最后的能量图谱中，峰值频率为1.099，对应的心率为1.099*60＝66，不在房扑的心率范围内，与P和T的频率一致，该P波与T波的频率与QRS波对应，因而该病例为非房扑病例。结合图7与图8，本实施例利用房扑信号的F波在时域不易检测，但在频域能量较为集中的特点，通过对房扑数据处理后进行时-频变换，在频域里寻找F波，进行房扑的判断，可以有效避免时域里噪声干扰的影响，提升诊断结果的可靠性。请参阅图9，本发明还提供了一种心电信号心房扑动的检测装置，包括预处理模块100，用于获取心电数据并对心电数据进行预处理；QRS波检测及聚类模块200，用于接收预处理模块100处理后的心电信号，依序进行QRS波检测及QRS波匹配聚类，以获得主导心拍；QRS波消除模块300，用于在预处理模块100得到的心电信号上，遍历QRS波检测及聚类模块200检测到的QRS波，并根据当前心拍与主导模板的关系对QRS波进行对消或者线性插值；心电判断模块400，用于对QRS波消除模块300处理后的信号进行重采样，经时-频变换获得信号能量图谱，并对心电信号的种类进行判断。请参阅图10，一实施例中，预处理模块100包括A/D转换单元110、基线滤波单元120、工频滤波单元130以及肌电滤波单元140，其中，A/D转换单元110用于将模拟的心电信号转换为数字信号，以便于机器识别；基线滤波单元120用于滤除基线漂移等低频噪声的干扰；工频滤波单元130用于滤除50/60Hz的工频干扰；肌电滤波单元140用于滤除心电信号中的高频噪声，这样一来，通过多种不同滤波单元对心电信号的滤波作用，获得滤波后的心电信号x，可以消除心电信号中的绝大多数干扰信号，即达到去除噪声，提升信号可靠性的目的。QRS波检测及聚类模块200在接收预处理模块100发送的心电信号x后，依序通过差分、平方、移动平均处理、寻找峰值及阈值比较等流程对QRS波进行检测，以获取有效QRS波，减小噪声干扰。进一步的，可结合图4与图5，每检测到一个QRS波后，QRS波检测及聚类模块200都将进行QRS波的模板匹配，具体的，取预定长度的数据，如前后各取80ms，总共160ms的数据作为心拍QRS波数据，由第一个模板至最后一个模板依次进行心拍QRS波数据和模板QRS波数据的匹配，若发生匹配，则将心拍加入模板，并更新当前模板数据；若到最后一个模板均未发生匹配，则新建模板。主导模板为所有模板中包含心拍个数最多的模板或在多个模板心拍个数相同时，取起终点之间宽度最小的模板作为主导模板。QRS波消除模块300在当前QRS波的心拍序号在主导模板的包含心拍序号里时，用当前QRS波数据减去主导心拍的QRS波数据；在当前QRS波的心拍序号不在主导模板的包含心拍序号里时，求取当前心拍的QRS波起始点和终止点并在起始点和终止点之间进行线性插值。线性插值的坐标公式如下：其中，i为插值点的位置坐标，on和off分别为QRS波的起始位置坐标和终止位置坐标，x和x为起始点和终止点的幅度值。心电判断模块400以预定的采样率对经由QRS波消除模块300对消后的信号进行重采样，以降低运算次数，提升装置的运算速率。随后对重采样后的信号进行时-频变换，获得能量图谱，根据经运算后的能量图谱的峰值是否落入F波的心率范围，判断心电信号的种类，如此一来，有利于检出在时域不易捕捉，但在频域能量较为集中的F波，降低心房扑动的检测难度。实施本发明的心电信号心房扑动的检测方法及检测装置，通过心电信号预处理，消除噪声干扰；利用QRS波检测算法并结合心拍匹配，获取信号的主导心拍，进行QRS波对消，消除了QRS波对心房扑动检测的影响；通过重采样降低运算次数，并利用F波在频域特征明显的特点，通过时-频变换，在频域的相应位置点上通过F波能量的大小，进行房扑的判断。本发明实施例能有效提高房扑诊断的准确性，进而提高心电图诊断结果的可靠性。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本发明的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。因此，本发明专利的保护范围应以所附权利要求为准。
