标题title
基于深度学习与诊断规则的心拍形态识别方法及系统
摘要abst
本发明公开了一种基于深度学习与诊断规则的心拍形态识别方法及装置，包括以下步骤：A：获取待检测心拍并通过m个基于DenseNet的深度神经网络分别生成待检测心拍中不同类别的心拍概率；B：根据得到的每个基于DenseNet的深度神经网络生成不同类别的心拍概率，通过融合决策的方法确定各个类别心拍概率的最终概率；C：根据各个类别心拍概率的最终概率，结合设定的概率阈值，判断待检测心拍所属的心拍类别；并利用诊断规则条件进一步校验待检测心拍的类别。本发明能够解决现有技术中对心梗患者QRS波、ST段和T波形态识别时依赖于特征点检测的准确性、自适应性差和易受噪声干扰鲁棒性差的缺陷，具有较高的识别准确率。
权利要求书clms
1.基于深度学习与诊断规则的心拍形态识别方法，其特征在于，依次包括以下步骤：A：获取待检测心拍，然后通过m个基于DenseNet的深度神经网络，分别生成待检测心拍中不同类别的心拍概率；其中，不同类别的心拍概率包括：正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率；m个基于DenseNet的深度神经网络的卷积核长度均不相同；B：根据步骤A中得到的每个基于DenseNet的深度神经网络生成不同类别的心拍概率，通过融合决策的方法确定各个类别心拍概率的最终概率；C：根据步骤B中得到的各个类别的心拍概率的最终概率，结合设定的概率阈值，判断待检测心拍所属的心拍类别；并利用下述诊断规则条件进一步校验待检测心拍的类别：条件1：待检测心拍有无Q波；条件2：待检测心拍的Q波间期数值；条件3：待检测心拍的Q波幅值；条件4：待检测心拍的ST段抬高幅度数值；条件5：待检测心拍的的T波幅值。2.根据权利要求1所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于，所述的步骤A包括以下具体步骤：A1：获取待检测心拍，并对获取待检测心拍进行数据预处理，得到预处理后的已去除基线干扰和噪声干扰的心电信号；A2：通过m个基于DenseNet的深度神经网络，分别对应生成待检测心拍中不同类别的心拍概率，即正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率；其中，第一类异常心拍，具体表现为无病理Q波、ST段典型抬高和T波高耸；第二类异常心拍，具体表现为有病理Q波和ST段典型抬高；第三类异常心拍，具体表现为有病理Q波和ST段不抬高；正常心拍，具体表现为无病理Q波和ST段不抬高。3.根据权利要求2所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于：所述的基于DenseNet的深度神经网络包含三个稠密连接块、两个过渡连接块、一个全局平均池化块、一个平化块和一个输出块；其中，每个稠密连接块均包含两个一维卷积层、两个归一化层、两个线性修正单元层和两个跳层连接层；每个过渡连接块均包含一个一维卷积层、一个一维平均池化层、一个归一化层和一个线性修正单元层。4.根据权利要求3所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于：所述的基于DenseNet的深度神经网络的进行生成时：第一稠密连接块通过第一稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对待检测心拍进行卷积，得到第一卷积特征；第一稠密连接块通过第一稠密连接块内的第一跳层连接层，对第一稠密连接块的输入和第一卷积特征进行融合，得到第一融合特征；第一稠密连接块通过第一稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第一融合特征进行卷积，得到第二卷积特征；第一稠密连接块通过第一稠密连接块内的第二跳层连接层，对第一稠密连接块的输入、第一融合特征和第二卷积特征进行融合，得到第二融合特征；第一过渡连接块通过第一过渡连接块内的一维卷积层、归一化层和线性修正单元层，对第二融合特征进行卷积得到第三卷积特征；第一过渡连接块通过第一过渡连接块内的一维平均池化层，对第三卷积特征进行降维，得到第一去冗余降维特征；第二稠密连接块通过第二稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对第一去冗余降维特征进行卷积，得到第四卷积特征；第二稠密连接块通过第二稠密连接块内的第一跳层连接层，对第一去冗余降维特征和第四卷积特征进行融合，得到第三融合特征；第二稠密连接块通过第二个稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第三融合特征进行卷积，得到第五卷积特征；第二稠密连接块通过第二个稠密连接块内的第二跳层连接层，对第一去冗余降维特征、第三融合特征和第五卷积特征进行融合，得到第四融合特征；第二过渡连接块通过第二过渡连接块内的一维卷积层、归一化层和线性修正单元层，对第四融合特征进行卷积，得到第六卷积特征；第二过渡连接块通过第二过渡连接块内的一维平均池化层，对第六卷积特征进行降维，得到第二去冗余降维特征；第三稠密连接块通过第三稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对第二去冗余降维特征进行卷积，得到第七卷积特征；第三稠密连接块通过第三稠密连接块内的第一跳层连接层，对第二去冗余降维特征和第七卷积特征进行融合，得到第五融合特征；第三稠密连接块通过第三稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第五融合特征进行卷积，得到第八卷积特征；第三稠密连接块通过第三稠密连接块内的跳层连接层，对第二去冗余降维特征、第五融合特征和第八卷积特征进行融合，得到第六融合特征；全局平均池化块对第六融合特征进行全局平均池化，即计算第六融合特征在每个特征映射上特征的平均值，得到全局平均池化特征；平化层将全局平均池化特征进行平化，获得平化特征；输出层将平化特征输入至以softmax作为激活函数的神经网络层，输出心拍属于正常心拍的概率P11、第一类异常心拍的概率P12、第二类异常心拍的概率P13和第三类异常心拍的概率P14。5.根据权利要求3所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于：所述的基于DenseNet的深度神经网络的损失函数采用基于加权平均的交叉熵损失函数；基于加权平均的交叉熵损失函数L为：其中，N表示心拍形态类别总数，n表示心拍形态类别的索引值，Q为样本总量，i为样本的索引值，y是模型实际输出，1为判断函数，若中括号内成立输出1，否则为0；Wi和bi分别表示对应异常心拍类别的权重矩阵和偏置，x表示平化特征，Kn为不同形态心拍样本的惩罚系数，an表示不同形态的心拍数量。6.根据权利要求3所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于：将m个基于DenseNet的深度神经网络输出不同类别的心拍概率记为矩阵P，其中，P11至Pm1、P12至Pm2、P13至Pm3和P14至Pm4，分别表示第1个至第m个基于DenseNet的深度神经网络输出的正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率。7.根据权利要求1所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于：所述的步骤B中，融合决策的方法是计算m个基于DenseNet的深度神经网络输出概率值的均值Z，使用Z矩阵的最大值做为所属心拍类别k的最终概率Zk；Z＝；正常心拍的最终概率第一类异常心拍的最终概率第二类异常心拍的最终概率第三类异常心拍的最终概率8.根据权利要求1所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于：所述的步骤C中，首先通过得到的待检测心拍在对应心拍类别下的最终概率；，与设定的该心拍类别下的概率阈值进行大小判断，若待检测心拍在该心拍类别下的最终概率大于概率阈值thr，则判定待检测心拍属于对应的心拍类别；再根据下述判断条件对判别结果进一步校验：分别计算待检测心拍的Q波间期、Q波幅值、ST段抬高幅度，并设定Q波间期阈值、Q波幅值阈值、ST段抬高幅度阈值和T波幅值阈值；如果心拍有Q波，且同时满足Q波间期小于等于Q波间期阈值、ST段抬高幅度高于ST段抬高幅度阈值和T波的幅值大于T波幅值阈值；或者心拍无Q波，且ST段抬高幅度高于ST段抬高幅度阈值，同时T波的幅值大于T波幅值阈值；则上述两种情况均属于第一类异常心拍；如果心拍有Q波，且同时满足Q波间期大于Q波间期阈值、Q波幅值大于Q波幅值阈值和ST段抬高幅度高于ST段抬高幅度阈值，则属于第二类异常心拍；如果心拍有Q波，且同时满足Q波间期大于Q波间期阈值、Q波幅值大于Q波幅值阈值和ST段抬高幅度低于ST段抬高幅度阈值，则属于第三类异常心拍；如果心拍有Q波，且Q波间期小于等于Q波间期阈值，同时ST段抬高幅度不高于ST段抬高幅度阈值；或者心拍无Q波，同时ST段抬高幅度不高于ST段抬高幅度阈值；则上述两种情况均属于正常心拍。9.根据权利要求8所述的基于深度学习与诊断规则的心拍形态识别方法，其特征在于：所述的步骤C中，对于T波幅值阈值根据待检测心拍所属不同导联取值不同，其中V2、V3、V4和V5导联的T波，T波幅值阈值增加20％-50％；对于I、II、AVF、V1和V6导联的T波，T波幅值阈值不变；对于III和AVL导联的T波，T波幅值阈值减少50％-70％；对于ST段抬高幅度阈值根据患者性别和待检测心拍所属不同导联取值不同，对于V2和V3导联ST段抬高幅度，如果患者为女性则ST段抬高幅度阈值减少15％-40％，如果患者为大于等于40岁的男性则ST段抬高幅度阈值不变，如果患者为小于40岁的男性则ST段抬高幅度阈值减少15％-40％，其它导联ST段抬高幅度阈值减少40％-60％。10.一种利用权利要求1至9中任意一项所述的基于深度学习与诊断规则的心拍形态识别方法的心拍形态系统，其特征在于：包括心拍提取模块、心拍识别模块和心拍修正模块；所述的心拍提取模块，包括心电信号采集单元和心拍提取单元；心电信号采集单元用于基于多导联心电系统采集多导联心电信号并进行数据预处理，去除基线干扰和噪声干扰的心电信号；心拍提取单元用于提取心电信号采集单元输出的心电信号的QRS波起止点和T波终止点，确定待检测心拍；所述的心拍识别模块，包括动态链接库、特征提取单元和形态识别单元；动态链接库用于封装特征提取单元；特征提取单元，用于调用动态链接库中基于DenseNet深度神经网络，并通过多个卷积核长度均不相同的基于DenseNet的深度神经网络生成不同类别的心拍概率，然后通过融合决策的方法确定各个类别心拍概率的最终概率；所述的心拍修正模块，用于根据心拍识别模块输出的最终概率，结合设定的概率阈值，判断待检测心拍所属的心拍类别；并利用诊断规则条件进一步校验待检测心拍的类别。
说明书desc
技术领域本发明涉及心电信号识别领域，尤其涉及一种基于深度学习与诊断规则的心拍形态识别方法及系统。背景技术心电图各个导联包含有周期性变化的心拍，每个心拍主要由四波P波、QRS波、T波、T波和四段PR间期、QRS时间、ST段和QT间期组成。其中QRS形态、ST段形态和T波形态对诊断心肌梗死等疾病具有重要意义。现有的QRS波形态识别方法包含小波变换法、自适应阈值搜索法、人工设计特征与支持向量机法和深度学习方法等；ST段形态识别方法包含斜率法与函数拟合法、基于规则的方法、曲率空间法、人工设计特征与支持向量机法和深度学习方法等；T波形态识别方法包含小波变换法、数学模板法、人工设计特征与支持向量机法和深度学习方法等。大部分传统方法都依赖于特征点提取的准确率，存在自适应性不强、易受噪声干扰鲁棒性差和识别准确率不高的缺陷。基于深度学习方法的QRS波、ST段和T波形态识别方法则需要候选段，而候选段的提取又依赖于经验参数，且ST段和T波形态的识别与QRS波有关，单独识别其形态无法直接应用于临床。发明内容本发明的目的是提供一种基于深度学习与诊断规则的心拍形态识别方法及系统，能够解决现有技术中对心梗患者QRS波、ST段和T波形态识别时依赖于特征点检测的准确性、自适应性差和易受噪声干扰鲁棒性差的缺陷，具有较高的识别准确率。本发明采用下述技术方案：一种基于深度学习与诊断规则的心拍形态识别方法，依次包括以下步骤：A：获取待检测心拍，然后通过m个基于DenseNet的深度神经网络，分别生成待检测心拍中不同类别的心拍概率；其中，不同类别的心拍概率包括：正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率；m个基于DenseNet的深度神经网络的卷积核长度均不相同；B：根据步骤A中得到的每个基于DenseNet的深度神经网络生成不同类别的心拍概率，通过融合决策的方法确定各个类别心拍概率的最终概率；C：根据步骤B中得到的各个类别心拍概率的最终概率，结合设定的概率阈值，判断待检测心拍所属的心拍类别；并利用下述诊断规则条件进一步校验待检测心拍的类别：条件1：待检测心拍有无Q波；条件2：待检测心拍的Q波间期数值；条件3：待检测心拍的Q波幅值；条件4：待检测心拍的ST段抬高幅度数值；条件5：待检测心拍的的T波幅值。所述的步骤A包括以下具体步骤：A1：获取待检测心拍，并对获取待检测心拍进行数据预处理，得到预处理后的已去除基线干扰和噪声干扰的心电信号；A2：通过m个基于DenseNet的深度神经网络，分别对应生成待检测心拍中不同类别的心拍概率，即正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率；其中，第一类异常心拍，具体表现为无病理Q波、ST段典型抬高和T波高耸；第二类异常心拍，具体表现为有病理Q波和ST段典型抬高；第三类异常心拍，具体表现为有病理Q波和ST段不抬高；正常心拍，具体表现为无病理Q波和ST段不抬高。所述的基于DenseNet的深度神经网络包含三个稠密连接块、两个过渡连接块、一个全局平均池化块、一个平化块和一个输出块；其中，每个稠密连接块均包含两个一维卷积层、两个归一化层、两个线性修正单元层和两个跳层连接层；每个过渡连接块均包含一个一维卷积层、一个一维平均池化层、一个归一化层和一个线性修正单元层。所述的基于DenseNet的深度神经网络的进行生成时：第一稠密连接块通过第一稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对待检测心拍进行卷积，得到第一卷积特征；第一稠密连接块通过第一稠密连接块内的第一跳层连接层，对第一稠密连接块的输入和第一卷积特征进行融合，得到第一融合特征；第一稠密连接块通过第一稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第一融合特征进行卷积，得到第二卷积特征；第一稠密连接块通过第一稠密连接块内的第二跳层连接层，对第一稠密连接块的输入、第一融合特征和第二卷积特征进行融合，得到第二融合特征；第一过渡连接块通过第一过渡连接块内的一维卷积层、归一化层和线性修正单元层，对第二融合特征进行卷积得到第三卷积特征；第一过渡连接块通过第一过渡连接块内的一维平均池化层，对第三卷积特征进行降维，得到第一去冗余降维特征；第二稠密连接块通过第二稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对第一去冗余降维特征进行卷积，得到第四卷积特征；第二稠密连接块通过第二稠密连接块内的第一跳层连接层，对第一去冗余降维特征和第四卷积特征进行融合，得到第三融合特征；第二稠密连接块通过第二个稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第三融合特征进行卷积，得到第五卷积特征；第二稠密连接块通过第二个稠密连接块内的第二跳层连接层，对第一去冗余降维特征、第三融合特征和第五卷积特征进行融合，得到第四融合特征；第二过渡连接块通过第二过渡连接块内的一维卷积层、归一化层和线性修正单元层，对第四融合特征进行卷积，得到第六卷积特征；第二过渡连接块通过第二过渡连接块内的一维平均池化层，对第六卷积特征进行降维，得到第二去冗余降维特征；第三稠密连接块通过第三稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对第二去冗余降维特征进行卷积，得到第七卷积特征；第三稠密连接块通过第三稠密连接块内的第一跳层连接层，对第二去冗余降维特征和第七卷积特征进行融合，得到第五融合特征；第三稠密连接块通过第三稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第五融合特征进行卷积，得到第八卷积特征；第三稠密连接块通过第三稠密连接块内的跳层连接层，对第二去冗余降维特征、第五融合特征和第八卷积特征进行融合，得到第六融合特征；全局平均池化块对第六融合特征进行全局平均池化，即计算第六融合特征在每个特征映射上特征的平均值，得到全局平均池化特征；平化层将全局平均池化特征进行平化，获得平化特征；输出层将平化特征输入至以softmax作为激活函数的神经网络层，输出心拍属于正常心拍的概率P11、第一类异常心拍的概率P12、第二类异常心拍的概率P13和第三类异常心拍的概率P14。所述的基于DenseNet的深度神经网络的损失函数采用基于加权平均的交叉熵损失函数；基于加权平均的交叉熵损失函数L为：其中，N表示心拍形态类别总数，n表示心拍形态类别的索引值，Q为样本总量，i为样本的索引值，y是模型实际输出，1为判断函数，若中括号内成立输出1，否则为0；Wi和bi分别表示对应异常心拍类别的权重矩阵和偏置，x表示平化特征，Kn为不同形态心拍样本的惩罚系数，an表示不同形态的心拍数量。将m个基于DenseNet的深度神经网络输出不同类别的心拍概率记为矩阵P，其中，P11至Pm1、P12至Pm2、P13至Pm3和P14至Pm4，分别表示第1个至第m个基于DenseNet的深度神经网络输出的正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率。所述的步骤B中，融合决策的方法是计算m个基于DenseNet的深度神经网络输出概率值的均值Z，使用Z矩阵的最大值做为所属心拍类别k的最终概率Zk；Z＝；正常心拍的最终概率第一类异常心拍的最终概率第二类异常心拍的最终概率第三类异常心拍的最终概率所述的步骤C中，首先通过得到的待检测心拍在对应心拍类别下的最终概率，与设定的该心拍类别下的概率阈值进行大小判断，若待检测心拍在该心拍类别下的最终概率大于概率阈值thr，则判定待检测心拍属于对应的心拍类别；再根据下述判断条件对判别结果进一步校验：分别计算待检测心拍的Q波间期、Q波幅值、ST段抬高幅度，并设定Q波间期阈值、Q波幅值阈值、ST段抬高幅度阈值和T波幅值阈值；如果心拍有Q波，且同时满足Q波间期小于等于Q波间期阈值、ST段抬高幅度高于ST段抬高幅度阈值和T波的幅值大于T波幅值阈值；或者心拍无Q波，且ST段抬高幅度高于ST段抬高幅度阈值，同时T波的幅值大于T波幅值阈值；则上述两种情况均属于第一类异常心拍；如果心拍有Q波，且同时满足Q波间期大于Q波间期阈值、Q波幅值大于Q波幅值阈值和ST段抬高幅度高于ST段抬高幅度阈值，则属于第二类异常心拍；如果心拍有Q波，且同时满足Q波间期大于Q波间期阈值、Q波幅值大于Q波幅值阈值和ST段抬高幅度低于ST段抬高幅度阈值，则属于第三类异常心拍；如果心拍有Q波，且Q波间期小于等于Q波间期阈值，同时ST段抬高幅度不高于ST段抬高幅度阈值；或者心拍无Q波，同时ST段抬高幅度不高于ST段抬高幅度阈值；则上述两种情况均属于正常心拍。所述的步骤C中，对于T波幅值阈值根据待检测心拍所属不同导联取值不同，其中V2、V3、V4和V5导联的T波，T波幅值阈值增加20％-50％；对于I、II、AVF、V1和V6导联的T波，T波幅值阈值不变；对于III和AVL导联的T波，T波幅值阈值减少50％-70％；对于ST段抬高幅度阈值根据患者性别和待检测心拍所属不同导联取值不同，对于V2和V3导联ST段抬高幅度，如果患者为女性则ST段抬高幅度阈值减少15％-40％，如果患者为大于等于40岁的男性则ST段抬高幅度阈值不变，如果患者为小于40岁的男性则ST段抬高幅度阈值减少15％-40％，其它导联ST段抬高幅度阈值减少40％-60％。一种基于深度学习与诊断规则的心拍形态识别方法的心拍形态系统，包括心拍提取模块、心拍识别模块和心拍修正模块；所述的心拍提取模块，包括心电信号采集单元和心拍提取单元；心电信号采集单元用于基于多导联心电系统采集多导联心电信号并进行数据预处理，去除基线干扰和噪声干扰的心电信号；心拍提取单元用于提取心电信号采集单元输出的心电信号的QRS波起止点和T波终止点，确定待检测心拍；所述的心拍识别模块，包括动态链接库、特征提取单元和形态识别单元；动态链接库用于封装特征提取单元；特征提取单元，用于调用动态链接库中基于DenseNet深度神经网络，并通过多个卷积核长度均不相同的基于DenseNet的深度神经网络生成不同类别的心拍概率，然后通过融合决策的方法确定各个类别心拍概率的最终概率；所述的心拍修正模块，用于根据心拍识别模块输出的最终概率，结合设定的概率阈值，判断待检测心拍所属的心拍类别；并利用诊断规则条件进一步校验待检测心拍的类别。本发明中，利用基于DenseNet网络的稠密连接块和过渡连接块，能够使心电拍各波段特征在各层之进行传递与重用，有效增强了心拍QRS波、ST段和T波整体形态特征的表达能力；本发明还通过基于集成学习对不同尺度的多个DenseNet网络进行融合决策，能够有效提高心拍形态识别性能；本发明中结合心拍的Q波间期、Q波幅值和ST段抬高幅度和诊断规则，对判断结构进行进一步的修正，能够有效降低心拍形态识别的漏检率和误检率。附图说明图1为本发明的流程示意图。具体实施方式以下结合附图和实施例对本发明作以详细的描述：如图1所示，本发明所述的基于深度学习与诊断规则的心拍形态识别方法，依次包括以下步骤：A：获取待检测心拍，然后通过m个基于DenseNet的深度神经网络，分别生成待检测心拍中不同类别的心拍概率；其中，不同类别的心拍概率包括：正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率；m个基于DenseNet的深度神经网络的卷积核长度均不相同。本发明中，步骤A包含以下具体步骤：A1：获取待检测心拍，并对获取待检测心拍进行数据预处理，得到预处理后的已去除基线干扰和噪声干扰的心电信号；本实施例中，对多导联心电信号中的每个导联信号，利用基于db6小波的离散小波变换去除基线干扰，并利用0.5～40Hz的三阶巴特沃斯带通滤波器去除高频和低频噪声，得到去除基线干扰和噪声干扰的心电信号；提取预处理后的心电信号的QRS波起止点和T波终止点，确定待检测心拍Y＝{y,t＝1,2,…M}，其中M表示心拍采用点个数，本实施例中，M可为256；不同类别的心拍形态如下所述：第一类异常心拍，具体表现为无病理Q波、ST段典型抬高和T波高耸；第二类异常心拍，具体表现为有病理Q波和ST段典型抬高；第三类异常心拍，具体表现为有病理Q波和ST段不抬高；正常心拍，具体表现为无病理Q波和ST段不抬高。A2：通过m个基于DenseNet的深度神经网络，分别对应生成待检测心拍中不同类别的心拍概率，即正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率；其中，m个基于DenseNet的深度神经网络的卷积核长度均不相同。本实施例中，基于DenseNet的深度神经网络包含三个稠密连接块、两个过渡连接块、一个全局平均池化块、一个平化块和一个输出块；其中，每个稠密连接块均包含两个一维卷积层、两个归一化层、两个线性修正单元层和两个跳层连接层；每个过渡连接块均包含一个一维卷积层、一个一维平均池化层、一个归一化层和一个线性修正单元层。在进行基于DenseNet的深度神经网络的生成时：第一稠密连接块通过第一稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对待检测心拍进行卷积，得到第一卷积特征；第一稠密连接块通过第一稠密连接块内的第一跳层连接层，对第一稠密连接块的输入和第一卷积特征进行融合，得到第一融合特征；第一稠密连接块通过第一稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第一融合特征进行卷积，得到第二卷积特征；第一稠密连接块通过第一稠密连接块内的第二跳层连接层，对第一稠密连接块的输入、第一融合特征和第二卷积特征进行融合，得到第二融合特征；第一过渡连接块通过第一过渡连接块内的一维卷积层、归一化层和线性修正单元层，对第二融合特征进行卷积得到第三卷积特征；第一过渡连接块通过第一过渡连接块内的一维平均池化层，对第三卷积特征进行降维，得到第一去冗余降维特征；第二稠密连接块通过第二稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对第一去冗余降维特征进行卷积，得到第四卷积特征；第二稠密连接块通过第二稠密连接块内的第一跳层连接层，对第一去冗余降维特征和第四卷积特征进行融合，得到第三融合特征；第二稠密连接块通过第二个稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第三融合特征进行卷积，得到第五卷积特征；第二稠密连接块通过第二个稠密连接块内的第二跳层连接层，对第一去冗余降维特征、第三融合特征和第五卷积特征进行融合，得到第四融合特征；第二过渡连接块通过第二过渡连接块内的一维卷积层、归一化层和线性修正单元层，对第四融合特征进行卷积，得到第六卷积特征；第二过渡连接块通过第二过渡连接块内的一维平均池化层，对第六卷积特征进行降维，得到第二去冗余降维特征；第三稠密连接块通过第三稠密连接块内的第一一维卷积层、第一归一化层和第一线性修正单元层，对第二去冗余降维特征进行卷积，得到第七卷积特征；第三稠密连接块通过第三稠密连接块内的第一跳层连接层，对第二去冗余降维特征和第七卷积特征进行融合，得到第五融合特征；第三稠密连接块通过第三稠密连接块内的第二一维卷积层、第二归一化层和第二线性修正单元层，对第五融合特征进行卷积，得到第八卷积特征；第三稠密连接块通过第三稠密连接块内的跳层连接层，对第二去冗余降维特征、第五融合特征和第八卷积特征进行融合，得到第六融合特征；全局平均池化块对第六融合特征进行全局平均池化，即计算第六融合特征在每个特征映射上特征的平均值，得到全局平均池化特征；平化层将全局平均池化特征进行平化，获得平化特征；输出层将平化特征输入至以softmax作为激活函数的神经网络层，输出心拍属于正常心拍的概率P11、第一类异常心拍的概率P12、第二类异常心拍的概率P13和第三类异常心拍的概率P14；本发明中，基于DenseNet的深度神经网络的损失函数采用基于加权平均的交叉熵损失函数；基于加权平均的交叉熵损失函数L为：其中，N表示心拍形态类别总数，n表示心拍形态类别的索引值，Q为样本总量，i为样本的索引值，y是模型实际输出，1为判断函数，若中括号内成立输出1，否则为0；Wi和bi分别表示对应异常心拍类别的权重矩阵和偏置，x表示平化特征，Kn为不同形态心拍样本的惩罚系数，可表示为：其中，an表示不同形态的心拍数量；将m个基于DenseNet的深度神经网络输出不同类别的心拍概率记为矩阵P，其中，P11至Pm1、P12至Pm2、P13至Pm3和P14至Pm4，分别表示第1个至第m个基于DenseNet的深度神经网络输出的正常心拍的概率、第一类异常心拍的概率、第二类异常心拍的概率和第三类异常心拍的概率；实施例中，可采用3个基于DenseNet的深度神经网络，卷积核的长度分别为7、11和15，模型生长率均为32。B：根据步骤A中得到的每个基于DenseNet的深度神经网络生成不同类别的心拍概率，通过融合决策的方法确定各个类别心拍概率的最终概率；本发明中，融合决策的方法是计算m个基于DenseNet的深度神经网络输出概率值的均值Z，使用Z矩阵的最大值做为所属心拍类别k的最终概率Zk；Z＝；正常心拍的最终概率第一类异常心拍的最终概率第二类异常心拍的最终概率第三类异常心拍的最终概率C：根据步骤B中得到的各个类别的心拍概率的最终概率，结合设定的概率阈值，判断待检测心拍所属的心拍类别；并利用下述诊断规则条件进一步校验待检测心拍的类别：条件1：待检测心拍有无Q波；条件2：待检测心拍的Q波间期数值；条件3：待检测心拍的Q波幅值；条件4：待检测心拍的ST段抬高幅度数值；条件5：待检测心拍的的T波幅值。本发明中，首先通过得到的待检测心拍在对应心拍类别下的最终概率，与设定的该心拍类别下的概率阈值进行大小判断，若待检测心拍在该心拍类别下的最终概率大于概率阈值thr，则判定待检测心拍属于对应的心拍类别。本实施例中，在对待检测心拍的类别进行判别后，再根据下述判断条件对判别结果进一步校验：分别计算待检测心拍的Q波间期、Q波幅值、ST段抬高幅度，并设定Q波间期阈值、Q波幅值阈值、ST段抬高幅度阈值和T波幅值阈值；如果心拍有Q波，且同时满足Q波间期小于等于Q波间期阈值、ST段抬高幅度高于ST段抬高幅度阈值和T波的幅值大于T波幅值阈值；或者心拍无Q波，且ST段抬高幅度高于ST段抬高幅度阈值，同时T波的幅值大于T波幅值阈值；则上述两种情况均属于第一类异常心拍；如果心拍有Q波，且同时满足Q波间期大于Q波间期阈值、Q波幅值大于Q波幅值阈值和ST段抬高幅度高于ST段抬高幅度阈值，则属于第二类异常心拍；如果心拍有Q波，且同时满足Q波间期大于Q波间期阈值、Q波幅值大于Q波幅值阈值和ST段抬高幅度低于ST段抬高幅度阈值，则属于第三类异常心拍；如果心拍有Q波，且Q波间期小于等于Q波间期阈值，同时ST段抬高幅度不高于ST段抬高幅度阈值；或者心拍无Q波，同时ST段抬高幅度不高于ST段抬高幅度阈值；则上述两种情况均属于正常心拍。本实施例中，Q波间期阈值为0.03s，Q波幅值阈值为0.1mV，ST段抬高幅度阈值为0.2mV，T波幅值阈值为0.5mV。考虑个体差异等因素对心拍形态准确率的影响，本发明针对ST段抬高幅度阈值V和T波幅值阈值进行进一步限定。对于T波幅值阈值U根据待检测心拍所属不同导联取值不同，其中V2、V3、V4和V5导联的T波，T波幅值阈值增加20％-50％，本实施例中增加至U＝0.7mV；对于I、II、AVF、V1和V6导联的T波，T波幅值阈值不变，U＝0.5mV；对于III和AVL导联的T波，T波幅值阈值减少50％-70％，本实施例中减少至U＝0.2mV。对于ST段抬高幅度阈值V根据患者性别和待检测心拍所属不同导联取值不同，对于V2和V3导联ST段抬高幅度，如果患者为女性则ST段抬高幅度阈值减少15％-40％，本实施例中减少至V＝0.15mV，如果患者为大于等于40岁的男性则ST段抬高幅度阈值不变，V＝0.2mV，如果患者为小于40岁的男性则ST段抬高幅度阈值减少15％-40％，本实施例中减少至V＝0.15mV，其它导联ST段抬高幅度阈值减少40％-60％，本实施例中减少至V＝0.1mV。利用上文所述的心拍形态识别方法的心拍形态系统，包括心拍提取模块、心拍识别模块和心拍修正模块；所述的心拍提取模块，包括心电信号采集单元和心拍提取单元；心电信号采集单元用于基于多导联心电系统采集多导联心电信号并进行数据预处理，去除基线干扰和噪声干扰的心电信号；心拍提取单元用于提取心电信号采集单元输出的心电信号的QRS波起止点和T波终止点，确定待检测心拍；心拍提取模块执行上文步骤A中的方法以实现相关功能。所述的心拍识别模块，包括动态链接库、特征提取单元和形态识别单元；动态链接库用于封装特征提取单元；特征提取单元，用于调用动态链接库中基于DenseNet深度神经网络，并通过多个卷积核长度均不相同的基于DenseNet的深度神经网络生成不同类别的心拍概率，然后通过融合决策的方法确定各个类别心拍概率的最终概率。心拍识别模块执行上文步骤B中的方法以实现相关功能。所述的心拍修正模块，用于根据心拍识别模块输出的最终概率，结合设定的概率阈值，判断待检测心拍所属的心拍类别；并利用诊断规则条件进一步校验待检测心拍的类别。心拍修正模块执行上文步骤C中的方法以实现相关功能。本发明中还可增设或连接现实设备，以显示心拍形态识别的结果。
