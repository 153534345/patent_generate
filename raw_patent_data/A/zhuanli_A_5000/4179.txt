标题title
一种基于BCG信号与PPG信号融合的生理监测系统
摘要abst
本发明涉及一种基于BCG信号与PPG信号融合的生理监测系统，包括：BCG信号采集系统，用于采集人体的BCG信号；PPG信号采集系统，用于采集人体的PPG信号；上位机，用于接收所述BCG信号采集系统采集的BCG信号与所述PPG信号采集系统采集的PPG信号数据，并对两种信号数据进行分析，并对分析结果采用非线性拟合的方式进行融合得到最终的生理参数信息。本发明能够提高监测的准确性。
权利要求书clms
1.一种基于BCG信号与PPG信号融合的生理监测系统，其特征在于，包括：BCG信号采集系统，用于采集人体的BCG信号；PPG信号采集系统，用于采集人体的PPG信号；上位机，用于接收所述BCG信号采集系统采集的BCG信号与所述PPG信号采集系统采集的PPG信号数据，并对两种信号数据进行分析，并对分析结果采用非线性拟合的方式进行融合得到最终的生理参数信息。2.根据权利要求1所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述的BCG信号采集系统包括：压阻传感器，用于采集原始BCG信号；BCG预处理模块，用于对所述原始BCG信号进行预处理；BCG信号采集芯片，用于采集预处理后的BCG信号；BCG信号数据接口，用于将所述BCG信号采集芯片采集到的BCG信号传输至所述上位机。3.根据权利要求2所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述BCG预处理模块包括：BCG信号放大器，用于对所述原始BCG信号进行放大；BCG信号滤波器，用于对放大后的原始BCG信号进行滤波。4.根据权利要求1所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述的PPG信号采集系统包括：PPG探头，用于采集原始PPG信号；PPG预处理模块，用于对所述原始PPG信号进行预处理；PPG信号采集芯片，用于采集预处理后的PPG信号；PPG信号数据接口，用于将所述PPG信号采集芯片采集到的PPG信号传输至所述上位机。5.根据权利要求1所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述PPG预处理模块包括：PPG信号放大器，用于对所述原始PPG信号进行放大；PPG信号滤波器，用于对放大后的原始PPG信号进行滤波。6.根据权利要求1所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述上位机包括：BCG信号数据接口，用于接收所述BCG信号采集系统采集的BCG信号；PPG信号数据接口，用于接收所述PPG信号采集系统采集的PGG信号；数据同步模块，用于将所接收的PPG信号与BCG信号进行时间层面同步以及数据格式层面同步；BCG数据分析模块，用于分析经过同步处理的BCG信号，得到第一生理参数信息，具体为：在BCG信号的波形上检测BCG峰值J波的位置，并确定BCG信号的波形中相邻J波的间隔时间；PPG数据分析模块，用于分析经过同步处理的PPG信号，得到第二生理参数信息，具体为：在PPG信号的波形上检测峰值A波的位置，并确定PPG信号的波形中相邻峰谷值的间隔时间以及BCG信号的波形中峰值J波与相邻PPG信号的波形中峰值A波的间隔时间；非线性拟合模型模块，用于对所述第一生理参数信息和所述第二生理参数信息进行非线性拟合，具体为：根据所述BCG信号的波形中相邻J波的间隔时间和所述PPG信号的波形的相邻峰谷值的间隔时间以及根据所述BCG信号的波形的峰值J波与相邻PPG信号的波形中峰值A波的间隔时间计算生理参数。7.根据权利要求6所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述生理参数为血压时，所述非线性拟合模型模块根据所述BCG信号的波形的峰值J波与相邻PPG信号的波形中峰值A波的间隔时间进行计算，其非线性拟合形式为：BP_MEAN＝a*e-b*JATD+c，其中，BP_MEAN为计算得到的血压数据、a、b、c、e均为校准系数，JATD为所述BCG信号的波形的峰值J波与相邻PPG信号的波形中峰值A波的间隔时间。8.根据权利要求7所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述生理参数为心率时，所述非线性拟合模型模块根据所述BCG信号的波形中相邻J波的间隔时间和所述PPG信号的波形的相邻峰谷值的间隔时间进行计算，其非线性拟合形式为：HR＝HR0+-HR0)*MAX/ALL_ER+-HR0)*MIN/ALL_ER，其中，HR为计算得到的心率数据，HR0为上一次的心率测量结果，HR_BCG为根据所述BCG信号的波形中相邻J波的间隔时间推算的心率，HR_PPG为根据所述PPG信号的波形中相邻峰谷值的间隔时间推算的心率，BCG_ER为HR_BCG与HR0的差值的绝对值，PPG_ER为HR_PPG与HR0的差值的绝对值，ALL_ER为BCG_ER与PPG_ER的和。9.根据权利要求6所述的基于BCG信号与PPG信号融合的生理监测系统，其特征在于，所述上位机还包括：数据显示模块，用于将所述非线性拟合模型模块输出的生理参数进行显示。
说明书desc
技术领域本发明涉及生理监测技术领域，特别是涉及一种基于BCG信号与PPG信号融合的生理监测系统。背景技术心脏跳动周期中心脏泵血能引起身体产生相应的运动，通过高灵敏度传感器拾取该运动信号，并将其描记成波形，该波形称为心冲击图。因为BCG 信号记录的是心脏泵血引起的与心搏同步的身体运动，所以BCG信号间接反映了心脏动力和运动状态。对BCG信号进行分析可以获取与之相关的生命体征或生理参数，并有可能对相关疾病进行预测、诊断或跟踪监测。近二十年来，随着传感器、电子和信号处理与分析等技术的快速发展，BCG信号检测变得更加方便，测量精度也大为提高，BCG技术本身又具备无创、非接触式和可长期连续监测等优点，因此，BCG信号被应用于心率、睡眠结构分析、心脏功能监测和评价等方面的定性、定量研究和临床应用，并取得了一定的研究成果。光电容积描记术是通过光电技术记录由心脏舒缩活动引起皮肤下微血管组织中血容量的变化，它是一种非侵入性光学生物监测技术，具有使用简单、无创、便携、准确、实时、可重复等特点。随着光电技术的不断发展，PPG在医学领域的应用也愈加广泛。PPG波形不仅可以收集心率、血压、呼吸、脉搏血氧饱和度等相关生理病理参数，而且可用于评估心输出量、血容量、动脉有无硬化或狭窄、高血压、糖尿病微血管病变和心血管危险因素等，PPG已被用于研究心血管功能，在远程医疗、疾病监测等方面具有广泛的应用前景。但是BCG信号和PPG信号的采集都会受到外界因素干扰，如：运动伪影、温度、噪音等，虽然有些研究运用不同的算法消除了个别因素的干扰得到了可观的结果，但其在疾病监测与诊断方面还需要大样本的随机对照实验及数据的支持。并且，单一BCG信号与 PPG信号所分析得到的生理参数与实际生理参数相关度较低，存在定性判断不准确的问题。发明内容本发明所要解决的技术问题是提供一种基于BCG信号与PPG信号融合的生理监测系统，能够提高监测的准确性。本发明解决其技术问题所采用的技术方案是：提供一种基于BCG信号与PPG信号融合的生理监测系统，包括：BCG信号采集系统，用于采集人体的BCG信号；PPG信号采集系统，用于采集人体的PPG信号；上位机，用于接收所述BCG信号采集系统采集的BCG信号与所述PPG信号采集系统采集的PPG信号数据，并对两种信号数据进行分析，并对分析结果采用非线性拟合的方式进行融合得到最终的生理参数信息。所述的BCG信号采集系统包括：压阻传感器，用于采集原始BCG信号；BCG预处理模块，用于对所述原始BCG信号进行预处理；BCG信号采集芯片，用于采集预处理后的 BCG信号；BCG信号数据接口，用于将所述BCG信号采集芯片采集到的BCG信号传输至所述上位机。所述BCG预处理模块包括：BCG信号放大器，用于对所述原始BCG信号进行放大；BCG信号滤波器，用于对放大后的原始BCG信号进行滤波。所述的PPG信号采集系统包括：PPG探头，用于采集原始PPG信号；PPG预处理模块，用于对所述原始PPG信号进行预处理；PPG信号采集芯片，用于采集预处理后的PPG 信号；PPG信号数据接口，用于将所述PPG信号采集芯片采集到的PPG信号传输至所述上位机。所述PPG预处理模块包括：PPG信号放大器，用于对所述原始PPG信号进行放大；PPG信号滤波器，用于对放大后的原始PPG信号进行滤波。所述上位机包括：BCG信号数据接口，用于接收所述BCG信号采集系统采集的BCG信号；PPG信号数据接口，用于接收所述PPG信号采集系统采集的PGG信号；数据同步模块，用于将所接收的PPG信号与BCG信号进行时间层面同步以及数据格式层面同步； BCG数据分析模块，用于分析经过同步处理的BCG信号，得到第一生理参数信息，具体为：在BCG信号的波形上检测BCG峰值J波的位置，并确定BCG信号的波形中相邻J 波的间隔时间；PPG数据分析模块，用于分析经过同步处理的PPG信号，得到第二生理参数信息，具体为：在PPG信号的波形上检测峰值A波的位置，并确定PPG信号的波形中相邻峰谷值的间隔时间以及BCG信号的波形中峰值J波与相邻PPG信号的波形中峰值A 波的间隔时间；非线性拟合模型模块，用于对所述第一生理参数信息和所述第二生理参数信息进行非线性拟合，具体为：根据所述BCG信号的波形中相邻J波的间隔时间和所述PPG信号的波形的相邻峰谷值的间隔时间以及根据所述BCG信号的波形的峰值J波与相邻PPG信号的波形中峰值A波的间隔时间计算生理参数。所述生理参数为血压时，所述非线性拟合模型模块根据所述BCG信号的波形的峰值J 波与相邻PPG信号的波形峰值A波的间隔时间进行计算，其非线性拟合形式为： BP_MEAN＝a*e-b*JATD+c，其中，BP_MEAN为计算得到的血压数据、a、b、c、e均为校准系数，JATD为所述BCG信号的波形的峰值J波与相邻PPG信号的波形中峰值A波的间隔时间。所述生理参数为心率时，所述非线性拟合模型模块根据所述BCG信号的波形中相邻J 波的间隔时间和所述PPG信号的波形中相邻峰谷值的间隔时间进行计算，其非线性拟合形式为：HR＝HR0+-HR0)*MAX/ALL_ER+ -HR0)*MIN/ALL_ER，其中，HR为计算得到的心率数据，HR0为上一次的心率测量结果，HR_BCG为根据所述BCG信号的波形中相邻J波的间隔时间推算的心率，HR_PPG为根据所述PPG信号的波形中相邻峰谷值的间隔时间推算的心率，BCG_ER为HR_BCG与HR0的差值的绝对值，PPG_ER为HR_PPG 与HR0的差值的绝对值，ALL_ER为BCG_ER与PPG_ER的和。所述上位机还包括：数据显示模块，用于将所述非线性拟合模型模块输出的生理参数进行显示。有益效果由于采用了上述的技术方案，本发明与现有技术相比，具有以下的优点和积极效果：本发明同时采集BCG信号与PPG信号，并将两者单一分析得到的生理参数信息进行非线性拟合得到最终的生理参数信息，避免了单一信号受干扰后得到的生理参数信息可靠度不高的问题。附图说明图1为本发明实施方式的整体系统方框图；图2为本发明实施方式中BCG信号采集系统的方框图；图3为本发明实施方式中PPG信号采集系统的方框图；图4为本发明实施方式中的上位机的方框图；图5为本发明实施方式中数据同步模块输出数据的图形化波形图；图6为受测者的心率监测实验结果对比图；图7为受测者的血压监测实验结果对比图。具体实施方式下面结合具体实施例，进一步阐述本发明。应理解，这些实施例仅用于说明本发明而不用于限制本发明的范围。此外应理解，在阅读了本发明讲授的内容之后，本领域技术人员可以对本发明作各种改动或修改，这些等价形式同样落于本申请所附权利要求书所限定的范围。本发明的实施方式涉及一种基于BCG信号与PPG信号融合的生理监测系统，如图1所示，包括：BCG信号采集系统11，用于采集人体的BCG信号；PPG信号采集系统12，用于采集人体的PPG信号；上位机10，用于接收所述BCG信号采集系统采集的BCG信号与所述PPG信号采集系统采集的PPG信号数据，并对两种信号数据进行分析，并对分析结果采用非线性拟合的方式进行融合得到最终的生理参数信息。如图2所示，BCG信号采集系统11包括：压阻传感器111，用于采集原始BCG信号；BCG预处理模块，用于对所述原始BCG信号进行预处理；BCG信号采集芯片114，用于采集预处理后的BCG信号；BCG信号数据接口115，用于将所述BCG信号采集芯片采集到的BCG信号传输至所述上位机。其中，BCG预处理模块包括：BCG信号放大器112，用于对所述原始BCG信号进行放大；BCG信号滤波器113，用于对放大后的原始BCG信号进行滤波。本实施方式中的BCG信号采集系统11通过采用压阻传感器111测量心脏跳动周期中心脏泵血引起身体产生相应的运动信号来反应BCG信号，由于原始采集的BCG信号的信号量较小，因此原始采集的BCG信号需要传入BCG信号放大器112，BCG信号放大器112 用于原始采集的BCG信号的放大。由于BCG信号受人体微动的影响较大，因此经过放大后的BCG信号会由于环境因素带有不可避免的噪声信号，需要传入BCG信号滤波器113， BCG信号滤波器113用于将其中所夹杂的噪声信号进行滤除。经过放大和滤波的BCG信号已满足采集要求，BCG信号采集芯片114用于采集已经过放大和滤波的BCG信号并且将其转化为信号数据。BCG信号数据接口115用于将BCG信号采集芯片114所转化的信号数据传入上位机10以供后续的数据分析和显示。如图3所示，PPG信号采集系统12包括：PPG探头121，用于采集原始PPG信号； PPG预处理模块，用于对所述原始PPG信号进行预处理；PPG信号采集芯片124，用于采集预处理后的PPG信号；PPG信号数据接口125，用于将所述PPG信号采集芯片采集到的PPG信号传输至所述上位机。其中，所述PPG预处理模块包括：PPG信号放大器122，用于对所述原始PPG信号进行放大；PPG信号滤波器123，用于对放大后的原始PPG信号进行滤波。本实施方式中的PPG信号采集系统12通过采用PPG探头121记录由心脏舒缩活动引起皮肤下微血管组织中血容量的变化来反应PPG信号，由于原始采集的PPG信号的信号量较小，因此原始采集的PPG信号需要传入PPG信号放大器122，PPG信号放大器122 用于原始采集的PPG信号的放大。由于PPG信号受外界环境光环境的影响较大，因此放大后的PPG信号会由于环境因素带有不可避免的噪声信号，需要传入PPG信号滤波器123， PPG信号滤波器123用于将其中所夹杂的噪声信号进行滤除。经过放大和滤波的PCG信号已满足采集要求，PCG信号采集芯片124用于采集已经过放大和滤波的PCG信号并且将其转化为信号数据。PCG信号数据接口125用于将PCG信号采集芯片124所转化的信号数据传入上位机10以供后续的数据分析和显示。如图4所示，上位机10包括：BCG信号数据接口101，用于接收所述BCG信号采集系统11采集的BCG信号；PPG信号数据接口102，用于接收所述PPG信号采集系统12 采集的PGG信号；数据同步模块103，用于将所接收的PPG信号与BCG信号进行时间层面同步以及数据格式层面同步；BCG数据分析模块104，用于分析经过同步处理的BCG 信号，得到第一生理参数信息；PPG数据分析模块105，用于分析经过同步处理的PPG信号，得到第二生理参数信息；非线性拟合模型模块106，用于对所述第一生理参数信息和所述第二生理参数信息进行非线性拟合；数据显示模块107，用于将所述非线性拟合模型模块输出的生理参数进行显示。具体地说，BCG信号数据接口101用于接收BCG信号采集系统11所采集的BCG信号数据，PPG信号数据接口102用于接收PPG信号采集系统12所采集的PPG信号数据。在信号数据采集与传送的过程中，可能会产生数据丢失或误码的现象，导致所接收的BCG 信号数据与PPG信号数据在时间上无法同步，因此需要将两个信号数据传入数据同步模块 103，数据同步模块103用于将所传入的两个信号数据进行时间上的同步与格式上的同步。时间同步的具体操作为校对两个信号数据的信号戳，对于存在信号戳有所偏差的数据帧，数据同步模块会识别数据帧的编号，进行适量的删减，将信号戳进行矫正，以达到数据时间上的同步。格式同步的具体操作为校对两个信号数据数据帧的发送帧格式，对于存在格式有所偏差的数据帧，数据同步模块会识别数据帧的编号，进行格式的对齐，以达到格式上的同步，同步后的BCG数据传入BCG数据分析模块104，BCG数据分析模块104用于针对单一BCG数据进行数据分析，并且输出对单一BCG数据进行数据分析后得到的与人体生理体征信息相关的第一生理参数。同步后的PPG数据传入PPG数据分析模块105， PPG数据分析模块105用于针对单一PPG数据进行数据分析，并且输出对单一PPG信号数据进行数据分析后得到的与人体生理体征信息相关的第二生理参数。由于单一BCG信号与PPG信号数据得到的人体生理参数不准确，因此得到的第一生理参数和第二生理参数需要传入非线性拟合模型模块106，非线性拟合模型模块106用于将单一BCG信号与PPG 信号数据所得到的人体生理参数进行非线性拟合，得到相关度更高以及更加准确的与人体生理体征信息相关的生理参数。根据具体实验，非线性拟合模型最终得到的生理参数与实际生理参数相关度高于单一模型得到的生理参数与实际生理参数相关度，数据显示模块 107用于将非线性拟合模型106输出的生理参数进行显示，显示的具体媒介可为是显示屏、打印纸等形式。图5示出了根据本实施方式中数据同步模块输出数据的图形化波形表示，包括BCG信号的波形21与PPG信号的波形22。其中，BCG信号的波形21的预定连续标记J波210与PPG信号的波形22的预定连续标记的A波220用于生理体征信息的推断。BCG数据分析模块104用于在BCG信号的波形21上检测BCG峰值J波210的位置，同时分析得到JJTD231，JJTD231为BCG信号的波形21最后中相邻J波210的间隔时间。PPG数据分析模块105用于在PPG信号的波形22上检测峰值A波220的位置，同时分析得到AATD232和JATD233。AATD233为PPG信号的波形23中相邻峰谷值的间隔时间，JATD233为BCG信号的波形21中峰值J波与相邻PPG信号的波形22中峰值A波的间隔时间。非线性拟合模型模块106根据相邻BCG信号峰值J波210的间隔时间，相邻PPG信号信号峰值A波的间隔时间进行心率的计算。心率数据的非线性拟合的形式为：HR_BCG＝60/JJTDHR_PPG＝60/AATDBCG_ER＝|HR_BCG-HR0|PPG_ER＝|HR_PPG-HR0| ALL_ER＝BCG_ER+PPG_ERHR＝HR0+-HR0)*MAX/ALL_ER+ -HR0)*MIN/ALL_ER其中，HR_BCG为根据JJTD数据推算的心率，HR_PPG为根据AATD数据推算的数据。HR为经过非线性拟合后的数据。HR0为上一次的心率测量结果。BCG_ER为HR_BCG与HR0的差值的绝对值。 PPG_ER为HR_PPG与HR0的差值的绝对值。ALL_ER为BCG_ER与PPG_ER的和。非线性拟合模型模块106根据BCG信号峰值J波210与相邻PPG信号信号峰值A波的间隔时间进行血压的计算。血压数据的非线性拟合的形式为：BP_MEAN＝a*e-b*JATD+c 其中，a、b、c、e均为校准系数。图6示出了受测者的心率实验结果。根据本实施方式，PPG信号从受测者的手指获取， BCG信号通过压阻传感器从受测者的足底获取，且使用商业数字示波法血压仪得到心率作为参考值。BCG心率测试数据31为根据BCG波形中JJTD数据推算的心率。PPG心率测试数据32为根据PPG波形中AATD数据推算的心率。线性拟合心率及非线性拟合心率测试数据33为根据BCG心率与PPG心率进行的数据拟合比较结果。线性拟合心率采用的方式为平均值。从图6中可以看到，非线性拟合心率的误差相较于原始的BCG心率测试数据、PPG心率测试数据以及线性拟合心率，与实际心率差值最小，有更好的稳定性和精确度。图7示出了受测者的血压实验结果。根据本实施方式，PPG信号从受测者的手指获取， BCG信号通过压阻传感器从受测者的足底获取，且使用商业数字示波法血压仪得到血压作为参考值。41为非线性拟合的实验结果，公式为BP_MEAN＝473.4*e-0.01502*JATD+50.63，与实际平均血压信号的和方差为12.23。42为普通线性拟合结果，公式为BP_MEAN＝-0.6174*JATD+194.4，与实际平均血压信号的和方差为51.37。从中可见，非线性拟合方法具有更好的血压监测功能。不难发现，本发明同时采集BCG信号与PPG信号，并将两者单一分析得到的生理参数信息进行非线性拟合得到最终的生理参数信息，避免了单一信号受干扰后得到的生理参数信息可靠度不高的问题。
