标题title
基于AI的踝骨骨折检测与三维重建方法
摘要abst
本发明公开了一种基于AI的踝骨骨折检测与三维重建方法，包括构建踝骨骨折数据集和踝骨骨骼数据集、对踝骨骨折数据集中的踝骨骨折CT图片进行预处理、利用预处理踝骨骨折数据集对改进YOLOV4模型进行训练、利用踝骨骨骼数据集对改进Unet网络进行训练及将待检测的踝骨CT图片输入到训练好的改进YOLOV4模型，改进YOLOV4模型对待检测的踝骨CT图片进行骨折检测；改进Unet网络对对应踝骨CT图片并进行非骨折区域抑制、语义分割；三维重建算法对分割后的踝骨CT图片进行三维重建；利用3D打印打印重建模型。本发明能够对输入的踝骨CT图片进行骨折检测，并在检测出骨折的情况下对输入的踝骨CT图片进行语义分割、三维重建和3D打印，以帮助医生更好地做出诊断。
权利要求书clms
1.一种基于AI的踝骨骨折检测与三维重建方法，其特征在于，包括：构建踝骨骨折数据集和踝骨骨骼数据集；其中，所述踝骨骨折数据集包括标注有骨折位置的多个踝骨骨折CT图片，所述踝骨骨骼数据集包括标注有骨骼区域的多个踝骨CT图片；对所述踝骨骨折数据集中的踝骨骨折CT图片进行预处理，以删除人体组织信息，保留骨骼信息，得到预处理踝骨骨折数据集；利用所述预处理踝骨骨折数据集对改进YOLOV4模型进行训练，利用所述踝骨骨骼数据集对改进Unet网络进行训练，保存训练最好的网络模型；将待检测的踝骨CT图片输入到训练好的改进YOLOV4模型，改进YOLOV4模型呈现骨折检测结果，并在判断待检测的踝骨CT图片存在骨折的情况下，将骨折图像索引和骨折位置传送至训练好的改进Unet网络；训练好的改进Unet网络改进Unet网络通过所述骨折图像索引找到对应踝骨CT图片并通过骨折位置抑制对应踝骨CT图片的非骨折区域，然后对其进行语义分割并将分割后的图片索引传送给三维重建算法；所述三维重建算法通过所述分割后的图片索引找到对应分割后的图片并对分割后的图片进行三维重建，得到重建模型，并导出STL格式文件；利用3D打印打印所述重建模型。2.根据权利要求1所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述对所述踝骨骨折数据集中的踝骨骨折CT图片进行预处理，包括：采用自适应阈值算法对所述踝骨骨折数据集中的踝骨骨折CT图片进行阈值分割。3.根据权利要求1所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述改进YOLOV4模型包括特征提取网络、特征增强网络和网络输出层；其中，所述特征提取网络采用DenseNet网络；所述特征增强网络中加入有CBAM注意力机制与ConvLstm时空卷积；所述网络输出层针对踝骨骨折特点三尺度使用的网格划分分别为：20x20,40x40,60x60。4.根据权利要求3所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述利用所述预处理踝骨骨折数据集对所述改进YOLOV4模型进行训练，包括：先对改进YOLOV4模型的backbone进行冻结仅训练预测网络；然后对改进YOLOV4模型的backbone进行解冻训练整个网络，选择Adam算法对改进YOLOV4进行优化，并选择step学习率下降方式对每个epoch的学习率进行调整；其中，初始学习率为0.001。5.根据权利要求1所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述改进Unet网络包括特征提取模块、注意力机制模块及加强特征提取模块；其中，所述特征提取模块中的网络采用MobileNet_V3网络；所述注意力机制采用ECA模块；所述加强特征提取模块各层尺寸与特征提取模块相同，以实现直接堆叠。6.根据权利要求5所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述利用所述踝骨骨骼数据集对所述改进Unet网络进行训练，包括：先对改进Unet网络的backbone进行冻结仅训练预测网络；然后对改进Unet网络的backbone进行解冻训练整个网络，选择SGD算法对改进UNet进行优化，并选择cos学习率下降方式对每个epoch的学习率进行调整；其中初始学习率为0.01,动量参数设置为0.9。7.根据权利要求1所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述通过骨折位置抑制对应踝骨CT图片的非骨折区域，包括利用踝骨CT图片的大致对称性将图片分为左右部分，通过骨折位置确定骨折位于哪一部分，将另一部分灰度设置为零。8.根据权利要求1所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述三维重建算法使用MachingCube改进算法。9.根据权利要求1所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，在所述导出STL格式文件前，还包括：对所述重建模型进行网格平滑。10.根据权利要求1所述的基于AI的踝骨骨折检测与三维重建方法，其特征在于，所述3D打印采用原比例打印。
说明书desc
技术领域本发明涉及机器视觉领域，具体涉及一种基于AI的踝骨骨折检测与三维重建方法。背景技术现在随着社会的发展，人的寿命越来越长，人口老龄化越来越严重，骨科疾病发病率与年龄相关性极高，随着年龄的增长，人体发生骨折的概率大幅提升，骨科患者日益增多，对骨科的改善型检测需求持续提升，推动骨科行业的持续提升。踝骨骨折多是由于直接或间接外力造成，对于影像科医生来说每天都要看大量的影像资料，不可避免的会出现视觉疲劳，漏诊误诊等情况。因为医患之间存在认知水平上的差距，所以双方无法进行有效的沟通，即使医生做出详细解释患者也未必真能听懂，若患者在不了解病情又情绪激动的情况下很容易产生医疗纠纷。因此实现骨折病情标注可以减轻影像科医生工作量，实现骨折三维可视化将加强医患沟通效果。现在骨折手术流程多为先切开组织再制作导板，这样不仅手术创口大而且创口暴露时间长。发明内容本发明所要解决的技术问题是克服现有技术的缺陷，提供一种基于AI的踝骨骨折检测与三维重建方法，它能够对输入的踝骨CT图片进行骨折检测，并在检测出骨折的情况下对输入的踝骨CT图片进行语义分割、三维重建和3D打印，以帮助医生更好地做出诊断。为了解决上述技术问题，本发明的技术方案是：一种基于AI的踝骨骨折检测与三维重建方法，包括：构建踝骨骨折数据集和踝骨骨骼数据集；其中，所述踝骨骨折数据集包括标注有骨折位置的多个踝骨骨折CT图片，所述踝骨骨骼数据集包括标注有骨骼区域的多个踝骨CT图片；对所述踝骨骨折数据集中的踝骨骨折CT图片进行预处理，以删除人体组织信息，保留骨骼信息，得到预处理踝骨骨折数据集；利用所述预处理踝骨骨折数据集对改进YOLOV4模型进行训练，利用所述踝骨骨骼数据集对改进Unet网络进行训练，保存训练最好的网络模型；将待检测的踝骨CT图片输入到训练好的改进YOLOV4模型，改进YOLOV4模型呈现骨折检测结果，并在判断待检测的踝骨CT图片存在骨折的情况下，将骨折图像索引和骨折位置传送至训练好的改进Unet网络；训练好的改进Unet网络改进Unet网络通过所述骨折图像索引找到对应踝骨CT图片并通过骨折位置抑制对应踝骨CT图片的非骨折区域，然后对其进行语义分割并将分割后的图片索引传送给三维重建算法；所述三维重建算法通过所述分割后的图片索引找到对应分割后的图片并对分割后的图片进行三维重建，得到重建模型，并导出STL格式文件；利用3D打印打印所述重建模型。进一步，所述对所述踝骨骨折数据集中的踝骨骨折CT图片进行预处理，包括：采用自适应阈值算法对所述踝骨骨折数据集中的踝骨骨折CT图片进行阈值分割。进一步，所述改进YOLOV4模型包括特征提取网络、特征增强网络和网络输出层；其中，所述特征提取网络采用DenseNet网络；所述特征增强网络中加入有CBAM注意力机制与ConvLstm时空卷积；所述网络输出层针对踝骨骨折特点三尺度使用的网格划分分别为：20x20,40x40,60x60。进一步，所述利用所述预处理踝骨骨折数据集对所述改进YOLOV4模型进行训练，包括：先对改进YOLOV4模型的backbone进行冻结仅训练预测网络；然后对改进YOLOV4模型的backbone进行解冻训练整个网络，选择Adam算法对改进YOLOV4进行优化，并选择step学习率下降方式对每个epoch的学习率进行调整；其中，初始学习率为0.001。进一步，所述改进Unet网络包括特征提取模块、注意力机制模块及加强特征提取模块；其中，所述特征提取模块中的网络采用MobileNet_V3网络；所述注意力机制采用ECA模块；所述加强特征提取模块各层尺寸与所述特征提取模块相同，以实现直接堆叠。进一步，所述利用所述踝骨骨骼数据集对所述改进Unet网络进行训练，包括：先对改进Unet网络的backbone进行冻结仅训练预测网络；然后对改进Unet网络的backbone进行解冻训练整个网络，选择SGD算法对改进UNet进行优化，并选择cos学习率下降方式对每个epoch的学习率进行调整；其中初始学习率为0.01,动量参数设置为0.9。进一步，所述通过骨折位置抑制对应踝骨CT图片的非骨折区域，包括利用踝骨CT图片的大致对称性将图片分为左右部分，通过骨折位置确定骨折位于哪一部分，将另一部分灰度设置为零。进一步，所述三维重建算法使用MachingCube改进算法。进一步，在所述导出STL前，还包括：对所述重建模型进行网格平滑。进一步，所述3D打印采用原比例打印。采用了上述技术方案后，本发明使用大量的临床数据进行训练，从而保证模型的鲁棒性，能够快速准确的对骨折图片进行检测，并对骨折图片进行语义分割、三维重建、3D打印，减少医患沟通障碍，提高手术实施效率，减少医疗纠纷，并能预制导板将减少手术创口与手术时间。附图说明图1为本发明的基于AI的踝骨骨折检测与三维重建方法一实施例的流程图；图2为本发明基于AI的踝骨骨折检测与三维重建方法一实施例操作窗口示意图。图3为本发明的基于AI的踝骨骨折检测与三维重建方法一实施例骨折检测结果示意图；图4为本发明的基于AI的踝骨骨折检测与三维重建方法一实施例骨骼分割结果示意图；图5为本发明基于AI的踝骨骨折检测与三维重建方法一实施例三维重建结果示意图。具体实施方式为了使本发明的内容更容易被清楚地理解，下面根据具体实施例并结合附图，对本发明作进一步详细的说明。如图1所示，一种基于AI的踝骨骨折检测与三维重建方法，包括：步骤S1：构建踝骨骨折数据集和踝骨骨骼数据集；其中，所述踝骨骨折数据集包括标注有骨折位置的多个踝骨骨折CT图片，所述踝骨骨骼数据集包括标注有骨骼区域的多个踝骨CT图片；步骤S2：对所述踝骨骨折数据集中的踝骨骨折CT图片进行预处理，以删除人体组织信息，保留骨骼信息，得到预处理踝骨骨折数据集；在一实施例中，所述对所述踝骨骨折数据集中的踝骨骨折CT图片进行预处理，包括：采用自适应阈值算法对所述踝骨骨折数据集中的踝骨骨折CT图片进行阈值分割；相关算法已经嵌入到YOLOV4算法内；步骤S3：利用所述预处理踝骨骨折数据集对改进YOLOV4模型进行训练，利用所述踝骨骨骼数据集对改进Unet网络进行训练，保存训练最好的网络模型；在一实施例中，为了充分利用现有数据集，在训练过程中使用K折交叉验证，每次交叉验证过程中又使用mosaic数据增强。在一实施例中，所述改进YOLOV4模型包括特征提取网络、特征增强网络和网络输出层，所述特征提取网络使用DenseNet网络代替原有原有特征提取网络；所述DenseNet网络可以实现特征重用，并且可能够减少模型参数量提高模型检测效率；所述特征增强网络在原有的结构基础之上加入CBAM注意力机制与ConvLstm时空卷积；所述CBAM注意力机制将空间注意力机制与通道注意力机制进行一个结合可以取得较好的效果；所述ConvLstm时空卷积为图像时空卷积，其不仅具有图像卷积能力还具有时序建模能力，可以更好的提取之前图片的有用特征；所述网络输出层针对踝骨骨折特点三尺度使用更细的网格划分，分别为：20x20,40x40,60x60；在一实施例中，所述改进Unet网络包括特征提取模块、注意力机制模块和加强特征提取模块，所述特征提取模块中使用MobileNet_V3网络代替原有网络，所述MobileNet_V3可以减少模型参数量提高模型检测速度；所述注意力机制模块采用ECA模块放在所述特征提取模块与所述加强特征提取模块之间，所述ECA模块即通道注意力模块，参数少效果好。所述加强特征提取模块各层尺寸与特征提取模块相同，可以实现直接堆叠。步骤S4：将待检测的踝骨CT图片输入到训练好的改进YOLOV4模型，改进YOLOV4模型开始检测，判断待检测的踝骨CT图片是否有骨折，如果没有则结束操作，如果检测出骨折则将骨折图像索引与骨折位置传送给改进UNet网络，改进Unet网络通过所述骨折图像索引找到对应踝骨CT图片并通过骨折位置抑制对应踝骨CT图片的非骨折区域，然后对其进行语义分割并将分割后的图片索引传送给三维重建算法；在一实施例中，采用自适应阈值算法对对踝骨骨折数据集进行阈值分割，相关算法已经嵌入到YOLOV4算法内，所以待检测的踝骨CT图片输入到改进YOLOV4后，会先对待检测的踝骨CT图片进行预处理，检测后将检测框绘制在踝骨CT图片上。在一实施例中，所述三维重建算法为：使用MachingCube改进算法，所述MachingCube改进算法可以直接使用改进UNet对分割后的图片进行三维重建，重建结果只包含骨骼信息不包含与骨骼阈值相差不大的其他内容，此外算法只对踝骨CT图片的骨折部分进行重建，减少运算量，提高重建速度；步骤S5：三维重建算法通过所述分割后的图片索引找到对应分割后的图片并对分割后的图片进行三维重建，得到重建模型；步骤S6：网格平滑所述重建模型，导出STL格式文件；具体地，所述网格平滑可以减少所述重建模型面片数从而减少stl模型大小；步骤S7：采用3D打印1:1打印所述重建模型，然后可以在模型上预制骨折导板，手术时候直接使用导板减少手术时间。本发明使用大量的临床数据进行训练，从而保证模型的鲁棒性，能够快速准确的对骨折图片进行检测，并对骨折图片进行语义分割、三维重建、3D打印，减少医患沟通障碍，提高手术实施效率，减少医疗纠纷，并能预制导板将减少手术创口与手术时间。本发明还提供一种针对上述实施例的操作窗口的操作方法，所述操作窗口示意图如图2所示，步骤中包括：通过导入文件按钮导入待检测的踝骨CT图片；通过开始检测按钮实现对待检测的踝骨CT图片骨折检测并将包括骨折图像索引与骨折位置的检测结果传送到改进UNet网络；检测结果如图3所示；通过开始分割按钮实现对抑制图片的分割并将分割图像索引传送给三维重建算法；分割结果如图4所示；通过开始重建按钮实现对分割图片的三维重建；重建效果如图5所示；通过导出STL按钮实现模型平滑后导出STL格式文件。本发明通过操作界面将各个算法组合起来，用户可以使用界面按钮轻松实现算法功能。以上所述的具体实施例，对本发明解决的技术问题、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上所述仅为本发明的具体实施例而已，并不用于限制本发明，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
