标题title
自动追踪方法以及装置、电子设备、存储介质
摘要abst
本申请公开了一种自动追踪方法以及装置、电子设备、存储介质，该方法包括根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示；如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。本申请实时保持指示对当前病患的进针点以及进针角，可用于相关设备的辅助定位中。
权利要求书clms
1.一种自动追踪方法，其特征在于，包括：根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示；如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。2.根据权利要求1所述的方法，其特征在于，所述激光辅助系统还包括：第一激光定位灯、第二激光定位灯，通过所述第一激光定位灯、所述第二激光定位灯投射的两个正交激光面交线指示并模拟出通过所述病灶靶点位置以及进针点位置确定的进针线路。3.根据权利要求2所述的方法，其特征在于，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，包括：如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过调整所述第一激光定位灯以及第二激光定位灯的位姿信息，追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。4.根据权利要求2所述的方法，其特征在于，所述根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示之后，还包括：如果判断所述当前病患初始摆位满足预设进针操作的条件，通过保持所述第一激光定位灯以及第二激光定位灯的位姿信息，以使所述激光辅助系统投射的激光指示交线保持指示并模拟出所述进针点以及所述进针角度。5.根据权利要求1所述的方法，其特征在于，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度，包括：在目标设备重新摆位调整后，确定所述病灶靶点M和所述进针点N变化后的在目标设备坐标系CDET的坐标位置信息；根据所述坐标位置信息，计算出所述M、所述N两点在目标设备坐标系CDET中的坐标MDET和NDET；根据所述M、所述N两点在坐标系CDET中的坐标MDET和NDET，计算出所述辅助激光系统中的激光定位灯移动的位置以及角度；在目标设备重新摆位调整后，所述激光定位灯灭并要重新计算新的M′DET和N′DET坐标信息；根据所述M、所述N两点在坐标系CDET中的坐标M′DET和N′DET；再次计算所述激光辅助系统中激光定位灯的位置和摆动角度，以使所述激光辅助系统投射的激光运动到当前进针线路以及进针角度。6.根据权利要求1所述的方法，其特征在于，所述根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示，包括：所述激光辅助系统工作时，所述激光辅助系统在目标位置生成的激光扇面交线即得到模拟所述进针点以及所述病灶靶点的两个点确定的进针路线，所述进针点和所述进针角度用于确定进针线路。7.根据权利要求1所述的方法，其特征在于，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，包括：如果判断所述当前病患初始摆位不满足预设进针操作的条件，则在目标设备重新摆位调整后，通过激光辅助系统重新在目标位置生成激光扇面交线即得到模拟所述进针点以及所述病灶靶点的两个点确定的进针路线，以追踪当前病患新的摆位。8.一种自动追踪装置，其特征在于，包括：确定模块，用于根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点、进针角度进行指示；追踪模块，用于如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。9.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现权利要求1至7任一项所述的自动追踪的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时实现权利要求1至7任一项所述的自动追踪的步骤。
说明书desc
技术领域本申请涉及医疗、计算机软件领域，具体而言，涉及一种自动追踪方法以及装置、电子设备、存储介质。背景技术介入治疗是近年迅速发展起来的一门融合了影像诊断和临床治疗于一体的新兴学科。介入治疗的技术特点是利用CT、MRI的图像进行手术前的规划，并利用磁导航、激光定位系统等辅助装置进行进针引导，手术中利用数字减影血管造影机，CT，MRI，B超等影像设备的引导下，通过穿刺针、导管及其他介入器材，通过人体自然孔道或微小的创口将特定的器械导入人体病变部位进行微创治疗。相关技术中，当获得初始进针点之后，判断当前病人摆位是否易于进针操作，如果易于进针操作才会进行介入操作。然而，对于上述场景，很难进行目标点/区域的自动追踪，从而当病人摆位发生变化时，再次确定进针点会较为困难。针对相关技术中介入治疗的设备中无法实现自动追踪的问题，目前尚未提出有效的解决方案。发明内容本申请的主要目的在于提供一种自动追踪方法以及装置、电子设备、存储介质，以解决介入治疗的设备中无法实现自动追踪的问题。为了实现上述目的，根据本申请的一个方面，提供了自动追踪方法。根据本申请的自动追踪方法包括：根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示；如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。进一步地，所述激光辅助系统还包括：第一激光定位灯、第二激光定位灯，通过所述第一激光定位灯、所述第二激光定位灯投射的两个正交激光面交线指示并模拟出通过所述病灶靶点位置以及进针点位置确定的进针线路。进一步地，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，包括：如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过调整所述第一激光定位灯以及第二激光定位灯的位姿信息，追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。进一步地，所述根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示之后，还包括：如果判断所述当前病患初始摆位满足预设进针操作的条件，通过保持所述第一激光定位灯以及第二激光定位灯的位姿信息，以使所述激光辅助系统投射的激光指示交线保持指示并模拟出所述进针点以及所述进针角度。进一步地，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度，包括：在目标设备重新摆位调整后，确定所述病灶靶点M和所述进针点N变化后的在目标设备坐标系CDET的坐标位置信息；根据所述坐标位置信息，计算出所述M、所述N两点在目标设备坐标系CDET中的坐标MDET和NDET；根据所述M、所述N两点在坐标系CDET中的坐标MDET和NDET，计算出所述辅助激光系统中的激光定位灯移动的位置以及角度；在目标设备重新摆位调整后，所述激光定位灯灭并要重新计算新的M′DET和N′DET坐标信息；根据所述M、所述N两点在坐标系CDET中的坐标M′DET和N′DET；再次计算所述激光辅助系统中激光定位灯的位置和摆动角度，以使所述激光辅助系统投射的激光运动到当前进针线路以及进针角度。进一步地，所述根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示，包括：所述激光辅助系统工作时，所述激光辅助系统在目标位置生成的激光扇面交线即得到模拟所述进针点以及所述病灶靶点的两个点确定的进针路线，所述进针点和所述进针角度用于确定进针线路。进一步地，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，包括：如果判断所述当前病患初始摆位不满足预设进针操作的条件，则在目标设备重新摆位调整后，通过激光辅助系统重新在目标位置生成激光扇面交线即得到模拟所述进针点以及所述病灶靶点的两个点确定的进针路线，以追踪当前病患新的摆位。为了实现上述目的，根据本申请的另一方面，提供了一种自动追踪装置。根据本申请的自动追踪装置包括：确定模块，用于根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点、进针角度进行指示；追踪模块，用于如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。为了实现上述目的，根据本申请的又一方面，提供了一种计算机可读存储介质，所述计算机可读存储介质中存储有计算机程序，其中，所述计算机程序被设置为运行时执行所述方法。为了实现上述目的，根据本申请的再一方面，提供了一种电子装置，包括存储器和处理器，所述存储器中存储有计算机程序，所述处理器被设置为运行所述计算机程序以执行所述的方法。在本申请实施例中自动追踪方法以及装置、电子设备、存储介质，采用根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示，达到了如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度的目的，从而实现了实时保持指示对当前病患的进针点以及进针角度的技术效果，进而解决了介入治疗的设备中无法实现自动追踪的技术问题。附图说明构成本申请的一部分的附图用来提供对本申请的进一步理解，使得本申请的其它特征、目的和优点变得更明显。本申请的示意性实施例附图及其说明用于解释本申请，并不构成对本申请的不当限定。在附图中：图1是根据本申请实施例的自动追踪方法所实施的硬件系统结构示意图；图2是根据本申请实施例的自动追踪方法流程示意图；图3是根据本申请实施例的自动追踪方法中CT、DSA坐标系示意图；图4是根据本申请实施例的自动追踪方法中探测器坐标系CDET示意图；图5是根据本申请实施例的自动追踪方法中激光灯坐标系示意图；图6是根据本申请实施例的自动追踪方法中激光灯位移及角度计算示意图；图6是根据本申请实施例的自动追踪方法中激光灯位移及角度计算示意图；图6是根据本申请实施例的自动追踪方法中激光灯位移及角度计算示意图；图7是根据本申请实施例的自动追踪方法的激光辅助定位实现原理示意图；图8是根据本申请优选实施例的自动追踪用于CT引导的DSA激辅助光定位方法的流程示意图；图9是根据本申请实施例的自动追踪装置结构示意图。具体实施方式为了使本技术领域的人员更好地理解本申请方案，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分的实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本申请保护的范围。需要说明的是，本申请的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本申请的实施例。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。在本申请中，术语“上”、“下”、“左”、“右”、“前”、“后”、“顶”、“底”、“内”、“外”、“中”、“竖直”、“水平”、“横向”、“纵向”等指示的方位或位置关系为基于附图所示的方位或位置关系。这些术语主要是为了更好地描述本申请及其实施例，并非用于限定所指示的装置、元件或组成部分必须具有特定方位，或以特定方位进行构造和操作。并且，上述部分术语除了可以用于表示方位或位置关系以外，还可能用于表示其他含义，例如术语“上”在某些情况下也可能用于表示某种依附关系或连接关系。对于本领域普通技术人员而言，可以根据具体情况理解这些术语在本申请中的具体含义。此外，术语“安装”、“设置”、“设有”、“连接”、“相连”、“套接”应做广义理解。例如，可以是固定连接，可拆卸连接，或整体式构造；可以是机械连接，或电连接；可以是直接相连，或者是通过中间媒介间接相连，又或者是两个装置、元件或组成部分之间内部的连通。对于本领域普通技术人员而言，可以根据具体情况理解上述术语在本申请中的具体含义。介入治疗的技术特点是利用CT、MRI的图像进行手术前的规划，并利用磁导航、激光定位系统等辅助装置进行进针引导，手术中利用数字减影血管造影机，CT，MRI，B超等影像设备的引导下，通过穿刺针、导管及其他介入器材，通过人体自然孔道或微小的创口将特定的器械导入人体病变部位进行微创治疗。发明人研究时发现，传统CT引导下经皮穿刺介入手术中，医生依据CT扫描图像中确定病灶的位置、进针路径，利用体表放置定位格栅再次CT扫描,确定皮肤进针点位置；医生再根据经验手动进针，术中需多次CT扫描验证，多次调整穿刺针角度；此时复杂角度时手术操作难度大，患者辐射量较大；市场上已出现了一些辅助激光定位装置，原理都是利用定位格栅进行扫描后，根据医生规划好穿刺路径和皮肤进针点后，手动调节定位激光线的位置和角度，操作使用复杂，精度低，需要在不同的设备间来回切换。在本申请中提供了一种自动追踪方法，实时保持指示对当前病患的进针点以及进针角度，从而方便并高精度的指引医生完成介入操作。需要说明的是，在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。下面将参考附图并结合实施例来详细说明本申请。如图1所示，硬件系统结构包括：CT100，DSA200以及激光定位灯201。CT100用于标记病灶靶点和皮肤进针点位置。所述激光定位灯201用于生成正交激光面交线，并通过激光线路以模拟穿刺进针路径。可以采用两个所述激光定位灯201安装在所述DSA200的探测器外壳上的正交激光辅助定位装置，根据所述CT100标记的病灶靶点和皮肤进针点位置，所述DSA200进行设备摆位及激光辅助定位装置摆位，两个正交激光面交线模拟病灶点和皮肤进针点形成的进针线路，引导术者方便、快捷、准确地完成经皮穿刺手术。如图2所示，该方法包括如下的步骤S201至步骤S202：步骤S201，根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示；步骤S202，如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。从以上的描述中，可以看出，本申请实现了如下技术效果：根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示，达到了如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度的目的，从而实现了实时保持指示对当前病患的进针点以及进针角度的技术效果，进而解决了介入治疗的设备中无法实现自动追踪的技术问题。上述步骤S201中根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示。所述激光辅助系统生成激光线束，并对当前病患的进针点以及进针角度进行指示。这是初始状态下或者第一状态下，所述激光辅助系统生成激光线束可以指示进针点以及进针角度。上述步骤S202中如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。当病患的位置发生变化或者初始位置不满足进针条件，即如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。可以理解，所述目标设备为DSA。此外，基于所述的方法，还提供了基于CT引导下的DSA经皮穿刺介入手术提供一种更加方便、快捷、准确的进针引导系统，提高临床手术准确率和效率。首先获得通过所述CT扫描标注出的病灶靶点以及进针点。病灶靶点以及进针点用于作为初始的位置点。作为一种可选的实施方式，所述病灶靶点可以经过所述CT扫描并标记得到。作为一种优选的实施方式，所述进针点可以经过所述CT扫描并标记得到。作为一种可选的实施方式，所述CT与所述DSA共同使用所述导管床且将CT主机架与所述DSA主机架的坐标保持一致。可以理解，DSA血管造影的影像通过数字化处理设备，可以将不需要的组织影像删除掉，只保留血管影像，这种技术叫做数字减影技术，其特点是图像清晰，分辨率高，对观察血管病变，血管狭窄的定位测量，诊断及介入治疗提供了真实的立体图像，为各种介入治疗提供了必备条件。作为一种可选的实施方式，所述运动部件至少包括如下之一：DSA主机架、导管床、探测器、激光定位灯。对于所述DSA的运动部件，可以包括如上的多种或者一种，即可能多种运动部件都需要改变或者只是其中的部件改变。作为一种优选的实施方式，所述激光定位灯至少包括两个。所述两个激光定位灯分别位于所述探测器的两侧，即非同侧。如果判断所述病患初始摆位不满足预设进针操作的条件，则根据对所述DSA的调整结果调整所述激光定位灯的角度和位置，以使所述激光定位灯投射的激光指示交线保持指示并模拟出所述进针点和所述进针角度。即当对DSA的透照角度进行微调时，激光定位器根据DSA新的位置自动进行位置调整，保持进针点位置以及病灶靶点位置不变。作为一种可选的实施方式，所述进针点和所述进针角度用于确定进针线路。作为一种优选的实施方式，此外所述病灶靶点位置以及进针点位置也可用于确定的进针线路。作为本实施例中的优选，所述激光辅助系统还包括：第一激光定位灯、第二激光定位灯，通过所述第一激光定位灯、所述第二激光定位灯投射的两个正交激光面交线指示并模拟出通过所述病灶靶点位置以及进针点位置确定的进针线路。具体实施时，所述激光辅助系统包括第一激光定位灯、第二激光定位灯，并且，通过所述第一激光定位灯、所述第二激光定位灯投射的两个正交激光面交线指示并模拟出通过所述病灶靶点位置以及进针点位置确定的进针线路。作为本实施例中的优选，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，包括：如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过调整所述第一激光定位灯以及第二激光定位灯的位姿信息，追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。具体实施时，需要调整所述第一激光定位灯以及第二激光定位灯的位姿信息，实现，追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。作为本实施例中的优选，所述根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示之后，还包括：如果判断所述当前病患初始摆位满足预设进针操作的条件，通过保持所述第一激光定位灯以及第二激光定位灯的位姿信息，以使所述激光辅助系统投射的激光指示交线保持指示并模拟出所述进针点以及所述进针角度。具体实施时，如果是满足预设进针操作的条件的，则通过保持所述第一激光定位灯以及第二激光定位灯的位姿信息，使得激光指示交线保持指示并模拟出所述进针点以及所述进针角度。作为本实施例中的优选，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度，包括：在目标设备重新摆位调整后，确定所述病灶靶点M和所述进针点N变化后的在目标设备坐标系CDET的坐标位置信息；根据所述坐标位置信息，计算出所述M、所述N两点在目标设备坐标系CDET中的坐标MDET和NDET；根据所述M、所述N两点在坐标系CDET中的坐标MDET和NDET，计算出所述辅助激光系统中的激光定位灯移动的位置以及角度；在目标设备重新摆位调整后，所述激光定位灯灭并要重新计算新的M′DET和N′DET坐标信息；根据所述M、所述N两点在坐标系CDET中的坐标M′DET和N′DET；再次计算所述激光辅助系统中激光定位灯的位置和摆动角度，以使所述激光辅助系统投射的激光运动到当前进针线路以及进针角度。激光辅助定位系统自动追踪，激光线保持指示当前进针点、进针角度，当微调导管床摆位，激光灯灭并提醒用户此时导航需要重新计算，新的M′DET和N′DET坐标如下：如上所述，再次计算第一激光定位灯和第二激光定位灯的位置和摆动角度，激光灯将运动到新的位置。此时用户再次打开激光灯，将得到新的进针路线指示。作为本实施例中的优选，所述根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示，包括：所述激光辅助系统工作时，所述激光辅助系统在目标位置生成的激光扇面交线即得到模拟所述进针点以及所述病灶靶点的两个点确定的进针路线，所述进针点和所述进针角度用于确定进针线路。作为本实施例中的优选，所述如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，包括：如果判断所述当前病患初始摆位不满足预设进针操作的条件，则在目标设备重新摆位调整后，通过激光辅助系统重新在目标位置生成激光扇面交线即得到模拟所述进针点以及所述病灶靶点的两个点确定的进针路线，以追踪当前病患新的摆位。作为本实施例中的优选，如图3所示，所述CT与所述DSA共同使用所述导管床且将CT主机架与所述DSA主机架的坐标保持一致，包括：将所述CT的坐标系C0设置为主坐标系且原点位于所述CT的扫描中心；将所述DSA的坐标系CDSA设置为原点位于所述C0坐标系中,其中，所述Toffset为主坐标系原点C0与DSA坐标系原点在Z轴向的距离，所述CDSA坐标系绕CDSA坐标系的Z轴旋转时旋转角度为θDSA，顺时针角度为正，逆时针角度为负；建立所述CDSA坐标系中任意点的坐标到所述C0坐标系中任意点的坐标系变换关系。具体实施时，CT坐标系C0：原点位于CT扫描中心，该坐标系静止不动。DSA坐标系CDSA：原点位于C0坐标系,其中Toffset为主坐标系原点CDSA与DSA坐标系原点C0在Z向距离。DSA坐标系绕DSA坐标系Z轴旋转，旋转角度为θDSA，顺时针角度为正，逆时针角度为负。坐标系变换关系：其中，xDSA、yDSA、zDSA是DSA坐标系任意点的3个坐标，xC、yC、zC是CT坐标系任意点的3个坐标。作为本实施例中的优选，如图9所示，所述获得通过所述CT扫描标注出的病灶靶点以及进针点，包括：至少两个所述激光定位灯分别安装在与所述探测器正交的两个平面上，且每个所述激光定位灯均具有两个运动自由度，其中，第一激光定位灯沿Z轴直线运动且绕X轴摆动；第二激光定位灯沿X轴直线运动且绕Z轴摆动；当所述第一激光定位灯和所述第二激光定位灯发射的扇形光束随所述DSA主机架运动以及所述探测器运动的过程中，所述第一激光定位灯和所述第二激光定位灯运动相交于一空间直线得到相交线L，且L在床板或物体表面形成十字相交点；获得通过所述CT扫描标注出的病灶靶点A并选择出进针点B，其中所述病灶靶点A与所述进针点B确定出一条直线L1；当调整所述DSA摆位以及所述两个所述激光定位灯的摆位的过程中，使得相交线L与直线L1重合后，确定出所述进针点、进针方向。具体实施时，第一激光定位灯和第二激光定位灯安装在平板探测器正交两个平面。每个激光灯有两个运动自由度：第一激光定位灯，沿Z轴直线运动，绕X轴摆动；第二激光定位灯，沿X轴直线运动；绕Z轴摆动；所述第一激光定位灯以及所述第二激光定位灯发射扇形光束，扇形光束随DSA主机架运动、探测器运动、导管床运动、激光定位灯运动相交于空间直线L，L在导管床的床板或人体表面形成十字相交点。在介入手术过程中，操作者通过CT扫描得到病灶靶点M，医生选择最佳进针点N，M、N两点确定一条直线L1。系统调整设备摆位及A/B激光灯摆位，使得相交线L与L1重合，进而确定人体表面进针点，同时L空间角度即为进针方向。作为本实施例中的优选，如图4以及图5所示，所述根据所述病灶靶点以及所述进针点在世界坐标系中的空间位置，计算所述DSA中运动部件的空间位置，并计算出所述进针点和进针角度，其中所述运动部件至少包括如下之一：DSA主机架、导管床、探测器、激光定位灯，所述激光定位灯至少包括两个，之前还包括：设置所述探测器、激光定位灯的坐标系，所述探测器的坐标系CDET原点位于所述探测器的表面中心，在所述DSA的坐标系CDSA中的坐标为，其中，所述Y为变量与所述探测器在Y方向上探测器垂直距离SID位置相关；所述激光定位灯包括第一激光定位灯坐标系CLa和第二激光定位灯坐标系CLb；其中，所述第一激光定位灯坐标系CLa的初始位为：原点在坐标系CDET下的坐标为，该坐标系沿X轴移动，同时绕Z轴旋转，顺时针角度为正，逆时针角度为负，所述第一激光定位灯位于所述探测器的正侧面靠近床侧，原心位于激光面上；第二激光定位灯坐标系CLb的初始位为：原点在坐标系CDET下的坐标为，该坐标系沿Z轴移动，同时绕X轴旋转，顺时针角度为正，逆时针角度为负，所述第二激光定位灯位于所述探测器的一侧面，原心位于激光面上。具体实施时，探测器坐标系CDET：原点位于平板探测器的表面中心，在坐标系中CDSA的坐标为；其中Y为变量与探测器在Y方向位置相关。SID是指探测器垂直距离。第一激光定位灯坐标系CLa：第一激光定位灯位于平板探测器的正侧面靠近床侧。原心位于激光面上。CLa初始位置定义如下：原点在坐标系CDET下的坐标为。该坐标系沿X轴移动，同时绕Z轴旋转，顺时针角度为正，逆时针角度为负。第二激光定位灯的坐标系CLb：第一激光定位灯位于平板探测器的左侧面。原心位于激光面上。CLb初始位置定义如下：原点在坐标系CDET下的坐标为。X、Y、Z轴的初始方向与CDET坐标系相同。该坐标系沿Z轴移动，同时绕X轴旋转，顺时针角度为正，逆时针角度为负。作为本实施例中的优选，如图6-6所示，所述根据所述病灶靶点以及所述进针点在世界坐标系中的空间位置，计算所述DSA中运动部件的空间位置，并计算出所述进针点和进针角度，其中所述运动部件至少包括如下之一：DSA主机架、导管床、探测器、激光定位灯，所述激光定位灯至少包括两个，还包括：所述病灶靶点M和N通过移动所述导管床、旋转所述DSA主机架、移动所述探测器之后，确定在所述探测器坐标系CDET的坐标位置信息；根据所述坐标位置信息，计算出所述M、所述N两点在坐标系CDET中的坐标MDET和NDET；根据所述M、所述N两点在坐标系CDET中的坐标MDET和NDET，计算出所述激光定位灯移动的位置以及角度。具体实施时，灶靶点M和N通过移动床、DSA旋转、探测器移动在探测器坐标系CDET的坐标如下：XDET、ZDET在坐标系CDSA中是常量，YDET是随着SID变化。通过上式可计算出M、N两点在坐标系CDET中的坐标MDET和NDET，进而可计算出激光灯移动的位置和角度。作为本实施例中的优选，如图6-6所示，所述根据所述病灶靶点以及所述进针点在世界坐标系中的空间位置，计算所述DSA中运动部件的空间位置，并计算出所述进针点和进针角度，其中所述运动部件至少包括如下之一：DSA主机架、导管床、探测器、激光定位灯，所述激光定位灯至少包括两个，包括：将所述MDET和所述NDET投影到X-Y平面，得到Mxy和Nxy，其坐标为MDET和BDET的X、Y坐标，确定出所述激光定位灯中的第一激光定位灯所转动的角度θLa和OLa的坐标信息；确定OLa的坐标中变量XLa的坐标信息；将MDET和ZDET投影到Z-Y平面，得到Mzy和Nzy，其坐标为MDET和NDET的Z、Y坐标，确定出所述激光定位灯中的第二激光定位灯所转动的角度角度θLb和OLb的坐标信息；确定OLb的坐标中变量ZLa的坐标信息；根据所述θLa，OLa，变量XLa的坐标信息，变量ZLa的坐标信息，得到所述DSA主机架、导管床、探测器、激光定位灯中一种或多种运动部件的位置信息；根据所述位置信息，在两个所述激光定位灯激光灯的激光光路上形成的激光扇面交线，得到并模拟出通过所述进针点以及所述病灶靶点确定的进针路线，其中，根据所述CT扫描得到CT图像并规划后确定出进针点N在主坐标系C0的坐标以及所述病灶靶点M在主坐标系C0的坐标；所述导管床相对主坐标系C0的原点的坐标位置移动信息；所述DSA旋转的角度θDSA、所述探测器移动的距离Tdet；当开始通过所述激光定位灯进行导航时，所述激光定位灯的第一激光定位灯相对于坐标系CDET原点的位置，或者说激光灯A坐标系CLa的原点在坐标系CDET上的坐标Ola；所述激光定位灯的第一激光定位灯坐标系CLa绕自身Z轴旋转的角度θLa；激光定位导航时，所述激光定位灯的第二激光定位灯相对于坐标系CDET原点的位置，或者说激光灯B坐标系CLb的原点在坐标系CDET上的坐标OLb；激光定位导航时，所述激光定位灯的第二激光定位灯坐标系CLb绕自身X轴旋转的角度θLb。具体实施时，所述进针点N在主坐标系C0的坐标，该坐标由工作站根据CT图像规划后给出。病灶靶点M在主坐标系C0的坐标，该坐标由工作站根据CT图像规划后给出。扫描床移动，相对主坐标系C0的原点。DSA旋转的角度θDSA，此处可设定探测器在12点钟方向时为0位，逆时针为正，顺时针为负。探测器移动的距离Tdet，此处可设定SID最大时探测器牌0位。在通过激光定位灯进行激光定位导航时，第一激光定位灯相对于坐标系CDET原点的位置，或者说第一激光定位灯坐标系CLa的原点在坐标系CDET上的坐标OLa。在通过激光定位灯进行激光定位导航时，第一激光定位灯坐标系CLa绕自身Z轴旋转的角度θLa；在通过激光定位灯进行激光定位导航时，第二激光定位灯相对于坐标系CDET原点的位置，或者说激光灯B坐标系CLb的原点在坐标系CDET上的坐标OLb。在通过激光定位灯进行激光定位导航时，激光灯B坐标系CLb绕自身X轴旋转的角度θLb；此外，对于变量、、、θDSA、Tdet是由操作者通过导航规划和实际操作来确定，目标是病灶靶点位置移动到所述DSA的ISO center，故可以当作是已知变量。OLa、θLa、OLb、θLb四个变量为未知变量，可通过下面的算法进行计算得出。进一步地，具体实施时，将MDET和NDET投影到XY平面，得到Mxy和Nxy，其坐标为MDET和BDET的X、Y坐标。由下式可算出第一激光定位灯所转动的角度θLa和OLa的坐标:OLa的坐标当中只有XLa坐标是变量，因此只需用下式算出XLa坐标即可：同理，将MDET和ZDET投影到ZY平面，得到Mzy和Nzy，其坐标为MDET和NDET的Z、Y坐标。由下式可算出第二激光定位所转动的角度θLb和OLb的坐标:OLb的坐标当中只有ZLa坐标是变量，因此只需用下式算出ZLa坐标即可：通过以上计算，可以得到各个运动部件运动位置。此时打开激光灯，激光灯此时位置形成的激光扇面交线即为模拟进针点和病灶靶点两个点确定的进针路线。通过将导管针放在激光线与人体表面的交点，转动手术导管针的另一端使得激光十字线与之重合，此时导管针即在进针路线上。作为本实施例中的优选，所述如果判断所述病患初始摆位不满足预设进针操作的条件，则根据对所述DSA的调整结果调整所述激光定位灯的角度和位置，以使所述激光定位灯投射的激光指示交线保持指示并模拟出所述进针点和所述进针角度，其中，所述进针点和所述进针角度用于确定进针线路包括：当所述导管床进行重新摆位后，所述激光定位灯灭并要重新计算新的M′DET和N′DET坐标信息；根据所述M、所述N两点在坐标系CDET中的坐标M′DET和N′DET；再次计算第一激光定位灯和第一激光定位灯的位置和摆动角度，以使所述第一激光定位灯和所述第二激光定位灯运动到新的位置，且得到新的所述进针线路。具体实施时，激光辅助定位系统自动追踪，激光线保持指示当前进针点、进针角度，当微调导管床摆位，激光灯灭并提醒用户此时导航需要重新计算，新的M′DET和N′DET坐标如下：如上所述，再次计算第一激光定位灯和第二激光定位灯的位置和摆动角度，激光灯将运动到新的位置。此时用户再次打开激光灯，将得到新的进针路线指示。需要说明的是，在附图的流程图示出的步骤可以在诸如一组计算机可执行指令的计算机系统中执行，并且，虽然在流程图中示出了逻辑顺序，但是在某些情况下，可以以不同于此处的顺序执行所示出或描述的步骤。根据本申请实施例，还提供了一种，如图9所示，该装置包括：确定模块301，用于根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点、进针角度进行指示；追踪模块302，用于如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。本申请实施例的所述确定模块301中根据预先确定的病灶靶点以及进针点的空间位置，通过激光辅助系统生成激光线束，用以对当前病患的进针点以及进针角度进行指示。所述激光辅助系统生成激光线束，并对当前病患的进针点以及进针角度进行指示。这是初始状态下或者第一状态下，所述激光辅助系统生成激光线束可以指示进针点以及进针角度。本申请实施例的所述追踪模块302中如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。当病患的位置发生变化或者初始位置不满足进针条件，即如果判断所述当前病患初始摆位不满足预设进针操作的条件，在目标设备重新摆位调整后，通过激光辅助系统追踪当前病患新的摆位，以使激光线保持指示当前的进针点以及进针角度。可以理解，所述目标设备为DSA。此外，基于所述的方法，还提供了基于CT引导下的DSA经皮穿刺介入手术提供一种更加方便、快捷、准确的进针引导系统，提高临床手术准确率和效率。首先获得通过所述CT扫描标注出的病灶靶点以及进针点。病灶靶点以及进针点用于作为初始的位置点。作为一种可选的实施方式，所述病灶靶点可以经过所述CT扫描并标记得到。作为一种优选的实施方式，所述进针点可以经过所述CT扫描并标记得到。作为一种可选的实施方式，所述CT与所述DSA共同使用所述导管床且将CT主机架与所述DSA主机架的坐标保持一致。可以理解，DSA血管造影的影像通过数字化处理设备，可以将不需要的组织影像删除掉，只保留血管影像，这种技术叫做数字减影技术，其特点是图像清晰，分辨率高，对观察血管病变，血管狭窄的定位测量，诊断及介入治疗提供了真实的立体图像，为各种介入治疗提供了必备条件。作为一种可选的实施方式，所述运动部件至少包括如下之一：DSA主机架、导管床、探测器、激光定位灯。对于所述DSA的运动部件，可以包括如上的多种或者一种，即可能多种运动部件都需要改变或者只是其中的部件改变。作为一种优选的实施方式，所述激光定位灯至少包括两个。所述两个激光定位灯分别位于所述探测器的两侧，即非同侧。如果判断所述病患初始摆位不满足预设进针操作的条件，则根据对所述DSA的调整结果调整所述激光定位灯的角度和位置，以使所述激光定位灯投射的激光指示交线保持指示并模拟出所述进针点和所述进针角度。即当对DSA的透照角度进行微调时，激光定位器根据DSA新的位置自动进行位置调整，保持进针点位置以及病灶靶点位置不变。作为一种可选的实施方式，所述进针点和所述进针角度用于确定进针线路。作为一种优选的实施方式，此外所述病灶靶点位置以及进针点位置也可用于确定的进针线路。显然，本领域的技术人员应该明白，上述的本申请的各模块或各步骤可以用通用的计算装置来实现，它们可以集中在单个的计算装置上，或者分布在多个计算装置所组成的网络上，可选地，它们可以用计算装置可执行的程序代码来实现，从而，可以将它们存储在存储装置中由计算装置来执行，或者将它们分别制作成各个集成电路模块，或者将它们中的多个模块或步骤制作成单个集成电路模块来实现。这样，本申请不限制于任何特定的硬件和软件结合。为了更好的理解上述基于CT引导的DSA激光定位方法流程，以下结合优选实施例对上述技术方案进行解释说明，但不用于限定本发明实施例的技术方案。本申请实施例中的基于CT引导的DSA激光定位方法，用于在CT引导下经皮穿刺介入手术过程中，通过CT扫描，标记病灶靶点和皮肤进针点位置，激光辅助定位系统通过设备以及激光定位装置摆位，生成激光线路以模拟穿刺进针路径，能够方便并高精度的指引医生完成介入操作。如图7所示，第一激光定位灯2011和第二激光定位灯2012安装在平板探测器1001正交两个平面。每个激光灯有两个运动自由度：第一激光定位灯，沿Z轴直线运动，绕X轴摆动；第二激光定位灯，沿X轴直线运动；绕Z轴摆动。其中，还包括：导管床1002、影像中心1003、矢状面定位线1004、介入参考点1005、冠状定位线1006、球状焦点1007。所述第一激光定位灯以及所述第二激光定位灯发射扇形光束，扇形光束随DSA主机架运动、探测器运动、导管床运动、激光定位灯运动相交于空间直线L，L在导管床的床板或人体表面形成十字相交点。如图8所示，是本申请实施例中示意图，在CT引导下经皮穿刺介入手术过程中,通过CT扫描，标记病灶靶点和皮肤进针点位置，激光辅助定位系统通过设备以及激光定位装置摆位，生成激光线路以模拟穿刺进针路径，能够方便并高精度的指引医生完成介入操作，实现的具体过程包括如下步骤：步骤S1001，根据CT扫描，医生标注病灶靶点、进针点。步骤S1002，DSA初始摆位，病人摆位。所述CT与所述DSA共同使用所述导管床且将CT主机架与所述DSA主机架的坐标保持一致；步骤S1003，将病灶靶点、进针点在DSA系统进行坐标转换。所述CT与所述DSA共同使用所述导管床且将CT主机架与所述DSA主机架的坐标保持一致，包括：将所述CT的坐标系C0设置为主坐标系且原点位于所述CT的扫描中心；将所述DSA的坐标系CDSA设置为原点位于所述C0坐标系中,其中，所述Toffset为主坐标系原点C0与DSA坐标系原点在Z轴向的距离，所述CDSA坐标系绕CDSA坐标系的Z轴旋转时旋转角度为θDSA，顺时针角度为正，逆时针角度为负；建立所述CDSA坐标系中任意点的坐标到所述C0坐标系中任意点的坐标系变换关系。步骤S1004，根据病灶靶点、进针点空间位置，计算DSA各个运动部件位置，DSA主机架、导管床、探测器、激光灯运动摆位，激光线束实现进针点、进针角度指示。探测器坐标系CDET：原点位于平板探测器的表面中心，在坐标系中CDSA的坐标为；其中Y为变量与探测器在Y方向位置相关。SID是指探测器垂直距离。第一激光定位灯坐标系CLa：第一激光定位灯位于平板探测器的正侧面靠近床侧。原心位于激光面上。CLa初始位置定义如下：原点在坐标系CDET下的坐标为。该坐标系沿X轴移动，同时绕Z轴旋转，顺时针角度为正，逆时针角度为负。第二激光定位灯的坐标系CLb：第一激光定位灯位于平板探测器的左侧面。原心位于激光面上。CLb初始位置定义如下：原点在坐标系CDET下的坐标为。X、Y、Z轴的初始方向与CDET坐标系相同。该坐标系沿Z轴移动，同时绕X轴旋转，顺时针角度为正，逆时针角度为负。所述进针点N在主坐标系C0的坐标，该坐标由工作站根据CT图像规划后给出。病灶靶点M在主坐标系C0的坐标，该坐标由工作站根据CT图像规划后给出。扫描床移动，相对主坐标系C0的原点。DSA旋转的角度θDSA，此处可设定探测器在12点钟方向时为0位，逆时针为正，顺时针为负。探测器移动的距离Tdet，此处可设定SID最大时探测器牌0位。在通过激光定位灯进行激光定位导航时，第一激光定位灯相对于坐标系CDET原点的位置，或者说第一激光定位灯坐标系CLa的原点在坐标系CDET上的坐标OLa。在通过激光定位灯进行激光定位导航时，第一激光定位灯坐标系CLa绕自身Z轴旋转的角度θLa；在通过激光定位灯进行激光定位导航时，第二激光定位灯相对于坐标系CDET原点的位置，或者说激光灯B坐标系CLb的原点在坐标系CDET上的坐标OLb。在通过激光定位灯进行激光定位导航时，激光灯B坐标系CLb绕自身X轴旋转的角度θLb；灶靶点M和N通过移动床、DSA旋转、探测器移动在探测器坐标系CDET的坐标如下：XDET、ZDET在坐标系CDSA中是常量，YDET是随着SID变化。通过上式可计算出M、N两点在坐标系CDET中的坐标MDET和NDET，进而可计算出激光灯移动的位置和角度。将MDET和NDET投影到XY平面，得到Mxy和Nxy，其坐标为MDET和BDET的X、Y坐标。由下式可算出第一激光定位灯所转动的角度θLa和OLa的坐标:OLa的坐标当中只有XLa坐标是变量，因此只需用下式算出XLa坐标即可：同理，将MDET和ZDET投影到ZY平面，得到Mzy和Nzy，其坐标为MDET和NDET的Z、Y坐标。由下式可算出第二激光定位所转动的角度θLb和OLb的坐标:OLb的坐标当中只有ZLa坐标是变量，因此只需用下式算出ZLa坐标即可：通过以上计算，可以得到各个运动部件运动位置。此时打开激光灯，激光灯此时位置形成的激光扇面交线即为模拟进针点和病灶靶点两个点确定的进针路线。通过将导管针放在激光线与人体表面的交点，转动手术导管针的另一端使得激光十字线与之重合，此时导管针即在进针路线上。步骤S1005，判断当前病人摆位是否易于进针操作。步骤S1006，进行介入操作。步骤S1007，激光辅助定位系统自动追踪，激光线保持指示当前进针点、进针角度。激光辅助定位系统自动追踪，激光线保持指示当前进针点、进针角度，当微调导管床摆位，激光灯灭并提醒用户此时导航需要重新计算，新的M′DET和N′DET坐标如下：如上所述，再次计算第一激光定位灯和第二激光定位灯的位置和摆动角度，激光灯将运动到新的位置。此时用户再次打开激光灯，将得到新的进针路线指示。步骤S1008，穿刺介入。以上所述仅为本申请的优选实施例而已，并不用于限制本申请，对于本领域的技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
