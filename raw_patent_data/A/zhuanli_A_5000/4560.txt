标题title
一种具有布针引导功能的陡脉冲治疗系统
摘要abst
本发明公开了一种具有布针引导功能的陡脉冲治疗系统，包括：采集模块，用于通过消融电极内置的磁导航模块获取电极的空间位置；定位及距离判断模块，用于计算电极之间的相对距离，并确保所述相对距离最短且位于目标消融范围内；平行度判断模块，用于计算得到电极所在直线的夹角大小来判断电极与电极之间的平行度；深度判断模块，用于计算入针深度；布针引导模块，用于通过磁导航模块实时反馈消融电极的针尖位置进行偏差调整直至穿刺结束，从而使得电极之间平行等距，能够准确穿刺至目标位置。不仅可以减少手术时间、降低患者暴露于射线的风险，还能提高治疗的精准度和一致性，为消融技术提供先进的导航工具，改善治疗体验并提升治疗结果。
权利要求书clms
1.一种具有布针引导功能的陡脉冲治疗系统，其特征在于，包括：采集模块，用于通过消融电极内置的磁导航模块获取至少两个消融电极的空间位置信息；定位及距离判断模块，用于接收第一消融电极和第二消融电极当前的空间位置信息并提取关键特征，根据关键特征确认所述第一消融电极和所述第二消融电极之间的空间位置关系以定位消融电极的位置，根据预设的三维坐标定位算法计算得到所述第一消融电极和所述第二消融电极之间的相对距离，并确保所述相对距离最短且位于目标消融范围内；平行度判断模块，用于将所述第一消融电极和所述第二消融电极之间的相对位置及对应电极所在直线的方向向量进行对比，根据对比结果计算得到所述第一消融电极和所述第二消融电极所在直线的夹角大小来判断电极与电极之间的平行度；深度判断模块，用于确认并获取同一消融电极未穿刺时的第一穿刺点和穿刺过程中的第二穿刺点的位置，分别计算得到所述第一消融电极和所述第二消融电极的入针深度；布针引导模块，用于根据当前所述第一消融电极和所述第二消融电极之间的相对距离、平行度及入针深度与预设的目标电极配置参数进行对比，通过磁导航模块实时反馈消融电极的针尖位置进行偏差调整直至穿刺结束，从而使得所述第一消融电极和所述第二消融电极之间平行等距，能够准确穿刺至目标位置。2.根据权利要求1所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，还包括能量施加模块，所述能量施加模块包括：预处理模块，用于采用磁导航模块反馈的消融电极空间位置数据，并对所述位置数据进行滤波、异常值处理及坐标系转换，生成预处理后统一的特征数据，所述位置数据包括每个消融电极的三维坐标、平行度及深度信息；模型建立模块，用于根据消融电极的空间位置及空间约束条件构建空间关系模型，并将所述特征数据作为所述空间关系模型的输入，能够生成目标消融参数；参数优化模块，用于对不同的空间关系参数分配对应权重，并根据对应权重构建多目标优化问题以寻找最佳的目标消融参数组合，所述权重根据临床需求和目标对象特征进行调整；参数生成模块，用于在构建的多目标优化算法下自动化生成最佳的目标消融参数，所述目标消融参数包括电极施加的电压值、电场频率、消融持续时间；反馈模块，用于将自动化生成的最佳目标消融参数反馈至前端监测界面，并监测运行过程，根据目标对象的反应情况实时对最佳目标消融参数进一步调整。3.根据权利要求1所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述定位及距离判断模块还包括：在三维空间中，若所述第一消融电极和所述第二消融电极所在的直线不相交，则所述第一消融电极和所述第二消融电极之间的最短距离为：，若所述第一消融电极和所述第二消融电极之间的相对距离所在的直线平行，则所述第一消融电极和所述第二消融电极的方位角相同，二者之间的最短距离为对应直线上任意点与点之间的距离：；其中，Pn、Pm分别为第一消融电极和第二消融电极所在直线上的任意两点的三维坐标值;Vn、Vm分别为第一消融电极和第二消融电极所在直线的方向向量，·为向量点积，×为向量的叉积。4.根据权利要求1所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述平行度判断模块还包括：若所述第一消融电极和所述第二消融电极所在直线的方向向量相同，则两电极所在的直线相互平行；若所述第一消融电极和所述第二消融电极所在直线的方向向量不同，则根据所述第一消融电极和所述第二消融电极所在直线的夹角大小来判断电极与电极之间的平行度为：，其中，P1是第一消融电极所在直线方向向量，P2是第二消融电极所在直线方向向量。5.根据权利要求1所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述深度判断模块还包括：确认并获取同一消融电极未穿刺时的第一穿刺点的坐标和穿刺过程中的第二穿刺点的坐标/＞；分别计算得到所述第一消融电极和所述第二消融电极的入针深度为：，其中，所述第一穿刺点为皮肤入针点位置。6.根据权利要求2所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述参数生成模块包括：基于电势分析计算消融电极所在空间上任意点P的产生的电势为：，其中，u为空间内任意点P的电势，N为电荷数,Qm为空间点S上的点电荷，rm为空间点S到P点的距离，ε0为介质常数，电场强度E和电势u均满足叠加原理。7.根据权利要求6所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述参数生成模块还包括：计算量优化模块，用于将每个消融电极作为圆柱带电体，将所述圆柱体带电等分为若干个等距点电荷，根据带电圆柱体电势的叠加计算得到目标对象所受的电场强度；根据上述电势公式结合自动化生成的目标消融参数绘制出所需消融电极所在空间电场等势线，根据电场等势线、目标位置的相对位置关系以及目标消融所需的电场强度，自动计算出最终的消融电压及消融占空比参数；和/或，电场判断模块，用于自动判断标识后的目标消融区域是否落入目标消融电场强度的范围内。8.根据权利要求1所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述关键特征包括消融电极所在空间的三维坐标和三维欧拉姿态角。9.根据权利要求1所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述定位及距离判断模块还包括：基于双目视觉定位算法根据人眼视差的原理，采用至少两台经过标定的光学相机从不同角度对任意消融电极上同一光学标记进行拍摄，再根据获取到的不同图像的视差计算出消融电极的实际空间位姿，所述消融电极内置的磁导航模块为光学传感器。10.根据权利要求2所述的具有布针引导功能的陡脉冲治疗系统，其特征在于，所述能量施加模块还包括：基于实时操作系统获取第一消融电极和第二消融电极的当前针尖位姿，同时将当前针尖位姿与目标针尖位姿对比得到的实时偏差进行同步调整，实时接收更新后的第一消融电极和第二消融电极的空间位置信息并对自动化生成的目标消融参数进行对应调整以实现消融电极穿刺过程的闭环反馈控制。
说明书desc
技术领域本发明属于医疗设备技术领域，尤其涉及一种具有布针引导功能的陡脉冲治疗系统。背景技术在陡脉冲治疗系统中，需要至少2根、最多6根消融电极同时联合工作，陡脉冲基于电场原理进行消融，消融发生在两两一对电极之间，所以对两两消融电极之间的距离是一个特别重要的参数，一般会要求两根电极之间的推荐距离是1.1cm-2.2cm之间，系统根据这个电极之间的距离进行工作电压设置，同时两个电极之间要求平行等距。所以在实际手术过程中，需要医生判断两两消融电极之间是否平行等距，以及测量两两消融电极之间的距离。目前，陡脉冲治疗一般是在影像引导下进行手术，例如CT和超声。当使用CT影像引导时，既可以测量电极之间的距离，也可以判断电极之间是否平行等距，但是存在以下问题：增加患者暴露于射线的次数：由于CT一般为非实时影像，所以需要医生一次次扫描，频繁进出CT手术室，频繁的扫描导致患者反复受到射线的照射，这可能会增加患者的健康风险，尤其是对于长期治疗需要多次陡脉冲治疗的患者；延长手术时间：CT扫描需要时间来准备和执行，每次扫描都会延长手术时间，增加了患者在手术台上的时间，这可能会导致不适和并发症的风险上升；增加医疗资源的消耗：每次CT扫描都需要专业的设备和技术人员，这增加了医疗资源的消耗，同时也增加了医疗成本。当使用超声影像引导时，超声虽然能够做到实时，而且没有射线，但也存在以下问题：1）无法识别多个电极之间的位置关系：超声影像在实时性和无射线方面具有优势，当消融电极数量超过3针时，难以准确识别它们之间的空间位置关系，这导致医生无法获得足够的信息来确保电极之间的距离和平行度；2）限制了手术的精确性：由于超声无法提供足够的信息来指导电极布置，手术的精确性受到了限制，这可能导致治疗效果不如预期，甚至可能需要额外的手术进行干预；3）增加医生的操作难度：医生在使用超声影像进行引导时需要更多的经验和技巧，必须依赖有限的信息来做出决策，无疑增加了手术的操作难度。综上所述，现有的陡脉冲治疗系统技术存在严重问题，包括频繁的CT扫描增加了患者的射线暴露和手术时间，以及超声影像的限制，导致手术的精确性受到限制。这些问题不仅影响了患者的安全和治疗效果，还增加了医疗资源的浪费。因此，有必要提出一种创新性的解决方案来克服这些问题，提高陡脉冲治疗的效率和精确性。发明内容本发明的技术目的是提供一种具有布针引导功能的陡脉冲治疗系统及系统，以解决陡脉冲治疗的效率和精确性不高的问题。为解决上述问题，本发明的技术方案为：一种具有布针引导功能的陡脉冲治疗系统，包括：采集模块，用于通过消融电极内置的磁导航模块获取至少两个消融电极的空间位置信息；定位及距离判断模块，用于接收第一消融电极和第二消融电极当前的空间位置信息并提取关键特征，根据关键特征确认所述第一消融电极和所述第二消融电极之间的空间位置关系以定位消融电极的位置，根据预设的三维坐标定位算法计算得到所述第一消融电极和所述第二消融电极之间的相对距离，并确保所述相对距离最短且位于目标消融范围内；平行度判断模块，用于将所述第一消融电极和所述第二消融电极之间的相对位置及对应电极所在直线的方向向量进行对比，根据对比结果计算得到所述第一消融电极和所述第二消融电极所在直线的夹角大小来判断电极与电极之间的平行度；深度判断模块，用于确认并获取同一消融电极未穿刺时的第一穿刺点和穿刺过程中的第二穿刺点的位置，分别计算得到所述第一消融电极和所述第二消融电极的入针深度；布针引导模块，用于根据当前所述第一消融电极和所述第二消融电极之间的相对距离、平行度及入针深度与预设的目标电极配置参数进行对比，通过磁导航模块实时反馈消融电极的针尖位置进行偏差调整直至穿刺结束，从而使得所述第一消融电极和所述第二消融电极之间平行等距，能够准确穿刺至目标位置。作为优选地，还包括能量施加模块，所述能量施加模块包括：预处理模块，用于采用磁导航模块反馈的消融电极空间位置数据，并对所述位置数据进行滤波、异常值处理及坐标系转换，生成预处理后统一的特征数据，所述位置数据包括每个消融电极的三维坐标、平行度及深度信息；模型建立模块，用于根据消融电极的空间位置及空间约束条件构建空间关系模型，并将所述特征数据作为所述空间关系模型的输入，能够生成目标消融参数；参数优化模块，用于对不同的空间关系参数分配对应权重，并根据对应权重构建多目标优化问题以寻找最佳的目标消融参数组合，所述权重根据临床需求和目标对象特征进行调整；参数生成模块，用于在构建的多目标优化算法下自动化生成最佳的目标消融参数，所述目标消融参数包括电极施加的电压值、电场频率、消融持续时间；反馈模块，用于将自动化生成的最佳目标消融参数反馈至前端监测界面，并监测运行过程，根据目标对象的反应情况实时对最佳目标消融参数进一步调整。作为优选地，所述定位及距离判断模块还包括：在三维空间中，若所述第一消融电极和所述第二消融电极所在的直线不相交，则所述第一消融电极和所述第二消融电极之间的最短距离为：，若所述第一消融电极和所述第二消融电极之间的相对距离所在的直线平行，则所述第一消融电极和所述第二消融电极的方位角相同，二者之间的最短距离为对应直线上任意点与点之间的距离：；其中，Pn、Pm分别为第一消融电极和第二消融电极所在直线上的任意两点的三维坐标值;Vn、Vm分别为第一消融电极和第二消融电极所在直线的方向向量，·为向量点积，×为向量的叉积。作为优选地，所述平行度判断模块还包括：若所述第一消融电极和所述第二消融电极所在直线的方向向量相同，则两电极所在的直线相互平行；若所述第一消融电极和所述第二消融电极所在直线的方向向量不同，则根据所述第一消融电极和所述第二消融电极所在直线的夹角大小来判断电极与电极之间的平行度为：，其中，P1是第一消融电极所在直线方向向量，P2是第二消融电极所在直线方向向量。作为优选地，所述深度判断模块还包括：确认并获取同一消融电极未穿刺时的第一穿刺点的坐标和穿刺过程中的第二穿刺点的坐标/＞；分别计算得到所述第一消融电极和所述第二消融电极的入针深度为：，其中，所述第一穿刺点为皮肤入针点位置。作为优选地，所述参数生成模块包括：基于电势分析计算消融电极所在空间上任意点P的产生的电势为：，其中，u为空间内任意点P的电势，N为电荷数,Qm为空间点S上的点电荷，rm为空间点S到P点的距离，ε0为介质常数，电场强度E和电势u均满足叠加原理。作为优选地，所述参数生成模块还包括：计算量优化模块，用于将每个消融电极作为圆柱带电体，将所述圆柱体带电等分为若干个等距点电荷，根据带电圆柱体电势的叠加计算得到目标对象所受的电场强度；根据上述电势公式结合自动化生成的目标消融参数绘制出所需消融电极所在空间电场等势线，根据电场等势线、目标位置的相对位置关系以及目标消融所需的电场强度，自动计算出最终的消融电压及消融占空比参数；和/或，电场判断模块，用于自动判断标识后的目标消融区域是否落入目标消融电场强度的范围内。作为优选地，所述关键特征包括消融电极所在空间的三维坐标和三维欧拉姿态角。作为优选地，所述定位及距离判断模块还包括：基于双目视觉定位算法根据人眼视差的原理，采用至少两台经过标定的光学相机从不同角度对任意消融电极上同一光学标记进行拍摄，再根据获取到的不同图像的视差计算出消融电极的实际空间位姿，所述消融电极内置的磁导航模块为光学传感器。作为优选地，所述能量施加模块还包括：基于实时操作系统获取第一消融电极和第二消融电极的当前针尖位姿，同时将当前针尖位姿与目标针尖位姿对比得到的实时偏差进行同步调整，实时接收更新后的第一消融电极和第二消融电极的空间位置信息并对自动化生成的目标消融参数进行对应调整以实现消融电极穿刺过程的闭环反馈控制。本发明由于采用以上技术方案，使其与现有技术相比具有以下的优点和积极效果：本发明旨在优化陡脉冲治疗手术流程，提高精确度和效率。通过多电极位置感知计算、实时数据反馈、自动化参数生成以及实时调整和反馈闭环控制等多项功能相互协作，将电极定位和治疗参数设置变得更加简单和可靠。如此不仅可以减少手术时间、降低患者暴露于射线的风险，还能提高治疗的精准度和一致性，为消融技术提供更先进的导航工具，改善治疗体验并提升治疗结果。附图说明通过阅读下文优选实施方式的详细描述，各种其他的优点和益处对于本领域普通技术人员将变得清楚明了。附图仅用于示出优选实施方式的目的，而并不认为是对本发明的限制。图1为本发明实施例中一种具有布针引导功能的陡脉冲治疗系统的原理框图；图2为本发明实施例中集成磁导航模块的纳米电极示意图；图3为本发明实施例中集成磁感应传感器的消融电极结构示意图；图4为本发明实施例中电场仿真效果图；图5为本发明实施例中消融电极布针方式示意图。附图标记说明：1：消融电极；2：磁导航模块。具体实施方式为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对照附图说明本发明的具体实施方式。显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图，并获得其他的实施方式。为使图面简洁，各图中只示意性地表示出了与本发明相关的部分，它们并不代表其作为产品的实际结构。另外，以使图面简洁便于理解，在有些图中具有相同结构或功能的部件，仅示意性地绘示了其中的一个，或仅标出了其中的一个。在本文中，“一个”不仅表示“仅此一个”，也可以表示“多于一个”的情形。以下结合附图和具体实施例对本发明提出的一种具有布针引导功能的陡脉冲治疗系统作进一步详细说明。根据下面说明和权利要求书，本发明的优点和特征将更清楚。参看图1所示，本实施例提供了一种具有布针引导功能的陡脉冲治疗系统，包括：采集模块，用于通过消融电极内置的磁导航模块获取至少两个消融电极的空间位置信息，例如，图2所示集成磁导航模块2的消融电极1，可以是纳米电极；首先，本实施例通过在多达6根消融电极中植入高精度磁导航模块，即采用传感器多种技术，包括电容传感、磁感应、超声测距、激光定位等，以实时、精确地监测每根电极的位置和方向。这些传感器与治疗系统紧密协作，将电极的三维坐标信息传输至系统，为精准定位和治疗参数的生成提供了关键数据。此处在消融电极植入有高精度传感器，做到每根消融电极均有相对应传感器，至少2根消融电极。例如，当消融电极多达6根时，传感器数量也可达到6个，以支持复杂的电极配置。高精度传感器可选用电容传感器、磁感应传感器、超声测距传感器和激光定位传感器中的一种。实施时，可以在消融电极末端放置光学标记，即采用激光定位传感器，也可以在消融电极1尖端放置磁导航模块2，此处磁导航模块2为磁感应传感器，例如图3所示。依靠高精度传感器，以实现实时、精确地采集并获取各消融电极的位置与方向，即电极位置信息，后续会将送入相应计算单元中进行数据处理。定位及距离判断模块，用于接收第一消融电极和第二消融电极当前的空间位置信息并提取关键特征，根据关键特征确认所述第一消融电极和所述第二消融电极之间的空间位置关系以定位消融电极的位置，根据预设的三维坐标定位算法计算得到所述第一消融电极和所述第二消融电极之间的相对距离，并确保所述相对距离最短且位于目标消融范围内；平行度判断模块，用于将所述第一消融电极和所述第二消融电极之间的相对位置及对应电极所在直线的方向向量进行对比，根据对比结果计算得到所述第一消融电极和所述第二消融电极所在直线的夹角大小来判断电极与电极之间的平行度；深度判断模块，用于确认并获取同一消融电极未穿刺时的第一穿刺点和穿刺过程中的第二穿刺点的位置，分别计算得到所述第一消融电极和所述第二消融电极的入针深度；布针引导模块，用于根据当前所述第一消融电极和所述第二消融电极之间的相对距离、平行度及入针深度与预设的目标电极配置参数进行对比，通过磁导航模块实时反馈消融电极的针尖位置进行偏差调整直至穿刺结束，从而使得所述第一消融电极和所述第二消融电极之间平行等距，能够准确穿刺至目标位置。本实施例采用的磁导航模块比如NDI，提供传感器位置坐标调用SDK接口，治疗系统软件可以通过调用相关函数获得传感器空间位置。实施时，比如消融电极上放置光学标记，磁传感器，以传感器信息处理系统规定的基坐标系为治疗系统的三维坐标系，比如侦测光学标记的光学相机基坐标系作为治疗系统的三维坐标系。，本实施例从空间位置信息中提取的关键特征数据包括消融电极在空间的三维坐标和三维欧拉姿态角共6个参数，而基于磁导航模块传回的上述6个参数可以确定消融电极在当前空间的位置。本实施例通过传感器的实时数据反馈，使医生能够准确了解每对电极之间的距离、平行度和深度参数。这些数据可视化显示在手术监视器上，为医生提供了即时的、可视化的导航工具。同时，系统还采用高级数据处理算法，根据传感器提供的信息自动计算出电极之间的相对位置，确保高度精确的电极配置。根据前述的磁导航模块的感知技术，可以精准的知道消融电极在空间中的位置，通过导航软件将多个消融电极的空间位置以及电极之间的相对最短距离值显示在显示屏上，具体为：所述定位及距离判断模块还包括：在三维空间中，若所述第一消融电极和所述第二消融电极所在的直线不相交，则所述第一消融电极和所述第二消融电极之间的最短距离为：，若所述第一消融电极和所述第二消融电极之间的相对距离所在的直线平行，则所述第一消融电极和所述第二消融电极的方位角相同，二者之间的最短距离为对应直线上任意点与点之间的距离：；其中，Pn、Pm分别为第一消融电极和第二消融电极所在直线上的任意两点的三维坐标值，优选的这里取消融电极的针尖坐标值;Vn、Vm分别为第一消融电极和第二消融电极所在直线的方向向量，·为向量点积，×为向量的叉积。这个最短距离就是最终穿刺到位的两根平行针的距离也就是手术规划要求的最终距离。上述计算方式可以理解为，1.首先，计算P1到P2的向量；2.然后，计算v1和v2的叉积；3.再计算向量与的点积，并取其模的值，得到|﹒|；4.最后，除以的模的值|v1×v2|，得到最短距离。优选地，本实施例确保第一消融电极和第二消融电极之间相对距离位于目标消融范围内，则第一消融电极和第二消融电极之间相对距离范围为1.1cm-2.2cm，有利于系统根据这个电极之间的距离进行工作电压设置，同时两个电极之间满足平行等距要求。可以理解为，通过已确定的电极坐标，系统使用几何学算法计算出每对电极之间的距离。这些距离数据对于治疗参数的生成至关重要。系统会根据医生的预设，确保电极之间的距离在治疗所需的范围内。本实施中消融电极间的相对距离、平行度及深度是穿刺过程中需要监测并调节的核心参数，需要在穿刺过程中通过磁导航反馈上述参数进行调整，指导最终满足平行等距要求。此过程穿刺是人工执行，但是人工不可能很精准的按照手术规划一下子穿刺到位，所以需要通过磁导航模块校正，如果消融针偏离一点反馈偏离就立即调整，不断调整直到穿刺完成。一种实施例中，在通过定位及距离判断模块先对消融电极定位及两两消融电极之间距离判断的基础上，再对二者的平行度进行判断，虽然软件是设置好平行度及深度信息，但实际穿刺会和平行度有偏差，所以需要磁导航反馈针尖位置调整，因此，为了系统能够判断电极是否平行等距，并计算出它们在组织中的深度。这些参数对于确保治疗的精准性非常重要。这边采用的所述平行度判断模块还包括：若所述第一消融电极和所述第二消融电极所在直线的方向向量相同，则两电极所在的直线相互平行；若所述第一消融电极和所述第二消融电极所在直线的方向向量不同，则根据所述第一消融电极和所述第二消融电极所在直线的夹角大小来判断电极与电极之间的平行度为：，其中，P1是第一消融电极所在直线方向向量，P2是第二消融电极所在直线方向向量。这样使得第一消融电极和第二消融电极之间平行等距，或者其他数量两两消融电极之间满足平行等距要求，只有这样才能均匀有效的灭活细胞，提高消融准确性。一种实施例中，为了判断消融针进入组织的深度，确保达到目标消融区域，提高消融准确性，所述深度判断模块还包括：确认并获取同一消融电极未穿刺时的第一穿刺点的坐标和穿刺过程中的第二穿刺点的坐标/＞；分别计算得到所述第一消融电极和所述第二消融电极的入针深度为：，其中，所述第一穿刺点为皮肤入针点位置。本申请的多种实施例中，根据实时反馈的电极之间的距离和位置关系，本发明还可以自动生成治疗参数，例如电压等。这样，手术流程得以简化，布针难度降低，治疗的精准度得到提高。本技术方案中能量施加模块的自动化消融参数生成算法是保证陡脉冲治疗系统的高效性和精确性的核心组成部分。以下将详细介绍该算法的工作原理，包括如何基于电极的空间位置和关系数据生成最佳的消融参数。本实施例中系统还包括能量施加模块，所述能量施加模块包括：预处理模块，用于采用磁导航模块反馈的消融电极空间位置数据，并对所述位置数据进行滤波、异常值处理及坐标系转换，生成预处理后统一的特征数据，所述位置数据包括每个消融电极的三维坐标、平行度及深度信息；首先，数据采集与前处理：系统会实时采集传感器提供的电极位置数据，这些数据包括每根电极的三维坐标、平行度、深度等信息。在数据采集后，系统会进行前处理，包括数据滤波、异常值处理和坐标系转换，以确保输入数据的准确性和一致性。模型建立模块，用于根据消融电极的空间位置及空间约束条件构建空间关系模型，并将所述特征数据作为所述空间关系模型的输入，能够生成目标消融参数；接下来，空间关系建模：系统将建立一个空间关系模型，以描述电极之间的相对位置和空间约束。这个模型将包括电极之间的距离、平行度、深度等参数，并考虑到电极配置的具体情况。这个模型将成为生成治疗参数的依据。参数优化模块，用于对不同的空间关系参数分配对应权重，并根据对应权重构建多目标优化问题以寻找最佳的目标消融参数组合，所述权重根据临床需求和目标对象特征进行调整；此模块设置参数权重和优化：系统会为不同的空间关系参数分配权重，这些权重根据临床需求和患者特征进行调整。例如，某些情况下，距离的精确性可能更加重要，而在其他情况下，平行度和深度可能更关键。系统会根据这些权重，构建一个多目标优化问题，以寻找最佳的治疗参数组合。参数生成模块，用于在构建的多目标优化算法下自动化生成最佳的目标消融参数，所述目标消融参数包括电极施加的电压值、电场频率、消融持续时间；系统将运用多目标优化算法，如多目标遗传算法或多目标粒子群优化算法，以在权重下生成最佳的治疗参数。这些参数可能包括：电压：根据距离和平行度的权重分配，确定电极应该施加的电压以达到所需的热效应。频率：确定电场的频率，以最大程度地影响目标组织而减小对周围健康组织的影响。消融持续时间：根据距离和深度，确定消融应该持续的时间，以确保充分的组织消融。反馈模块，用于将自动化生成的最佳目标消融参数反馈至前端监测界面，并监测运行过程，根据目标对象的反应情况实时对最佳目标消融参数进一步调整。一旦参数生成完成，系统会将这些参数实时反馈给医生，并在治疗过程中进行监控。医生可以在监视器上查看参数，并根据患者的响应进行必要的实时调整。这种反馈机制确保了治疗的个体化和精准性。本实施例的关键之一是自动化消融参数生成。系统根据传感器反馈的电极位置数据，通过复杂的算法自动生成最佳的治疗参数，如电压、频率等。这一自动化过程大大简化了手术流程，降低了医生的工作负担，同时提高了治疗的精确性和一致性，患者将受益于更加可靠的治疗效果。电场强度是一个矢量,表征静电场的强弱和方向,是从力的角度描述电场的，电势又称为静电场的标势,是一个标量,表征了电场是一个保守场,是从能量的角度描述电场的；对于空间某一点P,电场强度E和电势u均满足叠加原理。电场的叠加属于矢量叠加,计算难度相对较大;电势的叠加属于标量叠加,计算难度较小，对于肿瘤治疗领域而言，细胞是否凋零是和承受电场能量直接相关，因此，本实施例基于电势进行分析。一种实施例中，为了评估目标消融区域是否落入消融电场强度范围内，所述参数生成模块包括：假设空间点S有一点电荷Q，其在P点的电势为：，其中，/＞，为S到P点的距离。对于一个有N个电荷的电荷系而言，基于电势分析计算消融电极所在空间上任意点P的产生的电势为：，其中，u为空间内任意点P的电势，N为电荷数,Qm为空间点S上的点电荷，rm为空间点S到P点的距离，ε0为介质常数，电场强度E和电势u均满足叠加原理。为减少计算量，所述参数生成模块还包括：计算量优化模块，用于将每个消融电极作为圆柱带电体，将所述圆柱体带电等分为若干个等距点电荷，根据带电圆柱体电势的叠加计算得到目标对象所受的电场强度；每个消融电极可以近似为一个圆柱带电体，实际细胞组织所受的电场强度是两根带电圆柱体电势叠加。根据上述电势公式结合自动化生成的目标消融参数绘制出所需消融电极所在空间电场等势线，根据电场等势线、目标位置的相对位置关系以及目标消融所需的电场强度，自动计算出最终的消融电压及消融占空比参数；电场强度计算:E=U/d,U为两点间电势差,d为沿电场线方向的距离。占空比是指计算机和系统中某个脉冲被激发出来的持续时间与该脉冲周期的比率。它是一个比率，常用百分比来表示，即用百分数来表示，表示的公式为：占空比=激发/有效时间/一个周期的时间*100%。电场判断模块，用于自动判断标识后的目标消融区域是否落入目标消融电场强度的范围内。因此，根据上述公式，可以绘制出自动化治疗参数需要的消融电极所在空间电场等势线，根据及肿瘤病灶相对位置关系以及可靠消融需要的电场强度，可以自动计算出需要的消融电压，消融占空比等参数。参见图4所示，并自动对标识的肿瘤区域是否落在可靠消融电场强度进行计算比较，提高消融准确性。一种实施例中，所述能量施加模块还包括：基于实时操作系统获取第一消融电极和第二消融电极的当前针尖位姿，同时将当前针尖位姿与目标针尖位姿对比得到的实时偏差进行同步调整，实时接收更新后的第一消融电极和第二消融电极的空间位置信息并对自动化生成的目标消融参数进行对应调整以实现消融电极穿刺过程的闭环反馈控制。本实施例还具备实时调整和反馈闭环控制的能力。医生可以根据实际情况在监视器上进行手动调整，系统将立即反馈新的电极位置数据，并相应地调整治疗参数。这种实时的、双向的交互式控制使手术过程更加灵活，医生可以根据患者的个体差异进行个性化治疗。本实施例采用了实时操作系统来保证实时调整和闭环反馈控制。实时操作系统具有可预测性：实时操作系统可以保证任务在其时间片截止前完成，从而确保系统的安全性，其次具有高效性：实时操作系统专注于一项任务，因此，可以在给定时间内提供最佳性能，通过采用实时操作系统固定时间片进行定时调度，本项目优选的采用50ms，导航软件的电极位姿显示进程和传感器位姿获取进程虽然微观上是分时运行，但宏观上是同时运行，因而医生可以实时感知电极位姿并实时调整电极的位姿，实现消融电极穿刺过程的闭环反馈控制。一种实施例中，作为优选地，所述定位及距离判断模块还包括：基于双目视觉定位算法根据人眼视差的原理，采用至少两台经过标定的光学相机从不同角度对任意消融电极上同一光学标记进行拍摄，再根据获取到的不同图像的视差计算出消融电极的实际空间位姿，所述消融电极内置的磁导航模块为光学传感器；当同一个标记后消融电极同时出现在左右两张图像中时，由于摄像头之间的基线距离，它在两个图像中的位置会有所偏移，这种偏移量称为视差。视差可以通过计算两张图像中对应像素点的距离差来得到。其中，所述消融电极内置的其他导航模块还可以使用电容传感器、超声测距传感器、激光定位传感器中的任意一种或多种，常见的平行布针方式见图5所示，基于三角定位算法获取导航模块的空间位姿的方式还可以采用3组正交垂直的电磁场发射线圈，其中每一组发射线圈内至少有3个共面线圈,通过测量导航模块的感应线圈的电流，获取至少9组含有6个空间姿态参数的方程组，经过最优解解算即可获取消融电极的空间位姿，所述消融电极内置有导航模块为电磁传感器；三角定位原理系假设一量测目标点P1及两个已知坐标的参考点P2、P3可形成一个三角形，则借由计算三角形其中参考边的长度，量测两参考点与目标点形成的角度，即可找出目标点的距离及坐标。本实施例系统使用传感器提供的位置数据，采用三维坐标定位算法将每个电极的实际位置确定在一个全球坐标系中。这个算法结合了光学定位、磁感应、超声测距等传感技术其中之一，以高精度获取电极的X、Y和Z坐标。综上所述，本实施例旨在优化陡脉冲治疗手术流程，提高精确度和效率。通过磁导航模块的多电极位置感知技术、实时数据反馈、自动化参数生成以及实时调整和反馈闭环控制等创新元素相互协作，将电极定位和消融参数设置变得更加简单和可靠。这不仅有望减少手术时间、降低患者暴露于射线的风险，还能提高治疗的精准度和一致性，为医生提供更先进的导航工具，最终改善患者的治疗体验和治疗结果。本实施例陡脉冲治疗系统的关键是1、先通过导航模块获取关键数据保障穿刺到位且精准，2、通过定位及距离判断模块、平行度判断模块、深度判断模块及布针引导模块，先判断消融电极是否定位准确，再判断两两消融电极之间的距离是否等距，并确保相对距离位于目标消融范围内；再判断平行度，调整平行度偏差；确保入针深度到达目标消融区域，从而保障消融过程可靠。由于采用了前述的定位及距离判断模块、平行度判断模块、深度判断模块及布针引导模块，医生可以简单和可靠的可视化穿刺到准确的位置，采用能量施加模块医生可以精准的设定消融参数，并对消融电场分布是否完全覆盖病灶进行评估。上面结合附图对本发明的实施方式作了详细说明，但是本发明并不限于上述实施方式。即使对本发明作出各种变化，倘若这些变化属于本发明权利要求及其等同技术的范围之内，则仍落入在本发明的保护范围之中。
