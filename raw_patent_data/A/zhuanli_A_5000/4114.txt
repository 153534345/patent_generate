标题title
一种基于影像分析的智能化植发评估系统
摘要abst
本发明公开了一种基于影像分析的智能化植发评估系统，属于植发技术领域，包括待植发区域确定模块、待植发区域分块处理模块、既有毛囊统计模块、植发评估模块。本发明通过获取移植毛囊存活数量、移植毛囊未存活数量，并对第二方形框区域图像的实际面积进行修正，结合修正后面积对移植毛囊未存活密度均值与移植毛囊存活密度均值的比值进行计算，得到量化的植发评估结果，改变了传统的植发效果评估方式，相对人工判断方式准确性得到提高，不会受到人为主观经验等因素影响。
权利要求书clms
1.一种基于影像分析的智能化植发评估系统，其特征在于，包括：待植发区域确定模块、待植发区域分块处理模块、既有毛囊统计模块、植发评估模块 ；所述待植发区域确定模块，用于在植发前获取患者头部局部图像，根据预设的闭合标记线获取待植发区域图像；所述待植发区域分块处理模块，用于对待植发区域图像进行分块化处理，进而得到各方形框在待植发区域图像的位置信息，并根据各方形框的位置信息得到各个第一方形框区域图像；所述既有毛囊统计模块，用于对各个第一方形框区域图像中既有的有毛发生长的毛囊数量进行统计，得到各个第一方形框区域图像中既有毛囊数量信息；所述植发评估模块，用于在植发后获取与待植发区域确定模块中相同的患者头部局部图像，根据各方形框的位置信息得到多个第二方形框区域图像，进而通过识别得到第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量；并用于在植发后获取患者头部局部深度图像，利用患者头部局部深度图像对各个第二方形框区域图像的实际面积进行修正，获取各个第二方形框区域图像的修正后面积信息；然后根据各个第一方形框区域图像中既有毛囊数量信息，以及各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，结合各个第二方形框区域图像的修正后面积信息对植发效果进行评估，得到植发评估结果值。2.根据权利要求1所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述待植发区域确定模块包括图像获取单元、图像预处理单元、闭合标记线识别单元、待植发区域位置获取单元；所述图像获取单元用于在植发前通过拍摄设备对患者头部局部区域进行拍摄，获取植发前的患者头部局部图像，其中，植发前的患者头部局部区域包含待植发区域；所述图像预处理单元用于对患者头部局部图像进行预处理，得到预处理后的植发前的患者头部局部图像；所述闭合标记线识别单元用于通过预处理后的植发前的患者头部局部图像中各像素点的R、G、B通道值，对闭合标记线所在的区域进行识别；所述待植发区域位置获取单元用于对识别到的闭合标记线区域的内轮廓进行检测，获取闭合标记线区域内轮廓上各点的坐标位置，根据坐标位置将待植发区域从患者头部局部图像中裁剪下来，即得到待植发区域图像。3.根据权利要求2所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述闭合标记线区域的颜色为预设RGB颜色，预设RGB颜色在患者头部局部图像中的R、G、B通道值均在设定范围内。4.根据权利要求2所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述图像预处理单元预处理的方式包括降噪、增强处理，降噪处理采用高斯滤波降噪或中值滤波降噪方式实现，增强处理方式采用直方图均衡化实现。5.根据权利要求1所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述待植发区域分块处理模块包括填充处理单元、方形框位置信息获取单元、第一方形框区域图像获取单元；所述分块填充单元用于通过多个相同尺寸的方形框对待植发区域图像进行填充处理，在填充方形框时，按照从左至右、从上到下的顺序利用方形框对待植发区域图像进行填充，直至所有位于最外侧的方形框与待植发区域图像边缘之间无法填入一个完整的方形框时，结束填充处理工作，即完成分块化处理工作，其中，当方形框内部为平面时，其在实际空间下的实际面积为S1；所述方形框位置信息获取单元用于通过经过训练的第一目标检测模型对待植发区域图像填充的各方形框进行目标检测，获取各方形框目标检测框的四个角点坐标，根据四个角点坐标获取各方形框目标检测框的中心点坐标，各方形框目标检测框的四个角点坐标及中心点坐标即各方形框的位置信息，将各方形框的位置信息发送至所述植发评估模块中；所述第一方形框区域图像获取单元用于根据各方形框目标检测框的四个角点坐标，将方形框目标检测框对应的区域从待植发区域图像中裁剪下来，即得到各个第一方形框区域图像，将各个第一方形框区域图像发送至所述既有毛囊统计模块中。6.根据权利要求1所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述既有毛囊统计模块包括第一毛囊目标检测单元、第一毛囊计算单元；所述第一毛囊目标检测单元用于通过第二目标检测模型对各个第一方形框区域图像中既有的毛囊进行识别，获取多个毛囊目标检测框，并对毛囊目标检测框中毛囊类别进行分类，获得毛囊目标检测框的类别检测结果，其中，毛囊类别包括有毛发生长的毛囊、无毛发生长的毛囊；所述第一毛囊计算单元用于根据第一毛囊目标检测单元中毛囊目标检测框的类别检测结果，计算得到各个第一方形框区域图像中既有的毛囊数量，其中，第一方形框区域图像中既有的有毛发生长的毛囊数量记为Cn，既有的无毛发生长的毛囊数量记为Dn，n表示第n个第一方形框区域图像。7.根据权利要求1所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述植发评估模块 包括第二方形框区域图像获取单元、第二毛囊目标检测单元、第二毛囊计算单元；所述第二方形框区域图像获取单元用于根据待植发区域分块处理模块获取的各方形框在待植发区域图像的位置信息，将方形框目标检测框对应的区域从植发后获取的患者头部局部图像裁剪下来，即得到各个第二方形框区域图像，将第二方形框区域图像发送至所述第二毛囊目标检测单元中；所述第二毛囊目标检测单元用于通过第二目标检测模型对各个第二方形框区域图像中毛囊进行识别，获取多个毛囊目标检测框，并对毛囊目标检测框中毛囊类别进行分类，获得毛囊目标检测框的类别检测结果，其中，毛囊类别包括有毛发生长的毛囊、无毛发生长的毛囊；所述第二毛囊计算单元用于第二毛囊目标检测单元中毛囊目标检测框的类别检测结果，计算得到各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，其中，第二方形框区域图像中有毛发生长的毛囊数量记为Mn，无毛发生长的毛囊数量记为Wn，n表示第n个第二方形框区域图像，第二方形框区域图像的位置、数量、尺寸均与第一方形框区域图像完全一致。8.根据权利要求7所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述植发评估模块还包括深度图获取单元、方形框区域深度图像获取单元、面积修正单元、评估单元；所述深度图获取单元用于在植发后通过深度相机获取与患者头部局部图像尺寸、位置、分辨率均相同的患者头部局部深度图像并对其进行预处理，得到预处理后的患者头部局部深度图像；所述方形框区域深度图像获取单元用于根据待植发区域分块处理模块获取的各方形框在待植发区域图像的位置信息，将方形框目标检测框对应的区域从预处理后患者头部局部深度图像中裁剪下来，即得到各个方形框区域深度图像；所述面积修正单元用于对各个方形框区域深度图像中部分像素点的像素值，对各个第二方形框区域图像的实际面积进行修正，获取各个第二方形框区域图像的修正后面积信息，记为S2n，其中n表示第n个第二方形框区域图像；所述评估单元用于根据各个第一方形框区域图像中既有毛囊数量信息，以及各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，结合各个第二方形框区域图像的修正后面积信息对植发效果进行评估，得到植发评估结果值。9.根据权利要求8所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述面积修正单元的具体处理过程如下：S21：根据各方形框在植发前的待植发区域图像的位置信息，对应获取各个方形框区域深度图像四个角点的坐标；S22：根据各个方形框区域深度图像四个角点的坐标对应获取四个角点对应的像素点的像素值，即为对应像素点与深度相机在实际空间的距离值，也即得到四个角点对应的像素点的距离值，记为Jn1、Jn2、Jn3、Jn4，对四个角点对应的像素点的距离值进行均值处理，计算公式为Jnavg=/4，其中，Jnavg表示第n个方形框区域深度图像的四个角点的对应的像素点的距离均值，n表示第n个方形框区域深度图像；S23：在单个方形框区域深度图像中，遍历各个像素点，获取各个像素点的像素值，得到最大的像素值，即得到最大距离值Jnmax，计算距离均值Jnavg与最大距离值Jnmax的差值，得到距离差值Jndif，在距离差值范围-面积修正系数数据库中进行查找，得到各个第二方形框区域图像的面积修正系数Xn；遍历各个方形框区域深度图像，得到各个第二方形框区域图像的面积修正系数，利用面积修正系数与预设的实际面积S1计算获取第二方形框区域图像的修正后面积信息，记为S2n，计算公式为S2n=S1*Xn；在所述步骤S23中，距离差值-面积修正系数数据库存储有预设的距离差值范围与面积修正系数之间的关联关系。10.根据权利要求9所述的一种基于影像分析的智能化植发评估系统，其特征在于：所述评估单元的具体处理过程如下：S31：获取各个第二方形框区域图像中有毛发生长的毛囊数量Mn、无毛发生长的毛囊数量Wn；S32：遍历各个第二方形框区域图像，在单个第二方形框区域图像中，将第二方形框区域图像中有毛发生长的毛囊数量Mn减去第一方形框区域图像中既有的有毛发生长的毛囊数量Cn，得到移植毛囊存活数量Z1n，将第二方形框区域图像中无毛发生长的毛囊数量Wn减去第一方形框区域图像中既有的无毛发生长的毛囊数量Dn，得到移植毛囊未存活数量Z2n；S33：计算移植毛囊存活密度均值CHavg，计算公式如下：CHavg=/n，其中，CHavg为本次移植后移植毛囊存活密度均值，Z1n表示第n个第二方形框区域图像中的移植毛囊存活数量，S2n为第n个第二方形框区域图像的修正后面积值；计算移植毛囊未存活密度均值NHavg，计算公式如下：NHavg=/n，其中，NHavg为本次移植后移植毛囊未存活密度均值，Z2n表示第n个第二方形框区域图像中的移植毛囊未存活数量，S2n为第n个第二方形框区域图像的修正后面积值；S34：计算移植毛囊未存活密度均值NHavg与移植毛囊存活密度均值CHavg的比值，计算公式如下：NC=NHavg/CHavg，其中，NC为移植毛囊未存活密度均值NHavg与移植毛囊存活密度均值CHavg的比值，即为本次的植发评估结果值。
说明书desc
技术领域本发明涉及植发技术领域，具体涉及一种基于影像分析的智能化植发评估系统。背景技术植发就是毛发种植，毛发种植是一种建立在科学理论基础上的治疗脱发的外科手术。这种头部整形手术主要运用自体毛囊种植技术进行头部的美容。毛发种植其原理是应用显微外科技术取出供体部健康的毛囊组织，然后将其种植于毛发稀少的部位，种植后再生的毛发持有原毛发的所有特点，且永久生长在皮下表层里。目前在植发完成后对植发效果评估时，主要是通过经验丰富的医生利用工作经验进行判断，进而得到植发评估结果，上述评估结果的准确性相对较低，容易受到人为主观经验等因素影响，上述问题亟待解决，为此，提出一种基于影像分析的智能化植发评估系统。发明内容本发明所要解决的技术问题在于：如何解决现有技术中在进行植发评估时，主要是通过经验丰富的医生利用工作经验进行判断，进而得到植发评估结果，存在的评估结果的准确性相对较低，容易受到人为主观经验等因素影响的问题，提供了一种基于影像分析的智能化植发评估系统。本发明是通过以下技术方案解决上述技术问题的，本发明包括待植发区域确定模块、待植发区域分块处理模块、既有毛囊统计模块、植发评估模块 ；所述待植发区域确定模块，用于在植发前获取患者头部局部图像，根据预设的闭合标记线获取待植发区域图像；所述待植发区域分块处理模块，用于对待植发区域图像进行分块化处理，进而得到各方形框在待植发区域图像的位置信息，并根据各方形框的位置信息得到各个第一方形框区域图像；所述既有毛囊统计模块，用于对各个第一方形框区域图像中既有的有毛发生长的毛囊数量进行统计，得到各个第一方形框区域图像中既有毛囊数量信息；所述植发评估模块，用于在植发后获取与待植发区域确定模块中相同的患者头部局部图像，根据各方形框的位置信息得到多个第二方形框区域图像，进而通过识别得到第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量；并用于在植发后获取患者头部局部深度图像，利用患者头部局部深度图像对各个第二方形框区域图像的实际面积进行修正，获取各个第二方形框区域图像的修正后面积信息；然后根据各个第一方形框区域图像中既有毛囊数量信息，以及各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，结合各个第二方形框区域图像的修正后面积信息对植发效果进行评估，得到植发评估结果值 。更进一步地，所述待植发区域确定模块包括图像获取单元、图像预处理单元、闭合标记线识别单元、待植发区域位置获取单元；所述图像获取单元用于在植发前通过拍摄设备对患者头部局部区域进行拍摄，获取植发前的患者头部局部图像，其中，植发前的患者头部局部区域包含待植发区域；所述图像预处理单元用于对患者头部局部图像进行预处理，得到预处理后的植发前的患者头部局部图像；所述闭合标记线识别单元用于通过预处理后的植发前的患者头部局部图像中各像素点的R、G、B通道值，对闭合标记线所在的区域进行识别；所述待植发区域位置获取单元用于对识别到的闭合标记线区域的内轮廓进行检测，获取闭合标记线区域内轮廓上各点的坐标位置，根据坐标位置将待植发区域从患者头部局部图像中裁剪下来，即得到待植发区域图像。更进一步地，所述闭合标记线区域的颜色为预设RGB颜色，预设RGB颜色在患者头部局部图像中的R、G、B通道值均在设定范围内。更进一步地，所述图像预处理单元预处理的方式包括降噪、增强处理，降噪处理采用高斯滤波降噪或中值滤波降噪方式实现，增强处理方式采用直方图均衡化实现。更进一步地，所述待植发区域分块处理模块包括填充处理单元、方形框位置信息获取单元、第一方形框区域图像获取单元；所述分块填充单元用于通过多个相同尺寸的方形框对待植发区域图像进行填充处理，在填充方形框时，按照从左至右、从上到下的顺序利用方形框对待植发区域图像进行填充，直至所有位于最外侧的方形框与待植发区域图像边缘之间无法填入一个完整的方形框时，结束填充处理工作，即完成分块化处理工作，其中，当方形框内部为平面时，其在实际空间下的实际面积为S1；所述方形框位置信息获取单元用于通过经过训练的第一目标检测模型对待植发区域图像填充的各方形框进行目标检测，获取各方形框目标检测框的四个角点坐标，根据四个角点坐标获取各方形框目标检测框的中心点坐标，各方形框目标检测框的四个角点坐标及中心点坐标即各方形框的位置信息，将各方形框的位置信息发送至所述植发评估模块中；所述第一方形框区域图像获取单元用于根据各方形框目标检测框的四个角点坐标，将方形框目标检测框对应的区域从待植发区域图像中裁剪下来，即得到各个第一方形框区域图像，将各个第一方形框区域图像发送至所述既有毛囊统计模块中。更进一步地，所述既有毛囊统计模块包括第一毛囊目标检测单元、第一毛囊计算单元；所述第一毛囊目标检测单元用于通过第二目标检测模型对各个第一方形框区域图像中既有的毛囊进行识别，获取多个毛囊目标检测框，并对毛囊目标检测框中毛囊类别进行分类，获得毛囊目标检测框的类别检测结果，其中，毛囊类别包括有毛发生长的毛囊、无毛发生长的毛囊；所述第一毛囊计算单元用于根据第一毛囊目标检测单元中毛囊目标检测框的类别检测结果，计算得到各个第一方形框区域图像中既有的毛囊数量，其中，第一方形框区域图像中既有的有毛发生长的毛囊数量记为Cn，既有的无毛发生长的毛囊数量记为Dn，n表示第n个第一方形框区域图像。更进一步地，所述植发评估模块 包括第二方形框区域图像获取单元、第二毛囊目标检测单元、第二毛囊计算单元；所述第二方形框区域图像获取单元用于根据待植发区域分块处理模块获取的各方形框在待植发区域图像的位置信息，将方形框目标检测框对应的区域从植发后获取的患者头部局部图像裁剪下来，即得到各个第二方形框区域图像，将第二方形框区域图像发送至所述第二毛囊目标检测单元中；所述第二毛囊目标检测单元用于通过第二目标检测模型对各个第二方形框区域图像中毛囊进行识别，获取多个毛囊目标检测框，并对毛囊目标检测框中毛囊类别进行分类，获得毛囊目标检测框的类别检测结果，其中，毛囊类别包括有毛发生长的毛囊、无毛发生长的毛囊；所述第二毛囊计算单元用于第二毛囊目标检测单元中毛囊目标检测框的类别检测结果，计算得到各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，其中，第二方形框区域图像中有毛发生长的毛囊数量记为Mn，无毛发生长的毛囊数量记为Wn，n表示第n个第二方形框区域图像，第二方形框区域图像的位置、数量、尺寸均与第一方形框区域图像完全一致。更进一步地，所述植发评估模块还包括深度图获取单元、方形框区域深度图像获取单元、面积修正单元、评估单元；所述深度图获取单元用于在植发后通过深度相机获取与患者头部局部图像尺寸、位置、分辨率均相同的患者头部局部深度图像并对其进行预处理，得到预处理后的患者头部局部深度图像；所述方形框区域深度图像获取单元用于根据待植发区域分块处理模块获取的各方形框在待植发区域图像的位置信息，将方形框目标检测框对应的区域从预处理后患者头部局部深度图像中裁剪下来，即得到各个方形框区域深度图像；所述面积修正单元用于对各个方形框区域深度图像中部分像素点的像素值，对各个第二方形框区域图像的实际面积进行修正，获取各个第二方形框区域图像的修正后面积信息，记为S2n，其中n表示第n个第二方形框区域图像；所述评估单元用于根据各个第一方形框区域图像中既有毛囊数量信息，以及各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，结合各个第二方形框区域图像的修正后面积信息对植发效果进行评估，得到植发评估结果值 。更进一步地，所述面积修正单元的具体处理过程如下：S21：根据各方形框在植发前的待植发区域图像的位置信息，对应获取各个方形框区域深度图像四个角点的坐标；S22：根据各个方形框区域深度图像四个角点的坐标对应获取四个角点对应的像素点的像素值，即为对应像素点与深度相机在实际空间的距离值，也即得到四个角点对应的像素点的距离值，记为Jn1、Jn2、Jn3、Jn4，对四个角点对应的像素点的距离值进行均值处理，计算公式为Jnavg=/4，其中，Jnavg表示第n个方形框区域深度图像的四个角点的对应的像素点的距离均值，n表示第n个方形框区域深度图像；S23：在单个方形框区域深度图像中，遍历各个像素点，获取各个像素点的像素值，得到最大的像素值，即得到最大距离值Jnmax，计算距离均值Jnavg与最大距离值Jnmax的差值，得到距离差值Jndif，在距离差值范围-面积修正系数数据库中进行查找，得到各个第二方形框区域图像的面积修正系数Xn；遍历各个方形框区域深度图像，得到各个第二方形框区域图像的面积修正系数，利用面积修正系数与预设的实际面积S1计算获取第二方形框区域图像的修正后面积信息，记为S2n，计算公式为S2n=S1*Xn。更进一步地，在所述步骤S23中，距离差值-面积修正系数数据库存储有预设的距离差值范围与面积修正系数之间的关联关系。更进一步地，所述评估单元的具体处理过程如下：S31：获取各个第二方形框区域图像中有毛发生长的毛囊数量Mn、无毛发生长的毛囊数量Wn；S32：遍历各个第二方形框区域图像，在单个第二方形框区域图像中，将第二方形框区域图像中有毛发生长的毛囊数量Mn减去第一方形框区域图像中既有的有毛发生长的毛囊数量Cn，得到移植毛囊存活数量Z1n，将第二方形框区域图像中无毛发生长的毛囊数量Wn减去第一方形框区域图像中既有的无毛发生长的毛囊数量Dn，得到移植毛囊未存活数量Z2n；S33：计算移植毛囊存活密度均值CHavg，计算公式如下：CHavg=/n，其中，CHavg为本次移植后移植毛囊存活密度均值，Z1n表示第n个第二方形框区域图像中的移植毛囊存活数量，S2n为第n个第二方形框区域图像的修正后面积值；计算移植毛囊未存活密度均值NHavg，计算公式如下：NHavg=/n，其中，NHavg为本次移植后移植毛囊未存活密度均值，Z2n表示第n个第二方形框区域图像中的移植毛囊未存活数量，S2n为第n个第二方形框区域图像的修正后面积值；S34：计算移植毛囊未存活密度均值NHavg与移植毛囊存活密度均值CHavg的比值，计算公式如下：NC=NHavg/CHavg，其中，NC为移植毛囊未存活密度均值NHavg与移植毛囊存活密度均值CHavg的比值，即为本次的植发评估结果值 。本发明相比现有技术具有以下优点：该基于影像分析的智能化植发评估系统，通过获取移植毛囊存活数量、移植毛囊未存活数量，并对第二方形框区域图像的实际面积进行修正，结合修正后面积对移植毛囊未存活密度均值与移植毛囊存活密度均值的比值进行计算，得到量化的植发评估结果，改变了传统的植发效果评估方式，相对人工判断方式准确性得到提高，不会受到人为主观经验等因素影响。附图说明图1是本发明实施例中基于影像分析的智能化植发评估系统的结构示意图 。具体实施方式下面对本发明的实施例作详细说明，本实施例在以本发明技术方案为前提下进行实施，给出了详细的实施方式和具体的操作过程，但本发明的保护范围不限于下述的实施例。如图1所示，本实施例提供一种技术方案：一种基于影像分析的智能化植发评估系统，包括：待植发区域确定模块、待植发区域分块处理模块、既有毛囊统计模块、植发评估模块 ；所述待植发区域确定模块，用于在植发前获取患者头部局部图像，根据预设的闭合标记线获取待植发区域图像；在本实施例中，所述待植发区域确定模块包括图像获取单元、图像预处理单元、闭合标记线识别单元、待植发区域位置获取单元；所述图像获取单元用于在植发前通过拍摄设备对患者头部局部区域进行拍摄，获取植发前的患者头部局部图像，并将其发送至所述图像预处理单元中，其中，植发前的患者头部局部区域包含待植发区域；所述图像预处理单元用于对患者头部局部图像进行预处理，得到预处理后的植发前的患者头部局部图像，并将其发送至闭合标记线识别单元中；所述闭合标记线识别单元用于通过预处理后的植发前的患者头部局部图像中各像素点的R、G、B通道值，对闭合标记线所在的区域进行识别；所述待植发区域位置获取单元用于对识别到的闭合标记线区域的内轮廓进行检测，获取闭合标记线区域内轮廓上各点的坐标位置，根据坐标位置将待植发区域从患者头部局部图像中裁剪下来，即得到待植发区域图像，并将其发送至所述待植发区域分块处理模块中，作为下一步待植发区域分块处理模块的基础。通过设置的待植发区域确定模块，能够方便地确定待植发区域，进而获取待植发区域图像，便于后续进行植发效果评估工作。需要说明的是，本实施例中的基于影像分析的智能化植发评估系统用于剃发植发技术中的植发效果工作中。在本实施例中，所述拍摄设备为高清相机等设备。在本实施例中，所述闭合标记线区域的颜色为预设RGB颜色，预设RGB颜色在患者头部局部图像中的R、G、B通道值均在设定范围内。在本实施例中，所述闭合标记线在患者头部局部图像中为预设宽度的闭合线，具有内外轮廓，通过医生确定并绘出闭合标记线的位置。在本实施例中，所述图像预处理单元预处理的方式包括但不限于降噪、增强处理，降噪处理方式包括但不限于高斯滤波降噪、中值滤波降噪等方式，增强处理方式包括但不限于直方图均衡化等方式，用于提高图像的质量，方便后续进行识别。在本实施例中，所述待植发区域位置获取单元的具体处理过程如下：S11：获取识别到的闭合标记线区域；S12：利用OpenCV中的轮廓检测函数对闭合标记线区域的内轮廓进行检测；S13：获取闭合标记线区域内轮廓上各点的坐标位置，根据坐标位置将待植发区域从患者头部局部图像中裁剪下来，即得到待植发区域图像。所述待植发区域分块处理模块，用于对待植发区域图像进行分块化处理，进而得到各方形框在待植发区域图像的位置信息，并根据各方形框的位置信息得到各个第一方形框区域图像；采用本实施例中的分块化处理方式，能够更方便后续对植发效果进行量化。在本实施例中，所述待植发区域分块处理模块包括填充处理单元、方形框位置信息获取单元、第一方形框区域图像获取单元；所述分块填充单元用于通过多个相同尺寸的方形框对待植发区域图像进行填充处理，在填充方形框时，按照从左至右、从上到下的顺序利用方形框对待植发区域图像进行填充，直至所有位于最外侧的方形框与待植发区域图像边缘之间无法填入一个完整的方形框时，结束填充处理工作，即完成分块处理工作，其中，当方形框内部为平面时，其在实际空间下的实际面积为S1，也即方形框的长与宽的乘积；所述方形框位置信息获取单元用于通过经过训练的第一目标检测模型对待植发区域图像填充的各方形框进行目标检测，获取各方形框目标检测框的四个角点坐标，根据四个角点坐标获取各方形框目标检测框的中心点坐标，各方形框目标检测框的四个角点坐标及中心点坐标即各方形框的位置信息，将各方形框的位置信息发送至所述植发评估模块中；所述第一方形框区域图像获取单元用于根据各方形框目标检测框的四个角点坐标，将方形框目标检测框对应的区域从待植发区域图像中裁剪下来，即得到各个第一方形框区域图像，将各个第一方形框区域图像发送至所述既有毛囊统计模块中 。需要说明的是，在填充方形框时，待植发区域图像的多个方形框形成多行，每行中相邻的两个方形框之间的间距为设定值X，相邻行方形框之间的间距为设定值Y，设定值X、设定值Y均为提前预设定的 。在本实施例中，所述第一目标检测模型基于Faster-RCNN网络训练得到，通过大量含有方形框的图片形成数据集，将数据集分为训练集和验证集，对训练集和验证集中的图片中的方形框进行人工标注，将训练集中的图片输入到Faster-RCNN网络中进行训练，得到训练后的模型，并通过验证集对训练后的模型进行性能验证，当通过验证后，保存模型参数，即得到第一目标识别模型。所述既有毛囊统计模块，用于对各个第一方形框区域图像中既有的有毛发生长的毛囊数量进行统计，得到各个第一方形框区域图像中既有毛囊数量信息。将既有的毛囊数量作为其中一个依据，方便后续对植发效果进行评估。在本实施例中，所述既有毛囊统计模块包括第一毛囊目标检测单元、第一毛囊计算单元；所述第一毛囊目标检测单元用于通过第二目标检测模型对各个第一方形框区域图像中既有的毛囊进行识别，获取多个毛囊目标检测框，并对毛囊目标检测框中毛囊类别进行分类，获得毛囊目标检测框的类别检测结果，其中，毛囊类别包括有毛发生长的毛囊、无毛发生长的毛囊；所述第一毛囊计算单元用于根据第一毛囊目标检测单元中毛囊目标检测框的类别检测结果，计算得到各个第一方形框区域图像中既有的毛囊数量，其中，第一方形框区域图像中既有的有毛发生长的毛囊数量记为Cn，既有的无毛发生长的毛囊数量记为Dn，n表示第n个第一方形框区域图像。需要说明的是，本实施例中的既有的无毛发生长的毛囊为坏死的毛囊，对应的毛囊位置不具备移植条件，不会在该位置移植新的毛囊，即在植发一段时间后，由于移植存活率的影响，在同一方形框区域内，无毛发生长的毛囊数量会略微增加。更具体的，本实施例中的植发后是对待植发区域进行植发一段时间后，一部分移植的毛囊存活下来，生长出头发，另一部分移植的毛囊没有存活下来，因此，无毛发生长的毛囊数量会略微增加。在本实施例中，所述第二目标检测模型基于YOLOv3网络训练得到，通过大量含有正常毛囊、非正常毛囊的图片形成数据集，将数据集分为训练集和验证集，对训练集和验证集中的图片中的正常毛囊、非正常毛囊进行人工标注，将训练集中的图片输入到YOLOv3网络中进行训练，得到训练后的模型，并通过验证集对训练后的模型进行性能验证，当通过验证后，保存模型参数，即得到第二目标识别模型，需要说明的是，在得到目标检测框后，YOLOv3网络还会对目标类别进行分类。所述植发评估模块，用于在植发后获取与待植发区域确定模块中相同的患者头部局部图像，根据各方形框的位置信息得到多个第二方形框区域图像，进而通过识别得到第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量；并用于在植发后获取患者头部局部深度图像，利用患者头部局部深度图像对各个第二方形框区域图像的实际面积进行修正，获取各个第二方形框区域图像的修正后面积信息；然后根据各个第一方形框区域图像中既有毛囊数量信息，以及各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，结合各个第二方形框区域图像的修正后面积信息对植发效果进行评估，得到植发评估结果值 。在本实施例中，所述植发评估模块 包括第二方形框区域图像获取单元、第二毛囊目标检测单元、第二毛囊计算单元、深度图获取单元、方形框区域深度图像获取单元、面积修正单元、评估单元；所述第二方形框区域图像获取单元用于根据待植发区域分块处理模块获取的各方形框在待植发区域图像的位置信息，将方形框目标检测框对应的区域从植发后获取的患者头部局部图像裁剪下来，即得到各个第二方形框区域图像，将第二方形框区域图像发送至所述第二毛囊目标检测单元中；所述第二毛囊目标检测单元用于通过第二目标检测模型对各个第二方形框区域图像中毛囊进行识别，获取多个毛囊目标检测框，并对毛囊目标检测框中毛囊类别进行分类，获得毛囊目标检测框的类别检测结果，其中，毛囊类别包括有毛发生长的毛囊、无毛发生长的毛囊；所述第二毛囊计算单元用于第二毛囊目标检测单元中毛囊目标检测框的类别检测结果，计算得到各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，其中，第二方形框区域图像中有毛发生长的毛囊数量记为Mn，无毛发生长的毛囊数量记为Wn，n表示第n个第二方形框区域图像，第二方形框区域图像的位置、数量、尺寸均与第一方形框区域图像完全一致；所述深度图获取单元用于在植发后通过深度相机获取与患者头部局部图像尺寸、位置、分辨率均相同的患者头部局部深度图像并对其进行预处理，得到预处理后的患者头部局部深度图像，将其发送至方形框区域深度图像获取单元中；所述方形框区域深度图像获取单元用于根据待植发区域分块处理模块获取的各方形框在待植发区域图像的位置信息，将方形框目标检测框对应的区域从预处理后患者头部局部深度图像中裁剪下来，即得到各个方形框区域深度图像，将各个方形框区域深度图像发送至面积修正单元中；所述面积修正单元用于对各个方形框区域深度图像中部分像素点的像素值，对各个第二方形框区域图像的实际面积进行修正，获取各个第二方形框区域图像的修正后面积信息，记为S2n，其中n表示第n个第二方形框区域图像；所述评估单元用于根据各个第一方形框区域图像中既有毛囊数量信息，以及各个第二方形框区域图像中有毛发生长的毛囊数量、无毛发生长的毛囊数量，结合各个第二方形框区域图像的修正后面积信息对植发效果进行评估，得到植发评估结果值 。在本实施例中，所述面积修正单元的具体处理过程如下：S21：根据各方形框在植发前的待植发区域图像的位置信息，对应获取各个方形框区域深度图像四个角点的坐标；S22：根据各个方形框区域深度图像四个角点的坐标对应获取四个角点对应的像素点的像素值，即为对应像素点与深度相机在实际空间的距离值，也即得到四个角点对应的像素点的距离值，记为Jn1、Jn2、Jn3、Jn4，对四个角点对应的像素点的距离值进行均值处理，计算公式为Jnavg=/4，其中，Jnavg表示第n个方形框区域深度图像的四个角点的对应的像素点的距离均值，n表示第n个方形框区域深度图像；S23：在单个方形框区域深度图像中，遍历各个像素点，获取各个像素点的像素值，得到最大的像素值，即得到最大距离值Jnmax，计算距离均值Jnavg与最大距离值Jnmax的差值，得到距离差值Jndif，在距离差值范围-面积修正系数数据库中进行查找，得到各个第二方形框区域图像的面积修正系数Xn；遍历各个方形框区域深度图像，得到各个第二方形框区域图像的面积修正系数，利用面积修正系数与预设的实际面积S1计算获取第二方形框区域图像的修正后面积信息，记为S2n，计算公式为S2n=S1*Xn。在本实施例中，在步骤S23中，距离差值-面积修正系数数据库存储有预设的距离差值范围与面积修正系数之间的关联关系。通过面积修正处理，使第二方形框区域图像的修正后面积更接近实际空间中的实际面积，由于患者头部表面主要为弧面，第二方形框区域图像对应的实际面积要比平面下的实际面积S1更大，这样修正过后，使计算得到的移植毛囊存活密度均值、移植毛囊未存活密度均值更加准确，进而使评估结果更接近真实结果 。在本实施例中，所述评估单元的具体处理过程如下：S31：获取各个第二方形框区域图像中有毛发生长的毛囊数量Mn、无毛发生长的毛囊数量Wn；S32：遍历各个第二方形框区域图像，在单个第二方形框区域图像中，将第二方形框区域图像中有毛发生长的毛囊数量Mn减去第一方形框区域图像中既有的有毛发生长的毛囊数量Cn，得到移植毛囊存活数量Z1n，将第二方形框区域图像中无毛发生长的毛囊数量Wn减去第一方形框区域图像中既有的无毛发生长的毛囊数量Dn，得到移植毛囊未存活数量Z2n；S33：计算移植毛囊存活密度均值CHavg，计算公式如下：CHavg=/n，其中，CHavg为本次移植后移植毛囊存活密度均值，Z1n表示第n个第二方形框区域图像中的移植毛囊存活数量，S2n为第n个第二方形框区域图像的修正后面积值；计算移植毛囊未存活密度均值NHavg，计算公式如下：NHavg=/n，其中，NHavg为本次移植后移植毛囊未存活密度均值，Z2n表示第n个第二方形框区域图像中的移植毛囊未存活数量，S2n为第n个第二方形框区域图像的修正后面积值；S34：计算移植毛囊未存活密度均值NHavg与移植毛囊存活密度均值CHavg的比值，计算公式如下：NC=NHavg/CHavg，其中，NC为移植毛囊未存活密度均值NHavg与移植毛囊存活密度均值CHavg的比值，即为本次的植发评估结果值。在本实施例中，在所述步骤S32中，在计算移植毛囊存活数量Z1n时，为方便计算，将植发前后既有的有毛发生长的毛囊减少数量视为零。需要说明的是，在本实施例中，不仅获取移植毛囊存活数量，还结合移植毛囊未存活数量，利用存活密度均值、未存活密度均值两个概念对植发效果进行评估，使评估结果更加准确。在本实施例中，还可以根据得到植发评估结果值NC进行评级，进而得到植发评估结果的评级信息，使植发评估结果更加直观，植发评估结果值NC越大，表示本次植发效果越差，植发评估结果值NC越小，表示表示本次植发效果越好。需要说明的是，第一方形框区域图像、第二方形框区域图像在各图像中的位置和面积是完全相同的，为方便区分，采用上述命名方式。综上所述，上述实施例的基于影像分析的智能化植发评估系统，通过获取移植毛囊存活数量、移植毛囊未存活数量，并对第二方形框区域图像的实际面积进行修正，结合修正后面积对移植毛囊未存活密度均值与移植毛囊存活密度均值的比值进行计算，得到量化的植发评估结果，改变了传统的植发效果评估方式，相对人工判断方式准确性得到提高，不会受到人为主观经验等因素影响。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本发明的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。尽管上面已经示出和描述了本发明的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本发明的限制，本领域的普通技术人员在本发明的范围内可以对上述实施例进行变化、修改、替换和变型。
