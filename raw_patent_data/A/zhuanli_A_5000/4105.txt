标题title
一种基于RR间期空间特征的房颤分类方法、装置及系统
摘要abst
本发明公开了一种基于RR间期空间特征的房颤分类方法、装置及系统，其方法包括：获取固定时长的RR间期序列，对所述RR间期序列进行预处理；对所述预处理后的RR间期序列进行滑窗切割获取RR间期序列对应的多维数据矩阵，对所述多维数据矩阵进行傅里叶变换获取其多维空间相位数据；基于主成分分析法对所述多维空间相位数据进行降维，对降维后的数据进行特征提取，获得特征矩阵；将所述特征矩阵输入至房颤分类模型，获取房颤预测概率；将所述预测概率与预设房颤划分阈值对比，确定房颤预测结果；本方法有效地获取房颤心律与其他类型心律在RR间期空间特征上的差异，有效实现了房颤识别。
权利要求书clms
1.一种基于RR间期空间特征的房颤分类方法，其特征在于，包括：S1：获取固定时长的RR间期序列，对所述RR间期序列进行预处理；S2：对所述预处理后的RR间期序列进行滑窗切割获取所述RR间期序列对应的多维数据矩阵，对所述多维数据矩阵进行傅里叶变换获取其多维空间相位数据；S3：基于主成分分析法对所述多维空间相位数据进行降维，对降维后的数据进行特征提取，获得特征矩阵；S4：将所述特征矩阵输入至房颤分类模型，获取房颤预测概率；将所述预测概率与预设房颤划分阈值对比，确定房颤预测结果。2.根据权利要求1所述的基于RR间期空间特征的房颤分类方法，其特征在于，所述步骤S1具体包括：S11：获取固定时长的RR间期序列；S12：对所述RR间期序列进行时间单位归一化处理；S13：根据预设上下限条件对不符合条件的RR间期序列进行过滤处理。3.根据权利要求1所述的基于RR间期空间特征的房颤分类方法，其特征在于，所述步骤S3具体包括：S31：采用主成分分析法将所述多维空间相位数据压缩至二维空间相位数据；S32：将所述二维空间相位数据在每个维度上使用切割成网格，以切分得到的每个网格的横纵下标为元素组成初始特征矩阵；S33：计算初始特征矩阵中每个元素对应的网格中的落点数的占比，根据所述占比对所述元素进行赋值获得特征矩阵。4.根据权利要求1所述的基于RR间期空间特征的房颤分类方法，其特征在于，所述房颤分类模型以特征矩阵为输入，房颤预测概率为输出；其构建过程具体包括：S41：获取样本数据集，所述样本数据集包括多个固定时长的RR间期序列对应的特征矩阵以及其关联标签；S42：将所述样本数据集划分为训练集和测试集；S43：构建神经网络模型，利用所述训练集通过Adam优化算法和交叉熵损失函数对其进行训练获得房颤分类模型；S44：利用所述测试集确定所述房颤分类模型的分类准确率，根据所述准确率设置房颤划分阈值。5.根据权利要求4所述的基于RR间期空间特征的房颤分类方法，其特征在于，所述获取样本数据集具体包括：S411：获取多个固定时长的RR间期序列样本以及其关联标签，对所述RR间期序列样本进行预处理；S412：对所述预处理后的RR间期序列样本进行滑窗切割获得RR间期序列样本对应的多维数据矩阵样本，对所述多维数据矩阵样本进行傅里叶变换获取其多维空间相位数据样本；S413：基于主成分分析法对所述多维空间相位数据样本进行降维，对降维后的数据样本进行特征提取，获得特征矩阵样本；S414：将所有特征矩阵样本与其关联标签相对应组成样本数据集。6.一种基于RR间期空间特征的房颤分类装置，其特征在于，包括：预处理模块，用于获取固定时长的RR间期序列，对所述RR间期序列进行预处理；空间建模模块，用于对所述预处理后的RR间期序列进行滑窗切割获取RR间期序列对应的多维数据矩阵，对所述多维数据矩阵进行傅里叶变换获取其多维空间相位数据；特征提取模块，用于基于主成分分析法对所述多维空间相位数据进行降维，对降维后的数据进行特征提取，获得特征矩阵；分类模块，用于将所述特征矩阵输入至房颤分类模型，获取房颤预测概率；将所述预测概率与预设房颤划分阈值对比，确定房颤预测结果。7.一种基于RR间期空间特征的房颤分类系统，其特征在于，包括：信号获取装置，用于获取固定时长的RR间期序列；存储器，用于存储程序；处理器，用于接收所述固定时长的RR间期序列，执行所述程序以实现如权利要求1-5任意一项所述的方法。8.一种计算机存储介质，所述存储介质包括存储的程序，其中，处理器执行所述程序以实现权利要求1至5任意一项所述的方法。
说明书desc
技术领域本发明涉及房颤分类技术领域，尤其涉及一种基于RR间期空间特征的房颤分类方法、装置及系统。背景技术房颤是指心房颤动，发病时，心脏节律快且紊乱地纤颤，但是心房没有显著地收缩，导致血液在心房中存储并形成血块。尽管房颤通常不会直接引起死亡，但是绝大多数的脑卒中皆归因于在AF过程中形成的血块；另外房颤也会使得心力衰竭等并发症的风险成倍地增加。在中国，目前已超过1000万的房颤患者，且随着年龄的增长患病率也会升高，在65岁以上人群中有高达3％患病率。随着我国人口老龄化日益加重，国民的房颤患者人数在未来预计将会持续升高，将会加重社会医疗负担。房颤的早期发现及治疗是预防并发症的重要环节，但是多数早期房颤患者是没有明显症状的，导致错过最佳治疗时期。在便携式心电/心率采集设备蓬勃发展的今天，为我们提供实时房颤监测及筛查的条件。在心电图上，房颤的主要特征有以下两点：①RR间期绝对不规整。由窦房结的自主节律形成的心率一般为60至100bpm，RR间期变化平稳；当发生房颤时，心房壁细胞会产生高达350至600bpm的动作电位，此时的心室率不受窦房结控制，RR间期呈现不规则、随机紊乱的特性。②P波消失，会出现一系列快速连续、形态不同、间隔不匀的f波。当f波的振幅大于0.1mV时，可以将其称为粗颤；反之称为细颤。在心电图上粗颤识别较为简单，但是对于细颤其识别是相对困难的，很容易会导致筛查遗漏。而且便携式心电采集设备容易受到各种干扰，导致心电数据带有不同程度噪音，进一步增加了房颤识别难度。目前对于房颤的识别上主要的路线有以下两条：①提取心电图中的P波信息，进行房颤诊断；②以RR间期不规则为特点，对RR间期进行分析及量化。对比两条技术路线，第二条技术路线更有优势；一方面原因是心电图上的P波识别是一项非常困难的任务，P波的特征并不像QRS波那样明显，更加容易受到干扰的影响；另一方面利用RR间期特征可以应用在更加广泛的监护场景中，如除ECG外还可以应用在PPG等可以获取心率的场景中。目前根据RR间期进行定量分析的方法简单，主要方式有时域、频域及非线性分析。但是这些方法亦都受到提出时的分析工具限制，无法充分地将RR间期序列特征进行量化。在非线性分析方法中有一种根据庞加莱图或者洛伦兹图的形状进行直观的定性分析的方法，与时域、频域分析相比有独特之处。但是，散点图的量化分析主要集中在对散点图的分布形状进行数学特征的提取，如拟合到的椭圆参数等。这类量化方式一方面受到数学特征提取方法的限制，另一方面忽略了点在空间分布的密度及相对位置间的关系，导致量化结果代表性不足。发明内容为解决背景技术中存在的技术问题，本发明提出一种基于RR间期空间特征的房颤分类和分类的方法、装置及系统，实现有效地获取房颤心律与其他类型心律在RR间期空间特征上的差异，可以有效识别房颤。本发明提出一种基于RR间期空间特征的房颤分类方法，包括：S1：获取固定时长的RR间期序列，对所述RR间期序列进行预处理；S2：对所述预处理后的RR间期序列进行滑窗切割获得RR间期序列对应的多维数据矩阵，对所述多维数据矩阵进行傅里叶变换获取其多维空间相位数据；S3：基于主成分分析法对所述多维空间相位数据进行降维，对降维后的数据进行特征提取，获得特征矩阵；S4：将所述特征矩阵输入至房颤分类模型，获取房颤预测概率；将所述预测概率与预设房颤划分阈值对比，确定房颤预测结果。优选地，所述步骤S1具体包括：S11：获取固定时长的RR间期序列；S12：对所述RR间期序列进行时间单位归一化处理；S13：根据预设上下限条件对不符合条件的RR间期序列进行过滤处理。优选地，所述步骤S3具体包括：S31：采用主成分分析法将所述多维空间相位数据压缩至二维空间相位数据；S32：将所述二维空间相位数据在每个维度上使用切割成网格，以切分得到的每个网格的横纵下标为元素组成初始特征矩阵；S33：计算初始特征矩阵中每个元素对应的网格中的落点数的占比，根据所述占比对所述元素进行赋值获得特征矩阵。优选地，所述房颤分类模型以特征矩阵为输入，房颤预测概率为输出，其构建过程具体包括：S41：获取样本数据集，所述样本数据集包括多个固定时长的RR间期序列对应的特征矩阵以及其关联标签；S42：将所述样本数据集划分为训练集和测试集；S43：构建神经网络模型，利用所述训练集通过Adam优化算法和交叉熵损失函数对其进行训练获得房颤分类模型；S44：利用所述测试集确定所述房颤分类模型的分类准确率，根据所述准确率设置房颤划分阈值。优选地，所述获取样本数据集具体包括：S411：获取多个固定时长的RR间期序列样本以及其关联标签，对所述RR间期序列样本进行预处理；S412：对所述预处理后的RR间期序列样本进行滑窗切割获得RR间期序列样本对应的多维数据矩阵样本，对所述多维数据矩阵样本进行傅里叶变换获取其多维空间相位数据样本；S413：基于主成分分析法对所述多维空间相位数据样本进行降维，对降维后的数据样本进行特征提取，获得特征矩阵样本；S414：将所有特征矩阵样本与其关联标签相对应组成样本数据集。本发明还提出要一种基于RR间期空间特征的房颤分类装置，包括：预处理模块，用于获取固定时长的RR间期序列，对所述RR间期序列进行预处理；空间建模模块，用于对所述预处理后的RR间期序列进行滑窗切割获得RR间期序列对应的多维数据矩阵，对所述多维数据矩阵进行傅里叶变换获取其多维空间相位数据；特征提取模块，用于基于主成分分析法对所述多维空间相位数据进行降维，对降维后的数据进行特征提取，获得特征矩阵；分类模块，用于将所述特征矩阵输入至房颤分类模型，获取房颤预测概率；将所述预测概率与预设房颤划分阈值对比，确定房颤预测结果。本发明还提出一种基于RR间期空间特征的房颤分类系统，包括：信号获取装置，用于获取固定时长的RR间期序列；存储器，用于存储程序；处理器，用于接收所述固定时长的RR间期序列，执行所述程序以实现上述的方法。本发明还提出一种计算机存储介质，所述存储介质包括存储的程序，其中，处理器执行所述程序以实现上述的方法。本发明的优点在于：本发明中，通过获取固定时间长度内RR间期数据，无需获取考虑P波相关信息，即无需获取除RR间期外的其他数据，可以实现房颤检测的应用场景更加丰富。本发明中，通过多维度空间建模的方式，实现更加全面的衡量多个连续的RR间期之间的关系，从而提升算法准确度；本发明中，通过主成分分析及网格化特征提取的方式，一方面在多维信息损失较小的情况下，有效地降低了空间维度，降低了算法复杂度；另一方面是实现了充分衡量特征点在平面分布上的特性，提升了算法可靠性。附图说明图1为本发明提出的基于RR间期空间特征的房颤分类方法的流程示意图；图2为本发明提出的基于RR间期空间特征的房颤分类装置结构示意图；图3为本发明实施例提出的网格示意图。具体实施方式如图1所示，图1为本发明实施例一种基于RR间期空间特征的房颤分类方法的流程图；参照图1，本发明实施例提出的一种基于RR间期空间特征的房颤分类方法，包括：步骤S1：获取固定时长的RR间期序列，对所述RR间期序列进行预处理；需要说明的是，在步骤S1中，获取固定时长的RR间期序列，经过单位归一化，并设定RR间期的上下限过滤不合理数据。具体地，在本实施例中，步骤S1包括：S11：获取固定时长的RR间期序列；具体地，在本实施例中，获取10s时长的RR间期序列；S12：对所述RR间期序列进行时间单位归一化处理；具体地，在本实施例中，将输入的10s时长的RR间期序列的时间单位统一转换至ms为单位。S13：根据预设上下限条件对不符合条件的RR间期序列进行过滤处理。具体地，在本实施例中，设置RR间期上限为2000ms，下限为200ms，将不符合要求的RR间期剔除，最终得到RR间期序列，记为：；步骤S2：对所述预处理后的RR间期序列进行滑窗切割获得RR间期序列对应的多维数据矩阵，对所述多维数据矩阵进行傅里叶变换获取其多维空间相位数据；具体地，在本实施例中，为了获取多维空间中的相位信息，我们首先对RR间期进行滑窗切割，获取多维空间数据。；其中，表示经过滑窗切割得到的多维空间数据，每一行表示一组数据，整个矩阵表示一条固定时长的RR间期获取到的空间特征；表示滑窗大小；表示滑窗递进步长；，表示滑窗总数；n表示的长度，当时，使用填充至相等；表示对B向下取整。接着对每组多维空间数据进行傅里叶变换，获取对应的多维空间相位信息。为了获取空间相位，我们对中的每行分别进行傅里叶变换。；其中，表示角频率；表示需要进行傅里叶变换的函数。然后计算各频率的初始化相位，获取空间相位信息，将得到的空间相位矩阵记录为：。步骤S3：基于主成分分析法对所述多维空间相位数据进行降维，对降维后的数据进行特征提取，获得特征矩阵；需要说明的是，在步骤S3中，首先使用主成分分析将多维空间坐标相位数据压缩至二维；然后对经过维度压缩的数据在每个维度上使用特定策略进行切割，将二维数据分散到切线形成的网格中；以切分得到的二维网格的横纵下标形成特征矩阵；最后计算特征矩阵中的每个元素对应网格中的落点数占整张图点数的百分比，得到最终的特征矩阵。具体地，在本实施例中，步骤S3包括：S31：采用主成分分析法将所述多维空间相位数据压缩至二维空间相位数据；需要说明的是，主成分分析，是一种统计方法。通过正交变换将一组可能存在相关性的变量转换为一组线性不相关的变量，转换后的这组变量叫主成分。具体地，在本实施例中，使用scikit-learn工具包提供的API进行数据降维，目标维度设置为2，对执行PCA降维，得到特征维度为2的二维特征矩阵：；其中，表示经过PCA降维后的数据；表示滑窗总数。S32：将所述二维空间相位数据在每个维度上使用切割成网格，以切分得到的每个网格的横纵下标为元素组成初始特征矩阵；具体地，在本实施例中，如图3所示，设置相位范围为，生成一个X轴、Y轴坐标范围从-500到500坐标系，然后分别对X轴和Y轴使用125的固定步长进行切割，将坐标系切割为网格状；其中横纵坐标轴分别被划分为8个区域，然后自左下为起始，X轴向右表示增加，Y轴向上表示增加，将64个小格子的下标映射到8×8的初始特征矩阵中，初始特征矩阵记为：；其中，的元素初始值全部是0。S33：计算初始特征矩阵中每个元素对应的网格中的落点数的占比，根据所述占比对所述元素进行赋值获得特征矩阵。具体地，在本实施例中，在经过以上步骤后，已经将网格中的每个小格与特征矩阵的元素关联起来；并且在每个小格中的落点数量也已清楚；接下来计算每个小格中落点数占图中总点数的比例，并将比例值放置在特征矩阵的对应元素的位置上进行赋值，完成特征提取。步骤S4：将所述特征矩阵输入至房颤分类模型，获取房颤预测概率；将所述预测概率与预设房颤划分阈值对比，确定房颤预测结果。需要说明的是，在本实施例中，所述房颤分类模型以特征矩阵为输入，房颤预测概率为输出，其构建过程具体如下：S41：获取样本数据集，所述样本数据集包括多个固定时长的RR间期序列对应的特征矩阵以及其关联标签；需要说明的是，在本实施例中，样本数据集RR间期序列对应的特征矩阵的获取方法与步骤S1-S3所述方法步骤一致，样本数据集中RR间期序列的时长与获取固定时长的RR间期序列的时长一致。具体地，在本实施例中，获取样本数据集具体包括：S411：获取多个固定时长的RR间期序列样本以及其关联标签，对所述RR间期序列样本进行预处理；S412：对所述预处理后的RR间期序列样本进行滑窗切割获得RR间期序列样本对应的多维数据矩阵样本，对所述多维数据矩阵样本进行傅里叶变换获取其多维空间相位数据样本；S413：基于主成分分析法对所述多维空间相位数据样本进行降维，对降维后的数据样本进行特征提取，获得特征矩阵样本；S414：将所有特征矩阵样本与其关联标签相对应组成样本数据集。具体地，在本实施例中，将已知标签的10s时长的RR间期数据经过步骤S411-S414所述步骤，提取特征矩阵；然后将特征矩阵所对应的标签与其一一对应起来构建样本数据集，具体表示如下；；其中，Features表示获取到的全部特征矩阵；N表示固定时长RR间期片段数。；其中，表示标签的one-hot编码，二分类的情况下是包含2个元素的一维数组，第一个元素为是否是非AF，第二个元素表示是否是AF；0表示不是，1表示是；如非房颤，房颤；表示RR间期片段数。其中，Features与Labels中的元素一一对应，即 与 对应，表示数据片段对应的下标。S42：将所述样本数据集划分为训练集和测试集；具体地，在本实施例中，将数据随机打乱，然后按照标签抽取总量的30%作为测试集，另外70%作为训练集；如数据总量为，其中AF占比为，非AF占比为，则随机抽取作为测试集的AF总量为，非AF总量为，余下的数据作为训练集。S43：构建神经网络模型，利用所述训练集通过Adam优化算法和交叉熵损失函数对其进行训练获得房颤分类模型；具体地，在本实施例中，选择ResNet-18作为分类器，通道数为1，特征维度8×8，迭代100次，批大小为200，学习率设置为0.001，优化器选择Adam，使用交叉熵损失函数，进行模型训练并保存训练后的分类模型S43：利用所述测试集确定所述房颤分类模型的分类准确率，根据所述准确率设置房颤划分阈值。具体地，在本实施例中，以分类准确率作为房颤阈值划分标准，以0.05为步长，在0到1上递增，计算以Softmax为分类函数下的测试集上大于等于每个阈值下的准确率，获取这些中最高准确率对应的阈值，记该阈值为Thresh，作为房颤划分阈值。；上述公式表示在数组中，每个元素经过Softmax函数后输出的等长数组，通常作为神经网络的激活函数使用；其中表示数组的第个元素；表示数组的长度。具体地，在本实施例中，加载训练好的分类模型，并将待预测的特征矩阵输入到分类模型中，获取预测结果，经过Softmax函数，获取房颤预测概率，记为probability；判断probability是否大于等于Thresh，如果是则输出是房颤，否则输出不是房颤，最终得到房颤预测结果。如图2所示，本发明实施例还一种基于RR间期空间特征的房颤分类装置，包括：预处理模块，用于获取固定时长的RR间期序列，对所述RR间期序列进行预处理；空间建模模块，用于对所述预处理后的RR间期序列进行滑窗切割获得RR间期序列对应的多维数据矩阵，对所述多维数据矩阵进行傅里叶变换获取其多维空间相位数据；特征提取模块，用于基于主成分分析法对所述多维空间相位数据进行降维，对降维后的数据进行特征提取，获得特征矩阵；分类模块，用于将所述特征矩阵输入至房颤分类模型，获取房颤预测概率；将所述预测概率与预设房颤划分阈值对比，确定房颤预测结果。本发明实施例还提出一种基于RR间期空间特征的房颤分类系统，包括：信号获取装置，用于获取固定时长的RR间期序列；存储器，用于存储程序；处理器，用于接收所述固定时长的RR间期序列，执行所述程序以实现上述方法。本发明实施例还提出一种计算机存储介质，所述存储介质包括存储的程序，其中，处理器执行所述程序以实现上述实施例的方法。本发明中，仅需要获取固定时间长度内RR间期数据，无需获取考虑P波相关信息，即无需获取除RR间期外的其他数据，可以使得房颤检测的应用场景更加丰富；本发明中，通过多维度空间建模的方式，可以更加全面的衡量多个连续的RR间期之间的关系，从而提升算法准确度；本发明中，通过主成分分析及网格化特征提取的方式，一方面可以在多维信息损失较小的情况下，有效地降低空间维度，降低算法复杂度；另一方面可以充分衡量特征点在平面分布上的特性，提升算法可靠性。需要说明的是，上述实施例中程序可以是一种或多种程序设计语言的任意组合来编写用于执行本申请实施例操作的程序代码，所述程序设计语言包括面向对象的程序设计语言，诸如Java、C++等，还包括常规的过程式程序设计语言，诸如C语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、作为一个独立的软件包执行、部分在用户计算设备上部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。本领域技术人员可以清楚地了解到，为描述的方便和简洁，仅以上述各功能模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将装置的内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能。上述描述的装置的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，根据本发明的技术方案及其发明构思加以等同替换或改变，都应涵盖在本发明的保护范围之内。
