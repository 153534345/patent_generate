标题title
一种基于深度树模型的冠状动脉自动解剖标注方法及系统
摘要abst
一种基于深度树模型的冠状动脉自动解剖标注方法及系统，它属于医学图像处理技术领域。本发明解决了现有标注方法并未考虑到不同患者冠脉树拓扑结构的差异性的问题。本发明通过冠状动脉CT造影技术获取CCTA影像，再人工提取CCTA影像中的冠脉树各个分支的中心线，并对不同类型分支的中心线进行标注，构建深度树模型并进行训练，以准确且高效地实现冠状动脉的自动解剖标注。本发明能够根据CCTA检查获得的体数据和冠脉分支中心线生成每个患者对应的冠脉树拓扑结构，能够有效应对不同患者冠脉树拓扑结构的差异，并克服了未收录分支类别无法标注的问题。本发明可以应用于对冠状动脉进行自动解剖标注。
权利要求书clms
1.一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述方法具体包括以下步骤：步骤S1、获取CCTA影像，并对CCTA影像进行筛选，获得筛选后的CCTA影像；步骤S2、提取筛选后的CCTA影像中的冠脉树各个分支的中心线，并对不同类型的分支所属的类别进行标注；步骤S3、对筛选后的CCTA影像的体数据进行预处理，获得预处理后的CCTA体数据；步骤S4、构建深度树模型，以步骤S3预处理后的CCTA体数据以及步骤S2所提取的中心线和标注作为深度树模型的训练数据集，直至迭代次数达到预设的最大迭代次数时停止训练；步骤S5、对待标注的CCTA影像进行分支中心线的提取和体数据的预处理后，基于训练好的深度树模型、预处理后的CCTA体数据以及提取的冠脉分支中心线，完成CCTA影像中冠状动脉的自动解剖标注。2.根据权利要求1所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述对不同类型的分支所属的类别进行标注，使用数字0～11作为类别标签；其中：标签0代表右冠脉，标签1代表左主干，标签2代表前降支，标签3代表回旋支，标签4代表后降支，标签5代表左室后支，标签6代表钝缘支，标签7代表锐缘支，标签8代表动脉圆锥支，标签9代表右室前支，标签10代表对角支，标签11代表其它分支。3.根据权利要求2所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述步骤S3的具体过程为：步骤S31、对CCTA影像进行裁剪，获得裁剪后的CCTA影像；步骤S32、将裁剪后的CCTA影像中各体素的CT值按照由大到小排序，将排在前a％的体素中最小的CT值作为上界，将裁剪后的CCTA影像中各体素的CT值按照由小到大排序，将排在前a％的体素中最大的CT值作为下界；将裁剪后的CCTA影像中各体素的CT值缩放到确定出的上界和下界之间，获得经过缩放后各体素的CT值；步骤S33、计算经过缩放后全部体素的CT值的平均值和方差；步骤S34、对于任意一个体素，将该体素经过缩放后的CT值与平均值做差，再将做差结果除以方差得到该体素预处理后的CT值；同理，分别得到裁剪后的CCTA影像中每个体素预处理后的CT值。4.根据权利要求3所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述步骤S4中，对步骤S3预处理后的CCTA体数据以及步骤S2所提取的中心线进行处理，提取出冠脉段的图像特征和位置特征；再将提取出的冠脉段图像特征和位置特征进行拼接，将拼接结果输入深度树模型，利用拼接结果和标签对深度树模型进行训练；所述冠脉段的图像特征和位置特征的提取流程为：步骤S41、对于步骤S2中提取出的冠脉树各个分支的中心线，若在当前分支上不存在与其它分支的交汇点，则将当前分支作为一个冠脉段，若在当前分支上存在与其它分支的交汇点，则利用当前分支的起点、各交汇点和终点将当前分支分割成若干个冠脉段；步骤S42、分别对每个冠脉段进行图像特征和位置特征的提取步骤S421、对于任意一个冠脉段，沿该冠脉段的中心线每间隔5个坐标点选取出一个坐标点作为选择点坐标，将预处理后的CCTA体数据中与选择点坐标对应的体素作为中心体素，以中心体素作为三维体素块的中心点截取出25×25×25的体素块；步骤S422、将步骤S421中截取出的每个体素块分别通过3D CNN网络模块，提取出每个体素块的图像特征；将各个体素块的图像特征进行拼接后，将拼接结果通过特征映射模块，得到该冠脉段的图像特征；步骤S423、对该冠脉段中心线进行等间距采样，通过采样获得50个三维坐标点；对该冠脉段中心线进行9等分，得到8个等分点，获得起点、终点和等分点中的任意两个点分别连接产生的45个方向向量的法向量；选择等间距采样对该冠脉段中心线采样5个三维坐标点；步骤S424、将步骤S423采样得到的三维坐标点坐标和得到的法向量进行拼接，将拼接结果通过特征映射模块，得到该冠脉段的位置特征；步骤S425、重复步骤S421至步骤S424的过程，得到每个冠脉段的图像特征以及位置特征。5.根据权利要求4所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述3D CNN网络模块的结构为：从输入端开始，3D CNN网络模块依次包括第一卷积层、第一最大池化层、第二卷积层、第二最大池化层、第三卷积层以及第三最大池化层。6.根据权利要求5所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述特征映射模块由多个全连接层组成。7.根据权利要求6所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述深度树模型包括深度树生成器和分支归属判别器。8.根据权利要求7所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述步骤S5中，基于训练好的深度树模型、预处理后的CCTA体数据以及提取的冠脉分支中心线，完成CCTA影像中冠状动脉的自动解剖标注；其具体过程为：步骤S51、基于预处理后的CCTA体数据以及提取的冠脉分支中心线获得待标注CCTA影像中每个冠脉段的图像特征和位置特征，将图像特征和位置特征进行拼接，将拼接结果作为对应冠脉段的特征向量；步骤S52、将任意一个冠脉段的特征向量输入训练好的深度树模型，特征向量经过深度树的根节点的全连接层完成映射，再将全连接层的映射结果作为根节点的GRU模块的输入；步骤S53、将GRU模块的输出作为MLP模块的输入，利用MLP模块对该冠脉段所属的冠脉分支类别进行分类，若该冠脉段的类别所对应的节点存在，直接执行步骤S54；否则该冠脉段的类别所对应的节点不存在，则将MLP模块的输出作为Softmax分类器的输入，继续利用Softmax分类器判断该冠脉段的类别，若Softmax分类器判断出的类别所对应的节点存在，则执行步骤S54，若Softmax分类器判断出的类别所对应的节点不存在，则利用深度树生成器生成该冠脉段的类别所对应的节点，并执行步骤S54；步骤S54、将该冠脉段的特征向量和MLP模块的输出共同输入到分支归属判别器后，分支归属判别器对该冠脉段所属的类别进行三分类，三个分类结果分别为：该冠脉段属于步骤S53中分类结果对应的节点的左子节点、右子节点或属于步骤S53中分类结果对应的节点；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，且左子节点存在，则直接执行步骤S55，否则分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，且左子节点不存在，则利用深度树生成器生成该左子节点，并执行步骤S55；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，且右子节点存在，则直接执行步骤S55，否则分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，且右子节点不存在，则利用深度树生成器生成该右子节点，并执行步骤S55；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点，则执行步骤S56；步骤S55、若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，则将该冠脉段的特征向量依次经过深度树的根节点、步骤S53中分类结果对应的节点以及步骤S53中分类结果对应的节点的左子节点；其中，该冠脉段的特征向量经过深度树根节点的全连接层和GRU模块后，将该冠脉段的特征向量和根节点的GRU模块的输出共同作为步骤S53中分类结果对应的节点的输入；再将该冠脉段的特征向量与步骤S53中分类结果对应节点的GRU模块的输出共同作为步骤S53中分类结果对应节点的左子节点的输入，并利用步骤S53中分类结果对应节点的左子节点的输出来执行步骤S53和步骤S54，直至分支归属判别器的输出结果为该冠脉段在步骤S53中分类结果对应的节点，再执行步骤S56；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，则将该冠脉段的特征向量依次经过深度树的根节点、步骤S53中分类结果对应的节点以及步骤S53中分类结果对应的节点的右子节点；其中，该冠脉段的特征向量经过深度树根节点的全连接层和GRU模块后，将该冠脉段的特征向量和根节点的GRU模块的输出共同作为步骤S53中分类结果对应的节点的输入；再将该冠脉段的特征向量与步骤S53中分类结果对应节点的GRU模块的输出共同作为步骤S53中分类结果对应节点的右子节点的输入，并利用步骤S53中分类结果对应节点的右子节点的输出来执行步骤S53和步骤S54，直至分支归属判别器的输出结果为该冠脉段在步骤S53中分类结果对应的节点，再执行步骤S56；步骤S56、输入下一个冠脉段的特征向量，重复执行步骤S52至步骤S55，直至待标注的CCTA影像中包含的全部冠脉段处理结束后，得到深度树，根据得到的深度树构建冠脉树的拓扑结构，并对冠脉树的各冠脉段类别完成解剖标注。9.根据权利要求8所述的一种基于深度树模型的冠状动脉自动解剖标注方法，其特征在于，所述深度树生成器的损失函数LDTG为：其中，N为深度树生成节点的数量，C为深度树节点类别的数量，为样本i中生成的深度树上的节点j对应冠脉分支类别c的one-hot编码，为深度树生成器预测样本i中生成的深度树上的节点j对应冠脉分支类别c的概率；分支归属判别器的损失函数LBAD为：其中，M为输入深度树模型的冠脉段的数量，为样本i中冠脉段j′对应冠脉分支类别c的one-hot编码，为分支归属判别器预测样本i中冠脉段j′对应冠脉分支类别c的概率。10.一种基于深度树模型的冠状动脉自动解剖标注系统，其特征在于，所述系统用于执行权利要求1至权利要求9之一所述的一种基于深度树模型的冠状动脉自动解剖标注方法。
说明书desc
技术领域本发明属于医学图像处理技术领域，具体涉及一种基于深度树模型的冠状动脉自动解剖标注方法及系统。背景技术冠脉粥样硬化性心脏病，亦称为冠心病，是心血管疾病中患病率最高的疾病。其实由于冠脉的主要供血分支发生粥样硬化病变而造成的血管狭窄或堵塞，从而导致具有心肌缺血、心绞痛等症状的心脏病，严重时可危及人的生命。冠状动脉CT血管造影是一种用于诊断和预测冠状动脉疾病的非侵入性影像技术。CCTA检查通过静脉注射适当造影剂，而后使用多排螺旋CT扫描胸腔，对冠状动脉的病变情况进行成像。目前该影像技术主要应用于测量冠脉钙化斑块负荷、监测冠脉管壁周围组织病变情况以及冠心病相关手术的术后随访等用途。在临床应用中，医务人员需要通过一系列的CCTA影像后处理才能获得诊断报告。冠心病计算机辅助诊断系统能够自动化地完成上述功能，有效地减轻医务人员的工作压力，并降低发生误诊漏诊的可能性。而冠状动脉自动解剖标注任务是辅助诊断系统自动化检测冠脉狭窄及斑块前不可或缺的程序，但是现有的冠状动脉自动解剖标注方法并未考虑到不同患者冠脉树拓扑结构的差异性，进而影响到后续辅助诊断系统检测的准确率。发明内容本发明的目的是为解决现有标注方法并未考虑到不同患者冠脉树拓扑结构的差异性的问题，而提出了一种基于深度树模型的冠状动脉自动解剖标注方法及系统。本发明为解决上述技术问题所采取的技术方案是：基于本发明的一个方面，一种基于深度树模型的冠状动脉自动解剖标注方法，所述方法具体包括以下步骤：步骤S1、获取CCTA影像，并对CCTA影像进行筛选，获得筛选后的CCTA影像；步骤S2、提取筛选后的CCTA影像中的冠脉树各个分支的中心线，并对不同类型的分支所属的类别进行标注；步骤S3、对筛选后的CCTA影像的体数据进行预处理，获得预处理后的CCTA体数据；步骤S4、构建深度树模型，以步骤S3预处理后的CCTA体数据以及步骤S2所提取的中心线和标注作为深度树模型的训练数据集，直至迭代次数达到预设的最大迭代次数时停止训练；步骤S5、对待标注的CCTA影像进行分支中心线的提取和体数据的预处理后，基于训练好的深度树模型、预处理后的CCTA体数据以及提取的冠脉分支中心线，完成CCTA影像中冠状动脉的自动解剖标注。进一步地，所述CCTA影像是通过冠状动脉CT造影技术获取的。进一步地，所述对不同类型的分支所属的类别进行标注，使用数字0～11作为类别标签；其中：标签0代表右冠脉，标签1代表左主干，标签2代表前降支，标签3代表回旋支，标签4代表后降支，标签5代表左室后支，标签6代表钝缘支，标签7代表锐缘支，标签8代表动脉圆锥支，标签9代表右室前支，标签10代表对角支，标签11代表其它分支。进一步地，所述步骤S3的具体过程为：步骤S31、对CCTA影像进行裁剪，获得裁剪后的CCTA影像；步骤S32、将裁剪后的CCTA影像中各体素的CT值按照由大到小排序，将排在前a％的体素中最小的CT值作为上界，将裁剪后的CCTA影像中各体素的CT值按照由小到大排序，将排在前a％的体素中最大的CT值作为下界；将裁剪后的CCTA影像中各体素的CT值缩放到确定出的上界和下界之间，获得经过缩放后各体素的CT值；步骤S33、计算经过缩放后全部体素的CT值的平均值和方差；步骤S34、对于任意一个体素，将该体素经过缩放后的CT值与平均值做差，再将做差结果除以方差得到该体素预处理后的CT值；同理，分别得到裁剪后的CCTA影像中每个体素预处理后的CT值。进一步地，所述步骤S4中，对步骤S3预处理后的CCTA体数据以及步骤S2所提取的中心线进行处理，提取出冠脉段的图像特征和位置特征；再将提取出的冠脉段图像特征和位置特征进行拼接，将拼接结果输入深度树模型，利用拼接结果和标签对深度树模型进行训练；所述冠脉段的图像特征和位置特征的提取流程为：步骤S41、对于步骤S2中提取出的冠脉树各个分支的中心线，若在当前分支上不存在与其它分支的交汇点，则将当前分支作为一个冠脉段，若在当前分支上存在与其它分支的交汇点，则利用当前分支的起点、各交汇点和终点将当前分支分割成若干个冠脉段；步骤S42、分别对每个冠脉段进行图像特征和位置特征的提取步骤S421、对于任意一个冠脉段，沿该冠脉段的中心线每间隔5个坐标点选取出一个坐标点作为选择点坐标，将预处理后的CCTA体数据中与选择点坐标对应的体素作为中心体素，以中心体素作为三维体素块的中心点截取出25×25×25的体素块；步骤S422、将步骤S421中截取出的每个体素块分别通过3D CNN网络模块，提取出每个体素块的图像特征；将各个体素块的图像特征进行拼接后，将拼接结果通过特征映射模块，得到该冠脉段的图像特征；步骤S423、对该冠脉段中心线进行等间距采样，通过采样获得50个三维坐标点；对该冠脉段中心线进行9等分，得到8个等分点，获得起点、终点和等分点中的任意两个点分别连接产生的45个方向向量的法向量；选择等间距采样对该冠脉段中心线采样5个三维坐标点；步骤S424、将步骤S423采样得到的三维坐标点坐标和得到的法向量进行拼接，将拼接结果通过特征映射模块，得到该冠脉段的位置特征；步骤S425、重复步骤S421至步骤S424的过程，得到每个冠脉段的图像特征以及位置特征。进一步地，所述3D CNN网络模块的结构为：从输入端开始，3D CNN网络模块依次包括第一卷积层、第一最大池化层、第二卷积层、第二最大池化层、第三卷积层以及第三最大池化层。进一步地，所述特征映射模块由多个全连接层组成。进一步地，所述深度树模型包括深度树生成器和分支归属判别器。进一步地，所述步骤S5中，基于训练好的深度树模型、预处理后的CCTA体数据以及提取的冠脉分支中心线，完成CCTA影像中冠状动脉的自动解剖标注；其具体过程为：步骤S51、基于预处理后的CCTA体数据以及提取的冠脉分支中心线获得待标注CCTA影像中每个冠脉段的图像特征和位置特征，将图像特征和位置特征进行拼接，将拼接结果作为对应冠脉段的特征向量；步骤S52、将任意一个冠脉段的特征向量输入训练好的深度树模型，特征向量经过深度树的根节点的全连接层完成映射，再将全连接层的映射结果作为根节点的GRU模块的输入；步骤S53、将GRU模块的输出作为MLP模块的输入，利用MLP模块对该冠脉段所属的冠脉分支类别进行分类，若该冠脉段的类别所对应的节点存在，直接执行步骤S54；否则该冠脉段的类别所对应的节点不存在，则将MLP模块的输出作为Softmax分类器的输入，继续利用Softmax分类器判断该冠脉段的类别，若Softmax分类器判断出的类别所对应的节点存在，则执行步骤S54，若Softmax分类器判断出的类别所对应的节点不存在，则利用深度树生成器生成该冠脉段的类别所对应的节点，并执行步骤S54；步骤S54、分支归属判别器包括多层全连接层和一个softmax分类器，将该冠脉段的特征向量和MLP模块的输出共同输入到分支归属判别器后，分支归属判别器对该冠脉段所属的类别进行三分类，三个分类结果分别为：该冠脉段属于步骤S53中分类结果对应的节点的左子节点、右子节点或属于步骤S53中分类结果对应的节点；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，且左子节点存在，则直接执行步骤S55，否则分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，且左子节点不存在，则利用深度树生成器生成该左子节点，并执行步骤S55；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，且右子节点存在，则直接执行步骤S55，否则分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，且右子节点不存在，则利用深度树生成器生成该右子节点，并执行步骤S55；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点，则执行步骤S56；步骤S55、若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，则将该冠脉段的特征向量依次经过深度树的根节点、步骤S53中分类结果对应的节点以及步骤S53中分类结果对应的节点的左子节点；其中，该冠脉段的特征向量经过深度树根节点的全连接层和GRU模块后，将该冠脉段的特征向量和根节点的GRU模块的输出共同作为步骤S53中分类结果对应的节点的输入；再将该冠脉段的特征向量与步骤S53中分类结果对应节点的GRU模块的输出共同作为步骤S53中分类结果对应节点的左子节点的输入，并利用步骤S53中分类结果对应节点的左子节点的输出来执行步骤S53和步骤S54，直至分支归属判别器的输出结果为该冠脉段在步骤S53中分类结果对应的节点，再执行步骤S56；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，则将该冠脉段的特征向量依次经过深度树的根节点、步骤S53中分类结果对应的节点以及步骤S53中分类结果对应的节点的右子节点；其中，该冠脉段的特征向量经过深度树根节点的全连接层和GRU模块后，将该冠脉段的特征向量和根节点的GRU模块的输出共同作为步骤S53中分类结果对应的节点的输入；再将该冠脉段的特征向量与步骤S53中分类结果对应节点的GRU模块的输出共同作为步骤S53中分类结果对应节点的右子节点的输入，并利用步骤S53中分类结果对应节点的右子节点的输出来执行步骤S53和步骤S54，直至分支归属判别器的输出结果为该冠脉段在步骤S53中分类结果对应的节点，再执行步骤S56；步骤S56、输入下一个冠脉段的特征向量，重复执行步骤S52至步骤S55，直至待标注的CCTA影像中包含的全部冠脉段处理结束后，得到深度树，根据得到的深度树构建冠脉树的拓扑结构，并对冠脉树的各冠脉段类别完成解剖标注。更进一步地，所述深度树生成器的损失函数LDTG为：其中，N为深度树生成节点的数量，C为深度树节点类别的数量，为样本i中生成的深度树上的节点j对应冠脉分支类别c的one-hot编码，为深度树生成器预测样本i中生成的深度树上的节点j对应冠脉分支类别c的概率；分支归属判别器的损失函数LBAD为：其中，M为输入深度树模型的冠脉段的数量，为样本i中冠脉段j′对应冠脉分支类别c的one-hot编码，为分支归属判别器预测样本i中冠脉段j′对应冠脉分支类别c的概率。基于本发明的另一个方面，一种基于深度树模型的冠状动脉自动解剖标注系统，所述系统用于执行一种基于深度树模型的冠状动脉自动解剖标注方法。本发明的有益效果是：本发明方法通过冠状动脉CT造影技术获取CCTA影像，再人工提取CCTA影像中的冠脉树各个分支的中心线，并对不同类型分支的中心线进行标注，构建深度树模型并进行训练，以准确且高效地实现冠状动脉的自动解剖标注。本发明能够根据CCTA检查获得的体数据和冠脉分支中心线生成每个患者对应的冠脉树拓扑结构，能够有效应对不同患者冠脉树拓扑结构的差异，并克服了未收录分支类别无法标注的问题。附图说明图1为本发明自动解剖标记的冠脉分支类别及其拓扑关系的示意图；图2为本发明完成冠脉自动解剖标记任务的流程图；图3为本发明中深度树模型的原理图。具体实施方式具体实施方式一、结合图2说明本实施方式。本实施方式所述的一种基于深度树模型的冠状动脉自动解剖标注方法，所述方法具体包括以下步骤：步骤S1、获取CCTA影像，并对CCTA影像进行筛选，获得筛选后的CCTA影像；步骤S2、人工提取筛选后的CCTA影像中的冠脉树各个分支的中心线，并对不同类型的分支所属的类别进行标注；步骤S3、对筛选后的CCTA影像的体数据进行预处理，获得预处理后的CCTA体数据；步骤S4、构建深度树模型，以步骤S3预处理后的CCTA体数据以及步骤S2所提取的中心线和标注作为深度树模型的训练数据集，直至迭代次数达到预设的最大迭代次数时停止训练；数据集由多组CCTA体数据及其对应的冠脉分支中心线组成的独立的数据构成；在进行冠脉分支的中心线标注时，可以根据收集数据集的规模适当调整所分类别的数量。如CCTA体数据中提取的冠脉中心线数量过少，可适当减少二级或三级分支的类别以更好的训练网络，例如右室前支、右室前支等；而若体数据中提取的冠脉中心线数量较多，则使用本发明中的类别标注方法可能造成待命名分支过多的情况，因此可以适当添加标注类别的数量，例如添加左室后侧支、左房回旋支及窦房结支等新的冠脉分支类别。步骤S5、对待标注的CCTA影像进行分支中心线的提取和体数据的预处理后，基于训练好的深度树模型、预处理后的CCTA体数据以及提取的冠脉分支中心线，完成CCTA影像中冠状动脉的自动解剖标注。具体实施方式二：本实施方式与具体实施方式一不同的是，所述CCTA影像是通过冠状动脉CT造影技术获取的。筛选的目的是对CCTA影像数据进行检查，以确保所有的影像数据有效。其它步骤及参数与具体实施方式一相同。具体实施方式三：本实施方式与具体实施方式一或二不同的是，所述对不同类型的分支所属的类别进行标注，使用数字0～11作为类别标签；其中：标签0代表右冠脉，标签1代表左主干，标签2代表前降支，标签3代表回旋支，标签4代表后降支，标签5代表左室后支，标签6代表钝缘支，标签7代表锐缘支，标签8代表动脉圆锥支，标签9代表右室前支，标签10代表对角支，标签11代表其它分支。冠脉树分支的拓扑结构如图1所示，始于主动脉窦的第一对分支为右冠脉；左冠脉根部为左主干；左主干发出的分支为前降支和回旋支；右冠脉临近末端部分发出的分支为后降支；左冠和右冠的冠脉末端部分称为左室后支；左冠脉的回旋支与右冠脉沿心脏的左缘和右缘发出的分支分别为钝缘支和锐缘支；右冠和前降支沿右心室前壁上部发出的分支为动脉圆锥支；右冠和前降支沿右室前壁中部发出的分支为右室前支；前降支在与回旋支夹角间发出的分支为对角支。其中由于患者存在个体差异，冠脉树主干分支上的二级或三级分支存在与否因人而异，若分支无法被上述命名涵盖则归类为待命名分支。其它步骤及参数与具体实施方式一或二相同。具体实施方式四：本实施方式与具体实施方式一至三之一不同的是，所述步骤S3的具体过程为：步骤S31、对CCTA影像进行裁剪，获得裁剪后的CCTA影像；通过裁剪提高属于冠脉的体素在整个体数据中的占比；步骤S32、将裁剪后的CCTA影像中各体素的CT值按照由大到小排序，将排在前a％的体素中最小的CT值作为上界，将裁剪后的CCTA影像中各体素的CT值按照由小到大排序，将排在前a％的体素中最大的CT值作为下界；将裁剪后的CCTA影像中各体素的CT值缩放到确定出的上界和下界之间，获得经过缩放后各体素的CT值；步骤S33、计算经过缩放后全部体素的CT值的平均值和方差；步骤S34、对于任意一个体素，将该体素经过缩放后的CT值与平均值做差，再将做差结果除以方差得到该体素预处理后的CT值；同理，分别得到裁剪后的CCTA影像中每个体素预处理后的CT值。本实施方式中，a的取值为5，通过整体缩放CCTA影像的CT值，以初步筛选去除对模型训练可能产生负面影响的噪声；对体数据进行整体减均值除方差的标准化操作，以消除CCTA影像之间的差异，提高方法对于不同CCTA影像数据之间的差异的适应性，使模型更好的训练，有效增强了模型的鲁棒性。还可以根据具体图像质量和实际需求，对CCTA体数据进行直方图均衡化变换，即利用图像直方图对对比度进行调整，对CCTA体数据进行空间变换，即使用平移、拉伸等仿射变换的方式添加数据以达到数据扩增的目的。其它步骤及参数与具体实施方式一至三之一相同。具体实施方式五：本实施方式与具体实施方式一至四之一不同的是，所述步骤S4中，对步骤S3预处理后的CCTA体数据以及步骤S2所提取的中心线进行处理，提取出冠脉段的图像特征和位置特征；再将提取出的冠脉段图像特征和位置特征进行拼接，将拼接结果输入深度树模型，利用拼接结果和标签对深度树模型进行训练；所述冠脉段的图像特征和位置特征的提取流程为：步骤S41、对于步骤S2中提取出的冠脉树各个分支的中心线，若在当前分支上不存在与其它分支的交汇点，则将当前分支作为一个冠脉段，若在当前分支上存在与其它分支的交汇点，则利用当前分支的起点、各交汇点和终点将当前分支分割成若干个冠脉段；分割后的每个冠脉段的两端点为：起点和交汇点、交汇点和交汇点、交汇点和终点，将起点、交汇点和终点分别作为端点，每个冠脉段上包括且仅包括两个端点。步骤S42、分别对每个冠脉段进行图像特征和位置特征的提取步骤S421、对于任意一个冠脉段，沿该冠脉段的中心线每间隔5个坐标点选取出一个坐标点作为选择点坐标，将预处理后的CCTA体数据中与选择点坐标对应的体素作为中心体素，以中心体素作为三维体素块的中心点从预处理后的CCTA体数据中截取出25×25×25的体素块；步骤S422、将步骤S421中截取出的每个体素块分别通过3D CNN网络模块，提取出每个体素块的图像特征；将各个体素块的图像特征进行拼接后，将拼接结果通过特征映射模块，得到该冠脉段的图像特征；步骤S423、对该冠脉段中心线进行等间距采样，通过采样获得50个三维坐标点；对该冠脉段中心线进行9等分，得到8个等分点，获得起点、终点和等分点中的任意两个点分别连接产生的45个方向向量的法向量；对该冠脉段中心线进行9等分后，得到包括起点、终点和等分点在内的10个点，将其中的任意两点相连接后均可以得到一个方向向量，遍历完所有点后，共得到45个方向向量，再分别获得每个方向向量的法向量；选择等间距采样对该冠脉段中心线采样5个三维坐标点，以强化冠脉段的位置信息；步骤S424、将步骤S423采样得到的三维坐标点坐标和得到的法向量进行拼接，将拼接结果通过特征映射模块，得到该冠脉段的位置特征；步骤S425、重复步骤S421至步骤S424的过程，得到每个冠脉段的图像特征以及位置特征。对于存在交汇点的分支，由前到后对该分支所包括的各个冠脉段进行处理。其它步骤及参数与具体实施方式一至四之一相同。通过特征提取，使深度树模型能够同时结合位置信息与图像信息，更加准确的生成节点。具体实施方式六：本实施方式与具体实施方式一至五之一不同的是，所述3D CNN网络模块的结构为：从输入端开始，3D CNN网络模块依次包括第一卷积层、第一最大池化层、第二卷积层、第二最大池化层、第三卷积层以及第三最大池化层。本实施方式的3D CNN网络模块顺序连接了3个卷积核大小为3×3×3的卷积层，且在每个卷积层后均连接了2×2×2的最大池化层。通过3D CNN网络模块对体素块提取图像特征后，得到的图像特征图将被扁平化为1个一维向量。当前冠脉段的全部体素块对应的一维向量拼接后将通过特征映射模块以得到冠脉段的图像信息。通过顺序连接的CNN网络提取冠脉中心线坐标附近的CCTA影像的不同尺度的图像信息，可以使深度树模型能够得到更加丰富的多尺度图像特征。其它步骤及参数与具体实施方式一至五之一相同。具体实施方式七：本实施方式与具体实施方式一至六之一不同的是，所述特征映射模块由多个全连接层组成。多个全连接层是指大于等于2个全连接层，特征映射模块的设计目的是平衡深度树模型对图像信息与位置信息的分析，以提高标注的准确率。通过特征映射模块统一位置特征与图像特征的shape，以便能够相加后作为深度树模型的输入。其它步骤及参数与具体实施方式一至六之一相同。具体实施方式八：本实施方式与具体实施方式一至七之一不同的是，所述深度树模型包括深度树生成器和分支归属判别器。其它步骤及参数与具体实施方式一至七之一相同。具体实施方式九：结合图3说明本实施方式。本实施方式与具体实施方式一至八之一不同的是，所述步骤S5中，基于训练好的深度树模型、预处理后的CCTA体数据以及提取的冠脉分支中心线，完成CCTA影像中冠状动脉的自动解剖标注；其具体过程为：步骤S51、基于预处理后的CCTA体数据以及提取的冠脉分支中心线获得待标注CCTA影像中每个冠脉段的图像特征和位置特征，将图像特征和位置特征进行拼接，将拼接结果作为对应冠脉段的特征向量；步骤S52、将任意一个冠脉段的特征向量输入训练好的深度树模型，特征向量经过深度树的根节点的全连接层完成映射，再将全连接层的映射结果作为根节点的GRU模块的输入；步骤S53、将GRU模块的输出作为MLP模块的输入，利用MLP模块对该冠脉段所属的冠脉分支类别进行分类，若该冠脉段的类别所对应的节点存在，直接执行步骤S54；否则该冠脉段的类别所对应的节点不存在，则将MLP模块的输出作为Softmax分类器的输入，继续利用Softmax分类器判断该冠脉段的类别，若Softmax分类器判断出的类别所对应的节点存在，则执行步骤S54，若Softmax分类器判断出的类别所对应的节点不存在，则利用深度树生成器生成该冠脉段的类别所对应的节点，并执行步骤S54；步骤S54、分支归属判别器包括多层全连接层和一个softmax分类器，将该冠脉段的特征向量和MLP模块的输出共同输入到分支归属判别器后，分支归属判别器对该冠脉段所属的类别进行三分类，三个分类结果分别为：该冠脉段属于步骤S53中分类结果对应的节点的左子节点、右子节点或属于步骤S53中分类结果对应的节点；其中，若步骤S53中该冠脉段的类别所对应的节点不存在子节点且步骤S54判断该冠脉段属于当前节点的子节点，则直接生成当前节点的左子节点；若当前节点存在一个子节点且步骤S54判断该冠脉段不属于已经存在的子节点，则生成当前节点的右子节点；若当前节点的左右子节点均存在，则直接进行类别判定，决定该冠脉段特征向量输入左子节点或右子节点。若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，且左子节点存在，则直接执行步骤S55，否则分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，且左子节点不存在，则利用深度树生成器生成该左子节点，并执行步骤S55；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，且右子节点存在，则直接执行步骤S55，否则分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，且右子节点不存在，则利用深度树生成器生成该右子节点，并执行步骤S55；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点，则执行步骤S56；步骤S55、若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的左子节点，则将该冠脉段的特征向量依次经过深度树的根节点、步骤S53中分类结果对应的节点以及步骤S53中分类结果对应的节点的左子节点；其中，该冠脉段的特征向量经过深度树根节点的全连接层和GRU模块后，将该冠脉段的特征向量和根节点的GRU模块的输出共同作为步骤S53中分类结果对应的节点的输入；再将该冠脉段的特征向量与步骤S53中分类结果对应节点的GRU模块的输出共同作为步骤S53中分类结果对应节点的左子节点的输入，并利用步骤S53中分类结果对应节点的左子节点的输出来执行步骤S53和步骤S54，直至分支归属判别器的输出结果为该冠脉段在步骤S53中分类结果对应的节点，再执行步骤S56；若分支归属判别器的输出结果为该冠脉段属于步骤S53中分类结果对应的节点的右子节点，则将该冠脉段的特征向量依次经过深度树的根节点、步骤S53中分类结果对应的节点以及步骤S53中分类结果对应的节点的右子节点；其中，该冠脉段的特征向量经过深度树根节点的全连接层和GRU模块后，将该冠脉段的特征向量和根节点的GRU模块的输出共同作为步骤S53中分类结果对应的节点的输入；再将该冠脉段的特征向量与步骤S53中分类结果对应节点的GRU模块的输出共同作为步骤S53中分类结果对应节点的右子节点的输入，并利用步骤S53中分类结果对应节点的右子节点的输出来执行步骤S53和步骤S54，直至分支归属判别器的输出结果为该冠脉段在步骤S53中分类结果对应的节点，再执行步骤S56；步骤S56、输入下一个冠脉段的特征向量，重复执行步骤S52至步骤S55，直至待标注的CCTA影像中包含的全部冠脉段处理结束后，得到深度树，根据得到的深度树构建冠脉树的拓扑结构，并对冠脉树的各冠脉段类别完成解剖标注。每个节点均包括全连接层和GRU模块，可以使用LSTM、Transformer等其他序列到序列的网络模块替换GRU模块，还可以根据网络模型的训练情况以及损失函数的下降趋势适当调节GRU模块中GRU单元的数量。当前冠脉段的特征向量从深度树的根节点向下面的子节点输入，上一节点的GRU模块的输出与当前冠脉段的特征向量共同作为下一节点的全连接层的输入。将当前冠脉段的特征向量输入深度树的根节点向下传输，直至MLP模块或Softmax分类器的分类结果与分支归属判别器的分类结果一致时，得到当前冠脉段所属的类别。其它步骤及参数与具体实施方式一至八之一相同。具体实施方式十：本实施方式与具体实施方式一至九之一不同的是，所述深度树生成器的损失函数LDTG为：其中，N为深度树生成节点的数量，C为深度树节点类别的数量，为样本i中生成的深度树上的节点j对应冠脉分支类别c的one-hot编码，为深度树生成器预测样本i中生成的深度树上的节点j对应冠脉分支类别c的概率；分支归属判别器的损失函数LBAD为：其中，M为输入深度树模型的冠脉段的数量，为样本i中冠脉段j′对应冠脉分支类别c的one-hot编码，为分支归属判别器预测样本i中冠脉段j′对应冠脉分支类别c的概率。深度树生成器的主要目的是使分支生成的正确率最大化，因此深度树生成器需要使生成的预测节点和真实节点之间的差异最小化。分支归属判别器的主要功能为控制当前特征向量在深度树中的分支归属，也直接地控制了冠脉段的类别判定，因此其损失函数将计算各冠脉段预测类别与真实类别之间的差异。在进行网络模型的训练时，可以根据训练的具体情况对损失函数进行适当的调整，如下式所示：LTOTAL＝α·LDTG+·LBAD其中，LTOTAL为深度树模型的损失函数，α控制损失函数中LDTG和LBAD的影响占比，其取值范围为。其它步骤及参数与具体实施方式一至九之一相同。具体实施方式十一、本实施方式所述的一种基于深度树模型的冠状动脉自动解剖标注系统，所述系统用于执行一种基于深度树模型的冠状动脉自动解剖标注方法。本发明的上述算例仅为详细地说明本发明的计算模型和计算流程，而并非是对本发明的实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动，这里无法对所有的实施方式予以穷举，凡是属于本发明的技术方案所引伸出的显而易见的变化或变动仍处于本发明的保护范围之列。
