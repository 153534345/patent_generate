标题title
一种脊柱侧弯图像检测模型的生成方法
摘要abst
本发明申请涉及一种脊柱侧弯图像检测模型的生成方法，包括⑴向计算机设备输入待检测背部图像，确定脊柱投映于体表的凹陷区域轮廓，得到脊柱轮廓曲线特征点；⑵将正常脊柱样例图像进行扭曲处理，将扭曲处理后的样例图像投映于待检测脊柱图像脊柱体表凹陷区进行模拟；⑶识别模拟图像各椎体上下终板，用多项式函数近似代替上下终板直线，得到拟合函数。⑷基于拟合函数测量脊柱参数；⑸应用支持向量机，基于脊柱参数，根据Lenke分型原则进行脊柱侧弯检测，整理数据集并进行训练，获得已训练的脊柱侧弯图像检测模型。本发明通过正常脊柱图像模拟待检测背部图像，识别各椎体上下终板，进行直线拟合，并应用支持向量机，形成脊柱侧弯图像检测模型并用以脊柱侧弯检测。
权利要求书clms
1.一种脊柱侧弯图像检测模型的生成方法，其特征是：所述方法包括以下步骤：⑴向计算机设备输入待检测背部图像，识别脊柱体表凹陷区，确定脊柱投映于体表的凹陷区域轮廓，得到脊柱轮廓曲线特征点，去除周围背景干扰，保留主要的脊柱轮廓部分，获得待检测脊柱图像；⑵将正常脊柱样例图像进行扭曲处理，将扭曲处理后的样例图像投映于待检测脊柱图像脊柱体表凹陷区进行模拟，使扭曲处理后的图像脊柱轮廓与待检测脊柱图像脊柱体表凹陷区一致，扭曲处理后的图像脊柱中轴能够拟合背部图像脊柱轮廓曲线特征点，扭曲处理后的图像为模拟图像；⑶识别模拟图像各椎体上下终板，用多项式函数近似代替上下终板直线，通过多项式展开式得到拟合直线，得到拟合函数。⑷基于拟合函数测量脊柱参数；⑸应用支持向量机，基于脊柱参数，根据Lenke分型原则进行脊柱侧弯检测，整理数据集并进行训练，获得已训练的脊柱侧弯图像检测模型。2.根据权利要求1所述的一种脊柱侧弯图像检测模型的生成方法，其特征是：步骤⑴包括：对输入的待检测背部图像进行灰度化处理，得到灰度值图像，对灰度值图像作预处理，预处理方法包括灰度值均衡化处理、阈值处理和降噪处理。3.根据权利要求2所述的一种脊柱侧弯图像检测模型的生成方法，其特征是：所述步骤⑴还包括：将预处理后的待检测灰度值图像进行通道分离，获取红色通道灰度值图像信息，并将红色通道灰度值图像信息其转化为二值图像；将灰度值图像与二值图像进行点乘，获得除去干扰的灰度值图像，去除周围背景干扰，保留主要的脊柱轮廓部分；根据除去干扰的灰度值图像，求取梯度与灰度像素特征点，确定脊柱投映于体表的凹陷区域轮廓，得到脊柱轮廓曲线特征点。4.根据权利要求1到3任意一项所述的一种脊柱侧弯图像检测模型的生成方法，其特征是：所述背部图像为标准图像，所述标准图像可以通过使用数码摄像机采用以下步骤获得：⑴摄像机设于被采集者正后方且与地面垂直，摄像机距离被采集者0.5-0.8米，照明光源与摄像机位置一致，光线均匀照射在人体裸露的背部；⑵被采集人自然站立、双臂自然下垂、目视前方，所述数码摄像机采集人体背部从颈椎最上端到腰椎最下端的区域图像信息，获得标准图像。5.根据权利要求1到3任意一项所述的一种脊柱侧弯图像检测模型的生成方法，其特征是：所述步骤⑶包括：通过最小外包络矩形局部逼近椎体的边界，寻找出每一个脊椎椎体的最小外包络矩形，再基于最小外包络矩形的框架，对矩形框架像素点进行遍历，设定最边极限阈值以确定矩形四个顶点以及矩形上边和下边的中点，以矩形上边两个顶点与上边的中点作为椎体上终板的边界点，以矩形下边两个顶点与下边的中点作为椎体下终板的边界点，确定所有脊柱椎体的上下终板；通过将椎体上终板和下终板的中点和两个顶点的点集提取出来，得到每个点的坐标，采用多项式函数近似代替上终板和下终板直线，通过多项式展开式得到拟合直线，用分别不同的存储器将上下终板的拟合直线分别保存。6.根据权利要求5所述的一种脊柱侧弯图像检测模型的生成方法，其特征是：所述步骤⑷包括：分别用k1,、k2表示椎体上终板和下终板的拟合直线l1、l2的斜率；两直线的夹角为θ，用两直线的夹角公式可得求得两直线夹角；用夹角公式并对存储在不同存储器中的两组拟合直线进行两两比较，得到椎体上终板和下终板两拟合直线间的最大夹角，椎体上终板和下终板两拟合直线间的最大夹角为Cobb角度。7.根据权利要求6所述的一种脊柱侧弯图像检测模型的生成方法，其特征是：所述步骤⑸包括：在得到的每一个脊椎椎体的最小外包络矩形的基础上，计算得到每一个脊椎椎体的中心点坐标，并将其坐标按顺序存储；通过寻找合适的拟合曲线，对中心点进行拟合，提取拟合曲线的系数，作为支持向量机的输入特征；将每一类Lenke型打上标签，以1-6数字表示Lenk1-6型，并将系数特征作为支持向量机的特征值；整理数据集并进行训练，获得已训练的脊柱侧弯图像检测模型。8.根据权利要求7所述的一种脊柱侧弯图像检测模型的生成方法，其特征是：所述拟合曲线为快速傅里叶拟合函数，函数公式为：
说明书desc
技术领域本发明涉及一种检测技术领域，尤其是一种脊柱侧弯图像检测模型的生成方法。背景技术青少年特发性脊柱侧弯是是青少年骨骼肌肉系统中较为常见的畸形之一，往往伴有脊柱的三维弯曲、椎体和胸廓变形、形体不对称、本体感受器功能障碍、运动失去平衡等病理现象，严重的甚至还会阻碍患者肺脏、胸廓的生长发育，影响通气、换气等诸多功能，严重影响青少年的身心健康。该疾病不仅影响患儿的身体外观，对患儿生活质量及心理方面也产生极大的影响。在开展脊柱侧弯检测时，由于运用脊柱侧凸尺来测量躯干的旋转角度、Adams向前弯腰试验等方法会存在人工检测的工作量大，程序繁琐，效率低下的问题，也会因人工疲劳造成错判和误判。同时脊柱Cobb角的传统检测方法是医务人员利用铅笔盒量角器在X线片上手工测量。脊柱侧弯大致呈现出三个弯，医务人员通过经验找出最大倾斜读书的端椎。在这过程中所采用的X光线，具有一定量的放射性，对人体健康存在一定影响；且因手工操作，所以存在一定的误差，观察者内和观察者间的可靠性较差。此外医务人员根据经验检测，诊断存在着主观性。发明内容本发明所要解决的技术问题是提供一种检查时对人体无损伤、检测效率高，误检率低的基于人工智能-数字图像识别技术的脊柱侧弯检测模型的生成方法。为了实现以上目的，本发明提供了一种脊柱侧弯图像检测模型的生成方法，包括以下步骤：⑴向计算机设备输入待检测背部图像，识别脊柱体表凹陷区，确定脊柱投映于体表的凹陷区域轮廓，得到脊柱轮廓曲线特征点；⑵将正常脊柱样例图像进行扭曲处理，将扭曲处理后的图像投映于脊柱体表凹陷区进行模拟，使扭曲处理后的图像脊柱轮廓与背部图像脊柱体表凹陷区一致，扭曲处理后的图像脊柱中轴能够拟合背部图像脊柱轮廓曲线特征点，扭曲处理后的图像为模拟图像；⑶识别模拟图像各椎体上下终板，用多项式函数近似代替上下终板直线，通过多项式展开式得到拟合直线，得到拟合函数；⑷基于拟合函数测量脊柱参数；⑸应用支持向量机，基于脊柱参数，根据Lenke分型原则进行脊柱侧弯检测，整理数据集并进行训练，获得已训练的脊柱侧弯图像检测模型。进一步的，上述步骤⑴包括：对输入的待检测背部图像进行灰度化处理，得到灰度值图像，对灰度值图像作预处理，预处理包括灰度值均衡化处理、阈值处理和降噪处理。进一步的，上述步骤⑴还包括：将预处理后的灰度值图像进行通道分离，获取红色通道灰度值图像信息，并将红色通道灰度值图像信息其转化为二值图像；将灰度值图像与二值图像进行点乘，获得除去干扰的灰度值图像，去除周围背景干扰，保留主要的脊柱轮廓部分；根据除去干扰的灰度值图像，求取梯度与灰度像素特征点，确定脊柱投映于体表的凹陷区域轮廓，得到脊柱轮廓曲线特征点。进一步的，待检测背部图像为标准图像，所述标准图像可以通过使用数码摄像机采用以下步骤获得：①摄像机设于被采集者正后方且与地面垂直，摄像机距离被采集者0.5-0.8米，照明光源与摄像机位置一致，光线均匀照射在人体裸露的背部；②被采集人自然站立、双臂自然下垂、目视前方，所述数码摄像机采集人体背部从颈椎最上端到腰椎最下端的区域图像信息，获得标准图像。进一步的，所述步骤⑶包括：通过最小外包络矩形局部逼近椎体的边界，寻找出每一个脊椎椎体的最小外包络矩形，再基于最小外包络矩形的框架，对矩形框架像素点进行遍历，设定最边极限阈值以确定矩形四个顶点以及矩形上边和下边的中点，以矩形上边两个顶点与上边的中点作为椎体上椎板的边界点，以矩形下边两个顶点与下边的中点作为椎体下椎板的边界点，确定所有脊柱椎体的上下终板；通过将椎体上终板和下终板的中点和两个顶点集提取出来，得到每个点的坐标，采用多项式函数近似代替上终板和下终板直线，通过多项式展开式得到拟合直线，用分别不同的存储器将上下终板的拟合直线分别保存。进一步的，所述步骤⑷包括：分别用k1,、k2表示椎体上下终板的拟合直线l1、l2的斜率；两直线的夹角为θ，用两直线的夹角公式可得求得两直线夹角；用夹角公式并对存储在不同存储器中的两组拟合直线进行两两比较，得到椎体上下终板两拟合直线间的最大夹角，椎体上下终板两拟合直线间的最大夹角为Cobb角度。进一步的，所述步骤⑸包括：在得到的每一个脊椎椎体的最小外包络矩形的基础上，计算得到每一个脊椎椎体的中心点坐标，并将其坐标按顺序存储；通过寻找合适的拟合曲线，对中心点进行拟合，提取拟合曲线的系数，作为支持向量机的输入特征；将每一类Lenke型打上标签，以1-6数字表示Lenk1-6型，并将系数特征作为支持向量机的特征值；整理数据集并进行训练，获得已训练的脊柱侧弯图像检测模型。优选的，上述拟合曲线为快速傅里叶拟合函数，函数公式为：本发明的有益效果是：⑴本发明利用计算机设备分割输入的待检测背部图像，识别脊柱体表凹陷区，确定脊柱投映于体表的凹陷区域轮廓，得到脊柱轮廓曲线特征点；将正常脊柱样例图像进行扭曲处理，扭曲处理后的图像为模拟图像，将模拟图像投映于脊柱体表凹陷区使模拟图像脊柱轮廓与待检测背部图像脊柱体表凹陷区一致，模拟图像脊柱中轴能够拟合待检测背部图像脊柱轮廓曲线特征点，识别模拟图像各椎体上下终板，进行直线拟合，得到拟合函数，生成脊柱侧弯图像检测模型。通过该模型和拟合函数可以计算求得Cobb角度，当Cobb角度大于某个值时，一般为7度，则可以判定为脊柱侧弯。⑵本发明基于图像识别及AI技术，实现通过输入待检测的背部图像，即可生成用于检测的脊柱侧弯图像检测模型，通过该模型可以为脊柱外科医生在脊柱侧弯的临床诊断与治疗中提供一套客观的检测方法；还可与网络技术相结合，为脊柱侧弯患者提供在线检测服务。附图说明图1为本发明一种脊柱侧弯图像检测模型的生成方法的流程图。具体实施方式下面结合附图和实施例，对本发明进一步详细说明。其中相同的零部件用相同的附图标记表示。需要说明的是，下面描述中使用的词语“前”、“后”、“左”、“右”、“上”和“下”指的是附图中的方向，词语“底面”和“顶面”、“内”和“外”分别指的是朝向或远离特定部件几何中心的方向。参照图1所示，本发明的一种脊柱侧弯图像检测模型的生成方法，包括：⑴向计算机设备输入待检测背部图像，识别脊柱体表凹陷区，确定脊柱投映于体表的凹陷区域轮廓，得到脊柱轮廓曲线特征点，去除周围背景干扰，保留主要的脊柱轮廓部分，得到待检测脊柱图像；步骤⑴可由以下分步骤组成：A.向计算机设备中输入裸露的背部图像，为了提高准确率，输入的背部图像为标准图像，标准图像通过以下方法取得：布置普通数码摄像机与照明光源环境，摄像机位于被采集者正后方且与地面垂直，距离被采集者0.5-0.8米，照明光源与摄像机位置一致，使光线均匀照射在人体背部；采用摄像机获取人体体表裸露背部图像时，被采集人自然站立、双臂自然下垂、目视前方，采集包含从颈椎最上端到腰椎最下端的区域的图像；B.对输入的背部图片进行预处理：读取输入的体表裸露背部图像，获取分辨率信息以及每一像素点的RGB信息；对背部图像进行灰度化处理，对转化后的灰度值图像作灰度值均衡化处理、阈值处理和降噪处理等预处理。C.识别脊柱体表凹陷区，分割图像，获得待检测脊柱图像：将预处理后的灰度值图像进行通道分离，获取红色通道灰度值图像信息，将其转化为二值图像；将灰度值图像与二值图像进行点乘，获得除去干扰的灰度值图像，即获取感兴趣区域，去除周围背景干扰，保留主要的脊柱轮廓部分；根据除去干扰的灰度值图像，求取梯度与灰度像素特征点，得到脊柱轮廓曲线特征点，识别体表背部平面起伏，确定脊柱投映于体表的凹陷区域轮廓，获得待检测脊柱图像。⑵扭曲处理正常脊柱样例图像，将扭曲处理后的图像投映于待检测脊柱图像脊柱体表凹陷区进行模拟，使扭曲处理后的图像脊柱轮廓与待检测脊柱图像脊柱体表凹陷区一致，扭曲处理后的图像脊柱中轴能够拟合背部图像脊柱轮廓曲线特征点，扭曲处理后的图像为模拟图像；⑶识别模拟图像各椎体上下终板，进行直线拟合，得到拟合函数，由于椎体的形状类似于矩形，因此通过最小外包络矩形局部逼近椎体的边界，寻找出每一个脊椎椎体的最小外包络矩形，再基于最小外包络矩形的框架，对矩形的框架像素点进行遍历，设定最边极限阈值以确定矩形四个顶点以及矩形上边和下边的中点，以矩形上边两个顶点与上边的中点作为椎体上椎板的边界点，以矩形下边两个顶点与下边的中点作为椎体下椎板的边界点，确定所有脊柱椎体的上下终板，通过将椎体上终板和下终板的中点和两个顶点集提取出来，得到每个点的坐标，采用多项式函数近似代替上终板和下终板直线，通过多项式展开式得到拟合直线，用分别不同的存储器将上下终板的拟合直线分别保存。⑷基于拟合函数测量脊柱参数，设一椎体上下终板的拟合直线l1、l2的斜率存在，分别表示为k1,、k2；两直线的夹角为θ，由两直线的夹角公式可得通过上述公式便可求得所需的两直线夹角，通过夹角公式并对两存储器进行两两比较，则可以测量Cobb角度。⑸应用支持向量机，基于脊柱参数，根据Lenke分型原则进行脊柱侧弯检测，整理数据集并进行训练，获得已训练的脊柱侧弯图像检测模型,具体包括：在得到的每一个脊椎椎体的最小外包络矩形的基础上，计算得到每一个脊椎椎体的中心点坐标，并将其坐标按一定顺序存储；通过寻找合适的拟合曲线，对每一个脊椎椎体中心点进行拟合，此处采用的拟合函数为快速傅里叶拟合函数，其函数公式如下所示：其中aj，bj为待拟合参数；完成上述工作后，提取拟合曲线的系数，作为支持向量机的输入特征；将每一类Lenke型打上标签，以1-6数字表示Lenk1-6型，并将系数特征作为支持向量机的特征值；整理不同年龄、不同性别和不同程度脊柱侧弯的病人的背部图案数据集并用大量的不同程度脊柱侧弯的背部图案进行训练，获得已训练的一种脊柱侧弯图像检测模型。在上述实施例中，还可以建立正常脊柱样例图像库，收集不同年龄、不同性别的正常人的脊柱图像，范围包括颈椎最上端到腰椎最下端的区域的脊柱图像。上述实施例的实施基于计算机视觉库Opencv 4.2版本，编写语言为Python，版本为3.8，编译器为Pycharm，编译平台为Visual Stdio 2019，实验平台基于Windows 10系统，使用的显卡为Geforce 940MX。上述实施例的正常脊柱样例基于本研究单位建立的的正常脊柱样例图像库作为训练模型进行训练，其训练结果以应用于病体脊柱拟合。以上所述仅是本发明的优选实施方式，本发明的保护范围并不仅局限于上述实施例，凡属于本发明思路下的技术方案均属于本发明的保护范围。应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理前提下的若干改进和润饰，这些改进和润饰也应视为本发明的保护范围。
