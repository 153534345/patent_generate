标题title
基于交叉可视图的睡眠心脑信号关联性分析方法
摘要abst
本发明所述的基于交叉可视图的睡眠心脑信号关联性分析方法，首先构建心电和脑电生理序列的前向和后向原始可视度序列，并通过元素替换的方式构建心脑信号之间的前向和后向交叉可视度序列，然后计算原始‑交叉可视度概率分布的差异性衡量心脑之间的因果关联性。基于交叉可视图的睡眠心脑信号关联性分析方法有效地解决了根据时间序列可视状态的特征关系衡量生理序列关联性的问题。
权利要求书clms
1.基于交叉可视图的睡眠心脑信号关联性分析方法，其特征在于，所述方法的步骤为：S1、构建睡眠心电信号X＝{x1,x2,…,xt,…,xL}的前向原始可视序列Xof、交叉可视度序列Xcf及睡眠脑电信号Y＝{y1,y2,…,yt,…,yL}的前向原始可视度序列Yof、交叉可视度序列Ycf，即S2、构建睡眠心电信号X的后向原始可视度序列Xob、交叉可视度序列Xcb及睡眠脑电信号Y的后向原始可视度序列Yob和交叉可视度序列Ycb，即S3、计算睡眠心电信号X的原始-交叉可视度概率差异XOC；S4、计算睡眠脑电信号Y的原始-交叉可视度概率差异YOC；S5、根据S3及S4得到的结果计算睡眠心电和脑电的交叉可视因果XYVG。2.根据权利要求1所述的基于交叉可视图的睡眠心脑信号关联性分析方法，其特征在于，步骤S1具体为：S1-1、构建睡眠心电和睡眠脑电序列元素的前向原始可视度序列Xof和Yof；S1-2、将睡眠心电信号X中的元素xt替换为睡眠脑电Y中的对应元素yt，t取值范围从0至L，替换元素的前向可视度为xcft，并由此构建睡眠脑电信号Y对睡眠心电信号X的前向交叉可视度序列Xcf；S1-3、将睡眠脑电信号Y中的元素yt替换为睡眠心电信号X中的对应元素xt，t取值范围从0至L，替换元素的前向可视度为ycft，并由此构建睡眠心电信号X对睡眠脑电Y的前向交叉可视度序列Ycf。3.根据权利要求1所述的基于交叉可视图的睡眠心脑信号关联性分析方法，其特征在于，步骤S2具体为：S2-1、构建睡眠心电和脑电序列元素的后向原始可视度序列Xob和Yob；S2-2、将睡眠心电信号X中的元素xt替换为睡眠脑电信号Y中的对应元素yt，t取值范围从0至L，替换元素的后向可视度为xcbt，并由此构建睡眠脑电信号Y对睡眠心电信号X的后向交叉可视度序列Xcb；S2-3、将睡眠脑电信号Y中的元素yt替换为睡眠心电信号X中的对应元素xt，t取值范围从0至L，替换元素的后向可视度为ycbt，并由此构建心电信号X到脑电Y的后向交叉可视度序列Ycb。4.根据权利要求1所述的基于交叉可视图的睡眠心脑信号关联性分析方法，其特征在于，步骤S3具体为：S3-1、计算睡眠心电信号的可视度概率分布，Xofp和Xcfp分别为睡眠心电信号的前向原始可视度概率和交叉可视度概率，Xobp和Xcbp为睡眠心电信号的后向原始可视度概率和交叉可视度概率；其中，pxoft＝xoft/∑txoft为睡眠心电信号前向原始可视序列Xof中元素xoft在该序列中的概率，pxcft＝xcft/∑txcft为睡眠心电信号前向交叉可视度序列Xcf中元素xcft在该序列中的概率，pxobt＝xobt/∑txobt睡眠心电信号后向原始可视序列Xob中元素xobt在该序列中的概率，pxcbt＝xcbt/∑txcbt为睡眠心电信号后向交叉可视度序列Xcb中元素xcbt在该序列中的概率；S3-2、采用基于减法的Ys计算睡眠心电信号的前向原始-交叉可视度概率差异性XfOC和后向原始-交叉可视度概率差异性XbOC；在概率差异的计算中，需要保证Ys的非负性，在Ys＜pxoft,pxcft＞中，pxoft＞pxcft，否则将Ys＜pxoft,pxcft＞互换为Ys＜pxcft,pxoft＞；S3-3、计算睡眠心电的原始-交叉可视度概率差异XOC＝/2。5.根据权利要求1所述的基于交叉可视图的睡眠心脑信号关联性分析方法，其特征在于，步骤S4具体为：S4-1、计算睡眠脑电信号的可视度概率分布，Yofp和Ycfp分别为睡眠脑电信号的前向原始和交叉可视度概率，Yobp和Ycbp为睡眠脑电信号的后向原始和交叉可视度概率；其中，pyoft＝yoft/∑tyoft为睡眠脑电信号前向原始可视序列Xof中元素xoft在该序列中的概率，pycft＝ycft/∑tycft为睡眠脑电信号前向交叉可视度序列Ycf中元素ycft在该序列中的概率，pyobt＝yobt/∑tyobt为睡眠脑电信号后向原始可视序列Yob中元素yobt在该序列中的概率，pycbt＝ycbt/∑tycbt为睡眠脑电信号后向交叉可视度序列Ycb中元素ycbt在该序列中的概率；S4-2、采用基于减法的Ys计算睡眠脑电信号的前向原始-交叉可视度概率差异性YfOC和后向原始-交叉可视度概率差异性YbOC；在概率差异的计算中，需要保证Ys的非负性，在Ys＜pyoft,pycft＞中，pyoft＞pycft，否则将Ys＜pyoft,pycft＞互换为Ys＜pycft,pyoft＞；S4-3、计算睡眠脑电的原始-交叉可视度概率差异YOC＝/2。6.根据权利要求1所述的基于交叉可视图的睡眠心脑信号关联性分析方法，其特征在于，步骤S5具体为：S5-1、判断睡眠心电和脑电的交叉可视因果关系；如果XOC＞YOC，则睡眠脑电信号对心电的影响更大，脑电信号为驱动因子，心电信号为响应因子；反之，则说明心电信号为驱动因子，脑电信号为响应因子；S5-3、计算睡眠心电和脑电的交叉可视因果XYVG＝|XOC-YOC|。
说明书desc
技术领域本发明属于时间序列分析和因果关联性分析技术领域，尤其涉及基于交叉可视图的睡眠心脑信号关联性分析方法。背景技术心脏和大脑在睡眠中存在复杂的相互作用，确定心脑生理活动之间的关联性是睡眠系统研究的重要内容，在因果耦合等理论分析中也具有重要意义。为了确定心脑信号之间的关系，学者从不同角度提出多种分析的方法，如Granger因果、转移熵、相同步等。Granger因果是基于线性自回归模型的，要求系统满足相应的线性关系；转移熵是基于信息论的参数，序列的概率估计使其对控制参数有着较高的协调性要求；相同步方法则需要根据频域特征的关系确定信号的耦合关系；因此，当前关联性分析方法大多存在一定的局限性。在信号分析中，可视图方法通过元素之间可视性确定时间序列对应元素的连接性，其充分利用了序列元素之间的幅度关系，在提取生理序列的结构化特征中起到了重要的作用。可视图分析方法是对单一时间序列元素可视关系的分析方法，即根据序列元素和其他元素大小关系确定可视性，进而分析序列可视关系的统计特征。遗憾的是，当前可视图分析方法通过单一时间序列进行构建，只能分析单一序列的结构化特征，而无法用于构建不同序列之间的可视关系。这导致可视图方法不能用于不同时间序列之间的关联性分析，因此尚无基于可视图的心脑信号因果关联性分析方法。鉴于睡眠心脑关联性研究的重要以及可视图构建的特点，如何利用睡眠心脑时间序列之间的可视关系提取两者关联性特征是一个亟需解决的问题，其对于睡眠状态分析以及心脑之间的关联性分析都具有重要理论研究和现实应用意义。发明内容为了有效地解决利用可视图方法衡量睡眠心脑信号之间关联性的问题，本发明提出一种基于信号交叉可视图出入度差异性的睡眠心脑信号关联性分析方法，首先构建心电和脑电生理序列的前向和后向原始可视度序列，并通过元素替换的方式构建心脑信号之间的前向和后向交叉可视度序列，然后计算原始-交叉可视度概率分布的差异性衡量心脑之间的因果关联性，有效地解决了根据时间序列可视状态的特征关系衡量生理序列关联性的问题。本发明所述的基于交叉可视图的睡眠心脑信号关联性分析方法，其步骤为：S1、构建睡眠心电信号X＝{x1,x2,…,xt,…,xL}的前向原始可视序列Xof、前向交叉可视度序列Xcf及睡眠脑电信号Y＝{y1,y2,…,yt,…,yL}的前向原始可视度序列Yof和前向交叉可视度序列Ycf，即S2、构建睡眠心电信号X的后向原始可视度序列Xob、后向交叉可视度序列Xcb及睡眠脑电信号Y的后向原始可视度序列Yob和后向交叉可视度序列Ycb，即S3、计算睡眠心电信号X的原始-交叉可视度概率差异XOC；S4、计算睡眠脑电信号Y的原始-交叉可视度概率差异YOC；S5、根据S3及S4得到的结果计算睡眠心电和脑电的交叉可视因果XYVG。进一步的，步骤S1具体为：S1-1、构建睡眠心电和睡眠脑电序列元素的前向原始可视度序列Xof和Yof；S1-2、将睡眠心电信号X中的元素xt替换为睡眠脑电Y中的对应元素yt，t取值范围从0至L，替换元素的前向可视度为xcft，并由此构建睡眠脑电信号Y对睡眠心电信号X的前向交叉可视度序列Xcf；S1-3、将睡眠脑电信号Y中的元素yt替换为睡眠心电信号X的对应元素xt，t取值范围从0至L，替换元素的前向可视度为ycft，并由此构建睡眠心电信号X对睡眠脑电Y的前向交叉可视度序列Ycf。进一步的，步骤S2具体为：S2-1、构建睡眠心电和脑电序列元素的后向原始可视度序列Xob和Yob；S2-2、将睡眠心电信号X中的元素xt替换为睡眠脑电信号Y中的对应元素yt，t取值范围从0至L，替换元素的后向可视度为xcbt，并由此构建睡眠脑电信号Y对睡眠心电信号X的后向交叉可视度序列Xcb；S2-3、将睡眠脑电信号Y中的元素yt替换为睡眠心电信号X中的对应元素xt，t取值范围从0至L，替换元素的后向可视度为ycbt，并由此构建心电信号X到脑电Y的后向交叉可视度序列Ycb。进一步的，步骤S3具体为：S3-1、计算睡眠心电信号的可视度概率分布，Xofp和Xcfp分别为睡眠心电信号的前向原始可视度概率和交叉可视度概率，Xobp和Xcbp为睡眠心电信号的后向原始可视度概率和交叉可视度概率；其中，pxoft＝xoft/∑txoft为睡眠心电信号前向原始可视序列Xof中元素xoft在该序列中的概率，pxcft＝xcft/∑txcft为睡眠心电信号前向交叉可视度序列Xcf中元素xcft在该序列中的概率，pxobt＝xobt/∑txobt睡眠心电信号后向原始可视序列Xob中元素xobt在该序列中的概率，pxcbt＝xcbt/∑txcbt为睡眠心电信号后向交叉可视度序列Xcb中元素xcbt在该序列中的概率；S3-2、采用基于减法的Ys计算睡眠心电信号的前向原始-交叉可视度概率差异性XfOC和后向原始-交叉可视度概率差异性XbOC；在概率差异的计算中，需要保证Ys的非负性，例如在Ys＜pxoft，pxcft＞中，pxoft＞pxcft，否则将Ys/2。进一步的，步骤S4具体为：S4-1、计算睡眠脑电信号的可视度概率分布，Yofp和Ycfp分别为睡眠脑电信号的前向原始和交叉可视度概率，Yobp和Ycbp为睡眠脑电信号的后向原始和交叉可视度概率：其中，pyoft＝yoft/∑tyoft为睡眠脑电信号前向原始可视序列Xof中元素xoft在该序列中的概率，pycft＝ycft/∑tycft为睡眠脑电信号前向交叉可视度序列Ycf中元素ycft在该序列中的概率，pyobt＝yobt/∑tyobt为睡眠脑电信号后向原始可视序列Yob中元素yobt在该序列中的概率，pycbt＝ycbt/∑tycbt为睡眠脑电信号后向交叉可视度序列Ycb中元素ycbt在该序列中的概率；S4-2、采用基于减法的Ys计算睡眠脑电信号的前向原始-交叉可视度概率差异性YfOC和后向原始-交叉可视度概率差异性YbOC；在概率差异的计算中，需要保证Ys的非负性，例如在Ys＜pyoft′pycft＞中，pyoft＞pycft，否则将Ys/2。进一步的，步骤S5具体为：S5-1、判断睡眠心电和脑电的交叉可视因果关系；如果XOC＞YOC，则睡眠脑电信号对心电的影响更大，脑电信号为驱动因子，心电信号为响应因子；反之，则说明心电信号为驱动因子，脑电信号为响应因子；S5-2、计算睡眠心电和脑电的交叉可视因果XYVG＝|XOC-YOC|。本发明所述的有益效果为：本发明为了解决利用可视图方法衡量睡眠心脑信号关联性的问题，通过信号原始和交叉可视度概率分布差异性衡量心脑信号之间的相互影响；本发明首先构建心电和脑电的原始可视图序列，并通过对应元素互换的方式构建心脑信号的交叉可视图序列，然后通过计算睡眠心电和脑电信号原始-交叉可视度概率差异性衡量两者之间的相互影响程度，并由此确定睡眠心脑之间的关联性和因果关系；考虑到可视度为0的情况，本发明采用基于减法的Ys比较原始-交叉可视度概率差异性；在睡眠心脑的关联性分析中，基于可视图的方法有效地表征了心脏和大脑之间的关联性，并在对清醒和睡眠状态的识别中有良好的效果。附图说明图1是本发明基于交叉可视图的睡眠心脑信号关联性分析方法的流程图；图2是信号元素前向和后向可视度连接示意图；图3是清醒和睡眠心脑信号采集的样本示意图；图4是清醒和睡眠状态下心脑可视图的同步指标。具体实施方式为了使本发明的内容更容易被清楚地理解，下面根据具体实施例并结合附图，对本发明作进一步详细的说明。如图1所示，本发明的基于交叉可视图的睡眠心脑信号关联性分析方法，包括以下步骤：S1、给定长度为L的睡眠心电信号X＝{x1，x2，...，xt，...，xL}和睡眠脑电信号Y＝所示：S1具体如下：S1-1、构建睡眠心电和脑电序列元素的前向原始可视度序列Xof和Yof；前向可视度确定规则为：对于心电序列元素xt，其前向可视度为xoft＝a-t，则其和前向元素xa之间所有的元素xi都满足式同理，计算脑电序列元素yt的前向可视度为yoft。以图2元素x6为例，其前向可视度为3；S1-2、将睡眠心电信号X中的元素xt替换为睡眠脑电序列Y的对应元素yt，t取值范围从0至L，替换元素的前向可视度为xcft，并由此构建脑电信号Y对心电X的前向交叉可视度序列Xcf；S1-3、将脑电信号Y中的元素yt替换为脑电序列X的对应元素xt，t取值范围从0至L，替换元素的前向可视度为ycft，并由此构建心电信号X对脑电Y的前向交叉可视度序列Ycf。S2、构建睡眠心电X的后向原始可视度序列Xob和交叉可视度序列Xcb，脑电Y的后向原始可视度序列Yob和交叉可视度序列Ycb，如式所示：S2-1、构建睡眠心电和脑电序列元素的后向原始可视度序列Xob和Yob；后向可视度确定规则为：对于心电序列元素xt，其后向可视度为xobt＝b-t，则其和后向元素xb之间所有的元素xi都满足式同理，计算脑电序列元素yt的后向可视度为yobt。以图2元素x6为例，其后向可视度为4；S2-2、将心电信号X中的元素xt替换为脑电序列Y的对应元素yt，t取值范围从0至L，替换元素的后向可视度为xcbt，并由此构建脑电信号Y对心电X的后向交叉可视度序列Xcb；S2-3、将脑电信号Y中的元素yt替换为脑电序列X的对应元素xt，t取值范围从0至L，替换元素的后向可视度为ycbt，并由此构建心电信号X到脑电Y的后向交叉可视度序列Ycb。S3、计算睡眠心电信号X的原始-交叉可视度概率差异XOC；S3-1、计算睡眠心电信号的可视度概率分布，如式所示，其中Xofp和Xcfp分别为心电的前向原始和交叉可视度概率，Xobp和Xcbp为心电的后向原始和交叉可视度概率：其中，pxoft＝xoft/∑txoft为睡眠心电信号前向原始可视序列Xof中元素xoft在该序列中的概率，pxcft＝xcft/∑txcft为睡眠心电信号前向交叉可视度序列Xcf中元素xcft在该序列中的概率，pxobt＝xobt/∑txobt睡眠心电信号后向原始可视序列Xob中元素xobt在该序列中的概率，pxcbt＝xcbt/∑txcbt为睡眠心电信号后向交叉可视度序列Xcb中元素xcbt在该序列中的概率；S3-2、采用基于减法的Ys计算睡眠心电信号的前向原始-交叉可视度概率差异性XfOC和后向原始-交叉可视度概率差异性XboC；在概率差异的计算中，需要保证Ys的非负性，例如在Ys＜pxoft，pxcft＞中，pxoft＞pxcft，否则将Ys＜pxoft，pxcft＞互换为Ys＜pxcft，pxoft＞；S3-3、计算睡眠心电的原始-交叉可视度概率差异XOC＝/2。S4、计算睡眠脑电信号Y的原始-交叉可视度概率差异YOC；S4-1、计算睡眠脑电信号的可视度概率分布，如式所示，Yofp和Ycfp分别为睡眠脑电信号的前向原始和交叉可视度概率，Yobp和Ycbp为睡眠脑电信号的后向原始和交叉可视度概率；其中，pyoft＝yoft/∑tyoft为睡眠脑电信号前向原始可视序列Xof中元素xoft在该序列中的概率，pycft＝ycft/∑tycft为睡眠脑电信号前向交叉可视度序列Ycf中元素ycft在该序列中的概率，pyobt＝yobt/∑tyobt为睡眠脑电信号后向原始可视序列Yob中元素yobt在该序列中的概率，pycbt＝ycbt/∑tycbt为睡眠脑电信号后向交叉可视度序列Ycb中元素ycbt在该序列中的概率；S4-2、采用基于减法的Ys计算睡眠脑电信号的前向原始-交叉可视度概率差异性YfOC和后向原始-交叉可视度概率差异性YbOC；在概率差异的计算中，需要保证Ys的非负性，例如在Ys＜pyoft′pycft＞中，pyoft＞pycft，否则将Ys＜pyoft′pycft＞互换为Ys＜pycft′pyoft＞；S4-3、计算睡眠脑电的原始-交叉可视度概率差异YOC＝/2。S5、计算睡眠心电和脑电的交叉可视因果XYVG。S5-1、判断睡眠心电和脑电的交叉可视因果关系；如果XOC＞YOC，则睡眠脑电信号对心电的影响更大，脑电信号为驱动因子，心电信号为响应因子；反之，则说明心电信号为驱动因子，脑电信号为响应因子；S5-2、计算睡眠心电和脑电的交叉可视因果XYVG＝|XOC-YOC|。本发明的仿真结果：为了验证本发明提出方法对不同睡眠状态下的心脑耦合特征的提取效果，本发明选用了MIT-BIH公共数据库中睡眠数据，实验平台为Windows操作系统，并采用Python3.8软件进行仿真。本发明分析结果并不会受到操作系统以及Python软件版本的影响。本发明从MIT-BIH的数据集中提取了15组清醒和睡眠状态下的心电和脑电信号，图3为清醒和睡眠心脑信号采集的样本编码、截取的起始时间，信号采样频率为250Hz、12bit量化，每组信号选取10000采样点。睡眠信号中的伪迹已被手动删除，并对心电进行0.3至70Hz的带通滤波，对脑电信号进行0.3至50Hz的带通滤波。结果如图4所示，睡眠状态下心电和脑电的交叉可视因果要高于清醒状态的XYCC。整体看来，清醒状态下为0.114±0.007，睡眠状态下为0.124±0.0.008，且两者之间的差异性显著。从生理角度解释，在清醒状态下，心脏以及大脑受到更多的内外部因素的影响，因而两者之间的关联性的强度受到一定的限制，而当进入睡眠状态下，脑活动受到的人为意识影响较少，其和心脏之间的因果关联性增加。综述所述，本发明所述的基于交叉可视图的睡眠心脑信号分析方法可有效地表征心脑电信号之间的关联性。以上所述仅为本发明的优选方案，并非作为对本发明的进一步限定，凡是利用本发明说明书及附图内容所作的各种等效变化均在本发明的保护范围之内。
