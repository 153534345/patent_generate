标题title
一种心电和心音信号图形化联合分析的冠心病检测系统
摘要abst
本发明公开了一种心电和心音信号图形化联合分析的冠心病检测系统，涉及信号分析技术领域。该系统包括信号采集模块，用于同步采集被测试者的心电信号和心音信号；预处理模块，用于分别对心电信号和心音信号进行预处理和间期序列提取操作；联合散点角场图构建模块，用于根据心电时间序列和心音时间序列构建联合散点角场图；图像特征提取模块，用于提取联合散点角场图中图像特征；特征选择与分类模块，用于对图像特征进行特征选择，利用冠心病分类模型进行冠心病检测和分类。本发明充分考虑了冠心病在心电和心音两种信号上的表现，通过构建联合散点角场图，实现了高效的信号层面的联合分析，能够有效的进行冠心病的检测。
权利要求书clms
1.一种心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，包括：信号采集模块，用于同步采集被测试者的心电信号和心音信号；预处理模块，用于分别对心电信号和心音信号进行预处理和间期序列提取操作，得到心电时间序列和心音时间序列；联合散点角场图构建模块，用于根据心电时间序列和心音时间序列构建联合散点角场图；图像特征提取模块，用于提取联合散点角场图中图像特征；特征选择与分类模块，用于对图像特征进行特征选择，根据选择的特征训练冠心病分类模型，利用冠心病分类模型进行冠心病检测和分类。2.如权利要求1所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，预处理模块中，对心电信号的预处理操作包括先对心电信号进行带通滤波和工频陷波处理，以去除基线漂移和工频干扰，再进行归一化处理。3.如权利要求2所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，对预处理后的心电信号进行间期序列提取操作的具体步骤包括：分别定位心电信号中Q波的起点、R波的峰值点、T波的峰值点和终点，提取RR间期、QT间期、T波峰值-T波末点间期和Tpe/QT间期序列，并对QT间期进行校正，得到校正的QT间期。4.如权利要求1所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，预处理模块中，对心音信号的预处理操作包括先对心音信号进行高通滤波和工频陷波处理，以去除基线漂移和工频干扰，再进行归一化处理。5.如权利要求4所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，对预处理后的心音信号进行间期序列提取操作的具体步骤包括：定位心音信号的每个心动周期中第一心音、收缩期、第二心音和舒张期的起止点，获取收缩间期和舒张间期序列。6.如权利要求1所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，联合散点角场图构建模块中，构建联合散点角场图的具体步骤包括：将心电时间序列和心音时间序列分别归一化；将归一化后的心电时间序列和心音时间序列，其中一维作为x轴，另外一维作为y轴，构建二维联合散点图；计算二维联合散点图中每个点与原点的连线和x轴的夹角；根据计算的夹角构建联合散点角场矩阵作为联合散点角场图。7.如权利要求6所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，散点角场矩阵定义公式如下：其中，ui,vi分别为同步采集的心电时间序列和心音时间序列，φi为联合散点图中第i个点与x轴的夹角，G为得到的联合散点角场矩阵。8.如权利要求1所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，图像特征提取模块中，提取联合散点角场图中局部二值模式特征作为图像特征。9.如权利要求1所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，特征选择与分类模块中，使用基于支持向量机的递归特征消除法进行特征选择。10.如权利要求1所述的心电和心音信号图形化联合分析的冠心病检测系统，其特征在于，所述冠心病分类模型构建的方法为：基于特征选择后的特征集，使用支持向量机进行训练，获得冠心病分类模型，从而实现不同程度冠心病的分类。
说明书desc
技术领域本发明涉及信号分析技术领域，尤其涉及一种心电和心音信号图形化联合分析的冠心病检测系统。背景技术本部分的陈述仅仅是提供了与本发明相关的背景技术信息，不必然构成在先技术。冠心病是由于冠脉动脉粥样硬化导致心肌缺血、缺氧而坏死的心脏疾病，是最常见的心血管致死疾病之一，危害极其严重。冠脉造影作为检测冠心病的金标准，因为有创有损而且价格昂贵，因而不能作为常规筛查的手段。体表生理信号携带的信息表征了生理系统的状态，可用于个体生理病理状况的早期初步诊断，其中，心电和心音信号分别反映了心脏的电活动和机械活动情况，能够有效地反映心血管的生理和病理状态，同时具有无创无损、操作简便、成本低廉的优势，因此，可以通过分析心电和心音信号进行冠心病的初步诊断。此外，单独分析一种生理信号并不能捕获该部分包含的全部信息，因此，利用心电和心音信号间的耦合信息进行冠心病的检测也是必要的，同时采用有效的手段提取该部分的耦合信息更是关键。现有的研究中，对心电和心音信号的联合分析大多停留在特征层面上的联合，包括分别提取心电心音特征构建联合特征集、提取电-机械延迟构建耦合特征集等。这些方式虽然实现了两种信号间的联合，但也损失了原始信号中的部分耦合信息，因此存在信息利用不充分等问题。图形化分析方法是将原始一维时间序列转换成二维图形，从而更深度地挖掘信号中所携带的信息的一种方法。图形化分析方法不但能最大程度的保留原始信号中的信息，还有直观高效等优点，在信号分析领域中逐渐显示出不可替代的作用。近年来，将一维时间序列转换成二维图像的方法有很多种，包括庞加莱散点图、递归图、格拉姆角场等等，其中，庞加莱散点图是一种典型的将一维时间序列表示在笛卡尔坐标系下的图形化分析方法，图中任意一点的横纵坐标分别由时间序列中两点配对得到。庞加莱散点图能够描述系统相空间的几何构形，进而研究系统的变化规律，但庞加莱散点图使用的一般是一维时间序列，以当前时间序列值为x轴，下一时间值为y轴画图，因此不适合解决二维或多维时间序列分析的问题。有研究将庞加莱散点图的思想推广至两种序列，以其中一维作为x轴，另外一维作为y轴，构建二维联合散点图，研究两个时间信号之间的耦合关系及联合特征。然而，联合散点图需要的序列较长，且分辨率较低，因此也存在一定缺陷，不能有效的应用到心电、心音信号的耦合信息挖掘中。发明内容针对现有技术存在的不足，本发明的目的是提供一种心电和心音信号图形化联合分析的冠心病检测系统，充分考虑了冠心病在心电和心音两种信号上的表现，通过构建联合散点角场图，实现了高效的信号层面的联合分析，能够有效的进行冠心病的检测。为了实现上述目的，本发明是通过如下的技术方案来实现：本发明提供了一种心电和心音信号图形化联合分析的冠心病检测系统，包括：信号采集模块，用于同步采集被测试者的心电信号和心音信号；预处理模块，用于分别对心电信号和心音信号进行预处理和间期序列提取操作，得到心电时间序列和心音时间序列；联合散点角场图构建模块，用于根据心电时间序列和心音时间序列构建联合散点角场图；图像特征提取模块，用于提取联合散点角场图中图像特征；特征选择与分类模块，用于对图像特征进行特征选择，根据选择的特征训练冠心病分类模型，利用冠心病分类模型进行冠心病检测和分类。进一步的，预处理模块中，对心电信号的预处理操作包括先对心电信号进行带通滤波和工频陷波处理，以去除基线漂移和工频干扰，再进行归一化处理。更进一步的，对预处理后的心电信号进行间期序列提取操作的具体步骤包括：分别定位心电信号中Q波的起点、R波的峰值点、T波的峰值点和终点，提取RR间期、QT间期、T波峰值-T波末点间期和Tpe/QT间期序列，并对QT间期进行校正，得到校正的QT间期。进一步的，预处理模块中，对心音信号的预处理操作包括先对心音信号进行高通滤波和工频陷波处理，以去除基线漂移和工频干扰，再进行归一化处理。更进一步的，对预处理后的心音信号进行间期序列提取操作的具体步骤包括：定位心音信号的每个心动周期中第一心音、收缩期、第二心音和舒张期的起止点，获取收缩间期和舒张间期序列。进一步的，联合散点角场图构建模块中，构建联合散点角场图的具体步骤包括：将心电时间序列和心音时间序列分别归一化；将归一化后的心电时间序列和心音时间序列，其中一维作为x轴，另外一维作为y轴，构建二维联合散点图；计算二维联合散点图中每个点与原点的连线和x轴的夹角；根据计算的夹角构建联合散点角场矩阵作为联合散点角场图。更进一步的，散点角场矩阵定义公式如下：其中，ui,vi分别为同步采集的心电时间序列和心音时间序列，φi为联合散点图中第i个点与x轴的夹角，G为得到的联合散点角场矩阵。进一步的，图像特征提取模块中，提取联合散点角场图中局部二值模式特征作为图像特征。进一步的，特征选择与分类模块中，使用基于支持向量机的递归特征消除法进行特征选择。进一步的，所述冠心病分类模型构建的方法为：基于特征选择后的特征集，使用支持向量机进行训练，获得冠心病分类模型，从而实现不同程度冠心病的分类。以上一个或多个技术方案存在以下有益效果：本发明公开了一种心电和心音信号图形化联合分析的冠心病检测系统，充分考虑了冠心病在心电和心音两种信号上的表现，对二者进行联合分析，克服单一信号分析的局限性；本发明基于图形化分析方法，提出了一种心电和心音信号联合分析的新方法，即构建联合散点角场图，从信号层面对心电和心音信号进行了联合分析。本发明的图形化分析方法还可以尝试应用于任何两种相似信号的联合分析以及其他疾病的检测等，为一维信号的图形化分析提供了新思路。本发明附加方面的优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明构成本发明的一部分的说明书附图用来提供对本发明的进一步理解，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。图1是本发明实施例一冠心病检测过程整体流程图；图2是本发明实施例一联合散点角场图构建流程图；图3是本发明实施例一LBP特征提取流程图。具体实施方式应该指出，以下详细说明都是示例性的，旨在对本发明提供进一步的说明。除非另有指明，本文使用的所有技术和科学术语具有与本发明所属技术领域的普通技术人员通常理解的相同含义。应当说明的是，本发明实施例中，涉及到被测者的心电信号和心音信号等相关的数据，当本发明以上实施例运用到具体产品或技术中时，需要获得用户许可或者同意，且相关数据的收集、使用和处理需要遵守相关国家和地区的相关法律法规和标准。需要注意的是，这里所使用的术语仅是为了描述具体实施方式，而非意图限制根据本发明的示例性实施方式。如在这里所使用的，除非上下文另外明确指出，否则单数形式也意图包括复数形式，此外，还应当理解的是，当在本说明书中使用术语“包含”和/或“包括”时，其指明存在特征、步骤、操作、器件、组件和/或它们的组合；传统的联合散点图是将原始序列中的值直接对应横纵轴，点到图中的对应位置，如果序列太短，则点太少，图中会有大量空白，难以看清系统真正的状态。而如果序列足够长，则散点图中点过多，很容易出现两个或多个点距离过近或者完全重合难以区分的情况，此时就会体现分辨率低，信息利用不完全的问题。针对上述问题，本发明设计了一种联合散点角场图，对各个散点间计算得到一个夹角，其余弦值对应联合散点角场图中的一个像素，并且该值能够反应系统状态的变化情况，因此分辨率较高，信息挖掘也更完全。同时，设原始序列中有n个点，则联合散点角场图大小就为n*n，因此需要的时间序列也不必过长，克服了传统的联合散点图需要的序列较长，且分辨率较低的问题。实施例一：本发明实施例一提供了一种心电和心音信号图形化联合分析的冠心病检测系统，包括信号采集模块、预处理模块、联合散点角场图构建模块、图像特征提取模块和特征选择与分类模块，具体检测过程如图1所示，信号采集模块同步采集心电和心音信号；之后，预处理模块对采集到的原始信号进行滤波去噪处理，并提取处理后心电和心音信号的多种间期序列；联合散点角场图构建模块用于对两两组合的间期序列构建联合散点角场图；图像特征提取模块用于提取图像特征；最后特征选择与分类模块用于对提取的联合图特征进行特征选择和分类器构建，给出冠心病分类结果。更为具体的，信号采集模块，用于同步采集被测试者的心电信号和心音信号。预处理模块，用于分别对心电信号和心音信号进行预处理和间期序列提取等操作，得到心电时间序列和心音时间序列。其中，对心电信号的预处理操作包括先对心电信号进行带通滤波和工频陷波处理，以去除基线漂移和工频干扰，再进行归一化处理。对预处理后的心电信号进行间期序列提取操作的具体步骤包括：分别定位心电信号每个心动周期中Q波的起点、R波的峰值点、T波的峰值点和终点，从而提取RR间期、QT间期、T波峰值-T波末点间期和Tpe/QT间期序列，并采用Bazett法对QT间期进行校正，得到校正的QT间期，公式如下：其中，对心音信号的预处理操作包括先对心音信号进行高通滤波和工频陷波处理，以去除基线漂移和工频干扰，再进行归一化处理。对预处理后的心音信号进行间期序列提取操作的具体步骤包括：定位心音信号的每个心动周期中第一心音S1、收缩期、第二心音S2和舒张期的起止点，获取收缩间期和舒张间期序列。本实施例中，使用的心电和心音信号时长为5分钟，包含若干个心动周期，提取每个心动周期中对应间期的时长，按心动周期顺序排列，即为间期序列。在一种具体的实施方式中。首先，同步采集被测者的心电信号和心音信号，使用二阶巴特沃斯带通滤波器去除心电信号的噪声干扰，利用多项式3阶Savitzky-Golay滤波器处理心电信号的基线漂移，利用50Hz陷波去除心电信号的工频干扰，并使用Z-score方法对滤波后的心电信号进行归一化处理；使用巴特沃斯高通滤波器去除心音信号的低频噪声干扰，利用50Hz陷波去除心音信号的工频干扰，并使用Z-score方法对滤波后的心音信号进行归一化处理。联合散点角场图构建模块，用于根据心电时间序列和心音时间序列构建联合散点角场图。联合散点角场图构建流程如图2所示，将提取的心电和心音时间序列分别归一化到0-1，之后将心电信号的4种时间序列和心音信号的2种时间序列两两组合，共得到8种序列组合，构建联合散点图，之后计算散点夹角，进一步构建联合散点角场矩阵即联合散点角场图，从而实现心电和心音信号的联合。在一种具体的实施方式中，联合散点角场图构建模块中，构建联合散点角场图的具体步骤包括：步骤1，将心电时间序列和心音时间序列分别归一化。具体的，将两种模态的时间序列心电时间序列ui和心音时间序列vi分别归一化到0-1，从而减小尺度不同造成的影响。步骤2，将归一化后的心电时间序列和心音时间序列，其中一维作为x轴，另外一维作为y轴，构建二维联合散点图；对于同步采集的两种时间序列ui和vi，以其中一维作为x轴，另外一维作为y轴，构建二维联合散点图。对于健康人，联合散点图中的散点主要分布在标准线附近，而冠心病患者的散点分布范围则更为广泛，表明健康人的两种模态时间序列的变化规律有一定程度上的线性跟随关系，而对于冠心病患者，二者的跟随性则有一定程度的降低。步骤3，对于二维联合散点图中的每个点，计算二维联合散点图中每个点与原点的连线和x轴的夹角，从而提取每个时序散点的角度信息。公式为：其中，φi为联合散点图中第i个点与x轴的夹角，n为散点图中散点的个数。根据上文可知，若心脏生理活动稳定，则两种序列变化趋势基本一致，对于联合散点图中每个点，该夹角应接近45度。步骤4，根据计算的夹角构建联合散点角场矩阵作为联合散点角场图。其中，散点角场矩阵定义公式如下：其中，ui,vi分别为同步采集的心电时间序列和心音时间序列，φi为联合散点图中第i个点与x轴的夹角，G为得到的联合散点角场矩阵。若心脏生理活动比较稳定，则散点间角度变化应较小，矩阵中数值也比较稳定；反之，若心脏生理活动出现异常，则散点分布改变，散点间角度变化增大，对应散点角场矩阵数值波动大，散点角场图中纹理特征明显。图像特征提取模块，用于提取联合散点角场图中图像特征。其中，提取联合散点角场图中局部二值模式特征作为图像特征。在一种具体的实施方式中，提取联合散点角场图中的LBP特征，每张图提取10个特征，共80个特征。LBP是一种理论简单、计算高效的非参数局部纹理特征描述因子，当给定一个像素点，LBP计算可以表达为其中，gc是中心像素灰度值，gp是邻域像素灰度值，P是以R为半径的圆周上邻域像素个数。等价LBP模式指的是模式对应的二进制数最多只包含两次从1到0或从0到1的跳变，实际上从LBPP,R到的映射，将原来2p种模式降维p*+3种，u2表示等价模式，在保留原图像中大部分有效信息的同时降低了计算量。为了实现旋转不变性，局部旋转不变性模式可以定义为上式中，从LBPP,R到的映射，产生P+2种不同LBP特征值，riu2代表旋转不变的等价模式U≤2。提取图像LBP特征的流程如图3所示，将联合散点角场图图像划分为n*n的窗口，并计算窗口每个像素的基本LBP值码，LBP值码形似10110000的二进制串。利用旋转不变性，获取最小二进制串作为当前窗口的LBP值。采用等价模式进行降维。利用每个像素的LBP值，获取窗口的直方图。按步长移动窗口，直到遍历整个图像。之后连接全部窗口的直方图，获取该窗口尺寸下的LBP特征向量。特征选择与分类模块，用于对图像特征进行特征选择，根据选择的特征训练冠心病分类模型，利用冠心病分类模型进行冠心病检测和分类。其中，使用基于支持向量机的递归特征消除法进行特征选择。冠心病分类模型构建的方法为：基于特征选择后的特征集，使用支持向量机进行训练，获得冠心病分类模型，从而实现不同程度冠心病的分类。需要说明的是，本发明所述的心电和心音信号的预处理方法、特征提取方法、特征选择方法以及数据分析方法只是一种或多种实施例的体现，这意味着与本发明相似或等同的特征或方法、或组合均被涵盖在本发明中。本发明旨在涵盖所附权利要求的精神和范围内所包括的各种修改和等同布置。此外，未详细描述的地方均为现有技术。上述虽然结合附图对本发明的具体实施方式进行了描述，但并非对本发明保护范围的限制，所属领域技术人员应该明白，在本发明的技术方案的基础上，本领域技术人员不需要付出创造性劳动即可做出的各种修改或变形仍在本发明的保护范围以内。
