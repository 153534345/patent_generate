标题title
一种基于大脑外侧缰核信号的抑郁状态检测系统
摘要abst
本发明公开了一种基于大脑外侧缰核信号的抑郁状态检测系统，包括计算机存储器、计算机处理器以及存储在计算机存储器中并可在计算机处理器上执行的计算机程序，计算机存储器中存有训练好的抑郁状态检测模型，抑郁状态检测模型使用多组不同种类的弱分类器构建而成，每个弱分类器从训练集与测试集中构建的子特征空间中选取部分特征值进行训练；计算机处理器执行计算机程序时实现以下步骤：获取大脑外侧缰核信号，输入到训练好的检测模型后，提取每个时间片的高维度特征向量，对每个弱分类器推断的抑郁与非抑郁标签进行统计，采用多数表决制生成每个时间片对应的预测标签。本发明可以提高检测精度，对抑郁症的临床诊断、评估和治疗具有重要意义。
权利要求书clms
1.一种基于大脑外侧缰核信号的抑郁状态检测系统，包括计算机存储器、计算机处理器以及存储在所述计算机存储器中并可在所述计算机处理器上执行的计算机程序，其特征在于，所述计算机存储器中存有训练好的抑郁状态检测模型，所述抑郁状态检测模型的训练过程如下：获取同一抑郁对象的两组大脑外侧缰核信号数据，每组数据包含一个负样本数据段和一个正样本数据段；其中，负样本数据为抑郁状态，正样本数据为非抑郁状态，每组数据中的数据段包含相同的多个局部场电位通道和锋电位通道数据，两组数据中选取一组数据作为初始训练集，另一组为初始测试集；计算训练集中各个锋电位通道在正样本数据段和负样本数据段中的簇状放电数量的比值大小，选取比值小于固定阈值的锋电位通道对应的电极通道编号；根据选取的电极通道编号，从初始训练集与初始测试集分别选出对应通道编号的局部场电位通道数据，分别记为筛选后的训练集X与测试集Y；通过滑动时间窗，将训练集X与测试集Y中局部场电位通道的正负样本数据段划分为连续时间若干时间片；提取步骤训练集X与测试集中局部场电位通道的每个时间片，提取功率谱、功率谱熵、相-幅耦合、样本熵、樋口分形维数，分别构成对应的特征向量，并将这些特征向量拼接组成一个高维度特征向量，代表当前时间片对应的特征向量，高维度特征向量的维度为k；设时间片数为n，每个数据段将得到一个n*k的特征矩阵；基于方差分析的方法从维度为k的高维度特征向量中选取s个特征值，构建子特征空间；使用多组不同种类的弱分类器构建一个抑郁状态检测模型，每个弱分类器独立且随机从步骤中生成的子特征空间中选取部分特征值进行训练；所述计算机处理器执行所述计算机程序时实现以下步骤：获取待检测的大脑外侧缰核信号，输入到训练好的抑郁状态检测模型后，提取每个时间片的高维度特征向量，对每个弱分类器推断的抑郁与非抑郁标签进行统计，采用多数表决制生成每个时间片对应的预测标签。2.根据权利要求1所述的基于大脑外侧缰核信号的抑郁状态检测系统，其特征在于，步骤中，所述的功率谱通过对信号进行傅里叶变换后求平方得到。3.根据权利要求2所述的基于大脑外侧缰核信号的抑郁状态检测系统，其特征在于，在每个时间片中，提取0.5~4Hz的Delta波段、4~8Hz的Theta波段、8~13Hz的Alpha波段、13~30Hz 的Beta波段、30~70Hz 的Gamma波段、70~150Hz的High Gamma波段共六个频段的功率谱；每个时间片中每个局部场电位通道获得六个功率谱特征。4.根据权利要求1所述的基于大脑外侧缰核信号的抑郁状态检测系统，其特征在于，步骤中，所述功率谱熵的提取过程为：对局部场电位信号使用多窗口法计算信号的功率谱，然后对功率谱进行归一化处理，最后根据香农信息熵公式计算经归一化处理后功率谱的熵值。5.根据权利要求1所述的基于大脑外侧缰核信号的抑郁状态检测系统，其特征在于，步骤中，所述相-幅耦合的提取过程为：首先通过带通滤波方式从原始局部场电位信号 中得到特定低频波段的时域信号 与特定高频波段的时域信号 ；然后通过希尔伯特变换获得 的相位信息 ；最后通过希尔伯特变换获得的振幅包络，将相位序列与振幅包络序列组合成一组时间序列 ， ，为序列长度；将相位 等间距分成18个桶，并进行如下运算：其中：然后对进行归一化处理，并计算KL散度：其中， 最终计算得到相-幅耦合值：选择相位频率范围为4~8Hz 的Theta波段，幅值频率范围为30~70Hz的Gamma波段为计算参数，依次计算单个时间片中多个局部场电位通道的相-幅耦合值。6.根据权利要求1所述的基于大脑外侧缰核信号的抑郁状态检测系统，其特征在于，步骤中，使用支持向量机、逻辑斯蒂回归和多层感知机这三个弱分类器构建一个集成的抑郁状态检测模型。
说明书desc
技术领域本发明涉及脑电信号处理领域，尤其是涉及一种基于大脑外侧缰核信号的抑郁状态检测系统。背景技术当前抑郁症患病人群越来越多，其中10%-30%患者因传统治疗方式无效或者效果欠佳而发展成为难治性抑郁症。基于脑机接口的大脑闭环调控技术有望为难治性抑郁患者带来新的治疗手段。该技术的重要一环是基于脑信号的抑郁状态检测，当检测到抑郁状态发生时触发治疗电刺激脑调控，达到抑郁症缓解和治疗效果。公开号为CN110960233A的中国专利文献公开了一种基于脑电的抑郁状态检测方法及系统，通过采集偶数集导联左、右脑的脑电信号，计算左右脑脑电的Alpha波及其他波段的功率谱差值的时间信息和数值信息，左右脑脑电的Alpha波及其他波段的样本熵差值的时间信息和数值信息，使用这两类信息来确定偏侧性指标和抑郁状态，并构建了一套由采集脑电数据的信号采集设备，数据去噪、分析上述两类信息提取的软硬件模块构成的抑郁状态检测系统，从而客观量化分析人体抑郁状态。但是，该方法计算大脑前额叶左右半脑功率谱差值信息和特定波段样本熵差值信息，确定偏侧性指标和抑郁状态，选用的特征较为单一，很难全面衡量抑郁状态，容易出现误分类的情况。公开号为 CN112617833A的中国专利文献公开了一种基于静息态脑电波检测抑郁症的装置，通过采集62个脑电通道并提取各频带上的线性与非线性特征以及功率谱特征；使用包含基于树的特征选择模型及L1范数特征选择模型在内的特征选择装置，选取具有显著性的通道特征作为训练所述预测模型的特征；选用KNN，支持向量机、随机森林、逻辑回归在内的机器学习模型对特征及对应的标签进行训练；将待检测体检测结果进行反馈显示。但是，该装置使用脑电帽采集头皮脑电，属于非侵入式信号采集方式，信号源定位不准确，且伪迹较多，信号质量不如侵入式信号采集方式，导致在信号处理过程中很难去除噪声和伪迹的影响，进而直接影响分类准确率；且在模型训练过程中使用多种分类器分别进行训练，取测试效果最优者作为最终的分类器，单一模型无法有效捕捉多通道脑电特征的内在联系，进而无法有效提升分类正确率。发明内容本发明提供了一种基于大脑外侧缰核信号的抑郁状态检测系统，旨在为基于闭环脑机接口调控的抑郁治疗技术提供抑郁状态指征，检测精度高，对于抑郁症的临床诊断、评估和治疗具有重要意义。一种基于大脑外侧缰核信号的抑郁状态检测系统，包括计算机存储器、计算机处理器以及存储在所述计算机存储器中并可在所述计算机处理器上执行的计算机程序，所述计算机存储器中存有训练好的抑郁状态检测模型，所述抑郁状态检测模型的训练过程如下：获取同一抑郁对象的两组大脑外侧缰核信号数据，每组数据包含一个负样本数据段和一个正样本数据段；其中，负样本数据为抑郁状态，正样本数据为非抑郁状态，每组数据中的数据段包含相同的多个局部场电位通道和锋电位通道数据，两组数据中选取一组数据作为初始训练集，另一组为初始测试集；计算训练集中各个锋电位通道在正样本数据段和负样本数据段中的簇状放电数量的比值大小，选取比值小于固定阈值的锋电位通道对应的电极通道编号；根据选取的电极通道编号，从初始训练集与初始测试集分别选出对应通道编号的局部场电位通道数据，分别记为筛选后的训练集X与测试集Y；通过滑动时间窗，将训练集X与测试集Y中局部场电位通道的正负样本数据段划分为连续时间若干时间片；提取步骤训练集X与测试集中局部场电位通道的每个时间片，提取功率谱、功率谱熵、相-幅耦合、样本熵、樋口分形维数，分别构成对应的特征向量,并将这些特征向量拼接组成一个高维度特征向量，代表当前时间片对应的特征向量，高维度特征向量的维度为k；设时间片数为n，每个数据段将得到一个n*k的特征矩阵；基于方差分析的方法从维度为k的高维度特征向量中选取s个特征值，构建子特征空间；使用多组不同种类的弱分类器构建一个抑郁状态检测模型，每个弱分类器独立且随机从步骤中生成的子特征空间中选取部分特征值进行训练；所述计算机处理器执行所述计算机程序时实现以下步骤：获取待检测的大脑外侧缰核信号，输入到训练好的抑郁状态检测模型后，提取每个时间片的高维度特征向量，对每个弱分类器推断的抑郁与非抑郁标签进行统计，采用多数表决制生成每个时间片对应的预测标签。优选地，步骤中，负样本数据段和正样本数据段的记录时长均为500秒，采样率为1KHz。优选地，步骤中，在进行划分前，首先对各个局部场电位通道的正负样本数据段进行工频滤波处理，过滤工频噪声，然后将工频滤波后的信号进行带通滤波，得到滤波后的局部场电位信号。进一步地，步骤中，所述的功率谱通过对信号进行傅里叶变换后求平方得到。优选地，在每个时间片中，提取0.5~4Hz的Delta波段、4~8Hz的Theta波段、8~13Hz的Alpha波段、13~30Hz 的Beta波段、30~70Hz 的Gamma波段、70~150Hz的High Gamma波段共六个频段的功率谱；每个时间片中每个局部场电位通道获得六个功率谱特征。步骤中，所述功率谱熵的提取过程为：对局部场电位信号使用多窗口法计算信号的功率谱，然后对功率谱进行归一化处理，最后根据香农信息熵公式计算经归一化处理后功率谱的熵值。步骤中，使用支持向量机、逻辑斯蒂回归和多层感知机这三个弱分类器构建一个集成的抑郁状态检测模型。与现有技术相比，本发明具有以下有益效果：1、现有研究认为大脑外侧缰核组织的异常放电与抑郁症发作是密切相关的，所以该区域局部场电位与锋电位信号可以用于抑郁症分类。本发明中原始信号使用侵入式电极采集得到，各类噪声干扰较少，便于信号分析与提取特征，侵入式电极被植入脑区后可以在较长时间段内稳定获取局部场电位信号，结合本发明中提出的分类模型，可以实现抑郁状态实时检测与分析。2、本发明通过分析比较锋电位簇状放电情况选取分类所用局部场电位通道，可以有效提升分类正确率。3、本发明选用多种线性与非线性局部场电位特征，多维度捕捉局部场电位信号的时空特征，有效提升分类的正确率，降低误分类概率。4、本发明随机选取多维特征、选用多种类分类器构建基于投票机制的分类模型，可以提升分类器鲁棒性；模型训练较为简单，无需进行多轮反复最优化参数搜索；模型训练评价指标F1-Score和ROC_AUC较单一模型测试结果有一定程度增长。附图说明图1为本发明实施例中外侧缰核区域脑电信号通道选择与预处理、特征提取、模型训练与测试三阶段的流程示意图。图2为本发明实施例中抑郁状态检测模型的结构示意图。具体实施方式下面结合附图和实施例对本发明做进一步详细描述，需要指出的是，以下所述实施例旨在便于对本发明的理解，而对其不起任何限定作用。本实例使用C57BL/6小鼠经抑郁造模得到抑郁小鼠模型。原始脑电信号采用Plexon Inc公司的记录设备，原始信号包含16个通道，采样率为40KHz。将16根电极植入C57BL/6小鼠外侧缰核部位，一个原始信号通道可以分离出零至多个锋电位通道信号与一个局部场电位通道信号；锋电位通道信号使用Plexon Offline Sorter软件得到SpikeSort序列；局部场电位通道信号由原始脑电信号低通滤波至500Hz然后以1KHz采样率进行重采样得到；两者最终合并保存为.mat格式文件，以上为原始数据预处理步骤。间隔多日分两次给小鼠注射短效抗抑郁药物，分别记录注射前10~15分钟与注射药物后240分钟小鼠的脑电数据，经预处理及专家标注方式筛选出两组注射药物前后的脑电数据。将两次注射药物可获得两组正负样本数据，随机选取一组数据集作为训练集，另一组数据集作为测试集。一种基于大脑外侧缰核信号的抑郁状态检测系统，包括计算机存储器、计算机处理器以及存储在计算机存储器中并可在计算机处理器上执行的计算机程序，计算机存储器中存有训练好的抑郁状态检测模型。如图1所示，抑郁状态检测模型的训练过程如下：获取同一抑郁模型小鼠两组数据，每组数据包含一个负样本数据段与一个正样本数据段；两组数据中选取一组数据作为训练集，另一组为测试集。训练集与测试集各自拥有一段正样本数据段和一段负样本数据段，正负样本数据段记录时长均为500秒，采样率为1KHz，包含经过专家预处理与挑选的多组锋电位通道时间戳序列和局部场电位连续电压信号。计算步骤中训练集的各个锋电位通道在正负样本中的簇状放电数量的比值大小，选取比值小于固定阈值的锋电位通道对应的电极通道编号；根据所选取电极通道编号，从步骤中训练集与测试集分别选出对应通道编号的局部场电位通道数据，分别记为训练集X与测试集Y。具体操作流程为计算训练集中各个锋电位通道在正负样本的锋电位簇状放电数量，计算正样本中簇状放电个数与负样本中簇状放电个数比值，选出比值小于固定阈值的电极通道编号。将训练集中已选取的电极通道编号与测试集中电极通道编号进行交集运算，选出电极通道编号 。根据上述电极通道编号分别从训练集和测试集中选取对应的局部场电位通道信号，分别组成训练集X与测试集Y。通过滑动时间窗，将步骤训练集X与测试集Y中局部场电位通道的正负样本数据段划分为连续时间若干时间片。具体来说，首先对各个局部场电位通道正负样本信号进行带陷滤波处理，过滤工频噪声，然后将工频滤波后的信号带通滤波得到滤波后的局部场电位信号。然后将滤波后的局部场电位信号以长度为50秒，步长为25秒的滑动时间窗进行分割，得到若干段长度为50秒的时间片并标记为正样本或负样本时间片。因此，数据集X与数据集Y各自包含19个正样本时间片和19个负样本时间片，每个时间片包含多个局部场电位通道信号。提取步骤中训练与测试数据集中局部场电位通道的每个时间片，提取功率谱、功率谱熵、相-幅耦合、样本熵、樋口分形维数，分别构成对应的特征向量,并将这些特征向量拼接组成一个高维度特征向量，代表当前时间片对应的特征向量，高维度特征向量的维度为k；设时间片数为n，每个数据段将得到一个n*k的特征矩阵。功率谱特征：功率谱反应了脑电信号的功率随频率的变化。功率谱通过对信号进行傅里叶变换，然后求平方得到。其中对于包含N个点的信号s，傅立叶变换公式为：上式得到的是经过离散傅里叶变换后的结果，对变换后的结果求平方，便能得到功率谱：得到的功率谱 表征了每个频段的功率，在一定频段范围内求和，可得到该频段范围的功率。得到特征后，我们对功率谱特征取对数，以降低不同频段之间功率的差异：本实施例中，取Delta波段、Theta波段、Alpha波段、Beta波段、Gamma波段、High Gamma波段共六个频段的功率谱特征。每个时间片中每个局部场电位通道可获得六个功率谱特征可组成一个功率谱特征向量，多个局部场电位通道的功率谱特征向量按照电极通道编号顺序从小到大依次拼接成一个功率谱特征向量。功率谱熵特征：功率谱熵是一种信息熵，能够量化不确定性系统的频谱复杂度。对局部场电位信号使用多窗口法计算信号的功率谱 ，然后对功率谱进行归一化处理：根据香农信息熵公式计算经归一化处理后功率谱的熵值：一个时间片内单个局部场电位通道的功率谱熵为一个标量值，故将各个局部场电位通道的功率谱熵按照电极通道编号从小到大依次拼接成个功率谱熵特征向量。相-幅耦合特征：相-幅耦合特征反映局部场电位信号中高频信号分量的振幅被低频信号分量相位调制的程度大小。首先通过带通滤波方式从原始局部场电位信号中得到特定低频波段的时域信号 与特定高频波段的时域信号 ；然后通过希尔伯特变换获得 的相位信息 ，最后通过希尔伯特变换获得的振幅包络 ，将相位序列与振幅包络 序列组合成一组时间序列 ，, 为序列长度。将相位 等间距分成18个桶。根据相位 计算桶编号 ，公式为：然后将振幅包络累加到相应桶中，公式为：最后每个桶分别求取均值得到 ，公式为： 下面是三个步骤的总过程：其中，表示根据相位值求桶编号然后对进行归一化处理得到，并计算KL散度：，其中， 表示离散均匀分布， ；最终计算得到相-幅耦合值 :选择相位频率范围为Theta波段，幅值频率范围为Gamma波段为计算参数，依次计算单个时间片中多个局部场电位通道的相-幅耦合值，按照上述功率谱熵特征值拼接方法得到一个相-幅耦合向量。样本熵特征：样本熵是近似熵的一个改进算法，用于评估脑电时间序列信号的复杂程度，计算公式如下：给定个样本点的时间序列 ，选取组向量，其中。选定一个阈值参数 , 为时间序列的标准差。计算两个向量与之间的距离；给定向量，计算该向量与其他向量的距离小于给定阈值的向量个数，。然后，对于每个进行min-max归一化 ；定义 ，其公式如下：将原先的m维度增加至m+1维，重复上述步骤，得到和：最后，样本熵可由如下公式计算获得：本实例中将每个50秒长时间片的时间片使用窗长为5秒，步长为2.5秒的滑动窗口方式，划分成19个子时间片，分别计算这19个子时间片样本熵,，最后求取均值作为该时间片中单个局部场电位通道的样本熵值。按照上述功率谱熵特征值拼接方法得到一个样本熵向量。樋口分形维数特征：HFD用于计算时间序列信号的分形维度。其计算过程如下所示：给定N个样本点的时间序 ,N为时间序列长度。从序列 中选取k组子序列:，,为向下取整符号， ，k是固定常数；计算每组子序列的“长度” ：HFD值是上述k组子序列“长度”的均值：本实例中将每个50秒长时间片的时间片使用窗长为5秒，步长为2.5秒的滑动窗口方式，划分成19个子时间片，分别计算这19个子时间片樋口分形维数，最后求取均值作为该时间片中单个局部场电位通道的樋口分形维数。按照上述功率谱熵特征值拼接方法得到一个樋口分形维数向量。因此，本实例中训练集或测试集中包含一正一负共两个数据段，每个数据段包含19个时间片，每个时间片中的单通道局部场电位信号包含以上5类特征共10个特征值。假设步骤中选取了10个电极通道，则每个数据段的特征矩阵的维度为19*100。使用统计假设检验的方法检验步骤中训练集各个时间片提取的特征项是否在不同标签之间存在显著性差异，计算每个特征值的卡方检验P值，如 。将其进行升序排序，得到P值序列，依次选取对应的特征项，构建训练集子特征矩阵，其维数为，N代表时间片个数，t代表特征项个数；训练集中同样按照P值序列，依次选取对应的特征项，构建测试集子特征矩阵 。使用多组不同种类的弱分类器构建抑郁状态检测模型，每个弱分类器独立且随机从步骤中生成的子特征空间中选取部分特征值进行训练。模型推断阶段，对于每个时间片提取的高维度特征向量各个弱分类器独立生成预测标签，然后采用多数表决制生成该时间片对应的预测标签，如图2所示。具体来说，分别选择支持向量机、逻辑斯蒂回归、多层感知机三种模型，每种模型包含n个初始化参数独立的模型实例，分别记作;; ，在本实例中n取5。每个实例模型在训练时使用随机子空间方法独立地从步骤中子特征矩阵M中选取q个特征项输入到模型中进行模型参数学习。每个模型都保存有其选取的q个特征项对应的特征编号。测试集验证阶段，每个实例模型按照其保存的q个特征项编号从步骤中测试集子特征向量中选取q个对应的特征项，将其送入实例模型中进行分类预测。最终，这15个实例模型分类预测结果按多数表决制的方式输出分类预测标签，即 为非抑郁标签，否则为抑郁标签，为实例模型预测标签结果，0为抑郁标签，1为非抑郁标签。本实例选用两个数据集，每个数据集中包含19个抑郁时间片与19个非抑郁时间片。通过步骤选取40个特征项目，然后步骤中每个弱分类器再独立且随机从上述40个特征项中随机选取20个特征项，每个弱分类器初始参数随机初始化，训练轮数与学习率等超参数保持固定不变，使用一个数据集进行训练，另一个数据集进行测试的F1-Score分值结果如下，下表1是未使用步骤进行局部场电位通道选择的结果，下表2是使用步骤进行局部场电位通道选择的结果。表1 表2从上述测试结果可知，使用步骤筛选局部场电位通道可以显著提升抑郁状态分类正确率。以上所述的实施例对本发明的技术方案和有益效果进行了详细说明，应理解的是以上所述仅为本发明的具体实施例，并不用于限制本发明，凡在本发明的原则范围内所做的任何修改、补充和等同替换，均应包含在本发明的保护范围之内。
