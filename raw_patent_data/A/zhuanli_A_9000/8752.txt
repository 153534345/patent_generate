标题title
一种基于深度卷积残差网络的心律失常分类方法
摘要abst
本发明公开了一种基于深度卷积残差网络的心律失常分类方法，具体按照以下步骤实施：步骤1、选取MIT‑BIH心律失常数据库的心电数据；步骤2、对步骤1选取的心电数据进行预处理；步骤3、对步骤2预处理后的心电数据进行分割；构建分类网络模型；步骤4、利用步骤3分割的心电数据对网络模型进行训练；步骤5、将待测试的心电数据片段输入所述训练好的深度卷积残差网络模型，最终输出心电信号片段的分类结果。解决了现有技术中存在的疾病分类准确度低的问题。
权利要求书clms
1.一种基于深度卷积残差网络的心律失常分类方法，其特征在于，具体按照以下步骤实施：步骤1、选取MIT-BIH心律失常数据库的心电数据；步骤2、对步骤1选取的心电数据进行预处理；步骤3、对步骤2预处理后的心电数据进行分割；构建分类网络模型；步骤4、利用步骤3分割的心电数据对网络模型进行训练；步骤5、将待测试的心电数据片段输入所述训练好的深度卷积残差网络模型，最终输出心电信号片段的分类结果。2.根据权利要求1所述的一种基于深度卷积残差网络的心律失常分类方法，其特征在于，所述步骤2具体按照以下实施：步骤2.1、读取所选数据库中的原始心电数据；步骤2.2、利用小波9级分级特性进行噪声抑制；在分析离散化非平稳心电信号时，任意信号f可用多分辨率分析公式表示为：式中右边第一项是f在尺度空间的投影，是f的平滑近似，第二项是f在小波空间的投影，是对f的细节补充；j是任意尺度的开始，通常称cj，k为近似值或尺度系数，称dj，k为细节或小波系数；展开系数计算如下：使用Daubechies5小波基函数，对心电信号数据进行9尺度小波变换；然后使用软阈值函数对噪声进行抑除；其数学公式表示如下：其中w为尺度分解后的信号值，阈值λ满足σ为噪声标准差，N为信号长度；步骤2.3、心电信号的基线漂移情形采用零均值减法，就是将每一维滤波后的心电数据减去每一维的平均值即可得到干净的数据。3.根据权利要求1所述的一种基于深度卷积残差网络的心律失常分类方法，其特征在于，所述步骤3中对步骤2预处理后的心电数据进行分割具体按照以下实施：3.1.1、获取R波峰位置和对应的标签；3.1.2、选取R波峰前144个采样点到后180个采样点作为一个节拍；3.1.3、分割后每个节拍重采样到250，作为后续网络模型的输入。4.根据权利要求1所述的一种基于深度卷积残差网络的心律失常分类方法，其特征在于，所述步骤3中构建分类网络模型具体按照以下实施：步骤3.2.1、搭建基础的卷积神经网络；所述卷积神经网络与VGG网络的结构类似，由卷积结构和全连接层组成：卷积结构由4个21×1卷积的重复应用组成，每个卷积后跟一个批量归一化和一个ReLU激活函数进行运算，步长为1；所述后续的卷积结构由32个25×1卷积的重复应用组成，每个卷积层后跟一个批量归一化和一个ReLU激活函数进行运算，步长为1；全连接层用于对上一层的神经元进行全部连接，实现特征的非线性组合，是针对5种类别的分类，因此参数设置5；用激活函数softmax可将多分类的输出值转化为相对概率，这些值的累加和为1；步骤3.2.2、在所述的卷积神经网络的卷积层后添加残差块1，形成跳跃连接结构；公式如下：xl+1＝xl+F其中，xl+1为第l+1层卷积层的卷积结果，xl为第l层卷积层的卷积结果，Wl为第l层卷积层的权重，F为残差部分；将这种残差块添加在卷积网络中，形成跳跃连接结构；步骤3.2.3、将残差块2添加至卷积神经网络中两层残差块1的后一层，再次形成跳跃连接结构，最终完成深度卷积残差网络的搭建。5.根据权利要求1所述的一种基于深度卷积残差网络的心律失常分类方法，其特征在于，所述步骤4具体按照以下实施：步骤4.1、将步骤3处理后的心电节拍与对应的标签作为数据集；使用10折交叉验证来划分训练集和测试集，其中拿出每折的训练集来作为网络的输入，输入深度卷积残差网络，首先需要将分割后的数据作为数据集；将的数据集分成10个子集，每个子集所分布的数据量近似相等；用其中的9个子集作为网络模型的输入数据；步骤4.2、使用10折交叉验证划分的训练集数据对深度卷积残差网络进行训练：首先，将第一折中的9个训练子集输入网络模型，训练数据中每个节拍对应一个label；其中输入到深度卷积残差网络中的每个节拍大小为，输入的节拍需经过前后两层卷积操作、2个残差块1和1个残差块2；最后经过softmax激活函数对节拍进行5分类，输出的5分类概率值就是网络所预测出的结果；对于模型损失度量，是模型预测值与特定样本真实值的差值，当面对多分类或者多标签的任务时，评价度量可能会用到这两个，一个是交叉熵损失函数，另一个是稀疏交叉熵损失函数，选择后者衡量模型损失程度，是由于稀疏交叉熵损失函数用于目标结果是个整数，不需要存储一个矩阵，可减少内存空间的使用；公式如下：其中，n为样本个数，m为类别数，为预测输出值，y为实际值；再通过反向传播算法计算在卷积和池化运算过程中产生的参数来降低损失函数，反向传播计算所产生的参数就是网络的权重，记为W；其次，将其它9折心电数据输入深度卷积残差网络中，重复上一步的操作，不断的记录各折上损失值，最后各折损失值保持稳定后，对应权重W对应更新；等到所有折数据训练完后，即可得到各折上训练结果，得到训练好的深度卷积残差网络。6.根据权利要求1所述的一种基于深度卷积残差网络的心律失常分类方法，其特征在于，所述步骤5具体按照以下实施：首先，采用每折除训练集外剩余一个子集的数据作为该折待测试的心电数据；然后，将每折待测试的心电节拍输入到训练好的深度卷积残差网络，经过2次卷积运算以及2次的残差模块1操作和1次残差模块2操作，最后通过softmax对测试集上每个节拍进行类别预测，输出最终的分类结果。
说明书desc
技术领域本发明属于医学图像处理与信号处理技术领域，涉及一种基于深度卷积残差网络的心律失常分类方法。背景技术心血管疾病是严重威胁人类生命健康的重要疾病之一。据2020年世界卫生组织报告，心血管疾病是全球的头号死因，每年死于心血管疾病的人数多于任何其它疾病。心律失常是心血管疾病中重要的一组疾病，可单独发作亦可与其他心血管疾病伴发，甚至突然发作致人猝死，临床上通常使用心电图诊断心律失常。心律失常是心血管疾病中重要的一组疾病，可单独发作亦可与其他心血管疾病伴发，甚至突然发作致人猝死，临床上通常使用心电图诊断心律失常。因此，早发现心律失常并进行判别对预防心血管病引起猝死及提高心律失常预后管理具有重要意义。目前基于计算机辅助心电信号自动识别和诊断的研究引起人们的重视，但仍是一项具有挑战性的任务。首先，对原始心电信号缺乏有效滤波操作。由于心电信号微弱的性，里面参杂噪声成分多样，部分噪声与P波、T波类似，需要合理的分解并进行抑制。其次，心电信号分割方面，多以固定时间进行分割，虽然能减少数据量，但出现输入片段与这段时间的标签不一致情形；最后，现有分类方法很全面，但成万数据量导致设计网络深度大，出现调优难和梯度消失现象。为了准确高效的进行心律失常疾病的分类，目前主流的方法可以分为两大类，基于传统机器学习方法和基于深度学习方法。在传统方法中，有人提出了一种基于支持向量机的心跳分类方法。还有一些人提出基于一种利用聚类分析方法进行识别并诊断心电心律失常疾病。有人提出了基于决策阈值的贝叶斯网络心脏跳动分类方法，该方法将分类精度达到最优。然而，基于传统机器学习的方法对于人工特征非常依赖，需要用到相当多的病理学、信号学的专业知识，这样对算法的设计增加了难度，相应很难提取出高质量的特征，分类精度低下，极易引起误诊或漏诊。近年来，深度学习技术在模式识别应用中表现出了优异的性能。因此，基于深度学习相关技术的心电分类研究成为研究人员和工程师们关注的焦点。许多学者在利用深度学习技术进行心电分类的研究上做了大量的工作。有人提出了深度信念网络自动从ECG重采样中提取特征，DBN使用两种类型的限制波尔兹曼进行堆叠，使用两种算法对比度发散和持续对比度发散调整RBM参数。有人提出一种基于一维卷积神经网络的方法对5种类型的心律失常信号的分类。也有人使用2D-CNN对ECG心律失常分类，该方法最近在模式识别领域表现出突出的性能。还有部分学者提出了一种新的基于递归神经网络的患者特异性心电图分类算法，能从心电信号样本中学习时间相关性，对不同心律的心电节拍进行分类。尽管提高了分类准确性能，不可避免带来网络模型复杂，梯度消失和调优难等问题。发明内容本发明的目的是提供一种基于深度卷积残差网络的心律失常分类方法，解决了现有技术中存在的疾病分类准确度低的问题。本发明所采用的技术方案是，一种基于深度卷积残差网络的心律失常分类方法，具体按照以下步骤实施：步骤1、选取MIT-BIH心律失常数据库的心电数据；步骤2、对步骤1选取的心电数据进行预处理；步骤3、对步骤2预处理后的心电数据进行分割；构建分类网络模型；步骤4、利用步骤3分割的心电数据对网络模型进行训练；步骤5、将待测试的心电数据片段输入所述训练好的深度卷积残差网络模型，最终输出心电信号片段的分类结果。本发明的特点还在于：步骤2具体按照以下实施：步骤2.1、读取所选数据库中的原始心电数据；步骤2.2、利用小波9级分级特性进行噪声抑制；在分析离散化非平稳心电信号时，任意信号f可用多分辨率分析公式表示为：式中右边第一项是f在尺度空间的投影，是f的平滑近似，第二项是f在小波空间的投影，是对f的细节补充；j是任意尺度的开始，通常称cj，k为近似值或尺度系数，称dj，k为细节或小波系数；展开系数计算如下：使用Daubechies5小波基函数，对心电信号数据进行9尺度小波变换；然后使用软阈值函数对噪声进行抑除；其数学公式表示如下：其中w为尺度分解后的信号值，阈值λ满足σ为噪声标准差，N为信号长度；步骤2.3、心电信号的基线漂移情形采用零均值减法，就是将每一维滤波后的心电数据减去每一维的平均值即可得到干净的数据。步骤3中对步骤2预处理后的心电数据进行分割具体按照以下实施：3.1.1、获取R波峰位置和对应的标签；3.1.2、选取R波峰前144个采样点到后180个采样点作为一个节拍；3.1.3、分割后每个节拍重采样到250，作为后续网络模型的输入。步骤3中构建分类网络模型具体按照以下实施：步骤3.2.1、搭建基础的卷积神经网络；所述卷积神经网络与VGG网络的结构类似，由卷积结构和全连接层组成：卷积结构由4个21×1卷积的重复应用组成，每个卷积后跟一个批量归一化和一个ReLU激活函数进行运算，步长为1；所述后续的卷积结构由32个25×1卷积的重复应用组成，每个卷积层后跟一个批量归一化和一个ReLU激活函数进行运算，步长为1；全连接层用于对上一层的神经元进行全部连接，实现特征的非线性组合，是针对5种类别的分类，因此参数设置5；用激活函数softmax可将多分类的输出值转化为相对概率，这些值的累加和为1；步骤3.2.2、在所述的卷积神经网络的卷积层后添加残差块1，形成跳跃连接结构；公式如下：xl+1＝xl+F 其中，xl+1为第l+1层卷积层的卷积结果，xl为第l层卷积层的卷积结果，Wl为第l层卷积层的权重，F为残差部分；将这种残差块添加在卷积网络中，形成跳跃连接结构；步骤3.2.3、将残差块2添加至卷积神经网络中两层残差块1的后一层，再次形成跳跃连接结构，最终完成深度卷积残差网络的搭建。步骤4具体按照以下实施：步骤4.1、将步骤3处理后的心电节拍与对应的标签作为数据集；使用10折交叉验证来划分训练集和测试集，其中拿出每折的训练集来作为网络的输入，输入深度卷积残差网络，首先需要将分割后的数据作为数据集；将的数据集分成10个子集，每个子集所分布的数据量近似相等；用其中的9个子集作为网络模型的输入数据。步骤4.2、使用10折交叉验证划分的训练集数据对深度卷积残差网络进行训练：首先，将第一折中的9个训练子集输入网络模型，训练数据中每个节拍对应一个label；其中输入到深度卷积残差网络中的每个节拍大小为，输入的节拍需经过前后两层卷积操作、2个残差块1和1个残差块2；最后经过softmax激活函数对节拍进行5分类，输出的5分类概率值就是网络所预测出的结果；对于模型损失度量，是模型预测值与特定样本真实值的差值，当面对多分类或者多标签的任务时，评价度量可能会用到这两个，一个是交叉熵损失函数，另一个是稀疏交叉熵损失函数。选择后者衡量模型损失程度，是由于稀疏交叉熵损失函数用于目标结果是个整数，不需要存储一个矩阵，可减少内存空间的使用；公式如下：其中，n为样本个数，m为类别数，为预测输出值，y为实际值；再通过反向传播算法计算在卷积和池化运算过程中产生的参数来降低损失函数，反向传播计算所产生的参数就是网络的权重，记为W。其次，将其它9折心电数据输入深度卷积残差网络中，重复上一步的操作，不断的记录各折上损失值，最后各折损失值保持稳定后，对应权重W对应更新；等到所有折数据训练完后，即可得到各折上训练结果，得到训练好的深度卷积残差网络。步骤5具体按照以下实施：首先，采用每折除训练集外剩余一个子集的数据作为该折待测试的心电数据；然后，将每折待测试的心电节拍输入到训练好的深度卷积残差网络，经过2次卷积运算以及2次的残差模块1操作和1次残差模块2操作，最后通过softmax对测试集上每个节拍进行类别预测，输出最终的分类结果。本发明的有益效果是：本发明一种基于深度卷积残差网络的心律失常分类方法，解决了现有技术中存在的疾病分类准确度低的问题。在卷积神经网络模型中整合了残差网络结构，整体过程操作简单，易于实现，且具有较高的分类准确率。而且，两种残差结构引入到卷积网络中，有利于不丢失心电数据的特征信息并能更好的定位波峰特征，进一步会选择激活程度最高的元素特征，直接有助于分类。解决了网络深度大带来的梯度消失和调优难等问题，把分类性能提升到最佳，也是对算法鲁棒性的增强。附图说明图1为本发明一种基于深度卷积残差网络的心律失常分类方法的流程示意图；图2为本发明一种基于深度卷积残差网络的心律失常分类方法中基于残差块的结构示意图；图3为本发明一种基于深度卷积残差网络的心律失常分类方法中深度卷积残差网络的整体结构示意图；图4为本发明一种基于深度卷积残差网络的心律失常分类方法中残差块1结构示意图；图5为本发明一种基于深度卷积残差网络的心律失常分类方法中残差块2结构示意图；图6为本发明一种基于深度卷积残差网络的心律失常分类方法中深度卷积残差网络训练的流程示意图；图7为本发明一种基于深度卷积残差网络的心律失常分类方法中10折交叉验证示意图；图8为本发明一种基于深度卷积残差网络的心律失常分类方法中混淆矩阵显示的分类结果图；图9为本发明一种基于深度卷积残差网络的心律失常分类方法中性能指标结果图；图10为本发明一种基于深度卷积残差网络的心律失常分类方法与现有1维卷积神经网络的对比结果图；图11为本发明一种基于深度卷积残差网络的心律失常分类方法与现有1维卷积神经网络的准确率曲线与损失值曲线。具体实施方式下面结合附图和具体实施方式对本发明进行详细说明。本发明一种基于深度卷积残差网络的心律失常分类方法，如图1所示，具体按照以下步骤实施：步骤1、选取MIT-BIH心律失常数据库的心电数据；MIT-BIH心律失常数据库包含48条双导联ECG记录，每条记录长度30分钟左右，采样率360HZ，每条记录都有650000个点。第一通道信号是几乎所有记录含有的修改II导联；第二通道信号有V1,V2,V4,V5,具体取决于记录。所述的网络模型使用通道一数据。步骤2、对步骤1选取的心电数据进行预处理；将数据库的心电数据要进行预处理，包括读取心电数据、滤波处理、首尾不稳定数据的去除；步骤2具体按照以下实施：步骤2.1、读取所选数据库中的原始心电数据；步骤2.2、利用小波9级分级特性进行噪声抑制；在分析离散化非平稳心电信号时，任意信号f可用多分辨率分析公式表示为：式中右边第一项是f在尺度空间的投影，是f的平滑近似，第二项是f在小波空间的投影，是对f的细节补充；j是任意尺度的开始，通常称cj，k为近似值或尺度系数，称dj，k为细节或小波系数；展开系数计算如下：使用Daubechies5小波基函数，对心电信号数据进行9尺度小波变换；然后使用软阈值函数对噪声进行抑除；其公式表示如下：其中w为尺度分解后的信号值，阈值λ满足σ为噪声标准差，N为信号长度；步骤2.3、心电信号的基线漂移情形采用零均值减法，就是将每一维滤波后的心电数据减去每一维的平均值即可得到干净的数据。步骤3、对步骤2预处理后的心电数据进行分割，然后对心电片段进行重采样到250，构成心电数据片段数据集；构建分类网络模型，最先搭建基础的卷积神经网络，用于分析心电片段的特征；步骤3中对步骤2预处理后的心电数据进行分割具体按照以下实施：3.1.1、获取R波峰位置和对应的标签；3.1.2、选取R波峰前144个采样点到后180个采样点作为一个节拍；3.1.3、分割后每个节拍重采样到250，作为后续网络模型的输入。如图3所示，步骤3中构建分类网络模型具体按照以下实施：步骤3.2.1、搭建基础的卷积神经网络；所述卷积神经网络与VGG网络的结构类似，由卷积结构和全连接层组成：卷积结构由4个21×1卷积的重复应用组成，每个卷积后跟一个批量归一化和一个ReLU激活函数进行运算，步长为1；所述后续的卷积结构由32个25×1卷积的重复应用组成，每个卷积层后跟一个批量归一化和一个ReLU激活函数进行运算，步长为1；全连接层用于对上一层的神经元进行全部连接，实现特征的非线性组合，是针对5种类别的分类，因此参数设置5；用激活函数softmax可将多分类的输出值转化为相对概率，这些值的累加和为1；把两种结构的残差块添加到卷积神经网络中，形成深度卷积残差网络模型，具体包括：确定所述残差块1的结构单元；所述结构单元用于获取心电数据的特征信息并能更好的定位波峰特征，得到所谓的心电波段特征数据；确定所述残差块2的结构单元，所述结构单元用于选择激活程度最高的元素特征,形成深度残差网络模型的核心部分；如图2所示，基础残差结构构造图，步骤3.2.2、在所述的卷积神经网络的卷积层后添加残差块1，形成跳跃连接结构；公式如下：xl+1＝xl+F其中，xl+1为第l+1层卷积层的卷积结果，xl为第l层卷积层的卷积结果，Wl为第l层卷积层的权重，F为残差部分；将这种残差块添加在卷积网络中，形成跳跃连接结构；在卷积神经网络的卷积层后添加残差块1，形成跳跃连接结构，有利于不丢失心电数据的特征信息并能更好的定位波峰特征，相当于一种“软下采样”的方式，充分利用元素之间可以比较平滑的过渡；网络模型中残差块1的结构如图4所示，从结构图可看出，在主线上采用一层卷积操作与另一支的进行相加，最后进行ReLU激活，很好的将一些负权值进行滤除，减轻后面的特征信息冗余。步骤3.2.3、将残差块2添加至卷积神经网络中两层残差块1的后一层，再次形成跳跃连接结构，最终完成深度卷积残差网络的搭建。将残差块2添加至上述卷积神经网络中残差模块1的后一层，再次形成跳跃连接结构，用于对输入的特征信息进行提取，主要采取类似“硬下采样”的结构，能够选取激活程度高的特征，有助于去除冗余信息和后续的分类。最终完成深度卷积残差网络的搭建；残差块2如图5所示，具体过程如下：首先，确定所述残差块2。残差块2用于对输入的特征信息进行提取，主要采取类似“硬下采样”的结构，能构选取激活程度高的特征，有助于去除冗余信息和后续的分类。然后，采用跳跃连接进行融合信息。接着是使用ReLU激活函数提高特征的表达能力。最后将结果输送到最后卷积层。本发明的两种残差模块相当于“软硬下采样”的配合，充分利用这两种结构的特性，为特征的定位和提取以及后面的分类产生极好的效能。在如图3所示，设计的两种残差结构在该图的颜色深的残差结构部分。该图很好展示了完成心电信号分类需要进行的流程。步骤4、利用步骤3分割的心电数据对网络模型进行训练；如图6所示，步骤4具体按照以下实施：步骤4.1、将步骤3处理后的心电节拍与对应的标签作为数据集；针对心电数据集存在各类心跳数据不平衡性，使用10折交叉验证来划分训练集和测试集，其中拿出每折的训练集来作为网络的输入，输入深度卷积残差网络，如图7所示，首先需要将分割后的数据作为数据集；将的数据集分成10个子集，每个子集所分布的数据量近似相等；用其中的9个子集作为网络模型的输入数据。步骤4.2、使用10折交叉验证划分的训练集数据对深度卷积残差网络进行训练：首先，将第一折中的9个训练子集输入网络模型，训练数据中每个节拍对应一个label；其中输入到深度卷积残差网络中的每个节拍大小为，输入的节拍需经过前后两层卷积操作、2个残差块1和1个残差块2；最后经过softmax激活函数对节拍进行5分类，输出的5分类概率值就是网络所预测出的结果；对于模型损失度量，是模型预测值与特定样本真实值的差值，当面对多分类或者多标签的任务时，评价度量可能会用到这两个，一个是交叉熵损失函数，另一个是稀疏交叉熵损失函数。选择后者衡量模型损失程度，是由于稀疏交叉熵损失函数用于目标结果是个整数，不需要存储一个矩阵，可减少内存空间的使用；公式如下：其中，n为样本个数，m为类别数，为预测输出值，y为实际值；再通过反向传播算法计算在卷积和池化运算过程中产生的参数来降低损失函数，因为损失函数越小意味着我们的预测结果越接近于真实结果，反向传播计算所产生的参数就是网络的权重，记为W。其次，将其它9折心电数据输入深度卷积残差网络中，重复上一步的操作，不断的记录各折上损失值，最后各折损失值保持稳定后，对应权重W对应更新；等到所有折数据训练完后，即可得到各折上训练结果，得到训练好的深度卷积残差网络。深度卷积残差网络模型的最后模块包括一层卷积结构和分类结构，所述卷积层是对心电特征的高度分析，所述分类结构是最终分类结果的输出。步骤5、将待测试的心电数据片段输入所述训练好的深度卷积残差网络模型，最终输出心电信号片段的分类结果。步骤5具体按照以下实施：首先，采用每折除训练集外剩余一个子集的数据作为该折待测试的心电数据；然后，将每折待测试的心电节拍输入到训练好的深度卷积残差网络，经过2次卷积运算以及2次的残差模块1操作和1次残差模块2操作，最后通过softmax对测试集上每个节拍进行类别预测，输出最终的分类结果。得到各折测试集上心电节拍分类结果后，使用混淆矩阵来显示出分类模型在进行预测时会对哪部分产生混淆，可用于评价分类算法好坏。如图8所示，从该表中可看出，测试集为9943，在对角线上的数据为每个类别被正确分类数，非对角线上的数据为没被正确分类，这个占比非常小。对于测试总数为9943，N、L、R、A和V节拍误分类次数是相当少的，分别是31、32、15、8、16。对经过预处理后的待测试的心电数据片段输入训练好的深度卷积残差网络模型中；采用所述深度卷积残差模型依次进行卷积运算、归一化和ReLU等操作，最后利用softmax激活函数对每个节拍给出概率分数，输出所述的分类结果以及疾病类别。使用混淆矩阵表示实际类别和分类后的得到的结果，显示分类模型在进行预测时会对哪部分产生混淆，可用于评价分类算法的好坏；评价分类算法还需要准确度、灵敏度、精确度和特异度作为衡量标准。图9为本发明性能指标结果展示。从该表可看出，5个类别的分类准确率都接近100％；敏感度只有L是87.35％，其它类别的结果可观；在精确度方面，N与A的结果达到99.29与99.62，几乎是没有识别错误的；特异性结果表明，5种类型错误分类的情况是几乎没有的。对该表进一步分析可得，N、L、R、A和V节拍进行分类的平均准确率为99.59％、平均灵敏度为96.68％、平均精确度为96.84％、平均特异度为99.63％。总体的准确度达到98.96％，可知分类性能很突出。图10为本发明基于深度卷积残差网络与已有1维卷积神经网络对比结果图。该图中第二行是现有同类别的基于1维卷积神经网络的分类平均准确率和平均损失值，第三行是本发明的分类平均准确率和平均损失值，由此可以看出本发明基于深度卷积残差网络的心律失常分类方法的分类准确度高。图11是本文发明和已有1维卷积神经网络方法用在心律失常分类上的准率率曲线和损失曲线，红线代表本发明的实验数据结果。从图10的左图可以明显看出，在相同迭代数、学习率和批量下，本发明方法的精度曲线起步在0.7以上，到后面逐渐稳定在0.99附近。同时也反映出所提出的模型精度曲线收敛速度快于1维卷积神经网络模型，并且最终的分类精度远高于已有1D-CNN模型。从图10的左图不难看出，在相同学习率和批量下，虽然本发明方法损失曲线在开始时出现上升后下降的情形，但后续损失值逐渐下降并趋于0.05附近波动。同时该模型损失曲线收敛速度快于1D-CNN模型，并且最终的平均损失值也低于1维卷积神经模型。步骤5具体按照以下实施：首先，采用每折除训练集外剩余一个子集的数据作为该折待测试的心电数据；然后，将每折待测试的心电节拍输入到训练好的深度卷积残差网络，经过2次卷积运算以及2次的残差模块1操作和1次残差模块2操作，最后通过softmax对测试集上每个节拍进行类别预测，输出最终的分类结果。对经过预处理后的待测试的心电数据片段输入训练好的深度卷积残差网络模型中；采用深度卷积残差模型依次进行卷积运算、归一化和ReLU等操作，最后利用softmax激活函数对每个节拍给出概率分数，输出所述的分类结果以及疾病类别。将待分类的心电片段输入所述训练好的网络模型，得到分类结果，之后还包括：使用混淆矩阵表示实际类别和分类后的得到的结果，显示分类模型在进行预测时会对哪部分产生混淆，可用于评价分类算法的好坏；评价分类算法还需要准确度、灵敏度、精确度和特异度作为衡量标准。对于准确度表示正确分类样本的数量与测试样本总数的比值。公式如下：对于灵敏度表示在所有实际为正例样本中，被正确分类为心律失常病所占比例。公式如下：对于精确度表示在所有预测为心律失常样本中，被正确分类所占的比例。公式如下：对于特异度表示在所有实际为正常心律的样本中，预测正确为正常心律的样本所占比例。公式如下：其中各公式中，TP是真阳性，表示正确分类为4种心律失常病；TN是真阴性，表示是正确的分类为正常；FP是假阳性，表示不正确分类为4种心律失常病；FN是假阴性，表示不正确分类为正常。本发明一种基于深度卷积残差网络的心律失常分类方法，解决了现有技术中存在的疾病分类准确度低的问题。在卷积神经网络模型中整合了残差网络结构，整体过程操作简单，易于实现，且具有较高的分类准确率。而且，两种残差结构引入到卷积网络中，有利于不丢失心电数据的特征信息并能更好的定位波峰特征，进一步会选择激活程度最高的元素特征，直接有助于分类。解决了网络深度大带来的梯度消失和调优难等问题，把分类性能提升到最佳，也是对算法鲁棒性的增强。
