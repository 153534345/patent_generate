标题title
一种电磁控制的介入手术系统及方法
摘要abst
本发明公开了一种电磁控制的介入手术系统及方法，系统包括患者端和操作者端；操作者端是基于计算机图形学渲染技术和实时物理仿真方法构建的程序展示的虚拟手术环境，并由操纵杆等设备接收用户输入；患者端包括线圈阵列、磁性可控导丝、视觉输入设备、边缘计算设备和嵌入式控制设备。本发明首先是计算得到的各个线圈通过单位强度电流时的磁场矢量来构建磁控系统线性动力学方程的系数矩阵；再根据此系数矩阵，使用Moore‑Penrose广义逆进行线圈阵列电流值的实时求解。本发明由嵌入式系统模块动态准确地控制电流配置、进行外加磁场的生成，可远程操作受控导丝至指定位置，使医生免受手术环境下的辐射损伤从而提高手术效率。
权利要求书clms
1.一种电磁控制的介入手术系统，其特征在于：包括患者端和操作者端；所述患者端包括线圈阵列、磁性可控导丝、影像采集设备、边缘计算设备和嵌入式控制设备；所述线圈阵列，用于在所述磁性可控导丝前端产生所需偏转力，最终令所述磁性可控导丝偏转至操作者端指定的位置和角度；所述边缘计算设备，用于根据所述磁性可控导丝位置信息求解控制电流配置；所述嵌入式控制设备，用于根据所述边缘计算设备计算所得的控制电流配置，并根据求出的电流配置解向所述线圈阵列输出给定的电流值；所述操作者端包括：远程操作杆和图形工作站；所述远程操作杆，用于获取医生发出的述磁性可控导丝转向的输入指令，传入所述边缘计算设备中，结合述磁性可控导丝位置信息求解控制电流配置；所述图形工作站，用于通过“建模、模拟及渲染”工作流程将虚拟手术场景显示在屏幕上；所述患者端和操作者端之间通过计算机网络耦合，能基于多种网络协议进行通信。2.根据权利要求1所述的电磁控制的介入手术系统，其特征在于：所述线圈阵列中线圈个数为3个及以上，阵列为可扩展阵列；所述线圈无铁芯，每个线圈由单独的H桥通道驱动，能输出正负两向电流值，通过配置各个线圈所通的电流值，来产生所需电磁场，且每个线圈的位置和姿态均能自由调节；线圈阵列整体通过多路H桥模块驱动，每个线圈的电流值都单独进行控制。3.根据权利要求2所述的电磁控制的介入手术系统，其特征在于：所述H桥通道使用一对频率、电压相同、互补的高频脉冲来控制实际的电流输出方向和电流值，以实现对线圈电流大小和方向的快速精确调整。4.根据权利要求1所述的电磁控制的介入手术系统，其特征在于：所述磁性可控导丝，由磁性头部和无磁导丝两部分组成；所述磁性头部，为圆柱体，或者为半球与圆柱组合体；所述无磁导丝，是由弹性材料制作的管体，管体内填充有硬磁材料；所述硬磁材料在外加强磁场中沿轴向被磁化，在退磁后仍能保留磁性，磁滞曲线形状更宽。5.根据权利要求1-4任意一项所述的电磁控制的介入手术系统，其特征在于：所述磁性可控导丝，头部为磁性材料填充，外壁上设置有水凝胶。6.一种电磁控制的介入手术方法，其特征在于：边缘计算设备计算所得的控制电流配置，首先计算单个线圈在空间一点x的磁场强度，然后计算整个线圈阵列的磁场矢量；通过平衡态方程计算对磁性可控导丝所需要施加的力和需要生成的对应磁场强度，通过获得的各个线圈生成的磁场强度，构建关系矩阵A＝；通过奇异值矩阵分解方法A＝V∑WH得到关系矩阵的Moore-Penrose广义逆其中，V、∑、W分别通过标准奇异值矩阵分解方法得到的矩阵，V是3×3阶的幺正矩阵，∑是3×N阶非负实数对角矩阵，W是N×N阶幺正矩阵，H表示复矩阵的共轭转置操作，VH＝T；则磁控物理系统的线性稳态方程形式为：αF＝AI，其中α是一与磁性可控导丝弹性模量和磁化强度相关的常数系数，F是磁性可控导丝磁性前端受到的力或力矩组成的列向量，I是各个线圈的电流组成的列向量，A是此线性动力力学方程的关系矩阵；最后获得适合的电流配置解7.根据权利要求6所述的电磁控制的介入手术方法，其特征在于：所述计算单个线圈在空间一点x的磁场强度，分析线圈本体坐标系与世界坐标系的坐标变换关系，并找到平移变换矩阵T和旋转变换矩阵R，则从本体坐标系中xrel到世界坐标系的刚性变换矩阵为TR；作逆变换，得xrel＝-1x；计算本体坐标系中xrel处的磁场强度Brel在本体坐标系下的柱坐标表示，柱坐标系基底为ρ，z，其中，μ0是真空磁导率常数，a是线圈的半径，b是线圈高度的一半，n是单位高度线圈的匝数，I是流经线圈的电流，cel函数是广义完全椭圆积分，通过对函数参数进行特殊的取值cel函数可退化为常规完全和不完全椭圆积分；其中，kc，p，a，b为数学函数的4个参数，没有实际的物理量与之对应。8.根据权利要求6所述的电磁控制的介入手术方法，其特征在于：所述计算整个线圈阵列的磁场矢量；记线圈阵列中第i个线圈在阵列坐标系下位置x处生成的磁感应强度矢量为Bi，Ti和Ri分别为第i个线圈由本体坐标系到阵列坐标系的平移变换矩阵和旋转变换矩阵，xi是对应坐标位置在本体坐标系下的表示，满足关系x＝TiRixi；根据磁场的叠加原理，线圈阵列在x处生成的磁感应强度B为：9.一种电磁控制的介入手术方法，其特征在于：图形工作站通过“建模、模拟及渲染”将虚拟手术显示在屏幕上；首先通过视觉定位或实时物理仿真获取磁性可控导丝的几个预设控制点，利用C2连续性的插值方法确定磁性可控导丝的中心线插值函数；利用中心线，使用平行移动坐标系方法构建磁性可控导丝的管状模型。10.根据权利要求9所述的电磁控制的介入手术方法，其特征在于：所述插值函数，设Fi是一个插值函数，定义一条通过控制点pi-1、pi和pi+1的曲线；插值函数满足约束：Fi＝pi-1，Fi＝pi+1；对控制点pi和pi+1进行插值的曲线段Ci是通过混合这两个插值函数Fi和Fi+1来构造的；曲线段Ci为：其中
说明书desc
技术领域本发明属于结合可视化的计算机辅助手术技术领域，涉及一种人机交互与计算学图形学的建模、渲染、实时物理仿真系统及方法，特别涉及一种面向介入手术的磁控电流控制算法和手术系统。背景技术介入治疗是一种新兴的心血管病治疗方式，并迅速成为这一领域的流行治疗手段。文献定义介入治疗手术是指通过医学影像设备的导引，将特制的导管、导丝等精密医学器械引入人体，对体内病态进行诊断，对病灶进行局部治疗。其作为微创外科的一个分支已成为与传统内科、外科并列的医学的第三大支柱。另外，机器人技术、计算机技术和通信技术的广泛发展，极大地促进了相关技术在医学外科学中的应用。文献通过对相关技术的研究进行总结，指出计算机辅助方法可以为外科医生提供增强的灵活性、增强的可视化和触觉感知能力，增强手术的一致性，消除传统手术和介入器械的操作难点，提高介入手术的安全性。介入手术也存在明显弊端：医学影像导航设备会发射出X光，医生长时间暴露在X光辐射下会收到伤害；医生进行介入手术的操作能力非常依赖手术实践的经验，培养一名合格医生的难度大、成本高，且基于活体动物的训练存在生命伦理问题。特别的，传统的介入手术实施过程中的最大挑战是导丝前端的弯曲指向。使导丝前端在血管中向指定方向弯曲需要医生具备经过长期的手术训练所获得的经验与手感，因此，培养一名熟练的介入手术医生是一个长期且费用高昂的过程。计算机辅助系统控制的导丝与医生操作的导丝相比具备主动导向能力，目前面向介入手术的导丝操作有两种主流方法：通过机械传动方法进行控制和通过磁驱动进行无接触式控制。对于机械式传动控制的方法，文献介绍了一种远程导航系统，包括一个计算机控制的导丝和导航系统。该系统包括一个装有触摸屏监视器的操作模块、一个作为输入设备的操纵杆和一个由导丝机械驱动的病人模块。文献通过操纵杆和触摸屏对导丝进行操纵，通过机械传动模块实现导丝的轴向和旋转运动。文献从固体力学的第一原理出发，介绍了肌腱驱动的连续式机械手的力学模型，并在此基础上开发了一种可操纵的心导管。机械式传动控制的不足之处在于，由于导管的直径限制在毫米，使用机械结构很难实现对纤细导丝的精确控制。因此，磁驱动控制被认为是另一个更有应用前景的解决方案。目前，研究者们对磁场在介入手术中的应用进行研究并展示了磁控方法的可行性与广阔应用前景。文献提出了一种远程控制机器人导管系统，用于电生理测绘和射频消融。它由2个电脑控制的永磁体位于患者两侧，一个马达驱动导管前后移动。与机械方法相比，磁驱动导丝更灵活，可以制成比冠状动脉更小的导丝。与本发明相比，磁场的生成和驱动方式不同，相较于文献中利用的永磁体驱动，本发明中提出的动态电流控制方法精度更准确、反应更迅速。在磁场计算领域，目前已有成熟的商业软件可以使用，如ANSYS Maxwell和COMSOL。这些软件可以在模型网格上精确地计算任意拓扑结构的线圈阵列所产生的磁场从而分析其磁场特性，但是它们都基于有限元分析和有限差分法之类需要很大计算量的离散数值方法，求解一个场景的稳态磁场分布需要的计算时间往往多至数个小时，远远不能满足介入手术对动态磁场计算的实时性需求。参考文献卢旺盛,刘达,田增民,&amp;张大鹏..血管介入手术机器人的关键技术分析.生物医学工程研究,28,303–306.https://doi.org/10.19529/j.cnki.1672-6278.2009.04.017.Menaker,S.A.,Shah,S.S.,Snelling,B.M.,Sur,S.,Starke,R.M.,&amp;Peterson,E.C..Current applications and future perspectives of robotics incerebrovascular and endovascular neurosurgery.Journal of Neuro InterventionalSurgery,10,78–82.https://doi.org/10.1136/neurintsurg-2017-013284.Hasan,F.,&amp;Bonatti,J..Robotically assisted percutaneouscoronary intervention:Benefits to the patient and the cardiologist.ExpertReview of Cardiovascular Therapy,13,1165–1168.https://doi.org/10.1586/14779072.2015.1091725.Li,S.,Guo,J.,Wang,Q.,Meng,Q.,Chui,Y.P.,Qin,J.,&amp;Heng,P.A..Acatheterization-training simulator based on a fast multigrid solver.IEEEComputer Graphics and Applications,32,56–70.https://doi.org/10.1109/MCG.2012.32.Beyar,R.,Gruberg,L.,Deleanu,D.,Roguin,A.,Almagor,Y.,Cohen,S.,Kumar,G.,&amp;Wenderow,T..Remote-Control Percutaneous CoronaryInterventions.Journal of the American College of Cardiology,47,296–300.https://doi.org/10.1016/j.jacc.2005.09.024.Camarillo,D.B.,Milne,C.F.,Carlson,C.R.,Zinn,M.R.,&amp;Salisbury,J.K..Mechanics modeling of tendon-driven continuum manipulators.IEEETransactions on Robotics,24,1262–1273.https://doi.org/10.1109/TRO.2008.2002311.Ernst,S.,Ouyang,F.,Linder,C.,Hertting,K.,Stahl,F.,Chun,J.,Hachiya,H.,D.,Antz,M.,&amp;Kuck,K.H..Initial Experience with Remote CatheterAblation Using a Novel Magnetic Navigation System:Magnetic Remote CatheterAblation.Circulation,109,1472–1475.https://doi.org/10.1161/01.CIR.0000125126.83579.1B.E.Madenci and I.Guven.The Finite Element Method and Applicationsin Engineering UsingSpringer US,Boston,MA,2015.doi:10.1007/978-1-4899-7550-8.H.Kenneth,D.L.Dewhirst,D.E.Smith,and T.G.Byrom.The finite elementmethod for engineers.Wiley-Interscience,1995.Y.M.Tang,A.F.Zhou,and K.C.Hui.Comparison of FEM and BEM forinteractive object simulation.CAD Computer Aided Design,38:874–886,2006.doi:10.1016/j.cad.2006.04.014.发明内容为了解决介入手术中插管操作的导丝和导管转向难以操控的问题，本发明提供了一种电磁控制的介入手术系统与方法。本发明的系统所采用的技术方案是：一种电磁控制的介入手术系统，包括患者端和操作者端；所述患者端包括线圈阵列、磁性可控导丝、影像采集设备、边缘计算设备和嵌入式控制设备；所述线圈阵列，用于在所述磁性可控导丝前端产生所需偏转力，最终令所述磁性可控导丝偏转至操作者端指定的位置和角度；所述边缘计算设备，用于根据所述磁性可控导丝位置信息求解控制电流配置；所述嵌入式控制设备，用于根据所述边缘计算设备计算所得的控制电流配置，并根据求出的电流配置解向所述线圈阵列输出给定的电流值；所述操作者端包括：远程操作杆和图形工作站；所述远程操作杆，用于获取医生发出的述磁性可控导丝转向的输入指令，传入所述边缘计算设备中，结合述磁性可控导丝位置信息求解控制电流配置；所述图形工作站，用于通过“建模、模拟及渲染”工作流程将虚拟手术场景显示在屏幕上；所述患者端和操作者端之间通过计算机网络耦合，并基于TCP、UDP、MQTT等网络协议进行通信，在远程无线通信的应用场景使用5G通信技术实现低延迟、高可靠的物理层信号传输。本发明提供了一种电磁控制的介入手术方法，边缘计算设备计算所得的控制电流配置，首先计算单个线圈在空间一点x的磁场强度，然后计算整个无铁芯线圈阵列的磁场矢量；通过平衡态方程计算对磁性可控导丝所需要施加的力和需要生成的对应磁场强度，通过获得的各个线圈生成的磁场强度，构建关系矩阵A＝；通过奇异值矩阵分解方法A＝V∑WH得到关系矩阵的Moore-Penrose广义逆其中，V、Σ、W分别通过标准奇异值矩阵分解方法得到的矩阵，V是3×3阶的幺正矩阵，Σ是3×N阶非负实数对角矩阵，W是N×N阶幺正矩阵，H表示复矩阵的共轭转置操作，VH＝T；则磁控物理系统的线性稳态方程形式为：αF＝AI，其中α是一与磁性可控导丝弹性模量和磁化强度相关的常数系数，F是磁性可控导丝磁性前端受到的力或力矩组成的列向量，I是各个线圈的电流组成的列向量，A是此线性动力力学方程的关系矩阵；最后获得适合的电流配置解本发明还提供了一种电磁控制的介入手术方法，图形工作站通过“建模、模拟及渲染”将虚拟手术显示在屏幕上；首先通过视觉定位或实时物理仿真获取磁性可控导丝的几个关键预设控制点，这些关键预设控制点可以进一步利用C2连续性的插值方法确定磁性可控导丝的中心线插值函数；利用中心线，使用平行移动坐标系方法构建磁性可控导丝的管状模型。与现有技术相比，本发明具有如下的创新和优势：1.在远程应用此装置系统时的传输通信上利用5G技术的高可靠性连接和通信低延迟的优点，在边缘计算设备上执行闭环控制算法，在远程操作端进行指令的输入和可视化，在满足手术的实时性要求的同时，实现远程进行磁控介入手术的操作，使医生免于辐射损伤。2.使用基于空心线圈的磁场矢量生成方案来控制磁性导丝，与铁芯线圈相比，在适当降低所生成的磁场强度和磁场生成的范围的情况下，获得灵敏度高，无磁滞的优点，控制精度更高，操作更自由，控制的反应速度更快。3.使用闭环控制，充分考虑交互过程中磁性导丝的运动导致的位置变化，视觉输入设备能够实现快速准确的定位跟踪，使得对用户交互操作的定位准确、稳定，并根据用户输入指令及时调整导丝姿态位置。4.提出快速磁场计算和快速配置电流计算算法，与现有的有限元数值算法相比，计算速度更快，消耗的计算资源更少，使得系统能够满足稳定、高效的手术环境要求，在边缘计算设备上就可以满足实时性要求，降低系统的制造成本。5.结合虚拟现实技术和人机交互技术，实时展示介入手术的虚拟手术场景，将无法直接观察到的体内情况展示给医生，扩展医生的感官，增强远程手术的沉浸感。附图说明图1本发明实施例的系统原理图；图2本发明实施例的磁性可控导丝结构图；图3本发明实施例的方法流程图；图4本发明实施例的磁驱动导丝闭环控制流程图；图5本发明实施例的工程原型机虚拟手术与现实运动结合，进行远程同步磁控制实验图。具体实施方式为了便于本领域普通技术人员理解和实施本发明，下面结合附图及实施例对本发明作进一步的详细描述，应当理解，此处所描述的实施示例仅用于说明和解释本发明，并不用于限定本发明。请见图1，本发明提供的一种电磁控制的介入手术系统，包括患者端和操作者端；患者端包括线圈阵列、磁性可控导丝、影像采集设备、边缘计算设备和嵌入式控制设备；操作者端包括：远程操作杆和图形工作站；患者端和操作者端之间通过计算机网络耦合，并基于TCP、UDP、MQTT等网络协议进行通信，在远程无线通信的应用场景使用5G通信技术从而实现低延迟、高可靠的物理层信号传输。请见图2，本实施例的磁性可控导丝，由磁性头部和无磁导丝两部分构成。磁性头部，为圆柱体，或者为半球与圆柱组合体，为被磁化区域；无磁导丝，是由弹性材料制作的管体，管体内填充有硬磁材料，所填充材料的成分为20％体积的硬质磁性颗粒与软质材料的混合，在制备过程中外加强磁场进行磁化，使磁化方向沿着导丝轴向方向；填充区域被绝缘层包裹，其与血液接触的界面由水凝胶薄膜阻隔，水凝胶薄膜一方面增强了生物亲和性，减小活体的排异反应；另一方面减小进入与血管壁的摩擦，方便在血管中行进。磁性前端在外加磁场垂直与导丝轴向的分量作用下转向弯曲。本发明提出的导丝设计具备高弹性，在血管环境中能弯曲、不易折断、磁化强度高，外加较小的磁场就能控制其转向运动。本实施例的线圈阵列，用于在磁性可控导丝前端产生所需偏转力，最终令磁性可控导丝偏转至操作者端指定的位置和角度；线圈阵列中线圈个数为3个及以上，阵列为可扩展阵列；线圈无铁芯，每个线圈由单独的H桥通道驱动，能输出正负两向电流值，通过配置各个线圈所通的电流值，来产生所需电磁场，且每个线圈的位置和姿态均能自由调节；线圈阵列整体通过多路H桥电流模块驱动，每个线圈的电流值都单独进行控制。本实施例的H桥通道使用一对频率、电压相同、互补的高频脉冲来控制实际的电流输出方向和电流值，以实现对线圈电流大小和方向的快速精确调整。根据磁场的叠加原理，各个线圈所产生的磁场叠加为最终的所需磁场，在磁性导丝前端产生所需偏转力，最终令导丝偏转至操作者模块指定的位置和角度。本实施例的边缘计算设备，用于根据磁性可控导丝位置信息求解控制电流配置。本实施例的嵌入式控制设备，用于根据边缘计算设备计算所得的控制电流配置，基于H桥电流模块向线圈阵列输出给定的电流值。本实施例的远程操作杆，用于获取医生发出的述磁性可控导丝转向的输入指令，传入边缘计算设备中，结合述磁性可控导丝位置信息求解控制电流配置。本实施例的图形工作站，用于部署虚拟介入手术场景的展示程序，通过“建模、模拟及渲染”将虚拟手术显示在屏幕上。本发明的系统采用主从结构，并通过闭环控制来实现动态、准确、快速的远程磁控，并利用虚拟场景向医生展示患者体内手术状况。请见图3和图4，本发明提供的一种电磁控制的介入手术方法，中“导丝定位——电流求解——H桥输出——磁场生成——导丝弯曲——影像采集”是一完整的闭环控制流程，确保磁控操作准确快速地完成，图4不包含可视化，突出了闭环控制流程；可视化过程“建模——模拟——渲染”不属于闭环控制，但可以提供给操作者丰富的视觉信息，增强操作者远程操作时的沉浸感。在远程的应用场景下，基于5G网络技术带来的高可靠性连接和通信低延迟，也使得操作者免于手术环境下辐射损伤，既提高手术的安全性，又提高手术效率。其中电流求解的具体步骤为：步骤1：计算单个线圈在空间一点x的磁场强度；分析线圈本体坐标系与世界坐标系的坐标变换关系，并找到平移变换矩阵T和旋转变换矩阵R。则从本体坐标系中xrel到世界坐标系的刚性变换矩阵为TR。作逆变换，得xrel＝-1x。计算本体坐标系中xrel处的磁场强度Brel在本体坐标系下的柱坐标表示，a是线圈的半径，b是线圈高度的一半，n是单位高度线圈的匝数，I是流经线圈的电流，cel函数是广义完全椭圆积分，通过对函数参数进行特殊的取值cel函数可退化为常规完全和不完全椭圆积分；程序实现上，本实施例在实现中使用Bulirsch算法进行椭圆积分的快速数值计算。此处的kc,p,a,b是数学函数的4个参数，没有实际的物理量与之对应，只是在计算化简的数学推导过程中出现。步骤2：计算整个线圈阵列在空间x处的磁场矢量。线圈阵列是由数个线圈构成的整体，根据磁场的叠加原理，空间中某一点的磁感应强度矢量是所有线圈在同一点产生的磁感应强度矢量的和。记阵列中第i个线圈在阵列坐标系下位置x处生成的磁感应强度矢量为Bi，Ti和Ri分别为第i个线圈由本体坐标系到阵列坐标系的平移变换矩阵和旋转变换矩阵,xi是对应坐标位置在本体坐标系下的表示，满足关系x＝TiRixi。线圈阵列在x处生成的磁感应强度B为：步骤3：通过平衡态方程计算对导丝所需要施加的力和需要生成的对应磁场强度，并通过步骤1中计算所得的各个线圈生成的磁场强度，构建关系矩阵A＝。通过奇异值矩阵分解方法得到关系矩阵的Moore-Penrose广义逆，其中V、∑和W是通过奇异值矩阵分解得到的三个矩阵：A＝V∑WH其中，V、Σ、W分别通过标准奇异值矩阵分解方法得到的矩阵，V是3×3阶的幺正矩阵，Σ是3×N阶非负实数对角矩阵，W是N×N阶幺正矩阵，H是复矩阵的共轭转置操作，VH＝T。步骤4：磁控物理系统的线性稳态方程形式为：αF＝AI；其中α是一与被控导丝弹性模量和磁化强度相关的常数系数，F是导丝磁性前端受到的力或力矩组成的列向量，I是各个线圈的电流组成的列向量，A是此线性动力力学方程的关系矩阵。适合的电流配置解为：本实施例采用PWM控制的H桥电路模块控制特定极性和强度电流的输出。每个输出通道有两个信号引脚控制电流输出方向，PWM信号引脚的输入信号占空比控制输出电压。由于线圈的电阻是固定的，输出电路端部的电压与电流成正比。在本实施例采用的硬件实现中，输出电压与PWM占空比大致成线性关系。但在占空比很小的情况下，仍然是非线性的，需要进行修正。本实施例使用如下修正函数进行占空比的修正，使电流输出在电流输出范围内均为线性：其中，duty表示未修正的PWM信号的占空比，duty′表示修正后的PWM信号的占空比。本实施例的可视化过程“建模——模拟——渲染”不属于闭环控制，但可以提供给操作者丰富的视觉信息，增强操作者远程操作时的沉浸感。其具体步骤为：步骤1：通过视觉定位或实时物理仿真获取磁性可控导丝的几个关键控制点，这些关键控制点可以进一步利用C2连续性的插值方法确定导丝的中心线插值函数。插值函数的作用是定义一条经过三个连续控制点的曲线。设Fi是一个插值函数，它定义了一条通过控制点pi-1、pi和pi+1的曲线。插值函数满足约束：Fi＝pi+1；对控制点pi和pi+1进行插值的曲线段Ci是通过混合这两个插值函数Fi和Fi+1来构造的。本实施例对混合函数使用三角插值，即：其中步骤2：利用中心线，使用平行移动坐标系方法构建磁性可控导丝的管状模型。步骤3：根据构建得到的管状模型，使用实时物理进行力学上的模拟等分析工作。步骤4：使用实时渲染方法对模型进行渲染显示，如Blinn-Phong渲染。本实施例的原型图如图5所示，图5的上面4幅子图显示了虚拟场景中的虚拟血管和虚拟导丝的交互，特别地，是虚拟场景中血管模型和可变形的虚拟导丝模型的横截面图；下面的4幅子图是对磁性导丝前端的实拍图，磁性导丝前端在实时动态生成的外加磁场下进行弯曲转向。虚拟场景和物理实景的导丝的弯曲方向和程度在同一时刻相同，但是虚拟场景中包含了虚拟血管等物体，信息更丰富。应当理解的是，上述针对较佳实施例的描述较为详细，并不能因此而认为是对本发明专利保护范围的限制，本领域的普通技术人员在本发明的启示下，在不脱离本发明权利要求所保护的范围情况下，还可以做出替换或变形，均落入本发明的保护范围之内，本发明的请求保护范围应以所附权利要求为准。
