标题title
睡眠呼吸暂停与低通气事件识别方法
摘要abst
本发明公开了一种睡眠呼吸暂停与低通气事件识别方法，包括以下步骤：将滤波后的鼻腔压力信号进行分段，得到多个信号片段；提取每个信号片段的鼻腔压力特征，鼻腔压力特征为1×Y的峰峰值特征矩阵，抽取峰峰值特征矩阵中所有的非重复元素组成阈值候选矩阵,遍历阈值候选矩阵内所有元素,确定二元分割阈值。将峰峰值特征矩阵中元,素分为两部分，峰峰值特征矩阵中元素大于等于二元分割阈值的元素标记为正常模式，否则标记为呼吸暂停与低通气模式，建立时域二元分割模板，将时域二元分割模板中连续出现次数小于10次的呼吸暂停与低通气模式设置为正常模式；实现睡眠呼吸暂停与低通气事件识别。本发明减少人力劳动，为OSAHS的诊断提供可靠的标注工具与参考指导。
权利要求书clms
1.一种睡眠呼吸暂停与低通气事件识别方法，其特征在于，包括以下步骤：1）建立数据集：采集频率在X Hz以上的鼻腔压力信号，X=100,对鼻腔压力信号进行滤波，将滤波后的鼻腔压力信号进行分段，得到多个信号片段；2）提取每个信号片段的鼻腔压力特征，其中，鼻腔压力特征为1×Y的峰峰值特征矩阵，峰峰值特征矩阵与其相对应的信号片段在时间维度上对应，峰峰值特征矩阵中每个元素对应信号片段中1秒内的峰峰值；3）寻找二元分割阈值：抽取峰峰值特征矩阵中所有的非重复元素组成维度为1×Ngroup的阈值候选矩阵/＞，遍历阈值候选矩阵/＞内所有元素，分别构建每个元素/＞的方差/＞，并选择最大的方差/＞对应的元素/＞的值作为二元分割阈值/＞；4）利用峰峰值特征矩阵和二元分割阈值建立时域二元分割模板：将峰峰值特征矩阵中元素分为两部分，峰峰值特征矩阵中元素大于等于二元分割阈值/＞的元素标记为正常模式，峰峰值特征矩阵中元素小于二元分割阈值/＞的元素标记为呼吸暂停与低通气模式，建立时域二元分割模板，将时域二元分割模板中连续出现次数小于10次的呼吸暂停与低通气模式设置为正常模式；5）将正常模式和呼吸暂停与低通气模式作为模式识别标签，根据每个信号片段相对应的时域二元分割模板在该信号片段上进行标记，实现睡眠呼吸暂停与低通气事件识别。2.根据权利要求1所述的睡眠呼吸暂停与低通气事件识别方法，其特征在于，构建元素的方差/＞的方法包括：3-1）~3-4）：3-1）取出阈值候选矩阵中第/＞个元素/＞，/＞；3-2）将峰峰值特征矩阵中大于等于第个元素/＞的值的所有元素归为正常模式矩阵/＞；将峰峰值特征矩阵中所有小于第/＞个元素/＞的值的元素归为异常模式矩阵/＞；3-3）计算正常模式矩阵的先验概率/＞和异常模式矩阵/＞的先验概率/＞；计算正常模式矩阵/＞的均值/＞和异常模式矩阵/＞的均值/＞以及峰峰值特征矩阵的均值/＞；3-4）计算对应的方差/＞。3.根据权利要求1所述的睡眠呼吸暂停与低通气事件识别方法，其特征在于，在所述步骤2）中，Y为每个信号片段的时间。4.根据权利要求2所述的睡眠呼吸暂停与低通气事件识别方法，其特征在于，在步骤3-3）中：  为正常模式矩阵/＞中的元素个数，/＞为异常模式矩阵/＞中元素的个数。5.根据权利要求4所述的睡眠呼吸暂停与低通气事件识别方法，其特征在于，在步骤3-3）中，按照公式~计算正常模式矩阵的均值/＞和异常模式矩阵/＞的均值以及峰峰值特征矩阵的均值/＞；  为正常模式矩阵/＞中第/＞个元素，/＞为异常模式矩阵/＞中第/＞个元素，/＞为峰峰值特征矩阵中第/＞个元素。6.根据权利要求5所述的睡眠呼吸暂停与低通气事件识别方法，其特征在于，在步骤3-4）中， 。7.根据权利要求1所述的睡眠呼吸暂停与低通气事件识别方法，其特征在于，在所述步骤1）中，所述滤波为带通滤波。8.根据权利要求3所述的睡眠呼吸暂停与低通气事件识别方法，其特征在于，在所述步骤2）中，Y=30~60，其单位为秒。
说明书desc
技术领域本发明属于计算机辅助睡眠医学检测技术领域，具体来说涉及一种睡眠呼吸暂停与低通气事件识别方法。背景技术阻塞性睡眠呼吸暂停低通气综合征是一种睡眠疾病，是由于上气道的完全阻塞或部分阻塞，从而导致呼吸暂停或低通气的综合征。多导睡眠图是用于诊断OSAHS的重要生理数据，它记录了患者夜间睡眠期间的脑电图、心电图、血氧饱和度、鼻腔压力等多项重要生理信号。睡眠医学专家根据美国睡眠医学会出版的《AASM睡眠及其相关事件判读手册-规则、术语和技术规范》和患者夜间PSG，在时间维度上标记和分析睡眠呼吸暂停与低通气事件，计算并量化结果，最后提供详细的OSAHS分析报告。基于PSG的OSAHS诊断是全面的，但是它对医务人员的技术要求高，分析计算工作量大，检查报告产出时间长，完全依赖专业医务人员的目视判读的诊断方式难以适应需求量巨大的睡眠医学检测市场。因此，睡眠呼吸暂停与低通气事件的自动检测与模式识别可以解放人工劳动，可为诊断OSAHS提供有效参考与指导。目前，国内外已开展了睡眠呼吸暂停与低通气事件检测方法的研究并公布了相应成果。一种基于鼾声信号识别技术被提出来并应用于睡眠呼吸暂停与低通气事件的识别检测，该基于鼾声信号识别技术采用谱减法进行鼾声信号降噪，根据提取的声学特征识别鼾声，从而判定单帧信号是否包含睡眠呼吸暂停与低通气事件。一种基于血氧饱和度信号分析的睡眠呼吸暂停与低通气事件识别技术被提出，该睡眠呼吸暂停与低通气事件识别技术设计了单帧信号上血氧饱和度极差、矩估计、持续下降时间占比时域特征，通过分类器检测单帧信号是否有睡眠呼吸暂停与低通气事件。以上技术为睡眠呼吸暂停与低通气事件的识别提供了可靠的理论研究基础，然而，上述技术只能判别单帧信号内有无睡眠呼吸暂停与低通气事件的发生，不能实现单帧信号内睡眠呼吸暂停与低通气事件的模式识别、模式定位与次数统计，无法对识别结果进行符合AASM标准的模式标注与可视化，无法替代医生的专业手工标注，这将引发诊断结果不准确与信任问题。发明内容针对现有技术的不足，本发明的目的在于提供一种睡眠呼吸暂停与低通气事件识别方法，该睡眠呼吸暂停与低通气事件识别方法标记持续时间大于等于10秒的睡眠呼吸暂停与低通气事件，在单帧信号中睡眠呼吸暂停与低通气事件检测的基础上，实现符合AASM标准的睡眠呼吸暂停与低通气事件的模式识别与可视化，将提升睡眠呼吸暂停与低通气事件识别的准确性和可信任性，增强计算机辅助诊断的功能，提升睡眠呼吸暂停与低通气事件检测技术的实际应用价值，为睡眠医师对患者病情的诊断提供可靠的标注工具与参考指导。本发明的目的是通过下述技术方案予以实现的,一种睡眠呼吸暂停与低通气事件识别方法，包括以下步骤：1）建立数据集：采集频率在X Hz以上的鼻腔压力信号，X=100,对鼻腔压力信号进行滤波，将滤波后的鼻腔压力信号进行分段，得到多个信号片段；在所述步骤1）中，通过多导睡眠仪采集鼻腔压力信号;在所述步骤1）中，所述滤波为带通滤波;2）提取每个信号片段的鼻腔压力特征，其中，鼻腔压力特征为1×Y的峰峰值特征矩阵，峰峰值特征矩阵与其相对应的信号片段在时间维度上对应，峰峰值特征矩阵中每个元素对应信号片段中1秒内的峰峰值；在所述步骤2）中，Y为每个信号片段的时间;在所述步骤2）中，Y=30~60，其单位为秒;3）寻找二元分割阈值：抽取峰峰值特征矩阵中所有的非重复元素组成维度为1×Ngroup的阈值候选矩阵/＞，遍历阈值候选矩阵/＞内所有元素/＞，分别构建每个元素/＞的方差/＞，并选择最大的方差/＞对应的元素/＞的值作为二元分割阈值/＞;构建元素的方差/＞的方法包括：3-1）~3-4）：3-1）取出阈值候选矩阵中第/＞个元素/＞，/＞；3-2）将峰峰值特征矩阵中大于等于第个元素/＞的值的所有元素归为正常模式矩阵/＞；将峰峰值特征矩阵中所有小于第/＞个元素/＞的值的元素归为异常模式矩阵/＞；3-3）计算正常模式矩阵的先验概率/＞和异常模式矩阵/＞的先验概率/＞;在步骤3-3）中，为正常模式矩阵/＞中的元素个数，/＞为异常模式矩阵/＞中元素的个数;在步骤3-3）中，按照公式~计算正常模式矩阵的均值/＞和异常模式矩阵/＞的均值/＞以及峰峰值特征矩阵的均值/＞； 为正常模式矩阵/＞中第/＞个元素，/＞为异常模式矩阵/＞中第/＞个元素，/＞为峰峰值特征矩阵中第/＞个元素；3-4）计算对应的方差/＞；在步骤3-4）中， 4）利用峰峰值特征矩阵和二元分割阈值建立时域二元分割模板：将峰峰值特征矩阵中元素分为两部分，峰峰值特征矩阵中元素大于等于二元分割阈值/＞的元素标记为正常模式，峰峰值特征矩阵中元素小于二元分割阈值/＞的元素标记为呼吸暂停与低通气模式，建立时域二元分割模板，将时域二元分割模板中连续出现次数小于10次的呼吸暂停与低通气模式设置为正常模式；5）将正常模式和呼吸暂停与低通气模式作为模式识别标签，根据每个信号片段相对应的时域二元分割模板在该信号片段上进行标记，实现睡眠呼吸暂停与低通气事件识别。本发明的有益效果如下：1.利用睡眠呼吸暂停与低通气事件发生时的鼻腔压力信号的峰峰值变化特性，提取峰峰值特征矩阵，利用峰峰值特征矩阵建立时域二元分割模板，减少二元分割阈值的遍历次数；2.使用时域信号二元分割方法即可实现睡眠呼吸暂停与低通气事件模式的高精度识别；3.本发明对睡眠呼吸暂停与低通气事件识别结果可视化，减少人力劳动，为OSAHS的诊断提供可靠的标注工具与参考指导。附图说明图1为单实例的模式识别标签建立过程；图2为睡眠呼吸暂停与低通气事件识别方法和由睡眠医学专家标记的测试结果可视化图，其中，为信号片段的鼻腔压力信号，为鼻腔压力特征，为时域二元分割模板，为由睡眠医学专家进行的标注，为方差和元素/＞的关系曲线。具体实施方式下面结合具体实施例进一步说明本发明的技术方案。实施例1一种睡眠呼吸暂停与低通气事件识别方法，包括以下步骤：1）建立数据集：通过多导睡眠仪采集一整晚频率为200Hz的鼻腔压力信号，根据AASM标准对鼻腔压力信号进行带通滤波，将带通滤波后的一整晚的鼻腔压力信号进行分段，得到多个信号片段；2）提取每个信号片段的鼻腔压力特征，其中，鼻腔压力特征为1×Y的峰峰值特征矩阵，Y为每个信号片段的时间，其单位为秒，Y=60，峰峰值特征矩阵与其相对应的信号片段在时间维度上对应，峰峰值特征矩阵中每个元素对应信号片段中1秒内的峰峰值；3）寻找二元分割阈值：抽取峰峰值特征矩阵中所有的非重复元素组成维度为1×Ngroup的阈值候选矩阵/＞，遍历阈值候选矩阵/＞内所有元素/＞，分别构建每个元素/＞的方差/＞，并选择最大的方差/＞对应的元素/＞的值作为二元分割阈值/＞;构建元素的方差/＞的方法包括：3-1）~3-4）：3-1）逐个取出阈值候选矩阵中第/＞个元素/＞，/＞；3-2）将峰峰值特征矩阵中大于等于第个元素/＞的值的所有元素归为正常模式矩阵/＞；将峰峰值特征矩阵中所有小于第/＞个元素/＞的值的元素归为异常模式矩阵/＞；3-3）计算正常模式矩阵的先验概率/＞和异常模式矩阵/＞的先验概率/＞;为正常模式矩阵/＞中的元素个数，/＞为异常模式矩阵/＞中元素的个数;按照公式~计算正常模式矩阵的均值/＞和异常模式矩阵/＞的均值以及峰峰值特征矩阵的均值/＞；   为正常模式矩阵/＞中第/＞个元素，/＞为异常模式矩阵/＞中第/＞个元素，/＞为峰峰值特征矩阵中第/＞个元素；3-4）计算对应的方差/＞： 4）利用峰峰值特征矩阵和二元分割阈值建立时域二元分割模板：将峰峰值特征矩阵中元素分为两部分，峰峰值特征矩阵中元素大于等于二元分割阈值/＞的元素标记为正常模式，峰峰值特征矩阵中元素小于二元分割阈值/＞的元素标记为呼吸暂停与低通气模式，建立时域二元分割模板，将时域二元分割模板中连续出现次数小于10次的呼吸暂停与低通气模式设置为正常模式；5）将正常模式和呼吸暂停与低通气模式作为模式识别标签，根据每个信号片段相对应的时域二元分割模板在该信号片段上进行标记，实现睡眠呼吸暂停与低通气事件识别：将每段连续的呼吸暂停与低通气模式识别为一个睡眠呼吸暂停与低通气事件。实施例2随机选取按照睡眠呼吸暂停与低通气事件识别方法获得的1个信号片段，将该信号片段分别按照实施例1中睡眠呼吸暂停与低通气事件识别方法进行操作和由睡眠医学专家根据《AASM睡眠及其相关事件判读手册-规则、术语和技术规范》进行标记，如图1所示，图1的为该信号片段的鼻腔压力信号；图1的为与图1的相对应的鼻腔压力特征；图1的为与图1的相对应的时域二元分割模板；图1的为由睡眠医学专家根据《AASM睡眠及其相关事件判读手册-规则、术语和技术规范》进行的标签，其中，在图1的和中，数值为1对应的时间部分为呼吸暂停与低通气模式，数值为0对应的时间部分为正常模式。图1的为方差和元素/＞的关系曲线，选取最大的方差/＞对应的/＞作为二元分割阈值/＞。实施例3随机选取睡眠呼吸暂停与低通气事件识别方法获得的16个信号片段，将16个信号片段分别按照实施例1中睡眠呼吸暂停与低通气事件识别方法进行操作和由睡眠医学专家根据《AASM睡眠及其相关事件判读手册-规则、术语和技术规范》进行标记，如图2所示，其中，鼻腔压力信号波形为鼻腔压力信号带通滤波后获得的信号片段。每个信号片段内包含1至3个睡眠呼吸暂停与低通气事件。图2中横坐标代表信号片段的时间，纵坐标代表信号片段的鼻腔压力信号；每个信号片段中鼻腔压力信号波形上方的点划线对应为睡眠呼吸暂停与低通气事件识别方法识别的呼吸暂停与低通气模式所对应的时间，其余时间被识别为正常模式对应的时间，每个鼻腔压力信号波形下方的星形点划线对应的时间是由睡眠医学专家标记的睡眠呼吸暂停与低通气事件的时间，其余时间被睡眠医学专家标记为正常事件时间。因此，星形点划线和点划线在横坐标上重合的部分越多，结果越准确。通过上述可知，本发明睡眠呼吸暂停与低通气事件识别方法可将这些信号片段正确地分割为睡眠呼吸暂停与低通气事件和正常事件，当一个信号片段内包含多次睡眠呼吸暂停与低通气事件时，本发明睡眠呼吸暂停与低通气事件识别方法也能准确地识别与标记，并且重合部分相比于睡眠医学专家标注部分达到90%，证明了本发明睡眠呼吸暂停与低通气事件识别方法可被有效应用于睡眠呼吸暂停与低通气事件的识别。以上对本发明做了示例性的描述，应该说明的是，在不脱离本发明的核心的情况下，任何简单的变形、修改或者其他本领域技术人员能够不花费创造性劳动的等同替换均落入本发明的保护范围。
