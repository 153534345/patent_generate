标题title
心电信号分类方法、系统、计算机设备以及可读存储介质
摘要abst
本发明公开了一种心电信号分类方法、系统、计算机设备以及可读存储介质。其中，针对心电信号通过卷积后造成的冗余问题，本发明提出了一种新颖的ECA模块，来对特征通道进行权重分析，优化网络模型；针对ECG分类中的类别不平衡问题，本发明设计了一种权重分析方法，为提高少数类别分类的准确率提供了一条可行的途径。在此基础上，本发明方法构建了包括卷积神经网络模块、ECA模块以及密集模块的心电分类模型，通过所提心电分类模型，有效地提高了心电信号分类的准确度。与近年来同类型模型相比，本发明方法在准确度、特异性和F1等指标上均有了较大的提升，从而证明了本发明方法的有效性。
权利要求书clms
1.一种带有类别权重的卷积高效通道注意力心电信号分类方法，其特征在于，包括如下步骤：步骤1. 获取心电信号数据，并进行预处理；步骤2. 将预处理后的心电信号数据进行数据集切分，并切分为训练集以及测试集；定义训练集与测试集的切分比例为τ；根据数据集的切分比例τ对不同类别的心电信号进行加权处理，如公式所示；其中，CWc表示第c类样本的权重；N表示样本的类别数量，nc表示第c类样本的数量，表示向上取整；在下述步骤3中心电分类模型训练的同时，对不同类别的心电信号进行权重分配；步骤3. 构建心电分类模型；心电分类模型包括卷积神经网络模块、ECA模块以及密集模块；其中，卷积神经网络模块、ECA模块以及密集模块依次连接；卷积神经网络模块包括六个一维卷积层，各个一维卷积层依次连接；在每个一维卷积层之后依次放置了批归一化层、Relu激活层以及池化层；ECA模块包括全局平均池化层、自适应K值计算模块、一维卷积层、Relu函数层以及元素积函数运算模块，输入的特征图在ECA模块的处理过程如下：首先输入的特征图到达全局平均池化层执行全局平均池化处理，得到通道维数C，然后将通道维数C输入到自适应K值计算模块，计算得到自适应K值；再将自适应K值应用于一维卷积层中，作为一维卷积的卷积核，从而实现跨通道交互，并通过Relu函数层的Relu激活函数计算得到通道权重；最后将通道权重以及输入的特征图一并输入到元素积函数运算模块中，并进行相乘运算，最终输出加权后的特征图，即注意力机制增强后的特征图；密集模块包括一个展平层、两个全连接层以及一个softmax分类层；步骤4. 利用划分的训练集与测试集对构建的心电分类模型进行训练及测试；心电分类模型的训练过程为：首先将训练集中带有类别权重的心电信号输入到卷积神经网络模块进行六次一维卷积，在每次一维卷积后，依次进行批归一化、Relu激活以及最大池化处理；然后，将由卷积神经网络模块输出的特征图通过ECA模块进行筛选加权处理，并得到加权后的特征图，并通过展平层将输出的特征图一维化；紧接着，将一维化后的特征通过全连接层连接所有特征进行非线性变化，将学到的分布式特征表示映射到样本的标记空间，输出给softmax分类器，做最终分类预测输出；模型训练完成后，利用测试集中的数据对训练好的心电分类模型进行测试；步骤5. 对于待识别的心电信号，首先对心电信号按照步骤1进行预处理操作，然后利用训练及测试好的心电分类模型进行分类处理，得到心电信号分类结果。2.根据权利要求1所述的带有类别权重的卷积高效通道注意力心电信号分类方法，其特征在于，所述自适应K值计算模块中，自适应K值的计算公式如下：；其中，就是映射函数，赋值给K；γ、b是映射函数的参数，分别设置为2和1，|·|odd表示最接近·的最近奇数。3.根据权利要求1所述的带有类别权重的卷积高效通道注意力心电信号分类方法，其特征在于，所述卷积神经网络模块中：每个一维卷积层的卷积核大小依次设置为11、9、7、5、3、1，每个一维卷积层中的滤波器数量依次为32、64、64、128、128、256，每个一维卷积层的步长均为1；每个一维卷积层后的池化层均采用最大池化层，其中最大池化层的步长设置为2。4.根据权利要求1所述的带有类别权重的卷积高效通道注意力心电信号分类方法，其特征在于，所述密集模块中：两个全连接层的滤波器数量设置为256、128，softmax分类器的分类数设置为类别数量。5.根据权利要求1所述的带有类别权重的卷积高效通道注意力心电信号分类方法，其特征在于，所述步骤1具体为：步骤1.1. 从心律失常数据库中读取心电记录；步骤1.2. 采用离散小波变换法对心电记录中的心电信号进行去噪处理；步骤1.3. 对去噪后的心电记录进行心拍分割处理，得到多个独立新拍，即心电信号；步骤1.4. 将心电信号进行标准化处理。6.根据权利要求5所述的带有类别权重的卷积高效通道注意力心电信号分类方法，其特征在于，所述步骤1.3具体为：心拍分割时，首先判断心电信号R峰位置，并以R峰为中心，向R峰的前后方各取T1个和T2个采样点，将T1+T2+1个采样点作为一个独立心拍；T1以及T2均为自然数。7.一种带有类别权重的卷积高效通道注意力心电信号分类系统，其特征在于，包括：预处理模块，用于对获取的心电信号数据进行预处理；数据集切分模块，用于将预处理后的心电信号数据进行数据集切分，并切分为训练集以及测试集；定义训练集与测试集的切分比例为τ；根据数据集的切分比例τ对不同类别的心电信号进行加权，如公式所示； 其中，CWc表示第c类样本的权重；N表示样本的类别数量，nc表示第c类样本的数量，表示向上取整；在下述步骤3中心电分类模型训练的同时，对不同类别的心电信号进行权重分配；模型构建模块，用于构建心电分类模型；心电分类模型包括卷积神经网络模块、ECA模块以及密集模块；其中，卷积神经网络模块、ECA模块以及密集模块依次连接；卷积神经网络模块包括六个一维卷积层，各个一维卷积层依次连接；在每个一维卷积层之后依次放置了批归一化层、Relu激活层以及池化层；ECA模块包括全局平均池化层、自适应K值计算模块、一维卷积层、Relu函数层以及元素积函数运算模块；输入的特征图在ECA模块的处理过程如下：首先输入的特征图到达全局平均池化层执行全局平均池化处理，得到通道维数C，然后将通道维数C输入到自适应K值计算模块，计算得到自适应K值；再将自适应K值应用于一维卷积层中，作为一维卷积的卷积核，从而实现跨通道交互，并通过Relu函数层的Relu激活函数计算得到通道权重；最后将通道权重以及输入的特征图一并输入到元素积函数运算模块中并进行相乘运算，输出加权后的特征图即注意力机制增强后的特征图；密集模块包括一个展平层和两个全连接层以及一个softmax分类层；模型训练及测试模块，用于根据划分的训练集与测试集对构建的心电分类模型进行训练及测试；心电分类模型的训练过程为：首先将训练集中带有类别权重的心电信号输入到卷积神经网络模块进行六次一维卷积，在每次一维卷积后，依次进行批归一化、Relu激活以及最大池化处理；然后，将由卷积神经网络模块输出的特征图通过ECA模块进行筛选加权处理，并得到加权后的特征图，并通过展平层将输出的特征图一维化；紧接着，将一维化后的特征通过全连接层连接所有特征进行非线性变化，将学到的分布式特征表示映射到样本的标记空间，输出给softmax分类器，做最终分类预测输出；模型训练完成后，利用测试集中的数据对训练好的心电分类模型进行测试；分类预测模块，用于根据训练及测试好的心电分类模型进行分类处理，得到心电信号分类结果；其中，对于待识别的心电信号，首先对心电信号按照进行预处理操作。8.一种计算机设备，包括存储器和一个或多个处理器，所述存储器中存储有可执行代码，其特征在于，所述处理器执行所述可执行代码时，实现如权利要求1至6任一项所述的带有类别权重的卷积高效通道注意力心电信号分类方法。9.一种计算机可读存储介质，其上存储有程序，其特征在于，该程序被处理器执行时，实现如权利要求1至6任一项所述的带有类别权重的卷积高效通道注意力心电信号分类方法。
说明书desc
技术领域本发明涉及一种心电信号分类方法、系统、计算机设备以及可读存储介质。背景技术心律失常因其高发病率和高致死率，严重地危害着人类的健康。因此，及早、正确地诊断心律失常，对于患有心律失常的患者具有十分重要的意义。在临床医疗中，常规的心律失常诊断工作需要花费大量的时间和精力，因为大多数患者的心电波形都会有所不同，所以大部分诊断工作都是依靠专业医生来进行。然而，在实际工作中，由于医师的经验水平不同以及身体状态也都容易受到影响，因此，即便是相同的心电信号也可能会诊断出不同的结果。可见，传统的人工检测方法不仅费时费力，而且容易出现差错，已经无法满足当前的情况。因此，急需提出一种高效、准确的诊断心律失常信号的计算机辅助诊断方法。随着计算机技术的高速发展，人们已经对自动ECG分类问题进行了积极的研究。各种算法在心电信号识别中得到了广泛的应用，主要分为：机器学习和深度学习方法。各种机器学习方法已经被研究人员运用到心电疾病检测中，如支持向量机、随机森林和K-近邻等。传统机器学习算法在对心电信号的识别时存在如下问题：1). 面对不同种类的数据集，如何准确高效地提取特征；2). 分类结果依赖于提取的特征；3). 特征的提取依赖人工，效率低下；4). 分类结果多数情况下较差。深度学习方法在性能方面显示出很大的优势。不同于传统的机器学习算法，深度学习方法具有良好的泛化能力，还能够自动进行特征提取，因而无需人工操作。目前大多数心电图识别方法采用卷积神经网络，如专利文献1公开了一种短时训练卷积神经网络的心电信号分类方法，专利文献2公开了一种基于深度卷积神经网络的心电信号分类方法。然而，目前的卷积神经网络在对心电图识别时存在如下缺陷：1. 心电信号卷积运算后转换为多个等权重的特征通道，虽然会得到丰富的信息，但是并不是所有的通道都对最终的分类结果有影响，容易造成信息冗余，影响最终的分类结果。2. 目前进行心电信号分类训练所使用的数据库多为MIT-BIH数据库和AHA数据库等。由于罕见疾病样本少，正常样本数据多，因此现有数据库都存在数据不平衡问题。当使用这些不平衡数据集进行分类时，容易产生以下问题：1). 当某类样本占很大比例时，会产生降低训练效率负面影响；2). 对数量较少的异常样本类别的分类结果较差。参考文献专利文献1 中国发明专利申请 公开号 CN 114451898 A，公开日期：2022.05.10；专利文献2 中国发明专利申请 公开号 CN 113768515 A，公开日期：2021.12.10。发明内容本发明的目的在于提出一种带有类别权重的卷积高效通道注意力心电信号分类方法，以解决心电信号通过卷积运算后造成的多特征通道冗余问题以及数据库不平衡影响最终分类结果问题，从而提高心电信号分类准确度。本发明为了实现上述目的，采用如下技术方案：一种带有类别权重的卷积高效通道注意力心电信号分类方法，包括如下步骤：步骤1. 获取心电信号数据，并进行预处理；步骤2. 将预处理后的心电信号数据进行数据集切分，并切分为训练集以及测试集；定义训练集与测试集的切分比例为τ；根据数据集的切分比例τ对不同类别的心电信号进行加权，如公式所示；其中，CWc表示第c类样本的权重；N表示样本的类别数量，nc表示第c类样本的数量，表示向上取整；在下述步骤3中心电分类模型训练的同时，对不同类别的心电信号进行权重分配；步骤3. 构建心电分类模型；心电分类模型包括卷积神经网络模块、ECA模块以及密集模块；其中，卷积神经网络模块、ECA模块以及密集模块依次连接；卷积神经网络模块包括六个一维卷积层，各个一维卷积层依次连接；在每个一维卷积层之后依次放置了批归一化层、Relu激活层以及池化层；ECA模块包括全局平均池化层、自适应K值计算模块、一维卷积层、Relu函数层以及元素积函数运算模块；输入的特征图在ECA模块的处理过程如下：首先输入的特征图到达全局平均池化层执行全局平均池化处理，得到通道维数C，然后将通道维数C输入到自适应K值计算模块，计算得到自适应K值；再将自适应K值应用于一维卷积层中，作为一维卷积的卷积核，从而实现跨通道交互，并通过Relu函数层的Relu激活函数计算得到通道权重；最后将通道权重以及输入的特征图一并输入到元素积函数运算模块中并进行相乘运算，输出加权后的特征图即注意力机制增强后的特征图；密集模块包括一个展平层、两个全连接层以及一个softmax分类层；步骤4. 利用划分的训练集与测试集对构建的心电分类模型进行训练及测试；心电分类模型的训练过程为：首先将训练集中带有类别权重的心电信号输入到卷积神经网络模块进行六次一维卷积，在每次一维卷积后，依次进行批归一化、Relu激活以及最大池化处理；然后，将由卷积神经网络模块输出的特征图通过ECA模块进行筛选加权处理，并得到加权后的特征图，并通过展平层将输出的特征图一维化。紧接着，将一维化后的特征通过全连接层连接所有特征进行非线性变化，将学到的分布式特征表示映射到样本的标记空间，输出给softmax分类器，做最终分类预测输出。模型训练完成后，利用测试集中的数据对训练好的心电分类模型进行测试；步骤5. 对于待识别的心电信号，首先对心电信号按照步骤1进行预处理操作，然后利用训练及测试好的心电分类模型进行分类处理，得到心电信号分类结果。此外，本发明还提出了一种与上述带有类别权重的卷积高效通道注意力心电信号分类方法相对应的计算机设备，该计算机设备包括存储器和一个或多个处理器。所述存储器中存储有可执行代码，所述处理器执行所述可执行代码时，用于实现上面述及的带有类别权重的卷积高效通道注意力心电信号分类方法。此外，本发明还提出了一种与上述带有类别权重的卷积高效通道注意力心电信号分类方法相对应的计算机可读存储介质，其上存储有程序；该程序被处理器执行时，用于实现上面述及的带有类别权重的卷积高效通道注意力心电信号分类方法。此外，本发明还提出了一种与带有类别权重的卷积高效通道注意力心电信号分类方法相对应的带有类别权重的卷积高效通道注意力心电信号分类系统，其技术方案如下：一种带有类别权重的卷积高效通道注意力心电信号分类系统，包括：预处理模块，用于对获取的心电信号数据进行预处理；数据集切分模块，用于将预处理后的心电信号数据进行数据集切分，并切分为训练集以及测试集；定义训练集与测试集的切分比例为τ；根据数据集的切分比例τ对不同类别的心电信号进行加权，如公式所示；其中，CWc表示第c类样本的权重；N表示样本的类别数量，nc表示第c类样本的数量，表示向上取整；在下述步骤3中心电分类模型训练的同时，对不同类别的心电信号进行权重分配；模型构建模块，用于构建心电分类模型；心电分类模型包括卷积神经网络模块、ECA模块以及密集模块；其中，卷积神经网络模块、ECA模块以及密集模块依次连接；卷积神经网络模块包括六个一维卷积层，各个一维卷积层依次连接；在每个一维卷积层之后依次放置了批归一化层、Relu激活层以及池化层；ECA模块包括全局平均池化层、自适应K值计算模块、一维卷积层、Relu函数层以及元素积函数运算模块；输入的特征图在ECA模块的处理过程如下：首先输入的特征图到达全局平均池化层执行全局平均池化处理，得到通道维数C，然后将通道维数C输入到自适应K值计算模块，计算得到自适应K值；再将自适应K值应用于一维卷积层中，作为一维卷积的卷积核，从而实现跨通道交互，并通过Relu函数层的Relu激活函数计算得到通道权重；最后将通道权重以及输入的特征图一并输入到元素积函数运算模块中并进行相乘运算，输出加权后的特征图即注意力机制增强后的特征图；密集模块包括一个展平层、两个全连接层以及一个softmax分类层；模型训练及测试模块，用于根据划分的训练集与测试集对构建的心电分类模型进行训练及测试；心电分类模型的训练过程为：首先将训练集中带有类别权重的心电信号输入到卷积神经网络模块进行六次一维卷积，在每次一维卷积后，依次进行批归一化、Relu激活以及最大池化处理；然后，将由卷积神经网络模块输出的特征图通过ECA模块进行筛选加权处理，并得到加权后的特征图，并通过展平层将输出的特征图一维化。紧接着，将一维化后的特征通过全连接层连接所有特征进行非线性变化，将学到的分布式特征表示映射到样本的标记空间，输出给softmax分类器，做最终分类预测输出。模型训练完成后，利用测试集中的数据对训练好的心电分类模型进行测试；分类预测模块，用于根据训练及测试好的心电分类模型进行分类处理，得到心电信号分类结果；其中，对于待识别的心电信号，首先对心电信号按照进行预处理操作。此外，本发明还提出了一种与上述带有类别权重的卷积高效通道注意力心电信号分类方法相对应的计算机设备，该计算机设备包括存储器和一个或多个处理器。所述存储器中存储有可执行代码，所述处理器执行所述可执行代码时，用于实现上面述及的带有类别权重的卷积高效通道注意力心电信号分类方法。此外，本发明还提出了一种与上述带有类别权重的卷积高效通道注意力心电信号分类方法相对应的计算机可读存储介质，其上存储有程序；该程序被处理器执行时，用于实现上面述及的带有类别权重的卷积高效通道注意力心电信号分类方法。本发明具有如下优点：如上所述，本发明述及了一种带有类别权重的卷积高效通道注意力心电信号分类方法，其中，针对心电信号通过卷积后造成的冗余问题，本发明提出了一种新颖的ECA模块，来对特征通道进行权重分析，优化网络模型；针对ECG分类中的类别不平衡问题，本发明设计了一种权重分析方法，为提高少数类别分类的准确率提供了一条可行的途径，在此基础上，本发明方法还构建了包括卷积神经网络模块、ECA模块以及密集模块的心电分类模型，通过该模型，有效地提高了心电信号分类的准确度。与近年来同类型模型相比，本发明方法在准确度、特异性和F1等指标上均有了较大的提升，证明了本发明方法的有效性。附图说明图1为本发明实施例中带有类别权重的卷积高效通道注意力心电信号分类的流程框图。图2为本发明实施例中带有类别权重的卷积高效通道注意力心电信号分类的模型图。图3为本发明实施例中ECA模型的示意图。图4为本发明实施例中CNN-ECA模型在AAMI组的各类别ROC曲线图。图5为本发明实施例中CNN-ECA模型在Common组的各类别ROC曲线图。具体实施方式下面结合附图以及具体实施方式对本发明作进一步详细说明：如图1和图2所示，本发明实施例述及了一种带有类别权重的卷积高效通道注意力心电信号分类方法，该心电信号分类方法包括如下步骤：步骤1. 获取心电信号数据，并进行预处理。该步骤1具体为：步骤1.1. 从心律失常数据库中读取心电记录。本实施例中心律失常数据库选用MIT-BIH心律失常数据库，读取MIT-BIH数据库中48条心电记录，因为其中102、104号数据非MLII类型，只读取其余46条心电数据。步骤1.2. 采用离散小波变换法对心电记录中的心电信号进行去噪处理。本实施例中离散小波变换法采用Daubechies6小波变换法，去除心电信号中低频的基线漂移和高频的工频干扰和肌电干扰，可以提高心电信号分类的准确性。db6小波可以很好的保留心电信号的特征，相比其他小波函数取可以得更好的信噪比。步骤1.3. 对去噪后的心电记录进行心拍分割处理。每个分割后的独立心拍包括T1+T2+1个采样点，其中，T1以及T2均为自然数，此处例如设定每个独立心拍包括300个采样点，其中，T1=199个，T2=100个。则心拍分割处理的过程如下：心拍分割时，首先判断心电信号R峰位置，并以R峰为中心，向R峰的前后方各取199个和100个采样点，将这300个采样点作为一个独立心拍。步骤1.4. 将经过心拍分割处理后得到的独立心拍即心电信号，进行标准化处理。本实施例利用Z-score模型进行标准化处理，具体步骤如下：x*=/σ；x为原始心电信号数值，μ表示所有原始信号数值的均值，σ表示所有原始样本数据的标准差。步骤2. 将预处理后的心电信号数据进行数据集切分，并切分为训练集以及测试集。本实施例使用十折交叉验证来对心电分类模型进行训练和验证。根据交叉验证，将数据集切分如下：将全部的数据均分为10份，其中，9份为训练集和1份为测试集。然后再从9份训练集中，取其中的10%为验证集，使用交叉验证可以在一定程度上减小过拟合，还可以从有限的数据中获取尽可能多的有效信息。本实施例采用类别权重方法的对数据集中不平衡数据进行加权分析。具体过程如下：定义训练集与测试集的切分比例为τ。本实施例中类别权重算法，根据数据集的切分比例τ对不同类别的心电信号进行加权，如公式所示。其中，CWc表示第c类样本的权重；N表示样本的类别数量，nc表示第c类样本的数量，表示向上取整。本实施例中类别数量N例如设置为5。当采用AAMI组分类方法进行实验时，五类信号分别为：正常搏动、室上性异位搏动、室性异位搏动、融合搏动和未知搏动。当采用Common分类方法进行实验时，五类信号为：正常搏动、右束支阻滞搏动、左束支阻滞搏动、房性早搏。在下述步骤3中心电分类模型训练的同时，对不同类别的心电信号进行权重分配。本实施例通过给予像少数类别，例如房性早搏、融合搏动等类别较高的权重，使得构建的心电分类模型对这些类别疾病加强关注，以提高少数类别的分类准确度。与已有的网络模型对比，本发明方法提出的类别权重算法，为提高少数类别分类的准确率提供了一条可行的途径，提高了少数类别的分类准确度。步骤3. 构建心电分类模型。心电分类模型包括卷积神经网络模块、高效通道注意力模块以及密集模块；其中，CNN模块、ECA模块以及Dense模块依次连接。CNN模块包括六个一维卷积层，各个一维卷积层依次连接；在每个一维卷积层之后依次放置了批归一化层、Relu激活层以及池化层。其中，批归一化层可以加快模型的学习，提高收敛速度。池化层可以减小数据和参数的数量、减少过拟合，并改善模型的错误率。每个一维卷积层的卷积核大小依次设置为11、9、7、5、3、1，每个一维卷积层中的滤波器数量依次为32、64、64、128、128、256，每个一维卷积层的步长均为1。每个一维卷积层后的池化层均采用最大池化层，其中，最大池化层的步长设置为2。ECA模块包括全局平均池化层、自适应K值计算模块、一维卷积层、Relu函数层以及元素积函数运算模块。如图3所示，输入的特征图在ECA模块的处理过程如下：首先输入的特征图到达全局平均池化层执行全局平均池化处理，将输入的特征图尺寸从变为，得到通道维数C。然后将通道维数C输入到自适应K值计算模块，计算得到自适应K值，计算公式如下：；其中，就是映射函数，赋值给K。γ、b是映射函数的参数，分别设置为2和1，|·|odd表示最接近·的最近奇数。再将自适应K值应用于一维卷积层中，作为一维卷积的卷积核，从而实现跨通道交互，并通过Relu函数层的Relu激活函数计算得到通道权重α。α=δ)。其中，α是通道权重，δ是Relu激活函数，C1D是一维卷积，y是每个通道。最后将通道权重α以及输入的特征图一并输入到元素积函数运算模块中并进行相乘运算，输出加权后的特征图即注意力机制增强后的特征图。本发明使用一维全局平均池化对接收的心电信号进行处理，同时，在一维卷积激活函数的选择上选择了Relu函数，通过对ECA模块进行改进使模块更适合处理心电信号。与已有的加入注意力机制的方法相比，如加入SE块注意力机制的模型，本发明使用的ECA模块，不仅在模型复杂度上更加简单，而且在网络模型训练时，SE块会产生的参数量为8192，而ECA模块的参数量只有5。并且SE block需要对特征图进行压缩降维，而这样的降维操作不利于学习通道之间的依赖关系，ECA模块的使用，增强了模型性能的表现。Dense模块包括一个展平层、两个全连接层以及一个softmax分类层。其中，每个全连接层后接一层批归一化层、一层Relu激活层以及一个Dropout层。两个全连接层的滤波器数量设置为256、128，softmax分类器的分类数设置为类别数量。本发明实施例中心电分类模型结合了CNN模块、ECA模块以及Dense模块，它们是协同作用的，其中，首先利用CNN模块从输入数据中提取深层特征，然后引入ECA来自适应的增强重要的特征，并抑制不相关特征，同时，利用CW对不同类别信号赋予相应权重。最后，使用由几个完全连接的层组成的Dense模块来执行预测任务，输出预测结果。步骤4. 利用划分的训练集与测试集对构建的心电分类模型进行训练及测试。心电分类模型的训练过程为：首先将训练集中带有类别权重的心电信号输入到卷积神经网络模块进行六次一维卷积，在每次一维卷积后，依次进行批归一化、Relu激活以及最大池化处理。然后，将由卷积神经网络模块输出的特征图通过ECA模块进行筛选加权处理，并得到加权后的特征图，并通过展平层将输出的特征图一维化。紧接着，将一维化后的特征通过全连接层连接所有特征进行非线性变化，将学到的分布式特征表示映射到样本的标记空间，输出给softmax分类器，做最终分类预测输出。其中，此处的分布式特征表示即高度提纯的特征。心电分类模型训练完成后，保存模型参数，对切分测试集进行测试，输入训练好的心电分类模型中，输出最终五分类结果，并取十次均值作为最终指标结果。利用包括准确性、召回率、精确度、特异性、F1-score5种常规评估指标和受试者工作曲线下面积来评估提出模型的整体性能。步骤5. 对于待识别的心电信号，首先对心电信号按照步骤1进行预处理操作，然后利用训练及测试好的心电分类模型进行分类处理，得到心电信号分类结果。本发明提出的心电分类模型，不需要人工进行特征提取和选择，还可以通过ECA对CNN输出的多特征通道进行不同权重的赋予，来增强有用特征，抑制不相关特征。同时，本发明还提出了一种类别权重算法，大大提高了少数类疾病分类的准确度。与已有的单纯基于卷积神经网络的方法相比，本发明方法有效的提升了分类准确率。此外，为了验证本发明提出的模型的性能，采用了两种数据划分方式。一种是按照美国国家标准协会/医疗器械促进协会标准将数据库中15种原始心跳类别分为：正常搏动、室上性异位搏动、室性异位搏动、融合搏动和未知搏动，我们称为AAMI组。表1给出了AAMI标准的ECG分类类别。另一种方法是从数据库中，选择一些小类，这些小类也多为文献中广泛使用的，并且也常见于老年人群中。包括除正常搏动、右束支阻滞搏动、左束支阻滞搏动、房性早搏四类，称为Common组，在表1中加粗显示。表1 AAMI 推荐的心跳划分标准为了全面地评估提出的模型性能，本发明使用准确性、召回率、精确度、特异性、F1-score5种常规评估指标。除上述指标外，本发明还利用受试者工作曲线下面积来评估提出模型的整体性能。根据AUC的范围可以对分类性能及进行定性判断，如表2所示。表2 根据AUC的范围对分类性能进行定性判断AUC参考0.5-0.6无效0.6-0.7差0.7-0.8可接受的0.8-0.9良好的0.9-1极好的表3显示了本发明提出模型在AAMI划分方法上的详细结果。表3 本发明模型在AAMI组上的结果由表3可知，本发明提出的模型在AAMI组上得到了99.75%的准确、95.38%的召回率、96.64%精确度、99.49%特异性和96.00%F1评分以及0.99的AUC值。表4显示了本发明提出模型在Common划分方法上的详细结果。表4 所提出的模型在Common组上的结果由表4看出，本发明模型在Common组上取得的准确度，召回率、特异性、精准度和F1以及AUC分别为99.83%、98.41%、99.01%、99.77%、98.71%和0.99。图4和图5分别为本发明CNN-ECA模型在AAMI组和在Common组的各类别ROC曲线图。由图看出各类别都取得了超过0.99的AUC值，证明了本发明具有良好的性能。表5展示了本发明模型与一些使用相同数据库的其他文献中模型的比较。表5提出的模型与相关工作的比较从表5中能够看出，本发明方法构建的模型性能优于大多数模型。本发明在其中比较了一些使用SE块的模型，它们的模型性能低于本发明的模型。因为本发明模型具有更好地通道注意力机制，且基本上消除了数据不平衡带来的负面影响。在表5中还比较了一些使用SMOTE方法和使用FL损失函数处理不平衡数据的模型。通过比较发现，本发明模型评价指标评分高于大多数文献中性能评分。除上述外，本发明还比较了一些单独使用CNN算法和使用其他算法模型，都取得了更好的性能评分。综上所述，结果表明本发明提出的模型分类效果显著。基于同样的发明构思，本发明实施例还提供了一种带有类别权重的卷积高效通道注意力心电信号分类系统，该心电信号分类系统包括如下几个模块：预处理模块，用于对获取的心电信号数据进行预处理；数据集切分模块，用于将预处理后的心电信号数据进行数据集切分，并切分为训练集以及测试集；定义训练集与测试集的切分比例为τ；根据数据集的切分比例τ对不同类别的心电信号进行加权，如公式所示；其中，CWc表示第c类样本的权重；N表示样本的类别数量，nc表示第c类样本的数量，表示向上取整；在下述步骤3中心电分类模型训练的同时，对不同类别的心电信号进行权重分配；模型构建模块，用于构建心电分类模型；心电分类模型包括卷积神经网络模块、ECA模块以及密集模块；其中，卷积神经网络模块、ECA模块以及密集模块依次连接；卷积神经网络模块包括六个一维卷积层，各个一维卷积层依次连接；在每个一维卷积层之后依次放置了批归一化层、Relu激活层以及池化层；ECA模块包括全局平均池化层、自适应K值计算模块、一维卷积层、Relu函数层以及元素积函数运算模块；输入的特征图在ECA模块的处理过程如下：首先输入的特征图到达全局平均池化层执行全局平均池化处理，得到通道维数C，然后将通道维数C输入到自适应K值计算模块，计算得到自适应K值；再将自适应K值应用于一维卷积层中，作为一维卷积的卷积核，从而实现跨通道交互，并通过Relu函数层的Relu激活函数计算得到通道权重；最后将通道权重以及输入的特征图一并输入到元素积函数运算模块中并进行相乘运算，输出加权后的特征图即注意力机制增强后的特征图；密集模块包括一个展平层、两个全连接层以及一个softmax分类层；模型训练及测试模块，用于根据划分的训练集与测试集对构建的心电分类模型进行训练及测试；心电分类模型的训练过程为：首先将训练集中带有类别权重的心电信号输入到卷积神经网络模块进行六次一维卷积，在每次一维卷积后，依次进行批归一化、Relu激活以及最大池化处理；然后，将由卷积神经网络模块输出的特征图通过ECA模块进行筛选加权处理，并得到加权后的特征图，并通过展平层将输出的特征图一维化。紧接着，将一维化后的特征通过全连接层连接所有特征进行非线性变化，将学到的分布式特征表示映射到样本的标记空间，输出给softmax分类器，做最终分类预测输出。模型训练完成后，利用测试集中的数据对训练好的心电分类模型进行测试；分类预测模块，用于根据训练及测试好的心电分类模型进行分类处理，得到心电信号分类结果；其中，对于待识别的心电信号，首先对心电信号按照进行预处理操作。需要说明的是，带有类别权重的卷积高效通道注意力心电信号分类系统中，各个模块的功能和作用的实现过程具体详见上述方法中对应步骤的实现过程，在此不再赘述。此外，本发明还提出了一种用于实现上述带有类别权重的卷积高效通道注意力心电信号分类的计算机设备。该计算机设备包括存储器和一个或多个处理器。其中，在存储器中存储有可执行代码，处理器执行可执行代码时，用于实现上述带有类别权重的卷积高效通道注意力心电信号分类。本实施例中计算机设备为任意具备数据数据处理能力的设备或装置，此处不再赘述。此外，本发明还提出了一种用于实现上述带有类别权重的卷积高效通道注意力心电信号分类的计算机设备。该计算机设备包括存储器和一个或多个处理器。其中，在存储器中存储有可执行代码，处理器执行可执行代码时，用于实现上述带有类别权重的卷积高效通道注意力心电信号分类。本实施例中计算机设备为任意具备数据数据处理能力的设备或装置，此处不再赘述。此外，本发明实施例还提供一种计算机可读存储介质，其上存储有程序，该程序被处理器执行时，用于实现上述带有类别权重的卷积高效通道注意力心电信号分类。该计算机可读存储介质可以是任意具备数据处理能力的设备或装置的内部存储单元，例如硬盘或内存，也可以是任意具备数据处理能力的设备的外部存储设备，例如设备上配备的插接式硬盘、智能存储卡、SD卡、闪存卡等。当然，以上说明仅仅为本发明的较佳实施例，本发明并不限于列举上述实施例，应当说明的是，任何熟悉本领域的技术人员在本说明书的教导下，所做出的所有等同替代、明显变形形式，均落在本说明书的实质范围之内，理应受到本发明的保护。
