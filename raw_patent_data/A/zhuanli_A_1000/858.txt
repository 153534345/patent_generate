标题title
一种脑磁图源定位方法、存储介质和设备
摘要abst
提供一种脑磁图源定位方法、存储介质和设备，该方法包括：通过脑磁图传感器获取用户的第一脑磁图信号；通过均方根方法检测所述第一脑磁图信号中的ripple时间窗作为源定位的时间窗口，获得所述ripple时间窗内的第一脑磁图信号作为第二脑磁图信号；对所述第二脑磁图信号的原始张量进行Tucker分解来计算所述原始张量的估计值；通过对所述估计值计算协方差矩阵，且通过波束成形中的LCMV逆问题求解方法计算所述第二脑磁图信号对应的源位置。本发明消除了噪声信号的影响，降低了计算的复杂度，保证了每次计算结果的一致性，提高了致痫区域定位的准确度。
权利要求书clms
1.一种脑磁图源定位方法，其特征在于包括以下步骤：通过脑磁图传感器获取用户的第一脑磁图信号；通过均方根方法检测所述第一脑磁图信号中的ripple时间窗作为源定位的时间窗口，获得所述ripple时间窗内的第一脑磁图信号作为第二脑磁图信号，其中，频率为80-250Hz的且振幅高于背景信号的至少四个连续振荡信号被定义为ripple；对所述第二脑磁图信号的原始张量进行Tucker分解来计算所述原始张量的估计值，其中，利用高阶正交迭代约束Tucker分解计算的所述估计值，使该估计值保持唯一，所述估计值中去除了原始张量中的噪声因子张量；通过对所述估计值计算协方差矩阵，且通过波束成形中的LCMV逆问题求解方法计算所述第二脑磁图信号对应的源位置；其中，所述高阶正交迭代的计算过程如下：1)利用高阶奇异值分解算法计算原始张量X的因子矩阵U以及核心张量G；令k＝0；2)令k＝k+1，并对n＝1,2,…N，执行下列运算：B←X×1UT…×n-1UT×NUNT；并执行核心张量B的n模展开的奇异值分解，确定其主要奇异值个数Rn，其中，B为第k次迭代得到的核心张量，然后执行运算：U←U；3)计算第k次迭代得到的核心张量B，计G＝B，并通过下面公式判断是否收敛：||G-G||F＜E；其中，E为极小值；若满足收敛条件，则执行下一步，否则返回第2)步继续迭代，直到收敛为止；4)输出因子矩阵U和核心张量G；根据因子矩阵U和核心张量G重构出原始张量的所述估计值。2.根据权利要求1所述的方法，其特征在于通过源显示单元显示所述源位置。3.根据权利要求2所述的方法，其特征在于将所述源位置作为脑部的癫痫发作区。4.根据权利要求1-3任一项所述的方法，其特征在于通过预处理单元对所述第一脑磁图信号进行滤波、去线性趋势以及独立成分分析获得预处理后的第一脑磁图信号，该预处理后的第一脑磁图信号用于后续的ripple时间窗检测。5.根据权利要求1-3任一项所述的方法，其特征在于所述ripple时间窗为多个，针对每个ripple时间窗对应的第二脑磁图信号，计算出对应的多个源位置，并根据所述多个源位置集中对应的区域作为定位结果。6.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有计算机程序，所述计算机程序适于由处理器加载并执行，以使得具有所述处理器的计算机设备执行权利要求1-5任一项所述的方法。7.一种计算机设备，其特征在于，包括：处理器和存储器；所述处理器与存储器相连，其中，所述存储器用于存储计算机程序，所述处理器用于调用所述计算机程序，以使得所述计算机设备执行权利要求1-5任一项所述的方法。
说明书desc
本发明是中国专利申请号为ZL202011526796.6、发明名称为“基于Tucker分解和ripple时间窗的脑磁图源定位方法和装置”的分案申请，其内容通过全文参考结合于此。技术领域本发明涉及一种脑磁图源定位方法、存储介质和设备，属于生物医学领域。背景技术临床上，高达三分之一的癫痫患者是顽固性癫痫。而使用抗癫痫药物的药物治疗很难得到有效控制。癫痫灶可影响皮层兴奋性，导致异常放电，不仅直接影响病灶处或周围组织，而且影响远距离的脑区。因此，这些患者需要手术切除癫痫灶以实现无癫痫发作,术后癫痫发作与否取决于对致痫灶的定位。但是，由于缺乏直接测量该区域的工具，因此很难确定该区域。脑磁图是一种无创、实时监测脑功能的方法，在过去的几十年里，已经提出了几种基于脑电或脑电图的脑源定位方法，例如基于spike的dipole-fitting方法，但是这些方法的定位精度仍然不能满足术前精确定位的需求，计算复杂度高，定位结果易受到噪声信号的影响，对于同一脑磁图信号而言，多次定位的结果存在偏差且一致性差。鉴于上述，本发明旨在提供一种脑磁图源定位方法、存储介质和设备，来解决上述的一个或多个技术问题。发明内容为了解决现有技术中的一个或多个技术问题，申请人经过长期研究发现，通过提取原始脑磁图信号的ripple时间窗，结合Tucker分解能够提高癫痫灶定位的准确度，可为后续的手术提供参考和依据。基于该研究成果，根据本发明一方面，提供一种基于Tucker分解和ripple时间窗的脑磁图源定位装置，其特征在于包括：脑磁图传感器，用于获取用户的第一脑磁图信号；ripple检测单元，用于通过均方根方法检测所述第一脑磁图信号中的ripple时间窗作为源定位的时间窗口，获得所述ripple时间窗内的第一脑磁图信号作为第二脑磁图信号，其中，频率为80-250Hz的且振幅高于背景信号的至少四个连续振荡信号被定义为ripple；基于高阶正交迭代的Tucker分解单元，用于对所述第二脑磁图信号的原始张量进行Tucker分解来计算所述原始张量的估计值，其中，利用高阶正交迭代约束Tucker分解计算的所述估计值，使该估计值保持唯一，所述估计值中去除了原始张量中的噪声因子张量；以及源定位单元，用于对所述估计值计算协方差矩阵，且通过波束成形中的LCMV逆问题求解方法计算所述第二脑磁图信号对应的源位置。根据本发明又一方面，所述高阶正交迭代的计算过程如下：1)利用高阶奇异值分解算法计算原始张量X的因子矩阵U以及核心张量G；令k＝0；2)令k＝k+1，并对n＝1，2，…N，执行下列运算：B←X×1UT…×n-1UT×NUNT；并执行核心张量B的n模展开的奇异值分解，确定其主要奇异值个数Rn，其中，B为第k次迭代得到的核心张量，然后执行运算：U←U；3)计算第k次迭代得到的核心张量B，计G＝B，并通过下面公式判断是否收敛：||G-G||F＜E；其中，E为极小值；若满足收敛条件，则执行下一步，否则返回第2)步继续迭代，直到收敛为止；4)输出因子矩阵U和核心张量G；根据因子矩阵U和核心张量G重构出原始张量的所述估计值。根据本发明又一方面，所述的基于Tucker分解和ripple时间窗的脑磁图源定位装置还包括源显示单元，用于显示所述源位置。根据本发明又一方面，所述源位置为脑部的癫痫发作区。根据本发明又一方面，所述的基于Tucker分解和ripple时间窗的脑磁图源定位装置还包括预处理单元，用于对所述第一脑磁图信号进行滤波、去线性趋势以及独立成分分析获得预处理后的第一脑磁图信号，该预处理后的第一脑磁图信号输入所述ripple检测单元进行后续处理。根据本发明又一方面，所述ripple时间窗为多个，针对每个ripple时间窗对应的第二脑磁图信号，所述源定位单元计算出对应的多个源位置，并根据所述多个源位置集中对应的区域作为定位结果。根据本发明又一方面，还提供一种基于Tucker分解和ripple时间窗的脑磁图源定位方法，其特征在于包括以下步骤：通过脑磁图传感器获取用户的第一脑磁图信号；通过均方根方法检测所述第一脑磁图信号中的ripple时间窗作为源定位的时间窗口，获得所述ripple时间窗内的第一脑磁图信号作为第二脑磁图信号，其中，频率为80-250Hz的且振幅高于背景信号的至少四个连续振荡信号被定义为ripple；对所述第二脑磁图信号的原始张量进行Tucker分解来计算所述原始张量的估计值，其中，利用高阶正交迭代约束Tucker分解计算的所述估计值，使该估计值保持唯一，所述估计值中去除了原始张量中的噪声因子张量；对所述估计值计算协方差矩阵，且通过LCMV逆问题求解方法计算所述第二脑磁图信号对应的源位置。根据本发明又一方面，通过源显示单元显示所述源位置。根据本发明又一方面，将所述源位置作为脑部的癫痫发作区。根据本发明又一方面，通过预处理单元对所述第一脑磁图信号进行滤波、去线性趋势以及独立成分分析获得预处理后的第一脑磁图信号，该预处理后的第一脑磁图信号用于后续的ripple时间窗检测。根据本发明又一方面，所述ripple时间窗为多个，针对每个ripple时间窗对应的第二脑磁图信号，计算出对应的多个源位置，并根据所述多个源位置对应的具有第一集中度的区域作为定位结果。根据本发明又一方面，还提供了一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有计算机程序，所述计算机程序适于由处理器加载并执行，以使得具有所述处理器的计算机设备执行前述的方法。根据本发明又一方面，还提供了一种计算机设备，其特征在于，包括：处理器和存储器；所述处理器与存储器相连，其中，所述存储器用于存储计算机程序，所述处理器用于调用所述计算机程序，以使得所述计算机设备执行前述的方法。与现有技术相比，本发明具有以下一个或多个技术效果：脑磁图源定位中通过Tucker分解方法有效去除了脑磁信号中的高频噪声和低频噪声，减少了癫痫灶定位结果受噪声信号的影响，同时降低了计算的复杂度。利用高阶正交迭代方法对Tucker分解的结果实现了唯一性的约束，保证了每次计算结果的一致性。以ripple作为源定位选择的时间窗，结合Tucker分解进一步提高了癫痫灶定位的准确度，为后续的手术提供了参考和依据。通过检测出多个ripple时间窗并获得相应的多个源定位，根据多个源定位集中对应的区域来确定最终的定位结果，进一步提高了定位的精度；结合多个源定位结果，将10个以上脑部区域中具有第一集中度的脑部区域作为定位结果，能够进一步减小医生的工作量，排除潜在的干扰。附图说明为了能够理解本发明的上述特征的细节，可以参照实施例，得到对于简要概括于上的发明更详细的描述。附图涉及本发明的优选实施例，并描述如下：图1为根据本发明一种优选实施例的基于Tucker分解和ripple时间窗的脑磁图源定位装置的组成示意图；图2为根据本发明一种优选实施例的ripple时间窗的检测结果示意图；图3为基于ripple时间窗的Tucker分解的定位精度与基于spike的dipole-fitting的定位精度的对比示意图。具体实施例现在将对于各种实施例进行详细说明，这些实施例的一个或更多个实例分别绘示于图中。各个实例以解释的方式来提供，而非意味作为限制。例如，作为一个实施例的一部分而被绘示或描述的特征，能够被使用于或结合任一其他实施例，以产生再一实施例。本发明意在包含这类修改和变化。在以下对于附图的描述中，相同的参考标记指示相同或类似的结构。一般来说，只会对于个别实施例的不同之处进行描述。除非另有明确指明，否则对于一个实施例中的部分或方面的描述也能够应用到另一实施例中的对应部分或方面。实施例1参见图1-3，图1为根据本发明一种优选实施例的基于Tucker分解和ripple时间窗的脑磁图源定位装置的组成示意图；图2为根据本发明一种优选实施例的ripple时间窗的检测结果示意图；图3为基于ripple时间窗的Tucker分解的定位精度与基于spike的dipole-fitting的定位精度的对比示意图。根据本发明一种优选实施方式，参见图1-2，提供一种基于Tucker分解和ripple时间窗的脑磁图源定位装置，其特征在于包括：脑磁图传感器，用于获取用户的第一脑磁图信号；ripple检测单元，用于通过均方根方法检测所述第一脑磁图信号中的ripple时间窗作为源定位的时间窗口，获得所述ripple时间窗内的第一脑磁图信号作为第二脑磁图信号，其中，频率为80-250Hz的且振幅高于背景信号的至少四个连续振荡信号被定义为ripple；基于高阶正交迭代的Tucker分解单元，用于对所述第二脑磁图信号的原始张量进行Tucker分解来计算所述原始张量的估计值，其中，利用高阶正交迭代约束Tucker分解计算的所述估计值，使该估计值保持唯一，所述估计值中去除了原始张量中的噪声因子张量；以及源定位单元，用于对所述估计值计算协方差矩阵，且通过波束成形方法中的LCMV逆问题求解方法计算所述第二脑磁图信号对应的源位置。有利地，本发明通过基于高阶正交迭代的Tucker分解，并以MEG信号的ripple时间段作为定位的时间窗口，提高了源位置的检测精度，可以广泛适用于深源、浅源定位，并提高临床脑源定位在术前评估中的参考价值。根据本发明又一种优选实施方式，所述高阶正交迭代的计算过程如下：1)利用高阶奇异值分解算法计算原始张量X的因子矩阵U以及核心张量G；令k＝0；2)令k＝k+1，并对n＝1，2，…N，执行下列运算：B←X×1UT…×n-1UT×NUNT；并执行核心张量B的n模展开的奇异值分解，确定其主要奇异值个数Rn，其中，B为第k次迭代得到的核心张量，然后执行运算：U←U；3)计算第k次迭代得到的核心张量B，计G＝B，并通过下面公式判断是否收敛：||G-G||F＜E；其中，E为极小值；若满足收敛条件，则执行下一步，否则返回第2)步继续迭代，直到收敛为止；4)输出因子矩阵U和核心张量G；根据因子矩阵U和核心张量G重构出原始张量的所述估计值。根据本发明又一种优选实施方式，所述的基于Tucker分解和ripple时间窗的脑磁图源定位装置还包括源显示单元，用于显示所述源位置。根据本发明又一种优选实施方式，所述源位置为脑部的癫痫发作区。根据本发明又一种优选实施方式，所述的基于Tucker分解和ripple时间窗的脑磁图源定位装置还包括预处理单元，用于对所述第一脑磁图信号进行滤波、去线性趋势以及独立成分分析获得预处理后的第一脑磁图信号，该预处理后的第一脑磁图信号输入所述ripple检测单元进行后续处理。根据本发明又一种优选实施方式，所述ripple时间窗为多个，针对每个ripple时间窗对应的第二脑磁图信号，所述源定位单元计算出对应的多个源位置，并根据所述多个源位置集中对应的区域作为定位结果。具体地，例如将Z个源位置中的至少Y次反复对应的区域作为最终的结果输出，Y优选为大于等于3。根据实验验证表明，3次以上的反复对应的区域基本接近真实的致痫区，从而进一步提高了定位的准确性，为医生的后期手术提供了可靠参考。优选地，所述ripple时间窗为Z个，针对每个ripple时间窗对应的第二脑磁图信号，所述源定位单元计算出对应的Z个源位置，确定Z个源位置分别对应的Z个脑部区域，将所述Z个脑部区域中具有第一集中度的脑部区域作为定位结果。经过研究表明，取Z大于等于10，第一集中度为45％-85％，可以实现对真实致痫区的准确定位，相较于单一的源定位而言，能够进一步减小医生的工作量，排除潜在的干扰。根据本发明又一种优选实施方式，还提供一种基于Tucker分解和ripple时间窗的脑磁图源定位方法，其特征在于包括以下步骤：通过脑磁图传感器获取用户的第一脑磁图信号；通过均方根方法检测所述第一脑磁图信号中的ripple时间窗作为源定位的时间窗口，获得所述ripple时间窗内的第一脑磁图信号作为第二脑磁图信号，其中，频率为80-250Hz的且振幅高于背景信号的至少四个连续振荡信号被定义为ripple；对所述第二脑磁图信号的原始张量进行Tucker分解来计算所述原始张量的估计值，其中，利用高阶正交迭代约束Tucker分解计算的所述估计值，使该估计值保持唯一，所述估计值中去除了原始张量中的噪声因子张量；通过对所述估计值计算协方差矩阵，且通过波束成形中的LCMV逆问题求解方法计算所述第二脑磁图信号对应的源位置。根据本发明又一种优选实施方式，通过源显示单元显示所述源位置。根据本发明又一种优选实施方式，将所述源位置作为脑部的癫痫发作区。根据本发明又一种优选实施方式，通过预处理单元对所述第一脑磁图信号进行滤波、去线性趋势以及独立成分分析获得预处理后的第一脑磁图信号，该预处理后的第一脑磁图信号用于后续的ripple时间窗检测。根据本发明又一种优选实施方式，所述ripple时间窗为多个，针对每个ripple时间窗对应的第二脑磁图信号，计算出对应的多个源位置，并根据所述多个源位置集中对应的区域确定为定位结果。根据本发明又一优选实施方式，还提供了一种基于Tucker分解和ripple时间窗的新型源定位装置，包括ripple检测单元、张量分解单元、源定位单元以及验证单元。优选地，Ripple检测单元应用均方根方法。MEG信号采用Tucker分解计算原始张量的估计值，基于高阶正交迭代的方式约束使Tucker分解的结果保持唯一，去除主要信息为噪声的因子张量。源定位单元对Tucker分解后张量的估计值计算协方差矩阵，从而用LCMV的方法计算癫痫脑磁信号的源位置。验证单元包括在真实脑磁数据上面的验证，其中，基于真实数据的验证将基于ripple的Tucker分解与基于spike的临床偶极子方法进行比较。如图3所示，其中示出了比较结果，其中，本发明相对于基于spike的临床偶极子方法较大程度地提高了脑部致痫区域的定位精度。优选地，ripple检测单元将80-250Hz的且振幅高于背景信号的至少四个连续振荡定义为ripple。优选地，将80-250Hz的且振幅高于背景信号第一阈值的至少四个振荡定义为ripple，进一步提高定位精度。优选地，本发明中将均方根方法用于MEG中ripple的检测，其条件例如可具体选择如下：波形功率值应达到背景信号的3-9倍，并且波形的持续时间至少持续15ms。优选地，假阳性ripple可以手动消除。根据本发明又一优选实施方式，正交迭代过程中，输入原始张量X；输出迭代完成后的因子矩阵U和核心张量G。正交迭代的计算过程优选具体如下：1)利用高阶奇异值分解算法计算原始张量X的因子矩阵U以及核心张量G。令k＝0；2)令k＝k+1，并对n＝1，2，…N，执行下列运算：B←X×1UT…×n-1UT×NUNT；其中，X×nUT表示张量X与矩阵UT的n-模乘积；并执行核心张量B的n模展开的SVD，确定其主要奇异值个数Rn，然后执行运算：U←U3)计算第k次迭代的核心张量B，计G＝B，并通过下面的收敛公式判断是否收敛：||G-G||F＜EE为极小值。若满足收敛条件，则执行下一步，否则返回第2步继续迭代，直到收敛为止。4)输出因子矩阵U和核心张量G；根据因子矩阵U和核心张量G重构出原始张量的所述估计值。可以理解的是，其中，初始化核心张量G为零张量。||G-G||F＜E表示确定G-G是否符合收敛条件的收敛公式。优选地，针对所述估计值，用波束成形分析方法求解逆问题来计算协方差矩阵和估计源的位置，波束成形的原理是：通过时域信息和频域信息对信号滤波，以获得指定方向的信息，同时衰减来自其他方向的噪声干扰。根据本发明又一优选实施方式，还提供了一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有计算机程序，所述计算机程序适于由处理器加载并执行，以使得具有所述处理器的计算机设备执行前述的方法。根据本发明又一优选实施方式，还提供了一种计算机设备，其特征在于，包括：处理器和存储器；所述处理器与存储器相连，其中，所述存储器用于存储计算机程序，所述处理器用于调用所述计算机程序，以使得所述计算机设备执行前述的方法。与现有技术相比，本发明具有以下一个或多个技术效果：脑磁图源定位中通过Tucker分解方法有效去除了脑磁信号中的高频噪声和低频噪声，减少了癫痫灶定位结果受噪声信号的影响，同时降低了计算的复杂度。利用高阶正交迭代方法对Tucker分解的结果实现了唯一性的约束，保证了每次计算结果的一致性。以ripple作为源定位选择的时间窗，结合Tucker分解进一步提高了癫痫灶定位的准确度，为后续的手术提供了参考和依据。通过检测出多个ripple时间窗并获得相应的多个源定位，根据多个源定位集中对应的区域来确定最终的定位结果，进一步提高了定位的精度；结合多个源定位结果，将10个以上脑部区域中具有第一集中度的脑部区域作为定位结果，能够进一步减小医生的工作量，排除潜在的干扰。虽然前述内容是关于本发明的实施例，但可在不背离本发明的基本范围的情况下，设计出本发明其他和更进一步的实施例，本发明的范围由权利要求书确定。上述实施例仅为本发明的较佳实施例而已，并不用以限制本发明，这些实施例中不互相违背的技术特征可彼此结合。凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
