标题title
基于智能巡检机器人的母猪体尺检测系统
摘要abst
本发明公开了一种基于智能巡检机器人的母猪体尺检测系统，其特征在于它包括：机器人本体、充电仓、轨道、数据存储及上传单元、云服务器处理系统，其中：轨道铺设于养猪舍中，充电仓架设于轨道的尽头，机器人本体于轨道上行进实现巡检，机器人本体接入充电仓实现充电，机器人本体采集到的信息通过数据存储及上传单元传入云服务处理系统，云服务处理系统执行对母猪图像的处理。本系统通过研究智能巡检机器人，代替了传统人工巡检的方式，实时采集母猪视频信息并上传保存，避免了人猪接触，减少了猪只患病及应激的可能性，提高养殖场的自动化水平。
权利要求书clms
1.一种基于智能巡检机器人的母猪体尺检测系统，其特征在于它包括：机器人本体、充电仓、轨道、数据存储及上传单元、云服务器处理系统，其中：轨道铺设于养猪舍中，充电仓架设于轨道的尽头，机器人本体于轨道上行进实现巡检，机器人本体接入充电仓实现充电，机器人本体采集到的信息通过数据存储及上传单元传入云服务处理系统，云服务处理系统执行对母猪图像的处理。2.根据权利要求1所述的系统，其特征在于机器人本体包括：核心控制模块：主芯片为STM32F103的单片机控制板，其上面包括供电接口、485接口、PWM输出接口、电压采集接口和传感器接口；核心控制模块输出PWM信号以控制机器人本体移动停止；供电模块：为24v输出可充电锂电池，负责向机器人本体的核心控制模块、驱动传动模块、传感器模块、图像采集模块和无线信息传输模块进行供电；充电模块：固定于机器人本体最上侧，通过与充电仓内部充电桩接触对机器人本体进行充电；驱动传动模块：包括驱动电机和传动齿轮组，以及上滚轮组和下滚轮组；驱动传动模块受核心控制模块输出的PWM信号控制，并由供电模块供电，通过传动齿轮组将动力传输至上滚轮组驱动机器人本体移动，下滚轮组在轨道下方从动；传感器模块：包括温湿度、光照和二氧化碳的环境信息采集节点，由供电模块供电；图像采集模块：为视频采集摄像头，由供电模块供电；图像采集模块所采集的视频信息传输至数据存储及上传单元，数据存储及上传单元将视频信息转为图片信息后上传至云服务处理系统；无线信息传输模块：由供电模块供电，将传感器模块获得的环境数据上传至云服务处理系统。3.根据权利要求2所述的系统，其特征在于驱动传动模块中：传动齿轮组包括位于中间的驱动齿轮和位于两边的从动齿轮，驱动齿轮在驱动电机作用下转动，带动从动齿轮运动；上滚轮组的两个滚轮分别固定于从动齿轮的转轴上，滚轮的轮面宽于轨道宽度，且滚轮的轮面两侧具有挡护结构；上滚轮组的两个滚轮在轨道的上方滚动行进。4.根据权利要求3所述的系统，其特征在于传动齿轮组装置于齿轮盒中。5.根据权利要求2所述的系统，其特征在于驱动传动模块中：下滚轮组包括两个滚轮，滚轮的轮面宽于轨道宽度，且滚轮的轮面两侧具有挡护结构；下滚轮组的两个滚轮在轨道的下方滚动从动；两个滚轮之间通过内侧的拉紧弹簧连接，使下滚轮组向内、向上拉紧。6.根据权利要求1所述的系统，其特征在于数据存储及上传单元通过WIFI信号与图像采集模块在同一局域网内；数据存储及上传单元包括交换机、路由器、NVR和主机，将图像采集模块采集到的视频数据进行存储并处理，1s截取一张图片并每5min将截图数据上传至云服务器处理系统。7.根据权利要求1所述的系统，其特征在于云服务器处理系统进行母猪体尺检测包括以下步骤：S1、对获取到的图像数据进行人工标记，标记出出图像中母猪个体，从而得到数据集；S2、训练实例分割模型：将数据集中80％的数据样本用于训练识别模型，20％作为测试数据，训练YOLACT实例分割模型；S3、将训练好的实例分割模型用于母猪图像，得到监测框坐标和掩模图；S4、截图图像中掩膜所在区域；S5、根据掩膜与水平线所成角度求取线性拟合；S6、根据线性拟合值将掩膜图像旋转至水平方向；S7、基于OpenCV对掩膜图像进行椭圆拟合，得到掩膜的最小外接圆和最大内切圆，继而得到两种圆的圆心与半径；S8、通过两种圆的数据设置矩形掩膜，最大内切圆的直径作为矩形掩膜的宽，最小外接圆的直径作为矩形的长，则矩形掩膜的长和宽即为母猪的体长和体宽；S9、将母猪体长和体宽存储在数据库内。8.根据权利要求7所述的系统，其特征在于S5使用最小二乘法拟合母猪图像与水平方向偏移角度：式中，表示截距a的最佳估计值，表示斜率b的最佳估计值，,i＝1,2,3,4……m,代表掩膜边缘点的位置坐标。9.根据权利要求7所述的系统，其特征在于S2中，数据集中母猪按照姿态不同进行标注，分别为站立、坐姿、侧卧和胸卧,训练模型时设置总类别为4，模型训练时，将站立姿态的母猪进行后续掩膜分析，最终得到其体尺数据。
说明书desc
技术领域本发明涉及畜禽养殖、巡检机器人、图像检测、图像识别技术领域，具体地讲是一种基于智能巡检机器人的母猪体尺检测系统。背景技术传统的母猪体尺信息采集一般是由饲养员直接通过物理方式进行测量。传统的物理测量方式由于测量工具或者操作问题容易导致产生较大的数据误差，降低了测量准确性。同时测量过程中难免发生接触，使得待测猪的应激反应较大，导致测量操作繁杂误差增大。这么做不仅降低了猪的福利水平，提高了母猪生病、流产、死亡的风险。发明内容本专利结合母猪实际养殖环境中的需求，发明了一种基于智能巡检机器人的母猪体尺检测系统。技术方案：一种基于智能巡检机器人的母猪体尺检测系统，它包括：机器人本体、充电仓、轨道、数据存储及上传单元、云服务器处理系统，其中：轨道铺设于养猪舍中，充电仓架设于轨道的尽头，机器人本体于轨道上行进实现巡检，机器人本体接入充电仓实现充电，机器人本体采集到的信息通过数据存储及上传单元传入云服务处理系统，云服务处理系统执行对母猪图像的处理。优选的，机器人本体包括：核心控制模块：主芯片为STM32F103的单片机控制板，其上面包括供电接口、485接口、PWM输出接口、电压采集接口和传感器接口；核心控制模块输出PWM信号以控制机器人本体移动停止；供电模块：为24v输出可充电锂电池，负责向机器人本体的核心控制模块、驱动传动模块、传感器模块、图像采集模块和无线信息传输模块进行供电；充电模块：固定于机器人本体最上侧，通过与充电仓内部充电桩接触对机器人本体进行充电；驱动传动模块：包括驱动电机和传动齿轮组，以及上滚轮组和下滚轮组；驱动传动模块受核心控制模块输出的PWM信号控制，并由供电模块供电，通过传动齿轮组将动力传输至上滚轮组驱动机器人本体移动，下滚轮组在轨道下方从动；传感器模块：包括温湿度、光照和二氧化碳的环境信息采集节点，由供电模块供电；图像采集模块：为视频采集摄像头，由供电模块供电；图像采集模块所采集的视频信息传输至数据存储及上传单元，数据存储及上传单元将视频信息转为图片信息后上传至云服务处理系统；无线信息传输模块：由供电模块供电，将传感器模块获得的环境数据上传至云服务处理系统。优选的，驱动传动模块中：传动齿轮组包括位于中间的驱动齿轮和位于两边的从动齿轮，驱动齿轮在驱动电机作用下转动，带动从动齿轮运动；上滚轮组的两个滚轮分别固定于从动齿轮的转轴上，滚轮的轮面宽于轨道宽度，且滚轮的轮面两侧具有挡护结构；上滚轮组的两个滚轮在轨道的上方滚动行进。优选的，传动齿轮组装置于齿轮盒中。优选的，驱动传动模块中：下滚轮组包括两个滚轮，滚轮的轮面宽于轨道宽度，且滚轮的轮面两侧具有挡护结构；下滚轮组的两个滚轮在轨道的下方滚动从动；两个滚轮之间通过内侧的拉紧弹簧连接，使下滚轮组向内、向上拉紧。优选的，数据存储及上传单元通过WIFI信号与图像采集模块在同一局域网内；数据存储及上传单元包括交换机、路由器、NVR和主机，将图像采集模块采集到的视频数据进行存储并处理，1s截取一张图片并每5min将截图数据上传至云服务器处理系统。优选的，云服务器处理系统进行母猪体尺检测包括以下步骤：S1、对获取到的图像数据进行人工标记，标记出出图像中母猪个体，从而得到数据集；S2、训练实例分割模型：将数据集中80％的数据样本用于训练识别模型，20％作为测试数据，训练YOLACT实例分割模型；S3、将训练好的实例分割模型用于母猪图像，得到监测框坐标和掩模图；S4、截图图像中掩膜所在区域；S5、根据掩膜与水平线所成角度求取线性拟合；S6、根据线性拟合值将掩膜图像旋转至水平方向；S7、基于OpenCV对掩膜图像进行椭圆拟合，得到掩膜的最小外接圆和最大内切圆，继而得到两种圆的圆心与半径；S8、通过两种圆的数据设置矩形掩膜，最大内切圆的直径作为矩形掩膜的宽，最小外接圆的直径作为矩形的长，则矩形掩膜的长和宽即为母猪的体长和体宽；S9、将母猪体长和体宽存储在数据库内。优选的，S5使用最小二乘法拟合母猪图像与水平方向偏移角度：式中，表示截距a的最佳估计值，表示斜率b的最佳估计值，,i＝1,2,3,4……m,代表掩膜边缘点的位置坐标。优选的，S2中，数据集中母猪按照姿态不同进行标注，分别为站立、坐姿、侧卧和胸卧,训练模型时设置总类别为4，模型训练时，将站立姿态的母猪进行后续掩膜分析，最终得到其体尺数据。本发明的有益效果本系统通过研究智能巡检机器人，代替了传统人工巡检的方式，实时采集母猪视频信息并上传保存，避免了人猪接触，减少了猪只患病及应激的可能性，提高养殖场的自动化水平。对母猪体尺信息进行实时监测，在不需要人工参与的情况下，自动记录母猪体尺变化过程，为管理员饲养提供准确的参考。通过架设巡检轨道，可以做到一台智能巡检机器人巡检一栋猪舍，大大降低了养殖成本，为养猪场提高了生产效率以及经济效益。附图说明图1为本发明的系统模块结构图图2为智能巡检机器人的剖视图图3为智能巡检机器人的侧视图图4为智能巡检机器人的侧视图图5为巡检机器人充电仓及轨道设计图图6为巡检机器人本体充电触点设计图图7为本发明的系统整体框架图具体实施方式下面结合实施例对本发明作进一步说明，但本发明的保护范围不限于此：本申请利用预先建立的母猪体尺检测模型，通过对栏养母猪体尺信息的检测，实现实时反应养殖场母猪体尺变化信息的功能。本专利系统示意图如图1所示，选择悬挂式机器人作为图像采集载体，将巡检轨道架设在栏养母猪舍内，在母猪进食期间智能巡检机器人沿着轨道向下拍摄母猪俯视画面，其中摄像头距离母猪约1.95米，摄像头焦距为4mm，通过24小时不间断智能巡检，并通过无线传输将视频数据传输至数据存储及上传单元；数据存储及上传单元对视频数据进行截图处理，1s截取一张图片并每5min将截图数据上传至云服务器处理系统；云服务器处理系统对母猪截图数据进行目标检测并进行YOLACT实例分割得到监测框坐标和掩膜图，对掩膜进行线性拟合，将掩膜图像旋转至平行，基于opencv进行椭圆拟合，得到掩膜的最大内切圆和最小外接圆，提取两种圆心和半径设置矩形掩膜，即可得到矩形的长和宽即为母猪的体长和体宽；将得到的母猪体尺信息发送至养殖者手机APP和网页端显示。具体工作流程如下所示：第一步：研制巡检机器人及其充电仓与轨道，巡检机器人在结构上主要分为核心控制模块、供电模块、充电模块、驱动传动模块、传感器模块、图像采集模块和无线信息传输模块，充电仓主要包括充电桩及隔离仓，轨道为40*40mm方管标准件，可选择支撑式或悬挂式固定安装。第二步：核心控制版为主芯片为STM32F103的单片机控制板，其上面包括供电接口，485接口，PWM输出接口，电压采集接口和传感器接口等，控制板在巡检机器人中起到控制机器人移动停止、上传传感器数据的功能。第三步：供电模块为24v输出可充电锂电池，负责向巡检机器人的核心控制模块、驱动模块、传感器模块、图像采集模块和无线信息传输模块进行供电。第四步：充电模块固定在机器人最上侧，通过与充电仓内部充电桩接触对其进行充电。第五步：驱动传动模块主要包括驱动电机和传动齿轮组，以及上滚轮组和下滚轮组，驱动电机由核心控制板输出的PWM信号控制，由供电模块供电，通过三个齿轮将动力传输至上滚轮组，驱动巡检机器人移动，下滚轮组通过拉紧弹簧拉紧，紧贴在轨道上，保持机器人运行时的稳定性。第六步：传感器模块为温湿度、光照和二氧化碳等环境信息采集节点，由供电模块供电，由485接口将环境信息通过无线收发模块上传至云服务器。第七步：图像采集模块为视频采集摄像头，由供电模块供电，通过无线信息传输模块联网，将视频数据传输至数据存储及上传单元。第八步：无线信息传输模块带有网口及485接口，由供电模块供电，在与养殖舍内WIFI信号连接后，可为图像采集模块供网，通过将485接口接收到的环境数据上传至云服务器。第九步：巡检机器人充电仓架设在轨道上，充电仓内部充电桩通过充电触点与巡检机器人上侧充电模块接触为机器人进行充电；轨道选用40*40mm方管标准件，材质可选择铁镀锌方管和304不锈钢方管。第十步：数据存储及上传单元通过WIFI信号与图像采集模块在同一局域网内，将采集到的视频数据进行存储并处理，每1s截取一张图片并每5min将截图数据上传至云服务器处理系统。第十一步：对获取到的图像数据进行人工标记，标记出出图像中母猪个体，从而得到数据集，将将其中80％的数据样本用于训练识别模型，20％作为测试数据，训练YOLACT实例分割模型。第十二步：通过实例分割模型得到母猪监测框坐标以及母猪掩膜图，截取掩膜所在区域，进行线性拟合，将图像进行旋转，基于opencv求取图像的最小外接圆和最大内切圆,得到两种圆心与半径，通过圆心与半径的数据设置矩形掩膜，则矩形掩膜的长和宽即为母猪的体长和体宽。第十三步：将母猪体长和体宽数据保存至数据库并同时发送至管理员电脑网页端和手机APP，帮助管理员更好的了解母猪生长过程。系统的具体设计方案如下智能巡检机器人本体研制为更好的采集母猪站立视频数据防止对猪只产生应激反应，本发明设计了一款智能巡检机器人。智能巡检机器人采用可充电式锂电池供电的方式，巡检方式采用固定式轨道巡检，通过搭载图像采集模块将母猪图像传输至存储设备，实现无人状态下智能巡检采集视频图像的功能。智能巡检机器人设计图如图2-图4所示：其中1为无线收发模块，同时与传感器和图像采集模块相连，为其提供网络；2为轨道，规格选用40*40mm的铁镀锌方管或304不锈钢方管；3为温湿度、光照和二氧化碳四合一环境传感器；4为摄像头接口，与下方的图像采集模块相连；5为供电模块，选用24V可充电式锂电池，负责向巡检机器人的核心控制模块、驱动模块、传感器模块、图像采集模块和无线信息传输模块进行供电；6为驱动模块，选用步进电机驱动器，核心控制模块通过控制驱动模块驱动电机执行动作；7为充电桩，固定在轨道尽头；8为充电触点，通过与锂电池充电器相连，负责给供电模块供电；12为齿轮盒，保证智能巡检机器人在运行过程中齿轮的独立性；26为核心控制模块，是以STM32F103芯片为主芯片的单片机控制板，上面带有供电接口，485接口，PWM输出接口，电压采集接口和传感器接口等，控制板在巡检机器人中起到控制机器人移动停止、上传传感器数据的功能；13为驱动电机，驱动电机连接中间齿轮，由驱动器驱动，为机器人提供动力，其供电由供电模块提供，驱动电机带动中间齿轮转动，从而带动上齿轮组前后两个齿轮转动，控制机器人移动；14为上滚轮组，机器人通过上滚轮组悬挂在轨道上，上滚轮组与左右两个齿轮连接，由中间驱动齿轮带着转动；15为机器人支架，所有模块均搭载在支架上；16为下滚轮组，为下滚轮组通过拉紧弹簧向中间拉紧，从而使机器人从下方贴近在轨道上，保证机器人运行时的稳定性；17为拉紧弹簧，拉紧弹簧和下滚轮组连接，使下滚轮组向内、向上拉紧。巡检机器人充电仓及轨道研制巡检机器人充电模块位于机器人上侧，与固定在轨道上的充电桩配合对供电模块进行充电，充电仓固定在充电桩外侧，保证充电过程不受外界干扰。巡检机器人充电仓及充电模块如图5所示：图5中，11为机器人本体上的充电模块，由两两片铜板组成，绝缘固定在机器人上侧，与机器人供电模块相连；18为充电桩加强筋，保持结构的稳定性，19为方管支撑件，20为防撞垫片。充电触点固定在充电桩上，其设计图如图6所示。图6中，21为铜螺母，接触滚芯穿在铜螺母上面，可以保持自由转动；22为铜柱，23为固定螺母，铜柱和固定螺母保持整体的导电性；24为绝缘套筒，通过螺栓螺母固定在充电桩上，防止漏电；25为接触滚芯，在机器人进入充电仓与充电桩接触时，接触滚芯与铜板接触并压紧顶紧弹簧，使两者充分接触，保证充电正常进行；27为顶紧弹簧。云服务器母猪体尺检测本设计中对母猪图像的处理主要包括：①数据集获取：数据存储及上传单元通过WIFI信号与图像采集模块在同一局域网内，由交换机、路由器、NVR和主机组成，将采集到的视频数据进行存储并处理，1s截取一张图片并每5min将截图数据上传至云服务器处理系统。对获取到的图像数据进行人工标记，标记出出图像中母猪个体，从而得到数据集。②训练实例分割模型：将数据集中80％的数据样本用于训练识别模型，20％作为测试数据，训练YOLACT实例分割模型。③将训练好的实例分割模型用于母猪图像，得到监测框坐标和掩模图。④截图图像中掩膜所在区域。⑤根据掩膜与水平线所成角度求取线性拟合。⑥根据线性拟合值将掩膜图像旋转至水平方向。⑦基于OpenCV对掩膜图像进行椭圆拟合，得到掩膜的最小外接圆和最大内切圆，继而得到两种圆的圆心与半径。⑧通过两种圆的数据设置矩形掩膜，则矩形掩膜的长和宽即为母猪的体长和体宽。⑨将母猪体长和体宽存储在数据库内。步骤⑤中用最小二乘法拟合母猪图像与水平方向偏移角度，步骤就可以简化成：式中a代表截距，b代表斜率，，i＝1，2，3，4......m，代表掩膜边缘点的位置坐标。上式分别对a，b求偏导得：整理得到方程组：am+b∑xi＝∑yi解上述方程组可得参数a，b最佳估计值：步骤⑥根据所求得的b值将掩膜图像旋转至水平方向。母猪体尺信息可视化云服务器在得到母猪体长和体宽后，电脑端网页和手机端APP得到与服务器数据库内母猪体长和体宽信息，并通过可视化界面向管理员展示。图7则给出了系统整体框架，具体的：1)智能巡检机器人轨道巡检智能巡检机器人在轨道上巡检时，自动拍摄下方母猪进食时站立视频，不会对母猪产生不利干扰，图像采集模块通过局域网无线与数据存储相连，将视频数据上传至存储设备。2)数据存储及上传主机通过读取视频数据存储设备中母猪视频数据，每1s截取一张图片并每5min将截图数据上传至云服务器处理系统。3)母猪图像处理云服务器通过接收的母猪图像数据建立母猪实例分割模型，并采用后续的算法得到母猪的体长和体宽数据，并及时存储在数据库内。4)数据可视化电脑网页端和手机APP端可访问云服务器中存储的母猪体尺信息，管理员可实时查看母猪体尺历史变化曲线，为母猪喂养提供准确参考。本文中所描述的具体实施例仅仅是对本发明精神做举例说明。本发明所属技术领域的技术人员可以对所描述的具体实施例做各种各样的修改或补充或采用类似的方式替代，但并不会偏离本发明的精神或者超越所附权利要求书所定义的范围。
