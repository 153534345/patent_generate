标题title
一种胶囊内窥镜运行轨迹识别标注方法、设备及存储介质
摘要abst
本发明提供一种胶囊内窥镜运行轨迹识别标注方法，首先获取胶囊内窥镜的三维运动轨迹；在垂直方向的轨迹曲线上以时间T为间隔计算峰值和谷值；全轨迹内寻找垂直方向最小谷值，认为胶囊到达小肠末端并进入大肠；选取小肠与大肠分界点之前的轨迹，当前后两个峰值的差值大于阈值时，认为胶囊进入小肠；取小肠与大肠分界点之后的轨迹寻找垂直方向最大峰值，认为胶囊进入横结肠；选取升结肠与横结肠分界点之后的轨迹，当前后两个峰值的差值大于阈值时，认为胶囊进入降结肠；在横结肠与降结肠分界点之后的轨迹寻找垂直方向的最小谷值，认为胶囊进入直肠。本发明可智能识别和计算消化道各部位的通过和滞留时间，提高胃肠动力功能检查的准确性和效率。
权利要求书clms
1.一种胶囊内窥镜运行轨迹识别标注方法，其特征在于，包括以下步骤：获取胶囊内窥镜的三维运动轨迹；在垂直方向的轨迹曲线上以时间T为间隔计算胶囊内窥镜轨迹的峰值和谷值；在全轨迹内寻找垂直方向最小谷值，认为胶囊到达小肠末端并进入大肠；选取小肠与大肠分界点之前的轨迹，依次比较前后两个峰值的差值，当差值大于阈值时，认为胶囊离开胃部并开始下降进入小肠；取小肠与大肠分界点之后的轨迹，轨迹内寻找垂直方向最大峰值，认为胶囊经升结肠到达最高点并进入横结肠；选取升结肠与横结肠分界点之后的轨迹，依次比较前后两个峰值的差值，当差值大于阈值时，认为胶囊开始下降并进入降结肠；选取横结肠与降结肠分界点之后的轨迹，轨迹内寻找垂直方向最小谷值，认为胶囊到达降结肠末端并进入直肠。2.如权利要求1所述的胶囊内窥镜运行轨迹识别标注方法，其特征在于，所述时间T是15分钟。3.如权利要求1所述的胶囊内窥镜运行轨迹识别标注方法，其特征在于，所述两个峰值的差值是大于等于5cm。4.一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1至3任一项所述的胶囊内窥镜运行轨迹识别标注方法的步骤。5.一种胶囊内窥镜运行轨迹识别标注设备，包括胶囊内窥镜，其特征在于，包括：一个或多个处理器；存储器；以及一个或多个计算机程序，其中所述一个或多个计算机程序被存储在所述存储器中，并且被配置成由所述一个或多个处理器执行，其特征在于，所述处理器执行所述计算机程序时执行如权利要求1至3任一项所述的胶囊内窥镜运行轨迹识别标注方法的步骤。6.如权利要求5所述的胶囊内窥镜运行轨迹识别标注设备，其特征在于，所述时间T是15分钟。7.如权利要求5所述的胶囊内窥镜运行轨迹识别标注设备，其特征在于，所述两个峰值的差值是大于等于5cm。
说明书desc
技术领域本发明的技术方案中关于如何获取胶囊内窥镜运行轨迹的技术方案，请参考申请人在先的中国授权专利2020227703270，在此不再赘述。本发明涉及医疗器械领域，具体涉及到一种胶囊内窥镜运行轨迹的识别和标注方法。背景技术胶囊内窥镜作为新兴的胃肠道检查手段，正在逐步扩大市场，现有技术中胶囊内窥镜在检查胃肠道完毕后，医生需要在得到的消化道轨迹上手动添加多个部位分界点标记，并前后拖动标记来确定某个部位的起止时间点，并进一步地通过起始时间和截止时间相减，手动计算得到胶囊内窥镜在消化道各部位内的滞留时间，为进一步诊查提供辅助依据。这种处理方案增加了医生的工作负担，耗费医生大量时间，检查效率低下，并且检查结果因不同医生的主观判断而差异较大，客观上降低了胃肠道检查的准确度。中国专利申请号2021109294354提供了一种无线胶囊内窥镜的轨迹追踪系统、设备及介质，所述系统包括轨迹生成器、控制器、磁力生成器、驱动器和无线胶囊内窥镜，其中：轨迹生成器，用于接收输入的腹腔腔道内的多个关键点，根据所述多个关键点生成期望轨迹；控制器，用于根据所述无线胶囊内窥镜预设的动力学模型输出期望磁力；磁力生成器，用于根据所述期望磁力计算驱动器的配置信息，并按照所述配置信息对所述驱动器进行配置，以产生所述期望磁力；驱动器，用于将所述期望磁力作用于所述无线胶囊内窥镜，以控制所述无线胶囊内窥镜沿所述期望轨迹运动。采用上述轨迹追踪系统，可以驱动无线胶囊内窥镜按照指定的轨迹运动。该技术方案仍然不能解决胶囊内窥镜轨迹的识别与标注，后期仍然需要耗费医生大量时间进行标注。因此，有必要开发一种胶囊内窥镜运行轨迹的识别和标注方法，降低医生的工作量，减轻医生的负担，实现胶囊内窥镜运行轨迹的自动识别和标注。发明内容本发明提供一种运行轨迹识别标注方法、设备及存储介质，其技术方案如下：第一方面，本发明提供一种运行轨迹识别标注方法，包括以下步骤：获取胶囊内窥镜的三维运动轨迹；在垂直方向的轨迹曲线上以时间T为间隔计算胶囊内窥镜轨迹的峰值和谷值；在全轨迹内寻找垂直方向最小谷值，认为胶囊到达小肠末端并进入大肠；选取小肠与大肠分界点之前的轨迹，依次比较前后两个峰值的差值，当差值大于阈值时，认为胶囊离开胃部并开始下降进入小肠；取小肠与大肠分界点之后的轨迹，轨迹内寻找垂直方向最大峰值，认为胶囊经升结肠到达最高点并进入横结肠；选取升结肠与横结肠分界点之后的轨迹，依次比较前后两个峰值的差值，当差值大于阈值时，认为胶囊开始下降并进入降结肠；选取横结肠与降结肠分界点之后的轨迹，轨迹内寻找垂直方向最小谷值，认为胶囊到达降结肠末端并进入直肠。进一步的，所述时间T是15分钟。进一步的，所述两个峰值的差值是大于等于5cm。第二方面，本发明提供一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1至3任一项所述的运行轨迹识别标注方法的步骤。第三方面，本发明提供一种运行轨迹识别标注设备，包括胶囊内窥镜，包括：一个或多个处理器；存储器；以及一个或多个计算机程序，其中所述一个或多个计算机程序被存储在所述存储器中，并且被配置成由所述一个或多个处理器执行，所述处理器执行所述计算机程序时执行如第一方面任一项所述的运行轨迹识别标注方法的步骤。进一步的，所述时间T是15分钟。进一步的，所述两个峰值的差值是大于等于5cm。本发明提供一种轨迹识别标注方法及设备，在获得胶囊内窥镜拍摄完成后的消化道运行轨迹后，根据消化道形状将消化道划分为胃部、小肠、升结肠、横结肠、降结肠和直肠六大部位，并进一步地计算胶囊在消化道各部位内的通过时间和滞留时间，该技术方案可智能识别消化道各部位和计算各部位的通过时间、滞留时间，减轻了医生负担，提高了胃肠动力功能检查的准确性和效率。附图说明图1：本发明胶囊内窥镜的消化道轨迹三维示意图。图2：本发明胶囊内窥镜的消化道轨迹二维曲线变化结果图。图3：胶囊内窥镜运行轨迹垂直方向运动轨迹峰值与谷值自动搜索结果图。图4：本发明胶囊内窥镜的消化道轨迹自动部位划分结果图。图5：本发明胶囊内窥镜消化道轨迹识别标注方法流程图。图6：本发明胶囊内窥镜的轨迹识别标注设备组成示意图。具体实施方式为了使本发明所要解决的技术问题、技术方案及有益效果更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅用以解释本发明，并不用于限定本发明。参考图1本发明胶囊内窥镜的消化道轨迹三维示意图及图2本发明胶囊内窥镜的消化道轨迹二维曲线变化结果图，采用申请人在先的中国授权专利2020227703270可测量得到胶囊内窥镜在消化道内的三维运动轨迹如图1所示，对应的二维曲线变化结果图如图2所示，以下进行详细说明：进一步参考图3胶囊内窥镜运行轨迹垂直方向运动轨迹峰值、谷值自动搜索结果图，首先，在Y轴方向即消化道垂直方向的轨迹曲线上，以时间T为15分钟为间隔计算胶囊内窥镜轨迹的峰值和谷值，在轨迹内寻找垂直方向最小谷值，即图2和图3中的A部，此时认为胶囊到达最低点时胶囊到达小肠与大肠的分界点，该A点为小肠与大肠的界点。本领域技术人员可以理解，时间T的取值不仅局限于15分钟，也可以根据实际需要进行调整，本发明对此不做限制。其次，选取小肠与大肠分界点之前的轨迹，依次比较前后两个峰值的差值，即图2中B部位置和图3中B部位置，当差值大于5cm时，此时认为胶囊内窥镜开始下降并进入小肠部位，该B点为胃部与小肠分界点。再次，同上方法以此类推，取小肠与大肠分界点之后的轨迹，轨迹内寻找垂直方向最大峰值，认为胶囊内窥镜经升结肠到达最高点并进入横结肠，即图2中C点与图3中C点所示位置，该C点为升结肠与横结肠分界点，取升结肠与横结肠分界点之后的轨迹，依次比较前后两个峰值的差值，当差值大于5cm时，认为胶囊内窥镜开始下降并进入降结肠，该点为横结肠与降结肠分界点。最后，取横结肠与降结肠分界点之后的轨迹，轨迹内寻找垂直方向最小谷值，认为胶囊到达降结肠末端并进入直肠，该点为降结肠与直肠分界点。进一步参考图4本发明胶囊内窥镜的消化道轨迹自动部位划分结果图，通过以上方法自动计算的消化道各部位分界点，将划分的消化道胃部、小肠、升结肠、横结肠、降结肠及直肠分别用途不同符号标记和显示，即为消化道轨迹自动部位划分的结果，如图4所示，出胃部进入小肠的时间如图2所示，约为第60分钟，出小肠进入升结肠时间约为第240分钟，出升结肠进入横结肠时间约为第360分钟，降结肠和直肠以此类推。在胃部滞留时间约为60分钟，在小肠滞留时间约为180分钟，在升结肠滞留时间约为120分钟，降结肠和直肠以此类推。本领域技术人员可以理解的是：进一步还可以将计算得到的胶囊内窥镜轨迹结果，通过FFT变换，转换为频率信息，再利用消化道各部位的运动频率差异，进行消化道各部位划分，并进一步地计算胶囊内窥镜在各部位的通过时间和滞留时间，也可达到与本技术方案相同或相似的结果和目的。本领域普通技术人员可以理解上述实施例的方法中的全部或部分步骤是可以通过一个或多个计算机程序来指令相关的硬件来完成，该程序可以存储于一计算机可读存储介质中，存储介质可以包括：只读存储器、随机存取记忆体、磁盘或光盘等。参考图5本发明胶囊内窥镜消化道轨迹识别标注方法流程图，本发明的胶囊内窥镜消化道轨迹识别标注方法包括以下步骤：步骤501获取胶囊内窥镜的三维运动轨迹；步骤502在垂直方向的轨迹曲线上以时间T为间隔计算胶囊内窥镜轨迹的峰值和谷值；步骤503在全轨迹内寻找垂直方向最小谷值，认为胶囊到达小肠末端并进入大肠；步骤504选取小肠与大肠分界点之前的轨迹，依次比较前后两个峰值的差值，当差值大于阈值时，认为胶囊离开胃部并开始下降进入小肠；步骤505取小肠与大肠分界点之后的轨迹，轨迹内寻找垂直方向最大峰值，认为胶囊经升结肠到达最高点并进入横结肠；步骤506选取升结肠与横结肠分界点之后的轨迹，依次比较前后两个峰值的差值，当差值大于阈值时，认为胶囊开始下降并进入降结肠；步骤507取横结肠与降结肠分界点之后的轨迹，轨迹内寻找垂直方向最小谷值，认为胶囊到达降结肠末端并进入直肠。进一步参考图6本发明胶囊内窥镜的轨迹识别标注设备组成示意图，本发明提供一种胶囊内窥镜的轨迹识别标注设备，所述轨迹识别标注设备包括一个或多个处理器及存储器，其中所述一个或多个计算机程序被存储在所述存储器中，并且被配置成由所述一个或多个处理器执行，所述处理器执行所述计算机程序时实现胶囊内窥镜运行轨迹的识别标注方法的步骤。本发明技术方案根据人体消化道形态结构特征，利用胃部、小肠、升结肠、横结肠、降结肠和直肠六大部位的位置关系，提供了一种消化道六大部位的划分准则，进一步地利用该划分准则通过计算机程序对消化道轨迹进行自动部位划分和计算胶囊在各部位内的通过时间、滞留时间，可将检查结果更快、更直观、更简洁地提供给医生参考，有效减轻了医生的工作负担，提升了检查的准确性和检查效率。以上所述仅为本发明的较佳实施例而已，并不用于限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
