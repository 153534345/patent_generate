标题title
一种基于人脸关键点检测的斜视判别方法和装置
摘要abst
本发明提供了一种基于人脸关键点检测的斜视判别方法和装置，方法包括：获取受试者的若干人脸图像，从每张图像中提取人脸关键点；确定每张人脸图像的左眼关键点和右眼关键点，进而分别获得到左眼外接矩形和右眼外接矩形，通过左眼外接矩形和右眼外接矩形分别裁剪获得每张图像的左眼图像块和右眼图像块并输入至预先训练好的斜视判别模型，基于模型的输出分别确定每张人脸图像在各斜视类别的得分，从而判断所述受试者的斜视类型。本发明从人脸图形中提取人脸关键点，基于人脸关键点裁剪左右眼的图像，相比现有技术，可以充分利用脸部和左右眼之间的相对关系，提高斜视筛查和判别时的准确性，并且可以获得更完整的眼部信息，降低误判的几率。
权利要求书clms
1.一种基于人脸关键点检测的斜视判别方法，其特征在于，包括：获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点；从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块；将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。2.如权利要求1所述的一种基于人脸关键点检测的斜视判别方法，其特征在于，所述基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，具体为：基于所述斜视判别模型的输出，通过预设的分类标签，分别判断每张人脸图像在各斜视类别的得分；所述分类标签包括左眼内斜视标签、左眼外斜视标签、右眼内斜视标签、右眼外斜视标签、左眼上斜视标签、左眼下斜视标签、右眼上斜视标签、右眼下斜视标签和正常标签；每一分类标签与一斜视类别对应。3.如权利要求2所述的一种基于人脸关键点检测的斜视判别方法，其特征在于，所述斜视判别模型的训练过程包括：获取用户样本数据；所述用户样本数据包括若干用户的左眼图像块和右眼图像块以及用户的斜视类别；通过所述用户样本数据对采用深度学习的基础分类模型进行训练，直到所述基础分类模型收敛，获得所述斜视判别模型；所述基础分类模型的输入通道数为6。4.如权利要求3所述的一种基于人脸关键点检测的斜视判别方法，其特征在于，在所述将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型之前，还包括：将所有左眼图像块和所有右眼图像块的尺寸缩放为112x112，并将右眼图像块水平翻转之后与对应的左眼图像块进行通道维度的拼接，获得尺寸为112x112、通道为6的经过预处理的左右眼图像块。5.如权利要求1至4任意一项所述的一种基于人脸关键点检测的斜视判别方法，其特征在于，在所述从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点之前，还包括：根据提取的人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像，并从处于睁眼状态的人脸图像中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，获得经过筛选处理的所述若干人脸图像。6.一种基于人脸关键点检测的斜视判别装置，其特征在于，包括关键点提取模块、图像裁剪模块和判别模块；其中，所述关键点提取模块，用于获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点；所述图像裁剪模块，用于从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块；所述判别模块，用于将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。7.如权利要求6所述的一种基于人脸关键点检测的斜视判别装置，其特征在于，所述判别模块基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，具体为：所述判别模块基于所述斜视判别模型的输出，通过预设的分类标签，分别判断每张人脸图像在各斜视类别的得分；所述分类标签包括左眼内斜视标签、左眼外斜视标签、右眼内斜视标签、右眼外斜视标签、左眼上斜视标签、左眼下斜视标签、右眼上斜视标签、右眼下斜视标签和正常标签；每一分类标签与一斜视类别对应。8.如权利要求7所述的一种基于人脸关键点检测的斜视判别装置，其特征在于，所述斜视判别模型的训练过程包括：获取用户样本数据；所述用户样本数据包括若干用户的左眼图像块和右眼图像块以及用户的斜视类别；通过所述用户样本数据对采用深度学习的基础分类模型进行训练，直到所述基础分类模型收敛，获得所述斜视判别模型；所述基础分类模型的输入通道数为6。9.如权利要求7所述的一种基于人脸关键点检测的斜视判别装置，其特征在于，所述斜视判别装置还包括预处理模块，所述预处理模块用于在所述将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型之前，将所有左眼图像块和所有右眼图像块的尺寸缩放为112x112，并将右眼图像块水平翻转之后与对应的左眼图像块进行通道维度的拼接，获得尺寸为112x112、通道为6的经过预处理的左右眼图像块。10.如权利要求7所述的一种基于人脸关键点检测的斜视判别装置，其特征在于，所述斜视判别装置还包括筛选模块，所述筛选模块用于在所述从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点之前，根据提取的人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像；从处于睁眼状态的人脸图像中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，获得经过筛选处理的所述若干人脸图像。
说明书desc
技术领域本发明涉及斜视判别领域，尤其涉及一种基于人脸关键点检测的斜视判别方法和装置。背景技术斜视会在人的不同年龄阶段出现，斜视类型的不同会相应在年龄段上有差异化的体现。这种现象不仅严重影响人眼睛的美观，而且可能会影响视力的正常发育。斜视与弱视关系密切，有时互为因果关系，例如存在斜视的人视力正常，但是由于他们注视目标时始终只能用一只眼，而另一只眼存在偏斜，导致其视野狭窄，远不如正常人开阔，由此也可能存在弱视的现象。现有技术主要通过三棱镜交替遮盖试验对人是否存在斜视进行检查，但是这种方法需要额外的辅助设备、依赖专家的经验，耗时长且需要受试者的高度配合。目前虽然存在基于人工智能和视频的斜视筛查方法，但是这种方法对瞳孔识别的准确性有高度的依赖，并且没有充分利用脸部和左右眼之间的相对关系，导致在对斜视进行筛查和判别时准确性偏低。发明内容本发明提供了一种基于人脸关键点检测的斜视判别方法和装置，以解决如何提高斜视判别的准确性的技术问题。为了解决上述技术问题，本发明实施例提供了一种基于人脸关键点检测的斜视判别方法，包括：获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点；从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块；将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。作为优选方案，所述基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，具体为：基于所述斜视判别模型的输出，通过预设的分类标签，分别判断每张人脸图像在各斜视类别的得分；所述分类标签包括左眼内斜视标签、左眼外斜视标签、右眼内斜视标签、右眼外斜视标签、左眼上斜视标签、左眼下斜视标签、右眼上斜视标签、右眼下斜视标签和正常标签；每一分类标签与一斜视类别对应。作为优选方案，所述斜视判别模型的训练过程包括：获取用户样本数据；所述用户样本数据包括若干用户的左眼图像块和右眼图像块以及用户的斜视类别；通过所述用户样本数据对采用深度学习的基础分类模型进行训练，直到所述基础分类模型收敛，获得所述斜视判别模型；所述基础分类模型的输入通道数为6。作为优选方案，在所述将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型之前，还包括：将所有左眼图像块和所有右眼图像块的尺寸缩放为112x112，并将右眼图像块水平翻转之后与对应的左眼图像块进行通道维度的拼接，获得尺寸为112x112、通道为6的经过预处理的左右眼图像块。作为优选方案，在所述从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点之前，还包括：根据提取的人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像，并从处于睁眼状态的人脸图像中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，获得经过筛选处理的所述若干人脸图像。相应的，本发明实施例提供了一种基于人脸关键点检测的斜视判别装置，包括关键点提取模块、图像裁剪模块和判别模块；其中，所述关键点提取模块，用于获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点；所述图像裁剪模块，用于从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块；所述判别模块，用于将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。作为优选方案，所述判别模块基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，具体为：所述判别模块基于所述斜视判别模型的输出，通过预设的分类标签，分别判断每张人脸图像在各斜视类别的得分；所述分类标签包括左眼内斜视标签、左眼外斜视标签、右眼内斜视标签、右眼外斜视标签、左眼上斜视标签、左眼下斜视标签、右眼上斜视标签、右眼下斜视标签和正常标签；每一分类标签与一斜视类别对应。作为优选方案，所述斜视判别模型的训练过程包括：获取用户样本数据；所述用户样本数据包括若干用户的左眼图像块和右眼图像块以及用户的斜视类别；通过所述用户样本数据对采用深度学习的基础分类模型进行训练，直到所述基础分类模型收敛，获得所述斜视判别模型；所述基础分类模型的输入通道数为6。作为优选方案，所述斜视判别装置还包括预处理模块，所述预处理模块用于在所述将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型之前，将所有左眼图像块和所有右眼图像块的尺寸缩放为112x112，并将右眼图像块水平翻转之后与对应的左眼图像块进行通道维度的拼接，获得尺寸为112x112、通道为6的经过预处理的左右眼图像块。作为优选方案，所述斜视判别装置还包括筛选模块，所述筛选模块用于在所述从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点之前，根据提取的人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像；从处于睁眼状态的人脸图像中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，获得经过筛选处理的所述若干人脸图像。相比于现有技术，本发明实施例具有如下有益效果：本发明实施例提供了一种基于人脸关键点检测的斜视判别方法和装置，方法包括：获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点；从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块；将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。本发明实施例从人脸图形中提取人脸关键点，基于人脸关键点裁剪左右眼的图像，相比基于瞳孔识别的技术方案，可以充分利用脸部和左右眼之间的相对关系，提高斜视筛查和判别时的准确性；并且，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块，可以获得更完整的眼部信息，避免因瞳孔识别不准导致的误判，提高整体的识别效果。进一步地，通过预设分类标签，分别判断每张人脸图像在各斜视类别的得分，预设的分类标签包括包括九种类型，每种类型分别对应一种斜视类别，进而可以通过各斜视类别的得分判断受试者的斜视类型，可以避免判断结果出现模糊不清的情况，提高了模型的识别效果和稳定性。进一步地，采用深度学习的基础分类模型，且模型的输入通道数为6，在此基础上利用用户样本数据进行训练，学习图像块到类别之间的映射关系，对模型的性能进行优化，可以进一步提高判别的准确性。进一步地，基于人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像，并从中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，通过二次筛选获得更具有效性的用户样本，进一步提高斜视判别的准确性。附图说明图1：为本发明基于人脸关键点检测提供的斜视判别方法的一种实施例的流程示意图。图2：为本发明提供的人脸关键点的一种实施例的示意图。图3：为本发明基于人脸关键点检测提供的斜视判别装置的一种实施例的结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一:根据相关文献记载，人类立体视觉主要出现于出生后3至4个月，并将在3至4岁发育基本成熟，9岁时立体视觉发育结束。根据人类立体视觉的发育进程，可知有斜视现象的婴幼儿在3至5岁接受相应的视觉训练或矫正更有利于立体视觉的恢复，此外3至5岁的时期也是儿童斜视的发生率最高的时期，如果错过了最佳矫正时间，随着斜视者年龄的增大以及病程时间的增加，可能会出现黄斑、抑制视网膜对应异常等病理性改变。因此，及时对斜视等情形进行判别并相应进行矫正，对视力的健康发展极为重要。现有技术在临床上主要通过三棱镜交替遮盖试验对人是否存在斜视进行检查，但是这种方法需要额外的辅助设备、依赖专家的经验，耗时长并且需要受试者的高度配合。目前虽然存在基于人工智能和视频的斜视筛查方法，但是这种方法对瞳孔识别的准确性有高度的依赖，并且没有充分利用脸部和左右眼之间的相对关系，导致在对斜视进行筛查和判别时准确性偏低。针对上述一个或多个技术问题，请参照图1，图1为本发明实施例提供的一种基于人脸关键点检测的斜视判别方法，可以应用于包括但不限于婴幼儿等受试者，所述斜视判别方法包括步骤S1至步骤S3；其中，步骤S1，获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点。在本实施例中，可以通过手机摄像头、笔记本电脑摄像头等，对受试者进行视频的录制，录制过程中囊括受试者的人脸图像，录制的时间为10s，录制过程中受试者不能全程闭眼。从录制得到的拍摄视频中，筛选出符合要求的前n张照片，具体地：按照一个固定的间隔，对拍摄视频的序列帧进行抽帧，每一秒分别作为一个时间段，从每一时间段中等间隔地抽取10张图片，共得到长度为100的图片序列，获得所述受试者的若干人脸图像。然后将所有的人脸图像输入到dlib库提供的人脸检测模块检测受试者的人脸，并将人脸信息输入到现有的PIPNet中，获得如图2所示的人脸关键点。每一张人脸图像都包含若干所述人脸关键点。在步骤S2之前，还包括：根据提取的人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像，并从处于睁眼状态的人脸图像中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，获得经过筛选处理的所述若干人脸图像。例如，以图2为例，通过PIPNet对人脸信息进行识别，可以提取到编号为1至67的人脸关键点，根据提取的关键点可以计算距离d1、d2、d3和d4。其中，距离d1为每张人脸图像人脸关键点38到人脸关键点40之间的距离，距离d2为人脸关键点43到人脸关键点47之间的距离；s1为d1和d2的和。然后根据s1从大到小进行排序，获取排在前30的人脸图像，并过滤掉其余70张人脸图像。然后计算所述前30的人脸图像中每一张的人脸关键点36到人脸关键点39之间的距离d3，以及人脸关键点42到人脸关键点45之间的距离d4，从而获得d3-d4的绝对值s2，按照s2从小到大排序获取排在前5的人脸图像，筛除掉其余25张人脸图像，获得经过二次筛选后的人脸图像。这样可以确保完整的眼部信息，避免获取到闭眼或者眼睛偏移摄像头过大的人脸图像以及人脸关键点，以确保人脸图像以及人脸关键点的有效性，提高判别结果的准确性。步骤S2，从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块。在本实施例中，确定经过二次筛选后的人脸图像中每一张的左眼关键点和右眼关键点，然后根据人脸关键点36到人脸关键点41，得到左眼的人脸关键点的外接矩形，根据人脸关键点42到人脸关键点47，得到右眼的人脸关键点的外接矩形，然后裁剪出以外接矩形的中心点为中心位置，将右眼外接矩形外扩1.2倍的眼部图像块，获得每张人脸图像的左眼图像块和每张人脸图像的右眼图像块。进一步地，在步骤S3之前，还包括：将所有左眼图像块和所有右眼图像块的尺寸缩放为112x112，并将右眼图像块水平翻转之后与对应的左眼图像块进行通道维度的拼接，获得尺寸为112x112、通道为6的经过预处理的左右眼图像块。步骤S3，将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。作为一种优选实施方式，所述斜视判别模型的训练过程包括：获取用户样本数据，该用户样本数据相当于数据集，其包括若干用户的左眼图像块和右眼图像块以及用户的斜视类别；左眼图像块和右眼图像块可以通过人工裁剪的方式获得也可以通过上述方式获得。具体的斜视类别数据来自于用户的历史病历信息或眼部检查历史数据。通过包含若干用户的所述用户样本数据对采用深度学习的基础分类模型进行训练，该基础分类模型可以采用resnet18网络结构，以学习图像块和类别之间的映射关系，提取其中的相关性，直到所述基础分类模型收敛，获得所述斜视判别模型；所述基础分类模型的输入通道数为6。进一步地，在将尺寸为112x112、通道为6的经过预处理的左右眼图像块输入所述预先训练好的斜视判别模型之后，所述基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，具体为：基于所述斜视判别模型的输出，通过预设的分类标签，分别判断每张人脸图像在各斜视类别的得分；所述分类标签包括左眼内斜视标签、左眼外斜视标签、右眼内斜视标签、右眼外斜视标签、左眼上斜视标签、左眼下斜视标签、右眼上斜视标签、右眼下斜视标签和正常标签；每一分类标签与一斜视类别对应。由于受试者共5张人脸图像，因此对于每个斜视类别，分别取五张人脸图像的得分均值，对五张人脸图像进行整合并根据每个类别的得分均值，取其中的最高者作为受试者的斜视类型，判断受试者为左眼内斜视、左眼外斜视、右眼内斜视、右眼外斜视、左眼上斜视、左眼下斜视、右眼上斜视、右眼下斜视还是正常。在本实施例中，将斜视的类型划分为上述九种类别，其判别结果可以满足不同应用场景下的需求。并且，实施本申请实施例，除了摄像头以外，由于不需要额外的辅助设备、可以通过斜视判别模型自动判别受试者的斜视类型而无需受试者的高度配合，因此对婴幼儿等类型的受试者具有较高的适用性。相应的，参照图3，本发明实施例提供了一种基于人脸关键点检测的斜视判别装置，包括关键点提取模块101、图像裁剪模块102和判别模块103；其中，所述关键点提取模块101，用于获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点；所述图像裁剪模块102，用于从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块；所述判别模块103，用于将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。作为优选方案，所述判别模块103基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，具体为：所述判别模块103基于所述斜视判别模型的输出，通过预设的分类标签，分别判断每张人脸图像在各斜视类别的得分；所述分类标签包括左眼内斜视标签、左眼外斜视标签、右眼内斜视标签、右眼外斜视标签、左眼上斜视标签、左眼下斜视标签、右眼上斜视标签、右眼下斜视标签和正常标签；每一分类标签与一斜视类别对应。作为优选方案，所述斜视判别模型的训练过程包括：获取用户样本数据；所述用户样本数据包括若干用户的左眼图像块和右眼图像块以及用户的斜视类别；通过所述用户样本数据对采用深度学习的基础分类模型进行训练，直到所述基础分类模型收敛，获得所述斜视判别模型；所述基础分类模型的输入通道数为6。作为优选方案，所述斜视判别装置还包括预处理模块，所述预处理模块用于在所述将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型之前，将所有左眼图像块和所有右眼图像块的尺寸缩放为112x112，并将右眼图像块水平翻转之后与对应的左眼图像块进行通道维度的拼接，获得尺寸为112x112、通道为6的经过预处理的左右眼图像块。作为优选方案，所述斜视判别装置还包括筛选模块，所述筛选模块用于在所述从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点之前，根据提取的人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像；从处于睁眼状态的人脸图像中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，获得经过筛选处理的所述若干人脸图像。相比于现有技术，本发明实施例具有如下有益效果：本发明实施例提供了一种基于人脸关键点检测的斜视判别方法和装置，方法包括：获取受试者的若干人脸图像，并分别从每张所述受试者的人脸图像中提取人脸关键点；从所述人脸关键点中确定每张人脸图像的左眼关键点和右眼关键点，进而分别基于所述左眼关键点和右眼关键点得到左眼外接矩形和右眼外接矩形，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块；将所述每张人脸图像的左眼图像块和右眼图像块输入至预先训练好的斜视判别模型，并基于所述斜视判别模型的输出分别确定每张人脸图像在各斜视类别的得分，通过所有人脸图像各斜视类别的得分判断所述受试者的斜视类型。本发明实施例从人脸图形中提取人脸关键点，基于人脸关键点裁剪左右眼的图像，相比基于瞳孔识别的技术方案，可以充分利用脸部和左右眼之间的相对关系，提高斜视筛查和判别时的准确性；并且，通过所述左眼外接矩形和右眼外接矩形分别裁剪获得每张人脸图像对应的左眼图像块和右眼图像块，可以获得更完整的眼部信息，避免因瞳孔识别不准导致的误判，提高整体的识别效果。进一步地，通过预设分类标签，分别判断每张人脸图像在各斜视类别的得分，预设的分类标签包括包括九种类型，每种类型分别对应一种斜视类别，进而可以通过各斜视类别的得分判断受试者的斜视类型，可以避免判断结果出现模糊不清的情况，提高了模型的识别效果和稳定性。进一步地，采用深度学习的基础分类模型，且模型的输入通道数为6，在此基础上利用用户样本数据进行训练，学习图像块到类别之间的映射关系，对模型的性能进行优化，可以进一步提高判别的准确性。进一步地，基于人脸关键点之间的距离信息，筛选出处于睁眼状态的人脸图像，并从中筛选出眼睛相对摄像头偏移量处于预设范围的人脸图像，通过二次筛选获得更具有效性的用户样本，进一步提高斜视判别的准确性。以上所述的具体实施例，对本发明的目的、技术方案和有益效果进行了进一步的详细说明，应当理解，以上所述仅为本发明的具体实施例而已，并不用于限定本发明的保护范围。特别指出，对于本领域技术人员来说，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
