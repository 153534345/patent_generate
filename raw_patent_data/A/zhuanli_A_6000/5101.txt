标题title
一种基于多通道格拉姆角场的血压预测方法、系统
摘要abst
本发明提出一种基于多通道格拉姆角场的血压预测方法、系统，涉及血压预测的技术领域，首先构建数据集，数据集中包括基础的PPG信号及血压参考值，然后求解PPG信号的一阶导数信号和二阶导数信号，并将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号转换成格拉姆角场，为降低转换过程中的升维噪声，对格拉姆角场进行分解和重构，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像，最后合并成一张三通道的格拉姆角场图像作为血压预测模型的输入，以血压参考值作为指导，训练血压预测模型以用于血压预测，摒弃了以往传统实现血压预测需要进行的特征提取步骤，减少了工作量，且降低了计算复杂度。
权利要求书clms
1.一种基于多通道格拉姆角场的血压预测方法，其特征在于，所述方法包括以下步骤：S1.采集志愿者的PPG信号及对应的血压参考值，形成数据集，将数据集中每一个PPG信号及其对应的血压参考值作为数据集中的一组数据；S2.将数据集按比例划分为训练集和测试集，分别计算出训练集和测试集中PPG信号的一阶导数信号和二阶导数信号，将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系；S3.根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，计算出PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场；S4.对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构，得到重构后的格拉姆角场，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像；S5.将第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像，得到新的训练集和测试集；S6.构建回归任务卷积神经网络作为血压预测模型，利用训练集训练血压预测模型，得到训练好的血压预测模型；S7.利用测试集输入至血压预测模型得到血压预测结果。2.根据权利要求1所述的基于多通道格拉姆角场的血压预测方法，其特征在于，设数据集表示为D={,，...，}，Xj表示第j个1×n的PPG信号，对于任意一个PPG信号X，表示为：X={x1,x2，...，xn}，n表示一个PPG信号中含有实际信号元素x的个数；Yj表示第j个1×n的PPG信号对应的血压参考值，j=1,2,…,m；在步骤S2中，数据集按比例划分为训练集Dtrain和测试集Dtest，分别为表示为：；；其中，m1+m2=m；设计算出训练集和测试集中PPG信号Xj的一阶导数信号和二阶导数信号分别表示为DXj和SDXj，其中，对于任意一个PPG信号X的一阶导数信号DX，表示为：DX={dx1,dx2，...，dxn},一个一阶导数信号DX中含有实际信号元素dx的个数有n个；对于任意一个PPG信号X的二阶导数信号SDX，表示为：SDX={sdx1,sdx2，...，sdxn}，一个二阶导数信号SDX中含有实际信号元素sdx有n个；在将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系前，对PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号还进行预处理操作。3.根据权利要求2所述的基于多通道格拉姆角场的血压预测方法，其特征在于，所述的预处理操作为：将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号中的每一个实际信号元素均缩放至区间或内；设预处理操作后，PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均统一表征为：其中，表示PPG信号或PPG信号的一阶导数信号或PPG信号的二阶导数信号预处理操作后的统一表征，表示PPG信号或PPG信号的一阶导数信号或PPG信号的二阶导数信号预处理操作后含有的第i个实际信号元素，i=1,2,…,n。4.根据权利要求3所述的基于多通道格拉姆角场的血压预测方法，其特征在于，将中每个实际信号元素的值计算反余弦，以每个实际信号元素的下标作为该实际信号元素的时间戳标记，实际信号元素的时间戳为ti，设总时间长度为N，为自然数；则每个实际信号元素在极坐标系下的半径ri为：;通过对每个实际信号元素进行反余弦计算，将每个实际信号元素按时间序列编码成角度变量，计算表达式为：其中，表示对实际信号元素进行反余弦计算出的角度，当的值在区间时，的值属于区间,当的值在区间时，的值属于区间，因此，利用角度和半径ri将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均能从笛卡尔直角坐标系转换至极坐标系。5.根据权利要求4所述的基于多通道格拉姆角场的血压预测方法，其特征在于，在步骤S3中，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，令每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号中的任意一个的实际信号元素的角度变量表示为{，，…，}，分别求解每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号的实际信号元素间的角度做和后的余弦，得到格拉姆求和角场GASF，表示为：。6.根据权利要求4所述的基于多通道格拉姆角场的血压预测方法，其特征在于，在步骤S3中，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，令每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号中的任意一个的实际信号元素的角度变量表示为{，，…，}，分别求解每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号的实际信号元素间的角度作差后的余弦，得到格拉姆作差角场GADF，表示为：。7.根据权利要求5或6所述的基于多通道格拉姆角场的血压预测方法，其特征在于，在步骤S4中，对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构时，首先，将PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场统一表征为G：；其中，gi,q表示PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场统一表征的格拉姆角场G中的第i行第q列元素，与格拉姆角场里的元素对应，i=1,2，…,n，q=1,2，…,n；然后，使用一个大小为的矩形窗口对格拉姆角场G从左到右、从上到下进行步长为1的滑动取值，取值后得到由构成的4-D轨迹矩阵表示为：；其中，,，1≤u≤，1≤v≤，Kc是W列数的取值范围，Kr是Hi的列数取值范围；是由格拉姆角场G中元素构成的2-D轨迹矩阵；接着，对执行奇异值分解，满足表达式：；其中，为的特征值，和分别为对应的左奇异向量和右奇异向量，；挑选取一组特征向量来重构出新的4-D轨迹矩阵，具体为：=，其中，为重构后的2-D轨迹矩阵；最后，通过对轨迹矩阵进行对角平均化来计算出重构后的格拉姆角场，具体步骤为：得到：；再对执行一次对角平均化，计算出重构后的格拉姆角场：，其中，为重构后的格拉姆角场的元素。8.根据权利要求7所述的基于多通道格拉姆角场的血压预测方法，其特征在于，在步骤S5中，三通道的格拉姆角场图像的格拉姆角场为格拉姆求和角场，表示为，大小为n×n×3，其中，n×n为图像尺寸大小，3为通道数，n由信号长度决定，则训练集表示为：,测试集表示为：,在步骤S6中，构建n×n×3的回归任务卷积神经网络作为血压预测模型，并使用训练集Dtrain训练血压预测模型，在训练过程中，以三通道的格拉姆角场图像的格拉姆角场作为所述血压预测模型的输入，以Y1~Ym1表示的血压参考值作为所述血压预测模型的期望输出，根据血压预测模型的实际输出与所述期望输出，确定损失函数的值，在损失函数收敛时，得到训练好的血压预测模型，最后将测试集Dtest输入至训练好的血压预测模型，得到血压预测结果。9.根据权利要求7所述的基于多通道格拉姆角场的血压预测方法，其特征在于，在步骤S5中，三通道的格拉姆角场图像的格拉姆角场为格拉姆作差角场，表示为，大小为n×n×3，其中，n×n为图像尺寸大小，3为通道数，n由信号长度决定，则训练集表示为：测试集表示为：在步骤S6中，构建n×n×3的回归任务卷积神经网络作为血压预测模型，并使用训练集Dtrain训练血压预测模型，在训练过程中，以三通道的格拉姆角场图像的格拉姆角场作为所述血压预测模型的输入，以Y1~Ym1表示的血压参考值作为所述血压预测模型的期望输出，根据血压预测模型的实际输出与所述期望输出，确定损失函数的值，在损失函数收敛时，得到训练好的血压预测模型，最后将测试集Dtest输入至训练好的血压预测模型，得到血压预测结果。10.一种基于多通道格拉姆角场的血压预测系统，其特征在于，所述血压预测系统包括：数据集采集模块，用于采集志愿者的PPG信号及对应的血压参考值，形成数据集，将数据集中每一个PPG信号及其对应的血压参考值作为数据集中的一组数据；数据集处理模块，将数据集按比例划分为训练集和测试集，分别计算出训练集和测试集中PPG信号的一阶导数信号和二阶导数信号，将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系；格拉姆角场求解模块，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，计算出PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场；分析重构模块，对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构，得到重构后的格拉姆角场，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像；图像合成模块，将第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像，得到新的训练集和测试集；血压预测模型构建与训练模块，构建回归任务卷积神经网络作为血压预测模型，利用训练集训练血压预测模型，得到训练好的血压预测模型；血压预测模块，利用测试集输入至血压预测模型得到血压预测结果。
说明书desc
技术领域本发明涉及血压预测的技术领域，更具体地，涉及一种基于多通道格拉姆角场的血压预测方法、系统。背景技术高血压是一种全球性的慢性疾病，发生频率很高，影响着全世界大多数人的健康。血压值是身体状况的一个基本特征，可为医生提供很多有价值的信息，预测血压以将血压控制在正常范围内，对保障人们的生理健康至关重要。传统通过水银血压计的泵气袖带对使用者施加压力来测量血压的操作既复杂又不方便，而且不允许连续估计血压。目前，随着可穿戴传感器技术的进步，连续血压监测的方法越来越多地被提出，最常使用的就是结合机器学习和生物医学信号来实现连续血压监测。在血压预测方面，从光体积变化描记图法信号提取出关键特征，利用机器学习方法训练出血压预测模型的这种方法尤为常见。如现有技术中公开了一种血压预测方法，首先获取光电容积脉搏波信号及心率值，并对所述光电容积脉搏波信号进行离散余弦变换，以得到频域信号，再对所述频域信号进行低通滤波，以得到滤波后的信号，对滤波后的信号的交流系数进行筛选，以得到降噪信号，然后提取所述降噪信号的特征值，将特征值及心率值作为特征向量输入至预设模型中，以得到血压预测值。在该方法中，通过对信号进行离散余弦变换及系数筛选等处理，可以获得很好的降噪效果，使降噪信号具有更多有价值的特征信息，便于后续特征值的提取，进而提高了血压预测的准确性。但是，这种方法有一个明显的缺点，即需要进行与血压变化相关的特征提取，而后续血压预测的准确率高度依赖于所选特征的有效性。同时，过多冗余的特征会提高计算复杂度，造成预设模型计算缓慢，这在一定程度上又降低了血压预测效率和预测准确性。发明内容为解决现有血压预测的方式对特征提取和筛选的过程繁杂且要求高的问题，本发明提出了一种基于多通道格拉姆角场的血压预测方法、系统，避免了复杂的信号特征提取过程以及冗余特征的产生，实现轻量化预测的同时，提高血压预测的准确率。为了达到上述技术效果，本发明的技术方案如下：一种基于二维奇异谱分析和多通道格拉姆角场的血压预测方法，所述方法包括以下步骤：S1.采集志愿者的PPG信号及对应的血压参考值，形成数据集，将数据集中每一个PPG信号及其对应的血压参考值作为数据集中的一组数据；S2.将数据集按比例划分为训练集和测试集，分别计算出训练集和测试集中PPG信号的一阶导数信号和二阶导数信号，将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系；S3.根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，计算出PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场；S4.对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构，得到重构后的格拉姆角场，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像；S5.将第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像，得到新的训练集和测试集；S6.构建回归任务卷积神经网络作为血压预测模型，利用训练集训练血压预测模型，得到训练好的血压预测模型；S7.利用测试集输入至血压预测模型得到血压预测结果。在本技术方案中，首先构建数据集，数据集中包括基础的PPG信号及血压参考值，然后求解PPG信号的一阶导数信号和二阶导数信号，并直接将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号转换成格拉姆角场，为降低转换过程中产生的升维噪声，对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构，得到重构后的格拉姆角场，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像，最后以第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像作为血压预测模型的输入，以血压参考值作为指导，训练血压预测模型以用于血压预测，摒弃了以往传统实现血压预测需要进行的特征提取步骤，减少了工作量，且降低了计算复杂度。优选地，设数据集表示为D={,，...，}，Xj表示第j个1×n的PPG信号，对于任意一个PPG信号X，表示为：X={x1,x2，...，xn}，n表示一个PPG信号中含有实际信号元素x的个数；Yj表示第j个1×n的PPG信号对应的血压参考值，j=1,2,…,m；在步骤S2中，数据集按比例划分为训练集Dtrain和测试集Dtest，分别为表示为：；；其中，m1+m2=m；设计算出训练集和测试集中PPG信号Xj的一阶导数信号和二阶导数信号分别表示为DXj和SDXj，其中，对于任意一个PPG信号X的一阶导数信号DX，表示为：DX={dx1,dx2，...，dxn},一个一阶导数信号DX中含有实际信号元素dx的个数有n个；对于任意一个PPG信号X的二阶导数信号SDX，表示为：SDX={sdx1,sdx2，...，sdxn}，一个二阶导数信号SDX中含有实际信号元素sdx有n个；在将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系前，对PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号还进行预处理操作。优选地，所述的预处理操作为：将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号中的每一个实际信号元素均缩放至区间或内；设预处理操作后，PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均统一表征为：其中，表示PPG信号或PPG信号的一阶导数信号或PPG信号的二阶导数信号预处理操作后的统一表征，表示PPG信号或PPG信号的一阶导数信号或PPG信号的二阶导数信号预处理操作后含有的第i个实际信号元素，i=1,2,…,n。优选地，将中每个实际信号元素的值计算反余弦，以每个实际信号元素的下标作为该实际信号元素的时间戳标记，实际信号元素的时间戳为ti，设总时间长度为N，为自然数；则每个实际信号元素在极坐标系下的半径ri为：;通过对每个实际信号元素进行反余弦计算，将每个实际信号元素按时间序列编码成角度变量，计算表达式为：其中，表示对实际信号元素进行反余弦计算出的角度，当的值在区间时，的值属于区间,当的值在区间时，的值属于区间，因此，利用角度和半径ri将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均能从笛卡尔直角坐标系转换至极坐标系。优选地，在步骤S3中，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，分别求解每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号的实际信号元素间的角度做和后的余弦，得到格拉姆求和角场GASF，表示为：。优选地，在步骤S3中，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，分别求解每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号的实际信号元素间的角度作差后的余弦，得到格拉姆作差角场GADF，表示为：。在此，基于格拉姆求和角场GASF或格拉姆作差角场GADF即可分别得到每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号对应的格拉姆角场。优选地，在步骤S4中，对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构时，首先，将PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场统一表征为G：；其中，gi,q表示PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场统一表征的格拉姆角场G中的第i行第q列元素，与格拉姆角场里的元素对应，i=1,2，…,n，q=1,2，…,n；然后，使用一个大小为的矩形窗口对格拉姆角场G从左到右、从上到下进行步长为1的滑动取值，取值后得到由构成的4-D轨迹矩阵表示为：；其中，,，1≤u≤，1≤v≤，Kc是W列数的取值范围，Kr是Hi的列数取值范围；是由格拉姆角场G中元素构成的2-D轨迹矩阵；接着，对执行奇异值分解，满足表达式：。其中，为的特征值，和分别为对应的左奇异向量和右奇异向量，；挑选取一组特征向量来重构出新的4-D轨迹矩阵，具体为：=，其中，为重构后的2-D轨迹矩阵；最后，通过对轨迹矩阵进行对角平均化来计算出重构后的格拉姆角场，具体步骤为：得到：；再对执行一次对角平均化，计算出重构后的格拉姆角场：，其中，为重构后的格拉姆角场的元素。在此，考虑将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号转换成格拉姆角场时，在转换过程中会产生一定的升维噪声，会降低血压预测的准确率，在这里对PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号对应的格拉姆角场进行分解和重构，得到各自重构后的格拉姆角场作为第一通道图像、第二通道图像及第三通道图像，重构后的格拉姆角场去除了原本所存在的噪声。优选地，在步骤S5中，三通道的格拉姆角场图像的格拉姆角场为格拉姆求和角场，表示为，大小为n×n×3，其中，n×n为图像尺寸大小，3为通道数，n由信号长度决定，则训练集表示为：测试集表示为：,在步骤S5中，构建n×n×3的回归任务卷积神经网络作为血压预测模型，并使用训练集Dtrain训练血压预测模型，在训练过程中，以三通道的格拉姆角场图像的格拉姆角场作为所述血压预测模型的输入，以Y1~Ym1表示的血压参考值作为所述血压预测模型的期望输出，根据血压预测模型的实际输出与所述期望输出，确定损失函数的值，在损失函数收敛时，得到训练好的血压预测模型，最后将测试集Dtest输入至训练好的血压预测模型，得到血压预测结果。优选地，在步骤S4中，三通道的格拉姆角场图像的格拉姆角场为格拉姆作差角场，表示为，大小为n×n×3，其中，n×n为图像尺寸大小，3为通道数，n由信号长度决定，则训练集表示为：测试集表示为：在步骤S5中，构建n×n×3的回归任务卷积神经网络作为血压预测模型，并使用训练集Dtrain训练血压预测模型，在训练过程中，以三通道的格拉姆角场图像的格拉姆角场作为所述血压预测模型的输入，以Y1~Ym1表示的血压参考值作为所述血压预测模型的期望输出，根据血压预测模型的实际输出与所述期望输出，确定损失函数的值，在损失函数收敛时，得到训练好的血压预测模型，最后将测试集Dtest输入至训练好的血压预测模型，得到血压预测结果。本申请还提出一种基于二维奇异谱分析和多通道格拉姆角场的血压预测系统，所述血压预测系统包括：数据集采集模块，用于采集志愿者的PPG信号及对应的血压参考值，形成数据集，将数据集中每一个PPG信号及其对应的血压参考值作为数据集中的一组数据；数据集处理模块，将数据集按比例划分为训练集和测试集，分别计算出训练集和测试集中PPG信号的一阶导数信号和二阶导数信号，将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系；格拉姆角场求解模块，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，计算出PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场；分析重构模块，对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构，得到重构后的格拉姆角场，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像；图像合成模块，将第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像，得到新的训练集和测试集；血压预测模型构建与训练模块，构建回归任务卷积神经网络作为血压预测模型，利用训练集训练血压预测模型，得到训练好的血压预测模型；血压预测模块，利用测试集输入至血压预测模型得到血压预测结果。本申请还提出一种医疗设备，所述医疗设备应用所述的基于二维奇异谱分析和多通道格拉姆角场的血压预测方法进行血压预测。与现有技术相比，本发明技术方案的有益效果是：本发明提出一种基于多通道格拉姆角场的血压预测方法、系统，首先构建数据集，数据集中包括基础的PPG信号及血压参考值，然后求解PPG信号的一阶导数信号和二阶导数信号，并直接将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号转换成格拉姆角场，为降低转换过程中产生的升维噪声，对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构，得到重构后的格拉姆角场，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像，最后以第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像作为血压预测模型的输入，以血压参考值作为指导，训练血压预测模型以用于血压预测，摒弃了以往传统实现血压预测需要进行的特征提取步骤，减少了工作量，且降低了计算复杂度。附图说明图1表示本发明实施例1中提出的基于二维奇异谱分析和多通道格拉姆角场的血压预测方法的流程示意图；图2表示本发明实施例1中提出的将PPG信号转换成格拉姆求和角场后得到的第一通道图像；图3表示本发明实施例1中提出的将PPG信号的一阶导数信号转换成格拉姆求和角场后得到的第二通道图像；图4表示本发明实施例1中提出的将PPG信号的二阶导数信号转换成格拉姆求和角场后得到的第三通道图像；图5表示本发明实施例1中提出的将第一通道图像、第二通道图像及第三通道图像合成一张三通道图像的示意图；图6表示本发明实施例2中提出的将PPG信号转换成格拉姆作差角场后得到的第一通道图像；图7表示本发明实施例2中提出的将PPG信号的一阶导数信号转换成格拉姆作差角场后得到的第二通道图像；图8表示本发明实施例2中提出的将PPG信号的二阶导数信号转换成格拉姆作差角场后得到的第三通道图像；图9表示本发明实施例2中提出的将第一通道图像、第二通道图像及第三通道图像合成一张三通道图像的示意图；图10表示本发明实施例2中提出的应用基于二维奇异谱分析和多通道格拉姆角场的血压预测方法的得出的收缩压参考值与血压估计值的相关系数图；图11表示本发明实施例2中提出的应用基于二维奇异谱分析和多通道格拉姆角场的血压预测方法的得出的舒张压参考值与血压估计值的相关系数图；图12表示本发明实施例3中提出的基于二维奇异谱分析和多通道格拉姆角场的血压预测系统的结构图。具体实施方式附图仅用于示例性说明，不能理解为对本专利的限制；为了更好地说明本实施例，附图某些部位会有省略、放大或缩小，并不代表实际尺寸；对于本领域技术人员来说，附图中某些公知内容说明可能省略是可以理解的。下面结合附图和实施例对本发明的技术方案做进一步的说明。附图中描述位置关系的仅用于示例性说明，不能理解为对本专利的限制；实施例1如图1所示，本实施例提出一种基于二维奇异谱分析和多通道格拉姆角场的血压预测方法，参见图1，所述方法包括以下步骤：S1.采集志愿者的PPG信号及对应的血压参考值，形成数据集，将数据集中每一个PPG信号及其对应的血压参考值作为数据集中的一组数据；设数据集表示为D={,，...，}，Xj表示第j个1×n的PPG信号，对于任意一个PPG信号X，表示为：X={x1,x2，...，xn}，n表示一个PPG信号中含有实际信号元素x的个数；Yj表示第j个1×n的PPG信号对应的血压参考值，j=1,2,…,m；S2.将数据集按比例划分为训练集和测试集，分别计算出训练集和测试集中PPG信号的一阶导数信号和二阶导数信号，将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系；在本实施例中，将数据集按8：2的比例划分为训练集Dtrain和测试集Dtest，分别为表示为：；；其中，m1+m2=m；设计算出训练集和测试集中PPG信号Xj的一阶导数信号和二阶导数信号分别表示为DXj和SDXj，其中，对于任意一个PPG信号X的一阶导数信号DX，表示为：DX={dx1,dx2，...，dxn},一个一阶导数信号DX中含有实际信号元素dx的个数有n个；对于任意一个PPG信号X的二阶导数信号SDX，表示为：SDX={sdx1,sdx2，...，sdxn}，一个二阶导数信号SDX中含有实际信号元素sdx有n个；分别计算出训练集和测试集中PPG信号的一阶导数信号和二阶导数信号的过程即是对原PPG信号求一阶导数和二阶导数的基本数学问题，可以使用一阶向前差分法计算PPG信号的导数，PPG信号的二阶导数信号是在其一阶导数的基础上进行的，此处不再赘述具体的过程。在将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系前，对PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号还进行预处理操作，该预处理操作为：将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号中的每一个实际信号元素均缩放至区间或内；以PPG信号的缩放为例，PPG信号X中每一个实际信号元素x缩放至区间时满足的缩放表达式为：其中，表示PPG信号X中第i个实际信号元素xi缩放至区间对应的值，min表示PPG信号X中所有实际信号元素的最小值，max表示PPG信号X中所有实际信号元素的最大值；缩放至区间时满足的缩放表达式为：其中，表示PPG信号X中第i个实际信号元素xi缩放至区间对应的值。综上，设预处理操作后，PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均统一表征为：其中，表示PPG信号或PPG信号的一阶导数信号或PPG信号的二阶导数信号预处理操作后的统一表征，即这里不特指具体是哪一个信号，但是PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号中的每一个信号均进行了预操作处理，表示PPG信号或PPG信号的一阶导数信号或PPG信号的二阶导数信号预处理操作后含有的第i个实际信号元素，i=1,2,…,n，将中每个实际信号元素的值计算反余弦，以每个实际信号元素的下标作为该实际信号元素的时间戳标记，实际信号元素的时间戳为ti，设总时间长度为N，为自然数；则每个实际信号元素在极坐标系下的半径ri为：;通过对每个实际信号元素进行反余弦计算，将每个实际信号元素按时间序列编码成角度变量，计算表达式为：其中，表示对实际信号元素进行反余弦计算出的角度，当的值在区间时，的值属于区间,当的值在区间时，的值属于区间，因此，利用角度和半径ri将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均能从笛卡尔直角坐标系转换至极坐标系。这是一种基于极坐标系去寻找一维时间序列潜在信息的新方法,首先存在单调特性，且每个角度变量拥有唯一的时间戳，这说明整个编码是双射的,即当给定一个时间序列时，该序列在极坐标系中仅映射出唯一的结果，并且该结果的逆映射也唯一。其次，在极坐标系中ri保持了绝对的时间关系，以PPG信号为时间序列信号为例，利用上面定义的公式就可以将PPG信号从笛卡尔直角坐标系转换到极坐标系上。然后执行步骤S3:S3.根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，计算出PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场，基于格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像；在步骤S3中，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，令每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号中的任意一个的实际信号元素的角度变量表示为{，，…，}，分别求解每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号的实际信号元素间的角度做和后的余弦，得到格拉姆求和角场GASF，表示为：。基于二维奇异谱分析对PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号对应的格拉姆求角场进行分解和重构处理，得到各自重构后的格拉姆求和角场，执行步骤S4：S4.在步骤S4中，对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构时，首先，将PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场统一表征为G：；其中，gi,q表示PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场统一表征的格拉姆角场G中的第i行第q列元素，与格拉姆角场里的元素对应，i=1,2，…,n，q=1,2，…,n；然后，使用一个大小为的矩形窗口对格拉姆角场G从左到右、从上到下进行步长为1的滑动取值，取值后得到由构成的4-D轨迹矩阵表示为：；其中，,，1≤u≤，1≤v≤，Kc是W列数的取值范围，Kr是Hi的列数取值范围；是由格拉姆角场G中元素构成的2-D轨迹矩阵；接着，对执行奇异值分解，满足表达式：。其中，为的特征值，和分别为对应的左奇异向量和右奇异向量，；挑选取一组特征向量来重构出新的4-D轨迹矩阵，具体为：=，其中，为重构后的2-D轨迹矩阵；最后，通过对轨迹矩阵进行对角平均化来计算出重构后的格拉姆角场，具体步骤为：得到：；再对执行一次对角平均化，计算出重构后的格拉姆角场：，其中，为重构后的格拉姆角场的元素。对PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号对应的格拉姆求角场进行分解和重构处理，得到各自重构后的格拉姆求和角后，分别将其作为第一通道图像、第二通道图像及第三通道图像，如图2~4所示，执行步骤S5：S5.将第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像，得到新的训练集和测试集；由第一通道图像、第二通道图像及第三通道图像合成一张三通道的格拉姆角场图像的示意图如图5所示，具体可采用Opencv2之cv2函数进行处理，使用组合的方式将各个通道图像组合成一张三通道的格拉姆求和图片，代替了传统从PPG信号、一阶导数信号和二阶导数信号中提取关键点特征的方式，传统从信号中提取关键点特征的方式对是否能够精确找到与血压变化有关的特征要求很高，并且往往会产生冗余的特征，将PPG信号、一阶导数信号和二阶导数信号经过分解和重构后的图像组合在一起，不仅实现了在一张图中就能够包含三种信号的特征，而且不用经过特征提取就能够直接输入到模型中进行训练和测试，降低了计算复杂度和提高了模型的训练效率。三通道的格拉姆角场图像的格拉姆角场为格拉姆求和角场，表示为，大小为n×n×3，其中，n×n为图像尺寸大小，3为通道数，n由信号长度决定，则训练集表示为：测试集表示为：S6.构建回归任务卷积神经网络作为血压预测模型，利用训练集训练血压预测模型，得到训练好的血压预测模型；在步骤S6中，构建n×n×3的回归任务卷积神经网络作为血压预测模型，在此处，具体回归任务卷积神经网络的构建作为已知，可采用现有比较常用的回归任务卷积神经网络作为血压预测模型，不作强调保护，使用训练集Dtrain训练血压预测模型，在训练过程中，以三通道的格拉姆角场图像的格拉姆角场作为所述血压预测模型的输入，以Y1~Ym1表示的血压参考值作为所述血压预测模型的期望输出，根据血压预测模型的实际输出与所述期望输出，确定损失函数的值，在损失函数收敛时，得到训练好的血压预测模型，最后将测试集Dtest输入至训练好的血压预测模型，得到血压预测结果。S7.利用测试集输入至血压预测模型得到血压预测结果。实施例2本实施例与实施例1区别的地方在于，在步骤S3中，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，分别求解每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号的实际信号元素间的角度作差后的余弦，得到格拉姆作差角场GADF，表示为：。基于二维奇异谱分析对每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号对应的格拉姆作差角场进行分解和重构，得到各自重构后的格拉姆作差角场。基于重构后的格拉姆作差角场分别得到第一通道图像、第二通道图像及第三通道图像分别如图6~图8所示，由第一通道图像、第二通道图像及第三通道图像合成一张三通道的格拉姆角场图像的示意图如图9所示，具体可采用Opencv2之cv2函数进行处理，应用基于二维奇异谱分析和多通道格拉姆角场的血压预测方法的得出的收缩压参考值与血压估计值的相关系数图如图10所示，应用基于二维奇异谱分析和多通道格拉姆角场的血压预测方法的得出的舒张压参考值与血压估计值的相关系数图如图11所示，图10的横坐标表示收缩压参考值，纵坐标表示收缩压估计值，图11的横坐标表示舒张压参考值，纵坐标表示舒张压估计值，无论是收缩压还是舒张压，采用本实施例提出的基于二维奇异谱分析和多通道格拉姆角场的血压预测方法进行血压预测的结果，都具有较强的相关性。实施例3如图12所示，本申请还提出一种基于二维奇异谱分析和多通道格拉姆角场的血压预测系统，参见图12，所述血压预测系统包括：数据集采集模块101，用于采集志愿者的PPG信号及对应的血压参考值，形成数据集，将数据集中每一个PPG信号及其对应的血压参考值作为数据集中的一组数据；数据集处理模块102，将数据集按比例划分为训练集和测试集，分别计算出训练集和测试集中PPG信号的一阶导数信号和二阶导数信号，将PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号均从笛卡尔直角坐标系转换至极坐标系；格拉姆角场求解模块103，根据每个PPG信号、PPG信号的一阶导数信号和PPG信号的二阶导数信号在极坐标系中的角度，计算出PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场，基于格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像；分析重构模块104：对PPG信号、一阶导数信号及二阶导数信号对应的格拉姆角场进行分解和重构，得到重构后的格拉姆角场，基于重构后的格拉姆角场分别得到第一通道图像、第二通道图像及第三通道图像；图像合成模块105，将第一通道图像、第二通道图像及第三通道图像合并成一张三通道的格拉姆角场图像，得到新的训练集和测试集；血压预测模型构建与训练模块106，构建回归任务卷积神经网络作为血压预测模型，利用训练集训练血压预测模型，得到训练好的血压预测模型；血压预测模块107，利用测试集输入至血压预测模型得到血压预测结果。显然，本发明的上述实施例仅是为清楚地说明本发明所作的举例，而并非是对本发明的实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明权利要求的保护范围之内。
