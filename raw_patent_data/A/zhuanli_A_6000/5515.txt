标题title
适用于输尿管软镜末端的探镜角度校准方法、终端及介质
摘要abst
本发明公开了一种适用于输尿管软镜末端的探镜角度校准方法、终端及介质，包括：建立坐标系；获得探镜采集的降噪处理的第二图像；对第二图像进行特征点提取，并筛选第一关键点；获得探镜采集的降噪处理的第四图像；对第四图像进行特征点提取，并筛选第二关键点；对第一关键点和第二关键点进行粗匹配，获得输尿管软镜末端绕轴向旋转时的实际角位移；对比误差值和校准阈值，不符则改变驱动角位移；通过本发明的校准方法可以实现在确定期望角位移后，自动修正驱动角位移的目的，从而使得每次对输尿管软镜外端的控制均能满足内端探镜的旋转需求。
权利要求书clms
1.一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，包括：建立世界坐标系与探镜坐标系的模型，并确定探镜拍摄的图像的像素坐标系；获得探镜采集的第一图像，并对图像进行降噪处理，获得第二图像；对第二图像进行特征点提取，对特征点排序，并筛选第一关键点；根据期望角位移θ0确定驱动角位移θw，所述驱动角位移为输尿管软镜外端的转动角度；获得探镜采集的第三图像，并对图像进行降噪处理，获得第四图像；对第四图像进行特征点提取，对特征点排序，并筛选第二关键点；对第一关键点和第二关键点进行粗匹配，获得第二图像和第四图像的映射矩阵；获得输尿管软镜末端绕轴向旋转时的实际角位移θ，并确定校准误差值Ec＝θ0-θ；确定校准阈值E0，若|E0|＜|Ec|，则改变θw，直至|E0|＞|Ec|。2.根据权利要求1所述的一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，确定探镜拍摄的图像的图像坐标系的方法包括：建立世界坐标系T，所述世界坐标系中包含泌尿系统的三维信息；建立探镜坐标系T，并确定世界坐标系与探镜坐标系的变换关系式：其中R为3×3旋转矩阵，Q为3×1平移矩阵；建立图像的物理坐标系T，探镜坐标系变换到物理坐标系的变换关系式为：其中f为探镜的焦距；建立图像的像素坐标系T，所述像素坐标系为泌尿系统的三维信息在图像平面上的二维投影，物理坐标系变换到像素坐标系的变换关系式：其中fu为图像平面上X轴方向上单位距离内的像素数，fv为图像平面上Y轴方向上单位距离内的像素数，为图像的物理坐标系的中心坐标。3.根据权利要求2所述的一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，获得探镜采集的第一图像/获得探镜采集的第三图像后，还包括：以第一图像/第三图像为待处理图像，并确定待处理图像的中心；以中心为圆心，RROI为半径，确定将要进行降噪处理的感兴趣区域。4.根据权利要求3所述的一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，对图像进行降噪处理的方法包括：建立4个残差网络，在每个残差网络内设置多个卷积层，并以线性修正单元激活函数ReLU为激活函数；将不包含噪声的训练样本进行二维离散平稳小波分解，获得3个第一高频分量和第一低频分量；对不包含噪声的训练样本添加噪声，并将包含噪声的训练样本进行二维离散平稳小波分解，获得3个第二高频分量和第二低频分量；分解公式为：＝swt2，其中P表示待分解图像，z表示分解尺度，L表示低频分量，H表示水平方向高频分量，V表示垂直方向高频分量，D表示45°夹角方向高频分量，'haar'表示小波分解时使用haar基；将3个第二高频分量和第二低频分量输入残差网络，并通过损失函数进行反向调节参数，直至达到网络收敛，损失函数为：其中Li表示第i幅输入图像的分量，R表示残差网络的输出，Ri表示实际残差，m为残差网络进行一次迭代训练的训练样本数量；获得完成训练的4个残差网络；对待处理图像进行二维离散平稳小波分解，获得3个高频分量和低频分量，并将4个分量输入残差网络；获得预测分量，并进行平稳小波逆变换获得去噪图像其中，表示去噪后的低频分量，表示去噪后的水平方向高频分量，表示去噪后的垂直方向高频分量，表示去噪后的45°夹角方向高频分量。5.根据权利要求3所述的一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，所述第一关键点/所述第二关键点的获得方法包括：通过FAST特征检测器对第二图像/第四图像进行特征提取，获得多个特征点；通过Harris角点检测器对多个特征点进行排序和筛选，确定第一关键点/第二关键点。6.根据权利要求3所述的一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，对第一关键点和第二关键点进行粗匹配的方法包括：在以关键点为圆心，半径为R的局部区域中定义阶矩：其中G为点处的灰度值，mpq为第p+q阶的阶距，p和q为阶距数且为非负整数；确定局部区域的质心，并获得关键点的方向角α＝arctan；通过BRIEF描述子对关键点进行编码，获得二进制灰度测试表达式：其中G和G为点a和点b处的灰度值；在局部区域X中进行n次灰度测试，获得测试n个点后形成矩阵对矩阵S进行旋转，获得Sα＝RαS，其中Rα为α所对应的旋转矩阵；确定改进后的rBRIEF描述子，gn＝Fn∈Sα；求得第一关键点的rBRIEF描述子和第二关键点的rBRIEF描述子，使用基于汉明距离的暴力匹配进行粗匹配，并通过异或计算量化相似度：其中K1为第一关键点的rBRIEF描述子，K2为第二关键点的rBRIEF描述子，K1＝c1c2…cn，K2＝d1d2…dn。7.根据权利要求6所述的一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，获得第二图像和第四图像的映射矩阵的方法包括：确定第二图像的多个第一关键点T和第四图像的多个第二关键点T；建立第一关键点和第二关键点的映射关系其中H为单应矩阵，获得单应矩阵求解公式：选取4个具有映射关系的第一关键点和第二关键点，并基于SVD分解方法求解单应矩阵，获得输尿管软镜末端绕轴向旋转时的实际角位移θ，其中4个具有映射关系的第一关键点和第二关键点中的任意3个点处于非共线状态。8.根据权利要求7所述的一种适用于输尿管软镜末端的探镜角度校准方法，其特征在于，若θ0＜θ，则控制θw减小；若θ0＞θ，则控制θw增大。9.一种适用于输尿管软镜末端的探镜角度校准终端，包括存储器、处理器以及存储在存储器中并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1-8中任一项所述的一种适用于输尿管软镜末端的探镜角度校准方法的步骤。10.一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1-8中任一项所述的一种适用于输尿管软镜末端的探镜角度校准方法的步骤。
说明书desc
技术领域本发明涉及医疗器械控制技术领域，具体涉及一种适用于输尿管软镜末端的探镜角度校准方法、终端及介质。背景技术泌尿系统结石是一种世界范围内非常常见的疾病.统计数据显示，泌尿系统结石的发病率呈上升趋势，现阶段针对泌尿系统结石较多的采用输尿管软镜术，输尿管软镜术是利用输尿管软镜经尿道、膀胱、输尿管等自然腔道至肾盂进行手术的技术。现阶段的输尿管软镜的结构为，通过设置在外端的电机带动软尿管软镜旋转，从而达到控制末端探镜转动的目的。然而在手术过程中，由于人体自然腔道的约束，当输尿管软镜绕轴向旋转时，其具有探镜的末端存在明显的运动偏差，这就导致了在人体外控制输尿管软镜旋转了一定角度，例如10°，本意是希望输尿管软镜的末端探镜也旋转10°，但是在运动偏差的影响下，导致末端探镜仅旋转了5°，为了实现对探镜10°的旋转，需要继续对输尿管软镜外端旋转，这就导致对输尿管软镜的操作外端和末端出现了割裂感，需要输尿管软镜外端持续转动更长时间，导致在不同情况下需要末端探镜转动相同角度时，外端的转动时间不一致。发明内容本发明所要解决的技术问题是输尿管软镜的外端旋转角度与输尿管软镜的末端探镜旋转角度不匹配，目的在于提供一种适用于输尿管软镜末端的探镜角度校准方法、终端及介质，对输尿管软镜末端的探镜角度进行校准，减少外端与内端的操作割裂感。本发明通过下述技术方案实现：一种适用于输尿管软镜末端的探镜角度校准方法，包括：建立世界坐标系与探镜坐标系的模型，并确定探镜拍摄的图像的像素坐标系；获得探镜采集的第一图像，并对图像进行降噪处理，获得第二图像；对第二图像进行特征点提取，对特征点排序，并筛选第一关键点；根据期望角位移θ0确定驱动角位移θw，所述驱动角位移为输尿管软镜外端的转动角度；获得探镜采集的第三图像，并对图像进行降噪处理，获得第四图像；对第四图像进行特征点提取，对特征点排序，并筛选第二关键点；对第一关键点和第二关键点进行粗匹配，获得第二图像和第四图像的映射矩阵；获得输尿管软镜末端绕轴向旋转时的实际角位移θ，并确定校准误差值Ec＝θ0-θ；确定校准阈值E0，若|E0|＜|Ec|，则改变θw，直至|E0|＞|Ec|。可选地，确定探镜拍摄的图像的图像坐标系的方法包括：建立世界坐标系T，所述世界坐标系中包含泌尿系统的三维信息；建立探镜坐标系T，并确定世界坐标系与探镜坐标系的变换关系式：其中R为3×3旋转矩阵，T为3×1平移矩阵；建立图像的物理坐标系T，探镜坐标系变换到物理坐标系的变换关系式为：其中f为探镜的焦距；建立图像的像素坐标系T，所述像素坐标系为泌尿系统的三维信息在图像平面上的二维投影，物理坐标系变换到像素坐标系的变换关系式：其中fu为图像平面上X轴方向上单位距离内的像素数，fv为图像平面上Y轴方向上单位距离内的像素数，为图像的物理坐标系的中心坐标。可选地，获得探镜采集的第一图像/获得探镜采集的第三图像后，还包括：以第一图像/第三图像为待处理图像，并确定待处理图像的中心；以中心为圆心，RROI为半径，确定将要进行降噪处理的感兴趣区域。可选地，对图像进行降噪处理的方法包括：建立4个残差网络，在每个残差网络内设置多个卷积层，并以线性修正单元激活函数ReLU为激活函数；将不包含噪声的训练样本进行二维离散平稳小波分解，获得3个第一高频分量和第一低频分量；对不包含噪声的训练样本添加噪声，并将包含噪声的训练样本进行二维离散平稳小波分解，获得3个第二高频分量和第二低频分量；分解公式为：＝swt2，其中P表示待分解图像，z表示分解尺度，L表示低频分量，H表示水平方向高频分量，V表示垂直方向高频分量，D表示45°夹角方向高频分量，'haar'表示小波分解时使用haar基；将3个第二高频分量和第二低频分量输入残差网络，并通过损失函数进行反向调节参数，直至达到网络收敛，损失函数为：其中Li表示第i幅输入图像的分量，R表示残差网络的输出，Ri表示实际残差，m为残差网络进行一次迭代训练的训练样本数量；获得完成训练的4个残差网络；对待处理图像进行二维离散平稳小波分解，获得3个高频分量和低频分量，并将4个分量输入残差网络；获得预测分量，并进行平稳小波逆变换获得去噪图像其中，表示去噪后的低频分量，表示去噪后的水平方向高频分量，表示去噪后的垂直方向高频分量，表示去噪后的45°夹角方向高频分量。可选地，所述第一关键点/所述第二关键点的获得方法包括：通过FAST特征检测器对第二图像/第四图像进行特征提取，获得多个特征点；通过Harris角点检测器对多个特征点进行排序和筛选，确定第一关键点/第二关键点。可选地，对第一关键点和第二关键点进行粗匹配的方法包括：在以关键点为圆心，半径为R的局部区域中定义阶矩：其中G为点处的灰度值，mpq为第p+q阶的阶距，p和q为阶距数且为非负整数；确定局部区域的质心，并获得关键点的方向角α＝arctan；通过BRIEF描述子对关键点进行编码，获得二进制灰度测试表达式：其中G和G为点a和点b处的灰度值；在局部区域X中进行n次灰度测试，获得测试n个点后形成矩阵对矩阵S进行旋转，获得Sα＝RαS，其中Rα为α所对应的旋转矩阵；确定改进后的rBRIEF描述子，gn＝Fn∈Sα；求得第一关键点的rBRIEF描述子和第二关键点的rBRIEF描述子，使用基于汉明距离的暴力匹配进行粗匹配，并通过异或计算量化相似度：其中K1为第一关键点的rBRIEF描述子，K2为第二关键点的rBRIEF描述子，K1＝c1c2…cn，K2＝d1d2…dn。可选地，获得第二图像和第四图像的映射矩阵的方法包括：确定第二图像的多个第一关键点T和第四图像的多个第二关键点T；建立第一关键点和第二关键点的映射关系其中H为单应矩阵，获得单应矩阵求解公式：选取4个具有映射关系的第一关键点和第二关键点，并基于SVD分解方法求解单应矩阵，获得输尿管软镜末端绕轴向旋转时的实际角位移θ。具体地，4个具有映射关系的第一关键点和第二关键点中的任意3个点处于非共线状态。若θ0＜θ，则控制θw减小；若θ0＞θ，则控制θw增大。第二方面，一种适用于输尿管软镜末端的探镜角度校准终端，包括存储器、处理器以及存储在存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现如上述的一种适用于输尿管软镜末端的探镜角度校准方法的步骤。第三方面，一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现如上述的一种适用于输尿管软镜末端的探镜角度校准方法的步骤。本发明与现有技术相比，具有如下的优点和有益效果：本发明通过建立相应的坐标系，并确定期望角位移和驱动角位移，获得探镜在转动前的第一图像和转动后的第三图像，并计算获得探镜在肾盂内的实际角位移，确定校准误差值，若实际角位移与期望角位移的误差过大，则改变驱动角位移的值直至误差在阈值范围内；通过本发明的校准方法可以实现在确定期望角位移后，自动修正驱动角位移的目的，从而使得每次对输尿管软镜外端的控制均能满足内端探镜的旋转需求。附图说明附图示出了本发明的示例性实施方式，并与其说明一起用于解释本发明的原理，其中包括了这些附图以提供对本发明的进一步理解，并且附图包括在本说明书中并构成本说明书的一部分，并不构成对本发明实施例的限定。图1是根据本发明所述的一种适用于输尿管软镜末端的探镜角度校准方法的流程示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚明白，下面结合附图和实施方式对本发明作进一步的详细说明。可以理解的是，此处所描述的具体实施方式仅用于解释相关内容，而非对本发明的限定。另外还需要说明的是，为了便于描述，附图中仅示出了与本发明相关的部分。在不冲突的情况下，本发明中的实施方式及实施方式中的特征可以相互组合。下面将参考附图并结合实施方式来详细说明本发明。在输尿管软镜的实际使用中，使用者的最终目的是控制探镜的旋转角度，但是因为探镜末端与输尿管外端的电机之间转动角度存在运动偏差，则可能出现的情况是：探镜在此时此刻需要转动10°时，电机实际转动的角度为12°。而探镜在彼时彼刻需要转动10°时，电机的实际转动角度为18°。不同时间不同环境不同患者均可能导致探镜与电机的转动角度存在偏差，而现阶段较多的输尿管软镜的电机为固定转速，则导致需要探镜转动固定角度的时间不相同，从而使得使用者在操作上存在较大的割裂感。实施例一为了解决上述技术问题，本实施例提供一种适用于输尿管软镜末端的探镜角度校准方法，包括：第一步，建立世界坐标系与探镜坐标系的模型，并确定探镜拍摄的图像的像素坐标系。输尿管软镜末端的探镜是一种手-眼视觉探头，可以通过图像域信息获得末端探镜的状态，并通过坐标系的转换，可以将二维信息转换到世界坐标系，从而可以方便使用者控制探镜在肾盂内的位置。第二步，获得探镜采集的第一图像，并对图像进行降噪处理，获得第二图像；第一图像为输尿管软镜转动前探镜采集的图像，探镜采集的图像位于体内，并且因为探镜的尺寸较小，因此可能有较多的噪声干扰，需要对其进行降噪处理。第三步，对第二图像进行特征点提取，对特征点排序，并筛选第一关键点。可以通过ORB算法对降噪后图像进行处理，并进行特征提取获得特征点，然后对特征点进行排序，获得多个特征突出的第一关键点，便于后续进行特征匹配。第四步，根据期望角位移θ0确定驱动角位移θw，驱动角位移为输尿管软镜外端的转动角度。期望角位移为输尿管末端的探镜的希望转动角度。第五步，获得探镜采集的第三图像，并对图像进行降噪处理，获得第四图像；第三图像为输尿管软镜转动后探镜采集的图像。第六步，对第四图像进行特征点提取，对特征点排序，并筛选第二关键点；第五步和第六步的原理与第二步和第三步相似。第七步，对第一关键点和第二关键点进行粗匹配，获得第二图像和第四图像的映射矩阵；获得输尿管软镜末端绕轴向旋转时的实际角位移θ，并确定校准误差值Ec＝θ0-θ；通过计算可以获得在驱动角位移θw的驱动下，输尿管软镜末端的探镜的实际角位移θ以及它们的校准误差值。第八步，确定校准阈值E0，若|E0|＜|Ec|，则改变θw，直至|E0|＞|Ec|。如果校准误差值较大，则控制驱动角位移改变。若θ0＜θ，则证明相对于外端，探镜的转动幅度较大，则控制θw减小；若θ0＞θ，则证明相对于外端，探镜的转动幅度较小，则控制θw增大。并对上述方法进行举例说明：在未出现运动偏差前，可以认为，期望角位移是1°，驱动角位移也是1°，则在使用中只需要控制输尿管软镜外端的电机驱动输尿管软镜转动1°即可以实现探镜的角度转动。但是因为自然腔道对输尿管软镜的影响，可能出现的情况是，期望角位移是1°，驱动角位移为1°时，探镜的实际角位移只有0.5°，此时则出现了运动误差，则需要进行校准。以实际情况举例：输尿管软镜的外部电机的转动速度固定，使用者期望探镜的最终旋转角度为20°，因为有上述运动误差的情况，则外部电机转动20度后，探镜可能仅转动了8°。其原因可能为：在外部电机转动前10°时，自然腔道对输尿管的软镜影响下，外部电机转动10°，探镜转动了5°。在外部电机转动后10°时，自然腔道对输尿管软镜进行进一步的影响，探镜仅转动了3°，从而导致外端和末端的不匹配。但是如果应用了本实施例的方法。可以将期望角位移和驱动角位移均设置为1°，甚至更小。外部电机转动了1°后，对探镜获得的第一图像和第三图像进行处理，获得了实际角位移。然后将实际角位移与期望角位移1°相比，若误差值小于设定阈值，例如0.3°，则不改变驱动角位移。若误差值大于设定阈值，则可以通过改变外部电机的转速来改变在固定时间内的驱动角位移，则可以在同样的时间内，使外部电机转动更大的角度，从而可以使实际角位移更接近期望角位移。可简单总结为：在不需要进行校准时，期望角位移：驱动角位移＝1：1。在进行校准后，期望角位移：驱动角位移＝1：g，具体比值通过上述方法进行实时确认。实施例二基于实施例一中的方法，本实施例提出具体的处理方法，包括：确定探镜拍摄的图像的图像坐标系的方法包括：建立世界坐标系T，世界坐标系中包含泌尿系统的三维信息；建立探镜坐标系T，并确定世界坐标系与探镜坐标系的变换关系式：其中R为3×3旋转矩阵，Q为3×1平移矩阵；建立图像的物理坐标系T，探镜坐标系变换到物理坐标系的变换关系式为：其中f为探镜的焦距；建立图像的像素坐标系T，像素坐标系为泌尿系统的三维信息在图像平面上的二维投影，物理坐标系变换到像素坐标系的变换关系式：其中fu为图像平面上X轴方向上单位距离内的像素数，fv为图像平面上Y轴方向上单位距离内的像素数，为图像的物理坐标系的中心坐标。另外的，因为探镜在人体内进行工作，边缘极易出现模糊不清的情况，因此在获得探镜采集的第一图像/获得探镜采集的第三图像后，以第一图像/第三图像为待处理图像，并确定待处理图像的中心；以中心为圆心，RROI为半径，确定将要进行降噪处理的感兴趣区域。通过对图像目标区域进行裁剪，作为后续图像处理分析重点，通过ROI提取排除不必要的干扰，减轻计算负担本，本实施例中的RROI根据探镜的拍摄像素进行确定。完成ROI提取后，需要对图像进行降噪处理，降噪方法包括：建立4个残差网络，在每个残差网络内设置多个卷积层，并以线性修正单元激活函数ReLU为激活函数；四个残差网络的结构完全相同，且在可以设定每个残差网络包含两个残差块，前端的残差块用于实现收敛，后端的残差块用于对纹理细节进行增强。对残差网络进行训练，因此需要准备多个训练样本。不包含噪声的训练样本为清晰的图像，包含噪声的训练样本为不清晰的图像。将不包含噪声的训练样本进行二维离散平稳小波分解，获得3个第一高频分量和第一低频分量；对不包含噪声的训练样本添加噪声，并将包含噪声的训练样本进行二维离散平稳小波分解，获得3个第二高频分量和第二低频分量。上述小波分解均通过下方的分解公式进行，swt2表示小波分解，iswt2表示小波逆变换。＝swt2，其中P表示待分解图像，z表示分解尺度，L表示低频分量，H表示水平方向高频分量，V表示垂直方向高频分量，D表示45°夹角方向高频分量，'haar'表示小波分解时使用haar基；将3个第二高频分量和第二低频分量输入残差网络，并通过损失函数进行反向调节参数，直至达到网络收敛，损失函数为：其中Li表示第i幅输入图像的分量，R表示残差网络的输出，Ri表示实际残差，m为残差网络进行一次迭代训练的训练样本数量；Li可以为3个高频分量和低频分量，训练时根据具体的残差网络进行替换即可。获得完成训练的4个残差网络；小波分解在空间比、方向和频率范围方面使图像得以多尺度表示。本实施例中使用小波多尺度表示回归特征，训练用于图像去噪的多重卷积神经网络。对待处理图像进行二维离散平稳小波分解，获得3个高频分量和低频分量，并将4个分量输入残差网络；获得预测分量，并进行平稳小波逆变换获得去噪图像其中，表示去噪后的低频分量，表示去噪后的水平方向高频分量，表示去噪后的垂直方向高频分量，表示去噪后的45°夹角方向高频分量。本实施例中利用ORB算法对第二图像和第四图像进行特征提取，具体包括：通过FAST特征检测器对第二图像/第四图像进行特征提取，获得多个特征点，同时利用图像金字塔改善尺度不变性。通过Harris角点检测器对多个特征点进行排序和筛选，确定第二图像中的多个第一关键点，第四图像中的多个第二关键点。本实施例中通过汉明距离的暴力匹配来匹配第一关键点和第二关键点，具体方法包括：在以关键点为圆心，半径为R的局部区域中定义阶矩：其中G为点处的灰度值，mpq为第p+q阶的阶距，p和q为阶距数且为非负整数；确定局部区域的质心，并获得关键点的方向角α＝arctan，即m01,m10均为第1阶的阶距，m00为第0阶的阶距。通过BRIEF描述子对关键点进行编码，BRIEF描述子是由一组二进制灰度测试形成的字符串，获得二进制灰度测试表达式：其中G和G为点a和点b处的灰度值；在局部区域X中进行n次灰度测试，获得测试n个点后点对形成2×n矩阵为使BRIEF描述子具有旋转不变性，对矩阵S进行旋转，获得Sα＝RαS，其中Rα为α所对应的旋转矩阵；确定改进后的rBRIEF描述子，rBRIEF描述子是一种二进制字符串，gn＝Fn∈Sα；对第二图像和第四图像均进行上述的处理，求得第一关键点的rBRIEF描述子和第二关键点的rBRIEF描述子。使用基于汉明距离的暴力匹配进行粗匹配，并通过异或计算量化相似度：其中K1为第一关键点的rBRIEF描述子，K2为第二关键点的rBRIEF描述子，K1＝c1c2…cn，K2＝d1d2…dn。当输尿管软镜末端探镜在平面内绕轴向旋转时，平移矩阵为零，因此单应矩阵更适用于描述此类型运动前后图像之间的映射关系，单应矩阵描述的是空间中同一平面上的三维点在两张图像中的对应关系。这里需要强调的是同一平面。单应矩阵可以应用在图像矫正、图像配准拼接、视角转换以及计算两张图像的相机运动上。确定第二图像的多个第一关键点T和第四图像的多个第二关键点T；建立第一关键点和第二关键点的映射关系其中H为单应矩阵，获得单应矩阵求解公式：单应矩阵具有8个自由度，可以通过4个匹配点对来计算，因此选取4个具有映射关系的第一关键点和第二关键点，并基于SVD分解方法求解单应矩阵，获得输尿管软镜末端绕轴向旋转时的实际角位移θ。4个具有映射关系的第一关键点和第二关键点中的任意3个点处于非共线状态。实施例三一种适用于输尿管软镜末端的探镜角度校准终端，包括存储器、处理器以及存储在存储器中并可在处理器上运行的计算机程序，处理器执行计算机程序时实现如上述的一种适用于输尿管软镜末端的探镜角度校准方法的步骤。存储器可用于存储软件程序以及模块,处理器通过运行存储在存储器的软件程序以及模块,从而执行终端的各种功能应用以及数据处理。存储器可主要包括存储程序区和存储数据区,其中,存储程序区可存储操作系统、至少一个功能所需的执行程序等。存储数据区可存储根据终端的使用所创建的数据等。此外,存储器可以包括高速随机存取存储器,还可以包括非易失性存储器,例如至少一个磁盘存储器件,闪存器件、或其他易失性固态存储器件。一种计算机可读存储介质，计算机可读存储介质存储有计算机程序，计算机程序被处理器执行时实现如上述的一种适用于输尿管软镜末端的探镜角度校准方法的步骤。不失一般性，计算机可读介质可以包括计算机存储介质和通信介质。计算机存储介质包括以用于存储诸如计算机可读指令数据结构,程序模块或其他数据等信息的任何方法或技术实现的易失性和非易失性、可移动和不可移动介质。计算机存储介质包括RAM、ROM、EPROM、EEPROM、闪存或其他固态存储技术,CD-ROM、DVD或其他光学存储﹑磁带盒﹑磁带﹑磁盘存储或其他磁性存储设备。当然,本领域技术人员可知计算机存储介质不局限于上述几种。上述的系统存储器和大容量存储设备可以统称为存储器。在本说明书的描述中，参考术语“一个实施例/方式”、“一些实施例/方式”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例/方式或示例描述的具体特征、结构、材料或者特点包含于本申请的至少一个实施例/方式或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例/方式或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例/方式或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例/方式或示例以及不同实施例/方式或示例的特征进行结合和组合。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本申请的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。本领域的技术人员应当理解，上述实施方式仅仅是为了清楚地说明本发明，而并非是对本发明的范围进行限定。对于所属领域的技术人员而言，在上述发明的基础上还可以做出其它变化或变型，并且这些变化或变型仍处于本发明的范围内。
