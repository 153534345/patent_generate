标题title
一种外接式物理点导航配准方法、系统和存储介质
摘要abst
本发明提供了一种外接式物理点导航配准方法、系统和存储介质，骨钉穿过配准器后将固定于患者牙槽骨上，参考板固定设置于配准器上，骨钉通过设置于端部的凹坑而形成外接式物理点。通过获取各个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据后，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系，在光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，完成导航配准。以骨钉作为外接式物理点，同时实现固定连接和CT扫描参照两个功能，基于此结构即可进行后续的CBCT数据采集、光学定位数据采集、矩阵转换关系构建等操作，以对无牙颌口腔进行导航配准操作。
权利要求书clms
1.一种外接式物理点导航配准方法，其特征在于，所述方法基于配准器、参考板和多个骨钉，所述骨钉穿过所述配准器后将所述配准器固定于患者牙槽骨上，所述参考板固定设置于所述配准器上，所述骨钉通过设置于端部的凹坑而形成外接式物理点，所述方法包括以下步骤：S1.获取各个骨钉的CBCT数据，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据；S2.基于各个骨钉在CT三维坐标系中的中心点坐标数据和轴向坐标数据，分析得到各个骨钉的凹坑在CT三维坐标系中的坐标数据；S3.获取各个骨钉的光学定位数据，识别得到各个骨钉的凹坑在光学定位仪坐标系中的坐标数据；S4.基于多个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；S5.采集参考板在光学定位仪坐标系的实时坐标数据，在参考板三维坐标系和光学定位仪坐标系之间建立矩阵转换关系，进一步根据CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系分析得到CT三维坐标系和参考板三维坐标系之间的矩阵转换关系；S6.根据CT三维坐标系和参考板三维坐标系之间的矩阵转换关系，分析得到口腔三维坐标系和CT三维坐标系之间的矩阵转换关系；S7.通过对种植手机上的定位板进行标定，在种植手机坐标系和光学定位仪坐标系之间建立矩阵转换关系；S8.分析得到光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，完成导航配准。2.根据权利要求1所述的一种外接式物理点导航配准方法，其特征在于，在S1中，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据具体包括：S101.通过骨钉的CBCT数据获取骨钉表面在CT三维坐标系中的点云数据；S102.对骨钉表面的点云数据进行数据筛选，选取骨钉表面各个点在CT三维坐标系中的坐标数据；S103.根据骨钉表面各个点在CT三维坐标系中的坐标数据，构建骨钉CT三维模型；S104.对骨钉CT三维模型进行包裹体拟合，在骨钉CT三维模型上拟合得到长方体状包裹体；S105.根据骨钉CT三维模型上的长方体状包裹体，计算得到骨钉的中心点和轴向在CT三维坐标系中的坐标数据。3.根据权利要求1所述的一种外接式物理点导航配准方法，其特征在于，在S3具体包括：S301.对探针进行标定，在探针三维坐标系和光学定位仪坐标系之间建立矩阵转换关系；S302.采集抵接于骨钉的凹坑上的探针在光学定位仪坐标系下的实时位姿数据；S303.获取探针模型数据；S304.结合探针模型数据和探针在光学定位仪坐标系下的实时位姿数据，获取骨钉的凹坑在光学定位仪坐标系中的坐标数据。4.根据权利要求1所述的一种外接式物理点导航配准方法，其特征在于，在S4具体包括：S401.获取至少三个骨钉的凹坑在CT三维坐标系中的坐标数据、和，获取至少三个骨钉的凹坑在光学定位仪坐标系中的坐标数据、和；S402.将骨钉的凹坑在CT三维坐标系中的坐标数据和骨钉的凹坑在光学定位仪坐标系中的坐标数据进行一一配对，将和对应组成配对组、将和对应组成配对组、将和对应组成配对组，得到多组坐标转换数据；S403.根据配对得到的坐标转换数据进行转换矩阵计算，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。5.根据权利要求4所述的一种外接式物理点导航配准方法，其特征在于，在S403具体包括：S4031.根据和、和、和三个配对组，分析平移向量，并计算平移变换矩阵T，其中，t_x为X方向的向量值，t_y为Y方向的向量值，t_z为Z方向的向量值， T = | 100t_x | | 010t_y | | 001t_z | | 0001 |；S4032.根据和、和、和三个配对组，分析旋转矩阵R，计算对应凹坑在CT三维坐标系中的单位向量u=/sqrt，计算对应凹坑在光学定位仪坐标系中的单位向量u'=/sqrt，根据罗德里格斯公式分析旋转矩阵R=I+sin+)^2，其中I为单位矩阵，为v的斜对称矩阵，^2为的平方，v=u×u'，即θ=arccos；S4033.根据和、和、和三个配对组中的任一配对组，计算对应凹坑在CT三维坐标系中的欧式距离d=sqrt，计算对应凹坑在光学定位仪坐标系中的欧式距离d'=sqrt，分析得到缩放因子S=d'/d；S4034.根据平移变换矩阵T、旋转矩阵R和缩放因子S，获取CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；其中，Xa包括Xa1、Xa2和Xa3，Ya包括Ya1、Ya2和Ya3，Za包括Za1、Za2和Za3，Xb包括Xb1、Xb2和Xb3，Yb包括Yb1、Yb2和Yb3，Zb包括Zb1、Zb2和Zb3。6.一种外接式物理点导航配准系统，其特征在于，所述系统基于配准器、参考板和多个骨钉，所述骨钉穿过所述配准器后将所述配准器固定于患者牙槽骨上，所述参考板固定设置于所述配准器上，所述骨钉通过设置于端部的凹坑而形成外接式物理点，所述系统包括：CT扫描模块，用于获取各个骨钉的CBCT数据，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据；CT坐标分析模块，用于基于各个骨钉在CT三维坐标系中的中心点坐标数据和轴向坐标数据，分析得到各个骨钉的凹坑在CT三维坐标系中的坐标数据；光学扫描模块，用于获取各个骨钉的光学定位数据，识别得到各个骨钉的凹坑在光学定位仪坐标系中的坐标数据；坐标配对分析模块，用于基于多个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；第一矩阵转换分析模块，用于采集参考板在光学定位仪坐标系的实时坐标数据，在参考板三维坐标系和光学定位仪坐标系之间建立矩阵转换关系，进一步根据CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系分析得到CT三维坐标系和参考板三维坐标系之间的矩阵转换关系；第二矩阵转换分析模块，用于根据CT三维坐标系和参考板三维坐标系之间的矩阵转换关系，分析得到口腔三维坐标系和CT三维坐标系之间的矩阵转换关系；第三矩阵转换分析模块，用于通过对种植手机上的定位板进行标定，在种植手机坐标系和光学定位仪坐标系之间建立矩阵转换关系；配准模块，用于分析得到光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，完成导航配准。7.根据权利要求6所述的一种外接式物理点导航配准系统，其特征在于，所述CT扫描模块具体包括：点云数据采集单元，用于通过骨钉的CBCT数据获取骨钉表面在CT三维坐标系中的点云数据；数据筛选单元，用于对骨钉表面的点云数据进行数据筛选，选取骨钉表面各个点在CT三维坐标系中的坐标数据；模型构建单元，用于根据骨钉表面各个点在CT三维坐标系中的坐标数据，构建骨钉CT三维模型；包裹体拟合单元，用于对骨钉CT三维模型进行包裹体拟合，在骨钉CT三维模型上拟合得到长方体状包裹体；CT坐标分析单元，用于根据骨钉CT三维模型上的长方体状包裹体，计算得到骨钉的中心点和轴向在CT三维坐标系中的坐标数据。8.根据权利要求6所述的一种外接式物理点导航配准系统，其特征在于，所述光学扫描模块具体包括：探针标定单元，用于对探针进行标定，在探针三维坐标系和光学定位仪坐标系之间建立矩阵转换关系；坐标采集单元，用于采集抵接于骨钉的凹坑上的探针在光学定位仪坐标系下的实时位姿数据；模型获取单元，用于获取探针模型数据；光学坐标计算单元，用于结合探针模型数据和探针在光学定位仪坐标系下的实时位姿数据，获取骨钉的凹坑在光学定位仪坐标系中的坐标数据。9.根据权利要求6所述的一种外接式物理点导航配准系统，其特征在于，所述坐标配对分析模块具体包括：凹坑CT坐标获取单元，用于获取至少三个骨钉的凹坑在CT三维坐标系中的坐标数据、和，获取至少三个骨钉的凹坑在光学定位仪坐标系中的坐标数据、和；凹坑光学坐标获取单元，用于将骨钉的凹坑在CT三维坐标系中的坐标数据和骨钉的凹坑在光学定位仪坐标系中的坐标数据进行一一配对，将和对应组成配对组、将和对应组成配对组、将和对应组成配对组，得到多组坐标转换数据；凹坑坐标转换分析单元，用于根据配对得到的坐标转换数据进行转换矩阵计算，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；所述凹坑坐标转换分析单元具体包括：平移变换矩阵分析组件，用于根据和、和、和三个配对组，分析平移向量，并计算平移变换矩阵T，其中，t_x为X方向的向量值，t_y为Y方向的向量值，t_z为Z方向的向量值， T = | 100t_x | | 010t_y | | 001t_z | | 0001 |；旋转矩阵分析组件，用于根据和、和、和三个配对组，分析旋转矩阵R，计算对应凹坑在CT三维坐标系中的单位向量u=/sqrt，计算对应凹坑在光学定位仪坐标系中的单位向量u'=/sqrt，根据罗德里格斯公式分析旋转矩阵R=I+sin+)^2，其中I为单位矩阵，为v的斜对称矩阵，^2为的平方，v=u×u'，即θ=arccos；缩放因子分析组件，用于根据和、和、和三个配对组中的任一配对组，计算对应凹坑在CT三维坐标系中的欧式距离d=sqrt，计算对应凹坑在光学定位仪坐标系中的欧式距离d'=sqrt，分析得到缩放因子S=d'/d；凹坑坐标转换计算组件，用于根据平移变换矩阵T、旋转矩阵R和缩放因子S，获取CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；其中，Xa包括Xa1、Xa2和Xa3，Ya包括Ya1、Ya2和Ya3，Za包括Za1、Za2和Za3，Xb包括Xb1、Xb2和Xb3，Yb包括Yb1、Yb2和Yb3，Zb包括Zb1、Zb2和Zb3。10.一种存储介质，其特征在于，所述存储介质存储有计算机程序，所述的计算机程序包括程序指令，当所述程序指令被处理器执行时，处理器执行权利要求1-5中任一项所述的外接式物理点导航配准方法。
说明书desc
技术领域本发明涉及医疗技术领域，涉及一种用于在实施种植手术前进行对无牙颌的口腔进行导航配准的方法、系统和存储介质。背景技术口腔种植机器人是一种成熟的用于实施种植牙手术的工作，将种植手机等手术工具固定安装在机器人末端后，通过采集患者实时位姿和种植手机实时位姿，结合预先根据患者口腔情况而设计的种植方案，即可借助数字化技术实施种植牙手术。在通过口腔种植机器人进行种植牙操作之前，需要对末端手术工具的尖端进行配准操作，以在光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，从而将患者实时位姿和种植手机在CT图像中实时显示出来，便于进行实时导航定位。现有技术中的配准方式多需要通过牙颌将配准器、参考板等配准装置固定在患者口腔内，借助一个凹形固定组件包裹在牙颌上，再在凹形固定组件和牙颌之间通过灌胶的方式将二者连接固定，从而间接地将配准装置固定在牙颌上。当面对全口缺牙的无牙颌口腔状况时，因无法将配准装置牢固安装在牙颌上而难以实施术前配准，因此，如何对无牙颌口腔进行导航配准，一直是业界亟待解决的难题。发明内容本发明要解决的技术问题在于，针对现有技术的上述缺陷，提供一种外接式物理点导航配准方法、系统和存储介质，能够通过在牙槽骨上外接物理点，在实现固定连接的同时还提供CT扫描参照物，便于将配准装置牢固安装在牙颌上，以对无牙颌口腔进行导航配准操作。本发明解决技术问题所采用的技术方案如下：一种外接式物理点导航配准方法，所述方法基于配准器、参考板和多个骨钉，所述骨钉穿过所述配准器后将所述配准器固定于患者牙槽骨上，所述参考板固定设置于所述配准器上，所述骨钉通过设置于端部的凹坑而形成外接式物理点，所述方法包括以下步骤：S1.获取各个骨钉的CBCT数据，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据；S2.基于各个骨钉在CT三维坐标系中的中心点坐标数据和轴向坐标数据，分析得到各个骨钉的凹坑在CT三维坐标系中的坐标数据；S3.获取各个骨钉的光学定位数据，识别得到各个骨钉的凹坑在光学定位仪坐标系中的坐标数据；S4.基于多个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；S5.采集参考板在光学定位仪坐标系的实时坐标数据，在参考板三维坐标系和光学定位仪坐标系之间建立矩阵转换关系，进一步根据CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系分析得到CT三维坐标系和参考板三维坐标系之间的矩阵转换关系；S6.根据CT三维坐标系和参考板三维坐标系之间的矩阵转换关系，分析得到口腔三维坐标系和CT三维坐标系之间的矩阵转换关系；S7.通过对种植手机上的定位板进行标定，在种植手机坐标系和光学定位仪坐标系之间建立矩阵转换关系；S8.分析得到光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，完成导航配准。与现有技术相比，本技术方案的有益效果是：以骨钉作为外接式物理点，同时实现固定连接和CT扫描参照两个功能，基于此结构即可进行后续的CBCT数据采集、光学定位数据采集、矩阵转换关系构建等操作，以对无牙颌口腔进行导航配准操作。对应地，一种外接式物理点导航配准系统，所述系统基于配准器、参考板和多个骨钉，所述骨钉穿过所述配准器后将所述配准器固定于患者牙槽骨上，所述参考板固定设置于所述配准器上，所述骨钉通过设置于端部的凹坑而形成外接式物理点，所述系统包括：CT扫描模块，用于获取各个骨钉的CBCT数据，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据；CT坐标分析模块，用于基于各个骨钉在CT三维坐标系中的中心点坐标数据和轴向坐标数据，分析得到各个骨钉的凹坑在CT三维坐标系中的坐标数据；光学扫描模块，用于获取各个骨钉的光学定位数据，识别得到各个骨钉的凹坑在光学定位仪坐标系中的坐标数据；坐标配对分析模块，用于基于多个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；第一矩阵转换分析模块，用于采集参考板在光学定位仪坐标系的实时坐标数据，在参考板三维坐标系和光学定位仪坐标系之间建立矩阵转换关系，进一步根据CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系分析得到CT三维坐标系和参考板三维坐标系之间的矩阵转换关系；第二矩阵转换分析模块，用于根据CT三维坐标系和参考板三维坐标系之间的矩阵转换关系，分析得到口腔三维坐标系和CT三维坐标系之间的矩阵转换关系；第三矩阵转换分析模块，用于通过对种植手机上的定位板进行标定，在种植手机坐标系和光学定位仪坐标系之间建立矩阵转换关系；配准模块，用于分析得到光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，完成导航配准。对应地，一种存储介质，所述存储介质存储有计算机程序，所述的计算机程序包括程序指令，当所述程序指令被处理器执行时，处理器执行如上所述的外接式物理点导航配准方法。附图说明图1是本发明外接式物理点导航配准方法的流程示意图。图2是本发明外接式物理点导航配准系统的结构示意图。图3是本发明外接式物理点导航配准系统中外接式物理点配准装置的示意图。图中，各标号所代表的部件列表如下：CT扫描模块1、CT坐标分析模块2、光学扫描模块3、坐标配对分析模块4、第一矩阵转换分析模块5、第二矩阵转换分析模块6、第三矩阵转换分析模块7、配准模块8；配准器10、参考板20、骨钉30、凹坑300。实施方式为使本发明的目的、技术方案及优点更加清楚、明确，以下参照附图并举实施例对本发明进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。在本发明的描述中，需要理解的是，术语中“中心”、“上”、“下”、“前”、“后”、“左”、“右”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或组件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“连接”、“相连”应做广义理解，例如，可以是固定连接，也可以是拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以是通过中间媒介间接相连，可以是两个组件内部的连通。当组件被称为“固定于”或“设置于”另一个元件，它可以直接在另一个组件上或者也可以存在居中的组件。当一个组件被认为是“连接”另一个元件，它可以是直接连接到另一个元件或者可能同时存在居中元件。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明的具体含义。口腔种植机器人是一种成熟的用于实施种植牙手术的工作，将种植手机等手术工具固定安装在机器人末端后，通过采集患者实时位姿和种植手机实时位姿，结合预先根据患者口腔情况而设计的种植方案，即可借助数字化技术实施种植牙手术。在通过口腔种植机器人进行种植牙操作之前，需要对末端手术工具的尖端进行配准操作，以在光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，从而将患者实时位姿和种植手机在CT图像中实时显示出来，便于进行实时导航定位。现有技术中的配准方式多需要通过牙颌将配准器、参考板等配准装置固定在患者口腔内，借助一个凹形固定组件包裹在牙颌上，再在凹形固定组件和牙颌之间通过灌胶的方式将二者连接固定，从而间接地将配准装置固定在牙颌上。当面对全口缺牙的无牙颌口腔状况时，因无法将配准装置牢固安装在牙颌上而难以实施术前配准，因此，如何对无牙颌口腔进行导航配准，一直是业界亟待解决的难题。在本技术方案中，为了解决上述无牙颌难配准问题，外接式物理点导航配准方法和系统基于外接式物理点配准装置，如图3所示，所述外接式物理点配准装置包括配准器10、参考板20和多个骨钉30，所述骨钉穿过所述配准器后将所述配准器固定于患者牙槽骨上，所述参考板固定设置于所述配准器上，所述骨钉通过在端部设置的凹坑300而形成外接式物理点。具体地，所述骨钉设置有4个，所述骨钉为不锈钢结构。在实施配准操作之前，需要将外接式物理点配准装置固定在患者牙槽骨上：在患者牙龈上选择适合固定的区域，将配准器和参考板的整体结构放置在患者牙龈侧面，通过骨钉穿过配准器后固定在牙槽骨上，使得配准器和参考板的整体结构与人体相互固定。骨钉穿过配准器后与牙槽骨通过螺纹配合的方式固定连接，实现最为基本的连接固定功能，同时，在骨钉的端部形成有凹坑，且进一步采用不锈钢结构作为骨钉，基于骨钉于配准器之间的相互连接位置关系已知这一前提，当进行CBCT扫描时，可通过骨钉端部的凹坑形成物理参考点，进行构建口腔CT模型。如图1所示，一种外接式物理点导航配准方法，包括以下步骤：S1.获取各个骨钉的CBCT数据，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据。在步骤S1中，通过CBCT扫描获取各个骨钉的位姿数据，再根据各个骨钉的位姿数据，结合骨钉本身的模型结构，可得到各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据。所述骨钉的中心点，是指骨钉作为一个规则结构，其处于结构最中心位置的点；所述骨钉的轴向，是轴骨钉中轴线的实时朝向。S2.基于各个骨钉在CT三维坐标系中的中心点坐标数据和轴向坐标数据，分析得到各个骨钉的凹坑在CT三维坐标系中的坐标数据。在步骤S2中，由于骨钉的模型结构设计已知，在同一骨钉上，当已知其中心点和轴向的坐标数据，基于其模型结构则可通过简单的换算得到该骨钉上凹坑在CT三维坐标系中的坐标数据。S3.获取各个骨钉的光学定位数据，识别得到各个骨钉的凹坑在光学定位仪坐标系中的坐标数据。在步骤S3中，通过标定后的参考板与光学定位仪，光学定位仪向参考板发射出红外光，参考板将红外光反射回光学定位仪后，光学定位即可以实时捕捉参考板的位姿数据，进而基于标定而获取各个骨钉的凹坑在光学定位仪坐标系中的坐标数据。S4.基于多个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。在步骤S4中，由于各个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据均已知，此时只需要将数据组一一配对，即明确同一凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据，则可通过计算得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。S5.采集参考板在光学定位仪坐标系的实时坐标数据，在参考板三维坐标系和光学定位仪坐标系之间建立矩阵转换关系，进一步根据CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系分析得到CT三维坐标系和参考板三维坐标系之间的矩阵转换关系。在步骤S5中，基于光学定位仪向参考板发出红外光并接收参考板所返回的红外光即可在参考板三维坐标系和光学定位仪坐标系之间建立矩阵转换关系，又由于在步骤S4中已知获知CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系，因此，可进一步分析得到CT三维坐标系和参考板三维坐标系之间的矩阵转换关系。S6.根据CT三维坐标系和参考板三维坐标系之间的矩阵转换关系，分析得到口腔三维坐标系和CT三维坐标系之间的矩阵转换关系。在步骤S6中，由于骨钉已将配准器、参考板等固定在患者牙槽骨上，此时配准器、参考板和患者之间的相对位置保持不变，因此CT三维坐标系与口腔三维坐标系之间的矩阵转换关系可求，进一步可分析得到口腔三维坐标系和CT三维坐标系之间的矩阵转换关系。S7.通过对种植手机上的定位板进行标定，在种植手机坐标系和光学定位仪坐标系之间建立矩阵转换关系。步骤S7中的种植手机上固定设置有定位板作为手机参考板，经过标定后，可基于定位板确定种植手机的位姿，通过光学定位仪向定位板发射红外光并再接收手机参考板所反射回来的红外光，即可在种植手机坐标系和光学定位仪坐标系之间建立矩阵转换关系。S8.分析得到光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，完成导航配准。基于步骤S1至S7，可以光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，此时，可以在CT图像中显示种植手机、患者口腔的实时位置关系，并通过预设种植方案的辅助进行实时导航。至此，适用于无牙颌的导航配准操作完成。上述技术方案以骨钉作为外接式物理点，同时实现固定连接和CT扫描参照两个功能，基于此结构即可进行后续的CBCT数据采集、光学定位数据采集、矩阵转换关系构建等操作，以对无牙颌口腔进行导航配准操作。步骤S1的技术目的在于获取骨钉的中心点和轴向在CT三维坐标系中的坐标数据，优选地，在步骤S1中，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据具体包括：S101.通过骨钉的CBCT数据获取骨钉表面在CT三维坐标系中的点云数据。在步骤S101中，先通过CBCT扫描获取骨钉的CBCT数据，再进一步从整体CBCT数据中获取骨钉表面点云数据。S102.对骨钉表面的点云数据进行数据筛选，选取骨钉表面各个点在CT三维坐标系中的坐标数据。由于CBCT扫描可获取骨钉的整体数据，包括表面的和内部的，在步骤S102中，对点云数据进行筛选可得到骨钉表面各个点在CT三维坐标系中的坐标数据。S103.根据骨钉表面各个点在CT三维坐标系中的坐标数据，构建骨钉CT三维模型。在步骤S103中，基于步骤S102已知获得的骨钉表面各个点在CT三维坐标系中的坐标数据进行模型构建，得到骨钉CT三维模型。S104.对骨钉CT三维模型进行包裹体拟合，在骨钉CT三维模型上拟合得到长方体状包裹体。在步骤S104中，在骨钉CT三维模型的基础上进行包裹体拟合，拟合得到一个包裹在骨钉CT三维模型外的长方体。S105.根据骨钉CT三维模型上的长方体状包裹体，计算得到骨钉的中心点和轴向在CT三维坐标系中的坐标数据。在步骤S105中，由于长方体状包裹体的形状规则，可根据长方体状包裹体计算得到骨钉的中心点和轴向在CT三维坐标系中的坐标数据。基于上述技术方案，在获取骨钉表面点云数据后构建出骨钉CT三维模型，再通过包裹体拟合的方式在骨钉CT三维模型外得到一个长方体状包裹体，借助长方体状包裹体形状规则的特点，即可通过简单的方式和便捷的运算分析出骨钉的中心点和轴向在CT三维坐标系中的坐标数据。步骤S3的技术目的在于获取各个骨钉的凹坑在光学定位仪坐标系中的坐标数据，优选地，步骤S3具体包括：S301.对探针进行标定，在探针三维坐标系和光学定位仪坐标系之间建立矩阵转换关系。在步骤S301中，在通过光学定位仪向探针发射红外光进行定位前，先对探针进行标定操作，经过标定后，即可在探针三维坐标系和光学定位仪坐标系之间建立矩阵转换关系。需要说明的是，标定操作为导航技术领域的现有技术。S302.采集抵接于骨钉的凹坑上的探针在光学定位仪坐标系下的实时位姿数据。在步骤S302中，光学定位仪向向探针发射红外光，探针向光学定位仪反射红外光，光学定位仪则可根据接收到手红外光，分析抵接于骨钉的凹坑上的探针在光学定位仪坐标系下的实时位姿数据。S303.获取探针模型数据。在步骤S303中，探针作为一个通用工具，其模型数据已知，此步骤可直接获取探针模型数据。S304.结合探针模型数据和探针在光学定位仪坐标系下的实时位姿数据，获取骨钉的凹坑在光学定位仪坐标系中的坐标数据。在步骤S304中，在已经获取探针在光学定位仪坐标系下的实时位姿数据的基础上，结合探针模型数据，即可得知探针尖端在光学定位仪坐标系下的实时位姿数据，又由于探针尖端抵接于骨钉的凹坑上，此时，探针尖端在光学定位仪坐标系下的实时位姿数据即为骨钉的凹坑在光学定位仪坐标系中的坐标数据。基于上述技术方案，能够借助现有技术中较为成熟的工具，简单快速且准确地获取骨钉的凹坑在光学定位仪坐标系中的坐标数据。步骤S4的技术目的在于获取CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系，优选地，步骤S4具体包括：S401.获取至少三个骨钉的凹坑在CT三维坐标系中的坐标数据、和，获取至少三个骨钉的凹坑在光学定位仪坐标系中的坐标数据、和。在步骤S401中，基于步骤S1至S3，可以得到：三个骨钉的凹坑在CT三维坐标系中的坐标数据分别为、和，三个骨钉的凹坑在光学定位仪坐标系中的坐标数据分别为、和。S402.将骨钉的凹坑在CT三维坐标系中的坐标数据和骨钉的凹坑在光学定位仪坐标系中的坐标数据进行一一配对，将和对应组成配对组、将和对应组成配对组、将和对应组成配对组，得到多组坐标转换数据。在步骤S402中，所述配对，是指将同一个凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据进行绑定。S403.根据配对得到的坐标转换数据进行转换矩阵计算，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。在步骤S403中，基于配对数据，即可直接计算得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。具体地，步骤S403具体包括：S4031.根据和、和、和三个配对组，分析平移向量，并计算平移变换矩阵T，其中，t_x为X方向的向量值，t_y为Y方向的向量值，t_z为Z方向的向量值， T = | 100t_x | | 010t_y | | 001t_z | | 0001 |；S4032.根据和、和、和三个配对组，分析旋转矩阵R，计算对应凹坑在CT三维坐标系中的单位向量u=/sqrt，计算对应凹坑在光学定位仪坐标系中的单位向量u'=/sqrt，根据罗德里格斯公式分析旋转矩阵R=I+sin+)^2，其中I为单位矩阵，为v的斜对称矩阵，^2为的平方，v=u×u'，即θ=arccos；S4033.根据和、和、和三个配对组中的任一配对组，计算对应凹坑在CT三维坐标系中的欧式距离d=sqrt，计算对应凹坑在光学定位仪坐标系中的欧式距离d'=sqrt，分析得到缩放因子S=d'/d；S4034.根据平移变换矩阵T、旋转矩阵R和缩放因子S，获取CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；其中，Xa包括Xa1、Xa2和Xa3，Ya包括Ya1、Ya2和Ya3，Za包括Za1、Za2和Za3，Xb包括Xb1、Xb2和Xb3，Yb包括Yb1、Yb2和Yb3，Zb包括Zb1、Zb2和Zb3。需要说明的是，当Xa取Xa1时，Ya取Ya1、Za取Za1，Xa、Ya、Za为一一对应关系；同理，Xb、Yb、Zb也为一一对应关系。通过和、和、和三个配对组计算出平移变换矩阵T、旋转矩阵R和缩放因子S，即可进一步基于平移变换矩阵T、旋转矩阵R和缩放因子S获取CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。如图2所示，一种外接式物理点导航配准系统，包括CT扫描模块1、CT坐标分析模块2、光学扫描模块3、坐标配对分析模块4、第一矩阵转换分析模块5、第二矩阵转换分析模块6、第三矩阵转换分析模块7和配准模块8。具体地：所述CT扫描模块，用于获取各个骨钉的CBCT数据，识别各个骨钉的中心点和轴向在CT三维坐标系中的坐标数据；所述CT坐标分析模块，用于基于各个骨钉在CT三维坐标系中的中心点坐标数据和轴向坐标数据，分析得到各个骨钉的凹坑在CT三维坐标系中的坐标数据；所述光学扫描模块，用于获取各个骨钉的光学定位数据，识别得到各个骨钉的凹坑在光学定位仪坐标系中的坐标数据；所述坐标配对分析模块，用于基于多个骨钉的凹坑在CT三维坐标系中的坐标数据和在光学定位仪坐标系中的坐标数据，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系；所述第一矩阵转换分析模块，用于采集参考板在光学定位仪坐标系的实时坐标数据，在参考板三维坐标系和光学定位仪坐标系之间建立矩阵转换关系，进一步根据CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系分析得到CT三维坐标系和参考板三维坐标系之间的矩阵转换关系；所述第二矩阵转换分析模块，用于根据CT三维坐标系和参考板三维坐标系之间的矩阵转换关系，分析得到口腔三维坐标系和CT三维坐标系之间的矩阵转换关系；所述第三矩阵转换分析模块，用于通过对种植手机上的定位板进行标定，在种植手机坐标系和光学定位仪坐标系之间建立矩阵转换关系；所述配准模块，用于分析得到光学定位仪坐标系、CT三维坐标系、口腔三维坐标系和种植手机坐标系任意二者之间的矩阵转换关系，完成导航配准。优选地，所述CT扫描模块具体包括点云数据采集单元、数据筛选单元、模型构建单元、包裹体拟合单元和CT坐标分析单元。其中：所述点云数据采集单元，用于通过骨钉的CBCT数据获取骨钉表面在CT三维坐标系中的点云数据；所述数据筛选单元，用于对骨钉表面的点云数据进行数据筛选，选取骨钉表面各个点在CT三维坐标系中的坐标数据；所述模型构建单元，用于根据骨钉表面各个点在CT三维坐标系中的坐标数据，构建骨钉CT三维模型；所述包裹体拟合单元，用于对骨钉CT三维模型进行包裹体拟合，在骨钉CT三维模型上拟合得到长方体状包裹体；所述CT坐标分析单元，用于根据骨钉CT三维模型上的长方体状包裹体，计算得到骨钉的中心点和轴向在CT三维坐标系中的坐标数据。优选地，所述光学扫描模块具体包括探针标定单元、坐标采集单元、模型获取单元、光学坐标计算单元。具体地：所述探针标定单元，用于对探针进行标定，在探针三维坐标系和光学定位仪坐标系之间建立矩阵转换关系；所述坐标采集单元，用于采集抵接于骨钉的凹坑上的探针在光学定位仪坐标系下的实时位姿数据；所述模型获取单元，用于获取探针模型数据；所述光学坐标计算单元，用于结合探针模型数据和探针在光学定位仪坐标系下的实时位姿数据，获取骨钉的凹坑在光学定位仪坐标系中的坐标数据。优选地，所述坐标配对分析模块具体包括凹坑CT坐标获取单元、凹坑光学坐标获取单元、凹坑坐标转换分析单元。其中：所述凹坑CT坐标获取单元，用于获取至少三个骨钉的凹坑在CT三维坐标系中的坐标数据、和，获取至少三个骨钉的凹坑在光学定位仪坐标系中的坐标数据、和；所述凹坑光学坐标获取单元，用于将骨钉的凹坑在CT三维坐标系中的坐标数据和骨钉的凹坑在光学定位仪坐标系中的坐标数据进行一一配对，将和对应组成配对组、将和对应组成配对组、将和对应组成配对组，得到多组坐标转换数据；所述凹坑坐标转换分析单元，用于根据配对得到的坐标转换数据进行转换矩阵计算，分析得到CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。优选地，所述凹坑坐标转换分析单元具体包括平移变换矩阵分析组件、旋转矩阵分析组件、缩放因子分析组件和凹坑坐标转换计算组件。具体地：所述平移变换矩阵分析组件，用于根据和、和、和三个配对组，分析平移向量，并计算平移变换矩阵T，其中，t_x为X方向的向量值，t_y为Y方向的向量值，t_z为Z方向的向量值， T = | 100t_x | | 010t_y | | 001t_z | | 0001 |；所述旋转矩阵分析组件，用于根据和、和、和三个配对组，分析旋转矩阵R，计算对应凹坑在CT三维坐标系中的单位向量u=/sqrt，计算对应凹坑在光学定位仪坐标系中的单位向量u'=/sqrt，根据罗德里格斯公式分析旋转矩阵R=I+sin+)^2，其中I为单位矩阵，为v的斜对称矩阵，^2为的平方，v=u×u'，即θ=arccos；所述缩放因子分析组件，用于根据和、和、和三个配对组中的任一配对组，计算对应凹坑在CT三维坐标系中的欧式距离d=sqrt，计算对应凹坑在光学定位仪坐标系中的欧式距离d'=sqrt，分析得到缩放因子S=d'/d；所述凹坑坐标转换计算组件，用于根据平移变换矩阵T、旋转矩阵R和缩放因子S，获取CT三维坐标系和光学定位仪坐标系之间的矩阵转换关系。在上述方案中，Xa包括Xa1、Xa2和Xa3，Ya包括Ya1、Ya2和Ya3，Za包括Za1、Za2和Za3，Xb包括Xb1、Xb2和Xb3，Yb包括Yb1、Yb2和Yb3，Zb包括Zb1、Zb2和Zb3。对应地，一种存储介质，所述存储介质存储有计算机程序，所述的计算机程序包括程序指令，当所述程序指令被处理器执行时，处理器执行如上所述的外接式物理点导航配准方法。应当理解的是，本发明的应用不限于上述的举例，对本领域普通技术人员来说，可以根据上述说明加以改进或变换，所有这些改进和变换都应属于本发明所附权利要求的保护范围。
