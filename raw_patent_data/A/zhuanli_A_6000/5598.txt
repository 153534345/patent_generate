标题title
一种基于可分离卷积和注意力机制的心电信号检测方法
摘要abst
一种基于可分离卷积和注意力机制的心电信号检测方法，使用多分支处理模块处理不同长度连续的心电信号，扩大了模型处理信号的范围，使用特征提取模块可以提取信号中局部的特征信息，关注于信号的形态特征，使用注意力编码模块可以提取全局的的特征信息，使其关注于信号的时域和节奏信息。网络训练完成后能够保留最优的模型和参数，可以将要检测的数据输入到最优的模型中，获得检测分类的结果。
权利要求书clms
1.一种基于可分离卷积和注意力机制的心电信号检测方法，其特征在于，包括如下步骤：a)将心电信号的数据集合并到一起，并使其频率相同，得到心电信号记录集X0＝{x1,x2,...,xi,...,xn}，其中xi为第i个心电信号记录，i∈{1,...,n}，n为心电信号记录的总条数；b)对心电信号记录集X0进行预处理，得到预处理后的数据集X2，X2＝{x″1,x″2,...,x″i,...,x″n}；c)将预处理后的数据集X2中第i个预处理后的心电信号记录x″i通过剪裁或零填充的方式生成满足多分支处理模块的数据xi_1，xi_1＝{xi1,xi2,...,xij,...,xim}，其中xij为第i个预处理后的心电信号的第j个分支输入数据，j∈{1,...,m}，m个多分支的个数，xij的长度为Lj，Lj＝1250+j*250；d)建立多分支处理模块，将数据xi_1输入到多分支处理模块中，输出得到数据xi_3；e)建立局部特征信息卷积提取模块，将数据xi_3输入到局部特征信息卷积提取模块中，输出得到特征图xi_7；f)建立注意力编码模块，将特征图xi_7输入到注意力编码模块中，输出得到特征图xi_9；g)建立分类器模块，完成模型的建立，将特征图xi_9输入到分类器模块中，输出得到预测标签预测标签/＞为0时表示心电信号为正常信号，预测标签/＞为1时表示心电信号为异常信号。2.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于：步骤a)中心电信号数据包括MIT-BIH房颤数据集及MIT-BIH心率失常数据集，将MIT-BIH心率失常数据集的采用频率降至250HZ后与MIT-BIH房颤数据集合并到一起，将合并后的数据集随机分割为n条5-30秒的记录，得到心电信号记录集X0＝{x1,x2,...,xi,...,xn}。3.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于，步骤b)包括如下步骤：b-1)在心电信号数据中提取心电信号标签，得到心电信号标签集Y0＝{y1,y2,...,yi,...,yn}，其中yi为第i个心电信号记录xi的标签，yi＝0表示输入信号为正常信号，yi＝1表示输入信号为异常信号；b-2)将心电信号记录集X0中的第i个心电信号记录xi使用巴特沃斯带通滤波器去除噪声中的基线漂移，得到处理后的心电信号记录x′i，数据集X1＝{x′1,x′2,...,x′i,...,x′n}；b-3)将数据集X1中的第i个心电信号记录x′i通过小波变换和软阈值去除信号中的肌电干扰得到预处理后的心电信号数据记录x″i，数据集X2＝{x″1,x″2,...,x″i,...,x″n}。4.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于，步骤d)包括如下步骤：d-1)多分支处理模块由m个分支构成，每个分支均由第一线性层结构、第二线性层结构构成，第一线性层结构、第二线性层结构均依次由全连接层、Relu激活函数层、Dropout层构成；d-2)将第i个预处理后的心电信号的第j个分支输入数据xij输入到第j个分支的第一线性层结构中，输出得到特征图将特征图/＞输入到第j个分支的第二线性层结构中，输出得到特征图/＞特征图/＞的长度为Lj1，特征图/＞的长度为Lj2，/＞d-3)所有m个分支输出的特征图构成数据集合xi_2，d-4)数据集合xi_2中所有特征图进行拼接操作后输入到最大池化层中，输出得到数据xi_3。5.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于，步骤e)包括如下步骤：e-1)局部特征信息卷积提取模块由第一LICE_module模块、第二LICE_module模块、第三LICE_module模块及第四LICE_module模块构成，第一LICE_module模块、第二LICE_module模块、第三LICE_module模块及第四LICE_module模块均由第一分支、第二分支、BN层、SE模块构成，第一分支由第一卷积层、第一BN层、第一Relu激活函数层、深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层构成，第二分支由扩展卷积层、第一BN层、Relu激活函数层、第二卷积层、第二BN层、dropout层构成；e-2)将数据xi_3依次输入到第一LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第一LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第一分支输出的特征图/＞将数据xi_3依次输入到第一LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第一LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第一LICE_module模块的BN层、SE模块中，得到第一LICE_module模块的输出的特征图xi_4；e-3)将数据xi_4依次输入到第二LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第二LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_4依次输入到第二LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第二LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第二LICE_module模块的BN层、SE模块中，得到第二LICE_module模块的输出的特征图xi_5；e-4)将数据xi_5依次输入到第三LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第三LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_5依次输入到第三LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第三LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第三LICE_module模块的BN层、SE模块中，得到第三LICE_module模块的输出的特征图xi_6；e-5)将数据xi_6依次输入到第四LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第四LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_6依次输入到第四LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第四LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第四LICE_module模块的BN层、SE模块中，得到第四LICE_module模块的输出的特征图xi_7。6.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于：步骤e-2)中第一LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第一LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第一LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*3、步长为1，第一LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为3，第一LICE_module模块的第二分支的第二卷积层的卷积核大小为1*5、步长为1；步骤e-3)中第二LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第二LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第二LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*5、步长为2，第二LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第二LICE_module模块的第二分支的第二卷积层的卷积核大小为1*3、步长为2；步骤e-4)中第三LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第三LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第三LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*5、步长为2，第三LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第三LICE_module模块的第二分支的第二卷积层的卷积核大小为1*3、步长为2；步骤e-5)中第四LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第四LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第四LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*8、步长为2，第四LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第四LICE_module模块的第二分支的第二卷积层的卷积核大小为1*5、步长为2。7.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于，步骤f)包括如下步骤：f-1)注意力编码模块由Transformer模型的位置编码单元和3层encoder层构成；f-2)将特征图xi_7输入到注意力编码模块的位置编码单元中，输出得到位置编码后的特征图xi_8；f-3)将位置编码后的特征图xi_8依次输入到注意力编码模块的3层encoder层中，输出得到特征图xi_9。8.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于：步骤f-1)中encoder层的多头自注意力中head的个数为8。9.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于：分类器模块依次由卷积层、BN层、Relu激活函数层、flatten层、全连接层、softmax分类器构成。10.根据权利要求1所述的基于可分离卷积和注意力机制的心电信号检测方法，其特征在于，还包括在步骤g)后执行如下步骤：h-1)将特征图xi_7输入到分类器模块中，输出得到预测标签h-2)通过公式计算得到损失函数Loss，式中λ和β为权重值，λ+β＝1，γ为聚焦参数，γ＝2；h-3)通过Adam优化器利用损失函数训练步骤g)中的模型，得到训练后的模型。
说明书desc
技术领域本发明涉及心电信号异常检测技术领域，具体涉及一种基于可分离卷积和注意力机制的心电信号检测方法。背景技术心电信号是一种能够很好的反应心脏活动的重要信号，对于不同的心脏状态心电信号会表现出不同的特征。现阶段依赖于传统的机器学习和手工特征提取的信号异常检测方法不能满足当下的需要，随着深度学习、神经网络的蓬勃发展，已经有研究人员使用端到端的神经网络模型进行信号异常检测分类，但是现阶段的模型往往是针对单个数据集的学习以及固定长度的心电信号的检测。模型针对于单个数据集的学习会限制信号异常检测的范围，针对固定长度信号的检测会对采集设备和采集时长有一定的要求，实现成本过高。发明内容本发明为了克服以上技术的不足，提供了一种构建一个全新的深度可分离卷积模块来搭建基于深度可分离卷积和注意力机制的模型进行心电异常检测分类，以提高检测分类的精确度的方法。本发明克服其技术问题所采用的技术方案是：一种基于可分离卷积和注意力机制的心电信号检测方法，包括如下步骤：a)将心电信号的数据集合并到一起，并使其频率相同，得到心电信号记录集X0＝{x1,x2,...,xi,...,xn}，其中xi为第i个心电信号记录，i∈{1,...,n}，n为心电信号记录的总条数；b)对心电信号记录集X0进行预处理，得到预处理后的数据集X2，X2＝{x″1,x″2,...,x″i,...,x″n}；c)将预处理后的数据集X2中第i个预处理后的心电信号记录x″i通过剪裁或零填充的方式生成满足多分支处理模块的数据xi_1，xi_1＝{xi1,xi2,...,xij,...,xim}，其中xij为第i个预处理后的心电信号的第j个分支输入数据，j∈{1,...,m}，m个多分支的个数，xij的长度为Lj，Lj＝1250+j*250；d)建立多分支处理模块，将数据xi_1输入到多分支处理模块中，输出得到数据xi_3；e)建立局部特征信息卷积提取模块，将数据xi_3输入到局部特征信息卷积提取模块中，输出得到特征图xi_7；f)建立注意力编码模块，将特征图xi_7输入到注意力编码模块中，输出得到特征图xi_9；g)建立分类器模块，完成模型的建立，将特征图xi_9输入到分类器模块中，输出得到预测标签预测标签/＞为0时表示心电信号为正常信号，预测标签/＞为1时表示心电信号为异常信号。进一步的，步骤a)中心电信号数据包括MIT-BIH房颤数据集及MIT-BIH心率失常数据集，将MIT-BIH心率失常数据集的采用频率降至250HZ后与MIT-BIH房颤数据集合并到一起，将合并后的数据集随机分割为n条5-30秒的记录，得到心电信号记录集X0＝{x1,x2,...,xi,...,xn}。进一步的，步骤b)包括如下步骤：b-1)在心电信号数据中提取心电信号标签，得到心电信号标签集Y0＝{y1,y2,...,yi,...,yn}，其中yi为第i个心电信号记录xi的标签，yi＝0表示输入信号为正常信号，yi＝1表示输入信号为异常信号；b-2)将心电信号记录集X0中的第i个心电信号记录xi使用巴特沃斯带通滤波器去除噪声中的基线漂移，得到处理后的心电信号记录x′i，数据集X1＝{x′1,x′2,...,x′i,...,x′n}；b-3)将数据集X1中的第i个心电信号记录x′i通过小波变换和软阈值去除信号中的肌电干扰得到预处理后的心电信号数据记录x″i，数据集X2＝{x″1,x″2,...,x″i,...,x″n}。进一步的，步骤d)包括如下步骤：d-1)多分支处理模块由m个分支构成，每个分支均由第一线性层结构、第二线性层结构构成，第一线性层结构、第二线性层结构均依次由全连接层、Relu激活函数层、Dropout层构成；d-2)将第i个预处理后的心电信号的第j个分支输入数据xij输入到第j个分支的第一线性层结构中，输出得到特征图将特征图/＞输入到第j个分支的第二线性层结构中，输出得到特征图/＞特征图/＞的长度为Lj1，特征图/＞的长度为Lj2，d-3)所有m个分支输出的特征图构成数据集合xi_2，d-4)数据集合xi_2中所有特征图进行拼接操作后输入到最大池化层中，输出得到数据xi_3。进一步的，步骤e)包括如下步骤：e-1)局部特征信息卷积提取模块由第一LICE_module模块、第二LICE_module模块、第三LICE_module模块及第四LICE_module模块构成，第一LICE_module模块、第二LICE_module模块、第三LICE_module模块及第四LICE_module模块均由第一分支、第二分支、BN层、SE模块构成，第一分支由第一卷积层、第一BN层、第一Relu激活函数层、深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层构成，第二分支由扩展卷积层、第一BN层、Relu激活函数层、第二卷积层、第二BN层、dropout层构成；e-2)将数据xi_3依次输入到第一LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第一LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第一分支输出的特征图/＞将数据xi_3依次输入到第一LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第一LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第一LICE_module模块的BN层、SE模块中，得到第一LICE_module模块的输出的特征图xi_4；e-3)将数据xi_4依次输入到第二LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第二LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_4依次输入到第二LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第二LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第二LICE_module模块的BN层、SE模块中，得到第二LICE_module模块的输出的特征图xi_5；e-4)将数据xi_5依次输入到第三LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第三LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_5依次输入到第三LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第三LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第三LICE_module模块的BN层、SE模块中，得到第三LICE_module模块的输出的特征图xi_6；e-5)将数据xi_6依次输入到第四LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第四LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_6依次输入到第四LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第四LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第四LICE_module模块的BN层、SE模块中，得到第四LICE_module模块的输出的特征图xi_7。优选的，步骤e-2)中第一LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第一LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第一LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*3、步长为1，第一LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为3，第一LICE_module模块的第二分支的第二卷积层的卷积核大小为1*5、步长为1；步骤e-3)中第二LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第二LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第二LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*5、步长为2，第二LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第二LICE_module模块的第二分支的第二卷积层的卷积核大小为1*3、步长为2；步骤e-4)中第三LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第三LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第三LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*5、步长为2，第三LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第三LICE_module模块的第二分支的第二卷积层的卷积核大小为1*3、步长为2；步骤e-5)中第四LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第四LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第四LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*8、步长为2，第四LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第四LICE_module模块的第二分支的第二卷积层的卷积核大小为1*5、步长为2。进一步的，步骤f)包括如下步骤：f-1)注意力编码模块由Transformer模型的位置编码单元和3层encoder层构成；f-2)将特征图xi_7输入到注意力编码模块的位置编码单元中，输出得到位置编码后的特征图xi_8；f-3)将位置编码后的特征图xi_8依次输入到注意力编码模块的3层encoder层中，输出得到特征图xi_9。优选的，步骤f-1)中encoder层的多头自注意力中head的个数为8。进一步的，分类器模块依次由卷积层、BN层、Relu激活函数层、flatten层、全连接层、softmax分类器构成。进一步的，还包括在步骤g)后执行如下步骤：h-1)将特征图xi_7输入到分类器模块中，输出得到预测标签h-2)通过公式计算得到损失函数Loss，式中λ和β为权重值，λ+β＝1，γ为聚焦参数，γ＝2；h-3)通过Adam优化器利用损失函数训练步骤g)中的模型，得到训练后的模型。本发明的有益效果是：能够在同一个模型中处理不同长度的连续的心电信号并能够最大可能保留其原始的特征信息，使用多分支处理模块处理不同长度连续的心电信号，扩大了模型处理信号的范围，使用特征提取模块可以提取信号中局部的特征信息，关注于信号的形态特征，使用注意力编码模块可以提取全局的的特征信息，使其关注于信号的时域和节奏信息。网络训练完成后能够保留最优的模型和参数，可以将要检测的数据输入到最优的模型中，获得检测分类的结果。附图说明图1为本发明的方法流程图；图2为本发明的模型结构图；图3为本发明的多分支输入模块结构图；图4为本发明的LICE_module模块结构图。具体实施方式下面结合附图1至附图4对本发明做进一步说明。本发明为了克服了以上不足，通过构建一个全新的深度可分离卷积模块来搭建基于深度可分离卷积和注意力机制的模型进行心电异常检测分类，以提高检测分类的精确度。在下文中我们将全新的局部信息卷积提取模块简称为LICE_module,模型简称为DWT_Net。本发明所提出的技术方法能够在一个模型中对不同长度心电信号实现快速的检测分类，提高模型的生产效率。DWT_Net模型主要包含三个模块：多分支数据处理模块、局部特征信息卷积提取模块、和关注于心电信号时序特征的注意力编码模块。第一个模块是读取心电信号数据，通过计算其长度判断数据长度判断应该在哪一个分支输入。数据在每一个分支中经过两层的线性化模块后得到的特征图维度相同，在将所有分支的特征图相拼接并归一化后得到固定长度的特征数据。第二个模块是局部特征信息卷积提取模块，输入这个模块的特征数据经过多层的LICE_module进行进一步的特征信息的提取，并实现对整个数据进一步的下采样，得到更加丰富的局部特征信息并能够减少整体的计算量。这也是在减少数据的长度以便进入注意力编码模块的数据能在一个较短的长度，减少整体的计算量。第三个模块是注意力编码模块，输入模块之前数据要与位置编码相加，使得encoder层能够对长序列特征的数据有一个更好的位置判断，这一模块是进一步的提取特征信息，并使得模型更加关注于数据中异常信号的位置，并为之后的数据的分类提供重要的特征图。本发明针对一般模型只能够对单个数据集进行学习和处理固定长度心电信号，并且不能很好的处理长序列信号的问题,提出了一种基于可分离卷积和注意力机制的心电信号检测方法，包括如下步骤：a)将心电信号的数据集合并到一起，并使其频率相同，得到心电信号记录集X0＝{x1,x2,...,xi,...,xn}，其中xi为第i个心电信号记录，i∈{1,...,n}，n为心电信号记录的总条数。将多个心电数据库中的数据合并到一起，并对多个数据库中的数据重采样到相同的频率，以构建不同长度连续信号的大型数据集。b)对心电信号记录集X0进行预处理，得到预处理后的数据集X2，X2＝{x″1,x″2,...,x″i,...,x″n}。c)将预处理后的数据集X2中第i个预处理后的心电信号记录x″i通过剪裁或零填充的方式生成满足多分支处理模块的数据xi_1，xi_1＝{xi1,xi2,...,xij,...,xim}，其中xij为第i个预处理后的心电信号的第j个分支输入数据，j∈{1,...,m}，m个多分支的个数，xij的长度为Lj，Lj＝1250+j*250。d)建立多分支处理模块，将数据xi_1输入到多分支处理模块中，输出得到数据xi_3。e)建立局部特征信息卷积提取模块，将数据xi_3输入到局部特征信息卷积提取模块中，输出得到特征图xi_7。f)建立注意力编码模块，将特征图xi_7输入到注意力编码模块中，输出得到特征图xi_9。g)建立分类器模块，完成模型的建立，将特征图xi_9输入到分类器模块中，输出得到预测标签预测标签/＞为0时表示心电信号为正常信号，预测标签/＞为1时表示心电信号为异常信号。通过步骤d)至步骤g)构建了完整的模型结构，其包括多分支处理模块、局部特征信息卷积提取模块、注意力编码模块、分类器模块。网络模型中引入多分支处理模块适用于不同长度的心电信号，对其进行特征的转换成固定的数据维度，局部特征信息卷积提取模块是基于卷积的局部特征提取的能力，首先提取局部、浅层的特征信息。注意力编码层使用了自注意力机制，关注于局部每一点和全局的信息的关系，进而结合更多的时域信息和节奏信息。分类器模块基于通过多层的线性变换得到每一个类别具体的概率。主要包含了三个模块：第一个模块为多分支处理模块，对经过降噪处理后的数据判断其长度，使其进入特定的分支模块。整个分支结构进行梯度的线性变换，所有的分支的输出是在同一个尺寸维度；第二个模块是局部特征信息卷积提取模块，包含四个LICE_module模块，对于保留最多特征信息的数据在使用不同尺寸的卷积核对不同程度的特征进行提取，使用该模块降低整体的计算量，加入注意力图谱的计算部分是为了让特征图关注于通道之间的关系；第三个部分是注意力编码模块，将位置编码与特征提取的特征图相加输入到本模块当中，利用注意力机制对长序列信号整体信息把握的能力，通过不断的使用注意力模块使信息关注于数据中异常信号的位置，为最终的分类提供好的判断依据。实施例1：步骤a)中心电信号数据包括MIT-BIH房颤数据集及MIT-BIH心率失常数据集，将MIT-BIH心率失常数据集的采用频率降至250HZ后与MIT-BIH房颤数据集合并到一起，将合并后的数据集随机分割为n条5-30秒的记录，得到心电信号记录集X0＝{x1,x2,...,xi,...,xn}。实施例2：步骤b)包括如下步骤：b-1)在心电信号数据中提取心电信号标签，得到心电信号标签集Y0＝{y1,y2,...,yi,...,yn}，其中yi为第i个心电信号记录xi的标签，yi＝0表示输入信号为正常信号，yi＝1表示输入信号为异常信号。b-2)将心电信号记录集X0中的第i个心电信号记录xi使用巴特沃斯带通滤波器去除噪声中的基线漂移，得到处理后的心电信号记录x′i，数据集X1＝{x′1,x′2,...,x′i,...,x′n}。原始采集的心电信号包含了各种的噪音干扰，这会严重影响模型的分类的效果，进行适当的降噪处理能够明显的提升模型的性能。因此在输入模型之前应当获得较为纯净的心电信号。本发明中使用了巴特沃斯带通滤波器去除基线漂移中的噪声，使用小波滤波器和软阈值去除肌电噪音干扰。b-3)将数据集X1中的第i个心电信号记录x′i通过小波变换和软阈值去除信号中的肌电干扰得到预处理后的心电信号数据记录x″i，数据集X2＝{x″1,x″2,...,x″i,...,x″n}。实施例3：步骤d)包括如下步骤：d-1)多分支处理模块由m个分支构成，每个分支均由第一线性层结构、第二线性层结构构成，第一线性层结构、第二线性层结构均依次由全连接层、Relu激活函数层、Dropout层构成。d-2)将第i个预处理后的心电信号的第j个分支输入数据xij输入到第j个分支的第一线性层结构中，输出得到特征图将特征图/＞输入到第j个分支的第二线性层结构中，输出得到特征图/＞特征图/＞的长度为Lj1，特征图/＞的长度为Lj2，d-3)所有m个分支输出的特征图构成数据集合xi_2，d-4)数据集合xi_2中所有特征图进行拼接操作后输入到最大池化层中，输出得到数据xi_3。实施例4：步骤e)包括如下步骤：e-1)局部特征信息卷积提取模块由第一LICE_module模块、第二LICE_module模块、第三LICE_module模块及第四LICE_module模块构成，第一LICE_module模块、第二LICE_module模块、第三LICE_module模块及第四LICE_module模块均由第一分支、第二分支、BN层、SE模块构成，第一分支由第一卷积层、第一BN层、第一Relu激活函数层、深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层构成，第二分支由扩展卷积层、第一BN层、Relu激活函数层、第二卷积层、第二BN层、dropout层构成。e-2)将数据xi_3依次输入到第一LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第一LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第一分支输出的特征图/＞将数据xi_3依次输入到第一LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第一LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第一LICE_module模块的BN层、SE模块中，得到第一LICE_module模块的输出的特征图xi_4。e-3)将数据xi_4依次输入到第二LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第二LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_4依次输入到第二LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第二LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第二LICE_module模块的BN层、SE模块中，得到第二LICE_module模块的输出的特征图xi_5。e-4)将数据xi_5依次输入到第三LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第三LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_5依次输入到第三LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第三LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第三LICE_module模块的BN层、SE模块中，得到第三LICE_module模块的输出的特征图xi_6。e-5)将数据xi_6依次输入到第四LICE_module模块的第一分支的第一卷积层、第一BN层、第一Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第四LICE_module模块的第一分支的深度可分离卷积层、第二BN层、第二Relu激活函数层、第三卷积层、第三BN层中，得到第二分支输出的特征图/＞将数据xi_6依次输入到第四LICE_module模块的第二分支的扩展卷积层、第一BN层、Relu激活函数层中，输出得到特征图将特征图/＞依次输入到第四LICE_module模块的第二分支的第二卷积层、第二BN层、dropout层中，得到第二分支的输出的特征图/＞将特征图/＞和特征图/＞相加后依次输入到第四LICE_module模块的BN层、SE模块中，得到第四LICE_module模块的输出的特征图xi_7。实施例5：步骤e-2)中第一LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第一LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第一LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*3、步长为1，第一LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为3，第一LICE_module模块的第二分支的第二卷积层的卷积核大小为1*5、步长为1；步骤e-3)中第二LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第二LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第二LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*5、步长为2，第二LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第二LICE_module模块的第二分支的第二卷积层的卷积核大小为1*3、步长为2；步骤e-4)中第三LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第三LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第三LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*5、步长为2，第三LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第三LICE_module模块的第二分支的第二卷积层的卷积核大小为1*3、步长为2；步骤e-5)中第四LICE_module模块的第一分支的第一卷积层的卷积核大小为1*1、步长为1，第四LICE_module模块的第一分支的第三卷积层的卷积核大小为1*1、步长为1，第四LICE_module模块的第一分支的深度可分离卷积层的卷积核小为1*8、步长为2，第四LICE_module模块的第二分支的扩展卷积层的卷积核大小为1*1、扩展比例系数为6，第四LICE_module模块的第二分支的第二卷积层的卷积核大小为1*5、步长为2。实施例6：步骤f)包括如下步骤：f-1)注意力编码模块由Transformer模型的位置编码单元和3层encoder层构成。优选的，步骤f-1)中encoder层的多头自注意力中head的个数为8。encoder层使用了多头自注意力Layer Norm层和全连接的前向传播层。在所有的encoder使用相同的设置，每一层的encoder使用了相同的结构并且输入输出的维度相同。其中参数的设置为多头自注意力中head的个数为8。f-2)将特征图xi_7输入到注意力编码模块的位置编码单元中，输出得到位置编码后的特征图xi_8。f-3)将位置编码后的特征图xi_8依次输入到注意力编码模块的3层encoder层中中进行更加细致的注意力图谱的计算，输出得到特征图xi_9。实施例7：分类器模块依次由卷积层、BN层、Relu激活函数层、flatten层、全连接层、softmax分类器构成。实施例8：还包括在步骤g)后执行如下步骤：h-1)将特征图xi_7输入到分类器模块中，输出得到预测标签h-2)通过公式/＞计算得到损失函数Loss，式中λ和β为权重值，λ+β＝1，γ为聚焦参数，γ＝2。h-3)通过Adam优化器利用损失函数训练步骤g)中的模型，得到训练后的模型，获得最优的模型参数。整个模型尽最大可能的保留原始数据的基本特征信息，并在同一个网络中对不同长度的心电信号进行心电信号异常检测识别。最后应说明的是：以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
