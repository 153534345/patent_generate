标题title
信号检测方法、信号检测装置
摘要abst
本发明公开了一种信号检测方法、信号检测装置。信号检测方法包括：滑窗处理，得到信号的多个时间窗片段；检测高频振荡信号频段，即标记频段并分类各时间窗片段中的高频振荡信号；在高频振荡信号中识别超高频振荡信号。本发明通过第一高斯参数对信号中的高频振荡进行识别并分类，通过第二高斯参数对超高频振荡信号的孤岛进行识别，两者结合，可以更准确、更全面的分析出信号中的高频振荡，有利于提高本方法的准确性、可靠性和鲁棒性。
权利要求书clms
1.一种信号检测方法，其特征在于，包括：滑窗处理，得到信号的多个时间窗片段；检测高频振荡信号频段，即标记频段并分类各时间窗片段中的高频振荡信号；在高频振荡信号中识别超高频振荡信号；所述检测高频振荡信号频段包括：获取第一高斯参数，即拟合各时间窗片段的一维高斯函数；根据第一高斯参数划分各时间窗片段所处的高频振荡信号频段；其中所述一维高斯拟合函数为，为频率变量；所述第一高斯参数包括：带宽、中心频率ctr及其对应的能量高度hgt。2.如权利要求1所述的信号检测方法，其特征在于，所述获取第一高斯参数包括：设定时间窗片段在t时刻的中心频率为且1≤k≤m，m为连续高频振荡持续的最短时长且满足毫秒；判断t-k时刻的中心频率是否满足；若满足，则将该中心频率对应的能量高度筛选出；判断t+k时刻的中心频率是否满足；若满足，则将该中心频率对应的能量高度筛选出。3.如权利要求1或2所述的信号检测方法，其特征在于，所述根据第一高斯参数划分各时间窗片段所处的高频振荡信号频段包括：将筛选出的能量高度组成能量矩阵：h=；对能量高度～做一阶差分，得到每个时间窗片段的差分值D1；对能量高度～做一阶差分，得到每个时间窗片段的差分值D2；若满足同一时间窗片段的D1＞0且D2＜0且，则识别该时间窗片段为高频振荡信号；以及根据中心频率划分时间窗片段所处的频段；其中所述thd2为静息态能量的小波能量，即；表示静息态能量的RMS值的平均值，表示静息态能量的RMS值的方差。4.如权利要求3所述的信号检测方法，其特征在于，所述根据中心频率划分时间窗片段所处的频段包括：若80Hz≤ctr≤150Hz，则将该高频振荡信号记为高频伽马波；若150Hz＜ ctr≤250Hz，则将该高频振荡信号记为涟波；若250Hz＜ ctr≤500Hz，则将该高频振荡信号记为快涟波；若ctr ＞500Hz，则将该高频振荡信号记为超高频振荡波，即超高频振荡信号。5.如权利要求1所述的信号检测方法，其特征在于，所述时间窗片段的窗宽≤20毫秒。6.如权利要求1所述的信号检测方法，其特征在于，所述信号检测方法还包括在滑窗处理之前对原始信号进行信号段筛选；所述信号段筛选包括：获取原始信号的多个RMS值；通过能量阈值初步筛选出包含高频振荡信号的信号段作为所述信号；其中所述能量阈值=静息态能量的RMS值的平均值+3*静息态能量的RMS值的方差。7.如权利要求1所述的信号检测方法，其特征在于，所述信号检测方法还包括在超高频振荡信号中检测孤岛；所述在超高频振荡信号中检测孤岛包括：时频域处理，将信号转换为二维时频图；获取第二高斯参数，即拟合含有超高频振荡信号的时间窗片段的二维高斯函数；根据第二高斯参数检测超高频振荡信号中的孤岛；其中所述二维高斯函数为，为时间变量，为频率变量；所述第二高斯参数包括：能量高度、中心时间、时间宽度、中心频率和频率宽度。8.如权利要求7所述的信号检测方法，其特征在于，若能量高度hgt≥thd1，且时间宽度大于预设时长T，则判定超高频振荡信号中含有孤岛，其中thd1为静息态能量的平均小波能量。9.一种信号检测装置，其特征在于，包括：采集模块，用于采集信号；处理模块，用于执行如权利要求1-8任一项所述的信号检测方法；显示模块，用于显示高频振荡信号频段和超高频振荡信号。
说明书desc
技术领域本发明涉及信号检测技术领域，尤其涉及一种信号检测方法、信号检测装置。背景技术时域信号的信号特征随时间变化，一段时域信号中可能包含正常信号和异常信号，通过对异常信号进行检测、分析，可以了解这异常信号想要反映的内容。现有的信号检测方法，大多基于时域能量直接对异常信号进行检测，这种方法只能检测出信号中是否出现异常信号，无法识别出异常信号具体是哪种信号，并且，这种检测方法也容易出现误检和漏检。因此，需要提出一种新的信号检测方法来提高对异常信号检测的准确率。发明内容本发明要解决的技术问题是：为了解决现有技术的信号检测方法，检测结果不准确的技术问题。本发明提供一种信号检测方法，不仅能够对高频振荡信号进行准确识别和分类，还能够识别出超高频振荡信号。本发明解决其技术问题所采用的技术方案是：一种信号检测方法，包括：滑窗处理，得到信号的多个时间窗片段；检测高频振荡信号频段，即标记频段并分类各时间窗片段中的高频振荡信号；在高频振荡信号中识别超高频振荡信号。进一步的，所述检测高频振荡信号频段包括：获取第一高斯参数，即拟合各时间窗片段的一维高斯函数；根据第一高斯参数划分各时间窗片段所处的高频振荡信号频段；其中所述一维高斯拟合函数为，为频率变量；所述第一高斯参数包括：带宽、中心频率及其对应的能量高度。进一步的，所述获取第一高斯参数包括：设定时间窗片段在t时刻的中心频率为且1≤k≤m，m为连续高频振荡持续的最短时长且满足6毫秒；判断t-k时刻的中心频率是否满足；若满足，则将该中心频率对应的能量高度筛选出；判断t+k时刻的中心频率是否满足≤；若满足，则将该中心频率对应的能量高度筛选出。进一步的，所述根据第一高斯参数划分各时间窗片段所处的高频振荡信号频段包括：将筛选出的能量高度组成能量矩阵：h=；对能量高度～做一阶差分，得到每个时间窗片段的差分值D1；对能量高度～做一阶差分，得到每个时间窗片段的差分值D2；若满足同一时间窗片段的D1＞0且D2＜0且，则识别该时间窗片段为高频振荡信号；以及根据中心频率划分时间窗片段所处的频段；其中所述thd2为静息态能量的小波能量，即；表示静息态能量的RMS值的平均值，表示静息态能量的RMS值的方差。进一步的，所述根据中心频率划分时间窗片段所处的频段包括：若80Hz≤≤150Hz，则将该高频振荡信号记为高频伽马波；若150Hz＜≤250Hz，则将该高频振荡信号记为涟波；若250Hz＜≤500Hz，则将该高频振荡信号记为快涟波；若＞500Hz，则将该高频振荡信号记为超高频振荡波，即超高频振荡信号。进一步的，所述时间窗片段的窗宽≤20毫秒；进一步的，所述信号检测方法还包括在滑窗处理之前对原始信号进行信号段筛选；所述信号段筛选包括：获取原始信号的多个RMS值；通过能量阈值初步筛选出包含高频振荡信号的信号段作为所述信号；其中所述能量阈值=静息态能量的RMS值的平均值+3*静息态能量的RMS值的方差。进一步的，所述信号检测方法还包括在超高频振荡信号中检测孤岛；所述在超高频振荡信号中检测孤岛包括：时频域处理，将信号转换为二维时频图；获取第二高斯参数，即拟合含有超高频振荡信号的时间窗片段的二维高斯函数；根据第二高斯参数检测超高频振荡信号中的孤岛；其中所述二维高斯函数为，为时间变量，为频率变量；所述第二高斯参数包括：能量高度、中心时间、时间宽度、中心频率和频率宽度。进一步的，若能量高度≥thd1，且时间宽度大于预设时长T，则判定超高频振荡信号中含有孤岛，其中thd1为静息态能量的平均小波能量。本发明还提供一种信号检测装置，包括：采集模块，用于采集信号；处理模块，用于执行所述的信号检测方法；显示模块，用于显示高频振荡信号频段和超高频振荡信号。本发明的有益效果是，本发明的通过第一高斯参数对信号中的高频振荡进行识别并分类频段，然后在高频振荡信号中识别超高频振荡信号，可以更准确、更全面的分析出信号中的高频振荡，有利于提高本方法的准确性、可靠性和鲁棒性。附图说明下面结合附图和实施例对本发明进一步说明。图1是本发明的信号检测方法的流程图。图2是本发明的信号检测方法的具体工作流程图。图3是本发明的静息态小波能量随频率变化的曲线图。图4是本发明的高频振荡信号识别的工作流程图。图5a是本发明的信号的时频图的示意图。图5b是本发明的高频振荡频段识别结果的示意图。图5c是本发明的高频振荡检测结果显示的示意图。图6是本发明的高频振荡分类结果的另一示意图。图7是本发明的信号二维高斯拟合的示意图。图8是本发明的超高频振荡信号的孤岛识别的示意图。图9a～图9d是本发明实施例一的A组检测结果图。图10a～图10d是本发明实施例一的B组的检测结果图。图11是本发明的实施例二的原始信号曲线图。图12是本发明的实施例二的检测结果图。图13是本发明的不同窗宽对模拟信号的高频振荡检测结果的示意图。图14是本发明的不同窗宽的检测准确率的示意图。具体实施方式现在结合附图对本发明作进一步详细的说明。这些附图均为简化的示意图，仅以示意方式说明本发明的基本结构，因此其仅显示与本发明有关的构成。在本发明的描述中，需要理解的是，术语“中心”、“纵向”、“横向”、“长度”、“宽度”、“厚度”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”“内”、“外”、“顺时针”、“逆时针”、“轴向”、“径向”、“周向”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本发明的描述中，除非另有说明，“多个”的含义是两个或两个以上。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。如图1所示，本发明的信号检测方法，包括：S1、滑窗处理，得到信号的多个时间窗片段。S2、检测高频振荡信号频段，即标记并频段分类各时间窗片段中的高频振荡信号。S3、在高频振荡信号中识别超高频振荡信号。需要说明的是，本发明的信号可以为生理信号，如脑电、肌电、眼电、心电等的一段信号，脑电又可以分为头皮脑电、颅内脑电等。高频振荡信号是信号中的异常特征，例如，以脑电信号为例，高频振荡信号可能是由于成簇病理性中间神经元的突触后电位聚集产生的，如果不对高频振荡信号进行监测，那么可能会发生不可挽回的后果。而超高频振荡信号是指高频振荡信号中的超高频振荡信号。本发明的信号检测方法，不仅可以对信号中的高频振荡信号进行准确识别、分类，还可以区分出高频振荡信号中的超高频振荡信号，有利于用户评估和量化信号异常的强度，便于对症下药。在进行滑窗处理之前，可以对原始信号做预处理，如连续小波变换，得到信号。原始信号是时域信号，进行变换后的信号是时域信号、频域信号或时频域信号。对信号进行滑窗处理，可以得到多个时间窗片段，每个时间窗片段内包含一段信号。例如，时间窗片段的窗宽≤20毫秒，这样，可以保证持续时间超短的高频振荡信号也能够被捕捉到，防止漏检。例如，在进行滑窗处理之前还可以对变换后的信号进行信号段筛选，首先获取原始信号的多个RMS值，再通过能量阈值初步筛选出包含高频振荡信号的信号段作为信号。其中，能量阈值=静息态能量的RMS值的平均值+3*静息态能量的RMS值的方差。其中，静息态能量是指目标对象在清醒、闭眼、放松状态下的信号能量，RMS为Root Mean Square，表示均方根，能量表示信号的强度，例如信号的幅值等。换言之，进行信号段筛选时，可以先计算出原始信号的多个RMS值，例如，原始信号长度为10min，可以每1min计算一个RMS值，若RMS值大于能量阈值，则将该RMS值对应的原始信号段备选为信号段，再将所有备选的信号段组成信号。这样，经过筛选，可以筛选出整个原始信号中包含高频振荡信号的信号。这样，可以先过滤一些明显不含有高频振荡信号的信号段，减少后续的运算量，提高检测效率。如图2所示，检测高频振荡信号频段包括：获取第一高斯参数，即拟合各时间窗片段的一维高斯函数；根据第一高斯参数划分各时间窗片段所处的高频振荡信号频段。其中，一维高斯拟合函数为 ，为频率变量；第一高斯参数包括：带宽、中心频率及其对应的能量高度。换言之，对每个时间窗片段进行一维高斯函数拟合，可以获得第一高斯参数，每个时间窗片段的第一高斯参数均包含带宽、中心频率和中心频率对应的能量高度，根据中心频率可以判断该时间窗片段所处的高频振荡信号频段。这样，就可以获得每个时间窗片段所处的高频振荡信号频段。根据中心频率划分时间窗片段所处的频段包括：若80Hz≤≤150Hz，则将该高频振荡信号记为高频伽马波；若150Hz＜ctr≤250Hz，则将该高频振荡信号记为涟波；若250Hz＜ctr≤500Hz，则将该高频振荡信号记为快涟波；若＞500Hz，则将该高频振荡信号记为超高频振荡波，即初步筛选的超高频振荡信号。如图3至图4所示，获取第一高斯参数包括：设定时间窗片段在t时刻的中心频率为且1≤k≤m，m为连续高频振荡持续的最短时长且满足6毫秒；判断t-k时刻的中心频率是否满足；若满足，则将该中心频率对应的能量高度筛选出；判断t+k时刻的中心频率是否满足≤；若满足，则将该中心频率对应的能量高度筛选出。将筛选出的能量高度组成能量矩阵：h=，对能量高度～做一阶差分，得到每个时间窗片段的差分值D1；对能量高度～做一阶差分，得到每个时间窗片段的差分值D2；若满足同一时间窗片段的D1＞0且D2＜0且，则识别该时间窗片段为高频振荡信号。然后，根据中心频率划分时间窗片段所处的高频振荡频段。其中，thd2为静息态能量的小波能量， ，表示静息态能量的RMS值的平均值，表示静息态能量的RMS值的方差。也就是说，在本发明中，对高频振荡信号的识别并不仅仅是根据初始的第一高斯参数进行的，而是先对不同时刻的中心频率和能量高度做了筛选，对筛选出的能量高度做一阶差分，根据差分结果以及阈值thd2综合判断该时间窗是否为高频振荡信号。这样，通过一维高斯拟合的能量高度和频率宽度可以有效捕获脑电异常放电时，高频振荡信号随时间推移下的能量变化特点，贴合实际的生理状态；拟合中心频率可以准确量化高频振荡信号的频率区间，进而对高频振荡信号分类，能够显著提高高频振荡信号识别的准确性和可靠性。进一步的，由于部分癫痫患者在发作前期或者发作期，脑电信号会出现超高频振荡的癫痫样，通过对超高频振荡识别有助于识别致痫区，并对癫痫灶定位。然而初步筛选的超高频振荡信号中也可能含有伪迹，也可能含有并非癫痫发作的异常高频信号，会影响致痫区和癫痫灶定位的准确度。因此，需要在超高频振荡信号中检测孤岛，并通过孤岛的识别结果判定超高频振荡信号是否为发作前期或者发作期的脑电信号。在超高频振荡信号中检测孤岛包括：时频域处理，将信号转换为二维时频图；获取第二高斯参数，即拟合含有超高频振荡信号的时间窗片段的二维高斯函数；根据第二高斯参数检测超高频振荡信号中的孤岛。其中，二维高斯函数为，为时间变量，为频率变量；第二高斯参数包括：能量高度、中心时间、时间宽度、中心频率和频率宽度。换言之，根据第一高斯参数区分出含有超高频振荡信号的时间窗片段后，可以将该时间窗片段内的信号变换为二维时频图，然后对二维时频图进行二维高斯拟合，获得第二高斯参数。根据第二高斯参数可以识别出超高频振荡信号中是否含有孤岛。若能量高度≥thd1，且时间宽度大于预设时长T，如T≥6毫秒，则判定超高频振荡信号中含有孤岛，其中，thd1为静息态能量的平均小波能量，即thd1=静息态能量的RMS值的平均值+ w*静息态能量的RMS值的方差， w区间范围3~7。需要说明的是，孤岛是指在二维时频图中， 能量较高的深红色孤岛特征区域，代表以正常脑电为背景下的超高频异常放电特征。二维高斯拟合的自变量为时间和频率，不仅维度高信息量大，而且拟合的中心时间、时间宽度等参数。通过二维高斯函数可以有效捕获时频图上的孤岛特征，量化主观上观察的孤岛，进一步佐证一维高斯函数的拟合结果，尤其适用于超高频振荡信号中的孤岛。如图5a所示，图5a为信号的时频图，横坐标为时间，纵坐标为频率，对一维时频图进行一维高斯拟合后，可以得到多个中心频率ctr，从图中可以看出，中心频率ctr分布在80Hz～700Hz之间，根据中心频率ctr所处的频段，可以区分出该时间窗片段的高频振荡信号具体为哪个波。在图5c中，曲线A为原始信号，线段B为超高频振荡信号的标记，根据图5a至图5c，可以看出，根据本发明的分类方法，可以有效地将原始信号中的高频振荡信号识别出来，并且还能识别出超高频振荡信号。如图6所示，对于尖波复合的复杂波，通过本发明的分类方法，也能够有效识别出高频振荡信号，可以证明本方法具有很好的可靠性和鲁棒性。如图7至图8所示，当信号中存在超高频振荡信号时，时频图呈现有高能量的孤岛，通过第二高斯参数可以有效捕获信号中的孤岛特征。下面，结合具体的实施例来说明本方法的效果。实施例一以颅内脑电信号为例，采样率为16k，时间窗片段的窗宽为3ms，采样时间为60ms，采样信号分为A组和B组，两组均采集了多个通道的脑电信号。对每个通道采集的信号进行变换、滑窗处理，再进行一维、二维高斯拟合，得到每个时间窗片段的分类结果。以10ms为区间，分别统计在该10ms范围内，不同高频振荡类型的出现次数，形成柱状图。从图中可以看出，在A10、A11、A12通道的信号在0～60ms内出现了连续的超高频振荡信号，在B2～B8通道的信号在0～60ms内出现了连续的超高频振荡信号。由此，可以判读该被试者脑电出现异常主要集中在A10～A12通道和B2～B8通道。本方法可以有效区分出信号中的高频振荡的具体类型。实施例二以婴儿头皮脑电为例，采样率为500Hz，时间窗片段的窗宽为2ms，采样时间为45ms，采集了不同头皮位置的多组脑电信号。对每组信号进行变换、滑窗处理后，再进行一维、二维高斯拟合，得到每个时间窗片段的分类结果。以5ms为区间，分别统计在该5ms范围内，不同高频振荡类型的出现次数，形状柱状图。从图中可以看出，该被试者的脑电信号发生异常主要是在尖波发生时刻，属于高频振荡信号的高频伽马波段。根据上述两个实施例可知，本发明的分类方法对于不同的被试者均可以准确识别出高频振荡信号并区分具体是高频振荡信号的哪个频段、是否含有孤岛。由此可以说明，本方法具有较好的鲁棒性。并且，本方法可以准确区分出被试者信号异常的频段，便于后续有针对性的采取措施，具有较高的应用价值。本发明的时间窗片段的窗宽设置为≤20毫秒，并且在获取第一高斯参数时m需满足：6毫秒，这样做是为了提高高频振荡信号检测的准确率。例如可以通过模拟信号来进行验证。模拟信号由粉红噪声+高频振荡模板+白噪声组成，模拟信号中包含14个高频振荡模板。如图13所示，遍历窗宽1ms～20ms，分别得到对模拟信号的高频振荡检测结果。第一行的黑色实线为模拟信号的真实标签，包含14个HFO。当窗宽小于6ms时，本方法可以准确识别出14个高频振荡，检测准确率达到100%，因此在追求检测准确率时，可以将时间窗片段的窗宽进一步优选为1ms≤窗宽≤6ms，例如3ms、4ms、5ms；当窗宽≥6ms时，识别出的高频振荡个数逐渐减少，准确率逐渐下降，因此，当追求计算量时，可以将时间窗片段的窗宽进一步优选为6ms≤窗宽≤15ms，例如8ms、10ms、12ms。本发明还提供了一种信号检测装置，包括：采集模块，用于采集信号；处理模块，用于执行所述的信号检测方法；显示模块，用于显示高频振荡信号频段和超高频振荡信号。采集模块可以采集被试者的原始信号并传输给处理模块，处理模块对原始信号进行处理，得到高频振荡的检测结果；处理模块可以把检测结果传输给显示模块，显示模块将检测结果进行显示，便于用户直观地了解。可选的，所述采集模块例如但不限于电极，所述处理器模模块例如但不限于MCU、FPGA、CPU、GPU处理器芯片，所述显示模块例如但不限于显示屏、示波器等。综上所述，本发明的分类方法，通过第一高斯参数对信号中的高频振荡进行识别并分类，通过第二高斯参数对超高频振荡信号的孤岛进行识别，两者结合，可以更准确、更全面的分析出信号中的高频振荡，有利于提高本方法的准确性、可靠性和鲁棒性。以上述依据本发明的理想实施例为启示，通过上述的说明内容，相关工作人员完全可以在不偏离本项发明技术思想的范围内，进行多样的变更以及修改。本项发明的技术性范围并不局限于说明书上的内容，必须要如权利要求范围来确定其技术性范围。
