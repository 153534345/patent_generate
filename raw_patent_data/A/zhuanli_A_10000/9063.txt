标题title
一种非接触式人体血氧饱和度检测方法
摘要abst
本发明属于血氧检测技术领域，尤其是涉及一种非接触式人体血氧饱和度检测方法。一种非接触式人体血氧饱和度检测方法，包括以下步骤：S1、视频获取；S2、图像区域获取；S3、原始信号获取；S4、分离信号获取；S5、变量获取；S6、结果获取，基于步骤S5提取出的ACR、ACB和DCR、DCB计算出血氧饱和度参数R，根据朗伯—比尔定律，得到血氧饱和度SPO2。本发明提供了一种解决已公开方法中基于红蓝通道提取的原始信号信噪比差进而测量结果准确度不高的问题、采用非接触式人体血氧饱和度的检测方法。
权利要求书clms
1.一种非接触式人体血氧饱和度检测方法，其特征在于包括以下步骤：S1、视频获取，获取人体面部视频数据；S2、图像区域获取，截取步骤S1中视频的每一帧图像，并从视频帧图像中选取面部两脸颊部位作为感兴趣区域ROI；S3、原始信号获取，提取步骤S2中ROI的红色通道平均像素值PR和蓝色通道平均像素值PB作为原始脉搏波信号；S4、分离信号获取，采用基于动态嵌入的单通道独立成分分析算法，分别对步骤S3所得的脉搏波红色通道信号PR和蓝色通道信号PB进行盲源分离，得到重构的分离信号IR和IB；S5、变量获取，分别提取出步骤S4所得的重构信号IR和IB的交流变量ACR、ACB和直流变量DCR、DCB；S6、结果获取，基于步骤S5提取出的ACR、ACB和DCR、DCB计算出血氧饱和度参数R，根据朗伯—比尔定律，得到血氧饱和度SPO2。2.根据权利要求1所述的一种非接触式人体血氧饱和度检测方法，其特征在于所述步骤S4还包括以下步骤：S41、选择嵌入维数m和时间延迟Δ，分别将步骤S3获取的PR和PB进行相空间重构，形成两组多维向量；S42、当m较大时，先使用快速ICA算法对获取的嵌入矩阵P降维至k，后再使用快速ICA算法对降维后的矩阵进行盲源分离，分离出独立分量Q；S43、从Q中选取与BVP相关的独立分量Qj乘以对应混合矩阵B的列向量bj得到独立子分量Pj＝∑biQi，i∈j，j为与BVP相关的独立分量的集合；S44、对分量Pj进行逆重构，得到最终的一维分离信号3.根据权利要求2所述的一种非接触式人体血氧饱和度检测方法，其特征在于所述步骤S42还包括分离出独立分量Q＝AP，Q＝T，A为n×k维的解混矩阵，P为多维向量，n为分离出的独立信号的个数，此时n＝k；估计混合矩阵B＝pinv，B＝T，pinv表示伪逆。4.根据权利要求2所述的一种非接触式人体血氧饱和度检测方法，其特征在于所述步骤S41中嵌入维数m和时间延迟Δ的选取方法包括：时间延迟Δ取1，嵌入维数m根据观测信号的采样频率及源信号的最小频率进行设置，其中，fps为观测信号PR和PB的采样频率。5.根据权利要求4所述的一种非接触式人体血氧饱和度检测方法，其特征在于所述fps为相机的帧率，为30帧/秒；fL取分离后的源信号的最小频率，m为30～60。6.根据权利要求2所述的一种非接触式人体血氧饱和度检测方法，其特征在于所述步骤S42中使用快速ICA算法对获取的嵌入矩阵P进行降维时，基于特征值贡献率累积量选取降维后的维度k。7.根据权利要求1所述的一种非接触式人体血氧饱和度检测方法，其特征在于所述步骤S5中提取重构信号IR和IB的交流变量ACR、ACB和直流变量DCR、DCB的方法包括以下步骤：对重构信号IR和IB采用0.6～3HZ的带通滤波器进行滤波处理，提取与人体动脉血流容积脉冲BVP相关的频率信号SR和SB；通过计算SR和SB的标准差得到交流变量ACR和ACB；通过计算SR和SB的均值得到直流变量DCR、DCB。8.根据权利要求1所述的一种非接触式人体血氧饱和度检测方法，其特征在于所述步骤S6中血氧饱和度值的计算方法为：SPO2＝A+B*R其中，A、B通过求得的R序列与血氧仪参考值进行最小二乘线性拟合得到。
说明书desc
技术领域本发明属于血氧检测技术领域，尤其是涉及一种非接触式人体血氧饱和度检测方法。背景技术血氧饱和度是指人体血液中被氧结合的血红蛋白容量占总血红蛋白容量的百分比，它作为呼吸循环的重要参数，可以对肺的氧合和血红蛋白携氧能力进行估计，是一项重要的临床健康监护指标。传统的血氧饱和度测量方法分为有创法和无创法。有创法指的是先采集人体血液，再利用血气分析仪对血液进行分析从而计算出血氧饱和度的值。这种方法比较麻烦且不能连续测值，最主要的缺陷是会使用户产生疼痛感或者感染风险。无创法以指夹式血氧仪为主，需要将仪器与人的手指贴合，这种方法虽然可以进行连续测值，但是对于有皮肤创伤的使用者或者抽搐型病人明显不适用，且对一般用户也会造成不适感。近年来，由于成像式光电容积描记技术的兴起，它以其不需要通过与人体皮肤接触而直接通过对人体皮肤图像进行数据采集的特点成为非接触领域的热点研究方向。国内外学者基于IPPG的这一优点开展了血氧饱和度测量方法研究，内容均基于双波长可见光实现，总体上处于探索阶段，且设备昂贵不够便携，不利于日常监测。随着科技时代的迅速发展，笔记本、智能手机等装有摄像头的设备几乎成为生活必需工具，且基于这些彩色相机采集的图像数据，通过IPPG技术测量血氧饱和度被证实是可行的。部分已公开的文献和专利提到了采用彩色相机视频的红蓝通道作为双波长组合进行血氧饱和度测量，但是由于这些低端相机的分辨率较低，灵敏度较弱，若简单采用红蓝通道的像素值作为测量参数，噪声干扰较大，测量结果不够准确。发明内容本发明所要解决的技术问题是提供一种解决已公开方法中基于红蓝通道提取的原始信号信噪比差进而测量结果准确度不高的问题、采用非接触式人体血氧饱和度的检测方法。为此，本发明采用以下技术方案：一种非接触式人体血氧饱和度检测方法，包括以下步骤：S1、视频获取，获取人体面部视频数据；S2、图像区域获取，截取步骤S1中视频的每一帧图像，并从视频帧图像中选取面部两脸颊部位作为感兴趣区域ROI；S3、原始信号获取，提取步骤S2中ROI的红色通道平均像素值PR和蓝色通道平均像素值PB作为原始脉搏波信号；S4、分离信号获取，采用基于动态嵌入的单通道独立成分分析算法，分别对步骤S3所得的脉搏波红色通道信号PR和蓝色通道信号PB进行盲源分离，得到重构的分离信号IR和IB；S5、变量获取，分别提取出步骤S4所得的重构信号IR和IB的交流变量ACR、ACB和直流变量DCR、DCB；S6、结果获取，基于步骤S5提取出的ACR、ACB和DCR、DCB计算出血氧饱和度参数R，根据朗伯—比尔定律，得到血氧饱和度SPO2。本发明方法采用基于动态嵌入的单通道独立成分分析算法分别对采集的红蓝通道信号进行盲源分离，有效地消除了与BVP不相关的噪声，进而再根据朗伯—比尔定律进行双波长法的血氧饱和度估计，提高了检测准确度。在采用上述技术方案的基础上，本发明还可采用以下进一步的技术方案：所述步骤S4还包括以下步骤：S41、选择嵌入维数m和时间延迟Δ，分别将步骤S3获取的PR和PB进行相空间重构，形成两组多维向量。其中，ICA算法要求观测信号的个数应大于等于源信号的个数，因此首先分别将长度为N的一维信号PR和PB进行相空间重构，形成两组多维向量。S42、当m较大时，先使用快速ICA算法对获取的嵌入矩阵P降维至k，后再使用快速ICA算法对降维后的矩阵进行盲源分离，分离出独立分量Q；S43、从Q中选取与BVP相关的独立分量Qj乘以对应混合矩阵B的列向量bj得到独立子分量Pj＝∑biQi，i∈j，j为与BVP相关的独立分量的集合；S44、对分量Pj进行逆重构，得到最终的一维分离信号进一步地，所述步骤S42还包括分离出独立分量Q＝AP，Q＝T，A为n×k维的解混矩阵，P为多维向量，n为分离出的独立信号的个数，此时n＝k；估计混合矩阵B＝pinv，B＝T，pinv表示伪逆。进一步地，所述步骤S41中嵌入维数m和时间延迟Δ的选取方法包括：选择嵌入维数m和时间延迟Δ，分别使得观测信号PR和PB变成新的延迟变量，公式如下：P＝,t＝1,2,...,N-Δ依据上述公式组合构成多维嵌入延时矩阵信号，公式如下：时间延迟Δ取1，嵌入维数m根据观测信号的采样频率及源信号的最小频率进行设置，其中，fps为观测信号PR和PB的采样频率。所述fps为相机的帧率，为30帧/秒；fL取分离后的源信号的最小频率，m为30～60。其中，为保证获取的嵌入矩阵P能够提取出足够多的隐含信息，fL一般取分离后的源信号的最小频率。由于与BVP相关的信号频率一般为1-2HZ，所以m一般为30～60。进一步地，所述步骤S42中使用快速ICA算法对获取的嵌入矩阵P进行降维时，基于特征值贡献率累积量选取降维后的维度k。进一步地，步骤S44中DE-ICA的逆过程可表示为以下公式：其中ceil表示向上取整。按照公式的序位将Pj进行重构至一维分离信号重构过程中重复的元素用均值代替。所述步骤S5中提取重构信号IR和IB的交流变量ACR、ACB和直流变量DCR、DCB的方法包括以下步骤：对重构信号IR和IB采用0.6～3HZ的带通滤波器进行滤波处理，提取与人体动脉血流容积脉冲BVP相关的频率信号SR和SB；通过计算SR和SB的标准差得到交流变量ACR和ACB；通过计算SR和SB的均值得到直流变量DCR、DCB。所述步骤S6中血氧饱和度值的计算方法为：SPO2＝A+B*R其中，B、B通过求得的R序列与血氧仪参考值进行最小二乘线性拟合得到。与现有技术相比，本发明具有以下有益效果：采用DE-ICA算法分别对采集的红蓝通道信号进行盲源分离，有效地消除了与BVP不相关的噪声，进而再根据朗伯—比尔定律进行双波长法的血氧饱和度估计，提高了检测准确度。附图说明图1为本发明一种非接触式人体血氧饱和度检测方法的流程示意图；图2为本发明一种非接触式人体血氧饱和度检测方法的人脸ROI区域检测示意图；图3为本发明一种非接触式人体血氧饱和度检测方法的DE-ICA算法进行噪声滤除后的波形对比图；图4为运用本发明一种非接触式人体血氧饱和度检测方法的进行自然状态下血氧饱和度测量结果示意图；图5为运用本发明一种非接触式人体血氧饱和度检测方法的进行屏息状态下血氧饱和度测量结果示意。具体实施方式为了进一步理解本发明，下面结合具体实施方式对本发明提供的一种非接触式人体血氧饱和度检测方法进行具体描述，但本发明并不限于此，该领域技术人员在本发明核心指导思想下做出的非本质改进和调整，仍然属于本发明的保护范围。如图1-5所示，一种非接触式人体血氧饱和度检测方法，包括如下步骤：S1、获取人体面部视频数据。具体地，本发明采用一部配有普通摄像头的智能手机放在人脸前方50cm处，保持人脸正对摄像头并保证人脸完全处于拍摄画面中。录制视频分辨率为540×960、帧率为30、RGB彩色空间，录制视频为10s，格式保存为mp4格式，运行环境为win7+Python3。S2、截取视频中每一帧图像，并从视频帧图像中选取面部两脸颊部位作为感兴趣区域。具体地，采用人脸检测器Dlib库识别视频图像中的人脸并定位面部68个特征点，基于68个特征点中的部分特征点框出两脸颊ROI。S3、提取ROI的红色通道平均像素值PR和蓝色通道平均像素值PB作为原始脉搏波信号。具体地，提取出每一帧图像中两ROI的RGB通道值，对两ROI的红蓝通道像素值作平均，由此生成基于ROI的两通道信号PR和PB。S4、如图3所示，采用DE-ICA算法分别对脉搏波红色通道信号PR和蓝色通道信号PB进行盲源分离，得到重构的分离信号IR和IB；进一步地，步骤S4包含以下步骤：S41、ICA算法要求观测信号的个数应大于等于源信号的个数，因此首先分别将长度为N的一维信号PR和PB进行相空间重构，形成两组多维向量。具体地，选择嵌入维数m和时间延迟Δ，分别使得观测信号PR和PB变成新的延迟变量，公式如下：P＝,t＝1,2,...,N-Δ依据上述公式组合构成多维嵌入延时矩阵信号，公式如下：其中，时间延迟Δ一般取1，嵌入维数m可根据观测信号的采样频率及源信号的最小频率进行设置，公式如下：其中，fps为观测信号PR和PB的采样频率，这里即为相机的帧率，30帧/秒。为保证获取的嵌入矩阵P能够提取出足够多的隐含信息，fL一般取分离后的源信号的最小频率。由于与BVP相关的信号频率一般为1-2HZ，所以m一般为30～60，本实施例中取30。S42、由于嵌入维数m较大，可先使用快速ICA算法对获取的嵌入矩阵P降维至k，后再使用FastICA对降维后的矩阵进行盲源分离，分离出独立分量Q＝AP，Q＝T，其中A是n×k维的解混矩阵，n是分离出的独立信号的个数，这里n＝k。同时估计混合矩阵B＝pinv，B＝T，pinv表示伪逆。S43、从Q中选取与BVP相关的独立分量Qj乘以对应混合矩阵B的列向量bj得到独立子分量Pj＝∑biQi，i∈j，j为与BVP相关的独立分量的集合。S44、对分量Pj进行逆重构，得到最终的一维分离信号具体地，DE-ICA的逆过程可表示以下公式，其中ceil表示向上取整。按照公式的序位将Pj进行重构至一维分离信号重构过程中重复的元素用均值代替。S45、对所述S102步骤得到的一维信号PR和PB分别进行上述步骤的处理，获取重构后的一维分离信号IR和IB。S5、分别对重构信号IR和IB采用0.6～3HZ的带通滤波器进行滤波处理，提取与人体动脉血流容积脉冲相关的频率信号SR和SB，通过计算SR和SB的标准差得到交流变量ACR和ACB；通过计算SR和SB的均值得到直流变量DCR和DCB。S6、根据朗伯—比尔定律，计算得到血氧饱和度SPO2，公式如下：SPO2＝A+B*R其中，A、B可通过求得的R序列与血氧仪参考值进行最小二乘线性拟合得到，后续可基于该值进行血氧饱和度预测。如图4所示，对本发明所提方法进行测试。在本实施例中，选取8名受试者，4名女性和4名男性，实验环境和过程如下：在自然光线下，室温23度，让受试者坐在距离摄像头约50cm处保持自然呼吸状态，录制10s的面部视频作为样本数据，基于样本数据采用本发明所提方法进行血氧饱和度的测量计算。录制时让受试者手持普通指夹式血氧仪并记录10s内的血氧饱和度值的平均值作为参考值。结果显示，本发明所提方法的测量精度达到一个较好的标准。如图5所示，为不失一般性，选取其中一名受试者进行屏息试验。实验环境与上述相同，不同的是，让受试者前20s处于自然呼吸状态，从21s开始屏住呼吸30s，同时手持普通指夹式血氧仪记录受试者的血氧饱和度值作为参考值。结果同样显示，本发明所提方法的测量精度达到一个较好的标准。应当指出的是，本发明公开不限于前述实施方式并且可以在不背离本公开的精神的情况下适当地改变；例如，在S101中在面部选取不同的感兴趣区域；例如在S104中的带通滤波选用合适的频率范围等。虽然本发明已通过参考优选的实施例进行了图示和描述，但是，本专业普通技术人员应当了解，在权利要求书的范围内，可作形式和细节上的各种各样变化。
