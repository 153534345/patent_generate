标题title
一种基于非负矩阵分解的胎心音信号降噪方法
摘要abst
本发明公开了一种基于非负矩阵分解的胎心音信号降噪方法。现有滤波方法对提高胎心音信号的信噪比存在局限性。本发明对信号进行短时傅里叶变换得到幅值信息矩阵和相角信息矩阵；对幅值信息矩阵进行奇异值分解和非负矩阵分解，并根据特征矩阵和系数矩阵选取有用特征，组合得到降噪后的幅值信息矩阵；对相角信息矩阵进行相位补偿获得补偿后的相位矩阵；对幅值信息矩阵和补偿后的相位矩阵进行短时傅里叶逆变换，得到降噪后的时域信号。本发明所采用的奇异值分解方法避免了初始值的随机性对矩阵迭代结果的影响，所采用的相位补偿方法用补偿后的相位代替原始带噪信号相位，增加了降噪后相位信号的可信度，明显提升了胎心音信号的降噪效果。
权利要求书clms
1.一种基于非负矩阵分解的胎心音信号降噪方法，其特征在于：该方法包括以下步骤：步骤1、对胎儿心音原始数据进行重采样，将采样率降为1KHz，重采样后的信号记为y，n为采样点；步骤2、对离散的y信号进行短时傅里叶变换，得到信号时频图；短时傅里叶变换后，根据频域的复数信号的模得到幅值信息矩阵|Y|，根据复数信号的辐角得到相角信息矩阵∠Y，其中，a和b分别为幅值信息矩阵或相角信息矩阵的行和列，a遍历{1,2，……，A}，b遍历{1,2，……，B}，A为幅值信息矩阵或相角信息矩阵的总行数，B为幅值信息矩阵或相角信息矩阵的总列数；步骤3、分别对幅值信息和相位信息进行处理；步骤3.1对幅值信息矩阵进行奇异值分解，奇异值分解后求取非负矩阵分解的特征个数R、特征矩阵W的初始矩阵和系数矩阵H的初始矩阵；然后对幅值信息矩阵进行非负矩阵分解，并根据特征矩阵和系数矩阵选取有用特征，组合得到降噪后的幅值信息矩阵X；步骤3.2对相角信息矩阵∠Y进行相位补偿处理，获得补偿后的相位矩阵∠Y+Λ；步骤4、对幅值信息矩阵X和补偿后的相位矩阵∠Y+Λ进行短时傅里叶逆变换，得到降噪后的时域信号x。2.根据权利要求1所述一种基于非负矩阵分解的胎心音信号降噪方法，其特征在于：所述的短时傅里叶变换具体如下：使用125点的汉明窗对y信号进行截取，截取的每两个相邻段之间设有25个重叠的采样点；然后对截取的每一小段进行傅里叶变换，时域的实数信号经傅里叶变换后得到频域的复数信号。3.根据权利要求1所述一种基于非负矩阵分解的胎心音信号降噪方法，其特征在于：所述的步骤3.1具体如下：步骤3.1.1、对幅值信息矩阵|Y|进行奇异值分解|Y|＝U∑VT，其中U为a×a的酉矩阵，V为b×b的酉矩阵，VT为V的共轭转置矩阵，是半正定a×b阶对角矩阵，矩阵∑1＝diag，其中σ1≥σ2≥…σz＞0，σ1，σ2，…，σz为幅值信息矩阵|Y|的奇异值；然后，根据∑1求取非负矩阵分解的特征个数R，具体步骤如下：a)求取∑1中各元素的总和sum1＝σ1+σ2+…+σz，z为∑1中元素的总数；b)依次求取σ1，σ2，…，σz中前g个元素的和sum2，并计算sum2/sum1的值，若sum2/sum1＞0.9，则将g值作为非负矩阵分解的特征个数R，其中g遍历{1，2，…，z}；步骤3.1.2、设定优化目标为使欧几里得距离DEUD满足：其中，是弗罗贝尼乌斯范数；特征矩阵W的迭代公式为：系数矩阵H的迭代公式为：其中，⊙代表矩阵对应元素相乘，代表矩阵对应元素相除，迭代次数c≥1，r遍历{1，2，……，R}，特征矩阵的初始矩阵W0为奇异值分解得到的矩阵U的前R列组成的矩阵，系数矩阵的初始矩阵H0为奇异值分解得到的VT的前R行组成的矩阵；将迭代后得到的特征矩阵W和系数矩阵H相乘得到矩阵WH，作为幅值信息矩阵|Y|的非负矩阵分解结果，其中，W为A×R的矩阵，H为R×B的矩阵；步骤3.1.3、将特征矩阵W的第r列与系数矩阵H的第r行相乘，得到WHr；然后，求WHr与|Y|的相关系数其中，结合阈值将相关系数ρr大于λ的各WHr求和得到降噪后的幅值信息矩阵X；其中，4.根据权利要求1所述一种基于非负矩阵分解的胎心音信号降噪方法，其特征在于：所述的步骤3.2具体如下：步骤3.2.1、计算相角信息矩阵∠Y每一个元素对应位置的局部信噪比其中，相角信息矩阵∠Y是A×B的矩阵；取θr＝0.1；步骤3.2.2、局部信噪比确定后，估计谱时间稀疏度：其中，表示取最大整数的符号，N＝，取Iq＝8，Kq＝8；步骤3.2.3、将谱时间稀疏度s通过sigmoid函数q映射到区间，其中，exp代表指数函数，取γ＝0.3；步骤3.2.4、确定补偿相位矩阵其中，不随时间变化的反对称函数ψ公式为：步骤3.2.5、将求得的补偿相位矩阵Λ与相角信息矩阵∠Y相加获得补偿后的相位矩阵∠Y+Λ。
说明书desc
技术领域本发明涉及一种信号降噪方法，尤其是一种基于非负矩阵分解的胎心音信号降噪方法。背景技术在实际采集胎心音信号的过程中，包含有大量噪声，其中不仅胎儿自身在子宫内运动产生的噪声、母体内部的心脏跳动声以及其他器官运作的声音都会混叠在有用信号中，另外传感器与母体腹部摩擦的声音和环境噪声也是噪声的主要组成部分。因此需要对所采集到的信号进行降噪，提高信噪比，才能确保后续计算胎心率的准确性。目前已有许多降噪方法被应用于胎心音信号处理，其中小波变换、经验模态分解都是数字信号处理中常用的滤波方法。基于小波变换的滤波器，小波母函数以及小波阈值的选择对降噪效果有较大的影响，其次小波变换主要用于抑制有用信号频带以外的噪声，但是不能抑制与有用信号相同频段的噪声；经验模态分解是一种经验算法，目前没有精确的数学推理，存在包络拟合、端点效应、模态混叠等关键性缺陷，这些缺陷将导致经验模态分解的效果不理想；由于胎心音信号属于非平稳、非线性的信号，并且噪声频段与有用信号频段相重合，难以用小波变换和经验模态分解实现最优滤波。综上，上述现有的滤波方法对提高胎心音信号的信噪比虽然具有实际意义，但存在一定的局限性，影响了降噪结果的可靠性。发明内容本发明针对现有技术的不足，提出一种基于非负矩阵分解的胎心音信号降噪方法。本发明一种基于非负矩阵分解的胎心音信号降噪方法，包括以下步骤：步骤1、对胎儿心音原始数据进行重采样，将采样率降为1KHz，重采样后的信号记为y，n为采样点。步骤2、对离散的y信号进行短时傅里叶变换，得到信号时频图；短时傅里叶变换后，根据频域的复数信号的模得到幅值信息矩阵|Y|，根据复数信号的辐角得到相角信息矩阵∠Y，其中，a和b分别为幅值信息矩阵或相角信息矩阵的行和列，a遍历{1，2，……，A}，b遍历{1，2，……，B}，A为幅值信息矩阵或相角信息矩阵的总行数，B为幅值信息矩阵或相角信息矩阵的总列数。步骤3、分别对幅值信息和相位信息进行处理。步骤3.1对幅值信息矩阵进行奇异值分解，奇异值分解后求取非负矩阵分解的特征个数R、特征矩阵W的初始矩阵和系数矩阵H的初始矩阵；然后对幅值信息矩阵进行非负矩阵分解，并根据特征矩阵和系数矩阵选取有用特征，组合得到降噪后的幅值信息矩阵X。步骤3.2对相角信息矩阵∠Y进行相位补偿处理，获得补偿后的相位矩阵步骤4、对幅值信息矩阵X和补偿后的相位矩阵进行短时傅里叶逆变换，得到降噪后的时域信号x。进一步，所述的短时傅里叶变换具体如下：使用125点的汉明窗对y信号进行截取，截取的每两个相邻段之间设有25个重叠的采样点；然后对截取的每一小段进行傅里叶变换，时域的实数信号经傅里叶变换后得到频域的复数信号。进一步，所述的步骤3.1具体如下：步骤3.1.1、对幅值信息矩阵|Y|进行奇异值分解|Y|＝U∑VT，其中U为a×a的酉矩阵，V为b×b的酉矩阵，VT为V的共轭转置矩阵，是半正定a×b阶对角矩阵，矩阵∑1＝diag，其中σ1≥σ2≥…σz＞0，σ1，σ2，…，σz为幅值信息矩阵|Y|的奇异值。然后，根据∑1求取非负矩阵分解的特征个数R，具体步骤如下：a)求取∑1中各元素的总和sum1＝σ1+σ2+…+σz，z为∑1中元素的总数。b)依次求取σ1，σ2，…，σz中前g个元素的和sum2，并计算sum2/sum1的值，若sum2/sum1＞0.9，则将g值作为非负矩阵分解的特征个数R，其中g遍历{1，2，…，z}。步骤3.1.2、设定优化目标为使欧几里得距离DEUD满足：其中，是弗罗贝尼乌斯范数；特征矩阵W的迭代公式为：系数矩阵H的迭代公式为：其中，代表矩阵对应元素相乘，代表矩阵对应元素相除，迭代次数c≥1，r遍历{1，2，……，R}，特征矩阵的初始矩阵W0为奇异值分解得到的矩阵U的前R列组成的矩阵，系数矩阵的初始矩阵H0为奇异值分解得到的VT的前R行组成的矩阵。将迭代后得到的特征矩阵W和系数矩阵H相乘得到矩阵WH，作为幅值信息矩阵|Y|的非负矩阵分解结果，其中，W为A×R的矩阵，H为R×B的矩阵。步骤3.1.3、将特征矩阵W的第r列与系数矩阵H的第r行相乘，得到WHr；然后，求WHr与|Y|的相关系数其中，结合阈值将相关系数ρr大于λ的各WHr求和得到降噪后的幅值信息矩阵X；其中，进一步，所述的步骤3.2具体如下：步骤3.2.1、计算相角信息矩阵∠Y每一个元素对应位置的局部信噪比其中，相角信息矩阵∠Y是A×B的矩阵；取θr＝0.1。步骤3.2.2、局部信噪比确定后，估计谱时间稀疏度：其中，表示取最大整数的符号，N＝，取Iq＝8，Kq＝8。步骤3.2.3、将谱时间稀疏度s通过sigmoid函数q映射到区间，其中，exp代表指数函数，取γ＝0.3。步骤3.2.4、确定补偿相位矩阵其中，不随时间变化的反对称函数ψ公式为：步骤3.2.5、将求得的补偿相位矩阵与相角信息矩阵∠Y相加获得补偿后的相位矩阵本发明相比于现有技术的有益效果为：1、本发明所采用的奇异值分解方法，能够确定信号所包含的特征数，并获得固定的W和H的初始值，避免了初始值的随机性对矩阵迭代结果的影响；而且，本发明所采用的相位补偿方法，用补偿后的相位代替原始带噪信号相位，增加了降噪后相位信号的可信度，较为明显的提升了胎心音信号的降噪效果，能对不同大小信噪比的信号进行有效降噪，针对与有用信号同频段的噪声信号的降噪处理，效果特别明显。2、本发明步骤简单，设计合理，实现方便，适用范围较广。附图说明图1为本发明的流程框图；图2为一组真实胎心音原始数据经重采样和短时傅里叶变换后的信号时频图；图3为一组真实胎心音原始数据采用本发明降噪后的时频图；图4为第一组模拟胎心音信号采用本发明降噪前后的时域波形对比图；图5为第二组模拟胎心音信号采用本发明降噪前后的时域波形对比图；图6为第三组模拟胎心音信号采用本发明降噪前后的时域波形对比图。具体实施方式如图1所示，一种基于非负矩阵分解的胎心音信号降噪方法，包括以下步骤：步骤1、电子听诊器采集胎儿心音原始数据，并上传至PC。由于胎儿心音原始数据的采样率为16KHz，而胎儿心音有用信号频段集中在500Hz以下，因此对胎儿心音原始数据进行重采样，将采样率降为1KHz，重采样后的信号记为y，n为采样点。步骤2、对离散的y信号进行短时傅里叶变换，得到信号时频图；短时傅里叶变换具体如下：使用125点的汉明窗对y信号进行截取，截取的每两个相邻段之间设有25个重叠的采样点，将非平稳信号y看作截取后的短时平稳信号的叠加；然后对截取的每一小段进行傅里叶变换，时域的实数信号经傅里叶变换后得到频域的复数信号。短时傅里叶变换后，根据频域的复数信号的模得到幅值信息矩阵|Y|，根据复数信号的辐角得到相角信息矩阵∠Y，其中，a和b分别为幅值信息矩阵或相角信息矩阵的行和列，a遍历{1，2，……，A}，b遍历{1，2，……，B}，A为幅值信息矩阵或相角信息矩阵的总行数，B为幅值信息矩阵或相角信息矩阵的总列数。步骤3、分别对幅值信息和相位信息进行处理。步骤3.1对幅值信息矩阵进行奇异值分解，奇异值分解后求取非负矩阵分解的特征个数R、特征矩阵W的初始矩阵和系数矩阵H的初始矩阵；然后对幅值信息矩阵进行非负矩阵分解，并根据特征矩阵和系数矩阵选取有用特征，组合得到降噪后的幅值信息矩阵X。步骤3.2对相角信息矩阵∠Y进行相位补偿处理，获得补偿后的相位矩阵步骤4、对幅值信息矩阵X和补偿后的相位矩阵进行短时傅里叶逆变换，得到降噪后的时域信号x。进一步，所述的步骤3.1具体如下：步骤3.1.1、对幅值信息矩阵|Y|进行奇异值分解|Y|＝U∑VT，其中U为a×a的酉矩阵，V为b×b的酉矩阵，VT为V的共轭转置矩阵，是半正定a×b阶对角矩阵，矩阵∑1＝diag，其中σ1≥σ2≥…σz＞0，σ1，σ2，…，σz即为幅值信息矩阵|Y|的奇异值。然后，根据∑1求取非负矩阵分解的特征个数R，具体步骤如下：a)求取∑1中各元素的总和sum1＝σ1+σ2+…+σz，z为∑1中元素的总数。b)依次求取σ1，σ2，…，σz中前g个元素的和sum2，并计算sum2/sum1的值，若sum2/sum1＞0.9，则将g值作为非负矩阵分解的特征个数R，其中g遍历{1，2，…，z}。步骤3.1.2、设定优化目标为使欧几里得距离DEUD满足：其中，是弗罗贝尼乌斯范数；特征矩阵W的迭代公式为：系数矩阵H的迭代公式为：其中，代表矩阵对应元素相乘，代表矩阵对应元素相除，迭代次数c≥1，r遍历{1，2，……，R}，特征矩阵的初始矩阵W0为奇异值分解得到的矩阵U的前R列组成的矩阵，系数矩阵的初始矩阵H0为奇异值分解得到的VT的前R行组成的矩阵。将迭代后得到的特征矩阵W和系数矩阵H相乘得到矩阵WH，作为幅值信息矩阵|Y|的非负矩阵分解结果，其中，W为A×R的矩阵，H为R×B的矩阵。步骤3.1.3、将特征矩阵W的第r列与系数矩阵H的第r行相乘，得到WHr；然后，求WHr与|Y|的相关系数其中，结合阈值将相关系数ρr大于λ的各WHr求和得到降噪后的幅值信息矩阵X；其中，进一步，所述的步骤3.2具体如下：步骤3.2.1、计算相角信息矩阵∠Y每一个元素对应位置的局部信噪比其中，相角信息矩阵∠Y是A×B的矩阵；利用θr来限制局部信噪比的大小，这里取θr＝0.1。步骤3.2.2、局部信噪比确定后，估计谱时间稀疏度：其中，表示取最大整数的符号，N＝，可见，谱时间稀疏度s的计算需要用到矩阵元素lsnr同行的左边Iq个点，同列的上面Kq/2个点以及下面Kq/2个点，这里Iq取8，Kq取8。步骤3.2.3、将谱时间稀疏度s通过sigmoid函数q映射到区间，其中，exp代表指数函数，γ用于控制稀疏性，这里取γ＝0.3。步骤3.2.4、确定补偿相位矩阵其中，不随时间变化的反对称函数ψ公式为：步骤3.2.5、将求得的补偿相位矩阵与相角信息矩阵∠Y相加获得补偿后的相位矩阵如图2所示为一组真实胎心音原始数据经重采样和短时傅里叶变换后的信号时频图，其中横坐标为时间，纵坐标为频率；如图3所示为该组真实胎心音原始数据采用本发明降噪后的时频图，可以明显看出噪声信号被抑制。可见，本发明降噪方法对胎心音信号的降噪效果明显。图4、图5和图6为不同的三组模拟胎心音信号采用本发明降噪方法前后的时域波形对比图，且标有处理前后的信噪比数值，可明显看出本发明在胎心音降噪处理上的效果较好。以上所述仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员，在不脱离本发明构思的前提下，还可以做出若干改进和润色，这些改进和润色也应视为本发明保护范围内。
