标题title
一种青贮收获机喂入量控制系统及方法
摘要abst
本发明公开了一种青贮收获机喂入量控制系统及方法，包括喂入量检测单元、植株密度检测单元、车辆状态检测单元、显示器以及控制器；所述喂入量检测单元、植株密度检测单元、车辆状态检测单元和显示器均与控制器信号连接。喂入量检测单元包括扭矩传感器和编码器，植株密度检测单元包括视觉传感器和图像处理模块，车辆状态检测单元包括陀螺仪和加速度计。控制方法包括以下步骤：喂入量检测、种植密度测量、割幅宽度测量和车辆状态检测。本发明以切碎辊的转速和扭矩，种植密度和割幅宽度，以及车速为输入信号，为准确控制喂入量提供依据，降低机手的操作难度，有效提高收割效率。
权利要求书clms
1.一种青贮收获机喂入量控制系统，其特征在于，包括喂入量检测单元、植株密度检测单元、车辆状态检测单元以及控制器；所述喂入量检测单元、植株密度检测单元和车辆状态检测单元均与控制器信号连接；所述喂入量检测单元包括安装在喂入装置切碎辊上的扭矩传感器和编码器，所述扭矩传感器用于测量所述切碎辊的扭矩，所述编码器用于测量所述切碎辊的转速；所述植株密度检测单元包括安装在收获机驾驶室上的视觉传感器和图像处理模块，所述图像处理模块用于处理视觉传感器拍摄的植株照片，检测植株的种植密度；所述车速检测单元包括安装在青贮收获机上的陀螺仪和加速度计，所述陀螺仪和加速度计用于测量收获机的车速和角速度。2.根据权利要求1所述的青贮收获机喂入量控制系统，其特征在于，还包括设于收获机驾驶室内显示器，所述显示器与控制器信号连接，显示器可显示喂入量检测单元、密度检测单元和车辆状态检测单元反馈的信号。3.根据权利要求1所述的青贮收获机喂入量控制系统，其特征在于，所述视觉传感器设于驾驶室的顶部，且位于收获机的中间位置。4.一种青贮收获机喂入量控制方法，其特征在于，使用权利要求1～3任一所述的青贮收获机喂入量控制系统，包括以下步骤：喂入量检测所述扭矩传感器和编码器将检测到的扭矩和转速信号发送至控制器中，根据：P=T×n×2π/60其中：P为功率，单位W；T为扭矩，单位N.m；n为转速，单位rpm；可得出收获机喂入装置的实时工作功率，实时工作功率与喂入装置额定功率的比值即为喂入量系数，喂入量系数等于1时表示满负荷；种植密度测量a.图片拍摄：收获青贮饲料时，视觉传感器首先拍摄一张包含所收物料的图片，然后对图片进行处理，处理方法如下：b.图片处理：首先对图片做增强处理；然后再进行滤波处理，去除图像采集时产生的噪音；最后进行边缘检测，采用canny算子，将图像中植株的边缘提取出来；此时，图片被处理成背景为黑色，植株秸秆边缘为白色的二值化图像；c.株距测量：将b中得到的图片作为模板，与标准模板的第一排植株进行模板匹配，标记出第一排的植株，进而得到第一排植株的间距，即行距；同理可得出某一列中两植株间的距离，即株距；按以下方式计算：单株所占面积:s=xy/4种植密度:n=S/s其中，S为单亩面积；n为种植密度；割幅宽度测量视觉传感器拍摄一张包含所收物料的图片，然后对图片进行处理，处理方法如步骤b，处理后对图片中收获机的割台进行标记；然后再进行一次行距的模板匹配，标记出离割台最近的一排植株，然后以割台长度为割幅总宽度，进一步判断割台前方有多少植株在割台收获范围内，并得到此时最远的两植株间距，进而得到割幅宽度；车辆状态检测加速度计通过测量组件在轴向的受力情况来得到结果，表现形式为轴向的加速度大小和方向，即就是加速度计用于测量物体的线性加速度，加速度计的输出值与倾角呈非线性关系，随着倾角的增加而表现为正弦函数变化；因此，对加速度计的输出进行反正弦处理，可得到倾角值；陀螺仪通过测量自身的旋转状态，判断出设备当前运动状态，即用来测量角速度信号，通过对角速度积分，可得到角度值。
说明书desc
技术领域本发明属于青贮收获机技术领域，具体涉及一种青贮收获机喂入量控制系统及方法。背景技术喂入量是评估青贮收获机作业效率的关键参数，由于不同区域青饲料的长势以及种植密度不同。在收割过程中，机手要根据自身经验调整收获机的转速和行进速度。如果行进速度太慢、转速太高，会造成喂入量不足，无法达到额定作业效率，导致收割效率低下。如果行进速度太快、转速太高，容易使青贮收获机堵塞，造成喂入切碎装置，导致机器受损。发明内容本发明提供了一种青贮收获机喂入量控制系统及方法，目的在于解决现有青贮收获机喂入量难以控制的问题。为此，本发明采用如下技术方案：一种青贮收获机喂入量控制系统，包括喂入量检测单元、植株密度检测单元、车辆状态检测单元以及控制器；所述喂入量检测单元、植株密度检测单元和车辆状态检测单元均与控制器信号连接；所述喂入量检测单元包括安装在喂入装置切碎辊上的扭矩传感器和编码器，所述扭矩传感器用于测量所述切碎辊的扭矩，所述编码器用于测量所述切碎辊的转速；所述植株密度检测单元包括安装在收获机驾驶室上的视觉传感器和图像处理模块，所述图像处理模块用于处理视觉传感器拍摄的植株照片，检测植株的种植密度；所述车速检测单元包括安装在青贮收获机上的陀螺仪和加速度计，所述陀螺仪和加速度计用于测量收获机的车速和角速度。进一步地，还包括设于收获机驾驶室内显示器，所述显示器与控制器信号连接，显示器可显示喂入量检测单元、密度检测单元和车辆状态检测单元反馈的信号。进一步地，所述视觉传感器设于驾驶室的顶部，且位于收获机的中间位置。一种青贮收获机喂入量控制方法，包括以下步骤：喂入量检测所述扭矩传感器和编码器将检测到的扭矩和转速信号发送至控制器中，根据：P=T×n×2π/60其中：P为功率，单位W；T为扭矩，单位N.m；n为转速，单位rpm；可得出收获机喂入装置的实时工作功率，实时工作功率与喂入装置额定功率的比值即为喂入量系数，喂入量系数等于1时表示满负荷；种植密度测量a.图片拍摄：收获青贮饲料时，视觉传感器首先拍摄一张包含所收物料的图片，然后对图片进行处理，处理方法如下：b.图片处理：首先对图片做增强处理；然后再进行滤波处理，去除图像采集时产生的噪音；最后进行边缘检测，采用canny算子，将图像中植株的边缘提取出来；此时，图片被处理成背景为黑色，植株秸秆边缘为白色的二值化图像；c.株距测量：将b中得到的图片作为模板，与标准模板的第一排植株进行模板匹配，标记出第一排的植株，进而得到第一排植株的间距，即行距；同理可得出某一列中两植株间的距离，即株距；按以下方式计算：单株所占面积:s=xy/4种植密度:n=S/s其中，S为单亩面积；n为种植密度；割幅宽度测量视觉传感器拍摄一张包含所收物料的图片，然后对图片进行处理，处理方法如步骤b，处理后对图片中收获机的割台进行标记；然后再进行一次行距的模板匹配，标记出离割台最近的一排植株，然后以割台长度为割幅总宽度，进一步判断割台前方有多少植株在割台收获范围内，并得到此时最远的两植株间距，进而得到割幅宽度。车辆状态检测加速度计通过测量组件在轴向的受力情况来得到结果，表现形式为轴向的加速度大小和方向，即就是加速度计用于测量物体的线性加速度，加速度计的输出值与倾角呈非线性关系，随着倾角的增加而表现为正弦函数变化；因此，对加速度计的输出进行反正弦处理，便可得到其倾角值；陀螺仪通过测量自身的旋转状态，判断出设备当前运动状态，即用来测量角速度信号，通过对角速度积分，便可以得到角度值。本发明的有益效果在于：1.以切碎辊的转速和扭矩，种植密度和割幅宽度，以及车速为输入信号，为准确控制喂入量提供依据，降低机手的操作难度，有效提高收割效率；2.种植密度和割幅宽度自动获取，提高收获机的智能化水平，有助于机手实时掌握收割区域的植株生长状态，方便机手调整收获机状态，为青贮收割提供有力保障；3.使用陀螺仪和加速度计对车速进行测量，数据误差小、精确度高、稳定性好，可减少干扰，保障收获机在环境较恶劣的田间正常工作。附图说明图1是本发明的喂入量的检测流程图。具体实施方式下面结合附图对本发明作进一步说明：如图1所示，一种青贮收获机喂入量控制系统，包括喂入量检测单元、植株密度检测单元、车辆状态检测单元、显示器以及控制器。喂入量检测单元、植株密度检测单元、车辆状态检测单元和显示器均与控制器信号连接。显示器可显示喂入量检测单元、密度检测单元和车辆状态检测单元反馈的信号。喂入量检测单元包括安装在喂入装置切碎辊上的扭矩传感器和编码器，扭矩传感器用于测量所述切碎辊的扭矩，所述编码器用于测量所述切碎辊的转速。植株密度检测单元包括安装在收获机驾驶室顶部的视觉传感器和图像处理模块，图像处理模块用于处理视觉传感器拍摄的植株照片，检测植株的种植密度。车速检测单元包括安装在青贮收获机上的陀螺仪和加速度计，陀螺仪和加速度计用于测量收获机的车速和角速度。一种青贮收获机喂入量控制方法，包括以下步骤：喂入量检测扭矩传感器和编码器将检测到的扭矩和转速信号发送至控制器中，根据：P=T×n×2π/60其中：P为功率，单位W；T为扭矩，单位N.m；n为转速，单位rpm；可得出收获机喂入装置的实时工作功率，实时工作功率与喂入装置额定功率的比值即为喂入量系数。喂入量系数小于1表示未满负荷，喂入量系数等于1时表示满负荷，喂入量系数大于1表示超负荷。种植密度测量a.图片拍摄：收获青贮饲料时，视觉传感器首先拍摄一张包含所收物料的图片，然后对图片进行处理，处理方法如下：b.图片处理：首先对图片做增强处理，采集的图片由于背景复杂，光照环境等原因，使得图像识别困难，严重影响后续图像处理；使用图像增强方式，增强图像中整体或者局部信息。然后再进行滤波处理，采用中值滤波的方法，去除图像采集时产生的噪音；最后进行边缘检测，采用canny算子，将图像中植株的边缘提取出来；此时，图片被处理成背景为黑色，植株秸秆边缘为白色的二值化图像。c.株距测量：将b中得到的图片作为模板，与标准模板的第一排植株进行模板匹配，标记出第一排的植株，进而得到第一排植株的间距，即行距；同理可得出某一列中两植株间的距离，即株距；按以下方式计算：单株所占面积:种植密度:其中，S为单亩面积；n为种植密度；割幅宽度测量视觉传感器拍摄一张包含所收物料的图片，然后对图片进行预处理，处理方法如步骤b，处理后对图片中收获机的割台进行标记。安装在驾驶室顶部的视觉传感器在采集图像后，图像下方区域是割台。因此，直接便可以标记出割台的位置。然后再进行一次行距的模板匹配，标记出离割台最近的一排植株，然后以割台长度为割幅总宽度，进一步判断割台前方有多少植株在割台收获范围内，并得到此时最远的两植株间距，进而得到割幅宽度。车辆状态检测加速度计通过测量组件在某个轴向的受力情况来得到结果，表现形式为轴向的加速度大小和方向，即就是加速度计用于测量物体的线性加速度，加速度计的输出值与倾角呈非线性关系，随着倾角的增加而表现为正弦函数变化。因此，对加速度计的输出进行反正弦处理，便可得到其倾角值。陀螺仪通过测量自身的旋转状态，判断出设备当前运动状态，即用来测量角速度信号，通过对角速度积分，便可以得到角度值。其计算流程如下所述：加速度原始数据归一化处理，得到单位加速度把四元数换算成“方向余弦矩阵”中的第三列的三个元素。根据余弦矩阵和欧拉角的定义，地理坐标系的重力向量，转到机体坐标系，正好是这三个元素。所以这里的vx、vy、vz，就是当前的机体坐标参照系上换算出来的重力单位向量。加速度计由于噪声比较大，在机器运行过程中，受机体振动影响较大，短时间内的可靠性不高。陀螺仪噪声小，但是由于积分是离散的，长时间的积分会出现漂移的情况，因此需要将用加速度计求得的姿态来矫正陀螺仪积分姿态的漂移。在机体坐标参照系上，加速度计测出来的重力向量是ax、ay、az；陀螺积分后的姿态来推算出的重力向量是vx、vy、vz；它们之间的误差向量，就是陀螺积分后的姿态和加速度计测出来的姿态之间的误差。向量间的误差，可以用向量积来表示，ex、ey、ez就是两个重力向量的叉积。这个叉积向量仍旧是位于机体坐标系上的，而陀螺积分误差也是在机体坐标系，而且叉积的大小与陀螺积分误差成正比，正好拿来纠正陀螺。由于陀螺是对机体直接积分，所以对陀螺的纠正量会直接体现在对机体坐标系的纠正。那么误差可以表示为：对此以上误差进行积分：上式中：exInt、eyInt、ezInt为姿态解算误差的积分，初始状态都为0。Ki为控制加速度计修正陀螺仪积分姿态的速度，在编写程序时，可根据实际需求对ki进行赋值，halfT一般取姿态解算时间的一半。用叉乘误差来做PI修正陀螺零偏，通过调节Kp，Ki两个参数，可以控制加速度计修正陀螺仪积分姿态的速度。上式中：gx、gy、gz为三个轴的角速度，单位是弧度/秒。初始值为0，Kp为控制加速度计修正陀螺仪积分姿态的速度，在编写程序时，可根据实际需求对Kp进行赋值。上式中，q0、q1、q2、q3为四元数。四元数单位化：以上便是加速度计和陀螺仪数据融合，计算当前车速及角速度。选择该方式的原因：履带式青贮收获机采用液压驱动，其作业环境恶劣，有时需涉水作业，对底盘的密封要求高，因此，不适合安装编码器等测速传感器。对于GPS等导航信号，若存在遮挡，可能会导致信号延迟，因此，也不适和作为车速检测信号。以切碎辊扭矩、转速、种植密度、割幅宽度和车速作为输入信号，喂入量为输出参数，进行多次试验，喂入量可通过计算得到，得到输入信号与喂入量之间的函数关系。将此函数关系作为控制器判断喂入量的测定方式。其控制流程如下：喂入量的检测主要由三部分组成，分别是切碎辊转速、扭矩测量、图像处理和车速检测组成。在切碎辊转速、扭矩检测部分，编码器和扭矩传感器的数据需进行信号处理，降低因机械结构振动和环境因素所带来的误差。图像处理部分采用视觉传感器，将机器正前方信息采集，通过图像识别的方式，计算得到种植密度和割幅宽度。车速检测部分，通过加速度计和陀螺仪两者传感器数据融合，准确得到当前车速。将传感器检测的数据一一送入控制器中，控制器将该数据代入保存的函数关系，进而得到此时的喂入量。恒定喂入量控制：液压式履带式行走车辆通常采用无极变速控制方式。驾驶员通过控制前进后退档杆的开度，进而控制HST，最终实现履带车辆前进后退。为实现定喂入量控制，在HST的前进后退拨片上安装步进电机。当控制器得到其喂入量与青饲料联合收获机额定喂入量不相符时，控制步进电机调节青饲料联合收获机的前进速度，进而调节喂入量。为了提高其控制精度，采用PID控制完成。控制环节输入信号控制器得到的当前喂入量与额定喂入量的差值，通过计算得到控制步进电机转动的度数，最终实现控制车速，达到恒定喂入量的控制。其控制方式可以表示为：其中u表示步进电机的转动度数，Kp表示比例环节的系数，Ki表示积分环节的系数，Kd表示微分环节的系数。K表示时间。需要说明的是，以上仅是本发明的部分实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明技术原理的前提下，还可以做出若干改进和替换，这些改进和替换也应视为本发明的保护范围。
