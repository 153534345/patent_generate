标题title
基于锁相值构建的脑功能连接网络的情绪分类方法及系统
摘要abst
本发明公开了基于锁相值构建的脑功能连接网络的情绪分类方法及系统，获取待分类的脑电信号和基础情感脑电信号；对待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；基于第一和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；计算二值化脑网络的若干个特征；将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到情绪的分类结果。
权利要求书clms
1.基于锁相值构建的脑功能连接网络的情绪分类方法，其特征是，包括：获取待分类的脑电信号和基础情感脑电信号；对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；计算二值化脑网络的若干个特征；将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到待分类的脑电信号的情绪为积极情绪或消极情绪的分类结果。2.如权利要求1所述的基于锁相值构建的脑功能连接网络的情绪分类方法，其特征是，对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；具体包括：对所述待分类的脑电信号，减去基础情感脑电信号，得到情绪脑电信号。3.如权利要求1所述的基于锁相值构建的脑功能连接网络的情绪分类方法，其特征是，对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；具体包括：对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到Theta、Alpha、Beta1、Beta2、Gamma1和Gamma2这六个频段。4.如权利要求1所述的基于锁相值构建的脑功能连接网络的情绪分类方法，其特征是，采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；具体步骤包括：根据任意两个电极信号的瞬时相位，计算出所述两个电极信号通道之间的相位变化值；根据所述两个电极信号通道之间的相位变化值，计算出脑电信号相位锁相值PLV；将电极作为网络的节点，将任意两个节点进行连接作为网络的边，采用锁相值算法计算脑电信号的某个时间序列内任意两个节点间的权重，也就是任意两个节点之间的脑功能网络连接的边，构建脑功能连接网络。5.如权利要求1所述的基于锁相值构建的脑功能连接网络的情绪分类方法，其特征是，基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；具体包括：首先阈值设置环节，遍历所有被试人员所有试次所有频段所有时段的每个脑功能连接网络；判断脑功能连接网络的每个连接权值是否大与等于阈值，若大于等于则相应的连接权值设为1，否则为0；遍历结束之后得到一个子二值化脑网络；由此循环20次得到20个子二值化脑网络；将所有被试所有试次所有频段所有时段的二值化子二值化脑网络进行平均和重构建，得到二值化脑网络。6.如权利要求1所述的基于锁相值构建的脑功能连接网络的情绪分类方法，其特征是，基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；具体包括：S1：定义数据集为D，所有被试人员为S，遍历循环数据集D内的所有被试人员S；S2：初始化阈值为0.03；S3：遍历所有被试所有试次所有频段所有时段的每个脑功能连接网络；S4：设置每个脑功能连接网络的循环次数i为20；S5：循环六个频带，所述六个频带包括：Theta、Alpha、Beta1、Beta2、Gamma1、Gamma2；S6：循环时间序列t内，基于PLV算法构建脑功能连接网络内的任意两个连接之间的权值；S7：判断第一脑功能连接网络和第二脑功能连接网络内的连接边的权值是否大于等于阈值，如果大于等于阈值，则将这两个节点间的连接权值设为1，即这两个节点之间有连接；否则设为0，即这两个节点之间无连接，得到一个子二值化脑网络；S8：对阈值进行加0.01，产生新的阈值，返回步骤S3，继续循环产生子二值化脑网络；循环N次得到N个子二值化脑网络；每个子二值化脑网络的阈值不同，消除阈值对二值化脑网络产生的影响；N为正整数；S9：直接平均N个子二值化网络，得到最终的二值化脑网络。7.如权利要求1所述的基于锁相值构建的脑功能连接网络的情绪分类方法，其特征是，计算二值化脑网络的若干个特征；具体包括：计算二值化脑网络的五个全局属性特征和两个局部属性特征；五个全局网络属性特征包括：聚类系数、平均最短路径长度、同配系数、全局效率和局部效率，两个局部网络属性特征包括：中间中心度和节点度。8.基于锁相值构建的脑功能连接网络的情绪分类系统，其特征是，包括：获取模块，其被配置为：获取待分类的脑电信号和基础情感脑电信号；对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；预处理模块，其被配置为：对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；脑功能连接网络建立模块，其被配置为：采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；二值化脑网络建立模块，其被配置为：基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；特征提取模块，其被配置为：计算二值化脑网络的若干个特征；分类模块，其被配置为：将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到待分类的脑电信号的情绪为积极情绪或消极情绪的分类结果。9.一种电子设备，其特征是，包括：一个或多个处理器、一个或多个存储器、以及一个或多个计算机程序；其中，处理器与存储器连接，上述一个或多个计算机程序被存储在存储器中，当电子设备运行时，该处理器执行该存储器存储的一个或多个计算机程序，以使电子设备执行上述权利要求1-7任一项所述的方法。10.一种计算机可读存储介质，其特征是，用于存储计算机指令，所述计算机指令被处理器执行时，完成权利要求1-7任一项所述的方法。
说明书desc
技术领域本申请涉及情绪分类技术领域，特别是涉及基于锁相值构建的脑功能连接网络的情绪分类方法及系统。背景技术本部分的陈述仅仅是提到了与本申请相关的背景技术，并不必然构成现有技术。情绪是人类高级的表达方式，随着人工智能的迅速发展，人们对人脑的研究日渐加深，情绪识别是人脑研究的一个重要的领域。当前，大多数情绪分类研究利用脑电图和面部表情识别来进行情绪分类。EEG是记录大脑皮层表面活动的信号，这是大脑神经元突触激活的结果。近年来，已经表明，EEG是用于生物特征认证的合适信号，并且具有重要的功能。因此，基于EEG的情感识别应运而生，即利用EEG进行情感识别进而实现在线疲劳监测、远程教育、心理治疗、医疗诊断等。如今，“脑科学与类脑科学研究”启动在即，探索大脑秘密、攻克大脑疾病为导向的脑科学研究以及以建立和发展人工智能技术为导向的类脑研究是新一轮的科研高地，建立标准统一的脑科学研究数据平台，开展脑科学新技术、新方法研究，探究人脑的脑功能连接网络，从深层次探索人的大脑情绪将是新的研究方向。人脑是自然界中最复杂的系统之一,在这个系统中,多个神经元、神经元集群或者多个脑区相互连接成庞杂的结构网络,并通过相互作用完成脑的各种功能。大脑结构网络上动力学过程的同步化将大脑在广泛的时空尺度上连接形成了动态的复杂功能网络,从而使人脑连接组的研究从大脑结构网络扩展到了大脑功能网络。大脑功能网络是对大脑结构网络之上不同的神经元、神经元集群或脑区之间动态活动交互整合的直观描述。脑功能网络的连接指不同节点记录的神经活动信号之间的动态协调性,这种协调性的定义主要包括功能连接和效应连接两种描述。功能连接是指空间上分离的神经单元其连接网络是指不同节点记录的神经活动信号之间的动态协调性，神经活动在时间上的关联性或统计依赖关系。现有技术中存在以下技术问题：传统的情绪分类方法无法深入的反映大脑区域的动态的网络拓扑和具体的神经机制。人脑是一个大型网络，其功能取决于空间分布区域之间的动态交互。脑电图源连接方法可以实现无创且易于使用的神经成像技术来识别功能性大脑网络，而且可以高时空分辨率评估所识别网络的动态。Khosrowabadi等人采用互信息和幅度平方的相干性作为特征研究8个头皮区域之间的互连性并进行动态情感识别。Dasdemir等人得出信息的同步测度比基于幅度信息的测度对脑电信号的相位变化更加敏感。因此，在这项工作中我们采用了可以捕获非线性相位同步的锁相值来统计大脑整体的脑域变化。将脑电信号分布的头皮层的信号采集，按照10-20系统的电极分布，假设每个电极作为一个节点，计算任意两个电极的之间的相位变化，从而探索大脑功能连接网络的整体和局部的动态脑连接，进一步提取脑功能连接网络特征，从而进行情绪分类，探究深层次的情感源定位。研究发现，脑功能连接网络时，同时发现在整个的大脑功能连接网络中存在不少功能连接强度较弱的连接，这些连接不能帮助脑功能连接特征提取和特征计算，增加了计算复杂性和系统运行的时间。在现阶段的研究中大多采用公开数据集进行脑功能连接网络对情绪识别，现有技术不能摆脱实验对不同被试的依赖性，系统算法存在一定的局限性。发明内容为了解决现有技术的不足，本申请提供了基于锁相值构建的脑功能连接网络的情绪分类方法及系统；，减少弱连接对脑功能连接网络特征提取和特征计算的影响。第一方面，本申请提供了基于锁相值构建的脑功能连接网络的情绪分类方法；基于锁相值构建的脑功能连接网络的情绪分类方法，包括：获取待分类的脑电信号和基础情感脑电信号；对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；计算二值化脑网络的若干个特征；将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到待分类的脑电信号的情绪为积极情绪或消极情绪的分类结果。第二方面，本申请提供了基于锁相值构建的脑功能连接网络的情绪分类系统；基于锁相值构建的脑功能连接网络的情绪分类系统，包括：获取模块，其被配置为：获取待分类的脑电信号和基础情感脑电信号；对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；预处理模块，其被配置为：对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；脑功能连接网络建立模块，其被配置为：采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；二值化脑网络建立模块，其被配置为：基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；特征提取模块，其被配置为：计算二值化脑网络的若干个特征；分类模块，其被配置为：将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到待分类的脑电信号的情绪为积极情绪或消极情绪的分类结果。第三方面，本申请还提供了一种电子设备，包括：一个或多个处理器、一个或多个存储器、以及一个或多个计算机程序；其中，处理器与存储器连接，上述一个或多个计算机程序被存储在存储器中，当电子设备运行时，该处理器执行该存储器存储的一个或多个计算机程序，以使电子设备执行上述第一方面所述的方法。第四方面，本申请还提供了一种计算机可读存储介质，用于存储计算机指令，所述计算机指令被处理器执行时，完成第一方面所述的方法。第五方面，本申请还提供了一种计算机程序，包括计算机程序，所述计算机程序当在一个或多个处理器上运行的时候用于实现前述第一方面任意一项的方法。与现有技术相比，本申请的有益效果是：本系统采取基础情感消去法，在实验开始前，采集被试平静心态情绪下的基础脑电信号，作为实验刺激后脑电信号中去除，实验信号仅为情绪实验刺激后所产生的脑电信号，并在特征提取阶段将原始脑电信号、情绪刺激后的实验信号、平静信号进行情绪分类对比分析，从而验证系统的高效可行。小波包变换脑电信号能够获得更好的频域分辨率，更能捕捉脑电信号的非线性相位，脑功能连接选择法消去除弱连接对脑功能连接网络对脑网络特征提取和计算的不良影响，基础情感消去法能够减弱脑电实验对被试的依赖性，使实验系统更加具有普适性。本公开方法由六部分组成：基础情感消去模块、脑电信号重构模块、脑功能连接网络模块、二值化脑网络模块、脑网络属性特征提取模块、分类识别模块，通过分析发现，部分特征的更适合进行情绪分类研究，情绪刺激的实验信号的情绪分类效果更好，本公开采用基础情感消去法获得情绪后的实验信号，重构并提取脑电信号频带，针对三种信号的六个频带，分别采用PLV算法构建脑功能连接网络，脑功能连接选择算法构建二值化脑网络，计算聚类系数、平均最短路径长度、同配系数、全局效率和局部效率，中间中心度，节点度，通过五种全局特征和两种局部特征衡量整个脑网络构建的信息处理和情绪分类相关的脑网络特征，最后将五种全局特征和两种局部特征输入到分类器中进行分类与预测，进而进行情感状态的识别。本发明附加方面的优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明构成本申请的一部分的说明书附图用来提供对本申请的进一步理解，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。图1为本公开实施例中的基于锁相值的脑功能连接网络构建与情绪分类方法流程图；图2为本公开实施例中的脑电信号电极分布图；图3为本公开实施例中的原始脑电信号示意图；图4为本公开实施例中的基础情感消去后的情绪脑电示意图；图5为本公开实施例中的小波变换处理后的示意图；图6为本公开实施例中的脑功能连接网络示例图。图7为本公开实施例中的二值化脑网络连接矩阵示例图。图8为本公开实施例中的二值化脑网络的七个特征示意图；图9为本公开实施例中的分类结果示意图；图10为本公开实施例中的原始脑电信号、基础情感脑电信号和去除基础情感的情绪脑电信号；图11为本公开实施例中的WPT的小波系数索引和频率表；图12-图12为本公开实施例中的脑功能连接网络示意图；图13为本公开实施例中的脑功能连接网络混淆矩阵示例图；具体实施方式应该指出，以下详细说明都是示例性的，旨在对本申请提供进一步的说明。除非另有指明，本申请使用的所有技术和科学术语具有与本申请所属技术领域的普通技术人员通常理解的相同含义。需要注意的是，这里所使用的术语仅是为了描述具体实施方式，而非意图限制根据本申请的示例性实施方式。如在这里所使用的，除非上下文另外明确指出，否则单数形式也意图包括复数形式，此外，还应当理解的是，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。实施例一本实施例提供了基于锁相值构建的脑功能连接网络的情绪分类方法；如图1所示，基于锁相值构建的脑功能连接网络的情绪分类方法，包括：S101：获取待分类的脑电信号和基础情感脑电信号；对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；S102：对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；S103：采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；S104：基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；S105：计算二值化脑网络的若干个特征；S106：将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到待分类的脑电信号的情绪为积极情绪或消极情绪的分类结果。作为一个或多个实施例，所述S101：获取待分类的脑电信号；具体包括：通过电极采集受试者的待分类的脑电信号；如图3所示；待分类的脑电信号，是受试者接收到情感刺激后，由电极采集到的脑电信号。示例性的，初始化输入原始脑电数据集D，对于数据集D中的原始脑电信号的每个被试脑电信号Si截取实验试次i。示例性的，DEAP，使用的是经过降采样和去眼电处理的MATLAB版本的数据，每个被试有一个.mat文件。DEAP数据集提供的是经过降采样和去眼电的EEG数据，本公开对数据进行了进一步的预处理，数据预处理部分由数据选择、数据分段和基线校正。根据人类的注意力机制，人类情绪的产生需要一定的时间，因此提取24s-43s的数据作为分析数据，即删除前23s和后20s的数据。由于太长的数据可能会影响运行速度和分类性能，所以数据被划分为具有5s时间窗口的数据段，采用没有重叠的方式。因此，每个通道可以提取4段的EEG数据，它们共享一个标签，一个被试可以提取6400段数据。如图2所示，采用基础情感消去法提取前三秒的平静脑电信号，将平静脑电信号扩充至60s，提取4s-63s的原始脑电信号，从中减去60s的平静脑电信号得到去基础情感的情绪刺激后的脑电信号。作为一个或多个实施例，如图10所示，所述S101：对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；具体包括：对所述待分类的脑电信号，减去基础情感脑电信号，得到情绪脑电信号。进一步地，所述基础情感脑电信号，通过提取被试脑电信号前三秒的平静脑电信号，对平静脑电信号进行扩充得到。示例性的，对于每个试次i进行基础情感消去，提取平静脑电信号Sci和实验后的脑电信号Sti，从Sti中减去Sci得到情绪脑电信号Ssi。如图4所示。作为一个或多个实施例，所述S102：对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；具体包括：对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到Theta、Alpha、Beta1、Beta2、Gamma1和Gamma2这六个频段。示例性的，如图5所示，对平静脑电信号Sci和情绪脑电信号Ssi采用小波包分解脑电信号，将脑电信号进行j层小波包分解得到得到2i个小波节点；对第i层节点小波包系数进行重构，得到各节点的重构信号Sj,m，其中，m＝1,2,…,2j,根据小波系数Wi重构脑电信号频带分为Theta、Alpha、Beta1、Beta2、Gamma1、Gamma2。对预处理的EEG信号进行WPT分解重构，得到Theta、Alpha、Beta1、Beta2、Gamma1、Gamma2。本公开使用的是db6小波基小波包分解的具体小波系数如图11所示。情感识别的目标之一就是寻找与情感识别活动最相关的EEG频段，为基于脑电的研究提供良好的EEG特征。通过分析发现，并非所有收集到的频带都对情感识别问题是有效的，脑电信号的不同频带和不同的大脑活动密切相关。作为一个或多个实施例，所述S103：采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；其中，第一脑功能连接网络的建立过程与第二脑功能连接网络的建立过程是一致的。如图6所示。其中，采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；具体步骤包括：根据任意两个电极信号的瞬时相位，计算出所述两个电极信号通道之间的相位变化值；根据所述两个电极信号通道之间的相位变化值，计算出脑电信号相位锁相值PLV；将电极作为网络的节点，将任意两个节点进行连接作为网络的边，采用锁相值算法计算脑电信号的某个时间序列内任意两个节点间的权重，也就是任意两个节点之间的脑功能网络连接的边，构建脑功能连接网络。示例性的，采用锁相值算法计算平静脑电信号Sci和情绪脑电信号Ssi重构后的各频带的脑功能连接网络，假设任意两个电极信号x和y的瞬时相位分别为两个信号通道间的相位变化如下:其中φx和φy是时间序列t下的通道信号x和y的瞬时相位变化。PLV可以计算为：示例性的，对三种脑电信号的六个频带的脑电信号采用PLV算法构建脑功能连接网络。脑电信号分布如图2所示，DEAP数据集包括32导脑电信号，脑电电极是根据国际10-20系统选择32个电极位置，分别为Fp1、AF3、F3、F7、FC5、FC1、C3、T7、CP5、CP1、P3、P7、PO3、O1、Oz、Pz、Fp2、AF4、Fz、F4、F8、FC6、FC、Cz、C4、T8、Cp6、Cp2、P4、P8、PO4、O2。为了构建脑功能连接网络，我们使用32个电极作为网络连接节点，采用采用了可以捕获非线性相位同步的PLV算法来统计大脑整体的脑域变化。假设任意两个通道信号x和y之间存在功能连接，代表在被试受到情绪刺激的t时刻，这两个任意电极间存在信息交互，则这两个电极所在的大脑区域是情感相关的大脑区域。由此，我们引入脑区理论即将人的整个大脑区域根据位置分为大脑区域研究分为八个主要大脑区域左额区、右额区、左颞区、右颞区、左中央区、右中央区、左顶枕区和右顶枕区，从不同脑电信号在不同维度在不同频段这八个大脑区域的脑功能连接网络的连接变化，分析不同情绪下大脑在源定位层次的动态变化。如图12-图12所示，基础情感信号和去基础情感的情绪刺激后的脑电信号，在四个维度高效价高唤醒、高效价低唤醒、低效价高唤醒、低效加低唤醒度这四个维度上在Theta、Alpha、Beta1、Beta2、Gamma1、Gamma2六个频带上的脑功能连接网络的对比示例。图13显示不同强度的脑功能连接混淆矩阵，矩阵值代表两个脑电信号间具有连接且连接强度越高颜色越深。作为一个或多个实施例，所述S104：基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；具体包括：首先阈值设置环节，遍历所有被试人员所有试次所有频段所有时段的每个脑功能连接网络；判断脑功能连接网络的每个连接权值是否大与等于阈值，若大于等于则相应的连接权值设为1，否则为0；遍历结束之后得到一个子二值化脑网络；由此循环20次得到20个子二值化脑网络；将所有被试所有试次所有频段所有时段的二值化子二值化脑网络进行平均和重构建，得到二值化脑网络。作为一个或多个实施例，所述S104：基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；具体包括：S1041：定义数据集为D，所有被试人员为S，遍历循环数据集D内的所有被试人员S；S1042：初始化阈值为0.03；S1043：遍历所有被试所有试次所有频段所有时段的每个脑功能连接网络；S1044：设置每个脑功能连接网络的循环次数i为20；S1045：循环六个频带，所述六个频带包括：Theta、Alpha、Beta1、Beta2、Gamma1、Gamma2；S1046：循环时间序列t内，基于PLV算法构建脑功能连接网络内的任意两个连接之间的权值；S1047：判断第一脑功能连接网络和第二脑功能连接网络内的连接边的权值是否大于等于阈值，如果大于等于阈值，则将这两个节点间的连接权值设为1，即这两个节点之间有连接；否则设为0，即这两个节点之间无连接，得到一个子二值化脑网络；S1048：对阈值进行加0.01，产生新的阈值，返回步骤S1043，继续循环产生子二值化脑网络；循环20次得到20个子二值化脑网络；每个子二值化脑网络的阈值不同，消除阈值对二值化脑网络产生的影响；S1049：直接平均20个子二值化网络，得到最终的二值化脑网络。最后得到每个被试人员、每个实验试次、每个时间序列、每个频带的二值化脑网络。应理解的，针对建立的脑功能连接网络中存在弱连接对脑功能连接网络特征计算和提取存在影响，采用脑功能连接选择法，通过阈值设置和对子二值化脑网络进行循环平均减少小于阈值的弱连接对构建二值化脑网络的影响。循环平均得到每个被试每个试次每个频段每个时段各自的二值化脑网络。脑功能连接网络的阈值，根据经验设置初始值，后循环每次阈值加0.01，设置范围是20次循环，阈值范围是。循环平均是对构建二值化脑网络过程中，针对每个脑功能连接网络进行阈值判断产生的20个子二值化脑网络进行。循环所有被试所有试次所有频段所有时段的每个脑功能连接网络阈值判断产生的20个子二值化脑网络进行直接平均。循环平均得到每个被试每个试次每个频段每个时段各自的二值化脑网络。示例性的，构建二值化脑网络，采用脑功能连接选择法，对于任意两个电极之间的连接权值即PLV值，进行脑功能连接阈值判断，判断两种脑功能网络的连接权值是否大于或等于阈值，从而区分强连接和弱连接，并循环平均得到的所有二值化脑网络，最终得到平均二值化脑网络。将脑功能连接网络任意两个节点间的连接权值也就是PLV值和根据经验选择的阈值和循环产生的阈值进行比较，如果大于等于阈值那么代表该连接权值属于强连接，则将连接权值设置为1，小于阈值就代表是弱连接，连接权值设置为0。在脑功能连接选择算法中，针对每个被试的每个试次的每个频带进行叠加循环产生子二值化脑网络，消除经验阈值设置带来的影响，平均产生的二值化脑网络如图7所示，32个电极组成32*32的连接矩阵有连接为黑色，没有连接为灰色，自身电极默认是有连接。作为一个或多个实施例，如图8所示，所述S105：计算二值化脑网络的若干个特征；具体包括：计算二值化脑网络的五个全局属性特征和两个局部属性特征；五个全局网络属性特征包括：聚类系数、平均最短路径长度、同配系数、全局效率和局部效率，两个局部网络属性特征包括：中间中心度和节点度。本公开考虑到情绪刺激后的脑功能连接网络的信息交互和传递在情绪相关的脑域进行，为了衡量整个脑域的脑功能连接网络和局部脑功能连接网络的信息交互，采用五个全局网络属性特征包括：聚类系数、平均最短路径长度、同配系数、全局效率和局部效率，两个局部网络属性特征包括：中间中心度和节点度。示例性的，聚类系数：聚类系数C表示脑网络中节点也就是电极的聚集程度。计算方法是：计算任意一个节点的连接数，即该节点的全部连接的边。其中Ci表示第i个节点的聚类系数，k代表节点i的连接边。平均最短路径长度：平均最短路径长度衡量脑网络中，任意节点之间的连接能力，平均最短路径长度值越小，代表脑网络的来连接更为紧密，活跃程度更高。计算脑网络中所有节点连接长度的平均值。其中,m，n代表任意两个网络节点，Lmn代表节点m到n的最短路径长度，N代表网路中的节点总数。同配系数:同配P指的是脑网络连接中的节点倾向和自身类似的节点连接。其中，α代表每条边端点的度量值的方差，dm，dn代表边的端点的度量值。全局效率：全局效率用来度量脑网络的整体信息传输能力和连接能力。Lmn代表节点m到n的最短路径长度，N代表网路中的节点总数。局部效率：局部效率是用来衡量局部信息的传输和连接能力。其中N为脑网络节点总数。Eglobal为脑网络的全局效率。中间中心度：中间中心度是任意两个节点m和n的最短路径长度，用来衡量脑网络连接的节点的中心性大小。节点度：节点度是用来衡量脑网络连接中任意一个节点m与其他节点之间的连接性，是一个节点的出度和入度之和。kn＝∑amn作为一个或多个实施例，如图9所示，所述S106：将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到待分类的脑电信号的情绪为积极情绪或消极情绪的分类结果；其中训练后的支持向量机的训练步骤具体包括：构建训练集，所述训练集为已知情绪类别的二值化脑网络特征；基于训练集对支持向量机进行训练，得到训练后的支持向量机。支持向量机被用作生理信号的预测和情绪分类，并且效果良好，因此本申请选择SVM作为分类器。SVM的原理是通过选定的SVM类型和选定的内核函数，将二值化脑网络的属性特征映射到高维的超平面上，寻找超平面将数据进行分类。训练数据用到判别函数，该函数定义为：g＝WTx+b 其超平面定义为：WTx+b＝0其中WT是d维向量，b是标量。以下公式计算出最大边界和最小化误差：其中C是最大边界和最小化误差之间的权值。SVM的内核函数选择的是径向基函数，学习方法是顺序最小优化。RBF通过以下方式计算：K＝exp分类函数为：核函数采用RBF，将实验数据分为70％训练数据和20％的测试数据，进行10倍交叉验证，采用网格搜索算法寻找最优参数c,g,搜索范围。将七个特征送入支持向量机分类器中进行情绪的分类。核函数采用径向基核函数，将实验数据分为70％训练数据和20％的测试数据，进行10倍交叉验证，采用网格搜索算法寻找最优参数c,g，搜索范围。支持向量机是一种监督式学习的方法，广泛地应用于统计分类以及回归分析。它是将特征向量映射到一个更高维的空间里，在这个空间里建立有一个最大间隔超平面。划分数据的超平面的两边建有两个互相平行的超平面，分隔超平面使两个平行超平面的距离最大化。支持向量机的算法思想被广泛应用在情绪分类算法的研究中，尤其是核函数的应用将非线性数据进行分类，本公开根据情绪维度效价维度和唤醒维度的连续值，将大于5的划分为高效价或高唤醒维度，小于等于4的划分为低效价或低唤醒维度。在效价维度和唤醒维度采用支持向量机将实验数据划分为积极情绪和消极情绪。大量的研究表明，支持向量机是情感识别领域比较受欢迎的分类器之一。本公开提出了一种基于锁相值的脑功能连接网络构建与情绪分类方法及系统，包括采用基础情感消去法提取基础情感脑电信号，并将实验开始后的脑电信号消去基础情感脑电信号获得情绪刺激后的实验脑电信号，基础情感消去法能够减弱脑电实验对被试的依赖性，使实验系统更加具有普适性；将原始脑电信号、基础情感脑电信号、基础情感消去的情绪刺激后的实验脑电信号进行采用WPT分解重构为Theta、Alpha、Beta1、Beta2、Gamma1、Gamma2；对三种脑电信号的六个频带的脑电信号采用PLV算法构建脑功能连接网络；采取脑功能连接选择法构建二值化脑网络；计算二值化脑网络的五个全局属性特征和两个局部属性特征；将七个特征送入支持向量机分类器中进行情绪的分类。本公开所提出的方法在受到刺激后适应人脑的全局和局部变化，具有有高效普适价值，取得较好的情感分类效果并且与神经机制的研究相一致。实施例二本实施例提供了基于锁相值构建的脑功能连接网络的情绪分类系统；基于锁相值构建的脑功能连接网络的情绪分类系统，包括：获取模块，其被配置为：获取待分类的脑电信号和基础情感脑电信号；对所述待分类的脑电信号去除基础情感脑电信号，得到情绪脑电信号；预处理模块，其被配置为：对基础情感脑电信号和情绪脑电信号均进行预处理，对预处理后的基础情感脑电信号和预处理后的情绪脑电信号均进行小波变换得到若干个频段；脑功能连接网络建立模块，其被配置为：采用锁相值对基础情感脑电信号的若干个频段，建立第一脑功能连接网络；采用锁相值对情绪脑电信号的若干个频段，建立第二脑功能连接网络；二值化脑网络建立模块，其被配置为：基于第一脑功能连接网络和第二脑功能连接网络，通过阈值设置和循环平均，构建二值化脑网络；特征提取模块，其被配置为：计算二值化脑网络的若干个特征；分类模块，其被配置为：将二值化脑网络的所有特征均输入到训练后的支持向量机中，得到待分类的脑电信号的情绪为积极情绪或消极情绪的分类结果。此处需要说明的是，上述获取模块、预处理模块、脑功能连接网络建立模块、二值化脑网络建立模块、特征提取模块和分类模块对应于实施例一中的步骤S101至S106，上述模块与对应的步骤所实现的示例和应用场景相同，但不限于上述实施例一所公开的内容。需要说明的是，上述模块作为系统的一部分可以在诸如一组计算机可执行指令的计算机系统中执行。上述实施例中对各个实施例的描述各有侧重，某个实施例中没有详述的部分可以参见其他实施例的相关描述。所提出的系统，可以通过其他的方式实现。例如以上所描述的系统实施例仅仅是示意性的，例如上述模块的划分，仅仅为一种逻辑功能划分，实际实现时，可以有另外的划分方式，例如多个模块可以结合或者可以集成到另外一个系统，或一些特征可以忽略，或不执行。实施例三本实施例还提供了一种电子设备，包括：一个或多个处理器、一个或多个存储器、以及一个或多个计算机程序；其中，处理器与存储器连接，上述一个或多个计算机程序被存储在存储器中，当电子设备运行时，该处理器执行该存储器存储的一个或多个计算机程序，以使电子设备执行上述实施例一所述的方法。实施例四本实施例还提供了一种计算机可读存储介质，用于存储计算机指令，所述计算机指令被处理器执行时，完成实施例一所述的方法。以上所述仅为本申请的优选实施例而已，并不用于限制本申请，对于本领域的技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
