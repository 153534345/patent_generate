标题title
一种基于幅值的自动脑电去伪迹方法
摘要abst
本发明公开了一种基于幅值的自动脑电去伪迹方法，其特征在于，包括以下步骤：判断脑电数据长度；根据考虑的频域范围对原始脑电进行带通滤波，去除工频干扰并在一定程度上修正基线漂移；将滤波后的脑电数据分为分段数个等长度的小段，每段数据的时间长度不小于tmin；计算相对均值；计算相对标准差；计算相对均值阈值、相对标准差阈值、通道高阈值和通道低阈值；以上述划分的段为单位进行处理，判断小段上是否存在伪迹。该方法不需要额外通道和人工参与，计算量小，能够快速有效去除rsEEG中的伪迹，从而满足临床分析脑电的要求。
权利要求书clms
1.一种基于幅值的自动脑电去伪迹方法，其特征在于，包括以下步骤：步骤1、判断脑电数据长度：对于通道数行样本点数列的脑电数据，如果样本点数/采样率＜60，即脑电采集时间少于60秒，则生成数据处理报告，退出处理；步骤2、根据考虑的频域范围对原始脑电进行带通滤波，去除工频干扰并在一定程度上修正基线漂移；步骤3、将滤波后的脑电数据分为分段数个等长度的小段，每段数据的时间长度不小于tmin；步骤4、计算相对均值；步骤5、计算相对标准差；步骤6、计算相对均值阈值、相对标准差阈值、通道高阈值和通道低阈值；步骤7、以步骤3中划分的段为单位进行处理，判断小段上是否存在伪迹；步骤8、根据坏导情况对数据进行处理；步骤9、重复步骤7和8直至整个脑电数据处理完毕，生成数据报告。2.根据权利要求1所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述步骤2中的根据考虑的频域范围对原始脑电进行带通滤波，去除工频干扰并在一定程度上修正基线漂移具体为：根据考虑的频域范围确定频域最大值fmax和频域最小值fmin，具体为：关注静息态脑电节律信息时，频带一般选取1-40Hz，即fmax＝40，fmin＝1；利用数字滤波器对原始脑电进行带通滤波；如果频域范围包含50/60Hz工频干扰，利用陷波滤波器去除工频干扰，滤波修正基线漂移。3.根据权利要求1所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述步骤4中的计算相对均值具体为：步骤4.1、计算每个小段上每个通道的均值得到一个通道数行样本点数列的均值矩阵；步骤4.2、如果均值矩阵的所有值都大于绝对均值Ma；则生成数据处理报告，退出处理；否则，对均值矩阵的每一行，从所有小于Ma的数值中求中位数，如果某一行所有数值都不小于Ma，则该行的中位数记为Ma，得到一个通道数维的均值向量；步骤4.3、对得到的均值向量，从所有小于Ma的数值中求中位数记作相对相对均值Mr。4.根据权利要求3所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述绝对均值Ma的取值为4。5.根据权利要求3所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述步骤5中的计算相对标准差具体为：步骤5.1、计算每个小段上每个通道的标准差，得到一个通道数行分段数列的标准差矩阵；步骤5.2、如果标准差矩阵的所有值都大于绝对标准差阈值Sa，则返回错误代码0x002，退出处理；否则，对标准差矩阵的每一行，从所有小于Sa的数值中求中位数，如果某一行所有数值都不小于Sa，则该行的中位数记为Sa，得到一个nchans维的标准差向量；步骤5.3、对得到的标准差向量，从所有小于Sa的数值中求中位数记作相对标准差Sr。6.根据权利要求5所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述的绝对标准差阈值Sa为25。7.根据权利要求5所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述步骤6中的计算相对均值阈值、相对标准差阈值、通道高阈值和通道低阈值，具体为：步骤6.1、相对均值Mr和参数P1的积记为相对均值阈值Trm，该相对均值阈值Trm用于判断基线漂移是否过大；步骤6.2、相对标准差Sr和参数P2的积记为相对标准差阈值Trs，该相对标准差阈值Trs用来判断通道的幅值波动是否过小；步骤6.3、相对均值Mr与相对标准差Sr*参数P3之和记为高通道阈值H_Tc，相对均值Mr与相对标准差Sr*参数P3之差记为低通道阈值L_Tc，这两个阈值用来判断采样点的幅值是否过大。8.根据权利要求7所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述步骤7中的以步骤3中划分的段为单位进行处理，判断小段上是否存在伪迹，具体为：步骤7.1、如果某通道均值大于Trm，则判定该通道漂移太大，标记该通道为坏导；步骤7.2、如果某通道标准差小于Trs，则判定该通道振幅波动太小，标记该通道为坏导；步骤7.3、对任意的采样点，如果其幅值以及其后与之间隔为Np的样本点的幅值都不在区间内，则判定该样本点幅值太大，标记为伪迹点。如果伪迹点占整段数据的比例超过P5，则标记该通道为坏导。9.根据权利要求8所述的基于幅值的自动脑电去伪迹方法，其特征在于，所述步骤8中的根据坏导情况对数据进行处理具体为：步骤8.1、如果不存在坏导，则不进行处理；步骤8.2、如果坏导的数目不大于P4；则认为坏导数在可接受范围内，利用eeglab或者其它脑电处理软件进行插值坏导处理；步骤8.3、如果坏导的数目大于P4，则认为坏导数超出可接受范围，删除整段数据。
说明书desc
技术领域本发明属于脑信号处理的技术领域，具体地说，涉及一种基于幅值的自动脑电去伪迹方法。背景技术由于脑电尤其是头皮处采集到的脑电是一种极其微弱的生理信号，幅值较小，很容易受到各种噪声的干扰，形成脑电脑电伪迹，影响脑电信号的质量。因此，在对脑电信号进行分析以前需要进行预处理，去除脑电信号中的伪迹成分，得到干净的脑电信号。临床上去除脑电伪迹一般是采用滤波加目检的方式，即通过带通滤波器滤除不关心的频率成分，然后通过观察，从整个脑电数据中找出相对平滑的一小段作为代表进行分析。学术研究中使用较多的去伪方法有回归法、独立成分分析法和基于小波变换的滤波方法。回归法假定眼电伪迹是眼电采集通道所采信号的组合，通过回归模型求出眼电成分，然后再将其从采集的脑电信号中删除。ICA是目前研究领域认可度较高的脑电去伪迹方法，它是基于盲源分离技术发展起来的一种新的信号分析方法。ICA以随机变量的相互独立性和非高斯性为目标，在源信号、混合系统均未知的情况下，从给定的多导混合信号中分离出相互独立的源信号。在脑电信号分析中，ICA能够从原始信号中有效分离出眼电、心电等伪迹信号。基于小波变换的去伪迹方法基本思路是首先选取适当的小波函数族，对存在伪迹的信号进行小波分解，将信号分解到不同的子频带上，得到近似系数和细节系数。然后设定适当的阈值对小波系数进行处理，将伪迹对应的高频段和低频段的系数设置为零，保留有用的信号系数，从而达到滤除伪迹的目的。人工目检方法对阅图人员的经验要求较高，主观性强，完成一份脑电处理需要耗费大量的时间，在现实中很难应用。回归法需要额外的眼电采集通道，并且由于脑电和眼电双向混合，回归方法在去除伪迹的同时，也会损失部分真实的脑电信号。利用ICA去伪迹方法中求解解混矩阵是一个优化问题，因此，ICA的计算复杂度较高。常用的ICA去伪处理过程中需要肉眼去识别源信号中分离出的伪迹成分，不适用于脑电信号的自动处理。尽管有些学者提出了一些自动识别伪迹成分的方法，但这种方法仍然需要依赖于操作人员的经验，预定义适当的阈值来识别伪迹信号。基于小波的去伪迹方法同样存在小波基、阈值等选择的问题。另外，基于小波的去伪方法在处理一些频率和正常脑电相近的高幅值伪迹时效果较差。因此，有必要提供一种新的自动脑电去伪迹方法。发明内容有鉴于此，本发明针对静息态脑电数据中存在的体现为幅值异常的各种伪迹，研究一种基于幅值的自动脑电去伪迹方法。该方法不需要额外通道和人工参与，计算量小，能够快速有效去除rsEEG中的伪迹，从而满足临床分析脑电的要求。为了解决上述技术问题，本发明公开了一种基于幅值的自动脑电去伪迹方法，包括以下步骤：步骤1、判断脑电数据长度：对于通道数行样本点数列的脑电数据，如果样本点数/采样率＜60，即脑电采集时间少于60秒，则生成数据处理报告，退出处理；步骤2、根据考虑的频域范围对原始脑电进行带通滤波，去除工频干扰并在一定程度上修正基线漂移；步骤3、将滤波后的脑电数据分为分段数个等长度的小段，每段数据的时间长度不小于tmin；步骤4、计算相对均值；步骤5、计算相对标准差；步骤6、计算相对均值阈值、相对标准差阈值、通道高阈值和通道低阈值；步骤7、以步骤3中划分的段为单位进行处理，判断小段上是否存在伪迹；步骤8、根据坏导情况对数据进行处理；步骤9、重复步骤7和8直至整个脑电数据处理完毕，生成数据报告。可选地，所述步骤2中的根据考虑的频域范围对原始脑电进行带通滤波，去除工频干扰并在一定程度上修正基线漂移具体为：根据考虑的频域范围确定频域最大值fmax和频域最小值fmin，具体为：关注静息态脑电节律信息时，频带一般选取1-40Hz，即fmax＝40，fmin＝1。利用数字滤波器对原始脑电进行带通滤波。如果频域范围包含50/60Hz工频干扰，利用陷波滤波器去除工频干扰，滤波修正基线漂移。可选地，所述步骤4中的计算相对均值具体为：步骤4.1、计算每个小段上每个通道的均值得到一个通道数行样本点数列的均值矩阵；步骤4.2、如果均值矩阵的所有值都大于绝对均值Ma；则生成数据处理报告，退出处理；否则，对均值矩阵的每一行，从所有小于Ma的数值中求中位数，如果某一行所有数值都不小于Ma，则该行的中位数记为Ma，得到一个通道数维的均值向量；步骤4.3、对得到的均值向量，从所有小于Ma的数值中求中位数记作相对相对均值Mr。可选地，所述绝对均值Ma的取值为4。可选地，所述步骤5中的计算相对标准差具体为：步骤5.1、计算每个小段上每个通道的标准差，得到一个通道数行分段数列的标准差矩阵；步骤5.2、如果标准差矩阵的所有值都大于绝对标准差阈值Sa，则返回错误代码0x002，退出处理；否则，对标准差矩阵的每一行，从所有小于Sa的数值中求中位数，如果某一行所有数值都不小于Sa，则该行的中位数记为Sa，得到一个nchans维的标准差向量；步骤5.3、对得到的标准差向量，从所有小于Sa的数值中求中位数记作相对标准差Sr。可选地，所述的绝对标准差阈值Sa为25。可选地，所述步骤6中的计算相对均值阈值、相对标准差阈值、通道高阈值和通道低阈值，具体为：步骤6.1、相对均值Mr和参数P1的积记为相对均值阈值Trm，该相对均值阈值Trm用于判断基线漂移是否过大；步骤6.2、相对标准差Sr和参数P2的积记为相对标准差阈值Trs，该相对标准差阈值Trs用来判断通道的幅值波动是否过小；步骤6.3、相对均值Mr与相对标准差Sr*参数P3之和记为高通道阈值H_Tc，相对均值Mr与相对标准差Sr*参数P3之差记为低通道阈值L_Tc，这两个阈值用来判断采样点的幅值是否过大。可选地，所述步骤7中的以步骤3中划分的段为单位进行处理，判断小段上是否存在伪迹，具体为：步骤7.1、如果某通道均值大于Trm，则判定该通道漂移太大，标记该通道为坏导；步骤7.2、如果某通道标准差小于Trs，则判定该通道振幅波动太小，标记该通道为坏导；步骤7.3、对任意的采样点，如果其幅值以及其后与之间隔为Np的样本点的幅值都不在区间内，则判定该样本点幅值太大，标记为伪迹点。如果伪迹点占整段数据的比例超过P5，则标记该通道为坏导。可选地，所述步骤8中的根据坏导情况对数据进行处理具体为：步骤8.1、如果不存在坏导，则不进行处理。步骤8.2、如果坏导的数目不大于P4；则认为坏导数在可接受范围内，利用eeglab或者其它脑电处理软件进行插值坏导处理；步骤8.3、如果坏导的数目大于P4，则认为坏导数超出可接受范围，删除整段数据。与现有技术相比，本发明可以获得包括以下技术效果：本发明的方法使用的主要运算为求均值、标准差及中位数，其时间复杂度为nlog。因此，该方法具有运算量小，处理速度快的优点。另外，所需阈值通过脑电信号自适应产生，不需要额外通道和人工参与，降低了采集设备的要求，简化了采集流程，提高了脑电处理的自动化水平。当然，实施本发明的任一产品并不一定需要同时达到以上所述的所有技术效果。附图说明此处所说明的附图用来提供对本发明的进一步理解，构成本发明的一部分，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。在附图中：图1是本发明所有通道的伪迹点比例不超过P5，不做处理；图2是本发明幅值过大的伪迹点比例超过P5的通道个数大于P4，删除整段数据；图3是本发明幅值过小的伪迹点比例超过P5的通道个数大于P4，删除整段数据；图4是本发明含有伪迹点比例超过P5的通道个数不大于P4，插值坏导；图5是本发明插值坏导处理后的数据；图6是本发明脑电去伪迹流程图。具体实施方式以下将配合实施例来详细说明本发明的实施方式，藉此对本发明如何应用技术手段来解决技术问题并达成技术功效的实现过程能充分理解并据以实施。本本发明主要用于静息态脑电去伪,相对于任务态脑电来说，静息态脑电数据中眼电成分相对较少，伪迹主要包含工频干扰以及周围环境引入的噪声，伪迹多表现为幅值较正常有明显差别，因此，通过时域分析就能够有效的去除这些伪迹。基于这种情况，我们提出一种用于离线脑电数据处理的自动去伪方法。由于脑电幅值大小受被采集人、脑电采集设备以及采集规范程度等多个因素影响，不同的脑电数据其波幅大小存在差异，因而无法采用相同的阈值进行判断、处理。本方法根据脑电自身的幅值信息自动生成一系列阈值，这些阈值用于判断脑电是否存在伪迹成分，并根据伪迹的影响范围、程度采取不同的处理方式。算法中用到的符号含义及取值如表1所示：表1算法中用到的符号含义及取值注：注：表中nchans，npnts和srate三个参数由具体的脑电数据确定，P1，P2，P3，P5为经验值。为保证插值坏导的质量，计算P4过程中选取的0.3作为乘法因子。如果想要改变约束程度，可以对这些参数做出一些调整。floor为向下取整函数，max为取大函数。本发明公开了一种基于幅值的自动脑电去伪迹方法，如图6所示，包括以下步骤：步骤1、判断脑电数据长度。对于nchans行npnts列的脑电数据，如果npnts/srate＜60,即脑电采集时间少于60秒，则生成数据处理报告，退出处理。步骤2、根据考虑的频域范围确定频域最大值fmax和频域最小值fmin，具体为：关注静息态脑电节律信息时，频带一般选取1-40Hz，即fmax＝40，fmin＝1。利用数字滤波器对原始脑电进行带通滤波。如果频域范围包含50/60Hz工频干扰，利用陷波滤波器去除工频干扰，滤波可以修正基线漂移。步骤3、将滤波后的脑电数据分为epochs个等长度的小段，每段数据的时间长度不小于tmin。步骤4、计算相对均值：步骤4.1、计算每个小段上每个通道的均值得到一个nchans行epochs列的均值矩阵；步骤4.2、如果均值矩阵的所有值都大于绝对均值Ma，则返回错误代码0x001，退出处理。否则，对均值矩阵的每一行，从所有小于Ma的数值中求中位数,如果某一行所有数值都不小于Ma，则该行的中位数记为Ma，得到一个nchans维的均值向量；步骤4.3、对得到的均值向量，从所有小于Ma的数值中求中位数记作相对相对均值Mr。步骤5、计算相对标准差：步骤5.1、计算每个小段上每个通道的标准差得到一个nchans行epochs列的标准差矩阵；步骤5.2、如果标准差矩阵的所有值都大于绝对标准差阈值Sa，则生成数据处理报告，退出处理。否则，对标准差矩阵的每一行，从所有小于Sa的数值中求中位数，如果某一行所有数值都不小于Sa，则该行的中位数记为Sa，得到一个nchans维的标准差向量；步骤5.3、对得到的标准差向量，从所有小于Sa的数值中求中位数记作相对标准差Sr。步骤6、计算相对均值阈值、相对标准差阈值、通道高阈值和通道低阈值。步骤6.1、相对均值Mr和参数P1的积记为相对均值阈值Trm，该相对均值阈值Trm用于判断基线漂移是否过大；步骤6.2、相对标准差Sr和参数P2的积记为相对标准差阈值Trs，该相对标准差阈值Trs用来判断通道的幅值波动是否过小；步骤6.3、相对均值Mr与相对标准差Sr*参数P3之和记为高通道阈值H_Tc，Mr与Sr*P3之差记为低通道阈值L_Tc，高通道阈值H_Tc和低通道阈值L_Tc这两个阈值用来判断采样点的幅值是否过大。步骤7、以步骤3中划分的段为单位进行处理，判断小段上是否存在伪迹：步骤7.1、如果某通道均值大于Trm，则判定该通道漂移太大，标记该通道为坏导；步骤7.2、如果某通道标准差小于Trs，则判定该通道振幅波动太小，标记该通道为坏导；步骤7.3、对任意的采样点，如果其幅值以及其后与之间隔为Np的样本点的幅值都不在区间内，则判定该样本点幅值太大，标记为伪迹点。如果伪迹点占整段数据的比例超过P5，则标记该通道为坏导；步骤8、根据坏导情况对数据进行处理：步骤8.1、如果不存在坏导，则不进行处理，如图1所示，脑电截图为幅值波动较平稳数据，根据本发明判断，所有通道的伪迹点比例均不超过P5，该段数据不存在坏导，无需处理；步骤8.2、如果坏导的数目不大于P4；则认为坏导数在可接受范围内，利用eeglab或者其它脑电处理软件进行插值坏导处理；如图4所示，脑电截图为部分通道存在伪迹数据，根据本发明判断，C3，P3，O1，O2共4个通道的伪迹点比例超过P5，通道个数不大于P4，依具体实施方式中的步骤8.2，该段数据坏导数量在可接受范围内，采用插值坏导处理。步骤8.3、如果坏导的数目大于P4，则认为坏导数超出可接受范围，删除整段数据。如图2所示，脑电截图为幅值波动较大数据，根据本发明方法判断，伪迹点比例超过P5的通道个数为16，通道个数大于P4，依具体实施方式中的步骤8.3，该段数据坏导超出可接受范围，删除整段数据。如图3所示，脑电截图为幅值波动较小数据，根据本发明方法判断，伪迹点比例超过P5的通道个数为16，通道个数大于P4，依具体实施方式中的步骤8.3，该段数据坏导超出可接受范围，删除整段数据。如图5所示，图4所示脑电数据经插值坏导处理后得到的数据，从中不难看出C3，P3，O1，O2等4个通道的波幅经处理后变得相对平稳步骤9、重复步骤7和8直至整个脑电数据处理完毕，生成数据报告。上述说明示出并描述了发明的若干优选实施例，但如前所述，应当理解发明并非局限于本文所披露的形式，不应看作是对其他实施例的排除，而可用于各种其他组合、修改和环境，并能够在本文所述发明构想范围内，通过上述教导或相关领域的技术或知识进行改动。而本领域人员所进行的改动和变化不脱离发明的精神和范围，则都应在发明所附权利要求的保护范围内。
