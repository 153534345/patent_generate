标题title
辅助手术机器人穿刺的呼吸运动预测方法、设备及介质
摘要abst
本发明提供辅助手术机器人穿刺的呼吸运动预测方法、设备及介质，该方法包括步骤：获取采集的人体生理信号；对人体生理信号进行预处理，制作多源数据集；基于FEDformer模型通过预处理后的人体生理信号进行呼吸运动预测，得到目标的位置变化预测结果；根据目标的位置变化预测结果，控制手术机器人机械臂跟随目标的位置变化。针对穿刺手术机器人辅助穿刺下呼吸运动预测算法长时间预测时精度差的问题，本发明搭建了呼吸信号多源信息采集平台，以获取更丰富的呼吸数据，采用基于频域增强的FEDformer模型用于多源信息融合的呼吸运动预测，通过频域增强模块和频域注意力机制提高模型的预测表现。
权利要求书clms
1.一种辅助手术机器人穿刺的呼吸运动预测方法，其特征在于，包括以下步骤：获取采集的人体生理信号；其中，所述人体生理信号包括心电信号、胸部呼吸应变信号、腹部呼吸信号；对所述人体生理信号进行预处理，制作多源数据集；基于FEDformer模型通过预处理后的人体生理信号进行呼吸运动预测，得到目标的位置变化预测结果；根据所述目标的位置变化预测结果，控制手术机器人机械臂跟随目标的位置变化。2.如权利要求1所述的一种辅助手术机器人穿刺的呼吸运动预测方法，其特征在于，还包括以下步骤：通过所述目标的位置变化预测结果设置对应的穿刺阈值来获得最佳穿刺时机。3.如权利要求1所述的一种辅助手术机器人穿刺的呼吸运动预测方法，其特征在于：所述FEDformer模型的训练包括采用滑动窗口划分训练集的数据。4.如权利要求3所述的一种辅助手术机器人穿刺的呼吸运动预测方法，其特征在于：所述采用滑动窗口划分训练集的数据包括采用长度为n+Noutput的窗口沿时间轴方向以1个时间步的间隔进行滑动，每一次滑动获取一条数据，组合起来得到用于模型训练的训练集矩阵；其中，n为输入数据的时间步，Noutput为输出数据的时间步。5.如权利要求1至4任一项所述的一种辅助手术机器人穿刺的呼吸运动预测方法，其特征在于：所述FEDformer模型的训练包括以下步骤：对采集的人体生理信号进行预处理，制作多源数据集；将腹部变化幅度最大的标记点位置列为目标列，将非目标列的信号列为特征学习列；提取出时间列制作为包含时、分、秒、毫秒四个维度的时间标签，对时间标签进行编码；将非时间列的数据列划分为训练集、验证集和测试集，分别进入编码器中；在编码器架构中将输入序列划分为周期项和趋势项；将周期项传入频域增强模块，将原始时域上的输入序列映射到频域，然后在频域上进行随机采样；在特征学习阶段，将序列传入全连接层，作为可学习的参数，最后经由频域补全，投影回时域，进入混合专家分解模块；反复使用混合专家分解模块将序列分解为周期项和趋势项，将周期项交给后续的层进行学习，并最终传给解码器；在解码器中，解码器的输入经过混合专家分解模块将信号分解为周期项和趋势项，周期项传递给后续的层进行学习，通过频域注意力模块对编码器和解码器的周期项进行频域关联性学习；通过全连接层将趋势项进行累加并回给周期项，得到输出序列。6.如权利要求5所述的一种辅助手术机器人穿刺的呼吸运动预测方法，其特征在于：所述对所述人体生理信号进行预处理包括以下步骤：对所述胸部呼吸应变信号和所述心电信号，采用巴特沃斯滤波器进行处理，去除信号中的随机噪声并解决基线漂移问题；对所述腹部呼吸信号中的异常值点和尖锐的峰值，采用四分位法去除异常值，将所有数据按升序排列，计算得到四个四分位数，找到上四分位数和下四分位数，异常值表述为如下公式： ，其中，Q3为上四分位数，Q1为下四分位数，μ为异常系数，X为腹部呼吸信号中的数据，Doutliers为异常值；采用Savitzky-Golay滤波器平滑所述心电信号、胸部呼吸应变信号、腹部呼吸信号，平滑后的数据表述为如下公式： ，其中，x为待拟合的数据，y为拟合后的输出数据，为卷积系数；对所述心电信号、胸部呼吸应变信号、腹部呼吸信号进行重采样操作，使所述心电信号、胸部呼吸应变信号、腹部呼吸信号在相同的时间点上对齐；对所述心电信号、胸部呼吸应变信号、腹部呼吸信号进行归一化处理。7.一种辅助手术机器人穿刺的呼吸信号采集设备，实现如权利要求1所述的方法的人体生理信号采集，其特征在于：包括智能心电可穿戴设备和光学定位系统、若干标记物、基座；其中，所述标记物位于所述智能心电可穿戴设备腹部位置；所述基座用于设置为参考坐标系；所述光学定位系统采集若干标记物相对于光学定位系统坐标系的位置和三维角度，通过光学定位系统坐标系到基座参考坐标系的转化矩阵，将标记物相对于光学定位系统坐标系的位置和三维角度转换为标记点相对于基座参考坐标系的位置和三维角度，得到腹部呼吸信号；在所述光学定位系统采集数据的同时，所述智能心电可穿戴设备采集心电信号、胸部呼吸应变信号。8.如权利要求7所述的一种辅助手术机器人穿刺的呼吸信号采集设备，其特征在于：所述智能心电可穿戴设备内设有位移传感器和心电监护仪，所述位移传感器采集人体胸部在呼吸时上下起伏的信号作为胸部呼吸应变信号，所述心电监护仪采集心电信号。9.如权利要求8所述的一种辅助手术机器人穿刺的呼吸信号采集设备，其特征在于：所述光学定位系统布置在所述智能心电可穿戴设备腹部位置的正上方。10.一种计算机可读存储介质，其特征在于，其上存储有程序指令，所述程序指令被执行时实现如权利要求1所述的方法。
说明书desc
技术领域本发明涉及深度学习技术领域，特别涉及辅助手术机器人穿刺的呼吸运动预测方法、设备及介质。背景技术穿刺手术机器人在癌症诊断和治疗中的广泛应用带来了许多优势，相较于传统手工穿刺，其具备高精度的定位和运动控制能力、长时间的稳定性，并且减少了患者的创伤。然而，患者的呼吸运动会导致胸腔和腹腔内组织或器官的位置相对于外部固定参考点发生位置变化，从而对穿刺手术的精度造成显著影响。呼吸运动信号是一种半周期非平稳信号，其幅度和周期随时间变化且因患者而异。使用实时成像引导是指使用超声或其他实时成像技术，医生可以在呼吸运动期间观察目标位置，然后在合适的时机进行穿刺，可以帮助医生更好地调整穿刺的时机，但受到机器人控制器传递位置数据以及机器人末端执行机构延迟的限制。一般机器人的系统延迟约为300ms以上，而肿瘤的位置随呼吸运动而变化。因此，为了在实时成像引导下实现精准的穿刺手术，有必要进行长时长的呼吸运动预测，以便提前预测肿瘤位置的变化，根据预测数据及时调整机械臂，弥补机器人系统延迟，从而提高穿刺手术的精准性。呼吸运动预测是典型的时间序列预测任务，目前深度学习神经网络是解决此类任务的有效方法。如基于人工神经自适应提升的多层感知机网络、循环神经网络和Transformer模型等。ADMLP-NN对数据集要求高，需要输入数据是平稳序列，在呼吸预测任务中预测准确性较差。循环神经网络基本思想是把时序信息引入网络训练，因此可以更加准确的处理时间序列数据，但RNN网络存在结构一致性约束和弱长期依赖性的限制，当序列长度增加时，预测误差增大并且预测速度下降。Transformer模型可以通过具有残差连接的多头注意力机制捕获呼吸信号中的丰富特征，但Transformer在时域进行预测时模型非常复杂，空间复杂度随输入窗口呈二次增长，计算负担过大且准确率降低，而许多信号在频域上具有稀疏性，引入频域信息可以有效提高Transformer模型的性能。数据集是影响模型预测效果的重要因素，使用单一维度的数据进行预测容易导致过拟合，而使用多维数据预测可以提供更全面和准确的预测。呼吸运动引起胸部和腹部腔体变化，同时呼吸信号和心电信号存在互相作用机制。因此，基于多源信号融合是一种有效方法，充分考虑呼吸运动与其他生理参数之间的复杂关联，从而提高呼吸运动预测的鲁棒性和准确性。基于上述分析，为了满足穿刺手术机器人系统延迟，提高呼吸预测在较长时间任务下的预测精度，急需一种多源信息融合的呼吸运动预测方法。发明内容为了实现本发明的上述目的和其他优点，本发明的第一目的是提供一种辅助手术机器人穿刺的呼吸运动预测方法，包括以下步骤：获取采集的人体生理信号；其中，所述人体生理信号包括心电信号、胸部呼吸应变信号、腹部呼吸信号；对所述人体生理信号进行预处理，制作多源数据集；基于FEDformer模型通过预处理后的人体生理信号进行呼吸运动预测，得到目标的位置变化预测结果；根据所述目标的位置变化预测结果，控制手术机器人机械臂跟随目标的位置变化。进一步地，还包括以下步骤：通过所述目标的位置变化预测结果设置对应的穿刺阈值来获得最佳穿刺时机。进一步地，所述FEDformer模型的训练包括采用滑动窗口划分训练集的数据。进一步地，所述采用滑动窗口划分训练集的数据包括采用长度为n+Noutput的窗口沿时间轴方向以1个时间步的间隔进行滑动，每一次滑动获取一条数据，组合起来得到用于模型训练的训练集矩阵；其中，n为输入数据的时间步，Noutput为输出数据的时间步。进一步地，所述FEDformer模型的训练包括以下步骤：对采集的人体生理信号进行预处理，制作多源数据集；将腹部变化幅度最大的标记点位置列为目标列，将非目标列的信号列为特征学习列；提取出时间列制作为包含时、分、秒、毫秒四个维度的时间标签，对时间标签进行编码；将非时间列的数据列划分为训练集、验证集和测试集，分别进入编码器中；在编码器架构中将输入序列划分为周期项和趋势项；将周期项传入频域增强模块，将原始时域上的输入序列映射到频域，然后在频域上进行随机采样；在特征学习阶段，将序列传入全连接层，作为可学习的参数，最后经由频域补全，投影回时域，进入混合专家分解模块；反复使用混合专家分解模块将序列分解为周期项和趋势项，将周期项交给后续的层进行学习，并最终传给解码器；在解码器中，解码器的输入经过混合专家分解模块将信号分解为周期项和趋势项，周期项传递给后续的层进行学习，通过频域注意力模块对编码器和解码器的周期项进行频域关联性学习；通过全连接层将趋势项进行累加并回给周期项，得到输出序列。进一步地，所述对所述人体生理信号进行预处理包括以下步骤：对所述胸部呼吸应变信号和所述心电信号，采用巴特沃斯滤波器进行处理，去除信号中的随机噪声并解决基线漂移问题；对所述腹部呼吸信号中的异常值点和尖锐的峰值，采用四分位法去除异常值，将所有数据按升序排列，计算得到四个四分位数，找到上四分位数和下四分位数，异常值表述为公式：，其中，Q3为上四分位数，Q1为下四分位数，μ为异常系数，X为腹部呼吸信号中的数据，Doutliers为异常值；采用Savitzky-Golay滤波器平滑所述心电信号、胸部呼吸应变信号、腹部呼吸信号，平滑后的数据如公式： ，其中，x为待拟合的数据，y为拟合后的输出数据，为卷积系数；对所述心电信号、胸部呼吸应变信号、腹部呼吸信号进行重采样操作，使所述心电信号、胸部呼吸应变信号、腹部呼吸信号在相同的时间点上对齐；对所述心电信号、胸部呼吸应变信号、腹部呼吸信号进行归一化处理。本发明的第二目的是提供一种辅助手术机器人穿刺的呼吸信号采集设备，实现上述的方法的人体生理信号采集，包括智能心电可穿戴设备和光学定位系统、若干标记物、基座；其中，所述标记物位于所述智能心电可穿戴设备腹部位置；所述基座用于设置为参考坐标系；所述光学定位系统采集若干标记物相对于光学定位系统坐标系的位置和三维角度，通过光学定位系统坐标系到基座参考坐标系的转化矩阵，将标记物相对于光学定位系统坐标系的位置和三维角度转换为标记点相对于基座参考坐标系的位置和三维角度，得到腹部呼吸信号；在所述光学定位系统采集数据的同时，所述智能心电可穿戴设备采集心电信号、胸部呼吸应变信号。进一步地，所述智能心电可穿戴设备内设有位移传感器和心电监护仪，所述位移传感器采集人体胸部在呼吸时上下起伏的信号作为胸部呼吸应变信号，所述心电监护仪采集心电信号。进一步地，所述光学定位系统布置在所述智能心电可穿戴设备腹部位置的正上方。本发明的第三目的是提供一种计算机可读存储介质，其上存储有程序指令，所述程序指令被执行时实现一种辅助手术机器人穿刺的呼吸运动预测方法。与现有技术相比，本发明的有益效果是：针对穿刺手术机器人辅助穿刺下呼吸运动预测算法长时间预测时精度差的问题，本发明搭建了呼吸信号多源信息采集平台，以获取更丰富的呼吸数据，采用基于频域增强的FEDformer模型用于多源信息融合的呼吸运动预测，通过频域增强模块和频域注意力机制提高模型的预测表现。FEDformer模型在不同呼吸模式的多尺度时间延迟预测中误差都非常小，鲁棒性较好，针对实际应用场景有更好的泛化能力，对提高穿刺手术机器人实时跟踪技术和穿刺精准性具有实际应用价值。上述说明仅是本发明技术方案的概述，为了能够更清楚了解本发明的技术手段，并可依照说明书的内容予以实施，以下以本发明的较佳实施例并配合附图详细说明如后。本发明的具体实施方式由以下实施例及其附图详细给出。附图说明此处所说明的附图用来提供对本发明的进一步理解，构成本申请的一部分，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。在附图中：图1为实施例1的辅助手术机器人穿刺的呼吸信号采集设备示意图；图2为实施例1的光学定位系统实时跟踪标记物三维坐标示意图；图3为实施例1的智能心电可穿戴设备采集心电信号、胸部呼吸应变信号示意图；图4为实施例2的辅助手术机器人穿刺的呼吸运动预测方法流程图；图5为实施例2的辅助手术机器人穿刺的呼吸运动预测方法整体流程图；图6为实施例2的最佳穿刺时机获得流程图；图7为实施例2的FEDformer模型的训练流程图；图8为实施例2的对人体生理信号进行预处理流程图；图9为实施例2的FEDformer模型结构示意图；图10为实施例2的FEDformer模型术中呼吸预测示意图；图11为图10的局部放大图；图12为实施例3的存储介质示意图。图中：1、光学定位系统；2、智能心电可穿戴设备；3、标记物；4、基座。具体实施方式下面，结合附图以及具体实施方式，对本发明做进一步描述，需要说明的是，在不相冲突的前提下，以下描述的各实施例之间或各技术特征之间可以任意组合形成新的实施例。实施例1数据集对深度学习的影响至关重要，深度学习模型的性能很大程度上依赖于用于训练的数据。本实施例提供一种辅助手术机器人穿刺的呼吸信号采集设备，实现呼吸信号多源信息采集，用于制作多源信息融合的呼吸运动数据集。由于呼吸运动会导致胸部和腹部腔体变化，这些变化表现为周期性的膨胀和收缩，同时还与心肺相互作用，呼吸信号和心电信号存在密切的生理联系。呼吸信号多源信息采集平台采集的数据主要包括胸部呼吸应变信号、腹部呼吸信号和心电信号，本发明从这三个方面更全面的跟踪呼吸运动。如图1所示，该设备包括光学定位系统1和智能心电可穿戴设备2、若干标记物3、基座4；其中，标记物位于智能心电可穿戴设备腹部位置；基座用于设置为参考坐标系；光学定位系统采集若干标记物相对于光学定位系统坐标系的位置和三维角度，通过光学定位系统坐标系到基座参考坐标系的转化矩阵，将标记物相对于光学定位系统坐标系的位置和三维角度转换为标记点相对于基座参考坐标系的位置和三维角度，得到腹部呼吸信号，即竖直于地面的世界坐标系下的人体从背部到胸部的坐标变化情况。光学定位系统实时跟踪标记物的三维坐标如图2所示。在光学定位系统采集数据的同时，智能心电可穿戴设备采集心电信号、胸部呼吸应变信号。本实施例中，智能心电可穿戴设备内设有位移传感器和心电监护仪，位移传感器采集人体胸部在呼吸时上下起伏的信号作为胸部呼吸应变信号，心电监护仪采集心电信号。智能心电可穿戴设备采集的心电信号、胸部呼吸应变信号如图3所示。本实施例中，智能心电可穿戴设备可以采用智能心电T恤。如图1所示，为了最大程度模拟穿刺手术操作场景，志愿者身穿智能心电T恤仰卧在实验床上，将光学定位系统布置在人体腹部正上方，也就是，光学定位系统布置在智能心电可穿戴设备腹部位置的正上方。同时基座也被放置在实验床上，在智能心电T恤腹部位置放置6个标记物，光学定位系统采用俯视角度获取最佳采集视野，光学定位系统记录6个标记物相对于基座参考坐标系的位置坐标，采样频率为60Hz。智能心电T恤可以同时记录心电信号、胸部呼吸应变信号、皮电活动等人体各种生理信号，本实施例中智能心电T恤记录胸部呼吸应变信号和三导联的心电信号，其采样频率分别为50Hz和250Hz。为了满足穿刺手术机器人系统延迟，提高呼吸预测在较长时间任务下的预测精度，本实施例搭建了呼吸信号多源信息采集平台，后续采用频域增强的Transformer模型-FEDformer模型，设计多源信息融合的呼吸运动预测方法，对提高穿刺手术机器人实时跟踪技术和穿刺精度具有实际应用价值。关于方法的详细描述，可以参照下述方法实施例中的对应描述，在此不再赘述。实施例2一种辅助手术机器人穿刺的呼吸运动预测方法，采用实施例1提供的辅助手术机器人穿刺的呼吸信号采集设备采集的呼吸信号多源信息制作多源信息融合的呼吸运动数据集。如图4、图5所示，该方法包括以下步骤：S1、获取采集的人体生理信号；其中，人体生理信号包括心电信号、胸部呼吸应变信号、腹部呼吸信号；S2、对人体生理信号进行预处理，制作多源数据集；为了减少采集环境和传感器中随机噪声对信号的影响，在保持原始信号周期性和形状的前提下进行数据预处理。数据预处理包括降噪、平滑、重采样、规范化。如图8所示，对人体生理信号进行预处理包括以下步骤：S21、对胸部呼吸应变信号和三导联的心电信号，采用一阶巴特沃斯滤波器进行处理，以有效去除这两种信号中的随机噪声并解决基线漂移问题。S22、对腹部呼吸信号中的一些异常值点和尖锐的峰值，采用四分位法去除异常值，将所有数据按升序排列，计算得到四个四分位数，找到上四分位数和下四分位数，异常值表述为公式： ，其中，Q3为上四分位数，Q1为下四分位数，μ为异常系数，可以根据经验值设置为1.5，X为腹部呼吸信号中的数据，Doutliers为异常值；S23、采用Savitzky-Golay滤波器平滑心电信号、胸部呼吸应变信号、腹部呼吸信号，该滤波器是在给定的窗口内，使用最小二乘法进行多项式拟合，能够有效平滑信号并一定程度上降低高频噪声的干扰，同时保留呼吸信号的趋势和特征，平滑后的数据如公式： ，其中，x为待拟合的数据，y为拟合后的输出数据，为卷积系数；S24、对心电信号、胸部呼吸应变信号、腹部呼吸信号进行重采样操作，使心电信号、胸部呼吸应变信号、腹部呼吸信号在相同的时间点上对齐；本实施例中，三种数据的采样频率分别为60Hz、50Hz和250Hz，使用MATLAB的resample函数都转换为50Hz的采样频率，即每一个时间步为20ms，方便后续模型训练和分析。S25、对心电信号、胸部呼吸应变信号、腹部呼吸信号进行归一化处理。归一化处理是指将数据转化到同一个量纲和某一个指定大小的范围内，如0到1或-1到1之间。在神经网络训练过程中，归一化可以消除不同指标之间的量纲影响，减少计算负担和训练时间，加快训练模型收敛。本实施例采用的是Z-Score标准化，其转化函数如公式： ，其中，mean为原始数据的均值，std为原始数据的标准差。为了实现从n个时间步的输入数据预测Noutput个时间步的输出数据，本实施例采用了滑动窗口来划分训练集的数据，长度为n+Noutput的窗口沿时间轴方向以1个时间步的间隔进行滑动，每一次滑动获取一条数据，组合起来得到用于模型训练的训练集矩阵。这种滑动窗口的方法有助于构建输入和输出序列之间的关联关系，以便模型能够学习时间序列数据的特征和模式，从而实现对未来Noutput个时间步的预测。傅里叶变换和傅里叶逆变换可以将信号在时域和频域之间相互转换，一般信号在频域上具有稀疏性，即信号的重要信息主要集中在少数频率成分上，通过保留这些重要的频域成分来提取关键特征，从而降低数据复杂度提高模型的预测精度。如图9所示，本实施例采用频域增强的FEDformer模型进行多尺度时间延迟窗下的呼吸运动预测，将训练好的模型和数据保存，以备后续穿刺手术时调用进行实时预测辅助穿刺。FEDformer模型最大的不同就是在频域表征学习，通过频域增强模块和频域注意力机制实现更精准的呼吸运动预测。FEDformer模型的主体架构与Transformer模型类似，采用编码-解码器架构，主要包括频域增强模块、频域注意力模块、混合专家分解模块、前向传播模块。在长时间序列预测任务中，编码器架构的输入序列首先传递给频域增强模块，频域增强模块完成频域上表征学习的任务。首先将原始时域上的输入序列被映射到频域，然后在频域上进行随机采样，可以有效降低输入向量的长度和计算复杂度。在特征学习阶段，将序列传入全连接层，作为可学习的参数，最后经由频域补全，投影回时域，进入下一步混合专家分解模块。为了降低输入输出的分布差异，混合专家分解模块将序列分解为周期项和趋势项，其中trend分量被舍弃，seasonal分量交给接下来的层进行学习，并最终传给解码器。在解码器中，解码器的输入同样经过三个混合专家分解模块层，每层将信号分解为seasonal和trend分量，seasonal分量传递给接下来的层进行学习，通过频域注意力模块对编码器和解码器的seasonal项进行频域关联性学习，其流程与频域增强模块类似：频域投影—频域采样—特征学习—频域补全—投影回时域。频域注意力模块会更加关注编码器和解码器的seasonal的相互关联，以便更好地学习两部分信号的内在联系。最终，通过全连接层将trend分量进行累加最终回给seasonal项，从而得到输出序列，输出序列与标签值进行损失函数计算，损失函数采用均方根误差。具体的，如图7所示，FEDformer模型的训练包括以下步骤：为了实现基于FEDformer模型的多源信号融合的呼吸运动预测，S31、对采集的人体生理信号进行预处理，制作多源数据集。S32、将腹部变化幅度最大的标记点位置列为目标列，将其余信号列为特征学习列；S33、首先划分数据集，先提取出时间列制作为一个包含时、分、秒、毫秒四个维度的时间标签，对时间标签进行编码；S34、将其余的数据列划分为训练集、验证集和测试集，分别进入编码器中；S35、在编码器架构中将输入序列首先划分为周期项和趋势项；趋势项表征的是数据整体变化的水平，先分解出来，不需要进行特征学习。S36、将周期项传入频域增强模块，频域增强模块完成频域上表征学习的任务。首先将原始时域上的输入序列映射到频域，然后在频域上进行随机采样，可以有效降低输入向量的长度和计算复杂度。S37、在特征学习阶段，将序列传入全连接层，作为可学习的参数，最后经由频域补全，投影回时域，进入下一步混合专家分解模块；为了降低输入输出的分布差异，S38、反复使用混合专家分解模块将序列分解为周期项和趋势项，其中trend分量被舍弃，seasonal分量交给接下来的层进行学习，并最终传给解码器。S39、在解码器中，解码器的输入经过混合专家分解模块将信号分解为周期项和趋势项，周期项传递给后续的层进行学习，通过频域注意力模块对编码器和解码器的周期项进行频域关联性学习；S310、通过全连接层将趋势项进行累加并回给周期项，得到输出序列。S3、基于FEDformer模型通过预处理后的人体生理信号进行呼吸运动预测，得到目标的位置变化预测结果；呼吸运动预测结果如图10所示。通过呼吸信号多源信息采集平台获得的呼吸信号可以有效追踪肿瘤的准周期性运动，外部呼吸与肿瘤运动有很强的相关性，FEDformer模型可以精准有效的预测肿瘤位置变化。本实施例设置闭环控制的机械臂跟随控制算法，实现机械臂末端跟随肿瘤位置变化。即，S4、根据肿瘤位置变化预测结果，控制手术机器人机械臂跟随目标的位置变化。同时，为了适应不同的人群，在穿刺时机的选择上，可以设置医生可调的穿刺阈值d来控制，通过对患者波形变化幅度及频率的评估，可以设置不同的穿刺阈值d来获得最佳穿刺时机。如图6所示，还包括以下步骤：S5、通过目标的位置变化预测结果设置对应的穿刺阈值d来获得最佳穿刺时机，最佳穿刺时机如图11所示。为了在实时成像引导下实现精准的穿刺手术，本发明提供了辅助手术机器人穿刺的呼吸运动预测方法进行长时长的呼吸运动预测，以便提前预测肿瘤位置的变化，根据预测数据及时调整机械臂，弥补机器人系统延迟，从而提高穿刺手术的精准性。为了满足穿刺手术机器人系统延迟，提高呼吸预测在较长时间任务下的预测精度，本发明搭建了呼吸信号多源信息采集平台，采用频域增强的Transformer模型-FEDformer模型，设计多源信息融合的呼吸运动预测方法，对提高穿刺手术机器人实时跟踪技术和穿刺精度具有实际应用价值。实施例3一种计算机可读存储介质，如图12所示，其上存储有程序指令，程序指令被执行时实现一种辅助手术机器人穿刺的呼吸运动预测方法。关于方法的详细描述，可以参照上述方法实施例中的对应描述，在此不再赘述。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括要素的过程、方法、商品或者设备中还存在另外的相同要素。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上仅为本说明书实施例而已，并不用于限制本说明书一个或多个实施例。对于本领域技术人员来说，本说明书一个或多个实施例可以有各种更改和变换。凡在本说明书一个或多个实施例的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本说明书一个或多个实施例的权利要求范围之内。
