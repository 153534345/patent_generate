标题title
基于因果分析的心电图ST段异常判别系统
摘要abst
本发明提供了一种基于因果分析的心电图ST段异常判别系统，包括：提取心外体征因素数据并进行预处理，基于预处理后的心外体征因素数据生成数据变量间的加权邻接矩阵，加权邻接矩阵提取非零权值生成贝叶斯网络G0；计算贝叶斯网络G0各路径的因果效应估计量，基于因果效应估计量调整网络结构生成因果网络G1；从心电图中提取12导联数据，并对12导联数据进行预处理，得到预处理后的12导联数据；基于12导联数据获取10维心电特征；对预处理后的12导联数据和10维心电特征进行预处理，并通过卷积残差神经网络提取深度特征；将深度特征与因果机制变量数据进行结合，并输入决策树得到心电图中出现心电特征st段异常的预测概率。
权利要求书clms
1.一种基于因果分析的心电图ST段异常判别系统，其特征在于，包括：贝叶斯网络生成模块：提取心外体征因素数据并进行预处理，得到预处理后的心外体征因素数据，基于预处理后的心外体征因素数据生成数据变量间的加权邻接矩阵，加权邻接矩阵提取非零权值生成贝叶斯网络G0，建立心电图st段异常与心外体征因素数据之间的因果联系机制；有向调整模块：计算贝叶斯网络G0各路径的因果效应估计量，基于因果效应估计量调整网络结构生成因果网络G1，按照预设要求筛选出预设个与心电图st段异常相关的因果机制变量；心电图信号处理模块：从心电图中提取12导联数据，并对12导联数据进行预处理，得到预处理后的12导联数据；基于预处理后的12导联数据获取10维心电特征；判别模块：对预处理后的12导联数据和10维心电特征进行预处理，并通过卷积残差神经网络提取深度特征；将深度特征与因果机制变量数据进行结合，并输入决策树得到心电图中出现心电特征st段异常的预测概率。2.根据权利要求1所述的基于因果分析的心电图ST段异常判别系统，其特征在于，在所述贝叶斯网络生成模块中，模块M1.1：提取心外体征因素数据，并对提取出的心外体征因素数据进行离散化处理，得到离散化处理后的心外体征因素数据；模块M1.2：将离散化处理后的心外体征因素数据使用NOTEARS结构学习算法和K2评分算法生成数据变量间的加权邻接矩阵；模块M1.3：加权邻接矩阵通过硬阈值规则将矩阵权值进行二级化处理，提取非零权值，生成贝叶斯网络G0。3.根据权利要求1所述的基于因果分析的心电图ST段异常判别系统，其特征在于，所述模块M1.3采用：加权邻接矩阵通过硬阈值ω＝0.1将矩阵权值进行二级化处理，提取非零权值，生成贝叶斯网络G0。4.根据权利要求1所述的基于因果分析的心电图ST段异常判别系统，其特征在于，在所述有向调整模块中，模块M2.1：采用前门调整公式和后门调整公式计算贝叶斯网络G0各路径的因果效应估计量；模块M2.2：基于因果效应估计量使用do运算进行干预操作，调整网络结构，生成因果网络G1。5.根据权利要求4所述的基于因果分析的心电图ST段异常判别系统，其特征在于，在所述模块M2.1中，采用前门调整公式、后门调整公式和有向分离法则推断包括吸烟、饮酒以及运动变量与st段异常之间的不同因果关系。6.根据权利要求1所述的基于因果分析的心电图ST段异常判别系统，其特征在于，在所述心电图信号处理模块中，模块M3.1：从心电图机产生的XML文件提取12导联序列数据；模块M3.2：12导联序列数据使用symlets4小波对心电信号进行7层分解去噪处理，得到去噪后的12导联序列数据；模块M3.3：基于去噪后的12导联序列数据寻找心电序列数据中R波的位置，并以R波为基准进行心拍分割，获得10维心电特征。7.根据权利要求1所述的基于因果分析的心电图ST段异常判别系统，其特征在于，在所述判别模块中，模块M4.1：对去噪后的12导联序列数据和10维心电特征进行平移和缩放的数据增强处理，得到处理后的数据；模块M4.2：处理后的数据利用ResneXt50+SE深度残差深度神经网络提取深度特征；模块M4.3：将深度特征与因果机制变量数据进行结合，输入训练好的xgBoost树模型，得到心电图中出现心电特征st段异常的预测概率。8.根据权利要求7所述的基于因果分析的心电图ST段异常判别系统，其特征在于，所述ResneXt50+SE卷积残差深度神经网络采用：处理后的数据进入ResneXt50+SE深度残差深度神经网络，经过一个1维卷积层和最大池化层后，进入重复预设数量的瓶颈层，最后经过全局池化层和全局最大池化层转化为一维数据后，经过全连接层和Softmax函数层得到三维预测值。9.根据权利要求8所述的基于因果分析的心电图ST段异常判别系统，其特征在于，在所述瓶颈层中：使用卷积核为1的变换维度操作改变数据维度，然后使用分组卷积，最后使用核为1的变换维度的操作得到相应尺寸的数据。10.根据权利要求9所述的基于因果分析的心电图ST段异常判别系统，其特征在于，所述瓶颈层还包括：通过SE模块学习channel之间的相关性，提高ResneXt50+SE卷积残差深度神经网络的准确率。
说明书desc
技术领域本发明涉及人工智能技术领域，具体地，涉及基于因果分析的心电图ST段异常判别系统，更为具体地，涉及一种通过因果分析+树形分类器判断心电图是否有ST段异常以及异常类型的判别系统。背景技术冠状动脉粥样硬化性心脏病，简称为冠心病，是指由于冠状动脉粥样硬化、冠状动脉狭窄引起的缺血、缺氧性心脏病，心律失常是其常见并发症。冠心病是引起老年人的重要死因之一，发病率和年龄成正比例关系。临床上常表现为心绞痛、心肌梗死等状况，更有甚者因心律失常、心力衰竭而死亡。目前诊断冠心病的金标准是冠状动脉造影，但因其成本高且具有一定的风险，因此无法普及。目前利用十二导联心电图检测冠心病是十分重要的辅助检查手段，目前心电图筛查主要是通过医生观察心电图然后给出心电图相关的诊断，然后根据诊断判断是否可能患有冠心病。心电图各波及波段的组成依次为P波、PR间期、QRS波群、J点、ST段、T波、U波、QT间期。冠心病主要分为慢性的心肌缺血和急性的心肌缺血，慢性的心肌缺血主要表现为ST段的抬高、ST段的压低、T波的低平、T波的倒置，而急性的心肌缺血最主要的表现是ST段的抬高、病理性Q波、T波的倒置或者明显的高尖。ST段代表心室肌全部除极完成复极尚未开始的一段时间。此时各部位的心室肌都处于除极状态，细胞之间并没有电位差，因此正常情况下ST段应处于等电位线上。当某部位的心肌出现缺血或坏死的表现，心室在除极完毕后仍存在电位差，此时表现为心电图上ST段发生偏移。之后的T波代表了心室的复极，在QRS波主波向上的导联，T波应与QRS主波方向相同。心电图上T波的改变受多种因素的影响。Q波是室间隔除极产生右前方的向量形成的，正常情况下，时限不超过0.03s，深度不会超过同导联R波的1/4。然而目前进行的心电图研究大部分使用的是国际上公认的心率失常标准数据库，包含美国麻省理工学院提供的MIT-BIH数据库、美国心脏学会提供的AHA数据库、欧共体CSE数据库，集中在心率失常分类上，相对来说，心肌缺血和心肌梗死研究较少，主要是数据较难获取。但心肌缺血与心梗发病率很高，其代表疾病冠心病更是致死率极高的疾病，有很高的研究价值。且我们现阶段研制的人工智能严格意义上只能被称为弱人工智能，难以应用于医疗等高风险领域。其中大部分都是因为神经网络缺乏可解释性、潜在的不稳定性以及黑箱问题。深度学习是基于相关性的统计模型容易学习到数据中的“伪关系”，而非因果关系，从而降低了泛化能力和对抗攻击的能力。例如在医疗领域，看似非常精确的用于肺炎患者预后的系统，非常依赖数据集中的虚假相关性。深度学习模型系统预测有哮喘病史的病人死于肺炎的风险较低，但这是因为哮喘病人得到了更快、更好的关注，才导致他们的死亡率更低。冠心病发病率、致死率高，患者十二心电图上常会表现为ST-T段改变，病理性Q波，目前主要依靠医生识别出心电图相关异常，筛选出可能患有冠心病的病人。但是在不发达地区，限于医疗水平，可能误判或者漏判。心电图机也会给出心电图诊断结果，但是限于心电数据的复杂性，心电图机诊断结果准确性较低。近年也有不少研究者将深度学习技术应用于心电图诊断。专利文献CN112006678A公开了一种基于AlexNet和迁移学习相结合的心电图异常识别方法及系统，属于特征提取分类预测技术领域，本发明要解决的技术问题为如何结合AlexNet深度卷积神经网络和迁移学习准确高效的完成心电图异常识别，既能摆脱对样本数据容量的依赖，又能自动学习数据样本的特征，技术方案为：该方法具体如下：预处理：将数据集中的每条心电图信号转换成心电图图像，并对异常类型的心电图进行不同方位的裁剪；特征提取：把数据增强后的图像放入预训练的模型中进行训练，预训练后的心电图图像作为AlexNet模型的输入，自动提取特征，并利用ImageNet数据集预训练的AlexNet模型进行迁移学习；分类预测：把预训练的AlexNet深度卷积神经网络模型得到的高特征放入支持向量机中进行心电图分类。发明内容针对现有技术中的缺陷，本发明的目的是提供一种基于因果分析的心电图ST段异常判别系统。根据本发明提供的一种基于因果分析的心电图ST段异常判别系统，包括：贝叶斯网络生成模块：提取心外体征因素数据并进行预处理，得到预处理后的心外体征因素数据，基于预处理后的心外体征因素数据生成数据变量间的加权邻接矩阵，加权邻接矩阵提取非零权值生成贝叶斯网络G0，建立心电图st段异常与心外体征因素数据之间的因果联系机制；有向调整模块：计算贝叶斯网络G0各路径的因果效应估计量，基于因果效应估计量调整网络结构生成因果网络G1，按照预设要求筛选出预设个与心电图st段异常相关的因果机制变量；心电图信号处理模块：从心电图中提取12导联数据，并对12导联数据进行预处理，得到预处理后的12导联数据；基于预处理后的12导联数据获取10维心电特征；判别模块：对预处理后的12导联数据和10维心电特征进行预处理，并通过卷积残差神经网络提取深度特征；将深度特征与因果机制变量数据进行结合，并输入决策树得到心电图中出现心电特征st段异常的预测概率。优选地，在所述贝叶斯网络生成模块中，模块M1.1：提取心外体征因素数据，并对提取出的心外体征因素数据进行离散化处理，得到离散化处理后的心外体征因素数据；模块M1.2：将离散化处理后的心外体征因素数据使用NOTEARS结构学习算法和K2评分算法生成数据变量间的加权邻接矩阵；模块M1.3：加权邻接矩阵通过硬阈值规则将矩阵权值进行二级化处理，提取非零权值，生成贝叶斯网络G0。优选地，所述模块M1.3采用：加权邻接矩阵通过硬阈值ω＝0.1将矩阵权值进行二级化处理，提取非零权值，生成贝叶斯网络G0。优选地，在所述有向调整模块中，模块M2.1：采用前门调整公式和后门调整公式计算贝叶斯网络G0各路径的因果效应估计量；模块M2.2：基于因果效应估计量使用do运算进行干预操作，调整网络结构，生成因果网络G1。优选地，在所述模块M2.1中，采用前门调整公式、后门调整公式和有向分离法则推断包括吸烟、饮酒以及运动变量与st段异常之间的不同因果关系。优选地，在所述心电图信号处理模块中，模块M3.1：从心电图机产生的XML文件提取12导联序列数据；模块M3.2：12导联序列数据使用symlets4小波对心电信号进行7层分解去噪处理，得到去噪后的12导联序列数据；模块M3.3：基于去噪后的12导联序列数据寻找心电序列数据中R波的位置，并以R波为基准进行心拍分割，获得10维心电特征。优选地，在所述判别模块中，模块M4.1：对去噪后的12导联序列数据和10维心电特征进行平移和缩放的数据增强处理，得到处理后的数据；模块M4.2：处理后的数据利用ResneXt50+SE深度残差深度神经网络提取深度特征；模块M4.3：将深度特征与因果机制变量数据进行结合，输入训练好的xgBoost树模型，得到心电图中出现心电特征st段异常的预测概率。优选地，所述ResneXt50+SE卷积残差深度神经网络采用：处理后的数据进入ResneXt50+SE深度残差深度神经网络，经过一个1维卷积层和最大池化层后，进入重复预设数量的瓶颈层，最后经过全局池化层和全局最大池化层转化为一维数据后，经过全连接层和Softmax函数层得到三维预测值。优选地，在所述瓶颈层中：使用卷积核为1的变换维度操作改变数据维度，然后使用分组卷积，最后使用核为1的变换维度的操作得到相应尺寸的数据。优选地，所述瓶颈层还包括：通过SE模块学习channel之间的相关性，提高ResneXt50+SE卷积残差深度神经网络的准确率。与现有技术相比，本发明具有如下的有益效果：1、本发明安装使用成本低，能够自动筛查，准确性相对心电图机的诊断更高。可以供医生使用，减少误判或者漏判，降低医生工作量；2、并且相比其它深度网络心电研究，本发明结合了因果推断可以较好的提高模型的可解释性，并且易于将其它有益的特征也加入诊断该系统，扩展性好；3、本发明使用方法简单，可以的有效分析st段异常和心外因素之间的因果联系机制，提高模型在st段异常分类中的预测性能，可以快速给出筛查者心电图st段是否异常的诊断。附图说明通过阅读参照以下附图对非限制性实施例所作的详细描述，本发明的其它特征、目的和优点将会变得更明显：图1为基于因果分析的心电图ST段异常判别系统示意图。图2为因果机制的心外因素筛选流程。图3为ResneXt50+XGBoost网络的结构图。具体实施方式下面结合具体实施例对本发明进行详细说明。以下实施例将有助于本领域的技术人员进一步理解本发明，但不以任何形式限制本发明。应当指出的是，对本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变化和改进。这些都属于本发明的保护范围。实施例1根据本发明提供的一种基于因果分析的心电图ST段异常判别系统，如图1至3所示，包括：贝叶斯网络生成模块：提取心外体征因素数据并进行预处理，得到预处理后的心外体征因素数据，基于预处理后的心外体征因素数据生成数据变量间的加权邻接矩阵，加权邻接矩阵提取非零权值生成贝叶斯网络G0，建立心电图st段异常与心外体征因素数据之间的因果联系机制；其中，本发明使用大量临床心电图数据包括原始xml文件、医生对心电图的临床诊断结果以及受访者其他体征数据，基于先验知识从原始体征数据中筛选出了十个变量，将数据准备好了之后，分别使用NOTEARS结构学习算法和K2评分算法生成数据变量间的加权邻接矩阵，采取将邻接矩阵通过硬阈值ω＝0.1的方式二级化矩阵权值，得到初步因果网络模型，建立心电图ST段异常与体征变量之间的因果联系机制。所述心外体征因素数据包括心内因素和心外因素；所述心内因素通常包括窦房功能受损以及急性心肌受损；所述心外因素大致可以归为增龄以及迷走神经兴奋一类如深呼吸、运动等。而本发明主要涉及到的是心外因素。有向调整模块：计算贝叶斯网络G0各路径的因果效应估计量，基于因果效应估计量调整网络结构生成因果网络G1，按照预设要求筛选出预设个与心电图st段异常相关的因果机制变量；其中，对贝叶斯网络生成模块产生的贝叶斯网络G0进行结构调整，计算贝叶斯网络G0各路径的因果效应估计量，采用前门调整公式和后门调整公式，逐一排除各路径存在情况，删改调整贝叶斯网络G0结构，并筛选出8个与心电图ST段异常相关的因果机制变量。心电图信号处理模块：从心电图中提取12导联数据，并对12导联数据进行预处理，得到预处理后的12导联数据；基于预处理后的12导联数据获取10维心电特征；其中，本发明使用大量临床心电图数据包括原始xml文件以及医生对心电图的临床诊断结果，心电数据含有各种噪声，包含基线漂移、肌电噪声和工频噪声等。使用小波去除心电图上的各种噪声，并结合医生诊断的相关信息和心电波形信息去除记录不良和质量差的数据，然后对数据进行心拍分割，统一填充为固定长度。根据ST段异常的形态学特点，设计提取了十类特征用于后续训练。判别模块：对预处理后的12导联数据和10维心电特征进行预处理，并通过卷积残差神经网络提取深度特征；将深度特征与因果机制变量数据进行结合，并输入决策树得到心电图中出现心电特征st段异常的预测概率。其中，对心电图信号处理模块产生的数据进行数据增强，将原始心电序列数据进行平移和缩放，输入包含SE模块的RestneXt50深度残差网络训练，为了适应心电数据的特点，本发明将ResneXt50中的所有二维卷积操作换位一维卷积，并在全连接层前，SE模块主要学习了channel之间的相关性，可以提高网络性能.该网络可以发掘患者十二导联心电图所含的丰富信息，训练后得到能够提取心电图深度特征的网络模型。输入训练数据，使用心电图信号处理模块直接提取出512维深度特征，然后与心电波形特征、因果机制特征拼接在一起，使用xgboost树形模型进行训练，并调节xgboost相关超参数，学习得到概率预测模型。使用时，只需将心电图xml文件放到程序指定位置，先经过神经网络得到神经网络提取的512维特征，再将这些特征与患者体征等心外因素信息结合，输入xgboost模型，即可得该名检测者出现ST段异常心电特征的概率以及异常类型。具体地，在所述贝叶斯网络生成模块中，模块M1.1：提取心外体征因素数据，并对提取出的心外体征因素数据进行离散化处理，得到离散化处理后的心外体征因素数据；模块M1.2：将离散化处理后的心外体征因素数据使用NOTEARS结构学习算法和K2评分算法生成数据变量间的加权邻接矩阵；模块M1.3：加权邻接矩阵通过硬阈值规则将矩阵权值进行二级化处理，提取非零权值，生成贝叶斯网络G0。具体地，在所述有向调整模块中，模块M2.1：采用前门调整公式和后门调整公式计算贝叶斯网络G0各路径的因果效应估计量；模块M2.2：基于因果效应估计量使用do运算进行干预操作，调整网络结构，生成因果网络G1。具体地，在所述模块M2.1中，采用前门调整公式、后门调整公式和有向分离法则推断包括吸烟、饮酒以及运动变量与st段异常之间的不同因果关系。具体地，在所述心电图信号处理模块中，模块M3.1：从心电图机产生的XML文件提取12导联序列数据；模块M3.2：12导联序列数据使用symlets4小波对心电信号进行7层分解去噪处理，得到去噪后的12导联序列数据；模块M3.3：基于去噪后的12导联序列数据寻找心电序列数据中R波的位置，并以R波为基准进行心拍分割，获得10维心电特征。具体地，在所述判别模块中，模块M4.1：对去噪后的12导联序列数据和10维心电特征进行平移和缩放的数据增强处理，得到处理后的数据；模块M4.2：处理后的数据利用ResneXt50+SE深度残差深度神经网络提取深度特征；模块M4.3：将深度特征与因果机制变量数据进行结合，输入训练好的xgBoost树模型，得到心电图中出现心电特征st段异常的预测概率。具体地，所述ResneXt50+SE卷积残差深度神经网络采用：处理后的数据进入ResneXt50+SE深度残差深度神经网络，经过一个1维卷积层和最大池化层后，进入重复预设数量的瓶颈层，最后经过全局池化层和全局最大池化层转化为一维数据后，经过全连接层和Softmax函数层得到三维预测值。Softmax函数将输出结果转换为概率具体地，在所述瓶颈层中：使用卷积核为1的变换维度操作改变数据维度，然后使用分组卷积的方式提高网络宽度，最后使用核为1的变换维度的操作得到相应尺寸的数据。具体地，所述瓶颈层还包括：通过SE步骤学习channel之间的相关性，提高ResneXt50+SE卷积残差深度神经网络的准确率。SE模块的“挤压”操作作用是通过池化操作将每个通道的数据转化为一个值，包含了该通道的综合信息。紧接着是“解压”操作，它使用两层全连接层来训练学习各个通道之间的联系，最终得到每个特征通道的权重，该权重表征了通道的重要性和通道之间的关联。根据本发明提供的一种基于因果分析的心电图ST段异常判别方法，包括：贝叶斯网络生成步骤：提取心外体征因素数据并进行预处理，得到预处理后的心外体征因素数据，基于预处理后的心外体征因素数据生成数据变量间的加权邻接矩阵，加权邻接矩阵提取非零权值生成贝叶斯网络G0，建立心电图st段异常与心外体征因素数据之间的因果联系机制；其中，本发明使用大量临床心电图数据包括原始xml文件、医生对心电图的临床诊断结果以及受访者其他体征数据，基于先验知识从原始体征数据中筛选出了十个变量，将数据准备好了之后，分别使用NOTEARS结构学习算法和K2评分算法生成数据变量间的加权邻接矩阵，采取将邻接矩阵通过硬阈值ω＝0.1的方式二级化矩阵权值，得到初步因果网络模型，建立心电图ST段异常与体征变量之间的因果联系机制。有向调整步骤：计算贝叶斯网络G0各路径的因果效应估计量，基于因果效应估计量调整网络结构生成因果网络G1，按照预设要求筛选出预设个与心电图st段异常相关的因果机制变量；其中，对贝叶斯网络生成步骤产生的贝叶斯网络G0进行结构调整，计算贝叶斯网络G0各路径的因果效应估计量，采用前门调整公式和后门调整公式，逐一排除各路径存在情况，删改调整贝叶斯网络G0结构，并筛选出8个与心电图ST段异常相关的因果机制变量。心电图信号处理步骤：从心电图中提取12导联数据，并对12导联数据进行预处理，得到预处理后的12导联数据；基于预处理后的12导联数据获取10维心电特征；其中，本发明使用大量临床心电图数据包括原始xml文件以及医生对心电图的临床诊断结果，心电数据含有各种噪声，包含基线漂移、肌电噪声和工频噪声等。使用小波去除心电图上的各种噪声，并结合医生诊断的相关信息和心电波形信息去除记录不良和质量差的数据，然后对数据进行心拍分割，统一填充为固定长度。根据ST段异常的形态学特点，设计提取了十类特征用于后续训练。判别步骤：对预处理后的12导联数据和10维心电特征进行预处理，并通过卷积残差神经网络提取深度特征；将深度特征与因果机制变量数据进行结合，并输入决策树得到心电图中出现心电特征st段异常的预测概率。其中，对心电图信号处理步骤产生的数据进行数据增强，将原始心电序列数据进行平移和缩放，输入包含SE模块的RestneXt50深度残差网络训练，为了适应心电数据的特点，本发明将ResneXt50中的所有二维卷积操作换位一维卷积，并在全连接层前，SE模块主要学习了channel之间的相关性，可以提高网络性能.该网络可以发掘患者十二导联心电图所含的丰富信息，训练后得到能够提取心电图深度特征的网络模型。输入训练数据，使用心电图信号处理步骤直接提取出512维深度特征，然后与心电波形特征、因果机制特征拼接在一起，使用xgboost树形模型进行训练，并调节xgboost相关超参数，学习得到概率预测模型。使用时，只需将心电图xml文件放到程序指定位置，先经过神经网络得到神经网络提取的512维特征，再将这些特征与患者体征等心外因素信息结合，输入xgboost模型，即可得该名检测者出现ST段异常心电特征的概率以及异常类型。具体地，在所述贝叶斯网络生成步骤中，步骤S1.1：提取心外体征因素数据，并对提取出的心外体征因素数据进行离散化处理，得到离散化处理后的心外体征因素数据；步骤S1.2：将离散化处理后的心外体征因素数据使用NOTEARS结构学习算法和K2评分算法生成数据变量间的加权邻接矩阵；步骤S1.3：加权邻接矩阵通过硬阈值规则将矩阵权值进行二级化处理，提取非零权值，生成贝叶斯网络G0。具体地，在所述有向调整步骤中，步骤S2.1：采用前门调整公式和后门调整公式计算贝叶斯网络G0各路径的因果效应估计量；步骤S2.2：基于因果效应估计量使用do运算进行干预操作，调整网络结构，生成因果网络G1。具体地，在所述步骤S2.1中，采用前门调整公式、后门调整公式和有向分离法则推断包括吸烟、饮酒以及运动变量与st段异常之间的不同因果关系。具体地，在所述心电图信号处理步骤中，步骤S3.1：从心电图机产生的XML文件提取12导联序列数据；步骤S3.2：12导联序列数据使用symlets4小波对心电信号进行7层分解去噪处理，得到去噪后的12导联序列数据；步骤S3.3：基于去噪后的12导联序列数据寻找心电序列数据中R波的位置，并以R波为基准进行心拍分割，获得10维心电特征。具体地，在所述判别步骤中，步骤S4.1：对去噪后的12导联序列数据和10维心电特征进行平移和缩放的数据增强处理，得到处理后的数据；步骤S4.2：处理后的数据利用ResneXt50+SE深度残差深度神经网络提取深度特征；步骤S4.3：将深度特征与因果机制变量数据进行结合，输入训练好的xgBoost树模型，得到心电图中出现心电特征st段异常的预测概率。具体地，所述ResneXt50+SE卷积残差深度神经网络采用：处理后的数据进入ResneXt50+SE深度残差深度神经网络，经过一个1维卷积层和最大池化层后，进入重复预设数量的瓶颈层，最后经过全局池化层和全局最大池化层转化为一维数据后，经过全连接层和Softmax函数层得到三维预测值。Softmax函数将输出结果转换为概率具体地，在所述瓶颈层中：使用卷积核为1的变换维度操作改变数据维度，然后使用分组卷积的方式提高网络宽度，最后使用核为1的变换维度的操作得到相应尺寸的数据。具体地，所述瓶颈层还包括：通过SE步骤学习channel之间的相关性，提高ResneXt50+SE卷积残差深度神经网络的准确率。SE模块的“挤压”操作作用是通过池化操作将每个通道的数据转化为一个值，包含了该通道的综合信息。紧接着是“解压”操作，它使用两层全连接层来训练学习各个通道之间的联系，最终得到每个特征通道的权重，该权重表征了通道的重要性和通道之间的关联。实施例2实施例2是实施例1的优选例本发明使用的心外变量数据是一个基于对上海地区老年群体健康状况调查的数据集，该随访数据库来自于2018年5月28-2018年9月12日所有泥城镇60岁以上的老年人的健康状况调查，总调查人数为12098人。原始数据集中包含变量55个，基于先验知识从原始数据中筛选出了十个变量。本发明提供了一种基于因果分析的心电图ST段异常判别方法，如图1所示，包括：步骤1：利用NOTEARS结构学习算法和K2评分搜索的结构学习算法生成数据变量间的加权邻接矩阵，加权邻接矩阵通过硬阈值规则将矩阵权值进行二级化处理，提取非零权值，生成贝叶斯网络G0；基于迹指数以及增广拉格朗日法的非组合结构学习算法计算贝叶斯网络G0的损失函数；在损失函数的基础上添加l1正则化||W||1＝||vec||1获得得分函数：其中，X∈Rn×d是由n个独立同分布的数据观察向量X＝构成的数据矩阵，n为矩阵行数，d为向量列数；W＝，...通过公式定义了一个线性的结构方程模型；T为矩阵转置运算；z＝是一个随机噪声向量；为最小二乘损失函数；λ表示随机变量；vec表示正则化；建立因果关系图，即求得分函数最小值：subjectto G∈D其中，G表示有向无环图DAG由点集和边集构成，D表示基于n个节点生成的有向无环图的离散空间，包含所有可能的图形结构；数据矩阵W＝，...表示d*d的线性的结构方程模型，d为矩阵行数和列数。将离散的约束条件G∈D转化成光滑的等式约束h＝0。h＝tr-d＝0其中，⊙表示哈达玛积，eA是A的矩阵指数；d为数据矩阵W的行数和列数；目前待求解的问题是一个等式约束问题ECP如下：subjectto h＝0使用增广拉格朗日方法解决ECP问题，它会产生一个二次惩罚项：subjectto h＝0其中，ρ为随机变量；驻点即为h＝0的条件所求的最小值时，W的取值；计算生成10×10的加权邻接矩阵，在获得一个基于公式8的驻点后，给定一个固定的阈值ω＞0，将中小于阈值ω的权值都直接设置为0。这种策略还有一种重要的作用，就是它可以舍入增广拉格朗日数值解。由于需要考虑到数值精度，不需要严格地限制h＝0，而是给定一个接近机器数值精度的小的误差接受范围∈，要求h≤∈。这种做法也足以排除导致环出现的边。由于本发明的目标在于恢复出贝叶斯网络的结构，而并不关心邻接矩阵中非零权值的具体大小，所以对于邻接矩阵中的权值做二值化操作。保留零值，将所有的非零值置为1得到二值矩阵，生成初步因果网络。贝叶斯网络的箭头方向更多的只是反映了一个数据之间基于条件独立性以及评分函数得出的一个相对较优的结构，它有待后续我们基于领域内的知识积累做出一个修正，这里采用干预工具对网络模型进行调整。干预公式：P)＝∑ZP′·P′其中，X、Y、Z表示三个变量，以这三个变量为例我们通过干预公式探索三个变量间关系；x、y、z表示变量X、Y、Z所取的某一具体值。给定一个有向无环图G，以及G中的一对有序变量X和Y，如果一组变量Z中的节点都不是X的后代节点，并且以Z为条件会阻断所有X和Y之间的后门路径，那么变量Z满足关于的后门准则。后门调整公式即为P)＝∑ZP′·P′同样前门调整公式为P)＝∑x′P·P∑yP剥离各因素和ST段异常之间的网络结构，对结构中箭头的指向，路径的存在与否进行逐一排查，直接对网络中的路径进行删改。本发明使用心电数据是心电图机生成的xml格式的12导联心电图序列数据，这些心电图已经由有经验的医生给出心电图的诊断结果。Symlet小波函数是近似对称的小波函数，备较好的正则性，能够一定程度上减少对信号在分析和重构时的相位失真。选取Symlets4小波函数对心电信号进行7个尺度的分解，将小波分解的低频信号视为心电信号的基线漂移，即将尺度1的小波系数视为基线漂移，将尺度1，6，7的系数置为零，然后通过小波重构获得去噪后的心电信号。得到去噪心电信号后对心电图进行心拍分割，由于R波波差距极大，因而以心电图最大值乘以0.6的积作为阈值，然后以RR间距的平均值作为周期T，以R波前0.35*T距离的点为起点，R波前0.65*T距离的点为终点，截取心拍，然后通过填充0的方式将心拍数据填充为长度为600的序列数据。数据输入ResneXt50模块网络中训练。本发明将网络中的卷积操作全部换成一维卷积，离散一维卷积计算公式为：数据进入网络后经过一个1维卷积层和最大池化层后，进入重复的瓶颈层里，最后经过全局池化层和全局最大池化层层转换为一维数据后，经过全连接层，得到最终的三维预测值。在每个Bottleneck中，首先进行卷积核为1的变换维度操作，然后使用分组卷积，最后使用核为1的变换维度的操作得到相应尺寸的数据。它与Resnet50的差别在于使用了分组卷积，这一操作相当于在增加了网络“宽度”的同时没有增加参数数量，获得了比Resnet50更好的效果。训练树形分类器xgboost，它是一种提升树模型，本质是将许多树模型集成在一起，、在决策树模型中是使用启发式方法解决根据训练特征及训练数据构建分类树，判定每条数据的预测结果。其中构建树使用gini指数计算增益，即进行构建树的特征选取，gini指数公式如式，gini指数计算增益公式如式：pk表示数据集D中类别k的概率，K表示类别个数；D表示整个数据集，D1和D2分别表示数据集中特征为A的数据集和特征非A的数据集，Gini表示特征为A的数据集的gini指数。训练xgboost时，首先将步骤2中训练好的ResneXt50模型的全连接层去除，然后将训练数据输入，即可得到用于树模型训练的512维深度特征，然后将8维因果机制的数据与深度特征横向拼接起来，得到522维训练数据，将此数据输入xgboost训练，调整学习率、最大深度、每颗数采用列数占比等参数，得到最终预测及判别模型。本领域技术人员知道，除了以纯计算机可读程序代码方式实现本发明提供的系统、装置及其各个模块以外，完全可以通过将方法步骤进行逻辑编程来使得本发明提供的系统、装置及其各个模块以逻辑门、开关、专用集成电路、可编程逻辑控制器以及嵌入式微控制器等的形式来实现相同程序。所以，本发明提供的系统、装置及其各个模块可以被认为是一种硬件部件，而对其内包括的用于实现各种程序的模块也可以视为硬件部件内的结构；也可以将用于实现各种功能的模块视为既可以是实现方法的软件程序又可以是硬件部件内的结构。以上对本发明的具体实施例进行了描述。需要理解的是，本发明并不局限于上述特定实施方式，本领域技术人员可以在权利要求的范围内做出各种变化或修改，这并不影响本发明的实质内容。在不冲突的情况下，本申请的实施例和实施例中的特征可以任意相互组合。
