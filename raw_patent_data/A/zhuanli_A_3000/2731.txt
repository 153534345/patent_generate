标题title
一种在线学习按摩定位算法
摘要abst
本发明公开了一种在线学习按摩定位算法，涉及人工智能技术领域，包括以下步骤：根据自然指向确定按摩候选区域；利用比例选择法的方式在按摩候选区域通过询问交互确定按摩中心点位置、按摩点二维分布模型及按摩区域；在线学习按摩习惯，根据用户的选择区域，更新相关身体部位的两种概率以减少按摩中心点定位时减少人机的交互次数。本发明的有益效果在于可减少用户的记忆和操作负荷，并且用户可以不拘泥一种姿态，可按照自身意愿移动身体，系统会根据记录的按摩区域点与身体关键点的位置关系实现实时跟踪按摩。
权利要求书clms
1.一种在线学习按摩定位算法，其特征在于，包括以下步骤：根据自然指向确定按摩候选区域；利用比例选择法的方式在按摩候选区域通过询问交互确定按摩中心点位置、按摩点二维分布模型及按摩区域；在线学习按摩习惯，根据用户的选择区域，更新相关身体部位的两种概率以减少在按摩中心点定位时减少人机的交互次数。2.根据权利要求1所述的一种在线学习按摩定位算法，其特征在于，所述步骤中根据指向时食指是否出现弯曲设定不同的指向线Line1，确定指向线Line1后，假设存在一个身体姿态限定面，直线位于身体姿态限定面内，且身体姿态限定面均垂直于地面，即三维空间中的xoz面，已知地面的法线为，设直线Line1的方向向量为，身体姿态限定面的法线向量为： 结合指尖点坐标便可得到身体姿态限定面的方程，之后根据指向交点所在身体部位的关键点坐标信息确定身体面，最后，通过指向手的位置、指向方向以及身体姿态限定面和身体面的长和宽求出两个面的交线，根据指向手指指尖与的距离确定按摩候选区域的宽度d，d的取值设定了三种情况：第一种：8cm，即指尖与交点的距离比较近时，则设定d为所在部位的宽度最大值的；第二种：时，设定d为；第三种：20cm，即指尖与交点的距离比较远时，则设定d为；设定按摩候选区域T的高度为交线在y轴上的投影长度，按摩候选区域T的宽度L为比较在x轴上投影的长度并选择最大值。3.根据权利要求1所述的一种在线学习按摩定位算法，其特征在于，在步骤中，将人体进行部位划分并对每个部分进行细化的区域划分，按摩定位时，每个小区域均有一个中心概率值和选择概率值且每一身体部位下各个小区域的中心概率值总和与选择概率值总和均为1；假设按摩候选区域T中共包含个部分，面积值分别为，形成面积集合，确定每个部分所对应的选择概率，形成概率集合；确定每个部分所对应的中心概率，形成概率集合，使用比例选择法确定区域T内的首选询问点：首先，系统根据公式确定区域T内每一部分的被选择概率值，并按顺序计算出每一部分的累加概率，即每部分的累加概率为该部分以及其对应的前几部分的累加和，累积概率使用不同长度的线段来表示每一部分的概率，所有部分组合在一起便可形成一条长度为1的长线段； 其次，系统在区间中随机产生一个数r，若，则选择第一部分作为目标部分，否则，则根据选择第i部分作为目标部分；通过以上步骤可得到按摩候选区域T内首选询问部分的中心点位置，将机械臂移至该点并询问用户“当前所触碰的点是否包含在按摩区域内”，若系统得到否定答案，首选询问部分将从候选区域内剔除；剩余部分将作为新的候选区域，之后系统将重新计算候选区域内每个部分的综合概率值并利用以上步骤重新选择，另外，设置限定最小候选区域面积β，在不断缩小候选区域的过程中，若新的候选区域面积小于β，系统会要求用户重新进行表达，若得到积极答案，在x轴上将点移动至交线上得到点，并将该点作为按摩中心点；最后，设定按摩点的位置坐标在X轴和Y轴均服从正态分布，且参数x、y相互独立，两个分布的均值分别为和，方差由L和H决定，根据原则可分别求出X和Y的方差为：，由此得到按摩点坐标服从的二维正态分布公式： 根据公式随机产生按摩点的坐标，另外，设定，，  和四点所围成的区间为本次的按摩目标区域。4.根据权利要求1所述的一种在线学习按摩定位算法，其特征在于，所述步骤中通过递归贝叶斯方法来实现，假设身体的第R个部位被选择了N次，且该部位包括K个小区域，第i次选择按摩区域选择的结果可以表示为，代表第R个部位下的第i个小区域，值为0时代表选择的区域与第i个小区域没有相交的区域；值为1时代表目标区域中包含第i个小区域或包含第i个小区域的一部分，另外K个小区域具备的中心概率值形成概率集合，选择概率值形成集合，在线学习的目标是利用用户的按摩位置选择结果更新相关部位下每个小区域的概率值，即更新，利用贝叶斯公式可以得到概率集合的后验概率为： 其中先验函数可以通过，...，，即一步一迭代计算得到，设定服从狄利克雷分布，因此的后验分布也服从狄利克雷分布，似然函数可以通过以下公式进行计算：的最大后验值可以根据用户以往的定位信息，由公式计算得到： 其中，为狄利克雷分布的参数，它记录了先前按摩中心点落在第R个部位下第j个小区域的次数；依据中心概率的更新方式，设定选择概率的在线更新公式： 其中为历史选择的按摩区域内所包含第j个小区域的面积的总和；为本次目标按摩区域内包含第j个小区域的面积；为第j个小区域的面积。
说明书desc
技术领域本发明涉及人工智能技术领域，尤其涉及一种人工智能算法，具体是指一种在线学习按摩定位算法。背景技术随着科技的发展，人工智能的越来越多的应用于人们的日常生活之中，如将人工智能应用于按摩系统中并出现了诸如按摩机器人等产品。在按摩机器人产品中人机交互是其中的关键，目前智能按摩系统的交互设备主要由Xarm机械臂、Kinect感知设备、语音输入设备、计算与处理设备等组成，而其中按摩定位系统的实现难点在于系统如何精准的感知和理解人们对按摩区域位置进行的自然表达。为此，在线学习按摩定位算法的基本思路一般为：首先，实时感知指向和语音的输入，结合人体姿态利用冗余的思想扩展指向交点为指向交线得到按摩候选区域；其次，针对按摩候选区利用比例选择法进行询问交互确定按摩中心点和按摩点生成模型；最后根据按摩区域，更新该部位下每一部分的中心概率值和选择概率值，同一部位经过多次选择后，系统便可学习到人们在该部位上的按摩习惯，从而可减少下次中心点确认时的询问交互次数。对于语音表达的理解，首先建立语音意图数据库KWLib，该数据库描述了语音与可能意图之间的关系，并采用关键词检测的方法实现实时语音识别；而对指向识别，可以利用身体和手部关键点检测实现实时监控；按摩定位时，语音和指向两种模态可以是并行输入，也可以单模态输入。在此，将按摩定位系统的输入分为了三种情况：第一种，两种模态并行输入，此时需要判定两者所传输的信息是否存在矛盾性，如果存在，系统会主动提醒用户，并要求其重新表达；第二种，两种模态并行输入且两者不存在矛盾或者仅有指向作为单模态输入，此时系统将开启OLMP算法按摩定位功能；第三种，仅有语音作为单模态输入，系统对识别出的身体部位进行全区域按摩。其中，指向表达分为接触性和非接触性两种：第一种接触性表达方式，可以直接将接触点作为按摩中心点：第二种非接触性表达方式，可通过指向线和身体的交点作为按摩区域的中心点，但是，身体骨骼点检测不精准、操作者自身原因等情况均会对交点的位置造成较大的干扰，因此，将交点作为按摩中心点会存在误差，特别是手部距离目标区域较远时，指向产生一点小的偏差可能就会导致交点远远偏离目标点，另外，对于按摩而言，需要得到的信息是按摩区域而非一个按摩中心点。而本发明则是针对智能按摩定位系统中存在的因非接触表达所存在的以上问题,本文提出的智能按摩定位系统可以解决非接触表达所存在的以上问题。发明内容本发明针对现有技术的不足，提供了一种用于纠正因非接触表达导致按摩定位偏差的在线学习按摩定位算法。本发明是通过如下技术方案实现的，提供一种在线学习按摩定位算法，一种在线学习按摩定位算法，包括以下步骤：根据自然指向确定按摩候选区域；利用比例选择法的方式在按摩候选区域通过询问交互确定按摩中心点位置、按摩点二维分布模型及按摩区域；在线学习按摩习惯，根据用户的选择区域，更新相关身体部位的两种概率以减少在按摩中心点定位时减少人机的交互次数。作为优选，所述步骤中根据指向时食指是否出现弯曲设定不同的指向线Line1，确定指向线Line1后，假设存在一个身体姿态限定面，直线位于身体姿态限定面内，且身体姿态限定面均垂直于地面，即三维空间中的xoz面，已知地面的法线为，设直线Line1的方向向量为，身体姿态限定面的法线向量为： 结合指尖点坐标便可得到身体姿态限定面的方程，之后根据指向交点所在身体部位的关键点坐标信息确定身体面，最后，通过指向手的位置、指向方向以及身体姿态限定面和身体面的长和宽求出两个面的交线，根据指向手指指尖与的距离确定按摩候选区域的宽度d，d的取值设定了三种情况：第一种：8cm，即指尖与交点的距离比较近时，则设定d为所在部位的宽度最大值的；第二种：时，设定d为；第三种：20cm，即指尖与交点的距离比较远时，则设定d为；设定按摩候选区域T的高度为交线在y轴上的投影长度，按摩候选区域T的宽度L为比较在x轴上投影的长度并选择最大值。作为优选，在步骤中，将人体进行部位划分并对每个部分进行细化的区域划分，按摩定位时，每个小区域均有一个中心概率值和选择概率值且每一身体部位下各个小区域的中心概率值总和与选择概率值总和均为1；假设按摩候选区域T中共包含个部分，面积值分别为，形成面积集合，确定每个部分所对应的选择概率，形成概率集合；确定每个部分所对应的中心概率，形成概率集合，使用比例选择法确定区域T内的首选询问点：首先，系统根据公式确定区域T内每一部分的被选择概率值，并按顺序计算出每一部分的累加概率，即每部分的累加概率为该部分以及其对应的前几部分的累加和，累积概率使用不同长度的线段来表示每一部分的概率，所有部分组合在一起便可形成一条长度为1的长线段； 其次，系统在区间中随机产生一个数r，若，则选择第一部分作为目标部分，否则，则根据选择第i部分作为目标部分；通过以上步骤可得到按摩候选区域T内首选询问部分的中心点位置，将机械臂移至该点并询问用户“当前所触碰的点是否包含在按摩区域内”，若系统得到否定答案，首选询问部分将从候选区域内剔除；剩余部分将作为新的候选区域，之后系统将重新计算候选区域内每个部分的综合概率值并利用以上步骤重新选择，另外，设置限定最小候选区域面积β，在不断缩小候选区域的过程中，若新的候选区域面积小于β，系统会要求用户重新进行表达，若得到积极答案，在x轴上将点移动至交线上得到点，并将该点作为按摩中心点；最后，设定按摩点的位置坐标在X轴和Y轴均服从正态分布，且参数x、y相互独立，两个分布的均值分别为和，方差由L和H决定，根据原则可分别求出X和Y的方差为：，由此得到按摩点坐标服从的二维正态分布公式： 根据公式随机产生按摩点的坐标，另外，设定，， 和四点所围成的区间为本次的按摩目标区域。作为优选，所述步骤中通过递归贝叶斯方法来实现，假设身体的第R个部位被选择了N次，且该部位包括K个小区域，第i次选择按摩区域选择的结果可以表示为，代表第R个部位下的第i个小区域，值为0时代表选择的区域与第i个小区域没有相交的区域；值为1时代表目标区域中包含第i个小区域或包含第i个小区域的一部分，另外K个小区域具备的中心概率值形成概率集合，选择概率值形成集合，在线学习的目标是利用用户的按摩位置选择结果更新相关部位下每个小区域的概率值，即更新，利用贝叶斯公式可以得到概率集合的后验概率为： 其中先验函数可以通过，...，，即一步一迭代计算得到，设定服从狄利克雷分布，因此的后验分布也服从狄利克雷分布，似然函数可以通过以下公式进行计算： 的最大后验值可以根据用户以往的定位信息，由公式计算得到： 其中，为狄利克雷分布的参数，它记录了先前按摩中心点落在第R个部位下第j个小区域的次数；依据中心概率的更新方式，设定选择概率的在线更新公式： 其中为历史选择的按摩区域内所包含第j个小区域的面积的总和；为本次目标按摩区域内包含第j个小区域的面积；为第j个小区域的面积。根据以上方案，本发明的基本发明构思为：当系统检测到非接触指向手势后，利用冗余思想扩展指向交点为交线从而确定按摩候选区域T；系统利用比例选择法确定按摩中心点，进而根据区域T的高和宽确定按摩点的二维正态分布模型；根据系统确定的按摩目标区域，更新相关身体部位的中心概率和选择概率以逐步实现学习用户按摩习惯的功能。其主要特点在于：可理解用户在自然指向下对任意身体位置的表达，系统根据手指关键点确定用户指向方向，若指向线与身体区域无交点，系统会主动提醒用户并要求其重新表达；若指向线与身体存在交点，则系统会根据步骤求出候选区域T，并根据步骤在候选区域T内确定按摩中心点；在该过程中，系统会记录下按摩点与身体关键点的位置关系，这些设定均保证了在指向满足条件的前提下，按摩点总是能够被找到；可通过不断更新每个身体部位下区域的中心概率和选择概率，在线学习用户的按摩习惯。综上所述，本发明的有益效果在于通过分析用户在自然条件下对按摩区域的非接触指向表达，在不需要其他辅助条件的情况下可实现按摩定位，可减少用户的记忆和操作负荷，实现了在下一次的按摩定位过程中，更快地从按摩候选区域T中找到目标按摩部分，从而减少系统对用户的询问次数，更快地确定按摩模型，另外，在按摩定位过程中，用户可以不拘泥一种姿态，可按照自身意愿移动身体，系统会根据记录的按摩区域点与身体关键点的位置关系实现实时跟踪按摩。附图说明图1为本发明基于在线学习的按摩定位系统的结构示意图；图2为本发明中不同指向手势下确定交线的示意图，其中，表示不规范指向下的交线求取；表示规范指向下的交线求取；图3为本发明中按摩中心点确定过程的示意图，其中，表示虚线框定的区域代表T；表示注明了区域T所包含的各个部分的面积和两种类型的概率；代表按摩中心点的确定。图4为本发明中按摩候选区域的确定示意图。具体实施方式为能清楚说明本发明方案的技术特点，下面结合附图，并通过具体实施方式，对本方案进一步阐述。如图1和图2中所示，提供一种在线学习按摩定位算法，包括以下步骤：根据自然指向确定按摩候选区域；利用比例选择法的方式在按摩候选区域通过询问交互确定按摩中心点位置、按摩点二维分布模型及按摩区域；在线学习按摩习惯，根据用户的选择区域，更新相关身体部位的两种概率以减少在按摩中心点定位时减少人机的交互次数。在本实施例中，所述步骤中根据指向时食指是否出现弯曲设定不同的指向线Line1，确定指向线Line1后，假设存在一个身体姿态限定面，直线位于身体姿态限定面内，且身体姿态限定面均垂直于地面，即三维空间中的xoz面，已知地面的法线为，设直线Line1的方向向量为，身体姿态限定面的法线向量为： 结合指尖点坐标便可得到身体姿态限定面的方程，之后根据指向交点所在身体部位的关键点坐标信息确定身体面，最后，通过指向手的位置、指向方向以及身体姿态限定面和身体面的长和宽求出两个面的交线，根据指向手指指尖与的距离确定按摩候选区域的宽度d，d的取值设定了三种情况：第一种：8cm，即指尖与交点的距离比较近时，则设定d为所在部位的宽度最大值的；第二种：时，设定d为；第三种：20cm，即指尖与交点的距离比较远时，则设定d为；设定按摩候选区域T的高度为交线在y轴上的投影长度，按摩候选区域T的宽度L为比较在x轴上投影的长度并选择最大值。在步骤中，将人体进行部位划分并对每个部分进行细化的区域划分，如人体部位可分为左右胳膊、背部等，在本实施例中以按摩候选区域落在背部且背部共包含9个小区域为例进行说明，如图3中所示，图3中的中虚线框定的区域便是候选区域，该区域内的黑色直线为交线。按摩定位时，每个小区域均有一个中心概率值和选择概率值且每一身体部位下各个小区域的中心概率值总和与选择概率值总和均为1；假设按摩候选区域T中共包含个部分，面积值分别为，形成面积集合，确定每个部分所对应的选择概率，形成概率集合；确定每个部分所对应的中心概率，形成概率集合，使用比例选择法确定区域T内的首选询问点：首先，系统根据公式确定区域T内每一部分的被选择概率值，并按顺序计算出每一部分的累加概率，即每部分的累加概率为该部分以及其对应的前几部分的累加和，累积概率使用不同长度的线段来表示每一部分的概率，所有部分组合在一起便可形成一条长度为1的长线段； 其次，系统在区间中随机产生一个数r，若，则选择第一部分作为目标部分，否则，则根据选择第i部分作为目标部分；通过以上步骤可得到按摩候选区域T内首选询问部分的中心点位置，将机械臂移至该点并询问用户“当前所触碰的点是否包含在按摩区域内”，若系统得到否定答案，首选询问部分将从候选区域内剔除；剩余部分将作为新的候选区域，之后系统将重新计算候选区域内每个部分的综合概率值并利用以上步骤重新选择，另外，设置限定最小候选区域面积β，在不断缩小候选区域的过程中，若新的候选区域面积小于β，系统会要求用户重新进行表达，若得到积极答案，在x轴上将点移动至交线上得到点，并将该点作为按摩中心点；最后，设定按摩点的位置坐标在X轴和Y轴均服从正态分布，且参数x、y相互独立，两个分布的均值分别为和，方差由L和H决定，根据原则可分别求出X和Y的方差为：，由此得到按摩点坐标服从的二维正态分布公式： 根据公式随机产生按摩点的坐标，另外，设定，， 和四点所围成的区间为本次的按摩目标区域，如图4中虚线框定的区域所示。所述步骤中通过递归贝叶斯方法来实现，假设身体的第R个部位被选择了N次，且该部位包括K个小区域，第i次选择按摩区域选择的结果可以表示为，代表第R个部位下的第i个小区域，值为0时代表选择的区域与第i个小区域没有相交的区域；值为1时代表目标区域中包含第i个小区域或包含第i个小区域的一部分，另外K个小区域具备的中心概率值形成概率集合，选择概率值形成集合，在线学习的目标是利用用户的按摩位置选择结果更新相关部位下每个小区域的概率值，即更新，利用贝叶斯公式可以得到概率集合的后验概率为： 其中先验函数可以通过，...，，即一步一迭代计算得到，设定服从狄利克雷分布，因此的后验分布也服从狄利克雷分布，似然函数可以通过以下公式进行计算： 的最大后验值可以根据用户以往的定位信息，由公式计算得到： 其中，为狄利克雷分布的参数，它记录了先前按摩中心点落在第R个部位下第j个小区域的次数；依据中心概率的更新方式，设定选择概率的在线更新公式： 其中为历史选择的按摩区域内所包含第j个小区域的面积的总和；为本次目标按摩区域内包含第j个小区域的面积；为第j个小区域的面积。因此，第R个部位上每个小区域的概率值将随着交互信息的不断增加而逐步更新。 基于以上说明，本实施例给出具体的算法描述如下：算法:在线学习式按摩定位输入：用户的语音：voice；用户手部的关键点信息;用户身体的关键点信息；初始身体部位各个区域的中心概率和选择概率。输出：按摩点的集合P。1. 利用公式计算;利用和；利用和用户身体关键点信息;利用和/*计算面和面的交线。*/.2.H=Height；L=max,d).3.T /*确定按摩候选区域T*/4.Num1KWLib /*将用户的语音信息与语音意图库的内容进行匹配，从而找到按摩目标身体部位的编号。*/Num2T /*确定按摩候选区域所在身体部位的编号。*/5.IFNum1=num=Num2num=Num1Num2/*确定指向和语音所同时表达的按摩部位编号*/6.确定按摩候选区域内每一部分的初始中心概率值和选择概率值:7.利用公式计算8.中心点/*通过比例选择法算法确定;通过确定按摩目标区域的中心点坐标。*/9.10. /*确定按摩点集合P以及按摩目标区域。*/ .11.利用公式更新12.利用公式更新最后，还应说明，上述举例和说明也并不仅限于上述实施例，本发明未经描述的技术特征可以通过或采用现有技术实现，在此不再赘述；以上实施例及附图仅用于说明本发明的技术方案并非是对本发明的限制，参照优选的实施方式对本发明进行了详细说明，本领域的普通技术人员应当理解，本技术领域的普通技术人员在本发明的实质范围内所做出的变化、改型、添加或替换都不脱离本发明的宗旨，也应属于本发明的权利要求保护范围。
