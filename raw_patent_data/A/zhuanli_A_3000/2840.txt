标题title
基于元迁移学习的头皮脑电高频振荡信号识别方法及装置
摘要abst
本发明公开了一种基于元迁移学习的头皮脑电高频振荡信号识别方法及装置，涉及信号检测领域，通过对头皮脑电信号进行预处理；采用源域数据对端到端的卷积神经网络模型进行训练；构建包括基学习器和元学习器的元迁移学习模型，将端到端的卷积神经网络模型的部分参数作为基学习器的第二特征提取器的初始参数，采用部分源域数据对基学习器进行训练，将训练得到的第二特征提取器的参数迁移至元学习器中，采用另一源域数据对元学习器进行训练；将最终训练得到的元学习器的第二特征提取器和第二分类器的参数迁移至基学习器中；并通过目标域数据进行微调，得到微调后的基学习器。解决难以获取高精度、稳定的跨个体的HFO信号的识别结果的问题。
权利要求书clms
1.一种基于元迁移学习的头皮脑电高频振荡信号识别方法，其特征在于，包括以下步骤：获取待识别的患者和其余患者在癫痫发作间期的头皮脑电信号，对所述头皮脑电信号进行预处理，得到头皮脑电信号片段，对所述待识别的患者的部分头皮脑电信号片段和其余患者的头皮脑电信号片段进行标注，并将标注后的所述其余患者的头皮脑电信号片段作为源域数据，将标注后的所述待识别的患者的头皮脑电信号片段作为目标域数据；构建端到端的卷积神经网络模型，所述端到端的卷积神经网络模型包括第一特征提取器和第一分类器，采用所述源域数据对所述端到端的卷积神经网络模型进行训练，得到经训练的端到端的卷积神经网络模型；构建元迁移学习模型，所述元迁移学习模型包括均含有第二特征提取器和第二分类器的基学习器和元学习器，所述第一特征提取器和第二特征提取器的结构相同，将所述经训练的端到端的卷积神经网络模型的第一特征提取器的参数作为所述基学习器的第二特征提取器的初始参数，将所述源域数据分为K个子集，将每个子集中的数据分为第一部分数据和第二部分数据；采用每个子集的第一部分数据对所述基学习器进行训练，将训练得到的所述基学习器的所述第二特征提取器的参数迁移至所述元学习器中，采用每个子集的第二部分数据对所述元学习器进行训练；重复训练K次，将第K次训练得到的所述元学习器的第二特征提取器的参数和第二分类器的参数迁移至所述基学习器中，得到优化后的基学习器；采用所述目标域数据对所述优化后的基学习器进行训练，得到微调后的基学习器；将所述待识别的患者的头皮脑电信号片段输入所述微调后的基学习器，输出得到所述头皮脑电信号片段是否为HFO信号的识别结果。2.根据权利要求1所述的基于元迁移学习的头皮脑电高频振荡信号识别方法，其特征在于，所述对所述头皮脑电信号进行预处理，具体包括：去除所述头皮脑电信号的噪声，得到降噪后的头皮脑电信号；对所述降噪后的头皮脑电信号中的80-250Hz频带使用128阶巴特沃斯带通FIR滤波器对每个时段各个通道的数据进行滤波，提取得到滤波后的头皮脑电信号；对所述滤波后的头皮脑电信号采用滑动窗口技术进行信号分段，得到切分后的头皮脑电信号段；将所述切分后的头皮脑电信号段映射到一个欧式空间，得到映射后的信号片段，对所述映射后的信号片段进行对齐和变换。3.根据权利要求2所述的基于元迁移学习的头皮脑电高频振荡信号识别方法，其特征在于，所述去除所述头皮脑电信号的噪声，具体包括：采用独立成分分析法去除所述头皮脑电信号中肌电、眼动、眨眼所导致的头皮脑电噪声；采用陷波滤波器去除工频干扰带来的人工噪声。4.根据权利要求2所述的基于元迁移学习的头皮脑电高频振荡信号识别方法，其特征在于，所述将所述切分后的头皮脑电信号段映射到一个欧式空间，得到映射后的信号片段，对所述映射后的信号片段进行对齐和变换，具体包括：计算所述切分后的头皮脑电信号段的平均协方差矩阵：；其中，为第i个切分后的头皮脑电信号段，n为所述切分后的头皮脑电信号段的总数；采用所述平均协方差矩阵对所述切分后的头皮脑电信号段进行数据对齐：；其中，为第i个头皮脑电信号片段。5.根据权利要求1所述的基于元迁移学习的头皮脑电高频振荡信号识别方法，其特征在于，所述第一特征提取器包括依次连接的第一卷积层、第二卷积层、第一池化层、第三卷积层和第二池化层，所述第一卷积层和第二卷积层分别提取所述头皮脑电信号片段的时域特征和空域特征，所述第一池化层和第二池化层均采用平均池化，将所述第一池化层的输出特征输入所述第三卷积层提取得到深度特征，将所述深度特征经过所述第二池化层，得到时频域深度特征，所述第一分类器包括依次连接的一个全连接层和一个Softmax层，所述时频域深度特征依次输入所述第一分类器，得到所述头皮脑电信号片段是否为HFO信号的二分类结果及其概率，取概率最大的分类结果作为所述识别结果。6.根据权利要求5所述的基于元迁移学习的头皮脑电高频振荡信号识别方法，其特征在于，所述第二分类器包括依次连接的三层全连接层，所述头皮脑电信号片段输入所述基学习器或元学习器，输出得到所述头皮脑电信号片段是否为HFO信号的标签。7.根据权利要求1所述的基于元迁移学习的头皮脑电高频振荡信号识别方法，其特征在于，所述元迁移学习模型的训练过程中所述基学习器的损失函数为：；其中，表示每个子集的第一部分数据对所述基学习器进行训练的过程所使用的交叉熵损失；所述元迁移学习模型的训练过程中所述元学习器的损失函数为：；其中，表示每个子集的第二部分数据对所述元学习器进行训练的过程所使用的交叉熵损失。8.一种基于元迁移学习的头皮脑电高频振荡信号识别装置，其特征在于，包括：预处理模块，被配置为获取待识别的患者和其余患者在癫痫发作间期的头皮脑电信号，对所述头皮脑电信号进行预处理，得到头皮脑电信号片段，对所述待识别的患者的部分头皮脑电信号片段和其余患者的头皮脑电信号片段进行标注，并将标注后的所述其余患者的头皮脑电信号片段作为源域数据，将标注后的所述待识别的患者的头皮脑电信号片段作为目标域数据；预训练模块，被配置为构建端到端的卷积神经网络模型，所述端到端的卷积神经网络模型包括第一特征提取器和第一分类器，采用所述源域数据对所述端到端的卷积神经网络模型进行训练，得到经训练的端到端的卷积神经网络模型；模型构建模块，被配置为构建元迁移学习模型，所述元迁移学习模型包括均含有第二特征提取器和第二分类器的基学习器和元学习器，所述第一特征提取器和第二特征提取器的结构相同，将所述经训练的端到端的卷积神经网络模型的第一特征提取器的参数作为所述基学习器的第二特征提取器的初始参数，将所述源域数据分为K个子集，将每个子集中的数据分为第一部分数据和第二部分数据；元迁移学习模块，被配置为采用每个子集的第一部分数据对所述基学习器进行训练，将训练得到的所述基学习器的所述第二特征提取器的参数迁移至所述元学习器中，采用每个子集的第二部分数据对所述元学习器进行训练；优化模块，被配置为重复训练K次，将第K次训练得到的所述元学习器的第二特征提取器的参数和第二分类器的参数迁移至所述基学习器中，得到优化后的基学习器；微调模块，被配置为采用所述目标域数据对所述优化后的基学习器进行训练，得到微调后的基学习器；识别模块，被配置为将所述待识别的患者的头皮脑电信号片段输入所述微调后的基学习器，输出得到所述头皮脑电信号片段是否为HFO信号的识别结果。9.一种电子设备，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如权利要求1-7中任一所述的方法。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现如权利要求1-7中任一所述的方法。
说明书desc
技术领域本发明涉及信号检测领域，具体涉及一种基于元迁移学习的头皮脑电高频振荡信号识别方法及装置。背景技术癫痫是一种由大脑神经元的突发性异常放电所引发的慢性脑部疾病。在癫痫诊断中，脑电图一直是临床诊断的金标准。近年来，癫痫患者脑电信号中频率在80 Hz以上的脑电活动-高频振荡的临床意义受到广泛的关注。HFO目前无统一定义，学界普遍认为经过80-500 Hz带通滤波后，出现明显高于基准线的４个连续振荡即为HFO。癫痫患者脑电信号中的HFO根据采集方式不同主要分为有创和无创两类。有创的颅内脑电信号中的HFO被大量研究证明同癫痫致痫区有着高度的相关性，可以作为定位致痫区的生物标记物。而无创的头皮脑电信号中的HFO主要用于反映癫痫的严重程度、评价各种癫痫治疗方法的疗效、判断癫痫的易感性、预测癫痫发作等。HFO根据频段不同，可以划分为涟波和快涟波。由于采集技术方面的限制，目前对于应用最为广泛的无创头皮脑电HFO分析主要集中在涟波频段。早年头皮脑电信号由于信噪比低，同时容易受到肌电和伪迹干扰的原因，HFO在很长一段时间内被认为无法在头皮脑电数据中记录。近年来，受益于技术的进步，HFO可以清晰地被头皮脑电设备所记录，并应用于婴幼儿癫痫的诊疗。无创的头皮脑电HFO由于其适用人群广泛及患者接受度高的特点，目前逐步应用于评估婴幼儿癫痫的严重程度和评价婴幼儿癫痫预后上。在目前临床实践中，头皮脑电的HFO检测的金标准仍旧是目测和人工标注，然而HFO人工标注耗时甚久且具有一定主观性，同一科室的专家的对HFO的标注风格可能趋同。同时，头皮脑电数据还经常被未经神经电生理学培训的医生误读，导致HFO漏检与误检。误读头皮脑电数据将导致婴幼儿癫痫症状的误判和相对应的抗癫痫药的误服，并可能持续多年损害婴幼儿脑部发育进而影响婴幼儿的智力。因此，探索HFO信号的智能识别方法，具有极大的现实意义。为了解决这一问题，一系列的HFO信号智能识别模型被提出，这些模型根据识别依据可以划分为统计分析和人工智能两种。对于基于统计分析的识别模型，一般常用指定信号特征的阈值判断是否为HFO信号。而基于人工智能的识别模型，主要包括将特征矩阵直接输入进行信号识别的传统机器学习模型和基于卷积神经网络的深度学习模型。然而，现有这两类模型没有充分考虑到在现有的临床场景中，不同医疗平台用于采集头皮脑电数据的设备和采集标准存在较大差异，同时由于头皮脑电信号的非平稳性，不同婴幼儿癫痫患者的头皮脑电信号乃至同一婴幼儿癫痫患者不同时刻的头皮脑电信号具有一定的差异性，这种差异性往往较大而不能被忽略，而传统的婴幼儿癫痫高频振荡信号智能识别方法没有考虑到差异性的存在，直接构建智能识别模型，最终不同患者头皮脑电信号间的差异性会直接影响婴幼儿癫痫高频振荡信号智能识别模型的识别精度，同时导致模型的泛化能力较差。发明内容针对上述提到的技术问题。本申请的实施例的目的在于提出了一种基于元迁移学习的头皮脑电高频振荡信号识别方法及装置，来解决以上背景技术部分提到的技术问题。第一方面，本发明提供了一种基于元迁移学习的头皮脑电高频振荡信号识别方法，包括以下步骤：获取待识别的患者和其余患者在癫痫发作间期的头皮脑电信号，对头皮脑电信号进行预处理，得到头皮脑电信号片段，对待识别的患者的部分头皮脑电信号片段和其余患者的头皮脑电信号片段进行标注，并将标注后的其余患者的头皮脑电信号片段作为源域数据，将标注后的待识别的患者的头皮脑电信号片段作为目标域数据；构建端到端的卷积神经网络模型，端到端的卷积神经网络模型包括第一特征提取器和第一分类器，采用源域数据对端到端的卷积神经网络模型进行训练，得到经训练的端到端的卷积神经网络模型；构建元迁移学习模型，元迁移学习模型包括均含有第二特征提取器和第二分类器的基学习器和元学习器，第一特征提取器和第二特征提取器的结构相同，将经训练的端到端的卷积神经网络模型的第一特征提取器的参数作为基学习器的第二特征提取器的初始参数，将源域数据分为K个子集，将每个子集中的数据分为第一部分数据和第二部分数据；采用每个子集的第一部分数据对基学习器进行训练，将训练得到的基学习器的第二特征提取器的参数迁移至元学习器中，采用每个子集的第二部分数据对元学习器进行训练；重复训练K次，将第K次训练得到的元学习器的第二特征提取器的参数和第二分类器的参数迁移至基学习器中，得到优化后的基学习器；采用目标域数据对优化后的基学习器进行训练，得到微调后的基学习器；将待识别的患者的头皮脑电信号片段输入微调后的基学习器，输出得到头皮脑电信号片段是否为HFO信号的识别结果。作为优选，对头皮脑电信号进行预处理，具体包括：去除头皮脑电信号的噪声，得到降噪后的头皮脑电信号；对降噪后的头皮脑电信号中的80-250Hz频带使用128阶巴特沃斯带通FIR滤波器对每个时段各个通道的数据进行滤波，提取得到滤波后的头皮脑电信号；对滤波后的头皮脑电信号采用滑动窗口技术进行信号分段，得到切分后的头皮脑电信号段；将切分后的头皮脑电信号段映射到一个欧式空间，得到映射后的信号片段，对映射后的信号片段进行对齐和变换。作为优选，去除头皮脑电信号的噪声，具体包括：采用独立成分分析法去除头皮脑电信号中肌电、眼动、眨眼所导致的头皮脑电噪声；采用陷波滤波器去除工频干扰带来的人工噪声。作为优选，将切分后的头皮脑电信号段映射到一个欧式空间，得到映射后的信号片段，对映射后的信号片段进行对齐和变换，具体包括：计算切分后的头皮脑电信号段的平均协方差矩阵：；其中，为第i个切分后的头皮脑电信号段，n为切分后的头皮脑电信号段的总数；采用平均协方差矩阵对切分后的头皮脑电信号段进行数据对齐：；其中，为第i个头皮脑电信号片段。作为优选，第一特征提取器包括依次连接的第一卷积层、第二卷积层、第一池化层、第三卷积层和第二池化层，第一卷积层和第二卷积层分别提取头皮脑电信号片段的时域特征和空域特征，第一池化层和第二池化层均采用平均池化，将第一池化层的输出特征输入第三卷积层提取得到深度特征，将深度特征经过第二池化层，得到时频域深度特征，第一分类器包括依次连接的一个全连接层和一个Softmax层，时频域深度特征依次输入第一分类器，得到头皮脑电信号片段是否为HFO信号的二分类结果及其概率，取概率最大的分类结果作为识别结果。作为优选，第二分类器包括依次连接的三层全连接层，头皮脑电信号片段输入基学习器或元学习器，输出得到头皮脑电信号片段是否为HFO信号的标签。作为优选，元迁移学习模型的训练过程中基学习器的损失函数为：；其中，表示每个子集的第一部分数据对基学习器进行训练的过程所使用的交叉熵损失；元迁移学习模型的训练过程中元学习器的损失函数为：其中，表示每个子集的第二部分数据对元学习器进行训练的过程所使用的交叉熵损失。第二方面，本发明提供了一种基于元迁移学习的头皮脑电高频振荡信号识别装置，包括：预处理模块，被配置为获取待识别的患者和其余患者在癫痫发作间期的头皮脑电信号，对头皮脑电信号进行预处理，得到头皮脑电信号片段，对待识别的患者的部分头皮脑电信号片段和其余患者的头皮脑电信号片段进行标注，并将标注后的其余患者的头皮脑电信号片段作为源域数据，将标注后的待识别的患者的头皮脑电信号片段作为目标域数据；预训练模块，被配置为构建端到端的卷积神经网络模型，端到端的卷积神经网络模型包括第一特征提取器和第一分类器，采用源域数据对端到端的卷积神经网络模型进行训练，得到经训练的端到端的卷积神经网络模型；模型构建模块，被配置为构建元迁移学习模型，元迁移学习模型包括均含有第二特征提取器和第二分类器的基学习器和元学习器，第一特征提取器和第二特征提取器的结构相同，将经训练的端到端的卷积神经网络模型的第一特征提取器的参数作为基学习器的第二特征提取器的初始参数，将源域数据分为K个子集，将每个子集中的数据分为第一部分数据和第二部分数据；元迁移学习模块，被配置为采用每个子集的第一部分数据对基学习器进行训练，将训练得到的基学习器的第二特征提取器的参数迁移至元学习器中，采用每个子集的第二部分数据对元学习器进行训练；优化模块，被配置为重复训练K次，将第K次训练得到的元学习器的第二特征提取器的参数和第二分类器的参数迁移至基学习器中，得到优化后的基学习器；微调模块，被配置为采用目标域数据对优化后的基学习器进行训练，得到微调后的基学习器；识别模块，被配置为将待识别的患者的头皮脑电信号片段输入微调后的基学习器，输出得到头皮脑电信号片段是否为HFO信号的识别结果。第三方面，本发明提供了一种电子设备，包括一个或多个处理器；存储装置，用于存储一个或多个程序，当一个或多个程序被一个或多个处理器执行，使得一个或多个处理器实现如第一方面中任一实现方式描述的方法。第四方面，本发明提供了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如第一方面中任一实现方式描述的方法。相比于现有技术，本发明具有以下有益效果：本发明提出的基于元迁移学习的头皮脑电高频振荡信号识别方法采用端到端的卷积神经网络模型实现元迁移学习流程，可以自动化提取头皮脑电信号片段的特征，省略传统方式手工提取特征的步骤。本发明提出的基于元迁移学习的头皮脑电高频振荡信号识别方法中将经过滤波和降噪之后的不同患者的头皮脑电信号片段映射到一个欧式空间中去做对齐和变换，使得这些采自不同个体的头皮脑电信号段之间的分布比较相似，进而提高元迁移学习模型的泛化能力。本发明提出的基于元迁移学习的头皮脑电高频振荡信号识别方法结合了元学习技术的元迁移学习技术，可以通过记忆增强相关结构使得模型通过少量的目标域数据快速学习，进而提升源域和目标域的域适应能力。将该方法应用于跨个体的婴幼儿癫痫HFO信号智能识别任务，有助于提高智能识别模型的识别精度和泛化能力。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简要介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域的普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本申请的一个实施例可以应用于其中的示例性装置架构图；图2为本申请的实施例的基于元迁移学习的头皮脑电高频振荡信号识别方法的流程示意图；图3为本申请的实施例的基于元迁移学习的头皮脑电高频振荡信号识别方法的端到端的卷积神经网络模型的示意图；图4为本申请的实施例的基于元迁移学习的头皮脑电高频振荡信号识别方法的元学习迁移过程的示意图；图5为本申请的实施例的基于元迁移学习的头皮脑电高频振荡信号识别装置的示意图；图6是适于用来实现本申请实施例的电子设备的计算机装置的结构示意图。实施方式为了使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步地详细描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。图1示出了可以应用本申请实施例的基于元迁移学习的头皮脑电高频振荡信号识别方法或基于元迁移学习的头皮脑电高频振荡信号识别装置的示例性装置架构100。如图1所示，装置架构100可以包括终端设备101、102、103，网络104和服务器105。网络104用以在终端设备101、102、103和服务器105之间提供通信链路的介质。网络104可以包括各种连接类型，例如有线、无线通信链路或者光纤电缆等等。用户可以使用终端设备101、102、103通过网络104与服务器105交互，以接收或发送消息等。终端设备101、102、103上可以安装有各种应用，例如数据处理类应用、文件处理类应用等。终端设备101、102、103可以是硬件，也可以是软件。当终端设备101、102、103为硬件时，可以是各种电子设备，包括但不限于智能手机、平板电脑、膝上型便携计算机和台式计算机等等。当终端设备101、102、103为软件时，可以安装在上述所列举的电子设备中。其可以实现成多个软件或软件模块，也可以实现成单个软件或软件模块。在此不做具体限定。服务器105可以是提供各种服务的服务器，例如对终端设备101、102、103上传的文件或数据进行处理的后台数据处理服务器。后台数据处理服务器可以对获取的文件或数据进行处理，生成处理结果。需要说明的是，本申请实施例所提供的基于元迁移学习的头皮脑电高频振荡信号识别方法可以由服务器105执行，也可以由终端设备101、102、103执行，相应地，基于元迁移学习的头皮脑电高频振荡信号识别装置可以设置于服务器105中，也可以设置于终端设备101、102、103中。应该理解，图1中的终端设备、网络和服务器的数目仅仅是示意性的。根据实现需要，可以具有任意数目的终端设备、网络和服务器。在所处理的数据不需要从远程获取的情况下，上述装置架构可以不包括网络，而只需服务器或终端设备。图2示出了本申请的实施例提供的一种基于元迁移学习的头皮脑电高频振荡信号识别方法，包括以下步骤：S1，获取待识别的患者和其余患者在癫痫发作间期的头皮脑电信号，对头皮脑电信号进行预处理，得到头皮脑电信号片段，对待识别的患者的部分头皮脑电信号片段和其余患者的头皮脑电信号片段进行标注，并将标注后的其余患者的头皮脑电信号片段作为源域数据，将标注后的待识别的患者的头皮脑电信号片段作为目标域数据。具体的，使用医用头皮脑电设备采集婴幼儿患者癫痫发作间期的头皮脑电信号，具体的，本申请的实施例采用的医用头皮脑电设备是日本光电生产的32通道视频脑电图仪EEG-1200C，采样频率为1000Hz，脑电数据采集的标准是在癫痫发作间期进行无创的头皮视频脑电图连续监测至少三小时，包括至少以一个完整的清醒——睡眠——觉醒周期记录。源域数据和目标域数据是指两个不同婴幼儿癫痫患者的头皮脑电信号片段，具体的，源域数据为患者1至患者N的头皮脑电信号片段，目标域数据为患者N+1的头皮脑电信号片段，仅为少量样本。在具体的实施例中，对头皮脑电信号进行预处理，具体包括：去除头皮脑电信号的噪声，得到降噪后的头皮脑电信号；对降噪后的头皮脑电信号中的80-250Hz频带使用128阶巴特沃斯带通FIR滤波器对每个时段各个通道的数据进行滤波，提取得到滤波后的头皮脑电信号；对滤波后的头皮脑电信号采用滑动窗口技术进行信号分段，得到切分后的头皮脑电信号段；将切分后的头皮脑电信号段映射到一个欧式空间，得到映射后的信号片段，对映射后的信号片段进行对齐和变换。在具体的实施例中，去除头皮脑电信号的噪声，具体包括：采用独立成分分析法去除头皮脑电信号中肌电、眼动、眨眼所导致的头皮脑电噪声；采用陷波滤波器去除工频干扰带来的人工噪声。具体的，预处理过程中采用了独立成分分析法去除肌电、眼动、眨眼所导致的头皮脑电噪声，采用50Hz陷波滤波器去除工频干扰带来的人工噪声，对滤波段使用128阶巴特沃斯带通FIR滤波器对每个时段各个通道的数据进行滤波，最后得到头皮脑电信号片段。在具体的实施例中，将切分后的头皮脑电信号段映射到一个欧式空间，得到映射后的信号片段，对映射后的信号片段进行对齐和变换，具体包括：计算切分后的头皮脑电信号段的平均协方差矩阵：；其中，为第i个切分后的头皮脑电信号段，n为切分后的头皮脑电信号段的总数；采用平均协方差矩阵对切分后的头皮脑电信号段进行数据对齐：；其中，为第i个头皮脑电信号片段。具体的，对经过降噪和滤波之后得到的头皮脑电信号片段使用采用滑动窗口技术按照2秒不重叠地进行信号分段，切分后的头皮脑电信号段进行对齐。具体使用一种基于欧式空间的脑电数据对齐方法对切分后的头皮脑电信号段做归一化处理，使得模型的训练数据和测试数据的特征分布更为相似，具体来说将不同婴幼儿癫痫患者的头皮脑电信号段映射到一个欧式空间中，之后再对映射后的信号片段进行对齐和变换，使得这些采自不同个体的头皮脑电信号段之间的分布比较相似。将不同婴幼儿癫痫患者的头皮脑电信号段映射到欧式空间主要通过计算平均协方差矩阵来实现。S2，构建端到端的卷积神经网络模型，端到端的卷积神经网络模型包括第一特征提取器和第一分类器，采用源域数据对端到端的卷积神经网络模型进行训练，得到经训练的端到端的卷积神经网络模型。在具体的实施例中，第一特征提取器包括依次连接的第一卷积层、第二卷积层、第一池化层、第三卷积层和第二池化层，第一卷积层和第二卷积层分别提取头皮脑电信号片段的时域特征和空域特征，第一池化层和第二池化层均采用平均池化，将第一池化层的输出特征输入第三卷积层提取得到深度特征，将深度特征经过第二池化层，得到时频域深度特征，第一分类器包括依次连接的一个全连接层和一个Softmax层，时频域深度特征依次输入第一分类器，得到头皮脑电信号片段是否为HFO信号的二分类结果及其概率，取概率最大的分类结果作为识别结果。具体的，参考图3，端到端的卷积神经网络模型包括第一特征提取器和第一分类器，第一特征提取器以经过脑电对齐后的头皮脑电信号片段Nc×S作为输入，头皮脑电信号片段表示输入包括两个维度，其中Nc为脑电通道数，S为采样点个数。第一特征提取器包括依次连接的三个卷积层，第一卷积层用于提取头皮脑电信号片段的时域特征，第二卷积层用于提取头皮脑电信号片段的空域特征，将空域特征输入第一池化层，第一池化层的输出特征输入到第三卷积层中用于提取头皮脑电信号片段的深度特征，最后经过第二池化层得到固定维度的时频域深度特征。第二分类器包括一个全连接层和一个Softmax层，以第一特征提取器所提取的时频域深度特征为输入，其输出为二分类概率，取概率最大的分类为模型最终的识别结果。采用源域数据对端到端的卷积神经网络模型的第一特征提取器和第一分类器进行有监督的训练，得到能够对源域数据进行有效分类的经训练的端到端的卷积神经网络模型，为下一步针对元迁移学习模型提供初始参数。S3，构建元迁移学习模型，元迁移学习模型包括均含有第二特征提取器和第二分类器的基学习器和元学习器，第一特征提取器和第二特征提取器的结构相同，将经训练的端到端的卷积神经网络模型的第一特征提取器的参数作为基学习器的第二特征提取器的初始参数，将源域数据分为K个子集，将每个子集中的数据分为第一部分数据和第二部分数据。在具体的实施例中，第二分类器包括依次连接的三层全连接层，头皮脑电信号片段输入基学习器或元学习器，输出得到头皮脑电信号片段是否为HFO信号的标签。具体的，由于第一特征提取器和第二特征提取器的结构相同，因此可将经训练的端到端的卷积神经网络模型的第一特征提取器的参数输入到元迁移学习模型中，并作为基学习器的第二特征提取器的初始参数。元迁移学习的过程如图4所示。S4，采用每个子集的第一部分数据对基学习器进行训练，将训练得到的基学习器的第二特征提取器的参数迁移至元学习器中，采用每个子集的第二部分数据对元学习器进行训练。在具体的实施例中，元迁移学习模型的训练过程中基学习器的损失函数为：；其中，表示每个子集的第一部分数据对基学习器进行训练的过程所使用的交叉熵损失；元迁移学习模型的训练过程中元学习器的损失函数为：其中，表示每个子集的第二部分数据对元学习器进行训练的过程所使用的交叉熵损失。具体的，将源域数据分成个子集，记为。对于每个子集，进一步分割成和，取的数据对基学习器进行训练，并对第二特征提取器的参数进行优化更新。更新完成后，将训练得到的基学习器的第二特征提取器的参数迁移到元学习器中，即将训练得到的基学习器的第二特征提取器的参数更新至元学习器的第二特征提取器的参数中。再取的数据对元学习器进行训练，并对第二特征提取器的参数和第二分类器的参数进行优化更新。S5，重复训练K次，将第K次训练得到的元学习器的第二特征提取器的参数和第二分类器的参数迁移至基学习器中，得到优化后的基学习器。具体的，重复步骤S4完成K次训练，最终将第K次训练之后的元学习器的第二特征提取器的参数和第二分类器的参数迁移至基学习器中，即将训练得到的元学习器的第二特征提取器的参数和第二分类器的参数更新至基学习器的第二特征提取器的参数和第二分类器的参数中。S6，采用目标域数据对优化后的基学习器进行训练，得到微调后的基学习器。具体的，在此阶段，通过学习少量目标域数据，快速提升元迁移学习模型的域适应能力，之后再通过对优化后的基学习器不断优化参数，得到微调后的基学习器，提升跨个体的头皮脑电HFO信号智能识别算法的识别精度和泛化能力。多源异构场景指的是目标域数据和源域数据具有不同的特征分布。由于头皮脑电信号的非平稳性，不同婴幼儿癫痫患者的头皮脑电信号乃至同一婴幼儿癫痫患者不同时刻的头皮脑电信号具有一定的差异性，这种差异性往往较大而不能被忽略，这个问题在当前基于人工智能的HFO智能识别算法中，通常会考虑迁移学习的方法解决。然而目前关于迁移学习的研究主要集中在同构场景，即源域数据和目标域数据具有相同的特征，而上述头皮脑电信号片段的跨个体智能识别问题场景实际是个多源异构场景，即目标域和源域具有不同的特征分布。因此需要采用少量的目标域数据对优化后的基学习器进行微调，进一步优化参数，进而实现跨个体婴幼儿癫痫头皮脑电HFO的稳定识别。S7，将待识别的患者的头皮脑电信号片段输入微调后的基学习器，输出得到头皮脑电信号片段是否为HFO信号的识别结果。具体的，通过以上步骤训练得到微调后的基学习器即可用于对待识别的患者的头皮脑电信号片段进行分类，可准确的识别得到头皮脑电信号片段是否为HFO信号的识别结果。进一步参考图5，作为对上述各图所示方法的实现，本申请提供了一种基于元迁移学习的头皮脑电高频振荡信号识别装置的一个实施例，该装置实施例与图2所示的方法实施例相对应，该装置具体可以应用于各种电子设备中。本申请实施例提供了一种基于元迁移学习的头皮脑电高频振荡信号识别装置，包括：预处理模块1，被配置为获取待识别的患者和其余患者在癫痫发作间期的头皮脑电信号，对头皮脑电信号进行预处理，得到头皮脑电信号片段，对待识别的患者的部分头皮脑电信号片段和其余患者的头皮脑电信号片段进行标注，并将标注后的其余患者的头皮脑电信号片段作为源域数据，将标注后的待识别的患者的头皮脑电信号片段作为目标域数据；预训练模块2，被配置为构建端到端的卷积神经网络模型，端到端的卷积神经网络模型包括第一特征提取器和第一分类器，采用源域数据对端到端的卷积神经网络模型进行训练，得到经训练的端到端的卷积神经网络模型；模型构建模块3，被配置为构建元迁移学习模型，元迁移学习模型包括均含有第二特征提取器和第二分类器的基学习器和元学习器，第一特征提取器和第二特征提取器的结构相同，将经训练的端到端的卷积神经网络模型的第一特征提取器的参数作为基学习器的第二特征提取器的初始参数，将源域数据分为K个子集，将每个子集中的数据分为第一部分数据和第二部分数据；元迁移学习模块4，被配置为采用每个子集的第一部分数据对基学习器进行训练，将训练得到的基学习器的第二特征提取器的参数迁移至元学习器中，采用每个子集的第二部分数据对元学习器进行训练；优化模块5，被配置为重复训练K次，将第K次训练得到的元学习器的第二特征提取器的参数和第二分类器的参数迁移至基学习器中，得到优化后的基学习器；微调模块6，被配置为采用目标域数据对优化后的基学习器进行训练，得到微调后的基学习器；识别模块7，被配置为将待识别的患者的头皮脑电信号片段输入微调后的基学习器，输出得到头皮脑电信号片段是否为HFO信号的识别结果。下面参考图6，其示出了适于用来实现本申请实施例的电子设备的计算机装置600的结构示意图。图6示出的电子设备仅仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图6所示，计算机装置600包括中央处理单元601和图形处理器602，其可以根据存储在只读存储器603中的程序或者从存储部分609加载到随机访问存储器604中的程序而执行各种适当的动作和处理。在RAM 604中，还存储有装置600操作所需的各种程序和数据。CPU 601、GPU602、ROM 603以及RAM 604通过总线605彼此相连。输入/输出接口606也连接至总线605。以下部件连接至I/O接口606：包括键盘、鼠标等的输入部分607；包括诸如、液晶显示器等以及扬声器等的输出部分608；包括硬盘等的存储部分609；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分610。通信部分610经由诸如因特网的网络执行通信处理。驱动器611也可以根据需要连接至I/O接口606。可拆卸介质612，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器611上，以便于从其上读出的计算机程序根据需要被安装入存储部分609。特别地，根据本公开的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本公开的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分610从网络上被下载和安装，和/或从可拆卸介质612被安装。在该计算机程序被中央处理单元601和图形处理器602执行时，执行本申请的方法中限定的上述功能。需要说明的是，本申请所述的计算机可读介质可以是计算机可读信号介质或者计算机可读介质或者是上述两者的任意组合。计算机可读介质例如可以是——但不限于——电、磁、光、电磁、红外线或半导体的装置、装置或器件，或者任意以上的组合。计算机可读介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件或者上述的任意合适的组合。在本申请中，计算机可读介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行装置、装置或者器件使用或者与其结合使用。而在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行装置、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、电线、光缆、RF等等，或者上述的任意合适的组合。可以以一种或多种程序设计语言或其组合来编写用于执行本申请的操作的计算机程序代码，所述程序设计语言包括面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，也可以连接到外部计算机。附图中的流程图和框图，图示了按照本申请各种实施例的装置、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段或代码的一部分，该模块、程序段或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的装置来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本申请实施例中所涉及到的模块可以通过软件的方式实现，也可以通过硬件的方式来实现。所描述的模块也可以设置在处理器中。作为另一方面，本申请还提供了一种计算机可读介质，该计算机可读介质可以是上述实施例中描述的电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被该电子设备执行时，使得该电子设备：获取待识别的患者和其余患者在癫痫发作间期的头皮脑电信号，对头皮脑电信号进行预处理，得到头皮脑电信号片段，对待识别的患者的部分头皮脑电信号片段和其余患者的头皮脑电信号片段进行标注，并将标注后的其余患者的头皮脑电信号片段作为源域数据，将标注后的待识别的患者的头皮脑电信号片段作为目标域数据；构建端到端的卷积神经网络模型，端到端的卷积神经网络模型包括第一特征提取器和第一分类器，采用源域数据对端到端的卷积神经网络模型进行训练，得到经训练的端到端的卷积神经网络模型；构建元迁移学习模型，元迁移学习模型包括均含有第二特征提取器和第二分类器的基学习器和元学习器，第一特征提取器和第二特征提取器的结构相同，将经训练的端到端的卷积神经网络模型的第一特征提取器的参数作为基学习器的第二特征提取器的初始参数，将源域数据分为K个子集，将每个子集中的数据分为第一部分数据和第二部分数据；采用每个子集的第一部分数据对基学习器进行训练，将训练得到的基学习器的第二特征提取器的参数迁移至元学习器中，采用每个子集的第二部分数据对元学习器进行训练；重复训练K次，将第K次训练得到的元学习器的第二特征提取器的参数和第二分类器的参数迁移至基学习器中，得到优化后的基学习器；采用目标域数据对优化后的基学习器进行训练，得到微调后的基学习器；将待识别的患者的头皮脑电信号片段输入微调后的基学习器，输出得到头皮脑电信号片段是否为HFO信号的识别结果。以上描述仅为本申请的较佳实施例以及对所运用技术原理的说明。本领域技术人员应当理解，本申请中所涉及的发明范围，并不限于上述技术特征的特定组合而成的技术方案，同时也应涵盖在不脱离上述发明构思的情况下，由上述技术特征或其等同特征进行任意组合而形成的其它技术方案。例如上述特征与本申请中公开的具有类似功能的技术特征进行互相替换而形成的技术方案。
