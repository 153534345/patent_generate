标题title
一种横向甘蔗种植机供种机构的自动控制方法及系统
摘要abst
本发明提供一种横向甘蔗种植机供种机构的自动控制方法及系统，属于农业机械自动化领域，方法包括如下步骤：用传感器检测判断集蔗箱蔗量和输送状态，并适时控制液压缸和液压马达的运动状态来改变供种箱的供种量，从而保证集蔗箱的种量平衡，达到有序播种。但若在供种中，检测到供种箱种量需调整时，则及时控制液压提升装置动作，从而使得箱内保持充足的蔗量储备，更好保证其对集蔗箱的连续供种工作。特别的，在供种箱蔗量严重不足时，还可通过报警模块提醒人工补蔗。通过供种箱和集蔗箱的协同控制，实现了有序连续供种，而且通过供种机构的自动控制，提高种植机的工作效率并减少了人工劳动强度，实现自动化和精准化种植。
权利要求书clms
1.一种横向甘蔗种植机供种机构的自动控制方法，其特征在于，所述方法包括如下步骤：步骤1：采用超声波传感器同时获取供种箱两出口的蔗种厚度及运动信息，并判断蔗种量状态是否需要调整；步骤2：如需要调整，则对两个传感器的数据比较，并保留较小的数值；步骤3：选取若干次实验后得到高低临界厚度数据作为供种箱的蔗种厚度阈值参考，若蔗种量大于高临界阈值，则液压缸收回，若不足于高阈值，则液压缸动作使得蔗种状态更加集中，若蔗种量不足于低阈值，则蜂鸣器报警，并人工对供种箱进行大量补种，同时基于前期拟合的提升高度与蔗量厚度关系式，将实测超声波所测蔗种厚度代入关系式得到提升高度，用于与实测激光传感器所测液压缸提升高度比较，作为反馈量，以此来检测提升高度是否达标；步骤4：若供种箱蔗量不需要调整，判断集蔗箱蔗量是否需要调整；步骤5：若集蔗箱种量需要调整，则用双光电传感器做高低阈值去直接获取箱内蔗种量状态和输送状态；步骤6：若箱内蔗种量超过高阈值，则液压马达停止工作，切断供种箱对其的蔗种供应，若蔗种量不足于低阈值，则液压马达动作，恢复蔗种供应。步骤7：若集蔗箱蔗量不需要改变，则继续步骤1。2.根据权利要求1所述的一种横向甘蔗种植机供种机构的自动控制方法，其特征在于：步骤5中，在实现对集蔗箱蔗种识别时，首先，将甘蔗的有无转换成光电传感器高低电平的跳变信号，其次，由于是双行播种，具有两个独立工作的集蔗箱，两箱并行识别工作。3.根据权利要求2所述的一种横向甘蔗种植机供种机构的自动控制方法，其特征在于：步骤6中，在实现对播种输送液压马达调整时，对于单个集蔗箱，实时获取蔗种量之后，采用光电开关来实现阈值控制，具体分为以下情况：一是若是超过高阈值，则液压马达停止转动，二是若是低于低阈值，则液压马达又重新转动。4.根据权利要求3所述的一种横向甘蔗种植机供种机构的自动控制方法，其特征在于：在实现液压马达的调整过程中，提高供种输送回路的可靠性，采用双控制方案，具体如下：一是用电磁阀实现对马达的自动控制，二是用手动阀实现控制，同时，两方案的关系是自动控制为主，在电磁阀出现故障等特殊情况下，才启动手动控制。5.根据权利要求4所述的一种横向甘蔗种植机供种机构的自动控制方法，其特征在于：步骤1中，在对供种箱两分支出口蔗种识别中，采用若干个超声波传感器测量和传感器若干次测量的方法，并且对于原始数据采用了最小二乘法处理。6.根据权利要求1所述的一种横向甘蔗种植机供种机构的自动控制方法，其特征在于：步骤3中，在实现对动力机构液压缸调整的过程中，采用超声波传感器实时获取蔗种量，采用阈值法来进行控制，由于箱体的出口是两分支，在阈值判断之前，首先，对两路数据进行对比，并选择更具有代表性的较小数据，然后进行阈值区分判断，具体分为以下两种情况：一是若是低于高阈值，则提升液压缸供种，使得蔗种集中在箱体前部，二是若是低于低阈值，则报警模块报警提醒人工对供种箱补充蔗种。7.根据权利要求1所述的一种横向甘蔗种植机供种机构的自动控制方法，其特征在于：步骤6中，动力执行机构液压马达对蔗种量的调整中，实时监测集蔗箱内种量是否达到阈值，若超出最大阈值，则停止转动，以免造成蔗种量超量，若不足最小阈值，则恢复转动，以免造成漏种现象，影响种植质量。8.根据权利要求1-7任意一项所述的一种横向甘蔗种植机供种机构的自动控制方法的系统，其特征在于：包括：超声波传感器，用于获取供种箱蔗种量信息；光电传感器，用于获取集蔗箱蔗种量信息；激光传感器，用于获取液压缸行程信息；控制单元，用于接收到的各个传感器信息控制对应的执行单元工作；执行单元，用于执行集蔗箱和供种箱的蔗种量调整，具体过程如下：首先设置MOS触发开关，用于接收来自控制单元的电平信号，设置在供种箱上的液压升降装置，用于完成供种箱的提升和收回，设置在供种箱与集蔗箱间的传送链上的液压马达，用于完成蔗种的输送。9.根据权利要求8所述的一种横向甘蔗种植机供种机构的自动控制方法的系统，其特征在于：控制单元实时获取传感器的数据信息，根据蔗种量多少的信息通过PID处理后输出频率不同的PWM信号，通过MOS触发开关驱动模块进行脉冲调制，在电感作用下控制电磁铁的电流大小从而改变电磁阀的开度，来控制液压缸的运行速度和液压马达的工作转速。10.根据权利要求8所述的一种横向甘蔗种植机供种机构的自动控制方法的系统，其特征在于：还包括安装于司机驾驶室的蔗种状态量实时检测系统，可实时地将种植机工作状态、工作环境温度、供种箱和集蔗箱的蔗种量状态反馈于可触摸液晶屏显示装置上，通过自动控制系统可实现实时检测与调整控制，并可以通过触摸屏虚拟按键控制所需要的工作。
说明书desc
技术领域本发明涉及农业机械自动化领域，尤其涉及一种横向甘蔗种植机供种机构的自动控制方法及系统。背景技术广西是我国重要的糖料蔗生产基地，但受到工业成本高、人工成本高、市场竞争力下降等因素的影响，甘蔗种植面积逐年下降。同时，甘蔗种植作为生产过程中劳动强度最大的环节之一，目前机械化和智能化水平较低，农机的适应性和推广性也比较差。而技术现状是：在广西现存的预切种式甘蔗横向种植机只能依靠人工播种，无法实现连续有序供种需求及供种过程的自动化控制。所以，如何实现“良种良法”种植和提高种植过程中的机械自动化程度，从而更好实现甘蔗规模化和精准化种植是目前所急需考虑的问题。现有横向甘蔗种植机中普遍存在供种和播种不协同、漏种多、播种不精准等问题，不仅难以实现连续有序供种，且在供种过程仅依靠人工操作，工作效率低，无法实现自动化和精准化种植。发明内容本发明的目的在于提供一种横向甘蔗种植机供种机构的自动控制方法及系统，解决现有的技术问题。为了实现上述目的，本发明采用的技术方案如下：一种横向甘蔗种植机供种机构的自动控制方法，所述方法包括如下步骤：步骤1：采用超声波传感器同时获取获取供种箱两出口的蔗种厚度及运动信息，并判断蔗种量状态是否需要调整；步骤2：如需要调整，则对两个传感器的数据比较，并保留较小的数值；步骤3：选取若干次实验后得到高低临界厚度数据作为供种箱的蔗种厚度阈值参考，若蔗种量大于高临界阈值，则液压缸收回，若不足于高阈值，则液压缸动作使得蔗种状态更加集中，若蔗种量不足于低阈值，则蜂鸣器报警，并人工对供种箱进行大量补种，同时基于前期拟合的提升高度与蔗量厚度关系式，将实测超声波所测蔗种厚度代入关系式得到提升高度，用于与实测激光传感器所测液压缸提升高度比较，作为反馈量，以此来检测提升高度是否达标；步骤4：若供种箱蔗量不需要调整，判断集蔗箱蔗量是否需要调整；步骤5：若集蔗箱种量需要调整，则用双光电传感器做高低阈值去直接获取箱内蔗种量状态和输送状态；步骤6：若箱内蔗种量超过高阈值，则液压马达停止工作，切断供种箱对其的蔗种供应，若蔗种量不足于低阈值，则液压马达动作，恢复蔗种供应。步骤7：若集蔗箱蔗量不需要改变，则继续步骤1。进一步地，步骤5中，在实现对集蔗箱蔗种识别时，首先，将甘蔗的有无转换成光电传感器高低电平的跳变信号，其次，由于是双行播种，具有两个独立工作的集蔗箱，两箱并行识别工作。进一步地，步骤6中，在实现对播种输送液压马达调整时，对于单个集蔗箱，实时获取蔗种量之后，采用光电开关来实现阈值控制，具体分为以下情况：一是若是超过高阈值，则液压马达停止转动，二是若是低于低阈值，则液压马达又重新转动。进一步地，在实现液压马达的调整过程中，提高供种输送回路的可靠性，采用双控制方案，具体如下：一是用电磁阀实现对马达的自动控制，二是用手动阀实现控制，同时，两方案的关系是自动控制为主，在电磁阀出现故障等特殊情况下，才启动手动控制。进一步地，步骤1中，在对供种箱两分支出口蔗种识别中，采用若干个超声波传感器测量和传感器若干次测量的方法，并且对于原始数据采用了最小二乘法处理。进一步地，步骤3中，在实现对动力机构液压缸调整的过程中，采用超声波传感器实时获取蔗种量，采用阈值法来进行控制，由于箱体的出口是两分支，在阈值判断之前，首先，对两路数据进行对比，并选择更具有代表性的较小数据，然后进行阈值区分判断，具体分为以下两种情况：一是若是低于高阈值，则提升液压缸供种，使得蔗种集中在箱体前部，二是若是低于低阈值，则报警模块报警提醒人工对供种箱补充蔗种。进一步地，步骤6中，动力执行机构液压马达对蔗种量的调整中，实时监测集蔗箱内种量是否达到阈值，若超出最大阈值，则停止转动，以免造成蔗种量过多，，若不足最小阈值，则恢复转动，以免造成漏种现象，影响种植质量。一种横向甘蔗种植机供种机构的自动控制方法的系统，包括：超声波传感器，用于获取供种箱蔗种量信息；光电传感器，用于获取集蔗箱蔗种量信息；激光传感器，用于获取液压缸行程信息；控制单元，用于接收到的各个传感器信息控制对应的执行单元工作；执行单元，用于执行集蔗箱和供种箱的蔗种量调整，具体过程如下：首先设置MOS触发开关，用于接收来自控制单元的电平信号，设置在供种箱上的液压升降装置，用于完成供种箱的提升和收回，设置在供种箱与集蔗箱间的传送链上的液压马达，用于完成蔗种的输送。进一步地，控制单元实时获取传感器的数据信息，根据蔗种量多少的信息通过PID处理后输出频率不同的PWM信号，通过MOS触发开关驱动模块进行脉冲调制，在电感作用下控制电磁铁的电流大小从而改变电磁阀的开度，来控制液压缸的运行速度和液压马达的工作转速。进一步地，还包括安装于司机驾驶室的蔗种状态量实时检测系统，可实时地将种植机工作状态、工作环境温度、供种箱和集蔗箱的蔗种量状态反馈于可触摸液晶屏显示装置上，通过自动控制系统可实现实时检测与调整控制，并可以通过触摸屏虚拟按键控制所需要的工作。本发明由于采用了上述技术方案，具有以下有益效果：1.本发明的横向甘蔗种植机供种机构的自动控制系统，首先，以激光传感器作为液压缸行程的反映，实时监测液压缸的伸长量或者收缩量。以超声波和光电传感器作为蔗种数量的反映，实时检测并向自动控制系统传递蔗种数量信息；然后，自动控制系统通过调控平衡液压系统，进而调节安装在供种箱的液压缸和集蔗箱的液压马达，完成提升、收回与转动、停止动作，从而保证播种过程的连续有序。2.本发明的横向甘蔗种植机供种机构的自动控制方法，对于集蔗箱和供种箱蔗种数量状态检测问题，本发明将数量信息转化为厚度信息，得到了更为直观的效果。同时，由于车身在工作时包括一些振动等干扰因素，会造成超声波传感器在获取数据时产生误差，本发明采用卡尔曼滤波算法可以很大程度上减少由于噪声产生的误差。3.本发明的横向甘蔗种植机供种机构的自动控制系统，提高了播种过程中的连续有序性，很大程度上提升了横向甘蔗种植机的作业效率和准确性，减少了人工和资金的投入，同时弥补了当前市场上甘蔗种植机的不足，满足了实际的使用要求。附图说明图1是本发明横向甘蔗种植机供种机构的自动控制流程图；图2是本发明自动控制系统结构框图；图3是本发明执行单元模块结构框图；图4是本发明横向甘蔗种植机简图；图5是本发明供种机构部分简图；图6是本发明液压缸提升高度与蔗种厚度变化关系图。图中标号：1-供种箱、2-液压缸、3-传送链、4-集蔗箱、5-地轮6-激光传感器、7-第一光电传感器、8-第二光电传感器、9第一超声波传感器、10第二超声波传感器、11-液压马达、12-第一供种箱两分支出口、13-第二供种箱两分支出口、14-第一供种传送链、15-第二供种传送链。具体实施方式为使本发明的目的、技术方案及优点更加清楚明白，以下参照附图并举出优选实施例，对本发明进一步详细说明。然而，需要说明的是，说明书中列出的许多细节仅仅是为了使读者对本发明的一个或多个方面有一个透彻的理解，即便没有这些特定的细节也可以实现本发明的这些方面。如图1所示，一种横向甘蔗种植机供种机构的自动控制方法，包括如下步骤：步骤1：在获取供种箱1甘蔗量状态信息时，为了更好的数据准确性，除了对数据多次测量求取平均值以外，在此还采用了动态卡尔曼滤波算法。它的思想是：用前一时刻的最优值估计当前时刻的结果，再结合当前时刻的估计值和真实值得到当前的最优解。步骤2：根据获取的蔗种量信息，判断是否需要对蔗量进行调整。若蔗量厚度超出高阈值则不需调整。若处于高阈值与低阈值之间，则需要执行机构液压缸2提升动作。若低于低阈值，则需要立即发出报警声来提醒人工及时补种。步骤3：在检测到供种箱1蔗量状态不需要调整后，则进行集蔗箱4蔗量状态的判断。若需要调整蔗种数量，则控制执行机构液压马达需要动作。步骤4：若蔗量厚度超过高阈值，则蔗量充足，则马达11需要减速至停转，否则会破坏箱内蔗种运动的平衡和对蔗种的有序性造成影响。若在低阈值之下，则需要马达11恢复转动，保证蔗种量的充足。步骤5：若蔗种箱4蔗种状态不需要调整，则转步骤1)，直至完成播种过程或转换人工操作模式。总体来说，供种箱和集蔗箱的工作是协同的，前者的工作提供了蔗种的所有来源，是供种工作成功完成的前提。后者作为播种的最后环节，直接决定了播种的质量和效率。同时，显而易见的是，二者的工作环环相扣，互为因果，缺一不可，都对连续供种有序的实现至关重要。一种横向甘蔗种植机供种机构的自动控制方法的系统，包括：激光传感器6、光电传感器7、超声波传感器9、控制单元、执行机构、蔗种数量状态监测系统、红外遥控装置和危险报警装置。控制单元，用于获取多个传感器的数据信息，对数据进行处理分析，并传递相应信号给执行单元执行相关操作。本实施例中控制单元中央处理器采用STM32F103系列芯片，该芯片配置有144个引脚，并且大部分I/O口兼容5V电压，具有强大的数据处理分析能力和工作稳定可靠性。本发明中采用中央处理器实时获取传感器的数据信息，并传递给液压执行单元，从而完成供种箱和液压马达的相关动作，实现供种功能模块的自动控制。执行单元包括MOS触发开关驱动模块，用于接收控制单元的电平变化情况。安装在供种箱上的液压缸2升降装置，用于完成供种箱的提升和收回；安装在供种箱与集蔗箱间的输送链上的液压马达11，用于完成蔗种的输送。蔗种量状态实时监测系统安装于司机驾驶室内，可实时地将种植机工作状态、工作环境温度、供种箱和集蔗箱的蔗种量状态反馈于可触摸液晶屏显示装置上，这有利于操作人员更好掌握播种机供种模块的工作情况，以便于随时操作和在特殊情况下及时做出调整。超声波传感器9、10安装在供种箱1上侧，用于检测测箱内的蔗种量和运动状态；激光传感器6安装在供种箱的液压缸2上，用于在箱内蔗种量发生变化从而引发液压缸动作时，实时监测行程，保证动作的准确性，从而更好实现连续供种功能；光电传感器7、8安装在集蔗箱4上，用于监测箱内蔗种量状态的变化。红外遥控装置，包括红外线接收模块和远程红外遥控器，设置不同的按键情况进行供种模块的虚拟远程控制。危险报警模块，由蜂鸣器报警模块配合蔗种数量状态监测系统组成，当检测到蔗种数量严重不足时，将发出鸣响提醒人工及时补种。超声波测量公式：H＝T1×340/2H为最终距离，单位为米。T1为传感器的发送到接收到所用的时间，单位为秒。液压缸提升高度与蔗种厚度关系式：y＝0.0005202x4-0.005271x3+0.1808x2-2.14x+14.08其中，x为液压缸2提升高度，y为供种箱1蔗种厚度，单位均为厘米。控制单元实时获取传感器的数据信息，根据蔗种量多少的信息通过PID处理后输出频率不同的PWM信号，通过MOS触发开关驱动模块进行脉冲调制，在电感作用下控制电磁铁的电流大小从而改变电磁阀的开度，来控制液压缸2的运行速度和液压马达11的工作转速。PID控制PWM波的算法原理如下：其中，PIDOUT代表上次PID运算后的结果，PTDP为比例部分，PTDI为积分部分，PTDD为微分部分，e0为本次误差。本次误差等于设置厚度距离减去当前厚度。e1为上次误差，e2为上上次误差，K是运算放大系数。上次PID的运算结果加上当前计算增量得出当前PID运算的结果，除以放大系数K得到PWM的控制参数，根据实际情况对PID运算结果进行限幅，以提高供种箱工作的可靠性和稳定性。执行单元包括液压系统以及MOS触发开关驱动模块。自动控制系统通过驱动大功率MOS触发开关驱动模块来控制各个三位四通电磁阀和两个二位三通比例换向阀的开闭，从而实现供种模块液压系统的控制。自动控制过程如下：当横向甘蔗种植机准备工作时，各个支路的三位六通手动阀和三位四通电磁换向阀均处于中位机能，两位三通电磁阀处于常闭状态，此时所有的液压缸和液压马达均没有动作。以供种箱1蔗量厚度处理高低阈值之间和集蔗箱4蔗量严重不足情况为例，说明自动控制系统工作过程和原理。首先，自动控制系统打开液压泵，通过多个传感器的数据进行结算后发出控制指令，接着是三位六通手动阀工作和三位四通电磁换向阀得电，然后对于供种箱工作来说，一号二位三通电磁阀左位得电，执行液压缸的提升动作。接着，当收到液压缸外伸限位开关电平信号时，一号电磁阀失电，二号二位三通电磁阀左位得电，进行液压缸的收回动作，当收到液压缸2收缩限位开关电平信号时，二号电磁阀失电，标志着收回工作的完成。同时，集蔗箱的工作过程如下：当三位四通电磁阀左位得电时，两个输送液压马达实现正转，完成供种箱1对集蔗箱4蔗种的持续供应。当收到高位光电传感器7信号时，表面此时集蔗箱甘蔗量已经满足运动状态和蔗种有序的最大量，这时三位四通电磁阀失电，马达停止转动。可触摸液晶屏装置集成与电路板上，把经过中心处理器芯片解算过的种植机工作状态、工作环境温度、供种箱1和集蔗箱4的蔗种量状态等参数反馈于显示装置上，并可以通过触摸屏虚拟按键操作各个液压执行元件工作。自动控制系统原理如图2所示，通过解算超声波9、10检测出的供种箱蔗种量厚度和状态变化信息，通过解算光电传感器7、8检测出的集蔗箱4蔗种量厚度和运动状态信息，中心处理器、可触摸液晶屏显示装置、红外遥控信号接收装置和声光报警模块集成在一块电路板上，声音报警模块受到自动控制系统的控制，当监测到供种箱1蔗种量严重不足时，蜂鸣器发声提示操作人员立即实施大量补种的操作。限位开关信号模块主要是采集供种液压缸举升回路的液压缸极限位置的相关信息，即检测液压缸2是否处于外伸的极限位置或者收缩的极限位置。当外伸或收缩到相应的极限位置的时候，对应的光电限位开关会传递出相应的电平信号，电平信号经过模数转换变成数字信号，反馈给中心处理器，辅助供种箱的种量调整工作。图6中，X为提升高度Y为蔗种厚度量。以上所述仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以作出若干改进和润饰，这些改进和润饰也应视为本发明的保护范围。
