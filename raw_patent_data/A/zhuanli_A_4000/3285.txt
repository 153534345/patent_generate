标题title
一种房颤信号生成方法及系统
摘要abst
本发明公开了一种房颤信号生成方法及系统，包括以下步骤：获取采样率与输入长度相同的房颤信号和正常心电信号，并进行预处理；分别制作房颤信号和正常心电信号中T波终点至下一个心电周期的QRS波起点位置的标签；利用标签对房颤信号的房颤波和正常心电信号中相应位置依次进行截取；计算处理后的正常心电信号需要插入的房颤波数量，从n条房颤波中随机挑选所需数量房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。本发明生成的房颤信号可信度高，能够满足现阶段心电信号自动分析模型的训练需求，有效地缓解房颤心电信号数据量不足、数据量不均衡等相关问题。
权利要求书clms
1.一种房颤信号生成方法，其特征在于：包括以下步骤：S1：获取采样率与输入长度相同的房颤信号和正常心电信号，并进行预处理；S2：分别制作房颤信号和正常心电信号中T波终点至下一个心电周期的QRS波起点位置的标签，其中，房颤信号对应标签记为标签1，正常心电信号对应标签记为标签2；S3：利用标签1对房颤信号中相应位置的房颤波依次进行截取，得到n条房颤波；S4：利用标签2对正常心电信号中相应位置的心电波段进行截断，并将截断位置置零，得到处理后的正常心电信号；S5：计算处理后的正常心电信号需要插入的房颤波数量，从n条房颤波中随机挑选所需数量房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。2.如权利要求1所述的一种房颤信号生成方法，其特征在于：所述步骤S1中对房颤信号和正常心电信号分别进行预处理，所述预处理包括采用二阶巴特沃斯高通滤波器滤除信号中基线漂移和噪声。3.如权利要求1所述的一种房颤信号生成方法，其特征在于：所述步骤S2具体包括以下步骤：S21：利用检波算法分别生成房颤信号对应的QRS波标签a和T波标签b；S22：对齐标签a和标签b，标签b内T波终点至标签a内对应下一相邻的QRS波起点位置，标签置1，其他位置置零，生成标签1；S23：利用检波算法分别生成正常心电信号对应的QRS波标签c和T波标签d；S24：对齐标签c和标签d，标签d内T波终点至标签c内对应下一相邻的QRS波起点位置，标签置零，其他位置置1，生成标签2。4.如权利要求1所述的一种房颤信号生成方法，其特征在于：所述步骤S5具体包括以下步骤：计算处理后的正常心电信号需要插入的房颤波数量m，从n条房颤波中随机挑选m条房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。5.如权利要求1所述的一种房颤信号生成方法，其特征在于：还包括步骤：S6：通过移动平均滤波器对合成的房颤信号做平滑处理，消除拼接突兀。6.如权利要求5所述的一种房颤信号生成方法，其特征在于：还包括步骤：S7：构建多个房颤与非房颤的二分类模型，将合成后的房颤信号输入模型进行判别，循环测试，剔除模型无法识别的房颤信号，保留剩余的有效房颤信号。7.一种房颤信号生成系统，其特征在于：包括：采集单元，用于获取采样率与输入长度相同的房颤信号和正常心电信号，并进行预处理；标签制作单元，用于分别制作房颤信号和正常心电信号中T波终点至下一个心电周期的QRS波起点位置的标签，其中，房颤信号对应标签记为标签1，正常心电信号对应标签记为标签2；信号处理单元，用于利用标签1对房颤信号中相应位置的房颤波依次进行截取，得到n条房颤波；还用于利用标签2对正常心电信号中相应位置的心电波段进行截断，并将截断位置置零，得到处理后的正常心电信号；信号合成单元，计算处理后的正常心电信号需要插入的房颤波数量，从n条房颤波中随机挑选所需数量房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。8.一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于：所述处理器执行所述程序时实现权利要求1到5任一项所述方法的步骤。9.一种计算机可读存储介质，其上存储有计算机程序，其特征在于：该程序被处理器执行时实现权利要求1到5任一项所述方法的步骤。10.一种处理器，其特征在于：所述处理器用于运行程序，其中，所述程序运行时执行权利要求1到5任一项所述的方法。
说明书desc
技术领域本发明涉及心电图检测领域，具体涉及一种房颤信号生成方法及系统。背景技术心电图记录了被检测到的心肌细胞活动产生的电流，用一维信号来表示心脏活动产生电信号变化的情况。在正常心电周期中，一个典型的心电图主要是由P波、Q波、R波、S波和T波构成，以及在某些导联中可能会出现的U波，其中P波和QRS复合波群分别对应心房的去极化和心室的去极化过程，T波对应心室的复极化过程，具体的一个心电周期的波形如图2所示。目前，临床上主要使用的是标准心电图系统，一共有12个导联，包括6个肢体导联和6个胸导联。房颤是临床上比较常见的一种典型的持续性心律失常，当心脏的心房不协调活动而导致心房机械功能恶化时会产生房颤。心电图是房颤检测的主要方法，可以检测和识别不同类型的心律失常。房颤心电图的主要特征是P波的消失或RR间期的绝对不规则性。房颤的潜在危害非常大，很可能并发很多恶性疾病，例如脑动脉栓塞、心力衰竭等，严重可引发猝死，对人类的生命和健康有着极大的威胁，所以及时发现并治疗房颤有重要的意义。随着人工智能的飞速发展，基于大规模心电数据进行网络学习训练产生心电信号自动分析模型，已经取得了比传统算法更好的效果。但是，在网络学习训练过程中，充足的数据量是非常重要的，然而在实践和研究的过程中，数据量不足是非常常见的，而且心电信号的采集和获取耗时耗材且有效性低，无法满足现阶段网络模型学习训练的需求，严重阻碍了相关算法的发展与应用。近年来，已经有一些应用方法来克服这一难题，数据增强是最常用的传统方法，包括对信号的平移操作或者加入随机噪声等。但是这种简单的修改只能获得少量的附加信息，而且容易发生过拟合的现象。所以，合成高质量且有效的心电信号具有十分重要的意义。目前关于心电信号生成的研究已有的方法主要是通过数学函数波形拟合或者实测心电数据拟合产生心电信号：动力学模型法：该模型主要由三个耦合的常微分方程组成，主要由两个步骤：根据要求指定要生成的心电信号的特征；将指定的心电信号的特征值输入模型，利用其中的常微分方程来计算拟合，生成满足要求的波形。但是，使用该方法生成心电信号要求用户具备一定的专业医疗知识，依赖性很强。生成对抗网络合成法：生成对抗网络是一种生成数据的工具。整个框架的训练过程被定义为两个竞争性网络之间的游戏。判别模型D学习鉴别真假样本，生成模型G学习欺骗鉴别器。如在专利CN 110897634A中，提出了一种基于生成对抗网络的心电信号生成方法，该方法主要通过构建生成模型G和判别模型D来组成生成对抗网络。生成模型G的输入为噪声信号，输出为模拟心电信号；判别模型D的输入为心电信号，输出为心电信号为真实心电信号的概率。首先初始化生成模型G，模拟生成心电信号，将生成的虚拟心电信号和真实心电信号一同作为训练样本，对判别模型D进行训练更新，使得判别模型D对生成模型G生成的虚拟心电信号具有辨识能力；然后再根据训练后的判别模型D对抗训练生成模型G，多次循环，得到最终满足要求的生成模型G和判别模型D，使得生成模型G能够根据输入的噪声信号模拟生成无限接近于真实的心电信号。类似地，在专利CN109036573A中，公开了设计思路大致相同的心电信号生成方法，不同之处在于该方法使用的输入信号是MIT-BIT数据库中的真实心电信号，而不是噪声信号。对于第一种方法，基于传统数学模型的方法可以生成非常逼真的心跳，但这些心跳过于标准和相似。另外，每一种心跳都对应一组方程。为了产生不同类型的心跳，必须修改方程，尤其生成房颤信号，非常的复杂和麻烦；第二种方法和前者存在的问题大致相同，虽然目前已有一些基于GAN网络生成心电信号的改进研究，但是这些对于生成的房颤信号依然不具备充分的保真度和多样性，训练过程也不够稳定。发明内容本发明的目的是提供一种房颤信号生成方法及系统，生成的房颤信号可信度高，能够满足现阶段心电信号自动分析模型的训练需求，有效地缓解房颤心电信号数据量不足、数据量不均衡等相关问题。为了解决上述技术问题，本发明提供了一种房颤信号生成方法，包括以下步骤：S1：获取采样率与输入长度相同的房颤信号和正常心电信号，并进行预处理；S2：分别制作房颤信号和正常心电信号中T波终点至下一个心电周期的QRS波起点位置的标签，其中，房颤信号对应标签记为标签1，正常心电信号对应标签记为标签2；S3：利用标签1对房颤信号中相应位置的房颤波依次进行截取，得到n条房颤波；S4：利用标签2对正常心电信号中相应位置的心电波段进行截断，并将截断位置置零，得到处理后的正常心电信号；S5：计算处理后的正常心电信号需要插入的房颤波数量，从n条房颤波中随机挑选所需数量房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。作为本发明的进一步改进，所述步骤S1中对房颤信号和正常心电信号分别进行预处理，所述预处理包括采用二阶巴特沃斯高通滤波器滤除信号中基线漂移和噪声。作为本发明的进一步改进，所述步骤S2具体包括以下步骤：S21：利用检波算法分别生成房颤信号对应的QRS波标签a和T波标签b；S22：对齐标签a和标签b，标签a内T波终点至标签b内对应下一相邻的QRS波起点位置，标签置1，其他位置置零，生成标签1；S23：利用检波算法分别生成正常心电信号对应的QRS波标签c和T波标签d；S24：对齐标签c和标签d，标签c内T波终点至标签d内对应下一相邻的QRS波起点位置，标签置零，其他位置置1，生成标签2。作为本发明的进一步改进，所述步骤S5具体包括以下步骤：计算处理后的正常心电信号需要插入的房颤波数量m，从n条房颤波中随机挑选m条房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。作为本发明的进一步改进，还包括步骤：S6：通过移动平均滤波器对合成的房颤信号做平滑处理，消除拼接突兀。作为本发明的进一步改进，还包括步骤：S7：构建多个房颤与非房颤的二分类模型，将合成后的房颤信号输入模型进行判别，循环测试，剔除模型无法识别的房颤信号，保留剩余的有效房颤信号。一种房颤信号生成系统，包括：采集单元，用于获取采样率与输入长度相同的房颤信号和正常心电信号，并进行预处理；标签制作单元，用于分别制作房颤信号和正常心电信号中T波终点至下一个心电周期的QRS波起点位置的标签，其中，房颤信号对应标签记为标签1，正常心电信号对应标签记为标签2；信号处理单元，用于利用标签1对房颤信号中相应位置的房颤波依次进行截取，得到n条房颤波；还用于利用标签2对正常心电信号中相应位置的心电波段进行截断，并将截断位置置零，得到处理后的正常心电信号；信号合成单元，计算处理后的正常心电信号需要插入的房颤波数量，从n条房颤波中随机挑选所需数量房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如上所述方法的步骤。一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如上所述方法的步骤。一种处理器，所述处理器用于运行程序，其中，所述程序运行时执行如上所述的方法。本发明的有益效果：本发明通过房颤波段截取和房颤信号合成，截取真实房颤信号的房颤波段并替换正常心电信号对应T波终点至QRS波起点位置，将正常心电信号合成为房颤信号，避繁就简，合成的房颤信号可信度高，具有多样性，可以在较短的时间内合成大规模多样性的房颤心电信号，满足现阶段关于房颤心电信号自动分析模型的训练需求，促进了相关算法的改进与成熟。附图说明图1是本发明方法流程示意图；图2是本发明制作标签过程示意图；图3是本发明房颤信号处理过程示意图；图4是本发明正常心电信号处理过程示意图；图5是本发明合成的房颤信号结果示意图。具体实施方式下面结合附图和具体实施例对本发明作进一步说明，以使本领域的技术人员可以更好地理解本发明并能予以实施，但所举实施例不作为对本发明的限定。参考图1，本发明实施例提供了一种房颤信号生成方法，包括以下步骤：S1：获取采样率与输入长度相同的房颤信号和正常心电信号，并进行预处理；S2：分别制作房颤信号和正常心电信号中T波终点至下一个心电周期的QRS波起点位置的标签，其中，房颤信号对应标签记为标签1，正常心电信号对应标签记为标签2；S3：利用标签1对房颤信号中相应位置的房颤波依次进行截取，得到n条房颤波；S4：利用标签2对正常心电信号中相应位置的心电波段进行截断，并将截断位置置零，得到处理后的正常心电信号；S5：计算处理后的正常心电信号需要插入的房颤波数量，从n条房颤波中随机挑选所需数量房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。具体的，本方法使用的心电信号的输入长度固定为统一长度，采样频率固定，首先使用二阶巴特沃斯高通滤波器对两种信号做简单预处理，滤除基线漂移和其他噪声；利用检波算法生成每条数据的QRS波标签和T波标签，再根据这两个标签得到所需要的每条数据对应的T波终点至QRS波起点位置的标签；利用生成的标签分别对房颤和正常心电信号作处理：对于房颤心电信号，利用标签截取T波终点至QRS波起点位置的房颤波段并保存；对于正常心电信号，与房颤波段截取的方法一致，利用生成的标签，处理正常心电信号。从所有保存的房颤波段中随机挑选相应的数量，填充处理后的正常心电信号对应位置，最后用移动平均滤波器对合成信号做简单平滑处理，消除拼接突兀。最后，可搭建多个房颤和非房颤的二分类网络模型，将合成的房颤信号输入网络模型进行测试，根据多次判断的结果，筛选并保留能被网络识别判断为房颤的合成信号。实施例本实施例使用的心电信号数据采样率为500Hz，心电信号的输入长度固定为统一长度。步骤一、准备使用的房颤Sig_F和正常心电信号Sig_N，首先利用二阶巴特沃斯高通滤波器做简单的预处理，去除基线漂移和其他噪声；步骤二、利用检波算法分别生成房颤Sig_F对应的QRS波和T波的标签label_q和label_t，并根据这两种标签，制造本方法所需要的T波终点至QRS波起点位置的标签label1；重复上述步骤，生成正常心电信号Sig_N对应的标签label2。其中，房颤信号与正常心电信号对应的标签形式正好相反，房颤信号对应的T波终点至QRS波起点位置标签置1，其他位置置0，正常心电信号反之，如图2所示，对齐标签label_q和标签label_t，标签label_t内T波终点至标签label_q内对应下一相邻的QRS波起点位置，标签置1，其他位置置零，生成标签1；对正常心电信号做同样处理，生成标签2；步骤三、根据生成的标签分别对房颤Sig_F与正常心电信号Sig_N作处理：对房颤信号Sig_F，标记对应位置的房颤波并依次单个截取，保存截取得到的n条房颤波；对正常信号，将对应位置截断置零，保存处理后的正常心电信号Sig_n。具体方法及结果如图3和图4所示，图3中，通过标签1对房颤信号Sig_F截取，截取其他地方置零，保留截取信号，得到下方的截取波形；图4中，通过标签2对正常心电信号Sig_N对正常心电信号进行截取，截取部分置零，保留其他部分；步骤四、计算处理后的正常信号Sig_n需要插入的房颤波段的数量m，然后从保存的n条房颤波段中随机挑选m条，依次填充信号Sig_n对应截断的T波终点至QRS波起点位置，得到合成的房颤信号，如图5所示，为合成后的房颤信号。最后，使用移动平均滤波器对合成后的房颤信号做平滑处理，消除拼接突兀。进一步的，本方法具体应用时，为了进一步保证生成的房颤信号的有效性，可搭建多个房颤与非房颤的二分类网络模型，将合成后的房颤信号输入模型进行判别，多次循环测试，剔除不能被网络识别为房颤的合成信号，保留剩余的有效房颤心电信号。本方法经过测试，生成的房颤信号可信度较高，并且方法较为简单，合成的信号具备多样性，能够满足现阶段心电信号自动分析模型的训练需求，有效地缓解了房颤心电信号数据量不足、数据量不均衡等相关问题。本发明还提供一种房颤信号生成系统，包括：采集单元，用于获取采样率与输入长度相同的房颤信号和正常心电信号，并进行预处理；标签制作单元，用于分别制作房颤信号和正常心电信号中T波终点至下一个心电周期的QRS波起点位置的标签，其中，房颤信号对应标签记为标签1，正常心电信号对应标签记为标签2；信号处理单元，用于利用标签1对房颤信号中相应位置的房颤波依次进行截取，得到n条房颤波；还用于利用标签2对正常心电信号中相应位置的心电波段进行截断，并将截断位置置零，得到处理后的正常心电信号；信号合成单元，计算处理后的正常心电信号需要插入的房颤波数量，从n条房颤波中随机挑选所需数量房颤波依次填充入正常心电信号截断位置，得到合成的房颤信号。具体的，系统采集的心电信号的输入长度固定为统一长度，采样频率固定，首先使用二阶巴特沃斯高通滤波器对两种信号做简单预处理，滤除基线漂移和其他噪声；标签制作单元利用检波算法生成每条数据的QRS波标签和T波标签，再根据这两个标签得到所需要的每条数据对应的T波终点至QRS波起点位置的标签；两个标签的置零和置1位置相反；信号处理单元利用生成的标签分别对房颤和正常心电信号作处理：对于房颤心电信号，利用标签截取T波终点至QRS波起点位置的房颤波段并保存；对于正常心电信号，与房颤波段截取的方法一致，利用生成的标签，处理正常心电信号；信号合成单元，从所有保存的房颤波段中随机挑选相应的数量，填充处理后的正常心电信号对应位置，最后用移动平均滤波器对合成信号做简单平滑处理，消除拼接突兀。最后，可搭建多个房颤和非房颤的二分类网络模型，将合成的房颤信号输入网络模型进行测试，根据多次判断的结果，筛选并保留能被网络识别判断为房颤的合成信号。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。以上所述实施例仅是为充分说明本发明而所举的较佳的实施例，本发明的保护范围不限于此。本技术领域的技术人员在本发明基础上所作的等同替代或变换，均在本发明的保护范围之内。本发明的保护范围以权利要求书为准。
