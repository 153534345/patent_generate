标题title
一种基于频域信号与时域信号的模态融合胎心率分类方法
摘要abst
本申请实施例属于生物医学信号处理领域，涉及一种基于频域信号与时域信号的模态融合胎心率分类方法，包括获取胎心率信号，提取胎心率信号在时域模态的时域特征；将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。本申请还提供一种基于频域信号与时域信号的模态融合胎心率分类系统。本申请完成对胎心率信号的提纯。
权利要求书clms
1.一种基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述方法包括下述步骤：获取胎心率信号，提取胎心率信号在时域模态的时域特征；将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。2.根据权利要求1所述的基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述获取胎心率信号，提取胎心率信号在时域模态的时域特征的步骤包括：获取胎心率信号，通过一维卷积神经网络对胎心率信号在输入维度上进行扩充；将扩充后的胎心率信号输入至transformer网络结构中，获得胎心率信号在时域模态的时域特征。3.根据权利要求2所述的基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述在输入维度上进行扩充方式为将胎心率信号从一维空间扩充到多维空间。4.根据权利要求3所述的基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述将扩充后的胎心率信号输入至transformer网络结构中，获得胎心率信号在时域模态的时域特征的步骤包括：通过transformer网络结构对输入的扩充后的胎心率信号的每一层进行单独矩阵转置；对矩阵转置后的扩充后的胎心率信号进行整合，并获取每一层胎心率信号的时域特征。5.根据权利要求1所述的基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征的步骤包括：将胎心率信号经过快速傅里叶从时域模态变换到频域模态，使得胎心率信号从时域特征信号变换成频域特征信号；将变换后的胎心率的频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征。6.根据权利要求1所述的基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述将变换后的胎心率频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征的步骤包括：将变换后的胎心率信号输入至多个一维卷积神经网络；多个一维卷积神经网络连续输出胎心率信号在频域模态下的特征学习；提取胎心率信号在频域模态的频域特征。7.根据权利要求1所述的基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果的步骤具体包括：查找时域特征在时域向量表征的第一变量列，查找频域特征在频域向量表征的第二变量列；当第一变量列与第二变量列相同时，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，获得融合后的胎心率融合表征结果。8.根据权利要求1所述的基于频域信号与时域信号的模态融合胎心率分类方法，其特征在于，所述输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果的步骤包括：获取胎心率融合表征结果中的列向量；将列向量输入单层全连接神经网络中获取可训练参数；根据可训练参数设置预测分类标签；计算预测分类标签与预存分类标签的交叉熵损失；根据交叉熵损失的计算结果确定胎心率的诊疗结果。9.一种基于频域信号与时域信号的模态融合胎心率分类系统，其特征在于，所述系统包括下述步骤：胎心率信号时域特征提取模块，获取胎心率信号，提取胎心率信号在时域模态的时域特征；胎心率频谱特征提取模块，将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；融合分类模块，计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。10.根据权利要求9所述的基于频域信号与时域信号的模态融合胎心率分类系统，其特征在于，所述胎心率频谱特征提取模块包括：快速傅里叶单元，将胎心率信号经过快速傅里叶从时域模态变换到频域模态，使得胎心率信号从时域特征信号变换成频域特征信号；卷积神经网络单元，将变换后的胎心率的频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征。
说明书desc
技术领域本申请涉及生物医学信号处理领域，尤其涉及一种基于频域信号与时域信号的模态融合胎心率分类方法及系统。背景技术胎儿心率监护是判断胎儿在母体内是否健康的一项重要技术指标。获得胎心率信号的方法有多种，其中，超声多普勒法因高灵敏性、无损伤性、方向性强、适用周期长和操作简单等优点得到了广泛应用，然而在超声多普勒回波信号的采集过程中，由于是通过母体进行胎心率信号采集，而非直接对胎儿本体进行心率信号采集，因此在所采集到的心率信号中不仅会存在电磁噪声，还会存在由于胎儿在母体内运动造成的心率信号丢失等问题。所以针对胎心率信号噪声种类较多，如何提取较为纯净的胎心率信号以提高计算胎心率的准确性成为该领域研究的一个难点问题。发明内容本申请实施例的目的在于提出一种基于频域信号与时域信号的模态融合胎心率分类方法及系统，以解决胎心率信号噪声种类较多，无法得到纯净的胎心率信号的技术问题。为了解决上述技术问题，本申请实施例提供一种基于频域信号与时域信号的模态融合胎心率分类方法，采用了如下所述的技术方案：所述方法包括下述步骤：获取胎心率信号，提取胎心率信号在时域模态的时域特征；将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。进一步的，所述获取胎心率信号，提取胎心率信号在时域模态的时域特征的步骤包括：获取胎心率信号，通过一维卷积神经网络对胎心率信号在输入维度上进行扩充；将扩充后的胎心率信号输入至transformer网络结构中，获得胎心率信号在时域模态的时域特征。进一步的，所述在输入维度上进行扩充方式为将胎心率信号从一维空间扩充到多维空间。进一步的，所述将扩充后的胎心率信号输入至transformer网络结构中，获得胎心率信号在时域模态的时域特征的步骤包括：通过transformer网络结构对输入的扩充后的胎心率信号的每一层进行单独矩阵转置；对矩阵转置后的扩充后的胎心率信号进行整合，并获取每一层胎心率信号的时域特征。进一步的，所述将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征的步骤包括：将胎心率信号经过快速傅里叶从时域模态变换到频域模态，使得胎心率信号从时域特征信号变换成频域特征信号；将变换后的胎心率的频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征。进一步的，所述将变换后的胎心率频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征的步骤包括：将变换后的胎心率信号输入至多个一维卷积神经网络；多个一维卷积神经网络连续输出胎心率信号在频域模态下的特征学习；提取胎心率信号在频域模态的频域特征。进一步的，所述查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果的步骤具体包括：查找时域特征在时域向量表征的第一变量列，查找频域特征在频域向量表征的第二变量列；当第一变量列与第二变量列相同时，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，获得融合后的胎心率融合表征结果。进一步的，所述输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果的步骤包括：获取胎心率融合表征结果中的列向量；将列向量输入单层全连接神经网络中获取可训练参数；根据可训练参数设置预测分类标签；计算预测分类标签与预存分类标签的交叉熵损失；根据交叉熵损失的计算结果确定胎心率的诊疗结果。为了解决上述技术问题，本申请实施例还提供一种基于频域信号与时域信号的模态融合胎心率分类系统，所述系统包括下述步骤：胎心率信号时域特征提取模块，获取胎心率信号，提取胎心率信号在时域模态的时域特征；胎心率频谱特征提取模块，将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；融合分类模块，计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。进一步的，所述胎心率频谱特征提取模块包括：快速傅里叶单元，将胎心率信号经过快速傅里叶从时域模态变换到频域模态，使得胎心率信号从时域特征信号变换成频域特征信号；卷积神经网络单元，将变换后的胎心率的频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征。本实施例通过，获取胎心率信号，提取胎心率信号在时域模态的时域特征；将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。实现了去除由于胎心率信号在传输过程中电流所造成的电磁噪声的干扰，对胎心率信号进行了提纯，并准确地对胎心率信号进行分类。附图说明为了更清楚地说明本申请中的方案，下面将对本申请实施例描述中所需要使用的附图作一个简单介绍，显而易见地，下面描述中的附图是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本申请可以应用于其中的示例性系统架构图；图2是基于频域信号与时域信号的模态融合胎心率分类方法的一个实施例的流程图；图3是基于频域信号与时域信号的模态融合胎心率分类系统的一个实施例的结构示意图；图4是根据本申请应用于计算机设备的一个实施例的结构示意图。具体实施方式除非另有定义，本文所使用的所有的技术和科学术语与属于本申请的技术领域的技术人员通常理解的含义相同；本文中在申请的说明书中所使用的术语只是为了描述具体的实施例的目的，不是旨在于限制本申请；本申请的说明书和权利要求书及上述附图说明中的术语“包括”和“具有”以及它们的任何变形，意图在于覆盖不排他的包含。本申请的说明书和权利要求书或上述附图中的术语“第一”、“第二”等是用于区别不同对象，而不是用于描述特定顺序。在本文中提及“实施例”意味着，结合实施例描述的特定特征、结构或特性可以包含在本申请的至少一个实施例中。在说明书中的各个位置出现该短语并不一定均是指相同的实施例，也不是与其它实施例互斥的独立的或备选的实施例。本领域技术人员显式地和隐式地理解的是，本文所描述的实施例可以与其它实施例相结合。为了使本技术领域的人员更好地理解本申请方案，下面将结合附图，对本申请实施例中的技术方案进行清楚、完整地描述。如图1所示，系统架构100可以包括终端设备101、102、103，网络104和服务器105。网络104用以在终端设备101、102、103和服务器105之间提供通信链路的介质。网络104可以包括各种连接类型，例如有线、无线通信链路或者光纤电缆等等。用户可以使用终端设备101、102、103通过网络104与服务器105交互，以接收或发送消息等。终端设备101、102、103上可以安装有各种通讯客户端应用，例如网页浏览器应用、购物类应用、搜索类应用、即时通信工具、邮箱客户端、社交平台软件等。终端设备101、102、103可以是具有显示屏并且支持网页浏览的各种电子设备，包括但不限于智能手机、平板电脑、电子书阅读器、MP3播放器、MP4播放器、膝上型便携计算机和台式计算机等等。服务器105可以是提供各种服务的服务器，例如对终端设备101、102、103上显示的页面提供支持的后台服务器。需要说明的是，本申请实施例所提供的基于语音语义的信息检索方法一般由服务器执行，相应地，基于语音语义的信息检索系统一般设置于服务器中。应该理解，图1中的终端设备、网络和服务器的数目仅仅是示意性的。根据实现需要，可以具有任意数目的终端设备、网络和服务器。继续参考图2，示出了根据本申请的基于频域信号与时域信号的模态融合胎心率分类方法的一个实施例的流程图。所述的基于频域信号与时域信号的模态融合胎心率分类方法，包括以下步骤：步骤S1，获取胎心率信号，提取胎心率信号在时域模态的时域特征；在本实施例中，胎心率信号通过超声多普勒法进行获取；时域特征描述数学函数或物理信号对时间的关系，例如一个信号的时域波形可以表达信号随着时间的变化，若考虑离散时间，时域模态中的函数或信号，在各个离散时间点的数值均为已知。若考虑连续时间，则函数或信号在任意时间的数值均为已知。在研究时域信号时，常会用示波器将信号转换为其时域的波形。具体地，步骤S1包括：获取胎心率信号，通过一维卷积神经网络对胎心率信号在输入维度上进行扩充；将扩充后的胎心率信号输入至transformer网络结构中，获得胎心率信号在时域模态的时域特征。所述在输入维度上进行扩充方式为将胎心率信号从一维空间扩充到多维空间。将原始胎心率信号作为该胎心率信号在时域模态下的表征形式，同时也是一种在时域模态下的表征形式。同时，在该时域模态下，虽然无法去除由于胎动造成的信号突变，但是可以将其作为一种辅助特征来与正常胎心率信号共同进行表示学习，其中，通过一个一维卷积神经网络对原始胎心率信号在输入维度上进行多维卷积神经网络扩充。在此之后，将完成维度扩充后的胎心率信号时域下的初步表征结果输入到一个深度较浅的transformer网络结构中，来获得胎心率信号在时域模态下的时域特征表征结果。具体地的扩充方法：通过transformer网络结构对输入的扩充后的胎心率信号的每一层进行单独矩阵转置；对矩阵转置后的扩充后的胎心率信号进行整合，并获取每一层胎心率信号的时域特征。通过一维卷积神经网络将原始胎心率信号从一维扩充到高维空间，将扩充后的胎心率表征为并将其作为transformer网络结构的输入，具体过程如下：其中表示第k层，第i个注意力头得到的表征结果，为第k层，第i个注意力头中的线性转化矩阵，符号表示矩阵转置。最后通过一个线性转化矩阵对该层各头得到的注意力值结果进行整合，得到第k层的表征结果具体如下：步骤S2，将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；频域特征是描述胎心率信号在频率方面特性时用到的一种坐标系。对任何一个事物的描述都需要从多个方面进行，每一方面的描述仅为我们认识这个事物提供部分的信息。例如，胎心率信号可以这样描述它方面1：频率，波形，时间；方面2：周期，长度，幅度。而对于一个信号来说，它也有很多方面的特性，如胎心率信号强度随时间的变化规律，胎心率信号是由哪些单一频率的信号合成的。具体地，步骤S2包括：将胎心率信号经过快速傅里叶从时域模态变换到频域模态，使得胎心率信号从时域特征信号变换成频域特征信号；将变换后的胎心率的频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征。对采集到的原始胎心率信号进行快速傅里叶变换，完成将其从时域信号的形式到频率特征的变换。该操作既完成了胎心率信号从时域模态到频域模态的变换，还在一定程度上去除了由于胎心率信号在传输过程中电流所造成的电磁噪声的干扰。涉及公式：xf＝fft其中，表示原始胎心率信号，则表示经过快速傅里叶变换后的频域特征信号，fft为快速傅里叶变换函数。在变换之后，利用多个连续的卷积神经网络层对胎心率信号的频域特征进行特征提取，来获得胎心率图在频域模态下的频域特征。所述将变换后的胎心率频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征的步骤包括：将变换后的胎心率信号输入至多个一维卷积神经网络；多个一维卷积神经网络连续输出胎心率信号在频域模态下的特征学习；提取胎心率信号在频域模态的频域特征。即，将xf输入到多个一维卷积神经网络中，涉及公式：与分别表示第l-1层胎心率信号特征输出以及第l层胎心率信号特征输出，ω表示卷积神经网络中的滤波器，函数σ则表示卷积操作之后的非线性函数。通过上述公式对胎心率信号的频域特征进行学习，并通过改变卷积层的输入通道数与输出通道数，获得最终的胎心率信号在频域模态上的频域特征表征步骤S3，计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；通过注意力机制计算胎心率在频域模态下的频域特征与胎心率在时域模态下的时域特征在各自向量表征对应位置点的注意力值，并按照将两个模态下相对应位置内容进行加权求和的方式，进而生成最终的融合了频域模态特征与时域模态特征的胎心率信号表征。步骤S4，查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；对于从胎心率信号的频谱特征以及胎心率信号的频谱特征分别学到的频域模态下的特征以及时域模态下的特征，首先通过融合获得两种模态下的胎心率融合表征结果，使胎心率融合表征结果在充分包含频域特征的同时，也包含了时域模态下的特征。并将胎心率融合表征结果输入一个分类结构，进而获得最终的胎心率分类结果。具体地，步骤S4包括：查找时域特征在时域向量表征的第一变量列，查找频域特征在频域向量表征的第二变量列；当第一变量列与第二变量列相同时，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，获得融合后的胎心率融合表征结果。通过注意力机制计算胎心率在频域模态下的频域特征与胎心率在时域模态下的时域特征在各自向量表征对应位置点的注意力值，具体涉及公式如下：与分别表示对应的频域模态下特征Xf的第m列以及时域模态下特征Xt下的第m列。为用于计算注意力的参数向量。最终用αm，f与αm，t分别表示在位置m处频域模态下的注意力值以及时域模态下的注意力值。最终通过如下的注意力值加和操作来获得位置为m处的胎心率融合表征结果Xm＝αm，t·xm，t+αm，f·xm，f步骤S5，输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。具体地，步骤S5包括：获取胎心率融合表征结果中的列向量；将列向量输入单层全连接神经网络中获取可训练参数；根据可训练参数设置预测分类标签；计算预测分类标签与预存分类标签的交叉熵损失；根据交叉熵损失的计算结果确定胎心率的诊疗结果。由单层全连接神经网络构成的分类结构，对上述过程中获得的胎心率融合表征结果进行分类，完成对于胎心率的相关诊疗任务。具体涉及公式如下：Y＝softmax+bc)其中表示通过可训练参数设置预测分类标签。参数矩阵以及则表示全连接神经网络的可训练参数。函数flat表示将向量展开成一个列向量的操作。交叉熵损失计算采用如下方法进行：Lc＝CrossEntrophy其中CrossEntrophy表示交叉熵损失函数。y表示胎心率信号所对应的真实标签。本实施例通过，获取胎心率信号，提取胎心率信号在时域模态的时域特征；将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。实现了去除由于胎心率信号在传输过程中电流所造成的电磁噪声的干扰，对胎心率信号进行了提纯，并准确地对胎心率信号进行分类。本申请实施例可以基于人工智能技术对相关的数据进行获取和处理。其中，人工智能是利用数字计算机或者数字计算机控制的机器模拟、延伸和扩展人的智能，感知环境、获取知识并使用知识获得最佳结果的理论、方法、技术及应用系统。人工智能基础技术一般包括如传感器、专用人工智能芯片、云计算、分布式存储、大数据处理技术、操作/交互系统、机电一体化等技术。人工智能软件技术主要包括计算机视觉技术、机器人技术、生物识别技术、语音处理技术、自然语言处理技术以及机器学习/深度学习等几大方向。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机可读指令来指令相关的硬件来完成，该计算机可读指令可存储于一计算机可读取存储介质中，该程序在执行时，可包括如上述各方法的实施例的流程。其中，前述的存储介质可为磁碟、光盘、只读存储记忆体等非易失性存储介质，或随机存储记忆体等。应该理解的是，虽然附图的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，其可以以其他的顺序执行。而且，附图的流程图中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，其执行顺序也不必然是依次进行，而是可以与其他步骤或者其他步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。进一步参考图3，作为对上述图2所示方法的实现，本申请提供了一种基于频域信号与时域信号的模态融合胎心率分类系统的一个实施例，该系统实施例与图2所示的方法实施例相对应，该系统具体可以应用于各种电子设备中。如图3所示，本实施例所述的基于频域信号与时域信号的模态融合胎心率分类系统包括：胎心率信号时域特征提取模块401、胎心率频谱特征提取模块402、融合分类模块403。其中：胎心率信号时域特征提取模块401，获取胎心率信号，提取胎心率信号在时域模态的时域特征；胎心率频谱特征提取模块402，将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；融合分类模块403，计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。本实施例通过，获取胎心率信号，提取胎心率信号在时域模态的时域特征；将胎心率信号从时域模态转换到频域模态，提取胎心率信号在频域模态的频域特征；计算时域特征在时域向量表征对应位置点的注意力值以及频域特征在频域向量表征对应位置点的注意力值；查找时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，并获得融合后的胎心率融合表征结果；输入由单层全连接神经网络构成的分类结构至胎心率融合表征结果中，获得胎心率融合表征结果的预测分类标签，完成胎心率的诊疗结果。实现了去除由于胎心率信号在传输过程中电流所造成的电磁噪声的干扰，对胎心率信号进行了提纯，并准确地对胎心率信号进行分类。在本实施例的一些可选的实现方式中，所述胎心率频谱特征提取模块402包括：快速傅里叶单元，将胎心率信号经过快速傅里叶从时域模态变换到频域模态，使得胎心率信号从时域特征信号变换成频域特征信号；卷积神经网络单元，将变换后的胎心率的频域特征信号输入至多个一维卷积神经网络中，由多个一维卷积神经网络层对胎心率信号在频域模态下进行特征提取，即获得胎心率信号在频域模态的频域特征。在本实施例的一些可选的实现方式中，所述胎心率信号时域特征提取模块401包括：扩充单元，获取胎心率信号，通过一维卷积神经网络对胎心率信号在输入维度上进行扩充；获取单元，将扩充后的胎心率信号输入至transformer网络结构中，获得胎心率信号在时域模态的时域特征。在本实施例的一些可选的实现方式中，所述提取单元包括：转置单元，通过transformer网络结构对输入的扩充后的胎心率信号的每一层进行单独矩阵转置；整合单元，对矩阵转置后的扩充后的胎心率信号进行整合，并获取每一层胎心率信号的时域特征。在本实施例的一些可选的实现方式中，所述融合分类模块403包括：输入单元，将变换后的胎心率信号输入至多个一维卷积神经网络；输出单元，多个一维卷积神经网络连续输出胎心率信号在频域模态下的特征学习；提取单元，提取胎心率信号在频域模态的频域特征。在本实施例的一些可选的实现方式中，所述融合分类模块403还包括：查找单元，查找时域特征在时域向量表征的第一变量列，查找频域特征在频域向量表征的第二变量列；融合单元，当第一变量列与第二变量列相同时，将时域特征在时域向量表征以及频域特征在频域向量表征同一顺序的位置点的注意力值进行融合，获得融合后的胎心率融合表征结果。在本实施例的一些可选的实现方式中，所述融合分类模块403还包括：列向量获取单元，获取胎心率融合表征结果中的列向量；列向量输入单元，将列向量输入单层全连接神经网络中获取可训练参数；设置标签单元，根据可训练参数设置预测分类标签；交叉熵损失计算单元，计算预测分类标签与预存分类标签的交叉熵损失；确诊结果单元，根据交叉熵损失的计算结果确定胎心率的诊疗结果。为解决上述技术问题，本申请实施例还提供计算机设备。具体请参阅图4，图4为本实施例计算机设备基本结构框图。所述计算机设备6包括通过系统总线相互通信连接存储器41、处理器42、网络接口43。需要指出的是，图4中仅示出了具有组件41-43的计算机设备4，但是应理解的是，并不要求实施所有示出的组件，可以替代的实施更多或者更少的组件。其中，本技术领域技术人员可以理解，这里的计算机设备是一种能够按照事先设定或存储的指令，自动进行数值计算和/或信息处理的设备，其硬件包括但不限于微处理器、专用集成电路、可编程门阵列、数字处理器、嵌入式设备等。所述计算机设备可以是桌上型计算机、笔记本、掌上电脑及云端服务器等计算设备。所述计算机设备可以与用户通过键盘、鼠标、遥控器、触摸板或声控设备等方式进行人机交互。所述存储器41至少包括一种类型的可读存储介质，所述可读存储介质包括闪存、硬盘、多媒体卡、卡型存储器、随机访问存储器、静态随机访问存储器、只读存储器、电可擦除可编程只读存储器、可编程只读存储器、磁性存储器、磁盘、光盘等。在一些实施例中，所述存储器41可以是所述计算机设备4的内部存储单元，例如该计算机设备6的硬盘或内存。在另一些实施例中，所述存储器41也可以是所述计算机设备6的外部存储设备，例如该计算机设备4上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。当然，所述存储器41还可以既包括所述计算机设备4的内部存储单元也包括其外部存储设备。本实施例中，所述存储器41通常用于存储安装于所述计算机设备4的操作系统和各类应用软件，例如基于频域信号与时域信号的模态融合胎心率分类方法的计算机可读指令等。此外，所述存储器41还可以用于暂时地存储已经输出或者将要输出的各类数据。所述处理器42在一些实施例中可以是中央处理器、控制器、微控制器、微处理器、或其他数据处理芯片。该处理器42通常用于控制所述计算机设备4的总体操作。本实施例中，所述处理器42用于运行所述存储器41中存储的计算机可读指令或者处理数据，例如运行所述基于频域信号与时域信号的模态融合胎心率分类方法的计算机可读指令。所述网络接口43可包括无线网络接口或有线网络接口，该网络接口43通常用于在所述计算机设备4与其他电子设备之间建立通信连接。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台终端设备执行本申请各个实施例所述的方法。显然，以上所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例，附图中给出了本申请的较佳实施例，但并不限制本申请的专利范围。本申请可以以许多不同的形式来实现，相反地，提供这些实施例的目的是使对本申请的公开内容的理解更加透彻全面。尽管参照前述实施例对本申请进行了详细的说明，对于本领域的技术人员来而言，其依然可以对前述各具体实施方式所记载的技术方案进行修改，或者对其中部分技术特征进行等效替换。凡是利用本申请说明书及附图内容所做的等效结构，直接或间接运用在其他相关的技术领域，均同理在本申请专利保护范围之内。
