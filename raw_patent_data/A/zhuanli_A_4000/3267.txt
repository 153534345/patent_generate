标题title
一种以杏仁核为核心的脑功能网络多指标融合的图像分类方法、装置、设备及介质
摘要abst
本发明公开了一种以杏仁核为核心的脑功能网络多指标融合的图像分类方法、装置、设备及介质，方法：获取待分类的头部核磁共振影像数据，并对其进行预处理；根据预处理后的核磁共振影像，分别提取以杏仁核为核心的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量；对提取到的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均进行降维处理，得到两种模态的最优特征向量；将两种模态的最优特征向量输入至预训练好的基于多核支持向量机模型的图像分类器，输出得到核磁共振影像数据的类别。本发明可以提升头部核磁共振影像的分类准确率。
权利要求书clms
1.一种以杏仁核为核心的脑功能网络多指标融合的图像分类方法，其特征在于，包括：获取待分类的头部核磁共振影像数据，并对其进行预处理；根据预处理后的核磁共振影像，分别提取以杏仁核为核心的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量；对提取到的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均进行降维处理，得到两种模态的最优特征向量；将两种模态的最优特征向量输入至预训练好的基于多核支持向量机模型的图像分类器，输出得到核磁共振影像数据的类别。2.根据权利要求1所述的图像分类方法，其特征在于，所述以杏仁核为核心的静态脑功能网络特征向量，提取方法为：首先，根据其预处理后的静息态核磁共振数据，以左外侧杏仁核、右外侧杏仁核、左内侧杏仁核、右内侧杏仁核这4个杏仁核亚区为种子点；分别计算每个杏仁核亚区的BOLD时间序列与全脑各体素的BOLD时间序列之间的皮尔森相关系数r，记为杏仁核亚区与全脑体素之间的功能连接值，从而生成4组以杏仁核亚区为种子点的脑功能网络连接图谱；然后，采用Brainnetome Atlas的划分方法，将每组脑功能网络图谱划分成274个脑区；提取每组脑功能网络图谱的每个脑区的平均连接值；最后，将每组脑功能网络图谱各274个脑区的平均连接值，整合成一个274×4的静态脑功能网络连接值特征向量。3.根据权利要求1所述的图像分类方法，其特征在于，以杏仁核为核心的动态脑功能网络特征向量，提取方法为：首先，根据其预处理后的静息态核磁共振数据，以左外侧杏仁核、右外侧杏仁核、左内侧杏仁核、右内侧杏仁核这4个杏仁核亚区为种子点；将每个杏仁核亚区与全脑各体素的时间序列按照时间窗进行划分，计算各时间窗内的每个杏仁核亚区与全脑各体素时间序列之间的皮尔森相关系数，记为杏仁核亚区与全脑体素之间的功能连接值，从而生成4组以杏仁核亚区为种子点的动态脑功能网络时序图谱；然后，计算每组动态脑功能网络时序图谱的时序变异系数CV：式中：表示在所有时间窗口内，体素n与杏仁核亚区种子点之间的功能连接值的平均值；σn表示在所有时间窗口内，体素n与杏仁核亚区种子点之间的功能连接值的标准差；随后，采用BrainnetomeAtlas的划分方法，将每组时序变异系数图谱划分成274个脑区；提取每组时序变异系数图谱的每个脑区的平均变异值；最后，将每组时序变异系数图谱各274个脑区的平均变异值，整合成一个274×4的动态脑功能网络变异系数特征向量。4.根据权利要求1所述的图像分类方法，其特征在于，静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均采用PCA降维方法进行降维处理。5.根据权利要求1所述的图像分类方法，其特征在于，所述预训练好的基于多核支持向量机模型的图像分类器，其模型为：其中：F为待分类头部核磁共振影像数据x的类别标签；sgn表示符号函数；i用于区分不同的训练样本，S表示训练样本的数量；yi为多核支持向量机模型的训练样本xi的类别标签，ai为训练样本xi对应的拉格朗日乘子，为待优化参数；e用于区分输入的两种模态的最优特征向量；βe表示第e模态最优特征向量的权重因子，且满足是训练样本xi和待分类头部核磁共振影像数据x的第e模态最优特征向量的核函数；b为偏差，通过训练样本训练得到。6.根据权利要求5所述的图像分类方法，其特征在于，训练多核支持向量机模型得到图像分类器的方法为：通过求解以下目标函数得到待优化的参数ai和b：0≤ai≤C，i＝1，...，S式中，C为惩罚因子。7.一种基于脑功能网络多指标融合的图像分类装置，其特征在于，包括：数据预处理模块，用于：获取待分类的头部核磁共振影像数据，并对其进行预处理；特征向量提取模块，用于：根据预处理后的核磁共振影像，分别提取以杏仁核为核心的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量；降维模块，用于：对提取到的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均进行降维处理，得到两种模态的最优特征向量；图像分类器模块，基于多核支持向量机模型训练得到，用于：根据降维处理模块得到的两种模态的最优特征向量，输出得到核磁共振影像数据的类别。8.一种电子设备，包括存储器及处理器，所述存储器中存储有计算机程序，其特征在于，所述计算机程序被所述处理器执行时，使得所述处理器实现如权利要求1～6中任一项所述的方法。9.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1～6中任一项所述的方法。
说明书desc
技术领域本发明涉及与医疗辅助研究相关的图像处理技术领域，特别是涉及一种以杏仁核为核心的脑功能网络多指标融合的图像分类方法、装置、设备及介质。背景技术抑郁症是以心境低落、认知受损和社会功能障碍为特征的致残性疾病。2017年，世界卫生组织发布的世界卫生报告估计全球有近3.22亿抑郁患者，并预计到2030年抑郁症将成为世界首位疾病负担源，给患者和社会都带来了沉重的负担。抑郁症临床症状复杂多样，其中自杀是最严重的后果之一。流行病学研究表明，抑郁症患者的终生自杀率为2％-12％，导致了严重的社会问题和巨大的经济损失。自杀作为全球关注的公共卫生话题，具有重要研究意义。但是，目前识别抑郁中自杀风险采用的是医生问诊和量表相结合的方式，主观偏向性过强。因此，找到可识别抑郁伴高自杀风险的客观神经生物学标记是非常有必要的。发明内容本发明提供一种以杏仁核为核心的脑功能网络多指标融合的图像分类方法，可以提升头部核磁共振影像的分类准确率。为实现上述技术目的，本发明采用如下技术方案：一种以杏仁核为核心的脑功能网络多指标融合的图像分类方法，包括：获取待分类的头部核磁共振影像数据，并对其进行预处理；根据预处理后的核磁共振影像，分别提取以杏仁核为核心的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量；对提取到的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均进行降维处理，得到两种模态的最优特征向量；将两种模态的最优特征向量输入至预训练好的基于多核支持向量机模型的图像分类器，输出得到核磁共振影像数据的类别。进一步地，所述以杏仁核为核心的静态脑功能网络特征向量，提取方法为：首先，根据其预处理后的静息态核磁共振数据，以左外侧杏仁核、右外侧杏仁核、左内侧杏仁核、右内侧杏仁核这4个杏仁核亚区为种子点；分别计算每个杏仁核亚区的BOLD时间序列与全脑各体素的BOLD时间序列之间的皮尔森相关系数r，记为杏仁核亚区与全脑体素之间的功能连接值，从而生成4组以杏仁核亚区为种子点的脑功能网络连接图谱；然后，采用Brainnetome Atlas的划分方法，将每组脑功能网络图谱划分成274个脑区；提取每组脑功能网络图谱的每个脑区的平均连接值；最后，将每组脑功能网络图谱各274个脑区的平均连接值，整合成一个274×4的静态脑功能网络连接值特征向量。进一步地，以杏仁核为核心的动态脑功能网络特征向量，提取方法为：首先，根据其预处理后的静息态核磁共振数据，以左外侧杏仁核、右外侧杏仁核、左内侧杏仁核、右内侧杏仁核这4个杏仁核亚区为种子点；将每个杏仁核亚区与全脑各体素的时间序列按照时间窗进行划分，计算各时间窗内的每个杏仁核亚区与全脑各体素时间序列之间的皮尔森相关系数，记为杏仁核亚区与全脑体素之间的功能连接值，从而生成4组以杏仁核亚区为种子点的动态脑功能网络时序图谱；然后，计算每组动态脑功能网络时序图谱的时序变异系数CV：式中：表示在所有时间窗口内，体素n与杏仁核亚区种子点之间的功能连接值的平均值；σn表示在所有时间窗口内，体素n与杏仁核亚区种子点之间的功能连接值的标准差；随后，采用Brainnetome Atlas的划分方法，将每组时序变异系数图谱划分成274个脑区；提取每组时序变异系数图谱的每个脑区的平均变异值；最后，将每组时序变异系数图谱各274个脑区的平均变异值，整合成一个274×4的动态脑功能网络变异系数特征向量。进一步地，静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均采用PCA降维方法进行降维处理。进一步地，所述预训练好的基于多核支持向量机模型的图像分类器，其模型为：其中：F为待分类头部核磁共振影像数据x的类别标签；sgn表示符号函数；i用于区分不同的训练样本，S表示训练样本的数量；yi为多核支持向量机模型的训练样本xi的类别标签，ai为训练样本xi对应的拉格朗日乘子，为待优化参数；e用于区分输入的两种模态的最优特征向量；βe表示第e模态最优特征向量的权重因子，且满足是训练样本xi和待分类头部核磁共振影像数据x的第e模态最优特征向量的核函数；b为偏差，通过训练样本训练得到。进一步地，训练多核支持向量机模型得到图像分类器的方法为：通过求解以下目标函数得到待优化的参数ai和b：0≤ai≤C，i＝1，...，S式中，C为惩罚因子。一种基于脑功能网络多指标融合的图像分类装置，其特征在于，包括：数据预处理模块，用于：获取待分类的头部核磁共振影像数据，并对其进行预处理；特征向量提取模块，用于：根据预处理后的核磁共振影像，分别提取以杏仁核为核心的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量；降维模块，用于：对提取到的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均进行降维处理，得到两种模态的最优特征向量；图像分类器模块，基于多核支持向量机模型训练得到，用于：根据降维处理模块得到的两种模态的最优特征向量，输出得到核磁共振影像数据的类别。一种电子设备，包括存储器及处理器，所述存储器中存储有计算机程序，所述计算机程序被所述处理器执行时，使得所述处理器实现上述任一项所述的图像分类方法。一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述任一项所述的图像分类方法。有益效果本发明考虑了以杏仁核为核心的脑功能网络多个不同层面上的模式，并融合了静态和动态网络提取出的特征，可提升对是否存在抑郁伴高自杀风险的分类准确率；采用本发明从静态和动态层面上观察以杏仁核为核心的脑功能网络异常模式更为全面，可信性更强。而且，本发明选择的脑功能网络特征同时考虑了以杏仁核为核心的脑功能网络在静态和动态两种层面上与疾病的相关性，因此本发明探索出的以杏仁核为核心的脑功能网络特征更为全面和深入，对于揭示伴高自杀风险的抑郁神经机制研究过程具有重要的意义。附图说明图1是本发明实施例所述方法的流程示意图。具体实施方式下面对本发明的实施例作详细说明，本实施例以本发明的技术方案为依据开展，给出了详细的实施方式和具体的操作过程，对本发明的技术方案作进一步解释说明。本发明基于rs-fMRI数据，首先以Brainnetome Atlas所提供的杏仁核4个亚区为种子点进行静态脑功能网络的功能连接分析；按照Brainnetome Atlas模板将静态脑功能网络的功能连接图谱划分为 274个脑区，并提取出各脑区功能连接值的均值，生成一个274×4的静态脑功能网络特征向量；采用PCA降维方法对该静态脑功能网络特征向量进行降维；按照设定的时间窗口和移动步长，将rs-fMRI数据切割成不同的时间窗口；在时间窗口内，以Brainnetome Atlas所提供的杏仁核4个亚区为种子点进行功能连接分析，得到与杏仁核4个亚区相对应的4组动态脑功能网络在不同时间窗口内的功能连接值；根据每组动态脑功能网络在不同时间窗口内的连接模式计算其时序变异系数；按照BrainnetomeAtlas模板将时序变异系数图谱划分为274个脑区，并提取出各脑区功能连接值的均值，生成一个274×4的动态脑功能网络特征向量；采用PCA降维方法对动态脑功能网络特征向量进行降维；最后，采用多核SVM用于组合静态脑功能网络和动态功能网络中选择得到的最优特征向量，并进行图像类别标签的预测。实施例1本实施例提供一种以杏仁核为核心的脑功能网络多指标融合的图像分类方法，参考图1 所示，包括以下步骤：步骤1，获取待分类的头部核磁共振影像数据，并对其进行预处理。步骤2，根据预处理后的核磁共振影像，分别提取以杏仁核为核心的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量。提取以杏仁核为核心的静态脑功能网络连接值特征向量的具体方法为：步骤a1，根据预处理后的静息态核磁共振数据，采用Brainnetome Atlas中4个杏仁核亚区为种子点，分别计算杏仁核亚区的血氧水平依赖平均时间序列与全脑各体素时间序列的皮尔森相关系数r ，记为杏仁核亚区与全脑体素之间的功能连接值，从而生成4组以杏仁核亚区为种子点的脑功能网络连接图谱；其中：r表示皮尔森相关系数；cov表示协方差；σ表示标准差；m和n表示两个不同的体素，其中m为种子点，n为全脑中任意体素；mi和ni分别表示种子点m和体素n在第i个时间点的BOLD信号值；N表示静息态核磁共振数据中包括的时间点数量；和分别表示种子点m和体素n在所有时间点的均值。将r定义为脑功能网络中各体素与种子点的功能连接关系，即得到与杏仁核4个亚区相对应的4组静态脑功能网络连接模式。步骤a2，采用Brainnetome Atlas的划分方法，将每组脑功能网络图谱划分成274个脑区；提取每组脑功能网络图谱的每个脑区的平均连接值；步骤a3，将每组脑功能网络图谱各274个脑区的平均连接值，串联形成一个长度为1096 的静态脑功能网络连接值特征向量XS。提取以杏仁核为核心的动态脑功能网络变异系数特征向量的具体方法为：步骤b1，根据其预处理后的静息态核磁共振数据，以左外侧杏仁核、右外侧杏仁核、左内侧杏仁核、右内侧杏仁核这4个杏仁核亚区为种子点；将每个杏仁核亚区与全脑各体素的时间序列按照时间窗进行划分，每个时间窗口设置为50个volume，步长为1个volume；计算各时间窗内的每个杏仁核亚区的血氧水平依赖平均时间序列与全脑各体素时间序列之间的皮尔森相关系数。其中，在各时间窗内的皮尔森相关系数的计算方法，与静态脑功能网络连接值特征提取中的所述方法相同。将各杏仁核亚区与全脑各体素在所有时间窗内生成的功能连接图谱串联起来，得到与各杏仁核亚区的动态功能连接关系，即为动态脑功能网络脑功能网络时序图谱。步骤b2，计算每组动态脑功能网络时序图谱的时序变异系数：式中：CV表示杏仁核亚区种子点与体素n的功能连接值的时序变异系数，表示在所有时间窗口内，体素n与杏仁核亚区种子点之间的功能连接值的平均值；σn表示在所有时间窗口内，体素n与杏仁核亚区种子点之间的功能连接值的标准差；每个杏仁核亚区种子点对应的全脑各体素的功能连接值的时序变异系数，形成一组时序变异系数图谱；步骤b3，采用Brainnetome Atlas的划分方法，将每组时序变异系数图谱划分成274个脑区；提取每组时序变异系数图谱的每个脑区的平均变异值；步骤b4，将每组时序变异系数图谱各274个脑区的平均变异值，串联形成一个长度为1096 的动态脑功能网络变异系数特征向量XD。步骤3，对提取到的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均进行降维处理，得到两种模态的最优特征向量。本实施例利用训练样本采用PCA降维方法对原始的两个特征向量进行降维处理，提取占总载荷分数前90％的主成分特征，构成对应的最优特征向量XS′和XD′。以采用PCA降维方法对XS降维得到XS′为例，对本实施例中的降维处理过程解释如下：步骤c1，计算特征向量XS的协方差矩阵CS：其中，为特征向量XS中的第i列特征。的计算公式如下：其中，这里M即为总特征数量1096。步骤c2，求协方差矩阵CS的特征值λS和特征向量μS：CSμS＝λSμS其中，λS表示特征值；每一个对应一个特征向量将特征值按照从大到小的顺序排列，选择最大的前K个特征值所对应的K个特征向量，并保证前K个特征值的总和不低于总特征值的90％。对于每一个样本，原来的特征是投影之后的新特征是新特征的计算公式如下：通过PCA降维，原来的特征向量XS降维为XS′。按照相同的方法，可将特征向量XD降维为XD′。步骤4，将两种模态的最优特征向量输入至预训练好的基于多核支持向量机模型的图像分类器，输出得到核磁共振影像数据的类别。其中，图像分类器的模型为：其中：F为待分类头部核磁共振影像数据x的类别标签；sgn表示符号函数；i用于区分不同的训练样本，S表示训练样本的数量；yi为多核支持向量机模型的训练样本xi的类别标签，ai为训练样本xi对应的拉格朗日乘子，为待优化参数；e用于区分输入的两种模态的最优特征向量；βe表示第e模态最优特征向量的权重因子，且满足是训练样本xi和待分类头部核磁共振影像数据x的第e模态最优特征向量的核函数；b为偏差，通过训练样本训练得到。在使用预训练好的图像分类器对待分类的核磁共振影像数据进行分类之前，利用已知类别标签的训练样本，通过求解以下目标函数得到图像分类器模型中待优化的参数ai和b：0≤ai≤C，i＝1，...，S式中，C为惩罚因子。其中，是训练样本xi和xp的第e模态最优特征向量的核函数； ai和ap分别为训练样本xi和xp对应的拉格朗日乘子，yi和yp分别为训练样本xi和xp对应的标签。将求解得到的参数ai和b代入到前面的分类器中，即公式F，对于给定的待测对象，将其两种模态的特征输入到分类器，得到其类别标签。本实施例中涉及到的训练样本的类别标签和图像分类器识别输出得到的类别，即为判断图像对应人体是否存在抑郁伴高自杀风险，从而为抑郁伴高自杀风险提供客观的神经生物学标记。实施例2本实施例提供一种基于脑功能网络多指标融合的图像分类装置，包括：数据预处理模块，用于：获取待分类的头部核磁共振影像数据，并对其进行预处理；特征向量提取模块，用于：根据预处理后的核磁共振影像，分别提取以杏仁核为核心的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量；降维模块，用于：对提取到的静态脑功能网络连接值特征向量和动态脑功能网络变异系数特征向量，均进行降维处理，得到两种模态的最优特征向量；图像分类器模块，基于多核支持向量机模型训练得到，用于：根据降维处理模块得到的两种模态的最优特征向量，输出得到核磁共振影像数据的类别。本实施例提供的图像分类装置包括的上述各模块，工作原理与实施例1中所述相同，通过各模块的功能，实现实施例1所述的图像分类方法。实施例3本实施例提供一种电子设备，包括存储器及处理器，所述存储器中存储有计算机程序，所述计算机程序被所述处理器执行时，使得所述处理器实现实施例1所述的图像分类方法。实施例4本实施例提供一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现实施例1所述的图像分类方法。以上实施例为本申请的优选实施例，本领域的普通技术人员还可以在此基础上进行各种变换或改进，在不脱离本申请总的构思的前提下，这些变换或改进都应当属于本申请要求保护的范围之内。FAN L,LI H,ZHUO J,et al.The Human Brainnetome Atlas:A New BrainAtlas Based on Connectional Architecture.Cerebral cortex,2016,26:3508-26. 。
