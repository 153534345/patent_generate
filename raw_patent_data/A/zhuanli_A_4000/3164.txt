标题title
一种基于物联网的自动和面控制方法及系统
摘要abst
本发明涉及和面机自动控制领域，更具体地，本发明涉及一种基于物联网的自动和面控制方法及系统，方法包括：构建电机的扭矩滑窗，对所述扭矩序列进行切割，计算扭矩稳定指数判断面粉成团状态，获取面桶内部面团的图像并进行预处理，得到第一灰度图像；统计第一灰度图像中的像素点的像素值，进行阈值分割并与第一灰度图像相乘，得到增强后的第二灰度图像，从而进行边缘检测，得到面团部分的圆滑度，并统计面团部分的灰度依赖矩阵，以计算和面评价值，根据和面评价值判断自动和面机的状态。本发明通过分析图像中面团的像素之间的灰度关系，从而增强图像的识别和分析能力，确保和面程度适中，保证面团质量。
权利要求书clms
1.一种基于物联网的自动和面控制方法，其特征在于，包括：构建电机的扭矩滑窗，将使用扭矩滑窗对扭矩序列进行切割，获得若干个连续的扭矩滑窗；计算每个扭矩滑窗的扭矩稳定指数；根据所述扭矩稳定指数，判断面粉成团状态；响应于面粉初步成团时，获取面桶内部面团的图像并进行预处理，得到第一灰度图像；统计第一灰度图像中的像素点的像素值，进行阈值分割，得到分割图像；将分割图像与第一灰度图像相乘，得到增强后的第二灰度图像；根据所述第二灰度图像进行边缘检测，得到边缘图像，根据所述边缘图像进行处理，得到面团部分的圆滑度；根据第二灰度图像，统计面团部分的灰度依赖矩阵，根据所述灰度依赖矩阵内各个点值的集合和所述圆滑度，计算和面评价值；基于第二灰度图像，获得和面评价值，响应于和面评价值大于预设阈值时，自动和面机停止作业。2.根据权利要求1所述的一种基于物联网的自动和面控制方法，其特征在于，所述扭矩稳定指数满足下述过程：其中，表示扭矩稳定指数，/＞表示滑窗的扭矩，/＞表示标准差，/＞表示归一函数，表示最大值，/＞表示最小值。3.根据权利要求1所述的一种基于物联网的自动和面控制方法，其特征在于，所述判断面粉成团状态，满足下述关系式：其中，表示面粉的成团系数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数，/＞表示第个扭矩滑窗的扭矩稳定指数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数；响应于成团系数为1时，此时面团已经成团。4.根据权利要求1所述的一种基于物联网的自动和面控制方法，其特征在于，所述阈值分割的分割评价值满足下述多项式：其中，表示分割评价值，/＞表示面团的灰度值，/＞表示第一灰度图像中灰度值小于等于面团的灰度值的集合，/＞表示第一灰度图像中灰度值大于面团的灰度值的集合，/＞表示第一灰度图像中灰度值小于等于面团的灰度值的均值，/＞表示第一灰度图像中灰度值大于面团的灰度值的均值，/＞表示标准差，/＞表示灰度值在第一灰度图像中的占比。5.根据权利要求4所述的一种基于物联网的自动和面控制方法，其特征在于，根据所述分割评价值，得到分割图像，包括：响应于分割评价值达到最大时，得到分割像素值；响应于分割评价值小于等于面团的灰度值的像素点的像素值标记为1，其余面团的灰度值的像素点的像素值标记为0，得到分割图像。6.根据权利要求1所述的一种基于物联网的自动和面控制方法，其特征在于，根据所述第二灰度图像进行边缘检测，得到边缘图像，还包括：提取所述边缘图像中的连通域，统计各个连通域内的像素点个数的集合，其中，所述像素点个数最多的连通域为面团部分；对所述面团部分的边缘进行连续性检测，提取面团部分的边缘，根据所述边缘的像素点位置，进行圆拟合，得到圆模型参数，并统计圆模型参数的内点个数；计算所述内点个数与观测数据集内样本总数的比值，得到面团部分的圆滑度。7.根据权利要求1所述的一种基于物联网的自动和面控制方法，其特征在于， 所述和面评价值满足下述多项式：其中，表示和面评价值，/＞表示面团的圆滑度，/＞表示灰度依赖矩阵内各个点值的集合，/＞表示连通域内的像素点个数的集合，/＞表示最大值，/＞表示最小值。8.一种基于物联网的自动和面控制系统，其特征在于，包括：处理器和存储器，所述存储器存储有计算机程序指令，当所述计算机程序指令被所述处理器执行时实现根据权利要求1-7任一项所述的基于物联网的自动和面控制方法。
说明书desc
技术领域本发明一般地涉及和面机自动控制领域。更具体地，本发明涉及一种基于物联网的自动和面控制方法及系统。背景技术物联网指的是物品互联网或物联网，它是指各种物理设备、车辆、家用电器和其他物品通过互联网互相连接并交换数据的网络系统。将物品通常被嵌入传感器、软件和其他技术，使它们能够收集和交换数据。这些数据可以是关于设备自身状态、环境条件或与其他设备的互动信息。物联网的核心原理是通过互联网连接物品，使它们能够实现智能化、自动化或更高级的功能。目前在市面上的自动和面机，都是通过设定固定的时间，进行和面的。但由于使用者可能不会每次固定采用所推荐的标准面粉计量进行和面，采用这种固定时间的方式，会出现面粉投入多时和面不均匀，或面粉少时过度揉面，导致面团的筋性下降，降低面团的质量，因此需要一种基于物联网的自动和面控制方法及系统。发明内容为解决上述一个或多个技术问题，本发明提出通过图像处理的方式，对自动化和面机进行判断和面程度，分别对面团部分进行边缘检测、连续性检测以及圆检测，从而得到和面评价值，从而判断面团状态，将自动化与图像处理相结合，以提高面团的产出标准，提高产出速度，为此，本发明在如下的多个方面中提供方案。在第一方面中，一种基于物联网的自动和面控制方法，包括：构建电机的扭矩滑窗，将使用扭矩滑窗对扭矩序列进行切割，获得若干个连续的扭矩滑窗；计算每个扭矩滑窗的扭矩稳定指数；根据所述扭矩稳定指数，判断面粉成团状态；响应于面粉初步成团时，获取面桶内部面团的图像并进行预处理，得到第一灰度图像；统计第一灰度图像中的像素点的像素值，进行阈值分割，得到分割图像；将分割图像与第一灰度图像相乘，得到增强后的第二灰度图像；根据所述第二灰度图像进行边缘检测，得到边缘图像，根据所述边缘图像进行处理，得到面团部分的圆滑度；根据第二灰度图像，统计面团部分的灰度依赖矩阵，根据所述灰度依赖矩阵内各个点值的集合和所述圆滑度，计算和面评价值；基于第二灰度图像，获得和面评价值，响应于和面评价值大于预设阈值时，自动和面机停止作业。在一个实施例中，所述扭矩稳定指数满足下述过程：其中，表示扭矩稳定指数，/＞表示滑窗的扭矩，/＞表示标准差，/＞表示归一函数，/＞表示最大值，/＞表示最小值。在一个实施例中，所述判断面粉成团状态，满足下述关系式：其中，表示面粉的成团系数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数；响应于成团系数为1时，此时面团已经成团。在一个实施例中，所述阈值分割的分割评价值满足下述多项式：其中，表示分割评价值，/＞表示面团的灰度值，/＞表示第一灰度图像中灰度值小于等于面团的灰度值的集合，/＞表示第一灰度图像中灰度值大于面团的灰度值的集合，表示第一灰度图像中灰度值小于等于面团的灰度值的均值，/＞表示第一灰度图像中灰度值大于面团的灰度值的均值，/＞表示标准差，/＞表示灰度值在第一灰度图像中的占比。在一个实施例中，根据所述分割评价值，得到分割图像，包括：响应于分割评价值达到最大时，得到分割像素值；响应于分割评价值小于等于面团的灰度值的像素点的像素值标记为1，其余面团的灰度值的像素点的像素值标记为0，得到分割图像。在一个实施例中，根据所述第二灰度图像进行边缘检测，得到边缘图像，还包括：提取所述边缘图像中的连通域，统计各个连通域内的像素点个数的集合，其中，所述像素点个数最多的连通域为面团部分；对所述面团部分的边缘进行连续性检测，提取面团部分的边缘，根据所述边缘的像素点位置，进行圆拟合，得到圆模型参数，并统计圆模型参数的内点个数；计算所述内点个数与观测数据集内样本总数的比值，得到面团部分的圆滑度。在一个实施例中， 所述和面评价值满足下述多项式：其中，表示和面评价值，/＞表示面团的圆滑度，/＞表示灰度依赖矩阵内各个点值的集合，/＞表示连通域内的像素点个数的集合，/＞表示最大值，/＞表示最小值。第二方面，一种基于物联网的自动和面控制系统，包括：处理器和存储器，所述存储器存储有计算机程序指令，当所述计算机程序指令被所述处理器执行时实现任一项所述的基于物联网的自动和面控制方法。本发明具有以下效果：1.本发明通过采用机电结合的方式，通过电机扭矩判断面粉初步成团，通过面团图像的灰度依赖矩阵内各个点值的集合和圆滑度，计算和面评价值以用于检测成团质量，灰度依赖矩阵通过多方向分析图像中面团的像素之间的灰度关系，从而增强图像的识别和分析能力，实现对图像的自动分类和识别，确保和面程度适中，保证面团质量。2.本发明通过对面团部分增强后的第二灰度图像中面团部分的边缘进行连续性检测，提取面团部分的边缘，对边缘的像素点进行圆拟合，得到圆模型参数，以随机采样和拟合来寻找能够最好拟合数据的数学模型，提高以边缘的像素点为数据集的鲁棒性，能够有效地估计模型参数。附图说明通过参考附图阅读下文的详细描述，本发明示例性实施方式的上述以及其他目的、特征和优点将变得易于理解。在附图中，以示例性而非限制性的方式示出了本发明的若干实施方式，并且相同或对应的标号表示相同或对应的部分，其中：图1是本发明的实施例一种基于物联网的自动和面控制方法中步骤S1-S9的方法流程图。图2是本发明实施例一种基于物联网的自动和面控制方法中步骤S50-S52的方法流程图。图3是本发明实施例一种基于物联网的自动和面控制方法中步骤S70-S72的方法流程图。图4是本发明实施例一种基于物联网的自动和面控制方法中步骤S4中第一灰度图像。图5是本发明实施例一种基于物联网的自动和面控制方法中步骤S5中分割图像。图6是本发明实施例一种基于物联网的自动和面控制方法中步骤S6中第二灰度图像。图7是本发明实施例一种基于物联网的自动和面控制方法中步骤S7中边缘图像。图8是本发明实施例一种基于物联网的自动和面控制方法中步骤S72中边缘图像的凹陷处。图9是本发明实施例一种基于物联网的自动和面控制系统的结构框图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。下面结合附图来详细描述本发明的具体实施方式。参照图1，一种基于物联网的自动和面控制方法包括步骤S1-S9，具体如下：S1：构建电机的扭矩滑窗，将使用扭矩滑窗对扭矩序列进行切割，获得若干个连续的扭矩滑窗。示例性的，通过和面机电机的PLC控制平台，获取电机的扭矩数据；将扭矩数据打上对应的时间戳，按照时间顺序进行排列，获得扭矩序列。扭矩的采集频率为10hz，扭矩滑窗预设的长度为2，步长为2。S2：计算每个扭矩滑窗的扭矩稳定指数。扭矩稳定指数满足下述过程：其中，表示扭矩稳定指数，/＞表示滑窗的扭矩，/＞表示标准差，/＞表示归一函数，/＞表示最大值，/＞表示最小值。示例性的，在这个面粉的成团过程中，由于面粉不是均匀的吸收水分，即部分面粉率先吸水，出现絮状小面团，通过充分搅拌后，面粉均匀的吸收水分后，形成光滑的面团，稳定指数越高，说明此时和面机的面团已经成团，没有絮状面团，记录扭矩滑窗的扭矩稳定指数，当扭矩稳定指数不再出现明显上升时，此时的面团已经初步成团了。S3：根据扭矩稳定指数，判断面粉成团状态。判断面粉成团状态，满足下述关系式：其中，表示面粉的成团系数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数，/＞表示第/＞个扭矩滑窗的扭矩稳定指数。示例性的，成团系数为1时，说明此时面团已经成团。进一步说明，通过扭矩稳定指数，计算面粉成团系数，若面团中有疙瘩、鼓包、凹陷等情况，面团在扭矩滑窗转动时，扭矩滑窗的扭矩稳定指数不稳定，从而面粉成团系数受到影响。S4：响应于面粉初步成团时，获取面桶内部面团的图像并进行预处理，得到第一灰度图像。示例性的，通过面桶上方设置的摄像头，对面桶内部进行拍摄，得到面桶内部的和面的实时RGB图像，并将实时RGB图像转换为灰度图像，记录为第一灰度图像，从而对面粉盆的像素值和面粉的像素值进行区分。参照图4，通过相机拍摄面团图像，本实施例中，相机拍摄帧数为每秒60帧，帧数大于扭矩运转速度，可以得到多个面团的清晰图像，将多个面团的清晰图像转换为灰度图像，得到多个第一灰度图像。S5：统计第一灰度图像中的像素点的像素值，进行阈值分割，得到分割图像，参照图5。参照图2，包括步骤S50-S52：S50：阈值分割的分割评价值满足下述多项式：其中，表示分割评价值，/＞表示面团的灰度值，/＞表示第一灰度图像中灰度值小于等于面团的灰度值的集合，/＞表示第一灰度图像中灰度值大于面团的灰度值的集合，表示第一灰度图像中灰度值小于等于面团的灰度值的均值，/＞表示第一灰度图像中灰度值大于面团的灰度值的均值，/＞表示标准差，/＞表示灰度值在第一灰度图像中的占比。进一步说明，每一个灰度图像对应一个阈值分割的分割评价值。S51：响应于分割评价值达到最大时，得到分割像素值；S52：响应于分割评价值小于等于面团的灰度值的像素点的像素值标记为1，其余面团的灰度值的像素点的像素值标记为0，得到分割图像。S6：将分割图像与第一灰度图像相乘，得到增强后的第二灰度图像，参照图6。示例性的，根据分割图像，进一步得到面团部分的增强的第二灰度图像，更好地区分面团与面盆。S7：根据第二灰度图像进行边缘检测，得到边缘图像，根据边缘图像进行处理，得到面团部分的圆滑度，参照图3，包括步骤S70-S72：S70：提取边缘图像中的连通域，统计各个连通域内的像素点个数的集合，其中，像素点个数最多的连通域为面团部分；S71：对面团部分的边缘进行连续性检测，提取面团部分的边缘，根据边缘的像素点位置，进行圆拟合，得到圆模型参数，并统计圆模型参数的内点个数，参照图7；S72：计算内点个数与观测数据集内样本总数的比值，得到面团部分的圆滑度。示例性的，参照图8，图中圆圈部分为面团凹陷处，将面团部分的边缘进行连续性检测，边缘连续性越好，说明面团越圆润。提取面团部分边缘，根据面团边缘的像素点位置，利用RANSAC进行圆拟合，它是根据一组包含异常数据的样本数据集，计算出数据的数学模型参数，得到有效样本数据的算法，根据RANSCAC模型，输入观测数据集为面团边缘像素点的位置数据，输出为圆模型参数，统计圆模型的内点个数。预设内点最小子集内部样本数为3，因为圆的确定需要三个内部样本数点，允许误差阈值为2.5，估计模型参数最小数据个数为观测数据集内样本总数的80%，计算内点个数与观测数据集内样本总数的比值，为面团的圆滑度，圆圈部分为观测数据集内样本总数的外点个数，即为内点个数与观测数据集内样本总数相等时，也就是说比值为1时，面团圆滑度最好。RANSAC的步骤通常如下：从数据集中随机选择一小部分数据点进行拟合模型，拟合的模型可以是直线、平面、圆等，具体取决于问题的性质，将所有数据点带入模型中，计算它们到模型的拟合误差。根据一个阈值，判断哪些数据点可以被认为是内点，即与模型拟合较好的点。计算模型在内点上的性能得分，例如内点的数量；当前模型的性能得分满足一定的条件，则认为找到了一个好的模型。否则，重复上述步骤。S8：根据第二灰度图像，统计面团部分的灰度依赖矩阵，根据灰度依赖矩阵内各个点值的集合和圆滑度，计算和面评价值。和面评价值满足下述多项式：其中，表示和面评价值，/＞表示面团的圆滑度，/＞表示灰度依赖矩阵内各个点值的集合，/＞表示连通域内的像素点个数的集合，/＞表示最大值，/＞表示最小值。示例性的，灰度依赖矩阵设定距离为1，阈值为3的统计规则；灰度依赖矩阵通常是从灰度共生矩阵派生而来，灰度共生矩阵是描述图像中两个像素灰度值同时出现的频率的矩阵，对于每个像素，统计与其相邻的像素之间的灰度级别共生关系；使用灰度共生矩阵中的信息，按照定义的依赖关系构建灰度依赖矩阵，该矩阵描述了图像中不同灰度级别之间的依赖性。S9：基于第二灰度图像，获得和面评价值，响应于和面评价值大于预设阈值时，自动和面机停止作业。示例性的，本实施例中，预设阈值为0.7，和面评价值大于预设阈值时，控制自动和面机停止工作；此时的面团达到产出要求。进一步说明，桶内清晰面团的图像分别对应一个和面评价值，和面评价值大于预设阈值时，面团达到产出标准。本发明还提供了一种基于物联网的自动和面控制系统。如图9所示，系统包括处理器和存储器，存储器存储有计算机程序指令，当计算机程序指令被处理器执行时实现本发明第一方面的基于物联网的自动和面控制方法。系统还包括通信总线和通信接口等本领域技术人员熟知的其他组件，其设置和功能为本领域中已知，因此在此不再赘述。在本发明中，前述的存储器可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。例如，计算机可读存储介质可以是任何适当的磁存储介质或者磁光存储介质，比如，阻变式存储器RRAM、动态随机存取存储器DRAM、静态随机存取存储器SRAM、增强动态随机存取存储器EDRAM、高带宽内存HBM、混合存储立方HMC等等，或者可以用于存储所需信息并且可以由应用程序、模块或两者访问的任何其他介质。任何这样的计算机存储介质可以是设备的一部分或可访问或可连接到设备。本发明描述的任何应用或模块可以使用可以由这样的计算机可读介质存储或以其他方式保持的计算机可读/可执行指令来实现。在本说明书的描述中，“多个”、“若干个”的含义是至少两个，例如两个，三个或更多个等，除非另有明确具体的限定。虽然本说明书已经示出和描述了本发明的多个实施例，但对于本领域技术人员显而易见的是，这样的实施例只是以示例的方式提供的。本领域技术人员会在不偏离本发明思想和精神的情况下想到许多更改、改变和替代的方式。应当理解的是在实践本发明的过程中，可以采用对本文所描述的本发明实施例的各种替代方案。
