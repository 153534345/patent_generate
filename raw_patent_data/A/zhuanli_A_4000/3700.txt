标题title
基于GRU神经网络和ECG信号的疲劳检测方法
摘要abst
本发明提供了一种基于GRU神经网络和ECG信号的疲劳检测方法，涉及新一代信息技术领域。本发明包括以下步骤:S1：获取训练数据集T和测试数据集S；S2：从训练集T中分别提取时域特征t、频域特征f和非线性特征n，t、f和n组合，形成特征向量；S3：构建GRU神经网络：构建GRU神经网络，GRU神经网络包括input层、嵌入层、GRU层、线性分类层和输出层；S4：将t、f和n送入GRU神经网络训练得综合损失L，并更新GRU神经网络参数；S5：利用训练集T对GRU神经网络进行训练，然后利用测试集S对经训练得到的神经网络模型进行测试，输出最终GRU神经网络模型。本发明平均绝对值误差MAE小。
权利要求书clms
1.一种基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：包括以下步骤:S1：通过心电传感器收集原始心电信号数据并将数据标注标签信息，得到样本标签；而后将收集到的原始心电数据进行HHT变换得到预处理心电信号数据；而后将得到的预处理心电信号数据按照70%训练集和30%测试集进行随机划分，得训练数据集T和测试数据集S；S2：从训练集T中分别提取时域特征t、频域特征f和非线性特征n，时域特征t、频域特征f和非线性特征n组合，形成特征向量；S3：构建GRU神经网络：在深度学习框架Pytorch中构建GRU神经网络，所述GRU神经网络包括input层、嵌入层、GRU层、线性分类层和输出层，其中嵌入层由二维卷积神经网络和批归一化层构成；其中，input层，用于将特征向量输入至嵌入层中；嵌入层用于将input层输入的特征向量转换为低维稠密向量；GRU层用于对嵌入层输出的特征数据进行更高维度的抽线，使得得到的特征更具判别性；线性分类层对GRU层输出的特征信息进行分类，并输出样本的分类预测结果;S4：将时域特征t、频域特征f和非线性特征n送入GRU神经网络训练得综合损失L，并更新GRU神经网络参数；S5：利用训练集T对GRU神经网络进行训练，然后利用测试集S对经训练得到的神经网络模型进行测试，输出最终GRU神经网络模型。2.根据权利要求1所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤S1中，对原始心电信号数据进行HHT变换，所述HHT变换包括对原始心电数据进行的经验模态分解的过程以及对由经验模态分解后得到的IMF分量进行HT变换的过程。3.根据权利要求1或2所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：对原始心电信号数据进行HHT变换的具体步骤为：将原始心电数据进行经验模态分解，获得分解后的IMF分量；将分解后的每个IMF分量通过希尔伯特变换变换得到IMF分量的瞬时频率和瞬时幅值；使用自适应差分阈值法确定原始心电数据的R波，而后将原始心电信号数据进行多次分段，即得到预处理心电信号数据；将预处理心电信号数据按照70%训练集和30%测试集进行随机划分，获得训练数据集T和测试数据集S。4.根据权利要求3所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤的具体步骤为：①.找出原始心电信号中所有局部变量的极大值并使用三次样条函数连接形成上包络，同理，利用原始心电信号中所有局部变量的极小值并用三次样条函数连接形成下包络；②.求出上、下包络的包络均值m1,并求原始心电信号数据与包络均值之间的差值h1,m1通过式进行计算,h1通过式进行计算：其中，式中emax为上包络线，emin为下包络线;其中，式中，S是指原始心电信号函数；③.如果m1满足IMF条件，那么m1就是求得的第一个IMF分量，否则将h1作为原始心电信号返回进行步骤②，直到迭代第K次得到的差值h1,k满足终止准则SD的条件停止，此时，迭代第K次得到的差值h1,k，c1代表S最高频率的分量，c1与差值h1,k中分离c1，得到第一阶剩余信号r1，如式所示： 而后将第一阶剩余信号r1作为原始心电信号进行重复上述过程，得到原始心电信号函数S的第二个IMF分量c2，一直重复上述过程n次，就得到了n个IMF分量，如式所示： 当第N阶剩余信号是单调函数或者一个极小的常量时，无法再提取IMF分量，停止分解过程，得式：其中，式中，是残余函数，是S的平均趋势，IMF分量c1，…，cn分别包含信号不同时间特征尺度大小的成分，尺度依次由小到大，因此，各分量也就相应地包含从高到低的不同频率段的成分；每个频段所包含的频率成分是不相同的，并且随着原始心电信号函数S的变化而变化。5.根据权利要求3所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤中，将经过EMD处理完后得到的IMF分量通过式进行希尔伯特变换： 式中，为解析信号实质也是一种复信号，为复信号的实部，被称为复信号的虚部，为瞬时幅值函数，为瞬时频率函数，j表示虚部;而则是通过式计算得到的， 式中，x为原始心电信号数据，x在本申请中被定义为原始心电信号的函数，T为积分变量，T的取值范围为﹣∞～+∞，t为时间；由得到的IMF分量的瞬时频率和瞬时幅值对解析信号进行表示，如式所示：式中，n表示IMF分量的阶数，Re表示取复数的实部，j表示虚部，为瞬时幅值的函数，i表示第i阶IMF分量，为瞬时频率的函数；其中，第i阶IMF分量的瞬时幅值为将第i阶IMF分量送入公式得到的：由于解析信号x可写成，因此，相位函数可用公式进行计算： 而瞬时频率则可通过公式计算获得： 。6.根据权利要求1所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤 S2的具体步骤为：S2-1：从训练集T中提取时域特征t：对训练集T中训练集样本数据的平均值、序列标准差以及相邻均方根差进行提取，MEAN通过式计算： 式中，RR表示R-R间期序列，R表示心电图QRS波群中的R波，N表示R-R间期序列的总数；序列标准差评估的是整个R-R间期序列的标准差，SDNN通过公式计算：相邻均方根差通过计算两相邻R-R间期序列之差的均方根得到，RMSSD的计算公式，如式所示： S2-2：从训练集T中提取频域特征f：从训练集样本中提取高频分量、低频分量以及归一化低频分量；首先，利用快速傅里叶变换对心电信号进行功率谱函数估计，其中，快速傅里叶积分函数计算公式，如式所示：式中，s为原始心电信号的函数，i虚数单位，w为频率，t为时间；而后，对R-R间期序列进行功率谱计算，提取高频分量、低频分量以及归一化低频分量；S2-3：从训练集T中提取非线性特征n，即从训练集样本中提取样本熵和复杂度，具体步骤如下：S2-3-1：样本熵的计算：对包含n个点的R-R间期的时间序列计算样本熵，样本熵的计算公式如式所示： 式中，函数指的是从训练集样本中随意选取长度为a的序列，这里的序列在时间上连续，意义为任意两个连续序列的距离都小于b的概率;函数通过式进行计算： 式中，n是序列总长度，a是选取序列长度，函数C是通过式计算得到的：式中，表示从时间序列 中取m个数组成的向量;为距离函数，距离函数d的计算式如式所示： 式中，m是从 中选取数的个数，k是从0到m-1随机选取一个数值，本申请中选取m=1，阈值b=0.1;S2-3-2： 复杂度的计算：为了计算复杂度，本申请中先对R-R间期的时间序列用 表示，经过式所示的快速傅里叶积分函数得到频域序列 ；而后，再通过式计算序列能量的总均方根;式中，N为划分的时间序列的总个数;而后，将能量小于的部分叫做规则部分，其余部分能量称为混沌部分;将分量置零，将再次进行傅里叶逆变换得到序列，复杂度通过式计算得到：。7.根据权利要求6所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤S2-2中，R-R间期序列进行功率谱计算，提取高频分量、低频分量以及归一化低频分量的具体步骤为：首先，选择去趋势运算之后的R-R间期序列，通过三次样条插值，然后，再重采样得到采样率为4Hz的离散R-R间期序列；而后，将离散R-R间期序列样本进行重叠50%的处理方式，并将结果等分3份得到3组数据，时间窗设置为5分钟，总长度为300秒，以每组150秒长度相互重叠75秒得到3组数据；而后，将得到的3组数据加汉明窗并分别补零到2048点，通过进行2048点快速傅里叶变换得到0.002Hz频率的频谱信号；最后将得到的3组频谱信号取平均值，得心电信号的功率谱估计，而后，从其中提取功率谱频率0.15-0.4Hz范围内的能量作为高频分量，从中提取0.04-0.15Hz的能量作为低频分量；而后，利用高频分量和低频分量计算归一化低频分量LFnorm，LFnorm的计算公式，如式所示： 式中，HF为高频分量，LF为低频分量，LFnorm为归一化低频分量。8.根据权利要求1所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤S3中，通过二维卷积神经网络将将input层输入的特征向量数据映射到100维,而后通过批归一化层进一步使映射后的数据限定在维度为0到1之间。9.根据权利要求1所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤S4的具体步骤为：将每个训练集样本的时域特征t、频域特征f和非线性特征n送入GRU神经网络进行训练，线性分类层会输出分类预测结果，将预测结果与该训练集样本的样本标签做交叉熵，作为综合损失L，综合损失L的计算公式，如式所示： 式中，P和Lable分别表示网络预测输出和样本标签。10.根据权利要求1所述的基于GRU神经网络和ECG信号的疲劳检测方法，其特征在于：步骤S5的具体步骤为：每次完成一个训练段后，将测试集样本送入嵌入层映射，完成嵌入映射后，将映射结果送入GRU神经网络提取特征，而后将特征送入线性分类层中实现分类，得到预测的分类结果；而后将分类结果与该测试集样本对应的样本标签对比得出测试精度；保持利用训练集样本对GRU神经网络训练后得到的GRU神经网络的GRU神经网络参数不变，利用该GRU神经网络对测试集样本进行测试，测试中总迭代次数设置为10000，每个训练段长度为1000，若当前训练段的测试精度大于上一个训练段的测试精度，则保存当前GRU神经网络参数数据，输出GRU神经网络分类模型；若当前训练段测试精度小于上一训练段的测试精度，则不保存当前网络参数，并继续进行下一个训练段的训练，当训练次数达到预设的总迭代次数时结束训练，输出GRU神经网络分类模型。
说明书desc
技术领域本发明属于新一代信息技术领域，具体涉及一种基于GRU神经网络和ECG信号的疲劳检测方法。背景技术当下现有的疲劳检测技术中，可以分为两大类，分别为基于面部状态分析疲劳状态、基于脑电信号或者心电图信号指标分析疲劳状态。在上述这些检测方法中，由于心电提供的信号在采集过中程具有无创，且易于携带和便于采集相关指标的特点，使得利用心电信号来判断疲劳的应用越来越广泛。同时随着现代机器学习和深度学习方法的兴起，使得通过以上技术和心电信号相结合来监测人体疲劳状态成为了可能。现有基于心电信号的疲劳检测技术，一部分是基于传统的检测方法，比如KNN为上包络线，emin为下包络线。其中，式中，S是指原始心电信号函数；③.如果m1满足IMF条件，那么m1就是求得的第一个IMF分量，否则将h1作为原始心电信号返回进行步骤②，直到迭代第K次得到的差值h1,k满足终止准则SD的条件停止，此时，迭代第K次得到的差值h1,k，c1代表S最高频率的分量，c1与差值h1,k中分离c1，得到第一阶剩余信号r1，如式所示： 而后将第一阶剩余信号r1作为原始心电信号进行重复上述过程，得到原始心电信号函数S的第二个IMF分量c2，一直重复上述过程n次，就得到了n个IMF分量，如式所示： 当第N阶剩余信号是单调函数或者一个极小的常量时，无法再提取IMF分量，停止分解过程，得式：其中，式中，是残余函数，是S的平均趋势，IMF分量c1，…，cn分别包含信号不同时间特征尺度大小的成分，尺度依次由小到大，因此，各分量也就相应地包含从高到低的不同频率段的成分；每个频段所包含的频率成分是不相同的，并且随着原始心电信号函数S的变化而变化。优选地，步骤中，步骤中，将经过EMD处理完后得到的IMF分量通过式进行希尔伯特变换： 式中，为解析信号实质也是一种复信号，为复信号的实部，被称为复信号的虚部，为瞬时幅值函数，为瞬时频率函数，j表示虚部。而则是通过式计算得到的，式中，x为原始心电信号数据，x在本申请中被定义为原始心电信号的函数，T为积分变量，T的取值范围为﹣∞～+∞，t为时间；由得到的IMF分量的瞬时频率和瞬时幅值对解析信号进行表示，如式所示：式中，n表示IMF分量的阶数，Re表示取复数的实部，j表示虚部，为瞬时幅值的函数，i表示第i阶IMF分量，为瞬时频率的函数；其中，第i阶IMF分量的瞬时幅值为将第i阶IMF分量送入公式得到的：由于解析信号x可写成，因此，相位函数可用公式进行计算： 而瞬时频率则可通过公式计算获得：经过HHT变换后心电信号的时序特征变得较为明显，便于后续的时域特征t、频域特征f和非线性特征n的特征提取。优选地，步骤 S2的具体步骤为：S2-1：从训练集T中提取时域特征t：对训练集T中训练集样本数据的平均值、序列标准差以及相邻均方根差进行提取，通过式计算MEAN：式中，RR表示R-R间期序列，R表示心电图QRS波群中的R波，N表示R-R间期序列的总数；序列标准差评估的是整个R-R间期序列的标准差，SDNN通过公式计算：相邻均方根差通过计算两相邻R-R间期序列之差的均方根得到，RMSSD的计算公式，如式所示： S2-2：从训练集T中提取频域特征f：从训练集样本中提取高频分量、低频分量以及归一化低频分量。首先，利用快速傅里叶变换对心电信号进行功率谱函数估计，其中，快速傅里叶积分函数计算公式，如式所示： 式中，s为原始心电信号的函数，i虚数单位，w为频率，t为时间；而后，对R-R间期序列进行功率谱计算，提取高频分量、低频分量以及归一化低频分量。优选地，对R-R间期序列进行功率谱计算，提取高频分量、低频分量以及归一化低频分量的具体步骤如下：选择去趋势运算之后的R-R间期序列，通过三次样条插值，然后，再重采样得到采样率为4Hz的离散R-R间期序列；而后，将离散R-R间期序列样本进行重叠50%的处理方式，并将结果等分3份得到3组数据，时间窗设置为5分钟，总长度为300秒，以每组150秒长度相互重叠75秒得到3组数据；而后，将得到的3组数据加汉明窗并分别补零到2048点，通过进行2048点快速傅里叶变换得到0.002Hz频率的频谱信号；最后将得到的3组频谱信号取平均值，得心电信号的功率谱估计，而后，从其中提取功率谱频率0.15-0.4Hz范围内的能量作为高频分量，从中提取0.04-0.15Hz的能量作为低频分量。归一化低频分量利用高频分量和低频分量进行计算，LFnorm的计算公式，如式所示： 式中，HF为高频分量，LF为低频分量，LFnorm为归一化低频分量。S2-3：从训练集T中提取非线性特征n，具体来说就是，从训练集样本中提取样本熵和复杂度，具体步骤如下：S2-3-1：样本熵的计算：对包含n个点的R-R间期的时间序列计算样本熵，样本熵的计算公式如式所示： 式中，函数指的是从训练集样本中随意选取长度为a的序列，这里的序列在时间上连续，意义为任意两个连续序列的距离都小于b的概率。函数通过式进行计算： 式中，n是序列总长度，a是选取序列长度，函数C是通过式计算得到的：式中，表示从时间序列 中取m个数组成的向量。 为距离函数，距离函数d的计算式如式所示： 式中，m是从 中选取数的个数，k是从0到m-1随机选取一个数值，本申请中选取m=1，阈值b=0.1。S2-3-2： 复杂度的计算：为了计算复杂度，本申请中先对R-R间期的时间序列用 表示，经过式所示的快速傅里叶积分函数得到频域序列 ；而后，再通过式计算序列能量的总均方根。式中，N为划分的时间序列的总个数。而后，将能量小于的部分叫做规则部分，其余部分能量称为混沌部分。将分量置零，将再次进行傅里叶逆变换得到序列。复杂度通过式计算得到：优选地，步骤S3中，通过二维卷积神经网络将将input层输入的特征向量数据映射到100维,而后通过批归一化层进一步使映射后的数据限定在维度为0到1之间。优选地，S4的具体步骤为：将每个训练集样本的时域特征t、频域特征f和非线性特征n送入GRU神经网络进行训练，线性分类层会输出分类预测结果，将预测结果与该训练集样本的样本标签做交叉熵，作为综合损失L，综合损失L的计算公式，如式所示： 式中，P和Lable分别表示网络预测输出和样本标签；优选地，步骤S4中，迭代次数设置为10000，训练段长度设置为1000；训练数据为训练数据集中的所有样本数据。优选地，步骤S5的具体步骤为：利用训练集T对GRU神经网络进行训练，然后利用测试集S对经训练得到的神经网络模型进行测试，输出最终GRU神经网络模型。具体来说：每次完成一个训练段后，将测试集样本送入嵌入层映射，完成嵌入映射后，将映射结果送入GRU神经网络提取特征，而后将特征送入线性分类层中实现分类，得到预测的分类结果；而后将分类结果与该测试集样本对应的样本标签对比得出测试精度；保持利用训练集样本对GRU神经网络训练后得到的GRU神经网络的GRU神经网络参数不变，利用该GRU神经网络对测试集样本进行测试，测试中总迭代次数设置为10000，每个训练段长度为1000，若当前训练段的测试精度大于上一个训练段的测试精度，则保存当前GRU神经网络参数数据，输出GRU神经网络分类模型；若当前训练段测试精度小于上一训练段的测试精度，则不保存当前网络参数，并继续进行下一个训练段的训练，当训练次数达到预设的总迭代次数时结束训练，输出GRU神经网络分类模型。与现有技术相比，本发明的有益效果如下：本发明对ECG信号进行去噪预处理，相对于原始ECG信号，本申请得到的数据更有利于学习ECG信号中包含的信息，另外通过从ECG中提取时域、频域和非线性特征信息，从多个角度提取出了和使用者目前身体状况想匹配的信息，并结合GRU神经网络可以精准地对疲劳状况进行检测，而且，本申请中GRU神经网络分类模型相较于LSTM及LSTM改进方法，平均绝对值误差MAE明显降低。附图说明图1 是本发明的总体流程图；图2是本发明的GRU神经网络结构示意图；图3为本发明测试阶段的流程图；图4为本发明对GRU神经网络分类模型、LSTM及LSTM改进方法基于同一训练集和测试集进行测试，得到的平均绝对值误差MAE测试结果图。具体实施方式本发明中术语解释：GRU：Gated Recurrent Unit，门控循环单元，是标准循环神经网络的改进版。SimpleEn：Simple Entropy，样本熵，是在近似熵算法基础上的改进版，改进近似熵对固有的自匹配向量的计算偏差问题。本实施例提供的一种基于GRU神经网络和ECG信号的疲劳检测方法，其总体流程图如图1所示，具体包括以下步骤：S1：通过心电传感器收集原始心电信号数据并将数据标注标签信息，得到样本标签；而后将收集到的原始心电数据进行HHT变换得到预处理心电信号数据；而后将得到的预处理心电信号数据按照70%训练集和30%测试集进行随机划分，最终获得140个训练样本和60个测试样本；步骤S1中，对原始心电信号数据进行HHT变换，本申请中HHT变换包括对原始心电数据进行的经验模态分解EMD过程以及对由经验模态分解EMD后得到的IMF分量进行HT变换的过程，具体步骤为：将原始心电数据进行经验模态分解，获得分解后的IMF分量；具体步骤为：①找出原始心电信号中所有局部变量的极大值并使用三次样条函数连接形成上包络，同理，利用原始心电信号中所有局部变量的极小值并用三次样条函数连接形成下包络。②.求出上、下包络的包络均值m1,并求原始心电信号数据与包络均值之间的差值h1, m1通过式进行计算,h1通过式进行计算。其中，式中emax为上包络线，emin为下包络线。其中，式中，S是指原始心电信号函数。③.如果m1满足IMF条件，那么m1就是求得的第一个IMF分量，否则将h1作为原始心电信号返回进行步骤②，直到迭代第K次得到的差值h1,k满足终止准则SD的条件停止，此时，迭代第K次得到的差值h1,k，c1代表S最高频率的分量，c1与差值h1,k中分离c1，得到第一阶剩余信号r1，如式所示： 而后将第一阶剩余信号r1作为原始心电信号进行重复上述过程，得到原始心电信号函数S的第二个IMF分量c2，一直重复上述过程n次，就得到了n个IMF分量，如式所示： 当第N阶剩余信号是单调函数或者一个极小的常量时，无法再提取IMF分量，停止分解过程，得式： 其中，式中，是残余函数，是S的平均趋势，IMF分量c1，…，cn分别包含信号不同时间特征尺度大小的成分，尺度依次由小到大，因此，各分量也就相应地包含从高到低的不同频率段的成分；每个频段所包含的频率成分是不相同的，并且随着原始心电信号函数S的变化而变化。将分解后的每个IMF分量通过希尔伯特变换变换得到IMF分量的瞬时幅值与瞬时频率。本申请中，EMD处理完之后得到的IMF分量，具有窄带信号、非复杂信号和平稳信号的特点。本申请中希尔伯特变换把经EMD处理完之后得到的信号的所有频率的IMF分量的相位推迟90度。步骤的具体步骤为：步骤中，将经过EMD处理完后得到的IMF分量通过式进行希尔伯特变换： 式中，为解析信号实质也是一种复信号，为复信号的实部，被称为复信号的虚部，为瞬时幅值函数，为瞬时频率函数，j表示虚部。而则是通过式计算得到的，式中，x为原始心电信号数据，x在本申请中被定义为原始心电信号的函数，T为积分变量，T的取值范围为﹣∞～+∞，t为时间；由得到的IMF分量的瞬时频率和瞬时幅值对解析信号进行表示，如式所示：式中，n表示IMF分量的阶数，Re表示取复数的实部，j表示虚部，为瞬时幅值的函数，i表示第i阶IMF分量，为瞬时频率的函数；其中，第i阶IMF分量的瞬时幅值为将第i阶IMF分量送入公式得到的：由于解析信号x可写成，因此，相位函数可用公式进行计算： 而瞬时频率则可通过公式计算获得：经过HHT变换后心电信号的时序特征变得较为明显，便于后续的时域特征t、频域特征f和非线性特征n的特征提取。使用自适应差分阈值法确定R波，将原始心电信号数据进行多次分段，即得到预处理心电信号数据，其中，每段都是一个R-R周期，便于后续步骤S2的域特征t、频域特征f和非线性特征n的特征提取。将预处理心电信号数据按照70%训练集和30%测试集进行随机划分，最终获得140个训练样本和60个测试样本S2：从训练集T中分别提取时域特征t、频域特征f和非线性特征n，这些特征最后组合在一起形成特征向量。其具体步骤为：S2-1：从训练集T中提取时域特征t：由于时域特征最具代表性的特征是：平均值、序列标准差以及相邻均方根差，因此，本申请中时域特征t的提取实质就是对训练集T中训练集样本数据的平均值、序列标准差以及相邻均方根差进行的提取。本申请中通过式计算MEAN， MEAN的计算公式，如式所示：式中，RR表示R-R间期序列，R表示心电图QRS波群中的R波，N表示R-R间期序列的总数。序列标准差评估的是整个R-R间期序列的标准差，SDNN通过公式计算：相邻均方根差通过计算两相邻R-R间期序列之差的均方根得到，RMSSD的计算公式，如式所示： S2-2：从训练集T中提取频域特征f：本申请中从频域特征中选取了3个最具代表性的特征分别为：高频分量、低频分量以及归一化低频分量，本申请中从训练集T中提取频域特征f实质就是从训练集样本中提取高频分量、低频分量以及归一化低频分量。为了得到上述分量，首先要利用快速傅里叶变换对心电信号进行功率谱函数估计，其中，快速傅里叶积分函数计算公式，如式所示： 其中，式中，s为原始心电信号的函数，i虚数单位，w为频率，t为时间。而后，对R-R间期序列进行功率谱计算，步骤如下：选择去趋势运算之后的R-R间期序列，通过三次样条插值，然后，再重采样得到采样率为4Hz的离散R-R间期序列；将离散R-R间期序列样本进行重叠50%的处理方式，并将结果等分3份得到3组数据。时间窗设置为5分钟，总长度为300秒，则以每组150秒长度相互重叠75秒得到3组数据；将得到的3组数据加汉明窗并分别补零到2048点，通过进行2048点快速傅里叶变换得到0.002Hz频率的频谱信号；最后将得到的3组频谱信号取平均值，得心电信号的功率谱估计，而后，从其中提取功率谱频率0.15-0.4Hz范围内的能量作为高频分量，从中提取0.04-0.15Hz的能量作为低频分量。归一化低频分量中包含人体神经活性信息。归一化低频分量的计算公式，如式所示： S2-3：从训练集T中提取非线性特征n：本申请中从非线性特征中选取了2个最具代表性的特征分别为：样本熵和复杂度。本申请中提取非线性特征n实质就是从训练集样本中提取样本熵和复杂度。其中样本熵可以衡量序列的自我相似性的程度，如果在R-R间期中得到一个较大的样本熵，表示序列自我相似性较低，产生新模式的概率较大。本申请中从训练集T中提取非线性特征n的具体步骤如下：S2-3-1：样本熵的计算：对包含n个点的R-R间期的时间序列计算样本熵，样本熵的计算公式如式所示： 式中，函数指的是从训练集样本中随意选取长度为a的序列，这里的序列在时间上连续，意义为任意两个连续序列的距离都小于b的概率。函数通过式进行计算： 式中，n是序列总长度，a是选取序列长度，函数C是通过式计算得到的：式中， 表示从时间序列 中取m个数组成的向量。 为距离函数，距离函数d的计算式如式所示： 式中，m是从中选取数的个数，k是从0到m-1随机选取一个数值，本申请中选取m=1，阈值b=0.1。S2-3-2：复杂度的计算为了计算复杂度，本申请中先对R-R间期的时间序列用表示，经过式所示的快速傅里叶积分函数得到频域序列；而后，再通过式计算序列能量的总均方根。式中，N为划分的时间序列的总个数。而后，将能量小于的部分叫做规则部分，其余部分能量称为混沌部分。将分量置零，将再次进行傅里叶逆变换得到序列。复杂度通过式计算得到：S3：构建GRU神经网络：在深度学习框架Pytorch中构建GRU神经网络，GRU神经网络的结构图如图2所示，本实施例中构建的GRU神经网络包括input层、嵌入层、GRU层、线性分类层和输出层，其中嵌入层由二维卷积神经网络和批归一化层构成；其中，input层，用于将特征向量输入至嵌入层中；嵌入层用于将input层输入的特征向量转换为低维稠密向量，具体来说使用二维卷积神经网络和批归一化层同时运作共同实现将输入数据进行降维的目的,其中,通过二维卷积神经网络将将input层输入的特征向量数据映射到100维,而后通过批归一化层进一步使映射后的数据限定在维度为0到1之间；GRU层用于对嵌入层输出的特征数据进行更高维度的抽线，使得得到的特征更具判别性，其中GRU层中包括更新门和重置门，更新门用于控制有多少前一时间步的信息和当前时间步的信息可以被传递到未来，重置门用于控制要遗忘多少过去的信息；线性分类层对GRU层输出的特征信息进行分类，并输出样本的分类预测结果，本申请将人体疲劳程度定义为10级，这里分类预测输出10类,每一类代表不同的疲劳程度。S4：将时域特征t、频域特征f和非线性特征n送入GRU神经网络训练得综合损失L，并更新GRU神经网络参数，具体步骤为：将每个训练集样本的时域特征t、频域特征f和非线性特征n送入GRU神经网络进行训练，线性分类层会输出分类预测结果，将预测结果与该训练集样本的样本标签做交叉熵，作为综合损失L，综合损失L的计算公式，如式所示： 式中，P和Lable分别表示网络预测输出和样本标签。步骤S4中，本申请把迭代次数设置为10000，训练段长度设置为1000；训练数据为训练数据集中的所有样本数据。S5：利用训练集T对GRU神经网络进行训练，然后利用测试集S对经训练得到的神经网络模型进行测试，输出最终GRU神经网络模型。具体来说：每次完成一个训练段后，将测试集样本送入嵌入层映射，完成嵌入映射后，将映射结果送入GRU神经网络提取特征，而后将特征送入线性分类层中实现分类，得到预测的分类结果；而后将分类结果与该测试集样本对应的样本标签对比得出测试精度；保持利用训练集样本对GRU神经网络训练后得到的GRU神经网络的GRU神经网络参数不变，利用该GRU神经网络对测试集样本进行测试，测试中总迭代次数设置为10000，每个训练段长度为1000，若当前训练段的测试精度大于上一个训练段的测试精度，则保存当前GRU神经网络参数数据，输出GRU神经网络分类模型；若当前训练段测试精度小于上一训练段的测试精度，则不保存当前网络参数，并继续进行下一个训练段的训练，当训练次数达到预设的总迭代次数时结束训练，输出GRU神经网络分类模型。另外，为了验证本申请构建的GRU神经网络分类模型的有效性，本申请利用GRU神经网络分类模型、LSTM及LSTM改进方法基于同一训练集和测试集进行测试，得到不同方法所能取得的平均绝对值误差MAE，不同方法所能取得的平均绝对值误差MAE，如图4和表1所示。其中，图4和表1中的LSTM方法、LSTM-SA方法、LSTM-CSA方法是论文Fatigue AssessmentUsing ECG and Actigraphy Sensors中提到的三种对比方法。从图4和表1能够看出，本申请中的GRU神经网络分类模型相较于现有技术中的LSTM方法及LSTM改进方法，利用本申请中的GRU神经网络分类模型的GRU神经网络分类方法所能取得的平均绝对值误差MAE明显降低，具体来说，在上述四种分类方法中，相同测试样本数量的条件下，本申请使用GRU神经网络分类方法平均绝对值误差最小，比如，在同为15个测试样本的情况下，本申请GRU神经网络分类方法相较于LSTM改进方法——LSTM-CSA方法，GRU神经网络分类方法能够降低平均绝对值误差11%；在同为30个测试样本的情况下，本申请GRU神经网络分类方法相较于LSTM改进方法——LSTM-CSA方法，GRU神经网络分类方法能够降低平均绝对值误差18.94%；从表1和图4中也可以看出，随着样本数量的增加GRU神经网络分类方法平均绝对值误差也在不断地减少，比如，测试样本为75个的情况下相较于测试样本为15的情况下，本申请GRU神经网络分类方法的平均绝对值误差降低了63.7%，上述实验数据有效地证实了本申请中构建的GRU神经网络模型的有效性。表1本发明中GRU神经网络分类模型的测试过程，如图3所示，主要包括步骤：对测试数据集进行去噪预处理；将测试数据集完成嵌入映射；将映射后的数据送入GRU层提取深层特征；送入线性分类器中得到分类结果，判断疲劳程度。
