标题title
一种机器学习中增广脑磁图数据的方法
摘要abst
本发明涉及脑磁图领域，具体涉及一种机器学习中增广脑磁图数据的方法。该方法包括：基于人类大脑模板构建大脑皮层网格模型，将人类大脑模板的头皮表面与脑磁图头盔传感器位置进行配准对齐；在信号采集时间段内收集所有脑磁图头盔传感器采集的原始信号进行预处理后得到头皮表面的磁场信号；构建前向模型描述等效电流信号与头皮表面的磁场信号之间的关系；对前向模型执行空间位置扰动或将对等效电流信号执行数值扰动以增广脑磁图数据。本申请的脑磁图数据增广方法符合脑磁图中电磁场传播的物理规律及大脑内神经元放电的生理规律，可以覆盖更多的实际使用场景，增加脑磁图数据的多样性。
权利要求书clms
1.一种机器学习中增广脑磁图数据的方法，其特征在于，包括以下步骤：步骤一，基于人类大脑模板构建网格顶点数量为的大脑皮层网格模型，将人类大脑模板的头皮表面与脑磁图头盔传感器位置进行配准对齐，网格顶点数量/＞为：；其中，为整除符号，/＞为脑磁图头盔传感器的数量；步骤二，在信号采集时间段内收集所有脑磁图头盔传感器采集的原始信号，信号采集时间段内的采样点个数为，将原始信号预处理后得到头皮表面的磁场信号/＞；步骤三，构建前向模型描述等效电流信号与头皮表面的磁场信号/＞之间的关系，前向模型表示为：；其中，代表导向矩阵，/＞为脑磁图头盔传感器接收到的噪声，/＞表示矩阵点积运算；步骤四，将头皮表面的磁场信号转换为等效电流信号/＞，对前向模型执行空间位置扰动得到空间位置扰动后的前向模型，基于空间位置扰动后的前向模型将等效电流信号/＞转换为头皮表面的磁场信号，作为增广后的脑磁图数据的一部分样本；或者将头皮表面的磁场信号转换为等效电流信号/＞，将等效电流信号/＞执行数值扰动后得到扰动后的等效电流信号/＞，基于前向模型将扰动后的等效电流信号/＞转换为头皮表面的磁场信号，作为增广后的脑磁图数据的一部分样本。2.根据权利要求1所述一种机器学习中增广脑磁图数据的方法，其特征在于，步骤三中构建前向模型时，忽略脑磁图头盔传感器接收到的噪声。3.根据权利要求2所述一种机器学习中增广脑磁图数据的方法，其特征在于，定义导向矩阵的第/＞行、第/＞列处的元素为/＞，/＞，/＞，元素的计算方法如下：固定信号采集时间段内的采样点个数为1，将等效电流信号/＞转换为一维的长度为的电流强度矢量/＞，将电流强度矢量/＞的第/＞个分量设置为1，其他分量设置为0，得到第/＞个单位电流强度矢量；将第个单位电流强度矢量拆分为/＞个网格顶点上的长度为3的三维电流强度矢量；使用毕奥-萨伐尔定律，分别计算个网格顶点上的三维电流强度矢量在第/＞个脑磁图头盔传感器处产生的磁场强度矢量；将个磁场强度矢量相加，将相加的结果在第/＞个脑磁图头盔传感器线圈的法向量上的投影长度作为元素/＞的数值。4.根据权利要求2所述一种机器学习中增广脑磁图数据的方法，其特征在于，步骤四中所述将头皮表面的磁场信号转换为等效电流信号/＞，具体包括：；其中，表示基于导向矩阵/＞计算的逆向矩阵。5.根据权利要求2所述一种机器学习中增广脑磁图数据的方法，其特征在于，步骤四中所述对前向模型执行空间位置扰动，具体包括：部分网格顶点随机平移、大脑皮层区域整体平移、脑磁图头盔旋转。6.根据权利要求5所述一种机器学习中增广脑磁图数据的方法，其特征在于，所述部分网格顶点随机平移，具体包括：将等效电流信号按照/＞个网格顶点分为/＞组等效电流信号；分别计算每组等效电流信号的L2范数序列：；其中，为信号采集时间段内的一个时刻点，/＞表示在时刻点/＞某组等效电流信号的长度为3的电流分量，/＞为L2范数，/＞表示时序的集合；对每组等效电流信号的L2范数序列计算变异系数，从/＞个变异系数中选取数值最大的/＞个变异系数，/＞；将变异系数最大的个L2范数序列对应的网格顶点作为待平移网格顶点，将待平移网格顶点在大脑皮层网格模型中逐一执行空间位置的随机平移，待平移网格顶点平移后的空间位置/＞为：；；其中，为待平移网格顶点平移前的空间位置，/＞为待平移网格顶点的空间位置的随机平移量，/＞为待平移网格顶点的三个相邻网格顶点的序号，/＞为待平移网格顶点的第/＞个相邻网格顶点的空间位置，/＞为绝对值小于固定阈值的随机数生成函数。7.根据权利要求5所述一种机器学习中增广脑磁图数据的方法，其特征在于，所述脑磁图头盔旋转，具体包括：计算大脑皮层网格模型的个网格顶点的空间位置的平均值，作为脑磁图头盔旋转的中心点的坐标/＞：；其中，为第/＞个网格顶点的空间位置；计算旋转矩阵：；其中，为预定义的三个欧拉角；旋转后的脑磁图头盔传感器的空间位置为：；其中，为脑磁图头盔传感器未旋转前的原始空间位置。8.根据权利要求2所述一种机器学习中增广脑磁图数据的方法，其特征在于，步骤四中所述将等效电流信号执行数值扰动，具体包括：部分通道加噪、平稳信号抑制、部分通道振幅缩放以及打乱通道顺序。9.根据权利要求8所述一种机器学习中增广脑磁图数据的方法，其特征在于，所述部分通道加噪，具体包括：生成段长度为/＞的高斯白噪声信号，并对每段高斯白噪声进行滤波，/＞为整数且满足/＞；将等效电流信号分为/＞个通道，每个通道的长度为/＞；在个通道中随机选取/＞个通道与/＞段长度为/＞的高斯白噪声信号配对；对每对配对的信号，按预定义的信噪比缩放高斯白噪声信号，并将缩放后的高斯白噪声信号逐采样点叠加到配对的通道的电流信号上，得到/＞个通道的加噪信号；将个通道的加噪信号，替换等效电流信号/＞中的对应通道，得到扰动后的等效电流信号/＞。10.根据权利要求8所述一种机器学习中增广脑磁图数据的方法，其特征在于，所述部分通道振幅缩放，具体包括：将等效电流信号按照/＞个网格顶点分为/＞组等效电流信号；分别计算每组等效电流信号的L2范数序列：；其中，为信号采集时间段内的一个时刻点，/＞表示在时刻点/＞某组等效电流信号的长度为3的电流分量，/＞为L2范数，/＞表示时序的集合；在组等效电流信号中随机选择/＞组，/＞为整数且满足；计算组等效电流信号的缩放参数/＞：；其中，代表取平均值运算，/＞为求标准差运算，/＞为预设的L2范数的缩放参数；基于缩放参数计算/＞组等效电流信号缩放后的电流信号，并用缩放后的电流信号替代等效电流信号/＞中对应的原始信号，得到扰动后的等效电流信号/＞。
说明书desc
技术领域本发明涉及脑磁图领域，具体涉及一种机器学习中增广脑磁图数据的方法。背景技术脑磁图是一种非入侵式的功能性神经成像技术，可以实现对大脑内电生理活动的间接测量。脑磁图测量头皮表面的磁场强度，间接反映大脑内部的电生理信号。与脑电图相比，脑磁图具有更高的定位精度，因为大脑内部不同组织的电导率差异会影响脑电图的信号传播，而大脑内部不同组织的磁导率则近似相等。因此，脑磁图在临床上具有更高的价值。目前商用的脑磁图设备，使用灵敏性极高的超导量子干涉仪，记录大脑中微弱电流产生的磁场。为了保持超导量子干涉仪传感器的超导性，传感器需要浸泡在约-269℃的大型液氦冷却装置中。因此，目前商用的脑磁图设备，均采用尺寸较大、位置固定的头盔，采集患者的脑部磁场信号。脑磁图设备的生产运营成本较高，此外，对患者的脑磁图数据进行标注，需要耗费经验丰富医师的大量时间精力。因此，针对特定脑部疾病，一般只能搜集到数例至数百例带标签的患者脑磁图数据。然而，在实际临床中，不同患者的大脑虽然外形近似、功能区划分类似，但病灶区域位置、功能区形状等存在差异。因此，可使用的脑磁图数据集，往往无法很好地覆盖实际临床中可能出现的情况。而机器学习的相关算法，特别是机器学习中的深度学习的相关算法，对数据的依赖程度较大。仅利用现有的脑磁图数据集，使用机器学习算法进行建模分析，由于训练集患者数量较少，模型可以学到的信号种类偏少，容易出现在训练集上过拟合的问题，导致模型的泛化能力偏低，在临床应用时性能出现明显下降。为了减少上述问题，需要对现有的脑磁图数据进行合理的数据增广。考虑到脑磁图设备主要针对人类大脑内部电流产生的磁场进行观测，需要满足实际物理过程的约束，才能得到合理的增广的脑磁图数据。针对时间序列的信号，业界存在一些常见的增广办法，如在单通道时间序列信号的时域空间、频域空间、成分分解空间、或者模型特征空间上，引入一些扰动，实现数据增广；在脑磁图数据中，使用上述方法进行数据增广，得到的多通道时序信号不符合人类脑部的物理学上电磁场分布，因此增广后的信号不会在临床实际中出现，对改善脑磁图的机器学习模型的泛化能力无明显作用。针对脑磁图数据，存在一些电磁场的建模分析工作，如脑磁源强度定位方法；基于功能磁共振成像的时变约束脑电图或脑磁图溯源方法；这些方法针对患者大脑进行物理学电磁场建模，基于观测到的磁场信号实现大脑内部分电流源的溯源定位；这些方法设定源个数远大于脑磁图头盔传感器个数，对欠定的线性方程增加约束条件，转化为函数优化问题，近似求解部分电流源信号。由于在欠定条件下进行近似求解，因此结果中仅保留部分较强的电流源，无法从这些电流源中重构出原有的脑磁图信号，不适用于脑磁图的数据增广。发明内容为解决上述问题，本发明提供一种机器学习中增广脑磁图数据的方法。该方法包括：步骤一，基于人类大脑模板构建网格顶点数量为的大脑皮层网格模型，将人类大脑模板的头皮表面与脑磁图头盔传感器位置进行配准对齐，网格顶点数量/＞为：；其中，为整除符号，/＞为脑磁图头盔传感器的数量；步骤二，在信号采集时间段内收集所有脑磁图头盔传感器采集的原始信号，信号采集时间段内的采样点个数为，将原始信号预处理后得到头皮表面的磁场信号/＞；步骤三，构建前向模型描述等效电流信号与头皮表面的磁场信号/＞之间的关系，前向模型表示为：；其中，代表导向矩阵，/＞为脑磁图头盔传感器接收到的噪声，/＞表示矩阵点积运算；步骤四，将头皮表面的磁场信号转换为等效电流信号/＞，对前向模型执行空间位置扰动得到空间位置扰动后的前向模型，基于空间位置扰动后的前向模型将等效电流信号转换为头皮表面的磁场信号，作为增广后的脑磁图数据的一部分样本；或者将头皮表面的磁场信号转换为等效电流信号/＞，将等效电流信号/＞执行数值扰动后得到扰动后的等效电流信号/＞，基于前向模型将扰动后的等效电流信号/＞转换为头皮表面的磁场信号，作为增广后的脑磁图数据的一部分样本。进一步的，步骤三中构建前向模型时，忽略脑磁图头盔传感器接收到的噪声。进一步的，定义导向矩阵的第/＞行、第/＞列处的元素为/＞，/＞，，元素/＞的计算方法如下：固定信号采集时间段内的采样点个数为1，将等效电流信号/＞转换为一维的长度为/＞的电流强度矢量/＞，将电流强度矢量/＞的第/＞个分量设置为1，其他分量设置为0，得到第/＞个单位电流强度矢量；将第个单位电流强度矢量拆分为/＞个网格顶点上的长度为3的三维电流强度矢量；使用毕奥-萨伐尔定律，分别计算个网格顶点上的三维电流强度矢量在第/＞个脑磁图头盔传感器处产生的磁场强度矢量；将个磁场强度矢量相加，将相加的结果在第/＞个脑磁图头盔传感器线圈的法向量上的投影长度作为元素/＞的数值。进一步的，步骤四中所述将头皮表面的磁场信号转换为等效电流信号/＞，具体包括：；其中，表示基于导向矩阵/＞计算的逆向矩阵。进一步的，步骤四中所述对前向模型执行空间位置扰动，具体包括：部分网格顶点随机平移、大脑皮层区域整体平移、脑磁图头盔旋转。优选的，所述部分网格顶点随机平移，具体包括：将等效电流信号按照/＞个网格顶点分为/＞组等效电流信号；分别计算每组等效电流信号的L2范数序列：；其中，为信号采集时间段内的一个时刻点，/＞表示在时刻点/＞某组等效电流信号的长度为3的电流分量，/＞为L2范数，/＞表示时序的集合；对每组等效电流信号的L2范数序列计算变异系数，从/＞个变异系数中选取数值最大的/＞个变异系数，/＞；将变异系数最大的个L2范数序列对应的网格顶点作为待平移网格顶点，将待平移网格顶点在大脑皮层网格模型中逐一执行空间位置的随机平移，待平移网格顶点平移后的空间位置/＞为：；；其中，为待平移网格顶点平移前的空间位置，/＞为待平移网格顶点的空间位置的随机平移量，/＞为待平移网格顶点的三个相邻网格顶点的序号，/＞为待平移网格顶点的第/＞个相邻网格顶点的空间位置，/＞为绝对值小于固定阈值的随机数生成函数。优选的，所述脑磁图头盔旋转，具体包括：计算大脑皮层网格模型的个网格顶点的空间位置的平均值，作为脑磁图头盔旋转的中心点的坐标/＞：；其中，为第/＞个网格顶点的空间位置；计算旋转矩阵：；其中，为预定义的三个欧拉角；旋转后的脑磁图头盔传感器的空间位置为：；其中，为脑磁图头盔传感器未旋转前的原始空间位置。进一步的，步骤四中所述将等效电流信号执行数值扰动，具体包括：部分通道加噪、平稳信号抑制、部分通道振幅缩放以及打乱通道顺序。优选的，所述部分通道加噪，具体包括：生成段长度为/＞的高斯白噪声信号，并对每段高斯白噪声进行滤波，/＞为整数且满足/＞；将等效电流信号分为/＞个通道，每个通道的长度为/＞；在个通道中随机选取/＞个通道与/＞段长度为/＞的高斯白噪声信号配对；对每对配对的信号，按预定义的信噪比缩放高斯白噪声信号，并将缩放后的高斯白噪声信号逐采样点叠加到配对的通道的电流信号上，得到/＞个通道的加噪信号；将个通道的加噪信号，替换等效电流信号/＞中的对应通道，得到扰动后的等效电流信号/＞。优选的，所述部分通道振幅缩放，具体包括：将等效电流信号按照/＞个网格顶点分为/＞组等效电流信号；分别计算每组等效电流信号的L2范数序列：；其中，为信号采集时间段内的一个时刻点，/＞表示在时刻点/＞某组等效电流信号的长度为3的电流分量，/＞为L2范数，/＞表示时序的集合；在组等效电流信号中随机选择/＞组，/＞为整数且满足；计算组等效电流信号的缩放参数/＞：；其中，代表取平均值运算，/＞为求标准差运算，/＞为预设的L2范数的缩放参数；基于缩放参数计算/＞组等效电流信号缩放后的电流信号，并用缩放后的电流信号替代等效电流信号/＞中对应的原始信号，得到扰动后的等效电流信号/＞。本申请实施例中提供的一个或多个技术方案，至少具有如下技术效果或优点：本申请通过对大脑皮层网格模型中的所有网格顶点的等效电流信号执行数值扰动，或者对脑磁图的前向模型执行空间位置扰动，实现脑磁图数据的增广。其中，对等效电流信号的数值扰动遵循大脑内神经元放电的生理规律，可以模拟更多可能出现的放电模式；前向模型符合脑磁图中电磁场传播的物理规律，对前向模型执行的空间位置扰动可以模拟更多的患者大脑形态和位置变化，以及佩戴脑磁图头盔的位置变化。本申请的脑磁图数据增广方法，可以覆盖更多的实际使用场景，增加脑磁图数据的多样性。附图说明图1为本发明实施例提供的脑磁图头盔与人类大脑模板对齐示意图。具体实施方式以下结合附图和具体实施例，对本发明进行详细说明，在详细说明本发明各实施例的技术方案前，对所涉及的名词和术语进行解释说明，在本说明书中，名称相同或标号相同的部件代表相似或相同的结构，且仅限于示意的目的。本发明提出了一种机器学习中增广脑磁图数据的方法，该方法构建大脑皮层网格模型，使用所有网格顶点上的等效电流，对大脑内的电生理信号进行数值近似；构建前向模型描述等效电流信号与头皮表面的磁场信号之间的关系，通过对大脑皮层网格模型中的所有网格顶点的等效电流信号执行数值扰动，或者对脑磁图的前向模型执行空间位置扰动，增加脑磁图数据的多样性，以提高基于脑磁图数据的机器学习算法的性能。本发明的具体实现方法如下：1.针对脑磁图的电磁场建立前向模型本步骤旨在建立针对脑磁图的前向模型，描述大脑皮层电流在头皮表面感应磁场的影响。选择并分割一个人类大脑模板以得到大脑皮层区域，利用有限元方法将大脑皮层区域划分为固定数量的网格顶点，并将大脑模板的头皮表面与脑磁图头盔传感器位置进行配准对齐。根据毕奥-萨伐尔定律和脑磁图头盔传感器的数量，建立一个适定或超定的前向模型。1.1构建大脑皮层网格模型选择一个通用人类大脑模板，如MNI152，根据脑部核磁共振的T1结构像将人类大脑模板划分为若干个大脑皮层区域。利用有限元方法将大脑皮层区域划分为个网格顶点数量的网格，使用所有网格顶点上的等效电流，对大脑内的电生理信号进行数值近似，构建大脑皮层网格模型，其中大脑皮层网格模型中的网格顶点数量/＞为：；其中，为整除符号，3是三维空间的维度数，/＞为脑磁图头盔传感器的数量。通过人工设定基准点和ICP迭代算法将人类大脑模板的头皮表面与脑磁图头盔传感器位置进行配准对齐，以确定网格顶点和脑磁图头盔传感器的空间相对位置。对齐后的效果如图1所示，脑磁图头盔与人类大脑模板的头皮表面间距较小，人类大脑模板的头皮被脑磁图头盔半包围。1.2为脑磁图构建前向模型在一段时间内收集所有脑磁图头盔传感器采集的原始信号，将原始信号预处理后得到头皮表面的磁场信号，定义该段时间为信号采集时间段。对原始信号的预处理包括：时域的信号空间分离、去除坏通道、独立成分分析和滤波。通过对原始信号进行预处理，可以去除部分脑磁图头盔外部空间的干扰，以及部分心跳、眼动的干扰。头皮表面的磁场信号即为本发明需要增广的脑磁图数据。脑磁图的前向模型用以描述大脑皮层网格模型中的所有网格顶点的电流，以及在头皮表面的脑磁图头盔传感器处产生的感应磁场的过程。前向模型表示如下：；其中，为前向模型的导向矩阵，/＞为信号采集时间段内大脑皮层网格模型中的所有网格顶点的等效电流信号，/＞为脑磁图头盔传感器接收到的噪声，/＞表示矩阵点积运算。头皮表面的磁场信号/＞是一个/＞的二维矩阵，/＞为信号采集时间段内的采样点个数；导向矩阵/＞是一个/＞的二维矩阵；等效电流信号/＞是一个/＞的二维矩阵。噪声/＞在本发明中忽略。定义导向矩阵的第/＞行、第/＞列处的元素为/＞，/＞，，元素/＞的计算方法如下：将二维的等效电流信号的信号采集时间段内的采样点个数/＞固定为1，得到一维的长度为/＞的电流强度矢量/＞，将电流强度矢量/＞的第/＞个分量设置为1，其他分量设置为0，得到第/＞个单位电流强度矢量；将第个单位电流强度矢量拆分为/＞个网格顶点上的长度为3的三维电流强度矢量；使用毕奥-萨伐尔定律，分别计算个网格顶点上的三维电流强度矢量在第/＞个脑磁图头盔传感器处产生的磁场强度矢量；将个磁场强度矢量相加，将相加的结果在第/＞个脑磁图头盔传感器线圈的法向量上的投影长度作为元素/＞的数值。导向矩阵的第/＞行为长度/＞的矢量，代表/＞个单位电流强度矢量在第个脑磁图头盔传感器上产生的磁场强度分量；导向矩阵/＞的第/＞列为长度/＞的矢量，代表第/＞个单位电流强度矢量在/＞个脑磁图头盔传感器上产生的磁场强度分量。2.空间位置扰动生物系统，包括大脑，都存在自然的、独特的变异性。通过对前向模型执行空间位置扰动，可以模拟这种实际的生物变异性，使前向模型更接近大脑的实际情况。对前向模型执行空间位置扰动时，需要考虑到实际的大脑结构和功能，以及神经科学和生物物理学的相关理论；扰动应该是随机的，以模拟实际生物系统的不确定性和独特性。对前向模型执行空间位置扰动操作包括但不限于：部分网格顶点随机平移、大脑皮层区域整体平移、脑磁图头盔旋转、选用新的脑部核磁共振的T1结构像等。对前向模型执行空间位置扰动可以为一项操作，或多项操作的随机组合。对前向模型执行空间位置扰动后，计算出空间位置扰动后的前向模型的导向矩阵，基于空间位置扰动后的前向模型的导向矩阵/＞将等效电流信号/＞转换为头皮表面的磁场信号作为增广后的脑磁图数据的一部分样本。3.等效电流信号扰动本发明通过对等效电流信号执行扰动模拟实际的生物变异性，使增广后的脑磁图数据分布更接近实际情况。扰动应是随机的，且应保持等效电流信号的基本物理特性。执行等效电流信号扰动需要做两次电磁转换，第一次基于前向模型的逆向矩阵将头皮表面的磁场信号/＞转换为等效电流信号/＞，将等效电流信号/＞执行数值扰动后得到扰动后的等效电流信号/＞，接着执行第二次电磁转换，即基于前向模型将扰动后的等效电流信号/＞转换为头皮表面的磁场信号，以转换后得到的头皮表面的磁场信号作为增广后的脑磁图数据的一部分样本。3.1生成等效电流信号基于前向模型的导向矩阵求解逆向矩阵/＞。前向模型可以为未执行空间位置扰动的前向模型，也可以为执行过空间位置扰动的前向模型。逆向矩阵为/＞的二维矩阵。求解逆向矩阵为本领域公知常识，本发明不再赘述。基于逆向矩阵将头皮表面的磁场信号/＞转换为等效电流信号/＞：；其中，表示矩阵点积运算。3.2数值扰动对等效电流信号执行数值扰动，得到扰动后的等效电流信号/＞。对等效电流信号执行数值扰动操作包括但不限于：部分通道加噪、平稳信号抑制、部分通道振幅缩放、打乱通道顺序等。对等效电流信号执行数值扰动可以为一项操作，或多项操作的随机组合。两次电磁转换中可以一次电磁转换使用未执行空间位置扰动的前向模型，另一次电磁转换使用执行过空间位置扰动的前向模型，此种情况即在增广脑磁图数据的方法中引入了前向模型的空间位置扰动。两次电磁转换也可以都使用未执行空间位置扰动的前向模型。4.增广脑磁图数据本发明提供了前向模型的空间位置扰动及等效电流信号的数值扰动两种扰动类型，增广脑磁图数据的过程中，可以选择任一种类型的扰动或将两种类型的扰动结合。例如，仅执行前向模型的空间位置扰动，具体流程为：先基于逆向矩阵将头皮表面的磁场信号/＞转换为等效电流信号/＞；再执行前向模型的空间位置扰动得到空间位置扰动后的前向模型的导向矩阵/＞，使用空间位置扰动后的前向模型的导向矩阵/＞将等效电流信号/＞转换为头皮表面的磁场信号作为增广的脑磁图数据的一部分样本。或者，仅执行等效电流信号的数值扰动，具体流程为：先基于逆向矩阵将头皮表面的磁场信号/＞转换为等效电流信号/＞；对等效电流信号/＞执行数值扰动得到扰动后的等效电流信号/＞；使用导向矩阵/＞将扰动后的等效电流信号/＞转换为头皮表面的磁场信号作为增广的脑磁图数据的一部分样本。或者，同时执行前向模型的空间位置扰动和等效电流信号的数值扰动，具体流程为：先执行前向模型的空间位置扰动，得到空间位置扰动后的前向模型的导向矩阵，基于空间位置扰动后的前向模型的导向矩阵/＞求解逆向矩阵并将头皮表面的磁场信号/＞转换为等效电流信号/＞；对等效电流信号/＞执行数值扰动得到扰动后的等效电流信号/＞；使用导向矩阵/＞，将扰动后的等效电流信号/＞转换为头皮表面的磁场信号作为增广的脑磁图数据的一部分样本。5.前向模型的空间位置扰动实施例5.1部分网格顶点随机平移5.1.1计算等效电流信号的L2范数序列将等效电流信号按照/＞个网格顶点分为/＞组等效电流信号，每组等效电流信号代表某个网格顶点在三个维度方向的长度为/＞的电流分量。分别计算每组等效电流信号的L2范数序列：；其中，为信号采集时间段内的一个时刻点，/＞表示在时刻点/＞某组等效电流信号的长度为3的电流分量，/＞为L2范数，/＞表示时序的集合。5.1.2将待平移网格顶点随机平移对每组等效电流信号的L2范数序列计算变异系数，从/＞个变异系数中选取数值最大的/＞个变异系数，/＞。本实施例中，将L2范数序列的标准差和L2范数序列的平均值相除作为变异系数。将变异系数最大的个L2范数序列对应的网格顶点作为待平移网格顶点，将待平移网格顶点在大脑皮层网格模型中逐一执行空间位置的随机平移，待平移网格顶点平移后的空间位置/＞为：；；其中，为待平移网格顶点平移前的空间位置，/＞为待平移网格顶点的空间位置的随机平移量，/＞为待平移网格顶点的三个相邻网格顶点的序号，/＞为待平移网格顶点的第/＞个相邻网格顶点的空间位置，/＞为绝对值小于固定阈值的随机数生成函数。相邻网格顶点为根据空间距离计算最近的三个网格顶点，任意两个相邻的网格顶点与待平移的网格顶点不共线。将所有待平移网格顶点执行空间位置随机平移后，基于更新的大脑皮层网格模型计算空间位置扰动后的前向模型的导向矩阵，基于空间位置扰动后的前向模型的导向矩阵/＞将等效电流信号/＞转换为头皮表面的磁场信号作为增广后的脑磁图数据的一部分样本。5.2脑磁图头盔旋转5.2.1计算旋转中心点计算大脑皮层网格模型的个网格顶点的空间位置的平均值，作为脑磁图头盔旋转的中心点的坐标/＞：；其中，为第/＞个网格顶点的空间位置。5.2.2计算旋转矩阵定义三个欧拉角，本实施例中三个欧拉角取值范围为：/＞,,/＞。定义旋转矩阵，旋转矩阵/＞为/＞的二维矩阵，计算公式如下：。5.2.3坐标旋转旋转后的脑磁图头盔传感器的空间位置为：；其中，为脑磁图头盔传感器未旋转前的原始空间位置。基于旋转后的脑磁图头盔传感器的空间位置，计算空间位置扰动后的前向模型的导向矩阵，基于空间位置扰动后的前向模型的导向矩阵/＞将等效电流信号/＞转换为头皮表面的磁场信号，作为增广后的脑磁图数据的一部分样本。6.等效电流信号的数值扰动实施例6.1部分通道加噪生成段长度为/＞的高斯白噪声信号，并对每段高斯白噪声进行滤波，/＞为整数且满足/＞。对每段高斯白噪声进行滤波的滤波参数与对脑磁图头盔传感器采集的原始信号进行预处理时使用的滤波参数相同。等效电流信号为/＞的二维矩阵，将等效电流信号/＞分为/＞个通道，每个通道的长度为/＞。在/＞个通道中随机选取/＞个通道与/＞段长度为/＞的高斯白噪声信号配对。对每对配对的信号，按信噪比缩放高斯白噪声信号，并将缩放后的高斯白噪声信号逐采样点叠加到配对的通道的电流信号上，得到/＞个通道的加噪信号。本实施例中/＞。将个通道的加噪信号，替换等效电流信号/＞中的对应通道，得到扰动后的等效电流信号/＞，基于导向矩阵/＞将扰动后的等效电流信号/＞转换为头皮表面的磁场信号，作为增广后的脑磁图数据的一部分样本。6.2部分通道振幅缩放将等效电流信号按照/＞个网格顶点分为/＞组等效电流信号，每组等效电流信号为/＞的二维矩阵，每组等效电流信号代表某个网格顶点在三个维度方向的长度为/＞的电流分量。在组等效电流信号中随机选择/＞组，/＞为整数且满足。计算组等效电流信号的缩放参数/＞：；其中，为每组等效电流信号的L2范数序列，/＞代表取平均值运算，/＞为求标准差运算，/＞为预设的L2范数的缩放参数，本实施例中设定。由于每组等效电流信号的L2范数序列不同，每组等效电流信号的缩放参数也不同，基于缩放参数/＞计算/＞组等效电流信号缩放后的电流信号，并用缩放后的电流信号替代等效电流信号/＞中对应的原始信号，得到扰动后的等效电流信号/＞，基于导向矩阵/＞将扰动后的等效电流信号/＞转换为头皮表面的磁场信号，作为增广后的脑磁图数据的一部分样本。以上所述实施方式仅仅是对本发明的优选实施方式进行描述，并非对本发明的范围进行限定，在不脱离本发明设计精神的前提下，本领域普通技术人员对本发明的技术方案做出的各种变形和改进，均应落入本发明的权利要求书确定的保护范围内。
