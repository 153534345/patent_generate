标题title
基于轨迹优化的康复设备控制方法
摘要abst
针对现有康复设备运动轨迹单一，无法向患者提供针对性的训练及可能对患者造成二次伤害的问题，本发明公开的基于轨迹优化的康复设备控制方法，属于康复训练领域。本发明通过力传感器采集患者施加给康复设备末端的作用力，将采集到的末端力应用到康复控制器的设计中，通过实时优化康复训练的轨迹，使康复设备按照优化后的轨迹引导患者进行针对性的康复训练；利用滑模控制对干扰不敏感的特性来减少患者在康复训练过程中患肢颤抖给系统带来的不确定性和不稳定性。康复设备与患者交互时采用非连接式的结构，根据患者的实际情况设置康复训练的最大活动范围，保证患者安全的同时也使康复设备以更人性化的方式与患者交互。
权利要求书clms
1.基于轨迹优化的康复设备控制方法，其特征在于：包括如下步骤，步骤一、在考虑患者对康复设备末端施加的作用力时，康复设备在关节空间的动力学方程描述为其中，t表示时间，是康复设备各关节角度，是康复设备的惯性矩阵，是康复设备的向心力矩阵，是康复设备的重力矩阵，是各个关节的控制输入，J是将关节空间中的变量映射到笛卡尔空间的雅可比矩阵，是患者作用在康复设备末端的力，表示实数域，n表示关节数量；康复设备在笛卡尔空间中的动力学方程为其中，表示康复设备在笛卡尔空间中的关节角，是康复设备笛卡尔空间中的惯性矩阵，是康复设备笛卡尔空间中的向心力矩阵，是康复设备笛卡尔空间中的重力矩阵，是康复设备的控制输入；并且，M)＝J-TMd)J-1，G)＝J-TGd),τ＝JTu；通过式，得到状态空间方程如下其中，0m表示维数为m×m的零矩阵，Im表示维数为m×m的单位矩阵，此处m＝n；步骤二、利用最优控制，结合六维力传感器，优化在外力影响下的康复训练轨迹；已知状态方程形式的康复设备动力学方程为其中，C＝Bf+Δ；引入一个新的状态函数其中，xd表示期望轨迹，即康复训练最终要实现的轨迹；得表示如下定义一个关于的成本函数其中，Q是半正定的实对称矩阵，R是正定的实对称矩阵；最优控制解uo为其中，P满足黎卡提方程η满足方程将式代入式，解出最优状态解xo最终可得康复系统的最优状态，因为所以我们可以得到最优轨迹θo；步骤三、将步骤二得到的优化后的康复训练轨迹，运用到控制器的设计中，以获得更稳定的控制效果；此时，外力的影响在最优轨迹θo中体现，模型中的外力项f被消去；即采用最优康复训练轨迹的康复设备在笛卡尔空间中的动力学方程写为用步骤二中得到的最优轨迹θo设计滑模面So其中，eo＝θ-θo，β是eo的权重；对式求导得将公式代入，并令得设计控制输入项u其中，Ms)、和Gs)分别为M)、和G)的名义值；Ψ是滑模控制的权重，Ψ＝diag，；Sat表示饱和函数。2.如权利要求1所述的基于轨迹优化的康复设备控制方法，其特征在于：还包括步骤四，对基于轨迹优化的康复设备控制方法进行稳定性分析，采用李雅普诺夫函数保证系统的稳定性；采用李雅普诺夫函数保证系统的稳定性，设计李雅普诺夫函数V如下对公式求导得令ΔM＝M)-Ms)，ΔG＝G)-Gs)，将公式代入，得取则当且仅当So＝0时，故t→∞时，So→0；此时的控制律能够保证系统的稳定性。
说明书desc
技术领域本发明涉及一种基于轨迹优化的康复设备控制方法，属于康复训练领域。背景技术传统的纯结构式的康复设备只能提供固定轨迹的康复训练，运动轨迹单一。初级的带有电机的康复设备也只是实现了设备的自动运动。这两者均无法根据患者的恢复情况提供针对性的康复训练，并且可能对患者造成二次伤害。所以，智能化的康复设备的设计及其控制方法的研究显得尤为重要。由于康复训练的特殊性及对安全性和交互性的高要求，现有的控制技术直接运用到康复设备上，无法取得较好的效果。根据患者恢复情况的不同，施加给康复设备的作用力也不同，外力带来的额外负载，会影响康复设备的控制效果。由于患者力量不足或肌张力过大引起的患肢颤抖现象会给系统带来不确定性，影响控制系统的稳定性，进而影响康复训练的有效性和安全性。康复设备需要与患者交互，患者的安全问题也是需要考虑的。康复设备应保证训练过程中患者的安全性，避免给患者带来二次伤害。发明内容针对现有康复设备运动轨迹单一，无法向患者提供针对性的训练及可能对患者造成二次伤害的问题，本发明主要目的是提供一种基于轨迹优化的康复设备控制方法，该方法通过力传感器采集患者施加给康复设备末端的作用力，将采集到的末端力应用到康复控制器的设计中，通过实时优化康复训练的轨迹，使康复设备按照优化后的轨迹引导患者进行针对性的康复训练；利用滑模控制对干扰不敏感的特性来减少患者在康复训练过程中患肢颤抖给系统带来的不确定性和不稳定性。康复设备与患者交互时采用非连接式的结构，根据患者的实际情况设置康复训练的最大活动范围，保证患者安全的同时也使康复设备以更人性化的方式与患者交互。本发明的目的是通过下述技术方案实现的。本发明公开的基于轨迹优化的康复设备控制方法，包括如下步骤：步骤一、在考虑患者对康复设备末端施加的作用力时，康复设备在关节空间的动力学方程描述为其中，t表示时间，是康复设备各关节角度，是康复设备的惯性矩阵，是康复设备的向心力矩阵，是康复设备的重力矩阵，是各个关节的控制输入，J是将关节空间中的变量映射到笛卡尔空间的雅可比矩阵，是患者作用在康复设备末端的力，表示实数域，n表示关节数量。康复设备在笛卡尔空间中的动力学方程为其中，表示康复设备在笛卡尔空间中的关节角，是康复设备笛卡尔空间中的惯性矩阵，是康复设备笛卡尔空间中的向心力矩阵，是康复设备笛卡尔空间中的重力矩阵，是康复设备的控制输入。并且，M)＝J-TMd)J-1，G)＝J-TGd),τ＝JTu。通过式，得到状态空间方程如下其中，0m表示维数为m×m的零矩阵，Im表示维数为m×m的单位矩阵，此处m＝n。步骤二、利用最优控制，结合六维力传感器，优化在外力影响下的康复训练轨迹。已知状态方程形式的康复设备动力学方程为其中，C＝Bf+Δ。引入一个新的状态函数其中，xd表示期望轨迹，即康复训练最终要实现的轨迹。得表示如下定义一个关于的成本函数其中，Q是半正定的实对称矩阵，R是正定的实对称矩阵。最优控制解uo为其中，P满足黎卡提方程η满足方程将式代入式，解出最优状态解xo最终得康复系统的最优状态，因为所以能够得到最优轨迹θo。步骤三、将步骤二得到的优化后的康复训练轨迹，运用到控制器的设计中，以获得更稳定的控制效果。此时，外力的影响在最优轨迹θo中体现，模型中的外力项f被消去。即采用最优康复训练轨迹的康复设备在笛卡尔空间中的动力学方程写为用步骤二中得到的最优轨迹θo设计滑模面So其中，eo＝θ-θo，β是eo的权重。对式求导得将公式代入，并令得设计控制输入项u其中，Ms)、和Gs)分别为M)、和G)的名义值。Ψ是滑模控制的权重，Ψ＝diag，。Sat表示饱和函数。步骤四、对基于轨迹优化的康复设备控制方法进行稳定性分析，采用李雅普诺夫函数保证系统的稳定性。采用李雅普诺夫函数保证系统的稳定性，设计李雅普诺夫函数V如下对公式求导得令ΔM＝M)-Ms)，ΔG＝G)-Gs)，将公式代入，得取则当且仅当So＝0时，故t→∞时，So→0。此时的控制律能够保证系统的稳定性。有益效果1、本发明公开的基于轨迹优化的康复设备控制方法，考虑到患者施加给康复设备的作用力，而不是只考虑康复设备本身。通过设计轨迹调节器，实时优化康复训练的轨迹。使康复设备沿着优化后的轨迹引导患者进行运动，以保证康复训练的针对性和有效性。2、本发明公开的基于轨迹优化的康复设备控制方法，利用滑模控制对干扰不敏感的特性来减少患者在康复训练过程中患肢颤抖给系统带来的不确定性。3、本发明公开的基于轨迹优化的康复设备控制方法，能够解决传统康复仪器运动轨迹单一、适用性不强的问题。本发明中的康复系统能够为康复训练提供多种训练轨迹，适应不同恢复情况的患者。4、本发明公开的基于轨迹优化的康复设备控制方法，康复设备与患者交互时采用非连接式的结构，保证患者安全的同时也使康复设备以更人性化的方式与患者交互。附图说明图1是康复系统图。图2是外力变化示意图。图3是引入干扰示意图。图4是控制结构图。图5是控制系统流程图。图6是关节位置图。图7是康复过程示意图。具体实施方式下面将结合附图和实施例对本发明加以详细说明。同时也叙述了本发明技术方案解决的技术问题及有益效果，需要指出的是，所描述的实施例仅旨在便于对本发明的理解，而对其不起任何限定作用。本实施例针对有上肢康复需求的患者进行手臂训练。训练内容是患者的肩膀不动，手跟随机器人末端的抓握装置进行运动。实施例采用二自由度串联式的康复设备，整个康复系统如图1所示。为了验证所提方法的有效性，保证康复训练能够顺利进行并达到预期的效果。本实施例模拟了患者施加给康复设备的力是变化的，且康复训练过程中患肢存在颤抖现象的情况。给控制系统输入如图2所示的外力项，来模拟康复训练过程中患者施加给康复设备末端的作用力。输入如图3所示的干扰，来模拟康复训练中患肢颤抖给系统带来的干扰。控制结构图如图4所示，按照设计的控制结构，对康复设备进行控制。步骤一、在考虑患者对康复设备末端施加的作用力时，康复设备在关节空间的动力学方程描述为其中，t表示时间，是康复设备各关节角度，是康复设备的惯性矩阵，是康复设备的向心力矩阵，是康复设备的重力矩阵，是各个关节的控制输入，J是将关节空间中的变量映射到笛卡尔空间的雅可比矩阵，是患者作用在康复设备末端的力，表示实数域，n表示关节数量。康复设备在笛卡尔空间中的动力学方程为其中，表示康复设备在笛卡尔空间中的关节角，是康复设备笛卡尔空间中的惯性矩阵，是康复设备笛卡尔空间中的向心力矩阵，是康复设备笛卡尔空间中的重力矩阵，是康复设备的控制输入。并且，M)＝J-TMd)J-1，G)＝J-TGd),τ＝JTu。通过式，得到状态空间方程如下其中，0m表示维数为m×m的零矩阵，Im表示维数为m×m的单位矩阵，此处m＝n。步骤二、利用最优控制，结合六维力传感器，优化在外力影响下的康复训练轨迹。已知状态方程形式的康复设备动力学方程为其中，C＝Bf+Δ。引入一个新的状态函数其中，xd表示康复训练最终要实现的轨迹。可得表示如下定义一个关于的成本函数其中，Q是半正定的实对称矩阵，R是正定的实对称矩阵。最优控制解uo为其中，P满足黎卡提方程η满足方程将式代入式，可解出最优状态解xo最终可得康复系统的最优状态，因为所以能够得到最优轨迹θo。步骤三、将步骤二得到的优化后的最优康复训练轨迹，运用到控制器的设计中，以获得更稳定的控制效果。此时，外力的影响在最优轨迹θo中体现，模型中的外力项f可以被消去。即采用最优康复训练轨迹的康复设备在笛卡尔空间中的动力学方程可写为用步骤二中得到的最优轨迹θo设计滑模面So其中，eo＝θ-θo，β是eo的权重。对式求导可得将公式代入，并令可得设计控制输入项u其中，Ms)、和Gs)分别为M)、和G)的名义值。Ψ是滑模控制的权重，Ψ＝diag，。Sat表示饱和函数。步骤四、稳定性分析。采用李雅普诺夫函数保证系统的稳定性，设计李雅普诺夫函数V如下对公式求导可得令ΔM＝M)-Ms)，ΔG＝G)-Gs)，将公式代入，可得取则当且仅当So＝0时，故t→∞时，So→0。此时的控制律能够保证系统的稳定性。完整的控制流程图如图5所示。将得到的控制输入u输入给康复设备，采集设备运行时的实际位置、优化位置等数据，并对数据进行分析，得到结论如下。如图6所示，康复设备某旋转关节以0.5rad/s的角速度进行匀速旋转，由于受到外力项和干扰项的影响，期望信号和最优信号存在一定的偏差。实际信号跟随最优信号的效果很好，几乎没有延迟和误差。这就表示，在患者手臂力量不足或肌张力过大时，会对康复设备末端施加阻力，无法按照期望轨迹完成康复训练。为了不使患者受到二次伤害，康复设备不再按期望轨迹运行，而是根据患者施加的作用力，规划出新的轨迹，即最优轨迹进行运动。康复训练是同一动作多次重复的过程，患者需要进行成百上千次的训练。这是一个由患者可实现的运动空间向理想的运动空间不断接近的过程。如图7所示，使患者手臂跟随机器人末端按圆形轨迹进行康复训练。随着患者不断地重复康复训练，优化轨迹的范围也会越来越大，当优化轨迹与理想轨迹几乎重合时，即当趋近于0时，患者能够达到正常人的运动范围，即认为患者达到了康复目的。本发明致力于使这个过程考虑到患者的实际情况，让这个过程更加患者友好，在保证患者安全的前提下，实现康复训练的有效性。本发明设计了一种基于轨迹优化的康复设备控制方法。首先根据患者的康复情况，预设一个期望的康复训练运动轨迹。但在实际康复运动过程中，由于康复设备末端受到患者施加的作用力，并不能按照期望轨迹运行。所以此时，期望的轨迹不再是理想的轨迹。为了获得更好的控制效果，在进行控制器设计前，利用最优控制方法，结合六维力传感器，得到在外力影响下的优化后的康复训练轨迹。滑模控制方法能够有效减少患者在康复训练过程中患肢颤抖给系统带来的不确定性，使控制系统具有优良的鲁棒性。本发明考虑了环境的影响，可以保证康复过程中人的安全。所提出的控制方法的优越性已在康复设备的实施例中得到验证。结果表明，该控制方法能够人性化的优化患者的康复训练轨迹，降低患肢颤抖给系统带来的不确定性，在康复训练过程中具有良好的稳定性。以上所述的具体描述，对发明的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上所述仅为本发明的具体实施例而已，并不用于限定本发明的保护范围，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
