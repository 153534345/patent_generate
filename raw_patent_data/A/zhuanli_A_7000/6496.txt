标题title
基于联合递归量化的孤独症谱系障碍亚型分类方法及装置
摘要abst
本发明公开了基于联合递归量化的孤独症谱系障碍亚型分类方法及装置，属于医学图像技术领域，包括：基于ASD的rs‑fMRI图像获取每个ROI的BOLD信号；对每个ROI中获取的BOLD信号进行相位变换得到瞬时相位序列，获取功能连接矩阵序列；基于ROI间的功能连接矩阵序列构建脑网络内和脑网络间动态功能连接的状态空间轨迹；根据网络内和脑网络间动态功能连接的状态空间轨迹计算脑网络的联合递归图JRP，进一步的计算JRP的递归特征；以脑网络的JRP的递归特征为聚类特征，应用k均值聚类对ASD进行亚型分类。本发明实现通过ASD的rs‑fMRI图像获取其大脑网络功能交互过程中的非线性特征，从而获取ASD亚型。
权利要求书clms
1.一种基于联合递归量化的孤独症谱系障碍亚型分类方法，其特征在于：包括以下步骤：基于ASD的rs-fMRI图像获取每个ROI的BOLD信号；对每个ROI中获取的BOLD信号进行相位变换得到瞬时相位序列，并计算ROI间的功能连接，获取功能连接矩阵序列；基于ROI间的功能连接矩阵序列构建脑网络内和脑网络间动态功能连接的状态空间轨迹；根据网络内和脑网络间动态功能连接的状态空间轨迹计算脑网络的联合递归图JRP，进一步的计算JRP的递归特征；以脑网络的JRP的递归特征为聚类特征，应用k均值聚类对ASD进行亚型分类。2.根据权利要求1所述的基于联合递归量化的孤独症谱系障碍亚型分类方法，其特征在于：基于ASD的rs-fMRI图像获取每个ROI的BOLD信号包括：基于脑区先验模板从经过预处理的rs-fMRI图像中提取每个ROI的BOLD信号，获取T×R矩阵，其中T为BOLD信号的时间点个数，R为ROI个数。3.根据权利要求1所述的基于联合递归量化的孤独症谱系障碍亚型分类方法，其特征在于：对每个ROI中获取的BOLD信号进行相位变换得到瞬时相位序列，并计算ROI间的功能连接，获取功能连接矩阵序列，具体包括以下步骤：对于每个ROI的BOLD信号，即长度为T的序列x，其中x为T×1向量，利用希尔伯特变换获得其解析表式xa：xa＝x+jH其中H表示希尔伯特变换；然后对于x的解析表式xa进行相位变换得到瞬时相位序列计算每对ROI的瞬时相位序列之间的余弦相似性r：其中为T×1向量，/＞表示两个ROI的相位差，使用余弦相似性r来评估ROI间的功能连接，从而获取动态功能连接矩阵，即T×R×R矩阵。4.根据权利要求1所述的基于联合递归量化的孤独症谱系障碍亚型分类方法，其特征在于：基于ROI间的功能连接矩阵序列构建脑网络内和脑网络间动态功能连接的状态空间轨迹包括：基于动态功能连接矩阵分别构建脑网络内和脑网络间动态功能连接的状态空间轨迹，其中动态功能连接矩阵为T×R×R矩阵，每对ROI之间的动态功能连接视为独立的状态空间变量，状态空间变量为T×1向量，状态空间轨迹是通过广义函数从功能连接序列构造的：其中和/＞表示脑网络内和脑网络间动态功能连接的状态空间轨迹，/＞表示状态空间中的正交单位向量，M和N表示脑网络内和脑网络间动态功能连接的独立状态空间变量的个数。5.根据权利要求1所述的基于联合递归量化的孤独症谱系障碍亚型分类方法，其特征在于：根据网络内和脑网络间动态功能连接的状态空间轨迹计算脑网络的JRP，进一步的计算JRP的递归特征包括：计算脑网络的JRP；基于构建的脑网络内和脑网络间动态功能连接的状态空间轨迹和/＞分别计算递归图RP：其中Θ表示希尔伯特变换，ε是一个自定的距离阈值，表示状态/＞和状态/＞之间的欧氏距离；然后基于脑网络内和脑网络间的动态功能连接的RP来计算脑网络的JRP：其中，εp表示系统p的距离阈值；计算JRP的递归特征；通过联合递归量化分析对JRP中递归点构成的结构的特征进行量化分析计算其递归特征，包括确定率DET、平均对角线长度L、熵ENTR、散度DIV、层流率LAM和捕获时间TT，其中DET、L、ENTR和DIV是与对角线结构相关的递归特征，其计算方法如下：其中lmin表示对角线结构的最小长度，P是对角线结构长度为l的直方图，LAM和TT是与垂直/水平线结构相关的递归特征，其计算方法如下：其中νmin表示垂直结构的最小长度，即在连续两次测量中持续重复的模式，P是垂直结构长度为v的直方图。6.根据权利要求1所述的基于联合递归量化的孤独症谱系障碍亚型分类方法，其特征在于：以脑网络的JRP的递归特征为聚类特征，应用k均值聚类对ASD进行亚型分类包括：以JRP的递归特征作为聚类特征，对ASD个体进行k均值聚类获取ASD亚型，JRP的递归特征包括DET、L、ENTR、DIV、LAM和TT。7.一种基于联合递归量化分析的ASD亚型分类装置，其特征在于：使用如权利要求1～6任一项所述的基于联合递归量化的孤独症谱系障碍亚型分类方法，包括：输入模块，被配置为ASD的rs-fMRI数据的输入；预处理模块，被配置为对获取的ASD的rs-fMRI数据进行预处理，并基于先验的脑区模板提取所有ROI的BOLD信号；相位变换模块，被配置为对每个ROI的BOLD信号进行希尔伯特变换，并进一步的将BOLD信号转换为瞬时相位序列；动态功能连接计算模块，被配置为对瞬时相位序列计算余弦相似性来评估ROI间的动态功能连接；相空间重构模块，被配置为根据脑网络内和脑网络间每对ROI之间的动态功能连接来构建瞬时相位序列的空间轨迹；联合递归模块，被配置为根据脑网络内和脑网络间动态功能连接的相空间轨迹，构建网络内和网络间的RP，进而构建脑网络的JRP用于表述脑网络的动态功能连接分离和聚合的非线性特征；ASD亚型分类模块，被配置为根据获得的脑网络的动态功能连接分离和聚合的非线性特征，获得ASD的分亚型结果，其中分离和聚合的非线性特征包括DET、L、ENTR、DIV、LAM和TT。
说明书desc
技术领域本发明涉及医学图像技术领域，尤其是基于联合递归量化的孤独症谱系障碍亚型分类方法及装置。背景技术孤独症谱系障碍是一种早发性神经发育障碍，其核心症状是社会交往和沟通障碍，同时伴有重复和刻板的行为模式。美国疾病控制与预防中心发病率和死亡率周报显示根据2020年的最新统计数据分析，每36名8岁儿童中就有一名被确认患有ASD。虽然近年来针对ASD的遗传学和神经影像学研究日益增长，但是其发病机制仍不清楚，因此目前仍然没有统一有效的治疗方案与药物。静息态功能磁共振成像通过血氧水平依赖信号的变化获得大脑静息态下的自发活动信息，其被广泛应用于ASD大脑功能连接模式的分析中。然而在不断开展的ASD大脑功能连接模式分析中，也出现了不一致的结果，特别是在ASD大脑非典型区域的一致性上仍有争议。ASD的异质性可能是造成这些不一致结果的原因，利用rs-fMRI划分ASD亚型从而进一步揭示ASD的神经异质性机制是一种研究ASD异质性的有效手段。传统的ASD亚型分析方法基于静息态功能连接，即基于ASD大脑BOLD信号的线性相关进行ASD亚型划分，但是这往往忽略了大脑网络功能交互中所包含的非线性特征。本发明提出一种基于联合递归量化分析实现ASD亚型分类方法及装置，该发明基于动态系统的分析方法获取ASD大脑网络功能交互的详细时空描述，并通过进一步的计算获取时空描述中的非线性特征，从而实现基于ASD大脑网络功能交互的非线性特征获取ASD亚型。发明内容本发明需要解决的技术问题是提供一种基于联合递归量化的孤独症谱系障碍亚型分类方法及装置，能够弥补ASD亚型获取技术无法利用ASD大脑网络功能交互过程中非线性信息的不足，实现通过ASD的rs-fMRI图像获取其大脑网络功能交互过程中的非线性特征，从而获取ASD亚型。为解决上述技术问题，本发明所采用的技术方案是：一种基于联合递归量化的孤独症谱系障碍亚型分类方法，包括以下步骤：基于ASD的rs-fMRI图像获取每个ROI的BOLD信号；对每个ROI中获取的BOLD信号进行相位变换得到瞬时相位序列，并计算ROI间的功能连接，获取功能连接矩阵序列；基于ROI间的功能连接矩阵序列构建脑网络内和脑网络间动态功能连接的状态空间轨迹；根据网络内和脑网络间动态功能连接的状态空间轨迹计算脑网络的联合递归图JRP，进一步的计算JRP的递归特征；以脑网络的JRP的递归特征为聚类特征，应用k均值聚类对ASD进行亚型分类。本发明技术方案的进一步改进在于：基于ASD的rs-fMRI图像获取每个ROI的BOLD信号包括：基于脑区先验模板从经过预处理的rs-fMRI图像中提取每个ROI的BOLD信号，获取T×R矩阵，其中T为BOLD信号的时间点个数，R为ROI个数。本发明技术方案的进一步改进在于：对每个ROI中获取的BOLD信号进行相位变换得到瞬时相位序列，并计算ROI间的功能连接，获取功能连接矩阵序列，具体包括以下步骤：对于每个ROI的BOLD信号，即长度为T的序列x，其中x为T×1向量，利用希尔伯特变换获得其解析表式xa：xa＝x+jH其中H表示希尔伯特变换；然后对于x的解析表式xa进行相位变换得到瞬时相位序列：计算每对ROI的瞬时相位序列之间的余弦相似性r：其中为T×1向量，/＞表示两个ROI的相位差，使用余弦相似性r来评估ROI间的功能连接，从而获取动态功能连接矩阵，即T×R×R矩阵。本发明技术方案的进一步改进在于：基于ROI间的功能连接矩阵序列构建脑网络内和脑网络间动态功能连接的状态空间轨迹包括：基于动态功能连接矩阵分别构建脑网络内和脑网络间动态功能连接的状态空间轨迹，其中动态功能连接矩阵为T×R×R矩阵，每对ROI之间的动态功能连接视为独立的状态空间变量，状态空间变量为T×1向量，状态空间轨迹是通过广义函数从功能连接序列构造的：其中和/＞表示脑网络内和脑网络间动态功能连接的状态空间轨迹，/＞表示状态空间中的正交单位向量，M和N表示脑网络内和脑网络间动态功能连接的独立状态空间变量的个数。本发明技术方案的进一步改进在于：根据网络内和脑网络间动态功能连接的状态空间轨迹计算脑网络的JRP，进一步的计算JRP的递归特征包括：计算脑网络的JRP；基于构建的脑网络内和脑网络间动态功能连接的状态空间轨迹和/＞分别计算递归图RP：其中Θ表示希尔伯特变换，ε是一个自定的距离阈值，表示状态/＞和状态/＞之间的欧氏距离；然后基于脑网络内和脑网络间的动态功能连接的RP来计算脑网络的JRP：其中，εp表示系统p的距离阈值；计算JRP的递归特征；通过联合递归量化分析对JRP中递归点构成的结构的特征进行量化分析计算其递归特征，包括确定率DET、平均对角线长度L、熵ENTR、散度DIV、层流率LAM和捕获时间TT，其中DET、L、ENTR和DIV是与对角线结构相关的递归特征，其计算方法如下：其中lmin表示对角线结构的最小长度，P是对角线结构长度为l的直方图，LAM和TT是与垂直/水平线结构相关的递归特征，其计算方法如下：其中νmin表示垂直结构的最小长度，即在连续两次测量中持续重复的模式，P是垂直结构长度为ν的直方图。本发明技术方案的进一步改进在于：以脑网络的JRP的递归特征为聚类特征，应用k均值聚类对ASD进行亚型分类包括：以JRP的递归特征作为聚类特征，对ASD个体进行k均值聚类获取ASD亚型，JRP的递归特征包括DET、L、ENTR、DIV、LAM和TT。一种基于联合递归量化分析的ASD亚型分类装置，包括：输入模块，被配置为ASD的rs-fMRI数据的输入；预处理模块，被配置为对获取的ASD的rs-fMRI数据进行预处理，并基于先验的脑区模板提取所有ROI的BOLD信号；相位变换模块，被配置为对每个ROI的BOLD信号进行希尔伯特变换，并进一步的将BOLD信号转换为瞬时相位序列；动态功能连接计算模块，被配置为对瞬时相位序列计算余弦相似性来评估ROI间的动态功能连接；相空间重构模块，被配置为根据脑网络内和脑网络间每对ROI之间的动态功能连接来构建瞬时相位序列的空间轨迹；联合递归模块，被配置为根据脑网络内和脑网络间动态功能连接的相空间轨迹，构建网络内和网络间的RP，进而构建脑网络的JRP用于表述脑网络的动态功能连接分离和聚合的非线性特征；ASD亚型分类模块，被配置为根据获得的脑网络的动态功能连接分离和聚合的非线性特征，获得ASD的分亚型结果，其中分离和聚合的非线性特征包括DET、L、ENTR、DIV、LAM和TT。由于采用了上述技术方案，本发明取得的技术进步是：1、本发明可以对脑网络的动态功能交互进行联合递归量化分析，提取到脑网络动态功能连接分离和聚合的非线性特征。2、本发明通过相空间轨迹构建的形式背景建立方法，实现时间序列到状态空间轨迹的转变，可直观地揭示脑网络功能连接的动态演化规律。而且通过将脑网络动态功能连接分离和聚合的递归特性获取，提供了脑网络内和脑网络间的ROI之间功能连接动态交互的非线性特征。本技术方案弥补了传统的基于线性相关衡量脑区间功能连接的方法的缺陷，能获取脑网络动态功能连接分离和聚合的非线性特征，达到基于脑网络动态功能连接分离和聚合的非线性特征对ASD进行分亚型的目的，从而可以对ASD脑网络功能模式的异质性进行进一步的揭示。应当注意的是，以上的描述和后文的具体实例的描述仅是示例性和解释性的，并不能限制本发明。附图说明图1为本发明提供的基于联合递归量化分析实现ASD亚型分类方法实现的流程图；图2是根据本发明实施方式的一种基于联合递归量化分析的ASD亚型分类装置的结构框图。具体实施方式下面结合附图及实施例对本发明做进一步详细说明：如图1所示，基于联合递归量化的孤独症谱系障碍亚型分类方法，包括以下步骤：S1、基于ASD的rs-fMRI图像获取每个感兴趣区域的BOLD信号；具体包括：基于脑区先验模板从经过预处理的rs-fMRI图像中提取每个ROI的BOLD信号，获取T×R矩阵，其中T为BOLD信号的时间点个数，R为ROI个数。S2、对每个ROI中获取的BOLD信号进行相位变换得到瞬时相位序列，并计算ROI间的功能连接，获取功能连接矩阵序列；具体包括：对于每个ROI的BOLD信号，即长度为T的序列x，其中x为T×1向量，利用希尔伯特变换获得其解析表式xa：xa＝x+jH其中H表示希尔伯特变换；然后对于x的解析表式xa进行相位变换得到瞬时相位序列计算每对ROI的瞬时相位序列之间的余弦相似性r：其中为T×1向量，/＞表示两个ROI的相位差，使用余弦相似性r来评估ROI间的功能连接，从而获取动态功能连接矩阵，即T×R×R矩阵。S3、基于ROI间的功能连接矩阵序列构建脑网络内和脑网络间动态功能连接的状态空间轨迹；具体包括：基于动态功能连接矩阵分别构建脑网络内和脑网络间动态功能连接的状态空间轨迹，其中动态功能连接矩阵为T×R×R矩阵，每对ROI之间的动态功能连接视为独立的状态空间变量，状态空间变量为T×1向量，状态空间轨迹是通过广义函数从功能连接序列构造的：其中和/＞表示脑网络内和脑网络间动态功能连接的状态空间轨迹，/＞表示状态空间中的正交单位向量，M和N表示脑网络内和脑网络间动态功能连接的独立状态空间变量的个数。S4、根据网络内和脑网络间动态功能连接的状态空间轨迹计算脑网络的联合递归图，进一步的计算JRP的递归特征；具体包括以下步骤：S41计算脑网络的JRP；基于构建的脑网络内和脑网络间动态功能连接的状态空间轨迹和/＞分别计算递归图：其中Θ表示希尔伯特变换，ε是一个自定的距离阈值，表示状态/＞和状态之间的欧氏距离；然后基于脑网络内和脑网络间的动态功能连接的RP来计算脑网络的JRP：其中，εp表示系统p的距离阈值；S42计算JRP的递归特征；通过联合递归量化分析对JRP中递归点构成的结构的特征进行量化分析计算其递归特征，包括确定率、平均对角线长度、熵、散度、层流率和捕获时间，其中DET、L、ENTR和DIV是与对角线结构相关的递归特征，其计算方法如下：其中lmin表示对角线结构的最小长度，P是对角线结构长度为l的直方图，LAM和TT是与垂直/水平线结构相关的递归特征，其计算方法如下：其中vmin表示垂直结构的最小长度，即在连续两次测量中持续重复的模式，P是垂直结构长度为v的直方图。S5、以脑网络的JRP的递归特征为聚类特征，应用k均值聚类对ASD进行亚型分类；具体包括：以JRP的递归特征作为聚类特征，对ASD个体进行k均值聚类获取ASD亚型，JRP的递归特征包括DET、L、ENTR、DIV、LAM和TT。如图2所示，一种基于联合递归量化分析的ASD亚型分类装置，包括：输入模块，被配置为ASD的rs-fMRI数据的输入；预处理模块，被配置为对获取的ASD的rs-fMRI数据进行预处理，并基于先验的脑区模板提取所有ROI的BOLD信号；相位变换模块，被配置为对每个ROI的BOLD信号进行希尔伯特变换，并进一步的将BOLD信号转换为瞬时相位序列；动态功能连接计算模块，被配置为对瞬时相位序列计算余弦相似性来评估ROI间的动态功能连接；相空间重构模块，被配置为根据脑网络内和脑网络间每对ROI之间的动态功能连接来构建瞬时相位序列的空间轨迹；联合递归模块，被配置为根据脑网络内和脑网络间动态功能连接的相空间轨迹，构建网络内和网络间的RP，进而构建脑网络的JRP用于表述脑网络的动态功能连接分离和聚合的非线性特征；ASD亚型分类模块，被配置为根据获得的脑网络的动态功能连接分离和聚合的非线性特征，获得ASD的分亚型结果，其中分离和聚合的非线性特征包括DET、L、ENTR、DIV、LAM和TT。综上所述，本发明可以对脑网络的动态功能交互进行联合递归量化分析，提取到脑网络动态功能连接分离和聚合的非线性特征。本发明通过相空间轨迹构建的形式背景建立方法，实现时间序列到状态空间轨迹的转变，可直观地揭示脑网络功能连接的动态演化规律。而且通过将脑网络动态功能连接分离和聚合的递归特性获取，提供了脑网络内和脑网络间的ROI之间功能连接动态交互的非线性特征。本技术方案弥补了传统的基于线性相关衡量脑区间功能连接的方法的缺陷，能获取脑网络动态功能连接分离和聚合的非线性特征，达到基于脑网络动态功能连接分离和聚合的非线性特征对ASD进行分亚型的目的，从而可以对ASD脑网络功能模式的异质性进行进一步的揭示。
