标题title
一种多模态网络控制信令防窃听方法、交换机及存储介质
摘要abst
本发明涉及一种多模态网络控制信令防窃听方法、交换机及存储介质，所述方法包括：在接收到的报文为信令报文时，读取移位密钥对所述信令报文执行移位加密转换，将转换后的信令报文附加前置头，形成packet_in报文发送；接收到SDN控制器反馈的packet_out报文，判断为加密信令报文时，采用所述移位密钥执行移位解密转换，获得解密报文，发送至指定主机终端，所述packet_out报文基于packet_in报文处理后生成；所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。与现有技术相比，本发明通过轻量化的移位转换机制实现多模态网络中的灵活、低开销的控制信令防窃听。
权利要求书clms
1.一种多模态网络控制信令防窃听方法，其特征在于，该方法运行于可编程交换机中，所述可编程交换机用于实现多模态网络中报文的转发，可编程交换机分别连接主机终端和SDN控制器，该方法包括以下步骤：实时接收主机终端的报文，在接收到的报文为信令报文时，读取移位密钥对所述信令报文执行移位加密转换，将转换后的信令报文附加前置头，形成packet_in报文，发送至SDN控制器；接收到SDN控制器反馈的packet_out报文，根据所述packet_out报文中的前置头判断为加密信令报文时，采用所述移位密钥执行移位解密转换，获得解密报文，发送至指定主机终端，所述packet_out报文基于packet_in报文处理后生成；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。2.根据权利要求1所述的多模态网络控制信令防窃听方法，其特征在于，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。3.根据权利要求1所述的多模态网络控制信令防窃听方法，其特征在于，所述前置头包括type字段和port字段，所述type字段用于指示信令报文类型，所述port字段用于指示packet_in的入端口和packet_out的出端口。4.根据权利要求1所述的多模态网络控制信令防窃听方法，其特征在于，所述移位密钥定时更新，更新步骤包括：接收到SDN控制器反馈的packet_out报文，根据所述packet_out报文中的前置头判断为密钥更新报文时，使用当前移位密钥解密报文内容，获得更新密钥，并以所述更新密钥加密所述当前移位密钥，添加前置头构造更新确认报文发送给SDN控制器；若在设定时间内未收到新的密钥更新报文，则将当前移位密钥替换为所述更新密钥，否则重复上一步骤；其中，所述SDN控制器维护一超时时间，若一移位密钥的使用时间超过所述超时时间，则产生所述密钥更新报文，密钥更新报文中的更新密钥为随机生成，SDN控制器接收到所述更新确认报文后，以所述更新密钥解密获得加密部分，判断加密部分是否与当前移位密钥相同，若是，则更新结束，若否，则重新产生密钥更新报文。5.根据权利要求1所述的多模态网络控制信令防窃听方法，其特征在于，根据模态以太网帧类型进行所述数据块的划分。6.一种多模态网络控制信令防窃听方法，其特征在于，该方法运行于SDN控制器中，所述SDN控制器通过可编程交换机与主机终端连接，该方法包括以下步骤：接收可编程交换机的packet_in报文，根据所述packet_in报文中的前置头判断为加密信令报文时，根据可编程交换机ID读取预先配置的移位密钥，采用所述移位密钥执行移位解密转换，获得解密报文，基于解密报文和未加密报文进行处理，所述packet_in报文为可编程交换机对接收到的主机终端的信令报文，利用移位密钥加密形成；根据处理结果产生反馈信令报文，采用所述移位密钥对反馈信令报文进行移位加密转换，将转换后的信令报文附加前置头，形成packet_out报文，发送给对应的可编程交换机；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。7.根据权利要求6所述的多模态网络控制信令防窃听方法，其特征在于，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。8.根据权利要求6所述的多模态网络控制信令防窃听方法，其特征在于，所述前置头包括type字段和port字段，所述type字段用于指示信令报文类型，所述port字段用于指示packet_in的入端口和packet_out的出端口。9.根据权利要求6所述的多模态网络控制信令防窃听方法，其特征在于，所述移位密钥定时更新，更新步骤包括：SDN控制器维护一超时时间，若某个可编程交换机的当前移位密钥的使用时间超过所述超时时间，则随机生成一更新密钥，以所述当前移位密钥加密所述更新密钥，添加前置头构造密钥更新报文，发送给可编程交换机；接收到可编程交换机反馈的packet_out报文，根据所述packet_out报文中的前置头判断为更新确认报文时，以所述更新密钥解密获得加密部分，判断加密部分是否与当前移位密钥相同，若是，则更新结束，若否，则重新产生密钥更新报文，返回上一步；其中，所述更新确认报文为由可编程交换机以所述更新密钥加密所述当前移位密钥，并添加前置头构造而成。10.根据权利要求6所述的多模态网络控制信令防窃听方法，其特征在于，根据模态以太网帧类型进行所述数据块的划分。11.一种可编程交换机，其特征在于，包括：寄存模块，用于存储最新的移位密钥；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。12.根据权利要求11所述的可编程交换机，其特征在于，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。13.一种SDN控制器，其特征在于，包括：密钥管理模块，用于存储所有建立连接的可编程交换机的最新的移位密钥，并基于预设的超时时间对移位密钥进行定时更新；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。14.根据权利要求13所述的SDN控制器，其特征在于，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。15.一种实现控制信令防窃听的多模态网络，其特征在于，包括依次连接的SDN控制器、可编程交换机和主机终端，其中，所述可编程交换机包括：寄存模块，用于存储最新的移位密钥；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；所述SDN控制器包括：密钥管理模块，用于存储所有建立连接的可编程交换机的最新的移位密钥，并基于预设的超时时间对移位密钥进行定时更新；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。16.根据权利要求15所述的实现控制信令防窃听的多模态网络，其特征在于，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。17.一种计算机可读存储介质，其特征在于，包括供电子设备的一个或多个处理器执行的一个或多个程序，所述一个或多个程序包括用于执行如权利要求1-10任一所述多模态网络控制信令防窃听方法的指令。
说明书desc
技术领域本发明属于计算机多模态网络控制技术领域，尤其涉及一种多模态网络控制信令防窃听方法、交换机及存储介质。背景技术多模态网络以网络架构全维可定义为基础，能够基于各种模态实现全业务承载、智慧化管理控制、全方位覆盖能力，但随着多模态网络中可编程网元设备规模以及业务承载能力的扩大，SDN控制器逐渐成为网络系统攻击的主要切入点。传统的攻击目标是数据平面对的终端设备以及服务器，随着多模态网络的推广，针对SDN控制器的攻击方式日益增多，其安全性面临严重挑战。其中控制链路的安全又是SDN控制器安全的薄弱环节，控制链路安全的研究受到两方面的挑战，即既要保证信令信息的时效，又要保证信令信息的安全、防范窃听。目前针对控制链路的安全主要是通过信道加密技术保证的，但该种方式在面对多模态网络中数量庞大的信令交换会产生较大的时延，然而多模态网络中信令信息时效性很强，相关映射更新频率快、安全风险高，因此多模态网络的发展需要提供更加高效、时延更低、同时能够保证信令信息安全的防范窃听方式。发明内容本发明的目的就是为了克服上述现有技术存在的缺陷、针对多模态网络中高效、低时延的防范控制信令窃听需求而提供一种多模态网络控制信令防窃听方法、交换机及存储介质。本发明的目的可以通过以下技术方案来实现：本发明的第一方面提供一种多模态网络控制信令防窃听方法，该方法运行于可编程交换机中，所述可编程交换机用于实现多模态网络中报文的转发，可编程交换机分别连接主机终端和SDN控制器，该方法包括以下步骤：实时接收主机终端的报文，在接收到的报文为信令报文时，读取移位密钥对所述信令报文执行移位加密转换，将转换后的信令报文附加前置头，形成packet_in报文，发送至SDN控制器；接收到SDN控制器反馈的packet_out报文，根据所述packet_out报文中的前置头判断为加密信令报文时，采用所述移位密钥执行移位解密转换，获得解密报文，发送至指定主机终端，所述packet_out报文基于packet_in报文处理后生成；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。进一步地，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。进一步地，所述前置头包括type字段和port字段，所述type字段用于指示信令报文类型，所述port字段用于指示packet_in的入端口和packet_out的出端口。进一步地，所述移位密钥定时更新，更新步骤包括：接收到SDN控制器反馈的packet_out报文，根据所述packet_out报文中的前置头判断为密钥更新报文时，使用当前移位密钥解密报文内容，获得更新密钥，并以所述更新密钥加密所述当前移位密钥，添加前置头构造更新确认报文发送给SDN控制器；若在设定时间内未收到新的密钥更新报文，则将当前移位密钥替换为所述更新密钥，否则重复上一步骤；其中，所述SDN控制器维护一超时时间，若一移位密钥的使用时间超过所述超时时间，则产生所述密钥更新报文，密钥更新报文中的更新密钥为随机生成，SDN控制器接收到所述更新确认报文后，以所述更新密钥解密获得加密部分，判断加密部分是否与当前移位密钥相同，若是，则更新结束，若否，则重新产生密钥更新报文。进一步地，根据模态以太网帧类型进行所述数据块的划分。本发明的第二方面提供一种多模态网络控制信令防窃听方法，该方法运行于SDN控制器中，所述SDN控制器通过可编程交换机与主机终端连接，该方法包括以下步骤：接收可编程交换机的packet_in报文，根据所述packet_in报文中的前置头判断为加密信令报文时，根据可编程交换机ID读取预先配置的移位密钥，采用所述移位密钥执行移位解密转换，获得解密报文，基于解密报文和未加密报文进行处理，所述packet_in报文为可编程交换机对接收到的主机终端的信令报文，利用移位密钥加密形成；根据处理结果产生反馈信令报文，采用所述移位密钥对反馈信令报文进行移位加密转换，将转换后的信令报文附加前置头，形成packet_out报文，发送给对应的可编程交换机；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。进一步地，所述前置头包括type字段和port字段，所述type字段用于指示信令报文类型，所述port字段用于指示packet_in的入端口和packet_out的出端口。进一步地，所述移位密钥定时更新，更新步骤包括：SDN控制器维护一超时时间，若某个可编程交换机的当前移位密钥的使用时间超过所述超时时间，则随机生成一更新密钥，以所述当前移位密钥加密所述更新密钥，添加前置头构造密钥更新报文，发送给可编程交换机；接收到可编程交换机反馈的packet_out报文，根据所述packet_out报文中的前置头判断为更新确认报文时，以所述更新密钥解密获得加密部分，判断加密部分是否与当前移位密钥相同，若是，则更新结束，若否，则重新产生密钥更新报文，返回上一步；其中，所述更新确认报文为由可编程交换机以所述更新密钥加密所述当前移位密钥，并添加前置头构造而成。进一步地，根据模态以太网帧类型进行所述数据块的划分。本发明的第三方面提供一种可编程交换机，包括：寄存模块，用于存储最新的移位密钥；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。进一步地，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。本发明的第四方面提供一种SDN控制器，包括：密钥管理模块，用于存储所有建立连接的可编程交换机的最新的移位密钥，并基于预设的超时时间对移位密钥进行定时更新；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。进一步地，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。本发明的第五方面提供一种实现控制信令防窃听的多模态网络，包括依次连接的SDN控制器、可编程交换机和主机终端，其中，所述可编程交换机包括：寄存模块，用于存储最新的移位密钥；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；所述SDN控制器包括：密钥管理模块，用于存储所有建立连接的可编程交换机的最新的移位密钥，并基于预设的超时时间对移位密钥进行定时更新；移位模块，用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块，用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。进一步地，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。本发明的第六方面提供一种计算机可读存储介质，包括供电子设备的一个或多个处理器执行的一个或多个程序，所述一个或多个程序包括用于执行如上所述多模态网络控制信令防窃听方法的指令。与现有技术相比，本发明具有以下有益效果：1、本发明针对控制信令时效性强的特点，采用一种轻量化的移位转换机制对控制信令进行加解密处理，能够在保证信令信息安全、无需加密信道的情况下，实现低开销的加密，保证信令信息的实效性，相较于传统信道加密的方式，能够有效降低加解密时延，同时通过多模态网络全维可定义的功能，能够自定义信令报文的类型和混淆粒度，实现控制信令安全的软件定义和自定义扩展，能够实现灵活、低开销的控制信令防窃听。2、本发明采用一串预配置的二进制串作为移位密钥，存储方便，节省空间。3、本发明对移位密钥进行定时更新处理，有效提高加密案例性，并进一步提升多模态网络控制信令防窃听的可靠性。附图说明图1为本发明的结构示意图；图2为可编程网元数据链路信令报文处理流程图；图3为可编程网元控制链路信令报文处理流程图。具体实施方式下面结合附图和具体实施例对本发明进行详细说明。本实施例以本发明技术方案为前提进行实施，给出了详细的实施方式和具体的操作过程，但本发明的保护范围不限于下述的实施例。实施例1如图1所示，本实施例提供一种实现控制信令防窃听的多模态网络，包括依次连接的SDN控制器、可编程交换机和主机终端。主机终端可以包括WEB服务器、IP终端、GEO终端、MF终端、生产者和消费者等。网络中还可以包括地理位置标识无线接入点GEO_AP、身份位置标识接入点MF_AP等其他网元。WEB服务器、IP终端、GEO_AP、MF_AP、生产者、消费者通过有线链路连接至可编程交换机，MF终端通过无线链路连接至身份位置标识模态AP，GEO终端通过无线链路连接至地理位置标识模态AP。可编程交换机通过控制链路连接至SDN控制器。本实施例中，SDN控制器通过多个可编程交换机与多个主机终端形成连接。本实施例中，SDN控制器负责处理可编程交换机转发的信令报文，包括密钥管理模块、移位模块和数据包处理模块，其中，密钥管理模块用于存储所有建立连接的可编程交换机的最新的移位密钥，每个移位密钥与可编程交换机ID关联，实现数据平面可编程交换机的移位密钥的管理；移位模块用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块负责将数据包进行解序列化，将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容，具体是按照不同类型数据包进行解析，对数据包字段进行修改、增加、删除，能够将数据包序列化后发送至数据平面。其中，移位密钥是一串预配置的二进制串，每一位用于指示该位数据块是否需要移位，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。参考图1所示，本实施例中，可编程交换机设有5个，密钥管理模块中存储的可编程交换机的移位密钥实例如表1所示。表1可编程交换机ID移位密钥P4_1K11:101111001011P4_2K21:001010001001P4_3K32:011110100011P4_4K43:110100101010P4_5K51:100011101110可编程交换机负责转发多模态网络数据包，通过控制链路转发信令信息，包括寄存模块、移位模块和数据包处理模块，其中，寄存模块用于存储最新的移位密钥；移位模块用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容，具体是按照不同类型数据包进行解析，对数据包字段进行修改、增加、删除，能够将数据包序列化后发送至SDN控制器或者其他可编程交换机。上述多模态网络中，主机或其他网元通过主动/被动方式通过可编程交换机向SDN控制器发送信令报文，SDN控制器根据模态流程发送信令报文进行响应；其中，所述主动方式是主机、其他网元触发主动发送的方式；所述被动方式是可编程交换机、其他网元或SDN控制器通过心跳包探测感知；所述信令报文是主机与其他网元设备与SDN控制器交互产生的控制信令，具体的，包括主机与其他网元设备发送给SDN控制器的注册、查询、链路状态信令以及SDN控制器发送给主机与其他网元设备确认、响应信令；所述模态流程是不同模态网络控制信令触发与响应流程与机制。上述多模态网络实现控制信令防窃听的具体过程包括：步骤1：可编程交换机通过预设方法在入端口判断报文是否为信令报文，若为信令报文，移位模块读取寄存模块中移位密钥对所述信令报文执行移位加密转换，数据包处理模块将信令报文转换为packet_in报文，并通过控制链路上送至SDN控制器；其中，所述预设方法是可编程交换机预配置的报文处理逻辑；所述移位加密转换是指将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位；所述packet_in报文为加密转换后的信令报文附加前置头后形成的报文。如图2所示，以可编程交换机P4_1为例，其处理数据链路数据包的步骤包括：可编程交换机P4_1通过预设方法在入端口判断报文是否为信令报文，若为信令报文，移位模块读取寄存模块中移位密钥对所述信令报文执行移位加密转换，/＞是ID为的可编程交换机/＞的第/＞个移位密钥，数据包处理模块将信令报文转换为packet_in报文，数据包前置头类型字段为TYPE_ECS_IN，在本实施例中，类型字段为0x10，并通过控制链路上送至SDN控制器。步骤2：SDN控制器数据包处理模块去除packet_in报文前置头，根据type字段判断是否解密，若需要解密，密钥管理模块根据可编程交换机ID读取预先配置的移位加密密钥，数据包处理模块通过移位解密转换对packet_in报文进行解密，将解密后报文以及未加密报文传递给其他模块处理；其中，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位。步骤3：SDN控制器向指定可编程交换机产生信令报文，密钥管理模块读取上述可编程交换机ID对应的移位密钥，通过数据包处理模块进行移位加密转换，转换为packet_out报文，通过控制链路下发给上述可编程交换机；其中，所述packet_out报文为上述信令报文通过移位加密后附加前置头形成的报文。步骤4：可编程交换机的数据包处理模块去除packet_out报文前置头，根据前置头判断是否为加密信令报文，若为加密信令报文，则通过移位模块进行移位解密转换，将解密报文发送至指定端口。参考图3所示，以可编程交换机P4_1为例，可编程交换机接收到SDN控制器反馈的packet_out报文后，去除packet_out报文前置头，根据前置头对报文类型进行判断，若为加密信令报文则使用移位密钥解密，并按指定端口转发，若为不加密的信念报文，则直接转发。上述步骤中，步骤2、3、4中涉及的前置头包括以下字段：type字段、port字段。type字段用于指示信令报文类型。具体的，type字段为TYPE_UECS_IN代表可编程交换机上送至SDN控制器的未经加密信令报文，在具体实施方式中，字段值可为0x10；type字段为TYPE_ECS_IN代表可编程交换机上送至SDN控制器的加密信令报文，在具体实施方式中，字段值可为字段值为0x11；type字段为TYPE_UECS_OUT代表SDN控制器下发给可编程交换机的未经加密信令报文，在具体实施方式中，字段值可为0x20；type字段为TYPE_ECS_OUT代表SDN控制器下发给可编程交换机的加密信令报文，在具体实施方式中，字段值可为0x21；type字段为TYPE_RENEW代表SDN控制器下发给可编程交换机的移位密钥更新报文，在具体实施方式中，字段值可为0x22；type字段为TYPE_CONFIRM代表可编程交换机上送给SDN控制器的更新确认报文，在具体实施方式中，字段值可为0x13。port字段用于指示packet_in的入端口以及packet_out的出端口。上述步骤中，移位模块读取移位密钥对信令报文执行移位加密转换的步骤包括：步骤1-1：读取可编程交换机移位密钥，其中/＞表示代表移位密钥的第/＞位二进制，/＞表示二进制串的位数，移位模块根据预配置将报文待加密部分/＞划分为/＞部分，即/＞，其中/＞表示待加密部分的第/＞块，/＞表示第/＞次移位操作；步骤1-2：移位模块从至/＞依次读取/＞，若/＞的值为1，则执行动作/＞，若/＞的值为0，则不进行操作。以可编程交换机P4_1为例，移位加密转换具体包括：读取可编程交换机P4_1移位密钥，根据预配置将报文待加密部分/＞划分为/＞部分，即/＞，从/＞至/＞依次读取/＞，若的值为1，则执行动作/＞，若/＞的值为0，则不进行操作。步骤1-1中的预配置是根据模态以太网帧类型将不同长度信令报文分成n块，具体的，内容标识模态分块为bit＜Length_NDN＞；身份位置标识模态分块为bit＜Length_MF＞；地理位置标识模态分块为bit＜Length_GEO＞；IP模态分块为bit＜Length_IP＞。步骤1-2中的动作具体包括以下步骤：步骤2-1：移位模块将第块存入缓存/＞，具体的/＞；步骤2-2：移位模块从至/＞读取/＞，将/＞中第/＞块的值赋值给第/＞块，具体的，/＞；步骤2-3：移位模块将缓存赋值给/＞，具体的，/＞。以上述可编程交换机P4_1为例，动作的步骤包括：移位模块将第块存入缓存/＞，具体的/＞，从/＞至/＞读取/＞，将/＞中第/＞块的值赋值给第/＞块，具体的，/＞；将缓存/＞赋值给/＞，具体的，/＞。上述步骤中，移位模块执行移位解密转换的步骤包括：步骤3-1：读取移位密钥，其中/＞表示代表移位密钥的第/＞位二进制，数据包处理模块根据预配置将密文部分/＞划分为/＞部分，即，其中/＞表示密文部分/＞的第/＞块，/＞表示第/＞次移位操作；步骤3-2：数据包处理模块维护加密索引、指针/＞和指针/＞，具体的，数据包处理模块从/＞至/＞按位读取/＞，若/＞的值为1，则将/＞的值赋值给/＞，否则不进行操作，/＞值为/＞，/＞的值为/＞；步骤3-3：数据包处理模块从至/＞按位读取/＞，若/＞的值为1，则将密文/＞第/＞块赋值给第/＞块，同时/＞加1，具体的，/＞，/＞；若/＞的值为0，则将密文/＞第/＞块赋值给第/＞块，同时/＞减1，具体的，/＞，。以上述可编程交换机P4_1为例，移位解密转换的步骤包括：读取移位密钥，数据包处理模块根据预配置将密文部分划分为/＞部分，即/＞，从/＞至/＞按位读取/＞，若/＞的值为1，则将/＞的值赋值给/＞，否则不进行操作，/＞值为/＞，/＞的值为/＞；从/＞至/＞按位读取/＞，若/＞的值为1，则将密文/＞第/＞块赋值给第/＞块，同时/＞加1，若/＞的值为0，则将密文/＞第/＞块赋值给第/＞块，同时/＞减1。在优选的实施方式中，SDN控制器的密钥管理模块还基于预设的超时时间对移位密钥进行定时更新，以维护网络内可编程交换机移位密钥，每条移位密钥设置超时时间，其中，/＞是ID为/＞的可编程交换机/＞的第/＞个移位密钥；/＞代表移位加密密钥/＞的超时时间。更新过程具体包括以下步骤：步骤4-1：当定时器超过/＞后，密钥管理模块随机生成移位密钥/＞并记录在/＞的密钥列表，移位模块使用/＞进行/＞的移位加密转换，数据包处理模块添加前置头产生packet_out报文并通过控制链路下发给/＞，具体的，前置头type字段内容为TYPE_RENEW；步骤4-2：可编程交换机去除packet_out报文前置头，根据前置头type字段判断为密钥更新报文，移位模块使用/＞解密出/＞传递给寄存模块暂存，移位模块使用加密/＞，数据包处理模块添加前置头构造更新确认报文并通过控制链路发送给SDN控制器，具体的，前置头type字段内容为TYPE_CONFIRM；步骤4-3：SDN控制器接收到TYPE_CONFIRM类型的packet_in报文，数据包处理模块去掉前置头，密钥管理模块根据可编程交换机ID查找到以及/＞，移位模块接收解密出加密部分/＞，若/＞则SDN控制器密钥更新完成，具体的，密钥管理模块删除/＞密钥列表中/＞，若/＞则执行步骤4-1；步骤4-4：可编程交换机等待超时时间之后，没有再收到来自SDN控制器的密钥更新报文，寄存模块将移位密钥替换为/＞，可编程交换机密钥更新完成，若再次收到TYPE_RENEW类型的packet_out报文，则进行步骤4-2。参考图3所示，可编程交换机在接收到SDN控制器发送的packet_out报文后，掉前置头，判断报文类型，若报文类型为TYPE_RENEW，且未超过等待超时时间，则进行上述密钥更新操作，否则进一步判断报文类型是否为TYPE_ECS_OUT，若是，则用当前移位密钥执行移位加密转换，发送至指定端口，若报文类型为TYPE_UECS_OUT，则直接发送。实施例2本实施例提供一种多模态网络控制信令防窃听方法，该方法运行于可编程交换机中，可编程交换机用于实现多模态网络中报文的转发，可编程交换机分别连接主机终端和SDN控制器，该方法包括以下步骤：实时接收主机终端的报文，在接收到的报文为信令报文时，读取移位密钥对所述信令报文执行移位加密转换，将转换后的信令报文附加前置头，形成packet_in报文，发送至SDN控制器；接收到SDN控制器反馈的packet_out报文，根据所述packet_out报文中的前置头判断为加密信令报文时，采用所述移位密钥执行移位解密转换，获得解密报文，发送至指定主机终端，所述packet_out报文基于packet_in报文处理后生成；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位，所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。优选地，移位密钥定时更新，更新步骤包括：接收到SDN控制器反馈的packet_out报文，根据所述packet_out报文中的前置头判断为密钥更新报文时，使用当前移位密钥解密报文内容，获得更新密钥，并以所述更新密钥加密所述当前移位密钥，添加前置头构造更新确认报文发送给SDN控制器；若在设定时间内未收到新的密钥更新报文，则将当前移位密钥替换为所述更新密钥，否则重复上一步骤；其中，所述SDN控制器维护一超时时间，若一移位密钥的使用时间超过所述超时时间，则产生所述密钥更新报文，密钥更新报文中的更新密钥为随机生成，SDN控制器接收到所述更新确认报文后，以所述更新密钥解密获得加密部分，判断加密部分是否与当前移位密钥相同，若是，则更新结束，若否，则重新产生密钥更新报文。实施例3本实施例提供一种多模态网络控制信令防窃听方法，该方法运行于SDN控制器中，所述SDN控制器通过可编程交换机与主机终端连接，该方法包括以下步骤：接收可编程交换机的packet_in报文，根据所述packet_in报文中的前置头判断为加密信令报文时，根据可编程交换机ID读取预先配置的移位密钥，采用所述移位密钥执行移位解密转换，获得解密报文，基于解密报文和未加密报文进行处理，所述packet_in报文为可编程交换机对接收到的主机终端的信令报文，利用移位密钥加密形成；根据处理结果产生反馈信令报文，采用所述移位密钥对反馈信令报文进行移位加密转换，将转换后的信令报文附加前置头，形成packet_out报文，发送给对应的可编程交换机；其中，所述移位加密转换是将报文负载划分为若干个数据块，根据移位密钥对若干数据块进行移位，所述移位解密转换是将报文加密负载划分为若干数据块，通过移位密钥进行反向移位所述移位密钥为一串预配置的二进制串，二进制数为1时，指示数据块执行移位，二进制数为0时，不进行操作。优选地，移位密钥定时更新，更新步骤包括：SDN控制器维护一超时时间，若某个可编程交换机的当前移位密钥的使用时间超过所述超时时间，则随机生成一更新密钥，以所述当前移位密钥加密所述更新密钥，添加前置头构造密钥更新报文，发送给可编程交换机；接收到可编程交换机反馈的packet_out报文，根据所述packet_out报文中的前置头判断为更新确认报文时，以所述更新密钥解密获得加密部分，判断加密部分是否与当前移位密钥相同，若是，则更新结束，若否，则重新产生密钥更新报文，返回上一步，其中，所述更新确认报文为由可编程交换机以所述更新密钥加密所述当前移位密钥，并添加前置头构造而成。上述方法如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。实施例4本实施例提供一种可编程交换机，负责转发多模态网络数据包，通过控制链路转发信令信息，包括寄存模块、移位模块和数据包处理模块，其中，寄存模块用于存储最新的移位密钥；移位模块用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块用于将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容，具体是按照不同类型数据包进行解析，对数据包字段进行修改、增加、删除，能够将数据包序列化后发送至SDN控制器或者其他可编程交换机。该可编程交换机执行实施例2中的方法。实施例5本实施例提供一种SDN控制器，负责处理可编程交换机转发的信令报文，包括密钥管理模块、移位模块和数据包处理模块，其中，密钥管理模块用于存储所有建立连接的可编程交换机的最新的移位密钥，每个移位密钥与可编程交换机ID关联，实现数据平面可编程交换机的移位密钥的管理；移位模块用于读取所述移位密钥对报文执行移位加密转换，若者，读取所述移位密钥对加密内容执行移位解密转换；数据包处理模块负责将数据包进行解序列化，将转换后的报文附加前置头，形成发送报文，或者，对接收到的报文去除前置头，获取加密内容，具体是按照不同类型数据包进行解析，对数据包字段进行修改、增加、删除，能够将数据包序列化后发送至数据平面。该SDN控制器执行实施例3中的方法。对于一个技术的改进可以很明显地区分是硬件上的改进还是软件上的改进。然而，随着技术的发展，当今的很多方法流程的改进已经可以视为硬件电路结构的直接改进。设计人员几乎都通过将改进的方法流程编程到硬件电路中来得到相应的硬件电路结构。因此，不能说一个方法流程的改进就不能用硬件实体模块来实现。例如，可编程逻辑器件）就是这样一种集成电路，其逻辑功能由用户对器件编程来确定。由设计人员自行编程来把一个数字系统“集成”在一片PLD上，而不需要请芯片制造厂商来设计和制作专用的集成电路芯片。而且，如今，取代手工地制作集成电路芯片，这种编程也多半改用“逻辑编译器”软件来实现，它与程序开发撰写时所用的软件编译器相类似，而要编译之前的原始代码也得用特定的编程语言来撰写，此称之为硬件描述语言，而HDL也并非仅有一种，而是有许多种，如ABEL、AHDL、Confluence、CUPL、HDCal、JHDL、Lava、Lola、MyHDL、PALASM、RHDL等，目前最普遍使用的是VHDL与Verilog。本领域技术人员也应该清楚，只需要将方法流程用上述几种硬件描述语言稍作逻辑编程并编程到集成电路中，就可以很容易得到实现该逻辑方法流程的硬件电路。控制器可以按任何适当的方式实现，例如，控制器可以采取例如微处理器或处理器以及存储可由该处理器执行的计算机可读程序代码的计算机可读介质、逻辑门、开关、专用集成电路、可编程逻辑控制器和嵌入微控制器的形式，控制器的例子包括但不限于以下微控制器：ARC 625D、Atmel AT91SAM、Microchip PIC18F26K20 以及Silicone Labs C8051F320，存储器控制器还可以被实现为存储器的控制逻辑的一部分。本领域技术人员也知道，除了以纯计算机可读程序代码方式实现控制器以外，完全可以通过将方法步骤进行逻辑编程来使得控制器以逻辑门、开关、专用集成电路、可编程逻辑控制器和嵌入微控制器等的形式来实现相同功能。因此这种控制器可以被认为是一种硬件部件，而对其内包括的用于实现各种功能的装置也可以视为硬件部件内的结构。或者甚至，可以将用于实现各种功能的装置视为既可以是实现方法的软件模块又可以是硬件部件内的结构。上述实施例阐明的系统、装置、模块或单元，具体可以由计算机芯片或实体实现，或者由具有某种功能的产品来实现。一种典型的实现设备为计算机。具体的，计算机例如可以为个人计算机、膝上型计算机、蜂窝电话、相机电话、智能电话、个人数字助理、媒体播放器、导航设备、电子邮件设备、游戏控制台、平板计算机、可穿戴设备或者这些设备中的任何设备的组合。为了描述的方便，描述以上装置时以功能分为各种单元分别描述。当然，在实施本发明时可以把各单元的功能在同一个或多个软件和/或硬件中实现。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明是参照根据本发明实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。在一个典型的配置中，计算设备包括一个或多个处理器、输入/输出接口、网络接口和内存。内存可能包括计算机可读介质中的非永久性存储器，随机存取存储器和/或非易失性内存等形式，如只读存储器或闪存。内存是计算机可读介质的示例。计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存、静态随机存取存储器、动态随机存取存储器、其他类型的随机存取存储器、只读存储器、电可擦除可编程只读存储器、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体，如调制的数据信号和载波。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。本领域技术人员应明白，本发明的实施例可提供为方法、系统或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明可以在由计算机执行的计算机可执行指令的一般上下文中描述，例如程序模块。一般地，程序模块包括执行特定任务或实现特定抽象数据类型的例程、程序、对象、组件、数据结构等等。也可以在分布式计算环境中实践本发明，在这些分布式计算环境中，由通过通信网络而被连接的远程处理设备来执行任务。在分布式计算环境中，程序模块可以位于包括存储设备在内的本地和远程计算机存储介质中。本发明中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于系统实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。以上所述仅为本发明的实施例而已，并不用于限制本发明。对于本领域技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本发明的权利要求范围之内。
