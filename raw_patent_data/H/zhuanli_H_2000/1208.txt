标题title
基于位置密钥低轨卫星抗量子接入认证的卫星通信方法
摘要abst
本发明属于卫星网络安全通信领域，具体涉及一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，包括：地面控制中心获取卫星的位置和身份信息、用户的位置和身份信息；将位置信息作为密钥生成参数，地面控制中心为用户和卫星分配位置密钥；用户设备采用位置密钥对当前的位置信息进行加密，将包含位置信息的接入认证请求发送给低轨卫星；低轨卫星对用户设备发送请求进行验证，若验证成功，返回接入响应；用户设备对接入响应进行验证，若验证成功，用户设备接入卫星，完成注册；注册成功后的用户设备和低轨卫星进行通信；本方法利用位置信息的独特性增强了认证的准确性，并能够抵抗用户设备被捕获而造成的密钥泄露攻击。
权利要求书clms
1.一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，包括：构建低轨卫星通信系统，该系统包括控制中心、用户设备、低轨卫星；用户设备和低轨卫星向控制中心发起认证注册请求；注册成功后的用户设备与低轨卫星之间进行通信；用户设备和低轨卫星向控制中心发起认证注册请求包括：S1：低轨卫星通信系统中的控制中心选择安全参数，根据安全参数生成系统参数；S2：用户设备和低轨卫星分别向控制中心发起注册请求；S3：控制中心根据注册请求分别生成低轨卫星的位置密钥、用户设备的位置密钥以及注册响应；将位置密钥和注册响应分别返回给用户设备和低轨卫星；S4：用户设备采用位置密钥对当前的位置信息进行加密，将包含位置信息的接入认证请求发送给低轨卫星；S5：低轨卫星对用户设备发送的认证请求进行验证，若验证成功，则对位置信息进行验证；若位置信息验证成功，则执行步骤S6，否则用户接入低轨卫星失败；S6：低轨卫星对用户设备的身份信息认证成功，返回接入响应；S7：用户设备对低轨卫星发送的接入响应进行认证，若认证成功，则完成用户设备对低轨卫星的接入，否则接入失败。2.根据权利要求1所述的一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，生成系统参数包括：地面控制中心进行系统初始化；随机选取一个质数q=poly，地面控制中心为用户设备生成临时身份标识PIDu，地面控制中心为低轨卫星生成临时身份标识PIDs；生成系统密钥，选择防碰撞的哈希函数；其中，q=poly表示选择一个多项式poly作为质数q的生成器；/＞表示系统密钥，s表示随机选取的系统主密钥，P表示生成元，/＞为防碰撞哈希函数，/＞表示有限域。3.根据权利要求1所述的一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，用户设备和低轨卫星向控制中心发起注册请求包括：用户身份IDu、用户当前位置信息Lu、用户注册时间戳T1，卫星身份IDs、卫星当前位置信息Ls、卫星注册时间戳T2。4.根据权利要求1所述的一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，控制中心生成的位置密钥为：其中，KDF为密钥生成算法，/＞为系统主密钥，/＞为低轨卫星的临时身份标识，N为系统生成的随机数，L为位置信息。5.根据权利要求1所述的一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，用户设备向低轨卫星发送接入认证请求的过程包括：用户设备获取当前时间和位置信息；根据用户设备的真实身份计算加密密钥；采用位置密钥LKu计算消息认证码MAC1；根据加密密钥和消息认证码计算认证向量Vu=PIDu||AES||MAC1||T1；将当前位置信息Lu'和认证向量Vu嵌入到接入认证信息中，并向卫星发送接入认证请求；其中/＞表示加密密钥，/＞表示密钥生成算法，/＞表示系统主密钥，/＞表示用户身份，/＞表示用户注册时间戳，/＞为用户临时身份标识，/＞表示对称加密算法，/＞表示用户设备生成的随机数，/＞表示用户设备的位置信息。6.根据权利要求1所述的一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，低轨卫星对用户设备发送请求进行验证包括：低轨卫星验证用户设备发送的时间戳T1是否有效，若有效，则计算解密密钥对收到的用户设备的认证向量V解密获取其中的位置信息Lu；将计算出的位置信息Lu与从用户设备接收到的位置信息进行Lu'对比，若对比结果正确，则收到用户设备请求，否则用户设备请求失败。7.根据权利要求1所述的一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，低轨卫星对对位置信息进行验证包括：低轨卫星采用控制中心发送的位置密钥计算用户设备发送位置信息，得到新的消息认证码MAC1'；比较消息认证码MAC1'与从用户设备接收到的消息认证码MAC1是否相等，若相等则判断用户设备为合法用户，获取当前卫星的时间T2与位置信息Ls，计算加密密钥SKs与认证向量Vs，将位置数据与认证向量嵌入到接入认证响应信息中发送给用户设备。8.根据权利要求1所述的一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，其特征在于，用户设备对低轨卫星发送的接入响应进行认证包括：检查卫星时间戳T2的有效性，若有效则计算解密密钥，根据计算出的解密密钥对收到的卫星认证向量进行解密，得到位置数据；将计算出的位置数据与收到的卫星位置进行对比，若对比结果正确，则由位置密钥计算消息认证码MAC2'，比较计算出的消息认证码MAC2'与从卫星收到消息认证码MAC2是否相等，若相等则判断卫星为合法节点，完成接入认证；否则认证失败；其中，/＞表示卫星临时身份标识，/＞表示对称加密算法，/＞表示卫星的加密密钥，/＞表示卫星生成的随机数，/＞表示卫星的位置信息。
说明书desc
技术领域本发明属于卫星网络安全通信领域，具体涉及一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法。背景技术随着地面5G移动通信技术的快速发展，人们对面向6G的未来通信场景提出了更高要求。作为地面通信网络的补充，卫星网络因其覆盖范围广、吞吐量大、部署灵活等特点受到人们的广泛关注。利用卫星网络保障用户设备在偏远山区、荒漠远洋等地的安全接入，为电力勘测、应急救援等领域提供了技术上的支撑，有利于促进天地一体化信息网络的高度融合与深度互联。低轨卫星网络具有覆盖范围广、通信功耗小、机动性高等优势，能够作为地基网络的补充网络为复杂地形的用户提供网络服务。但LEO卫星网络具有节点暴露、信道开放、资源受限、网络拓扑结构高动态变化、用户设备海量等特点，导致LEO卫星网络中星地、星间链路使用开放信道通信，容易遭受欺骗、恶意拦截、信息窃取等攻击。因此如何增强用户设备与卫星之间认证的准确性，保障低轨卫星与用户设备之间的通信安全是目前亟待解决的问题。发明内容为解决以上现有技术存在的问题，本发明提出了一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，该方法包括：构建低轨卫星通信系统，该系统包括控制中心、用户设备、低轨卫星；用户设备和低轨卫星向控制中心发起认证注册请求；注册成功后的用户设备和低轨卫星进行通信；用户设备和低轨卫星向控制中心发起认证注册请求包括：S1：低轨卫星通信系统中的控制中心选择安全参数，根据安全参数生成系统参数；S2：用户设备和低轨卫星分别向控制中心发起注册请求；S3：控制中心根据注册请求分别生成低轨卫星的位置密钥和用户设备的位置密钥；并将位置密钥和注册响应分别返回给用户设备和递归卫星；S4：用户设备采用位置密钥对当前的位置信息进行加密，并将包含位置信息的接入认证请求发送给低轨卫星；S5：低轨卫星对用户设备发送请求进行验证，若验证成功，则对位置信息进行验证；若位置信息验证成功，则执行步骤S6，否则用户接入低轨卫星失败；S6：低轨卫星对用户设备的身份信息认证成功，并返回接入响应；S7：用户设备对低轨卫星发送的接入响应进行认证，若认证成功，则完成用户设备对低轨卫星的接入，否则接入失败。本发明的有益效果：本发明在系统初始化阶段由地面控制中心根据用户设备与低轨卫星网络的位置信息生成相应的位置密钥，在用户设备与低轨卫星进行接入认证请求的交互过程中，在预先设定的位置容忍精度下，根据用户设备与低轨卫星之间的位置信息来完成身份认证；本发明利用位置报告的独特性有效的增强了认证的准确性。附图说明图1为本发明的一种基于位置密钥的低轨卫星网络接入认证方法整体流程图；图2为本发明的一种基于位置密钥的低轨卫星网络接入认证方法的流程示意图；图3为本发明的用户设备与低轨卫星交互流程图。实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法，如图1所示，该方法包括系统初始化阶段、注册阶段与接入认证阶段三个阶段。系统初始化阶段包括：建立系统参数，所建立的系统参数主要包括：系统所需随机数，用户设备与低轨卫星的临时身份标识以及系统主密钥。注册阶段包括：用户设备与低轨卫星生成不同随机数并获取当前位置信息，将位置数据与随机参数嵌入到注册信息中，向地面控制中心发出注册请求；地面控制中心接收到注册请求后根据主密钥由密钥生成算法KDF为用户设备和低轨卫星生成位置密钥，将位置密钥嵌入到响应信息中向用户设备与低轨卫星发出注册响应。接入阶段包括：用户设备获取当前时间与新的位置数据，根据用户设备的真实身份计算加密密钥，由位置密钥计算消息认证码，由消息认证码计算认证向量。将认证向量和加密密钥与位置信息嵌入到接入认证请求信息中，向低轨卫星发出接入认证请求；低轨卫星在收到接入认证请求后首先检查用户设备所发送时间戳的有效性，若有效则计算其位置解密密钥，对所发送的认证向量解密获得位置信息，将解密后的位置信息与收到的位置信息进行对比，若在误差容忍精度内，则根据位置密钥计算消息认证码，比较计算出的消息认证码与收到的消息认证码是否相等，若相等，则低轨卫星判断用户设备合法并向用户设备发出认证响应，用户设备根据响应信息来判断低轨卫星是否为合法节点，若不是则拒接接入，若是则完成接入认证。一种基于位置密钥低轨卫星抗量子接入认证的卫星通信方法的具体实施方式，包括：构建低轨卫星通信系统，该系统包括控制中心、用户设备、低轨卫星；用户设备和低轨卫星向控制中心发起认证注册请求；注册成功后的用户设备和低轨卫星进行通信。如图2和图3所示，用户设备和低轨卫星向控制中心发起认证注册请求包括：S1：低轨卫星通信系统中的控制中心选择安全参数，根据安全参数生成系统参数；S2：用户设备和低轨卫星分别向控制中心发起注册请求；S3：控制中心根据注册请求分别生成低轨卫星的位置密钥和用户设备的位置密钥；并将位置密钥和注册响应分别返回给用户设备和递归卫星；S4：用户设备采用位置密钥对当前的位置信息进行加密，并将包含位置信息的接入认证请求发送给低轨卫星；S5：低轨卫星对用户设备发送请求进行验证，若验证成功，则对位置信息进行验证；若位置信息验证成功，则执行步骤S6，否则用户接入低轨卫星失败；S6：低轨卫星对用户设备的身份信息认证成功，并返回接入响应；S7：用户设备对低轨卫星发送的接入响应进行认证，若认证成功，则完成用户设备对低轨卫星的接入，否则接入失败。在本实施例中，低轨卫星通信系统中的控制中心选择安全参数，根据安全参数生成系统参数包括：地面控制中心进行系统初始化，选择一个质数q=poly,并为用户设备生成临时身份标识PIDu，生成系统密钥,选择防碰撞的哈希函数/＞，同时为低轨卫星生成临时身份标识PIDs；其中，q=poly表示选择一个多项式poly作为质数q的生成器，此多项式用于生成质数q，/＞表示系统密钥，s表示随机选取的系统主密钥，/＞表示生成元，/＞为防碰撞哈希函数，/＞表示有限域。用户设备和低轨卫星向控制中心注册包括：用户设备生成随机数Nu，用户设备位置信息Lu嵌入到注册请求中发送给地面控制中心进行注册，低轨卫星生成密钥所需的随机数Ns，低轨卫星位置信息Ls嵌入到注册请求中发送给地面控制中心进行注册。用户设备向低轨卫星发送接入认证请求的过程包括：用户设备获取当前时间和位置信息；根据用户设备的真实身份计算加密密钥；采用位置密钥LKu计算消息认证码MAC1；根据加密密钥和消息认证码计算认证向量Vu=PIDu||AES||MAC1||T1；将当前位置信息Lu'和认证向量Vu嵌入到接入认证信息中，并向卫星发送接入认证请求；其中/＞表示加密密钥，/＞表示密钥生成算法，/＞表示系统主密钥，表示用户身份，/＞表示用户注册时间戳，/＞为用户临时身份标识，/＞表示对称加密算法，/＞表示用户设备生成的随机数，/＞表示用户设备的位置信息。地面控制中心在接收到用户和卫星的注册请求后进行如下计算，根据主密钥Ppub，用户和卫星的身份PID由密钥生成算法KDF为用户设备分配认证所需的位置密钥，为卫星分配位置密钥/＞，地面控制中心，将位置密钥LK嵌入到注册响应发送给用户设备和卫星；其中/＞表示加密密钥，/＞表示密钥生成算法，/＞表示系统主密钥，/＞表示用户身份，/＞表示用户注册时间戳，/＞为用户临时身份标识，/＞表示对称加密算法，/＞表示用户设备生成的随机数，/＞表示用户设备位置信息。地面控制中心在接收到用户和卫星的注册请求后进行如下计算，根据主密钥Ppub，用户和卫星的身份PID由密钥生成算法KDF为用户设备分配认证所需的位置密钥，为卫星分配位置密钥/＞，地面控制中心,将位置密钥LK嵌入到注册响应发送给用户设备和卫星。在本实施例中，KDF采用PBKDF2加密，其具体步骤为：步骤1.获取参数，参数包括密码、盐值、迭代次数以及密钥长度。步骤2.将盐值和一个计数器连接起来，生成一个输入块。步骤3.对输入块进行HMAC计算。其中HMAC通过使用一个伪随机函数来计算密钥材料。步骤4.重复步骤3，迭代次数为i次，每次将上一次计算得到的结果作为下一次计算的输入块。步骤5.将每次计算得到的结果与初始密钥材料进行异或运算。步骤6.重复步骤3至步骤5，直到达到指定的密钥长度dkLen。步骤7.返回最终生成的密钥作为输出。卫星在接收到用户设备的接入认证请求后首先检查时间戳T1的有效性，若有效，则计算位置解密密钥，对于认证向量Vu中的进行解密，得到用户设备的位置信息Lu与随机数Nu，将计算出的用户位置信息Lu与收到的用户设备位置信息Lu'进行对比，看是否满足/＞，/＞为预先设定的位置容忍精度，若满足，则由位置密钥/＞计算消息认证码/＞，比较消息认证码MAC1'是否与收到的MAC1相等。若卫星比较消息认证码MAC1'与收到的MAC1相等，则判断用户为合法用户，首先卫星获取当前时间T2,根据自身身份标识IDs与主密钥Ppub生成加密密钥，根据对称加密算法AES计算/＞，得到认证向量/＞，将认证向量Vs与加密密钥SKs以及卫星当前的位置信息Ls'嵌入到接入认证响应信息发送给用户设备。在本实施例中，通过对称加密算法AES计算包括：字节替代、行位移、列混淆和轮密钥加密。解密算法每一步分别对应加密算法的逆操作，加解密中每轮的密钥分别由种子密钥经过密钥扩展算法得到。算法中若明文、密文和轮子密钥为16字节，则均以一个4*4的矩阵表示。在轮密钥加中：矩阵中的每一个字节都与该次轮密钥做XOR运算；每个子密钥由密钥生成方案产生。字节替代：通过非线性的替换函数，用查找表的方式把每个字节替换成对应的字节。行移位：将矩阵中的每个横列进行循环式移位。AES加密函数中首先进行密钥扩展，把128位长度的字符串读进一个4*4的整数数组中，该数组为状态矩阵。如pArray= S0,pArray= S1, pArray= S4。这个读取过程是通过 convertToIntArray函数来实现的。每轮操作的函数都对pArray进行修改，也就是对状态矩阵进行混淆。在执行完10轮加密后，会把pArray转换回字符串，再存入明文p的字符数组中。此转换过程由convertArrayToStr函数实现。在执行T函数时首先用单个numArray储存从32位的W中取得4个字节。若W为0x12ABCDEF,则numArray = 0x12,numArray=0xAB。函数splitIntToArray用于从32位整数中读取这四个字节。调用leftLoop4int函数把numArray数组中的4个元素循环左移1位。然后执行字节代换，通过getNumFromSBox函数获取S盒中相应的值来替换numArray中的值。接着通过mergeArrayToInt函数把字节代换后的numArray合并回32位的整数，在进行轮常量异或后返回。字节代换主要过程为把状态矩阵中的每个元素传进getNumFromSBox函数中，然后取得前面8位中的高4位作为行值，低4位作为列值，然后返回S，此处S为储存S盒的数组。行移位：把状态矩阵中第2，3，4行复制出来，然后对它们行进左移相应的位数，然后再复制到状态矩阵array中。列混合实现：把状态矩阵初始状态复制一份到tempArray中，然后把tempArray与colM矩阵相乘，colM为存放要乘的常数矩阵的数组。其中的GFMul函数定义了矩阵相乘时的乘法，加法则直接通过异或来实现。GFMul通过调用乘以各个数对应的函数来实现乘法。如S1*2通过调用GFMul2来实现。S1*3通过GFMul3来实现。用户设备在接收到认证响应消息后，首先检查时间戳T2的有效性，若有效，根据加密密钥解密/＞，对比位置信息/＞，/＞为预先设定的位置容忍精度；若满足，则用户根据位置密钥/＞计算消息认证码与/＞收到的MAC2'进行对比，若相等,则判断卫星为合法节点完成接入认证。以上所举实施例，对本发明的目的、技术方案和优点进行了进一步的详细说明，所应理解的是，以上所举实施例仅为本发明的优选实施方式而已，并不用以限制本发明，凡在本发明的精神和原则之内对本发明所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
