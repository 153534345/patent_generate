标题title
一种远距离双目三维变形测量系统的拍摄控制方法
摘要abst
本发明公开一种远距离双目三维变形测量系统的拍摄控制方法，先根据景深视差角计算确定并布局调整基线距离，保证在一定景深范围内的成像清晰；然后根据双目重叠视野范围与基线、方位角的关系，计算得到方位角范围，再通过不同方位角姿态下的相机标定计算得到对应的标定误差，控制精密转台转动至最小标定误差对应的方位；最后根据上述步骤确定的基线距离、方位角和相机标定参数等最佳拍摄参数，控制系统进行测量目标的实时拍摄分析三维变形。根据测量场景参数，先确定调整大范围基线距离，再通过标定误差评价控制调整方位角，保障了不同测量任务的三维变形测量精度。
权利要求书clms
1.一种远距离双目三维变形测量系统的拍摄控制方法，其特征在于，包括如下步骤：步骤一：根据预设的景深视差角，计算确定双测量站的基线距离b；步骤二：通过所述双测量站的远距离激光测距模块实时测量所述双测量站之间距离，调节所述双测量站之间距离为步骤一中计算确定的基线距离b；步骤三：根据远距离双目三维变形测量系统重叠视野范围w，计算确定相机的方位角α的范围；步骤四：控制所述双测量站的精密转台在所述方位角α的范围内转动，两相机同步采集视野范围内标定板图像并经相机标定计算得到所述方位角α姿态下对应的重投影误差集合和标定内外参数矩阵集合，并确定出可接受标定误差和可接受标定内外参数矩阵/＞；步骤五：控制所述双测量站的精密转台旋转至可接受标定误差对应的可接受方位角；步骤六：通过上述步骤一～步骤五确定所述双测量站最佳拍摄姿态并保存最佳拍摄参数：基线距离b、可接受方位角和可接受标定内外参数矩阵/＞，并以此最佳拍摄参数控制两相机同步拍摄实时分析测量目标的三维变形。2.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，所述步骤一中基线距离b和景深视差角之间的计算模型为：，式中：为拍摄距离范围最近景的会聚角，/＞为拍摄距离范围最远景的会聚角，h为拍摄工作距离，/＞为前景深，/＞为后景深；其中，，/＞，f为相机焦距，k为相机的镜头固有系数，相机的镜头选定后通过镜头的光圈值和弥散圆直径值相乘计算得到。3.根据权利要求2所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，所述景深视差角取值范围为65～75分，所述相机的镜头焦距/＞根据拍摄工作距离和拟测量范围选定：/＞，B为相机靶面尺寸，/＞为实际工程测量任务中拟测量范围。4.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，在所述步骤二中，按照计算确定的基线距离b初步布置所述双测量站后，先控制所述双测量站的精密转台旋转使得两相机严格对视，再通过所述双测量站中任一远距离测距模块实时获得双测量站之间的距离，并调节任一测量站或双测量站相近或相远移动，使远距离激光测距模块实时显示的距离值为计算基线距离b，至此固定所述双测量站的基线距离。5.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，在所述步骤三中，，令/＞得：，式中，θ为相机视场角，为实际工程测量任务中拟测量范围，g为放大倍数, h为拍摄工作距离。6.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，在所述步骤四中，控制双测量站的精密转台在所述方位角α范围内转动的方式为：先控制双测量站的精密转台旋转使得两相机严格对视，设定该严格对视状态下两精密转台方位角为零，再分别控制两精密转台左右旋转至。7.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，在所述步骤四中，标定误差计算包括：在所述步骤三中重叠视野范围w内均匀布置至少8个不同方位的标定板，当两相机等角度旋转至一个方位时，控制两相机同步采集共同视野范围内的标定板，获得左右标定板图像，对左右标定板图像通过特征提取、特征匹配及优化算法即可得到一个单点标定内外参数矩阵和单点重投影误差。8.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，在所述步骤五中，可接受标定误差包括：所述步骤四中计算的重投影误差集合内的最小标定误差，或者最先小于等于预设误差阈值/＞的标定误差，预设误差阈值/＞根据被测物变形测量允许精度等级误差值设定。9.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，所述步骤六的控制方式如下：控制两相机同步拍摄被测对象获得左右相机图像，通过特征提取获得左右图像像素坐标，读取可接受标定内外参数矩阵完成被测点像素坐标到空间三维坐标转换，实时计算被测点在不同时刻的空间三维坐标差值即可得到被测点的三维变形。10.根据权利要求1所述的远距离双目三维变形测量系统的拍摄控制方法，其特征在于，所述远距离双目三维变形测量系统包含两个测量站，即所述双测量站，每个测量站均包括摄像测量装置、远距离激光测距模块、精密转台、工业三脚架和控制单元，所述摄像测量装置与所述远距离激光测距模块的光轴平行固定于所述精密转台上方，所述摄像测量装置、所述远距离激光测距模块、所述精密转台均与所述控制单元相连。
说明书desc
技术领域本发明涉及到基于双目视觉的三维变形检测技术领域，具体涉及到一种远距离双目三维变形测量系统的拍摄控制方法。背景技术常见的双目视觉测量系统有两种结构类型：一是两相机通过连接杆保持一定间距的双目视觉系统，二是采用独立双测量站布局形式的双目视觉系统，第一种结构中两相机间距一般固定或在厘米级别范围内可调整，通常只适用于近距离拍摄测量，第二种结构中两相机间距及方位自由可调，可根据测量范围和拍摄距离进行调整布局，可适应不同测量需求任务，特别在远距离大视场工程测量领域具有明显优势。双目视觉测量精度与拍摄距离、相机焦距、基线距离、方位角及标定参数等拍摄条件有关，为了满足不同测量任务需求均具有较好的测量效果，因此需要对上述拍摄参数进行控制调整。目前现有拍摄调整控制方法主要针对于第一种结构且两相机光轴平行的双目视觉测量系统，基于预设的安全视差范围指标，依据视差、物距和基线距离关系z=fb/d，调节控制基线距离使其满足计算的基线距离范围。对于第二种远距离双目视觉测量系统，一般除了基线距离外还涉及方位角等参数的调整控制，且调整参数之间相互约束影响，实际测量任务中主要依赖于自身经验进行各拍摄参数的调整设置。对于远距离大视场工程测量，远距离双目三维变形测量系统采取双独立测量站会聚布局形式，其拍摄距离和双站基线距离可达数百米，很明显通过视差范围调节双站距离不太适用：一是该关系基于相机光轴平行布局推导，只与水平像素差有关；二是远距离双目基线距离大，因此调整范围也大。发明内容本发明的目的是针对现有技术存在的问题，提供一种远距离双目三维变形测量系统的拍摄控制方法。为实现上述目的，本发明采用的技术方案是：一种远距离双目三维变形测量系统的拍摄控制方法，包括如下步骤：步骤一：根据预设的景深视差角，计算确定双测量站的基线距离b；步骤二：通过所述双测量站的远距离激光测距模块实时测量所述双测量站之间距离，调节所述双测量站之间距离为步骤一中计算确定的基线距离b；步骤三：根据远距离双目三维变形测量系统重叠视野范围w，计算确定相机的方位角α的范围；步骤四：控制所述双测量站的精密转台在所述方位角α的范围内转动，两相机同步采集视野范围内标定板图像并经相机标定计算得到所述方位角α姿态下对应的重投影误差集合和标定内外参数矩阵集合，并确定出可接受标定误差和可接受标定内外参数矩阵/＞；步骤五：控制所述双测量站的精密转台旋转至可接受标定误差对应的可接受方位角/＞；步骤六：通过上述步骤一～步骤五确定所述双测量站最佳拍摄姿态并保存最佳拍摄参数：基线距离b、可接受方位角和可接受标定内外参数矩阵/＞，并以此最佳拍摄参数控制两相机同步拍摄实时分析测量目标的三维变形。本发明先根据景深视差角计算确定并布局调整基线距离，保证在一定景深范围内的成像清晰；然后根据双目重叠视野范围与基线、方位角的关系，计算得到方位角范围，再通过不同方位角姿态下的相机标定计算得到对应的标定误差，控制精密转台转动至最小标定误差对应的方位；最后根据上述步骤确定的基线距离、方位角和相机标定参数等最佳拍摄参数，控制系统进行测量目标的实时拍摄分析三维变形。通过标定误差评价、控制并调整方位角，保障了系统三维变形测量精度。本发明还综合考虑了影响双目视觉系统测量精度各拍摄参数及其相互约束关系，根据拍摄距离、最大测量范围等场景参数，提出先依据景深范围约束关系计算确定并调整基线距离，再根据视野范围与基线距离、方位角的约束关系，并引入标定误差评价，计算确定并控制方位角，这种先确定大范围基线距离再控制调整方位的拍摄控制程序简单且更容易实现。进一步的，所述步骤一中基线距离b和景深视差角之间的计算模型为：，式中：为拍摄距离范围最近景的会聚角，/＞为拍摄距离范围最远景的会聚角，h为拍摄工作距离，/＞为前景深，/＞为后景深；其中，，/＞，f为相机焦距，k为相机的镜头固有系数，相机的镜头选定后通过镜头的光圈值和弥散圆直径值相乘计算得到。进一步的，所述景深视差角取值范围为65～75分，所述相机的镜头焦距/＞根据拍摄工作距离和拟测量范围选定：/＞，B为相机靶面尺寸，/＞为实际工程测量任务中拟测量范围。进一步的，在所述步骤二中，按照计算确定的基线距离b初步布置所述双测量站后，先控制所述双测量站的精密转台旋转使得两相机严格对视，再通过所述双测量站中任一远距离测距模块实时获得双测量站之间的距离，并调节任一测量站或双测量站相近或相远移动，使远距离激光测距模块实时显示的距离值为计算基线距离b，至此固定所述双测量站的基线距离。进一步的，在所述步骤三中，，令/＞得：，式中，θ为相机视场角，为实际工程测量任务中拟测量范围，g为放大倍数。进一步的，在所述步骤四中，控制双测量站的精密转台在所述方位角α范围内转动的方式为：先控制双测量站的精密转台旋转使得两相机严格对视，设定该严格对视状态下两精密转台方位角为零，再分别控制两精密转台左右旋转至。进一步的，在所述步骤四中，标定误差计算包括：在所述步骤三中重叠视野范围w内均匀布置至少8个不同方位的标定板，当两相机等角度旋转至一个方位时，控制两相机同步采集共同视野范围内的标定板，获得左右标定板图像，对左右标定板图像通过特征提取、特征匹配及优化算法得到即可得到一个单点标定内外参数矩阵和单点重投影误差。进一步的，在所述步骤五中，可接受标定误差包括：所述步骤四中计算的重投影误差集合内的最小标定误差，或者最先小于等于预设误差阈值/＞的标定误差，预设误差阈值/＞根据被测物变形测量允许精度等级误差值设定。进一步的，所述步骤六的控制方式如下：调整好所述双测量站的最佳拍摄姿态并保存对应最佳拍摄参数：基线距离、可接受方位角角和可接受标定内外参数矩阵在该最佳拍摄姿态下进行被测对象的三维测量，控制两相机同步拍摄被测对象获得左右相机图像，通过特征提取获得左右图像像素坐标，读取可接受标定内外参数矩阵完成被测点像素坐标到空间三维坐标转换，实时计算被测点在不同时刻的空间三维坐标差值即可得到被测点的三维变形。进一步的，所述远距离双目三维变形测量系统包含两个测量站，即所述双测量站，每个测量站均包括摄像测量装置、远距离激光测距模块、精密转台、工业三脚架和控制单元，所述摄像测量装置与所述远距离激光测距模块的光轴平行固定于所述精密转台上方，所述摄像测量装置、所述远距离激光测距模块、所述精密转台均与所述控制单元相连。与现有技术相比，本发明的有益效果是：1、本拍摄控制方法先根据景深视差角计算确定并布局调整基线距离，保证在一定景深范围内的成像清晰；然后根据双目重叠视野范围与基线、方位角的关系，计算得到方位角范围，再通过不同方位角姿态下的相机标定计算得到对应的标定误差，控制精密转台转动至最小标定误差对应的方位；最后根据上述步骤确定的基线距离、方位角和相机标定参数等最佳拍摄参数，控制系统进行测量目标的实时拍摄分析三维变形；通过标定误差评价控制调整方位角，保障了不同测量任务的三维变形测量精度；2、本拍摄控制方法还综合考虑了影响双目视觉系统测量精度各拍摄参数及其相互约束关系，根据拍摄距离、最大测量范围等场景参数，提出先依据景深范围约束关系计算确定并调整基线距离，再根据视野范围与基线距离、方位角的约束关系，并引入标定误差评价，计算确定并控制方位角，这种先确定大范围基线距离再控制调整方位的拍摄控制程序简单且更容易实现，为数百米甚至上千米的远距离双目三维变形测量系统的拍摄控制提供指导依据。附图说明图1为本发明一种远距离双目三维变形测量系统的拍摄控制方法的流程示意图；图2为本发明远距离双目视觉模型的示意图，图中、/＞分别表示双测量站视觉原点；具体实施方式下面将结合本发明中的附图，对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动条件下所获得的所有其它实施例，都属于本发明保护的范围。结合图1和图2所示，一种远距离双目三维变形测量系统的拍摄控制方法，包括如下步骤：步骤一：根据预设的景深视差角，计算确定双测量站的基线距离b；，式中：为拍摄距离范围最近景的会聚角，/＞为拍摄距离范围最远景的会聚角，h为拍摄工作距离，/＞为前景深，/＞为后景深；其中，，/＞，f为相机焦距，k为相机的镜头固有系数，相机的镜头选定后通过镜头的光圈值和弥散圆直径值相乘计算得到。所述景深视差角,取值范围为65～75分,优选的为70分，所述相机的镜头焦距/＞根据拍摄工作距离和拟测量范围选定：/＞，B为相机靶面尺寸，/＞为实际工程测量任务中拟测量范围。步骤二：通过所述双测量站的远距离激光测距模块实时测量所述双测量站之间距离，调节所述双测量站之间距离为步骤一中计算确定的基线距离b；本实施例优选的，按照计算确定的基线距离b初步布置所述双测量站后，先控制所述双测量站的精密转台旋转使得两相机严格对视，再通过所述双测量站中任一远距离测距模块实时获得双测量站之间的距离，并调节任一测量站或双测量站相近或相远移动，使远距离激光测距模块实时显示的距离值为计算基线距离b，至此固定所述双测量站的基线距离。步骤三：根据远距离双目三维变形测量系统重叠视野范围w，计算确定相机的方位角α的范围；如图2所示，所述重叠视野范围即为该系统可视范围：，令/＞得：，式中，θ为相机视场角，为实际工程测量任务中拟测量范围，g为放大倍数。为了保证系统可视范围足够涵盖拟测量最大范围，另外也要考虑目标图像在整个图像中画幅占比尽可能大，可用户设定g取值范围，代入计算得到相应方位角范围/＞。步骤四：控制所述双测量站的精密转台在所述方位角α的范围内转动，两相机同步采集视野范围内标定板图像并经相机标定计算得到所述方位角α姿态下对应的重投影误差集合和标定内外参数矩阵集合，从重投影误差集合和标定内外参数矩阵集合中确定出可接受标定误差和可接受标定内外参数矩阵/＞；步骤五：控制所述双测量站的精密转台旋转至可接受标定误差对应的可接受方位角/＞；具体的，在所述步骤三中所述重叠视野范围w内均匀布置至少8个不同方位的标定板，控制所述双测量站的精密转台在上述方位角范围内转动，控制两相机同步采集视野范围内标定板图像并经相机标定计算得到上述方位角姿态下对应的标定误差，再控制精密转台转动至可接受标定误差对应的方位角，本实施例中提供两种方位角确定控制模式：其一：先控制双测量站的精密转台旋转使得两相机严格对视，设定该对视状态下两精密转台方位角为零；然后控制两精密转台从方位依次转动至/＞方位，一共转动n个方位，例如，可等角度间隔转动，则/＞，，当两相机每旋转至某一个方位时，控制两相机同步采集共同视野范围内的标定板，获得左右标定板图像，对左右标定板图像通过特征提取、特征匹配及优化算法得到一个单点标定内外参数矩阵/＞和单点重投影误差/＞，在/＞范围，则可得到n个标定内外参数矩阵/＞和n个重投影误差/＞，通过最小函数得到重投影误差数组中最小的标定误差，所述最小的标定误差即为可接受标定误差/＞，进而可以得到其对应的可接受标定内外参数矩阵/＞和可接受方位角/＞，并控制精密转台旋转至该方位角，即可接受方位角/＞。该种方式通过控制精密转台旋转至方位角范围内的每个角度，找到整个范围内最小的标定误差，将所述最小的标定误差确定为接受标定误差/＞，从而确定其对应的可接受标定内外参数矩阵/＞和可接受方位角/＞。其二，先控制双测量站的精密转台旋转使得两相机严格对视，设定该对视状态下两精密转台方位角为零；然后控制两精密转台从方位开始隔一定角度间隔依次旋转，例如，可设定为等角度间隔转动，则方位/＞，当两相机每旋转至一个方位角如/＞，控制两相机同步采集共同视野范围内的标定板，获得左右标定板图像，对左右标定板图像通过特征提取、特征匹配及优化算法得到单点标定内外参数矩阵/＞和单点重投影误差/＞，若/＞小于等于预设误差阈值/＞,则确定此时方位角为最佳方位，控制精密转台锁定该最佳方位角，该最佳方位角确定为可接受方位角/＞。第二种方式不用在整个方位角范围内转动，只需找到小于或等于预设误差阈值/＞的重投影误差/＞即可确定此时方位为最佳方位。预设误差阈值/＞根据被测物变形测量允许精度等级误差值设定。步骤六：通过上述步骤一～步骤五确定所述双测量站最佳拍摄姿态并保存最佳拍摄参数：基线距离b、可接受方位角和可接受标定内外参数矩阵/＞，并以此拍摄参数控制两相机同步拍摄实时分析测量目标的三维变形。其控制方式如下：在该最佳拍摄姿态下进行被测对象的三维测量，控制两相机同步拍摄被测对象获得左右相机图像，通过特征提取获得左右图像像素坐标，读取可接受标定内外参数矩阵完成被测点像素坐标到空间三维坐标转换，实时计算被测点在不同时刻的空间三维坐标差值即可得到被测点的三维变形。本发明的拍摄控制方法通过上述步骤的实施，既能够保证不同测量任务的三维变形测量精度，也能够简化和优化双测量站的参数调整过程，这种先确定大范围基线距离再控制调整方位的拍摄控制程序简单且更容易实现，还能够为数百米甚至上千米的远距离双目三维变形测量系统的拍摄控制提供指导依据。本实施例中所述远距离双目三维变形测量系统包含两个测量站，即所述双测量站，每个测量站均包括摄像测量装置、远距离激光测距模块、精密转台、工业三脚架和控制单元，所述摄像测量装置包含有相机和角度传感器，所述摄像测量装置与所述远距离激光测距模块的光轴平行固定于所述精密转台上方，所述摄像测量装置、所述远距离激光测距模块、所述精密转台均与所述控制单元相连。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。
