标题title
一种基于攻击者视角的外部攻击面管理方法及系统
摘要abst
本发明公开了一种基于攻击者视角的外部攻击面管理方法及系统，涉及网络安全技术领域，方法包括：收集预设区域内的IP地址和全量域名数据，进行资产全端口扫描，对资产进行指纹识别得到指纹信息；以漏洞数据库对指纹信息进行碰撞对比，分析疑似漏洞，通过POC验证，得到网络空间漏洞；利用预设风险检查规则库进行风险检查，得到资产风险；构建映射的网络空间与社会空间和地理空间，形成网络空间地图；利用可视化工具，绘制并展示网络空间漏洞和资产风险。通过本发明的技术方案，解决了传统漏洞扫描工具对区域进行大面积漏扫的难题，提升了针对区域攻击面管理的效率，降低了潜在攻击的风险，以提供全面的网络安全评估和管理解决方案。
权利要求书clms
1.一种基于攻击者视角的外部攻击面管理方法，其特征在于，包括：收集预设区域内的IP地址和全量域名数据，并对所述IP地址和所述域名数据进行全端口扫描；将扫描识别到的资产汇总得到所述预设区域的资产数据集，对所述资产数据集中的资产进行指纹识别，得到所述资产的指纹信息；在预设的漏洞数据库中对所述资产的指纹信息进行碰撞对比，分析每个资产中的疑似漏洞；利用漏洞扫描引擎对所述疑似漏洞进行POC验证，得到所述预设区域内资产中的网络空间漏洞；利用预设风险检查规则库中的规则比对方法对所述资产进行风险检查，得到所述预设区域的资产风险；以网络空间地理学为基础，构建网络空间与社会空间和地理空间的映射关系，形成所述预设区域的网络空间地图；利用可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的网络空间漏洞和资产风险。2.根据权利要求1所述的基于攻击者视角的外部攻击面管理方法，其特征在于，还包括：在预设的威胁情报库中对所述预设区域的IP地址和域名数据进行查询，判断所述IP地址或所述域名数据是否为威胁情报；利用所述可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的威胁情报。3.根据权利要求1或2所述的基于攻击者视角的外部攻击面管理方法，其特征在于，还包括：根据风险检查结果，并基于CVSS通用弱点评价体系，利用风险评估模型综合不同评估维度对所述资产进行风险评分；其中，所述风险评估模型所基于的评估维度包括扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险和问卷风险；其中，在所述CVSS通用弱点评价体系下，针对所述资产中不同评估维度是否存在漏洞以及漏洞的风险等级，在0-10的量度之间确定所述资产在对应评估维度的CVSS评分。4.根据权利要求3所述的基于攻击者视角的外部攻击面管理方法，其特征在于，还包括：针对所述预设区域内资产的风险，依据预定义的风险优先级标准的评价指标，对不同风险的评价指标分别赋予对应的权重；基于各评价指标的量化得分和权重，计算对应风险的优先级评分；根据所有风险的优先级评分，确定每种风险的优先级；按照优先级的排序，对所述预设区域内资产的风险进行分级处理。5.根据权利要求4所述的基于攻击者视角的外部攻击面管理方法，其特征在于，进行全端口扫描的端口扫描技术包括TCP连接扫描、SYN扫描、NULL扫描、FIN扫描、XMAS扫描、UDP扫描、IDLE扫描和SCTP扫描；进行指纹识别的指纹识别方式包括比对特定文件的MD5、检测正常页面或错误网页中包含的关键字、请求头信息的关键字匹配和部分URL中包含的关键字；进行碰撞对比的分析工具为spark分布式计算引擎。6.根据权利要求3所述的基于攻击者视角的外部攻击面管理方法，其特征在于，所述预设风险检查规则库中的风险检查项包括但不限于SSL不可用、不支持HTTPS重定向、SSL将在20天内到期、弱SSL算法、支持不安全的SSL/TLS版本、已吊销的证书正在使用中、HTTP不重定向到HTTPS、未强制执行HTTP严格传输安全、HSTS标头不包含includeSubDomains、在HSTS预加载列表中找不到域、未使用安全cookie、标头暴露使用ASP.NET、标头暴露特定ASP.NET版本、未使用HttpOnlycookie、已启用WordPress XML-RPC API、WordPress版本曝光、WordPress用户列表暴露、域名即将到期、域名已过期、未启用域注册商转移保护、未启用域注册商删除保护、域标记为非活动、域名注册局DNS保留、域名注册商DNS保留、注册局阻止域名续订、疑似恶意软件提供商、SPF语法错误、标头暴露X-Powered-By、标头暴露Server信息、主机名与SSL证书不匹配、未启用DNSSEC以及未找到DMARC策略。7.一种基于攻击者视角的外部攻击面管理系统，其特征在于，应用如权利要求1至6中任一项所述的基于攻击者视角的外部攻击面管理方法，包括：资产扫描模块，用于收集预设区域内的IP地址和全量域名数据，并对所述IP地址和所述域名数据进行全端口扫描；指纹识别模块，用于将扫描识别到的资产汇总得到所述预设区域的资产数据集，对所述资产数据集中的资产进行指纹识别，得到所述资产的指纹信息；疑似分析模块，用于在预设的漏洞数据库中对所述资产的指纹信息进行碰撞对比，分析每个资产中的疑似漏洞；漏洞验证模块，用于利用漏洞扫描引擎对所述疑似漏洞进行POC验证，得到所述预设区域内资产中的网络空间漏洞；风险检查模块，用于利用预设风险检查规则库中的规则比对方法对所述资产进行风险检查，得到所述预设区域的资产风险；地图构建模块，用于以网络空间地理学为基础，构建网络空间与社会空间和地理空间的映射关系，形成所述预设区域的网络空间地图；风险可视模块，用于利用可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的网络空间漏洞和资产风险。8.根据权利要求7所述的基于攻击者视角的外部攻击面管理系统，其特征在于，还包括威胁查询模块，用于在预设的威胁情报库中对所述预设区域的IP地址和域名数据进行查询，判断所述IP地址或所述域名数据是否为威胁情报；所述风险可视模块还用于利用所述可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的威胁情报。9.根据权利要求7或8所述的基于攻击者视角的外部攻击面管理系统，其特征在于，还包括风险评分模块，具体用于：根据风险检查结果，并基于CVSS通用弱点评价体系，利用风险评估模型综合不同评估维度对所述资产进行风险评分；其中，所述风险评估模型所基于的评估维度包括扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险和问卷风险；其中，在所述CVSS通用弱点评价体系下，针对所述资产中不同评估维度是否存在漏洞以及漏洞的风险等级，在0-10的量度之间确定所述资产在对应评估维度的CVSS评分。10.根据权利要求9所述的基于攻击者视角的外部攻击面管理系统，其特征在于，还包括风险分级模块，具体用于：针对所述预设区域内资产的风险，依据预定义的风险优先级标准的评价指标，对不同风险的评价指标分别赋予对应的权重；基于各评价指标的量化得分和权重，计算对应风险的优先级评分；根据所有风险的优先级评分，确定每种风险的优先级；按照优先级的排序，对所述预设区域内资产的风险进行分级处理。
说明书desc
技术领域本发明涉及网络安全技术领域，尤其涉及一种基于攻击者视角的外部攻击面管理方法以及一种基于攻击者视角的外部攻击面管理系统。背景技术随着计算机网络的快速发展和普及，网络安全威胁也日益严重。黑客、病毒、僵尸网络等恶意攻击手段层出不穷，给企业和个人的信息安全带来了严重的挑战。传统的网络安全防御方法主要侧重于固定规则和模式的防护，往往只能应对已知的攻击手段，对于新型的、未知的攻击方式容易无法检测和防范，这导致了网络安全防御的盲区和薄弱环节的存在。对于大型网络环境中存在的漏洞进行全面扫描和管理是一项复杂且耗时的任务。为了更好地了解网络的攻击面和潜在的风险，从攻击者的角度来评估和管理网络风险显得尤为重要。攻击者具备各种攻击手段和策略，其行为模式和攻击路径可以为网络管理员提供重要的参考和思路。传统的网络安全防御方法主要基于固定的规则和模式，往往只能识别和阻止已知的攻击手段。这导致对于新型、未知的攻击方式无法进行及时的检测和防范，使网络容易受到新型攻击的威胁。传统的漏洞扫描工具虽然能够检测到网络中存在的一些已知漏洞，但缺乏全面的安全评估和漏洞修复的指导。这导致网络管理员在修复漏洞时缺乏指导和优先级的判断，无法高效地进行漏洞管理。传统方法在评估网络安全时常常局限于特定的漏洞或攻击点，无法提供全面的攻击面评估。这导致网络管理员难以了解网络中的整体安全状况，无法准确识别潜在的攻击路径和风险。在网络安全领域，对攻击者的行为和策略缺乏全面的了解和参考，这使得网络管理员在制定安全策略和防御措施时缺乏相关的指导，缺乏对攻击者行为模型的考虑，容易导致防御策略的不完善和漏洞的遗漏。发明内容针对上述问题，本发明提供了一种基于攻击者视角的外部攻击面管理方法及系统，通过综合考虑攻击者的行为模式和攻击路径，模拟攻击者的行为和策略，通过疑似漏洞分析结合漏洞扫描的策略，解决了传统漏洞扫描工具对区域进行大面积漏扫的难题，通过基于风险检查规则库进行的风险检查，能够识别潜在的攻击路径、漏洞和风险，从而了解网络的整体安全状况和风险，提升了针对区域攻击面管理的效率，以降低潜在攻击的风险，保护重要信息和资产，并通过可视化工具展示一定区域内的网络空间漏洞和资产风险，从攻击者的角度来评估和管理网络的外部攻击面，以提供全面的网络安全评估和管理解决方案。为实现上述目的，本发明提供了一种基于攻击者视角的外部攻击面管理方法，包括：收集预设区域内的IP地址和全量域名数据，并对所述IP地址和所述域名数据进行全端口扫描；将扫描识别到的资产汇总得到所述预设区域的资产数据集，对所述资产数据集中的资产进行指纹识别，得到所述资产的指纹信息；在预设的漏洞数据库中对所述资产的指纹信息进行碰撞对比，分析每个资产中的疑似漏洞；利用漏洞扫描引擎对所述疑似漏洞进行POC验证，得到所述预设区域内资产中的网络空间漏洞；利用预设风险检查规则库中的规则比对方法对所述资产进行风险检查，得到所述预设区域的资产风险；以网络空间地理学为基础，构建网络空间与社会空间和地理空间的映射关系，形成所述预设区域的网络空间地图；利用可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的网络空间漏洞和资产风险。在上述技术方案中，优选地，基于攻击者视角的外部攻击面管理方法还包括：在预设的威胁情报库中对所述预设区域的IP地址和域名数据进行查询，判断所述IP地址或所述域名数据是否为威胁情报；利用所述可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的威胁情报。在上述技术方案中，优选地，基于攻击者视角的外部攻击面管理方法还包括：根据风险检查结果，并基于CVSS通用弱点评价体系，利用风险评估模型综合不同评估维度对所述资产进行风险评分；其中，所述风险评估模型所基于的评估维度包括扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险和问卷风险；其中，在所述CVSS通用弱点评价体系下，针对所述资产中不同评估维度是否存在漏洞以及漏洞的风险等级，在0-10的量度之间确定所述资产在对应评估维度的CVSS评分。在上述技术方案中，优选地，基于攻击者视角的外部攻击面管理方法还包括：针对所述预设区域内资产的风险，依据预定义的风险优先级标准的评价指标，对不同风险的评价指标分别赋予对应的权重；基于各评价指标的量化得分和权重，计算对应风险的优先级评分；根据所有风险的优先级评分，确定每种风险的优先级；按照优先级的排序，对所述预设区域内资产的风险进行分级处理。在上述技术方案中，优选地，进行全端口扫描的端口扫描技术包括TCP连接扫描、SYN扫描、NULL扫描、FIN扫描、XMAS扫描、UDP扫描、IDLE扫描和SCTP扫描；进行指纹识别的指纹识别方式包括比对特定文件的MD5、检测正常页面或错误网页中包含的关键字、请求头信息的关键字匹配和部分URL中包含的关键字；进行碰撞对比的分析工具为spark分布式计算引擎。在上述技术方案中，优选地，所述预设风险检查规则库中的风险检查项包括但不限于SSL不可用、不支持HTTPS重定向、SSL将在20天内到期、弱SSL算法、支持不安全的SSL/TLS版本、已吊销的证书正在使用中、HTTP不重定向到HTTPS、未强制执行HTTP严格传输安全、HSTS标头不包含includeSubDomains、在HSTS预加载列表中找不到域、未使用安全cookie、标头暴露使用ASP.NET、标头暴露特定ASP.NET版本、未使用HttpOnlycookie、已启用WordPress XML-RPC API、WordPress版本曝光、WordPress用户列表暴露、域名即将到期、域名已过期、未启用域注册商转移保护、未启用域注册商删除保护、域标记为非活动、域名注册局DNS保留、域名注册商DNS保留、注册局阻止域名续订、疑似恶意软件提供商、SPF语法错误、标头暴露X-Powered-By、标头暴露Server信息、主机名与SSL证书不匹配、未启用DNSSEC以及未找到DMARC策略。本发明还提出一种基于攻击者视角的外部攻击面管理系统，应用如上述技术方案中任一项公开的基于攻击者视角的外部攻击面管理方法，包括：资产扫描模块，用于收集预设区域内的IP地址和全量域名数据，并对所述IP地址和所述域名数据进行全端口扫描；指纹识别模块，用于将扫描识别到的资产汇总得到所述预设区域的资产数据集，对所述资产数据集中的资产进行指纹识别，得到所述资产的指纹信息；疑似分析模块，用于在预设的漏洞数据库中对所述资产的指纹信息进行碰撞对比，分析每个资产中的疑似漏洞；漏洞验证模块，用于利用漏洞扫描引擎对所述疑似漏洞进行POC验证，得到所述预设区域内资产中的网络空间漏洞；风险检查模块，用于利用预设风险检查规则库中的规则比对方法对所述资产进行风险检查，得到所述预设区域的资产风险；地图构建模块，用于以网络空间地理学为基础，构建网络空间与社会空间和地理空间的映射关系，形成所述预设区域的网络空间地图；风险可视模块，用于利用可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的网络空间漏洞和资产风险。在上述技术方案中，优选地，基于攻击者视角的外部攻击面管理系统还包括威胁查询模块，用于在预设的威胁情报库中对所述预设区域的IP地址和域名数据进行查询，判断所述IP地址或所述域名数据是否为威胁情报；所述风险可视模块还用于利用所述可视化工具，在所述网络空间地图中绘制并展示对应所述预设区域的威胁情报。在上述技术方案中，优选地，基于攻击者视角的外部攻击面管理系统还包括风险评分模块，具体用于：根据风险检查结果，并基于CVSS通用弱点评价体系，利用风险评估模型综合不同评估维度对所述资产进行风险评分；其中，所述风险评估模型所基于的评估维度包括扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险和问卷风险；其中，在所述CVSS通用弱点评价体系下，针对所述资产中不同评估维度是否存在漏洞以及漏洞的风险等级，在0-10的量度之间确定所述资产在对应评估维度的CVSS评分。在上述技术方案中，优选地，基于攻击者视角的外部攻击面管理系统还包括风险分级模块，具体用于：针对所述预设区域内资产的风险，依据预定义的风险优先级标准的评价指标，对不同风险的评价指标分别赋予对应的权重；基于各评价指标的量化得分和权重，计算对应风险的优先级评分；根据所有风险的优先级评分，确定每种风险的优先级；按照优先级的排序，对所述预设区域内资产的风险进行分级处理。与现有技术相比，本发明的有益效果为：通过综合考虑攻击者的行为模式和攻击路径，模拟攻击者的行为和策略，通过疑似漏洞分析结合漏洞扫描的策略，解决了传统漏洞扫描工具对区域进行大面积漏扫的难题，通过基于风险检查规则库进行的风险检查，能够识别潜在的攻击路径、漏洞和风险，从而了解网络的整体安全状况和风险，提升了针对区域攻击面管理的效率，以降低潜在攻击的风险，保护重要信息和资产，并通过可视化工具展示一定区域内的网络空间漏洞和资产风险，能够从攻击者的角度来评估和管理网络的外部攻击面，以提供全面的网络安全评估和管理解决方案。附图说明图1为本发明一种实施例公开的基于攻击者视角的外部攻击面管理方法的流程示意图；图2为本发明一种实施例公开的基于攻击者视角的外部攻击面管理方法的逻辑框架示意图；图3为本发明一种实施例公开的基于攻击者视角的外部攻击面管理系统的模块示意图。图中，各组件与附图标记之间的对应关系为：1.资产扫描模块，2.指纹识别模块，3.疑似分析模块，4.漏洞验证模块，5.风险检查模块，6.地图构建模块，7.风险可视模块，8.威胁查询模块，9.风险评分模块，10.风险分级模块。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。下面结合附图对本发明做进一步的详细描述：如图1和图2所示，根据本发明提供的一种基于攻击者视角的外部攻击面管理方法，包括：收集预设区域内的IP地址和全量域名数据，并对IP地址和域名数据进行全端口扫描；将扫描识别到的资产汇总得到预设区域的资产数据集，对资产数据集中的资产进行指纹识别，得到资产的指纹信息；在预设的漏洞数据库中对资产的指纹信息进行碰撞对比，分析每个资产中的疑似漏洞；利用漏洞扫描引擎对疑似漏洞进行POC验证，得到预设区域内资产中的网络空间漏洞；利用预设风险检查规则库中的规则比对方法对资产进行风险检查，得到预设区域的资产风险；以网络空间地理学为基础，构建网络空间与社会空间和地理空间的映射关系，形成预设区域的网络空间地图；利用可视化工具，在网络空间地图中绘制并展示对应预设区域的网络空间漏洞和资产风险。在该实施方式中，通过综合考虑攻击者的行为模式和攻击路径，模拟攻击者的行为和策略，通过疑似漏洞分析结合漏洞扫描的策略，解决了传统漏洞扫描工具对区域进行大面积漏扫的难题，通过基于风险检查规则库进行的风险检查，能够识别潜在的攻击路径、漏洞和风险，从而了解网络的整体安全状况和风险，提升了针对区域攻击面管理的效率，以降低潜在攻击的风险，保护重要信息和资产，并通过可视化工具展示一定区域内的网络空间漏洞和资产风险，能够从攻击者的角度来评估和管理网络的外部攻击面，以提供全面的网络安全评估和管理解决方案。具体地，要收集一个城市或者一个省的全部IP需要借助IP地理位置数据库，通过城市或者省份名称或者经纬度数据获取该地域的全量IP或者IP段。常见的IP地理位置数据库包括：GeoIP2：GeoIP2数据库是目前较为广泛使用的IP地理位置数据库之一。它提供了准确的IP定位数据，包括国家、省/州、城市、经纬度等信息，可作为API或本地数据库进行访问；IP2Location：IP2Location是另一个知名的IP地理位置数据库提供商。它提供了全球范围内的IP定位数据，包括国家、省/州、城市、邮政编码、经纬度、时区等信息，可以通过API或本地数据库进行查询；QQWry：QQWry是一种较早期使用的IP地理位置数据库。它提供了IP地址对应的国家、省/市、运营商等基本信息。该库在国内较为常用，但在国外的IP定位精度相对较低；IP2Location LITE：IP2Location LITE是免费的IP地理位置数据库，虽然精度不如付费版高，但仍然提供了一定程度的IP定位功能；纯真库：纯真库是中国互联网上最常用的IP地址定位工具之一，以IP地址为基准，提供了IP地址和地理位置的对应关系，可以通过查询IP地址来获得相应的地理位置信息，例如国家、省/市、运营商等。纯真库的数据基于大量的网络数据收集和整理，经过持续更新和维护，提供了较高的IP定位精度。在本发明的实施过程中，优选采用纯真库，通过城市或者省份名称获取该区域的IP段。域名数据的收集需要借助单位数据，首先从国家企业信用信息公示系统收集到该地域的全部企业信息，然后通过企业名称在ICP/IP地址/域名信息备案管理系统中获取到该企业所有的备案数据，从而得到该地区的网站域名，以此域名为基础进一步进行子域名挖掘，从而得到全量域名数据。外部攻击面是指政企IT基础设施中一切可被黑客攻击利用的元素以及元素的组合，这些元素包括了各类已知和未知的资产、漏洞、网络访问路径。网络空间资产扫描是外部攻击面管理的基础，在端口扫描过程中IP被封锁是时常遇见的问题。在实施过程中，优选地，本发明使用对预设区域内IP进行单个端口一个个扫描的方式，实现了对同一个目标IP的扫描间隔拉长到几十分钟，从而避免了在短时间内对同一IP发送大量扫描包，有效的规避了扫描IP被封锁。对上述步骤中收集的IP地址，使用主动扫描和识别技术发送探测包进行全端口扫描，探测IP上开放了哪些端口，以及每个端口上面运行什么协议。其中，优选地，进行全端口扫描的端口扫描技术包括TCP连接扫描、SYN扫描、NULL扫描、FIN扫描、XMAS扫描、UDP扫描、IDLE扫描和SCTP扫描等，用于识别目标主机上开放的服务和应用。具体地，TCP连接扫描是最常用的端口扫描技术之一。它通过发送TCP SYN或TCPConnect请求来建立与目标主机的TCP连接。如果目标主机响应了SYN/ACK数据包，表示该端口是开放的；如果目标主机响应了RST数据包，表示该端口是关闭的。SYN扫描是一种快速且隐蔽的扫描技术。它通过发送TCP SYN数据包，但在接收到目标主机的SYN/ACK响应之前发送RST数据包来终止连接。如果目标主机响应了SYN/ACK，表示该端口是开放的；如果目标主机响应了RST/ACK，表示该端口是关闭的；对域名数据扫描80和443端口，最终汇总形成资产数据集。常用的端口扫描工具有：masscan：masscan是一个高速的端口扫描工具，专注于快速扫描大规模网络。它使用异步发送和接收数据包的方式，可以在短时间内扫描大量的IP地址和端口；zmap：zmap是另一个高速的端口扫描工具，旨在快速地对整个IPv4地址空间进行端口扫描。它采用多线程和高效的数据包发送机制，可以快速扫描大范围的IP地址；xmap：xmap是一款快速网络扫描器，专为执行互联网范围的IPv6和IPv4网络研究扫描而设计；nmap：nmap是一款广泛使用的开源网络安全扫描工具。它旨在探测目标主机和网络上的开放端口、服务识别、操作系统检测以及漏洞发现。nmap提供了丰富的功能和灵活的扫描选项，使其成为渗透测试、漏洞评估和网络管理等领域的重要工具。在本发明的实施过程中，优选采用zmap进行资产扫描，zmap每次扫描一个端口，这样针对一个城市的所有IP两个端口扫描之间有时间差，对同一个IP目标来说间隔较长时间进行一次扫描，能有效防止被封锁。经过这一步将得到该区域的全量资产数据，包括ip、端口、协议、端口状态字段。指纹识别将为渗透测试人员提供大量有用的信息，指纹是组件上能标识对象类型的一段特征信息，用来在渗透测试信息收集环节中快速识别目标服务。指纹识别通常需要获取CMS信息、前端技术、Web服务器、应用服务器、开发语言、操作系统信息、CDN信息、WAF信息、IP及域名信息。在上述实施方式中，优选地，进行指纹识别的指纹识别方式包括比对特定文件的MD5、检测正常页面或错误网页中包含的关键字、请求头信息的关键字匹配和部分URL中包含的关键字等。根据上述步骤得到该区域的所有网络资产以及资产的指纹信息，指纹信息中包含了协议、服务和中间件以及对应的版本号，然后使用大数据分析技术跟漏洞数据库中的数据进行碰撞对比，经过版本比对分析出每个资产的疑似漏洞。其中，优选地，进行碰撞对比的分析工具采用spark分布式计算引擎，对每个资产上识别到的中间件和框架版本号跟漏洞数据库中的版本号进行比对，只要版本号在漏洞涉及的版本范围内，即可认为该资产存在疑似漏洞。针对上述对比分析出来的疑似漏洞，使用漏洞扫描引擎进行POC验证，从而得到每个资产的漏洞信息。这一步是比较关键的，因为传统的漏扫工具主要目标是针对单个目标进行体检式的漏洞扫描，针对一个目标遍历POC库中的所有POC，这种方式耗时较长，目标接收到的流量大，更容易被感知以及对目标造成影响。而本发明使用自研的并发扫描引擎，针对单个目标只验证已经发现的疑似漏洞，效率高且不易被封锁。经过POC验证，可以得到一个现实地理区域内的网络空间漏洞情况。在上述实施方式中，优选地，预设风险检查规则库中的风险检查项包括但不限于SSL不可用、不支持HTTPS重定向、SSL将在20天内到期、弱SSL算法、支持不安全的SSL/TLS版本、已吊销的证书正在使用中、HTTP不重定向到HTTPS、未强制执行HTTP严格传输安全、HSTS标头不包含includeSubDomains、在HSTS预加载列表中找不到域、未使用安全cookie、标头暴露使用ASP.NET、标头暴露特定ASP.NET版本、未使用HttpOnlycookie、已启用WordPressXML-RPC API、WordPress版本曝光、WordPress用户列表暴露、域名即将到期、域名已过期、未启用域注册商转移保护、未启用域注册商删除保护、域标记为非活动、域名注册局DNS保留、域名注册商DNS保留、注册局阻止域名续订、疑似恶意软件提供商、SPF语法错误、标头暴露X-Powered-By、标头暴露Server信息、主机名与SSL证书不匹配、未启用DNSSEC以及未找到DMARC策略。在传统的地理空间，地图作为描绘地理现象的重要载体，是指挥作战不可或缺的工具；如今在网络空间，也迫切需要能够全面展示网络空间信息的网络空间地图。在本发明中，以网络空间地理学为基础，通过网络空间要素的地理属性和社会属性，构建网络空间与社会空间以及地理空间的映射关系，将地理环境层/网络环境层/行为主体层/业务环境层进行技术融合，在地图上对网络空间资产进行打点，绘制实时、可靠、有效的网络空间外部攻击面风险。通过图表从扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险、问卷风险等维度进行图表可视化。在上述实施方式中，优选地，基于攻击者视角的外部攻击面管理方法还包括：在预设的威胁情报库中对预设区域的IP地址和域名数据进行查询，判断IP地址或域名数据是否为威胁情报；利用可视化工具，在网络空间地图中绘制并展示对应预设区域的威胁情报。具体地，对上述实施方式中获取的每个IP地址和域名数据，查询其whois信息，然后对IP地址和域名数据查询预设的威胁情报库，获取当前IP地址或者域名数据是不是恶意的。如果是恶意的，能够关联到哪些威胁情报报告、恶意文件、恶意URL、恶意组织、攻击事件等情报。具体地，对每个IP地址查询它的whois信息，包括：ip地址、扫描时间、网络地址段、网络名称、组织、地址描述、国家、管理员、技术员、拥有者、ip划分根源、联系人、联系人地址、电话、传真、联系邮箱、所属域名解析服务器、所属路由段、所属区域、插入时间、更新时间等字段。对域名数据也获取whois信息，得到注册商、创建时间、过期时间、域名服务器、域名状态、DNS解析服务器、注册邮箱、注册电话、最后更新时间等字段。其中，威胁情报库的构建是其中关键点，需要收集各大厂商发布的威胁情报的报告，从中解析出事件、文件MD5、文件大小、文件类型、C2服务器IP和域名、恶意URL等关键要素，从而构建威胁情报库。在上述实施方式中，优选地，基于攻击者视角的外部攻击面管理方法还包括：根据风险检查结果，并基于CVSS通用弱点评价体系，利用风险评估模型综合不同评估维度对资产进行风险评分；其中，风险评估模型所基于的评估维度包括扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险和问卷风险；其中，在CVSS通用弱点评价体系下，针对资产中不同评估维度是否存在漏洞以及漏洞的风险等级，在0-10的量度之间确定资产在对应评估维度的CVSS评分。具体地，在上述实施方式中利用风险检查规则库对资产进行风险检查的基础上，使用风险评估模型分析出每个资产的风险评分，每个漏洞的风险借鉴CVSS通用弱点评价体系。CVSS评分基于一系列维度上的测量结果，这些测量维度被称为量度，漏洞的最终的分最大为10，最小为0，得分7-10的漏洞通常被认为比较严重，得分再4-6.9之间的为中级漏洞，得分0-3.9的为低级漏洞，得分为0的说明没有漏洞。CVSS系统包括三种类型的分数：基本分数、暂时分和环境分。其中，风险评估模型为构建的回归模型，从扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险、问卷风险等评估维度计算该区域的资产风险评分。在上述实施方式中，优选地，基于攻击者视角的外部攻击面管理方法还包括：针对预设区域内资产的风险，依据预定义的风险优先级标准的评价指标，对不同风险的评价指标分别赋予对应的权重；基于各评价指标的量化得分和权重，计算对应风险的优先级评分；根据所有风险的优先级评分，确定每种风险的优先级；按照优先级的排序，对预设区域内资产的风险进行分级处理。具体地，经过上述步骤得到了该区域大量的资产和漏洞以及风险等数据，但是庞大的数据难以管理，因此需要进行风险优先级判定，优先处理优先级高的风险。风险优先级判定是在风险管理过程中对不同风险进行评估和排序的过程。首先，需要进行风险评估，以识别和量化潜在的风险。这包括确定风险的可能性和影响程度，通常使用定性和定量的方法来衡量风险的严重性。为了进行风险优先级判定，需要定义一组优先级标准或评估准则。这些准则可以包括风险的潜在影响范围、可能性、易受攻击程度、资产价值、法规合规要求等。根据组织的具体需求和上下文，可以为不同的标准赋予不同的权重。为了更客观地进行风险优先级判定，可以定义一组评估指标来衡量风险。这些指标可以基于定性或定量的数据，如历史事件数据、漏洞评分、威胁情报、安全性能指标等。通过综合考虑这些指标，可以得出一个更全面的风险优先级评估。基于风险评估和优先级标准，可以使用适当的算法或模型来计算风险的优先级。常见的方法包括加权得分法、故障模式和影响分析、风险矩阵等。这些方法将考虑各种风险因素，并为每个风险分配一个相对权重或得分，以确定其优先级。最后根据计算得到的优先级，可以对风险进行排序和分级。如图3所示，本发明还提出一种基于攻击者视角的外部攻击面管理系统，应用如上述实施方式中任一项公开的基于攻击者视角的外部攻击面管理方法，包括：资产扫描模块1，用于收集预设区域内的IP地址和全量域名数据，并对IP地址和域名数据进行全端口扫描；指纹识别模块2，用于将扫描识别到的资产汇总得到预设区域的资产数据集，对资产数据集中的资产进行指纹识别，得到资产的指纹信息；疑似分析模块3，用于在预设的漏洞数据库中对资产的指纹信息进行碰撞对比，分析每个资产中的疑似漏洞；漏洞验证模块4，用于利用漏洞扫描引擎对疑似漏洞进行POC验证，得到预设区域内资产中的网络空间漏洞；风险检查模块5，用于利用预设风险检查规则库中的规则比对方法对资产进行风险检查，得到预设区域的资产风险；地图构建模块6，用于以网络空间地理学为基础，构建网络空间与社会空间和地理空间的映射关系，形成预设区域的网络空间地图；风险可视模块7，用于利用可视化工具，在网络空间地图中绘制并展示对应预设区域的网络空间漏洞和资产风险。在该实施方式中，通过综合考虑攻击者的行为模式和攻击路径，模拟攻击者的行为和策略，通过疑似漏洞分析结合漏洞扫描的策略，解决了传统漏洞扫描工具对区域进行大面积漏扫的难题，通过基于风险检查规则库进行的风险检查，能够识别潜在的攻击路径、漏洞和风险，从而了解网络的整体安全状况和风险，提升了针对区域攻击面管理的效率，以降低潜在攻击的风险，保护重要信息和资产，并通过可视化工具展示一定区域内的网络空间漏洞和资产风险，从攻击者的角度来评估和管理网络的外部攻击面，以提供全面的网络安全评估和管理解决方案。在上述实施方式中，优选地，基于攻击者视角的外部攻击面管理系统还包括威胁查询模块8，用于在预设的威胁情报库中对预设区域的IP地址和域名数据进行查询，判断IP地址或域名数据是否为威胁情报；风险可视模块7还用于利用可视化工具，在网络空间地图中绘制并展示对应预设区域的威胁情报。在上述实施方式中，优选地，基于攻击者视角的外部攻击面管理系统还包括风险评分模块9，具体用于：根据风险检查结果，并基于CVSS通用弱点评价体系，利用风险评估模型综合不同评估维度对资产进行风险评分；其中，风险评估模型所基于的评估维度包括扫描风险、渗透风险、网站安全、网络安全、品牌和声誉风险、网络钓鱼和恶意软件风险、电子邮件安全、渗透风险和问卷风险；其中，在CVSS通用弱点评价体系下，针对资产中不同评估维度是否存在漏洞以及漏洞的风险等级，在0-10的量度之间确定资产在对应评估维度的CVSS评分。在上述实施方式中，优选地，基于攻击者视角的外部攻击面管理系统还包括风险分级模块10，具体用于：针对预设区域内资产的风险，依据预定义的风险优先级标准的评价指标，对不同风险的评价指标分别赋予对应的权重；基于各评价指标的量化得分和权重，计算对应风险的优先级评分；根据所有风险的优先级评分，确定每种风险的优先级；按照优先级的排序，对预设区域内资产的风险进行分级处理。根据上述实施方式公开的基于攻击者视角的外部攻击面管理系统，其各模块所要实现的功能，与上述实施方式中公开的基于攻击者视角的外部攻击面管理方法中的各步骤分别对应一致，实施过程中参照上述实施方式进行，在此不再赘述。以上仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
