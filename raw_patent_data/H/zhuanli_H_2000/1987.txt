标题title
基于变隶属度函数的水下无线传感器网络信任评估方法
摘要abst
基于变隶属度函数的水下无线传感器网络信任评估方法，涉及水下无线传感器网络信任管理技术领域，针对现有的信任模型在面对动态网络拓扑时难以针对特定攻击和场景给出差异化的信任评估策略，无法有效保护重要区域中节点的问题。本申请考虑攻击和环境特点，定义三类安全因子，设计出了一种变隶属度函数模糊系统完成综合信任值的计算，信任模型的隶属度函数可以受安全因子调控，针对特定攻击模式和环境场景自适应地改变，而不再是固定不变。模型考虑了节点间的不确定性，为不同节点提供差异化的信任评估，能够提高对来自重要区域攻击行为的敏感程度，缩短恶意攻击检测时间，减少攻击对网络造成的影响，可以获得较高的检测率和较低的误检率。
权利要求书clms
1.基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于包括以下步骤：步骤1：在滑动时间窗机制下，收集通信信任证据、数据信任证据和能量信任证据；步骤2：基于步骤1收集的通信信任证据、数据信任证据和能量信任证据，使用基于beta分布计算被评估节点的通信信任值、使用基于云模型计算被评估节点的数据信任值、使用基于高斯分布的算法计算被评估节点的能量信任值；步骤3：获取被评估节点的通信安全因子、数据安全因子和能量安全因子，并将被评估节点通信安全因子、数据安全因子和能量安全因子作为隶属度函数参数，构建模糊系统，之后将步骤2中得到的被评估节点的通信信任值、数据信任值和能量信任值作为输入量，通过模糊系统输出综合信任值；步骤4：获取被评估节点的历史信任值，根据被评估节点的历史信任值和步骤3得到的综合信任值得到最终信任值，将最终信任值中低于阈值的节点加入黑名单并广播通知全网。2.根据权利要求1所述的基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于所述步骤1的具体步骤为：首先建立滑动时间窗机制，其中，G表示信任模型运行期间总时间窗数，Δt表示时间窗口的长度，在每个时间窗口中，评估节点通过监听和包头信息交换的方式收集被评估节点的信任证据，所述信任证据包括通信信任证据、数据信任证据和能量信任证据。3.根据权利要求2所述的基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于所述收集被评估节点的信任证据的具体步骤为：收集通信信任证据：选取被评估节点在一个时间窗内转发数据包成功与失败的统计次数作为通信信任证据，记一个时间窗内监测到的被评估节点转发数据包成功次数为s，转发数据包失败次数记为f；收集数据信任证据：在一个时间窗内，评估节点通过监听的方式获取包括被评估节点在内的节点集中每一个节点的数据信任证据，记为{u1,u2,...,uN}，其中，N表示最近收集数据的个数，N为整数，u表示传感器收集的数据；收集能量信任证据：在一个时间窗内，评估节点通过监听的方式获取包括被评估节点在内的节点集中每一个节点在一段时间内的能耗作为对应节点的能量信任证据，记为e。4.根据权利要求3所述的基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于所述步骤2中使用基于beta分布计算被评估节点的通信信任值、使用基于云模型计算被评估节点的数据信任值、使用基于高斯分布的算法计算被评估节点的能量信任值；的具体步骤为：计算通信信任值：选择基于beta分布的方法计算通信信任值Fcom，表示为：其中，Beta表示Beta函数；计算数据信任值：评估节点将节点集中每一个节点的数据信任证据{u1,u2,...,uN}使用逆向云算法转换为云向量，云向量包括三个参数：期望ex、熵en和超熵he，并获取三个参数的估计值，三个参数的估计值表示为：其中，均值和方差S2表示为：其中，xq表示节点集中节点q的数据信任证据，q＝1,2,...,M-1；之后使用云相似度算法量化评估节点和节点集中任一节点的云向量之间的相似程度，使用2个云向量夹角余弦值表示云相似度，两个云向量的相似度为：其中，和/＞表示两个云向量Cj和Ck的数字特征组成的向量，j和k表示云向量Cj和Ck使用逆向云算法转换之前对应的节点，其中Cj＝，Ck＝,节点j与节点k该时段数据的相对信任RTjk表示为：对节点的j数据信任值Fdata是指评估节点将包括自己在内的除节点j外的所有节点集中节点，节点j的相对信任的平均值，即为数据信任值Fdata，表示为：其中，S为节点集中节点的数量，节点v是节点集中除节点j外的节点，v＝1,2,...S,v≠j；计算能量信任值：能量信任值Fenergy表示为：其中，z表示一个时间窗内的节点能耗值，d表示积分符号，σ表示正态分布的标准差，elocal表示一个时间窗内评估节点自身的能耗，eevaluated表示被评估节点一个时间窗内的能耗值。5.根据权利要求4所述的基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于所述步骤3中获取被评估节点通信安全因子、数据安全因子和能量安全因子的具体步骤为：获取被评估节点通信安全因子：设节点i的通信范围是以r为半径的球，对应的节点集表示为Ci＝{c1,c2,…,cM-1}，定义节点i节点集中的直接链路为一跳可达的节点间链路，定义间接链路为一跳不可达但经过节点i多跳可达的节点间链路，直接链路的集合表示为其中cm和cn分别表示邻居集中的两个节点，m＝1,2,...,M-1,n＝1,2,...,M-1,m≠n，lmn表示节点m与节点n间组成的链路，总链路数由计算得到，其中节点p为节点集中除节点i外的节点，p＝1，2，...，M-1,p≠i，通信安全因子表示为：其中，|L|表示集合L的基数，M表示节点i包括自己在内的节点集中节点的数量，M≥1；获取被评估节点数据安全因子：定义数据安全因子来量化节点发动数据篡改攻击时对网络的威胁水平，数据安全因子表示为：其中，dtotal表示部署范围中的深度最大值，d表示被评估节点当前所处深度且0≤d≤dtotal；获取被评估节点能量安全因子：定义能量安全因子来量化节点发动DOS攻击时对网络的威胁水平，能量安全因子表示为：其中，整数Nth1和Nth2是根据具体场景确定的阈值，满足0≤Nth1＜Nth2。6.根据权利要求5所述的基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于所述步骤3中将被评估节点通信安全因子、数据安全因子和能量安全因子作为隶属度函数参数，构建模糊系统，之后将步骤2中得到的被评估节点的通信信任值、数据信任值和能量信任值作为输入量，通过模糊系统输出综合信任值的具体步骤为：首先将通信信任值Fcom、数据信任值Fdata和能量信任值Fenergy作为输入变量，并将通信信任值Fcom、数据信任值Fdata和能量信任值Fenergy分别划分为3个模糊集{低，中，高}，将作为输出变量的综合信任值划分为6个模糊集{极低，低，较低，较高，高，极高}，隶属度函数选择三角隶属度函数，信任值论域Uf＝，Uf＝{uf}，uf表示Uf中的元素，定义模糊集中低为Al、中为Am、高为Ah，Int表示隶属度函数调整区间大小，0≤Int≤1，模糊集合的隶属度函数分别为μAl、μAm、μAh，定义如下：SF为通信信任值Fcom、数据信任值Fdata或能量信任值Fenergy；然后基于模糊集合的隶属度函数，并使用曼达尼模糊规则进行模糊推理，最后使用重心法解模糊得到综合信任值精确输出量Tsynthesized。7.根据权利要求6所述的基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于所述曼达尼模糊规则中，在逻辑运算中为AND算子填充min方法、为OR算子填充max方法，所有规则的权重均为1，使用min蕴含规则得到各个规则下的模糊集，使用max聚合规则将所有规则的输出模糊集组合为综合信任值模糊集。8.根据权利要求7所述的基于变隶属度函数的水下无线传感器网络信任评估方法，其特征在于所述步骤4的具体步骤为：获取历史信任值{Th1,Th2,Th3,Th4}，然后结合综合信任值Tsynthesized得到最终信任值Tfinal，最终信任值Tfinal表示为：Tfinal＝w0*Tsynthesized+w1*Th1+w2*Th2+w3*Th3+w4*Th4其中，w0、w1、w2、w3和w4为衰减因子权重，w0∈，w1∈，w2∈，w3∈，w4∈，w0+w1+w2+w3+w4＝1；更新历史信任值为{Tfinal,Th1,Th2}，作为历史信任值；设置信任值阈值Tth，0≤Tth≤1，当评估节点检测到Tfinal≤Tth时，将被评估节点地址加入自身黑名单并进行全网广播，随后采取措施将节点隔离出网络。
说明书desc
技术领域本发明涉及水下无线传感器网络信任管理技术领域，具体为基于变隶属度函数的水下无线传感器网络信任评估方法。背景技术近年来，水下无线传感器网络已经被应用于污染监控、油气勘测、导航控制、海啸预警及军事和安全等领域。传感器节点用完即弃、成本低廉的特点决定了大多数节点没有被实施防篡改技术，因此有被物理入侵并重新部署成为妥协节点并发动内部攻击的风险。内部攻击包括选择性转发攻击、数据篡改攻击、DOS攻击、虫洞攻击、女巫攻击等。其中发动选择性转发攻击的节点会选择性地丢弃数据包，发动数据篡改攻击的节点试图将篡改后的虚假传感器信息发送到目的节点，发动DOS攻击的节点试图通过高频率发包占用信道、消耗节点能量。攻击会降低网络数据包送达率，网络寿命，对网络性能造成消极影响。由于妥协节点已经拥有合法节点所必需的加密信息，传统的密码技术在网络中存在妥协节点的情况下无法阻止其发动内部攻击，因此需要有效的机制识别妥协节点，降低内部攻击对网络造成的影响。信任管理机制被认为是对传统密码机制的有效补充，其由一系列基于信任的安全技术构成，用于保护网络免遭妥协节点的攻击。自从Marsh将信任研究引入计算机领域以来，人们在分布式网络、普适计算、对等计算、自组织网络等方面提出了众多的信任模型，以提高系统的安全性、可靠性和公平性。基于模糊系统的信任模型使用模糊系统计算信任值，量化评估节点对被评估节点的信任水平。模糊系统中的模糊集合论具有适于描述和处理模糊概念和对象的特点，借助于隶属度和语言变量的概念可以提供一种对主观信任进行定量研究的有效方法。尽管模糊集理论能够建模单个用户对于语义概念理解的不确定性,即个体内不确定性，然而由于个体间的不确定性，不同用户对于同一个语义概念会有不同的理解。考虑到节点攻击对网络造成的影响程度与节点位置和拓扑有关，在现实场景下,不同节点发动攻击对网络影响程度不同，因此在模糊化过程中使用固定隶属度函数无法重点保护重要区域中的节点。发明内容本发明的目的是：针对现有的信任模型在面对动态网络拓扑时难以针对特定攻击和场景给出差异化的信任评估策略，无法有效保护重要区域中节点的问题，提出基于变隶属度函数的水下无线传感器网络信任评估方法。本发明为了解决上述技术问题采取的技术方案是：基于变隶属度函数的水下无线传感器网络信任评估方法，包括以下步骤：步骤1：在滑动时间窗机制下，收集通信信任证据、数据信任证据和能量信任证据；步骤2：基于步骤1收集的通信信任证据、数据信任证据和能量信任证据，使用基于beta分布计算被评估节点的通信信任值、使用基于云模型计算被评估节点的数据信任值、使用基于高斯分布的算法计算被评估节点的能量信任值；步骤3：获取被评估节点的通信安全因子、数据安全因子和能量安全因子，并将被评估节点通信安全因子、数据安全因子和能量安全因子作为隶属度函数参数，构建模糊系统，之后将步骤2中得到的被评估节点的通信信任值、数据信任值和能量信任值作为输入量，通过模糊系统输出综合信任值；步骤4：获取被评估节点的历史信任值，根据被评估节点的历史信任值和步骤3得到的综合信任值得到最终信任值，将最终信任值中低于阈值的节点加入黑名单并广播通知全网。进一步的，所述步骤1的具体步骤为：首先建立滑动时间窗机制，其中，G表示信任模型运行期间总时间窗数，Δt表示时间窗口的长度，在每个时间窗口中，评估节点通过监听和包头信息交换的方式收集被评估节点的信任证据，所述信任证据包括通信信任证据、数据信任证据和能量信任证据。进一步的，所述收集被评估节点的信任证据的具体步骤为：收集通信信任证据：选取被评估节点在一个时间窗内转发数据包成功与失败的统计次数作为通信信任证据，记一个时间窗内监测到的被评估节点转发数据包成功次数为s，转发数据包失败次数记为f；收集数据信任证据：在一个时间窗内，评估节点通过监听的方式获取包括被评估节点在内的节点集中每一个节点的数据信任证据，记为{u1,u2,...,uN}，其中，N表示最近收集数据的个数，N为整数，u表示传感器收集的数据；收集能量信任证据：在一个时间窗内，评估节点通过监听的方式获取包括被评估节点在内的节点集中每一个节点在一段时间内的能耗作为对应节点的能量信任证据，记为e。进一步的，所述步骤2中使用基于beta分布计算被评估节点的通信信任值、使用基于云模型计算被评估节点的数据信任值、使用基于高斯分布的算法计算被评估节点的能量信任值；的具体步骤为：计算通信信任值：选择基于beta分布的方法计算通信信任值Fcom，表示为：其中，Beta表示Beta函数；计算数据信任值：评估节点将节点集中每一个节点的数据信任证据{u1,u2,...,uN}使用逆向云算法转换为云向量，云向量包括三个参数：期望ex、熵en和超熵he，并获取三个参数的估计值，三个参数的估计值表示为：其中，均值和方差S2表示为：其中，xq表示节点集中节点q的数据信任证据，q＝1,2,...,M-1；之后使用云相似度算法量化评估节点和节点集中任一节点的云向量之间的相似程度，使用2个云向量夹角余弦值表示云相似度，两个云向量的相似度为：其中，和/＞表示两个云向量Cj和Ck的数字特征组成的向量，j和k表示云向量Cj和Ck使用逆向云算法转换之前对应的节点，其中Cj＝，Ck＝,节点j与节点k该时段数据的相对信任RTjk表示为：对节点的j数据信任值Fdata是指评估节点将包括自己在内的除节点j外的所有节点集中节点，节点j的相对信任的平均值，即为数据信任值Fdata，表示为：其中，S为节点集中节点的数量，节点v是节点集中除节点j外的节点，v＝1,2,...S,v≠j；计算能量信任值：能量信任值Fenergy表示为：其中，z表示一个时间窗内的节点能耗值，d表示积分符号，σ表示正态分布的标准差，elocal表示一个时间窗内评估节点自身的能耗，eevaluated表示被评估节点一个时间窗内的能耗值。进一步的，所述步骤3中获取被评估节点通信安全因子、数据安全因子和能量安全因子的具体步骤为：获取被评估节点通信安全因子：设节点i的通信范围是以r为半径的球，对应的节点集表示为Ci＝{c1,c2,…,cM-1}，定义节点i节点集中的直接链路为一跳可达的节点间链路，定义间接链路为一跳不可达但经过节点i多跳可达的节点间链路，直接链路的集合表示为其中cm和cn分别表示邻居集中的两个节点，m＝1,2,...,M-1,n＝1,2,...,M-1,m≠n，lmn表示节点m与节点n间组成的链路，总链路数由计算得到，其中节点p为节点集中除节点i外的节点，p＝1，2，...，M-1,p≠i，通信安全因子表示为：其中，|L|表示集合L的基数，M表示节点i包括自己在内的节点集中节点的数量，M≥1；获取被评估节点数据安全因子：定义数据安全因子来量化节点发动数据篡改攻击时对网络的威胁水平，数据安全因子表示为：其中，dtotal表示部署范围中的深度最大值，d表示被评估节点当前所处深度且0≤d≤dtotal；获取被评估节点能量安全因子：定义能量安全因子来量化节点发动DOS攻击时对网络的威胁水平，能量安全因子表示为：其中，整数Nth1和Nth2是根据具体场景确定的阈值，满足0≤Nth1＜Nth2。进一步的，所述步骤3中将被评估节点通信安全因子、数据安全因子和能量安全因子作为隶属度函数参数，构建模糊系统，之后将步骤2中得到的被评估节点的通信信任值、数据信任值和能量信任值作为输入量，通过模糊系统输出综合信任值的具体步骤为：首先将通信信任值Fcom、数据信任值Fdata和能量信任值Fenergy作为输入变量，并将通信信任值Fcom、数据信任值Fdata和能量信任值Fenergy分别划分为3个模糊集{低，中，高}，将作为输出变量的综合信任值划分为6个模糊集{极低，低，较低，较高，高，极高}，隶属度函数选择三角隶属度函数，信任值论域Uf＝，Uf＝{uf}，uf表示Uf中的元素，定义模糊集中低为Al、中为Am、高为Ah，Int表示隶属度函数调整区间大小，0≤Int≤1，模糊集合的隶属度函数分别为μAl、μAm、μAh，定义如下：SF为通信信任值Fcom、数据信任值Fdata或能量信任值Fenergy；然后基于模糊集合的隶属度函数，并使用曼达尼模糊规则进行模糊推理，最后使用重心法解模糊得到综合信任值精确输出量Tsynthesized。进一步的，所述曼达尼模糊规则中，在逻辑运算中为AND算子填充min方法、为OR算子填充max方法，所有规则的权重均为1，使用min蕴含规则得到各个规则下的模糊集，使用max聚合规则将所有规则的输出模糊集组合为综合信任值模糊集。进一步的，所述步骤4的具体步骤为：获取历史信任值{Th1,Th2,Th3,Th4}，然后结合综合信任值Tsynthesized得到最终信任值Tfinal，最终信任值Tfinal表示为：Tfinal＝w0*Tsynthesized+w1*Th1+w2*Th2+w3*Th3+w4*Th4其中，w0、w1、w2、w3和w4为衰减因子权重，w0∈，w1∈，w2∈，w3∈，w4∈，w0+w1+w2+w3+w4＝1；更新历史信任值为{Tfinal,Th1,Th2}，作为历史信任值；设置信任值阈值Tth，0≤Tth≤1，当评估节点检测到Tfinal≤Tth时，将被评估节点地址加入自身黑名单并进行全网广播，随后采取措施将节点隔离出网络。本发明的有益效果是：本申请考虑攻击和环境特点，定义三类安全因子，设计出了一种变隶属度函数模糊系统完成综合信任值的计算，信任模型的隶属度函数可以受安全因子调控，针对特定攻击模式和环境场景自适应地改变，而不再是固定不变。模型考虑了节点间的不确定性，为不同节点提供差异化的信任评估，能够提高对来自重要区域攻击行为的敏感程度，缩短恶意攻击检测时间，减少攻击对网络造成的影响，可以获得较高的检测率和较低的误检率。同时，信任模型对网络重要区域节点发动攻击的行为更加敏感，识别耗时更短，增强了对重要区域节点的防护力度。另外，本申请还解决了现有水下无线传感器网络信任模型参数固定不变，存在忽视节点间不确定性，导致模型环境适应性和准确性受限的问题。附图说明图1为本申请基于变隶属度函数模糊系统的信任模型过程示意图；图2为信任模型在一个时间窗内的工作过程示意图；图3为变隶属度函数模糊系统对综合信任值计算过程示意图。具体实施方式需要特别说明的是，在不冲突的情况下，本申请公开的各个实施方式之间可以相互组合。具体实施方式一：参照图1具体说明本实施方式，本实施方式所述的基于变隶属度函数的水下无线传感器网络信任评估方法，包括以下步骤：步骤1：在滑动时间窗机制下，收集通信信任证据、数据信任证据和能量信任证据；步骤2：基于步骤1收集的通信信任证据、数据信任证据和能量信任证据，使用基于beta分布计算被评估节点的通信信任值、使用基于云模型计算被评估节点的数据信任值、使用基于高斯分布的算法计算被评估节点的能量信任值；步骤3：获取被评估节点的通信安全因子、数据安全因子和能量安全因子，并将被评估节点通信安全因子、数据安全因子和能量安全因子作为隶属度函数参数，构建模糊系统，之后将步骤2中得到的被评估节点的通信信任值、数据信任值和能量信任值作为输入量，通过模糊系统输出综合信任值；步骤4：获取被评估节点的历史信任值，根据被评估节点的历史信任值和步骤3得到的综合信任值得到最终信任值，将最终信任值中低于阈值的节点加入黑名单并广播通知全网。本申请还包括这样一些结构特征：步骤3包括：定义通信安全因子SFcom量化节点发动选择性转发攻击时对网络的威胁水平。设节点i的通信范围是以r为半径的球，对应的邻居集合表示为Ci＝{c1,c2,…,cM-1}，定义节点i邻居节点集合中的直接链路为一跳可达的节点间链路，定义间接链路为一跳不可达但经过节点i多跳可达的节点间链路，直接链路的集合表示为总链路数可以由/＞计算得到，M为节点i包括自己在内的邻居节点数量M≥1。通信安全因子的计算公式如下：其中|L|表示集合L的基数。进一步地，计算数据安全因子。定义数据安全因子SFdata量化节点发动数据篡改攻击时对网络的威胁水平。数据安全因子的计算公式如下：其中dtotal为节点部署范围中的深度最大值，d为被评估节点当前所处深度且0≤d≤dtotal。进一步地，计算能量安全因子。定义能量安全因子SFenergy量化节点发动DOS攻击时对网络的威胁水平。能量安全因子的计算公式如下：其中整数Nth1和Nth2是根据具体场景确定的阈值，满足0≤Nth1＜Nth2。进一步地，采用模糊逻辑方法，使用变隶属度函数模糊系统计算综合信任值。首先将三个作为输入变量的通信信任值Fcom、数据信任值Fdata和能量信任值Fenergy都划分为3个模糊集{低，中，高}，将作为输出变量的综合信任值划分为6个模糊集{极低，低，较低，较高，高，极高}，隶属度函数选择三角隶属度函数。以通信信任值为例，通信信任值论域Ucf＝，ucf表示Ucf中的元素，记作Ucf＝{ucf}。定义模糊集合“低”为模糊集合“中”为/＞模糊集合“高”为/＞Intc为隶属度函数调整区间大小，0≤Intc≤1，由于受到通信安全因子的调控，这些模糊集合的隶属度函数分别为/＞定义如下：在数据信任值和能量信任值论域中模糊集合的隶属度函数公式与通信信任值论域中模糊集合的隶属度函数公式类似，区别在于通信安全因子SFcom分别由SFdata和SFenergy代替，隶属度函数调整区间Intc由Intd、Inte代替，0≤Intd≤1、0≤Inte≤1。进一步地，使用曼达尼模糊规则进行模糊推理。以IF CT is CT1 and DT is DT1and ET is ET1 THEN OT is ST1的形式表达总共27条模糊规则，其中CT1、DT1、ET1和ST1分别代表了在三个输入量CT、DT、ET和一个输出量ST上的模糊语言变量。在逻辑运算中为AND算子填充min方法、为OR算子填充max方法，所有规则的权重均为1，使用min蕴含规则得到各个规则下的模糊集，使用max聚合规则将所有规则的输出模糊集组合为综合信任值模糊集。最后使用重心法解模糊得到综合信任值精确输出量Tsynthesized。本申请目的是设计一种水下无线传感器网络信任模型，主要是为了解决现有的水下无线传感器网络信任模型参数固定不变，导致模型适应性和准确性受限的问题。本申请在时间窗机制下周期性地利用声通信开放性特点，收集信任证据，计算信任值，在此基础上考虑攻击和环境特点，定义三类安全因子，设计出一种变隶属度函数模糊系统完成综合信任值的计算，结合历史信任值和衰减因子，从而计算得到最终信任值。实施例一如附图1所示，是本申请基于变隶属度函数模糊系统的信任模型过程示意图。步骤1：在滑动时间窗机制下，节点分布式地收集通信、数据和能量信任证据。步骤1.1：建立滑动时间窗机制。如附图2所示，是本申请的信任模型在一个时间窗内的工作过程示意图。首先建立滑动时间窗机制，其中G为信任模型运行期间总时间窗数，在每个时间窗口中，节点利用声通信的开放性特点，通过监听和包头信息交换的方式，分布式地收集邻居节点的通信、数据和能量信任证据。信任证据在每个时间窗口中实时更新，在时间窗口结束时进行结算并计算节点信任值。信任值包括通信信任值Fcom、数据信任值Fdata和能量信任值Fenergy，由之间的值表示，更高的信任值意味着被评估节点在该观测角度具有更高的可信程度。经过模糊系统计算得到综合信任值后结合历史信任值计算得到最终信任值，最后清空信任证据，在下一个时间窗口中再次重复执行上述操作。步骤1.2：收集通信信任证据。针对选择性转发攻击节点选择性丢弃数据包的攻击方式，收集与数据包转发有关的通信信任证据计算通信信任值。选取节点在一段时间内转发数据包的成功与失败统计次数作为通信信任证据，记一个时间窗内监测到的被评估节点转发数据包成功次数为s，转发数据包失败次数记为f。步骤1.3：收集数据信任证据。针对数据篡改攻击节点篡改传感器数据的攻击方式，收集与传感器数据有关的数据信任证据计算数据信任值。选取传感器节点最新收集的数据作为节点自身的数据信任证据，记为{x1,x2,...,xN}，其中整数N表示最近收集数据的个数。步骤1.4：收集能量信任证据。针对DOS攻击节点高频率发送数据包的攻击方式，收集与能耗有关的能量信任证据计算能量信任值。选取传感器节点在一段时间内的能耗作为能量信任证据，记为e。步骤2：基于步骤1所收集的通信、数据和能量信任证据，分别使用基于beta分布，基于云模型和基于高斯分布的算法计算被评估节点的通信、数据和能量信任值。步骤2.1：计算通信信任值。选择基于beta分布的方法计算通信信任值Fcom。Beta＝/ΓΓ)εx-1y-1其中0＜ε＜1,s＞0,f＞0，且x代表诚实行为的次数，y代表恶意行为的次数，信任模型中将这两个变量记录为s和f。在该算法中s代表被评估节点成功转发数据包的次数，定义为在一个时间窗中，评估节点监听到被评估节点发送的ACK消息后一段时间内，监听到其转发数据包行为的次数。f代表被评估节点转发数据包失败的次数，定义为评估节点监听到被评估节点发送的ACK消息后一段时间内，没有监听到其转发数据包行为的次数。概率分布可以由以s和f为参数的beta分布表示，通信信任值Fcom则是概率密度函数的统计期望。步骤2.2：计算数据信任值。选择基于云模型的群体信任算法计算数据信任值Fdata。首先，使用逆向云算法实现从定量值到定性概念的转换。各个节点将本地存储的N个数据作为云滴{x1,x2,...,xN}，使用逆向云算法分布式地计算本地信任云向量，云向量包括三个参数：期望ex、熵en和超熵he。三参数的估计值计算：其中均值和方差S2计算如下其次，使用云相似度算法量化2个云之间的相似程度。使用2个云向量夹角余弦值表示云相似度：若两个云Cj和Ck的数字特征组成向量和/＞两个云的相似度为：然后，在云相似度的基础上使用相对信任描述两个节点同时段数据的相对可信程度。给定两个邻近节点j和k相同时段的云模型为Cj和Ck，其中Cj＝，Ck＝,节点j与节点k该时段数据的RTjk相对信任如式所示：最后计算数据信任值。对节点的j数据信任值Fdata是指评估节点将包括自己在内的除节点j外的所有邻居节点，对节点j的相对信任的平均值。步骤2.3：计算能量信任值。选择基于高斯分布的算法计算能量信任值Fenergy。使用正态分布概率密度函数计算能量信任值，能耗的概率密度函数可以通过下式计算：其中z是一个时间窗内的节点能耗值，σ是正态分布的标准差，其值可以根据具体场景具体设置，elocal是一个时间窗内评估节点自身的能耗，能量信任值定义为：其中eevaluated是被评估节点一个时间窗内的能耗值。步骤3：计算被评估节点通信、数据和能量安全因子作为隶属度函数参数，将步骤2所得到的信任值作为输入量，通过模糊系统输出综合信任值。如附图3所示，是本申请的变隶属度函数模糊系统对综合信任值计算过程示意图。步骤3.1：计算通信安全因子。定义通信安全因子来量化节点发动选择性转发攻击时对网络的威胁水平。设节点i的通信范围是以r为半径的球，对应的邻居集合表示为Ci＝{c1,c2,…,cM-1}，定义节点i邻居节点集合中的直接链路为一跳可达的节点间链路，定义间接链路为一跳不可达但经过节点i多跳可达的节点间链路，直接链路的集合表示为总链路数可以由/＞计算得到。通信安全因子的计算公式如下：其中|L|表示集合L的基数。步骤3.2：计算数据安全因子。定义数据安全因子来量化节点发动数据篡改攻击时对网络的威胁水平。数据安全因子的计算公式如下：其中dtotal为部署范围中的深度最大值，d为被评估节点当前所处深度且0≤d≤dtotal。步骤3.3：计算能量安全因子。定义能量安全因子来量化节点发动DOS攻击时对网络的威胁水平。能量安全因子的计算公式如下：其中整数Nth1和Nth2是根据具体场景确定的阈值，满足0≤Nth1＜Nth2。步骤3.4：采用模糊逻辑方法，使用变隶属度函数模糊系统计算综合信任值。首先将三个作为输入变量的通信信任值Fcom、数据信任值Fdata和能量信任值Fenergy都划分为3个模糊集{低，中，高}，将作为输出变量的综合信任值划分为6个模糊集{极低，低，较低，较高，高，极高}，隶属度函数选择三角隶属度函数。以通信信任值为例，通信信任值论域Ucf＝，ucf表示Ucf中的元素，记作Ucf＝{ucf}。定义模糊集合“低”为模糊集合“中”为/＞模糊集合“高”为/＞Intc为隶属度函数调整区间大小，0≤Intc≤1，由于受到通信安全因子的调控，这些模糊集合的隶属度函数分别为/＞定义如下：/＞在数据信任值和能量信任值论域中模糊集合的隶属度函数公式与通信信任值论域中模糊集合的隶属度函数公式类似，区别在于通信安全因子SFcom分别由SFdata和SFenergy代替，隶属度函数调整区间Intc由Intd、Inte代替，0≤Intd≤1、0≤Inte≤1。然后使用曼达尼模糊规则进行模糊推理。以IF CTisCT1 andDTisDT1andETisET1THENOTis ST1的形式表达总共27条模糊规则，其中CT1、DT1、ET1和ST1分别代表了在三个输入量CT、DT、ET和一个输出量ST上的模糊语言变量。在逻辑运算中为AND算子填充min方法、为OR算子填充max方法，所有规则的权重均为1，使用min蕴含规则得到各个规则下的模糊集，使用max聚合规则将所有规则的输出模糊集组合为综合信任值模糊集。最后使用重心法解模糊得到综合信任值精确输出量Tsynthesized。步骤4：结合历史信任值和步骤3所得到的综合信任值计算最终信任值，将最终信任值低于阈值的节点加入黑名单并广播通知全网。步骤4.1：计算最终信任值。在计算最终信任值时同时考虑综合信任值Tsynthesized和4个历史信任值{Th1,Th2,Th3,Th4}，当前时间窗结算的最终信任值Tfinal为：Tfinal＝w0*Tsynthesized+w1*Th1+w2*Th2+w3*Th3+w4*Th4其中w0、w1、w2、w3和w4为衰减因子权重，w0∈，w1∈，w2∈，w3∈，w4∈，w0+w1+w2+w3+w4＝1。计算得到最终信任值，更新历史信任值为{Tfinal,Th1,Th2}，留作下一次最终信任值计算时使用。步骤4.2：设置信任值阈值Tth，0≤Tth≤1，当评估节点检测到Tfinal≤Tth时，将被评估节点地址加入自身黑名单并进行全网广播，随后采取措施将节点隔离出网络。实施例二表1为仿真参数设置，包括部署范围、节点通信范围、移动模型、仿真时间等；表2为改变随机种子实验100次后的统计的恶意节点检测率和误检率。恶意节点检测率定义为被检测到的恶意节点个数与恶意节点总数的比值，误检率定义为合法节点被检测为恶意节点的个数与合法节点总数的比值。表1表2恶意节点检测率97.43％误检率0.45％在本申请实施例二中，使用NS-3网络仿真模拟器，使用Aqua-Sim-NG模块，每个节点的发送数据包事件服从泊松分布。采用本申请实施例一中的信任模型，修改随机种子仿真100次，得到恶意节点检测率97.43％，误检率0.45％，这表明本发明提供方法具有较高的可靠性。本申请涉及水下无线传感器网络信任管理技术领域，提供了一种基于变隶属度函数模糊系统的信任模型。信任模型的隶属度函数可以受安全因子调控，针对特定攻击模式和环境场景自适应地改变，而不再是固定不变。模型考虑了节点间的不确定性，为不同节点提供差异化的信任评估，能够提高对来自重要区域攻击行为的敏感程度，缩短恶意攻击检测时间，减少攻击对网络造成的影响，还可以获得较高的检测率和较低的误检率。本申请实施例一的信任模型适用性强，鲁棒性高，具备较好的可解释性，克服现有方法的缺点，可以自适应地调整模型参数，做出差异化的信任评估，提高对重要区域节点的防护力度。需要注意的是，具体实施方式仅仅是对本发明技术方案的解释和说明，不能以此限定权利保护范围。凡根据本发明权利要求书和说明书所做的仅仅是局部改变的，仍应落入本发明的保护范围内。
