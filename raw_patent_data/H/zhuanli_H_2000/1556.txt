标题title
基于自编码器的图像压缩方法和装置
摘要abst
本发明提供了一种基于自编码器的图像压缩方法和装置。其中，该方法包括切割待处理图像为多个区域图块并依次输入至预先训练好的自编码器中，获得多个区域图块的图块纹理特征并进行维度合并，得到压缩纹理特征集；选定当前查找表并对将压缩纹理特征集进行最邻近查找，获得最邻近查找结果集后再进行维度拆分，得到与每个区域图块的图块纹理特征最邻近的最邻近纹理特征；将每个区域图块的最邻近纹理特征输入至预先训练好的解码器中获得多个最邻近区域图块并进行拼接获得输出图像。本发明的技术方案能够提取人眼感知不到的纹理特征，既提高压缩率又节省人工，而且具有用户可调的码率控制功能。
权利要求书clms
1.一种基于自编码器的图像压缩方法，其特征在于，所述图像压缩方法包括以下步骤：S1：切割待处理图像为多个区域图块；S2：将所述多个区域图块输入至当前自编码器中，获得与所述多个区域图块中的每个区域图块分别对应的图块纹理特征；S3：对所述多个区域图块的图块纹理特征进行维度合并，得到压缩纹理特征集；S4：根据所述压缩纹理特征集，通过当前查找表查找出与所述压缩纹理特征集中的每行压缩纹理特征最邻近的行特征，根据所述行特征获得最邻近查找结果集；S5：对所述最邻近查找结果集进行维度拆分，获得与所述多个区域图块中的每个区域图块的图块纹理特征最邻近的最邻近纹理特征；S6：将所述多个区域图块中的每个区域图块的最邻近纹理特征输入至当前解码器中获得多个最邻近区域图块；S7：将所述多个最邻近区域图块进行拼接，获得输出图像，其中，所述当前查找表从预先构建的查找表集合中选定，然后根据选定的所述当前查找表从预先训练好的自编码器与解码器集合中选定所述当前自编码器以及所述当前解码器。2.根据权利要求1所述的图像压缩方法，其特征在于，所述查找表集合在对所述自编码器与解码器集合进行预先训练的过程中构建。3.根据权利要求2所述的图像压缩方法，其特征在于，所述查找表集合中的每个查找表分别具有查找表序号，所述查找表序号为正整数。4.根据权利要求3所述的图像压缩方法，其特征在于，所述当前自编码器包括基础编码卷积模块组以及X个附加编码卷积模块，所述当前解码器包括基础解码卷积模块组以及X个附加解码卷积模块，其中X的值为所述当前查找表的序号减去1得到的值。5.根据权利要求4所述的图像压缩方法，其特征在于，所述方法还包括对所述最邻近查找结果集进行熵编码后传输至解码器端。6.根据权利要求5所述的图像压缩方法，其特征在于，所述自编码器与解码器集合的训练方法包括输入训练图片集，并分别对训练图片集中的每一帧训练图片执行以下步骤：S01：切割训练图片为多个训练图块，将每个训练图块的像素数据作为一组训练数据，所述多个训练图块各自的训练数据共同组成输入训练数据集；S02：所述自编码器对所述输入训练数据集进行编码并输出训练图块特征集；S03：在高、宽两个维度上对所述训练图块特征集进行合并以得到压缩训练特征集；S04：遍历所述压缩训练特征集，在第一查找表中逐行进行查找以选取与所述压缩训练特征集中的每个压缩训练特征最邻近的一行，获得第一查找表结果集；S05：在高、宽两个维度上对所述第一查找表结果集进行拆分以得到最邻近训练特征集；S06：将所述最邻近训练特征集输入至所述解码器以得到多个最邻近训练图块，所述多个最邻近训练图块共同构成输出训练图像；S07：固定基础编码卷积模块组中每个编码卷积模块的权重值、基础解码卷积模块组中每个解码卷积模块的权重值以及第一查找表中的内容不变，在所述自编码器与所述解码器中分别加入附加编码卷积模块与附加解码卷积模块，分别构成新的自编码器与新的解码器；S08：将所述查找表集合中的其他查找表依次作为新的第一查找表，并分别执行S01至S07，从而得到所述查找表集合中每一个查找表以及与所述每一个查找表相对应的自编码器与解码器的训练结果。7.根据权利要求6所述的图像压缩方法，其特征在于，所述方法中判断是否邻近的度量指标包括L1或L2范数。8.根据权利要求7所述的图像压缩方法，其特征在于，所述解码器输入端反向回传的梯度与所述自编码器输出端反向回传的梯度相同。9.根据权利要求8所述的图像压缩方法，其特征在于，所述压缩纹理特征集的压缩倍数由用户自行设定，所述压缩倍数包括正整数与正分数。10.根据权利要求9所述的图像压缩方法，其特征在于，当所述图块纹理特征除以所述压缩倍数后得到的压缩纹理特征的尺寸为分数时，则向上取整。11.一种基于自编码器的图像压缩装置，其特征在于，所述图像压缩装置包括以下模块：图像切割模块，被配置为切割待处理图像为多个区域图块；图像编码模块，被配置为将所述多个区域图块输入至当前自编码器中，获得与所述多个区域图块中的每个区域图块分别对应的图块纹理特征；维度合并模块，被配置为对所述多个区域图块的图块纹理特征进行维度合并，得到压缩纹理特征集；邻近查找模块，被配置为根据所述压缩纹理特征集，通过当前查找表查找出与所述压缩纹理特征集中的每行压缩纹理特征最邻近的行特征，根据所述行特征获得最邻近查找结果集；维度拆分模块，被配置为对所述最邻近查找结果集进行维度拆分，获得与所述多个区域图块中的每个区域图块的图块纹理特征最邻近的最邻近纹理特征；图像解码模块，被配置为将所述多个区域图块中的每个区域图块的最邻近纹理特征输入至当前解码器中获得多个最邻近区域图块；图像获取模块，被配置为将所述多个最邻近区域图块进行拼接，获得输出图像，其中，所述当前查找表从预先构建的查找表集合中选定，然后根据选定的所述当前查找表从预先训练好的自编码器与解码器集合中选定所述当前自编码器以及所述当前解码器。12.一种电子设备，其特征在于，所述电子设备包括：一个或多个处理器；存储器，其用于存储可执行指令；所述一个或多个处理器被配置为经由所述可执行指令来实现权利要求1至10中任一项所述的方法。13.一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时，使所述处理器执行权利要求1至10中任一项所述的方法。
说明书desc
技术领域本发明涉及图像压缩技术领域，尤其涉及一种基于自编码器的图像压缩方法和装置。背景技术现有技术中，基于神经网络进行图像压缩的方法均为使用神经网络对整张图像进行压缩，而非先将图像切分成图块再进行压缩。此外，现有技术在神经网络训练时也均使用整张图像作为训练数据进行训练。使用整张图像进行压缩的优势在于，整张图像中包括非常丰富的语义信息，这使得神经网络能够感知整张图像中的所有内容，从而能够提取更高层次的语义特征和全局特征。理论上而言，由于获得了更高层次的语义特征和全局特征，神经网络对整张图像进行压缩能够获得比对切割后的图像块进行压缩更高的压缩率。然而，尽管对整张图像进行压缩能够取得更好的压缩率，但是其在实际应用中仍存在一些问题。首先，为了获得更高的压缩率，神经网络需要学习全面的语义特征和全局特征，这导致整图压缩的神经网络体积通常会很大，而且需要更大的训练数据集和更长时间的训练才能达到要求。其次，神经网络体积变大还会严重影响压缩和解压缩的速度，尤其是难以在低算力低功耗的设备上部署使用。并且，由于网络算力高，大体积的神经网络也难以扩展应用至例如视频编解码等对吞吐率要求高的场景下。此外，由于需要全图输入，因此流式传输过程中编码器需要等到全图输入完毕后才能开始编码，在解码时解码器同样也需要接收到完整的图像比特流才能开始解码。这就导了图像编解码延迟增加，对延迟较高的应用场景存在较大的影响。现有技术中，基于频域变换进行图像压缩的方法通常是，分隔图像为多个图块，对每个图块进行无损频域变换，然后将变换后的结果使用量化表有损量化到更少的比特表示上，接着采用熵编码将所有图块的频域比特表示无损压缩成比特流。解压缩的方法是压缩方法的逆过程。然而，传统的频域压缩算法中，量化表是靠人的主观感知手工设计的，很难考虑到纹理的深层次关系并提取出冗余信息。此外，由于不同场景、不同风格的图像纹理存在不同，仅使用一个固定的量化表，很难在面对不同场景和风格的图片时均取得同样好的效果，但是对于每一种风格和场景分别设计一个量化表，又过于费时费力。综上所述，现有技术中无论是基于神经网络进行图像压缩的方法还是基于频域变换进行图像压缩的方法均存在一定的问题。发明内容鉴于此，本发明提供了一种基于自编码器的图像压缩方法及装置，以用于解决现有技术中的上述技术问题。根据本发明的一个方面，提供了一种基于自编码器的图像压缩方法，其中，该图像压缩方法包括以下步骤：S1：切割待处理图像为多个区域图块；S2：将多个区域图块输入至当前自编码器中，获得与多个区域图块中的每个区域图块分别对应的图块纹理特征；S3：对多个区域图块的图块纹理特征进行维度合并，得到压缩纹理特征集；S4：根据压缩纹理特征集，通过当前查找表查找出与压缩纹理特征集中的每行压缩纹理特征最邻近的行特征，根据行特征获得最邻近查找结果集；S5：对最邻近查找结果集进行维度拆分，获得与多个区域图块中的每个区域图块的图块纹理特征最邻近的最邻近纹理特征；S6：将多个区域图块中的每个区域图块的最邻近纹理特征输入至当前解码器中获得多个最邻近区域图块；S7：将多个最邻近区域图块进行拼接，获得输出图像，其中，当前查找表从预先构建的查找表集合中选定，然后根据选定的当前查找表从预先训练好的自编码器与解码器集合中选定当前自编码器以及当前解码器。根据本发明的另一个方面，提供了一种基于自编码器的图像压缩装置，其中，该图像压缩装置包括以下模块：图像切割模块，被配置为切割待处理图像为多个区域图块；图像编码模块，被配置为将多个区域图块输入至当前自编码器中，获得与多个区域图块中的每个区域图块分别对应的图块纹理特征；维度合并模块，被配置为对多个区域图块的图块纹理特征进行维度合并，得到压缩纹理特征集；邻近查找模块，被配置为根据压缩纹理特征集，通过当前查找表查找出与压缩纹理特征集中的每行压缩纹理特征最邻近的行特征，根据行特征获得最邻近查找结果集；维度拆分模块，被配置为对最邻近查找结果集进行维度拆分，获得与多个区域图块中的每个区域图块的图块纹理特征最邻近的最邻近纹理特征；图像解码模块，被配置为将多个区域图块中的每个区域图块的最邻近纹理特征输入至当前解码器中获得多个最邻近区域图块；图像获取模块，被配置为将多个最邻近区域图块进行拼接，获得输出图像，其中，当前查找表从预先构建的查找表集合中选定，然后根据选定的当前查找表从预先训练好的自编码器与解码器集合中选定当前自编码器以及当前解码器。根据本发明的又一个方面，提供了一种电子设备，包括：一个或多个处理器以及存储器，其中，存储器用于存储可执行指令；一个或多个处理器被配置为经由可执行指令来实现上述的方法。根据本发明的再另一方面，提供了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时，使处理器执行上述的方法。从以上技术方案可以看出，本发明所提供的技术方案至少存在以下优点：1. 本发明使用自编码器和隐空间的离散表示直接压缩，能够在纹理的更高层次统计纹理的冗余信息并进行分类压缩，从而达到更好的压缩效果；2. 本发明使用小型神经网络直接提取训练图片中图块的局部纹理特征，并学习局部纹理特征到低维空间的映射关系，再用训练最临近查找表的方式将低维空间映射到图块的低比特表示上，从而不仅提高了压缩和解压缩的速度，降低了图像的编解码延迟，还能够提取到人眼感知不到的纹理特征，学习到更高效的纹理特征到低比特的映射关系，既提高了压缩率又能节省人工；3. 本发明还通过从多个查找表中进行选择的方式实现了多级别的码率控制，使得本发明所提供的方法具有用户可调的码率控制功能。附图说明附图用来提供对本发明技术方案的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明的技术方案，但并不构成对本发明技术方案的限制。图1示出了本发明示例性实施例所提供的方法的流程图；图2示出了本发明示例性实施例中提供的一个多级码率的训练方法；图3示出了本发明示例性实施例中提供的又一多级码率的训练方法；图4示出了本发明示例性实施例中提供的再一多级码率的训练方法；图5示出了本发明示例性实施例中第一卷积神经网络的示意图；图6示出了本发明示例性实施例中第二卷积神经网络的示意图；图7示出了本发明示例性实施例中第三、四卷积神经网络的示意图；图8示出了本发明示例性实施例中第五、六卷积神经网络的示意图；图9示出了本发明示例性实施例中第七卷积神经网络的示意图；图10示出了本发明示例性实施例中第八卷积神经网络的示意图；图11示出了本发明示例性实施例中卷积神经网络A1、A2的示意图；图12示出了本发明示例性实施例中卷积神经网络B1、B2的示意图；图13示出了本发明示例性实施例中进行图像压缩的方法；图14示出了本发明示例性实施例中进行图像解压缩的方法；图15示出了本发明示例性实施例所提供的装置的结构框图；图16示出了本发明示例性实施例所提供的电子设备的结构框图。具体实施方式下面将参照附图来详细描述本发明的各种示例性实施例。对示例性实施例的描述仅仅是说明性的，并不作为对本发明及其应用或使用的任何限制。本发明能够以许多不同的形式实现，不限于这里所述的实施例。提供这些实施例是为了使本发明透彻且完整，并且向本领域技术人员充分表达本发明的范围。除非明确表明，如果未特意限定要素的数量，则该要素可以是一个也可以是多个。术语“多个/若干”意指两个或更多，术语“基于”应解释为“至少部分地基于”，术语“和/或”以及“……中的至少一个”涵盖所列出的项目中的任何一个以及全部可能的组合方式。另外，“第一”、“第二”等类似表述仅出于描述目的，而非指示或暗示其相对重要性或者隐含指明所指示的技术特征的数量。请参考图1，其示出了本发明示例性实施例所提供的方法的流程图。本发明提供的基于自编码器的图像压缩方法包括以下步骤：S1：切割待处理图像为多个区域图块；S2：将多个区域图块输入至当前自编码器中，获得与多个区域图块中的每个区域图块分别对应的图块纹理特征；S3：对多个区域图块的图块纹理特征进行维度合并，得到压缩纹理特征集；S4：根据压缩纹理特征集，通过当前查找表查找出与压缩纹理特征集中的每行压缩纹理特征最邻近的行特征，根据行特征获得最邻近查找结果集；S5：对最邻近查找结果集进行维度拆分，获得与多个区域图块中的每个区域图块的图块纹理特征最邻近的最邻近纹理特征；S6：将多个区域图块中的每个区域图块的最邻近纹理特征输入至当前解码器中获得多个最邻近区域图块；S7：将多个最邻近区域图块进行拼接，获得输出图像，其中，当前查找表从预先构建的查找表集合中选定，然后根据选定的当前查找表从预先训练好的自编码器与解码器集合中选定当前自编码器以及当前解码器。以下部分将结合具体的实施例对本发明所提供的训练方法进行详细说明。首先，将训练图片集中的图片划分为训练图块，并以训练图的图块纹理数据作为训练集来训练自编码器与解码器集合，构建查找表集合，详细步骤如下。1. 根据所需压缩图像的场景或风格选取训练图片数据集。将图片数据集中的每一张图片都切割为多个训练图块，训练图块的尺寸可以为16×16、32×32或64×64，具体选择还需根据训练完毕后进行测试得出的测试结果进行调整。举例而言，假设图片数据集共有100张图片，每张图片的分辨率为1920×1080，并选定训练图块的分辨率为32×32，则每张图片可切分出2025个训练图块，整个图片数据集共产生202500个区域图块。2. 使用所有的训练图块训练自编码器和解码器。自编码器网络包括多个级连的卷积神经网络，每个卷积神经网络模块可能包括二维卷积层、激活层、归一化层、残差结构层中的一个或多个层的组合。自编码器的输入为训练图块，将各个训练图块的像素数据作为一组训练数据，尺寸为。自编码器的输出为训练图块特征集，尺寸为/＞，其中N为降采样倍数，一般取2的整数次方倍，D为输出通道数。将自编码器输出的训练图块特征集在高和宽两个维度上合并以得到压缩训练特征集，此时训练图块特征尺寸经压缩后变为/＞。3. 构建一个尺寸为的矩阵作为查找表。遍历自编码器输出的压缩训练特征在维度上的每个特征，并在查找表中按行查找，选取与该特征最邻近的一行，最终得到/＞个查找表的行结果，这些最邻近查找表的结果组成一个尺寸为/＞的矩阵。查找中判断是否邻近的度量指标包括L1或L2范数。将查找后得到的尺寸为的矩阵在/＞维度上拆分成/＞和/＞维度，得到一个/＞特征，将该特征通过解码器解码成尺寸为/＞的图像。其中，解码器包括多个级连的卷积神经网络，每个卷积神经网络模块可能包括二维卷积层、二维反卷积、激活层、归一化层、残差结构层中的一个或多个层的组合。在训练过程中，由于最邻近查找操作的输出对特征输入是不可导的，故采用直通的方式，直接将解码器输入端反向回传的梯度作为自编码器输出端反向回传的梯度。上述训练过程中能够最小化三个损失，分别是：图块重建损失最小，即输入图块和输出图块的差别最小；自编码器输出特征和解码器的输入特征的L2距离最小；以及，解码器的输入特征和对应查找表中对应的行特征的L2距离最小。此外，本发明所提出的方法还可以根据场景或风格的不同，独立训练不同场景、不同风格图片适用的神经网络，从而取得更好的压缩效果。以下部分将结合具体的实施例对本发明所提供的图像压缩方法进行详细说明。自编码器与解码器集合训练完成、查找表集合构建完成后即可运用于图像压缩与解压缩，其中自编码器用于图像压缩并能到图像压缩后的比特流，具体说明如下。1. 将待处理图像切分多个区域图块，区域图块的尺寸与训练时选取的尺寸相同。假设每张待处理图像最终切分出了M个区域图块。将区域图块按切割时的图像块序号依次输入自编码器做推理，则每个区域图块都会得到一个尺寸为的特征，将该特征的每行在查找表中查找最邻近的行，并取得这些最邻近行在R维度上的序号作为查找结果。某区域图块该特征中的所有行处理完后，就能得到/＞个序号，这些序号可以组成一个尺寸为的向量。所有M个区域图块处理完毕后即能获得M个/＞的向量，此时共有个元素，每个元素均是一个R维度上的序号。2. 统计个序号的频数，对序号进行熵编码，例如采用霍夫曼编码，得到每个序号的二进制编码。3. 按图像块序号的顺序，以及每个区域图块向量中序号的排列顺序，将序号的二进制编码组成比特流，该比特流即为待压缩的图像压缩后的比特流。解码器用于图像解压缩并得到解压缩后的图像，具体说明如下。接收到压缩后的比特流后，使用熵编码的解码方法，将二进制编码拆分成序号的序列，该序列的排列顺序与图像块序号的顺序以及每个区域图块向量中序号的排列顺序相对应。将每个序号送入训练时产生的查找表，取出该序号对应的查找表中的最邻近行。将每个区域图块/＞向量中的序号对应的最邻近行组成/＞的矩阵，该矩阵即为当前区域图块的特征矩阵。将每个区域图块的的矩阵在维度上做拆分，得到尺寸为的特征，将此特征通过解码器，则能够得到的最邻近区域图块。然后，按照图像块序号的顺序，将所有最邻近区域图块拼接起来，即得到解压缩图像。请参考图2至图4，其示出了本发明示例性实施例中提供的多级码率的训练方法。在一个优选实施例中，本发明还提出了一种多级码率控制方法，能够实现用户可调的压缩率控制功能。请一并参考图5至图10，其分别示出了本发明示例性实施例中第一至第八卷积神经网络的示意图。自编码器与解码器集合通过神经网络模型训练获得，查找表集合在对自编码器与解码器集合进行预先训练的过程中预先构建。刚开始训练时，初始的自编码器中包括基础编码卷积模块组，初始的解码器中包括基础解码卷积模块组。图2至图4中，基础编码卷积模块组包括第一卷积神经网络至第四卷积神经网络，共计四个卷积神经网络；基础解码卷积模块组包括第五卷积神经网络至第八卷积神经网络，共计四个卷积神经网络。然而，上述基础编码卷积模块组与基础解码卷积模块组中卷积神经网络的个数仅作为示例，并非用于限定本发明，也可根据需要选择其他数量的卷积神经网络。训练方法包括输入训练图片集，并分别对训练图片集中的每一帧训练图片执行以下步骤：S01：切割训练图片为多个训练图块，将每个训练图块的像素数据作为一组训练数据，多个训练图块各自的训练数据共同组成输入训练数据集；S02：自编码器对输入训练数据集进行编码并输出训练图块特征集；S03：在高、宽两个维度上对训练图块特征集进行合并以得到压缩训练特征集；S04：遍历压缩训练特征集，在第一查找表中逐行进行最邻近查找以选取与压缩训练特征集中的每个压缩训练特征最邻近的一行，获得第一查找表结果集；S05：在高、宽两个维度上对第一查找表结果集进行拆分以得到最邻近训练特征集；S06：将最邻近训练特征集输入至解码器以得到多个最邻近训练图块，多个最邻近训练图块共同构成输出训练图像；S07：固定基础编码卷积模块组中每个编码卷积模块的权重值、基础解码卷积模块组中每个解码卷积模块的权重值以及第一查找表中的内容不变，在自编码器与解码器中分别加入附加编码卷积模块与附加解码卷积模块，分别构成新的自编码器与新的解码器；S08：将查找表集合中的其他查找表依次作为新的第一查找表，并分别执行S01至S07，从而得到查找表集合中每一个查找表以及与每一个查找表相对应的自编码器与解码器的训练结果。上述训练完成后，即能够通过对查找表集合、自编码器与解码器集合的选择实现多级码率控制。具体而言，本发明所提供的方法中查找表集合中的每个查找表分别具有查找表序号，且查找表序号为正整数。根据用户选择的当前查找表不同，当前自编码器与当前解码器的构成也不同。其中，当前自编码器包括基础编码卷积模块组以及X个附加编码卷积模块，当前解码器包括基础解码卷积模块组以及X个附加解码卷积模块，X的值为所述当前查找表的序号减去1得到的值。以图3为例，当选择第二查找表时，当前自编码器包括基础编码卷积模块组以及1个附加编码卷积模块，当前解码器包括基础解码卷积模块组以及1个附加解码卷积模块。以图2为例，当选择第一查找表时，当前自编码器包括基础编码卷积模块组以及0个附加编码卷积模块，当前解码器包括基础解码卷积模块组以及0个附加解码卷积模块。此外，由上述步骤可知，训练方法中包括多个查找表和最邻近查找操作，每个最邻近查找操作的高、宽合并后维度依次降低一个压缩倍数K。邻近查找操作的数量和压缩倍数由用户根据应用场景决定。压缩倍数K压缩倍数包括正整数与正分数，如果图块纹理特征尺寸除以降采样倍数、压缩倍数之后计算出的尺寸不是整数，则需要将尺寸向上取整。此外，每增加一级卷积网络模块和邻近查找，图像的尺寸就会除以K倍，因此邻近查找操作的数量不能太多，以避免图像的尺寸小于卷积核的尺寸。向上取整的举例说明：例如输入图块尺寸为32×32，若取N=1.5，则自编码器输出图块分辨率为21.333×21.333，需要向上取整至22×22。然后设计一个输入为32×32，输出为22×22的卷积神经网络映射关系。邻近查找操作的数量受限的举例说明：例如，当输入图块尺寸是32×32，N=1，K=2时，第一级卷积网络模块和邻近查找会让输出图块分辨率变为16×16，第二级卷积网络模块和邻近查找会让输出图块分辨率变为8×8。第三级卷积网络模块和邻近查找会让输出图块分辨率变为4×4。由于卷积网络模块中的卷积核大小为4×4，图块的分辨率已经缩小到可处理的极限，因此只能再增加一级卷积网络模块和邻近查找模块。右侧框中最多可以有四级卷积网络模块和邻近查找模块。以下部分对多码率多个查找表的训练方法进行详细说明。图11、12分别示出了本发明示例性实施例中卷积神经网络A1、A2以及卷积神经网络B1、B2的示意图。选取一个自然风光图像的数据集，该数据集共含有100张分辨率为1920×1080的图像，将每一张图像切分成32×32的训练图块，则每张整图可以切分出2025个训练图块，整个数据集共产生2025×100=202500个训练图块。每个训练图块保存为3通道的RGB图像。选定N=1，K=2，R=210，则自编码器输出的图块尺寸大小为32×32。经过最邻近查找后输出的图块中每个像素用10比特表示，而输入图块的尺寸为32×32，有3个通道，每个通道为8比特表示，因此神经网络的理论压缩率为倍。每增加一级K=2的卷积网络模块和R=210邻近查找模块，理论压缩率增大4倍。首先用202500个训练图块训练图2中的神经网络。训练完成后，固定第一卷积神经网络至第八卷积神经网络的权重，使第一卷积神经网络至第八卷积神经网络的权重不参与训练过程中权重的更新，移除第一邻近查找模块，并将卷积神经网络A1、卷积神经网络B1和第二邻近查找模块添加到训练网络中，此时新的训练网络如图3所示。卷积神经网络A1、卷积神经网络B1和第二邻近查找模块训练完毕后，固定卷积神经网络A1与卷积神经网络B1的权重，并移除第二邻近查找模块，将卷积神经网络A2、卷积神经网络B2和第三邻近查找模块添加到训练网络中，此时新的训练网络如图4所示。以此类推，训练完所有待训练的卷积神经网络模块和邻近查找模块。虽然每添加一级卷积神经网络和邻近查找表，图像的压缩率理论上会提高K倍，但是图像的质量也会有相应的下降。因此，各级神经网络模块训练完毕以后，用户可以根据自己对压缩率的要求和图像质量的要求，从预先训练好的查找表集合中选定一个作为当前查找表。然后，使用该当前查找表以及与之对应的卷积神经网络模块继续图像压缩操作。请参考图13至图14，其示出了本发明示例性实施例中进行图像压缩与解压缩的方法。以下将以使用训练好的第二邻近查找模块为例进行图像压缩操作的示例性说明。将待压缩的图像切割成32×32的区域图块，一张1920×1080的图可以切出2025个区域图块，每个区域图块分别具有各自的图像块序号。按图像块序号的顺序送入神经网络进行推理，经过卷积神经网络A1后，每个区域图块都会得到一个尺寸为的特征，将该特征维度合并为，并将该特征的每行在查找表中查找最邻近的行，取得最邻近行的在R=1024维度上的序号。该区域图块的所有行可得个序号并组成一个尺寸为的向量。所有区域图块最终可以得到2025个的向量，共有518400个元素，每个元素是一个R维度上的序号。接着，统计这518400个序号的频数，对序号进行熵编码以得到每个序号的二进制编码。按图像块序号的顺序以及每个区域图块向量中序号的排列顺序，将序号的二进制编码组成比特流，该比特流即为待压缩的图像压缩后的比特流。如图14所示，接收到图像压缩后的比特流以后，按照图像块序号的顺序以及每个区域图块向量中序号的排列顺序，将比特流拆分成序号的二进制表示序列。然后使用熵编码的解码方法将序号的二进制表示解码成查找表的序号。将每个序号按照编码时向量中序号的排列顺序，送入第二查找表，取出该序号对应的查找表中的一行。将每个图块向量中的序号对应的行，组成的矩阵，该矩阵即为当前图块的特征矩阵。一张1920×1080的图像总共需要查找2025个图块，每个图块对应查找256个序号。将每个图块的的矩阵在高、宽维度上做拆分，得到尺寸为的特征，将此特征通过解码器则得到的图块。最后，按照图像块序号的顺序，将所有图块通过解码器得到的的图块拼接起来，即得到解压后的1920×1080图像。请参考图14，其示出了本发明示例性实施例所提供的装置的结构框图。本发明还提供了一种基于自编码器的图像压缩装置，具体地，该图像压缩装置包括以下模块：图像切割模块，被配置为切割待处理图像为多个区域图块；图像编码模块，被配置为将多个区域图块输入至当前自编码器中，获得与多个区域图块中的每个区域图块分别对应的图块纹理特征；维度合并模块，被配置为对多个区域图块的图块纹理特征进行维度合并，得到压缩纹理特征集；邻近查找模块，被配置为根据压缩纹理特征集，通过当前查找表查找出与压缩纹理特征集中的每行压缩纹理特征最邻近的行特征，根据行特征获得最邻近查找结果集；维度拆分模块，被配置为对最邻近查找结果集进行维度拆分，获得与多个区域图块中的每个区域图块的图块纹理特征最邻近的最邻近纹理特征；图像解码模块，被配置为将多个区域图块中的每个区域图块的最邻近纹理特征输入至当前解码器中获得多个最邻近区域图块；图像获取模块，被配置为将多个最邻近区域图块进行拼接，获得输出图像，其中，当前查找表从预先构建的查找表集合中选定，然后根据选定的当前查找表从预先训练好的自编码器与解码器集合中选定当前自编码器以及当前解码器。应当理解，图15中所示的装置可以与本说明书前文描述的方法相对应。由此，上面针对方法描述的操作、特征和优点同样适用于本发明所提供的装置及其包括的模块，上面针对装置及其包括的模块描述的操作、特征和优点同样适用于本发明所提供的方法。为了简洁起见，某些操作、特征和优点将不再赘述。虽然上面参考特定模块讨论了特定功能，但是应当注意，本发明技术方案中各个模块的功能也可以分为多个模块进行实现，和/或多个模块的至少一些功能可以组合成单个模块进行实现。本发明技术方案中特定模块执行动作的方式包括，该特定模块本身执行动作，或者由该特定模块调用或以其他方式访问执行动作。因此，执行动作的特定模块可以包括执行动作的该特定模块本身和/或该特定模块调用或以其他方式访问的、执行动作的另一模块。除上述技术方案外，本发明还提供了一种电子设备，该电子设备包括一个或多个处理器以及用于存储可执行指令存储器。其中，该一个或多个处理器被配置为经由可执行指令来实现上述方法。本发明还提供了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时，使得处理器执行上述方法。在本说明书的以下部分，将结合图16来描述前述电子设备、计算机可读存储介质的说明性示例。图16示出了可以被用来实施本发明所描述的方法的电子设备300的示例配置。本发明技术方案可以全部或至少部分地由电子设备300或类似设备/系统实现。电子设备300可以是各种不同类型的设备。电子设备300的示例包括但不限于：台式计算机、服务器计算机、笔记本电脑、移动设备、可穿戴设备、娱乐设备、电视或其他显示设备、汽车计算机等。电子设备300可包括能够通过系统总线311或其他适当的连接彼此通信的至少一个处理器302、存储器304、通信接口309、显示设备301、其他输入/输出设备310以及一个或更多大容量存储设备303。处理器302可以是单个或多个处理单元，所有处理单元可以包括单个或多个计算单元或多个核心。处理器302可以被实施成一个或多个微处理器、微型计算机、微控制器、数字信号处理器、中央处理单元、状态机、逻辑电路和/或基于操作指令来操纵信号的任何设备。此外，处理器302可被配置成获取并且执行存储在存储器304、大容量存储设备303或其他计算机可读介质中的计算机可读指令，例如操作系统305或应用程序306或其他程序307的程序代码等。存储器304和大容量存储设备303是用于存储指令的计算机可读存储介质的示例，指令由处理器302执行来实施前面所描述的各种功能。举例来说，存储器304一般包括易失性存储器和非易失性存储器。此外，大容量存储设备303一般包括硬盘驱动器、固态驱动器、可移除介质、包括外部和可移除驱动器、存储器卡、闪存、软盘、光盘、存储阵列、网络附属存储、存储区域网等。存储器304和大容量存储设备303在本发明中可以被统称为存储器或计算机可读存储介质，并且可以是能够把计算机可读、处理器可执行程序指令存储为计算机程序代码的非暂态介质，计算机程序代码可由处理器302作为被配置成实施在本发明的示例中所描述的操作和功能的特定机器来执行。多个程序可以存储在大容量存储设备303上。这些程序包括操作系统305、一个或多个应用程序306、其他程序307和程序数据308，并且它们可以被加载到存储器304以供执行。这样的应用程序或程序模块的示例可以包括例如用于实现以下部件/功能的计算机程序逻辑：本发明所提供的方法和/或本发明描述的另外的实施例。虽然在图16中被示成存储在电子设备300的存储器304中，但模块化的操作系统305、应用程序306、其他程序307和程序数据308或者其部分可使用能由电子设备300访问的任何形式的计算机可读介质来实施。计算机可读介质可以是能供计算机访问的任意可用的计算机可读存储介质或通信介质。通信介质包括例如计算机可读指令、数据结构、程序模块或其他数据的通信信号被从一个系统传送到另一系统的介质。通信介质可包括有导的传输介质以及能传播能量波的无线介质。计算机可读指令、数据结构、程序模块或其他数据可被体现为例如无线介质中的已调制数据信号。例如，计算机可读存储介质可包括以用于存储如计算机可读指令、数据结构、程序模块或其它数据的信息的任何方法或技术实现的易失性和非易失性、可移动和不可移动的介质。例如，计算机可读存储介质包括但不限于，易失性存储器，例如随机存储器；以及非易失性存储器，例如闪存、各种只读存储器、磁性和铁磁/铁电存储器；以及磁性和光学存储设备；或其它已知的介质或今后开发的能够存储供计算机系统使用的计算机可读信息/数据。一个或多个通信接口309用于通过如网络、直接连接等与其他设备交换数据。此通信接口可以是以下各项中的一个或多个：任何类型的网络接口、有线或无线接口、Wi-MAX接口、以太网接口、USB接口、蜂窝网络接口、蓝牙接口、NFC接口等。通信接口309可以促进在多种网络和协议类型内的通信，其中包括有线网络和无线网络、因特网等。通信接口309还可提供与例如存储阵列、网络附属存储、存储区域网等中的外部存储设备的通信。在一些示例中，可以包括例如监视器的显示设备301，以用于向用户显示信息和图像。其他I/O设备310可以是接收用户输入并向用户提供输出的设备，例如包括触摸/手势输入设备、摄影机、键盘、遥控器、鼠标、音频输入/输出设备等。本发明描述的技术方案可由电子设备300的这些各种配置来支持，并且不限于本发明所描述的技术方案的具体示例。说明书及附图中的说明与描述并非用于限制本发明，对本领域技术人员而言，在不背离本发明精神或基本特征的情况下能够以其他的具体形式实现本发明。本发明所要求保护的范围由权利要求而非上述说明限定，落在权利要求的等同要件含义和范围内的所有更改与变动均属于本发明的保护范围。
