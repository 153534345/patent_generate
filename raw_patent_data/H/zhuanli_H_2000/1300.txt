标题title
一种基于4G物联网的铁路安全防护系统的实现方法
摘要abst
本发明涉及一种基于4G物联网的铁路安全防护系统的实现方法，安全防护移动终端通过内置的4G物联网卡与云服务器、机车台主机和道口摄像头实现通信；云服务器触发预警信令：安全防护移动终端发起报警：实时查看线路当前情况：安全防护移动终端内置道口视频软件，打开视频数据流的链接地址查看道口实时情况，通过实时查看线路当前情况，对于前方道口情况进行掌握，及时提示机车台主机前方道口存在的潜在危险以及对道口行人人身安全进行提前预判，防止列车与道口行人、车辆、物体发生相撞事故。
权利要求书clms
1.一种基于4G物联网的铁路安全防护系统的实现方法，基于机车台主机、安全防护移动终端、道口摄像头和云服务器实现，所述安全防护移动终端操作系统为Android5.0及以上，其特征在于，具体步骤如下：第一步，建立通信连接：机车台主机、安全防护移动终端、云服务器和道口摄像头接入4G网络系统后，机车台主机与云服务器建立通信连接，多台安全防护移动终端与云服务器建立通信连接，多个道口摄像头与云服务器建立通信连接；第二步，云服务器触发预警信令：建立通信连接以后，机车台主机和多台安全防护移动终端分别发送位置给云服务器，云服务器通过计算得到机车台主机和多台安全防护移动终端之间的距离，计算结果的距离小于配置的距离后触发预警信令，云服务器将预警信令发送给小于配置距离的安全防护移动终端；第三步，安全防护移动终端发起报警：发现异常情况的安全防护移动终端将报警信令发送给云服务器，云服务器将报警信令转发给机车台主机和其他的安全防护移动终端；第四步，获取道口摄像头数据链接地址：建立通信连接以后，道口摄像头定时向云服务器发送最新的道口摄像头数据链接地址，云服务器将收到的道口摄像头数据的链接地址保存在数据库，安全防护移动终端向云服务器发送获取道口摄像头数据链接地址的请求信令，云服务器将数据库中最新的道口摄像头数据的链接地址转发给发起请求的安全防护移动终端；第五步，实时查看线路当前情况：基于步骤二、步骤三、步骤四，每一台安全防护移动终端的地图页面以marker的形式展示其他的安全防护移动终端、机车台主机和道口摄像头所在的位置，以列表的形式展示云服务器发送的预警信令、其他安全防护移动终端发送的报警信令和道口摄像头数据链接地址，安全防护移动终端通过内置道口视频软件查看道口实时情况。2.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第一步所述机车台主机与云服务器建立通信连接的方法为：云服务器使用SpringBoot框架开发，并集成了Spring Data JPA简化持久层的操作，内置服务器响应软件以及基于MySQL的信息数据库，云服务器开机后，开启Spring Boot 框架中的HttpServer服务器端口，等待机车台主机发起连接请求，机车台主机是基于CIR系统，内置向服务器发起请求的应用软件，机车台主机在开机以后，内置应用软件自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败，当连接失败时开启定时器，每隔10秒连接一次，直到连接成功，定时器关闭。3.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第一步所述多台安全防护移动终端与云服务器建立通信连接方法为：服务器开启Spring Boot 框架中的HttpServer服务器端口，等待安全防护移动终端发起连接请求，安全防护移动终端是基于android9.0 64位系统的三防工业级安全防护移动终端，内置向服务器发起请求的应用软件，向云服务器发送报警信令，接收服务器发送过来的预警信令，安全防护移动终端在开机以后，内置应用app自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败，当连接失败时安全防护移动终端app开启定时器，每隔10秒连接一次，直到连接成功，定时器关闭。4.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第一步所述多个道口摄像头与云服务器建立通信连接方法为：服务器开启Spring Boot 框架中的HttpServer服务器端口，等待道口摄像头发起连接请求，道口摄像头在开机以后，内置应用自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败。5.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第二步所述机车台主机和多台安全防护移动终端分别发送位置给云服务器的方法为：机车台主机通过http协议每隔10秒向云服务器发送经度、纬度、线路名、机车号、车次号、速度、距离、公里标和时间信息，安全防护移动终端通过http协议每隔10秒向云服务器发送经度和纬度。6.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第二步所述云服务器将预警信令发送给小于配置距离的安全防护移动终端的方法为：云服务器得到的机车台主机和安全防护移动终端的经度和纬度确定的位置，利用高德地图提供的距离计算公式：float distance = AMapUtils.calculateLineDistance，通过传入的车台主机位置参数latLng1和安全防护移动终端的位置参数latLng2计算后得到车台主机和安全防护移动终端的距离distance，distance小于配置的距离后触发预警信令，通过websocket将预警信令发送给安全防护移动终端，distance不小于配置的距离，云服务器将位置信息保存数据库。7.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第三步所述安全防护移动终端将报警信令发送给云服务器，云服务器将报警信令转发给机车台主机和其他的安全防护移动终端的方法为：安全防护移动终端通过http协议给云服务器发送报警信令，云服务器通过websocket协议给机车台主机和其他安全防护移动终端发送报警信令，报警信令内容包括：报警类型、报警时间、报警位置、设备号。8.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第四步所述云服务器将数据库中最新的道口摄像头数据的链接地址转发给发起请求的安全防护移动终端的方法为：道口摄像头的连接地址每隔5分钟刷新一次，在刷新完成后，将最新的生成的道口摄像头数据的链接地址通过http发送给云服务器，云服务器将收到的道口摄像头数据的链接地址保存在数据库，安全防护移动终端通过http请求向云服务器发送请求摄像头数据链接地址的命令，云服务器通过查询数据库将道口摄像头数据的最新链接地址转发给当前安全防护移动终端。9.根据权利要求1所述的一种基于4G物联网的铁路安全防护系统的实现方法，其特征在于：第五步所述安全防护移动终端通过内置道口视频软件查看道口实时情况的方法为：软件包含，播放、暂停、道口信息、截图保存当前状态的四个功能子项，播放软件通过rtsp协议对视频流进行解析和渲染后进行播放。
说明书desc
技术领域本发明涉及一种基于4G物联网的铁路安全防护系统的实现方法，属于铁路交通安全通信技术领域。背景技术铁路网络安全的防护系统在目前的铁路上运用比较广泛，技术也比较成熟，主要采用的方法是机车台主机通过安装的GPS定位模块，实时上报位置信息，固定在室内的盯控系统显示当前机车台主机的位置信息，盯控台工作人员通过机车台主机位置信息判断是否发出预警信令，如果需要发送预警信令，通过对讲机的方式发送给对应的对讲机设备，以语音的方式告诉巡道工人员做出相应的安全措施。而随着铁路运输的高速发展，这样的方案会使巡道工接收预警信令不及时，不能远程查看机车台主机和道口的实时详细情况，从而无法实现远程道口的主动报警。以专利公开号CN201711126953，《一种既有线路施工中来车预警系统》为例，为实现铁路安全防护系统，采用包括无线红外探测器、无线报警主机以及无线数字对讲机设备去实现；无线数字对讲机包括无线数字主对讲机以及无线数字子对讲机；无线红外探测器与无线报警主机通信连接，无线报警主机与无线数字主对讲机通信连接，将存储的报警信息输出至所述无线数字主对讲机；无线数字主对讲机设置有声控发射模块，可通过声控与多台所述无线数字子对讲机及时通讯，来满足铁路防护预警的效果。其不足之处为，每增加一个铁路巡道工人，都需要为其配置一个对讲机，并且对讲机不能实时查看当前线路上道口、周围巡道工，机车的情况。发明内容鉴于目前铁路安全防护存在预警不及时，无法实时远程查看其他道口、机车台主机详细信息，巡道工需要单独配置对讲机等问题，本发明提供了一种基于4G物联网的铁路安全防护系统的实现方法，通过websocket、rtsp和http协议实现机车台主机、安全防护移动终端和道口摄像头和云服务器之间相互通信，实现了应用于目前铁路安全防护系统中机车台主机向多台安全防护移动终端发送预警信令，安全防护移动终端向机车台主机发送报警信令以及在安全防护移动终端实时查看线路当前情况。本发明采用的技术方案是：一种基于4G物联网的铁路安全防护系统的实现方法，基于机车台主机、安全防护移动终端、道口摄像头和云服务器实现，所述安全防护移动终端操作系统为Android5.0及以上，具体步骤如下：第一步，建立通信连接：机车台主机、安全防护移动终端、云服务器和道口摄像头接入4G网络系统后，机车台主机与云服务器建立通信连接，多台安全防护移动终端与云服务器建立通信连接，多个道口摄像头与云服务器建立通信连接；第二步，云服务器触发预警信令：建立通信连接以后，机车台主机和多台安全防护移动终端分别发送位置给云服务器，云服务器通过计算得到机车台主机和多台安全防护移动终端之间的距离，计算结果的距离小于配置的距离后触发预警信令，云服务器将预警信令发送给小于配置距离的安全防护移动终端；第三步，安全防护移动终端发起报警：发现异常情况的安全防护移动终端将报警信令发送给云服务器，云服务器将报警信令转发给机车台主机和其他的安全防护移动终端；第四步，获取道口摄像头数据链接地址：建立通信连接以后，道口摄像头定时向云服务器发送最新的道口摄像头数据链接地址，云服务器将收到的道口摄像头数据的链接地址保存在数据库，安全防护移动终端向云服务器发送获取道口摄像头数据链接地址的请求信令，云服务器将数据库中最新的道口摄像头数据的链接地址转发给发起请求的安全防护移动终端；第五步，实时查看线路当前情况：基于步骤二、步骤三、步骤四，每一台安全防护移动终端的地图页面以marker的形式展示其他的安全防护移动终端、机车台主机和道口摄像头所在的位置，以列表的形式展示云服务器发送的预警信令、其他安全防护移动终端发送的报警信令和道口摄像头数据链接地址，安全防护移动终端通过内置道口视频软件查看道口实时情况，对于前方道口情况进行掌握，及时提示机车台主机前方道口存在的潜在危险以及对道口行人人身安全进行提前预判，防止列车与道口行人、车辆、物体发生相撞事故。第一步所述机车台主机与云服务器建立通信连接的方法为：云服务器使用SpringBoot框架开发，并集成了Spring Data JPA简化持久层的操作，内置服务器响应软件以及基于MySQL的信息数据库，云服务器开机后，开启Spring Boot 框架中的HttpServer服务器端口，等待机车台主机发起连接请求，机车台主机是基于CIR系统，内置向服务器发起请求的应用软件，机车台主机在开机以后，内置应用软件自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败，当连接失败时开启定时器，每隔10秒连接一次，直到连接成功，定时器关闭。第一步所述多台安全防护移动终端与云服务器建立通信连接方法为：服务器开启Spring Boot 框架中的HttpServer服务器端口，等待安全防护移动终端发起连接请求，安全防护移动终端是基于android9.0 64位系统的三防工业级安全防护移动终端，内置向服务器发起请求的应用软件，向云服务器发送报警信令，接收服务器发送过来的预警信令，安全防护移动终端在开机以后，内置应用app自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败，当连接失败时安全防护移动终端app开启定时器，每隔10秒连接一次，直到连接成功，定时器关闭。第一步所述多个道口摄像头与云服务器建立通信连接方法为：服务器开启SpringBoot 框架中的HttpServer服务器端口，等待道口摄像头发起连接请求，道口摄像头在开机以后，内置应用自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败。第二步所述机车台主机和多台安全防护移动终端分别发送位置给云服务器的方法为：机车台主机通过http协议每隔10秒向云服务器发送经度、纬度、线路名、机车号、车次号、速度、距离、公里标和时间信息，安全防护移动终端通过http协议每隔10秒向云服务器发送经度和纬度。第二步所述云服务器将预警信令发送给小于配置距离的安全防护移动终端的方法为：云服务器得到的机车台主机和安全防护移动终端的经度和纬度确定的位置，利用高德地图提供的距离计算公式：float distance = AMapUtils.calculateLineDistance，通过传入的车台主机位置参数latLng1和安全防护移动终端的位置参数latLng2计算后得到车台主机和安全防护移动终端的距离distance，distance小于配置的距离后触发预警信令，通过websocket将预警信令发送给安全防护移动终端，distance不小于配置的距离，云服务器将位置信息保存数据库。第三步所述安全防护移动终端将报警信令发送给云服务器，云服务器将报警信令转发给机车台主机和其他的安全防护移动终端的方法为：安全防护移动终端通过http协议给云服务器发送报警信令，云服务器通过websocket协议给机车台主机和其他安全防护移动终端发送报警信令，报警信令内容包括：报警类型、报警时间、报警位置、设备号。第四步所述云服务器将数据库中最新的道口摄像头数据的链接地址转发给发起请求的安全防护移动终端的方法为：道口摄像头的连接地址每隔5分钟刷新一次，在刷新完成后，将最新的生成的道口摄像头数据的链接地址通过http发送给云服务器，云服务器将收到的道口摄像头数据的链接地址保存在数据库，安全防护移动终端通过http请求向云服务器发送请求摄像头数据链接地址的命令，云服务器通过查询数据库将道口摄像头数据的最新链接地址转发给当前安全防护移动终端。第五步所述安全防护移动终端通过内置道口视频软件查看道口实时情况的方法为：软件包含，播放、暂停、道口信息、截图保存当前状态的四个功能子项，播放软件通过rtsp协议对视频流进行解析和渲染后进行播放。本发明产生的技术效果是：1、巡道工不用配置专门的对讲机设备，而是使用任何一台安装有Android 5.0以上系统的设备，巡道工人使用起来更加灵活方便，节约成本。2、云服务器通过机车台主机上报的位置，去判断是否满足预警条件并主动向对应的安全防护移动终端发送预警信令，无需人工参与，在接收预警和报警的时候，具有声音，震动以及画面闪烁等提示，在提示中可以根据声音频率，震动频域，语音提示去判断预警等级。3、手持安全防护移动终端的防护巡道安全人员在地图页面查看线路上持有安全防护移动终端的巡道人员信息、机车信息和道口摄像头视频信息，实现远程报警。附图说明图1为本发明基于4G物联网的铁路安全防护系统整体网络图；图2为本发明安全防护移动终端的电路连接框图；图3为本发明安全防护移动终端功能构成图；图4为本发明机车台主机发送预警逻辑图；图5为本发明安全移动防护终端发送报警逻辑图。具体实施方式如图1所示，一种基于4G物联网的铁路安全防护系统，包括机车台主机、安全防护移动终端、道口摄像头和云服务器。机车台主机与云服务器建立通信连接以后，机车台主机每隔10秒通过http协议向云服务器发送机车台主机的经度、纬度、线路名、机车号、车次号、速度、距离、公里标和时间信息。云服务器通过websocket向机车台主机发送报警信令，报警信令内容包括：报警类型、报警时间、报警位置、设备号。多台安全防护移动终端和云服务器建立通信连接以后，安全防护移动终端通过websocket协议接收云服务器发送的预警信令、通过http协议向云服务器发送位置信息和报警信令、通过rtsp协议向云服务器访问道口摄像头数据链接地址的数据流信息。多个道口摄像头和云服务器建立通信连接以后，多个道口摄像头通过http向云服务器上报当前道口摄像头数据的最新链接地址，多个道口摄像头通过rtsp向云服务器发送道口摄像头数据链接地址的数据流信息。因此机车台主机实现了接收安全防护移动终端发送的报警信令，安全防护移动终端实现了接收云服务器发送的预警信令和其他安全防护移动终端发送的报警信令以及实时查看道口摄像头的数据流信息。如图2所示，安全防护移动终端的主要硬件包括：智能预警处理器、电源模块、网络模块、收发天线、IO模块、LCD显示器、震动马达、蜂鸣器。安全防护移动终端上电开机上电以后，智能预警处理器开始工作，通过网络模块接收外部收发天线传入的信令，智能预警处理器将处理完成的数据发送到IO模块，IO模块驱动LCD屏幕显示、蜂鸣器语音报警、以及震动马达开始工作。电源模块为IO模块、智能预警处理器提供电源。如图3所示为安全防护移动终端功能构成图，安全防护移动终端上搭载Android5.0及以上的系统平台，在平台上安装App，App上包括：预警模块、报警模块，地图模块，在地图模块中显示道口摄像头、机车台主机、安全防护移动终端的详细信息。如图4所示为云服务器触发预警信令逻辑图，机车台主机和安全防护移动终端向云服务器上报位置，云服务器通过计算所有安全防护移动终端与机车台主机的距离，当距离满足提前配置的距离触发预警，云服务器向满足条件的安全防护移动终端发送预警信令。当距离不满足提前配置的距离不触发预警，将机车位置数据保存到数据库。如图5所示为安全移动防护终端发送报警逻辑图，手持安全移动防护终端的巡道工人，通过判断周围情况是否有异常，如果有异常，向云服务器发送报警信令，云服务器将报警信令发送给机车台主机和其它安全移动防护终端，如果无异常，不发送报警信令。实施例1，本方法在实际项目中的具体运用，以应用于某条基于4G网络的移动网络安全的防护系统的铁路为例。该条铁路系统上包括：机车上的机车台主机，多名手持安全移动防护终端巡道工人，一台远程云服务器，多个安装有道口摄像头的道口，具体步骤如下：第一步，建立通信连接：机车台主机、安全防护移动终端、云服务器和道口摄像头接入4G网络系统后，1、机车台主机与云服务器建立通信连接：云服务器使用Spring Boot框架开发，并集成了Spring Data JPA简化持久层的操作，内置服务器响应软件以及基于MySQL的信息数据库，云服务器开机后，开启Spring Boot 框架中的HttpServer服务器端口10951，等待机车台主机发起连接请求，机车台主机是基于CIR系统，内置向服务器发起请求的应用软件，机车台主机在开机以后，内置应用软件自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败，当连接失败时开启定时器，每隔10秒连接一次，直到连接成功，定时器关闭；机车台主机与云服务器建立通信连接以后，机车台主机每隔10秒通过http协议向云服务器发送机车台主机的经度、纬度、线路名、机车号、车次号、速度、距离、公里标和时间信息。云服务器通过websocket向机车台主机发送报警信令，报警信令内容包括：报警类型、报警时间、报警位置、设备号。2、多台安全防护移动终端与云服务器建立通信连接：安全防护移动终端是基于android9.0 64位系统的三防工业级安全防护移动终端，内置向服务器发起请求的应用软件，向云服务器发送报警信令，接收服务器发送过来的预警信令，安全防护移动终端在开机以后，内置应用app自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败，当连接失败时安全防护移动终端app开启定时器，每隔10秒连接一次，直到连接成功，定时器关闭；建立通信连接以后，安全防护移动终端通过websocket协议接收云服务器发送的预警信令、通过http协议向云服务器发送位置信息和报警信令、通过rtsp协议向云服务器访问道口摄像头数据链接地址的数据流信息。3、多个道口摄像头在开机以后，内置应用自动向云服务器地址及端口发送请求连接，当返回的code 码为1时，连接成功，当返回code码为0时，连接失败。建立通信连接以后，多个道口摄像头每隔5分钟通过http向云服务器上报当前道口摄像头数据的最新链接地址，通过rtsp向云服务器发送道口摄像头数据链接地址的数据流信息。第二步，云服务器触发预警步骤：机车台主机在与云服务器建立连接以后，机车台主机通过http协议每隔10秒向云服务器发送机车台主机的经度、纬度、线路名、机车号、车次号、速度、距离、公里标和时间信息，安全防护移动终端通过http协议每隔10秒向云服务器发送经度和纬度；云服务器利用高德地图提供的距离计算公式：float distance =AMapUtils.calculateLineDistance，通过传入的车台主机位置参数latLng1和安全防护移动终端的位置参数latLng2计算后得到车台主机和安全防护移动终端的距离distance ，如果距离小于配置的距离触发预警信令，通过websocket将预警信令发送给安全防护移动终端，当全防护移动终端收到预警信令后，解析信令，将解析后的信令内容经度、纬度、线路名、机车号、车次号、速度、距离、公里标和时间信息呈现在安全防护移动终端的LCD显示器上，并提供震动、”您有新的预警“文字闪烁、语音预警提示”您有新的预警“。手持安全防护移动终端的巡道工人收到预警信令以后及时撤离危险区域。第三步，安全防护移动终端报警具体步骤：当手持安全防护移动终端的巡道工人在巡道时候发现异常情况，点击手持安全防护移动终端上的报警按钮，安全防护移动终端通过http协议给云服务器发送报警信令，报警信令内容包括：报警类型、报警时间、报警位置、设备号，报警类型包括，线路报警、施工报警、道口报警、防护报警，默认选择的报警是线路报警。云服务器通过websocket协议将收到的报警信令转发给机车台主机和其他安全防护移动终端；接收到报警信令的机车台主机和其他安全防护移动以文字、语音、震动的方式提示机车台司机和当手持安全防护移动终端的巡道工人及时做出安全措施，文字提示为”您有新的报警”，语音提示为”您有新的报警”，音量大小跟随手机系统音量的大小。第四步，获取道口摄像头数据链接地址：建立通信连接以后，道口摄像头为了数据的安全，每隔5分钟向云服务器发送最新的道口摄像头数据链接地址，云服务器将收到的道口摄像头数据的链接地址保存在数据库；安全防护移动终端向云服务器发送获取道口摄像头数据链接地址的请求信令，云服务器将数据库中最新的道口摄像头数据的链接地址转发给发起请求的安全防护移动终端，安全防护移动终端通过内置的视频软件，打开道口摄像头数据的链接地址，查看道口的实时情况。第五步，实时查看线路当前情况：基于第二步、第三步、第四步，安全防护移动终端的地图页面以marker的形式展示其他安全防护移动终端、机车台主机和道口摄像头所在的位置，marker上的信息包括：机车号、线路名、距离、道口摄像头数据的链接地址，marker 通过不同的图标，分别代表道口摄像头、安全防护移动终端和机车台主机，以列表的形式展示机车台发送的预警信令，其他安全防护移动终端发送的报警信令和视频数据流的链接地址；预警信令内容包括，机车台主机的经度、纬度、线路名、机车号、车次号、速度、距离、公里标和时间信息；报警信令内容包括：报警类型、报警时间、报警位置、设备号。安全防护移动终端内置道口视频软件，软件包含：播放、暂停、道口信息，截图保存当前状态四个功能子项，道口信息包括道口摄像头位置信息，所属线路名、道口摄像头数据的链接地址。点击播放按钮，视频软件通过rtsp协议对视频流进行解析和渲染后进行播放，查看道口实时情况；通过实时查看线路当前情况，对于前方道口情况进行掌握，及时提示机车台主机司机前方道口存在的潜在危险以及对道口行人人身安全进行提前预判，防止列车与道口行人、车辆、物体发生相撞事故。
