标题title
语音消息播放方法及电子设备
摘要abst
本申请提供了一种语音消息播放方法及电子设备，该方法包括：电子设备在播放语音消息时，基于接近光传感器确定的接近光状态以及状态数据确定的接近光状态，控制电子设备播放语音消息的模式。从而使得在接近光传感器检测异常的情况下，可基于状态数据计算得到的接近光状态对异常接近光状态进行校正，使得电子设备可基于正确的接近光状态，控制电子设备播放语音消息的模式。
权利要求书clms
1.一种语音消息播放方法，其特征在于，应用于电子设备，所述方法包括：响应于接收到的对语音消息的点击操作，调用扬声器播放所述语音消息，并且，所述电子设备的显示屏处于亮屏状态；基于接近光传感器的检测结果，获取第一接近光状态；基于第一状态数据，获取第二接近光状态；其中，状态数据包括姿态数据和运动数据，所述姿态数据用于描述所述电子设备当前的姿态，所述运动数据用于描述所述电子设备当前的运动状态；检测到所述第一接近光状态与所述第二接近光状态均指示为远离状态，继续调用所述扬声器播放所述语音消息，并且，所述电子设备显示屏处于亮屏状态；在用户抬手将所述电子设备置于耳边接听所述语音消息的情况下，基于所述接近光传感器的检测结果，获取第三接近光状态；基于第二状态数据，获取第四接近光状态；检测到所述第三接近光状态指示为远离状态，且所述第四接近光状态指示为接近状态，确定所述第三接近光状态为异常状态，以及，基于所述第四接近光状态，确定所述电子设备处于耳边接听场景，调用听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。2.根据权利要求1所述的方法，其特征在于，所述方法还包括：在用户将所述电子设备持续置于耳边接听所述语音消息的过程中，基于所述接近光传感器的检测结果，获取第五接近光状态；基于第三状态数据，获取第六接近光状态；检测到所述第五接近光状态指示为远离状态，且所述第六接近光状态指示为接近状态，确定所述第五接近光状态为异常状态，以及，基于所述第六接近光状态，确定所述电子设备仍处于耳边接听场景，继续调用所述听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。3.根据权利要求1所述的方法，其特征在于，所述检测到所述第一接近光状态与所述第二接近光状态均指示为远离状态，继续调用所述扬声器播放所述语音消息，并且，所述电子设备显示屏处于亮屏状态，包括：检测所述听筒是否为打开状态；检测到所述听筒为关闭状态，判断所述第一接近光状态是否指示为远离状态；判定所述第一接近光状态指示为远离状态，判断所述第二接近光状态是否指示为接近状态；判定所述第二接近光状态指示为远离状态，确定所述电子设备当前的目标接近光状态为远离状态；基于所述目标接近光状态，继续调用所述扬声器播放所述语音消息，并且，所述电子设备显示屏处于亮屏状态。4.根据权利要求1所述的方法，其特征在于，所述检测到所述第三接近光状态指示为远离状态，且所述第四接近光状态指示为接近状态，确定所述第三接近光状态为异常状态，包括：检测所述听筒是否为打开状态；检测到所述听筒为关闭状态，判断所述第三接近光状态是否指示为远离状态；判定所述第三接近光状态指示为远离状态，判断所述第四接近光状态是否指示为接近状态；判定所述第四接近光状态指示为接近状态，基于所述第三接近光状态与所述第四接近光状态，确定所述第三接近光状态为异常状态；确定所述第四接近光状态为目标接近光状态。5.根据权利要求4所述的方法，其特征在于，所述基于所述第四接近光状态，确定所述电子设备处于耳边接听场景，调用听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态，包括：基于所述目标接近光状态，确定所述电子设备处于耳边接听场景，调用听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。6.根据权利要求2所述的方法，其特征在于，所述检测到所述第五接近光状态指示为远离状态，且所述第六接近光状态指示为接近状态，确定所述第五接近光状态为异常状态，包括：检测所述听筒是否为打开状态；检测到所述听筒为打开状态，判断所述第六接近光状态是否指示为接近状态；判定所述第六接近光指示为接近状态，基于所述第五接近光状态与所述第六接近光状态，确定所述第五接近光状态为异常状态；确定所述第六接近光状态为目标接近光状态。7.根据权利要求6所述的方法，其特征在于，所述基于所述第六接近光状态，确定所述电子设备仍处于耳边接听场景，继续调用所述听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态，包括：基于所述目标接近光状态，确定所述电子设备处于耳边接听场景，继续调用所述听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。8.一种电子设备，其特征在于，包括：一个或多个处理器、存储器；以及一个或多个计算机程序，其中所述一个或多个计算机程序存储在所述存储器上，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：响应于接收到的对语音消息的点击操作，调用扬声器播放所述语音消息，并且，所述电子设备的显示屏处于亮屏状态；基于接近光传感器的检测结果，获取第一接近光状态；基于第一状态数据，获取第二接近光状态；其中，状态数据包括姿态数据和运动数据，所述姿态数据用于描述所述电子设备当前的姿态，所述运动数据用于描述所述电子设备当前的运动状态；检测到所述第一接近光状态与所述第二接近光状态均指示为远离状态，继续调用所述扬声器播放所述语音消息，并且，所述电子设备显示屏处于亮屏状态；在用户抬手将所述电子设备置于耳边接听所述语音消息的情况下，基于所述接近光传感器的检测结果，获取第三接近光状态；基于第二状态数据，获取第四接近光状态；检测到所述第三接近光状态指示为远离状态，且所述第四接近光状态指示为接近状态，确定所述第三接近光状态为异常状态，以及，基于所述第四接近光状态，确定所述电子设备处于耳边接听场景，调用听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。9.根据权利要求8所述的电子设备，其特征在于，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：在用户将所述电子设备持续置于耳边接听所述语音消息的过程中，基于所述接近光传感器的检测结果，获取第五接近光状态；基于第三状态数据，获取第六接近光状态；检测到所述第五接近光状态指示为远离状态，且所述第六接近光状态指示为接近状态，确定所述第五接近光状态为异常状态，以及，基于所述第六接近光状态，确定所述电子设备仍处于耳边接听场景，继续调用所述听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。10.根据权利要求8所述的电子设备，其特征在于，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：检测所述听筒是否为打开状态；检测到所述听筒为关闭状态，判断所述第一接近光状态是否指示为远离状态；判定所述第一接近光状态指示为远离状态，判断所述第二接近光状态是否指示为接近状态；判定所述第二接近光状态指示为远离状态，确定所述电子设备当前的目标接近光状态为远离状态；基于所述目标接近光状态，继续调用所述扬声器播放所述语音消息，并且，所述电子设备显示屏处于亮屏状态。11.根据权利要求8所述的电子设备，其特征在于，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：检测所述听筒是否为打开状态；检测到所述听筒为关闭状态，判断所述第三接近光状态是否指示为远离状态；判定所述第三接近光状态指示为远离状态，判断所述第四接近光状态是否指示为接近状态；判定所述第四接近光状态指示为接近状态，基于所述第三接近光状态与所述第四接近光状态，确定所述第三接近光状态为异常状态；确定所述第四接近光状态为目标接近光状态。12.根据权利要求11所述的电子设备，其特征在于，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：基于所述目标接近光状态，确定所述电子设备处于耳边接听场景，调用听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。13.根据权利要求9所述的电子设备，其特征在于，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：检测所述听筒是否为打开状态；检测到所述听筒为打开状态，判断所述第六接近光状态是否指示为接近状态；判定所述第六接近光指示为接近状态，基于所述第五接近光状态与所述第六接近光状态，确定所述第五接近光状态为异常状态；确定所述第六接近光状态为目标接近光状态。14.根据权利要求13所述的电子设备，其特征在于，当所述计算机程序被所述一个或多个处理器执行时，使得所述电子设备执行以下步骤：基于所述目标接近光状态，确定所述电子设备处于耳边接听场景，继续调用所述听筒播放所述语音消息，并且，所述电子设备的显示屏处于熄屏状态。15.一种计算机存储介质，其特征在于，包括计算机指令，当所述计算机指令在电子设备上运行时，使得所述电子设备执行如权利要求1-7任一项所述的方法。16.一种计算机程序产品，其特征在于，当所述计算机程序产品在计算机上运行时，使得所述计算机执行如权利要求1-7任一项所述的方法。17.一种芯片，其特征在于，包括一个或多个接口电路和一个或多个处理器；所述接口电路用于从电子设备的存储器接收信号，并向所述处理器发送所述信号，所述信号包括存储器中存储的计算机指令；当所述处理器执行所述计算机指令时，使得所述电子设备执行权利要求1-7任一项所述的方法。
说明书desc
技术领域本申请涉及终端设备领域，尤其涉及一种语音消息播放方法及电子设备。背景技术目前，随着终端技术发展，终端应用的功能越来越强大，例如用户可使用聊天应用进行文字交流以及语音交流。其中，语音交流包括但不限于视频通话、语音通话以及语音消息等。在用户拿起手机并在耳边接听语音消息时，聊天应用获取到接近光传感器检测到接近状态，启动防误触流程，自动从扬声器播放方式切换到听筒播放方式，且熄屏，以防止误触。相应的，当用户放下手机时，聊天应用获取到接近光传感器检测到远离状态，关闭防误触流程，自动从听筒播放方式切换到扬声器播放方式，且亮屏。但是，由于接近光传感器可能发生误报，造成用户在耳边接听语音消息时，聊天应用误关闭防误触流程，使得手机仍在用户耳边时，聊天应用已经切换到扬声器播放模式，且亮屏，影响用户使用体验。发明内容本申请提供一种语音消息播放方法及电子设备。在该方法中，电子设备可基于算法，获取接近光状态，并对接近光传感器检测到的接近光状态进行修正，以避免误报，影响用户使用体验。第一方面，本申请提供一种语音消息播放方法。该方法包括：电子设备响应于接收到的对语音消息的点击操作，调用扬声器播放语音消息，并且，电子设备的显示屏处于亮屏状态。在电子设备播放语音消息的过程中，电子设备基于接近光传感器的检测结果，获取第一接近光状态，并且，电子设备基于第一状态数据，获取第二接近光状态；其中，状态数据包括姿态数据和运动数据，姿态数据用于描述电子设备当前的姿态，运动数据用于描述电子设备当前的运动状态。电子设备检测到第一接近光状态与第二接近光状态均指示为远离状态，继续调用扬声器播放语音消息，并且，电子设备显示屏处于亮屏状态。在用户抬手将电子设备置于耳边接听语音消息的情况下，基于接近光传感器的检测结果，获取第三接近光状态。电子设备基于第二状态数据，获取第四接近光状态。在电子设备检测到第三接近光状态指示为远离状态，且第四接近光状态指示为接近状态的情况下，电子设备确定第三接近光状态为异常状态，以及，电子设备基于第四接近光状态，确定电子设备处于耳边接听场景，调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。这样，本申请中的电子设备可通过电子设备姿态以及运动状态，计算出电子设备的接近光状态，以在接近光传感器误报的情况下，对接近光传感器的检测结果进行修正，以得到正确的接近光状态。从而使得电子设备能够基于正确的接近光状态，控制电子设备在播放语音消息时的模式。并且，手势辅助算法在扬声器打开之后，持续获取状态数据，可使得手势辅助算法能够实时获取到对应的接近光状态。相应的，电子设备也可以实时调用算法计算出的接近光状态。示例性的，状态数据为ACC数据。姿态数据包括但不限于俯仰角和翻滚角。运动数据包括但不限于handupJudge参数。在一种可能的实现方式中，方法还包括：在用户将电子设备持续置于耳边接听语音消息的过程中，电子设备基于接近光传感器的检测结果，获取第五接近光状态。电子设备基于第三状态数据，获取第六接近光状态。电子设备检测到第五接近光状态指示为远离状态，且第六接近光状态指示为接近状态，确定第五接近光状态为异常状态，以及，基于第六接近光状态，确定电子设备仍处于耳边接听场景，继续调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。这样，电子设备在听筒打开之后，即可基于在听筒打开之前获取到的状态参数和当前获取到的状态参数，从而得到电子设备的准确的运动状态，以基于算法获取到准确的接近光状态。在一种可能的实现方式中，检测到第一接近光状态与第二接近光状态均指示为远离状态，继续调用扬声器播放语音消息，并且，电子设备显示屏处于亮屏状态，包括：电子设备检测听筒是否为打开状态。电子设备检测到听筒为关闭状态，判断第一接近光状态是否指示为远离状态。电子设备判定第一接近光状态指示为远离状态，判断第二接近光状态是否指示为接近状态。电子设备判定第二接近光状态指示为远离状态，确定电子设备当前的目标接近光状态为远离状态。电子设备基于目标接近光状态，继续调用扬声器播放语音消息，并且，电子设备显示屏处于亮屏状态。这样，电子设备可基于接近光传感器的结果，确定是否需要结合算法得到的接近光状态进行判定。在需要结合算法的情况下，再调用算法算得的接近光状态，以进一步确定接近光传感器所检测到的结果是否存在误报。在一种可能的实现方式中，电子设备检测到第三接近光状态指示为远离状态，且第四接近光状态指示为接近状态，确定第三接近光状态为异常状态，包括：电子设备检测听筒是否为打开状态。电子设备检测到听筒为关闭状态，判断第三接近光状态是否指示为远离状态。电子设备判定第三接近光状态指示为远离状态，判断第四接近光状态是否指示为接近状态。电子设备判定第四接近光状态指示为接近状态，基于第三接近光状态与第四接近光状态，确定第三接近光状态为异常状态。电子设备确定第四接近光状态为目标接近光状态。这样，电子设备可基于接近光传感器的结果，确定是否需要结合算法得到的接近光状态进行判定。在需要结合算法的情况下，再调用算法算得的接近光状态，以进一步确定接近光传感器所检测到的结果是否存在误报。在一种可能的实现方式中，基于第四接近光状态，确定电子设备处于耳边接听场景，调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态，包括：电子设备基于目标接近光状态，确定电子设备处于耳边接听场景，调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。这样，电子设备可基于算法与接近光传感器的结果，确定电子设备当前是否处于耳边接听状态，以获取到准确的结果，并基于最终确定的目标接近光状态，控制电子设备播放语音消息的模式。在一种可能的实现方式中，检测到第五接近光状态指示为远离状态，且第六接近光状态指示为接近状态，确定第五接近光状态为异常状态，包括：电子设备检测听筒是否为打开状态。电子设备检测到听筒为打开状态，判断第六接近光状态是否指示为接近状态。电子设备判定第六接近光指示为接近状态，基于第五接近光状态与第六接近光状态，确定第五接近光状态为异常状态。电子设备确定第六接近光状态为目标接近光状态。这样，电子设备在听筒打开之前，即可获取到状态数据，并基于状态数据，将手势锁锁定，即锁定接近光状态，使得电子设备在耳边接听的场景中，即使接近光传感器误报，而基于手势锁已经锁定接近状态，则电子设备最终获取到的接近光状态仍然是接近状态，而不会收到传感器误报的影响。在一种可能的实现方式中，电子设备基于第六接近光状态，确定电子设备仍处于耳边接听场景，继续调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态，包括：基于目标接近光状态，确定电子设备处于耳边接听场景，继续调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。这样，电子设备可基于算法得到的接近光状态，对接近光传感器的异常上报进行校正，并基于正确的接近光状态，控制电子设备播放语音消息的模式。第二方面，本申请提供一种电子设备，包括：一个或多个处理器、存储器；以及一个或多个计算机程序，其中一个或多个计算机程序存储在存储器上，当计算机程序被一个或多个处理器执行时，使得电子设备执行以下步骤：响应于接收到的对语音消息的点击操作，调用扬声器播放语音消息，并且，电子设备的显示屏处于亮屏状态；基于接近光传感器的检测结果，获取第一接近光状态；基于第一状态数据，获取第二接近光状态；其中，状态数据包括姿态数据和运动数据，姿态数据用于描述电子设备当前的姿态，运动数据用于描述电子设备当前的运动状态；检测到第一接近光状态与第二接近光状态均指示为远离状态，继续调用扬声器播放语音消息，并且，电子设备显示屏处于亮屏状态；在用户抬手将电子设备置于耳边接听语音消息的情况下，基于接近光传感器的检测结果，获取第三接近光状态；基于第二状态数据，获取第四接近光状态；检测到第三接近光状态指示为远离状态，且第四接近光状态指示为接近状态，确定第三接近光状态为异常状态，以及，基于第四接近光状态，确定电子设备处于耳边接听场景，调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。在一种可能的实现方式中，当计算机程序被一个或多个处理器执行时，使得电子设备执行以下步骤：在用户将电子设备持续置于耳边接听语音消息的过程中，基于接近光传感器的检测结果，获取第五接近光状态；基于第三状态数据，获取第六接近光状态；检测到第五接近光状态指示为远离状态，且第六接近光状态指示为接近状态，确定第五接近光状态为异常状态，以及，基于第六接近光状态，确定电子设备仍处于耳边接听场景，继续调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。在一种可能的实现方式中，当计算机程序被一个或多个处理器执行时，使得电子设备执行以下步骤：检测听筒是否为打开状态；检测到听筒为关闭状态，判断第一接近光状态是否指示为远离状态；判定第一接近光状态指示为远离状态，判断第二接近光状态是否指示为接近状态；判定第二接近光状态指示为远离状态，确定电子设备当前的目标接近光状态为远离状态；基于目标接近光状态，继续调用扬声器播放语音消息，并且，电子设备显示屏处于亮屏状态。在一种可能的实现方式中，当计算机程序被一个或多个处理器执行时，使得电子设备执行以下步骤：检测听筒是否为打开状态；检测到听筒为关闭状态，判断第三接近光状态是否指示为远离状态；判定第三接近光状态指示为远离状态，判断第四接近光状态是否指示为接近状态；判定第四接近光状态指示为接近状态，基于第三接近光状态与第四接近光状态，确定第三接近光状态为异常状态；确定第四接近光状态为目标接近光状态。在一种可能的实现方式中，当计算机程序被一个或多个处理器执行时，使得电子设备执行以下步骤：基于目标接近光状态，确定电子设备处于耳边接听场景，调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。在一种可能的实现方式中，当计算机程序被一个或多个处理器执行时，使得电子设备执行以下步骤：检测听筒是否为打开状态；检测到听筒为打开状态，判断第六接近光状态是否指示为接近状态；判定第六接近光指示为接近状态，基于第五接近光状态与第六接近光状态，确定第五接近光状态为异常状态；确定第六接近光状态为目标接近光状态。在一种可能的实现方式中，当计算机程序被一个或多个处理器执行时，使得电子设备执行以下步骤：基于目标接近光状态，确定电子设备处于耳边接听场景，继续调用听筒播放语音消息，并且，电子设备的显示屏处于熄屏状态。第二方面以及第二方面的任意一种实现方式分别与第一方面以及第一方面的任意一种实现方式相对应。第二方面以及第二方面的任意一种实现方式所对应的技术效果可参见上述第一方面以及第一方面的任意一种实现方式所对应的技术效果，此处不再赘述。第三方面，本申请提供了一种计算机可读介质，用于存储计算机程序，该计算机程序包括用于执行第一方面或第一方面的任意可能的实现方式中的方法的指令。第四方面，本申请提供了一种计算机程序，该计算机程序包括用于执行第一方面或第一方面的任意可能的实现方式中的方法的指令。第五方面，本申请提供了一种芯片，该芯片包括处理电路、收发管脚。其中，该收发管脚、和该处理电路通过内部连接通路互相通信，该处理电路执行第一方面或第一方面的任一种可能的实现方式中的方法，以控制接收管脚接收信号，以控制发送管脚发送信号。附图说明图1为示例性示出的电子设备的硬件结构示意图；图2为示例性示出的电子设备的软件结构示意图；图3为示例性示出的用户界面示意图；图4a为示例性示出的应用场景示意图；图4b为示例性示出的应用场景示意图；图4c~图4d为示例性示出的模块交互示意图；图5为示例性示出的语音消息播放方法的流程示意图；图6为示例性示出的语音消息播放方法的流程示意图；图7为示例性示出的手势辅助算法的状态值计算流程示意图；图8为示例性示出的语音消息播放方法的流程示意图；图9a~图9b为示例性示出的语音消息播放方法的流程示意图；图10为示例性示出的手势锁计算流程示意图；图11为示例性示出的语音播放方法的流程示意图；图12为示例性示出的语音消息播放流程示意图；图13为示例性示出的装置的结构示意图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。本文中术语“和/或”，仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。本申请实施例的说明书和权利要求书中的术语“第一”和“第二”等是用于区别不同的对象，而不是用于描述对象的特定顺序。例如，第一目标对象和第二目标对象等是用于区别不同的目标对象，而不是用于描述目标对象的特定顺序。在本申请实施例中，“示例性的”或者“例如”等词用于表示作例子、例证或说明。本申请实施例中被描述为“示例性的”或者“例如”的任何实施例或设计方案不应被解释为比其它实施例或设计方案更优选或更具优势。确切而言，使用“示例性的”或者“例如”等词旨在以具体方式呈现相关概念。在本申请实施例的描述中，除非另有说明，“多个”的含义是指两个或两个以上。例如，多个处理单元是指两个或两个以上的处理单元；多个系统是指两个或两个以上的系统。图1示出了电子设备100的结构示意图。应该理解的是，图1所示电子设备100仅是电子设备的一个范例，并且电子设备100可以具有比图中所示的更多的或者更少的部件，可以组合两个或多个的部件，或者可以具有不同的部件配置。图1中所示出的各种部件可以在包括一个或多个信号处理和/或专用集成电路在内的硬件、软件、或硬件和软件的组合中实现。电子设备100可以包括：处理器110，外部存储器接口120，内部存储器121，通用串行总线接口130，充电管理模块140，电源管理模块141，电池142，天线1，天线2，移动通信模块150，无线通信模块160，音频模块170，扬声器170A，受话器170B，麦克风170C，耳机接口170D，传感器模块180，按键190，马达191，指示器192，摄像头193，显示屏194，以及用户标识模块卡接口195等。其中传感器模块180可以包括压力传感器180A，陀螺仪传感器180B，气压传感器180C，磁传感器180D，加速度传感器180E，距离传感器180F，接近光传感器180G，指纹传感器180H，温度传感器180J，触摸传感器180K，环境光传感器180L，骨传导传感器180M等。处理器110可以包括一个或多个处理单元，例如：处理器110可以包括应用处理器，调制解调处理器，图形处理器，图像信号处理器，控制器，存储器，视频编解码器，数字信号处理器，基带处理器，和/或神经网络处理器等。其中，不同的处理单元可以是独立的器件，也可以集成在一个或多个处理器中。其中，控制器可以是电子设备100的神经中枢和指挥中心。控制器可以根据指令操作码和时序信号，产生操作控制信号，完成取指令和执行指令的控制。处理器110中还可以设置存储器，用于存储指令和数据。在一些实施例中，处理器110中的存储器为高速缓冲存储器。该存储器可以保存处理器110刚用过或循环使用的指令或数据。如果处理器110需要再次使用该指令或数据，可从所述存储器中直接调用。避免了重复存取，减少了处理器110的等待时间，因而提高了系统的效率。在一些实施例中，处理器110可以包括一个或多个接口。接口可以包括集成电路接口，集成电路内置音频接口，脉冲编码调制接口，通用异步收发传输器接口，移动产业处理器接口，通用输入输出接口，用户标识模块接口，和/或通用串行总线接口等。充电管理模块140用于从充电器接收充电输入。其中，充电器可以是无线充电器，也可以是有线充电器。在一些有线充电的实施例中，充电管理模块140可以通过USB接口130接收有线充电器的充电输入。在一些无线充电的实施例中，充电管理模块140可以通过电子设备100的无线充电线圈接收无线充电输入。充电管理模块140为电池142充电的同时，还可以通过电源管理模块141为电子设备供电。电源管理模块141用于连接电池142，充电管理模块140与处理器110。电源管理模块141接收电池142和/或充电管理模块140的输入，为处理器110，内部存储器121，外部存储器，显示屏194，摄像头193，和无线通信模块160等供电。电源管理模块141还可以用于监测电池容量，电池循环次数，电池健康状态等参数。在其他一些实施例中，电源管理模块141也可以设置于处理器110中。在另一些实施例中，电源管理模块141和充电管理模块140也可以设置于同一个器件中。电子设备100的无线通信功能可以通过天线1，天线2，移动通信模块150，无线通信模块160，调制解调处理器以及基带处理器等实现。天线1和天线2用于发射和接收电磁波信号。电子设备100中的每个天线可用于覆盖单个或多个通信频带。不同的天线还可以复用，以提高天线的利用率。例如：可以将天线1复用为无线局域网的分集天线。在另外一些实施例中，天线可以和调谐开关结合使用。移动通信模块150可以提供应用在电子设备100上的包括2G/3G/4G/5G等无线通信的解决方案。移动通信模块150可以包括至少一个滤波器，开关，功率放大器，低噪声放大器等。移动通信模块150可以由天线1接收电磁波，并对接收的电磁波进行滤波，放大等处理，传送至调制解调处理器进行解调。移动通信模块150还可以对经调制解调处理器调制后的信号放大，经天线1转为电磁波辐射出去。在一些实施例中，移动通信模块150的至少部分功能模块可以被设置于处理器110中。在一些实施例中，移动通信模块150的至少部分功能模块可以与处理器110的至少部分模块被设置在同一个器件中。调制解调处理器可以包括调制器和解调器。其中，调制器用于将待发送的低频基带信号调制成中高频信号。解调器用于将接收的电磁波信号解调为低频基带信号。随后解调器将解调得到的低频基带信号传送至基带处理器处理。低频基带信号经基带处理器处理后，被传递给应用处理器。应用处理器通过音频设备输出声音信号，或通过显示屏194显示图像或视频。在一些实施例中，调制解调处理器可以是独立的器件。在另一些实施例中，调制解调处理器可以独立于处理器110，与移动通信模块150或其他功能模块设置在同一个器件中。无线通信模块160可以提供应用在电子设备100上的包括无线局域网网络)，蓝牙，全球导航卫星系统，调频，近距离无线通信技术，红外技术等无线通信的解决方案。无线通信模块160可以是集成至少一个通信处理模块的一个或多个器件。无线通信模块160经由天线2接收电磁波，将电磁波信号调频以及滤波处理，将处理后的信号发送到处理器110。无线通信模块160还可以从处理器110接收待发送的信号，对其进行调频，放大，经天线2转为电磁波辐射出去。在一些实施例中，电子设备100的天线1和移动通信模块150耦合，天线2和无线通信模块160耦合，使得电子设备100可以通过无线通信技术与网络以及其他设备通信。所述无线通信技术可以包括全球移动通讯系统，通用分组无线服务，码分多址接入，宽带码分多址，时分码分多址，长期演进，BT，GNSS，WLAN，NFC ，FM，和/或IR技术等。所述GNSS可以包括全球卫星定位系统，全球导航卫星系统，北斗卫星导航系统，准天顶卫星系统和/或星基增强系统电子设备100通过GPU，显示屏194，以及应用处理器等实现显示功能。GPU为图像处理的微处理器，连接显示屏194和应用处理器。GPU用于执行数学和几何计算，用于图形渲染。处理器110可包括一个或多个GPU，其执行程序指令以生成或改变显示信息。显示屏194用于显示图像，视频等。显示屏194包括显示面板。显示面板可以采用液晶显示屏，有机发光二极管，有源矩阵有机发光二极体或主动矩阵有机发光二极体，柔性发光二极管，Miniled，MicroLed，Micro-oLed，量子点发光二极管等。在一些实施例中，电子设备100可以包括1个或N个显示屏194，N为大于1的正整数。电子设备100可以通过ISP，摄像头193，视频编解码器，GPU，显示屏194以及应用处理器等实现拍摄功能。ISP 用于处理摄像头193反馈的数据。例如，拍照时，打开快门，光线通过镜头被传递到摄像头感光元件上，光信号转换为电信号，摄像头感光元件将所述电信号传递给ISP处理，转化为肉眼可见的图像。ISP还可以对图像的噪点，亮度进行算法优化。ISP还可以对拍摄场景的曝光，色温等参数优化。在一些实施例中，ISP可以设置在摄像头193中。摄像头193用于捕获静态图像或视频。物体通过镜头生成光学图像投射到感光元件。感光元件可以是电荷耦合器件或互补金属氧化物半导体光电晶体管。感光元件把光信号转换成电信号，之后将电信号传递给ISP转换成数字图像信号。ISP将数字图像信号输出到DSP加工处理。DSP将数字图像信号转换成标准的RGB，YUV等格式的图像信号。在一些实施例中，电子设备100可以包括1个或N个摄像头193，N为大于1的正整数。数字信号处理器用于处理数字信号，除了可以处理数字图像信号，还可以处理其他数字信号。例如，当电子设备100在频点选择时，数字信号处理器用于对频点能量进行傅里叶变换等。视频编解码器用于对数字视频压缩或解压缩。电子设备100可以支持一种或多种视频编解码器。这样，电子设备100可以播放或录制多种编码格式的视频，例如：动态图像专家组1，MPEG2，MPEG3，MPEG4等。NPU为神经网络计算处理器，通过借鉴生物神经网络结构，例如借鉴人脑神经元之间传递模式，对输入信息快速处理，还可以不断的自学习。通过NPU可以实现电子设备100的智能认知等应用，例如：图像识别，人脸识别，语音识别，文本理解等。外部存储器接口120可以用于连接外部存储卡，例如Micro SD卡，实现扩展电子设备100的存储能力。外部存储卡通过外部存储器接口120与处理器110通信，实现数据存储功能。例如将音乐，视频等文件保存在外部存储卡中。内部存储器121可以用于存储计算机可执行程序代码，所述可执行程序代码包括指令。处理器110通过运行存储在内部存储器121的指令，从而执行电子设备100的各种功能应用以及数据处理。内部存储器121可以包括存储程序区和存储数据区。其中，存储程序区可存储操作系统，至少一个功能所需的应用程序等。存储数据区可存储电子设备100使用过程中所创建的数据等。此外，内部存储器121可以包括高速随机存取存储器，还可以包括非易失性存储器，例如至少一个磁盘存储器件，闪存器件，通用闪存存储器等。电子设备100可以通过音频模块170，扬声器170A，受话器170B，麦克风170C，耳机接口170D，以及应用处理器等实现音频功能。例如音乐播放，录音等。音频模块170用于将数字音频信息转换成模拟音频信号输出，也用于将模拟音频输入转换为数字音频信号。音频模块170还可以用于对音频信号编码和解码。在一些实施例中，音频模块170可以设置于处理器110中，或将音频模块170的部分功能模块设置于处理器110中。扬声器170A，也称“喇叭”，用于将音频电信号转换为声音信号。电子设备100可以通过扬声器170A收听音乐，或收听免提通话。受话器170B，也称“听筒”，用于将音频电信号转换成声音信号。当电子设备100接听电话或语音信息时，可以通过将受话器170B靠近人耳接听语音。麦克风170C，也称“话筒”，“传声器”，用于将声音信号转换为电信号。当拨打电话或发送语音信息时，用户可以通过人嘴靠近麦克风170C发声，将声音信号输入到麦克风170C。电子设备100可以设置至少一个麦克风170C。在另一些实施例中，电子设备100可以设置两个麦克风170C，除了采集声音信号，还可以实现降噪功能。在另一些实施例中，电子设备100还可以设置三个，四个或更多麦克风170C，实现采集声音信号，降噪，还可以识别声音来源，实现定向录音功能等。耳机接口170D用于连接有线耳机。耳机接口170D可以是USB接口130，也可以是3.5mm的开放移动电子设备平台标准接口，美国蜂窝电信工业协会标准接口。压力传感器180A用于感受压力信号，可以将压力信号转换成电信号。在一些实施例中，压力传感器180A可以设置于显示屏194。压力传感器180A的种类很多，如电阻式压力传感器，电感式压力传感器，电容式压力传感器等。电容式压力传感器可以是包括至少两个具有导电材料的平行板。当有力作用于压力传感器180A，电极之间的电容改变。电子设备100根据电容的变化确定压力的强度。当有触摸操作作用于显示屏194，电子设备100根据压力传感器180A检测所述触摸操作强度。电子设备100也可以根据压力传感器180A的检测信号计算触摸的位置。在一些实施例中，作用于相同触摸位置，但不同触摸操作强度的触摸操作，可以对应不同的操作指令。例如：当有触摸操作强度小于第一压力阈值的触摸操作作用于短消息应用图标时，执行查看短消息的指令。当有触摸操作强度大于或等于第一压力阈值的触摸操作作用于短消息应用图标时，执行新建短消息的指令。陀螺仪传感器180B可以用于确定电子设备100的运动姿态。在一些实施例中，可以通过陀螺仪传感器180B确定电子设备100围绕三个轴的角速度。陀螺仪传感器180B可以用于拍摄防抖。示例性的，当按下快门，陀螺仪传感器180B检测电子设备100抖动的角度，根据角度计算出镜头模组需要补偿的距离，让镜头通过反向运动抵消电子设备100的抖动，实现防抖。陀螺仪传感器180B还可以用于导航，体感游戏场景。气压传感器180C用于测量气压。在一些实施例中，电子设备100通过气压传感器180C测得的气压值计算海拔高度，辅助定位和导航。磁传感器180D包括霍尔传感器。电子设备100可以利用磁传感器180D检测翻盖皮套的开合。在一些实施例中，当电子设备100是翻盖机时，电子设备100可以根据磁传感器180D检测翻盖的开合。进而根据检测到的皮套的开合状态或翻盖的开合状态，设置翻盖自动解锁等特性。加速度传感器180E可检测电子设备100在各个方向上加速度的大小。当电子设备100静止时可检测出重力的大小及方向。还可以用于识别电子设备姿态，应用于横竖屏切换，计步器等应用。距离传感器180F，用于测量距离。电子设备100可以通过红外或激光测量距离。在一些实施例中，拍摄场景，电子设备100可以利用距离传感器180F测距以实现快速对焦。接近光传感器180G可以包括例如发光二极管和光检测器，例如光电二极管。发光二极管可以是红外发光二极管。电子设备100通过发光二极管向外发射红外光。电子设备100使用光电二极管检测来自附近物体的红外反射光。当检测到充分的反射光时，可以确定电子设备100附近有物体。当检测到不充分的反射光时，电子设备100可以确定电子设备100附近没有物体。电子设备100可以利用接近光传感器180G检测用户手持电子设备100贴近耳朵通话，以便自动熄灭屏幕达到省电的目的。接近光传感器180G也可用于皮套模式，口袋模式自动解锁与锁屏。环境光传感器180L用于感知环境光亮度。电子设备100可以根据感知的环境光亮度自适应调节显示屏194亮度。环境光传感器180L也可用于拍照时自动调节白平衡。环境光传感器180L还可以与接近光传感器180G配合，检测电子设备100是否在口袋里，以防误触。指纹传感器180H用于采集指纹。电子设备100可以利用采集的指纹特性实现指纹解锁，访问应用锁，指纹拍照，指纹接听来电等。温度传感器180J用于检测温度。在一些实施例中，电子设备100利用温度传感器180J检测的温度，执行温度处理策略。例如，当温度传感器180J上报的温度超过阈值，电子设备100执行降低位于温度传感器180J附近的处理器的性能，以便降低功耗实施热保护。在另一些实施例中，当温度低于另一阈值时，电子设备100对电池142加热，以避免低温导致电子设备100异常关机。在其他一些实施例中，当温度低于又一阈值时，电子设备100对电池142的输出电压执行升压，以避免低温导致的异常关机。触摸传感器180K，也称“触控面板”。触摸传感器180K可以设置于显示屏194，由触摸传感器180K与显示屏194组成触摸屏，也称“触控屏”。触摸传感器180K用于检测作用于其上或附近的触摸操作。触摸传感器可以将检测到的触摸操作传递给应用处理器，以确定触摸事件类型。可以通过显示屏194提供与触摸操作相关的视觉输出。在另一些实施例中，触摸传感器180K也可以设置于电子设备100的表面，与显示屏194所处的位置不同。骨传导传感器180M可以获取振动信号。在一些实施例中，骨传导传感器180M可以获取人体声部振动骨块的振动信号。骨传导传感器180M也可以接触人体脉搏，接收血压跳动信号。在一些实施例中，骨传导传感器180M也可以设置于耳机中，结合成骨传导耳机。音频模块170可以基于所述骨传导传感器180M获取的声部振动骨块的振动信号，解析出语音信号，实现语音功能。应用处理器可以基于所述骨传导传感器180M获取的血压跳动信号解析心率信息，实现心率检测功能。按键190包括开机键，音量键等。按键190可以是机械按键。也可以是触摸式按键。电子设备100可以接收按键输入，产生与电子设备100的用户设置以及功能控制有关的键信号输入。马达191可以产生振动提示。马达191可以用于来电振动提示，也可以用于触摸振动反馈。例如，作用于不同应用的触摸操作，可以对应不同的振动反馈效果。作用于显示屏194不同区域的触摸操作，马达191也可对应不同的振动反馈效果。不同的应用场景也可以对应不同的振动反馈效果。触摸振动反馈效果还可以支持自定义。指示器192可以是指示灯，可以用于指示充电状态，电量变化，也可以用于指示消息，未接来电，通知等。电子设备100的软件系统可以采用分层架构，事件驱动架构，微核架构，微服务架构，或云架构。本申请实施例以分层架构的Android系统为例，示例性说明电子设备100的软件结构。图2是本申请实施例的电子设备100的软件结构框图。电子设备100的分层架构将软件分成若干个层，每一层都有清晰的角色和分工。层与层之间通过软件接口通信。在一些实施例中，将Android系统分为四层，从上至下分别为应用程序层，应用程序框架层，硬件抽象层，以及内核层。应用程序层可以包括一系列应用程序包。如图2所示，应用程序包可以包括相机，图库，日历，通话，地图，导航，WLAN，蓝牙，音乐，视频，短信息，聊天等应用程序。其中，聊天应用可以为电子设备预安装的应用，也可以是第三方应用，本申请不做限定。本申请实施例中仅以聊天应用为例进行说明，在其他实施例中，本申请实施例中的方法可以应用于任意可以发送语音消息的应用，本申请不做限定。应用程序框架层为应用程序层的应用程序提供应用编程接口和编程框架。应用程序框架层包括一些预先定义的函数。如图2所示，应用程序框架层可以包括窗口管理器，内容提供器，视图系统，电话管理器，资源管理器，通知管理器，Sensorservice，Audioservice等。窗口管理器用于管理窗口程序。窗口管理器可以获取显示屏大小，判断是否有状态栏，锁定屏幕，截取屏幕等。内容提供器用来存放和获取数据，并使这些数据可以被应用程序访问。所述数据可以包括视频，图像，音频，拨打和接听的电话，浏览历史和书签，电话簿等。资源管理器为应用程序提供各种资源，比如本地化字符串，图标，图片，布局文件，视频文件等等。通知管理器使应用程序可以在状态栏中显示通知信息，可以用于传达告知类型的消息，可以短暂停留后自动消失，无需用户交互。比如通知管理器被用于告知下载完成，消息提醒等。通知管理器还可以是以图表或者滚动条文本形式出现在系统顶部状态栏的通知，例如后台运行的应用程序的通知，还可以是以对话窗口形式出现在屏幕上的通知。例如在状态栏提示文本信息，发出提示音，电子设备振动，指示灯闪烁等。Sensorservice用于提供传感器的相关服务，并为上层应用提供服务接口。Audioservice用于提供音频的相关服务，并为上层应用提供服务接口。HAL层为位于操作系统内核与硬件电路之间的接口层。HAL层包括但不限于：SensorHal、AudioHal等。其中，其中，Audio HAL用于对音频流进行处理，例如，对音频流进行降噪、定向增强等处理。SensorHal用于对传感器驱动上报的事件进行处理。内核层是硬件和软件之间的层。内核层至少包含显示驱动，Sensorevent模块，音频驱动，蓝牙驱动，Wi-Fi驱动等。其中，显示驱动用于控制显示器的显示。Sensorevent用于记录听筒或扬声器的状态。音频驱动用于控制音频器件，例如包括但不限于：听筒、扬声器等。SensorHub层包括但不限于：手势辅助模块和传感器驱动。手势辅助模块用于控制手势锁。其中，手势锁也可以理解为是接近光状态锁，用于锁定接近光状态。若手势锁为锁定状态，即为接近光状态锁定，则接近光驱动上报的接近光状态为接近状态。若手势锁未锁定，即为接近光状态未锁定，则接近光驱动依照实际检测到的接近光状态进行上报。传感器驱动用于控制传感器的状态以及接收传感器上报的传感参数。可选地，传感器驱动中可以进一步包括对应于不同传感器的传感器驱动，例如，在本申请实施例中，传感器驱动可以包括接近光驱动，以控制接近光传感器，并接收接近光传感器上传的传感参数。可选地，传感器驱动还可以包括加速度传感器等，本申请不做限定。可以理解的是，图2示出的软件结构中的层以及各层中包含的部件，并不构成对电子设备100的具体限定。在本申请另一些实施例中，电子设备100可以包括比图示更多或更少的层，以及每个层中可以包括更多或更少的部件，本申请不做限定。图3为示例性示出的用户界面示意图，请参照图3，显示界面300中包括聊天应用界面310。其中聊天应用界面中包括但不限于聊天框和输入框等。其中，聊天框用于显示接收和发送的聊天消息。在本申请实施例中，聊天消息包括但不限于：语音聊天消息311和文字聊天消息等。如图3所示，用户可点击语音消息311，以指示手机播放语音消息。需要说明的是，本申请实施例中仅以电子设备为手机为例进行说明，在其他实施例中，电子设备还可以是可穿戴设备、平板等，本申请不做限定。示例性的，如图4a所示的场景示意图，在本申请实施例中，用户在点击语音消息311时，手机通常是处于远离状态。在本申请实施例中，远离状态可以理解为是非耳边接听状态。在图4a所示的场景中，用户若需要点击语音消息311，其姿势通常是单手持手机，且用户可观测到手机的显示界面，以点击语音消息311。在本申请实施例中，用户点击语音消息311之后，手机响应于接收到的用户操作，通过扬声器播放语音消息311。也可以理解为，在远离状态下，手机通过扬声器播放语音消息311中的音频内容，并且，显示界面300处于亮屏状态，即显示如图3所示的界面。在本申请实施例中，与远离状态对应的为接近状态，也可以理解为是耳边接听状态。如图4b所示为耳边接听的场景示意图，在图4b中，用户可从图4a所示的手持手机的远离状态，向用户的耳侧移动，使得手机的听筒贴近用户耳侧，即为接近状态。在该场景中，手机检测到当前处于接近状态，则可启动防误触流程，即通过听筒播放语音消息，并熄屏。在本申请实施例中，手机熄屏后，触摸事件被锁定，即触摸传感器不再检测触摸事件，以防止误触。结合图4a和图4b所示的场景，图4c~图4d为示例性示出的模块交互示意图。请参照图4c，在接听语音消息时，聊天应用会注册监听接近光事件。具体的，聊天应用可向Sensorservice发送注册监听消息。Sersorservice接收到注册监听消息，向SersorHal发送activate信息。SersorHal响应于接收到的activate消息，指示传感器驱动触发接近光传感器。接近光传感器检测接近光，具体检测方式可参照已有技术实施例，本申请不做限定。在本申请实施例中，接近光传感器可以持续向接近光驱动上报检测到的传感器参数，接近光驱动可基于接收到的传感器参数确定对应的接近光事件，本申请不做限定。其中，接近光事件包括但不限于：接近事件和远离事件。可选地，传感器驱动可以在确定发生接近光事件切换的时候，向接近光驱动上报相关事件。可选地，接近光传感器也可以基于检测到的参数，向传感器驱动上报接近光事件。其中，接近光事件包括但不限于：接近事件和远离事件。可选地，接近光传感器可以仅在发生切换事件的时候，向接近光驱动上报相关事件。示例性的，传感器驱动确定发生接近光事件后，向SensorHal上报接近光事件。SensorHal响应于接收到的接近光事件，向Sensorservice发送接近光事件。Sensorsevice将接近光事件发送给聊天应用。在本申请实施例中，若用户拿起手机接听，则聊天应用接收到接近光驱动通过其它模块上报的接近事件，也可以理解为是接近光驱动上报接近状态。聊天应用响应于上报的接近状态启动防误触流程。如图4d所示，示例性的，聊天应用向PoserManager模块发送指示消息，用于指示启动灭屏流程。PoserManager模块向硬件合成器发送灭屏指令。HWC将灭屏指令发送给显示驱动。显示驱动响应于接收到的灭屏指令，控制显示屏熄屏。示例性的，聊天应用同时向Audioservice发送听筒播放指令，用于指示调用听筒播放当前语音消息。Audioservice向AudioHal发送听筒播放指令，AudioHal向音频驱动发送听筒播放指令。音频驱动响应于接收到的指令，调用听筒播放当前音频数据，即语音消息中的语音内容。在图4b和图4c所示的流程中，聊天应用是否启动防误触流程均是依赖于接近光传感器的检测结果。在一些实施例中，如果接近光传感器检测错误，例如将接近状态检测为远离状态。例如用户的头发可能会遮挡住接近光传感器的检测信号，用户的头发可能吸收接近光传感器的检测信号，使得接近光传感器未能接收到反射回的检测信号。相应的，接近光传感器的检测结果将指示当前接近光状态为远离状态。其中，如上文所述，检测结果可能是接近光传感器确定的，也可能是接近光驱动确定的，本申请不做限定。在该异常场景中，由于接近光传感器误报，聊天应用将关闭防误触流程。具体的，仍参照图4c，聊天应用响应于接收到的接近状态，关闭防误触流程。聊天应用向向PoserManager模块发送指示消息，用于指示关闭灭屏流程。PoserManager模块向HWC发送亮屏指令。HWC将亮屏指令发送给显示驱动。显示驱动响应于接收到的亮屏指令，控制显示亮屏，例如显示图3中的显示界面300。示例性的，聊天应用同时向Audioservice发送扬声器播放指令，用于指示调用扬声器播放当前语音消息。Audioservice向AudioHal发送扬声器播放指令，AudioHal向音频驱动发送扬声器播放指令。音频驱动响应于接收到的指令，调用扬声器播放当前音频数据，即语音消息中的语音内容。也就是说，当用户拿起手机，在耳边接听语音消息时，由于传感器驱动误报，聊天应用关闭防误触流程，使得手机通过扬声器播放音频，影响用户体验，并且，由于在耳边时已经亮屏，则用户可能会误触。本申请实施例提供一种语音消息播放方法，可通过手势锁锁定接近光状态，以在算法检测到手机仍处于接近状态的情况下，校正接近光传感器误报的远离状态，以避免误报，提高接近光上报的准确性。图5为示例性示出的语音消息播放方法的流程示意图，请参照图5，具体包括但不限于：S501，播放语音消息。示例性的，如图3所示，聊天应用接收到语音消息，并在聊天应用界面中显示语音消息311。用户可点击语音消息311，以触发聊天应用通过扬声器播放语音消息311。在本申请实施例中，均以默认扬声器播放语音消息为例进行说明。聊天应用响应于接收到的用户操作，播放语音消息311。S502，获取接近光状态。示例性的，接近光驱动基于接近光传感器的检测结果，确定接近光状态，为区分于算法得到的接近光状态，本申请实施例中将接近光驱动从接近光传感器获取到的接近光状态称为实体接近光状态。其中，接近光状态包括远离状态或接近状态。其中，接近光传感器被遮挡，则对应为接近状态。接近光传感器未被遮挡，则对应为远离状态。S503，检测听筒是否打开。示例性的，接近光驱动获取听筒状态，以检测听筒当前是否为打开状态。一个示例中，如果听筒为打开状态，则执行S508。另一个示例中，如果听筒为关闭状态，则执行S504。S504，判断接近光状态是否为远离状态。示例性的，接近光驱动判断获取到的实体接近光状态是否为远离状态。一个示例中，如果为远离状态，则执行S505。另一个示例中，如果为接近状态，则执行S506。S505，判断状态值是否为true。在本申请实施例中，手势辅助算法在听筒或者是扬声器打开之后，实时获取手机的ACC数据，并基于ACC数据计算状态值。其中，状态值用于指示是否为接近状态。在本申请实施例中，为区分于上文所述的实体接近光状态，算法所得的接近光状态称为算法接近光状态。一个示例中，如果状态值为true，则表示手势辅助算法基于ACC数据得到算法接近光状态为接近状态。另一个示例中，如果状态值为false，则表示手势辅助算法基于ACC数据得到的算法接近光状态为远离状态。在本申请实施例中，接近光驱动读取手势辅助算法的输出的状态值。一个示例中，如果状态值为true，则执行S506。另一个示例中，如果状态值为false，则执行S507。S506，确定上报接近状态。在本申请实施例中，实体接近光状态为远离状态，而算法接近光状态为接近状态，则说明实体接近光状态存在误报，例如上文所述的接近光传感器将接近状态，误检测为远离状态。接近光驱动可基于算法接近光状态，对实体接近光状态进行校正，以上报正确的接近光状态。S507，接近光状态上报。示例性的，接近光驱动按照已确认的接近光状态，向聊天应用上报接近光状态。S508，获取手势锁状态。示例性的，手势辅助算法基于ACC数据，确定手势锁状态。在本申请实施例中，手势锁状态包括锁定状态和未锁定状态。其中，锁定状态用于锁定接近状态，也就是说，手势锁锁定的情况下，接近光驱动上报的接近光状态均为接近状态。未锁定状态下，接近光驱动向聊天应用上报的接近光状态即为实际检测到的接近光状态，即实体接近光状态，可以包括接近状态或远离状态。示例性的，接近光驱动读取手势辅助算法输出的手势锁状态。S509，判断手势锁是否为锁定状态。一个示例中，如果手势锁状态为锁定状态，则执行S506。另一个示例中，如果手势锁状态为非锁定状态，则执行S510。S510，确定上报当前接近光状态。示例性的，如上文所述，未锁定状态下，接近光驱动向聊天应用上报的接近光状态即为实际检测到的接近光状态，即实体接近光状态，可以包括接近状态或远离状态。下面以具体实施例对图5所示的流程进行详细说明。图6为示例性示出的语音消息播放方法的流程示意图，请参照图6，具体包括但不限于如下步骤：S601，应用播放语音消息。示例性的，如图3所示，聊天应用接收到语音消息，并在聊天应用界面中显示语音消息311。用户可点击语音消息311，以触发聊天应用通过扬声器播放语音消息311。在本申请实施例中，均以默认扬声器播放语音消息为例进行说明。示例性的，聊天应用响应于接收到的用户点击语音消息311的操作，播放语音消息。S602a，应用向AudioHal发送打开扬声器指令。示例性的，聊天应用确定需要播放语音消息，如图4c所示，聊天应用向Audioservice发送扬声器播放指令，用于指示调用扬声器播放当前语音消息。Audioservice向AudioHal发送扬声器播放指令，AudioHal向音频驱动发送扬声器播放指令。音频驱动响应于接收到的指令，调用扬声器播放当前音频数据，即语音消息中的语音内容。其中，显示屏处于亮屏状态。S602b，AudioHal向Sensorevent发送写入扬声器打开状态指令。示例性的，AudioHal指示扬声器打开之后，可确认扬声器当前为打开状态。AudioHal向Sensorevent发送写入扬声器打开状态指令，以指示Sensorevent记录扬声器当前为打开状态。S602c，Sensorevnet记录扬声器打开状态。示例性的，Sensorevent响应于接收到的写入扬声器打开状态指令，记录扬声器当前为打开状态。例如，Sensorevent可设置有对应于扬声器状态的标记位，其中“1”表示打开，“0”表示关闭。Sensorevent接收到扬声器打开指令之前，扬声器状态的标记位为“0”，即为关闭状态。Sensorevent响应于接收到的写入扬声器打开状态指令，将标记位切换为“1”，以指示扬声器打开。S602，SenSorHal读取扬声器打开状态。示例性的，SensorHal实时读取Sensorevent中的数据，以获取听筒与扬声器的状态。在本实例中，Sensorevent记录扬声器打开状态之后，SensorHal可监测到Sensorevnet中记录的扬声器状态切换，即从关闭状态切换为打开状态。S603，SensorHal向手势辅助算法发送指示信息。示例性的，SenSorHal检测到扬声器状态从关闭切换到打开之后，向手势辅助算法发送指示信息，指示信息中包括扬声器打开状态信息，用于指示扬声器打开。需要说明的是，在本申请实施例中，SensorHal在监测到扬声器和/或听筒的状态切换的情况下，触发指示信息。也就是说，SensorHal当前发送指示信息之后，扬声器与听筒的状态无变化的情况下，例如听筒当前一直处于关闭状态，扬声器一直处于打开状态，SensorHal不会向手势辅助算法发送指示信息。S604，手势辅助算法记录扬声器打开状态。示例性的，手势辅助算法响应于接收到的指示信息，确定扬声器当前为打开状态。手势辅助算法可记录扬声器状态为打开状态。可选地，手势辅助算法也可以设置标志位，用于记录扬声器状态以及听筒状态。记录方式可以参照Sensorevent，此处不再赘述。S605，手势辅助算法基于ACC数据，输出状态值。示例性的，图7为示例性示出的手势辅助算法的状态值计算流程，请参照图7，具体包括但不限于：S701，获取ACC数据示例性的，手势辅助算法可向传感器驱动发送请求信息，以请求ACC数据。传感器驱动响应于手势辅助算法的请求，获取加速度传感器以及陀螺仪传感器等的检测数据。可选地，加速度传感器与陀螺仪传感器可以是一直开启的，也可以是响应于传感器驱动的调用再启动的，本申请不做限定。S702，计算pitch、roll和handupJudge数值。示例性的，pitch、roll可用于描述手机的姿态。handupJudge数值用于描述手机的动态到静态或静态到动态的过程变量。具体计算方式可参照已有技术，本申请不再赘述。S703，判断pitch、roll和handupJudge是否满足阈值，且听筒或扬声器为打开状态。示例性的，手势辅助算法基于计算出的pitch、roll和handupJudge，与各自对应的阈值范围进行比较。如果pitch、roll和handupJudge均满足阈值范围，例如，pitch和roll满足左手持手机对应的阈值范围或者是右手持手机对应的阈值范围，且，handupJudge大于0，则进一步判断听筒或扬声器是否为打开状态。如上文所述，手势辅助算法可记录有扬声器和/或听筒的状态，手势辅助算法可基于记录的状态，确定听筒或扬声器是否打开。如果上述条件均满足，则执行S704。如果任意条件不满足，则状态值输出false。S704，判断上一次接近光上报状态是否为接近状态。示例性的，手势辅助算法可读取接近光驱动上一次上报的接近状态，是指接近光驱动实际向聊天应用上报的接近光状态。一个示例中，如果接近光上报状态为接近状态，状态值输出为true。另一个示例中，如果接近光上报状态为远离状态，状态值输出为false。仍参照图6，在该示例中，用户当前手持手机，即手机处于远离状态。相应的，手势辅助算法基于ACC数据，获取到的pitch、roll和handupJudge均不满足阈值，则状态值输出为false，用于指示算法接近光状态为远离状态。S606a，应用向SensorHal注册监听接近光事件。示例性的，应用执行S601a的同时，聊天应用向Sensorservice发送注册监听接近光请求。Sensorservice响应于接收到的注册监听接近光请求，向SensorHal发送activate消息。S606b，SensorHal向接近光驱动发送触发接近光传感器指令。示例性的，SensorHal响应于接收到的activate消息，向接近光驱动发送触发接近光传感器指令，用于指示传感器驱动触发接近光传感器。S606c，接近光驱动获取接近光状态。示例性的，如图4a所示，用户当前手持手机，即接近光驱动基于接近光传感器检测到的参数，确定手机处于远离状态。S607，接近光驱动读取听筒状态。示例性的，如上文所述，手势辅助记录有听筒与扬声器的状态。手势辅助记录的听筒当前的状态为关闭状态。也就是说，手势辅助算法默认记录扬声器与听筒的状态均是关闭的。如S604，手势辅助算法记录扬声器为打开状态，其中，听筒状态仍然为关闭。接近光驱动可读取手势辅助算法记录的听筒与扬声器的状态，并获取到当前听筒状态。S608，接近光驱动判断听筒是否打开。示例性的，接近光驱动基于从手势辅助算法读取到的听筒状态，判断听筒是否为打开状态。如图5的S503，如果听筒打开，则执行S508，如果听筒关闭，则执行S504。在本实例中，接近光驱动检测到听筒为关闭状态，执行S609。S609，接近光驱动判断是否为远离状态。示例性的，接近光驱动基于S606c获取到的实体接近光状态进行判断。如图5中的S504所示，如果判断为是，则执行S505，如果判断为否，则执行S506。如图6所示，在该示例中，在S606c中接近光驱动获取到的实体接近光状态为远离状态，接近光驱动判断当前状态为远离状态，执行S610。S610，接近光驱动从手势辅助算法读取状态值。示例性的，图5中的流程走到S505，对应于图6中，接近光驱动从手势辅助算法读取状态值。需要说明的是，手势辅助算法在S603之后直至扬声器与听筒关闭之前，持续计算输出状态值。接近光驱动读取的即为手势辅助算法最新计算得到的输出状态值。可选地，手势辅助算法也可以设置计算周期，其计算周期可以与接近光驱动的读取周期相同，本申请不做限定。S611，接近光驱动判断状态值是否为true。示例性的，在图5的S505中，如果判断为是，则执行S506，如果判断为否，则执行S510。如图6所示，接近光驱动读取到状态值为false。相应的，图5中的流程将走到S510。S612a，接近光驱动确定上报远离状态。示例性的，如图5中的S510，接近光将以当前的实体接近光状态进行上报。也就是说，算法接近光状态以及实体接近光状态均是远离状态。S612b，接近光驱动向SensorHal上报远离状态。S612c，SensorHal向应用上报远离状态。示例性的，请参照图4b，接近光驱动确定向SensorHal上报远离状态。SensorHal向Sensorservice上报远离状态。Sensorsevice将远离状态发送给聊天应用。聊天应用确定当前为远离状态，则继续亮屏，并通过扬声器播放语音消息，即保持当前的语音消息播放方式。示例性的，用户在播放语音过程中，持续手持手机处于远离状态，在该过程中，各模块循环执行图5中的流程。图8为示例性示出的语音消息播放方法的流程示意图，请参照图8，具体包括但不限于如下步骤：S801，手势辅助算法基于ACC数据，输出状态值。示例性的，如上文所述，手势辅助算法持续获取ACC数据，并计算对应的状态值。在该示例中，由于手机处于远离状态，则图7中的计算结果仍然为false。S802，接近光驱动获取接近光状态。示例性的，如图4a所示，用户当前手持手机，即接近光驱动基于接近光传感器检测到的参数，确定手机处于远离状态。S803，接近光驱动读取听筒状态。示例性的，如上文所述，手势辅助记录有听筒与扬声器的状态。手势辅助记录的听筒当前的状态为关闭状态。也就是说，手势辅助算法默认记录扬声器与听筒的状态均是关闭的。手势辅助算法记录扬声器为打开状态，其中，听筒状态仍然为关闭。接近光驱动可读取手势辅助算法记录的听筒与扬声器的状态，并获取到当前听筒状态。S804，接近光驱动判断听筒是否打开。示例性的，接近光驱动基于从手势辅助算法读取到的听筒状态，判断听筒是否为打开状态。如图5的S503，如果听筒打开，则执行S508，如果听筒关闭，则执行S504。在本实例中，接近光驱动检测到听筒为关闭状态，执行S805。S805，接近光驱动判断是否为远离状态。示例性的，接近光驱动基于S802获取到的实体接近光状态进行判断。如图5中的S504所示，如果判断为是，则执行S505，如果判断为否，则执行S506。如图8所示，在该示例中，在S802中接近光驱动获取到的实体接近光状态为远离状态，接近光驱动判断当前状态为远离状态，执行S806。S806，接近光驱动从手势辅助算法读取状态值。示例性的，图5中的流程走到S505，对应于图6中，接近光驱动从手势辅助算法读取状态值。需要说明的是，手势辅助算法在扬声器打开之后直至扬声器与听筒关闭之前，持续计算输出状态值。接近光驱动读取的即为手势辅助算法最新计算得到的输出状态值。可选地，手势辅助算法也可以设置计算周期，其计算周期可以与接近光驱动的读取周期相同，本申请不做限定。S807，接近光驱动判断状态值是否为true。示例性的，在图5的S505中，如果判断为是，则执行S506，如果判断为否，则执行S510。如图8所示，接近光驱动读取到状态值为false。相应的，图5中的流程将走到S510。S808a，接近光驱动确定上报远离状态。示例性的，如图5中的S510，接近光将以当前的实体接近光状态进行上报。也就是说，算法接近光状态以及实体接近光状态均是远离状态。S808b，接近光驱动向SensorHal上报远离状态。S808c，SensorHal向应用上报远离状态。示例性的，请参照图4b，接近光驱动确定向SensorHal上报远离状态。SensorHal向Sensorservice上报远离状态。Sensorsevice将远离状态发送给聊天应用。聊天应用确定当前为远离状态，则继续亮屏，并通过扬声器播放语音消息，即保持当前的语音消息播放方式。示例性的，以用户从图4a所示的接听方式切换为图4b所示的接听方式，即，用户将手机拿到耳边接听语音消息。图9a~图9b为示例性示出的语音消息播放方法的流程示意图，请参照图9a~图9b，具体包括但不限于：S901，手势辅助算法基于ACC数据，输出状态值。示例性的，如上文所述，手势辅助算法持续获取ACC数据，并计算对应的状态值。在该示例中，由于用户拿起手机至耳边接听，手势辅助算法执行S703时，判断为是，即各参数满足阈值，且扬声器为打开状态。在该示例中，由于接近光驱动还未上报过接近状态，则S704执行时，接近光驱动判断上一次接近光驱动上报为远离状态，输出状态值仍然为false。S902，接近光驱动获取接近光状态。示例性的，用户将手机拿起到耳边，相应的，接近光驱动基于接近光传感器的检测结果，确定当前接近光状态为接近状态。S903，接近光驱动读取听筒状态。示例性的，如上文所述，手势辅助记录有听筒与扬声器的状态。手势辅助记录的听筒当前的状态为关闭状态。也就是说，手势辅助算法默认记录扬声器与听筒的状态均是关闭的。手势辅助算法记录扬声器为打开状态，其中，听筒状态仍然为关闭。接近光驱动可读取手势辅助算法记录的听筒与扬声器的状态，并获取到当前听筒状态。S904，接近光驱动判断听筒是否打开。示例性的，接近光驱动基于从手势辅助算法读取到的听筒状态，判断听筒是否为打开状态。如图5的S503，如果听筒打开，则执行S508，如果听筒关闭，则执行S504。在本实例中，接近光驱动检测到听筒为关闭状态，执行S905。S905，近光驱动判断是否为远离状态。示例性的，接近光驱动基于S902获取到的实体接近光状态进行判断。如图5中的S504所示，如果判断为是，则执行S505，如果判断为否，则执行S506。如图8所示，在该示例中，在S902中接近光驱动获取到的实体接近光状态为接近状态，接近光驱动判断当前状态为远离状态，执行S906a。即，对应于图5，流程将走到S506。S906a，接近光驱动确定上报接近状态。示例性的，接近光驱动在确定当前为远离状态的情况下，则无需再读取算法接近光状态，可直接上报接近状态。S906b，接近光驱动向SensorHal上报接近状态。S906c，SensorHal向应用上报接近状态。示例性的，请参照图4b，接近光驱动确定向SensorHal上报接近状态。SensorHal向Sensorservice上报接近状态。Sensorsevice将接近状态发送给聊天应用。S907a，应用向AudioHal发送打开听筒指令。示例性的，如图4b所示，向Audioservice发送听筒播放指令，用于指示调用听筒播放当前语音消息。Audioservice向AudioHal发送听筒播放指令，AudioHal向音频驱动发送听筒播放指令。音频驱动响应于接收到的指令，调用听筒播放当前音频数据，即语音消息中的语音内容。同时，聊天应用向PoserManager模块发送指示消息，用于指示启动灭屏流程。PoserManager模块向硬件合成器发送灭屏指令。HWC将灭屏指令发送给显示驱动。显示驱动响应于接收到的灭屏指令，控制显示屏熄屏。S907b，AudioHal向Sensorevent发送写入听筒打开状态指令。示例性的，AudioHal指示听筒打开之后，可确认听筒当前为打开状态。AudioHal向Sensorevent发送写入听筒打开状态指令，以指示Sensorevent记录听筒当前为打开状态。需要说明的是，在未接收到扬声器关闭指令之前，Sensorevent以及手势辅助算法记录的扬声器状态仍然为打开状态。S907c，Sensorevnet记录听筒打开状态。示例性的，Sensorevent响应于接收到的写入听筒打开状态指令，记录听筒当前为打开状态。例如，Sensorevent可设置有对应于听筒状态的标记位，其中“1”表示打开，“0”表示关闭。Sensorevent接收到听筒打开指令之前，扬声器状态的标记位为“0”，即为关闭状态。Sensorevent响应于接收到的写入听筒打开状态指令，将标记位切换为“1”，以指示听筒打开。S908，SensorHal读取听筒打开状态。示例性的，SensorHal实时读取Sensorevent中的数据，以获取听筒与扬声器的状态。在本实例中，Sensorevent记录听筒打开状态之后，SensorHal可监测到Sensorevnet中记录的听筒状态切换，即从关闭状态切换为打开状态。S909，SensorHal向手势辅助算法发送指示信息。示例性的，SenSorHal检测到听筒状态从关闭切换到打开之后，向手势辅助算法发送指示信息，指示信息中包括听筒打开状态信息，用于指示听筒为打开状态。需要说明的是，在本申请实施例中，SensorHal在监测到扬声器和/或听筒的状态切换的情况下，触发指示信息。也就是说，SensorHal当前发送指示信息之后，扬声器与听筒的状态无变化的情况下，例如听筒当前一直处于关闭状态，扬声器一直处于打开状态，SensorHal不会向手势辅助算法发送指示信息。S910，手势辅助算法记录听筒打开状态。示例性的，手势辅助算法响应于接收到的指示信息，确定听筒当前为打开状态。手势辅助算法可记录听筒状态为打开状态。可选地，手势辅助算法也可以设置标志位，用于记录扬声器状态以及听筒状态。记录方式可以参照Sensorevent，此处不再赘述。S911a，手势辅助算法基于ACC数据，输出状态值。仍参照图7，示例性的，如上文所述，手势辅助算法持续获取ACC数据，并计算对应的状态值。在该示例中，由于用户拿起手机至耳边接听，手势辅助算法执行S703时，判断为是，即各参数满足阈值，且扬声器为打开状态。在该示例中，由于接近光驱动已上报过接近状态，则S704执行时，接近光驱动判断上一次接近光驱动上报为接近状态，输出状态值为true，即，手势辅助算法计算出的算法接近光状态为接近状态。S911b，手势辅助算法基于ACC数据，输出手势锁状态。示例性的，手势辅助算法在扬声器打开之后，持续获取ACC数据，在上文所述的流程中，手势辅助算法可以仅计算状态值。可选地，手势辅助算法也可以同时计算状态值和手势锁，本申请不做限定。在本实例中，手势辅助算法在检测到听筒打开之后，可以开始计算手势锁状态值。可选地，手势辅助算法也可以在接近光驱动需要读取手势锁状态值再计算手势锁状态值，本申请不做限定。图10为示例性示出的手势锁计算流程示意图，请参照图10，具体包括但不限于如下步骤：S1001，获取ACC数据。S1002，计算pitch、roll和handupJudge数值。示例性的，如上文所述，手势辅助算法实时获取ACC数据，并计算对应的pitch、roll和handupJudge数值。一种可能的实现方式中，手势辅助算法可基于pitch、roll和handupJudge，输出状态值以及手机锁状态值。另一种可能的实现方式中，手势辅助算法可以在接近光驱动调用时，再基于pitch、roll和handupJudge数值的计算结果，执行相应的判断流程，以输出状态值和/或手机锁状态值。在本申请实施例中，以手势辅助算法在检测到听筒打开之后，持续获取手势锁状态为例进行说明。S1003，判断当前接近光是否为接近状态。示例性的，手势辅助算法获取接近光驱动获取到的实体接近光状态是否为接近状态。一个示例中，如果为接近状态，则执行S1004。另一个示例中，如果为远离状态，则执行S1005。S1004，判断pitch、roll和handupJudge是否满足阈值。具体流程可参照S703，此处不再赘述。一个示例中，如果pitch、roll和handupJudge满足阈值，则手势锁锁定，即输出的手势锁状态为锁定。另一个示例中，如果pitch、roll和handupJudge不满足阈值，则手势锁未锁定，即输出的手势锁状态为未锁定。S1005，判断状态值是否为true。示例性的，手势辅助算法可执行图7中的流程，以获取状态值。一个示例中，如果状态值为true，则手势锁锁定，即输出的手势锁状态为锁定。另一个示例中，如果状态值为false，则执行S1006。S1006，判断当前是否为锁定状态。示例性的，手势辅助算法检测手势锁当前是否为锁定状态。一个示例中，如果判断为是，则执行S100,7。另一个示例中，如果判断为否，即手势锁未锁定，则继续保持未锁定状态。S1007，判断pitch和roll是否满足阈值。一个示例中，如果pitch、roll满足阈值，则手势锁锁定，即输出的手势锁状态为锁定。另一个示例中，如果pitch、roll不满足阈值，则手势锁未锁定，即输出的手势锁状态为未锁定。请继续参照图9a，在该示例中，用户拿起手机在耳边接听，手势辅助算法执行图10所示的流程，具体的，手势辅助算法执行S1003，确定当前接近光状态为接近状态，则执行S1004。如上文所述，手势辅助算法是实时获取并计算pitch、roll和handupJudge数值的，相应的，用户抬手之后，手势辅助算法可基于已获取的pitch、roll和handupJudge，确定满足耳边接听的条件，即S1004判断为是，手势锁锁定，即将接近光状态锁定为接近状态。其中，用户拿起手机在耳边接听的情况下，pitch、roll会较之之前的数值发生变化，满足右手接听阈值范围或左手接听阈值范围。并且，由于用户将手机从远离状态拿到耳边，手机从远离位置移动到耳边，handupJudge数值大于0，即满足预设阈值。S912，接近光驱动获取接近光状态。示例性的，如4b所示，用户当前手持手机在耳边接听，即接近光驱动基于接近光传感器检测到的参数，确定手机处于接近状态。S913，接近光驱动从手势辅助算法读取听筒状态。示例性的，如上文所述，手势辅助记录有听筒与扬声器的状态。手势辅助记录的听筒当前的状态为关闭状态。也就是说，手势辅助算法默认记录扬声器与听筒的状态均是关闭的。手势辅助算法记录扬声器为打开状态，其中，听筒状态仍然为关闭。接近光驱动可读取手势辅助算法记录的听筒与扬声器的状态，并获取到当前听筒状态。S914，接近光驱动判断听筒是否打开。示例性的，接近光驱动基于从手势辅助算法读取到的听筒状态，判断听筒是否为打开状态。如图5的S503，如果听筒打开，则执行S508，如果听筒关闭，则执行S504。在本实例中，接近光驱动检测到听筒为打开状态，执行S914。对应图5中的流程走到S508。S915，接近光驱动读取手势锁状态值。示例性的，对应图5中的S508，如果判断手势锁状态为锁定状态，则执行S506，如果手势锁状态为未锁定状态，则执行S510。请继续参照图9b，示例性的，如上文所述，手势辅助算法经过图10所示的流程，输出手势锁状态为锁定状态，即接近光锁定为接近状态。S916a，接近光驱动确定上报接近状态。示例性的，如上文所述，手势锁锁定状态下，接近光状态锁定为接近状态。也就是说，无论接近光驱动获取到的实体接近光状态为接近状态或者是远离状态，接近光驱动向聊天应用上报的接近光状态均为接近状态。S916b，接近光驱动向SensorHal上报接近状态。S916c，SensorHal向应用上报接近状态。示例性的，请参照图4b，接近光驱动确定向SensorHal上报接近状态。SensorHal向Sensorservice上报接近状态。Sensorsevice将接近状态发送给聊天应用。在用户耳边接听语音消息的过程中，各模块重复执行S911a~S916c，使得手机持续处于灭屏状态，且使用听筒播放语音消息。在本申请实施例中，用户将手机拿到耳边接听之后，手机进入防误触模式，即灭屏，并使用听筒播放语音消息。在一些场景中，如果用户从耳边放下手机，则手机将关闭防误触模式，即亮屏，并使用扬声器继续播放语音消息。图11为示例性示出的语音播放方法的流程示意图，请参照图11，具体包括但不限于：S1101a，手势辅助算法基于ACC数据，输出状态值。示例性的，用户将手机拿开耳边之后，手势辅助算法计算出的pitch、roll和handupJudge将不满足阈值，相应的，在图7所示的流程中，手势辅助算法输出false。S1001b，手势辅助算法基于ACC数据，输出手势锁状态。示例性的，在图10所示的流程中，手势辅助算法执行S1003，由于器件性能或者是接近光驱动上报周期的影响，用户从耳边拿开手机后，接近光驱动可能还未获取到远离状态。相应的，手势辅助算法判断当前接近光状态为远离状态，执行S1005。示例性的，手势辅助算法获取状态值，如上文所述，状态值判断为false。手势辅助算法继续执行S1006。手势辅助算法当前为锁定状态，则执行S1007。相应的，手势辅助算法基于pitch、roll和handupJudge，判断不满足阈值，则解除锁定状态，即输出手势锁状态为未锁定状态。S1002，接近光驱动获取接近光状态。示例性的，接近光驱动获取到实体接近光状态为远离状态。S1003，接近光驱动从手势辅助算法读取听筒状态。示例性的，手势辅助记录的当前听筒状态为打开状态。接近光驱动读取到听筒为打开状态。S1104，接近光驱动判断听筒是否打开。S1105，接近光驱动从手势辅助算法读取手势锁状态。S1106a，接近光驱动确定上报远离状态。示例性的，在图5所示的流程中，接近光驱动确定听筒打开，且获取到手势所的状态为未锁定。流程走到S510，接近光驱动可确定上报当前获取到的实体接近光状态，即为远离状态。S1106b，接近光驱动向SensorHal上报远离状态。S1106c，SensorHal向应用上报远离状态。相应的，聊天应用响应于接收到的远离状态，可从图6的S601a开始执行，即打开扬声器，以使用扬声器继续播放语音消息，且亮屏。示例性的，如上文所述，接近光驱动可能发生异常上报，即，用户在耳边接听语音消息时，接近光传感器误检测到远离状态。在该场景中，接近光驱动可基于手势辅助算法的手势锁状态，以校正接近光驱动的实体接近光检测结果，以向聊天应用上报正确的接近状态，避免误报。图12为示例性示出的语音消息播放流程示意图，请参照图12，具体包括但不限于如下步骤：S1201a，手势辅助算法基于ACC数据，输出状态值。示例性的，手势辅助算法执行图7中的流程，在该示例中，手势辅助算法基于计算出的pitch、roll和handupJudge数值，判断满足阈值，且听筒和扬声器为打开状态。手势辅助算法判断为是，执行S704。在该示例中，由于接近光驱动本次是误报，而上一次上报的仍然为接近状态，相应的，手势辅助算法判断上一次上报的接近光状态为接近状态，判断为是，输出状态值为true。S1201b，手势辅助算法基于ACC数据，输出手势锁状态。示例性的，手势辅助算法基于ACC数据，执行图10中的流程。请参照图10，手势辅助算法执行S1003。一个示例中，S1202可能是在S1201b执行之前执行的，即，接近光驱动已经获取到当前实体接近状态为远离状态，相应的，手势辅助算法执行S1003，判断为否，继续执行S1005。手势辅助算法可获取到输出状态值为true。手势辅助算法确定手势锁锁定。另一个示例中，由于器件性能或者是接近光驱动上报周期的影响，接近光驱动可能还未获取到实体接近光状态，则当前的接近光状态仍然是接近状态。相应的，手势辅助算法执行S1004，并基于pitch、roll，判断满足阈值，进一步确定手势锁锁定。需要说明的是，在本申请实施例中，在手势锁锁定之后，也就是说，用户在耳边接听的过程中，由于手机的加速度不会发生变化，则handupJudge可能始终为0。相应的，手势辅助算法在该场景中，在执行状态值的判断流程和手势锁状态的判断流程时，可以不考虑handupJudge。例如在执行S1004时，可以仅对pitch、roll进行判断，而无需再判断handupJudge。S1202，接近光驱动获取接近光状态。示例性的，在本实例中，以接近光驱动获取到异常状态，即实际上是接近状态，而接近光驱动获取到远离状态为例进行说明。S1203，接近光驱动从手势辅助算法读取听筒状态。示例性的，手势辅助记录的当前听筒状态为打开状态。接近光驱动读取到听筒为打开状态。S1204，接近光驱动判断听筒是否打开。S1205，接近光驱动从手势辅助算法读取手势锁状态。S1206a，接近光驱动确定上报接近状态。示例性的，在图5所示的流程中，接近光驱动确定听筒打开，且获取到手势所的状态为锁定。流程走到S506，接近光驱动可确定上报接近状态。也就是说，接近光驱动虽然获取到的实体接近光状态为远离状态，但是由于手势锁将接近状态锁定，相应的，接近光状态在检测到手势锁锁定的情况下，将原本要上报的远离状态更新为接近状态，从而实现对接近光状态误检测的及时修正，避免误报所导致的手机在用户耳边而通过扬声器播放，且亮屏可能发生误触的问题。S1206b，接近光驱动向SensorHal上报接近状态。S1206c，SensorHal向应用上报接近状态。具体描述可参照上文中的相关内容，此处不再赘述。在本申请实施例中，语音消息播放结束之后，聊天应用检测到语音消息播放结束，聊天应用可停止对扬声器或听筒的调用，即聊天应用可向AudioHal发送关闭扬声器和/或听筒指令。AudioHal响应于接收到的指令，指示音频驱动关闭听筒或扬声器。并且，AudioHal向Sensorevent发送写入扬声器和听筒关闭状态指示。Sensorevent响应于接收到的指示，记录听筒与扬声器的状态均为关闭状态。SensorHal从Sensorevent读取到扬声器和/或听筒的状态从打开状态切换为关闭状态，SensorHal向手势辅助算法发送扬声器关闭指示和/或听筒关闭指示。手势辅助算法可记录听筒和/或扬声器的状态为关闭状态。并且，手势辅助算法停止获取ACC数据，以降低系统功耗。在本申请实施例中，扬声器打开之后，手势辅助算法即开始获取ACC数据，并计算电子设备的姿态数据与运动数据，以提前准备手势锁状态计算时所需的数据。当用户将手机放到耳边接听时，接近光驱动检测到接近状态后上报聊天应用，聊天应用即可基于接近状态，启动防误触流程，即指示手机灭屏并切换到听筒播放语音消息。如上文所述，聊天应用调用听筒需要各模块之间进行交互，基于性能影响，接近光驱动可能还未获取到听筒打开状态。也就是说，在图5所示的流程中，流程继续走至S504，而此时听筒已经处于打开状态，即听筒播放语音消息，且屏幕处于灭屏状态。在接近光驱动在接收到听筒打开消息之前，接近光驱动可继续获取手势辅助算法输出的状态值，此时，手势辅助算法基于姿态数据和运动数据，已经判断出手机处于接近状态。即如图7所示，手势辅助算法执行S703判断为是，流程走到S704，其中，由于接近光驱动已经上报过接近状态，则该流程同样判断为是，相应的，输出的状态值为true，即指示算法接近光状态得到的结果为接近状态。在该示例中，如果实体接近光异常上报远离状态，即在图5中，流程将从S504走到S505。在执行S505时，接近光驱动基于手势辅助算法的输出状态值，可确定算法接近光状态为接近状态。相应的，接近光驱动将会上报接近状态，以实现对实体接近光状态的异常检测结果进行校正。可以理解的是，电子设备为了实现上述功能，其包含了执行各个功能相应的硬件和/或软件模块。结合本文中所公开的实施例描述的各示例的算法步骤，本申请能够以硬件或硬件和计算机软件的结合形式来实现。某个功能究竟以硬件还是计算机软件驱动硬件的方式来执行，取决于技术方案的特定应用和设计约束条件。本领域技术人员可以结合实施例对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本申请的范围。一个示例中，图13示出了本申请实施例的一种装置1300的示意性框图装置1300可包括：处理器1301和收发器/收发管脚1302，可选地，还包括存储器1303。装置1300的各个组件通过总线1304耦合在一起，其中总线1304除包括数据总线之外，还包括电源总线、控制总线和状态信号总线。但是为了清楚说明起见，在图中将各种总线都称为总线1304。可选地，存储器1303可以用于前述方法实施例中的指令。该处理器1301可用于执行存储器1303中的指令，并控制接收管脚接收信号，以及控制发送管脚发送信号。装置1300可以是上述方法实施例中的电子设备或电子设备的芯片。其中，上述方法实施例涉及的各步骤的所有相关内容均可以援引到对应功能模块的功能描述，在此不再赘述。本实施例还提供一种计算机存储介质，该计算机存储介质中存储有计算机指令，当该计算机指令在电子设备上运行时，使得电子设备执行上述相关方法步骤实现上述实施例中的方法。本实施例还提供了一种计算机程序产品，当该计算机程序产品在计算机上运行时，使得计算机执行上述相关步骤，以实现上述实施例中的方法。另外，本申请的实施例还提供一种装置，这个装置具体可以是芯片，组件或模块，该装置可包括相连的处理器和存储器；其中，存储器用于存储计算机执行指令，当装置运行时，处理器可执行存储器存储的计算机执行指令，以使芯片执行上述各方法实施例中的方法。其中，本实施例提供的电子设备、计算机存储介质、计算机程序产品或芯片均用于执行上文所提供的对应的方法，因此，其所能达到的有益效果可参考上文所提供的对应的方法中的有益效果，此处不再赘述。以上所述，以上实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围。
