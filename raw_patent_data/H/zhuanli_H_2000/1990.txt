标题title
一种基于时空旋转的视频浓缩方法
摘要abst
本发明公开了一种基于时空旋转的视频浓缩方法，属于计算机视觉领域，包括以下步骤：1)根据目标占比阈值分别进行动态时域平移或时空旋转避免视频浓缩过程中的伪碰撞；2)定义角度临界阈值将时空旋转分为自适应时空旋转和临界时空旋转，在保证压缩率的同时避免伪碰撞；3)设计时序函数进行时序判断，避免目标间的时序混乱；4)最后缝合目标管生成浓缩视频。该方法能够充分利用视频中的时空信息，在保持良好帧浓缩率的同时避免伪碰撞，同时保留目标间的时序关系，具有良好的视觉效果。
权利要求书clms
1.一种基于时空旋转的视频浓缩方法，其特征在于，包括如下步骤：1)使用Yolov4和DeepSort算法对输入视频进行目标检测与跟踪，提取目标管；2)分析视频浓缩过程中目标间产生的伪碰撞，定义目标占比阈值，将伪碰撞的目标分别处理；3)提出动态时域平移方法，将大于目标占比阈值的运动目标进行动态时域平移避免伪碰撞，以确保在运动目标大小不一的监控视频中时空旋转算法的鲁棒性；4)将小于目标占比阈值的运动目标进行时空旋转，定义角度临界阈值，将时空旋转方法分为自适应时空旋转和临界时空旋转；5)对角度临界阈值小于0的伪碰撞目标，采用自适应时空旋转以提高原始视频的反映程度；6)对角度临界阈值大于0的伪碰撞目标，采用临界时空旋转以提高浓缩视频的压缩率。2.如权利要求1所述的基于时空旋转的视频浓缩方法，其特征在于，输入视频的预处理操作为：首先，对输入视频使用Yolov4目标检测算法检测视频中的运动目标；然后，采用DeepSort目标跟踪算法获得目标运动轨迹，并形成目标管；最后分析目标管间的碰撞关系，根据碰撞方式分别进行处理。3.如权利要求1所述的基于时空旋转的视频浓缩方法，其特征在于，根据输入视频的宽W、高H、帧率f和目标框宽w、高h设计出目标占比阈值，计算为：4.如权利要求1所述的基于时空旋转的视频浓缩方法，其特征在于，对于目标框面积大于γ的伪碰撞目标，采用动态时域平移，推迟目标管的开始时间标签，假设目标的移动速度为ν，根据目标碰撞交并比将目标管的开始时间标签修改为：5.如权利要求1所述的基于时空旋转的视频浓缩方法，其特征在于，对于目标框面积小于γ的目标管Ti和Tj，采用时空域旋转的方法避免伪碰撞。计算出两个目标管的方向向量夹角cosθi，j，据此定义角度临界阈值：6.如权利要求1所述的基于时空旋转的视频浓缩方法，其特征在于，对η≤0的监控视频，提出自适应时空旋转的方式避免伪碰撞，假设目标管Tj进入监视区域的坐标为旋转目标管Tj避免伪碰撞，旋转后的方向向量是/＞具体定义如下：其中r为目标从进入监视区域到当前位置的距离，和/＞分别为目标管Ti和Tj在t时刻的重心坐标，和/＞分别为Ti和Tj在t时刻目标框的右下坐标。7.如权利要求1所述的基于时空旋转的视频浓缩方法，其特征在于，对η＞0的监控视频，提出临界时空旋转的方式避免伪碰撞，根据目标管在监视区域中的运动位置关系进行分类，定义以下公式：其中，和/＞分别代表第m个目标退出和进入监视区域的重心坐标，以目标管Tj进入监视区域的起点为圆心，λ≥0时，Ti和Tj的临界交点为Ti的顶点，此时称Ti为近心段；λ＜0时，Ti和Tj的临界交点为Tj的顶点，此时称Tj为近心段。计算目标管Tj的旋转角度避免目标管之间的伪碰撞，生成符合人眼视觉效果且还原运动目标间关系的浓缩视频：其中，根据已知条件进行计算：
说明书desc
技术领域本发明涉及一种基于时空旋转的视频浓缩方法，属于计算机视觉技术领域。背景技术近年来，随着生活水平的提高，人们的安全防范意识不断增强，作为安防有效手段之一的监控设备被广泛地应用于银行、超市等人流密集的场合。大量的摄像机出于安全目的每天24小时用于监控视频录制，产生了海量的视频数据，虽然捕获的视频包含了用于安防的有效信息，但对如此大量视频数据的存储、管理和控制变得越来越困难。在监控视频中，可能一段时间内没有活动或活动只发生在小的图像区域，若采用传统的人工观看视频来寻找所需要的信息，将耗费大量的人力、物力和时间，不仅如此，长时间集中注意力观看视频很容易引起工作人员的疲劳，容易错看、漏看造成信息的误判。视频浓缩技术为以上问题提供了有效的解决方案，它通过将原始画面中的运动轨迹优化重排，生成适合高效浏览与查找的浓缩视频。不仅大大减少了视频时长，而且不会丢失原视频的信息。面对海量监控视频数据，如何实现快速地浏览和查询所需内容成为亟待解决的问题，有着迫切的现实需求。对当今社会时时刻刻都在产生视频数据的这一情况，视频浓缩技术的应用显得尤为重要。此外，Ghatak等人评估了将管优化重排问题转化为求解能量函数最优解问题的性能，即模拟退火、文化算法、基于教学的优化算法、森林优化算法、灰狼优化器、非支配排序遗传算法II、JAYA算法、精英-JAYA算法和自适应多种群JAYA算法。在后续改进中，Ghatak等人提出利用SA和JAYA相结合的混合算法改进能量最小化过程。Yao等人使用遗传算法生成新的最小化能量函数公式。此外，Xu等人提出了一种基于GA的优化方案来解决浓缩视频生成过程中目标管合并的问题，在信息损失和时间消耗方面优于基于SA方法。Ghatak等人探索了多帧和缩放的概念，提出了一种将GWO和SA混合在一起的HGWOSA优化算法，以获得较低计算代价的全局最优结果。Moussa等人利用粒子群算法优化重排目标管，减少伪碰撞，保持时间顺序，计算目标间的交互。基于目标的视频浓缩中最具挑战性的任务是获得目标管的最佳重排，以在最短的时间跨度内展示最多的运动信息。在视频浓缩过程中，原视频中不存在碰撞的两个目标可能在浓缩视频中发生碰撞，称为伪碰撞。为了解决目标交互性丢失、伪碰撞等问题，许多改进的视频浓缩技术被提出。Nie等人提出了一种在时域和空域中移动目标的视频浓缩技术，以生成减少伪碰撞浓缩视频。Li等人针对视频浓缩中的伪碰撞问题提出了缩小碰撞目标尺寸的解决方案，该方法在时域中将识别出的伪碰撞目标尺寸最小化，虽然伪碰撞的问题在技术上得到了解决，但浓缩后的视频在同一场景中彼此靠近的车辆和人大小可能是相同的，不符合现实情况。He等人定义了运动目标之间的碰撞状态，分别为：无碰撞、同向碰撞、反向碰撞，进一步分析了运动碰撞，还提出了一种基于碰撞图的优化策略，以确定性的方式填充目标管，降低计算复杂度。区别于利用能量函数求解来优化重排目标管的方法，Huang等人证实了在线优化的优越性，该方法允许在检测目标的同时重排目标管，无需等待优化过程开始，但该方法中最大的问题是完全忽略了伪碰撞以提高时间性能，另一个问题是优化技术阈值手动确定而非使用决策技术，这带来了计算时间和压缩率之间的权衡问题，精度降低。Feng等人引入了一种选择图像中活动最多、背景变化最大的视频帧的背景生成方法，生成的浓缩视频背景随着时间和运动而变化。Hsia等人提出了一种利用区域树来选择目标管的优化重排方法，为运动目标数据库引入一种高效的搜索技术，降低了计算复杂度。发明内容针对视频浓缩方法中伪碰撞严重、目标时序混乱，导致生成的浓缩视频对原始视频反映程度低以及现有基于能量函数求最优解的视频浓缩方法对局部伪碰撞避免效果较差的问题，本发明的目的是在于提供一种同时保留目标时序性、避免伪碰撞且保持较高视频压缩率的视频浓缩方法，通过设计时空旋转算法和时序函数实现高质量的高效视频浓缩。为实现上述目的，本发明的一个实施例提供了一种基于时空旋转的视频浓缩方法，其特征包括如下步骤：1)使用Yolov4和DeepSort算法对输入视频进行目标检测与跟踪，提取目标管；2)分析视频浓缩过程中目标间产生的伪碰撞，定义目标占比阈值，将伪碰撞的目标分别处理；3)提出动态时域平移方法，将大于目标占比阈值的运动目标进行动态时域平移避免伪碰撞，以确保在运动目标大小不一的监控视频中时空旋转算法的鲁棒性；4)将小于目标占比阈值的运动目标进行时空旋转，定义角度临界阈值，将时空旋转方法分为自适应时空旋转和临界时空旋转；5)对角度临界阈值小于0的伪碰撞目标，采用自适应时空旋转以提高原始视频的反映程度；6)对角度临界阈值大于0的伪碰撞目标，采用临界时空旋转以提高浓缩视频的压缩率。进一步的技术方案在于：首先，定义目标交互性函数分析目标间的交互性，划分管集以便共同处理；其次，分析目标间的伪碰撞，根据目标占比阈值分别进行动态时域平移或时空旋转避免伪碰撞，并定义角度临界阈值将时空旋转分为自适应时空旋转和临界时空旋转，在保证压缩率的同时避免伪碰撞；然后，设计时序函数进行时序判断，避免目标间的时序混乱；最后，缝合目标管生成浓缩视频。进一步的技术方案在于：假设发生伪碰撞的目标管为Ti和Tj，其中Ti已经重排完毕属于浓缩视频，而Tj尚未重排，Ti和Tj在t时刻的碰撞交并比定义为：进一步的技术方案在于：定义目标占比阈值，根据阈值分别进行动态时域平移和时空域旋转来避免伪碰撞；其次定义角度临界阈值，将时空域旋转分为自适应时空旋转和临界时空旋转。进一步的技术方案在于：定义目标占比阈值：对于目标框面积大于γ的伪碰撞目标，采用动态时域平移，推迟Ti的开始时间标签，将Tj的开始时间标签修改为：进一步的技术方案在于：对于目标框面积小于γ的目标管Ti和Tj，采用时空域旋转的方法避免伪碰撞，定义角度临界阈值：进一步的技术方案在于：对η≤0的监控视频，提出自适应时空旋转的方式避免伪碰撞，将目标管Tj以起点为圆心旋转使其远离碰撞点，直至两个目标刚好无碰撞，虚线为目标管Tj旋转后的时空轨迹。进一步的技术方案在于：假设目标管Tj进入监视区域的坐标为旋转目标管Tj避免伪碰撞，旋转后的方向向量是/＞具体定义为：目标管Tj旋转角度的计算方式为：进一步的技术方案在于：对于η＞0的监控视频，提出一种临界时空旋转方法在保证压缩率的前提下避免伪碰撞，将目标管Tj以起点为圆心旋转使其远离碰撞点，直至两个目标管无重叠帧。进一步的技术方案在于：根据目标管在监视区域中的运动位置关系进行分类，定义以下公式：其中，和/＞分别代表第m个目标退出和进入监视区域的重心坐标。进一步的技术方案在于：以目标管Tj进入监视区域的起点为圆心，λ≥0时，Ti和Tj的临界交点为Ti的顶点，此时称Ti为近心段；λ＜0时，Ti和Tj的临界交点为Tj的顶点，此时称Tj为近心段；在进行目标管优化重排时，不同的目标管作为近心段需要进行不同的处理来避免碰撞。进一步的技术方案在于：Ti为近心段时，将Tj旋转直至与Ti的终点相交，两个目标管将不存在碰撞关系，的具体定义如下：其中，分别为Ti退出监视区域的坐标和Tj进入监视区域的坐标。已知/＞为Tj的运动方向向量，可计算出旋转角度/＞进一步的技术方案在于：Tj为近心段，将Tj旋转直至Tj的终点与Ti相交，两个目标管将不存在碰撞关系，已知假设旋转后的Tj与Ti的交点坐标为，则/＞的具体定义如下：其中，根据已知条件进行计算：采用上述技术方案所产生的有益效果在于：本发明针对浓缩视频中目标间出现伪碰撞的问题，提出了一种基于时空旋转的监控视频高效浓缩方案，首先，提出目标交互性函数对提取的目标管进行交互分析，确定存在交互行为的目标；其次，在处理伪碰撞的问题上提出了动态时域平移和时空旋转算法，并根据目标的碰撞方式分别进行自适应时空旋转和临界时空旋转，在避免伪碰撞的同时保证压缩率；最后，利用旋转搜索的方式填充目标管，定义时序性函数保证生成的浓缩视频与原视频时序的一致性。实验结果表明，所提方法在保证压缩率的前提下避免了目标间的伪碰撞，可以实现高质量的视频浓缩。附图说明通过阅读参照以下附图对非限制性实施例所作的详细描述，本发明的其它特征、目的和优点将会变得更明显：图1为本发明实施例提供的一种基于时空旋转的监控视频浓缩整体流程图；图2为本发明实施例提供的动态时域平移示意图；图3为本发明实施例提供的自适应时空旋转示意图；图4为本发明实施例提供的临界时空旋转示意图；图5为本发明实施例提供的伪碰撞示意图；图6为本发明实施例提供的临界时空旋转示意图；图7为本发明实施例提供的临界时空旋转示意图。具体实施方式下面结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在下面的描述中阐述了很多具体细节以便于充分理解本发明，但是本发明还可以采用其他不同于在此描述的其它方式来实施，本领域技术人员可以在不违背本发明内涵的情况下做类似推广，因此本发明不受下面公开的具体实施例的限制。如图1所示，本发明实施例提供的一种基于时空旋转的监控视频浓缩整体流程图，包括：1)使用Yolov4和DeepSort算法对输入视频进行目标检测与跟踪，提取目标管；2)分析视频浓缩过程中目标间产生的伪碰撞，定义目标占比阈值，将伪碰撞的目标分别处理；3)提出动态时域平移方法，将大于目标占比阈值的运动目标进行动态时域平移避免伪碰撞，以确保在运动目标大小不一的监控视频中时空旋转算法的鲁棒性；4)将小于目标占比阈值的运动目标进行时空旋转，定义角度临界阈值，将时空旋转方法分为自适应时空旋转和临界时空旋转；5)对角度临界阈值小于0的伪碰撞目标，采用自适应时空旋转以提高原始视频的反映程度；6)对角度临界阈值大于0的伪碰撞目标，采用临界时空旋转以提高浓缩视频的压缩率。如图2所示，为了确保在运动目标大小不一的监控视频中时空旋转算法的鲁棒性，本发明根据不同的伪碰撞方式将时空旋转算法提出三种处理方式。首先定义目标占比阈值，根据阈值分别进行动态时域平移和时空域旋转来避免伪碰撞；其次定义角度临界阈值，将时空域旋转分为自适应时空旋转和临界时空旋转。定义目标占比阈值γ：其中，w、h分别为目标框的宽和高，W、H分别为视频帧的宽和高，f为输入视频的帧率。对于目标框面积大于γ的伪碰撞目标，采用动态时域平移，推迟Tj的开始时间标签，假设目标j的移动速度为v，将Tj的开始时间标签修改为：图2展示了目标框面积大于γ的视频浓缩结果，在原视频中没有交集的两个目标在同一时间出现在了相同的空间位置，产生了伪碰撞。采用动态时域平移方法修改目标管Tj的开始时间标签，可以看出动态时域平移后的浓缩视频不存在伪碰撞，并且无需平移整个目标管的时间长度，对压缩率的影响极小。如图3所示，为了保证浓缩视频的良好视觉效果，对η≤0的监控视频，提出自适应时空旋转的方式避免伪碰撞。两个目标管沿时间轴平移后存在少量视频帧重叠，原视频中无碰撞的目标在浓缩后产生了伪碰撞。如图3所示，将目标管Tj以起点为圆心旋转使其远离碰撞点，直至两个目标刚好无碰撞，虚线为目标管Tj旋转后的时空轨迹。为了更直观的展示自适应时空旋转方法，图3展示了目标管Ti和Tj在t时刻产生最大碰撞面积的二维示意图，Ti和Tj的运动方向向量分别为和/＞以目标管Tj进入监视区域的起点为圆心，旋转Tj直至伪碰撞消失，如图3所示，虚线为其旋转后的运动方向，/＞为方向向量，/＞为目标管旋转的角度。为了提高浓缩视频的压缩率，对于η＞0的监控视频，大量视频帧发生伪碰撞，推迟目标管的开始时间标签会极大地牺牲视频压缩率，因此提出一种临界时空旋转方法在保证压缩率的前提下避免伪碰撞。如图4所示，两个目标管沿时间轴平移后存在大量的重叠视频帧，原视频中无碰撞的目标在浓缩后发生了伪碰撞。将目标管Tj以起点为圆心旋转使其远离碰撞点，直至两个目标管无重叠帧，如图4所示，虚线为目标管Tj旋转后的时空轨迹。为了更直观的展示临界时空旋转方法，图5展示了目标管Ti和Tj在t时刻的运动方向向量二维示意图，根据目标管在监视区域中的运动位置关系进行分类，定义以下公式：如图5所示，以目标管Tj进入监视区域的起点为圆心，λ≥0时，Ti和Tj的临界交点为Ti的顶点，此时称Ti为近心段；λ＜0时，Ti和Tj的临界交点为Tj的顶点，此时称Tj为近心段，如图5所示。在进行目标管优化重排时，不同的目标管作为近心段需要进行不同的处理来避免碰撞，下文将分别对Ti和Tj作为近心段时介绍旋转角度相应的计算方法。如图6所示，Ti为近心段。将Tj旋转直至与Ti的终点相交，两个目标管将不存在碰撞关系，的具体定义如下：如图7示，Tj为近心段。将Tj旋转直至Tj的终点与Ti相交，两个目标管将不存在碰撞关系。旋转角度的计算需要/＞和/＞已知/＞假设旋转后的Tj与Ti的交点坐标为，则/＞的具体定义如下：其中，根据已知条件进行计算：由此可以得出目标管Tj的旋转角度避免目标管之间的伪碰撞，生成符合人眼视觉效果且还原运动目标间关系的浓缩视频。为了验证以上实施例的有效性，在公共数据集和真实场景采集的监控视频上进行实验对比。实验环境为Windows10系统、IntelCorei5-8265U CPU、NVIDIA GeForceMX250显卡，内存16G。使用12段监控视频对所提方法进行了实验验证。表1和表2分别展示了12段测视视频上的帧浓缩率FR和碰撞率OR实验结果。为了更直观地比较不同方法之间的性能，在表格的最后一行使用所有视频的实验结果平均值进行比较。表1与CE方法、PSO方法、IV方法、CF方法的FR结果比较表2与CE方法、PSO方法、IV方法、CF方法的OR结果比较由表2可以看出，所提方法的平均OR明显优于CE方法、PSO方法和IV方法，这是因为CE方法、PSO方法和IV方法仅仅在时间轴上平移目标管，而所提方法同时考虑空间和时间两个维度，可以更好的避免伪碰撞从而得到更优秀的OR。所提方法与CF方法的平均OR接近，分别为0.0680和0.0633，这是因为CF方法在时间轴平移目标管的同时改变目标的尺寸和移动速度，虽然取得了与所提方法接近的OR但视觉质量较差，对原始视频内容的反映程度有待提高。通常来说，FR的提高是以增加OR为代价的，通过表1和表2的综合分析，与CE方法相比，所提方法在FR方面有较大改进，同时保持了较好的OR值。与PSO方法相比，浓缩视频的OR值有效降低，而FR值也有所优化。与IV方法相比，所提方法在OR方面明显优于IV方法，在FR方面，所提方法与IV方法接近但优于IV方法。以上对本发明的具体实施例进行了详细描述。需要理解的是，本发明并不局限于上述特定实施方式，本领域技术人员可以在权利要求的范围内做出各种变形或修改，这并不影响本发明的实质内容。
