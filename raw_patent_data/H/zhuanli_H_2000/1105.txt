标题title
一种基于特征选择和集成学习的物联网入侵检测方法
摘要abst
本发明提供了一种基于特征选择和集成学习的物联网入侵检测方法，本方法首先通过对捕获到的数据进行分析和特征提取后获得原始数据集并划分为训练集和测试集。针对数据的高冗余，高维度问题，采用鲸鱼优化算法和人工蜂鸟算法的混合策略优化算法进行特征选择，以常见的三种机器学习分类器逻辑回归LR、随机森林、XGBoost为评估器评估测试集，选择出对分类最重要的特征，再根据提取到的三种特征子集从原始数据集中获得对应的数据子集，作为集成分类模块的输入，训练集成模型，DNN负责综合各个机器学习基分类器的评估结果，最终完成入侵检测。本发明的特征选择方法有效解决了因数据流量的高冗余高维度带来的效率低下问题，提高了入侵检测的效率，同时引入集成学习方法能够避免单一模型出现的过拟合现象，有效提高入侵检测的稳定性。采用本方法进行物联网入侵检测，能够极大提高物联网入侵检测的性能。
权利要求书clms
1.一种基于特征选择和集成学习的物联网入侵检测方法，其特征在于包含以下步骤：a.获取物联网网络数据包，并进行相应的预处理，对获取到的流量数据包进行解析并提取特征构建原始的数据集D＝，其中xn表示数据样本的第n个特征，y表示该样本对应的标签，对标签y进行数值化操作，对数据集D进行数据清洗和数据归一化操作，并将原始数据划分为训练集和测试集；b.构建鲸鱼优化和人工蜂鸟的混合策略优化算法进行特征选择，引入人工蜂鸟的探索阶段，扩大鲸鱼的搜索方位，提高全局搜索能力，减少陷入局部最优的可能性，在鲸鱼优化算法中使用余弦非线性收敛因子替换原先的线性收敛因子，让种群保持更长时间的探索能力，使用随机参数p来控制算法的探索和开发过程，在迭代后期，引入Levy飞行机制来改进算法，提高算法在迭代后期的局部搜索性能，最终种群通过WOA和AHA的混合优化策略进行更新以寻找最优解；c.构建集成学习入侵检测模型，利用集成学习模型实现对物联网的入侵检测，特征选择完成后获得针对三种评估器效果最优的特征子集，使用特征子集筛选原始数据集，获得对应的数据子集，将数据子集又重新馈送到对应的分类器中，组合这三个分类器针对对应数据子集的输出，与原始标签一起输入到深度神经网络DNN中，相当于将这三个机器学习作为基分类器，深度神经网络DNN作为元分类器，共同构建了一个集成模型，在DNN中使用Relu作为隐藏层的激活函数，使用Softmax作为最终输出层的激活函数；d.利用所得到的集成学习模型实现物联网入侵检测，采用准确率Accuracy、召回率DR、精确度Precision、特异度TNR和F1分数多个指标作为衡量标准，以对模型进行综合评价。
说明书desc
技术领域本发明涉及一种基于特征选择和集成学习的物联网入侵检测方法，针对物联网入侵检测领域，采用鲸鱼优化算法和人工蜂鸟算法的混合策略进行特征选择，利用集成学习方法，组合多个基分类器的结果，获得一个检测效果更好的元分类器，实现对各种攻击的有效检测。背景技术近年来，随着物联网的飞速发展，我们的生活日新月异，越来越多的物理设备因此更具智能化，智能家居、智慧城市、医疗保健等物联网技术的应用，改善着我们的生活质量，提高社会运行效率。在物联网发展的同时，也产生很多安全问题，入侵行为成为物联网环境中的重要威胁。黑客和攻击者利用各种手段和技术，试图窃取用户的敏感信息、破坏系统等活动，给个人和组织带来了巨大的损失和风险。现如今，传统的身份认证、防火墙等安全防护机制无法应对不断更新的入侵攻击。为了进一步提高物联网的防御能力，研究者们设计入侵检测系统用来检测物联网环境中出现的异常数据和各种异常行为，然而由于从物联网网络信道中获取到的数据往往存在维度高、冗余度大的问题。因此就需要对获取到的流量数据进行特征选择，从而降低数据的复杂性、消除数据之间存在的冗余而导致的检测效率不足的问题。特征选择作为数据预处理的关键阶段，已成为热门的研究方向。特征选择可以去除不相关的特征或属性，同时保留其他显着影响数据分类的相关特征。因此，特征选择可以提高分类准确性并加速生成决策的模型学习和数据处理阶段。集成学习是一种机器学习技术，通过结合多个基本学习器的预测结果，从而获得更好的整体性能。集成学习旨在通过组合多个学习器的优点，弥补单个学习器的不足，提高模型的泛化能力和准确性。针对当前物联网入侵检测中存在的检测效率低和检测精度不足等问题，首先通过特征选择算法对物联网流量数据进行特征选择，保留最重要的特征，剔除不重要特征以及一些冗余特征，从而提高检测效率。采用集成学习方式，构建集成学习模型用于对所提取的重要特征数据进行检测，集成学习的引入有效防止了单一分类器容易造成的过拟合现象，提升了分类精度的同时能够保持分类的稳定性，结合特征选择算法和集成学习的入侵检测模型能够有效提升物联网入侵检测模型的性能。发明内容为提高物联网入侵检测的效率和准确率，本发明提出一种基于特征选择和集成学习的物联网入侵检测方法，通过基于鲸鱼优化算法和人工蜂鸟优化算法的混合策略进行特征选择，使用机器学习分类器评估特征选择效果，保留效果最好的特征，再构建集成学习分类模型，对经过处理的数据进行分类，从而提高物联网入侵检测的效率和准确率。其特征在于以下步骤：获取网络流量数据，并进行数据预处理通过采集物联网信道中的流量数据生成原始数据集，再进行数据清洗，数据归一化操作，并划分为训练集Dtrain＝,xn∈和测试集Dtest＝,xn∈；通过混合策略的优化算法WOAAHA进行特征选择结合鲸鱼优化算法WOA和人工蜂鸟优化算法AHA，引入余弦非线性收敛因子替换WOA中的线性收敛因子，并使用Levy飞行来提高迭代后期算法整体的局部搜索能力，以对混合算法进行优化，从而构建一种混合策略算法WOAAHA进行特征选择并使用逻辑回归、随机森林、XGBoost三种常见机器学习分类器作为特征选择的评估器，通过适应度函数来评估选择的特征的效果；构建集成学习模型使用特征选择阶段获得的特征，对原始数据集进行特征筛选获得数据子集，使用特征选择阶段对应的分类器进行分类，将这些分类器作为基分类器进行初步分类后，将其结果连接起来输入到深度神经网络DNN中，训练最终的DNN元分类器，其中DNN采用具有两层隐藏层的全连接神经网络；利用集成学习模型实现物联网入侵检测将测试集Dtest进行特征筛选后，获得不同基分类器对应的数据子集，输入到集成分类器中，得到入侵检测结果；附图说明为了更清楚的说明本发明实施例中的技术方案，下面结合附图与具体实施方案对本发明做进一步说明：图1基于特征选择和集成学习的物联网入侵检测模型WOAAHA-Ensemble-DNN。图2基于鲸鱼优化和人工蜂鸟的混合优化算法WOAAHA流程图。具体实施方式下面结合附图对本发明作进一步详细的描述，本发明主要包括以下几个步骤：通过对物联网进行实时监听捕获网络中的流量数据包，对流量数据包进行解析并提取特征构建原始的数据集D＝，其中xn表示数据样本的第n个特征，y表示该样本对应的标签；对获取到的流量数据进行数据预处理，包括数据清洗、数据归一化，数据清洗包含删除单值特征，即所有网络流量数据中具有相同值的数据、删除包含缺失值或无穷值的流量数据以及删除重复列；对流量数据标签y进行数值化；数据归一化对数值数据进行归一化，将各个数值特征限定在同一范围，从而减少不同类型网络流量数据之间的差异。采用minmax方法进行归一化，将各个特征映射到0、1之间，计算方式如下所示：其中xn表示每条数据的第n个特征，经过处理后该值的取值范围在0、1之间，xmin表示这个特征对应的数据中的最小值，xmax表示这个特征对应的数据中的最大值。经过上述处理之后，为了方便接下来对数据流量特征的选择，将进行预处理后的数据以7：3的比例划分为训练集Dtrain＝,xn∈和测试集Dtest＝,xn∈；构建鲸鱼和人工蜂鸟的混合策略优化算法进行特征选择，所提出的算法通过在探索和开发之间提供平衡来找到最佳解决方法，由于鲸鱼优化算法容易陷入局部最优，引入人工蜂鸟的探索阶段，扩大鲸鱼的搜索方位，提高全局搜索能力，减少陷入局部最优的可能性。并在鲸鱼优化算法中引入余弦非线性收敛因子替换原先的线性收敛因子，/＞非线性减少会使得/＞在迭代中间和后期保持大于1，让种群保持更长时间的探索能力，提升鲸鱼优化算法的收敛精度，平衡算法在收缩包围过程中的收缩性能。在迭代后期，引入Levy飞行策略来改进算法，提高算法在迭代后期的局部搜索性能；具体步骤如下：1)首先初始化WOAAHA算法参数，包括个体的种群数量N，搜索空间维度M以及最大的迭代次数T。2)将获得的数据集以7：3划分为训练集和测试集，作为算法的输入。然后使用随机初始化方法构造初始种群X具体公式如式所示：Xi＝rand×+min_B,i＝1,2,…,N其中，N代表种群的数量，min_B和max_B指的是搜索域的边界，rand为之间的随机值，具体表示为Xi＝{Xij，j＝1,2,...,M}，M代表特征的数量。3)使用离散编码方案来表示群体中的个体，使用等式获得Xij的布尔形式，其中0表示该特征未被选择，1表示该特征被选择。因此，Xi被转化为{0,1,0,1...}形式。4)根据Xi所选定的特征，从训练集和测试集中分别获得训练子集和测试子集，在训练子集上进行训练并在测试子集上进行评估，以计算Xi的适应度，适应度越小越好，具体计算如式所示：式中：Fitness表示适应度函数，ErrorRate为特征选择的分类错误率，即ErrorRate＝1-Accuracy，Accuracy表示测试集上的分类准确度，α和β分别为分类错误率和子集大小的权重，且α＝1-β，S_F为所选特征子集的长度，即Xi中编码为1的数量，All_F为所选数据集的特征总数。5)根据适应度函数Fitness计算个体适应度值。使用混合策略优化算法不断更新种群，直到满足最大的迭代次数时停止。种群更新包含两个阶段，第一阶段为探索阶段，通过AHA算法更新种群X，第二阶段为开发阶段，通过WOA算法的收缩包围机制实现。采用p作为平衡因子用来平衡人工蜂鸟的探索和鲸鱼的开发过程。详细步骤如下：通过概率p以及参数来控制算法的开发和探索过程①初始化随机概率p，p为之间的随机数，计算参数如式所示，其中，/＞为之间的随机向量,使用余弦非线性因子/＞替换原先的线性因子，如所示；②当p＜0.5，搜索代理将通过式和利用鲸鱼的收缩包围机制更新其位置，使用鲸鱼优化算法寻找最优解。其中，在鲸鱼向最优位置游走阶段，具体过程如式，引入Levy飞行机制，提高局部搜索性能，防止陷入局部最优。当时，使用式更新搜索代理当前位置，当/＞时，使用式更新搜索代理当前位置。其中，t为当前迭代次数，表示当前最优解的位置，/＞表示当前鲸鱼个体的位置，/＞表示从当前种群中随机选取的鲸鱼个体的位置，/＞为当前鲸鱼个体与当前最优解之间的距离，/＞表示当前鲸鱼个体到随机鲸鱼之间的距离；当p≥0.5，搜索代理将通过式利用人工蜂鸟引导觅食策略更新其位置，其中，f表示适应度函数值，Vi为引导觅食行为的数学表示，具体计算如式所示，在引导觅食策略中引入Levy飞行机制，提高迭代后期算法的局部搜索能力，表示第t次迭代时的第i个食物源位置，/＞表示第i个蜂鸟访问的目标食物源的位置，b是服从标准正态分布的引导因子，/＞是飞行向量。使用人工蜂鸟的觅食行为进行最优位置的探索和开发寻找最优解，如果人工蜂鸟能够找到比鲸鱼更好的位置，所有的鲸鱼都会迁移到人工蜂鸟来开发，如果找不到更好的点，鲸鱼就会在原地继续进行探索；③完成一次迭代后，计算个体适应度值并更新当前最优解④判断算法是否达到设定的最大迭代次数，若达到则结束就是求得的最佳解，否则回到步骤②继续进行迭代；⑤输出个体的最佳位置，即最佳解及其适应度值；6)根据所获得的最优解对流量数据集进行处理，获得最优特征子集。构建集成学习入侵检测模型，利用集成学习模型实现对物联网的入侵检测，特征选择完成后获得针对这三种评估器效果最优的特征子集，使用特征子集筛选原始数据集获得对应的数据子集，将数据子集重新又馈送到对应的分类器中，把三个分类器对各自数据子集的输出结果组合起来，与原始标签一起输入到深度神经网络DNN中，相当于将这三个机器学习分类器作为基分类器，深度神经网络DNN作为元分类器，共同构建了一个集成模型。在DNN中使用Relu作为隐藏层的激活函数，使用Softmax作为最终输出层的激活函数；利用集成学习模型实现物联网入侵检测。通过WOAAHA-Ensemble-DNN模型进行物联网入侵检测，采用准确率Accuracy、召回率DR、精确度Precision、特异度TNR和F1分数多个指标作为衡量标准，以对模型进行综合评价，具体的计算表达式如下所示：其中TP表示正常流量被分为正常流量的数量、FP表示正常流量被分为攻击流量的数量、FN表示攻击流量被分为正常流量的数量、TN表示攻击流量被分为攻击流量的数量。Accuracy表示检测到的真实样本数占样本总数的比例，DR或Recall表示检测到的入侵样本数占所有入侵样本数的比例，Precision表示检测到的入侵样本与实际入侵样本的比例，TNR表示用于表示预测的正常样本与所有正常样本的比率，F1score定义为精确率和召回率的调和平均值。本发明主要采用人工蜂鸟优化算法对鲸鱼优化算进行改进，并将改进后的混合算法用于特征选择，随机森林、XGBoost、LR作为特征选择算法中的学习算法以对所选择的特征进行评估，将特征选择后得到的三个数据子集输入到各自相应的集成学习基分类器中，最终将这三种基分类器的结果组合起来，并结合原始数据标签输入到DNN中，进行入侵检测。本发明所提出的特征选择算法能够在降低数据维度的同时提升分类效果，集成学习的引入避免了单一模型容易陷入过拟合的问题，提高了模型的泛化效果。结合本发明中特征选择算法和集成学习方法能够更好的进行物联网入侵检测防护。
