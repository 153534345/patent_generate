标题title
一种融合规则与优化算法的电力系统快速生产模拟方法
摘要abst
本发明涉及一种融合规则与优化算法的电力系统快速生产模拟方法。本发明读取生产模拟对象参数及设置、设置火电机组及储能初始状态、火电机组启停决策资源池初始化；根据当前时段各节点负荷、各VRE机组最大出力、火电机组启停决策资源池变量决定火电机组开关机状态、储能充放电功率和VRE机组弃电功率，以实现基于规则的火电机组开关机决策；构建当前时刻下考虑网络约束、VRE机组出力上限约束、已开火电机组出力上下限约束、备用约束和储能约束，以运行成本最小为目标的出力优化OPF模型并求解；将每个时段OPF求解结果按照时间顺序串联，从而得到所有仿真时段各类设备状态及出力。本申请避免离散变量的多种组合尝试，能显著提高计算效率。
权利要求书clms
1.一种融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，包括：根据生产模拟对象系统参数和对象系统初始状态，其中，生产模拟对象系统参数包括：网架参数、负荷参数、火电机组参数、VRE机组参数、储能参数；读取或按规则生成火电机组开关机状态及持续时间、储能充放电功率，为生产模拟提供火电机组及储能初始状态，继而根据火电机组和储能初始状态将火电机组启停决策资源池初始化；根据当前时段各节点负荷、各VRE机组最大出力、火电机组启停决策资源池变量决定火电机组开关机状态、储能充放电功率和VRE机组弃电功率，以实现基于规则的火电机组开关机决策；构建当前时刻下考虑网络约束、VRE机组出力上限约束、已开火电机组出力上下限约束、备用约束和储能约束，以运行成本最小为目标的出力优化OPF模型并求解；将每个时段OPF求解结果按照时间顺序串联，从而得到所有仿真时段各类设备状态及出力。2.根据权利要求1所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，读取或按规则生成火电机组开关机状态及持续时间、储能充放电功率，为生产模拟提供火电机组及储能初始状态包括：若初始状态通过读入获取，则直接将读取的初始状态写入每个火电机组开关机状态及持续时间数组变量cGenState及储能充放电功率数组ESSP；若初始状态由内部生成，则包括：设置储能充放电功率数组ESSP全部为零；读取初始时刻所有节点负荷及所有VRE机组最大出力，分别计算二者之和并作差形成VRE机组完全出力时净负荷；采用下式计算火电机组平均运行煤耗，并按由小到大排序：式中，pgi,rate为第i台火电机组的平均煤耗和额定功率，ai,bi,ci分别为第i台火电机组煤耗特性的二次、一次和常数项系数；根据平均煤耗大小逐一开启火电机组，直至净负荷功率位于所开机组最小功率和与最大功率和之间，根据开机情况设置火电机组开关机状态及持续时间数组变量cGenState。3.根据权利要求1所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，所述继而根据火电机组和储能初始状态将火电机组启停决策资源池初始化遍历储能充放电功率数组ESSP，根据各行数据是否放电，是则，将索引及功率写入放电态储能数组dischargeESS；否则写入充电态数组chargeESS；遍历火电机组开关机状态及持续时间数组变量cGenState，根据火电机组状态是否开机将机组索引、平均煤耗写入待开机组资源池cGen2On，否则写入待关机组资源池cGen2OFF，清空缓冲待关机组资源池cGen2OFFBuff和缓冲待开机组资源池cGen2OnBuff。4.根据权利要求1所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，所述基于规则的火电机组开关机决策包括：针对每一个仿真时段，计算当前时段净负荷，更新待开机组资源池cGen2On、待关机组资源池cGen2OFF；净负荷小于火电机组总最小出力，则按照设定规则在火电机组关机、储能功率调整及VRE弃电量间进行决策，以实现火电机组关机决策；净负荷大于火电机组总最大出力，则按照设定规则在火电机组关机、储能功率调整及VRE弃电量间进行决策，以实现火电机组开机决策。5.根据权利要求4所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，针对每一个仿真时段，计算当前时段净负荷，更新待开机组资源池cGen2On、待关机组资源池cGen2OFF包括：检测缓冲待关机组资源池cGen2OFFBuff是否非空，若是则逐行减少其锁定时间，并在锁定时间到零时，将对应机组索引及平均成本信息写入待关机组资源池cGen2OFF，并清空缓冲待关机组资源池cGen2OFFBuff中相应机组记录；检测缓冲待开机组资源池cGen2ONBuff是否非空，若是则逐行减少其锁定时间，并在锁定时间到零时，将对应机组索引及平均成本信息写入待开机组资源池cGen2ON，并清空缓冲待开机组资源池cGen2ONBuff中相应机组记录。6.根据权利要求4所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，净负荷等于系统总负荷加上储能总充电功率减去VRE机组总出力：根据火电机组开关机状态及上一步出力，计算已开火电机组总最小出力Pcmin和总最大出力Pcmax，公式如下：式中，pgi0为上一步火电机组出力，为第i台火电机组在调度步长下允许的向上和向下最大功率变化量，/＞为第i台火电机组最小额定出力和最大额定出力，min为求最小值函数，max为求最大值函数。7.根据权利要求4所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，按照设定规则在火电机组关机、储能功率调整及VRE弃电量间进行决策，以实现火电机组关机决策包括：储能功率调整：先判断是否有储能放电，逐一减少储能放电功率，并更新净负荷，重新检测启动条件，直至不满足启动条件或所有储能停止放电；进一步判断储能充电功率是否达到最大，逐一增加储能充电功率，并更新净负荷Plnet，重新检测启动条件，直至不满足启动条件或所有储能以最大功率充电；火电机组关机决策：若储能功率调整后，仍满足启动条件，则进一步进行火电关机决策，先检测待关机组资源池cGen2OFF是否非空，若非空则选择运行成本最大的火电机组关机，并将关闭火电机组索引写入缓冲待开机组资源池cGen2ONBuff，更新总最小出力Pcmin，重新检测启动条件，直至不满足启动条件或待关机组资源池cGen2OFF变为空；VRE机组弃电决策：若储能功率调整与火电机组关机后仍满足启动条件，则进一步根据VRE机组最大出力进行弃电，直至启动条件不满足。8.根据权利要求4所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，所述按照设定规则在火电机组关机、储能功率调整及VRE弃电间进行决策，以实现火电机组开机决策包括：VRE机组弃电决策：若VRE机组弃电不为零，则按VRE机组最大出力等比例减少弃电，并更新净负荷，重新检测启动条件，直至决策条件不满足或弃电为零；储能功率调整：先判断是否有储能充电，若是则逐一减少充电功率，并更新净负荷，重新检测启动条件，直至不满足启动条件或所有储能停止充电；进一步判断储能放电功率是否达到最大，逐一增加储能放电功率，并更新净负荷Plnet，重新检测启动条件，直至不满足启动条件或所有储能以最大功率放电；火电机组开机决策：若储能功率调整后，仍满足启动条件，则进一步进行火电开机决策，先检测待开机组资源池cGen2ON是否非空，若非空则选择运行成本最小的机组开机，并将开启机组索引写入缓冲待关机组资源池cGen2OFFBuff，更新总最大出力Pcmax，重新检测启动条件，直至不满足启动条件或待开机组资源池cGen2ON变为空。9.根据权利要求1所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，所构建出力优化OPF模型目标函数为其中，f1＝fp1+fr1+flc1，flc1＝zplc,t，其中，分别为第t时段第i台火电机组有功出力及其提供的上、下备用和第t时段切负荷总量，λcoal，λCO2分别为煤炭价格和碳排放价格，/＞第i台火电机组正备用、负备用成本，，z为切负荷单位罚金，plc,t为第t时段切负荷总量。10.根据权利要求1所述的融合规则与优化算法的电力系统快速生产模拟方法，其特征在于，所构建出力优化OPF模型约束条件包括：当前功率平衡约束：pgi、pwj、pdk、pEm为当前时刻第i台火电机组、第j台VRE机组、第k个负荷、第m个储能的功率；当前旋转备用需求约束：式中，为当前时刻第i台火电机组提供的上备用和下备用，L+,L-,W+,W-分别为负荷和VRE机组出力预留的备用要求系数；当前火电机组出力约束：式中，为第i台火电机组当前时段的最小和最大出力，计算公式为：当前火电机组备用约束：当前VRE机组出力约束：式中，为第j台VRE机组在当前时刻的最大出力；当前储能功率约束：为第m个储能最大充电和放电功率；当前储能能量平衡约束：EEm＝EEm,0+pEmΔT，EEm0，EEm分别为第m个储能上一时段和当前时段的电量，ΔT为优化调度时间步长，/＞为第m个储能允许的最小和最大电量；当前线路潮流约束：和/＞为第l条线路实时功率和允许通过的最小、最大功率。
说明书desc
技术领域本发明涉及电网运行规划领域，尤其涉及一种融合规则与优化算法的电力系统快速生产模拟方法。背景技术21世纪以来，能源危机与气候问题日益凸显，推动能源系统转型实现能源的绿色低碳利用成为发展趋势，以风电、光伏为代表的新能源将逐渐替代传统火力发电成为电能供应主体，但新能源的随机性与波动性给电力系统的源荷平衡、稳定控制等问题带来显著挑战。优化电力系统中传统电源、风光电源、储能等运行特性各异元件的容量及位置，保证供电充裕性与可靠性要求同时降低经济成本是新时代电力系统规划需要解决的主要问题。规划过程中必须合理评价所规划方案的运行性能指标，综合考虑建设成本与运行性能实现方案优选。传统电力系统规划主要采用基于典型场景评价运行指标，但风光储元件加入导致运行场景复杂多样，典型场景代表性降低而影响了评价准确度。为尽可能准确计算规划方案的运行指标，基于逐时段仿真的生产模拟生成运行基础数据，进而计算运行指标逐渐成为主流方法。然而，基于逐时段仿真的生产模拟虽然可支撑计算准确运行指标，但会显著增加计算量而限制其应用于较大规模系统。特别是，电力系统规划需要扫描对比数百甚至更多种设计方案，基于逐时段仿真的生产模拟评价运行指标将显著增加规划问题求解时间，限制了规划方法的应用范围。如何加速生产模拟计算速度，实现运行指标的快速评估成为嵌入生产模拟规划方法推广应用的关键。发明内容为了解决上述技术问题或者至少部分地解决上述技术问题，本发明提供一种融合规则与优化算法的电力系统快速生产模拟方法。本发明提供一种融合规则与优化算法的电力系统快速生产模拟方法，根据生产模拟对象系统参数和对象系统初始状态设置开关机决策用资源池变量，其中，生产模拟对象系统参数包括：网架参数、负荷参数、火电机组参数、VRE机组参数、储能参数；读取或按规则生成火电机组开关机状态及持续时间、储能充放电功率，为生产模拟提供火电机组及储能初始状态，继而根据火电机组和储能初始状态将火电机组启停决策资源池初始化；根据当前时段各节点负荷、各VRE机组最大出力、火电机组启停决策资源池变量决定火电机组开关机状态、储能充放电功率和VRE机组弃电功率，以实现基于规则的火电机组开关机决策；构建当前时刻下考虑网络约束、VRE机组出力上限约束、已开火电机组出力上下限约束、备用约束和储能约束，以运行成本最小为目标的出力优化OPF模型并求解；将每个时段OPF求解结果按照时间顺序串联，从而得到所有仿真时段各类设备状态及出力。优选地，读取或按规则生成火电机组开关机状态及持续时间、储能充放电功率，为生产模拟提供火电机组及储能初始状态包括：若初始状态通过读入获取，则直接将读取的初始状态写入每个火电机组开关机状态及持续时间数组变量cGenState及储能充放电功率数组ESSP；若初始状态由内部生成，则包括：设置储能充放电功率数组ESSP全部为零；读取初始时刻所有节点负荷及所有VRE机组最大出力，分别计算二者之和并作差形成VRE机组完全出力时净负荷；采用下式计算火电机组平均运行煤耗，并按由小到大排序：式中，pgi,rate为第i台火电机组的平均煤耗和额定功率，ai,bi,ci分别为第i台火电机组煤耗特性的二次、一次和常数项系数；根据平均煤耗大小逐一开启火电机组，直至净负荷功率位于所开机组最小功率和与最大功率和之间，根据开机情况设置火电机组开关机状态及持续时间数组变量cGenState。优选地，所述继而根据火电机组和储能初始状态将火电机组启停决策资源池初始化遍历储能充放电功率数组ESSP，根据各行数据是否放电，是则，将索引及功率写入放电态储能数组dischargeESS；否则写入充电态数组chargeESS；遍历火电机组开关机状态及持续时间数组变量cGenState，根据火电机组状态是否开机将机组索引、平均煤耗写入待开机组资源池cGen2On，否则写入待关机组资源池cGen2OFF，清空缓冲待关机组资源池cGen2OFFBuff和缓冲待开机组资源池cGen2OnBuff。优选地，所述基于规则的火电机组开关机决策包括：针对每一个仿真时段，计算当前时段净负荷，更新待开机组资源池cGen2On、待关机组资源池cGen2OFF；净负荷小于火电机组总最小出力，则按照设定规则在火电机组关机、储能功率调整及VRE弃电量间进行决策，以实现火电机组关机决策；净负荷大于火电机组总最大出力，则按照设定规则在火电机组关机、储能功率调整及VRE弃电量间进行决策，以实现火电机组开机决策。优选地，针对每一个仿真时段，计算当前时段净负荷，更新待开机组资源池cGen2On、待关机组资源池cGen2OFF包括：检测缓冲待关机组资源池cGen2OFFBuff是否非空，若是则逐行减少其锁定时间，并在锁定时间到零时，将对应机组索引及平均成本信息写入待关机组资源池cGen2OFF，并清空缓冲待关机组资源池cGen2OFFBuff中相应机组记录；检测缓冲待开机组资源池cGen2ONBuff是否非空，若是则逐行减少其锁定时间，并在锁定时间到零时，将对应机组索引及平均成本信息写入待开机组资源池cGen2ON，并清空缓冲待开机组资源池cGen2ONBuff中相应机组记录。优选地，净负荷等于系统总负荷加上储能总充电功率减去VRE机组总出力：根据火电机组开关机状态及上一步出力，计算已开火电机组总最小出力Pcmin和总最大出力Pcmax，公式如下：式中，pgi0为上一步火电机组出力，为第i台火电机组在调度步长下允许的向上和向下最大功率变化量，/＞为第i台火电机组最小额定出力和最大额定出力，min为求最小值函数，max为求最大值函数。优选地，按照设定规则在火电机组关机、储能功率调整及VRE弃电量间进行决策，以实现火电机组关机决策包括：储能功率调整：先判断是否有储能放电，逐一减少储能放电功率，并更新净负荷，重新检测启动条件，直至不满足启动条件或所有储能停止放电；进一步判断储能充电功率是否达到最大，逐一增加储能充电功率，并更新净负荷Plnet，重新检测启动条件，直至不满足启动条件或所有储能以最大功率充电；火电机组关机决策：若储能功率调整后，仍满足启动条件，则进一步进行火电关机决策，先检测待关机组资源池cGen2OFF是否非空，若非空则选择运行成本最大的火电机组关机，并将关闭火电机组索引写入缓冲待开机组资源池cGen2ONBuff，更新总最小出力Pcmin，重新检测启动条件，直至不满足启动条件或待关机组资源池cGen2OFF变为空；VRE机组弃电决策：若储能功率调整与火电机组关机后仍满足启动条件，则进一步根据VRE机组最大出力进行弃电，直至启动条件不满足。优选地，所述按照设定规则在火电机组关机、储能功率调整及VRE弃电量间进行决策，以实现火电机组开机决策包括：VRE机组弃电决策：若VRE机组弃电不为零，则按VRE机组最大出力等比例减少弃电，并更新净负荷，重新检测启动条件，直至决策条件不满足或弃电为零；储能功率调整：先判断是否有储能充电，若是则逐一减少充电功率，并更新净负荷，重新检测启动条件，直至不满足启动条件或所有储能停止充电；进一步判断储能放电功率是否达到最大，逐一增加储能放电功率，并更新净负荷Plnet，重新检测启动条件，直至不满足启动条件或所有储能以最大功率放电；火电机组开机决策：若储能功率调整后，仍满足启动条件，则进一步进行火电开机决策，先检测待开机组资源池cGen2ON是否非空，若非空则选择运行成本最小的机组开机，并将开启机组索引写入缓冲待关机组资源池cGen2OFFBuff，更新总最大出力Pcmax，重新检测启动条件，直至不满足启动条件或待开机组资源池cGen2ON变为空。优选地，出力优化OPF模型，目标函数为其中，f1＝fp1+fr1+flc1，flc1＝zplc,t，其中，pgi,t,plc,t分别为第t时段第i台火电机组有功出力及其提供的上、下备用和第t时段切负荷总量，λcoal，λCO2分别为煤炭价格和碳排放价格，第i台火电机组正备用、负备用成本，。优选地，出力优化OPF模型所遵循的约束条件包括：当前功率平衡约束：pgi、pwj、pdk、pEm为当前时刻第i台火电机组、第j台VRE机组、第k个负荷、第m个储能的功率；当前旋转备用需求约束：式中，为当前时刻第i台火电机组提供的上备用和下备用，L+,L-,W+,W-分别为负荷和VRE机组出力预留的备用要求系数；当前火电机组出力约束：式中，为第i台火电机组当前时段的最小和最大出力，计算公式为：当前火电机组备用约束：当前VRE机组出力约束：式中，为第j台VRE机组在当前时刻的最大出力；当前储能功率约束：为第m个储能最大充电和放电功率；当前储能能量平衡约束：EEm＝EEm,0+pEmΔT，EEm0，EEm分别为第m个储能上一时段和当前时段的电量，ΔT为优化调度时间步长，/＞为第m个储能允许的最小和最大电量；当前线路潮流约束：和/＞为第l条线路实时功率和允许通过的最小、最大功率。本发明实施例提供的上述技术方案与现有技术相比具有如下优点：典型日调度问题是一个混合整数规划问题，主要求解方法以分支定界法等方法为主，需要对多种离散方案组合进行筛选因而计算费时，且随离散变量数增加而用时快速增加。针对上述问题，本专利提出结合电力系统运行调度实际设计机组启停规则，基于规则确定机组启停状态而将典型日调度问题转化为连续线性规划问题，从而避免了离散变量的多种组合尝试，显著提高计算效率。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本发明的实施例，并与说明书一起用于解释本发明的原理。为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，对于本领域普通技术人员而言，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为基于滚动日调度的生产模拟的流程图；图2为本发明提供的融合经验规则与优化算法的电力系统快速生产模拟方法的流程图；图3为本发明提供的火电机组启停决策资源池初始化流程图；图4为本发明提供的基于规则的火电机组开关机决策图；图5为基于滚动日调度的生产模拟结果示意图；图6为本发明结果示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者装置中还存在另外的相同要素。电力系统生产模拟以电力系统运行调度为建模对象，即通过对电力系统调度过程的数学建模来模拟其运行过程，进而得到运行指标。由于电力系统实际运行通常以日为调度周期进行调度，因而生产模拟问题可转变为滚动日调度模拟。由图1可见，电力系统生产模拟就是在不断读取每日负荷、新能源最大出力等信息进行日机组组合与经济调度计算，并将每日计算结果组合作为设定时间段内的模拟结果，因此，日机组组合与经济调度是电力系统生产模拟核心。日机组组合与经济调度采用如下优化模型描述：目标函数为火电机组的煤耗成本、备用成本、启停机成本、碳排放成本之和最小，即其中，f＝fp+fr+fuc+flc，式中，fp、fr、fuc和flc分别为火电机组燃料及碳排费用、备用费用、启停费用和切负荷惩罚费用；pgi,t,plc,t分别为第t时段第i台火电机组有功出力及其提供的上、下备用和第t时段切负荷总量；vgi,t,/＞为第t时段第i台火电机组启动和停止标志，ai,bi,ci分别为第i台火电机组煤耗特性的二次、一次和常数项系数，/＞hi,si分别为第i台火电机组正备用、负备用、启动和关闭成本，λcoal，λCO2分别为煤炭价格和碳排放价格，z为切负荷单位罚金，Ωg,T分别为火电机组台数和仿真时段总数。所遵循的约束条件包括：时段功率平衡约束：pwj,t、pdk,t、pEm,t和为第t时段第j台波动性电源机组、第k个负荷、第m个储能的功率。Ωd,Ωw,ΩE分别为负荷总数、VRE机组总数和储能总数。旋转备用需求约束：式中，L+,L-,W+,W-分别为负荷和VRE机组出力预留的备用要求系数。火电机组出力约束：式中，为第i台火电机组的最小和最大额定出力，ugi,t为第i台火电机组状态。火电机组备用约束：火电机组爬坡约束：式中，为第i台火电机组在调度步长下允许的向上和向下最大功率变化量。火电机组最小启停持续时间约束：式中，TON,TOFF为第i台火电机组最小启动、停止持续时间。火电机组状态约束：vgi,t≥ugi,t-ugi,t-1，wgi,t≥ugi,t-1-ugi,t。VRE机组出力约束：式中，为第j台VRE机组在第t时段可能的最大出力。储能功率约束：式中，为第m个储能最大充电和放电功率。储能能量平衡约束：EEm,t＝EEm,t-1+pEm,t-1ΔT，式中，EEm,t为第m个储能在第t时时段的电量，ΔT为优化调度时间步长，通常为1小时，且假定储能充放电效率均为1。储能能量约束：式中，为第m个储能允许的最小和最大电量。线路潮流约束：式中，pl,t、和/＞为第l条线路实时功率和允许通过的最小、最大功率。综上，日机组组合与经济调度即为以目标函数为目标，以上述约束为约束的混合整数规划问题。上述规划问题决策变量包括：每个时刻下火电机组启停0-1变量，每个时段火电机组有功出力及其提供的上下备用功率、储能充放电功率、VRE机组出力、切负荷功率，且决策变量数随机组数目增加而增加，导致求解时间逐渐增加。因此，必须对原始优化问题进行适当简化而加快求解速度，适应规划方案优选的快速性需要。本发明提出的融合经验规则与优化算法的电力系统快速生产模拟方法先采用经验规则确定每个调度时段火电机组开关机状态，再结合开关机状态及上一步火电机组出力构建OPF问题，对每个时段重复上述过程，即可完成生产模拟。本发明方法不再以日为调度周期而是直接对设定时段内各时段进行逐段计算得到相应设备状态及出力，步骤包括：火电机组启停决策资源池初始化、基于规则的火电机组开关机决策、考虑网络与备用约束的OPF问题构建与求解、单时段模拟结果组合与结束判断4个环节。各步骤详述如下：step 1、火电机组启停决策资源池初始化。用于根据生产模拟对象系统参数和对象系统初始状态设置开关机决策用资源池变量，具体包括：读取生产模拟对象参数及设置、设置火电机组及储能初始状态、火电机组启停决策资源池初始化三个方面，细分为以下步骤，对应流程如图3所示：step 1.1、读取生产模拟对象系统参数及生产模拟设置。具体包括：读取生产模拟对象系统的网架参数，包括：节点编号、互联关系、线路阻抗及传输容量参数；读取生产模拟对象系统的负荷参数，包括：负荷接入位置、切负荷单位罚金、各点负荷曲线；读取生产模拟对象系统的火电机组参数，包括：火电机组接入位置，火电机组的最大、最小出力，火电机组最小开机、关机持续时间，火电机组上爬坡、下爬坡最大功率，火电机组正备用、负备用单位成本，火电机组煤耗特性一次、二次及常数项系数，火电机组开机和关机单次成本；读取生产模拟对象系统的VRE机组参数，包括：VRE机组接入位置，VRE机组最大出力曲线，VRE机组单位功率运行成本，VRE机组弃电单位罚金；读取生产模拟对象系统的储能参数，包括：储能接入位置，储能容量，储能最大充电、放电功率，储能允许的最大、最小荷电状态。读取生产模拟设置，包括：生产模拟步长、生产模拟时段数。step 1.2、设置火电机组及储能初始状态。读取或按规则生成火电机组开关机状态及持续时间、储能充放电功率，为生产模拟提供初始状态，包括：若初始状态通过读入获取，则直接将读取的初始状态写入每个火电机组开关机状态及持续时间数组变量cGenState及储能充放电功率数组ESSP，其中cGenState为二维数组，每行对应一台火电机组，第一列为机组启停状态，第二列为该状态锁定时间，ESSP为列向量，对应每个储能充放电功率。若初始状态由内部生成，则包括：设置储能充放电功率数组ESSP全部为零，即假定储能全部不工作；读取初始时刻所有节点负荷及所有VRE机组最大出力，分别计算二者之和并作差形成VRE机组完全出力时净负荷；采用下式计算火电机组平均运行煤耗，并按由小到大排序：式中，pgi,rate为第i台火电机组的平均煤耗和额定功率。根据平均煤耗大小逐一开启火电机组，直至净负荷功率位于所开机组最小功率和与最大功率和之间，根据开机情况设置火电机组开关机状态及持续时间数组变量cGenState。step 1.3、火电机组启停决策资源池初始化，主要根据储能充放电功率数组ESSP设置储能资源池变量：充电态数组chargeESS及放电态储能数组dischargeESS，根据火电机组开关机状态及持续时间数组变量cGenState设置火电机组资源池变量：待开机组资源池cGen2On、待关机组资源池cGen2OFF、缓冲待开机组资源池cGen2ONBuff、缓冲待关机组资源池cGen2OFFBuff数据资源池，具体包括：遍历储能充放电功率数组ESSP，根据各行数据是否放电是则，将索引及功率写入放电态储能数组dischargeESS；否则写入充电态数组chargeESS。遍历火电机组开关机状态及持续时间数组变量cGenState，根据火电机组状态将机组索引、平均煤耗写入待开机组资源池cGen2On，否则写入待关机组资源池cGen2OFF，清空cGen2OFFBuff和cGen2OnBuff。step 2、基于规则的火电机组开关机决策。主要功能是根据当前时段各节点负荷、各VRE机组最大出力、火电机组启停决策资源池变量决定火电机组开关机状态、储能充放电功率和VRE机组弃电功率。如图4所示包括启停决策资源池变量状态更新、关机决策和开机决策三个环节，对应流程，具体的，参阅图4所示，包括：step 2.1、火电机组启停决策资源池变量状态更新。针对每一个仿真时段，计算当前时段净负荷，更新待开机组资源池cGen2On、待关机组资源池cGen2OFF，为调整储能充放电功率、弃电功率及火电开关机状态提供输入，具体包括：检测缓冲待关机组资源池cGen2OFFBuff是否非空，若是则逐行减少其锁定时间，并在锁定时间到零时，将对应机组索引及平均成本信息写入待关机组资源池cGen2OFF，并清空cGen2OFFBuff中相应机组记录；检测缓冲待开机组资源池cGen2ONBuff是否非空，若是则逐行减少其锁定时间，并在锁定时间到零时，将对应机组索引及平均成本信息写入待开机组资源池cGen2ON，并清空cGen2ONBuff中相应机组记录。step 2.2、火电机组关机决策。根据净负荷与火电机组总最小出力，在火电机组关机、储能功率调整及VRE弃电间进行决策，原则是尽可能减少弃电与火电关机次数，具体流程包括：决策启动：判断净负荷Plnet是否小于已开火电机组总最小出力Pcmin，若是则启动决策流程，如否则进入step2.3。读取当前日负荷曲线、各站点风电/光伏最大出力曲线；假定储能保持上一步充放电功率，VRE机组无弃电，用下式计算净负荷Plnet，即净负荷等于系统总负荷加上储能总充电功率减去VRE机组总出力：根据火电机组开关机状态及上一步出力，计算已开火电机组总最小出力Pcmin和总最大出力Pcmax，公式如下：式中，pgi0为上一步火电机组出力，min为求最小值函数，max为求最大值函数。具体的，按照设定规则在火电机组关机、储能功率调整及VRE弃电间进行决策，以实现火电机组关机决策包括：储能功率调整：根据DischargeESS数组是否非空先判断是否有储能放电，逐一减少储能放电功率，并使用更新净负荷，重新检测启动条件，直至不满足启动条件或所有储能停止放电；进一步判断储能充电功率是否达到最大，逐一增加储能充电功率，并使用式/＞更新净负荷Plnet，重新检测启动条件，直至不满足启动条件或所有储能以最大功率充电；火电机组关机决策：若储能功率调整后，仍满足启动条件，则进一步进行火电关机决策，先检测待关机组资源池cGen2OFF是否非空，若非空则选择运行成本最大的火电机组关机，并将关闭火电机组索引写入缓冲待开机组资源池cGen2ONBuff，进一步调用更新总最小出力Pcmin，重新检测启动条件，直至不满足启动条件或待关机组资源池cGen2OFF变为空；VRE机组弃电决策：若储能功率调整与火电机组关机后仍满足启动条件，则进一步根据VRE机组最大出力进行弃电，直至启动条件不满足。step 2.3、火电机组开机决策。根据净负荷与火电机组总最大出力，在火电机组关机、储能功率调整及VRE机组弃电间进行决策，原则是尽可能减少弃电与火电开机次数，具体流程为：启动：判断净负荷Plnet是否大于开火电机组总最大出力Pcmax，若是则启动决策流程，如否则进入step 3。具体的，按照设定规则在火电机组关机、储能功率调整及VRE弃电间进行决策，以实现火电机组开机决策包括：VRE机组弃电决策：若VRE机组弃电不为零，则按VRE机组最大出力等比例减少弃电，并使用更新净负荷，重新检测启动条件，直至决策条件不满足或弃电为零；储能功率调整：先判断是否有储能充电，若是则逐一减少充电功率，并使用更新净负荷，重新检测启动条件，直至不满足启动条件或所有储能停止充电；进一步判断储能放电功率是否达到最大，逐一增加储能放电功率，并使用/＞更新净负荷Plnet，重新检测启动条件，直至不满足启动条件或所有储能以最大功率放电；火电机组开机决策：若储能功率调整后，仍满足启动条件，则进一步进行火电开机决策，先检测待开机组资源池cGen2ON是否非空，若非空则选择运行成本最小的机组开机，并将开启机组索引写入缓冲待关机组资源池cGen2OFFBuff，进一步调用更新总最大出力Pcmax，重新检测启动条件，直至不满足启动条件或cGen2ON变为空。step 3、考虑网络与备用约束的OPF模型构建与求解。主要功能是根据当前时段各节点负荷、各VRE机组最大出力、储能运行边界、处于开机状态的火电机组出力边界及网络约束构建OPF模型并求解确定所有机组、储能最大出力，主要包括模型构建及求解两大环节，具体如下：OPF模型构建：构建当前时刻下考虑网络约束、VRE机组出力上限约束、已开火电机组出力上下限约束、备用约束和储能约束，以运行成本最小为目标的出力优化模型，即其中，f1＝fp1+fr1+flc1，flc1＝zplc,t，OPF模型仅针对当前时刻，且不用考虑机组启停成本。本发明所遵循的约束条件包括：当前功率平衡约束：pgi、pwj、pdk、pEm为当前时刻第i台火电机组、第j台VRE机组、第k个负荷、第m个储能的功率。当前旋转备用需求约束：/＞式中，为当前时刻第i台火电机组提供的上备用和下备用当前火电机组出力约束：式中，为第i台火电机组当前时段的最小和最大出力，计算公式为：当前火电机组备用约束：当前VRE机组出力约束：式中，为第j台VRE机组在当前时刻的最大出力。当前储能功率约束：当前储能能量平衡约束：EEm＝EEm,0+pEmΔT，当前线路潮流约束：OPF模型求解：上述模型为目标函数二次型的连续规划问题，采用Cplex商用求解器求解，得到各设备出力。step 4、单时段模拟结果组合与结束判断。主要功能是将每个时段OPF求解结果按照时间顺序串联，从而得到所有仿真时段各类设备状态及出力；同时判断当前仿真时段是否达到设置的最大时段数，并在达到最大仿真时段数时停止生产模拟而退出。以某省级电网年度生产模拟为例验证本专利方法效果，该电网以500kV及1000kV电压等级电网为骨架，含变电站78座、500kV电厂12座，总负荷1.22亿kW，火电及核电装机7066万kW共151台，500kV及以上线路200条，风电装机6000万kw，光伏装机6000万kW，储能装机1400万kW。对该系统进行24*30＝720小时的月度生产模拟，通过对比滚动日调度模拟和专利方法说明本专利方法效果。对上述省级电网按图1所示调度滚动日调度的生产模拟流程进行计算，构建日内机组组合与经济调度模型，并采用Cplex商用求解器进行求解，得到每日不同时间段机组启停状态及出力情况如图5所示，图中自上向下给出了：火电机组出力、风电机组出力、光伏出力、储能出力情况。进一步采用本专利方法对该升级电网进行逐时段建模求解，共需进行720次OPF模型构建与求解，对每个OPF问题首先确定机组开启及关闭状态，构建OPF模型，采用Cplex商用求解器求解OPF问题得到各设备出力情况如图6所示。由图5和图6可见，两种生产模拟方法有较好一致性，特别是风电、光伏出力结果较为相似，同一计算平台上两种生产模拟用时分别为1370.16s和12.29s，基于两种生产模拟结果计算的运行指标见下表：上表数据表明：本专利所提生产模拟方法与滚动日调度方法下相比燃料成本下降12％，启动成本上升为7.5倍，停机成本上升为8.3倍，总成本增加9.8％。弃风率从23％降低为14％，弃光率25％降低为8％。上述指标说明本专利计算方法与滚动日调度法相比有着相近的计算结果，用于后期规划的运行成本误差在10％左右，启停成本增加较多而风电光伏消纳量有所提升，说明基于规则的启停方式倾向于更多启停机组而消纳风光电源。然而，本专利所提方法时间仅为滚动日调度方法的1％左右，可显著提升计算效率，因而更适合用于大规模系统的生产模拟。以上所述仅是本发明的具体实施方式，使本领域技术人员能够理解或实现本发明。对这些实施例的多种修改对本领域的技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所示的这些实施例，而是要符合与本文所申请的原理和新颖特点相一致的最宽的范围。
