标题title
一种高可疑IP判定方法
摘要abst
本发明提供的一种高可疑IP判定方法，所述判定方法包括：将用户登录和访问日志中的用户IP按照地址来源区分境内、境外和云IP三类；使用多种用户IP的类型访问多个算子，结合异常行为特征库进行比对和匹配，将不同算子筛选出可疑IP进行归并、去重后输出最终的可疑IP，并导入IP黑名单。通过多种IP类型访问用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选等算子，结合异常行为特征库进行比对和匹配，筛选出可疑攻击IP。
权利要求书clms
1.一种高可疑IP判定方法，其特征在于，所述判定方法包括：将用户登录和访问日志中的用户IP按照地址来源区分境内、境外和云IP三类；使用多种用户IP的类型访问多个算子，结合异常行为特征库进行比对和匹配，将不同算子筛选出可疑IP进行归并、去重后输出最终的可疑IP，并导入IP黑名单。2.根据权利要求1所述的一种高可疑IP判定方法，其特征在于，所述多个算子具体包括：用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选。3.根据权利要求2所述的一种高可疑IP判定方法，其特征在于，所述多种IP类型访问用户分析算子将10分钟内通过两类或以上IP地址来源登录或访问的用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。4.根据权利要求2所述的一种高可疑IP判定方法，其特征在于，所述非白名单访问用户分析的算子将使用过域外IP或云IP登录访问的非白名单用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。5.根据权利要求2所述的一种高可疑IP判定方法，其特征在于，所述访问多个系统的用户分析算子将访问应用系统数量大于5个的用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。6.根据权利要求2所述的一种高可疑IP判定方法，其特征在于，所述多地域登录用户分析算子将使用超过3个境内地域IP的用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。7.根据权利要求2所述的一种高可疑IP判定方法，其特征在于，所述异常IP深度筛选算子将访问IP属于黑名单的用户筛选出来，将筛选出的用户使用过的所有IP进行输出。
说明书desc
技术领域本发明涉及网络安全领域，尤其涉及一种高可疑IP判定方法。背景技术网络安全威胁日益严峻，如何有效的判定可疑攻击IP是开展有效防御的重要前提。尽管通过将用户访问日志直接与异常行为特征库进行比对，发现一些可疑IP。但却会带来诸如误报率高、耗时较长等问题。发明内容鉴于上述问题，提出了本发明以便提供克服上述问题或者至少部分地解决上述问题的一种高可疑IP判定方法。根据本发明的一个方面，提供了一种高可疑IP判定方法，所述判定方法包括：将用户登录和访问日志中的用户IP按照地址来源区分境内、境外和云IP三类；使用多种用户IP的类型访问多个算子，结合异常行为特征库进行比对和匹配，将不同算子筛选出可疑IP进行归并、去重后输出最终的可疑IP，并导入IP黑名单。可选的，所述多个算子具体包括：用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选。可选的，所述多种IP类型访问用户分析算子将10分钟内通过两类或以上IP地址来源登录或访问的用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。可选的，所述非白名单访问用户分析的算子将使用过域外IP或云IP登录访问的非白名单用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。可选的，所述访问多个系统的用户分析算子将访问应用系统数量大于5个的用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。可选的，所述多地域登录用户分析算子将使用超过3个境内地域IP的用户筛选出来，将筛选出来的用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。可选的，所述异常IP深度筛选算子将访问IP属于黑名单的用户筛选出来，将筛选出的用户使用过的所有IP进行输出。本发明提供的一种高可疑IP判定方法，所述判定方法包括：将用户登录和访问日志中的用户IP按照地址来源区分境内、境外和云IP三类；使用多种用户IP的类型访问多个算子，结合异常行为特征库进行比对和匹配，将不同算子筛选出可疑IP进行归并、去重后输出最终的可疑IP，并导入IP黑名单。通过多种IP类型访问用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选等算子，结合异常行为特征库进行比对和匹配，筛选出可疑攻击IP。上述说明仅是本发明技术方案的概述，为了能够更清楚了解本发明的技术手段，而可依照说明书的内容予以实施，并且为了让本发明的上述和其它目的、特征和优点能够更明显易懂，以下特举本发明的具体实施方式。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1为本发明实施例提供的一种高可疑IP判定方法的流程图。具体实施方式下面将参照附图更详细地描述本公开的示例性实施例。虽然附图中显示了本公开的示例性实施例，然而应当理解，可以以各种形式实现本公开而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更透彻地理解本公开，并且能够将本公开的范围完整的传达给本领域的技术人员。本发明的说明书实施例和权利要求书及附图中的术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元。下面结合附图和实施例，对本发明的技术方案做进一步的详细描述。如图1所示，本发明实施例提供了一种高可疑IP研判方法，在本发明实施例中，日志标准化化、归一化处理模块将用户登录日志和访问日志统一处理后，分发给多种IP类型访问用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选等5个算子，各算子输出的IP进行归并、去重后导入IP黑名单。步骤101：将用户登录日志和业务访问日志等接入到“日志标准化、归一化处理”模块，对各类日志去重和标准化后，将处理后的日志分发给多种IP类型访问用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选等5个算子，分别执行步骤102、103、104、105、106。步骤102：将10分钟内通过两类或以上IP地址来源登录或访问的用户筛选出来，将这些用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。步骤103：先将使用过域外IP或云IP登录访问的非白名单用户筛选出来，再将这些用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。步骤104：先将访问应用系统数量大于5个的用户筛选出来，再将这些用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。步骤105：先将使用超过3个以上境内地域IP的用户筛选出来，再将这些用户的访问行为日志与异常行为特征库进行比对和匹配，将比中日志中的IP进行输出。步骤106：先将访问IP属于黑名单的用户筛选出来，再将该类用户使用过的所有IP进行输出。步骤107：将步骤102、103、104、105、106的输出结果进行归并、去重后，导入IP黑名单。本发明提出一种高可疑IP判定方法，先从攻击者可能采取的登录和访问手段出发，通过多种IP类型访问用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选等算子，先将可能的攻击用户日志快速收敛，在基础上再与异常行为特征库进行比对和匹配，最后将所有五种算子输出的IP进行归并和去重，输出可信度高的可疑IP。有益效果：分别通过多种IP类型访问用户分析、非白名单访问用户分析、访问多个系统的用户分析、多地域登录用户分析和异常IP深度筛选等算子，先将可能的攻击用户日志快速收敛，在基础上再与异常行为特征库进行比对和匹配，最后将所有五种算子输出的IP进行归并和去重，输出可信度高的可疑IP。以上的具体实施方式，对本发明的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上仅为本发明的具体实施方式而已，并不用于限定本发明的保护范围，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
