标题title
含新能源和充电站的主动配电网动态无功优化方法及系统
摘要abst
本发明公开了一种含新能源和充电站的主动配电网动态无功优化方法及系统，该方法涉及如下步骤：获得次日每小时负荷变化率、新能源有功出力和电动汽车充电负荷；确定动态无功优化的目标函数和约束条件；将目标函数无量纲化并通过层次分析法转化为单目标函数；采用基于划分的聚类算法得到电容器组的动作时刻；提出电容器组投入组数优化—新能源、电动汽车充电站和SVC联合优化的两阶段静态无功优化思路，确定最终无功补偿装置的投入量。本发明将动态无功优化转变成几个静态无功优化，减小了问题的求解规模，加速了求解速度，同时，在满足无功补偿装置的动作次数的约束下，能够最大限度地减小网损，提高系统稳定性和电压质量。
权利要求书clms
1.一种含新能源和充电站的主动配电网动态无功优化方法，其特征在于，包含如下步骤：步骤S1：获得次日的居民用电负荷、新能源有功出力和电动汽车充电负荷；步骤S2：确定动态无功优化的目标函数和约束条件；以有功网损最小、电压偏差最小和电压稳定性最优为目标函数，以功率平衡、系统电压电流上下限、无功补偿装置无功输出量上下限和电容器组最大动作次数为约束；步骤S3：将目标函数无量纲化并通过层次分析法转化为单目标函数；步骤S4：以步骤S1所得数据作为电容器组动作时段划分的依据，采用基于划分的聚类算法得到电容器组的动作时段；步骤S5：第一阶段进行静态无功优化的单目标函数求解，根据电容器组的动作时段确定各时间段内电容器组的投入组数；第二阶段以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量；输出动态无功优化的结果；所述步骤S2中， 目标函数包括：有功损耗最小目标函数：;式中，N为系统节点总数；为支路/＞的电导；/＞为/＞时段从支路/＞首端流出的有功功率，/＞为/＞时段从支路/＞首端流出的无功功率；/＞为/＞时段支路/＞的首端电压；/＞为节点/＞的节点集合，支路/＞为节点/＞与节点/＞之间的支路；/＞为取实部操作；电压偏差最小目标函数：;式中，为/＞时段节点/＞的电压幅值，/＞为/＞时段节点/＞的电压上限 ，/＞为/＞时段节点/＞的电压下限，/＞为节点额定电压；电压稳定性最优目标函数：;;式中，为支路/＞的阻抗，/＞为支路/＞的导纳；/＞为系统支路集合，/＞为/＞时段支路的电压稳定性指标。2.根据权利要求1所述的一种含新能源和充电站的主动配电网动态无功优化方法，其特征在于，所述步骤S2中，所述约束条件包括：功率平衡约束：;式中，、/＞、/＞依次为/＞时段注入节点/＞的大电网有功功率、风电机组有功功率和光伏电站有功功率；/＞、/＞、/＞依次为/＞时段在节点/＞消耗的负荷的有功功率、电动汽车充电站的充电功率和系统有功损耗；/＞、/＞、/＞、/＞依次为/＞时段注入节点/＞的大电网无功功率、风电机组无功功率、光伏电站无功功率和可投切电容器组无功功率；/＞、/＞分别为/＞时段在节点/＞消耗的负荷的无功功率和系统的无功损耗；、/＞、/＞、/＞依次为安装风电机组、光伏电站、可投切电容器组及电动汽车充电站的节点集合；电压电流约束：;式中，为/＞时段支路/＞的电流，/＞、/＞分别为支路/＞的电流上、下限；/＞为/＞时段节点/＞的电压幅值，/＞、/＞分别为节点/＞的电压幅值上、下限；控制变量约束：;式中，、/＞分别为/＞时段节点/＞的风电机组无功功率输出上、下限；/＞、分别为/＞时段节点/＞的光伏电站无功功率输出上、下限；/＞、/＞分别为节点/＞的可投切电容器组无功功率补偿上、下限；/＞为/＞时段节点/＞的SVC无功功率，/＞、分别为节点/＞的SVC无功功率补偿上、下限；电动汽车充电站功率约束：式中：为/＞时段充电站在节点/＞所耗的有功功率，/＞、/＞分别为/＞时段充电站在节点/＞所耗最小和最大有功功率；/＞为/＞时段充电站在节点/＞注入的无功功率，、/＞分别为/＞时段充电站在节点/＞注入的最小和最大无功功率；/＞为/＞时段节点/＞的充电站容量；电容器组动作次数约束：;式中，为/＞时段节点/＞处电容器组的投切量大可投切次数，/＞为/＞时段节点/＞处电容器组的投切量大可投切次数；/＞为异或运算符；/＞为日最大可投切次数。3.根据权利要求2所述的一种含新能源和充电站的主动配电网动态无功优化方法，其特征在于，所述步骤S3中，采用极差标准法对目标函数进行无量纲化：;式中，为无量纲化之后的数据；/＞为评价策略，/＞为指标，/＞为评价策略/＞的指标/＞数值；/＞、/＞分别为所有评价策略的指标/＞的最大值和最小值；无量纲化之后，采用层次分析法把多个目标函数转化为单目标函数：;式中，为指标/＞的权重系数；/＞为层次分析法处理之后的目标函数；/＞为无量纲化后指标/＞的数值。4.根据权利要求3所述的一种含新能源和充电站的主动配电网动态无功优化方法，其特征在于，所述步骤S4中，在步骤S1的所获得的数据基础上，将全天划分为T个时段，以每个时段的风电机组有功出力、光伏电站有功出力、居民用电负荷和电动汽车充电站的充电负荷作为影响聚类结果的因数，全天的功率序列表述为：;;;;其中，为第/＞台风电机组全天有功出力序列，/＞为/＞时段第/＞台风电机组有功出力；/＞为第/＞台光伏电站全天有功出力序列，/＞为/＞时段第/＞台光伏电站有功出力；/＞为全天居民用电负荷序列，/＞为/＞时段居民用电负荷；/＞为第/＞个电动汽车充电站全天充电负荷序列，/＞为/＞时段第/＞个电动汽车充电站充电负荷；/＞分别风电机组、光伏电站和电动汽车充电站的个数，/＞，/＞为时段总数。5.根据权利要求4所述的一种含新能源和充电站的主动配电网动态无功优化方法，其特征在于，所述步骤S4中，将每个时段的风电机组、光伏电站有功出力、居民用电负荷和电动汽车充电站的充电负荷归为一个样本点，维度为，其表达式为：;式中：为时段t的样本点。6.根据权利要求5所述的一种含新能源和充电站的主动配电网动态无功优化方法，其特征在于，所述步骤S4中，采用k-medoids算法对样本点进行聚类，具体操作为：i)选取个样本点作为聚类中心；ii)计算样本点到聚类中心的欧式距离，距离的大小反映数据之间的相似度，计算公式为：；式中，，/＞为时段t的样本点到第/＞个聚类中心/＞的相似度，sqrt表示开方操作，/＞为第/＞个聚类中心的第/＞台风电机组有功出力，/＞为第/＞个聚类中心的第/＞台光伏电站有功出力，/＞为第/＞个聚类中心的第/＞个电动汽车充电站充电负荷，/＞为第个聚类中心的居民用电负荷；距离计算完成之后，将距离质心最近的样本点归类为该质心所在的簇；iii)分别将簇中每个点作为聚类中心，计算簇内其余各点与聚类中心的总距离，然后选择总距离最小的点作为新的聚类中心：iv)重复ii)、iii)步骤，直至聚类中心位置不再变化；聚类完成之后，所有样本点均被归类到相应的簇中，其结果为：；式中，表示第/＞个簇中的第/＞个样本点，/＞、/＞、/＞表示第1、/＞、k个簇中的样本个数，/＞、/＞、表示第1、/＞、k个簇的样本集合，且/＞；将同一簇中相邻时间段的样本合并为一个时段，合并后的时段即为电容器组的动作时间段，若合并后的时间段数大于电容器组的最大可投切次数/＞，则进行二次分段，具体操作为：计算分段后相邻时间段样本点之间的欧式距离，并将距离从小到大排序，然后根据该次序依次将相邻时间段合并，直到/＞；无功优化时，合并后每个时段中电容器组的投入次数固定，在各时间段内确定电容器组的投入组数，再对一天中/＞个时段进行静态无功优化，而无需考虑电容器组的动作次数约束。7.根据权利要求6所述的一种含新能源和充电站的主动配电网动态无功优化方法，其特征在于，所述步骤S5中：第一阶段进行静态无功优化的单目标函数求解，确定各时间段内电容器组的投入组数；第一阶段的静态无功优化同时包含离散型变量和连续型变量，采用离散型变量和连续型变量分离的协调优化算法求解；优化后各时段电容器组的无功补偿序列为：；式中：为聚类后第/＞个时间段投入的电容器组数, /＞；/＞为第/＞个时间段包含的小时数，且/＞；第二阶段，保持电容器组的投入组数不变，以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量。8.含新能源和充电站的主动配电网动态无功优化系统，其特征在于，包括数据获取模块、单目标无功优化模块、聚类模块和无功优化计算模块，所述数据获取模块获得次日的居民用电负荷、新能源有功出力和电动汽车充电负荷；单目标无功优化模型模块确定动态无功优化的目标函数和约束条件；以有功网损最小、电压偏差最小和电压稳定性最优为目标函数，以功率平衡、系统电压电流上下限、无功补偿装置无功输出量上下限和电容器组最大动作次数为约束；单目标无功优化模型模块将目标函数无量纲化并通过层次分析法转化为单目标函数；所述聚类模块以权利要求1中步骤S1所得数据作为电容器组动作时段划分的依据，采用基于划分的聚类算法得到电容器组的动作时段；无功优化计算模块在第一阶段进行静态无功优化的单目标函数求解，根据电容器组的动作时段确定各时间段内电容器组的投入组数；第二阶段以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量。9.根据权利要求8所述的含新能源和充电站的主动配电网动态无功优化系统，其特征在于，采用k-medoids算法对样本点进行聚类，将同一簇中相邻时间段的样本合并为一个时段，合并后的时段即为电容器组的动作时间段，若合并后的时间段数大于电容器组的最大可投切次数/＞，则进行二次分段，具体操作为：计算分段后相邻时间段样本点之间的欧式距离，并将距离从小到大排序，然后根据该次序依次将相邻时间段合并，直到/＞；无功优化时，合并后每个时段中电容器组的投入次数固定，在各时间段内确定电容器组的投入组数，再对一天中/＞个时段进行静态无功优化，而无需考虑电容器组的动作次数约束。10.根据权利要求9所述的含新能源和充电站的主动配电网动态无功优化系统，其特征在于，第一阶段进行静态无功优化的单目标函数求解，确定各时间段内电容器组的投入组数；第一阶段的静态无功优化同时包含离散型变量和连续型变量，采用离散型变量和连续型变量分离的协调优化算法求解；优化后各时段电容器组的无功补偿序列为：；式中：为聚类后第/＞个时间段投入的电容器组数, /＞；/＞为第/＞个时间段包含的小时数，且/＞；第二阶段，保持电容器组的投入组数不变，以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量。
说明书desc
技术领域本发明涉及配电网技术领域，尤其是指一种含新能源和电充电站的主动配电网动态无功优化方法及系统。背景技术近年来，电动汽车和新能源技术的快速发展，对降低碳排放起了重要作用。但是，随着以光伏电站、风电机组为主的新能源和电动汽车渗透率地不断提升，一些新的问题也会随着产生。一方面，主动配电网中新能源发电装置和电动汽车充电站均具有无功调节能力，虽然丰富了配电网的无功调节手段，但增加了无功优化中的变量维度，使得无功优化模型的求解过程更加复杂。另一方面，新能源的输出功率、电动汽车充电站的充电负荷和居民用电负荷随着周围环境或用户偏好实时变化，过去简单地依靠对日负荷曲线进行分段而达到时空解耦的方法将不再适用，因为引起系统波动的原因是多样性的，并且不同节点处安装的新能源或电动汽车充电站对系统造成的波动程度不一样。因此，亟需一种更加合理的动态无功优化方法，既能满足电容器组动作次数的要求，又能充分利用其他无功补偿装置的调节特点，使系统运行指标达到令人满意的效果。发明内容为了解决上述问题，本发明提出了一种含新能源和电充电站的主动配电网动态无功优化方法及系统。该方法以日前新能源有功出力、电动汽车充电站的充电负荷和居民用电负荷为依据，采用k-medoids算法对一天内的每个小时进行聚类，充分考虑了每种波动源对聚类影响，使聚类结果更具合理性。接着依据聚类结果对时段进行划分，在划分结果的基础上再进行静态无功优化，既能保证电容器组投切次数的约束，又能充分发挥新能源发电装置、电动汽车充电站和SVC的无功调节能力，使配电网各项指标达到令人满意的效果。本发明所提出的一种含新能源和充电站的主动配电网动态无功优化方法，包含如下步骤：步骤S1：获得次日的居民用电负荷、新能源有功出力和电动汽车充电负荷；步骤S2：确定动态无功优化的目标函数和约束条件；以有功网损最小、电压偏差最小和电压稳定性最优为目标函数，以功率平衡、系统电压电流上下限、无功补偿装置无功输出量上下限和电容器组最大动作次数为约束；步骤S3：将目标函数无量纲化并通过层次分析法转化为单目标函数；步骤S4：以步骤S1所得数据作为电容器组动作时段划分的依据，采用基于划分的聚类算法得到电容器组的动作时段；步骤S5：第一阶段进行静态无功优化的单目标函数求解，根据电容器组的动作时段确定各时间段内电容器组的投入组数；第二阶段以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量；输出动态无功优化的结果。进一步优选，所述步骤S2中， 目标函数包括：有功损耗最小目标函数：式中，为系统节点总数；/＞为支路/＞的电导；/＞为/＞时段从支路/＞首端流出的有功功率，/＞为/＞时段从支路/＞首端流出的无功功率；/＞为/＞时段支路/＞的首端电压；/＞为节点/＞的节点集合，支路/＞为节点/＞与节点/＞之间的支路；/＞为取实部操作；电压偏差最小目标函数：式中， 为/＞时段节点/＞的电压幅值，/＞为/＞时段节点/＞的电压上限 ，/＞为/＞时段节点/＞的电压下限，/＞为节点额定电压；电压稳定性最优目标函数：式中，为支路/＞的阻抗，/＞为支路/＞的导纳；/＞为系统支路集合，/＞为/＞时段支路/＞的电压稳定性指标。进一步优选，所述步骤S2中，所述约束条件包括：功率平衡约束：式中，依次为/＞时段注入节点/＞的大电网有功功率、风电机组有功功率和光伏电站有功功率；/＞依次为/＞时段在节点/＞消耗的负荷的有功功率、电动汽车充电站的充电功率和系统有功损耗；依次为/＞时段注入节点/＞的大电网无功功率、风电机组无功功率、光伏电站无功功率和可投切电容器组无功功率；/＞分别为/＞时段在节点/＞消耗的负荷的无功功率和系统的无功损耗；/＞依次为安装风电机组、光伏电站、可投切电容器组及电动汽车充电站的节点集合。电压电流约束：式中，为/＞时段支路/＞的电流，/＞分别为支路/＞的电流上、下限；/＞为/＞时段节点/＞的电压幅值，/＞分别为节点/＞的电压幅值上、下限。控制变量约束：式中，分别为/＞时段节点/＞的风电机组无功功率输出上、下限；分别为/＞时段节点/＞的光伏电站无功功率输出上、下限；/＞分别为节点/＞的可投切电容器组无功功率补偿上、下限；/＞为/＞时段节点/＞的SVC无功功率，分别为节点/＞的SVC无功功率补偿上、下限；电动汽车充电站功率约束：式中：为/＞时段充电站在节点/＞所耗的有功功率，/＞分别为时段充电站在节点/＞所耗最小和最大有功功率；/＞为/＞时段充电站在节点/＞注入的无功功率，/＞分别为/＞时段充电站在节点/＞注入的最小和最大无功功率；为/＞时段节点/＞的充电站容量。电容器组动作次数约束：式中，为/＞时段节点/＞处电容器组的投切量大可投切次数，/＞为/＞时段节点处电容器组的投切量大可投切次数；/＞为异或运算符；/＞为日最大可投切次数。进一步优选，所述步骤S3中，采用极差标准法对目标函数进行无量纲化：式中，为无量纲化之后的数据；/＞为评价策略，/＞为指标，/＞为评价策略/＞的指标/＞数值；/＞、/＞分别为所有评价策略的指标/＞的最大值和最小值。进一步优选，无量纲化之后，采用层次分析法把多个目标函数转化为单目标函数：式中，为指标/＞的权重系数；/＞为层次分析法处理之后的目标函数；/＞为无量纲化后指标/＞的数值。进一步优选，所述步骤S4中，首先，将全天划分为T个时段，以每个时段的风电机组有功出力、光伏电站有功出力、居民用电负荷和电动汽车充电站的充电负荷作为影响聚类结果的主要因数，全天的功率序列表述为：其中，为第/＞台风电机组全天有功出力序列，/＞为/＞时段第/＞台风电机组有功出力；/＞为第/＞台光伏电站全天有功出力序列，/＞为/＞时段第/＞台光伏电站有功出力；为全天居民用电负荷序列，/＞为/＞时段居民用电负荷；/＞为第/＞个电动汽车充电站全天充电负荷序列，/＞为/＞时段第/＞个电动汽车充电站充电负荷；/＞分别风电机组、光伏电站和电动汽车充电站的个数，/＞，/＞为时段总数。进一步优选，所述步骤S4中，将每个时段的风电机组、光伏电站有功出力、居民用电负荷和电动汽车充电站的充电负荷归为一个样本点，维度为，其表达式为：式中：为时段t的样本点。进一步优选，所述步骤S4中，采用k-medoids算法对样本点进行聚类。进一步优选，采用k-medoids算法对样本点进行聚类具体操作为：i)选取个样本点作为聚类中心;ii)计算样本点到聚类中心的欧式距离，距离的大小反映数据之间的相似度，计算公式为：式中，，/＞为时段t的样本点到第/＞个聚类中心/＞的相似度，sqrt表示开方操作，/＞为第/＞个聚类中心的第/＞台风电机组有功出力，/＞为第/＞个聚类中心的第/＞台光伏电站有功出力，/＞为第/＞个聚类中心的第/＞个电动汽车充电站充电负荷，为第/＞个聚类中心的居民用电负荷；距离计算完成之后，将距离质心最近的样本点归类为该质心所在的簇；iii)分别将簇中每个点作为聚类中心，计算簇内其余各点与聚类中心的总距离，然后选择总距离最小的点作为新的聚类中心：iv)重复ii)、iii)步骤，直至聚类中心位置不再变化。进一步优选，所述步骤S4中，聚类完成之后，所有样本点均被归类到相应的簇中，其结果为：式中，表示第/＞个簇中的第/＞个样本点，/＞第1、/＞、k个簇中的样本个数，/＞表示第1、/＞、k个簇的样本集合，且/＞；将同一簇中相邻时间段的样本合并为一个时段，合并后的时段即为电容器组的动作时间段，若合并后的时间段数大于电容器组的最大可投切次数/＞，则进行二次分段，具体操作为：计算分段后相邻时间段样本点之间的欧式距离，并将距离从小到大排序，然后根据该次序依次将相邻时间段合并，直到/＞；无功优化时，合并后每个时段中电容器组的投入次数固定，在各时间段内先确定电容器组的投入组数，再对一天中/＞个时段进行静态无功优化，而无需考虑电容器组的动作次数约束。进一步优选，所述步骤S5中：第一阶段进行静态无功优化的单目标函数求解，确定各时间段内电容器组的投入组数；第一阶段的静态无功优化同时包含离散型变量和连续型变量，采用离散型变量和连续型变量分离的协调优化算法求解；优化后各时段电容器组的无功补偿序列为：式中：为聚类后第/＞个时间段投入的电容器组数,/＞；/＞为第/＞个时间段包含的小时数，且/＞；第二阶段，保持电容器组的投入组数不变，以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量。本发明还提供一种含新能源和充电站的主动配电网动态无功优化系统，包括数据获取模块、单目标无功优化模块、聚类模块和无功优化计算模块，所述数据获取模块获得次日的居民用电负荷、新能源有功出力和电动汽车充电负荷；单目标无功优化模型模块确定动态无功优化的目标函数和约束条件；以有功网损最小、电压偏差最小和电压稳定性最优为目标函数，以功率平衡、系统电压电流上下限、无功补偿装置无功输出量上下限和电容器组最大动作次数为约束；单目标无功优化模型模块将目标函数无量纲化并通过层次分析法转化为单目标函数；所述聚类模块以步骤S1所得数据作为电容器组动作时段划分的依据，采用基于划分的聚类算法得到电容器组的动作时段；无功优化计算模块在第一阶段进行静态无功优化的单目标函数求解，根据电容器组的动作时段确定各时间段内电容器组的投入组数；第二阶段以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量。本发明还提供了一种非易失性计算机存储介质，计算机存储介质存储有计算机可执行指令，该计算机可执行指令可执行上述任意实施例中的含新能源和充电站的主动配电网动态无功优化方法。本发明还提供一种计算机程序产品，计算机程序产品包括存储在非易失性计算机存储介质上的计算机程序，计算机程序包括程序指令，当程序指令被计算机执行时，使计算机执行上述实施例的含新能源和充电站的主动配电网动态无功优化方法。本发明还提供一种电子设备，包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行含新能源和充电站的主动配电网动态无功优化方法。本发明的优点为:1)本发明依据次日新能源有功出力、电动汽车充电站的充电负荷和居民用电负荷对全天每个小时进行时段划分，克服了仅依据负荷曲线分段的片面性。2)本发明解决了动态无功优化过程中存在的时空耦合问题，将动态无功优化的求解转化为静态无功优化，极大地降低了动态无功优化的复杂度。3)本发明通过时空解耦先确定电容器组动作时段，再通过电容器组和其他连续型无功补偿装置的联和优化确定各时间段电容器组的投入组数，最后利用连续型无功补偿装置对配电网每个小时段进行静态无功优化，有效降低了电容器组的动作次数，充分发挥了连续型无功补偿装置的调节能力，极大程度上降低了系统有功损耗，提升了电压质量和系统稳定性。附图说明图1是本发明提出的一种含新能源和充电站的主动配电网动态无功优化方法流程图。具体实施方式以下结合附图说明对本发明作进一步说明。如图1所示，本发明所提出的一种含新能源和充电站的主动配电网动态无功优化方法包含如下步骤：步骤S1：获得次日的居民用电负荷、新能源有功出力和电动汽车充电负荷；新能源以风电机组和光伏电站为主，其有功出力受周围环境变化，是导致配电网在各小时段运行状态不同的主要原因之一；步骤S2：确定动态无功优化的目标函数和约束条件；以有功网损最小、电压偏差最小和电压稳定性最优为目标函数，以功率平衡、系统电压电流上下限、无功补偿装置无功输出量上下限和电容器组最大动作次数为约束；步骤S3：将目标函数无量纲化并通过层次分析法转化为单目标函数；步骤S4：以步骤S1所得数据作为电容器组动作时段划分的依据，采用基于划分的聚类算法得到电容器组的动作时段；步骤S5：第一阶段进行静态无功优化的单目标函数求解，根据电容器组的动作时段确定各时间段内电容器组的投入组数；第二阶段以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量；输出动态无功优化的结果。所述步骤S2中，以有功网损最小、电压偏差最小和电压稳定性最优为目标函数，以功率平衡、系统电压电流上下限、无功补偿装置无功输出量上下限和电容器组最大动作次数为约束。其中，目标函数包括：有功损耗最小目标函数：式中，为系统节点总数；/＞为支路/＞的电导；/＞为/＞时段从支路/＞首端流出的有功功率，/＞为/＞时段从支路/＞首端流出的无功功率；/＞为/＞时段支路/＞的首端电压；/＞为节点/＞的节点集合，支路/＞为节点/＞与节点/＞之间的支路；/＞为取实部操作。电压偏差最小目标函数：式中， 为/＞时段节点/＞的电压幅值，/＞为/＞时段节点/＞的电压上限 ，/＞为/＞时段节点/＞的电压下限，/＞为节点额定电压。电压稳定性最优目标函数：式中，为支路/＞的阻抗，/＞为支路/＞的导纳；/＞为系统支路集合，/＞为/＞时段支路/＞的电压稳定性指标。所述约束条件包括：功率平衡约束：式中，依次为/＞时段注入节点/＞的大电网有功功率、风电机组有功功率和光伏电站有功功率；/＞依次为/＞时段在节点/＞消耗的负荷的有功功率、电动汽车充电站的充电功率和系统有功损耗；/＞依次为/＞时段注入节点/＞的大电网无功功率、风电机组无功功率、光伏电站无功功率和可投切电容器组无功功率；/＞分别为/＞时段在节点/＞消耗的负荷的无功功率和系统的无功损耗；/＞依次为安装风电机组、光伏电站、可投切电容器组及电动汽车充电站的节点集合。电压电流约束：式中，为/＞时段支路/＞的电流，/＞分别为支路/＞的电流上、下限；/＞为时段节点/＞的电压幅值，/＞分别为节点/＞的电压幅值上、下限。控制变量约束：式中，为/＞时段节点/＞的风电机组无功功率输出上、下限；分别为/＞时段节点/＞的光伏电站无功功率输出上、下限；/＞分别为节点/＞的可投切电容器组无功功率补偿上、下限；/＞为/＞时段节点/＞的SVC无功功率，分别为节点/＞的SVC无功功率补偿上、下限；电动汽车充电站功率约束：式中：为/＞时段充电站在节点/＞所耗的有功功率，/＞分别为/＞时段充电站在节点/＞所耗最小和最大有功功率；/＞为/＞时段充电站在节点/＞注入的无功功率，分别为/＞时段充电站在节点/＞注入的最小和最大无功功率；/＞为/＞时段节点的充电站容量。电容器组动作次数约束：式中，为/＞时段节点/＞处电容器组的投切量大可投切次数，/＞为/＞时段节点/＞处电容器组的投切量大可投切次数；/＞为异或运算符；/＞为日最大可投切次数。本发明所述的数学模型是一个多目标无功优化模型，各子目标之间相互约束，无法同时达到最优，因此采用层次分析法把多个目标函数转化为单目标函数，使得优化结果为一个满意度较高的折中解，此外，各目标函数的量纲与数量级并不一致，需对目标函数做归一化处理。所述步骤S3中，采用极差标准法对目标函数进行无量纲化：式中，为无量纲化之后的数据；/＞为评价策略，/＞为指标，/＞为评价策略/＞的指标数值；/＞分别为所有评价策略的指标/＞的最大值和最小值。无量纲化之后，采用层次分析法把多个目标函数转化为单目标函数：式中，为指标/＞的权重系数；/＞为层次分析法处理之后的目标函数；/＞为无量纲化后指标/＞的数值。所述步骤S4中，风电机组有功出力、光伏电站有功出力、居民用电负荷和电动汽车充电负荷在各时段的波动是导致配电网各小时段运行状态不同的主要原因，对它们的功率进行聚类更具合理性。所述步骤S4中，首先，将全天划分为T个时段，以每个时段的风电机组有功出力、光伏电站有功出力、居民用电负荷和电动汽车充电站的充电负荷作为影响聚类结果的主要因数，全天的功率序列可以表述为：其中，为第/＞台风电机组全天有功出力序列，/＞为/＞时段第/＞台风电机组有功出力；/＞为第/＞台光伏电站全天有功出力序列，/＞为/＞时段第/＞台光伏电站有功出力；为全天居民用电负荷序列，/＞为/＞时段居民用电负荷；/＞为第/＞个电动汽车充电站全天充电负荷序列，/＞为/＞时段第/＞个电动汽车充电站充电负荷；/＞分别风电机组、光伏电站和电动汽车充电站的个数，/＞，/＞为时段总数。进一步，将每个时段的风电机组、光伏电站有功出力、居民用电负荷和电动汽车充电站的充电负荷归为一个样本点，维度为，其表达式为：式中：为时段t的样本点。其次，采用k-medoids算法对样本点进行聚类，具体操作为：i)选取个样本点作为聚类中心。ii)计算样本点到聚类中心的欧式距离，距离的大小反映了数据之间的相似度，越近，则表示数据间的相似度越高，计算公式为：式中，，/＞为时段t的样本点到第/＞个聚类中心/＞的相似度，sqrt表示开方操作，/＞为第/＞个聚类中心的第/＞台风电机组有功出力，/＞为第/＞个聚类中心的第/＞台光伏电站有功出力，/＞为第/＞个聚类中心的第/＞个电动汽车充电站充电负荷，为第/＞个聚类中心的居民用电负荷。距离计算完成之后，将距离质心最近的样本点归类为该质心所在的簇。iii)分别将簇中每个点作为聚类中心，计算簇内其余各点与聚类中心的总距离，然后选择总距离最小的点作为新的聚类中心。iv)重复ii)、iii)步骤，直至聚类中心位置不再变化。聚类完成之后，所有样本点均被归类到相应的簇中，其结果为：式中，表示第/＞个簇中的第/＞个样本点，/＞表示第1、/＞、k个簇中的样本个数，/＞表示第1、/＞、k个簇的样本集合，且/＞。将同一簇中相邻时间段的样本合并为一个时段，合并后的时段即为电容器组的动作时间段，若合并后的时间段数大于电容器组的最大可投切次数/＞，则进行二次分段，具体操作为：计算分段后相邻时间段样本点之间的欧式距离，并将距离从小到大排序，然后根据该次序依次将相邻时间段合并，直到/＞；无功优化时，合并后每个时段中电容器组的投入次数固定，不同时间段的电容器组投入数量可以不同，这样只需在各时间段内先确定电容器组的投入组数，再对一天中/＞个时段进行静态无功优化，而无需考虑电容器组的动作次数约束，从而动态无功优化问题转化为了静态无功优化问题，大大降低了动态无功优化问题的求解难度。所述步骤S5中，在确定电容器组的动作时段之后，将每个时间段内新能源、电动汽车充电负荷和居民用电负荷的平均值代表该时间段的功率特性，第一阶段进行静态无功优化的单目标函数求解，确定各时间段内电容器组的投入组数；所述步骤S5中，第一阶段的静态无功优化是一个混合整数非线性规划问题，采用离散型变量和连续型变量分离的协调优化算法求解较为理想，本发明对具体求解算法不做限定。式中：为聚类后第/＞个时间段投入的电容器组数,/＞；/＞为第/＞个时间段包含的小时数，且/＞；第二阶段，保持电容器组的投入组数不变，以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量。由于新能源、电动汽车充电站和SVC无功出力均为连续可调的，所以第二阶段的无功优化只涉及连续型变量，求解方法多样，即可采用内点法、牛顿法等传统优化算法，又可采用粒子群、蜂群算法等启发式算法，本实施例对具体算法不做限定。至此，动态无功优化中的离散型决策变量和连续型决策变量分别在第一阶段的静态无功优化和第二阶段的静态无功优化求解完成，优化结束。最终确定一天内每个小时所有无功补偿装置的投入量。本发明首先通过时空解耦先确定电容器组动作时段，再通过电容器组和其他连续型无功补偿装置的联和优化确定各时间段电容器组的投入组数，最后固定电容器组投入组数，利用连续型无功补偿装置对配电网每个小时段进行静态无功优化，有效降低了电容器组的动作次数和动态无功优化的求解复杂度，充分发挥了连续型无功补偿装置的调节能力，极大程度上降低了系统有功损耗，提升了电压质量和系统稳定性。此外，本发明依据次日新能源有功出力、电动汽车充电站的充电负荷和居民用电负荷对全天每个小时进行时段划分，克服了仅依据负荷曲线分段的片面性。本实施例还提供一种含新能源和充电站的主动配电网动态无功优化系统，包括数据获取模块、单目标无功优化模块、聚类模块和无功优化计算模块，所述数据获取模块获得次日的居民用电负荷、新能源有功出力和电动汽车充电负荷；单目标无功优化模型模块确定动态无功优化的目标函数和约束条件；以有功网损最小、电压偏差最小和电压稳定性最优为目标函数，以功率平衡、系统电压电流上下限、无功补偿装置无功输出量上下限和电容器组最大动作次数为约束；单目标无功优化模型模块将目标函数无量纲化并通过层次分析法转化为单目标函数；所述聚类模块以步骤S1所得数据作为电容器组动作时段划分的依据，采用基于划分的聚类算法得到电容器组的动作时段；无功优化计算模块在第一阶段进行静态无功优化的单目标函数求解，根据电容器组的动作时段确定各时间段内电容器组的投入组数；第二阶段以新能源、电动汽车充电站和SVC为无功补偿装置进行静态无功优化的单目标函数求解，确定无功补偿装置的投入量。在另一实施例中，提供了一种非易失性计算机存储介质，计算机存储介质存储有计算机可执行指令，该计算机可执行指令可执行上述任意实施例中的含新能源和充电站的主动配电网动态无功优化方法。本实施例还提供一种计算机程序产品，计算机程序产品包括存储在非易失性计算机存储介质上的计算机程序，计算机程序包括程序指令，当程序指令被计算机执行时，使计算机执行上述实施例的含新能源和充电站的主动配电网动态无功优化方法。本实施例提供一种电子设备，包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行含新能源和充电站的主动配电网动态无功优化方法。以上所述的具体实施方案，进一步详细地说明了本发明的目的、技术方案和技术效果。所应理解的是，以上所述仅为本发明的具体实施方案而已，并非用以限定本发明的范围，任何本领域的技术人员，在不脱离本发明思想和原则的前提下所做出的等同变化与修改，均应属于本发明保护的范围。
