标题title
一种去中心化的前向安全身份基加密方法及系统
摘要abst
本申请公开了一种去中心化的前向安全身份基加密方法及系统，属于网络空间安全中的密码学技术领域。该系统包括：系统公开参数产生模块、公私钥对生产模块、加密模块、密钥提取模块、私钥更新模块以及解密模块。本申请有益效果如下：使用户可以进行细粒度的密钥更新，有针对性地撤销对重要数据的访问权限，有效防止密钥泄露导致的重要数据失密。同时，用户可以自行产生私钥，而不必依赖于任何外部机构；并且，本申请提出的前向安全身份基加密方法不使用随机预言机，因而更加符合现实世界中的应用。
权利要求书clms
1.一种去中心化的前向安全身份基加密方法，其特征在于，包括：步骤S1：系统初始化，用户或者云服务提供商运行初始化算法，产生系统公开参数；步骤S2：任意用户可加入系统并基于系统公开参数生成自己的公私钥对，其中，公钥向互联网发布，私钥由用户保管；步骤S3：数据所有者在将数据上传之前，基于标识字符串ID以及标签集加密数据，形成密文，然后将密文上传给云服务器；步骤S4：数据所有者可针对任意标识字符串提取密钥，获得密钥的数据使用者只能访问被标识字符串ID加密的数据；步骤S5:数据所有者可随时更新自己的私钥，且在进行更新时，数据所有者可指定敏感数据的标签；步骤S6：数据使用者从云服务器下载密文后，使用数据所有者分配的密钥进行解密，如果密文中的标识字符串ID与密钥ID一致，并且，密钥更新时使用的任何一个标签都不在密文的标签集里，则解密成功。2.根据权利要求1所述的方法，其特征在于，在步骤S1中，所述运行初始化算法，包括：输入安全参数λ和与密文关联的最大标签数量n；选定两个阶为大素数p的群G与GT，G与GT间存在双线性映射e:G×G→GT,然后选择任意群元素g，g2∈G，u0,u1,...,ul∈G，h0，h1，...，hn∈G，其中l表示身份标识字符串以二进制表示时的最大长度，则算法输出公开参数为PP＝。3.根据权利要求2所述的方法，其特征在于，在步骤S2中，所述基于系统公开参数生成自己的公私钥对，包括：所述基于系统公开参数使用公私钥生成算法生成自己的公私钥对输入系统公开参数PP；用户选择随机元素α并计算公钥PK＝g1＝gα；选择随机数r，z0∈Zp计算:输出公钥PK＝g1，私钥SK＝。4.根据权利要求3所述的方法，其特征在于，在步骤S3中，所述基于标识字符串ID以及标签集加密数据，形成密文，包括：所述基于标识字符串ID以及标签集并使用加密算法加密数据，形成密文，包括：输入系统公开参数PP、用户公钥PK，明文M、标签集合T＝{t1,...,tn}，以及标识字符串ID；设集合V是将ID表示为二进制后所有比特位为1的位置集合；加密算法首先计算一元多项式f＝Π1≤i≤n得到多项式系数a0，a1，...，an，然后，选择随机元素s∈Zp计算：c0＝Mes，C1＝gs，C2＝s，输出密文CT＝。5.根据权利要求4所述的方法，其特征在于，在步骤S4中，所述数据所有者可针对任意标识字符串提取密钥，包括：数据所有者可针对任意标识字符串使用密钥提取算法提取密钥，包括：输入系统公开参数PP、私钥SK以及标识字符串ID∈{0,1}*；设集合V是将标识字符串ID表示为二进制后所有比特位为1的位置集合，则密钥提取算法选择随机数k∈Zp并计算：SK0，4＝gk’输出与标识字符串ID关联的私钥SKID＝。6.根据权利要求5所述的方法，其特征在于，在步骤S5中，所述数据所有者可随时更新自己的私钥，包括：所述数据所有者使用密钥更新算法可随时更新自己的私钥，包括：输入系统公开参数PP、私钥SK，以及标签z；密钥更新算法选择随机元素λ，r′，t∈zp并计算：SK’0，2＝SK0，2gr′输出SKz＝，SKz，1，SKz，2，SKz，3)。7.根据权利要求6所述的方法，其特征在于，在步骤S6中，所述使用数据所有者分配的密钥进行解密，包括：所述使用数据所有者分配的密钥并采用解密算法进行解密，包括：输入系统公开参数PP、密文CT、解密密钥解密算法计算多项式得到系数a0，a1，...，an，然后计算以及其中zi表示密钥/＞第i次更新时所使用的标签；解密算法接着计算：输出明文M＝C0/。8.一种用于执行权利要求1-7任意一项所述的方法的去中心化的前向安全身份基加密系统，其特征在于，该系统包括：系统公开参数产生模块，用于系统初始化，用户或者云服务提供商运行初始化算法，产生系统公开参数；公私钥对生产模块，用于任意用户可加入系统并基于系统公开参数生成自己的公私钥对，其中，公钥向互联网发布，私钥由用户保管；加密模块，用于数据所有者在将数据上传之前，基于标识字符串ID以及标签集加密数据，形成密文，然后将密文上传给云服务器；密钥提取模块，用于数据所有者可针对任意标识字符串提取密钥，获得密钥的数据使用者只能访问被标识字符串ID加密的数据；私钥更新模块，用于数据所有者可随时更新自己的私钥，且在进行更新时，数据所有者可指定敏感数据的标签；解密模块，用于数据使用者从云服务器下载密文后，使用数据所有者分配的密钥进行解密，如果密文中的标识字符串ID与密钥ID一致，并且，密钥更新时使用的任何一个标签都不在密文的标签集里，则解密成功。
说明书desc
技术领域本申请属于网络空间安全中的密码学技术领域，具体涉及一种去中心化的前向安全身份基加密方法及系统。背景技术云计算是一种能够为用户提供便捷计算资源服务的新兴技术。通过云计算，用户不必在本地存储大量数据，而只需将数据委托给云计算服务提供商进行存储和管理。但是，随着数据脱离用户的物理控制，云计算数据安全与隐私问题也越发严峻。目前保护云数据安全的通用做法是密码学加密，数据所有者在将数据上传给云服务器之前对数据进行加密处理，使得数据只能被指定的授权用户访问。为了实现数据只被指定用户访问，数据所有者在加密时可以使用指定用户的公钥，使得数据只能被该公钥对应的私钥解密。现在使用较为普遍的公钥加密系统是基于公钥基础设施的。在PKI系统中，存在一个公钥证书管理机构，负责为所有的用户产生公私钥，并为每个公钥证书提供认证服务。当数据所有者在加密时，需要与公钥证书管理机构进行交互，获得目标接收者的公钥证书，然后再使用该公钥加密数据。随着云计算用户数量的日益增多，公钥证书管理机构的密钥生成和管理负担越来越大，不能更好适应云计算服务的要求。针对该问题，人们提出了身份基加密。在IBE系统中，数据所有者在加密时不需要与公钥证书管理机构通信以获得目标接收者公钥，而是直接使用目标接收者的身份标识字符串加密数据，从而避免了PKI系统中的公钥管理问题。在身份基加密中，目标接收者使用与自己身份标识相对应的私钥对密文进行解密，从而访问数据。这里的私钥决定着数据加密措施的有效性，如果私钥泄露，那么获得私钥的黑客或网络攻击者将轻而易举获得数据。为了防止密钥泄露，人们提出了前向安全加密。简单来说，前向安全加密要求用户定期更新自己的私钥，而私钥被更新后，便不能再访问在更新之前上传的密文。这样一来，即使用户当前密钥泄露，获得密钥的黑客或网络攻击者也不能访问之前的数据，这就是前向安全性。现有前向安全加密方案的密钥更新较为粗放，即密钥被更新后，会失去对更新之前上传的所有数据的访问权限，不利于数据的分享。而在身份基加密领域，虽然有少量的关于密钥更新的研究工作，但是要么是中心化的，即需要一个可信任的中心机构为所有用户产生私钥，要么安全性依赖于随机预言机，即存在一个函数将用户身份标识映射为一个完全随机的整数，而现实世界中不存在这样完全随机的函数。为此，本申请提供一种去中心化的前向安全身份基加密方法及系统以解决上述问题。发明内容本申请实施例的目的是提供一种去中心化的前向安全身份基加密方法及系统，其使用户可以进行细粒度的密钥更新，有针对性地撤销对重要数据的访问权限，有效防止密钥泄露导致的重要数据失密；同时，用户可以自行产生私钥，而不必依赖于任何外部机构；并且，本申请提出的前向安全身份基加密方法不使用随机预言机，因而更加符合现实世界中的应用，从而可以解决背景技术中涉及的至少一个技术问题。为了解决上述技术问题，本申请是这样实现的：本申请实施例提供了一种去中心化的前向安全身份基加密方法，包括：步骤S1：系统初始化，用户或者云服务提供商运行初始化算法，产生系统公开参数；步骤S2：任意用户可加入系统并基于系统公开参数生成自己的公私钥对，其中，公钥向互联网发布，私钥由用户保管；步骤S3：数据所有者在将数据上传之前，基于标识字符串ID以及标签集加密数据，形成密文，然后将密文上传给云服务器；步骤S4：数据所有者可针对任意标识字符串提取密钥，获得密钥的数据使用者只能访问被标识字符串ID加密的数据；步骤S5:数据所有者可随时更新自己的私钥，且在进行更新时，数据所有者可指定敏感数据的标签；步骤S6：数据使用者从云服务器下载密文后，使用数据所有者分配的密钥进行解密，如果密文中的标识字符串ID与密钥ID一致，并且，密钥更新时使用的任何一个标签都不在密文的标签集里，则解密成功。可选的，在步骤S1中，所述运行初始化算法，包括：输入安全参数λ和与密文关联的最大标签数量n；选定两个阶为大素数p的群G与GT，G与GT间存在双线性映射e：G×G→GT，然后选择任意群元素g，g2∈G，u0，u1，...，ul∈G,h0，h1，...，hn∈G，其中l表示身份标识字符串以二进制表示时的最大长度，则算法输出公开参数为PP＝。可选的，在步骤S2中，所述基于系统公开参数生成自己的公私钥对，包括：所述基于系统公开参数使用公私钥生成算法生成自己的公私钥对输入系统公开参数PP；用户选择随机元素α并计算公钥PK＝g1＝gα；选择随机数r，z0∈Zp计算:输出公钥PK＝g1，私钥SK＝。可选的，在步骤S3中，所述基于标识字符串ID以及标签集加密数据，形成密文，包括：所述基于标识字符串ID以及标签集并使用加密算法加密数据，形成密文，包括：输入系统公开参数PP、用户公钥PK，明文M、标签集合T＝{t1,...,tn}，以及标识字符串ID；设集合V是将ID表示为二进制后所有比特位为1的位置集合；加密算法首先计算一元多项式f＝Π1≤i≤n得到多项式系数a0，a1，...，an，然后，选择随机元素s∈Zp计算：输出密文CT＝。可选的，在步骤S4中，所述数据所有者可针对任意标识字符串提取密钥，包括：数据所有者可针对任意标识字符串使用密钥提取算法提取密钥，包括：输入系统公开参数PP、私钥SK以及标识字符串ID∈{0,1}*；设集合V是将标识字符串ID表示为二进制后所有比特位为1的位置集合，则密钥提取算法选择随机数k∈Zp并计算：输出与标识字符串ID关联的私钥SKID＝。可选的，在步骤S5中，所述数据所有者可随时更新自己的私钥，包括：所述数据所有者使用密钥更新算法可随时更新自己的私钥，包括：输入系统公开参数PP、私钥SK，以及标签z；密钥更新算法选择随机元素λ，r′，t∈Zp并计算：SK'0，2＝SK0，2gr’输出SKz＝，SKz，1，SKz，2，SKz，3)。可选的，在步骤S6中，所述使用数据所有者分配的密钥进行解密，包括：所述使用数据所有者分配的密钥并采用解密算法进行解密，包括：输入系统公开参数PP、密文CT、解密密钥解密算法计算多项式得到系数a0，a1，...，an，然后计算以及其中zi表示密钥/＞第i次更新时所使用的标签；解密算法接着计算：输出明文M＝C0/。本申请实施例还提供了一种用于执行所述的方法的去中心化的前向安全身份基加密系统，该系统包括：系统公开参数产生模块，用于系统初始化，用户或者云服务提供商运行初始化算法，产生系统公开参数；公私钥对生产模块，用于任意用户可加入系统并基于系统公开参数生成自己的公私钥对，其中，公钥向互联网发布，私钥由用户保管；加密模块，用于数据所有者在将数据上传之前，基于标识字符串ID以及标签集加密数据，形成密文，然后将密文上传给云服务器；密钥提取模块，用于数据所有者可针对任意标识字符串提取密钥，获得密钥的数据使用者只能访问被标识字符串ID加密的数据；私钥更新模块，用于数据所有者可随时更新自己的私钥，且在进行更新时，数据所有者可指定敏感数据的标签；解密模块，用于数据使用者从云服务器下载密文后，使用数据所有者分配的密钥进行解密，如果密文中的标识字符串ID与密钥ID一致，并且，密钥更新时使用的任何一个标签都不在密文的标签集里，则解密成功。本申请的有益效果如下：使用户可以进行细粒度的密钥更新，有针对性地撤销对重要数据的访问权限，有效防止密钥泄露导致的重要数据失密。同时，用户可以自行产生私钥，而不必依赖于任何外部机构；并且，本申请提出的前向安全身份基加密方法不使用随机预言机，因而更加符合现实世界中的应用。附图说明图1是本申请实施例提供的去中心化的前向安全身份基加密方法的流程示意图；图2是本申请实施例提供的去中心化的前向安全身份基加密系统的系统框架图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。本申请的说明书和权利要求书中的术语“第一”、“第二”等是用于区别类似的对象，而不用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便本申请的实施例能够以除了在这里图示或描述的那些以外的顺序实施，且“第一”、“第二”等所区分的对象通常为一类，并不限定对象的个数，例如第一对象可以是一个，也可以是多个。此外，说明书以及权利要求中“和/或”表示所连接对象的至少其中之一，字符“/”，一般表示前后关联对象是一种“或”的关系。下面结合附图，通过具体的实施例及其应用场景对本申请实施例提供的去中心化的前向安全身份基加密方法进行详细地说明。请参见图1，是本申请实施例提供的一种去中心化的前向安全身份基加密方法，包括：步骤S1：系统初始化，用户或者云服务提供商运行初始化算法，产生系统公开参数；步骤S2：任意用户可加入系统并基于系统公开参数生成自己的公私钥对，其中，公钥向互联网发布，私钥由用户保管；步骤S3：数据所有者在将数据上传之前，基于标识字符串ID以及标签集加密数据，形成密文，然后将密文上传给云服务器；步骤S4：数据所有者可针对任意标识字符串提取密钥，获得密钥的数据使用者只能访问被标识字符串ID加密的数据；步骤S5:数据所有者可随时更新自己的私钥，且在进行更新时，数据所有者可指定敏感数据的标签；步骤S6：数据使用者从云服务器下载密文后，使用数据所有者分配的密钥进行解密，如果密文中的标识字符串ID与密钥ID一致，并且，密钥更新时使用的任何一个标签都不在密文的标签集里，则解密成功。在步骤S1中，所述运行初始化算法，包括：输入安全参数λ和与密文关联的最大标签数量n；选定两个阶为大素数p的群G与GT，G与GT间存在双线性映射e：G×G→GT，然后选择任意群元素g，g2∈G，u0，u1，...，ul∈G,h0，h1，...，hn∈G，其中l表示身份标识字符串以二进制表示时的最大长度，则算法输出公开参数为PP＝。在步骤S2中，所述基于系统公开参数生成自己的公私钥对，包括：所述基于系统公开参数使用公私钥生成算法生成自己的公私钥对输入系统公开参数PP；用户选择随机元素α并计算公钥PK＝g1＝gα；选择随机数r，z0∈Zp计算:输出公钥PK＝g1，私钥SK＝。需要额外说明的是，在上述公私钥生成算法中，所需的唯一参数是系统公开参数PP。这意味着任何用户都可以生成自己的公私钥对，而不必要求一个中心机构来为用户生成密钥。在步骤S3中，所述基于标识字符串ID以及标签集加密数据，形成密文，包括：所述基于标识字符串ID以及标签集并使用加密算法加密数据，形成密文，包括：输入系统公开参数PP、用户公钥PK，明文M、标签集合T＝{t1,...,tn}，以及标识字符串ID；设集合V是将ID表示为二进制后所有比特位为1的位置集合；加密算法首先计算一元多项式f＝Π1≤i≤n得到多项式系数a0，a1，...，an，然后，选择随机元素s∈Zp计算：C0＝Mes，CI＝gs’输出密文CT＝。在步骤S4中，所述数据所有者可针对任意标识字符串提取密钥，包括：数据所有者可针对任意标识字符串使用密钥提取算法提取密钥，包括：输入系统公开参数PP、私钥SK以及标识字符串ID∈{0,1}*；设集合V是将标识字符串ID表示为二进制后所有比特位为1的位置集合，则密钥提取算法选择随机数k∈Zp并计算：输出与标识字符串ID关联的私钥SKID＝。需要额外说明的是，在上述密钥提取算法中，不需要假设存在随机函数将ID映射为Zp中的一个整数，因而算法不需要使用随机预言机来保证安全性。在步骤S5中，所述数据所有者可随时更新自己的私钥，包括：所述数据所有者使用密钥更新算法可随时更新自己的私钥，包括：输入系统公开参数PP、私钥SK，以及标签z；密钥更新算法选择随机元素λ，r′，t∈Zp并计算：SK'0，2＝SK0，2gr’输出SKz＝，SKz，1，SKz，2，SKz，3)。在步骤S6中，所述使用数据所有者分配的密钥进行解密，包括：所述使用数据所有者分配的密钥并采用解密算法进行解密，包括：输入系统公开参数PP、密文CT、解密密钥解密算法计算多项式得到系数a0，a1，...，an，然后计算以及其中zi表示密钥/＞第i次更新时所使用的标签；解密算法接着计算：输出明文M＝C0/。再结合图2所示，本申请实施例还提供了一种用于执行所述的方法的去中心化的前向安全身份基加密系统，该系统包括系统公开参数产生模块1、公私钥对生产模块2、加密模块3、密钥提取模块4、私钥更新模块5以及解密模块6。所述系统公开参数产生模块1用于系统初始化，用户或者云服务提供商运行初始化算法，产生系统公开参数。所述公私钥对生产模块2用于任意用户可加入系统并基于系统公开参数生成自己的公私钥对，其中，公钥向互联网发布，私钥由用户保管。所述加密模块3用于数据所有者在将数据上传之前，基于标识字符串ID以及标签集加密数据，形成密文，然后将密文上传给云服务器。所述密钥提取模块4用于数据所有者可针对任意标识字符串提取密钥，获得密钥的数据使用者只能访问被标识字符串ID加密的数据。所述私钥更新模块5用于数据所有者可随时更新自己的私钥，且在进行更新时，数据所有者可指定敏感数据的标签。所述解密模块6用于数据使用者从云服务器下载密文后，使用数据所有者分配的密钥进行解密，如果密文中的标识字符串ID与密钥ID一致，并且，密钥更新时使用的任何一个标签都不在密文的标签集里，则解密成功。本申请的有益效果如下：使用户可以进行细粒度的密钥更新，有针对性地撤销对重要数据的访问权限，有效防止密钥泄露导致的重要数据失密。同时，用户可以自行产生私钥，而不必依赖于任何外部机构；并且，本申请提出的前向安全身份基加密方法不使用随机预言机，因而更加符合现实世界中的应用。上面结合附图对本申请的实施例进行了描述，但是本申请并不局限于上述的具体实施方式，上述的具体实施方式仅仅是示意性的，而不是限制性的，本领域的普通技术人员在本申请的启示下，在不脱离本申请宗旨和权利要求所保护的范围情况下，还可做出很多形式，均属于本申请的保护之内。
