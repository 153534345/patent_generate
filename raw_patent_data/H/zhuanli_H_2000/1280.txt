标题title
一种基于模型数据双驱动的动态状态估计方法和系统
摘要abst
本发明公开了一种基于模型数据双驱动的动态状态估计方法和系统，包括：获取电力系统的实时节点功率量测信息，并识别当前时刻异常信息，对应的节点为异常点；采用数据驱动预测模型得到异常点处的功率预测值；基于模型驱动预测模型得到异常点处的功率预测值；对预测值进行学习，得到异常点处的最终功率预测结果；将最终功率预测结果作为当前时刻的伪量测量，替换当前时刻的异常信息，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计，实现基于模型数据双驱动的动态状态估计。本发明提高了输入数据的可靠性和状态估计量测量的准确度，更加能够反映实际电力系统状态。
权利要求书clms
1.一种基于模型数据双驱动的动态状态估计方法，其特征在于：所述方法包括以下步骤：S1：获取电力系统的实时节点功率量测信息，并结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算，识别当前时刻异常信息，对应的节点为异常点；S2：采用历史节点功率量测信息和预训练的基于LSTM神经网络的数据驱动预测模型得到异常点处的功率预测值；S3：基于模型驱动预测模型进行负荷实时分类预测，得到异常点处的功率预测值；S4：结合历史节点功率量测信息，对S2与S3得到的预测值进行学习，得到异常点处的最终功率预测结果；S5：将最终功率预测结果作为当前时刻的伪量测量，替换当前时刻的异常信息，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计，实现基于模型数据双驱动的动态状态估计。2.根据权利要求1所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：S1中，节点功率量测信息包括节点注入功率和线路功率，其中节点注入功率包括节点的注入有功功率和无功功率，线路功率包括线路的有功功率和无功功率。3.根据权利要求1所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：S1中，识别异常信息的过程包括：1）将历史节点功率量测信息分为注入有功功率和无功功率、线路有功功率和无功功率四个量测集合，对于每个集合，从中随机选择M个信息样本，并将其作为树的根节点，随机生成切割点，以切割点信息大小为标准将样本分割为两个部分置于切割点两侧，在子节点中重复切割，直到最终剩下一个信息数据或是子节点达到限定高度；循环随机生成切割点及重复切割操作，生成K颗树；2）将每个集合所生成的K棵树计算平均高度，进而计算集合中样本信息异常分数，异常分数超过设定阈值则表示样本信息异常。4.根据权利要求3所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：对于量测集合g，其样本信息异常分数 为：  其中，h为量测集合g对应树中每个样本点从根节点到其所在节点所经过路径长度关于样本数m的平均；E)为K棵树的h的平均值；为m个样本的平均高度；为中间计算参数，/＞为欧拉常数。5.根据权利要求1所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：S2中，对基于LSTM神经网络的数据驱动预测模型预训练时，LSTM神经网络的神经元内信息传递遵循的公式如下：      其中，分别代表遗忘门、输入门和输出门；、/＞、/＞分别表示遗忘门、输入门和输出门的权重；、/＞、/＞、/＞分别表示遗忘门、输入门、输出门和神经单元状态的门控单元偏置量；表示LSTM单元的输入向量；、/＞分别代表上一时刻和当前时刻神经元的状态；代表当前时刻t的输入节点的状态；、/＞分别代表上一时刻和当前时刻隐藏层状态变量；和tanh分别代表Sigmoid函数和Tanh函数。6.根据权利要求1所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：S3中，采用模型驱动预测模型，根据异常信息所在节点的负荷类型得出异常点处的注入有功功率预测值，在功率因数的基础上，计算异常信息所在节点注入无功功率的预测值，通过潮流计算得出异常点所在支路功率信息的预测值。7.根据权利要求6所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：异常点处的注入有功功率预测值为：  其中，为t时刻异常信息所在节点i的注入有功功率；C表示异常信息所在节点i的负荷类型的数量；为t时刻异常信息所在节点i的上游变电站节点r所服务的总节点数；表示t时刻异常信息所在节点i的类型为p的负荷的有功功率；表示t时刻异常信息所在节点上游变电站节点r的遥测功率；表示t时刻类型为p的负荷的荷载模型系数；表示荷载模型系数的平均值；表示类型为p的负荷在节点i处的消耗需求。8.根据权利要求6所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：所述异常信息所在节点注入无功功率的预测值计算式为：其中，/＞为t时刻异常信息所在节点i的注入无功功率；表示t时刻异常信息所在节点i的类型为p的负荷的有功功率；C表示异常信息所在节点i的负荷类型的数量；为节点i处负荷类型为p的功率因数。9.根据权利要求1所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：S4具体过程为：分别采用S2和S3得到的异常点处的功率预测值，替换S1实时节点功率量测信息中的异常信息，并结合S2中的历史节点功率量测信息形成两大组训练集，对每大组训练集进行如下预测操作：将训练集分成若干小组，以用于训练多个基学习器，其中小组数量与基学习器数量相同；采用每小组数据训练与其对应的基学习器，每个基学习器输出各自的预测结果；将所有基学习器的输出作为元学习器的输入进行训练，元学习器的输出作为异常点处的功率预测值。10.根据权利要求1所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：S5中，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计的模型为：  其中，表示t时刻的状态估计值；表示t时刻的状态转移函数；，/＞分别表示过程噪声和量测噪声；为基于粒子滤波的量测量到状态量的非线型映射函数。11.根据权利要求10所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：从量测量到状态量的非线型映射逻辑为：采用状态后验概率表示状态估计结果，通过随机采样获得的离散样本点来获得后验概率，进而得到由粒子权值多项式表示的状态估计结果；求解粒子权值并将粒子权值小于设定值的项去掉，余下的项求和得到最终的状态估计结果。12.一种基于模型数据双驱动的动态状态估计系统，用于实现权利要求1-11任意一项所述的方法，其特征在于：所述动态状态估计系统包括：信息获取与异常识别模块，用于获取电力系统的实时节点功率量测信息，并结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算，识别当前时刻异常信息，对应的节点为异常点；数据驱动预测模块，用于采用历史节点功率量测信息和预训练的基于LSTM神经网络的数据驱动预测模型得到异常点处的功率预测值；模型驱动预测模块，用于基于模型驱动预测模型进行负荷实时分类预测，得到异常点处的功率预测值；集成学习模块，用于结合历史节点功率量测信息，对数据驱动预测模块与模型驱动预测模块得到的预测值进行学习，得到异常点处的最终功率预测结果；状态估计模块，用于将最终功率预测结果作为当前时刻的伪量测量，替换当前时刻的异常信息，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计，实现基于模型数据双驱动的动态状态估计。13.一种终端，包括处理器及存储介质；其特征在于：所述存储介质用于存储指令；所述处理器用于根据所述指令进行操作以执行根据权利要求1-11任一项所述方法的步骤。14.计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现权利要求1-11任一项所述方法的步骤。
说明书desc
技术领域本发明属于电力系统动态状态估计技术领域，涉及一种基于模型数据双驱动的动态状态估计方法和系统。背景技术电力系统状态估计是维护电力系统安全运行的前提，但在实际配网中由于缺少量测装置和随机误差等原因，量测数据存在数据缺失和不良数据的问题，降低了状态估计的可靠性，目前已有二次线性状态估计检测不良数据的方法，但该方法的计算效率不高，难以满足配网对电力系统检测量的实时性要求，因此亟需对实时量测数据进行异常检测。而对于检测出的异常数据，需要基于历史数据进行预测替换，常规的预测方法有模型驱动和数据驱动两种，模型驱动基于物理模型，具有强解释性和因果逻辑，模型的泛化性能较好，但由于模型驱动主要考虑的因素为荷载因子和消耗需求，模型的预测精度较低；而基于数据驱动的深度神经网络，其基本原理是基于深层的非线性神经网络从大量高维样本中学到深层次的特征，实现复杂函数的逼近，预测精度相较于模型驱动高，但数据驱动对数据的依赖性很高，因此对数据的质量要求严格，其泛化性能相较于模型驱动较弱。因此，需要找到一种方法能够融合两种驱动方法，实现兼顾精度与泛化性能的数据预测，为后续实现精度更高的状态估计提供有力的数据支撑。同时针对配电网中的非高斯量测噪声的问题，常规的基于卡尔曼滤波框架的状态估计方法，其中假设的所有噪声，包括条件概率、联合概率等均高斯分布，虽然便于得到状态估计计算过程中的解析解，但对于非线性非高斯的动态系统，所有概率都有可能不是高斯分布的，而这种情况在配网中尤其常见，因此在状态估计中是无法得到解析解的，常规的基于卡尔曼滤波的状态框架并不能适用于配网情况，因此为解决配网量测数据中存在非高斯噪声的问题，亟需找到一种模型能够解决卡尔曼滤波易被噪声模型限制的问题，此研究具有较好的实际应用价值。发明内容为解决现有技术中存在的不足，本发明提供一种基于模型数据双驱动的动态状态估计方法和系统，能够对实时量测数据进行异常检测，融合模型数据预测驱动方法实现对量测量的精确预测，并解决配网非高斯噪声的问题，提高电力系统状态估计的准确度。本发明采用如下的技术方案。一种基于模型数据双驱动的动态状态估计方法，包括以下步骤：S1：获取电力系统的实时节点功率量测信息，并结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算，识别当前时刻异常信息，对应的节点为异常点；S2：采用历史节点功率量测信息和预训练的基于LSTM神经网络的数据驱动预测模型得到异常点处的功率预测值；S3：基于模型驱动预测模型进行负荷实时分类预测，得到异常点处的功率预测值；S4：结合历史节点功率量测信息，对S2与S3得到的预测值进行学习，得到异常点处的最终功率预测结果；S5：将最终功率预测结果作为当前时刻的伪量测量，替换当前时刻的异常信息，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计，实现基于模型数据双驱动的动态状态估计。优选地，S1中，节点功率量测信息包括节点注入功率和线路功率，其中节点注入功率包括节点的注入有功功率和无功功率，线路功率包括线路的有功功率和无功功率。优选地，S1中，识别异常信息的过程包括：1）将历史节点功率量测信息分为注入有功功率和无功功率、线路有功功率和无功功率四个量测集合，对于每个集合，从中随机选择M个信息样本，并将其作为树的根节点，随机生成切割点，以切割点信息大小为标准将样本分割为两个部分置于切割点两侧，在子节点中重复切割，直到最终剩下一个信息数据或是子节点达到限定高度；循环随机生成切割点及重复切割操作，生成K颗树；2）将每个集合所生成的K棵树计算平均高度，进而计算集合中样本信息异常分数，异常分数超过设定阈值则表示样本信息异常。优选地，对于量测集合g，其样本信息异常分数为：  其中，h为量测集合g对应树中每个样本点从根节点到其所在节点所经过路径长度关于样本数m的平均；E)为K棵树的h的平均值。 为m个样本的平均高度；，/＞为欧拉常数。优选地，S2中，对基于LSTM神经网络的数据驱动预测模型预训练时，LSTM神经网络的神经元内信息传递遵循的公式如下：      其中，分别代表遗忘门、输入门和输出门；、/＞、/＞分别表示遗忘门、输入门和输出门的权重；、/＞、/＞、/＞分别表示遗忘门、输入门、输出门和神经单元状态的门控单元偏置量；表示LSTM单元的输入向量；、/＞分别代表上一时刻和当前时刻神经元的状态；代表当前时刻t的输入节点的状态；、/＞分别代表上一时刻和当前时刻隐藏层状态变量；和tanh分别代表Sigmoid函数和Tanh函数。优选地，S3中，采用模型驱动预测模型，根据异常信息所在节点的负荷类型得出异常点处的注入有功功率预测值，在功率因数的基础上，计算异常信息所在节点注入无功功率的预测值，通过潮流计算得出异常点所在支路功率信息的预测值。优选地，异常点处的注入有功功率预测值为：  其中，为t时刻异常信息所在节点i的注入有功功率；C表示异常信息所在节点i的负荷类型的数量；为t时刻异常信息所在节点i的上游变电站节点r所服务的总节点数；表示t时刻异常信息所在节点i的类型为p的负荷的有功功率；表示t时刻异常信息所在节点上游变电站节点r的遥测功率；表示t时刻类型为p的负荷的荷载模型系数；表示荷载模型系数的平均值；表示类型为p的负荷在节点i处的消耗需求。优选地，所述异常信息所在节点注入无功功率的预测值计算式为：其中，为t时刻异常信息所在节点i的注入无功功率；表示t时刻异常信息所在节点i的类型为p的负荷的有功功率；C表示异常信息所在节点i的负荷类型的数量；为节点i处负荷类型为p的功率因数。优选地，S4具体过程为：分别采用S2和S3得到的异常点处的功率预测值，替换S1实时节点功率量测信息中的异常信息，并结合S2中的历史节点功率量测信息形成两大组训练集，对每大组训练集进行如下预测操作：将训练集分成若干小组，以用于训练多个基学习器，其中小组数量与基学习器数量相同；采用每小组数据训练与其对应的基学习器，每个基学习器输出各自的预测结果；将所有基学习器的输出作为元学习器的输入进行训练，元学习器的输出作为异常点处的功率预测值。优选地，S5中，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计的模型为：  其中，表示t时刻的状态估计值；表示t时刻的状态转移函数；，/＞分别表示过程噪声和量测噪声；为基于粒子滤波的量测量到状态量的非线型映射函数。11、根据权利要求10所述的一种基于模型数据双驱动的动态状态估计方法，其特征在于：从量测量到状态量的非线型映射逻辑为：采用状态后验概率表示状态估计结果，通过随机采样获得的离散样本点来获得后验概率，进而得到由粒子权值多项式表示的状态估计结果；求解粒子权值并将粒子权值小于设定值的项去掉，余下的项求和得到最终的状态估计结果。一种基于模型数据双驱动的动态状态估计系统，包括：信息获取与异常识别模块，用于获取电力系统的实时节点功率量测信息，并结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算，识别当前时刻异常信息，对应的节点为异常点；数据驱动预测模块，用于采用历史节点功率量测信息和预训练的基于LSTM神经网络的数据驱动预测模型得到异常点处的功率预测值；模型驱动预测模块，用于基于模型驱动预测模型进行负荷实时分类预测，得到异常点处的功率预测值；集成学习模块，用于结合历史节点功率量测信息，对数据驱动预测模块与模型驱动预测模块得到的预测值进行学习，得到异常点处的最终功率预测结果；状态估计模块，用于将最终功率预测结果作为当前时刻的伪量测量，替换当前时刻的异常信息，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计，实现基于模型数据双驱动的动态状态估计。一种终端，包括处理器及存储介质；所述存储介质用于存储指令；所述处理器用于根据所述指令进行操作以执行所述方法的步骤。计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现所述方法的步骤。本发明的有益效果在于，与现有技术相比：1）本发明考虑到配网量测数据容易出现异常的问题，结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算以对数据缺失及有误数据进行检测，提高了输入数据的可靠性；2）本发明融合了基于LSTM神经网络的数据驱动预测、模型驱动预测以及集成学习实现模型数据混合预测，从数据趋势及实际物理意义两部分对节点功率进行预测，本发明的数据驱动能够更深层次挖掘数据内部蕴含的特性，最终实现预测，提高了模型的泛化潜能，本发明的模型驱动依据变电站的检测信息，建立了具有实际物理意义的模型，解决了传统数据驱动对数据质量要求较高的问题。通过双驱动模型最终集成学习获得更优的伪量测量，降低了不良数据对状态估计结果的影响，提高了状态估计量测量的准确度；3）本发明考虑到传统卡尔曼滤波方法受到噪声模型限制，难以处理非高斯噪声干扰下的配电网量测数据，引入了粒子滤波对噪声进行处理，基于粒子滤波进行状态估计，使噪声分布不受模型限制，更加能够反映实际电力系统状态。附图说明图1为本发明一种基于模型数据双驱动的动态状态估计方法的流程图；图2为标准IEEE33节点配网系统结构图；图3为拉普拉斯噪声影响下不同节点的滤波结果图；图4为存在异常数据下的不同算法估计结果对比图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明的技术方案进行清楚、完整地描述。本申请所描述的实施例仅仅是本发明一部分的实施例，而不是全部实施例。基于本发明精神，本领域普通技术人员在没有作出创造性劳动前提下所获得的有所其它实施例，都属于本发明的保护范围。如图1所示，本发明实施例1提供一种基于模型数据双驱动的动态状态估计方法，在本发明优选但非限制性的实施方式中，所述方法包括以下步骤：S1：获取电力系统的实时节点功率量测信息，并结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算，识别当前时刻异常信息，对应的节点为异常点；S1.1：获取电力系统的实时节点功率量测信息；该步骤获取电力系统的实时初始信息，主要为节点功率量测信息；所述节点量测信息集合可表示如下： 其中，为节点功率量测信息集合，表示0-T时刻节点i所有量测量的集合；为i节点与j节点之间的线路；N、T分别为节点数量和量测周期；和/＞为节点注入功率，分别表示t时刻i节点的注入有功功率和无功功率；和/＞为线路功率，分别表示t时刻线路/＞的有功功率和无功功率。S1.2：并结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算，识别当前时刻异常信息，对应的节点为异常点；异常信息主要体现在数据缺失及数据异常。该步骤可快速检测大数据中异常数据，主要分为训练和评估两个阶段，具体如下：① 在离线训练中，将历史节点功率量测信息分为、/＞、/＞和/＞四个量测集合，对于每个集合，从中随机选择M个信息样本，并将其作为树的根节点，随机生成切割点o，以信息大小为标准将样本分割为两个部分置于切割点两侧，其中比切割点数据小的节点放在切割点的左侧，反之放在右侧，在剩余子节点中重复切割，直到最终剩下一个信息数据或是子节点达到限定高度；其中除去根节点外所有节点都称为子节点；通常可以先不设置最大值，取值一般为树的平均高度。对于成熟的孤立森林异常检测算法包，其限定高度可由程序自动确定，因此在本发明中不加以说明。循环随机生成切割点及之后的上述操作，即循环上述的随机生成切割点，以切割点信息大小为标准将样本分割为两个部分置于切割点两侧，在子节点中重复切割，直到最终剩下一个信息数据或是子节点达到限定高度，生成K颗树，根据经验，树的棵数通常设置为100。② 在评估中，将实时节点功率量测信息分为、/＞、/＞和/＞四个量测集合，逐个代入对应的树的集合中计算平均高度，进而计算集合中样本信息异常分数，异常分数超过设定阈值则表示样本信息异常。即将实时节点功率量测信息分为注入有功功率和无功功率、线路有功功率和无功功率四个量测集合，对于每个量测集合，分别进行1）中操作生成四组含有K棵树的集合，对每组树的集合计算平均高度，进而计算集合中样本信息异常分数，异常分数超过设定阈值则表示样本信息异常；其中，样本的异常分数越接近1，其是异常信息的可能性越高；如果异常分数小于0.5，那么基本可以判定为正常数据。具体的：每个量测集合g，对于其中的m个样本的平均高度与异常分数/＞计算如下：  其中，，/＞为欧拉常数；h为量测集合g中的每个样本点从根节点到其所在节点所经过路径长度关于样本数m的平均；E)为量测集合g在K棵树中计算路径长度关于树的棵数的平均值，即T棵树的h的平均值。S2：采用历史节点功率量测信息和预训练的基于LSTM神经网络的数据驱动预测模型得到异常点处的功率预测值；具体的获取历史节点功率量测信息及历史节点状态信息，其中历史节点状态信息用于后续的状态转移函数，历史信息输入基于LSTM神经网络的数据驱动预测模型中进行训练，并进行单变量单步预测得出当前t时刻的状态变量预测量。节点状态信息包括节点电压幅值及相角，具体表示为：，且有/＞ 其中，为节点状态信息集合；N、T分别为节点数量和量测周期；和/＞分别表示t时刻节点i的电压幅值及相角。在数据驱动预测方面，搭建LSTM神经网络，通过各节点的历史功率数据训练LSTM神经网络，对缺失及异常数据进行预测，得到异常点处负荷功率的预测值，从而实现模型预测，即通过构建长短期神经网络模型，基于历史功率数据对神经网络进行训练，用以实现对电力系统状态变量中节点异常注入功率的预测修正。具体的：将第一历史节点功率量测信息集合输入基于LSTM神经网络的数据驱动预测模型中进行预训练，将第二历史节点功率量测信息集合输入到预训练的基于LSTM神经网络的数据驱动预测模型，得到异常点处的功率预测值；具体实施时，S1可选择使用2010年历史数据，S2使用2010年历史数据作为第一历史节点功率量测信息集合进行模型预训练，使用2011年历史数据进行预测，S3使用2010年历史数据。公式-中Z历史量测数据表示输入数据，通常最后一个模块的o表示输出的异常信息预测值，即异常点处的功率预测值，公式-公式可对、/＞、/＞和这四个值即当前时刻t的量测量/＞进行预测。对基于LSTM神经网络的数据驱动预测模型预训练时，LSTM神经网络的神经元内信息传递遵循的公式如下：      其中，分别代表遗忘门、输入门和输出门；、/＞、/＞分别表示遗忘门、输入门和输出门的权重；、/＞、/＞、/＞分别表示遗忘门、输入门、输出门和神经单元状态的门控单元偏置量；表示LSTM单元的输入向量；、/＞分别代表上一时刻和当前时刻神经元的状态；代表当前时刻t的输入节点的状态；、/＞分别代表上一时刻和当前时刻隐藏层状态变量；和tanh分别代表Sigmoid函数和Tanh函数。S3：基于模型驱动预测模型进行负荷实时分类预测，得到异常点处的功率预测值；模型驱动预测方面，结合用户分类后的荷载模型系数曲线进行负荷的实时分类预测，得到异常点处总负荷的有功功率及无功功率。模型驱动预测模型对于t时刻的异常信息所在节点i的注入有功功率存在式-的关系。步骤S3中构建了结合用户分类曲线进行负荷的实时分类模型预测模型。其过程可表述为：通过遥测上游变电站节点r的功率流数据，根据荷载模型系数计算t时刻下游异常信息节点属于p类负荷的功率需求，其计算公式如下所示： 其中，为t时刻异常信息所在节点i的上游变电站节点r所服务的总节点数；表示t时刻异常信息所在节点i的类型为p的负荷的有功功率；本文中t时刻均表示任意时刻，该物理表达式反应的恒定的关系，与具体时间t为哪一时刻无关。表示t时刻异常信息所在节点上游变电站节点r的遥测功率；表示t时刻类型为p的负荷的荷载模型系数；表示荷载模型系数的平均值，此平均值代表了典型负荷的日变化，对于t时刻的具体平均值取值，可以通过查阅t时刻下不同类型负荷的改进日负荷变化曲线得出，而改进的日负荷曲线从基于历史数据的统计分析中得来，通常是季节、温度、一周中的使用天数的函数，即曲线是与季节、温度、一周内使用天数相关的，具体如何相关并不能用具体函数描述，只是宏观层面预测相关。实际计算时，不需要对/＞进行计算，直接通过查阅t时刻下不同类型负荷的改进日负荷变化曲线得出。因为是改进的曲线，对应曲线的横坐标为时刻t，纵坐标即为E。其中负荷荷载模型系数可由某一类型负荷日负荷功率变化的曲线得来，该曲线通常通过查阅文献或者统计相关历史数据得出。表示类型为p的负荷在节点i处的消耗需求，消耗需求取每月度电/计费周期天数；异常信息所在节点i处的总预测功率为所有类型负荷功率之和，表示如下： 其中，为t时刻异常信息所在节点i的注入有功功率；C表示异常信息所在节点i的负荷类型的数量。将异常信息所在节点的上述相关负荷信息输入上述模型驱动预测模型即实现负荷实时分类预测，得到异常信息预测值；在经验或历史统计得到的对应负荷类型的功率因数的基础上，计算得异常信息的预测值，计算式为：其中，为t时刻i节点的注入无功功率；表示t时刻异常信息所在节点i的类型为p的负荷的有功功率；C表示异常信息所在节点i的负荷类型的数量；为节点i处负荷类型为p的功率因数。最后通过潮流计算得出异常支路功率信息的预测值，具体公式为：式中，1j表示虚数，并且有，/＞，，/＞；和/＞分别为t时刻节点i的注入有功功率及无功功率；和/＞分别为线路/＞的电导及电纳；和/＞分别为t时刻节点i的电压幅值及相角；/＞和/＞分别表示t时刻线路/＞的有功功率和无功功率。S4：结合历史节点功率量测信息，对S2与S3得到的预测值进行学习，得到异常点处的最终功率预测结果；构建集成学习模型，包括第一层的基学习器和第二层元学习器；集成学习模型采用步骤S2及步骤S3得到的数据与历史节点功率量测信息，训练第一层的基学习器，将基学习器的输出作为元学习器的输入进行训练，最终元学习器的输出预测的最终结果，具体的：分别采用S2和S3得到的异常点处的功率预测值，替换S1实时节点功率量测信息中的异常信息，并结合S2中获取的历史节点功率量测信息形成两大组训练集，即S2得到的异常点处的功率预测值，替换S1实时节点功率量测信息中的异常信息，结合S2中获取的历史节点功率量测信息形成一大组训练集；S3得到的异常点处的功率预测值，替换S1实时节点功率量测信息中的异常信息，结合S2中获取的历史节点功率量测信息形成另一大组训练集，然后对每大组训练集进行如下预测操作：为了避免过拟合，通常在基学习器阶段采用交叉验证的方式训练模型，即将训练集分成若干小组，用于训练第一层的多个基学习器。每小组数据分别训练对应的基学习器，每个基学习器输出各自的预测结果；在第二层元学习器中，将第一层所有基学习器的输出作为元学习器的输入进行训练，元学习器的输出作为最终的预测结果，即为基于模型及数据模型的总体预测结果。即将训练集分成若干小组，以用于训练多个基学习器，其中小组数量与基学习器数量相同，本专利选取的是常见的5折交叉验证方法，即将训练集随机划分为5个无重叠的大小基本相等的小组；采用每小组数据训练与其对应的基学习器，每个基学习器输出各自的预测结果；将所有基学习器的输出作为元学习器的输入进行训练，元学习器的输出作为异常点处的功率预测值。即将两个训练集得到的多个预测结果输入第二层的元学习器中可以得到一个预测结果，即为最终预测结果。S5：将最终功率预测结果作为当前时刻的伪量测量，替换当前时刻的异常信息，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计，实现基于模型数据双驱动的动态状态估计。将替换异常信息后的当前时刻的全部量测信息作为系统输入进行状态估计，在该过程中采用粒子滤波方法，更加贴合配网噪声实际，实现对电力系统更加精确的状态估计。进一步优选地，针对实际配电网的量测数据受到非高斯噪声干扰的问题，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计的模型为：  其中，表示t时刻的状态估计值，t时刻在本文中表示的均为任意时刻，反应的是一种统一的、不变的物理约束，在此处可以狭义上理解为预测时刻。表示t时刻的状态转移函数，该状态转移的过程可表示为：将前t-1时刻历史状态数据输入LSTM中训练，并进行单变量单步预测得出当前t时刻的状态变量预测量；，/＞分别表示过程噪声和量测噪声，过程噪声可选用柯西分布噪声，量测噪声在实施算例中可选取为拉普拉斯噪声；过程噪声是指本身设计系统的噪声；为量测量到状态量的非线型映射函数。采用粒子滤波实现从量测量到状态量的非线性方程的建模，具体过程表示如下：对的建模作为状态估计的重要问题，在此采用粒子滤波的方式进行计算。其主要思想是，通过离散的随机采样点来模拟系统随机变量的概率密度函数，并将结果进行平均，最终得到状态的最小方差估计。首先，需要明确的为，对于式，已知的为量测量，而需要求解的为状态量/＞。其次，需要注意的是及/＞描述的为一种映射关系，难以用数学语言描述，可以理解为一种过程，在本发明中/＞可理解为一种黑箱处理过程，但本发明所进行的实际上为此过程的逆变换，即知道叠加噪声后的量测量，如何求得真实的状态量，该具体过程即为下述-的过程。同时，对于粒子滤波方法，可以使得状态估计的结果用表示，即为所求/＞。从量测量到状态量的非线型映射逻辑为：采用状态后验概率表示状态估计结果，通过随机采样获得的离散样本点来获得后验概率，进而得到由粒子权值多项式表示的状态估计结果；求解粒子权值并将粒子权值小于设定值的项去掉，余下的项求和得到最终的状态估计结果。具体为-的过程：、系统的状态估计结果可以用系统的状态后验概率表示，即用一组加权样本近似表示如下： 其中，，W为后验概率中采样的W个样本，/＞指0:T时刻的状态信息，/＞指1:T时刻量测信息，/＞指重要性概率密度函数，/＞指后验概率的第w个样本，/＞为/＞过程，即将0:T时刻的状态信息输入LSTM中得到当前时刻的状态输出；/＞、而实际应用中很难直接从后验概率分布中抽取样本，为此采用贝叶斯重要性采样，即引入一个简单的，易于采样的提议分布/＞，即随机采样获得离散样本点来近似获得后验概率，则函数/＞的期望可改写为其中，表示每个粒子的权值，其求解过程如下。、对式中粒子的权值进行求解：、首先，将的重要性概率密度函数进行分解，形式如下。、则后验概率密度函数的递归形式可表述如下：可以看出最终右侧式子与左侧存在时序上联系；、将式，式分别代入中粒子权值的公式，则粒子权值的递归形式可表示为：、通过多项式重采样方法，对权重大的粒子进行复制，删除权重小的粒子，最终得到，即为系统状态的最小方差估计/＞。具体的：根据公式的计算得到公式中的/＞，将公式中/＞小于设定值的项/＞去掉，余下的项求和得到/＞，/＞即为/＞，即S5得到的状态估计，也是本发明得到的状态估计值。应用实施例：图2为标准IEEE33节点的配电网系统，基准电压为12.66KV，对该配网系统进行状态估计，步骤为：1）选取2010年的负荷数据作为量测训练集，对于所有量测数据均叠加拉普帕斯噪声，噪声的参数为均值为0，且方差矩阵为，依据公式-检测出当前时刻的异常数据。2）依据LSTM的内部关系，参照公式-，将2010年的负荷数据作为训练集输入LSTM中进行训练，再将2011年的量测作为测试集输入LSTM中进行预测，计算得数据驱动下异常点处的功率预测；根据2010年的历史数据生成日负荷曲线，得到荷载模型系数平均的日曲线，将其代入公式-，计算模型驱动下得异常点处的功率预测；结合数据、模型模型的预测结果，通过集成学习中得到异常点处最终的预测功率，用最终的预测功率数据作为伪量测量替换异常数据。3）对配电网进行状态估计，具体过程参照公式-，并输出状态估计的最终结果。算例中采用均方根误差及绝对误差来对状态误差的结果进行评估。图3显示的为拉普拉斯噪声下节点7和节点23的滤波效果，可以看出经过本发明方法，不同噪声对最终的状态估计影响很小，计算结果几乎与实际结果相同。同时，表1中显示的为噪声影响下的估计性能分析，表中可以看出节点的AE值位于数量级，RMSE也在/＞数量级，状态估计的精确度很高，能够满足实际系统的要求。表1 拉普拉斯噪声影响下本发明所提方法的估计结果为进一步说明本发明所提方法在含有异常数据时的准确性，设置了如下情景作为对比：假设节点7，20,23的量测信息随机缺失，从样本序列9到样本序列23的误差为20%。并将本发明所提方法与UKF算法对比，结果如图4所示。图4中可以看出，异常调节对各算法的AE有着影响，UKF的AE波动明显且波动幅值远大于所提的状态估计，且所提算法的波动也很小，精确度及鲁棒性都远好于UKF算法。本发明实施例2提供一种基于模型数据双驱动的动态状态估计系统，包括：信息获取与异常识别模块，用于获取电力系统的实时节点功率量测信息，并结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算，识别当前时刻异常信息，对应的节点为异常点；数据驱动预测模块，用于采用历史节点功率量测信息和预训练的基于LSTM神经网络的数据驱动预测模型得到异常点处的功率预测值；模型驱动预测模块，用于基于模型驱动预测模型进行负荷实时分类预测，得到异常点处的功率预测值；集成学习模块，用于结合历史节点功率量测信息，对数据驱动预测模块与模型驱动预测模块得到的预测值进行学习，得到异常点处的最终功率预测结果；状态估计模块，用于将最终功率预测结果作为当前时刻的伪量测量，替换当前时刻的异常信息，采用替换异常信息后的当前时刻的全部节点功率量测信息进行状态估计，实现基于模型数据双驱动的动态状态估计。一种终端，包括处理器及存储介质；所述存储介质用于存储指令；所述处理器用于根据所述指令进行操作以执行实施例1所述方法的步骤。计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现实施例1所述方法的步骤。本发明的有益效果在于，与现有技术相比：1）本发明考虑到配网量测数据容易出现异常的问题，结合历史节点功率量测信息对实时节点功率量测信息进行异常分数计算以对数据缺失及有误数据进行检测，提高了输入数据的可靠性；2）本发明融合了基于LSTM神经网络的数据驱动预测、模型驱动预测以及集成学习实现模型数据混合预测，从数据趋势及实际物理意义两部分对节点功率进行预测，最终集成学习获得更优的伪量测量，降低了不良数据对状态估计结果的影响，提高了状态估计量测量的准确度；3）本发明考虑到传统卡尔曼滤波方法受到噪声模型限制，难以处理非高斯噪声干扰下的配电网量测数据，引入了粒子滤波对噪声进行处理，基于粒子滤波进行状态估计，使噪声分布不受模型限制，更加能够反映实际电力系统状态。本公开可以是系统、方法和/或计算机程序产品。计算机程序产品可以包括计算机可读存储介质，其上载有用于使处理器实现本公开的各个方面的计算机可读程序指令。计算机可读存储介质可以是可以保持和存储由指令执行设备使用的指令的有形设备。计算机可读存储介质例如可以是――但不限于――电存储设备、磁存储设备、光存储设备、电磁存储设备、半导体存储设备或者上述的任意合适的组合。计算机可读存储介质的更具体的例子包括：便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、静态随机存取存储器、便携式压缩盘只读存储器、数字多功能盘、记忆棒、软盘、机械编码设备、例如其上存储有指令的打孔卡或凹槽内凸起结构、以及上述的任意合适的组合。这里所使用的计算机可读存储介质不被解释为瞬时信号本身，诸如无线电波或者其它自由传播的电磁波、通过波导或其它传输媒介传播的电磁波、或者通过电线传输的电信号。这里所描述的计算机可读程序指令可以从计算机可读存储介质下载到各个计算/处理设备，或者通过网络、例如因特网、局域网、广域网和/或无线网下载到外部计算机或外部存储设备。网络可以包括铜传输电缆、光纤传输、无线传输、路由器、防火墙、交换机、网关计算机和/或边缘服务器。每个计算/处理设备中的网络适配卡或者网络接口从网络接收计算机可读程序指令，并转发该计算机可读程序指令，以供存储在各个计算/处理设备中的计算机可读存储介质中。用于执行本公开操作的计算机程序指令可以是汇编指令、指令集架构指令、机器指令、机器相关指令、微代码、固件指令、状态设置数据、或者以一种或多种编程语言的任意组合编写的源代码或目标代码，所述编程语言包括面向对象的编程语言—诸如Smalltalk、C++等，以及常规的过程式编程语言—诸如“C”语言或类似的编程语言。计算机可读程序指令可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络—包括局域网或广域网—连接到用户计算机，或者，可以连接到外部计算机。在一些实施例中，通过利用计算机可读程序指令的状态信息来个性化定制电子电路，例如可编程逻辑电路、现场可编程门阵列或可编程逻辑阵列，该电子电路可以执行计算机可读程序指令，从而实现本公开的各个方面。最后应当说明的是，以上实施例仅用以说明本发明的技术方案而非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等同替换，其均应涵盖在本发明的权利要求保护范围之内。
