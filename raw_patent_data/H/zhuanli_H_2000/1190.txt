标题title
针对WiFi6的无线局域网阻断方法、装置、设备以及存储介质
摘要abst
本发明提供一种针对WiFi6的无线局域网阻断方法、装置、设备以及存储介质，其接收所在无线局域网的无线信号，对无线信号进行扫频，获取所述无线信号中的数据包，解析出数据包信息，根据所述数据包信息确定所述无线局域网的加密方式，根据所述数据包信息确定所述无线局域网采用的WiFi协议是否为WiFi6协议，若所述WiFi协议为WiFi6协议，则向对应的无线接入点设备发送Deauthentication帧，并且，若所述加密协议类型为WPA3或者WPA2/WPA3混合，则向所述无线接入点设备补充持续发送降级Beacon帧和commit‑4‑1帧，若所述加密协议类型为WPA2或者WPA/WPA2混合且所述管理帧加密状态为启用，则向所述无线接入点设备补充持续发送降级Beacon帧，由此，可以有效阻断WiFi6协议的无线局域网。
权利要求书clms
1.一种针对WiFi6的无线局域网阻断方法，其特征在于，包括：接收所在无线局域网的无线信号；对所述无线信号进行扫频，获取所述无线信号中的数据包，解析出数据包信息，根据所述数据包信息确定所述无线局域网的加密方式，所述加密方式包括加密协议类型和管理帧加密状态；根据所述数据包信息确定所述无线局域网采用的WiFi协议是否为WiFi6协议；若所述WiFi协议为WiFi6协议，则向对应的无线接入点设备发送Deauthentication帧，并且，若所述加密协议类型为WPA3或者WPA2/WPA3混合，则向所述无线接入点设备补充持续发送降级Beacon帧和commit-4-1帧，若所述加密协议类型为WPA2或者WPA/WPA2混合且所述管理帧加密状态为启用，则向所述无线接入点设备补充持续发送降级Beacon帧。2.根据权利要求1所述的一种针对WiFi6的无线局域网阻断方法，其特征在于，所述确定所述无线局域网的加密方式，进一步包括：判断所述数据包信息中WAPI能力信息字段的MFPR或者MFPC标志位是否不为0，若是，则代表所述管理帧加密状态为启用。3.一种针对WiFi6的无线局域网阻断装置，其特征在于，包括：射频接收模块，用于接收所在无线局域网的无线信号；扫频模块，用于对所述无线信号进行扫频，获取所述无线信号中的数据包，解析出数据包信息，根据所述数据包信息确定所述无线局域网的加密方式，所述加密方式包括加密协议类型和管理帧加密状态；WiFi6识别模块，用于根据所述数据包信息确定所述无线局域网采用的WiFi协议是否为WiFi6协议；阻断模块，用于若所述WiFi协议为WiFi6协议，则向对应的无线接入点设备发送Deauthentication帧，并且，若所述加密协议类型为WPA3或者WPA2/WPA3混合，则向所述无线接入点设备补充持续发送降级Beacon帧和commit-4-1帧，若所述加密协议类型为WPA2或者WPA/WPA2混合且所述管理帧加密状态为启用，则向所述无线接入点设备补充持续发送降级Beacon帧。4.根据权利要求3所述的一种针对WiFi6的无线局域网阻断装置，其特征在于，所述确定所述无线局域网的加密方式，进一步包括：判断所述数据包信息中WAPI能力信息字段的MFPR或者MFPC标志位是否不为0，若是，则代表所述管理帧加密状态为启用。5.一种电子设备，其特征在于，包括存储模块，所述存储模块包括由处理器加载并执行的指令，所述指令在被执行时使所述处理器执行根据权利要求1-2任一项所述的一种针对WiFi6的无线局域网阻断方法。6.一种计算机可读存储介质，该计算机可读存储介质存储一个或多个程序，其特征在于，所述一个或多个程序当被处理器执行时，实现权利要求1-2任一项所述的一种针对WiFi6的无线局域网阻断方法。
说明书desc
技术领域本发明属于网络安全技术领域，尤其涉及一种针对WiFi6的无线局域网阻断方法、装置、设备以及存储介质。背景技术无线通信的飞速发展在给人们带来方便的同时，也给通信安全和保密工作提出了新的挑战。近几年，在我国已发生多起利用无线局域网进行的不法行为，其危害程度和严重性已引起有关部门的高度重视。因此，在适当的场所，对无线局域网的正常通信实施合法和必要的阻断，已成为实践中迫切的需要。WiFi6在调制、编码、多用户并发等方面进行了技术改进和优化，具有高速、低延时、长续航等特点，更贴合于现阶段多WiFi终端、多应用普及的场景，但是，目前尚未有针对WiFi6协议的无线局域网的阻断手段。发明内容基于此，针对上述技术问题，提供一种针对WiFi6的无线局域网阻断方法、装置、设备以及存储介质。本发明采用的技术方案如下：第一方面，提供一种针对WiFi6的无线局域网阻断方法，包括：接收所在无线局域网的无线信号；对所述无线信号进行扫频，获取所述无线信号中的数据包，解析出数据包信息，根据所述数据包信息确定所述无线局域网的加密方式，所述加密方式包括加密协议类型和管理帧加密状态；根据所述数据包信息确定所述无线局域网采用的WiFi协议是否为WiFi6协议；若所述WiFi协议为WiFi6协议，则向对应的无线接入点设备发送Deauthent ication帧，并且，若所述加密协议类型为WPA3或者WPA2/WPA3混合，则向所述无线接入点设备补充持续发送降级Beacon帧和commi t-4-1帧，若所述加密协议类型为WPA2或者WPA/WPA2混合且所述管理帧加密状态为启用，则向所述无线接入点设备补充持续发送降级Beacon帧。第二方面，提供一种针对WiFi6的无线局域网阻断装置，包括：射频接收模块，用于接收所在无线局域网的无线信号；扫频模块，用于对所述无线信号进行扫频，获取所述无线信号中的数据包，解析出数据包信息，根据所述数据包信息确定所述无线局域网的加密方式，所述加密方式包括加密协议类型和管理帧加密状态；WiFi6识别模块，用于根据所述数据包信息确定所述无线局域网采用的WiFi协议是否为WiFi 6协议；阻断模块，用于若所述WiFi协议为WiFi6协议，则向对应的无线接入点设备发送Deauthent icat ion帧，并且，若所述加密协议类型为WPA3或者WPA2/WPA3混合，则向所述无线接入点设备补充持续发送降级Beacon帧和commi t-4-1帧，若所述加密协议类型为WPA2或者WPA/WPA2混合且所述管理帧加密状态为启用，则向所述无线接入点设备补充持续发送降级Beacon帧。第三方面，提供一种电子设备，包括存储模块，所述存储模块包括由处理器加载并执行的指令，所述指令在被执行时使所述处理器执行上述第一方面的一种针对WiFi6的无线局域网阻断方法。第四方面，提供一种计算机可读存储介质，该计算机可读存储介质存储一个或多个程序，所述一个或多个程序当被处理器执行时，实现上述第一方面的一种针对WiFi6的无线局域网阻断方法。本发明可以有效阻断WiFi6协议的无线局域网。附图说明下面结合附图和具体实施方式对本发明进行详细说明：图1为本发明实施例提供的一种针对WiFi 6的无线局域网阻断方法的流程图；图2为本发明实施例提供的一种针对WiFi 6的无线局域网阻断装置的示意图；图3为本发明实施例提供的一种电子设备的示意图；图4为本发明实施例的应用环境的示意图。具体实施方式以下将结合说明书附图对本发明的实施方式予以说明。需要说明的是，本说明书中所涉及的实施方式不是穷尽的，不代表本发明的唯一实施方式。以下相应的实施例只是为了清楚的说明本发明专利的发明内容，并非对其实施方式的限定。对于该领域的普通技术人员来说，在该实施例说明的基础上还可以做出不同形式的变化和改动，凡是属于本发明的技术构思和发明内容并且显而易见的变化或变动也在本发明的保护范围之内。图4示出了本申请实施例的应用环境，其包括无线接入点设备、STA站点以及阻断设备，无线接入点设备是无线局域网的创建者，是无线局域网的中心节点，如一般家庭或办公室使用的无线路由器，STA站点是指连接到无线局域网中的终端，可以是装有无线网卡的计算机，也可以是具有WiFi模块的智能手机、平板电脑、PDA等等，可以是移动的，也可以是固定的，阻断设备设置在无线局域网中，用于对所在无线局域网对应的无线接入点设备进行阻断，使STA站点无法连接至无线接入点设备。如图1所示，本申请实施例提供一种针对WiFi 6的无线局域网阻断方法，应用于上述阻断设备，其具体流程如下：S101、接收所在无线局域网的无线信号。S102、对无线信号进行扫频，获取无线信号中的数据包，解析出数据包信息，根据数据包信息确定无线局域网的加密方式。其中，加密方式包括加密协议类型和管理帧加密状态。扫频是指对无线信号信道进行轮流扫描，从而捕获无线信号中的数据包。加密协议类型包括WEP、OPEN、WPA、WPA2、WPA/WPA2混合、WPA3以及WPA2/WPA3混合，下面对如何识别上述各加密协议类型进行说明。1、WEP类型：方法一：通过Beacon帧解析识别，当同时满足以下条件时识别为WEP类型：1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为1。2)Beacon帧中Tagged parameters中没有RSN和WPA的Tag字段。方法二：通过DATA帧解析识别，当满足以下任一条件时识别为WEP类型：1)DATA帧的Radiotap Header的Flags的WEP位为1。2)DATA帧中存在WEP parameters字段。2、OPEN类型：通过Beacon帧解析识别，当不满足以下任一条件时识别为OPEN类型：1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为0。2)Beacon帧中Tagged parameters中没有RSN和WPA的Tag字段。3、WPA类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA类型：1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为1。2)Beacon帧中Tagged parameters中有WPA Information Element字段。3)Beacon帧中Tagged parameters中没有RSN的Tag字段。4、WPA2类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA2类型：1)Beacon帧中Tagged parameters中有RSN的Tag字段。2)Beacon帧中RSN的Tag字段中Auth Key Managementtype指示为PSK或者指示为802.1x。5、WPA/WPA2混合类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA/WPA2混合类型:1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为1。2)Beacon帧中Tagged parameters中有WPA Information Element字段。3)Beacon帧中Tagged parameters中有RSN的Tag字段。6、WPA3类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA3类型：1)热点Beacon帧中有HE Capabilities字段，表示支持802.11ax。2)热点Beacon帧中Tagged parameters中存在RSN的Tag字段。3)Beacon帧中RSN的Tag字段中Auth Key Managementtype指示不为PSK。7、WPA2/WPA3混合类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA2/WPA3混合类型：1)Beacon帧中有HE Capabilities字段，表示支持802.11ax。2)Beacon帧中Tagged parameters中存在RSN的Tag字段。3)Beacon帧中RSN的Tag字段中有2种Auth Key Managementtype：Auth KeyManagementSuite Count指示为2。当数据包信息中WAPI能力信息字段的MFPR或者MFPC标志位不为0时，代表管理帧加密状态为启用，MFPR和MFPC标志位均为0，则代表管理帧加密状态为关闭。具体地，由射频接收芯片和天线接收所在无线局域网的无线信号。S103、根据数据包信息确定无线局域网采用的WiFi协议是否为WiFi6协议。当频段为2.4GHz或5GHz，且热点Beacon帧中有HE Capabilities字段时，表示无线局域网支持802.11ax，即采用WiFi6协议。S104、若WiFi协议为WiFi6协议，则向对应的无线接入点设备持续发送Deauthenticat ion帧，并且，若加密协议类型为WPA3或者WPA2/WPA3混合，则向无线接入点设备补充持续发送降级Beacon帧和commi t-4-1帧，若加密协议类型为WPA2或者WPA/WPA2混合且管理帧加密状态为启用，则向无线接入点设备补充持续发送降级Beacon帧。其中，由射频发射芯片、功率放大器和天线向无线接入点设备发送帧。下面对步骤S104的原理进行说明：WiFi的连接交互过程如下：1、AP广播发送Beacon。2、STA向AP发送携带有指定SSID的Probe Reques t。3、AP向STA发送Probe Response。4、STA对AP发送Authent icat ion Reques t：AP向STA发送Authent ict ion Response。STA对AP发送Authent icat ion Response。5、AP向STA发送Authent ict ion Response。6、STA向AP发送As sociat ion Reques t。7、AP向STA发送As sociat ion Response。***正常数据传输***8、STA向AP发送Di sas sociat ion。基于上述过程，如果一个STA想要从AP取消认证，或者一个AP想要从STA取消认证，无论哪一个设备都可以Deauthent icat ion帧以取消认证帧。由于认证帧是关联帧的先决条件，故取消认证帧会自动的导致取消关联的发生，取消认证帧不能被任何一方拒绝，除非双方已经协商了管理帧保护协议，并且MIC完整性检查失败。因此，Deauthent icat ion帧的发送会导致WiFi连接断开。当加密协议类型为WPA3或者WPA2/WPA3混合时，发送降级Beacon帧的作用就是为了使STA使用WPA2连接到AP，进而由Deauthent icat ion帧进行阻断，同时，由于发送降级Beacon帧不能百分之百保证所有的STA都会使用WPA2连接到AP，故通过commit-4-1帧将遗漏的WPA3请求资源耗尽。当加密协议类型为WPA2或者WPA/WPA2混合且管理帧加密状态为启用时，通过持续发送降级Beacon帧，将MFPC和MFPR字段的值都置为0，关闭管理帧加密状态，即不是帧保护的状态，这样就可以通过Deauthentication帧进行阻断。由上可知，本申请实施例可以有效阻断WiFi6协议的无线局域网。以下将详细描述本发明的一个或多个实施例的针对WiFi6的无线局域网阻断装置。本领域技术人员可以理解，这些阻断装置均可使用市售的硬件组件通过本方案所教导的步骤进行配置来构成。图2示出了本发明实施例提供的一种针对WiFi6的无线局域网阻断装置，如图2所示，该阻断装置包括射频接收模块11、扫频模块12、WiFi6识别模块13以及阻断模块14。射频接收模块11，用于接收所在无线局域网的无线信号。扫频模块12，用于对无线信号进行扫频，获取无线信号中的数据包，解析出数据包信息，根据数据包信息确定无线局域网的加密方式。其中，加密方式包括加密协议类型和管理帧加密状态。扫频是指对无线信号信道进行轮流扫描，从而捕获无线信号中的数据包。加密协议类型包括WEP、OPEN、WPA、WPA2、WPA/WPA2混合、WPA3以及WPA2/WPA3混合，下面对如何识别上述各加密协议类型进行说明。1、WEP类型：方法一：通过Beacon帧解析识别，当同时满足以下条件时识别为WEP类型：1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为1。2)Beacon帧中Tagged parameters中没有RSN和WPA的Tag字段。方法二：通过DATA帧解析识别，当满足以下任一条件时识别为WEP类型：1)DATA帧的Radiotap Header的Flags的WEP位为1。2)DATA帧中存在WEP parameters字段。2、OPEN类型：通过Beacon帧解析识别，当不满足以下任一条件时识别为OPEN类型：1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为0。2)Beacon帧中Tagged parameters中没有RSN和WPA的Tag字段。3、WPA类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA类型：1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为1。2)Beacon帧中Tagged parameters中有WPA Information Element字段。3)Beacon帧中Tagged parameters中没有RSN的Tag字段。4、WPA2类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA2类型：1)Beacon帧中Tagged parameters中有RSN的Tag字段。2)Beacon帧中RSN的Tag字段中Auth Key Managementtype指示为PSK或者指示为802.1x。5、WPA/WPA2混合类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA/WPA2混合类型:1)Beacon帧中Fixed parameters-Capabilities Information的字段Privacy为1。2)Beacon帧中Tagged parameters中有WPA Information Element字段。3)Beacon帧中Tagged parameters中有RSN的Tag字段。6、WPA3类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA3类型：1)热点Beacon帧中有HE Capabilities字段，表示支持802.11ax。2)热点Beacon帧中Tagged parameters中存在RSN的Tag字段。3)Beacon帧中RSN的Tag字段中Auth Key Managementtype指示不为PSK。7、WPA2/WPA3混合类型：通过Beacon帧解析识别，当同时满足以下条件时识别为WPA2/WPA3混合类型：1)Beacon帧中有HE Capabilities字段，表示支持802.11ax。2)Beacon帧中Tagged parameters中存在RSN的Tag字段。3)Beacon帧中RSN的Tag字段中有2种Auth Key Managementtype：Auth KeyManagementSuite Count指示为2。当数据包信息中WAPI能力信息字段的MFPR或者MFPC标志位不为0时，代表管理帧加密状态为启用，MFPR和MFPC标志位均为0，则代表管理帧加密状态为关闭。具体地，由射频接收芯片和天线接收所在无线局域网的无线信号。WiFi6识别模块13，用于根据数据包信息确定无线局域网采用的WiFi协议是否为WiFi6协议。阻断模块14，用于若WiFi协议为WiFi6协议，则向对应的无线接入点设备持续发送Deauthentication帧，并且，若加密协议类型为WPA3或者WPA2/WPA3混合，则向无线接入点设备补充持续发送降级Beacon帧和commit-4-1帧，若加密协议类型为WPA2或者WPA/WPA2混合且管理帧加密状态为启用，则向无线接入点设备补充持续发送降级Beacon帧。其中，由射频发射芯片、功率放大器和天线向无线接入点设备发送帧。下面对步骤S104的原理进行说明：WiFi的连接交互过程如下：1、AP广播发送Beacon。2、STA向AP发送携带有指定SSID的Probe Request。3、AP向STA发送Probe Response。4、STA对AP发送Authent icat ion Reques t：AP向STA发送Authent ict ion Response。STA对AP发送Authent icat ion Response。5、AP向STA发送Authent ict ion Response。6、STA向AP发送As sociat ion Reques t。7、AP向STA发送As sociat ion Response。***正常数据传输***8、STA向AP发送Di sas sociat ion。基于上述过程，如果一个STA想要从AP取消认证，或者一个AP想要从STA取消认证，无论哪一个设备都可以Deauthent icat ion帧以取消认证帧。由于认证帧是关联帧的先决条件，故取消认证帧会自动的导致取消关联的发生，取消认证帧不能被任何一方拒绝，除非双方已经协商了管理帧保护协议，并且MIC完整性检查失败。因此，Deauthent icat ion帧的发送会导致WiFi连接断开。当加密协议类型为WPA3或者WPA2/WPA3混合时，发送降级Beacon帧的作用就是为了使STA使用WPA2连接到AP，进而由Deauthent icat ion帧进行阻断，同时，由于发送降级Beacon帧不能百分之百保证所有的STA都会使用WPA2连接到AP，故通过commi t-4-1帧将遗漏的WPA3请求资源耗尽。当加密协议类型为WPA2或者WPA/WPA2混合且管理帧加密状态为启用时，通过持续发送降级Beacon帧，将MFPC和MFPR字段的值都置为0，关闭管理帧加密状态，即不是帧保护的状态，这样就可以通过Deauthent icat ion帧进行阻断。综上，上述实施例提供的针对WiFi6的无线局域网阻断装置可以执行前述各实施例中提供的针对WiFi6的无线局域网阻断方法。与上述构思相同，上述图2所示的针对WiFi6的无线局域网阻断装置的结构可实现为一电子设备，图3示出了本发明实施例提供的一种电子设备的结构示意性框图。示例性的，电子设备包括存储模块21以及处理器22，存储模块21包括由处理器22加载并执行的指令，指令在被执行时使处理器22执行本说明书上述一种针对WiFi6的无线局域网阻断方法部分中描述的根据本发明各种示例性实施方式的步骤。应当理解的是，处理器22可以是中央处理单元，该处理器22还可以是其它通用处理器、数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。其中，通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。本发明实施例中还提供一种计算机可读存储介质，该计算机可读存储介质存储一个或多个程序，一个或多个程序当被处理器执行时，实现上述一种针对WiFi6的无线局域网阻断方法部分中描述的根据本发明各种示例性实施方式的步骤。本领域普通技术人员可以理解，上文中所公开方法中的全部或某些步骤、系统、装置中的功能模块/单元可以被实施为软件、固件、硬件及其适当的组合。在硬件实施方式中，在以上描述中提及的功能模块/单元之间的划分不一定对应于物理组件的划分；例如，一个物理组件可以具有多个功能，或者一个功能或步骤可以由若干物理组件合作执行。某些物理组件或所有物理组件可以被实施为由处理器，如中央处理器、数字信号处理器或微处理器执行的软件，或者被实施为硬件，或者被实施为集成电路，如专用集成电路。这样的软件可以分布在计算机可读存储介质上，计算机可读存储介质可以包括计算机可读存储介质和通信介质。如本领域普通技术人员公知的，术语计算机可读存储介质包括在用于存储信息的任何方法或技术中实施的易失性和非易失性、可移除和不可移除介质。计算机可读存储介质包括但不限于RAM、ROM、EEPROM、闪存或其他存储器技术、CD-ROM、数字多功能盘或其他光盘存储、磁盒、磁带、磁盘存储或其他磁存储装置、或者可以用于存储期望的信息并且可以被计算机访问的任何其它的介质。此外，本领域普通技术人员公知的是，通信介质通常包含计算机可读指令、数据结构、程序模块或者诸如载波或其它传输机制之类的调制数据信号中的其他数据，并且可包括任何信息递送介质。示例性的，计算机可读存储介质可以是前述实施例的电子设备的内部存储单元，例如电子设备的硬盘或内存。计算机可读存储介质也可以是电子设备的外部存储设备，例如电子设备上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。前述各实施例提供的电子设备和计算机可读存储介质，可以有效阻断WiFi6协议的无线局域网。显然，本领域的技术人员可以对本申请进行各种改动和变型而不脱离本申请的范围。这样，倘若本申请的这些修改和变型属于本申请权利要求及其等同技术的范围之内，则本申请也意图包含这些改动和变型在内。
