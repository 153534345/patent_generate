标题title
用于增强大功率储能双向DC-DC变换器稳定性的方法和系统
摘要abst
本发明公开了一种用于增强大功率储能双向DC‑DC变换器稳定性的方法，包括：在高压直流母线侧加入Sinc滤波函数进行高次谐波滤除，在变换器LC滤波电路后使用虚拟电阻反馈法，增强系统阻尼性，并对PWM输出信号采用预设脉宽累加技术。本发明能够很好的消除大功率储能双向DC‑DC变换器中高压直流母线侧高次谐波干扰问题，并能抑制IGBT开关管开通开通关断时的电压尖峰和减少变换器元器件电压冲击和损耗，使系统稳定性得到大大提升。
权利要求书clms
1.一种用于增强大功率储能双向DC-DC变换器稳定性的方法，是应用于包括2200V高压直流母线、高压直流母线侧电容CM、非隔离型Buck/Boost双向DC-DC电路、LCL滤波电路、两个霍尔电流传感器、霍尔电压传感器、以及蓄电池的大功率储能双向DC-DC变换器中，其特征在于，所述方法包括以下步骤：从2200V高压直流母线获取高次谐波信号，利用sinc滤波函数对该高次谐波信号进行滤波处理，以得到第一直流信号和PWM调制信号。将步骤得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC电路的第二IGBT和第四IGBT，以得到第一谐波信号。将步骤得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC变换电路的第一IGBT和第三IGBT，以得到第二谐波信号。通过霍尔电压传感器分别获取步骤得到的第一谐波信号、以及步骤得到的第二谐波信号的电压值，并与步骤得到的第一直流信号的电压进行比较，如果第一谐波信号或者第二谐波信号的电压值大于第一直流信号的电压，则转入步骤，否则转入步骤。通过两个霍尔电流传感器获取步骤得到的第二谐波信号的电流值与预设电流值之间的差值作为内环PI控制的输入来调节第二IGBT和第四IGBT的占空比，以输出第三谐波信号，然后进入步骤。通过霍尔电压传感器获得步骤得到的第一谐波信号的电压值与预设电压值的差值作为外环PI控制的输入，以得到电流内环的预设值，并对两个霍尔电流传感器获得步骤得到的第一谐波信号的电流值与预设电流值的差值作为内环PI控制的输入来调节第一IGBT和第三IGBT的占空比，以输出第四谐波信号，然后进入步骤。将步骤和步骤输出的第三谐波信号和第四谐波信号输入LCL滤波电路进行滤波，使用虚拟电阻反馈法对滤波后的第三谐波信号和第四谐波信号进行处理，并将处理得到的结果进行合并，以得到第二直流信号。通过霍尔电压传感器获取步骤得到的第二直流信号的电压值，并判断其是否达到预设电压值，如果是则过程结束，否则进入步骤。将步骤获得的第二直流信号的电压值与预设电压值的差值输入PI控制器，以产生PWM输出信号。设置计数器i＝1；判断i是否大于步骤获得的PWM输出信号中脉冲信号的总数，如果是则进入步骤，否则进入步骤；通过霍尔电压传感器判断步骤获得的PWM输出信号中第i个脉冲信号的脉宽宽度是否大于预设脉宽阈值，如果是则进入步骤，否则进入步骤。设置计数器i＝i+1，并返回步骤；设置计数器j＝1；将步骤获得的第i个脉冲信号删除，并记录其脉宽宽度；判断j是否大于步骤中删除的脉冲信号个数，如果是则返回步骤，否则进入步骤；将步骤记录的第i个脉冲信号的脉宽宽度Tij设置为Tij＝Tij+Ti，其中Ti0＝0；判断步骤中累加脉宽宽度Tij是否大于预设脉宽阈值，如果是则进入步骤，否则进入步骤。设置计数器j＝j+1；并返回步骤。将步骤得到的累加脉宽宽度Tij清零，并在步骤得到的PWM输出信号中补上一个脉宽宽度为预设脉宽阈值的脉冲信号，将得到的结果作为PWM调制信号，并返回步骤。2.根据权利要求1所述的用于增强大功率储能双向DC-DC变换器稳定性的方法，其特征在于，步骤中预设电流值的取值范围是-200A到200A。3.根据权利要求1或2所述的用于增强大功率储能双向DC-DC变换器稳定性的方法，其特征在于，步骤和中预设电压值的取值范围是0到750V。4.根据权利要求1至3中任意一项所述的用于增强大功率储能双向DC-DC变换器稳定性的方法，其特征在于，PWM输出信号是由多个频率均为1000HZ、但脉宽宽度不同的脉冲信号组成。5.根据权利要求1所述的用于增强大功率储能双向DC-DC变换器稳定性的方法，其特征在于，步骤中，PWM输出信号频率为1000HZ，周期为1ms；通过霍尔电压传感器获取步骤获得的PWM输出信号中单个脉冲信号的电压值，将其与预设电压值相除再与周期1ms相乘，即可得到该脉冲信号的脉宽宽度。预设脉宽阈值的取值范围是0.5ms到1ms，优选为0.5ms。6.一种用于增强大功率储能双向DC-DC变换器稳定性的系统，是应用于包括2200V高压直流母线、高压直流母线侧电容CM、非隔离型Buck/Boost双向DC-DC电路、LCL滤波电路、两个霍尔电流传感器、霍尔电压传感器、以及蓄电池的大功率储能双向DC-DC变换器中，其特征在于，所述系统包括：第一模块，用于从2200V高压直流母线获取高次谐波信号，利用sinc滤波函数对该高次谐波信号进行滤波处理，以得到第一直流信号和PWM调制信号。第二模块，用于将第一模块得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC电路的第二IGBT和第四IGBT，以得到第一谐波信号。第三模块，用于将第一模块得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC变换电路的第一IGBT和第三IGBT，以得到第二谐波信号。第四模块，用于通过霍尔电压传感器分别获取第二模块得到的第一谐波信号、以及第三模块得到的第二谐波信号的电压值，并与第一模块得到的第一直流信号的电压进行比较，如果第一谐波信号或者第二谐波信号的电压值大于第一直流信号的电压，则转入第五模块，否则转入第六模块。第五模块，用于通过两个霍尔电流传感器获取第二模块得到的第二谐波信号的电流值与预设电流值之间的差值作为内环PI控制的输入来调节第二IGBT和第四IGBT的占空比，以输出第三谐波信号，然后进入第七模块。第六模块，用于通过霍尔电压传感器获得第二模块得到的第一谐波信号的电压值与预设电压值的差值作为外环PI控制的输入，以得到电流内环的预设值，并对两个霍尔电流传感器获得第二模块得到的第一谐波信号的电流值与预设电流值的差值作为内环PI控制的输入来调节第一IGBT和第三IGBT的占空比，以输出第四谐波信号，然后进入第七模块。第七模块，用于将第五模块和第六模块输出的第三谐波信号和第四谐波信号输入LCL滤波电路进行滤波，使用虚拟电阻反馈法对滤波后的第三谐波信号和第四谐波信号进行处理，并将处理得到的结果进行合并，以得到第二直流信号。第八模块，用于通过霍尔电压传感器获取第七模块得到的第二直流信号的电压值，并判断其是否达到预设电压值，如果是则过程结束，否则进入第九模块。第九模块，用于将第八模块获得的第二直流信号的电压值与预设电压值的差值输入PI控制器，以产生PWM输出信号。第十模块，用于设置计数器i＝1；第十一模块，用于判断i是否大于第九模块获得的PWM输出信号中脉冲信号的总数，如果是则进入第十五模块，否则进入第十二模块；第十二模块，用于通过霍尔电压传感器判断第九模块获得的PWM输出信号中第i个脉冲信号的脉宽宽度是否大于预设脉宽阈值，如果是则进入第十三模块，否则进入第十五模块。第十三模块，用于设置计数器i＝i+1，并返回第十一模块；第十四模块，用于设置计数器j＝1；第十五模块，用于将第十二模块获得的第i个脉冲信号删除，并记录其脉宽宽度；第十六模块，用于判断j是否大于第十五模块中删除的脉冲信号个数，如果是则返回第十三模块，否则进入第十七模块；第十七模块，用于将第十四模块记录的第i个脉冲信号的脉宽宽度Tij设置为Tij＝Tij+Ti，其中Ti0＝0；第十八模块，用于判断第十七模块中累加脉宽宽度Tij是否大于预设脉宽阈值，如果是则进入第二十模块，否则进入第十九模块。第十九模块，用于设置计数器j＝j+1；并返回第十六模块；第二十模块，用于将第十八模块得到的累加脉宽宽度Tij清零，并在第九模块得到的PWM输出信号中补上一个脉宽宽度为预设脉宽阈值的脉冲信号，将得到的结果作为PWM调制信号，并返回第二模块。
说明书desc
技术领域本发明属于电力电子技术领域，尤其涉及一种用于增强大功率储能双向DC-DC变换器稳定性的方法。背景技术随着能源短缺问题日益严重，可再生能源技术的发展得到高速发展，而与开再生能源联系密切的储能技术也得到了飞速发展，常见的储能变换系统都是通过双向DC-DC变换器来实现的，通常是由蓄电池、超级电容、钠硫电池，以及超导等组成的储能装置通过双向DC-DC变换器与直流母线之间建立能量传递关系。现有的双向DC-DC变换器的拓扑结构通常是采用Buck、Boost、CUK、SEPIC、ZEAT或这几种基础拓扑结构的组合，在控制方法上一般都是采用电压控制或者电流控制。然而，现有的双向DC-DC变换器都存在一些不可忽略的缺陷：第一、变换器输入端的直流信号含有大量高次谐波，容易对系统产生谐波干扰；第二、系统变换效率低；第三、系统稳定性差；第四、变换器中开关器件常受较大的电压冲击且功率器件损耗大。发明内容针对现有技术的以上缺陷或改进需求，本发明提供了一种用于增强大功率储能双向DC-DC变换器稳定性的方法和系统，其目的在于，解决现有双向DC-DC变换器由于直流母线侧存在高次谐波，导致对系统产生谐波干扰的技术问题，以及系统变换效率低的技术问题，以及系统稳定性差的技术问题，以及开关器件常受到较大的电压冲击且功率元件损耗大的技术问题。为实现上述目的，按照本发明的一个方面，提供了一种用于增强大功率储能双向DC-DC变换器稳定性的方法，是应用于包括2200V高压直流母线、高压直流母线侧电容CM、非隔离型Buck/Boost双向DC-DC电路、LCL滤波电路、两个霍尔电流传感器、霍尔电压传感器、以及蓄电池的大功率储能双向DC-DC变换器中，所述方法包括以下步骤：从2200V高压直流母线获取高次谐波信号，利用sinc滤波函数对该高次谐波信号进行滤波处理，以得到第一直流信号和PWM调制信号。将步骤得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC电路的第二IGBT和第四IGBT，以得到第一谐波信号。将步骤得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC变换电路的第一IGBT和第三IGBT，以得到第二谐波信号。通过霍尔电压传感器分别获取步骤得到的第一谐波信号、以及步骤得到的第二谐波信号的电压值，并与步骤得到的第一直流信号的电压进行比较，如果第一谐波信号或者第二谐波信号的电压值大于第一直流信号的电压，则转入步骤，否则转入步骤。通过两个霍尔电流传感器获取步骤得到的第二谐波信号的电流值与预设电流值之间的差值作为内环PI控制的输入来调节第二IGBT和第四IGBT的占空比，以输出第三谐波信号，然后进入步骤。通过霍尔电压传感器获得步骤得到的第一谐波信号的电压值与预设电压值的差值作为外环PI控制的输入，以得到电流内环的预设值，并对两个霍尔电流传感器获得步骤得到的第一谐波信号的电流值与预设电流值的差值作为内环PI控制的输入来调节第一IGBT和第三IGBT的占空比，以输出第四谐波信号，然后进入步骤。将步骤和步骤输出的第三谐波信号和第四谐波信号输入LCL滤波电路进行滤波，使用虚拟电阻反馈法对滤波后的第三谐波信号和第四谐波信号进行处理，并将处理得到的结果进行合并，以得到第二直流信号。通过霍尔电压传感器获取步骤得到的第二直流信号的电压值，并判断其是否达到预设电压值，如果是则过程结束，否则进入步骤。将步骤获得的第二直流信号的电压值与预设电压值的差值输入PI控制器，以产生PWM输出信号。设置计数器i＝1；判断i是否大于步骤获得的PWM输出信号中脉冲信号的总数，如果是则进入步骤，否则进入步骤；通过霍尔电压传感器判断步骤获得的PWM输出信号中第i个脉冲信号的脉宽宽度是否大于预设脉宽阈值，如果是则进入步骤，否则进入步骤。设置计数器i＝i+1，并返回步骤；设置计数器j＝1；将步骤获得的第i个脉冲信号删除，并记录其脉宽宽度；判断j是否大于步骤中删除的脉冲信号个数，如果是则返回步骤，否则进入步骤；将步骤记录的第i个脉冲信号的脉宽宽度Tij设置为Tij＝Tij+Ti，其中Ti0＝0；判断步骤中累加脉宽宽度Tij是否大于预设脉宽阈值，如果是则进入步骤，否则进入步骤。设置计数器j＝j+1；并返回步骤。将步骤得到的累加脉宽宽度Tij清零，并在步骤得到的PWM输出信号中补上一个脉宽宽度为预设脉宽阈值的脉冲信号，将得到的结果作为PWM调制信号，并返回步骤。优选地，步骤中预设电流值的取值范围是-200A到200A。优选地，步骤和中预设电压值的取值范围是0到750V。优选地，PWM输出信号是由多个频率均为1000HZ、但脉宽宽度不同的脉冲信号组成。优选地，步骤中，PWM输出信号频率为1000HZ，周期为1ms；通过霍尔电压传感器获取步骤获得的PWM输出信号中单个脉冲信号的电压值，将其与预设电压值相除再与周期1ms相乘，即可得到该脉冲信号的脉宽宽度。预设脉宽阈值的取值范围是0.5ms到1ms，优选为0.5ms。按照本发明的另一方面，提供了一种用于增强大功率储能双向DC-DC变换器稳定性的系统，是应用于包括2200V高压直流母线、高压直流母线侧电容CM、非隔离型Buck/Boost双向DC-DC电路、LCL滤波电路、两个霍尔电流传感器、霍尔电压传感器、以及蓄电池的大功率储能双向DC-DC变换器中，所述系统包括：第一模块，用于从2200V高压直流母线获取高次谐波信号，利用sinc滤波函数对该高次谐波信号进行滤波处理，以得到第一直流信号和PWM调制信号。第二模块，用于将第一模块得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC电路的第二IGBT和第四IGBT，以得到第一谐波信号。第三模块，用于将第一模块得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC变换电路的第一IGBT和第三IGBT，以得到第二谐波信号。第四模块，用于通过霍尔电压传感器分别获取第二模块得到的第一谐波信号、以及第三模块得到的第二谐波信号的电压值，并与第一模块得到的第一直流信号的电压进行比较，如果第一谐波信号或者第二谐波信号的电压值大于第一直流信号的电压，则转入第五模块，否则转入第六模块。第五模块，用于通过两个霍尔电流传感器获取第二模块得到的第二谐波信号的电流值与预设电流值之间的差值作为内环PI控制的输入来调节第二IGBT和第四IGBT的占空比，以输出第三谐波信号，然后进入第七模块。第六模块，用于通过霍尔电压传感器获得第二模块得到的第一谐波信号的电压值与预设电压值的差值作为外环PI控制的输入，以得到电流内环的预设值，并对两个霍尔电流传感器获得第二模块得到的第一谐波信号的电流值与预设电流值的差值作为内环PI控制的输入来调节第一IGBT和第三IGBT的占空比，以输出第四谐波信号，然后进入第七模块。第七模块，用于将第五模块和第六模块输出的第三谐波信号和第四谐波信号输入LCL滤波电路进行滤波，使用虚拟电阻反馈法对滤波后的第三谐波信号和第四谐波信号进行处理，并将处理得到的结果进行合并，以得到第二直流信号。第八模块，用于通过霍尔电压传感器获取第七模块得到的第二直流信号的电压值，并判断其是否达到预设电压值，如果是则过程结束，否则进入第九模块。第九模块，用于将第八模块获得的第二直流信号的电压值与预设电压值的差值输入PI控制器，以产生PWM输出信号。第十模块，用于设置计数器i＝1；第十一模块，用于判断i是否大于第九模块获得的PWM输出信号中脉冲信号的总数，如果是则进入第十五模块，否则进入第十二模块；第十二模块，用于通过霍尔电压传感器判断第九模块获得的PWM输出信号中第i个脉冲信号的脉宽宽度是否大于预设脉宽阈值，如果是则进入第十三模块，否则进入第十五模块。第十三模块，用于设置计数器i＝i+1，并返回第十一模块；第十四模块，用于设置计数器j＝1；第十五模块，用于将第十二模块获得的第i个脉冲信号删除，并记录其脉宽宽度；第十六模块，用于判断j是否大于第十五模块中删除的脉冲信号个数，如果是则返回第十三模块，否则进入第十七模块；第十七模块，用于将第十四模块记录的第i个脉冲信号的脉宽宽度Tij设置为Tij＝Tij+Ti，其中Ti0＝0；第十八模块，用于判断第十七模块中累加脉宽宽度Tij是否大于预设脉宽阈值，如果是则进入第二十模块，否则进入第十九模块。第十九模块，用于设置计数器j＝j+1；并返回第十六模块；第二十模块，用于将第十八模块得到的累加脉宽宽度Tij清零，并在第九模块得到的PWM输出信号中补上一个脉宽宽度为预设脉宽阈值的脉冲信号，将得到的结果作为PWM调制信号，并返回第二模块。总体而言，通过本发明所构思的以上技术方案与现有技术相比，能够取得下列有益效果：由于本发明采用了步骤，将高压直流母线后接入了sinc滤波函数，滤去了高次谐波，得到了较为平稳的直流信号，解决了大功率双向DC-DC变换器高压直流母线侧带有高次谐波信号导致变换器输入端直流信号质量差；由于本发明采用了步骤和步骤，通过在非隔离型Buck/Boost双向DC-DC电路工作在Boost状态时采用恒流控制即电流内环PI控制，；在非隔离型Buck/Boost双向DC-DC电路工作在Buck状态时采用恒压限流控制即电压外环和电流内环的双闭环PI控制，从而解决了系统变换效率低的问题；由于本发明采用了步骤，通过在LCL滤波电路后使用虚拟电阻反馈法，增加了系统阻尼效果，消除了系统谐振点，从而使系统的稳定性得到了大大提升，解决了系统稳定性差的问题；由于本发明采用了步骤到步骤，通过采用累计预设脉宽处理技术，即在预设脉宽处理技术的基础上通过将PWM输出信号中小于预设脉宽宽度的脉冲信号删除并记录其脉宽宽度，当每删除一次累计脉宽宽度大于预设脉宽宽度的脉冲信号时就补上一个脉宽宽度为预设脉宽的脉冲信号，这样就解决了预设脉宽处理技术容易造成的电压冲击问题和功率损耗问题。附图说明图1是大型矿车蓄电池储能双向DC-DC变换器拓扑结构图。图2是本发明用于增强大功率储能双向DC-DC变换器稳定性的方法的流程图；图3是大型矿车蓄电池储能双向DC-DC变换器工作在Boost模式下的状态示意图。图4是大型矿车蓄电池储能双向DC-DC变换器工作在Buck模式下的状态示意图。图5是大型矿车蓄电池储能双向DC-DC变换器工作在Boost模式下恒流控制逻辑图。图6是大型矿车蓄电池储能双向DC-DC变换器工作在Buck模式下恒压限流控制逻辑图。图7为理想条件下大型矿车蓄电池储能双向DC-DC变换系统PI控制流程图。图8为理想条件下大型矿车蓄电池储能双向DC-DC变换器引入虚拟电阻反馈法的PI控制流程图。图9为累计预设脉宽处理技术示意图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。此外，下面所描述的本发明各个实施方式中所涉及到的技术特征只要彼此之间未构成冲突就可以相互组合。以下针对外部直流母线电压等级为2200V的电驱动矿用卡车制动能量回收系统为例对本发明作进一步详细的说明，表1为该系统各元器件规格表。表1各元件规格表如图1所示，其为大功率储能双向DC-DC变换器的拓扑结构图，包括2200V高压直流母线、高压直流母线侧电容CM、非隔离型Buck/Boost双向DC-DC电路、LCL滤波电路、两个霍尔电流传感器、霍尔电压传感器、以及蓄电池。其中非隔离型Buck/Boost双向DC-DC电路采用H桥+并联交错的结构，采用H桥形式可以有效降低IGBT、电抗器、滤波电容的电压应力，采用并联交错的形式可以降低输出电流纹波，采用LCL滤波可以在相同电抗器容量下进一步降低输出电流波纹。如图2所示，本发明提出了一种用于增强大功率储能双向DC-DC变换器稳定性的方法，包括以下步骤：从2200V高压直流母线获取高次谐波信号，利用sinc滤波函数对该高次谐波信号进行滤波处理，以得到第一直流信号和PWM调制信号。经过本步骤以后，得到的第一直流信号的电压较为平稳，得到的PWM调制信号的脉冲宽度为0。本步骤的优点在于，解决了大功率双向DC-DC变换器高压直流母线侧带有高次谐波信号从而对元器件造成电压冲击影响系统稳定性的问题将步骤得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC电路的第二IGBT和第四IGBT，以得到第一谐波信号。将步骤得到的第一直流信号通过PWM调制信号调制后输入非隔离型Buck/Boost双向DC-DC变换电路的第一IGBT和第三IGBT，以得到第二谐波信号。通过霍尔电压传感器分别获取步骤得到的第一谐波信号、以及步骤得到的第二谐波信号的电压值，并与步骤得到的第一直流信号的电压进行比较，如果第一谐波信号或者第二谐波信号的电压值大于第一直流信号的电压，则转入步骤，否则转入步骤。通过两个霍尔电流传感器获取步骤得到的第二谐波信号的电流值与预设电流值之间的差值作为内环PI控制的输入来调节第二IGBT和第四IGBT的占空比，以输出第三谐波信号，然后进入步骤。具体而言，本步骤中预设电流值的取值范围是-200A到200A。本步骤的优点在于，采用恒流控制即电流内环PI控制，从而使系统的抗干扰性和稳定性更强。通过霍尔电压传感器获得步骤得到的第一谐波信号的电压值与预设电压值的差值作为外环PI控制的输入，以得到电流内环的预设值，并对两个霍尔电流传感器获得步骤得到的第一谐波信号的电流值与预设电流值的差值作为内环PI控制的输入来调节第一IGBT和第三IGBT的占空比，以输出第四谐波信号，然后进入步骤。具体而言，本步骤中预设电压值的取值范围是0到750V本步骤的优点在于，采用恒压限流控制即电压外环和电流内环的双闭环PI控制，从而使系统的抗干扰性和安全稳定性更强、系统变换效率更高；将步骤和步骤输出的第三谐波信号和第四谐波信号输入LCL滤波电路进行滤波，使用虚拟电阻反馈法对滤波后的第三谐波信号和第四谐波信号进行处理，并将处理得到的结果进行合并，以得到第二直流信号。本步骤的核心思想就是以控制算法来代替电阻，图7所示为理想条件下系统PI控制流程图，参照电容串联阻尼电阻的控制方法，可以对流程图作步骤变形，从而达到虚拟电阻替代实际阻尼电阻的控制，如图8所示，最后输出第二直流信号。经过本步骤以后，得到的第二直流信号的电压较为平稳且没有谐振点。本步骤的优点在于，解决了LCL滤波电路导致系统阻尼性大大降低的问题，消除了系统谐振点，从而使系统的稳定性得到了大大提升；通过霍尔电压传感器获取步骤得到的第二直流信号的电压值，并判断其是否达到预设电压值，如果是则过程结束，否则进入步骤。具体而言，预设电压值的取值范围是0到750V。将步骤获得的第二直流信号的电压值与预设电压值的差值输入PI控制器，以产生PWM输出信号。具体而言，本步骤中得到的PWM输出信号是由许多个频率均为1000HZ、但脉宽宽度不同的脉冲信号组成。设置计数器i＝1；判断i是否大于步骤获得的PWM输出信号中脉冲信号的总数，如果是则进入步骤，否则进入步骤；通过霍尔电压传感器判断步骤获得的PWM输出信号中第i个脉冲信号的脉宽宽度是否大于预设脉宽阈值，如果是则进入步骤，否则进入步骤。具体而言，PWM输出信号频率为1000HZ，周期则为1ms，通过霍尔电压传感器获取步骤获得的PWM输出信号中单个脉冲信号的电压值，将其与预设电压值相除再与周期1ms相乘，即可得到该脉冲信号的脉宽宽度。具体而言，预设脉宽阈值的取值范围是0.5ms到1ms，优选为0.5ms。设置计数器i＝i+1，并返回步骤；设置计数器j＝1；将步骤获得的第i个脉冲信号删除，并记录其脉宽宽度；判断j是否大于步骤中删除的脉冲信号个数，如果是则返回步骤，否则进入步骤；将步骤记录的第i个脉冲信号的脉宽宽度Tij设置为Tij＝Tij+Ti，其中Ti0＝0；判断步骤中累加脉宽宽度Tij是否大于预设脉宽阈值，如果是则进入步骤，否则进入步骤。设置计数器j＝j+1；并返回步骤。将步骤得到的累加脉宽宽度Tij清零，并在步骤得到的PWM输出信号中补上一个脉宽宽度为预设脉宽阈值的脉冲信号，将得到的结果作为PWM调制信号，并返回步骤。上述步骤到步骤的优点在于，通过对PWM输出信号采用累计预设脉宽处理技术解决了其容易造成电压冲击问题，从而使系统的安全性和稳定性得到了大大提升。本领域的技术人员容易理解，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
