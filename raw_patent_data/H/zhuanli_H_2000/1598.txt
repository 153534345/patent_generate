标题title
一种基于密钥魔方的海量密钥管理方法、系统及存储介质
摘要abst
本发明公开了一种基于密钥魔方的海量密钥管理方法、系统及存储介质，属于信息安全技术领域，该方法包括：构建具有预设数量位面和矩阵空间的密钥魔方；在密钥魔方的矩阵空间中配置预设字节的随机数；通过访问规则从密钥魔方上选中随机数获取密钥。在本发明中构建了1536个字节的密钥魔方，采用规则的方式访问海量密钥，同步密钥仅需同步密钥魔方；密钥魔方可以支持海量密钥的产生、导入、运算，具备海量密钥占用空间小、快速密钥同步等特点；有助于实现海量密钥的高效管理。
权利要求书clms
1.一种基于密钥魔方的海量密钥管理方法，其特征在于，该方法包括以下步骤：S1、构建具有预设数量位面和矩阵空间的密钥魔方；S2、在所述密钥魔方的矩阵空间中配置预设字节的随机数；S3、通过访问规则从密钥魔方上选中随机数获取密钥。2.根据权利要求1所述的一种基于密钥魔方的海量密钥管理方法，其特征在于，所述步骤S1中、所述密钥魔方的构建数量为N，N为大于等于1的正整数。3.根据权利要求1所述的一种基于密钥魔方的海量密钥管理方法，其特征在于，所述步骤S2中、每个所述矩阵空间中配置一个随机数，单个所述随机数为1字节随机数，在0x00~0xFF之间随机选取。4.根据权利要求3所述的一种基于密钥魔方的海量密钥管理方法，其特征在于，所述步骤S2中，若矩阵空间中存在重复的随机数，则重新选取随机数检测不重复后再次配置。5.根据权利要求1所述的一种基于密钥魔方的海量密钥管理方法，其特征在于，所述步骤S3中，所述访问规则中包括：位面、矩阵空间位置、旋转次数和旋转轨迹。6.根据权利要求5所述的一种基于密钥魔方的海量密钥管理方法，其特征在于，所述旋转轨迹包括：上、下、左、右、右上、左上、右下、左下的8个轨迹。7.根据权利要求1所述的一种基于密钥魔方的海量密钥管理方法，其特征在于，构建的所述密钥魔方支持导入密钥。8.一种基于密钥魔方的海量密钥管理系统，其特征在于，应用时执行如权利要求1-7中任一项所述的一种基于密钥魔方的海量密钥管理方法，实现海量密钥管理，该系统包括：密钥魔方构建模块，用于构建具有预设数量位面和矩阵空间的密钥魔方；随机数配置模块，用于在所述密钥魔方的矩阵空间中配置预设字节的随机数；密钥获取模块，用于通过访问规则从密钥魔方上选中随机数获取密钥。9.根据权利要求8所述的一种基于密钥魔方的海量密钥管理系统，其特征在于，该系统还包括：随机数更新模块，用于在矩阵空间中存在重复的随机数时，重新选取随机数检测不重复后再次配置。10.一种存储介质，其上存储有计算设备可读的一个或多个程序，其特征在于：所述一个或多个程序包括指令，所述指令当由计算设备执行时，使得所述计算设备执行如权利要求1至7中任一项所述的一种基于密钥魔方的海量密钥管理方法。
说明书desc
技术领域本发明涉及信息安全技术领域，更具体的说是涉及一种基于密钥魔方的海量密钥管理方法、系统及存储介质。背景技术当前，信息产业发展迅速，电子商务、电子政务应用逐渐普及，网上银行、网上证券、网上购物等应用平台不断的推陈出新。大数据、云存储也蓬勃发展。随着互联网应用的不断发展，安全技术逐渐深入到信息领域的各个方面，用户对安全设备在高效性、稳定性、易用性、可管理性和可移植性等各方面的需求不断提高。随着密码法的普及，越来越多的用户选用了密码设备、密码模块，随着用户的增加相应的所需的密钥数量愈发的增多，出现了上亿级别的密钥量需求，现有密钥的产生效率也较低，越来越不能满足人们的日益增长的密钥量需求；同时，作为密钥安全存储介质的密码卡、密码机、密钥管理系统等产品，通过不断增加存储芯片或采用密文密钥方案增加磁盘容量等方式解决，因存储功能有限也不能有效满足人们的日益增长的密钥量需求。并且，现有方案中上亿级别的密钥量，占用的存储空间非常大，设备之间密钥同步也产生了巨大的困难。因此，如何高效的产生海量密钥，并使生成的海量密钥占用空间小、可以快速同步海量密钥；是本领域技术人员亟需解决的技术问题。发明内容有鉴于此，本发明提供至少解决上述部分技术问题的一种基于密钥魔方的海量密钥管理方法、系统及存储介质，使用该方法便于高效的产生海量密钥，同时具备占用空间小、可以快速同步海量密钥的特点，有助于实现海量密钥的高效管理。为实现上述目的，本发明采取的技术方案为：第一方面，本发明提供一种基于密钥魔方的海量密钥管理方法，该方法包括以下步骤：S1、构建具有预设数量位面和矩阵空间的密钥魔方；S2、在所述密钥魔方的矩阵空间中配置预设字节的随机数；S3、通过访问规则从密钥魔方上选中随机数获取密钥。进一步地，所述步骤S1中，所述密钥魔方的构建数量为N，N为大于等于1的正整数。进一步地，所述步骤S2中、每个所述矩阵空间中配置一个随机数，单个所述随机数为1字节随机数，在0x00~0xFF之间随机选取。进一步地，所述步骤S2中，若矩阵空间中存在重复的随机数，则重新选取随机数检测不重复后再次配置。进一步地，所述步骤S3中，访问规则中包括密钥魔方的：位面、矩阵空间位置、旋转次数和旋转轨迹。进一步地，所述旋转轨迹包括：上、下、左、右、右上、左上、右下、左下的8个轨迹。进一步地，构建的所述密钥魔方支持导入密钥。第二方面，本发明还提供一种基于密钥魔方的海量密钥管理系统，应用于上述的一种基于密钥魔方的海量密钥管理方法，进行海量密钥管理；该系统包括：密钥魔方构建模块、随机数配置模块和密钥获取模块，其中：密钥魔方构建模块，用于构建具有预设数量位面和矩阵空间的密钥魔方；随机数配置模块，用于在所述密钥魔方的矩阵空间中配置预设字节的随机数；密钥获取模块，用于通过访问规则从密钥魔方上选中随机数获取密钥。进一步地，该系统还包括：随机数更新模块，用于在矩阵空间中存在重复的随机数时，重新选取随机数检测不重复后再次配置。第三方面，本发明还提供一种存储介质，其上存储有计算设备可读的一个或多个程序，所述一个或多个程序包括指令，所述指令当由计算设备执行时，使得所述计算设备执行如上述的一种基于密钥魔方的海量密钥管理方法。与现有技术相比，本发明至少具有如下有益技术效果：本发明公开了一种基于密钥魔方的海量密钥管理方法、系统及存储介质，利用该方法可以高效的产生海量密钥，同时具备海量密钥占用空间小、可以快速同步海量密钥的特点，使用便利，有助于实现海量密钥的高效管理。本发明的其它特征和优点将在随后的说明书中阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点可通过在所写的说明书以及附图中所特别指出的结构来实现和获得。下面通过附图和实施例，对本发明的技术方案做进一步的详细描述。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。图1为本发明实施例提供的一种基于密钥魔方的海量密钥管理方法流程示意图。图2为本发明实施例提供的密钥魔方的结构示意图。图3为本发明实施例提供的密钥魔方转动的轨迹示意图。图4为本发明实施例提供的一种基于密钥魔方的海量密钥管理系统框架示意图。具体实施方式下面将参照附图更详细地描述本公开的示例性实施例。虽然附图中显示了本公开的示例性实施例，然而应当理解，可以以各种形式实现本公开而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更透彻地理解本公开，并且能够将本公开的范围完整的传达给本领域的技术人员。实施例1：参照图1所示，本发明实施例提供了一种基于密钥魔方的海量密钥管理方法，该方法主要包括以下步骤：S1、构建具有预设数量位面和矩阵空间的密钥魔方；S2、在所述密钥魔方的矩阵空间中配置预设字节的随机数；S3、通过访问规则从密钥魔方上选中随机数获取密钥。下面对上述方法的具体实施方式进行进一步的说明。在本实施例中，密钥魔方的结构如图2所示，密钥魔方优选的具备6个位面，各位面为16*16单位的矩阵空间，上述6个位面构成一个立方体。优选的，随机产生0x00~0xFF之间的随机数放置于各位面的16*16个单位矩阵中，各位面单位矩阵中的随机数不重复，即每一个位面的256个单位矩阵随机放置0x00~0xFF的随机数。若查找到单位矩阵空间中存在重复随机数，则重新产生随机数，检测不存重复后再次放置，确保不重复。产生海量密钥的过程即产生6个位面的0x00~0xFF的随机数并放置在单位矩阵中，再将6个位面组成密钥魔方。基于规则的访问机制：随机选取一个位面的一个单位矩阵空间，设置访问规则催动密钥魔方整体转动，密钥魔方转动形成轨迹，被轨迹选中的随机数为密钥。该密钥魔方可存放在密码模块内部，密码运算过程中由用户赋能和指定。用户通过规则访问密钥魔方，选中的密钥进行密码运算。本发明实施例中，密钥魔方支持导入密钥功能，分析待导入的密钥并返回访问该密钥的规则，使用返回的规则即可访问该密钥。下面对本发明中的访问规则的优选实施方式进行介绍：在本实施例中，密钥魔方具有6个位面，优选的依次采用A、B、C、D、E、F命名，单位矩阵从第一排第一列开始命名，第一排第一列选中的单位矩阵为1，第二排第一列选中的单位矩阵为17，以此类推。假设选中了第一位面，第一排第一列的单位矩阵则命名为A1，A1的内容配置为0xaa。如图3所示，随机选中一个单位矩阵，密钥魔方整体转动时，可以预设上、下、左、右、右上、左上、右下、左下8个轨迹，分别对应1~8标识，如表1所示。。例如，随机选中第一位面的第一排第一列的单位矩阵，采用左转轨迹，转动15次则获取到的随机数是0xaa，0x22，0x55，0x77，0x23，0x89，0xef，0xff，0x01，0x09，0x28，0x31，0x42，0x54，0x70，0x8f该16字节随机数为用户指定密钥，可以基于该密钥进行密码运算。旋转轨迹也可以跨位面进行，例如，选中第一位面的第一排第一列的单位矩阵，采用右转轨迹，则获取到的随机数为另一个位面的单位矩阵。用户可以设定访问规则，密钥魔方根据规则旋转，选中对应的随机数作为密钥。优选的，访问规则中包括的内容如下表2所示。即访问规则中包括密钥魔方的：位面、矩阵空间位置、旋转次数和旋转轨迹等信息。确定位面和单位矩阵的位置，可以选中随机数的第一个字节，每个单位矩阵位置有8种旋转方式，可以选中不同的8个随机数。旋转次数：所需要的密钥字节数减1。由于第一字节已经选中，若需要16字节密钥，则旋转次数赋值15。旋转轨迹1：旋转轨迹1须先确定，以确定旋转方式。后续旋转轨迹可以不指定，若不指定后续旋转轨迹，则密钥魔方按照当前指定的旋转方式旋转。例如，若用户发送 A 1 15 3 0 的规则指令，根据规则用户选中了A位面，第一个单位矩阵，采用左转的方式旋转15次，该指令获取的随机数为密钥。则选中密钥魔方的第一位面的第一排的16字节随机数做密钥。即: 0xaa，0x22，0x55，0x77，0x23，0x89，0xef，0xff，0x01，0x09，0x28，0x31，0x42，0x54，0x70，0x8f。该密钥临时保存，运算完毕清零。每次密码运算时均根据规则指令访问密钥，不以任何形式导出明文密钥。现有模式密钥动辄上T字节，密钥同步过程非常慢。本实施例中，因密钥魔方只有1536字节，因此占用空间很小，备份恢复过程速度非常快。备份密钥魔方和恢复密钥魔方，可以实现两个设备之间快速同步密钥魔方。在本实施例中，密钥魔方支持导入密钥功能，分析待导入的密钥并返回访问该密钥的规则，假设导入密钥为 0xaa，0x22，0x55，0x77，0x23，0x89，0xef，0xff，0x01，0x09，0x28，0x31，0x42，0x54，0x70，0x8f，导入数据并返回A 1 15 3 0的规则，用户使用返回的规则即可访问该密钥。使用本方法，以8字节密钥为例；由于随机选取的点有1536个，每次旋转有8个轨迹，可以访问到的密钥即为1536*78 = 8854734336，可以访问8字节密钥88亿个，同理能够访问到的16字节的密钥4万亿个左右。若密钥量仍然不够，可以配置多个密钥魔方即可满足需求。由上述实施例的描述可知，本发明提供了一种基于密钥魔方的海量密钥管理方法，该方法中构建了1536字节的密钥魔方，可以支持海量密钥的产生、导入、运算等密钥管理机制，具备海量密钥占用空间小、快速密钥同步等特点；该方法可加载于PCI密码卡，密钥安全性高，稳定性好，使用便利；适用目前国内主流的对称密钥管理、SM2密钥管理；有助于实现海量密钥的高效管理。实施例2：参照图4所示，本发明实施例还提供了一种基于密钥魔方的海量密钥管理系统，应用于上述实施例1所描述的一种基于密钥魔方的海量密钥管理方法，实现海量密钥管理，该系统包括：密钥魔方构建模块、随机数配置模块和密钥获取模块，其中：密钥魔方构建模块，用于构建具有预设数量位面和矩阵空间的密钥魔方；随机数配置模块，用于在密钥魔方的矩阵空间中配置预设字节的随机数；密钥获取模块，用于通过访问规则从密钥魔方上选中随机数获取密钥。作为本实施例的进一步优化，该系统还包括：随机数更新模块，用于在矩阵空间中存在重复的随机数时，重新选取随机数检测不重复后再次配置。本发明实施例所提供的一种基于密钥魔方的海量密钥管理系统，其实现原理及产生的技术效果和前述方法实施例相同，为简要描述，该实施例部分未提及之处，可参考前述方法实施例中相应内容，在此不再赘述。实施例3：本发明实施例还提供一种存储介质，其上存储有计算设备可读的一个或多个程序，一个或多个程序包括指令，指令当由计算设备执行时，使得计算设备执行实施例1中的一种基于密钥魔方的海量密钥管理方法。这里的计算机可读存储介质的示例包括：只读存储器 、随机存取可编程只读存储器 、电可擦除可编程只读存储器、随机存取存储器 、动态随机存取存储器 、静态随机存取存储器、闪存、非易失性存储器、CD-ROM、DVD-ROM、蓝光或光盘存储器、硬盘驱动器、固态硬盘、卡式存储器卡或极速数字卡)、磁带、软盘、磁光数据存储装置、光学数据存储装置、硬盘、固态盘以及任何其他装置，上述任何其他装置被配置为以非暂时性方式存储计算机程序以及任何相关联的数据、数据文件和数据结构并将所述计算机程序以及任何相关联的数据、数据文件和数据结构提供给处理器或计算机使得处理器或计算机能执行所述计算机程序。上述计算机可读存储介质中的计算机程序可在诸如客户端、主机、代理装置、服务器等计算机设备中部署的环境中运行，此外，在一个示例中，计算机程序以及任何相关联的数据、数据文件和数据结构分布在联网的计算机系统上，使得计算机程序以及任何相关联的数据、数据文件和数据结构通过一个或多个处理器或计算机以分布式方式存储、访问和执行。以上对本发明实施例进行了详细介绍，对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想。对所公开的实施例的上述说明，使本领域专业技术人员能够实现或使用本发明。对这些实施例的多种修改对本领域的专业技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所示的这些实施例，而是要符合与本文所公开的原理和新颖特点相一致的最宽的范围。
