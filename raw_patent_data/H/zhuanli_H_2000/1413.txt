标题title
登录控制方法、装置、服务器及存储介质
摘要abst
本申请涉及计算机网络安全领域，尤其涉及登录控制方法、装置、服务器及存储介质；该方法包括接收登录端的令牌获取请求；生成动态令牌；确定与用户账户信息预设关联的目标社交账户，利用目标社交账户所属的目标社交系统向目标社交账户发送应用消息，应用消息携带有动态令牌。本方案在登录内部系统时，动态令牌可直接发送到预设关联的目标社交账户，而且以应用消息的形式进行发送；一方面解决了令牌短信通知的费用问题；另一方面，操作更加便捷。
权利要求书clms
1.一种登录控制方法，其特征在于，所述登录控制方法包括：接收登录端的令牌获取请求；所述令牌获取请求中携带有用户账户信息；生成动态令牌；确定与所述用户账户信息预设关联的目标社交账户，利用所述目标社交账户所属的目标社交系统向所述目标社交账户发送应用消息，所述应用消息携带有所述动态令牌。2.根据权利要求1所述的登录控制方法，其特征在于，所述登录控制方法还包括：将所述动态令牌与所述用户账户信息进行关联存储。3.根据权利要求2所述的登录控制方法，其特征在于，所述登录控制方法还包括：接收登录请求，所述登录请求携带有所述用户账户信息以及待验证动态令牌；对所述登录请求进行验证，并根据验证结果生成对应的响应消息，并利用所述目标社交系统将所述响应消息发送给所述目标社交账户。4.根据权利要求3所述的登录控制方法，其特征在于，所述对所述登录请求进行验证，并根据验证结果生成对应的响应消息包括：判断所述用户账户信息是否匹配；如否，确定验证失败；如是，获取所述用户账户信息最近一次关联存储的最新动态令牌；并判断所述最新动态令牌是否处于有效状态；如否，确定验证失败；如是，将所述最新动态令牌作为参考动态令牌；并判断所述待验证动态令牌与所述参考动态令牌是否匹配；如否，确定验证失败；如是，则验证通过；在所述确定验证失败时，拒绝对应用户账户登录，并生成登录失败的响应消息；在所述确定验证通过时，允许对应用户账户登录，并生成登录成功的响应消息。5.根据权利要求4所述的登录控制方法，其特征在于，所述生成登录失败的响应消息包括：在判断所述用户账户信息不匹配时，生成账户/密码错误的第一响应消息；在判断所述最新动态令牌未处于有效状态时，生成动态令牌过期的第二响应消息；在判断所述待验证动态令牌与所述参考动态令牌不匹配时，生成动态令牌输入错误的第三响应消息；所述登录失败的响应消息包括所述第一响应消息、所述第二响应消息和所述第三响应消息。6.根据权利要求4所述的登录控制方法，其特征在于，所述判断所述最新动态令牌是否处于有效状态包括：判断所述最新动态令牌是否未作为所述参考动态令牌并参与过与待验证动态令牌的匹配，若是，且所述最新动态令牌处于设定有效期内，则判定所述最新动态令牌处于有效状态；否则，判定所述最新动态令牌未处于有效状态。7.根据权利要求1-6任一项所述的登录控制方法，其特征在于，所述目标社交系统包括企业微信、钉钉和飞书中的至少一种。8.一种登录控制装置，其特征在于，所述登录控制装置包括：接收模块，用于接收登录端的令牌获取请求；所述令牌获取请求中携带有用户账户信息；令牌管理模块，用于生成动态令牌；处理模块，用于确定与所述用户账户信息预设关联的目标社交账户，利用所述目标社交账户所属的目标社交系统向所述目标社交账户发送应用消息，所述应用消息携带有所述动态令牌。9.一种服务器，其特征在于，包括处理器、存储器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现如权利要求1-7中任意一项所述的登录控制方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机程序；所述计算机程序被处理器执行时实现如权利要求1-7中任意一项所述的登录控制方法。
说明书desc
技术领域本申请涉及计算机网络安全领域，尤其是涉及登录控制方法、装置、服务器及存储介质。背景技术为了提高企业内部系统安全性，在企业员工/管理人员等登录内部系统时，输入正确的账号密码后，打开令牌生成器的应用程序，获取动态令牌，然后将该动态令牌输入登录界面相应的令牌输入框中，才能进入到企业内部系统中。打断了用户办公，操作比较不便。尽管目前可以通过短信通道的方式，在用户输入正确的账号密码后，自动发送动态令牌，但是短信通道本身存在费用成本问题，而且还需要绑定用户手机号，将手机号与用户账号关联。因此，如何提供一种无需打断用户登录过程，同时也不需要增加费用成本的方式，以更好满足用户需求。发明内容为了更好地满足用户登录公司内部系统的需求，本申请提供了登录控制方法、装置、服务器及存储介质。第一方面，本申请提供的登录控制方法，采用如下的技术方案：一种登录控制方法，包括：接收登录端的令牌获取请求；所述令牌获取请求中携带有用户账户信息；生成动态令牌；确定与所述用户账户信息预设关联的目标社交账户，利用所述目标社交账户所属的目标社交系统向所述目标社交账户发送应用消息，所述应用消息携带有所述动态令牌。通过采用上述技术方案，在登录内部系统时，动态令牌可直接发送到预设关联的目标社交账户，而且以应用消息的形式进行发送；一方面解决了令牌短信通知的费用问题；另一方面，在登录过程无需切换到令牌生成器单独生成动态令牌，可直接在登录界面触发获取动态令牌，操作更加便捷。可选的，所述登录控制方法还包括：将所述动态令牌与所述用户账户信息进行关联存储。通过采用上述技术方案，在该用户账户输入动态令牌进行登录时，系统可直接获取为该用户账户对应生成的动态令牌，从而可准确地将输入的动态令牌与生成的动态令牌直接进行比对，实现更好地关联比对。可选的，所述登录控制方法还包括：接收登录请求，所述登录请求携带有所述用户账户信息以及待验证动态令牌；对所述登录请求进行验证，并根据验证结果生成对应的响应消息，并利用所述目标社交系统将所述响应消息发送给所述目标社交账户。通过采用上述技术方案，将响应消息发送给指定的目标社交账户，可使得目标社交账户对应的用户及时获悉该用户账户的使用状态，当用户发现该账户被他人非法盗用时，可及时采取措施，从而有利于提供系统安全。可选的，所述对所述登录请求进行验证，并根据验证结果生成对应的响应消息包括：判断所述用户账户信息是否匹配；如否，确定验证失败；如是，获取所述用户账户信息最近一次关联存储的最新动态令牌；并判断所述最新动态令牌是否处于有效状态；如否，确定验证失败；如是，将所述最新动态令牌作为参考动态令牌；并判断所述待验证动态令牌与所述参考动态令牌是否匹配；如否，确定验证失败；如是，则验证通过；在所述确定验证失败时，拒绝对应用户账户登录，并生成登录失败的响应消息。在所述确定验证通过时，允许对应用户账户登录，并生成登录成功的响应消息。通过采用上述技术方案，从用户账户信息和动态令牌两方面进行了验证，保证了登录安全；同时根据验证结果，生成不同的响应消息，可便于用户更好更及时地掌控该用户账户的登录状态。可选的，所述生成登录失败的响应消息包括：在判断所述用户账户信息不匹配时，生成账户/密码错误的第一响应消息；在判断所述最新动态令牌未处于有效状态时，生成动态令牌过期的第二响应消息；在判断所述待验证动态令牌与所述参考动态令牌不匹配时，生成动态令牌输入错误的第三响应消息；所述登录失败的响应消息包括所述第一响应消息、所述第二响应消息和所述第三响应消息。通过采用上述技术方案，针对登录失败的具体情形，生成相应的响应消息，可指示更好地完成登录。可选的，所述判断所述最新动态令牌是否处于有效状态包括：判断所述最新动态令牌是否未作为所述参考动态令牌并参与过与待验证动态令牌的匹配，若是，且所述最新动态令牌处于设定有效期内，则判定所述最新动态令牌处于有效状态；否则，判定所述最新动态令牌未处于有效状态。通过采用上述技术方案，通过设定有效期和参与匹配得情况，判断最新动态令牌的有效性，从而可保证参考动态令牌的安全性，避免参考动态令牌被重复或非法使用，影响系统安全。可选的，所述目标社交系统包括企业微信、钉钉和飞书中的至少一种。通过采用上述技术方案，基于上述系统的开放接口，利用上述社交系统实现动态令牌以及登录情况的消息下发，为登录控制提供了一种全新的口令下发方式，更好地满足用户使用需求。第二方面，本申请提供的登录控制装置，采用如下的技术方案：一种登录控制装置，包括：接收模块，用于接收登录端的令牌获取请求；所述令牌获取请求中携带有用户账户信息；令牌管理模块，用于生成动态令牌；处理模块，用于确定与所述用户账户信息预设关联的目标社交账户，利用所述目标社交账户所属的目标社交系统向所述目标社交账户发送应用消息，所述应用消息携带有所述动态令牌。第三方面，本申请提供的服务器，采用如下的技术方案：一种服务器，包括处理器、存储器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述登录控制方法。第四方面，本申请提供的计算机可读存储介质，采用如下的技术方案：一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序；所述计算机程序被处理器执行时实现上述登录控制方法。通过采用上述技术方案，提供了登录控制方法的计算机程序的载体。综上所述，本申请包括以下至少有益技术效果：1.在登录内部系统时，动态令牌可直接发送到预设关联的目标社交账户，而且以应用消息的形式进行发送；一方面解决了令牌短信通知的费用问题；另一方面，操作更加便捷。2.将响应消息发送给指定的目标社交账户，可使得目标社交账户对应的用户及时获悉该用户账户的使用状态，当用户发现该账户被他人非法盗用时，可及时采取措施，从而有利于提供系统安全。附图说明图1是本申请实施例中的一种登录控制方法的流程框图；图2是本申请实施例中的一种登录界面示意图；图3是本申请实施例中的一种配置界面示意图；图4是本申请实施例中的另一种配置界面示意图；图5是本申请实施例中的另一种登录控制方法的流程框图；图6是本申请实施例中的一种动态令牌的显示界面示意图；图7是本申请实施例中的另一种动态令牌的显示界面示意图；图8是本申请实施例中的一种对登录请求进行验证的流程框图；图9是本申请实施例中的又一种登录控制方法的流程框图；图10是本申请实施例中的一种登录控制装置的结构框图；图11是本申请实施例中的一种服务器的结构框图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处所描述的具体实施例仅用以解释本申请，并不用于限定本申请。本申请实施例公开登录控制方法。参考图1，一种登录控制方法，包括以下步骤：S101、接收登录端的令牌获取请求；其中，令牌获取请求中携带有用户账户信息；本申请实施例中的登录控制方法可应用于公司内部管理系统，保证内部系统的使用安全，尽可能避免被无权限人员非法登录。其中内部管理系统可以是现有任意管理系统，包括但不限于人员管理系统、财务管理系统、台账管理系统、安全管理系统等。在此不再一一举例说明。登录端可以是PC端，也可以移动端。用户通过登录端进入系统登录界面，可发起登录请求。可参考图2，用户可通过点击“获取动态密码”，触发登录端发起登录请求；此时系统即可接收到登录端发送的令牌获取请求。应当理解的是，请求的发起与获取的具体过程及原理为现有相关技术，在此不再赘述。本申请实施例中，令牌获取请求中携带有用户账户信息，也即在发起令牌获取请求之前，需要输入相关用户账户信息，包括但不限于账号和密码。参考图2中所示的账号输入框“wanghao”和密码输入框“********”。相对于目前通过令牌生成器来获取动态令牌的方式，一是可更方面地获取动态令牌，无需切换到令牌生成器的应用界面去获取动态令牌，因此不会打断用户的正常办公，减少了用户在登录时的操作步骤；另外，可建立动态令牌与用户账户信息之间的关联性，可更好地实现一对一的关联性验证，即使其他用户获取到该动态令牌，由于用户账户信息的差异，也无法验证通过，保证了系统安全。S102、生成动态令牌；本申请可选实施例中，在接收到该令牌获取请求时，可触发生成动态令牌。其中，生成动态令牌的算法可采用现有任意方式，但应尽可能保证动态令牌的随机性和安全性。动态令牌的下发目前主要有如下几种形式，一是通过短信进行下发，这种方式需要预先绑定用户手机号，同时对于服务商而言需要短信费用的投入；二是通过邮箱下发，这种方式尽管没有费用成本，但是对于用户而言不是很友好，需要用户登录邮箱查看动态令牌，操作十分不便，影响用户使用；总之目前的动态令牌下发方式均存在一些不足之处，对此本申请采用如下方式。S103、确定与用户账户信息预设关联的目标社交账户，利用目标社交账户所属的目标社交系统向目标社交账户发送应用消息；应用消息携带有该动态令牌。参考图3，可预先配置与用户账户信息关联的社交账户，使得该用户账户的动态令牌通过该目标社交账户进行下发，使用方便无成本。继续参考图3，基于该配置界面可实现对关联的目标社交账户的额配置。具体的，其中“类型”指的是关联的系统，通过下拉选择包括“企业微信”、“飞书”和“钉钉”；在本申请可选实施例中，可对关联系统进行适当拓展。“名称”通过关联“类型”的选择默认设置，例如选择“飞书”作为关联系统，则默认名称为“飞书-应用消息”。“动态密码长度”可基于实际需求灵活设置，例如设置为“4”，即限定生成的动态令牌为4位字符。可选的，“动态密码长度”的设置范围为“1-10”，具体可灵活设置。“令牌有效时长”指的是生成的动态令牌在设定有效期内有效，超过设定有效期，则无效，需要重新获取新的动态令牌进行验证。“令牌有效时长”设置数值越小，安全性相对更高。“令牌有效时长”例如可设置为“1”，即表示“1分钟”。“消息模版”框中可灵活设置下发动态令牌的显示格式。在本申请可选实施例中，配置界面还可包含其他设置栏或设置框，具体可灵活设置，本申请实施例并不限于上述示例。例如，可参考图4，图4为关联系统为“钉钉”的可选配置界面。通过采用本实施例的上述技术方案，在登录内部系统时，动态令牌可直接发送到预设关联的目标社交账户，而且以应用消息的形式进行发送；一方面解决了令牌短信通知的费用问题；另一方面，在登录过程无需切换到令牌生成器单独生成动态令牌，可直接在登录界面触发获取动态令牌，操作更加便捷。本申请实施例还提供一种登录控制方法，请参考图5，该登录控制方法主要包括：S501、接收登录端的令牌获取请求；其中，令牌获取请求中携带有用户账户信息；S502、生成动态令牌；S503、将动态令牌与用户账户信息进行关联存储；S504、确定与用户账户信息预设关联的目标社交账户，利用目标社交账户所属的目标社交系统向目标社交账户发送应用消息，其中应用消息携带有该动态令牌；参考图6所示，动态令牌通过该目标社交系统以应用消息的形式进行通知显示。在本申请可选实施例中，也可以消息弹窗的形式进行通知显示，参考图7所示。S505、接收登录请求；其中，登录请求携带有该用户账户信息以及待验证动态令牌；在本申请可选实施例中，用户在输入待验证动态令牌后，即可点击“登录”按钮，以触发生成登录请求。S506、对登录请求进行验证，得到验证结果；在本申请可选实施例中，可参考图8，验证过程主要包括：S801、判断用户账户信息是否匹配；也即是将登录请求中所携带的登录账号和登录密码，与用户身份信息存储系统存储的相关信息进行比较，确定是否匹配；具体的，可判断用户身份信息存储系统中是否存在对应的登录账号，若不存在，则确定验证失败；若存在该登录账号，判断登录请求中所携带的登录密码与该系统中与该登录账号关联的密码是否匹配或相同，若是，则判断用户账户信息匹配，否则，判断密码错误，也即验证失败。S802、如否，确定验证失败；可选的，在判断用户账户信息不匹配时，生成账户/密码错误的第一响应消息。具体的，还可当系统中不存在对应的登录账户时，生成账户错误的第一响应消息；当系统中存在对应的登录账户，但是登录密码不匹配时，生成密码错误的第一响应消息。通过对登录过程中的错误类型进行指示，更好地引导用户能够成功登录，避免输入错误导致的登录失败问题。S803、如是，获取用户账户信息最近一次关联存储的最新动态令牌；S804、判断最新动态令牌是否处于有效状态；在本申请可选实施例中，判断最新动态令牌是否未作为参考动态令牌并参与过与待验证动态令牌的匹配；若是，且最新动态令牌处于设定有效期内，则判定最新动态令牌处于有效状态；否则，判定最新动态令牌未处于有效状态。也即，当最新动态令牌作为参考动态令牌参与过与待验证动态令牌的匹配，或者最新动态令牌当前已经超过了设定有效期，则判定最新动态令牌处于失效状态，此时用户需要重新获取新的动态令牌，并重新点击“登录”，从而保证了登录安全。S805、如否，确定验证失败；可选的，在判断最新动态令牌未处于有效状态时，生成动态令牌过期的第二响应消息；S806、如是，将最新动态令牌作为参考动态令牌；S807、并判断待验证动态令牌与参考动态令牌是否匹配；判断待验证动态令牌与参考动态令牌是否匹配，也即判断两者是否完全相同，若是，则确定两者匹配，若否，则确定两者不匹配。S808、如否，确定验证失败；在判断待验证动态令牌与参考动态令牌不匹配时，生成动态令牌输入错误的第三响应消息。在本申请可选实施例中，当用户基于目标社交系统发送的响应消息发现他人非法登录自己的账户时，用户可通过该目标社交系统的消息交互界面，发送指令以退出该账户的登录，使得该账户直接退出登录状态，保证系统安全。例如，输入并向社交系统发送“退出登录”指令，社交系统将该指令转发给用户账户所属系统，系统即可依据指示退出该账户的登录。S809、如是，则验证通过；S810、在确定验证失败时，拒绝对应用户账户登录，并生成登录失败的响应消息。S811、在确定验证通过时，允许对应用户账户登录，并生成登录成功的响应消息。S507、根据验证结果生成对应的响应消息；S508、利用目标社交系统将响应消息发送给目标社交账户。本申请实施例还提供一种登录控制方法，参考图9，该登录控制方法主要包括：S901、网页端生成令牌获取请求，并发送给对应的登录系统；S902、登录系统接收令牌获取请求，生成动态令牌；S903、登录系统依据令牌获取请求中携带的用户账户信息，确定目标社交账户和目标社交账户；S904、登录系统将动态令牌发送给目标社交系统；S905、目标社交系统基于该动态令牌生成应用消息，并将该应用消息发送给该目标社交账户；S906、目标社交账户对应的用户终端接收该应用消息，并进行提示或展示；S907、网页端基于用户输入获取待验证动态令牌，并基于用户点击“登录”指令生成登录请求，并将登录请求发送给登录系统；S908、登录系统接收登录请求，并对登录请求进行验证；S909、验证通过，则允许登录；S910、验证失败，则拒绝登录。基于同一设计构思，本实施例还公开一种登录控制装置。参考图10，一种登录控制装置，包括：接收模块110，用于接收登录端的令牌获取请求；令牌获取请求中携带有用户账户信息；令牌管理模块120，用于生成动态令牌；处理模块130，用于确定与用户账户信息预设关联的目标社交账户，利用目标社交账户所属的目标社交系统向目标社交账户发送应用消息，应用消息携带有动态令牌。上述实施例提供的方法中的各种变化方式和具体实例同样可灵活适用于本实施例的登录控制装置，通过前述对登录控制方法的详细描述，本领域技术人员可以清楚的知道本实施例中的登录控制装置的实施方法，为了说明书的简洁，在此不再详述。为了更好地执行上述方法的程序，本申请实施例还提供一种服务器，如图11所示，服务器包括处理器和存储器。其中，存储器可用于存储指令、程序、代码、代码集或指令集。存储器可以包括存储程序区和存储数据区，其中，存储程序区可存储用于实现操作系统的指令、用于至少一个功能的指令，以及用于实现上述实施例提供的登录控制方法的指令等；存储数据区可存储上述实施例提供的登录控制方法中涉及到的数据等。处理器可以包括一个或者多个处理核心。处理器通过运行或执行存储在存储器内的指令、程序、代码集或指令集，调用存储在存储器内的数据，执行本申请的各种功能和处理数据。处理器可以为特定用途集成电路、数字信号处理器、数字信号处理装置、可编程逻辑装置、现场可编程门阵列、中央处理器、控制器、微控制器和微处理器中的至少一种。可以理解地，对于不同的设备，用于实现上述处理器功能的电子器件还可以为其它，本申请实施例不作具体限定。本申请实施例提供一种计算机可读存储介质，例如包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。该计算机可读存储介质存储有能够被处理器加载并执行上述实施例的登录控制方法的计算机程序。以上所述，以上实施例仅用以对本申请的技术方案进行了详细介绍，但以上实施例的说明只是用于帮助理解本申请的方法及其核心思想，不应理解为对本申请的限制。本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本申请的保护范围之内。
