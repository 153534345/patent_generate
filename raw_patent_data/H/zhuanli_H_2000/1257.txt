标题title
一种加密存储鉴权系统
摘要abst
本发明涉及加密设备技术领域，特别是涉及一种加密存储鉴权系统。所述系统包括加密存储模块、认证模块和连接设备；所述加密存储模块用于与所述认证模块建立第一通信链路和第二通信链路，发送授权请求，接收第一子密钥和第二子密钥并拼合成授权密钥，使用授权密钥对密文解密后开启存储操作权限；所述认证模块用于接收授权请求，对认证数据加密生成密文和授权密钥并拆分授权密钥生成第一子密钥和第二子密钥，发送密文、第一子密钥和第二子密钥；所述连接设备用于给所述加密存储模块和所述认证模块提供电源，将所述加密存储模块和所述认证模块相连使所述加密存储模块和所述认证模块建立第二通信链路。本发明大大的减少了认证数据失窃的风险。
权利要求书clms
1.一种加密存储鉴权系统，其特征在于，所述加密存储鉴权系统包括加密存储模块、认证模块和连接设备；所述加密存储模块用于与所述认证模块建立第一通信链路和第二通信链路，向所述认证模块发送授权请求，接收所述认证模块发送的密文，接收所述认证模块通过第一通信链路发送的第一子密钥和通过第二通信链路发送的第二子密钥，拼合第一子密钥和第二子密钥得到授权密钥，使用授权密钥对密文解密后开启存储操作权限；所述认证模块用于与所述加密存储模块建立第一通信链路和第二通信链路，接收所述加密存储模块发送的授权请求，对认证数据加密生成密文和授权密钥并拆分授权密钥生成第一子密钥和第二子密钥，将密文发送给所述加密存储模块，通过第一通信链路将第一子密钥、通过第二通信链路将第二子密钥发送给所述加密存储模块；所述连接设备用于给所述加密存储模块和所述认证模块提供电源，将所述加密存储模块和所述认证模块相连使所述加密存储模块和所述认证模块建立第二通信链路。2.根据权利要求1所述的加密存储鉴权系统，其特征在于，所述加密存储模块包括第一蓝牙模块，所述认证模块包括第二蓝牙模块；加密存储模块与所述认证模块建立第一通信链路和第二通信链路，包括：通过第一蓝牙模块与所述认证模块的第二蓝牙模块相配对，与所述认证模块建立第一通信链路；配对完成后，通过连接设备与所述认证模块建立第二通信链路；认证模块与所述加密存储模块建立第一通信链路和第二通信链路，包括：通过第二蓝牙模块与所述认证模块的第一蓝牙模块相配对，与所述加密存储模块建立第一通信链路；配对完成后，通过连接设备与所述加密存储模块建立第二通信链路。3.根据权利要求1所述的加密存储鉴权系统，其特征在于，所述向所述认证模块发送授权请求，包括：判断是否接收到连接设备的操作请求，若是，则生成授权请求；将授权请求拆分两部分并分别通过第一通信链路和第二通信链路向所述认证模块发送拆分后的授权请求；所述接收所述加密存储模块发送的授权请求，包括：通过第一通信链路、第二通信链路接收所述加密存储模块发送的拆分后的授权请求；将拆分后的授权请求拼合得到授权请求。4.根据权利要求3所述的加密存储鉴权系统，其特征在于，所述将授权请求拆分两部分并分别通过第一通信链路和第二通信链路向所述认证模块发送拆分后的授权请求，包括：将授权请求根据第一预设比例按预设顺序拆分成第一子授权请求Q1、第二子授权命请求Q2；将Q1根据第二预设比例按预设顺序拆分成第一授权命令q1和第二授权命令q2；将Q2根据第二预设比例按预设顺序拆分成第三授权命令q3和第四授权命令q4；通过第一通信链路向所述认证模块发送q1和q2；通过第二通信链路向所述认证模块发送q3和q4；所述通过第一通信链路、第二通信链路接收所述加密存储模块发送的拆分后的授权请求，包括：通过第一通信链路接收所述加密存储模块发送的q1和q2；通过第二通信链路接收所述加密存储模块发送的q3和q4。5.根据权利要求4所述的加密存储鉴权系统，其特征在于，所述将拆分后的授权请求拼合得到授权请求，包括：将q1、q2、q3和q4按拆分顺序拼合得到授权请求。6.根据权利要求4所述的加密存储鉴权系统，其特征在于，所述对认证数据加密生成密文和授权密钥并拆分授权密钥生成第一子密钥和第二子密钥，包括：根据拆分后的授权请求的数据量和由发送到接收的时间差得到第一通信链路的数据传出速度v1、蓝牙传输速度v2，第二通信链路的数据传出速度v3和数据线传输速度v4；将认证模块的认证数据加密生成密文和授权密钥；根据v1、v2、v3和v4将授权密钥拆成第一子密钥和第二子密钥。7.根据权利要求6所述的加密存储鉴权系统，其特征在于，所述根据拆分后的授权请求的数据量和由发送到接收的时间差得到第一通信链路的数据传出速度v1、蓝牙传输速度v2，第二通信链路的数据传出速度v3和数据线传输速度v4，包括：确定q1由发送到接收的时间差t1、q2由发送到接收的时间差t2、q3由发送到接收的时间差t3和q4由发送到接收的时间差t4；由得到第一通信链路的数据传出速度v1和蓝牙传输速度v2；由得到第二通信链路的数据传出速度v3和数据线传输速度v4；其中B1是q1的数据量，B2是q2的数据量，B3是q3的数据量，B4是q4的数据量。8.根据权利要求6所述的加密存储鉴权系统，其特征在于，所述根据v1、v2、v3和v4将授权密钥拆成第一子密钥和第二子密钥，包括：由得到第一子密钥的数据量B6；由得到第二子密钥的数据量B7；根据B6和B7将授权密钥的数据拆分成前后两部分，记授权密钥前部分的数据为第一子密钥，记授权密钥后部分的数据为第二子密钥；其中，B5为授权密钥的数据量。9.根据权利要求8所述的加密存储鉴权系统，其特征在于，所述通过第一通信链路将第一子密钥、通过第二通信链路将第二子密钥发送给所述加密存储模块，包括：由得到第一子密钥的传输时间t5；由得到第二子密钥的传输时间t6；由得到两个子密钥的传输时间差t7；判断t7是否大于0，若是，则通过第一通信链路将第一子密钥发送给所述加密存储模块，经过t7后，通过第二通信链路将第二子密钥发送给所述加密存储模块；若否，则通过第二通信链路将第二子密钥发送给所述加密存储模块，经过后，通过第一通信链路将第一子密钥发送给所述加密存储模块。
说明书desc
技术领域本发明涉及加密设备技术领域，特别是涉及一种加密存储鉴权系统。背景技术硬件加密是指使用硬件来实现数据加密和安全保护的技术。与软件加密相比，硬件加密更加安全可靠，因为加密算法和密钥存储在物理芯片中，很难被攻击者获取或修改。硬件加密通常是加密存储设备使用的加密技术。目前对加密存储设备进行硬件加密后会生成密钥或者数字证书，生成的密钥或者数字证书保存在USBkey中，当加密存储设备和USBkey连接后，加密存储设备通过蓝牙传输获取USBkey中的密钥或者数字证书，就可以对加密存储设备进行操作。如果在加密存储设备获取USBkey中的密钥或者数字证书的过程中被入侵，那么可能面临密钥或数字证书失窃的风险。发明内容基于此，有必要针对上述的问题，提供一种加密存储鉴权系统。本发明实施例是这样实现的，一种加密存储鉴权系统，所述加密存储鉴权系统包括加密存储模块、认证模块和连接设备；所述加密存储模块用于与所述认证模块建立第一通信链路和第二通信链路，向所述认证模块发送授权请求，接收所述认证模块发送的密文，接收所述认证模块通过第一通信链路发送的第一子密钥和通过第二通信链路发送的第二子密钥，拼合第一子密钥和第二子密钥得到授权密钥，使用授权密钥对密文解密后开启存储操作权限；所述认证模块用于与所述加密存储模块建立第一通信链路和第二通信链路，接收所述加密存储模块发送的授权请求，对认证数据加密生成密文和授权密钥并拆分授权密钥生成第一子密钥和第二子密钥，将密文发送给所述加密存储模块，通过第一通信链路将第一子密钥、通过第二通信链路将第二子密钥发送给所述加密存储模块；所述连接设备用于给所述加密存储模块和所述认证模块提供电源，将所述加密存储模块和所述认证模块相连使所述加密存储模块和所述认证模块建立第二通信链路。本发明实施例提供的加密存储鉴权系统通过对认证数据加密生成密文和授权密钥，将授权密钥按照第一通信链路和第二通信链路的传输速度拆分成第一子密钥和第二子密钥，认证模块通过第一通信链路将第一子密钥、通过第二通信链路将第二子密钥发送给加密存储模块，加密存储模块拼合第一子密钥和第二子密钥得到授权密钥后使用授权密钥对密文解密后开启存储操作权限，由于在传输授权密钥的过程中是将授权密钥拆分成两部分通过两种不同的通信链路进行传输，就是有一个通信链路被非法入侵也不会使授权密钥失窃，大大的减少了认证数据失窃的风险。附图说明图1为一个实施例中提供的加密存储鉴权系统的结构框图；图2为一个实施例中提供的加密存储鉴权系统的环境结构图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。可以理解，本发明所使用的术语“第一”、“第二”等可在本文中用于描述各种元件，但除非特别说明，这些元件不受这些术语限制。这些术语仅用于将第一个元件与另一个元件区分。举例来说，在不脱离本发明的范围的情况下，可以将第一xx脚本称为第二xx脚本，且类似地，可将第二xx脚本称为第一xx脚本。如图1所示，在一个实施例中，提出了一种加密存储鉴权系统，具体可以包括加密存储模块、认证模块和连接设备；所述加密存储模块用于与所述认证模块建立第一通信链路和第二通信链路，向所述认证模块发送授权请求，接收所述认证模块发送的密文，接收所述认证模块通过第一通信链路发送的第一子密钥和通过第二通信链路发送的第二子密钥，拼合第一子密钥和第二子密钥得到授权密钥，使用授权密钥对密文解密后开启存储操作权限；所述认证模块用于与所述加密存储模块建立第一通信链路和第二通信链路，接收所述加密存储模块发送的授权请求，对认证数据加密生成密文和授权密钥并拆分授权密钥生成第一子密钥和第二子密钥，将密文发送给所述加密存储模块，通过第一通信链路将第一子密钥、通过第二通信链路将第二子密钥发送给所述加密存储模块；所述连接设备用于给所述加密存储模块和所述认证模块提供电源，将所述加密存储模块和所述认证模块相连使所述加密存储模块和所述认证模块建立第二通信链路。在本实施例中，第一通信链路和第二通信链路是两种不同形式的通信链路。在本实施例中，授权请求是一组数据，当认证模块接收到加密模块发送的表示授权请求的数据，对认证数据进行加密并发送密文和授权密钥。在本实施例中，拼合第一子密钥和第二子密钥将第一子密钥和第二子密钥按第一子密钥在前、第二子密钥在后的顺序进行组合。在本实施例中，使用授权密钥对密文解密后开启存储操作权限是指使用授权密钥对密文进行解密得到认证数据，再使用认证数据开启加密存储模块的存储操作权限。在本实施例中，认证数据是指保存在认证模块里面的能够开启加密存储模块的存储操作权限密钥或数字证书。在本实施例中，对认证数据加密使用的是对称密钥算法，需要密文和对称密钥算法生成的授权密钥才能进行解密。在本实施例中，将密文发送给所述加密存储模块，可以通过第一通信链路也可以通过第二通信链路，由于第二通信链路的传输速度比第一通信链路快，一般采用通过第二通信链路传输密文。本发明实施例提供的加密存储鉴权系统通过对认证数据加密生成密文和授权密钥，将授权密钥按照第一通信链路和第二通信链路的传输速度拆分成第一子密钥和第二子密钥，认证模块通过第一通信链路将第一子密钥、通过第二通信链路将第二子密钥发送给加密存储模块，加密存储模块拼合第一子密钥和第二子密钥得到授权密钥后使用授权密钥对密文解密后开启存储操作权限，由于在传输授权密钥的过程中是将授权密钥拆分成两部分通过两种不同的通信链路进行传输，就是有一个通信链路被非法入侵也不会使授权密钥失窃，大大的减少了认证数据失窃的风险。在一个实施例中，所述加密存储模块包括第一蓝牙模块，所述认证模块包括第二蓝牙模块；加密存储模块与所述认证模块建立第一通信链路和第二通信链路，包括：通过第一蓝牙模块与所述认证模块的第二蓝牙模块相配对，与所述认证模块建立第一通信链路；配对完成后，通过连接设备与所述认证模块建立第二通信链路；认证模块与所述加密存储模块建立第一通信链路和第二通信链路，包括：通过第二蓝牙模块与所述认证模块的第一蓝牙模块相配对，与所述加密存储模块建立第一通信链路；配对完成后，通过连接设备与所述加密存储模块建立第二通信链路。在本实施例中，第一通信链路是蓝牙连接形成的通信链路，第二通信链路是硬件连接形成的通信链路。在一个实施例中，所述向所述认证模块发送授权请求，包括：判断是否接收到连接设备的操作请求，若是，则生成授权请求；将授权请求拆分两部分并分别通过第一通信链路和第二通信链路向所述认证模块发送拆分后的授权请求；所述接收所述加密存储模块发送的授权请求，包括：通过第一通信链路、第二通信链路接收所述加密存储模块发送的拆分后的授权请求；将拆分后的授权请求拼合得到授权请求。在本实施例中，生成授权请求的前提是需要对加密存储模块进行存储操作，而加密存储模块与连接设备相连，由连接设备操控，所以当接收到连接设备需要对加密存储模块进行存储操作的操作请求，加密存储模块才会生成授权请求。在本实施例中，分别通过第一通信链路和第二通信链路发送拆分后的授权请求是为计算第一通信链路的数据传输速度和第二通信链路的数据传输速度。在本实施例中，拆分后的授权请求没有增加任何的数据，所以拼合后得到还是同样的授权请求。在一个实施例中，所述将授权请求拆分两部分并分别通过第一通信链路和第二通信链路向所述认证模块发送拆分后的授权请求，包括：将授权请求根据第一预设比例按预设顺序拆分成第一子授权请求Q1、第二子授权命请求Q2；将Q1根据第二预设比例按预设顺序拆分成第一授权命令q1和第二授权命令q2；将Q2根据第二预设比例按预设顺序拆分成第三授权命令q3和第四授权命令q4；通过第一通信链路向所述认证模块发送q1和q2；通过第二通信链路向所述认证模块发送q3和q4；所述通过第一通信链路、第二通信链路接收所述加密存储模块发送的拆分后的授权请求，包括：通过第一通信链路接收所述加密存储模块发送的q1和q2；通过第二通信链路接收所述加密存储模块发送的q3和q4。在本实施例中，授权请求的数据量和第一预设比例相乘得到第一子授权请求Q1的数据量，因为授权请求拆分成两部分，所以授权请求减去Q1得到的就是Q2。在本实施例中，第一通信链路是通过蓝牙进行数据传输，第二通信链路是通过数据线进行传输，第一通信链路的传输速度理论上是要比第二通信链路慢，为了不使接收的时间相隔太久，需要将授权请求拆分成数据量不同的两部分，所以第一预设比例可以设置为小于1/2的数，比如1/3，这样Q1为1/3的授权请求，Q2为2/3的授权请求。在本实施例中，预设顺序是指前后顺序，比如第一预设比例为1/3，那么授权请求的前1/3的数据即为Q1，剩下的2/3的授权请求就是Q2。在本实施例中，因为第一通信链路存在两个不同的传输速度，需要传输两次数据量不同的数据才能求得这两个不同的传输速度，所以设置第二预设比例将Q1拆分成数据量不同的两部分，第二预设比例的值不能为1/2，对于第二通信链路同理。在一个实施例中，所述将拆分后的授权请求拼合得到授权请求，包括：将q1、q2、q3和q4按拆分顺序拼合得到授权请求。在本实施例中，拆分顺序是指授权请求拆分的各个部分在授权请求中的顺序，比如说，授权请求拆分成第一子授权请求Q1和第二子授权请求Q2，Q1在Q2的前面，Q1拆分成q1和q2，q1在q2前面，Q2拆分成q3和q4，所以拆分顺序为q1、q2、q3、q4。在一个实施例中，所述对认证数据加密生成密文和授权密钥并拆分授权密钥生成第一子密钥和第二子密钥，包括：根据拆分后的授权请求的数据量和由发送到接收的时间差得到第一通信链路的数据传出速度v1、蓝牙传输速度v2，第二通信链路的数据传出速度v3和数据线传输速度v4；将认证模块的认证数据加密生成密文和授权密钥；根据v1、v2、v3和v4将授权密钥拆成第一子密钥和第二子密钥。在本实施例中，第一通信链路的数据传出速度是指数据经过认证模块处理后传输到第二蓝牙模块的速度。在本实施例中，第一通信链路的蓝牙传输速度是指数据通过第二蓝牙模块传输到加密存储模块的速度。在本实施例中，第二通信链路的数据传出速度是指数据经过认证模块处理后传输到数据线的速度。在本实施例中，第二通信链路的数据线传输速度是指数据通过数据线传输到加密存储模块的速度。在本实施例中，因为通过第一通信链路传输数据的速度和通过第二通信链路传输数据的速度不同，所以根据传输速度将授权密钥进行拆分，使传输速度快的通信链路传输数据量大的部分授权密钥，传输速度慢的通信链路传输数据量小的部分授权密钥。在一个实施例中，所述根据拆分后的授权请求的数据量和由发送到接收的时间差得到第一通信链路的数据传出速度v1、蓝牙传输速度v2，第二通信链路的数据传出速度v3和数据线传输速度v4，包括：确定q1由发送到接收的时间差t1、q2由发送到接收的时间差t2、q3由发送到接收的时间差t3和q4由发送到接收的时间差t4；由得到第一通信链路的数据传出速度v1和蓝牙传输速度v2；由得到第二通信链路的数据传出速度v3和数据线传输速度v4；其中B1是q1的数据量，B2是q2的数据量，B3是q3的数据量，B4是q4的数据量。在本实施例中，发送数据时添加时间戳就可以知道发送数据的时间，由接收到数据的时间减去发送数据的时间就可以得到时间差。在本实施例中，因为时间是数据量和传输速度的比值，数据通过通信链路传输的总时间就是数据通信链路中不同传输渠道的时间之和，比如说，对于，/＞是q1在经过认证模块处理后传输到第二蓝牙模块所需要的时间，/＞是q1通过第二蓝牙模块传输到加密存储模块所需要的时间，这两个时间相加就是q1通过第一通信链路进行传输的总时间，也就是q1由发送到接收的时间差t1，对于q2、q3和q4同理。在一个实施例中，所述根据v1、v2、v3和v4将授权密钥拆成第一子密钥和第二子密钥，包括：由得到第一子密钥的数据量B6；由得到第二子密钥的数据量B7；根据B6和B7将授权密钥的数据拆分成前后两部分，记授权密钥前部分的数据为第一子密钥，记授权密钥后部分的数据为第二子密钥；其中，B5为授权密钥的数据量。在本实施例中，对于而言，本质是第一通信链路的平均速度占第一通信链路的平均速度与第二通信链路的平均速度之和的比值，即，根据这个比值对授权密钥的数据量B5进行拆分得到第一子密钥的数据量B6。在本实施例中，B7也可以由B5减去B6得到，因为与的和为1.在本实施例中，第一通信链路的传输速度理论上是要比第二通信链路慢，所以第一子密钥的数据量比第二子密钥的数据量少。在一个实施例中，所述通过第一通信链路将第一子密钥、通过第二通信链路将第二子密钥发送给所述加密存储模块，包括：由得到第一子密钥的传输时间t5；由得到第二子密钥的传输时间t6；由得到两个子密钥的传输时间差t7；判断t7是否大于0，若是，则通过第一通信链路将第一子密钥发送给所述加密存储模块，经过t7后，通过第二通信链路将第二子密钥发送给所述加密存储模块；若否，则通过第二通信链路将第二子密钥发送给所述加密存储模块，经过后，通过第一通信链路将第一子密钥发送给所述加密存储模块。在本实施例中，t5是第一子密钥由发送到接收的理论时间差，t6是第二子密钥由发送到接收的理论时间差，因为t5和t6是算出来的理论值，实际上传输速度是存在一个动态的速度，所以这里t5不是第一子密钥由发送到接收的实际时间差，t6不是第二子密钥的实际时间差。在本实施例中，若t7大于0，则第一子密钥传输的时间比第二子密钥传输的时间长，所以要先传输第一子密钥；若t7小于0，则第一子密钥传输的时间比第二子密钥传输的时间短，所以要先传输第二子密钥；若t7等于0，第一子密钥传输的时间比第二子密钥传输的时间一样，同时传输第一子密钥和第二子密钥。在本实施例中，第一子密钥和第二子密钥传输时间间隔t7是为了使加密存储模块接收到第一子密钥和第二子密钥的时刻保存一样。图2示出了一个实施例中加密存储鉴权系统的环境结构图。如图2所示，该系统包括通过数据线相连的加密存储模块和认证模块。其中，加密存储模块包括通过系统总线连接的第一主控芯片、第一蓝牙模块和存储设备，认证模块包括通过系统总线连接的第二主控芯片和第二蓝牙模块。该加密存储模块的第一主控芯片可以执行本发明任意一个实施例所述提供的加密存储鉴权系统中加密存储模块所执行的对应步骤。该认证模块的第二主控芯片可以执行本发明任意一个实施例所述提供的加密存储鉴权系统中认证模块所执行的对应步骤。本领域技术人员可以理解，图2中示出的结构，仅仅是与本发明方案相关的部分结构的框图，并不构成对本发明方案所应用于其上的系统的限定，具体的系统可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本发明的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对本发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。
