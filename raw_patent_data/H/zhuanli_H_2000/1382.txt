标题title
一种微型逆变器无功控制方法
摘要abst
本申请公开了一种微型逆变器无功控制方法，包括微型逆变器电路；在电网的过零点，将开关管S1、S3和Sw进行关断设置，进而开关管S2、S4、电容Cg以及电感Lg与电网形成等效电路，通过控制等效电路的电流和电压相互反向以进行微型逆变器电路的无功控制。本申请的有益效果：通过形成等效电路，可以对传统微型逆变器电路增加无功功率控制功能。并且进行无功功率的控制无需修改硬件，只需在软件上进行修改即可。
权利要求书clms
1.一种微型逆变器无功控制方法，用于微型逆变器电路；其特征在于：在电网的过零点，将开关管S1、S3和Sw进行关断设置，进而开关管S2、S4、电容Cg以及电感Lg与电网形成等效电路，通过控制等效电路的电流和电压相互反向以进行微型逆变器电路的无功控制。2.如权利要求1所述的微型逆变器无功控制方法，其特征在于：在等效电路中，将开关管S2和S4同时进行导通设置；从而在电网的电压vg为正方向时，电网的电流ig将负向增长；或电网的电压vg为负方向时，电网的电流ig将正向增长。3.如权利要求1所述的微型逆变器无功控制方法，其特征在于：在等效电路中，若电网的电流ig负向增长，则将开关管S2设置为导通，将开关管S4设置为关断，以使得电网的电压vg保持正方向；若电网的电流ig为正向增长，则将开关管S4设置为导通，将开关管S2设置为关断，以使得电网的电压vg保持负方向。4.如权利要求2或3所述的微型逆变器无功控制方法，其特征在于：在等效电路中，开关管S2和S4的导通作用时间为ΔT，ΔT的取值由无功功率Q*的值来决定；具体的表达式如下：；式中，t表示时间。5.如权利要求2或3所述的微型逆变器无功控制方法，其特征在于：在等效电路中，开关管S2和S4通过高频斩波以进行导通设置，进而对电网的电流ig的增长速率进行抑制。6.如权利要求5所述的微型逆变器无功控制方法，其特征在于：高频斩波的一个周期包括高电平段和低电平段；当开关管S2和S4中的一个处于高频斩波的高电平段时，电容Cg的两端电压钳位为零，则电网的电压vg和电流ig将相互反向增长；当开关管S2和S4中的一个处于高频斩波的低电平段时，电容Cg和电感Lg发生谐振，使得电网的电流ig向零点的方向减小。7.如权利要求5所述的微型逆变器无功控制方法，其特征在于：在无功控制阶段，电网的电流最大值Ig_max与高频斩波的占空比d以及无功作用时间ΔT有关；在进行无功控制时，将无功功率Q*的值以及电流ig的最大值限制值Ig_max*作为前置条件，通过函数f或者查表，得到高频斩波的占空比d以及无功作用时间ΔT，进而对电网的电流最大值Ig_max进行限制。8.如权利要求5所述的微型逆变器无功控制方法，其特征在于：无功作用时间ΔT包括先后进行的恒波阶段和缓降阶段；在恒波阶段，开关管S2和S4进行高频斩波的占空比d的值恒定；在缓降阶段，开关管S2和S4进行高频斩波的占空比d的值逐渐降低。9.如权利要求8所述的微型逆变器无功控制方法，其特征在于：设高频斩波的一个周期时间段为Ts，则0~dTs时间段为高电平段，dTs~Ts时间段为低电平段；在缓降阶段，通过占空比d的值逐渐减小，使得高电平段的时间段逐渐缩短，低电平段的时间段逐渐增加，进而使电流ig进行增长的幅值小于进行减小的幅值。10.如权利要求8所述的微型逆变器无功控制方法，其特征在于：在缓降阶段，高频斩波的占空比下降速率与有功功率P和电网的电流初始值Ig_ini有关；将有功功率P和电网的电流初始值Ig_ini作为前置条件，通过函数f或查表，得到占空比的下降速率。
说明书desc
技术领域本申请涉及新能源发电技术领域，尤其是涉及一种微型逆变器无功控制方法。背景技术微型逆变器，一般指的是光伏发电系统中的功率小于等于1千瓦、具组件级MPPT的逆变器，全称是微型光伏并网逆变器。“微型”是相对于传统的集中式逆变器而言的。传统的光伏逆变方式是将所有的光伏电池在阳光照射下生成的直流电全部串并联在一起，再通过一个逆变器将直流电逆变成交流电接入电网；微型逆变器则对每块组件进行逆变。其优点是可以对每块组件进行独立的MPPT控制，能够大幅提高整体效率，同时也可以避免集中式逆变器具有的直流高压、弱光效应差、木桶效应等。现在普通采用的微型逆变器电路如图1所示，由前级的反激电路110和后级的工频换向电路120组成。该电路拓扑的优势在于，成本低，效率较高。但在使用过程中最大的问题是，前级的反激为单向电路，所以系统发无功非常困难，常规的控制只能发送有功，无法发送无功。因此，现在急需对现有的微型逆变器进行改进。发明内容本申请的其中一个目的在于提供一种能够解决上述背景技术中至少一个缺陷的微型逆变器的无功控制方法。为达到上述的目的，本申请采用的技术方案为：一种微型逆变器无功控制方法，应用于微型逆变器电路；在电网的过零点，将开关管S1、S3和Sw进行关断设置，进而开关管S2、S4、电容Cg以及电感Lg与电网形成等效电路，通过控制等效电路的电流和电压相互反向以进行微型逆变器电路的无功控制。优选的，在等效电路中，将开关管S2和S4同时进行导通设置；从而在电网的电压vg为正方向时，电网的电流ig将负向增长；或电网的电压vg为负方向时，电网的电流ig将正向增长；进而根据电网的电压和电流的不同形成无功功率。优选的，在等效电路中，若电网的电流ig负向增长，则将开关管S2设置为导通，将开关管S4设置为关断，以使得电网的电压vg保持正方向；若电网的电流ig为正向增长，则将开关管S4设置为导通，将开关管S2设置为关断，以使得电网的电压vg保持负方向；进而根据电网的电压和电流的不同形成无功功率。优选的，在等效电路中，开关管S2和S4的导通作用时间为ΔT，ΔT的取值由无功功率Q*的值来决定；具体的表达式如下：；式中，t表示时间。优选的，在等效电路中，开关管S2和S4通过高频斩波以进行导通设置，进而对电网的电流ig的增长速率进行抑制。优选的，高频斩波的一个周期包括高电平段和低电平段；当开关管S2和S4中的一个处于高频斩波的高电平段，另一个处于关断时；电容Cg的两端电压钳位为零，则电网的电压vg和电流ig将相互反向增长；当开关管S2和S4中的一个处于高频斩波的低电平段，另一个处于关断时，电容Cg和电感Lg发生谐振，使得电网的电流ig向零点的方向减小。优选的，在无功控制阶段，电网的电流最大值Ig_max与高频斩波的占空比d以及无功作用时间ΔT有关；在进行无功控制时，将无功功率Q*的值以及电流ig的最大值限制值Ig_max*作为前置条件，通过函数f或者查表，得到高频斩波的占空比d以及无功作用时间ΔT，进而对电网的电流最大值Ig_max进行限制。优选的，无功作用时间ΔT包括先后进行的恒波阶段和缓降阶段；在恒波阶段，开关管S2和S4进行高频斩波的占空比d的值恒定；在缓降阶段，开关管S2和S4进行高频斩波的占空比d的值逐渐降低。优选的，设高频斩波的一个周期时间段为Ts，则0~dTs时间段为高电平段，dTs~Ts时间段为低电平段；在缓降阶段，通过占空比d的值逐渐减小，使得高电平段的时间段逐渐缩短，低电平段的时间段逐渐增加，进而使电流ig进行增长的幅值小于进行减小的幅值。优选的，在缓降阶段，高频斩波的占空比下降速率与有功功率P和电网的电流初始值Ig_ini有关；将有功功率P和电网的电流初始值Ig_ini作为前置条件，通过函数f或查表，得到占空比的下降速率。与现有技术相比，本申请的有益效果在于：通过形成等效电路，可以对传统微型逆变器电路增加无功功率控制功能。并且进行无功功率的控制无需修改硬件，只需在软件上进行修改即可。可以控制无功电流上升的速率以及无功电流的作用时间，并且可以防止模式切换过程中的电流冲击。附图说明图1为现有的一种微型逆变器电路的结构示意图。图2为现有的微型逆变器的工作流程示意图。图3为本发明其中一个实施例进行无功控制时的电网电流和电压以及各开关管的电平状态随时间的变化示意图。图4为本发明图3所示实施例进行无功控制时的等效电路的结构示意图。图5为本发明另一个实施例进行无功控制时的电网电流和电压以及各开关管的电平状态随时间的变化示意图。图6为本发明图5所示实施例进行无功控制时的等效电路的结构示意图一。图7为本发明图5所示实施例进行无功控制时的等效电路的结构示意图二。图8为本发明进行电流抑制时的电网电流和电压以及各开关管的电平状态随时间的变化示意图。图9为本发明图8中对应的高频斩波阶段的放大示意图。图10为本发明处于高频斩波的低电平段时等效电路的结构示意图。图11为本发明进行电流的最大值限制时的逻辑示意图。图12为本发明进行电流缓降时的电网电流和电压以及各开关管的电平状态随时间的变化示意图。图13为本发明图12中对应的占空比缓降阶段的放大示意图。图14为本发明进行占空比下降速率调节的逻辑示意图。图中：反激电路110、工频换向电路120、光伏组件200、电网300。具体实施方式下面，结合具体实施方式，对本申请做进一步描述，需要说明的是，在不相冲突的前提下，以下描述的各实施例之间或各技术特征之间可以任意组合形成新的实施例。在本申请的描述中，需要说明的是，对于方位词，如有术语“中心”、 “横向”、“纵向”、“长度”、“宽度”、“厚度”、“上”、“下”、 “前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”、“内”、“外”、“顺时针”、“逆时针”等指示方位和位置关系为基于附图所示的方位或位置关系，仅是为了便于叙述本申请和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定方位构造和操作，不能理解为限制本申请的具体保护范围。需要说明的是，本申请的说明书和权利要求书中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。如图1所示，为现有的一种微型逆变器的电路结构，主要包括前级的反激电路110和后级的工频换向电路120。反激电路110的输入端与光伏组件200进行连通，反激电路110的输出端与工频换向电路120的输入端连通，工频换向电路120的输出端与电网300进行连通。具体的，如图1所示，反激电路110包括开关管Sw、变压电路和二级管D；工频换向电路120包括桥式连接的开关管S1至S4。电网300通过电感Lg和电容Cg与工频换向电路120进行连接。如图2所示，为现有的微型逆变器的工作流程示意图；为了方便理解，下面可以结合图2所示的流程图对微型逆变器的具体工作过程进行详细的描述。对于反激电路110这一侧；首先将光伏组件200的电压VPV和电流iPV送入MPPT环路中，获得光伏组件200的电压指令VPV*。然后将得到的电压指令VPV*和电压VPV一同输入PI调节器后，获得电流峰值指令Ip*。同时，电网300的电压vg经过锁相环PLL产生相角信息|sinθ|。然后将电流峰值指令Ip*和相角信息|sinθ|相乘，获得电流瞬时值的参考iPV*。最后将电流瞬时值的参考iPV*和光伏组件200的电流值iPV送入峰值电流控制模块中，产生开关管Sw的控制信号以进行逆变器的反激。对于工频换向电路120这一侧；由电网300的电压vg的正负来决定。当电网300的电压vg为正时，开关管S1和S4为导通，开关管S2和S3为关断；当电网300的电压vg为负时，开关管S1和S4为关断，开关管S2和S3为导通；从而通过开关管的电平变化实现工频换向。应当知道的是，上述的工作过程只能够控制有功功率，无法控制无功功率。同时，为了方便后续内容的描述，将上述正常情况下控制有功功率的方式称为“正常发波”。可以理解的是，开关管S1至S4以及开关管Sw的具体结构和工作原理为本领域技术人员所公知，且开关管S1至S4以及开关管Sw的具体种类有多种，包括但不限于晶闸管和场效应管等。在本领域中，开关管Sw以及开关管S2和S4常用场效应管；开关管S1和S3常用晶闸管。基于上述内容，为实现在现有微型逆变器电路的基础上进行无功控制。本申请的其中一个优选实施例，如图3至图7所示，提供了一种微型逆变器无功控制方法，应用于上述的微型逆变器电路。在电网300的过零点，将开关管S1、S3和Sw进行关断设置，进而使开关管S2、S4、电容Cg以及电感Lg与电网300形成等效电路，通过控制等效电路的电流和电压相互反向以进行微型逆变器电路的无功控制。可以理解的是，对于等效电路的调节方式有多种，包括但不限于下述的两种实施例。实施例一：如图3和图4所示，在电网300的过零点，将开关管S2和S4同时进行导通设置，此时开关管S1、S3和Sw均处于关断封锁状态，从而开关管S2、开关管S4、电感Lg、电容Cg和电网300进行连通以形成如图4中粗实线所示的等效电路。由等效电路可知，此时开关管S2和S4组成零电平，电容Cg两端的电压为零。当电网300的电压vg为正方向时，电网300的电流ig将负向增长；或电网300的电压vg为负方向时，电网300的电流ig将正向增长，这样电网300的电压和电流不同向即可形成无功功率。实施例二：如图5至图7所示，与实施例一不同的是，开关管S2和S4不是同时进行导通设置，而是根据电网300的电流方向交替进行导通设置。在电网300的过零点，若电网300的电流ig负向增长，则将开关管S2设置为导通，同时将开关管S1、S3和Sw设置为关断封锁状态，以及将开关管S4设置为关断状态。由于此时开关管S4的二极管导通方向与电网300的电压vg的正方保持一致，使得电网300的电压vg能够保持正方向，进而使电网300的电压vg和电流ig的方向不同。在电网300的过零点，若电网300的电流ig正向增长，则将开关管S4设置为导通，同时将开关管S1、S3和Sw设置为关断封锁状态，以及将开关管S2设置为关断状态。由于此时开关管S2的二极管导通方向与电网300的电压vg的负方向保持一致，使得电网300的电压vg能够保持负方向，进而使电网300的电压vg和电流ig的方向不同。可以理解的是，上述的两种实施例均可以满足对微型逆变器电路的无功控制，本领域的技术人员可以根据实际需要自行进行选择。且上述的两种实施例在进行无功控制时，无需对现有的微型逆变器电路进行硬件上的修改，只需通过软件上的调节即可。应当知道的是，在进行无功控制时，开关管S2和S4的导通作用时间ΔT即为无功作用时间。在无功作用时间ΔT作用完毕后，微型逆变器电路将进入原始的正常发波模式，在正常发波模式中，微型逆变器电路所产生的电压和电流同向以产生有功。而无功作用时间ΔT的作用长度是由微型逆变器系统所需要的的无功功率Q*的大小来决定的；一般来说，所需要的无功功率Q*的值越大，则无功作用时间ΔT的作用长度越大，即ΔT的值越大；反之越小。具体的，可以通过构建函数f来进行ΔT的计算。具体的计算过程如下：将无功功率Q*作为输入带入函数f中进行计算以得到对应的ΔT的值。则无功功率Q*和无功作用时间ΔT之间的函数f的具体表达式如下：；式中，t表示时间。应当知道的是，上述的实施例在进行微型逆变器电路的无功控制时，如图3和图5所示，主要存在两个问题。问题一：电网300侧的电感Lg一般比较小；所以在进行无功控制时，电流ig增长太快，意味着器件需要承受较大的电流，容易造成器件的过载损坏。问题二：在无功控制结束后，微型逆变器电路需要从无功控制模式立即切回正常发波模式；即电流开始反向回零，但一般会有一个过冲过程；过冲电流太大，同样会对器件造成过载损坏。为解决上述的两个问题，本申请提供了基于上述无功控制的改进方案。针对问题一，本申请的其中一个实施例，如图8至图11所示，在等效电路中，开关管S2和S4通过高频斩波以进行导通设置。因为是高频斩波，电流ig可以缓慢上升，这样可以有效的抑制电流ig的上升速率，同时对最大电流也可以进行有效抑制，从而降低了器件所要承受的最大电流。为方便进行理解，以上述无功控制的实施例二为例，进行利用高频斩波实现电流ig抑制的说明。具体的，如图9所示，高频斩波的一个周期包括高电平段和低电平段。当开关管S2和S4中的一个处于高频斩波的高电平段，另一个处于关断时；电容Cg的两端电压钳位为零，则电网300的电压vg和电流ig将相互反向增长。当开关管S2和S4中的一个处于高频斩波的低电平段，另一个处于关断时，电容Cg和电感Lg发生谐振，使得电网300的电流ig向零点的方向减小。可以理解的是，高电平段的电压大于开关管的导通压降，使得开关管在高电平段能够正常的进行导通；低电平段的电压小于开关管的导通压降，使得开关管在低电平段处于驱动封锁状态，即关断状态；一般来说，低电平段的电压默认为0。为了更方便的进行理解，以开关管S2进行高频斩波，开关管S4进行关断设置为例；如图8和图9所示，设高频斩波的占空比为d，则高频斩波的一个周期时间Ts内，高电平段对应的时间段为0~dTs，低电平段对应的时间段为dTs~Ts。当开关管S2处于0~dTs对应的高电平段时，对应的等效电路如图6所示。此时，电容Cg两端电压钳位为零，当电网300的电压vg为正方向，这样电网300的电流ig将反向增长。当开关管S2处于dTs~Ts对应的低电平段时，对应的等效电路如图10所示。此时，电容Cg电压不再被钳位，电感Lg和电容Cg发生谐振，使得电感Lg的能量转移至电容Cg，这样电网300的电流ig向零的方向进行减小。通过在高频斩波的一个周期时间Ts内，实现对电流ig的一增一减来降低电流ig的上升速率。应当知道的是，在电流ig向远离零点方向进行增加的幅值需要大于电流ig向靠近零点方向进行减小的幅值，以使得电流ig在整个无功作用时间ΔT内的趋势是增长的，只是增长的程度进行了降低。本实施例中，如图11所示，在无功控制阶段，电网300的电流最大值Ig_max与高频斩波的占空比d以及无功作用时间ΔT有关。为了有效保证在无功控制阶段的电流最大值Ig_max不会超过器件的承受范围，同时无功功率控制功能可以得到保证，可以构造一个函数f或者查表的方式对电流最大值Ig_max进行限制。即在进行无功控制时，将无功功率Q*的值以及电流ig的最大值限制值Ig_max*作为前置条件，根据前置条件通过函数f或者查表等方式，得到高频斩波的占空比d以及无功作用时间ΔT的值，进而根据占空比d以及无功作用时间ΔT的值对电网300的电流最大值Ig_max进行限制。针对问题二，本申请的其中一个实施例，如图12至图14所示，为了防止无功控制结束后立即切回正常发波模式时造成的过冲电流；在无功作用时间内采用插入一段占空比缓降阶段。该占空比缓降阶段的核心是将高频斩波的占空比慢慢降低，使电感电流ig电流先降为零，然后再转入正常发波模式。这样将电感Lg中的能量先降为零后，然后再转为正常发波模式就不会造成微型逆变器电路的振荡。通俗的讲，就是无功作用时间ΔT包括先后进行的恒波阶段和缓降阶段。在恒波阶段，等效电路主要用于实现对微型逆变器电路进行无功控制，此时开关管S2和S4进行高频斩波的占空比d的值恒定。在缓降阶段，开关管S2和S4进行高频斩波的占空比d的值逐渐降低。具体的说，如图12和图13所示，可以设高频斩波的一个周期时间段为Ts，则0~dTs时间段为高电平段，dTs~Ts时间段为低电平段。则在恒波阶段，由于占空比d的值恒定，使得电流ig进行增长的幅值与减小的幅值保持恒定，进而电流ig总体可以保持恒定的增长。在缓降阶段，通过占空比d的值逐渐减小，使得高电平段的时间段逐渐缩短，低电平段的时间段逐渐增加，进而使电流ig进行增长的幅值越来越小于进行减小的幅值，使得电流ig在无功作用时间结束前先降为零。应当知道的是，无功作用时间ΔT的值需要大于高频斩波的一个周期长度Ts；优选的是无功作用时间ΔT的值为高频斩波的一个周期长度Ts的整倍数，即ΔT=NTs，N≥2。为了方便进一步的理解，以开关管S2进行高频斩波，开关管S4进行关断设置为例进行详细的说明。如图12和图13所示，在缓降阶段，在0~dTs时间段内，开关管S2处于高电平段；此时电容Cg两端电压钳位为零，当电网300的电压vg为正方向，这样电网300的电流ig将反向增长。在dTs~Ts时间段内，开关管S2处于低电平段；此时电容Cg两端电压不再被钳位，电感Lg的能量转移到电容Cg，这样电网300的电流ig向零的方向减小。随着缓降阶段的持续，占空比d的值逐渐减小，这样电感电流ig增长的幅值越来越小于减小的幅值，使得电流ig慢慢降为零。应当知道的是，占空比缓降的速率可以根据实际的场景进行相应的调控，目标是电流ig能快速降为零，同时又不会造成太大的电流冲击。由于高频斩波的占空比下降速率与有功功率P和电网300的电流初始值Ig_ini有关；因此，在缓降阶段，可以根据有功功率P，电流初始值Ig_ini，通过函数f或者查表的方式，得到占空比的下降速率。即将有功功率P和电网300的电流初始值Ig_ini作为前置条件，通过函数f或查表，计算得到占空比的下降速率。以上描述了本申请的基本原理、主要特征和本申请的优点。本行业的技术人员应该了解，本申请不受上述实施例的限制，上述实施例和说明书中描述的只是本申请的原理，在不脱离本申请精神和范围的前提下本申请还会有各种变化和改进，这些变化和改进都落入要求保护的本申请的范围内。本申请要求的保护范围由所附的权利要求书及其等同物界定。
