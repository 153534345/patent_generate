标题title
一种RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法
摘要abst
本申请涉及一种RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法。该方法包括：建立RIS辅助的空间相关去蜂窝大规模MIMO系统的信道模型，并进行信道估计获得估计信道信息，推导出RIS辅助的空间相关去蜂窝大规模MIMO系统的下行可达速率的表达式，建立接入点有源波束和可重构智能表面无源波束联合优化问题及约束条件，将联合优化问题转化为接入点发射功率优化问题和可重构智能表面的相移优化问题，求解接入点发射功率优化问题和可重构智能表面的相移优化问题，获得优化结果，根据优化结果调整接入点的发射功率和可重构智能表面的相移，以实现RIS辅助的空间相关去蜂窝大规模MIMO系统最大化用户的和速率，提升了去蜂窝大规模MIMO系统的性能。
权利要求书clms
1.一种RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法，应用于RIS辅助的去蜂窝大规模MIMO系统中，所述系统包括：M个接入点AP、K个用户以及随机分布在给定区域内的Z个可重构智能表面RIS，其中，每个接入点AP配备N个天线，每个可重构智能表面RIS配有个反射单元，其特征在于，所述方法包括：建立RIS辅助的空间相关去蜂窝大规模MIMO系统的信道模型，所述信道分为直连信道和间接信道；根据所述信道模型，采用关闭所有可重构智能表面RIS的反射单元的方式对所述直连信道进行信道估计，采用逐个打开单个可重构智能表面RIS的单个反射单元的方式进行信道估计，获得估计信道信息；根据所述估计信道信息，推导出RIS辅助的空间相关去蜂窝大规模MIMO系统的下行可达速率的表达式；根据所述下行可达速率的表达式，建立接入点AP有源波束和可重构智能表面RIS无源波束联合优化问题，并将接入点AP发射功率约束和可重构智能表面RIS单位模量约束作为所述联合优化问题的约束条件；根据有源波束和无源波束的特性，将所述联合优化问题转化为接入点AP发射功率优化问题和可重构智能表面RIS的相移优化问题；采用注水算法求解接入点AP发射功率优化问题，采用凸优化求解器求解可重构智能表面RIS的相移优化问题，获得优化结果；根据所述优化结果调整接入点AP的发射功率和可重构智能表面RIS的相移，以实现RIS辅助的空间相关去蜂窝大规模MIMO系统最大化用户的和速率。2.根据权利要求1所述的方法，其特征在于，所述信道模型的表达为：；其中：，，，；其中，代表从接入点/＞到用户/＞的总级联信道，/＞，/＞，代表第m个接入点，/＞代表从接入点/＞到用户/＞的直接信道，/＞代表从接入点经过可重构智能表面/＞的第/＞个反射单元到用户/＞的间接信道，Z代表可重构智能表面RIS的个数，/＞代表可重构智能表面/＞的反射单元个数，/＞代表第t个可重构智能表面，/＞代表一个幅度已知的确定性信道，/＞为一个服从瑞利分布的信道，/＞代表接入点/＞到用户/＞的视距传输信道，e为自然常数，j为虚数单位，/＞为可重构智能表面/＞的第/＞个反射单元的相移反射系数，/＞代表从可重构智能表面/＞的第/＞个反射单元到用户/＞的信道，/＞代表从接入点/＞到可重构智能表面/＞的第/＞个反射单元的信道，代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户/＞的视距传输信道，/＞代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户/＞的非视距传输信道，/＞代表可重构智能表面/＞到用户/＞的视距传输信道，/＞代表可重构智能表面/＞到用户/＞的非视距传输信道，/＞代表从接入点/＞到可重构智能表面/＞的第个反射单元的视距传输信道，/＞代表从接入点/＞到可重构智能表面/＞的第/＞个反射单元的非视距传输信道，/＞为接入点/＞到用户/＞的大规模衰落系数，/＞为可重构智能表面/＞到用户/＞的大规模衰落系数，/＞为接入点/＞到可重构智能表面/＞的大规模衰落系数，/＞为接入点/＞到用户/＞的莱斯因子，/＞为可重构智能表面/＞到用户/＞的莱斯因子，/＞为接入点/＞到可重构智能表面/＞的莱斯因子。3.根据权利要求2所述的方法，其特征在于，所述估计信道信息的表达为：，；其中，为/＞的估计信道，/＞为/＞的估计信道，，/＞为接入点/＞到用户/＞的大规模衰落系数，，/＞为接入点/＞经过可重构智能表面/＞到用户/＞的大规模衰落系数，/＞为接入点/＞经过可重构智能表面/＞到用户/＞的大规模衰落系数，为导频序列的长度，/＞是每个导频符号的归一化信噪比，/＞为从接入点/＞到用户/＞的直接信道，/＞为分配给用户/＞的导频序列的共轭转置，/＞为分配给用户/＞的导频序列，代表从接入点/＞到用户/＞的加性噪声，/＞代表从接入点/＞经过可重构智能表面的第/＞个反射单元到用户/＞的加性噪声。4.根据权利要求3所述的方法，其特征在于，所述下行可达速率的表达式为：；用户的信干噪比/＞为：，其中，为数学期望，上标T表示转置，/＞为所有接入点AP到用户/＞的级联信道，，/＞，/＞代表矢量的维度，/＞为接入点/＞到用户/＞总级联信道，/＞，/＞为接入点/＞的天线个数，/＞为用户/＞的波束成形矩阵，，/＞，/＞为接入点/＞相应的波束赋形向量，，/＞是加性高斯白噪声的协方差，/＞为用户/＞的波束成形矩阵。5.根据权利要求4所述的方法，其特征在于，所述联合优化问题的表达式为： ，，；其中，为/＞的相移矩阵，/＞，/＞是/＞的最大发射功率，/＞表示约束于。6.根据权利要求5所述的方法，其特征在于，所述接入点AP发射功率优化问题的表达式为： ，；其中，为分配给用户/＞的功率，/＞为接入点AP处的长期功率分配，，/＞，/＞为矩阵的迹，/＞为迫零预编码向量，，/＞为/＞的估计信道，/＞，上标H表示共轭转置。7.根据权利要求6所述的方法，其特征在于，所述可重构智能表面RIS的相移优化问题的表达式为：，；其中，，/＞为辅助变量，/＞，/＞为可重构智能表面/＞的反射单元个数，/＞，/＞，/＞为一个半正定矩阵，/＞为/＞的第/＞行第/＞列元素，/＞，/＞。
说明书desc
技术领域本申请涉及通信技术领域，特别是涉及一种RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法。背景技术近年来由于用户和应用的急剧增加，对数据吞吐量的需求呈指数级增长。为了满足这一需求，去蜂窝大规模MIMO作为6G潜在的关键技术之一得到了广泛的关注。作为网络MIMO的一种实现方式，去蜂窝大规模MIMO在广域内部署数百甚至数千个随机分布的接入点，大量AP在相同的频率资源中同时为网络中数量较少的用户提供服务。此外，通过在AP上配备多个天线，去蜂窝大规模MIMO继承了大规模MIMO的信道硬化这一重要优点。智能反射表面也是6G使能技术之一。通常RIS是一个由大量无源反射元件组成的平面，每个无源反射元件都能独立改变入射信号的振幅和相位，通过在无线网络中密集部署RIS，可以灵活地重新构造发射机和接收机之间的传输信道，从而减小无线信道衰落损耗和干扰，实现无线通信容量和可靠性的提升。但目前的去蜂窝大规模MIMO系统中当AP天线间相关性较高时，天线选择性衰落减少、空间复用能力受限以及干扰会增加，因此，去蜂窝大规模MIMO系统的性能较差。发明内容基于此，有必要针对上述技术问题，提供一种能够提升去蜂窝大规模MIMO系统的性能的RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法。一种RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法，应用于RIS辅助的去蜂窝大规模MIMO系统中，所述系统包括：M个接入点AP、K个用户以及随机分布在给定区域内的Z个可重构智能表面RIS，其中，每个接入点AP配备N个天线，每个可重构智能表面RIS配有个反射单元，所述方法包括：建立RIS辅助的空间相关去蜂窝大规模MIMO系统的信道模型，所述信道分为直连信道和间接信道；根据所述信道模型，采用关闭所有可重构智能表面RIS的反射单元的方式对所述直连信道进行信道估计，采用逐个打开单个可重构智能表面RIS的单个反射单元的方式进行信道估计，获得估计信道信息；根据所述估计信道信息，推导出RIS辅助的空间相关去蜂窝大规模MIMO系统的下行可达速率的表达式；根据所述下行可达速率的表达式，建立接入点AP有源波束和可重构智能表面RIS无源波束联合优化问题，并将接入点AP发射功率约束和可重构智能表面RIS单位模量约束作为所述联合优化问题的约束条件；根据有源波束和无源波束的特性，将所述联合优化问题转化为接入点AP发射功率优化问题和可重构智能表面RIS的相移优化问题；采用注水算法求解接入点AP发射功率优化问题，采用凸优化求解器求解可重构智能表面RIS的相移优化问题，获得优化结果；根据所述优化结果调整接入点AP的发射功率和可重构智能表面RIS的相移，以实现RIS辅助的空间相关去蜂窝大规模MIMO系统最大化用户的和速率。在其中一个实施例中，所述信道模型的表达为：；其中：，，，；其中，代表从接入点/＞到用户/＞的总级联信道，/＞，，/＞代表第m个接入点，/＞代表从接入点/＞到用户/＞的直接信道，代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户/＞的间接信道，Z代表可重构智能表面RIS的个数，/＞代表可重构智能表面/＞的反射单元个数，/＞代表第t个可重构智能表面，/＞代表一个幅度已知的确定性信道，/＞为一个服从瑞利分布的信道，/＞代表接入点/＞到用户/＞的视距传输信道，e为自然常数，j为虚数单位，/＞为可重构智能表面/＞的第/＞个反射单元的相移反射系数，/＞代表从可重构智能表面/＞的第/＞个反射单元到用户/＞的信道，/＞代表从接入点/＞到可重构智能表面/＞的第/＞个反射单元的信道，/＞代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户的视距传输信道，/＞代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户/＞的非视距传输信道，/＞代表可重构智能表面/＞到用户/＞的视距传输信道，/＞代表可重构智能表面/＞到用户/＞的非视距传输信道，/＞代表从接入点/＞到可重构智能表面/＞的第/＞个反射单元的视距传输信道，/＞代表从接入点/＞到可重构智能表面的第/＞个反射单元的非视距传输信道，/＞为接入点/＞到用户/＞的大规模衰落系数，为可重构智能表面/＞到用户/＞的大规模衰落系数，/＞为接入点/＞到可重构智能表面/＞的大规模衰落系数，/＞为接入点/＞到用户/＞的莱斯因子，/＞为可重构智能表面到用户/＞的莱斯因子，/＞为接入点/＞到可重构智能表面/＞的莱斯因子。在其中一个实施例中，所述估计信道信息的表达为：，；其中，为/＞的估计信道，/＞为/＞的估计信道，，/＞为接入点/＞到用户/＞的大规模衰落系数，，/＞为接入点/＞经过可重构智能表面/＞到用户/＞的大规模衰落系数，/＞为接入点/＞经过可重构智能表面/＞到用户/＞的大规模衰落系数，为导频序列的长度，/＞是每个导频符号的归一化信噪比，/＞为从接入点/＞到用户/＞的直接信道，/＞为分配给用户/＞的导频序列的共轭转置，/＞为分配给用户/＞的导频序列，代表从接入点/＞到用户/＞的加性噪声，/＞代表从接入点/＞经过可重构智能表面的第/＞个反射单元到用户/＞的加性噪声。在其中一个实施例中，所述下行可达速率的表达式为：；用户的信干噪比/＞为：，其中，为数学期望，上标T表示转置，/＞为所有接入点AP到用户/＞的级联信道，，/＞，/＞代表矢量的维度，/＞为接入点/＞到用户/＞总级联信道，/＞，/＞为接入点/＞的天线个数，/＞为用户/＞的波束成形矩阵，，/＞，/＞为接入点/＞相应的波束赋形向量，，/＞是加性高斯白噪声的协方差，/＞为用户/＞的波束成形矩阵。在其中一个实施例中，所述联合优化问题的表达式为： ，，；其中，为/＞的相移矩阵，/＞，/＞是/＞的最大发射功率，/＞表示约束于。在其中一个实施例中，所述接入点AP发射功率优化问题的表达式为： ，；其中，为分配给用户/＞的功率，/＞为接入点AP处的长期功率分配，，/＞，/＞为矩阵的迹，/＞为迫零预编码向量，，/＞为/＞的估计信道，/＞，上标H表示共轭转置。在其中一个实施例中，所述可重构智能表面RIS的相移优化问题的表达式为：，；其中，，/＞为辅助变量，/＞，/＞为可重构智能表面/＞的反射单元个数，/＞，/＞，/＞为一个半正定矩阵，/＞为/＞的第/＞行第/＞列元素，/＞，/＞。上述RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法，通过建立RIS辅助的空间相关去蜂窝大规模MIMO系统的信道模型，信道分为直连信道和间接信道，根据信道模型，采用关闭所有可重构智能表面RIS的反射单元的方式对直连信道进行信道估计，采用逐个打开单个可重构智能表面RIS的单个反射单元的方式进行信道估计，获得估计信道信息，根据估计信道信息，推导出RIS辅助的空间相关去蜂窝大规模MIMO系统的下行可达速率的表达式，根据下行可达速率的表达式，建立接入点AP有源波束和可重构智能表面RIS无源波束联合优化问题，并将接入点AP发射功率约束和可重构智能表面RIS单位模量约束作为联合优化问题的约束条件，根据有源波束和无源波束的特性，将联合优化问题转化为接入点AP发射功率优化问题和可重构智能表面RIS的相移优化问题，采用注水算法求解接入点AP发射功率优化问题，采用凸优化求解器求解可重构智能表面RIS的相移优化问题，获得优化结果，根据优化结果调整接入点AP的发射功率和可重构智能表面RIS的相移，以实现RIS辅助的空间相关去蜂窝大规模MIMO系统最大化用户的和速率。由此，实现了下行和速率的最大化，显著改善了接入点AP相关性带来的性能损耗，提升了去蜂窝大规模MIMO系统的性能。附图说明图1为一个实施例中RIS辅助的空间相关去蜂窝大规模MIMO系统结构示意图；图2为一个实施例中RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法的流程示意图；图3为一个实施例中下行用户可达速率的累积分布函数图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。在一个实施例中，提供了一种RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法，应用于如图1所示的RIS辅助的去蜂窝大规模MIMO系统中，系统包括：M个接入点AP、K个用户以及随机分布在给定区域内的Z个可重构智能表面RIS，其中，每个接入点AP配备N个天线，每个可重构智能表面RIS配有个反射单元，每个用户配备单天线，所有接入点AP都通过一个回程链路连接CPU。如图2所示，该RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法包括以下步骤：步骤S220，建立RIS辅助的空间相关去蜂窝大规模MIMO系统的信道模型，信道分为直连信道和间接信道。在一个实施例中，信道模型的表达为：；其中：，，，；其中，代表从接入点/＞到用户/＞的总级联信道，/＞，，/＞代表第m个接入点，/＞代表从接入点/＞到用户/＞的直接信道，代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户/＞的间接信道，Z代表可重构智能表面RIS的个数，/＞代表可重构智能表面/＞的反射单元个数，/＞代表第t个可重构智能表面，/＞代表一个幅度已知的确定性信道，/＞为一个服从瑞利分布的信道，/＞代表接入点/＞到用户/＞的视距传输信道，e为自然常数，j为虚数单位，/＞为可重构智能表面/＞的第/＞个反射单元的相移反射系数，/＞代表从可重构智能表面/＞的第/＞个反射单元到用户/＞的信道，/＞代表从接入点/＞到可重构智能表面/＞的第/＞个反射单元的信道，/＞代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户的视距传输信道，/＞代表从接入点/＞经过可重构智能表面/＞的第/＞个反射单元到用户/＞的非视距传输信道，/＞代表可重构智能表面/＞到用户/＞的视距传输信道，/＞代表可重构智能表面/＞到用户/＞的非视距传输信道，/＞代表从接入点/＞到可重构智能表面/＞的第/＞个反射单元的视距传输信道，/＞代表从接入点/＞到可重构智能表面的第/＞个反射单元的非视距传输信道，/＞为接入点/＞到用户/＞的大规模衰落系数，为可重构智能表面/＞到用户/＞的大规模衰落系数，/＞为接入点/＞到可重构智能表面/＞的大规模衰落系数，/＞为接入点/＞到用户/＞的莱斯因子，/＞为可重构智能表面到用户/＞的莱斯因子，/＞为接入点/＞到可重构智能表面/＞的莱斯因子。步骤S240，根据信道模型，采用关闭所有可重构智能表面RIS的反射单元的方式对直连信道进行信道估计，采用逐个打开单个可重构智能表面RIS的单个反射单元的方式进行信道估计，获得估计信道信息。在一个实施例中，估计信道信息的表达为：，；其中，为/＞的估计信道，/＞为/＞的估计信道，，/＞为接入点/＞到用户/＞的大规模衰落系数，，/＞为接入点/＞经过可重构智能表面/＞到用户/＞的大规模衰落系数，/＞为接入点/＞经过可重构智能表面/＞到用户/＞的大规模衰落系数，为导频序列的长度，/＞是每个导频符号的归一化信噪比，/＞为从接入点/＞到用户/＞的直接信道，/＞为分配给用户/＞的导频序列的共轭转置，/＞为分配给用户/＞的导频序列，代表从接入点/＞到用户/＞的加性噪声，/＞代表从接入点/＞经过可重构智能表面的第/＞个反射单元到用户/＞的加性噪声。在一个实施例中，将接入点到用户k的信道建模为：；应理解，考虑每个接入点AP天线间的相关性，被建模为一个幅度已知的确定性信道，/＞被建模为一个服从瑞利分布的信道并且有/＞，表示服从均值为/＞、/＞协方差为循环对称复合高斯分布。其中，为接入点/＞和用户k之间的相关系数矩阵。从接入点/＞经过/＞的第/＞个反射元件到用户/＞的间接信道建模为：；其中：，；的相移矩阵可以表示为/＞, 代表RIS反射元件的单位模量约束。基于接入点/＞到用户k的信道建模和接入点/＞经过/＞的第/＞个反射元件到用户/＞的间接信道建模，系统的总级联信道可以表示为：。在考虑时分双工协议下进行信道估计，并且假设RIS的存在不影响信道互易性。在时分双工协议下，每个相干区间分为上行训练、下行数据传输以及上行数据传输三个阶段。在上行训练阶段，所有用户向AP发送长度为的正交导频序列，其中，分配给第k个用户的导频序列为/＞，/＞，/＞代表矢量的维度。将信道估计阶段划分成个子阶段。在第一个子阶段我们通过关闭所有RIS上的所有反射单元来估计直接信道/＞。令阶段为/＞：/＞，在/＞个子阶段，通过一次只打开一个RIS上的一个反射单元来估计间接信道/＞。在第一个子阶段，在AP处采用MMSE估计，直接信道上的接收信号/＞的表达式为：；其中，为每个导频符号的归一化信噪比，/＞，/＞代表发射导频功率，代表发射噪声功率。/＞是接入点/＞处的加性高斯白噪声，/＞。将接收到的信号/＞投影到AP上的信号/＞可以得到：；由此，可以得到从接入点到用户/＞的直接信道/＞的线性最小均方误差估计为：；其中，。在第阶段中，将/＞的第/＞个元素打开，关闭其他所有元素。/＞接收到的导频信号/＞的表达式为：；通过的接收信号/＞的表达式和/＞接收到的信号/＞的表达式，可以得到：；其中，表示为间接信道上的/＞的接收信号。由此，可以得到线性最小均方误差估计为：；其中。步骤S260，根据估计信道信息，推导出RIS辅助的空间相关去蜂窝大规模MIMO系统的下行可达速率的表达式。其中，对下行数据传输过程进行建模，推导出用户下行可达速率。在一个实施例中，下行可达速率的表达式为：；用户的信干噪比/＞为：，其中，为数学期望，上标T表示转置，/＞为所有接入点AP到用户/＞的级联信道，，/＞，/＞代表矢量的维度，/＞为接入点/＞到用户/＞总级联信道，/＞，/＞为接入点/＞的天线个数，/＞为用户/＞的波束成形矩阵，，/＞，/＞为接入点/＞相应的波束赋形向量，，/＞是加性高斯白噪声的协方差，/＞为用户/＞的波束成形矩阵。在一个实施例中，发送的预编码信号/＞的表达式为：；其中，为接入点/＞相应的波束赋形向量，/＞， /＞为用户/＞的数据符号。此外/＞且/＞，/＞表示K×K的单位矩阵，上标H表示共轭转置。每个AP满足功率约束/＞，其中，/＞是/＞的最大发射功率。可以获得用户/＞的接收信号，用户/＞的接收信号/＞的表达式为：；其中，是用户k处的加性高斯白噪声，/＞为用户/＞的数据符号。由此，可以得到用户/＞的信干噪比/＞和下行可达速率/＞为：，。步骤S280，根据下行可达速率的表达式，建立接入点AP有源波束和可重构智能表面RIS无源波束联合优化问题，并将接入点AP发射功率约束和可重构智能表面RIS单位模量约束作为联合优化问题的约束条件。在一个实施例中，通过联合设计混合波束成形来最大化用户和速率，建立接入点AP有源波束和可重构智能表面RIS无源波束联合优化问题，并将接入点AP发射功率约束和可重构智能表面RIS单位模量约束作为联合优化问题的约束条件，联合优化问题的表达式为： ，，；其中，为/＞的相移矩阵，/＞，/＞是/＞的最大发射功率，/＞表示约束于。步骤S300，根据有源波束和无源波束的特性，将联合优化问题转化为接入点AP发射功率优化问题和可重构智能表面RIS的相移优化问题。其中，在无源波束成形部分，可以设计一种长期无源波束成形器，使有源预编码器的最大功率最小化，并使用凸优化求解器解决和可重构智能表面RIS的相移优化问题；在有源波束成形部分，使用迫零预编码器进行波束成形设计，并使用注水算法解决接入点AP发射功率优化问题。在一个实施例中，接入点AP发射功率优化问题的表达式为： ，；其中，为分配给用户/＞的功率，/＞为接入点AP处的长期功率分配，，/＞，/＞为矩阵的迹，/＞为迫零预编码向量，，/＞为/＞的估计信道，/＞，上标H表示共轭转置。在一个实施例中，可重构智能表面RIS的相移优化问题的表达式为：，；其中，，/＞为辅助变量，/＞，/＞为可重构智能表面/＞的反射单元个数，/＞，/＞，/＞为一个半正定矩阵，/＞为/＞的第/＞行第/＞列元素，/＞，/＞。在一个实施例中，首先在有源波束设计方面，考虑使用迫零预编码器，因为它能消除用户间干扰，从而简化最优功率分配。用户接收的信号/＞可以表示为：；其中，，/＞，，/＞，/＞表示用户k处的加性噪声。迫零预编码之后可以得到/＞，从而有源波束成形可以设置为。在所有AP处都有长期功率分配/＞下，用户/＞的信干噪比可以化简为/＞。约束条件，/＞可以变换为：。因此联合优化问题可以变换为接入点AP发射功率优化问题，接入点AP发射功率优化问题的表达式为：，；，，/＞表示迫零预编码之后/＞相应的波束赋形向量。接入点AP发射功率优化问题的最优解可以通过注水算法获得，则：，其中，/＞是/＞的第/＞个对角线元素，/＞为一个归一化因子，并且/＞能够满足/＞。其次，根据所提出的有源波束设计，发现无源波束形成器与目标函数无关，仅与联合优化问题中的发射功率约束和单位模约束相关。因此，可以设计一个长期无源波束形成器来最小化有源预编码器的最大功率。最小化有源预编码器的最大功率的优化问题可以表示为：；；其中，，/＞，/＞。实际上，随着信道增益的增加，传输功率会减小，因此提出了一个通过无源波束成形最大化最小平均信道增益的次优化问题，次优化问题的表达式为：，；通过利用统计信道状态信息，用户的平均信道增益可以表示为一个关于/＞的函数：；其中，，/＞，/＞。其中，；；；其中，，/＞为/＞中视距传输信道的部分，/＞为/＞中非视距传输信道的部分，/＞，/＞为对/＞做数学变换后得到，，/＞为用户k到所有RIS的信道矩阵，/＞代表从可重构智能表面/＞到用户/＞的直接信道，/＞，，/＞为从接入点/＞到可重构智能表面/＞的信道，/＞为/＞到所有RIS的信道矩阵，/＞为/＞中视距传输信道的部分，/＞为/＞中非视距传输信道的部分，/＞，。/＞为/＞的单位矩阵。由于半正定，平均信道增益是/＞的凸函数。但是，因为目标函数不是/＞的凹函数，单位模量约束也不是凸集，所以可重构智能表面RIS的相移优化问题是一个非凸优化问题。应用半正定松弛将接入点AP发射功率优化问题转化为凸问题。首先，引入辅助变量/＞，将用户/＞的平均信道增益改写为：；其中，，/＞，/＞是一个半正定矩阵。由于，令/＞，/＞且/＞半正定。通过放松/＞上的秩约束，次优化问题的表达式可以变为可重构智能表面RIS的相移优化问题，可重构智能表面RIS的相移优化问题的表达式为：；；可重构智能表面RIS的相移优化问题是一个凸半正定规划，使用现有的凸优化求解器可以有效地求解。如果可重构智能表面RIS的相移优化问题的最优解是一个秩一的矩阵，那么最优解/＞是通过取对应于最优解/＞的最大特征值的特征向量得到的。步骤S320，采用注水算法求解接入点AP发射功率优化问题，采用凸优化求解器求解可重构智能表面RIS的相移优化问题，获得优化结果。步骤S340，根据优化结果调整接入点AP的发射功率和可重构智能表面RIS的相移，以实现RIS辅助的空间相关去蜂窝大规模MIMO系统最大化用户的和速率。上述RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法，通过建立RIS辅助的空间相关去蜂窝大规模MIMO系统的信道模型，信道分为直连信道和间接信道，根据信道模型，采用关闭所有可重构智能表面RIS的反射单元的方式对直连信道进行信道估计，采用逐个打开单个可重构智能表面RIS的单个反射单元的方式进行信道估计，获得估计信道信息，根据估计信道信息，推导出RIS辅助的空间相关去蜂窝大规模MIMO系统的下行可达速率的表达式，根据下行可达速率的表达式，建立接入点AP有源波束和可重构智能表面RIS无源波束联合优化问题，并将接入点AP发射功率约束和可重构智能表面RIS单位模量约束作为联合优化问题的约束条件，根据有源波束和无源波束的特性，将联合优化问题转化为接入点AP发射功率优化问题和可重构智能表面RIS的相移优化问题，采用注水算法求解接入点AP发射功率优化问题，采用凸优化求解器求解可重构智能表面RIS的相移优化问题，获得优化结果，根据优化结果调整接入点AP的发射功率和可重构智能表面RIS的相移，以实现RIS辅助的空间相关去蜂窝大规模MIMO系统最大化用户的和速率。由此，实现了下行和速率的最大化，显著改善了接入点AP相关性带来的性能损耗，提升了去蜂窝大规模MIMO系统的性能。在一个实施例中，结合仿真实验对本申请的RIS辅助的空间相关去蜂窝大规模MIMO系统优化方法性能进行进一步说明。如图3所示的下行用户可达速率的累积分布函数图，能直观的反应系统性能。仿真参数取K=4，M=4，N=5，Z=3，=20。如图3所示，在空间相关与空间不相关系统中优化后的系统性能均得到了较大的提升，并且能明显的看出优化算法能大大改善空间相关性对系统性能的影响。综上所述，本申请对RIS无源波束和AP有源波束进行了联合优化，借助凸优化求解器和注水算法能使系统中的用户可达速率得到较大提升。应该理解的是，虽然图2的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，图2中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些子步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
