标题title
一种静脉图像自适应曝光方法
摘要abst
本发明涉及一种静脉图像自适应曝光方法，属于图像处理技术领域领域，包括以下步骤：当前环境下分别采集用户在近红外灯开启下的静脉图像P1和在近红外灯关闭下的静脉图像P2，分别计算静脉图像P1的平均灰度值G1和静脉图像P2的平均灰度值G2，根据静脉图像P2的平均灰度值G2判断当前环境属于室内场景还是室外场景，若属于室内场景，则对静脉图像P1进行补光操作得到室内目标输出图像P3，若属于室外场景，则对静脉图像P1进行环境光分离操作得到室外目标输出图像P4，判断室外目标输出图像P4是否满足输出条件，若不满足输出条件，则对室外目标输出图像P4进行矫正操作。本发明能降低室外场景环境光对采集的静脉图像的影响，提高静脉图像质量。
权利要求书clms
1.一种静脉图像自适应曝光方法，其特征在于，包括以下步骤：步骤1：当前环境下通过静脉采集设备分别采集用户在近红外灯开启下的静脉图像P1和在近红外灯关闭下的静脉图像P2，分别计算静脉图像P1的平均灰度值G1和静脉图像P2的平均灰度值G2；步骤2：根据静脉图像P2的平均灰度值G2判断当前环境属于室内场景还是室外场景；步骤3：若属于室内场景，则对静脉图像P1进行补光操作得到室内目标输出图像P3；若属于室外场景，则对静脉图像P1进行环境光分离操作得到室外目标输出图像P4；步骤4：判断室外目标输出图像P4是否满足输出条件，若不满足输出条件，则对室外目标输出图像P4进行矫正操作。2.根据权利要求1所述的静脉图像自适应曝光方法，其特征在于：所述步骤2中根据静脉图像P2的平均灰度值G2判断当前环境属于室内场景还是室外场景为：设定第一灰度阈值N1，若静脉图像P2的平均灰度值G2小于第一灰度阈值N1，则判定当前环境属于室内场景，反之若静脉图像P2的平均灰度值G2大于第一灰度阈值N1，则判定当前环境属于室外场景。3.根据权利要求1所述的静脉图像自适应曝光方法，其特征在于：所述步骤3中对静脉图像P1进行补光操作之前还包括：根据静脉图像 P1 的平均灰度值G1判断是否需要补光，具体为：设定第二灰度阈值R1，若静脉图像P1的平均灰度值G1小于第二灰度阈值R1，则判定需要进行补光操作，反之不需要补光操作，输出静脉图像P1。4.根据权利要求3所述的静脉图像自适应曝光方法，其特征在于：所述补光操作为设定第三灰度阈值R2，调整静脉设备的曝光参数、增益参数，使得采集到的用户在近红外灯开启下的静脉图像P3的平均灰度值G3大于第二灰度阈值R1且小于第三灰度阈值R2。5.根据权利要求2所述的静脉图像自适应曝光方法，其特征在于：所述步骤3中对静脉图像P1进行环境光分离操作得到室外目标输出图像P4为：将静脉图像P1中每个像素点的灰度值减去静脉图像P2中对应位置像素点的灰度值与分离系数C的乘积，计算公式为：P4=P1-P2*C公式中，x和y分别为像素点的行坐标和列坐标。6.根据权利要求5所述的静脉图像自适应曝光方法，其特征在于：在对静脉图像P1进行环境光分离操作时，根据静脉图像P1的平均灰度值G1和静脉图像P2的平均灰度值G2计算室外场景环境光的影响系数S，并根据影响系数S对分离系数C进行调整。7.根据权利要求6所述的静脉图像自适应曝光方法，其特征在于：所述根据影响系数S对分离系数C进行调整为：设定系数阈值M1，若影响系数S小于系数阈值M1，分离系数C等于影响系数S，反之若影响系数S大于等于系数阈值M1，分离系数C等于1，计算公式为： S = /G1。8.根据权利要求7所述的静脉图像自适应曝光方法，其特征在于：所述步骤4中，对室外目标输出图像P4进行矫正操作包括：设定第四灰度阈值Q和数量阈值N，统计室外目标输出图像P4中灰度值大于Q的像素点数量，若其数量大于数量阈值N，则对室外目标输出图像P4进行二次分离得到矫正后的室外目标输出图像 P5，计算公式为：，公式中，G4为室外目标输出图像P4的平均灰度值，K1为灰度变量。9.根据权利要求8所述的静脉图像自适应曝光方法，其特征在于：计算矫正后的室外目标输出图像P5的平均灰度值G5，若其小于第一灰度阈值N1，则对矫正后的室外目标输出图像P5进行灰度调整得到二次矫正后的室外目标输出图像P6，计算公式为：。
说明书desc
技术领域本发明涉及于图像处理技术领域，特别是涉及一种静脉图像自适应曝光方法。背景技术静脉识别技术是通过近红外光对目标区域进行照射，当目标区域流动血液中的血红素吸收了近红外光后，可以获得静脉图像，再使用特征提取算法从静脉图像中提取出特征值，识别时将提取的特征值数据与之前存储的特征值数据进行比对，给出识别比对的结果，从而达到身份识别的功能。针对这种需要靠近红外补光才能获取静脉图像的设备，不仅仅对近红外光的补光强度有要求，而且在室外使用时由于环境光的影响，会在手指表皮形成反射光，即最终采集到的静脉图像是一个环境光和近红外光相互作用的产生的，因此如何降低室外场景环境光对采集的静脉图像的影响，是亟需解决的问题。发明内容本发明的主要目的是提供一种静脉图像自适应曝光方法，可以有效解决室外场景环境光对采集的静脉图像的影响。为实现上述目的，本发明提供了如下方案：步骤1：当前环境下通过静脉采集设备分别采集用户在近红外灯开启下的静脉图像P1和在近红外灯关闭下的静脉图像P2，分别计算静脉图像P1的平均灰度值G1和静脉图像P2的平均灰度值G2；步骤2：根据静脉图像P2的平均灰度值G2判断当前环境属于室内场景还是室外场景；步骤3：若属于室内场景，则对静脉图像P1进行补光操作得到室内目标输出图像P3；若属于室外场景，则对静脉图像P1进行环境光分离操作得到室外目标输出图像P4；步骤4：判断室外目标输出图像P4是否满足输出条件，若不满足输出条件，则对室外目标输出图像P4进行矫正操作。优选地，所述步骤2中根据静脉图像P2的平均灰度值G2判断当前环境属于室内场景还是室外场景为：设定第一灰度阈值N1，若静脉图像P2的平均灰度值G2小于第一灰度阈值N1，则判定当前环境属于室内场景，反之若静脉图像P2的平均灰度值G2大于第一灰度阈值N1，则判定当前环境属于室外场景。优选地，所述步骤3中对静脉图像P1进行补光操作之前还包括：根据静脉图像 P1的平均灰度值G1判断是否需要补光，具体为：设定第二灰度阈值R1，若静脉图像P1的平均灰度值G1小于第二灰度阈值R1，则判定需要进行补光操作，反之不需要补光操作，输出静脉图像P1。优选地，所述补光操作为设定第三灰度阈值R2，调整静脉设备的曝光参数、增益参数，使得采集到的用户在近红外灯开启下的静脉图像P3的平均灰度值G3大于第二灰度阈值R1且小于第三灰度阈值R2。优选地，所述步骤3中对静脉图像P1进行环境光分离操作得到室外目标输出图像P4为：将静脉图像P1中每个像素点的灰度值减去静脉图像P2中对应位置像素点的灰度值与分离系数C的乘积，计算公式为：P4=P1-P2*C公式中，x和y分别为像素点的行坐标和列坐标。优选地，在对静脉图像P1进行环境光分离操作时，根据静脉图像P1的平均灰度值G1和静脉图像P2的平均灰度值G2计算室外场景环境光的影响系数S，并根据影响系数S对分离系数C进行调整。优选地，所述根据影响系数S对分离系数C进行调整为：设定系数阈值M1，若影响系数S小于系数阈值M1，分离系数C等于影响系数S，反之若影响系数S大于等于系数阈值M1，分离系数C等于1，计算公式为： S =  / G1优选地，所述步骤4中，对室外目标输出图像P4进行矫正操作包括：设定第四灰度阈值Q和数量阈值N，统计室外目标输出图像P4中灰度值大于Q的像素点数量，若其数量大于数量阈值N，则对室外目标输出图像P4进行二次分离得到矫正后的室外目标输出图像P5，计算公式为：，公式中，G4为室外目标输出图像P4的平均灰度值，K1为灰度变量。优选地，计算矫正后的室外目标输出图像P5的平均灰度值G5，若其小于第一灰度阈值N1，则对矫正后的室外目标输出图像P5进行灰度调整得到二次矫正后的室外目标输出图像P6，计算公式为：本发明提供一种静脉图像自适应曝光方法，该方法包括分别采集近红外灯开启和近红外灯关闭下的静脉图像，并根据其平均灰度值判断当前环境是室内场景还是室外场景，并根据室内场景和室外场景进行不同的操作，室内场景下通过平均灰度值判断是否需要补光操作，室外场景下进行图像分离降低室外场景环境光对采集的静脉图像的影响，进而提高采集到的静脉图像质量，提高静脉识别成功率。附图说明图1为本发明涉及的一种静脉图像自适应曝光方法的流程图。具体实施方式下面通过具体实施例，对本发明的技术方案作进一步具体的说明，实施例是对本发明的说明而作，不是对本发明的限制，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。参照图1所示，本发明涉及一种静脉图像自适应曝光方法，其包括以下步骤：步骤1：当前环境下通过静脉采集设备分别采集用户在近红外灯开启下的静脉图像P1和在近红外灯关闭下的静脉图像P2，分别计算静脉图像P1的平均灰度值G1和静脉图像P2的平均灰度值G2；其中平均灰度值的计算方法为将图像所有像素点的灰度值相加除以像素点的个数；步骤2：根据静脉图像P2的平均灰度值G2判断当前环境属于室内场景还是室外场景，具体方法为：设定第一灰度阈值N1，若静脉图像P2的平均灰度值G2小于第一灰度阈值N1，则判定当前环境属于室内场景，反之若静脉图像P2的平均灰度值G2大于第一灰度阈值N1，则判定当前环境属于室外场景；若是在室内场景下采集用户的静脉图像，环境光影响较小，关闭近红外灯光的情况下采集的静脉图像因缺少近红外光，整体灰度值较低，因此设定第一灰度阈值N1，以此来判断当前环境是室内场景还是室外场景；步骤3：若属于室内场景，则对静脉图像P1进行补光操作得到室内目标输出图像P3；此外，在对静脉图像P1进行补光操作之前还包括：根据静脉图像 P1 的平均灰度值G1判断是否需要补光，具体为：设定第二灰度阈值R1，若静脉图像P1的平均灰度值G1小于第二灰度阈值R1，则判定需要进行补光操作，反之不需要补光操作，输出静脉图像P1，室内场景采集的静脉图像很有可能因为静脉采集设备曝光参数、增益参数导致静脉图像P1灰度较低，因此需要进行补光操作，其中补光操作为设定第三灰度阈值R2，调整静脉设备的曝光参数、增益参数，使得采集到的用户在近红外灯开启下的静脉图像P3的平均灰度值G3大于第二灰度阈值R1且小于第三灰度阈值R2；若属于室外场景，因环境光对采集到的静脉图像影响较大，因此需要降低环境光的影响，即对静脉图像P1进行环境光分离操作得到室外目标输出图像P4，环境光分离操作的具体方式为：将静脉图像P1中每个像素点的灰度值减去静脉图像P2中对应位置像素点的灰度值与分离系数C的乘积，计算公式为：P4=P1-P2*C公式中，x和y分别为像素点的行坐标和列坐标。在一个实施例中，根据静脉图像P1的平均灰度值G1和静脉图像P2的平均灰度值G2计算室外场景环境光的影响系数S，并根据影响系数S对分离系数C进行调整，具体方式为：设定系数阈值M1，若影响系数S小于系数阈值M1，分离系数C等于影响系数S，反之若影响系数S大于等于系数阈值M1，分离系数C等于1，计算公式为： S =  / G1步骤4：判断室外目标输出图像P4是否满足输出条件，若不满足输出条件，则对室外目标输出图像P4进行矫正操作，因环境光的影响，可能会导致采集到的静脉图像出现局部高亮的情况，因此矫正方式为统计静脉图像中的高亮像素点，具体包括：设定第四灰度阈值Q和数量阈值N，统计室外目标输出图像P4中灰度值大于Q的像素点数量，若其数量大于数量阈值N，则对室外目标输出图像P4进行二次分离得到矫正后的室外目标输出图像P5，计算公式为：，公式中，G4为室外目标输出图像P4的平均灰度值，K1为灰度变量。在一个实施例中，因矫正后的室外目标输出图像P5整体灰度值较低，不利于后续静脉识别等处理，因此需要对其进行灰度提升操作，具体方式为：计算矫正后的室外目标输出图像P5的平均灰度值G5，若其小于第一灰度阈值N1，则对矫正后的室外目标输出图像P5进行灰度调整得到二次矫正后的室外目标输出图像P6，计算公式为：以上所述的实施例仅是对本发明的优选方式进行描述，并非对本发明的范围进行限定，在不脱离本发明设计精神的前提下，本领域普通技术人员对本发明的技术方案做出的各种变形和改进，均应落入本发明权利要求书确定的保护范围内。
