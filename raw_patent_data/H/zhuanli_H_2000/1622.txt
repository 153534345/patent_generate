标题title
一种基于RTC通信的弱网场景带宽估计方法及系统
摘要abst
本发明提供了一种基于RTC通信的弱网场景带宽估计方法及系统，属于通信技术领域，方法包括：获取RTC网络中弱网模式下的下载数据；下载数据包括依次接收到的时间长度相等的数据段；根据数据量和响应时间测算当前数据段的段头带宽、段中带宽和段尾带宽；对段头带宽、段中带宽和段尾带宽求平均，以得到当前数据段的带宽，定义为第一带宽；测算当前数据段与下一数据段之间的带宽，定义为第二带宽；根据第一带宽和第二带宽估测下一数据段的带宽，以得到RTC网络中弱网模式下的实时带宽。该方法能够提前预估接收端接收后续数据的网络带宽，提高网络带宽估计的即时性，能够提前调整码率，避免网络拥堵的情况。
权利要求书clms
1.一种基于RTC通信的弱网场景带宽估计方法，其特征在于，包括：获取RTC网络中弱网模式下的下载数据；所述下载数据包括依次接收到的时间长度相等的数据段；根据数据量和响应时间测算当前所述数据段的段头带宽、段中带宽和段尾带宽；对所述段头带宽、所述段中带宽和段尾带宽求平均，以得到当前所述数据段的带宽，定义为第一带宽；测算当前所述数据段与下一所述数据段之间的带宽，定义为第二带宽；根据所述第一带宽和所述第二带宽估测下一所述数据段的带宽，以得到RTC网络中弱网模式下的实时带宽。2.根据权利要求1所述基于RTC通信的弱网场景带宽估计方法，其特征在于，所述根据数据量和响应时间测算当前所述数据段的段头带宽、段中带宽和段尾带宽具体包括：在所述数据段的头部抽取第一数据量S1，记录发起下载所述第一数据量的下载请求至完成所述第一数据量下载之间的时间，定义为第一响应时间t1，所述段头带宽T1的定义为：T1=S1/t1；在所述数据段的中部抽取第二数据量S2，记录发起下载所述第二数据量的下载请求至完成所述第二数据量下载之间的时间，定义为第二响应时间t2，所述段中带宽T2的定义为：T2=S2/t2；在所述数据段的尾部抽取第三数据量S3，记录发起下载所述第三数据量的下载请求至完成所述第三数据量下载之间的时间，定义为第三响应时间t3，所述段尾带宽T3的定义为：T3=S3/t3。3.根据权利要求2所述基于RTC通信的弱网场景带宽估计方法，其特征在于，所述第一带宽T4的定义为：T4=/3；所述第二带宽T5根据RTC网络中弱网模式下的标准带宽估计得到；所述RTC网络中弱网模式下的实时带宽T6的定义为：T6=T4+T5。4.根据权利要求1所述基于RTC通信的弱网场景带宽估计方法，其特征在于，所述下载数据中数据段的时间长度的确定方法包括：初始化所述时间长度；当所述RTC网络中弱网模式下的实时带宽满足网络堵塞条件时，缩短所述时间长度。5.根据权利要求4所述基于RTC通信的弱网场景带宽估计方法，其特征在于，在所述RTC网络中弱网模式下的实时带宽满足网络堵塞条件之后，还包括：配置接收所述下载数据的进程在后台运行；将接收到的所述下载数据存储至缓存空间中；当所述缓存空间中的所述数据段的数量大于最大缓存阈值时，放慢速度依次展示所述缓存空间中的所述数据段；清空所述缓存空间中的数据段。6.一种基于RTC通信的弱网场景带宽估计系统，其特征在于，包括：接收单元：用于获取RTC网络中弱网模式下的下载数据；所述下载数据包括依次接收到的时间长度相等的数据段；第一估计单元：用于根据数据量和响应时间测算当前所述数据段的段头带宽、段中带宽和段尾带宽；对所述段头带宽、所述段中带宽和段尾带宽求平均，以得到当前所述数据段的带宽，定义为第一带宽；第二估计单元：用于测算当前所述数据段与下一所述数据段之间的带宽，定义为第二带宽；实时带宽估计单元：用于根据所述第一带宽和所述第二带宽估测下一所述数据段的带宽，以得到RTC网络中弱网模式下的实时带宽。7.根据权利要求6所述基于RTC通信的弱网场景带宽估计系统，其特征在于，所述第一估计单元具体用于：在所述数据段的头部抽取第一数据量S1，记录发起下载所述第一数据量的下载请求至完成所述第一数据量下载之间的时间，定义为第一响应时间t1，所述段头带宽T1的定义为：T1=S1/t1；在所述数据段的中部抽取第二数据量S2，记录发起下载所述第二数据量的下载请求至完成所述第二数据量下载之间的时间，定义为第二响应时间t2，所述段中带宽T2的定义为：T2=S2/t2；在所述数据段的尾部抽取第三数据量S3，记录发起下载所述第三数据量的下载请求至完成所述第三数据量下载之间的时间，定义为第三响应时间t3，所述段尾带宽T3的定义为：T3=S3/t3。8.根据权利要求7所述基于RTC通信的弱网场景带宽估计系统，其特征在于，所述第一带宽T4的定义为：T4=/3；所述第二带宽T5根据RTC网络中弱网模式下的标准带宽估计得到；所述RTC网络中弱网模式下的实时带宽T6的定义为：T6=T4+T5。9.根据权利要求6所述基于RTC通信的弱网场景带宽估计系统，其特征在于，还包括：段长确定单元用于：初始化所述时间长度；当所述RTC网络中弱网模式下的实时带宽满足网络堵塞条件时，缩短所述时间长度。10.根据权利要求9所述基于RTC通信的弱网场景带宽估计系统，其特征在于，还包括：展示单元用于：配置接收所述下载数据的进程在后台运行；将接收到的所述下载数据存储至缓存空间中；当所述缓存空间中的所述数据段的数量大于最大缓存阈值时，放慢速度依次展示所述缓存空间中的所述数据段；清空所述缓存空间中的数据段。
说明书desc
技术领域本发明属于通信技术领域，具体涉及一种基于RTC通信的弱网场景带宽估计方法及系统。背景技术弱网场景是指在网络环境较差的情况下使用的场景，弱网场景的网络带宽、稳定性较低，容易出现丢包、延迟等问题。目前的网络带宽估计主要是估计当下的带宽，不能预测未来的网络带宽，且也缺少RTC通信下的弱网场景带宽估计方法。发明内容针对现有技术中的缺陷，本发明提供一种基于RTC通信的弱网场景带宽估计方法及系统，能够对网络情况进行预测，网络带宽估计的即时性更高。第一方面，一种基于RTC通信的弱网场景带宽估计方法，包括：获取RTC网络中弱网模式下的下载数据；下载数据包括依次接收到的时间长度相等的数据段；根据数据量和响应时间测算当前数据段的段头带宽、段中带宽和段尾带宽；对段头带宽、段中带宽和段尾带宽求平均，以得到当前数据段的带宽，定义为第一带宽；测算当前数据段与下一数据段之间的带宽，定义为第二带宽；根据第一带宽和第二带宽估测下一数据段的带宽，以得到RTC网络中弱网模式下的实时带宽。进一步地，根据数据量和响应时间测算当前数据段的段头带宽、段中带宽和段尾带宽具体包括：在数据段的头部抽取第一数据量S1，记录发起下载第一数据量的下载请求至完成第一数据量下载之间的时间，定义为第一响应时间t1，段头带宽T1的定义为：T1=S1/t1；在数据段的中部抽取第二数据量S2，记录发起下载第二数据量的下载请求至完成第二数据量下载之间的时间，定义为第二响应时间t2，段中带宽T2的定义为：T2=S2/t2；在数据段的尾部抽取第三数据量S3，记录发起下载第三数据量的下载请求至完成第三数据量下载之间的时间，定义为第三响应时间t3，段尾带宽T3的定义为：T3=S3/t3。进一步地，第一带宽T4的定义为：T4=/3；第二带宽T5根据RTC网络中弱网模式下的标准带宽估计得到；RTC网络中弱网模式下的实时带宽T6的定义为：T6=T4+T5。进一步地，下载数据中数据段的时间长度的确定方法包括：初始化时间长度；当RTC网络中弱网模式下的实时带宽满足网络堵塞条件时，缩短时间长度。进一步地，在RTC网络中弱网模式下的实时带宽满足网络堵塞条件之后，还包括：配置接收下载数据的进程在后台运行；将接收到的下载数据存储至缓存空间中；当缓存空间中的数据段的数量大于最大缓存阈值时，放慢速度依次展示缓存空间中的数据段；清空缓存空间中的数据段。第二方面，一种基于RTC通信的弱网场景带宽估计系统，包括：接收单元：用于获取RTC网络中弱网模式下的下载数据；下载数据包括依次接收到的时间长度相等的数据段；第一估计单元：用于根据数据量和响应时间测算当前数据段的段头带宽、段中带宽和段尾带宽；对段头带宽、段中带宽和段尾带宽求平均，以得到当前数据段的带宽，定义为第一带宽；第二估计单元：用于测算当前数据段与下一数据段之间的带宽，定义为第二带宽；实时带宽估计单元：用于根据第一带宽和第二带宽估测下一数据段的带宽，以得到RTC网络中弱网模式下的实时带宽。进一步地，第一估计单元具体用于：在数据段的头部抽取第一数据量S1，记录发起下载第一数据量的下载请求至完成第一数据量下载之间的时间，定义为第一响应时间t1，段头带宽T1的定义为：T1=S1/t1；在数据段的中部抽取第二数据量S2，记录发起下载第二数据量的下载请求至完成第二数据量下载之间的时间，定义为第二响应时间t2，段中带宽T2的定义为：T2=S2/t2；在数据段的尾部抽取第三数据量S3，记录发起下载第三数据量的下载请求至完成第三数据量下载之间的时间，定义为第三响应时间t3，段尾带宽T3的定义为：T3=S3/t3。进一步地，第一带宽T4的定义为：T4=/3；第二带宽T5根据RTC网络中弱网模式下的标准带宽估计得到；RTC网络中弱网模式下的实时带宽T6的定义为：T6=T4+T5。进一步地，还包括：段长确定单元用于：初始化时间长度；当RTC网络中弱网模式下的实时带宽满足网络堵塞条件时，缩短时间长度。进一步地，还包括：展示单元用于：配置接收下载数据的进程在后台运行；将接收到的下载数据存储至缓存空间中；当缓存空间中的数据段的数量大于最大缓存阈值时，放慢速度依次展示缓存空间中的数据段；清空缓存空间中的数据段。由上述技术方案可知，本发明提供的一种基于RTC通信的弱网场景带宽估计方法及系统，能够提前预估接收端接收后续数据的网络带宽，提高网络带宽估计的即时性，能够提前调整码率，避免网络拥堵的情况。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍。在所有附图中，类似的元件或部分一般由类似的附图标记标识。附图中，各元件或部分并不一定按照实际的比例绘制。图1为实施例提供的弱网场景带宽估计方法的流程图。图2为实施例提供的弱网场景带宽估计系统的模块框图。具体实施方式下面将结合附图对本发明技术方案的实施例进行详细的描述。以下实施例仅用于更加清楚地说明本发明的技术方案，因此只作为示例，而不能以此来限制本发明的保护范围。需要注意的是，除非另有说明，本申请使用的技术术语或者科学术语应当为本发明所属领域技术人员所理解的通常意义。应当理解，当在本说明书和所附权利要求书中使用时，术语“包括”和“包含”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。还应当理解，在此本发明说明书中所使用的术语仅仅是出于描述特定实施例的目的而并不意在限制本发明。如在本发明说明书和所附权利要求书中所使用的那样，除非上下文清楚地指明其它情况，否则单数形式的“一”、“一个”及“该”意在包括复数形式。如在本说明书和所附权利要求书中所使用的那样，术语“如果”可以依据上下文被解释为“当...时”或“一旦”或“响应于确定”或“响应于检测到”。类似地，短语“如果确定”或“如果检测到”可以依据上下文被解释为意指“一旦确定”或“响应于确定”或“一旦检测到”或“响应于检测到”。实施例:一种基于RTC通信的弱网场景带宽估计方法，参见图1，包括：A：获取RTC网络中弱网模式下的下载数据；下载数据包括依次接收到的时间长度相等的数据段；B：根据数据量和响应时间测算当前数据段的段头带宽、段中带宽和段尾带宽；C：对段头带宽、段中带宽和段尾带宽求平均，以得到当前数据段的带宽，定义为第一带宽；D：测算当前数据段与下一数据段之间的带宽，定义为第二带宽；E：根据第一带宽和第二带宽估测下一数据段的带宽，以得到RTC网络中弱网模式下的实时带宽。在本实施例中，由于弱网模式下网络带宽波动较大，使得RTC通信中视频流传输面临巨大挑战，所以该弱网场景带宽估计方法可以实时估计网络带宽，来实时调整通信过程中的编码码率，使得视频流的传输动态适应网络的实时变化。该弱网场景带宽估计方法首先分段下载视频流，需要下载的视频流首先可以根据段长进行等长分段，每段的时间长度相等。然后RTC网络中的接收端按照分段顺序从前往后依次接收。在本实施例中，弱网场景带宽估计方法首先估计当前数据段的带宽，即在当前数据段的头部、中部、尾部分别选中一部分数据量，并根据对应的数据量估计当前数据段的段头带宽、段中带宽和段尾带宽，然后对段头带宽、段中带宽和段尾带宽求平均，以得到当前数据段的带宽，这样该方法就能够根据当前数据段整体的带宽情况估算当前数据段的带宽，得到第一带宽，第一带宽能够反应出当前的网络情况。接着该弱网场景带宽估计方法估算当前数据段接收结束到下一数据段开始接收之间的带宽，定义为第二带宽，第二带宽能够反应出接收下一数据段之前的网络情况。该弱网场景带宽估计方法根据第一带宽和第二带宽估测下一数据段的带宽，得到弱网模式下的实时带宽，即根据接收当前数据段的网络情况和接收下一数据段之前的网络情况，估计接收下一数据段的网络情况，这样就可以在接收下一数据段之前根据预估的带宽调整码率，避免网络拥堵的情况。该弱网场景带宽估计方法能够提前预估接收端接收后续数据的网络带宽，提高了网络带宽估计的即时性，能够提前调整码率，避免网络拥堵的情况。进一步地，在一些实施例中，根据数据量和响应时间测算当前数据段的段头带宽、段中带宽和段尾带宽具体包括：在数据段的头部抽取第一数据量S1，记录发起下载第一数据量的下载请求至完成第一数据量下载之间的时间，定义为第一响应时间t1，段头带宽T1的定义为：T1=S1/t1；在数据段的中部抽取第二数据量S2，记录发起下载第二数据量的下载请求至完成第二数据量下载之间的时间，定义为第二响应时间t2，段中带宽T2的定义为：T2=S2/t2；在数据段的尾部抽取第三数据量S3，记录发起下载第三数据量的下载请求至完成第三数据量下载之间的时间，定义为第三响应时间t3，段尾带宽T3的定义为：T3=S3/t3。在本实施例中，该弱网场景带宽估计方法在估算段头带宽、段中带宽和段尾带宽时，都是根据数据量和响应时间进行估算。其中第一数据量、第二数据量、第三数据量分别根据用户的需求自行确认或者是随机抽取，第一数据量、第二数据量和第三数据量可以相同也可以不同。例如在估计段头带宽时，发起下载第一数据量S1的下载请求，记录此时时刻为t01，接着开始下载第一数据量S1，当第一数据量S1下载完成后，记录此时时刻为t02，则第一响应时间t1= t02- t01，此时得到的段头带宽T1 =S1/t1。同理，段中带宽和段尾带宽的估计方法同段头带宽。进一步地，在一些实施例中，第一带宽T4的定义为：T4=/3；第二带宽T5根据RTC网络中弱网模式下的标准带宽估计得到；RTC网络中弱网模式下的实时带宽T6的定义为：T6=T4+T5。在本实施例中，当前数据段的带宽等于段头带宽、段中带宽和段尾带宽的平均，即第一带宽T4=/3。第二带宽根据标准带宽获得，如果第二带宽T5较大，说明网络波动较大，如果第二带宽T5较小，说明网络波动较小。最后该弱网场景带宽估计方法在第一带宽的基础上累加第二带宽，得到RTC网络中接收下一数据段的带宽情况，这样得到的实时带宽能够紧紧跟随实际带宽变化而变化，带宽估计更加准确。进一步地，在一些实施例中，下载数据中数据段的时间长度的确定方法包括：初始化时间长度；当RTC网络中弱网模式下的实时带宽满足网络堵塞条件时，缩短时间长度。在本实施例中，该弱网场景带宽估计方法可以预设时间长度的缺省值，这样当该弱网场景带宽估计方法开始启动运行时，根据缺省值对时间长度进行初始化。当实时带宽满足网络堵塞条件时，说明RTC网络已出现堵塞，此时为了提高带宽检测的实时性，缩短时间长度，这样就能提高码率的调整频率，使得网络堵塞情况尽快得到缓解。进一步地，在一些实施例中，在RTC网络中弱网模式下的实时带宽满足网络堵塞条件之后，还包括：配置接收下载数据的进程在后台运行；将接收到的下载数据存储至缓存空间中；当缓存空间中的数据段的数量大于最大缓存阈值时，放慢速度依次展示缓存空间中的数据段；清空缓存空间中的数据段。在本实施例中，由于弱网场景下的网络状态不稳定，所以当网络堵塞时就会导致视频显示时出现卡顿，所以该方法在网络堵塞时，可以将接收到下载数据先缓存起来，当缓存到一定数量时，在统一进行展示。展示的时候可以放慢速度显示视频，这样避免带来突然顺畅突然卡顿的较差体验感。当缓存空间中的数据展示完后，清空缓存空间中的数据。这样缓存空间就可以在下一次网络堵塞时用于缓存数据。一种基于RTC通信的弱网场景带宽估计系统，参见图2，包括：接收单元1：用于获取RTC网络中弱网模式下的下载数据；下载数据包括依次接收到的时间长度相等的数据段；第一估计单元2：用于根据数据量和响应时间测算当前数据段的段头带宽、段中带宽和段尾带宽；对段头带宽、段中带宽和段尾带宽求平均，以得到当前数据段的带宽，定义为第一带宽；第二估计单元3：用于测算当前数据段与下一数据段之间的带宽，定义为第二带宽；实时带宽估计单元4：用于根据第一带宽和第二带宽估测下一数据段的带宽，以得到RTC网络中弱网模式下的实时带宽。进一步地，在一些实施例中，第一估计单元2具体用于：在数据段的头部抽取第一数据量S1，记录发起下载第一数据量的下载请求至完成第一数据量下载之间的时间，定义为第一响应时间t1，段头带宽T1的定义为：T1=S1/t1；在数据段的中部抽取第二数据量S2，记录发起下载第二数据量的下载请求至完成第二数据量下载之间的时间，定义为第二响应时间t2，段中带宽T2的定义为：T2=S2/t2；在数据段的尾部抽取第三数据量S3，记录发起下载第三数据量的下载请求至完成第三数据量下载之间的时间，定义为第三响应时间t3，段尾带宽T3的定义为：T3=S3/t3。进一步地，在一些实施例中，第一带宽T4的定义为：T4=/3；第二带宽T5根据RTC网络中弱网模式下的标准带宽估计得到；RTC网络中弱网模式下的实时带宽T6的定义为：T6=T4+T5。进一步地，在一些实施例中，还包括：段长确定单元5用于：初始化时间长度；当RTC网络中弱网模式下的实时带宽满足网络堵塞条件时，缩短时间长度。进一步地，在一些实施例中，还包括：展示单元6用于：配置接收下载数据的进程在后台运行；将接收到的下载数据存储至缓存空间中；当缓存空间中的数据段的数量大于最大缓存阈值时，放慢速度依次展示缓存空间中的数据段；清空缓存空间中的数据段。本发明实施例所提供的系统，为简要描述，实施例部分未提及之处，可参考前述实施例中相应内容。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围，其均应涵盖在本发明的权利要求和说明书的范围当中。
