标题title
一种计时装置用控制装置及其控制方法
摘要abst
本发明涉及一种计时装置用控制装置及其控制方法。本发明属于电子设备时序控制技术领域。该计时装置用控制装置，该装置包括，石英晶振构成的皮尔斯振荡网络模块、数字信号转换模块、定时控制模块、检测控制模块、调节控制模块与输出模块；所述皮尔斯振荡网络模块，其被配置为生成本地时钟信号，即时间数据；所述定时控制模块，其被配置为基于时间数据生成时序控制数据；所述调节控制模块，其被配置为调节皮尔斯振荡网络模块输出的时间数据；所述数字信号转换模块，其被配置为协调各模块的数字信号的输入、输出转换；该计时装置用控制装置及其控制方法，提高石英晶振构成的皮尔斯振荡网络模块输出的精度。
权利要求书clms
1.一种计时装置用控制方法，其特征在于，该方法包括以下步骤，获得皮尔斯振荡网络输出的第一时间数据；基于所述第一时间数据获得第一时序控制数据；基于所述第一时序控制数据与实际时序控制数据获得所述第一时序控制数据的误差数据；其中，所述第一时序控制数据包括若干组时序控制信号，所述实际时序控制数据包括若干组时序控制信号对应的实际时序控制信号；基于所述误差数据获得频率计时数据，基于所述频率计时数据，于设定时长后，获得第二时序控制数据；基于第二时序控制数据与实际时序控制数据获得所述第二时序控制数据的误差数据，基于所述第二时序控制数据的误差数据，获得控制完成或重新生成或告警的结果。2.根据权利要求1所述的一种计时装置用控制方法，其特征在于：所述误差数据包括单个所述时序控制信号中的时间数据与实际时序控制信号中的时间数据之间的差值大于设置值时，判断所述时序控制信号为误差信号。3.根据权利要求1所述的一种计时装置用控制方法，其特征在于：所述误差数据包括基于所有所述时序控制信号中的时间数据的基准值，判断所有所述时序控制信号是否为误差信号，其中，/＞，其中，/＞为各时序控制信号中的基础时序数据，所述基础时序数据为所述时序控制信号中的时间数据中的基础时间值，/＞为各时序控制信号中的时间数据的方差。4.根据权利要求1-3任一所述的一种计时装置用控制方法，其特征在于：当所述时序控制信号为误差信号时，获取并同步基准时间数据，获得频率计时数据并计数，于修正计时时长下，获取基准时间，基于基准时间获得时间偏差数据以及偏差方向数据，基于偏差方向数据调整第一时间数据获得第一时序控制数据，并基于第一时序控制数据获得第二时序控制数据。5.根据权利要求4所述的一种计时装置用控制方法，其特征在于：基于偏差方向数据，获得时间误差率，获得秒误差时长，并获得调整数据。6.根据权利要求5所述的一种计时装置用控制方法，其特征在于：基于皮尔斯振荡网络中的振荡频率计时，于修正计时时长下，获得基准时间。7.根据权利要求5所述的一种计时装置用控制方法，其特征在于：设置频率计数器，获得频率计数器标准输出频率信号并计数，于修正计时时长后，停止接收频率信号，获得频率累计计数值，获得基准时间。8.一种计时装置用控制装置，其特征在于，该装置包括，石英晶振构成的皮尔斯振荡网络模块、数字信号转换模块、定时控制模块、检测控制模块、调节控制模块与输出模块；所述皮尔斯振荡网络模块，其被配置为生成本地时钟信号，即时间数据；所述定时控制模块，其被配置为基于时间数据生成时序控制数据；所述检测控制模块，其被配置为采集定时控制模块生成的时序控制数据与实际执行的时序控制数据；所述调节控制模块，其被配置为调节皮尔斯振荡网络模块输出的时间数据；所述数字信号转换模块，其被配置为协调各模块的数字信号的输入、输出转换；所述输出模块，其被配置为当调节控制模块调节后，基于检测控制模块的二次检测结果，以预设的形式输出相应的结果。
说明书desc
技术领域本发明属于电子设备时序控制技术领域，具体涉及一种计时装置用控制装置及其控制方法。背景技术在电子设备中，不同的执行操作之间具有不同的时序。通常情况下，定时控制器通过本地时间信号生成多个时序控制信号，以生成的多个时序控制信号分别控制不同的模块执行响应的功能操作。但随着科技的发展。电子设备的控制逻辑趋向于复杂化和更快速化。这将对生成的时序控制信号的数量、时钟精确度等有着更高的要求。而本地时钟信号通常采用晶振等形式实现，其因工艺、材料等问题，具有不可避免的频偏等。且成本越低廉的晶振，其产生的本地时钟信号的频偏越大，对时序控制的干扰也越大。发明内容本发明的目的就在于为了解决上述问题而提供一种结构简单，设计合理的计时装置用控制装置及其控制方法。本发明通过以下技术方案来实现上述目的：本发明第一方面提出了一种计时装置用控制方法，该方法包括以下步骤，获得皮尔斯振荡网络输出的第一时间数据；基于所述第一时间数据获得第一时序控制数据；基于所述第一时序控制数据与实际时序控制数据获得所述第一时序控制数据的误差数据；其中，所述第一时序控制数据包括若干组时序控制信号，所述实际时序控制数据包括若干组时序控制信号对应的实际时序控制信号；基于所述误差数据获得频率计时数据，基于所述频率计时数据，于设定时长后，获得第二时序控制数据；基于第二时序控制数据与实际时序控制数据获得所述第二时序控制数据的误差数据，基于所述第二时序控制数据的误差数据，获得控制完成或重新生成或告警的结果。作为本发明的进一步优化方案，所述误差数据包括单个所述时序控制信号中的时间数据与实际时序控制信号中的时间数据之间的差值大于设置值时，判断所述时序控制信号为误差信号。作为本发明的进一步优化方案，所述误差数据包括基于所有所述时序控制信号中的时间数据的基准值，判断所有所述时序控制信号是否为误差信号，其中，，其中，/＞为各时序控制信号中的基础时序数据，所述基础时序数据为所述时序控制信号中的时间数据中的基础时间值，/＞为各时序控制信号中的时间数据的方差。作为本发明的进一步优化方案，当所述时序控制信号为误差信号时，获取并同步基准时间数据，获得频率计时数据并计数，于修正计时时长下，获取基准时间，基于基准时间获得时间偏差数据以及偏差方向数据，基于偏差方向数据调整第一时间数据获得第一时序控制数据，并基于第一时序控制数据获得第二时序控制数据。作为本发明的进一步优化方案，基于偏差方向数据，获得时间误差率，获得秒误差时长，并获得调整数据。作为本发明的进一步优化方案，基于皮尔斯振荡网络中的振荡频率计时，于修正计时时长下，获得基准时间。作为本发明的进一步优化方案，基于频率计数器，获得频率计数器标准输出频率信号并计数，于修正计时时长后，停止接收频率信号，获得频率累计计数值，获得基准时间。本发明第二方面提出了一种计时装置用控制装置，该装置包括，石英晶振构成的皮尔斯振荡网络模块、数字信号转换模块、定时控制模块、检测控制模块、调节控制模块与输出模块；所述皮尔斯振荡网络模块，其被配置为生成本地时钟信号，即时间数据；所述定时控制模块，其被配置为基于时间数据生成时序控制数据；所述检测控制模块，其被配置为采集定时控制模块生成的时序控制数据与实际执行的时序控制数据；所述调节控制模块，其被配置为调节皮尔斯振荡网络模块输出的时间数据；所述数字信号转换模块，其被配置为协调各模块的数字信号的输入、输出转换；所述输出模块，其被配置为当调节控制模块调节后，基于检测控制模块的二次检测结果，以预设的形式输出相应的结果。本发明的有益效果在于：本发明通过对实际的时序控制数据与装置生成的第一时序数据对比，来获得相应的误差数据，通过对误差数据的分析来调整第一时间数据，以求来提高皮尔斯振荡网络所输出的精度；并，再对生成的第二时序控制数据进行相应的验证，若误差消失了，则输出控制完成的结果；如果误差降低了，则输出重新生产的结果，并以第二时序控制数据为上述步骤中的第一时序控制数据，重新执行各步骤，重复设定次数，若仍无法消除误差，则输出告警的结果；若单次无法降低误差，则直接输出告警的结果；本发明可以极大的提高时序控制精度。附图说明图1是本发明的一种计时装置用控制方法的方法流程图；图2是本发明的一种计时装置用控制方法的时间数据一种调整方法流程图；图3是本发明的一种计时装置用控制方法的时间数据另一种调整方法流程图；图4本发明的一种计时装置用控制装置的模块系统图。具体实施方式下面结合附图对本申请作进一步详细描述，有必要在此指出的是，以下具体实施方式只用于对本申请进行进一步的说明，不能理解为对本申请保护范围的限制，该领域的技术人员可以根据上述申请内容对本申请作出一些非本质的改进和调整。如图1所示，提供了一种计时装置用控制方法的方法流程图，该方法包括以下步骤，步骤S102，获得皮尔斯振荡网络输出的第一时间数据；基于所述第一时间数据获得第一时序控制数据；步骤S104，基于所述第一时序控制数据与实际时序控制数据获得所述第一时序控制数据的误差数据；其中，所述第一时序控制数据包括若干组时序控制信号，所述实际时序控制数据包括若干组时序控制信号对应的实际时序控制信号；步骤S106，基于所述误差数据获得频率计时数据，基于所述频率计时数据，于设定时长后，获得第二时序控制数据；步骤S108，基于第二时序控制数据与实际时序控制数据获得所述第二时序控制数据的误差数据；步骤S110，基于所述第二时序控制数据的误差数据，获得控制完成或重新生成或告警的结果。在本实施例中，通过对实际的时序控制数据与装置生成的第一时序数据对比，来获得相应的误差数据，通过对误差数据的分析来调整第一时间数据，以求来提高皮尔斯振荡网络所输出的精度；并，再对生成的第二时序控制数据进行相应的验证，若误差消失了，则输出控制完成的结果；如果误差降低了，则输出重新生产的结果，并以第二时序控制数据为上述步骤中的第一时序控制数据，重新执行各步骤，重复设定次数，若仍无法消除误差，则输出告警的结果；若单次无法降低误差，则直接输出告警的结果。在对误差数据进行相应的判断时，会考虑单个的时序控制信号中的时间数据的误差以及单个时序控制信号中的时间数据与所有的时序控制信号中的时间数据的相互差值的影响；即进一步的，所述误差数据包括单个所述时序控制信号中的时间数据与实际时序控制信号中的时间数据之间的差值大于设置值时，判断所述时序控制信号为误差信号。再进一步的，所述误差数据包括基于所有所述时序控制信号中的时间数据的基准值，判断所有所述时序控制信号是否为误差信号，其中，/＞，其中，/＞为各时序控制信号中的基础时序数据，所述基础时序数据为所述时序控制信号中的时间数据中的基础时间值，/＞为各时序控制信号中的时间数据的方差；其中，同样是基于单个时序控制信号中的时间数据与基准值之间的差值来判断该时序控制信号的时间数据是否为误差值。进一步的，当所述时序控制信号为误差信号时，获取并同步基准时间数据，获得频率计时数据并计数，于修正计时时长下，获取基准时间，基于基准时间获得时间偏差数据以及偏差方向数据，基于偏差方向数据调整第一时间数据获得第一时序控制数据，并基于第一时序控制数据获得第二时序控制数据。基于偏差方向数据，获得时间误差率，获得秒误差时长，并获得调整数据。具体的，分为两种情况，如图2所示，其中一种为：基于皮尔斯振荡网络中的振荡频率计时，于修正计时时长下，获得基准时间。具体的，保持现有的皮尔斯振荡网络模块，参考现有的精准计时装置，通过读取，输入两次读取外部精确基准时间并与皮尔斯振荡网络模块内部基准时间进行比较，从而获取到时间偏差值，将该偏差值换算为时间补偿值，对皮尔斯振荡网络模块的计时进行实时补偿，从而得到比较高的计时精度。这个方法实现相对简单，成本比较低。但要获取一定精度的时间补偿值，需要的修正时间跨度相对较长。在图2中，其符号及计算方法说明如下:基准时间t0：原始基准时间；基准时间t1：次基准时间 ；修正计时时长ΣTR：进行时间修正的总时长；基准时间戳TO：TO=Unit_TimeStamp；基准时间戳T1：T1=Unit_TimeStamp；时间偏差ΔT：ΔT=l-Tcl；时间误差率η：η=ΔT/；秒误差时长TL：TL=1/η=/ΔT；实时间tR：运行实时间。如图3所示，另一种为：基于频率计数器，获得频率计数器标准输出频率信号并计数，于修正计时时长后，停止接收频率信号，获得频率累计计数值，获得基准时间。在图3中，其符号及计算方法说明如下:基准频率FB：原始钟输出基准频率，一般为10MHZ；基准频率累计计数ΣCB：修正时间段内累计基准频率计数值；修正基准时间TB :TB=ΣCB/FB;修正计时时长ΣTR：进行时间修正的总时长；时间偏差ΔT：ΔT=lTB-ΣTRl；时间误差率η：η=ΔT/TB；秒误差时长TL：TL=1/η=TB/ΔT；实时间tR：运行实时间；在图2与图3中，D＞0：实时间快于基准时间；D=0：实时间等于基准时间；D＜0：实时间慢于基准时间。具体的，直接通过捕捉原子钟或其他超高精度振荡器所输出的稳定、高精度的频率信号，一般有5MHz，10MHz等，经过计算获取基准时间，再与皮尔斯振荡网络模块自身基准时间进行比较计算来获得时间补偿值，然后对手表时间进行实时修正。这个方法需要在开发生产时配置一台原子钟或其他超高精度振荡器，但因为时基于频率信号进行修正，获取补偿值的修正时间会大大缩短，一般1~3分钟即可。如图4所示，在本实施例中，本发明还提供了一种计时装置用控制装置，该装置包括，石英晶振构成的皮尔斯振荡网络模块、数字信号转换模块、定时控制模块、检测控制模块、调节控制模块与输出模块；所述皮尔斯振荡网络模块，其被配置为生成本地时钟信号，即时间数据；所述定时控制模块，其被配置为基于时间数据生成时序控制数据；所述检测控制模块，其被配置为采集定时控制模块生成的时序控制数据与实际执行的时序控制数据；所述调节控制模块，其被配置为调节皮尔斯振荡网络模块输出的时间数据；所述数字信号转换模块，其被配置为协调各模块的数字信号的输入、输出转换；所述输出模块，其被配置为当调节控制模块调节后，基于检测控制模块的二次检测结果，以预设的形式输出相应的结果。在本申请所提供的几个实施例中，应该理解到，所揭露的设备和方法，可以通过其它的方式实现。以上所描述的设备实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，如：多个单元或组件可以结合，或可以集成到另一个系统，或一些特征可以忽略，或不执行。另外，所显示或讨论的各组成部分相互之间的耦合、或直接耦合、或通信连接可以是通过一些接口，设备或单元的间接耦合或通信连接，可以是电性的、机械的或其它形式的。上述作为分离部件说明的单元可以是、或也可以不是物理上分开的，作为单元显示的部件可以是、或也可以不是物理单元；既可以位于一个地方，也可以分布到多个网络单元上；可以根据实际的需要选择其中的部分或全部单元来实现本实施例方案的目的。另外，在本发明各实施例中的各功能单元可以全部集成在一个处理单元中，也可以是各单元分别单独作为一个单元，也可以两个或两个以上单元集成在一个单元中；上述集成的单元既可以采用硬件的形式实现，也可以采用硬件加软件功能单元的形式实现。本领域普通技术人员可以理解：实现上述方法实施例的全部或部分步骤可以通过程序指令相关的硬件来完成，前述的程序可以存储于计算机可读取存储介质中，该程序在执行时，执行包括上述方法实施例的步骤；而前述的存储介质包括：移动存储设备、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。
