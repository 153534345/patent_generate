标题title
电流采样电路及电子设备
摘要abst
本发明适用于电子电路技术领域，提供了一种电流采样电路及电子设备，电路包括：包括功率管Q1和功率管组的电阻可调模块，功率管Q1的漏极与电流输入端连接，源极通过功率管组与电流输出端连接；与功率管组连接的电流采样模块，用于采集功率管组的电流信号；信号调节模块，分别与电流采样模块、基准电压端Vref、信号调节模块、功率管Q1及功率管组连接。本申请通过功率管组的等效电阻的阻值R在流过电流的电流值I小时变大，降低了对采样运算放大器输入失调电压的要求，R在I大时变小，但是I*R的乘积仍然维持在较大范围，对采样运算放大器的输入失调电压不敏感，普通采样运算放大器即可满足一般要求，实现对变化电流的精确采样功能。
权利要求书clms
1.一种电流采样电路，其特征在于，包括：电阻可调模块、电流采样模块以及信号调节模块，所述电阻可调模块包括功率管Q1和功率管组；所述功率管Q1的漏极与电流输入端连接，所述功率管Q1的源极分别与所述功率管组的第一端和所述电流采样模块连接，所述功率管Q1的栅极分别与所述信号调节模块和所述功率管组的第二端连接，所述功率管组的第三端分别与所述电流采样模块和电流输出端连接，所述电流采样模块与信号调节模块连接，所述信号调节模块与基准电压端Vref连接；所述电流采样模块，用于采集所述功率管组的电流信号。2.如权利要求1所述的电流采样电路，其特征在于，所述功率管组包括N个串联的功率管Q2，其中，N≥1，所述功率管Q2和所述功率管Q1相同。3.如权利要求2所述的电流采样电路，其特征在于，所述电流采样模块包括功率管Q3、功率管Q4、电阻R1以及采样运算放大器CSA；所述功率管Q3的源极分别与所述功率管Q1的漏极和所述功率管组的第一端连接，所述功率管Q3的栅极分别与所述功率管Q1的栅极、所述功率管组的第二端以及所述信号调节模块连接，所述功率管Q3的漏极分别与所述功率管Q4的漏极和所述采样运算放大器CSA的正向输入端连接；所述功率管Q4的源极通过所述电阻R1接地，所述功率管Q4的源极连接所述信号调节模块，所述功率管Q4的栅极与所述采样运算放大器CSA的输出端连接；所述采样运算放大器CSA的反相输入端分别与所述电流输出端和所述功率管组的第三端连接。4.如权利要求3所述的电流采样电路，其特征在于，所述信号调节模块包括放大器EA，所述放大器EA的反向输入端与所述功率管Q4的源极连接，所述放大器EA的正向输入端与所述基准电压端Vref连接，所述放大器EA的输出端分别与所述功率管Q1的栅极、所述功率管组的第二端以及所述功率管Q3的栅极连接。5.一种电子设备，其特征在于，包括如权利要求1-4任一项所述的电流采样电路。
说明书desc
技术领域本发明属于电子电路技术领域，尤其涉及一种电流采样电路及电子设备。背景技术电流采样通常是利用外围高精度的精密电阻实现采样。其可以让电流流过精密电阻产生压降，然后采样电阻上的电压差，从而实现电流采样。或者等效的利用内部集成功率管的全开状态的等效电阻Rds_on来实现采样。但是，为了提高能量转化效率，采样电阻的阻值很小，通常只有几十毫欧姆。即使在大电流情况下，采样电阻上的压降也很小，所以对采样运算放大器的失调电压要求很高，对采样运算放大器提出很高的要求；而且在小电流情况下，采样电阻上的压降变得非常小，往往远远小于1mV，即使采样运算放大器失调电压很小，在很多情况下任然不能满足采样精度的要求。另外，还可以通过增加采样电阻的阻值以采样更小的电流，但是增大采样电阻的阻值会降低能量转换效率，特别是在大电流的情况下的能量转化效率低，能量损失大。发明内容本发明实施例提供一种电流采样电路及电子设备，旨在解决采样电阻阻值固定不适用电流变化的问题。本发明实施例是这样实现的，第一方面，本发明实施例提供一种电流采样电路，电阻可调模块、电流采样模块以及信号调节模块，所述电阻可调模块包括功率管Q1和功率管组；所述功率管Q1的漏极与电流输入端连接，所述功率管Q1的源极分别与所述功率管组的第一端和所述电流采样模块连接，所述功率管Q1的栅极分别与所述信号调节模块和所述功率管组的第二端连接，所述功率管组的第三端分别与所述电流采样模块和电流输出端连接，所述电流采样模块与信号调节模块连接，所述信号调节模块与基准电压端Vref连接；所述电流采样模块，用于采集所述功率管组的电流信号。近一步地，所述功率管组包括N个串联的功率管Q2，其中，N≥1，所述功率管Q2和所述功率管Q1相同。更近一步地，所述电流采样模块包括功率管Q3、功率管Q4、电阻R1以及采样运算放大器CSA；所述功率管Q3的源极分别与所述功率管Q1的漏极和所述功率管组的第一端连接，所述功率管Q3的栅极分别与所述功率管Q1的栅极、所述功率管组的第二端以及所述信号调节模块连接，所述功率管Q3的漏极分别与所述功率管Q4的漏极和所述采样运算放大器CSA的正向输入端连接；所述功率管Q4的源极通过所述电阻R1接地，所述功率管Q4的源极连接所述信号调节模块，所述功率管Q4的栅极与所述采样运算放大器CSA的输出端连接；所述采样运算放大器CSA的反相输入端分别与所述电流输出端和所述功率管组的第三端连接。更近一步地，所述信号调节模块包括放大器EA，所述放大器EA的反向输入端与所述功率管Q4的源极连接，所述放大器EA的正向输入端与所述基准电压端Vref连接，所述放大器EA的输出端分别与所述功率管Q1的栅极、所述功率管组的第二端以及所述功率管Q3的栅极连接。更近一步地，所述电流采样电路还包括信号控制模块，所述信号控制模块分别与所述电阻可调模块、所述电流采样模块以及信号调节模块连接；所述信号控制模块用于调节所述基准电压端Vref的电压值，以实现所述电流输入端和/或电流输出端的电流大小；或者，所述信号控制模块用于调节所述电阻R1的电阻值，以实现调节所述电流输入端和/或电流输出端的电流大小。更近一步地，所述信号控制模块用于调节所述基准电压端Vref的电压值，以实现调节所述电流输入端和/或电流输出端的电流大小，包括：获取预先设置的所述电流输入端的第一电流值和/或预先设置的所述电流输出端的第二电流值；根据所述第一电流值和/或所述第二电流值，确定所述电阻R1的目标电阻值；调节所述电阻R1的电阻值为所述目标电阻值，以实现调节所述电流输入端和/或电流输出端的电流大小。更近一步地，所述信号控制模块用于调节所述电阻R1的电阻值，以实现调节所述电流输入端和/或电流输出端的电流大小，包括：获取预先设置的所述电流输入端的第一电流值和/或预先设置的所述电流输出端的第二电流值；根据所述第一电流值和/或所述第二电流值确定所述电阻R1的目标电压值；调节所述基准电压端Vref的电压值为所述目标电压值，以实现调节所述电流输入端和/或电流输出端的电流大小。第二方面，本申请还提供一种电子设备，包括如上述的电流采样电路。本申请实施例通过电阻可调模块中的功率管Q1和功率管组串联，功率管Q1的漏极连接电流输入端，功率管组的另一端连接电流输出端，电流采样模块与功率管组连接以采集功率管组的电流信号，信号调节模块能根据电流采样模块和基准电压端Vref的基准电压信号调节输入电流，功率管组的等效电阻能随电流的变化产生自适应变化，当流过电流的电流值I小时，功率管组的等效电阻的阻值R变大，降低了对采样运算放大器输入失调电压的要求，当流过电流的电流值I大时，功率管组的等效电阻的阻值R变小，但是I*R的乘积仍然维持在较大范围，对采样运算放大器的输入失调电压不敏感，普通采样运算放大器即可满足一般要求，实现对变化电流的自适应精确采样功能。附图说明图1是本申请一个实施例的模块结构示意图；图2是本申请一个实施例的具体电路结构示意图；图3是本申请一个实施例高压线性充电应用的电路结构示意图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。在一些可选实施例中，如图1至图3所示，本申请第一方面提供一种电流采样电路，包括电阻可调模块1、电流采样模块2和信号调节模块3，电阻可调模块1包括功率管Q1和功率管组；功率管Q1的漏极与电流输入端input连接，功率管Q1的源极分别与功率管组的第一端和电流采样模块2连接，功率管Q1的栅极分别与信号调节模块3和功率管组的第二端连接，功率管组的第三端分别与电流采样模块2和电流输出端output连接，电流采样模块2与信号调节模块3连接，信号调节模块3与基准电压端Vref连接；电流采样模块2，用于采集功率管组的电流信号。在实施时，功率管组包括N个串联的功率管Q2，其中，N≥1，N个串联的功率管Q2中，相邻两个功率管Q2，前一个功率管Q2的漏极与后一个功率管Q2的源极连接，第一个功率管Q2的源极为功率管组的第一端，功率管组的第一端与功率管Q1的源极连接，即是，第一个功率管Q2的源极与功率管Q1的源极连接，最后一个功率管Q2的漏极为功率管组的第三端，功率管组的第三端与电流输出端output连接，即是，最后一个功率管Q2的漏极与电流输出端output连接，功率管Q1的源极通过多个串联的功率管Q2与电流输出端output连接，功率管组的第二端为N个串联的功率管Q2的栅极，其中，功率管Q1根据电流大小工作在饱和区或者工作在线性区，例如功率管Q1大多数情况下是工作在饱和区的，而在大电流的情况下工作在线性区间，而功率管Q2则始终工作在线性区。当输入电流为大电流时，功率管Q1的过驱动电压VGS大，功率管Q2的线性电阻小；而当输入电流为小电流时，功率管Q1的过驱动电压VGS小，功率管Q2的线性电阻大，利用功率管Q2始终工作在线性区间的自动调节的等效可变电阻实现对大电流或者小电流的自适应采样。本申请通过电阻可调模块1中的功率管Q1和功率管组串联，功率管Q1的漏极连接电流输入端input，功率管组的另一端连接电流输出端output，电流采样模块2与功率管组连接以采集功率管组的电流信号，信号调节模块3能根据电流采样模块2和基准电压端Vref的基准电压信号调节输入电流，功率管组的等效电阻能随电流的变化产生自适应变化，当流过电流的电流值I小时，功率管组的等效电阻的阻值R变大，降低了对采样运算放大器输入失调电压的要求，当输入电流大时，功率管组的等效电阻的阻值R变小，但是I*R的乘积仍然维持在较大范围，对采样运算放大器的输入失调电压不敏感，普通采样运算放大器即可满足一般要求，实现对变化电流的自适应精确采样功能。在一些可选实施例中，如图2所示，电流采样模块2包括功率管Q3、功率管Q4、电阻R1以及采样运算放大器CSA；功率管Q3的源极分别与功率管Q1的漏极和功率管组的第一端连接，功率管Q3的栅极分别与功率管Q1的栅极、功率管组的第二端以及信号调节模块3连接，功率管Q3的漏极分别与功率管Q4的漏极和采样运算放大器CSA的正向输入端连接；功率管Q4的源极通过电阻R1接地，功率管Q4的源极连接信号调节模块3，功率管Q4的栅极与采样运算放大器CSA的输出端连接；采样运算放大器CSA的反相输入端分别与电流输出端output和功率管组的第三端连接。信号调节模块3包括放大器EA，放大器EA的反向输入端与功率管Q4的源极连接，放大器EA的正向输入端与基准电压端Vref连接，放大器EA的输出端分别与功率管Q1的栅极、功率管组的第二端以及功率管Q3的栅极连接。在实施时，以功率管组包括一个功率管Q2为例，功率管Q1的漏极连接电流输入端input，功率管Q1的源极连接功率管Q2的源极，功率管Q2的漏极连接电流输出端output，功率管Q3的源极与功率管Q1的源极连接，功率管Q3的栅极与功率管Q2的栅极连接，功率管Q3的漏极与功率管Q4的漏极连接。信号调节模块3包括放大器EA，放大器EA的反向输入端与功率管Q4的源极连接，放大器EA的正向输入端与基准电压端Vref连接，放大器EA的输出端与功率管Q1的栅极、功率管Q2的栅极以及功率管Q3的栅极连接。在一些实施例中，功率管Q2可以设置有N个，各功率管Q2的源极和功率管Q3的源极连接在一起，各功率管Q2的栅极和功率管Q3的栅极连接在一起，各功率管Q2的漏极靠采样运算放大器CSA保证电位相等，从而保证功率管Q3采样到的电流和流过功率管Q2的电流等于功率管Q2和功率管Q3的个数比例N：1，另外，功率管Q3采样得到的电流到电阻R1形成电压，该电压和基准电压端Vref的基准电压作用于放大器EA，调节功率管Q1、功率管Q2和功率管Q3的栅极电压，达到调节输入电流的目的。功率管Q1和功率管Q2组成串联功率管，功率管Q2不管是输入电流在什么样的变化区间，始终工作在线性区间。当输入电流大的时候，功率管Q1的过驱动电压VGS大，功率管Q2的线性电阻小；当工作在小电流的情况下，功率管Q1 的过驱动电压VGS小，功率管Q2的线性电阻大。通过利用这个始终工作在线性区间的自动调节的可变电阻来实现对不管是大电流还是小电流的自适应采样。由于功率管Q2的线性电阻根据电流大小自动调节，所以功率管Q2的源漏压差Vds始终保持在一个较大的水平，例如100mV，所以对后继处理的采样运算放大器的失调电压没有太高的要求情况下也能达到比较高的采样精度。在一些实施例中，电流采样电路还包括信号控制模块，信号控制模块分别与电阻可调模块1、电流采样模块2以及信号调节模块3连接；信号控制模块用于调节基准电压端Vref的电压值，以实现电流输入端和/或电流输出端的电流大小；或者，信号控制模块用于调节电阻R1的电阻值，以实现调节电流输入端和/或电流输出端的电流大小。可选的，信号控制模块用于调节基准电压端Vref的电压值，以实现调节电流输入端和/或电流输出端的电流大小，包括：获取预先设置的电流输入端的第一电流值和/或预先设置的电流输出端的第二电流值；根据第一电流值和/或第二电流值，确定电阻R1的目标电阻值；调节电阻R1的电阻值为目标电阻值，以实现调节电流输入端和/或电流输出端的电流大小。在一些实施例中，信号控制模块用于调节电阻R1的电阻值，以实现调节电流输入端和/或电流输出端的电流大小，包括：获取预先设置的电流输入端的第一电流值和/或预先设置的电流输出端的第二电流值；根据第一电流值和/或第二电流值确定电阻R1的目标电压值；调节基准电压端Vref的电压值为目标电压值，以实现调节电流输入端和/或电流输出端的电流大小。在一些实施例中，如图3所示，功率管Q1的漏极连接输入端Vbus，功率管Q1的源极连接功率管Q2的源极，功率管Q2的漏极连接电池端Vbat，功率管Q2的栅极与功率管Q1的栅极连接，功率管Q2的源极连接功率管Q3的源极和功率管Q5的源极，功率管Q3的源极与恒流采样端Isense_cc连接，功率管Q5的源极与充电截止判断采样端Isense_eoc连接，功率管Q2、Q3和Q5的栅极相连，功率管Q3的漏极与功率管Q4的漏极连接，功率管Q4的源极通过电阻R1接地，功率管Q3的漏极与采样运算放大器CSA1的正向输入端连接，功率管Q2的漏极与采样运算放大器CSA1的反向输入端连接，采样运算放大器CSA1的输出端与功率管Q4的栅极连接；功率管Q5的漏极与功率管Q6的漏极连接，功率管Q6的源极通过电阻R2接地，功率管Q5的漏极与采样运算放大器CSA2的正向输入端连接，功率管Q2的漏极与采样运算放大器CSA2的反向输入端连接，采样运算放大器CSA2的输出端与功率管Q6的栅极连接，功率管Q6的源极与比较器Ceoc的正向输入端，比较器Ceoc的反向输入端与基准电压端Vref_eoc连接，比较器Ceoc的输出端为EOC；功率管Q4的源极与比较器EA1的反向输入端连接，比较器EA1的正向输入端连接基准电压端Vref_cc，比较器EA 1的输出端连接功率管Q2的栅极，功率管Q2的栅极连接电荷泵，电荷泵是一种直流-直流转换器，利用电容器为储能元件；功率管Q2的漏极还通过串联的电阻R3和电阻R4接地，电阻R3和电阻R4之间的线路连接放大器EA2的反向输入端，放大器EA2的正向输入端连接基准电压端Vref_cv，放大器EA2的输出端与功率管Q2的栅极连接。在实施时，功率管Q1和功率管Q2采用面对面的两个高压功率管，目的是防止输入端Vbus和电池端Vbat通过功率管的体二极管相互贯通；由于是集成薄栅功率管，所以功率管的VGS有一个防止高压击穿的齐纳二极管；系统包括两个环路：恒流CC环路和恒压CV环路；系统包括两个CSA采样环路：CC恒流采样和EOC充电截止判断采样。为了保证EOC电流高精度1mA截止，所以EOC的采样比例较小，设置成100：1以减小在功率管小过驱动电压下功率管和采样管的VTH阈值失调失配影响。恒流采样电路设置相对比较大的采样比例1000:1,在满足系统精度需求前提下，减小芯片内部功耗和提高能量转换效率。在一些实施例中，本申请还提供一种电流采样装置，包括如上述的电流采样电路。电路包括电阻可调模块1、电流采样模块2和信号调节模块3；电阻可调模块1包括功率管Q1和功率管组，功率管Q1的漏极与电流输入端input连接，功率管Q1的源极与功率管组的一端连接，功率管组的另一端与电流输出端output连接；电流采样模块2与功率管组连接，用于采集功率管组的电流信号；信号调节模块3与电流采样模块2的输出端以及基准电压端Vref连接，信号调节模块3的输出端与功率管Q1的栅极以及功率管组连接。在实施时，功率管组包括N个串联的功率管Q2，其中，N≥1，功率管Q1的源极通过多个串联的功率管Q2与电流输出端output连接，其中，功率管Q2和功率管Q3的源端、栅极分别接在一起，漏极靠采样运算放大器CSA保证电位相等。这样保证功率管Q3采样得到电流和流过功率管Q2的电流等于功率管Q2和功率管Q3的个数比例N：1。功率管Q3采样出来的电流注入到电阻R1形成电压，该电压和基准电压端Vref的电压作用于放大器EA，调节功率管Q1、功率管Q2和功率管Q3的栅极电压，达到调节输入电流的目的。功率管Q2则始终工作在线性区，当流过功率管组的电流的电流值I小时，功率管组的等效电阻的阻值R变大，降低对采样运算放大器的要求，满足采样要求；当流过功率管组的电流的电流值I小时，功率管组的等效电阻的阻值R变小，但是I*R的乘积仍然维持在较大范围，对采样运算放大器的输入失调电压不敏感，普通采样运算放大器即可满足一般要求，而且降低能耗，提高能量转化效率，通过利用功率管组中功率管Q2始终工作在线性区间的自动调节的可变电阻来实现对变化电流的自适应采样功能。在一些实施例中，本申请还提供一种电子设备，包括如上述的电流采样电路。本申请通过电阻可调模块1中的功率管Q1和功率管组串联，功率管Q1的漏极连接电流输入端input，功率管组的另一端连接电流输出端output，电流采样模块2与功率管组连接以采集功率管组的电流信号，信号调节模块3能根据电流采样模块2和基准电压端Vref的基准电压信号调节输入电流，功率管组的等效电阻能随电流的变化产生自适应变化，当流过功率管组的电流的电流值I小时，功率管组的等效电阻的阻值R变大，降低对采样运算放大器的要求，满足采样要求；当流过功率管组的电流的电流值I小时，功率管组的等效电阻的阻值R变小，但是I*R的乘积仍然维持在较大范围，对采样运算放大器的输入失调电压不敏感，普通采样运算放大器即可满足一般要求，降低能耗，提高能量转化效率，通过利用功率管组中功率管Q2始终工作在线性区间的自动调节的可变电阻来实现对变化电流的自适应采样功能。以上仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
