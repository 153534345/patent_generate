标题title
一种解决密钥托管问题的白盒可追责属性基加密系统及其方法
摘要abst
本发明公开了一种解决密钥托管问题的白盒可追责属性基加密系统及其方法，包括系统初始化、密钥生成、明文加密、密文解密、密钥完整性验证和密钥追责，通过在用户的密钥中嵌入用户身份相关的秘密信息来支持系统的白盒追责功能，并将现有属性基加密算法中的密钥生成中心分成身份授权机构IA和属性授权机构AA两部分，分别用于嵌入用户身份相关的秘密信息和生成用户属性相关的密钥，同时设计一个两部分之间合作生成用户解密密钥的协议，使得两个机构必须通过合作才能进行用户解密密钥的生成，从而确保任何一个机构都不能独自生成具有完整解密功能的解密密钥，解决了现有属性基加密算法中的密钥生成中心中存在的密钥托管问题。
权利要求书clms
1.一种解决密钥托管问题的白盒可追责属性基加密系统，包括密钥生成模块、数据拥有者D0、数据用户DU和云服务器CSP，其特征在于：所述密钥生成模块包括身份授权机构IA和属性授权机构AA，所述身份授权机构IA用于执行输出用户的身份密钥和中间密钥，所述属性授权机构AA根据中间密钥输出用户属性密钥；所述数据拥护者D0用于执行明文加密算法，输出消息密文，通过云服务器CSP将消息密文传送给数据用户DU；所述数据用户DU用于接收用户的身份密钥和用户属性密钥，并对消息密文进行解密；所述身份授权机构IA还包括初始化的用户列表，在为用户生成解密密钥时，将用户的身份标识和随机值c的对应关系添加到用户列表中；身份授权机构IA根据公共参数、用户的身份密钥和用户属性密钥判断解密密钥是否完整，若完整，则执行追责操作，通过用户列表追责泄露密钥的恶意用户，并输出用户的身份标识。2.一种解决密钥托管问题的白盒可追责属性基加密方法，其特征在于：包括如下步骤：S1，系统初始化：身份授权机构IA根据输入的安全参数1λ执行初始化算法，输出公共参数PKIA和系统私钥SKIA；属性授权机构AA根据输入的安全参数1λ和IA的公共参数PKIA执行初始化算法，输出公共参数PKAA和系统私钥SKAA；所述身份授权机构IA另外初始化建立用户列表S2，用户密钥生成：所述用户密钥包括用户的身份密钥和用户属性密钥，身份授权机构IA根据输入的公共参数PKIA、系统私钥SKIA、数据用户的身份标识id和属性集合S，输出用户的身份密钥UserSKid和中间密钥MidKey，其中用户的身份密钥UserSKid通过安全信道发送给数据用户DU，中间密钥MidKey通过安全信道发送给属性授权机构AA；属性授权机构AA根据输入的公共参数PKIA和PKAA、中间密钥MidKey，输出用户的属性密钥UserSKS，其中用户的属性密钥UserSKS通过安全信道发送给数据用户DU，数据用户DU得到完整的解密密钥UserSKid，S＝；S3，明文加密：由数据拥有者D0执行，输入为公共参数PKIA和PKAA、明文m、访问控制结构，输出消息密文CT；S4，密文解密：由数据用户DU执行，输入为公共参数PKIA和PKAA、密文CT、用户的解密密钥UserSKid，S，输出明文m；S5，密钥完整性验证：身份授权机构IA根据输入的公共参数PKIA和PKAA、用户的解密密钥UserSKid，S判断解密密钥是否通过完整性验证，如果解密密钥UserSKid，S通过了密钥完整性验证，那么输出1，继续步骤S6；否则，输出0，步骤结束；S6，密钥追责：若步骤S5输出为1，则解密密钥UserSKid，S是完整的，执行追责操作并输出恶意用户的身份标识id。3.如权利要求2所述的解决密钥托管问题的白盒可追责属性基加密方法，其特征在于：所述步骤S1中：公共参数PKIA＝β)公开，系统私钥SKIA＝作为身份授权机构IA的私钥秘密保存，其中，双线性群GD＝，大素数p是群G和GT的生成元，e是使得G×G→GT的一个双线性映射，系统的属性域设定为U＝Zp；g，u，h，w，υ是身份授权机构IA从群G中选择的随机参数，是从Zp中随机选择的参数；公共参数PKAA＝eβt公开，系统私钥SKAA由属性授权机构AA秘密保存，其中，t是属性授权机构AA从Zp中随机选择的参数。4.如权利要求3所述的解决密钥托管问题的白盒可追责属性基加密方法，其特征在于：所述步骤S2中：身份授权机构IA为用户从乘法循环群中选择随机数c和z，将用户身份标识id和随机数c的对应关系存入用户列表T中，并将随机数z通过安全信道发送给数据用户DU，用户身份密钥UserSKid＝z：属性授权机构AA从加法循环群Zp中随机选取{r，r1，r2，...rk}k＝|S|，计算出用户的属性密钥UserSKS，通过秘密信道发送给数据用户DU，UserSKS的具体结构如下：5.如权利要求4所述的解决密钥托管问题的白盒可追责属性基加密方法，其特征在于：所述步骤S3中，密文CT的具体结构如下：CT＝＜，C＝m·eβts，C0＝gs，C1＝gαs，其中，是数据拥有者D0确定访问的控制矩阵，M是l行n列的分享策略矩阵，ρ是一个将Mi映射到一个属性ρ∈U的函数，Mi代表分享策略矩阵M的第i行，数据拥有者D0加法循环群Zp中随机选择向量其中s是用于分享的随机秘密，得到分享向量随机指数η1，η2，…，ηl∈Zp。6.如权利要求5所述的解决密钥托管问题的白盒可追责属性基加密方法，其特征在于：所述步骤S4具体包括：S41.如果数据用户DU私钥中对应的属性集合S满足密文中的访问控制策略A，则对秘密值s的分享数据用户DU可以计算出常数{wi∈Zp}i∈，使得∑i∈wiλi＝s；S42.数据用户DU进行以下计算，解密得到明文m：m＝C/Fz。7.如权利要求6所述的解决密钥托管问题的白盒可追责属性基加密方法，其特征在于：所述步骤S5密钥完整性的通过条件为，所述解密密钥UserSKid，S满足下面的要求：获得的泄露密钥UserSKid，S格式符合的形式，且e＝e
说明书desc
技术领域本发明属于密码学技术领域，涉及属性基加密的技术，尤其涉及一种解决密钥托管问题的白盒可追责属性基加密系统及其方法。背景技术随着社会信息化的不断提高，数据的价值日益彰显，如何进行安全且高效的数据共享已经成为人们关注的重点。传统的数据共享方案中，用户将自己的数据存储在云端服务器上进行共享，利用公钥加密技术来保证用户将自己的数据秘密分享给某个指定的用户。虽然利用加密技术可以保护数据的安全性，但是传统的加密机制只能进行一对一加密，即利用一个公钥加密的信息只有通过对应的私钥才能解密，很难实现细粒度的访问控制。基于密文策略的属性加密算法作为基于身份的密码体系的一个扩展，不仅提供了对数据的安全性保障，而且提供了对加密数据的细粒度访问控制机制，非常适合于数据共享背景下的访问控制。在实际利用密文策略属性基加密进行数据共享访问控制的过程中，由于属性基加密密文的解密权限由具有相同属性的多个用户共享，用户的密钥只是和用户属性相关联，不包含任何用户特有的信息，这导致如果发生了解密密钥的泄漏或非法共享，难以从泄漏的解密密钥中去追责到是哪个用户泄漏了该密钥。从这个角度出发，支持白盒可追责特性的属性基加密方案被提出。2014年，Ning等人在《Larger universe ciphertext-policyattribute-based encryption with white-box traceability》中提出了一个大属性域下的白盒可追责属性基加密方案，该方案不仅支持系统的大属性域构造，而且具备白盒可追责的特性。然而，从密钥生成中心的角度看，由于密钥的生成需要用户将自己的属性信息提交给密钥生成中心、由密钥生成中心计算出属性密钥后再返回给用户，这导致密钥生成中心拥有所有用户解密密钥的生成记录，密钥生成中心也可以利用它的主密钥来生成任意属性集合的属性密钥来解密任意密文，即Ning等人的白盒可追责方案中的密钥生成中心存在密钥托管问题。因此，急需对现有的方案进行改进。发明内容本发明正是针对现有属性基加密算法在实际应用中存在的问题，提供一种解决密钥托管问题的白盒可追责属性基加密系统及其方法。算法通过在用户的密钥中嵌入用户身份相关的秘密信息来支持系统的白盒追责功能，并将现有属性基加密算法中的密钥生成中心分成身份授权机构IA和属性授权机构AA两部分，分别用于嵌入用户身份相关的秘密信息和生成用户属性相关的密钥，同时设计一个两部分之间合作生成用户解密密钥的协议，使得两个机构必须通过合作才能进行用户解密密钥的生成，从而确保任何一个机构都不能独自生成具有完整解密功能的解密密钥，解决了现有属性基加密算法中的密钥生成中心中存在的密钥托管问题。为了实现上述目的，本发明采取的技术方案是：一种解决密钥托管问题的白盒可追责属性基加密系统，包括密钥生成模块、数据拥有者DO、数据用户DU和云服务器CSP,所述密钥生成模块包括身份授权机构IA和属性授权机构AA，所述身份授权机构IA用于执行输出用户的身份密钥和中间密钥，所述属性授权机构AA根据中间密钥输出用户属性密钥；所述数据拥护者DO用于执行明文加密算法，输出消息密文，通过云服务器CSP将消息密文传送给数据用户DU；所述数据用户DU用于接收用户的身份密钥和用户属性密钥，并对消息密文进行解密；所述身份授权机构IA还包括初始化的用户列表，在为用户生成解密密钥时，将用户的身份标识和随机值c的对应关系添加到用户列表中，身份授权机构IA根据公共参数、用户的身份密钥和用户属性密钥判断解密密钥是否完整，若完整，则执行追责操作，通过用户列表追责泄露密钥的恶意用户，并输出用户的身份标识。为了实现上述目的，本发明还采取的技术方案是：一种解决密钥托管问题的白盒可追责属性基加密方法，包括如下步骤：S1，系统初始化：身份授权机构IA根据输入的安全参数1λ执行初始化算法，输出公共参数PKIA和系统私钥SKIA；属性授权机构AA根据输入的安全参数1λ和IA的公共参数PKIA执行初始化算法，输出公共参数PKAA和系统私钥SKAA；所述身份授权机构IA另外初始化建立用户列表S2，用户密钥生成：所述用户密钥包括用户的身份密钥和用户属性密钥，身份授权机构IA根据输入的公共参数PKIA、系统私钥SKIA、数据用户的身份标识id和属性集合S，输出用户的身份密钥UserSKid和中间密钥MidKey，其中用户的身份密钥UserSKid通过安全信道发送给数据用户DU，中间密钥MidKey通过安全信道发送给属性授权机构AA；属性授权机构AA根据输入的公共参数PKIA和PKAA、中间密钥MinKey，输出用户的属性密钥UserSKs，其中用户的属性密钥UserSKs通过安全信道发送给数据用户DU，数据用户DU得到完整的解密密钥UserSKid，S＝；S3，明文加密：由数据拥有者DO执行，输入为公共参数PKIA和PKAA、明文m、访问控制结构，输出消息密文CT；S4，密文解密：由数据用户DU执行，输入为公共参数PKIA和PKAA、密文CT、用户的解密密钥UserSKid，S，输出明文m；S5，密钥完整性验证：身份授权机构IA根据输入的公共参数PKIA和PKAA、用户的解密密钥UserSKid，S判断解密密钥是否通过完整性验证，如果解密密钥UserSKid，S通过了密钥完整性验证，那么输出1，继续步骤S6；否则，输出0，步骤结束；S6，密钥追责：若步骤S5输出为1，则解密密钥UserSKid，S是完整的，执行追责操作并输出恶意用户的身份标识id。作为本发明的一种改进，所述步骤S1中，公共参数PKIA＝β)公开，系统私钥SKIA＝作为身份授权机构IA的私钥秘密保存，其中，双线性群GD＝，大素数p是群G和GT的生成元，e是使得G×G→GT的一个双线性映射，系统的属性域设定为U＝Zp；g，u，h，w，v是身份授权机构IA从群G中选择的随机参数，是从Zp中随机选择的参数；公共参数PKAA＝eβt公开，系统私钥SKAA由属性授权机构AA秘密保存，其中，t是属性授权机构AA从Zp中随机选择的参数。作为本发明的一种改进，所述步骤S2中，身份授权机构IA为用户从乘法循环群中选择随机数c和z，将用户身份标识id和随机数c的对应关系存入用户列表T中，并将随机数z通过安全信道发送给数据用户DU，用户身份密钥UserSKid＝z：属性授权机构AA从加法循环群Zp中随机选取{r，r1，r2，...rk}k＝|S|，计算出用户的属性密钥UserSKS，通过秘密信道发送给数据用户DU，UserSKS的具体结构如下：作为本发明的另一种改进，所述步骤S3中，密文CT的具体结构如下：CT＝＜，C＝m·eβts，C0＝gs，C1＝gαs，其中，是数据拥有者DO确定访问的控制矩阵，M是l行n列的分享策略矩阵，ρ是一个将Mi映射到一个属性ρ∈U的函数，Mi代表分享策略矩阵M的第i行，数据拥有者DO加法循环群Zp中随机选择向量其中是用于分享的随机秘密，得到分享向量随机指数η1，η2，...，ηl∈Zp。作为本发明的又一种改进，所述步骤S4包括：S41.如果数据用户DU私钥中对应的属性集合S满足密文中的访问控制策略A，则对秘密值s的分享数据用户DU可以计算出常数{wi∈Zp}i∈，使得∑i∈ωiλi＝s；S42.数据用户DU进行以下计算，解密得到明文m:m＝C/Fz 。作为本案更进一步的改进，所述步骤S5密钥完整性的通过条件为，解密密钥UserSKid，S满足下面的要求：获得的泄露密钥UserSKid，S格式符合的形式，且K，L，L′，Kτ，2∈G；e＝e；与现有技术相比：本发明改进了现有属性基加密算法，系统支持大属性域构造的同时，通过在用户的密钥中嵌入用户身份相关的秘密信息来支持系统的白盒追责功能，这使得用户在非法泄露自己的私钥后，可以通过泄露的解密密钥去追责到是哪个用户泄露了该密钥；同时算法将现有属性基加密算法中的密钥生成中心分成身份授权机构IA和属性授权机构AA两部分，分别用于嵌入用户身份相关的秘密信息和生成用户属性相关的密钥，同时设计一个两部分之间合作生成用户解密密钥的协议，使得两个机构必须通过合作才能进行用户解密密钥的生成，确保任何一个机构都不能独自解密密文，同时也无法独自生成具有完整解密功能的解密密钥，解决了密钥托管的问题，使系统同时具备属性空间可以动态扩展、解密密钥白盒可追责、解决密钥生成中心的密钥托管问题多个特性。附图说明图1是本发明所涉及解决密钥托管问题的白盒可追责属性基加密方法的系统架构图；图2是本发明所涉及解决密钥托管问题的白盒可追责属性基加密方法的时序图。具体实施方式下面结合附图和具体实施方式，进一步阐明本发明，应理解下述具体实施方式仅用于说明本发明而不用于限制本发明的范围。实施例1一种解决密钥托管问题的白盒可追责属性基加密系统，包括密钥生成模块、数据拥有者DO、数据用户DU和云服务器CSP,如图1所示，密钥生成模块包括身份授权机构IA和属性授权机构AA，所述身份授权机构IA用于执行输出用户的身份密钥和中间密钥，所述属性授权机构AA根据中间密钥输出用户属性密钥；所述数据拥护者DO用于执行明文加密算法，输出消息密文，通过云服务器CSP将消息密文传送给数据用户DU；所述数据用户DU用于接收用户的身份密钥和用户属性密钥，并对消息密文进行解密；所述身份授权机构IA还包括初始化的用户列表，在为用户生成解密密钥时，将用户的身份标识和随机值c的对应关系添加到用户列表中。身份授权机构IA根据公共参数、用户的身份密钥和用户属性密钥判断解密密钥是否完整，若完整，则执行追责操作，通过用户列表追责泄露密钥的恶意用户，并输出用户的身份标识。本系统通过引入多个机构合作生成用户的解密密钥，并将现有属性基加密算法中的密钥生成中心功能进行划分，实现解决密钥托管问题的白盒可追责属性基加密方案。通过在用户的密钥中嵌入用户身份相关的秘密信息来支持系统的白盒追责功能；并将现有属性基加密算法中的密钥生成中心分成身份授权机构IA和属性授权机构AA两部分，分别用于嵌入用户身份相关的秘密信息和生成用户属性相关的密钥，同时设计一个两部分之间合作生成用户解密密钥的协议，使得两个机构必须通过合作才能进行用户解密密钥的生成，确保任何一个机构都不能独自解密密文，解决了现有属性基加密算法中密钥生成中心存在的密钥托管问题。实施例2一种解决密钥托管问题的白盒可追责属性基加密方法，共涉及六个阶段的算法：系统初始化算法、密钥生成算法、明文加密算法、密文解密算法、密钥完整性验证算法、密钥追责算法，如图2所示，具体包括如下步骤：S1，系统初始化IA.Setup→和AA.Setup→：身份授权机构IA根据输入的安全参数1λ执行初始化算法，输出公共参数PKIA和系统私钥SKIA，其中PKIA公开，SKIA由身份授权机构IA秘密保存；属性授权机构AA根据输入的安全参数1λ和IA的公共参数PKIA执行初始化算法，输出公共参数PKAA和系统私钥SKAA，其中PKAA公开，SKAA由属性授权机构AA秘密保存；所述身份授权机构IA另外初始化建立用户列表用于后续的白盒追责；所述步骤的算法，进一步包括：S11.身份授权机构IA选择双线性群GD＝，大素数p是群G和GT的生成元，e是使得G×G→GT的一个双线性映射，系统的属性域设定为U＝Zp；S12.身份授权机构IA从群G中选择随机参数g，u，h，w，v，从Zp中随机选择参数，并且初始化一个用户列表S13.身份授权机构IA将系统参数PKIA＝β)公开，SKIA＝作为身份授权机构IA的私钥秘密保存；S14.属性授权机构AA从Zp中随机选择参数t，计算eβt；S15.属性授权机构AA将系统参数PKAA＝eβt公开，SKAA＝t作为属性授权机构AA的私钥秘密保存；S2，用户密钥生成IA.KeyGen→：所述用户密钥包括用户的身份密钥和用户属性密钥，身份授权机构IA根据输入的公共参数PKIA、系统私钥SKIA、数据用户的身份标识id和属性集合S，输出用户的身份密钥UserSKid和中间密钥MidKey，其中用户的身份密钥UserSKid通过安全信道发送给数据用户DU，中间密钥MidKey通过安全信道发送给属性授权机构AA；属性授权机构AA根据输入的公共参数PKIA和PKAA、中间密钥MidKey，输出用户的属性密钥UserSKS，其中用户的属性密钥UserSKS通过安全信道发送给数据用户DU，数据用户DU得到完整的解密密钥UserSKid，S＝；所属步骤的算法进一步包括：S21.每个数据用户DU在加入数据共享平台时，需要在系统中注册自己的身份，认证自己的身份标识id以及属性集合S，数据用户DU向身份授权机构IA发送自己的身份标识id以及属性集合S，请求生成用户私钥；S22.身份授权机构IA为该用户从乘法循环群中选择随机数c和z，将用户身份标识id和随机数c的对应关系存入身份列表T中，并将随机数z通过安全信道发送给用户作为用户关于用户身份的第一部分解密密钥UserSKid＝z；S23.身份授权机构IA分别计算g1/z，gβ/z，gα/z，w1/z，gβ，并且为用户属性集合S中的每一个属性Ai计算1/z，形成中间密钥MidKey＝{g1/z，gβ/z，gα/z，ω1/z，gβ，1/z，c，S}通过安全信道发送给属性授权机构AA；S24.属性授权机构AA从加法循环群Zp中随机选取{r，r1，r2，...rk}k＝|S|,为用户计算出关于用户属性的第二部分解密密钥UserSKS，通过秘密信道发送给用户，UserSKS的具体结构如下：S25.数据用户DU获取完整的密钥UserSKid，S＝；S3，明文加密Encry)→CT：由数据拥有者DO执行，输入为公共参数PKIA和PKAA、明文m、访问控制结构，输出消息密文CT；所述步骤进一步包括：S31.数据拥有者DO确定访问控制矩阵，M是l行n列的分享策略矩阵，ρ是一个将Mi映射到一个属性ρ∈U的函数，Mi代表分享策略矩阵M的第i行。数据拥有者DO从加法循环群Zp中随机选择向量其中是用于分享的随机秘密；S32.数据拥有者DO计算得到分享向量S33.数据拥有者DO随机选择l个随机指数η1，η2，...，ηl∈Zp，计算出最终的密文CT通过安全信道发送给云服务器。密文CT的具体结构如下：S4，密文解密Decrypt→m：由数据用户DU执行，输入为公共参数PKIA和PKAA、密文CT、用户的解密密钥UserSKid，S，输出明文m；所述明文m的计算方法为：S41.如果数据用户DU私钥中对应的属性集合S满足密文中的访问控制策略A，则对秘密值s的分享数据用户DU可以计算出常数{wi∈Zp}i∈，使得∑i∈wiλi＝s；S42.数据用户DU进行以下计算，解密得到明文m:m＝C/Fz；S5，密钥完整性验证KeySanityCheck→1or 0：身份授权机构IA根据输入的公共参数PKIA和PKAA、用户的解密密钥UserSKid，S判断解密密钥是否通过完整性验证，如果解密密钥UserSKid，S通过了密钥完整性验证，那么输出1，继续步骤S6；否则，输出0，步骤结束；所述解密密钥UserSKid，S若满足下面的要求：获得的泄露密钥UserSKid，S格式符合的形式，且K，L，L′，Kτ，2∈G。e＝e则表示该密钥通过密钥完整性验证，可以用于解密和用户追责，算法输出结果为1；否则表示该密钥不符合解密密钥的格式，验证算法输出结果为0；S6，密钥追责Trace→id or⊥：若步骤S5输出为1，则解密密钥UserSKid，S是完整的，执行追责操作并输出恶意用户的身份标识id，所述步骤进一步包括：S61.如果需要进行追责的密钥通过了密钥健全性验证算法，身份授权机构IA通过泄露密钥UserSkid，S中包含的K′＝c，在身份列表T中查找对应用户身份id；S62.如果身份授权机构IA可以在追责列表中查找到随机值c对应的id，则表明追责到泄密的用户身份为id；否则输出错误符号⊥。以上，本案的方法通过在用户的密钥中嵌入用户身份相关的秘密信息来支持系统的白盒追责功能，并将现有属性基加密算法中的密钥生成中心分成身份授权机构IA和属性授权机构AA两部分，分别用于嵌入用户身份相关的秘密信息和生成用户属性相关的密钥，同时设计一个两部分之间合作生成用户解密密钥的协议，使得两个机构必须通过合作才能进行用户解密密钥的生成，从而确保任何一个机构都不能独自生成具有完整解密功能的解密密钥，解决了现有属性基加密算法中的密钥生成中心中存在的密钥托管问题，使系统同时具备属性空间可以动态扩展、解密密钥白盒可追责、解决密钥生成中心的密钥托管问题多个特性。需要说明的是，以上内容仅仅说明了本发明的技术思想，不能以此限定本发明的保护范围，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干改进和润饰，这些改进和润饰均落入本发明权利要求书的保护范围之内。
