标题title
无线自组织网络多控制器通信方法
摘要abst
本发明公开的一种无线自组织网络多控制器通信方法，网络整体架构清晰，控制节点功能明确，通道带宽开销可控，能够有效提升无线信道利用率。本发明通过下述技术步骤实现：步骤1，基于服务器/客户端架构，搭建控制器东西向通道，建立控制器间TCP连接；步骤2，根据所述连接确定网络视图同步模式，各控制器基于与服务器连接的无线链路质量确定视图同步模式；步骤3，根据所述网络视图同步模式，各控制器将子域视图信息异步上报至服务器；步骤4，根据所述上报的子域视图信息，服务器整合并存储全局视图信息，当有跨域通信需求时，采用暖备份方式，服务器将所述全局信息下发至源节点所属控制器，由控制器完成跨域路径计算；提高网络鲁棒性。
权利要求书clms
1.一种无线自组织网络多控制器通信方法，其特征在于，包括如下步骤：步骤1，基于服务器/客户端架构，在软件定义无线自组织网络中，软件定义无线自组织网络系统面向软件定义无线自组织网络，搭建异构多控制器协同通信的东西向通道，所有SDN控制器作为客户端，主动与服务器建立连接；步骤2，根据网络视图抽象机制，基于各SDN控制器与服务器连接的无线链路质量信息，将视图同步模式分为粗颗粒度模式和细颗粒度模式，各SDN控制器基于感知的无线信道链路质量与设定阈值比较，对链路质量大于阈值，选择细颗粒度模式，SDN控制器将完整局部视图信息上报至服务器，对链路质量小于阈值，则选择粗颗粒度模式，仅上报抽象过后的视图信息；步骤3，根据所述网络视图同步模式，各控制器将子域视图信息异步上报至服务器，服务器整合并存储全局网络视图信息，当有跨域通信需求时，SDN控制器向服务器请求全局网络视图信息，然后计算全局最优跨域路径；步骤4，主服务器周期性将全局视图信息复制至备服务器中，若主服务器故障，控制器可以平滑切换至备服务器，备服务器直接使用备份数据，恢复业务运行，保障无线网络运行稳定。2.根据权利要求1所述的无线自组织网络多控制器通信方法，其特征在于，无线自组织网络建立异构控制器之间的东西向通道，基于服务器/客户端架构，服务器通过连接多个客户端从而实现多个控制器之间的协同通信，各控制器根据服务器IP地址、端口号，主动发起与服务器的无线TCP连接。3.根据权利要求2所述的无线自组织网络多控制器通信方法，其特征在于，东西向通道建立后，服务器和控制器协商网络视图同步模式，各SDN控制器基于感知的无线信道链路质量，与设定链路阈值进行比较，当所有链路质量均大于阈值时，选择细颗粒度模式，若存在部分链路质量低于阈值，则选择粗颗粒度模式。4.根据权利要求3所述的无线自组织网络多控制器通信方法，其特征在于，各SDN控制器根据上述协商的视图同步模式，将局部视图信息上传至服务器，当视图同步模式为细颗粒度时，各SDN控制器上传子域内所有节点拓扑连接关系、链路质量的详细信息，当同步模式为粗颗粒度时，SDN控制器将局部视图信息进行抽象，仅上传边界节点信息，服务器根据上报的局部视图信息，生成全局视图信息。5.根据权利要求1所述的无线自组织网络多控制器通信方法，其特征在于，软件定义无线自组织网络系统包括：主服务器、备服务器、作为中间层的N个SDN控制器，以及与每个SDN控制器相连的底层交换节点，中间层SDN控制器往上连接主服务器，将收集的状态信息发送至主服务器，协助主服务器端生成全局视图信息，完成全局网络视图信息汇总收集，并备份至备服务器中，往下连接底层数据转发节点，收集各节点设备状态信息，并通过东西向通道将路径信息广播至其他控制节点，完成流表下发到各转发节点，指导其数据转发。6.根据权利要求1所述的无线自组织网络多控制器通信方法，其特征在于，各SDN控制器基于感知的无线信道链路质量的网络视图同步模式，SDN控制器客户端针对不同的无线网络环境，向服务器上报网络视图支持粗颗粒度和细颗粒度两种模式；当无线信道质量较差时，采用一种网络视图抽象方法，此时各控制器仅上报各SDN子域边界节点信息，不进行域内节点信息同步，以节省带宽，减少跨域路径计算复杂度，当无线信道质量较优时，各控制器将各SDN子域内所有节点状态及拓扑信息上报至服务器进行同步，基于完整的网络拓扑信息，可实现最佳的跨域路径计算结果。7.根据权利要求1所述的无线自组织网络多控制器通信方法，其特征在于，采用暖备份方式，设计主、备服务器同时工作机制，将备服务器配置为与所述主服务器相同的系统和运行环境，定期从主服务器备份业务数据，一旦主服务器故障，控制器客户端平滑切换至备服务器，备服务器则直接使用备份数据，恢复业务运行。8.根据权利要求1所述的无线自组织网络多控制器通信方法，其特征在于，服务器启动后随时监听来自SDN控制器的请求，当SDN控制器1、SDN控制器2、SDN控制器3连接到服务器时，服务器分出相应的客户端线程1、客户端线程2、客户端线程3来建立SDN控制器1、SDN控制器2、SDN控制器3对应连接，然后再启动用于服务器和SDN控制器间通信的服务器主线程，当SDN控制器上传网络视图信息时，负责连接SDN控制器的主线程会把数据存储在全局网络视图库中。9.根据权利要求1所述的无线自组织网络多控制器通信方法，其特征在于，服务器采用心跳机制来甄别控制器是否在线，与SDN控制器建立连接，各SDN控制器客户端主动以默认周期2000ms向服务器发送心跳信息，服务器接收来自各SDN控制的心跳消息，并记录时间戳，甄别控制器是否在线，若服务器超过10个心跳周期未收到来自某控制器的新心跳信息，则会结束与该客户端的会话，断开与该客户端的连接，结束与其的对话，并将该客户端判断为失效，删除该客户端保存在服务端的相关信息，并告知其他控制器该控制器失效的信息，否则返回收来SDN控制的心跳消息，重新甄别控制器是否在线。10.根据权利要求1所述的无线自组织网络多控制器通信方法，其特征在于，当有数据传输需求时，无线自组织网络根据转发节点收到的数据包，首先判断此时是否有可匹配的流表项，是则各转发节点按照流表动作项内容进行匹配转发，结束程序，如果没有可匹配的流表项，则将该数据流的第一个数据包以Packet-in消息封装方式上报至所属控制器节点，控制器节点接收到来自转发节点的Packet-in消息后，解析该数据包的源节点地址和目的节点地址，判断该数据包目的地址是否在本子域网络内，如果目的节点在子域内，则属于域内数据转发，控制器直接根据收集的局部拓扑信息，计算出从源节点到目的节点的最优路径，然后下发流表项，完成沿路所有转发节点流表项安装，各转发平台依据新安装的流表内容指导数据包转发；如果目的节点不在本子域内，则属于跨域数据转发，此时该控制器需要向服务器请求全局拓扑信息，控制器判断此时请求得到的全局拓扑是否是细颗粒度模式，是则直接根据全局拓扑信息计算出一条从源节点到目的节点的完整跨域路径，然后下发路径上属于本子网络的转发平台流表项，再通过东西向服务器通道将路径信息广播至沿路其他控制器，向沿路控制器请求协作下发其他子域内转发节点流表项；如果不是细颗粒度模式，控制器根据服务器提供的全局拓扑信息，计算出从源节点到目的节点的抽象跨域路径，将路径结果通过东西向服务器通道发送至沿路其他控制器，请求协作计算各子域域内路径，并下发最新的流表项，完成转发节点流表项安装；各转发节点完成所有流表项安装后，各转发节点按照最新流表动作项内容进行匹配完成数据包转发。
说明书desc
技术领域本发明属于软件定义无线自组织网络技术领域，尤其涉及一种软件定义无线自组织网络多控制器之间东西向通信方法。背景技术当前,软件定义网络成为计算机网络中一个热门的研究领域。软件定义网络架构通过抽象网络设备的控制功能，将网络中的控制功能集中到控制器中，网络设备变成简单的数据包的转发设备，从而实现了网络中数据平面和控制平面的分离。最初软件定义网络提出的架构非常简单，目的仅是让科研人员能够快速地进行SDN实验，整个网络由单个控制器和若干交换设备组成。所有交换设备都向控制器发送各自状态信息，由控制器形成全局网络视图信息。随着网络规模的扩大，控制流量增多，控制器处理能力有限，容易导致网络收敛速度变慢。因此，在大规模的SDN网络中单一的控制器很难满足需求，需要部署多个控制器进行协同管理，由此引发多控制器间的通信需求。目前关于SDN网络多控制器间通信研究主要包括垂直式和水平式两种架构。垂直式架构是在多个控制器之上再叠加一层超级控制器，此时普通控制器和超级控制器形成父子拓扑关系，普通控制器只负责各自子域网络管理，收集子域内转发设备状态信息，形成局部网络视图，普通控制器将局部视图统一汇总至超级控制器，超级控制器完成全局视图信息收集、存储。典型案例有Kandoo、Orion、OpeneXchange等。垂直式架构获取全局视图信息流程简单、架构清晰，各普通控制器仅需要将各自局部视图发送至超级控制器汇总。当数据平面跨域通信时，普通控制器仅有局部信息，无法计算出合适路径，需要向超级控制器发起协助，超级控制器根据全局视图信息计算出跨域路径，再经各普通控制器下发至请求设备，控制路径时延较大。水平式架构中所有控制器没有级别之分，各控制器之间分布式交互各自局部视图信息，通过相互迭代的过程，形成全局网络视图信息。典型方案有HyperFlow、ONOS、West-EastBridge等。可以看出，水平式架构通过各控制器分布式同步机制，通过相互迭代、更新的过程形成全局视图信息，当跨域路径请求时，各控制器均有全局视图信息，无需其他控制器协助即可完成跨域路径的计算，跨域路径计算流程简单，但是分布式同步必然会出现全局视图一致性问题，且相互交互视图信息过程繁琐。此外，上述东西向方案均是各控制器厂商从各自需求出发，针对的仅是各自面临的场景，缺乏统一的标准。上述方案都是面向有线网络场景设计，针对无线网络带宽受限、拓扑高动态等特征没有考虑。因此，现有SDN东西向解决方案在软件定义无线网络场景中存在较多不足。发明内容本发明针对以上问题，以及现有SDN东西向解决方案在软件定义无线网络场景中存在较多的不足之处，提供一种网络整体架构清晰，控制节点功能明确，通道带宽开销可控，能够有效提升无线信道利用率，最小信道带宽能够实现全局网络视图信息同步，同时具备故障自愈能力的软件定义无线自组织网络多控制器间东西向通信的方法。为解决上述技术问题，本发明提供一种无线自组织网络多控制器通信方法，其特征在于，包括如下步骤：步骤1，基于服务器/客户端架构，软件定义无线自组织网络系统面向软件定义无线自组织网络，在软件定义无线自组织网络中，搭建异构多控制器协同通信的东西向通道，所有SDN控制器作为客户端，主动与服务器建立连接；步骤2，根据网络视图抽象机制，基于各SDN控制器与服务器连接的无线链路质量信息，将视图同步模式分为粗颗粒度模式和细颗粒度模式，各SDN控制器基于感知的无线信道链路质量与设定阈值比较，对链路质量大于阈值，选择细颗粒度模式，SDN控制器将完整局部视图信息上报至服务器，对链路质量小于阈值，则选择粗颗粒度模式，仅上报抽象过后的视图信息；步骤3，根据所述网络视图同步模式，各控制器将子域视图信息异步上报至服务器，服务器整合并存储全局网络视图信息，当有跨域通信需求时，SDN控制器向服务器请求全局网络视图信息，然后计算全局最优跨域路径；步骤4，主服务器周期性将全局视图信息复制至备服务器中，若主服务器故障，控制器可以平滑切换至备服务器，备服务器直接使用备份数据，恢复业务运行，保障无线网络运行稳定。本发明具有如下有益效果。本发明针对软件定义无线自组织网络场景下，面向软件定义无线自组织网络，基于服务器/客户端架构，软件定义无线自组织网络系统面向软件定义无线自组织网络，在软件定义无线自组织网络中，搭建异构多控制器协同通信的东西向通道，所有SDN控制器作为客户端，主动与服务器建立连接；可以应用于无人机蜂群网络、航空自组网、移动车联网领域，提供一种简单的多控制器之间通信模式，可以实现多个SDN控制器之间高效的全局网络视图同步，同时还可作为控制器之间其他控制消息的传递通道，提供控制器间消息的单播、组播及广播模式。本发明根据网络视图抽象机制，基于各SDN控制器与服务器连接的无线链路质量信息，将视图同步模式分为粗颗粒度模式和细颗粒度模式，采用服务器/客户端架构，以多个SDN控制器之间通信的东西向通信，将所有SDN控制器作为客户端，处于同一层次，控制器之间是等价同等角色，负责所辖SDN子域网络的管理，无须在控制器间进行繁琐的视图信息交互；服务器仅参与全局视图数据的存储、同步，不进行任何网络管理过程。网络整体架构清晰，控制节点功能明确，即能够让控制器专注网络管理，又能避免分层式结构中根控制节点易拥塞的瓶颈问题。本发明结合无线信道实时链路质量指示情况，设计网络抽象机制，将视图同步模式分为粗颗粒度和细颗粒度模式，当网络环境较优时，采用细颗粒度模式，将完整网络视图信息上报至服务器，当网络环境恶劣时，采用粗颗粒度模式，仅上报抽象过后的视图信息。从而实现基于无线信道质量感知的网络视图同步方式，实现控制通道带宽开销可控，有效提升无线信道利用率，提高网络性能。另外，本发明采用暖备份机制，一旦主服务器故障，各控制器可以平滑切换至备服务器，恢复业务运行，提升系统鲁棒性。附图说明图1是软件定义无线自组织网络系统组成图；图2是无线自组织网络多控制通信运行流程图；图3是服务器线程连接示意图；图4是控制器失效心跳机制流程图；图5是跨域数据转发运行流程图。为使本发明要解决的技术问题、技术方案和要点更加清楚，下面将结合附图及具体实施例对本发明进一步说明，应当理解，所描述的实施例仅是本发明的一部分实施例，而不是全部的实施例。具体实施方式参阅图1。根据本发明，采用如下步骤：步骤1，基于服务器/客户端架构，在软件定义无线自组织网络中，软件定义无线自组织网络系统面向软件定义无线自组织网络，搭建异构多控制器协同通信的东西向通道，所有SDN控制器作为客户端，主动与服务器建立连接；步骤2，根据网络视图抽象机制，基于各SDN控制器与服务器连接的无线链路质量信息，将视图同步模式分为粗颗粒度模式和细颗粒度模式，各SDN控制器基于感知的无线信道链路质量与设定阈值比较，对链路质量大于阈值，选择细颗粒度模式，SDN控制器将完整局部视图信息上报至服务器，对链路质量小于阈值，则选择粗颗粒度模式，仅上报抽象过后的视图信息；步骤3，根据所述网络视图同步模式，各控制器将子域视图信息异步上报至服务器，服务器整合并存储全局网络视图信息，当有跨域通信需求时，SDN控制器向服务器请求全局网络视图信息，然后计算全局最优跨域路径；步骤4，主服务器周期性将全局视图信息复制至备服务器中，若主服务器故障，控制器可以平滑切换至备服务器，备服务器直接使用备份数据，恢复业务运行，保障无线网络运行稳定。在可选实施例中，包括如下步骤：步骤S101，无线自组织网络建立异构控制器之间的东西向通道，基于服务器/客户端架构，服务器通过连接多个客户端从而实现多个控制器之间的协同通信，各控制器根据服务器IP地址、端口号，主动发起与服务器的无线TCP连接；步骤S102，东西向通道建立后，服务器和控制器协商网络视图同步模式。各SDN控制器基于感知的无线信道链路质量，与设定链路阈值进行比较，当所有链路质量均大于阈值时，选择细颗粒度模式，若存在部分链路质量低于阈值，则选择粗颗粒度模式；步骤S103，各SDN控制器根据上述协商的视图同步模式，将局部视图信息上传至服务器，当视图同步模式为细颗粒度时，各SDN控制器上传子域内所有节点拓扑连接关系、链路质量的详细信息，当同步模式为粗颗粒度时，SDN控制器将局部视图信息进行抽象，仅上传边界节点信息，服务器根据上报的局部视图信息，生成全局视图信息；步骤S104，跨域节点通信时，由源节点所属SDN控制器向服务器请求全局视图信息。当全局视图为细颗粒度模式时，源节点所属SDN控制器根据全局视图信息，直接完成完整跨域路径计算，然后将计算结果通过所述东西向通道广播至路径上的其它节点所属SDN控制器，从而保证跨域流表下发的一致性；当全局视图为粗颗粒度模式时，源节点所属SDN控制器根据全局视图信息计算抽象跨域路径，然后将计算结果通过东西向通道广播至沿路其他SDN控制器，沿路各SDN控制器完成各自域内路径计算；参阅图2。在可选实施例中，软件定义无线自组织网络系统包括主服务器、备服务器、作为中间层的N个SDN控制器以及与每个SDN控制器相连的底层交换节点，作为中间层SDN控制器往上连接主服务器，将收集的状态信息发送至主服务器，协助主服务器端生成全局视图信息，完成全局网络视图信息汇总收集，并备份至备服务器中，往下连接底层数据转发节点，收集各节点设备状态信息，并通过东西向通道将路径信息广播至其他控制节点，完成流表下发到各转发节点，指导其数据转发。各SDN控制器基于感知的无线信道链路质量的网络视图同步模式，SDN控制器客户端针对不同的无线网络环境，向服务器上报网络视图支持粗颗粒度和细颗粒度两种模式；当无线信道质量较差时，采用一种网络视图抽象方法，此时各控制器仅上报各SDN子域边界节点信息，不进行域内节点信息同步，以节省带宽，减少跨域路径计算复杂度，当无线信道质量较优时，各控制器将各SDN子域内所有节点状态及拓扑信息上报至服务器进行同步，基于完整的网络拓扑信息，可实现最佳的跨域路径计算结果。抽象方法也可以称为纯虚函数，是面向对象编程技术的一个核心概念，抽象方法的语法很简单：在声明一个虚方法的基础上，在原型的末尾加上“＝0”，告诉编译器不用浪费时间在这个类里寻找这个方法的实现。当类里面有虚函数的时候，编译器会给类添加一个虚函数表，里边存放着虚函数指针。为了节省资源，只有当一个类被用来作为基类的时候，才把析构函数写成虚函数。在可选的实施例中，采用暖备份方式，设计主、备服务器同时工作机制，将备服务器配置为与所述主服务器相同的系统和运行环境，定期从主服务器备份业务数据，一旦主服务器故障，控制器客户端平滑切换至备服务器，备服务器则直接使用备份数据，恢复业务运行。暖备份也称热备份，是在数据库运行的情况下，采用archivelogmode方式备份数据库的方法。即热备份是系统处于正常运转状态下的备份。所以，如果有一个冷备份而且又有热备份文件，在发生问题时，就可以利用这些资料恢复更多的信息。热备份要求数据库在Archivelog方式下操作，并需要大量的档案空间。一旦数据库运行在archivelog状态下，就可以做备份了。冷备份，也被称为离线备份，是指在关闭数据库并且数据库不能更新的状况下进行的数据库完整备份。并可对数据进行指定恢复。冷备份发生在数据库已经正常关闭的情况下，当正常关闭时会提供给我们一个完整的数据库。冷备份是将关键性文件拷贝到另外的位置的一种说法。对于备份Oracle信息而言，冷备份是最快和最安全的方法。参阅图3。服务器启动后随时监听来自SDN控制器的请求，当SDN控制器1、SDN控制器2、SDN控制器3连接到服务器时，服务器会分出相应的客户端线程1、客户端线程2、客户端线程3来建立SDN控制器1、SDN控制器2、SDN控制器3对应连接，然后再启动用于服务器和SDN控制器间通信的服务器主线程，当SDN控制器上传网络视图信息时，负责连接SDN控制器的主线程会把数据存储在全局网络视图库中。服务器仅参与SDN控制器之间消息转发和全局视图信息的存储，不提供路径计算、流量管理等网络管理功能。作为客户端的SDN控制器，需要在启动后连接到服务器，完成与服务器的消息接收和发送。另外还需要发现其他SDN控制器，考虑到无线信道带宽受限约束，本发明采用一种开销较小的集中式发现方式，当控制器启动的时候，就会主动去服务器注册本控制器的基本信息，同时询问其他注册器的信息，以这种方式来寻找到其他控制器。每个控制器都有一个配置文件，该配置文件存储控制器相关的参数，主要有：控制器支持的OpenFlow版本号、控制器客户端ID、该控制器所管辖的交换设备列表。参阅图4。服务器采用心跳机制来甄别控制器是否在线，与SDN控制器建立连接，各SDN控制器客户端主动以默认周期2000ms向服务器发送心跳信息，服务器接收来自各SDN控制的心跳消息，并记录时间戳，甄别控制器是否在线，若服务器超过10个心跳周期未收到来自某控制器的新心跳信息，则会结束与该客户端的会话，断开与该客户端的连接，结束与其的对话，并将该客户端判断为失效，删除该客户端保存在服务端的相关信息，并告知其他控制器该控制器失效的信息，否则返回收来SDN控制的心跳消息，重新甄别控制器是否在线。本发明不仅可以完成多控制器全局网络视图信息的同步，还可作为控制器间其他东西向消息传递的通道，可实现控制器间消息的单播、组播及广播。按照传输方向的不同，东西向消息分为上行消息和下行消息。上行消息是从控制器发往服务器，消息字段包括消息目的、消息长度、消息类型、消息载荷字段，消息目的分为服务器、所有控制器以及指定控制器三种类型。下行消息是服务器发至控制器，仅有单播模式，消息字段包括消息长度、消息类型、消息载荷字段。参阅图5。当有数据传输需求时，无线自组织网络根据转发节点收到的数据包，首先判断此时是否有可匹配的流表项，是则各转发节点按照流表动作项内容进行匹配转发，结束程序，如果没有可匹配的流表项，则将该数据流的第一个数据包以Packet-in消息封装方式上报至所属控制器节点，控制器节点接收到来自转发节点的Packet-in消息后，解析该数据包的源节点地址和目的节点地址，判断该数据包目的地址是否在本子域网络内，如果目的节点在子域内，则属于域内数据转发，控制器直接根据收集的局部拓扑信息，就可以计算出从源节点到目的节点的最优路径，然后下发流表项，完成沿路所有转发节点流表项安装，各转发平台依据新安装的流表内容指导数据包转发。如果目的节点不在本子域内，则属于跨域数据转发，此时该控制器需要向服务器请求全局拓扑信息，控制器判断此时请求得到的全局拓扑是否是细颗粒度模式，是则直接根据全局拓扑信息计算出一条从源节点到目的节点的完整跨域路径，然后下发路径上属于本子网络的转发平台流表项，再通过东西向服务器通道将路径信息广播至沿路其他控制器，向沿路控制器请求协作下发其他子域内转发节点流表项；如果不是细颗粒度模式，控制器根据服务器提供的全局拓扑信息，计算出从源节点到目的节点的抽象跨域路径，将路径结果通过东西向服务器通道发送至沿路其他控制器，请求协作计算各子域域内路径，并下发最新的流表项，完成转发节点流表项安装。各转发节点完成所有流表项安装后，各转发节点按照最新流表动作项内容进行匹配完成数据包转发。以上所述仅为本发明的较佳实施例，对本发明而言仅仅是说明性的，而非限制性的。本专业技术人员理解，在本发明权利要求所限定的精神和范围内可对其进行许多改变、修改、甚至等效，但都将落入本发明的保护范围内。
