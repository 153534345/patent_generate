标题title
一种漏洞无感缓解装置及方法
摘要abst
本发明公开了一种漏洞无感缓解装置及方法，装置包括：漏洞监测程序模块监测应用APP的漏洞风险；访问策略模块基于访问请求包，对访问请求进行拦截或者放行至该应用APP或者无感缓解模块内与该应用APP对应的APP；无感缓解模块根据漏洞监测程序模块的监测结果，构建漏洞加固函数，生成加固函数及加固日志；评估模块根据加固日志、访问日志持续对应用APP进行评估，访问策略模块基于评估结果，生成该接口函数的新的访问规则，从而实现无需重启应用程序即可对应用APP函数漏洞暴露的关键指标能及时进行加固，实时更新加载虚拟补丁进行拦截配置，在恶意软件危及易受攻击目标之前，高效地修补相关漏洞，避免相应的攻击行为。
权利要求书clms
1.一种漏洞无感缓解装置，其特征在于，包括：应用漏洞监测程序模块、访问策略模块、无感缓解模块、评估模块，其中，所述漏洞监测程序模块，用于对应用APP进行实时感知监测，监测其存在的漏洞风险；所述访问策略模块，用于基于访问请求包，对访问请求进行拦截或者放行至该应用APP或者无感缓解模块内与该应用APP对应的APP；所述无感缓解模块，用于根据漏洞监测程序模块的监测结果，构建相应的漏洞加固函数，生成加固函数及相关加固日志并发送至评估模块；所述评估模块，用于根据加固日志、访问日志持续对应用APP进行评估，访问策略模块基于评估模块的评估结果，生成该应用APP的接口函数的新的访问规则。2.一种漏洞无感缓解方法，其特征在于，基于权利要求1所述的漏洞无感缓解装置，所述方法包括：当应用APP接收到访问者发送的访问请求包时，应用APP将访问请求包发送至访问策略模块，所述访问策略模块根据其内部存储的各应用APP的访问规则、接收到的请求包，判断访问者是否有访问权限；当所述访问者有访问权限时，访问策略模块判断访问函数是否存在漏洞，当访问函数有访问漏洞时，访问策略模块判断无感缓解模块是否有该应用APP相对应的加固函数；当无感缓解模块有与该应用APP相对应的加固函数时，访问策略模块将访问请求包发送至无感缓解模块内与该应用APP对应的APP，进行正常的业务访问。3.根据权利要求2所述的漏洞无感缓解方法，其特征在于，还包括：当访问者没有访问权限时，访问策略模块拦截该访问请求。4.根据权利要求2所述的漏洞无感缓解方法，其特征在于，还包括：当访问函数有访问漏洞时，访问策略模块对该访问请求进行放行，访问者正常的访问该应用APP。5.根据权利要求2所述的漏洞无感缓解方法，其特征在于，还包括：当无感缓解模块没有与该应用APP相对应的加固函数时，访问策略模块拦截该访问请求。6.根据权利要求2所述的漏洞无感缓解方法，其特征在于，还包括：所述无感缓解模块记录相关的访问日志，将访问过程同步给评估模块；所述评估模块持续对应用访问进行评估，访问策略模块基于评估模块的评估结果，生成该应用APP的接口函数的新的访问规则。7.根据权利要求2所述的漏洞无感缓解方法，其特征在于，无感缓解模块建立加固函数的过程包括：在各应用容器中均部署一个应用漏洞监测程序模块，利用所述应用漏洞监测程序模块对应用APP进行扫描，并基于扫描结果，建立该应用APP与漏洞关系标签，并将标签发送至无感缓解模块；所述无感缓解模块基于应用APP与漏洞关系标签，对该应用APP的接口函数进行加固，生成加固函数及相关加固日志并发送至评估模块；评估模块基于加固日志对该应用APP的接口函数的访问规则进行评估，得到评估结果并发送至访问策略模块；访问策略模块基于评估结果，生成该应用APP的接口函数的新的访问规则。8.根据权利要求7所述的漏洞无感缓解方法，其特征在于，所述扫描结果包括：应用APP所依赖的函数库、暴露的接口函数、端口的危险情况。9.根据权利要求7所述的漏洞无感缓解方法，其特征在于，所述基于扫描结果，建立该应用APP与漏洞关系标签的过程，包括：应用漏洞监测程序模块分析该应用APP的暴露的接口函数出现的漏洞；基于分析结果，将应用APP与暴露的接口函数出现的漏洞，建立关系标签。10.一种计算机设备，其特征在于，包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器执行权利要求2-9中任一所述的漏洞无感缓解方法。
说明书desc
技术领域本发明涉及信息安全技术领域，具体涉及一种漏洞无感缓解装置及方法。背景技术随着电力系统智能化、互动化发展和网络攻击技术演进，具有“硬件平台化、业务APP化、结构模块化”特点的智能物联终端面临来自公网或专网的网络攻击风险，终端自身存在的漏洞隐患问题也更加突出。一般通过离线或者在线的方式对存在问题的软件包进行替换或者补丁的方式进行相关漏洞的修复，以对应用进行加固，但是这样一方面漏洞修复的周期和更换的成本较大，另一方面漏洞修复的过程，升级完后需要重启应用或系统，影响其他业务的正常使用，对原生应用和系统有较大的侵入。发明内容因此，本发明要解决的技术问题在于克服现有技术中的漏洞修复的过程，升级完后需要重启应用或系统的缺陷，从而提供一种漏洞无感缓解装置及方法。为达到上述目的，本发明提供如下技术方案：第一方面，本发明实施例提供一种漏洞无感缓解装置，包括：应用漏洞监测程序模块、访问策略模块、无感缓解模块、评估模块，其中，漏洞监测程序模块，用于对应用APP进行实时感知监测，监测其存在的漏洞风险；访问策略模块，用于基于访问请求包，对访问请求进行拦截或者放行至该应用APP或者无感缓解模块内与该应用APP对应的APP；无感缓解模块，用于根据漏洞监测程序模块的监测结果，构建相应的漏洞加固函数，生成加固函数及相关加固日志并发送至评估模块；评估模块，用于根据加固日志、访问日志持续对应用APP进行评估，访问策略模块基于评估模块的评估结果，生成该应用APP的接口函数的新的访问规则。第二方面，本发明实施例提供一种漏洞无感缓解方法，基于第一方面的漏洞无感缓解装置，方法包括：当应用APP接收到访问者发送的访问请求包时，应用APP将访问请求包发送至访问策略模块，访问策略模块根据其内部存储的各应用APP的访问规则、接收到的请求包，判断访问者是否有访问权限；当访问者有访问权限时，访问策略模块判断访问函数是否存在漏洞，当访问函数有访问漏洞时，访问策略模块判断无感缓解模块是否有该应用APP相对应的加固函数；当无感缓解模块有与该应用APP相对应的加固函数时，访问策略模块将访问请求包发送至无感缓解模块内与该应用APP对应的APP，进行正常的业务访问。在一实施例中，当访问者没有访问权限时，访问策略模块拦截该访问请求。在一实施例中，当访问函数有访问漏洞时，访问策略模块对该访问请求进行放行，访问者正常的访问该应用APP。在一实施例中，当无感缓解模块没有与该应用APP相对应的加固函数时，访问策略模块拦截该访问请求。在一实施例中，无感缓解模块记录相关的访问日志，将访问过程同步给评估模块；评估模块持续对应用访问进行评估，访问策略模块基于评估模块的评估结果，生成该应用APP的接口函数的新的访问规则。在一实施例中，无感缓解模块建立加固函数的过程包括：在各应用容器中均部署一个应用漏洞监测程序模块，利用应用漏洞监测程序模块对应用APP进行扫描，并基于扫描结果，建立该应用APP与漏洞关系标签，并将标签发送至无感缓解模块；无感缓解模块基于应用APP与漏洞关系标签，对该应用APP的接口函数进行加固，生成加固函数及相关加固日志并发送至评估模块；评估模块基于加固日志对该应用APP的接口函数的访问规则进行评估，得到评估结果并发送至访问策略模块；访问策略模块基于评估结果，生成该应用APP的接口函数的新的访问规则。在一实施例中，扫描结果包括：应用APP所依赖的函数库、暴露的接口函数、端口的危险情况。在一实施例中，基于扫描结果，建立该应用APP与漏洞关系标签的过程，包括：应用漏洞监测程序模块分析该应用APP的暴露的接口函数出现的漏洞；基于分析结果，将应用APP与暴露的接口函数出现的漏洞，建立关系标签。第三方面，本发明实施例提供一种计算机可读存储介质，计算机可读存储介质存储有计算机指令，计算机指令用于使计算机执行本发明实施例第二方面的漏洞无感缓解方法。本发明技术方案，具有如下优点：本发明提供的漏洞无感缓解装置及方法，漏洞监测程序模块对应用APP进行实时感知监测，监测其存在的漏洞风险；访问策略模块基于访问请求包，对访问请求进行拦截或者放行至该应用APP或者无感缓解模块内与该应用APP对应的APP；无感缓解模块根据漏洞监测程序模块的监测结果，构建相应的漏洞加固函数，生成加固函数及相关加固日志；评估模块根据加固日志、访问日志持续对应用APP进行评估，访问策略模块基于评估模块的评估结果，生成该应用APP的接口函数的新的访问规则，从而实现无需重启应用程序即可对应用APP函数漏洞暴露的端口、泄露的地址等关键指标能及时进行加固，实时更新加载虚拟补丁进行拦截配置，在恶意软件危及易受攻击目标之前，高效地修补相关漏洞，避免相应的攻击行为。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的漏洞无感缓解装置的一个具体示例的组成图；图2为本发明实施例提供的漏洞无感缓解方法的一个具体示例的流程图；图3为本发明实施例提供的漏洞无感缓解方法的另一个具体示例的流程图；图4为本发明实施例提供的计算机设备一个具体示例的组成图。具体实施方式下面将结合附图对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要说明的是，术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”、“第三”仅用于描述目的，而不能理解为指示或暗示相对重要性。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，还可以是两个元件内部的连通，可以是无线连接，也可以是有线连接。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。此外，下面所描述的本发明不同实施方式中所涉及的技术特征只要彼此之间未构成冲突就可以相互结合。实施例1本发明实施例提供一种漏洞无感缓解装置可以为基于电力智能物联终端应用的漏洞无感缓解装置，该漏洞无感缓解装置可在应用程序被非法访问时进行数据流拦截，有针对性地过滤对原应用程序有害的攻击数据包，如恶意软件、攻击脚本执行、SQL注入、CC指令、SHELLCODE、异常数据包等，提升应用程序在未打补丁升级时的安全性。如图1所示，本发明实施例的漏洞无感缓解装置包括：应用漏洞监测程序模块1、访问策略模块2、无感缓解模块3、评估模块4。本发明实施例的漏洞监测程序模块用对应用APP进行实时感知监测，监测其存在的漏洞风险。具体地，本发明实施例在每个应用APP中均部署一个漏洞监测程序模块，应用APP的类型可以为营销业务APP、配电业务APP、环境监测APP等等。本发明实施例的访问策略模块用于基于访问请求包，对访问请求进行拦截或者放行至相应应用APP或者无感缓解模块内与该应用APP对应的APP。本发明实施例的无感缓解模块用于根据漏洞监测程序模块的监测结果，构建相应的漏洞加固函数，生成加固函数及相关加固日志并发送至评估模块。评估模块通过终端应用APP访问请求进行实时的信任评估，实现对应用和漏洞访问访问上下文环境的风险判定，内置利用基于卷积神经网络+循环神经网络、孪生网络等深度学习算法的持续评估模型，可以在已有的访问策略的基础上同时对当前应用访问的信任进行评估。本发明实施例的评估模块用于根据加固日志、访问日志持续对应用APP进行评估，访问策略模块基于评估模块的评估结果，生成该应用APP的接口函数的新的访问规则。访问策略具有短时性特征，持续信任评估模型根据认证强度、风险状态和环境因素，对访问策略在当前上下文进行动态调整，形成一种动态信任关系，持续动态的对应用程序进行防护。具体地，本发明实施例在智能终端上建立一个安全访问中心，利用动态访问控制技术持续地对应用访问业务app的行为和习惯等进行记录、分析和识别，动态评估应用的信任度，并根据授权结果进行最小程度的开放，同时会在安全访问中心建立白名单机制，对应用的访问过程做全过程监督，非法访问进行有效动态拦截。本发明实施例的漏洞无感缓解模块内可以完成两种操作：漏洞无感缓解及应用扫描加固操作，具体操作过程如下：漏洞无感缓解操作：当应用APP接收到访问者发送的访问请求包时，应用APP将访问请求包发送至访问策略模块，访问策略模块根据其内部存储的各应用APP的访问规则、接收到的请求包，判断访问者是否有访问权限；当访问者有访问权限时，访问策略模块判断访问函数是否存在漏洞，当访问函数有访问漏洞时，访问策略模块判断无感缓解模块是否有该应用APP相对应的加固函数；当无感缓解模块有与该应用APP相对应的加固函数时，访问策略模块将访问请求包发送至无感缓解模块内与该应用APP对应的APP，进行正常的业务访问。应用扫描加固操作：在各应用容器中均部署一个应用漏洞监测程序模块，利用应用漏洞监测程序模块对应用APP进行扫描，并基于扫描结果，建立该应用APP与漏洞关系标签，并将标签发送至无感缓解模块；无感缓解模块基于应用APP与漏洞关系标签，对该应用APP的接口函数进行加固，生成加固函数及相关加固日志并发送至评估模块；评估模块基于加固日志对该应用APP的接口函数的访问规则进行评估，得到评估结果并发送至访问策略模块；访问策略模块基于评估结果，生成该应用APP的接口函数的新的访问规则。实施例2本发明实施例提供一种漏洞无感缓解方法，基于实施例1的漏洞无感缓解装置，如图2所示，方法包括：步骤S11：当应用APP接收到访问者发送的访问请求包时，应用APP将访问请求包发送至访问策略模块，访问策略模块根据其内部存储的各应用APP的访问规则、接收到的请求包，判断访问者是否有访问权限。具体地，当访问者访问应用APP时，应用APP通过其内核钩子函数将接收的访问请求包通过应用访问转发模块发送到安全访问中心内的访问策略模块，访问策略模块内部存储各应用APP的访问规则，将访问请求包与该访问规则进行匹配，判断访问者是否具有访问权限。步骤S12：当访问者有访问权限时，访问策略模块判断访问函数是否存在漏洞，当访问函数有访问漏洞时，访问策略模块判断无感缓解模块是否有该应用APP相对应的加固函数。具体地，访问请求包中包含访问者信息、访问函数，当访问者有访问权限时，访问策略模块还需要判断访问函数是否有漏洞，当该访问函数有漏洞时，访问策略模块判断无感访问模块是否有该应用APP对应的加固函数，该加固函数是针对该应用APP可能出现的多种接口函数的漏洞设置的；当访问者没有访问权限时，访问策略模块直接拦截该访问请求；当访问者有访问权限，且访问函数无漏洞时，访问策略模块对该访问请求进行放行，访问者正常的访问该应用APP。步骤S13：当无感缓解模块有与该应用APP相对应的加固函数时，访问策略模块将访问请求包发送至无感缓解模块内与该应用APP对应的APP，进行正常的业务访问。具体地，访问策略模块内部具有该应用APP接口函数加固后的APP，当无感缓解模块有与该应用APP相对应的加固函数时，访问策略模块将访问请求包发送至无感缓解模块内与该应用APP对应的APP，访问者进行正常的业务访问；当无感缓解模块没有与该应用APP相对应的加固函数时，访问策略模块拦截该访问请求。在一具体实施例中，漏洞无感缓解方法还包括：无感缓解模块记录相关的访问日志，将访问过程同步给评估模块；评估模块持续对应用访问进行评估，访问策略模块基于评估模块的评估结果，生成该应用APP的接口函数的新的访问规则。具体地，评估模块针对无感缓解模块发送的访问日志或者加固日志，对应用访问进行实时的信任评估，实现对应用和漏洞访问访问上下文环境的风险判定，利用基于卷积神经网络+循环神经网络、孪生网络等深度学习算法的持续评估模型，在已有的访问策略的基础上同时对当前应用访问的信任进行评估。访问策略具有短时性特征，持续信任评估模型根据认证强度、风险状态和环境因素，对访问策略在当前上下文进行动态调整，形成一种动态信任关系，持续动态的对应用程序进行防护。具体地，访问规则的更新不限于白名单机制、黑名单机制的建立，以对应用的访问过程做全过程监督，非法访问进行有效动态拦截。在一具体实施例中，如图3所示，无感缓解模块建立加固函数的过程包括：步骤S21：在各应用容器中均部署一个应用漏洞监测程序模块，利用应用漏洞监测程序模块对应用APP进行扫描，并基于扫描结果，建立该应用APP与漏洞关系标签，并将标签发送至无感缓解模块。具体地，漏洞监测程序模块对应用APP进行扫描分析，得到应用APP所依赖的函数库、暴露的接口函数、端口的危险情况，同时根据暴露的内容，进一步分析暴露的接口函数存在的漏洞，，将应用APP与暴露的接口函数出现的漏洞，建立关系标签。步骤S22：无感缓解模块基于应用APP与漏洞关系标签，对该应用APP的接口函数进行加固，生成加固函数及相关加固日志并发送至评估模块。具体地，无感缓解模块根据应用APP与漏洞关系标签，分析出现漏洞的接口函数被利用的过程，并及时进行加固，得到加固函数及加固日志，该加固日志中不限于时间、加固项目等信息；对于来不及加固的接口函数，当存在非法访问过程时，访问策略中心进行及时阻断拦截。步骤S23：评估模块基于加固日志对该应用APP的接口函数的访问规则进行评估，得到评估结果并发送至访问策略模块。步骤S24：访问策略模块基于评估结果，生成该应用APP的接口函数的新的访问规则。具体地，评估模块针对无感缓解模块发送的加固日志对应用访问进行实时的信任评估，实现对应用和漏洞访问访问上下文环境的风险判定，利用持续评估模型，在已有的访问策略的基础上同时对当前应用访问的信任进行评估。访问策略模块基于评估结果，生成该应用APP的接口函数的新的访问规则。实施例3本发明实施例提供一种计算机设备，如图4所示，包括：至少一个处理器401，例如CPU，至少一个通信接口403，存储器404，至少一个通信总线402。其中，通信总线402用于实现这些组件之间的连接通信。其中，通信接口403可以包括显示屏、键盘，可选通信接口403还可以包括标准的有线接口、无线接口。存储器404可以是高速RAM存储器，也可以是非不稳定的存储器，例如至少一个磁盘存储器。存储器404可选的还可以是至少一个位于远离前述处理器401的存储装置。其中处理器401可以执行实施例2的漏洞无感缓解方法。存储器404中存储一组程序代码，且处理器401调用存储器404中存储的程序代码，以用于执行实施例2的漏洞无感缓解方法。其中，通信总线402可以是外设部件互连标准总线或扩展工业标准结构总线等。通信总线402可以分为地址总线、数据总线、控制总线等。为便于表示，图4中仅用一条线表示，但并不表示仅有一根总线或一种类型的总线。其中，存储器404可以包括易失性存储器，例如随机存取存储器；存储器也可以包括非易失性存储器，例如快闪存储器，硬盘或固降硬盘；存储器404还可以包括上述种类的存储器的组合。其中，处理器401可以是中央处理器，网络处理器或者CPU和NP的组合。其中，处理器401还可以进一步包括硬件芯片。上述硬件芯片可以是专用集成电路，可编程逻辑器件或其组合。上述PLD可以是复杂可编程逻辑器件，现场可编程逻辑门阵列，通用阵列逻辑或其任意组合。可选地，存储器404还用于存储程序指令。处理器401可以调用程序指令，实现如本申请执行实施例2中的漏洞无感缓解方法。本发明实施例还提供一种计算机可读存储介质，计算机可读存储介质上存储有计算机可执行指令，该计算机可执行指令可执行实施例2的漏洞无感缓解方法。其中，存储介质可为磁碟、光盘、只读存储记忆体、随机存储记忆体、快闪存储器、硬盘或固降硬盘等；存储介质还可以包括上述种类的存储器的组合。显然，上述实施例仅仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引申出的显而易见的变化或变动仍处于本发明创造的保护范围之中。
