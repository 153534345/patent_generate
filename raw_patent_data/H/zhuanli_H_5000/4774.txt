标题title
eSIM卡失效恢复方法、装置、设备及存储介质
摘要abst
本发明公开了一种eSIM卡失效恢复方法、装置、设备及存储介质，所述方法通过在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互，保证eSIM正常工作，节省了移动设备的使用成本，提高了移动通信的便利性和安全性，避免了通信服务中断，提升了eSIM卡失效恢复的速度和效率。
权利要求书clms
1.一种eSIM卡失效恢复方法，其特征在于，所述eSIM卡失效恢复方法包括：在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。2.如权利要求1所述的eSIM卡失效恢复方法，其特征在于，所述在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果，包括：在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果；或，在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果。3.如权利要求2所述的eSIM卡失效恢复方法，其特征在于，所述在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果，包括：在检测到eSIM卡上电时，在所述eSIM卡内维护复位计数器；在检测到复位流程开始时，对复位计数器的异常加1，获取所述复位计数器的复位异常值，在所述复位异常值大于预设复位阈值时，确定自检结果为所述eSIM卡无法正常复位；在检测到复位流程完成时，将所述复位计数器清零。4.如权利要求3所述的eSIM卡失效恢复方法，其特征在于，所述在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果，包括：在检测到eSIM卡上电时，在所述eSIM卡内维护鉴权异常计数器；在检测到复位流程开始时，对鉴权异常计数器的异常加1，获取所述鉴权异常计数器的鉴权异常值，在所述鉴权异常值大于预设阈值时，确定自检结果为所述eSIM卡无法正常通信；在检测到鉴权指令校验成功时，将所述鉴权异常计数器清零。5.如权利要求4所述的eSIM卡失效恢复方法，其特征在于，所述根据所述自检结果判断当前eSIM卡是否失效，包括：在所述自检结果为当前eSIM卡无法正常复位，或所述自检结果为所述当前eSIM卡无法正常通信时，遍历当前用户配置文件的文件链表，对文件访问异常现象进行存储记录，并重新开始下一次自检；在自检次数超过预设次数阈值，且每次自检过程中均为同一处文件异常时，判定所述当前eSIM卡失效，且失效原因为同一处文件。6.如权利要求1所述的eSIM卡失效恢复方法，其特征在于，所述若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，包括：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。7.如权利要求6所述的eSIM卡失效恢复方法，其特征在于，所述若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡，包括：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，并发送默认复位信息至终端；在所述当前eSIM卡失效原因为复位异常时，将初始用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡；在所述当前eSIM卡失效原因为鉴权异常时，接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。8.一种eSIM卡失效恢复装置，其特征在于，所述eSIM卡失效恢复装置包括：自检模块，用于在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；判断模块，用于根据所述自检结果判断当前eSIM卡是否失效；切换模块，用于若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。9.一种eSIM卡失效恢复设备，其特征在于，所述eSIM卡失效恢复设备包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的eSIM卡失效恢复程序，所述eSIM卡失效恢复程序配置为实现如权利要求1至7中任一项所述的eSIM卡失效恢复方法的步骤。10.一种存储介质，其特征在于，所述存储介质上存储有eSIM卡失效恢复程序，所述eSIM卡失效恢复程序被处理器执行时实现如权利要求1至7中任一项所述的eSIM卡失效恢复方法的步骤。
说明书desc
技术领域本发明涉及计算机数据存储技术领域，尤其涉及一种eSIM卡失效恢复方法、装置、设备及存储介质。背景技术eSIM卡，即Embedded-SIM，嵌入式用户身份识别模块卡；eSIM卡的概念就是将传统SIM卡直接嵌入到设备芯片上，而不是作为独立的可移除零部件加入设备中，用户无需插入物理SIM卡；未来通用的eSIM标准建立将为普通消费者、企业用户节省更多移动设备使用成本，并带来更多的便利、安全性；eSIM技术取代传统的实体SIM卡，虽然无需增加新的硬件，但需要与终端的操作系统进行深度集成，才能完成与通信基带芯片的交互从而实现通信服务能力；eSIM应用在手机终端中必须保持长期在线，一旦出现异常，就会导致通信服务的中断，影响客户感知。目前eSIM卡片一般采用文件链表方式进行数据存储，当链表中其中一个或多个文件数据异常时会导致异常文件后续链式存储的所有文件全部无法访问；当卡片复位时，会出现无法访问的相关内容存储的文件，从而导致卡片无法正常工作；当其中鉴权相关文件无法访问或数据内容异常时，会导致卡片无法连接到网络。因此，现在亟需一种eSIM卡失效恢复方法来解决上述问题。发明内容本发明的主要目的在于提供一种eSIM卡失效恢复方法、装置、设备及存储介质，旨在解决现有技术中文件链表数据异常时，导致后续链式存储的文件无法访问，导致eSIM卡片无法正常工作且无法连接网络的技术问题。第一方面，本发明提供一种eSIM卡失效恢复方法，所述eSIM卡失效恢复方法包括以下步骤：在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。可选地，所述在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果，包括：在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果；或，在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果。可选地，所述在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果，包括：在检测到eSIM卡上电时，在所述eSIM卡内维护复位计数器；在检测到复位流程开始时，对复位计数器的异常加1，获取所述复位计数器的复位异常值，在所述复位异常值大于预设复位阈值时，确定自检结果为所述eSIM卡无法正常复位；在检测到复位流程完成时，将所述复位计数器清零。可选地，所述在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果，包括：在检测到eSIM卡上电时，在所述eSIM卡内维护鉴权异常计数器；在检测到复位流程开始时，对鉴权异常计数器的异常加1，获取所述鉴权异常计数器的鉴权异常值，在所述鉴权异常值大于预设阈值时，确定自检结果为所述eSIM卡无法正常通信；在检测到鉴权指令校验成功时，将所述鉴权异常计数器清零。可选地，所述根据所述自检结果判断当前eSIM卡是否失效，包括：在所述自检结果为当前eSIM卡无法正常复位，或所述自检结果为所述当前eSIM卡无法正常通信时，遍历当前用户配置文件的文件链表，对文件访问异常现象进行存储记录，并重新开始下一次自检；在自检次数超过预设次数阈值，且每次自检过程中均为同一处文件异常时，判定所述当前eSIM卡失效，且失效原因为同一处文件。可选地，所述若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，包括：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。可选地，所述若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡，包括：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，并发送默认复位信息至终端；在所述当前eSIM卡失效原因为复位异常时，将初始用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡；在所述当前eSIM卡失效原因为鉴权异常时，接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。第二方面，为实现上述目的，本发明还提出一种eSIM卡失效恢复装置，所述eSIM卡失效恢复装置包括：自检模块，用于在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；判断模块，用于根据所述自检结果判断当前eSIM卡是否失效；切换模块，用于若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。第三方面，为实现上述目的，本发明还提出一种eSIM卡失效恢复设备，所述eSIM卡失效恢复设备包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的eSIM卡失效恢复程序，所述eSIM卡失效恢复程序配置为实现如上文所述的eSIM卡失效恢复方法的步骤。第四方面，为实现上述目的，本发明还提出一种存储介质，所述存储介质上存储有eSIM卡失效恢复程序，所述eSIM卡失效恢复程序被处理器执行时实现如上文所述的eSIM卡失效恢复方法的步骤。本发明提出的eSIM卡失效恢复方法，通过在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互，保证eSIM正常工作，节省了移动设备的使用成本，提高了移动通信的便利性和安全性，避免了通信服务中断，提升了eSIM卡失效恢复的速度和效率。附图说明图1为本发明实施例方案涉及的硬件运行环境的设备结构示意图；图2为本发明eSIM卡失效恢复方法第一实施例的流程示意图；图3为本发明eSIM卡失效恢复方法第二实施例的流程示意图；图4为本发明eSIM卡失效恢复方法第三实施例的流程示意图；图5为本发明eSIM卡失效恢复方法第四实施例的流程示意图；图6为本发明eSIM卡失效恢复方法第五实施例的流程示意图；图7为本发明eSIM卡失效恢复方法第六实施例的流程示意图；图8为本发明eSIM卡失效恢复方法第七实施例的流程示意图；图9为本发明eSIM卡失效恢复装置第一实施例的功能模块图。本发明目的的实现、功能特点及优点将结合实施例，参照附图做进一步说明。具体实施方式应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。本发明实施例的解决方案主要是：通过在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互，保证eSIM正常工作，节省了移动设备的使用成本，提高了移动通信的便利性和安全性，避免了通信服务中断，提升了eSIM卡失效恢复的速度和效率，解决了现有技术中文件链表数据异常时，导致后续链式存储的文件无法访问，导致eSIM卡片无法正常工作且无法连接网络的技术问题。参照图1，图1为本发明实施例方案涉及的硬件运行环境的设备结构示意图。如图1所示，该设备可以包括：处理器1001，例如CPU，通信总线1002、用户接口1003，网络接口1004，存储器1005。其中，通信总线1002用于实现这些组件之间的连接通信。用户接口1003可以包括显示屏、输入单元比如键盘，可选用户接口1003还可以包括标准的有线接口、无线接口。网络接口1004可选的可以包括标准的有线接口、无线接口。存储器1005可以是高速RAM存储器，也可以是稳定的存储器，例如磁盘存储器。存储器1005可选的还可以是独立于前述处理器1001的存储装置。本领域技术人员可以理解，图1中示出的设备结构并不构成对该设备的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。如图1所示，作为一种存储介质的存储器1005中可以包括操作装置、网络通信模块、用户接口模块以及eSIM卡失效恢复程序。本发明设备通过处理器1001调用存储器1005中存储的eSIM卡失效恢复程序，并执行以下操作：在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。本发明设备通过处理器1001调用存储器1005中存储的eSIM卡失效恢复程序，还执行以下操作：在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果；或，在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果。本发明设备通过处理器1001调用存储器1005中存储的eSIM卡失效恢复程序，还执行以下操作：在检测到eSIM卡上电时，在所述eSIM卡内维护复位计数器；在检测到复位流程开始时，对复位计数器的异常加1，获取所述复位计数器的复位异常值，在所述复位异常值大于预设复位阈值时，确定自检结果为所述eSIM卡无法正常复位；在检测到鉴权指令校验成功时，将所述复位计数器清零。本发明设备通过处理器1001调用存储器1005中存储的eSIM卡失效恢复程序，还执行以下操作：在检测到eSIM卡上电时，在所述eSIM卡内维护鉴权异常计数器；在检测到复位流程开始时，对鉴权异常计数器的异常加1，获取所述鉴权异常计数器的鉴权异常值，在所述鉴权异常值大于预设阈值时，确定自检结果为所述eSIM卡无法正常通信；在检测到鉴权指令校验成功时，将所述鉴权异常计数器清零。本发明设备通过处理器1001调用存储器1005中存储的eSIM卡失效恢复程序，还执行以下操作：在所述自检结果为当前eSIM卡无法正常复位，或所述自检结果为所述当前eSIM卡无法正常通信时，遍历当前用户配置文件的文件链表，对文件访问异常现象进行存储记录，并重新开始下一次自检；在自检次数超过预设次数阈值，且每次自检过程中均为同一处文件异常时，判定所述当前eSIM卡失效，且失效原因为同一处文件。本发明设备通过处理器1001调用存储器1005中存储的eSIM卡失效恢复程序，还执行以下操作：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。本发明设备通过处理器1001调用存储器1005中存储的eSIM卡失效恢复程序，还执行以下操作：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，并发送默认复位信息至终端；在所述当前eSIM卡失效原因为复位异常时，将初始用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡；在所述当前eSIM卡失效原因为鉴权异常时，接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。本实施例通过上述方案，通过在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互，保证eSIM正常工作，节省了移动设备的使用成本，提高了移动通信的便利性和安全性，避免了通信服务中断，提升了eSIM卡失效恢复的速度和效率。基于上述硬件结构，提出本发明eSIM卡失效恢复方法实施例。参照图2，图2为本发明eSIM卡失效恢复方法第一实施例的流程示意图。在第一实施例中，所述eSIM卡失效恢复方法包括以下步骤：步骤S10、在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果。需要说明的是，在检测到eSIM卡上电时，即每次eSIM卡上电时，可以对eSIM卡内部文件进行自检，从而获得对应的自检结果。步骤S20、根据所述自检结果判断当前eSIM卡是否失效。可以理解的是，根据所述之间结果可以判断当前eSIM卡是否失效，同时可以确定导致eSIM卡失效的原因。步骤S30、若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。应当理解的是，在所述当前eSIM卡失效时，可以对损坏的用户配置文件PROFILE进行切换。本实施例通过上述方案，通过在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互，保证eSIM正常工作，节省了移动设备的使用成本，提高了移动通信的便利性和安全性，避免了通信服务中断，提升了eSIM卡失效恢复的速度和效率。进一步地，图3为本发明eSIM卡失效恢复方法第二实施例的流程示意图，如图3所示，基于第一实施例提出本发明eSIM卡失效恢复方法第二实施例，在本实施例中，所述步骤S10具体包括以下步骤：步骤S11、在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果。需要说明的是，自检之前需要在卡片内维护复位计数器，在检测到eSIM卡上电时，可以通过复位计数器可以对eSIM卡内部文件进行自检，一般会依次对文件链表存储的所有文件进行相应检验，从而获得对应的自检结果。步骤S12、在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果。可以理解的是，自检之前需要在卡片内维护鉴权异常计数器，在检测到eSIM卡上电时，可以通过鉴权异常计数器可以对eSIM卡内部文件进行自检，一般会依次对文件链表存储的所有文件进行相应检验，从而获得对应的自检结果。本实施例通过上述方案，通过在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果；或，在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果，能够快速确定自检结果，提升了eSIM卡失效恢复的速度和效率。进一步地，图4为本发明eSIM卡失效恢复方法第三实施例的流程示意图，如图4所示，基于第二实施例提出本发明eSIM卡失效恢复方法第三实施例，在本实施例中，所述步骤S11具体包括以下步骤：步骤S111、在检测到eSIM卡上电时，在所述eSIM卡内维护复位计数器。需要说明的是，在检测到eSIM卡上电时，可以启动复位计数器的维护功能，即在所述eSIM卡内维护复位计数器。步骤S112、在检测到复位流程开始时，对复位计数器的异常加1，获取所述复位计数器的复位异常值，在所述复位异常值大于预设复位阈值时，确定自检结果为所述eSIM卡无法正常复位。可以理解的是，在检测到复位流程开始时，对复位计数器的异常加1，即当复位流程开始时，异常复位计数器加1，每次复位开始时判断异常复位计数器的值，如果大于设定的阈值，则认为卡片数据损坏，无法正常复位工作，此时直接进行默认复位信息的发送，完成与终端的复位交互过程。步骤S113、在检测到复位流程完成时，将所述复位计数器清零。应当理解的是，在检测到复位流程完成时，可以将所述复位计数器清零，即复位流程顺利完成后异常复位计数器清0。本实施例通过上述方案，通过在检测到eSIM卡上电时，在所述eSIM卡内维护复位计数器；在检测到复位流程开始时，对复位计数器的异常加1，获取所述复位计数器的复位异常值，在所述复位异常值大于预设复位阈值时，确定自检结果为所述eSIM卡无法正常复位；在检测到复位流程完成时，将所述复位计数器清零；能够快速确定自检结果，提升了eSIM卡失效恢复的速度和效率。进一步地，图5为本发明eSIM卡失效恢复方法第四实施例的流程示意图，如图5所示，基于第二实施例提出本发明eSIM卡失效恢复方法第四实施例，在本实施例中，所述步骤S12具体包括以下步骤：步骤S121、在检测到eSIM卡上电时，在所述eSIM卡内维护鉴权异常计数器。需要说明的是，在检测到eSIM卡上电时，可以启动鉴权异常计数器的维护功能，即在所述eSIM卡内维护鉴权异常计数器。步骤S122、在检测到复位流程开始时，对鉴权异常计数器的异常加1，获取所述鉴权异常计数器的鉴权异常值，在所述鉴权异常值大于预设阈值时，确定自检结果为所述eSIM卡无法正常通信。可以理解的是，在检测到复位流程开始时，对鉴权异常计数器的异常加1，即当复位流程开始时，鉴权异常计数器加1，每次复位后第1条指令时检查鉴权异常计数器，如果大于设定的阈值，则认为卡片鉴权相关文件已损坏，无法正常通信，此时可以遍历当前PROFILE的文件系统的整个文件链表，确认是否全部文件都能被正确访问。步骤S123、在检测到鉴权指令校验成功时，将所述鉴权异常计数器清零。在具体实现中，在检测到鉴权指令校验成功时，可以将所述鉴权异常计数器清零，即所述eSIM卡鉴权成功后鉴权异常计数器清0。本实施例通过上述方案，通过在检测到eSIM卡上电时，在所述eSIM卡内维护鉴权异常计数器；在检测到复位流程开始时，对鉴权异常计数器的异常加1，获取所述鉴权异常计数器的鉴权异常值，在所述鉴权异常值大于预设阈值时，确定自检结果为所述eSIM卡无法正常通信；在检测到鉴权指令校验成功时，将所述鉴权异常计数器清零，能够快速确定自检结果，提升了eSIM卡失效恢复的速度和效率。进一步地，图6为本发明eSIM卡失效恢复方法第五实施例的流程示意图，如图6所示，基于第三实施例提出本发明eSIM卡失效恢复方法第五实施例，在本实施例中，所述步骤S20具体包括以下步骤：步骤S21、在所述自检结果为所述eSIM卡无法正常复位，或所述自检结果为所述eSIM卡无法正常通信时，遍历当前用户配置文件的文件链表，对文件访问异常现象进行存储记录，并重新开始下一次自检。需要说明的是，在所述自检结果为所述eSIM卡无法正常复位，或所述自检结果为所述eSIM卡无法正常通信时，可以确定对应的异常数据，从而根据异常数据判定当前eSIM卡失效。步骤S22、在自检次数超过预设次数阈值，且每次自检过程中均为同一处文件异常时，判定当前eSIM卡失效，且失效原因为同一处文件。应当理解的是，在所述自检结果为所述eSIM卡无法正常复位，或所述自检结果为所述eSIM卡无法正常通信时，可以遍历当前PROFILE的文件系统的整个文件链表，确认是否全部文件都能被正确访问，若在任意文件自检过程时发生异常则对文件异常信息进行存储记录，并重新开始下一次自检，若自检次数超过阈值且每次自检过程中均为该处异常，则判定当前eSIM卡失效，且是由于该处异常导致。本实施例通过上述方案，通过在所述自检结果为所述eSIM卡无法正常复位，或所述自检结果为所述eSIM卡无法正常通信时，根据异常数据判定当前eSIM卡失效，能够自动识别当前eSIM卡失效，从而快速恢复通信功能，进行eSIM卡修复，提升了eSIM卡失效恢复的速度和效率。进一步地，图7为本发明eSIM卡失效恢复方法第六实施例的流程示意图，如图7所示，基于第一实施例提出本发明eSIM卡失效恢复方法第六实施例，在本实施例中，所述步骤S30具体包括以下步骤：步骤S31、若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。需要说明的是，在所述当前eSIM卡失效时，则确定所述当前eSIM卡文件的失效位置，进而通过所述失效位置查找到损坏的用户配置文件，进而对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。本实施例通过上述方案，若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡，能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互。进一步地，图8为本发明eSIM卡失效恢复方法第 七实施例的流程示意图，如图8所示，基于第六实施例提出本发明eSIM卡失效恢复方法第七实施例，在本实施例中，所述步骤S31具体包括以下步骤：步骤S311、若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，并发送默认复位信息至终端。需要说明的是，在所述当前eSIM卡失效时，则确定所述当前eSIM卡文件的失效位置，进而通过所述失效位置查找到损坏的用户配置文件，并且可以直接进行默认复位信息的发送，从而完成与终端的复位交互过程。步骤S312、在所述当前eSIM卡失效原因为复位异常时，将初始用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。可以理解的是，在所述当前eSIM卡失效原因为复位异常时，可以将初始用户配置文件作为目标用户配置文件，即eSIM卡自动切换回PROFILE，从而根据所述目标用户配置文件对损坏的用户配置文件进行切换，从而可以恢复所述当前eSIM卡。在具体实现中，在卡片内维护复位计数器，当复位流程开始时，异常复位计数器加1，复位流程顺利完成后异常复位计数器清0。每次复位开始时判断异常复位计数器的值，如果大于设定的阈值，则认为卡片数据损坏，无法正常复位工作，此时直接进行默认复位信息的发送，完成与终端的复位交互过程。标记卡片文件系统已损坏，需重新下载PROFILE，收到复位后第1条指令后，卡片自动切换回初始PROFILE，完成与网络端鉴权后，发送卡片文件系统已损坏，需重新下载PROFILE的通知到eSIM平台，等待平台重新下发新的PROFILE数据并切换到新的PROFILE继续工作。步骤S313、在所述当前eSIM卡失效原因为鉴权异常时，接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。应当理解的是，在所述当前eSIM卡失效原因为鉴权异常时，可以接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，即需重新下载PROFILE的通知到eSIM平台，等待平台重新下发新的PROFILE数据并切换到新的PROFILE继续工作，从而根据所述目标用户配置文件对损坏的用户配置文件进行切换，从而可以恢复所述当前eSIM卡。在具体实现中，在卡片内维护鉴权异常计数器，当复位流程开始时，鉴权异常计数器加1，卡片鉴权成功后鉴权异常计数器清0。每次复位后第1条指令时检查鉴权异常计数器，如果大于设定的阈值，则认为卡片鉴权相关文件已损坏，无法正常通信，此时遍历当前PROFILE的文件系统的整个文件链表，确认是否全部文件都能被正确访问。如果存在文件访问异常情况，标记卡片文件系统已损坏，需重新下载PROFILE，卡片自动切换回初始PROFILE，完成与网络端鉴权后，发送卡片文件系统已损坏，需重新下载PROFILE的通知到eSIM平台，等待平台重新下发新的PROFILE数据并切换到新的PROFILE继续工作。如果遍历整个文件系统无文件访问异常情况，则标记卡片鉴权参数数据异常，卡片自动切换回初始PROFILE，完成与网络端鉴权后，发送卡片鉴权参数数据异常通知到eSIM平台，等待平台更新PROFILE的鉴权参数数据后再切换回当前PROFILE继续工作。本实施例通过上述方案，通过若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，并发送默认复位信息至终端；在所述当前eSIM卡失效原因为复位异常时，将初始用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡；在所述当前eSIM卡失效原因为鉴权异常时，接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡；能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互，保证eSIM正常工作，节省了移动设备的使用成本，提高了移动通信的便利性和安全性，避免了通信服务中断，提升了eSIM卡失效恢复的速度和效率。相应地，本发明进一步提供一种eSIM卡失效恢复装置。参照图9，图9为本发明eSIM卡失效恢复装置第一实施例的功能模块图。本发明eSIM卡失效恢复装置第一实施例中，该eSIM卡失效恢复装置包括：自检模块10，用于在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果。判断模块20，用于根据所述自检结果判断当前eSIM卡是否失效。切换模块30，用于若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。所述自检模块10，还用于在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果；或，在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果。所述自检模块10，还用于在检测到eSIM卡上电时，在所述eSIM卡内维护复位计数器；在检测到复位流程开始时，对复位计数器的异常加1，获取所述复位计数器的复位异常值，在所述复位异常值大于预设复位阈值时，确定自检结果为所述eSIM卡无法正常复位；在检测到复位流程完成时，将所述复位计数器清零。所述自检模块10，还用于在检测到eSIM卡上电时，在所述eSIM卡内维护鉴权异常计数器；在检测到复位流程开始时，对鉴权异常计数器的异常加1，获取所述鉴权异常计数器的鉴权异常值，在所述鉴权异常值大于预设阈值时，确定自检结果为所述eSIM卡无法正常通信；在检测到鉴权指令校验成功时，将所述鉴权异常计数器清零。所述判断模块20，还用于在所述自检结果为所述eSIM卡无法正常复位，或所述自检结果为所述eSIM卡无法正常通信时，遍历当前用户配置文件的文件链表，对文件访问异常现象进行存储记录，并重新开始下一次自检；在自检次数超过预设次数阈值，且每次自检过程中均为同一处文件异常时，判定当前eSIM卡失效，且失效原因为同一处文件。所述切换模块30，还用于若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对所述目标用户配置文件进行切换，以恢复所述当前eSIM卡。所述切换模块30，还用于若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，并发送默认复位信息至终端；在所述当前eSIM卡失效原因为复位异常时，将初始用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡；在所述当前eSIM卡失效原因为鉴权异常时，接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。其中，eSIM卡失效恢复装置的各个功能模块实现的步骤可参照本发明eSIM卡失效恢复方法的各个实施例，此处不再赘述。此外，本发明实施例还提出一种存储介质，所述存储介质上存储有eSIM卡失效恢复程序，所述eSIM卡失效恢复程序被处理器执行时实现如下操作：在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复。进一步地，所述eSIM卡失效恢复程序被处理器执行时还实现如下操作：在eSIM卡内维护复位计数器，在检测到eSIM卡上电时，通过所述复位计数器对eSIM卡内部文件进行自检，获得自检结果；或，在eSIM卡内维护鉴权异常计数器，在检测到eSIM卡上电时，通过所述鉴权异常计数器对eSIM卡内部文件进行自检，获得自检结果。进一步地，所述eSIM卡失效恢复程序被处理器执行时还实现如下操作：在检测到eSIM卡上电时，在所述eSIM卡内维护复位计数器；在检测到复位流程开始时，对复位计数器的异常加1，获取所述复位计数器的复位异常值，在所述复位异常值大于预设复位阈值时，确定自检结果为所述eSIM卡无法正常复位；在检测到复位流程完成时，将所述复位计数器清零。进一步地，所述eSIM卡失效恢复程序被处理器执行时还实现如下操作：在检测到eSIM卡上电时，在所述eSIM卡内维护鉴权异常计数器；在检测到复位流程开始时，对鉴权异常计数器的异常加1，获取所述鉴权异常计数器的鉴权异常值，在所述鉴权异常值大于预设阈值时，确定自检结果为所述eSIM卡无法正常通信；在检测到鉴权指令校验成功时，将所述鉴权异常计数器清零。进一步地，所述eSIM卡失效恢复程序被处理器执行时还实现如下操作：在所述自检结果为所述eSIM卡无法正常复位，或所述自检结果为所述eSIM卡无法正常通信时，遍历当前用户配置文件的文件链表，对文件访问异常现象进行存储记录，并重新开始下一次自检；在自检次数超过预设次数阈值，且每次自检过程中均为同一处文件异常时，判定当前eSIM卡失效，且失效原因为同一处文件。进一步地，所述eSIM卡失效恢复程序被处理器执行时还实现如下操作：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，对所述目标用户配置文件进行切换，以恢复所述当前eSIM卡。进一步地，所述eSIM卡失效恢复程序被处理器执行时还实现如下操作：若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置，根据所述失效位置查找损坏的用户配置文件，并发送默认复位信息至终端；在所述当前eSIM卡失效原因为复位异常时，将初始用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡；在所述当前eSIM卡失效原因为鉴权异常时，接收eSIM平台重新下发的新用户配置文件作为目标用户配置文件，根据所述目标用户配置文件对损坏的用户配置文件进行切换，以恢复所述当前eSIM卡。本实施例通过上述方案，通过在检测到eSIM卡上电时，对eSIM卡内部文件进行自检，获得自检结果；根据所述自检结果判断当前eSIM卡是否失效；若判断所述当前eSIM卡已失效，则确定所述当前eSIM卡文件的失效位置并恢复，能够自动识别当前eSIM卡失效，快速恢复通信功能，进行eSIM卡修复，实现eSIM与终端的复位交互，保证eSIM正常工作，节省了移动设备的使用成本，提高了移动通信的便利性和安全性，避免了通信服务中断，提升了eSIM卡失效恢复的速度和效率。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者装置中还存在另外的相同要素。上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。以上仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
