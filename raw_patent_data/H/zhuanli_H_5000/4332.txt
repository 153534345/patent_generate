标题title
一种视频图像的FMO错误隐藏方法、系统、设备及介质
摘要abst
本发明公开了一种视频图像的FMO错误隐藏方法、系统、设备及介质，该方法将第一原始视频图像划分为多个宏块；计算每个宏块内部的像素复杂程度，并且计算每个宏块与周围宏块之间的像素相关性；根据每个宏块的像素复杂程度和像素相关性，计算获得目标矩阵；根据目标矩阵移动宏块，其中，每移动一次宏块，获得移动一次宏块对应的Mask矩阵；计算恢复图像和第二原始视频图像之间的峰值信噪比；选取出最优图像恢复质量和最优图像恢复质量对应的Mask矩阵；基于最优图像恢复质量对应的Mask矩阵，采用Masked Autoencoders模型进行图像重建，获得重建图像。本发明能够提高视频图像恢复质量。
权利要求书clms
1.一种视频图像的FMO错误隐藏方法，其特征在于，所述视频图像的FMO错误隐藏方法包括：获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像；提取所述第一原始视频图像中的Y通道信息，并将所述第一原始视频图像划分为多个宏块；根据所述第一原始视频图像计算每个所述宏块内部的像素复杂程度，并且根据所述第二原始视频图像计算每个所述宏块与周围宏块之间的像素相关性；根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算获得目标矩阵；根据所述目标矩阵移动宏块，其中，每移动一次所述宏块，获得移动一次所述宏块对应的Mask矩阵；将所述Mask矩阵和所述第二原始视频图像输入至Masked Autoencoders模型中，获得恢复图像；计算所述恢复图像和所述第二原始视频图像之间的峰值信噪比；从每一次移动宏块对应的所述峰值信噪比中，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵；基于所述最优图像恢复质量对应的Mask矩阵，采用所述Masked Autoencoders模型进行图像重建，获得重建图像。2.根据权利要求1所述的视频图像的FMO错误隐藏方法，其特征在于，所述获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像，包括：通过编码器读取原始视频数据，并获取所述原始视频数据中单帧的YUV格式的第一原始视频图像；将所述YUV格式的第一原始视频图像转换为RGB格式的第二原始视频图像。3.根据权利要求1所述的视频图像的FMO错误隐藏方法，其特征在于，所述根据所述第一原始视频图像计算每个所述宏块内部的像素复杂程度，并且根据所述第二原始视频图像计算每个所述宏块与周围宏块之间的像素相关性，包括：根据所述第一原始视频图像，对每个所述宏块采用宏块Y通道信息的有偏标准差对所述像素复杂程度进行归一化：其中，L1表示所述宏块内部的像素复杂程度，N表示当前宏块的像素总数量，表示所述当前宏块中一个像素的大小，表示所述当前宏块的平均像素;根据所述第二原始视频图像，通过所述宏块与周围宏块之间的分布值来衡量所述宏块与周围宏块之间的像素相关性，通过如下公式计算所述宏块与周围宏块之间的像素相关性：其中，L2表示所述宏块与周围宏块之间的像素相关性，表示所述当前宏块中的像素概率分布，表示所述当前宏块的一个周围宏块的像素概率分布，N表示所述当前宏块的周围宏块的总数量。4.根据权利要求1所述的视频图像的FMO错误隐藏方法，其特征在于，所述根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算获得目标矩阵，包括：根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算每个所述宏块的恢复值：其中，L表示所述宏块的恢复值，和表示超参数，L1表示所述宏块内部的像素复杂程度，L2表示所述宏块与周围宏块之间的像素相关性；将每个所述宏块的恢复值进行矩阵排列，获得目标矩阵。5.根据权利要求4所述的视频图像的FMO错误隐藏方法，其特征在于，所述根据所述目标矩阵移动宏块，其中，每移动一次所述宏块，获得移动一次所述宏块对应的Mask矩阵，包括：在FMO中选择Dispersed模式，并初始化Mask矩阵；每移动一次宏块，在当前所述目标矩阵中查找最大恢复值且mask为1和最小恢复值且mask为0的宏块，获得所述最大恢复值在所述目标矩阵中的第一位置和所述最小恢复值在所述目标矩阵中的第二位置；若所述第一位置在所述初始化Mask矩阵对应位置的mask值为1，则将所述初始化Mask矩阵对应位置的mask值变为0；若所述第二位置在所述初始化Mask矩阵对应位置的mask值为0，则将所述初始化Mask矩阵对应位置的mask值变为1；获得移动一次宏块对应的Mask矩阵。6.根据权利要求5所述的视频图像的FMO错误隐藏方法，其特征在于，所述从每一次移动宏块对应的所述峰值信噪比中，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵，包括：预设移动的宏块数量，每移动一次宏块，获得移动一次宏块对应的Mask矩阵，并计算所述Mask矩阵对应的所述峰值信噪比；在移动不超过预设的所述宏块数量下，比较每一次移动宏块对应的所述峰值信噪比，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵。7.根据权利要求6所述的视频图像的FMO错误隐藏方法，其特征在于，所述基于所述最优图像恢复质量对应的Mask矩阵，采用所述Masked Autoencoders模型进行图像重建，获得重建图像，包括：通过编码器在灵活宏块重排中选择Explicit模式，并通过所述最优图像恢复质量对应的Mask矩阵的信息初始化所述灵活宏块重排，获得Mask编码信息；通过解码器对所述Mask编码信息进行解码，获得初始化Mask矩阵信息；若发生丢包，则将所述初始化Mask矩阵信息和所述初始化Mask矩阵信息对应的第二原始视频图像输入至所述Masked Autoencoders模型进行图像重建，获得重建图像。8.一种视频图像的FMO错误隐藏系统，其特征在于，所述视频图像的FMO错误隐藏系统包括：图像获取单元，用于获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像；信息提取单元，用于提取所述第一原始视频图像中的Y通道信息，并将所述第一原始视频图像划分为多个宏块；像素计算单元，用于根据所述第一原始视频图像计算每个所述宏块内部的像素复杂程度，并且根据所述第二原始视频图像计算每个所述宏块与周围宏块之间的像素相关性；目标矩阵获取单元，用于根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算获得目标矩阵；Mask矩阵获取单元，用于根据所述目标矩阵移动宏块，其中，每移动一次所述宏块，获得移动一次所述宏块对应的Mask矩阵；恢复图像获取单元，用于将所述Mask矩阵和所述第二原始视频图像输入至MaskedAutoencoders模型中，获得恢复图像；恢复质量计算单元，用于计算所述恢复图像和所述第二原始视频图像之间的峰值信噪比；恢复质量对比单元，用于从每一次移动宏块对应的所述峰值信噪比中，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵；图像重建单元，用于基于所述最优图像恢复质量对应的Mask矩阵，采用所述MaskedAutoencoders模型进行图像重建，获得重建图像。9.一种视频图像的FMO错误隐藏设备，其特征在于，包括至少一个控制处理器和用于与所述至少一个控制处理器通信连接的存储器；所述存储器存储有可被所述至少一个控制处理器执行的指令，所述指令被所述至少一个控制处理器执行，以使所述至少一个控制处理器能够执行如权利要求1至7任一项所述的视频图像的FMO错误隐藏方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机可执行指令，所述计算机可执行指令用于使计算机执行如权利要求1至7任一项所述的视频图像的FMO错误隐藏方法。
说明书desc
技术领域本发明涉及视频图像处理技术领域，尤其是涉及一种视频图像的FMO错误隐藏方法、系统、设备及介质。背景技术随着H.264/AVC标准的正式发布，如何降低因传输过程中产生丢包所造成的视频图像的失真一直是主要研究问题之一。在AVC中，典型的抗误码工具主要有：参数集的使用、数据分割、多参考帧运动估计、GoB、FMO等。在传统错误隐藏算法中，视频图像的恢复效果极其有限，普通的线性插值在丢包率上升的情况下恢复效果并不理想。传统线性插值主要参照的是当前发生错误的宏块的周围宏块的像素值进行重建，而对于较远距离的像素值则不会进行参考，从而可能失去部分像素信息。并且，在以AVC为代表的视频编码标准的编码器中，随着丢包率的上升，邻近宏块也可能出现像素缺失，从而造成缺失宏块中心像素恢复效果极差。发明内容本发明旨在至少解决现有技术中存在的技术问题之一。为此，本发明提出一种视频图像的FMO错误隐藏方法、系统、设备及介质，能够提高视频图像恢复质量。第一方面，本发明实施例提供了一种视频图像的FMO错误隐藏方法，所述视频图像的FMO错误隐藏方法包括：获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像；提取所述第一原始视频图像中的Y通道信息，并将所述第一原始视频图像划分为多个宏块；根据所述第一原始视频图像计算每个所述宏块内部的像素复杂程度，并且根据所述第二原始视频图像计算每个所述宏块与周围宏块之间的像素相关性；根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算获得目标矩阵；根据所述目标矩阵移动宏块，其中，每移动一次所述宏块，获得移动一次所述宏块对应的Mask矩阵；将所述Mask矩阵和所述第二原始视频图像输入至Masked Autoencoders模型中，获得恢复图像；计算所述恢复图像和所述第二原始视频图像之间的峰值信噪比；从每一次移动宏块对应的所述峰值信噪比中，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵；基于所述最优图像恢复质量对应的Mask矩阵，采用所述Masked Autoencoders模型进行图像重建，获得重建图像。与现有技术相比，本发明第一方面具有以下有益效果：本方法通过获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像；由于人眼对Y通道信息较为敏感，提取第一原始视频图像中的Y通道信息，并将第一原始视频图像划分为多个宏块。为了提高视频图像恢复质量，根据第一原始视频图像计算每个宏块内部的像素复杂程度，并且根据第二原始视频图像计算每个宏块与周围宏块之间的像素相关性；根据每个宏块的像素复杂程度和像素相关性，计算获得目标矩阵；根据目标矩阵移动宏块，其中，每移动一次宏块，获得移动一次宏块对应的Mask矩阵；将Mask矩阵和第二原始视频图像输入至Masked Autoencoders模型中，获得恢复图像；计算恢复图像和第二原始视频图像之间的峰值信噪比；从每一次移动宏块对应的峰值信噪比中，选取出最优图像恢复质量和最优图像恢复质量对应的Mask矩阵；基于最优图像恢复质量对应的Mask矩阵，采用Masked Autoencoders模型进行图像重建，获得重建图像。本方法通过比较每一次移动宏块对应的峰值信噪比，获得最优图像恢复质量和最优图像恢复质量对应的Mask矩阵，峰值信噪比是用于评价图像恢复质量的指标，因此，本方法能够在不同视频的各帧图像中提取自适应的Mask矩阵，而不是用固定的Mask矩阵对各帧图像进行恢复；基于最优图像恢复质量对应的Mask矩阵，采用Masked Autoencoders模型进行图像重建，采用MaskedAutoencoders模型使得本方法在较高丢包率情况下显著提升视频图像恢复质量。根据本发明的一些实施例，所述获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像，包括：通过编码器读取原始视频数据，并获取所述原始视频数据中单帧的YUV格式的第一原始视频图像；将所述YUV格式的第一原始视频图像转换为RGB格式的第二原始视频图像。根据本发明的一些实施例，所述根据所述第一原始视频图像计算每个所述宏块内部的像素复杂程度，并且根据所述第二原始视频图像计算每个所述宏块与周围宏块之间的像素相关性，包括：根据所述第一原始视频图像，对每个所述宏块采用宏块Y通道信息的有偏标准差对所述像素复杂程度进行归一化：其中，L1表示所述宏块内部的像素复杂程度，N表示当前宏块的像素总数量，表示所述当前宏块中一个像素的大小，表示所述当前宏块的平均像素;根据所述第二原始视频图像，通过所述宏块与周围宏块之间的分布值来衡量所述宏块与周围宏块之间的像素相关性，通过如下公式计算所述宏块与周围宏块之间的像素相关性：其中，L2表示所述宏块与周围宏块之间的像素相关性，表示所述当前宏块中的像素概率分布，表示所述当前宏块的一个周围宏块的像素概率分布，N表示所述当前宏块的周围宏块的总数量。根据本发明的一些实施例，所述根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算获得目标矩阵，包括：根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算每个所述宏块的恢复值：其中，L表示所述宏块的恢复值，和表示超参数，L1表示所述宏块内部的像素复杂程度，L2表示所述宏块与周围宏块之间的像素相关性；将每个所述宏块的恢复值进行矩阵排列，获得目标矩阵。根据本发明的一些实施例，所述根据所述目标矩阵移动宏块，其中，每移动一次所述宏块，获得移动一次所述宏块对应的Mask矩阵，包括：在FMO中选择Dispersed模式，并初始化Mask矩阵；每移动一次宏块，在当前所述目标矩阵中查找最大恢复值且mask为1和最小恢复值且mask为0的宏块，获得所述最大恢复值在所述目标矩阵中的第一位置和所述最小恢复值在所述目标矩阵中的第二位置；若所述第一位置在所述初始化Mask矩阵对应位置的mask值为1，则将所述初始化Mask矩阵对应位置的mask值变为0；若所述第二位置在所述初始化Mask矩阵对应位置的mask值为0，则将所述初始化Mask矩阵对应位置的mask值变为1；获得移动一次宏块对应的Mask矩阵。根据本发明的一些实施例，所述从每一次移动宏块对应的所述峰值信噪比中，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵，包括：预设移动的宏块数量，每移动一次宏块，获得移动一次宏块对应的Mask矩阵，并计算所述Mask矩阵对应的所述峰值信噪比；在移动不超过预设的所述宏块数量下，比较每一次移动宏块对应的所述峰值信噪比，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵。根据本发明的一些实施例，所述基于所述最优图像恢复质量对应的Mask矩阵，采用所述Masked Autoencoders模型进行图像重建，获得重建图像，包括：通过编码器在灵活宏块重排中选择Explicit模式，并通过所述最优图像恢复质量对应的Mask矩阵的信息初始化所述灵活宏块重排，获得Mask编码信息；通过解码器对所述Mask编码信息进行解码，获得初始化Mask矩阵信息；若发生丢包，则将所述初始化Mask矩阵信息和所述初始化Mask矩阵信息对应的第二原始视频图像输入至所述Masked Autoencoders模型进行图像重建，获得重建图像。第二方面，本发明实施例还提供了一种视频图像的FMO错误隐藏系统，所述视频图像的FMO错误隐藏系统包括：图像获取单元，用于获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像；信息提取单元，用于提取所述第一原始视频图像中的Y通道信息，并将所述第一原始视频图像划分为多个宏块；像素计算单元，用于根据所述第一原始视频图像计算每个所述宏块内部的像素复杂程度，并且根据所述第二原始视频图像计算每个所述宏块与周围宏块之间的像素相关性；目标矩阵获取单元，用于根据每个所述宏块的所述像素复杂程度和所述像素相关性，计算获得目标矩阵；Mask矩阵获取单元，用于根据所述目标矩阵移动宏块，其中，每移动一次所述宏块，获得移动一次所述宏块对应的Mask矩阵；恢复图像获取单元，用于将所述Mask矩阵和所述第二原始视频图像输入至MaskedAutoencoders模型中，获得恢复图像；恢复质量计算单元，用于计算所述恢复图像和所述第二原始视频图像之间的峰值信噪比；恢复质量对比单元，用于从每一次移动宏块对应的所述峰值信噪比中，选取出最优图像恢复质量和所述最优图像恢复质量对应的Mask矩阵；图像重建单元，用于基于所述最优图像恢复质量对应的Mask矩阵，采用所述Masked Autoencoders模型进行图像重建，获得重建图像。第三方面，本发明实施例还提供了一种视频图像的FMO错误隐藏设备，包括至少一个控制处理器和用于与所述至少一个控制处理器通信连接的存储器；所述存储器存储有可被所述至少一个控制处理器执行的指令，所述指令被所述至少一个控制处理器执行，以使所述至少一个控制处理器能够执行如上所述的一种视频图像的FMO错误隐藏方法。第四方面，本发明实施例还提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机可执行指令，所述计算机可执行指令用于使计算机执行如上所述的一种视频图像的FMO错误隐藏方法。可以理解的是，上述第二方面至第四方面与相关技术相比存在的有益效果与上述第一方面与相关技术相比存在的有益效果相同，可以参见上述第一方面中的相关描述，在此不再赘述。附图说明本发明的上述和/或附加的方面和优点从结合下面附图对实施例的描述中将变得明显和容易理解，其中：图1是本发明一实施例的一种视频图像的FMO错误隐藏方法的流程图；图2是本发明一实施例的部分测试图像示例效果的示意图；图3是本发明一实施例的一种视频图像的FMO错误隐藏系统的结构图。具体实施方式下面详细描述本发明的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，仅用于解释本发明，而不能理解为对本发明的限制。在本发明的描述中，如果有描述到第一、第二等只是用于区分技术特征为目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量或者隐含指明所指示的技术特征的先后关系。在本发明的描述中，需要理解的是，涉及到方位描述，例如上、下等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。本发明的描述中，需要说明的是，除非另有明确的限定，设置、安装、连接等词语应做广义理解，所属技术领域技术人员可以结合技术方案的具体内容合理确定上述词语在本发明中的具体含义。随着H.264/AVC标准的正式发布，如何降低因传输过程中产生丢包所造成的视频图像的失真一直是主要研究问题之一。在AVC中，典型的抗误码工具主要有：参数集的使用、数据分割、多参考帧运动估计、GoB、FMO等。在传统错误隐藏算法中，视频图像的恢复效果极其有限，普通的线性插值在丢包率上升的情况下恢复效果并不理想。传统线性插值主要参照的是当前发生错误的宏块的周围宏块的像素值进行重建，而对于较远距离的像素值则不会进行参考，从而可能失去部分像素信息。并且，在以AVC为代表的视频编码标准的编码器中，随着丢包率的上升，邻近宏块也可能出现像素缺失，从而造成缺失宏块中心像素恢复效果极差。为解决上述问题，本发明通过获取YUV格式的原始视频图像；由于人眼对Y通道信息较为敏感，提取原始视频图像中的Y通道信息，并将原始视频图像划分为多个宏块。为了提高视频图像恢复质量，计算每个宏块内部的像素复杂程度，并且计算每个宏块与周围宏块之间的像素相关性；根据每个宏块的像素复杂程度和像素相关性，计算获得目标矩阵；根据目标矩阵移动宏块，其中，每移动一次宏块，获得移动一次宏块对应的Mask矩阵；将Mask矩阵和视频图像输入至Masked Autoencoders模型中，获得恢复图像；计算恢复图像和视频图像之间的峰值信噪比；从每一次移动宏块对应的峰值信噪比中，选取出最优图像恢复质量和最优图像恢复质量对应的Mask矩阵；基于最优图像恢复质量对应的Mask矩阵，采用Masked Autoencoders模型进行图像重建，获得重建图像。本发明通过比较每一次移动宏块对应的峰值信噪比，获得最优图像恢复质量和最优图像恢复质量对应的Mask矩阵，峰值信噪比是用于评价图像恢复质量的指标，因此，本发明能够在不同视频的各帧图像中提取自适应的Mask矩阵，而不是用固定的Mask矩阵对各帧图像进行恢复；基于最优图像恢复质量对应的Mask矩阵，采用Masked Autoencoders模型进行图像重建，采用MaskedAutoencoders模型使得本发明在较高丢包率情况下显著提升视频图像恢复质量。参照图1，本发明实施例提供了一种视频图像的FMO错误隐藏方法，该视频图像的FMO错误隐藏方法包括：步骤S100、获取YUV格式的第一原始视频图像和RGB格式的第二原始视频图像。具体的，通过编码器读取原始视频数据，并获取原始视频数据中单帧的YUV格式的第一原始视频图像；将YUV格式的第一原始视频图像转换为RGB格式的第二原始视频图像。步骤S200、提取第一原始视频图像中的Y通道信息，并将第一原始视频图像划分为多个宏块。具体的，由于人眼对Y通道信息较为敏感，因此，提取第一原始视频图像中的Y通道信息，并将第一原始视频图像划分为多个宏块。需要说明的是，本实施例将原始视频图像拆分为16x16的若干宏块。步骤S300、根据第一原始视频图像计算每个宏块内部的像素复杂程度，并且根据第二原始视频图像计算每个宏块与周围宏块之间的像素相关性。具体的，每个宏块的恢复程度信息主要由两部分构成：第一部分为宏块内部的像素复杂程度，第二部分为该宏块与周围宏块的像素相关性。根据第一原始视频图像，对每个宏块采用宏块Y通道信息的有偏标准差对像素复杂程度进行归一化：其中，L1表示宏块内部的像素复杂程度，N表示当前宏块的像素总数量，表示当前宏块中一个像素的大小，表示当前宏块的平均像素；根据第二原始视频图像，通过宏块与周围宏块之间的分布值来衡量宏块与周围宏块之间的像素相关性，通过如下公式计算宏块与周围宏块之间的像素相关性：其中，L2表示宏块与周围宏块之间的像素相关性，表示当前宏块中的像素概率分布，表示当前宏块的一个周围宏块的像素概率分布，N表示当前宏块的周围宏块的总数量。需要说明的是，本实施例的像素相关性主要参考与周围宏块的像素分布值来衡量，参考块选择当前宏块的上、下、左、右四个方位的像素分布，分布值越接近0则认为两个宏块之间的相关性越强，恢复效果更好；分布值越接近1则认为两个宏块之间不具有较强相关，需要额外的信息进行恢复。步骤S400、根据每个宏块的像素复杂程度和像素相关性，计算获得目标矩阵。具体的，根据每个宏块的像素复杂程度和像素相关性，计算每个宏块的恢复值：其中，L表示宏块的恢复值，和表示超参数，L1表示宏块内部的像素复杂程度，L2表示宏块与周围宏块之间的像素相关性；将每个宏块的恢复值进行矩阵排列，获得目标矩阵。例如：假设宏块大小是16x16，视频图像大小是224x224，L1和L2都是计算16x16的宏块得到的两个值，则L最后的结果是14x14的矩阵，其中矩阵中的每个值都是通过L1和L2计算获得的。需要说明的是，根据两部分对当前宏块恢复信息的重要影响程度，分别初始化和，但和的选值可以根据实际需要进行修改，本实施例不做具体限定。步骤S500、根据目标矩阵移动宏块，其中，每移动一次宏块，获得移动一次宏块对应的Mask矩阵。具体的，宏块分组的移动情况可以由上述得到的目标矩阵进行修改，在保证不同片组均有较好的恢复方式的情况下，可以在传统FMO中选用Dispersed模式进行适当移动，根据MAE模型恢复程度选用合适的移动宏块的个数，具体步骤如下：在FMO中选择Dispersed模式，并初始化Mask矩阵；每移动一次宏块，在当前目标矩阵中查找最大恢复值且mask为1和最小恢复值且mask为0的宏块，获得最大恢复值在目标矩阵中的第一位置和最小恢复值在目标矩阵中的第二位置；若第一位置在初始化Mask矩阵对应位置的mask值为1，则将初始化Mask矩阵对应位置的mask值变为0；若第二位置在初始化Mask矩阵对应位置的mask值为0，则将初始化Mask矩阵对应位置的mask值变为1；获得移动一次宏块对应的Mask矩阵。需要说明的是，每次移动宏块需保证Mask矩阵中0和1的数量相等，便于MaskedAutoencoders模型的mask初始化以及恢复图像质量。步骤S600、将Mask矩阵和第二原始视频图像输入至Masked Autoencoders模型中，获得恢复图像。具体的，在获得每次移动宏块对应的Mask矩阵后，将每个Mask矩阵和第二原始视频图像输入至Masked Autoencoders模型中，获得每个Mask矩阵对应的恢复图像。步骤S700、计算恢复图像和第二原始视频图像之间的峰值信噪比。具体的，计算每个恢复图像和第二原始视频图像之间的峰值信噪比，峰值信噪比是一种衡量图像质量的指标，峰值信噪比越大，表明图像恢复质量越好。步骤S800、从每一次移动宏块对应的峰值信噪比中，选取出最优图像恢复质量和最优图像恢复质量对应的Mask矩阵。具体的，预设移动的宏块数量，每移动一次宏块，获得移动一次宏块对应的Mask矩阵，并计算Mask矩阵对应的峰值信噪比；在移动不超过预设的宏块数量下，比较每一次移动宏块对应的峰值信噪比，选取出最优图像恢复质量和最优图像恢复质量对应的Mask矩阵。需要说明的是，本实施例中的预设移动的宏块数量可以根据实际需要进行更改，本实施例不做具体限定。在本实施例中，通过比较每一次移动宏块对应的峰值信噪比，获得最优图像恢复质量和最优图像恢复质量对应的Mask矩阵，峰值信噪比是用于评价图像恢复质量的指标，因此，本方法能够在不同视频的各帧图像中提取自适应的Mask矩阵，而不是用固定的Mask矩阵对各帧图像进行恢复。步骤S900、基于最优图像恢复质量对应的Mask矩阵，采用Masked Autoencoders模型进行图像重建，获得重建图像。具体的，在获得最优图像恢复质量对应的Mask矩阵后，通过编码器在AVC中选用传统灵活宏块重排的Explicit模式进行用户自定义Slice。若在通信过程中发生丢包情况，解码器通过该信息初始化Mask矩阵，并使用MaskedAutoencoders模型进行错误隐藏。具体步骤如下：通过编码器在灵活宏块重排中选择Explicit模式，并通过最优图像恢复质量对应的Mask矩阵的信息初始化灵活宏块重排，获得Mask编码信息；通过解码器对Mask编码信息进行解码，获得初始化Mask矩阵信息；若发生丢包，则将初始化Mask矩阵信息和初始化Mask矩阵信息对应的第二原始视频图像输入至Masked Autoencoders模型进行图像重建，获得重建图像。需要说明的是，本实施例对AVC视频中每帧图像都进行上述步骤的处理。在本实施例中，基于最优图像恢复质量对应的Mask矩阵，采用MaskedAutoencoders模型进行图像重建，采用Masked Autoencoders模型使得本方法在较高丢包率情况下显著提升视频图像恢复质量。为了更好的说明，本实施例进行了如下分析：本发明实施例整个模型的训练和测试平台的软硬件具体配置如下表1所示。表1由于MAE模型在输入尺寸上固定为224x224分辨率大小，因此，本实施例使用如表2所示的标准视频测试序列，且对这些视频进行随机裁剪为224x224的视频序列，将测试视频输入H.264/AVC的参考编码器JM-8.6分别对传统FMO算法和本实施例的视频图像的FMO错误隐藏方法进行测试，宏块Slice数量设置为2，丢包率设置为50%，即每帧图像存在一半像素发生丢失。在针对自适应的宏块映射实验中，为了保证算法的有效性，选择了ImageNet测试图像数据集ILSVRC2012中随机的1000张图像进行测试，图像大小均为224x224。表2在本实施例的视频图像的FMO错误隐藏方法的实验中，其测试结果如表3所示。表中为AVC中传统恢复算法的恢复质量结果，为使用MAE模型增强后的恢复质量结果，为引入自适应的宏块映射矩阵后的MAE模型恢复质量结果。表3在本实施例的视频图像的FMO错误隐藏方法的实验中，其测试结果如表4所示，图2是部分测试图像示例效果的示意图，其中，纯灰色区域为丢失像素的宏块，图2中有a、b、c三组图片，其中，a组为表4中图像编号00025056的一组图片，从左至右第一个图为原始图像，第二个图和第三个图为一组都是disperse模式，其中，第二个图为FMO中disperse模式的丢包图，第三个图为使用MAE模型增强后的恢复质量结果和恢复图像，第四个图和第五个图为一组都是explicit模式，其中，第四个图为FMO中explicit模式在自适应矩阵下的丢包图，第五个图为引入自适应的宏块映射矩阵后的MAE模型恢复质量结果和恢复图像；b组为表4中图像编号00027412的一组图片，从左至右第一个图为原始图像，第二个图和第三个图为一组都是disperse模式，其中，第二个图为FMO中disperse模式的丢包图，第三个图为使用MAE模型增强后的恢复质量结果和恢复图像，第四个图和第五个图为一组都是explicit模式，其中，第四个图为FMO中explicit模式在自适应矩阵下的丢包图，第五个图为引入自适应的宏块映射矩阵后的MAE模型恢复质量结果和恢复图像；c组为表4中图像编号00028615的一组图片，从左至右第一个图为原始图像，第二个图和第三个图为一组都是disperse模式，其中，第二个图为FMO中disperse模式的丢包图，第三个图为使用MAE模型增强后的恢复质量结果和恢复图像，第四个图和第五个图为一组都是explicit模式，其中，第四个图为FMO中explicit模式在自适应矩阵下的丢包图，第五个图为引入自适应的宏块映射矩阵后的MAE模型恢复质量结果和恢复图像。在该测试集上97.3%的视频图像在使用了自适应的Mask矩阵后得到了恢复效果的提升。表4参照图3，本发明实施例还提供了一种视频图像的FMO错误隐藏系统，该视频图像的FMO错误隐藏系统包括：图像获取单元100，用于获取YUV格式的原始视频图像；信息提取单元200，用于提取原始视频图像中的Y通道信息，并将原始视频图像划分为多个宏块；像素计算单元300，用于计算每个宏块内部的像素复杂程度，并且计算每个宏块与周围宏块之间的像素相关性；目标矩阵获取单元400，用于根据每个宏块的像素复杂程度和像素相关性，计算获得目标矩阵；Mask矩阵获取单元500，用于根据目标矩阵移动宏块，其中，每移动一次宏块，获得移动一次宏块对应的Mask矩阵；恢复图像获取单元600，用于将Mask矩阵和视频图像输入至Masked Autoencoders模型中，获得恢复图像；恢复质量计算单元700，用于计算恢复图像和视频图像之间的峰值信噪比；恢复质量对比单元800，用于从每一次移动宏块对应的峰值信噪比中，选取出最优图像恢复质量和最优图像恢复质量对应的Mask矩阵；图像重建单元900，用于基于最优图像恢复质量对应的Mask矩阵，采用MaskedAutoencoders模型进行图像重建，获得重建图像。需要说明的是，由于本实施例中的一种视频图像的FMO错误隐藏系统与上述的一种视频图像的FMO错误隐藏方法基于相同的发明构思，因此，方法实施例中的相应内容同样适用于本系统实施例，此处不再详述。本发明实施例还提供了一种视频图像的FMO错误隐藏设备，包括：至少一个控制处理器和用于与至少一个控制处理器通信连接的存储器。存储器作为一种非暂态计算机可读存储介质，可用于存储非暂态软件程序以及非暂态性计算机可执行程序。此外，存储器可以包括高速随机存取存储器，还可以包括非暂态存储器，例如至少一个磁盘存储器件、闪存器件、或其他非暂态固态存储器件。在一些实施方式中，存储器可选包括相对于处理器远程设置的存储器，这些远程存储器可以通过网络连接至该处理器。上述网络的实例包括但不限于互联网、企业内部网、局域网、移动通信网及其组合。实现上述实施例的一种视频图像的FMO错误隐藏方法所需的非暂态软件程序以及指令存储在存储器中，当被处理器执行时，执行上述实施例中的一种视频图像的FMO错误隐藏方法，例如，执行以上描述的图1中的方法步骤S100至步骤S900。以上所描述的系统实施例仅仅是示意性的，其中作为分离部件说明的单元可以是或者也可以不是物理上分开的，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。本发明实施例还提供了一种计算机可读存储介质，该计算机可读存储介质存储有计算机可执行指令，该计算机可执行指令被一个或多个控制处理器执行，可使得上述一个或多个控制处理器执行上述方法实施例中的一种视频图像的FMO错误隐藏方法，例如，执行以上描述的图1中的方法步骤S100至步骤S900的功能。本领域普通技术人员可以理解，上文中所公开方法中的全部或某些步骤、系统可以被实施为软件、固件、硬件及其适当的组合。某些物理组件或所有物理组件可以被实施为由处理器，如中央处理器、数字信号处理器或微处理器执行的软件，或者被实施为硬件，或者被实施为集成电路，如专用集成电路。这样的软件可以分布在计算机可读介质上，计算机可读介质可以包括计算机存储介质和通信介质。如本领域普通技术人员公知的，术语计算机存储介质包括在用于存储信息的任何方法或技术中实施的易失性和非易失性、可移除和不可移除介质。计算机存储介质包括但不限于RAM、ROM、EEPROM、闪存或其他存储器技术、CD-ROM、数字多功能盘或其他光盘存储、磁盒、磁带、磁盘存储或其他磁存储装置、或者可以用于存储期望的信息并且可以被计算机访问的任何其他的介质。此外，本领域普通技术人员公知的是，通信介质通常包含计算机可读指令、数据结构、程序模块或者诸如载波或其他传输机制之类的调制数据信号中的其他数据，并且可包括任何信息递送介质。上面结合附图对本发明实施例作了详细说明，但本发明不限于上述实施例，在所属技术领域普通技术人员所具备的知识范围内，还可以在不脱离本发明宗旨的前提下作出各种变化。
