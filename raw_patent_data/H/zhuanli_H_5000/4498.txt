标题title
一种基于STM32单片机的多设备协同拍照系统
摘要abst
本发明公开了一种基于STM32单片机的多设备协同拍照系统，包括CH340在线下载的最小系统模块、单片机模块、USB串口模块、按键输入模块和手机设备，所述CH340在线下载的最小系统模块与单片机连接，所述的单片机设置有48个引脚，通过引脚与分别与按键输入模块和USB串口模块连接，USB串口模块通过USB耳机线和按键输入模块相连，按键输入模块与手机设备连接；其中，所述按键输入模块为单片机传输拍摄信号，单片机模块接收按键输入模块的输入信号改变电压，控制引脚电压跳变，使所述的USB串口模块电压跳变，实现手机设备的拍照功能。该系统能够实现使不同设备同时进行拍照的能力。
权利要求书clms
1.一种基于STM32单片机的多设备协同拍照系统，包括CH340在线下载的最小系统模块、单片机模块、USB串口模块、按键输入模块和手机设备，其特征在于，所述CH340在线下载的最小系统模块与单片机连接，所述的单片机设置有48个引脚，通过引脚与分别与按键输入模块和USB串口模块连接，USB串口模块通过USB耳机线和按键输入模块相连，按键输入模块与手机设备连接；其中，所述按键输入模块为单片机传输拍摄信号，单片机模块接收按键输入模块的输入信号改变电压，控制引脚电压跳变，使所述的USB串口模块电压跳变，实现手机设备的拍照功能。2.如权利要求1所述的基于STM32单片机的多设备协同拍照系统，其特征在于，所述单片机模块选择STM32F103C8T6单片机。3.如权利要求1所述的基于STM32单片机的多设备协同拍照系统，其特征在于，所述CH340在线下载的最小系统模块用于为单片机烧录程序，且选用USB总线的转接芯片CH340。4.如权利要求1所述的基于STM32单片机的多设备协同拍照系统，其特征在于，在单片机内部还设置有用于控制单片机的程序。5.如权利要求1所述的基于STM32单片机的多设备协同拍照系统，其特征在于，所述USB耳机线用于为外设传输电压跳变信号。6.如权利要求1所述的基于STM32单片机的多设备协同拍照系统，其特征在于，所述的按键输入模块采用独立式按键，并与单片机焊接。7.如权利要求1所述的基于STM32单片机的多设备协同拍照系统，其特征在于，所述的USB串口模块采用usb2.0母座转DIP模块。8.如权利要求1所述的基于STM32单片机的多设备协同拍照系统，其特征在于，所述耳机线采用通用标准3.5mm接口转usb接口类型。
说明书desc
技术领域本发明属于一种单片机应用与开发技术领域，尤其涉及一种基于STM32单片机的多设备协同拍照系统。背景技术近年来，随着智能手机的飞速发展，手机的照相技术变得越来越成熟，人们可以摆脱沉重的照相机的束缚，随时随地用手机来进行拍摄。在这个全民自拍的时代里，人们常用的拍照方式是使用自拍杆进行拍照。然而，使用一个设备来拍照仅仅能记录下一个瞬时的二维平面，无法将环境多角度信息全部记录下来，例如在三维建模中，往往需要为动态物体进行建模，但很难将物体的一个动作完整的记录下来，如果使用多个设备从多角度同时进行拍照，就可以解决该问题。但是人为使用多个设备进行拍照很难保证同步，因此，开发一种多设备协同拍照系统可在一定程度上填补市场的空白。发明内容为了满足人们对多设备协同拍照的需求，本发明的目的在于，提供一种基于STM32单片机的多设备协同拍照系统，该系统能够使用多个设备进行同时多角度拍照，以达到记录更多的信息。为了实现上述任务，本发明采用以下的技术解决方案：一种基于STM32单片机的多设备协同拍照系统，包括CH340在线下载的最小系统模块、单片机模块、USB串口模块、按键输入模块和手机设备，其特征在于，所述CH340在线下载的最小系统模块与单片机连接，所述的单片机设置有48个引脚，通过引脚与分别与按键输入模块和USB串口模块连接，USB串口模块通过USB耳机线和按键输入模块相连，按键输入模块与手机设备连接；其中，所述按键输入模块为单片机传输拍摄信号，单片机模块接收按键输入模块的输入信号改变电压，控制引脚电压跳变，使所述的USB串口模块电压跳变，实现手机设备的拍照功能。根据本发明，所述单片机模块选择STM32F103C8T6单片机。进一步地，所述CH340在线下载的最小系统模块用于为单片机烧录程序，且选用USB总线的转接芯片CH340。具体地，在单片机内部还设置有用于控制单片机的程序。优选地，所述的按键输入模块采用独立式按键，并与单片机焊接。进一步优选地，所述的USB串口模块采用usb2.0母座转DIP模块。作为优选，所述的耳机线采用通用标准3.5mm接口转usb接口类型。本发明的基于STM32单片机的多设备协同拍照系统，基于根据耳机接口电路的原理方法，将单片机开发和外设相结合，利用耳机的电压跳变，做到了一键多拍的功能。能够实现使不同设备同时进行拍照的能力。附图说明图1是本发明的基于STM32单片机的多设备协同拍照系统框架图；图2A是单片机STM32F103C8T6内部结构图；图2B是USB接口和转接芯片CH340接口电路图；图3是USB串口模块电路图；图4是耳机插口电路图；图5是单片机程序流程图；下面结合附图和实施例对本发明作进一步详细地解释和说明。具体实施方式参见图1，本实施例给出一种基于STM32单片机的多设备协同拍照系统，采用单片机进行开发，包括CH340在线下载的最小系统模块、单片机模块、USB串口模块、按键输入模块和手机设备，其特征在于，所述CH340在线下载的最小系统模块与单片机连接，所述的单片机设置有48个引脚，通过引脚与分别与按键输入模块和USB串口模块连接，USB串口模块通过USB耳机线和按键输入模块相连，按键输入模块与手机设备连接；其中，所述按键输入模块为单片机传输拍摄信号，单片机模块接收按键输入模块的输入信号改变电压，控制引脚电压跳变，使所述的USB串口模块电压跳变，实现手机设备的拍照功能。本实施例中，所述单片机模块选择STM32F103C8T6单片机，该STM32F103C8T6单片机内部还设置有用于控制单片机的程序。所述CH340在线下载的最小系统模块用于为单片机烧录程序，且选用USB总线的转接芯片CH340。所述的按键输入模块采用独立式按键，并与单片机焊接。所述的USB串口模块采用usb2.0母座转DIP模块。所述耳机线采用通用标准3.5mm接口转usb接口类型。USB接口电路和CH340接口电路与STM32F103C8T6单片机组成单片机最小系统下载板。STM32F103C8T6单片机有48个引脚，CH340能够实时进行程序的下载调试，方便设计者根据设计要求自行进行程序的编写调试。而且方便灵活，便于与其他部件组装。STM32F103C8T6单片机的内部结构如图2A所示，USB接口电路和CH340接口电路如图2B所示。USB接口电路包括U1模块，其中Vbus引脚接5V电源，D-引脚接和D+引脚接分别通过电阻R连接单片机引脚PA11和PA12，D+引脚在连接单片机引脚之前通过另一电阻R连接5V电源；ID引脚和G引脚接地。CH340接口电路包括P1模块，其中引脚1和引脚4之间连接电容C，引脚4接地，引脚2和引脚3悬空。USB串口模块的连接方式如图3所示。USB串口模块的P1正极与STM32F103C8T单片机6引脚PC15相连，负极与单片机引脚PA1相连；USB串口模块的P2正极与单片机引脚PA2相连，负极与单片机引脚PA5相连；USB串口模块的P3正极与单片机引脚PA7相连，负极与单片机引脚PB0相连；USB串口模块的P4正极与单片机引脚PB1相连，负极与单片机引脚PB10相连；USB串口模块的P5正极与单片机引脚PB11相连，负极与单片机引脚GND相连；USB串口模块的P6正极与单片机引脚PB12相连，负极与单片机引脚PB13相连；USB串口模块的P7正极与单片机引脚PB15相连，负极与单片机引脚PA8相连；USB串口模块的P8正极与单片机引脚PA10相连，负极与单片机引脚PA11相连；USB串口模块的P9正极与单片机引脚PA15相连，负极与单片机引脚PB3相连；USB串口模块的P10的正极与单片机引脚PB6相连，负极与单片机引脚GND相连；其中每个USB串口模块，在正极与单片机连线上串联一个1.5千欧的电阻，并在正负极之间并联一个200欧姆的电阻，最后将按键输入模块与单片机引脚PB9直连。电路焊接完成后，通过ST-Link将程序从keil中烧录到单片机中。耳机插口电路如图4所示，包括电阻R1、R2、R3、R4和R5，电容C1等。在耳机插入前，HEADSET_L_INT引脚被上拉到VDDIO；当耳机插入后，耳机左声道与上方的弹片接触，由于耳机左声道线圈阻抗是几十欧姆，会把HEADSET_L_INT引脚电压明显拉低。芯片内部一般会设计比较器，通过比较HEADSET_L_INT引脚电压和预先设置的门限电压的大小关系，来产生中断或者更新相应的状态寄存器，从而指示耳机插拔状态。STM32F103C8T6单片机程序控制流程如图5所示：先初始化LED端口，延时函数以及和按键输入模块连接的硬件接口，然后使各个接口电平拉高，进入循环后，每次判断是否得到按键输入，是则将接口电平反转，延时0.1s后再次反转回初始状态，进入下一轮循环，否则直接延时10ms，进入下一轮循环，其检测代码如下：当STM32F103C8T单片机供电，待led灯常亮后，便可通过外接USB插孔与手机设备的耳机相连，如USB串口模块的P1，C15与A1为单片机的I/O口，A1输出为GND电平，C15通过单片机控制，当单片机检测到按键输入模块的按键被按下后，C15由3.3V变为0V，根据电阻的分压原理，如图4所示，耳机插入前，HEADMIC_IN引脚被上拉HEADMICBIAS；耳机插入后，因为耳机MIC的等效阻抗，会拉低HEADMIC_IN引脚上的电压，耳机两端电压发生跳变，由1.1V变为0.2V。以Android手机为例，手机处理器检测到MIC段电压变化后，会产生特定的硬件中断，软件系统例如耳机接口驱动会响应这个中断，在中断处理例程中通过Linux Input子系统上报一个按键事件，一般是音量键事件，而Android相机对音量键事件的默认响应就是拍照，由此实现了按键检测功能。由于单片机主频比较高，因此，不同耳机电路检测到按键按下的时延为0.016us，满足系统要求。以上实施例描述了本发明的基本原理和主要特征和优点，本领域的技术人员应该了解，本发明不限于上述实施例的限制，在不脱离本发明精神和技术方案前提下，在本发明的技术方案基础上进行的添加或简单替换，均应属于本发明所述的权利要求及其附属权利要求的保护范围。
