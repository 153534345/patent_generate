标题title
混合储能VSG自适应虚拟阻尼参数整定方法
摘要abst
本申请提出了一种混合储能自适应虚拟阻尼参数整定方法，包括：建立混合储能虚拟同步机转子机械方程；使用自适应虚拟阻尼代替机械方程中的虚拟阻尼系数；根据机械方程建立有功功率‑频率下垂公式并进行反拉普拉斯变换，得到变换方程；将机械方程转换为频率‑功率形式；根据变换方程和频率‑功率形式得到虚拟惯量、虚拟阻尼系数；当控制系统稳态运行时将机械方程频率‑功率形式转化为虚拟转矩偏差表达式；根据转化的表达式得到自适应虚拟阻尼方程中额定虚拟阻尼系数；将虚拟惯量、虚拟阻尼系数代入到自适应虚拟阻尼方程中，根据虚拟惯量和滤波参数得到自适应虚拟阻尼系数取值范围。采用上述方案的本发明实现了混合储能最优功率控制。
权利要求书clms
1.一种混合储能自适应虚拟阻尼参数整定方法，其特征在于，包括以下步骤：建立混合储能虚拟同步机转子机械方程；使用自适应虚拟阻尼代替混合储能转子机械方程中的虚拟阻尼系数；根据所述混合储能转子机械方程建立有功功率-频率下垂公式，并将建立的有功功率-频率下垂公式进行反拉普拉斯变换，得到有功功率-频率下垂反拉普拉斯变换方程；将所述混合储能转子机械方程转换为频率-功率形式；根据所述有功功率-频率下垂反拉普拉斯变换方程和混合储能转子机械方程频率-功率形式得到虚拟惯量、虚拟阻尼系数；当控制系统稳态运行时，将所述混合储能转子机械方程频率-功率形式转化为虚拟转矩偏差表达式；根据所述虚拟转矩偏差表达式得到自适应虚拟阻尼方程中的额定虚拟阻尼系数；将所述虚拟惯量、所述虚拟阻尼系数代入到所述自适应虚拟阻尼方程中，根据虚拟惯量和滤波参数得到自适应虚拟阻尼系数取值范围。2.如权利要求1所述的方法，其特征在于，所述混合储能虚拟同步机转子机械方程，表示为：其中，为虚拟角频率，为虚拟转动惯量，、分别为机械转矩、电磁转矩，为虚拟阻尼系数，为额定角频率，为有功功率参考值，为虚拟电磁功率，为虚拟功角，t表示时间。3.如权利要求2所述的方法，其特征在于，所述使用自适应虚拟阻尼代替混合储能转子机械方程中的虚拟阻尼系数，表示为：其中，为虚拟阻尼系数，为额定虚拟阻尼系数，为虚拟阻尼自适应系数，为虚拟阻尼最大调节倍数，为虚拟角频率偏差阈值，为虚拟角频率偏差，，为额定角频率。4.如权利要求3所述的方法，其特征在于，所述根据所述混合储能转子机械方程建立有功功率-频率下垂公式，表示为：其中，为虚拟角频率，为额定角频率，为一阶滤波器，为有功下垂系数，为有功功率参考值，为虚拟电磁功率。5.如权利要求4所述的方法，其特征在于，所述将建立的有功功率-频率下垂公式进行反拉普拉斯变换，表示为：其中，为虚拟角频率，为额定角频率，为滤波参数，为有功下垂系数，为有功功率参考值，为虚拟电磁功率。6.如权利要求5所述的方法，其特征在于，所述将所述混合储能转子机械方程转换为频率-功率形式，表示为：其中，为虚拟转动惯量，为虚拟角频率，为额定角频率，为有功功率参考值，为虚拟电磁功率。7.如权利要求6所述的方法，其特征在于，所述根据所述有功功率-频率下垂反拉普拉斯变换方程和混合储能转子机械方程频率-功率形式得到虚拟惯量、虚拟阻尼系数，表示为：其中，为虚拟转动惯量，为滤波参数，为有功下垂系数，为虚拟阻尼系数，为虚拟角频率。8.如权利要求7所述的方法，其特征在于，所述将所述混合储能转子机械方程频率-功率形式转化为虚拟转矩偏差表达式，表示为：其中，为有功功率参考值，为虚拟电磁功率，为虚拟角频率，为额定角频率，为额定虚拟阻尼系数，为虚拟角频率偏差，，为额定角频率，为虚拟转矩偏差。9.如权利要求8所述的方法，其特征在于，所述自适应虚拟阻尼方程中的额定虚拟阻尼系数，表示为：其中，为额定虚拟阻尼系数，为有功功率参考值，为虚拟转矩偏差，为虚拟角频率偏差，，为额定角频率，f为频率，Δf为频率变化范围。10.如权利要求9所述的方法，其特征在于，所述将所述虚拟惯量、所述虚拟阻尼系数代入到所述自适应虚拟阻尼方程，表示为：其中，为额定虚拟阻尼系数，为虚拟转动惯量，为滤波参数，为虚拟阻尼最大调节倍数，为虚拟角频率偏差，，为额定角频率。
说明书desc
技术领域本申请涉及储能控制技术领域，尤其涉及混合储能自适应虚拟阻尼参数整定方法。背景技术作为我国能源变革关键技术支撑之一的大规模储能技术，因为其可以为电网提供调峰、调频、应急响应等多种辅助服务，近年来受到了业内的广泛关注。分布式混合储能系统由蓄电池与超级电容组成，通过换流器与电网相连，具备功率双向流动能力，具有功率调节迅速、应用模式多样等优点。在混合储能系统中，蓄电池具有高能量密度特点但不适合频繁充放电，超级电容具有高功率密度优势。分布式混合储能系统因为其低惯性、低阻尼特性会对网侧的频率稳定性造成影响。为了使储能换流器控制系统具备如同步电机拥有的转动惯量和阻尼，目前广泛采用虚拟同步机控制技术，使其像同步发电机一样参与到电网频率和电压的调节中。发明内容本申请旨在至少在一定程度上解决相关技术中的技术问题之一。为此，本申请的第一个目的在于提出一种混合储能自适应虚拟阻尼参数整定方法，实现了混合储能最优功率控制。为达上述目的，本申请第一方面实施例提出了一种混合储能自适应虚拟阻尼参数整定方法，包括：建立混合储能虚拟同步机转子机械方程；使用自适应虚拟阻尼代替混合储能转子机械方程中的虚拟阻尼系数；根据混合储能转子机械方程建立有功功率-频率下垂公式，并将建立的有功功率-频率下垂公式进行反拉普拉斯变换，得到有功功率-频率下垂反拉普拉斯变换方程；将混合储能转子机械方程转换为频率-功率形式；根据有功功率-频率下垂反拉普拉斯变换方程和混合储能转子机械方程频率-功率形式得到虚拟惯量、虚拟阻尼系数；当控制系统稳态运行时，将混合储能转子机械方程频率-功率形式转化为虚拟转矩偏差表达式；根据虚拟转矩偏差表达式得到自适应虚拟阻尼方程中额定虚拟阻尼系数；将虚拟惯量、虚拟阻尼系数代入到自适应虚拟阻尼方程中，根据虚拟惯量和滤波参数得到自适应虚拟阻尼系数取值范围。本申请实施例的混合储能自适应虚拟阻尼参数整定方法，通过在混合储能控制系统中采用自适应虚拟阻尼控制，有效提高对功率振荡的抑制能力。可选地，在本申请的一个实施例中，混合储能虚拟同步机转子机械方程，表示为：其中，为虚拟角频率，为虚拟转动惯量，、分别为机械转矩、电磁转矩，为虚拟阻尼系数，为额定角频率，为有功功率参考值，为虚拟电磁功率，为虚拟功角，t表示时间。可选地，在本申请的一个实施例中，使用自适应虚拟阻尼代替混合储能转子机械方程中的虚拟阻尼系数，表示为：其中，为虚拟阻尼系数，为额定虚拟阻尼系数，为虚拟阻尼自适应系数，为虚拟阻尼最大调节倍数，为虚拟角频率偏差阈值，为虚拟角频率偏差，，为额定角频率。可选地，在本申请的一个实施例中，根据混合储能转子机械方程建立有功功率-频率下垂公式，表示为：其中，为虚拟角频率，为额定角频率，为一阶滤波器，为有功下垂系数，为有功功率参考值，为虚拟电磁功率。可选地，在本申请的一个实施例中，将建立的有功功率-频率下垂公式进行反拉普拉斯变换，表示为：其中，为虚拟角频率，为额定角频率，为滤波参数，为有功下垂系数，为有功功率参考值，为虚拟电磁功率。可选地，在本申请的一个实施例中，将混合储能转子机械方程转换为频率-功率形式，表示为：其中，为虚拟转动惯量，为虚拟角频率，为额定角频率，为有功功率参考值，为虚拟电磁功率。可选地，在本申请的一个实施例中，根据有功功率-频率下垂反拉普拉斯变换方程和混合储能转子机械方程频率-功率形式得到虚拟惯量、虚拟阻尼系数，表示为：其中，为虚拟转动惯量，为滤波参数，为有功下垂系数，为虚拟阻尼系数，为虚拟角频率。可选地，在本申请的一个实施例中，将混合储能转子机械方程频率-功率形式转化为虚拟转矩偏差表达式，表示为：其中，为有功功率参考值，为虚拟电磁功率，为虚拟角频率，为额定角频率，为额定虚拟阻尼系数，为虚拟角频率偏差，，为额定角频率，为虚拟转矩偏差。可选地，在本申请的一个实施例中，自适应虚拟阻尼方程中额定虚拟阻尼系数，表示为：其中，为额定虚拟阻尼系数，为有功功率参考值，为虚拟转矩偏差，为虚拟角频率偏差，，为额定角频率，f为频率，Δf为频率变化范围。可选地，在本申请的一个实施例中，将虚拟惯量、虚拟阻尼系数代入到自适应虚拟阻尼方程，表示为：其中，为额定虚拟阻尼系数，为虚拟转动惯量，为滤波参数，为虚拟阻尼最大调节倍数，为虚拟角频率偏差，，为额定角频率。本申请附加的方面和优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本申请的实践了解到。附图说明本申请上述的和/或附加的方面和优点从下面结合附图对实施例的描述中将变得明显和容易理解，其中：图1为本申请实施例一所提供的一种混合储能自适应虚拟阻尼参数整定方法的流程示意图；图2为本申请实施例的含有混合储能微网拓扑结构图；图3为本申请实施例的混合储能换流器拓扑及控制流程图。具体实施方式下面详细描述本申请的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，旨在用于解释本申请，而不能理解为对本申请的限制。下面参考附图描述本申请实施例的混合储能自适应虚拟阻尼参数整定方法。图1为本申请实施例一所提供的一种混合储能自适应虚拟阻尼参数整定方法的流程示意图。如图1所示，该混合储能自适应虚拟阻尼参数整定方法包括以下步骤：步骤101，建立混合储能虚拟同步机转子机械方程。步骤102，使用自适应虚拟阻尼代替混合储能转子机械方程中的虚拟阻尼系数。步骤103，根据混合储能转子机械方程建立有功功率-频率下垂公式，并将建立的有功功率-频率下垂公式进行反拉普拉斯变换，得到有功功率-频率下垂反拉普拉斯变换方程。步骤104：将混合储能转子机械方程转换为频率-功率形式。步骤105：根据有功功率-频率下垂反拉普拉斯变换方程和混合储能转子机械方程频率-功率形式得到虚拟惯量、虚拟阻尼系数。步骤106：当控制系统稳态运行时，将混合储能转子机械方程频率-功率形式转化为虚拟转矩偏差表达式。步骤107：根据虚拟转矩偏差表达式得到自适应虚拟阻尼方程中额定虚拟阻尼系数。步骤108：将虚拟惯量、虚拟阻尼系数代入到自适应虚拟阻尼方程中，根据虚拟惯量和滤波参数得到自适应虚拟阻尼系数取值范围。本申请实施例的混合储能自适应虚拟阻尼参数整定方法，通过在混合储能控制系统中采用自适应虚拟阻尼控制，有效提高对功率振荡的抑制能力。可选地，在本申请的一个实施例中，混合储能虚拟同步机转子机械方程，表示为：其中，为虚拟角频率，为虚拟转动惯量，、分别为机械转矩、电磁转矩，、，为虚拟阻尼系数，为额定角频率，为有功功率参考值，为虚拟电磁功率，在控制中，虚拟转动惯量使得混合储能换流器在功率和频率调节过程中具有了惯性，阻尼系数使得混合储能换流器具有抑制交流电网功率振荡的能力，为虚拟功角，t表示时间。可选地，在本申请的一个实施例中，为了实现混合储能最优功率控制，使用自适应虚拟阻尼代替混合储能虚拟同步机转子机械方程中的虚拟阻尼系数，表示为：其中，为虚拟阻尼系数，为额定虚拟阻尼系数，为虚拟阻尼自适应系数，为虚拟阻尼最大调节倍数，为虚拟角频率偏差阈值，为虚拟角频率偏差，，为额定角频率，当，自适应减少，快速响应增大/减少；当，快速增加限值，防止其进入失稳区。可选地，在本申请的一个实施例中，根据混合储能虚拟同步机转子机械方程建立有功功率-频率下垂公式，表示为：其中，为虚拟角频率，为额定角频率，为一阶滤波器，为有功下垂系数，为有功功率参考值，为虚拟电磁功率。可选地，在本申请的一个实施例中，将建立的有功功率-频率下垂公式进行反拉普拉斯变换，表示为：其中，为虚拟角频率，为额定角频率，为滤波参数，为有功下垂系数，为有功功率参考值，为虚拟电磁功率。可选地，在本申请的一个实施例中，将混合储能虚拟同步机转子机械方程转换为频率-功率形式，表示为：其中，为虚拟转动惯量，为虚拟角频率，为额定角频率，为有功功率参考值，为虚拟电磁功率。可选地，在本申请的一个实施例中，根据有功功率-频率下垂反拉普拉斯变换方程和混合储能转子机械方程频率-功率形式得到虚拟惯量、虚拟阻尼系数，表示为：其中，为虚拟转动惯量，为滤波参数，为有功下垂系数，为虚拟阻尼系数，为虚拟角频率。可选地，在本申请的一个实施例中，将混合储能转子机械方程频率-功率形式转化为虚拟转矩偏差表达式，表示为：其中，为有功功率参考值，为虚拟电磁功率，为虚拟角频率，为额定角频率，为额定虚拟阻尼系数，为虚拟角频率偏差，，为额定角频率，为虚拟转矩偏差。可选地，在本申请的一个实施例中，自适应虚拟阻尼方程中额定虚拟阻尼系数，表示为：其中，为额定虚拟阻尼系数，为有功功率参考值，为虚拟转矩偏差，为虚拟角频率偏差，，为额定角频率，f为频率，Δf为频率变化范围。当混合储能输出功率及频率变化范围已知情况，可以确定额定虚拟阻尼系数取值。可选地，在本申请的一个实施例中，将虚拟惯量、虚拟阻尼系数代入到自适应虚拟阻尼方程，可得：其中，为额定虚拟阻尼系数，为虚拟转动惯量，为滤波参数，为虚拟阻尼最大调节倍数，为虚拟角频率偏差，，为额定角频率。根据虚拟惯量和滤波参数得到自适应虚拟阻尼系数取值范围：。下面通过附图2详细描述本发明的另一实施例。如图2所示，负载通过换流器与直流母线相连，因为其有功出力波动性，需要配置由蓄电池和超级电容组成的混合储能设备，通过调节蓄电池有功功率、超级电容有功功率来平抑波动。当交流大电网发生频率振荡事故，功率振荡信号通过换流器传递至直流侧，需要混合储能具备频率振荡抑制能力。如图3所示，为直流母线电压；、为混合储能换流器交流侧三相电压、电流；为交流电网三相电压；、、、构成滤波电路。控制流程中，为虚拟角频率；为虚拟功角；为有功功率参考值；为虚拟电磁功率，无定子绕组损耗，又称控制输出功率；为虚拟机械功率；为中虚拟内电势；为无功功率实际输出值；为无功功率参考值。转子机械方程为：其中，为虚拟角频率，为虚拟转动惯量，、分别为机械转矩、电磁转矩，、，为虚拟阻尼系数，为额定角频率，为有功功率参考值，为虚拟电磁功率，在控制中，虚拟转动惯量使得混合储能换流器在功率和频率调节过程中具有了惯性，阻尼系数使得混合储能换流器具有抑制交流电网功率振荡的能力，t表示时间。为了实现混合储能最优功率控制，本发明采用自适应虚拟阻尼，自适应虚拟阻尼系数可表示为：上式中，为虚拟阻尼系数，为额定虚拟阻尼系数，为虚拟阻尼自适应系数，为虚拟阻尼最大调节倍数，为虚拟角频率偏差阈值，为虚拟角频率偏差，，为额定角频率，当，自适应减少，快速响应增大/减少；当，快速增加限值，防止其进入失稳区。在自适应虚拟阻尼系数表达式中，需要整定额定虚拟阻尼系数取值，自适应虚拟阻尼系数取值范围。根据上式，并引入有功下垂系数，可以得到下垂公式：上式中：为一阶滤波器。将上式反拉普拉斯变换后可得：第一个公式中的转子机械方程可写为：对比上述两个公式可以得到虚拟惯量、虚拟阻尼为：当控制系统稳态运行时，变化量为0，此时虚拟阻尼系数为额定虚拟阻尼系数，第五个公式又可写作：上式中，为虚拟转矩偏差。根据上式，可表示为：由上式可知，当混合储能输出功率及频率变化范围已知情况，可以确定额定虚拟阻尼系数取值。为了得到自适应虚拟阻尼系数取值范围，将第六个公式引入第二个公式自适应虚拟阻尼防失稳表达式中，可得：当控制系统稳态运行为定值，根据虚拟惯量和滤波参数可以确定，取值范围为：本发明取自适应虚拟阻尼系数=12，虚拟阻尼最大调节倍数=60。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、 “示例”、“具体示例”或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本申请的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本申请的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。流程图中或在此以其他方式描述的任何过程或方法描述可以被理解为，表示包括一个或更多个用于实现定制逻辑功能或过程的步骤的可执行指令的代码的模块、片段或部分，并且本申请的优选实施方式的范围包括另外的实现，其中可以不按所示出或讨论的顺序，包括根据所涉及的功能按基本同时的方式或按相反的顺序，来执行功能，这应被本申请的实施例所属技术领域的技术人员所理解。在流程图中表示或在此以其他方式描述的逻辑和/或步骤，例如，可以被认为是用于实现逻辑功能的可执行指令的定序列表，可以具体实现在任何计算机可读介质中，以供指令执行系统、装置或设备使用，或结合这些指令执行系统、装置或设备而使用。就本说明书而言，"计算机可读介质"可以是任何可以包含、存储、通信、传播或传输程序以供指令执行系统、装置或设备或结合这些指令执行系统、装置或设备而使用的装置。计算机可读介质的更具体的示例包括以下：具有一个或多个布线的电连接部，便携式计算机盘盒，随机存取存储器，只读存储器，可擦除可编辑只读存储器，光纤装置，以及便携式光盘只读存储器。另外，计算机可读介质甚至可以是可在其上打印所述程序的纸或其他合适的介质，因为可以例如通过对纸或其他介质进行光学扫描，接着进行编辑、解译或必要时以其他合适方式进行处理来以电子方式获得所述程序，然后将其存储在计算机存储器中。应当理解，本申请的各部分可以用硬件、软件、固件或它们的组合来实现。在上述实施方式中，多个步骤或方法可以用存储在存储器中且由合适的指令执行系统执行的软件或固件来实现。如，如果用硬件来实现和在另一实施方式中一样，可用本领域公知的下列技术中的任一项或他们的组合来实现：具有用于对数据信号实现逻辑功能的逻辑门电路的离散逻辑电路，具有合适的组合逻辑门电路的专用集成电路，可编程门阵列，现场可编程门阵列等。本技术领域的普通技术人员可以理解实现上述实施例方法携带的全部或部分步骤是可以通过程序来指令相关的硬件完成，所述的程序可以存储于一种计算机可读存储介质中，该程序在执行时，包括方法实施例的步骤之一或其组合。此外，在本申请各个实施例中的各功能单元可以集成在一个处理模块中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个模块中。上述集成的模块既可以采用硬件的形式实现，也可以采用软件功能模块的形式实现。所述集成的模块如果以软件功能模块的形式实现并作为独立的产品销售或使用时，也可以存储在一个计算机可读取存储介质中。上述提到的存储介质可以是只读存储器，磁盘或光盘等。尽管上面已经示出和描述了本申请的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本申请的限制，本领域的普通技术人员在本申请的范围内可以对上述实施例进行变化、修改、替换和变型。
