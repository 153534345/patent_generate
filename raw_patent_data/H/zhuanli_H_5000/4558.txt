标题title
一种空对地随机接入级联长前导序列检测方法
摘要abst
本发明请求保护一种空对地随机接入级联长前导序列检测方法，属于地空通信、非地面组网覆盖范围较广的技术领域。包括步骤：1.根据空对地覆盖半径求取随机接入前导序列的级联段数，级联前导序列选择的是相同的根不同的循环移位。2.将级联长前导序列的第一个短ZC序列变成其共轭序列。3.改进的级联长前导序列的ZC共轭根序列作为接收端的本地ZC序列，将前两个ZC根序列相同的差分间隔进行两两共轭相乘作为本地差分序列，接收序列相似变化作为待检差分序列，接收信号序列经过多普勒频移，本地差分序列与待检差分序列进行时域周期相关检测生成功率时延谱。4.从PDP中获取相关峰值，根据相关峰值计算出各个用户的定时提前量TA值。
权利要求书clms
1.一种空对地随机接入级联长前导序列检测方法，其特征在于，包括以下步骤：根据空对地ATG覆盖半径求取随机接入前导序列的级联段数，级联前导序列选择的是相同的根不同的循环移位；将级联长前导序列的第一个短ZC序列变成其共轭序列，方便与其他序列进行区分，称为改进的级联前导序列；改进的级联长前导序列的ZC共轭根序列作为接收端的本地ZC序列，将前两个ZC根序列相同的差分间隔进行两两共轭相乘作为本地差分序列，接收序列相似变化作为待检差分序列，接收信号序列经过多普勒频移的，本地差分序列与待检差分序列进行时域周期相关检测生成功率时延谱PDP，即PDP运算；从PDP中获取相关峰值，根据相关峰值计算出各个用户的定时提前量TA值。2.根据权利要求1所述的一种空对地随机接入级联长前导序列检测方法，其特征在于，所述根据空对地ATG覆盖半径求取随机接入前导序列的级联段数，级联前导序列选择的是相同的根不同的循环移位，具体包括：根据空对地ATG覆盖半径求出随机接入前导帧结构中循环前缀时长TCP、序列时长TSEQ以及保护间隔时长TGT，具体公式为：TCP≥TRTD+τds TGT＝TRTD TSEQ≥TCP其中TRTD表示覆盖范围内终端发送端与基站接收端之间往返时延，τds表示时延扩展；当空对地ATG覆盖半径要求为300km条件下，根据循环前缀CP时长、序列SEQ时长及保护时间GT时长公式计算出各自时长分别为2ms、2.4ms及2ms。根据覆盖半径仍为300km条件，能够通过公式计算得出长前导序列长度，并根据公式计算得出级联段数为3，其中，k为整数，TRTD表示覆盖范围内终端发送端与基站接收端之间往返时延，如公式所示；TSEQ表示5G系统中前导格式1中序列时长，如公式所示。其中TLS表示长前导序列时长，TSYS表示上行符号持续时间；TLS＝kTSEQ TSEQ＝kTSYS TRTD＝6.67us/kmTSEQ＝0.8ms。3.根据权利要求1所述的一种空对地随机接入级联长前导序列检测方法，其特征在于，所述将级联长前导序列的第一个短ZC序列变成其共轭序列，其中级联长前导序列X'如式所示，将第一个短ZC序列变成其共轭序列后的级联长前导序列X如式所示，具体包括：其中经过共轭运算后，X如式所示。其中，NZC表示前导序列长度，本文长度值为839。4.根据权利要求1-3任一项所述的一种空对地随机接入级联长前导序列检测方法，其特征在于，使用改进的级联长前导的单序列检测算法设计检测数学模型Ps如式所示，其中级联长前导序列X如式所示，接收序列r如式所示。其中，xn，xn+1，xn+2...xNzc表示接受端本地ZC序列，xn和x*n+1表示两两共轭相乘构成本地差分序列，d表示定时索引时刻，rn+d，rn+d+1，rn+d+2...rNzc+d表示接收端在定时位置的接收序列，n取值在范围内，xn，xn+1，xn+2...xNzc属于级联长前导X的第一个序列。ρ代表信道增益，τ为信道时延，ε为子载波间隔归一化频偏，w代表均值为0方差为σ2的高斯白噪声。由于w不会影响ZC序列的抗偏特性分析，为了计算方便，下文的检测算法计算中忽略噪声项。将式代入式，在正确的定时位置d处，Ps可以进一步如式所示。当d＝τ时，式变为式；Ps表示在定时位置d等于信道时延τ时的单序列检测算法设计检测数学模型；根据式能看出单序列的长前导序列的设计率偏移部分为一常数项该项进行取模获取PDP谱值为1，因此频率偏移对正确的PDP峰值位置不产生影响；产生的本地差分序列不再具有零自相关性质。5.根据权利要求4所述的一种空对地随机接入级联长前导序列检测方法，其特征在于，所述使用改进的级联长前导的单序列检测算法单序列检测算法设计转变为使用改进的级联长前导的前两个序列检测算法设计，级联长前导的前两个序列检测算法设计本地差分序列与接收公式，可根据将上述本地联合差分矩阵P与接收差分矩阵Rd对应元素相乘，再将相同差分间隔行数的元素合并，即可得到定时索引d处的联合差分互相关函数。6.根据权利要求5所述的一种空对地随机接入级联长前导序列检测方法，其特征在于，所述级联长前导的前两个序列检测算法设计本地差分序列与接收公式，具体包括：其中x表示长前导序列的第一个序列，x表示长前导序列的第二个序列，n取值在范围内。x*x表示第一个序列与第二个序列两两共轭相乘构成本地差分矩阵。r与r表示接收端在定时位置的接收序列。r*r接收序列两两共轭相乘构成接收端差分矩阵；所述将本地联合差分矩阵P与接收差分矩阵Rd对应元素相乘，联合差分互相关函数如式所示，其中l表示不同的差分间隔行数，l＝0，1，2...L,L＝NZC-1。步骤2-2.根据步骤2-1的联合差分互相关函数如式，在准确的定时位置时，即当d＝τ时，式变为式；由式可以看出频率偏移项经过取模运算后，该项同样变成一个常数，因此该算法也可以去除CFO对相关函数的影响；本地序列和接收序列进行相关的相关长度增大了NZC倍。7.根据权利要求6所述的一种空对地随机接入级联长前导序列检测方法，其特征在于，所述从PDP中获取相关峰值，根据相关峰值计算出各个用户的定时提前量TA值，具体包括：当接收端通过前导检测得到PDP后，需要进一步提取PDP中的相关峰值并根据相关峰值计算得到各个用户的TA值。本节从理论上说明如何根据PDP中的相关峰值得到用户的TA值。不失一般性，假设UE选择发送的前导序列是由根序列x经过循环得到的，即x，根序列x如式所示。其中，NCS是循环移位间隔，k取值是正整数；假设前导序列经过的信道为平坦衰落信道，忽略频偏的影响，接收端接收的序列信号如式所示：y＝ρx+w其中，ρ为信道增益，w表示高斯白噪声，τ为信道时延。将式代入式，可得时间索引m处的相关检测函数C如式为：CW是噪声与本地序列相关运算得到的，这个值远远小于相关峰值，看作附加噪声。ZC序列性质得知|x|2＝1。当πu/NZC＝0的时候，|C|相关峰值达到最大值，峰值的位置是m＝modNZC。PDP峰值检测原理：根据峰值的位置m1＝modNZC，能够发现当信道时延τ为0时，峰值位置为m2＝modNZC，峰值位置和循环移位NCS有关；当信道时延τ不为0时，峰值位置会随τ的不同而发生位置偏移，发生位置偏移多少可以由当前位置与τ为0时的位置之差得到，即可以求出信道时延τ，也就是TA值，TA如式所示。TA＝modNZC-modNZC＝m1-m2 综上所述，能够根据峰值位置计算得到TA值。
说明书desc
技术领域本发明属于空对地通信、沙漠海洋甚至卫星等覆盖半径较大、多普勒频移较大及信噪比较低的场景，具体设计到超广覆盖随机接入级联长前导序列检测算法研究。背景技术民航空地宽带通信系统为旅客和机组提供宽带服务。空地宽带系统主要分为两类，一类是基于卫星的宽带接入，另一类是基于地面基站的宽带接入。基于卫星的宽带接入具有覆盖范围广、通信频带宽及通信容量大等优点，应用范围及广，适合国际航班。基于地面基站的宽带接入沿着航线规划基站，在陆上航线同等覆盖面积下，相比于卫星宽带接入，空对地通信系统带宽更大，成本更低，适合国内航班。将5G技术应用到ATG系统中，相当于把地面上的基站搬移天上覆盖终端 ，能够使飞机上的用户可以像在地面一样高流量使用。但是该场景设计存在很多问题需要解决，如时间提前量估计补偿、多普勒频移消除等。机上用户通信属于上行通信，首先进行的是随机接入，随机接入技术是基于5G ATG宽带接入系统的重点研究之一。基于5G的ATG研究国内正处于研究阶段，其中中国移动、中国电信及中兴通讯在ATG研究要求覆盖半径均为300km，移动速度高达1200km/h，由于飞机飞行速度较高，产生的多普勒频移较大，影响随机接入性能。目前关于在多普勒频移影响下的检测算法研究，主要有两种方案，一种是增大子载波间隔来提前抑制多普勒频移影响，另一种是级联的两个ZC序列进行共轭计算抑制多普勒频移影响。但是，以上两种检测算法研究都是基于地面低速场景的使用，飞机速度高达1200km/h，多普勒频移较大，现有方法无法满足该场景，需要重新设计一种能够适应该场景的随机接入检测算法。本文讨论5G ATG覆盖范围更广，传输时延较大，多普勒频移较大，所以，综上所述随机接入前导检测算法需要重新设计。经过检索，最接近的现有技术中，一种大面积覆盖下的随机接入方法。该发明用在卫星场景的广覆盖，使用的依旧是5G随机接入前导序列结构，根据往返时延差分区域设置多个检测窗口获得峰值，不通电在于与本发明在一个检测窗口中获得峰值。专利“一种在NR-5G中利用PRACH 信号估算定时提前量TA的优化方法”发明通过对 PRACH的839点序列在频域与基序列做共轭相乘后，通过4096点IFFT转换到时域，利用4096点时域功率谱计算TA，提高TA精度，避免让UE调整信号太靠前，避免基站收到Msg3有ISI干扰。专利“一种4G-LTE地空宽带通信系统及方法”发明可以实现飞机与地面基站一直处于连接状态，相邻两个地面基站之间可以进行自己切换信号，保证飞机与地面基站之间的信号不中断，增加了飞机飞行过程中的信号覆盖范围，旅客可以畅通连续的上网。本发明优点在于首先是基于5G只需要一个检测窗口就能得到准确的检测峰值位置，进而能够计算得到TA值，并且可以抑制多普勒频移的影响。发明内容本发明旨在解决以上现有技术的问题。提出了一种空对地随机接入级联长前导序列检测方法。本发明的技术方案如下：一种空对地随机接入级联长前导序列检测方法，其包括以下步骤：根据空对地ATG覆盖半径求取随机接入前导序列的级联段数，级联前导序列选择的是相同的根不同的循环移位；将级联长前导序列的第一个短ZC序列变成其共轭序列，方便与其他序列进行区分，称为改进的级联前导序列；改进的级联长前导序列的ZC共轭根序列作为接收端的本地ZC序列，将前两个ZC根序列相同的差分间隔进行两两共轭相乘作为本地差分序列，接收序列相似变化作为待检差分序列，接收信号序列经过多普勒频移的，本地差分序列与待检差分序列进行时域周期相关检测生成功率时延谱PDP，即PDP运算；从PDP中获取相关峰值，根据相关峰值计算出各个用户的定时提前量TA 值。进一步的，所述根据空对地ATG覆盖半径求取随机接入前导序列的级联段数，级联前导序列选择的是相同的根不同的循环移位，具体包括：根据空对地ATG覆盖半径求出随机接入前导帧结构中循环前缀时长TCP、序列时长TSEQ以及保护间隔时长TGT，具体公式为：TCP≥TRTD+τds TGT＝TRTDTSEQ≥TCP 其中TRTD表示覆盖范围内终端发送端与基站接收端之间往返时延，τds表示时延扩展。当空对地ATG覆盖半径要求为300km条件下，根据循环前缀CP时长、序列SEQ时长及保护时间GT时长公式计算出各自时长分别为2ms、2.4ms及2ms。根据覆盖半径仍为300km条件，能够通过公式计算得出长前导序列长度，并根据公式计算得出级联段数为3，其中，k为整数，TRTD表示覆盖范围内终端发送端与基站接收端之间往返时延，如公式所示。TSEQ表示5G系统中前导格式1中序列时长，如公式所示。其中TLS表示长前导序列时长，TSYS表示上行符号持续时间。TLS＝kTSEQ TSEQ＝kTSYSTRTD＝6.67us/kmTSEQ＝0.8ms2、进一步的，所述将级联长前导序列的第一个短ZC序列变成其共轭序列，其中级联长前导序列X'如式所示，将第一个短ZC序列变成其共轭序列后的级联长前导序列X如式所示，具体包括：其中经过共轭运算后，X如式所示。其中，NZC表示前导序列长度，本文长度值为839。使用改进的级联长前导的单序列检测算法设计检测数学模型Ps如式 所示，其中级联长前导序列X如式所示，接收序列r如式所示。其中，xn，xn+1，xn+2...xNzc表示接受端本地ZC序列，xn和x*n+1表示两两共轭相乘构成本地差分序列，d表示定时索引时刻，rn+d，rn+d+1，rn+d+2...rNzc+d表示接收端在定时位置的接收序列，n取值在范围内， xn，xn+1，xn+2...xNzc属于级联长前导X的第一个序列。ρ代表信道增益，τ为信道时延，ε为子载波间隔归一化频偏，w代表均值为0方差为σ2的高斯白噪声。由于w不会影响ZC序列的抗偏特性分析，为了计算方便，下文的检测算法计算中忽略噪声项。将式代入式，在正确的定时位置d处，Ps可以进一步如式 所示。当d＝τ时，式变为式；Ps表示在定时位置d等于信道时延τ时的单序列检测算法设计检测数学模型。进一步的，所述使用改进的级联长前导的单序列检测算法单序列检测算法设计转变为使用改进的级联长前导的前两个序列检测算法设计，级联长前导的前两个序列检测算法设计本地差分序列与接收公式，可根据将上述本地联合差分矩阵C与接收差分矩阵Rd对应元素相乘，再将相同差分间隔行数的元素合并，即可得到定时索引d处的联合差分互相关函数。进一步的，所述级联长前导的前两个序列检测算法设计本地差分序列与接收公式，具体包括：其中x表示长前导序列的第一个序列，x表示长前导序列的第二个序列，n取值在范围内。x*x表示第一个序列与第二个序列两两共轭相乘构成本地差分矩阵。r与r表示接收端在定时位置的接收序列。r*r接收序列两两共轭相乘构成接收端差分矩阵。所述将本地联合差分矩阵P与接收差分矩阵Rd对应元素相乘，联合差分互相关函数如式所示，其中l表示不同的差分间隔行数，l＝0，1，2...L,L＝NZC-1。步骤2-2.根据步骤2-1的联合差分互相关函数如式，在准确的定时位置时，即当d＝τ时，式变为式。由式可以看出频率偏移项经过取模运算后，该项同样变成一个常数，因此该算法也可以去除CFO对相关函数的影响；本地序列和接收序列进行相关的相关长度增大了NZC倍。进一步的，所述从PDP中获取相关峰值，根据相关峰值计算出各个用户的定时提前量TA值，具体包括：当接收端通过前导检测得到PDP后，需要进一步提取PDP中的相关峰值并根据相关峰值计算得到各个用户的TA值。本节从理论上说明如何根据PDP中的相关峰值得到用户的TA值。不失一般性，假设UE选择发送的前导序列是由根序列x经过循环得到的，即x，NCS是循环移位间隔，k取值是正整数。假设前导序列经过的信道为平坦衰落信道，忽略频偏的影响，接收端接收的序列信号如式所示：y＝ρx+w其中，ρ为信道增益，w表示AWGN噪声，τ为信道时延。将式代入式，可得时间索引m处的相关检测函数C如式为：CW是噪声与本地序列相关运算得到的，这个值远远小于相关峰值，看作附加噪声。ZC序列性质得知|x|2＝1。当πu/NZC＝0的时候，|C|相关峰值达到最大值，峰值的位置是m＝modNZC。图8表示PDP峰值检测原理图，根据峰值的位置m1＝modNZC，能够发现当信道时延τ为0时，峰值位置为m2＝modNZC，峰值位置和循环移位NCS有关；当信道时延τ不为0时，峰值位置会随τ的不同而发生位置偏移，发生位置偏移多少可以由当前位置与τ为0时的位置之差得到，即可以求出信道时延τ，也就是TA值，TA如式所示。TA＝modNZC-modNZC＝m1-m2 综上所述，能够根据峰值位置计算得到TA值。本发明的优点及有益效果如下：本发明提出了一种空对地随机接入级联长前导序列检测算法设计与研究。现有的是基于5G的地面研究，对于如何抵消多普勒频移的影响，多普勒频移影响的具体体现在载波频率偏移大小。LTE系统及5G系统采用的主要是两种方案，一种是增大子载波间隔，因为系统能够容纳的最大的载波频率偏移可大子载波间隔的一半。另一种是级联的两个ZC序列共轭，与接收序列进行PDP计算能够抵消多普勒频移的影响。但是，以上的两个方法使用场景是低速的地面场景，低速也意味着多普勒频移较小，不适用与多普勒较大的ATG场景。所以，本发明一种空对地随机接入级联长前导序列检测算法设计与研究成为解决这些难题的有效方法。具体表现：针对航空信道多普勒频移较大的特点提出一种基于多序列差分相关检测算法，本地级联序列的前两个序列差分共轭，接收序列进行相似变换，通过差分共轭的本地序列和接收序列再进行共轭计算，检测函数能够得到唯一的峰值，较好的克服了多普勒频移影响。理论分析和仿真结果表明，通过使用长前导序列及本文提出的多序列联合差分检测算法，能够较好的满足5G ATG较大覆盖半径和较大多普勒频移要求。附图说明图1空对地随机接入级联长前导序列检测方法流程图；图2是本发明提供优选实施例级联长前导序列格式；图3同根不同循环移位的前导发送流程图；图4基于单序列差分检测的双序列定时检测；图5不同接收SNR以及不同归一化频偏下的误检概率；图6基于双序列差分检测的双序列定时检测；图7 SNR＝-16dB下不同相关长度及不同归一化频偏下的误检概率；图8 PDP峰值检测原理示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、详细地描述。所描述的实施例仅仅是本发明的一部分实施例。本发明解决上述技术问题的技术方案是：本发明的目的是提供一种空对地随机接入级联长前导序列检测算法设计与研究，用于ATG等广覆盖，高速度场景。以ATG覆盖半径为300km，飞行速度为1000km/h，载波频率为3.5GHz，最大多普勒频移为3.24kHz。多普勒效应是指发射端与接收端直接存在相对运动的时候，二者互相接近时接收频率变高，而远离时接收频率变低的物理现象。多普勒频偏即发射端与接收机直接的相对运动引起信号在频域上的扩展。多普勒频移大小见式。其中fd是多普勒频移大小，f是载波频率，v是飞机速度，θ是飞机飞向基站方向飞行水平线与基站的夹角，c是无线电传播速度，c＝3*10^8m/s。通过式能够知道，当移动速度已知时，最大的多普勒频偏位于是垂直夹角处。参阅表1，对于飞机高速飞行移动场景下的随机接入前导进行检测，对比分析算法的检测性能。系统的仿真参数如表1所示。参阅图2图3，图2所示的级联长前导序列格式以及同根不同循环移位的前导发送流程图是本文随机接入检测算法的基础。本文算法计算的前提使用的就是级联的相同根不同循环移位的前导序列。参阅图4，图4为两径莱斯信道中联合差分双序列检测函数曲线，其中信噪比为-5dB，传播时延对应于1200，归一化频偏为3。如图4所示，能够看出没有发生峰值位置偏移与峰值能量泄漏。如图4所示，单序列仿真定时检测函数有一个冲击明显的峰值，峰值位置仍在正确的定时位置。参阅图5，以误检概率作为评价指标，验证单序列定时检测算法算法在抗频偏性能和抗噪性能。图5表示单序列定时检测算法的误检概率仿真曲线，自变量是接收信噪比SNR不同，归一化频偏不同的情况下，因变量是误检概率仿真曲线。首先，能够从图5中看到，归一化频偏增大，但是自身的误检概率并没有发生多大的变化，所以能够得出该算法抗噪性能良好。然后，也能够从图5 中看到，在信噪比低的情况，如图中-16dB，该序列算法中的误检概率约等于1，所以可以得出单序列检测算法能够抵抗多普勒频偏的影响，但是在信噪比低的情况下，误检概率接近100％，所以不适合用在低信噪比的环境中。原因是级联的前导差分检测算法中差分序列xk*xk+1不再满足和ZC序列一样的零自相关性质，PDP相关峰值容易受到噪声影响，所以该算法抗噪性能差，定时检测性能在低信噪比环境下严重降低。ATG通信系统信噪比较低，所以需要研究一种能够满足ATG环境的定时检测算法。xk*xk+1零自相关证明如下：假设k＝0；则发送序列如公式，接收序列如式。X＝xk*xk+1R＝ρX+w 那么二者相关运算如式所示。继续计算化简为式。由得知当d＝τ且d＝τ+NZC时，PDP才会出现峰值。d＝τ与d＝τ+NZC不能同时满足。所以差分序列不具有良好的相关性能。参阅图6，给出在两径莱斯信道中联合差分双序列检测函数曲线，其中信噪比为-5dB，传播时延对应于1200，归一化频偏为3，相关行数L为2。如图6 所示，能够看出没有发生峰值位置偏移与峰值能量泄漏。如图6所示，双序列仿真定时检测函数有一个冲击明显的峰值，峰值位置仍在正确的定时位置。参阅图7，给出在两径莱斯信道中联合差分双序列检测函数曲线，信噪比选择-16dB，在相关行数L为1、2、4、8下不同频偏的误检概率，图6中可以看出，在相同的相关行数下，误检概率不受频偏影响，并且相关长度越大，误检概率越小。与图5相比，选择合适的相关行数，误检概率在较低信噪比下也能够小于1％。这是因为相关行数增大，复杂度增大，定时检测性能越好。表1上述实施例阐明的系统、装置、模块或单元，具体可以由计算机芯片或实体实现，或者由具有某种功能的产品来实现。一种典型的实现设备为计算机。具体的，计算机例如可以为个人计算机、膝上型计算机、蜂窝电话、相机电话、智能电话、个人数字助理、媒体播放器、导航设备、电子邮件设备、游戏控制台、平板计算机、可穿戴设备或者这些设备中的任何设备的组合。计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存、静态随机存取存储器、动态随机存取存储器、其他类型的随机存取存储器、只读存储器、电可擦除可编程只读存储器、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘 或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。按照本文中的界定，计算机可读介质不包括暂存电脑可读媒体，如调制的数据信号和载波。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。以上这些实施例应理解为仅用于说明本发明而不用于限制本发明的保护范围。在阅读了本发明的记载的内容之后，技术人员可以对本发明作各种改动或修改，这些等效变化和修饰同样落入本发明权利要求所限定的范围。
