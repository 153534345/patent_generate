标题title
用于联邦学习和隐私计算的密钥分级管理方法及装置
摘要abst
本申请涉及一种用于联邦学习和隐私计算的密钥分级管理方法及装置。在联邦学习和隐私计算技术领域的各种应用中，该方法及装置实现了防止密钥泄露和克服重启等因素导致密钥丢失的问题，同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。
权利要求书clms
1.一种密钥分级管理方法，用于联邦学习和隐私计算，其特征在于，所述密钥分级管理方法包括：通过根密钥管理服务器，基于非对称加密算法生成第一公钥私钥对，并将所述第一公钥私钥对的公钥发送给具有第一执行环境的第一参与方；通过所述第一参与方的第一执行环境，利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的第一执行环境的第二执行环境；响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息。2.根据权利要求1所述的密钥分级管理方法，其特征在于，所述第一执行环境是可信执行环境TEE，所述第二执行环境是非TEE。3.根据权利要求2所述的密钥分级管理方法，其特征在于，所述第一执行环境和所述第二执行环境不位于同一地理位置、同一平台、同一系统、同一局域网或者同一机器。4.根据权利要求2所述的密钥分级管理方法，其特征在于，所述第二执行环境是磁盘、外部存储器、云上存储资源、云服务器或者共享服务器。5.根据权利要求1至4中任一项所述的密钥分级管理方法，其特征在于，该机密信息包括业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识中的至少一项。6.根据权利要求5所述的密钥分级管理方法，其特征在于，该业务密钥包括业务根密钥和基于该业务根密钥生成的至少一个业务子密钥，该业务根密钥用于加密所述第一参与方通过所述第一执行环境执行的业务流程的整体，该至少一个业务子密钥用于加密所述第一参与方通过所述第一执行环境执行该业务流程的过程中所述第一参与方获得的待处理业务数据和/或已处理业务数据，该中间阶段处理结果是所述第一参与方通过所述第一执行环境执行该业务流程的过程中所述第一参与方获得的中间结果，该最终结果是该业务流程执行完成后所述第一参与方获得的最终结果。7.根据权利要求6所述的密钥分级管理方法，其特征在于，该会话是所述第一参与方通过所述第一执行环境进行的会话，该口令包括所述第一参与方通过所述第一执行环境生成的口令，该授权文件包括所述第一参与方通过所述第一执行环境生成的授权签名，该交互标识包括至少一个第二参与方的标识，其中所述第一参与方通过所述第一执行环境与该至少一个第二参与方进行数据交互，其中，所述待处理业务数据和所述已处理业务数据均与所述第一参与方所参与的联邦学习任务关联，该会话发生在所述第一参与方和该至少一个第二参与方之间，该至少一个第二参与方参与所述联邦学习任务。8.根据权利要求1至4中任一项所述的密钥分级管理方法，其特征在于，所述根密钥管理服务器将所述第一公钥私钥对的公钥以明文形式发送给所述第一参与方。9.根据权利要求1至4中任一项所述的密钥分级管理方法，其特征在于，所述根密钥管理服务器对所述第一公钥私钥对的公钥和私钥均通过用户口令进行加密并将加密后的公钥和私钥存储在第三执行环境。10.根据权利要求9所述的密钥分级管理方法，其特征在于，所述密钥分级管理方法还包括：响应于所述根密钥管理服务器丢失所述第一公钥私钥对，所述根密钥管理服务器从所述第三执行环境获得该加密后的公钥和私钥，并利用所述用户口令进行解密从而恢复所述第一公钥私钥对。11.根据权利要求1至4中任一项所述的密钥分级管理方法，其特征在于，该机密信息的加密结果是第一加密结果，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，基于非对称加密算法生成第二公钥私钥对，并将所述第二公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的所述第一执行环境，利用所述第二公钥私钥对的公钥加密该第一加密结果得到第二加密结果，并将该第二加密结果存储在所述第二执行环境。12.根据权利要求11所述的密钥分级管理方法 ，其特征在于，利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息，包括：利用所述第二公钥私钥对的私钥对该第二加密结果进行解密从而恢复该第一加密结果，然后利用所述第一公钥私钥对的私钥对该第一加密结果进行解密从而恢复该机密信息。13.根据权利要求1至4中任一项所述的密钥分级管理方法，其特征在于，该机密信息的加密结果是第一加密结果，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，基于非对称加密算法生成第二公钥私钥对，并将所述第二公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的所述第一执行环境，利用所述第二公钥私钥对的公钥加密该机密信息得到第三加密结果，并将该第三加密结果存储在所述第二执行环境。14.根据权利要求13所述的密钥分级管理方法 ，其特征在于，利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息，包括：利用所述第一公钥私钥对的私钥对该第一加密结果或者该第三加密结果进行解密从而恢复该机密信息。15.根据权利要求1所述的密钥分级管理方法 ，其特征在于，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，在恢复该机密信息之后，利用所述第一公钥私钥对的私钥加密该机密信息得到第一重加密结果，然后利用与所述第一参与方协商生成的临时对称密钥对该第一重加密结果进行加密得到第二重加密结果，以及将该第二重加密结果和所述第一公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的第一执行环境，利用该临时对称密钥对该第二重加密结果进行解密然后利用所述第一公钥私钥对的公钥进行解密，从而获得该机密信息。16.一种非瞬时性计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机指令，该计算机指令被处理器执行时实现根据权利要求1至15中任一项所述的方法。17.一种电子设备，其特征在于，所述电子设备包括：处理器；用于存储处理器可执行指令的存储器；其中，所述处理器通过运行所述可执行指令以实现根据权利要求1至15中任一项所述的方法。18.一种密钥分级管理装置，用于联邦学习和隐私计算，所述密钥分级管理装置位于第一参与方的第一执行环境，其特征在于，所述密钥分级管理装置包括：接收模块，用于从根密钥管理服务器接收第一公钥私钥对的公钥，其中，所述第一公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成；加密模块，用于利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的所述第一执行环境的第二执行环境；恢复模块，用于：响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并从所述根密钥管理服务器接收所述根密钥管理服务器利用所述第一公钥私钥对的私钥进行解密从而恢复的该机密信息。19.根据权利要求18所述的密钥分级管理装置，其特征在于，所述第一执行环境是TEE，所述第二执行环境是非TEE。20.根据权利要求18所述的密钥分级管理装置，其特征在于，所述第二执行环境是磁盘、外部存储器、云上存储资源、云服务器或者共享服务器，该机密信息包括业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识中的至少一项。21.根据权利要求18至20中任一项所述的密钥分级管理装置，其特征在于，所述根密钥管理服务器对所述第一公钥私钥对的公钥和私钥均通过用户口令进行加密并将加密后的公钥和私钥存储在第三执行环境，以及，响应于所述根密钥管理服务器丢失所述第一公钥私钥对，所述根密钥管理服务器从所述第三执行环境获得该加密后的公钥和私钥，并利用所述用户口令进行解密从而恢复所述第一公钥私钥对。22.根据权利要求18至20中任一项所述的密钥分级管理装置，其特征在于，该机密信息的加密结果是第一加密结果，所述加密模块还用于：通过所述第一参与方的所述第一执行环境，利用第二公钥私钥对的公钥加密该第一加密结果得到第二加密结果，并将该第二加密结果存储在所述第二执行环境，其中所述第二公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成。23.根据权利要求18至20中任一项所述的密钥分级管理装置，其特征在于，该机密信息的加密结果是第一加密结果，所述加密模块还用于：通过所述第一参与方的所述第一执行环境，利用第二公钥私钥对的公钥加密该机密信息得到第三加密结果，并将该第三加密结果存储在所述第二执行环境，其中所述第二公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成。
说明书desc
技术领域本申请涉及数据安全和隐私保护技术领域，尤其涉及联邦学习和隐私计算技术领域，具体涉及一种用于联邦学习和隐私计算的密钥分级管理方法及装置。背景技术随着对数据安全和个人信息隐私的日益重视，隐私计算技术和联邦学习技术取得了巨大的发展。隐私计算指的是在保护隐私信息安全前提下进行数据相关计算及分析和挖掘数据价值。联邦学习指的是拥有数据的各个参与方，在无需共享数据资源且数据不出本地的前提下，通过加密的方式进行加密后数据的联合训练从而协同优化共享机器学习模型而实现多赢合作。在联邦学习应用场景中，各个拥有数据的参与方通常采用加密处理的方式对原始数据进行加密，再将加密后的密态数据或者叫做密文用在联合网络模型训练、梯度计算、模型参数训练等。这里，加密处理所需要用到的密钥是日后从密文中恢复原始数据的关键。因此，密钥泄露问题和因服务器重启而导致的密钥丢失问题也成为了联邦学习和隐私计算技术领域的关键问题。如果发生密钥泄露问题，则可能导致密文被未授权甚至恶意方获取后解密得到原始数据。如果发生因服务器重启而导致的密钥丢失，则会影响使用这些密钥的程序。例如海光处理器所提供的TEE方案，数据在内存中处于加密状态但是数据一旦离开内存写入到磁盘或者发送至网络就不再处于加密状态，因此需要将敏感数据使用密钥加密后再写入磁盘或者通过网络发送，并将密钥存储在TEE中的内存中来保证敏感数据离开内存后的安全性。但是这样的方式在存储密钥的设备因不可抗力的干扰而重启并导致内存中的密钥丢失时，则可能无法恢复被加密的敏感数据。通过将密钥固化在应用程序中并将该应用程序一起写入磁盘，虽然这样可以利用磁盘里的应用程序恢复被加密的敏感数据，但是却又引入了应用程序被破解而导致密钥泄露的安全隐患。面临上述各种挑战，为此需要一种用于联邦学习和隐私计算的密钥分级管理方法及装置。发明内容第一方面，本申请实施例提供了一种密钥分级管理方法，用于联邦学习和隐私计算。所述密钥分级管理方法包括：通过根密钥管理服务器，基于非对称加密算法生成第一公钥私钥对，并将所述第一公钥私钥对的公钥发送给具有第一执行环境的第一参与方；通过所述第一参与方的第一执行环境，利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的第一执行环境的第二执行环境；响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息。第一方面所描述的技术方案，借助了第二执行环境来存储该机密信息的加密结果的至少一部分从而可以利用第一执行环境以外的外部资源，因为存储在第二执行环境的是该机密信息的加密结果从而有效保护数据安全和隐私，因为是用基于非对称加密算法生成的所述第一公钥私钥对的公钥来加密该机密信息从而有效克服了因密钥泄露而导致的安全风险，并且当发生该机密信息的丢失的情况下能通过该根密钥管理服务器来恢复该机密信息，进而在联邦学习和隐私计算技术领域的各种应用中实现了防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述第一执行环境是可信执行环境TEE，所述第二执行环境是非TEE。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述第一执行环境和所述第二执行环境不位于同一地理位置、同一平台、同一系统、同一局域网或者同一机器。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述第二执行环境是磁盘、外部存储器、云上存储资源、云服务器或者共享服务器。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，该机密信息包括业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识中的至少一项。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，该业务密钥包括业务根密钥和基于该业务根密钥生成的至少一个业务子密钥，该业务根密钥用于加密所述第一参与方通过所述第一执行环境执行的业务流程的整体，该至少一个业务子密钥用于加密所述第一参与方通过所述第一执行环境执行该业务流程的过程中所述第一参与方获得的待处理业务数据和/或已处理业务数据，该中间阶段处理结果是所述第一参与方通过所述第一执行环境执行该业务流程的过程中所述第一参与方获得的中间结果，该最终结果是该业务流程执行完成后所述第一参与方获得的最终结果。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，该会话是所述第一参与方通过所述第一执行环境进行的会话，该口令包括所述第一参与方通过所述第一执行环境生成的口令，该授权文件包括所述第一参与方通过所述第一执行环境生成的授权签名，该交互标识包括至少一个第二参与方的标识，其中所述第一参与方通过所述第一执行环境与该至少一个第二参与方进行数据交互，其中，所述待处理业务数据和所述已处理业务数据均与所述第一参与方所参与的联邦学习任务关联，该会话发生在所述第一参与方和该至少一个第二参与方之间，该至少一个第二参与方参与所述联邦学习任务。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述根密钥管理服务器将所述第一公钥私钥对的公钥以明文形式发送给所述第一参与方。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述根密钥管理服务器对所述第一公钥私钥对的公钥和私钥均通过用户口令进行加密并将加密后的公钥和私钥存储在第三执行环境。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述密钥分级管理方法还包括：响应于所述根密钥管理服务器丢失所述第一公钥私钥对，所述根密钥管理服务器从所述第三执行环境获得该加密后的公钥和私钥，并利用所述用户口令进行解密从而恢复所述第一公钥私钥对。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，该机密信息的加密结果是第一加密结果，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，基于非对称加密算法生成第二公钥私钥对，并将所述第二公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的所述第一执行环境，利用所述第二公钥私钥对的公钥加密该第一加密结果得到第二加密结果，并将该第二加密结果存储在所述第二执行环境。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息，包括：利用所述第二公钥私钥对的私钥对该第二加密结果进行解密从而恢复该第一加密结果，然后利用所述第一公钥私钥对的私钥对该第一加密结果进行解密从而恢复该机密信息。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，该机密信息的加密结果是第一加密结果，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，基于非对称加密算法生成第二公钥私钥对，并将所述第二公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的所述第一执行环境，利用所述第二公钥私钥对的公钥加密该机密信息得到第三加密结果，并将该第三加密结果存储在所述第二执行环境。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息，包括：利用所述第一公钥私钥对的私钥对该第一加密结果或者该第三加密结果进行解密从而恢复该机密信息。根据第一方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，在恢复该机密信息之后，利用所述第一公钥私钥对的私钥加密该机密信息得到第一重加密结果，然后利用与所述第一参与方协商生成的临时对称密钥对该第一重加密结果进行加密得到第二重加密结果，以及将该第二重加密结果和所述第一公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的第一执行环境，利用该临时对称密钥对该第二重加密结果进行解密然后利用所述第一公钥私钥对的公钥进行解密，从而获得该机密信息。第二方面，本申请实施例提供了一种非瞬时性计算机可读存储介质。所述计算机可读存储介质存储有计算机指令，该计算机指令被处理器执行时实现根据第一方面中任一项所述的方法。第二方面所描述的技术方案，借助了第二执行环境来存储该机密信息的加密结果的至少一部分从而可以利用第一执行环境以外的外部资源，因为存储在第二执行环境的是该机密信息的加密结果从而有效保护数据安全和隐私，因为是用基于非对称加密算法生成的所述第一公钥私钥对的公钥来加密该机密信息从而有效克服了因密钥泄露而导致的安全风险，并且当发生该机密信息的丢失的情况下能通过该根密钥管理服务器来恢复该机密信息，进而在联邦学习和隐私计算技术领域的各种应用中实现了防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。第三方面，本申请实施例提供了一种电子设备。所述电子设备包括：处理器；用于存储处理器可执行指令的存储器；其中，所述处理器通过运行所述可执行指令以实现根据第一方面中任一项所述的方法。第三方面所描述的技术方案，借助了第二执行环境来存储该机密信息的加密结果的至少一部分从而可以利用第一执行环境以外的外部资源，因为存储在第二执行环境的是该机密信息的加密结果从而有效保护数据安全和隐私，因为是用基于非对称加密算法生成的所述第一公钥私钥对的公钥来加密该机密信息从而有效克服了因密钥泄露而导致的安全风险，并且当发生该机密信息的丢失的情况下能通过该根密钥管理服务器来恢复该机密信息，进而在联邦学习和隐私计算技术领域的各种应用中实现了防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。第四方面，本申请实施例提供了一种密钥分级管理装置，用于联邦学习和隐私计算，所述密钥分级管理装置位于第一参与方的第一执行环境。所述密钥分级管理装置包括：接收模块，用于从根密钥管理服务器接收第一公钥私钥对的公钥，其中，所述第一公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成；加密模块，用于利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的所述第一执行环境的第二执行环境；恢复模块，用于：响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并从所述根密钥管理服务器接收所述根密钥管理服务器利用所述第一公钥私钥对的私钥进行解密从而恢复的该机密信息。第四方面所描述的技术方案，借助了第二执行环境来存储该机密信息的加密结果的至少一部分从而可以利用第一执行环境以外的外部资源，因为存储在第二执行环境的是该机密信息的加密结果从而有效保护数据安全和隐私，因为是用基于非对称加密算法生成的所述第一公钥私钥对的公钥来加密该机密信息从而有效克服了因密钥泄露而导致的安全风险，并且当发生该机密信息的丢失的情况下能通过该根密钥管理服务器来恢复该机密信息，进而在联邦学习和隐私计算技术领域的各种应用中实现了防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。根据第四方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述第一执行环境是TEE，所述第二执行环境是非TEE。根据第四方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述第二执行环境是磁盘、外部存储器、云上存储资源、云服务器或者共享服务器，该机密信息包括业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识中的至少一项。根据第四方面的技术方案的一种可能的实现方式，本申请实施例还提供了，所述根密钥管理服务器对所述第一公钥私钥对的公钥和私钥均通过用户口令进行加密并将加密后的公钥和私钥存储在第三执行环境，以及，响应于所述根密钥管理服务器丢失所述第一公钥私钥对，所述根密钥管理服务器从所述第三执行环境获得该加密后的公钥和私钥，并利用所述用户口令进行解密从而恢复所述第一公钥私钥对。根据第四方面的技术方案的一种可能的实现方式，本申请实施例还提供了，该机密信息的加密结果是第一加密结果，所述加密模块还用于：通过所述第一参与方的所述第一执行环境，利用第二公钥私钥对的公钥加密该第一加密结果得到第二加密结果，并将该第二加密结果存储在所述第二执行环境，其中所述第二公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成。根据第四方面的技术方案的一种可能的实现方式，本申请实施例还提供了，该机密信息的加密结果是第一加密结果，所述加密模块还用于：通过所述第一参与方的所述第一执行环境，利用第二公钥私钥对的公钥加密该机密信息得到第三加密结果，并将该第三加密结果存储在所述第二执行环境，其中所述第二公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成。附图说明为了说明本申请实施例或背景技术中的技术方案，下面将对本申请实施例或背景技术中所需要使用的附图进行说明。图1示出了本申请实施例提供的用于联邦学习和隐私计算的密钥分级管理方法的流程示意图。图2示出了本申请实施例提供的用于联邦学习和隐私计算的密钥分级管理装置的框图。图3示出了本申请实施例提供的用于图1所示的密钥分级管理方法的电子设备的框图。图4示出了本申请实施例提供的根密钥管理服务器和TEE之间交互过程的示意图。具体实施方式本申请实施例为了解决上述的密钥泄露问题和因服务器重启而导致的密钥丢失问题，这样的技术难题，提出了一种用于联邦学习和隐私计算的密钥分级管理方法及装置。其中，所述密钥分级管理方法包括：通过根密钥管理服务器，基于非对称加密算法生成第一公钥私钥对，并将所述第一公钥私钥对的公钥发送给具有第一执行环境的第一参与方；通过所述第一参与方的第一执行环境，利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的第一执行环境的第二执行环境；响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息。本申请实施例具有以下有益技术效果：在联邦学习和隐私计算技术领域的各种应用中实现了防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。本申请实施例可用于以下应用场景，包括但是不限于，多方安全计算、与联邦学习有关的机器学习模型训练、数据安全、隐私保护或者应用隐私计算框架或算法的其它应用场景等。本申请实施例可以依据具体应用环境进行调整和改进，此处不做具体限定。为了使本技术领域的人员更好地理解本申请方案，下面将结合本申请实施例中的附图，对本申请的实施例进行描述。图1示出了本申请实施例提供的用于联邦学习和隐私计算的密钥分级管理方法的流程示意图。如图1所示，密钥分级管理方法包括以下步骤。步骤S102：通过根密钥管理服务器，基于非对称加密算法生成第一公钥私钥对，并将所述第一公钥私钥对的公钥发送给具有第一执行环境的第一参与方。步骤S104：通过所述第一参与方的第一执行环境，利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的第一执行环境的第二执行环境。步骤S106：响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息。在联邦学习和隐私计算技术领域的各种应用中，经常需要用到加密解密处理，而与加密解密处理有关的密钥的管理是保护数据安全和隐私信息的关键。密钥泄露可能导致未授权方甚至恶意方破解加密数据并造成隐私泄露。此外，存储密钥的设备如服务器、计算机等可能遇到不可抗力的干扰而重启，这样就可能导致存储在内存中的密钥丢失或者受到破坏，从而影响正在使用以及后续可能使用这些密钥的程序。另一方面，如果安排加解密程序和密钥都运行存储在安全可靠的执行环境，如可信执行环境，则需要占用大量的存储资源，这是因为加密后的数据往往有较大的位宽如1比特的原始数据经同态加密处理后可能占用1024比特的位宽。而且要求仅在安全可靠的执行环境下运行存储加解密程序和密钥，也无法充分利用可行的各种云计算资源、云网络、云存储资源、云计算中心等，这样不利于降低成本和快速部署。一种做法是用密钥加密数据并将加密后的数据存入外部磁盘中，并将密钥保存在TEE中，例如海光处理器所提供的TEE方案将敏感数据加密后写入磁盘或者通过网络发送，并将密钥存储在TEE中的内存中，数据在内存中处于加密状态但是写入到磁盘或者发送至网络过程中会被解密。但是这样的方式在存储密钥的设备因不可抗力的干扰而重启并导致内存中的密钥丢失时，则可能无法恢复被加密的敏感数据。通过将密钥固化在应用程序中并将该应用程序一起写入磁盘，虽然这样可以利用磁盘里的应用程序恢复被加密的敏感数据，但是却又引入了应用程序被破解而导致密钥泄露的安全隐患。因此，需要在防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源。请参阅步骤S102至步骤S106，第一参与方具有第一执行环境，该第一执行环境可以理解为第一参与方执行联邦学习和隐私计算各种应用、算法、框架、算法的软硬件环境。在一种可能的实施方式中，该第一执行环境可以是满足TEE要求的运行环境，例如满足安全隔离要求以及对代码和资源访问实施严格保护等。在一些实施例中，第一参与方具有的该第一执行环境可以是基于ARM TrustZone的TEE方案，或者可以是基于Intel SGX的TEE方案，或者可以是基于AMD SEV的TEE方案，或者可以是其他任意的TEE方案。在另一种可能的实施方式中，该第一执行环境可以是非TEE的运行环境，例如该第一执行环境是常规操作系统。无论第一参与方具有的该第一执行环境是TEE或者非TEE，第一参与方在运行存储加解密程序和管理密钥时，如果全部通过该第一执行环境来进行操作，则受限于该第一执行环境有限的软硬件资源而且也没有充分利用外部的可用资源。但是借助外部可用资源时，则需要考虑如何保护密钥不被泄露以及外部可用资源的安全性和访问控制都难以保证的可能性。为此，在步骤S102，通过根密钥管理服务器，基于非对称加密算法生成第一公钥私钥对，并将所述第一公钥私钥对的公钥发送给具有第一执行环境的第一参与方。其中，非对称加密算法可以是例如RSA算法或者椭圆曲线密码学算法或者任意合适的非对称加密算法。基于非对称加密算法生成的第一公钥私钥对，其中该第一公钥私钥对包括成对的公钥和私钥，并且同一对的公钥私钥对中的公钥用于加密而私钥用于解密经公钥加密的数据，而且如果公钥和私钥不属于同一对的话则无法完成解密操作。因此，在生成该第一公钥私钥对之后，将其中的公钥发送给具有第一执行环境的第一参与方。在一些实施例中，所述根密钥管理服务器将所述第一公钥私钥对的公钥以明文形式发送给所述第一参与方。在另一些实施例中，所述根密钥管理服务器将所述第一公钥私钥对的公钥以加密方式如基于临时加密协议以密文形式发送给所述第一参与方。临时加密协议可以是通过协商生成的临时会话密钥并用该临时会话密钥进行加密。在步骤S102之后，执行步骤S104，通过所述第一参与方的第一执行环境，利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的第一执行环境的第二执行环境。其中，机密信息可以是任意合适的需要保护的数据、敏感数据、个人信息等。例如，机密信息可以是业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识或者任意其他合适的信息。关于机密信息的说明会在下面进一步详细描述。这里，在第一参与方处，通过第一参与方所具有的第一执行环境，利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的第一执行环境的第二执行环境。在一些实施例中，第二执行环境可以与第一执行环境均属于第一参与方但是保持彼此独立，这样做是为了避免当第一执行环境遭遇死机、重启等情况而导致第一执行环境中的机密信息丢失时不会同时导致第二执行环境也遭遇同样问题。例如，第一执行环境和第二执行环境可以是属于第一参与方的彼此独立运作的两台机器，并且可能还具有彼此独立的供电系统。在另一些实施例中，第二执行环境可以不属于第一参与方。或者第二执行环境与第一执行环境不位于同一地理位置、同一平台、同一系统、同一局域网或者同一机器。如此，一方面借助了第二执行环境来存储该机密信息的加密结果的至少一部分从而可以利用第一执行环境以外的外部资源，另一方面因为存储在第二执行环境的是该机密信息的加密结果从而有效保护数据安全和隐私，并且因为是用基于非对称加密算法生成的所述第一公钥私钥对的公钥来加密该机密信息从而有效克服了因密钥泄露而导致的安全风险。换句话说，如果在数据交互、通讯或者对第二执行环境进行的存取操作中发生了密钥泄露，也只会泄露所述第一公钥私钥对的公钥，但是如上面所述，只有所述第一公钥私钥对的私钥能用来解密该机密信息的加密结果，从而有效克服了因密钥泄露而导致的安全风险。此外，当第一参与方或者说第一参与方具有的第一执行环境受到不可抗力的干扰，例如因为停电、跳闸、电网浪涌等电力供应条件的变化或者因雷电、地震等自然条件的变化而导致服务器、计算机或者其他承载第一执行环境的设备死机、重启或者终止响应等，这些都可能导致第一执行环境中存储的信息受到破坏或者丢失。而通过将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的第一执行环境的第二执行环境，则可以后续进行恢复操作来恢复受到破坏或者丢失的信息。这一点下面结合步骤S106详细说明。在步骤S104之后，执行步骤S106，响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息。这里，该机密信息的丢失可能是部分丢失或者全部丢失，也包括受到破坏而无法正确读取的情况。造成该机密信息的丢失的可能原因，可以是上面提到第一参与方或者说第一参与方具有的第一执行环境受到不可抗力的干扰的各种情形，如停电、跳闸、电网浪涌等电力供应条件的变化或者因雷电、地震等自然条件的变化，还可以是其他任意可能的情形，只要能影响到承载第一执行环境的设备或者软硬件环境的正常运行并且因此导致无法正确完整地获取该机密信息。例如，其他的可能导致该机密信息的丢失的情形，还可以包括例如受到恶意病毒或者木马程序的攻击从而导致内存中数据受到破坏甚至是不可逆的破坏，如在物理磁盘层面进行的不可逆删除操作等。当第一参与方或者该第一执行环境发生了该机密信息的丢失，响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，这里可以是通过第一参与方执行或者通过第二执行环境的主体来具体实施。在一些实施例中，响应于该机密信息的丢失，第一参与方可以告知第二执行环境的主体例如承载第二执行环境的服务器或计算机并指示第二执行环境将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器。在另一些实施例中，响应于该机密信息的丢失，第一参与方可以告知第二执行环境的主体并指示第二执行环境将存储在所述第二执行环境的该机密信息的加密结果发送给第一参与方，然后再由第一参与方将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器。也就是说，第二执行环境可以直接将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，也可以经由第一参与方或者第一参与方所具有的第一执行环境进行中转，在此不做具体限定，只要能实现将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器。接着，在步骤S106，通过该根密钥管理服务器，利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息。上面提到，在步骤S102中，该根密钥管理服务器在生成该第一公钥私钥对之后，将其中的公钥发送给具有第一执行环境的第一参与方，而其中的私钥则不离开该根密钥管理服务器。因此只有根密钥管理服务器可以利用该私钥进行解密，并且只有所述第一公钥私钥对的私钥能用来解密该机密信息的加密结果，这样就通过根密钥管理服务器与第一参与方的第一执行环境之间的隔离，有效避免了密钥泄露的同时还使得后续能进行恢复操作来恢复受到破坏或者丢失的信息。并且，一般情况下，根密钥管理服务器应位于可靠的运行环境例如位于满足TEE要求的运行环境中。总之，参阅上述的步骤S102至步骤S106，借助了第二执行环境来存储该机密信息的加密结果的至少一部分从而可以利用第一执行环境以外的外部资源，因为存储在第二执行环境的是该机密信息的加密结果从而有效保护数据安全和隐私，因为是用基于非对称加密算法生成的所述第一公钥私钥对的公钥来加密该机密信息从而有效克服了因密钥泄露而导致的安全风险，并且当发生该机密信息的丢失的情况下能通过该根密钥管理服务器来恢复该机密信息，进而在联邦学习和隐私计算技术领域的各种应用中实现了防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。在一种可能的实施方式中，所述第一执行环境是可信执行环境TEE，所述第二执行环境是非TEE。如此，可以利用第二执行环境也就是非TEE来存储该机密信息的加密结果的部分或者全部。这样还可以进一步地利用各种非TEE的外部资源，例如云计算资源、云网络、云存储资源、云计算中心等。此外，面对运算需求较高或者数据量较大的任务，第一执行环境也就是TEE所能提供的物理存储空间有限，可能无法将所有需要保护的数据都存储在TEE中，这时候也需要利用外部资源如外部磁盘、云资源等来分担一部分存储的负担。如此，可以利用非TEE的第二执行环境来配合TEE的第一执行环境，在确保密钥不被泄露和能克服密钥丢失风险的前提下，等效于拓展了TEE的存储能力，突破了TEE自身所具有的物理存储空间的局限。并且，非TEE的第二执行环境，不仅可以作为额外的存储空间，而且还作为当TEE的第一执行环境遇到不可抗力如重启、死机等而导致其中存储的机密信息丢失的情况下的数据恢复手段。在一种可能的实施方式中，所述第一执行环境和所述第二执行环境不位于同一地理位置、同一平台、同一系统、同一局域网或者同一机器。其中，第二执行环境不同于所述第一参与方的第一执行环境，因此避免当第一执行环境遭遇死机、重启等情况而导致第一执行环境中的机密信息丢失时不会同时导致第二执行环境也遭遇同样问题。为了更好地保持第二执行环境和第一执行环境之间的隔离或者说相互独立性，可以进一步要求不位于同一地理位置、同一平台、同一系统、同一局域网或者同一机器。例如，第二执行环境和第一执行环境可以分别承载在两台不同的计算机上且彼此具有相互独立的供电系统等。在一种可能的实施方式中，所述第二执行环境是磁盘、外部存储器、云上存储资源、云服务器或者共享服务器。如上所述，无论第一执行环境是否为TEE，第二执行环境都是不同于第一执行环境从而保持相互独立也避免第二执行环境与第一执行环境因同样的不可抗力的干扰而丢失所存储信息。并且，第二执行环境对应了相对于第一执行环境的外部资源。例如，第二执行环境可以是磁盘，并用于存储密钥和第一执行环境在处理数据过程中生成的阶段结果以及最终结果等。再例如，第二执行环境可以是云上存储资源、云服务器或者云计算中心等基于云的运行环境，包括公有云和私有云。另外，有些时候需要进行异地容灾备份，包括对业务数据和用于加密业务数据的密钥都进行异地备份，这一点也可以通过在异地部署第二执行环境例如采用位于异地的云上存储资源来实现。再例如，第二执行环境可以是共享服务器例如共享存储服务器，可以将加密后的机密信息存储到局域网内共享存储服务器，并通过共享存储服务器提供定时备份功能。在一种可能的实施方式中，该机密信息包括业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识中的至少一项。应当理解的是，机密信息可以是任意合适的需要保护的数据、敏感数据、个人信息等。其中，业务密钥是用来对业务数据，包括待处理业务数据和已处理业务数据进行加密的密钥。业务数据是第一参与方在进行联邦学习和隐私计算的各种业务流程时所面对的各种数据。例如，设第一参与方要与其他参与方协同训练联邦学习模型，则业务数据可以是训练数据和参数等。业务密钥用于加密业务数据，加密后的业务数据可以存储在内存、磁盘或者其他合适的地方，还可以通过通信接口发送给其他参与方或者管理方、仲裁方等。取决于具体的隐私计算技术的解决方案、安全协议、联邦学习框架等因素，业务数据的内涵和定义可以有所不同，在此不做具体限定。业务密钥的泄露可能导致加密后的业务数据被破解并泄露隐私，而业务密钥的丢失则可能影响后续流程的进行。为此，通过将包括业务密钥的机密信息的加密结果存储在第二执行环境，就可以克服这些不足。另外，机密信息还可以包括业务流程处理过程中所生成的中间阶段处理结果以及业务流程执行完毕后的最终结果。另外，机密信息还可以包括会话，或者说第一参与方与其他参与方之间进行的一般意义上的通话、交流等，可以是语音聊天方式也可以是文字信息形式，还可以是任意合适的会话形式和组织方式。另外，机密信息还可以是授权文件，例如数字证书、电子签名等。另外，机密信息还可以是交互标识，用于标记或者识别与第一参与方在同一个联邦学习任务或者属于同一个联邦学习合作网络的其他方。以上这些机密信息的示例仅为说明性，还可以包括任意其他合适的机密信息的示例。通过将这些类型的机密信息的加密结果存储在第二执行环境，在确保机密信息的安全性和隐私性同时，还分担了第一执行环境的存储压力，也在第一执行环境遭遇不可抗力的干扰时提供了恢复的选项。其中业务密钥可以分成业务根密钥和基于该业务根密钥生成的至少一个业务子密钥，业务根密钥对应业务流程整体，而业务子密钥则对应业务流程中的某个环节或者某个步骤，一个业务流程可以有多个业务子密钥。在一些实施例中，业务密钥包括其中的业务根密钥和业务子密钥、中间阶段处理结果以及最终结果，这些可以对应同一个业务流程。具体地，该业务密钥包括业务根密钥和基于该业务根密钥生成的至少一个业务子密钥，该业务根密钥用于加密所述第一参与方通过所述第一执行环境执行的业务流程的整体，该至少一个业务子密钥用于加密所述第一参与方通过所述第一执行环境执行该业务流程的过程中所述第一参与方获得的待处理业务数据和/或已处理业务数据，该中间阶段处理结果是所述第一参与方通过所述第一执行环境执行该业务流程的过程中所述第一参与方获得的中间结果，该最终结果是该业务流程执行完成后所述第一参与方获得的最终结果。在一些实施例中，上述的各种机密信息的示例可以对应同一个联邦学习任务，或者说每个由第一参与方参与的联邦学习任务都可以有各自对应的机密信息。具体地，该会话是所述第一参与方通过所述第一执行环境进行的会话，该口令包括所述第一参与方通过所述第一执行环境生成的口令，该授权文件包括所述第一参与方通过所述第一执行环境生成的授权签名，该交互标识包括至少一个第二参与方的标识，其中所述第一参与方通过所述第一执行环境与该至少一个第二参与方进行数据交互，其中，所述待处理业务数据和所述已处理业务数据均与所述第一参与方所参与的联邦学习任务关联，该会话发生在所述第一参与方和该至少一个第二参与方之间，该至少一个第二参与方参与所述联邦学习任务。如此，针对同一个联邦学习任务，可以将所涉及到的会话、授权文件以及交互标识中的一个或者多个或者全部都作为机密信息。在一种可能的实施方式中，所述根密钥管理服务器将所述第一公钥私钥对的公钥以明文形式发送给所述第一参与方。如上所述，还可以采用加密通信方式或者密文形式等发送该公钥给第一参与方。因为是基于非对称加密算法生成的，所以有效地避免了密钥泄露带来的安全风险。在一种可能的实施方式中，所述根密钥管理服务器对所述第一公钥私钥对的公钥和私钥均通过用户口令进行加密并将加密后的公钥和私钥存储在第三执行环境。这里，用户口令可以是随机生成的例如通过随机种子或者随机算法生成，也可以是用户输入的，或者可以通过任意合适的方式。通过用户口令来加密所述第一公钥私钥对的公钥和私钥并将加密后的公钥和私钥存储在第三执行环境，这样当根密钥管理服务器遇到不可抗力的干扰而导致存储在根密钥管理服务器的所述第一公钥私钥对丢失时，可以通过用户口令来从第三执行环境恢复所述第一公钥私钥对。这样就在上述的针对第一参与方的机密信息提供数据恢复功能的基础上，还针对根密钥管理服务器所生成的所述第一公钥私钥对也提供数据恢复功能。应当理解的是，这样的双重数据恢复功能，涉及到在第一参与方的第一执行环境、不同于第一执行环境的第二执行环境、根密钥管理服务器以及第三执行环境。这些运行环境或者承载其功能的机器设备，彼此之间有所区别，至少不会因为其中一个的死机或重启而必然导致另一个的死机或重启，或者说不会出现连锁反应而导致同时多个出现死机或重启。在一些实施例中，在第一参与方的第一执行环境、不同于第一执行环境的第二执行环境、根密钥管理服务器以及第三执行环境彼此之间互相隔离且有独立的运行机制和供电系统，这样有利于进一步提升数据安全性。在一些实施例中，所述密钥分级管理方法还包括：响应于所述根密钥管理服务器丢失所述第一公钥私钥对，所述根密钥管理服务器从所述第三执行环境获得该加密后的公钥和私钥，并利用所述用户口令进行解密从而恢复所述第一公钥私钥对。如此，通过用户口令来加密存储公钥私钥，可以有效应对根密钥管理服务器可能遭遇的不可抗力的干扰。在一种可能的实施方式中，该机密信息的加密结果是第一加密结果，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，基于非对称加密算法生成第二公钥私钥对，并将所述第二公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的所述第一执行环境，利用所述第二公钥私钥对的公钥加密该第一加密结果得到第二加密结果，并将该第二加密结果存储在所述第二执行环境。这里，第二公钥私钥对是用于加密已经利用第一公钥私钥对加密得到的第一加密结果。也就是说，利用第一公钥私钥对来加密该机密信息得到该加密信息的加密结果也即第一加密结果，再利用第二公钥私钥对来加密该第一加密结果从而得到第二加密结果。这样的二重加密机制，使得后续解密是必须同时利用第一公钥私钥对和第二公钥私钥对，并且缺少其中任意一个都无法完成解密。并且，因为第二公钥私钥对也是基于非对称加密算法生成，所以有效克服了密钥泄露风险。在一些实施例中，利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息，包括：利用所述第二公钥私钥对的私钥对该第二加密结果进行解密从而恢复该第一加密结果，然后利用所述第一公钥私钥对的私钥对该第一加密结果进行解密从而恢复该机密信息。如此，在利用了第二公钥私钥对来进行二重加密的情况下，解密时需要按照加密次序的反向次序，也就是先利用所述第二公钥私钥对的私钥对该第二加密结果进行解密从而恢复该第一加密结果，然后利用所述第一公钥私钥对的私钥对该第一加密结果进行解密从而恢复该机密信息。应当理解的是，还可以有第三重加密、第四重加密或者更多层次的加密，每个新增的加密层次都是在已加密的结果基础上用新生成的公钥私钥对来进行加密。在一种可能的实施方式中，该机密信息的加密结果是第一加密结果，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，基于非对称加密算法生成第二公钥私钥对，并将所述第二公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的所述第一执行环境，利用所述第二公钥私钥对的公钥加密该机密信息得到第三加密结果，并将该第三加密结果存储在所述第二执行环境。这里，第二公钥私钥对是用于加密该机密信息并得到第三加密结果，这样得到的第三加密结果和利用第一公钥私钥对加密该机密信息得到的第一加密结果，都是对同样的机密信息进行加密得到的，所以是镜像加密机制，也就是分别利用第一公钥私钥对和第二公钥私钥对针对同样的机密信息进行加密分别得到第一加密结果和第三加密结果。这样的镜像加密机制，使得后续可以通过第一加密结果或者第三加密结果来恢复该机密信息。在一些实施例中，该第三加密结果也就是镜像加密机制的加密结果，可以存储在第二执行环境也可以存储在其他地方从而当第二执行环境遇到不可抗力的干扰时还能提供额外的恢复功能。在一些实施例中，利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息，包括：利用所述第一公钥私钥对的私钥对该第一加密结果或者该第三加密结果进行解密从而恢复该机密信息。在一种可能的实施方式中，所述密钥分级管理方法还包括：通过所述根密钥管理服务器，在恢复该机密信息之后，利用所述第一公钥私钥对的私钥加密该机密信息得到第一重加密结果，然后利用与所述第一参与方协商生成的临时对称密钥对该第一重加密结果进行加密得到第二重加密结果，以及将该第二重加密结果和所述第一公钥私钥对的公钥发送给所述第一参与方；通过所述第一参与方的第一执行环境，利用该临时对称密钥对该第二重加密结果进行解密然后利用所述第一公钥私钥对的公钥进行解密，从而获得该机密信息。上面提到，当该机密信息丢失时，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并利用所述第一公钥私钥对的私钥进行解密从而恢复该机密信息。在该机密信息被解密恢复之后，接着，根密钥管理服务器利用所述第一公钥私钥对的私钥加密该机密信息得到第一重加密结果，这一点区别于上述步骤S104中所提及的，通过所述第一参与方的第一执行环境，利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果。然后，根密钥管理服务器利用与所述第一参与方协商生成的临时对称密钥对该第一重加密结果进行加密得到第二重加密结果。临时对称密钥是基于对称加密算法生成，例如可以采用椭圆曲线迪菲-赫尔曼秘钥交换来生成并共享对称加密的密钥如ECDH协商临时密钥。临时对称密钥还可以是一般采用的在双方之间建立临时会话用的共有加密资料。然后，根密钥管理服务器将该第二重加密结果和所述第一公钥私钥对的公钥发送给所述第一参与方。接下来，通过所述第一参与方的第一执行环境，利用该临时对称密钥对该第二重加密结果进行解密然后利用所述第一公钥私钥对的公钥进行解密，从而获得该机密信息。如此，确保了第一公钥私钥对的私钥没有离开根密钥管理服务器，而第一参与方可以通过公钥来解密并获得该机密信息，同时还利用临时对称密钥保护了第一重加密结果以及其中的机密信息，从而在第一参与方恢复了丢失的机密信息。应当理解的是，上述方法可以通过相应的执行主体或者载体来实现。在一些示例性实施例中，一种非瞬时性计算机可读存储介质，所述计算机可读存储介质存储有计算机指令，该计算机指令被处理器执行时实现上述方法以及上述任意实施例、实施方式或者它们的组合。在一些示例性实施例中，一种电子设备，包括：处理器；用于存储处理器可执行指令的存储器；其中，所述处理器通过运行所述可执行指令以实现上述方法以及上述任意实施例、实施方式或者它们的组合。图2示出了本申请实施例提供的用于联邦学习和隐私计算的密钥分级管理装置的框图。所述密钥分级管理装置位于第一参与方的第一执行环境。如图2所示，所述密钥分级管理装置包括：接收模块210，用于从根密钥管理服务器接收第一公钥私钥对的公钥，其中，所述第一公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成；加密模块220，用于利用所述第一公钥私钥对的公钥加密机密信息得到该机密信息的加密结果，并将该机密信息的加密结果的至少一部分存储在不同于所述第一参与方的所述第一执行环境的第二执行环境；恢复模块230，用于：响应于该机密信息的丢失，将存储在所述第二执行环境的该机密信息的加密结果发送给所述根密钥管理服务器，并从所述根密钥管理服务器接收所述根密钥管理服务器利用所述第一公钥私钥对的私钥进行解密从而恢复的该机密信息。图2所示的密钥分级管理装置，包括其中各个部件，借助了第二执行环境来存储该机密信息的加密结果的至少一部分从而可以利用第一执行环境以外的外部资源，因为存储在第二执行环境的是该机密信息的加密结果从而有效保护数据安全和隐私，因为是用基于非对称加密算法生成的所述第一公钥私钥对的公钥来加密该机密信息从而有效克服了因密钥泄露而导致的安全风险，并且当发生该机密信息的丢失的情况下能通过该根密钥管理服务器来恢复该机密信息，进而在联邦学习和隐私计算技术领域的各种应用中实现了防止密钥泄露和克服重启等因素导致密钥丢失的同时还能利用可行的各种外部资源，有利于保护数据安全和隐私信息以及降低成本和部署时间。在一种可能的实施方式中，所述第一执行环境是TEE，所述第二执行环境是非TEE。在一种可能的实施方式中，所述第二执行环境是磁盘、外部存储器、云上存储资源、云服务器或者共享服务器，该机密信息包括业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识中的至少一项。在一种可能的实施方式中，所述根密钥管理服务器对所述第一公钥私钥对的公钥和私钥均通过用户口令进行加密并将加密后的公钥和私钥存储在第三执行环境，以及，响应于所述根密钥管理服务器丢失所述第一公钥私钥对，所述根密钥管理服务器从所述第三执行环境获得该加密后的公钥和私钥，并利用所述用户口令进行解密从而恢复所述第一公钥私钥对。在一种可能的实施方式中，该机密信息的加密结果是第一加密结果，所述加密模块还用于：通过所述第一参与方的所述第一执行环境，利用第二公钥私钥对的公钥加密该机密信息得到第三加密结果，并将该第三加密结果存储在所述第二执行环境，其中所述第二公钥私钥对由所述根密钥管理服务器基于非对称加密算法生成。图3示出了本申请实施例提供的用于图1所示的密钥分级管理方法的电子设备的框图。该电子设备可以运行在根密钥管理服务器或者第一参与方的TEE。如图3所示，电子设备包括主处理器302，内部总线304，网络接口306，主存储器308，以及辅助处理器310和辅助内存312，还有辅助处理器320和辅助内存322。其中，主处理器302与主存储器308连接，主存储器308可用于存储主处理器302可执行的计算机指令，从而可以实现图1所示的密钥分级管理方法，包括其中部分或者全部步骤，也包括其中步骤的任意可能的组合或结合以及可能的替换或者变体。网络接口306用于提供网络连接以及通过网络收发数据。内部总线304用于提供在主处理器302、网络接口306、辅助处理器310以及辅助处理器320之间的内部的数据交互。其中，辅助处理器310与辅助内存312连接并一起提供辅助计算能力，而辅助处理器320与辅助内存322连接并一起提供辅助计算能力。辅助处理器310和辅助处理器320可以提供相同或者不同的辅助计算能力，包括但是不限于，针对特定计算需求进行优化的计算能力如并行处理能力或者张量计算能力，针对特定算法或者逻辑结构进行优化的计算能力例如迭代计算能力或者图计算能力等。辅助处理器310和辅助处理器320可以包括特定类型的一个或者多个处理器，如数字信号处理器，专用集成电路，现场可编程门阵列等，从而可以提供定制化的功能和结构。在一些示例性实施例中，电子设备可以不包括辅助处理器，可以包括仅一个辅助处理器，还可以包括任意数量的辅助处理器且各自具有相应的定制化功能及结构，在此不做具体限定。图3中所示出的两个辅助处理器的架构仅为说明性而不应解释为限制性。另外，主处理器302可以包括单核或者多核的计算单元，用于提供本申请实施例所必需的功能和操作。另外，主处理器302和辅助处理器可以具有不同的架构，也就是电子设备可以是基于异构架构的系统，例如主处理器302可以是基于指令集操作体系的通用型处理器如CPU，而辅助处理器可以是适合并行化计算的图形处理器GPU或者是适合神经网络模型相关运算的专用加速器。辅助内存可以用于配合各自对应的辅助处理器来实现定制化功能及结构。而主存储器308用于存储必要的指令、软件、配置、数据等从而可以配合主处理器302提供本申请实施例所必需的功能和操作。在一些示例性实施例中，电子设备可以不包括辅助内存，可以包括仅一个辅助内存，还可以包括任意数量的辅助内存，在此不做具体限定。图3中所示出的两个辅助内存的架构仅为说明性而不应解释为限制性。主存储器308以及可能的辅助内存可以包括以下一个或多个特征：易失性，非易失性，动态，静态，可读/写，只读，随机访问，顺序访问，位置可寻址性，文件可寻址性和内容可寻址性，并且可以包括随机存取存储器，闪存，只读存储器，可擦可编程只读存储器，电可擦可编程只读存储器，寄存器，硬盘，可移动磁盘，可记录和/或可重写光盘，数字多功能光盘，大容量存储介质设备或任何其他形式的合适存储介质。内部总线304可以包括不同总线结构中的任何一种或不同总线结构的组合，例如存储器总线或存储器控制器，外围总线，通用串行总线和/或利用多种总线体系结构中的任何一种的处理器或本地总线。应当理解的是，图3所示的电子设备，其所示的结构并不构成对有关装置或系统的具体限定，在一些示例性实施例中，电子设备可以包括比具体实施例和附图更多或更少的部件，或者组合某些部件，或者拆分某些部件，或者具有不同的部件布置。图4示出了本申请实施例提供的根密钥管理服务器和TEE之间交互过程的示意图。如图4所示，根密钥管理服务器402和TEE404之间的交互过程包括多个示例性的环节，下面结合图4说明这些示例性环节各自的细节。如图4所示，该交互过程包括多个示例性的环节，分别是根密钥管理服务器402向TEE404发送公钥的环节410，TEE404执行联邦学习和隐私计算的业务流程的环节420，TEE404用公钥加密机密信息并将该机密信息的加密结果存储在第二执行环境的环节430，以及TEE404在根密钥管理服务器402的协助下恢复丢失的机密信息的环节440。这里，环节410可以对应上面的步骤S102，环节430可以对应上面的步骤S104，环节440可以对应上面的步骤S106。环节420还可以涉及到TEE404与其他参与方协同进行联邦学习模型的训练推理等，或者共同完成某个隐私计算任务。在环节420中可能生成或者获得各种机密信息，例如业务密钥、中间阶段处理结果、最终结果、会话、口令、授权文件、交互标识或者任意其他合适的信息。图4所示的交互过程示意性描述了，TEE404在环节410中接收到来自根密钥管理服务器402发送的公钥，并在环节420中生成或者获得各种机密信息，然后在环节430用该公钥加密机密信息。最后，如果TEE404遇到重启、死机等故障或者其他不可抗力的干扰而导致机密信息的丢失，则可以在环节440来恢复丢失的机密信息。应当理解的是，上述交互过程中示出的各种环节仅为示例性，在实际应用中，TEE404可以有多个环节420也就是可以运行多个业务流程，可以针对每个业务流程配置专属的公钥，也可以让两个或者更多个业务流程配置同一个公钥。而环节440仅响应于机密信息的丢失，所以环节440不是必然发生的，而是根据需要部署。另外，图4所示出的多个示例性环节之间存在先后关系，这种先后关系也只是说明性的。其中，TEE404只有在收到来自根密钥管理服务器402发送的公钥后才会用该公钥加密机密信息。TEE404可能会分成多个步骤或者多个环节来执行业务流程，并在执行业务流程的这些环节中间隔地利用公钥来加密，并且被加密的对象可能是已经处理过的业务数据也可能是尚未处理的业务数据。在一些实施例中，环节430可以安排在环节420之上，也就是TEE404可以先用公钥对尚未处理的业务数据进行加密并将加密结果存储在第二执行环境，然后才执行业务流程对业务数据进行处理。本申请提供的具体实施例可以用硬件，软件，固件或固态逻辑电路中的任何一种或组合来实现，并且可以结合信号处理，控制和/或专用电路来实现。本申请具体实施例提供的设备或装置可以包括一个或多个处理器，专用集成电路，现场可编程门阵列等），这些处理器处理各种计算机可执行指令从而控制设备或装置的操作。本申请具体实施例提供的设备或装置可以包括将各个组件耦合在一起的系统总线或数据传输系统。系统总线可以包括不同总线结构中的任何一种或不同总线结构的组合，例如存储器总线或存储器控制器，外围总线，通用串行总线和/或利用多种总线体系结构中的任何一种的处理器或本地总线。本申请具体实施例提供的设备或装置可以是单独提供，也可以是系统的一部分，也可以是其它设备或装置的一部分。本申请提供的具体实施例可以包括计算机可读存储介质或与计算机可读存储介质相结合，例如能够提供非暂时性数据存储的一个或多个存储设备。计算机可读存储介质/存储设备可以被配置为保存数据，程序器和/或指令，这些数据，程序器和/或指令在由本申请具体实施例提供的设备或装置的处理器执行时使这些设备或装置实现有关操作。计算机可读存储介质/存储设备可以包括以下一个或多个特征：易失性，非易失性，动态，静态，可读/写，只读，随机访问，顺序访问，位置可寻址性，文件可寻址性和内容可寻址性。在一个或多个示例性实施例中，计算机可读存储介质/存储设备可以被集成到本申请具体实施例提供的设备或装置中或属于公共系统。计算机可读存储介质/存储设备可以包括光存储设备，半导体存储设备和/或磁存储设备等等，也可以包括随机存取存储器，闪存，只读存储器，可擦可编程只读存储器，电可擦可编程只读存储器，寄存器，硬盘，可移动磁盘，可记录和/或可重写光盘，数字多功能光盘，大容量存储介质设备或任何其他形式的合适存储介质。以上是本申请实施例的实施方式，应当指出，本申请具体实施例描述的方法中的步骤可以根据实际需要进行顺序调整、合并和删减。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详细描述的部分，可以参见其他实施例的相关描述。可以理解的是，本申请实施例以及附图所示的结构并不构成对有关装置或系统的具体限定。在本申请另一些实施例中，有关装置或系统可以包括比具体实施例和附图更多或更少的部件，或者组合某些部件，或者拆分某些部件，或者具有不同的部件布置。本领域技术人员将理解，在不脱离本申请具体实施例的精神和范围的情况下，可以对具体实施例记载的方法和设备的布置，操作和细节进行各种修改或变化；在不脱离本申请实施例原理的前提下，还可以做出若干改进和润饰，这些改进和润饰也视为本申请的保护范围。
