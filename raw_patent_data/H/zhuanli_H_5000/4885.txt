标题title
一种基于行为基线异常分析和事件编排的辅助决策方法
摘要abst
本发明公开了一种基于行为基线异常分析和事件编排的辅助决策方法，属于网络安全技术领域，包括步骤：S1，基于行为基线异常分析定位真实告警信息，编排网络安全事件分析模型；S2，采用编排的网络安全事件分析模型，对定位到的真实告警信息进行告警处置。本发明提供了包括快速精准定位真实告警信息、预先编排网络安全事件分析标准模型、告警自动化处置为一体的网络安全事件处置方案，不仅能够从流程上打通、团队上协同，还能够降低网络安全分析技术门槛、减轻网络安全决策负担，提升效率。
权利要求书clms
1.一种基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，包括步骤：S1，基于行为基线异常分析定位真实告警信息，编排网络安全事件分析模型；S2，采用编排的网络安全事件分析模型，对定位到的真实告警信息进行告警处置。2.根据权利要求1所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S1中所述基于行为基线异常分析定位真实告警信息包括子步骤：S101，定义告警数据字段；S102，以步骤S101定义的告警数据字段作为特征，对在某个设定时间范围内的重复告警日志记录进行去重筛选；S103，对步骤S102筛选的告警日志中，从告警数据字段中的告警类型、名称、类型占比、请求头、响应头建立每台内网主机的行为基线，采用告警数据字段中的源IP、目的IP、告警信息、告警时间作为选择的组合特征进行建模；S104，对步骤S103选择的组合特征进行特征编码；S105，对步骤S104中进行特征编码后的特征进行异常检测。3.根据权利要求1所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S1中所述编排网络安全事件分析模型，包括子步骤：S111，采用安全事件编排剧本设计相应的流程剧本，且剧本由动作和处理逻辑两部分组成；S112，通过将多源异构的安全事件进行重定义和分析形成安全分析与响应引擎，完成复杂安全场景的分析，用于实现自动化、API化地驱动各应用；S113，通过网络安全事件编排对典型网络安全事件场景进行编排，形成对应的网络安全处置模型。4.根据权利要求1所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S2中，包括子步骤：S201，采用网络安全设备分布式调度将安全目标进行分解，结合网络安全资源，构建网络安全资源综合管理模型；S202，采用多点异构安全设备处置命令自动下发建立网络安全设备联动API接口，构建异构设备安全处置命令下发脚本，实现决策指令在不同设备之间下发与执行，通过调用编排的所述网络安全事件分析模型，达到自动化告警处置。5.根据权利要求2所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S101中，所述告警数据字段的公式化表示如下：A＝其中，A为单条告警数据，time为告警产生时间、sip为源IP、dip为目的IP、device_ip为产生该条告警的探针IP、dport为目的端口、event_type为告警类型、event_name为告警名称、payload为告警载荷、q_body为Web访问的请求体、r_body为Web请求的响应体。6.根据权利要求2所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S102中，以源IP、目的IP、告警信息、告警时间作为组合特征，对在某个设定时间范围内的重复告警日志记录进行去重，公式化表示如下：满足，|A1-A2|＜Timestamp其中：A1,A2分别为不同的告警数据，R为是否去重，f为告警数据相似度衡量函数，t为相似度阈值，Timestamp为时间窗阈值；若告警数据A1,A2产生的时间在Timestamp内，且A1,A2之间的相似度大于等于阈值t，则表示A1,A2为重复告警即R＝1，否则为不同告警即R＝0。7.根据权利要求2所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S103中，包括子步骤：首先构建基本子集{sip,dip}；然后计算其他特征列和基本子集的互信息量，若互信息量小于阈值则保留，特征x1、x2的互信息量计算公式表示如下：其中：S1,S2分别表示x1,x2的状态空间；最终选择源IP、目的IP、告警信息、告警时间作为组合特征进行建模。8.根据权利要求2所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S104中，所述特征编码为采用哈希编码和one-hot编码组合的二进制编码。9.根据权利要求2所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，在步骤S105中，所述进行异常检测包括采用孤立森林算法，利用孤立树二叉搜索树结构来孤立样本，具体包括以下子步骤：S501，从数据集X中抽取用于建立孤立树的样本集Y，并计算该树的最大深度，计算公式表示如下：其中：max_depth为孤立树的最大深度，s为样本集Y的样本数目，为向上取整操作符；S502，对样本集Y中的样本构建孤立树结构；S503，重复步骤S501和步骤S502的操作，直至完成n个孤立树的构建；S504，n个孤立树构建完成后，计算树的平均深度及数据集X中样本的孤立值，计算公式如下：其中：x为数据集X中的样本，t为数据集X的大小，depth为样本x在孤立树中的深度，mean)为样本x在其孤立森林中的平均深度，mean_depth_forest为孤立树构建完成后，所有孤立树的平均深度。10.根据权利要求8所述的基于行为基线异常分析和事件编排的辅助决策方法，其特征在于，所述二进制编码包括子步骤：首先使用顺序编码器将包含源IP、目的IP、告警信息、告警时间的组合特征的告警数据字段转换为数值，然后将得到的数值转换为二进制列数据；其中对告警发生时间进行取整处理。
说明书desc
技术领域本发明涉及网络安全技术领域，更为具体的，涉及一种基于行为基线异常分析和事件编排的辅助决策方法。背景技术随着计算机网络的快速发展，网络安全威胁日益严峻，通过对网络安全设备产生的告警日志进行分析，是网络安全态势感知的一种重要手段。但目前存在网络环境愈发复杂、攻击手段愈发多样、安全分析人员经验难以固化等问题，使得传统的人工分析方式难以应对海量的告警日志信息，阻碍了对真正威胁的及时响应。现有技术中存在如下问题：1)由于网络环境的日渐复杂性，难以准确分析、定位告警信息；2)流程上部分环节依赖于人工，技术分析门槛受限于人的认知，协同性较差，网络安全决策负担较重；3)数据包在传输过程中会经过多个网络安全设备，存在大量重复告警，导致分析效率低下等。发明内容本发明的目的在于克服现有技术的不足，提供一种基于行为基线异常分析和事件编排的辅助决策方法，不仅能够从流程上打通、团队上协同，还能够降低网络安全分析技术门槛、减轻网络安全决策负担等。本发明的目的是通过以下方案实现的：一种基于行为基线异常分析和事件编排的辅助决策方法，包括步骤：S1，基于行为基线异常分析定位真实告警信息，编排网络安全事件分析模型；S2，采用编排的网络安全事件分析模型，对定位到的真实告警信息进行告警处置。进一步地，在步骤S1中所述基于行为基线异常分析定位真实告警信息包括子步骤：S101，定义告警数据字段；S102，以步骤S101定义的告警数据字段作为特征，对在某个设定时间范围内的重复告警日志记录进行去重筛选；S103，对步骤S102筛选的告警日志中，从告警数据字段中的告警类型、名称、类型占比、请求头、响应头建立每台内网主机的行为基线，采用告警数据字段中的源IP、目的IP、告警信息、告警时间作为选择的组合特征进行建模；S104，对步骤S103选择的组合特征进行特征编码；S105，对步骤S104中进行特征编码后的特征，进行异常检测。进一步地，在步骤S1中所述编排网络安全事件分析模型，包括子步骤：S111，采用安全事件编排剧本设计相应的流程剧本，且剧本由动作和处理逻辑两部分组成；S112，通过将多源异构的安全事件进行重定义和分析形成安全分析与响应引擎，完成复杂安全场景的分析，用于实现自动化、API化地驱动各应用；S113，通过网络安全事件编排对典型网络安全事件场景进行编排，形成对应的网络安全处置模型。进一步地，在步骤S2中，包括子步骤：S201，采用网络安全设备分布式调度将安全目标进行分解，结合网络安全资源，构建网络安全资源综合管理模型；S202，采用多点异构安全设备处置命令自动下发建立网络安全设备联动API接口，构建异构设备安全处置命令下发脚本，实现决策指令在不同设备之间下发与执行，通过调用编排的所述网络安全事件分析模型，达到自动化告警处置。进一步地，在步骤S101中，所述告警数据字段的公式化表示如下：A＝其中，A为单条告警数据，time为告警产生时间、sip为源IP、dip为目的IP、device_ip为产生该条告警的探针IP、dport为目的端口、event_type 为告警类型、event_name为告警名称、payload为告警载荷、q_body为Web 访问的请求体、r_body为Web请求的响应体。进一步地，在步骤S102中，以源IP、目的IP、告警信息、告警时间作为组合特征，对在某个设定时间范围内的重复告警日志记录进行去重，公式化表示如下：满足，|A1-A2|＜Timestamp其中：A1,A2分别为不同的告警数据，R为是否去重，f为告警数据相似度衡量函数，t为相似度阈值，Timestamp为时间窗阈值；若告警数据A1,A2产生的时间在Timestamp内，且A1,A2之间的相似度大于等于阈值t，则表示A1,A2为重复告警即R＝1，否则为不同告警即R＝0。进一步地，在步骤S103中，包括子步骤：首先构建基本子集{sip,dip}；然后计算其他特征列和基本子集的互信息量，若互信息量小于阈值则保留，特征x1、x2的互信息量计算公式表示如下：其中：S1,S2分别表示x1,x2的状态空间；最终选择源IP、目的IP、告警信息、告警时间作为组合特征进行建模。进一步地，在步骤S104中，所述特征编码为采用哈希编码和one-hot 编码组合的二进制编码。进一步地，在步骤S105中，所述进行异常检测包括采用孤立森林算法，利用孤立树二叉搜索树结构来孤立样本，具体包括以下子步骤：S501，从数据集X中抽取用于建立孤立树的样本集Y，并计算该树的最大深度，计算公式表示如下：其中：max_depth为孤立树的最大深度，s为样本集Y的样本数目，为向上取整操作符；S502，对样本集Y中的样本构建孤立树结构；由于异常样本数量远远小于正常样本，当样本数据划分到一定程度后，对于深度较大的正常样本不再继续划分；S503，重复步骤S501和步骤S502的操作，直至完成n个孤立树的构建；S504，n个孤立树构建完成后，计算树的平均深度及数据集X中样本的孤立值，计算公式如下：其中：x为数据集X中的样本，t为数据集X的大小，depth为样本x在孤立树中的深度，mean)为样本x在其孤立森林中的平均深度， mean_depth_forest为孤立树构建完成后，所有孤立树的平均深度。进一步地，所述二进制编码包括子步骤：首先使用顺序编码器将包含源IP、目的IP、告警信息、告警时间的组合特征的告警数据字段转换为数值，然后将得到的数值转换为二进制列数据；其中对告警发生时间进行取整处理。本发明的有益效果是：本发明实施例提供了包括快速精准定位真实告警信息、预先编排网络安全事件分析标准模型、告警自动化处置为一体的网络安全事件处置方案，不仅能够从流程上打通、团队上协同，还能够降低网络安全分析技术门槛、减轻网络安全决策负担。本发明实施例提供的基于行为基线异常分析技术能够过滤80％以上的无效告警，极大地提升了安全分析人员决策的有效性。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为告警日志分布情况示意图；图2为本发明实施例的整体流程图；图3为本发明实施例的基于行为基线异常分析技术流程图；图4为本发明实施例的孤立树示意图；图5为本发明实施例的剧本设计示意图。具体实施方式本说明书中所有实施例公开的所有特征，或隐含公开的所有方法或过程中的步骤，除了互相排斥的特征和/或步骤以外，均可以以任何方式组合和/或扩展、替换。下面根据附图1～图5，对本发明实际解决的技术问题、技术构思、工作原理、工作过程和实际技术效果作进一步详细说明。本发明为了解决背景技术中提出的问题，提供一种在海量告警日志中快速精准地定位真正的威胁，并通过预先编排的网络安全事件分析标准模型实现自动化告警处置为一体的网络安全事件处置架构的方案，该方案为辅助网络安全人员进行决策分析提供技术支撑。具体实施中，如图3所示，本发明实施例采用基于行为基线异常分析技术，从海量告警日志中快速精准定位亟需处理的真实告警信息，得到的真实告警信息通过预先编排的网络安全事件分析标准模型进行自动化告警处置。具体实现步骤如下：1、采用基于行为基线异常分析技术精确定位真实告警信息；2、编排网络安全事件分析标准模型；3、自动化告警处置。在具体应用时，本发明实施例还提供一种基于行为基线异常分析和事件编排的辅助决策方法的技术方案，具体包括以下步骤：采用基于行为基线异常分析技术，从海量告警日志中有效去除/ 融合重复告警信息，并进一步快速精准定位真实告警信息；预先将不同的人员角色、安全能力接口、各类信息数据等按照特定场景进行组合编排，形成网络安全事件分析标准模型；采用步骤中预先编排的网络安全事件分析标准模型，对步骤中得到的告警信息进行自动化告警处置。在采用如上实施例中方案解决背景技术中提出的问题的过程中，又遇到了如下问题：①应对海量日志信息络如何快速精准定位亟需处理的真实告警信息。②得到的真实告警信息后，如何进行自动化处置，降低人工参与分析和决策。为了解决技术问题①，本发明在具体实施过程中，对对步骤中所述基于行为基线异常分析技术设计以下子步骤：定义的告警数据字段；以定义的告警数据字段如源IP、目的IP、告警信息、告警时间等作为特征，对在某个特定时间范围内的重复告警日志记录进行去重；对步骤筛选的告警日志中，从告警类型、名称、类型占比、请求头、响应头建立每台内网主机的行为基线，采用源IP、目的IP、告警信息、告警时间作为组合特征进行建模；对步骤选择的特征进行特征编码，其中源IP、目的IP、告警信息采用二进制编码，告警时间编码采用小时位；对步骤中进行特征编码后的特征，采用孤立森林算法进行异常检测。在具体实施步骤的子步骤的过程中，又遇到如下技术问题：③如何分析网络安全防护设备告警日志的分布规律以及如何定义告警数据字段；④解决存在大量重复告警的问题。本发明实施例针对技术问题③和④，设计如下子步骤：步骤1：定义告警数据字段。告警数据字段包括告警产生时间、源IP、目的IP、产生该条告警的探针IP、目的端口、告警类型、告警名称、告警载荷 、Web访问的请求体、Web请求的响应体。公式化表示如下：A＝其中，A为单条告警数据。步骤2：告警数据去重。以源IP、目的IP、告警信息、告警时间作为组合特征，对在某个特定时间范围内的重复告警日志记录进行去重。公式化表示如下：满足，|A1-A2|＜Timestamp其中：A1,A2分别为不同的告警数据，R为是否去重，f为告警数据相似度衡量函数，t为相似度阈值，Timestamp为时间窗阈值。若告警数据A1,A2产生的时间在Timestamp内，且A1,A2之间的相似度大于等于阈值t，则表示A1,A2为重复告警，否则为不同告警。在具体实施步骤的子步骤的过程中，又遇到如下技术问题：⑤如何进行特征选取，降低数据维度。本发明实施例针对技术问题⑤，设计如下子步骤：步骤3：特征选择。从原始特征中选择出一些最有效特征以降低数据维度，采用计算互信息的方法选择特征子集，首先构建基本子集{sip,dip}，然后计算其他特征列和基本子集的互信息量，若互信息量小于阈值则保留，特征x1、x2的互信息量计算公式表示如下：其中：S1,S2分别表示x1,x2的状态空间。最终选择源IP、目的IP、告警信息、告警时间作为组合特征进行建模。步骤4：特征编码。采用二进制编码对源IP、目的IP、告警信息等字段进行特征编码，二进制编码是哈希编码和one-hot编码的组合，即首先使用顺序编码器将字段转换为数值，然后将得到的数值进一步转换为二进制列数据。对于告警时间编码采用小时位，即对告警发生时间进行小时位取整。步骤5：构建异常检测模型。采用孤立森林算法，利用孤立树二叉搜索 树结构来孤立样本，具体包括以下子步骤：步骤5.1：从数据集X中抽取用于建立孤立树的样本集Y，并计算该树的最大深度，计算公式表示如下：其中：max_depth为孤立树的最大深度，s为样本集Y的样本数目，为向上取整操作符。步骤5.2：对样本集Y中的样本按照图4的方式构建孤立树结构，由于异常样本数量远远小于正常样本，当样本数据划分到一定程度后，对于深度较大的正常样本不再继续划分。步骤5.3：重复步骤5.1和步骤5.2的操作，直至完成n个孤立树的构建。步骤5.4：n个孤立树构建完成后，计算树的平均深度及数据集X中样本的孤立值。计算公式如下：其中：x为数据集X中的样本，t为数据集X的大小，depth为样本x在孤立树中的深度，mean)为样本x在其孤立森林中的平均深度， mean_depth_forest为孤立树构建完成后，所有孤立树的平均深度。在上述编排网络安全事件分析标准模型的步骤中，包括子步骤：步骤1：剧本设计。采用安全事件编排剧本设计技术，设计相应的流程剧本。剧本由动作和处理逻辑两部分组成。接收到基于行为基线异常分析技术定位真实告警信息后，在具体实施时，可以采用一种如图5所示的剧本设计流程。步骤2：网络安全事件编排。通过将多源异构的安全事件进行重定义和自动分析，形成安全分析与响应引擎，完成复杂安全场景的分析，实现自动化、API化地驱动各应用。步骤3：典型网络安全事件场景编排。通过网络安全事件编排技术，对典型网络安全事件场景进行编排，形成对应的网络安全自动处置模型。在上述自动化告警处置的步骤中，包括子步骤：步骤1：采用网络安全设备分布式调度技术将安全目标进行分解，结合已有网络安全资源，构建网络安全资源综合管理模型。步骤2：采用多点异构安全设备处置命令自动下发技术，建立网络安全设备联动API接口，构建异构设备安全处置命令下发脚本，实现决策指令在不同设备之间下发与执行，通过调用事先编排的网络安全事件分析标准模型，达到自动化告警处置的目的。实施例1：一种基于行为基线异常分析和事件编排的辅助决策方法，包括步骤：S1，基于行为基线异常分析定位真实告警信息，编排网络安全事件分析模型；S2，采用编排的网络安全事件分析模型，对定位到的真实告警信息进行告警处置。实施例2：在实施例1的基础上，在步骤S1中所述基于行为基线异常分析定位真实告警信息包括子步骤：S101，定义告警数据字段；S102，以步骤S101定义的告警数据字段作为特征，对在某个设定时间范围内的重复告警日志记录进行去重筛选；S103，对步骤S102筛选的告警日志中，从告警数据字段中的告警类型、名称、类型占比、请求头、响应头建立每台内网主机的行为基线，采用告警数据字段中的源IP、目的IP、告警信息、告警时间作为选择的组合特征进行建模；S104，对步骤S103选择的组合特征进行特征编码；S105，对步骤S104中进行特征编码后的特征，进行异常检测。实施例3：在实施例1的基础上，在步骤S1中所述编排网络安全事件分析模型，包括子步骤：S111，采用安全事件编排剧本设计相应的流程剧本，且剧本由动作和处理逻辑两部分组成；S112，通过将多源异构的安全事件进行重定义和分析形成安全分析与响应引擎，完成复杂安全场景的分析，用于实现自动化、API化地驱动各应用；S113，通过网络安全事件编排对典型网络安全事件场景进行编排，形成对应的网络安全处置模型。实施例4：在实施例1的基础上，在步骤S2中，包括子步骤：S201，采用网络安全设备分布式调度将安全目标进行分解，结合网络安全资源，构建网络安全资源综合管理模型；S202，采用多点异构安全设备处置命令自动下发建立网络安全设备联动API接口，构建异构设备安全处置命令下发脚本，实现决策指令在不同设备之间下发与执行，通过调用编排的所述网络安全事件分析模型，达到自动化告警处置。实施例5：在实施例2的基础上，在步骤S101中，所述告警数据字段的公式化表示如下：A＝q_dody,r_body]其中，A为单条告警数据，time为告警产生时间、sip为源IP、dip为目的IP、device_ip为产生该条告警的探针IP、dport为目的端口、event_type 为告警类型、event_name为告警名称、payload为告警载荷、q_body为Web 访问的请求体、r_body为Web请求的响应体。实施例6：在实施例2的基础上，在步骤S102中，以源IP、目的IP、告警信息、告警时间作为组合特征，对在某个设定时间范围内的重复告警日志记录进行去重，公式化表示如下：满足，|A1-A2|＜Timestamp其中：A1,A2分别为不同的告警数据，R为是否去重，f为告警数据相似度衡量函数，t为相似度阈值，Timestamp为时间窗阈值；若告警数据A1,A2产生的时间在Timestamp内，且A1,A2之间的相似度大于等于阈值t，则表示A1,A2为重复告警即R＝1，否则为不同告警即R＝0。实施例7：在实施例2的基础上，在步骤S103中，包括子步骤：首先构建基本子集{sip,dip}；然后计算其他特征列和基本子集的互信息量，若互信息量小于阈值则保留，特征x1、x2的互信息量计算公式表示如下：其中：S1,S2分别表示x1,x2的状态空间；最终选择源IP、目的IP、告警信息、告警时间作为组合特征进行建模。实施例8：在实施例2的基础上，在步骤S104中，所述特征编码为采用哈希编码和one-hot编码组合的二进制编码。实施例9：在实施例2的基础上，在步骤S105中，所述进行异常检测包括采用孤立森林算法，利用孤立树二叉搜索树结构来孤立样本，具体包括以下子步骤：S501，从数据集X中抽取用于建立孤立树的样本集Y，并计算该树的最大深度，计算公式表示如下：其中：max_depth为孤立树的最大深度，s为样本集Y的样本数目，为向上取整操作符；S502，对样本集Y中的样本构建孤立树结构；由于异常样本数量远远小于正常样本，当样本数据划分到一定程度后，对于深度较大的正常样本不再继续划分；S503，重复步骤S501和步骤S502的操作，直至完成n个孤立树的构建；S504，n个孤立树构建完成后，计算树的平均深度及数据集X中样本的孤立值，计算公式如下：其中：x为数据集X中的样本，t为数据集X的大小，depth为样本x在孤立树中的深度，mean)为样本x在其孤立森林中的平均深度，mean_depth_forest为孤立树构建完成后，所有孤立树的平均深度。实施例10：在实施例8的基础上，所述二进制编码包括子步骤：首先使用顺序编码器将包含源IP、目的IP、告警信息、告警时间的组合特征的告警数据字段转换为数值，然后将得到的数值转换为二进制列数据；其中对告警发生时间进行取整处理。本发明功能如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，在一台计算机设备以及相应的软件中执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、或者光盘等各种可以存储程序代码的介质，进行测试或者实际的数据在程序实现中存在于只读存储器 、随机存取存储器等。
