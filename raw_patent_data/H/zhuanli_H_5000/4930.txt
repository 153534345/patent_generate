标题title
一种便携设备的充电电路、充电芯片及充电控制方法
摘要abst
本发明提供了一种便携设备的充电电路、充电芯片及充电控制方法，该电路包括电压输入端、电压输出端和控制单元，所述充电电路还包括第一充电支路、第二充电支路、第一开关管和电池端；所述第一充电支路为降压开关电路，包括主开关管、续流开关管和电感，所述电压输入端通过所述主开关管和续流开关管接地，所述主开关管和续流开关管的公共端通过所述电感连接所述电压输出端；所述第二充电支路包括第二开关管，所述电压输入端通过所述第二开关管连接所述电压输出端；所述电压输出端通过所述第一开关管连接所述电池端。本发明能降低第一充电支路切换到第二充电电路时便携设备瞬间关机的几率，提高了用户体验。
权利要求书clms
1.一种便携设备的充电电路，包括电压输入端、电压输出端和控制单元，所述电压输入端用于与充电设备连接，所述电压输出端用于连接所述便携设备的负载电路，其特征在于，所述充电电路还包括第一充电支路、第二充电支路、第一开关管和电池端；所述第一充电支路为降压开关电路，包括主开关管、续流开关管和电感，所述电压输入端通过所述主开关管和续流开关管接地，所述主开关管和续流开关管的公共端通过所述电感连接所述电压输出端；所述第二充电支路包括第二开关管，所述电压输入端通过所述第二开关管连接所述电压输出端；所述电压输出端通过所述第一开关管连接所述电池端；所述控制单元用于：若所述电池端的电压小于第一阈值电压，则控制所述第一开关管导通、所述第二开关管关断，并控制所述降压开关电路将所述电压输入端的电压降压至输出给所述电压输出端的第一电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电池端的压差大于第二阈值电压时，则控制所述第一开关管导通、所述第二开关管关断，并且随着所述电池端的电压上升，控制所述降压开关电路将所述电压输入端的电压适应性地降压至输出给所述电压输出端的对应电压值，使得所述电压输出端与所述电池端的电压差为第二电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电压输出端的压差小于第二阈值电压时，则控制所述第一开关管和所述第二开关管导通，并控制所述降压开关电路关闭，从而使所述电压输入端的电压通过所述第二开关管和第一开关管对向所述电压输出端和电池端供电；其中，所述电压输入端的电压、所述第一电压、第二阈值电压和第一阈值电压依次减小，所述第一阈值电压与所述第二阈值电压之和小于所述电压输入端的电压。2.根据权利要求1所述的充电电路，其特征在于，所述负载电路消耗的电流、电池的充电电流、所述负载电路的最小工作电压、所述电压输入端的电压，所述第二开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，Vmin＜VIN-*RM2；其中，I1为所述负载电路消耗的电流，I2为电池的充电电流，Vmin为所述负载电路的最小工作电压，VIN为所述电压输入端的电压，RM2为所述第二开关管的导通电阻。3.根据权利要求1所述的充电电路，其特征在于，所述电池端的电压、电池向所述电压输出端提供的电流、所述第一开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，所述电池端的电压与I3*RM1之差大于所述负载电路的最小工作电压；其中，I3为所述电池向所述电压输出端提供的电流，RM1为所述第一开关管的导通电阻。4.根据权利要求1至3任一所述的充电电路，其特征在于，所述主开关管、续流开关管和第一开关管集成于一个芯片内，所述第二开关管位于所述芯片外。5.根据权利要求1至3任一所述的充电电路，其特征在于，所述主开关管、续流开关管、第一开关管和第二开关管集成于一个芯片内。6.一种便携设备的充电芯片，包括电压输入端、电压输出端和控制单元，所述电压输入端用于与充电设备连接，所述电压输出端用于连接所述便携设备的负载电路，其特征在于，还包括芯片控制端、电感连接端、电池端、主开关管、续流开关管和第一开关管；所述电压输入端通过所述主开关管和续流开关管接地，所述主开关管和续流开关管的公共端为所述电感连接端，所述电感连接端用于连接外置的电感并通过所述电感连接所述电压输出端；所述主开关管、续流开关管和所述电感为降压开关电路的组成部分；所述电压输入端用于连接外置的第二开关管并通过所述第二开关管连接所述电压输出端，所述芯片控制端用于连接所述第二开关管的控制端；所述电压输出端通过所述第一开关管连接所述电池端；所述控制单元用于：若所述电池端的电压小于第一阈值电压，则控制所述第一开关管导通，并通过所述芯片控制端控制所述第二开关管关断，并控制所述降压开关电路将所述电压输入端的电压降压至输出给所述电压输出端的第一电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电池端的压差大于第二阈值电压时，则控制所述第一开关管导通，并通过所述芯片控制端控制所述第二开关管关断，并且随着所述电池端的电压上升，控制所述降压开关电路将所述电压输入端的电压适应性地降压至输出给所述电压输出端的对应电压值，使得所述电压输出端与所述电池端的电压差为第二电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电压输出端的压差小于第二阈值电压时，则控制所述第一开关管导通，并通过所述芯片控制端控制所述第二开关管导通，并控制所述降压开关电路关闭，从而使所述电压输入端的电压通过所述第二开关管和第一开关管对向所述电压输出端和电池端供电；其中，所述电压输入端的电压、所述第一电压、第二阈值电压和第一阈值电压依次减小，所述第一阈值电压与所述第二阈值电压之和小于所述电压输入端的电压。7.根据权利要求6所述的充电芯片，其特征在于，所述负载电路消耗的电流、电池的充电电流、所述负载电路的最小工作电压、所述电压输入端的电压，所述第二开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，Vmin＜VIN-*RM2；其中，I1为所述负载电路消耗的电流，I2为电池的充电电流，Vmin为所述负载电路的最小工作电压，VIN为所述电压输入端的电压，RM2为所述第二开关管的导通电阻。8.根据权利要求6所述的充电芯片，其特征在于，所述电池端的电压、电池向所述电压输出端提供的电流、所述第一开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，所述电池端的电压与I3*RM1之差大于所述负载电路的最小工作电压；其中，I3为所述电池向所述电压输出端提供的电流，RM1为所述第一开关管的导通电阻。9.一种便携设备的充电电路的控制方法，其中，所述充电电路包括电压输入端和电压输出端，所述电压输入端用于与充电设备连接，所述电压输出端用于连接所述便携设备的负载电路，其特征在于，所述充电电路还包括第一充电支路、第二充电支路、第一开关管和电池端；所述第一充电支路为降压开关电路，包括主开关管、续流开关管和电感，所述电压输入端通过所述主开关管和续流开关管接地，所述主开关管和续流开关管的公共端通过所述电感连接所述电压输出端；所述第二充电支路包括第二开关管，所述电压输入端通过所述第二开关管连接所述电压输出端；所述电压输出端通过所述第一开关管连接所述电池端；所述控制方法包括如下步骤：若所述电池端的电压小于第一阈值电压，则控制所述第一开关管导通、所述第二开关管关断，并控制所述降压开关电路将所述电压输入端的电压降压至输出给所述电压输出端的第一电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电池端的压差大于第二阈值电压时，则控制所述第一开关导通、所述第二开关管关断，并且随着所述电池端的电压上升，并控制所述降压开关电路将所述电压输入端的电压适应性地降压至输出给所述电压输出端的对应电压值，使得所述电压输出端与所述电池端的电压差为第二电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电压输出端的压差小于第二阈值电压时，则控制所述第一开关管和所述第二开关管导通，并控制所述降压开关电路关闭，所述电压输入端的电压通过所述第二开关管和第一开关管对向所述电压输出端和电池端供电；其中，所述电压输入端的电压、所述第一电压、第二阈值电压和第一阈值电压依次减小，所述第一阈值电压与所述第二阈值电压之和小于所述电压输入端的电压。10.根据权利要求9所述的控制方法，其特征在于，所述负载电路消耗的电流、电池的充电电流、所述负载电路的最小工作电压、所述电压输入端的电压，所述第二开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，Vmin＜VIN-*RM2；其中，I1为所述负载电路消耗的电流，I2为电池的充电电流，Vmin为所述负载电路的最小工作电压，VIN为所述电压输入端的电压，RM2为所述第二开关管的导通电阻。11.根据权利要求9所述的控制方法，其特征在于，所述电池端的电压、电池向所述电压输出端提供的电流、所述第一开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，所述电池端的电压与I3*RM1之差大于所述负载电路的最小工作电压；其中，I3为所述电池向所述电压输出端提供的电流，RM1为所述第一开关管的导通电阻。12.一种电路板，其特征在于，包括如权利要求1-5任一所述的充电电路，或者包括如权利要求6-8任一所述的充电芯片。13.一种便携设备，其特征在于，包括如权利要求1-5任一所述的充电电路，或者包括如权利要求6-8任一所述的充电芯片。
说明书desc
技术领域本发明涉及充电领域，具体涉及一种便携设备的充电电路、充电芯片及充电控制方法。背景技术如今，便携设备的应用非常广泛，例如智能手机、智能手表、平板电脑、蓝牙音箱，等等。这些便携设备具有可充电电池，通过充电设备可以对可充电电池进行充电。降压开关电路是常见的充电电路，然而，降压开关电路在输入输出压差较大仍然能够保证转换效率较高，但是当输入与输出压差较小时，开关降压实现难度会增加。为了进一步提高充电效率，并降低实现难度，现有技术提出了一种便携式设备的充电电路，如图1所示，该充电电路包括一个切换式充电电路和一个旁路充电电路，当电池的电压较小时，则切换式充电电路工作，而旁路充电电路断开，切换式充电电路经过开关管向电池充电；当电池的电压较大时，则切换式充电电路停止工作，而旁路充电电路导通，同时，通过所述开关管向电压输出端供电，即，从切换式充电电路工作切换至旁路充电电路工作，切换式充电电路与旁路充电电路之间切换的分界点例如可以为3.6V。这样，可以提高充电效率。经过研究发现，在切换式充电电路切换至旁路充电电路过程中，会出现便携设备瞬间关机的问题。发明内容基于上述现状，本发明的主要目的在于提供一种充电芯片及充电电路，能够降低在第一充电电路切换至第二充电电路的过程中出现的便携设备瞬间关机问题的几率。为实现上述目的，本发明采用的技术方案如下：一种便携设备的充电电路，包括电压输入端、电压输出端和控制单元，所述电压输入端用于与充电设备连接，所述电压输出端用于连接所述便携设备的负载电路，其特征在于，所述充电电路还包括第一充电支路、第二充电支路、第一开关管和电池端；所述第一充电支路为降压开关电路，包括主开关管、续流开关管和电感，所述电压输入端通过所述主开关管和续流开关管接地，所述主开关管和续流开关管的公共端通过所述电感连接所述电压输出端；所述第二充电支路包括第二开关管，所述电压输入端通过所述第二开关管连接所述电压输出端；所述电压输出端通过所述第一开关管连接所述电池端；所述控制单元用于：若所述电池端的电压小于第一阈值电压，则控制所述第一开关管导通、所述第二开关管关断，并控制所述降压开关电路将所述电压输入端的电压降压至输出给所述电压输出端的第一电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电池端的压差大于第二阈值电压时，则控制所述第一开关管导通、所述第二开关管关断，并且随着所述电池端的电压上升，控制所述降压开关电路将所述电压输入端的电压适应性地降压至输出给所述电压输出端的对应电压值，使得所述电压输出端与所述电池端的电压差为第二电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电压输出端的压差小于第二阈值电压时，则控制所述第一开关管和所述第二开关管导通，并控制所述降压开关电路关闭，从而使所述电压输入端的电压通过所述第二开关管和第一开关管对向所述电压输出端和电池端供电；其中，所述电压输入端的电压、所述第一电压、第二阈值电压和第一阈值电压依次减小，所述第一阈值电压与所述第二阈值电压之和小于所述电压输入端的电压。优选的，所述负载电路消耗的电流、电池的充电电流、所述负载电路的最小工作电压、所述电压输入端的电压，所述第二开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，Vmin＜VIN-*RM2；其中，I1为所述负载电路消耗的电流，I2为电池的充电电流，Vmin为所述负载电路的最小工作电压，VIN为所述电压输入端的电压，RM2为所述第二开关管的导通电阻。优选的，所述电池端的电压、电池向所述电压输出端提供的电流、所述第一开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，所述电池端的电压与I3*RM1之差大于所述负载电路的最小工作电压；其中，I3为所述电池向所述电压输出端提供的电流，RM1为所述第一开关管的导通电阻。优选的，所述主开关管、续流开关管和第一开关管集成于一个芯片内，所述第二开关管位于所述芯片外。优选的，所述主开关管、续流开关管、第一开关管和第二开关管集成于一个芯片内。本发明还提供了一种便携设备的充电芯片，包括电压输入端、电压输出端和控制单元，所述电压输入端用于与充电设备连接，所述电压输出端用于连接所述便携设备的负载电路，还包括芯片控制端、电感连接端、电池端、主开关管、续流开关管和第一开关管；所述电压输入端通过所述主开关管和续流开关管接地，所述主开关管和续流开关管的公共端为所述电感连接端，所述电感连接端用于连接外置的电感并通过所述电感连接所述电压输出端；所述主开关管、续流开关管和所述电感为降压开关电路的组成部分；所述电压输入端用于连接外置的第二开关管并通过所述第二开关管连接所述电压输出端，所述芯片控制端用于连接所述第二开关管的控制端；所述电压输出端通过所述第一开关管连接所述电池端；所述控制单元用于：若所述电池端的电压小于第一阈值电压，则控制所述第一开关管导通，并通过所述芯片控制端控制所述第二开关管关断，并控制所述降压开关电路将所述电压输入端的电压降压至输出给所述电压输出端的第一电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电池端的压差大于第二阈值电压时，则控制所述第一开关管导通，并通过所述芯片控制端控制所述第二开关管关断，并且随着所述电池端的电压上升，控制所述降压开关电路将所述电压输入端的电压适应性地降压至输出给所述电压输出端的对应电压值，使得所述电压输出端与所述电池端的电压差为第二电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电压输出端的压差小于第二阈值电压时，则控制所述第一开关管导通，并通过所述芯片控制端控制所述第二开关管导通，并控制所述降压开关电路关闭，从而使所述电压输入端的电压通过所述第二开关管和第一开关管对向所述电压输出端和电池端供电；其中，所述电压输入端的电压、所述第一电压、第二阈值电压和第一阈值电压依次减小，所述第一阈值电压与所述第二阈值电压之和小于所述电压输入端的电压。优选的，所述负载电路消耗的电流、电池的充电电流、所述负载电路的最小工作电压、所述电压输入端的电压，所述第二开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，Vmin＜VIN-*RM2；其中，I1为所述负载电路消耗的电流，I2为电池的充电电流，Vmin为所述负载电路的最小工作电压，VIN为所述电压输入端的电压，RM2为所述第二开关管的导通电阻。优选的，所述电池端的电压、电池向所述电压输出端提供的电流、所述第一开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，所述电池端的电压与I3*RM1之差大于所述负载电路的最小工作电压；其中，I3为所述电池向所述电压输出端提供的电流，RM1为所述第一开关管的导通电阻。本发明还提供了一种便携设备的充电电路的控制方法，其中，所述充电电路包括电压输入端和电压输出端，所述电压输入端用于与充电设备连接，所述电压输出端用于连接所述便携设备的负载电路，所述充电电路还包括第一充电支路、第二充电支路、第一开关管和电池端；所述第一充电支路为降压开关电路，包括主开关管、续流开关管和电感，所述电压输入端通过所述主开关管和续流开关管接地，所述主开关管和续流开关管的公共端通过所述电感连接所述电压输出端；所述第二充电支路包括第二开关管，所述电压输入端通过所述第二开关管连接所述电压输出端；所述电压输出端通过所述第一开关管连接所述电池端；所述控制方法包括如下步骤：若所述电池端的电压小于第一阈值电压，则控制所述第一开关管导通、所述第二开关管关断，并控制所述降压开关电路将所述电压输入端的电压降压至输出给所述电压输出端的第一电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电池端的压差大于第二阈值电压时，则控制所述第一开关导通、所述第二开关管关断，并且随着所述电池端的电压上升，并控制所述降压开关电路将所述电压输入端的电压适应性地降压至输出给所述电压输出端的对应电压值，使得所述电压输出端与所述电池端的电压差为第二电压，从而向所述电压输出端和电池端供电；若所述电池端的电压大于第一阈值电压，且所述电压输入端与所述电压输出端的压差小于第二阈值电压时，则控制所述第一开关管和所述第二开关管导通，并控制所述降压开关电路关闭，所述电压输入端的电压通过所述第二开关管和第一开关管对向所述电压输出端和电池端供电；其中，所述电压输入端的电压、所述第一电压、第二阈值电压和第一阈值电压依次减小，所述第一阈值电压与所述第二阈值电压之和小于所述电压输入端的电压。优选的，所述负载电路消耗的电流、电池的充电电流、所述负载电路的最小工作电压、所述电压输入端的电压，所述第二开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，Vmin＜VIN-*RM2；其中，I1为所述负载电路消耗的电流，I2为电池的充电电流，Vmin为所述负载电路的最小工作电压，VIN为所述电压输入端的电压，RM2为所述第二开关管的导通电阻。优选的，所述电池端的电压、电池向所述电压输出端提供的电流、所述第一开关管的导通电阻被配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，所述电池端的电压与I3*RM1之差大于所述负载电路的最小工作电压；其中，I3为所述电池向所述电压输出端提供的电流，RM1为所述第一开关管的导通电阻。本发明还提供了一种电路板，包括任一所述的充电电路，或者包括任一所述的充电芯片。本发明还提供了一种便携设备，包括任一所述的充电电路，或者包括任一所述的充电芯片。【有益效果】本发明提供的充电电路或充电芯片的方案中，对于第二充电电路，由于电压输入端通过第二开关管连接电压输出端而不是电池端，相比于图1的现有技术，本发明实施例减少了第二充电电路上的开关管数量，因而减少了第二充电电路的电阻，因此在第二充电电路工作时，降低了电压输入端至电压输出端之间的电压压降损耗，从而从降压开关电路供电切换至第二充电电路供电时，降低了电压输出端的电压小于负载电路的最小工作电压的几率，进而降低了上述切换时便携设备瞬间关机的几率，因此提高了用户体验。在优选的方案中，通过将所述负载电路消耗的电流、所述电池的充电电流、所述负载电路的最小工作电压、所述电压输入端的电压，所述第二开关管的导通电阻配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，Vmin＜VIN-*RM2，可以保证电压输出端的电压大于负载电路的最小工作电压，从而避免便携设备瞬间关机，进一步保证良好的用户体验。在优选的方案中，通过将所述电池端的电压、所述电池向所述电压输出端提供的电流、所述第一开关管的导通电阻配置为满足如下关系：当所述第一开关和所述第二开关管均导通时，所述电池端的电压与I3*RM1之差大于所述负载电路的最小工作电压，可以保证电压输出端的电压大于负载电路的最小工作电压，从而避免便携设备瞬间关机，进一步保证良好的用户体验。本发明的其他有益效果，将在具体实施方式中通过具体技术特征和技术方案的介绍来阐述，本领域技术人员通过这些技术特征和技术方案的介绍，应能理解所述技术特征和技术方案带来的有益技术效果。附图说明以下将参照附图对本发明的优选实施方式进行描述。图中：图1为现有技术的便携设备充电电路；图2为根据本发明的一种优选实施方式的便携设备的框图；图3为根据本发明的一种优选实施方式的便携设备的充电电路；图4为根据本发明的另一种优选实施方式的便携设备的充电电路。具体实施方式以下基于实施例对本发明进行描述，但是本发明并不仅仅限于这些实施例。在下文对本发明的细节描述中，详尽描述了一些特定的细节部分，为了避免混淆本发明的实质，公知的方法、过程、流程、元件并没有详细叙述。此外，本领域普通技术人员应当理解，在此提供的附图都是为了说明的目的，并且附图不一定是按比例绘制的。除非上下文明确要求，否则整个说明书和权利要求书中的“包括”、“包含”等类似词语应当解释为包含的含义而不是排他或穷举的含义；也就是说，是“包括但不限于”的含义。在本发明的描述中，需要理解的是，术语“第一”、“第二”等仅用于描述目的，而不能理解为指示或暗示相对重要性。此外，在本发明的描述中，除非另有说明，“多个”的含义是两个或两个以上。进一步研究现有技术发现，若切换式充电电路与旁路充电电路之间切换的分界点较低，在切换式充电电路工作时，切换式充电电路可以对电池提供充电电流，同时还可以对系统端提供电流，当电池电压达到分界点，切换式充电电路切换至旁路充电电路时，若此时电池抽取的充电电流和负载电路从系统端抽取的电流均较大时，由于存在三个开关管：开关管1、开关管2和开关管3，输入端的电压经过三个开关管的压降损耗之后，提供给系统端的电压的可能小于负载电路的最低工作电压，另外由于此时电池的电压也较低无法给系统端提供大于最低工作电压的电压，因此，在切换式充电电路切换至旁路充电电路后，可能出现便携设备瞬间关机的问题，影响了用户体验。上述问题，在便携设备负载电路抽取电流和电池充电电流在1A以上的电流时尤其明显，例如负载电路抽取电流达到3A。鉴于此，提供了本发明各种实施例的便携设备的充电电路、充电芯片及充电控制方法。如图2所示，是一种实施例的便携设备的框图，便携设备包括可充电电池、充电电路和负载电路，充电设备提供的电压和电流通过充电电路进入便携设备，从而提供给电池和负载电路，负载电路是相对于电池和充电电路而言的，负载电路消耗电池和/或充电电路提供的电能以实现相应的功能，负载电路可以是便携设备的电路板上除充电电路和电池之外的各种电子元件，例如处理器、外围功能电路等。如图3所示，是一种实施例的便携设备的充电电路，包括电压输入端Vin、电压输出端Vsys、控制单元、第一充电支路、第二充电支路、第一开关管M1和电池端bat。电压输入端Vin用于与充电设备连接，充电设备提供的电流和电压从该电压输入端Vin进入便携设备的充电电路，电压输出端Vsys用于连接便携设备的负载电路，负载电路从该电压输出端Vsys获取工作所需的电压和电流。第一充电支路为降压开关电路，降压开关电路包括主开关管Q1、续流开关管Q2和电感L，电压输入端Vin通过主开关管Q1和续流开关管Q2接地，主开关管Q1和续流开关管Q2的公共端lx通过电感L连接电压输出端Vsys；第二充电支路包括第二开关管M2，电压输入端Vin通过第二开关管M2连接电压输出端Vsys；电压输出端Vsys通过第一开关管M1连接电池端bat；电池端bat用于连接电池BAT的正极。若电池端bat的电压小于第一阈值电压，则控制单元控制第一开关管M1导通、第二开关管M2关断，并控制降压开关电路工作，即控制降压开关电路将电压输入端Vin的电压降压至第一电压，并将第一电压输出给电压输出端Vsys，从而向电压输出端Vsys和电池端bat供电，即从第一充电支路供电。在一个实施例中，输入端的电压、第一电压和第一阈值电压分别为5V、3V和2.8V。降压开关电路是一种常见的电路，通过控制主开关管Q1和续流开关管Q2的导通和关段，从而可以使得电压输出端Vsys的电压维持在某一所需的电压值上，例如上述第一电压；具体而言，当主开关管Q1导通、续流开关管Q2关断时，电流从电压输入端Vin流入，经过主开关管Q1和电感L到达电压输出端Vsys；当主开关管Q1断开、续流开关管Q2导通时，电流从地流出，经过续流开关管Q2和电感L到达电压输出端Vsys。若电池端bat的电压大于第一阈值电压，且电压输入端Vin与电池端bat的压差大于第二阈值电压时，则控制单元控制第一开关管M1导通，控制第二开关管M2关断，并随着电池端bat的电压上升，控制单元控制降压开关电路将电压输入端Vin的电压适应性地降压至对应电压值，并将该对应电压值输出给电压输出端Vsys，使得电压输出端Vsys与电池端bat的电压差为第二电压，从而向电压输出端Vsys和电池端bat供电，即从第一充电支路供电。换言之，控制单元每次采集获得电池端bat的电池电压后，计算电池电压与第二电压之和得到目标电压，然后控制单元控制降压开关电路将电压输入端Vin的电压降压至该目标电压。一旦接下来的某次采集获得的电池电压发生变化，例如增大，则计算得到的目标电压增大，进而控制降压开关电路将电压输入端Vin的电压降压至该新的目标电压，如此，使得电压输出端Vsys与电池端bat的电压差为第二电压。若电池端bat的电压大于第一阈值电压，且电压输入端Vin与电压输出端Vsys的压差小于第二阈值电压时，则控制单元控制第一开关管M1和第二开关管M2导通，并控制降压开关电路关闭，这样，电压输入端Vin的电压通过第二开关管M2和第一开关管M1对向电压输出端Vsys和电池端bat供电，即从第二充电支路供电。其中，电压输入端Vin的电压、第一电压、第二阈值电压和第一阈值电压依次减小，第一阈值电压与第二阈值电压之和小于电压输入端Vin的电压。作为一个例子，电压输入端Vin的电压为5V，第一电压为3V，负载电路的最小工作电压为3V，第二阈值电压为0.2V，第一阈值电压为2.8V，第二电压为0.1V。对于第二充电电路，由于电压输入端Vin通过第二开关管M2连接电压输出端Vsys而不是电池端bat，相比于现有技术，本发明实施例减少了第二充电电路上的开关管数量，因而减少了第二充电电路的电阻，因此在第二充电电路工作时，降低了电压输入端Vin至电压输出端Vsys之间的电压压降损耗，从而在降压开关电路供电切换至第二充电电路供电时，降低了电压输出端Vsys的电压小于负载电路的最小工作电压的几率，进而降低了上述切换时便携设备瞬间关机的几率，因此提高了用户体验。需要指出的是，在负载电路抽取的电流和电池充电电流较大，开关管的导通电阻较大时，现有技术的上述问题更加明显。在一些实施例中，为了保证从降压开关电路供电切换至第二充电电路供电时，避免便携设备瞬间关机，将负载电路消耗的电流、电池的充电电流、负载电路的最小工作电压、电压输入端Vin的电压，第二开关管M2的导通电阻配置为满足如下关系：当从降压开关电路供电切换至第二充电电路供电时，即当第一开关和第二开关管M2均导通时，Vmin＜VIN-*RM2；其中，I1为此时负载电路消耗的电流，I2为电池的充电电流，Vmin为负载电路的最小工作电压，VIN为电压输入端的电压，RM2为第二开关管M2的导通电阻。在本实施例中，从降压开关电路供电切换至第二充电电路供电后，电压输出端Vsys的电压大于负载电路的最小工作电压，因此不会出现负载电路瞬间掉电而关机的情况。在一些实施例中，为了保证从降压开关电路供电切换至第二充电电路供电时，避免便携设备瞬间关机，将电池端bat的电压、电池向电压输出端Vsys提供的电流、第一开关管M1的导通电阻配置为满足如下关系：当第一开关和第二开关管M2均导通时，电池端bat的电压与I3*RM1之差大于负载电路的最小工作电压；其中，I3为电池向电压输出端Vsys提供的电流，RM1为第一开关管M1的导通电阻。在本实施例中，从降压开关电路供电切换至第二充电电路供电后，此时电池端bat向电压输出端Vsys提供能量，并能保证电压输出端Vsys的电压大于负载电路的最小工作电压，因此不会出现负载电路瞬间掉电而关机的情况。如图4所示，是一种实施例的便携设备的充电芯片组成的电路，该电路与图3的充电电路大体类似，主要区别在于本实施例中，充电芯片内部集成了图3的充电电路大部分的元件，而第二开关管M2和电感L位于该充电芯片的外部。具体而言，充电芯片包括电压输入端Vin、电压输出端Vsys、芯片控制端PTM、电感连接端lx、电池端bat、主开关管Q1、续流开关管Q2、第一开关管M1和控制单元，电压输入端Vin用于与充电设备连接，电压输出端Vsys用于连接便携设备的负载电路；电压输入端Vin通过主开关管Q1和续流开关管Q2接地，主开关管Q1和续流开关管Q2的公共端为电感连接端lx，电感连接端lx用于连接外置的电感L并通过电感L连接电压输出端Vsys；主开关管Q1、续流开关管Q2和电感L为降压开关电路的组成部分；电压输入端Vin用于连接外置的第二开关管M2并通过第二开关管M2连接电压输出端Vsys，芯片控制端PTM用于连接第二开关管M2的控制端；电压输出端Vsys通过第一开关管M1连接电池端bat；控制单元用于：若电池端bat的电压小于第一阈值电压，则控制第一开关管M1导通，并通过芯片控制端PTM控制第二开关管M2关断，并控制降压开关电路将电压输入端Vin的电压降压至输出给电压输出端Vsys的第一电压，从而向电压输出端Vsys和电池端bat供电；若电池端bat的电压大于第一阈值电压，且电压输入端Vin与电池端bat的压差大于第二阈值电压时，则控制第一开关管M1导通，通过芯片控制端PTM控制第二开关管M2关断，并且随着电池端bat的电压上升，控制降压开关电路将电压输入端Vin的电压适应性地降压至输出给电压输出端Vsys的对应电压值，使得电压输出端Vsys与电池端bat的电压差为第二电压，从而向电压输出端Vsys和电池端bat供电；若电池端bat的电压大于第一阈值电压，且电压输入端Vin与电压输出端Vsys的压差小于第二阈值电压时，则控制第一开关管M1导通，通过芯片控制端PTM控制第二开关管M2导通，控制降压开关电路关闭，从而使电压输入端Vin的电压通过第二开关管M2和第一开关管M1对向电压输出端Vsys和电池端bat供电。其中，电压输入端Vin的电压、第一电压、第二阈值电压和第一阈值电压依次减小，第一阈值电压与第二阈值电压之和小于电压输入端Vin的电压。本实施例中，充电芯片由于不需要集成大功率的第二开关管M2，因此，成本较低，可靠性更高。充电芯片构成的电路的其他相关功能和参数，可以与图3实施例的充电电路相同，在此不再赘述。在一些实施例中，图4的充电芯片还可以进一步集成第二开关管M2，即该充电芯片内部还包括该第二开关管M2，这样可以提高充电芯片的集成度。本发明还提供了便携设备的充电电路的控制方法，包括如下步骤：若电池端bat的电压小于第一阈值电压，则控制第一开关管M1导通、第二开关管M2关断，并控制降压开关电路将电压输入端Vin的电压降压至输出给电压输出端Vsys的第一电压，从而向电压输出端Vsys和电池端bat供电；若电池端bat的电压大于第一阈值电压，且电压输入端Vin与电池端bat的压差大于第二阈值电压时，则控制第一开关导通、第二开关管M2关断，并且随着电池端bat的电压上升，并控制降压开关电路将电压输入端Vin的电压适应性地降压至输出给电压输出端Vsys的对应电压值，使得电压输出端Vsys与电池端bat的电压差为第二电压，从而向电压输出端Vsys和电池端bat供电；若电池端bat的电压大于第一阈值电压，且电压输入端Vin与电压输出端Vsys的压差小于第二阈值电压时，则控制第一开关管M1和第二开关管M2导通，并控制降压开关电路关闭，电压输入端Vin的电压通过第二开关管M2和第一开关管M1对向电压输出端Vsys和电池端bat供电。本领域的技术人员能够理解的是，在不冲突的前提下，上述各优选方案可以自由地组合、叠加。应当理解，上述的实施方式仅是示例性的，而非限制性的，在不偏离本发明的基本原理的情况下，本领域的技术人员可以针对上述细节做出的各种明显的或等同的修改或替换，都将包含于本发明的权利要求范围内。
