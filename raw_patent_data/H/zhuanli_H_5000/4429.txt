标题title
查询方法和查询系统
摘要abst
本申请提供一种查询方法和查询系统，所述查询方法，包括：查询端向管理端提供待查身份标识；管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端，目标数据端为被管理端管理的多个数据端中的一个；目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值；管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端。在一定程度上提高了命中次数的查询效率。
权利要求书clms
1.一种查询方法，其特征在于，包括：查询端向管理端提供待查身份标识；管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端，目标数据端为被管理端管理的多个数据端中的一个；目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值；管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端。2.根据权利要求1所述的查询方法，其特征在于，所述管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，包括：管理端按照目标数据端要求的分片长度对待查身份标识进行分片处理，得到多个分片标识；从多个分片标识中选择出一个作为目标数据端对应的隐匿查询信息。3.根据权利要求1所述的查询方法，其特征在于，所述目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，包括：目标数据端根据所述隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识；目标数据端将候选身份列表映射到布隆过滤器，得到初步的候选身份向量；目标数据端将初步的候选身份向量中的每个位置的位置值加上自身存储的零和随机数，得到候选身份向量，多个数据端中存储的零和随机数的和为零；向管理端反馈候选身份向量。4.根据权利要求3所述的查询方法，其特征在于，所述向管理端反馈候选身份向量，包括：目标数据端将候选身份向量输入目标数据端和管理端之间的不经意传输模块，以向管理端反馈自身得到的候选身份向量；所述管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，包括：管理端根据待查身份标识得到查询位置，将查询位置输入目标数据端和管理端之间的不经意传输模块，以便目标数据端和管理端之间的不经意传输模块根据目标数据端输入的候选身份向量和管理端输入的查询位置得到所述目标数据端对应的查询位置值；管理端将多个数据端对应的查询位置值相加，得到待查身份标识对应的汇总命中次数。5.根据权利要求4所述的查询方法，其特征在于，所述多个数据端组成一个环，环上的每个数据端分配有环序号，目标数据端的环序号为i；在所述查询端向管理端提供待查身份标识之前，还包括：目标数据端将自身到环序号为i-1的数据端的减一随机数减去自身到环序号为i+1的数据端的加一随机数，得到零和随机数。6.根据权利要求5所述的查询方法，其特征在于，在所述目标数据端将环序号为i+1的数据端的加一随机数减去环序号为i-1的数据端的减一随机数，得到零和随机数之前，还包括：目标数据端针对环序号为i+1的数据端生成第一随机数；环序号为i+1的数据端针对目标数据端生成第二随机数；目标数据端使用环序号为i+1的数据端的公钥加密第一随机数，得到第一加密随机数；目标数据端对目标数据端的公钥和第一加密随机数签名，得到第一签名，将目标数据端的公钥、第一加密随机数和第一签名发送管理端；管理端使用目标数据端的公钥对第一签名进行第一校验；在第一校验通过后，管理端对目标数据端的公钥和第一加密随机数签名，得到第二签名，将目标数据端的公钥、第一加密随机数和第二签名发送至环序号为i+1的数据端；环序号为i+1的数据端使用管理端的公钥对第二签名进行第二校验；在第二校验通过后，环序号为i+1的数据端使用自身的私钥解密第一加密随机数，得到第一解密随机数，根据第二随机数和第一解密随机数生成目标数据端到环序号为i+1的数据端的加一随机数。7.根据权利要求1至6任一项所述的查询方法，其特征在于，所述汇总命中次数包括黑名单命中次数，所述管理端包括银联端，所述数据端包括银行端。8.一种查询系统，其特征在于，包括：查询端、管理端和数据端；查询端用于向管理端提供待查身份标识；管理端用于根据待查身份标识得到目标数据端对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端，目标数据端为被管理端管理的多个数据端中的一个；目标数据端用于根据所述隐匿查询信息向管理端反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值；管理端还用于根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端。9.根据权利要求8所述的查询系统，其特征在于，管理端具体用于按照目标数据端要求的分片长度对待查身份标识进行分片处理，得到多个分片标识；从多个分片标识中选择出一个作为目标数据端对应的隐匿查询信息。10.根据权利要求8所述的查询系统，其特征在于，目标数据端具体用于根据所述隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识；将候选身份列表映射到布隆过滤器，得到初步的候选身份向量；将初步的候选身份向量中的每个位置的位置值加上自身存储的零和随机数，得到候选身份向量，多个数据端中存储的零和随机数的和为零；向管理端反馈候选身份向量。
说明书desc
技术领域本申请涉及多方安全技术领域，具体而言，涉及一种查询方法和查询系统。背景技术用户在向贷款机构贷款时，贷款机构会向多个金融机构发起黑名单查询请求，以便多个金融机构向贷款机构返回黑名单信息，通过黑名单信息，贷款机构可以知晓用户是否命中贷款机构的黑名单，从而在用户多次命中黑名单时，拒绝向用户贷款。现有技术中，贷款机构是分别向各个金融机构发起黑名单查询请求的，然后各个金融机构在接收到黑名单查询请求后再分别查询，导致黑名单的命中次数的获取效率低下。并且，贷款机构在向金融机构发起黑名单查询请求时，会直接向金融机构发送用户的身份标识，例如，身份证号和/或手机号，存在一定的隐私泄露风险。发明内容基于此，提出一种查询方法和查询系统。第一方面，提供了一种查询方法，包括：查询端向管理端提供待查身份标识；管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端，目标数据端为被管理端管理的多个数据端中的一个；目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值；管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端。上述查询方法，管理端会根据待查身份标识得到隐匿查询信息，然后使用隐匿查询信息进行查询，而不是直接使用待查身份标识进行查询，在一定程度降低了用户隐私泄露的风险，并且，各个数据端之间未通信，查询端与各个数据端之间也未通信，进一步降低了用户隐私泄露的风险，并且，查询端只需要一次向管理端发送待查身份标识，即可得到待查身份标识对应的汇总命中次数，在一定程度上提高了命中次数的查询效率。在一个实施例中，所述管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，包括：管理端按照目标数据端要求的分片长度对待查身份标识进行分片处理，得到多个分片标识；从多个分片标识中选择出一个作为目标数据端对应的隐匿查询信息。在一个实施例中，所述目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，包括：目标数据端根据所述隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识；目标数据端将候选身份列表映射到布隆过滤器，得到初步的候选身份向量；目标数据端将初步的候选身份向量中的每个位置的位置值加上自身存储的零和随机数，得到候选身份向量，多个数据端中存储的零和随机数的和为零；向管理端反馈候选身份向量。在一个实施例中，所述向管理端反馈候选身份向量，包括：目标数据端将候选身份向量输入目标数据端和管理端之间的不经意传输模块，以向管理端反馈自身得到的候选身份向量；所述管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，包括：管理端根据待查身份标识得到查询位置，将查询位置输入目标数据端和管理端之间的不经意传输模块，以便目标数据端和管理端之间的不经意传输模块根据目标数据端输入的候选身份向量和管理端输入的查询位置得到所述目标数据端对应的查询位置值；管理端将多个数据端对应的查询位置值相加，得到待查身份标识对应的汇总命中次数。在一个实施例中，所述多个数据端组成一个环，环上的每个数据端分配有环序号，目标数据端的环序号为i；在所述查询端向管理端提供待查身份标识之前，还包括：目标数据端将自身到环序号为i-1的数据端的减一随机数减去自身到环序号为i+1的数据端的加一随机数，得到零和随机数。在一个实施例中，在所述目标数据端将环序号为i+1的数据端的加一随机数减去环序号为i-1的数据端的减一随机数，得到零和随机数之前，还包括：目标数据端针对环序号为i+1的数据端生成第一随机数；环序号为i+1的数据端针对目标数据端生成第二随机数；目标数据端使用环序号为i+1的数据端的公钥加密第一随机数，得到第一加密随机数；目标数据端对目标数据端的公钥和第一加密随机数签名，得到第一签名，将目标数据端的公钥、第一加密随机数和第一签名发送管理端；管理端使用目标数据端的公钥对第一签名进行第一校验；在第一校验通过后，管理端对目标数据端的公钥和第一加密随机数签名，得到第二签名，将目标数据端的公钥、第一加密随机数和第二签名发送至环序号为i+1的数据端；环序号为i+1的数据端使用管理端的公钥对第二签名进行第二校验；在第二校验通过后，环序号为i+1的数据端使用自身的私钥解密第一加密随机数，得到第一解密随机数，根据第二随机数和第一解密随机数生成目标数据端到环序号为i+1的数据端的加一随机数。在一个实施例中，所述汇总命中次数包括黑名单命中次数，所述管理端包括银联端，所述数据端包括银行端。第二方面，提供了一种查询系统，包括：查询端用于向管理端提供待查身份标识；管理端用于根据待查身份标识得到目标数据端对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端，目标数据端为被管理端管理的多个数据端中的一个；目标数据端用于根据所述隐匿查询信息向管理端反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值；管理端还用于根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端。在一个实施例中，管理端具体用于按照目标数据端要求的分片长度对待查身份标识进行分片处理，得到多个分片标识；从多个分片标识中选择出一个作为目标数据端对应的隐匿查询信息。在一个实施例中，目标数据端具体用于根据所述隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识；将候选身份列表映射到布隆过滤器，得到初步的候选身份向量；将初步的候选身份向量中的每个位置的位置值加上自身存储的零和随机数，得到候选身份向量，多个数据端中存储的零和随机数的和为零；向管理端反馈候选身份向量。附图说明为了更清楚地说明本申请实施例的技术方案，下面将对本申请实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本申请的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1为本申请实施例中查询方法的实现流程示意图；图2为本申请实施例中管理端向多个数据端发送隐匿查询信息的示意图；图3为本申请实施例中管理端、数据端和不经意传输模块的示意图；图4为本申请实施例中环的示意图；图5为本申请实施例中共享随机数的示意图；图6为本申请实施例中查询系统的组成结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在一个实施例中，如图1所示，提供了一种查询方法，包括：步骤100，查询端向管理端提供待查身份标识。查询端，为有查询汇总命中次数需求的端，例如，查询端为用户终端，即用户自己查询自己的汇总命中次数，再如，查询端为贷款机构，用户在向贷款机构贷款时，贷款机构查询用户的汇总命中次数。待查身份标识，为被查询对象的身份标识，用于唯一确定一个被查询对象，例如，待查身份标识为身份证号，再如，待查身份标识为手机号，再如，待查身份标识为纳税人识别号，再如，待查身份标识为用户编号。在一个示例中，查询端还发送了回溯时间，以便查询回溯时间到当前时间的汇总命中次数。步骤200，管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端，目标数据端为被管理端管理的多个数据端中的一个。隐匿查询信息和待查身份标识都是数据端可用于查询的信息，但是，如果直接将待查身份标识发送给数据端进行查询，在一定程度上存在用户隐私泄露的风险，因此，根据待查身份标识得到和待查身份标识不同的隐匿查询信息，例如，待查身份标识为1789996，则对1789996进行哈希，得到一个散列值，例如，得到的散列值为2785433321，隐匿查询信息可以为散列值2785433321的前三位：278，从而在一定程度上保障了用户隐私不被泄露。管理端对多个数据端进行管理，目标数据端为多个数据端中的一个。例如，管理端对20个数据端进行管理，则管理端需要得到20个隐匿查询信息，并把20个隐匿查询信息发送给20个数据端，如图2所示。步骤300，目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值。候选身份向量，为一个向量。例如，候选身份标识为1222，候选身份标识在候选身份向量中的位置为12，位置12的位置值为1。在一个示例中，目标数据端根据隐匿查询信息向管理端反馈候选身份向量，包括：目标数据端根据隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识；目标数据端将候选身份列表映射到布隆过滤器，得到候选身份向量；向管理端反馈候选身份向量。例如，待查身份标识为3283561，待查身份标识3283561对应的隐匿查询信息为128，目标数据端自身存储的身份标识的散列值有1286561，3243521，1245555，1698333，5678128，9991588，3331282，7个散列值分别对应不同的身份标识，目标数据端将128与自身存储的7个身份标识的散列值进行匹配，从中选择出包含128的散列值作为候选身份标识，在此例中，候选身份标识包括1286561、5678128和3331282，由三个候选身份标识可以得到候选身份列表，目标数据端将候选身份列表映射到布隆过滤器，即将候选身份标识1286561、5678128和3331282映射到布隆过滤器，得到输出向量，即候选身份向量为，通过候选身份向量看出，总共记录了3个位置，3个位置分别为1、5和7，位置1、5和7的位置值为1，即候选身份向量实现了对候选身份标识的表示，记录了候选身份标识在候选身份向量中的位置和位置值，在得到候选身份向量之后，向管理端反馈候选身份向量。步骤400，管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端。管理端会分别根据待查身份标识和某个数据端反馈的候选身份向量确定待查身份标识是否命中该数据端的候选身份标识，如果待查身份标识命中了该数据端的某个候选身份标识，则汇总命中次数增加1，其中，待查身份标识对应的汇总命中次数，为管理端统计得到的命中各个数据端的次数的和，例如，总共有20个数据端，命中了3个数据端，于是，汇总命中次数为3，将3反馈给查询端。为了更好的理解本申请实施例，对本申请的一个应用场景进行说明，汇总命中次数包括黑名单命中次数，再如，汇总命中次数为白名单命中次数，管理端包括银联端，数据端包括银行端，例如，火星银行，水星银行，太阳银行，宇宙银行，即本申请的应用场景包括通过银联端对银行端的黑名单命中情况进行汇总，得到用户命中各家银行的黑名单的总次数。上述查询方法，管理端会根据待查身份标识得到隐匿查询信息，然后使用隐匿查询信息进行查询，而不是直接使用待查身份标识进行查询，在一定程度降低了用户隐私泄露的风险，并且，各个数据端之间未通信，查询端与各个数据端之间也未通信，进一步降低了用户隐私泄露的风险，并且，查询端只需要一次向管理端发送待查身份标识，即可得到待查身份标识对应的汇总命中次数，在一定程度上提高了命中次数的查询效率。在一个实施例中，步骤200所述管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，包括：步骤201，管理端按照目标数据端要求的分片长度对待查身份标识进行分片处理，得到多个分片标识。每个数据端要求的分片长度可以相同，例如，所有数据端要求的分片长度均为3，也可以不同，从而管理端会按照目标数据端要求的分片长度对待查身份标识进行分片处理，得到目标数据端对应的多个分片标识，然后从中选择一个作为目标数据端对应的隐匿查询信息。步骤202，从多个分片标识中选择出一个作为目标数据端对应的隐匿查询信息。例如，总共有2个数据端，数据端1要求的分片长度为5，数据端2要求的分片长度为3，待查身份标识为5689788881，待查身份标识的散列值为178999666523498，按照数据端1的要求进行分片处理，得到3个分片标识：17899、96665和23498，从3个分片标识中选择出一个，例如，选择出17899作为数据端1对应的隐匿查询信息，按照数据端2的要求进行分片处理，得到5个分片标识：178、999、666、523和498，从5个分片标识中选择出一个，例如，选择出178作为数据端2对应的隐匿查询信息。可以理解的是，有的数据端中存储的身份标识的数量比较大，有的数据端中存储的身份标识的数量比较小，因此，为了让各个数据端提取出来的候选身份标识的数量尽可能一致，并且，提高查询效率，在数据端中存储的身份标识的数量比较大时，可以让该数据端的分片长度大一些，例如，为5位，从而避免提取出过多的候选身份标识，而在数据端中存储的身份标识的数量比较小时，可以让该数据端的分片长度小一些，例如，为3位，从而避免提取出过少的候选身份标识。在一个示例中，管理端还可以按照目标数据端要求的分片长度得到隐匿查询信息的位数，然后根据隐匿查询信息的位数得到隐匿查询信息。例如，数据端1要求的分片长度为5，待查身份标识的散列值为178999666523498，位数为15，于是，隐匿查询信息的位数为5，于是，可以从任意位数开始，提取出5位，即可得到隐匿查询信息，例如，从第二位开始，提取出5位，得到隐匿查询信息为：78999。上述实施例，提供了一种简单的得到隐匿查询信息的方法，即从分片标识中得到隐匿查询信息。在一个实施例中，步骤300所述目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，包括：步骤301，目标数据端根据所述隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识。步骤302，目标数据端将候选身份列表映射到布隆过滤器，得到初步的候选身份向量。步骤301和步骤302，可参照针对步骤300的相关描述，在此不再详述。步骤303，目标数据端将初步的候选身份向量中的每个位置的位置值加上自身存储的零和随机数，得到候选身份向量，多个数据端中存储的零和随机数的和为零。例如，假设目标数据端存储的零和随机数为Zi，初步的候选身份向量为，于是，候选身份向量为。多个数据端中存储的零和随机数的和为零，由此使得最终计算得到的汇总命中次数不受零和随机数的影响，例如，总共有3个数据端，对待查身份标识进行哈希，哈希后得到一个散列值，并且，确定该散列值在候选身份向量中的位置为8，数据端1对应的候选身份向量为，数据端2对应的候选身份向量为，数据端3对应的候选身份向量为，于是，找到数据端1到数据端3对应的候选身份向量中的位置8，然后将位置8的位置值提取出来：Z1，Z2，Z3，将Z1，Z2，Z3相加，得到0，即待查身份标识对应的汇总命中次数为0，若散列值在候选身份向量中的位置为3，则找到数据端1到数据端3对应的候选身份向量中的位置3，然后将位置3的位置值提取出来：Z1+1，Z2，Z3+1，将Z1+1，Z2，Z3+1相加，得到2。步骤304，向管理端反馈候选身份向量。上述实施例，对候选身份向量中的每个位置值都加上了零和随机数，从而在一定程度上防止了隐私泄露，保障了隐私安全，并且，各个数据端的零和随机数的和为0，使得在保密的同时最终的汇总命中次数不会受到零和随机数的影响。在一个实施例中，步骤304所述向管理端反馈候选身份向量，包括：目标数据端将候选身份向量输入目标数据端和管理端之间的不经意传输模块，以向管理端反馈自身得到的候选身份向量；步骤400所述管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，包括：管理端根据待查身份标识得到查询位置，将查询位置输入目标数据端和管理端之间的不经意传输模块，以便目标数据端和管理端之间的不经意传输模块根据目标数据端输入的候选身份向量和管理端输入的查询位置得到所述目标数据端对应的查询位置值；管理端将多个数据端对应的查询位置值相加，得到待查身份标识对应的汇总命中次数。如图3所示，数据端1到N分别通过各自与管理端之间的不经意传输模块向管理端反馈自身得到的候选身份向量。不经意传输模块能够使得管理端只拿到自己想要的数据，例如，管理端对待查身份标识进行哈希，哈希后得到一个散列值，并且，确定该散列值在候选身份向量中的位置为8，表明管理端想要拿到位置8的位置值，则即使数据端输入不经意传输模块的是候选身份向量，管理端也看不到候选身份向量中其他位置的位置值，管理端只能看到位置8的位置值，从而在一定程度上实现了隐私保护。在一个示例中，候选身份向量的尺寸为13，数据端生成了13对公私钥，并把13个公钥发送给了管理端，管理端想要拿到位置8的位置值，管理端生成了一个随机数M，并使用公钥8对随机数M加密，得到加密的随机数M’，将M’发送给数据端，数据端使用13个私钥分别解密M’，得到13个解密结果，数据端将13个解密结果分别与13个位置值进行异或，得到13个异或结果，将13个异或结果发送给管理端，由于管理端持有的随机数为M，因此，管理端在得到13个异或结果之后，管理端能够得到位置8的位置值，得不到其他位置的位置值，在得到位置8的位置值之后，将位置8的位置值作为数据端对应的查询位置值，将各个数据端对应的查询位置值相加，即可得到汇总命中次数。上述实施例，在根据候选身份向量和查询位置得到查询位置值的过程中使用的是不经意传输协议，在一定程度上保障了隐私安全。在一个实施例中，所述多个数据端组成一个环，环上的每个数据端分配有环序号，目标数据端的环序号为i；在步骤100所述查询端向管理端提供待查身份标识之前，还包括：目标数据端将自身到环序号为i-1的数据端的减一随机数减去自身到环序号为i+1的数据端的加一随机数，得到零和随机数。银联端将多个数据端组成一个环，环上的每个数据端均分配有环序号，并将所有的环序号共享给了每个数据端，以便数据端知晓自身的环序号以及相邻的数据端。如图4所示，4个数据端组成了一个环，环上的每个数据端分配有环序号，假设目标数据端的环序号为i，于是，目标数据端将自身到环序号为i-1的数据端的减一随机数减去自身到环序号为i+1的数据端的加一随机数，得到目标数据端的零和随机数，例如，数据端i到数据端i+1的加一随机数为Ri，i+1，数据端i到数据端i-1的减一随机数为Ri，i-1，从而R4，1-R1，2+R1，2-R2，3+R2，3-R3，4+R3，4-R4，1=0。上述实施例，说明了数据端的零和随机数是如何得到并保证零和的。在一个实施例中，在所述目标数据端将环序号为i+1的数据端的加一随机数减去环序号为i-1的数据端的减一随机数，得到零和随机数之前，还包括：目标数据端针对环序号为i+1的数据端生成第一随机数；环序号为i+1的数据端针对目标数据端生成第二随机数；目标数据端使用环序号为i+1的数据端的公钥加密第一随机数，得到第一加密随机数；目标数据端对目标数据端的公钥和第一加密随机数签名，得到第一签名，将目标数据端的公钥、第一加密随机数和第一签名发送管理端；管理端使用目标数据端的公钥对第一签名进行第一校验；在第一校验通过后，管理端对目标数据端的公钥和第一加密随机数签名，得到第二签名，将目标数据端的公钥、第一加密随机数和第二签名发送至环序号为i+1的数据端；环序号为i+1的数据端使用管理端的公钥对第二签名进行第二校验；在第二校验通过后，环序号为i+1的数据端使用自身的私钥解密第一加密随机数，得到第一解密随机数，根据第二随机数和第一解密随机数生成目标数据端到环序号为i+1的数据端的加一随机数。例如图5所示。通过上述步骤，环序号为i+1的数据端可以得到目标数据端到环序号为i+1的数据端的加一随机数，同样的，按照相同的方法，目标数据端也可以得到目标数据端到环序号为i+1的数据端的加一随机数，具体的，环序号为i+1的数据端使用目标数据端的公钥对第二随机数加密，得到第二加密随机数，环序号为i+1的数据端对自身的公钥和第二加密随机数签名，得到第三签名，将环序号为i+1的数据端的公钥、第二加密随机数以及第三签名发送至管理端，管理端使用环序号为i+1的数据端的公钥对第三签名进行第三校验，在第三校验通过后，对环序号为i+1的数据端的公钥和第二加密随机数签名，得到第四签名，将环序号为i+1的数据端的公钥，第二加密随机数和第四签名发送至目标数据端，目标数据端使用管理端的公钥对第四签名进行第四校验，在第四校验通过后，目标数据端使用自身的私钥解密第二加密随机数，得到第二解密随机数，根据第二解密随机数和第一随机数得到目标数据端到环序号为i+1的数据端的加一随机数。环序号为i的数据端到环序号为i+1的数据端的加一随机数等于环序号为i+1的数据端到环序号为i的数据端的减一随机数，即环序号为i+1的数据端在得到的环序号为i的数据端到环序号为i+1的数据端的加一随机数之后，可以将得到的环序号为i的数据端到环序号为i+1的数据端的加一随机数作为环序号为i+1的数据端到环序号为i的数据端的减一随机数。上述实施例，银行之间不直接通信，而是通过银联通信，并且，通信过程中，第一随机数是加密了的，只有持有相应私钥的数据端才能解密，能够进一步的降低信息泄露的风险，并且，通过数据端共享随机数，可以得到加一随机数，以便得到零和随机数。在一个实施例中，提供了一种查询系统600，包括：查询端601、管理端602和数据端603；查询端601用于向管理端602提供待查身份标识；管理端602用于根据待查身份标识得到目标数据端6031对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端6031，目标数据端6031为被管理端602管理的多个数据端603中的一个；目标数据端6031用于根据所述隐匿查询信息向管理端602反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值；管理端602还用于根据待查身份标识和多个数据端603反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端601。在一个实施例中，管理端602具体用于按照目标数据端6031要求的分片长度对待查身份标识进行分片处理，得到多个分片标识；从多个分片标识中选择出一个作为目标数据端6031对应的隐匿查询信息。在一个实施例中，目标数据端6031具体用于根据所述隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识；将候选身份列表映射到布隆过滤器，得到初步的候选身份向量；将初步的候选身份向量中的每个位置的位置值加上自身存储的零和随机数，得到候选身份向量，多个数据端603中存储的零和随机数的和为零；向管理端602反馈候选身份向量。在一个实施例中，目标数据端6031具体用于将候选身份向量输入目标数据端6031和管理端602之间的不经意传输模块，以向管理端602反馈自身得到的候选身份向量；管理端602具体用于根据待查身份标识得到查询位置，将查询位置输入目标数据端6031和管理端602之间的不经意传输模块，以便目标数据端6031和管理端602之间的不经意传输模块根据目标数据端输入的候选身份向量和管理端602输入的查询位置得到所述目标数据端对应的查询位置值；管理端602具体用于将多个数据端603对应的查询位置值相加，得到待查身份标识对应的汇总命中次数。在一个实施例中，所述多个数据端603组成一个环，环上的每个数据端603分配有环序号，目标数据端6031的环序号为i；目标数据端6031还用于将自身到环序号为i-1的数据端603的减一随机数减去自身到环序号为i+1的数据端603的加一随机数，得到零和随机数。在一个实施例中，目标数据端6031还用于针对环序号为i+1的数据端603生成第一随机数；环序号为i+1的数据端603针对目标数据端6031生成第二随机数；目标数据端6031还用于使用环序号为i+1的数据端603的公钥加密第一随机数，得到第一加密随机数；目标数据端6031还用于对目标数据端6031的公钥和第一加密随机数签名，得到第一签名，将目标数据端6031的公钥、第一加密随机数和第一签名发送管理端602；管理端602使用目标数据端6031的公钥对第一签名进行第一校验；在第一校验通过后，管理端602对目标数据端6031的公钥和第一加密随机数签名，得到第二签名，将目标数据端6031的公钥、第一加密随机数和第二签名发送至环序号为i+1的数据端603；环序号为i+1的数据端603使用管理端602的公钥对第二签名进行第二校验；在第二校验通过后，环序号为i+1的数据端603使用自身的私钥解密第一加密随机数，得到第一解密随机数，根据第二随机数和第一解密随机数生成目标数据端到环序号为i+1的数据端的加一随机数。在一个实施例中，所述汇总命中次数包括黑名单命中次数，所述管理端602包括银联端，所述数据端603包括银行端。在一个实施例中，提供一种查询装置，包括：身份查询单元，用于查询端向管理端提供待查身份标识；信息发送单元，用于管理端根据待查身份标识得到目标数据端对应的隐匿查询信息，将所述隐匿查询信息发送至目标数据端，目标数据端为被管理端管理的多个数据端中的一个；信息反馈单元，用于目标数据端根据所述隐匿查询信息向管理端反馈候选身份向量，候选身份向量中记录了候选身份标识在候选身份向量中的位置和位置值；汇总处理单元，用于管理端根据待查身份标识和多个数据端反馈的候选身份向量进行汇总处理，得到待查身份标识对应的汇总命中次数，将待查身份标识对应的汇总命中次数反馈至查询端。在一个实施例中，信息发送单元，具体用于：管理端按照目标数据端要求的分片长度对待查身份标识进行分片处理，得到多个分片标识；从多个分片标识中选择出一个作为目标数据端对应的隐匿查询信息。在一个实施例中，信息反馈单元，具体用于：目标数据端根据所述隐匿查询信息得到候选身份列表，候选身份列表中记录了多个候选身份标识；目标数据端将候选身份列表映射到布隆过滤器，得到初步的候选身份向量；目标数据端将初步的候选身份向量中的每个位置的位置值加上自身存储的零和随机数，得到候选身份向量，多个数据端中存储的零和随机数的和为零；向管理端反馈候选身份向量。在一个实施例中，信息反馈单元，具体用于：目标数据端将候选身份向量输入目标数据端和管理端之间的不经意传输模块，以向管理端反馈自身得到的候选身份向量；汇总处理单元，具体用于：管理端根据待查身份标识得到查询位置，将查询位置输入目标数据端和管理端之间的不经意传输模块，以便目标数据端和管理端之间的不经意传输模块根据目标数据端输入的候选身份向量和管理端输入的查询位置得到所述目标数据端对应的查询位置值；管理端将多个数据端对应的查询位置值相加，得到待查身份标识对应的汇总命中次数。在一个实施例中，所述多个数据端组成一个环，环上的每个数据端分配有环序号，目标数据端的环序号为i；查询装置，还包括：零和单元，用于：目标数据端将自身到环序号为i-1的数据端的减一随机数减去自身到环序号为i+1的数据端的加一随机数，得到零和随机数。在一个实施例中，查询装置，还包括：随机单元，用于：目标数据端针对环序号为i+1的数据端生成第一随机数；环序号为i+1的数据端针对目标数据端生成第二随机数；目标数据端使用环序号为i+1的数据端的公钥加密第一随机数，得到第一加密随机数；目标数据端对目标数据端的公钥和第一加密随机数签名，得到第一签名，将目标数据端的公钥、第一加密随机数和第一签名发送管理端；管理端使用目标数据端的公钥对第一签名进行第一校验；在第一校验通过后，管理端对目标数据端的公钥和第一加密随机数签名，得到第二签名，将目标数据端的公钥、第一加密随机数和第二签名发送至环序号为i+1的数据端；环序号为i+1的数据端使用管理端的公钥对第二签名进行第二校验；在第二校验通过后，环序号为i+1的数据端使用自身的私钥解密第一加密随机数，得到第一解密随机数，根据第二随机数和第一解密随机数生成目标数据端到环序号为i+1的数据端的加一随机数。在一个实施例中，所述汇总命中次数包括黑名单命中次数，所述管理端包括银联端，所述数据端包括银行端。需要说明的是，上述查询方法、查询系统和查询装置属于一个总的发明构思，查询方法、查询系统和查询装置实施例中的内容可相互适用。在本申请所提供的实施例中，应该理解到，所揭露装置和方法，可以通过其它的方式实现。以上所描述的装置实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，又例如，多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些通信接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。另外，作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。再者，在本申请各个实施例中的各功能模块可以集成在一起形成一个独立的部分，也可以是各个模块单独存在，也可以两个或两个以上模块集成形成一个独立的部分。在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。以上所述仅为本申请的实施例而已，并不用于限制本申请的保护范围，对于本领域的技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
