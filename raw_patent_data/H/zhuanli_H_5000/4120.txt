标题title
基于视觉灰度和延时摄影的测绘方法和系统
摘要abst
本发明涉及测绘领域，公开了一种基于视觉灰度和延时摄影的测绘方法和系统，提供了一种利用像素点灰度梯度来判断岸线位置，并基于灰度曲线的突变点来判断湖心岛背面岸线位置的方法及系统，通过单次或少次测绘即可完成对湖心岛轮廓的确定，避免了绕飞测绘所带来的重复定位误差和效率较低的问题。本发明还利用定点照相机进行延时摄影，利用插值拟合得到不同时间的岸线数据，由于岸线变化相对于湖水面积较小，因此插值拟合可以保证在可接受的误差范围内，得到湖面轮廓沿时间的变化情况，对后续监测提供有效的指导。
权利要求书clms
1.一种基于视觉灰度和延时摄影的测绘方法，其特征在于：包括以下步骤：S1、无人机飞临目标湖泊，对目标湖泊进行拍照，确定湖泊外围岸线，确定湖心岛；S2、利用视觉灰度算法对照片进行处理，具体包括：S21、将拍摄的图片按照公式Ⅰ进行灰度处理：公式Ⅰ：；S22、按照公式Ⅱ计算各像素点的最大灰度梯度方向：公式Ⅱ：；式中，x,y为像素点在照片中的位置参数，为单向位置增量，由技术人员手动输入及调整；S23、按照公式Ⅲ，沿最大灰度梯度方向计算各像素点灰度变化函数f：公式Ⅲ：；S24、基于f绘制像素点的灰度变化曲线，将灰度曲线中两个突变点之间的距离确定为临岸宽度L；S3、对于湖心岛处于非视角盲区的水岸，确定灰度曲线中远离湖面的突变点为视觉岸线点；对于湖心岛处于视角盲区的水岸，确定靠近湖面的突变点为岸线基点，从岸线基点沿最大灰度梯度方向前进临岸宽度L，得到推算岸线点；连接湖心岛的视觉岸线点和推算岸线点，得到湖心岛的岸线轮廓；S4、基于湖泊外围岸线和湖心岛的岸线轮廓，计算湖泊的水面面积和湖心岛面积。2.根据权利要求1所述的一种基于视觉灰度和延时摄影的测绘方法，其特征在于：在所述步骤S24中，使用卡尔曼滤波算法对所述灰度变化曲线进行滤波，使曲线平滑化，滤波强度可以由技术人员手动调节。3.根据权利要求1或2所述的一种基于视觉灰度和延时摄影的测绘方法，其特征在于：还包括S5、延时摄影步骤，具体包括：S51、在湖岸高点设置固定式照相机，所述固定式照相机对标记岸线点进行延时摄影，确定水面高度沿时间的位置参数；S52、将某一时刻下，由固定式照相机拍摄的标记岸线点而位置参数，代入在相同时刻下，由无人机拍摄的湖泊外围岸线和湖心岛的岸线轮廓中，完成匹配；S53、将其他时刻下，由固定式照相机拍摄的标记岸线点而位置参数，作为插值点，代入无人机数据，计算该时刻的湖泊外围岸线和湖心岛的岸线轮廓，得到湖面参数沿时间的变化数据。4.一种基于视觉灰度和延时摄影的测绘系统，用于实施如权利要求1-3任一项所述的测绘方法，其特征在于：包括无人机、固定式照相机和计算机，所述计算机内置有数据存储器和算法存储器；所述无人机携带有数码照相机，用于拍摄目标湖泊的照片。5.根据权利要求4所述的一种基于视觉灰度和延时摄影的测绘系统，其特征在于：所述算法存储器用于存储执行如权利要求1-3任一项所述的测绘方法的软件程序。
说明书desc
技术领域本发明属于测绘技术领域，具体为一种基于视觉灰度和延时摄影的测绘方法和系统。背景技术测绘学研究测定和推算地面点的几何位置、地球形状及地球重力场，据此测量地球表面自然形状和人工设施的几何分布，并结合某些社会信息和自然信息的地理分布，编制全球和局部地区各种比例尺的地图和专题地图的理论和技术学科。无人机航测是传统航空摄影测量手段的有力补充，具有机动灵活、高效快速、精细准确、作业成本低、适用范围广、生产周期短等特点，在小区域和飞行困难地区高分辨率影像快速获取方面具有明显优势，随着无人机与数码相机技术的发展，基于无人机平台的数字航摄技术已显示出其独特的优势，无人机与航空摄影测量相结合使得“无人机数字低空遥感”成为航空遥感领域的一个崭新发展方向。现有技术中，存在基于无人机进行测绘的技术方案：CN111982031B公开了一种基于无人机视觉的水面面积测量方法，具体公开了将RGB色度空间转化为YCrCb色度空间以克服高光问题，并基于Canny边缘检测确定水体轮廓。CN111142548A公开了一种测绘无人机以及基于无人机的测绘方法，具体公开了通过在电路板上设置CPU、陀螺仪、气压计、空速计以及遥控器接收机，各部件进行相关工作，以保证无人机在空中航行的稳定性。CN114529599A公开了一种基于深度学习和无人机航拍的湖泊湿地作物面积测绘方法及相关算法，具体公开了利用人工智能分割算法对水生植物区域进行分割，减少人工判断水生植物区域的工作量，降低在分割过程中对经验的依赖和人工判断的影响，提高分割的准确度。上述技术方案提出了对无人机测绘的改进，但是，现有技术在无人机测绘领域，仍然存在以下问题：使用无人机对大面积湖泊进行测绘时，由于无人机的电池容量有限，滞空时间较短，需要重复起落充电，则会产生重复定位的问题，即当无人机电量不足时，需要返回操作区充电，然后返回最后的拍摄点，往返的过程需要耗费电量，效率较低。无人机在返回拍摄点时，需要重复定位并在此校准拍摄设备的角度，存在重复定位误差；并在在飞行拍摄时，由于航迹误差也会造成测绘误差。使用无人机对具有多个湖心岛的湖泊进行拍摄时，无法直接拍摄或估算湖心岛背面的岸线位置，无人机需要飞至湖心岛的另一侧，重复定位并拍摄，造成重复定位误差、电量浪费和效率低下。由于湖面岸线受风力影响会发生波动，造成测绘精度的降低，现有技术未能给出有效的解决方案。湖面岸线会随时间推移，因水面高度的起伏而发生变化，现有技术中，只能在不同的时间段反复派出无人机进行测绘，需要耗费大量的人力物力，效率低下。发明内容一种基于视觉灰度和延时摄影的测绘方法，包括以下步骤：S1、无人机飞临目标湖泊，对目标湖泊进行拍照，确定湖泊外围岸线，确定湖心岛；S2、利用视觉灰度算法对照片进行处理，具体包括：S21、将拍摄的图片按照公式Ⅰ进行灰度处理：公式Ⅰ：；S22、按照公式Ⅱ计算各像素点的最大灰度梯度方向：公式Ⅱ：；式中，x,y为像素点在照片中的位置参数，为单向位置增量，由技术人员手动输入及调整；S23、按照公式Ⅲ，沿最大灰度梯度方向计算各像素点灰度变化函数f：公式Ⅲ：；S24、基于f绘制像素点的灰度变化曲线，将灰度曲线中两个突变点之间的距离确定为临岸宽度L；S3、对于湖心岛处于非视角盲区的水岸，确定灰度曲线中远离湖面的突变点为视觉岸线点；对于湖心岛处于视角盲区的水岸，确定靠近湖面的突变点为岸线基点，从岸线基点沿最大灰度梯度方向前进临岸宽度L，得到推算岸线点；连接湖心岛的视觉岸线点和推算岸线点，得到湖心岛的岸线轮廓；S4、基于湖泊外围岸线和湖心岛的岸线轮廓，计算湖泊的水面面积和湖心岛面积。进一步的，在所述步骤S24中，使用卡尔曼滤波算法对所述灰度变化曲线进行滤波，使曲线平滑化，滤波强度可以由技术人员手动调节。进一步的，还包括S5、延时摄影步骤，具体包括：S51、在湖岸高点设置固定式照相机，所述固定式照相机对标记岸线点进行延时摄影，确定水面高度沿时间的位置参数；S52、将某一时刻下，由固定式照相机拍摄的标记岸线点而位置参数，代入在相同时刻下，由无人机拍摄的湖泊外围岸线和湖心岛的岸线轮廓中，完成匹配；S53、将其他时刻下，由固定式照相机拍摄的标记岸线点而位置参数，作为插值点，代入无人机数据，计算该时刻的湖泊外围岸线和湖心岛的岸线轮廓，得到湖面参数沿时间的变化数据。一种基于视觉灰度和延时摄影的测绘系统，用于实施所述的测绘方法，包括无人机、固定式照相机和计算机，所述计算机内置有数据存储器和算法存储器；所述无人机携带有数码照相机，用于拍摄目标湖泊的照片。进一步的，所述算法存储器用于存储执行所述的测绘方法的软件程序。有益效果与现有技术相比，本发明提供了一种基于区块链的任务调度方法及系统，具备以下有益效果：1、本发明基于灰度图计算像素点的最大灰度变化方向，可以快速找到岸线的法线方向，基于岸线的法线，准确地确定视觉范围内的岸线；并且，技术人员可以根据实际情况，实时调整步距，提高了对岸线判定的效率，保证了判定的可靠性。2、本发明利用浅水区域的灰度不同于深水区域及山体的特点，基于灰度曲线的突变点来判断浅水区域的宽度，进而可以推算出山体背面的岸线位置，通过单次或少次测绘即可完成对湖心岛轮廓的确定，避免了绕飞测绘所带来的重复定位误差和效率较低的问题。3、本发明利用无人机测绘得到湖面的外围轮廓及湖心岛轮廓后，利用定点照相机进行延时摄影，得到数个标记点的水位涨落的位置参数，将这些参数作为插值点，代入岸线轮廓，利用插值拟合得到不同时间的岸线数据，由于岸线变化相对于湖水面积较小，因此插值拟合可以保证在可接受的误差范围内，得到湖面轮廓沿时间的变化情况，对后续监测提供有效的指导。附图说明图1为本发明的经灰度处理的湖心岛照片；图2为本发明的计算最大灰度梯度方向之后并进行了轮廓扩散的示意图；图3为本发明的垂直于最大灰度梯度方向的灰度增强处理的示意图；图4为本发明的灰度变化曲线及突变点示意图；图5为本发明的视线内岸线的示意图；图6为本发明的基于视觉岸线点和推算岸线点得到的湖心岛岸线轮廓的示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一：一种基于视觉灰度和延时摄影的测绘方法，包括以下步骤：S1、无人机飞临目标湖泊，对目标湖泊进行拍照，确定湖泊外围岸线，确定湖心岛；S2、利用视觉灰度算法对照片进行处理，具体包括：S21、将拍摄的图片按照公式Ⅰ进行灰度处理：公式Ⅰ：；在RGB图像中，当R=G=B时，像素点为灰色，公式Ⅰ为灰度均值算法，对于任意像素点，按照该公式计算后，所有的像素点均变为灰色，仅有亮度的差异，从图1中可以看出，经过灰度处理的照片，并不会丢失原有的湖心岛信息、水面信息和岸线信息。S22、按照公式Ⅱ计算各像素点的最大灰度梯度方向：公式Ⅱ：；式中，x,y为像素点在照片中的位置参数，为单向位置增量，由技术人员手动输入及调整；通过调节的值，技术人员可以控制梯度计算的布距和敏感度，具体来说，当被设置的较小时，可以提高梯度计算的精度，精度过高可能造成计算量增大及边缘锯齿效应，当被设置的较大时，可以提高计算效率，但会降低梯度计算的精度，造成图片模糊；图2示出了采用适度偏小的值计算梯度后，进行轮廓扩散处理处理得到的图片，显示岸线周边出现了阴影。S23、按照公式Ⅲ，沿最大灰度梯度方向计算各像素点灰度变化函数f：公式Ⅲ：；如图3所示，求临近像素点的差值求平方的操作，对图像亮度差实现了增强的效果，可以清晰地显示出山体与湖面的中间交界线，具体来说，由于水线在靠近湖心岛的部分，存在风吹波动，并且水位较浅，反射率与湖面和山体均不相同，因此会形成独特的“浅水区域”，该区域具有特殊的色相，对于无人机视野内的水岸线可以直接拍摄，但湖心岛背面的水岸线，通常需要绕飞拍摄，但是，由于无人机的飞行高度较高，通常情况下，无人机至背面岸线的连线夹角，与山体坡角的差异并不大，通常可以拍到浅水区域，但背面岸线由于植被的遮挡，会出现难以拍清晰的问题，如果绕飞，则浪费电量，因此，可以考虑利用“浅水区域”来进行测绘，即，利用浅水区域的在色相图上的变化，确定浅水区域的外围界线之后，推算出浅水区域的内测界线，即岸线，得到湖心岛的岸线轮廓。S24、基于f绘制像素点的灰度变化曲线，将灰度曲线中两个突变点之间的距离确定为临岸宽度L；S3、对于湖心岛处于非视角盲区的水岸，确定灰度曲线中远离湖面的突变点为视觉岸线点；对于湖心岛处于视角盲区的水岸，确定靠近湖面的突变点为岸线基点，从岸线基点沿最大灰度梯度方向前进临岸宽度L，得到推算岸线点；连接湖心岛的视觉岸线点和推算岸线点，得到湖心岛的岸线轮廓；S4、基于湖泊外围岸线和湖心岛的岸线轮廓，计算湖泊的水面面积和湖心岛面积。进一步的，在所述步骤S24中，使用卡尔曼滤波算法对所述灰度变化曲线进行滤波，使曲线平滑化，滤波强度可以由技术人员手动调节。进一步的，还包括S5、延时摄影步骤，具体包括：S51、在湖岸高点设置固定式照相机，所述固定式照相机对标记岸线点进行延时摄影，确定水面高度沿时间的位置参数；S52、将某一时刻下，由固定式照相机拍摄的标记岸线点而位置参数，代入在相同时刻下，由无人机拍摄的湖泊外围岸线和湖心岛的岸线轮廓中，完成匹配；S53、将其他时刻下，由固定式照相机拍摄的标记岸线点而位置参数，作为插值点，代入无人机数据，计算该时刻的湖泊外围岸线和湖心岛的岸线轮廓，得到湖面参数沿时间的变化数据。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。
