标题title
PA设备的转换装置、接入方法、电子设备及存储介质
摘要abst
本发明涉及一种PA设备的转换装置、接入方法、电子设备及存储介质，该转换装置包括：至少两个MODBUS接口分别连接一条MODBUS‑RTU总线；一个PA接口用于连接通过PA总线与多个PA设备连接；冗余判断模块与至少两个MODBUS接口连接，用于判断连接的至少两个MODBUS接口中的一个为主接口，并基于主接口接收实时输出数据；协议处理模块与冗余判断模块和PA接口连接，用于对实时数据进行协议处理，并输出到PA接口。将PROFIBUS‑PA协议转换为MODBUS‑RTU协议，通过MODBUS‑RTU协议对PA设备进行组态配置、修改地址或在线诊断，扩展PROFIBUS‑PA的应用场合。
权利要求书clms
1.一种PA设备的转换装置，其特征在于，所述转换装置包括：至少两个MODBUS接口，每个MODBUS接口分别连接一条MODBUS-RTU总线；一个PA接口，用于连接通过PA总线与多个PA设备连接；冗余判断模块，与所述至少两个MODBUS接口连接，用于判断连接的所述至少两个MODBUS接口中的一个为主接口，并基于所述主接口接收实时输出数据；以及协议处理模块，与所述冗余判断模块和所述PA接口连接，用于对所述实时数据进行协议处理，并输出到所述PA接口。2.根据权利要求1所述的PA设备的转换装置，其特征在于，所述MODBUS接口为RS-485，支持MODBUS-RTU从站协议。3.根据权利要求2所述的PA设备的转换装置，其特征在于，所述PA设备通过一个MODBUS接口进行组态配置、修改PA设备的地址或在线诊断，其余MODBUS接口保持与DCS/PLC系统通讯。4.根据权利要求3所述的PA设备的转换装置，其特征在于，所述PA设备组态配置完成后，所述转换装置冗余接入所述DCS/PLC系统。5.根据权利要求1所述的PA设备的转换装置，其特征在于，所述协议处理模块包括：协议转换单元，与所述冗余判断模块连接，用于对所述实时数据进行协议转换；以及PA协议栈，与所述协议转换单元和所述PA接口连接。6.根据权利要求1所述的PA设备的转换装置，其特征在于，所述多个PA设备经过MODBUS-RTU协议组态配置。7.根据权利要求6所述的PA设备的转换装置，其特征在于，所述MODBUS-RTU协议包括保持寄存器和输入寄存器；所述保持寄存器用于存储PA设备的组态内容；所述输入寄存器为多个MODBUS接口共用的、用于存储多个PA设备的实时输入数据；其中所述保持寄存器和所述输入寄存器均按照PA设备的地址来划分地址范围，每个PA设备分配256个字节的地址范围。8.一种基于权利要求1-7中任一项所述的PA设备的转换装置的接入方法，其特征在于，所述方法包括：判断所述至少两个MODBUS接口中的一个为主接口，并基于所述主接口接收实时输出数据；将所述实时输出数据通过PA协议调度发送给PA设备。9.一种电子设备，其特征在于，包括：处理器；存储器，存储用于所述处理器控制根据权利要求8所述的方法步骤。10.一种存储介质，其上存储有计算机可执行指令，其特征在于，所述可执行指令被处理器执行时实现根据权利要求8所述的方法步骤。
说明书desc
技术领域本发明涉及工业自动化领域，尤其涉及一种PA设备的转换装置、介入方法、电子设备及存储介质。背景技术PROFIBUS-PA作为PROFIBUS标准的一员在过程测量领域有着广泛的应用，其使用IEC61158-2物理层标准，支持总线供电和本质安全。各大厂商有各种PA型号的仪表可供选择，采用PROFIBUS-PA方案相比传统4～20mA信号具有一定的优势。传统接入PROFIBUS-PA的方法是，PLC/DCS系统配置PROFIBUS-DP主站接口模块和配套的PROFIBUS组态软件，在通过PROFIBUS DP/PA耦合器接入PROFIBUS-PA仪表。但这样的配置方式大大限制了PROFIBUS-PA的推广应用，具体原因为：第一，PROFIBUS-DP协议虽然是国际标准，但并非所有厂商默认配置DP接口，而另外采用DP接入方式的成本要大于MODBUS-RTU接入；第二，中小型DCS/PLC厂家不支持PROFIBUS或者支持PROFIBUS的成本很高，但基本上都支持MODBUS-RTU接入；第三，改造项目相比在现有MODBUS-RTU接口上接入，新增PROFIBUS-DP接口用户接受度不高。基于以上原因，往往在PROFIBUS-DP不支持的场合，PROFIBUS-PA也无法使用，PROFIBUS-PA的使用仍然受限。上述缺陷是本领域技术人员期望克服的。发明内容要解决的技术问题为了解决现有技术的上述问题，本发明提供了一种PA设备的转换装置、接入方法、电子设备及存储介质，旨在解决现有技术中存在PROFIBUS-PA的使用仍然受限的问题。技术方案为了解决上述问题，第一方面，本发明提供了一种PA设备的转换装置，所述方法包括：至少两个MODBUS接口，每个MODBUS接口分别连接一条MODBUS-RTU总线；一个PA接口，用于连接通过PA总线与多个PA设备连接；冗余判断模块，与所述至少两个MODBUS接口连接，用于判断连接的所述至少两个MODBUS接口中的一个为主接口，并基于所述主接口接收实时输出数据；以及协议处理模块，与所述冗余判断模块和所述PA接口连接，用于对所述实时数据进行协议处理，并输出到所述PA接口。在本发明的一种示例性实施例中，所述MODBUS接口为RS-485，支持MODBUS-RTU从站协议。在本发明的一种示例性实施例中，所述PA设备通过一个MODBUS接口进行组态配置、修改PA设备的地址或在线诊断，其余MODBUS接口保持与DCS/PLC系统通讯。在本发明的一种示例性实施例中，所述PA设备组态配置完成后，所述转换装置冗余接入所述DCS/PLC系统。在本发明的一种示例性实施例中，所述协议处理模块包括：协议转换单元，与所述冗余判断模块连接，用于对所述实时数据进行协议转换；以及PA协议栈，与所述协议转换单元和所述PA接口连接。在本发明的一种示例性实施例中，所述多个PA设备经过MODBUS-RTU协议组态配置。在本发明的一种示例性实施例中，所述MODBUS-RTU协议包括保持寄存器和输入寄存器；所述保持寄存器用于存储PA设备的组态内容；所述输入寄存器为多个MODBUS接口共用的、用于存储多个PA设备的实时输入数据；其中所述保持寄存器和所述输入寄存器均按照PA设备的地址来划分地址范围，每个PA设备分配256个字节的地址范围。第二方面，本发明还提供了一种基于以上所述PA设备的转换装置的接入方法，所述接入方法包括：判断所述至少两个MODBUS接口中的一个为主接口，并基于所述主接口接收实时输出数据；将所述实时输出数据通过PA协议调度发送给PA设备。第三方面，本发明还提供了一种电子设备，包括：处理器；存储器，存储用于所述处理器控制如上所述的方法步骤。第四方面，本发明还提供了一种存储介质，其上存储有计算机可执行指令，其特征在于，所述可执行指令被处理器执行时实现如上所述的方法步骤。有益效果本发明的有益效果是：本发明实施例提供的PA设备的转换装置、接入方法、电子设备及存储介质，通过该转换装置将PROFIBUS-PA这样的高阶协议转换为工业领域应用最广的MODBUS-RTU协议，通过MODBUS-RTU协议对PA设备进行组态配置、修改地址或在线诊断，扩展PROFIBUS-PA的应用场合。另外，使用PROFIBUS-PA，可降低工厂建设投资费用，实现仪表层的智能化、数字化。附图说明图1为本发明相关实施例中基于MTL831+MTL838的温度采集结构示意图；图2为本发明一个实施例提供的一种PA设备的转换装置的组成框图，；图3为本发明实施例中提供的转换装置原理示意图；图4为本发明另一实施例中还提供一种基于PA设备的转换装置的接入方法的步骤流程图；图5为本发明再一实施例提供的一种电子设备的计算机系统内部结构示意图。具体实施方式为了更好的解释本发明，以便于理解，下面结合附图，通过具体实施方式，对本发明作详细描述。需要说明，本发明实施例中所有方向性指示仅用于解释在某一特定姿态下各部件之间的相对位置关系、运动情况等，如果该特定姿态发生改变时，则该方向性指示也相应地随之改变。另外，在本发明中如涉及“第一”、“第二”等的描述仅用于描述目的，而不能理解为指示或暗示其相对重要性或者隐含指明所指示的技术特征的数据量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本发明的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。本发明相关实施例中采用PROFIBUS-PA现场总线，PA仪表采用数字通讯方式传输仪表的测量结果，可以读取仪表的全部参数，一般也不再有模拟信号输出；但是普通仪表一般为4～20mA仪表，采用模拟信号传送测量结果，只能一路信号一个测量内容，可见，PA仪表相比传统的4～20mA仪表，最直观的特点就是布线简单，省电缆。此外，PA仪表还具有高精度、丰富的诊断报警等功能，尤其在测量点集中的场合，比如集中的温度测量点，使用PA多路温度变送器具有更明显的优势。使用PROFIBUS-PA，最普及的做法是通过PROFIBUS DP/PA耦合器进行转换，将PROFIBUS-PA通过DP总线接入DCS/PLC系统中。缺点是PROFIBUS除有实力的DCS/PLC厂商能够支持外，一般中小厂商不支持，大大限制PROFIBUS-PA的应用。此外，类似于PROFIBUS-PA现场总线的还有一些制造厂家自定义协议，比如MTL的温度采集方案，图1为本发明相关实施例中基于MTL831+MTL838的温度采集结构示意图，如图1所示，MTL838和MTL831之间的通讯协议就是采用MTL自定义的支持总线供电的协议。该技术的缺点在于所有的模块都使用MTL的，产品可替代性很差，组态方式也是MTL自有的风格，兼容性较差，用户使用很不方便。基于上述，本发明提供一种基于PROFIBUS-PA设备的接入方法和转换装置，能够将MODBUS-RTU组态数据转换为PROFIBUS-PA仪表组态，还能够将PROFIBUS-PA仪表实时数据转换为MODBUS-RTU数据，转换装置能够将PROFIBUS-PA协议转换为冗余MODBUS-RTU协议，但同时保留转换为DP协议的功能，因此可以将PROFIBUS-PA应用于大多数场合，突破对PROFIBUS-PA应用的限制。图2为本发明一个实施例提供的一种PA设备的转换装置的组成框图，如图2所示，该转转装置100包括至少两个MODBUS接口101、冗余判断模块102、协议处理模块103和一个PA接口104；至少两个MODBUS接口101中的每个MODBUS接口分别连接一条MODBUS-RTU总线；一个PA接口104用于连接通过PA总线与多个PA设备连接；冗余判断模块102与所述至少两个MODBUS接口101连接，用于判断连接的所述至少两个MODBUS接口101中的一个为主接口，并基于所述主接口接收实时输出数据；以及协议处理模块103与所述冗余判断模块102和所述PA接口104连接，用于对所述实时数据进行协议处理，并输出到所述PA接口104。通过上述转换装置，可以将PROFIBUS-PA这样的高阶协议转换为工业领域应用最广的MODBUS-RTU协议，通过MODBUS-RTU协议对PA设备进行组态配置、修改地址或在线诊断，扩展PROFIBUS-PA的应用场合。图3为本发明实施例中提供的转换装置原理示意图，如图3所示，以两个MODBUS-RTU总线为例，MODBUS-RTU总线通过MODBUS-RTU接口接入，通过冗余判断、协议转换以及PA协议栈的处理后到PA总线。以下结合图2和图3对转换装置进行详细介绍：如图所示的转换装置具有3个接口，2个MODBUS接口和1个PA接口；两个RS-485接口，支持MODBUS-RTU从站协议，可以直接连接MODBUS-RTU总线；一个PA接口可以直接连接PA总线，并给PA总线供电。MODBUS-RTU通过协议，控制器与控制器、控制器通过网络与其他设备之间可以实现串行通信。RTU即远程终端单元，消息中每8位包含两个十六进制字符。在本发明的一种示例性实施例中，MODBUS-RTU接口支持冗余，两个冗余MODBUS-RTU接口先判断主备接口，主接口正常使用主接口实时输出数据，主接口异常，将备用接口切换为主接口。在本发明的一种示例性实施例中，所述PA设备通过一个MODBUS接口进行组态配置、修改PA设备的地址或在线诊断，其余MODBUS接口保持与DCS/PLC系统通讯。配置PA仪表的软件比较灵活，只要支持MODBUS-RTU主站协议即可，例如，可以是威纶通或组态王软件等。本发明中的PA设备主要指PA仪表，按照上述线路连接完成后可以进行PA仪表组态配置，具体步骤包括：每种类型的PA仪表都有对应的GSD文件，开发MODBUS-RTU接口的PA组态软件时，需要专用的DP组态软件来解析GSD文件；根据DP组态软件的解析的组态内容开发对应的PA组态工程文件；工程项目中每种使用PA仪表都需要开发对应的PA组态工程文件。在本发明的一种示例性实施例中，所述PA设备组态配置完成后，将配置软件的MODBUS-RTU接头拿开，所述转换装置冗余接入所述DCS/PLC系统。DCS系统主要特点是分散控制、集中操作、分级管理、配置灵活以及组态方便；PLC系统采用一类可编程的存储器，用于其内部存储程序，执行逻辑运算、顺序控制、定时、计数与算术操作等面向用户的指令，并通过数字或模拟式输入/输出控制各种类型的机械或生产过程，是工业控制的核心部分。在本发明的一种示例性实施例中，所述协议处理模块包括：协议转换单元，与所述冗余判断模块连接，用于对所述实时数据进行协议转换；以及PA协议栈，与所述协议转换单元和所述PA接口连接。在本发明的一种示例性实施例中，所述多个PA设备经过MODBUS-RTU协议组态配置。在本发明的一种示例性实施例中，所述MODBUS-RTU协议包括保持寄存器和输入寄存器；所述保持寄存器用于存储PA设备的组态内容；所述输入寄存器为多个MODBUS接口共用的、用于存储多个PA设备的实时输入数据；其中所述保持寄存器和所述输入寄存器均按照PA设备的地址来划分地址范围，每个PA设备分配256个字节的地址范围。PA组态的内容存储在MODBUS-RTU保持寄存器，按PA仪表地址来划分保持寄存器的地址范围，每个PA仪表地址256字节组态空间。DCS/PLC下发的PA仪表实时输出数据通过MODBUS写保持寄存器，每个PA仪表预留256字节输出空间。MODBUS-RTU接口取到正常的实时输出数据后，再转换成PA协议的数据，通过PA协议调度发送实时输出数据给PA仪表。PA接口接收到PA仪表实时输入数据后，将实时输入数据放置到MODBUS输入寄存器，两个MODBUS接口共用一个输入寄存器，MODBUS输入寄存器同样按PA仪表地址划分，每个PA地址256字节。综上所述，上述转换装置PROFIBUS-PA转换为冗余MODBUS-RTU的转转装置，可以将MODBUS-RTU组态数据转换为PROFIBUS-PA仪表组态，PROFIBUS-PA仪表实时数据转换为MODBUS-RTU数据。将PROFIBUS-PA这样的高阶协议转换为工业领域应用最广的MODBUS-RTU协议，通过MODBUS-RTU协议对PA设备进行组态配置、修改地址或在线诊断，扩展PROFIBUS-PA的应用场合。另外，使用PROFIBUS-PA，可降低工厂建设投资费用，实现仪表层的智能化、数字化。与上述转换装置相对应的，图4为本发明另一实施例中还提供一种基于以上所述PA设备的转换装置的接入方法的步骤流程图，如图4所示，具体包括以下步骤：如图4所示，在步骤S110中，判断所述至少两个MODBUS接口中的一个为主接口，并基于所述主接口接收实时输出数据；如图4所示，在步骤S120中，将所述实时输出数据通过PA协议调度发送给PA设备。本发明按照图2所示的转换装置连接完成后，可以进行PROFIBUS-PA仪表设备的接入和组态，将PROFIBUS-PA协议转换为MODBUS-RTU协议，但同时保留转换为DP协议的功能，PROFIBUS-PA仪表设备的组态可通过MODBUS-RTU协议组态，MODBUS-RTU接口支持冗余，可以通过任意一个MODBUS-RTU接口进行组态配置，然后接入DCS/PLC系统；PROFIBUS-PA仪表支持MODBUS-RTU协议进行诊断。对于数据处理过程如下：上行数据：DCS/PLC下发给PA仪表的实时输出数据通过MODBUS写入到保持寄存器，每个PA仪表预留256字节输出空间；两个冗余MODBUS-RTU接口先判断主备接口，主接口正常使用主接口实时输出数据，主接口异常，将备用接口切换为主接口；协议转换模块收取到正常的实时输出数据后，再将其转换成PA协议的数据，基于PA协议栈通过PA协议调度发送实时输出数据给PA仪表，完成数据传输。下行数据：PA接口接收到PA仪表实时输入数据后，将实时输入数据放存储到MODBUS输入寄存器，两个MODBUS接口共用一个输入寄存器，MODBUS输入寄存器同样按PA仪表地址划分，每个PA地址256字节。基于上述实施例提供的接入方法，能够将MODBUS-RTU组态数据转换为PROFIBUS-PA仪表组态，还可以将PROFIBUS-PA仪表实时数据转换为MODBUS-RTU数据，进而能够将PROFIBUS-PA应用于大多数场合。另外，还可以降低工厂建设投资费用，实现仪表层的智能化、数字化。另一方面，本公开还提供了一种电子设备，包括处理器和存储器，存储器存储用于上述处理器控制以下方法的操作指令：判断所述至少两个MODBUS接口中的一个为主接口，并基于所述主接口接收实时输出数据；将所述实时输出数据通过PA协议调度发送给PA设备。下面参考图5，其示出了适于用来实现本申请实施例的电子设备的计算机系统500的结构示意图。图5示出的电子设备仅仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图5所示，计算机系统400包括中央处理单元401，其可以根据存储在只读存储器402中的程序或者从存储部分407加载到随机访问存储器403中的程序而执行各种适当的动作和处理。在RAM 403中，还存储有系统400操作所需的各种程序和数据。CPU401、ROM 402以及RAM 403通过总线404彼此相连。输入/输出接口405也连接至总线404。以下部件连接至I/O接口405：包括键盘、鼠标等的输入部分406；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分407；包括硬盘等的存储部分408；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分409。通信部分409经由诸如因特网的网络执行通信处理。驱动器410也根据需要连接至I/O接口405。可拆卸介质411，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器410上，以便于从其上读出的计算机程序根据需要被安装入存储部分408。特别地，根据本公开的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本公开的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分409从网络上被下载和安装，和/或从可拆卸介质411被安装。在该计算机程序被中央处理单元401执行时，执行本申请的系统中限定的上述功能。需要说明的是，本申请所示的存储介质可以是计算机可读信号介质或者计算机可读介质或者是上述两者的任意组合。计算机可读介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本申请中，计算机可读介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、电线、光缆、RF等等，或者上述的任意合适的组合。附图中的流程图和框图，图示了按照本申请各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本申请实施例中所涉及到的单元可以通过软件的方式实现，也可以通过硬件的方式来实现。所描述的单元也可以设置在处理器中，其中，这些单元的名称在某种情况下并不构成对该单元本身的限定。另一方面，本公开还提供了一种存储介质，该存储介质可以是上述实施例中描述的电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述存储介质承载有一个或者多个程序，当上述一个或者多个程序被一个该电子设备执行时，使得该电子设备包括以下方法步骤：判断所述至少两个MODBUS接口中的一个为主接口，并基于所述主接口接收实时输出数据；将所述实时输出数据通过PA协议调度发送给PA设备。需要理解的是，以上对本发明的具体实施例进行的描述只是为了说明本发明的技术路线和特点，其目的在于让本领域内的技术人员能够了解本发明的内容并据以实施，但本发明并不限于上述特定实施方式。凡是在本发明权利要求的范围内做出的各种变化或修饰，都应涵盖在本发明的保护范围内。
