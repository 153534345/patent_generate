标题title
一种适用于电力物联网的跳频同步方法
摘要abst
本发明涉及电力物联网技术领域，具体公开了一种适用于电力物联网的跳频同步方法，在开始跳频通信前进行跳频初始同步，基于设计的跳频同步头、捕获扫描策略和时钟同步策略，完成时间信息的粗同步和频率信息的同步，然后再进入第一阶段的正常跳频通信状态。因为跳频发送端和接收端系统时钟的精度的差异，在经过长时间的跳频通信之后，发送端和接收端将会出现时钟偏移，使得跳频同步难以保持。因此，本发明还添加同步维护操作步骤来维护发送端和接收端的实时时钟一致，从而维持可靠的跳频数据通信。最后完成同步保持和校时，完成数据的传输工作。本发明使得收发双方时钟信息基本保持一致，提高了数据通信传输的可靠性。
权利要求书clms
1.一种适用于电力物联网的跳频同步方法，其特征在于，在开始跳频通信前进行跳频初始同步，具体包括步骤：S1、发送端以第一跳速向接收端发送初始同步信息，初始同步信息中每隔2秒插入有一个跳频同步头，每个跳频同步头对应一组频率相关A码和一组频率相关B码，每组频率相关A码中包含4个同步频点Fa0～Fa3顺序重复4次形成的16个同步频率，每组频率相关B码包含4个同步频点Fb0～Fb3顺序形成的4个同步频率；S2、接收端以第二跳速开始捕获扫描，判断是否捕获到频率相关A码的首个相关峰，若否则继续扫描，若是则进入步骤S3；S3、接收端捕获到该相关峰以后，获得发送端的对应频率，完成跳频粗同步，此时接收端固定该频率，以该频率去接收Fb0～Fb3中某一个频率，若未接收到则返回至步骤S1，若接收到则进入步骤S4；S4、接收端根据捕获到的Fb0～Fb3中某个频率的相关峰，获得发送端的时间信息，此时接收端计算出与发送端的时间差，并根据此时间差调整自己的时钟信息，使之与发送端的时钟信息一致，完成跳频频率信息的同步；S5、接收端转移到同步跟跳状态以进一步进入正常跳频通信状态，若否则返回至步骤S1。2.根据权利要求1所述的一种适用于电力物联网的跳频同步方法，其特征在于：第一跳速为第二跳速的4倍。3.根据权利要求2所述的一种适用于电力物联网的跳频同步方法，其特征在于：在步骤S1中，每个跳频同步头占用3个时隙，包含22跳，其中前16跳为4个频点Fa0～Fa3重复4次；第17跳为空跳，用于等待光纤拉远时延；第18至21跳为4个频点Fb0～Fb3；第22跳为空跳。4.根据权利要求2所述的一种适用于电力物联网的跳频同步方法，其特征在于：在步骤S1中，发送端以自身的高位时钟信息产生与频点Fb0～Fb3对应的同步频率集f0～f3，然后按照顺序发送相对应的相关序列CS0～CS3，且每个频率对应一个相关序列，重复4次。5.根据权利要求4所述的一种适用于电力物联网的跳频同步方法，其特征在于：在步骤S2中，接收端一直对接收的4个相关序列CS0～CS3进行相关运算，得到一个相关值并且与序列门限值进行比较，如果相关值小于序列门限值，则表明发送端没有发送相关信息或者没有相符合的频率来发送信息；如果超过序列门限值，则接收端捕获到首个相关峰，即捕获到了对应的频率相关码。6.根据权利要求1所述的一种适用于电力物联网的跳频同步方法，其特征在于：在步骤S3中，接收端接收到的相关峰对应的相关序列为CSn，n＝0,1,...,3，而发送端在发送相关序列时的频率为fn，设当前接收机的频率为Fm，m＝0,1,...,3，则有Fm＝fn，得到当前接收端的高位时钟信息TODH与发送端的高位时钟信息TODh之间的关系为：TODh＝TODH+m-n。7.根据权利要求2～6任一项所述的一种适用于电力物联网的跳频同步方法，其特征在于：第一跳速为256跳/秒，第二跳速为256/4跳/秒。8.根据权利要求7所述的一种适用于电力物联网的跳频同步方法，其特征在于，在步骤S5后还包括步骤：S6、经过长时间的跳频通信之后进行迟入网维护同步，具体包括步骤：S61、发送端将维护同步信息穿插于数据流中向接收端发送，维护同步信息中发送的相关序列和跳频初始同步的不一样，发送格式与频率相同；S62、接收端以第一跳速捕获扫描，确定后续是否捕获到维护同步信息中同步频点Fa0～Fa3的相关峰，若是则接收端在缓冲一跳后进入到下一阶段的正常跳频通信状态，若否则返回至步骤S1。9.根据权利要求8所述的一种适用于电力物联网的跳频同步方法，其特征在于，在步骤S6之后还包括步骤：S7、在跳频初始同步和迟入网维护同步建立后，进入同步保持状态，完成数据的传输工作。10.根据权利要求9所述的一种适用于电力物联网的跳频同步方法，其特征在于：步骤S7中的数据传输以512跳为一跳帧，每一跳帧中有480跳传用户数据，24跳传维护同步信息，8跳保留。
说明书desc
技术领域本发明涉及电力物联网技术领域，尤其涉及一种适用于电力物联网的跳频同步方法。背景技术工作在离散频点上的电力无线专网通信承载于无线通信技术基础上的数据通信资源分配，在很长一段时间内，大型专变用户用电信息采集和监控系统都是采用的这种方式。传统电力无线专网通信系统数据处理速度快、效率高，系统纠错能力强，在以往的用电数据信息采集工作有很大的积极作用。然而随着社会的发展，社会对电力的需求不断上升，电网形态发生变化。接入到电网系统的设备类型和数量呈指数增长，电网系统变得格外复杂，电网系统安全运行压力加大。在现代各种复杂的信号传输环境中，存在着大量的人为或者自然的干扰，其中包括一些正常通信设备的无线收发信号对其他设备的干扰、短波的天波受到的电离层变化的影响以及空间的多径效应带来的快衰落影响等。受此影响，传统的电力无线专网通信系统在运行过程中，收发双方时钟信息不一致，数据通信传输可靠性低，数据在提高电网系统的工作质量、效率效益等方面发挥不充分，大范围能源优化配置资源能力未充分体现，通信接入网覆盖深度不够、带宽不足。发明内容本发明提供一种适用于电力物联网的跳频同步方法，解决的技术问题在于：传统电力无线专网通信系统中存在的收发双方时钟信息不一致，数据通信传输可靠性低。为解决以上技术问题，本发明提供一种适用于电力物联网的跳频同步方法，具体包括步骤：S1、发送端以第一跳速向接收端发送初始同步信息，初始同步信息中每隔2秒插入有一个跳频同步头，每个跳频同步头对应一组频率相关A码和一组频率相关B码，每组频率相关A码中包含4个同步频点Fa0～Fa3顺序重复4次形成的16个同步频率，每组频率相关B码包含4个同步频点Fb0～Fb3顺序形成的4个同步频率；S2、接收端以第二跳速开始捕获扫描，判断是否捕获到频率相关A码的首个相关峰，若否则继续扫描，若是则进入步骤S3；S3、接收端捕获到该相关峰以后，获得发送端的对应频率，完成跳频粗同步，此时接收端固定该频率，以该频率去接收Fb0～Fb3中某一个频率，若未接收到则返回至步骤S1，若接收到则进入步骤S4；S4、接收端根据捕获到的Fb0～Fb3中某个频率的相关峰，获得发送端的时间信息，此时接收端计算出与发送端的时间差，并根据此时间差调整自己的时钟信息，使之与发送端的时钟信息一致，完成跳频频率信息的同步；S5、接收端转移到同步跟跳状态以进一步进入正常跳频通信状态，若否则返回至步骤S1。优选的，第一跳速为第二跳速的4倍。优选的，在步骤S1中，每个跳频同步头占用3个时隙，包含22跳，其中前16跳为4个频点Fa0～Fa3重复4次；第17跳为空跳，用于等待光纤拉远时延；第18至21跳为4个频点Fb0～Fb3；第22跳为空跳。优选的，在步骤S1中，发送端以自身的高位时钟信息产生与频点Fb0～Fb3对应的同步频率集f0～f3，然后按照顺序发送相对应的相关序列CS0～CS3，且每个频率对应一个相关序列，重复4次。优选的，在步骤S2中，接收端一直对接收的4个相关序列CS0～CS3进行相关运算，得到一个相关值并且与序列门限值进行比较，如果相关值小于序列门限值，则表明发送端没有发送相关信息或者没有相符合的频率来发送信息；如果超过序列门限值，则接收端捕获到首个相关峰，即捕获到了对应的频率相关码。优选的，在步骤S3中，接收端接收到的相关峰对应的相关序列为CSn，n＝0,1,...,3，而发送端在发送相关序列时的频率为fn，设当前接收机的频率为Fm，m＝0,1,...,3，则有Fm＝fn，得到当前接收端的高位时钟信息TODH与发送端的高位时钟信息TODh之间的关系为：TODh＝TODH+m-n。优选的，第一跳速为256跳/秒，第二跳速为256/4跳/秒。优选的，在步骤S5后还包括步骤：S6、经过长时间的跳频通信之后进行迟入网维护同步，具体包括步骤：S61、发送端将维护同步信息穿插于数据流中向接收端发送，维护同步信息中发送的相关序列和跳频初始同步的不一样，发送格式与频率相同；S62、接收端以第一跳速捕获扫描，确定后续是否捕获到维护同步信息中同步频点Fa0～Fa3的相关峰，若是则接收端在缓冲一跳后进入到下一阶段的正常跳频通信状态，若否则返回至步骤S1。优选的，在步骤S6之后还包括步骤：S7、在跳频初始同步和迟入网维护同步建立后，进入同步保持状态，完成数据的传输工作。优选的，步骤S7中的数据传输以512跳为一跳帧，每一跳帧中有480跳传用户数据，24跳传维护同步信息，8跳保留。本发明提供的一种适用于电力物联网的跳频同步方法，在开始跳频通信前执行步骤S1～S5进行跳频初始同步，基于设计的跳频同步头、捕获扫描策略和时钟同步策略，完成时间信息的粗同步和频率信息的同步，然后再进入第一阶段的正常跳频通信状态。因为跳频发送端和接收端系统时钟的精度的差异，在经过长时间的跳频通信之后，发送端和接收端将会出现时钟偏移，使得跳频同步难以保持。因此，本发明还添加同步维护操作步骤来维护发送端和接收端的实时时钟一致，从而维持可靠的跳频数据通信。最后完成同步保持和校时，完成数据的传输工作。本发明使得收发双方时钟信息基本保持一致，极大地提高了数据通信传输的可靠性。附图说明图1是本发明实施例提供的跳频同步头的示意图；图2是本发明实施例提供的跳频初始同步过程的状态转移图；图3是本发明实施例提供的发送端进行跳变发送的状态转移图；图4是本发明实施例提供的接收端进行跳变接收的状态转移图。具体实施方式下面结合附图具体阐明本发明的实施方式，实施例的给出仅仅是为了说明目的，并不能理解为对本发明的限定，包括附图仅供参考和说明使用，不构成对本发明专利保护范围的限制，因为在不脱离本发明精神和范围基础上，可以对本发明进行许多改变。为了使得发送端和接收端双方的时钟信息一致，本发明实施例提供了一种适用于电力物联网的跳频同步方法，包括三个方面：跳频初始同步，迟入网维护同步，同步保持和校时。跳频初始同步：在开始跳频通信前进行跳频初始同步，初始跳频同步的主要工作是完成时间信息的粗同步和频率信息的同步，实现跳频同步。跳频初始同步具体包括步骤：S1、发送端以第一跳速向接收端发送初始同步信息，初始同步信息中每隔2秒插入有一个跳频同步头，每个跳频同步头对应一组频率相关A码和一组频率相关B码，每组频率相关A码中包含4个同步频点Fa0～Fa3顺序重复4次形成的16个同步频率，每组频率相关B码包含4个同步频点Fb0～Fb3顺序形成的4个同步频率；S2、接收端以第二跳速开始捕获扫描，判断是否捕获到频率相关A码的首个相关峰，若否则继续扫描，若是则进入步骤S3；S3、接收端捕获到该相关峰以后，获得发送端的对应频率，完成跳频粗同步，此时接收端固定该频率，以该频率去接收Fb0～Fb3中某一个频率，若未接收到则返回至步骤S1，若接收到则进入步骤S4；S4、接收端根据捕获到的Fb0～Fb3中某个频率的相关峰，获得发送端的时间信息，此时接收端计算出与发送端的时间差，并根据此时间差调整自己的时钟信息，使之与发送端的时钟信息一致，完成跳频频率信息的同步；S5、接收端转移到同步跟跳状态以进一步进入正常跳频通信状态，若否则返回至步骤S1。在步骤S1中，如图1所示，每个跳频同步头占用3个时隙，包含22跳，其中前16跳为4个频点Fa0～Fa3重复4次，用于传输频率相关A码；第17跳为空跳，用于等待光纤拉远时延；第18至21跳为4个频点Fb0～Fb3，用于传输频率相关B码；第22跳为空跳。为适用于在电力物联网下完成数据传输，保证跳频同步检测可靠性、并为实现速率提供保证，3个时隙的跳频同步实现均按9.6kbps业务模式的码元带宽模式传输，同时可以适用于更高的码元数据速率传输。分析步骤S1～S5可知，跳频初始同步流程在以下四种状态之间完成转移：同步捕获扫描，同步确认，同步跟跳以及正常跳频通信状态。四种状态的转移如图2所示。同步捕获扫描状态：接收端启动后，首先读取高位时钟信息TODH，产生N个同步频率，设为F0,F1,...,FN-1，同步频率如下：接收端在这N个同步频点上循环慢速扫描。慢速扫描时是相比于正常跳频速度而言，具体表现为接收端在每个频率上驻留时间为正常跳频速的1/，这样在扫描过程中，至少可以保证在某个频率上能捕获到一个完整的相关序列。在步骤S2中，当发送端需要完成数据发送时，根据自身的高位时钟信息产生的同步频率集f0～fN-1，然后按照顺序发送相对应的相关序列，且每个频率对应一个相关序列，重复K次。由跳频同步头的设计可知，本例中N的值为4，K的值为4，同步频率在初始同步过程中，用于捕获的相关序列CS为CS0～CS3，分别对应频率f0～f3。此时频率跳变为正常跳速，此时为了确保接收端能捕获到相关序列，此时应该按照对应频率循环发送相关序列，称为粗同步，长度为16跳。在步骤S3中，在接收端捕获扫描的过程中，需要一直对N个CS序列进行相关运算，得到一个相关值并且与序列门限值进行比较。如果小于序列门限值，则表明发送端没有发送相关信息或者没有相符合的频率来发送信息；如果超过序列门限值，则接收端捕获到首个相关峰，则接收端捕获到了对应的频率相关码。在步骤S4中，当相关值大于相关峰的序列门限值时，设当前接收机的频率为Fm，接收到的相关峰对应的相关序列为CSn，所以发送端在发送相关序列时，有：如果接收端能够得到相关峰的序列门限值，则说明收发双方频率一样，即Fm＝fn，则可以得到当前接收端TODH与发送端TODh之间的关系为：TODh＝TODH+m-n首先接收端调整本地TODH，计算出与之相对应的N个频点，然后根据CSn计算下一跳发送端的发送频率fn+1，得到发送频率信息以后提前将频率控制信息写入信道机，为接下来频率跳变做准备。接收端完成上述功能，标志着接收端结束捕获扫描状态。同步确认状态：同步确认状态用于判断本地高位时钟信息TODH是否正确。此时接收端的频率跳变速率变为正常跳速，如果接收端时钟调整正确，则在接下来的过程中可以继续接收发送端发送的同步消息。因为接收端频率跳变与发送端一致，所以可以接收到每一条对应频率的相关序列，通过相关运算得到的相关值也会超过序列门限值。因为本方案中包含N个同步频率，即同步确认状态的长度为N跳，所以对所有N个同步频点Fa0～Fa3都接收到相关值时，跳频同步捕获完成，转移到同步跟跳状态。同步跟跳状态：当状态转移到同步跟跳时，接收端跳变规律与发送端保持一致，以正常跳变速率速完成频率跳变，因此可以完整的接收到发送端发送的跳频同步信息，如网关信息等。整体来讲，在本跳频初始同步方案中，为适用于电力物联网场景，用一组相关码作为同步频率，即Fa0～Fa3。第一组初始同步频率按照Fa0～Fa3排序，依次跳变，重复4次形成16个同步频率。发送端以256跳/秒的跳速发送同步序列，这些跳频序列和频率表存在对应关系。同时接收端以256/4跳/秒的扫描速度在同步频率上搜索发送端的同步序列。当收发双方有一个频率相同时，接收端就可以捕获到一个相关峰，从而实现同步捕获，完成粗跳频同步。当粗同步捕获到相关峰后，接下来需要跟跳确认。在接收到首个相关峰并进入跟跳阶段后，第二组同步频率按照Fb0～Fb3排序，同样依次跳变一次，以该频率去接收Fb0～Fb3中某一个频率则认为粗同步建立成功，否则返回扫描，并重新获取时钟数据。同时收方根据捕获到相关序列获得发送端的对应频率，由此判断出接收端与发送端的时间差，接收端同样可以根据此时间差调整自己的TODH，使之与发送端的TODh一致。在粗同步建立后，再进行同步确认后，接下来需要传输同步信息，此时已经处于跟跳阶段。接收端在完成初始同步以后，此时达到收发双方同步频率的同步，这就保证了网号、时钟等信息的正确接收。迟入网维护同步：因为跳频发送端和接收端系统时钟的精度的差异，在经过长时间的跳频通信之后，发送端和接收端将会出现时钟偏移，使得跳频同步难以保持。因此，需要添加同步维护操作来维护发送端和接收端的实时时钟一致，从而维持可靠的跳频数据通信。迟入网维护同步和同步保持都是通过同步发送端和接收端的维护信息实现的。维护信息的基本格式和初始同步信息格式是一致的，由于维护信息是穿插于数据流中，受限于帧结构的长度限制，因此维护信息跳数远小于初始信息跳数。迟入网维护同步主要包含同步确认和同步跟跳两个状态。因为初始同步已经完成了时钟信息的同步，此时跳频双方的时钟差异很小，不需要重新进行同步捕获扫描。因为时钟偏移会逐渐地累加，所以只需要对粗同步序列进行确认。同步确认状态长度同样为4跳，如果能够捕获到1个对应的相关峰，则说明目前双方TODH没有偏移，即时钟偏移在可接受时间范围内，可以进入同步跟跳状态。如果不能捕获到1个对应的相关峰，则说明发送端和接收端的时钟偏移较大，则需要重新校正TODH，即状态转为初始同步过程，则此时维护同步结束，并进入到捕获扫描状态，重新完成跳频同步流程。为了区别初始同步与迟入网维护同步，维护同步的粗同步阶段发送相关序列和初始同步的不一样，发送格式与频率相同，同步跟跳和同步确认信息的传输和初始同步相同。在同步确认信息传输完成后，设置了1跳的缓冲时间，然后进入到下一阶段的正常跳频通信状态，此时迟入网维护同步完成。概括来讲，在步骤S5后还包括步骤：S6、经过长时间的跳频通信之后进行迟入网维护同步，具体包括步骤：S61、发送端将维护同步信息穿插于数据流中向接收端发送，维护同步信息中发送的相关序列和跳频初始同步的不一样，发送格式与频率相同；S62、接收端以第一跳速捕获扫描，确定后续是否捕获到维护同步信息中同步频点Fa0～Fa3的相关峰，若是则接收端在缓冲一跳后进入到下一阶段的正常跳频通信状态，若否则返回至步骤S1。同步保持和校时：在步骤S6之后还包括步骤：S7、在跳频初始同步和迟入网维护同步建立后，进入同步保持状态，完成数据的传输工作。同步保持状态是在初始跳频同步和迟入网维护同步建立后的状态，在此状态中完成传输的数据工作。数据传输以512跳为一跳帧，每一跳帧中有480跳传用户数据，24跳传同步维护信息，8跳保留。为实现数据在收发双方完成数据的可靠性传输，按照正常的跳频时序完成数据之间的跳频收发，发送端进行跳频发送的状态转移如图3所示，接收端进行跳频接收的状态转移如图4所示。如图3所示，发送端的跳频转态转移过程主要包括步骤：1、开机，进入同步搜索状态；2、开始发送数据，进入发初始同步信息状态；3、在发初始同步信息状态，进一步初始同步信息发完则进入发数据信息状态和发维护信息状态；4、在发数据信息状态，若下一信息为维护信息，则进入发维护信息状态，进一步数据发送完毕则发结束信息状态；5、在发维护信息状态，若下一信息为数据信息，则进入发数据信息状态，进一步维护信息发送完毕则进入发结束信息状态；6、结束信息发完后，则返回至同步搜索状态。如图4所示，接收端的跳频转态转移过程主要包括步骤：1、开机，进入同步搜索状态；2、在同步搜索状态，若未收到初始同步信息则继续搜索，若收到初始同步信息则进入初始同步状态，若收到维护同步信息则进入迟入网同步状态；3、在初始同步状态，下一跳为维护跳时则进入解维护信息状态，下一跳为数据跳时则进入解数据信息状态；4、在解维护信息状态，下一跳为数据跳则进入解数据信息状态，若无其他解得信息，则进入同步保持状态；5、在解数据信息状态，下一跳为维护跳则进入解维护信息转态，收到发送端发送的结束信息后则进入同步搜索状态；6、在同步保持状态，若同步保持失败则进入同步搜索状态，否则继续保持；7、在迟入网同步状态，若下一跳为数据跳，则进入解数据信息状态，若下一跳为维护跳，则进入解维护信息状态。综上，本发明实施例提供的一种适用于电力物联网的跳频同步方法，在开始跳频通信前执行步骤S1～S5进行跳频初始同步，基于设计的跳频同步头、捕获扫描策略和时钟同步策略，完成时间信息的粗同步和频率信息的同步，然后再进入第一阶段的正常跳频通信状态。因为跳频发送端和接收端系统时钟的精度的差异，在经过长时间的跳频通信之后，发送端和接收端将会出现时钟偏移，使得跳频同步难以保持。因此，本发明还添加同步维护操作步骤来维护发送端和接收端的实时时钟一致，从而维持可靠的跳频数据通信。最后完成同步保持和校时，完成数据的传输工作。本发明使得收发双方时钟信息基本保持一致，极大地提高了数据通信传输的可靠性。上述实施例为本发明较佳的实施方式，但本发明的实施方式并不受上述实施例的限制，其他的任何未背离本发明的精神实质与原理下所作的改变、修饰、替代、组合、简化，均应为等效的置换方式，都包含在本发明的保护范围之内。
