标题title
基于大数据的感知优先级流控的负载均衡方法及其系统
摘要abst
本发明公开了一种基于大数据的感知优先级流控的负载均衡方法及其系统，该方法包括：交换机监听到新数据包后，以新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径；若更换路径，对数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径；其中，利用往返延时RTT和链路利用率周期性探测路径状态，并分为非拥塞路径、触发了优先级流控的不确定路径和拥塞路径；若不需更换路径，继续按照当前路径传输新数据包。进而本发明根据RTT级别的信号初步判断路径状态，利用次RTT级别的信号即数据包的逗留时间来进一步判断路径状态，通过RTT级别和次RTT级别的信号联合做负载均衡决策，有效降低PFC队头阻塞的出现概率。
权利要求书clms
1.一种基于大数据的感知优先级流控的负载均衡方法，其特征在于：包括以下步骤：交换机监听到新数据包后，以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径；若更换路径，则对所述新数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径；其中，利用往返延时RTT和链路利用率周期性探测路径状态，所述路径状态分为：非拥塞路径、触发了优先级流控的不确定路径和拥塞路径；若不需更换路径，则继续按照当前路径传输所述新数据包。2.根据权利要求1所述的负载均衡方法，其特征在于：利用往返延时RTT和链路利用率周期性探测路径状态时，分类规则为：所述往返延时RTT小于预设阈值且所述链路利用率小于1时，对应路径的路径状态为非拥塞路径；所述往返延时RTT大于预设阈值且所述链路利用率小于1时，对应路径的路径状态为触发了优先级流控的不确定路径；所述往返延时RTT大于预设阈值且所述链路利用率等于1时，对应路径的路径状态为拥塞路径。3.根据权利要求2所述的负载均衡方法，其特征在于：所述预设阈值的取值范围为：40微秒+基础往返延时至60微秒+基础往返延时。4.根据权利要求1所述的负载均衡方法，其特征在于：所述依据当前各个路径状态选择最优路径的过程为：若当前存在非拥塞路径，将所述新数据包转发到往返延时RTT最小的非拥塞路径上；若当前不存在非拥塞路径且存在触发了优先级流控的不确定路径，将所述新数据包转发到链路利用率最大的路径上；若仅存在拥塞路径，将所述新数据包转发到往返延时RTT最小的拥塞路径上。5.根据权利要求1所述的负载均衡方法，其特征在于：以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径的过程如下：计算所述新数据包在当前交换机上对应的可接受延时；其中，所述可接受延时的初始值为最优路径与次优路径的延迟差，更新过程为：前一可接受延时减去在交换机上的逗留时间作为下一交换机上对应的可接受延时；判断所述可接受延时是否小于当前交换机上数据包的平均逗留时间、预测的最小排队延时中的最小值；若小于所述最小值，需要更换当前路径；否则，在等待期间判断所述新数据包在所述交换机上的逗留时间是否超过当前的所述可接受延时，或者所述新数据包在当前路径上的累计逗留时间是否超过所述可接受延时的初始值时，若超过，将所述新数据包重新路由，更换当前路径；否则，按照当前路径转发所述新数据包至目的端口。6.根据权利要求1所述的负载均衡方法，其特征在于：传输数据包的初始路径是基于各个路径的往返延时RTT和链路利用率进行选择的最优路径。7.一种基于权利要求1-6任一项所述负载均衡方法的系统，其特征在于：所述系统为数据中心网络系统，所述负载均衡方法应用于所述数据中心网络系统内，对应数据中心网络采用叶-脊网络拓扑结构，其中，叶交换机和脊交换机连接，叶交换机与主机连接。8.一种基于权利要求1-6任一项所述负载均衡方法的系统，其特征在于：包括：监听模块，用于交换机监听是否有新数据包；路径判断模块，用于监听到新数据包后，以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径；路径更新模块，用于对所述新数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径；传输模块，用于不需更换路径时，继续按照当前路径传输所述新数据包；路径状态更新模块，用于利用往返延时RTT和链路利用率周期性探测路径状态，所述路径状态分为：非拥塞路径、触发了优先级流控的不确定路径和拥塞路径。9.一种可读存储介质，其特征在于：存储了计算机程序，所述计算机程序被处理器或处理单元调用以实现：权利要求1-6任一项所述负载均衡方法的步骤。
说明书desc
技术领域本发明属于数据中心网络技术，具体涉及一种基于大数据的感知优先级流控的负载均衡方法及其系统。背景技术为了避免因拥塞造成缓存溢出，现代数据中心以太网络部署了基于优先级的流控机制来实现无数据包丢失的可靠传输。PFC是逐跳流控机制，一旦入端口队列长度超过设定的阈值，交换机向上游交换机发送PFC暂停帧以停止数据传输，直到暂停持续时间结束或者入端口队列长度降低到另一个阈值后由交换机发送PFC恢复帧。由于PFC机制是基于端口或队列的，就会造成无辜流也被暂停，即队头阻塞的问题。近几年提出的端到端传输控制协议，有效缓解了拥塞，减少了PFC触发，进而减少了PFC的负面影响。但这些传输控制方案的拥塞反馈至少需要一个往返延时，因此它们无法控制在一个RTT内就将数据发完的突发流量，导致PFC在这种突发流量造成的瞬时拥塞场景下仍然会触发。作为这些传输控制机制的补充机制，负载均衡机制在由于PFC触发导致的端口暂停传输期间可以及时做出重新路由的决策，以减轻PFC的队头阻塞问题。然而，现有数据中心负载均衡机制在部署了PFC的无损网络中性能不好。其原因有：1)基于本地队列长度做负载均衡决策的方案无法对下游交换机发生的PFC暂停做出及时反应，因此即使本地队列长度最小的路径也不一定是最好的转发路径。2)基于端到端反馈的拥塞信号做负载均衡决策的机制，由于其至少存在一个RTT的反馈延时，无法及时反应路径上的逐跳的PFC暂停，因此延时较大的路径不一定是较差的路径。3)基于链路利用率做负载均衡决策的机制不能正确反映PFC暂停机制，因为链路利用率低的路径不一定表示拥塞小的好路径，有可能路径上发生了PFC暂停，而是较差的路径。因此，如何通过负载均衡机制减轻PFC队头阻塞，优化路径选择仍然是一个亟待解决的问题。发明内容本发明的目的是通过提出的新负载均衡机制进一步减轻PFC的队头阻塞，从而提高吞吐率，降低流完成时间。为此，本发明的技术方案提供一种基于大数据的感知优先级流控的负载均衡方法及其系统，所述负载均衡方法是根据RTT级别的信号即路径往返延时和链路利用率初步判断路径状态，以及利用次RTT级别的信号即数据包的逗留时间来进一步判断路径状态，进而及时应对PFC暂停。其中，选择/更新路径时，用RTT级信号探测路径状态，能在粗粒度上做到负载均衡；在传输过程中，再用次RTT级信号及时应对PFC暂停机制，能在细粒度上减轻数据包的PFC队头阻塞问题。综上，本发明技术方案利用RTT级别和次RTT级别的信号联合做负载均衡决策，以降低PFC队头阻塞的出现概率。一方面，本发明提供一种基于大数据的感知优先级流控的负载均衡方法，其包括以下步骤：交换机监听到新数据包后，以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径；若更换路径，则对所述新数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径；其中，利用往返延时RTT和链路利用率周期性探测路径状态，所述路径状态分为：非拥塞路径、触发了优先级流控的不确定路径和拥塞路径；若不需更换路径，则继续按照当前路径传输所述新数据包。本发明技术方案创造性地提出利用往返延时RTT和链路利用率周期性探测路径状态，并将路径状态划分为非拥塞路径、触发了优先级流控的不确定路径和拥塞路径，从而为数据包选择或者更换路径时能更准确的选择到最优路径；另一方面，数据包的传输过程中，数据包每到达交换机后，都将利用数据包在交换机/当前路径上的逗留时间判断是否需要更换路径，从而能够及时反应路径上的逐跳的PFC暂停，有效减轻PFC的队头阻塞，从而提高吞吐率，降低流完成时间。进一步可选地，利用往返延时RTT和链路利用率周期性探测路径状态时，对应的分类规则为：所述往返延时RTT小于预设阈值且所述链路利用率小于1时，对应路径的路径状态为非拥塞路径；所述往返延时RTT大于预设阈值且所述链路利用率小于1时，对应路径的路径状态为触发了优先级流控的不确定路径；所述往返延时RTT大于预设阈值且所述链路利用率等于1时，对应路径的路径状态为拥塞路径。进一步可选地，所述预设阈值的取值范围为：40微秒+基础往返延时至60微秒+基础往返延时。进一步可选地，所述依据当前各个路径状态选择最优路径的过程为：若当前存在非拥塞路径，将所述新数据包转发到往返延时RTT最小的非拥塞路径上；若当前不存在非拥塞路径且存在触发了优先级流控的不确定路径，将所述新数据包转发到链路利用率最大的路径上；若仅存在拥塞路径，将所述新数据包转发到往返延时RTT最小的拥塞路径上。进一步可选地，以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径的过程如下：计算所述新数据包在当前交换机上对应的可接受延时；其中，所述可接受延时的初始值为最优路径与次优路径的延迟差，更新过程为：前一可接受延时减去在交换机上的逗留时间作为下一交换机上对应的可接受延时；判断所述可接受延时是否小于当前交换机上数据包的平均逗留时间、预测的最小排队延时中的最小值；若小于所述最小值，需要更换当前路径；否则，在等待期间判断所述新数据包在所述交换机上的逗留时间是否超过当前的所述可接受延时，或者所述新数据包在路径上的累计逗留时间是否超过所述可接受延时的初始值时，若超过，将所述新数据包重新路由，更换当前路径；否则，按照当前路径转发所述新数据包至目的端口。应当理解，可接受延时的计算实际上也是基于新数据包在交换机/当前路径上的逗留时间得到。其中，总的思路是统计逗留时间，然而实际应用中，由于数据包的传输是逐跳的，因此，基于逗留时间统计每个交换机对应可接受延时也是一种具体实现过程。进一步可选地，传输数据包的初始路径是基于各个路径的往返延时RTT和链路利用率进行选择的最优路径。第二方面，本发明提供一种基于上述负载均衡方法的系统，其系统为数据中心网络系统，所述负载均衡方法应用于数据中心网络，所述数据中心网络采用叶-脊网络拓扑结构，其中，叶交换机和脊交换机连接，叶交换机与主机连接。第三方面，本发明提供一种基于上述负载均衡方法的系统，包括：监听模块，用于交换机监听是否有新数据包；路径判断模块，用于监听到新数据包后，以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径；路径更新模块，用于对所述新数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径；传输模块，用于不需更换路径时，继续按照当前路径传输所述新数据包；路径状态更新模块，用于利用往返延时RTT和链路利用率周期性探测路径状态，所述路径状态分为：非拥塞路径、触发了优先级流控的不确定路径和拥塞路径。第四方面，本发明提供一种可读存储介质，其存储了计算机程序，所述计算机程序被处理器或处理单元调用以实现：一种感知优先级流控的负载均衡方法的步骤。有益效果本发明技术方案提供的一种感知优先级流控的负载均衡方法，利用RTT级别和次RTT级别的信号联合做负载均衡决策，减轻PFC队头阻塞的程度。其中，RTT级别的信号选用RTT和链路利用率，利用这两个端到端的信号对路径状态做初步分类。并将路径分为3类：非拥塞路径、不确定路径和拥塞路径，从而在选择/更换路径时，能够选择出更优路径作为数据包的转发路径；同时，本发明根据次RTT级别信号即数据包在路径上的逗留时间判断该路径是否有因突发拥塞触发了PFC暂停机制，能够及时反应路径上的逐跳的PFC暂停。综上，本发明用RTT级信号探测路径状态，能在粗粒度上做到负载均衡，同时本发明用次RTT级信号及时应对PFC暂停机制，能在细粒度上减轻数据包的PFC队头阻塞问题。附图说明图1是本发明实施例提供的一种基于大数据的感知优先级流控的负载均衡方法的流程示意图；图2是本发明实验例给出的叶-脊网络拓扑结构示意图；图3为web server工作负载下的性能测试结果示意图，其中，图为平均流完成时间的示意图，图为99分位拖尾流完成时间的示意图，本发明命名为PLB；图4为data mining工作负载下的性能测试结果示意图，其中，图为平均流完成时间的示意图，图为99分位拖尾流完成时间的示意图，本发明命名为PLB。具体实施方式本发明技术方案提供的一种基于大数据的感知优先级流控的负载均衡方法，主要通过三个方面的技术优化来提升负载均衡效果，一方面是利用RTT级别的信号即RTT和链路利用率探测路径状态，并将路径分为三种状态。1)非拥塞路径，即RTT小于一定阈值，且链路利用率小于1；2)不确定路径，即发生了PFC，但不知道会被PFC暂停多久，RTT大于一定阈值，且链路利用率小于1；3)拥塞路径，即RTT大于一定阈值，且链路利用率等于1。进而为数据包重路由选择路径时提供依据。二方面，重新选路路径时，本发明技术方案根据三类路径状态设定了选择规则：即先判断是否有非拥塞路径，如有，则选择最小RTT的有效路径；否则判断是否有不确定路径，如有，则选择最大链路利用率的路径；否则转发数据包到最小RTT路径。三方面，本发明技术方案根据次RTT级别的信号即数据包的逗留时间来进一步判断路径状态，进而及时应对PFC暂停，应当理解，数据包在路径上的累计逗留时间若超过某一阈值，意味着当前路径突发拥塞/PFC暂停，则需要重路由。因此，基于上述思路，本发明提供一种基于大数据的感知优先级流控的负载均衡方法，其包括：交换机监听到新数据包后，以所述新数据包在交换机/当前路径上的逗留时间判断是否需更换路径。其中，如何依据逗留时间来判断是否需要更换路径优选参照下述实施例1的对应过程，应当理解，其他可行的实施例中，基于逗留时间不应该超过某一阈值的基础思路，可以设定其他规则，即在路径上/交换机上数据包的逗留时间太久，会视为该路径可能出现拥塞/PFC情况，进而需要及时更换路径。若更换路径，则对所述数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径；其中，利用往返延时RTT和链路利用率周期性探测路径状态，所述路径状态分为：非拥塞路径、触发了优先级流控的不确定路径和拥塞路径。若不需更换路径，则继续按照当前路径传输所述新数据包。其中，如何依据上述三类路径选择选择最优路径时，优选参照下述实施例1的对应过程，但应当理解，非拥塞路径的优先级是高于触发了优先级流控的不确定路径以及拥塞路径，而不确定路径的优先级高于拥塞路径，因此，其他可行的实施例中，依据上述优先级选择路径时，实际上已属于对现有技术进行了优化，只是存在效果的好坏差异，因此，其他可行的实施例中，不脱离本发明上述三类路径的分类基础上，可以依据其优先级设定其他规则，并不局限于实施例1的对应过程为唯一实现方式。下面将结合实施例对本发明做进一步的说明。实施例1：如图1所示，本实施例提供一种基于大数据的感知优先级流控的负载均衡方法，其包括：S0：初始化设置。其中，基础往返延时设置为50μs；路径状态更新周期阈值Tth设置为100μs；数据包可接受的延时ttd、交换机数据包平均排队延时tavg、出端口最小排队延时tPd、路径状态更新周期的起始时间t均设置为0。S1：交换机监听是否有新数据包达到，若有新数据包达到，执行S2；否则，继续监听是否有新数据包达到。S2：判断当前时间与路径状态更新周期的起始时间t的差值是否大于或等于路径状态更新的周期阈值Tth；若是，执行S3；否则，执行S4；S3：更新每条路径的往返延时和链路利用率，并将所有路径分为三种状态：往返延时小于40微秒与基础往返延时的和，且链路利用率小于1的非拥塞路径；往返延时大于40微秒与基础往返延时的和，且链路利用率小于1的触发了优先级流控的路径；往返延时大于40微秒与基础往返延时的和，且链路利用率等于1的拥塞路径；其中，路径状态更新的每个周期起始时间t设置为当前时间；应当理解，S2-S3的目的在于：保证对新数据包进行探究之前，每条路径在对应的路径状态更新周期内实现更新，即基于路径往返延时以及链路利用率实现路径状态分类：一类：非拥塞路径；二类：触发了优先级流控的路径；三类：拥塞路径。S4：根据RTT级别的信号即路径往返延时和链路利用率选择最优路径为目的出端口路径，并计算当前数据包可接受的延时ttd以及预测目的出端口的最小排队延时tpd。其中，初始最优路径的选择可以是基于下述更换路径时的规则进行选择，也可以是按照路径往返延时和链路利用率越低，越优选的原则进行选取。本实施例中，数据包包头会携带在路径上可接受的延时，初始的可接受延时为最优路径和次优路径的延时差。数据包到达每个交换机后，会先预测目的出端口的排队延时。若数据包不重路由，直接转发到目的出端口，再将数据包包头的可接受延时减去在该交换机上的逗留时间作为下一个可接受延时，即更新的可接受延时实际为数据包在路径上剩余的可接受延时。即仅仅是在第一个交换机上的初始值是最优路径和次优路径的延时之差，其他阶段即在数据包传输路径上的其他交换机上都会更新该可接受延时的数值；换到别的路径上之后，其可接受延时是以当前的最优路径和次优路径重新计算。S5：判断数据包可接受的延时ttd是否小于当前交换机数据包的平均逗留时间tavg与预测的最小排队延时tpd的最小值；若是，执行S7；若否，执行S6；其中，最小排队延时是本领域的常规指标，因此，对其预测手段不进行陈述，可以采用现有技术来实现。S6：在等待期间，监测所述新数据包在所述交换机上的逗留时间是否超过当前的所述可接受延时或监测所述新数据包在路径上的累计逗留时间是否超过所述可接受延时的初始值时，若未超过，转发当前数据包到目的出端口，并更新数据包可接受的延时、更新当前交换机数据包平均逗留时间；若超过，视为当前路径已不是优选路径，执行S7；S7：目的出端口所在路径标记为无效路径，直至该路径状态更新，执行S8；S8：判断非拥塞路径类是否非空；若是，转发前期数据包到有效的最小RTT路径；否则，执行S9；S9：判断已发生的PEF的路径是非空，若是，转发当前数据包到最大链路利用率的路径；否则，执行S10；S10：转发当前数据包到有效的最小RTT路径。按照上述实现过程，本实施例可以有效减轻PFC队头阻塞，从而提高吞吐率，降低流完成时间，提升应用性能。同时也应当理解，本发明该技术方案是可以解决数据中心网络中基于优先级的流控机制存在的技术缺陷，进一步改善了现有数据中心负载均衡机制在部署了PFC的无损网络中性能。应当理解，数据中心网络可以应用于云计算背景。下述实验实例将以叶-脊网络拓扑结构进行验证。实施例2：本实施例提供一种基于所述负载均衡方法的系统，包括：相互连接的监听模块、路径判断模块、路径更新模块、传输模块以及路径状态更新模块。其中，监听模块，用于交换机监听是否有新数据包。路径判断模块，用于监听到新数据包后，以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径。其中，路径是否需要更换的规则可以参照上述方法内容的陈述。譬如，对照实施例1，路径判断模块还包括可接受延时计算单元和判断单元。可接受延时计算单元用于计算所述新数据包在当前交换机上对应的可接受延时。其中，所述可接受延时的初始值为最优路径与次优路径的延迟差，更新过程为：前一可接受延时减去在交换机上的逗留时间作为下一交换机上对应的可接受延时。判断单元，用于判断可接受延时是否小于当前交换机上数据包的平均逗留时间、预测的最小排队延时中的最小值；其中，若小于最小值，需要更换当前路径；否则，在等待期间，继续判断新数据包在交换机上的逗留时间是否超过当前的可接受延时或判断新数据包在路径上的累计逗留时间是否超过可接受延时的初始值。路径更新模块，用于对所述数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径。同理，如何选择最优路径的规则可以参照上述方法内容的陈述。传输模块，用于不需更换路径时，继续按照当前路径传输所述新数据包。路径状态更新模块，用于利用往返延时RTT和链路利用率周期性探测路径状态，所述路径状态分为：非拥塞路径、触发了优先级流控的不确定路径和拥塞路径。具体各个模块的实现过程请参照上述方法的内容，在此不再赘述。应该理解到，上述功能模块的划分仅仅是一种逻辑功能的划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。同时，上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。实施例3：本实施例提供一种可读存储介质，其存储了计算机程序，所述计算机程序被处理器或处理单元调用以实现：交换机监听到新数据包后，以所述新数据包在交换机/当前路径上的逗留时间判断是否需要更换路径；若更换路径，则对所述数据包进行重路由操作，并依据当前各个路径的路径状态选择最优路径；其中，利用往返延时RTT和链路利用率周期性探测路径状态，所述路径状态分为：非拥塞路径、触发了优先级流控的不确定路径和拥塞路径；若不需更换路径，则继续按照当前路径传输所述新数据包。其中，也可以参照实施例1用于实现下述过程：S0：初始化设置。其中，基础往返延时设置为50μs；路径状态更新周期阈值Tth设置为100μs；数据包可接受的延时ttd、交换机数据包平均排队延时tavg、出端口最小排队延时tPd、路径状态更新周期的起始时间t均设置为0。S1：交换机监听是否有新数据包达到，若有新数据包达到，执行S2；否则，继续监听是否有新数据包达到。S2：判断当前时间与路径状态更新周期的起始时间t的差值是否大于或等于路径状态更新的周期阈值Tth；若是，执行S3；否则，执行S4；S3：更新每条路径的往返延时和链路利用率，并将所有路径分为三种状态：往返延时小于40微秒与基础往返延时的和，且链路利用率小于1的非拥塞路径；往返延时大于40微秒与基础往返延时的和，且链路利用率小于1的触发了优先级流控的路径；往返延时大于40微秒与基础往返延时的和，且链路利用率等于1的拥塞路径；其中，路径状态更新的每个周期起始时间t设置为当前时间；S4：根据RTT级别的信号即路径往返延时和链路利用率选择最优路径为目的出端口路径，并计算当前数据包可接受的延时ttd以及预测目的出端口的最小排队延时tpd。S5：判断数据包可接受的延时ttd是否小于当前交换机数据包的平均逗留时间tavg与预测的最小排队延时tpd的最小值；若是，执行S7；若否，执行S6；S6：在等待期间，监测所述新数据包在所述交换机上的逗留时间是否超过当前的所述可接受延时或监测所述新数据包在路径上的累计逗留时间是否超过所述可接受延时的初始值时，若未超过，转发当前数据包到目的出端口，并更新数据包可接受的延时、更新当前交换机数据包平均逗留时间；若超过，视为当前路径已不是优选路径，执行S7；S7：目的出端口所在路径标记为无效路径，直至该路径状态更新，执行S8；S8：判断非拥塞路径类是否非空；若是，转发前期数据包到有效的最小RTT路径；否则，执行S9；S9：判断已发生的PEF的路径是非空，若是，转发当前数据包到最大链路利用率的路径；否则，执行S10；S10：转发当前数据包到有效的最小RTT路径。各个步骤的具体实现过程请参照前述方法的阐述。所述可读存储介质为计算机可读存储介质，其可以是前述任一实施例所述的控制器的内部存储单元，例如控制器的硬盘或内存。所述可读存储介质也可以是所述控制器的外部存储设备，例如所述控制器上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，所述可读存储介质还可以既包括所述控制器的内部存储单元也包括外部存储设备。所述可读存储介质用于存储所述计算机程序以及所述控制器所需的其他程序和数据。所述可读存储介质还可以用于暂时地存储已经输出或者将要输出的数据。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分，或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的可读存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。实验实例：本发明利用NS-3网络仿真平台来实现，并进行了性能测试。实验设置如下：采用叶-脊网络拓扑结构，其中，8个叶交换机和8个脊交换机，128台主机通过40Gbps链路与叶交换机相连。每条链路的网络传播延时为5微秒。图2为测试场景拓扑图。交换机开启了PFC功能，共享缓存的大小为9MB。实验中使用DCQCN作为默认传输协议。实验生成两种典型的数据中心工作负载，即web server和data mining。其中，webserver工作负载中所有流都小于1MB，且大约81％的流小于100KB。Data mining工作负载中大约83％的流小于100KB，约9％的流大于1MB。流的发送时间服从泊松分布。图3为web server工作负载下的性能测试结果示意图，其中，图为平均流完成时间的示意图，图为99分位拖尾流完成时间的示意图。本发明命名为PLB。与其他负载均衡机制相比，本发明在负载增加的情况下，始终达到了最低的流完成时间。这是因为PLB有效地利用RTT和次RTT级信号来感知和响应路径上的PFC暂停。一方面，PLB使用RTT和链路利用率来指导负载平衡决策，从而正确检测不同类型的路径。另一方面，PLB会考虑是否在遇到PFC暂停的情况下通过累积逗留时间小心切换路径，而不是随意重新路由或一直停留在被PFC暂停的路径上。图4为data mining工作负载下的性能测试结果示意图，其中，图为平均流完成时间的示意图，图为99分位拖尾流完成时间的示意图。本发明命名为PLB。Data mining工作负载中包含了更多大流，一旦长时间触发了优先级流控暂停，低链路利用率会误导CONGA选择最优路径，导致性能下降。相比之下，PLB一旦感知到网络中的PFC暂停，就可以在通过数据包逗留时间及时合理的选择转发路径，减轻了PFC暂停导致的队头阻塞的影响。需要强调的是，本发明所述的实例是说明性的，而不是限定性的，因此本发明不限于具体实施方式中所述的实例，凡是由本领域技术人员根据本发明的技术方案得出的其他实施方式，不脱离本发明宗旨和范围的，不论是修改还是替换，同样属于本发明的保护范围。
