标题title
可计费的量子密钥及量子密钥分发网络计费方法及系统
摘要abst
本发明公开了可计费的量子密钥及量子密钥分发网络计费方法及系统，该方法包括以下步骤：S1、利用量子通信服务站分别为第一用户端和第二用户端颁发对应的量子密钥；S2、第一用户端提出与第二用户端对应的量子通信服务站之间的密钥颁发请求；S3、第一用户端发送带币值的量子密钥给第一用户端对应的量子通信服务站，并存储随机数作为用于与第二用户端进行通信的量子密钥；S4、实现第一用户端与第二用户端之间的量子保密通信；S5、量子通信服务站实现数字货币的兑换；S6、利用每次密钥颁发事件的记录对用户端及量子密钥进行计费和计费审计。有益效果：本发明中的量子密钥的计费模式具有简单、灵活及透明的优点。
权利要求书clms
1.可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，该方法包括以下步骤：S1、利用量子通信服务站分别为第一用户端和第二用户端颁发对应的量子密钥；S2、所述第一用户端提出与第二用户端对应的量子通信服务站之间的密钥颁发请求；S3、所述第一用户端发送带币值的量子密钥给第一用户端对应的量子通信服务站，并存储随机数作为用于与第二用户端进行通信的量子密钥；S4、利用量子密钥随机数实现第一用户端与第二用户端之间的量子保密通信；S5、所述量子通信服务站通过货币兑换方法实现数字货币的兑换；S6、利用每次密钥颁发事件的记录对用户端及量子密钥进行计费和计费审计。2.根据权利要求1所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S1中利用量子通信服务站分别为第一用户端和第二用户端颁发对应的量子密钥包括以下步骤：S11、利用第一用户端对应的量子通信服务站为第一用户端颁发第一对称密钥；S12、利用第二用户端对应的量子通信服务站为第二用户端颁发第二对称密钥。3.根据权利要求1所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S11利用第一用户端对应的量子通信服务站为第一用户端颁发第一对称密钥具体包括以下步骤：S111、第一用户端向第一用户端对应的量子通信服务站提出申请带币值的量子密钥的请求，第一用户端对应的量子通信服务站生成随机数及带币值的量子密钥，并发送给第一用户端；S112、所述第一用户端对应的量子通信服务站通过密钥颁发方法为第一用户端颁发各类币值的第一对称密钥，同时，所述第一用户端向第一用户端对应的量子通信服务站支付等价的实体货币；S113、所述第一用户端将各类币值的第一对称密钥形成第一对称密钥池存储于对应的量子密钥卡中，同时，第一用户端对应的量子通信服务站本地保存第一对称密钥池。4.根据权利要求1所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S12中利用第二用户端对应的量子通信服务站为第二用户端颁发第二对称密钥具体包括以下步骤：S121、第二用户端向第二用户端对应的量子通信服务站提出申请带币值的量子密钥的请求，第二用户端对应的量子通信服务站生成随机数及带币值的量子密钥，并发送给第二用户端；S122、所述第二用户端对应的量子通信服务站通过密钥颁发方法为第二用户端颁发各类币值的第二对称密钥，同时，所述第二用户端向第二用户端对应的量子通信服务站支付等价的实体货币；S123、所述第二用户端将各类币值的第二对称密钥形成第二对称密钥池存储于对应的量子密钥卡中，同时，第二用户端对应的量子通信服务站本地保存第二对称密钥池。5.根据权利要求1所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S2中第一用户端提出与第二用户端对应的量子通信服务站之间的密钥颁发请求具体包括以下步骤：S21、所述第一用户端根据第二用户端发送的网络消息或电子邮件及手机短信息得知通信对象第二用户端目前连接于第二用户端对应的量子通信服务站；S22、所述第一用户端向当前连接的第一用户端对应的量子通信服务站提出与第二用户端对应的量子通信服务站之间的密钥颁发请求；S23、所述第一用户端对应的量子通信服务站计算密钥路由确定各中继节点，并根据计费策略计算得到计费明细；S24、所述第一用户端对应的量子通信服务站将计费明细发送给第一用户端。6.根据权利要求1所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S3中第一用户端发送带币值的量子密钥给第一用户端对应的量子通信服务站，并存储随机数作为用于与第二用户端进行通信的量子密钥具体包括以下步骤：S31、所述第一用户端根据计费明细和求和方法计算得到总费用；S32、所述第一用户端选取一个币值等于总费用且尚未使用过的量子密钥，并与当前时间及发款方信息组合得到交易信息；S33、使用所述第一用户端的私钥对交易信息进行签名得到签名信息，并生成第一用户端的密钥颁发事件发送给第一用户端对应的量子通信服务站；S34、所述第一用户端对应的量子通信服务站接收消息并对第一用户端的数字证书、签名信息及量子密钥的签名进行验证，查看交易信息中的量子密钥是否由第一用户端对应的量子通信服务站颁发且未被使用，验证通过后则信任该交易；S35、所述第一用户端对应的量子通信服务站取出量子密钥中的随机数并作为第一用户端与第二用户端之间的密钥；S36、所述第一用户端对应的量子通信服务站将密钥颁发事件通过量子密钥分发网络逐级中继，发送到第二用户端对应的量子通信服务站，且第一用户端对应的量子通信服务站到第二用户端对应的量子通信服务站均存储密钥颁发事件；S37、所述第二用户端对应的量子通信服务站从交易信息中取出量子密钥及量子密钥中的随机数，并将该随机数安全发送到第二用户端，第二用户端将该随机数储存为用于与第一用户端进行通信的量子密钥，并告知第二用户端对应的量子通信服务站密钥颁发完成；S38、密钥分发完成后，所述第二用户端对应的量子通信服务站逐级将成功的消息发送到第一用户端对应的量子通信服务站，第一用户端对应的量子通信服务站将成功的消息发送给第一用户端，将己方第一密钥池中已经使用过的量子密钥删除，并记录第一用户端的密钥颁发事件以备事后审计；S39、所述第一用户端将己方第一密钥池中已经使用过的量子密钥删除，并记录第一用户端的密钥颁发事件以备事后审计，同时，存储随机数作为用于与第二用户端进行通信的量子密钥。7.根据权利要求6所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S36中的中继方法包括以下步骤：首先相邻两个量子通信服务站之间产生量子密钥分发密钥，然后发送方利用该密钥对发送消息进行对称加密后发送给接收方，最后接收方利用密钥进行对称解密，解密后对第一用户端的数字证书、签名信息及量子密钥的签名进行验证。8.根据权利要求1所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S5中量子通信服务站通过货币兑换方法实现数字货币的兑换具体包括以下步骤：S51、密钥分发完成后，各量子通信服务站根据第一用户端的密钥颁发事件向第一用户端对应的量子通信服务站兑换价值等于量子密钥分发中收取费用的实体货币；S52、所述第一用户端对应的量子通信服务站查询所有密钥颁发事件，并找到对应的密钥颁发事件，确认真实后向各量子通信服务站进行支付。9.根据权利要求1所述的可计费的量子密钥及量子密钥分发网络计费方法，其特征在于，所述S6中利用每次密钥颁发事件的记录对用户端及量子密钥进行计费和计费审计包括以下步骤：S61、所述用户端利用每次密钥颁发事件的记录在用户本地进行审计，得到计费明细；S62、所述量子通信服务站利用每次密钥颁发事件的记录对本服务站所颁发的所有被使用的量子密钥及所有中继量子密钥的行为进行计费和计费审计；其中，所述S61包括以下步骤：所述用户端根据每次密钥颁发事件的记录查询得到每次记录所对应的使用币值，并依据所述币值在用户本地进行审计得到计费明细，无需向计费服务端查询。10.可计费的量子密钥及量子密钥分发网络计费系统，用以实现权利要求1-9中任一项所述的可计费的量子密钥及量子密钥分发网络计费方法的步骤，其特征在于，该系统包括量子通信服务站及用户端，所述量子通信服务站之间部署有量子密钥分发网络，且量子通信服务站之间通过量子密钥分发密钥进行安全通信，所述用户端拥有量子密钥卡，存有对称密钥池，且其对应的量子通信服务站存有相同的对称密钥池；所述用户端包括第一用户端和第二用户端，且第一用户端连接于第一用户端对应的量子通信服务站，第二用户端连接于第二用户端对应的量子通信服务站，且第一用户端与第一用户端对应的量子通信服务站之间、第二用户端与第二用户端对应的量子通信服务站之间均进行可靠通信；所述第一用户端和第二用户端均拥有来自证书颁发机构的数字证书及该证书对应的私钥，且该数字证书不会被明发出或读出，所述量子通信服务站下载有证书颁发机构的根证书。
说明书desc
技术领域本发明涉及保密通信领域，尤其涉及可计费的量子密钥及量子密钥分发网络计费方 法及系统。背景技术经济全球化的趋势已经势不可挡，数以百亿计的信息在互联网上流出，就像人类在 存储设备中构建了一个虚拟化的世界，集中了隐私和知识。而这些信息就和现实世界中的资源一样，具有无形的价值。因此，对于个人或组织来说，要确保自己的信息不被窃取，必须将密钥掌握在己方手里才能确保自身信息的安全，对于密钥的管理变得至关重要。传统上的加密方式主要 依靠非对称密码体系。非对称密码体系的优势在于不需要双方约定密钥的过程，减少了 很多成本。但是量子计算机的出现，让现今大部分的非对称密码算法变得不堪一击。伴随着量子计算机出现的还有量子通信。量子密钥分发技术以量子物理基本原理作保障，可以在公开信道上无条件安全地分发密钥，从原理上保证了一旦存在窃 听就必然被发现。一旦在通信双方成功建立了密钥，这组密钥就是安全的，而且这种具 有绝对随机性的密钥从原理上是无法被破解的。量子密钥分发是利用可信中继技术、经典网络通信技术和网络管理技术等实现大规 模、跨地域的安全、高效的密钥分发与管理，实现在不同区域的2台量子保密通信终端间的安全、高效的密钥共享。量子通信网络利用量子密钥分发技术，实现2台量子保密 通信终端间的安全、高效的密钥共享的网络；经典网络即传统的数据通信网络，实现设 备间的数据传输。目前，现有技术存在以下缺陷：1、现有技术中，量子密钥的计费模式不够灵活：一般在颁发时根据量子密钥的数量进行计费；2、现有技术中，量子密钥的计费模式较为繁琐：量子密钥分发和计费是二个独立的流程和二套独立的运行系统，系统搭建和业务逻辑较为复杂；3、现有技术中，量子密钥的计费模式不够透明：用户需要通过查询得到每次通信的计费细节，并且计费细节没有细化到每个中继节点的计费情况。发明内容针对相关技术中的问题，本发明提出可计费的量子密钥及量子密钥分发网络计费方 法及系统，以克服现有相关技术所存在的上述技术问题。为此，本发明采用的具体技术方案如下：根据本发明的一个方面，提供了可计费的量子密钥及量子密钥分发网络计费方法， 该方法包括以下步骤：S1、利用量子通信服务站分别为第一用户端和第二用户端颁发对应的量子密钥；S2、所述第一用户端提出与第二用户端对应的量子通信服务站之间的密钥颁发请求；S3、所述第一用户端发送带币值的量子密钥给第一用户端对应的量子通信服务站， 并存储随机数作为用于与第二用户端进行通信的量子密钥；S4、利用量子密钥随机数实现第一用户端与第二用户端之间的量子保密通信；S5、所述量子通信服务站通过货币兑换方法实现数字货币的兑换；S6、利用每次密钥颁发事件的记录对用户端及量子密钥进行计费和计费审计。进一步的，所述S1中利用量子通信服务站分别为第一用户端和第二用户端颁发对应的量子密钥包括以下步骤：S11、利用第一用户端对应的量子通信服务站为第一用户端颁发第一对称密钥；S12、利用第二用户端对应的量子通信服务站为第二用户端颁发第二对称密钥。进一步的，所述S11利用第一用户端对应的量子通信服务站为第一用户端颁发第一 对称密钥具体包括以下步骤：S111、第一用户端向第一用户端对应的量子通信服务站提出申请带币值的量子密钥 的请求，第一用户端对应的量子通信服务站生成随机数及带币值的量子密钥，并发送给第一用户端；S112、所述第一用户端对应的量子通信服务站通过密钥颁发方法为第一用户端颁发 各类币值的第一对称密钥，同时，所述第一用户端向第一用户端对应的量子通信服务站支付等价的实体货币；S113、所述第一用户端将各类币值的第一对称密钥形成第一对称密钥池存储于对应 的量子密钥卡中，同时，第一用户端对应的量子通信服务站本地保存第一对称密钥池。进一步的，所述S12中利用第二用户端对应的量子通信服务站为第二用户端颁发第 二对称密钥具体包括以下步骤：S121、第二用户端向第二用户端对应的量子通信服务站提出申请带币值的量子密钥 的请求，第二用户端对应的量子通信服务站生成随机数及带币值的量子密钥，并发送给第二用户端；S122、所述第二用户端对应的量子通信服务站通过密钥颁发方法为第二用户端颁发 各类币值的第二对称密钥，同时，所述第二用户端向第二用户端对应的量子通信服务站支付等价的实体货币；S123、所述第二用户端将各类币值的第二对称密钥形成第二对称密钥池存储于对应 的量子密钥卡中，同时，第二用户端对应的量子通信服务站本地保存第二对称密钥池。进一步的，所述S2中第一用户端提出与第二用户端对应的量子通信服务站之间的密钥颁发请求具体包括以下步骤：S21、所述第一用户端根据第二用户端发送的网络消息或电子邮件及手机短信息得 知通信对象第二用户端目前连接于第二用户端对应的量子通信服务站；S22、所述第一用户端向当前连接的第一用户端对应的量子通信服务站提出与第二 用户端对应的量子通信服务站之间的密钥颁发请求；S23、所述第一用户端对应的量子通信服务站计算密钥路由确定各中继节点，并根据计费策略计算得到计费明细；S24、所述第一用户端对应的量子通信服务站将计费明细发送给第一用户端。进一步的，所述S3中第一用户端发送带币值的量子密钥给第一用户端对应的量子通信服务站，并存储随机数作为用于与第二用户端进行通信的量子密钥具体包括以下步骤：S31、所述第一用户端根据计费明细和求和方法计算得到总费用；S32、所述第一用户端选取一个币值等于总费用且尚未使用过的量子密钥，并与当前时间及发款方信息组合得到交易信息；S33、使用所述第一用户端的私钥对交易信息进行签名得到签名信息，并生成第一用户端的密钥颁发事件发送给第一用户端对应的量子通信服务站；S34、所述第一用户端对应的量子通信服务站接收消息并对第一用户端的数字证书、 签名信息及量子密钥的签名进行验证，查看交易信息中的量子密钥是否由第一用户端对 应的量子通信服务站颁发且未被使用，验证通过后则信任该交易；S35、所述第一用户端对应的量子通信服务站取出量子密钥中的随机数并作为第一 用户端与第二用户端之间的密钥；S36、所述第一用户端对应的量子通信服务站将密钥颁发事件通过量子密钥分发网 络逐级中继，发送到第二用户端对应的量子通信服务站，且第一用户端对应的量子通信服务站到第二用户端对应的量子通信服务站均存储密钥颁发事件；S37、所述第二用户端对应的量子通信服务站从交易信息中取出量子密钥及量子密 钥中的随机数，并将该随机数安全发送到第二用户端，第二用户端将该随机数储存为用于与第一用户端进行通信的量子密钥，并告知第二用户端对应的量子通信服务站密钥颁发完成；S38、密钥分发完成后，所述第二用户端对应的量子通信服务站逐级将成功的消息发送到第一用户端对应的量子通信服务站，第一用户端对应的量子通信服务站将成功的消息发送给第一用户端，将己方第一密钥池中已经使用过的量子密钥删除，并记录第一 用户端的密钥颁发事件以备事后审计；S39、所述第一用户端将己方第一密钥池中已经使用过的量子密钥删除，并记录第一用户端的密钥颁发事件以备事后审计，同时，存储随机数作为用于与第二用户端进行 通信的量子密钥。进一步的，所述S36中的中继方法包括以下步骤：首先相邻两个量子通信服务站之间产生量子密钥分发密钥，然后发送方利用该密钥对发送消息进行对称加密后发送给接收方，最后接收方利用密钥进行对称解密，解密后对第一用户端的数字证书、签名信息 及量子密钥的签名进行验证。进一步的，所述S5中量子通信服务站通过货币兑换方法实现数字货币的兑换具体包括以下步骤：S51、密钥分发完成后，各量子通信服务站根据第一用户端的密钥颁发事件向第一用户端对应的量子通信服务站兑换价值等于量子密钥分发中收取费用的实体货币；S52、所述第一用户端对应的量子通信服务站查询所有密钥颁发事件，并找到对应的密钥颁发事件，确认真实后向各量子通信服务站进行支付。进一步的，所述S6中利用每次密钥颁发事件的记录对用户端及量子密钥进行计费和计费审计包括以下步骤：S61、所述用户端利用每次密钥颁发事件的记录在用户本地进行审计，得到计费明细；S62、所述量子通信服务站利用每次密钥颁发事件的记录对本服务站所颁发的所有 被使用的量子密钥及所有中继量子密钥的行为进行计费和计费审计；其中，所述S61包括以下步骤：所述用户端根据每次密钥颁发事件的记录查询得到每次记录所对应的使用币值，并依据所述币值在用户本地进行审计得到计费明细，无需 向计费服务端查询。根据本发明的另一个方面，提供了可计费的量子密钥及量子密钥分发网络计费系统， 该系统包括量子通信服务站及用户端，所述量子通信服务站之间部署有量子密钥分发网 络，且量子通信服务站之间通过量子密钥分发密钥进行安全通信，所述用户端拥有量子密钥卡，存有对称密钥池，且其对应的量子通信服务站存有相同的对称密钥池；所述用户端包括第一用户端和第二用户端，且第一用户端连接于第一用户端对应的 量子通信服务站，第二用户端连接于第二用户端对应的量子通信服务站，且第一用户端与第一用户端对应的量子通信服务站之间、第二用户端与第二用户端对应的量子通信服务站之间均进行可靠通信；所述第一用户端和第二用户端均拥有来自证书颁发机构的数字证书及该证书对应 的私钥，且该数字证书不会被明发出或读出，所述量子通信服务站下载有证书颁发机构的根证书。本发明的有益效果为：1)、本发明中，量子密钥的计费模式比较灵活：根据实际的量子通信路径来计费；2)本发明中，量子密钥的计费模式比较简单：量子密钥分发和计费统一为一个独立的流程和一套独立的运行系统，系统搭建和业务逻辑较为简单；3)本发明中，量子密钥的计费模式比较透明：量子密钥分发网络主动发送计费细节给用户，用户无需通过查询得到每次通信的计费细节，并且计费细节细化到每个中继 节点的计费情况。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需 要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附 图获得其他的附图。图1是根据本发明实施例的可计费的量子密钥及量子密钥分发网络计费方法流程图；图2是根据本发明实施例的可计费的量子密钥及量子密钥分发网络计费方系统的基 本结构图。具体实施方式为进一步说明各实施例，本发明提供有附图，这些附图为本发明揭露内容的一部分， 其主要用以说明实施例，并可配合说明书的相关描述来解释实施例的运作原理，配合参 考这些内容，本领域普通技术人员应能理解其他可能的实施方式以及本发明的优点，图中的组件并未按比例绘制，而类似的组件符号通常用来表示类似的组件。根据本发明的实施例，提供了可计费的量子密钥及量子密钥分发网络计费方法及系 统。现结合附图和具体实施方式对本发明进一步说明，如图1所示，根据本发明的一个实施例，提供了可计费的量子密钥及量子密钥分发网络计费方法，该方法包括以下步骤：S1、密钥颁发；其中，所述S1包括以下步骤：用户端A向量子通信服务站Q1提出申请带币值的量子密钥的请求，Q1生成随机数，生成带币值的量子密钥，将 其发到用户端A，发送方式可以是专线网络或拷贝。带币值的量子密钥的数据结构如下 表所示，由ID、币值、随机数构成。其中，随机数优选为量子随机数。ID币值随机数 Q1向A颁发各类币值的对称密钥时，A需要向Q1支付等价的实体货币。若用户 持有的带币值的量子密钥不想再使用了，可以到Q1处进行退款，并且用户和Q1同时 销毁带币值的量子密钥。A将各类币值的对称密钥形成对称密钥池存储于量子密钥卡中， 同时Q1本地也保存对称密钥池。Qn为B颁发带币值的量子密钥的过程同理。S2、A提出密钥颁发请求；其中，所述S2包括以下步骤：S21、A根据B发送的网络消息或email、手机短信息等其他渠道，得知通信对象B 目前连接于Qn。S22、A向当前连接的量子通信服务站Q1提出与Qn之间的密钥颁发请求。S23、Q1计算密钥路由确定各个中继节点，根据计费策略给出计费明细MD＝ {Qi||Mi,1≤i≤n}。其中，Qi为第i个量子密钥分发节点，Mi为Qi在本次量子密钥分 发中收取的费用。S24、Q1将计费明细MD发送给A。S3、A发送带币值的量子密钥；其中，所述S3包括以下步骤：S31、A计算总费用M＝∑Mi。S32、A随机选取一个币值等于M且尚未使用过的量子密钥AM，与当前时间T， 发款方信息一起组成TX，发款方信息包括IDA和计费明细MD。S33、用A的私钥SKA对TX进行签名得到TXS＝SIGN，其中，SIGN表 示使用私钥sk对m签名。将A的密钥颁发事件EVENT＝TX||TXS||CertA发送给Q1。S34、Q1验证CertA、TXS以及AM的签名，并且查看TX中的AM是否由Q1颁 发且还未被使用。验证通过后信任该交易。S35、Q1取出AM中的随机数AMK作为A和B之间的密钥。S36、Q1将EVENT＝TX||TXS||CertA通过量子密钥分发网络逐级中继，通过Q2、 Q3等节点发送到Qn。中继的方法为，相邻两个量子通信服务站产生QKD密钥QK， 发送方利用QK对发送消息进行对称加密后发送到接收方，接收方用QK进行对称解密， 解密后跟Q1一样验证CertA、TXS以及AM的签名。Q1到Qn均存储EVENT＝TX||TXS||CertA。S37、Qn从TX中取出AM，进一步取出AM中的随机数AMK，将AMK安全发送 到B。B将AMK存储为用于与A进行通信的量子密钥，并告知Qn密钥分发完成。S38、密钥分发完成后，Qn逐级将成功的消息发送到Q1，Q1将成功的消息发送到 A，将密钥池中已经使用过的AM删除，并记录A的密钥颁发事件以备事后审计。S39、A将密钥池中已经使用过的AM删除，并记录A的密钥颁发事件以备事后审 计，存储AMK作为用于与B进行通信的量子密钥。S4、A与B进行量子保密通信；具体的，A与B可以利用前文所述的量子密钥AMK进行各种业务的量子保密通信。S5、量子密钥分发网络成员进行兑换。其中，所述S5包括以下步骤：密钥分发完成后，各量子通信服务站可根据A的密钥颁发事件EVENT，尤其是TX 中的MD中Qi||Mi，向Q1兑换价值Mi的实体货币，可通过现金或网上银行交易的方式。 Q1查询所有密钥颁发事件，找到对应的密钥颁发事件，确认真实后向Qi进行支付。S6、事后审计；其中，所述S6包括以下步骤：用户端因存有每次密钥颁发事件的记录，并且每次的记录均可查到所使用的币值， 因此可以在用户本地进行审计，得到计费明细，无需向计费服务端查询。同样地，量子通信服务站也可以用同样方法进行审计，且可以对本服务站所颁发的所有被使用的量子密钥进行计费和计费审计，也可以对所有中继量子密钥的行为进行计费和计费审计。根据本发明的另一个方面，如图2所示，提供了可计费的量子密钥及量子密钥分发网络计费系统，该系统由量子通信服务站以及用户端组成。量子通信服务站记为Q1、Q2、……、Qn，用户端记为A、B。量子通信服务站之间部署有QKD 网络，可通过QKD密钥进行安全通信。用户端拥有量子密钥卡，存有对称密钥池，同 时其对应的量子通信服务站存有相同对称密钥池。设用户端A连接于Q1，用户端B连接于Qn，A与Q1、B与Qn进行可靠通信， 例如近距离通信、专线通信或利用量子密钥卡的加密通信，以保证信息传输的安全性。用户端均拥有来自CA的数字证书，以及该证书对应的私钥。所有量子通信服务站下载有CA的根证书。为抗量子计算，所有数字证书不会被明文发出或读出。综上所述，借助于本发明的上述技术方案，本发明中，量子密钥的计费模式比较灵活：根据实际的量子通信路径来计费；此外，本发明中，量子密钥的计费模式比较简单： 量子密钥分发和计费统一为一个独立的流程和一套独立的运行系统，系统搭建和业务逻 辑较为简单；此外，本发明中，量子密钥的计费模式比较透明：量子密钥分发网络主动 发送计费细节给用户，用户无需通过查询得到每次通信的计费细节，并且计费细节细化 到每个中继节点的计费情况。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施 例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本发明的几种实施方式，其描述较为具体和详细，但并不 能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的 保护范围。因此，本发明专利的保护范围应以所附权利要求为准。
