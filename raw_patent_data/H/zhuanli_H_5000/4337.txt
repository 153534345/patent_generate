标题title
一种基于环签名的去中心化混币方法
摘要abst
本发明公开了一种基于环签名的去中心化混币方法，属于数字货币用户的隐私保护领域。混币方法包括钱包初始化、混合组组成、混合协议协商、数字货币转入、数字货币重分配和数字货币转出六个阶段步骤。通过在混币过程中完全去中心化管理、定义参与者标准，混合协议的协商以及基于AOS环签名算法签署数字货币的转入交易，提高了数字货币交易的强匿名性，实现了对数字货币交易节点的隐私保护。
权利要求书clms
1.一种基于环签名的去中心化混币方法，应用于基于区块链的数字货币系统，所述数字货币系统包括用于产生数字货币交易的多个节点，所述多个节点包括发起节点，除发起节点以外的其余所有节点为响应节点；其特征在于，所述基于环签名的去中心化混币方法包括：S1、各个节点分别通过数字货币地址生成方法依次生成自己的公私钥对和地址，并将自己拟交易的数字货币分配到自己生成的所述地址中；S2、发起节点广播混合请求，所述混合请求包括响应节点的参与标准，发起节点和符合所述参与标准的响应节点组成混合组；所述参与标准包括响应节点具有的公私钥对数量大于等于第一阈值，且响应节点拟交易的数字货币数量大于等于第二阈值；S3、混合组内各个节点合作生成聚合地址，并协商得到混合协议，然后根据所述混合协议在混合组内公开辅助信息；S4、混合组内各个节点分别创建用于将拟交易的数字货币转入聚合地址的转入交易，并对所述转入交易进行AOS环签名；S5、选取混合组内节点作为验证节点，验证节点根据所述辅助信息对AOS环签名后的转入交易进行验证，若验证通过，则执行S6，若验证不通过，则解散混合组，并终止混币操作；S6、聚合地址对转入的数字货币进行汇集，并按照混合组协商得到的最小分配数量对汇集的数字货币进行分割，所述最小分配数量小于第二阈值；S7、混合组内各个节点分别创建用于从聚合地址取出数字货币的转出交易，并对所述转出交易进行ECDSA签名；S8、验证节点根据所述辅助信息对ECDSA签名后的转出交易进行验证，若节点的转出交易验证通过，则聚合地址向该节点发送数字货币，发送数字货币的数量与该节点拟交易的数字货币数量相同，若节点的转出交易验证不通过，则聚合地址不向该节点发送数字货币。2.根据权利要求1所述的一种基于环签名的去中心化混币方法，其特征在于，所述S1中的公私钥对的数量为多个。3.根据权利要求2所述的一种基于环签名的去中心化混币方法，其特征在于，所述S1的具体步骤为：S11、节点使用伪随机数生成器生成根种子；S12、基于根种子，使用HMAC-SHA512算法生成第一层级的私钥和第一层级的链码；S13、选取一个索引号，基于所述索引号、所述第一层级的私钥和第一层级的链码，使用HMAC-SHA512算法生成第二层级的私钥和第二层级的链码，其中选择的索引号在到之间；S14、根据第一层级的私钥计算第一层级的公钥，并组成一个公私钥对；根据第二层级的私钥计算第二层级的公钥，并组成一个公私钥对；S15、根据第二层级的私钥或第二层级的公钥，以及第二层级的链码，使用HMAC-SHA512算法生成与第二层级同层级的公私钥对和/或第二层级之后多个层级的公私钥对；S16、根据各个公私钥对中的公钥分别生成一个地址，节点将自己拟交易的数字货币分配到一个或多个所述地址中。4.根据权利要求3所述的一种基于环签名的去中心化混币方法，其特征在于，所述S14的具体步骤如下：SS1、根据第一层级的私钥计算第一层级的公钥，组成一个公私钥对，其中为第一大素数，为循环群中的生成元，为第一层级的私钥，i表示节点自己的身份编号；SS2、根据第二层级的私钥计算第二层级的公钥，组成一个公私钥对，其中为第二层级的私钥。5.根据权利要求4所述的一种基于环签名的去中心化混币方法，其特征在于，所述S3中，混合组内各个节点合作生成聚合地址的具体步骤为：SSS1、取第二大素数；SSS2、混合组内各个节点分别生成一个第一随机数，并分别通过自己的公私钥对中的公钥计算第一中间参数，得到个第一中间参数，然后将得到的个第一中间参数在混合组内广播，其中的取值为各个节点自己的公私钥对数量；SSS3、计算聚合地址，其中N的取值为混合组内所有节点的公私钥对之和。6.根据权利要求5所述的一种基于环签名的去中心化混币方法，其特征在于，所述SSS3之后还包括以下步骤：SSS4、重复执行SSS1至SSS3，得到多个不同的聚合地址；其中，所述SSS4中，每次执行SSS2时混合组内至少一个节点改变第一随机数的取值。7.根据权利要求5所述的一种基于环签名的去中心化混币方法，其特征在于，所述S4中，对所述转入交易进行AOS环签名的具体步骤为：SSSS1、选取用于签名的公私钥对，并收集混合组内各个节点所有公私钥对中的公钥，组成公钥集，其中；SSSS2、选择第二随机数，计算第二中间参数，其中，M为所述转入交易，为q阶素数群；SSSS3、选择第三随机数 ，计算，其中，，为第三中间参数，为第四中间参数；SSSS4、计算第五中间参数，其中为第六中间参数；SSSS5、生成AOS环签名。8.根据权利要求7所述的一种基于环签名的去中心化混币方法，其特征在于，所述S3中的混合协议包含：混合组内每个节点必须公开自己拟混合的数字货币数量，且必须公开自己拟参与混币的公私钥对数量；所述S3中的辅助信息包含：拟混合的数字货币数量和拟参与混币的公私钥对数量。9.根据权利要求8所述的一种基于环签名的去中心化混币方法，其特征在于，所述S5中，验证节点根据所述辅助信息对AOS环签名后的转入交易进行验证的具体步骤为：SSSSS1、计算转入交易的数量、拟参与混币的公私钥对数量总和、转入聚合地址的数字货币总数量和拟混合的数字货币数量之和；SSSSS2、判断转入交易的数量与拟参与混币的公私钥对数量总和是否一致、转入聚合地址的数字货币总数量与拟混合的数字货币数量之和是否一致、以及验证AOS环签名是否有效；若转入交易的数量与拟参与混币的公私钥对数量总和一致，且转入聚合地址的数字货币总数量与拟混合的数字货币数量之和一致，且AOS环签名有效，则验证通过，否则验证不通过；其中，所述SSSSS2中，验证AOS环签名是否有效的具体步骤为：S001、计算第七中间参数，，其中；S002、验算等式是否成立，若是，则签名有效，若否，则签名无效。10.根据权利要求8所述的一种基于环签名的去中心化混币方法，其特征在于，所述S8中，验证节点根据所述辅助信息对ECDSA签名后的转出交易进行验证的具体步骤为：S0001、验证ECDSA签名是否有效，以及判断节点拟转出的数字货币数量与该节点拟混合的数字货币数量是否一致，若ECDSA签名有效，且节点拟转出的数字货币数量与该节点拟混合的数字货币数量一致，则该节点的转出交易验证通过，否则该节点的转出交易验证不通过。
说明书desc
技术领域本发明属于数字货币用户的隐私保护领域，特别涉及大额数字货币转账用户的匿名性实现，具体涉及一种基于环签名的去中心化混币方法。背景技术匿名性一直是数字货币隐私保护领域的热门话题。比特币为基于区块链的数字货币之一，其节点创建账户时不需要使用其真实身份，而是在本地产生公私钥对，利用公钥产生交易地址，并且节点可以生成任意多的地址来隐藏自己，故比特币被认为是匿名的数字货币。然而，这种观念并不是正确的。比特币系统内的所有交易信息都是公开透明的，而每一笔交易都与前一个区块中的至少一个其他交易相关联，因此比特币区块链中的所有交易的起源都可以被追溯到。即使交易地址没有与真实身份链接，一旦使用比特币作为支付手段时，交易地址就必将与物理世界产生联系，其他人能够以此为线索，使用聚类分析等技术推断出节点的真实身份。上述内容被称为比特币的伪匿名性。比特币系统使用的P2P网络结构，使其成为跨境交易支付的不错选择。然而，在使用比特币支付时，节点可能并不希望暴露自己的身份。因此，迫切需要一种技术，来应对因比特币伪匿名性给节点带来的隐私泄露的风险。在过去的研究中，已有方法着力于解决比特币的伪匿名性带来的隐私问题。例如，Heilman和Tram等人引入了混合器的概念。现存的混合器中多数为中心化混合器。以CoinJoin为例，该混合器的硬币混合过程由可信的第三方混合服务器执行，需要多个用户往该混合服务器中转入硬币，并且共同生成具有多个输入和输出的组合交易。可信的第三方混合服务器割裂交易的输入地址和输出地址之间的链接，让交易中的比特币无法被正确追溯到原所有者，达到保护隐私的目的。然而，该方案具有局限性。其一、用户们需要为中心化混合服务器提供的硬币混合服务支付额外的费用；其二、由于该混合服务器知道每个原始交易的细则，如果该混合服务器产生恶意，那么用户隐私将完全得不到保证；其三、由于这种中心化的系统结构，该混合服务器很容易成为攻击者的攻击对象，一旦混合服务器被攻击者攻破，那么交易的所有信息将被泄露，在过去已经多次出现了这种案例。因此，需要设计一种去中心化的混币方案，在具有与中心化混合器相同功能的基础上，完全避免中心化混合器所具有的风险。在去中心化的比特币混合方案中，CoinShuffle让节点广播混合要求，其中包括需要混合的硬币数量，混合相同数量硬币的节点组成一个混合组，在混合组中完成混币操作。然而此方案具有局限性。其一、对混合硬币数量的规定增大了创建混合组的难度；其二、混合组节点只是交换彼此地址，由于所有节点都将需求公开，因此其他节点能够从某一个节点的混合量中推断出对应的另一个节点的真实输出地址；其三、该混合过程是在没有在可信任第三方混合服务器的监控下进行的，故难以证明一个节点是恶意节点或是诚实节点，这是去中心化的系统迫切需要解决的问题。在比特币系统中，节点在转让一定数量的比特币时需要为交易签署数字签名，采用的是ECDSA签名验证算法。这是中本聪在2008年根据当时的数字签名系统所做出的技术决定。然而，ECDSA签名算法不适用于比特币混合器。采用ECDSA签名混币交易时，其他节点可以清楚地锁定签名者，这对希望隐藏身份的混合组节点来讲并不理想。对比之下，环签名在这种场景具有显著优势。环签名允许一个签名者代表一个签名集合进行签名，由签名者用自己的私钥和组内其他节点的公钥实现。其他节点验证签名时，仅可验证签名是来自组内的节点，但是无法锁定某个具体节点，因此能够保证签名者身份的匿名性。综上所述，将环签名融入去中心化的混合方案具有可行性。发明内容本发明的目的在于克服背景技术中提到的一项或多项不足，提供一种基于环签名的去中心化混币方法。本发明的目的是通过以下技术方案来实现的：一种基于环签名的去中心化混币方法，应用于基于区块链的数字货币系统，所述数字货币系统包括用于产生数字货币交易的多个节点，所述多个节点包括发起节点，除发起节点以外的其余所有节点为响应节点；所述基于环签名的去中心化混币方法包括：S1、各个节点分别通过数字货币地址生成方法依次生成自己的公私钥对和地址，并将自己拟交易的数字货币分配到自己生成的所述地址中；S2、发起节点广播混合请求，所述混合请求包括响应节点的参与标准，发起节点和符合所述参与标准的响应节点组成混合组；所述参与标准包括响应节点具有的公私钥对数量大于等于第一阈值，且响应节点拟交易的数字货币数量大于等于第二阈值；S3、混合组内各个节点合作生成聚合地址，并协商得到混合协议，然后根据所述混合协议在混合组内公开辅助信息；S4、混合组内各个节点分别创建用于将拟交易的数字货币转入聚合地址的转入交易，并对所述转入交易进行AOS环签名；S5、选取混合组内节点作为验证节点，验证节点根据所述辅助信息对AOS环签名后的转入交易进行验证，若验证通过，则执行S6，若验证不通过，则解散混合组，并终止混币操作；S6、聚合地址对转入的数字货币进行汇集，并按照混合组协商得到的最小分配数量对汇集的数字货币进行分割，所述最小分配数量小于第二阈值；S7、混合组内各个节点分别创建用于从聚合地址取出数字货币的转出交易，并对所述转出交易进行ECDSA签名；S8、验证节点根据所述辅助信息对ECDSA签名后的转出交易进行验证，若节点的转出交易验证通过，则聚合地址向该节点发送数字货币，发送数字货币的数量与该节点拟交易的数字货币数量相同，若节点的转出交易验证不通过，则聚合地址不向该节点发送数字货币。优选地，所述S1中的公私钥对的数量为多个。优选地，所述S1的具体步骤为：S11、节点使用伪随机数生成器生成根种子；S12、基于根种子，使用HMAC-SHA512算法生成第一层级的私钥和第一层级的链码；S13、选取一个索引号，基于所述索引号、所述第一层级的私钥和第一层级的链码，使用HMAC-SHA512算法生成第二层级的私钥和第二层级的链码，其中选择的索引号在到之间；S14、根据第一层级的私钥计算第一层级的公钥，并组成一个公私钥对；根据第二层级的私钥计算第二层级的公钥，并组成一个公私钥对；S15、根据第二层级的私钥或第二层级的公钥，以及第二层级的链码，使用HMAC-SHA512算法生成与第二层级同层级的公私钥对和/或第二层级之后多个层级的公私钥对；S16、根据各个公私钥对中的公钥分别生成一个地址，节点将自己拟交易的数字货币分配到一个或多个所述地址中。优选地，所述S14的具体步骤如下：SS1、根据第一层级的私钥计算第一层级的公钥，组成一个公私钥对，其中为第一大素数，为循环群中的生成元，为第一层级的私钥，i表示节点自己的身份编号；SS2、根据第二层级的私钥计算第二层级的公钥，组成一个公私钥对，其中为第二层级的私钥。优选地，所述S3中，混合组内各个节点合作生成聚合地址的具体步骤为：SSS1、取第二大素数；SSS2、混合组内各个节点分别生成一个第一随机数，并分别通过自己的公私钥对中的公钥计算第一中间参数，得到个第一中间参数，然后将得到的个第一中间参数在混合组内广播，其中的取值为各个节点自己的公私钥对数量；SSS3、计算聚合地址，其中N的取值为混合组内所有节点的公私钥对之和。优选地，所述SSS3之后还包括以下步骤：SSS4、重复执行SSS1至SSS3，得到多个不同的聚合地址；其中，所述SSS4中，每次执行SSS2时混合组内至少一个节点改变第一随机数的取值。优选地，所述S4中，对所述转入交易进行AOS环签名的具体步骤为：SSSS1、选取用于签名的公私钥对，并收集混合组内各个节点所有公私钥对中的公钥，组成公钥集，其中；SSSS2、选择第二随机数，计算第二中间参数，其中，M为所述转入交易，为q阶素数群；SSSS3、选择第三随机数 ，计算，其中，，为第三中间参数，为第四中间参数；SSSS4、计算第五中间参数，其中为第六中间参数；SSSS5、生成AOS环签名。优选地，所述S3中的混合协议包含：混合组内每个节点必须公开自己拟混合的数字货币数量，且必须公开自己拟参与混币的公私钥对数量；所述S3中的辅助信息包含：拟混合的数字货币数量和拟参与混币的公私钥对数量。优选地，所述S5中，验证节点根据所述辅助信息对AOS环签名后的转入交易进行验证的具体步骤为：SSSSS1、计算转入交易的数量、拟参与混币的公私钥对数量总和、转入聚合地址的数字货币总数量和拟混合的数字货币数量之和；SSSSS2、判断转入交易的数量与拟参与混币的公私钥对数量总和是否一致、转入聚合地址的数字货币总数量与拟混合的数字货币数量之和是否一致、以及验证AOS环签名是否有效；若转入交易的数量与拟参与混币的公私钥对数量总和一致，且转入聚合地址的数字货币总数量与拟混合的数字货币数量之和一致，且AOS环签名有效，则验证通过，否则验证不通过；其中，所述SSSSS2中，验证AOS环签名是否有效的具体步骤为：S001、计算第七中间参数，，其中；S002、验算等式是否成立，若是，则签名有效，若否，则签名无效。优选地，所述S8中，验证节点根据所述辅助信息对ECDSA签名后的转出交易进行验证的具体步骤为：S0001、验证ECDSA签名是否有效，以及判断节点拟转出的数字货币数量与该节点拟混合的数字货币数量是否一致，若ECDSA签名有效，且节点拟转出的数字货币数量与该节点拟混合的数字货币数量一致，则该节点的转出交易验证通过，否则该节点的转出交易验证不通过。本发明的有益效果是：、通过在混币过程中完全去中心化管理，避免了因中心化混合服务器的恶意行为或因中心化混合服务器被攻破带来的单点故障问题，由此保证了节点的匿名性，同时去中心化管理为节点的数字货币交易节省了混合服务所产生的费用。、通过参与者标准的定义，相比CoinShuffle中混合相同数量数字货币的节点才能组成混合组来说，降低了组成混合组的难度。、通过在混币操作前引入一个协商混合协议的过程，解决CoinShuffle中去中心化混合器具有的难以证明节点为诚实或是恶意节点的问题，若混合组内存在恶意节点，解散该混合组后，诚实节点能够通过提供相同的数字签名证明数字货币的拥有权并赎回数字货币，不会造成经济损失。、通过使用AOS环签名算法签署数字货币的转入交易，在签名中隐藏了签名者的公钥信息，同时聚合地址验证时不牵涉到签名者使用的私钥信息，因此让混合组内节点也只能确定签名者属于该混合组，而不能具体锁定到特定的节点，对比ECDSA签名方案具有更高的匿名性。并且节点能够独自完成签名操作，对比CoinJoin采用的多重签名方案，减少了节点交互开销，提升了混币效率。、通过混合组协商合作生成多个聚合地址，进一步提高了混合组节点的匿名性。附图说明图1为基于环签名的去中心化混币方法的一种流程图。具体实施方式下面将结合实施例，对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域技术人员在没有付出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。如图1所示，本实施例提供了一种基于环签名的去中心化混币方法，包括如下六个阶段：第一阶段、钱包初始化阶段：S1、各个节点分别通过数字货币地址生成方法依次生成自己的公私钥对和地址，并将自己拟交易的数字货币分配到自己生成的地址中。第二阶段、混合组组成阶段：S2、发起节点广播混合请求，混合请求包括响应节点的参与标准，发起节点和符合参与标准的响应节点组成混合组。参与标准包括响应节点具有的公私钥对数量大于等于第一阈值，且响应节点拟交易的数字货币数量大于等于第二阈值。第三阶段、混合协议协商阶段：S3、混合组内各个节点合作生成聚合地址，并协商得到混合协议，然后根据混合协议在混合组内公开辅助信息。该聚合地址将作为去中心化混合器的地址。第四阶段、数字货币转入阶段：S4、混合组内各个节点分别创建用于将拟交易的数字货币转入聚合地址的转入交易，并对转入交易进行AOS环签名。S5、选取混合组内节点作为验证节点，验证节点根据S3中公开的辅助信息对AOS环签名后的转入交易进行验证，若验证通过，则执行步骤S6，若验证不通过，则解散混合组，并终止混币操作。其中从混合组内选取的验证节点至少为两个，分别为第一验证节点和第二验证节点，第一验证节点用于对除自身创建的转入交易外的其他转入交易进行验证，第二验证节点用于对第一验证节点创建的转入交易进行验证。第五阶段、数字货币重分配阶段：S6、聚合地址对转入的数字货币进行汇集，并按照混合组预先协商得到的最小分配数量对汇集的数字货币进行分割。其中最小分配数量小于第二阈值。通过将汇集的数字货币按照最小分配数量分割成相同大小的单位，使得这些单位之间无法被明确区分，达到混淆数字货币的作用，由此进一步提升数字货币交易的匿名性。第六阶段、数字货币转出阶段：S7、混合组内各个节点分别创建用于从聚合地址取出数字货币的转出交易，并对转出交易进行ECDSA签名。S8、验证节点根据S3中公开的辅助信息对ECDSA签名后的转出交易进行验证，若混合组内节点验证通过，则向该节点发送数字货币，发送数字货币的数量与该节点拟交易的数字货币数量相同，若混合组内节点验证不通过，则不向该节点发送数字货币，该节点的混币操作终止。其中，第一验证节点用于对除自身创建的转出交易外的其他转出交易进行验证，第二验证节点用于对第一验证节点创建的转出交易进行验证。其中，S3中的混合协议包含：混合组内每个节点必须公开自己拟混合的数字货币数量，且必须公开自己拟参与混币的公私钥对数量。S3中的辅助信息包含：拟混合的数字货币数量和拟参与混币的公私钥对数量。其中，S1中的公私钥对的数量为多个。通过多个公私钥对的设置，在混合组外的节点看来，混合组内具有更多的成员，加强了对节点的隐私保护。S1的具体步骤如下：S11、节点使用伪随机数生成器生成根种子。S12、基于根种子，使用HMAC-SHA512算法生成第一层级的私钥和第一层级的链码。第一层级的私钥也称为父私钥。S13、选取一个索引号，基于选取的索引号、第一层级的私钥和第一层级的链码，使用HMAC-SHA512算法生成第二层级的私钥和第二层级的链码，其中选择的索引号在到之间。到之间索引号用于强化衍生方程，即为以父私钥推导。第二层级的私钥也称为子私钥。由于扩展密钥包含有链码，如果子私钥被泄漏，链码就可以被用来衍生所有的其他子私钥，基于本步骤的强化衍生方程，避免了上述安全问题。S14、根据第一层级的私钥计算第一层级的公钥，并组成一个公私钥对。根据第二层级的私钥计算第二层级的公钥，并组成一个公私钥对。S15、根据第二层级的私钥或第二层级的公钥，以及第二层级的链码，使用HMAC-SHA512算法生成与第二层级同层级的公私钥对和/或第二层级之后多个层级的公私钥对。S16、根据各个公私钥对中的公钥分别生成一个地址，节点将自己拟交易的数字货币分配到一个或多个上述地址中。S14的具体步骤如下：SS1、根据第一层级的私钥计算第一层级的公钥，组成一个公私钥对，其中为第一大素数，为循环群中的生成元，为第一层级的私钥，i表示节点自己的身份编号。SS2、根据第二层级的私钥计算第二层级的公钥，组成一个公私钥对，其中为第二层级的私钥。 S3中，混合组内各个节点合作生成聚合地址的具体步骤为：SSS1、取第二大素数。SSS2、混合组内各个节点分别生成一个第一随机数，并分别通过自己的公私钥对中的公钥计算第一中间参数，得到个第一中间参数，然后将得到的个第一中间参数在混合组内广播，其中的取值为各个节点自己的公私钥对数量。SSS3、计算聚合地址，其中N的取值为混合组内所有节点的公私钥对之和。同样地，聚合私钥的生成步骤如下：混合组内各个节点分别通过自己的公私钥对中的私钥 计算第八中间参数，得到个第八中间参数，然后将得到的个第八中间参数在混合组内广播；计算聚合私钥。在SSS3之后还包括以下步骤：SSS4、重复执行SSS1至SSS3多次，每次执行SSS2时混合组内至少一个节点改变第一随机数的取值，由此得到多个不同的聚合地址。通过多个不同的聚合地址，进一步提高了混合组节点的匿名性。S4中，对转入交易进行AOS环签名的具体步骤如下：SSSS1、选取用于签名的公私钥对，并收集混合组内各个节点所有公私钥对中的公钥，组成公钥集，其中。SSSS2、选择第二随机数，计算第二中间参数，其中，M为转入交易，为q阶素数群。SSSS3、选择第三随机数，计算，其中，，为第三中间参数，为第四中间参数。SSSS4、计算第五中间参数，其中为第六中间参数。SSSS5、生成AOS环签名。S5中，验证节点根据辅助信息对AOS环签名后的转入交易进行验证的具体步骤为：SSSSS1、计算转入交易的数量、拟参与混币的公私钥对数量总和、转入聚合地址的数字货币总数量和拟混合的数字货币数量之和。SSSSS2、判断转入交易的数量与拟参与混币的公私钥对数量总和是否一致、转入聚合地址的数字货币总数量与拟混合的数字货币数量之和是否一致、以及验证AOS环签名是否有效；若转入交易的数量与拟参与混币的公私钥对数量总和一致，且转入聚合地址的数字货币总数量与拟混合的数字货币数量之和一致，且AOS环签名有效，则验证通过，否则验证不通过。其中，上述SSSSS2中，验证AOS环签名是否有效的具体步骤为：S001、计算第七中间参数，，其中。S002、验算等式是否成立，若是，则签名有效,若否，则签名无效。其中，等式的正确性推导过程如下：。S8中，验证节点根据辅助信息对ECDSA签名后的转出交易进行验证的具体步骤为：S0001、验证ECDSA签名是否有效，以及判断混合组内节点拟转出的数字货币数量与该节点拟混合的数字货币数量是否一致，若ECDSA签名有效，且混合组组内节点拟转出的数字货币数量与该节点拟混合的数字货币数量一致，则该节点的转出交易验证通过，否则该节点的转出交易验证不通过。以上所述仅是本发明的优选实施方式，应当理解本发明并非局限于本文所披露的形式，不应看作是对其他实施例的排除，而可用于各种其他组合、修改和环境，并能够在本文所述构想范围内，通过上述教导或相关领域的技术或知识进行改动。而本领域人员所进行的改动和变化不脱离本发明的精神和范围，则都应在本发明所附权利要求的保护范围内。
