标题title
应用于安全编码软件的数据时效性校验方法和系统
摘要abst
本发明公开了一种应用于安全编码软件的数据时效性校验方法和系统，该方法包括：在安全消息接收端设定系统时间戳、校验时间戳和接收校验时间戳，并初始化系统时间戳，以及根据系统时间戳初始化校验时间戳和接收校验时间戳；根据校验时间戳和接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验；在时效校核字与预设时效校核字校验一致时，确定当前周期时效性校验通过，并将接收校验时间戳更新为当前周期的校验时间戳。本发明能够在不改变数据结构的前提下，有效保证数据的高安全性、可靠性和时效性。
权利要求书clms
1.一种应用于安全编码软件的数据时效性校验方法，其特征在于，包括：在安全消息接收端设定系统时间戳、校验时间戳和接收校验时间戳，并初始化所述系统时间戳，以及根据所述系统时间戳初始化所述校验时间戳和所述接收校验时间戳；根据所述校验时间戳和所述接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验；在所述时效校核字与所述预设时效校核字校验一致时，确定当前周期时效性校验通过，并将所述接收校验时间戳更新为当前周期的校验时间戳。2.如权利要求1所述的应用于安全编码软件的数据时效性校验方法，其特征在于，所述接收校验时间戳为用于记录上一周期接收到安全消息时的校验时间戳。3.如权利要求1所述的应用于安全编码软件的数据时效性校验方法，其特征在于，在安全消息接收端设定的所述系统时间戳包括第一系统时间戳、第二系统时间戳和第三系统时间戳，所述校验时间戳包括第一校验时间戳、第二校验时间戳和第三校验时间戳，所述接收校验时间戳的初始化步骤与所述校验时间戳的初始化步骤相同，所述根据所述系统时间戳初始化所述校验时间戳的步骤包括：所述第一校验时间戳与所述第一系统时间戳在初始化时，均将初始值设为零；所述第二校验时间戳和所述第三校验时间戳分别作为所述第一校验时间戳的两个通道的冗余码，所述第二校验时间戳和所述第三校验时间戳分别采用所述第二系统时间戳和所述第三系统时间戳的掩码作为固定签名进行初始化。4.如权利要求3所述的应用于安全编码软件的数据时效性校验方法，其特征在于，在根据所述校验时间戳和所述接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验时，采用双通道一致性校验方式对当前周期的安全消息时效性进行校验。5.如权利要求4所述的应用于安全编码软件的数据时效性校验方法，其特征在于，所述接收校验时间戳包括第一接收校验时间戳、第二接收校验时间戳和第三接收校验时间戳，所述第二接收校验时间戳和所述第三接收校验时间戳分别为所述第一接收校验时间戳的第一通道冗余码和第二通道冗余码，所述采用双通道一致性校验方式对当前周期的安全消息时效性进行校验的步骤包括：在所述第一通道冗余码和所述第二通道冗余码上分别模加所述第二系统时间戳和所述第三系统时间戳的掩码；确定所述第一校验时间戳和所述第一接收校验时间戳的差值，并在所述差值位于预设差值范围内时，分别在所述第一通道冗余码和所述第二通道冗余码上模减所述第二系统时间戳和所述第三系统时间戳的掩码；计算所述第二校验时间戳与完成模减操作后的第一通道冗余码的差值，得到第一差值，并计算所述第三校验时间戳与完成模减操作后的第二通道冗余码的差值，得到第二差值；分别根据所述第一差值和所述第二差值计算得到第一通道和第二通道用于时效性校验的第一补偿值和第二补偿值，并根据所述第一差值和所述第一补偿值确定第一时效校核字，根据所述第二差值和所述第二补偿值确定第二时效校核字，以及将所述第一时效校核字和所述第二时效校核字分别与所述预设时效校核字进行一致性校验。6.如权利要求3所述的应用于安全编码软件的数据时效性校验方法，其特征在于，在接收校验时间戳初始化操作之后，时效校核字一致性校验之前，所述方法还包括：在当前周期对是否接收到安全消息进行确认，并在确认未接收到安全消息时，依次对所述系统时间戳和所述校验时间戳进行更新，并返回确认是否接收到安全消息的步骤。7.如权利要求6所述的应用于安全编码软件的数据时效性校验方法，其特征在于，所述方法还包括：在当前周期确认接收到安全消息之后，对所述安全消息进行完整性校验。8.如权利要求7所述的应用于安全编码软件的数据时效性校验方法，其特征在于，所述方法还包括：将所述接收校验时间戳更新为当前周期的校验时间戳之后，还依次对所述系统时间戳和所述校验时间戳进行更新，并返回确认是否接收到安全消息的步骤。9.如权利要求6或8所述的应用于安全编码软件的数据时效性校验方法，其特征在于，对所述系统时间戳和所述校验时间戳进行更新的步骤包括：每隔预设周期对所述第一系统时间戳和所述第一校验时间戳进行加一更新，对所述第二校验时间戳和所述第三校验时间戳进行2^32的模减运算。10.如权利要求1所述的应用于安全编码软件的数据时效性校验方法，其特征在于，所述方法还包括：在接收到安全消息之后，还对校验时间戳和接收校验时间戳的签名进行校验。11.一种应用于安全编码软件的数据时效性校验系统，其特征在于，包括：初始化模块，用于在安全消息接收端设定系统时间戳、校验时间戳和接收校验时间戳后，初始化所述系统时间戳，以及根据所述系统时间戳初始化所述校验时间戳和所述接收校验时间戳；时效性校验模块，与所述初始化模块连接，所述时效性校验模块用于根据所述校验时间戳和所述接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验；时间戳更新模块，与所述时效性校验模块连接，所述时间戳更新模块用于在所述时效校核字与所述预设时效校核字校验一致时，确定当前周期时效性校验通过，并将所述接收校验时间戳更新为当前周期的校验时间戳。12.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时，实现如权利要求1-10中任一项所述的应用于安全编码软件的数据时效性校验方法。13.一种电子设备，其特征在于，包括处理器和存储器，所述存储器上存储有计算机程序，所述计算机程序被所述处理器执行时，实现如权利要求1-10中任一项所述的应用于安全编码软件的数据时效性校验方法。
说明书desc
技术领域本发明涉及数据可信计算技术领域，尤其涉及一种应用于安全编码软件的数据时效性校验方法和系统。背景技术轨道交通领域安全编解码软件通常负责验证消息的完整性，例如发送端发送消息时产生发送校验和，接收端接收消息时通过该校验和验证消息的完整性，并安全的解析出安全数据。但是，在数据的结构不能改变的情况下，不能在数据结构中添加类似时间戳的字段，那么此类安全编解码软件就无法保证数据的时效性，如SACEM编解码软件。因此，在数据结构不能改变的情况下，如何保证数据的时效性是目前需要解决的问题。发明内容本发明旨在至少在一定程度上解决相关技术中的技术问题之一。为此，本发明的第一个目的在于提供一种应用于安全编码软件的数据时效性校验方法，该方法在不改变数据结构的前提下，能够保证数据的高安全性、可靠性和时效性。本发明的第二个目的在于提供一种应用于安全编码软件的数据时效性校验系统。本发明的第三个目的在于提供一种计算机可读存储介质。本发明的第四个目的在于提供一种电子设备。为达到上述目的，本发明通过以下技术方案实现：一种应用于安全编码软件的数据时效性校验方法，包括：在安全消息接收端设定系统时间戳、校验时间戳和接收校验时间戳，并初始化所述系统时间戳，以及根据所述系统时间戳初始化所述校验时间戳和所述接收校验时间戳；根据所述校验时间戳和所述接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验；在所述时效校核字与所述预设时效校核字校验一致时，确定当前周期时效性校验通过，并将所述接收校验时间戳更新为当前周期的校验时间戳。可选的，所述接收校验时间戳为用于记录上一周期接收到安全消息时的校验时间戳。可选的，在安全消息接收端设定的所述系统时间戳包括第一系统时间戳、第二系统时间戳和第三系统时间戳，所述校验时间戳包括第一校验时间戳、第二校验时间戳和第三校验时间戳，所述接收校验时间戳的初始化步骤与所述校验时间戳的初始化步骤相同，所述根据所述系统时间戳初始化所述校验时间戳的步骤包括：所述第一校验时间戳与所述第一系统时间戳在初始化时，均将初始值设为零；所述第二校验时间戳和所述第三校验时间戳分别作为所述第一校验时间戳的两个通道的冗余码，所述第二校验时间戳和所述第三校验时间戳分别采用所述第二系统时间戳和所述第三系统时间戳的掩码作为固定签名进行初始化。可选的，在根据所述校验时间戳和所述接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验时，采用双通道一致性校验方式对当前周期的安全消息时效性进行校验。可选的，所述接收校验时间戳包括第一接收校验时间戳、第二接收校验时间戳和第三接收校验时间戳，所述第二接收校验时间戳和所述第三接收校验时间戳分别为所述第一接收校验时间戳的第一通道冗余码和第二通道冗余码，所述采用双通道一致性校验方式对当前周期的安全消息时效性进行校验的步骤包括：在所述第一通道冗余码和所述第二通道冗余码上分别模加所述第二系统时间戳和所述第三系统时间戳的掩码；确定所述第一校验时间戳和所述第一接收校验时间戳的差值，并在所述差值位于预设差值范围内时，分别在所述第一通道冗余码和所述第二通道冗余码上模减所述第二系统时间戳和所述第三系统时间戳的掩码；计算所述第二校验时间戳与完成模减操作后的第一通道冗余码的差值，得到第一差值，并计算所述第三校验时间戳与完成模减操作后的第二通道冗余码的差值，得到第二差值；分别根据所述第一差值和所述第二差值计算得到第一通道和第二通道用于时效性校验的第一补偿值和第二补偿值，并根据所述第一差值和所述第一补偿值确定第一时效校核字，根据所述第二差值和所述第二补偿值确定第二时效校核字，以及将所述第一时效校核字和所述第二时效校核字分别与所述预设时效校核字进行一致性校验。可选的，在接收校验时间戳初始化操作之后，时效校核字一致性校验之前，所述方法还包括：在当前周期对是否接收到安全消息进行确认，并在确认未接收到安全消息时，依次对所述系统时间戳和所述校验时间戳进行更新，并返回确认是否接收到安全消息的步骤。可选的，所述方法还包括：在当前周期确认接收到安全消息之后，对所述安全消息进行完整性校验。可选的，所述方法还包括：将所述接收校验时间戳更新为当前周期的校验时间戳之后，还依次对所述系统时间戳和所述校验时间戳进行更新，并返回确认是否接收到安全消息的步骤。可选的，对所述系统时间戳和所述校验时间戳进行更新的步骤包括：每隔预设周期对所述第一系统时间戳和所述第一校验时间戳进行加一更新，对所述第二校验时间戳和所述第三校验时间戳进行2^32的模减运算。可选的，所述方法还包括：在接收到安全消息之后，还对校验时间戳和接收校验时间戳的签名进行校验。为达到上述目的，本发明第二方面提供了一种应用于安全编码软件的数据时效性校验系统，包括：初始化模块10，用于在安全消息接收端设定系统时间戳、校验时间戳和接收校验时间戳后，初始化所述系统时间戳，以及根据所述系统时间戳初始化所述校验时间戳和所述接收校验时间戳；时效性校验模块20，与所述初始化模块10连接，所述时效性校验模块20用于根据所述校验时间戳和所述接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验；时间戳更新模块30，与所述时效性校验模块20连接，所述时间戳更新模块30用于在所述时效校核字与所述预设时效校核字校验一致时，确定当前周期时效性校验通过，并将所述接收校验时间戳更新为当前周期的校验时间戳。为达到上述目的，本发明第三方面提供了一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时，实现上述所述的应用于安全编码软件的数据时效性校验方法。为达到上述目的，本发明第四方面提供了一种电子设备，包括处理器和存储器，所述存储器上存储有计算机程序，所述计算机程序被所述处理器执行时，实现上述所述的应用于安全编码软件的数据时效性校验方法。本发明至少具有以下技术效果：本发明在安全消息接收端设定了系统时间戳、校验时间戳和接收校验时间戳，从而提出了一种完全基于接收方的安全编码软件的数据时效性校验方法，使得该方法在不影响对端系统、不改变原先数据结构的情况下，能够完成数据时效性校验；本发明还根据校验时间戳和接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行双通道一致性校验，可充分保证数据的高时效性，以及在时效校验过程中，通过系统时间戳的参与运算，可保证数据的高安全性；另外，该方法在工程实现中更加简单灵活，能够有效降低系统运算负担。本发明附加的方面和优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明图1为本发明一实施例提供的应用于安全编码软件的数据时效性校验方法的流程图；图2为本发明一具体示例的应用于安全编码软件的数据时效性校验方法的工作流程图；图3为本发明一实施例提供的应用于安全编码软件的数据时效性校验系统的结构框图。具体实施方式下面详细描述本实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，旨在用于解释本发明，而不能理解为对本发明的限制。承如背景技术中所述，轨道交通领域安全编解码软件通常负责验证消息的完整性，例如发送端发送消息时产生发送校验和，接收端接收消息时通过该校验和验证消息的完整性，并安全的解析出安全数据。但是，在数据的结构不能改变的情况下，不能在数据结构中添加类似时间戳的字段，那么此类安全编解码软件就无法保证数据的时效性，如SACEM编解码软件。针对此类安全编解码软件的这一问题，本发明提出了在安全消息接收端另外设计了一套专门用于安全消息时效性校验的时间戳，提出了一种不改变数据结构，并且运算过程有系统安全时间戳参与的低复杂度、高安全、高可靠性的时效性校验方法，可以应用于轨道交通领域安全编解码软件的时效性校验。下面参考附图描述本实施例的应用于安全编码软件的数据时效性校验方法和系统。图1为本发明一实施例提供的应用于安全编码软件的数据时效性校验方法的流程图。如图1所示，该方法包括：步骤S1：在安全消息接收端设定系统时间戳、校验时间戳和接收校验时间戳，并初始化系统时间戳，以及根据系统时间戳初始化校验时间戳和接收校验时间戳。本实施例中，在安全消息接收端设定的系统时间戳包括第一系统时间戳、第二系统时间戳和第三系统时间戳，校验时间戳包括第一校验时间戳、第二校验时间戳和第三校验时间戳，接收校验时间戳的初始化步骤与校验时间戳的初始化步骤相同，根据系统时间戳初始化校验时间戳的步骤包括：第一校验时间戳与第一系统时间戳在初始化时，均将初始值设为零；第二校验时间戳和第三校验时间戳分别作为第一校验时间戳的两个通道的冗余码，第二校验时间戳和第三校验时间戳分别采用第二系统时间戳和第三系统时间戳的掩码作为固定签名进行初始化。需要说明的是，根据系统时间戳对校验时间戳进行初始化后，可根据初始化后的校验时间戳对接收校验时间戳进行初始化，所述接收校验时间戳的初始化步骤与校验时间戳的初始化步骤相同。具体的，可在安全消息接收端设定VSN0、VSN1和VSN2分别作为第一系统时间戳、第二系统时间戳和第三系统时间戳，以作为接收校验端的系统时间戳。另外，再增加一套专门用于时效性校验的校验时间戳LoopTimer即LoopTimer0、LoopTimer1和LoopTimer2，分别作为第一校验时间戳、第二校验时间戳和第三校验时间戳。其中，第一校验时间戳LoopTimer0的初始化和更新与第一系统时间戳VSN0一致，初始值均设定为0。LoopTimer1和LoopTimer2即第二校验时间戳和第三校验时间戳分别为第一检验时间戳LoopTimer0的两个通道冗余码，冗余码LoopTimer1和LoopTimer2使用第二系统时间戳VSN1和第三系统时间戳VSN2的掩码作为固定签名进行初始化。进一步的，可设定一静态结构体变量RecvLoopTimer作为接收校验时间戳，该接收校验时间戳为用于记录上一周期接收到安全消息时的校验时间戳，其初始化时用校验时间戳的初始化值进行初始化。在本发明的一个实施例中，在接收校验时间戳初始化操作之后，时效校核字一致性校验之前，该方法还包括：在当前周期对是否接收到安全消息进行确认，并在确认未接收到安全消息时，依次对系统时间戳和校验时间戳进行更新，并返回确认是否接收到安全消息的步骤，以及在当前周期确认接收到安全消息之后，对安全消息进行完整性校验。其中，对系统时间戳和校验时间戳进行更新的步骤包括：每隔预设周期对第一系统时间戳和第一校验时间戳进行加一更新，对第二校验时间戳和第三校验时间戳进行2^32的模减运算。具体的，如图2所示，可确认是否接收到SACEM编解码软件发送端发送的安全消息，若未接收到，可依次对系统时间戳和校验时间戳进行更新。其中，第一系统时间戳VSN0和第一校验时间戳LoopTimer0均在每预设周期进行加1更新，第二校验时间戳LoopTimer1和第三校验时间戳LoopTimer2均在每预设周期更新时进行2^32的模减运算。若接收到，则对安全消息进行完整性校验，以确保数据的完整性。需要说明的是，在接收到安全消息之后，还对校验时间戳和接收校验时间戳的签名进行校验。即在收到安全消息并进行时效性校验时，还需确保校验签名必须一致。步骤S2：根据校验时间戳和接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验。本实施例中，在根据校验时间戳和接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验时，采用双通道一致性校验方式对当前周期的安全消息时效性进行校验，以确保时效性校验的可靠性。在本发明的一个实施例中，接收校验时间戳RecvLoopTimer包括第一接收校验时间戳RecvLoopTimer-LoopTimer0、第二接收校验时间戳RecvLoopTimer-LoopTimer1和第三接收校验时间戳RecvLoopTimer-LoopTimer2，第二接收校验时间戳RecvLoopTimer-LoopTimer1和第三接收校验时间戳RecvLoopTimer-LoopTimer2分别为第一接收校验时间戳RecvLoopTimer-LoopTimer0的第一通道冗余码和第二通道冗余码，采用双通道一致性校验方式对当前周期的安全消息时效性进行校验的步骤包括：步骤S21：在第一通道冗余码RecvLoopTimer-LoopTimer1和第二通道冗余码RecvLoopTimer-LoopTimer2上分别模加第二系统时间戳VSN1和第三系统时间戳VSN2的掩码。步骤S22：确定第一校验时间戳LoopTimer0和第一接收校验时间戳RecvLoopTimer-LoopTimer0的差值，并在差值位于预设差值范围内时，分别在第一通道冗余码RecvLoopTimer-LoopTimer1和第二通道冗余码RecvLoopTimer-LoopTimer2上模减第二系统时间戳VSN1和第三系统时间戳VSN2的掩码。步骤S23：计算第二校验时间戳LoopTimer1与完成模减操作后的第一通道冗余码RecvLoopTimer-LoopTimer1的差值，得到第一差值，并计算第三校验时间戳LoopTimer2与完成模减操作后的第二通道冗余码RecvLoopTimer-LoopTimer2的差值，得到第二差值。具体的，如果校验时间戳LoopTimer和接收校验时间戳RecvLoopTimer的LoopTimer0差值为k，并在预设差值范围内，则校验时间戳LoopTimer和接收校验时间戳RecvLoopTimer冗余码位LoopTimer1和LoopTimer2的差值分别为MOD1和MOD2，即第一差值和第二差值，其中，MOD1和MOD2为相应差值变量。步骤S24：分别根据第一差值和第二差值计算得到第一通道和第二通道用于时效性校验的第一补偿值Diff1和第二补偿值Diff2，并根据第一差值和第一补偿值Diff1确定第一时效校核字VSN_CHECK_WORD1，根据第二差值和第二补偿值Diff2确定第二时效校核字VSN_CHECK_WORD2，以及将第一时效校核字VSN_CHECK_WORD1和第二时效校核字VSN_CHECK_WORD2分别与预设时效校核字进行一致性校验。具体的，可设定两个预设时效校核字，然后通过预先计算好的第一补偿值Diff1和第二补偿值Diff2分别按照如下公式和确定第一时效校核字VSN_CHECK_WORD1和第二时效校核字VSN_CHECK_WORD2：VSN_CHECK_WORD1＝Diff1^MOD1VSN_CHECK_WORD2＝Diff2^MOD2其中，补偿值Diff是预先计算的一个数组，具体元素值跟预设时效校核字和MOD1、MOD2有关，k的最大值是一个系统参数，其可根据系统的需求灵活选择。假定系统容忍的超时为最大10个周期，则补偿值数组定义为diff，数组元素diff表示当前周期收到的安全消息跟上次收到的安全消息在同一周期，数组元素diff表示当前收到的安全消息距离上次收到的安全消息间隔了1个周期，依次类推，数组元素diff表示当前收到的安全消息距离上次收到的安全消息间隔了10个周期，超过10个周期则直接返回错误，不进行后续操作。如果计算得到的校核字跟预设时效校核字不一致，则说明时效性校验错误，并且两个通道校验同时通过才表示时效性校验通过。步骤S3：在时效校核字与预设时效校核字校验一致时，确定当前周期时效性校验通过，并将接收校验时间戳更新为当前周期的校验时间戳。如图2所示，将接收校验时间戳更新为当前周期的校验时间戳之后，还依次对系统时间戳和校验时间戳进行更新，并返回确认是否接收到安全消息的步骤。在一个具体示例中，参见图2对本发明的数据时效性校验方法进行详细阐述。本具体示例中，校验时间戳为SACEM_VSN，接收校验时间戳为SACEM_RECV_VSN。本具体示例所阐述的数据时效性校验流程如下述步骤所述：步骤S100：初始化系统时间戳VSN。步骤S101：初始化校验时间戳SACEM_VSN也即LoopTimer。其中LoopTimer.LoopTimer0的值初始化为0，LoopTimer.LoopTimer1的值初始化为系统时钟即第二系统时间戳VSN1的掩码，LoopTimer.LoopTimer2的值初始化为系统时钟即第三系统时间戳VSN2的掩码。步骤S102：初始化接收校验时间戳SACEM_RECV_VSN也即RecvLoopTimer。接收校验时间戳RecvLoopTimer的初始化和校验时间戳LoopTimer的初始化一致。步骤S103：当前周期收到SACEM安全消息并且完整性校验通过，向下执行步骤S104，如果当前周期没有收到SACEM安全消息则直接跳到步骤S110，如果收到SACEM安全消息，但是完整性校验失败，系统直接退出。步骤S104：接收校验时间戳RecvLoopTimer的冗余码LoopTimer1和LoopTimer2分别模加上系统时钟冗余码VSN1^通道1掩码和VSN2^通道2掩码，让系统安全时钟VSN1和VSN2参与运算。步骤S105：计算校验时间戳和接收校验时间戳LoopTimer0的差值k，按照逻辑设计k是一个大于等于0的整数。如果计算出的k值在系统设计的范围之内，则向下执行步骤S106。如果计算出的k值超过系统设计的容忍值则时效性校验超时，系统直接退出。步骤S106：时效性校核字清零。步骤S107：接收校验时间戳RecvLoopTimer的冗余码LoopTimer1和LoopTimer2分别模减去系统时钟冗余码VSN1^通道1掩码和VSN2^通道2掩码。步骤S108：此时，当前收到SACEM安全消息的校验时间戳LoopTimer的冗余码LoopTimer1和LoopTimer2与上一次收到SACEM安全消息时的接收校验时间戳RecvLoopTimer的冗余码LoopTimer1和LoopTimer2的差值为与差值k相关的值MOD1和MOD2，根据差值k异或预先计算好的补偿值Diff1和Diff2，计算时效性校核字。如果计算出的两个通道的时效性校核字VSN_CHECK_WORD1和VSN_CHECK_WORD2跟预定义的时效性校核字一致则时效性校验通过，则执行步骤S109。如果校验失败，则时效性校验失败，系统退出。步骤S109：时效性校验通过，接收校验时间戳RecvLoopTimer更新为当前周期的校验时间戳LoopTimer。步骤S110：系统时间戳VSN更新。步骤S111：校验时间戳LoopTimer的更新，其中LoopTimer.LoopTimer0加1更新，LoopTimer.LoopTimer1和LoopTimer.LoopTimer2模减2^32更新。然后返回到步骤S103判断新的周期是否收到SACEM安全消息，依次循环。图3为本发明一实施例提供的应用于安全编码软件的数据时效性校验系统的结构框图。如图3所示，该数据时效性校验系统1包括初始化模块10、时效性校验模块20和时间戳更新模块30。其中，初始化模块10用于在安全消息接收端设定系统时间戳、校验时间戳和接收校验时间戳后，初始化系统时间戳，以及根据系统时间戳初始化校验时间戳和接收校验时间戳；时效性校验模块20与初始化模块10连接，所述时效性校验模块20用于根据校验时间戳和接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验；时间戳更新模块30与时效性校验模块20连接，所述时间戳更新模块30用于在时效校核字与预设时效校核字校验一致时，确定当前周期时效性校验通过，并将接收校验时间戳更新为当前周期的校验时间戳。在本发明的一个实施例中，所述接收校验时间戳为用于记录上一周期接收到安全消息时的校验时间戳。在本发明的一个实施例中，在安全消息接收端设定的系统时间戳包括第一系统时间戳、第二系统时间戳和第三系统时间戳，校验时间戳包括第一校验时间戳、第二校验时间戳和第三校验时间戳，所述接收校验时间戳的初始化步骤与所述校验时间戳的初始化步骤相同，初始化模块10根据系统时间戳初始化校验时间戳时具体用于，将第一校验时间戳与第一系统时间戳的初始值设为零；将第二校验时间戳和第三校验时间戳分别作为第一校验时间戳的两个通道的冗余码，并对第二校验时间戳和第三校验时间戳分别采用第二系统时间戳和第三系统时间戳的掩码作为固定签名进行初始化。在本发明的一个实施例中，时效性校验模块20在根据校验时间戳和接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行一致性校验时，采用双通道一致性校验方式对当前周期的安全消息时效性进行校验。具体的，接收校验时间戳包括第一接收校验时间戳、第二接收校验时间戳和第三接收校验时间戳，第二接收校验时间戳和第三接收校验时间戳分别为第一接收校验时间戳的第一通道冗余码和第二通道冗余码，时效性校验模块20采用双通道一致性校验方式对当前周期的安全消息时效性进行校验时具体用于：在第一通道冗余码和第二通道冗余码上分别模加第二系统时间戳和第三系统时间戳的掩码；确定第一校验时间戳和第一接收校验时间戳的差值，并在差值位于预设差值范围内时，分别在第一通道冗余码和第二通道冗余码上模减第二系统时间戳和第三系统时间戳的掩码；计算第二校验时间戳与完成模减操作后的第一通道冗余码的差值，得到第一差值，并计算第三校验时间戳与完成模减操作后的第二通道冗余码的差值，得到第二差值；分别根据第一差值和第二差值计算得到第一通道和第二通道用于时效性校验的第一补偿值和第二补偿值，并根据第一差值和第一补偿值确定第一时效校核字，根据第二差值和第二补偿值确定第二时效校核字，以及将第一时效校核字和第二时效校核字分别与预设时效校核字进行一致性校验。在本发明的一个实施例中，在当前周期还对是否接收到安全消息进行确认，并在确认未接收到安全消息时，所述时间戳更新模块30还用于依次对系统时间戳和校验时间戳进行更新，并返回确认是否接收到安全消息的步骤。在将接收校验时间戳更新为当前周期的校验时间戳之后，时间戳更新模块30还依次对系统时间戳和校验时间戳进行更新，并返回确认是否接收到安全消息的步骤。其中，时间戳更新模块30对系统时间戳和校验时间戳进行更新时具体用于：每隔预设周期对第一系统时间戳和第一校验时间戳进行加一更新，对第二校验时间戳和第三校验时间戳进行2^32的模减运算。需要说明的是，本实施例的数据时效性校验系统系统的具体实施方式可参见上述数据时效性校验方法的具体实施方式，本实施例中的初始化模块10用于实现上述的步骤S100-S102，时效性校验模块20用于实现上述的步骤S104-S108，时间戳更新模块30用于实现上述的步骤S109-S111，为避免冗余，此处不再赘述。进一步的，本发明还提供了一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时，实现上述的应用于安全编码软件的数据时效性校验方法。进一步的，本发明还提供了一种电子设备，包括处理器和存储器，所述存储器上存储有计算机程序，所述计算机程序被所述处理器执行时，实现上述的应用于安全编码软件的数据时效性校验方法。综上，本发明在安全消息接收端设定了系统时间戳、校验时间戳和接收校验时间戳，从而提出了一种完全基于接收方的安全编码软件的数据时效性校验方法，使得该方法在不影响对端系统、不改变原先数据结构的情况下，能够完成数据时效性校验；本发明还根据校验时间戳和接收校验时间戳的冗余码确定时效校核字，并将其与预设时效校核字进行双通道一致性校验，可充分保证数据的高时效性，以及在时效校验过程中，通过系统时间戳的参与运算，可保证数据的高安全性；另外，该方法在工程实现中更加简单灵活，能够有效降低系统运算负担。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括要素的过程、方法、物品或者设备中还存在另外的相同要素。尽管本发明的内容已经通过上述优选实施例作了详细介绍，但应当认识到上述的描述不应被认为是对本发明的限制。在本领域技术人员阅读了上述内容后，对于本发明的多种修改和替代都将是显而易见的。因此，本发明的保护范围应由所附的权利要求来限定。
