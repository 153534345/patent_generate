标题title
文件传输方法及装置、电子设备和计算机可读存储介质
摘要abst
本公开提供了一种文件传输方法及装置、电子设备和计算机可读存储介质。该文件传输方法方法包括：在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，其中当前待执行任务用于将当前文件上传至预定云存储；确定预定云存储的当前剩余带宽；将待执行任务队列中的目标待执行任务添加至可执行任务队列中，其中，目标待执行任务为预占用带宽小于等于当前剩余带宽的待执行任务；从可执行任务队列中确定目标可执行任务，以便通过执行目标可执行任务将目标文件上传至预定云存储。
权利要求书clms
1.一种文件传输方法，包括：在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，其中所述当前待执行任务用于将当前文件上传至预定云存储；确定所述预定云存储的当前剩余带宽；将所述待执行任务队列中的目标待执行任务添加至可执行任务队列中，其中，所述目标待执行任务为预占用带宽小于等于所述当前剩余带宽的待执行任务；从所述可执行任务队列中确定目标可执行任务，以便通过执行所述目标可执行任务将目标文件上传至所述预定云存储。2.根据权利要求1所述的方法，其中，所述从所述可执行任务队列中确定目标可执行任务包括：确定所述可执行任务队列中的每个可执行任务的任务权重；将任务权重满足预设阈值的可执行任务确定为所述目标可执行任务。3.根据权利要求2所述的方法，其中，所述确定所述可执行任务队列中的每个可执行任务的任务权重包括：根据每个所述可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个所述可执行任务的任务权重。4.根据权利要求3所述的方法，其中，所述根据每个所述可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个所述可执行任务的任务权重包括：分别计算每个所述可执行任务的第一子权重、第二子权重以及第三子权重，其中，所述第一子权重为所述预上传文件数据量的倒数和第一预设系数的乘积，所述第二子权重为所述预占用带宽和第二预设系数的乘积，所述第三子权重为所述任务已等待时长和第三预设系数的乘积；计算所述第一子权重、所述第二子权重以及所述第三子权重的加和，以得到每个所述可执行任务的任务权重。5.根据权利要求1所述的方法，其中，所述确定所述预定云存储的当前剩余带宽包括：计算所述预设带宽限值与所述预定云存储的当前实时占用带宽的差值，以得到所述当前剩余带宽。6.根据权利要求1所述的方法，其中：所述当前预占用总带宽为：当前实时占用带宽与所述当前待执行任务的预占用带宽之和。7.根据权利要求1所述的方法，还包括：开启带宽限速；其中，所述将当前待执行任务添加至待执行任务队列中的操作适用于：开启带宽限速且当前预占用总带宽大于预设带宽限值的情况。8.根据权利要求7所述的方法，还包括：在开启宽带限速且所述当前预占用总带宽小于等于所述预设带宽限值的情况下，执行所述当前待执行任务。9.一种文件传输装置，包括：第一添加模块，用于在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，其中所述当前待执行任务用于将当前文件上传至预定云存储；第一确定模块，用于确定所述预定云存储的当前剩余带宽；第二添加模块，用于将所述待执行任务队列中的目标待执行任务添加至可执行任务队列中，其中，所述目标待执行任务为预占用带宽小于等于所述当前剩余带宽的待执行任务；第二确定模块，用于从所述可执行任务队列中确定目标可执行任务，以便通过执行所述目标可执行任务将目标文件上传至所述预定云存储。10.一种电子设备，包括：一个或多个处理器；存储器，用于存储一个或多个程序，其中，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现权利要求1至8中任一项所述的方法。11.一种计算机可读存储介质，其上存储有可执行指令，该指令被处理器执行时使处理器实现权利要求1至8中任一项所述的方法。12.一种计算机程序产品，所述计算机程序产品包括计算机可执行指令，所述指令在被执行时用于实现权利要求1至8中任一项所述的方法。
说明书desc
技术领域本公开涉及云存储技术领域，更具体地，涉及一种文件传输方法及装置、电子设备、计算机可读存储介质和计算机程序产品。背景技术目前，在存储领域，云存储是一个较为常用的备份方式，云存储是指将数据上传到云存储，可以起到数据备份以及节省本地存储空间的作用。在实现本公开构思的过程中，发明人发现相关技术中至少存在如下问题：在集群云存储整体限速，带宽不能满足大量文件同时上传的情况下，会导致部分文件备份上传失败。发明内容有鉴于此，本公开提供了一种文件传输方法及装置、电子设备、计算机可读存储介质和计算机程序产品。本公开的一个方面提供了一种文件传输方法，包括：在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，其中当前待执行任务用于将当前文件上传至预定云存储；确定预定云存储的当前剩余带宽；将待执行任务队列中的目标待执行任务添加至可执行任务队列中，其中，目标待执行任务为预占用带宽小于等于当前剩余带宽的待执行任务；从可执行任务队列中确定目标可执行任务，以便通过执行目标可执行任务将目标文件上传至预定云存储。根据本公开的实施例，其中，从可执行任务队列中确定目标可执行任务包括：确定可执行任务队列中的每个可执行任务的任务权重；将任务权重满足预设阈值的可执行任务确定为目标可执行任务。根据本公开的实施例，其中，确定可执行任务队列中的每个可执行任务的任务权重包括：根据每个可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个可执行任务的任务权重。根据本公开的实施例，其中，根据每个可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个可执行任务的任务权重包括：分别计算每个可执行任务的第一子权重、第二子权重以及第三子权重，其中，第一子权重为预上传文件数据量的倒数和第一预设系数的乘积，第二子权重为预占用带宽和第二预设系数的乘积，第三子权重为任务已等待时长和第三预设系数的乘积；计算第一子权重、第二子权重以及第三子权重的加和，以得到每个可执行任务的任务权重。根据本公开的实施例，其中，确定预定云存储的当前剩余带宽包括：计算预设带宽限值与预定云存储的当前实时占用带宽的差值，以得到当前剩余带宽。根据本公开的实施例，其中：当前预占用总带宽为：当前实时占用带宽与当前待执行任务的预占用带宽之和。根据本公开的实施例，还包括：开启带宽限速；其中，将当前待执行任务添加至待执行任务队列中的操作适用于：开启带宽限速且当前预占用总带宽大于预设带宽限值的情况。根据本公开的实施例，还包括：在开启宽带限速且当前预占用总带宽小于等于预设带宽限值的情况下，执行当前待执行任务。本公开的另一个方面提供了一种文件传输装置，包括第一添加模块、第一确定模块、第二添加模块和第二确定模块。其中，第一添加模块，用于在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，其中当前待执行任务用于将当前文件上传至预定云存储；第一确定模块，用于确定预定云存储的当前剩余带宽；第二添加模块，用于将待执行任务队列中的目标待执行任务添加至可执行任务队列中，其中，目标待执行任务为预占用带宽小于等于当前剩余带宽的待执行任务；第二确定模块，用于从可执行任务队列中确定目标可执行任务，以便通过执行目标可执行任务将目标文件上传至预定云存储。根据本公开的实施例，其中，第二确定模块包括第一确定单元、第二确定单元。其中，第一确定单元，用于确定可执行任务队列中的每个可执行任务的任务权重；第二确定单元，用于将任务权重满足预设阈值的可执行任务确定为目标可执行任务。根据本公开的实施例，其中，第一确定单元中，确定可执行任务队列中的每个可执行任务的任务权重包括：根据每个可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个可执行任务的任务权重。根据本公开的实施例，其中，第一确定单元包括第一计算子单元和第二计算子单元。其中，第一计算子单元，用于分别计算每个可执行任务的第一子权重、第二子权重以及第三子权重，其中，第一子权重为预上传文件数据量的倒数和第一预设系数的乘积，第二子权重为预占用带宽和第二预设系数的乘积，第三子权重为任务已等待时长和第三预设系数的乘积；第二计算子单元，用于计算第一子权重、第二子权重以及第三子权重的加和，以得到每个可执行任务的任务权重。根据本公开的实施例，其中，第一确定模块中，确定预定云存储的当前剩余带宽包括：计算预设带宽限值与预定云存储的当前实时占用带宽的差值，以得到当前剩余带宽。根据本公开的实施例，其中，当前预占用总带宽为：当前实时占用带宽与当前待执行任务的预占用带宽之和。根据本公开的实施例，还包括开启模块，用于开启带宽限速；其中，将当前待执行任务添加至待执行任务队列中的操作适用于：开启带宽限速且当前预占用总带宽大于预设带宽限值的情况。根据本公开的实施例，还包括执行模块，用于在开启宽带限速且当前预占用总带宽小于等于预设带宽限值的情况下，执行当前待执行任务。本公开的另一个方面提供了一种电子设备，包括：一个或多个处理器、以及存储器；其中该存储器用于存储一个或多个程序；其中，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现如上所述的文件传输方法。本公开的另一方面提供了一种计算机可读存储介质，存储有计算机可执行指令，所述指令在被执行时用于实现如上所述的文件传输方法。本公开的另一方面提供了一种计算机程序产品，所述计算机程序产品包括计算机可执行指令，所述指令在被执行时用于实现如上所述的文件传输方法。根据本公开的实施例，通过在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，并且通过选择目标可执行任务优先执行，可保证文件备份能够有序、正确、完整的上传到云存储，避免了文件备份失败的情况发生，提高了文件传输的可靠性。根据本公开的实施例，通过确定预定云存储的当前剩余带宽以及将预占用带宽小于等于当前剩余带宽的待执行任务确定为可执行任务，可在保证备份流量不会达到云存储带宽的上限的情况下，也不会空闲云存储带宽，在提高文件传输可靠性的前提下，提高了带宽利用率。附图说明通过以下参照附图对本公开实施例的描述，本公开的上述以及其他目的、特征和优点将更为清楚，在附图中：图1示意性示出了可以应用本公开的文件传输方法和装置的示例性系统架构；图2示意性示出了根据本公开实施例的文件传输方法的流程图；图3示意性示出了根据本公开实施例的文件传输方法的系统示意图；图4示意性示出了根据本公开实施例的文件传输装置的框图；图5示意性示出了根据本公开实施例的用于实现文件传输方法的电子设备的框图。具体实施方式以下，将参照附图来描述本公开的实施例。但是应该理解，这些描述只是示例性的，而并非要限制本公开的范围。在下面的详细描述中，为便于解释，阐述了许多具体的细节以提供对本公开实施例的全面理解。然而，明显地，一个或多个实施例在没有这些具体细节的情况下也可以被实施。此外，在以下说明中，省略了对公知结构和技术的描述，以避免不必要地混淆本公开的概念。在此使用的术语仅仅是为了描述具体实施例，而并非意在限制本公开。在此使用的术语“包括”、“包含”等表明了所述特征、步骤、操作和/或部件的存在，但是并不排除存在或添加一个或多个其他特征、步骤、操作或部件。在此使用的所有术语具有本领域技术人员通常所理解的含义，除非另外定义。应注意，这里使用的术语应解释为具有与本说明书的上下文相一致的含义，而不应以理想化或过于刻板的方式来解释。在使用类似于“A、B和C等中至少一个”这样的表述的情况下，一般来说应该按照本领域技术人员通常理解该表述的含义来予以解释。在使用类似于“A、B或C等中至少一个”这样的表述的情况下，一般来说应该按照本领域技术人员通常理解该表述的含义来予以解释。在对本公开的实施例进行详细阐述之前，先对本公开实施例提供的方法所涉及的系统结构以及应用场景进行如下介绍。图1示意性示出了可以应用本公开的文件传输方法和装置的示例性系统架构100。需要注意的是，图1所示仅为可以应用本公开实施例的系统架构的示例，以帮助本领域技术人员理解本公开的技术内容，但并不意味着本公开实施例不可以用于其他设备、系统、环境或场景。如图1所示，根据该实施例的系统架构100可以包括业务服务器101、云存储102、以及任务管理系统103。业务服务器101、云存储102、以及任务管理系统103之间可以通过网络进行通信，网络可以包括各种连接类型，例如有线和/或无线通信链路等等。业务服务器101可以是提供各种服务的服务器，例如对用户利用终端设备所浏览的网站提供支持的后台管理服务器。后台管理服务器可以对接收到的用户请求等数据进行分析等处理，并将处理结果反馈给终端设备。根据本公开的实施例，云存储102用于对外提供云存储服务，用于服务请求者将需要备份的数据上传到云存储102，对服务请求者起到数据备份以及节省本地存储空间的作用。根据本公开的实施例，业务服务器101对外提供服务的过程中，产生大量的业务数据，其中，业务数据可以备份上传存储至云存储102。根据本公开的实施例，业务服务器101将数据备份上传至云存储102的过程中，可以通过执行数据上传任务将数据同时上传，也可以将数据分成多份数据文件，将每份数据文件依次上传。根据本公开的实施例，任务管理系统103用于管理业务服务器101的数据上传任务，使得数据完整、有序上传。根据本公开的实施例，在云存储102整体限速的情况下，带宽不能满足大量文件同时上传的情况下，可通过任务管理系统103对业务服务器101中的业务数据的上传任务进行管理。例如，可以是将当前待执行任务添加至待执行任务队列中，并计算每个待执行任务的任务权重，然后根据任务权重选择权重较大的任务依次执行。需要说明的是，本公开实施例所提供的文件传输方法一般可以由任务管理系统103执行。相应地，本公开实施例所提供的文件传输装置一般可以设置于任务管理系统103中。本公开实施例所提供的文件传输方法也可以由不同于任务管理系统103且能够与任务管理系统103通信的服务器或服务器集群执行。相应地，本公开实施例所提供的文件传输装置也可以设置于不同于任务管理系统103且能够与任务管理系统103通信的服务器或服务器集群中。或者，本公开实施例所提供的文件传输方法也可以由业务服务器101执行。相应地，本公开实施例所提供的文件传输装置也可以设置于业务服务器101中。应该理解，图1中的服务器的数目仅仅是示意性的。根据实现需要，可以具有任意数目的服务器。根据本公开的实施例，在将需要备份的文件数据上传至预定云存储的过程中，存在带宽不能满足大量文件同时上传的情况，例如云存储整体限速的情况，或者云存储带宽已被其他程序占用了部分带宽的情况等等。在这种情况下，不能满足大量文件同时上传，可以通过本公开实施例的文件传输方法完成文件数据的有序上传。图2示意性示出了根据本公开实施例的文件传输方法的流程图。如图2所示，该方法包括操作S201～S204。在操作S201，在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，其中当前待执行任务用于将当前文件上传至预定云存储。根据本公开的实施例，当前预占用总带宽可以是当前实时占用带宽与当前待执行任务的预占用带宽之和，也可以仅是当前待执行任务的预占用带宽，当前待执行任务可以是仅用于执行上传单份文件数据，也可以是用于同时完成多份文件数据的上传。预设带宽限值可以是预定云存储开启带宽限速后，设置的带宽限值，也可以是预定云存储在未开启带宽限速的情况下，其本身的带宽限值。例如，本公开实施例文件传输方法的应用场景可以是，云存储整体限速的情况下，云存储设置了带宽限值，不能满足大量文件同时上传，在这种情况下，需要确定当前预占用总带宽，根据当前预占用总带宽是否大于预设带宽限值，在当前预占用总带宽小于等于预设带宽限值的情况下，满足执行条件，可将通过执行上传任务将当前文件上传；在当前预占用总带宽大于预设带宽限值的情况下，不满足执行条件，可将当前待执行任务添加至待执行任务队列中，等待执行。在操作S202，确定预定云存储的当前剩余带宽。在待执行任务等待过程中，需实时确定剩余带宽，以便在剩余带宽满足上传条件的情况下执行上传。当前可能存在其他正在执行的上传任务占用预定云存储部分带宽的情况，因此，需要预先计算预定云存储的当前剩余带宽。在操作S203，将待执行任务队列中的目标待执行任务添加至可执行任务队列中，其中，目标待执行任务为预占用带宽小于等于当前剩余带宽的待执行任务。根据本公开的实施例，待执行任务队列中的每个待执行任务的文件数据量大小可能不同，因此每个待执行任务的预占用带宽大小也不同，可以将预占用带宽小于等于当前剩余带宽的待执行任务确定为可执行任务，以便后续执行。同时，将预占用带宽大于当前剩余带宽的待执行任务确定为当前不可执行任务，等待后续任务执行过程中，预定云存储的剩余带宽满足上传条件的情况下再执行。在操作S204，从可执行任务队列中确定目标可执行任务，以便通过执行目标可执行任务将目标文件上传至预定云存储。根据本公开的实施例，从可执行任务队列中确定目标可执行任务，可以是根据预设筛选条件从可执行任务队列中确定目标可执行任务。预设预设筛选条件，例如可以是优先执行文件数据量较大的任务，或者优先执行文件数据量较小的任务，也可以是优先执行已等待时长较长的任务，也可以是优先执行预占用带宽较小或者较大的任务，也可以是综合考虑文件数据量大小、已等待时长以及预占用带宽大小中的其中一个或多个因素，确定每个待执行任务的权重，优先选择权重较大的任务执行。根据本公开的实施例，通过在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，并且通过选择目标可执行任务优先执行，可保证文件备份能够有序、正确、完整的上传到云存储，避免了文件备份失败的情况发生，提高了文件传输的可靠性。根据本公开的实施例，通过确定预定云存储的当前剩余带宽以及将预占用带宽小于等于当前剩余带宽的待执行任务确定为可执行任务，可在保证备份流量不会达到云存储带宽的上限的情况下，也不会空闲云存储带宽，在提高文件传输可靠性的前提下，提高了带宽利用率。根据本公开的实施例，其中，确定预定云存储的当前剩余带宽包括：计算预设带宽限值与预定云存储的当前实时占用带宽的差值，以得到当前剩余带宽。根据本公开的实施例，预设带宽限值可以是预定云存储开启带宽限速后，设置的带宽限值，也可以是预定云存储在未开启带宽限速的情况下，其本身的带宽限值。预定云存储的当前实时占用带宽，可以是当前正在执行的上传任务已占用的实时带宽，也可以是其他任务占用的实时带宽。根据本公开的实施例，例如，预设带宽限值设置为60G/s，当前正在执行的上传任务已占用的实时带宽为40G/s，则当前剩余带宽为20G/s。根据本公开的实施例，其中：当前预占用总带宽为：当前实时占用带宽与当前待执行任务的预占用带宽之和。根据本公开的实施例，例如，当前实时占用带宽为40G/s，当前待执行任务的预占用带宽为10G/s，则当前预占用总带宽为50G/s。根据本公开的实施例，其中，从可执行任务队列中确定目标可执行任务包括：确定可执行任务队列中的每个可执行任务的任务权重；将任务权重满足预设阈值的可执行任务确定为目标可执行任务。根据本公开的实施例，确定任务权重可以是根据多个影响因子的综合作用确定的，多个影响因子例如可以包括文件大小、预占用带宽大小、已等待时长、文件重要程度等等。根据本公开的实施例，确定可执行任务队列中的每个可执行任务的任务权重，可以是：对于每个可执行任务，针对每个影响因子，分别计算出子权重，然后计算多个子权重的加权和，以得到每个可执行任务的任务权重。根据本公开的实施例，可以将任务权重满足预设阈值的可执行任务确定为目标可执行任务，也可以是将任务权重最大的可执行任务确定为目标可执行任务，或者是将任务权重最小的可执行任务确定为目标可执行任务，可根据实际应用场景自由设置筛选条件。根据本公开的实施例，通过确定可执行任务队列中的每个可执行任务的任务权重，可以确定每个可执行任务的优先级，进而选择任务权重满足预设阈值的可执行任务，优先执行文件上传任务，可保证文件备份能够有序地上传到云存储，降低了文件上传的失败率。根据本公开的实施例，其中，确定可执行任务队列中的每个可执行任务的任务权重包括：根据每个可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个可执行任务的任务权重。即，本公开的实施例，将预上传文件数据量、预占用带宽、以及任务已等待时长作为影响文件上传执行优先级的影响因子。根据本公开的实施例，其中，根据每个可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个可执行任务的任务权重包括：对于每个可执行任务，针对每个影响因子，分别计算出子权重，然后计算多个子权重的加权和，以得到每个可执行任务的任务权重。具体地：分别计算每个可执行任务的第一子权重、第二子权重以及第三子权重，再计算第一子权重、第二子权重以及第三子权重的加和，以得到每个可执行任务的任务权重。其中，第一子权重用于表征预上传文件数据量作为影响因子，对文件上传执行优先级的影响大小；第二子权重用于表征预占用带宽作为影响因子，对文件上传执行优先级的影响大小；第三子权重用于表征任务已等待时长作为影响因子，对文件上传执行优先级的影响大小。根据本公开的实施例，具体地：对于每个可执行任务，第一子权重为预上传文件数据量的倒数和第一预设系数的乘积，第二子权重为预占用带宽和第二预设系数的乘积，第三子权重为任务已等待时长和第三预设系数的乘积。每个可执行任务的任务权重Pi的计算方法可采用如下公式所示计算方法：其中，Mi表示当前可执行任务的预上传文件的大小；Li表示当前可执行任务的预占用带宽；Ti表示当前可执行任务的已等待时长。根据本公开的实施例，将预上传文件数据量、预占用带宽、以及任务已等待时长作为影响文件上传执行优先级的影响因子，并设置权重分配方式，可以保证数据量较小的文件优先上传，预占用带宽较大的任务优先执行、以及等待时长较长的任务优先执行；因数据量较大的文件容易上传失败，选择数据量较小的文件优先上传，可保证上传的成功率；受带宽的限制，因预占用带宽较大的任务可能无法与别的任务同时上传，优先选择将其上传，方便后续设置将占用带宽较小的任务同时执行，任务分配更加合理，提高了上传效率；选择等待时长较长的任务优先执行，可保证尽量短时间完成上传，缩短了单个任务的执行时长，提高了上传效率。根据本公开的实施例，还包括：开启带宽限速；其中，将当前待执行任务添加至待执行任务队列中的操作适用于：开启带宽限速且当前预占用总带宽大于预设带宽限值的情况。根据本公开的实施例，在特定场景下，需要对预定云存储开启带宽限速，例如，当业务执行系统和数据备份系统同时共用一个云存储的情况下，在业务高峰期，业务执行系统需要占用较大的带宽，则优先供给业务执行系统执行数据传输对带宽使用，这种情况下，对数据备份系统的上传任务则开启带宽限速，则，将当前待执行任务添加至待执行任务队列中的操作适用于：开启带宽限速且当前预占用总带宽大于预设带宽限值的情况。根据本公开的实施例，在开启宽带限速且当前预占用总带宽小于预设带宽限值的情况下，执行当前待执行任务。该情形下，当前预占用总带宽较小，当前实时带宽可以满足当前任务的执行，则直接执行当前任务。根据本公开的实施例，在解除宽带限速的情况下，可以同时启动所述待执行任务队列中的全部待执行任务。图3示意性示出了根据本公开实施例的文件传输方法的系统示意图。如图3所示，执行本公开实施例的文件传输方法的系统包括两部分：Agent、TaskManager。其中Agent负责定时备份任务的执行，TaskManager负责任务的管理及派发。根据本公开的实施例，可通过TaskManager配置流量限值。通过Agent任务执行系统执行定时备份任务完场文件上传至预订云存储。Agent在执行定时任务之前，预先判断是否开启宽带限速，在未开启宽带限速的情况下，直接执行定时备份任务。在开启宽带限速的情况下，判断当前预占用总带宽大于预设带宽限值。在开启宽带限速且当前预占用总带宽小于预设带宽限值的情况下，执行当前待执行任务；在开启宽带限速且当前预占用总带宽小于等于预设带宽限值的情况下，直接执行当前待执行任务。在执行任务的过程中，实时计算占用带宽。根据本公开的实施例，在开启宽带限速且当前预占用总带宽大于预设带宽限值的情况下，当前待执行任务无法直接执行，请求TaskManager将当前待执行任务添加至待执行任务队列中，等待带宽满足时执行上传。待执行任务队列中包含各个待执行任务的任务信息，例如：任务编号，文件编号，文件数据量大小，任务预占用带宽，任务已等待时长等。根据本公开的实施例，TaskManager配置流量限值后，TaskManager开启定时检测任务，若任务队列为空，直接返回。若任务队列不为空，则代表任务队列中存在的待执行等待任务。通过TaskManager进行任务的管理，具体地：定时检测预定云存储的当前剩余带宽、将预占用带宽小于等于当前剩余带宽的待执行任务确定为可执行任务、以及根据每个可执行任务的任务权重，从可执行任务队列中确定目标可执行任务，以便调用Agent任务执行系统执行目标可执行任务。在关闭带宽限速的情况下，Taskmanager启动所有任务列表中任务，待所有任务执行完毕后，停止定时任务执行。图4示意性示出了根据本公开实施例的文件传输装置400的框图。该文件传输装置400可以用来实现参考图2所示的方法。如图4所示，文件传输装置400，包括第一添加模块401、第一确定模块402、第二添加模块403和第二确定模块404。其中，第一添加模块401，用于在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，其中当前待执行任务用于将当前文件上传至预定云存储；第一确定模块402，用于确定预定云存储的当前剩余带宽；第二添加模块403，用于将待执行任务队列中的目标待执行任务添加至可执行任务队列中，其中，目标待执行任务为预占用带宽小于等于当前剩余带宽的待执行任务；第二确定模块404，用于从可执行任务队列中确定目标可执行任务，以便通过执行目标可执行任务将目标文件上传至预定云存储。根据本公开的实施例，通过第一添加模块401在当前预占用总带宽大于预设带宽限值的情况下，将当前待执行任务添加至待执行任务队列中，并且通过第一确定模块402、第二添加模块403和第二确定模块404选择目标可执行任务优先执行，可保证文件备份能够有序、正确、完整的上传到云存储，避免了文件备份失败的情况发生，提高了文件传输的可靠性。根据本公开的实施例，通过第一确定模块402、第二添加模块403，确定预定云存储的当前剩余带宽以及将预占用带宽小于等于当前剩余带宽的待执行任务确定为可执行任务，可在保证备份流量不会达到云存储带宽的上限的情况下，也不会空闲云存储带宽，在提高文件传输可靠性的前提下，提高了带宽利用率。根据本公开的实施例，其中，第二确定模块包括第一确定单元、第二确定单元。其中，第一确定单元，用于确定可执行任务队列中的每个可执行任务的任务权重；第二确定单元，用于将任务权重满足预设阈值的可执行任务确定为目标可执行任务。根据本公开的实施例，其中，第一确定单元中，确定可执行任务队列中的每个可执行任务的任务权重包括：根据每个可执行任务的预上传文件数据量、预占用带宽、以及任务已等待时长，确定每个可执行任务的任务权重。根据本公开的实施例，其中，第一确定单元包括第一计算子单元和第二计算子单元。其中，第一计算子单元，用于分别计算每个可执行任务的第一子权重、第二子权重以及第三子权重，其中，第一子权重为预上传文件数据量的倒数和第一预设系数的乘积，第二子权重为预占用带宽和第二预设系数的乘积，第三子权重为任务已等待时长和第三预设系数的乘积；第二计算子单元，用于计算第一子权重、第二子权重以及第三子权重的加和，以得到每个可执行任务的任务权重。根据本公开的实施例，其中，第一确定模块中，确定预定云存储的当前剩余带宽包括：计算预设带宽限值与预定云存储的当前实时占用带宽的差值，以得到当前剩余带宽。根据本公开的实施例，其中，当前预占用总带宽为：当前实时占用带宽与当前待执行任务的预占用带宽之和。根据本公开的实施例，还包括开启模块，用于开启带宽限速；其中，将当前待执行任务添加至待执行任务队列中的操作适用于：开启带宽限速且当前预占用总带宽大于预设带宽限值的情况。根据本公开的实施例，还包括执行模块，用于在开启宽带限速且当前预占用总带宽小于等于预设带宽限值的情况下，执行当前待执行任务。根据本公开的实施例的模块、子模块、单元、子单元中的任意多个、或其中任意多个的至少部分功能可以在一个模块中实现。根据本公开实施例的模块、子模块、单元、子单元中的任意一个或多个可以被拆分成多个模块来实现。根据本公开实施例的模块、子模块、单元、子单元中的任意一个或多个可以至少被部分地实现为硬件电路，例如现场可编程门阵列、可编程逻辑阵列、片上系统、基板上的系统、封装上的系统、专用集成电路，或可以通过对电路进行集成或封装的任何其他的合理方式的硬件或固件来实现，或以软件、硬件以及固件三种实现方式中任意一种或以其中任意几种的适当组合来实现。或者，根据本公开实施例的模块、子模块、单元、子单元中的一个或多个可以至少被部分地实现为计算机程序模块，当该计算机程序模块被运行时，可以执行相应的功能。例如，第一添加模块401、第一确定模块402、第二添加模块403和第二确定模块404中的任意多个可以合并在一个模块/单元/子单元中实现，或者其中的任意一个模块/单元/子单元可以被拆分成多个模块/单元/子单元。或者，这些模块/单元/子单元中的一个或多个模块/单元/子单元的至少部分功能可以与其他模块/单元/子单元的至少部分功能相结合，并在一个模块/单元/子单元中实现。根据本公开的实施例，第一添加模块401、第一确定模块402、第二添加模块403和第二确定模块404中的至少一个可以至少被部分地实现为硬件电路，例如现场可编程门阵列、可编程逻辑阵列、片上系统、基板上的系统、封装上的系统、专用集成电路，或可以通过对电路进行集成或封装的任何其他的合理方式等硬件或固件来实现，或以软件、硬件以及固件三种实现方式中任意一种或以其中任意几种的适当组合来实现。或者，第一添加模块401、第一确定模块402、第二添加模块403和第二确定模块404中的至少一个可以至少被部分地实现为计算机程序模块，当该计算机程序模块被运行时，可以执行相应的功能。图5示意性示出了根据本公开实施例的用于实现文件传输方法的电子设备的框图。图5示出的电子设备仅仅是一个示例，不应对本公开实施例的功能和使用范围带来任何限制。如图5所示，根据本公开实施例的电子设备500包括处理器501，其可以根据存储在只读存储器502中的程序或者从存储部分508加载到随机访问存储器503中的程序而执行各种适当的动作和处理。处理器501例如可以包括通用微处理器、指令集处理器和/或相关芯片组和/或专用微处理器)，等等。处理器501还可以包括用于缓存用途的板载存储器。处理器501可以包括用于执行根据本公开实施例的方法流程的不同动作的单一处理单元或者是多个处理单元。在RAM 503中，存储有电子设备500操作所需的各种程序和数据。处理器501、ROM502以及RAM 503通过总线504彼此相连。处理器501通过执行ROM 502和/或RAM 503中的程序来执行根据本公开实施例的方法流程的各种操作。需要注意，所述程序也可以存储在除ROM 502和RAM 503以外的一个或多个存储器中。处理器501也可以通过执行存储在所述一个或多个存储器中的程序来执行根据本公开实施例的方法流程的各种操作。根据本公开的实施例，电子设备500还可以包括输入/输出接口505，输入/输出接口505也连接至总线504。系统500还可以包括连接至I/O接口505的以下部件中的一项或多项：包括键盘、鼠标等的输入部分506；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分507；包括硬盘等的存储部分508；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分509。通信部分509经由诸如因特网的网络执行通信处理。驱动器510也根据需要连接至I/O接口505。可拆卸介质511，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器510上，以便于从其上读出的计算机程序根据需要被安装入存储部分508。根据本公开的实施例，根据本公开实施例的方法流程可以被实现为计算机软件程序。例如，本公开的实施例包括一种计算机程序产品，其包括承载在计算机可读存储介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分509从网络上被下载和安装，和/或从可拆卸介质511被安装。在该计算机程序被处理器501执行时，执行本公开实施例的系统中限定的上述功能。根据本公开的实施例，上文描述的系统、设备、装置、模块、单元等可以通过计算机程序模块来实现。本公开还提供了一种计算机可读存储介质，该计算机可读存储介质可以是上述实施例中描述的设备/装置/系统中所包含的；也可以是单独存在，而未装配入该设备/装置/系统中。上述计算机可读存储介质承载有一个或者多个程序，当上述一个或者多个程序被执行时，实现根据本公开实施例的方法。根据本公开的实施例，计算机可读存储介质可以是非易失性的计算机可读存储介质。例如可以包括但不限于：便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本公开中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。例如，根据本公开的实施例，计算机可读存储介质可以包括上文描述的ROM 502和/或RAM 503和/或ROM 502和RAM 503以外的一个或多个存储器。本公开的实施例还包括一种计算机程序产品，其包括计算机程序，该计算机程序包含用于执行本公开实施例所提供的方法的程序代码，当计算机程序产品在电子设备上运行时，该程序代码用于使电子设备实现本公开实施例所提供的文件传输方法。在该计算机程序被处理器501执行时，执行本公开实施例的系统/装置中限定的上述功能。根据本公开的实施例，上文描述的系统、装置、模块、单元等可以通过计算机程序模块来实现。在一种实施例中，该计算机程序可以依托于光存储器件、磁存储器件等有形存储介质。在另一种实施例中，该计算机程序也可以在网络介质上以信号的形式进行传输、分发，并通过通信部分509被下载和安装，和/或从可拆卸介质511被安装。该计算机程序包含的程序代码可以用任何适当的网络介质传输，包括但不限于：无线、有线等等，或者上述的任意合适的组合。根据本公开的实施例，可以以一种或多种程序设计语言的任意组合来编写用于执行本公开实施例提供的计算机程序的程序代码，具体地，可以利用高级过程和/或面向对象的编程语言、和/或汇编/机器语言来实施这些计算程序。程序设计语言包括但不限于诸如Java，C++，python，“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。在涉及远程计算设备的情形中，远程计算设备可以通过任意种类的网络，包括局域网或广域网，连接到用户计算设备，或者，可以连接到外部计算设备。附图中的流程图和框图，图示了按照本公开各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。本领域技术人员可以理解，本公开的各个实施例和/或权利要求中记载的特征可以进行多种组合和/或结合，即使这样的组合或结合没有明确记载于本公开中。特别地，在不脱离本公开精神和教导的情况下，本公开的各个实施例和/或权利要求中记载的特征可以进行多种组合和/或结合。所有这些组合和/或结合均落入本公开的范围。以上对本公开的实施例进行了描述。但是，这些实施例仅仅是为了说明的目的，而并非为了限制本公开的范围。尽管在以上分别描述了各实施例，但是这并不意味着各个实施例中的措施不能有利地结合使用。本公开的范围由所附权利要求及其等同物限定。不脱离本公开的范围，本领域技术人员可以做出多种替代和修改，这些替代和修改都应落在本公开的范围之内。
