标题title
基于位置进行控制带宽补偿方法及系统、贴片机
摘要abst
本发明涉及控制带宽技术领域，具体公开了一种基于位置进行控制带宽补偿方法及系统、贴片机，所述方法适用于电机丝杆传动系统，包括以下步骤：获取电机丝杆传动系统信息，包括负载在丝杆上的可移动范围和期望的最大带宽；根据所述负载在丝杆上的可移动范围确定带宽调节比例范围；检测负载位于丝杆上的位置信息；根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息；依据所述实时控制带宽信息实时调整所述电机丝杆传动系统的控制带宽。该方案有效改善系统振动，架构简单，鲁棒性强；计算简单，运算时间短；充分利用系统的可用带宽，同时改善远离电机和靠近电机的运动定位差异。
权利要求书clms
1.一种基于位置进行控制带宽补偿方法，其特征在于，适用于电机丝杆传动系统，所述电机丝杆传动系统包括电机、联轴器、丝杆和位于丝杆上的负载，所述电机通过联轴器与丝杆连接并驱动丝杆旋转，所述方法包括以下步骤：获取电机丝杆传动系统信息，包括负载在丝杆上的可移动范围和期望的最大带宽；根据所述负载在丝杆上的可移动范围确定带宽调节比例范围；检测负载位于丝杆上的位置信息；根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息；依据所述实时控制带宽信息实时调整所述电机丝杆传动系统的控制带宽。2.根据权利要求1所述的方法，其特征在于，所述带宽调节比例范围为： ，其中，l1为所述丝杆上的可移动范围起始位置，l2为所述丝杆上的可移动范围终止位置。3.根据权利要求2所述的方法，其特征在于，所述方法还包括：根据所述带宽调节比例范围对所述期望的最大带宽归一化处理，具体为：预设所述期望的最大带宽调整比例范围为，再将所述带宽调节比例范围映射到所述最大带宽调整比例范围上，0＜P＜1。4.根据权利要求3中所述的方法，其特征在于，所述方法还包括约束检查，具体为：监测生成的所述控制带宽是否超出理论保护范围，若超过则使用所述期望的最大带宽进行控制。5.根据权利要求4所述的方法，其特征在于，所述根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息计算公式如下：，其中，ω表示所述实时控制带宽，ωc表示所述期望的最大带宽，l表示所述负载位于丝杆上的位置，且l1≤l≤l2。6.根据权利要求4所述的方法，其特征在于，所述根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息计算公式如下：，其中，ω表示所述实时控制带宽，ωc表示所述期望的最大带宽，l表示所述负载位于丝杆上的位置，且l1≤l≤l2。7.一种基于位置进行控制带宽补偿系统，其特征在于，包括：电机丝杆传动模块，包括电机、联轴器、丝杆和位于丝杆上的负载，所述电机通过联轴器与丝杆连接并驱动丝杆旋转；位置测量模块，用于检测负载位于丝杆上的位置信息并将该位置信息发送至带宽补偿模块；带宽补偿模块，用于获取电机丝杆传动模块信息，包括负载在丝杆上的可移动范围和期望的最大带宽，根据所述负载在丝杆上的可移动范围确定带宽调节比例范围，以及根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息；控制器，用于依据所述实时控制带宽信息控制所述电机丝杆模块的运行，以实时调整所述电机丝杆传动模块的控制带宽。8.根据权利要求7所述的系统，其特征在于，所述系统还包括约束检查模块，用于监测生成的所述控制带宽是否超出理论保护范围，若超过则使用所述期望的最大带宽进行控制。9.根据权利要求7或8所述的系统，其特征在于，所述实时控制带宽信息计算公式为：或，其中，ω表示所述实时控制带宽，ωc表示所述期望的最大带宽，l1为所述丝杆上的可移动范围起始位置，l2为所述丝杆上的可移动范围终止位置，l表示所述负载位于丝杆上的位置，且l1≤l≤l2。10.一种贴片机，其特征在于，包括如权利要求7-9中任意一项所述的系统。
说明书desc
技术领域本发明涉及控制带宽技术领域，具体地涉及一种基于位置进行控制带宽补偿方法及系统、贴片机。背景技术运动控制常见于工业过程、民用产品、军用装备以及航空航天等应用环境，从工厂物料输送、自动化挤压成形、机器人手臂控制，到计算机硬盘驱动、车辆驾驶控制、安防设备方位控制等，均属于运动控制范畴。由于应用环境以及控制对象、执行装置，驱动机构等环节特性的不同，有着不同的系统特性与指标要求，但抽象为数学模型后，此类控制具有极大的相似性。基本方式是根据位置、速度、加速度的要求，和运动的需要，调节执行驱动机构的运动，实现控制对象一定精度的定位、定速或者轨迹跟踪。然而，无论是平移还是旋转，无论是定位、定速还是轨迹跟踪，运动的振动问题都是一个公认的控制难题。振动由系统的谐振模态导致，而谐振模态属于系统内部动态不可分割的一部分，是系统搭建后的本征特征。按照物理规律，只要系统涉及运动，机械谐振将不可避免。运动中的振动会使系统动态特性发生变化，造成能源浪费和性能退化，因此振动的抑制或隔离问题非常重要。少数情况下，如果谐振模态的固有频率远高于系统闭环带宽，则影响基本可以被忽略。然而，如果谐振固有频率与系统带宽相近，谐振模态有可能被激发，造成系统振荡和失稳，而系统性能的改进会面临回路带宽限制的问题，控制设计就变成了棘手的问题。例如，电机通过传动机构驱动负载时，为了获得快速的响应，需要设置较高的控制带宽。但是，实际的传动机构在传导力时，存在形变、摩擦等，引起运动滞后，导致高带宽下引起机械结构振动；在闭环反馈控制状态下，存在持续放大振动的风险，引起结构破坏，限制了系统可用带宽范围。此外，由于形变会和距离相关，距离越长形变量越大，会导致负载远离电机和靠近电机时，刚度存在差异，使得负载的定位过程有差异；当靠近电机能够快速定位不抖动时，远端就定位不稳定或者定位时间长；远端定位快速准确时，那么近端就无法稳定或者产生抖动情况。为了克服以上问题，通常使用滤波器对控制信号和反馈信号进行滤波，去除产生振动的频率。但是该方法存在一定的使用不便，具体如下：1）计算较为复杂；2）滤波的频率不好选择，确定后，滤波频率固定，不能适应频率的变化；3）引起了额外的滞后，会降低整体系统的控制带宽，影响控制性能；4）存在影响系统稳定性的风险；5）无法解决物体靠近电机和远离电机时引起的差异。因此，如何提供一种能够克服上述问题的控制带宽补偿方法，是业界亟待解决的问题。发明内容本发明的目的是为了克服现有技术存在的问题，本发明提出了一种基于位置进行控制带宽补偿方法及系统、贴片机，可以有效改善系统振动问题，同时计算简单，鲁棒性强，能够充分利用系统的可用带宽。为了实现上述目的，本发明第一方面提供了一种基于位置进行控制带宽补偿方法，适用于电机丝杆传动系统，所述电机丝杆传动系统包括电机、联轴器、丝杆和位于丝杆上的负载，所述电机通过联轴器与丝杆连接并驱动丝杆旋转，所述方法包括以下步骤：获取电机丝杆传动系统信息，包括负载在丝杆上的可移动范围和期望的最大带宽；根据所述负载在丝杆上的可移动范围确定带宽调节比例范围；检测负载位于丝杆上的位置信息；根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息；依据所述实时控制带宽信息实时调整所述电机丝杆传动系统的控制带宽。本发明第二方面提供了一种基于位置进行控制带宽补偿系统，包括：电机丝杆传动模块，包括电机、联轴器、丝杆和位于丝杆上的负载，所述电机通过联轴器与丝杆连接并驱动丝杆旋转；位置测量模块，用于检测负载位于丝杆上的位置信息并将该位置信息发送至带宽补偿模块；带宽补偿模块，用于获取电机丝杆传动模块信息，包括负载在丝杆上的可移动范围和期望的最大带宽，根据所述负载在丝杆上的可移动范围确定带宽调节比例范围，以及根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息；控制器，用于依据所述实时控制带宽信息控制所述电机丝杆模块的运行，以实时调整所述电机丝杆传动模块的控制带宽。本发明第三方面提供了一种贴片机，包括上述基于位置进行控制带宽补偿系统。通过上述技术方案，可以有效改善系统振动，同时架构简单，鲁棒性强；计算简单，运算时间短；可以充分利用系统的可用带宽，同时改善远离电机和靠近电机的运动定位差异。附图说明图1为本发明的电机丝杆传动系统示意图；图2为本发明电机丝杆传动系统模型示意图；图3为本发明电机丝杆传动系统运动框图；图4为本发明基于位置进行控制带宽补偿系统示意图；图5为本发明实施例1中负载位移与实时控制带宽关系示意图；图6为本发明实施例2中负载位移与实时控制带宽关系示意图；图7为本发明实施例中存在谐振的电流曲线图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。谐振问题的处理，可以从结构改良与控制补偿两方面着手进行。工业上最常见的谐振主要由联轴器、皮带、弹簧等柔性结构引致，其对运动控制的影响可以等效视为弹簧。既然谐振由柔性装置导致，显然可以用刚性传动装置来代替皮带等柔性联轴器，消除或减少柔性环节，从而消除或减轻谐振。也可以通过增大机械阻尼、增加电机惯量等方法来抑制或减轻谐振。然而，这些结构改良方法成本过高，不少研究人员由此转向控制补偿方法，采用低通、陷波和双二阶等各类滤波器来降低谐振频率下的环路增益，达到抑制谐振的目的，也有部分研究者采用较为复杂的现代控制技术来研究和解决振动问题。然而，上面的补偿控制方法需要建立物理过程详细的数学模型，这在实际应用中往往难以实现。即便是付出很大代价获得的过程模型，在谐振频率下也往往会发生变化，使得各类控制补偿方法特别是陷波滤波器变得极其脆弱。而复杂的现代控制技术，结构复杂，难于设计，实现及参数整定，影响了相应方法的实用性。为了克服以上困难，本发明第一方面提出了一种基于位置进行控制带宽补偿方法，是一种工程化实时调整控制带宽的方法。为了阐述本发明的设计，示例性地基于电机丝杆传动系统为例进行说明，如图1所示，电机丝杆传动系统由电机、联轴器、丝杆和位于丝杆上的负载组成，电机的驱动器驱动电机，通过联轴器驱动丝杆旋转，丝杆将旋转运动转换成平移运动，从而驱动负载进行平移，达到目标位置。该电机丝杆传动系统作为被控制对象，对电机丝杆传动系统进行模型建模，能够简化表达为一个双惯量系统模型，使该问题转换为旋转运动谐振问题。电机通过弹簧与负载相连，在电机端施加驱动力矩，电机与负载将产生相应的运动，如图2所示，电机输出的转矩TE，经过该系统进行传导到负载的转矩为TL。电机端的角位置为θM，角速度为ωM，角加速为ɑM；负载端的水平位置的等效角位置为θL，等效角速度为ωL，等效角加速为ɑL。电机惯量为JM，负载的在电机上的等效惯量为JL。将中间传动结构近似为弹性系统，包括联轴器、丝杆等结构，其特征参数为刚度KS和阻尼系数bS。通常机械传动结构都包括了以上的特征物理量。基于上述模型可以知道:电机输出的转矩TE减去负载转矩TL的剩余转矩，驱动了电机本体旋转；传动机构传输了TL；TL的产生来自于传动机构两侧的形变。于是，根据自动控制理论，可以建立系统运动框图，如图3所示，可以得到以下传递函数关系：    由于位置是速度的积分，有θ = ω / s ，式-式中s表示s域。基于以上公式进行推导，将式带入式有：对式变换有：TL=JL×s×ωL 联立式、式，进行变换，于是有： 。由式、式和式得到：TE= TM+TL= JM×s×ωM+ JL×s×ωL由式得到电机端角速度ωM和转矩TE的传递函数为：。取联立式、式和式，可以得到如下的传递函数：。从式第二项可以看到存在一个谐振频率ωR和反谐振频率ωAR：。以上为基于控制理论和传递函数的计算分析，下面从工程力学分析传动系统的扭转角度： 其中G为切变模量，Ip为丝杆截面的极惯性矩，l为负载位于丝杆上的位置，即电机和负载质心之间的距离。取丝杆近似为等值圆轴时，从式可以得到 摩擦在当前系统下一般很小，可以忽略不计，于是取TL= KS 由式、式联立得到刚度KS近似为。由式看出KS和l成反比，说明其谐振频率随着负载距电机距离的增加而减小。如果控制带宽高于或者接近谐振频率，则经过该频率附近时就会产生振动。对被控制对象进行建模分析后，于是有以下结论：从控制上看，存在谐振频率，该频率是由系统柔性部分引起，即系统的刚度有限导致，其对应了刚度KS的变化；KS会随着距离的增加下降，从而导致系统谐振频率降低；在物体远离电机和控制电机时，系统刚度不同，靠近电机时大，远离电机时小。以上的模型还较为简单，实际系统会有结构不理想，运动存在不理想，从而引起实际谐振频率会比理论的更低，但是其反映的规律是准确的。系统的控制带宽要小于系统的谐振频率点，否则会导致系统产生明显震荡。随着负载在丝杆上的移动，其谐振频率是在变化的，在系统未做振动处理时，整个系统的控制带宽需要限制在最小谐振频率以下，这样会导致本可以获得更高控制带宽的地方被限制，从而影响响应效果。负载在丝杆上移动，不同位置存在不同的谐振频率；此时可以使用本发明方法，根据位置调整控制带宽，避开谐振频率的同时，充分利用系统运行带宽。实施例1基于前述的问题及规律认识，本发明提出的一种基于位置进行控制带宽补偿方法，适用于电机丝杆传动系统，所述电机丝杆传动系统包括电机、联轴器、丝杆和位于丝杆上的负载，所述电机通过联轴器与丝杆连接并驱动丝杆旋转，所述方法包括以下步骤：获取电机丝杆传动系统信息，包括负载在丝杆上的可移动范围和期望的最大带宽；对基于位置进行控制带宽补偿系统结构抽象后如图4所示，获取电机丝杆传动系统信息具体步骤如下：系统以丝杆的端部为原点0，根据结构设计，获得负载在丝杆上的可移动范围为，且l2＞l1＞0，l1为靠近原点位置；计算极限位置l1,l2对应的刚度KS1和KS2：计算极限位置对应的谐振频率ωR1和ωR2：；取通常使用的一种“控制器”来进行说明，例如PI-串联模式，此时存在一个可调带宽参数ωc，设置ωc为期望的最大带宽，下面根据系统的特性对该带宽进行补偿，改善控制效果。根据所述负载在丝杆上的可移动范围确定带宽调节比例范围；负载在之间移动，以ωR1为基准，则整个运动过程总产生的谐振频率比例关系范围为：，化简后为。根据所述带宽调节比例范围对所述期望的最大带宽归一化处理；根据谐振变化的范围和特点，工程中可以设置期望调整的比例范围，进行归一化处理，范围为。例如期望调整的范围为ωc的90%~100%，从而能够将谐振变换的规律映射到上。此处的处理是为了进行归一化，从而能够适配不同的距离范围和结构，否则在不同的运动范围和材料参数下，其计算的结果可能会范围过大，或者产生负数，从而脱离了实际情况。检测负载位于丝杆上的位置信息；根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定信息；根据负载运动中的位置l，可以得到任意位置l的比例值为，于是根据映射的比例范围，可以计算得到当前位置下的带宽设定值为：式表示将的变化范围，映射到范围，并乘以ωc，从而得到实际的带宽值。实时控制带宽具体的推导过程如下：a.系统当前带宽为ωc，此为控制器的设置带宽，是本发明方法的已知值；b.设置期望的带宽调整范围为，根据不同的系统下和实际场景下的使用，进行人为设置的范围；此时可调带宽范围为；c.当前的位置为l，谐振的变化范围简化后为，取谐振变化比例关系，从而得到位置l的比例值为；d.带宽的范围为，带宽的变化过程是根据位置进行计算，取为，变化范围为，于是将ωc×P和对应，ωc和1对应，中间变化规律为，根据这个对应关系进行映射，得到式。式表示位置从l1变化到l2过程中，带宽从ωc变化到ωc×P，变化的趋势和过程符合，对应了谐振频率变化的规律。示例性地，当最大的期望带宽ωc=1000rad/s，可移动范围为，于是在移动过程中，计算得到位置和对应的实时控制带宽变化如图5所示，随着负载位移的增加，实时控制带宽逐渐减小。由图5可知，针对性地根据谐振频率变化地规律对带宽进行了限制和补偿，从而能够充分利用系统带宽；带宽计算中有非线性项，意味着对系统进行了非线性矫正，一定程度上弥补了PI控制只能处理线性系统的缺陷。依据所述实时控制带宽信息实时调整所述电机丝杆传动系统的控制带宽；进行约束检查，为了防止距离测量错误、人员编程错误操作等，或者位置范围等参数设置异常，引起计算错误，导致不可控，生成的带宽不可以超过理论保护范围，超过理论范围会使用默认值ωc进行控制。实施例2本发明提出的一种基于位置进行控制带宽补偿方法，也可以进行非谐振的控制补偿，当系统运动过程中不存在明显的谐振状态时，例如在转速较小下使用，未触发谐振点，此时会存在远离电机和靠近电机响应不一致的情况。基于此，本实施例的补偿方法与实施例1相同，区别在于，实时控制带宽具体的推导过程不同，如下：在相同控制参数下，当负载远离电机端时，系统刚度降低，物理系统的整体等效带宽降低，控制效果变差；可以根据位置对该部分损失的带宽进行补偿，从而改善其控制效果；基于丝杆机构计算，远端的系统等效带宽小，近端的大，这是系统固有特性，我们需要设计控制器对该特性进行补偿，从而使其整体带宽一致，从而使响应一致，因此需要提高远端带宽，降低近端带宽，为了补偿刚度减小引起的带宽减小，于是将ωc×P和对应1，ωc和对应，根据结构和位置参数以及对应关系进行映射，可以得到如下的公式：其得到的效果为位置从l1变化到l2过程中，带宽从ωc×P变化到ωc，变化的趋势和过程符合。这样使得控制器的带宽是近端小，远端大，从而补偿了被控对象的近端大，远端小的特性，从而使系统响应一致。示例性地，当最大的期望带宽ωc=1000rad/s，可移动范围为，于是在移动过程中，计算得到位置和对应的实时控制带宽变化如图6所示，随着负载位移的增加，实时控制带宽逐渐增大。使用以上计算可以实现对远端和近端控制差异的补偿，从而改善控制效果。实施例3本发明第二方面提供一种基于位置进行控制带宽补偿系统，与基于位置进行控制带宽补偿方法同一发明构思，如图4所示，包括电机丝杆传动模块，包括电机、联轴器、丝杆和位于丝杆上的负载，所述电机通过联轴器与丝杆连接并驱动丝杆旋转；位置测量模块，用于检测负载位于丝杆上的位置信息并将该位置信息发送至带宽补偿模块；带宽补偿模块，用于获取电机丝杆传动模块信息，包括负载在丝杆上的可移动范围和期望的最大带宽，根据所述负载在丝杆上的可移动范围确定带宽调节比例范围，以及根据所述带宽调节比例范围、所述负载位于丝杆上的位置信息和所述期望的最大带宽确定实时控制带宽信息；控制器，用于依据所述实时控制带宽信息控制所述电机丝杆模块的运行，以实时调整所述电机丝杆传动模块的控制带宽。该补偿系统的工作过程如下：建立如图4所示的电机丝杆传动模块和坐标系；位置测量模块测量负载实际运动范围；使用控制器控制电机运行，取传递函数如下：，控制带宽为ωc；驱动电机丝杆传动模块进行运行，带宽补偿模块采集运动过程中的电流，得到如图7所示的存在谐振的电流曲线图，并进行傅里叶变换，得到其幅频特性图；带宽补偿模块使用传感器对位置进行测量得到当前位置l，设定期望调整范围，作为归一化范围；根据幅频特性图，如果存在谐振频率，根据谐振频率规律进行归一化映射：；以及调整控制带宽ωc进行补偿为： ；根据幅频特性图，如果系统不存在谐振点，则调整控制带宽ωc进行补偿为：；带宽补偿模块将实际频率ω代入控制器，由控制器进行控制调整补偿： ，ωc改为ω。此时可以处理近端和远端不一致问题。本发明第三方面提供一种贴片机，包括上述基于位置进行控制带宽补偿系统，所述负载包括不限于贴装头、横梁、载物台或被检测工件等。综上所述，本发明技术方案具有以下有益效果：架构简单，鲁棒性强：只需要根据位置可以直接计算得到控制带宽；比例控制速度快；位置是实时测量值，从而带宽可以连续计算得到，没有跳变，因此没有参数调整带来的谐波；适用于高精度控制下带有位置传感器的情况，充分利用位置传感器信息，而不需要再额外增加任何硬件；计算简单，运算时间短，不影响整体的带宽，不对其他频率产生明显影响：运算时间长会引起控制滞后时间长，导致控制效果变差；计算时间越短越好。本发明方法，只有开方耗时，其他运算对于MCU都能很快时间，计算时间可以控制在微秒级；传感器的测量带宽很容易做到几十Mhz及以上，本发明等效为是比例控制，该方式下带宽无限大，叠加到整个系统带宽上，不产生影响。滤波或者其他观测器方式，计算后会有相位或者时间滞后，会降低控制带宽；能够充分利用系统运行的控制带宽，减小远端和近端运动差异，抑制振动：靠近电机端的控制带宽可以减小，远离电机端的控制带宽可以增强，从而能够避免从远端运动到近端，和从近端运动到远端时，控制上的差异，使控制响应一致；或者随着谐振频率调整带宽从而可以能够有自适应能力，而不必全部固定到一个小的控制带宽上。本发明方法适用但不仅限于适用于电机丝杆传动系统，还可应用到与电机丝杆传动系统具有相同结构原理的系统中，如电机驱动皮带传送的系统、电机驱动螺杆传送的系统。本发明中位置测量采用传感器测量，但不限于传感器。以上结合附图详细描述了本发明的优选实施方式，但是，本发明并不限于此。在本发明的技术构思范围内，可以对本发明的技术方案进行多种简单变型包括各个具体技术特征以任何合适的方式进行组合。为了避免不必要的重复，本发明对各种可能的组合方式不再另行说明。但这些简单变型和组合同样应当视为本发明所公开的内容，均属于本发明的保护范围。
