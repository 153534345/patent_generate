标题title
免密钥发行的安全模组防盗用方法、安全模组及装置
摘要abst
本发明涉及安全模组和物联网安全领域，提供一种免密钥发行的安全模组防盗用方法、安全模组及装置。所述方法包括：在安全模组注册过程中，生成第一随机数作为安全模组与装置绑定的绑定凭证，将第一随机数发送到装置；在安全模组与装置绑定使用时，生成第二随机数作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数发送到装置；接收装置发送的第一密文，根据安全模组生成的第一随机数和第二随机数进行加密计算得到第二密文，将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系。本发明无需第三方发行密钥，即可实现安全模组与唯一的装置进行绑定的安全机制，防止安全模组被盗用。
权利要求书clms
1.一种免密钥发行的安全模组防盗用方法，应用于与装置绑定使用的安全模组，其特征在于，所述方法包括：生成第二随机数作为验证所述安全模组与所述装置的绑定关系的验证凭证，将第二随机数发送到所述装置；接收所述装置发送的第一密文，将第一密文与第二密文进行比较，根据比较结果验证所述安全模组与所述装置的绑定关系；所述第一密文是所述装置根据第一随机数和第二随机数进行加密计算得到的，所述第二密文是所述安全模组根据所述第一随机数和所述第二随机数进行加密计算得到的，所述第一随机数作为所述安全模组与所述装置绑定的绑定凭证，由所述安全模组生成并发送至所述装置，或由所述装置生成并发送至所述安全模组。2.根据权利要求1所述的免密钥发行的安全模组防盗用方法，其特征在于，所述方法还包括：在安全模组注册过程中，接收所述装置发送的绑定锁闭指令，根据所述绑定锁闭指令触发所述安全模组与所述装置完成绑定锁闭；所述绑定锁闭指令是所述装置接收并保存所述安全模组发送的第一随机数之后，向所述安全模组发送的。3.根据权利要求1所述的免密钥发行的安全模组防盗用方法，其特征在于，所述第一密文是所述装置采用单向摘要算法或对称加密算法对所述第一随机数和所述第二随机数进行加密计算得到的；所述第二密文是所述安全模组采用单向摘要算法或对称加密算法对所述第一随机数和所述第二随机数进行加密计算得到的。4.根据权利要求1所述的免密钥发行的安全模组防盗用方法，其特征在于，所述将第一密文与第二密文进行比较，根据比较结果验证所述安全模组与所述装置的绑定关系，包括：比较第一密文与第二密文是否一致，若一致，则确定所述安全模组与所述装置的绑定关系验证成功。5.根据权利要求1所述的免密钥发行的安全模组防盗用方法，其特征在于，所述安全模组通过与所述装置之间的硬件链路发送所述第一随机数和所述第二随机数到所述装置。6.一种免密钥发行的安全模组防盗用方法，应用于与安全模组绑定使用的装置，其特征在于，所述方法包括：接收安全模组发送的第一随机数并保存，将第一随机数作为装置与安全模组绑定的绑定凭证；或者，生成第一随机数作为装置与安全模组绑定的绑定凭证，将所述第一随机数发送至所述安全模组；接收安全模组发送的第二随机数，将所述第二随机数作为验证所述安全模组与所述装置的绑定关系的验证凭证，根据第一随机数和第二随机数进行加密计算得到第一密文，将第一密文发送到安全模组，以验证安全模组与装置的绑定关系。7.根据权利要求6所述的免密钥发行的安全模组防盗用方法，其特征在于，所述方法还包括：在安全模组注册过程中，所述装置在接收并保存所述安全模组发送的第一随机数之后，向所述安全模组发送绑定锁闭指令，所述绑定锁闭指令用于触发所述安全模组与所述装置完成绑定锁闭。8.根据权利要求6所述的免密钥发行的安全模组防盗用方法，其特征在于，所述装置采用单向摘要算法或对称加密算法对第一随机数和第二随机数进行计算得到第一密文；所述安全模组在接收到第一密文之后，采用单向摘要算法或对称加密算法对第一随机数和第二随机数进行计算得到第二密文，将接收到的第一密文与计算得到的第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系。9.一种免密钥发行的安全模组防盗用方法，应用于安全模组以及与安全模组绑定使用的装置，其特征在于，所述方法包括：在安全模组注册过程中：安全模组生成第一随机数作为安全模组与装置绑定的绑定凭证，将第一随机数发送到装置；或者，装置生成第一随机数作为装置与安全模组绑定的绑定凭证，将第一随机数发送到安全模组；装置接收安全模组发送的第一随机数并保存，将第一随机数作为装置与安全模组绑定的绑定凭证；或者，安全模组接收装置发送的第一随机数并保存，将第一随机数作为安全模组与装置绑定的绑定凭证；在安全模组与装置绑定使用时：安全模组生成第二随机数作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数发送到装置；装置接收安全模组发送的第二随机数，将第二随机数作为验证安全模组与装置的绑定关系的验证凭证，根据第一随机数和第二随机数进行加密计算得到第一密文，将第一密文发送到安全模组；安全模组接收装置发送的第一密文，将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。10.一种免密钥发行的安全模组防盗用方法，应用于安全模组以及与安全模组绑定使用的装置，其特征在于，所述方法包括：在安全模组注册过程中：安全模组生成一对非对称密钥，保存非对称密钥中的私钥作为安全模组与装置绑定的绑定凭证，将非对称密钥中的公钥发送到装置；装置接收安全模组发送的公钥并保存，将公钥作为装置与安全模组绑定的绑定凭证；在安全模组与装置绑定使用时：安全模组生成随机数作为验证安全模组与装置的绑定关系的验证凭证，将随机数发送到装置；装置接收安全模组发送的随机数，利用装置保存的绑定凭证对随机数进行加密得到密文，将密文发送到安全模组；安全模组接收密文，利用安全模组保存的绑定凭证对密文进行解密得到随机数，将安全模组生成的随机数与解密得到的随机数进行比较，根据比较结果验证安全模组与装置的绑定关系。11.一种与装置绑定使用的安全模组，其特征在于，包括：随机数生成模块，用于在安全模组注册过程中生成第一随机数，以及在安全模组与装置绑定使用时生成第二随机数，所述第一随机数作为安全模组与装置绑定的绑定凭证，所述第二随机数作为验证安全模组与装置的绑定关系的验证凭证；验证模块，用于在与装置绑定使用时将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系；所述第一密文是装置根据第一随机数和第二随机数进行加密计算得到的，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。12.一种与安全模组绑定使用的装置，其特征在于，包括：随机数生成模块，用于在安全模组注册过程中生成第一随机数，所述第一随机数作为安全模组与装置绑定的绑定凭证；加密模块，用于在与安全模组绑定使用时，根据第一随机数和第二随机数进行加密计算得到第一密文，所述第一密文用于与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系；所述第二随机数是由安全模组生成的，作为验证安全模组与装置的绑定关系的验证凭证，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。13.一种物联网设备，其特征在于，包括：安全模组以及与安全模组绑定使用的装置；所述安全模组用于在注册过程中，生成第一随机数作为安全模组与装置绑定的绑定凭证，将第一随机数发送到装置；所述装置用于接收安全模组发送的第一随机数并保存，将第一随机数作为装置与安全模组绑定的绑定凭证；所述安全模组还用于在与装置绑定使用时，生成第二随机数作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数发送到装置；所述装置还用于接收安全模组发送的第二随机数，将第二随机数作为验证安全模组与装置的绑定关系的验证凭证，根据第一随机数和第二随机数进行加密计算得到第一密文，将第一密文发送到安全模组；所述安全模组还用于接收装置发送的第一密文，将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。14.一种计算机设备，其特征在于，包括：存储器；处理器；以及计算机程序；其中，所述计算机程序存储在存储器中，并被配置为由处理器执行以实现如权利要求1至权利要求10中任一项所述的免密钥发行的安全模组防盗用方法。15.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行以实现如权利要求1至权利要求10中任一项所述的免密钥发行的安全模组防盗用方法。
说明书desc
技术领域本发明涉及安全模组和物联网安全领域，具体地涉及一种免密钥发行的安全模组防盗用方法、一种与装置绑定使用的安全模组、一种与安全模组绑定使用的装置、一种物联网设备、一种计算机设备以及一种计算机可读存储介质。背景技术安全模组是指内嵌安全芯片的安全硬件模组或安全芯片，例如SIM卡、eSIM、安全TF卡、Ukey等。安全模组可以为使用安全模组的装置提供合法身份。在安全模组的应用中存在一些安全威胁，如安全模组被非法获得，可以直接被用于非法装置上，会给网络和业务带来威胁。通常采用在安全模组内置密钥的方式来实现安全应用，避免安全模组被非法盗用。现有技术中，首先需要在安全模组的工厂生产阶段预制密钥，即通过密钥发行的方式在安全模组和欲使用安全模组的装置上预制密钥。通常，欲使用安全模组的装置是不具备密钥发行能力的，因此需要密钥发行平台通过安全通信链路向安全模组和装置发送密钥数据，或者需要专用的密钥发行机通过读写机构向安全模组和装置写入密钥数据。现有的密钥发行方法过程复杂，需要密钥发行平台或密钥发行机等第三方机构参与，也存在一定安全隐患。发明内容为了解决现有技术的缺陷，本发明实施例中提供了一种免密钥发行的安全模组防盗用方法。本发明第一个方面，提供了一种免密钥发行的安全模组防盗用方法，应用于与装置绑定使用的安全模组，所述方法包括：生成第二随机数作为验证所述安全模组与所述装置的绑定关系的验证凭证，将第二随机数发送到所述装置；接收所述装置发送的第一密文，将第一密文与第二密文进行比较，根据比较结果验证所述安全模组与所述装置的绑定关系；所述第一密文是所述装置根据第一随机数和第二随机数进行加密计算得到的，所述第二密文是所述安全模组根据所述第一随机数和所述第二随机数进行加密计算得到的，所述第一随机数作为所述安全模组与所述装置绑定的绑定凭证，由所述安全模组生成并发送至所述装置，或由所述装置生成并发送至所述安全模组。本发明实施例中，上述方法还包括：在安全模组注册过程中，接收所述装置发送的绑定锁闭指令，根据所述绑定锁闭指令触发所述安全模组与所述装置完成绑定锁闭；所述绑定锁闭指令是所述装置接收并保存所述安全模组发送的第一随机数之后，向所述安全模组发送的。本发明实施例中，所述第一密文是所述装置采用单向摘要算法或对称加密算法对所述第一随机数和所述第二随机数进行加密计算得到的；所述第二密文是所述安全模组采用单向摘要算法或对称加密算法对所述第一随机数和所述第二随机数进行加密计算得到的。本发明实施例中，所述将第一密文与第二密文进行比较，根据比较结果验证所述安全模组与所述装置的绑定关系，包括：比较第一密文与第二密文是否一致，若一致，则确定所述安全模组与所述装置的绑定关系验证成功。本发明实施例中，所述安全模组通过与所述装置之间的硬件链路发送所述第一随机数和所述第二随机数到所述装置。本发明第二个方面，提供了一种免密钥发行的安全模组防盗用方法，应用于与安全模组绑定使用的装置，所述方法包括：接收安全模组发送的第一随机数并保存，将第一随机数作为装置与安全模组绑定的绑定凭证；或者，生成第一随机数作为装置与安全模组绑定的绑定凭证，将所述第一随机数发送至所述安全模组；接收安全模组发送的第二随机数，将所述第二随机数作为验证所述安全模组与所述装置的绑定关系的验证凭证，根据第一随机数和第二随机数进行加密计算得到第一密文，将第一密文发送到安全模组，以验证安全模组与装置的绑定关系。本发明实施例中，上述方法还包括：在安全模组注册过程中，所述装置在接收并保存所述安全模组发送的第一随机数之后，向所述安全模组发送绑定锁闭指令，所述绑定锁闭指令用于触发所述安全模组与所述装置完成绑定锁闭。本发明实施例中，所述装置采用单向摘要算法或对称加密算法对第一随机数和第二随机数进行计算得到第一密文；所述安全模组在接收到第一密文之后，采用单向摘要算法或对称加密算法对第一随机数和第二随机数进行计算得到第二密文，将接收到的第一密文与计算得到的第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系。本发明第三个方面，提供了一种免密钥发行的安全模组防盗用方法，应用于安全模组以及与安全模组绑定使用的装置，所述方法包括：在安全模组注册过程中：安全模组生成第一随机数作为安全模组与装置绑定的绑定凭证，将第一随机数发送到装置；或者，装置生成第一随机数作为装置与安全模组绑定的绑定凭证，将第一随机数发送到安全模组；装置接收安全模组发送的第一随机数并保存，将第一随机数作为装置与安全模组绑定的绑定凭证；或者，安全模组接收装置发送的第一随机数并保存，将第一随机数作为安全模组与装置绑定的绑定凭证；在安全模组与装置绑定使用时：安全模组生成第二随机数作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数发送到装置；装置接收安全模组发送的第二随机数，将第二随机数作为验证安全模组与装置的绑定关系的验证凭证，根据第一随机数和第二随机数进行加密计算得到第一密文，将第一密文发送到安全模组；安全模组接收装置发送的第一密文，将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。本发明第四个方面，提供了一种免密钥发行的安全模组防盗用方法，应用于安全模组以及与安全模组绑定使用的装置，所述方法包括：在安全模组注册过程中：安全模组生成一对非对称密钥，保存非对称密钥中的私钥作为安全模组与装置绑定的绑定凭证，将非对称密钥中的公钥发送到装置；装置接收安全模组发送的公钥并保存，将公钥作为装置与安全模组绑定的绑定凭证；在安全模组与装置绑定使用时：安全模组生成随机数作为验证安全模组与装置的绑定关系的验证凭证，将随机数发送到装置；装置接收安全模组发送的随机数，利用装置保存的绑定凭证对随机数进行加密得到密文，将密文发送到安全模组；安全模组接收密文，利用安全模组保存的绑定凭证对密文进行解密得到随机数，将安全模组生成的随机数与解密得到的随机数进行比较，根据比较结果验证安全模组与装置的绑定关系。本发明实施例还提供了一种与装置绑定使用的安全模组，包括：随机数生成模块，用于在安全模组注册过程中生成第一随机数，以及在安全模组与装置绑定使用时生成第二随机数，所述第一随机数作为安全模组与装置绑定的绑定凭证，所述第二随机数作为验证安全模组与装置的绑定关系的验证凭证；验证模块，用于在与装置绑定使用时将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系；所述第一密文是装置根据第一随机数和第二随机数进行加密计算得到的，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。本发明实施例还提供了一种与安全模组绑定使用的装置，包括：随机数生成模块，用于在安全模组注册过程中生成第一随机数，所述第一随机数作为安全模组与装置绑定的绑定凭证；加密模块，用于在与安全模组绑定使用时，根据第一随机数和第二随机数进行加密计算得到第一密文，所述第一密文用于与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系；所述第二随机数是由安全模组生成的，作为验证安全模组与装置的绑定关系的验证凭证，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。本发明实施例还提供了一种物联网设备，包括：安全模组以及与安全模组绑定使用的装置；所述安全模组用于在注册过程中，生成第一随机数作为安全模组与装置绑定的绑定凭证，将第一随机数发送到装置；所述装置用于接收安全模组发送的第一随机数并保存，将第一随机数作为装置与安全模组绑定的绑定凭证；所述安全模组还用于在与装置绑定使用时，生成第二随机数作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数发送到装置；所述装置还用于接收安全模组发送的第二随机数，将第二随机数作为验证安全模组与装置的绑定关系的验证凭证，根据第一随机数和第二随机数进行加密计算得到第一密文，将第一密文发送到安全模组；所述安全模组还用于接收装置发送的第一密文，将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系，所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。本发明还提供了一种计算机设备，该计算机设备包括存储器、处理器以及计算机程序，该计算机程序存储在存储器中，并被配置为由处理器执行以实现上述的免密钥发行的安全模组防盗用方法。本发明还提供了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行以实现上述的免密钥发行的安全模组防盗用方法。本发明将安全模组的使用过程分为注册绑定和验证绑定两个阶段，在注册绑定阶段根据绑定凭证将安全模组与装置进行绑定，在使用阶段利用验证凭证验证安全模组与装置的绑定关系，无需第三方发行密钥，即可实现安全模组与唯一的装置进行绑定的安全机制，即使安全模组被盗，也无法应用到其它装置上。而且，配对使用的安全模组与装置之间共享同一个绑定凭证，不同的安全模组与装置之间的绑定凭证是不同的，保障凭证的差异化和个性化，进一步提高安全模组的安全性，防止安全模组被盗用。附图说明此处所说明的附图用来提供对本发明的进一步理解，构成本发明的一部分，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。在附图中：图1为本发明实施例一提供的免密钥发行的安全模组防盗用方法的流程图；图2为本发明实施例二提供的免密钥发行的安全模组防盗用方法的流程图；图3为本发明实施例三提供的免密钥发行的安全模组防盗用方法的流程图；图4为本发明实施方式提供的物联网设备的框图。具体实施方式为了使本发明实施例中的技术方案及优点更加清楚明白，以下结合附图对本发明的示例性实施例进行进一步详细的说明，显然，所描述的实施例仅是本发明的一部分实施例，而不是所有实施例的穷举。需要说明的是，在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。在实现本发明的过程中，发明人发现，需要配备使用安全模块的装置通常不具备密钥发行能力，需要通过密钥发行平台或密钥发行机等第三方机构对装置进行密钥初始化和预制密钥，这种方式在一定程度上防止安全模组被盗用，但流程较为复杂，且装置生产过程中也难以进行密钥个人化发行，无法实现安全模组与唯一的装置进行绑定等安全机制。针对上述问题，本发明实施方式提供一种免密钥发行的安全模组防盗用方法，将安全模组同唯一的装置进行绑定，可以防止安全模组被盗用后的滥用。免密钥发行是指装置无需预制密钥就可以与安全模组进行绑定，简化了安全机制的整体流程。该方法包括注册绑定和验证绑定两个阶段：注册绑定阶段，即安全模组首次在装置上电时，或者在某种触发条件下触发绑定流程，安全模组与装置通过协商的绑定凭证实现绑定；验证绑定阶段，即安全模组重新上电时或者在某种触发条件下，安全模组对装置进行认证，验证装置中存在正确的绑定凭证。本发明将安全模组的使用过程分为注册绑定和验证绑定两个阶段，在注册绑定阶段根据绑定凭证将安全模组与装置进行绑定，在使用阶段利用验证凭证验证安全模组与装置的绑定关系，无需第三方发行密钥，即可实现安全模组与唯一的装置进行绑定的安全机制，即使安全模组被盗，也无法应用到其它装置上。而且，配对使用的安全模组与装置之间共享同一个绑定凭证，不同的安全模组与装置之间的绑定凭证是不同的，保障凭证的差异化和个性化，进一步提高安全模组的安全性，防止安全模组被盗用后的滥用。下面对上述方案进行详细阐述。实施例一图1为本发明实施例一提供的免密钥发行的安全模组防盗用方法的流程图。如图1所示，本实施例提供一种免密钥发行的安全模组防盗用方法，应用于安全模组以及与安全模组绑定使用的装置，所述方法包括注册绑定和验证绑定两个阶段，具体流程如下：在安全模组注册过程中，安全模组生成第一随机数R1作为安全模组与装置绑定的绑定凭证，将第一随机数R1发送到装置；装置接收安全模组发送的第一随机数R1并保存，将第一随机数R1作为装置与安全模组绑定的绑定凭证。在安全模组与装置绑定使用时，安全模组生成第二随机数R2作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数R2发送到装置。装置接收安全模组发送的第二随机数R2，将第二随机数R2作为验证安全模组与装置的绑定关系的验证凭证，根据保存的第一随机数R1和接收到的第二随机数R2进行加密计算得到第一密文M1，将第一密文M1发送到安全模组。安全模组接收装置发送的第一密文M1，根据安全模组生成的第一随机数R1和第二随机数R2进行加密计算得到的第二密文M2，将第一密文M1与第二密文M2进行比较，根据比较结果验证安全模组与装置的绑定关系。本实施例中，通过安全模组向装置发送作为绑定凭证的第一随机数R1，安全模组与装置之间共享同一个绑定凭证R1。参照图1，应用于与装置绑定使用的安全模组，所述免密钥发行的安全模组防盗用方法包括：在安全模组注册过程中，生成第一随机数R1作为安全模组与装置绑定的绑定凭证，将第一随机数R1发送到装置。在安全模组与装置绑定使用时，生成第二随机数R2作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数R2发送到装置；接收装置发送的第一密文M1，采用单向摘要算法或对称加密算法对安全模组生成的第一随机数R1和第二随机数R2进行计算得到第二密文M2，将第一密文M1与第二密文M2进行比较，根据比较结果验证安全模组与装置的绑定关系。参照图1，应用于与安全模组绑定使用的装置，所述免密钥发行的安全模组防盗用方法包括：在安全模组注册过程中，接收安全模组发送的第一随机数R1并保存，将第一随机数R1作为装置与安全模组绑定的绑定凭证。在与安全模组绑定使用时，接收安全模组发送的第二随机数R2，将第二随机数R2作为验证安全模组与装置的绑定关系的验证凭证，根据接收到的第一随机数R1和第二随机数R2进行加密计算得到第一密文M1，将第一密文M1发送到安全模组，以验证安全模组与装置的绑定关系。在一具体实施例中，安全模组验证与装置的绑定关系时，比较第一密文M1与第二密文M2是否一致，若一致，则确定安全模组与装置的绑定关系验证成功，安全模组启动后续安全服务；若不一致，则确定安全模组与装置的绑定关系验证不成功，安全模组不启动安全服务。在一具体实施例中，装置采用单向摘要算法或对称加密算法对接收到的第一随机数R1和第二随机数R2进行计算得到第一密文M1；安全模组采用单向摘要算法或对称加密算法对安全模组生成的第一随机数R1和第二随机数R2进行计算得到第二密文M2。其中，单向摘要算法可采用SHA256、SM3等摘要算法，对称加密算法可采用AES、SM4等加密算法。本实施例在验证绑定过程中采用随机数和安全算法，安装模组与装置相互通信时，可以在不暴露绑定凭证等机密信息的基础上进行安全验证，确保安全模组注册绑定后不能再被其它装置使用。在一具体实施例中，在安全模组注册绑定过程中，装置接收并保存安全模组发送的第一随机数之后，向安全模组发送绑定锁闭指令。安全模组接收到绑定锁闭指令之后，根据绑定锁闭指令触发安全模组与装置完成绑定锁闭，此时安全模组中的绑定凭证不能再更改，禁止安全模组重新写入绑定凭证。由于在工厂环境中或初始绑定过程中，安全模组可能存在重写的需求。本实施例中通过绑定锁闭指令触发安全模组完成绑定锁闭，可避免安全模组绑定过程中失败导致安全模组被报废。在一具体实施例中，安全模组通过与装置之间的硬件链路发送第一随机数和第二随机数到装置。采用随机数作为绑定凭证和验证凭证，并结合安全算法生成密文，在硬件链路上传输，不会在物理通信信道暴露绑定凭证和验证凭证，可以预防物理攻击。实施例二图2为本发明实施例二提供的免密钥发行的安全模组防盗用方法的流程图。如图2所示，本实施例提供一种免密钥发行的安全模组防盗用方法，应用于安全模组以及与安全模组绑定使用的装置，所述方法包括注册绑定和验证绑定两个阶段，具体流程如下：在安全模组注册过程中，装置生成第一随机数R1作为装置与安全模组绑定的绑定凭证，将第一随机数R1发送到安全模组；安全模组接收装置发送的第一随机数R1并保存，将第一随机数R1作为安全模组与装置绑定的绑定凭证。在安全模组与装置绑定使用时，安全模组生成第二随机数R2作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数R2发送到装置。装置接收安全模组发送的第二随机数R2，将第二随机数R2作为验证安全模组与装置的绑定关系的验证凭证，根据装置生成的第一随机数R1与接收到的第二随机数R2进行加密计算得到第一密文M1，将第一密文M1发送到安全模组。安全模组接收装置发送的第一密文M1，根据安全模组生成的第二随机数R2与保存的第一随机数R1进行加密计算得到第二密文M2，将第一密文M1与第二密文M2进行比较，根据比较结果验证安全模组与装置的绑定关系。本实施例中，通过装置向安全模组发送作为绑定凭证的第一随机数R1，装置与安全模组之间共享同一个绑定凭证R1。参照图1，应用于与装置绑定使用的安全模组，所述免密钥发行的安全模组防盗用方法包括：在安全模组注册过程中，接收装置发送的第一随机数并保存，将第一随机数作为安全模组与装置绑定的绑定凭证；在安全模组与装置绑定使用时，生成第二随机数作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数发送到装置；接收装置发送的第一密文，根据安全模组生成的第二随机数与保存的第一随机数进行加密计算得到第二密文，将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系。在一具体实施例中，安全模组验证与装置的绑定关系时，比较第一密文M1与第二密文M2是否一致，若一致，则确定安全模组与装置的绑定关系验证成功，安全模组启动后续安全服务；若不一致，则确定安全模组与装置的绑定关系验证不成功，安全模组不启动安全服务。在一具体实施例中，装置采用单向摘要算法或对称加密算法对第一随机数R1和第二随机数R2进行计算得到第一密文M1；安全模组采用单向摘要算法或对称加密算法对第一随机数R1和第二随机数R2进行计算得到第二密文M2。在一具体实施例中，在安全模组注册绑定过程中，安全模组接收并保存第一随机数之后，向装置返回确定保存的指令，或者装置在确定安全模组接收并保存第一随机数之后，装置向安全模组发送绑定锁闭指令。安全模组接收到绑定锁闭指令之后，根据绑定锁闭指令触发安全模组与装置完成绑定锁闭，此时安全模组中的绑定凭证不能再更改，禁止安全模组重新写入绑定凭证。由于在工厂环境中或初始绑定过程中，安全模组可能存在重写的需求。本实施例中通过绑定锁闭指令触发安全模组完成绑定锁闭，可避免安全模组绑定过程中失败导致安全模组被报废。在一具体实施例中，安全模组通过与装置之间的硬件链路发送第一随机数和第二随机数到装置。采用随机数作为绑定凭证和验证凭证，并结合安全算法生成密文，在硬件链路上传输，不会在物理通信信道暴露绑定凭证和验证凭证，可以预防物理攻击。实施例三图3为本发明实施例三提供的免密钥发行的安全模组防盗用方法的流程图。如图3所示，本实施例提供一种免密钥发行的安全模组防盗用方法，应用于安全模组以及与安全模组绑定使用的装置，所述方法包括注册绑定和验证绑定两个阶段，具体流程如下：在安全模组注册过程中，安全模组生成一对非对称密钥，保存非对称密钥中的私钥作为安全模组与装置绑定的绑定凭证，将非对称密钥中的公钥发送到装置；装置接收安全模组发送的公钥并保存，将公钥作为装置与安全模组绑定的绑定凭证。在安全模组与装置绑定使用时，安全模组生成随机数R’作为验证安全模组与装置的绑定关系的验证凭证，将随机数R’发送到装置；装置接收安全模组发送的随机数R’，利用装置保存的绑定凭证对随机数R’进行加密得到密文M’，将密文M’发送到安全模组；安全模组接收密文M’，利用安全模组保存的绑定凭证对密文M’进行解密得到随机数R”，将安全模组生成的随机数R’与解密得到的随机数R”进行比较，根据比较结果验证安全模组与装置的绑定关系。其中，若随机数R’与随机数R”一致，则确定安全模组与装置的绑定关系验证成功，安全模组启动后续安全服务；若随机数R’与随机数R”不一致，则确定安全模组与装置的绑定关系验证不成功，安全模组不启动安全服务。在一具体实施例中，在安全模组注册绑定过程中，装置接收并保存安全模组发送的绑定凭证之后，向安全模组发送绑定锁闭指令。安全模组接收到绑定锁闭指令之后，根据绑定锁闭指令触发安全模组与装置完成绑定锁闭，此时安全模组中的绑定凭证不能再更改，禁止安全模组重新写入绑定凭证。由于在工厂环境中或初始绑定过程中，安全模组可能存在重写的需求。本实施例中通过绑定锁闭指令触发安全模组完成绑定锁闭，可避免安全模组绑定过程中失败导致安全模组被报废。在一具体实施例中，安全模组通过与装置之间的硬件链路发送第一随机数和第二随机数到装置。采用随机数作为绑定凭证和验证凭证，并结合安全算法生成密文，在硬件链路上传输，不会在物理通信信道暴露绑定凭证和验证凭证，可以预防物理攻击。本实施例通过安全模组生成非对称密钥作为绑定凭证，生成随机数作为验证凭证，在注册绑定阶段根据绑定凭证将安全模组与装置进行绑定，在使用阶段利用验证凭证验证绑定关系，无需第三方发行密钥，即可实现安全模组与唯一的装置进行绑定的安全机制，防止安全模组被盗用。本发明实施方式还提供一种与装置绑定使用的安全模组，包括：随机数生成模块和验证模块。随机数生成模块用于在安全模组注册过程中生成第一随机数，以及在安全模组与装置绑定使用时生成第二随机数，第一随机数作为安全模组与装置绑定的绑定凭证，第二随机数作为验证安全模组与装置的绑定关系的验证凭证。验证模块用于在与装置绑定使用时将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系，其中，第一密文是装置根据第一随机数和第二随机数进行加密计算得到的，第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。本实施方式提供的安全模组可以实现免密钥发行的防盗用功能，其具体实现方式可以参阅上述实施例提供的免密钥发行的安全模组防盗用方法进行理解，此处不再赘述。本发明实施方式还提供一种与安全模组绑定使用的装置，包括：随机数生成模块和加密模块。随机数生成模块用于在安全模组注册过程中生成第一随机数，所述第一随机数作为安全模组与装置绑定的绑定凭证。加密模块用于在与安全模组绑定使用时，根据第一随机数和第二随机数进行加密计算得到第一密文。所述第一密文用于与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系。所述第二随机数是由安全模组生成的，作为验证安全模组与装置的绑定关系的验证凭证。所述第二密文是安全模组根据第一随机数和第二随机数进行加密计算得到的。本实施方式提供的装置可以配合安全模组实现免密钥发行的防盗用功能，其具体实现方式可以参阅上述实施例提供的免密钥发行的安全模组防盗用方法进行理解，此处不再赘述。本发明实施方式还提供一种物联网设备，如图4所示，该物联网设备包括安全模组以及与安全模组绑定使用的装置。安全模组用于在注册过程中，生成第一随机数作为安全模组与装置绑定的绑定凭证，将第一随机数发送到装置。装置用于接收安全模组发送的第一随机数并保存，将第一随机数作为装置与安全模组绑定的绑定凭证；或者，在安全模组注册过程中，装置生成第一随机数作为装置与安全模组绑定的绑定凭证，将第一随机数发送到安全模组，安全模组接收装置发送的第一随机数并保存，将第一随机数作为安全模组与装置绑定的绑定凭证。安全模组还用于在与装置绑定使用时，生成第二随机数作为验证安全模组与装置的绑定关系的验证凭证，将第二随机数发送到装置。装置还用于接收安全模组发送的第二随机数，将第二随机数作为验证安全模组与装置的绑定关系的验证凭证，根据接收到的第一随机数和第二随机数进行加密计算得到第一密文，将第一密文发送到安全模组。安全模组还用于接收装置发送的第一密文，根据安全模组生成的第一随机数和第二随机数进行加密计算得到第二密文，将第一密文与第二密文进行比较，根据比较结果验证安全模组与装置的绑定关系。本发明实施方式还提供一种计算机设备，该计算机设备包括存储器、处理器以及计算机程序，该计算机程序存储在存储器中，并被配置为由处理器执行以实现上述的免密钥发行的安全模组防盗用方法。本发明实施方式还提供一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行以实现上述的免密钥发行的安全模组防盗用方法。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明实施例中的方案可以采用各种计算机语言实现，例如，面向对象的程序设计语言Java和直译式脚本语言JavaScript等。本发明是参照根据本发明实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。尽管已描述了本发明的优选实施例，但本领域内的技术人员一旦得知了基本创造性概念，则可对这些实施例作出另外的变更和修改。所以，所附权利要求意欲解释为包括优选实施例以及落入本发明范围的所有变更和修改。显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围之内，则本发明也意图包含这些改动和变型在内。
