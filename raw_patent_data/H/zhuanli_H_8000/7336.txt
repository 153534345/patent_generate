标题title
一种高精度扩频信号捕获方法
摘要abst
本发明公开了一种高精度扩频信号捕获方法，所述方法包括：对接收到的信号进行数据采样；对采样数据进行载波频率的补偿修正；对频率修正后的采样数据进行伪码相位的相关解扩得到相关积分数据；根据相关积分数据计算得到自适应检测门限、相关积分峰值及旁峰信息；对伪码相位和载波频率进行插值校正；采用校正后的相关积分峰值与自适应检测门限作比较检测接收信号是否捕获成功，并解算得到接收信噪比、扩频码相位、载波多普勒频移。本发明能够快速、有效、精确地捕获扩频信号。
权利要求书clms
1.一种高精度扩频信号捕获方法，其特征在于，所述方法包括：对接收到的信号进行数据采样；对采样数据进行载波频率的补偿修正；对频率修正后的采样数据进行伪码相位的相关解扩得到相关积分数据；根据相关积分数据计算得到自适应检测门限、相关积分峰值及旁峰信息；对伪码相位和载波频率进行插值校正；采用校正后的相关积分峰值与自适应检测门限作比较检测接收信号是否捕获成功，并解算得到接收信噪比、扩频码相位、载波多普勒频移。2.如权利要求1所述的高精度扩频信号捕获方法，其特征在于，所述对采样数据进行载波频率的补偿修正具体包括：根据载波频偏范围将载波频偏划分成若干个频率子槽；根据若干个频率子槽内的载波频偏对采样数据进行载波频率的补偿修正。3.如权利要求2所述的高精度扩频信号捕获方法，其特征在于，所述根据载波频偏范围将载波频偏划分成若干个频率子槽具体包括：根据载波频偏范围将载波频偏划分成K+1个频率子槽，其中，fmin为载波频偏最小值，fmax为载波频偏最大值，第k个频率子槽内载波频偏fk为fmin+k×δf，其中，k为频率子槽搜索轮次，满足k∈，δf为载波频偏搜索步进，满足δf＝/K。4.如权利要求3所述的高精度扩频信号捕获方法，其特征在于，所述根据若干个频率子槽内的载波频偏对采样数据进行载波频率的补偿修正具体包括：根据载波频偏fk和采样速率fsamp，采用计算公式CWk＝fk×232/fsamp进行数据转换，得到载波频偏控制字CWk，对CWk进行累加得到查询地址，通过地址映射、查表生成载波频偏fk的本地载波，载波频偏fk的本地载波与采样数据进行复乘运算，对采样数据完成载波频率的补偿修正。5.如权利要求1所述的高精度扩频信号捕获方法，其特征在于，所述对频率修正后的采样数据进行伪码相位的相关解扩得到相关积分数据具体包括：对N个本地伪码进行N点快速傅里叶变换，取共轭后得到N个本地伪码变换数据；对N个采样数据进行N点快速傅里叶变换，得到N个采样数据变换数据，N个本地伪码变换数据和N个采样数据变换数据进行复乘运算得到N个复乘运算数据；对N个复乘运算数据进行N点快速傅里叶逆变换，得到N个逆变换数据，取绝对值后得到N个相关积分数据。6.如权利要求4所述的高精度扩频信号捕获方法，其特征在于，所述根据相关积分数据计算得到自适应检测门限、相关积分峰值及旁峰信息具体包括：对所有搜索子槽的×N个相关积分数据采用加权平均的方法得到积分均值Vavg，结合检测门限比例因子κthr，得到自适应检测门限Vthr为κthr×Vavg；采用比较搜索的方法得到相关积分峰值Vmax，其对应的频率指数/伪码相位为kmax/τmax，以及频率指数/伪码相位为kmax/对应的相关积分值为V-δτ、频率指数/伪码相位为kmax/对应的相关积分值为V+δτ、频率指数/伪码相位为/τmax对应的相关积分值为V-δf、频率指数/伪码相位为/τmax对应的相关积分值为V+δf，其中，N为采样数据总数，Rc为扩频码速率，δτ为伪码相位搜索步进，满足δτ＝Rc/fsamp。7.如权利要求6所述的高精度扩频信号捕获方法，其特征在于，所述对伪码相位和载波频率进行插值校正具体包括：采用三角关系对伪码相位进行插值校正，采用二次函数对载波频率进行插值校正。8.如权利要求7所述的高精度扩频信号捕获方法，其特征在于，所述采用三角关系对伪码相位进行插值校正具体包括：相关积分峰值Vmax对应的伪码相位为τmax，相关积分值V-δτ对应的伪码相位为τmax-δτ，相关积分值为V+δτ对应的伪码相位为τmax+δτ，根据伪码相关的三角函数关系，相关积分峰值的校正值ΔVτ为abs/2，伪码相位的校正值Δτ为其中，abs为取绝对值运算，min为取小值运算。9.如权利要求8所述的高精度扩频信号捕获方法，其特征在于，所述采用二次函数对载波频率进行插值校正具体包括：相关积分峰值Vmax对应的频率指数为kmax，相关积分值为V-δf对应的频率指数为kmax-1，相关积分值为V+δf对应的频率指数为kmax+1，根据相干积分的函数关系，采用二次函数差值校正后频率指数的校正值Δk为-b/-kmax，经过计算Δk为相关积分峰值的校正值ΔVf为a2+b+c-Vmax，经过计算ΔVf为a+bΔk。10.如权利要求9所述的高精度扩频信号捕获方法，其特征在于，所述采用校正后的相关积分峰值与自适应检测门限作比较检测接收信号是否捕获成功，并解算得到接收信噪比、扩频码相位、载波多普勒频移具体包括：采用校正后的相关积分峰值与自适应检测门限作比较判决的方法检测接收信号，并解算得到接收信噪比、扩频码相位、载波多普勒频移；经过校正后相关积分峰值为Vmax+ΔVτ+ΔVf，与自适应检测门限Vthr进行比较判决，当/＞时，表明捕获成功，否则捕获失败，当捕获成功时，解算得到的接收信噪比SNR为/＞扩频码相位τcode为τmax+Δτ、载波多普勒频移fdopl为fmin+×δf，其中，L为扩频码周期。/＞
说明书desc
技术领域本发明属于无线通信技术领域，尤其涉及一种高精度扩频信号捕获方法。背景技术扩频通信系统在发送端利用伪随机码对信息数据进行频谱扩展，在接收端对接收信号进行解扩以获得只有信息数据调制的载波信号，再进行载波解调从而获得信息数据，扩频信号的时频同步作为扩频通信系统的核心技术，包括捕获和跟踪两个步骤，而信号捕获是扩频接收信号处理的第一步关键环节，对扩频信号的伪码相位、载波频率进行粗略估计，其目的是使本地信号与接收信号之间的伪码相位、载波频率误差在跟踪环路的牵引范围，若本地信号与接收信号之间的误差超过了跟踪环路的牵引范围，则跟踪环路会无法正常入锁，若信号捕获提供高精度的伪码相位、载波频率测量值，本地信号与接收信号之间的误差较小，则跟踪环路能够有效而稳定地快速入锁，从而实现数据解调，因此，如何提高扩频信号伪码相位和载波频率的捕获精度，成为扩频通信系统的亟待解决的关键核心技术之一。传统信号捕获方法主要分为时域捕获法和频域捕获法，滑动相关捕获方法作为一种经典的时域捕获法，算法原理简单，易于工程实现，早期应用广泛，但捕获时间较长，捕获速度慢，计算量巨大；频域捕获法常采用快速傅里叶变换来实现信号捕获，主要有并行频率捕获法、并行码相位捕获法、基于部分匹配滤波器和FFT捕获方法等，基于FFT与信号卷积的关系实现扩频信号伪码相位或载波频率的并行搜索，从捕获精度、搜索效率和数据计算量等方面折中考虑，传统捕获方法伪码相位的捕获精度在±0.5个码片范围之内，载波频率的捕获精度在几百赫兹，若提高伪码相位、载波频率的捕获精度，需要减小伪码相位、载波频率的搜索步进，直接增加全部模糊区间所需的数据计算量，从而对捕获时间、搜索效率造成严重影响。因此，传统信号捕获方法有各自的技术优点，但难以兼顾捕获精度、捕获时间、搜索效率、数据计算量等互相影响和制约的技术指标，无法精确、快速、有效地捕获扩频信号的伪码相位和载波频率。发明内容本发明的目的在于，为克服现有技术缺陷，提供了一种高精度扩频信号捕获方法,具备捕获精度高、实现结构简单、处理实时性好的优点，能够快速、有效、精确地捕获扩频信号，为后续信号处理提供高精度的接收信噪比、扩频码相位和载波多普勒频移。本发明目的通过下述技术方案来实现：一种高精度扩频信号捕获方法，所述方法包括：对接收到的信号进行数据采样；对采样数据进行载波频率的补偿修正；对频率修正后的采样数据进行伪码相位的相关解扩得到相关积分数据；根据相关积分数据计算得到自适应检测门限、相关积分峰值及旁峰信息；对伪码相位和载波频率进行插值校正；采用校正后的相关积分峰值与自适应检测门限作比较检测接收信号是否捕获成功，并解算得到接收信噪比、扩频码相位、载波多普勒频移。进一步的，所述对采样数据进行载波频率的补偿修正具体包括：根据载波频偏范围将载波频偏划分成若干个频率子槽；根据若干个频率子槽内的载波频偏对采样数据进行载波频率的补偿修正。进一步的，所述根据载波频偏范围将载波频偏划分成若干个频率子槽具体包括：根据载波频偏范围将载波频偏划分成K+1个频率子槽，其中，fmin为载波频偏最小值，fmax为载波频偏最大值，第k个频率子槽内载波频偏fk为fmin+k×δf，其中，k为频率子槽搜索轮次，满足k∈，δf为载波频偏搜索步进，满足δf＝/K。进一步的，所述根据若干个频率子槽内的载波频偏对采样数据进行载波频率的补偿修正具体包括：根据载波频偏fk和采样速率fsamp，采用计算公式CWk＝fk×232/fsamp进行数据转换，得到载波频偏控制字CWk，对CWk进行累加得到查询地址，通过地址映射、查表生成载波频偏fk的本地载波，载波频偏fk的本地载波与采样数据进行复乘运算，对采样数据完成载波频率的补偿修正。进一步的，所述对频率修正后的采样数据进行伪码相位的相关解扩得到相关积分数据具体包括：对N个本地伪码进行N点快速傅里叶变换，取共轭后得到N个本地伪码变换数据；对N个采样数据进行N点快速傅里叶变换，得到N个采样数据变换数据，N个本地伪码变换数据和N个采样数据变换数据进行复乘运算得到N个复乘运算数据；对N个复乘运算数据进行N点快速傅里叶逆变换，得到N个逆变换数据，取绝对值后得到N个相关积分数据。进一步的，所述根据相关积分数据计算得到自适应检测门限、相关积分峰值及旁峰信息具体包括：对所有搜索子槽的×N个相关积分数据采用加权平均的方法得到积分均值Vavg，结合检测门限比例因子κthr，得到自适应检测门限Vthr为κthr×Vavg；采用比较搜索的方法得到相关积分峰值Vmax，其对应的频率指数/伪码相位为kmax/τmax，以及频率指数/伪码相位为kmax/对应的相关积分值为V-δτ、频率指数/伪码相位为kmax/对应的相关积分值为V+δτ、频率指数/伪码相位为/τmax对应的相关积分值为V-δf、频率指数/伪码相位为/τmax对应的相关积分值为V+δf，其中，N为采样数据总数，Rc为扩频码速率，δτ为伪码相位搜索步进，满足δτ＝Rc/fsamp。进一步的，所述对伪码相位和载波频率进行插值校正具体包括：采用三角关系对伪码相位进行插值校正，采用二次函数对载波频率进行插值校正。进一步的，所述采用三角关系对伪码相位进行插值校正具体包括：相关积分峰值Vmax对应的伪码相位为τmax，相关积分值V-δτ对应的伪码相位为τmax-δτ，相关积分值为V+δτ对应的伪码相位为τmax+δτ，根据伪码相关的三角函数关系，相关积分峰值的校正值ΔVτ为abs/2，伪码相位的校正值Δτ为其中，abs为取绝对值运算，min为取小值运算。进一步的，所述采用二次函数对载波频率进行插值校正具体包括：相关积分峰值Vmax对应的频率指数为kmax，相关积分值为V-δf对应的频率指数为kmax-1，相关积分值为V+δf对应的频率指数为kmax+1，根据相干积分的函数关系，采用二次函数差值校正后频率指数的校正值Δk为-b/-kmax，经过计算Δk为相关积分峰值的校正值ΔVf为a2+b+c-Vmax，经过计算ΔVf为a+bΔk。进一步的，所述采用校正后的相关积分峰值与自适应检测门限作比较检测接收信号是否捕获成功，并解算得到接收信噪比、扩频码相位、载波多普勒频移具体包括：采用校正后的相关积分峰值与自适应检测门限作比较判决的方法检测接收信号，并解算得到接收信噪比、扩频码相位、载波多普勒频移；经过校正后相关积分峰值为Vmax+ΔVτ+ΔVf，与自适应检测门限Vthr进行比较判决，当/＞时，表明捕获成功，否则捕获失败，当捕获成功时，解算得到的接收信噪比SNR为扩频码相位τcode为τmax+Δτ、载波多普勒频移fdopl为fmin+×δf，其中，L为扩频码周期。本发明的有益效果在于：本发明采用三角关系对伪码相位进行插值校正，采用二次函数对载波频率进行插值校正，采用校正后的相关积分峰值解算得到接收信噪比，相对于传统捕获方法，能够进一步有效地提高扩频信号的捕获精度。本发明对采样数据进行伪码相位的并行解扩，采用三角关系对伪码相位进行插值校正，采用二次函数对载波频率进行插值校正，相对于传统捕获方法，只需增加较少的数据计算复杂度，算法结构简单易实现。本发明能够快速处理采样数据，相关运算量少，采用多条数据处理支路并行搜索，极大地缩短数据处理时间，相对于传统捕获方法，捕获速度得到显著提高，具有良好的处理实时性。附图说明图1是本发明实施例提供的高精度扩频信号捕获方法流程示意图；图2是本发明实施例时频修正模块的结构原理示意图；图3是本发明实施例并行相关模块的结构原理示意图；图4是本发明实施例插值校正模块三角关系插值校正伪码相位的算法原理示意图；图5是本发明实施例插值校正模块二次函数插值校正载波频率的算法原理示意图。具体实施方式以下通过特定的具体实例说明本发明的实施方式，本领域技术人员可由本说明书所揭露的内容轻易地了解本发明的其他优点与功效。本发明还可以通过另外不同的具体实施方式加以实施或应用，本说明书中的各项细节也可以基于不同观点与应用，在没有背离本发明的精神下进行各种修饰或改变。需说明的是，在不冲突的情况下，以下实施例及实施例中的特征可以相互组合。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。传统信号捕获方法有各自的技术优点，但难以兼顾捕获精度、捕获时间、搜索效率、数据计算量等互相影响和制约的技术指标，无法精确、快速、有效地捕获扩频信号的伪码相位和载波频率。为了解决上述技术问题，提出了本发明一种高精度扩频信号捕获方法的下述各个实施例。参照图1，如图1所示是本实施例提供的高精度扩频信号捕获方法流程示意图，该方法通过数据采样模块、频偏开槽模块、频率修正模块、本地伪码模块、并行相关模块、峰值搜索模块、插值校正模块和检测解算模块实现。具体地，数据采样模块对接收信号进行数据采样处理；频偏开槽模块根据载波频偏范围将载波频偏划分成若干个频率子槽；频率修正模块根据频偏开槽模块若干个频率子槽内的载波频偏对数据采样模块输出的采样数据进行载波频率的补偿修正；并行相关模块采用FFT-IFFT算法对频率修正后的采样数据进行伪码相位的相关解扩；峰值搜索模块对所有相关积分数据采用加权平均的方法得到自适应检测门限，采用比较搜索的方法得到相关积分峰值及旁峰信息；插值校正模块采用三角关系对伪码相位进行插值校正，采用二次函数对载波频率进行插值校正；检测解算模块采用校正后的相关积分峰值与自适应检测门限作比较判决的方法检测接收信号，并解算得到接收信噪比、扩频码相位、载波多普勒频移。其中，数据采样模块对接收信号进行数据采样处理，采样数据总数N为fsamp/Rc×L，其中，fsamp为采样速率，Rc为扩频码速率，L为扩频码周期。频偏开槽模块根据载波频偏范围将载波频偏划分成K+1个频率子槽，其中，fmin为载波频偏最小值，fmax为载波频偏最大值，第k个频率子槽内载波频偏fk为fmin+k×δf，其中，k为频率子槽搜索轮次，满足k∈，δf为载波频偏搜索步进，满足δf＝/K。参照图2，如图2所示是本实施例时频修正模块的结构原理示意图。频率修正模块根据频偏开槽模块若干个频率子槽内的载波频偏对数据采样模块输出的采样数据进行载波频率的补偿修正；频率修正模块根据频偏开槽模块频率子槽内的载波频偏fk和采样速率fsamp，采用计算公式CWk＝fk×232/fsamp进行数据转换，得到载波频偏控制字CWk，对CWk进行累加得到查询地址，通过地址映射、查表生成载波频偏fk的本地载波，载波频偏fk的本地载波与数据采样模块输出的采样数据进行复乘运算，对采样数据完成载波频率的补偿修正。参照图3，如图3所示是本实施例并行相关模块的结构原理示意图。并行相关模块采用FFT-IFFT算法对频率修正后的采样数据进行伪码相位的相关解扩；第一N点FFT模块对N个本地伪码进行N点快速傅里叶变换，取共轭后得到N个本地伪码变换数据，第二N点FFT模块对N个采样数据进行N点快速傅里叶变换，得到N个采样数据变换数据，N个本地伪码变换数据和N个采样数据变换数据进行复乘运算得到N个复乘运算数据，N点IFFT模块对N个复乘运算数据进行N点快速傅里叶逆变换，得到N个逆变换数据，取绝对值后得到N个相关积分数据。峰值搜索模块对所有搜索子槽的×N个相关积分数据采用加权平均的方法得到积分均值Vavg，结合检测门限比例因子κthr，得到自适应检测门限Vthr为κthr×Vavg；采用比较搜索的方法得到相关积分峰值Vmax，其对应的频率指数/伪码相位为kmax/τmax，以及频率指数/伪码相位为kmax/对应的相关积分值为V-δτ、频率指数/伪码相位为kmax/对应的相关积分值为V+δτ、频率指数/伪码相位为/τmax对应的相关积分值为V-δf、频率指数/伪码相位为/τmax对应的相关积分值为V+δf，其中，N为采样数据总数，Rc为扩频码速率，δτ为伪码相位搜索步进，满足δτ＝Rc/fsamp。参照图4，如图4所示是本实施例插值校正模块三角关系插值校正伪码相位的算法原理示意图。插值校正模块采用三角关系对伪码相位进行插值校正；峰值搜索模块输出的相关积分峰值Vmax对应的伪码相位为τmax，即A点，相关积分值V-δτ对应的伪码相位为τmax-δτ，即B点，相关积分值为V+δτ对应的伪码相位为τmax+δτ，即C点；根据伪码相关的三角函数关系，A、B、C三点处于等腰三角形中，当V-δτ≤V+δτ时，B'C为V+δτ-V-δτ，为平行四边形且ΔAMM2为等腰三角形，MM1为/2，ΔABD和ΔMBM1呈相似三角形，AM1为/＞经过计算为/＞当V-δτ＞V+δτ时，MM1为/2，AM1为/＞采用三角关系差值校正后相关积分峰值的校正值ΔVτ为abs/2，伪码相位的校正值Δτ为/＞其中，abs为取绝对值运算，min为取小值运算。参照图5，如图5所示是本实施例插值校正模块二次函数插值校正载波频率的算法原理示意图。插值校正模块采用二次函数对载波频率进行插值校正；峰值搜索模块输出的相关积分峰值Vmax对应的频率指数为kmax，即A点，相关积分值为V-δf对应的频率指数为kmax-1，即E点，相关积分值为V+δf对应的频率指数为kmax+1，即F点；根据相干积分的函数关系，A、E、F三点拟合成开口向下的二次函数，设二次函数方程为V＝ak2+bk+c，将A、E、F三点坐标带入二次函数方程，解得a＝/2-Vmax、b＝/2-×kmax、c＝Vmax-akmax2-bkmax，二次函数最大点必然是顶点坐标处，采用二次函数差值校正后频率指数的校正值Δk为-b/-kmax，经过计算Δk为相关积分峰值的校正值ΔVf为a2+b+c-Vmax，经过计算ΔVf为a+bΔk。检测解算模块采用校正后的相关积分峰值与自适应检测门限作比较判决的方法检测接收信号，并解算得到接收信噪比、扩频码相位、载波多普勒频移；经过校正后相关积分峰值为Vmax+ΔVτ+ΔVf，与自适应检测门限Vthr进行比较判决，当/＞时，表明捕获成功，否则捕获失败，当捕获成功时，解算得到的接收信噪比SNR为扩频码相位τcode为τmax+Δτ、载波多普勒频移fdopl为fmin+×δf，其中，L为扩频码周期。本实施例采用三角关系对伪码相位进行插值校正，采用二次函数对载波频率进行插值校正，采用校正后的相关积分峰值解算得到接收信噪比，相对于传统捕获方法，能够进一步有效地提高扩频信号的捕获精度。对采样数据进行伪码相位的并行解扩，采用三角关系对伪码相位进行插值校正，采用二次函数对载波频率进行插值校正，相对于传统捕获方法，只需增加较少的数据计算复杂度，算法结构简单易实现。能够快速处理采样数据，相关运算量少，采用多条数据处理支路并行搜索，极大地缩短数据处理时间，相对于传统捕获方法，捕获速度得到显著提高，具有良好的处理实时性。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
