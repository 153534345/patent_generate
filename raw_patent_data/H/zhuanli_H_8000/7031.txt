标题title
RC振荡时钟的校准电路、校准方法、芯片和电子设备
摘要abst
本发明提供一种RC振荡时钟的校准电路、校准方法、芯片和电子设备，包括：RC振荡器，用于输出RC振荡时钟，且RC振荡器内设置有细调电容阵列和粗调电容阵列；参考时钟模块，用于输出参考时钟；第一计数模块，用于以多个RC振荡时钟的周期作为第一时间窗口对参考时钟的周期进行计数；第一比较模块，用于比较参考时钟的实际计数值和参考时钟的基准计数值，得到RC振荡时钟的频率偏差；校准模块，用于根据RC振荡时钟的频率偏差计算得到细调整值，RC振荡器还用于根据细调整值去调整细调电容阵列的比特位，以调整RC振荡时钟的频率。本发明能够在既满足校准精度的同时可以最大限度的节省功耗。
权利要求书clms
1.一种RC振荡时钟的校准电路，其特征在于，包括：RC振荡器，用于输出RC振荡时钟，且所述RC振荡器内设置有细调电容阵列和粗调电容阵列，分别用于对所述RC振荡器的电容值进行细调和粗调；参考时钟模块，用于输出参考时钟；第一计数模块，用于接收所述RC振荡时钟和所述参考时钟，以多个所述RC振荡时钟的周期作为第一时间窗口对所述参考时钟的周期进行计数，得到所述参考时钟的实际计数值；第一比较模块，用于比较所述参考时钟的实际计数值和所述参考时钟在所述第一时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；校准模块，用于当所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内时，根据所述RC振荡时钟的频率偏差计算得到细调整值；所述RC振荡器，还用于根据所述细调整值去调整所述细调电容阵列的比特位，以调整所述RC振荡时钟的频率。2.一种RC振荡时钟的校准电路，其特征在于，包括：RC振荡器，用于输出RC振荡时钟，且所述RC振荡器内设置有细调电容阵列和粗调电容阵列，分别用于对所述RC振荡器的电容值进行细调和粗调；参考时钟模块，用于输出参考时钟；第二计数模块，用于接收所述RC振荡时钟和所述参考时钟，以多个所述参考时钟的周期作为第二时间窗口对所述RC振荡时钟的周期进行计数，得到所述RC振荡时钟的实际计数值；第二比较模块，用于比较所述RC振荡时钟的实际计数值和所述RC振荡时钟在所述第二时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；校准模块，用于当所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内时，根据所述RC振荡时钟的频率偏差计算得到细调整值；所述RC振荡器，还用于根据所述细调整值去调整所述细调电容阵列的比特位，以调整所述RC振荡时钟的频率。3.根据权利要求1或2所述的RC振荡时钟的校准电路，其特征在于，所述RC振荡时钟为32.768KHz的睡眠时钟。4.根据权利要求1或2所述的RC振荡时钟的校准电路，其特征在于，所述校准电路还包括：校准时间间隔配置模块，用于配置两次校准的时间间隔，具体包括：将任意两次校准的时间间隔配置为固定时间；或者，根据本次校准的频率偏差，动态配置本次校准和下次校准的时间间隔，若本次校准的频率偏差大于设定阈值，则缩短本次校准和下次校准的时间间隔，若本次校准的频率偏差小于设定阈值，则增加本次校准和下次校准的时间间隔或者保持时间间隔不变；或者，根据本次校准的频率偏差，将本次校准和下次校准的时间间隔配置为频率偏差所在档位对应的时间间隔。5.根据权利要求1或2所述的RC振荡时钟的校准电路，其特征在于，所述校准模块，还用于当所述RC振荡时钟的频率偏差超出所述细调电容阵列的可调范围时，根据所述RC振荡时钟的频率偏差计算得到粗调整值；所述RC振荡器，还用于根据所述粗调整值去调整所述粗调电容阵列的比特位，使得在粗调之后，所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内。6.一种RC振荡时钟的校准方法，其特征在于，基于如权利要求1所述的RC振荡时钟的校准电路来实现，所述校准方法包括：在开始校准时使能参考时钟模块，使得所述参考时钟模块输出参考时钟；第一计数模块接收RC振荡时钟和所述参考时钟，以多个所述RC振荡时钟的周期作为第一时间窗口对所述参考时钟的周期进行计数，得到所述参考时钟的实际计数值；第一比较模块比较所述参考时钟的实际计数值和所述参考时钟在所述第一时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；当所述RC振荡时钟的频率偏差在细调电容阵列的可调范围内时，校准模块根据所述RC振荡时钟的频率偏差计算得到细调整值；RC振荡器根据所述细调整值去调整内置的细调电容阵列的比特位，以调整所述RC振荡时钟的频率；校准完成后关闭参考时钟模块。7.一种RC振荡时钟的校准方法，其特征在于，基于如权利要求2所述的RC振荡时钟的校准电路来实现，所述校准方法包括：在开始校准时使能参考时钟模块，使得所述参考时钟模块输出参考时钟；第二计数模块接收RC振荡时钟和所述参考时钟，以多个所述参考时钟的周期作为第二时间窗口对所述RC振荡时钟的周期进行计数，得到所述RC振荡时钟的实际计数值；第二比较模块比较所述RC振荡时钟的实际计数值和所述RC振荡时钟在所述第二时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；当所述RC振荡时钟的频率偏差在细调电容阵列的可调范围内时，校准模块根据所述RC振荡时钟的频率偏差计算得到细调整值；RC振荡器根据所述细调整值去调整所述细调电容阵列的比特位，以调整所述RC振荡时钟的频率；校准完成后关闭参考时钟模块。8.根据权利要求6或7所述的RC振荡时钟的校准方法，其特征在于，所述RC振荡时钟为32.768KHz的睡眠时钟。9.根据权利要求6或7所述的RC振荡时钟的校准方法，其特征在于，任意两次校准的时间间隔配置为固定时间；或者，本次校准和下次校准的时间间隔根据本次校准的频率偏差动态配置，若本次校准的频率偏差大于设定阈值，则缩短本次校准和下次校准的时间间隔，若本次校准的频率偏差小于设定阈值，则增加本次校准和下次校准的时间间隔或者保持时间间隔不变；或者，根据本次校准的频率偏差，将本次校准和下次校准的时间间隔配置为频率偏差所在档位对应的时间间隔。10.根据权利要求6或7所述的RC振荡时钟的校准方法，其特征在于，所述校准方法还包括：当所述RC振荡时钟的频率偏差超出细调电容阵列的可调范围时，所述校准模块根据所述RC振荡时钟的频率偏差计算得到粗调整值；所述RC振荡器根据所述粗调整值去调整内置的粗调电容阵列的比特位，使得在粗调之后，所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内。11.一种芯片，其特征在于，所述芯片包括如权利要求1至5任一项所述的RC振荡时钟的校准电路。12.一种电子设备，其特征在于，所述电子设备包括如权利要求11所述的芯片。
说明书desc
技术领域本发明涉及集成电路技术领域，尤其涉及一种RC振荡时钟的校准电路、校准方法、芯片和电子设备。背景技术移动通信终端一般都具有两个时钟，系统时钟和睡眠时钟，系统时钟主要在正常模式下为整个系统提供时钟源，保证移动通信终端在正常工作模式下可以正常工作。睡眠时钟一般有两个作用，在系统进入睡眠模式为移动通信终端提供周期性的唤醒，以便接收基站的寻呼，以及在整个系统都进入超低功耗模式或者关机模式为系统提供钟表日期时间，计时显示开机前运行时钟等等。在现有技术中，睡眠时钟可以由RC振荡器来提供，但由于RC振荡器自身特性，常温下其频偏大概都有±200ppm的偏差，加上芯片差异、电压、温度等因素的影响，往往在关机一段时间后会产生很大的频率偏差，因此需要定时校准RC振荡器。如何对RC振荡时钟做到高精度的校准，对于各家设计者来说都是非常大的挑战。发明内容有鉴于此，本发明提供了一种RC振荡时钟的校准电路、校准方法、芯片和电子设备，能够对RC振荡时钟进行高精度的校准，且可以最大限度的节省功耗。第一方面，本发明提供一种RC振荡时钟的校准电路，包括：RC振荡器，用于输出RC振荡时钟，且所述RC振荡器内设置有细调电容阵列和粗调电容阵列，分别用于对所述RC振荡器的电容值进行细调和粗调；参考时钟模块，用于输出参考时钟；第一计数模块，用于接收所述RC振荡时钟和所述参考时钟，以多个所述RC振荡时钟的周期作为第一时间窗口对所述参考时钟的周期进行计数，得到所述参考时钟的实际计数值；第一比较模块，用于比较所述参考时钟的实际计数值和所述参考时钟在所述第一时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；校准模块，用于当所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内时，根据所述RC振荡时钟的频率偏差计算得到细调整值；所述RC振荡器，还用于根据所述细调整值去调整所述细调电容阵列的比特位，以调整所述RC振荡时钟的频率。第二方面，本发明提供一种RC振荡时钟的校准电路，包括：RC振荡器，用于输出RC振荡时钟，且所述RC振荡器内设置有细调电容阵列和粗调电容阵列，分别用于对所述RC振荡器的电容值进行细调和粗调；参考时钟模块，用于输出参考时钟；第二计数模块，用于接收所述RC振荡时钟和所述参考时钟，以多个所述参考时钟的周期作为第二时间窗口对所述RC振荡时钟的周期进行计数，得到所述RC振荡时钟的实际计数值；第二比较模块，用于比较所述RC振荡时钟的实际计数值和所述RC振荡时钟在所述第二时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；校准模块，用于当所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内时，根据所述RC振荡时钟的频率偏差计算得到细调整值；所述RC振荡器，还用于根据所述细调整值去调整所述细调电容阵列的比特位，以调整所述RC振荡时钟的频率。可选地，所述RC振荡时钟为32.768KHz的睡眠时钟。可选地，所述校准电路还包括：校准时间间隔配置模块，用于配置两次校准的时间间隔，具体包括：将任意两次校准的时间间隔配置为固定时间；或者，根据本次校准的频率偏差，动态配置本次校准和下次校准的时间间隔，若本次校准的频率偏差大于设定阈值，则缩短本次校准和下次校准的时间间隔，若本次校准的频率偏差小于设定阈值，则增加本次校准和下次校准的时间间隔或者保持时间间隔不变；或者，根据本次校准的频率偏差，将本次校准和下次校准的时间间隔配置为频率偏差所在档位对应的时间间隔。可选地，所述校准模块，还用于当所述RC振荡时钟的频率偏差超出所述细调电容阵列的可调范围时，根据所述RC振荡时钟的频率偏差计算得到粗调整值；所述RC振荡器，还用于根据所述粗调整值去调整所述粗调电容阵列的比特位，使得在粗调之后，所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内。第三方面，本发明提供一种RC振荡时钟的校准方法，包括：在开始校准时使能参考时钟模块，使得所述参考时钟模块输出参考时钟；第一计数模块接收RC振荡时钟和所述参考时钟，以多个所述RC振荡时钟的周期作为第一时间窗口对所述参考时钟的周期进行计数，得到所述参考时钟的实际计数值；第一比较模块比较所述参考时钟的实际计数值和所述参考时钟在所述第一时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；当所述RC振荡时钟的频率偏差在细调电容阵列的可调范围内时，校准模块根据所述RC振荡时钟的频率偏差计算得到细调整值；RC振荡器根据所述细调整值去调整内置的细调电容阵列的比特位，以调整所述RC振荡时钟的频率；校准完成后关闭参考时钟模块。第四方面，本发明提供一种RC振荡时钟的校准方法，包括：在开始校准时使能参考时钟模块，使得所述参考时钟模块输出参考时钟；第二计数模块接收RC振荡时钟和所述参考时钟，以多个所述参考时钟的周期作为第二时间窗口对所述RC振荡时钟的周期进行计数，得到所述RC振荡时钟的实际计数值；第二比较模块比较所述RC振荡时钟的实际计数值和所述RC振荡时钟在所述第二时间窗口的基准计数值，得到所述RC振荡时钟的频率偏差；当所述RC振荡时钟的频率偏差在细调电容阵列的可调范围内时，校准模块根据所述RC振荡时钟的频率偏差计算得到细调整值；RC振荡器根据所述细调整值去调整所述细调电容阵列的比特位，以调整所述RC振荡时钟的频率；校准完成后关闭参考时钟模块。可选地，所述RC振荡时钟为32.768KHz的睡眠时钟。可选地，任意两次校准的时间间隔配置为固定时间；或者，本次校准和下次校准的时间间隔根据本次校准的频率偏差动态配置，若本次校准的频率偏差大于设定阈值，则缩短本次校准和下次校准的时间间隔，若本次校准的频率偏差小于设定阈值，则增加本次校准和下次校准的时间间隔或者保持时间间隔不变；或者，根据本次校准的频率偏差，将本次校准和下次校准的时间间隔配置为频率偏差所在档位对应的时间间隔。可选地，所述校准方法还包括：当所述RC振荡时钟的频率偏差超出细调电容阵列的可调范围时，所述校准模块根据所述RC振荡时钟的频率偏差计算得到粗调整值；所述RC振荡器根据所述粗调整值去调整内置的粗调电容阵列的比特位，使得在粗调之后，所述RC振荡时钟的频率偏差在所述细调电容阵列的可调范围内。第五方面，本发明提供一种芯片，所述芯片包括上述RC振荡时钟的校准电路。第六方面，本发明提供一种电子设备，所述电子设备包括上述芯片。本发明提供的RC振荡时钟的校准电路、校准方法、芯片和电子设备，根据RC振荡时钟的频率偏差直接调整RC振荡器内置的电容阵列，实现RC振荡时钟的校准，从源头解决RC振荡时钟的精度问题，提高了RC振荡时钟输出精度，保证在超低功耗或者长期关机下再次开机都能精准显示时间。且在校准时使能参考时钟，校准完成后关闭参考时钟，可以最大限度的节省功耗。附图说明图1为本发明一实施例的RC振荡时钟的校准电路的结构示意图；图2为本发明一实施例的RC振荡时钟的校准电路的结构示意图；图3为本发明一实施例的RC振荡器的内部电路示意图；图4为本发明一实施例的RC振荡时钟的校准方法的流程示意图；图5为本发明一实施例的RC振荡时钟的校准方法的流程示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明的是，本申请的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本申请的实施例。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。此外，术语“安装”、“设置”、“设有”、“连接”、“相连”、“套接”应做广义理解。例如，可以是固定连接，可拆卸连接，或整体式构造；可以是机械连接，或电连接；可以是直接相连，或者是通过中间媒介间接相连，又或者是两个装置、元件或组成部分之间内部的连通。对于本领域普通技术人员而言，可以根据具体情况理解上述术语在本申请中的具体含义。下面结合附图，对本发明的一些实施方式作详细说明。在不冲突的情况下，下述的实施例及实施例中的特征可以相互组合。本发明一个实施例提供一种RC振荡时钟的校准电路，如图1所示，该校准电路包括：RC振荡器101，用于输出RC振荡时钟RCCLK，且RC振荡器101内设置有一个细调电容阵列和一个粗调电容阵列，分别用于对RC振荡器101的电容值进行细调和粗调；参考时钟模块102，用于输出参考时钟REFCLK；第一计数模块103，用于接收RC振荡时钟RCCLK和参考时钟REFCLK，以多个RC振荡时钟RCCLK的周期作为第一时间窗口对参考时钟REFCLK的周期进行计数，得到参考时钟的实际计数值REAL_NUM1；第一比较模块104，用于比较参考时钟的实际计数值REAL_NUM1和参考时钟的基准计数值REF_NUM1，得到RC振荡时钟的频率偏差FE1；校准模块105，用于当RC振荡时钟的频率偏差FE1在细调电容阵列的可调范围内时，根据RC振荡时钟的频率偏差FE1计算得到细调整值；RC振荡器101，还用于根据细调整值去调整细调电容阵列的比特位，以调整RC振荡时钟RCCLK的频率。进一步地，参考图1，该校准电路包括：参考时钟控制模块106，用于在开始校准时使能参考时钟模块102，使得参考时钟模块102输出参考时钟；以及，校准完成后关闭参考时钟模块102。本发明实施例是以反推法来实现RC振荡时钟的校准。通过参考时钟的基准计数值和实际计数值相比较，得到RC振荡时钟的频率偏差，然后折算到细调电容阵列需要调整的比特位。在一个实施例中，RC振荡器101输出32.768KHz的RC振荡时钟，该RC振荡时钟可以作为睡眠时钟，记为RC_32K，参考时钟可以选择26MHz的系统时钟，但不限于此，也可以是19.2MHz或者38.3MHz或者52MHz等等。用几个RC_32K的周期作为时间窗口，即时间窗口为*N，N为自然数，对26MHz时钟的周期进行计数，使得获取26MHz周期计数的最小偏差小于某一个值，比如60ppm。考虑到采样偏差及计时精度，可以拟定最小偏差为±15ppm。经过计算，*84作为时间窗口，在该时间窗口内，26MHz周期计数的基准计数值为66667，最小偏差可以做到±15ppm。需要说明的是，这里的84和66667，可根据实际情况来调整，可往大的取也可往小的取。本实施例中，26MHz周期的实际计数值和基准计数值相差1，对应32KHz时钟有15ppm的频率偏差。26MHz周期的实际计数值和基准计数值相差2，对应32KHz时钟有30ppm的频率偏差。以此类推。具体地，首先作以下设定：细调电容阵列的单位比特所对应的频率偏差记为FreFT ppm/bit，即细调电容阵列调节1bit，产生FreFT ppm的频率偏差。参考时钟周期计数的单位计数偏差所对应的频率偏差记为FreREF ppm/step，即参考时钟的实际计数值和基准计数值相差1，产生FreREF ppm的频率偏差，1个step就是一个计数偏差。基于上述设定，RC振荡时钟的频率偏差的表达式为：FE1＝∣REAL_NUM1-REF_NUM1∣*FreREF，其中，FE1表示RC振荡时钟的频率偏差，REAL_NUM1表示参考时钟周期的实际计数值，REF_NUM1表示参考时钟周期的基准计数值，FreREF表示参考时钟周期的单位计数偏差所对应的RC振荡时钟的频率偏差。进一步地，校准模块105计算细调整值的方法如下：当实际计数值REAL_NUM1＞基准计数值REF_NUM1，说明RC振荡时钟频率偏小，周期变大，那么细调电容阵列就往上调/A个bit，减小电容值，从而增加RC振荡频率；当实际计数值REAL_NUM1＜基准计数值REF_NUM1，说明RC振荡时钟频率偏大，周期变小，那么细调电容阵列就往下调/A个bit，增大电容值，从而减小RC振荡频率。在上式中，这里的A＝FreFT/FreREF，且A需要取整，采取四舍五入法。设定：B＝/A，这里的B需要向下取整，B＜1，则取0，1≤B＜2，则取1。同理，C＝/A，这里的C需要向下取整，C＜1，则取0，1≤C＜2，则取1。举一个具体的示例进行说明，如果设定细调电容阵列调节1bit，产生60ppm的频率偏差。而26MHz周期计数的计数偏差为1，只产生15ppm的频率偏差，那么不需要调整细调电容阵列。只有26MHz周期计数的计数偏差对应的频率偏差大于60ppm，才需要调整细调电容阵列。通过调整细调电容阵列，得到准确的RC_32K后，然后再通过固定分频系数得到准确的计时模块的clock，完成日历更新和时间同步更新。另一方面，本发明一个实施例提供一种RC振荡时钟的校准电路，如图2所示，该校准电路包括：RC振荡器201，用于输出RC振荡时钟RCCLK，且RC振荡器201内设置有一个细调电容阵列和粗调电容阵列，分别用于对RC振荡器的电容值进行细调和粗调；参考时钟模块202，用于输出参考时钟REFCLK；第二计数模块203，用于接收RC振荡时钟RCCLK和参考时钟REFCLK，以多个参考时钟REFCLK的周期作为第二时间窗口对RC振荡时钟RCCLK的周期进行计数，得到RC振荡时钟的实际计数值REAL_NUM2；第二比较模块204，用于比较RC振荡时钟的实际计数值REAL_NUM2和RC振荡时钟在第二时间窗口的基准计数值REF_NUM2，得到RC振荡时钟的频率偏差FE2；校准模块205，用于当RC振荡时钟的频率偏差FE2在细调电容阵列的可调范围内时，根据RC振荡时钟的频率偏差FE2计算得到细调整值；RC振荡器201，还用于根据细调整值去调整细调电容阵列的比特位，以调整RC振荡时钟RCCLK的频率。进一步地，参考图2，该校准电路包括：参考时钟控制模块206，用于在开始校准时使能参考时钟模块202，使得参考时钟模块202输出参考时钟；以及，校准完成后关闭参考时钟模块202。本发明实施例是用几个参考时钟的周期作为时间窗口，直接对RC振荡时钟进行计数，进而实现RC振荡时钟的校准。通过RC振荡时钟的基准计数值和实际计数值相比较，得到RC振荡时钟的频率偏差，然后折算到细调电容阵列需要调整的比特位。在一个实施例中，RC振荡器201输出32.768KHz的RC振荡时钟，该RC振荡时钟可以作为睡眠时钟，记为RC_32K，参考时钟可以选择26MHz的系统时钟，但不限于此，也可以是19.2MHz或者38.3MHz或者52MHz等等。如果以26MHz的系统时钟作为参考时钟，时间窗口为*N，N为自然数。参考前述实施例，作以下设定：细调电容阵列的单位比特所对应的频率偏差记为FreFT ppm/bit，即细调电容阵列调节1bit，产生FreFT ppm的频率偏差。RC振荡时钟周期计数的单位计数偏差所对应的频率偏差记为FreRC ppm/step，即RC振荡时钟的实际计数值和基准计数值相差1，产生FreRC ppm的频率偏差，1个step就是一个计数偏差。基于上述设定，RC振荡时钟的频率偏差的表达式为：FE2＝∣REAL_NUM2-REF_NUM2∣*FreRC，其中，FE2表示RC振荡时钟的频率偏差，REAL_NUM2表示RC振荡时钟周期的实际计数值，REF_NUM2表示RC振荡时钟周期的基准计数值，FreRC表示RC振荡时钟周期的单位计数偏差所对应的RC振荡时钟的频率偏差。进一步地，校准模块205计算细调整值的方法如下：当RC振荡时钟RC_32K的实际计数值REAL_NUM2＞基准计数值REF_NUM2，说明RC振荡时钟频率偏大，周期变小，那么细调电容阵列就往下调/A个bit，增大电容值，从而减小RC振荡频率。当RC振荡时钟RC_32K的实际计数值REAL_NUM2＜基准计数值REF_NUM2，说明RC振荡时钟频率偏小，周期变大，那么细调电容阵列就往上调/A个bit，减小电容值，从而增加RC振荡频率。在上式中，这里的A＝FreFT/FreRC，且A需要取整，采取四舍五入法。设定：B＝/A，这里的B需要向下取整，B＜1，则取0，1≤B＜2，则取1。同理，C＝/A，这里的C需要向下取整，C＜1，则取0，1≤C＜2，则取1。另外说明的是，在上述的实施例中，对于细调电容阵列和粗调电容阵列的结构不做具体限定，能够理解的是，可以采用数字电容阵列的形式来实现。图3示出了一种RC振荡器的内部结构示意图，其中细调电容阵列和粗调电容阵列的基本调节原理在于：通过控制电容阵列中开关管的通断，从而调节电容阵列的容值。粗调电容阵列的精度和细调电容阵列的精度可以按照一定的比率设计，保证细调可以覆盖一定的粗调范围。进一步地，在一个实施例中，RC振荡时钟的校准电路还包括：校准时间间隔配置模块，用于配置两次校准的时间间隔，具体包括：将任意两次校准的时间间隔配置为固定时间；或者，根据本次校准的频率偏差，动态配置本次校准和下次校准的时间间隔，若本次校准的频率偏差大于设定阈值，则缩短本次校准和下次校准的时间间隔，若本次校准的频率偏差小于设定阈值，则增加本次校准和下次校准的时间间隔或者保持时间间隔不变；或者，根据本次校准的频率偏差，将本次校准和下次校准的时间间隔配置为频率偏差所在档位对应的时间间隔。具体地，本发明实施例提供三种方式配置校准时间间隔。方式1、配置两次校准的时间间隔为固定时间T，然后根据设定的固定时间T，定时对RC振荡时钟的频率进行校准。方式2、根据本次校准的RC振荡时钟的频率偏差来动态配置两次校准的时间间隔。先设定一个固定的时间间隔T，上一次校准完毕后，等待时间间隔T，在本次校准前，先计算RC_32K的频率偏差，如果频率偏差大于阈值TH，那么就缩短本次校准和下次校准的时间间隔T，调整为T*。如果频率偏差小于阈值TH，那么就保持这个时间间隔T或者调整为T*。其中m、n都可以配置。方式3，将频率偏差分成多个档位，每个档位分别对应不同的时间间隔。根据本次校准计算的频率偏差，将本次校准和下次校准的时间间隔配置为频率偏差所在档位对应的时间间隔。进一步地，在一个实施例中，校准模块105/205，用于当RC振荡时钟的频率偏差超出细调电容阵列的可调范围时，根据RC振荡时钟的频率偏差计算得到粗调整值；此时RC振荡器还用于根据粗调整值去调整粗调电容阵列的比特位，使得在粗调之后，RC振荡时钟的频率偏差在细调电容阵列的可调范围内。校准模块105/205计算粗调整值，需要软件参与。默认情况下粗调电容阵列的调节会在ATE阶段校准写入，所以通常只需要调节细调电容阵列就可以实现RC振荡时钟的校准，然后通过固定分频系数来得到准确的计时模块的Clock。但是，当实际计数值大于或小于基准计数值在X个counter以上，也就是说，当RC_32K的频率偏差超出了细调电容阵列的可调范围后，那么这时需要起中断唤醒系统，交由软件参与。首次开机获取粗调电容阵列的配置值后，存入粗调电容阵列的寄存器中，软件接收到中断并告知软件目前RC_32K的偏差方向和偏差大小；软件收到偏差方向和偏差大小后，修改存入粗调电容阵列的寄存器值，然后在接着进入SD或者UPS模式；进入SD或者UPS模式后，重新计算RC_32K的频率偏差并调节细调电容阵列，进而获得相对准确的RC_32K。本发明实施例提供的一种RC振荡时钟的校准电路，根据预设条件定期或动态配置一定时间间隔，起来校准RC振荡时钟的频率，并根据RC振荡时钟的频率偏差来调整两个电容阵列，一个粗调电容阵列，一个细调电容阵列，使得在节省功耗的同时，提高RC振荡时钟输出精度，保证在超低功耗或者长期关机下再次开机都能精准显示时间。具体可以带来以下效果：1、在RC振荡器内设置粗调和细调的两个电容阵列，通过直接调整RC振荡器内置的电容阵列，实现RC振荡时钟的校准，从源头解决RC振荡时钟的精度问题。2、以RC振荡时钟的几个周期作为时间窗口，来数参考时钟的周期，可以提高校准的精度。3、融入温漂带来的频率偏差，动态配置前后两次校准的时间间隔，最大程度的优化校准频度，在既满足校准精度的同时可以最大限度的节省功耗。4、全程由硬件实现校准，只在调节粗调电容阵列时才需要软件参与，减少软件参与度。5、在校准时使能参考时钟，校准完成后关闭参考时钟，可以最大限度的节省功耗。另一方面，基于上述图1实施例的RC振荡时钟的校准电路，本发明实施例提供一种RC振荡时钟的校准方法，如图4所示，所述校准方法包括：步骤401，在开始校准时使能参考时钟模块，使得参考时钟模块输出参考时钟；步骤402，第一计数模块接收RC振荡时钟和参考时钟，以多个RC振荡时钟的周期作为第一时间窗口对参考时钟的周期进行计数，得到参考时钟的实际计数值；步骤403，第一比较模块比较参考时钟的实际计数值和参考时钟在第一时间窗口的基准计数值，得到RC振荡时钟的频率偏差；步骤404，当RC振荡时钟的频率偏差在细调电容阵列的可调范围内时，校准模块根据RC振荡时钟的频率偏差计算得到细调整值；步骤405，RC振荡器根据细调整值去调整内置的细调电容阵列的比特位，以调整RC振荡时钟的频率；步骤406，校准完成后关闭参考时钟模块。另一方面，基于上述图2实施例的RC振荡时钟的校准电路，本发明实施例提供一种RC振荡时钟的校准方法，如图5所示，所述校准方法包括：步骤501，在开始校准时使能参考时钟模块，使得参考时钟模块输出参考时钟；步骤502，第二计数模块接收RC振荡时钟和参考时钟，以多个参考时钟的周期作为第二时间窗口对RC振荡时钟的周期进行计数，得到RC振荡时钟的实际计数值；步骤503，第二比较模块比较RC振荡时钟的实际计数值和RC振荡时钟在第二时间窗口的基准计数值，得到RC振荡时钟的频率偏差；步骤504，当RC振荡时钟的频率偏差在细调电容阵列的可调范围内时，校准模块根据RC振荡时钟的频率偏差计算得到细调整值；步骤505，RC振荡器根据细调整值去调整细调电容阵列的比特位，以调整RC振荡时钟的频率；步骤506，校准完成后关闭参考时钟模块。在上述的实施例中，RC振荡时钟可以为32.768KHz的睡眠时钟，参考时钟可以为26MHz的系统时钟。在一个实施例中，配置校准时间间隔有三种方式.方式1：任意两次校准的时间间隔配置为固定时间；方式2：本次校准和下次校准的时间间隔根据本次校准的频率偏差动态配置，若本次校准的频率偏差大于设定阈值，则缩短本次校准和下次校准的时间间隔，若本次校准的频率偏差小于设定阈值，则增加本次校准和下次校准的时间间隔或者保持时间间隔不变。方式3：根据本次校准的频率偏差，将本次校准和下次校准的时间间隔配置为频率偏差所在档位对应的时间间隔。在一个实施例中，当RC振荡时钟的频率偏差超出细调电容阵列的可调范围时，校准模块根据RC振荡时钟的频率偏差计算得到粗调整值。然后RC振荡器根据粗调整值去调整内置的粗调电容阵列的比特位，使得在粗调之后，RC振荡时钟的频率偏差在细调电容阵列的可调范围内。然后重新计算RC振荡时钟的频率偏差，去调整细调电容阵列，进而获得相对准确的时钟。本发明实施例提供的一种RC振荡时钟的校准方法，是基于上述实施例的RC振荡时钟的校准电路来实现的，因此能够产生同样的技术效果，技术细节可参考上述校准电路实施例的描述，在此不再赘述。另一方面，本发明一个实施例提供一种芯片，该芯片包括上述实施例的RC振荡时钟的校准电路。另一方面，本发明一个实施例提供一种电子设备，该电子设备包括上述芯片。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应该以权利要求的保护范围为准。
