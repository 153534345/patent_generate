标题title
SMF选择UPF的方法及装置
摘要abst
本申请公开一种SMF选择UPF的方法及装置，其中方法包括：SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息；SMF根据获取到的各UPF与IMS列表中的各IMS之间的时延信息实时维护IMS时延列表，IMS时延列表包括各IMS对应的低时延UPF列表；SMF选择一个IMS来提供服务资源；SMF从IMS时延列表中找到被选IMS的低时延UPF列表；从被选IMS的低时延UPF列表中选取UPF来建立UE上下文。本申请可以解决基于选择的UPF建立的会话网络时延大的问题，提升业务使用体验。
权利要求书clms
1.一种SMF选择UPF的方法，其特征在于，包括：SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息；SMF根据获取到的各UPF与所述IMS列表中的各IMS之间的时延信息实时维护IMS时延列表，所述IMS时延列表包括各IMS对应的低时延UPF列表；SMF选择一个IMS来提供服务资源；SMF从所述IMS时延列表中找到被选IMS的低时延UPF列表；从所述被选IMS的低时延UPF列表中选取UPF来建立UE上下文。2.根据权利要求1所述的SMF选择UPF的方法，其特征在于，所述SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息，包括：SMF向UPF发送时延检测请求，所述检测请求中包括所述IMS列表，所述IMS列表中包括各IMS的地址；UPF根据所述IMS列表向各IMS的地址发起检测请求；各IMS实时响应UPF的所述检测请求；UPF根据所述检测请求的发起和响应分别得到时延参考值。3.根据权利要求2所述的SMF选择UPF的方法，其特征在于，UPF向各IMS的地址发起至少两次所述检测请求；各IMS实时响应UPF的每一次所述检测请求；UPF根据各次所述检测请求的发起和响应分别得到时延参考值，并根据各所述时延参考值得到平均时延参考值作为所述时延信息返回给SMF。4.根据权利要求2或3所述的SMF选择UPF的方法，其特征在于，所述UPF根据所述IMS列表向各IMS的地址发起检测请求，包括：UPF根据所述IMS列表向各IMS的地址发起检测请求并记录发送时间戳；所述UPF根据所述检测请求的发起和响应分别得到时延参考值，包括：UPF接收到IMS的响应消息时记录响应时间戳；UPF根据所述发送时间戳和对应的所述响应时间戳计算得到所述时延参考值。5.根据权利要求1所述的SMF选择UPF的方法，其特征在于，从所述被选IMS的低时延UPF列表中选取UPF来建立UE上下文，包括：根据所述被选IMS的低时延UPF列表中各UPF的负载情况选取UPF来建立UE上下文。6.根据权利要求1所述的SMF选择UPF的方法，其特征在于，还包括：当SMF获取已建立UE上下文的UPF出现网络时延抖动时，从所述低时延UPF列表选取另一UPF替代来建立UE上下文。7.一种SMF选择UPF的装置，其特征在于，包括：获取模块，用于SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息；维护模块，用于SMF根据获取到的各UPF与所述IMS列表中的各IMS之间的时延信息实时维护IMS时延列表，所述IMS时延列表包括各IMS对应的低时延UPF列表；选择模块，用于SMF选择一个IMS来提供服务资源；查找模块，用于SMF从所述IMS时延列表中找到被选IMS的低时延UPF列表；选取模块，用于从所述被选IMS的低时延UPF列表中选取UPF来建立UE上下文。8.根据权利要求7所述的SMF选择UPF的装置，其特征在于，从所述被选IMS的低时延UPF列表中选取来建立UE上下文，包括：从所述被选IMS的低时延UPF列表中选取情况最佳的UPF来建立UE上下文。9.一种设备，其特征在于，包括：处理器；存储器，其中存储有所述处理器的可执行指令；其中，所述处理器配置为经由执行所述可执行指令来执行如权利要求1至6任一项所述的SMF选择UPF的方法。10.一种计算机可读存储介质，其上存储有程序，其特征在于，所述程序被处理器执行时实现如权利要求1至6任一项所述的SMF选择UPF的方法。
说明书desc
技术领域本申请涉及5GS技术领域，具体涉及一种SMF选择UPF的方法及装置。背景技术随着通信技术的不断发展，当今时代对于移动通信网络提出了更高的体验要求，尤其是对于通信质量方面的要求，而影响通信质量的关键之一就是网络时延。降低网络时延有助于增强通信的实时性，提高用户的使用体验。用户的使用体验主要来源于UPF与服务端的数据传输时延，时延大的时候表现为服务卡顿，用户使用体验会变差，时延小的时候表现为服务流畅，用户使用体验良好。然而，如今SMF选择UPF的方法中，并不包含时延特征。现有技术中，SMF选择UPF的时候，一般是通过对UPF的动态负载及UPF本身的能力来选择UPF。基于上述UPF选择方式，可能会出现用户建立会话后发现网络时延较大，导致业务使用体验较差问题。因此，本申请引入时延特征辅助SMF选择UPF。发明内容本申请的目的在于提供一种SMF选择UPF的方法、装置、设备以及计算机可读存储介质，可以解决基于选择的UPF建立的会话网络时延大的问题，提升业务使用体验。为实现上述目的，本申请提供了一种SMF选择UPF的方法，包括：SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息；SMF根据获取到的各UPF与所述IMS列表中的各IMS之间的时延信息实时维护IMS时延列表，所述IMS时延列表包括各IMS对应的低时延UPF列表；SMF选择一个IMS来提供服务资源；SMF从所述IMS时延列表中找到被选IMS的低时延UPF列表；从所述被选IMS的低时延UPF列表中选取UPF来建立UE上下文。可选地，所述SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息，包括：SMF向UPF发送时延检测请求，所述检测请求中包括所述IMS列表，所述IMS列表中包括各IMS的地址；UPF根据所述IMS列表向各IMS的地址发起检测请求；各IMS实时响应UPF的所述检测请求；UPF根据所述检测请求的发起和响应分别得到时延参考值。可选地，UPF向各IMS的地址发起至少两次所述检测请求；各IMS实时响应UPF的每一次所述检测请求；UPF根据各次所述检测请求的发起和响应分别得到时延参考值，并根据各所述时延参考值得到平均时延参考值作为所述时延信息返回给SMF。可选地，所述UPF根据所述IMS列表向各IMS的地址发起检测请求，包括：UPF根据所述IMS列表向各IMS的地址发起检测请求并记录发送时间戳；所述UPF根据所述检测请求的发起和响应分别得到时延参考值，包括：UPF接收到IMS的响应消息时记录响应时间戳；UPF根据所述发送时间戳和对应的所述响应时间戳计算得到所述时延参考值。可选地，从所述被选IMS的低时延UPF列表中选取来建立UE上下文，包括：根据所述被选IMS的低时延UPF列表中各UPF的负载情况选取UPF来建立UE上下文。可选地，所述方法还包括：当SMF获取已建立UE上下文的UPF出现网络时延抖动时，从所述低时延UPF列表选取另一UPF替代来建立UE上下文。为实现上述目的，本申请还提供了一种SMF选择UPF的装置，包括：获取模块，用于SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息；维护模块，用于SMF根据获取到的各UPF与所述IMS列表中的各IMS之间的时延信息实时维护IMS时延列表，所述IMS时延列表包括各IMS对应的低时延UPF列表；选择模块，用于SMF选择一个IMS来提供服务资源；查找模块，用于SMF从所述IMS时延列表中找到被选IMS的低时延UPF列表；选取模块，用于从所述被选IMS的低时延UPF列表中选取UPF来建立UE上下文。可选地，从所述被选IMS的低时延UPF列表中选取UPF来建立UE上下文，包括：从所述被选IMS的低时延UPF列表中选取情况最佳的UPF来建立UE上下文。为实现上述目的，本申请还提供了一种设备，包括：处理器；存储器，其中存储有所述处理器的可执行指令；其中，所述处理器配置为经由执行所述可执行指令来执行如上所述的SMF选择UPF的方法。为实现上述目的，本申请还提供了一种计算机可读存储介质，其上存储有程序，所述程序被处理器执行时实现如上所述的SMF选择UPF的方法。本申请还提供了一种计算机程序产品或计算机程序，该计算机程序产品或计算机程序包括计算机指令，该计算机指令存储在计算机可读存储介质中。电子设备的处理器从计算机可读存储介质读取该计算机指令，处理器执行该计算机指令，使得该电子设备执行如上所述的SMF选择UPF的方法。本申请中，SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息，并根据获取到的时延信息实时维护各IMS对应的低时延UPF列表，在SMF选择一个IMS来提供服务资源后，SMF找到被选IMS的低时延UPF列表并从中选取合适的UPF来建立UE上下文。本申请SMF可以提前获取UPF与IMS之间的互通性和时延信息，将UPF和IMS关联起来，在SMF为UE选择IMS的同时，同步选择一个与该IMS之间具有良好时延特征指标的UPF来建立UE上下文，进而可以解决基于选择的UPF建立的会话网络时延大的问题，提升业务使用体验。附图说明图1是本申请实施例SMF选择UPF的方法的流程图。图2是本申请实施例SMF获取各UPF与IMS列表中的各IMS之间的时延信息的流程图。图3是本申请实施例SMF获取各UPF与IMS列表中的各IMS之间的时延信息的一示例流程图。图4是本申请实施例SMF选择UPF的装置的示意框图。图5是本申请实施例设备的示意框图。具体实施方式为了详细说明本申请的技术内容、构造特征、所实现目的及效果，以下结合实施方式并配合附图详予说明。为便于理解本申请，在此将本申请出现的相关术语解释如下：UE：User Equipment用户设备SMF：Session Management Function会话管理功能UPF：User Plane Function用户平面功能IMS：IP Multimedia Subsystem IP多媒体子系统VoLTE：Voice over Long-Term Evolution长期演进语音承载实施例一请参阅图1至图3，本申请公开了一种SMF选择UPF的方法，包括：S1、SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息。请参阅图2，在一些实施方式中，SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息，包括：S11、SMF向UPF发送时延检测请求，检测请求中包括IMS列表，IMS列表中包括各IMS的地址。S12、UPF根据IMS列表向各IMS的地址发起检测请求。UPF在接收到IMS列表后会读取到其中的各个IMS的地址以向各个IMS的地址发起检测请求。S13、各IMS实时响应UPF的检测请求。S14、UPF根据检测请求的发起和响应分别得到时延参考值。每经过预设的时间周期后重复上述流程，获取最新的时延信息以作更新之用。具体地，可以直接将该时延参考值作为时延信息返回给SMF。当然并不局限于此。比如，为了更准确的获取时延信息，还可以是：UPF向各IMS的地址发起至少两次检测请求；各IMS实时响应UPF的每一次检测请求；UPF根据各次检测请求的发起和响应分别得到时延参考值，并根据各时延参考值得到平均时延参考值作为时延信息返回给SMF。请参阅图3，具体地，步骤S12：UPF根据IMS列表向各IMS的地址发起检测请求，包括：S121、UPF根据IMS列表向各IMS的地址发起检测请求并记录发送时间戳；步骤S14：UPF根据检测请求的发起和响应分别得到时延参考值，包括：S141、UPF接收到IMS的响应消息时记录响应时间戳；S142、UPF根据发送时间戳和对应的响应时间戳计算得到时延参考值。进一步地，在UPF向各IMS的地址发起至少两次检测请求的情况下，每次发送检测请求时均会记录发送时间，比如第一次发送检测请求的时间可以记录为第一发送时间，第二次发送检测请求的时间可以记录为第二发送时间，以此类推。其中每两次检测请求发送的时间之间可以是间隔预设时长。IMS接收到每次检测请求时均立即发送响应消息，响应消息可以包括序列号，UPF接收到IMS的响应消息后根据响应消息中的序列号将响应时间戳和发送时间戳相匹配，如将第一响应时间与第一发送时间相匹配，将第二响应时间与第二发送时间相匹配，并根据相匹配的响应时间戳和发送时间戳计算得出时延参考值。然后将至少两次的时延参考值取平均得到平均时延参考值并返回给SMF。S2、SMF根据获取到的各UPF与IMS列表中的各IMS之间的时延信息实时维护IMS时延列表，IMS时延列表包括各IMS对应的低时延UPF列表。也就是说，每个IMS均有对应的低时延UPF列表，而且由于是周期性进行检测，各IMS的低时延UPF列表在初次建立后会周期性的更新，存在新的符合时延要求的UPF会被列入，低时延UPF列表已有的UPF出现不符合时延要求的情况下，则将该UPF从低时延UPF列表中移除。S3、SMF选择一个IMS来提供服务资源。在会话建立流程中，SMF会为UE分配VoLTE资源用于高清通话服务，此时会选定一个IMS网元来提供语音等服务资源。S4、SMF从IMS时延列表中找到被选IMS的低时延UPF列表。S5、从被选IMS的低时延UPF列表中选取UPF来建立UE上下文。具体地，从被选IMS的低时延UPF列表中选取UPF来建立UE上下文，包括：根据被选IMS的低时延UPF列表中各UPF的负载情况选取UPF来建立UE上下文。进而本申请SMF选择UPF的方法可以兼顾时延特征指标和UPF的动态负载指标，有利于保证选出的IMS具有良好的网络状态。举例说明，已选择好的IMS已有低时延UPF列表，低时延UPF列表中有UPF1时延10毫秒且负载30000用户，UPF2时延20毫秒且负载10000用户，根据UPF负载均衡，SMF将在UPF2上建立UE上下文。可以理解的是，本申请SMF选择UPF的方法选取UPF来建立UE上下文时，还可以同时考虑其他指标。具体地，SMF选择UPF的方法还包括：当SMF获取已建立UE上下文的UPF出现网络时延抖动时，从低时延UPF列表选取另一UPF替代来建立UE上下文。由于本申请SMF选择UPF的方法会周期性的更新每一IMS对应的各UPF的时延信息，如果已建立UE上下文的UPF出现网络时延抖动时，SMF会立刻得知，进而可以从对应的低时延UPF列表中选择另一UPF替代来建立UE上下文，同时将上述出现网络时延抖动的UPF从对应低时延UPF列表中移除。举例说明，IMS1有低时延UPF列表，低时延UPF列表现有UPF1时延10毫秒且负载10000用户，UPF2时延20毫秒且负载10000用户。此时，UPF1的网络时延出现抖动，当前时延为1000毫秒，SMF收到UPF1的时延检测响应后，会将UPF1从IMS1的低时延UPF列表中移除，为UE选择IMS1时不会再选择在UPF1上建立UE上下文，而是选择UPF2替代UPF1来建立UE上下文。本申请中，SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息，并根据获取到的时延信息实时维护各IMS对应的低时延UPF列表，在SMF选择一个IMS来提供服务资源后，SMF找到被选IMS的低时延UPF列表并从中选取合适的UPF来建立UE上下文。本申请SMF可以提前获取UPF与IMS之间的互通性和时延信息，将UPF和IMS关联起来，在SMF为UE选择IMS的同时，同步选择一个与该IMS之间具有良好时延特征指标的UPF来建立UE上下文，进而可以解决基于选择的UPF建立的会话网络时延大的问题，提升业务使用体验。实施例二请参阅图4，本申请公开了一种SMF选择UPF的装置，包括：获取模块201，用于SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息；维护模块202，用于SMF根据获取到的各UPF与IMS列表中的各IMS之间的时延信息实时维护IMS时延列表，IMS时延列表包括各IMS对应的低时延UPF列表；选择模块203，用于SMF选择一个IMS来提供服务资源；查找模块204，用于SMF从IMS时延列表中找到被选IMS的低时延UPF列表；选取模块205，用于从被选IMS的低时延UPF列表中选取UPF来建立UE上下文。具体地，从被选IMS的低时延UPF列表中选取UPF来建立UE上下文，包括：根据被选IMS的低时延UPF列表中各UPF的负载情况选取UPF来建立UE上下文。进而本申请SMF选择UPF的方法可以兼顾时延特征指标和UPF的动态负载指标，有利于保证选出的IMS具有良好的网络状态。举例说明，已选择好的IMS已有低时延UPF列表，低时延UPF列表中有UPF1时延10毫秒且负载30000用户，UPF2时延20毫秒且负载10000用户，根据UPF负载均衡，SMF将在UPF2上建立UE上下文。可以理解的是，本申请SMF选择UPF的方法选取UPF来建立UE上下文时，还可以同时考虑其他指标。具体地，当SMF获取已建立UE上下文的UPF出现网络时延抖动时，从低时延UPF列表选取另一UPF替代来建立UE上下文。由于本申请SMF选择UPF的方法会周期性的更新每一IMS对应的各UPF的时延信息，如果已建立UE上下文的UPF出现网络时延抖动时，SMF会立刻得知，进而可以从对应的低时延UPF列表中选择另一UPF替代来建立UE上下文，同时将上述出现网络时延抖动的UPF从对应低时延UPF列表中移除。举例说明，IMS1有低时延UPF列表，低时延UPF列表现有UPF1时延10毫秒且负载10000用户，UPF2时延20毫秒且负载10000用户。此时，UPF1的网络时延出现抖动，当前时延为1000毫秒，SMF收到UPF1的时延检测响应后，会将UPF1从IMS1的低时延UPF列表中移除，为UE选择IMS1时不会再选择在UPF1上建立UE上下文，而是选择UPF2替代UPF1来建立UE上下文。本申请中，SMF周期性地获取各UPF与IMS列表中的各IMS之间的时延信息，并根据获取到的时延信息实时维护各IMS对应的低时延UPF列表，在SMF选择一个IMS来提供服务资源后，SMF找到被选IMS的低时延UPF列表并从中选取合适的UPF来建立UE上下文。本申请SMF可以提前获取UPF与IMS之间的互通性和时延信息，将UPF和IMS关联起来，在SMF为UE选择IMS的同时，同步选择一个与该IMS之间具有良好时延特征指标的UPF来建立UE上下文，进而可以解决基于选择的UPF建立的会话网络时延大的问题，提升业务使用体验。实施例三请结合图5，本申请公开了一种设备，包括：处理器30；存储器40，其中存储有处理器30的可执行指令；其中，处理器30配置为经由执行可执行指令来执行如实施例一所述的SMF选择UPF的方法。实施例四本申请公开了一种计算机可读存储介质，其上存储有程序，程序被处理器执行时实现如实施例一所述的SMF选择UPF的方法。实施例五本申请实施例公开了一种计算机程序产品或计算机程序，该计算机程序产品或计算机程序包括计算机指令，该计算机指令存储在计算机可读存储介质中。电子设备的处理器从计算机可读存储介质读取该计算机指令，处理器执行该计算机指令，使得该电子设备执行如实施例一所述的SMF选择UPF的方法。应当理解，在本申请实施例中，所称处理器可以是中央处理模块，该处理器还可以是其他通用处理器、数字信号处理器、专用集成电路、现成可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序指令相关的硬件来完成，的程序可存储于一计算机可读取存储介质中，该程序在执行时，可包括如上述各方法的实施例的流程。其中，的存储介质可为磁碟、光盘、只读存储记忆体或随机存储记忆体等。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述的部分，可以参见其它实施例的相关描述。以上所揭露的仅为本申请的较佳实例而已，不能以此来限定本申请之权利范围，因此依本申请权利要求所作的等同变化，均属于本申请所涵盖的范围。
