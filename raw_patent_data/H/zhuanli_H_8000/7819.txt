标题title
流量调度方法、装置、电子设备及存储介质
摘要abst
本发明提供了一种流量调度方法、装置、电子设备及存储介质，涉及流量调度技术领域。本发明实施例中，可以根据预先训练的选路模型，确定第一数据中心的最优出口链路，以将所述第一应用服务器对所述业务访问请求的响应流量返回用户，本发明实施例中，运用机器学习迭代调整选路策略，以根据当前链路配置数据以及当前链路质量数据，从多个出口链路中确定最优出口链路，以动态调整出口链路，为用户提供最优的访问路线。可以整体提高系统的处理效率，缩短用户的等待时间。
权利要求书clms
1.一种流量调度方法，其特征在于，应用于双活数据中心流量调度系统中的全局调度服务器，所述双活数据中心流量调度系统包括：全局调度服务器、第一数据中心、第二数据中心，每个数据中心包括：至少一个应用服务器，所述方法包括：接收用户发送的业务访问请求；将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的；根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户；所述选路模型的输入为当前链路配置数据和当前链路质量数据，输出为最优出口链路。2.根据权利要求1所述流量调度方法，其特征在于，所述方法还包括：采集所述第一数据中心各个出口链路的链路质量配置数据；根据当前用户的位置确定各个出口链路的链路价格值；根据当前用户确定各个出口链路的用户加权值；根据链路质量配置数据、链路价格值和用户加权值，确定当前链路配置数据；采集所述第一数据中心各个出口链路当前的丢包率和/或延迟率，确定当前链路质量数据。3.根据权利要求1所述的流量调度方法，其特征在于，每个数据中心还包括：至少一个应用负载均衡服务器；将所述业务访问请求转发至第一数据中心的第一应用服务器，包括：根据所述业务访问请求携带的域名确定对应的第一数据中心，将所述业务访问请求转发至第一数据中心，所述第一数据中心将所述业务访问请求转发至第一数据中心内的应用负载均衡服务器，所述应用负载均衡服务器用于根据第一数据中心内各个应用服务器的配置和负载均衡策略，确定第一应用服务器；将所述业务访问请求转发至所述第一应用服务器。4.根据权利要求1所述的流量调度方法，其特征在于，每个数据中心还包括：至少一个应用负载均衡服务器，不同数据中心布置的应用负载均衡服务器组成负载均衡集群；将所述业务访问请求转发至第一数据中心的第一应用服务器，包括：根据所述业务访问请求携带的域名确定对应的第一数据中心，所述第一数据中心将所述业务访问请求转发至负载均衡集群，所述负载均衡集群用于根据第一数据中心和第二数据中心各个应用服务器的配置和负载均衡策略确定第一应用服务器；将所述业务访问请求转发至应用服务器。5.根据权利要求4所述的流量调度方法，其特征在于，所述方法还包括：周期性发送探测报文，探测目标对象的可达性，所述目标对象包括：数据中心出口链路、应用负载服务器、数据中心互联链路、数据中心内网链路；在任意目标对象不可达的情况下，生成告警信息。6.根据权利要求5所述的流量调度方法，其特征在于，所述方法还包括：在第一数据中心的应用负载均衡服务器出现故障的情况下，将访问所述第一数据中心的业务访问请求转发至第二数据中心的应用负载均衡服务器，所述第二数据中心的应用负载均衡服务器用于根据第一数据中心各个应用服务器的配置和负载均衡策略把所述业务访问请求转发给第一数据中心的应用服务器提供服务器。7.根据权利要求5所述的流量调度方法，其特征在于，所述方法还包括：在第一数据中心出口链路出现故障的情况下，将所述业务访问请求中携带的访问域名解析为第二数据中心的地址，由第二数据中心布置的应用服务器对所述业务访问请求进行处理。8.根据权利要求5所述的流量调度方法，其特征在于，所述方法还包括：在数据中心之间的互联链路故障的情况下，将所述业务访问请求中携带的域名全部解析为第一数据中心的地址，所述第一数据中心为主数据中心。9.一种流量调度装置，其特征在于，应用于双活数据中心流量调度系统中的全局调度服务器，所述双活数据中心流量调度系统包括：全局调度服务器、第一数据中心、第二数据中心，每个数据中心包括：至少一个应用服务器，所述装置包括：接收模块，用于接收用户发送的业务访问请求；转发模块，用于将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的；确定模块，用于根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户；所述选路模型的输入为当前链路配置数据和当前链路质量数据，输出为最优出口链路。10.根据权利要求9所述的流量调度装置，其特征在于，所述装置还包括：采集模块，用于采集所述第一数据中心各个出口链路的链路质量配置数据；链路价格值确定模块，用于根据当前用户的位置确定各个出口链路的链路价格值；用户加权值确定模块，用于根据当前用户确定各个出口链路的用户加权值；链路配置数据确定模块，用于根据链路质量配置数据、链路价格值和用户加权值，确定当前链路配置数据；链路质量数据确定模块，用于采集所述第一数据中心各个出口链路当前的丢包率和/或延迟率，确定当前链路质量数据。11.根据权利要求10所述的流量调度装置，其特征在于，每个数据中心还包括：至少一个应用负载均衡服务器；所述转发模块，具体用于：根据所述业务访问请求携带的域名确定对应的第一数据中心，将所述业务访问请求转发至第一数据中心，所述第一数据中心将所述业务访问请求转发至第一数据中心内的应用负载均衡服务器，所述应用负载均衡服务器用于根据第一数据中心内各个应用服务器的配置和负载均衡策略，确定第一应用服务器；将所述业务访问请求转发至所述第一应用服务器。12.根据权利要求10所述的流量调度装置，其特征在于，每个数据中心还包括：至少一个应用负载均衡服务器，不同数据中心布置的应用负载均衡服务器组成负载均衡集群；所述转发模块，具体用于：根据所述业务访问请求携带的域名确定对应的第一数据中心，所述第一数据中心将所述业务访问请求转发至负载均衡集群，所述负载均衡集群用于根据第一数据中心和第二数据中心各个应用服务器的配置和负载均衡策略确定第一应用服务器；将所述业务访问请求转发至应用服务器。13.根据权利要求9所述的流量调度装置，其特征在于，所述装置还包括：发送模块，用于周期性发送探测报文，探测目标对象的可达性，所述目标对象包括：数据中心出口链路、应用负载服务器、数据中心互联链路、数据中心内网链路；生成模块，用于在任意目标对象不可达的情况下，生成告警信息。14.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1-8任一项所述的流量调度方法的步骤。15.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时实现权利要求1-8任一项所述的流量调度方法的步骤。
说明书desc
技术领域本发明实施例涉及流量调度技术领域，尤其涉及一种流量调度方法、装置、电子设备及存储介质。背景技术随着信息技术的发展，数据中心成为政府、企业、金融机构等处理数据提供服务的中心。数据的完整一致性，以及服务的连续和可靠性变为决定经济效益和改善国计民生的重要因素。单数据中心是存在单点故障的运行风险的，如果一个机房发生基础设施、电力、自然灾害等不可抗力因素，业务势必会受到影响，短期将难以恢复，所以双数据中心、两地三中心等建设要求应运而生。如何保证一个数据中心在重大灾难打击下业务继续提供服务，是数据中心建设中需要重点考虑的技术工作，所有技术选择和架构设计都要围绕着可靠和连续进行开展。相关领域中，出于容灾考虑一般会建设两个以上的数据中心，主数据中心和备数据中心镜像设计建设。其中，主数据中心用于提供用户服务，备份数据中心用来备份主数据中心的业务、配置、数据等等。当主数据中心出现问题的时候，备数据中心进行接管继续对外提供服务。可以看出，备数据中心在平时是不承担业务的，所以就会造成资源的浪费和运维成本的增加，双活数据中心可以很好的解决这个问题，双活数据中心指的是两个数据中心同时提供服务，且互为备份。即使在没有故障的情况下各个业务也可以分担到不同的数据中心，从而避免了一个数据中心的闲置造成的浪费，同时也扩大了服务提供能力，产生了更多的经济效益。然而，双活数据中心会带来更复杂的网络架构设计和网络策略设计。流量会负载到两个数据中心，就带来了流量模型的复杂；不同的业务位于不同的数据中心也会带来流量调度的多样性问题；数据中心出口策略固定单一在遇到网络质量波动的时候会影响用户体验；遇到网络故障如何精确的定位且快速切换主备中心，保证业务中断时间最小也成为双活数据中心的一大挑战。因此，目前亟需一种具体的流量调度方法，以解决相关问题。发明内容本发明实施例提供一种流量调度方法、装置、电子设备及存储介质，以至少部分解决相关技术中存在的问题。本发明实施例第一方面提供了一种流量调度方法，应用于双活数据中心流量调度系统中的全局调度服务器，所述双活数据中心流量调度系统包括：全局调度服务器、第一数据中心、第二数据中心，每个数据中心包括：至少一个应用服务器，所述方法包括：接收用户发送的业务访问请求；将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的；根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户；所述选路模型的输入为当前链路配置数据和当前链路质量数据，输出为最优出口链路。可选地，所述方法还包括：采集所述第一数据中心各个出口链路的链路质量配置数据；根据当前用户的位置确定各个出口链路的链路价格值；根据当前用户确定各个出口链路的用户加权值；根据链路质量配置数据、链路价格值和用户加权值，确定当前链路配置数据；采集所述第一数据中心各个出口链路当前的丢包率和/或延迟率，确定当前链路质量数据。可选地，每个数据中心还包括：至少一个应用负载均衡服务器；将所述业务访问请求转发至第一数据中心的第一应用服务器，包括：根据所述业务访问请求携带的域名确定对应的第一数据中心，将所述业务访问请求转发至第一数据中心，所述第一数据中心将所述业务访问请求转发至第一数据中心内的应用负载均衡服务器，所述应用负载均衡服务器用于根据第一数据中心内各个应用服务器的配置和负载均衡策略，确定第一应用服务器；将所述业务访问请求转发至所述第一应用服务器。可选地，每个数据中心还包括：至少一个应用负载均衡服务器，不同数据中心布置的应用负载均衡服务器组成负载均衡集群；将所述业务访问请求转发至第一数据中心的第一应用服务器，包括：根据所述业务访问请求携带的域名确定对应的第一数据中心，所述第一数据中心将所述业务访问请求转发至负载均衡集群，所述负载均衡集群用于根据第一数据中心和第二数据中心各个应用服务器的配置和负载均衡策略确定第一应用服务器；将所述业务访问请求转发至应用服务器。可选地，所述方法还包括：周期性发送探测报文，探测目标对象的可达性，所述目标对象包括：数据中心出口链路、应用负载服务器、数据中心互联链路、数据中心内网链路；在任意目标对象不可达的情况下，生成告警信息。可选地，所述方法还包括：在第一数据中心的应用负载均衡服务器出现故障的情况下，将访问所述第一数据中心的业务访问请求转发至第二数据中心的应用负载均衡服务器，所述第二数据中心的应用负载均衡服务器用于根据第一数据中心各个应用服务器的配置和负载均衡策略把所述业务访问请求转发给第一数据中心的应用服务器提供服务器。可选地，所述方法还包括：在第一数据中心出口链路出现故障的情况下，将所述业务访问请求中携带的访问域名解析为第二数据中心的地址，由第二数据中心布置的应用服务器对所述业务访问请求进行处理。可选地，所述方法还包括：在数据中心之间的互联链路故障的情况下，将所述业务访问请求中携带的域名全部解析为第一数据中心的地址，所述第一数据中心为主数据中心。本发明实施例第二方面提供了一种流量调度装置，应用于双活数据中心流量调度系统中的全局调度服务器，所述双活数据中心流量调度系统包括：全局调度服务器、第一数据中心、第二数据中心，每个数据中心包括：至少一个应用服务器，所述装置包括：接收模块，用于接收用户发送的业务访问请求；转发模块，用于将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的；确定模块，用于根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户；所述选路模型的输入为当前链路配置数据和当前链路质量数据，输出为最优出口链路。可选地，所述装置还包括：采集模块，用于采集所述第一数据中心各个出口链路的链路质量配置数据；链路价格值确定模块，用于根据当前用户的位置确定各个出口链路的链路价格值；用户加权值确定模块，用于根据当前用户确定各个出口链路的用户加权值；链路配置数据确定模块，用于根据链路质量配置数据、链路价格值和用户加权值，确定当前链路配置数据；链路质量数据确定模块，用于采集所述第一数据中心各个出口链路当前的丢包率和/或延迟率，确定当前链路质量数据。可选地，每个数据中心还包括：至少一个应用负载均衡服务器；所述转发模块，具体用于：根据所述业务访问请求携带的域名确定对应的第一数据中心，将所述业务访问请求转发至第一数据中心，所述第一数据中心将所述业务访问请求转发至第一数据中心内的应用负载均衡服务器，所述应用负载均衡服务器用于根据第一数据中心内各个应用服务器的配置和负载均衡策略，确定第一应用服务器；将所述业务访问请求转发至所述第一应用服务器。可选地，每个数据中心还包括：至少一个应用负载均衡服务器，不同数据中心布置的应用负载均衡服务器组成负载均衡集群；所述转发模块，具体用于：根据所述业务访问请求携带的域名确定对应的第一数据中心，所述第一数据中心将所述业务访问请求转发至负载均衡集群，所述负载均衡集群用于根据第一数据中心和第二数据中心各个应用服务器的配置和负载均衡策略确定第一应用服务器；将所述业务访问请求转发至应用服务器。可选地，所述装置还包括：发送模块，用于周期性发送探测报文，探测目标对象的可达性，所述目标对象包括：数据中心出口链路、应用负载服务器、数据中心互联链路、数据中心内网链路；生成模块，用于在任意目标对象不可达的情况下，生成告警信息。可选地，所述装置还包括：第一故障处理模块，用于在第一数据中心的应用负载均衡服务器出现故障的情况下，将访问所述第一数据中心的业务访问请求转发至第二数据中心的应用负载均衡服务器，所述第二数据中心的应用负载均衡服务器用于根据第一数据中心各个应用服务器的配置和负载均衡策略把所述业务访问请求转发给第一数据中心的应用服务器提供服务器。可选地，所述装置还包括：第二故障处理模块，用于在第一数据中心出口链路出现故障的情况下，将所述业务访问请求中携带的访问域名解析为第二数据中心的地址，由第二数据中心布置的应用服务器对所述业务访问请求进行处理。可选地，所述装置还包括：第三故障处理模块，用于在数据中心之间的互联链路故障的情况下，将所述业务访问请求中携带的域名全部解析为第一数据中心的地址，所述第一数据中心为主数据中心。本发明实施例第三方面提供一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如本发明第一方面所述的方法中的步骤。本发明实施例第四方面提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行时实现如本发明第一方面所述的方法中的步骤。本发明实施例中，可以根据预先训练的选路模型，确定第一数据中心的最优出口链路，以将所述第一应用服务器对所述业务访问请求的响应流量返回用户，本发明实施例中，运用机器学习迭代调整选路策略，以根据当前链路配置数据以及当前链路质量数据，从多个出口链路中确定最优出口链路，以动态调整出口链路，为用户提供最优的访问路线。可以整体提高系统的处理效率，缩短用户的等待时间。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对本发明实施例的描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例的一种流量调度方法的流程图；图2是本发明实施例的另一种流量调度方法的流程图；图3是本发明实施例的另一种流量调度方法的流程图；图4是本发明实施例的一种流量调度装置的结构框图。具体实施方式为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图和具体实施方式对本发明作进一步详细的说明。参照图1，示出了本发明实施例的一种流量调度方法的流程图，本发明实施例所提供的流量调度方法应用于双活数据中心流量调度系统中的全局调度服务器，所述双活数据中心流量调度系统包括：全局调度服务器、第一数据中心、第二数据中心，每个数据中心包括：至少一个应用服务器，本发明实施例提供的流量调度方法可以包括以下步骤：S101，接收用户发送的业务访问请求。本发明实施例中，全局调度服务器可以连接双活数据中心流量调度系统中的所有数据中心。将来自用户的业务访问请求调度至对应的第一数据中心。本发明实施例中，用户发送的业务访问请求中可以携带用户信息，用户信息至少包括：用户标识、用户所在位置。S102，将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的。本发明实施例中，全局调度服务器可以根据所述业务访问请求和负载均衡策略，将业务访问请求转发给与该业务访问请求相对应的、并且符合负载均衡策略的第一数据中心的第一应用服务器，以使该第一应用服务器对该业务访问请求进行处理。本发明实施例中，第一数据中心和第二数据中心内布设的应用服务器可以分别用于处理不同的业务服务，也可以有多个应用服务器被配置成处理同样的业务服务，在多个应用服务器被配置处理同样的业务服务的情况下，可以为应用服务器配置各自的优先级。本发明实施例中，负载均衡策略指的是对数据中心内布设的处理同一业务服务的多个应用服务器的流量负载进行均衡分配。S103，根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户。本发明实施例中，所述选路模型的输入为当前链路配置数据和当前链路质量数据，输出为最优出口链路。本发明实施例中，当前链路配置数据指的是：用户或者系统管理员根据链路配置的固定数值，以及根据当前用户信息确定出的各个链路的配置数据。当前链路质量数据指的是：当前各个链路的实时网络质量状况。本发明实施例中，预设的训练模型为支持向量机模型，以链路质量数据样本值、及链路配置数据样本值作为输入，以样本选路结果作为输出，将输入以及输出作为训练向量输入至SVM模型进行训练，得到训练后的模型，即选路模型。本发明实施例中，样本选路结果是根据链路质量数据样本值、及链路配置数据样本值人工制定的最优出口链路。在实际应用时，将当前链路配置数据以及当前链路质量数据输入至训练好的选路模型中，得到选路结果，即与用户相对应的最优出口链路，从而基于该最优出口链路进行动态链路调整，使得第一应用服务器对所述业务访问请求的响应流量经过该最优出口链路返回用户。本发明实施例中，在应用过程中，还可以不断将实时的链路配置数据以及链路质量数据作为输入，最优出口链路作为输出对模型进行迭代训练，实现根据网络质量状况自适应确定可靠性更高的出口链路。本发明实施例中，可以根据用户发送的业务访问请求中携带的用户IP的运营商选择进入数据中心的出口链路，之后可以根据当前链路配置数据以及当前链路质量数据，从多个出口链路中确定最优出口链路，以动态调整出口链路，为用户提供最优的访问路线。参照图2，示出了本发明实施例的一种流量调度方法的流程图，本发明实施例所提供的流量调度方法应用于双活数据中心流量调度系统中的全局调度服务器，所述双活数据中心流量调度系统包括：全局调度服务器、第一数据中心、第二数据中心，每个数据中心包括：至少一个应用服务器、至少一个应用负载均衡服务器。具体的，所述流量调度方法可以包括以下步骤：S201，接收用户发送的业务访问请求。所述步骤S201与上述步骤S101类似，本发明实施例在此不再赘述。S202，将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的。本发明实施例中，每个数据中心中布设有至少一个应用负载均衡服务器，具体的，所述步骤S202包括以下子步骤：S2021A，根据所述业务访问请求携带的域名确定对应的第一数据中心，将所述业务访问请求转发至第一数据中心，所述第一数据中心将所述业务访问请求转发至第一数据中心内的应用负载均衡服务器，所述应用负载均衡服务器用于根据第一数据中心内各个应用服务器的配置和负载均衡策略，确定第一应用服务器。S2022A，将所述业务访问请求转发至所述第一应用服务器。本发明实施例中，用户访问数据中心的某个业务时，全局调度服务器会将业务访问请求中携带的域名解析成距离用户距离最近数据中心的出口业务IP地址，并将公网的业务IP映射成应用负载均衡服务器的私网IP地址，应用负载均衡服务器关联了应用服务器，通过负载均衡技术将流量调度到对应的应用服务器上提供服务。本发明实施例中，不同数据中心布置的应用负载均衡服务器可以组成负载均衡集群。具体的，数据中心的的应用负载均衡服务器均采用集群部署旁挂到汇聚交换机上。本发明实施例中，负载均衡集群采用虚拟业务IP代理应用系统的实际IP。第一数据中心的应用负载均衡服务器的虚拟IP和第二数据中心的应用负载均衡服务器的虚拟IP设置相同的应用系统或数据库服务器的节点池，通过为应用系统或数据库节点设置优先级的方式实现相同的应用在两个数据中心中的扩展部署和容灾备份。本发明实施例中，双活数据中心流量调度系统，在业务层的双活方案为：用户访问地址由全局负载服务器进行全局调度，通过DNS递归解析回源第一数据中心或第二数据中心的应用系统服务器，由数据中心的应用系统服务器提供服务。在应用层的双活方案为：第一数据中心和第二数据中心的应用负载均衡服务器可以共同对外提供应用层代理服务，对于每一个应用组，负载均衡集群面向互联网用户提供不同的代理IP，由全局负载均衡技术为两个IP设置相同的域名指向和不同的权重优先级，实现用户业务流的负载均衡和应用系统的备份。数据库层的双活方案为数据库分布式部署在第一数据中心和第二数据中心，采用主从结构布局，部分应用系统以第一数据中心为主库，第二数据中心为从库，而部分应用系统以第二数据中心为主库，第一数据中心为从库，当数据中心应用系统的主数据库出现故障后，在另外一个数据中心相同应用系统的从库成为主库承接业务。在这种情况下，所述步骤S202包括以下子步骤：S2021B，根据所述业务访问请求携带的域名确定对应的第一数据中心，所述第一数据中心将所述业务访问请求转发至负载均衡集群，所述负载均衡集群用于根据第一数据中心和第二数据中心各个应用服务器的配置和负载均衡策略确定第一应用服务器。S2022B，将所述业务访问请求转发至应用服务器。本发明实施例中，通过负载均衡集群可以对两个数据中心中布设的应用服务器，基于应用服务器的配置和负载均衡策略进行统一的流量调度。S203，采集所述第一数据中心各个出口链路的链路质量配置数据；根据当前用户的位置确定各个出口链路的链路价格值；根据当前用户确定各个出口链路的用户加权值。本发明实施例中，每条出口链路的链路质量配置数据是提前配置好的固定值，例如为1-100的数值，其代表链路质量的高低。各个出口链路的链路价格值指的是每条链路距离用户距离的远近，各个出口链路的用户加权值指的是用户对该出口链路的链路需求。S204，根据链路质量配置数据、链路价格值和用户加权值，确定当前链路配置数据。S205，采集所述第一数据中心各个出口链路当前的丢包率和/或延迟率，确定当前链路质量数据。本发明实施例中，链路质量数据为各个出口链路的探测流量信息，包括延迟率、丢包率等。S206，根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户。本发明实施例中，可以从多个出口链路中确定最优出口链路，以动态调整出口链路，为用户提供最优的访问路线。参照图3，示出了本发明实施例的一种流量调度方法的流程图，本发明实施例所提供的流量调度方法，具体可以包括以下步骤：S301，接收用户发送的业务访问请求。S302，将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的。S303，根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户。所述步骤S301~S303与上述步骤S101~S103类似，本发明实施例在此不再赘述。S304，周期性发送探测报文，探测目标对象的可达性，所述目标对象包括：数据中心出口链路、应用负载服务器、数据中心互联链路、数据中心内网链路。S305，在任意目标对象不可达的情况下，生成告警信息。本发明实施例中，全局调度服务器可以周期性发送探测报文，探测目标对象的可达性，具体为探测特定位置的网络连通性和网络质量，当网络出现故障的时候生成中断信息进行反馈；进而根据网络中断情况及时根据提前设置好的故障处理策略进行流量调度。本发明实施例中，针对目标对象不可达的情况，还提出以下几种故障处理策略，具体包括：一、应用负载均衡服务器出现故障：在第一数据中心的应用负载均衡服务器出现故障的情况下，将访问所述第一数据中心的业务访问请求转发至第二数据中心的应用负载均衡服务器，所述第二数据中心的应用负载均衡服务器用于根据第一数据中心各个应用服务器的配置和负载均衡策略把所述业务访问请求转发给第一数据中心的应用服务器提供服务器。本发明实施例中，每个数据中心均布置至少一个应用负载均衡服务器组成集群，当某个应用负载均衡服务器发生故障，可以优先切换到本数据中心的另一台应用负载均衡服务器接管全部业务。这时候流量调度不发生变化。在第一数据中心的所有应用负载均衡服务器均出现故障的情况下，可以优先切换到第二数据中心的应用负载均衡服务器接管全部业务。本发明实施例中当第一数据中心所有应用负载均衡服务器全部故障，用户的访问流量会被调度到第二数据中心的应用负载均衡服务器上，此时第二数据中心的虚拟服务依然可以通过数据中心互联链路调度流量到第一数据中心的应用服务器上，只有当第一数据中心的应用服务器路由不可达的时候，虚拟服务才会调度第二数据中心的应用服务器。二、第一数据中心出口链路出现故障：在第一数据中心出口链路出现故障的情况下，将所述业务访问请求中携带的访问域名解析为第二数据中心的地址，由第二数据中心布置的应用服务器对所述业务访问请求进行处理。本发明实施例中，虽然第一数据中心的应用服务器和数据库没有故障，但是由于第一数据中心的默认路由都指向本数据中心的出口，出现出口链路的故障只能使第二数据中心进行业务托管。以第一数据中心作为某应用系统的主中心，第二数据中心为备中心为例，当主中心上联交换机或出口防火墙出现故障的时候，全局负载服务器通过链路健康检查机制和调度机制，用户的业务访问请求被解析为备中心的IP地址，同时还可以对主数据中心中的服务器节点池进行优先级降级处理，让备中心承担业务服务。三、数据中心之间的互联链路故障：在数据中心之间的互联链路故障的情况下，将所述业务访问请求中携带的域名全部解析为第一数据中心的地址，所述第一数据中心为主数据中心。具体的，以第一数据中心作为某应用系统的主中心，第二数据中心为备中心为例，正常情况下北方用户调度到第一数据中心访问主数据库，南方用户调度到第二数据中心后通过专线访问主数据库。数据中心互联链路发生故障后，全局负载将用户访问的域名解析到第一数据中心访问主数据库。四、数据中心内网链路故障：在第一数据中心的内网链路故障的情况下，将访问所述第一数据中心的业务访问请求转发至第一数据中心的应用负载均衡服务器，所述第一数据中心的应用负载均衡服务器用于降低第一数据中心各个应用服务器的优先级配置，并根据负载均衡策略把所述业务访问请求转发给第二数据中心的应用服务器提供服务器。本发明实施例中，数据中心内网链路故障具体为：应用负载均衡服务器到应用服务器出现网络端口不可达。此时，用户请求可以到达第一数据中心的应用负载均衡服务器的虚拟IP，但是对于实际提供服务的节点不可达。需要将业务访问请求转发给第二数据中心的应用服务器提供服务器。由此，第一数据中心内网链路故障不会影响业务的正常访问。以第一数据中心作为某应用系统的主中心，第二数据中心为备中心为例。当第一数据中心的内网链路故障后，业务中断。第一数据中心的应用负载均衡服务器降低本数据中心应用服务器的优先级配置，使流量通过数据中心互联链路调度到第二数据中心的应用服务器。同时，第二数据中心的应用负载均衡服务器也可以同时提高本数据中心应用服务器的优先级配置，调度流量到本数据中心应用服务器，以保证所有用户都能正常访问服务。本发明实施例中，还可以对用户访问的具体路径信息进行采集并展示双活数据中心流量调度系统的前端界面；本发明实施例中，还可以对所有应用服务器的配置和描述信息进行存储，包括业务名称、域名、提供服务的公网IP、IP所属机房、公网映射内网的IP地址、服务提供节点列表、各个节点所属机房、节点优先级、节点开启或关闭等情况，并且提供接口供其他模块或者管理人员查询调用。从而，本发明实施例中，当数据中心的出口链路出现故障，全局负载会将访问的域名解析为另一个数据中心的地址，实现用户业务无感知。当应用负载均衡服务器出现故障时，全局负载服务器会和应用负载均衡服务器联动，将流量引导至另一个数据中心的应用负载均衡服务器上。当数据中心的互联链路故障时，全局负载服务器将用户访问的域名全部解析为主数据中心业务IP地址，流量会调度到主中心上。当数据中心内网发生故障，应用负载到应用节点网络中断。这时候提高另一个数据中心节点的优先级，流量通过互联专线去往另一个数据中心的节点。从而，本发明实施例保证了用户流量负载到两个数据中心，大大提高资源的使用率；并运用机器学习迭代调整选路策略，提供最优的出口链路。同时针对不同情况下的网络故障可以快速检测并响应网络故障，能够在短时间内恢复业务并定位故障点，降低运维成本和运维压力；最后还可以将业务配置和用户访问的具体路径信息打包供网络管理人员使用，大大提高运维效率。基于同一发明构思，本发明实施例提供一种流量调度装置，参考图4，图4是本发明实施例提供的流量调度装置的示意图，所述装置应用于双活数据中心流量调度系统中的全局调度服务器，所述双活数据中心流量调度系统包括：全局调度服务器、第一数据中心、第二数据中心，每个数据中心包括：至少一个应用服务器，所述装置包括：接收模块401，用于接收用户发送的业务访问请求；转发模块402，用于将所述业务访问请求转发至第一数据中心的第一应用服务器，以对所述业务访问请求进行处理，所述第一数据中心的第一应用服务器是根据所述业务访问请求和负载均衡策略确定的；确定模块403，用于根据预先训练的选路模型，确定所述第一数据中心的最优出口链路，所述最优出口链路用于将所述第一应用服务器对所述业务访问请求的响应流量返回用户；所述选路模型的输入为当前链路配置数据和当前链路质量数据，输出为最优出口链路。可选地，所述装置还包括：采集模块，用于采集所述第一数据中心各个出口链路的链路质量配置数据；链路价格值确定模块，用于根据当前用户的位置确定各个出口链路的链路价格值；用户加权值确定模块，用于根据当前用户确定各个出口链路的用户加权值；链路配置数据确定模块，用于根据链路质量配置数据、链路价格值和用户加权值，确定当前链路配置数据；链路质量数据确定模块，用于采集所述第一数据中心各个出口链路当前的丢包率和/或延迟率，确定当前链路质量数据。可选地，每个数据中心还包括：至少一个应用负载均衡服务器；所述转发模块402，具体用于：根据所述业务访问请求携带的域名确定对应的第一数据中心，将所述业务访问请求转发至第一数据中心，所述第一数据中心将所述业务访问请求转发至第一数据中心内的应用负载均衡服务器，所述应用负载均衡服务器用于根据第一数据中心内各个应用服务器的配置和负载均衡策略，确定第一应用服务器；将所述业务访问请求转发至所述第一应用服务器。可选地，每个数据中心还包括：至少一个应用负载均衡服务器，不同数据中心布置的应用负载均衡服务器组成负载均衡集群；所述转发模块402，具体用于：根据所述业务访问请求携带的域名确定对应的第一数据中心，所述第一数据中心将所述业务访问请求转发至负载均衡集群，所述负载均衡集群用于根据第一数据中心和第二数据中心各个应用服务器的配置和负载均衡策略确定第一应用服务器；将所述业务访问请求转发至应用服务器。可选地，所述装置还包括：发送模块，用于周期性发送探测报文，探测目标对象的可达性，所述目标对象包括：数据中心出口链路、应用负载服务器、数据中心互联链路、数据中心内网链路；生成模块，用于在任意目标对象不可达的情况下，生成告警信息。可选地，所述装置还包括：第一故障处理模块，用于在第一数据中心的应用负载均衡服务器出现故障的情况下，将访问所述第一数据中心的业务访问请求转发至第二数据中心的应用负载均衡服务器，所述第二数据中心的应用负载均衡服务器用于根据第一数据中心各个应用服务器的配置和负载均衡策略把所述业务访问请求转发给第一数据中心的应用服务器提供服务器。可选地，所述装置还包括：第二故障处理模块，用于在第一数据中心出口链路出现故障的情况下，将所述业务访问请求中携带的访问域名解析为第二数据中心的地址，由第二数据中心布置的应用服务器对所述业务访问请求进行处理。可选地，所述装置还包括：第三故障处理模块，用于在数据中心之间的互联链路故障的情况下，将所述业务访问请求中携带的域名全部解析为第一数据中心的地址，所述第一数据中心为主数据中心。对于装置实施例而言，由于其与方法实施例基本相似，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。基于同一发明构思，本发明实施例提供一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现上述任一实施例所述的流量调度方法中的步骤。基于同一发明构思，本发明实施例提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行计算机程序时实现上述任一实施例所述的流量调度方法中的步骤。本说明书中的各个实施例均采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似的部分互相参见即可。本领域内的技术人员应明白，本发明实施例的实施例可提供为方法、装置、或计算机程序产品。因此，本发明实施例可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明实施例可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明实施例是参照根据本发明实施例的方法、终端设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程流量调度终端设备的处理器以产生一个机器，使得通过计算机或其他可编程流量调度终端设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程流量调度终端设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程流量调度终端设备上，使得在计算机或其他可编程终端设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程终端设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。尽管已描述了本发明实施例的优选实施例，但本领域内的技术人员一旦得知了基本创造性概念，则可对这些实施例做出另外的变更和修改。所以，所附权利要求意欲解释为包括优选实施例以及落入本发明实施例范围的所有变更和修改。最后，还需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者终端设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者终端设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者终端设备中还存在另外的相同要素。以上对本发明所提供的一种流量调度方法、装置、电子设备及存储介质，进行了详细介绍，本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处，综上所述，本说明书内容不应理解为对本发明的限制。
