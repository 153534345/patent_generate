标题title
基于电流检测的阵列式位移计的地址自动分配方法和排序方法
摘要abst
本发明公开了一种基于电流检测的阵列式位移计的地址自动分配方法和排序方法，通过节点对应的电流检测芯片分别检测电源线上并联电流的大小，从而根据节点上流经的电流大小确定当前节点处于总线上的位置，并利用其相对位置来修改自身的地址或者对与节点电流关联的地址重新进行排序，最终得到按照节点顺序编号的地址表，从而利用地址表来依次采集各节点的三轴位移数据，最终得到整个阵列式位移计的形变测量结果。本发明的方法通过软硬件方面的配合改进，能提高阵列式位移计测量工作的自动化程度，并提高批量地址的排序和分配处理速度。
权利要求书clms
1.一种基于电流检测的阵列式位移计的地址自动分配方法，其特征在于，阵列式位移计的N个节点与采集终端之间分别通过电源线和通讯线并联连接，所述采集终端的电源输出为恒压源，在通用的电源线上依次串联设置有N个电流检测芯片，第1个电流检测芯片设置在采集终端和第1个节点之间的电源线上，第i个电流检测芯片设置在第i-1个节点和第i个节点之间的电源线上，i取值为2~N；所述地址自动分配方法包括如下步骤：步骤1.1：系统上电后，确保所述采集终端和各节点的供电通讯正常；步骤1.2：发送节点总数N和自动分配地址指令至采集终端，所述采集终端进入自动分配地址流程；步骤1.3：所述采集终端发送自动分配地址指令和节点总数N到各节点；步骤1.4：接收到所述自动分配地址指令后，各节点进入地址分配模式，各节点关闭无关的外设模块，并通过各节点处的电流检测芯片多次采集流经电流，得到平均电流值bj，下标j取值为1~N；步骤1.5：各节点自行计算自身地址，各节点根据采集的所述平均电流值bj、节点总数N以及所存储的单个节点的标准电流a综合计算出各个节点的地址Kj=+1)，并将地址Kj修改为节点自身的地址，round函数为对x保留0位小数的四舍五入取整函数；步骤1.6：所述采集终端从1开始依次读取各节点的地址，再对比可通讯的地址最大值M与输入的节点总数N是否相等，若相等，则表示地址分配总数正确，执行下一步骤1.7，若不相等，则退出地址分配程序并提示地址自动分配异常；步骤1.7：所述采集终端将地址1~N依次顺序保存到地址表中。2.根据权利要求1所述的基于电流检测的阵列式位移计的地址自动分配方法，其特征在于，步骤1.2还包括，在所述采集终端进入自动分配地址流程后，暂停其它与地址分配无关的工作。3.根据权利要求1所述的基于电流检测的阵列式位移计的地址自动分配方法，其特征在于，所述采集终端与上位机之间通信连接，所述上位机用于输入所述节点总数N。4.根据权利要求1所述的基于电流检测的阵列式位移计的地址自动分配方法，其特征在于，所述步骤1.5在满足预设阈值的时长后再执行所述步骤1.6。5.根据权利要求1所述的基于电流检测的阵列式位移计的地址自动分配方法，其特征在于，所述可通讯的地址最大值M是在采集终端从1开始依次读取各节点的地址过程中连续通信握手成功的总次数。6.一种基于电流检测的阵列式位移计的地址自动排序方法，其特征在于，阵列式位移计的N个节点与采集终端之间分别通过电源线和通讯线并联连接，所述采集终端的电源输出为恒压源，在通用的电源线上依次串联设置有N个电流检测芯片，第1个电流检测芯片设置在采集终端和第1个节点之间的电源线上，第i个电流检测芯片设置在第i-1个节点和第i个节点之间的电源线上，i取值为2~N；所述地址自动排序方法包括如下步骤：步骤2.1：系统上电后，确保所述采集终端和各节点的供电通讯正常；步骤2.2：发送自动排序指令到采集终端，所述采集终端进入地址自动排序流程；步骤2.3：所述采集终端通过通讯线向所有节点发送自动排序指令；步骤2.4：各个节点在接收到所述自动排序指令后，关闭无关的外设模块，并通过所述电流检测芯片多次采集对应节点的流经电流，计算得到节点的平均电流值bj；步骤2.5：所述采集终端等待一定时间后，通过已经存储在系统内的节点地址ej向各节点逐个发送获取电流值指令，j为1~N，各个节点则将平均电流值bj发送给采集终端，所述采集终端中将各个节点的平均电流值bj与节点地址ej一一对应，再通过对平均电流值bj带节点地址ej进行从大到小的排序，更新得到各个节点地址ej的顺序地址表，并保存顺序地址表。7.根据权利要求6所述的基于电流检测的阵列式位移计的地址自动排序方法，其特征在于，步骤2.2还包括，在所述采集终端进入地址自动排序流程后，暂停其它与地址排序无关的工作。8.根据权利要求6所述的基于电流检测的阵列式位移计的地址自动排序方法，其特征在于，所述采集终端与上位机之间通信连接，所述上位机用于输入自动排序指令。9.根据权利要求6所述的基于电流检测的阵列式位移计的地址自动排序方法，其特征在于，所述关闭无关的外设模块包括关闭加速度采集芯片。10.根据权利要求6所述的基于电流检测的阵列式位移计的地址自动排序方法，其特征在于，所述步骤2.5中平均电流值bj的排序方式具体为冒泡排序法。
说明书desc
技术领域本发明属于传感器测量的数据传输技术领域，特别是涉及一种基于电流检测的阵列式位移计的地址自动分配方法和排序方法。背景技术阵列式位移计SSA是由多个物理上串联的位移计节点组成的传感器，常用于地质灾害和大型建筑物形变的监测，每个节点中含有一个MEMS加速度的元器件和处理器芯片，用于测量X、Y、Z三轴的加速度，根据三轴加速度可以计算出单个节点的坐标系倾角，由于单个节点的长度是已知的，因此以节点首端作为原点，末端的坐标可以根据三轴的倾角计算得出。通过上述方法可以得出单个节点的坐标值，再将坐标进行累加就可以得到某个节点相对于首节点的一个坐标值，此处需要知道每个节点的一个相对位置才可以进行一个累加工作，因此需要将相对位置使用上位机或者其他方式输入到采集终端中后采集终端才可以计算出每个节点以首节点作为坐标系的坐标值。在阵列式位移计的实际应用现场安装时，由于现场钻孔的深度或者需求无法一次性直接确定，因此采集终端内预先存储的节点地址表与串联结构的阵列式位移计的节点数不一定可以做到一一对应，可能存在节点变化或者加减组装的情况，在需要增加节点、更换节点时操作复杂，需要再次按照既定顺序将串联节点的相对位置写入到采集设备中。目前，在阵列式位移计上可能存在使用新增硬件进行自动排序的方法，但是其地址表的排序速度和地址写入速度都较慢，需要一个个写入地址或者排序地址。基于此，亟需设计一种基于电流检测的阵列式位移计的地址自动分配方法和排序方法，使得终端中物理上串联的各个位移计节点的连接关系足够清楚，从而降低阵列式位移计的地址排序和分配工作的工作量，并提高批量地址的排序和分配效率。发明内容要解决的技术问题基于此，本发明公开了一种基于电流检测的阵列式位移计的地址自动分配方法和排序方法，该方法在包含软硬件结合两方面的综合改进，能提高阵列式位移计测量工作的自动化程度，并提高批量地址的排序和分配处理速度。技术方案本发明公开了一种基于电流检测的阵列式位移计的地址自动分配方法，阵列式位移计的N个节点与采集终端之间分别通过电源线和通讯线并联连接，所述采集终端的电源输出为恒压源，在通用的电源线上依次串联设置有N个电流检测芯片，第1个电流检测芯片设置在采集终端和第1个节点之间的电源线上，第i个电流检测芯片设置在第i-1个节点和第i个节点之间的电源线上，i取值为2~N；所述地址自动分配方法包括如下步骤：步骤1.1：系统上电后，确保所述采集终端和各节点的供电通讯正常；步骤1.2：发送节点总数N和自动分配地址指令至采集终端，所述采集终端进入自动分配地址流程；步骤1.3：所述采集终端发送自动分配地址指令和节点总数N到各节点；步骤1.4：接收到所述自动分配地址指令后，各节点进入地址分配模式，各节点关闭无关的外设模块，并通过各节点处的电流检测芯片多次采集流经电流，得到平均电流值bj，下标j取值为1~N；步骤1.5：各节点自行计算自身地址，各节点根据采集的所述平均电流值bj、节点总数N以及所存储的单个节点的标准电流a综合计算出各个节点的地址Kj=+1)，并将地址Kj修改为节点自身的地址，round函数为对x保留0位小数的四舍五入取整函数；步骤1.6：所述采集终端从1开始依次读取各节点的地址，再对比可通讯的地址最大值M与输入的节点总数N是否相等，若相等，则表示地址分配总数正确，执行下一步骤1.7，若不相等，则退出地址分配程序并提示地址自动分配异常；步骤1.7：所述采集终端将地址1~N依次顺序保存到地址表中。进一步的，步骤1.2还包括，在所述采集终端进入自动分配地址流程后，暂停其它与地址分配无关的工作。进一步的，所述采集终端与上位机之间通信连接，所述上位机用于输入所述节点总数N。进一步的，所述步骤1.5在满足预设阈值的时长后再执行所述步骤1.6。进一步的，所述可通讯的地址最大值M是在采集终端从1开始依次读取各节点的地址过程中连续通信握手成功的总次数。在另外一方面，本发明还公开了一种基于电流检测的阵列式位移计的地址自动排序方法，阵列式位移计的N个节点与采集终端之间分别通过电源线和通讯线并联连接，所述采集终端的电源输出为恒压源，在通用的电源线上依次串联设置有N个电流检测芯片，第1个电流检测芯片设置在采集终端和第1个节点之间的电源线上，第i个电流检测芯片设置在第i-1个节点和第i个节点之间的电源线上，i取值为2~N；所述地址自动排序方法包括如下步骤：步骤2.1：系统上电后，确保所述采集终端和各节点的供电通讯正常；步骤2.2：发送自动排序指令到采集终端，所述采集终端进入地址自动排序流程；步骤2.3：所述采集终端通过通讯线向所有节点发送自动排序指令；步骤2.4：各个节点在接收到所述自动排序指令后，关闭无关的外设模块，并通过所述电流检测芯片多次采集对应节点的流经电流，计算得到节点的平均电流值bj；步骤2.5：所述采集终端等待一定时间后，通过已经存储在系统内的节点地址ej向各节点逐个发送获取电流值指令，j为1~N，各个节点则将平均电流值bj发送给采集终端，所述采集终端中将各个节点的平均电流值bj与节点地址ej一一对应，再通过对平均电流值bj带节点地址ej进行从大到小的排序，更新得到各个节点地址ej的顺序地址表，并保存顺序地址表。进一步的，步骤2.2还包括，在所述采集终端进入地址自动排序流程后，暂停其它与地址排序无关的工作。进一步的，所述采集终端与上位机之间通信连接，所述上位机用于输入自动排序指令。进一步的，所述关闭无关的外设模块包括关闭加速度采集芯片。进一步的，所述步骤2.5中平均电流值bj的排序方式具体为冒泡排序法。有益效果本发明基于电流检测的阵列式位移计的地址自动分配方法和排序方法为软硬件结合的改进方法，两者工作原理总结来说是通过各节点对应的电流检测芯片分别检测电源线上并联电流的大小，从而根据节点上流经的电流大小确定当前节点处于总线上的位置，并利用其相对位置来修改自身的地址或者对节点电流关联的地址重新进行排序，最终得到按照节点顺序编号的地址表。此外，由于本发明的地址排序方法主要利用各个节点的数据处理功能来分别自行计算和修改自身的地址值，故其数据并行处理方式的速度较快，能够很好地适应节点数量较大的地址自动分配工作，且还利用输入的节点总数等先验信息对地址分配结果进行校验和核对，能够保证在所有节点正常分配完毕后自动退出分配程序。附图说明通过参考附图会更加清楚的理解本发明的特征和优点，附图是示意性的而不应理解为对本发明进行任何限制，在附图中：图1为本发明基于电流检测的阵列式位移计的地址自动分配方法和排序方法所对应的系统结构示意图；图2为本发明中地址自动分配方法的流程图；图3为本发明中地址自动排序方法的流程图。具体实施方式下面将结合附图和实施例对本发明进行清楚、完整地描述，同时也叙述了本发明技术方案解决的技术问题及有益效果，需要指出的是，所描述的实施例仅旨在便于对本发明的理解，而对其不起任何限定作用。阵列式位移计SAA具有多个串联的节点，各个相邻节点之间硬件上首尾相连，在进行数据计算时，需要确定每个节点位于系统的相对位置，传统的方法是提前将相对位置通过上位机或者其他方式写入到采集设备中，从而导致了采集设备与节点需要一一对应，在增加节点、插入节点、更换节点时操作复杂，需要再次按照既定顺序将各个节点的相对位置写入到采集设备中，尤其是对于较长的阵列式位移计来说，其大大增加了测量准备工作的工作量。为了解决以上问题，本发明在现有的阵列式位移计测量系统的基础上进行了结构化的改进，基于电流检测的阵列式位移计的地址自动分配方法和排序方法所对应的系统结构可参见图1所示。如图1所示，本发明阵列式位移计的地址自动分配和排序系统包括采集终端、N个节点、电源线、通讯线、排序线等电气组件构成，阵列式位移计的N个节点与采集终端之间分别通过电源线和通讯线并联连接，其中采集终端主要用于采集阵列式位移计中各节点的加速度数据，计算出单个节点在坐标X-Y-Z三个轴不同的位移，通过各节点的相对位置将各节点位移进行顺序累加，再将数据通过4G等无线通信方式发送至平台，在地址的自动排序及分配工作中，采集终端主要执行控制、采集以及存储工作。各节点的工作主要是使用高精度的加速度计采集当前位置X-Y-Z的三轴位移数据，并对数据进行滤波处理，同时通过通讯线接收采集终端的数据上传指令，从而分别对各个节点采集的三轴位移数据进行上传。电源线主要是供电使用，供电范围约为6V-26V左右，标准电压为12V。此外，通讯线是采集终端控制、读取节点数据以及节点上传数据的通道。节点与终端均挂在在同一电源线和通讯线下，从而实现各节点之间的并联连接，通讯线一般由两根构成，以实现数据的双向通信，电源线一般也由两根构成，以实现供电和接地，因为并不影响理解，故图中只绘出一根通讯和电源线作为示意。为了实现地址的自动排序和分配功能，从而在采集终端中得到对应的地址表，如图1所示，本发明在采集终端和N个节点之间还额外设置了N个电流检测芯片，每个节点的电源线上带有一个电流检测芯片，用于检测经过此节点处的并联电流大小。具体的，采集终端的电源输出为恒压源，N个电流检测芯片依次串联设置在通用的电源线上，电流检测芯片1设置在采集终端和第1个节点之间的电源线上，对于后续的电流检测芯片，电流检测芯片i设置在第i-1个节点和第i个节点之间的电源线上，i取值为2~N；此外，电流检测芯片1~N分别与对应的第1-N个节点的控制口通信连接，从而通过iic或者SPI等方式与对应节点上的单片机等处理器芯片进行通讯，节点的处理器芯片则通过该控制口实时读取电流检测芯片采集的电流数据。值得一提的是，因为采集终端的电源输出为恒压源，为了保证每个并联子节点的工作电压一致，故根据电路中的并联分流原理，节点1处的电流检测芯片1采集的电流最大，节点N处的电流检测芯片N采集的电流最小，此时电流检测芯片1~N采集的是从大到小的节点并联电流。例如，对于10个电阻和功耗等参数完全相同的节点，在每个节点的电流4mA时，电流检测芯片1检测的是10个节点并联的总电流40mA，最后一个电流检测芯片1检测的则是最后一个节点N自身的电流4mA。此外，对于单个电流检测芯片的检测精度，只需其大于等于单个节点的电流值即可。除了以上的硬件改进以外，本发明还配合系统上的改进新设计了一种基于电流检测的阵列式位移计的地址自动分配和/或自动排序方法，其分别对应于实施例一和实施例二，两者的工作原理总结来说就是使用特定位置的电流检测芯片，利用经过各节点电源线的电流大小不同进行判定，随着节点离终端越远，节点经过的并联电流越小，在节点1处电流最大，节点N处电流最小，以此电流值排序做到区分N个节点，从而通过对阵列式位移计的地址进行自动分配和/或者排序来提高测量工作的自动化程度，减少测量准备的工作量。实施例一参见图2所示，在图1的基础上，本发明公开了一种基于电流检测的阵列式位移计的地址自动分配方法，各节点的EEPROM中提前存有单个节点的标准电流a，以用于计算地址，地址自动分配方法具体包括以下步骤：步骤1.1：系统上电后，确保采集终端和各节点的供电通讯正常。步骤1.2：发送节点总数N和自动分配地址指令至采集终端，采集终端进入自动分配地址流程。具体的，采集终端进入自动分配地址流程后，暂停其它与地址分配流程无关的工作，以保证在自动分配地址期间所采集的节点数据不会发生错乱。具体的，节点总数可根据提前统计设为N个，节点总数N的输入设备可以为远程监控用的上位机，上位机与采集终端之间可以采用4G等无线方式通信连接。此外，采集终端中的地址表为反映各节点有序串联连接的地址存储表，其内存有各个节点的访问地址，使用地址表可计算出后续每个节点以首节点作为坐标系的相对位置，因为阵列式位移计的各个节点连接和数量在发生改变后，需要通过后续的地址自动分配或者地址自动排序重新得到新的地址表。步骤1.3：采集终端发送自动分配地址指令和节点总数N到各节点。步骤1.4：接收到自动分配地址指令后，各节点进入地址分配模式，各节点关闭无关的外设模块，并通过各节点处的电流检测芯片多次采集流经电流，得到平均电流值bj，下标j取值为1~N。步骤1.5：各节点自行计算自身地址，各节点根据采集的平均电流值bj、节点总数N以及所存储的单个节点的标准电流a综合计算出各个节点的地址Kj=+1)，并将地址Kj修改为节点自身的地址，round函数为对x保留0位小数四舍五入取整。具体的，在各节点自行计算地址时，假设第j节采集到的平均电流值为 bj ，则第j节点的地址Kj为+1)，其中round函数表示对x保留0位小数四舍五入取整，a为各个节点的EEPROM中存储的单个节点的标准电流值，在电流检测芯片工作正常且电源线与节点正常连接时，此时第j个节点的地址Kj则应该正好为节点编号j。还需要指出的是，之所以设置取整函数round，主要是由于电流检测芯片滤波采集的平均电流值b存在一定小范围的误差，故应该进行归整处理，归整方法为范围设定，在既定整数范围内取整处理，再将此值作为地址修改到节点中。具体的，步骤1.6是在各个节点并行执行完步骤1.5以后再执行的程序，而每个节点的数据不同导致处理时间有一定差异，故步骤1.5的执行时间可以设置为满足预设阈值的时长后再执行步骤1.6，比如预设阈值可设置为80ms，以保证每个节点在正常情况下都能将各自的节点地址Kj计算和地址修改工作都执行完毕。步骤1.6：采集终端从1开始依次读取各节点的地址，再对比可通讯的地址最大值M与输入的节点总数N是否相等，若相等，则表示地址分配总数正确，执行下一步骤1.7，若不相等，则退出地址分配程序并提示地址自动分配异常。具体的，步骤1.6中，可通讯的地址最大值M具体可为采集终端从1开始依次读取各节点的地址过程中连续通信握手成功的总次数，例如有30个节点，即N为30时，在验证完第9个节点的地址9以后，需要按照顺序验证第10个节点的地址10，如果第10个节点发生异常，则在采集终端读取该节点的地址10时，则返回通信握手失败的信息，无通信成功的信息返回到采集终端，此时地址的可通讯的地址最大值M则为9，即表示只有第1~9个节点地址分配成功，而因为可通讯的地址最大值9与输入的节点总数30不相等，则退出程序并在上位机监控界面中提示地址自动分配异常。正常情况下，可通讯的地址最大值30与输入的节点总数30是相等的，并且在正常情况下顺序验证不存在的地址31时，必然会出现无法通信成功的情况，如此就将可通讯的地址最大值M最终确定为30，故通过该步骤1.6能够很好地复核校验各个节点的地址是否自动分配成功。步骤1.7：采集终端将地址1~N依次顺序保存到地址表中。在步骤1.6中确认节点i的地址被成功强制分配为对应的节点编号i后，各个节点的顺序编号实际上就是其访问地址了，此时只需在采集终端中将地址1~N依次顺序保存到新建立的地址表中，从而与N个串联的节点一一对应，即可利用该地址表测得第1~N个节点的三轴位移数据。由此可知，上述的地址自动分配方法的工作原理总结来说是通过各节点分别检测电流大小，由于单个节点的电路板功耗和电学参数基本相同，因此可以通过设置对应的电流检测芯片检测各节点并联的实际电流值，最终根据节点上流经的实际并联电流大小确定当前节点处于总线上的位置来修改自身的地址，得到按照节点顺序编号的地址值和地址表，且由于本发明主要利用各个节点的数据处理功能来分别自行计算和修改自身的地址值，故其数据并行处理方式的速度较快，能够很好地适应节点数量较大的地址自动分配工作。此外，在自动分配地址前，采集终端实际上无需知道挂载在此采集终端下的各节点地址，只需在自动分配前输入节点总数N即可，从而利于阵列式位移计的新建节点、增加节点、插入节点、更换节点和拼接节点等操作。实施例二本发明在以上实施例一中，给出了通过重新自动分配连续编号的地址得到具备节点连接顺序信息的地址表以减少测量准备工作量的方案，其节点对应的地址值与节点的编号一致。然而，在额外插入节点、自由拼接节点段或者自由增减某些节点时，可能出于重复利用节点段的需求不便于重新分配和强行修改各个节点的地址，且也可能不便提前于统计所有串联节点的总数量，故此时还可以使用本发明实施例二所对应的地址自动排序方法，从而得到无需存储地址连续化的顺序性地址表，以减少测量准备的工作量。需要指出的是，本发明实施例二地址自动排序方法的前提是各节点的地址已经在采集终端中存在或者录入，即各节点已经自动分配了地址或者各节点地址已经手动录入采集终端，且地址自动分配方法既可以是实施例一中的连续地址分配方法，也可以是其它的乱序地址分配方法。参见图3所示，与实施例一类似，在图1的系统硬件改进基础上，本发明中公开了一种基于电流检测的阵列式位移计的地址自动排序方法，具体包括：步骤2.1：系统上电后，确保采集终端和各节点的供电通讯正常。步骤2.2：发送自动排序指令到采集终端，采集终端进入地址自动排序流程。具体的，采集终端进入地址自动排序流程后，暂停其它与地址排序流程无关的数据上传和采集等工作，以保证在地址自动排序期间所采集的节点数据不会发生错乱。且发送自动排序指令到采集终端的设备可以为上位机，上位机可与采集终端远程通过4G等方式无线通信连接。步骤2.3：采集终端通过通讯线向所有节点发送自动排序指令。步骤2.4：各个节点在接收到自动排序指令后，关闭无关的外设模块，并通过电流检测芯片多次采集对应节点的流经电流，计算得到节点的平均电流值bj。具体的，此处关闭加速度采集芯片、关闭无关的外设模块主要是为了避免电流存在波动，使得每个节点正常工作；在计算平均电流值bj时，需要对进行多次采集和滤波平均等操作，以保证测量的值尽可能准确。此外，将平均电流值bj保存在节点处理芯片的对应寄存器中，等待采集终端对其进行读取。步骤2.5：采集终端等待一定时间后，通过已经存储在系统内的节点地址ej向各节点逐个发送获取电流值指令，j为1~N，各个节点则将平均电流值bj发送给采集终端，采集终端中将各个节点的平均电流值bj与节点地址ej一一对应，再通过对平均电流值bj带节点地址ej进行从大到小的排序，更新得到各个节点地址ej的顺序地址表，并保存顺序地址表。具体的，在步骤2.5中，当前节点的节点地址ej实际上是对应的当前节点已经被采集终端写入分配过的地址或者录入过的默认地址，此时采集终端内已经录入各个节点地址ej的旧地址表实际上无法反映各个节点的物理串联连接顺序，故需要根据电流的客观大小重新进行排序，从而得到物理关系上串联的各节点之间的顺序关系。参见图1可知，平均电流值bj最大的电流对应第1个节点，平均电流值bj最小的电流对应最后一个节点N。此外，为了得到各个串联的节点的物理连接顺序，上传到采集终端的节点地址ej与平均电流值bj在采集终端内是一一对应存储的，从而与平均电流值bj一起参与到后续的地址自动排序工作中，而采集终端会对采集到的所有平均电流值带节点地址的进行从大到小的依次排序，最终利用冒泡等排序法快速整理得到新的顺序地址表，顺序地址表根据电流的客观大小映射出节点1~N的物理连接顺序。还需要指出的是，因为排序方法缺乏先验的节点总个数的信息，平均电流值bj的个数无法与实际的节点总数进行复核校验，即采集终端只会对已经提前录入系统中的N个节点进行排序，并将所有采集的平均电流值bj和节点地址ej两者视为一组关联数据进行存储。另外，本发明的地址排序方法只需电流检测芯检测出各个节点处的电流平均值的相对大小即可，故对电流检测芯片的检测精度要求不高。由此可知，与地址自动分配方法类似，上述的地址自动排序方法也是通过各节点分别检测电流大小，并通过设置对应的电流检测芯片检测各节点并联的实际电流值，最终根据节点上流经的实际并联电流大小，从而通过变量映射和电流值排序得到反映各节点之间的物理串联顺序关系的顺序地址表，最终利用其进行阵列式位移计的三维数据的测量采集。综上可知，对于本发明中基于电流检测的阵列式位移计的地址自动分配方法和排序方法，两者既可以分别独立运行，从而利用各自得到与节点排序一致的顺序性的地址表解决减少测量准备的工作量，两者也可以相互配合使用，从而对节点地址进行有序分配和有序排序。最后说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
