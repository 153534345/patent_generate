标题title
基于eUICC的码号变更方法、SM-SR及可读存储介质
摘要abst
本发明提供一种基于eUICC的码号变更方法、SM‑SR及可读存储介质，该方法包括：接收发起者发送的码号切换命令；根据码号切换命令判断是否需要向第二ICCID对应的第二运营商发送码号禁用命令，若是，则向第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二PLMA和/或更新POL2操作；根据码号切换命令判断是否需要向第一ICCID对应的第一运营商发送码号激活命令，若是，则向第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作。该方法、装置及可读存储介质能够解决现有的eUICC码号变更应用落地的一些问题，提高成功率。
权利要求书clms
1.一种基于嵌入式通用集成电路卡eUICC的码号变更方法，其特征在于，所述方法包括：接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二集成电路卡识别码ICCID的第二码号更换为第一ICCID的第一码号；根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作；根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。2.根据权利要求1所述的方法，其特征在于，所述发起者为机器对机器服务提供商M2MSP或其他运营商；所述接收发起者发送的码号切换命令，具体包括：接收所述M2M SP或其他运营商通过ES4接口发送的所述码号切换命令。3.根据权利要求2所述的方法，其特征在于，所述接收发起者发送的码号切换命令之后，所述方法还包括：根据所述码号切换命令判断是否满足预先设置的第一初始条件，所述第一初始条件包括以下任意一个或多个：所述eUICC归属自己管理；所述第一ICCID对应的第一Profile已被加载到所述eUICC上；所述第一Profile处于禁用状态；若所述码号切换命令不满足预先设置的第一初始条件，则向所述发起者发送命令执行失败响应。4.根据权利要求1所述的方法，其特征在于，所述根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，具体包括：根据所述码号切换命令判断是否满足预先设置的第二初始条件，所述第二初始条件包括：所述第二ICCID对应的第二Profile由授予第二PLMA的第二运营商所拥有，且发起者获得所述第二PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第二Profile的第二POL2允许本次码号激活操作；若根据所述码号切换命令判断不满足预先设置的第二初始条件，则确定需要向所述第二运营商发送码号禁用命令。5.根据权利要求4所述的方法，其特征在于，所述向所述第二运营商发送码号禁用命令，具体包括：向所述第二运营商发送携带有eUICC标识EID、第二ICCID以及发起者标识的码号禁用命令，以使所述第二运营商根据所述EID、第二ICCID以及发起者标识判断所述码号禁用命令是否可接受；所述根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作，具体包括：接收所述第二运营商在判断出所述码号禁用命令可接受时返回的所述码号禁用命令响应；根据所述码号禁用命令响应进行设置第二PLMA和/或更新第二POL2操作。6.根据权利要求1所述的方法，其特征在于，所述根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，具体包括：根据所述码号切换命令判断是否满足预先设置的第三初始条件，所述第三初始条件包括：所述第一ICCID对应的第一Profile由授予第一PLMA的第一运营商所拥有，且发起者获得所述第一PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第一Profile的第一POL2允许本次码号激活操作；若根据所述码号切换命令判断不满足预先设置的第三初始条件，则确定需要向所述第一运营商发送码号激活命令。7.根据权利要求6所述的方法，其特征在于，所述向所述第一运营商发送码号激活命令，具体包括：向所述第一运营商发送携带有EID、第一ICCID以及发起者标识的码号激活命令，以使所述第一运营商根据所述EID、第一ICCID以及发起者标识判断所述码号激活命令是否可接受；所述根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作，具体包括：接收所述第一运营商在判断出所述码号激活命令可接受时返回的所述码号激活命令响应；根据所述码号激活命令响应进行设置第二PLMA和/或更新第二POL2操作。8.根据权利要求4所述的方法，其特征在于，所述向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程之后，所述方法还包括：如果所述第二Profile的第二POL2指示其禁用，则向所述第二运营商发送删除命令，以使所述第二运营商删除所述第二Profile。9.根据权利要求1所述的方法，其特征在于，所述向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程之后，所述方法还包括：接收所述ISD-R返回的响应信息；根据所述响应信息更新所述eUICC的eUICC信息集EIS；向所述发起者反馈所述码号切换命令的执行结果。10.一种签约关系管理平台安全路由网元SM-SR，其特征在于，包括：码号切换命令接收模块，用于接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号；码号禁用判断模块，与所述码号切换命令接收模块连接，用于根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作；码号激活判断模块，与所述码号切换命令接收模块连接，用于根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；码号变更模块，与所述码号禁用判断模块以及所述码号激活判断模块连接，用于向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。11.一种签约关系管理平台安全路由网元SM-SR，其特征在于，包括存储器和处理器，所述存储器中存储有计算机程序，所述处理器被设置为运行所述计算机程序以实现如权利要求1-9中任一项所述的基于eUICC的码号变更方法。12.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1-9中任一项所述的基于eUICC的码号变更方法。
说明书desc
技术领域本发明涉及eUICC技术领域，尤其涉及一种基于eUICC的码号变更方法、SM-SR及可读存储介质。背景技术eUICC作为一种新型的终端接入运营商网络的鉴权工具，以及承载各种应用、数据的安全载体，已经成为5G时代移动通信系统的重要组成部件之一。eUICC的远程管理意味着突破了传统的由运营商管控的UICC线性流程管理，可能导致运营商迁移，其用户关系管理前所未有的复杂和灵活，对现有安全机制产生重大影响。eUICC的技术特征使得物联网应用得以灵活开展，典型应用场景如设置车联网应用的漫游号码，当车辆漫游至新地区时，车联网业务提供商可根据需求申请远程变更车机中的号码为本地号码等。目前，全球已有多家运营商支持eUICC，覆盖多个国家和地区，其中，在我国也已经开展了相关业务；但在实际测试和应用中，由于eUICC技术涉及多个平台交互，包括终端系统、远程配置管理平台、各地区运营商系统等，相比传统SIM卡，eUICC业务提供的线上、线下的实时开通、暂停、注销等服务也更复杂，标准的eUICC技术流程如码号变更这种最常见的应用需求，在实际落地应用中可能出现问题多、定位慢等问题，导致商用维护难度加大，用户体验较差。发明内容本发明所要解决的技术问题是针对现有技术的上述不足，提供一种基于eUICC的码号变更方法、SM-SR及可读存储介质，用以提高eUICC码号变更应用落地成功率。第一方面，本发明提供一种基于eUICC的码号变更方法，所述方法包括：接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二集成电路卡识别码ICCID的第二码号更换为第一ICCID的第一码号；根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作；根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。进一步地，所述发起者为机器对机器服务提供商M2M SP或其他运营商；所述接收发起者发送的码号切换命令，具体包括：接收所述M2M SP或其他运营商通过ES4接口发送的所述码号切换命令。进一步地，所述接收发起者发送的码号切换命令之后，所述方法还包括：根据所述码号切换命令判断是否满足预先设置的第一初始条件，所述第一初始条件包括以下任意一个或多个：所述eUICC归属自己管理；所述第一ICCID对应的第一Profile已被加载到所述eUICC上；所述第一Profile处于禁用状态；若所述码号切换命令不满足预先设置的第一初始条件，则向所述发起者发送命令执行失败响应。进一步地，所述根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，具体包括：根据所述码号切换命令判断是否满足预先设置的第二初始条件，所述第二初始条件包括：所述第二ICCID对应的第二Profile由授予第二PLMA的第二运营商所拥有，且发起者获得所述第二PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第二Profile的第二POL2允许本次码号激活操作；若根据所述码号切换命令判断不满足预先设置的第二初始条件，则确定需要向所述第二运营商发送码号禁用命令。进一步地，所述向所述第二运营商发送码号禁用命令，具体包括：向所述第二运营商发送携带有eUICC标识EID、第二ICCID以及发起者标识的码号禁用命令，以使所述第二运营商根据所述EID、第二ICCID以及发起者标识判断所述码号禁用命令是否可接受；所述根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作，具体包括：接收所述第二运营商在判断出所述码号禁用命令可接受时返回的所述码号禁用命令响应；根据所述码号禁用命令响应进行设置第二PLMA和/或更新第二POL2操作。进一步地，所述根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，具体包括：根据所述码号切换命令判断是否满足预先设置的第三初始条件，所述第三初始条件包括：所述第一ICCID对应的第一Profile由授予第一PLMA的第一运营商所拥有，且发起者获得所述第一PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第一Profile的第一POL2允许本次码号激活操作；若根据所述码号切换命令判断不满足预先设置的第三初始条件，则确定需要向所述第一运营商发送码号激活命令。进一步地，所述向所述第一运营商发送码号激活命令，具体包括：向所述第一运营商发送携带有EID、第一ICCID以及发起者标识的码号激活命令，以使所述第一运营商根据所述EID、第一ICCID以及发起者标识判断所述码号激活命令是否可接受；所述根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作，具体包括：接收所述第一运营商在判断出所述码号激活命令可接受时返回的所述码号激活命令响应；根据所述码号激活命令响应进行设置第二PLMA和/或更新第二POL2操作。进一步地，所述向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程之后，所述方法还包括：如果所述第二Profile的第二POL2指示其禁用，则向所述第二运营商发送删除命令，以使所述第二运营商删除所述第二Profile。进一步地，所述向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程之后，所述方法还包括：接收所述ISD-R返回的响应信息；根据所述响应信息更新所述eUICC的eUICC信息集EIS；向所述发起者反馈所述码号切换命令的执行结果。第二方面，本发明提供一种SM-SR，包括：码号切换命令接收模块，用于接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号；码号禁用判断模块，与所述码号切换命令接收模块连接，用于根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作；码号激活判断模块，与所述码号切换命令接收模块连接，用于根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；码号变更模块，与所述码号禁用判断模块以及所述码号激活判断模块连接，用于向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。第三方面，本发明提供一种SM-SR，包括存储器和处理器，所述存储器中存储有计算机程序，所述处理器被设置为运行所述计算机程序以实现上述第一方面所述的基于eUICC的码号变更方法。第四方面，本发明提供一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现上述第一方面所述的基于eUICC的码号变更方法。本发明提供的基于eUICC的码号变更方法、SM-SR及可读存储介质。首先接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号；然后根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二PLMA和/或更新第二POL2操作；以及根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；最后向所述eUICC中的ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。本发明从技术标准落地的实际出发，能够提高eUICC码号变更应用落地成功率，解决了现有的eUICC码号变更应用落地存在问题多、定位慢等问题。附图说明图1为本发明实施例1的一种基于eUICC的码号变更方法的流程图；图2为本发明实施例的一种基于eUICC的码号变更方法的交互示意图；图3为本发明实施例2的一种SM-SR的结构示意图；图4为本发明实施例3的一种SM-SR的结构示意图。具体实施方式为使本领域技术人员更好地理解本发明的技术方案，下面将结合附图对本发明实施方式作进一步地详细描述。可以理解的是，此处描述的具体实施例和附图仅仅用于解释本发明，而非对本发明的限定。可以理解的是，在不冲突的情况下，本发明中的各实施例及实施例中的各特征可相互组合。可以理解的是，为便于描述，本发明的附图中仅示出了与本发明相关的部分，而与本发明无关的部分未在附图中示出。可以理解的是，本发明的实施例中所涉及的每个单元、模块可仅对应一个实体结构，也可由多个实体结构组成，或者，多个单元、模块也可集成为一个实体结构。可以理解的是，在不冲突的情况下，本发明的流程图和框图中所标注的功能、步骤可按照不同于附图中所标注的顺序发生。可以理解的是，本发明的流程图和框图中，示出了按照本发明各实施例的系统、装置、设备、方法的可能实现的体系架构、功能和操作。其中，流程图或框图中的每个方框可代表一个单元、模块、程序段、代码，其包含用于实现规定的功能的可执行命令。而且，框图和流程图中的每个方框或方框的组合，可用实现规定的功能的基于硬件的系统实现，也可用硬件与计算机命令的组合来实现。可以理解的是，本发明实施例中所涉及的单元、模块可通过软件的方式实现，也可通过硬件的方式来实现，例如单元、模块可位于处理器中。实施例1：本实施例提供一种基于eUICC的码号变更方法，如图1所示，该方法包括：步骤S101：接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。需要说明的是，为了解决eUICC技术实际应用中的问题，本发明针对eUICC技术最常见的应用需求——码号变更，基于eUICC技术标准提出一种技术方案，旨在解决技术落地的实际问题，减轻后期商用维护难度，提升用户体验，便于产品推广，本发明系统架构遵循eUICC标准体系架构。在本实施例中，发起者为M2M SP或其他MNO，发起者与SM-SR直接连接，通过ES4接口进行交互，eUICC上已下载并安装对应的码号配置文档，具体地，M2M SP或其他MNO向SM-SR发送码号切换命令ChangeProfile，以用于请求将ICCID2标识的码号2更换为ICCID1标识的码号1，SM-SR接收所述M2M SP或其他运营商通过ES4接口发送的所述码号切换命令。在本实施例中，ChangeProfile命令的定义如下：功能名称：ChangeProfile发起方：运营商或M2M-SP被调方：SM-SR描述：本命令允许发起方请求被调方切换目标eUICC中的Profile1为Profile2，Profile1由运营商1拥有，Profile2由运营商2拥有。具体地，ChangeProfile命令的输入数据可以如表1所示，输出数据可以如表2所示。表1：ChangeProfile命令的输入数据表2：ChangeProfile命令的输出数据具体地，ChangeProfile命令消息可能返回：“Function execution status”为“Executed-success”表示命令已经成功完成，已在eUICC上启用新的配置文档。“Function execution status”为“Expired”表示命令执行超过有效期；“Function execution status”为“Failed”表示命令执行失败，除标准定义通用状态码，其他特别状态码如表3所示。表3：ChangeProfile命令的特别状态码/＞可选地，所述接收发起者发送的码号切换命令之后，所述方法还包括：根据所述码号切换命令判断是否满足预先设置的第一初始条件，所述第一初始条件包括以下任意一个或多个：所述eUICC归属自己管理；所述第一ICCID对应的第一Profile已被加载到所述eUICC上；所述第一Profile处于禁用状态；若所述码号切换命令不满足预先设置的第一初始条件，则向所述发起者发送命令执行失败响应。在本实施例中，SM-SR接收到码号切换命令后，可以根据所述码号切换命令判断是否满足预先设置的第一初始条件，所述第一初始条件优选包括以下三项：所述eUICC归属自己管理；所述第一ICCID对应的第一Profile已被加载到所述eUICC上；所述第一Profile处于禁用状态；若所述码号切换命令不满足预先设置的第一初始条件，则向所述发起者发送命令执行失败响应，即若该eUICC不归属自己管理，或者第一ICCID对应的第一Profile没有被加载到所述eUICC上，或者第一Profile不处于禁用状态，则SM-SR向发起者发送命令执行失败响应，其中可以携带相应的通用或特别状态码。步骤S102：根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二PLMA和/或更新第二策略规则POL2操作。在本实施例中，PLMA是运营商向发起者授予的授权，以允许配置文件生命周期管理。POL指策略规则，POL1位于配置文件中，POL2策略规则与配置文件关联并存储在SM-SR的相关EIS中。在本实施例中，SM-SR可以根据码号切换命令判断是否满足预先设置的第二初始条件，所述第二初始条件包括：所述第二ICCID对应的第二Profile由授予第二PLMA的第二运营商所拥有，且发起者获得所述第二PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第二Profile的第二POL2允许本次码号激活操作；若根据所述码号切换命令判断不满足预先设置的第二初始条件，则确定需要向所述第二运营商发送码号禁用命令。若根据所述码号切换命令判断满足预先设置的第二初始条件，则直接跳过此步骤。可选地，所述向所述第二运营商发送码号禁用命令，具体包括：向所述第二运营商发送携带有eUICC标识EID、第二ICCID以及发起者标识的码号禁用命令，以使所述第二运营商根据所述EID、第二ICCID以及发起者标识判断所述码号禁用命令是否可接受；所述根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作，具体包括：接收所述第二运营商在判断出所述码号禁用命令可接受时返回的所述码号禁用命令响应；根据所述码号禁用命令响应进行设置第二PLMA和/或更新第二POL2操作。在本实施例中，如果第二初始条件满足，SM-SR向第二运营商发送码号禁用命令ProfileDisableRequest，第二运营商收到码号禁用命令后，确认该命令是否可接受，具体检查规则依据运营商具体业务及管理要求，在本方案中不作限定，如检查用户合约、费用情况等。如果第二运营商通过该命令，向SM-SR反馈该码号禁用命令响应ProfileDisableRequest response，其中携带更新PLMA和/或POL2命令。SM-SR根据收到的命令进行设置PLMA和/或更新POL2操作。需要说明的是，如果第二运营商确定该命令不可接受，则向SM-SR反馈一个包含拒绝消息的码号禁用命令响应；SM-SR收到后向发起者返回一个表明失败的响应，指示该流程应结束。在本实施例中，ProfileDisableRequest命令的定义如下：功能名称：ProfileDisableRequest发起方：SM-SR被调方：运营商描述：本命令由发起方向被调方请求码号禁用确认。具体地，ProfileDisableRequest命令的输入数据可以如表4所示，输出数据可以如表5所示。表4：ProfileDisableRequest命令的输入数据表5：ProfileDisableRequest命令的输出数据具体地，ProfileDisableRequest命令消息可能返回：“Function execution status”为“Executed-success”表示命令已经成功完成，返回待更新的POL2和PLMA；“Function execution status”为“Expired”表示命令执行超过有效期；“Function execution status”为“Failed”表示命令执行失败，除标准定义通用状态码，其他状态码如表6。表6：ProfileDisableRequest命令的特别状态码在本实施例中，SM-SR进行设置PLMA和/或更新POL2操作之后，根据设置与更新结果，可以向第二运营商发送更新结果HandleRulesUpdateNotification，以及根据发起者获得授权的情况，可以向发起者反馈更新结果HandleRulesUpdateNotification。具体地，HandleRulesUpdateNotification命令的定义如下：功能名称：HandleRulesUpdateNotification发起方：SM-SR接收方：M2M-SP或运营商具体地，HandleRulesUpdateNotification命令的输入数据可以如表7所示。表7：HandleRulesUpdateNotification命令的输入数据步骤S103：根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作。在本实施例中，SM-SR可以根据码号切换命令判断是否满足预先设置的第三初始条件，所述第三初始条件包括：所述第一ICCID对应的第一Profile由授予第一PLMA的第一运营商所拥有，且发起者获得所述第一PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第一Profile的第一POL2允许本次码号激活操作；若根据所述码号切换命令判断不满足预先设置的第三初始条件，则确定需要向所述第一运营商发送码号激活命令。若根据所述码号切换命令判断满足预先设置的第三初始条件，则直接跳过此步骤。可选地，所述向所述第一运营商发送码号激活命令，具体包括：向所述第一运营商发送携带有EID、第一ICCID以及发起者标识的码号激活命令，以使所述第一运营商根据所述EID、第一ICCID以及发起者标识判断所述码号激活命令是否可接受；所述根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作，具体包括：接收所述第一运营商在判断出所述码号激活命令可接受时返回的所述码号激活命令响应；根据所述码号激活命令响应进行设置第二PLMA和/或更新第二POL2操作。在本实施例中，如果第三初始条件满足，SM-SR向第一运营商发送码号激活命令ProfileEnableRequest，第一运营商收到码号激活命令后，确认该命令是否可接受，具体检查细则在本方案中不作限定，如确认发起者授权情况，该号码服务协议等。如果第一运营商通过该命令，向SM-SR反馈码号激活命令响应ProfileEnableRequest response，其中携带更新PLMA和/或POL2命令。SM-SR根据收到的消息进行设置PLMA和/或更新POL2操作。需要说明的是，如果第一运营商确定该命令不可接受，则向SM-SR反馈一个包含拒绝消息的码号激活命令响应；SM-SR收到后向发起者返回一个表明失败的响应，指示该流程应结束。需要说明的是，本发明从技术标准落地的实际出发，由运营商系统进行实时审核与授权，能够解决现有由于策略规则和授权不足或错误而导致的变更失败或错误等问题，相较于技术标准能进一步满足实际应用的需求。在本实施例中，ProfileEnableRequest命令的定义如下：功能名称：ProfileEnableRequest发起方：SM-SR被调方：运营商描述：本命令由发起方向被调方请求码号激活确认。具体地，ProfileEnableRequest命令的输入数据可以如表8所示，输出数据可以如表9所示。表8：ProfileEnableRequest命令的输入数据/＞表9：ProfileEnableRequest命令的输出数据具体地，ProfileEnableRequest命令消息可能返回：“Function execution status”为“Executed-success”表示命令已经成功完成，返回待更新的POL2和PLMA；“Function execution status”为“Expired”表示命令执行超过有效期；“Function execution status”为“Failed”表示命令执行失败，除标准定义通用状态码，其他状态码如表10。表10：ProfileEnableRequest命令的特别状态码在本实施例中，SM-SR进行设置PLMA和/或更新POL2操作之后，根据设置与更新结果，可以向第一运营商发送更新结果HandleRulesUpdateNotification，以及根据发起者获得授权的情况，可以向发起者反馈更新结果HandleRulesUpdateNotification。步骤S104：向所述eUICC中的ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。在本实施例中，SM-SR根据第一运营商及第二运营商的反馈结果，确认第一ICCID标识的码号归属于第一运营商，并且发起者已通过PLMA取得了“EnableProfile”操作授权，并且第一ICCID和第二ICCID标识的码号的POL2都允许本次码号更换操作，SM-SR向ISD-R发送包含用于启用第一Profile的“ES5.STORE DATA”命令的消息，发起激活第一profile的流程。需要说明的是，eUICC中除了包括ISD-R外，还包括ECASD、ISD-P、MNO-SD等。可选地，所述向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程之后，所述方法还包括：如果所述第二Profile的第二POL2指示其禁用，则向所述第二运营商发送删除命令，以使所述第二运营商删除所述第二Profile。在本实施例中，码号切换后如果第二Profile的第二POL2指示其禁用时第二Profile应被删除，则SM-SR继续发起删除操作，并根据执行情况返回指示执行结果的响应消息。可选地，所述向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程之后，所述方法还包括：接收所述ISD-R返回的响应信息；根据所述响应信息更新所述eUICC的eUICC信息集EIS；向所述发起者反馈所述码号切换命令的执行结果。在本实施例中，成功执行上述流程后，SM-SR根据执行的序列和eUICC响应更新EIS，向发起者反馈ChangeProfile结果，指示将已将第二ICCID标识的第二码号更换为第一ICCID标识的第一码号，第二码号已被禁用。此外，还可以向第一运营商反馈第一Profile已被启用，向第二运营商反馈第二Profile已被禁用及是否被成功删除。具体地，参考图2，示出了本发明实施例提供的一种基于eUICC的码号变更方法的交互示意图，需要说明的是，在该流程启用之前在eUICC上已下载并安装对应的码号配置文档，该流程由第三方发起者启动，其中，发起者为取得授权的M2M-SP或其他运营商，发起者与SM-SR直接连接，通过ES4接口进行交互，该流程不限定SM-SR和eUICC之间可能的传输协议，在本实施例中，该基于eUICC的码号变更方法的交互示意图包括如下步骤：步骤S01：发起者向SM-SR发送码号切换命令ChangeProfile，以用于请求将ICCID2标识的码号2更换为ICCID1标识的码号1。步骤S02：SM-SR检查初始条件，确认该命令是否可以接受。如果不满足初始条件，则SM-SR应返回失败消息，结束本流程。初始条件主要检查确认：a)SM-SR是否负责管理该eUICC。b)由其ICCID识别的目标Profile是否已被加载到该eUICC上。c)目标profile是否处于禁用状态。d)目标Profile由授予PLMA的运营商所拥有，发起者获得的PLMA授权是否允许其对该eUICC执行本次码号激活操作。e)目标profile的POL2允许本次码号激活操作。f)当前启用的Profile由授予PLMA的运营商所拥有，发起者获得的PLMA授权是否允许其对该eUICC执行本次码号激活操作。g)当前启用的profile的POL2是否允许本次码号激活操作。其中，如果要验证的初始条件全部满足，则该流程应在步骤S18继续进行；如果a、b、c中的任意一条没有得到满足，SM-SR应返回一个表明失败的响应，指示该流程应结束；如果条件d和/或e不满足，则该流程转到步骤S03继续进行；如果仅有条件f和/或g不满足，则该流程转到步骤S10继续进行。步骤S03：SM-SR向运营商2发送码号禁用命令ProfileDisableRequest。步骤S04：运营商2收到码号禁用命令后，确认该命令是否可接受，具体检查规则依据运营商具体业务及管理要求，在本方案中不作限定，如检查用户合约、费用情况等。步骤S05：如果运营商2通过该命令，向SM-SR反馈该码号禁用命令响应ProfileDisableRequest response，其中携带更新PLMA和/或POL2命令。需要说明的是，如果运营商2确定该命令不可接受，则向SM-SR反馈一个包含拒绝消息的码号禁用命令响应；SM-SR收到后向发起者返回一个表明失败的响应，指示该流程应结束。步骤S06：SM-SR根据收到的命令进行设置PLMA和/或更新POL2操作。步骤S07：根据设置与更新结果，SM-SR向运营商2发送更新结果HandleRulesUpdateNotification。步骤S08：根据设置与更新结果及发起者获得授权的情况，SM-SR向发起者反馈更新结果HandleRulesUpdateNotification。步骤S09：运营商2也可以根据其业务与管理规则同时更新POL1，该流程为可选。步骤S10：SM-SR向运营商1发送码号激活命令ProfileEnableRequest。步骤S11：运营商1收到码号激活命令后，确认该命令是否可接受，具体检查细则在本方案中不作限定，如确认发起者授权情况，该号码服务协议等。步骤S12：如果运营商1通过该命令，向SM-SR反馈该码号激活命令响应ProfileEnableRequest response，其中携带更新PLMA和/或POL2命令。需要说明的是，如果运营商1确定该命令不可接受，则向SM-SR反馈一个包含拒绝消息的码号激活命令响应；SM-SR收到后向发起者返回一个表明失败的响应，指示该流程应结束。步骤S13：SM-SR根据收到的消息进行设置PLMA和/或更新POL2操作。步骤S14：根据设置与更新结果，SM-SR向运营商1发送更新结果HandleRulesUpdateNotification。步骤S15：根据设置与更新结果，及发起者获得授权的情况，SM-SR向发起者反馈更新结果HandleRulesUpdateNotification。步骤S16：SM-SR向ISD-R发送包含用于启用Profile1的“ES5.STORE DATA”命令的消息，发起激活profile1的流程。具体地，SM-SR根据运营商1及运营商2的反馈结果，确认ICCID1标识的码号归属于运营商1，并且发起者已通过PLMA取得了“EnableProfile”操作授权，并且ICCID1和ICCID2标识的码号的POL2都允许本次码号更换操作，SM-SR向ISD-R发送包含用于启用Profile1的“ES5.STORE DATA”命令的消息，发起激活profile1的流程。需要说明的是，eUICC中除了包括ISD-R外，还包括ECASD、ISD-P、MNO-SD等。在本实施例中，码号切换后如果Profile2的POL2指示其禁用时Profile应被删除，则SM-SR继续发起删除操作，并根据执行情况返回指示执行结果的响应消息。在本实施例中，成功执行上述流程后，SM-SR根据执行的序列和eUICC响应更新EIS。需要说明的是，上述流程中任一环节未能成功，则可以通过SM-SR向发起者返回失败消息，并在必要时将卡内码号回滚到profile2。步骤S17：SM-SR向发起者反馈ChangeProfile结果，指示已将ICCID2标识的码号2更换为ICCID1标识的码号1，码号2已被禁用。此外，还可以向运营商1反馈Profile1已被启用，向运营商2反馈Profile2已被禁用及是否被成功删除。本发明实施例提供的基于eUICC的码号变更方法，首先接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号；然后根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二PLMA和/或更新第二POL2操作；以及根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；最后向所述eUICC中的ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。本发明从技术标准落地的实际出发，能够提高eUICC码号变更应用落地成功率，解决了现有的eUICC码号变更应用落地存在问题多、定位慢等问题。实施例2：如图3所示，本实施例提供一种SM-SR，用于执行上述基于eUICC的码号变更方法，包括：码号切换命令接收模块11，用于接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号；码号禁用判断模块12，与所述码号切换命令接收模块11连接，用于根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二配置文件生命周期管理授权PLMA和/或更新第二策略规则POL2操作；码号激活判断模块13，与所述码号切换命令接收模块11连接，用于根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；码号变更模块14，与所述码号禁用判断模块12以及所述码号激活判断模块13连接，用于向所述eUICC中的根安全域ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。可选地，所述发起者为机器对机器服务提供商M2M SP或其他运营商；所述码号切换命令接收模块11具体用于：接收所述M2M SP或其他运营商通过ES4接口发送的所述码号切换命令。可选地，所述SM-SR还包括：第一判断模块，用于根据所述码号切换命令判断是否满足预先设置的第一初始条件，所述第一初始条件包括以下任意一个或多个：所述eUICC归属自己管理；所述第一ICCID对应的第一Profile已被加载到所述eUICC上；所述第一Profile处于禁用状态；第一响应发送模块，用于若所述码号切换命令不满足预先设置的第一初始条件，则向所述发起者发送命令执行失败响应。可选地，所述码号禁用判断模块12包括：第一条件判断单元，用于根据所述码号切换命令判断是否满足预先设置的第二初始条件，所述第二初始条件包括：所述第二ICCID对应的第二Profile由授予第二PLMA的第二运营商所拥有，且发起者获得所述第二PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第二Profile的第二POL2允许本次码号激活操作；第一确定单元，用于若根据所述码号切换命令判断不满足预先设置的第二初始条件，则确定需要向所述第二运营商发送码号禁用命令。可选地，所述码号禁用判断模块12还包括：码号禁用命令发送单元，用于向所述第二运营商发送携带有eUICC标识EID、第二ICCID以及发起者标识的码号禁用命令，以使所述第二运营商根据所述EID、第二ICCID以及发起者标识判断所述码号禁用命令是否可接受；码号禁用命令响应接收单元，用于接收所述第二运营商在判断出所述码号禁用命令可接受时返回的所述码号禁用命令响应；第一设置更新单元，用于根据所述码号禁用命令响应进行设置第二PLMA和/或更新第二POL2操作。可选地，所述码号激活判断模块13包括：第二条件判断单元，用于根据所述码号切换命令判断是否满足预先设置的第三初始条件，所述第三初始条件包括：所述第一ICCID对应的第一Profile由授予第一PLMA的第一运营商所拥有，且发起者获得所述第一PLMA授权以允许所述发起者对所述eUICC执行本次码号激活操作；以及所述第一Profile的第一POL2允许本次码号激活操作；第二确定单元，用于若根据所述码号切换命令判断不满足预先设置的第三初始条件，则确定需要向所述第一运营商发送码号激活命令。可选地，所述码号激活判断模块13还包括：码号激活命令发送单元，用于向所述第一运营商发送携带有EID、第一ICCID以及发起者标识的码号激活命令，以使所述第一运营商根据所述EID、第一ICCID以及发起者标识判断所述码号激活命令是否可接受；码号激活命令响应接收单元，用于接收所述第一运营商在判断出所述码号激活命令可接受时返回的所述码号激活命令响应；第二设置更新单元，用于根据所述码号激活命令响应进行设置第二PLMA和/或更新第二POL2操作。可选地，所述SM-SR还包括：删除命令发送模块，用于如果所述第二Profile的第二POL2指示其禁用，则向所述第二运营商发送删除命令，以使所述第二运营商删除所述第二Profile。可选地，所述SM-SR还包括：响应信息接收模块，用于接收所述ISD-R返回的响应信息；EIS更新模块，用于根据所述响应信息更新所述eUICC的eUICC信息集EIS；执行结果反馈模块，用于向所述发起者反馈所述码号切换命令的执行结果。实施例3：参考图4，本实施例提供一种SM-SR，包括存储器21和处理器22，存储器21中存储有计算机程序，处理器22被设置为运行所述计算机程序以执行实施例1中的基于eUICC的码号变更方法。其中，存储器21与处理器22连接，存储器21可采用闪存或只读存储器或其他存储器，处理器22可采用中央处理器或单片机。实施例4：本实施例提供一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现上述实施例1中的基于eUICC的码号变更方法。该计算机可读存储介质包括在用于存储信息的任何方法或技术中实施的易失性或非易失性、可移除或不可移除的介质。计算机可读存储介质包括但不限于RAM，ROM，EEPROM、闪存或其他存储器技术、CD-ROM，数字多功能盘或其他光盘存储、磁盒、磁带、磁盘存储或其他磁存储装置、或者可以用于存储期望的信息并且可以被计算机访问的任何其他的介质。实施例2至实施例4提供的SM-SR及可读存储介质，首先接收发起者发送的码号切换命令，所述码号切换命令用于请求将eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号；然后根据所述码号切换命令判断是否需要向所述第二ICCID对应的第二运营商发送码号禁用命令，若是，则向所述第二运营商发送码号禁用命令，并根据返回的码号禁用命令响应进行设置第二PLMA和/或更新第二POL2操作；以及根据所述码号切换命令判断是否需要向所述第一ICCID对应的第一运营商发送码号激活命令，若是，则向所述第一运营商发送码号激活命令，并根据返回的码号激活命令响应设置第一PLMA和/或更新第一POL2操作；最后向所述eUICC中的ISD-R发起激活所述第一ICCID对应的第一Profile的流程，以将所述eUICC中第二ICCID的第二码号更换为第一ICCID的第一码号。本发明从技术标准落地的实际出发，能够提高eUICC码号变更应用落地成功率，解决了现有的eUICC码号变更应用落地存在问题多、定位慢等问题。可以理解的是，以上实施方式仅仅是为了说明本发明的原理而采用的示例性实施方式，然而本发明并不局限于此。对于本领域内的普通技术人员而言，在不脱离本发明的精神和实质的情况下，可以做出各种变型和改进，这些变型和改进也视为本发明的保护范围。
