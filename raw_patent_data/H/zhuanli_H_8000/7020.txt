标题title
一种基于深度学习的轻量级车载网络入侵检测方法
摘要abst
一种基于深度学习的轻量级车载网络入侵检测方法，包括对车载网络流量进行数据清洗；对车载网络流量基于时间进行维度转换；划分训练和测试数据集；使用迁移学习和MobileNetV3模型对数据集进行训练和测试；保存效果最好模型部署树莓派在IVN中用于检测异常CAN信息并产生警报。本发明结合迁移学习构建基于可视化和改进的MobileNet模型的轻量级车载网络入侵检测模型，将攻击流量可视化为彩色图；之后通过双线性插值方法扩大图像以增强数据集并防止模型过拟合；为减少参数和训练过程中的资源消耗，对MoblieNet进行改进并使用迁移学习对模型进行微调。本发明能够满足实时检测的需要，适用于低算力平台。
权利要求书clms
1.一种基于深度学习的轻量级车载网络入侵检测方法，其特征在于：首先提出了一种数据转换方式，将车内和车外网络数据以基于时间的块为单位进行采集，接着通过维度变换将一维的攻击数据转换到二维空间，并将其可视化；然后，采用主流的卷积神经网络变体MobileNetV3，结合现在有效的迁移学习方式，通过迁移大模型预训练权重对卷积神经网络进行微调训练；最后，模拟真实环境下低算力平台，验证本方法的有效性；包括以下步骤：步骤1、对车载网络流量进行数据清洗；步骤2、对车载网络流量基于时间进行维度转换；步骤3、划分训练和测试数据集；步骤4、使用迁移学习和MobileNetV3模型对数据集进行训练和测试；步骤5、保存效果最好模型部署树莓派在IVN中用于检测异常CAN信息并产生警报。2.如权利要求1所述的一种基于深度学习的轻量级车载网络入侵检测方法，其特征在于：具体步骤为：步骤1、对数据集进行数据清洗：对于数据位置异常的原始样本归位并将遗漏数据全部置为0，删除数据格式异常的原始样本；步骤2、根据网络流量数据集的时间戳和特征大小将数据样本转换为数据块；Car-Hacking和OTIDS数据集有9个重要特征，将27个连续样本的9个特征：27×9＝243个特征值，转换为形状为9×9×3的三通道图像，采用双线性插值法将9×9×3的图像扩大到224×224×3；采用的线性插值具体如下：首先从x轴方向对先用关于x的单线性插值去分别计算f与f的像素值:再使用关于y方向的单线性插值计算得到数据点的像素值f：经过以上的数据预处理过程，生成最终的变换后的图像集；步骤3、按照2:8的比例划分测试数据集和训练数据集；分别输入树莓派和服务器；步骤4、对MobileNetV3模型进行适当的改进，删除在原始模型中部分Bottleneck层，保留了原模型的13层，以适用车载网络入侵检测；在模型训练前，加载ImageNet权重，再进行训练及测试；步骤5、训练效果最好模型部署在树莓派中，用于检测异常CAN信息并产生警报。3.如权利要求1所述的一种基于深度学习的轻量级车载网络入侵检测方法，其特征在于：所述步骤5最后检测异常CAN信息并产生警报。
说明书desc
技术领域本发明属于网络空间安全中的物联网安全领域，具体涉及一种基于深度学习的轻量级车载网络入侵检测方法。背景技术近年来，汽车技术有了飞跃式的发展，随着5G、工业2.0与移动群智感知的提出与推广，特别是智能交通系统和自动驾驶汽车的出现，汽车本体逐渐开始承担部分计算任务。2020年7月27日由国家标准化管理委员会、中共中央网络安全和信息化委员会办公室、国家发展和改革委员会、中华人民共和国科学技术部、中华人民共和国工业和信息化部五部门联合发布的《国家新一代人工智能标准体系建设指南》关键内容之一为“人工智能与车联网的结合”。为了实现这一目标，研究者进行了大量研究，如车载网络通信、车辆资源优化、车辆隐私保护等。随着物联网的飞速发展，大量传感器支持部署在车辆上并支持相互通信，人们把车间通信网络称为车联网。汽车内部与外界网络的信息互动日益频繁，多个接口支持人们通过远程连接和有线连接方法与车辆连接，但这种多元信息交流极易导致车载网络成为攻击目标。目前控制器区域网络总线是被广泛用于车载网络的通信标准，为电子控制单元之间提供有效、稳定的信息沟通。但是，CAN并没有使用安全措施以保证网络通信安全，如缺少认证、明文传输等。研究人员在远程控制汽车时利用CAN接收节点对源地址缺少认证的漏洞实现攻击，如通过伪造控制信息发送恶意指令破坏ECU，获得对车辆的部分控制权，最终导致汽车设备如齿轮、刹车或发动机故障等。如图1所示，攻击者可以通过OBD-II接口对IVN发起内部攻击，如拒绝服务攻击、数据包注入和欺骗攻击等。为车载网络提供保护已成为目前亟待人们解决的问题，常用方法是恶意行为检测和入侵检测，有基于签名的方法、基于阈值的方法、基于参数检测的方法、以及基于机器学习和深度学习的方法。但车载网络入侵检测要求低算力消耗和实时性，目前大多的解决方案并没有在低算力平台部署实验。此外，解决方案存在数据集旧、训练收敛时间长、准确率低、仅支持二分类难以识别特定的恶意消息等问题。发明内容本发明的目的在于提供一种基于优化CNN和迁移学习的轻量级车载网络入侵检测方法，并使用树莓派部署在IVN的CAN总线上，用于检测异常CAN信息并产生警报。本发明的技术方案是：一种基于深度学习的轻量级车载网络入侵检测方法，首先提出了一种数据转换方式，将车内和车外网络数据以基于时间的块为单位进行采集，接着通过维度变换将一维的攻击数据转换到二维空间，并将其可视化；然后，采用主流的卷积神经网络变体MobileNetV3，结合现在有效的迁移学习方式，通过迁移大模型预训练权重对卷积神经网络进行微调训练，以改善模型的多种性能指标；最后，模拟真实环境下低算力平台，验证本发明的有效性。流程包括如下步骤：步骤1、对车载网络流量进行数据清洗；步骤2、对车载网络流量基于时间进行维度转换；步骤3、划分训练和测试数据集；步骤4、使用迁移学习和MobileNetV3模型对数据集进行训练和测试；步骤5、保存效果最好模型部署树莓派在IVN中用于检测异常CAN信息并产生警报。上述的一种基于深度学习的轻量级车载网络入侵检测方法，具体步骤为：步骤1、对数据集进行数据清洗：原始车载网络流量可能存在脏数据，需要对于数据位置异常的原始样本归位并将遗漏数据全部置为0，删除数据格式异常的原始样本。步骤2、根据网络流量数据集的时间戳和特征大小将数据样本转换为数据块；Car-Hacking和OTIDS数据集有9个重要特征，将27个连续样本的9个特征：27×9＝243个特征值，转换为形状为9×9×3的三通道图像，采用双线性插值法将9×9×3的图像扩大到224×224×3；采用的线性插值具体如下：首先从x轴方向对先用关于x的单线性插值去分别计算f与f的像素值:再使用关于y方向的单线性插值计算得到数据点的像素值f：经过以上的数据预处理过程，生成最终的变换后的图像集。步骤3、按照2:8的比例划分测试数据集和训练数据集；分别输入树莓派和服务器；步骤4、对MobileNetV3模型进行适当的改进，删除在原始模型中部分Bottleneck层，保留了原模型的13层，以适用车载网络入侵检测；在模型训练前，加载ImageNet权重，再进行训练及测试；步骤5、训练效果最好模型部署在树莓派中，用于检测异常CAN信息并产生警报。本发明具有以下特点：1、本发明支持低算力平台部署，在树莓派上进行实际测试。改良后的MobileNetV3参数量的减少使得发明支持在低算力平台上部署。2、相较于其他轻量级卷积神经网络，本发明使用轻量级卷积神经网络MobileNetV3结合迁移学习不仅提升了准确率，减少了检测时间支持实时性检测，还使得训练收敛时间大幅降低。3、相较于其他车载网络入侵检测方法，本发明通过迁移学习+MobileNetV3的方法，不仅可以更快训练出适合的模型，还可以加快检测速度，实现轻量级的车载网络入侵检测。附图说明图1是本发明入侵检测方法框架图；图2是本发明入侵检测部署框架图；图3是本发明神经网络模型结构架构图；图4是Car-Hacking数据集可视化代表性样本；图5是OTIDS数据集可视化代表性样本；图6针对Car-Hacking数据集训练对比结果；图7针对OTIDS数据集训练对比结果。具体实施方式下面通过附图和实施例对本发明作进一步描述。参见图1-5，一种基于优化CNN和迁移学习的轻量级车载网络入侵检测方法，并使用树莓派部署在IVN的CAN总线上，用于检测异常CAN信息并产生警报，首先提出了一种数据转换方式，将车内和车外网络数据以基于时间的块为单位进行采集，接着通过维度变换将一维的攻击数据转换到二维空间，并将其可视化；然后，采用主流的卷积神经网络变体MobileNetV3，结合现在有效的迁移学习方式，通过迁移大模型预训练权重对卷积神经网络进行微调训练；最后，使用CAR-HACKING DATASET、OTIDS两个真实车载网络数据集在树莓派实验，模拟真实环境下低算力平台，验证本文方法的有效性；具体包括以下步骤：步骤1、对车载网络流量进行数据清洗；步骤2、对车载网络流量基于时间进行维度转换；步骤3、划分训练和测试数据集；步骤4、使用迁移学习和MobileNetV3模型对数据集进行训练和测试；步骤5、保存效果最好模型部署树莓派在IVN中用于检测异常CAN信息并产生警报。更具体地：步骤1、对数据集进行数据清洗。对于数据位置异常的原始样本归位并将遗漏数据全部置为0，删除数据格式异常的原始样本。步骤2、根据网络流量数据集的时间戳和特征大小将数据样本转换为数据块。Car-Hacking和OTIDS数据集有9个重要特征，将27个连续样本的9个特征转换为形状为9×9×3的三通道图像，采用双线性插值法将9×9×3的图像扩大到224×224×3。采用的线性插值具体如下：首先从x轴方向对先用关于x的单线性插值去分别计算f与f的像素值:再使用关于y方向的单线性插值计算得到数据点的像素值f：/＞经过以上的数据预处理过程，生成最终的变换后的图像集。步骤3、按照2:8的比例划分测试数据集和训练数据集；分别输入树莓派和服务器；步骤4、对MobileNetV3模型进行适当的改进，删除在原始模型中部分Bottleneck层，保留了原模型的13层，以适用车载网络入侵检测；在模型训练前，加载ImageNet权重，再进行训练及测试。步骤5、训练效果最好模型部署在树莓派中，用于检测异常CAN信息并产生警报。本发明结合车载网络场景特点，在原MobileNet V3模型的基础上进行部分调整，删除在原始模型中部分Bot-tleneck层，保留了原模型的13层，为减少模型可能发生的过拟合情况，采用双线性插值法将9×9×3的图像扩大到224×224×3，作为下一步改进MobileNetV3的输入。参见图6-7，为了验证迁移学习在本发明中的有效性，选取MobileNet模型分别在Car-Hacking和OTIDS两个数据集上进行有无迁移学习的训练损失和准确率对比。通过图6-7可以看出，使用预训练权重的模型训练过程需要更短的时间就可以收敛，而在效果基本一致的前提下，不使用迁移学习的训练工程需要更多的时间才能训练收敛。这验证了迁移学习对于本发明的有效性。在基于迁移学习的卷积模型的选取上，本发明目的是在保证一定检测效率的基础上进行轻量化，以适应在类似树莓派这种低算力场景下的实时检测任务。为此，本文在数据预处理的前提下，选取两类主流的模型，一类是复杂化的网络模型，如EfficientNet、ResNet和VisionTransformer；二是轻量化模型，如MobileNetV3和ShuffleNetV2。选取模型后分别针对本文任务所对应的两个数据集进行模型的训练和测试，最终测试结果见表1和表2。在表1和表2中Acc、P、R、F1-score和TestTime分别是在树莓派设备上对测试集进行实验得出的准确率、精确率、召回率、F1值和一个样本的测试时间；TrainTime是在有GPU加持的PC机上进行训练需要的时间；Params是卷积核的参数量，用来形容模型的大小程度。通过表1和表2可以看出，在Car-Hacking和OTIDS两个数据集上不同模型训练和测试结果的总体趋势是，复杂模型的检测效果是更优且稳定的，这是因为复杂模型的网络架构设计更复杂导致模型拥有更复杂的拟合能力；但由于复杂模型Params过多，从而导致复杂模型的测试时间相比轻量化模型更长。Params越低的网络，保存模型所需的内存小，对硬件内存要求较低，因此对低算力设备更友好。综合5个模型来看，MobileNet的Params接近最低值2.28M。结合表1及图4可以分析得出，由于Car-Hacking数据集类别之间耦合性差，所以测试的五个模型都可以达到100％的检测效果。但在训练时间上，MobileNet相比于复杂模型ResNet-18、EfficientNet以及VisionTransformer分别减少了40％、74％和93％。相比ShuffleNet也减少了14％。同样在测试时间上，MobileNet测试一个样本的平均时间只需要2.5ms，相比ShuffleNet减少了46％的检测时间，且相比复杂模型中速度最快的ResNet-18更是减少了71％的时间,这得益于MobileNet与ResNet-18相比，Params减少了67％。结合表2和图5可以看出，由于OTIDS数据集类别之间相对难以区分，所以在测试的五个模型中，复杂模型的检测效果可以达到100％，轻量级模型达到99％以上。这是由于轻量化模型相比复杂模型减少了隐藏层数和多余的层连接，以此提升模型的处理速度。通过表2可以看出，两个轻量级模型ShuffleNet和MobileNet得益于Params的减少，在满足99％以上的检测效果的前提下相比于复杂模型中检测效果更快的ResNet-18模型分别降低了32％和59％的测试时间，提升了检测效率。表1表2本发明结合迁移学习构建基于可视化和改进的MobileNet模型的轻量级车载网络入侵检测模型。将攻击流量可视化为彩色图，之后通过双线性插值方法扩大图像以增强数据集并防止模型过拟合。最后，为减少参数和训练过程中的资源消耗，对MoblieNet进行改进并使用迁移学习对模型进行微调。实验结果表明，该方法在算力有限的树莓派设备上对车载网络流量数据集CAR HACKING DATASET和OTIDS的测试准确率、精确率、召回率和F1值达到100％，平均响应时间分别为2.5ms和2.9ms。以上所述，仅是本发明的较佳实施例而已，并非对本发明作任何形式上的限制，任何未脱离本发明技术方案内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化与修饰，均仍属于本发明技术方案的范围内。
