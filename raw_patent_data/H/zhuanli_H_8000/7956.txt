标题title
一种基于5G通信的大数据云计算实时分发运维系统及方法
摘要abst
本发明公开了基于5G通信的大数据云计算实时分发运维系统及方法，通过采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU，根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点，根据车辆的密度动态设定中继车辆的比例，然后进行路段划分使得每个路段中并行执行，建立一个最优的V2V通信链路结构，可以将不同的内容缓存到部署在不同区域的RSU中，在内容分发阶段，请求节点可以做出不同的选择来获取内容，从而使得系统效用最大化，提高了系统内容分发的效率和精确度。
权利要求书clms
1.一种基于5G通信的大数据云计算实时分发运维系统，其特征在于，应用于车辆驾驶系统，车辆驾驶系统包括通信连接的车辆、服务节点和控制平面，所述分发运维系统包括：信息采集单元，用于采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU；决策规划单元，用于根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，其中，服务节点向控制平面发送其资源状态信息，车辆向RSU发送任务卸载请求，报告车辆的任务参数和移动性信息，在收到卸载请求后，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，控制平面将任务卸载决策和任务调度信息分别发送给车辆和目标服务节点，车辆将人任务输入数据发送给目标服务节点，目标服务节点执行计算人任务并将计算结果返回给车辆；指令分发单元，用于将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点。2.根据权利要求1所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，指令分发单元包括以下三个阶段；第一步、确定传输区域，发送传输请求：车辆会根据自身存储容量M、预装地图信息Mc以确定从当前位置起，在长度为L的传输区域行驶时间内，预取L区域之外大小为LD的目标区域的数据，向服务节点发送目标区域的地图数据请求，请求内容包括车辆当前位置、目标区域名称与范围、以及传输区域内的基础情况；第二步、获取传输区域服务节点信息，计算最佳传输范围Lopt，服务节点返回传输区域基础信息，其中传输区域基础信息包括服务节点位置和地图数据分布矩阵，采用回溯法计算出当前状态下的最佳传输范围，进入L区域的车辆均在Lopt之内发起地图数据请求；第三步、根据车辆地图数据请求发起情况确定各目标站点与传输比例，完成数据分发工作，当同一服务节点车辆过多时，若传输速度地域预设阈值时，则该车辆不宜在该服务节点传输数据，继续寻找下一目标服务节点。3.根据权利要求2所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，确定传输区域，发送传输请求，包括：在L传输区域距离内，车辆需完成目标区域LD的地图数据传输任务，在区域L内车辆消耗已有的L区域地图数据和接收LD区域的地图数据，预设M表示车辆自身的数据存储容量，c表示每单位距离车消耗的地图数据量，Mc表示车载中已存储的目标区域地图数据量，ML表示本区域L内传输的数据量，设目标区域距离是传输区域距离的α倍，则其中Mc≤M，LD*c＜Mc+ML表示在L段积累到的地图数据大于LD的消耗量，否则出现在LD处某时刻无地图可用的情况；Mc+ML-L*c＜M表示车辆存储空间有限，在L区域中任一时刻的车载地图数据量都不超过车辆的存储限制，否则接收到的地图数据会发生溢出；ML与传输区域的服务节点覆盖率β、服务节点平均带宽B和车速v有关，当车速为v时，传输区域距离L内可被服务节点覆盖的长度为βL，则最终得到传输区域距离L的上下界的表达式为/＞其中E表示当前车速下每秒消耗的地图数据，G表示整个L区域的平均带宽。/＞4.根据权利要求3所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，传输区域根据传输区域距离L的上下界进行选择，预设其上界为Lmax和下界为Lmin，则在传输区域距离L内，车辆完成LD区域的地图数据传输任务，车辆到达LD区域后，取得的地图数据将被消耗，同时进行下一轮的地图数据传输；预设车辆以恒定速度v行驶，每个服务节点信号覆盖范围为一个半径为R的圆，服务节点i范围内的传输带宽为存在/＞其中Bmin、Bmax表示带宽的上下界，服务节点i距离车辆所在车道的距离为di，车道宽度为r，当R-di＞r时，车辆在通过服务节点i的覆盖范围Li时，将拥有Ti的时间片，总计传输数据量为Mi，车辆在服务节点i覆盖范围的行驶距离为/＞车辆在服务节点i覆盖范围的最大逗留时间为/＞服务节点i传输的数据包大小为Mi＝tiBi；当车辆驾驶系统检查服务节点的缓存表并筛选出车辆j进行地图数据传输的候选服务节点集合j，其中包含服务节点数量为N，每个服务节点均满足R-di＞r。5.根据权利要求1所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，所述分发运维系统还包括网络单元，网络单元采用V2V通信方式，当车辆节点i0向周围车辆请求内容时，预设车辆节点i0请求内容大小为车辆之间的连接时间为/＞在连接时间内传输的可以有效传输的数据量为Adaa，车辆节点j0向请求节点i0发送发送/＞比特数据的成功概率为/＞其中E表示Adata的均值，D表示方差，请求节点的请求内容/＞时，才能作为服务节点响应该请求。6.根据权利要求1所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，决策规划单元包括模糊化模块，模糊化模块通过隶属度函数从具体的输入得到模糊隶属度的过程，隶属度函数用于模糊化车辆的行驶速度VVF、车辆的剩余缓存大小VCF和车辆的链路质量VLF，车辆的行驶速度函数根据RSU节点的行驶速度计算其中Vs表示车辆v的行驶速度，N*表示与RSU通信的车辆集，VVF越小表示速度等级越低，车辆在RSU覆盖范围内停留时间越长，服务节点间的通信时间越长；车辆间的剩余缓存大小根据RSU计算其通信范围内的函数表达式为其中VCF值越大表示该服务节点缓存能力越高，能携带多内容进行下一步分发；RSU根据服务节点通信过程中包成功概率来计算其通信范围内车辆的VLF，其表达式为其中VLF的值越大表示该链路状态越稳定，有助于数据包的成功分发和减少时延。7.根据权利要求6所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，决策规划单元还包括反模糊化模块，反模糊化模块采用centroid方法反模糊化，其表达式为其中x是输出变量，ζ表示模糊推理的输出结果，Frank表示服务节点的最终适应值，用于衡量一个车辆作为中继车辆的性能；RSU通过模糊推理得到其覆盖范围内各个车辆节点的Frank值，并建立一个有序表来存放该值，RSU动态地设置一个筛选概率Psel，来决定参与内容分发的中继车辆的数量Psel的值根据当前RSU覆盖范围内车辆的密度来决定，当车辆密度高时，网络负载大，Psel的设置为较小值，当车辆密度低时，网络负载较小时，Psel的值设置较大，/＞其中k表示车辆的空间密度，即每单位道路长度内的车辆数，Hi表示第i辆车与前车的距离。8.根据权利要求1所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，包括：在场景中有n辆车向RSU发出计算卸载请求，车辆从1到n编号，并设集合N＝{1,2...n}，车辆i′的计算任务记为vi′，其中i′∈N，每个任务vi′以元祖来表征，其中di′表示任务执行所需的输入数据的大小，wi′表示计算量，即完成任务所需的计算资源量，表示一个车辆参数且指出车辆i′对任务延迟增加的敏感程度，ei′表示任务的期望完成时间，任务vi′在期望完成时间ei′内完成将不会产生延迟成本；每辆车在本地执行计算任务时，预设fi′表示车辆i′的本地计算能力，则任务vi′的本地执行时间ti0为当ti0＞ei时，任务的延期完成会给车辆造成延迟成本，车辆使用自身的计算资源不需要付出成本，计算任务vi′的本地处理成本/＞中包含车辆i′在本地执行计算任务vi′时的延迟成本，则/＞9.根据权利要求8所述的基于5G通信的大数据云计算实时分发运维系统，其特征在于，RSU任务卸载过程包括：以纵轴表示时间，横轴表示服务节点构建坐标系，将所有的车辆视为一个服务节点S0，并将服务节点的集合M扩展为M′＝M+{0}＝{0,1...m}，任务vi″的本地执行时间ti0表示为tij，j＝0，则ai0＝1，坐标系中的每个矩形表示一个计算任务，矩形中得数字为任务对应的车辆编号，矩形的高度表示任务的执行时间，矩形的横坐标表示处理该任务的服务节点，上下两条边的纵坐标分别表示任务执行的完成时间和起始时间以得到对应的任务卸载效用。10.一种根据权利要求1-9任一项所述的基于5G通信的大数据云计算实时分发运维系统的基于5G通信的大数据云计算实时分发运维方法，其特征在于，包括以下步骤：采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU；根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，其中，服务节点向控制平面发送其资源状态信息，车辆向RSU发送任务卸载请求，报告车辆的任务参数和移动性信息，在收到卸载请求后，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，控制平面将任务卸载决策和任务调度信息分别发送给车辆和目标服务节点，车辆将人任务输入数据发送给目标服务节点，目标服务节点执行计算人任务并将计算结果返回给车辆；将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点。
说明书desc
技术领域本发明属于数据处理技术领域，尤其涉及一种基于5G通信的大数据云计算实时分发运维系统及方法。背景技术车联网是物联网和智慧交通系统快速发展的产物，在车联网中车辆配备了大量的传感器如雷达、摄像头和GPS等、车载单元、无线点设备以及其他的功能模块，可以通过传感技术、网络通信技术和人工智能以及信息处理等技术实现车辆之间、行人和车辆的信息交换、处理和传输，从而对道路和车辆实现智能监控和管理。车联网系统中得通信方式通常为V2I，在V2I通信阶段，车辆与路边基站如路边单元通常将内容分发给覆盖范围内所有车辆节点，这种方式在车辆密度较小时可以提升分发效率，使得较多的车辆均可获取到内容，然而当道路中存在大量车辆节点进行通信时，分发内容给所有节点会减小链路的通信带宽，使得链路质量下降，且当网络中有大量的数据包存在时，更容易发生数据包碰撞和丢失问题，产生网络拥塞，大量的资源会被浪费。另外，当车辆不在RSU内时，便不能获取信息，这使得分发范围十分有限，当车辆行驶在城市街区道路中时，由于各种建筑物设施的存在，容易影响车辆与路边设施通信的效率。发明内容有鉴于此，本发明提供了一种可以提高数据通信的流畅性、通信质量和数据分发运维及时的基于5G通信的大数据云计算实时分发运维系统及方法，来解决上述存在的技术问题，具体采用以下技术方案来实现。第一方面，本发明提供了一种基于5G通信的大数据云计算实时分发运维系统，应用于车辆驾驶系统，车辆驾驶系统包括通信连接的车辆、服务节点和控制平面，所述分发运维系统包括：信息采集单元，用于采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU；决策规划单元，用于根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，其中，服务节点向控制平面发送其资源状态信息，车辆向RSU发送任务卸载请求，报告车辆的任务参数和移动性信息，在收到卸载请求后，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，控制平面将任务卸载决策和任务调度信息分别发送给车辆和目标服务节点，车辆将人任务输入数据发送给目标服务节点，目标服务节点执行计算人任务并将计算结果返回给车辆；指令分发单元，用于将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点。作为上述技术方案的进一步改进，指令分发单元包括以下三个阶段；第一步、确定传输区域，发送传输请求：车辆会根据自身存储容量M、预装地图信息Mc以确定从当前位置起，在长度为L的传输区域行驶时间内，预取L区域之外大小为LD的目标区域的数据，向服务节点发送目标区域的地图数据请求，请求内容包括车辆当前位置、目标区域名称与范围、以及传输区域内的基础情况；第二步、获取传输区域服务节点信息，计算最佳传输范围Lopt，服务节点返回传输区域基础信息，其中传输区域基础信息包括服务节点位置和地图数据分布矩阵，采用回溯法计算出当前状态下的最佳传输范围，进入L区域的车辆均在Lopt之内发起地图数据请求；第三步、根据车辆地图数据请求发起情况确定各目标站点与传输比例，完成数据分发工作，当同一服务节点车辆过多时，若传输速度地域预设阈值时，则该车辆不宜在该服务节点传输数据，继续寻找下一目标服务节点。作为上述技术方案的进一步改进，确定传输区域，发送传输请求，包括：在L传输区域距离内，车辆需完成目标区域LD的地图数据传输任务，在区域L内车辆消耗已有的L区域地图数据和接收LD区域的地图数据，预设M表示车辆自身的数据存储容量，c表示每单位距离车消耗的地图数据量，Mc表示车载中已存储的目标区域地图数据量，ML表示本区域L内传输的数据量，设目标区域距离是传输区域距离的α倍，则其中Mc≤M，LD*c＜Mc+ML表示在L段积累到的地图数据大于LD的消耗量，否则出现在LD处某时刻无地图可用的情况；Mc+ML-L*c＜M表示车辆存储空间有限，在L区域中任一时刻的车载地图数据量都不超过车辆的存储限制，否则接收到的地图数据会发生溢出；ML与传输区域的服务节点覆盖率β、服务节点平均带宽B和车速v有关，当车速为v时，传输区域距离L内可被服务节点覆盖的长度为βL，则最终得到传输区域距离L的上下界的表达式为/＞其中E表示当前车速下每秒消耗的地图数据，G表示整个L区域的平均带宽。作为上述技术方案的进一步改进，传输区域根据传输区域距离L的上下界进行选择，预设其上界为Lmax和下界为Lmin，则在传输区域距离L内，车辆完成LD区域的地图数据传输任务，车辆到达LD区域后，取得的地图数据将被消耗，同时进行下一轮的地图数据传输；预设车辆以恒定速度v行驶，每个服务节点信号覆盖范围为一个半径为R的圆，服务节点i范围内的传输带宽为存在/＞其中Bmin、Bmax表示带宽的上下界，服务节点i距离车辆所在车道的距离为di，车道宽度为r，当R-di＞r时，车辆在通过服务节点i的覆盖范围Li时，将拥有Ti的时间片，总计传输数据量为Mi，车辆在服务节点i覆盖范围的行驶距离为/＞车辆在服务节点i覆盖范围的最大逗留时间为服务节点i传输的数据包大小为Mi＝tiBi；当车辆驾驶系统检查服务节点的缓存表并筛选出车辆j进行地图数据传输的候选服务节点集合j，其中包含服务节点数量为N，每个服务节点均满足R-di＞r。作为上述技术方案的进一步改进，所述分发运维系统还包括网络单元，网络单元采用V2V通信方式，当车辆节点i0向周围车辆请求内容时，预设车辆节点i0请求内容大小为车辆之间的连接时间为/＞在连接时间内传输的可以有效传输的数据量为Adaa，车辆节点j0向请求节点i0发送发送/＞比特数据的成功概率为其中E表示Adata的均值，D表示方差，请求节点的请求内容/＞时，才能作为服务节点响应该请求。作为上述技术方案的进一步改进，决策规划单元包括模糊化模块，模糊化模块通过隶属度函数从具体的输入得到模糊隶属度的过程，隶属度函数用于模糊化车辆的行驶速度VVF、车辆的剩余缓存大小VCF和车辆的链路质量VLF，车辆的行驶速度函数根据RSU节点的行驶速度计算其中Vs表示车辆v的行驶速度，N*表示与RSU通信的车辆集，VVF越小表示速度等级越低，车辆在RSU覆盖范围内停留时间越长，服务节点间的通信时间越长；车辆间的剩余缓存大小根据RSU计算其通信范围内的函数表达式为其中VCF值越大表示该服务节点缓存能力越高，能携带多内容进行下一步分发；RSU根据服务节点通信过程中包成功概率来计算其通信范围内车辆的VLF，其表达式为其中VLF的值越大表示该链路状态越稳定，有助于数据包的成功分发和减少时延。作为上述技术方案的进一步改进，决策规划单元还包括反模糊化模块，反模糊化模块采用centroid方法反模糊化，其表达式为其中x是输出变量，表示模糊推理的输出结果，Frank表示服务节点的最终适应值，用于衡量一个车辆作为中继车辆的性能；RSU通过模糊推理得到其覆盖范围内各个车辆节点的Frank值，并建立一个有序表来存放该值，RSU动态地设置一个筛选概率Psel，来决定参与内容分发的中继车辆的数量Psel的值根据当前RSU覆盖范围内车辆的密度来决定，当车辆密度高时，网络负载大，Psel的设置为较小值，当车辆密度低时，网络负载较小时，Psel的值设置较大，其中k表示车辆的空间密度，即每单位道路长度内的车辆数，Hi表示第i辆车与前车的距离。作为上述技术方案的进一步改进，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，包括：在场景中有n辆车向RSU发出计算卸载请求，车辆从1到n编号，并设集合N＝{1，2...n}，车辆i′的计算任务记为vi′，其中i′∈N，每个任务vi′以元祖来表征，其中di′表示任务执行所需的输入数据的大小，wi′表示计算量，即完成任务所需的计算资源量，/＞表示一个车辆参数且指出车辆i′对任务延迟增加的敏感程度，ei′表示任务的期望完成时间，任务vi′在期望完成时间ei′内完成将不会产生延迟成本；每辆车在本地执行计算任务时，预设fi′表示车辆i′的本地计算能力，则任务vi′的本地执行时间ti0为当ti0＞ei时，任务的延期完成会给车辆造成延迟成本，车辆使用自身的计算资源不需要付出成本，计算任务vi′的本地处理成本/＞中包含车辆i′在本地执行计算任务vi′时的延迟成本，则/＞作为上述技术方案进一步的改进，RSU任务卸载过程包括：以纵轴表示时间，横轴表示服务节点构建坐标系，将所有的车辆视为一个服务节点S0，并将服务节点的集合M扩展为M′＝M+{0}＝{0，1...m}，任务vi′′的本地执行时间ti0表示为tij，j＝0，则ai0＝1，坐标系中的每个矩形表示一个计算任务，矩形中得数字为任务对应的车辆编号，矩形的高度表示任务的执行时间，矩形的横坐标表示处理该任务的服务节点，上下两条边的纵坐标分别表示任务执行的完成时间和起始时间以得到对应的任务卸载效用。第二方面，本发明还提供了一种基于5G通信的大数据云计算实时分发运维方法，包括以下步骤：采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU；根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，其中，服务节点向控制平面发送其资源状态信息，车辆向RSU发送任务卸载请求，报告车辆的任务参数和移动性信息，在收到卸载请求后，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，控制平面将任务卸载决策和任务调度信息分别发送给车辆和目标服务节点，车辆将人任务输入数据发送给目标服务节点，目标服务节点执行计算人任务并将计算结果返回给车辆；将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点。本发明提供了一种基于5G通信的大数据云计算实时分发运维系统及方法，通过采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU，根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点，采用根据模糊逻辑计算作为中继车辆的潜能，并根据车辆的密度动态设定中继车辆的比例，然后进行路段划分使得每个路段中并行执行，当前时间片段内，建立一个最优的V2V通信链路结构，可以将不同的内容缓存到部署在不同区域的RSU中，在内容分发阶段，请求节点可以做出不同的选择来获取内容，从而使得系统效用最大化，提高了系统内容分发的效率和精确度。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1为本发明的基于5G通信的大数据云计算实时分发运维系统的结构框图；图2为本发明的基于5G通信的大数据云计算实时分发运维方法的流程图。具体实施方式下面详细描述本发明的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，仅用于解释本发明，而不能理解为对本发明的限制。参阅图1，本发明提供了一种基于5G通信的大数据云计算实时分发运维系统，应用于车辆驾驶系统，车辆驾驶系统包括通信连接的车辆、服务节点和控制平面，所述分发运维系统包括：信息采集单元，用于采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU；决策规划单元，用于根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，其中，服务节点向控制平面发送其资源状态信息，车辆向RSU发送任务卸载请求，报告车辆的任务参数和移动性信息，在收到卸载请求后，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，控制平面将任务卸载决策和任务调度信息分别发送给车辆和目标服务节点，车辆将人任务输入数据发送给目标服务节点，目标服务节点执行计算人任务并将计算结果返回给车辆；指令分发单元，用于将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点。本实施例中，指令分发单元包括以下三个阶段；第一步、确定传输区域，发送传输请求：车辆会根据自身存储容量M、预装地图信息Mc以确定从当前位置起，在长度为L的传输区域行驶时间内，预取L区域之外大小为LD的目标区域的数据，向服务节点发送目标区域的地图数据请求，请求内容包括车辆当前位置、目标区域名称与范围、以及传输区域内的基础情况；第二步、获取传输区域服务节点信息，计算最佳传输范围Lopt，服务节点返回传输区域基础信息，其中传输区域基础信息包括服务节点位置和地图数据分布矩阵，采用回溯法计算出当前状态下的最佳传输范围，进入L区域的车辆均在Lopt之内发起地图数据请求；第三步、根据车辆地图数据请求发起情况确定各目标站点与传输比例，完成数据分发工作，当同一服务节点车辆过多时，若传输速度地域预设阈值时，则该车辆不宜在该服务节点传输数据，继续寻找下一目标服务节点。RSU任务卸载过程包括：以纵轴表示时间，横轴表示服务节点构建坐标系，将所有的车辆视为一个服务节点S0，并将服务节点的集合M扩展为M′＝M+{0}＝{0，1...m}，任务vi′′的本地执行时间ti0表示为tij，j＝0，则ai0＝1，坐标系中的每个矩形表示一个计算任务，矩形中得数字为任务对应的车辆编号，矩形的高度表示任务的执行时间，矩形的横坐标表示处理该任务的服务节点，上下两条边的纵坐标分别表示任务执行的完成时间和起始时间以得到对应的任务卸载效用。需要说明的是，采用车辆边缘网络内容分发来实现资源调度、边缘缓存、任务卸载和内容分发，随着车载应用的发展，车联网中得数据呈现指数级的增长，车联网能够提供从安全和传输效率到信息娱乐的大量应用，如碰撞报警、拥堵预测、大型地图信息和娱乐多媒体等，以提高驾驶的边界高效性。通过V2V通信为请求车辆提供内容，通过车辆的移动，进一步扩大内容分发的效率和覆盖范围。分发内容分为M个数据包，每个数据包大小为sq，在每一个时间片内，为了获取所有车辆的基本信息，RSU采用当前车辆密度和模糊逻辑来动态选择中继车辆，RSU再给车辆节点分发内容时，预设车辆在每个相应的节点时间片内，其位置是相对静止的，若节点接收重复数据则丢弃该数据包；若首次接收则检查自身缓存空间，服务节点便检查自己的缓存空间，若服务节点的缓存空间大于sq，则保存该数据，反之丢弃，冰箱RSU上报缓存不足，接着RSU将该服务节点从中继节点集中删除。随着车辆的行驶，在同一路段中可能出现多个被RSU覆盖的中继车辆，为了考虑使RSU分发范围最大化，V2V先将道路划分，并在当前路段执行规划策略得到最优V2V网络结构后，再进行内容分发。应理解，一系列车辆行驶在双向道路上并将区域划分为前摄区域，将区域划分为前摄区域Lp、数据传输区域L、目标区域LD，预设车辆Vb为目标车辆，当前行驶在前摄区域，其目标是获取目标区域的地图数据信息，当其进入数据传输区域时开始传输数据。底层和中层数据存储在边缘服务节点，高层数据存储在边缘服务节点或车本身，车辆向边缘服务节点获取完数据就可以进行基本的安全行驶，只是为了更好的驾驶体验，才需要上层的地图数据信息。对每层数据还可以细分为数据块存储，每个数据块量为数据分发的元数据设为M0。预设车辆之间通信信道的带宽相同记为Bv，时隙的长度设为使得一个数据块可以在V2V通信信道的一个时隙内传输。传输区域是目标车辆完成其所需所有数据传输的区域，加入了V2V协作数据传输，服务节点如基站所需传输的数据量减小，传输区域距离也会相应地减小，传输区域距离是根据车流量的不同而动态变化的，从而提升了数据分发运维的准确性和系统工作效率。可选地，确定传输区域，发送传输请求，包括：在L传输区域距离内，车辆需完成目标区域LD的地图数据传输任务，在区域L内车辆消耗已有的L区域地图数据和接收LD区域的地图数据，预设M表示车辆自身的数据存储容量，c表示每单位距离车消耗的地图数据量，Mc表示车载中已存储的目标区域地图数据量，ML表示本区域L内传输的数据量，设目标区域距离是传输区域距离的α倍，则其中Mc≤M，LD*c＜Mc+ML表示在L段积累到的地图数据大于LD的消耗量，否则出现在LD处某时刻无地图可用的情况；Mc+ML-L*c＜M表示车辆存储空间有限，在L区域中任一时刻的车载地图数据量都不超过车辆的存储限制，否则接收到的地图数据会发生溢出；ML与传输区域的服务节点覆盖率β、服务节点平均带宽B和车速v有关，当车速为v时，传输区域距离L内可被服务节点覆盖的长度为βL，则最终得到传输区域距离L的上下界的表达式为/＞其中E表示当前车速下每秒消耗的地图数据，G表示整个L区域的平均带宽。本实施例中，传输区域根据传输区域距离L的上下界进行选择，预设其上界为Lmax和下界为Lmin，则在传输区域距离L内，车辆完成LD区域的地图数据传输任务，车辆到达LD区域后，取得的地图数据将被消耗，同时进行下一轮的地图数据传输；预设车辆以恒定速度v行驶，每个服务节点信号覆盖范围为一个半径为R的圆，服务节点i范围内的传输带宽为/＞存在/＞其中Bmin、Bmax表示带宽的上下界，服务节点i距离车辆所在车道的距离为di，车道宽度为r，当R-di＞r时，车辆在通过服务节点i的覆盖范围Li时，将拥有Ti的时间片，总计传输数据量为Mi，车辆在服务节点i覆盖范围的行驶距离为/＞车辆在服务节点i覆盖范围的最大逗留时间为/＞服务节点i传输的数据包大小为Mi＝tiBi；当车辆驾驶系统检查服务节点的缓存表并筛选出车辆j进行地图数据传输的候选服务节点集合j，其中包含服务节点数量为N，每个服务节点均满足R-di＞r。需要说明的是，预设当服务节点接收或发送数据给车辆未接收该内容的邻居节点时，会产生正效用来鼓励车辆参与分发，同时由于其他服务节的干扰会产生一定的通信代价来影响内容分发，为了保证车辆间通信的正常进行，减少数据冲撞，其中邻居为与车辆节点的距离小于其最大通信范围的节点。每辆车对应的服务节点即基站集合不完全相等，车辆传输完整的数据包不一定需要j的全部基站。预设实际为车辆传输数据的旋转基站集合j，其中包含基站数目为k，车辆在数据获取期间，数据一直有效且该车辆获取数据完成前数据不会更新。在传输距离L内存在多个目标数据存储基站，设从地图数据请求发起基站到最后一个获取数据基站的距离为LPj，这段距离定义为车辆j地图数据预取距离，LPj为本次传输基站集合中最远的两个基站的距离，车辆j能在这段距离内获取完所需的地图数据信息。在传输距离L内存在多个目标数据存储基站，则允许多种传输组合存在，在各种组合策略下，LPj也各不相同，当存在多种组合策略时，车辆按最高传输数率Bmax获取数据，可计算得到LPj的最小值，若车辆按最低传输数率Bmin传输数据，可计算得到LPj的最大值。先让每个基站以最大带宽Bmax进行传输，从传输区域的最后一个基站往前传输数据，直至传输完所需地图数据，记下当前基站位置并记为让每个基站以最小带宽Bmin进行传输，记下刚好传输完成的基站位置并记为/＞则Lo为/＞和/＞两个基站的距离，从而提高了数据传输的精确性和完整度。可选地，所述分发运维系统还包括网络单元，网络单元采用V2V通信方式，当车辆节点i0向周围车辆请求内容时，预设车辆节点i0请求内容大小为车辆之间的连接时间为/＞在连接时间内传输的可以有效传输的数据量为Adaa，车辆节点j0向请求节点i0发送发送/＞比特数据的成功概率为/＞其中E表示Adata的均值，D表示方差，请求节点的请求内容/＞时，才能作为服务节点响应该请求。可选地，决策规划单元包括模糊化模块，模糊化模块通过隶属度函数从具体的输入得到模糊隶属度的过程，隶属度函数用于模糊化车辆的行驶速度VVF、车辆的剩余缓存大小VCF和车辆的链路质量VLF，车辆的行驶速度函数根据RSU节点的行驶速度计算其中Vs表示车辆v的行驶速度，N*表示与RSU通信的车辆集，VVF越小表示速度等级越低，车辆在RSU覆盖范围内停留时间越长，服务节点间的通信时间越长；车辆间的剩余缓存大小根据RSU计算其通信范围内的函数表达式为其中VCF值越大表示该服务节点缓存能力越高，能携带多内容进行下一步分发；RSU根据服务节点通信过程中包成功概率来计算其通信范围内车辆的VLF，其表达式为其中VLF的值越大表示该链路状态越稳定，有助于数据包的成功分发和减少时延。本实施例中，决策规划单元还包括反模糊化模块，反模糊化模块采用centroid方法反模糊化，其表达式为其中x是输出变量，/＞表示模糊推理的输出结果，Frank表示服务节点的最终适应值，用于衡量一个车辆作为中继车辆的性能；RSU通过模糊推理得到其覆盖范围内各个车辆节点的Frank值，并建立一个有序表来存放该值，RSU动态地设置一个筛选概率Psel，来决定参与内容分发的中继车辆的数量/＞Psel的值根据当前RSU覆盖范围内车辆的密度来决定，当车辆密度高时，网络负载大，Psel的设置为较小值，当车辆密度低时，网络负载较小时，Psel的值设置较大，/＞其中k表示车辆的空间密度，即每单位道路长度内的车辆数，Hi表示第i辆车与前车的距离。可选地，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，包括：在场景中有n辆车向RSU发出计算卸载请求，车辆从1到n编号，并设集合N＝{1，2...n}，车辆i′的计算任务记为vi′，其中i′∈N，每个任务vi′以元祖来表征，其中di′表示任务执行所需的输入数据的大小，wi′表示计算量，即完成任务所需的计算资源量，/＞表示一个车辆参数且指出车辆i′对任务延迟增加的敏感程度，ei′表示任务的期望完成时间，任务vi′在期望完成时间ei′内完成将不会产生延迟成本；每辆车在本地执行计算任务时，预设fi′表示车辆i′的本地计算能力，则任务vi′的本地执行时间ti0为当ti0＞ei时，任务的延期完成会给车辆造成延迟成本，车辆使用自身的计算资源不需要付出成本，计算任务vi′的本地处理成本/＞中包含车辆i′在本地执行计算任务vi′时的延迟成本，则/＞/＞本实施例中，当计算任务的本地处理成本不为零时，车辆会像RSU发出计算卸载请求，在发出计算卸载请求时，车辆将它的位置和移动性发送给控制平面，这样控制平面可以直到特定的服务节点是否对该车辆可用。aij表示服务节点Sj对车辆i′的可用性，若车辆i′在服务节点Sj的覆盖范围内切可以连接到Sj，则aij＝1，否则aij＝0。当aij＝1时，控制平面可以选择服务节点Sj来处理任务vi′，此时任务的完成时间包括连接诶建立时间、上传时间、等待时间和执行时间，连接诶建立时间是车辆i′与服务节点Sj建立可靠连接所需的时间，建立新链接所需的时间通常取决于其接收到的车辆信号强度，车辆与服务节点之间的相对位置和相对速度对信号强度产生假的较大的影响；上传时间/＞表示车辆i′将任务vi′的输入数据通过上行信道上传到服务节点Sj的时间得到/＞等待时间/＞是指任务vi′在服务节点Sj上等待执行的时间；执行时间/＞是指服务节点Sj执行任务vi′的时间得到/＞可以省略服务节点将计算结果返回给车辆所用的时间，从而提高了车辆与服务节点通信连接的稳定性和分发运维系统的工作稳定性。参阅图2，本发明还提供了一种基于5G通信的大数据云计算实时分发运维方法，包括以下步骤：S1：采集车辆的任务参数、服务节点的属性信息，并感知车辆的位置、速度和可接入路侧单元RSU；S2：根据信息采集单元采集到的属性信息决策车辆的任务卸载决策和服务节点的任务调度信息，其中，服务节点向控制平面发送其资源状态信息，车辆向RSU发送任务卸载请求，报告车辆的任务参数和移动性信息，在收到卸载请求后，控制平面根据采集到的网络信息，执行任务卸载算法得到任务卸载决策和任务调度信息，控制平面将任务卸载决策和任务调度信息分别发送给车辆和目标服务节点，车辆将人任务输入数据发送给目标服务节点，目标服务节点执行计算人任务并将计算结果返回给车辆；S3：将决策规划单元产生的决策和任务调度信息转换成可执行指令，并发送给对应的车辆和服务节点。本实施例中，预设每个车辆都配备了GPS来获取自己的位置，且中继车辆在与请求车辆通信的过程中速度不便，当前t时刻请求车辆CVi的运行速度为vi，位置为{xi，yi}，行驶方向角度为θi，选择通信的车辆节点CVk的运行速度记为vk，当前时刻的位置为{xk，yk}，行驶方向角度为θk，车辆之间的距离为边缘计算通过在网络边缘进行数据处理，降低了边缘设备与数据中心之间的通信成本，预先在边缘服务器缓存流行内容，进一步提高内容的命中率，可以在更加有效的时间内满足车辆节点用户的需求。在这里示出和描述的所有示例中，任何具体值应被解释为仅仅是示例性的，而不是作为限制，因此，示例性实施例的其他示例可以具有不同的值。应注意到：相似的标号和字母在下面的附图中表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中不需要对其进行进一步定义和解释。以上所述实施例仅表达了本发明的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对本发明范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。
