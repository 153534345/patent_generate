标题title
一种基于区块链的流媒体实时存证与校验方法
摘要abst
本发明提出了一种基于区块链的流媒体实时存证与校验方法，该方法面向的系统组成包括数据采集节点、网络边界节点、内容存证与验证节点；所述网络边界节点、内容存证与验证节点同时作为区块链节点运行，所述数据采集节点通过网络边界节点上传数据流，每一个区块链节点有唯一的ID，并且能够同时充当边界节点和内容存证与验证节点；所述区块链上运行数据转发调度智能合约；本发明能够面向司法存证中重要的音视频数据存证，提供一种基于区块链的时采时存的流媒体数据存证与验证方法，使多媒体文件内容从采集源直接、实时的上链存证，同时确保多媒体证据内容的隐私性与源头真实性。
权利要求书clms
1.一种基于区块链的流媒体实时存证与校验方法，其特征在于，该方法面向的系统组成包括数据采集节点、网络边界节点、内容存证与验证节点；所述网络边界节点、内容存证与验证节点同时作为区块链节点运行，所述数据采集节点通过网络边界节点上传数据流；该系统用于流数据的实时存证以及数据内容的真实性验证；所述流数据的实时存证的方法包括如下步骤：步骤1.1：数据采集节点采集流媒体数据，向网络边界节点推送多媒体数据流；数据采集节点在上传数据前对流数据进行切片处理，后续所有传输过程基于切片后的数据分片Segment进行；步骤1.2：网络边界节点在接收到数据采集节点的推流后，进一步的执行数据分发，将不同的数据分片Segment发送给对应的内容存证与验证节点；步骤1.3：内容存证与验证节点接收到新的Segment后，记录该Segment对应的流信息以及Segment的序列号，随后对Segment数据片进行签名、并计算hash值，最后将上述内容写入区块链记录；步骤1.4：数据存证完成，同时数据采集节点向网络边界节点终止会话，随后系统在本地保存该多媒体数据流文件，并记录关键的数据流信息与数据分片信息。2.根据权利要求1所述的一种基于区块链的流媒体实时存证与校验方法，其特征在于，所述数据内容的真实性验证的方法包括如下步骤：步骤2.1：数据存证方发起对数据内容的真实性的验证流程，并提供多媒体数据流的关键参数，包括数据流信息、数据分片信息；步骤2.2：验证方在区块链上检索与该项数据流对应的存证记录；步骤2.3：存证方将多媒体数据文件按照存证时采用的相同的分片规则，将数据进行分片，计算每一个Segment的hash值，并与区块链上的检索记录进行比对；并记录每个Segment的存证节点签名；当hash值比对无误后，验证方可确认数据内容的真实性；步骤2.4：验证方对数据实时存证行为的真实性进行二次验证，防止数据流实时存证过程中，网络边界节点的与数据存证人的联合作恶行为。3.根据权利要求1或2所述的一种基于区块链的流媒体实时存证与校验方法，其特征在于，每一个所述区块链节点有唯一的ID，并且能够同时充当边界节点和内容存证与验证节点；所述区块链上运行数据转发调度智能合约。4.根据权利要求2所述的一种基于区块链的流媒体实时存证与校验方法，其特征在于，在步骤2.4中，验证过程中需要查找区块链上的转发调度智能合约执行记录，并获得与数据流时间戳对应的数据分发路由表状态；数据分发路由表由转发调度智能合约统一维护，所述数据分发路由表的维护机制包括如下步骤：步骤3.1：计算数据分发路由表中节点对之间的初始转发概率，其计算方法如公式所示：其中，i为节点的序号，为节点i可用的目标转发节点集合，/＞为节点对/＞的初始转发权重，节点i选择节点j作为分发节点的初始转发概率为；步骤3.2：智能合约每隔时间统计一次该时间段内的成功转发事件，其具体的统计方式如下：记录内的任意节点对/＞之间所转发的Segment存证延时，在时间窗口/＞内，节点对/＞之间的平均存证延时记做/＞；步骤3.3：基于，智能合约调整任意节点对之间的转发权重/＞，并按照步骤3.1计算新的转发概率后，更新路由表。5.根据权利要求4所述的一种基于区块链的流媒体实时存证与校验方法，其特征在于，在步骤3.3中，转发权重的调整方法如下：1）对于特定的网络边界节点i，设置其中包含节点数量为m；2）智能合约计算得到在该时间窗口内的平均存证延时集合，其计算方法如公式所示：/＞3）令对于节点对/＞，智能合约计算得到其在/＞内的转发权重的更新值/＞，并将转发权重/＞更新为；其中，函数/＞。6.根据权利要求2所述的一种基于区块链的流媒体实时存证与校验方法，其特征在于，所述步骤2.4中二次验证的验证方法如下：验证方根据检索到的所有分片的验证节点签名记录，以及网络边界节点ID，统计网络边界节点在该数据存证过程中选择存证节点的概率，然后将概率/＞与数据分发路由表中的转发概率/＞进行比对；同时设置一个系统所需置信度α，验证方通过计算/＞，并将得到的结果与α进行比较，仅当/＞时，判断该数据流存证记录有效。7.根据权利要求1所述的一种基于区块链的流媒体实时存证与校验方法，其特征在于，在步骤1.1中，数据采集节点推流之前需要确定数据流的切片规则，所述数据流切片规则的计算方法包括如下步骤：步骤4.1：在步骤2.4中，通过查找概率统计Z值表，并得到；步骤4.2：计算数据采集节点的最低样本容量，其计算方法如公式所示：其中，N为数据采集节点最低样本容量，α为系统进行存证行为真实性验证所需置信度，p为样本的标准偏差，可通过查找该采集节点接入的边界节点的路由表中对应到不同目标分发节点的分发概率计算得到，或可直接采用经验值进行计算；步骤4.3：数据采集节点保证当前流数据的总切片数量。/＞
说明书desc
技术领域本发明涉及区块链的技术领域，特别涉及一种基于区块链的流媒体实时存证与校验方法。背景技术区块链技术由于天生具备不可篡改、不可抵赖属性，被广泛采用于司法过程中的电子证据保护。通常的司法存证可以包括文字证据、图片证据、语音证据和视频证据，而现有基于区块链技术的司法存证系统，仅将复杂种类的电子证据统一当做文件数据进行存证处理，无法防止在上链存证之前对文件内容自身的篡改与伪造行为，限制了区块链上电子证据的实际证据效力。例如，CN114219489A公开了一种实时上传交易信息的区块链存证方法。该方法由四个阶段组成：第一阶段、验证，在人的协助下完成支付方P和收款方S之间的验证；第二阶段、存证，支付方P获得合法许可并启动存证流程；第三阶段、法律程序，建立存证的法律程序；第四阶段、支付和存证反馈，完成支付操作和存证反馈。上述技术方案设计了提供地址信息和时间戳的交易信息存证方案，允许在会话密钥存在的有效时间内的多轮存证，虽然优化了区块链存证的交易存证延时，但是校验与核查的手段过于简易，也无法良好的保证存证之前数据的安全性。例如，CN111353180A公开了一种区块链存证方法、取证方法及系统；其中区块链存证方法，包括：获取用户上传的存证数据，存证数据包括：存证文件的文件特征信息以及用户信息；将存证数据上链至用户存证区块链，以使用户存证区块链生成与存证数据对应的区块，并且用户存证区块链生成区块的区块特征信息；根据区块特征信息确定存证数据存证成功。进而可以只将存证文件的文件特征信息存储在实现本实申请方法的装置中，而无需对存证文件进行保存；可保证存证文件的数据安全，防止被篡改，并有效保障用户的隐私。上述技术方案仅将复杂种类的电子证据统一当做文件数据进行存证处理，无法防止在上链存证之前对文件内容自身的篡改与伪造行为，因此无法保证存证数据的有效性和安全性，具有较大的改进空间。针对上述现有技术中存在的缺陷，亟需一种基于区块链的流媒体实时存证与校验方法，能够防止电子证据在上链存证之前出现文件本身的被篡改与伪造行为，能够进一步提升区块链上电子证据的实际证据效力。发明内容本发明面向司法存证中重要的音视频数据存证，提供一种基于区块链的时采时存的流媒体数据存证与验证方法，使多媒体文件内容从采集源直接、实时的上链存证，同时确保多媒体证据内容的隐私性与源头真实性。为了实现上述目的，本发明提出了一种基于区块链的流媒体实时存证与校验方法，该方法面向的系统组成包括数据采集节点、网络边界节点、内容存证与验证节点；所述网络边界节点、内容存证与验证节点同时作为区块链节点运行，所述数据采集节点通过网络边界节点上传数据流；该系统用于流数据的实时存证以及数据内容的真实性验证；所述流数据的实时存证的方法包括如下步骤：步骤1.1：数据采集节点采集流媒体数据，向网络边界节点推送多媒体数据流；数据流推送协议可以为RUDP等现有的推流通信协议；数据采集节点在上传数据前对流数据进行切片处理，后续所有传输过程基于切片后的数据分片Segment进行；步骤1.2：网络边界节点在接收到数据采集节点的推流后，进一步的执行数据分发，将不同的数据分片Segment发送给对应的内容存证与验证节点；网络边界节点根据数据分发路由表为不同的Segment选择目标分发节点；步骤1.3：内容存证与验证节点接收到新的Segment后，记录该Segment对应的流信息以及Segment的序列号，随后对Segment数据片进行签名、并计算hash值，最后将上述内容写入区块链记录；当完成记录后，内容存证与验证节点删除掉接收到的数据内容；步骤1.4：数据存证完成，同时数据采集节点向网络边界节点终止会话，随后系统在本地保存该多媒体数据流文件，并记录关键的数据流信息与数据分片信息；所述数据内容的真实性验证的方法包括如下步骤：步骤2.1：数据存证方发起对数据内容的真实性的验证流程，并提供多媒体数据流的关键参数，包括数据流信息、数据分片信息；步骤2.2：验证方可以通过智能合约实现在区块链上检索与该项数据流对应的存证记录；可以通过数据流会话信息、数据流采集时间进行检索；检索完成后可以获取与该多媒体数据对应的若干hash值；步骤2.3：存证方将多媒体数据文件按照存证时采用的相同的分片规则，将数据进行分片，计算每一个Segment的hash值，并与区块链上的检索记录进行比对；并记录每个Segment的存证节点签名；当hash值比对无误后，验证方可确认数据内容的真实性；步骤2.4：验证方对数据实时存证行为的真实性进行二次验证，防止数据流实时存证过程中，网络边界节点的与数据存证人的联合作恶行为。优选的，每一个所述区块链节点有唯一的ID，并且能够同时充当边界节点和内容存证与验证节点；所述区块链上运行数据转发调度智能合约。优选的，在步骤2.4中，验证过程中需要查找区块链上的转发调度智能合约执行记录，并获得与数据流时间戳对应的数据分发路由表状态；数据分发路由表由转发调度智能合约统一维护，所述数据分发路由表的维护机制包括如下步骤：步骤3.1：计算数据分发路由表中节点对之间的初始转发概率，其计算方法如公式所示：其中，i为节点的序号，为节点i可用的目标转发节点集合，/＞为节点对的初始转发权重，转发调度智能合约为区块链上节点分配统一的初始转发权重，转发权重与每一个节点对相对应；节点i选择节点j作为分发节点的初始转发概率为/＞；步骤3.2：随着系统开始运行，智能合约每隔时间统计一次该时间段内的成功转发事件，其具体的统计方式如下：记录内的任意节点对/＞之间所转发的Segment存证延时，所述Segment存证延时为该Segment从网络边界节点发出，到存证记录上链的时间差；在时间窗口/＞内，节点对/＞之间的平均存证延时记做/＞；步骤3.3：基于，智能合约调整任意节点对之间的转发权重/＞，并按照步骤3.1计算新的转发概率后，更新路由表。优选的，在步骤3.3中，转发权重的调整方法如下：1）对于特定的网络边界节点i，设置其中包含节点数量为m；2）智能合约计算得到在该时间窗口内的平均存证延时集合，其计算方法如公式所示：/＞3）令对于节点对/＞，智能合约计算得到其在/＞内的转发权重的更新值/＞并将转发权重/＞更新为；其中，函数/＞。优选的，所述步骤2.4中二次验证的验证方法如下：验证方根据检索到的所有分片的验证节点签名记录，以及网络边界节点ID，统计网络边界节点在该数据存证过程中选择存证节点的概率，然后将概率/＞与数据分发路由表中的转发概率/＞进行比对；同时设置一个系统所需置信度α，验证方通过计算/＞，并将得到的结果与α进行比较，仅当/＞时，判断该数据流存证记录有效。优选的，在步骤1.1中，数据采集节点推流之前需要确定数据流的切片规则，所述数据流切片规则的计算方法包括如下步骤：步骤4.1：在步骤2.4中，通过查找概率统计Z值表，并得到；步骤4.2：计算数据采集节点的最低样本容量，其计算方法如公式所示：其中，N为数据采集节点最低样本容量，α为系统进行存证行为真实性验证所需置信度，p为样本的标准偏差，可通过查找该采集节点接入的边界节点的路由表中对应到不同目标分发节点的分发概率计算得到，或可直接采用经验值/＞进行计算；步骤4.3：采集节点可以自主选择切片规则，但数据采集节点需要保证当前流数据的总切片数量。本发明与现有技术相比较具有如下有益效果：本发明面向的系统组成包含有数据采集节点、网络边界节点、内容存证与验证节点，系统主体功能包括流数据实时存证与数据内容真实性验证两部分；所述网络边界节点、内容存证与验证节点同时作为区块链节点运行，数据采集节点通过网络边界节点上传数据流；且每一个区块链节点有唯一的ID，并且能够同时充当边界节点和内容存证与验证节点；同时，区块链上运行数据转发调度智能合约；本发明面向司法存证中重要的音视频数据存证，使多媒体文件内容从采集源直接、实时的上链存证，同时确保多媒体证据内容的隐私性与源头真实性。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明面向的系统组成及工作原理示意图；图2为本发明基于区块链的流媒体数据的实时存证的方法示意图；图3为本发明基于区块链的流媒体数据内容真实性验证的方法示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本发明实施例的组件可以以各种不同的配置来布置和设计。因此，以下对在附图中提供的本发明的实施例的详细描述并非旨在限制要求保护的本发明的范围，而是仅仅表示本发明的选定实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。如图1所示，本发明提出了一种基于区块链的流媒体实时存证与校验方法，本发明面向的系统组成包括数据采集节点、网络边界节点、内容存证与验证节点；其中网络边界节点、内容存证与验证节点同时作为区块链节点运行，数据采集节点通过网络边界节点上传数据流；每一个区块链节点有唯一的ID，并且能够同时充当边界节点和内容存证与验证节点；同时，区块链上运行数据转发调度智能合约；系统主体功能包括流数据实时存证与数据内容真实性验证两部分。其中：如图2所示，所述流数据的实时存证的方法包括如下步骤：步骤1.1：数据采集节点采集流媒体数据，向网络边界节点推送多媒体数据流；数据流推送协议可以为RUDP等现有的推流通信协议；数据采集节点在上传数据前对流数据进行切片处理，后续所有传输过程基于切片后的数据分片Segment进行；采集节点可以自主选择切片规则，但需要保证最终的数据总分片数；步骤1.2：网络边界节点在接收到采集节点的推流后，进一步的执行数据分发；数据分发过程即将不同的数据分片Segment发送给不同的内容存证与验证节点；网络边界节点根据数据分发路由表为不同的Segment选择目标分发节点；作为一种实施方法，数据分发路由表可以按照表1所示方式构造：对应到表1所示的路由表：边界节点A选择B作为目标存证与验证节点的概率为0.6，选择C作为目标内容存证与验证节点的概率为0.2；边界节点C选择D作为目标存证与验证节点的概率为0.7。上述过程中的数据分发路由表由区块链智能合约更新与维护，即任意边界节点的路由表具有全局一致性。步骤1.3：内容存证与验证节点每接收到新的Segment，记录该Segment对应的流信息、Segment的序列号等，随后对Segment数据片进行签名、并计算hash值，最后将以上内容写入区块链记录；步骤1.4：采集节点完成数据存证后，向网络边界节点终止会话。随后在本地保存该多媒体数据流文件，并记录关键的数据流信息与数据分片信息；如图3所示，所述数据内容的真实性验证的方法包括如下步骤：步骤2.1：数据内容真实性验证流程由数据存证人发起。存证人提供多媒体数据流的关键参数，包括数据流信息、数据分片信息等；步骤2.2：验证者在区块链上检索与该项数据流对应的存证记录；可以通过数据流会话信息、数据流采集时间进行检索；检索完成后可以获取与该多媒体数据对应的若干hash值；步骤2.3：存证人将多媒体数据文件按照存证时采用的相同的分片规则，将数据进行分片，计算每一个Segment的hash值，并与区块链上的检索记录进行比对；并记录每个Segment的存证节点签名；当hash值比对无误后，验证者可确认数据内容的真实性；步骤2.4：为避免数据流实时存证过程中，网络边界节点的与数据存证人的联合作恶行为，验证者还需要进一步的对数据实时存证行为真实性进行验证；验证者根据检索到的所有分片的验证节点签名记录，以及网络边界节点ID，统计网络边界节点在该数据存证过程中选择存证节点的概率，然后将概率/＞与数据分发路由表中的转发概率/＞进行比对；同时设置一个系统所需置信度α，验证方通过计算/＞，并将得到的结果与α进行比较，仅当/＞时，判断该数据流存证记录有效。在步骤2.4中，验证节点需要通过查找区块链上的转发调度智能合约执行记录，获得与数据流时间戳对应的数据分发路由表状态。在上述流媒体数据实时存证与真实性验证流程中，数据分发路由表的建立和维护是关键的影响因素。在本发明中，数据分发路由表由转发调度智能合约统一维护，而路由表的建立和维护机制可遵循如下流程：3.数据分发路由表维护机制：步骤3.1：转发调度智能合约为区块链上节点分配统一的初始转发权重；其中转发权重与每一个节点对对应；如对于序号为i的节点，其可用的目标转发节点集合表示为，对于节点对/＞，其初始转发权重为/＞，那么节点i选择节点j作为分发节点的初始转发概率为/＞；步骤3.2：随着系统开始运行，智能合约每隔时间统计一次该时间段内的成功转发事件，然后更新路由表。所述统计操作即记录该时间窗口内的任意节点对间所转发的Segment存证延时，即该Segment从网络边界节点发出，到存证记录上链的时间差。假设在时间窗口内，节点对/＞间的平均存证延时记做/＞；步骤3.3：基于，智能合约调整任意节点对之间的转发权重/＞，并按照步骤3.1计算新的转发概率后，更新路由表。转发权重的调整规则如下：1）对于特定的网络边界节点i，假设其可用的目标转发节点集合表示为，/＞中包含节点数量为m；2）智能合约计算得到在该时间窗口内的平均存证延时集合，其计算方法如下：3）令对于节点对/＞，智能合约计算得到其在/＞内的转发权重的更新值/＞并将转发权重/＞更新为；在以上表达式中，函数/＞。4.数据流推流分片规则：在步骤1.1中，数据采集节点推流之前需要确定数据流的切片规则；本部分提供一种数据流推流切片规则方法；数据流切片规则计算方法可按照以下步骤：步骤4.1：对应步骤2.4，假设系统进行存证行为真实性验证所需置信度为α，通过查找概率统计Z值表，可以得到  ；步骤4.2：数据采集节点根据如下公式计算最低样本容量：其中，p为样本的标准偏差，可通过查找该采集节点接入的边界节点的路由表中对应到不同目标分发节点的分发概率计算得到；或可直接采用经验值进行计算；步骤4.3：与步骤1.1对应，数据采集节点需要保证当前流数据的切片数量。当然，以上所述仅为本发明的具体实施例而已，并非来限制本发明实施范围，凡依本发明申请专利范围所述构造、特征及原理所做的等效变化或修饰，均应包括于本发明申请专利范围内。最后应说明的是：以上所述实施例，仅为本发明的具体实施方式，用以说明本发明的技术方案，而非对其限制，本发明的保护范围并不局限于此，尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，其依然可以对前述实施例所记载的技术方案进行修改或可轻易想到变化，或者对其中部分技术特征进行等同替换；而这些修改、变化或者替换，并不使相应技术方案的本质脱离本发明实施例技术方案的精神和范围，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应所述以权利要求的保护范围为准。
