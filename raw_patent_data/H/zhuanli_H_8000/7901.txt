标题title
一种数据安全传输方法及系统
摘要abst
本发明公开一种数据安全传输方法及系统，方法包括：LORA传感器终端节点设备采集环境数据，通过LORAWAN协议传输给LORA网关；LORA网关采用TCP/IP协议连接网络服务器，网络服务器将LORA传感器终端节点设备采集到的数据发送到LINKWAN平台；LINKWAN平台使用HTTPS协议连接阿里云物联网平台，用户在阿里云物联网平台管理智慧农业；WEB应用程序通过MQTT协议连接阿里云物联网平台，用户通过个人的WEB应用程序管理智慧农业。本发明属于通信技术领域，具体是指一种传输距离广、安全性高、抗干扰能力强、用户交互性强、成本低、适用于大型智慧农业的数据安全传输方法及系统。
权利要求书clms
1.一种数据安全传输方法，其特征在于，所述数据安全传输方法由数据安全传输系统执行，所述数据安全传输系统包括LORA传感器终端节点设备、LORA网关、网络服务器、LINKWAN平台、阿里云物联网平台和WEB应用程序，所述LINKWAN平台设有服务器，所述阿里云物联网平台设有应用服务器，所述网络服务器设有解密模块和硬件防火墙，所述数据安全传输方法包括以下步骤：步骤S1：所述LORA传感器终端节点设备采集环境数据，通过LORAWAN协议传输给LORA网关，步骤S1包括步骤S11、步骤S12、步骤S13和步骤S14；在步骤S11中，所述LORA传感器终端节点设备、服务器、应用服务器和网络服务器设置AppEUI、DevEUI和AppKey；在步骤S12中，所述LORA传感器终端节点设备使用HCBC加密算法对入网请求报文进行加密；在步骤S13中，所述网络服务器通过HCBC解密算法对入网请求报文进行解密，并将解密后的入网请求报文传输给LINKWAN平台和阿里云物联网平台，所述阿里云物联网平台的应用服务器向LORA传感器终端节点设备返回入网接受报文；在步骤S14中，所述LORA传感器终端节点设备通过AES加密算法以及校验算法加密环境数据，并传输至阿里云物联网平台；步骤S2：所述LORA网关采用TCP/IP协议连接网络服务器，所述网络服务器将LORA传感器终端节点设备采集到的数据发送到LINKWAN平台；步骤S3：所述LINKWAN平台使用HTTPS协议连接阿里云物联网平台；步骤S4：所述WEB应用程序通过MQTT协议连接阿里云物联网平台。2.根据权利要求1所述的一种数据安全传输方法，其特征在于：在步骤S11中，在所述LORA传感器终端节点设备入网之前，所述LORA传感器终端节点设备、服务器、应用服务器和网络服务器设置AppEUI、DevEUI和AppKey，AppEUI是应用标识，DevEUI是LORA传感器终端节点设备的唯一标识，AppKey是密钥。3.根据权利要求1所述的一种数据安全传输方法，其特征在于：在步骤S12中，所述LORA传感器终端节点设备通过LORA网关向网络服务器发送加密后的入网请求报文，所述LORA传感器终端节点设备对入网请求报文进行改进，在入网请求报文发送前使用AppKey作为密钥，使用HCBC加密算法进行加密，HCBC加密算法如下：HCBC加密算法式中，HCBC是加密后的密文，EN是基于AES_CBC算法的加密函数，MHDR是入网请求报文的数据的类型，入网请求报文中携带有AppEUI和DevEUI，所述应用服务器收到入网请求报文后，通过AppEUI和DevEUI决定是否允许设备入网，DevNonce由每次请求时通过LORA射频模块的信号强度或者时间戳加伪随机数列算出，DevNonce是随机值，H是校验码，在入网请求时是通过AppKey作为密钥计算的，H使用校验算法算出，具体校验算法如下：……校验算法式中，、……是入网请求报文被划分成的n个128位的数据块，E是加密函数，K是加密密钥AppKey，、……是每个数据块通过加密函数生成的密文，H是取位后得到的校验码，是常数，L是取位函数，s指取位函数每次取的位数，公式表示H是的前s位。4.根据权利要求1所述的一种数据安全传输方法，其特征在于：在步骤S13中，所述网络服务器收到入网请求后使用HCBC解密算法对入网请求报文解密，所述网络服务器的解密模块对接收到的入网请求报文进行解密，所述网络服务器得到解密后的入网请求报文，解密模块通过H校验码检测解密后的入网请求报文是否合法，如果合法会将入网请求转发给LINKWAN平台，所述服务器将数据交给阿里云物联网平台处理，所述阿里云物联网平台的应用服务器根据报文中的AppEUI和DevEUI来判断是否接受入网请求，如果接受入网，所述阿里云物联网平台的应用服务器向LORA传感器终端节点设备返回入网接受报文，所述阿里云物联网平台的应用服务器使用AppKey作为密钥，使用AES_ECB加密算法加密入网接受报文，所述LORA传感器终端节点设备使用AES_EBC解密函数去解密收到的入网接受报文，得到报文中的参数，此时所述LORA传感器终端节点设备根据报文中的参数算出网络会话密钥和应用会话密钥。5.根据权利要求1所述的一种数据安全传输方法，其特征在于：在步骤S14中，所述LORA传感器终端节点设备、服务器、应用服务器和网络服务器通过加密密钥完成数据收发，所述LORA传感器终端节点设备、服务器、应用服务器和网络服务器得到加密密钥后对数据进行加密和解密，在所述LORA传感器终端节点设备端，使用双层加密数据方式将数据传输到LORA网关，双层加密数据方式具体通过应用会话密钥使用AES加密算法进行数据加密以及通过网络会话密钥使用校验算法计算H校验码，所述LORA网关接收到数据后将数据转发给网络服务器，所述网络服务器通过网络会话密钥解析H校验码，检测数据包的完整性，检测无误后将数据包转发至所述LINKWAN平台，进而上行至所述应用服务器，所述应用服务器使用应用会话密钥解密，得到数据具体内容，完成数据的传输，AES加密算法及校验算法如下：……，在AES加密算法及校验算法式中，S是加密密文，AES是加密函数，NA是加密密钥，MSG是需要加密的数据，、……是AES算法加密后的每个数据块通过校验算法加密函数生成的密文块，E是校验算法的加密函数，N是网络会话密钥，、……是数据在AES算法加密后被划分成的n个数据块，H是取位后得到的校验码，是常数，L是取位函数，s指取位函数每次取的位数，公式表示H是的前s位。6.根据权利要求1所述的一种数据安全传输方法，其特征在于：所述LORA网关采用TCP/IP协议连接网络服务器，包括：步骤S21：所述LORA网关通过TCP三次握手与网络服务器建立TCP连接，所述LORA网关使用SYN代理的方式对数据进行保护，SYN代理设在LORA网关和网络服务器之间，SYN代理接收到所述LORA网关发送的SYN包后并不转发SYN包，而是以所述网络服务器的名义主动回复SYN/ACK包给LORA网关，如果SYN代理接收到ACK包，表示是正常的访问，此时，SYN代理向所述网络服务器发送ACK包并完成三次握手；步骤S22：完成TCP三次握手后，TCP连接建立过程结束，TCP进入数据传输的状态；步骤S23：完成数据的收发后，执行TCP四次挥手断开连接，数据传输过程结束。7.根据权利要求1所述的一种数据安全传输方法，其特征在于：在步骤S2中，所述LORA网关采用TCP/IP协议连接网络服务器，所述网络服务器将LORA传感器终端节点设备采集到的数据发送到LINKWAN平台，使用所述LINKWAN平台，用户在PC端进行网关管理、节点管理以及网络维护。8.根据权利要求1所述的一种数据安全传输方法，其特征在于：所述阿里云物联网平台作为数据出口与LINKWAN平台连接，同步接收LORA传感器终端节点设备采集到的信息和数据。9.一种数据安全传输系统，用于实现如权利要求1-8中任一项所述的数据安全传输方法，其特征在于：包括LORA传感器终端节点设备、LORA网关、网络服务器、LINKWAN平台、阿里云物联网平台和WEB应用程序，所述LORA传感器终端节点设备采集环境数据并通过LORAWAN协议将环境数据传输至LORA网关；所述LORA网关采用TCP/IP协议连接网络服务器，所述网络服务器将LORA传感器终端节点设备采集到的数据发送到LINKWAN平台；所述LINKWAN平台通过HTTPS协议连接阿里云物联网平台，用户通过所述阿里云物联网平台管理智慧农业；所述WEB应用程序通过MQTT协议连接阿里云物联网平台，用户通过个人的WEB应用程序管理智慧农业，所述网络服务器设有解密模块，所述解密模块用于对入网请求报文解密，所述网络服务器设有硬件防火墙，所述硬件防火墙抵御数据在网络服务器与LINKWAN之间传输遇到的侵袭；所述LINKWAN平台设有服务器，所述阿里云物联网平台设有应用服务器。10.根据权利要求9所述的一种数据安全传输系统，其特征在于：还包括存储器和处理器，所述处理器执行所述存储器存储的计算机程序，以实现如权利要求1-8中任一项所述的一种数据安全传输方法。
说明书desc
技术领域本发明属于通信技术领域，具体是指一种数据安全传输方法及系统。背景技术智慧农业主要由数据感知层、数据处理层和用户交互层组成，数据在采集、传输以及存储过程中保证安全性尤为重要，很多企业遭遇过农作物数据被截取、窃取、恶意篡改等安全问题，导致接收到的数据有误，从而造成经济损失。为解决上述问题，目前大多企业采用ZigBee技术传输数据，ZigBee技术采用ASE128位加密算法进行通信加密，但由于ZigBee技术要经过无线传输环境，信息的传输容易受到攻击和窃听，攻击和窃听发生在非安全模式下，攻击者通过抓取数据分组的形式，查看受害者的数据分组内容，目前已经出现了一套专门攻击ZigBee网络的攻击套件KillerBee，攻击者通过学习完成对ZigBee的安全漏洞攻击，此外，ZigBee技术的抗干扰能力有限，传输距离不够远，现有的基于ZigBee技术的物联网技术通过ZigBee接入阿里云平台来实现，此种方法虽然一定程度上提高了用户交互性，但是在网络管理方面只能满足大部分小型应用场景，不适用于大型的智慧农业企业。发明内容针对上述情况，为克服现有技术的缺陷，本发明提供了一种数据安全传输方法及系统，针对ZigBee技术存在的安全性差，容易被有针对性的攻击套件KillerBee攻击的技术问题，本方案提出在LORA网关和LINKWAN平台之间设置集成有硬件防火墙的网络服务器，同时，改进LORA传感器终端节点设备入网的方式，在LORA传感器终端节点设备端，使用基于AES_CBC加密算法的HCBC加密算法对入网请求报文进行加密，此外，在LORA网关与网络服务器建立TCP连接时，使用SYN代理的方式进行防护，针对ZigBee技术传输距离短，不适用于大型智慧农业企业的技术问题，本方案巧妙地利用了LORA技术的抗干扰能力强，传输距离远的特点，以解决ZigBee技术抗干扰能力有限，传输距离短，不适用于大型智慧农业企业的技术问题，本方案结合LINKWAN平台以及阿里云物联网平台，利用LINKWAN平台和阿里云物联网平台提供的交互性服务，以解决现有的基于ZigBee技术的物联网技术在网络管理方面只能满足大部分小型应用场景的技术问题，同时，使用本方案进一步降低了企业的投资成本，提高了用户交互性，也方便用户在云端管理网络以及终端节点设备。本发明采取的技术方案如下：本发明提供的一种数据安全传输方法，应用于数据安全传输系统，所述数据安全传输系统包括LORA传感器终端节点设备、LORA网关、网络服务器、LINKWAN平台、阿里云物联网平台和WEB应用程序，所述LINKWAN平台设有服务器，所述阿里云物联网平台设有应用服务器，所述网络服务器设有解密模块和硬件防火墙，所述方法包括以下步骤：步骤S1：LORA传感器终端节点设备采集环境数据，通过LORAWAN协议传输给LORA网关；步骤S2：LORA网关采用TCP/IP协议连接网络服务器，网络服务器将LORA传感器终端节点设备采集到的数据发送到LINKWAN平台；步骤S3：LINKWAN平台使用HTTPS协议连接阿里云物联网平台，用户在阿里云物联网平台管理智慧农业；步骤S4：WEB应用程序通过MQTT协议连接阿里云物联网平台，用户通过个人的WEB应用程序管理智慧农业。作为本方案的进一步改进，在步骤S1中，LORA传感器终端节点设备通过LORAWAN协议传输给LORA网关，具体方法包括以下步骤：步骤S11：在LORA传感器终端节点设备入网之前，所述LORA传感器终端节点设备、服务器、应用服务器和网络服务器设置AppEUI、DevEUI和AppKey，其中，AppEUI是应用标识，同一设备使用不同的AppEUI入网不同的后台进而使用不同的应用服务器，DevEUI用于标识唯一的终端设备，AppKey由应用程序拥有者分配给终端，用于入网请求报文和入网接受报文的解密以及应用会话密钥和网络会话密钥的生成，在LORA传感器终端节点设备和服务器两端都必须具备AppKey；步骤S12：LORA传感器终端节点设备通过LORA网关向网络服务器发送加密后的入网请求报文；步骤S13：网络服务器收到入网请求报文后使用HCBC解密算法对入网请求报文进行解密，HCBC解密算法是HCBC加密算法的逆运算，网络服务器的解密模块对接收到的入网请求报文进行解密，网络服务器得到解密后的入网请求报文，通过H校验码检测解密后的入网请求报文是否合法，如果合法会将入网请求报文转发给LINKWAN平台，网络服务器集成硬件防火墙，保障数据在网络服务器与LORA传感器终端节点设备以及LINKWAN平台的传输过程中的安全性，LINKWAN平台的服务器将数据交给阿里云物联网平台处理，阿里云物联网平台的应用服务器根据入网请求报文中的AppEUI和DevEUI来判断是否接受入网请求，如果接受入网，则通过网络服务器向LORA传感器终端节点设备返回入网接受报文，使用AppKey作为密钥，使用AES_ECB加密算法对入网接受报文进行加密，LORA传感器终端节点设备使用AES_ECB解密算法去解密收到的入网接受报文，得到报文中的AppNonce、NetID和DevAddr等参数，此时根据参数算出网络会话密钥和应用会话密钥，AES_ECB加密算法如下：ECB=AES_ECB，AES_ECB加密算法式中，ECB是加密密文，AES_ECB是加密函数，AppNonce是由服务器生成的3字节的随机值，在解密得到应用会话密钥和网络会话密钥时用到，DevAddr是由应用服务器分配的设备的短地址，NetID用于应用会话密钥和网络会话密钥的生成，DLSettings用于设置下行第一个接收窗口和下行第二个接收窗口的速率，由RFU、RX1DRoffset和RX2DataRate组成，RX2DataRate用来指定下行第二个接收窗口的速率，RX1DRoffset用来指定下行第一个接收窗口与上行的速率差，RFU是保留字段，RXDelay用来指定第一个接收窗口与上行间的时延，CFlist是可选字段，用来指定通信信道，每一位代表一个信道，为1则允许使用该信道，为0则禁止使用该信道，MIC是校验码，用于网络服务器检验数据包合法性，MIC校验码的生成算法如下：CMAC=AES128_cmac，MIC校验码的生成算法式中，CMAC是加密密文，AES128_cmac是加密函数，MHDR是入网接受报文的帧头；步骤S14：LORA传感器终端节点设备、服务器、应用服务器和网络服务器通过加密密钥完成数据收发，LORA传感器终端节点设备、服务器、应用服务器和网络服务器得到加密密钥后对数据进行加密和解密，在LORA传感器终端节点设备端，使用双层加密数据方式将数据传输到LORA网关，双层加密数据方式具体通过应用会话密钥使用AES加密算法进行数据加密以及通过网络会话密钥使用校验算法计算H校验码，LORA网关接收到数据后将数据转发给网络服务器，网络服务器通过网络会话密钥解析H校验码，检测数据包的完整性，检测无误后将数据包转发至LINKWAN平台，进而上行至应用服务器，应用服务器使用应用会话密钥解密，得到数据具体内容，完成数据的传输，AES加密算法及校验算法如下：……，在AES加密算法及校验算法式中，S是加密密文，AES是加密函数，NA是加密密钥，MSG是需要加密的数据，、……是AES算法加密后的每个数据块通过校验算法加密函数生成的密文块，E是校验算法的加密函数，N是网络会话密钥，、……是数据在AES算法加密后被划分成的n个数据块，H是取位后得到的校验码，是常数，L是取位函数，s指取位函数每次取的位数，公式表示H是的前s位。作为本方案的进一步改进，在步骤S12中，所述LORA传感器终端节点设备对入网请求报文进行改进，在入网请求报文发送前使用AppKey作为密钥，通过HCBC加密算法进行加密，HCBC加密算法基于AES_CBC加密算法，AES加密的具体原理是将入网请求报文分解为多个128位的明文块，通过AES加密器将多个明文块加密成多个密文块，HCBC加密算法的加密原理是明文块0与初始化向量异或运算，再利用密钥进行加密，得到的密文块0作为下一个明文块1的初始化向量，重复执行直到所有明文块被加密，HCBC加密算法如下：HCBC加密算法式中，HCBC是加密后的密文，EN是HCBC加密函数，MHDR是入网请求报文的数据的类型，入网请求报文中携带有AppEUI和DevEUI，应用服务器收到入网请求报文后，通过AppEUI和DevEUI决定是否允许设备入网，DevNonce由每次请求时通过LORA射频模块的信号强度或者时间戳加伪随机数列算出，DevNonce设定为随机值，H是校验码，在入网请求时是通过AppKey作为密钥计算的，H使用校验算法算出，具体校验算法如下：……校验算法式中，、……是入网请求报文被划分成的n个128位的数据块，E是加密函数，K是加密密钥AppKey，、……是每个数据块通过加密函数生成的密文，H是取位后得到的校验码，是常数，L是取位函数，s指取位函数每次取的位数，公式表示H是的前s位。作为本方案的进一步改进，所述LORA传感器终端节点设备通过LORA技术与LORA网关进行通信，LORA技术作为扩频技术，通过注入一个更高频信号将基带信号扩展到更宽的频带，其传输信息所用信号的带宽远大于信息本身的带宽，公式如下：，式中，C是信道容量，单位为比特每秒，它是在理论上可接受的误码率下所允许的最大数据速率，B是要求的信道带宽，单位是Hz，S/N是信号噪声功率比；从上式看出，通过提高信号带宽B维持或提高通信的性能C，实现抗干扰能力更强，传输距离更远的技术效果。作为本方案的进一步改进，在步骤S2中，数据在LORA网关和网络服务器之间安全传输的过程由以下步骤实现：步骤S21：LORA网关通过TCP三次握手与网络服务器建立TCP连接，从一定程度上减少数据丢失，但TCP协议处于半开放时，攻击者利用SYN泛洪对服务器发动攻击，攻击者使用第一数据包对服务器进行大流量冲击，使服务器一直处于半开放的连接状态，导致服务器无法完成三次握手，继而无法响应其他客户端发来的建立连接的请求，为此，本发明采用SYN代理的方式进行防护，SYN代理设在LORA网关和网络服务器之间，SYN代理接收到LORA网关发送的SYN包后并不转发SYN包，而是以网络服务器的名义主动回复SYN/ACK包给LORA网关，如果SYN代理接收到ACK包，表示是正常的访问，此时，SYN代理向服务器发送ACK包并完成三次握手；步骤S22：完成TCP三次握手后，TCP连接建立过程结束，TCP进入数据传输的状态；步骤S23：完成数据的收发后，执行TCP四次挥手断开连接，数据传输过程结束。作为本方案的进一步改进，在步骤S2中，本发明设置有LINKWAN平台，以便于用户在PC端进行网关管理、节点管理以及网络维护操作，且便于用户搭建物联网络专网服务。本发明还提供了一种数据安全传输系统，该系统包括多种LORA传感器终端节点设备、LORA网关、网络服务器、LINKWAN平台、阿里云物联网平台和WEB应用程序，所述LORA传感器终端节点设备用于信息采集，LORA传感器终端节点设备设有电源模块和LORA模块，所述LORA模块设有嵌入式传感器模块，LORA传感器终端节点设备通过嵌入式传感器模块采集数据，所述LORA网关设备具体是一种集成好的设备，从阿里云或者其他渠道购买，LORA传感器终端节点设备使用LORA技术将数据传输给LORA网关，LORA网关使用TCP/IP协议将数据传送至网络服务器，所述网络服务器设有解密模块，所述解密模块中存储有用于解密的计算机程序，网络服务器将LORA传感器终端节点设备采集到的数据转发至LINKWAN平台，所述LINKWAN平台为阿里云LINKWAN平台，是阿里云开发的一套组网的网络管理系统，所述阿里云物联网平台，是阿里云针对物联网领域开发人员推出的一款设备管理平台，所述阿里云物联网平台通过HTPPS协议和LINKWAN平台连接，实现同步接收传感器采集到的信息和数据，方便用户在LINKWAN平台以及阿里云物联网平台上进行网关管理、节点管理以及网络维护等操作，所述WEB应用程序是指用户根据实际物理环境以及阿里云物联网平台设计使用编程语言编写的应用程序，以便于用户操作管理智慧农业。优选的，所述应用服务器为阿里云提供的云服务器，所述服务器为阿里云提供的云服务器。采用上述方案本发明取得的有益效果如下：针对ZigBee技术存在安全性差，容易被针对性软件攻击的技术问题，本方案通过使用LORA技术提高安全性，同时改进了LORA传感器终端节点设备入网的方式，使用AppKey密钥加密LORA传感器终端节点设备在入网时的入网请求报文，此外，在LORA网关与网络服务器建立TCP连接时，使用SYN代理的方式，以及在网络服务器集成防火墙的方式，对数据传输过程进行多重防护，降低了数据传输过程中数据被窃取攻击的可能，从而提高了数据传输的安全性以及传输效率。针对ZigBee技术的抗干扰能力有限和传输距离不够远的技术问题，本方案利用LORA技术传输信息所用信号的带宽远大于信息本身的带宽的特点，实现通信的抗干扰能力更强，传输距离更远的技术效果。针对现有的基于ZigBee技术的物联网技术在网络管理上具有局限性的技术问题，本方案使用LINKWAN平台进行网络管理，以便于在云端管理接入新的终端节点时或者弃用旧的终端节点时进行网络部署，从而提高了用户交互性。本方案通过设置阿里云物联网平台和WEB应用程序对大型智慧农业进行实时监测和管理环境数据，以便于保障农作物正常生长。附图说明图1为本发明提供的一种数据安全传输方法的流程示意图；图2为图1中步骤S1的流程示意图；图3为图1中步骤S2的流程示意图；图4为本发明提供的一种数据安全传输系统的LORA传感器终端节点设备、LORA网关、网络服务器、LINKWAN平台、阿里云物联网平台和WEB应用程序的连接框图；图5为图2中步骤S12中HCBC加密算法的加密原理图；图6为图3中步骤S21的流程示意图；图7为使用现有的基于ZigBee技术的数据传输系统的农作物生长状况和使用本方案中的数据传输系统的农作物生长状况的实验对比图。其中，100、LORA传感器终端节点设备，200、LORA网关，300、网络服务器，400、LINKWAN平台，500、阿里云物联网平台，600、WEB应用程序。附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例；基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要理解的是，术语“上”、“下”、“前”、“后”、“左”、“右”、“顶”、“底”、“内”、“外”等指示方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。参阅图1和图4，本发明采取的技术方案如下：本发明提供的一种数据安全传输方法，应用于数据安全传输系统，所述数据安全传输系统包括LORA传感器终端节点设备100、LORA网关200、网络服务器300、LINKWAN平台400、阿里云物联网平台500和WEB应用程序600，所述网络服务器300设有解密模块和硬件防火墙，所述解密模块中存储有用于解密的计算机程序，所述LINKWAN平台400设有服务器，阿里云物联网平台500设有应用服务器，所述方法包括以下步骤：步骤S1：将LORA传感器终端节点设备100部署在智慧农业园区内，LORA传感器终端节点设备100采集环境数据，通过LORAWAN协议传输给LORA网关200；步骤S2：LORA网关200连接网络服务器300，网络服务器300将LORA传感器终端节点设备100采集到的数据转发给LINKWAN平台400，在LINKWAN平台400配置好云端设备，包括智慧农业园区的LORA传感器终端节点设备100和LORA网关200，云端设备接收到智慧农业园区的实际物理环境数据；步骤S3：LINKWAN平台400连接到阿里云物联网平台500，在阿里云物联网平台500配置好云端设备，同步LINKWAN平台400的数据，用户在阿里云物联网平台500管理智慧农业；步骤S4：WEB应用程序600接入阿里云物联网平台500，WEB应用程序600由用户根据智慧农业实际物理环境以及阿里云物联网平台500使用编程语言开发，用户在个人的WEB应用程序600管理智慧农业。参阅图1、图2和图5，在步骤S1中，LORA传感器终端节点设备100通过LORAWAN协议传输给LORA网关200，具体方法包括以下步骤：步骤S11：在LORA传感器终端节点设备100入网之前，所述LORA传感器终端节点设备100、服务器、应用服务器和网络服务器300设置AppEUI、DevEUI和AppKey，其中，AppEUI为应用标识，同一设备使用不同的AppEUI入网不同的后台进而使用不同的应用服务器，DevEUI用于标识唯一的终端设备，AppKey由应用程序拥有者分配给终端，用于入网请求报文和入网接受报文的解密以及网络会话密钥和应用会话密钥的生成，在LORA传感器终端节点设备100和服务器两端都必须具备AppKey；步骤S12：LORA传感器终端节点设备100通过LORA网关200向网络服务器300发送加密后的入网请求报文，在入网请求报文发送前使用AppKey作为密钥，通过HCBC加密算法进行加密，HCBC加密算法基于AES_CBC加密算法，AES加密的具体原理是将入网请求报文分解为多个128位的明文块，通过AES加密器将多个明文块加密成多个密文块，HCBC加密算法的加密原理是明文块0与初始化向量异或运算，再利用密钥进行加密，得到的密文块0作为下一个明文块1的初始化向量，重复执行直到所有明文块被加密，HCBC加密算法如下：HCBC加密算法式中，HCBC是加密后的密文，EN是HCBC加密函数，MHDR表示入网请求报文的数据的类型，入网请求报文中携带有AppEUI和DevEUI，应用服务器收到入网请求报文后，通过AppEUI和DevEUI决定是否允许设备入网，DevNonce由每次请求时通过LORA射频模块的信号强度或者时间戳加伪随机数列算出，DevNonce设定为随机值，H是校验码，在入网请求时是通过AppKey作为密钥计算的，H使用校验算法算出，具体校验算法如下：……校验算法式中，、……是入网请求报文被划分成的n个128位的数据块，E是加密函数，K是加密密钥AppKey，、……是每个数据块通过加密函数生成的密文，H是取位后得到的校验码，是常数，L是取位函数，s指取位函数每次取的位数，公式表示H是的前s位；步骤S13：网络服务器300收到入网请求报文后使用AES_CBC解密算法对入网请求报文进行解密，网络服务器300的解密模块对接收到的入网请求报文进行解密，网络服务器300得到解密后的入网请求报文，通过H检测解密后的入网请求报文是否合法，如果合法会将入网请求转发给LINKWAN平台400，LINKWAN平台400将数据交给阿里云物联网平台500处理，阿里云物联网平台500的应用服务器根据报文中的AppEUI和DevEUI来判断是否接收入网请求，如果接受入网，应用服务器将会通过网络服务器300向LORA传感器终端节点设备100返回入网接受报文，应用服务器使用AppKey作为密钥，使用AES_ECB加密算法对入网接受报文进行加密，LORA传感器终端节点设备100使用AES_ECB解密算法去解密收到的入网接受报文，得到报文中的AppNonce、NetID和DevAddr等参数，此时算出网络会话密钥和应用会话密钥，AES_ECB加密算法如下：ECB=AES_ECB，AES_ECB加密算法式中，ECB是加密密文，AES_ECB是加密函数，AppNonce是由服务器生成的3字节的随机值，在解密得到应用会话密钥和网络会话密钥时用到，DevAddr是由应用服务器分配的设备的短地址，NetID用于网络会话密钥和应用会话密钥的生成，DLSettings用于设置下行第一个接收窗口和下行第二个接收窗口的速率，由RFU、RX1DRoffset和RX2DataRate组成，RX2DataRate用来指定下行第二个接收窗口的速率，RX1DRoffset用来指定下行第一个接收窗口与上行的速率差，RFU是保留字段，RXDelay用来指定第一个接收窗口与上行间的时延，CFlist是可选字段，用来指定通信信道，每一位代表一个信道，为1则允许使用该信道，为0则禁止使用该信道，H是校验码，用于网络服务器300检验数据包合法性，MIC校验码的生成算法如下：CMAC=AES128_cmac，MIC校验码的生成算法式中，CMAC是加密密文，AES128_cmac是加密函数，MHDR是入网接受报文的帧头；步骤S14：LORA传感器终端节点设备100、服务器、应用服务器和网络服务器300通过加密密钥完成数据收发，LORA传感器终端节点设备100、服务器、应用服务器和网络服务器300得到加密密钥后对数据进行加密和解密，在LORA传感器终端节点设备100端，使用双层加密数据方式将数据传输到LORA网关200，双层加密数据方式具体通过应用会话密钥使用AES加密算法进行数据加密以及通过网络会话密钥使用校验算法计算H校验码，LORA网关200接收到数据后将数据转发给网络服务器300，网络服务器300通过网络会话密钥解析H校验码，检测数据包的完整性，检测无误后将数据包转发至LINKWAN平台400，进而上行至应用服务器，应用服务器使用应用会话密钥解密，得到数据具体内容，完成数据的传输，AES加密算法及校验算法如下：……，在AES加密算法及校验算法式中，S是加密密文，AES是加密函数，NA是加密密钥，MSG是需要加密的数据，、……是AES算法加密后的每个数据块通过校验算法加密函数生成的密文块，E是校验算法的加密函数，N是网络会话密钥，、……是数据在AES算法加密后被划分成的n个数据块，H是取位后得到的校验码，是常数，L是取位函数，s指取位函数每次取的位数，公式表示H是的前s位。参阅图1，LORA技术通过注入一个更高频信号将基带信号扩展到更宽的频带，LORA技术传输信息所用信号的带宽远大于信息本身的带宽，公式如下：，式中，C是信道容量，单位为比特每秒，它是在理论上可接受的误码率下所允许的最大数据速率，B是要求的信道带宽，单位是Hz，S/N是信号噪声功率比；从上式可以看出，通过提高信号带宽B维持或提高通信的性能C，实现抗干扰能力更强，传输距离更远的技术效果。参阅图1、图3和图6，在步骤S2中，数据在LORA网关200和网络服务器300之间安全传输的过程由以下步骤实现：步骤S21：LORA网关200通过TCP三次握手与网络服务器300的服务器建立TCP连接，可以从一定程度上减少数据丢失，但TCP协议处于半开放时，攻击者可以利用SYN泛洪对服务器发动攻击，攻击者使用第一数据包对服务器进行大流量冲击，使服务器一直处于半开放的连接状态，导致服务器无法完成三次握手，继而无法响应其他客户端发来的建立连接的请求，为此，本发明采用SYN代理的方式进行防护，SYN代理设在LORA网关200和网络服务器300之间，SYN代理接收到LORA网关200发送的SYN包后并不转发SYN包，而是以网络服务器的名义主动回复SYN/ACK包给LORA网关200，如果SYN代理接收到ACK包，表示是正常的访问，此时，SYN代理向服务器发送ACK包并完成三次握手；步骤S22：完成TCP三次握手后，TCP连接建立过程结束，TCP进入数据传输的状态；步骤S23：完成数据的收发后，执行TCP四次挥手断开连接，数据传输过程结束。参阅图1和图3，在步骤S2中，本发明设置有LINKWAN平台400，以便于用户在PC端进行网关管理、节点管理以及网络维护操作，且便于用户搭建物联网络专网服务。参阅图4，本发明还提供了一种数据安全传输系统，该系统包括多种LORA传感器终端节点设备100、LORA网关200、网络服务器300、LINKWAN平台400、阿里云物联网平台500和WEB应用程序600，所述LORA传感器终端节点设备100用于信息采集，LORA传感器终端节点设备100设有电源模块和LORA模块，所述LORA模块设有嵌入式传感器模块，LORA传感器终端节点设备100通过嵌入式传感器模块采集数据，所述LORA网关200设备具体是一种集成好的设备，从阿里云或者其他渠道购买，LORA传感器终端节点设备100使用LORA技术将数据传输给LORA网关200，LORA网关200使用TCP/IP协议将数据传送至网络服务器300，LORA网关200与网络服务器300之间设有SYN代理，网络服务器300将数据进一步转发至LINKWAN平台400，所述LINKWAN平台400为阿里云LINKWAN平台，是阿里云开发的一套组网的网络管理系统，所述阿里云物联网平台500，是阿里云针对物联网领域开发人员推出的一款设备管理平台，所述阿里云物联网平台500通过HTPPS协议和LINKWAN平台400连接，实现同步接收传感器采集到的信息和数据的功能，以便于用户在LINKWAN平台400以及阿里云物联网平台500上进行网关管理、节点管理以及网络维护等操作，所述WEB应用程序600是指用户根据实际物理环境以及阿里云物联网平台500设计使用编程语言编写的WEB端程序，以便于用户操作管理智慧农业，所述应用服务器为阿里云提供的云服务器，所述服务器为阿里云提供的云服务器。实施例一，参阅图1，本方案的数据安全传输方法的实现过程由以下步骤实现：步骤S1：将LORA传感器终端节点设备100部署在智慧农业园区内，LORA传感器终端节点设备100采集环境数据，通过LORAWAN协议传输给LORA网关200；步骤S2：LORA网关200连接网络服务器300，网络服务器300将LORA传感器终端节点设备100采集到的数据转发给LINKWAN平台400，在LINKWAN平台400配置好云端设备，包括智慧农业园区的LORA传感器终端节点设备100和LORA网关200，云端设备接收到智慧农业园区的实际物理环境数据；步骤S3：LINKWAN平台400连接到阿里云物联网平台500，在阿里云物联网平台500配置好云端设备，同步LINKWAN平台400的数据，用户在阿里云物联网平台500管理智慧农业；步骤S4：WEB应用程序600接入阿里云物联网平台500，WEB应用程序600由用户根据智慧农业实际物理环境以及阿里云物联网平台500使用编程语言开发，用户在个人的WEB应用程序600管理智慧农业。实施例二，参阅图1、图2和图5，该实施例基于上述实施例，LORA传感器终端节点设备100采集环境数据，通过LORAWAN协议传输给LORA网关200，在LORA传感器终端节点设备100入网之前，所述LORA传感器终端节点设备100、服务器、应用服务器和网络服务器300设置AppEUI、DevEUI和AppKey，LORA传感器终端节点设备100通过命令发起加密后的入网请求报文向服务器进行入网请求，由于入网请求报文是未加密传输的，只是使用AppKey进行数字签名，如果在数据传输过程中AppKey被盗取将会造成恶意入网并伪装终端，本发明提出在入网请求报文发送前使用AppKey作为密钥，使用HCBC加密算法进行加密，网络服务器300收到入网请求后使用HCBC解密算法对入网请求报文解密，再将解密后的入网请求报文转发给LINKWAN平台400，进而上行至应用服务器，应用服务器返回入网接受报文，LORA传感器终端节点设备100收到入网接受报文后解析出密钥，LORA传感器终端节点设备100、服务器、应用服务器和网络服务器300通过加密密钥完成数据收发。实施例三，参阅图1、图3和图6，该实施例基于上述实施例，LORA网关200采用TCP/IP协议连接网络服务器300，网络服务器300将LORA传感器终端节点设备100采集到的数据发送到LINKWAN平台400，LORA网关200通过TCP三次握手与网络服务器300建立TCP连接，在LORA网关200和网络服务器300之间设置SYN代理，SYN代理接收到LORA网关200发送的SYN包后并不转发SYN包，而是以网络服务器的名义主动回复SYN/ACK包给LORA网关200，如果SYN代理接收到ACK包，表示是正常的访问，此时，SYN代理向网络服务器300发送ACK包并完成三次握手，完成TCP三次握手后，TCP连接建立过程结束，TCP进入数据传输的状态，完成数据的收发后，执行TCP四次挥手断开连接，数据传输过程结束。参阅图7，为验证本方案的安全性，使用者对现有的基于ZigBee技术的数据传输系统和本方案中的数据传输系统进行强度相同的数据攻击，实验结果显示，现有的基于ZigBee技术的数据传输系统的农作物生长状况和使用本方案的数据传输系统的农作物生长状况存在明显差异，使用基于ZigBee技术的数据传输系统时，由于安全性较差，从而使数据容易遭受攻击、窃取和篡改，从而导致接收到的数据有误，进而减弱了对农作物的管理能力，导致农作物较为稀疏，且矮小瘦弱，使用本方案中的数据传输系统时，由于安全性高，从而使数据不容易遭受攻击、窃取和篡改，保证了传输过程中的数据的安全性，增强了对农作物的管理能力，使农作物茂盛且茁壮，因此，本方案中的数据传输系统明显优于现有的基于ZigBee技术的数据传输系统，便于用户管理更大的智慧农业系统，提高了环境数据在传输过程中的安全性，同时，使用者能够在云端实时检测农作物的生长环境。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。以上对本发明及其实施方式进行了描述，这种描述没有限制性，附图中所示的也只是本发明的实施方式之一，实际的结构并不局限于此。总而言之如果本领域的普通技术人员受其启示，在不脱离本发明创造宗旨的情况下，不经创造性的设计出与该技术方案相似的结构方式及实施例，均应属于本发明的保护范围。
