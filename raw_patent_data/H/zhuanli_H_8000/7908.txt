标题title
开关电源控制电路和具有其的开关电源、芯片、设备
摘要abst
本发明公开了一种开关电源控制电路和具有其的开关电源、芯片、设备，该开关电源控制电路包括脉宽调制模块、调频模块和驱动模块：脉宽调制模块用于在时钟信号的控制下输出脉冲宽度调制信号；驱动模块响应于驱动信号驱动开关电源的上管与下管的导通与关断，以对外提供输出电压；调频模块连接在脉宽调制模块和驱动模块之间，用于在每个检测周期内检测脉冲宽度调制信号，以调整驱动信号；当得到在当前检测周期内，脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值时，调频模块在驱动信号中插入第一控制信号，以使上管在控制周期内保持导通或关断。本实施例公开的开关电源控制电路实现了开关电源较宽输出电压的应用范围。
权利要求书clms
1.一种开关电源控制电路，其特征在于，包括：脉宽调制模块、调频模块和驱动模块，其中：所述脉宽调制模块用于在时钟信号的控制下输出脉冲宽度调制信号；所述驱动模块用于响应于驱动信号驱动开关电源的上管与下管的导通与关断，以对外提供输出电压，其中，所述驱动信号为PWM信号；所述调频模块连接在所述脉宽调制模块和所述驱动模块之间，用于在每个检测周期内检测所述脉冲宽度调制信号，以调整所述驱动信号；当得到在当前检测周期内，所述脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值时，所述调频模块在所述驱动信号中插入第一控制信号，所述第一控制信号的控制周期与所述检测周期关联，以使所述上管在所述控制周期内保持导通或关断。2.如权利要求1所述的开关电源控制电路，其特征在于，当得到在当前检测周期内，所述脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值、且所述驱动信号的占空比不等于1或0的检测结果时，所述调频模块在所述驱动信号中插入所述第一控制信号。3.如权利要求2所述的开关电源控制电路，其特征在于，当得到在当前检测周期内，所述脉冲宽度调制信号的占空比大于所述第一预设阈值、且所述驱动信号的占空比不等于1的检测结果时，所述第一控制信号使所述上管在所述控制周期内保持导通。4.如权利要求2所述的开关电源控制电路，其特征在于， 当得到在当前检测周期内，所述脉冲宽度调制信号的占空比小于所述第二预设阈值、且所述驱动信号的占空比不等于0的检测结果时，所述第一控制信号使所述上管在所述控制周期内保持关断。5.如权利要求2-4任意一项所述的开关电源控制电路，其特征在于，所述控制周期为所述检测周期的整数倍。6.如权利要求5所述的开关电源控制电路，其特征在于，所述调频模块在所述当前检测周期结束后，即下一个检测周期开始时向所述驱动信号插入所述第一控制信号。7.如权利要求6所述的开关电源控制电路，其特征在于，所述调频模块在当前检测周期结束后对所述驱动信号所插入的所述第一控制信号的控制周期，与在所述当前检测周期开始前所插入的所述第一控制信号的控制周期之间的差距是一个检测周期；其中，所述当前检测周期为检测结果为所述脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值、且所述驱动信号的占空比不等于1或0的检测周期。8.如权利要求7所述的开关电源控制电路，其特征在于，所述控制周期的上限为2至6倍所述检测周期。9.如权利要求7所述的开关电源控制电路，其特征在于，所述调频模块包括D触发器，所述D触发器的数据输入端接收所述脉冲宽度调制信号，所述D触发器的时钟信号端接收检测信号，所述D触发器的输出端输出第二控制信号；所述检测周期为所述检测信号的一个时钟周期；所述第一预设阈值为所述检测信号的占空比；所述检测信号的周期与所述时钟信号的周期相同；所述检测信号的上升沿与时钟信号的上升沿对齐。10.如权利要求9所述的开关电源控制电路，其特征在于，当所述脉冲宽度调制信号的占空比大于所述检测信号的占空比时，则确定所述脉冲宽度调制信号的占空比大于所述第一预设阈值；当所述脉冲宽度调制信号的占空比小于所述检测信号的占空比时，则确定所述脉冲宽度调制信号的占空比小于所述第一预设阈值。11.如权利要求10所述的开关电源控制电路，其特征在于，所述检测信号的占空比比所述时钟信号的占空比小预设值，所述检测信号的下降沿到来时刻早于所述时钟信号的下降沿到来时刻；所述D触发器在所述检测信号的下降沿到来时检测所述脉冲宽度调制信号的电平。12.如权利要求9所述的开关电源控制电路，其特征在于， 所述调频模块还包括降频状态机及二输入或门；所述降频状态机连接在D触发器的输出端与所述二输入或门的第二输入端之间；所述二输入或门的第一输入端用于接收所述脉冲宽度调制信号，所述二输入或门的输出端连接至所述驱动模块；所述二输入或门用于对所述脉冲宽度调制信号和所述降频状态机的输出进行或运算，以生成所述驱动信号。13.如权利要求12所述的开关电源控制电路，其特征在于，在当前检测周期内，所述降频状态机接收到的所述第二控制信号为高电平，且自身向所述二输入或门输出低电平时，在下一个检测周期内向所述二输入或门保持输出持续的高电平或持续的低电平。14.如权利要求13所述的开关电源控制电路，其特征在于，在所述降频状态机接收到的所述第二控制信号为高电平，且自身向所述二输入或门输出低电平的当前检测周期结束后，所述降频状态机向所述二输入或门输出的持续的高电平或持续的低电平的时长，与在所述当前检测周期开始前所输出的持续高电平或持续的低电平的时长之间的差距是一个检测周期。15.一种用于开关电源的芯片，其上集成有集成电路，其特征在于，所述集成电路包括如权利要求1-14任意一项所述的开关电源控制电路。16.一种开关电源，其特征在于，包括如权利要求1-14任意一项所述的开关电源控制电路，或者如权利要求15所述的芯片。17.如权利要求16所述的开关电源，所述开关电源为升压开关电源，或降压开关电源。18.一种电子设备，其特征在于，包括如权利要求16或17所述的开关电源。
说明书desc
技术领域本发明涉及电子电路技术领域，尤其涉及一种开关电源控制电路和具有其的开关电源、芯片、设备。背景技术电子设备通常由开关电源来提供电源，开关电源又称交换式电源、开关变换器，是一种高频化电能转换装置，一般由上管、下管、电感与电容构成，通过控制上管与下管的导通时间，来维持稳定的输出电压。降压型DCDC转换器是开关电源中的一种，将输入直流电压转换成另一个电压更低的固定直流电压。当目标输出电压接近输入电压时，需要减小下管导通时间来增大占空比，而由于驱动控制延迟与死区时间限制，下管导通时间难以做得很小；并且在上管为NMOS的DCDC转换器中，在下管导通时间内还需要对自举电容进行充电，因而更加难以减小下管导通时间。为了增大占空比，现有技术中存在的一种方案为：预设多个开关电源的开关频率，将输入电压与预设阈值相比较，从而根据使用需求在多个频率间进行切换。这种方式的弊端在于，如果输入电压在预设阈值上下存在比较大的波动，会导致开关频率来回切换，增大输出电压的纹波；当多个预设阈值相接近时，输入电压的波动将导致多个开关频率的频繁切换，更加剧了输出电压的纹波；同时由于只能在预设的开关频率中进行选择，应用范围较窄，不能满足各种场景下的占空比需求。现有技术中存在的另一种方案是：在输入电压与输出电压间增加一个额外的功率管，当目标输出电压接近于输入电压时，打开该功率管，使得输入电压不经过电感，直通到输出电压，从而使得占空比接近于1。这种方式的弊端在于，功率管太小时会造成发热，因此功率管通常面积较大，增加了开关电源控制芯片面积的开销，同时需要额外的控制电路控制该功率管的导通，增加了电路的复杂度。因此，如何减小开关电源控制芯片面积开销的同时，提高开关电源较宽输出电压的应用范围，且使最高输出电压能够尽可能接近输入电压，成为亟待解决的技术问题。发明内容基于上述现状，本发明的主要目的在于提供一种开关电源控制电路和具有其的开关电源、芯片、设备，以在减小开关电源控制芯片面积开销的同时，提高开关电源较宽输出电压的应用范围。为实现上述目的，本发明采用的技术方案如下：根据第一方面，本发明实施例公开了一种开关电源控制电路，包括：脉宽调制模块、调频模块和驱动模块，其中：脉宽调制模块用于在时钟信号的控制下输出脉冲宽度调制信号；驱动模块用于响应于驱动信号驱动开关电源的上管与下管的导通与关断，以对外提供输出电压，其中，驱动信号为PWM信号；调频模块连接在脉宽调制模块和驱动模块之间，用于在每个检测周期内检测脉冲宽度调制信号，以调整驱动信号；当得到在当前检测周期内，脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值时，调频模块在驱动信号中插入第一控制信号，第一控制信号的控制周期与检测周期关联，以使上管在控制周期内保持导通或关断。可选地，当得到在当前检测周期内，脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值、且驱动信号的占空比不等于1或0的检测结果时，调频模块才在驱动信号中插入第一控制信号。可选地，当得到在当前检测周期内，脉冲宽度调制信号的占空比大于第一预设阈值、且驱动信号的占空比不等于1的检测结果时，第一控制信号使上管在控制周期内保持导通。可选地，当得到在当前检测周期内，脉冲宽度调制信号的占空比小于第二预设阈值、且驱动信号的占空比不等于0的检测结果时，第一控制信号使上管在控制周期内保持关断。可选地，控制周期为检测周期的整数倍。可选地，调频模块在当前检测周期结束后，即下一个检测周期开始时向驱动信号插入第一控制信号。可选地，调频模块在当前检测周期结束后对驱动信号所插入的第一控制信号的控制周期，与在当前检测周期开始前所插入的第一控制信号的控制周期之间的差距是一个检测周期；其中，当前检测周期为检测结果为脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值、且驱动信号的占空比不等于1或0的检测周期。可选地，控制周期的上限为2至6倍检测周期。可选地，调频模块包括D触发器，D触发器的数据输入端接收脉冲宽度调制信号，D触发器的时钟信号端接收检测信号，D触发器的输出端输出第二控制信号；检测周期为检测信号的一个时钟周期；第一预设阈值为检测信号的占空比；检测信号的周期与时钟信号的周期相同；检测信号的上升沿与时钟信号的上升沿对齐。可选地，当脉冲宽度调制信号的占空比大于检测信号的占空比时，则确定脉冲宽度调制信号的占空比大于第一预设阈值；当脉冲宽度调制信号的占空比小于检测信号的占空比时，则确定脉冲宽度调制信号的占空比小于第一预设阈值。可选地，检测信号的占空比比时钟信号的占空比小预设值，检测信号的下降沿到来时刻早于时钟信号的下降沿到来时刻；D触发器在检测信号的下降沿到来时检测脉冲宽度调制信号的电平。可选地，调频模块还包括降频状态机及二输入或门；降频状态机连接在D触发器的输出端与二输入或门的第二输入端之间；二输入或门的第一输入端用于接收脉冲宽度调制信号，二输入或门的输出端连接至驱动模块；二输入或门用于对脉冲宽度调制信号和降频状态机输出的第二控制信号进行或运算，以生成驱动信号。可选地，在当前检测周期内，降频状态机接收到的第二控制信号为高电平，且自身向二输入或门输出低电平时，在下一个检测周期内向二输入或门保持输出持续的高电平或持续的低电平。可选地，在降频状态机接收到的第二控制信号为高电平，且自身向二输入或门输出低电平的当前检测周期结束后，降频状态机向二输入或门输出的持续的高电平或持续的低电平的时长，与在当前检测周期开始前所输出的持续高电平或持续的低电平的时长之间的差距是一个检测周期。根据第二方面，本发明实施例公开了一种用于开关电源的芯片，其上集成有集成电路，集成电路包括如第一方面公开的开关电源控制电路。根据第三方面，本发明实施例公开了一种开关电源，包括如第一方面公开的开关电源控制电路，或者如第二方面公开的用于开关电源的芯片。可选地，开关电源为升压开关电源，或降压开关电源。根据第四方面，本发明实施例公开了一种电子设备，包括如第三方面公开的开关电源。依据本发明实施例公开的一种开关电源控制电路和具有其的开关电源、芯片、设备，包括脉宽调制模块、调频模块和驱动模块。脉宽调制模块输出脉冲宽度调制信号，调频模块周期性检测脉冲宽度调制信号的占空比是否大于第一预设阈值或小于第二预设阈值，在检测时刻到来时，调频模块对脉冲宽度调制信号的占空比与预设阈值进行比较，当脉冲宽度调制信号的占空比大于第一预设阈值或小于第二预设阈值时，调频模块在驱动信号中插入第一控制信号，以延长开关电源中上管的导通时间或关断时间，增大或减小开关电源输出电压的占空比，直至下一个检测时刻的到来，也就是，在当前检测周期检测到脉冲宽度调制信号的占空比大于第一预设阈值时，在驱动信号中插入高电平的第一控制信号，即驱动信号的周期会被延长控制周期的时长，且驱动信号中被延长的时段用作延长上管的导通时间，即延长了驱动信号的周期的同时提高了开关电源输出电压，也就是说，在下一个检测时刻到来时，若脉冲宽度调制信号的占空比仍大于预设阈值，会继续延长驱动信号的周期，且提高开关电源输出电压，从而，根据需求调整占空比，实现开关电源较宽输出电压范围，由此满足各种场景下的电压需求；并且，由于延长驱动信号的周期的同时提高开关电源输出电压，因此，理论上，占空比可以无限接近1，即最高输出电压能够尽可能接近输入电压。此外，需要说明的是，相比于根据输入电压判断是否需要进行降频，依据脉冲宽度调制信号的占空比判断是否需要进行降频不受输入电压波动的影响，更为稳定，一方面不会受输入电压波动的影响产生频率的来回切换，避免增加输出电压的纹波；另一方面在整个控制过程中不需要使用功率管，因此控制电路发热较小，可以集成在较小面积的芯片中，减小开关电源控制芯片的面积。本发明的其他有益效果，将在具体实施方式中通过具体技术特征和技术方案的介绍来阐述，本领域技术人员通过这些技术特征和技术方案的介绍，应能理解所述技术特征和技术方案带来的有益技术效果。附图说明以下将参照附图对本发明实施方式进行描述。图中：图1为本实施例公开的一种DC/DC转换器电路原理示例示意图；图2为本实施例公开的一种开关电源控制电路原理示意图；图3为本实施例公开的另一种开关电源控制电路原理示意图。具体实施方式以下基于实施例对本发明进行描述，但是本发明并不仅仅限于这些实施例。在下文对本发明的细节描述中，详尽描述了一些特定的细节部分，为了避免混淆本发明的实质，公知的方法、过程、流程、元件并没有详细叙述。此外，本领域普通技术人员应当理解，在此提供的附图都是为了说明的目的，并且附图不一定是按比例绘制的。除非上下文明确要求，否则整个说明书和权利要求书中的“包括”、“包含”等类似词语应当解释为包含的含义而不是排他或穷举的含义；也就是说，是“包括但不限于”的含义。在本发明的描述中，需要理解的是，术语“第一”、“第二”等仅用于描述目的，而不能理解为指示或暗示相对重要性。此外，在本发明的描述中，除非另有说明，“多个”的含义是两个或两个以上。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，还可以是两个元件内部的连通，可以是无线连接，也可以是有线连接。对于本领域技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。此外，下面所描述的本发明不同实施方式中所涉及的技术特征只要彼此之间未构成冲突就可以相互结合。本实施例公开的开关电源控制电路应用于DC/DC转换器，请参考图1，为本实施例公开的一种DC/DC转换器电路原理示例示意图，DC/DC转换器为一种将直流输入电压转变为固定直流输出电压的转换器，分为升压型、降压型及升降压型三类，通常由上管Q1、下管Q2、电感L及电容C构成，并受驱动信号clk_drv的控制，以使上管Q1与下管Q2交替导通，即在驱动信号clk_drv为高电平时，上管Q1导通，下管Q2关断；在驱动信号clk_drv为低电平时，上管Q1关断，下管Q2导通。在一个开关周期内，先是上管Q1导通、下管Q2关断，之后上管Q1关断、下管Q2导通：上管Q1导通、下管Q2关断时，使用输入电压VIN对电容C进行充电，在电容C处形成了高电平的稳态直流电压，即开关电源输出恒定的高电平电压信号；在上管Q1关断、下管Q2导通时，对电容C进行放电，在电容C处形成了低电平的稳态直流电压，即开关电源输出恒定的低电平电压信号。由此可知，开关电源对外提供的输出电压VOUT是以开关周期为周期的脉冲信号，且输出电压VOUT由输入电压VIN、上管Q1导通时间与下管Q2导通时间确定，以TON表示上管Q1导通时间、TOFF表示下管Q2导通时间，则开关电源对外提供的输出电压VOUT计算公式如下：因此，当目标的输出电压VOUT接近输入电压VIN时，减小下管Q2导通时间TOFF即可。需要说明的是，在具体实施过程中，DC/DC转换器并不局限于图1所示的示例结构，本实施例公开的开关电源控制电路也适用于其它的DC/DC转换器电路结构，具体地，在阅读下文记载的实施例后，在理解本申请开关电源控制电路的工作原理，本领域技术人员能够依据实际需要，选择应用于对应的DC/DC转换器。为了在减小芯片面积的同时，提高开关电源较宽输出电压的应用范围，本实施例公开了一种开关电源控制电路，请参考图2，为本实施例公开的一种开关电源控制电路原理示意图，该开关电源控制电路包括脉宽调制模块1、调频模块2和驱动模块3，其中：脉宽调制模块1用于在时钟信号clk_max的控制下输出脉冲宽度调制信号clk_pre；本实施例中，占空比为脉冲信号在一个周期内高电平持续时长占周期时长的时间比率。时钟信号clk_max为一个具有较大占空比的时钟信号，如占空比为95%，用于限制脉冲宽度调制信号clk_pre的最大占空比，也就是说，脉冲宽度调制信号clk_pre的最大占空比为时钟信号clk_max的占空比；脉冲宽度调制信号clk_pre为基于输出电压VOUT的反馈生成的信号，用于控制上管Q1与下管Q2导通与关断。需要说明的是，当目标的输出电压VOUT接近输入电压VIN时，虽然需要减小下管Q2导通时间TOFF，但由于开关管死区时间、驱动控制延迟等因素的影响，下管Q2导通时间TOFF难以做得很小，因此使用时钟信号clk_max来保证下管Q2导通时间TOFF，也就是说时钟信号clk_max的低电平时长为下管Q2导通时间TOFF，或略大于下管Q2导通时间TOFF。可选地，脉宽调制模块1还用于在另一时钟信号clk_min的控制下输出脉冲宽度调制信号clk_pre。另一时钟信号clk_min为一个具有较小占空比的时钟信号，如占空比为5%，用于限制脉冲宽度调制信号clk_pre的最小占空比，也就是说，脉冲宽度调制信号clk_pre的最小占空比为另一时钟信号clk_min的占空比。同理，当目标的输出电压VOUT接近0时，需要减小上管Q1导通时间TON，但由于开关管死区时间、驱动控制延迟等因素的影响，上管Q1导通时间TON难以做得很小，因此使用另一时钟信号clk_min来保证上管Q1导通时间TON，也就是说另一时钟信号clk_min的高电平时长为上管Q1导通时间TON，或略大于上管Q1导通时间TON。可选地，脉宽调制模块1包括误差放大器11与比较器12：误差放大器11的正相输入端接收参考电压信号Vtarget，反相输入端接收输出电压信号，误差放大器1的输出端输出误差放大信号Vea；误差放大器11用于对输出电压信号与参考电压信号Vtarget进行比较以产生误差放大信号Vea；比较器12的正相输入端连接至误差放大器11的输出端，以接收误差放大信号Vea，比较器12的反相输入端接收锯齿波信号Vsaw，比较器12的输出端输出脉冲宽度调制信号clk_pre；比较器12用于基于误差放大信号Vea与锯齿波信号Vsaw生成脉冲宽度调制信号clk_pre，比较器12的输出端就是脉宽调制模块1的输出端。需要说明的是，时钟信号clk_max与另一时钟信号clk_min作用于比较器12，限制脉冲宽度调制信号clk_pre的最大占空比与最小占空比。驱动模块3用于响应于驱动信号clk_drv驱动开关电源的上管Q1与下管Q2的导通与关断，以对外提供输出电压VOUT；本实施例中，驱动信号clk_drv为PWM信号，当驱动信号clk_drv为高电平时，驱动模块3驱动开关电源的上管Q1导通，下管Q2关断；当驱动信号clk_drv为低电平时，驱动模块3驱动开关电源的上管Q1关断，下管Q2导通。本实施例中驱动模块3的具体结构不限。调频模块2连接在脉宽调制模块1和驱动模块3之间，用于在每个检测周期内检测脉冲宽度调制信号clk_pre，以调整驱动信号clk_drv；本实施例中，检测周期与脉冲宽度调制信号clk_pre的周期时长相同，调频模块2在每个检测周期内的检测时刻检测脉冲宽度调制信号clk_pre的占空比，得到检测结果，基于检测结果调整驱动信号clk_drv，其中，一个检测周期的检测时刻为与该检测周期的起始时刻相距预设时长的一刻。当得到在当前检测周期内，脉冲宽度调制信号clk_pre的占空比大于第一预设阈值或小于第二预设阈值时，调频模块2在驱动信号clk_drv中插入第一控制信号，第一控制信号的控制周期与检测周期关联，以使上管Q1在控制周期内保持导通或关断。为了便于在驱动信号clk_drv中插入第一控制信号，在可选的实施例中，第一控制信号的控制周期为检测周期的整数倍，使得插入第一控制信号后的驱动信号clk_drv的周期为检测周期的整数倍，在驱动信号clk_drv的当前周期结束后，调频模块2依旧能够在固定的检测时刻对脉冲宽度调制信号clk_pre的占空比进行检测，从而保证周期对齐，也就是检测时刻与驱动信号clk_drv对齐，从而便于确定何时在驱动信号clk_drv中插入第一控制信号。反之如果驱动信号clk_drv中插入的第一控制信号的控制周期为检测周期的小数倍，检测时刻相对于驱动信号clk_drv产生移位，难以确定在何时插入第一控制信号。需要说明的是，未插入第一控制信号的驱动信号clk_drv就是脉冲宽度调制信号clk_pre。本实施例中，第一预设阈值略小于时钟信号clk_max的占空比，当脉冲宽度调制信号clk_pre的占空比大于第一预设阈值时，此时输出电压VOUT接近输入电压VIN，为了进一步提高输出电压VOUT，使其更趋近输入电压VIN，调频模块2在驱动信号clk_drv的高电平时期插入第一控制信号，第一控制信号为持续的高电平，以使上管Q1在第一控制信号的控制周期内保持导通，从而延长上管Q1导通时间TON，使得输出电压VOUT更接近1。本实施例中，第二预设阈值略大于另一时钟信号clk_min的占空比，当脉冲宽度调制信号clk_pre的占空比小于第一预设阈值时，此时输出电压VOUT接近0，为了进一步减小输出电压VOUT，使其更趋近0，调频模块2在驱动信号clk_drv的低电平时期插入第一控制信号，第一控制信号为持续的低电平，以使上管Q1在第一控制信号的控制周期内保持关断，即下管Q2在第一控制信号的控制周期内保持导通，从而延长下管Q2导通时间TOFF，使得输出电压VOUT更接近0。为了使驱动信号clk_drv的周期平缓变化，从而减小输出电压的纹波，在可选的实施例中，当得到在当前检测周期内，脉冲宽度调制信号clk_pre的占空比大于第一预设阈值或小于第二预设阈值、且驱动信号clk_drv的占空比不等于1或0的检测结果时，调频模块2在驱动信号clk_drv中插入第一控制信号。本实施例中，驱动信号clk_drv在当前检测周期内持续为高电平，则在当前检测周期内驱动信号clk_drv的占空比为1；驱动信号clk_drv在当前检测周期内持续为低电平，则在当前检测周期内驱动信号clk_drv的占空比为0。本实施例中，在当前检测周期内驱动信号clk_drv的占空比不等于1或0时，才会在脉冲宽度调制信号clk_pre的占空比满足阈值条件时插入第一控制信号，避免在驱动信号clk_drv的一个周期内多次插入第一控制信号，使得驱动信号clk_drv的周期平缓变化，避免由于驱动信号clk_drv周期突变产生驱动信号clk_drv周期来回跳变的震荡现象，从而减少输出电压的纹波。在具体实施过程中，具有脉冲宽度调制信号clk_pre的占空比大于第一预设阈值与小于第二预设阈值两种情况，具体如下：在一种实施例中，当得到在当前检测周期内，脉冲宽度调制信号clk_pre的占空比大于第一预设阈值、且驱动信号clk_drv的占空比不等于1的检测结果时，第一控制信号使上管Q1在控制周期内保持导通。本实施例中，第一控制信号使上管Q1在控制周期内保持导通，也就是说第一控制信号为持续的高电平，持续时长为控制周期的时长。需要说明的是，在当前检测周期内，驱动信号clk_drv的占空比不等于1即表示驱动信号clk_drv在当前检测周期内非持续的高电平信号，也就是说，当前检测周期中的驱动信号clk_drv不是插入的第一控制信号。驱动信号clk_drv的当前周期等于脉冲宽度调制信号clk_pre的周期加当前周期插入的第一控制信号的控制周期，脉冲宽度调制信号clk_pre的周期与检测周期相同，第一控制信号的控制周期为检测周期的整数倍，因此驱动信号clk_drv的周期为检测周期的整数倍。只有在当前检测周期内驱动信号clk_drv的占空比不为1时，当脉冲宽度调制信号clk_pre的占空比大于第一预设阈值时才在驱动信号clk_drv中插入第一控制信号，也就是说，在驱动信号clk_drv的当前周期内，在脉冲宽度调制信号clk_pre所在的检测周期内，当脉冲宽度调制信号clk_pre的占空比大于第一预设阈值时才在驱动信号clk_drv中插入第一控制信号，即在驱动信号clk_drv的当前周期内，至多在一个检测周期中，调频模块2需要在驱动信号clk_drv中插入第一控制信号。本实施例中，在当前检测周期内驱动信号clk_drv的占空比不等于1且脉冲宽度调制信号clk_pre的占空比大于第一预设阈值时，才插入使上管Q1在控制周期内保持导通的第一控制信号，也就是在驱动信号clk_drv的当前周期内，至多在一个检测周期中，调频模块2需要在驱动信号clk_drv中插入第一控制信号，避免由于在驱动信号clk_drv的当前周期内的多个检测周期中都检测到脉冲宽度调制信号clk_pre的占空比大于第一预设阈值，导致多次插入第一控制信号，也就是防止产生驱动信号clk_drv的前后两个周期时长相差过大的现象，使得驱动信号clk_drv的周期平缓变化，避免震荡现象的产生，从而减少输出电压的纹波。在另一种实施例中，当得到在当前检测周期内，脉冲宽度调制信号clk_pre的占空比小于第二预设阈值、且驱动信号clk_drv的占空比不等于0的检测结果时，第一控制信号使上管Q1在控制周期内保持关断。本实施例中，减小输出电压VOUT的原理同上述增大输出电压VOUT的实施例，在此不再赘述，需要说明的是，第一控制信号使上管Q1在控制周期内保持导通，也就是说第一控制信号为持续的低电平，持续时长为控制周期的时长。为了避免时序冲突的产生，从而保证驱动模块3能够正确驱动上管Q1和下管Q2的导通与关断，在可选的实施例中，调频模块2在当前检测周期结束后，即下一个检测周期开始时向驱动信号clk_drv插入第一控制信号。具体地，在当前检测周期结束后向驱动信号clk_drv中插入第一控制信号，值得注意的是，需要插入第一控制信号即说明在当前检测周期内，脉冲宽度调制信号clk_pre的占空比大于第一预设阈值或小于第二预设阈值、且驱动信号clk_drv的占空比不等于1或0。在当前检测周期结束后向驱动信号clk_drv中插入第一控制信号，即在下一个检测周期开始时向驱动信号clk_drv插入第一控制信号，也就是说，插入第一控制信号后的驱动信号clk_drv的前一部分为插入的第一控制信号，后一部分为原始的脉冲宽度调制信号clk_pre，即对于插入第一控制信号后的驱动信号clk_drv来说，其最后一个检测周期中的信号为脉冲宽度调制信号clk_pre，由于上述的在脉冲宽度调制信号clk_pre所在的检测周期内，当脉冲宽度调制信号clk_pre的占空比大于第一预设阈值时才在驱动信号clk_drv中插入第一控制信号，也就是说当需要向驱动信号clk_drv插入第一控制信号时，是在驱动信号clk_drv的当前周期中，在最后一个检测周期结束后向下一个周期的驱动信号clk_drv插入第一控制信号。本实施例中，由于插入的第一控制信号作用于下一个周期的驱动信号clk_drv，因此调频模块2对驱动信号clk_drv的调整具有滞后性，能够避免时序冲突，从而保证驱动模块3能够基于驱动信号clk_drv正确驱动上管Q1与下管Q2的导通与关断，使得控制电路正确控制开关电源的输出电压。反之如果没有这种滞后性，在当前周期快要结束时，驱动模块3响应于驱动信号clk_drv准备驱动开关电源的下管Q2导通时，检测到脉冲宽度调制信号clk_pre的占空比大于第一预设阈值或小于第二预设阈值，调频模块2在当前周期的驱动信号clk_drv中插入第一控制信号，使得驱动模块3又驱动下管Q2关断，导致产生时序冲突，致使驱动模块3错误驱动上管Q1与下管Q2的导通与关断，影响输出电压，从而影响使用该开关电源的用电设备，并且，当错误驱动导致驱动信号clk_drv的周期突变时，还将增大输出电压的纹波，影响用电设备的正常工作；而本实施例中使插入的第一控制信号作用于下一个周期的驱动信号clk_drv则避免了时序冲突的产生。为了减少驱动信号clk_drv周期来回改变的震荡现象的产生，在可选的实施例中，调频模块2在当前检测周期结束后对驱动信号clk_drv所插入的第一控制信号的控制周期，与在当前检测周期开始前所插入的第一控制信号的控制周期之间的差距是一个检测周期；本实施例中，当前检测周期为检测结果为脉冲宽度调制信号clk_pre的占空比大于第一预设阈值或小于第二预设阈值、且驱动信号clk_drv的占空比不等于1或0的检测周期。本实施例中，当前周期的驱动信号clk_drv中插入的第一控制信号的控制周期记作第一控制周期，下一个周期的驱动信号clk_drv中插入的第一控制信号的控制周期记作第二控制周期，第一控制周期与第二控制周期之间相差一个检测周期，即当前周期插入第一控制信号的驱动信号clk_drv与下一个周期插入第一控制信号的驱动信号clk_drv的周期相差一个检测周期。本实施例中，当在驱动信号clk_drv中插入第一控制信号时，插入的第一控制信号的控制周期是逐个递增的，使得插入第一控制信号后的驱动信号clk_drv的周期也是逐个递增的，从而使得驱动信号clk_drv平缓变化。由于改变驱动信号clk_drv从而改变上管Q1的导通或关断时间，再到电感电流的改变，再到输出电压VOUT改变的过程存在延迟，因此脉冲宽度调制信号clk_pre的占空比改变也存在延迟，当未限制第一控制信号的控制周期时，很容易出现类似控制周期从1直接变为3的震荡现象，从而使得驱动信号clk_drv的周期震荡，产生较大的电感电流及输出电压的纹波。本实施例中使得驱动信号clk_drv的周期平缓变化避免了这种震荡现象的产生，从而减小输出电压的纹波。在可选的实施例中，控制周期的上限为2至6倍检测周期，优选地，控制周期的上限为3至4倍检测周期。为便于理解，下面以脉冲宽度调制信号clk_pre的占空比大于第一预设阈值为例进行说明。为了进一步保证及时对脉冲宽度调制信号clk_pre的占空比进行检测，从而及时基于检测结果做出相应响应与控制，在可选的实施例中，调频模块2包括D触发器21，D触发器21的数据输入端D接收脉冲宽度调制信号clk_pre，D触发器21的时钟信号端接收检测信号clk_det，D触发器21的输出端输出第二控制信号dq；检测周期为检测信号clk_det的一个时钟周期。本实施例中，第一预设阈值为检测信号clk_det的占空比；检测信号clk_det的周期与时钟信号clk_max的周期相同；检测信号clk_det的上升沿与时钟信号clk_max的上升沿对齐。在具体实施例中，D触发器21具有数据输入端D、时钟信号端与输出端Q：数据输入端D用于接收输入数据，本实施例中接收脉冲宽度调制信号clk_pre；时钟信号端用于接收时钟信号，本实施例中接收检测信号clk_det；D触发器21基于时钟信号对数据输入端D接收到的脉冲宽度调制信号clk_pre进行检测，即D触发器21在时钟信号每个周期内的特定时刻对数据输入端D接收到的脉冲宽度调制信号clk_pre进行检测，从而实现周期性检测；检测信号clk_det的周期与时钟信号clk_max的周期相同，即检测信号clk_det的周期与脉冲宽度调制信号clk_pre的周期相同，也就是D触发器21在脉冲宽度调制信号clk_pre的每个周期内会对其进行一次检测；D触发器21周期性检测脉冲宽度调制信号clk_pre的占空比是否大于检测信号clk_det的占空比，即D触发器21周期性检测脉冲宽度调制信号clk_pre的占空比是否大于第一预设阈值，当检测到脉冲宽度调制信号clk_pre的占空比大于第一预设阈值时，D触发器输出的第二控制信号dq为高电平，即dq=1，当检测到脉冲宽度调制信号clk_pre的占空比小于第一预设阈值时，D触发器输出的第二控制信号dq为低电平，即dq=0。可选地，由于检测信号clk_det与时钟信号clk_max的周期相同且上升沿对齐，即，检测信号clk_det与时钟信号clk_max时钟对齐，因此可以使用同一源生成检测信号clk_det与时钟信号clk_max。本实施例中，通过D触发器对脉冲宽度调制信号clk_pre的占空比进行检测，能够进一步保证及时检测脉冲宽度调制信号clk_pre的占空比，也就是说能够在每个检测周期内对脉冲宽度调制信号clk_pre的占空比进行一次检测，从而使得第一控制信号的周期能够及时响应于检测结果进行相应调整。在可选的实施例中，当脉冲宽度调制信号clk_pre的占空比大于检测信号clk_det的占空比时，则确定脉冲宽度调制信号clk_pre的占空比大于第一预设阈值；当脉冲宽度调制信号clk_pre的占空比小于检测信号clk_det的占空比时，则确定脉冲宽度调制信号clk_pre的占空比小于第一预设阈值。本实施例中，由于检测信号clk_det的占空比即为第一预设阈值，因此只需判断脉冲宽度调制信号clk_pre的占空比与检测信号clk_det的占空比的大小。为了提高检测效率与检测精准度，在可选的实施例中，检测信号clk_det的占空比比时钟信号clk_max的占空比小预设值，检测信号clk_det的下降沿到来时刻早于时钟信号clk_max的下降沿到来时刻；D触发器21在检测信号clk_det的下降沿到来时检测脉冲宽度调制信号clk_pre的电平。本实施例中，检测信号clk_det的占空比比时钟信号clk_max的占空比小预设值，该预设值为一个较小的值，也就是说，检测信号clk_det的占空比略小于时钟信号clk_max的占空比，具体的值可以依据经验来确定。由于时钟信号clk_max的占空比即为脉冲宽度调制信号clk_pre的最大占空比，因此检测信号clk_det的占空比小于时钟信号clk_max，也即第一预设阈值小于脉冲宽度调制信号clk_pre的最大占空比；同时，若检测信号clk_det的占空比过小，即第一预设阈值过小，则检测结果不具有参考性，可能造成在不需要调频以提高输出电压VOUT的时候进行调频。在理想状态下该预设值为无穷小，但在具体实施过程中，由于电路存在延迟，因此该预设值基于D触发器21的建立时间确定，即该预设值对应的时间内，D触发器21建立完成，可以立即开始检测。本实施例中，考虑实际实施过程中的电路延迟，将检测信号clk_det的占空比设置为略小于时钟信号clk_max的占空比，预留D触发器21的建立时间，保证在D触发器21建立完成后进行占空比比较，提高检测精准度。进一步地，由于检测信号clk_det的上升沿与时钟信号clk_max的上升沿对齐，因此，当脉冲宽度调制信号clk_pre的占空比大于检测信号clk_det的占空比时，脉冲宽度调制信号clk_pre的下降沿晚于检测信号clk_det的下降沿；当脉冲宽度调制信号clk_pre的占空比小于检测信号clk_det的占空比时，脉冲宽度调制信号clk_pre的下降沿早于检测信号clk_det的下降沿；D触发器21在检测信号clk_det的下降沿检测脉冲宽度调制信号clk_pre电平的高低，相当于比较脉冲宽度调制信号clk_pre与第一预设阈值的大小，当D触发器21检测到脉冲宽度调制信号clk_pre为高电平时，即确定脉冲宽度调制信号clk_pre的占空比大于检测信号clk_det的占空比，也就是脉冲宽度调制信号clk_pre的占空比大于第一预设阈值；同理当D触发器21检测到脉冲宽度调制信号clk_pre为低电平时，确定脉冲宽度调制信号clk_pre的占空比小于第一预设阈值。本实施例中，由于检测信号clk_det的占空比是固定的，因此可以作为预设阈值，D触发器21通过在检测信号clk_det的下降沿检测脉冲宽度调制信号clk_pre电平的高低来确定脉冲宽度调制信号clk_pre的占空比与预设阈值的大小，无需额外计算脉冲宽度调制信号clk_pre的占空比，从而减小计算量，一方面，能够快速得到脉冲宽度调制信号clk_pre的占空比与预设阈值的大小关系，提高比较的效率，另一方面，由于无需再设计计算占空比的电路，因此简化电路设计，降低电路复杂度。为了生成相应的驱动信号clk_drv，在可选的实施例中，调频模块2还包括降频状态机23及二输入或门22；降频状态机23连接在D触发器21的输出端与二输入或门22的第二输入端之间；二输入或门22的第一输入端用于接收脉冲宽度调制信号clk_pre，二输入或门22的输出端连接至驱动模块3；二输入或门22用于对脉冲宽度调制信号clk_pre和降频状态机23的输出进行或运算，以生成驱动信号clk_drv。本实施例中，降频状态机23的工作周期与检测周期周期相同，降频状态机23的每个状态持续时长为一个工作周期，降频状态机23用于根据第二控制信号dq进行状态跳转，以得到与检测周期关联的控制周期，降频状态机23的若干个工作周期即为控制周期。具体而言，降频状态机23的状态包括0和1,降频状态机23的状态为0即降频状态机23在当前工作周期中持续输出0,降频状态机23的状态为1即降频状态机23在当前工作周期中持续输出1。当需要在驱动信号clk_drv中插入控制周期为1个检测周期的第一控制信号以延长上管Q1的导通时间时，降频状态机23连续2个工作周期的状态为10；当需要插入控制周期为2个检测周期的第一控制信号时，降频状态机23连续3个工作周期的状态为110；当需要插入控制周期为3个检测周期的第一控制信号时，降频状态机23连续4个工作周期的状态为1110；以此类推；当不需要插入控制周期时，降频状态机23在该工作周期的状态为0。第二控制信号dq=1时，需要插入第一控制信号以延长上管Q1的导通时间；降频状态机23基于第二控制信号dq与自身上一次若干个连续工作周期的状态确定下一次若干个连续工作周期的状态，并进行相应的状态跳转。本实施例中，二输入或门22对脉冲宽度调制信号clk_pre和降频状态机23的输出进行或运算，也就是说，当降频状态机23当前工作周期的输出为1时，生成的驱动信号clk_drv为持续的高电平，当降频状态机23当前工作周期的输出为0时，生成的驱动信号clk_drv为脉冲宽度调制信号clk_pre；因此，当降频状态机23连续n个工作周期的状态为n-1个1与1个0时，即第一控制信号的控制周期为n-1倍检测周期，生成的驱动信号clk_drv为持续时长为n-1个工作周期的高电平加上一个工作周期的脉冲宽度调制信号clk_pre，也就是驱动模块3驱动上管Q1导通的时间延长n-1个工作周期。为了避免时序冲突的产生，保证驱动模块3能够正确驱动上管Q1与下管Q2的导通与关断，在可选的实施例中，在当前检测周期内，降频状态机23接收到的第二控制信号dq为高电平，且自身向二输入或门22输出低电平时，在下一个检测周期内向二输入或门22保持输出持续的高电平或持续的低电平。本实施例中，以脉冲宽度调制信号clk_pre的占空比大于第一预设阈值为例，降频状态机23在当前若干个连续工作周期的最后一个工作周期接收到高电平的第二控制信号dq时，在下一个检测周期内向二输入或门22保持输出持续的高电平即在下一次若干个连续工作周期初增加一个状态为1的工作周期。本实施例中，实现对驱动信号clk_drv的调整的滞后性，避免了时序冲突的产生，从而保证驱动模块3能够基于驱动信号clk_drv正确驱动上管Q1与下管Q2的导通与关断，使得控制电路正确控制开关电源的输出电压。为了进一步避免震荡现象的产生，减小输出电压的纹波，在可选的实施例中，在降频状态机23接收到的第二控制信号dq为高电平，且自身向二输入或门22输出低电平的当前检测周期结束后，降频状态机23向二输入或门22输出的持续的高电平或持续的低电平的时长，与在当前检测周期开始前所输出的持续高电平或持续的低电平的时长之间的差距是一个检测周期。在具体实施例中，当第二控制信号dq为高电平时，降频状态机23增加一个工作周期，以使降频状态机23的输出信号增加一个工作周期对应的高电平；当第二控制信号dq为低电平时，降频状态机23减小一个工作周期，以使降频状态机23的输出信号减小一个工作周期对应的高电平。需要说明的是，降频状态机23至少有一个工作周期输出低电平信号，以使二输入或门22输出的驱动信号clk_drv至少在一个检测周期内输出脉冲宽度调制信号clk_pre，以保证下管Q2的导通时间。本实施例中，当前检测周期开始前后降频状态机23向二输入或门22输出的持续的高电平时长差距为一个检测周期，也就是相邻两个周期的驱动信号clk_drv的周期时长相差一个检测周期，使得驱动信号clk_drv的周期平滑变化，进一步避免了震荡现象的产生，从而减小输出电压的纹波。上面以脉冲宽度调制信号clk_pre的占空比大于第一预设阈值为例进行了说明，请参考图3，图3为本实施例公开的一种开关电源控制电路原理示意图，下面对脉冲宽度调制信号clk_pre的占空比小于第二预设阈值时的控制原理进行简要说明，本领域技术人员能够理解的是脉冲宽度调制信号clk_pre的占空比小于第二预设阈值的控制原理与脉冲宽度调制信号clk_pre的占空比大于第一预设阈值的控制原理相似，相类似的原理在此不再赘述。具体地，当脉冲宽度调制信号clk_pre的占空比小于第二预设阈值时，输出电压VOUT接近0，为了进一步减小输出电压VOUT，调频模块2在驱动信号clk_drv的低电平时期插入第一控制信号，第一控制信号为持续的低电平，以使上管Q1在第一控制信号的控制周期内保持关断，下管Q2在第一控制信号的控制周期内保持导通，从而延长下管Q2的导通时间，使得输出电压VOUT更接近0。进一步地，D触发器24的时钟信号端接收的最小检测信号clk_detect的占空比为第二预设阈值；最小检测信号clk_detect的周期与另一时钟信号clk_min的周期相同；最小检测信号clk_detect的上升沿与另一时钟信号clk_min的上升沿对齐；当脉冲宽度调制信号clk_pre的占空比小于最小检测信号clk_detect的占空比时，则确定脉冲宽度调制信号clk_pre的占空比小于第二预设阈值。最小检测信号clk_detect的占空比比另一时钟信号clk_min的占空比大预设值，最小检测信号clk_detect的下降沿到来时刻晚于另一时钟信号clk_min的下降沿到来时刻；D触发器24在最小检测信号clk_detect的下降沿到来时检测脉冲宽度调制信号clk_pre的电平，当脉冲宽度调制信号clk_pre为低电平时，则确定脉冲宽度调制信号clk_pre的占空比小于第二预设阈值，D触发器24输出低电平，调频模块2需要在驱动信号clk_drv中插入持续为0的控制信号，以延长上管Q1的关断时间。调频模块2还包括与门25，与门25用于对脉冲宽度调制信号clk_pre和另一降频状态机26的输出进行与运算，以生成驱动信号clk_drv；降频状态机26与降频状态机23原理相类似，在降频状态机26的连续若干个工作周期中，降频状态机26在至少一个工作周期输出高电平，其余工作周期输出低电平。需要说明的是，在具体实施例中，一般的场景下只需要实现提高占空比或只需要实现降低占空比，因此调频模块2只需要设置D触发器21、二输入或门22、降频状态机23，或者调频模块2只需要设置D触发器24、二输入与门25、另一降频状态机26；而即使在特殊场景下，需要同时实现提高占空比与降低占空比的控制电路，可以基于当前输出电压的大小来确定使用哪一个控制电路生成驱动信号clk_drv，也就是在输出电压接近输入电压时使用提高占空比的控制电路生成驱动信号clk_drv，在输出电压接近0时使用降低占空比的控制电路生成驱动信号clk_drv。本申请实施例还公开了一种用于开关电源的芯片，其上集成有集成电路，包括如上述实施例公开的开关电源控制电路。本申请实施例还公开了一种开关电源，包括如上述实施例公开的开关电源控制电路，或者包括如上述实施例公开的芯片。可选地，该开关电源为升压开关电源，或降压开关电源。可选地，该开关电源为升降压开关电源。本申请实施例还公开了一种电子设备，包括如上述实施例公开的开关电源。本领域的技术人员能够理解的是，在不冲突的前提下，上述各优选方案可以自由地组合、叠加。应当理解，上述的实施方式仅是示例性的，而非限制性的，在不偏离本发明的基本原理的情况下，本领域的技术人员可以针对上述细节做出的各种明显的或等同的修改或替换，都将包含于本发明的权利要求范围内。
