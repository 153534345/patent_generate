标题title
一种面向狭长空间的室内定位装置及方法
摘要abst
本发明公开了一种面向狭长空间的室内定位装置及方法，所述装置包括：控制模块、UWB定位模块、姿态测量模块、TOF激光测距模块、通信模块、后端服务器和供电模块；UWB定位模块用于对目标对象在长轴方向进行一维定位，以确定目标对象在长轴的位置；姿态测量模块用于检测目标对象的运动姿态信息；TOF激光测距模块用于测量目标对象到狭长空间短轴两侧的距离，并结合运动姿态信息修正激光测距值，以获取目标对象在短轴的位置；控制模块用于接收关于目标对象的测量信息；通信模块用于对位置信息进行通讯传输；后端服务器用于完成目标对象的二维坐标解算；供电模块用于为整个装置供电。本发明实现了狭长空间高精度室内二维定位，大幅降低室内定位系统的成本。
权利要求书clms
1.一种面向狭长空间的室内定位装置，其特征在于，所述面向狭长空间的室内定位装置包括：控制模块、UWB定位模块、姿态测量模块、TOF激光测距模块、通信模块、后端服务器和供电模块，所述控制模块分别与所述UWB定位模块、所述姿态测量模块、所述TOF激光测距模块、所述通信模块和所述供电模块连接，所述通信模块与所述后端服务器连接；UWB定位模块，用于基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置；姿态测量模块，用于检测所述目标对象的运动姿态信息；TOF激光测距模块，用于测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置；控制模块，用于接收所述UWB定位模块、所述姿态测量模块和所述TOF激光测距模块发送的关于所述目标对象的测量信息；通信模块，用于对所述目标对象的位置信息进行通讯传输；后端服务器，用于接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统；供电模块，用于为所述面向狭长空间的室内定位装置供电。2.根据权利要求1所述的面向狭长空间的室内定位装置，其特征在于，所述目标对象包括设备和人员。3.根据权利要求1所述的面向狭长空间的室内定位装置，其特征在于，所述姿态测量模块由陀螺仪、加速度计和磁力计组成。4.根据权利要求1所述的面向狭长空间的室内定位装置，其特征在于，所述TOF激光测距模块由两个垂直于所述目标对象行进方向的激光测距仪组成。5.一种基于权利要求1-4任一项所述的面向狭长空间的室内定位装置的面向狭长空间的室内定位方法，其特征在于，所述面向狭长空间的室内定位方法包括：所述UWB定位模块基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置；所述姿态测量模块检测所述目标对象的运动姿态信息，所述TOF激光测距模块测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置；所述后端服务器接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统。6.根据权利要求5所述的面向狭长空间的室内定位方法，其特征在于，所述UWB定位模块基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置，之前还包括：构建狭长空间二维坐标系，以目标对象到起点的里程为长轴坐标Y，目标对象到基准侧的距离为短轴坐标X，以坐标对表示目标对象的实时位置。7.根据权利要求6所述的面向狭长空间的室内定位方法，其特征在于，所述UWB定位模块基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置，具体包括：多个UWB定位基站以狭长空间中线为基准，从一端每隔预设距离均匀布置；各UWB定位基站通过有线连接中央时间同步器，再与后端服务器连接，构建覆盖整个狭长空间的长轴一维定位系统；长轴一维坐标计算如下：Y＝*S+d0； 其中，Y为目标对象的长轴坐标，N为目标对象前置UWB定位基站个数，S为UWB定位基站布置间隔，d0为目标对象距离前一个UWB定位基站的距离；TDOA定位技术通过目标对象向所有UWB定位基站广播超宽带脉冲，每个UWB定位基站在不同时刻接收到目标对象发送的信息，通过UWB定位基站接收信息的时间差，确定目标对象的位置；基于TDOA定位技术测得目标对象发射信号到两个UWB定位基站的飞行时间差，根据电磁波传输速度解算目标对象到两个UWB定位基站的距离差Δd；根据双曲线定义，确定目标对象实时位置在以两个UWB定位基站AP1、AP2为焦点的双曲线L1上；若目标对象同时在AP1、AP2所在的直线L2上，L1、L2由下列方程组表示：解算方程组，得到目标对象的两个模糊坐标Ptrue、Pfalse，根据目标对象到两个UWB定位基站的时间判断目标对象此时到两个UWB定位基站的距离的远近，以排除错误坐标Pfalse，得到正确坐标Ptrue；根据如下公式：计算目标对象到前一UWB定位基站AP1的距离d0，将d0代入公式得到目标对象此时在狭长空间二维坐标系中的长轴坐标Y。8.根据权利要求6所述的面向狭长空间的室内定位方法，其特征在于，所述姿态测量模块检测所述目标对象的运动姿态信息，所述TOF激光测距模块测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置，具体包括：所述TOF激光测距模块中的激光测距仪内部的高精度计时器记录激光发射时间T1和接收时间T2，结合激光飞行速度c，计算目标对象到狭长空间的两侧的距离D：D＝c*； 将两个激光测距仪安装于目标对象两侧，发射器垂直于目标对象前进方向，实时获取目标对象到两侧的距离；目标对象前进方向与狭长空间方向存在一定的夹角α，使激光测距仪的测量值D与目标对象到两侧实际垂直距离d存在误差；通过捷联惯导的姿态更新算法得到目标对象的实时姿态，解算得到出激光测距仪在某一时刻的姿态，捷联惯导的姿态更新算法表示为：/＞其中，n表示导航坐标系，b表示载体坐标系，k表示时刻，表示k时刻从载体坐标系旋转至导航坐标系的四元数，/＞表示四元数乘法，Δθk表示角速度增量，/＞表示目标对象当前姿态的四元数，/＞表示目标对象当前时刻的姿态矩阵；对当前得到的姿态通过如下公式进行相应的转换：其中，表示目标对象相对于当前平面坐标系的姿态矩阵，/＞表示最初始的平面坐标系到当前平面坐标系的变换矩阵；在三维空间中，将激光测距仪发射的光束表示为l向量，通过如下公式解算得到目标对象到狭长空间的两侧的距离：其中，l表示激光光束到两侧的原始测距信息，θ表示目标对象的俯仰角，表示目标对象的航向角。9.一种终端，其特征在于，所述终端包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的面向狭长空间的室内定位程序，所述面向狭长空间的室内定位程序被所述处理器执行时实现如权利要求5-8任一项所述的面向狭长空间的室内定位方法的步骤。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有面向狭长空间的室内定位程序，所述面向狭长空间的室内定位程序被处理器执行时实现如权利要求5-8任一项所述的面向狭长空间的室内定位方法的步骤。
说明书desc
技术领域本发明涉及计算机和位置服务技术领域，尤其涉及一种面向狭长空间的室内定位装置、方法、终端及计算机可读存储介质。背景技术狭长空间是一种常见的室内场景，包括隧道、引水洞、建筑长廊、矿井巷道、综合管廊等。其特点是长度尺寸远大于宽度且为封闭或半封闭空间，无法接收GNSS信号，该类空间范围内的移动对象定位是智能建造、基础设施安全运维的关键技术之一。为保障狭长空间内作业人员的安全，以及设备的正常运行，提高其工作的效率，实现人员设备的实时定位是极其重要的。狭长空间的室内定位多使用定位基站构成的无线传感器网络WSN，通过测量用户到多个基站的距离或信号强度等信息实现人员定位。然而要实现狭长空间高精度室内定位，无线传感器网络WSN通常需要布设大量定位基站，来提高定位精度。大量布设基站一方面会产生较大的设备成本，另一方面，设备的安装维护也会带来额外的成本。因此，传统WSN方法实现狭长空间室内定位的成本较高，极大的限制了相关技术的推广应用。基于较少UWB基站布设，仅可实现一维定位，无法满足高精度定位需求。因此，现有技术还有待于改进和发展。发明内容本发明的主要目的在于提供一种面向狭长空间的室内定位装置、方法、终端及计算机可读存储介质，旨在解决现有技术中在狭长空间进行室内定位时，基于较少UWB基站布设，仅可实现一维定位，无法满足高精度定位需求的问题。为实现上述目的，本发明提供一种面向狭长空间的室内定位装置，所述面向狭长空间的室内定位装置包括：控制模块、UWB定位模块、姿态测量模块、TOF激光测距模块、通信模块、后端服务器和供电模块，所述控制模块分别与所述UWB定位模块、所述姿态测量模块、所述TOF激光测距模块、所述通信模块和所述供电模块连接，所述通信模块与所述后端服务器连接；UWB定位模块，用于基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置；姿态测量模块，用于检测所述目标对象的运动姿态信息；TOF激光测距模块，用于测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置；控制模块，用于接收所述UWB定位模块、所述姿态测量模块和所述TOF激光测距模块发送的关于所述目标对象的测量信息；通信模块，用于对所述目标对象的位置信息进行通讯传输；后端服务器，用于接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统；供电模块，用于为所述面向狭长空间的室内定位装置供电。所述的面向狭长空间的室内定位装置，其中，所述目标对象包括设备和人员。所述的面向狭长空间的室内定位装置，其中，所述姿态测量模块由陀螺仪、加速度计和磁力计组成。所述的面向狭长空间的室内定位装置，其中，所述TOF激光测距模块由两个垂直于所述目标对象行进方向的激光测距仪组成。为实现上述目的，本发明还提供一种基于如上所述的面向狭长空间的室内定位装置的面向狭长空间的室内定位方法，所述面向狭长空间的室内定位方法包括如下步骤：所述UWB定位模块基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置；所述姿态测量模块检测所述目标对象的运动姿态信息，所述TOF激光测距模块测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置；所述后端服务器接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统。所述的面向狭长空间的室内定位方法，其中，所述UWB定位模块基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置，之前还包括：构建狭长空间二维坐标系，以目标对象到起点的里程为长轴坐标Y，目标对象到基准侧的距离为短轴坐标X，以坐标对表示目标对象的实时位置。所述的面向狭长空间的室内定位方法，其中，所述UWB定位模块基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置，具体包括：多个UWB定位基站以狭长空间中线为基准，从一端每隔预设距离均匀布置；各UWB定位基站通过有线连接中央时间同步器，再与后端服务器连接，构建覆盖整个狭长空间的长轴一维定位系统；长轴一维坐标计算如下：Y＝*S+d0； 其中，Y为目标对象的长轴坐标，N为目标对象前置UWB定位基站个数，S为UWB定位基站布置间隔，d0为目标对象距离前一个UWB定位基站的距离；TDOA定位技术通过目标对象向所有UWB定位基站广播超宽带脉冲，每个UWB定位基站在不同时刻接收到目标对象发送的信息，通过UWB定位基站接收信息的时间差，确定目标对象的位置；基于TDOA定位技术测得目标对象发射信号到两个UWB定位基站的飞行时间差，根据电磁波传输速度解算目标对象到两个UWB定位基站的距离差Δd；根据双曲线定义，确定目标对象实时位置在以两个UWB定位基站AP1、AP2为焦点的双曲线L1上；若目标对象同时在AP1、AP2所在的直线L2上，L1、L2由下列方程组表示：解算方程组，得到目标对象的两个模糊坐标Ptrue、Pfalse，根据目标对象到两个UWB定位基站的时间判断目标对象此时到两个UWB定位基站的距离的远近，以排除错误坐标Pfalse，得到正确坐标Ptrue；根据如下公式：计算目标对象到前一UWB定位基站AP1的距离d0，将d0代入公式得到目标对象此时在狭长空间二维坐标系中的长轴坐标Y。所述的面向狭长空间的室内定位方法，其中，所述姿态测量模块检测所述目标对象的运动姿态信息，所述TOF激光测距模块测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置，具体包括：所述TOF激光测距模块中的激光测距仪内部的高精度计时器记录激光发射时间T1和接收时间T2，结合激光飞行速度c，计算目标对象到狭长空间的两侧的距离D：D＝c*； 将两个激光测距仪安装于目标对象两侧，发射器垂直于目标对象前进方向，实时获取目标对象到两侧的距离；目标对象前进方向与狭长空间方向存在一定的夹角α，使激光测距仪的测量值D与目标对象到两侧实际垂直距离d存在误差；通过捷联惯导的姿态更新算法得到目标对象的实时姿态，解算得到出激光测距仪在某一时刻的姿态，捷联惯导的姿态更新算法表示为：其中，n表示导航坐标系，b表示载体坐标系，k表示时刻，表示k时刻从载体坐标系旋转至导航坐标系的四元数，o表示四元数乘法，Δθk表示角速度增量，/＞表示目标对象当前姿态的四元数，/＞表示目标对象当前时刻的姿态矩阵；对当前得到的姿态通过如下公式进行相应的转换：其中，表示目标对象相对于当前平面坐标系的姿态矩阵，/＞表示最初始的平面坐标系到当前平面坐标系的变换矩阵；在三维空间中，将激光测距仪发射的光束表示为l向量，通过如下公式解算得到目标对象到狭长空间的两侧的距离：其中，l表示激光光束到两侧的原始测距信息，θ表示目标对象的俯仰角，表示目标对象的航向角。此外，为实现上述目的，本发明还提供一种终端，其中，所述终端包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的面向狭长空间的室内定位程序，所述面向狭长空间的室内定位程序被所述处理器执行时实现如上所述的面向狭长空间的室内定位方法的步骤。此外，为实现上述目的，本发明还提供一种计算机可读存储介质，其中，所述计算机可读存储介质存储有面向狭长空间的室内定位程序，所述面向狭长空间的室内定位程序被处理器执行时实现如上所述的面向狭长空间的室内定位方法的步骤。本发明中，所述装置包括：控制模块、UWB定位模块、姿态测量模块、TOF激光测距模块、通信模块、后端服务器和供电模块，所述控制模块分别与所述UWB定位模块、所述姿态测量模块、所述TOF激光测距模块、所述通信模块和所述供电模块连接，所述通信模块与所述后端服务器连接；UWB定位模块，用于基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置；姿态测量模块，用于检测所述目标对象的运动姿态信息；TOF激光测距模块，用于测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置；控制模块，用于接收所述UWB定位模块、所述姿态测量模块和所述TOF激光测距模块发送的关于所述目标对象的测量信息；通信模块，用于对所述目标对象的位置信息进行通讯传输；后端服务器，用于接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统；供电模块，用于为所述面向狭长空间的室内定位装置供电。本发明结合超宽带、TOF激光测距以及姿态测量模块的狭长空间室内定位装置及方法，该装置仅需少量定位基站，即可实现狭长空间高精度室内二维定位，大幅降低室内定位系统的成本。附图说明图1是本发明面向狭长空间的室内定位装置的较佳实施例的原理示意图；图2是本发明面向狭长空间的室内定位方法的较佳实施例的流程图；图3是本发明面向狭长空间的室内定位方法的较佳实施例中构建的狭长空间二维坐标系的示意图；图4是本发明面向狭长空间的室内定位方法的较佳实施例中多个UWB定位基站布设示意图；图5是本发明面向狭长空间的室内定位方法的较佳实施例中多个UWB定位基站时间同步的示意图；图6是本发明面向狭长空间的室内定位方法的较佳实施例中UWB一维定位原理图；图7是本发明面向狭长空间的室内定位方法的较佳实施例中TOF激光测距原理示意图；图8是本发明面向狭长空间的室内定位方法的较佳实施例中目标对象姿态修正的示意图；图9是本发明面向狭长空间的室内定位方法的较佳实施例中激光光束的三维空间图；图10为本发明终端的较佳实施例的运行环境示意图。具体实施方式为使本发明的目的、技术方案及优点更加清楚、明确，以下参照附图并举实施例对本发明进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。本发明较佳实施例所述的面向狭长空间的室内定位装置，如图1所示，所述面向狭长空间的室内定位装置包括：控制模块、UWB定位模块、姿态测量模块、TOF激光测距模块、通信模块、后端服务器和供电模块，所述控制模块分别与所述UWB定位模块、所述姿态测量模块、所述TOF激光测距模块、所述通信模块和所述供电模块连接，所述通信模块与所述后端服务器连接。其中，UWB定位模块，用于基于预先布设的UWB定位基站)对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置。其中，姿态测量模块，用于检测所述目标对象的运动姿态信息。其中，TOF激光测距模块，用于测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置。其中，控制模块，用于接收所述UWB定位模块、所述姿态测量模块和所述TOF激光测距模块发送的关于所述目标对象的测量信息。其中，通信模块，用于对所述目标对象的位置信息进行通讯传输。其中，后端服务器，用于接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统。其中，供电模块，用于为所述面向狭长空间的室内定位装置供电。具体地，所述姿态测量模块由陀螺仪、加速度计和磁力计组成。具体地，所述TOF激光测距模块由两个垂直于所述目标对象行进方向的激光测距仪组成。针对狭长室内环境，首先采用UWB一维定位技术，确定目标对象在长轴的位置；同时利用TOF激光测距传感器测量目标对象到两侧的距离，结合姿态测量模块测量的目标对象运动姿态等信息修正激光测距值，以获取目标对象在短轴的位置；通过通信模块将上述传感器获取的数据传递给后端服务器，并在后端服务器上完成设备的二维坐标解算；结合UWB长轴测距及TOF短轴测距结果，实现在狭长空间的二维定位。仅需布设较少数目的UWB定位基站，即可实现高精度二维定位，大幅降低了定位服务的成本。进一步地，基于所述面向狭长空间的室内定位装置，本发明较佳实施例所述的面向狭长空间的室内定位方法，如图2所示，所述面向狭长空间的室内定位方法包括以下步骤：步骤S10、所述UWB定位模块基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置；步骤S20、所述姿态测量模块检测所述目标对象的运动姿态信息，所述TOF激光测距模块测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置；步骤S30、所述后端服务器接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统。狭长空间如隧道、地铁等具有里程较长、形状弯曲等特点，常规平面直角坐标系无法直观表示人员或设备的位置，并且弯曲场景下，平面坐标不易通过测量获取。因此本发明构建了一种简单、实用的狭长空间下二维坐标系。该坐标系能够直观表示人员或设备距离长轴起点的里程和到短轴基准测的距离，且易于测量。具体地，如图3所示，构建狭长空间二维坐标系：以目标对象到起点的里程为长轴坐标Y，目标对象到基准侧的距离为短轴坐标X，以坐标对表示目标对象的实时位置，例如P1、P2、P3。长轴定位具有距离长、场景重复等特点，在隧道、引水洞等特殊场景下，还有照度低等挑战。常规视觉定位方法和指纹匹配定位难以达到室内高精度定位需求。本发明采用UWB定位技术来确定长轴位置，UWB定位技术通过发射超宽带信号，并通过接收和处理这些信号来确定目标物体的位置。UWB定位系统与传统的窄带系统相比，具有穿透力强、功耗低、抗多路径效果好、安全性高、系统复杂度低、能提供精确定位精度等优点。因此，UWB定位技术可以应用于室内静止或者移动物体以及人的定位跟踪与导航，且能提供十分精确的定位精度。如图4所示，多个UWB定位基站以狭长空间中线为基准，从一端每隔预设距离均匀布置；各UWB定位基站通过有线连接中央时间同步器，再与后端服务器连接，构建覆盖整个狭长空间的长轴一维定位系统；长轴一维坐标计算如下：Y＝*S+d0； 其中，Y为目标对象的长轴坐标，N为目标对象前置UWB定位基站个数，S为UWB定位基站布置间隔，d0为目标对象距离前一个UWB定位基站的距离。TDOA定位技术要求所有UWB定位基站时钟严格同步，TDOA定位技术通过目标对象向所有UWB定位基站广播超宽带脉冲，每个UWB定位基站在不同时刻接收到目标对象发送的信息，可以通过UWB定位基站接收信息的时间差，确定目标对象的位置。该方法有以下几个特点：a)进行一维定位至少需要2个UWB定位基站，UWB定位基站坐标已知；b)所有UWB定位基站之间需进行同步，目标对象无需与UWB定位基站之间进行同步；c)目标对象只发送信号，不进行接收，比较节省功耗。UWB定位基站时间同步采用有线同步的方式，有线时间同步可将误差控制在0.1ns以内，同步精度非常高。该同步方法需要一个中央时间同步器通过有线连接各个UWB定位基站，如图5所示。在本发明中，长轴定位采用UWB定位技术，测距定位方法为达到时间差测量法，即通过到达时间的不同进行位置测量，原理如图6所示。基于TDOA定位技术测得目标对象发射信号到两个UWB定位基站的飞行时间差，根据电磁波传输速度解算目标对象到两个UWB定位基站的距离差Δd。根据双曲线定义，可以确定目标对象实时位置在以两个UWB定位基站AP1、AP2为焦点的双曲线L1上。由于UWB只做一维定位，可以假定目标对象同时在AP1、AP2所在的直线L2上，L1、L2由下列方程组表示：解算方程组，得到目标对象的两个模糊坐标Ptrue、Pfalse，根据目标对象到两个UWB定位基站的时间可以判断目标对象此时到两个UWB定位基站的距离的远近，以此排除错误坐标Pfalse，得到正确坐标Ptrue。再根据如下公式：计算目标对象到前一UWB定位基站AP1的距离d0，将d0代入公式得到目标对象此时在狭长空间二维坐标系中的长轴坐标Y。TOF是利用电磁波飞行时间的测距方法，大量应用于激光雷达、深度相机等距离测量传感器上。TOF激光测距设备主要由发射器、接收器、高精度计时器组成。发射器发射出已调制的激光光束，光束到达观测物表面并反射回接收器，通过高精度计时器得到发射和接收激光的时间差和激光飞行速度计算距离。TOF激光雷达的原理图如图7所示，所述TOF激光测距模块中的激光测距仪内部的高精度计时器记录激光发射时间T1和接收时间T2，结合激光飞行速度c，计算目标对象到狭长空间的两侧的距离D：D＝c*； 将两个激光测距仪安装于目标对象两侧，发射器垂直于目标对象前进方向，实时获取目标对象到两侧的距离；如图8所示，目标对象不会严格平行于狭长空间两侧方向前进，前进方向与狭长空间方向存在一定的夹角α，使激光测距仪的测量值D与目标对象到两侧实际垂直距离d存在误差。由于激光测距仪固定在目标对象两侧，可以认为激光测距仪的姿态与设备的姿态保持一致，而目标对象搭载姿态测量模块，可通过捷联惯导的姿态更新算法可以得到目标对象的实时姿态，进而可以解算得到出激光测距仪在某一时刻的姿态，捷联惯导的姿态更新算法表示为：/＞其中，n表示导航坐标系，b表示载体坐标系，k表示时刻，表示k时刻从载体坐标系旋转至导航坐标系的四元数，o表示四元数乘法，Δθk表示角速度增量，/＞表示目标对象当前姿态的四元数，/＞表示目标对象当前时刻的姿态矩阵。通过捷联惯导的姿态更新算法得到的姿态是相对于最初始的平面坐标系，由于后续对短轴的位置解算需要用到相对于当前平面坐标系的设备姿态，对当前得到的姿态通过如下公式进行相应的转换：其中，表示目标对象相对于当前平面坐标系的姿态矩阵，/＞表示最初始的平面坐标系到当前平面坐标系的变换矩阵。如图9所示，在三维空间中，可将激光测距仪发射的光束表示为l向量，利用上述计算所求的姿态角，通过如下公式解算得到目标对象到狭长空间的两侧的距离：其中，l表示激光光束到两侧的原始测距信息，θ表示目标对象的俯仰角，表示目标对象的航向角。本发明提供了一种集成UWB、TOF激光测距和姿态测量模块的室内定位装置，该装置由供电模块、控制模块、UWB定位模块、TOF激光测距模块、姿态测量模块、通信模块以及后端服务器组成。结合狭长空间特点和定位需求，该装置充分运用UWB、TOF激光测距和姿态测量模块的功能，解决了狭长空间的二维定位需求，同时降低了仅用UWB定位的高额定位成本。同时，本发明提出了一种融合UWB、TOF激光测距和惯导设备的狭长空间二维定位方法，该方法结合狭长空间定位需求，将二维定位分解为长轴和短轴的一维定位，定位结果能直观表示被测物体在狭长空间的具体位置。在该定位方法下，长轴定位采用UWB定位技术测量长轴坐标，短轴定位采用TOF激光测距和姿态测量模块测量短轴坐标。由于UWB采用一维定位方式，只需测距值，不需要解算二维坐标，因此，实现了仅用少量UWB定位基站，实现了狭长空间二维高精度室内定位，大幅降低了定位服务的成本。另外，长轴定位技术不局限于UWB定位技术，可以采用蓝牙、WIFI等射频定位技术。面向不同的需求，可灵活更换相应的技术，如定位精度需要较低的情况下，可采用其他更合适的射频定位技术。另外，射频测距定位方法不局限于TDOA测距定位方法，还可以采用达到时间测量法、基于接收信号强度测量法等。以TOA为例，无线信号的传播速度是一定的，根据节点发送信号到接收节点时传播时间的长短可以确定节点间的距离。根据设备或人员到不同基站的距离，通过距离交会法，确定设备或人员的位置，如下所示：2+2＝d12；2+2＝d22；…………2+2＝dn2；其中，、……为信号基站已知坐标，为设备或人员待测坐标，d1、d2、……dn为设备或人员到各基站的距离。进一步地，如图10所示，基于上述面向狭长空间的室内定位方法和系统，本发明还相应提供了一种终端，所述终端包括处理器10、存储器20及显示器30。图10仅示出了终端的部分组件，但是应理解的是，并不要求实施所有示出的组件，可以替代的实施更多或者更少的组件。所述存储器20在一些实施例中可以是所述终端的内部存储单元，例如终端的硬盘或内存。所述存储器20在另一些实施例中也可以是所述终端的外部存储设备，例如所述终端上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，所述存储器20还可以既包括所述终端的内部存储单元也包括外部存储设备。所述存储器20用于存储安装于所述终端的应用软件及各类数据，例如所述安装终端的程序代码等。所述存储器20还可以用于暂时地存储已经输出或者将要输出的数据。在一实施例中，存储器20上存储有面向狭长空间的室内定位程序40，该面向狭长空间的室内定位程序40可被处理器10所执行，从而实现本申请中面向狭长空间的室内定位方法。所述处理器10在一些实施例中可以是一中央处理器，微处理器或其他数据处理芯片，用于运行所述存储器20中存储的程序代码或处理数据，例如执行所述面向狭长空间的室内定位方法等。所述显示器30在一些实施例中可以是LED显示器、液晶显示器、触控式液晶显示器以及OLED触摸器等。所述显示器30用于显示在所述终端的信息以及用于显示可视化的用户界面。所述终端的部件10-30通过系统总线相互通信。在一实施例中，当处理器10执行所述存储器20中面向狭长空间的室内定位程序40时实现如上所述面向狭长空间的室内定位方法的步骤。本发明还提供一种计算机可读存储介质，其中，所述计算机可读存储介质存储有面向狭长空间的室内定位程序，所述面向狭长空间的室内定位程序被处理器执行时实现如上所述的面向狭长空间的室内定位方法的步骤。综上所述，本发明提供一种面向狭长空间的室内定位装置、方法、终端及计算机可读存储介质，所述装置包括：控制模块、UWB定位模块、姿态测量模块、TOF激光测距模块、通信模块、后端服务器和供电模块，所述控制模块分别与所述UWB定位模块、所述姿态测量模块、所述TOF激光测距模块、所述通信模块和所述供电模块连接，所述通信模块与所述后端服务器连接；UWB定位模块，用于基于预先布设的UWB定位基站对目标对象在长轴方向进行一维定位，以确定所述目标对象在长轴的位置；姿态测量模块，用于检测所述目标对象的运动姿态信息；TOF激光测距模块，用于测量所述目标对象到狭长空间短轴两侧的距离，并结合所述运动姿态信息修正激光测距值，以获取所述目标对象在短轴的位置；控制模块，用于接收所述UWB定位模块、所述姿态测量模块和所述TOF激光测距模块发送的关于所述目标对象的测量信息；通信模块，用于对所述目标对象的位置信息进行通讯传输；后端服务器，用于接收所述通信模块传输的信息，完成所述目标对象的二维坐标解算，并提供给目标对象管理系统；供电模块，用于为所述面向狭长空间的室内定位装置供电。本发明结合超宽带、TOF激光测距以姿态测量模块的狭长空间室内定位装置及方法，该装置仅需少量定位基站，即可实现狭长空间高精度室内二维定位，大幅降低室内定位系统的成本。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者终端不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者终端所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者终端中还存在另外的相同要素。当然，本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关硬件来完成，所述的程序可存储于一计算机可读取的计算机可读存储介质中，所述程序在执行时可包括如上述各方法实施例的流程。其中所述的计算机可读存储介质可为存储器、磁碟、光盘等。应当理解的是，本发明的应用不限于上述的举例，对本领域普通技术人员来说，可以根据上述说明加以改进或变换，所有这些改进和变换都应属于本发明所附权利要求的保护范围。
