标题title
用于安防工程远程智能监控方法
摘要abst
本发明涉及图像加密传输领域，具体涉及用于安防工程远程智能监控方法，该方法包括：对明文图像分块获得所有明文图像块；根据灰度均值和灰度方差对所有明文图像块排列获得图像循环矩阵；根据第一目标列对明文图像进行块间置乱获得初始密文图像；计算所有尺寸对应的初始密文图像的混乱度，将混乱度最大的初始密文图像记为目标密文图像；根据灰度值对所有明文像素点排列获得块循环矩阵；根据第二目标列对目标密文图像进行块内置乱，获得密文图像。本发明通过对明文图像进行块间置乱和块内置乱，对于所有的明文图像都具有较强的置乱效果，打破了明文图像中像素点之间的强关联性，实现对明文图像加密，维护用户的合法权益，保护用户隐私。
权利要求书clms
1.用于安防工程远程智能监控方法，其特征在于，所述方法包括：获取明文图像；获得所有的尺寸；获得任意一种尺寸对应的初始密文图像的混乱度，包括：根据任意一种尺寸对明文图像进行分块获得所有明文图像块；将组成明文图像块的所有明文像素点的灰度值的均值记为明文图像块的灰度均值，将组成明文图像块的所有明文像素点的灰度值的方差记为明文图像块的灰度方差； 根据灰度均值和灰度方差对所有明文图像块进行排列，获得明文图像的图像循环矩阵；根据第一子密钥获得图像循环矩阵的第一目标列，根据第一目标列中所有明文图像块的顺序对所有明文图像块重排，获得初始密文图像；计算明文像素点的二值模式，根据明文图像和初始密文图像中所有明文像素点的灰度值和二值模式，计算初始密文图像的混乱度；获得所有的尺寸对应的初始密文图像的混乱度，将混乱度最大的初始密文图像记为目标密文图像；根据第二子密钥获得混沌序列；获取目标密文图像中的任意一个明文图像块对应的密文图像块，包括：根据灰度值对明文图像块的所有明文像素点进行排列，获得明文图像块的块循环矩阵；根据混沌序列获得明文图像块的混沌值，将块循环矩阵中列号等于混沌值的列记为第二目标列，根据第二目标列中所有明文像素点的顺序对所有明文像素点进行重排，获得密文图像块；将目标密文图像中的所有明文图像块对应的密文图像块按照顺序组成的图像记为密文图像。2.根据权利要求1所述的用于安防工程远程智能监控方法，其特征在于，所述获得所有的尺寸的步骤包括：尺寸为m×n的明文图像块，其中，m的取值范围为，n的取值范围为，则共有11×11=121种不同的尺寸，M×N为明文图像的尺寸，/＞表示向上取整。3.根据权利要求1所述的用于安防工程远程智能监控方法，其特征在于，所述根据任意一种尺寸对明文图像进行分块获得所有明文图像块，包括的具体步骤如下：根据尺寸m×n将明文图像划分为大小为m×n的明文图像块，具体为：通过填充灰度值为0的像素点，将明文图像扩充为大小为的明文图像，将明文图像划分为大小为m×n的明文图像块，获得G个明文图像块，/＞，每个明文图像块中明文像素点的数量为m×n个，M×N为明文图像的尺寸。4.根据权利要求1所述的用于安防工程远程智能监控方法，其特征在于，所述获得明文图像的图像循环矩阵，包括的具体步骤如下：按照从左到右、从上到下的顺序对明文图像中的所有明文图像块进行排列，获得明文图像的第一序列；将明文图像的第一序列进行循环左移，每次循环左移一位，每循环左移一次，获得一个新的第一序列，经过G次循环左移得到G个新的第一序列，其中，G表示明文图像的第一序列的长度；将新的第一序列中第一个明文图像块的灰度均值和灰度方差作为新的第一序列的均值和方差，根据均值和方差对所有新的第一序列进行排序，具体为：按照均值从小到大的顺序对所有新的第一序列进行排列，对于均值相同的新的第一序列，按照方差从小到大的顺序进行排列，对于方差相同的新的第一序列，按照获得顺序进行排列；按照顺序将所有新的第一序列组成的矩阵记为明文图像的图像循环矩阵，每个新的第一序列作为图像循环矩阵中的一行。5.根据权利要求1所述的用于安防工程远程智能监控方法，其特征在于，所述计算明文像素点的二值模式，包括的具体步骤如下：以任意一个明文像素点为中心像素点，计算中心像素点的特征值的具体计算公式为：式中，T表示中心像素点的特征值，K表示中心像素点的邻域内明文像素点的数量，/＞表示中心像素点的邻域内的第s个明文像素点的灰度值，/＞表示中心像素点的灰度值，/＞表示取绝对值；判断中心像素点的邻域内所有明文像素点的特征值与中心像素点的特征值的关系：对于邻域内任意一个明文像素点，如果明文像素点的特征值不小于中心像素点的特征值，则该明文像素点的二值码为1，否则该明文像素点的二值码为0；将邻域内所有明文像素点的二值码组成的二值序列，记为中心像素点的二值模式，获得明文像素点的二值模式。6.根据权利要求1所述的用于安防工程远程智能监控方法，其特征在于，所述计算初始密文图像的混乱度，包括的具体步骤如下：计算尺寸对应的初始密文图像的混乱度的具体计算公式为：式中，/＞表示尺寸对应的初始密文图像的混乱度，P表示尺寸对应的明文图像中明文像素点的数量，/＞表示明文图像中的j个明文像素点的二值模式，/＞表示初始密文图像中的j个明文像素点的二值模式，/＞表示明文图像中的j个明文像素点的二值模式/＞与初始密文图像中的j个明文像素点的二值模式/＞的汉明距离，/＞表示明文图像中的j个明文像素点的灰度值，表示初始密文图像中的j个明文像素点的灰度值，/＞表示取绝对值，/＞和/＞为系数。7.根据权利要求1所述的用于安防工程远程智能监控方法，其特征在于，所述获得明文图像块的块循环矩阵，包括的具体步骤如下：按照从左到右、从上到下的顺序对组成该明文图像块的所有明文像素点进行排序，获得明文图像块的第二序列；将明文图像块的第二序列进行循环左移，每次循环左移一位，每循环左移一次，获得一个新的第二序列，经过m×n次循环左移得到m×n个新的第二序列，其中，m×n表示明文图像块的第二序列的长度；将新的第二序列中第一个明文像素点的灰度值作为新的第二序列的灰度值，按照灰度值从小到大的顺序对所有新的第二序列进行排列，对于灰度值相同的新的第二序列，按照获得顺序进行排列；按照顺序将所有新的第二序列组成的矩阵记为明文图像块的块循环矩阵，每个新的第二序列作为块循环矩阵中的一行，明文图像块的块循环矩阵既是明文图像块的所有明文像素点重排后的结果。
说明书desc
技术领域本发明涉及数据加密传输领域，具体涉及用于安防工程远程智能监控方法。背景技术安防摄像头因其灵敏度高、抗强光、畸变小、体积小、寿命长、抗震、可通过远程控制监测等特点，被广泛应用与安防系统中。通过安防摄像头采集的监控视频需要传输至终端设备进行查看和分析和存储，为保证通信的效率，安防摄像头与终端设备一般采用蓝牙通信，如果以明文的形式进行传输，在受到攻击时，明文很容易被窃取泄露，导致用户隐私信息被泄露。为了维护用户的合法权益，保护用户隐私，需要对明文图像进行加密传输，常规的图像加密方法是基于混沌映射进行的，将明文图像中像素点的位置打乱，使其变换成杂乱无章难以辨认的密文图片，虽然基于混沌映射的图像加密方法打破了图像中像素点之间的强关联性，但是无法保证对于所有的明文图像都具有较强的置乱效果。发明内容为了解决上述问题，本发明提供用于安防工程远程智能监控方法，所述方法包括：获取明文图像；获得所有的尺寸；获得任意一种尺寸对应的初始密文图像的混乱度，包括：根据任意一种尺寸对明文图像进行分块获得所有明文图像块；将组成明文图像块的所有明文像素点的灰度值的均值记为明文图像块的灰度均值，将组成明文图像块的所有明文像素点的灰度值的方差记为明文图像块的灰度方差； 根据灰度均值和灰度方差对所有明文图像块进行排列，获得明文图像的图像循环矩阵；根据第一子密钥获得图像循环矩阵的第一目标列，根据第一目标列中所有明文图像块的顺序对所有明文图像块重排，获得初始密文图像；计算明文像素点的二值模式，根据明文图像和初始密文图像中所有尺寸为m×n的明文图像块，其中，m的取值范围为明文像素点的灰度值和二值模式，计算初始密文图像的混乱度；获得所有的尺寸对应的初始密文图像的混乱度，将混乱度最大的初始密文图像记为目标密文图像；根据第二子密钥获得混沌序列；获取目标密文图像中的任意一个明文图像块对应的密文图像块，包括：根据灰度值对明文图像块的所有明文像素点进行排列，获得明文图像块的块循环矩阵；根据混沌序列获得明文图像块的混沌值，将块循环矩阵中列号等于混沌值的列记为第二目标列，根据第二目标列中所有明文像素点的顺序对所有明文像素点进行重排，获得密文图像块；将目标密文图像中的所有明文图像块对应的密文图像块按照顺序组成的图像记为密文图像。进一步地，所述获得所有的尺寸的步骤包括：尺寸为m×n的明文图像块，其中，m的取值范围为，n的取值范围为/＞，则共有11×11=121种不同的尺寸，M×N为明文图像的尺寸，/＞表示向上取整。进一步地，所述根据任意一种尺寸对明文图像进行分块获得所有明文图像块，包括的具体步骤如下：根据尺寸m×n将明文图像划分为大小为m×n的明文图像块，具体为：通过填充灰度值为0的像素点，将明文图像扩充为大小为的明文图像，将明文图像划分为大小为m×n的明文图像块，获得G个明文图像块，/＞，每个明文图像块中明文像素点的数量为m×n个，M×N为明文图像的尺寸。进一步地，所述获得明文图像的图像循环矩阵，包括的具体步骤如下：按照从左到右、从上到下的顺序对明文图像中的所有明文图像块进行排列，获得明文图像的第一序列；将明文图像的第一序列进行循环左移，每次循环左移一位，每循环左移一次，获得一个新的第一序列，经过G次循环左移得到G个新的第一序列，其中，G表示明文图像的第一序列的长度；将新的第一序列中第一个明文图像块的灰度均值和灰度方差作为新的第一序列的均值和方差，根据均值和方差对所有新的第一序列进行排序，具体为：按照均值从小到大的顺序对所有新的第一序列进行排列，对于均值相同的新的第一序列，按照方差从小到大的顺序进行排列，对于方差相同的新的第一序列，按照获得顺序进行排列；按照顺序将所有新的第一序列组成的矩阵记为明文图像的图像循环矩阵，每个新的第一序列作为图像循环矩阵中的一行。进一步地，所述计算明文像素点的二值模式，包括的具体步骤如下：以任意一个明文像素点为中心像素点，计算中心像素点的特征值的具体计算公式为：式中，T表示中心像素点的特征值，K表示中心像素点的邻域内明文像素点的数量，表示中心像素点的邻域内的第s个明文像素点的灰度值，/＞表示中心像素点的灰度值，表示取绝对值；判断中心像素点的邻域内所有明文像素点的特征值与中心像素点的特征值的关系：对于邻域内任意一个明文像素点，如果明文像素点的特征值不小于中心像素点的特征值，则该明文像素点的二值码为1，否则该明文像素点的二值码为0；将邻域内所有明文像素点的二值码组成的二值序列，记为中心像素点的二值模式，获得明文像素点的二值模式。进一步地，所述计算初始密文图像的混乱度，包括的具体步骤如下：计算尺寸对应的初始密文图像的混乱度的具体计算公式为：/＞式中，表示尺寸对应的初始密文图像的混乱度，P表示尺寸对应的明文图像中明文像素点的数量，/＞表示明文图像中的j个明文像素点的二值模式，/＞表示初始密文图像中的j个明文像素点的二值模式，/＞表示明文图像中的j个明文像素点的二值模式/＞与初始密文图像中的j个明文像素点的二值模式/＞的汉明距离，/＞表示明文图像中的j个明文像素点的灰度值，/＞表示初始密文图像中的j个明文像素点的灰度值， /＞表示取绝对值，/＞和/＞为系数。进一步地，所述获得明文图像块的块循环矩阵，包括的具体步骤如下：按照从左到右、从上到下的顺序对组成该明文图像块的所有明文像素点进行排序，获得明文图像块的第二序列；将明文图像块的第二序列进行循环左移，每次循环左移一位，每循环左移一次，获得一个新的第二序列，经过m×n次循环左移得到m×n个新的第二序列，其中，m×n表示明文图像块的第二序列的长度；将新的第二序列中第一个明文像素点的灰度值作为新的第二序列的灰度值，按照灰度值从小到大的顺序对所有新的第二序列进行排列，对于灰度值相同的新的第二序列，按照获得顺序进行排列；按照顺序将所有新的第二序列组成的矩阵记为明文图像块的块循环矩阵，每个新的第二序列作为块循环矩阵中的一行，明文图像块的块循环矩阵既是明文图像块的所有明文像素点重排后的结果。本发明实施例至少具有如下有益效果：本发明根据不同尺寸对明文图像分块获得所有明文图像块，根据灰度均值和灰度方差对所有明文图像块排列获得图像循环矩阵，根据图像循环矩阵第一目标列对明文图像进行块间置乱获得初始密文图像；计算所有尺寸对应的初始密文图像的混乱度，将混乱度最大的初始密文图像记为目标密文图像；根据灰度值对所有明文像素点排列获得块循环矩阵，根据块循环矩阵的第二目标列对目标密文图像进行块内置乱，获得密文图像。通过块间置乱后的初始密文图像的混乱度获得混乱度最大的目标密文图像，进而对目标密文图像进行块内置乱获得密文图像，因此，本发明的加密方法对于所有的明文图像都具有较强的置乱效果，打破了明文图像中像素点之间的强关联性，实现对明文图像加密，维护用户的合法权益，保护用户隐私。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明一个实施例提供的用于安防工程远程智能监控方法的步骤流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的用于安防工程远程智能监控方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构、或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的用于安防工程远程智能监控方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的用于安防工程远程智能监控方法的步骤流程图，该方法包括以下步骤：S001，获取明文图像。通过设置的安防摄像头采集监控视频，将监控视频的每一帧图像作为明文图像。S002，获得所有的尺寸，根据尺寸对明文图像进行分块，获得所有明文图像块；根据灰度均值和灰度方差对所有明文图像块进行排列，获得图像循环矩阵；根据第一子密钥获得图像循环矩阵的第一目标列，根据第一目标列对明文图像进行块间置乱，获得初始密文图像获得初始密文图像。需要说明的是，本发明通过尺寸对明文图像进行分块，通过对明文图像块进行块间置乱，获得初始密文图像，由于对明文图像进行分块的尺寸有多种，为了获得加密效果最好的初始密文图像，需要获得不同尺寸下的初始密文图像，具体方法如下：1、获得所有的尺寸。尺寸为m×n的明文图像块，其中，m的取值范围为，n的取值范围为/＞，则共有11×11=121种不同的尺寸，M×N为明文图像的尺寸，/＞表示向上取整。2、根据尺寸对明文图像进行分块，获得所有明文图像块。对于任意一种尺寸，根据该尺寸将明文图像划分为大小为m×n的明文图像块，具体为：通过填充灰度值为0的像素点，将明文图像扩充为大小为的明文图像，将明文图像划分为大小为m×n的明文图像块，则明文图像被划分为G个明文图像块，/＞，每个明文图像块中明文像素点的数量为m×n个。3、根据灰度均值和灰度方差对所有明文图像块进行排列，获得图像循环矩阵。计算每个明文图像块的灰度均值和灰度方差。对于任意一个明文图像块，获取组成该明文图像块的所有明文像素点的灰度值，计算所有明文像素点的灰度值的均值，记为该明文图像块的灰度均值；计算所有明文像素点的灰度值的方差，记为该明文图像块的灰度方差。根据灰度均值和灰度方差对所有明文图像块进行排列，获得图像循环矩阵。按照从左到右、从上到下的顺序对明文图像中的所有明文图像块进行排列，获得明文图像的第一序列。将明文图像的第一序列进行循环左移，每次循环左移一位，每循环左移一次，获得一个新的第一序列，经过G次循环左移得到G个新的第一序列，其中，G表示明文图像的第一序列的长度。将新的第一序列中第一个明文图像块的灰度均值和灰度方差作为新的第一序列的均值和方差，根据均值和方差对所有新的第一序列进行排序，具体为：按照均值从小到大的顺序对所有新的第一序列进行排列，对于均值相同的新的第一序列，按照方差从小到大的顺序进行排列，对于方差相同的新的第一序列，按照获得顺序进行排列；按照顺序将所有新的第一序列组成的矩阵记为明文图像的图像循环矩阵，每个新的第一序列作为图像循环矩阵中的一行，明文图像的图像循环矩阵既是明文图像的所有明文图像块重排后的结果。4、根据第一子密钥获得图像循环矩阵的第一目标列，根据第一目标列对明文图像进行块间置乱，获得初始密文图像。在的范围内随机产生一个数值记为第一子密钥，将图像循环矩阵中列号等于/＞的列记为图像循环矩阵的第一目标列，G表示明文图像的第一序列的长度，/＞表示向上取整，根据图像循环矩阵的第一目标列中所有明文图像块的顺序，对所有明文图像块进行重排，实现对所有明文图像块进行块间置乱，将块间置乱后的图像记为初始密文图像。需要说明的是，第一子密钥是发送端和接收端事先约定好的，在整个加密过程中只获取一次，并在发送端和接收端进行存储，因此，在传输密文图像时，不需要对第一子密钥进行传输，保证了密钥的安全性。S003，计算明文像素点的特征值，获得明文像素点的二值模式，根据明文像素点的灰度值和二值模式，计算初始密文图像的混乱度；根据混乱度获得目标密文图像。需要说明的是，本发明对明文图像进行分块获得明文图像块，通过对所有明文图像块进行块间置乱，使置乱后的初始密文图像相对于明文图像在视觉上混乱，并且初始密文图像相对于明文图像的混乱度越大，则说明置乱效果越好。相应的初始密文图像的加密效果越好。在本实施例中，对于任意一种尺寸，通过上述步骤S002，获得该尺寸下对应的初始密文图像，根据明文图像和初始密文图像中所有明文像素点的灰度值和二值模式，计算初始密文图像的混乱度，根据混乱度获得目标密文图像，具体步骤如下：1、计算明文像素点的特征值，获得明文像素点的二值模式。以任意一个明文像素点为中心像素点，计算中心像素点的特征值的具体计算公式为：式中，T表示中心像素点的特征值，K表示中心像素点的邻域内明文像素点的数量，表示中心像素点的邻域内的第s个明文像素点的灰度值，/＞表示中心像素点的灰度值，表示取绝对值。判断中心像素点的邻域内所有明文像素点的特征值与中心像素点的特征值的关系：对于邻域内任意一个明文像素点，如果明文像素点的特征值不小于中心像素点的特征值，则该明文像素点的二值码为1，否则该明文像素点的二值码为0；将邻域内所有明文像素点的二值码组成的二值序列，记为中心像素点的二值模式，获得明文像素点的二值模式。2、根据明文图像和初始密文图像中明文像素点的灰度值和二值模式，计算初始密文图像的混乱度。对于尺寸对应的初始密文图像，根据该初始密文图像和明文图像中所有明文像素点的灰度值和二值模式，计算尺寸对应的初始密文图像的混乱度，混乱度的具体计算公式为：式中，表示尺寸对应的初始密文图像的混乱度，P表示尺寸对应的明文图像中明文像素点的数量，也既是尺寸对应的初始密文图像中明文像素点的数量，/＞，/＞表示向上取整，/＞表示明文图像中的j个明文像素点的二值模式，/＞表示初始密文图像中的j个明文像素点的二值模式，/＞表示明文图像中的j个明文像素点的二值模式/＞与初始密文图像中的j个明文像素点的二值模式/＞的汉明距离，/＞表示明文图像中的j个明文像素点的灰度值，/＞表示初始密文图像中的j个明文像素点的灰度值，/＞表示取绝对值，/＞和/＞为系数，在本实施例中，/＞，，在其他实施例中，实施人员可根据需要设置系数/＞和/＞。3、根据混乱度获得最优尺寸和目标密文图像。计算所有不同尺寸对应的初始密文图像的混乱度，将混乱度最大的初始密文图像对应的尺寸记为最优尺寸，将混乱度最大的初始密文图像记为目标密文图像。S004，设置第二子密钥，根据第二子密钥获得混沌序列。一维Logistic 映射是一种典型的混沌映射，模型为，当系数/＞时，系统进入混沌状态，就会产生之间的混沌序列。在、/＞、/＞的范围内随机产生第二子密钥/＞，将一维Logistic 混沌映射模型迭代/＞次，为防止初值干扰,去除前/＞个数值，将剩余的G个数值的每一个数值乘以G，并进行四舍五入取整，将取整后的第i数值记为混沌值/＞，将G个混沌值组成的序列记为混沌序列。需要说明的是，第二子密钥是发送端和接收端事先约定好的，在整个加密过程中只获取一次，并在发送端和接收端进行存储，因此，在传输密文图像时，不需要对第二子密钥进行传输，保证了密钥的安全性。S005，根据灰度值对明文图像块的所有明文像素点进行排列，获得明文图像块的块循环矩阵，根据混沌序列获得第二目标列，根据第二目标列对明文图像块进行块内置乱，获得密文图像。1、根据灰度值对明文图像块的所有明文像素点进行排列，获得明文图像块的块循环矩阵。对于目标密文图像中的任意一个明文图像块，根据灰度值对组成该明文图像块的所有明文像素点进行重排，具体为：按照从左到右、从上到下的顺序对组成该明文图像块的所有明文像素点进行排序，获得明文图像块的第二序列。将明文图像块的第二序列进行循环左移，每次循环左移一位，每循环左移一次，获得一个新的第二序列，经过m×n次循环左移得到m×n个新的第二序列，其中，m×n表示明文图像块的第二序列的长度。将新的第二序列中第一个明文像素点的灰度值作为新的第二序列的灰度值，按照灰度值从小到大的顺序对所有新的第二序列进行排列，对于灰度值相同的新的第二序列，按照获得顺序进行排列；按照顺序将所有新的第二序列组成的矩阵记为明文图像块的块循环矩阵，每个新的第二序列作为块循环矩阵中的一行，明文图像块的块循环矩阵既是明文图像块的所有明文像素点重排后的结果。2、根据混沌序列获得第二目标列，根据第二目标列对明文图像块进行块内置乱，获得密文图像。对于目标密文图像中的第i个明文图像块，获得混沌序列中的第i个混沌值，将第i个明文图像块的块循环矩阵中列号等于/＞的列，记为该块循环矩阵的第二目标列；根据块循环矩阵的第二目标列中所有明文像素点的顺序，对组成第i个明文图像块的所有明文像素点进行重排，实现对明文图像块的块内置乱，将块内置乱后的明文图像块记为密文图像块。对目标密文图像中的所有明文图像块进行块内置乱，获得所有密文图像块，将所有密文图像块按照顺序组成的图像记为密文图像。经过块间置乱和块内置乱实现对明文图像进行加密，密文图像为明文图像的加密结果。S006，对密文图像进行块内还原和块间还原，获得还原图像。根据尺寸对密文图像进行分块，获得所有的密文图像块；对于第i个密文图像块，按照从左到右、从上到下的顺序，对组成密文图像块的所有密文像素点进行排序，获得该密文图像块的第三序列；根据第二子密钥获得混沌序列，根据混沌序列获得该密文图像块对应的混沌值，则该密文图像块的第三序列为该密文图像块的块循环矩阵中的第/＞列；同时对第三序列中的灰度值从小到大进行排序，获得块循环矩阵中的第1列；结合此对应关系，获得该密文图像块的第一序列，根据第一序列，对组成该密文图像块的所有密文像素点进行重新排列，获得该密文图像块的还原图像块。获得所有密文图像块的还原图像块组成的初始还原图像。按照从左到右、从上到下的顺序，对于所有密文图像块进行排序，获得所有密文图像块的第四序列；根据第一子密钥，将第四序列作为图像循环矩阵中的第列，为第一子密钥，根据灰度均值和灰度方差对所有密文图像块进行排列，获得图像循环矩阵的第1列，结合此对应关系，获得所有密文图像块的第二序列，根据第二序列，对所有密文图像块的所有密文像素点进行重新排列，获得还原图像。本发明根据不同尺寸对明文图像分块获得所有明文图像块，根据灰度均值和灰度方差对所有明文图像块排列获得图像循环矩阵，根据图像循环矩阵第一目标列对明文图像进行块间置乱获得初始密文图像；计算所有尺寸对应的初始密文图像的混乱度，将混乱度最大的初始密文图像记为目标密文图像；根据灰度值对所有明文像素点排列获得块循环矩阵，根据块循环矩阵的第二目标列对目标密文图像进行块内置乱，获得密文图像。通过块间置乱后的初始密文图像的混乱度获得混乱度最大的目标密文图像，进而对目标密文图像进行块内置乱获得密文图像，因此，本发明的加密方法对于所有的明文图像都具有较强的置乱效果，打破了明文图像中像素点之间的强关联性，实现对明文图像加密，维护用户的合法权益，保护用户隐私。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。
