标题title
一种安全告警处理方法以及装置
摘要abst
本申请实施例提供了一种安全告警处理方法及装置，属于网络安全技术领域，包括：接收安全事件分析系统产生的安全告警；分析安全告警；在安全告警满足目标条件的情况下，以安全告警的攻击IP作为参数向威胁情报服务系统发起协助请求；接收威胁情报服务系统收集到的关于攻击IP的情报数据；根据情报数据计算攻击IP的危险等级；在攻击IP的危险等级为高危等级的情况下，可以不同威胁等级进行不同的处理。通过本发明提供的安全告警处理方法可以更加准确地确认攻击IP的危险等级，提升了安全告警的准确性。
权利要求书clms
1.一种安全告警处理方法，其特征在于，包括：接收安全事件分析系统产生的安全告警；分析所述安全告警；在所述安全告警满足目标条件的情况下，以所述安全告警的攻击IP作为参数向威胁情报服务系统发起协助请求；接收所述威胁情报服务系统收集到的关于所述攻击IP的情报数据；根据所述情报数据计算所述攻击IP的危险等级；在所述攻击IP的危险等级为高危等级的情况下，对所述攻击IP进行处理。2.根据权利要求1所述的安全告警处理方法，其特征在于，所述根据所述情报数据计算所述攻击IP的危险等级，包括：对所述情报数据进行解析，分析所述情报数据的解析文本中含有的多个目标字段；根据各个所述目标字段的评分以及权重计算所述攻击IP的危险评分；根据所述危险评分，确定所述攻击IP的危险等级。3.根据权利要求2所述的安全告警处理方法，其特征在于，所述根据各个所述目标字段的评分以及权重计算所述攻击IP的危险评分，包括：根据以下公式计算所述攻击IP的危险评分S：其中，λi表示第i个目标字段的权重，xi表示第i个目标字段的评分，n表示目标字段的个数。4.根据权利要求2所述的安全告警处理方法，其特征在于，所述根据各个所述目标字段的评分以及权重计算所述攻击IP的危险评分，包括：根据以下公式计算所述攻击IP的危险评分S：其中，λi表示第i个目标字段的权重，μi表示第i个目标字段的来源信任系数，xi表示第i个目标字段的评分，n表示目标字段的个数。5.根据权利要求2所述的安全告警处理方法，其特征在于，所述根据所述危险评分，确定所述攻击IP的危险等级，包括：在所述危险评分S满足的情况下，确定所述攻击IP的危险等级为高危等级；在所述危险评分S满足的情况下，确定所述攻击IP的危险等级为中危等级；在所述危险评分S满足的情况下，确定所述攻击IP的危险等级为低危等级；其中，S1表示第一预设评分值，S2表示第二预设评分值。6.根据权利要求2所述的安全告警处理方法，其特征在于，所述分析所述情报数据的解析文本中含有的多个目标字段，具体包括：从数据库中确定目标字段P；将所述情报数据的解析文本与所述目标字段P进行匹配；将当前待匹配文本T的尾字符与所述目标字段P的尾字符进行匹配；在所述当前待匹配文本T的尾字符与所述目标字段P的尾字符匹配成功的情况下，匹配所述目标字段P的首字符；在所述当前待匹配文本T的首字符与所述目标字段P的首字符匹配成功的情况下，匹配所述目标字段P的最中间字符；在所述当前待匹配文本T的最中间字符与所述匹配目标字段P的最中间字符匹配成功的情况下，从所述目标字段P的第二个字符依次匹配直至倒数第二个字符，中途跳过最中间字符；在上述匹配过程中，一旦出现不匹配的情况，按照以下跳跃规则对所述当前待匹配文本T向后移动相应的距离d：其中，x表示所述当前待匹配文本T的尾字符的后一个字符，m表示所述目标字段P的长度，P表示所述目标字段P中的第i个字符，max表示字符x出现在所述目标字段P中最右的位置；在所述情报数据的解析文本中匹配到的所述目标字段的情况下，将所述目标字段的名称以及在所述情报数据的解析文本中出现次数ci进行记录。7.根据权利要求6所述的安全告警处理方法，其特征在于，所述目标字段权重的计算方式为：统计所述目标字段的名称以及在所述情报数据的解析文本中出现次数ci；根据所述目标字段在所述情报数据的解析文本中出现次数ci，计算目标字段的权重：其中，λi表示第i个目标字段的权重，ci表示第i个目标字段在所述情报数据的解析文本中出现的次数，n表示目标字段的个数。8.根据权利要求1所述的安全告警处理方法，其特征在于，所述对所述攻击IP进行处理，包括：对主机进行隔离处理，以禁止所述攻击IP进行访问；生成安全告警工单，并发送通知。9.根据权利要求1所述的安全告警处理方法，其特征在于，还包括：在所述攻击IP的危险等级为中危等级的情况下，发送通知；在所述攻击IP的危险等级为低危等级的情况下，将所述攻击IP记录到白名单。10.一种安全告警处理装置，其特征在于，包括：第一接收模块，用于接收安全事件分析系统产生的安全告警；分析模块，用于分析所述安全告警；发起模块，用于在所述安全告警满足目标条件的情况下，以所述安全告警的攻击IP作为参数向威胁情报服务系统发起协助请求；第二接收模块，用于接收所述威胁情报服务系统收集到的关于所述攻击IP的情报数据；计算模块，用于根据所述情报数据计算所述攻击IP的危险等级；处理模块，用于在所述攻击IP的危险等级为高危等级的情况下，对所述攻击IP进行处理。
说明书desc
技术领域本申请各实施例属于网络安全技术领域，具体涉及一种安全告警处理方法以及装置。背景技术随着网络时代的进一步发展，人们对于网络的黏性越来越大，随之而来的，网络上的信息泄露也越来越频繁，如何维护网络安全成为重中之重。现有技术中，系统的安全事件分析系统可以在面临网络风险时发出告警，但是，经过安全事件分析系统分析产生的安全告警，通常都是基于告警源通知的数据和已有的内部数据进行分析后产生，对于需要通过查询外部接口获取数据的场景支持不足，无法通过外部的数据来进一步确定告警源的危险程度，导致安全告警的准确性较低。发明内容为了解决现有技术存在的对于需要通过查询外部接口获取数据的场景支持不足，无法通过外部的数据来进一步确定告警源的危险程度，导致安全告警的准确性较低的技术问题，本发明提供了一种安全告警处理方法及装置。第一方面，本发明提供了一种安全告警处理方法，包括：接收安全事件分析系统产生的安全告警；分析安全告警；在安全告警满足目标条件的情况下，以安全告警的攻击IP作为参数向威胁情报服务系统发起协助请求；接收威胁情报服务系统收集到的关于攻击IP的情报数据；根据情报数据计算攻击IP的危险等级；在攻击IP的危险等级为高危等级的情况下，对攻击IP进行处理。第二方面，本发明提供了一种安全告警处理装置，包括：第一接收模块，用于接收安全事件分析系统产生的安全告警；分析模块，用于分析安全告警；发起模块，用于在安全告警满足目标条件的情况下，以安全告警的攻击IP作为参数向威胁情报服务系统发起协助请求；第二接收模块，用于接收威胁情报服务系统收集到的关于攻击IP的情报数据；计算模块，用于根据情报数据计算攻击IP的危险等级；处理模块，用于在攻击IP的危险等级为高危等级的情况下，对攻击IP进行处理。与现有技术相比，本发明至少具有以下有益效果：在本发明中，接收安全事件分析系统产生的安全告警后，首先确认安全告警是否满足目标条件，例如确认安全告警是否为APT事件或者渗透工具这两个对于系统安全威胁较大的安全告警。之后会通过威胁情报服务系统获取外部的情报数据，外部情报数据往往可以对各种新型的网络袭击以及安全漏洞做到及时的更新，具有更高的可信度，结合外部的情报数据进一步地分析攻击IP的危险等级，在攻击IP的危险等级为高危等级的情况下，对攻击IP进行处理，处理方式可以是封禁等。可以更加准确地确认攻击IP的危险等级，提升了安全告警的准确性。附图说明图1是本发明提供的一种安全告警处理方法的流程示意图。图2是本发明提供的一种目标字段匹配方法的流程示意图。图3是本发明提供的一种安全告警处理装置的结构示意图。此处所说明的附图用来提供对本申请的进一步理解，构成本申请的一部分，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。后文将参照附图以示例性而非限制性的方式详细描述本申请的一些具体实施例。具体实施方式为了使本技术领域的人员更好地理解本申请方案，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述。显然，所描述的实施例仅仅是本申请一部分的实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获取的所有其他实施例，都应当属于本申请保护的范围。第一方面，参照图1，示出了本发明实施例提供的一种安全告警处理方法的流程示意图。本发明提供了一种安全告警处理方法，包括：S101：接收安全事件分析系统产生的安全告警。其中，安全事件分析系统是设备内部自带的系统，可以对于异常的网络行为进行预警。关于安全事件分析系统的具体工作原理可以参考杀毒系统等安全告警软件，本发明不再赘述。其中，安全告警是安全事件分析系统在分析当前网络行为存在异常时发出的警告，旨在提醒用户当前设备可能正在遭遇网络袭击。S102：分析安全告警。可选地，在分析安全告警是可以分析安全告警的类型、来源等。其中，常见的安全告警类型有弱口令、进程异常、网站后门、异常登录、恶意进程、APT事件和渗透工具等。S103：在安全告警满足目标条件的情况下，以安全告警的攻击IP作为参数向威胁情报服务系统发起协助请求。可选地，目标条件为以下一者或者两者的组合：安全告警的类型为目标类型、安全告警的来源为危险设备。可选地，目标类型为APT事件或者渗透工具。其中，APT事件或者渗透工具是两类对于系统安全威胁较大的告警类型，如果仅仅靠安全事件分析系统内部进行分析，得到的分析结果往往是不够准确的，为了避免误判，此时需要向威胁情报服务系统发起协助请求，威胁情报服务系统从外部数据库中筛选出与本次告警攻击的IP相关的情报数据。其中，判断安全告警是否为APT事件需要从多个方面进行综合分析：告警源头：如果告警来自于高度信任的安全设备，如EDR、SIEM等，且告警内容涉及到异常操作、高危漏洞、恶意文件等信息，则可能是APT事件。攻击链路：需要查看攻击链路，确定攻击者使用了哪些攻击手段和技术，如果使用了多种攻击手法，且攻击手法比较高级，如命令与控制服务器、横向渗透等，则可能是APT事件。攻击对象：APT事件通常会有明确的攻击目标，可能是特定的机构、行业或公司，或者是特定的个人或团队。攻击持续周期：APT攻击通常会持续一段时间，在这个过程中攻击者通过多次进攻尝试获取机密信息或占领目标系统。其中，判断安全告警是否为渗透工具也需要从多个方面进行综合分析：攻击目的：渗透工具的攻击目的比较明确，通常是为了获取目标系统的管理员权限，以实现远程控制和数据窃取等非法活动。攻击方式：渗透工具通常使用脚本、漏洞利用等攻击手段，诸如后门、反弹shell、远程访问等，可以从攻击方式进行判断。攻击频率：渗透工具通常使用快速攻击的方式进行入侵，相比其他攻击方式更容易产生异常大量的登录失败、拒绝服务等告警。软件特征：渗透工具通常会有明显的软件特征，如常用于攻击的KaliLinux、Metasploit等。S104：接收威胁情报服务系统收集到的关于攻击IP的情报数据。其中，外部情报数据往往可以对各种新型的网络袭击以及安全漏洞做到及时的更新，具有更高的可信度，结合外部的情报数据进一步地分析攻击IP的危险等级。其中，外部情报数据的来源可以是各大安全漏洞分析网站、各大网络安全论坛和各大信息安全软件供应商的数据库。S105：根据情报数据计算攻击IP的危险等级。在一种可能的实施方式中，S105具体包括子步骤S1051至S1053：S1051：对情报数据进行解析，分析情报数据的解析文本中含有的多个目标字段。参照图2，示出了本发明实施例提供的一种目标字段匹配方法的流程示意图。在一种可能的实施方式中，子步骤S1051包括S1051A至S1051H：S1051A：从数据库中确定目标字段P。S1051B：将情报数据的解析文本与目标字段P进行匹配。S1051C：将当前待匹配文本T的尾字符与目标字段P的尾字符进行匹配。S1051D：在当前待匹配文本T的尾字符与目标字段P的尾字符匹配成功的情况下，匹配目标字段P的首字符。需要说明的是，在匹配过程中之所以先匹配尾字符、进而再匹配首字符，是由于对于单词来说，通常具有相同前缀或后缀的概率比较高，而单词中间部分相同的概率较小。比如overall与overflow，breakage与marriage。因此优先去匹配尾字符和首字符，相较于单纯的从前向后匹配或者从后向前匹配可以提升字符匹配的效率。S1051E：在当前待匹配文本T的首字符与目标字段P的首字符匹配成功的情况下，匹配目标字段P的最中间字符。进一步地，最中间字符往往可以跳过前缀或者后缀，是每个单词中较为普通的字符，若最中间字符匹配成功则意味着整个字符匹配成功的概率将会大幅提高，因此，在匹配完尾字符和首字符之后紧接着进行最中间字符的匹配可以进一步提升字符匹配的效率。S1051F：在当前待匹配文本T的最中间字符与匹配目标字段P的最中间字符匹配成功的情况下，从目标字段P的第二个字符依次匹配直至倒数第二个字符，中途跳过最中间字符。S1051G：在上述匹配过程中，一旦出现不匹配的情况，按照以下跳跃规则对当前待匹配文本T向后移动相应的距离d：其中，x表示当前待匹配文本T的尾字符的后一个字符，m表示目标字段P的长度，P表示目标字段P中的第i个字符，max表示字符x出现在目标字段P中最右的位置。需要说明的是，d的具体含义是：在字符x不在目标字段P中的情况下，跳跃的步数为m+1，也就是说在待匹配窗口中直接跳过一个完整的长度。在字符x在目标字段P中的情况下，跳跃的步数为m-max，也就是说跳跃到待匹配窗口的下一个尾字符处。S1051H：在情报数据的解析文本中匹配到的目标字段的情况下，将目标字段的名称以及在情报数据的解析文本中出现次数ci进行记录。在本发明中，采用尾字符、首字符、最中间字符、其他字符的匹配顺序进行文本匹配，可以减少匹配次数，提升匹配效率。本发明还提供了一种跳跃规则，在实现准确匹配的同时，尽可能地跳过已经可以确定无法与目标字段匹配的文本内容，提升匹配效率。S1052：根据各个目标字段的评分以及权重计算攻击IP的危险评分。在一种可能的实施方式中，目标字段权重的计算方式为：统计目标字段的名称以及在情报数据的解析文本中出现次数ci。根据目标字段在情报数据的解析文本中出现次数ci，计算目标字段的权重：其中，λi表示第i个目标字段的权重，ci表示第i个目标字段在情报数据的解析文本中出现的次数，n表示目标字段的个数。也就是说，当前目标字段的权重为在所有目标字段中出现的频率。在本发明中，提供了两种危险评分的计算方式，一种只考虑目标字段的权重，可以提升安全告警的处理速度，另一种在考虑目标字段权重的基础上还考虑了目标字段的来源，可以提升识别安全告警的危险级别的准确性。在一种可能的实施方式中，子步骤S1052包括：根据以下公式计算攻击IP的危险评分S：其中，λi表示第i个目标字段的权重，xi表示第i个目标字段的评分，n表示目标字段的个数。在一种可能的实施方式中，子步骤S1052包括：根据以下公式计算攻击IP的危险评分S：其中，λi表示第i个目标字段的权重，μi表示第i个目标字段的来源信任系数，xi表示第i个目标字段的评分，n表示目标字段的个数。S1053：根据危险评分，确定攻击IP的危险等级。在一种可能的实施方式中，子步骤S1053包括：在危险评分S满足的情况下，确定攻击IP的危险等级为高危等级；在危险评分S满足的情况下，确定攻击IP的危险等级为中危等级；在危险评分S满足的情况下，确定攻击IP的危险等级为低危等级；其中，S1表示第一预设评分值，S2表示第二预设评分值。S106：在攻击IP的危险等级为高危等级的情况下，对攻击IP进行处理。需要说明的是，对于高危等级的攻击IP的具体处理方式可以是对攻击IP直接进行封禁，也可以根据安全告警中的字段触发一些自定义的处理流程。例如，在安全告警中的账户信息字段是高风险账号的情况下，对高风险账号进行自动禁用。再例如，在安全告警中的主机字段是高风险主机的情况下，对高风险主机进行自动隔离。需要说明的是，触发一些自定义的处理流程的字段可以是攻击IP、受害IP、受害者端口、攻击者端口、告警一级分类、告警二级分类、告警等级、告警名称、标签、受害站点URL、关联告警区域、关联安全设备、关联分析规则、攻击结果、攻击链阶段、是否失陷、受害者信息、攻击者信息、账户信息、业务信息、漏洞信息、其他信息、自定义非告警。可以理解的是，对攻击IP进行封禁处理可以是系统内部确定好的封禁剧本，封禁剧本中包括一系列相互关联的处理方式，例如，主机隔离、生成安全告警工单等。在一种可能的实施方式中，S106包括子步骤S1061和S1062：S1061：对主机进行隔离处理，以禁止攻击IP进行访问。S1062：生成安全告警工单，并发送通知。可选地，通知的方式可以是邮件、短信或者是语言播放的方式，用于通知运维人员进行安全确认。与现有技术相比，本发明至少具有以下有益效果：在本发明中，接收安全事件分析系统产生的安全告警后，首先确认安全告警是否满足目标条件，例如确认安全告警是否为APT事件或者渗透工具这两个对于系统安全威胁较大的安全告警。之后会通过威胁情报服务系统获取外部的情报数据，外部情报数据往往可以对各种新型的网络袭击以及安全漏洞做到及时的更新，具有更高的可信度，结合外部的情报数据进一步地分析攻击IP的危险等级，在攻击IP的危险等级为高危等级的情况下，对攻击IP进行处理，处理方式可以是封禁等。可以更加准确地确认攻击IP的危险等级，提升了安全告警的准确性。在一种可能的实施方式中，安全告警处理方法还包括：S107：在攻击IP的危险等级为中危等级的情况下，发送通知运。在本发明中，对于中危等级的攻击IP应当及时地提醒运维人员进行人工确认，避免攻击IP进一步升级。S108：在攻击IP的危险等级为低危等级的情况下，将攻击IP记录到白名单。在本发明中，对于低危等级的攻击IP可以记录在白名单中，在后续遇到类似情况时，予以放行，提升安全告警处理效率。第二方面，参照图3，示出了本发明实施例提供的一种安全告警处理装置的结构示意图。本发明提供了一种安全告警处理装置30，包括：第一接收模块301，用于接收安全事件分析系统产生的安全告警；分析模块302，用于分析安全告警；发起模块303，用于在安全告警满足目标条件的情况下，以安全告警的攻击IP作为参数向威胁情报服务系统发起协助请求；第二接收模块304，用于接收威胁情报服务系统收集到的关于攻击IP的情报数据；计算模块305，用于根据情报数据计算攻击IP的危险等级；处理模块306，用于在攻击IP的危险等级为高危等级的情况下，对攻击IP进行处理。在一种可能的实施方式中，计算模块305用于：对情报数据进行解析，分析情报数据的解析文本中含有的多个目标字段；根据各个目标字段的评分以及权重计算攻击IP的危险评分；根据危险评分，确定攻击IP的危险等级。在一种可能的实施方式中，计算模块305用于：根据以下公式计算攻击IP的危险评分S：其中，λi表示第i个目标字段的权重，xi表示第i个目标字段的评分，n表示目标字段的个数。在一种可能的实施方式中，计算模块305用于：根据以下公式计算攻击IP的危险评分S：其中，λi表示第i个目标字段的权重，μi表示第i个目标字段的来源信任系数，xi表示第i个目标字段的评分，n表示目标字段的个数。在一种可能的实施方式中，计算模块305用于：在危险评分S满足的情况下，确定攻击IP的危险等级为高危等级；在危险评分S满足的情况下，确定攻击IP的危险等级为中危等级；在危险评分S满足的情况下，确定攻击IP的危险等级为低危等级；其中，S1表示第一预设评分值，S2表示第二预设评分值。在一种可能的实施方式中，计算模块305用于：从数据库中确定目标字段P；将情报数据的解析文本与目标字段P进行匹配；将当前待匹配文本T的尾字符与目标字段P的尾字符；在当前待匹配文本T的尾字符与目标字段P的尾字符匹配成功的情况下，匹配目标字段P的首字符；在当前待匹配文本T的首字符与目标字段P的首字符匹配成功的情况下，匹配目标字段P的最中间字符；在当前待匹配文本T的最中间字符与匹配目标字段P的最中间字符匹配成功的情况下，从目标字段P的第二个字符依次匹配直至倒数第二个字符，中途跳过最中间字符；在上述匹配过程中，一旦出现不匹配的情况，按照以下跳跃规则对当前待匹配文本T向后移动相应的距离d：其中，x表示当前待匹配文本T的尾字符的后一个字符，m表示目标字段P的长度，P表示目标字段P中的第i个字符，max表示字符x出现在目标字段P中最右的位置；在情报数据的解析文本中匹配到的目标字段的情况下，将目标字段的名称以及在情报数据的解析文本中出现次数ci进行记录。在一种可能的实施方式中，计算模块305用于：统计目标字段的名称以及在情报数据的解析文本中出现次数ci；根据目标字段在情报数据的解析文本中出现次数ci，计算目标字段的权重：其中，λi表示第i个目标字段的权重，ci表示第i个目标字段在情报数据的解析文本中出现的次数，n表示目标字段的个数。在一种可能的实施方式中，处理模块306用于：对主机进行隔离处理，以禁止攻击IP进行访问；生成安全告警工单，并发送通知。在一种可能的实施方式中，安全告警处理装置30还包括：发送模块307，用于在攻击IP的危险等级为中危等级的情况下，发送通知；记录模块308，用于在攻击IP的危险等级为低危等级的情况下，将攻击IP记录到白名单。本发明提供的安全告警处理装置30能够实现上述方法实施例中实现的各个过程，为避免重复，这里不再赘述。本发明提供的虚拟装置可以是装置，也可以是终端中的部件、集成电路、或芯片。与现有技术相比，本发明至少具有以下有益效果：在本发明中，接收安全事件分析系统产生的安全告警后，首先确认安全告警是否满足目标条件，例如确认安全告警是否为APT事件或者渗透工具这两个对于系统安全威胁较大的安全告警。之后会通过威胁情报服务系统获取外部的情报数据，外部情报数据往往可以对各种新型的网络袭击以及安全漏洞做到及时的更新，具有更高的可信度，结合外部的情报数据进一步地分析攻击IP的危险等级，在攻击IP的危险等级为高危等级的情况下，对攻击IP进行处理，处理方式可以是封禁等。可以更加准确地确认攻击IP的危险等级，提升了安全告警的准确性。最后应说明的是：以上各实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述各实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围。
