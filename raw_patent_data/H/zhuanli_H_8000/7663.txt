标题title
一种基于httpServer实现在主动智能家庭的智能互联方法
摘要abst
本发明公开了一种基于httpServer实现在主动智能家庭的智能互联方法，包括基于同一个ip地址在电视上安装站点服务和中控服务，实现电视开机时，站点服务和中控服务自启动；站点服务启动后，每个站点固定一个第一端口号，建立第一httpServer服务器；中控服务启动后，固定一个第二端口号，建立第二httpServer服务器，通过http请求，订阅站点消息；站点服务收到中控订阅消息请求，解析消息内容；站点服务接收设备上报消息，并将设备上报消息内容推送给中控服务器；中控服务器在消息接收回调地方收到该站点上报的消息；中控服务对消息进行处理，解析出要执行的操作命令，中控服务通过http请求把操作命令发到对应的站点服务；站点服务收到控制命令，解析命令后，控制对应的设备。
权利要求书clms
1.一种基于httpServer实现在主动智能家庭的智能互联方法，其特征在于，包括以下步骤：基于同一个ip地址在电视上安装站点服务和中控服务，实现电视开机时，站点服务和中控服务自启动；站点服务启动后，每个站点固定一个第一端口号，基于第一端口号建立第一httpServer服务器；中控服务启动后，固定一个第二端口号，基于第二端口号建立第二httpServer服务器，通过http请求，订阅站点消息；站点服务收到中控订阅消息请求，解析消息内容；站点服务接收设备上报消息，并将设备上报消息内容推送给中控服务器；中控服务器在消息接收回调地方收到该站点上报的消息；中控服务对消息进行处理，解析出要执行的操作命令，中控服务通过http请求把操作命令发到对应的站点服务；站点服务收到控制命令，解析命令后，控制对应的设备。2.根据权利要求1所述的一种基于httpServer实现在主动智能家庭的智能互联方法，其特征在于，所述站点消息内容包含订阅的消息id列表，以及中控服务的端口号。3.根据权利要求1所述的一种基于httpServer实现在主动智能家庭的智能互联方法，其特征在于，所述解析消息内容包括存储中控端口号，以及要订阅的消息。4.根据权利要求1所述的一种基于httpServer实现在主动智能家庭的智能互联方法，其特征在于，所述站点服务接收设备上报消息，并将设备上报消息内容推送给中控服务器；中控服务器在消息接收回调地方收到该站点上报的消息；包括：站点服务收到设备上报的消息，利用收到的中控服务端口号以及ip地址127.0.0.1通过http方式把消息内容推送给中控服务器，中控服务器在消息接收回调地方收到该站点上报的消息。5.根据权利要求1所述的一种基于httpServer实现在主动智能家庭的智能互联方法，其特征在于，所述中控服务对消息进行处理，解析出要执行的操作命令，包括：中控服务对消息进行处理，找到消息里面的触发事件，利用场景规则引擎解析出要执行的操作命令。
说明书desc
技术领域本发明涉及通信技术领域，具体涉及一种基于httpServer实现在主动智能家庭的智能互联方法。背景技术目前不论是单品服务还是场景联动，人获得服务的方式都仍处在被动响应阶段，对构想的理想智慧家庭而言，这是“伪智能”化服务。变被动为主动，将人由服务主体延伸为研究主体，通过聚焦用户行为、举一反三挖掘用户需求，为用户提供无感、个性化服务，开启千人千面的全屋智能居家体验，才是智慧家庭的真正智慧所在。主动智能，一定是作为智能家居行业的企业要追求的最佳解决方案，为用户多想一步的本质是减少对用户的打搅。好的交互方式是润物细无声的，主动智能，其实就是这种不打搅用户交互体验的技术实现路径。目前市场上一些主动智能服务实现方式是，用户注册并登录用户系统，然后配置场景规则，并把场景规则放到云端服务器，智能家居设备也建立绑定关系，并放到云端，实现场景主要是依靠云端服务器去解析场景规则，严重依赖云端服务器，在无网情况下，用户就无法访问云端服务器，智能场景就无法工作；用户高峰期时候，大量用户同时访问云端，会造成服务器拥塞，用户体验感非常差，如果不断加大服务器，对于公司来说，服务器成本也非常大。发明内容本发明的目的在于提供一种基于httpServer实现在主动智能家庭的智能互联方法，以期解决背景技术中存在的技术问题。一种基于httpServer实现在主动智能家庭的智能互联方法，包括以下步骤：基于同一个ip地址在电视上安装站点服务和中控服务，实现电视开机时，站点服务和中控服务自启动；站点服务包包括雷达站点、语音面板站点、音响站点、设备控制站点，在同一个电视上安装的服务，ip地址可以用127.0.0.1。站点服务启动后，每个站点固定一个第一端口号，基于第一端口号建立第一httpServer服务器；中控服务启动后，固定一个第二端口号，基于第二端口号建立第二httpServer服务器，通过http请求，订阅站点消息；站点服务收到中控订阅消息请求，解析消息内容；站点服务接收设备上报消息，并将设备上报消息内容推送给中控服务器；中控服务器在消息接收回调地方收到该站点上报的消息；中控服务对消息进行处理，解析出要执行的操作命令，中控服务通过http请求把操作命令发到对应的站点服务；站点服务收到控制命令，解析命令后，控制对应的设备。在一些实施例中，所述站点消息内容包含订阅的消息id列表，以及中控服务的端口号。在一些实施例中，所述解析消息内容包括存储中控端口号，以及要订阅的消息。在一些实施例中，所述站点服务接收设备上报消息，并将设备上报消息内容推送给中控服务器；中控服务器在消息接收回调地方收到该站点上报的消息；包括：站点服务收到设备上报的消息，利用收到的中控服务端口号以及ip地址127.0.0.1通过http方式把消息内容推送给中控服务器，中控服务器在消息接收回调地方收到该站点上报的消息。在一些实施例中，所述中控服务对消息进行处理，解析出要执行的操作命令，包括：中控服务对消息进行处理，找到消息里面的触发事件，利用场景规则引擎解析出要执行的操作命令。本申请所提供的一种基于httpServer实现在主动智能家庭的智能互联方法具有的有益效果包括但不限于：本发明可以不依赖云端服务器，并在无网情况下实现主动智能服务。通过本发明的一种基于httpServer实现在主动智能家庭的智能互联方法，解决大量依赖云端服务器的弊端，无网就不能工作的问题。附图说明图1基于httpServer实现在主动智能家庭通信流程图。具体实施方式为使本申请的目的、技术方案和优点更加清楚，下面将结合本申请的优选实施例中的附图，对本申请实施例中的技术方案进行更加详细的描述。在附图中，自始至终相同或类似的标号表示相同或类似的部件或具有相同或类似功能的部件。所描述的实施例是本申请一部分实施例，而不是全部的实施例。下面通过参考附图描述的实施例是示例性的，旨在用于解释本申请，而不能理解为对本申请的限制。基于本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。以下将结合图1，对本申请实施例所涉及的一种基于httpServer实现在主动智能家庭的智能互联方法进行详细说明。值得注意的是，以下实施例，仅仅用于解释本申请，并不构成对本申请的限定。基于httpServer实现在主动智能家庭的一种智能互联方法的具体工作流程如下：在电视上安装雷达站点服务，语音面板服务，音响服务，设备服务，并设置开机自启动，启动后每个站点建立一个httpServer服务器，每个站点服务都固定一个自有的端口号；在电视上安装中控服务，中控服务里面内置了场景规则，并设置开机自启动，启动后建立一个httpServer服务器；中控服务用127.0.0.1以及和各个站点固定的端口通过http方式订阅站点消息，发送消息内容包含了订阅消息id列表以及中控服务的端口号；订阅雷达站点服务消息id包含了回家事件，离家事件，进入区域事件，离开区域事件等；每个站点服务收到订阅消息请求后，解析消息体，保存中控服务的端口，以及订阅的消息id列表；雷达站点收到雷达上报离家事件消息，然后把回家事件消息推送到中控服务；中控服务在httpServer服务器监听消息回调，收到雷达消息后，解析消息内容，解析场景规则找到离家事件匹配的规则，中控服务把场景规则执行action内容解析封装，通过http方式下发到设备服务站点；设备服务站点收到消息后，解析消息内容并控制对应的设备，包含了关闭空调，关闭空气净化器，关闭屋内灯等控制操作；就实现了主动式智能场景服务。本发明提出在电视上安装设备站点服务，一个中控服务，这些服务都是随着电视开机自启动的内置服务，不需要用户去注册登录，设备站点服务启动后，开启轻量级的httpServer作为服务器。中控服务启动后，开启一个轻量级的httpServer作为服务器，都是在同一台电视上运行的服务，ip可以用127.0.0.1，每一个站点端口都是提前约定好固定值，中控服务通过http请求去订阅站点消息，消息体里面包含了中控服务的端口号，以及订阅消息id列表，站点收到该请求时，解析里面消息体，可以获取到中控服务的端口号，就可以给中控服务发送消息。中控服务在httpServer服务端收到站点消息，实现了中控服务订阅消息，然后在服务器接收消息端接收站点上报的消息，中控服务控制站点设备，可以通过http去下发控制命令就实现了设备控制。实现智能家庭，基本不用访问服务器，在无网情况下也可以实现智能互联。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
