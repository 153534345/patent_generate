标题title
一种基于子图特征的链路预测方法
摘要abst
本发明公开了一种基于子图特征的链路预测方法，获取待预测网络并进行预处理，得到无方向无权重的待预测网络，从该网络中分别取边构成训练集样本和测试集样本；从样本中每次提取两个目标节点，确定各自对应的一阶邻居节点集合并取并集，得到两个目标节点组成的连边对应的一阶邻域子图；接着提取一阶邻域子图的特征；从样本中再次提取两个目标节点直至训练集样本或测试集样本中的所有目标节点均提取完成，经过同样方式处理，相应得到多个一阶邻域子图特征；最后预设全连接神经网络二分类器并进行训练，将多个一阶邻域子图特征输入至训练后的全连接神经网络二分类器，得出相应链路的预测得分。该方法具有更强的特征提取能力和更少的计算时间。
权利要求书clms
1.一种基于子图特征的链路预测方法，其特征在于，所述方法包括：S1、获取待预测网络，对所述待预测网络进行预处理，得到无方向无权重的待预测网络，从所述无方向无权重的待预测网络中分别取边构成训练集样本和测试集样本；S2、从所述训练集样本或测试集样本中每次提取两个目标节点，确定所述两个目标节点各自对应的一阶邻居节点集合，对所述一阶邻居节点集合取并集得到所述两个目标节点组成的边对应的一阶邻域子图；S3、将所述一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为所述一阶邻域子图特征；S4、从所述训练集样本或测试集样本中再次提取两个目标节点直至训练集样本或测试集样本中的所有目标节点均提取完成，经过S2和S3处理，相应得到多个一阶邻域子图特征；S5、预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个所述一阶邻域子图特征输入至所述训练后的全连接神经网络二分类器，经过处理，输出链路预测得分，根据所述链路得分得到对应的两个目标节点组成的边的预测结果。2.如权利要求1所述的基于子图特征的链路预测方法，其特征在于，所述S1包括：S11、获取待预测网络，消除所述待预测网络中边的方向和权重，得到不包含孤立节点的无方向无权重的待预测网络；S12、从所述无方向无权重的待预测网络中删除预设比例的边，将未删除的边作为训练集正样本，将删除的边作为测试集正样本；S13、将所述无方向无权重的待预测网络中不存在边的节点对构成边，从中分别随机采样和所述训练集正样本和测试集正样本同等数量且不重合的边作为训练集负样本和测试集负样本，将所述训练集正样本和所述训练集负样本组成训练集样本，将所述测试集正样本和所述测试集负样本组成测试集样本。3.如权利要求2所述的基于子图特征的链路预测方法，其特征在于，所述S2具体包括：S21、从所述训练集样本或测试集样本中每次提取两个目标节点x和y；S22、提取所述目标节点x的一阶邻居节点，组成目标节点x的一阶邻居节点集合；S23、提取所述目标节点y的一阶邻居节点，组成目标节点y的一阶邻居节点集合；S24、对所述目标节点x的一阶邻居节点集合和所述目标节点y的一阶邻居节点集合取并集，得到所述两个目标节点x和y组成的边对应的一阶邻域子图。4.如权利要求3所述的基于子图特征的链路预测方法，其特征在于，所述S24中所述两个目标节点x和y组成的边对应的一阶邻域子图由如下节点集合而成：Γ＝{v∈Vmin,d)≤1}式中，Γ为目标节点x和y对应的一阶邻居节点的集合，V为待预测网络中所有节点的集合，d为待预测网络中的节点v和目标节点x之间的路径，d为待预测网络中的节点v和目标节点y之间的路径。5.如权利要求4所述的基于子图特征的链路预测方法，其特征在于，所述S3中将所述一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为所述一阶邻域子图特征，具体包括：S31、将所述一阶邻域子图划分为x社区、y社区和CN社区；S32、分别计算所述x社区、y社区和CN社区的节点数和边数，将计算得到的节点数和边数作为对应社区的特征；S33、将所述对应社区的特征按照预设顺序排列，得到所述一阶邻域子图特征。6.如权利要求5所述的基于子图特征的链路预测方法，其特征在于，所述S31中的x社区由如下节点集合而成：Vx＝Γ-{y}式中，Vx为x社区的节点集，Γ为目标节点x的一阶邻居节点集，即和节点x直接相连的节点的集合，{y}为目标节点y的集合。7.如权利要求6所述的基于子图特征的链路预测方法，其特征在于，所述S31中的y社区由如下节点集合而成:Vy＝Γ-{x}式中，Vy为y社区的节点集，Γ为目标节点y的一阶邻居节点集合，即和节点y直接相连的节点的集合，{x}为目标节点x的集合。8.如权利要求7所述的基于子图特征的链路预测方法，其特征在于，所述S31中的CN社区由如下节点集合而成:VCN＝Γ∩Γ式中，VCN为CN社区的节点集，Γ为目标节点x的一阶邻居节点集，Γ为目标节点y的一阶邻居节点集。9.如权利要求8所述的基于子图特征的链路预测方法，其特征在于，所述S33中将所述对应社区的特征按照预设顺序排列，得到所述一阶邻域子图特征，具体可表示为：式中，|Vx|为x社区的节点数，|Ex|为x社区的边数，|Vy|为y社区的节点数,|Ey|为y社区的边数，|VCN|为CN社区的节点数，|ECN|为CN社区的边数。10.如权利要求2所述的基于子图特征的链路预测方法，其特征在于，所述S12中从所述无方向无权重的待预测网络中删除预设比例的边，所述预设比例为20％。
说明书desc
技术领域本发明涉及数据挖掘技术领域，尤其是涉及一种基于子图特征的链路预测方法。背景技术随着自媒体的兴起，互联网的进步以及云计算的发展，涌现了海量的可以建模为网络的数据。由实际的主题作为节点，由各个主体之间的交互信息产生连边的数据称之为网络。在现实世界中存在着大量的不同类型的网络数据，例如将每个账号看成节点，用户之间加好友、点赞等行为作为连边，则可以将微博、微信、QQ、抖音等社交平台看作一个大的社交网络；将神经系统里大量的神经元看成节点，依据间隙、突触等关系构造连边，则神经系统可以表示为网络；将每一台计算机当作节点，计算机之间通过光缆、同轴电缆等当作连边也可以建模为网络；火车站和火车轨道可以分别建模为节点和连边，因而火车线路网是也一个网络。通过挖掘现实网络中同类或者不同类实体之间的多种联系规则构建网络，这种网络具有独有的特点，也有许多共性，通常被称为复杂网络。链路预测是复杂网络研究的一个子问题，主要目的是预测缺失边和潜在边是否存在。随着科技的发展，许多真实网络中的交互越来越频繁。因此，真实网络的演化机制可以通过研究网络实体之间的关系来理解，但由于构建成本的限制，在构建网络拓扑来接近一个复杂的社会系统时，常常出现缺失或冗余的信息。此外，一些新的连接也会随着真实的网络的动态变化而产生。因此，这些隐藏的链路或未来的链路需要从当前网络拓扑中检测出来。链路预测问题关注的是节点之间的连接，而不是节点本身，根据观测到的连边信息，可以预测任意两个非连通节点之间连通的可能性。目前，启发式算法由于计算简便且无需学习而被广泛应用，然而启发式方法最大的缺点是需要预先假设网络的基本演化规则，然后进行链路预测，导致其泛化能力较差。例如，共同邻居启发式指标可以很好地预测社交网络中的朋友关系或协作网络中的合作者关系，但不能更准确地预测电力和生物网络中的连边。因为在蛋白质-蛋白质相互作用网络中，两个蛋白质的共同邻居个数对蛋白质之间的相互作用不具有明显的促进作用。类似地，在电力网络中，两个节点有许多共同的邻居反而降低了两节点产生新连边的概率。基于上述分析可以看出，已经有许多启发式方法来解决不同领域中的链路预测问题，但面对一个新网络时选择合适的启发式方法仍是一个大的挑战。为了克服上述启发式方法泛化能力的局限性，最近提出的大多数方法都是基于学习的方法。基于学习的方法通过已知拓扑构建训练数据，并使用学习模型来预测链路。在现有的基于学习的方法中，编码子图模式可以自动构造合适的启发式算法，并取得比图嵌入方法更好的链路预测性能。最早的编码子图模式利用封闭子图的邻接矩阵进行链路预测，但这样的子图提取过程有几个缺点：首先，由于全连接神经网络只接受固定大小的张量作为输入，因此需要固定子图大小；其次，当单跳邻居数小于预定义大小的子图时，固定大小的子图可能需要更高阶的邻居信息，当单跳邻居数量大于预定义的大小时，一些单跳邻居信息也可能被丢弃；最后，编码子图模式需要额外的节点排序过程，增加了计算复杂度。目前，图神经网络通常用于从封闭子图学习启发式，具体是以两个目标节点为中心提取一跳或两跳封闭子图，并根据封闭子图的拓扑预测链路的存在与否。因此，链路预测任务被转化为图分类问题：输入目标节点的封闭子图，并预测子图的中心节点对之间是否存在连接。这样的子图提取过程仍有两个缺点：首先，需要设计图池化层来得到子图固定大小的特征向量，这个过程往往会丢失信息；其次，采用图神经网络进行图分类需要较大的时间空间复杂度。发明内容针对上述子图模式编码的链路预测方法在计算子图嵌入需要较大的时间空间复杂度问题，本发明提供了一种基于子图特征的链路预测方法，包括如下步骤：S1、获取待预测网络，对待预测网络进行预处理，得到无方向无权重的待预测网络，从无方向无权重的待预测网络中分别取边构成训练集样本和测试集样本；S2、从训练集样本或测试集样本中每次提取两个目标节点，确定两个目标节点各自对应的一阶邻居节点集合，对一阶邻居节点集合取并集得到两个目标节点组成的边对应的一阶邻域子图；S3、将一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为一阶邻域子图特征；S4、从训练集样本或测试集样本中再次提取两个目标节点直至训练集样本或测试集样本中的所有目标节点均提取完成，经过S2和S3处理，相应得到多个一阶邻域子图特征；S5、预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个一阶邻域子图特征输入至训练后的全连接神经网络二分类器，经过处理，输出链路预测得分，根据链路得分得到对应的两个目标节点组成的边的预测结果。优选地，S1包括：S11、获取待预测网络，消除待预测网络中边的方向和权重，得到不包含孤立节点的无方向无权重的待预测网络；S12、从无方向无权重的待预测网络中删除预设比例的边，将未删除的边作为训练集正样本，将删除的边作为测试集正样本；S13、将无方向无权重的待预测网络中不存在边的节点对构成边，从中分别随机采样和训练集正样本和测试集正样本同等数量且不重合的边作为训练集负样本和测试集负样本，将训练集正样本和训练集负样本组成训练集样本，将测试集正样本和测试集负样本组成测试集样本。优选地，S2具体包括：S21、从训练集样本或测试集样本中每次提取两个目标节点x和y；S22、提取目标节点x的一阶邻居节点，组成目标节点x的一阶邻居节点集合；S23、提取目标节点y的一阶邻居节点，组成目标节点y的一阶邻居节点集合；S24、对目标节点x的一阶邻居节点集合和目标节点y的一阶邻居节点集合取并集，得到两个目标节点x和y组成的边对应的一阶邻域子图。优选地，S24中两个目标节点x和y组成的边对应的一阶邻域子图由如下节点集合而成：Γ＝{v∈V|min,d)≤1}式中，Γ为目标节点x和y对应的一阶邻居节点的集合，V为待预测网络中所有节点的集合，d为待预测网络中的节点v和目标节点x之间的路径，d为待预测网络中的节点v和目标节点y之间的路径。优选地，S3中将一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为一阶邻域子图特征，具体包括：S31、将一阶邻域子图划分为x社区、y社区和CN社区；S32、分别计算x社区、y社区和CN社区的节点数和边数，将计算得到的节点数和边数作为对应社区的特征；S33、将对应社区的特征按照预设顺序排列，得到一阶邻域子图特征。优选地，S31中的x社区由如下节点集合而成：Vx＝Γ-{y}式中，Vx为x社区的节点集，Γ为目标节点x的一阶邻居节点集，即和节点x直接相连的节点的集合，{y}为目标节点y的集合。优选地，S31中的y社区由如下节点集合而成:Vy＝Γ-{x}式中，Vy为y社区的节点集，Γ为目标节点y的一阶邻居节点集合，即和节点y直接相连的节点的集合，{x}为目标节点x的集合。优选地，S31中的CN社区由如下节点集合而成:VCN＝Γ∩Γ式中，VCN为CN社区的节点集，Γ为目标节点x的一阶邻居节点集，Γ为目标节点y的一阶邻居节点集。优选地，S33中将对应社区的特征按照预设顺序排列，得到一阶邻域子图的特征，具体可表示为：式中，|Vx|为x社区的节点数，|Ex|为x社区的边数，|Vy|为y社区的节点数,|Ey|为y社区的边数，|VCN|为CN社区的节点数，|ECN|为CN社区的边数。优选地，S12中从无方向无权重的待预测网络中删除预设比例的边，预设比例为20％。上述一种基于子图特征的链路预测方法，首先获取待预测网络，对待预测网络进行预处理，得到无方向无权重的待预测网络，从无方向无权重的待预测网络中分别取边构成训练集样本和测试集样本；然后从训练集样本或测试集样本中每次提取两个目标节点，确定两个目标节点及其各自对应的一阶邻居节点集，对两个目标节点各自对应的一阶邻居节点集取并集得到两个目标节点组成的连边对应的一阶邻域子图；接着将一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为一阶邻域子图特征，从训练集样本或测试集样本中再次提取两个目标节点直至训练集样本或测试集样本中的所有目标节点均提取完成，经过同样方式处理，相应得到多个一阶邻域子图特征；最后预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个一阶邻域子图特征输入至训练后的全连接神经网络二分类器，经过处理，相应输出链路预测得分，根据预测得分判断对应两个目标节点组成的连边是否存在。该方法通过直接使用单跳邻域作为目标节点对的封闭子图，可以不需要预定子图大小以及更高阶的邻居信息，通过从封闭子图中提取若干关键特征作为全连接神经网络二分类器的输入，避免了因子图大小限制、池化操作以及排序导致的信息损失和计算量大等问题。该方法还能够从不同启发式的分解中得到有辨识性的子图信息，并利用神经网络的拟合能力自动为每个图数据构造合适的启发式，相比于现有链路预测技术具有更强的特征提取能力和更少的计算时间。附图说明图1是本发明一实施例中一种基于子图特征的链路预测方法的流程图；图2是本发明一实施例中本发明一实施例中一种基于子图特征的链路预测方法的算法框架图；图3是本发明一实施例中无方向无权重的的待预测网络示例图；图4是本发明另一实施例中无方向无权重的的待预测网络示例图；图5是本发明一实施例中目标节点x和y组成的边对应的一阶邻域子图；图6是本发明一实施例中对一阶邻域子图进行社区划分并提取一阶邻域子图特征的示意图；图7是本发明一实施例中计算社区节点的示意图。具体实施方式为了使本技术领域的人员更好地理解本发明的技术方案，下面结合附图对本发明作进一步的详细说明。一种基于子图特征的链路预测方法，具体包括：S1、获取待预测网络，对待预测网络进行预处理，得到无方向无权重的待预测网络，从无方向无权重的待预测网络中分别取边构成训练集样本和测试集样本；S2、从训练集样本或测试集样本中每次提取两个目标节点，确定两个目标节点各自对应的一阶邻居节点集合，对一阶邻居节点集合取并集得到两个目标节点组成的边对应的一阶邻域子图；S3、将一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为一阶邻域子图特征；S4、从训练集样本或测试集样本中再次提取两个目标节点直至训练集样本或测试集样本中的所有目标节点均提取完成，经过S2和S3处理，相应得到多个一阶邻域子图特征；S5、预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个一阶邻域子图特征输入至训练后的全连接神经网络二分类器，经过处理，输出链路预测得分，根据链路得分得到对应的两个目标节点组成的边的预测结果。具体地，参见图1和图2，图1为本发明一实施例中一种基于子图特征的链路预测方法的流程图，图2为本发明一实施例中一种基于子图特征的链路预测方法的算法框架图。一种基于子图特征的链路预测方法，首先获取待预测网络，对待预测网络进行预处理，得到无方向无权重的待预测网络，从无方向无权重的待预测网络中分别取边构成训练集样本和测试集样本；然后从训练集样本或测试集样本中每次提取两个目标节点，确定两个目标节点各自对应的一阶邻居节点集合，对其取并集得到两个目标节点组成的边对应的一阶邻域子图；接着将一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为一阶邻域子图特征；接着从训练集样本或测试集样本中再次提取两个目标节点直至训练集样本或测试集样本中的所有目标节点均提取完成，经过S2和S3处理，相应得到多个一阶邻域子图特征；最后预设全连接神经网络二分类器并进行训练，得到训练后的全连接神经网络二分类器，将多个一阶邻域子图特征输入至训练后的全连接神经网络二分类器，经过处理，相应输出链路预测得分，根据链路得分进行判断，得出对应两个目标节点组成的边的预测结果。例如，如果链路预测得分大于等于0.5，表示正边，即相应两个目标节点组成的边存在，否则，如果链路预测得分小于0.5，表示负边，即相应两个目标节点组成的边不存在。在一个实施例中，S1包括：S11、获取待预测网络，消除待预测网络中边的方向和权重，得到不包含孤立节点的无方向无权重的待预测网络；S12、从无方向无权重的待预测网络中删除预设比例的边，将未删除的边作为训练集正样本，将删除的边作为测试集正样本；S13、将无方向无权重的待预测网络中不存在边的节点对构成边，从中分别随机采样和训练集正样本和测试集正样本同等数量且不重合的边作为训练集负样本和测试集负样本，将训练集正样本和训练集负样本组成训练集样本，将测试集正样本和测试集负样本组成测试集样本。具体地，参见图3和图4，图3是本发明一实施例中的无方向无权重的待预测网络示例图，图4是本发明另一实施例中的的无方向无权重的待预测网络示例图。首先消除待预测网络中边的方向和权重，得到不包含孤立节点的无方向无权重的待预测网络，在图3中，所述无方向无权重的待预测网络中有9个节点，10条边，以及个节点对。图4为在图3基础上删除20％的边后得到一个无方向无权重的待预测网络，图4中的中网络有9个节点，8条边以及/＞个节点对。将图3中无方向无权重的待预测网络未删除的边作为训练集正样本，这些未删除的边也就是图4中无方向无权重的待预测网络中的边，此时训练集正样本中包括以下8个边：,,,,,,,；将图3中无方向无权重的待预测网络删除的边作为测试集正样本，包括以下2个边：,；从图3中无方向无权重的待预测网络不存在边的节点对中随机采样同训练集正样本的数量等同的边作为训练集负样本，在图3中无方向无权重的待测试网络有36个节点对，其中10对是有边的，所以从剩下的26对中随机选8个，比如：,,,,,,,；从图3中无方向无权重的待预测网络不存在边的节点对中随机采样同测试集正样本数量等同的边作为测试集负样本，其中训练集负样本和测试集负样本中的边不重合，比如：,。训练集正样本和训练集负样本共同组成训练集样本，测试集正样本和测试集负样本共同组成测试集样本。需要说明的是，图3中删除预设比例的边，此处预设比例为20％，也可以是10％，或30％等，预设比例越低，删除的边越少，预测精度会越高。在一个实施例中，S2具体包括：S21、从训练集样本或测试集样本中每次提取两个目标节点x和y；S22、提取目标节点x的一阶邻居节点，组成目标节点x的一阶邻居节点集合；S23、提取目标节点y的一阶邻居节点，组成目标节点y的一阶邻居节点集合；S24、对目标节点x的一阶邻居节点集合和目标节点y的一阶邻居节点集合取并集，得到两个目标节点x和y组成的边对应的一阶邻域子图。以训练集样本为例，首先从训练集样本中每次提取两个目标节点x和y；然后提取目标节点x的一阶邻居节点集，即和目标节点x直接相连的所有节点；接着采用同样的方法提取目标节点y的一阶邻居节点集，对目标节点x的一阶邻居节点集和目标节点y的一阶邻居节点集取并集构成目标节点x和y组成的边对应的一阶邻域子图。从测试集样本中每次提取两个目标节点，并确定两个目标节点组成的边对应的一阶邻域子图的方法同上，此处不再赘述。在一个实施例中，S24中两个目标节点x和y组成的边对应的一阶邻域子图由如下节点集合而成：Γ＝{v∈V|min,d)≤1}式中，Γ为目标节点x和y对应的一阶邻居节点的集合，V为待预测网络中所有节点的集合，d为待预测网络中的节点v和目标节点x之间的路径，d为待预测网络中的节点v和目标节点y之间的路径。具体地，参见图5，图5为本发明一实施例中的目标节点x和目标节点y的一阶邻域子图的示例图。在图5中，目标节点x和y的一阶邻域子图是由直接与目标节点x或y相连的节点的集合而成的，例如，与目标节点x直接相连接的点有1,2,3,4,5,6，且这些点和目标节点x之间都只有一个连边，同样，与目标节点y直接相连接的点有4,5,6,7,8,9,10,且这些点和目标节点y之间也都只有一个连边。目标节点x和y组成的边对应的一阶邻域子图由如下节点集合而成：Γ＝{v∈V|min,d)≤1}式中，Γ为目标节点x和y对应的一阶邻居节点的集合，V为待预测网络中所有节点的集合，d为待预测网络中的节点v和目标节点x之间的路径，d为待预测网络中的节点v和目标节点y之间的路径，min,d)≤1表示节点v与目标节点x或y直接相连。在图5中，Γ＝{1,2,3，4,5,6,7,8,9,10}。在一个实施例中，S3中将一阶邻域子图划分为三个社区，并分别提取每个社区的节点数和边数作为一阶邻域子图特征，具体包括：S31、将一阶邻域子图划分为x社区、y社区和CN社区；S32、分别计算x社区、y社区和CN社区的节点数和边数，将计算得到的节点数和边数作为对应社区的特征；S33、将对应社区的特征按照预设顺序排列，得到一阶邻域子图特征。具体地，参见图6，图6为本发明一实施例中对一阶邻域子图进行社区划分并提取一阶邻域子图特征的示意图。在图6中，首先将目标节点x和y的一阶邻域子图划分为x社区、y社区和CN社区，其中：x社区为如下节点的集合：Vx＝{1,2,3,4,5,6}x社区的边包括：Ex＝{,,}y社区为如下节点的集合：Vy＝{4,5,6,7,8,9,10}y社区的边包括：Ey＝{,}CN社区为如下节点的集合：VCN＝{4,5,6}CN社区的边包括：ECN＝{}然后分别计算x社区、y社区和CN社区的节点数和边数，相应如下：x社区的节点数|Vx|＝6，x社区的边数|Ex|＝3；y社区的节点数|Vy|＝7，y社区的边数|Ey|＝2；CN社区的节点数|VCN|＝3，CN社区的边数|ECN|＝1。上述节点数和边数即为对应社区的特征，将对应社区的特征按照预设顺序排列，得到一阶邻域子图特征，具体表述如下：＝在一个实施例中，S31中的x社区由如下节点集合而成：Vx＝Γ-{y}式中，Vx为x社区的节点集，Γ为目标节点x的一阶邻居节点集，即和节点x直接相连的节点的集合，{y}为目标节点y的集合。具体地，当目标节点x的一阶邻居节点集中包含了目标节点y,即目标节点y和目标节点x直接相连,此时计算x社区的节点时，需要去除目标节点y。在一个实施例中，S31中的y社区由如下节点集合而成:Vy＝Γ-{x}式中，Vy为y社区的节点集，Γ为目标节点y的一阶邻居节点集合，即和节点y直接相连的节点的集合，{x}为目标节点x的集合。具体地，当目标节点y的一阶邻居节点集中包含了目标节点x,即目标节点x和目标节点y直接相连,此时计算y社区的节点时，需要去除目标节点x。参见图7，图7为本发明一实施例中计算社区节点的示意图。在图7中，以提取的子图为例，即目标节点x为1，目标节点y为4：目标节点1的社区中的节点为：V1＝Γ-{4}＝{3,4}-{4}＝{3}，目标节点4的社区中的节点为：V4＝Γ-{1}＝{1,6}-{1}＝{6}。在图7中，以提取的子图为例，即目标节点x为3，目标节点y为6：目标节点3的社区中的节点为：V3＝Γ-{6}＝{1,2,5}-{6}＝{1，2，5}，目标节点6的社区中的节点为：V6＝Γ-{3}＝{4,7,8}-{3}＝{4,7,8}。在一个实施例中，S31中的CN社区由如下节点集合而成:VCN＝Γ∩Γ式中，VCN为CN社区的节点集，Γ为目标节点x的一阶邻居节点集，Γ为目标节点y的一阶邻居节点集。具体地，CN社区中的节点为目标节点x和目标节点y各自节点集中共有的节点。在一个实施例中，S33中将对应社区的特征按照预设顺序排列，得到一阶邻域子图特征，具体可表示为：式中，|Vx|为x社区的节点数，|Ex|为x社区的边数，|Vy|为y社区的节点数,|Ey|为y社区的边数，|VCN|为CN社区的节点数，|ECN|为CN社区的边数。具体地，目标节点x和目标节点y组成的边对应的一阶邻域子图特征就是其一阶邻域子图划分的三个社区对应的节点数和边数。进一步地，对上述一种基于子图特征的链路预测方法的预测效果进行实验验证。本实验采用USAir、NS、PB、Yeast、C.ele、Power、Router和E.coli八个真实世界网络作为实验数据集。其中，USAir是美国航空公司的航空网络，NS是基于网络科学领域论文发表而构建的科学家合作网络，PB是一个博客网络，Yeast是酵母中的一个蛋白质-蛋白质相互作用网络，C.ele是秀丽隐杆线虫的神经网络，Power是美国西部的一个电力网络，Router是一个路由级的互联网网络，E.coli是大肠杆菌中代谢产物的反应网络。为了比较本发明中的方法和现有方法的性能，将本发明中的方法与其他经典的基于拓扑启发式的方法、图表示学习方法和子图模式编码方法进行对比。启发式的方法包括CN、PA、Katz；图表示学习方法包括随机块模型SBM、node2vec和变分图自编码器VGAE；子图模式编码方法包括Weisfeiler-Lehman图核方法、WLNM和SEAL。本发明中的神经网络的结构都是一个全连接的神经网络，它有3个隐层，分别为32、32、16个神经元。所有隐藏层和输出层的激活函数分别选择ReLU和softmax。采用Adam更新规则进行优化，学习率为0.001，一个batch的大小为128。在训练过程中，epoch设置为100。每个数据集随机分成一组训练样本和一组测试样本并重复10次，记录10次的AUC平均值。实验采用python作为编程语言，神经网络的实现采用机器学习框架sklearn。表1为不同算法在不同数据集下均删除10％的边后进行链路预测的AUC值，其中NNESF为采用本发明技术方案中的链路预测方法。表1在表1中，每一列代表一种链路预测方法，前9列是现有的链路预测方法，第10例是本发明实施例提出的链路预测方法。表1中的每一行代表一个网络在AUC评价指标下的实验结果。在表1中，对于每个网络，最优的链路预测性能通过加粗的字体标记。可以看出，NNESF在USAir和NS数据集上的性能优于所有的启发式方法、所有的图表示学习方法以及子图模式编码方法下的WLK、WLNM和SEAL方法。与SEAL模型中的图神经网络相比，NNESF中使用的全连接神经网络包含的参数更少，这意味着NNESF在训练过程中需要的计算时间和内存更少。表2为三种算法的相关参数对比。在表2中，WLNM、SEAL和NNESF三种算法在子图特征提取时间、训练时间和峰值内存对比结果如下：表2上述三种算法的神经网络都是使用Torch机器学习框架实现的。由表2可以看出，首先，在子图特征提取过程中，WLNM和SEAL需要额外的时间完成节点排序，而NNESF只需要计算封闭子图中的节点和边的数量，因此NNESF子图特征提取时间远远小于WLNM和SEAL；其次，NNESF和WLNM的神经网络模型都是全连接神经网络，而SEAL是图神经网络，因此NNESF和WLNM训练时间和峰值内存都远小于SEAL；最后，从整体所需时间来看，WLNM和SEAL所需时间都明显大于NNESF。上述一种基于子图特征的链路预测方法，通过直接使用单跳邻域作为目标节点对的封闭子图，可以不需要预定子图大小以及更高阶的邻居信息，通过从封闭子图中提取若干关键特征作为全连接神经网络二分类器的输入，避免了因子图大小限制、池化操作以及排序导致的信息损失和计算量大等问题。该方法还能够从不同启发式的分解中得到有辨识性的子图信息，并利用神经网络的拟合能力自动为每个图数据构造合适的启发式，相比于现有链路预测技术具有更强的特征提取能力和更少的计算时间。以上对本发明所提供的一种基于子图特征的链路预测方法进行了详细介绍。本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的核心思想。应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以对本发明进行若干改进和修饰，这些改进和修饰也落入本发明权利要求的保护范围内。
