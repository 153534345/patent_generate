标题title
一种用于反射内存组网性能测试的装置及其方法
摘要abst
本发明提供了一种用于反射内存组网性能测试的装置及其方法，所述的装置包括光纤交换机、节点设备A、节点设备B、节点设备C、以太网交换机和测试PC，所述节点设备A、节点设备B、节点设备C通过一台光纤交换机进行组网，所述测试PC和节点设备A、节点设备B以及节点设备C之间采用以太网交换机进行连接。本发明通过一台专用的测试主机，预先对应常见操作系统、反射内存相关的代码模块的整理，根据不同的测试场景和测试数据，自动将数据和程序注入各个节点设备之中，最终自动生成测试报告，用户结合实际使用场景根据测试报告选择该组网模式下的最优参数设置。
权利要求书clms
1.一种用于反射内存组网性能测试的装置，其特征在于，包括光纤交换机、节点设备A、节点设备B、节点设备C、以太网交换机和测试PC，所述节点设备A、节点设备B、节点设备C通过一台光纤交换机进行组网，所述测试PC和节点设备A、节点设备B以及节点设备C之间采用以太网交换机进行连接；所述测试PC包括自动控制模块、框架代码模块、数据收发模块、定时模块、中断选择模块和网络数据注入读取控制模块；所述自动控制模块完成对应模块代码的生成、系统代码的集成、makefile编译文件的选择，完成数据的远程编译和运行停止功能；所述框架代码模块根据节点设备A、节点设备B、节点设备C不同的软硬件，通过获取和选择，通过自动控制脚生成不同的框架代码；所述中断选择模块根据用户选择的中断模式，完成对于中断模块相关代码的生成；所述数据收发模块根据用户选择的数据格式、数据长短，完成对于数据发送和数据接收、校验的代码生成；所述定时模块根据中断和非中断模式，完成对于代码中定时精度的设定；所述网络数据注入读取控制模块完成通过以太网交换机获取节点设备的系统信息、传输数据的操作。2.根据权利要求1所述的一种用于反射内存组网性能测试的装置的测试方法，其特征在于，包括以下步骤：先配置节点设备A、节点设备B、节点设备C的IP地址以及配置节点设备A、节点设备B、节点设备C的远程操作权限，远程控制节点设备A、节点设备B、节点设备C建立专用文件夹，完成通信和设备基本状态检测；再在测试PC的测试界面选择确定节点设备A、节点设备B、节点设备C的系统信息，按照对应的系统信息，通过网口注入对应的系统测试代码，自动执行，获取节点设备的编译器信息和反射内存信息，并返回测试PC，根据返回的系统信息和之前确定的系统信息，结合测试PC的系统测试软件支持的编译器和系统信息，按照优先级自动确定远程控制使用的编译器信息；然后注明测试的定时精度、传输数据大小、测试总步长，在测试PC的测试界面上确定反射内存是否选择中断模式；需要确定发送中断模式的节点，即只有一个节点完成中断模式和数据的发送，其余节点完成中断的响应和数据的接收，中断模式下需要确定中断类型：默认中断一；根据选择的设备节点的信息和反射内存的设置参数，完成对应各个设备节点的相应功能的源码生成，将生成的源码通过以太网导入到节点设备A、节点设备B、节点设备C之中，并自动调用编译器完成对可执行文件的编译，并在测试PC上实时反馈编译状态信息；再远程控制节点设备A、节点设备B、节点设备C实时运行，验证自动生成的代码运行是否正常，返回测试结果，远程控制节点设备A、节点设备B、节点设备C节点实时运行，反射内存按照设定的参数进行定时数据的收发、误码率的测试，本地保存测试报告，重复进行直至生成测试报告；最后提取测试报告，自动比较各种测试模式下的误码率，根据实际使用场景，确定最优定时时间、中断参数、传输数据大小、主节点选择。3.根据权利要求2所述的一种用于反射内存组网性能测试的装置的测试方法，其特征在于，按照定时中断的设置，提前设计传输数据的数据格式，系统根据收到的数据帧，完成对于数据正常的判断，主节点完成数据帧的生成，数据帧至少包括、帧头、帧尾、校验信息、有效数据、标志位信息，其中有效信息采用数据累加的方式。
说明书desc
技术领域本发明属于及反射内存性能组网测试技术领域，具体涉及一种用于反射内存组网性能测试的装置及其方法。背景技术目反射内存是半实物仿真场景下一种被经常使用的模块。通常情况下，反射内存被组网使用，主要解决在各节点设备之间数据的快速传递、共享。通常反射内存配合实时操作系统使用。在反射内存组网中，一个节点的反射内存数据发生改变，会在极短的时间内自动更新系统其他的节点对应地址的数据。在工程应用领域，在使用反射内存组网之前，对于系统的放射内存性能进行测试是必不可少的。需要结合实际的工程应用场景，得出在组网模式下，系统的最优定时、最优数据传输大小、中断使用、主从节点的分配等问题。半实物仿真系统中，可能会遇到各节点设备的操作系统、定时精度不相同的问题，甚至会遇到不同设备之间采用的反射内存硬件版本不一致的问题，可以理解为，以内存为例，一个128M一个256M，有时候并不影响使用，但是不同版本的反射内存之间对于定时的响应、传输的速率等是有可能不一样的，在工程中，存在个设备节点已经存在，需要将不同的设备进行组网，这个时候有时候为了保证统一，可能会选择将各节点设备的软硬件统一，也可能不会进行统一。传统的反射内存组网模式，通常采用手动选择的方式选择某一主节点设备进行定时数据发送，通过切换延时长短和数据大小等进行反射内存组网性能测试。这一测试方法需要耗费大量的时间，代码的手动修改编译也可能带来额外的人为测试偏差。基于此，提出了一种快速测试反射内存组网性能的装置及其方法。发明内容本发明针对上述现有技术的不足，提供一种用于反射内存组网性能测试的装置及其测试方法，通过一台专用的测试主机，预先对应常见操作系统、反射内存相关的代码模块的整理，根据不同的测试场景和测试数据，自动将数据和程序注入各个节点设备之中，最终自动生成测试报告，用户结合实际使用场景根据测试报告选择该组网模式下的最优参数设置。具体的，本发明采用的技术方案是：第一方面，提供一种用于反射内存组网性能测试的装置，包括光纤交换机、节点设备A、节点设备B、节点设备C、以太网交换机和测试PC，所述节点设备A、节点设备B、节点设备C通过一台光纤交换机进行组网，所述测试PC和节点设备A、节点设备B以及节点设备C之间采用以太网交换机进行连接；所述测试PC包括自动控制模块、框架代码模块、数据收发模块、定时模块、中断选择模块和网络数据注入读取控制模块；所述自动控制模块完成对应模块代码的生成、系统代码的集成、makefile编译文件的选择，完成数据的远程编译和运行停止功能；所述框架代码模块根据节点设备A、节点设备B、节点设备C不同的软硬件，通过获取和选择，通过自动控制脚生成不同的框架代码；所述中断选择模块根据用户选择的中断模式，完成对于中断模块相关代码的生成；所述数据收发模块根据用户选择的数据格式、数据长短，完成对于数据发送和数据接收、校验的代码生成；所述定时模块根据中断和非中断模式，完成对于代码中定时精度的设定；所述网络数据注入读取控制模块完成通过以太网交换机获取节点设备的系统信息、传输数据的操作。第二方面，提供一种用于反射内存组网性能测试的装置的测试方法，包括以下步骤：先配置节点设备A、节点设备B、节点设备C的IP地址以及配置节点设备A、节点设备B、节点设备C的远程操作权限，远程控制节点设备A、节点设备B、节点设备C建立专用文件夹，完成通信和设备基本状态检测；再在测试PC的测试界面选择确定节点设备A、节点设备B、节点设备C的系统信息，按照对应的系统信息，通过网口注入对应的系统测试代码，自动执行，获取节点设备的编译器信息和反射内存信息，并返回测试PC，根据返回的系统信息和之前确定的系统信息，结合测试PC的系统测试软件支持的编译器和系统信息，按照优先级自动确定远程控制使用的编译器信息；然后注明测试的定时精度、传输数据大小、测试总步长，在测试PC的测试界面上确定反射内存是否选择中断模式；需要确定发送中断模式的节点，即只有一个完成中断模式和数据的发送，其余节点完成中断的响应和数据的接收，中断模式下需要确定中断类型：默认中断一；根据选择的设备节点的信息和反射内存的设置参数，完成对应各个设备节点的相应功能的源码生成，将生成的源码通过以太网导入到节点设备A、节点设备B、节点设备C之中，并自动调用编译器完成对可执行文件的编译，并在测试PC上实时反馈编译状态信息；再远程控制节点设备A、节点设备B、节点设备C实时运行，验证自动生成的代码运行是否正常，返回测试结果，远程控制节点设备A、节点设备B、节点设备C节点实时运行，反射内存按照设定的参数进行定时数据的收发、误码率的测试，本地保存测试报告，重复进行直至生成测试报告；最后提取测试报告，自动比较各种测试模式下的误码率，根据实际使用场景，确定最优定时时间、中断参数、传输数据大小、主节点选择。按照定时中断的设置，提前设计传输数据的数据格式，系统根据收到的数据帧，完成对于数据正常的判断，主节点完成数据帧的生成，数据帧至少包括、帧头、帧尾、校验信息、有效数据、标志位信息，其中有效信息采用数据累加的方式。本发明与现有技术相比具有以下优点：本发明通过一台专用的测试主机，预先对应常见操作系统、反射内存相关的代码模块的整理，根据不同的测试场景和测试数据，自动将数据和程序注入各个节点设备之中，最终自动生成测试报告，用户结合实际使用场景根据测试报告选择该组网模式下的最优参数设置。附图说明图1是本发明的反射内存组网示意图。图2是本发明测试PC原理框架图。图3是本发明反射内存组网性能测试流程图。附图标记说明：1、光纤交换机；2、节点设备A；3、节点设备B；4、节点设备C；5、以太网交换机；6、测试PC；61、自动控制模块；62、框架代码模块；63、数据收发模块；64、定时模块；65、中断选择模块；66、网络数据注入读取控制模块。实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。如图1-3所示，本发明提供一种技术方案：一种用于反射内存组网性能测试的装置，包括光纤交换机1、节点设备A 2、节点设备B 3、节点设备C 4、以太网交换机5和测试PC6，所述节点设备A 2、节点设备B 3、节点设备C 4通过一台光纤交换机1进行组网，所述测试PC 6和节点设备A 2、节点设备B 3以及节点设备C 4之间采用以太网交换机5进行连接；所述测试PC 6包括自动控制模块61、框架代码模块62、数据收发模块63、定时模块64、中断选择模块65和网络数据注入读取控制模块66；所述自动控制模块61完成对应模块代码的生成、系统代码的集成、makefile编译文件的选择，完成数据的远程编译和运行停止功能；所述框架代码模块62根据节点设备A 2、节点设备B 3、节点设备C 4不同的软硬件，通过获取和选择，通过自动控制脚生成不同的框架代码；所述中断选择模块65根据用户选择的中断模式，完成对于中断模块相关代码的生成；所述数据收发模块63主要根据用户选择的数据格式、数据长短，完成对于数据发送和数据接收、校验的代码生成；所述定时模块64根据中断和非中断模式，完成对于代码中定时精度的设定；所述网络数据注入读取控制模块66完成通过以太网交换机5获取节点设备的系统信息、传输数据的操作。一种用于反射内存组网性能测试的装置的测试方法，包括以下步骤：先配置节点设备A 2、节点设备B 3、节点设备C 4的IP地址以及配置节点设备A 2、节点设备B 3、节点设备C 4的远程操作权限，远程控制节点设备A 2、节点设备B 3、节点设备C 4建立专用文件夹，完成通信和设备基本状态检测。再在测试PC 6的测试界面选择确定节点设备A 2、节点设备B 3、节点设备C 4的系统信息，按照对应的系统信息，通过网口注入对应的系统测试代码，自动执行，获取节点设备的编译器信息和反射内存信息，并返回测试PC 6，根据返回的系统信息和之前确定的系统信息，结合测试PC 6的系统测试软件支持的编译器和系统信息，按照优先级自动确定远程控制使用的编译器信息。然后注明测试的定时精度、传输数据大小、测试总步长，在测试PC 6的测试界面上确定反射内存是否选择中断模式；需要确定发送中断模式的节点，即只有一个完成中断模式和数据的发送，其余节点完成中断的响应和数据的接收，中断模式下需要确定中断类型：默认中断一。本发明的测试系统，需要测试反射内存的两种模式：中断模式和非中断模式，而反射内存一般有4种中断模式，中断一、中断二、中断三、中断四。在中断模式下，可以选择其中的一种中断的类型。本发明中所确定的中断类型“默认中断一”，即在选择中断模式却不选择具体的中断类型的情况下，默认选择中断一。根据选择的设备节点的信息和反射内存的设置参数，完成对应各个设备节点的相应功能的源码生成，将生成的源码通过以太网导入到节点设备A 2、节点设备B 3、节点设备C 4之中，并自动调用编译器完成对可执行文件的编译，并在测试PC 6上实时反馈编译状态信息。再远程控制节点设备A 2、节点设备B 3、节点设备C 4实时运行，验证自动生成的代码运行是否正常，返回测试结果，远程控制节点设备A 2、节点设备B 3、节点设备C 4节点实时运行，反射内存按照设定的参数进行定时数据的收发、误码率的测试，本地保存测试报告，重复进行直至生成测试报告。最后提取测试报告，自动比较各种测试模式下的误码率，根据实际使用场景，确定最优定时时间、中断参数、传输数据大小、主节点选择。按照定时中断的设置，提前设计传输数据的数据格式，系统根据收到的数据帧，完成对于数据正常的判断，主节点完成数据帧的生成，数据帧至少应该包括、帧头、帧尾、校验信息、有效数据、标志位信息，其中有效信息采用数据累加的方式。具体的实施方式如下：S1：系统由3台设备节点，节点设备A 2、节点设备B 3、节点设备C 4构成，分别采用windows32位操作系统、window-RTX32位操作系统，centos64位操作系统。反射内存最大支持128M数据的传输，有4种中断可供选择。测试PC采用EA平台用于模块代码的自动生成。自动控制脚本采用windows自带的bat脚本。S2：采用SSH工具，测试P C6和节点设备A 2、节点设备B 3、节点设备C 4之间完成连接。在节点设备A 2、节点设备B 3、节点设备C 4的C盘新建一个专门用于反射内存测试的文件夹RF_TEST。将用于反射内存和系统信息获取的文件注入RF_TEST中。S3：测试PC 6远程执行节点设备A 2、节点设备B 3、节点设备C 4中系统信息获取的文件，获取反射内存的系统信息、设备节点的编译器信息，并上传测试PC 6。S4：用户选择或者系统默认，对应节点设备选择的编译器信息，例如节点设备A 2采用MinGW、节点设备B 3采用MinGW，节点设备C 4采用GCC工具。S5：在测试PC 6软件界面选择中断模式、节点设备A 2为主节点、定时精度为1ms、采用中断一、传输数据为1024个int数据，offset确定为0x100。运行步长为1万次。S6：测试PC 6根据选择的反射内存参数，通过一系列的脚本工具链，通过EA工具，完成了节点设备A 2、节点设备B 3、节点设备C 4对应参数的框架代码、各模块代码、makefile文件生成。S7：测试PC 6通过ssh工具将集成代码和编译文件，下载到RF_TEST中。S8：通过远程控制文件，节点设备A 2、节点设备B 3、节点设备C 4完成代码的编译，并通过SSH返回编译信息。S9：通过远程控制文件，控制节点设备A 2、节点设备B 3、节点设备 C4的代码运行启动，此时节点设备A 2定时往offset0x100发送1024个int数和中断。数据格式为头、发送次数、1024int数、尾的方式进行，节点设备B 3、节点设备C 4接收到中断以后，按照接收的先后去判定数据的正确性。如果产生误码，记录现场数据。S10：运行1万次以后，节点设备A 2、节点设备B 3、节点设备C 4自动停止运行。测试PC 6获取到节点设备A 2、节点设备B 3、节点设备C 4的测试输出文件。S11：修改主节点、定时精度、中断方式、数据大小、步长等设置，反复执行S5-S10，比较最终输出文件。S12：将S11的过程编写为测试用例，使得参数之前的转换采用自动运行的方式进行，节约人力时间。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。
