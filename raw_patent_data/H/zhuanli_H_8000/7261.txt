标题title
一种基于时间序列聚类的短期负荷预测方法
摘要abst
一种基于时间序列聚类的短期负荷预测方法，首先基于历史日期的负载时间序列对历史日期集做聚类分析，给每个历史日期分配聚类标签并确定日期类型，然后在历史日期集中选定与待预测日期的日期类型相同，同时与待预测日期前p天的标签序列相同的历史日期作为目标日期，随后在历史日期集中选定目标日期前q天，计算目标日期前q天的温度时间序列与待预测日期前q天的温度时间序列之间的距离，筛选出距离最近的目标日期并基于其负载时间序列计算得到待预测日期的负载时间序列。本设计不仅充分考虑了日期和温度对于负荷的影响，而且充分利用了数据时间序列包含的信息，最终提高短期负荷预测精度。
权利要求书clms
1.一种基于时间序列聚类的短期负荷预测方法，其特征在于：所述预测方法依次按照以下步骤进行：S1、基于历史日期的负载时间序列对历史日期集做聚类分析，给每个历史日期分配聚类标签，并确定每个历史日期所属的日期类型；S2、在历史日期集中选定多个同时满足以下条件的历史日期作为目标日期：a、日期类型与待预测日期的日期类型相同；b、前p天的标签序列与待预测日期前p天的标签序列相同；S3、在历史日期集中选定目标日期前q天，计算目标日期前q天的温度时间序列与待预测日期前q天的温度时间序列之间的距离，筛选得到多个前q天的温度时间序列与待预测日期前q天的温度时间序列之间距离最近的目标日期；S4、基于步骤S3筛选到的目标日期的负载时间序列计算得到待预测日期的负载时间序列。2.根据权利要求1所述一种基于时间序列聚类的短期负荷预测方法，其特征在于：步骤S1中，采用K-Medoids聚类分析法做聚类分析，所述K-Medoids聚类分析法中所使用的距离、目标日期前q天的温度时间序列与待预测日期前q天的温度时间序列之间的距离均通过以下公式计算得到：；；上式中，为组合距离，w1、w2、w3、w4分别为欧几里得距离权重、基于皮尔森相关性的测量距离权重、基于周期图的欧式距离权重、估计自相关函数间的欧式距离权重，/＞、/＞、、/＞分别为欧几里得距离、基于皮尔森相关性的测量距离、基于周期图的欧式距离、估计自相关函数间的欧式距离。3.根据权利要求2所述一种基于时间序列聚类的短期负荷预测方法，其特征在于：所述欧几里得距离的计算公式为：；上式中，为欧几里得距离，/＞为第d1个历史日期在第t个采样周期的数据，/＞为第d2个历史日期在第t个采样周期的数据，n为采样周期的数量，数据为温度采样数据或负荷采样数据。4.根据权利要求2所述一种基于时间序列聚类的短期负荷预测方法，其特征在于：所述基于皮尔森相关性的测量距离的计算公式为：；；上式中，为第d1个历史日期的数据时间序列/＞与第d2个历史日期的数据时间序列/＞之间的皮尔森相关性，n为采样周期的数量，/＞为第d1个历史日期在第t个采样周期的数据，/＞为第d2个历史日期在第t个采样周期的数据，数据为温度数据或负荷数据，为基于皮尔森相关性的测量距离。5.根据权利要求2所述一种基于时间序列聚类的短期负荷预测方法，其特征在于：所述基于周期图的欧式距离的计算公式为：；；；上式中，、/＞分别为第d1个历史日期的数据时间序列/＞、第d2个历史日期的数据时间序列/＞的周期图，/＞，/＞， n为采样周期的数量，/＞为第d1个历史日期在第t个采样周期的数据，/＞为第d2个历史日期在第t个采样周期的数据，数据为温度数据或负荷数据，/＞为基于周期图的欧式距离。6.根据权利要求2所述一种基于时间序列聚类的短期负荷预测方法，其特征在于：所述估计自相关函数间的欧式距离的计算公式为：；/＞；上式中，、/＞分别为第d1个历史日期的数据时间序列/＞、第d2个历史日期的数据时间序列/＞的自相关系数，/＞为数据时间序列/＞的平均值，数据时间序列/＞中的数据为温度数据或负荷数据，k=1，2，…，n，n为采样周期的数量，/＞为估计自相关函数之间的欧式距离。7.根据权利要求1所述一种基于时间序列聚类的短期负荷预测方法，其特征在于：步骤S4包括根据以下公式计算得到待预测日期的负载时间序列：；；；上式中，为权重，/＞为第d个目标日期的前q天温度时间序列/＞与待预测日期的前q天温度时间序列/＞之间的距离，d=1，2，…，N2，N2为由步骤S3筛选到的目标日期的天数，/＞为待预测日期的负载时间序列，t =1，2，…，n，n为采样周期的数量，N为历史日期集中历史日期的数量，/＞表示待预测日期的前q天温度时间序列/＞中第t个采样周期的温度数据。8.根据权利要求1所述一种基于时间序列聚类的短期负荷预测方法，其特征在于：步骤S2中，所述日期类型分为工作日、非工作日或者分为节假日、非节假日。
说明书desc
技术领域本发明属于电力系统负荷预测技术领域，具体涉及一种基于时间序列聚类的短期负荷预测方法。背景技术短期负荷预测在能源规划中起着重要作用，其准确性直接影响电力系统的运行和管理方式。短期负荷预测可以定义为时间范围从一天到两周的负荷预测，它是电力行业中包括发电机经济调度、机组承诺、安全评估和维护计划等操作过程的基础。相似模式方法是在历史数据集中找到相似的日负载模式，并在这些选定的相似天数内，通过使用聚合度量或一些机器学习算法进行短期负荷预测。但鉴于负荷时间序列的波动性、非线性和非平稳性，以及影响因素的多样性，包括气象、日历和随机因素，导致并非前期具有相似的日负载模式的所有日子都会呈现相似的日负荷分布，存在短期负荷预测精度较差的问题。发明内容本发明的目的是克服现有技术存在的上述问题，提供一种预测精度高的基于时间序列聚类的短期负荷预测方法。为实现以上目的，本发明提供了以下技术方案：一种基于时间序列聚类的短期负荷预测方法，所述预测方法依次按照以下步骤进行：S1、基于历史日期的负载时间序列对历史日期集做聚类分析，给每个历史日期分配聚类标签，并确定每个历史日期所属的日期类型；S2、在历史日期集中选定多个同时满足以下条件的历史日期作为目标日期：a、日期类型与待预测日期的日期类型相同；b、前p天的标签序列与待预测日期前p天的标签序列相同；S3、在历史日期集中选定目标日期前q天，计算目标日期前q天的温度时间序列与待预测日期前q天的温度时间序列之间的距离，筛选得到多个前q天的温度时间序列与待预测日期前q天的温度时间序列之间距离最近的目标日期；S4、基于步骤S3筛选到的目标日期的负载时间序列计算得到待预测日期的负载时间序列。步骤S1中，采用K-Medoids聚类分析法做聚类分析，所述K-Medoids聚类分析法中所使用的距离、目标日期前q天的温度时间序列与待预测日期前q天的温度时间序列之间的距离均通过以下公式计算得到：；；/＞上式中，为组合距离，w1、w2、w3、w4分别为欧几里得距离权重、基于皮尔森相关性的测量距离权重、基于周期图的欧式距离权重、估计自相关函数间的欧式距离权重，/＞、、/＞、/＞分别为欧几里得距离、基于皮尔森相关性的测量距离、基于周期图的欧式距离、估计自相关函数间的欧式距离。所述欧几里得距离的计算公式为：；上式中，为欧几里得距离，/＞为第d1个历史日期在第t个采样周期的数据，为第d2个历史日期在第t个采样周期的数据，n为采样周期的数量，数据为温度采样数据或负荷采样数据。所述基于皮尔森相关性的测量距离的计算公式为：；；上式中，为第d1个历史日期的数据时间序列/＞与第d2个历史日期的数据时间序列/＞之间的皮尔森相关性，n为采样周期的数量，/＞为第d1个历史日期在第t个采样周期的数据，/＞为第d2个历史日期在第t个采样周期的数据，数据为温度数据或负荷数据，/＞为基于皮尔森相关性的测量距离。所述基于周期图的欧式距离的计算公式为：；；；/＞上式中，、/＞分别为第d1个历史日期的数据时间序列/＞、第d2个历史日期的数据时间序列/＞的周期图，/＞，/＞， n为采样周期的数量，/＞为第d1个历史日期在第t个采样周期的数据，/＞为第d2个历史日期在第t个采样周期的数据，数据为温度数据或负荷数据，/＞为基于周期图的欧式距离。所述估计自相关函数间的欧式距离的计算公式为：；；上式中，、/＞、/＞分别为第d1个历史日期的数据时间序列/＞、第d2个历史日期的数据时间序列/＞、第d个历史日期的数据时间序列/＞的自相关系数序列中第k个数据，/＞为第d个历史日期的数据时间序列/＞的平均值，/＞为第d个历史日期的数据时间序列/＞中第t个采样周期的数据，数据为温度数据或负荷数据，k=1，2，…，n，n为采样周期的数量，/＞为估计自相关函数之间的欧式距离。步骤S4包括根据以下公式计算得到待预测日期的负载时间序列：；；；上式中，为权重，/＞为第d个目标日期的前q天温度时间序列与待预测日期的前q天温度时间序列/＞之间的距离，d=1，2，…，N2，N2为由步骤S3筛选到的目标日期的天数，/＞为待预测日期的负载时间序列，t =1，2，…，n，n为采样周期的数量，N为历史日期集中历史日期的数量，/＞表示待预测日期的前q天温度时间序列/＞中第t个采样周期的温度数据。步骤S2中，所述日期类型分为工作日、非工作日或者分为节假日、非节假日。与现有技术相比，本发明的有益效果为：1、本发明一种基于时间序列聚类的短期负荷预测方法，首先基于历史日期的负载时间序列对历史日期集做聚类分析，给每个历史日期分配聚类标签，并确定每个历史日期所属的日期类型，然后在历史日期集中选定日期类型与待预测日期的日期类型相同，同时前p天的标签序列与待预测日期前p天的标签序列相同的历史日期作为目标日期，随后在历史日期集中选定目标日期前q天，计算目标日期前q天的温度时间序列与待预测日期前q天的温度时间序列之间的距离，筛选得到多个前q天的温度时间序列与待预测日期前q天的温度时间序列之间距离最近的目标日期，并基于筛选得到的目标日期的负载时间序列计算得到待预测日期的负载时间序列；通过该方法筛选得到的最终用于预测的历史日期与待预测日期不仅日期类型相同，而且前几日的温度分布、负荷分布均相似，该设计一方面充分考虑了日期和温度对于负荷的影响，另一方面着重考虑了温度和负荷数据在较长时期内的连续性，充分利用了数据时间序列包含的信息，最终提高了短期负荷预测精度。2、本发明一种基于时间序列聚类的短期负荷预测方法，在聚类分析以及温度时间序列匹配时采用考虑四个归一化距离的组合距离，旨在结合每个距离测量值的特点，利用欧几里得距离捕捉尺度上的差异，通过基于皮尔森相关性的欧式距离考虑到随时间的线性增加或减少趋势，基于周期图的欧氏距离能够表示序列的频率或周期成分之间的差异，估计自相关函数之间的欧式距离体现了对过去观测的依赖关系，使聚类分析以及温度时间序列匹配结果更准确，进一步提高短期负荷预测精度。因此，本发明进一步提高了短期负荷预测精度。附图说明图1为本发明的流程图。具体实施方式下面结合说明书附图和具体实施方式对本发明作进一步的说明。参见图1，一种基于时间序列聚类的短期负荷预测方法依次按照以下步骤进行：S1、选取某地2014-2017年构建历史日期集，所述历史日期集中历史日期的数量N为1096天，确定历史日期集中每个历史日期所属的日期类型，并基于历史日期的负载时间序列采用K-Medoids聚类分析法对历史日期集做聚类分析，给每个历史日期分配聚类标签，其中，所述日期类型分为工作日、非工作日，所述K-Medoids聚类分析法中所使用的组合距离通过以下步骤计算得到，此处数据种类为负荷数据：首先，分别计算得到欧几里得距离、基于皮尔森相关性的测量距离、基于周期图的欧式距离、估计自相关函数间的欧式距离，其中，所述欧几里得距离的计算公式为：；上式中，为欧几里得距离，/＞为第d1个历史日期在第t个采样周期的数据，为第d2个历史日期在第t个采样周期的数据，n为采样周期的数量；所述基于皮尔森相关性的测量距离的计算公式为：；；上式中，为第d1个历史日期的数据时间序列/＞与第d2个历史日期的数据时间序列/＞之间的皮尔森相关性，n为采样周期的数量，/＞为第d1个历史日期在第t个采样周期的数据，/＞为第d2个历史日期在第t个采样周期的数据，/＞为基于皮尔森相关性的测量距离；所述基于周期图的欧式距离的计算公式为：；；；上式中，、/＞分别为第d1个历史日期的数据时间序列/＞、第d2个历史日期的数据时间序列/＞的周期图，/＞，/＞， n为采样周期的数量，/＞为第d1个历史日期在第t个采样周期的数据，/＞为第d2个历史日期在第t个采样周期的数据，/＞为基于周期图的欧式距离，此处数据种类为负荷数据；所述估计自相关函数间的欧式距离的计算公式为：；/＞；上式中，、/＞、/＞分别为第d1个历史日期的数据时间序列/＞、第d2个历史日期的数据时间序列/＞、第d个历史日期的数据时间序列/＞的自相关系数序列中第k个数据，/＞为第d个历史日期的数据时间序列/＞的平均值，/＞为第d个历史日期的数据时间序列/＞中第t个采样周期的数据，数据为温度数据或负荷数据，k=1，2，…，n，n为采样周期的数量，/＞为估计自相关函数之间的欧式距离，第d1个历史日期的数据时间序列/＞的自相关系数序列为/＞，第d2个历史日期的数据时间序列/＞的自相关系数序列为/＞；然后，通过以下公式计算得到组合距离：；；上式中，为组合距离，w1、w2、w3、w4分别为欧几里得距离权重、基于皮尔森相关性的测量距离权重、基于周期图的欧式距离权重、估计自相关函数间的欧式距离权重；S2、在历史日期集中选定N1个同时满足以下条件的历史日期作为目标日期：条件a、日期类型与待预测日期的日期类型相同；条件b、前p天的标签序列与待预测日期前p天的标签序列相同，p=5；S3、先在历史日期集中选定目标日期前q天，q=2，计算每个目标日期的前q天温度时间序列与待预测日期的前q天温度时间序列之间的组合距离，该组合距离的计算过程与K-Medoids聚类分析法中所使用的组合距离计算过程相同，然后筛选得到N2个前q天的温度时间序列与待预测日期前q天的温度时间序列之间组合距离最近的目标日期，其中，；上式中，round为四舍五入函数，P为设置的取值比例，P=0.2；S4、基于步骤S3筛选到的N2个目标日期的负载时间序列，，计算得到待预测日期/＞的负载时间序列，计算过程如下：；；；上式中，为权重，/＞为第d个目标日期的前q天温度时间序列/＞与待预测日期/＞的前q天温度时间序列/＞之间的组合距离，d=1，2，…，N2，N2为由步骤S3筛选到的目标日期的天数，/＞为待预测日期/＞的负载时间序列，t =1，2，…，n，n为采样周期的数量，n=96，采样周期为15分钟，N为历史日期集中历史日期的数量，/＞表示待预测日期的前q天温度时间序列/＞中某一天第t个采样周期的温度数据，/＞表示第d个目标日期的前q天温度时间序列/＞中某一天第t个采样周期的温度数据。性能测试：1、为了评估本发明预测精度，以SN、PSF、SPA作为对比例1-3，分别计算本发明实施例及对比例1-3的预测误差指标，结果如表1所示，所述预测误差指标包括RMSE、MAE、MAPE，计算公式为：；；；上式中，et为观测值与相应的预测值之间的差值；表1 预测性能对比由上表可知，本发明在RMSE、MAE和MAPE这三个预测误差指标上均低于对比例1-3，表示本发明的预测精度好。2、采用HI指数检验组合距离及各单一距离的度量性能，结果如表2所示：表2 组合距离及各单一距离的HI指数由上表可知，本发明使用的组合距离在Mean，Perc.50th指标下取得最好性能，在其他指标上虽然不是最佳，但仍得到较好结果，综合来看，本发明使用的组合距离相比单一距离偏差更小，数据更集中，能提供更好的分类效果。3、分别使用各单一距离进行预测，计算本发明实施例及使用各单一距离的预测误差指标，结果如表3所示：表3 组合距离及各单一距离的预测性能由上表可知，本发明使用组合距离的预测精度高于使用单一距离的预测精度。
