标题title
设备接入方法、装置、电子设备及存储介质
摘要abst
本发明涉及通信技术领域，提供一种设备接入方法、装置、电子设备及存储介质，该方法包括：接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出第一设备的第一设备类型；将第一设置地址请求发送至载波系统，以接收载波系统基于第一设置地址请求返回的第一应用协议；基于第一应用协议和第一设备类型，将第一设备接入至载波系统；第一设备为RS485设备，载波系统为PLC电力线载波系统，第一应用协议为PLC通用应用协议。本发明提供的设备接入方法通过第一协议接口和第一应用协议，实现了将RS485设备接入至了PLC电力线载波系统中，需控制RS485设备时，PLC电力线载波系统能够直接对RS485设备进行控制通信。
权利要求书clms
1.一种设备接入方法，其特征在于，包括：接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。2.根据权利要求1所述的设备接入方法，其特征在于，所述基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统，包括：基于所述第一应用协议和所述第一设备类型，确定所述第一设备的第一新RS485地址；将所述第一新RS485地址发送至所述第一设备，以接收所述第一设备基于所述第一新RS485地址返回的第一地址修改完成指令；将所述第一地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第一设备。3.根据权利要求1所述的设备接入方法，其特征在于，所述基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统之后，还包括：接收到新的第二设备发送的第二设置地址请求后，确定通过所述第一协议接口是否能识别出第二设备的设备类型；若确定通过所述第一协议接口能识别出所述第二设备的设备类型，则将所述第二设备作为所述第一设备，并执行所述第一设备接入至所述载波系统的过程步骤；其中，所述第二设备为RS485设备。4.根据权利要求3所述的设备接入方法，其特征在于，所述确定通过所述第一协议接口是否能识别出第二设备的设备类型之后，还包括：若确定通过所述第一协议接口识别不能识别出所述第二设备的设备类型，则通过第二协议接口识别所述第二设备的第二设备类型；将所述第二设置地址请求发送至所述载波系统，以接收所述载波系统基于所述第二设置地址请求返回的第二应用协议；基于所述第二应用协议和所述第二设备类型，将所述第二设备接入至所述载波系统；其中，所述第二应用协议为PLC通用应用协议。5.根据权利要求4所述的设备接入方法，其特征在于，所述基于所述第二应用协议和所述第二设备类型，将所述第二设备接入至所述载波系统，包括：基于所述第二应用协议和所述第二设备类型，确定所述第二设备的第二新RS485地址；将所述第二新RS485地址发送至所述第二设备，以接收所述第二设备基于所述第二新RS485地址返回的第二地址修改完成指令；将所述第二地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第二设备。6.根据权利要求1至5任一项所述的设备接入方法，其特征在于，所述设备接入方法还包括：确定所述第一设备的协议信息以及RS485通讯波特率；所述协议信息包括RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息；根据所述第一设备的RS485通讯波特率、RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息，封装得到所述第一协议接口。7.根据权利要求1至5任一项所述的设备接入方法，其特征在于，所述设备接入方法还包括：接收所述载波系统发送的PLC应用通用协议消息；对所述PLC应用通用协议消息进行解析，得到PLC命令码、RS485设备通信地址和RS485具体消息；基于所述PLC命令码和所述RS485设备通信地址，确定出待控制RS485负载设备；基于所述RS485具体消息控制所述待控制RS485负载设备。8.一种设备接入装置，其特征在于，包括：识别模块，用于接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；发送模块，用于将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；设备接入模块，用于基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。9.一种电子设备，所述电子设备包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至7任一项所述的设备接入方法。10.一种非暂态计算机可读存储介质，所述非暂态计算机可读存储介质包括计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1至7任一项所述的设备接入方法。
说明书desc
技术领域本发明涉及通信技术领域，尤其涉及一种设备接入方法、装置、电子设备及存储介质。背景技术近几年来电力线载波系统已在家庭视音频和电力抄表等方面取得重大突破，并给相关企业带来了良好的经益。其特点是利用现有电力线，通过载波方式将模拟或数字信号进行高速传输。但电力线载波PLC不能直接与常见的RS485设备进行通信，如RS485窗帘电机、RS485智能空开、空调控制器等。发明内容本发明提供一种设备接入方法、装置、电子设备及存储介质，旨在实现PLC电力线载波系统直接对RS485设备进行控制通信。第一方面，本发明提供一种设备接入方法，包括：接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。一个实施例中，所述基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统，包括：基于所述第一应用协议和所述第一设备类型，确定所述第一设备的第一新RS485地址；将所述第一新RS485地址发送至所述第一设备，以接收所述第一设备基于所述第一新RS485地址返回的第一地址修改完成指令；将所述第一地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第一设备。所述基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统之后，还包括：接收到新的第二设备发送的第二设置地址请求后，确定通过所述第一协议接口是否能识别出第二设备的设备类型；若确定通过所述第一协议接口能识别出所述第二设备的设备类型，则将所述第二设备作为所述第一设备，并执行所述第一设备接入至所述载波系统的过程步骤；其中，所述第二设备为RS485设备。所述确定通过所述第一协议接口是否能识别出第二设备的设备类型之后，还包括：若确定通过所述第一协议接口识别不能识别出所述第二设备的设备类型，则通过第二协议接口识别所述第二设备的第二设备类型；将所述第二设置地址请求发送至所述载波系统，以接收所述载波系统基于所述第二设置地址请求返回的第二应用协议；基于所述第二应用协议和所述第二设备类型，将所述第二设备接入至所述载波系统；其中，所述第二应用协议为PLC通用应用协议。所述基于所述第二应用协议和所述第二设备类型，将所述第二设备接入至所述载波系统，包括：基于所述第二应用协议和所述第二设备类型，确定所述第二设备的第二新RS485地址；将所述第二新RS485地址发送至所述第二设备，以接收所述第二设备基于所述第二新RS485地址返回的第二地址修改完成指令；将所述第二地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第二设备。所述设备接入方法还包括：确定所述第一设备的协议信息以及RS485通讯波特率；所述协议信息包括RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息；根据所述第一设备的RS485通讯波特率、RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息，封装得到所述第一协议接口。所述设备接入方法还包括：接收所述载波系统发送的PLC应用通用协议消息；对所述PLC应用通用协议消息进行解析，得到PLC命令码、RS485设备通信地址和RS485具体消息；基于所述PLC命令码和所述RS485设备通信地址，确定出待控制RS485负载设备；基于所述RS485具体消息控制所述待控制RS485负载设备。第二方面，本发明提供一种设备接入装置，包括：识别模块，用于接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；发送模块，用于将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；设备接入模块，用于基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。第三方面，本发明还提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现第一方面所述设备接入方法。第四方面，本发明还提供一种非暂态计算机可读存储介质，非暂态计算机可读存储介质包括计算机程序，所述计算机程序被所述处理器执行时实现第一方面所述设备接入方法。第五方面，本发明还提供一种计算机程序产品，所述计算机程序产品包括计算机程序，所述计算机程序被所述处理器执行时实现第一方面所述设备接入方法。本发明提供的设备接入方法、装置、电子设备及存储介质，接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出第一设备的第一设备类型；将第一设置地址请求发送至载波系统，以接收载波系统基于第一设置地址请求返回的第一应用协议；基于第一应用协议和第一设备类型，将第一设备接入至载波系统；第一设备为RS485设备，载波系统为PLC电力线载波系统，第一应用协议为PLC通用应用协议。在设备接入的过程中，通过第一协议接口和第一应用协议，实现了将RS485设备接入至了PLC电力线载波系统中，使得需要控制RS485设备时，PLC电力线载波系统能够直接对RS485设备进行控制通信。附图说明为了更清楚地说明本发明的技术方案，下面将对实施例或现有技术描述中所需使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明提供的设备接入方法的流程示意图；图2是本发明提供的载波系统控制RS485设备的示意图；图3是本发明提供的设备接入装置的结构示意图；图4是本发明提供的电子设备的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明实施例提供了设备接入方法的实施例，需要说明的是，虽然在流程图中示出了逻辑顺序，但是在某些数据下，可以以不同于此处的顺序完成所示出或描述的步骤。参照图1，图1是本发明提供的设备接入方法的流程示意图。本发明实施例提供的设备接入方法包括：步骤101，接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；步骤102，将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；步骤103，基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统。本发明实施例以设备接入装置作为执行主体为例。需要说明的是，本发明实施例中的第一设备为RS485设备，载波系统为PLC电力线载波系统，第一应用协议为PLC通用应用协议。需要说明的是，设备接入装置的其中一种表现形式可为PLC转RS485转换器。在PLC转RS485转换器中有预先已经封装好的协议接口和RS485设备的收发程序，RS485设备可以理解为RS485负载设备，如RS485窗帘电机、RS485智能空开、RS485空调控制器等。需要说明的是，根据各种类型的RS485设备配置地址触发流程，通过PLC转RS485转换器统一管理并配置其下连接的各RS485设备地址，避免RS485总线数据冲突情况。在本发明一实施例中，为了防止恶意修改RS485设备地址，从而导致RS485总线数据冲突情况，大部分RS485设备都会有一套其指定的配置地址触发流程，如RS485窗帘电机在发送配置RS485地址前，需要长按5秒电机设置键。RS485智能空开在发送配置RS485地址前，需要把设置拨码拨到手动挡。因此，RS485设备触发配置地址流程后，将设置地址请求发送至PLC转RS485转换器，即可以理解为，第一RS485设备触发配置地址流程后，将第一设置地址请求发送至PLC转RS485转换器。进一步地，PLC转RS485转换器接收到第一RS485设备发送的第一设置地址请求后，通过第一协议接口识别出第一RS485设备的第一设备类型，即确定第一RS485设备是什么类型的负载设备。进一步地，PLC转RS485转换器将第一设置地址请求发送至PLC电力线载波系统，需要说明的是，PLC电力线载波系统中至少包括转换器网关，一个转换器网关可以接入多个PLC转RS485转换器，因此可以理解为，PLC转RS485转换器实际是与PLC电力线载波系统的转换器网关连接通信。进一步地，PLC电力线载波系统接收到第一设置地址请求后，根据第一设置地址请求确定出第一PLC通用应用协议，并将第一PLC通用应用协议返回至PLC转RS485转换器。因此，PLC转RS485转换器将第一设置地址请求发送至PLC电力线载波系统后，会接收到PLC电力线载波系统返回的第一PLC通用应用协议。需要说明的是，在PLC电力线载波系统中，需要预先制定出一套PLC应用通用协议，PLC通用应用协议的协议帧格式为帧头+标记1、标记2、标记3、标记4+PLC转RS485转换器地址+消息序号+消息长度+PLC命令码+RS485设备通信地址+RS485命令码+具体消息+校验码，并制定出RS485命令码与各协议接口的映射关系，以及RS485命令码对应的具体消息内容，在PLC转RS485转换器芯片里编写PLC通用应用协议与协议接口转换程序。在本发明一实施例中，PLC转RS485转换器的地址为123456，PLC命令码为控制RS485设备0x210508，RS485设备通信地址配置、开关停、开关方向、位置百分比、行程设置接口具体对应的RS485命令码分别为0x2300、0x2301、0x2302、0x2303、0x2304，RS485命令码0x2301对应的具体消息为0为关，1为开，2为停。进一步地，PLC转RS485转换器根据第一PLC通用应用协议和第一设备类型，将第一RS485设备接入至PLC电力线载波系统。本发明实施例提供的设备接入方法，接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出第一设备的第一设备类型；将第一设置地址请求发送至载波系统，以接收载波系统基于第一设置地址请求返回的第一应用协议；基于第一应用协议和第一设备类型，将第一设备接入至载波系统；第一设备为RS485设备，载波系统为PLC电力线载波系统，第一应用协议为PLC通用应用协议。在设备接入的过程中，通过第一协议接口和第一应用协议，实现了将RS485设备接入至载波系统中，使得需要控制RS485设备时，PLC电力线载波系统能够直接对RS485设备进行控制通信。进一步地，步骤103记载的基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统，包括：基于所述第一应用协议和所述第一设备类型，确定所述第一设备的第一新RS485地址；将所述第一新RS485地址发送至所述第一设备，以接收所述第一设备基于所述第一新RS485地址返回的第一地址修改完成指令；将所述第一地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第一设备。具体地，PLC转RS485转换器根据第一PLC通用应用协议和第一设备类型，确定第一RS485设备的第一新RS485地址，即为第一RS485设备配置一个新RS485地址。在一实施例中，第一设备类型为窗帘电机类型，即第一RS485设备为RS485窗帘电机，因此，PLC转RS485转换器根据第一PLC通用应用协议和窗帘电机类型，为RS485窗帘电机分配第一新RS485地址为0x02。进一步地，PLC转RS485转换器通过第一协议接口将第一新RS485地址发送至第一RS485设备。第一RS485设备接收到第一新RS485地址后，将RS485地址修改为第一新RS485地址，并将第一地址修改完成指令返回至PLC转RS485转换器。进一步地，PLC转RS485转换器接收到第一RS485设备返回的第一地址修改完成指令后，将第一地址修改完成指令发送至PLC电力线载波系统。PLC电力线载波系统接收到PLC转RS485转换器发送的第一地址修改完成指令后，将第一RS485设备注册至PLC电力线载波系统中，完成第一RS485设备接入至PLC电力线载波系统。在一实施例中，本实施例以第一RS485设备为RS485窗帘电机接入至PLC电力线载波系统为例说明，PLC转RS485转换器的地址为123456，即PLC转RS485转换器123456。具体的：RS485窗帘电机上电并连接485线到PLC转RS485转换器，PLC转RS485转换器接入到PLC电力线载波系统中，等待PLC转RS485转换器入网。PLC转RS485转换器入网成功后，入网指示灯常亮，此时需要启动RS485窗帘电机地址配置机制，即RS485窗帘电机长按5秒电机设置键，并向PLC转RS485转换器上报RS485设备的设置地址请求。PLC转RS485转换器接收到设置地址请求后，通过协议接口识别出第一RS485设备为RS485窗帘电机，并将设置地址请求发送至PLC电力线载波系统。PLC电力线载波系统根据设置地址请求返回PLC通用应用协议，用于设置RS485设备的地址。PLC转RS485转换器接收到PLC通用应用协议后，为RS485窗帘电机分配新RS485地址0x02，并向RS485窗帘电机发送地址设置信息。RS485窗帘电机接收到地址设置信息后，将地址修改为0x02，并将地址修改完成指令返回至PLC转RS485转换器。PLC转RS485转换器将地址修改完成指令发送至PLC电力线载波系统，PLC电力线载波系统将RS485窗帘电机注册至PLC电力线载波系统中，因此完成RS485窗帘电机接入至PLC电力线载波系统。需要说明的是，RS485窗帘电机地址由PLC电力线载波系统自动分配，从0x02开始累加，已被使用则累加跳过，满246时重投开始遍历。在另一实施例中，本实施例以第一RS485设备为RS485智能空开接入至PLC电力线载波系统为例说明，PLC转RS485转换器的地址为123456，即PLC转RS485转换器123456。具体的：RS485智能空开上电并连接485线到PLC转RS485转换器，PLC转RS485转换器接入到PLC电力线载波系统中，等待PLC转RS485转换器入网。PLC转RS485转换器入网成功后，入网指示灯常亮，此时需要启动RS485智能空开地址配置机制，即RS485智能空开把设置拨码拨到手动挡，并向PLC转RS485转换器上报RS485设备的设置地址请求。PLC转RS485转换器接收到设置地址请求后，通过协议接口识别出第二RS485设备为RS485智能空开，并将设置地址请求发送至PLC电力线载波系统。PLC电力线载波系统根据设置地址请求返回PLC通用应用协议，用于设置RS485设备的地址。PLC转RS485转换器接收到PLC通用应用协议后，为RS485智能空开分配新RS485地址0x03，并向RS485智能空开发送地址设置信息。RS485智能空开接收到地址设置信息后，将地址修改为0x03，并将地址修改完成指令返回至PLC转RS485转换器。PLC转RS485转换器将地址修改完成指令发送至PLC电力线载波系统，PLC电力线载波系统将RS485智能空开注册至PLC电力线载波系统中，因此完成RS485智能空开接入至PLC电力线载波系统。本发明实施例通过第一协议接口和第一应用协议，实现了将第一RS485设备接入至载波系统中，使得需要控制第一RS485设备时，PLC电力线载波系统能够直接对第一RS485设备进行控制通信。进一步地，步骤103记载的基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统之后，还包括：接收到新的第二设备发送的第二设置地址请求后，确定通过所述第一协议接口是否能识别出第二设备的设备类型；若确定通过所述第一协议接口能识别出所述第二设备的设备类型，则将所述第二设备作为所述第一设备，并执行所述第一设备接入至所述载波系统的过程步骤；若确定通过所述第一协议接口识别不能识别出所述第二设备的设备类型，则通过第二协议接口识别所述第二设备的第二设备类型；将所述第二设置地址请求发送至所述载波系统，以接收所述载波系统基于所述第二设置地址请求返回的第二应用协议；基于所述第二应用协议和所述第二设备类型，将所述第二设备接入至所述载波系统。具体地，PLC转RS485转换器接收到新的第二RS485设备发送的第二设置地址请求后，确定通过第一协议接口是否能识别出第二RS485设备的设备类型。若确定通过第一协议接口能识别出第二RS485设备的设备类型，PLC转RS485转换器则确定第二RS485设备的设备类型与第一设备类型相同，并对第二RS485设备执行接入PLC电力线载波系统的过程步骤，第二RS485设备执行接入PLC电力线载波系统的过程步骤，与第一RS485设备接入PLC电力线载波系统的过程步骤相同，在此不再赘述。进一步地，若确定通过第一协议接口识别不能识别出第二RS485设备的设备类型，PLC转RS485转换器则通过第二协议接口识别出第二RS485设备的第二设备类型。进一步地，PLC转RS485转换器将第二设置地址请求发送至PLC电力线载波系统。PLC电力线载波系统接收到第二设置地址请求后，返回第二PLC通用应用协议。进一步地，PLC转RS485转换器根据第二PLC通用应用协议和第二设备类型，将第二RS485设备接入至PLC电力线载波系统。进一步可以理解为：已经将RS485窗帘电机接入至了PLC电力线载波系统，从上述整体机制可得如果需要再接入多一台RS485窗帘电机，则可接入到PLC转RS485转换器，并通过RS485窗帘电机的接入步骤分配设置新接入的RS485窗帘电机的RS485地址。如果需要接入其他类型的RS485负载设备，则只需要在PLC转RS485转换器中增加新协议接口，为新接入的其他类型的RS485负载设备分配设置RS485地址，大大的提高了各类型RS485设备接入到PLC电力线载波系统的效率。进一步地，基于所述第二应用协议和所述第二设备类型，将所述第二设备接入至所述载波系统，包括：基于所述第二应用协议和所述第二设备类型，确定所述第二设备的第二新RS485地址；将所述第二新RS485地址发送至所述第二设备，以接收所述第二设备基于所述第二新RS485地址返回的第二地址修改完成指令；将所述第二地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第二设备。具体地，PLC转RS485转换器根据第二PLC通用应用协议和第二设备类型，确定第二RS485设备的第二新RS485地址，即为第二RS485设备配置一个新RS485地址。进一步地，PLC转RS485转换器第二协议接口将第二新RS485地址发送至第二RS485设备。第二RS485设备接收到第二新RS485地址后，将RS485地址修改为第二新RS485地址，并将第二地址修改完成指令返回至PLC转RS485转换器。进一步地，PLC转RS485转换器接收到第二RS485设备返回的第二地址修改完成指令后，将第二地址修改完成指令发送至PLC电力线载波系统。PLC电力线载波系统接收到PLC转RS485转换器发送的第二地址修改完成指令后，将第二RS485设备注册至PLC电力线载波系统中，完成第二RS485设备接入至PLC电力线载波系统。本发明实施例通过第二协议接口和第二应用协议，实现了将第二RS485设备接入至载波系统中，使得需要控制第二RS485设备时，PLC电力线载波系统能够直接对第二RS485设备进行控制通信。进一步地，执行将RS485设备接入至载波系统之前，需要在PLC转RS485转换器中封装每一个RS485设备的协议接口，具体如下：确定所述第一设备的协议信息以及RS485通讯波特率；所述协议信息包括RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息；根据所述第一设备的RS485通讯波特率、RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息，封装得到所述第一协议接口。本发明实施例中的的协议接口是PLC转RS485转换器中的一个软件程序，是由软件开发人员针对第三方RS485设备的专用协议来实现的，比如，RS485窗帘电机打开的专用协议为55 00 02 03 01 48 FC，软件开发人员则需要完成一个窗帘打开的接口，这个接口实际就是向RS485窗帘电机发送55 00 02 03 01 48 FC，以此类推，需要完成所有用到的第三方RS485设备功能所对应的软件接口。具体地，确定RS485设备具体用到的协议及RS485通讯波特率等参数，协议信息包括RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息，在PLC转RS485转换器芯片里编写RS485收发程序，封装好需要用的的协议接口。在一实施例中，RS485窗帘电机具体用到的RS485设备协议有但不限制于窗帘电机RS485地址配置信息、开关停信息、开关方向信息、位置百分比信息和行程设置信息。进一步地，根据每一个RS485设备的RS485通讯波特率、RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息，封装得到每一个RS485设备的协议接口。由于RS485是半双工通信方式，因此RS485收发程序除了基本的收发功能以外还包括发送超时重发功能，本发明实施例为了确保通信成功率及加大对接各类型的RS485设备兼容性，超时重发机制设置成可配，默认是超时时间为200ms，重发次数为3次。此步骤完成后，则可单独通过PLC转RS485转换器对RS485设备进行控制。本发明实施例根据RS485设备具体用到的协议及RS485通讯波特率等参数，封装每一个RS485设备的协议接口，为PLC电力线载波系统能够直接对RS485设备进行控制通信提供了保障。进一步地，在将RS485设备接入至载波系统后，需要接收载波系统发送的PLC应用通用协议消息，根据PLC应用通用协议消息控制所需要控制的RS485负载设备，具体为：接收所述载波系统发送的PLC应用通用协议消息；对所述PLC应用通用协议消息进行解析，得到PLC命令码、RS485设备通信地址和RS485具体消息；基于所述PLC命令码和所述RS485设备通信地址，确定出待控制RS485负载设备；基于所述RS485具体消息控制所述待控制RS485负载设备。具体地，RS485设备连接后接入到PLC电力线载波系统的电力线中，等待PLC转RS485转换器入网成功后，PLC电力线载波系统即可通过PLC应用通用协议控制具体的RS485负载设备。因此，PLC电力线载波系统需要对RS485负载设备控制时，需要向PLC转RS485转换器发送PLC应用通用协议消息。因此，PLC转RS485转换器接收PLC电力线载波系统发送的PLC应用通用协议消息。进一步地，PLC转RS485转换器对PLC应用通用协议消息进行解析，得到PLC应用通用协议消息中的PLC命令码、RS485设备地址和RS485具体消息。进一步地，PLC转RS485转换器根据PLC命令码和RS485设备地址，确定出所要控制的待控制RS485负载设备。最后，PLC转RS485转换器根据RS485具体消息控制待控制RS485负载设备，即根据RS485具体消息中开关停信息控制待控制RS485负载设备。参照图2，图2是本发明提供的载波系统控制RS485设备的示意图。PLC电力线载波系统需要控制地址为123456的PLC转RS485转换器下RS485地址为0x01的窗帘电机开，则可发送一条PLC应用通用协议消息为：PLC转RS485转换器地址为123456、PLC命令码为控制RS485设备0x210508、RS485地址为0x01、具体消息为0x01。本发明实施例PLC电力线载波系统通过PLC应用通用协议消息直接控制RS485设备，实现了PLC电力线载波系统能够直接对RS485设备进行控制通信。进一步地，本发明提供的设备接入装置与本发明提供的设备接入方法互对应参照。图3所示，图3是本发明提供的设备接入装置的结构示意图，设备接入装置包括：识别模块301，用于识别模块，用于接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；发送模块302，用于将第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；设备接入模块303，用于基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。进一步地，设备接入模块303还用于：基于所述第一应用协议和所述第一设备类型，确定所述第一设备的第一新RS485地址；将所述第一新RS485地址发送至所述第一设备，以接收所述第一设备基于所述第一新RS485地址返回的第一地址修改完成指令；将所述第一地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第一设备。进一步地，设备接入模块303还用于：接收到新的第二设备发送的第二设置地址请求后，确定通过所述第一协议接口是否能识别出第二设备的设备类型；若确定通过所述第一协议接口能识别出所述第二设备的设备类型，则将所述第二设备作为所述第一设备，并执行所述第一设备接入至所述载波系统的过程步骤；其中，所述第二设备为RS485设备。进一步地，设备接入模块303还用于：若确定通过所述第一协议接口识别不能识别出所述第二设备的设备类型，则通过第二协议接口识别所述第二设备的第二设备类型；将所述第二设置地址请求发送至所述载波系统，以接收所述载波系统基于所述第二设置地址请求返回的第二应用协议；基于所述第二应用协议和所述第二设备类型，将所述第二设备接入至所述载波系统；其中，所述第二应用协议为PLC通用应用协议。进一步地，设备接入模块303还用于：基于所述第二应用协议和所述第二设备类型，确定所述第二设备的第二新RS485地址；将所述第二新RS485地址发送至所述第二设备，以接收所述第二设备基于所述第二新RS485地址返回的第二地址修改完成指令；将所述第二地址修改完成指令发送至所述载波系统，以供所述载波系统接入所述第二设备。进一步地，设备接入装置还包括封装模块，用于：确定所述第一设备的协议信息以及RS485通讯波特率；所述协议信息包括RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息；根据所述第一设备的RS485通讯波特率、RS485地址配置信息、控制运行信息、运行方向信息、位置百分比信息和行程设置信息，封装得到所述第一协议接口。进一步地，设备接入装置还包括控制模块，用于：接收所述载波系统发送的PLC应用通用协议消息；对所述PLC应用通用协议消息进行解析，得到PLC命令码、RS485设备通信地址和RS485具体消息；基于所述PLC命令码和所述RS485设备通信地址，确定出待控制RS485负载设备；基于所述RS485具体消息控制所述待控制RS485负载设备。本发明提供的设备接入装置的具体实施例与设备接入方法各实施例基本相同，在此不作赘述。图4示例了一种电子设备的实体结构示意图，如图4所示，电子设备可以包括：处理器410、通信接口420、存储器430和通信总线440，其中，处理器410，通信接口420，存储器430通过通信总线440完成相互间的通信。处理器410可以调用存储器430中的逻辑指令，以执行设备接入方法，该方法包括：接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。此外，上述的存储器430中的逻辑指令可以通过软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。另一方面，本发明还提供一种计算机程序产品，计算机程序产品包括存储在非暂态计算机可读存储介质上的计算机程序，计算机程序包括程序指令，当程序指令被计算机执行时，计算机能够执行上述各方法所提供的设备接入方法，该方法包括：接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。又一方面，本发明还提供一种非暂态计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现以执行上述各提供的设备接入方法，该方法包括：接收到第一设备发送的第一设置地址请求后，通过第一协议接口识别出所述第一设备的第一设备类型；将所述第一设置地址请求发送至载波系统，以接收所述载波系统基于所述第一设置地址请求返回的第一应用协议；基于所述第一应用协议和所述第一设备类型，将所述第一设备接入至所述载波系统；其中，所述第一设备为RS485设备，所述载波系统为PLC电力线载波系统，所述第一应用协议为PLC通用应用协议。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到各实施方式可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在计算机可读存储介质中，如ROM/RAM、磁碟、光盘等，包括若干指令用以使得一台计算机设备执行各个实施例或者实施例的某些部分所述的方法。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
