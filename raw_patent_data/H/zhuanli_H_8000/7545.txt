标题title
一种检测白盒密码的方法
摘要abst
本发明提供一种检测白盒密码的方法，包括比较白盒密码计算得出的计算结果和预期结果，输出相应的正确性检验结果；比较经白盒密码计算得出的性能实测值和性能要求值，输出相应的性能检测结果；比较白盒密码密钥变更的时长要求值与变更密钥后的时长实测值，输出相应的密钥变更时长检测结果；比较经计算得出白盒密码的多样性实测值与多样性要求值，输出相应的多样性检测结果；采集密钥泄露的实时值，比较实时值与泄露的界限值，输出相应的安全性检测结果，本发明的检测方法对白盒密码形成相应的检测，解决了当前密钥针对白盒密码的正确性、多样性、安全性、性能以及密钥变更时长检测方法的问题，使得白盒密码算法正确、有效地发挥密码算法的作用。
权利要求书clms
1.一种检测白盒密码的方法，其特征在于，包括：比较经白盒密码计算得出的计算结果和预期结果，并输出相应的正确性检验结果；比较经白盒密码计算得出的性能实测值和性能要求值，并输出相应的性能检测结果；比较白盒密码密钥变更的时长要求值与变更密钥后的时长实测值，并输出相应的密钥变更时长检测结果；比较经计算得出白盒密码的多样性实测值与多样性要求值，并输出相应的多样性检测结果；采集密钥泄露的实时值，比较实时值与泄露的界限值，并输出相应的安全性检测结果。2.根据权利要求1所述的一种检测白盒密码的方法，其特征在于，所述比较经白盒密码计算得出的计算结果和预期结果，并输出相应的正确性检验结果包括：设定多组样本数据；利用白盒密码对同一样本数据进行多次密码计算，和/或利用白盒密码对多组样本数据进行密码计算；对比计算得到的计算结果和预期结果，依据对比结果输出相应的正确性检验结果。3.根据权利要求2所述的一种检测白盒密码的方法，其特征在于，所述比较经白盒密码计算得出的计算结果和预期结果，并输出相应的正确性检验结果还包括至少变更一次白盒密码的密钥。4.根据权利要求1所述的一种检测白盒密码的方法，其特征在于，所述比较经白盒密码计算得出的性能实测值和性能要求值，并输出相应的性能检测结果包括：设定性能要求值和明文数据；利用白盒密码对设定的明文数据进行多次密码计算，并记录对应的计算时长；根据明文数据的数量、密码计算次数和计算时长求得性能实测值；对比求得的性能实测值和性能要求值，依据对比结果输出相应的性能检测结果。5.根据权利要求1-4任意一项所述的一种检测白盒密码的方法，其特征在于，所述密码计算包括解密计算和/或加密计算。6.根据权利要求1所述的一种检测白盒密码的方法，其特征在于，所述比较白盒密码密钥变更的时长要求值与变更密钥后的时长实测值，并输出相应的密钥变更时长检测结果包括：设定变更白盒密码密钥的时长要求值；更改白盒密码的密钥并重新生成新的密钥，得出新的密钥生成的时长实测值；对比时长要求值和时长要求值，依据对比结果输出相应的密钥变更时长检测结果。7.根据权利要求1所述的一种检测白盒密码的方法，其特征在于，所述比较经计算得出白盒密码的多样性实测值与多样性要求值，并输出相应的多样性检测结果包括：设定白盒密码的多样性要求值；确定白盒密码查找表的数量；确定每个查找表的输入个数；根据查找表的数量以及每个查找表的输入个数计算得出白盒密码的多样性实测值；对比多样性实测值和多样性要求值，并输出相应的多样性检测结果。8.根据权利要求1所述的一种检测白盒密码的方法，其特征在于，所述采集密钥泄露的实时值，比较实时值与泄露的界限值，并输出相应的安全性检测结果包括：设定不同数据量的样本数据和密钥泄露的界限值；利用白盒密码对样本数据逐一进行计算；采集计算过程中的泄露信息；对采集的泄露信息进行差分分析，得出分析结果；对分析结果进行明文、密钥和密文验证，得出密钥泄露的实时值；对比密钥的实时值与设定的密钥泄露的界限值，并输出相应的安全性检测结果。
说明书desc
技术领域本发明涉及信息安全技术领域，尤其涉及一种检测白盒密码的方法。背景技术白盒密码是目前新型的密码技术，白盒密码致力于构造密码学算法的软件实现，探索在现实世界中部署的软件中隐藏密钥的方法，并使得该实现能够为抵抗白盒攻击提供足够的安全水平。在大部分的情况下，白盒密码提供的安全水平是以保护秘密密钥为主要目标的，也有其他一些情况下白盒密码会以其他信息作为保护目标，白盒密码具有传统密码算法所没有的优势：它能够使得密码算法的程序在不可信任的终端安全地运行，抵抗白盒攻击者的攻击，最大限度地保护机密信息。此外，白盒密码使用软件实现的方式来对机密信息进行保护，与使用硬件的方式相比，具有容易扩展、使用便捷、传输方便等优点。但是，目前尚无针对白盒密码模块的安全检测方法，因而白盒密码的特性是否符合要求无从得知，使得白盒密码无法更加准确地发挥作用。因此，有必要提供一种检测白盒密码的方法解决上述技术问题。发明内容为解决上述技术问题，本发明提供一种检测白盒密码的方法用于解决当前密钥针对白盒密码的正确性、多样性、安全性、性能以及密钥变更时长检测方法的问题。本发明提供的一种检测白盒密码的方法，包括：比较经白盒密码计算得出的计算结果和预期结果，并输出相应的正确性检验结果；比较经白盒密码计算得出的性能实测值和性能要求值，并输出相应的性能检测结果；比较白盒密码密钥变更的时长要求值与变更密钥后的时长实测值，并输出相应的密钥变更时长检测结果；比较经计算得出白盒密码的多样性实测值与多样性要求值，并输出相应的多样性检测结果；采集密钥泄露的实时值，比较实时值与泄露的界限值，并输出相应的安全性检测结果。优选的，所述比较经白盒密码计算得出的计算结果和预期结果，并输出相应的正确性检验结果包括：设定多组样本数据；利用白盒密码对同一样本数据进行多次密码计算，和/或利用白盒密码对多组样本数据进行密码计算；对比计算得到的计算结果和预期结果，依据对比结果输出相应的正确性检验结果。优选的，所述比较经白盒密码计算得出的计算结果和预期结果，并输出相应的正确性检验结果还包括至少变更一次白盒密码的密钥。优选的，所述比较经白盒密码计算得出的性能实测值和性能要求值，并输出相应的性能检测结果包括：设定性能要求值和明文数据；利用白盒密码对设定的明文数据进行多次密码计算，并记录对应的计算时长；根据明文数据的数量、密码计算次数和计算时长求得性能实测值；对比求得的性能实测值和性能要求值，依据对比结果输出相应的性能检测结果。优选的，所述密码计算包括解密计算和/或加密计算。优选的，所述比较白盒密码密钥变更的时长要求值与变更密钥后的时长实测值，并输出相应的密钥变更时长检测结果包括：设定变更白盒密码密钥的时长要求值；更改白盒密码的密钥并重新生成新的密钥，得出新的密钥生成的时长实测值；对比时长要求值和时长要求值，依据对比结果输出相应的密钥变更时长检测结果。优选的，所述比较经计算得出白盒密码的多样性实测值与多样性要求值，并输出相应的多样性检测结果包括：设定白盒密码的多样性要求值；确定白盒密码查找表的数量；确定每个查找表的输入个数；根据查找表的数量以及每个查找表的输入个数计算得出白盒密码的多样性实测值；对比多样性实测值和多样性要求值，并输出相应的多样性检测结果。优选的，所述采集密钥泄露的实时值，比较实时值与泄露的界限值，并输出相应的安全性检测结果包括：设定不同数据量的样本数据和密钥泄露的界限值；利用白盒密码对样本数据逐一进行计算；采集计算过程中的泄露信息；对采集的泄露信息进行差分分析，得出分析结果；对分析结果进行明文、密钥和密文验证，得出密钥泄露的实时值；对比密钥的实时值与设定的密钥泄露的界限值，并输出相应的安全性检测结果。与相关技术相比较，本发明提供的一种检测白盒密码的方法具有如下有益效果：本发明的检测方法对白盒密码形成相应的检测路径，实现对白盒密码的正确性、安全性、多样性、密钥变更时长以及性能的检测，解决了当前密钥针对白盒密码的正确性、多样性、安全性、性能以及密钥变更时长检测方法的问题，继而使得白盒密码算法正确、有效地发挥密码算法的作用。附图说明图1为本发明提供的一种检测白盒密码的方法的流程示意图；图2为本发明提供的一种检测白盒密码的方法的正确性检测流程示意图；图3为本发明提供的一种检测白盒密码的方法的性能检测流程示意图；图4为本发明提供的一种检测白盒密码的方法的密钥变更时长检测示意图；图5为本发明提供的一种检测白盒密码的方法的多样性检测流程示意图；图6为本发明提供的一种检测白盒密码的方法的安全性检测流程示意图。具体实施方式下面结合附图和实施方式对本发明做进一步说明。一种检测白盒密码的方法，如图1所示，包括：S100：比较经白盒密码计算得出的计算结果和预期结果，并输出相应的正确性检验结果；具体如图2所示，包括如下步骤：S101：设定多组样本数据；S102：利用白盒密码对同一样本数据进行多次密码计算，和/或利用白盒密码对多组样本数据进行密码计算；更为具体的，白盒密码计算可以是采用白盒密码多次对同一样本数据进行加密和/或解密计算，记录每次计算结果；还可以是采用白盒密码对多组样本数据进行加密和/或解密计算，记录每次计算结果；S103：对比计算得到的计算结果和预期结果，依据对比结果输出相应的正确性检验结果，例如：对比结果不一致，输出检测错误，代表该白盒密码的正确性不符合要求；此外，还需要变更白盒密码的密钥，并重新按照上述方式进行计算，得出白盒密码的正确性检测结果，且白盒密码的密钥变更次数至少为一次。在具体实施时，首先设定白盒密码算法计算的组数N，设置样本数据集，包括加密运算的样本和解密数据样本，每个样本包括密钥、IV、明文、密文等计算所需参数。然后将样本数据分别代入白盒密码，并运行白盒密码进行加密和/或解密，得到经过白盒密码加密运算后的密文和/或解密运算后的明文，将运算得到的数据和样本数据集中的数据进行逐一比对，若相等，则测试通过，否则测试不通过。设定将同一组数据进行重复输入的次数为M，将M次的输出进行对比测试，如果M次的输出不相等，则测试不通过，否则测试通过。S200：比较经白盒密码计算得出的性能实测值和性能要求值，并输出相应的性能检测结果；具体如图3所示，包括如下步骤：S201：设定性能要求值和明文数据；S202：利用白盒密码对设定的明文数据进行多次密码计算，并记录对应的计算时长；更为具体的：将设定的明文数据输入白盒密码并执行一定次数的加密和/或解密计算，逐一记录计算时长；S203：根据明文数据的数量、密码计算次数和计算时长求得性能实测值；其中，性能实测值由在单位时间内的计算数据量进行表示；S204：对比求得的性能实测值和性能要求值，依据对比结果输出相应的性能检测结果；如果性能实测值不在性能要求值的范围内，则输出警告，代表该白盒密码不符合性能要求。在具体实施时，设置大于等于64byte数据量的待加密和/或解密数据作为性能测试的明文数据，记为X。将明文数据代入白盒密码，并运行白盒密码进行加密和/或解密，循环操作该Y次。统计操作Y次的运行时间T，如果T≤于0，则报警，代表性能不符合要求。性能指标计算方法：S＝8*X*Y*/T，单位为Mbps。S300：比较白盒密码密钥变更的时长要求值与变更密钥后的时长实测值，并输出相应的密钥变更时长检测结果；具体如图4所示，包括如下步骤：S301：设定变更白盒密码密钥的时长要求值；S302：更改白盒密码的密钥并重新生成新的密钥，得出新的密钥生成的时长实测值；S303：对比时长要求值和时长要求值，依据对比结果输出相应的密钥变更时长检测结果。在具体实施时，收集被检对象采用的密钥管理机制以及密钥类型，确定白盒密码相对的根密钥；根据最底层的密钥要求，设置符合要求的样本密钥；用样本密钥对相对的根密钥进行更新，记录更新结束时长；将记录的时长实测值与时长要求值进行对比，判断时长实测值是否符合要求。S400：比较经计算得出白盒密码的多样性实测值与多样性要求值，并输出相应的多样性检测结果；具体如图5所示，包括如下步骤：S401：设定白盒密码的多样性要求值；S402：确定白盒密码查找表的数量；S403：确定每个查找表的输入个数；S404：根据查找表的数量以及每个查找表的输入个数计算得出白盒密码的多样性实测值；S405：对比多样性实测值和多样性要求值，并输出相应的多样性检测结果。在具体实施时，收集白盒密码的设计原理，确定查找表类型，设定类型种数N种，每种类型是相互独立的。计算每种类型的可能选择输入的个数，假设根据白盒密码设计原理计算出第i种类型的查找表的选择输入的可能性为Mi种；计算得出整体白盒软件的多样性多样性至少高于232，若低于232，则检测不通过。S500：采集密钥泄露的实时值，比较实时值与泄露的界限值，并输出相应的安全性检测结果；具体如图6所示，包括如下步骤：S501：设定不同数据量的样本数据和密钥泄露的界限值；S502：利用白盒密码对样本数据逐一进行计算；S503：采集计算过程中的泄露信息；S504：对采集的泄露信息进行差分分析，得出分析结果；S505：对分析结果进行明文、密钥和密文验证，得出密钥泄露的实时值；S506：对比密钥的实时值与设定的密钥泄露的界限值，并输出相应的安全性检测结果。在具体实施时：首先分析白盒密码在运行过程中会泄露的信息，包括访问的地址或者频繁使用的数据、Cache命中率等；运行至少一次白盒密码，采集运行过程中泄露的信息数据，提取这些数据对白盒密码运行影响最大的数据所对应的特征；输入N组随机明文Mi，并进行运算，采集泄露的数据，提取数据对应的特征，使用特征数据组成并形成计算轨迹，记录每组密文值Ci；选取密钥ki的搜索空间Ω以及白盒密码算法的中包含密钥的计算函数f，计算y＝f；将计算轨迹结果y分为两个不同的集合，如y的最低为0即归为集合A，y的最低为1归为集合B。计算两个集合的均值，然后做差取绝对值，记录绝对值大于等于设定值时对应的密钥猜测值。将明文Mi和记录绝对值最大的猜测密钥进行计算得到密文Ci'，比较Ci'和Ci，若一致，输出不安全。如果Ci'和Ci不一致，则依次将猜测密钥与Mi进行计算，将结算得到的密文与Ci对比。如果出现一致的情况，则输出不安全。在本发明的描述中，需要说明的是，术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。以上所述仅为本发明的实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所做的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
