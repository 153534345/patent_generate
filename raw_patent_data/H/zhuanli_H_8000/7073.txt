标题title
分段线性数字预失真模型的参数更新方法及预失真系统
摘要abst
本发明公开了分段线性数字预失真模型的参数更新方法，包括：获取基带信号，基于所述基带信号和功率放大器特性，对分段线性数字预失真模型的分段区间和分段区间参数进行初始化；基于初始化确定的分段区间和分段区间参数，采用R2参数判别方法，判断各分段区间是否满足预设条件，若满足，则不进行区间拆分，否则，对该分段区间进行区间拆分，直至拆分后的分段区间满足预设条件，得到新的分段区间；对所述新的分段区间进行线性拟合，得到新的分段区间参数；以及，预失真系统。本发明具有能自动调整分段线性预失真模型的分段区间和分段区间参数等优点。
权利要求书clms
1.分段线性数字预失真模型的参数更新方法，其特征在于，包括：获取基带信号，基于所述基带信号/＞和功率放大器特性，对分段线性数字预失真模型的分段区间和分段区间参数进行初始化；基于初始化确定的分段区间和分段区间参数，采用R2参数判别方法，判断各分段区间是否满足预设条件，若满足，则不进行区间拆分，否则，对该分段区间进行区间拆分，直至拆分后的分段区间满足预设条件，得到新的分段区间；对所述新的分段区间进行线性拟合，得到新的分段区间参数。2.如权利要求1所述的分段线性数字预失真模型的参数更新方法，其特征在于，所述对分段线性数字预失真模型的分段区间和分段区间参数进行初始化，包括：根据功率放大器特性，确定所述分段线性数字预失真模型的分段数和幅度区间；依据所述基带信号，设定所述分段线性数字预失真模型为：式中，，/＞，/＞为功率放大器第m段分段区间的增益；/＞为一个初始化的数值； /＞ ；/＞、/＞到/＞为根据功率放大器特性得到的参数；根据功率放大器特性，对所述分段线性数字预失真模型进行初始化，得到所述初始化确定的分段区间和分段区间参数a1m、a0m。3.如权利要求2所述的分段线性数字预失真模型的参数更新方法，其特征在于，所述、/＞到/＞按照如下方法得到：1）在幅度区间的范围内，取N个幅度点，第n个幅度为，/＞；2）将所述第n个幅度输入功率放大器，获取功率放大器的输出Cn；3）从n=2开始，到n=N为止，执行下述操作：若Cn-2Cn-1+Cn-2≤e，e为预设阈值，则n，n-1，n-2为一个幅度区间，否则，n，n-1，n-2为不同的幅度区间，且n-1为区间的边界，记录n-1的数值，并将其作为分界点的序号， /＞， /＞，由此得到/＞到/＞；4）通过最小二乘拟合法，得到功率放大器各分段区间的增益。4.如权利要求2所述的分段线性数字预失真模型的参数更新方法，其特征在于，所述预设条件为：，式中，/＞为数字预失真器输出的信号/＞依次经过数模转换器、调制器、功率放大器、解调器和模数转换器后的反馈信号，，/＞为各分段区间的精度控制参数。5.如权利要求2所述的分段线性数字预失真模型的参数更新方法，其特征在于，所述区间拆分包括：若第m段分段区间不满足所述预设条件，则将第m段分段区间拆分为两段分段区间和/＞，对这两段分段区间分别进行线性拟合，如果满足所述预设条件，则停止区间拆分，否则，继续进行区间拆分，直至拆分后的分段区间满足所述预设条件；其中，/＞， /＞。6.如权利要求2所述的分段线性数字预失真模型的参数更新方法，其特征在于，所述对所述新的分段区间进行线性拟合，得到新的分段区间参数，包括：根据所述新的分段区间的分段数M1，设定所述分段线性数字预失真模型为：式中， ；顺序采样一段包含J个采样点，且幅度取值在区间的基带信号 ，/＞，采用初始化确定的分段区间参数a1m和a0m，以min|Gm1Y-z1|2作为优化目标，得到模型新的分段区间参数/＞、/＞，其中，/＞为功率放大器第/＞段分段区间的增益；z1为信号Y依次数模转换器、调制器、功率放大器，再经过解调器和模数转换器后的反馈信号，Y为输入的基带信号x经过所述分段线性预失真模型之后的输出，Y=Bm XT， Bm=，XT为X的转置，X=。7.如权利要求6所述的分段线性数字预失真模型的参数更新方法，其特征在于，所述对所述新的分段区间进行线性拟合，得到新的分段区间参数，还包括：判断所述新的分段区间中相邻分段区间的斜率是否满足，/＞斜率的精度控制参数，若是，则将该相邻分段区间合并，在区间/＞中进行拟合，得到新的分段区间参数、/＞。8.如权利要求1所述的分段线性数字预失真模型的参数更新方法，其特征在于，所述基带信号为归一化的基带信号，/＞，其中，/＞为设定的输入的基带信号的最大值， /＞为接收的原始基带信号。9.预失真系统，其特征在于，包括：数字预失真器、数模转换器、调制器、功率放大器、解调器、模数转换器和数字预失真模型参数更新模块；其中，所述数字预失真器中内置有分段线性数字预失真模型，所述数字预失真器用于获取输入的基带信号和所述数字预失真模型参数更新模块推送的模型参数，并将所述基带信号和所述模型参数输入所述分段线性数字预失真模型中，得到数字预失真器的输出信号；所述输出信号再依次经所述数模转换器、调制器、功率放大器、解调器、模数转换器后得到反馈信号；所述数字预失真模型参数更新模块用于获取所述基带信号和所述反馈信号，并采用如权利要求1-8任一所述的分段线性数字预失真模型的参数更新方法对模型参数进行更新，并将更新后的模型参数推送给所述数字预失真器。
说明书desc
技术领域本发明涉及功放数字预失真领域。更具体地说，本发明涉及一种分段线性数字预失真模型的参数更新方法及预失真系统。背景技术射频功率放大器是5G通信系统最关键和最昂贵的器件。在5G射频芯片中，高增益、高线性度的功率放大器是5G系统中的关键器件，它能够保证5G信号在近200MHz的带宽范围内具有良好的线性度，使得传输大带宽、低失真的高阶调制信号成为可能；同时保证5G信号具有较高的发射功率，满足了5G信号的传输距离要求。面对复杂的功率放大器行为特征，当前数字预失真的建模方法主要包括三类：无记忆模型、有记忆模型和分段线性模型。其中，分段线性模型的基本思想是将非线性函数的定义域划分为多个不同的子定义域，每个子定义域上该非线性函数可近似看做一个线性函数。理论上，子定义域划分的足够细，则分段线性函数可以对原非线性函数进行较为精确的近似。现有的分段线性模型的模型参数多是恒定的，即各段的系数为恒定值，区间也为恒定数值，在初始化后很少改变。但是，事实上，随着功率放大器特性的改变，或者射频系统中其它器件非线性特性的影响，或者这种非线性特性影响的变化，分段线性模型的系数会发生改变，增加或者减少，且分段的区间情况也会发生一定的改变。然而，这些问题在之前的研究中很少涉及。发明内容本发明的目的是提供一种分段线性数字预失真模型的参数更新方法及预失真系统，以解决上述问题。为了实现本发明的目的和其它优点，提供了一种分段线性数字预失真模型的参数更新方法，包括：获取基带信号，基于所述基带信号/＞和功率放大器特性，对分段线性数字预失真模型的分段区间和分段区间参数进行初始化；基于初始化确定的分段区间和分段区间参数，采用R2参数判别方法，判断各分段区间是否满足预设条件，若满足，则不进行区间拆分，否则，对该分段区间进行区间拆分，直至拆分后的分段区间满足预设条件，得到新的分段区间；对所述新的分段区间进行线性拟合，得到新的分段区间参数。优选的是，所述的分段线性数字预失真模型的参数更新方法，所述对分段线性数字预失真模型的分段区间和分段区间参数进行初始化，包括：根据功率放大器特性，确定所述分段线性数字预失真模型的分段数和幅度区间；依据所述基带信号，设定所述分段线性数字预失真模型为：/＞式中，，/＞，/＞为功率放大器第m段分段区间的增益；/＞为一个初始化的数值；/＞ ；/＞、/＞到/＞为根据功率放大器特性得到的参数；根据功率放大器特性，对所述分段线性数字预失真模型进行初始化，得到所述初始化确定的分段区间和分段区间参数a1m、a0m。优选的是，所述的分段线性数字预失真模型的参数更新方法，所述、/＞到/＞按照如下方法得到：1）在幅度区间的范围内，取N个幅度点，第n个幅度为，/＞；2）将所述第n个幅度输入功率放大器，获取功率放大器的输出Cn；3）从n=2开始，到n=N为止，执行下述操作：若Cn-2Cn-1+Cn-2≤e，e为预设阈值，则n，n-1，n-2为一个幅度区间，否则，n，n-1，n-2为不同的幅度区间，且n-1为区间的边界，记录n-1的数值，并将其作为分界点的序号，/＞，/＞，由此得到到/＞；4）通过最小二乘拟合法，得到功率放大器各分段区间的增益。优选的是，所述的分段线性数字预失真模型的参数更新方法，所述预设条件为：，式中，/＞为数字预失真器输出的信号/＞依次经过数模转换器、调制器、功率放大器、解调器和模数转换器后的反馈信号，/＞，为各分段区间的精度控制参数。优选的是，所述的分段线性数字预失真模型的参数更新方法，所述区间拆分包括：若第m段分段区间不满足所述预设条件，则将第m段分段区间拆分为两段分段区间和/＞，对这两段分段区间分别进行线性拟合，如果满足所述预设条件，则停止区间拆分，否则，继续进行区间拆分，直至拆分后的分段区间满足所述预设条件；其中，/＞，/＞。优选的是，所述的分段线性数字预失真模型的参数更新方法，所述对所述新的分段区间进行线性拟合，得到新的分段区间参数，包括：根据所述新的分段区间的分段数M1，设定所述分段线性数字预失真模型为：式中，；顺序采样一段包含J个采样点，且幅度取值在区间的基带信号/＞，/＞，采用初始化确定的分段区间参数a1m和a0m，以min|Gm1Y-z1|2作为优化目标，得到模型新的分段区间参数/＞、/＞，其中，/＞为功率放大器第/＞段分段区间的增益；z1为信号Y依次数模转换器、调制器、功率放大器，再经过解调器和模数转换器后的反馈信号，Y为输入的基带信号x经过所述分段线性预失真模型之后的输出，Y=BmXT， Bm=，XT为X的转置，X=。优选的是，所述的分段线性数字预失真模型的参数更新方法，所述对所述新的分段区间进行线性拟合，得到新的分段区间参数，还包括：判断所述新的分段区间中相邻分段区间的斜率是否满足，/＞斜率的精度控制参数，若是，则将该相邻分段区间合并，在区间/＞中进行拟合，得到新的分段区间参数/＞、/＞。优选的是，所述的分段线性数字预失真模型的参数更新方法，所述基带信号为归一化的基带信号，/＞，其中，/＞为设定的输入的基带信号的最大值，/＞为接收的原始基带信号。本发明还提供了一种预失真系统，包括：数字预失真器、数模转换器、调制器、功率放大器、解调器、模数转换器和数字预失真模型参数更新模块；其中，所述数字预失真器中内置有分段线性数字预失真模型，所述数字预失真器用于获取输入的基带信号和所述数字预失真模型参数更新模块推送的模型参数，并将所述基带信号和所述模型参数输入所述分段线性数字预失真模型中，得到数字预失真器的输出信号；所述输出信号再依次经所述数模转换器、调制器、功率放大器、解调器、模数转换器后得到反馈信号；所述数字预失真模型参数更新模块用于获取所述基带信号和所述反馈信号，并采用上述的分段线性数字预失真模型的参数更新方法对模型参数进行更新，并将更新后的模型参数推送给所述数字预失真器。本发明至少包括以下有益效果：本发明的分段线性数字预失真模型的参数更新方法，可以根据数字预失真系统的运行情况，自动调整分段线性预失真模型的分段区间和分段区间参数，以满足功率放大器的数字预失真要求。本发明的其它优点、目标和特征将部分通过下面的说明体现，部分还将通过对本发明的研究和实践而为本领域的技术人员所理解。附图说明图1是本发明一个实施例的分段线性数字预失真模型的参数更新方法的流程图。具体实施方式下面结合实施例和附图对本发明做进一步的详细说明，以令本领域技术人员参照说明书文字能够据以实施。应当理解，本文所使用的诸如“具有”、“包含”以及“包括”术语并不排除一个或多个其它元件或其组合的存在或添加。需要说明的是，下述实施方案中所述实验方法，如无特殊说明，均为常规方法。如图1所示，本发明提供一种分段线性数字预失真模型的参数更新方法，包括如下步骤：步骤一、获取原始基带信号，对/＞进行归一化处理，得基带信号/＞，，/＞为设定的输入的基带信号的最大值。步骤二、基于所述基带信号和功率放大器特性，对分段线性数字预失真模型的分段区间和分段区间参数进行初始化。具体包括：根据功率放大器特性，确定所述分段线性数字预失真模型的分段数和幅度区间/＞；依据所述基带信号，设定所述分段线性数字预失真模型为：式中，，/＞，/＞为功率放大器第m段分段区间的增益；/＞为一个初始化的数值；/＞ ；/＞、/＞到/＞为根据功率放大器特性得到的参数；根据功率放大器特性，对所述分段线性数字预失真模型进行初始化，得到所述初始化确定的分段区间和分段区间参数a1m、a0m。其中，所述、/＞到/＞按照如下方法得到：1）在幅度区间的范围内，取N个幅度点，第n个幅度为，/＞；2）将所述第n个幅度输入功率放大器，获取功率放大器的输出Cn；3）从n=2开始，到n=N为止，执行下述操作：若Cn-2Cn-1+Cn-2≤e，e为预设阈值，取值范围为0.02-0.05，则n，n-1，n-2为一个幅度区间，否则，n，n-1，n-2为不同的幅度区间，且n-1为区间的边界，记录n-1的数值，并将其作为分界点的序号，/＞，，由此得到/＞到/＞；4）通过最小二乘拟合法，得到功率放大器各分段区间的增益。步骤三、基于初始化确定的分段区间和分段区间参数，采用参数判别方法，判断各分段区间是否满足预设条件，若满足，则不进行区间拆分，否则，对该分段区间进行区间拆分，直至拆分后的分段区间满足预设条件，得到新的分段区间。其中，所述预设条件为：，式中，/＞为数字预失真器输出的信号/＞依次经过数模转换器、调制器、功率放大器、解调器和模数转换器后的反馈信号，/＞，/＞为各分段区间的精度控制参数，取值一般为0.97-0.98。所述区间拆分包括：若第m段分段区间不满足所述预设条件，则将第m段分段区间拆分为两段分段区间和/＞，对这两段分段区间分别进行线性拟合，如果满足所述预设条件，则停止区间拆分，否则，继续进行区间拆分，直至拆分后的分段区间满足所述预设条件；其中，/＞，/＞。步骤四、对所述新的分段区间进行线性拟合，得到新的分段区间参数。具体包括：根据所述新的分段区间的分段数M1，设定所述分段线性数字预失真模型为：式中，；顺序采样一段包含J个采样点，且幅度取值在区间的基带信号/＞，/＞，采用初始化确定的分段区间参数a1m和a0m，以min|Gm1Y-z1|2作为优化目标，得到模型新的分段区间参数/＞、/＞，其中，/＞为功率放大器第/＞段分段区间的增益；z1为信号Y依次数模转换器、调制器、功率放大器，再经过解调器和模数转换器后的反馈信号，Y为输入的基带信号x经过所述分段线性预失真模型之后的输出，Y=BmXT， Bm=，XT为X的转置，X=。步骤五、基于确定的所述新的分段区间和分段区间参数，判断相邻分段区间是否可以合并，若是，则更新分段区间及分段区间参数，否则，结束。具体地，判断所述新的分段区间中相邻分段区间的斜率是否满足，若是，则将该相邻分段区间合并，在区间/＞中进行拟合，得到新的分段区间参数/＞、/＞，若否，则结束分段区间合并和分段区间参数更新。其中，/＞为斜率的精度控制参数，可以根据情况设置，例如它可以按照如下方法设置：1）取/＞至/＞中斜率最大的值/＞和斜率最小的值/＞：，/＞；2），根据情况，取其中一个公式，计算/＞值。下面，通过两个例子，对本发明的方法进行进一步的解释说明。一种分段线性数字预失真模型的参数更新方法，包括如下步骤：、获取原始基带信号，对/＞进行归一化处理，得基带信号/＞，，/＞为设定的输入的基带信号的最大值。、根据功率放大器特性，在幅度的范围内，取100个幅度点，第n个幅度为，/＞，/＞，/＞。、将第n个幅度输入功率放大器，获取功率放大器的输出Cn。、从n=2开始，执行下述操作，到n=100为止，当Cn-2Cn-1+Cn-2≤e，e为预设阈值，这里取值为0.02， n、n-1、n-2为一个幅度区间，当Cn-2Cn-1+Cn-2＞e时，n、n-1、n-2为不同的幅度区间，n-1为区间的边界，记录n-1的数值，并将其作为第一个分界点的序号，，以此类推，得到第/＞分界点的序号/＞，/＞，，由此得到/＞到/＞。、假设M=3，，/＞，通过最小二乘拟合法，得到功率放大器各幅度区间的增益/＞。，/＞，/＞。则数字预失真模型为：，/＞，/＞；，/＞，/＞。但是上述模型及参数是根据功率放大器测量特性得到的参数，在真实的数字预失真系统中，该参数受到多种因素的影响，包括除功率放大器外其它电路非线性或者其它电路对于信号失真的影响，所以需要在上述参数的基础上，进行模型参数的更新。、基于步骤5确定的分段区间和分段区间参数，采用参数的判别方法，判断是否满足如下条件：/＞如果，则不进行区间拆分；其中，/＞为数字预失真器输出的信号/＞依次经过数模转换器、调制器、功率放大器、解调器和模数转换器后的反馈信号，/＞，/＞为各分段区间的精度控制参数，这里取值为0.97；如果不满足，则按照如下步骤拆分幅度区间：如果第m段分段区间不满足/＞，则将第m段分段区间拆分为两段分段区间和/＞，对这两段分段区间分别进行线性拟合，如果满足，则停止区间拆分，否则，继续进行区间拆分，直至拆分后的分段区间满足/＞；其中，/＞，/＞。假设经过上述判断后，第三段区间被拆分为两段，其余区间不发生改变，区间数目变为4段，则数字预失真模型变为：，/＞，/＞，/＞，/＞，/＞，/＞，/＞；，/＞，/＞，/＞。上面是一个区间拆分的例子，下面举一个区间合并的例子。假设步骤6中，进行区间拆分后获得的预失真模型为：，/＞，/＞，/＞，/＞，/＞，/＞，/＞；，/＞，/＞，/＞。按照如下方法进行区间合并：当相邻分段区间的斜率比较接近时，即时，将两段区间的数据放在一起进行拟合，即在区间/＞中进行参数拟合，得到新的分段拟合参数/＞、/＞。为一个控制斜率精度的参数，可以根据情况设置，例如它可以按照如下方法设置：1）取至/＞中斜率最大的值/＞和斜率最小的值，/＞；2）。则，/＞，/＞。区间1和2可以进行合并。数字预失真模型改变为：，/＞，/＞，/＞，/＞，/＞；，/＞，/＞。由此可知，本发明的分段线性数字预失真模型的参数更新方法，可以根据数字预失真系统的运行情况，自动调整分段线性预失真模型的分段区间和分段区间参数，以满足功率放大器的数字预失真要求。本发明还提供了一种预失真系统，包括：数字预失真器、数模转换器、调制器、功率放大器、解调器、模数转换器和数字预失真模型参数更新模块；其中，所述数字预失真器中内置有分段线性数字预失真模型，所述数字预失真器用于获取输入的基带信号和所述数字预失真模型参数更新模块推送的模型参数，并将所述基带信号和所述模型参数输入所述分段线性数字预失真模型中，得到数字预失真器的输出信号；所述输出信号再依次经所述数模转换器、调制器、功率放大器、解调器、模数转换器后得到反馈信号；所述数字预失真模型参数更新模块用于获取所述基带信号和所述反馈信号，并采用上述的分段线性数字预失真模型的参数更新方法对模型参数进行更新，并将更新后的模型参数推送给所述数字预失真器。上述预失真系统中预失真模型的参数更新方法是基于与上述的分段线性数字预失真模型的参数更新方法相同的发明构思得到，这里不再赘述。进一步地，本发明所述的实施例可以由硬件、软件、固件、中间件、微代码或其任意组合来实现。对于硬件实现方式，处理单元可以在一个或多个专用集成电路、数字信号处理器、数字信号处理器件、可编程逻辑器件、现场可编辑门阵列，处理器、控制器、微控制器，微处理器、被设计以执行本发明所述功能的其他电子单元、或其组合内实现。当以软件、固件、中间件或微代码、程序代码或代码段来实现实施例时，可以将它们存储在诸如存储组件的机器可读介质中。尽管本发明的实施方案已公开如上，但其并不仅仅限于说明书和实施方式中所列运用，它完全可以被适用于各种适合本发明的领域，对于熟悉本领域的人员而言，可容易地实现另外的修改，因此在不背离权利要求及等同范围所限定的一般概念下，本发明并不限于特定的细节和这里示出与描述的图例。
