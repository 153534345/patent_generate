标题title
一种基于智能设备的运动状态识别方法及系统
摘要abst
本发明适用于运动检测技术领域，尤其涉及一种基于智能设备的运动状态识别方法及系统，包括：与智能穿戴设备建立数据连接，获取定位数据，基于定位数据判定用户是否进入室内场地；基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态；基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据；基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态。本发明通过蓝牙测距确定用户的腕部与移动设备之间的相对运动轨迹，基于该运动轨迹确定用户的动作，从而实现对用户运动状态的监测。
权利要求书clms
1.一种基于智能设备的运动状态识别方法，其特征在于，所述基于智能设备的运动状态识别方法包括：与智能穿戴设备建立数据连接，获取定位数据，基于定位数据判定用户是否进入室内场地；基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态；基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据；基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态。2.根据权利要求1所述的基于智能设备的运动状态识别方法，其特征在于，所述基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态的步骤，具体包括：基于定位数据确定用户位置，基于用户位置对周边的商户进行搜索，基于搜索结果确定是否包含运动区域；在确定包含运动区域时，进行音频数据采集，得到音频数据；对音频数据进行内容识别，基于识别结果确定音频属性，根据音频属性判定当前音频是否适合于运动场景，若适合，则进入运动预备状态。3.根据权利要求1所述的基于智能设备的运动状态识别方法，其特征在于，所述基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据的步骤，具体包括：获取本机的蓝牙通讯信号，并获取智能穿戴设备的蓝牙通讯信号，得到双向通讯信号；基于双向通讯信号计算通讯距离，基于计算得到的两组通讯距离计算平均值，得到距离数据；获取智能穿戴设备的传感器数据，对传感器数据以及距离数据进行时间对齐处理。4.根据权利要求1所述的基于智能设备的运动状态识别方法，其特征在于，所述基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态的步骤，具体包括：构建三维坐标系，确定智能穿戴设备的起始位置；基于距离数据在三维坐标系中确定基础定位球面，基于传感器数据在三维坐标系中确定定位向量，根据定位向量确定轨迹点，生成三维运动轨迹；将三维运动轨迹与预设运动轨迹进行比较，确定对应的运动状态，并进行确认弹窗。5.根据权利要求4所述的基于智能设备的运动状态识别方法，其特征在于，所述将三维运动轨迹与预设运动轨迹进行比较的步骤，具体包括，对预设运动轨迹进行缩放，使得预设运动轨迹的起止点与三维运动轨迹的起止点重合，基于起止点构建对比参考线，分别计算预设运动轨迹和三维运动轨迹上各点与对比参考线之间的距离，得到两组距离值序列，通过以下公式计算两组距离值序列的相似度：；其中，n为单组距离值序列中的距离值数量，x和y分别为两组距离值序列中的距离值，L为起止点连线的长度值。6.一种基于智能设备的运动状态识别系统，其特征在于，所述基于智能设备的运动状态识别系统包括：用户定位模块，用于与智能穿戴设备建立数据连接，获取定位数据，基于定位数据判定用户是否进入室内场地；运动区域校核模块，用于基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态；数据获取模块，用于基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据；运动状态识别模块，用于基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态。7.根据权利要求6所述的基于智能设备的运动状态识别系统，其特征在于，所述运动区域校核模块包括：区域识别单元，用于基于定位数据确定用户位置，基于用户位置对周边的商户进行搜索，基于搜索结果确定是否包含运动区域；音频采集单元，用于在确定包含运动区域时，进行音频数据采集，得到音频数据；音频校核单元，用于对音频数据进行内容识别，基于识别结果确定音频属性，根据音频属性判定当前音频是否适合于运动场景，若适合，则进入运动预备状态。8.根据权利要求6所述的基于智能设备的运动状态识别系统，其特征在于，所述数据获取模块包括：信号获取单元，用于获取本机的蓝牙通讯信号，并获取智能穿戴设备的蓝牙通讯信号，得到双向通讯信号；距离计算单元，用于基于双向通讯信号计算通讯距离，基于计算得到的两组通讯距离计算平均值，得到距离数据；数据处理单元，用于获取智能穿戴设备的传感器数据，对传感器数据以及距离数据进行时间对齐处理。9.根据权利要求6所述的基于智能设备的运动状态识别系统，其特征在于，所述运动状态识别模块包括：坐标构建单元，用于构建三维坐标系，确定智能穿戴设备的起始位置；轨迹构建单元，用于基于距离数据在三维坐标系中确定基础定位球面，基于传感器数据在三维坐标系中确定定位向量，根据定位向量确定轨迹点，生成三维运动轨迹；状态确认单元，用于将三维运动轨迹与预设运动轨迹进行比较，确定对应的运动状态，并进行确认弹窗。10.根据权利要求9所述的基于智能设备的运动状态识别系统，其特征在于，所述将三维运动轨迹与预设运动轨迹进行比较的步骤，具体包括，对预设运动轨迹进行缩放，使得预设运动轨迹的起止点与三维运动轨迹的起止点重合，基于起止点构建对比参考线，分别计算预设运动轨迹和三维运动轨迹上各点与对比参考线之间的距离，得到两组距离值序列，通过以下公式计算两组距离值序列的相似度：;其中，n为单组距离值序列中的距离值数量，x和y分别为两组距离值序列中的距离值，L为起止点连线的长度值。
说明书desc
技术领域本发明属于运动检测技术领域，尤其涉及一种基于智能设备的运动状态识别方法及系统。背景技术智能穿戴设备是应用穿戴式技术对日常穿戴进行智能化设计、开发出可以穿戴的设备的总称，如手表、手环、眼镜、服饰等。随着智能穿戴设备的发展，智能手环和智能手表等智能穿戴设备用户逐渐增加，智能穿戴设备的定位主要是用于进行健康监测和运动辅助，常见的智能穿戴设备能够识别用户是否在运动，而上述可以被监测的运动类型比较局限，主要以跑步、划船机等简单易识别的运动类型为主，而对其他固定运动器械，如蝴蝶机和悍马机，上述运动是通过常见的智能穿戴设备是无法直接识别，可见，现有技术中的智能穿戴设备难以完成对多种运动类型的主动识别。发明内容本发明的目的在于提供一种基于智能设备的运动状态识别方法，旨在解决现有技术中的智能穿戴设备难以完成对多种运动类型的主动识别的问题。本发明是这样实现的，一种基于智能设备的运动状态识别方法，所述基于智能设备的运动状态识别方法包括：与智能穿戴设备建立数据连接，获取定位数据，基于定位数据判定用户是否进入室内场地；基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态；基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据；基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态。优选的，所述基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态的步骤，具体包括：基于定位数据确定用户位置，基于用户位置对周边的商户进行搜索，基于搜索结果确定是否包含运动区域；在确定包含运动区域时，进行音频数据采集，得到音频数据；对音频数据进行内容识别，基于识别结果确定音频属性，根据音频属性判定当前音频是否适合于运动场景，若适合，则进入运动预备状态。优选的，所述基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据的步骤，具体包括：获取本机的蓝牙通讯信号，并获取智能穿戴设备的蓝牙通讯信号，得到双向通讯信号；基于双向通讯信号计算通讯距离，基于计算得到的两组通讯距离计算平均值，得到距离数据；获取智能穿戴设备的传感器数据，对传感器数据以及距离数据进行时间对齐处理。优选的，所述基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态的步骤，具体包括：构建三维坐标系，确定智能穿戴设备的起始位置；基于距离数据在三维坐标系中确定基础定位球面，基于传感器数据在三维坐标系中确定定位向量，根据定位向量确定轨迹点，生成三维运动轨迹；将三维运动轨迹与预设运动轨迹进行比较，确定对应的运动状态，并进行确认弹窗。优选的，所述将三维运动轨迹与预设运动轨迹进行比较的步骤，具体包括，对预设运动轨迹进行缩放，使得预设运动轨迹的起止点与三维运动轨迹的起止点重合，基于起止点构建对比参考线，分别计算预设运动轨迹和三维运动轨迹上各点与对比参考线之间的距离，得到两组距离值序列，通过以下公式计算两组距离值序列的相似度：;其中，n为单组距离值序列中的距离值数量，x和y分别为两组距离值序列中的距离值，L为起止点连线的长度值。本发明的另一目的在于提供一种基于智能设备的运动状态识别系统，所述基于智能设备的运动状态识别系统包括：用户定位模块，用于与智能穿戴设备建立数据连接，获取定位数据，基于定位数据判定用户是否进入室内场地；运动区域校核模块，用于基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态；数据获取模块，用于基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据；运动状态识别模块，用于基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态。优选的，所述运动区域校核模块包括：区域识别单元，用于基于定位数据确定用户位置，基于用户位置对周边的商户进行搜索，基于搜索结果确定是否包含运动区域；音频采集单元，用于在确定包含运动区域时，进行音频数据采集，得到音频数据；音频校核单元，用于对音频数据进行内容识别，基于识别结果确定音频属性，根据音频属性判定当前音频是否适合于运动场景，若适合，则进入运动预备状态。优选的，所述数据获取模块包括：信号获取单元，用于获取本机的蓝牙通讯信号，并获取智能穿戴设备的蓝牙通讯信号，得到双向通讯信号；距离计算单元，用于基于双向通讯信号计算通讯距离，基于计算得到的两组通讯距离计算平均值，得到距离数据；数据处理单元，用于获取智能穿戴设备的传感器数据，对传感器数据以及距离数据进行时间对齐处理。优选的，所述运动状态识别模块包括：坐标构建单元，用于构建三维坐标系，确定智能穿戴设备的起始位置；轨迹构建单元，用于基于距离数据在三维坐标系中确定基础定位球面，基于传感器数据在三维坐标系中确定定位向量，根据定位向量确定轨迹点，生成三维运动轨迹；状态确认单元，用于将三维运动轨迹与预设运动轨迹进行比较，确定对应的运动状态，并进行确认弹窗。优选的，所述将三维运动轨迹与预设运动轨迹进行比较的步骤，具体包括，对预设运动轨迹进行缩放，使得预设运动轨迹的起止点与三维运动轨迹的起止点重合，基于起止点构建对比参考线，分别计算预设运动轨迹和三维运动轨迹上各点与对比参考线之间的距离，得到两组距离值序列，通过以下公式计算两组距离值序列的相似度：;其中，n为单组距离值序列中的距离值数量，x和y分别为两组距离值序列中的距离值，L为起止点连线的长度值。本发明提供的一种基于智能设备的运动状态识别方法，在用户的佩戴过程中，基于用户的位置以及场景数据确定用户是否进入到运动区域，在运动区域内，则通过蓝牙测距确定用户的腕部与移动设备之间的相对运动轨迹，基于该运动轨迹确定用户的动作，从而实现对用户运动状态的监测。附图说明图1为本发明实施例提供的一种基于智能设备的运动状态识别方法的流程图；图2为本发明实施例提供的基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态的步骤的流程图；图3为本发明实施例提供的基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据的步骤的流程图；图4为本发明实施例提供的基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态的步骤的流程图；图5为本发明实施例提供的一种基于智能设备的运动状态识别系统的架构图；图6为本发明实施例提供的运动区域校核模块的架构图；图7为本发明实施例提供的数据获取模块的架构图；图8为本发明实施例提供的运动状态识别模块的架构图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。可以理解，本申请所使用的术语“第一”、“第二”等可在本文中用于描述各种元件，但除非特别说明，这些元件不受这些术语限制。这些术语仅用于将第一个元件与另一个元件区分。举例来说，在不脱离本申请的范围的情况下，可以将第一xx脚本称为第二xx脚本，且类似地，可将第二xx脚本称为第一xx脚本。如图1所示，为本发明实施例提供的一种基于智能设备的运动状态识别方法的流程图，所述基于智能设备的运动状态识别方法包括：S100，与智能穿戴设备建立数据连接，获取定位数据，基于定位数据判定用户是否进入室内场地。在本步骤中，与智能穿戴设备建立数据连接，本发明应用于移动设备，如手机，在使用时，需要先将移动设备与智能穿戴设备通过近距通讯的方式进行连接，具体可以通过蓝牙进行连接，智能穿戴设备可以为智能手表或者智能手环，其内置有霍尔元件、三轴加速度传感器以及拾音器，在使用过程中，用户需要授权给智能穿戴设备收音权限，并为移动设备授权定位权限，移动设备对用户的位置进行间歇性获取，基于获取得到的用户位置判定是位于室内场地还是室外场地，当位于室外场地时，则说明用户不处于室内运动的状态，此时则不允许智能穿戴设备进行收音。S200，基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态。在本步骤中，基于定位数据进行运动区域识别，根据定位数据确定用户位于室内场地时，如商场或者小区等位置，则进一步基于用户所在的位置进行检索，当确定用户在A商场时，则对A商场进行检索，判定A商场内是否存在运动健身场所，如健身房等，若存在则判定用户处于运动区域，此时为了进一步进行确认，则通过智能穿戴设备进行收音处理，当用户所处的位置播放的音乐的节奏较快，适合在运动场所播放时，则初步判定用户可能在进行运动，对音乐类型的识别可以通过对音乐进行识别，确定歌曲类型，进而根据歌曲的标签属性来确定其是否适合于运动场所，也可以提取音乐的振幅、响度等信息，当满足预设条件时，则判定为其适合于运动场所，运动场所播放的音乐节奏较快，音量较大，较为容易识别，具体也可以设置响度阈值和/或振幅阈值，当智能穿戴设备采集的音频数据超过上述阈值时，则判定校验通过，开始进入到运动预备状态。S300，基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据。在本步骤中，基于蓝牙信号进行双向通讯距离计算，在进入到运动预备状态之后，则开始进行运动状态检测，此时通过移动设备对智能穿戴设备进行蓝牙信号检测，对其检测到的蓝牙信号的强度进行记录，基于记录得到蓝牙信号强度，将其转化为距离值，具体的，通过蓝牙距离计算公式确定对应的距离：;其中，d为基于蓝牙信号计算得到的距离，P为发送功率，T为接收得到的蓝牙信号强度，其中n为传播常数，那么基于上述公式可以计算得到移动设备与智能穿戴设备之间的距离，随后进行反向计算，通过智能穿戴设备对移动设备的蓝牙信号进行检测，从而计算智能穿戴设备与移动设备之间的距离，基于上述距离值，计算平均值，即为本次检测得到的距离数据，按照预设的时间间隔不断计算移动设备与智能穿戴设备之间的距离数据，在此过程中，不断获取智能穿戴设备的传感器数据，所述传感器数据至少包括三轴加速度传感器数据以及霍尔元件传感器数据，基于三轴加速度传感器可以获知当前智能穿戴设备在空间内的运动方向以及距离，而霍尔元件传感器数据则可以确定用户的手表姿态，即其朝向。S400，基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态。在本步骤中，基于传感器数据和距离数据生成三维运动轨迹，构建三维坐标系，将移动设备的位置定为三维坐标系的原点，并将智能穿戴设备的起点位置定在X轴上的预设位置，此时不断提取距离数据，每次提取一组距离数据，则根据该距离数据在三维坐标系中确定一组球面，该球面即为智能穿戴设备可能存在的位置，进而基于该组距离数据对应的时间信息提取对应的传感器数据，基于该传感器数据进一步确定该时刻智能穿戴设备在该球面上的具体位置，重复上述步骤，不断确定智能穿戴设备在三维坐标系中的位置，直到智能穿戴设备回到起始位置，此时即得到三维运动轨迹，将得到的三维运动轨迹与预设运动轨迹进行对比，从而判定当前用户的运动状态，也就能够确定用户当前使用的健身器械类型，这是由于对于某一健身器械，用户在使用时，其腕部的运动轨迹是相同的，当用户重复锻炼动作时，则会在三维坐标系中形成重复的轨迹，不同的健身器械，其在三维空间内的轨迹是不同的，因此可以据此识别用户的运动状态。如图2所示，作为本发明的一个优选实施例，所述基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态的步骤，具体包括：S201，基于定位数据确定用户位置，基于用户位置对周边的商户进行搜索，基于搜索结果确定是否包含运动区域。在本步骤中，基于定位数据确定用户位置，定位数据来源于移动设备，那么基于该定位数据就可以确定用户的位置，由于移动设备定位存在精度问题，则以用户位置范围的中心点为用户的具体位置，若该具体位置与某建筑重合，则对该建筑进行检索，确定该建筑是否存在运动区域。S202，在确定包含运动区域时，进行音频数据采集，得到音频数据。在本步骤中，在确定包含运动区域时，进行音频数据采集，为了辅助确定用户是否进入到运动区域内，通过智能穿戴设备进行音频采集，不采用移动设备进行录音是因为移动设备可能放置在衣服内，影响收音，并且进行录音影响移动设备的其他功能，因此，采用智能穿戴设备进行录音，得到音频数据。S203，对音频数据进行内容识别，基于识别结果确定音频属性，根据音频属性判定当前音频是否适合于运动场景，若适合，则进入运动预备状态。在本步骤中，对音频数据进行内容识别，通过内容识别的方式可以确定该歌曲的内容，从而根据歌曲的名称以及歌曲标签属性判定其是否适合于运动场景，若适合，则判定进入运动预备状态。如图3所示，作为本发明的一个优选实施例，所述基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据的步骤，具体包括：S301，获取本机的蓝牙通讯信号，并获取智能穿戴设备的蓝牙通讯信号，得到双向通讯信号。在本步骤中，获取本机的蓝牙通讯信号，通过移动设备对智能穿戴设备所发出的蓝牙信号进行持续监测，同样的，通过智能穿戴设备对移动设备发出的蓝牙信号进行持续监测，从而得到双向通讯信号。S302，基于双向通讯信号计算通讯距离，基于计算得到的两组通讯距离计算平均值，得到距离数据。在本步骤中，基于双向通讯信号计算通讯距离，通讯距离包括移动设备与智能穿戴设备之间的双向距离，由于蓝牙信号可能存在不稳定的情况，因此取两组通讯距离的平均值，将其作为距离数据进行记录。S303，获取智能穿戴设备的传感器数据，对传感器数据以及距离数据进行时间对齐处理。在本步骤中，获取智能穿戴设备的传感器数据，具体的，在确定距离数据的时候，每一组距离数据均包括有时间信息，基于该时间信息去查询智能穿戴设备所产生的传感器数据，以提取得到对应时刻的传感器数据，则保证了传感器数据与距离数据是对齐的。如图4所示，作为本发明的一个优选实施例，所述基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态的步骤，具体包括：S401，构建三维坐标系，确定智能穿戴设备的起始位置。在本步骤中，构建三维坐标系，三维坐标系的Y轴负半轴指向正北方向，由于智能穿戴设备与移动设备之间的距离是可以确定的，而智能穿戴设备与移动设备之间的相对方位是无法确定的，因此在构建三维坐标系之后，将原点定义为移动设备的位置，将三维坐标系X轴上的预设位置定义为智能穿戴设备的起始位置，具体的，若用户将智能穿戴设备佩戴在左手，则智能穿戴设备在三维坐标系中X轴的负半轴上，反之，若用户将智能穿戴设备佩戴在右手，则智能穿戴设备在三维坐标系X轴的正半轴上。S402，基于距离数据在三维坐标系中确定基础定位球面，基于传感器数据在三维坐标系中确定定位向量，根据定位向量确定轨迹点，生成三维运动轨迹。在本步骤中，基于距离数据在三维坐标系中确定基础定位球面，基于距离数据确定基础定位球面的半径，即以三维坐标系原点为球心，以距离数据中记录的距离值为半径，构建基础定位球面，基础定位球面即为该时刻智能穿戴设备所可能存在的位置，智能穿戴设备可能出现在该基础定位球面上的任意一点，基于传感器数据在三维坐标系中确定定位向量，在传感器数据中，记录了智能穿戴设备的朝向以及运动方向，其中三轴加速度传感器能够获知在相邻两组距离数据对应的采集时刻之间的移动轨迹，基于移动轨迹的起点位置和终点位置，构建一个定位向量，该定位向量的起点为当前智能穿戴设备的位置，该定位向量的模等于移动轨迹起点位置与终点位置之间的距离值，将该定位向量标记于三维坐标系中，以定位向量的起点构建与该定位向量方向相同的射线，该射线与基础定位球面的第一个点，即为本次智能穿戴设备移动的一个轨迹点，重复上述过程，从而确定智能穿戴设备在三维坐标系中各个时刻的轨迹点，以形成三维运动轨迹，在上述过程中，上一个确定的轨迹点作为分析下一个轨迹点过程中智能穿戴设备的起点，当出现轨迹点与智能穿戴设备的初始位置重合时，则一个运动周期结束，得到一个三维运动轨迹，具体的，可以记录多个运动周期，得到多个三维运动轨迹。S403，将三维运动轨迹与预设运动轨迹进行比较，确定对应的运动状态，并进行确认弹窗。在本步骤中，将三维运动轨迹与预设运动轨迹进行比较，预设运动轨迹存储在移动设备中，预设运动轨迹是通过进行实际试验获取得到的，具体的，通过配对完成的移动设备和智能穿戴设备，测试人员佩戴智能穿戴设备，并将移动设备置于对应的锻练器械上，采集智能穿戴设备的传感器数据，以构建预设运动轨迹，那么将三维运动轨迹与预设运动轨迹进行比对，即可确定对应的运动状态，具体的，将三维运动轨迹与预设运动轨迹进行比较的步骤，具体包括，对预设运动轨迹进行缩放，使得预设运动轨迹的起止点与三维运动轨迹的起止点重合，基于起止点构建对比参考线，分别计算预设运动轨迹和三维运动轨迹上各点与对比参考线之间的距离，得到两组距离值序列，通过以下公式计算两组距离值序列的相似度：;其中，n为单组距离值序列中的距离值数量，x和y分别为两组距离值序列中的距离值，L为起止点连线的长度值，上述过程即为通过缩放使得预设运动轨迹和三维运动轨迹的起点和终点分别对应重合，那么通过确定两者与起点终点连线之间的距离值得波动情况来分析两者的相似性，当P大于预设值时，则说明两者相似，则确定确定了用户当前使用的运动器械以及运动状态，确定之后，可以通过智能穿戴设备进行确认弹窗，具体的，提示用户是否正在进行某项运动，若用户选择是，则开始基于霍尔元件监测得到智能穿戴设备的姿态判定用户的动作是否标准，如用户使用蝴蝶机时，智能穿戴设备在运动轨迹上的不同位置其朝向应当是朝向哪个方向，用于辅助判定用户的手腕姿势是否正确，如在运动轨迹的某一点，用户的手腕应当弯曲，根据运动轨迹判定用户的智能穿戴设备的朝向应当为正南方向，而实际监测到智能穿戴设备的朝向为西南方向，则说用用户需要调整手腕方向，以对用户进行提示，在上述过程中，还可以对用户的心率、脉搏等数据进行采集，以进行辅助分析。如图5所示，为本发明提供的一种基于智能设备的运动状态识别系统，所述基于智能设备的运动状态识别系统包括：用户定位模块100，用于与智能穿戴设备建立数据连接，获取定位数据，基于定位数据判定用户是否进入室内场地。在本系统中，用户定位模块100与智能穿戴设备建立数据连接，本发明应用于移动设备，如手机，在使用时，需要先将移动设备与智能穿戴设备通过近距通讯的方式进行连接，具体可以通过蓝牙进行连接，智能穿戴设备可以为智能手表或者智能手环，其内置有霍尔元件、三轴加速度传感器以及拾音器，在使用过程中，用户需要授权给智能穿戴设备收音权限，并为移动设备授权定位权限，移动设备对用户的位置进行间歇性获取，基于获取得到的用户位置判定是位于室内场地还是室外场地，当位于室外场地时，则说明用户不处于室内运动的状态，此时则不允许智能穿戴设备进行收音。运动区域校核模块200，用于基于定位数据进行运动区域识别，当处于运动区域时，获取音频数据，基于音频数据进行场地校验，校验通过后，进入运动预备状态。在本系统中，运动区域校核模块200基于定位数据进行运动区域识别，根据定位数据确定用户位于室内场地时，如商场或者小区等位置，则进一步基于用户所在的位置进行检索，当确定用户在A商场时，则对A商场进行检索，判定A商场内是否存在运动健身场所，如健身房等，若存在则判定用户处于运动区域，此时为了进一步进行确认，则通过智能穿戴设备进行收音处理，当用户所处的位置播放的音乐的节奏较快，适合在运动场所播放时，则初步判定用户可能在进行运动，对音乐类型的识别可以通过对音乐进行识别，确定歌曲类型，进而根据歌曲的标签属性来确定其是否适合于运动场所，也可以提取音乐的振幅、响度等信息，当满足预设条件时，则判定为其适合于运动场所，运动场所播放的音乐节奏较快，音量较大，较为容易识别，具体也可以设置响度阈值和/或振幅阈值，当智能穿戴设备采集的音频数据超过上述阈值时，则判定校验通过，开始进入到运动预备状态。数据获取模块300，用于基于蓝牙信号进行双向通讯距离计算，得到距离数据，并获取智能穿戴设备的传感器数据。在本系统中，数据获取模块300基于蓝牙信号进行双向通讯距离计算，在进入到运动预备状态之后，则开始进行运动状态检测，此时通过移动设备对智能穿戴设备进行蓝牙信号检测，对其检测到的蓝牙信号的强度进行记录，基于记录得到蓝牙信号强度，将其转化为距离值，具体的，通过蓝牙距离计算公式确定对应的距离：;其中，d为基于蓝牙信号计算得到的距离，P为发送功率，T为接收得到的蓝牙信号强度，其中n为传播常数，那么基于上述公式可以计算得到移动设备与智能穿戴设备之间的距离，随后进行反向计算，通过智能穿戴设备对移动设备的蓝牙信号进行检测，从而计算智能穿戴设备与移动设备之间的距离，基于上述距离值，计算平均值，即为本次检测得到的距离数据，按照预设的时间间隔不断计算移动设备与智能穿戴设备之间的距离数据，在此过程中，不断获取智能穿戴设备的传感器数据，所述传感器数据至少包括三轴加速度传感器数据以及霍尔元件传感器数据，基于三轴加速度传感器可以获知当前智能穿戴设备在空间内的运动方向以及距离，而霍尔元件传感器数据则可以确定用户的手表姿态，即其朝向。运动状态识别模块400，用于基于传感器数据和距离数据生成三维运动轨迹，基于三维运动轨迹识别运动状态。在本系统中，运动状态识别模块400基于传感器数据和距离数据生成三维运动轨迹，构建三维坐标系，将移动设备的位置定为三维坐标系的原点，并将智能穿戴设备的起点位置定在X轴上的预设位置，此时不断提取距离数据，每次提取一组距离数据，则根据该距离数据在三维坐标系中确定一组球面，该球面即为智能穿戴设备可能存在的位置，进而基于该组距离数据对应的时间信息提取对应的传感器数据，基于该传感器数据进一步确定该时刻智能穿戴设备在该球面上的具体位置，重复上述步骤，不断确定智能穿戴设备在三维坐标系中的位置，直到智能穿戴设备回到起始位置，此时即得到三维运动轨迹，将得到的三维运动轨迹与预设运动轨迹进行对比，从而判定当前用户的运动状态，也就能够确定用户当前使用的健身器械类型，这是由于对于某一健身器械，用户在使用时，其腕部的运动轨迹是相同的，当用户重复锻炼动作时，则会在三维坐标系中形成重复的轨迹，不同的健身器械，其在三维空间内的轨迹是不同的，因此可以据此识别用户的运动状态。如图6所示，作为本发明的一个优选实施例，所述运动区域校核模块200包括：区域识别单元201，用于基于定位数据确定用户位置，基于用户位置对周边的商户进行搜索，基于搜索结果确定是否包含运动区域。在本模块中，区域识别单元201基于定位数据确定用户位置，定位数据来源于移动设备，那么基于该定位数据就可以确定用户的位置，由于移动设备定位存在精度问题，则以用户位置范围的中心点为用户的具体位置，若该具体位置与某建筑重合，则对该建筑进行检索，确定该建筑是否存在运动区域。音频采集单元202，用于在确定包含运动区域时，进行音频数据采集，得到音频数据。在本模块中，音频采集单元202在确定包含运动区域时，进行音频数据采集，为了辅助确定用户是否进入到运动区域内，通过智能穿戴设备进行音频采集，不采用移动设备进行录音是因为移动设备可能放置在衣服内，影响收音，并且进行录音影响移动设备的其他功能，因此，采用智能穿戴设备进行录音，得到音频数据。音频校核单元203，用于对音频数据进行内容识别，基于识别结果确定音频属性，根据音频属性判定当前音频是否适合于运动场景，若适合，则进入运动预备状态。在本模块中，音频校核单元203对音频数据进行内容识别，通过内容识别的方式可以确定该歌曲的内容，从而根据歌曲的名称以及歌曲标签属性判定其是否适合于运动场景，若适合，则判定进入运动预备状态。如图7所示，作为本发明的一个优选实施例，所述数据获取模块300包括：信号获取单元301，用于获取本机的蓝牙通讯信号，并获取智能穿戴设备的蓝牙通讯信号，得到双向通讯信号。在本模块中，信号获取单元301获取本机的蓝牙通讯信号，通过移动设备对智能穿戴设备所发出的蓝牙信号进行持续监测，同样的，通过智能穿戴设备对移动设备发出的蓝牙信号进行持续监测，从而得到双向通讯信号。距离计算单元302，用于基于双向通讯信号计算通讯距离，基于计算得到的两组通讯距离计算平均值，得到距离数据。在本模块中，距离计算单元302基于双向通讯信号计算通讯距离，通讯距离包括移动设备与智能穿戴设备之间的双向距离，由于蓝牙信号可能存在不稳定的情况，因此取两组通讯距离的平均值，将其作为距离数据进行记录。数据处理单元303，用于获取智能穿戴设备的传感器数据，对传感器数据以及距离数据进行时间对齐处理。在本模块中，数据处理单元303获取智能穿戴设备的传感器数据，具体的，在确定距离数据的时候，每一组距离数据均包括有时间信息，基于该时间信息去查询智能穿戴设备所产生的传感器数据，以提取得到对应时刻的传感器数据，则保证了传感器数据与距离数据是对齐的。如图8所示，作为本发明的一个优选实施例，所述运动状态识别模块400包括：坐标构建单元401，用于构建三维坐标系，确定智能穿戴设备的起始位置。在本模块中，坐标构建单元401构建三维坐标系，三维坐标系的Y轴负半轴指向正北方向，由于智能穿戴设备与移动设备之间的距离是可以确定的，而智能穿戴设备与移动设备之间的相对方位是无法确定的，因此在构建三维坐标系之后，将原点定义为移动设备的位置，将三维坐标系X轴上的预设位置定义为智能穿戴设备的起始位置，具体的，若用户将智能穿戴设备佩戴在左手，则智能穿戴设备在三维坐标系中X轴的负半轴上，反之，若用户将智能穿戴设备佩戴在右手，则智能穿戴设备在三维坐标系X轴的正半轴上。轨迹构建单元402，用于基于距离数据在三维坐标系中确定基础定位球面，基于传感器数据在三维坐标系中确定定位向量，根据定位向量确定轨迹点，生成三维运动轨迹。在本模块中，轨迹构建单元402基于距离数据在三维坐标系中确定基础定位球面，基于距离数据确定基础定位球面的半径，即以三维坐标系原点为球心，以距离数据中记录的距离值为半径，构建基础定位球面，基础定位球面即为该时刻智能穿戴设备所可能存在的位置，智能穿戴设备可能出现在该基础定位球面上的任意一点，基于传感器数据在三维坐标系中确定定位向量，在传感器数据中，记录了智能穿戴设备的朝向以及运动方向，其中三轴加速度传感器能够获知在相邻两组距离数据对应的采集时刻之间的移动轨迹，基于移动轨迹的起点位置和终点位置，构建一个定位向量，该定位向量的起点为当前智能穿戴设备的位置，该定位向量的模等于移动轨迹起点位置与终点位置之间的距离值，将该定位向量标记于三维坐标系中，以定位向量的起点构建与该定位向量方向相同的射线，该射线与基础定位球面的第一个点，即为本次智能穿戴设备移动的一个轨迹点，重复上述过程，从而确定智能穿戴设备在三维坐标系中各个时刻的轨迹点，以形成三维运动轨迹，在上述过程中，上一个确定的轨迹点作为分析下一个轨迹点过程中智能穿戴设备的起点，当出现轨迹点与智能穿戴设备的初始位置重合时，则一个运动周期结束，得到一个三维运动轨迹，具体的，可以记录多个运动周期，得到多个三维运动轨迹。状态确认单元403，用于将三维运动轨迹与预设运动轨迹进行比较，确定对应的运动状态，并进行确认弹窗。在本模块中，状态确认单元403将三维运动轨迹与预设运动轨迹进行比较，预设运动轨迹存储在移动设备中，预设运动轨迹是通过进行实际试验获取得到的，具体的，通过配对完成的移动设备和智能穿戴设备，测试人员佩戴智能穿戴设备，并将移动设备置于对应的锻练器械上，采集智能穿戴设备的传感器数据，以构建预设运动轨迹，那么将三维运动轨迹与预设运动轨迹进行比对，即可确定对应的运动状态，具体的，将三维运动轨迹与预设运动轨迹进行比较的步骤，具体包括，对预设运动轨迹进行缩放，使得预设运动轨迹的起止点与三维运动轨迹的起止点重合，基于起止点构建对比参考线，分别计算预设运动轨迹和三维运动轨迹上各点与对比参考线之间的距离，得到两组距离值序列，通过以下公式计算两组距离值序列的相似度：;其中，n为单组距离值序列中的距离值数量，x和y分别为两组距离值序列中的距离值，L为起止点连线的长度值，上述过程即为通过缩放使得预设运动轨迹和三维运动轨迹的起点和终点分别对应重合，那么通过确定两者与起点终点连线之间的距离值得波动情况来分析两者的相似性，当P大于预设值时，则说明两者相似，则确定确定了用户当前使用的运动器械以及运动状态，确定之后，可以通过智能穿戴设备进行确认弹窗，具体的，提示用户是否正在进行某项运动，若用户选择是，则开始基于霍尔元件监测得到智能穿戴设备的姿态判定用户的动作是否标准，如用户使用蝴蝶机时，智能穿戴设备在运动轨迹上的不同位置其朝向应当是朝向哪个方向，用于辅助判定用户的手腕姿势是否正确，如在运动轨迹的某一点，用户的手腕应当弯曲，根据运动轨迹判定用户的智能穿戴设备的朝向应当为正南方向，而实际监测到智能穿戴设备的朝向为西南方向，则说用用户需要调整手腕方向，以对用户进行提示，在上述过程中，还可以对用户的心率、脉搏等数据进行采集，以进行辅助分析。应该理解的是，虽然本发明各实施例的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，各实施例中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些子步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
