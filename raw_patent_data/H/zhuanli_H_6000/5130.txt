标题title
一种基于图卷积网络的主动配电网分区方法
摘要abst
本发明公开了一种基于图卷积网络的主动配电网分区方法，其步骤包括：1、建立主动配电网无向图模型；2、预处理主动配电网节点的特征数据作为训练样本；3、构建图卷积神经网络；4、通过梯度下降反向传播算法更新图卷积神经网络的网络参数；5、根据最优模型实现主动配电网网络分区。本发明无需建立并求解复杂的主动配电网分区数学优化模型，即可得到最佳分区结果，降低了时间成本，从而使主动配电网的运行、控制、管理指令能够及时地生效，提高电压质量。
权利要求书clms
1.一种基于图卷积网络的主动配电网分区方法，是应用于包含多种分布式发电设备与可调负载的主动配电网中；所述主动配电网的拓扑由N个节点组成；每个节点包含M个特征属性；其特征是，所述网络分区方法是按如下步骤进行：步骤一、获取所述主动配电网的拓扑、各个节点的历史特征数据以及相对应的历史分区方案，以生成训练样本数据；步骤1.1、以所述主动配电网中N个节点为图的顶点，设备的配电线路连接情况为图的边，建立无向图模型G＝；其中，V＝表示顶点集合；E＝{eij∣i∈,j∈,i≠j}表示边集合，vi表示第i个顶点，eij表示第i个顶点vi与第j个顶点vj间存在边；步骤1.2、利用式获取主动配电网的无向图模型G的邻接矩阵A中的第i行第j列的元素aij，从而得到维数为N×N的邻接矩阵A＝{aij}；步骤1.3、根据各节点的历史特征数据，生成无向图模型G的T组特征矩阵，其中第t组特征矩阵记为Xt＝{xi,t|t∈,i∈}，1＜t＜T，xi,t表示第t组特征矩阵中第i个顶点vi的M个特征属性；步骤1.4、对所述无向图模型G中的第t组特征矩阵Xt进行标准差的标准化处理，从而得到第t组标准化后的特征矩阵Xt*；步骤1.5、将历史分区方案映射为T组分区标识向量，其中，第t组分区标识向量记为Rt＝{rt,i|t∈,i∈}，其中，rt,i表示第t组分区标识向量中第i个顶点vi被划分到的区域编号，1＜rt,i＜C，其中，C为主动配电网的分区总数；步骤1.6、由第t组标准化后的特征矩阵Xt*和第t组分区标识向量Rt构成第t组训练样本Traint＝{Xt*,Rt}；从而得到共T组的训练样本集Train＝{Traint|t∈}；步骤二、构建图卷积神经网络，包括：L个图卷积层和1个softmax多分类层；步骤三、训练图卷积神经网络；步骤3.1、定义网络当前迭代次数为α，并初始化α＝1；最大迭代次数为αmax；对所述网络中各层的参数进行第α次随机初始化，从而得到第α次迭代的图卷积神经网络；步骤3.2、定义变量t，初始化t＝1；步骤3.3、初始化l＝1；当l＝1时，将所述邻接矩阵A与第t组标准化后的特征矩阵输入到第α次迭代的图卷积神经网络中，并经过第l个图卷积层运算，从而利用式-式得到经过第l个图卷积层输出的隐藏特征矩阵式-式中，I是单位对角矩阵，为加入自循环的邻接矩阵，为相应的度矩阵，为加入自循环的邻接矩阵中第i行第j列的元素，为相应的度矩阵中第i行第i列的元素；φ为图卷积层的信息聚合函数；为第α次迭代的图卷积神经网络中第l-1层的权重矩阵，当l＝1时，令表示经过第l-1个图卷积层输出的隐藏特征矩阵，当l＝1时，令当l＝2,3,…,L时，将第l-1个图卷积层输出的隐藏特征矩阵输入第l个图卷积层中进行处理，并得到第l个图卷积层输出的隐藏特征矩阵最终由第L个图卷积层输出隐藏特征矩阵步骤3.4、将所述隐藏特征矩阵输入所述softmax多分类层中，并利用式计算第α次迭代的分区概率Zα,t：式中，为第α次迭代的图卷积神经网络中第L层的权重矩阵；步骤3.5、利用式得到第α次迭代的预分区标识向量式中，zα,t,i,c为第α次迭代的图卷积神经网络输出的第i个顶点vi分配到第c个分区的概率，rα,t,i*为第t组分区标识向量中第i个顶点vi被划分到的区域编号；步骤3.6、将所述第α次迭代的预分区标识向量与分区标识向量R作差，得到第t组训练样本Traint在第α次迭代的误差eα,t；步骤3.7、将t+1赋值给t，判断t＞T是否成立，若成立，则表示第α次迭代的图卷积神经网络已完成对T组的训练样本集的训练，并执行步骤3.8；否则，返回步骤3.3顺序执行；步骤3.8、利用式计算第α次迭代的图卷积神经网络中的均方误差损失函数eα；步骤3.9、判断eα＜e0且α＞αmax是否成立；若成立，则将第α次迭代的图卷积神经网络作为最优模型；否则，将α+1赋值给α后，根据梯度下降反向传播算法更新后得到第α次迭代图卷积神经网络参数，并返回步骤3.2顺序执行；其中，e0是人工设定误差阈值；步骤四、主动配电网的网络分区；以主动配电网中实时获取的拓扑以及各个节点的特征数据作为输入，从而利用所述最优模型得到主动配电网的网络分区结果。
说明书desc
技术领域本发明涉及主动配电网分区领域，具体地说是一种基于图卷积神经网络的面向主动配电网的网络分区方法，无需建立并求解复杂的主动配电网分区数学优化模型，即可得到最佳分区拓扑。背景技术主动配电网是一种高度集成，完全互连且具有通信功能的电气系统。与传统的配电网相比，主动配电网采用主动管理分布式发电、储能设备、客户双向负荷的模式，能够灵活调节网络拓扑、主动优化控制无功补偿装置，使分布式柔性技术的实现更加高效。然而，随着配电网络结构变得越来越复杂，主动配电网的分析和监控变得越来越困难。合理划分主动配电网可以简化网络结构，使区域电网的运行、控制和管理能够科学有效地进行。同时，配电网分区可以实现空间负载均衡，为储能装置、分布式发电设备等分布式资源的优化区域分配和管理提供视角。传统的主动配电网分区主要运用如Tabu搜索法、模拟退火法、遗传算法和禁忌搜索算法等数学方法，其主旨是对各节点组合优化。然而，这样的划分往往不太关注网络结构，不能准确反映网格组件之间的状态相关性。与此同时，其解空间的组合爆炸增加了求解的复杂度。因此，近年来传统的图划分算法与进化算法相结合的混合方法被应用到主动配电网分区当中。三峡大学阮建雄等提出了一种基于谱聚类的含分布式电源配电网孤岛划分策略。该方案结合复杂网络社团发现的原理通过谱聚类算法将系统划分为各子系统，该方法根据电网拓扑Laplace矩阵的第一小非平凡特征向量和第二小非平凡特征向量，将网络拓扑关系映射到由第一小非平凡特征向量和第二小非平凡特征向量构成的空间。然后通过聚类算法将构成空间中各节点对应的元素进行聚类，形成内部结构紧凑、电气联系紧密的各子系统。最后，建立负荷恢复范围优化模型，保证在各子系统中利用有限的电源功率恢复更多更重要的负荷，完成孤岛划分。但是此方案无法跟踪负载、分布式发电设备功率的实时变化而调整分区结果，无法保证方法的普适性。国网河北省电力有限公司孙利强等提出了一种促进主动配电网高效运维的虚拟微网分区划分方法，该算法以虚拟微网分区的形式简化主动配电网的运行控制。该方法以通信成本最低、分区功率不平衡最小及分区供电独立性最高为目标，建立主动配电网微网虚拟分区优化模型。基于广度优先搜索算法获取各分区信息，提出主动配电网微网化虚拟分区方法，将主动配电网划分为多个虚拟微网分区，将主动配电网划分为多个虚拟微电网，充分利用了微电网高度自治性和可以孤岛运行的特点，显著降低了主动配电网运行控制的维度和复杂度，提高了主动配电系统的可控性。并且在紧急情况下，各微网分区可以孤岛运行，降低事故对电网造成的损害，显著提升电网的可靠性。但是此方案数学模型复杂，计算复杂度较高，受分布式发电设备间歇性行为影响较大。发明内容本发明是为避免上述现有技术所存在的不足之处，提供一种一种基于图卷积网络的主动配电网分区方法，以期能在无需建立并求解复杂的主动配电网分区数学优化模型的情况下，即可得到最佳分区结果，以降低时间成本，从而使主动配电网的运行、控制、管理指令能够及时地生效，并能提高电压质量。本发明为解决技术问题采用如下技术方案：本发明一种基于图卷积网络的主动配电网分区方法，是应用于包含多种分布式发电设备与可调负载的主动配电网中；所述主动配电网的拓扑由N个节点组成；每个节点包含M个特征属性；其特点是，所述网络分区方法是按如下步骤进行：步骤一、获取所述主动配电网的拓扑、各个节点的历史特征数据以及相对应的历史分区方案，以生成训练样本数据；步骤1.1、以所述主动配电网中N个节点为图的顶点，设备的配电线路连接情况为图的边，建立无向图模型G＝；其中，V＝表示顶点集合；E＝{eij∣i∈,j∈,i≠j}表示边集合，vi表示第i个顶点，eij表示第i个顶点vi与第j个顶点vj间存在边；步骤1.2、利用式获取主动配电网的无向图模型G的邻接矩阵A中的第i行第j列的元素aij，从而得到维数为N×N的邻接矩阵A＝{aij}；步骤1.3、根据各节点的历史特征数据，生成无向图模型G的T组特征矩阵，其中第t组特征矩阵记为Xt＝{xi,t|t∈,i∈}，1＜t＜T，xi,t表示第t组特征矩阵中第i个顶点vi的M个特征属性；步骤1.4、对所述无向图模型G中的第t组特征矩阵Xt进行标准差的标准化处理，从而得到第t组标准化后的特征矩阵Xt*；步骤1.5、将历史分区方案映射为T组分区标识向量，其中，第t组分区标识向量记为Rt＝{rt,i|t∈,i∈}，其中，rt,i表示第t组分区标识向量中第i个顶点vi被划分到的区域编号，1＜rt,i＜C，其中，C为主动配电网的分区总数；步骤1.6、由第t组标准化后的特征矩阵Xt*和第t组分区标识向量Rt构成第t组训练样本Traint＝{Xt*,Rt}；从而得到共T组的训练样本集Train＝{Traint|t∈}；步骤二、构建图卷积神经网络，包括：L个图卷积层和1个softmax多分类层；步骤三、训练图卷积神经网络；步骤3.1、定义网络当前迭代次数为α，并初始化α＝1；最大迭代次数为αmax；对所述网络中各层的参数进行第α次随机初始化，从而得到第α次迭代的图卷积神经网络；步骤3.2、定义变量t，初始化t＝1；步骤3.3、初始化l＝1；当l＝1时，将所述邻接矩阵A与第t组标准化后的特征矩阵输入到第α次迭代的图卷积神经网络中，并经过第l个图卷积层运算，从而利用式-式得到经过第l个图卷积层输出的隐藏特征矩阵式-式中，I是单位对角矩阵，为加入自循环的邻接矩阵，为相应的度矩阵，为加入自循环的邻接矩阵中第i行第j列的元素，为相应的度矩阵中第i行第i列的元素；φ为图卷积层的信息聚合函数；为第α次迭代的图卷积神经网络中第l-1层的权重矩阵，当l＝1时，令表示经过第l-1个图卷积层输出的隐藏特征矩阵，当l＝1时，令当l＝2,3,…,L时，将第l-1个图卷积层输出的隐藏特征矩阵输入第l个图卷积层中进行处理，并得到第l个图卷积层输出的隐藏特征矩阵最终由第L个图卷积层输出隐藏特征矩阵步骤3.4、将所述隐藏特征矩阵输入所述softmax多分类层中，并利用式计算第α次迭代的分区概率Zα,t：式中，为第α次迭代的图卷积神经网络中第L层的权重矩阵；步骤3.5、利用式得到第α次迭代的预分区标识向量式中，zα,t,i,c为第α次迭代的图卷积神经网络输出的第i个顶点vi分配到第c个分区的概率，rα,t,i*为第t组分区标识向量中第i个顶点vi被划分到的区域编号；步骤3.6、将所述第α次迭代的预分区标识向量与分区标识向量R作差，得到第t组训练样本Traint在第α次迭代的误差eα,t；步骤3.7、将t+1赋值给t，判断t＞T是否成立，若成立，则表示第α次迭代的图卷积神经网络已完成对T组的训练样本集的训练，并执行步骤3.8；否则，返回步骤3.3顺序执行；步骤3.8、利用式计算第α次迭代的图卷积神经网络中的均方误差损失函数eα；步骤3.9、判断eα＜e0且α＞αmax是否成立；若成立，则将第α次迭代的图卷积神经网络作为最优模型；否则，将α+1赋值给α后，根据梯度下降反向传播算法更新后得到第α次迭代图卷积神经网络参数，并返回步骤3.2顺序执行；其中，e0是人工设定误差阈值；步骤四、主动配电网的网络分区；以主动配电网中实时获取的拓扑以及各个节点的特征数据作为输入，从而利用所述最优模型得到主动配电网的网络分区结果。与已有技术相比，本发明有益效果体现在：1、本发明提出的网络分区方法不需要建立并求解复杂的主动配电网分区数学优化模型，因此，能在分布式发电设备的间歇性出力及其连接/断开、网络重新配置操作等行为发生后，根据节点特征数据的变化迅速产生相应的分区方案，从而能使主动配电网运行控制效果更优。2、本发明采用图卷积神经网络实现主动配电网分区分区求解，充分考虑了电网的结构特征与节点自身的信息特征，从而提高了分区结果的可靠性性与准确度。3、本发明只需要现存的主动配电网拓扑数据与节点历史特征数据即可实现，无需额外安装数据采集装置，可以在现有的配电系统中实现，从而降低了硬件成本。附图说明图1为本发明中一种基于图卷积网络的主动配电网分区方法的流程图；图2为本发明中图卷积神经网络结构图。具体实施方式本实施例中，一种基于图卷积网络的主动配电网分区方法，是应用于包含多种分布式发电设备与可调负载的主动配电网中；主动配电网的拓扑由N个节点组成；每个节点包含M个特征属性；如图1所示，该网络分区方法是按如下步骤进行：步骤一、获取主动配电网的拓扑、各个节点的历史特征数据以及相对应的历史分区方案，以生成训练样本数据；步骤1.1、以主动配电网中N个节点为图的顶点，设备的配电线路连接情况为图的边，建立无向图模型G＝；其中，V＝表示顶点集合；E＝{eij∣i∈,j∈,i≠j}表示边集合，vi表示第i个顶点，eij表示第i个顶点vi与第j个顶点vj间存在边；本实施例中，N＝69；步骤1.2、利用式获取主动配电网的无向图模型G的邻接矩阵A中的第i行第j列的元素aij，从而得到维数为N×N的邻接矩阵A＝{aij}；步骤1.3、根据各节点的历史特征数据，生成无向图模型G的T组特征矩阵，其中第t组特征矩阵记为Xt＝{xi,t|t∈,i∈}，1＜t＜T，xi,t表示第t组特征矩阵中第i个顶点vi的M个特征属性；本实施例中，T＝200,M＝7,xi,t＝{Pi,t,Ci,t,Vi,t,RSSi,t,Pc,i,t,RBi,t,Li}，其中Pi,t为第t组特征矩阵中第i个顶点vi所消耗或发出的功率，Ci,t表示第t组特征矩阵中第i个顶点vi是否接入配电网，Vi,t为第t组特征矩阵中第i个顶点vi的电压，RSSi,t为第t组特征矩阵中第i个顶点vi的无线通信信号接收强度，Pc,i,t为第t组特征矩阵中第i个顶点vi的无线发射功率，RBi,t为第t组特征矩阵中第i个顶点vi被分配的通信资源，Li为第t组特征矩阵中第i个顶点vi的物理位置坐标；步骤1.4、对无向图模型G中的第t组特征矩阵Xt进行标准差的标准化处理，从而得到第t组标准化后的特征矩阵Xt*；步骤1.5、将历史分区方案映射为T组分区标识向量，其中，第t组分区标识向量记为Rt＝{rt,i|t∈,i∈}，其中，rt,i表示第t组分区标识向量中第i个顶点vi被划分到的区域编号，1＜rt,i＜C，其中，C为主动配电网的分区总数；本实施例中，C＝4；步骤1.6、由第t组标准化后的特征矩阵Xt*和第t组分区标识向量Rt构成第t组训练样本Traint＝{Xt*,Rt}；从而得到共T组的训练样本集Train＝{Traint|t∈}；步骤二、构建图卷积神经网络，如图2所示，包括：L个图卷积层和1个softmax多分类层；本实施例中，L＝3；步骤三、训练图卷积神经网络；步骤3.1、定义网络当前迭代次数为α，并初始化α＝1；最大迭代次数为αmax；对网络中各层的参数进行第α次随机初始化，从而得到第α次迭代的图卷积神经网络；本实施例中，αmax＝200；步骤3.2、定义变量t，初始化t＝1；步骤3.3、初始化l＝1；当l＝1时，将邻接矩阵A与第t组标准化后的特征矩阵输入到第α次迭代的图卷积神经网络中，并经过第l个图卷积层运算，从而利用式-式得到经过第l个图卷积层输出的隐藏特征矩阵式-式中，I是单位对角矩阵，为加入自循环的邻接矩阵，为相应的度矩阵，为加入自循环的邻接矩阵中第i行第j列的元素，为相应的度矩阵中第i行第i列的元素；φ为图卷积层的信息聚合函数；为第α次迭代的图卷积神经网络中第l-1层的权重矩阵，当l＝1时，令表示经过第l-1个图卷积层输出的隐藏特征矩阵，当l＝1时，令当l＝2,3,…,L时，将第l-1个图卷积层输出的隐藏特征矩阵输入第l个图卷积层中进行处理，并得到第l个图卷积层输出的隐藏特征矩阵最终由第L个图卷积层输出隐藏特征矩阵步骤3.4、将隐藏特征矩阵输入softmax多分类层中，并利用式计算第α次迭代的分区概率Zα,t：式中，为第α次迭代的图卷积神经网络中第L层的权重矩阵；步骤3.5、利用式得到第α次迭代的预分区标识向量式中，zα,t,i,c为第α次迭代的图卷积神经网络输出的第i个顶点vi分配到第c个分区的概率，rα,t,i*为第t组分区标识向量中第i个顶点vi被划分到的区域编号；步骤3.6、将第α次迭代的预分区标识向量与分区标识向量R作差，得到第t组训练样本Traint在第α次迭代的误差eα,t；步骤3.7、将t+1赋值给t，判断t＞T是否成立，若成立，则表示第α次迭代的图卷积神经网络已完成对T组的训练样本集的训练，并执行步骤3.8；否则，返回步骤3.3顺序执行；步骤3.8、利用式计算第α次迭代的图卷积神经网络中的均方误差损失函数eα；步骤3.9、判断eα＜e0且α＞αmax是否成立；若成立，则将第α次迭代的图卷积神经网络作为最优模型；否则，将α+1赋值给α后，根据梯度下降反向传播算法更新后得到第α次迭代图卷积神经网络参数，并返回步骤3.2顺序执行；其中，e0是人工设定误差阈值；步骤四、主动配电网的网络分区；以主动配电网中实时获取的拓扑以及各个节点的特征数据作为输入，从而利用最优模型得到主动配电网的网络分区结果。
