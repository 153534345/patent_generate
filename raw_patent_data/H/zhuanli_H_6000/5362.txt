标题title
计及出力相关性的配电网电压风险识别方法、装置及设备
摘要abst
本发明公开了计及出力相关性的配电网电压风险识别方法、装置及设备，配电网电压风险识别方法包括：获取光伏出力的历史数据，采用局部密度中心法进行聚类分析，给出各类光伏出力场景；基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型；采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。本发明可以综合考虑各种不确定性因素对系统运行稳定性的影响，进而对运行薄弱点和潜在风险进行全面分析，更适合应用于配网电压风险识别。
权利要求书clms
1.一种计及出力相关性的配电网电压风险识别方法，其特征在于，具体包括如下步骤：获取光伏出力的历史数据，采用局部密度中心法进行聚类分析，给出各类光伏出力场景；基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型；采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。2.如权利要求1所述计及出力相关性的配电网电压风险识别方法，其特征在于，光伏出力的历史数据包多个时间点下配电网多个节点的负荷和光伏出力功率。3.如权利要求1所述计及出力相关性的配电网电压风险识别方法，其特征在于，采用局部密度中心法进行聚类分析，给出各类光伏出力场景，具体包括如下步骤：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。4.如权利要求3所述计及出力相关性的配电网电压风险识别方法，其特征在于，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心，具体包括如下步骤：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度，具体表示为：；；其中，I为i点的聚类度，截断距离，/＞为i点到j点的距离，min为取最小值函数；比较各个数据点的聚类度及预设阈值，确定聚类中心。5.如权利要求2所述计及出力相关性的配电网电压风险识别方法，其特征在于，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，具体包括如下步骤：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。6.如权利要求5所述计及出力相关性的配电网电压风险识别方法，其特征在于，每类光伏出力场景的边缘概率分布函数，具体表示为：；其中，f为第i类场景中光伏出力功率数据的边缘概率分布，pi为第i类场景中的光伏出力功率数据，n为光伏出力功率数据的总量，h为核函数的带宽，pi,j为第i类场景中的第j个光伏出力功率数据，K为高斯核函数。7.如权利要求6所述计及出力相关性的配电网电压风险识别方法，其特征在于，高斯核函数具体为：；其中，K为高斯核函数，pi为第i类场景中的光伏出力功率数据，h为核函数的带宽，pi,j为第i类场景中的第j个光伏出力功率数据。8.如权利要求6所述计及出力相关性的配电网电压风险识别方法，其特征在于，建立场景概率模型，具体表示为：；其中，为第i类场景的场景概率，/＞为多维的场景概率模型函数，/＞为场景概率模型函数的反函数，/＞为第i类场景中光伏出力功率数据的边缘概率分布。9.如权利要求8所述计及出力相关性的配电网电压风险识别方法，其特征在于，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布，具体包括如下步骤：采用极大似然方法对场景概率模型进行参数估计，给出对应的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。10.如权利要求9所述计及出力相关性的配电网电压风险识别方法，其特征在于，确定光伏出力目标样本，具体表示为：；其中，为第i类场景的第q个目标样本，/＞为第i类场景的场景概率函数的反函数，N为目标样本的总数。11.如权利要求9所述计及出力相关性的配电网电压风险识别方法，其特征在于，从光伏出力的历史数据中确定光伏出力目标样本之后，还包括：对目标样本的冗余数据进行消减，具体包括如下步骤：对于目标样本中的每一个样本pi=，定义其中两个样本之间的距离函数；对于每一个样本pi，计算该样本与其余样本之间的距离函数；取pi与其他样本之间距离的最小值Dmin，具体表示为：Dmin=min{D}，d=1,2,...,m，d≠i；定义总体评估函数作为剔除的依据，对所有样本的总体评估函数排序，剔除所有样本中总体评估函数最小的一个样本；重复步骤取距离最小值和剔除的步骤，直至剩余样本数量达到数据削减预先设定的要求。12.如权利要求11所述计及出力相关性的配电网电压风险识别方法，其特征在于，两个样本之间的距离函数，具体表示为：；其中，D为两个样本之间的距离函数，pa、pb分别为两个样本。13.如权利要求11所述计及出力相关性的配电网电压风险识别方法，其特征在于，总体评估函数，具体为：；其中，F为总体评估函数。14.一种计及出力相关性的配电网电压风险识别装置，其特征在于，采用如权利要求1-13任一所述计及出力相关性的配电网电压风险识别方法，包括：采集单元，用于获取光伏出力的历史数据；分析单元，用于采用局部密度中心法进行聚类分析，给出各类光伏出力场景，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；判定单元，用于分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。15.一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至13中任意一项所述计及出力相关性的配电网电压风险识别方法。
说明书desc
技术领域本发明属于配电网技术领域，具体涉及计及出力相关性的配电网电压风险识别方法、装置及设备。背景技术对分布式电源接入系统后的电压质量影响做出客观而且科学的评估，是建设可持续发展的配电系统的有利基础，科学的评估结果能够在系统规划与建设中提供科学的引导。由于配电网中负荷和光伏发电量存在随机性波动，传统配电自动化系统中确定性潮流计算功能很大程度上不能满足对配网系统电压风险的分析需求。如专利CN110707700A公开一种考虑分布式电源时空特性的配电网潮流计算方法，是采用前推回代法，先假定各节点电压为根节点电压，从末端节点开始，根据已知的各节点负荷功率、各节点电压，向辐射网络始端推算各支路的电流或各支路的始端功率；然后根据根节点的电压和求得的各支路的电流或各支路的始端功率，向末端推算各节点电压，重复以上过程直至完成迭代。其虽然可以改善传统的配电网潮流计算的局限性，可以用来评估有源配电网中分布式电源接入后对配电系统所产生的影响，同时也可以分析分布式电源对电网静态稳定性的影响。但是其仍无法综合考虑各种不确定性因素对系统运行稳定性的影响，进而无法应用于配网电压风险识别。因此，如何考虑各种不确定性因素对系统运行稳定性的影响，以实现对运行薄弱点和潜在风险进行全面分析，使其可以应用于配网电压风险识别是本领域技术人员亟待解决的问题。发明内容针对上述现有技术中存在的缺陷，本发明提供了一种计及出力相关性的配电网电压风险识别方法、装置及设备，通过获取光伏出力的历史数据，采用局部密度中心法进行聚类分析，给出各类光伏出力场景；基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型；采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。可以综合考虑各种不确定性因素对系统运行稳定性的影响，进而对运行薄弱点和潜在风险进行全面分析，更适合应用于配网电压风险识别。第一方面，本发明提供一种计及出力相关性的配电网电压风险识别方法，具体包括如下步骤：获取光伏出力的历史数据，采用局部密度中心法进行聚类分析，给出各类光伏出力场景；基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型；采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。进一步的，光伏出力的历史数据包多个时间点下配电网多个节点的负荷和光伏出力功率。进一步的，采用局部密度中心法进行聚类分析，给出各类光伏出力场景，具体包括如下步骤：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。进一步的，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心，具体包括如下步骤：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度，具体表示为：其中，I为i点的聚类度，截断距离，为i点到j点的距离，min为取最小值函数；比较各个数据点的聚类度及预设阈值，确定聚类中心。进一步的，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，具体包括如下步骤：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。进一步的，每类光伏出力场景的边缘概率分布函数，具体表示为：其中，f为第i类场景中光伏出力功率数据的边缘概率分布，pi为第i类场景中的光伏出力功率数据，n为光伏出力功率数据的总量，h为核函数的带宽，pi,j为第i类场景中的第j个光伏出力功率数据，K为高斯核函数。进一步的，建立场景概率模型，具体表示为：其中，为第i类场景的场景概率，为多维的场景概率模型函数，为场景概率模型函数的反函数，为第i类场景中光伏出力功率数据的边缘概率分布。进一步的，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布，具体包括如下步骤：采用极大似然方法对场景概率模型进行参数估计，给出对应的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。进一步的，确定光伏出力目标样本，具体表示为：其中，为第i类场景的第q个目标样本，为第i类场景的场景概率函数的反函数，N为目标样本的总数。进一步的，从光伏出力的历史数据中确定光伏出力目标样本之后，还包括：对目标样本的冗余数据进行消减，具体包括如下步骤：对于目标样本中的每一个样本pi=，定义其中两个样本之间的距离函数；对于每一个样本pi，计算该样本与其余样本之间的距离函数；取pi与其他样本之间距离的最小值Dmin，具体表示为：Dmin=min{D}，d=1,2,...,m，d≠i；定义总体评估函数作为剔除的依据，对所有样本的总体评估函数排序，剔除所有样本中总体评估函数最小的一个样本；重复步骤取距离最小值和剔除的步骤，直至剩余样本数量达到数据削减预先设定的要求。进一步的，两个样本之间的距离函数，具体表示为：其中，D为两个样本之间的距离函数，pa、pb分别为两个样本。进一步的，总体评估函数，具体为：其中，F为总体评估函数。第二方面，本发明还提供一种计及出力相关性的配电网电压风险识别装置，采用上述计及出力相关性的配电网电压风险识别方法，包括：采集单元，用于获取光伏出力的历史数据；分析单元，用于采用局部密度中心法进行聚类分析，给出各类光伏出力场景，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；判定单元，用于分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。分析单元包括：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。分析单元还包括：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度；比较各个数据点的聚类度及预设阈值，确定聚类中心。分析单元还包括：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。分析单元还包括：采用极大似然方法对场景概率模型进行参数估计，给出满足条件的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。进一步的，光伏出力的历史数据包多个时间点下配电网多个节点的负荷和光伏出力功率。进一步的，采用局部密度中心法进行聚类分析，给出各类光伏出力场景，具体包括如下步骤：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。进一步的，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心，具体包括如下步骤：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度，具体表示为：其中，I为i点的聚类度，截断距离，为i点到j点的距离，min为取最小值函数；比较各个数据点的聚类度及预设阈值，确定聚类中心。进一步的，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，具体包括如下步骤：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。进一步的，每类光伏出力场景的边缘概率分布函数，具体表示为：其中，f为第i类场景中光伏出力功率数据的边缘概率分布，pi为第i类场景中的光伏出力功率数据，n为光伏出力功率数据的总量，h为核函数的带宽，pi,j为第i类场景中的第j个光伏出力功率数据，K为高斯核函数。进一步的，建立场景概率模型，具体表示为：其中，为第i类场景的场景概率，为多维的场景概率模型函数，为场景概率模型函数的反函数，为第i类场景中光伏出力功率数据的边缘概率分布。进一步的，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布，具体包括如下步骤：采用极大似然方法对场景概率模型进行参数估计，给出对应的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。进一步的，确定光伏出力目标样本，具体表示为：其中，为第i类场景的第q个目标样本，为第i类场景的场景概率函数的反函数，N为目标样本的总数。进一步的，从光伏出力的历史数据中确定光伏出力目标样本之后，还包括：对目标样本的冗余数据进行消减，具体包括如下步骤：对于目标样本中的每一个样本pi=，定义其中两个样本之间的距离函数；对于每一个样本pi，计算该样本与其余样本之间的距离函数；取pi与其他样本之间距离的最小值Dmin，具体表示为：Dmin=min{D}，d=1,2,...,m，d≠i；定义总体评估函数作为剔除的依据，对所有样本的总体评估函数排序，剔除所有样本中总体评估函数最小的一个样本；重复步骤取距离最小值和剔除的步骤，直至剩余样本数量达到数据削减预先设定的要求。进一步的，两个样本之间的距离函数，具体表示为：其中，D为两个样本之间的距离函数，pa、pb分别为两个样本。进一步的，总体评估函数，具体为：其中，F为总体评估函数。第三方面，本发明还提供一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述任意一项所述方法。本发明提供的计及出力相关性的配电网电压风险识别方法、装置及设备，至少包括如下有益效果：利用聚类算法，获取各个光伏发电系统具有差异性的发电曲线簇，每簇利用核估计法建立概率密度函数，并且抽样时考虑各簇的概率特征，建立一个精确的光伏发电系统模型。利用所生成场景，以及光伏发电系统模型，进行配电网潮流计算并评估该条线路上各节点的电压越限概率。最终可以综合考虑各种不确定性因素对系统运行稳定性的影响，进而对运行薄弱点和潜在风险进行全面分析，更适合应用于配网电压风险识别。附图说明图1为本发明提供的一种计及出力相关性的配电网电压风险识别方法的流程示意图；图2为本发明提供的某一实施例的给出各类光伏出力场景的流程示意图；图3为本发明提供的某一实施例的建立场景概率模型的流程示意图；图4为本发明提供的某一实施例的获取配电网电压分布的流程示意图；图5为本发明提供的一种计及出力相关性的配电网电压风险识别装置的结构示意图。具体实施方式为了更好的理解上述技术方案，下面将结合说明书附图以及具体的实施方式对上述技术方案做详细的说明。显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。在本发明实施例中使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本发明。在本发明实施例和所附权利要求书中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义，“多种”一般包含至少两种。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的商品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种商品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的商品或者装置中还存在另外的相同要素。含分布式电源的配电网运行时存在大量的不确定因素，线路上配变的负荷与分布式电源的出力具有很大的不确定性。此时若仅仅分析馈线在任意一个断面下线路节点的电压分布情况，往往不具有代表性，不能反映出该馈线潜在的电压越限风险。对于难以用数学模型准确描述的负荷波动与光伏电源出力不确定性，可以将分布式电源出力与负荷根据数值大小分解成多个可能出现的极端场景，每个场景将有唯一的光伏出力值与配变负荷分布。将不确定性问题转化为确定的场景组合来解决，通过分析讨论极端情况下馈线电压的分布情况来决定光伏出力限制以及系统的无功补偿方案。如图1所示，本发明提供一种计及出力相关性的配电网电压风险识别方法，具体包括如下步骤：获取光伏出力的历史数据，采用局部密度中心法进行聚类分析，给出各类光伏出力场景；基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型；采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。其中，光伏出力的历史数据包多个时间点下配电网多个节点的负荷和光伏出力功率。本发明充分考虑分布式电源出力的特点来建立场景，既可以避免过多的场景使得计算量增大，又能规避过少的场景无法完全反映分布式电源出力的特点，场景数适当选取。值得注意的是，配电网负荷与分布式电源出力在同一时间点具有内在关联性，因此，在提取季节性典型断面时，需要将每个时间断面下各节点的负荷与光伏出力看成是一个馈线断面负荷向量，季节性典型断面生成就是从包含若干个负荷向量中抽取具有典型特征的向量。本发明基于W-GAN框架，利用历史数据，模拟历史光伏出力序列可能具有的多种形态，如负荷的增加、减少、突变等，从而产生具有不同形态特征的负序列。基于这个方法生成的配电网初始场景质量高，具有足够的多样性。由于多光伏电场出力的复杂性，在不同出力场景下其相关性很有可能发生变化。针对这一特性，本发明对生成的数据使用基于局部密度中心的聚类方法，对于生成的每一类，利用核密度估计法和Copula函数将多光伏电站出力联合分布函数场景化，建立其场景概率模型。对该场景概率模型进行抽样，生成若干光伏出力典型场景，以供后续概率潮流计算需要。如图2所示，采用局部密度中心法进行聚类分析，给出各类光伏出力场景，具体包括如下步骤：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。本发明通过定义样本的局部密度作为聚类依据，可以自动生成类数和聚类中心并适用于非球面簇。该聚类分析的具体步骤如下：①对每个样本点i，定义每个样本点的局部密度函数。②定义每个样本点的距离偏量，其涵义为所有局部密度大于样本点i的样本点到i点的距离的最小值。③确定聚类中心，聚类中心需要满足：样本点本身的局部密度大，即周围点的密度应该小于样本点，同时和比它密度更大的点之间的距离，即样本的距离偏量应该尽可能的大。综合考虑以上条件，建立聚类度指标，当该聚类度指标大于设定的阈值，判定该点为一个聚类中心。④确定了聚类中心，需要对其余对样本点归类。首先，对样本点降序排列，对于样本点a，找到比它大的样本点中和它距离最近的那个样本点b，把样本点b的类别标号赋给样本点a。根据局部密度的降序依次给所有样本点进行类别赋值。⑤对每一个类中的点，需要先确定每个类的边界区域。在邻域内，存在着其他类的点，计算这样跨类的点对的平均局部密度，并取一个类的所有存在的跨类点对的平均局部密度的最大值作为该类的平均局部密度上界；然后对所有样本点进行一次标记，如果一个样本点的局部密度小于它所在类别的平均局部密度上界，则被标记为halo点，否则标记为core点；halo点是被抛弃的离群点。其中，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心，具体包括如下步骤：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度，具体表示为：其中，I为i点的聚类度，截断距离，为i点到j点的距离，min为取最小值函数；比较各个数据点的聚类度及预设阈值，确定聚类中心。如图3所示，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，具体包括如下步骤：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。本发明用非参数核密度估计法建立光伏出力水平的随机分布模型，从数据样本出发研究数据分布特征。边缘概率分布函数的核函数选取以0为中心的对称单峰概率密度函数，核密度估计中选用高斯核函数。具体的，每类光伏出力场景的边缘概率分布函数，具体表示为：其中，f为第i类场景中光伏出力功率数据的边缘概率分布，pi为第i类场景中的光伏出力功率数据，n为光伏出力功率数据的总量，h为核函数的带宽，pi,j为第i类场景中的第j个光伏出力功率数据，K为高斯核函数。高斯核函数具体为：。Copula函数能够将多维随机变量的联合分布函数与各自的边缘分布函数连接起来，主要用于描述随机变量之间的相关性。Copula函数模型的构造步骤如下：①确定随机变量的边缘分布；②根据随机变量相关性特点，选取合适的Copula函数，以便能较好地描述随机变量之间的相关关系。Copula函数可以为高斯Copula函数、t-Copula函数、GumbelCopula函数、ClaytonCopula函数和FrankCopula函数等；③根据已选择的Copula函数，估计Copula模型中的未知参数，针对以上步骤，使用核密度估计的结果作为随机变量的边缘分布，采用高斯Copula函数模型描述出力的相关结构，并采用极大似然方法对该高斯Copula函数模型进行参数估计，得到场景概率模型。进一步的，建立场景概率模型，具体表示为：其中，为第i类场景的场景概率，为多维的场景概率模型函数，为场景概率模型函数的反函数，为第i类场景中光伏出力功率数据的边缘概率分布。如图4所示，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布，具体包括如下步骤：采用极大似然方法对场景概率模型进行参数估计，给出对应的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。其中，确定光伏出力目标样本，具体表示为：其中，为第i类场景的第q个目标样本，为第i类场景的场景概率函数的反函数，N为目标样本的总数。本发明基于拉丁超立方采样方法对样本进行抽取，拉丁超立方采样方法分成以下两步：①采样。对每个输入随机变量进行采样，确保随机分布区域能够被采样点完全覆盖。②排列。改变各随机变量采样值的排列顺序，使相互独立的随机变量的采样值的相关性趋于最小。采样方法为：将场景概率模型的纵轴分成N个等间距不重叠的区间，即确定光伏出力目标样本。每一个随机变量的采样值排成矩阵的一行。当i个输入随机变量采样结束，所有的采样值形成一个i×N 阶的初始采样矩阵。随后进入下一步，排列各行采样点的顺序，消除行之间的相关性。在排列过程中先形成一个i×N阶的顺序矩阵，该顺序矩阵的每一行的元素值代表初始采样矩阵对应行的元素应该排列的位置。初始采样矩阵的元素排列后形成最终的采样矩阵。拉丁超立方采样优于随机采样的原因是它确保采样值能够覆盖输入随机变量的整个分布区间。对于相同的采样规模N，用随机采样和拉丁超立方采样得到的2个独立随机变量的联合覆盖空间百分比的期望值分别为：2×100%2×100%对于任何N≥2，后者的值总是比前者的值大，因此，拉丁超立方采样覆盖的输入随机变量的采样空间总是比随机采样的大。例如：当N=10，由以上2个式子得到的期望值分别为66.9%和81.0％。与传统的随机采样相比，拉丁超立方采样具有如下优越性：在采样规模相同的情况下，误差有很大改善；误差收敛的稳健性比随机采样好，可以得到较为稳定的收敛精度，并且，拉丁超立方采样在估计输出随机变量的期望值时特别有效。在确定光伏出力目标样本后，还需要对冗余数据进行削减。对于若干样本，如果两个样本距离非常接近，则可以考虑用其中一个样本替代，因此可以定义一个样本的距离函数作为剔除冗余数据的依据；同理，如果一个样本发生的概率过低，则可以考虑剔除这个样本。因此定义一个样本的概率函数作为剔除冗余数据的依据。综合考虑两方面因素，可以定义一个总体评估函数，作为剔除的依据。即本发明采用基于距离函数的冗余数据削减方法进行实现。该基于距离函数的冗余数据削减方法，包括以下步骤：对于目标样本中的每一个样本pi=，定义其中两个样本之间的距离函数为：对于每一个样本pi，计算该样本与其余样本之间的距离函数；取pi与其他样本之间距离的最小值Dmin为：Dmin=min{D}，d=1,2,...,n，d≠i定义总体评估函数作为剔除的依据，具体为：对所有样本的总体评估函数排序，剔除所有样本中总体评估函数最小的一个样本。重复步骤取距离最小值和剔除的步骤，直至剩余样本数量达到数据削减预先设定的要求。本发明在实现冗余数据的削减后，可以基于蒙特卡洛方法实现概率潮流计算。具体的，蒙特卡洛模拟法以随机模拟和统计实验为手段，是一种从随机变量的概率分布中，通过随机选择数字的方法产生一种符合该随机变量概率分布特性的随机数值序列，作为输入变量序列进行特定分析的求解方法。其计算步骤包括:①对潮流方程的输入变量W构造相应的概率模型；②产生随机数序列，作为系统的抽样输入进行大量的数字模拟，每一组采样值通过潮流计算得到相应的模拟实验值；③系统计算，对模拟实验结果进行统计处理，给出所求问题的解。蒙特卡洛模拟的优点在于样本数量足够大时，计算结果足够精确；并且计算量一般不受系统规模的影响，该方法的抽样次数与抽样精度的平方成反比。缺点在于为提高计算精度，往往需要提高系统抽样规模，从而导致计算时长过大。因此，本发明通过预先对冗余数据的消减，可以在提高计算精度的基础上，降低抽样的规模，减小计算时长。本发明使用了基于蒙特卡洛方法的模拟法。针对传统的模拟法存在计算时间过长，难以实际运行的缺点，为了缩减计算时间，采用了拉丁超立方采样方法和基于距离函数的冗余数据削减方法，争取在缩减样本数量的同时较好保了留原有样本集的特征。最终根据潮流计算的结果，可以对配电网各个节点在不同场景下的电压质量进行分析，计算电压越限概率。本发明利用聚类算法，获取各个光伏发电系统具有差异性的发电曲线簇，每簇利用核估计法建立概率密度函数，并且抽样时考虑各簇的概率特征，建立一个精确的光伏发电系统模型。利用所生成场景，以及上述建立的学习模型，进行配电网潮流计算并评估该条线路上各节点的电压越限概率。最终可以综合考虑各种不确定性因素对系统运行稳定性的影响，进而对运行薄弱点和潜在风险进行全面分析，因此更适合应用于配网电压风险识别。如图5所示，本发明还提供一种计及出力相关性的配电网电压风险识别装置，采用上述计及出力相关性的配电网电压风险识别方法，包括：采集单元，用于获取光伏出力的历史数据；分析单元，用于采用局部密度中心法进行聚类分析，给出各类光伏出力场景，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；判定单元，用于分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。分析单元包括：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。分析单元还包括：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度；比较各个数据点的聚类度及预设阈值，确定聚类中心。分析单元还包括：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。分析单元还包括：采用极大似然方法对场景概率模型进行参数估计，给出对应的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。进一步的，光伏出力的历史数据包多个时间点下配电网多个节点的负荷和光伏出力功率。进一步的，采用局部密度中心法进行聚类分析，给出各类光伏出力场景，具体包括如下步骤：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。进一步的，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心，具体包括如下步骤：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度，具体表示为：其中，I为i点的聚类度，截断距离，为i点到j点的距离，min为取最小值函数；比较各个数据点的聚类度及预设阈值，确定聚类中心。进一步的，基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，具体包括如下步骤：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。进一步的，每类光伏出力场景的边缘概率分布函数，具体表示为：其中，f为第i类场景中光伏出力功率数据的边缘概率分布，pi为第i类场景中的光伏出力功率数据，n为光伏出力功率数据的总量，h为核函数的带宽，pi,j为第i类场景中的第j个光伏出力功率数据，K为高斯核函数。进一步的，建立场景概率模型，具体表示为：其中，为第i类场景的场景概率，为多维的场景概率模型函数，为场景概率模型函数的反函数，为第i类场景中光伏出力功率数据的边缘概率分布。进一步的，采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布，具体包括如下步骤：采用极大似然方法对场景概率模型进行参数估计，给出对应的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。进一步的，确定光伏出力目标样本，具体表示为：其中，为第i类场景的第q个目标样本，为第i类场景的场景概率函数的反函数，N为目标样本的总数。进一步的，从光伏出力的历史数据中确定光伏出力目标样本之后，还包括：对目标样本的冗余数据进行消减，具体包括如下步骤：对于目标样本中的每一个样本pi=，定义其中两个样本之间的距离函数；对于每一个样本pi，计算该样本与其余样本之间的距离函数；取pi与其他样本之间距离的最小值Dmin，具体表示为：Dmin=min{D}，d=1,2,...,m，d≠i；定义总体评估函数作为剔除的依据，对所有样本的总体评估函数排序，剔除所有样本中总体评估函数最小的一个样本；重复步骤取距离最小值和剔除的步骤，直至剩余样本数量达到数据削减预先设定的要求。进一步的，两个样本之间的距离函数，具体表示为：其中，D为两个样本之间的距离函数，pa、pb分别为两个样本。进一步的，总体评估函数，具体为：其中，F为总体评估函数。本发明中还提供一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述任意一项所述计及出力相关性的配电网电压风险识别方法。具体来说，计算机设备可以包括一个或多个处理设备，诸如一个或多个中央处理单元，每个处理单元可以实现一个或多个硬件线程。计算机设备还可以包括任何存储资源，其用于存储诸如代码、设置、数据等之类的任何种类的信息。非限制性的，比如，存储资源可以包括以下任一项或多种组合：任何类型的RAM，任何类型的ROM，闪存设备，硬盘，光盘等。更一般地，任何存储资源都可以使用任何技术来存储信息。进一步的，任何存储资源可以提供信息的易失性或非易失性保留。进一步地，任何存储资源可以表示计算机设备的固定或可移除部件。在一种情况下，当处理设备执行被存储在任何存储资源或存储资源的组合中的相关联的指令时，计算机设备可以执行相关联指令的任一操作。计算机设备还包括用于与任何存储资源交互的一个或多个驱动机构，诸如硬盘驱动机构、光盘驱动机构等。计算机设备还可以包括输入/输出模块，其用于接收各种输入和用于提供各种输出。一个具体输出机构可以包括呈现设备和相关联的图形用户接口。在其他实施例中，还可以不包括输入/输出模块、输入设备以及输出设备，仅作为网络中的一台计算机设备。计算机设备还可以包括一个或多个网络接口，其用于经由一个或多个通信链路与其他设备交换数据。一个或多个通信总线将上文所描述的部件耦合在一起。通信链路可以以任何方式实现，例如，通过局域网、广域网、点对点连接等、或其任何组合。通信链路可以包括由任何协议或协议组合支配的硬连线链路、无线链路、路由器、网关功能、名称服务器等的任何组合。处理器执行计算机程序时实现计及出力相关性的配电网电压风险识别方法时，配电网电压风险识别方法包括：获取光伏出力的历史数据，采用局部密度中心法进行聚类分析，给出各类光伏出力场景；基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型；采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布；分析各个光伏出力场景下的电压越限概率，完成计及出力相关性的配电网电压风险识别。其中，光伏出力的历史数据包多个时间点下配电网多个节点的负荷和光伏出力功率。本发明充分考虑分布式电源出力的特点来建立场景，既可以避免过多的场景使得计算量增大，又能规避过少的场景无法完全反映分布式电源出力的特点，场景数适当选取。值得注意的是，配电网负荷与分布式电源出力在同一时间点具有内在关联性，因此，在提取季节性典型断面时，需要将每个时间断面下各节点的负荷与光伏出力看成是一个馈线断面负荷向量，季节性典型断面生成就是从包含若干个负荷向量中抽取具有典型特征的向量。本发明基于W-GAN框架，利用历史数据，模拟历史光伏出力序列可能具有的多种形态，如负荷的增加、减少、突变等，从而产生具有不同形态特征的负序列。基于这个方法生成的配电网初始场景质量高，具有足够的多样性。由于多光伏电场出力的复杂性，在不同出力场景下其相关性很有可能发生变化。针对这一特性，本发明对生成的数据使用基于局部密度中心的聚类方法，对于生成的每一类，利用核密度估计法和Copula函数将多光伏电站出力联合分布函数场景化，建立其场景概率模型。对该场景概率模型进行抽样，生成若干光伏出力典型场景，以供后续概率潮流计算需要。采用局部密度中心法进行聚类分析，给出各类光伏出力场景，具体包括如下步骤：根据光伏出力的历史数据，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心；基于对各个聚类中心与对应跨类点的分析，给出各个聚类中心的归类边界，并对光伏出力的历史数据进行标记归类；根据确定的各个聚类中心和类数，给出对应的各类光伏出力场景。本发明通过定义样本的局部密度作为聚类依据，可以自动生成类数和聚类中心并适用于非球面簇。该聚类分析的具体步骤如下：①对每个样本点i，定义每个样本点的局部密度函数。②定义每个样本点的距离偏量，其涵义为所有局部密度大于样本点i的样本点到i点的距离的最小值。③确定聚类中心，聚类中心需要满足：样本点本身的局部密度大，即周围点的密度应该小于样本点，同时和比它密度更大的点之间的距离，即样本的距离偏量应该尽可能的大。综合考虑以上条件，建立聚类度指标，当该聚类度指标大于设定的阈值，判定该点为一个聚类中心。④确定了聚类中心，需要对其余对样本点归类。首先，对样本点降序排列，对于样本点a，找到比它大的样本点中和它距离最近的那个样本点b，把样本点b的类别标号赋给样本点a。根据局部密度的降序依次给所有样本点进行类别赋值。⑤对每一个类中的点，需要先确定每个类的边界区域。在邻域内，存在着其他类的点，计算这样跨类的点对的平均局部密度，并取一个类的所有存在的跨类点对的平均局部密度的最大值作为该类的平均局部密度上界；然后对所有样本点进行一次标记，如果一个样本点的局部密度小于它所在类别的平均局部密度上界，则被标记为halo点，否则标记为core点；halo点是被抛弃的离群点。其中，分析各个数据的局部密度及距离偏量，给出聚类度，确定聚类中心，具体包括如下步骤：获取每个数据的局部密度以及距离偏量，给出该数据点的聚类度，具体表示为：其中，I为i点的聚类度，截断距离，为i点到j点的距离，min为取最小值函数；比较各个数据点的聚类度及预设阈值，确定聚类中心。基于每类光伏出力场景中光伏出力的历史数据的相关性，通过非参数估计方式建立场景概率模型，具体包括如下步骤：基于光伏出力功率数据，确定核函数，通过非参数估计，给出每类光伏出力场景的边缘概率分布函数；以边缘概率分布函数为随机变量的边缘进行分析，构建高斯Copula函数模型，建立场景概率模型，描述每类光伏出力场景。本发明用非参数核密度估计法建立光伏出力水平的随机分布模型，从数据样本出发研究数据分布特征。边缘概率分布函数的核函数选取以0为中心的对称单峰概率密度函数，核密度估计中选用高斯核函数。具体的，每类光伏出力场景的边缘概率分布函数，具体表示为：其中，f为第i类场景中光伏出力功率数据的边缘概率分布，pi为第i类场景中的光伏出力功率数据，n为光伏出力功率数据的总量，h为核函数的带宽，pi,j为第i类场景中的第j个光伏出力功率数据，K为高斯核函数。高斯核函数具体为：。Copula函数能够将多维随机变量的联合分布函数与各自的边缘分布函数连接起来，主要用于描述随机变量之间的相关性。Copula函数模型的构造步骤如下：①确定随机变量的边缘分布；②根据随机变量相关性特点，选取合适的Copula函数，以便能较好地描述随机变量之间的相关关系。Copula函数可以为高斯Copula函数、t-Copula函数、GumbelCopula函数、ClaytonCopula函数和FrankCopula函数等；③根据已选择的Copula函数，估计Copula模型中的未知参数，针对以上步骤，使用核密度估计的结果作为随机变量的边缘分布，采用高斯Copula函数模型描述出力的相关结构，并采用极大似然方法对该高斯Copula函数模型进行参数估计，得到场景概率模型。进一步的，建立场景概率模型，具体表示为：其中，为第i类场景的场景概率，为多维的场景概率模型函数，为场景概率模型函数的反函数，为第i类场景中光伏出力功率数据的边缘概率分布。采用模拟法的概率潮流计算，给出光伏出力目标样本，并获取配电网的电压分布，具体包括如下步骤：采用极大似然方法对场景概率模型进行参数估计，给出对应的光伏出力场景；通过拉丁超立方采样法，结合给出的光伏出力场景，从光伏出力的历史数据中确定光伏出力目标样本；对光伏出力目标样本进行概率潮流计算，给出配电网的电压分布。其中，确定光伏出力目标样本，具体表示为：其中，为第i类场景的第q个目标样本，为第i类场景的场景概率函数的反函数，N为目标样本的总数。本发明基于拉丁超立方采样方法对样本进行抽取，拉丁超立方采样方法分成以下两步：①采样。对每个输入随机变量进行采样，确保随机分布区域能够被采样点完全覆盖。②排列。改变各随机变量采样值的排列顺序，使相互独立的随机变量的采样值的相关性趋于最小。采样方法为：将场景概率模型的纵轴分成N个等间距不重叠的区间，即确定光伏出力目标样本。每一个随机变量的采样值排成矩阵的一行。当i个输入随机变量采样结束，所有的采样值形成一个i×N 阶的初始采样矩阵。随后进入下一步，排列各行采样点的顺序，消除行之间的相关性。在排列过程中先形成一个i×N阶的顺序矩阵，该顺序矩阵的每一行的元素值代表初始采样矩阵对应行的元素应该排列的位置。初始采样矩阵的元素排列后形成最终的采样矩阵。拉丁超立方采样优于随机采样的原因是它确保采样值能够覆盖输入随机变量的整个分布区间。对于相同的采样规模N，用随机采样和拉丁超立方采样得到的2个独立随机变量的联合覆盖空间百分比的期望值分别为：2×100%2×100%对于任何N≥2，后者的值总是比前者的值大，因此，拉丁超立方采样覆盖的输入随机变量的采样空间总是比随机采样的大。例如：当N=10，由以上2个式子得到的期望值分别为66.9%和81.0％。与传统的随机采样相比，拉丁超立方采样具有如下优越性：在采样规模相同的情况下，误差有很大改善；误差收敛的稳健性比随机采样好，可以得到较为稳定的收敛精度，并且，拉丁超立方采样在估计输出随机变量的期望值时特别有效。在确定光伏出力目标样本后，还需要对冗余数据进行削减。对于若干样本，如果两个样本距离非常接近，则可以考虑用其中一个样本替代，因此可以定义一个样本的距离函数作为剔除冗余数据的依据；同理，如果一个样本发生的概率过低，则可以考虑剔除这个样本。因此定义一个样本的概率函数作为剔除冗余数据的依据。综合考虑两方面因素，可以定义一个总体评估函数，作为剔除的依据。即本发明采用基于距离函数的冗余数据削减方法进行实现。该基于距离函数的冗余数据削减方法，包括以下步骤：对于目标样本中的每一个样本pi=，定义其中两个样本之间的距离函数为：对于每一个样本pi，计算该样本与其余样本之间的距离函数；取pi与其他样本之间距离的最小值Dmin为：Dmin=min{D}，d=1,2,...,n，d≠i定义总体评估函数作为剔除的依据，具体为：对所有样本的总体评估函数排序，剔除所有样本中总体评估函数最小的一个样本。重复步骤取距离最小值和剔除的步骤，直至剩余样本数量达到数据削减预先设定的要求。本发明在实现冗余数据的削减后，可以基于蒙特卡洛方法实现概率潮流计算。具体的，蒙特卡洛模拟法以随机模拟和统计实验为手段，是一种从随机变量的概率分布中，通过随机选择数字的方法产生一种符合该随机变量概率分布特性的随机数值序列，作为输入变量序列进行特定分析的求解方法。其计算步骤包括:①对潮流方程的输入变量W构造相应的概率模型；②产生随机数序列，作为系统的抽样输入进行大量的数字模拟，每一组采样值通过潮流计算得到相应的模拟实验值；③系统计算，对模拟实验结果进行统计处理，给出所求问题的解。蒙特卡洛模拟的优点在于样本数量足够大时，计算结果足够精确；并且计算量一般不受系统规模的影响，该方法的抽样次数与抽样精度的平方成反比。缺点在于为提高计算精度，往往需要提高系统抽样规模，从而导致计算时长过大。因此，本发明通过预先对冗余数据的消减，可以在提高计算精度的基础上，降低抽样的规模，减小计算时长。本发明使用了基于蒙特卡洛方法的模拟法。针对传统的模拟法存在计算时间过长，难以实际运行的缺点，为了缩减计算时间，采用了拉丁超立方采样方法和基于距离函数的冗余数据削减方法，争取在缩减样本数量的同时较好保了留原有样本集的特征。最终根据潮流计算的结果，可以对配电网各个节点在不同场景下的电压质量进行分析，计算电压越限概率。利用聚类算法，获取各个光伏发电系统具有差异性的发电曲线簇，每簇利用核估计法建立概率密度函数，并且抽样时考虑各簇的概率特征，建立一个精确的光伏发电系统模型。利用所生成场景，以及光伏发电系统模型，进行配电网潮流计算并评估该条线路上各节点的电压越限概率。最终可以综合考虑各种不确定性因素对系统运行稳定性的影响，进而对运行薄弱点和潜在风险进行全面分析，更适合应用于配网电压风险识别。尽管已描述了本发明的优选实施例，但本领域内的技术人员一旦得知了基本创造性概念，则可对这些实施例作出另外的变更和修改。所以，所附权利要求意欲解释为包括优选实施例以及落入本发明范围的所有变更和修改。显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围之内，则本发明也意图包含这些改动和变型在内。
