标题title
UWB定位距离标定方法、装置、电子设备及存储介质
摘要abst
本发明提供了一种UWB定位距离标定方法、装置、电子设备及存储介质，涉及定位技术领域，本发明在进行UWB定位距离标定时，先获取UWB模块在多个固定位置采集的距离标定数据，该距离标定数据包括每个固定位置对应的一组计算距离值；然后根据距离标定数据，确定每个固定位置对应的平均距离值和相应校准系数；进而根据各个固定位置对应的平均距离值和相应校准系数，确定UWB模块对应的标定参数。这样可以基于得到的标定参数对UWB模块进行误差校正，提高定位精度。
权利要求书clms
1.一种UWB定位距离标定方法，其特征在于，包括：获取UWB模块在多个固定位置采集的距离标定数据，所述距离标定数据包括每个所述固定位置对应的一组计算距离值；根据所述距离标定数据，确定每个所述固定位置对应的平均距离值和相应校准系数；根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数；所述根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数，包括：根据各个所述固定位置对应的平均距离值和相应校准系数，确定距离值与校准系数对应的拟合函数；将所述拟合函数确定为所述UWB模块对应的标定参数。2.根据权利要求1所述的UWB定位距离标定方法，其特征在于，所述根据所述距离标定数据，确定每个所述固定位置对应的平均距离值和相应校准系数，包括：根据每个所述固定位置对应的一组计算距离值，确定每个所述固定位置对应的平均距离值；根据每个所述固定位置对应的平均距离值和预设的实际距离值，计算得到相应校准系数。3.根据权利要求2所述的UWB定位距离标定方法，其特征在于，所述根据每个所述固定位置对应的一组计算距离值，确定每个所述固定位置对应的平均距离值，包括：对于每个所述固定位置，确定该固定位置对应的一组计算距离值中数值最小的多个目标计算距离值；根据各个所述目标计算距离值对应的频数，对各个所述目标计算距离值进行加权平均计算，得到该固定位置对应的平均距离值；其中，加权平均计算时每个所述目标计算距离值的权重与其频数相关。4.根据权利要求1所述的UWB定位距离标定方法，其特征在于，所述根据各个所述固定位置对应的平均距离值和相应校准系数，确定距离值与校准系数对应的拟合函数，包括：以平均距离值为自变量，相应校准系数为因变量，对各个所述固定位置对应的平均距离值和相应校准系数进行多项式拟合，得到距离值与校准系数对应的拟合函数。5.根据权利要求1所述的UWB定位距离标定方法，其特征在于，在所述根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数之后，所述UWB定位距离标定方法还包括：获取所述UWB模块采集的当前距离值；根据所述标定参数，确定所述当前距离值对应的目标校准系数；基于所述目标校准系数对所述当前距离值进行校正，得到校正后距离值。6.根据权利要求1-5中任一项所述的UWB定位距离标定方法，其特征在于，所述多个固定位置包括预设距离范围内每隔预设距离间隔对应的多个位置。7.一种UWB定位距离标定装置，其特征在于，包括：数据获取模块，用于获取UWB模块在多个固定位置采集的距离标定数据，所述距离标定数据包括每个所述固定位置对应的一组计算距离值；第一确定模块，用于根据所述距离标定数据，确定每个所述固定位置对应的平均距离值和相应校准系数；第二确定模块，用于根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数；所述第二确定模块具体用于：根据各个所述固定位置对应的平均距离值和相应校准系数，确定距离值与校准系数对应的拟合函数；将所述拟合函数确定为所述UWB模块对应的标定参数。8.一种电子设备，包括存储器、处理器，所述存储器中存储有可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1-6中任一项所述的UWB定位距离标定方法。9.一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，其特征在于，所述计算机程序被处理器运行时执行权利要求1-6中任一项所述的UWB定位距离标定方法。
说明书desc
技术领域本发明涉及定位技术领域，尤其是涉及一种UWB定位距离标定方法、装置、电子设备及存储介质。背景技术超宽带无线通信技术是一种无载波通信技术。不用载波，而采用时间间隔极短的脉冲进行无线通信。UWB采用超宽带无线通信，脉冲频率高，可在室内、地下精准定位。定位精度是衡量UWB超宽带定位系统性能的最关键指标。影响UWB定位精度的因素较多，主要包括:多径效应、非视距传播、多址干扰、参考基站数量、参考基站位置和时钟同步误差等因素。所以在产品化的过程中，必须要对UWB模块进行校准。发明内容本发明的目的在于提供一种UWB定位距离标定方法、装置、电子设备及存储介质，以实现UWB模块的误差校正，提高定位精度。第一方面，本发明实施例提供了一种UWB定位距离标定方法，包括：获取UWB模块在多个固定位置采集的距离标定数据，所述距离标定数据包括每个所述固定位置对应的一组计算距离值；根据所述距离标定数据，确定每个所述固定位置对应的平均距离值和相应校准系数；根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数。进一步地，所述根据所述距离标定数据，确定每个所述固定位置对应的平均距离值和相应校准系数，包括：根据每个所述固定位置对应的一组计算距离值，确定每个所述固定位置对应的平均距离值；根据每个所述固定位置对应的平均距离值和预设的实际距离值，计算得到相应校准系数。进一步地，所述根据每个所述固定位置对应的一组计算距离值，确定每个所述固定位置对应的平均距离值，包括：对于每个所述固定位置，确定该固定位置对应的一组计算距离值中数值最小的多个目标计算距离值；根据各个所述目标计算距离值对应的频数，对各个所述目标计算距离值进行加权平均计算，得到该固定位置对应的平均距离值；其中，加权平均计算时每个所述目标计算距离值的权重与其频数相关。进一步地，所述根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数，包括：根据各个所述固定位置对应的平均距离值和相应校准系数，确定距离值与校准系数对应的拟合函数；将所述拟合函数确定为所述UWB模块对应的标定参数。进一步地，所述根据各个所述固定位置对应的平均距离值和相应校准系数，确定距离值与校准系数对应的拟合函数，包括：以平均距离值为自变量，相应校准系数为因变量，对各个所述固定位置对应的平均距离值和相应校准系数进行多项式拟合，得到距离值与校准系数对应的拟合函数。进一步地，在所述根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数之后，所述UWB定位距离标定方法还包括：获取所述UWB模块采集的当前距离值；根据所述标定参数，确定所述当前距离值对应的目标校准系数；基于所述目标校准系数对所述当前距离值进行校正，得到校正后距离值。进一步地，所述多个固定位置包括预设距离范围内每隔预设距离间隔对应的多个位置。第二方面，本发明实施例还提供了一种UWB定位距离标定装置，包括：数据获取模块，用于获取UWB模块在多个固定位置采集的距离标定数据，所述距离标定数据包括每个所述固定位置对应的一组计算距离值；第一确定模块，用于根据所述距离标定数据，确定每个所述固定位置对应的平均距离值和相应校准系数；第二确定模块，用于根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数。第三方面，本发明实施例还提供了一种电子设备，包括存储器、处理器，所述存储器中存储有可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现第一方面所述的UWB定位距离标定方法。第四方面，本发明实施例还提供了一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器运行时执行第一方面所述的UWB定位距离标定方法。本发明实施例提供的UWB定位距离标定方法、装置、电子设备及存储介质，在进行UWB定位距离标定时，先获取UWB模块在多个固定位置采集的距离标定数据，该距离标定数据包括每个固定位置对应的一组计算距离值；然后根据距离标定数据，确定每个固定位置对应的平均距离值和相应校准系数；进而根据各个固定位置对应的平均距离值和相应校准系数，确定UWB模块对应的标定参数。这样可以基于得到的标定参数对UWB模块进行误差校正，提高定位精度。附图说明为了更清楚地说明本发明具体实施方式或现有技术中的技术方案，下面将对具体实施方式或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的一种UWB定位距离标定方法的流程示意图；图2为本发明实施例提供的一种实际距离值为100cm时的一组计算距离值对应的频数分布图；图3为本发明实施例提供的一种平均距离值和相应校准系数的散点图；图4为本发明实施例提供的一种实际距离值为100cm时的一组校正后距离值对应的频数分布图；图5为本发明实施例提供的一种UWB定位距离标定装置的结构示意图；图6为本发明实施例提供的一种电子设备的结构示意图。具体实施方式下面将结合实施例对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。UWB模块实际是通过ToF来测距，主要利用信号在UWB模块的两个锚点之间的飞行时间来测量两个锚点间的距离。每个锚点从启动开始即会生成一条独立的时间戳，由此可以计算出脉冲信号在两个锚点之间的飞行时间，从而乘以光速c就能确定两个锚点之间的距离。由于UWB模块的定位精度会受到多径效应、非视距传播、多址干扰、参考基站数量、参考基站位置和时钟同步误差等多种因素的影响，因此需要对UWB模块进行校准。基于此，本发明实施例提供的一种UWB定位距离标定方法、装置、电子设备及存储介质，可以实现UWB模块的误差校正，提高定位精度。为便于对本实施例进行理解，首先对本发明实施例所公开的一种UWB定位距离标定方法进行详细介绍。本发明实施例提供了一种UWB定位距离标定方法，该方法可以由具有数据处理能力的电子设备执行。参见图1所示的一种UWB定位距离标定方法的流程示意图，该方法主要包括如下步骤S102、步骤S104和步骤S106：步骤S102，获取UWB模块在多个固定位置采集的距离标定数据，该距离标定数据包括每个固定位置对应的一组计算距离值。其中，多个固定位置可以包括预设距离范围内每隔预设距离间隔对应的多个位置。预设距离范围、预设距离间隔均可以根据实际需求设置，这里不做限定，例如预设距离范围为，一个Tag，两个锚点分段固定位置采集数据，例如：每隔50cm或100cm采集一组UWB模块计算的距离值。步骤S104，根据距离标定数据，确定每个固定位置对应的平均距离值和相应校准系数。在一些可能的实施例中，步骤S104可以包括如下子步骤1~子步骤2：子步骤1，根据每个固定位置对应的一组计算距离值，确定每个固定位置对应的平均距离值。平均距离值可以选择UWB模块在相应固定位置下测量得到的、与相应实际距离值之间的平均误差最小的距离值，这样可以提高UWB模块的定位精度。通常认为距离短的数据是更为可靠，为了提高平均距离值的准确性，可以仅考虑上报距离最短的几组数据，即数值最小的一定数量的计算距离值，基于此，子步骤1可以通过如下方式实现：对于每个固定位置，确定该固定位置对应的一组计算距离值中数值最小的多个目标计算距离值；根据各个目标计算距离值对应的频数，对各个目标计算距离值进行加权平均计算，得到该固定位置对应的平均距离值；其中，加权平均计算时每个目标计算距离值的权重与其频数相关。在选取目标计算距离值时，可以将由各个计算距离值构成的集合中，数值最小的预设数量个计算距离值确定为目标计算距离值，例如将由各个计算距离值构成的集合中元素，按照由大至小的顺序排序，将排序最靠后的预设数量个元素确定为目标计算距离值；也可以将数值小于实际距离值对应的预设阈值的计算距离值确定为目标计算距离值。其中，预设数量和预设阈值均可以根据实际需求设置，这里不做限定，例如当一组计算距离值的数量为20000时，预设数量可以为50，当实际距离值为100cm时，预设阈值可以为120cm。加权平均计算时，每个目标计算距离值的权重可以但不限于为其在所有目标计算距离值中的频数占比，即每个目标计算距离值的权重=每个目标计算距离值的频数/总频数，总频数等于各个目标计算距离值的频数之和。子步骤2，根据每个固定位置对应的平均距离值和预设的实际距离值，计算得到相应校准系数。可以将每个固定位置对应的实际距离值与平均距离值的比值，确定为该平均距离值对应的校准系数，即校准系数=实际距离值/平均距离值。步骤S106，根据各个固定位置对应的平均距离值和相应校准系数，确定UWB模块对应的标定参数。考虑到仅所设置的几个固定位置有平均距离值和相应校准系数，为了得到任意距离值对应的校准系数，可以通过拟合方法得到距离值与校准系数对应的拟合函数，这样可以基于该拟合函数得到任意距离值对应的校准系数。基于此，步骤S106可以通过如下过程实现：根据各个固定位置对应的平均距离值和相应校准系数，确定距离值与校准系数对应的拟合函数；将拟合函数确定为UWB模块对应的标定参数。本发明实施例还提供了一种拟合函数的确定方式，如下：以平均距离值为自变量，相应校准系数为因变量，对各个固定位置对应的平均距离值和相应校准系数进行多项式拟合，得到距离值与校准系数对应的拟合函数。这种多项式拟合方式，简单方便，且拟合效果较好。需要说明的是，本发明实施例并不限于多项式拟合方式，在其他实施例中，也可以采用其他拟合方式。为了提高多项式拟合方式得到的拟合函数的可用性，在进行多项式拟合时，可以将各个固定位置对应的平均距离值带入预设的n次多项式中，并基于相应校准系数计算得到误差的平方和；将使误差的平方和最小的一组拟合系数带入n次多项式中，得到距离值与校准系数对应的拟合函数。这种采用使误差的平方和最小的一组拟合系数的拟合函数，拟合程度较好。进一步地，在求解使误差的平方和最小的一组拟合系数时，可以对误差的平方和中的n+1个拟合系数分别求偏导，并令每个偏导为0，得到n+1个等式构成的方程组，进而通过求解方程组即可得到使误差的平方和最小的一组拟合系数。这种求解方式计算量小，求解速度快。需要说明的是，本发明实施例并不限于对误差的平方和求n+1次偏导的求解方式，在其他实施例中，也可以采用其他求解方式。在得到标定参数之后，可以基于标定参数进行数据的校准。基于此，上述UWB定位距离标定方法还包括：获取UWB模块采集的当前距离值；根据标定参数，确定当前距离值对应的目标校准系数；基于目标校准系数对当前距离值进行校正，得到校正后距离值。具体实现时，可以将当前距离值带入距离值与校准系数对应的拟合函数，得到当前距离值对应的目标校准系数，然后将当前距离值与目标校准系数的乘积作为校正后距离值。本发明实施例提供的UWB定位距离标定方法，在进行UWB定位距离标定时，先获取UWB模块在多个固定位置采集的距离标定数据，该距离标定数据包括每个固定位置对应的一组计算距离值；然后根据距离标定数据，确定每个固定位置对应的平均距离值和相应校准系数；进而根据各个固定位置对应的平均距离值和相应校准系数，确定UWB模块对应的标定参数。这样可以基于得到的标定参数对UWB模块进行误差校正，提高定位精度。为了便于理解，下面对上述UWB定位距离标定方法进行示例性介绍。本发明实施例提供的UWB定位距离标定方法包括以下步骤：1、UWB距离标定数据采集。暂定有两个UWB锚点，一个Anchor，一个Tag。两个锚点分段固定位置采数：每隔50cm或100cm采集一组UWB模块计算的距离值。2、UWB距离数据分析。仿真分析采回来的数据，在某个固定位置上，以UWB模块计算的距离为横坐标，距离出现的频次为纵坐标，画出对应的柱状图，如图2示出了Anchor和Tag距离100cm时，固定位置采集的UWB计算距离分布柱状图。图2的数据分布显示，频数分布中间多，两边少，符合偏态分布。其中，偏态分布是与“正态分布”相对，分布曲线左右不对称的数据次数分布，是连续随机变量概率分布的一种。3、UWB距离标定系数的获取。在每个固定位置采集的每组数据都会得两个参数：1.平均距离值ave_distance；2.对应的校准系数ave_ratio。参数的计算使用加权平均，挑取上报距离中最短的N组数，ave_distance为N组最短距离的加权平均所得；当实际距离值为100cm时，校准系数ave_ratio=100cm/ave_distance。4、多项式曲线拟合。以间隔50cm，采集50cm~500cm的数据为例，则会得到10组平均距离值x和10组对应校准系数y。组成一组样本数据{,,...}，画出样本数据的散点图，如图3所示，样本点形成的轨迹为非线性函数，故采样多项式拟合。n次多项式函数为：由上式可得，n次多项式有共n+1个未知的拟合系数，多项式拟合就是求出这最佳的n+1个拟合系数。把样本中的横坐标xi带入设定的多项式函数中，得到给定样本的纵坐标：误差的平方和为：其中，为根据样本数据中xi拟合出的值，yi为样本数据中的y，如果能有一组拟合系数让/＞最小，则这组拟合系数就可以认为是最好的。对的每个拟合系数求偏导，即对/＞分别求如下n+1次偏导，并令每个偏导为0，得：其中，上式方程组中的某一项，展开得：其中，m为样本数据的样本数量。同理，上述方程组中的其他项也可以展开为包含拟合系数a0至an的等式。那么，方程组中的n+1个等式就可以求出n+1个拟合系数。如此，这组拟合系数可以使得拟合函数的误差方最小，将这组拟合系数代入/＞即得所求的拟合函数。5、UWB距离标定。当已知UWB计算的距离值与校准系数对应的拟合函数后，当Tag距Anchor为任一距离distance时，代入拟合函数得到对应的校准系数ratio，当前的原始距离distance×ratio即为校正后的实际距离。为了验证上述UWB定位距离标定方法的效果，本发明实施例还进行了实验验证，结果如下：当Tag距Anchor为1米时，UWB采集的原始距离分布柱状图如图2所示，根据上述方法校正后的距离分布柱状图如图4所示。由图4可以看出，实际距离为100cm时，校正后的距离大多分布在96、97cm，与实际距离之间的误差大大的减小。由于本发明实施例提供的UWB定位距离标定方法只依赖于Tag与Anchor间UWB计算上报的相对距离，当一套系统UWB模块增多、相距距离变大，现场环境变动时，该方法也完全适用。且该方法完全由软件实现，不会增加任何成本。对应于上述的UWB定位距离标定方法，本发明实施例还提供了一种UWB定位距离标定装置，参见图5所示的一种UWB定位距离标定装置的结构示意图，该装置包括：数据获取模块501，用于获取UWB模块在多个固定位置采集的距离标定数据，所述距离标定数据包括每个所述固定位置对应的一组计算距离值；第一确定模块502，用于根据所述距离标定数据，确定每个所述固定位置对应的平均距离值和相应校准系数；第二确定模块503，用于根据各个所述固定位置对应的平均距离值和相应校准系数，确定所述UWB模块对应的标定参数。进一步地，上述第一确定模块502具体用于：根据每个所述固定位置对应的一组计算距离值，确定每个所述固定位置对应的平均距离值；根据每个所述固定位置对应的平均距离值和预设的实际距离值，计算得到相应校准系数。进一步地，上述第一确定模块502还用于：对于每个所述固定位置，确定该固定位置对应的一组计算距离值中数值最小的多个目标计算距离值；根据各个所述目标计算距离值对应的频数，对各个所述目标计算距离值进行加权平均计算，得到该固定位置对应的平均距离值；其中，加权平均计算时每个所述目标计算距离值的权重与其频数相关。进一步地，上述第二确定模块503具体用于：根据各个所述固定位置对应的平均距离值和相应校准系数，确定距离值与校准系数对应的拟合函数；将所述拟合函数确定为所述UWB模块对应的标定参数。进一步地，上述第二确定模块503还用于：以平均距离值为自变量，相应校准系数为因变量，对各个所述固定位置对应的平均距离值和相应校准系数进行多项式拟合，得到距离值与校准系数对应的拟合函数。进一步地，上述装置还包括：校正模块，用于获取所述UWB模块采集的当前距离值；根据所述标定参数，确定所述当前距离值对应的目标校准系数；基于所述目标校准系数对所述当前距离值进行校正，得到校正后距离值。进一步地，上述多个固定位置包括预设距离范围内每隔预设距离间隔对应的多个位置。本实施例所提供的UWB定位距离标定装置，其实现原理及产生的技术效果和前述UWB定位距离标定方法实施例相同，为简要描述，UWB定位距离标定装置实施例部分未提及之处，可参考前述UWB定位距离标定方法实施例中相应内容。如图6所示，本发明实施例提供的一种电子设备600，包括：处理器601、存储器602和总线，存储器602存储有可在处理器601上运行的计算机程序，当电子设备600运行时，处理器601与存储器602之间通过总线通信，处理器601执行计算机程序，以实现上述UWB定位距离标定方法。具体地，上述存储器602和处理器601能够为通用的存储器和处理器，这里不做具体限定。本发明实施例还提供了一种计算机可读存储介质，该计算机可读存储介质上存储有计算机程序，该计算机程序被处理器运行时执行前面方法实施例中所述的UWB定位距离标定方法。该计算机可读存储介质包括：U盘、移动硬盘、只读存储器、RAM、磁碟或者光盘等各种可以存储程序代码的介质。在这里示出和描述的所有示例中，任何具体值应被解释为仅仅是示例性的，而不是作为限制，因此，示例性实施例的其他示例可以具有不同的值。附图中的流程图和框图显示了根据本发明的多个实施例的装置、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段或代码的一部分，所述模块、程序段或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个连续的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或动作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。在本申请所提供的几个实施例中，应该理解到，所揭露的装置和方法，可以通过其它的方式实现。以上所描述的装置实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，又例如，多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些通信接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围。
