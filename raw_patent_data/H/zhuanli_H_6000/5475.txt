标题title
一种无人机通讯协议数据异常检测方法
摘要abst
本发明涉及无人机通讯协议技术领域，具体涉及一种无人机通讯协议数据异常检测方法，实时获取无人机通讯系统与控制中心之间通信产生的数据流，对数据流中的特征数据进行选取构成数据集；对数据集进行数据集中化及独立化处理，得到重构特征数据集；对重构特征数据集中的符合目标特征字段的特征数据进行监测，判断重构特征数据集中是否存在异常；通过网关将判断为非异常的特征数据流转换为通讯报文格式，确定通讯报文是否通过网关检测；在确定报文通过网关检测后，将通讯报文发送给控制中心。
权利要求书clms
1.一种无人机通讯协议数据异常检测方法，其特征在于，包括如下步骤：S1、实时获取无人机通讯系统与控制中心之间通信产生的数据流，对数据流中的特征数据进行选取构成数据集；S2、对数据集进行数据集中化及独立化处理，得到重构特征数据集；S3、对重构特征数据集中的符合目标特征字段的特征数据进行监测，判断重构特征数据集中是否存在异常；S4、通过网关将步骤S3中判断为非异常的特征数据流转换为通讯报文格式，确定通讯报文是否通过网关检测；在确定报文通过网关检测后，将通讯报文发送给控制中心。2.根据权利要求1中所述的无人机通讯协议数据异常检测方法，其特征在于，步骤S2中，对时刻i的采集的特征数据一维向量Xi=集中化，将特征数据一维向量Xi中的每个特征数据xik减去均值，得到n个集中化后的特征数据，其中第k个集中化后的特征数据/＞为：；集中化后的特征数据一维向量，t个集中化后的特征数据一维向量/＞构成了集中化后的特征数据矩阵/＞；计算特征数据矩阵的协方差矩阵C：；其中，为特征数据矩阵/＞的转置，对协方差矩阵C进行特征值分解，C＝UDUT，D为协方差矩阵C的特征值构成的特征值对角矩阵，U为协方差矩阵C的特征向量矩阵。3.根据权利要求2中所述的无人机通讯协议数据异常检测方法，其特征在于，对集中化后的特征数据进行独立化处理，独立化后的特征数据/＞表达式为：；其中，独立化后的特征数据构成重构特征数据集。4.根据权利要求3中所述的无人机通讯协议数据异常检测方法，其特征在于，步骤S3中，构建预测模型，将重构特征数据集中的特征数据与经预测模型预测的预测值进行偏离度计算；当偏离度大于设定的阈值时，则判断重构特征数据集中存在异常。5.根据权利要求1中所述的无人机通讯协议数据异常检测方法，其特征在于，步骤S4中，从中间接收设备接收数据流，并将数据流进行分组，通过网关将步骤S3中判断为非异常的数据流转换为通讯报文格式，网关具有检测规则；比较通讯报文和检测规则，以确定通讯报文是否通过网关检测；在确定通讯报文通过网关检测后，通过网关将通讯报文发送给控制中心，并通过控制中心基于优先级策略设置通讯报文的优先级；将通过网关检测的通讯报文格式转换为优先级格式，并通过控制中心将符合优先级格式的分组临时存储在队列中；控制中心根据报文的优先级和目的地址将报文转发到目的地址。6.根据权利要求5中所述的无人机通讯协议数据异常检测方法，其特征在于，比较接收到的通讯报文和检测规则，当确定该通讯报文与检测规则匹配时，通过网关获取与该检测规则匹配的处理操作，当通讯报文与检测规则匹配时，通过网关获取与所匹配的安全规则对应的处理操作，处理操作为激活操作时，通过网关将通讯报文发送给控制中心；当处理操作为截获操作时，截获该通讯报文，然后通过网关将截获结果发送给控制中心，以阻止网关发送该通讯报文。7.根据权利要求2中所述的无人机通讯协议数据异常检测方法，其特征在于，步骤S1中，收集无人机不同时刻i的采集的特征数据一维向量Xi，t个时刻的一维向量Xi构成数据集X={X1,X2…Xi…Xt}，其中Xi=是一种以无线电遥控或由自身程序控制为主的不载人飞机。随着无人机相关技术的发展，无人机应用从军用级和工业级的领域走向民用，众多行业也在积极扩展行业应用与发展无人机技术。无人机在农业植保、通信中继、抢险救灾、协同侦查和集群打击等不同领域具有广泛的应用价值和重要的发展前景。然而，无人机群服务于经济民生和防护领域的同时，其通讯数据泄露带来的各种潜在风险和安全隐患也与日俱增。 为保证无人机飞行安全，一种常见的做法是对飞行数据进行监控，即监控飞行数据中的异常情况。当出现异常飞行数据时，说明无人机组 成部件或者操控人员的操作出现了问题，针对问题及时查找原因，避免飞行事故的发生，从而保证飞行安全。如何从大量的无人机历史飞行数据中挖掘出飞机异常状态的数据模式是亟待解决的问题。无人机的异常数据检测方法主要分为基于知识的方法、基于模型的方法、基于数据驱动的方法，而基于数据驱动的方法又分为基于监督学习的方法和基于无监督学习的方法。基于知识的方法需要足够的专家知识来建立异常检测模型，对已知的异常检测效果较好，但在未知的异常方面检测效果会明显下降。基于模型的方法通过构造特定系统的模型，来估计系统状态的残差变化，从而检测系统中的异常情况并往往能达到很好的性能。由于需要使用目标系统的模型，因此当检测其它系统的异常情况就会效果变差。 基于监督学习的无人机异常数据检测虽然在检测异常数据方面能取得良好的效果，但是其要首先构建异常数据的先验知识，即需要获取每一类异常数据来训练模型，因此它无法有效识别未知类型的异常数据，这可能会导致检测效果降低。 针对无人机飞行数据缺少标签而且异常数据较少的情况，可采用无监督机器学习方法进行无人机异常数据检测。发明内容为了解决上述技术问题，本发明提出了一种无人机通讯协议数据异常检测方法，包括如下步骤：S1、实时获取无人机通讯系统与控制中心之间通信产生的数据流，对数据流中的特征数据进行选取构成数据集；S2、对数据集进行数据集中化及独立化处理，得到重构特征数据集；S3、对重构特征数据集中的符合目标特征字段的特征数据进行监测，判断重构特征数据集中是否存在异常；S4、通过网关将步骤S3中判断为非异常的特征数据流转换为通讯报文格式，确定通讯报文是否通过网关检测；在确定报文通过网关检测后，将通讯报文发送给控制中心。进一步地，步骤S2中，对时刻i的采集的特征数据一维向量Xi=则集中化后的特征数据一维向量。t个集中化后的特征数据一维向量构成了集中化后的特征数据矩阵/＞。对集中化后的特征数据矩阵进行分析计算：首先求特征数据矩阵/＞的协方差矩阵C：其中为特征数据矩阵/＞的转置，对协方差矩阵C进行特征值分解，C＝UDUT，其中D为协方差矩阵C的特征值构成的特征值对角矩阵，U＝为协方差矩阵C的特征向量矩阵。对集中化后的特征数据进行独立化处理，去除特征数据中的相关性，使得特征数据更容易满足独立性的假设。独立化后的特征数据表达式为公式：其中，U和D分别为用协方差矩阵C计算得出的特征向量矩阵和特征值对角矩阵。独立化后的特征数据构成重构特征数据集。S3、对重构特征数据集中的符合目标特征字段的特征数据进行监测，判断重构特征数据集中是否存在异常。构建预测模型，将重构特征数据集中的特征数据与经预测模型预测的预测值进行偏离度计算；当偏离度大于设定的阈值时，则判断重构特征数据集中存在异常。首先对重构特征数据集中的符合目标特征字段的特征变量进行周期性提取，用集合表示周期T内的M个符合目标特征字段的特征变量；/＞表示第j个符合目标特征字段的特征变量。用集合表示在测取时间窗口长度N内采集的所有符合目标特征字段的行为特征变量的集合，构建稳定控制数据集，获取该稳定控制数据集延迟两个周期测取点/＞和延迟两个周期测取点/＞得到行为特征变量，以构建预测模型的输入输出行为特征变量集；预测模型的输入行为特征变量集表示为：；其中，T2和T1分别为两个周期，周期N为测取时间窗口的长度,下标T-2表示延迟两个周期，下标T-1表示延迟一个周期；预测模型的输出行为特征变量集表示为：。预测模型表示为：；；其中，为构建的预测模型，/＞为预测模型预测的T时刻的预测值，/＞为预测模型预测的T时刻的第j个符合目标特征字段的特征变量预测值，/＞为第j个符合目标特征字段的特征变量，β为数据异常检测阈值，R为偏离度与数据异常检测阈值的比较结果。对应本步骤，设置了用于数据流异常检测的处理器，每个处理器包括判断单元和存储器；特征变量元素被连续化，以便连贯地处理每个特征变量元素，如图2所示的虚线部分，代表选取的连续化输入的特征变量元素部分。将等待进入判断单元的队列中的第一个特征变量元素，作为当前特征变量元素：作为输入预测模型的值。判断单元基于目标特征字段，判断的特征变量元素的异常状态，并获取要执行的状态存储的存储器中的地址。输出值，即最终结果判定状态包括：队列中的每个特征变量元素的最终判定状态的值以及对应的存储器中的地址。其中指令允许处理器执行以下之一：将目标特征字段与参考值进行比较；更新与目标特征字段相关联的当前判定状态；重复对目标特征字段的处理，合并已经通过处理的目标特征字段的处理；或者结束比较、更新、复制或合并。S4、通过网关将步骤S3中判断为非异常的特征数据流转换为通讯报文格式，确定通讯报文是否通过网关检测；在确定报文通过网关检测后，将通讯报文发送给控制中心。从中间接收设备接收数据流，并将数据流进行分组，通过网关将步骤S3中判断为非异常的数据流转换为通讯报文格式，网关具有检测规则；比较通讯报文和检测规则，以确定通讯报文是否通过网关检测；在确定通讯报文通过网关检测后，通过网关将通讯报文发送给控制中心，并通过控制中心基于优先级策略设置通讯报文的优先级；将通过网关检测的通讯报文格式转换为优先级格式，并通过控制中心将符合优先级格式的分组临时存储在队列中；控制中心根据报文的优先级和目的地址将报文转发到目的地址。如图3所示，为通讯报文格式示意图。通过网关检测的步骤包括：比较接收到的通讯报文和检测规则，当确定该通讯报文与检测规则匹配时，通过网关获取与该检测规则匹配的处理操作，当通讯报文与检测规则匹配时，通过网关获取与所匹配的安全规则对应的处理操作，处理操作为激活操作时，通过网关将通讯报文发送给控制中心；当处理操作为截获操作时，截获该通讯报文，然后通过网关将截获结果发送给控制中心，以阻止网关发送该通讯报文。检测规则记录安全规则和相应的处理操作，转换检测规则以符合网关的存储表的格式，以便在接收到检测规则后，通过网关将检测规则写入存储表中，将处理操作写到操作列中，其中存储表还包括状态列，该状态列记录接收分组的网关的分组计数。在优选实施例中，若无人机执行异常通讯数据流，则无人机与控制中心之间的安全不合格，若无人机拒绝执行异常通讯数据流，则无人机与控制中心之间的安全合格。具体地，按照通讯协议的格式构造异常通讯数据流，需通过控制中心的通信模块向无人机发送，测试无人机对异常通讯数据流的校验和识别能力。异常通讯数据流是对控制协议的格式中的各参数进行变异，构造异常通信数据包样本，发送并由无人机进行解析，用于测试解析控制协议的过程是否存在安全漏洞。在上述实施例中，可以全部或部分地通过软件、硬件、固件或者其任意组合来实现。当使用软件实现时，可以全部或部分地以计算机程序产品的形式实现。所述计算机程序产品包括一个或多个计算机指令。在计算机上加载和执行所述计算机程序指令时，全部或部分地产生按照本申请实施例所述的流程或功能。所述计算机可以是通用计算机、专用计算机、计算机网络、或者其他可编程装置。所述计算机指令可以存储在计算机可读存储介质中，或者通过所述计算机可读存储介质进行传输。所述计算机可读存储介质可以是计算机能够存取的任何可用介质或者是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。所述可用介质可以是磁性介质，、光介质、或者半导体介质)等。以上所述，仅为本申请的具体实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到各种等效的修改或替换，这些修改或替换都应涵盖在本申请的保护范围之内。因此，本申请的保护范围应以权利要求的保护范围为准。
