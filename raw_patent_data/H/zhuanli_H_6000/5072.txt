标题title
磁按键触发方法和电子设备
摘要abst
磁按键触发方法和电子设备。在该方法中，电子设备通过地磁计输出的磁力矢量，对线性磁传感器输出的磁力矢量进行校准，去除了线性磁传感器输出的磁力矢量中地磁场的干扰。使得进行比较的第一时刻的第一磁场强度更能反映磁铁的位置。这样，在第一按键达到预定行程位置时，电子设备能更快更准确的确定第一按键完成了该预定行程，可以触发相应功能，极大的提升了磁按键触发的灵敏度。
权利要求书clms
1.一种磁按键触发方法，其特征在于，包括：电子设备确定线性磁传感器在第一时刻输出的磁力矢量，得到第一磁力矢量；其中，随着电子设备中第一按键的按键行程增大，与所述第一按键关联的磁铁对所述线性传感器输入的磁力矢量增大；所述电子设备确定地磁计在所述第一时刻输出的磁力矢量，得到第二磁力矢量；所述电子设备确定所述第一磁力矢量与所述第二磁力矢量的矢量差的磁场强度，得到在第一时刻的第一磁场强度；当确定所述第一时刻的第一磁场强度大于第一预设比较阈值时，所述电子设备触发与完成第一行程对应的第一功能。2.根据权利要求1所述的方法，其特征在于，所述第一预设比较阈值为初始磁场强度与第一干扰阈值的和；所述初始磁场强度为所述电子设备中第一按键的按键行程为0时，线性传感器输出的磁力矢量与地磁计输出的磁力矢量的矢量差的磁场强度；所述第一干扰阈值为已经测算好的排除地磁场干扰后其他环境干扰因素对线性传感器输出的磁力矢量的干扰总值。3.根据权利要求2所述的方法，其特征在于，所述方法还包括：当确定所述第一时刻的第一磁场强度大于第二预设比较阈值时，所述电子设备触发与完成第二行程对应的第二功能；所述第二行程为所述第一按键在所述第一行程之后的下一个按键行程；所述第二预设比较阈值大于所述第一预设比较阈值。4.根据权利要求3所述的方法，其特征在于，所述第二预设比较阈值为所述第一预设比较阈值与预置第一行程磁场增加值的和；所述预置第一行程磁场增加值为预先测算好的磁铁随第一按键运动第一行程时在线性磁传感器的位置上磁铁的磁场强度的增加值。5.根据权利要求1至4中任一项所述的方法，其特征在于，所述电子设备为手柄，所述手柄中的一个磁按键包括所述第一按键和与所述第一按键关联的磁铁。6.一种电子设备，其特征在于，所述电子设备包括：一个或多个处理器，存储器，第一按键，与所述第一按键关联的磁铁，线性磁传感器和地磁计；所述线性磁传感器，用于检测输入的磁力矢量并输出；其中，随着所述第一按键的按键行程增大，与所述第一按键关联的磁铁对所述线性传感器输入的磁力矢量增大；所述地磁计，用于检测地磁场的磁力矢量并输出；所述存储器与所述一个或多个处理器耦合，所述存储器用于存储计算机程序代码，所述计算机程序代码包括计算机指令，所述一个或多个处理器调用所述计算机指令以使得所述电子设备执行：确定线性磁传感器在第一时刻输出的磁力矢量，得到第一磁力矢量；确定地磁计在所述第一时刻输出的磁力矢量，得到第二磁力矢量；确定所述第一磁力矢量与所述第二磁力矢量的矢量差的磁场强度，得到在第一时刻的第一磁场强度；当确定所述第一时刻的第一磁场强度大于第一预设比较阈值时，触发与完成第一行程对应的第一功能。7.根据权利要求6所述的电子设备，其特征在于，所述第一预设比较阈值为初始磁场强度与第一干扰阈值的和；所述初始磁场强度为所述电子设备中第一按键的按键行程为0时，线性传感器输出的磁力矢量与地磁计输出的磁力矢量的矢量差的磁场强度；所述第一干扰阈值为已经测算好的排除地磁场干扰后其他环境干扰因素对线性传感器输出的磁力矢量的干扰总值。8.根据权利要求7所述的电子设备，其特征在于，所述一个或多个处理器，还用于调用所述计算机指令以使得所述电子设备执行：当确定所述第一时刻的第一磁场强度大于第二预设比较阈值时，触发与完成第二行程对应的第二功能；所述第二行程为所述第一按键在所述第一行程之后的下一个按键行程；所述第二预设比较阈值大于所述第一预设比较阈值。9.根据权利要求8所述的电子设备，其特征在于，所述第二预设比较阈值为所述第一预设比较阈值与预置第一行程磁场增加值的和；所述预置第一行程磁场增加值为预先测算好的磁铁随第一按键运动第一行程时在线性磁传感器的位置上磁铁的磁场强度的增加值。10.根据权利要求6至9中任一项所述的电子设备，其特征在于，所述电子设备为手柄，所述手柄中的一个磁按键包括所述第一按键和与所述第一按键关联的磁铁。
说明书desc
技术领域本申请涉及终端及通信技术领域，尤其涉及磁按键触发方法和电子设备。背景技术目前，电子设备中的6自由度套件可以使用磁铁和线性磁传感器实现按键行程功能。然而，磁按键的行程检测会受到较大的环境干扰。例如，地磁场干扰、器件本身的噪声干扰、磁铁本身剩磁属性或磁化方向干扰、结构组装干扰等。假设这些干扰产生的误差经验值大概为MuT左右。因此导致确定磁按键行程时，最小的磁场强度检测门限值为MuT。磁按键的行程改变了单位检测距离后，线性磁传感器检测到的磁场强度需要大于MuT，才会被识别为磁按键的行程移动了单位检测距离。否则，会被识别为磁按键误触。因此，现有磁按键对于单位检测距离引起的磁场变化小于MuT的设计，或者小于MuT的磁场变化的行程，无法进行识别，导致磁按键不够灵敏。发明内容本申请提供了磁按键触发方法和电子设备，用于提高磁按键的灵敏度。第一方面，本申请提供了一种磁按键触发方法，该方法包括：电子设备确定线性磁传感器在第一时刻输出的磁力矢量，得到第一磁力矢量；其中，随着电子设备中第一按键的按键行程增大，与该第一按键关联的磁铁对该线性传感器输入的磁力矢量增大；该电子设备确定地磁计在该第一时刻输出的磁力矢量，得到第二磁力矢量；该电子设备确定该第一磁力矢量与该第二磁力矢量的矢量差的磁场强度，得到在第一时刻的第一磁场强度；当确定该第一时刻的第一磁场强度大于第一预设比较阈值时，该电子设备触发与完成第一行程对应的第一功能。在上述实施例中，电子设备通过地磁计输出的磁力矢量，对线性磁传感器输出的磁力矢量进行校准，去除了线性磁传感器输出的磁力矢量中地磁场的干扰。使得进行比较的第一时刻的第一磁场强度更能反映磁铁的位置。在第一按键达到第一行程位置时，电子设备能更快更准确的确定第一按键完成了该第一行程，可以触发相应的第一功能，而不会与现有技术一样判断为误触，极大的提升了磁按键触发的灵敏度。结合第一方面的一些实施例，在一些实施例中，该第一预设比较阈值为初始磁场强度与第一干扰阈值的和；该初始磁场强度为该电子设备中第一按键的按键行程为0时，线性传感器输出的磁力矢量与地磁计输出的磁力矢量的矢量差的磁场强度；该第一干扰阈值为已经测算好的排除地磁场干扰后其他环境干扰因素对线性传感器输出的磁力矢量的干扰总值。在上述实施例中，第一预设比较阈值为排除了地磁场干扰的初始磁场强度与第一干扰阈值的和，其中第一干扰阈值相比现有技术中环境干扰因素的干扰总值MuT更小，使得第一预设比较阈值相比于现有技术中更小。因此比较时电子设备能更快更准确的确定第一按键完成了该第一行程，极大的提升了磁按键触发的灵敏度。结合第一方面的一些实施例，在一些实施例中，该方法还包括：当确定该第一时刻的第一磁场强度大于第二预设比较阈值时，该电子设备触发与完成第二行程对应的第二功能；该第二行程为该第一按键在该第一行程之后的下一个按键行程；该第二预设比较阈值大于该第一预设比较阈值。在上述实施例中，该第一按键可以有多个行程，在提升磁按键触发的灵敏度的同时不影响磁按键多行程的实现。结合第一方面的一些实施例，在一些实施例中，该第二预设比较阈值为该第一预设比较阈值与预置第一行程磁场增加值的和；该预置第一行程磁场增加值为预先测算好的磁铁随第一按键运动第一行程时在线性磁传感器的位置上磁铁的磁场强度的增加值。结合第一方面的一些实施例，在一些实施例中，该电子设备为手柄，该手柄中的一个磁按键包括该第一按键和与该第一按键关联的磁铁。第二方面，本申请实施例提供了一种电子设备，该电子设备包括：一个或多个处理器，存储器，第一按键，与该第一按键关联的磁铁，线性磁传感器和地磁计；该线性磁传感器，用于检测输入的磁力矢量并输出；其中，随着该第一按键的按键行程增大，与该第一按键关联的磁铁对该线性传感器输入的磁力矢量增大；该地磁计，用于检测地磁场的磁力矢量并输出；该存储器与该一个或多个处理器耦合，该存储器用于存储计算机程序代码，该计算机程序代码包括计算机指令，该一个或多个处理器调用该计算机指令以使得该电子设备执行：确定线性磁传感器在第一时刻输出的磁力矢量，得到第一磁力矢量；确定地磁计在该第一时刻输出的磁力矢量，得到第二磁力矢量；确定该第一磁力矢量与该第二磁力矢量的矢量差的磁场强度，得到在第一时刻的第一磁场强度；当确定该第一时刻的第一磁场强度大于第一预设比较阈值时，触发与完成第一行程对应的第一功能。结合第二方面的一些实施例，在一些实施例中，该第一预设比较阈值为初始磁场强度与第一干扰阈值的和；该初始磁场强度为该电子设备中第一按键的按键行程为0时，线性传感器输出的磁力矢量与地磁计输出的磁力矢量的矢量差的磁场强度；该第一干扰阈值为已经测算好的排除地磁场干扰后其他环境干扰因素对线性传感器输出的磁力矢量的干扰总值。结合第二方面的一些实施例，在一些实施例中，该一个或多个处理器，还用于调用该计算机指令以使得该电子设备执行：当确定该第一时刻的第一磁场强度大于第二预设比较阈值时，触发与完成第二行程对应的第二功能；该第二行程为该第一按键在该第一行程之后的下一个按键行程；该第二预设比较阈值大于该第一预设比较阈值。结合第二方面的一些实施例，在一些实施例中，该第二预设比较阈值为该第一预设比较阈值与预置第一行程磁场增加值的和；该预置第一行程磁场增加值为预先测算好的磁铁随第一按键运动第一行程时在线性磁传感器的位置上磁铁的磁场强度的增加值。结合第二方面的一些实施例，在一些实施例中，该电子设备为手柄，该手柄中的一个磁按键包括该第一按键和与该第一按键关联的磁铁。第三方面，本申请实施例提供了一种芯片系统，该芯片系统应用于电子设备，该芯片系统包括一个或多个处理器，该处理器用于调用计算机指令以使得该电子设备执行如第一方面以及第一方面中任一可能的实现方式描述的方法。第四方面，本申请实施例提供一种包含指令的计算机程序产品，当上述计算机程序产品在电子设备上运行时，使得上述电子设备执行如第一方面以及第一方面中任一可能的实现方式描述的方法。第五方面，本申请实施例提供一种计算机可读存储介质，包括指令，当上述指令在电子设备上运行时，使得上述电子设备执行如第一方面以及第一方面中任一可能的实现方式描述的方法。可以理解地，上述第二方面提供的电子设备、第三方面提供的芯片系统、第四方面提供的计算机程序产品和第五方面提供的计算机存储介质均用于执行本申请实施例所提供的方法。因此，其所能达到的有益效果可参考对应方法中的有益效果，此处不再赘述。附图说明图1是本申请实施例中6DOF相关方位的一个示例性示意图；图2是本申请实施例中磁力矢量的一个场景示意图；图3是本申请实施例中对磁力进行三轴检测的一个场景示意图；图4是本申请实施例中对磁力进行单轴检测的一个场景示意图；图5是本申请实施例中磁按键的行程与磁铁对线性磁传感器输入的磁场强度的关系的一个场景示意图；图6是本申请实施例中地磁力对线性传感器输出的磁力矢量的影响的一个场景示意图；图7是本申请实施例中识别磁按键完成行程的一个示例性场景示意图；图8是本申请实施例中单位距离磁场变化门限组成的一个示例图；图9是现有技术中磁按键触发方法与本申请实施例中磁按键触发方法进行比对的一个场景示意图；图10是本申请实施例提供的电子设备100的结构示意图；图11是本申请实施例中磁按键触发方法的一个流程示意图；图12是本申请实施例中电子设备得到第一磁场强度的数据流向示意图。具体实施方式本申请以下实施例中所使用的术语只是为了描述特定实施例的目的，而并非旨在作为对本申请的限制。如在本申请的说明书和所附权利要求书中所使用的那样，单数表达形式“一个”、“一种”、“所述”、“上述”、“该”和“这一”旨在也包括复数表达形式，除非其上下文中明确地有相反指示。还应当理解，本申请中使用的术语“和/或”是指并包含一个或多个所列出项目的任何或所有可能组合。以下，术语“第一”、“第二”仅用于描述目的，而不能理解为暗示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征，在本申请实施例的描述中，除非另有说明，“多个”的含义是两个或两个以上。为了便于理解，下面先对本申请实施例涉及的相关术语及概念进行介绍。6DOF：6DOF指在如图1中的所示，上下、前后、左右3个转动角度的自由度的基础上，再加上如图1中的所示，上下、前后、左右等三个位置移动相关的自由度。因此，如图1中的所示，具有6DOF检测能力的电子设备不仅能检测到电子设备向不同方向的自由转动，而且还可以检测到其向不同方向位移的变化。磁力矢量：本申请实施例中，磁力矢量包括磁场强度和磁力方向。本申请实施例中，线性磁传感器输入和输出的磁力都可以用磁力矢量表示，磁力计输入和输出的磁力也都可以用磁力矢量表示。具体的，如图2所示为本申请实施例中磁力矢量的一个场景示意图。地磁计可以检测到地磁场输入的磁力矢量并将其输出。线性磁传感器可以检测到磁按键中磁铁输入的磁力矢量、地磁场输出的磁力矢量以及一些其他环境干扰因素输入的磁力矢量，然后计算后输出检测到的磁力矢量。根据线性磁传感器和磁力计检测磁力方向时是三轴检测还是单轴检测的不同，线性磁传感器和磁力计在进行磁力矢量输出时的计算方式也有所不同。磁铁对线性磁传感器输入的磁力矢量的计算：本申请实施例中，可根据线性磁传感器输出的磁力矢量和地磁计输出的磁力矢量，来计算磁按键中磁铁对线性磁传感器输入的磁力矢量。具体的，本申请实施例中，磁铁对线性磁传感器输入的磁力矢量＝线性磁传感器输出的磁力矢量-地磁计输出的磁力矢量。可以理解的是，虽然线性磁传感器输出的磁力矢量中，除了有地磁场对线性磁传感器输入的磁力矢量和磁铁对线性磁传感器输入的磁力矢量的影响外，还有其他环境干扰因素输入的磁力矢量的影响。但是本申请实施中在计算磁铁对线性磁传感器输入的磁力矢量时，可以仅使用线性磁传感器输出的磁力矢量和地磁计输出的磁力矢量，以排除掉地磁场对线性磁传感器检测精度的影响。下面分别结合线性磁传感器和磁力计检测磁力方向时是三轴检测和单轴检测两种情况的具体场景，描述磁按键中磁铁对线性磁传感器输入的磁力矢量的计算原理：1、三轴检测：三轴检测即线性磁传感器和磁力计能输出的磁力矢量的磁力方向可以为空间中所有方位。图3为本申请实施例中对磁力进行三轴检测的一个场景示意图。线性磁传感器可以检测到磁铁输入的磁力矢量Cs，以及地磁场输入的磁力矢量Ds，可以对检测到的磁力矢量计算矢量和，得到线性磁传感器输出的磁力矢量Ss。同理，磁力计也可以检测到地磁场输入的磁力矢量Ds并输出。这种情况下，线性磁传感器输出的磁力矢量Ss约为磁铁输入的磁力矢量Cs与地磁计输出的磁力矢量Ds的矢量和。因此，磁铁输入的磁力矢量Cs可以估算为线性磁传感器输出的磁力矢量Ss与地磁计输出的磁力矢量Ds的矢量差。2、单轴检测：单轴检测即线性磁传感器和磁力计能输出的磁力矢量的磁力方向只为空间中一个轴上的方向，只需要使用正负号就可以表示磁力矢量在该轴上的方向。优选地，该轴的方向可以与磁按键中磁铁对线性磁传感器的磁力方向一致。这样可以简化计算过程。可以理解的是，一般的，在进行单轴检测时，线性磁传感器和磁力计的单轴的方向一致。可选的，若单轴方向不一致，在进行计算时，也可以转换为单轴方向一致的数据后再进行计算，此处不作限定。图4为本申请实施例中对磁力进行单轴检测的一个场景示意图。线性磁传感器可以检测到磁铁在单轴上输入的磁力矢量Cf，以及地磁场的磁力矢量Ds在该单轴上的分量Df，在该单轴上对Cf和Df求矢量和，可得到线性传感器输出的磁力矢量Sf。同理，磁力计也可以检测到地磁场的磁力矢量Ds在该单轴上的分量Df并输出。这种情况下，线性磁传感器输出的磁力矢量Sf约为磁铁输入的磁力矢量Cf与地磁计输出的磁力矢量Df的矢量和。因此，磁铁输入的磁力矢量Cf可以估算为线性磁传感器输出的磁力矢量Sf与地磁计输出的磁力矢量Df的矢量差。因此，不管是三轴检测还是单轴检测，磁按键中磁铁输入的磁力矢量均可以估算为线性磁传感器输入的磁力矢量与地磁计输出的磁力矢量的矢量差。为便于描述，本申请下述实施例中均以线性磁传感器和磁力计进行三轴检测为例进行描述，但本申请实施例的方法中该线性磁传感器和磁力计并不限定为中只能使用三轴检测，其也可以使用单轴检测，此处不作限定。下述实施例中对此不再赘述。磁按键的行程和磁铁对线性磁传感器输入的磁力矢量：图5为本申请实施例中磁按键的行程与磁铁对线性磁传感器输入的磁场强度的关系的一个场景示意图。随着磁按键行程的增大，磁按键的磁铁与线性磁传感器的距离会变小，因此，会使得磁铁对线性磁传感器输入的磁场强度增大。地磁力对线性磁传感器输出的磁力矢量的影响：本申请实施例中，之所以要在线性磁传感器输出的磁力矢量中排除掉地磁力对线性磁传感器的影响，是因为在线性磁传感器变换方向的过程中，地磁力会影响到线性磁传感器输出的磁力矢量，从而对线性磁传感器输出的磁力矢量造成干扰。图6为本申请实施例中地磁力对线性传感器输出的磁力矢量的影响的一个场景示意图。如图6中的所示，线性磁传感器能在按键行程方向上检测到磁按键中磁铁的磁力，并能检测到该位置地磁场对线性磁传感器的磁力。如图6中的所示，若在该位置输入线性磁传感器的磁铁的磁力矢量为Ch、地磁场的磁力矢量为Dh，则该线性磁传感器输出的磁力矢量约为两者的矢量和Sh。在该位置即使该磁按键的按键行程没有变化，仅仅方向发生变化，由于地磁场的影响，也会导致该线性磁传感器输出的磁力矢量发生变化。如图6中的所示，线性磁传感器同样能在按键行程方向上检测到磁按键中磁铁的磁力以及地磁场对线性磁传感器的磁力。但是如图6中的所示，在该线性磁传感器在该位置上处于该方向时，输入线性磁传感器的磁铁的磁力矢量为Cx、地磁场的磁力矢量为Dx。与图6中的相比，虽然磁铁的磁力矢量Cx的磁场强度与磁铁的磁力矢量Ch的磁场强度相同，地磁场的磁力矢量Dx的磁场强度也与地磁场的磁力矢量Dh的磁场强度相同。但是由于磁按键的方向发生了变化，导致磁铁的磁力矢量Cx相对于地磁场的磁力矢量Dx的方向，与磁铁的磁力矢量Ch相对于地磁场的磁力矢量Dh的方向发生了变化。从而使得图6中的中线性磁传感器输出的磁力矢量Sx与图6中的中线性磁传感器输出的磁力矢量Sh的磁场强度和磁力方向均发生了变化。因此，只要磁按键方向变化，地磁场对线性磁传感器输出的磁力矢量就会造成干扰。在线性磁传感器输出的磁力矢量中去除地磁场造成的干扰后得到的磁力矢量，能更准确的反应磁按键中磁铁对线性磁传感器输入的磁力矢量。磁按键的识别方式：图7为本申请实施例中识别磁按键完成行程的一个示例性场景示意图。图7中以磁按键中包括两个行程为例，本申请其他实施例中磁按键可以包括有更多或更少的行程，此处不作限定。可以理解的是，结合上述磁铁对线性磁传感器输入的磁力矢量的计算可知，线性磁传感器输出的磁力矢量去除地磁场干扰后的磁场强度约为磁按键中磁铁对线性磁传感器的磁力矢量的磁场强度。如图7中的所示，磁按键中按键处于初始位置，可以设定此时磁铁对线性磁传感器的磁力矢量的磁场强度为初始磁场强度。一般的，该初始磁场强度可以在该磁按键出厂前或装有该磁按键的电子设备出厂前计算好，并预置在装有该磁按键的电子设备中。在一些实施例中，该初始磁场强度也可以不进行预置，通过实时计算确定，此处不作限定。如图7中的所示，磁按键中按键在运动时，装有该磁按键的电子设备会实时计算磁铁对线性磁传感器的磁力矢量的磁场强度。若在某个时刻，磁铁对线性磁传感器的磁力矢量的磁场强度大于初始磁场强度与第一干扰阈值的和，则该电子设备可以确定按键完成第一行程，可以触发第一功能。可以理解的是，该第一干扰阈值为排除了地磁场干扰后的干扰阈值。示例性的，若干扰总值经验值为300uT，其中地磁场干扰评估为120uT，则该排除了地磁场干扰后的第一干扰阈值为180uT。可以理解的是，根据实际环境的不同，该第一干扰阈值也可能不同。具体可以根据实际情况评估，此处不作限定。在确定此时磁铁对线性磁传感器的磁力矢量的磁场强度大于第一干扰阈值和初始化磁场强度的和时，可以表示按键在初始位置的基础上运动的幅度对线性磁传感器的影响已经超出了环境干扰的上限，因此电子设备可以确定完成了第一行程，可以触发第一功能。可以理解的是，初始磁场强度与第一干扰阈值的和也可以在该磁按键出厂前或装有该磁按键的电子设备出厂前计算好，并预置在装有该磁按键的电子设备中。在一些实施例中，也可以仅预置该第一干扰阈值，通过实时计算确定该初始磁场强度，此处不作限定。在一些实施例中，该初始磁场强度与第一干扰阈值的和可以被称为第一预置比较阈值。如图7中的所示，若在某个时刻，磁铁对线性磁传感器的磁力矢量的磁场强度大于初始磁场强度、第一干扰阈值以及磁铁运动第一行程时线性磁传感器磁场强度的增加值的和，则该电子设备可以确定按键完成第二行程，可以触发第二功能。在确定此时磁铁对线性磁传感器的磁力矢量的磁场强度大于初始磁场强度、第一干扰阈值以及磁铁运动第一行程时线性磁传感器磁场强度的增加值的和时，可以表示按键在初始位置的基础上运动的幅度对线性磁传感器的影响已经超出了运动第一行程以及环境干扰的上限，因此电子设备可以确定完成了第二行程，可以触发第二功能。可以理解的是，该磁铁运动第一行程时线性磁传感器磁场强度的增加值可以在该磁按键出厂前或装有该磁按键的电子设备出厂前计算好，并预置在装有该磁按键的电子设备中。在一些实施例中，也可以直接预置初始磁场强度、第一干扰阈值以及磁铁运动第一行程时线性磁传感器磁场强度的增加值的和，而不单独预置该磁铁运动第一行程时线性磁传感器磁场强度的增加值，此处不作限定。在一些实施例中，该初始磁场强度、第一干扰阈值以及磁铁运动第一行程时线性磁传感器磁场强度的增加值的和可以被称为第二预置比较阈值。环境干扰因素的干扰总值和第一干扰阈值：除了磁按键中磁铁会向线性磁传感器输出磁力矢量外，其他环境干扰因素也会向线性磁传感器输入磁力矢量，从而对线性传感器输出的磁力矢量造成干扰。单位距离磁场变化门限的上限值可以作为环境干扰因素的干扰总值MuT。在磁按键中按键运动后，增加的磁场强度大于该环境干扰因素的干扰总值时，才能确定按键运动了单位距离，否则会被认定为误触。图8为本申请实施例中单位距离磁场变化门限组成的一个示例图。示例性的，根据经验评估测算，单位距离磁场变化门限可以包括地磁场引起的误差120uT、器件噪声误差15uT、结构公差引起的误差+/-10％、磁铁磁强度公差引起的误差+/-4％等。示例性的，在一些实施例中，根据经验评估，环境干扰因素的干扰总值MuT可以为300uT。本申请实施例中，由于在线性磁传感器的磁力矢量中排除了地磁场的干扰，因此，可以在单位距离磁场变化门限中排除地磁场引起的误差，例如120uT，从而得到上述第一干扰阈值，例如为180uT。可以理解的是，根据实际情况的不同，环境干扰因素的干扰总值MuT、该第一干扰阈值也可以不同，具体可以根据实际环境和器件进行测算，此处不作限定。图9为现有技术中磁按键触发方法与本申请实施例中磁按键触发方法进行比对的一个场景示意图。如图9中的所示，假设磁按键中按键在初始位置时线性磁传感器输出的磁力矢量S1约为磁铁的磁力矢量C1与地磁场的磁力矢量D1的矢量和。如图9中的所示，假设相对于图9中，磁按键变换了方向，且按键被按压到了第一行程处。此时，磁铁对线性磁传感器的磁力矢量变更为C2。C2相对于地磁场的磁力矢量D2与C1相对于地磁场的磁力矢量D1不同。线性磁传感器输出的磁力矢量S2约为磁铁的磁力矢量C2与地磁场的磁力矢量D2的矢量和。如图9中的所示，现有技术的磁按键触发方法中，在确定按键是否触发时，会直接判断线性磁传感器输出的磁力矢量S2的磁场强度与磁力矢量S1的磁场强度的差值是否大于环境干扰因素的干扰总值MuT。例如MuT为300uT时，则需要在增加值Z1大于300uT时，才能确定按键被触发。否则会认为按键误触。而在相同情况下，如图9中的所示，本申请实施例的磁按键触发方法中，会先在线性磁传感器输出的磁力矢量的基础上排除地磁场的干扰，得到磁铁的磁力矢量。只需要判断磁铁的磁力矢量C2的磁场强度与磁力矢量C1的磁场强度的差值是否大于排除地磁场干扰后的第一干扰阈值。例如环境干扰因素的干扰总值MuT为300uT时，第一干扰阈值可能只有180uT，则在增加值Z2大于180uT时，就可以确定按键被触发，而不会认为按键误触。不仅判断比对的干扰阈值从300uT降低到180uT，而且在很多情况下，由于排除了地磁场干扰，计算出的第一行程磁场强度的增加值Z2相比现有技术中增加值Z1会增大，从而可以使得磁按键中按键在达到第一行程时能更快更准确的被识别。因此，极大的提升了磁按键触发识别的灵敏度。下面首先介绍本申请实施例提供的示例性电子设备100。图10是本申请实施例提供的电子设备100的结构示意图。下面以电子设备100为例对实施例进行具体说明。应该理解的是，电子设备100可以具有比图中所示的更多的或者更少的部件，可以组合两个或多个的部件，或者可以具有不同的部件配置。图中所示出的各种部件可以在包括一个或多个信号处理和/或专用集成电路在内的硬件、软件、或硬件和软件的组合中实现。电子设备100可以包括：处理器110，地磁计120，线性磁传感器130，按键141和磁铁142。可以理解的是，本申请实施例示意的结构并不构成对电子设备100的具体限定。在本申请另一些实施例中，电子设备100可以包括比图示更多或更少的部件，或者组合某些部件，或者拆分某些部件，或者不同的部件布置。图示的部件可以以硬件，软件或软件和硬件的组合实现。处理器110可以包括一个或多个处理单元。其中，不同的处理单元可以是独立的器件，也可以集成在一个或多个处理器中。处理器110中还可以设置存储器，用于存储指令和数据。处理器110可以调用储存器中存储的指令和数据，以使得该电子设备100执行本申请实施例中的磁按键触发方法。本申请实施例中，该处理器110，用于根据线性磁传感器130输出的磁力矢量和地磁计120输出的磁力矢量，实时计算磁铁142对线性传感器130输出的磁力矢量。并将磁铁142对线性传感器130输出的磁力矢量的磁场强度与预置比较阈值进行比较，从而确定磁按键中按键141是否完成预设行程。在确定按键141完成预设行程时，触发相应的预设功能。在本申请的一些实施例中，该电子设备100为一个手柄。该处理器110为一个手柄主控芯片。在本申请的一些实施例中，该电子设备100为一个移动终端设备。该处理器110为该移动终端设备的CPU。该地磁计120，用于检测地磁场的磁力矢量并输出；该线性磁传感器130，用于检测输入的磁力矢量，并输出。输入该线性磁传感器130的磁力矢量主要为磁铁142对该线性传感器的磁力矢量。此外，输入该线性磁传感器130的磁力矢量还包括地磁场对该线性传感器130的磁力矢量，以及其他环境干扰因素对该线性传感器130的磁力矢量。磁铁142，用于在按键141的作用下运动，向线性传感器130输入磁力矢量；按键141，用于在用户操作下运动，并带动磁铁142。可以理解的是，磁铁142与按键141可以一起组成磁按键。下面结合上述示例性电子设备100的硬件结构，对本申请实施例中磁按键触发方法进行具体描述，图11为本申请实施例中磁按键触发方法的一个流程示意图：可以理解的是，在下述步骤执行之前，电子设备中已经预置了初始磁场强度、第一干扰阈值。其中，该初始磁场强度为电子设备中第一按键的按键行程为0时，线性传感器输出的磁力矢量与地磁计输出的磁力矢量的矢量差的磁场强度。该第一干扰阈值为已经测算好的排除地磁场干扰后其他环境干扰因素对线性传感器输出的磁力矢量的干扰总值。S1101、电子设备确定线性磁传感器在第一时刻输出的磁力矢量，得到第一磁力矢量；其中，随着电子设备100中第一按键的按键行程增大，磁铁142对该线性磁传感器130输入的磁力矢量增大。可以理解的是，本申请实施例中，磁按键包括第一按键和与第一按键关联的磁铁，例如按键141和磁铁142。与该第一按键关联的磁铁会随着该第一按键的移动而移动。与该第一按键关联的磁铁和该第一按键的连接方式可以有很多种。例如，磁铁可以粘连在该第一按键上；再如，磁铁可以嵌入在该第一按键上等。还可以有很多其他的连接方式，此处不作限定。在电子设备100开机后，或电子设备100的磁按键功能开启后，电子设备100可以持续的监测线性传感器输出的磁力矢量。其中，可以将线性磁传感器130在第一时刻输出的磁力矢量记为第一磁力矢量。S1102、电子设备确定地磁计在该第一时刻输出的磁力矢量，得到第二磁力矢量；在电子设备100开机后，或电子设备100的磁按键功能开启后，电子设备100可以持续的监测地磁计120输出的磁力矢量。可以将地磁计120在第一时刻输出的磁力矢量记为第二磁力矢量。S1103、电子设备确定该第一磁力矢量与第二磁力矢量的矢量差的磁场强度，得到在第一时刻的第一磁场强度；在电子设备100得到线性磁传感器130在第一时刻输出的第一磁力矢量与地磁计120在第一时刻输出的第二磁力矢量后，电子设备可以实时确定第一磁力矢量与第二磁力矢量的矢量差的磁场强度，得到在第一时刻的第一磁场强度，即为排除地磁场干扰，校准后的磁场强度。需要说明的是，第一磁力矢量与第二磁力矢量的矢量差同样为一个磁力矢量，该磁力矢量包括磁场强度和磁力方向。可以理解的是，该第一磁场强度即为在第一时刻线性磁传感器130检测到的磁力矢量排除地磁场干扰后的磁场强度。示例性的，图12为电子设备得到第一磁场强度的数据流向示意图。处理器得到线性磁传感器第一时刻输出的第一磁力矢量T1与地磁计第一时刻输出的第二磁力矢量T2，并得到T1与T2的矢量差的磁场强度|T1-T2|，作为校准后的磁场强度，即第一时刻的第一磁场强度。电子设备在计算得到第一时刻的第一磁场强度后，可以与预置比较阈值进行比较。根据电子设备中第一按键的按键行程的段数，电子设备中可以预置有多个预置比较阈值。例如，若第一按键只有1段行程：第一行程，这电子设备中可以预置有第一预置比较阈值；再如，若该第一按键有2段行程：第一行程和第二行程，则电子设备中可以预置有第一预置比较阈值和第二预置比较阈值。再如若该第一按键有3段行程：第一行程、第二行程和第三行程，则电子设备中可以预置有第一预置比较阈值、第二预置比较阈值和第三预置比较阈值。可以理解的是，该第一按键还可以有更多段行程，此处不作限定。S1104、当确定该第一时刻的第一磁场强度大于第一预置比较阈值时，该电子设备触发与完成第一行程对应的第一功能；若电子设备100确定在第一时刻的第一磁场强度大于第一预置比较阈值，则该电子设备可以在该第一时刻时或该第一时刻后确定该第一按键完成第一行程，可以触发预设的完成该第一行程对应的第一功能。其中，第一预设比较阈值为初始磁场强度与第一干扰阈值的和。S1105、当确定该第一时刻的第一磁场强度大于第二预设比较阈值时，该电子设备触发与完成第二行程对应的第二功能。若该第一按键中还包括第二行程，则电子设备100中可以预置有第二预设比较阈值，或预置有预置第一行程磁场增加值。其中，第二预设比较阈值为第一预设比较阈值与预设第一行程磁场增加值的和。预设第一行程磁场增加值为预先测算好的磁铁随第一按键运动第一行程时在线性磁传感器的位置上磁铁的磁场强度的增加值。因此，若电子设备100确定在第一时刻的第一磁场强度大于第二预设比较阈值，则该电子设备可以在该第一时刻时或该第一时刻后确定该第一按键完成第二行程，可以触发预设的完成该第二行程对应的第二功能。本申请实施例中，一方面，电子设备100通过地磁计120输出的磁力矢量，对线性磁传感器130输出的磁力矢量进行校准，去除了线性磁传感器130输出的磁力矢量中地磁场的干扰。使得进行比较的第一时刻的第一磁场强度更能反映磁铁142的位置。另一方面，第一预设比较阈值为排除了地磁场干扰的初始磁场强度与第一干扰阈值的和，使得第一预设比较阈值相比于现有技术中更小。这样，在第一按键达到预定行程位置时，电子设备100能更快更准确的确定第一按键完成了该预定行程，可以触发相应功能，而不会与现有技术一样判断为误触，极大的提升了磁按键触发的灵敏度。以上所述，以上实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围。上述实施例中所用，根据上下文，术语“当…时”可以被解释为意思是“如果…”或“在…后”或“响应于确定…”或“响应于检测到…”。类似地，根据上下文，短语“在确定…时”或“如果检测到”可以被解释为意思是“如果确定…”或“响应于确定…”或“在检测到时”或“响应于检测到”。在上述实施例中，可以全部或部分地通过软件、硬件、固件或者其任意组合来实现。当使用软件实现时，可以全部或部分地以计算机程序产品的形式实现。所述计算机程序产品包括一个或多个计算机指令。在计算机上加载和执行所述计算机程序指令时，全部或部分地产生按照本申请实施例所述的流程或功能。所述计算机可以是通用计算机、专用计算机、计算机网络、或者其他可编程装置。所述计算机指令可以存储在计算机可读存储介质中，或者从一个计算机可读存储介质向另一个计算机可读存储介质传输，例如，所述计算机指令可以从一个网站站点、计算机、服务器或数据中心通过有线或无线方式向另一个网站站点、计算机、服务器或数据中心进行传输。所述计算机可读存储介质可以是计算机能够存取的任何可用介质或者是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。所述可用介质可以是磁性介质，、光介质、或者半导体介质等。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，该流程可以由计算机程序来指令相关的硬件完成，该程序可存储于计算机可读取存储介质中，该程序在执行时，可包括如上述各方法实施例的流程。而前述的存储介质包括：ROM或随机存储记忆体RAM、磁碟或者光盘等各种可存储程序代码的介质。
