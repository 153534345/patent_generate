标题title
一种量子密钥分发网络中负载均衡的分布式路由方法及系统
摘要abst
本发明公开了一种量子密钥分发网络中负载均衡的分布式路由方法及系统，当QKD设备节点接入量子密钥分发网络后，根据邻接量子链路的密钥量状态动态更新路由状态通告时间，当到达路由状态通告时间后广播密钥量更新报文；在收到密钥量更新报文后，网内节点在本地计算并更新路由表和转发表；当节点需要进行路由转发时，查询路由表和转发表，将数据转发的负载分摊到若干条最短可用路径上。该方法及系统可以实现高带宽加密应用需求情况下量子密钥分发网络的负载均衡，避免单一路径上密钥资源的耗尽；同时提升了路由信息的准确性，降低了报文广播的开销，从而提高了QKD网络的效率和可靠性。
权利要求书clms
1.一种量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，所述方法包括：步骤1、当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，执行邻居发现机制，启动与邻居节点间的量子密钥协商过程，之后节点A与节点B协商关于链路的路由通告主节点，并由链路/＞的路由通告主节点设置初始路由状态通告时间/＞；步骤2、当用户向量子密钥分发网络发送密钥请求，触发端到端量子密钥分发过程且密钥请求的路由经过链路时，节点A与节点B之间共享的量子密钥会被消耗，在量子密钥消耗之后，链路/＞的路由通告主节点更新路由状态通告时间/＞；步骤3、当到达路由状态通告时间后，链路/＞的路由通告主节点检查节点A和节点B当前共享的量子密钥量，并向网络中广播链路/＞的量子密钥量更新报文，之后更新路由状态通告时间/＞；步骤4、当量子密钥分发网络中的节点C收到来自链路的路由通告主节点广播的量子密钥量更新报文后，本地计算目的节点分别为节点A和节点B的最短可用路径集合，以及所述最短可用路径集合中每条路径的最小量子密钥量，并根据计算结果更新本地路由表和转发表；步骤5、当节点C需要对用户的密钥请求进行路由转发时，查询步骤4更新后的本地路由表和转发表，获取最短可用路径集合及对应路径的最小量子密钥量，之后节点C进行负载均衡转发，按照所述最短可用路径集合中不同路径对应的最小量子密钥量将分组加密转发到对应端口；步骤6、当链路出现故障，无法继续提供服务时，链路/＞的路由通告主节点将通过经典信道向网络中广播关于链路/＞的错误报文；当节点C收到网络中关于链路的错误报文后，删除本地存储的关于节点A和节点B的相关拓扑信息和链路/＞的量子密钥量信息，重新计算路由并更新本地路由表和转发表。2.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，在所述步骤1中，当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，执行邻居发现机制，启动与邻居节点间的量子密钥协商过程，具体过程为：当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，首先节点A通过经典网络的路由协议获取网络拓扑状态，并在经典信道上广播Hello报文，在收到具有量子信道连接的相邻节点B的回复报文后，确认节点A与节点B的邻居关系，结束邻居发现过程；在邻居发现过程结束后，节点A和节点B通过量子信道开始执行链路上的量子密钥协商过程，并持续产生双方共享的量子密钥。3.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，在所述步骤1中，节点A与节点B协商关于链路的路由通告主节点，并由链路/＞的路由通告主节点设置初始路由状态通告时间/＞，具体过程为：节点A与节点B协商关于链路的路由通告主节点，链路/＞的路由通告主节点是指当链路/＞的量子密钥量状态发生改变时，即节点A与节点B之间共享的量子密钥量发生改变时，负责广播通告其它节点的节点；在协商结束后，链路的路由通告主节点设置初始路由状态通告时间/＞，表示为：其中，/＞表示链路/＞的路由通告主节点协商结束时间；/＞表示预设的全网路由状态最大通告周期。4.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，所述步骤2的过程具体为：当用户向量子密钥分发网络发送密钥请求，触发端到端量子密钥分发过程且路由经过链路时，节点A与节点B之间共享的量子密钥会被消耗；在量子密钥消耗之后，链路的路由通告主节点更新路由状态通告时间/＞，具体计算公式为：其中，/＞表示链路/＞的量子密钥量因服务密钥请求而发生改变的时间；/＞表示预设的全网路由状态通告周期；/＞表示预设的全网路由状态最大通告周期；/＞表示链路/＞上量子密钥的平均产生速率；/＞表示链路/＞上密钥的平均消耗速率。5.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，所述步骤3的具体过程为：当到达路由状态通告时间后，链路/＞路由通告主节点检查节点A和节点B当前共享的量子密钥量，生成链路/＞的量子密钥量更新报文，并向网络中广播该报文，其中，链路/＞量子密钥量更新报文中包含链路/＞的剩余量子密钥量信息；当报文广播结束后，链路路由通告主节点更新链路/＞路由状态通告时间/＞，具体计算公式为：其中，/＞表示链路/＞量子密钥量更新报文广播结束后时间；/＞表示预设的全网路由状态通告周期；/＞表示预设的全网路由状态最大通告周期；/＞表示链路/＞上量子密钥的平均产生速率；/＞表示链路/＞上密钥的平均消耗速率。6.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，所述步骤4中，最短可用路径是指从源节点出发到达目的节点的跳数最少的路径，并且该路径上经过的所有链路的最小量子密钥量大于0；最短可用路径集合是指从源节点出发到达目的节点的条最短可用路径/＞组成的集合，其中，/＞；节点的本地路由表和本地转发表中的表项由以本节点为源节点，网络中其他节点为目的节点的对和/＞对所对应的表项值构成；其中，本地路由表中对所对应的表项值为源节点前往目的节点的/＞条最短可用路径/＞以及/＞的下一跳信息；本地转发表中/＞对所对应的表项值为源节点前往目的节点/＞条最短可用路径/＞的最小量子密钥量/＞，以及自上次转发表更新事件以来本节点向最短可用路径/＞转发的累积密钥量/＞。7.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，所述步骤4的具体过程为：当节点C收到来自链路的路由通告主节点广播的量子密钥量更新报文后，更新本地维护的关于链路/＞的量子密钥量信息，并重新计算从节点C出发，分别到达节点A和节点B的最短可用路径集合/＞和/＞；当节点C计算得到以节点A为目的节点的最短可用路径集合后，根据所述最短可用路径集合/＞以及集合中/＞条最短可用路径/＞的下一跳信息，节点C更新本地以节点A为目的节点的路由表表项；其中，/＞；之后，根据所述最短可用路径集合中/＞条最短可用路径/＞的最小量子密钥量/＞更新本地以节点A为目的节点的转发表表项，并将转发表中自上次转发表更新事件以来本节点向/＞条最短可用路径/＞转发的累积密钥量/＞清零；节点C对以节点B为目的节点的最短可用路径集合重复上述过程，完成以节点B为目的节点的路由表和转发表表项的更新。8.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，所述步骤5的具体过程为：当节点C需要对用户的密钥请求进行路由转发时，首先根据用户的密钥请求获取目的节点以及本次密钥请求所请求的密钥量，查询本地路由表，获取前往目的节点的/＞条最短可用路径/＞和对应的下一跳节点；其中，/＞条最短可用路径/＞组成最短可用路径集合且/＞；之后，节点C查询转发表，获取前往目的节点的条最短可用路径/＞对应的最小量子密钥量/＞，以及自上次转发表更新事件以来本节点向/＞条最短可用路径/＞转发的累积密钥量/＞；基于上述信息，节点C按照不同最短可用路径上的最小量子密钥量/＞将用户请求密钥量/＞按比例分摊到若干条最短可用路径上，实现负载均衡转发，即在最短可用路径/＞上发送的密钥量/＞为：其中，/＞为上次转发表更新事件以来本节点向所有最短可用路径转发的累积密钥总量；/＞为前往目的节点的最短可用路径集合/＞总量子密钥量；/＞为最短可用路径/＞上最小量子密钥量占最短可用路径集合/＞总量子密钥量的比例；在计算得到条最短可用路径/＞上发送的密钥量/＞后，节点C向/＞条最短可用路径/＞的下一跳节点的对应端口发送密钥量为/＞的量子密钥，同时自上次转发表更新事件以来本节点向/＞条最短可用路径/＞转发的累积密钥量/＞记录本次已转发的密钥量/＞，表示为：其中，/＞为经过本次密钥转发后本节点向/＞条最短可用路径/＞转发的累积密钥量；之后，节点C的每个端口独立向对应下一跳节点发送量子密钥，完成本次路由转发。9.根据权利要求1所述量子密钥分发网络中负载均衡的分布式路由方法，其特征在于，在所述步骤6中，当节点C收到链路的错误报文后，将删除本地关于节点A和节点B的相关拓扑以及链路/＞的量子密钥量信息；其中，错误报文包含节点信息以及对应发生故障的量子通信链路信息；之后节点C将重新计算本地路由表，若路由表表项改变，则更新路由表表项，并将对应转发表的表项中自上次转发表表项更新以来已转发密钥量清零；若路由表表项未改变，则直接结束上述过程。10.一种量子密钥分发网络中负载均衡的分布式路由系统，其特征在于，所述系统包括：设备接入与报文广播模块，用于当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，执行邻居发现机制，启动与邻居节点间的量子密钥协商过程；之后使节点A与节点B协商关于链路的路由通告主节点，并由链路/＞的路由通告主节点设置初始路由状态通告时间；每当链路/＞的量子密钥被消耗时，使路由通告主节点根据当前链路/＞量子密钥量更新路由状态通告时间；当到达路由状态通告时间后，使路由通告主节点向网络中广播链路/＞的量子密钥量更新报文，并根据当前链路/＞量子密钥量更新路由状态通告时间；路由计算与路由表更新模块，用于当量子密钥分发网络中的节点C收到来自链路的路由通告主节点广播的量子密钥量更新报文后，本地计算目的节点分别为节点A和节点B的最短可用路径集合以及对应的路径最小量子密钥量，并根据计算结果更新本地路由表和转发表；负载均衡转发模块，用于当节点A需要进行路由转发时，查询路由表和转发表，获取前往目的节点的最短可用路径集合及对应的路径最小量子密钥量，之后由节点A进行负载均衡转发，并按照路径最小量子密钥量将量子密钥转发到对应端口；路由错误处理模块，用于当链路出现故障，无法继续提供服务时，使链路/＞的路由通告主节点通过经典信道向网络中广播关于链路/＞的错误报文；当节点C收到网络中关于链路/＞的错误报文后，删除本地存储的关于节点A和节点B的相关拓扑信息和链路/＞的量子密钥量信息，重新计算路由并更新本地路由表和转发表。
说明书desc
技术领域本发明涉及信息通信技术领域，尤其涉及一种量子密钥分发网络中负载均衡的分布式路由方法及系统。背景技术信息安全一直是现代社会中至关重要的议题，特别是在数字化时代，我们对信息的保护变得愈发重要。传统的加密方法依赖于复杂的数学算法，其安全性基于数学难题的困难性。然而随着计算机算力的增长和量子计算的发展，这些传统加密方法可能面临着被破解的风险。为了应对日益增长的安全威胁，量子密钥分发技术应运而生，该技术可以实现无条件安全的量子密钥分发，从而有效地抵御量子计算攻击和传统计算攻击。随着QKD技术的不断发展，为了实现更大规模、更远距离的量子密钥分发，QKD网络应运而生。基于QKD网络，通信双方可以通过可信中继的方式，利用多个中继节点的逐跳转发实现任意网络节点之间的密钥分发，但是随着QKD网络规模的扩大，中继节点的数量和密钥分发路径的复杂性也会增加，QKD网络的路由问题成为一个重要的挑战。现有的路由算法主要分为两类：一类是集中式路由算法，利用集中控制器接收各节点的上报信息，并利用该信息计算和下发路由表。但由于路由计算和决策都依靠集中控制器，一旦集中控制器发生故障，整个网络的路由功能将受到影响。此外随着QKD网络的规模扩大，集中式路由将成为性能瓶颈且不利于进一步扩展；另一类是分布式路由算法，其可以在每一个节点上独立进行路由决策，大大提高了网络路由的效率和可靠性，但是现有的QKD网络不同链路密钥产生速率差异较大，已有分布式路由算法只考虑选择网络中的最短路径进行路由转发，这将导致网络中的负载分布不均衡，降低QKD网络的效率和可靠性。发明内容本发明的目的是提供一种量子密钥分发网络中负载均衡的分布式路由方法及系统，该方法及系统可以实现高带宽加密应用需求情况下的负载均衡，避免单一路径上密钥资源的耗尽；同时提升了路由信息的准确性，降低了报文广播的开销，从而提高了QKD网络的效率和可靠性。本发明的目的是通过以下技术方案实现的：一种量子密钥分发网络中负载均衡的分布式路由方法，所述方法包括：步骤1、当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，执行邻居发现机制，启动与邻居节点间的量子密钥协商过程，之后节点A与节点B协商关于链路的路由通告主节点，并由链路/＞的路由通告主节点设置初始路由状态通告时间/＞；步骤2、当用户向量子密钥分发网络发送密钥请求，触发端到端量子密钥分发过程且密钥请求的路由经过链路时，节点A与节点B之间共享的量子密钥会被消耗，在量子密钥消耗之后，链路/＞的路由通告主节点更新路由状态通告时间/＞；步骤3、当到达路由状态通告时间后，链路/＞的路由通告主节点检查节点A和节点B当前共享的量子密钥量，并向网络中广播链路/＞的量子密钥量更新报文，之后更新路由状态通告时间/＞；步骤4、当量子密钥分发网络中的节点C收到来自链路的路由通告主节点广播的量子密钥量更新报文后，本地计算目的节点分别为节点A和节点B的最短可用路径集合，以及所述最短可用路径集合中每条路径的最小量子密钥量，并根据计算结果更新本地路由表和转发表；步骤5、当节点C需要对用户的密钥请求进行路由转发时，查询步骤4更新后的本地路由表和转发表，获取最短可用路径集合及对应路径的最小量子密钥量，之后节点C进行负载均衡转发，按照所述最短可用路径集合中不同路径对应的最小量子密钥量将分组加密转发到对应端口；步骤6、当链路出现故障，无法继续提供服务时，链路/＞的路由通告主节点将通过经典信道向网络中广播关于链路/＞的错误报文；当节点C收到网络中关于链路的错误报文后，删除本地存储的关于节点A和节点B的相关拓扑信息和链路/＞的量子密钥量信息，重新计算路由并更新本地路由表和转发表。由上述本发明提供的技术方案可以看出，上述方法及系统可以实现高带宽加密应用需求情况下的负载均衡，避免单一路径上密钥资源的耗尽；同时提升了路由信息的准确性，降低了报文广播的开销，从而提高了QKD网络的效率和可靠性。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域的普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他附图。图1为本发明实施例提供的量子密钥分发网络中负载均衡的分布式路由方法流程示意图；图2为本发明实施例中网络负载均衡路由前状态示意图；图3为本发明实施例中网络负载均衡路由后的状态示意图；图4为本发明实施例提供的量子密钥分发网络中负载均衡的分布式路由系统的结构示意图。具体实施方式下面结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例，这并不构成对本发明的限制。基于本发明的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明的保护范围。如图1所示为本发明实施例提供的量子密钥分发网络中负载均衡的分布式路由方法流程示意图，所述方法包括：步骤1、当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，执行邻居发现机制，启动与邻居节点间的量子密钥协商过程，之后节点A与节点B协商关于链路的路由通告主节点，并由链路/＞的路由通告主节点设置初始路由状态通告时间/＞；在该步骤中，当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，首先节点A通过经典网络的路由协议获取网络拓扑状态，并在经典信道上广播Hello报文，在收到具有量子信道连接的相邻节点B的回复报文后，确认节点A与节点B的邻居关系，结束邻居发现过程；在邻居发现过程结束后，节点A和节点B通过量子信道开始执行链路上的量子密钥协商过程，并持续产生双方共享的量子密钥。之后，节点A与节点B协商关于链路的路由通告主节点，链路/＞的路由通告主节点是指当链路/＞的量子密钥量状态发生改变时，即节点A与节点B之间共享的量子密钥量发生改变时，负责广播通告其它节点的节点；在协商结束后，链路的路由通告主节点设置初始路由状态通告时间/＞，表示为：其中，/＞表示链路/＞的路由通告主节点协商结束时间；表示预设的全网路由状态最大通告周期。举例来说，如图2所示为本发明实施例中网络负载均衡路由前状态示意图，假设在该QKD网络中所设置全网路由状态通告最大更新周期设为10s，/＞时刻量子通信链路/＞、/＞、/＞、/＞均结束了路由通告主节点的协商，此时网络中各条链路初始路由状态通告时间/＞设为/＞，即为10s。步骤2、当用户向量子密钥分发网络发送密钥请求，触发端到端量子密钥分发过程且密钥请求的路由经过链路时，节点A与节点B之间共享的量子密钥会被消耗，在量子密钥消耗之后，链路/＞的路由通告主节点更新路由状态通告时间/＞；在该步骤中，当用户向量子密钥分发网络发送密钥请求，触发端到端量子密钥分发过程且路由经过链路时，节点A与节点B之间共享的量子密钥会被消耗；在量子密钥消耗之后，链路/＞的路由通告主节点更新路由状态通告时间/＞，具体计算公式为：其中，/＞表示链路/＞的量子密钥量因服务密钥请求而发生改变的时间；/＞表示预设的全网路由状态通告周期；/＞表示预设的全网路由状态最大通告周期；/＞表示链路/＞上量子密钥的平均产生速率；/＞表示链路/＞上密钥的平均消耗速率。步骤3、当到达路由状态通告时间后，链路/＞的路由通告主节点检查节点A和节点B当前共享的量子密钥量，并向网络中广播链路/＞的量子密钥量更新报文，之后更新路由状态通告时间/＞；在该步骤中，当到达路由状态通告时间后，链路/＞路由通告主节点检查节点A和节点B当前共享的量子密钥量，生成链路/＞的量子密钥量更新报文，并向网络中广播该报文，其中，链路/＞量子密钥量更新报文中包含链路/＞的剩余量子密钥量信息；当报文广播结束后，链路/＞路由通告主节点更新链路/＞路由状态通告时间/＞，具体计算公式为：其中，/＞表示链路/＞量子密钥量更新报文广播结束后时间；/＞表示预设的全网路由状态通告周期；/＞表示预设的全网路由状态最大通告周期；/＞表示链路/＞上量子密钥的平均产生速率；/＞表示链路/＞上密钥的平均消耗速率。步骤4、当量子密钥分发网络中的节点C收到来自链路的路由通告主节点广播的量子密钥量更新报文后，本地计算目的节点分别为节点A和节点B的最短可用路径集合，以及所述最短可用路径集合中每条路径的最小量子密钥量，并根据计算结果更新本地路由表和转发表；上述步骤中，最短可用路径是指从源节点出发到达目的节点的跳数最少的路径，并且该路径上经过的所有链路的最小量子密钥量大于0；最短可用路径集合是指从源节点出发到达目的节点的条最短可用路径/＞组成的集合/＞，其中，/＞；节点的本地路由表和本地转发表中的表项由以本节点为源节点，网络中其他节点为目的节点的对和/＞对所对应的表项值构成；其中，本地路由表中对所对应的表项值为源节点前往目的节点的/＞条最短可用路径/＞以及/＞的下一跳信息；本地转发表中/＞对所对应的表项值为源节点前往目的节点/＞条最短可用路径/＞的最小量子密钥量/＞，以及自上次转发表更新事件以来本节点向最短可用路径/＞转发的累积密钥量/＞。当节点C收到来自链路的路由通告主节点广播的量子密钥量更新报文后，更新本地维护的关于链路/＞的量子密钥量信息，并重新计算从节点C出发，分别到达节点A和节点B的最短可用路径集合/＞和/＞；当节点C计算得到以节点A为目的节点的最短可用路径集合后，根据所述最短可用路径集合/＞以及集合中/＞条最短可用路径/＞的下一跳信息，节点C更新本地以节点A为目的节点的路由表表项；其中，/＞；之后，根据所述最短可用路径集合中/＞条最短可用路径/＞的最小量子密钥量/＞更新本地以节点A为目的节点的转发表表项，并将转发表中自上次转发表更新事件以来本节点向/＞条最短可用路径/＞转发的累积密钥量/＞清零；节点C对以节点B为目的节点的最短可用路径集合重复上述过程，完成以节点B为目的节点的路由表和转发表表项的更新。举例来说，如图2所示，在该网络拓扑中，QKD节点A通过网络中各条链路的密钥量更新报文获取各链路的量子密钥量信息，此时量子通信链路、/＞、/＞、/＞上密钥量分为为/＞、/＞、/＞、/＞。根据QKD网络的拓扑状态，节点A计算前往各个节点的最短可用路径集合并更新路由表和转发表：以节点A计算并更新和节点D之间的路由表和转发表为例，节点A首先按照跳数筛选，筛选得到最短路径集合，集合中包含两条最短路径分别为/＞和/＞，此时检查最短路径集合/＞中路径可用性：路径/＞上最小密钥量为/＞，路径/＞上最小密钥量为/＞，因此这两条路径均为可用路径，最短可用路径集合为。在得到最短可用路径集合/＞后，节点A更新路由表，路由表内包含最短可用路径集合/＞和2条最短路径/＞的下一跳信息，即下一跳节点分别为节点B和节点C。之后，更新转发表内对2条最短路径/＞的最小密钥量/＞，分别为/＞和/＞，并将转发表中自上次转发表更新事件以来本节点向最短可用路径/＞转发的累积密钥量/＞清零，分别为0和0，完成前往目的节点D的路由表和转发表的更新。步骤5、当节点C需要对用户的密钥请求进行路由转发时，查询步骤4更新后的本地路由表和转发表，获取最短可用路径集合及对应路径的最小量子密钥量，之后节点C进行负载均衡转发，按照所述最短可用路径集合中不同路径对应的最小量子密钥量将分组加密转发到对应端口；上述步骤中，当节点C需要对用户的密钥请求进行路由转发时，首先根据用户的密钥请求获取目的节点以及本次密钥请求所请求的密钥量，查询本地路由表，获取前往目的节点的/＞条最短可用路径/＞和对应的下一跳节点；其中，/＞条最短可用路径/＞组成最短可用路径集合/＞且/＞；之后，节点C查询转发表，获取前往目的节点的条最短可用路径/＞对应的最小量子密钥量/＞，以及自上次转发表更新事件以来本节点向/＞条最短可用路径/＞转发的累积密钥量/＞；基于上述信息，节点C按照不同最短可用路径上的最小量子密钥量/＞将用户请求密钥量/＞按比例分摊到若干条最短可用路径上，实现负载均衡转发，即在最短可用路径上发送的密钥量/＞为：其中，/＞为上次转发表更新事件以来本节点向所有最短可用路径转发的累积密钥总量；/＞为前往目的节点的最短可用路径集合/＞总量子密钥量；/＞为最短可用路径/＞上最小量子密钥量占最短可用路径集合/＞总量子密钥量的比例；在计算得到条最短可用路径/＞上发送的密钥量/＞后，节点C向/＞条最短可用路径/＞的下一跳节点的对应端口发送密钥量为/＞的量子密钥，同时自上次转发表更新事件以来本节点向/＞条最短可用路径/＞转发的累积密钥量/＞记录本次已转发的密钥量/＞，表示为：其中，/＞为经过本次密钥转发后本节点向/＞条最短可用路径/＞转发的累积密钥量；之后，节点C的每个端口独立向对应下一跳节点发送量子密钥，完成本次路由转发。举例来说，在如图2所示的路由表和转发表下，假设0s时刻QKD节点A需要对用户的密钥请求进行路由转发，该请求所请求的密钥量为，请求的目的节点为节点D，网络中量子通信链路/＞、/＞、/＞、/＞的链路密钥平均产生速率均为/＞。此时对节点A来说，首先查询前往节点D的路由表，得到前往节点D的最短可用路径集合以及2条最短可用路径/＞的下一跳节点，即节点B和节点C。之后节点A查询对应转发表，前往目的节点D的2条最短可用路径/＞对应的最小量子密钥量/＞：通过节点B发往节点D的路径/＞最小密钥量/＞为/＞，通过节点C发往节点D的路径/＞最小密钥量/＞为/＞。节点A继续查询转发表得到自上次转发表更新事件以来本节点向最短可用路径转发的累积密钥量/＞：通过节点B发往节点D的路径/＞已转发密钥量/＞为0，通过节点C发往节点D的路径/＞已转发密钥量/＞为0。之后节点A代入负载均衡策略，可以得到节点A在最短可用路径/＞上发送的密钥量/＞：通过节点B发往节点D的路径/＞的密钥量/＞为/＞，通过节点C发往节点D的路径/＞的密钥量/＞为/＞。在计算得到/＞条最短可用路径/＞上发送的密钥量/＞后，节点A向最短可用路径/＞的下一跳节点对应端口发送密钥量为/＞的量子密钥，同时节点A中同时自上次转发表更新事件以来本节点向/＞条最短可用路径/＞转发的累积密钥量/＞记录本次已转发的密钥量/＞：自上次转发表更新事件以来节点A通过节点B发往节点D的路径转发的累积密钥量/＞为/＞，通过节点C发往节点D的路径/＞转发的累积密钥量/＞为/＞。之后，节点C的每个端口独立向对应下一跳节点发送量子密钥，完成本次路由转发。在时刻完成路由转发后，每条量子通信链路根据当前链路量子密钥量信息，更新路由状态通告时间/＞：假设预设的全网路由状态通告周期，以链路/＞为例，此时链路/＞上密钥的平均产生速率/＞为/＞，链路/＞上密钥的平均消耗速率/＞为/＞，根据上述公式，链路/＞的路由通告主节点更新路由状态通告时间/＞。当到达链路的路由状态通告时间/＞时，即/＞时，链路/＞的路由通告主节点检查节点A和节点C当前共享的量子密钥量，生成密钥量更新报文并由向网络中其他节点广播该报文，之后，更新路由状态通告时间/＞：网络中其他节点B接收到密钥量更新报文后，将更新本地网络拓扑信息并重新计算路由表和转发表。如图3所示为本发明实施例中网络负载均衡路由后的状态示意图，在路由表和转发表更新结束后，继续重复上述负载均衡转发流程。步骤6、当链路出现故障，无法继续提供服务时，链路/＞的路由通告主节点将通过经典信道向网络中广播关于链路/＞的错误报文；当节点C收到网络中关于链路的错误报文后，删除本地存储的关于节点A和节点B的相关拓扑信息和链路/＞的量子密钥量信息，重新计算路由并更新本地路由表和转发表。上述步骤中，当节点C收到链路的错误报文后，将删除本地关于节点A和节点B的相关拓扑以及链路/＞的量子密钥量信息；其中，错误报文包含节点信息以及对应发生故障的量子通信链路信息；之后节点C将重新计算本地路由表，若路由表表项改变，则更新路由表表项，并将对应转发表的表项中自上次转发表表项更新以来已转发密钥量清零；若路由表表项未改变，则直接结束上述过程。举例来说，在如图2所示拓扑中，当量子通信链路出现故障，无法继续提供服务时，链路/＞的路由通告主节点将通过经典信道向网络中广播链路/＞错误报文，告知网络中其他节点链路/＞的故障信息；当节点A收到链路故障信息后，将删除本地关于节点C和节点D的相关拓扑以及链路/＞的密钥量信息，并重新计算本地路由表：若路由表表项改变，则更新路由表表项，并将对应转发表表项中自上次转发表表项更新以来已转发密钥量清零；若路由表表项未改变，则直接结束上述过程。基于上述方法，本发明实施例还提供了一种量子密钥分发网络中负载均衡的分布式路由系统，如图4所示为所述系统的结构示意图，所述系统包括：设备接入与报文广播模块，用于当量子密钥分发网络QKD设备节点A接入量子密钥分发网络后，执行邻居发现机制，启动与邻居节点间的量子密钥协商过程；之后使节点A与节点B协商关于链路的路由通告主节点，并由链路/＞的路由通告主节点设置初始路由状态通告时间；每当链路/＞的量子密钥被消耗时，使路由通告主节点根据当前链路量子密钥量更新路由状态通告时间；当到达路由状态通告时间后，使路由通告主节点向网络中广播链路/＞的量子密钥量更新报文，并根据当前链路/＞量子密钥量更新路由状态通告时间；路由计算与路由表更新模块，用于当量子密钥分发网络中的节点C收到来自链路的路由通告主节点广播的量子密钥量更新报文后，本地计算目的节点分别为节点A和节点B的最短可用路径集合以及对应的路径最小量子密钥量，并根据计算结果更新本地路由表和转发表；负载均衡转发模块，用于当节点A需要进行路由转发时，查询路由表和转发表，获取前往目的节点的最短可用路径集合及对应的路径最小量子密钥量，之后由节点A进行负载均衡转发，并按照路径最小量子密钥量将量子密钥转发到对应端口；路由错误处理模块，用于当链路出现故障，无法继续提供服务时，使链路的路由通告主节点通过经典信道向网络中广播关于链路/＞的错误报文；当节点C收到网络中关于链路/＞的错误报文后，删除本地存储的关于节点A和节点B的相关拓扑信息和链路/＞的量子密钥量信息，重新计算路由并更新本地路由表和转发表。上述各模块的具体实现方式见上述方法实施例所述。值得注意的是，本发明实施例中未作详细描述的内容属于本领域专业技术人员公知的现有技术。综上所述，本发明实施例所述方法及系统具有如下优点：1、本实施例通过获取前往目标节点的最短可用路径集合和对应的最小密钥量，按比例将单一最短路径上的负载分摊到若干条最短可用路径上，可以实现高带宽加密应用需求情况下的负载均衡，避免单一路径上密钥资源的耗尽；2、本实施例提出了一种路由状态通告时间动态调整机制，该机制可以根据当前量子通信链路的密钥产生速率和消耗速率，动态调整路由状态通告时间，提升了路由信息的准确性，降低了报文广播的开销，提升了QKD网络的效率和可靠性。另外，本领域普通技术人员可以理解实现上述实施例方法中的全部或部分步骤是可以通过程序来指令相关的硬件完成，相应的程序可以存储于一种计算机可读存储介质中，上述提到的存储介质可以是只读存储器，磁盘或光盘等。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明披露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应该以权利要求书的保护范围为准。本文背景技术部分公开的信息仅仅旨在加深对本发明的总体背景技术的理解，而不应当被视为承认或以任何形式暗示该信息构成已为本领域技术人员所公知的现有技术。
