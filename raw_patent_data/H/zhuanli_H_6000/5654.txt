标题title
氛围灯设备及发光分区布局构造方法、装置和计算机设备
摘要abst
本申请涉及一种氛围灯设备及发光分区布局构造方法、装置和计算机设备，所述方法包括：基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位；构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑；响应布局构造指令，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局。本申请通过灯带图像抽象出灯带模型用于确定发光灯带的灯位的顺序位置信息，为发光灯带构造其发光分区布局实现了易理解、易操作的人机交互功能，可以提升发光灯带的配置效率，使此类氛围灯设备更易推广普及。
权利要求书clms
1.一种发光分区布局构造方法，其特征在于，包括：基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位；构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑；响应布局构造指令，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局。2.根据权利要求1所述的发光分区布局构造方法，其特征在于，基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位，包括：启动摄像单元采集所述发光灯带处于点亮状态下的灯带图像；基于所述灯带图像确定其中的发光灯带的造型区域以定义该发光灯带的造型路径，提取所述造型区域内的灯带本体图像；识别所述灯带本体图像中的亮灯显著特征，确定每个亮灯显著特征所在的位置作为相应的灯位。3.根据权利要求1所述的发光分区布局构造方法，其特征在于，基于所述灯带图像确定其中的发光灯带的造型区域以定义该发光灯带的造型路径，包括：将所述灯带图像输入预设的目标检测模型，检测出其中的发光灯带的区域图像；将所述区域图像输入预设的图像分割模型，识别出其中的发光灯带的造型区域以定义该发光灯带的造型路径。4.根据权利要求1所述的发光分区布局构造方法，其特征在于，构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑，包括：将所述造型路径转换为矢量曲线；对应各个灯位在所述造型路径的位置，在所述矢量曲线的相应位置处添加每个灯位相对应的可视标识；将所述矢量曲线和所述可视标识绘制到界面画布中成为灯带模型后渲染显示。5.根据权利要求1所述的发光分区布局构造方法，其特征在于，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局，包括：根据所述灯带模型中的各个灯位相对于界面画布的坐标信息确定每个灯位的位置信息；根据各个灯位在所述灯带模型的造型路径中的顺序确定每个灯位的顺序信息，所述顺序以所述造型路径中的信号输入端为排序起始端；合并各个灯位的位置信息和顺序信息成为顺序位置信息，将各个灯位的顺序位置信息封装为发光灯带的发光分区布局。6.根据权利要求1至5中任意一项所述的发光分区布局构造方法，其特征在于，响应布局构造指令之前，包括：基于所述灯带图像，识别出所述造型路径中的信号输入端，以该信号输入端为排序起始端确定各个所述灯位的顺序。7.根据权利要求6所述的发光分区布局构造方法，其特征在于，响应布局构造指令之前，包括：响应灯位标定指令，确定该指令所指定的灯位为适于确定顺序位置信息的有效灯位。8.一种发光分区布局构造装置，其特征在于，包括：图像分析模块，设置为基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位；模型展示模块，设置为构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑；布局构造模块，设置为响应布局构造指令，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局。9.一种氛围灯设备，其特征在于，包括控制器和至少一个发光灯带，所述控制器用于接收如权利要求1至7中任意一项所述的方法所生成的发光分区布局，根据所述发光分区布局控制所述发光灯带播放灯效。10.一种计算机设备，包括中央处理器和存储器，其特征在于，所述中央处理器用于调用运行存储于所述存储器中的计算机程序以执行如权利要求1至7中任意一项所述的方法的步骤。
说明书desc
技术领域本申请涉及照明控制领域，尤其涉及一种氛围灯设备及发光分区布局构造方法、装置和计算机设备。背景技术一种氛围灯设备中，采用发光灯带作为其负责发光渲染氛围的灯体，由于发光灯带具有柔韧性，可将发光灯带弯曲塑造为各种期望的形状，例如花朵、云朵或者其它图案等。当需要通过发光灯带播放相应的灯效时，灯效可以根据参考图像之类的素材提供颜色分布，将该颜色分布投射到发光灯带中，通过发光灯带中的各个发光单元协同播放相应的灯效，展示相应的颜色分布，起到光线氛围渲染的效果。为了支持颜色分布到发光灯带的投射，需要知晓发光灯带中，各个发光单元在发光灯带所形成的图案平面上的位置分布，当需要投射颜色分布时，对照这个位置分布便可实现投射。确定这个位置分布的方式，常借助人工手动设计来实现，效率明显较低。本申请人曾试图利用终端设备提供的人机交互功能来实现辅助确定位置分布，但旧有的方案主要是因应平面形状的灯块拼接灯具来设计，无法有效适用于发光灯带，导致无法为发光灯带快速生成相应的位置分布。发明内容本申请的目的在于提供一种氛围灯设备及发光分区布局构造方法、装置和计算机设备。根据本申请的一个方面，提供一种发光分区布局构造方法，包括：基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位；构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑；响应布局构造指令，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局。根据本申请的另一方面，提供一种发光分区布局构造装置，包括：图像分析模块，设置为基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位；模型展示模块，设置为构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑；布局构造模块，设置为响应布局构造指令，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局。根据本申请的另一方面，提供一种氛围灯设备，包括控制器和至少一个发光灯带，所述控制器用于接收如所述发光分区布局构造方法所生成的发光分区布局，根据所述发光分区布局控制所述发光灯带播放灯效。根据本申请的另一方面，提供一种计算机设备，包括中央处理器和存储器，所述中央处理器用于调用运行存储于所述存储器中的计算机程序以执行所述发光分区布局构造方法的步骤。相对于现有技术，本申请适应发光灯带具有柔韧性可造型的特点，基于灯带图像直接确定发光灯带的造型路径，同时确定出该造型路径中的多个灯位，根据造型路径和各个灯位构造出发光灯带相对应的灯带模型，将该灯带模型显示到界面画布中，实现将该发光灯带抽象为图形用户界面中的图形对象，并且在其中指示出各个灯位，方便用户编辑修正灯位，当用户触发布局构造指令时，响应于该指令，再将灯带模型中，各个灯位的顺序位置信息封装为发光分区布局，其中以界面画布为参考平面，准确表示出各个灯位的顺序位置信息，便可得到准确描述了各个灯位的位置分布的发光分区布局。该发光分区布局可以提供给该发光灯带所在的氛围灯设备的控制器使用，当该控制器播放灯效时，可以根据该发光分区布局确定发光灯带的每个灯位的顺序位置信息，根据该顺序位置信息准确投射灯效。本申请为发光灯带构造其发光分区布局实现了易理解、易操作的人机交互功能，可以提升发光灯带的配置效率，使此类氛围灯设备更易推广普及。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本申请示例性的氛围灯设备的电气结构示意图，其中，氛围灯设备的发光灯带被塑造为水壶状以表示其可按任意形状塑型；图2为本申请实施例中的发光分区布局构造方法的流程示意图；图3、图4、图5均为示例性的图形用户界面，其中：图3展示摄像预览界面，以展示出灯带图像；图4展示位于界面画布中的灯带模型，该灯带模型指示出图3所示的发光灯带的造型路径及其中的各个灯位；图5展示在图4的灯带模型的基础上进入手动连线相对应的手动编辑模式后，由用户连线所确认的手动造型路径，通过该造型路径将其所覆盖的灯位确认为有效灯位；图6为本申请实施例中根据灯带图像确定造型路径和各个灯位的流程示意图；图7为本申请实施例中构造并展示灯带模型的流程示意图；图8为本申请实施例中构造发光分区布局的流程示意图；图9为本申请实施例中的发光分区布局构造装置的结构示意图；图10为本申请实施例中的计算机设备的结构示意图。具体实施方式请参阅图1，本申请一种实施例提供的一种氛围灯设备的结构示意图中可以看出，所述氛围灯设备包括控制器1、灯体2，以及图像获取接口，灯体2与控制器1电性连接，以便接受控制器1中运行的计算机程序的控制协同工作，实现灯效播放。控制器1通常包括控制芯片、通信组件以及总线接头，在一些实施例中，控制器1还可以按需配置电源适配器、控制面板、显示屏等。电源适配器主要用于将市电转换为直流电，以便为整个氛围灯设备供电。控制芯片可采用各种嵌入式芯片实现，例如蓝牙SoC、WiFi SoC、MCU 、DSP等各种类型的芯片，控制芯片通常包括中央处理器和存储器，存储器和中央处理器分别用于存储和执行程序指令，以实现相应的功能。以上各种类型的控制芯片，可以自带通信组件，也可按需额外配置通信组件。通信组件可以用于与外部设备通信，例如，可以与个人计算机或各种智能手机之类的终端设备通信，以便用户通过其终端设备下达各种配置指令之后，控制器1的控制芯片可以通过通信组件接收配置指令，完成基础配置，以便控制灯体工作。此外，控制器1还可以通过通信组件获取终端设备的界面图像，或者获取摄像单元3采集的实时预览图像。总线接头主要用于为接入总线的灯体2接入电源并提供灯效播放指令，因而对应提供电源总线和信号总线相对应的针脚，由此，当灯体2需要接入控制器1时，通过灯体2相应的接头与所述总线接头连接即可。控制面板通常提供一个或多个按键，用于对控制器1实施开关控制、选择各种预设的灯效控制方式等等。显示屏可用于显示各种控制信息，以便与所述控制面板中的按键相配合，支持人机交互功能的实现。一些实施例中，控制面板与所述显示屏可以集成到同一触控显示屏中。氛围灯设备中的灯体2，采用发光灯带实施，可以包含一条或多条发光灯带，由于发光灯带具有柔韧性，因而可以塑造成任意形状的布局。每条发光灯带21都包括多个串接而成的灯珠210，每个灯珠210作为一个发光单元，并且，每条发光灯带21内的灯珠210数量可以相同，且等间距排列。同一发光灯带21中的各个灯珠210由接入总线的同一组线缆传输工作电流，同一发光灯带21的各个灯珠210之间，在电性连接关系上，可以采用并联的方式进行连接。图像获取接口既可以是硬件接口，也可以是实现于控制器1中的软件接口。当为硬件接口时，图像获取接口可以实现为摄像单元3，由控制器1加载相应的驱动程序驱动摄像单元3工作，当将摄像单元3对准目标画面时，例如对准终端设备的显示桌面，或者将摄像单元3对准实体空间环境，按照一定的帧率采集图像，便可采集到界面图像。当为软件接口时，图像获取接口可以是借助终端设备的操作系统所提供的图形基础结构技术而在控制器1侧实现的图像获取程序，控制器1通过各种线缆例如HDMI、Type-C连接线与终端设备相连接，便可在该图形基础结构技术的支持下，持续获得终端设备的界面图像；当然，如果控制器1与终端设备中预先建立无线投屏协议，控制器1也可以通过无线通信的方式，获取终端设备的界面图像。操作系统的图形基础结构技术，视操作系统类型不同而不同，示例而言，Windows操作系统中，提供了相应的技术，即：Microsoft DirectX GraphicsInfrastructure，简称DXGI，便可实现此一功能。由此可见，图像获取接口负责采集环境参照图像时，其采集图像的具体环境可由用户灵活设定，例如，当图像获取接口为摄像单元3时，用户可以将摄像单元3对准计算机的图形用户界面进行拍摄以采集相应的界面图像作为目标图像用来播放灯效，使灯体2可以根据界面图像生成相应的灯效描述数据；用户也可以将摄像单元3对准实体空间环境例如户外环境，摄录实景图像作为环境参照图像，使灯体2可以生成实景相对应的灯效描述数据。当氛围灯设备要根据灯效描述数据播放灯效时，其控制器1需根据其灯体2的相对应的发光分区布局提供其灯体2中各个发光单元的顺序位置信息，以便将相应的灯效描述数据解析成各个发光单元的控制数据，并且按照各个发光单元的顺序位置信息将各个控制数据封装成灯效控制数据，然后将灯效控制数据发送至相应的发光灯带，由发光灯带中的各个发光单元的控制芯片，提取出自身相对应的控制数据，根据该控制数据控制其中的各个发光元件发出相应的色光，在各个发光单元发出色光的协同作用下，实现整个灯效的播放。根据以上氛围灯设备的产品架构和工作原理，本申请的氛围灯设备的发光分区布局构造方法，可以实现为计算机程序产品，运行于终端设备中，通过对拍摄氛围灯设备中的发光灯带所得到的灯带图像进行分析，得到发光灯带相对应的发光分区布局，提供给相应的氛围灯设备的控制器作为播放灯效的基础配置信息。请参阅图2，在部分实施例中，本申请的发光分区布局构造方法，运行在适于与本申请的氛围灯设备通信连接的终端设备中，包括：步骤S5100、基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位；本申请可基于对氛围灯设备中灯体所采用的发光灯带进行拍摄所得的灯带图像进行图像分析，来确定用户对发光灯带塑型之后形成的造型路径，同时还可以在图像分析过程中，确定分布在该造型路径上的各个灯位。此处所称的灯位，是基于对灯带图像进行图像分析得到的用于指示造型路径上的发光单位，这个发光单位既可以是对应发光灯带中的发光单元而设定，也可以是对应发光灯带中标准数量或标准长度范围的多个发光单元而设定，所以，在计算机程序层面，既可以将灯位表示为该造型路径中的区段，每个区段可以对应指示覆盖一个或数个发光单元；也可以表示为该造型路径中的节点，每个节点表示造型路径中的仅一个发光单元。实际实现时，可根据需求而定，以使对发光灯带的分区管理更具灵活性。为便于理解，不妨将本申请以下实施例中提及的每个灯位视为对应发光灯带中的一个发光单元。根据灯带图像确定发光灯带的造型路径有多种，选用以下任意一种方式实施均可：一种实施例中，可以根据单张灯带图像进行图像分割，得到其中的发光灯带的图像掩膜，该图像掩膜实际上描述了发光灯带在灯带图像中的造型所处的区域，即造型区域。由于发光灯带的造型区域必然呈线状，所以，通过该造型区域也便定义出了发光灯带的造型路径。在本实施例中，灯带图像可以是发光灯带亮灯前或亮灯后的图像。按照此种方式端到端确定造型路径，较为精准。另一实施例中，可以根据单张灯带图像进行二值化转换，在转换而得的二值化图像的基础上借助各种已知的边缘检测算法进行边缘检测，从而得到该造型区域，以定义出发光灯带的造型路径。同理，在本实施例中，灯带图像可以是发光灯带亮灯前或亮灯后的图像。按照这种方式确定造型路径，运算量少，识别迅速，实施成本低，更为经济。以上确定发光灯带的造型路径的两种实施例中，为了提升造型路径检测的准确度，还可以在获取单张灯带图像之前，先通过终端设备向氛围灯设备发送亮灯指令，使氛围灯设备先控制发光灯带亮灯，然后再行启动摄像单元获取灯带图像。由于此时发光灯带处于亮灯状态，所得的灯带图像中的发光灯带更为高亮，无论是进行图像分割带是进行边缘检测，均能够在高亮特征的帮助下，更准确地确定发光灯带在灯带图像中的造型区域。根据灯带图像确定发光灯带的造型路径的再一实施例中，可以在开启终端设备的摄像单元进行摄像预览之后，获取发光灯带亮灯前后的两帧灯带图像，将两张灯带图像对齐后求解帧差信息，该帧差信息中对应发光灯带所在位置处的像素会得到显著数值，具有显著数值的像素的集合便构成发光灯带的造型区域，也就定义出了相应的造型路径。此种方式同样具有运算量少，快速高效的优势。图3是在示例性的场景中对一个氛围灯设备的发光灯带拍摄所获得的灯带图像，该发光灯带处于点亮状态，因而，灯带图像中的发光灯带较为高亮，可供参考。当确定了发光灯带的造型路径之后，还可以进一步检测分布在该造型路径上的各个灯位，确定造型路径上的灯位的方式也有多种，选用以下任意一种方式实施均可：一种实施例中，可以按照如下过程实施：根据灯带图像的成像焦距计算出灯带图像在实体空间相对应的实际尺寸；然后，基于灯带图像中的造型区域计算出造型路径的长度作为发光灯带的实际尺寸；最后，再根据预设的分区占位参数对造型路径进行分段，每个分段便构造一个相应的灯位。其中，分区占位参数可以是发光灯带中相邻两个发光单元之间的间距，也可以是发光灯带的发光单元总数，根据该间距或总数对该实际尺寸进行平均划分，便可确定各个区段，从而确定各个灯位。分区占位参数还可以是用于指示构成一个灯位的发光单元标准数量，按照每标准数量的一组发光单元为一个灯位进行划分设定即可。根据本实施例，在预先设定分区占位参数的情况下，无需依赖于发光灯带是否点亮，可以自动化地确定灯带图像中的各个灯位，确定灯位的算法关联于成像的物理焦距来确定，较为准确，无需人工干预，更为高效。其中，分区占位参数可以由用户事先设定或者使用应用程序提供的出厂默认设置。另一实施例中，可以按如下过程实施：先向氛围灯设备发送特定亮灯指令，控制发光灯带的各个发光单元以特定的颜色分布高亮工作，使相邻两个发光单元之间显示不同的颜色；在灯带图像中，沿发光灯带的造型路径，根据相邻发光单元所辐射的光线不同的特征，在造型路径中划分出多个区段，每个区段便构成一个相应的灯位。按照这种方式确定各个灯位，无需依赖分区占位参数，更具灵活适用性，也即，不会受制于发光灯带的长度、发光单元间距等因素影响，无论发光灯带的长度多长，发光单元之间间距多少，均可以有效识别出其中的各个灯位。此处用到的特定亮灯指令，还可以与前文利用发光灯带的亮灯后的图像确定造型路径的实施例相结合使用，也即，在第一时间通过该特定亮灯指令控制发光灯带点亮，得到亮灯后的灯带图像，既可以用于确定造型路径，也可以用于本实施例中确定各个灯位。可见，本实施例可具有与前文关于利用亮灯后图像确定造型路径的实施例有机结合的效率优势。步骤S5200、构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑；确定出发光灯带在灯带图像中的造型路径和各个灯位后，可以将该造型路径和各个灯位迁移表示到终端设备的图形用户界面中，以便借助终端设备的人机交互能力，供用户编辑其中的灯位。为此，可以先在图形用户界面中设定一个界面画布，由此也就定义了一个参考坐标系，然后，将造型路径构造为一个灯带模型，定位显示到该界面画布中，相对整体居中显示以便取得更佳的可视效果，同时，在构造灯带模型时，也将沿造型路径分布的各个灯位标示到相应的位置处，也即为灯带模型所表示的造型路径中的各个灯位显示其可视标识，由此，通过界面画布中的灯带模型，实现对灯带图像中发光灯带的造型路径和各个灯位的可视化表示，用户便可通过界面画布浏览灯带模型的全图，可对其进行缩放、平移、编辑等操作。图4是根据图3所示的灯带图像确定造型路径及各个灯位之后，在界面画布中展示的灯带模型的示例。在图4所示的界面中，发光灯带的造型路径被显示为灰色，其中的各个灯位以浅色图点为可视标识示出，在灯带模型的下方，提供灯带图像浏览键用于显示或隐藏图3所示的灯带图像，即据以确定灯带模型的灯带图像，方便用户引用参考。灯带模型的下方还提供有“手动连线”相对应的按键，用于切换到用户手动编辑模式，供用户从该灯带模型的多个灯位中确认有效灯位，以便用于步骤S5500中构造发光分区布局。当用户未触控“手动连线”按键进入手动编辑模式便点击下方的“下一步”按键时，图4所示界面中的灯带模型上的每个灯位均会被默认为有效灯位用于步骤S5500中构造发光分区布局。参考图4可知，用户可以基于灯带模型进行手动编辑操作以确认发光灯带中的各个灯位，进入图5所示的界面，在该界面中，例如，用户可以自行对其中的多个有效灯位进行连线以示确认，用户的连线构成事实上的手动造型路径，该手动造型路径所覆盖的灯位，构成有效灯位，未被该手动造型路径覆盖的灯位即为无效灯位，从而将无效灯位排除在其连线之外，在此过程中，用户可以分多次补充同一连线，直至达到期望的连线状态，在用户每次连线操作释放连线动作时可以触发相应的灯位标定指令，响应于该指令，终端设备确认被连线的灯位为有效灯位，将连线未覆盖的灯位视为无效灯位，后续在构造发光分区布局时只针对有效灯位进行相应的处理，而不对无效灯位进行处理。步骤S5500、响应布局构造指令，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局。当用户认为灯带模型中各个灯位的分布关系准确后，可以在终端设备中触发布局构造指令，其触发方式可以是基于图形用户界面中提供的按键例如通过触控图5所示的界面中的“完成识别”控键触发该指令，或者通过其它手势操作、摇一摇、语音指令等任意指定的操控方式产生。响应于该布局构造指令，终端设备以该界面画布为参考坐标系，确定各个灯位的位置信息，以该灯带模型的造型路径为排序依据，确定各个灯位的顺序信息，将各个灯位的顺序信息和位置信息联合表示为顺序位置信息，将各个灯位的顺序位置信息按照预设的协议格式进行封装构成对发光灯带中的各个灯位的分布关系的描述信息，成为发光分区布局。本申请所确定的发光分区布局，可以存储到云端服务器或存储在终端设备本地，以备再次调用，例如，当需要编辑氛围灯设备的灯效时，可以利用该发光分区布局再次生成发光灯带的灯带模型，方便用户在灯带模型的基础上，为各个灯位设定颜色、配置灯效运动模式等。终端设备还可以将该发光分区布局传输到氛围灯设备的控制器中，成为控制器播放灯效的基础信息，控制器存储该发光分区布局后，当接收到灯效描述数据时，将其解析转换为多个播放帧，对应每个播放帧，根据发光分区布局中指定的各个顺序位置的灯位相对应的发光单元生成相应的控制数据，将全部发光单元的控制数据封装为灯效控制数据，传输给发光灯带，发光灯带中的各个发光单元，从灯效控制数据中提取自身相对应的控制数据，控制自身相应的发光元件发射相应的色光，据此，整条发光灯带中的各个发光单元协同播放同一帧灯效，进而，通过播放多个播放帧，还可实现播放同一运动灯效。根据以上实施例可以理解，本申请适应发光灯带具有柔韧性可造型的特点，基于灯带图像直接确定发光灯带的造型路径，同时确定出该造型路径中的多个灯位，根据造型路径和各个灯位构造出发光灯带相对应的灯带模型，将该灯带模型显示到界面画布中，实现将该发光灯带抽象为图形用户界面中的图形对象，并且在其中指示出各个灯位，方便用户编辑修正灯位，当用户触发布局构造指令时，响应于该指令，再将灯带模型中，各个灯位的顺序位置信息封装为发光分区布局，其中以界面画布为参考平面，准确表示出各个灯位的顺序位置信息，便可得到准确描述了各个灯位的位置分布的发光分区布局。该发光分区布局可以提供给该发光灯带所在的氛围灯设备的控制器使用，当该控制器播放灯效时，可以根据该发光分区布局确定发光灯带的每个灯位的顺序位置信息，根据该顺序位置信息准确投射灯效。本申请为发光灯带构造其发光分区布局实现了易理解、易操作的人机交互功能，可以提升发光灯带的配置效率，使此类氛围灯设备更易推广普及。在本申请的方法的任意实施例的基础上，请参阅图6，基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位，包括：步骤S5110、启动摄像单元采集所述发光灯带处于点亮状态下的灯带图像；本申请中，可以利用发光灯带点亮之后被拍摄所得的图像，也即灯带图像，快速检测出灯带图像中发光灯带的造型路径和各个灯位。为此，可以在氛围灯设备的发光灯带被点亮的状态下，启动终端设备的摄像单元，拍摄点亮状态下的发光灯带，得到相应的灯带图像。一种实施例中，用户在终端设备中，用户调用摄像单元用于采集灯带图像时，便在后台自动向氛围灯设备发送一个亮灯指令，氛围灯设备的控制器接收到该亮灯指令后，便控制发光灯带点亮而工作。该亮灯指令可以包含有指示发光灯带的各个发光单元相邻之间显示不同颜色之类的发光特征信息，控制器将该发光特征信息转换为各个发光单元的控制数据，构成灯效控制数据发送给发光灯带的各个发光单元，从而，确保相邻两个发光单元发出的色光都不相同，例如，使发光灯带按照红、绿、蓝、红、绿、蓝……这样的顺序发光。终端设备发出该亮灯指令后，便启动摄像单元进行图像数据采集，在后台得到预览图像，然后对各个预览图像进行目标识别或者指令特征检测，当其中一个预览图像中包含有发光灯带时，可提醒用户拍摄获取灯带图像。在进行目标识别时，可以借助目标检测模型实施；在进行指令特征检测时，可以检测灯带图像中是否存在与亮灯指令中设定的发光特征信息相对应的发光特征，当灯带图像中存在该发光特征信息相对应的发光特征时，便可提醒用户拍摄。本实施例中，通过后台识别机制，可以辅助用户确认灯带图像是否适于确定造型路径，如果灯带图像中发光灯带本体的图像不全，或者聚焦模糊，导致后台无法确定出发光灯带，便不会提示用户拍摄，这种情况下，可以引导用户获取有效的灯带图像。当然，在其他部分实施例中，用户可以自行控制氛围灯设备点亮其发光灯带，再由用户利用终端设备进行手动拍摄得到该发光灯带的灯带图像。在另外部分实施例中，终端设备可以开放亮灯指令给用户调用，由用户通过图形用户界面中的控键之类的触发方式按需触发。步骤S5120、基于所述灯带图像确定其中的发光灯带的造型区域以定义该发光灯带的造型路径，提取所述造型区域内的灯带本体图像；对于处于点亮状态下得到的灯带图像来说，由于发光灯带处于点亮状态下，所以，灯带图像中的发光灯带区域相对高亮，更易识别。这种情况下，可以如前文各种实施例所揭示，利用边缘检测或者图像分割技术，对灯带图像进行检测，确定出发光灯带在灯带图像中的图像内容区域，也即呈现其造型相对应的造型区域，该造型区域可以表示为一个图像掩膜，在图像掩码中，对应灯带图像中，将发光灯带的图像所覆盖的像素表示为1，将发光灯带的图像未覆盖的像素表示为0，从而，数值为1的像素的集合所构成的区域，便是该造型区域。由于发光灯带整体是呈线状的，所以，造型区域也必然呈线状，实际上也定义出了整个发光灯带的造型路径。此外，为便于集中进行灯位的识别，进一步可以根据该造型区域，例如该图像掩膜，从灯带图像中提取出造型区域内的全部像素，构成灯带本体图像，相当于在灯带图像的基础上，去除了发光灯带之外的全部背景图像，得到纯净的灯带本体图像。步骤S5130、识别所述灯带本体图像中的亮灯显著特征，确定每个亮灯显著特征所在的位置作为相应的灯位。发光灯带发光的状态下，如果其各个发光单元的光线未经柔化，在灯带本体图像中，各个发光单元对应的位置处，应是最高光部位，构成亮灯显著特征。即使发光灯带中各个发光单元的光线经过发光灯带中光路结构的柔化处理，借助亮灯指令中设定的发光特征信息所表现的亮灯显著特征，也仍然可以确定各个发光单元对应的位置。由此可见，只要根据实际情况确定需要识别的亮灯显著特征，在发光灯带中识别出各个亮灯显著特征，便可将各个亮灯显著特征所在的位置设定为相应的发光单元，将每个发光单元作为一个相应的灯位。以前文所示例的红、绿、蓝三色交替的发光特征为例，红、绿、蓝三色的色值差异明显，故直接以红、绿、蓝三色的标准值为参考，识别出灯带本体图像中，发光灯带的造型路径上，红、绿、蓝三色区段的各个最大值所在位置处作为亮灯显著特征，这些位置便是发光单元所在的位置，即构成相应的灯位。在其他示例中，即使发光灯带是单色发光，也可以通过检测造型路径中各个区域中的高亮区域，因为高亮区域通常是发光单元所在的区域，所以也可将高亮区域作为亮灯显著特征，设为相应的灯位。根据以上实施例可见，利用处于点亮状态的发光灯带的单张灯带图像，便可以一气呵成地确定出其造型路径，以及分布在造型路径上的各个灯位，较之采用多张图像识别灯体，具有运算量小、检测迅速高效的技术优势，无需人工干预，降低了用户配置氛围灯设备的难度。在本申请的方法的任意实施例的基础上，基于所述灯带图像确定其中的发光灯带的造型区域以定义该发光灯带的造型路径，包括：步骤S5121、将所述灯带图像输入预设的目标检测模型，检测出其中的发光灯带的区域图像；本实施例中，可以借助Yolo系列之类模型实现的深度学习模型，对灯带图像进行目标检测。将灯带图像输入该目标检测模型，由其预测出发光灯带的候选框和置信度，将其中置信度满足预设阈值的候选框，作为发光灯带的有效选框，从灯带图像中截取该有效选框相对应的图像作为区域图像，以去除其它背景图像信息的干扰。步骤S5122、将所述区域图像输入预设的图像分割模型，识别出其中的发光灯带的造型区域以定义该发光灯带的造型路径。进一步将该区域图像输入U-net、SAM之类的图像分割模型中，对其进行图像分割，通过图像分割得到其中的发光灯带的图像掩膜，该图像掩膜表示出发光灯带的各个像素在该区域图像中的位置，将该图像掩膜对应灯带图像进行扩充，便可构成与灯带图像相对应的图像掩膜，这个图像掩膜中，同样以数值1指示出发光灯带在灯带图像中的像素的位置，相当于指定了灯带图像中发光灯带所在的造型区域，从而定义出该发光灯带相对于灯带图像的造型路径。本实施例借助目标检测模型和图像分割模型等深度学习模型，对灯带图像进行造型路径的检测，利用深度学习模型所具有的强大的图像处理能力，实现端到端的精准检测效果，降低开发复杂度，节省开发成本，同时又能保障精准地确定发光灯带的造型路径。在本申请的方法的任意实施例的基础上，请参阅图7，构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑，包括：步骤S5210、将所述造型路径转换为矢量曲线；当需要将发光灯带表示到界面画布中时，由于事先已经确定了发光灯带的造型路径，其通过造型区域进行表示，据此，可以根据该造型区域，将造型路径转换矢量曲线。具体而言，发光灯带的造型区域实际上界定了一个基本等宽纵长的条状路径，据此，沿着造型区域的纵长方向，求取路径两侧的造型区域宽度方向两侧的中间像素点，这些中间像素点的连线便可用来定义和描述造型路径。进一步可以对这个造型路径进行平滑处理，使其成为过渡自然的曲线。为了便于进行计算机处理，还可以将该曲线转换为矢量曲线，通过近似曲线函数来描述该曲线。同理，可以利用造型区域中的任意一条长边来定义造型路径，得到相应的矢量曲线，本领域技术人员可参考以上揭示的方式灵活实施，恕不赘述。步骤S5220、对应各个灯位在所述造型路径的位置，在所述矢量曲线的相应位置处添加每个灯位相对应的可视标识；本申请基于灯带图像或其中的灯带本体图像检测出的各个灯位，当然也是沿其造型路径分布的，在这种情况下，还可以造型路径相对应的矢量基线为基础，对应每个灯位在造型路径中的位置，在矢量曲线的相应位置处，标示出已经检测出的各个灯位。为便于识别，可将各个灯位表示为圆点、短线段等任意可视形式，使其构成可视标识，以便随矢量曲线显示到界面画布中。步骤S5230、将所述矢量曲线和所述可视标识绘制到界面画布中成为灯带模型后渲染显示。在完成了矢量曲线和各个灯位的可视标识的构造成灯带模型的图形描述数据后，便可调用系统的图形开放库的图像渲染接口，根据该图形描述数据，利用GPU进行图像绘制，将该矢量曲线和可视标识绘制到界面画布中渲染显示。当需要缩放、平移、修改该矢量曲线或任意灯位时，只需对应修改其图形描述数据，便可同步更新界面画布中的灯带模型的图像效果。由于灯带模型在后台是以图形描述数据来表示的，属于矢量数据，所以，其资源占用低，刷新高效，且更方便进行缩放、平移、修改等操作。根据以上实施例可见，在构造发光灯带相对应的灯带模型时，先将发光灯带在灯带图像中的造型路径构造为矢量曲线，且将造型路径上的各个灯位配置为矢量曲线上相应位置处的可视标识，构成灯带模型的图形描述信息，再进行绘制渲染以显示到界面画布中，可以进一步支持对灯带模型的各种编辑操作，包括缩放、平移，增删修改等，有利于用户参与到其中确保精准构造发光分区分局。在本申请的方法的任意实施例的基础上，请参阅图8，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局，包括：步骤S5510、根据所述灯带模型中的各个灯位相对于界面画布的坐标信息确定每个灯位的位置信息；在用户触发布局构造指令之后，终端设备便可对界面画布中的灯带模型上的各个灯位确定其位置信息。本实施例所处理的灯位，是界面画布中的有效灯位。在用户未对终端设备所显示的灯带模型上的各个灯位进行修改的情况下，灯带模型上的各个灯位都属于有效灯位；在用户对其中的各个灯位进行修改的实施例中，例如用户通过连线放弃其中的一个或数个灯位，此时，可以将用户连线选定的灯位作为有效灯位，将未被连线的灯位作为无效灯位，只针对用户连线选定的有效灯位确定其位置信息。确定灯位的位置信息时，可以基于该界面画面所建立的参考坐标系确定各个灯位的位置信息，给出其相应的坐标进行位置信息的表示，当然，也可以替换为其他起相同作用的方式进行表示。步骤S5520、根据各个灯位在所述灯带模型的造型路径中的顺序确定每个灯位的顺序信息，所述顺序以所述造型路径中的信号输入端为排序起始端；同理，对于每个灯位来说，具体是对于每个需要确定位置信息的有效灯位来说，进一步还需要确定其在造型路径中的顺序信息，为此，可以造型路径任意一端，也即发光灯带的任意一端为排序起始端，按照各个灯位距离该排序起始端的远近，确定各个灯位的顺序信息。在一些实施例中，在事先确定了发光灯带的信号输入端的情况下，可以该信号输入端作为造型路径的排序起始端，以参考该排序起始端确定各个灯位的顺序信息。发光灯带的信号输入端可以事先由用户通过图形用户界面进行设定，例如，一种实施例中，可以是在步骤S5200之后，由用户在界面画布的灯带模型上选定造型路径中的两个端点任意之一作为信号输入端。在其他实施例中，也可以借助自动识别方式，确定出造型路径上的信号输入端。步骤S5530、合并各个灯位的位置信息和顺序信息成为顺序位置信息，将各个灯位的顺序位置信息封装为发光灯带的发光分区布局。确定出各个灯位的位置信息和顺序信息后，便可按照协议格式，主要是与控制器预协议的格式，对各个灯位的位置信息和顺序信息进行数据封装，以便得到相应的发光分区布局。一种实施例中，先以每个灯位，具体是指有效灯效，以有效灯位为单位，按照协议格式表示出其位置信息和顺序信息，将位置信息和顺序信息综合表示为顺序位置信息，然后再直接合并各个有效灯位的顺序位置信息成为发光分区布局即可。另一实施例中，根据发光灯带中的发光单元有序连接的特点，每个灯位的位置信息，按照各个灯位的顺序信息所指示的顺序进行有序拼接，从而，使各个灯位的顺序信息表示在其拼接顺序中，由此，更为高效地得到发光分区布局，相应的，在控制器一侧，也可快捷高效地解析得到各个发光单元的位置信息和顺序信息。根据以上实施例不难理解，本申请在灯带模型中确实出各个灯位后，便可基于界面画布提供的参考坐标系，确定各个灯位的位置信息，而根据各个灯位在发光灯带的造型路径中的排序，便可确定其相应的顺序信息，利用各个灯位的顺序信息和位置信息，便可构造出发光分区布局，实现对发光灯带在构图平面的造型的准确有效表示，为氛围灯设备播放灯效或者为终端设备定义灯效，提供了准确的基础数据。在本申请的方法的任意实施例的基础上，响应布局构造指令之前，包括：步骤S5400、基于所述灯带图像，识别出所述造型路径中的信号输入端，以该信号输入端为排序起始端确定各个所述灯位的顺序。本实施例可以基于灯带图像自动识别出发光灯带的信号输入端，以便更有效地表示各个灯位在造型路径中的顺序信息，例如：一种实施例中，可以利用目标检测模型对灯带图像内发光灯带中的特定形状或者特定部件例如电源适配器进行目标识别，将存在特定形状或者电源适配器的端部识别为信号输入端。另一实施例中，在按照前文事先向氛围灯设备发出亮灯指令的实施例，在该亮灯指令的作用下，发光灯带受控点亮呈现相应的发光特征，据此，可以对应该亮灯指令所定义的发光特征信息，根据灯带图像中相应表现的发光特征进行信号输入端的识别。以前文中控制发光灯带中各个发光单元顺次发出红、绿、蓝三种色光为例，其中，红色光为起点，考虑到发光灯带通过设置偶数个灯珠，其中位于端部且发射红色光的发光单元即为信号输入端所在处，所以，根据该发光特征，识别灯带图像中灯带本体图像的两端的色光的颜色值，当一个端部处的颜色值表征红色时，该端部即为信号输入端。由此可见，通过对灯带图像进行图像识别，可以识别出发光灯带的信号输入端，以此为依据确定造型路径中各个灯位的顺序信息，以供在发光分区布局中进一步表示出各个灯位的顺序位置信息，可以减少人工干预，提供自动化效率。在本申请的方法的任意实施例的基础上，响应布局构造指令之前，包括：步骤S5300、响应灯位标定指令，确定该指令所指定的灯位为适于确定顺序位置信息的有效灯位。尽管通过对灯带图像进行检测，可以确定出各个灯位，但有时候，由于灯带弯曲所导致的反光，或者由于环境照明条件所致，在识别灯带图像中的发光灯带的灯位时，也可能出现误识别，导致最终在灯带模型中出现多余的灯位的可视标识，这种情况下，可以向用户开放手动编辑模式，让用户进行手动编辑状态，手动指定各个灯位中的有效灯位。一种实施例中，如图5所示，用户可以在界面画布中，通过绘制连线发出灯位标定指令，将其确认为有效的灯位连接在同一条线上，终端设备对用户的连线予以高亮显示以方便用户识别，被用户的连线所覆盖的各个灯位，便构成用于构造发光分区布局的有效灯位，在步骤S5500执行发光分区布局的构造过程中，只针对用户指定的有效灯位进行顺序位置信息的构造即可。另一实施例中，用户可以单独针对灯带模型中的每个灯位的可视标识进行编辑操作以触发灯位标定指令，可以删除其中的个别灯位，或者微调灯位在造型路径中的位置，同时也可以增设个别灯位后再调整其在造型路径中的位置，诸如此类均可，最终显示在界面画布的灯带模型上的灯位，便被全部识别为用于构造发光分区布局的有效灯位。当用户完成对灯位的编辑后，可以基于图形用户界面触发相应的布局构造指令，进行发光分区布局的构造。本步骤的执行，当其与步骤S5400相结合使用时，可以在步骤S5400之前执行，也可以在其后执行，并不影响本申请的创造精神的体现。根据以上实施例可见，可以通过多种方式编辑灯带模型上的灯位，一方面，使用户可以根据发光灯带的实际情况确定有效灯位用于构造发光分区布局，另一方面，也可以发挥灯带模型引导用户定制灯位的作用，最终均可得到准确表示发光灯带的各个发光单元沿特定的造型路径分布相对应的位置分布信息，表示为发光分区布局，用于参考实现灯效的定制和播放。请参阅图9，本申请的另一实施例还提供一种发光分区布局构造装置，其包括图像分析模块5100、模型展示模块5200，以及布局构造模块5500，其中，所述图像分析模块5100，设置为基于灯带图像确定发光灯带的造型路径及该造型路径中的多个灯位；所述模型展示模块5200，设置为构造表示所述造型路径和各个所述灯位的灯带模型，显示至界面画布中供用户编辑；所述布局构造模块5500，设置为响应布局构造指令，将所述灯带模型中参考该界面画布确定的各个灯位的顺序位置信息构造为所述发光灯带的发光分区布局。在本申请的装置的任意实施例的基础上，所述图像分析模块5100，包括：图像获取单元，设置为启动摄像单元采集所述发光灯带处于点亮状态下的灯带图像；造型分析单元，设置为基于所述灯带图像确定其中的发光灯带的造型区域以定义该发光灯带的造型路径，提取所述造型区域内的灯带本体图像；灯位分析单元，设置为识别所述灯带本体图像中的亮灯显著特征，确定每个亮灯显著特征所在的位置作为相应的灯位。在本申请的装置的任意实施例的基础上，所述造型分析单元，包括：目标检测子单元，设置为将所述灯带图像输入预设的目标检测模型，检测出其中的发光灯带的区域图像；图像分割子单元，设置为将所述区域图像输入预设的图像分割模型，识别出其中的发光灯带的造型区域以定义该发光灯带的造型路径。在本申请的装置的任意实施例的基础上，所述模型展示模块5200，包括：路径转换单元，设置为将所述造型路径转换为矢量曲线；灯位标识单元，设置为对应各个灯位在所述造型路径的位置，在所述矢量曲线的相应位置处添加每个灯位相对应的可视标识；渲染显示单元，设置为将所述矢量曲线和所述可视标识绘制到界面画布中成为灯带模型后渲染显示。在本申请的装置的任意实施例的基础上，发光分区布局所述布局构造模块5500，包括：位置确定单元，设置为根据所述灯带模型中的各个灯位相对于界面画布的坐标信息确定每个灯位的位置信息；顺序确定单元，设置为根据各个灯位在所述灯带模型的造型路径中的顺序确定每个灯位的顺序信息，所述顺序以所述造型路径中的信号输入端为排序起始端；布局封装单元，设置为合并各个灯位的位置信息和顺序信息成为顺序位置信息，将各个灯位的顺序位置信息封装为发光灯带的发光分区布局。在本申请的装置的任意实施例的基础上，先于所述灯位分析模块的运行，本申请的发光分区布局构造装置包括：输入识别模块，设置为基于所述灯带图像，识别出所述造型路径中的信号输入端，以该信号输入端为排序起始端确定各个所述灯位的顺序。在本申请的装置的任意实施例的基础上，先于所述灯位分析模块的运行，本申请的发光分区布局构造装置包括：灯位编辑模块，设置为响应灯位标定指令，确定该指令所指定的灯位为适于确定顺序位置信息的有效灯位。在本申请任意实施例的基础上，请参阅图10，本申请的另一实施例还提供一种计算机设备，该计算机设备可以充当氛围灯设备中的控制器使用，如图10所示，计算机设备的内部结构示意图。该计算机设备包括通过系统总线连接的处理器、计算机可读存储介质、存储器和网络接口。其中，该计算机设备的计算机可读存储介质存储有操作系统、数据库和封装计算机可读指令的计算机程序，数据库中可存储有控件信息序列，该计算机可读指令被处理器执行时，可使得处理器实现一种发光分区布局构造方法。该计算机设备的处理器用于提供计算和控制能力，支撑整个计算机设备的运行。该计算机设备的存储器中可存储有计算机可读指令，该计算机可读指令被处理器执行时，可使得处理器执行本申请的发光分区布局构造方法。该计算机设备的网络接口用于与终端连接通信。本领域技术人员可以理解，图10中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备的限定，具体的计算机设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。本实施方式中处理器用于执行图9中的各个模块及其子模块的具体功能，存储器存储有执行上述模块或子模块所需的程序代码和各类数据。网络接口用于向用户终端或服务器之间的数据传输。本实施方式中的存储器存储有本申请的发光分区布局构造装置中执行所有模块/子模块所需的程序代码及数据，服务器能够调用服务器的程序代码及数据执行所有子模块的功能。本申请还提供一种存储有计算机可读指令的存储介质，计算机可读指令被一个或多个处理器执行时，使得一个或多个处理器执行本申请任一实施例所述发光分区布局构造方法的步骤。本申请还提供一种计算机程序产品，包括计算机程序/指令，该计算机程序/指令被一个或多个处理器执行时实现本申请任一实施例所述发光分区布局构造方法的步骤。本领域普通技术人员可以理解实现本申请上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，该计算机程序可存储于一计算机可读取存储介质中，该程序在执行时，可包括如上述各方法的实施例的流程。其中，前述的存储介质可为磁碟、光盘、只读存储记忆体等计算机可读存储介质，或随机存储记忆体等。以上所述仅是本申请的部分实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本申请原理的前提下，还可以做出若干改进和润饰，这些改进和润饰也应视为本申请的保护范围。综上所述，本申请通过灯带图像抽象出灯带模型用于确定发光灯带的灯位的顺序位置信息，为发光灯带构造其发光分区布局实现了易理解、易操作的人机交互功能，可以提升发光灯带的配置效率，使此类氛围灯设备更易推广普及。
