标题title
基于SOA的车云协同控制系统、方法及可读存储介质
摘要abst
本发明具体涉及基于SOA的车云协同控制系统、方法及可读存储介质。系统包括：云服务器，用于发布服务调用请求；车载网络终端，用于接收并根据云服务器的服务调用请求生成对应的服务调用指令；车内域控制器，用于接收并根据车载网络终端的服务调用指令执行对应的服务调用；执行器，用于根据车内域控制器的服务调用情况执行对应的服务功能；其中，车内域控制器还用于对车内的硬件资源和应用业务流程进行抽象，定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口，建立对应的服务架构。本发明还公开了车云协同控制方法及可读存储介质。本发明能够兼顾提高车云通讯效率以及车云协同控制功能的可扩展性及灵活性。
权利要求书clms
1.基于SOA的车云协同控制系统，其特征在于，包括：云服务器，用于发布服务调用请求；车载网络终端，用于接收并根据云服务器的服务调用请求生成对应的服务调用指令；车内域控制器，用于接收并根据车载网络终端的服务调用指令执行对应的服务调用；执行器，用于根据车内域控制器的服务调用情况执行对应的服务功能；其中，车内域控制器还用于对车内的硬件资源和应用业务流程进行抽象，定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口，建立对应的服务架构。2.如权利要求1所述的基于SOA的车云协同控制系统，其特征在于：云服务器和车载网络终端之间通过消息队列遥测传输协议进行通信。3.如权利要求2所述的基于SOA的车云协同控制系统，其特征在于：车载网络终端和车内域控制器之间通过车载以太网通信协议进行通信。4.如权利要求3所述的基于SOA的车云协同控制系统，其特征在于：消息队列遥测传输协议和车载以太网通信协议载荷中的数据格式及数据结构保持一致；车载网络终端上部署有用于实现消息队列遥测传输指令和车载以太网通信指令间相互转换的转换中间件。5.如权利要求1所述的基于SOA的车云协同控制系统，其特征在于：执行器完成对应服务功能的执行后，向车内域控制器反馈相应的服务执行响应，然后依次通过车内域控制器和车载网络终端将对应的服务执行响应反馈至云服务器。6.基于SOA的车云协同控制方法，其特征在于，基于权利要求1中的车云协同控制系统实施，具体包括以下步骤：S1：通过车内域控制器对车内的硬件资源和应用业务流程进行抽象，定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口，建立对应的服务架构；S2：建立云服务器和车载网络终端之间以及车载网络终端和车内域控制器之间的通信；S3：通过云服务器发布服务调用请求；S4：通过车载网络终端接收并根据云服务器的服务调用请求生成对应的服务调用指令；S5：通过车内域控制器接收并根据车载网络终端的服务调用指令执行对应的服务调用；S6：通过执行器根据车内域控制器的服务调用情况执行对应的服务功能。7.如权利要求6所述的基于SOA的车云协同控制方法，其特征在于：步骤S1中，具体包括如下步骤：S101：基于硬件资源分析硬件的关键属性，获得对应的硬件输入输出；然后基于上层业务需求分析关键业务场景，建立对应的业务场景库；S102：对硬件资源进行抽象，明确上层调用策略及调用接口；然后对应用业务流程进行分析，明确业务实现所需环节及各环节所需功能；S103：定义对应的原子服务和原子服务接以及应用抽象服务和应用抽象服务接口；S104：基于定义的原子服务、原子服务接口、应用抽象服务、应用抽象服务接口进行服务部署，建立车内域控制器的服务架构；S105：基于服务定义及服务架构进行服务开发实现，实现对外的服务暴露，以能够为车载网络终端对车内域控制器的服务调用提供协议接口。8.如权利要求6所述的基于SOA的车云协同控制方法，其特征在于：步骤S2中，云服务器和车载网络终端之间通过消息队列遥测传输协议进行通信；车载网络终端和车内域控制器之间通过车载以太网通信协议进行通信。9.如权利要求8所述的基于SOA的车云协同控制方法，其特征在于：步骤S2中，具体包括如下步骤：S201：云服务器与车载连网终端基于消息队列遥测传输代理服务器进行认证连接，并基于消息队列遥测传输协议的连接机制建立对应的端云长连接机制；S202：车载网络终端基于连接认证机制判断端云连接是否成功，若不成功则重试连接；S203：云服务器、车载网络终端基于消息队列遥测传输代理服务器订阅所需服务，并约定端云协同的控制交互服务质量；同时，车载网络终端根据服务配置基于车载以太网通信协议发起相关服务发现，并根据车内域控制器提供的服务报文，车载网络终端建立与对应车内域控制器的服务调用映射关系；S204：云端服务器基于用户请求及服务订阅关系，向车载网络终端发布服务调用请求；S205：车载网络终端接收到云端发布的远程控制服务请求后，执行消息队列遥测传输协议与车载以太网通信协议的转换，并基于与车内域控制器间的服务调用映射关系向对应车内域控制器进行服务调用。10.一种可读存储介质，其特征在于，其上存储有计算机管理类程序，所述计算机管理类程序被处理器执行时实现如权利要求6-9任一项所述的基于SOA的车云协同控制方法的步骤。
说明书desc
技术领域本发明涉及车云协同技术领域，具体涉及基于SOA的车云协同控制系统、方法及可读存储介质。背景技术随着车载通讯技术、车载控制器芯片、车载操作系统和云服务技术的发展，车云协同愈发紧密。车云协同依靠云端的大容量、大算力及车端的实时性、可无线连网等特性，可实现基于车辆实时或非实时信息的在线车辆控制；车云协同依靠车内以太网技术、4G/5G通讯等技术，可实现基于大数据量的在线车云数据交互；车云协同依靠车内控制芯片、操作系统技术的发展，可实现车内通讯由基于信号的通讯向面向服务的通讯转变。针对车云协同控制方案的设计，公开号为CN113327442A的中国专利公开了《一种基于端云融合的协同控制系统及方法》，其包括云端协同控制平台、边缘感知分析系统和移动终端控制系统；其中，移动终端控制系统安装在智能网联汽车或者道路的技术设施上，用于采集信息和执行协调控制指令；边缘感知分析系统部署在道路两侧或5G服务基站，用于采集信息和信息融合，云端协同控制平台部署在云端平台上，用于数据管理、业务通信和协调控制指令生成。上述现有方案中的端云融合协同控制系统通过车云协同的方式，对智能化车辆与人驾驶车辆混合运行过程中的数据感知计算进行在线运算、模型修正和实时调度控制。但申请人发现，现有的车云协同方法，一般以基于信号的通讯交互为主，该通讯方式主要基于CAN、LIN、Flexray总线技术实现，其具有车内通讯实时性高、总线信号周期性发送对总线实时占用、单信号交互信息量有限、总线带宽较低等优势，但其存在车云通讯效率偏低、车云协同控制功能的可扩展性及灵活性较差等问题。因此，如何设计一种能够兼顾提高车云通讯效率和车云协同控制功能可扩展性及灵活性的系统和方法是亟需解决的技术问题。发明内容针对上述现有技术的不足，本发明所要解决的技术问题是：如何提供一种基于SOA的车云协同控制系统和方法，以能够兼顾提高车云通讯效率以及车云协同控制功能的可扩展性及灵活性，从而能够提高车云协同通讯的同构性和协同效率。为了解决上述技术问题，本发明采用了如下的技术方案：基于SOA的车云协同控制系统，包括：云服务器，用于发布服务调用请求；车载网络终端，用于接收并根据云服务器的服务调用请求生成对应的服务调用指令；车内域控制器，用于接收并根据车载网络终端的服务调用指令执行对应的服务调用；执行器，用于根据车内域控制器的服务调用情况执行对应的服务功能；其中，车内域控制器还用于对车内的硬件资源和应用业务流程进行抽象，定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口，建立对应的服务架构。优选的，云服务器和车载网络终端之间通过消息队列遥测传输协议进行通信。优选的，车载网络终端和车内域控制器之间通过车载以太网通信协议进行通信。优选的，消息队列遥测传输协议和车载以太网通信协议载荷中的数据格式及数据结构保持一致；车载网络终端上部署有用于实现消息队列遥测传输指令和车载以太网通信指令间相互转换的转换中间件。优选的，执行器完成对应服务功能的执行后，向车内域控制器反馈相应的服务执行响应，然后依次通过车内域控制器和车载网络终端将对应的服务执行响应反馈至云服务器。本发明还公开了基于SOA的车云协同控制方法，其基于本发明的车云协同控制系统实施，具体包括以下步骤：S1：通过车内域控制器对车内的硬件资源和应用业务流程进行抽象，定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口，建立对应的服务架构；S2：建立云服务器和车载网络终端之间以及车载网络终端和车内域控制器之间的通信；S3：通过云服务器发布服务调用请求；S4：通过车载网络终端接收并根据云服务器的服务调用请求生成对应的服务调用指令；S5：通过车内域控制器接收并根据车载网络终端的服务调用指令执行对应的服务调用；S6：通过执行器根据车内域控制器的服务调用情况执行对应的服务功能。优选的，步骤S1中，具体包括如下步骤：S101：基于硬件资源分析硬件的关键属性，获得对应的硬件输入输出；然后基于上层业务需求分析关键业务场景，建立对应的业务场景库；S102：对硬件资源进行抽象，明确上层调用策略及调用接口；然后对应用业务流程进行分析，明确业务实现所需环节及各环节所需功能；S103：定义对应的原子服务和原子服务接以及应用抽象服务和应用抽象服务接口；S104：基于定义的原子服务、原子服务接口、应用抽象服务、应用抽象服务接口进行服务部署，建立车内域控制器的服务架构；S105：基于服务定义及服务架构进行服务开发实现，实现对外的服务暴露，以能够为车载网络终端对车内域控制器的服务调用提供协议接口。优选的，步骤S2中，云服务器和车载网络终端之间通过消息队列遥测传输协议进行通信；车载网络终端和车内域控制器之间通过车载以太网通信协议进行通信。优选的，步骤S2中，具体包括如下步骤：S201：云服务器与车载连网终端基于消息队列遥测传输代理服务器进行认证连接，并基于消息队列遥测传输协议的连接机制建立对应的端云长连接机制；S202：车载网络终端基于连接认证机制判断端云连接是否成功，若不成功则重试连接；S203：云服务器、车载网络终端基于消息队列遥测传输代理服务器订阅所需服务，并约定端云协同的控制交互服务质量；同时，车载网络终端根据服务配置基于车载以太网通信协议发起相关服务发现，并根据车内域控制器提供的服务报文，车载网络终端建立与对应车内域控制器的服务调用映射关系；S204：云端服务器基于用户请求及服务订阅关系，向车载网络终端发布服务调用请求；S205：车载网络终端接收到云端发布的远程控制服务请求后，执行消息队列遥测传输协议与车载以太网通信协议的转换，并基于与车内域控制器间的服务调用映射关系向对应车内域控制器进行服务调用。本发明还公开了一种可读存储介质，其上存储有计算机管理类程序，所述计算机管理类程序被处理器执行时实现本发明的基于SOA的车云协同控制方法的步骤。本发明的车云远程协同控制系统和方法与现有技术相比，具有如下有益效果：本发明对车内的硬件资源和应用业务流程进行抽象，进而定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口来建立对应的服务架构，实现了车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，进而能够为车云服务相互调用、车端服务灵活编排提供基础，从而能够提高车云协同控制功能的可扩展性及灵活性，并能够有效的为基于SOA的车云协同控制提供基础。本发明的云服务器通过车载网络终端间接调用车内域控制器的车内服务，而车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，使得能够基于SOA构架来提高车云通讯的效率和灵活性，从而能够提高车云协同通讯的同构性和协同效率。附图说明为了使发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步的详细描述，其中：图1为基于SOA的车云协同控制系统的结构示意图；图2为基于SOA的车云协同控制方法的逻辑框图。具体实施方式下面通过具体实施方式进一步详细的说明：实施例一：本实施例中公开了一种基于SOA的车云协同控制系统。如图1所示，基于SOA的车云协同控制系统，包括：云服务器，用于发布服务调用请求；车载网络终端，用于接收并根据云服务器的服务调用请求生成对应的服务调用指令；车内域控制器，用于接收并根据车载网络终端的服务调用指令执行对应的服务调用；执行器，用于根据车内域控制器的服务调用情况执行对应的服务功能；本实施例中，执行器与车内域控制器之间通过硬线、CAN、LIN等通讯方式通信。其中，车内域控制器还用于对车内的硬件资源和应用业务流程进行抽象，定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口，建立对应的服务架构。本发明对车内的硬件资源和应用业务流程进行抽象，进而定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口来建立对应的服务架构，实现了车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，进而能够为车云服务相互调用、车端服务灵活编排提供基础，从而能够提高车云协同控制功能的可扩展性及灵活性，并能够有效的为基于SOA的车云协同控制提供基础。同时，本发明的云服务器通过车载网络终端间接调用车内域控制器的车内服务，而车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，使得能够基于SOA构架来提高车云通讯的效率和灵活性，从而能够提高车云协同通讯的同构性和协同效率。具体实施过程中，云服务器和车载网络终端之间通过消息队列遥测传输协议进行通信。本实施例中，在云服务器部署消息队列遥测传输代理服务器，在车载网络终端部署对应的消息队列遥测传输代理，使得云服务器能够通过消息队列遥测传输代理服务器发布对应的服务调用请求，车载网络终端能够通过消息队列遥测传输代理订阅对应的服务调用请求。同时，在云服务器部署对应的消息队列遥测传输代理，用于订阅车载网络终端发布的服务执行响应。具体实施过程中，车载网络终端和车内域控制器之间通过车载以太网通信协议进行通信。本实施例中，分别在车载网络终端和车内域控制器部署对应的车载以太网通信协议栈。车载网络终端在初始化完成后，主动发起服务发现以获取对应的服务，待接收到对应车内域控制器提供的服务报文后，基于关键信息建立服务绑定关系；车载网络终端接收到MQTT服务器下发的服务调用请求后，基于服务绑定关系及SOME/IP的RPC机制向对应车内域控制器发起服务调用并接收服务执行响应。具体实施过程中，消息队列遥测传输协议和车载以太网通信协议载荷中的数据格式及数据结构保持一致；车载网络终端上部署有用于实现消息队列遥测传输指令和车载以太网通信指令间相互转换的转换中间件。本发明云服务器和车载网络终端之间通过MQTT进行通信、车载网络终端和车内域控制器之间通过SOME/IP进行通信，使得云服务器能够实现通过车载网络终端间接调用车内域控制器的车内服务，而车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，从而能够基于SOA构架来提高车云通讯的效率和灵活性。同时，本发明的MQTT协议和SOME/IP协议载荷中的数据格式及数据结构保持一致，使得车载网络终端可直接将接收到的MQTT协议中的服务调用请求相关载荷截取装载至SOME/IP协议载荷中，期间无需进行载荷中参数的解析及转译，能够保证MQTT协议与SOME/IP协议的载荷一致性，从而能够进一步提高车云协同通讯效率。具体实施过程中，执行器完成对应服务功能的执行后，向车内域控制器反馈相应的服务执行响应，然后依次通过车内域控制器和车载网络终端将对应的服务执行响应反馈至云服务器。本实施例中，车载网络终端在接收到对应域控制器的服务响应后可直接将接收到的SOME/IP协议中的服务执行响应相关载荷截取装载至MQTT协议载荷并发布至MQTT服务器，期间无需进行载荷参数解析及转译。本发明中执行器完成对应服务功能的执行后，能够向车内域控制器反馈相应的服务执行响应，然后依次通过车内域控制器和车载网络终端将服务执行响应反馈至云服务器，使得云服务器能够及时、准确的获知服务调用的执行情况，从而能够提高车云协同通讯的同构性和协同效率。实施例二：本实施例中公开了基于SOA的车云协同控制方法。如图2所示，基于SOA的车云协同控制方法，具体包括以下步骤：S1：通过车内域控制器对车内的硬件资源和应用业务流程进行抽象，定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口，建立对应的服务架构；S2：建立云服务器和车载网络终端之间以及车载网络终端和车内域控制器之间的通信；本实施例中，执行器与车内域控制器之间通过硬件、CAN、LIN等通讯方式通信。S3：通过云服务器发布服务调用请求；S4：通过车载网络终端接收并根据云服务器的服务调用请求生成对应的服务调用指令；S5：通过车内域控制器接收并根据车载网络终端的服务调用指令执行对应的服务调用；S6：通过执行器根据车内域控制器的服务调用情况执行对应的服务功能。需要说明的是，本发明的基于SOA的车云协同控制方法可通过程序编程的方式生对应的成软件代码或软件服务，进而能够在服务器和计算机上运行和实施。本发明对车内的硬件资源和应用业务流程进行抽象，进而定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口来建立对应的服务架构，实现了车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，进而能够为车云服务相互调用、车端服务灵活编排提供基础，从而能够提高车云协同控制功能的可扩展性及灵活性，并能够有效的为基于SOA的车云协同控制提供基础。同时，本发明的云服务器通过车载网络终端间接调用车内域控制器的车内服务，而车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，使得能够基于SOA构架来提高车云通讯的效率和灵活性，从而能够提高车云协同通讯的同构性和协同效率。步骤S1中，具体包括如下步骤：S101：基于硬件资源分析硬件的关键属性，获得对应的硬件输入输出；然后基于上层业务需求分析关键业务场景，建立对应的业务场景库；S102：对硬件资源进行抽象，明确上层调用策略及调用接口；然后对应用业务流程进行分析，明确业务实现所需环节及各环节所需功能；本实施例中，针对车内域控制器下挂的电控单元，车内域控制器基于与电控单元间的信号通讯以信号交互为基础实现对电控单元的服务抽象。针对车云业务基于各业务流程进行服务定义以明确业务所涉及的抽象服务或方法，如空调开闭、空调参数调节、空调状态反馈等。针对抽象服务或方法，车内域控制器通过对原子服务的组合调用封装及对抽象服务的组合调用封装以实现定义的抽象服务。S103：定义对应的原子服务和原子服务接以及应用抽象服务和应用抽象服务接口；S104：基于定义的原子服务、原子服务接口、应用抽象服务、应用抽象服务接口进行服务部署，建立车内域控制器的服务架构；本实施例中，采用SOME/IP通讯中间件实现对服务的通讯打包，以对外提供对应的服务化调用能力及相关信息的订阅发布能力，车载网络终端可直接基于SOME/IP通讯实现对车内域控制器的服务调用或事件订阅从而实现服务化交互。S105：基于服务定义及服务架构进行服务开发实现，实现对外的服务暴露，以能够为车载网络终端对车内域控制器的服务调用提供协议接口。本实施例中，车载网络终端在初始化完成后，主动发起服务发现以获取对应的服务，待接收到对应车内域控制器提供的服务报文后，基于关键信息建立服务绑定关系；车载网络终端接收到MQTT服务器下发的服务调用请求后，基于服务绑定关系及SOME/IP的RPC机制向对应车内域控制器发起服务调用并接收服务执行响应。本发明通过上述步骤，使得车内域控制器能够有效的对车内的硬件资源和应用业务流程进行抽象，进而定义对应的原子服务和原子服务接口以及应用抽象服务和应用抽象服务接口来建立对应的服务架构，实现了车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，进而能够为车云服务相互调用、车端服务灵活编排提供基础，从而能够进更好的提高车云协同控制功能的可扩展性及灵活性，并能够更有效的为基于SOA的车云协同控制提供基础。具体实施过程中，步骤S2中，云服务器和车载网络终端之间通过消息队列遥测传输协议进行通信；车载网络终端和车内域控制器之间通过车载以太网通信协议进行通信。步骤S2中，具体包括如下步骤：S201：云服务器与车载连网终端基于消息队列遥测传输代理服务器进行认证连接，并基于消息队列遥测传输协议的连接机制建立对应的端云长连接机制；S202：车载网络终端基于连接认证机制判断端云连接是否成功，若不成功则重试连接；S203：云服务器、车载网络终端基于消息队列遥测传输代理服务器订阅所需服务，并约定端云协同的控制交互服务质量；车载网络终端根据服务配置基于车载以太网通信协议发起相关服务发现，并根据车内域控制器提供的服务报文，车载网络终端建立与对应车内域控制器的服务调用映射关系；S204：云端服务器基于用户请求及服务订阅关系，向车载网络终端发布服务调用请求；S205：车载网络终端接收到云端发布的远程控制服务请求后，执行消息队列遥测传输协议与车载以太网通信协议的转换，并基于与车内域控制器间的服务调用映射关系向对应车内域控制器进行服务调用。本实施例中，MQTT协议及SOME/IP协议载荷中的数据格式及数据结构在设计上保持一致，车载网络终端可直接对MQTT协议的服务调用请求载荷截取装载至SOME/IP协议载荷中，期间无需进行载荷中参数的解析及转译。本发明云服务器和车载网络终端之间通过MQTT进行通信、车载网络终端和车内域控制器之间通过SOME/IP进行通信，使得云服务器能够实现通过车载网络终端间接调用车内域控制器的车内服务，而车内域控制器及其下挂执行器的服务化抽象、车内功能的服务化调用及车云协同的服务化统一，从而能够基于SOA构架来提高车云通讯的效率和灵活性。同时，本发明的MQTT协议和SOME/IP协议载荷中的数据格式及数据结构保持一致，使得车载网络终端可直接将接收到的MQTT协议中的服务调用请求相关载荷截取装载至SOME/IP协议载荷中，期间无需进行载荷中参数的解析及转译，能够保证MQTT协议与SOME/IP协议的载荷一致性，从而能够进一步提高车云协同通讯效率。实施例三：本实施例中公开了一种可读存储介质。一种可读存储介质，其上存储有计算机管理类程序，所述计算机管理类程序被处理器执行时本发明的基于SOA的车云协同控制方法的步骤。可读存储介质可以是U盘或计算机等具有可读存储功能的设备。最后需要说明的是，以上实施例仅用以说明本发明的技术方案而非限制技术方案，本领域的普通技术人员应当理解，那些对本发明的技术方案进行修改或者等同替换，而不脱离本技术方案的宗旨和范围，均应涵盖在本发明的权利要求范围当中。
