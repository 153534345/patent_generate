标题title
基于边缘计算的实时道路交通状态监测方法、设备及系统
摘要abst
本发明公开了一种基于边缘计算的实时道路交通状态监测方法、设备及系统，包括：获取当前道路的监测视频流数据，实时提取道路图像；进行语义分割，确定当前道路区域以及对应的多个车道区域；基于轻量化目标检测网络从道路图像中锚定多个目标车辆，并根据锚定坐标和车道区域确定目标车辆所属车道，基于目标跟踪算法对多个目标车辆进行跟踪识别，确定多个目标车辆的车辆信息及轨迹信息；根据多个目标车辆的轨迹信息及车道信息确定多个车道的车速信息，分析当前道路在设定统计时间间隔内的交通状态数据。本发明通过语义分割算法、配合目标检测算法与目标跟踪算法，进行道路区域内车辆及车辆行为的辨识，实现对当前交通状态进行实时监测分析。
权利要求书clms
1.一种基于边缘计算的实时道路交通状态监测方法，其特征在于，应用于边缘计算设备，所述方法包括：S1、获取当前道路的监测视频流数据，从所述监测视频流数据中实时提取道路图像；S2、从所述道路图像中提取背景图像，对所述背景图像进行语义分割，确定当前道路对应的多个车道区域；S3、基于轻量化目标检测网络从所述道路图像中锚定多个目标车辆，并根据锚定坐标和所述车道区域确定目标车辆所属车道，以及，基于目标跟踪算法对多个所述目标车辆进行跟踪识别，确定多个所述目标车辆的车辆信息及轨迹信息；S4、根据多个目标车辆的轨迹信息及车道信息确定多个所述车道的车速信息，根据所述轨迹信息、车速信息分析当前道路在设定统计时间间隔内的交通状态数据。2.如权利要求1所述的基于边缘计算的实时道路交通状态监测方法，其特征在于，采用SegNext神经网络对所述背景图像进行语义分割。3.如权利要求1所述的基于边缘计算的实时道路交通状态监测方法，其特征在于，所述轻量化目标检测网络为：轻量化Yolov7网络，通过网络模型算子的NPU适配和参数量化实现Yolov7网络的轻量化。4.如权利要求1所述的基于边缘计算的实时道路交通状态监测方法，其特征在于，通过以下方法构建所述轻量化目标检测网络，包括：构建轻量化网络初始模型，基于开源车辆数据图像集对所述网络初始模型进行预训练，得到预训练网络模型；基于标记后的道路图像数据集对预训练网络模型进行迁移训练，以得到目标检测迁移训练网络模型。5.如权利要求1所述的基于边缘计算的实时道路交通状态监测方法，其特征在于，所述基于目标跟踪算法对多个所述目标车辆进行跟踪识别，包括：基于deepsort算法，根据目标车辆的外观特征进行目标轨迹信息的识别；其中，采用ShuffleNet网络提取目标车辆的外观特征。6.如权利要求5所述的基于边缘计算的实时道路交通状态监测方法，其特征在于，所述ShuffleNet网络为：轻量化ShuffleNet网络，通过网络模型算子的NPU适配和参数量化实现ShuffleNet网络的轻量化。7.如权利要求1~6任一所述的基于边缘计算的实时道路交通状态监测方法，其特征在于，根据所述轨迹信息、车速信息分析当前道路在设定统计时间间隔内的交通状态数据，包括：统计设定时间间隔内所有目标车辆的总体及分车道、分车型流量、车速、密度、车头间距、车头时距、空间占有率、时间占有率信息，对统计结果进行分析，得到当前道路在设定统计时间间隔内的交通状态数据，向云端服务器传输所述统计结果以及交通状态数据。8.一种边缘计算设备，其特征在于，包括：包括处理器、网络接口和存储器，所述处理器、所述网络接口和所述存储器相互连接，其中，所述存储器用于存储计算机程序，所述计算机程序包括程序指令，所述处理器被配置用于调用所述程序指令，执行如权利要求1~7任一项所述的基于边缘计算的实时道路交通状态监测方法。9.一种基于边缘计算的实时道路交通状态监测系统，其特征在于，所述系统包括：图像采集设备，用于采集当前道路的监测视频流数据，并传输至边缘计算设备；边缘计算设备，用于获取监测视频流数据，并采用权利要求1~7任一项所述的基于边缘计算的实时道路交通状态监测方法分析当前道路在设定统计时间间隔内的交通状态数据。10.如权利要求9所述的系统，其特征在于，所述边缘计算设备为RK3588边缘计算开发板；所述系统还包括：云端服务器；所述云端服务器与所述边缘计算设备通讯连接，用于接收边缘计算设备传输的当前道路在设定统计时间间隔内的交通状态数据。
说明书desc
技术领域本发明涉及交通监测技术领域，尤其涉及一种基于边缘计算的实时道路交通状态监测方法、设备及系统。背景技术目前交通调查/监测技术主要包括：路侧交通调查/监测技术与基于远程数据处理的交通调查/监测技术。其中，基于远程数据处理的交通调查/监测技术存在通讯设备复杂、数据传输延迟、时效性不强的缺陷；因而在当前交通监测管控技术中，通常以发展路侧交通调查/监测技术为主。现有路侧交通调查/监测技术主要采用基于立杆安装交调设备采集数据并通过云平台自动进行交通调查，或者由人工结合交通设备进行统计分析、从而完成交通调查的方式。其中，立杆监测方式存在设计、安装过程复杂，维护成本高、灵活性差、时延较长的问题，而人工进行统计分析的方法存在人力资源消耗大，准确性、可靠性无法保障问题。发明内容本发明的目的在于克服现有路侧交通调查/监测技术所存在的设备复杂、灵活性差、时延较长、不够准确的问题，提供一种基于边缘计算的实时道路交通状态监测方法、设备及系统，通过将算力布置在与监控感知设备距离更近的边缘端，减小交通调查/监测系统构成的复杂性，提高调查/监测应用的灵活性、即时性、准确性；同时本发明基于计算机视觉目标跟踪技术实现对道路交通状态数据的实时监测。为了实现上述发明目的，本发明提供了以下技术方案：一种基于边缘计算的实时道路交通状态监测方法，应用于边缘计算设备，所述方法包括：S1、获取当前道路的监测视频流数据，从所述监测视频流数据中实时提取道路图像；S2、从所述道路图像中提取背景图像，对所述背景图像进行语义分割，确定当前道路对应的多个车道区域；S3、基于轻量化目标检测网络从所述道路图像中锚定多个目标车辆，并根据锚定坐标和所述车道区域确定目标车辆所属车道，以及，基于目标跟踪算法对多个所述目标车辆进行跟踪识别，确定多个所述目标车辆的车辆信息及轨迹信息；S4、根据多个目标车辆的轨迹信息及车道信息确定多个所述车道的车速信息，根据所述轨迹信息、车速信息分析当前道路在设定统计时间间隔内的交通状态数据。根据一种具体的实施方式，上述基于边缘计算的实时道路交通状态监测方法中，采用SegNext神经网络对所述背景图像进行语义分割。根据一种具体的实施方式，上述基于边缘计算的实时道路交通状态监测方法中，所述轻量化目标检测网络为：轻量化Yolov7网络，通过网络模型算子的NPU适配和参数量化实现Yolov7网络的轻量化。根据一种具体的实施方式，上述基于边缘计算的实时道路交通状态监测方法中，通过以下方法构建所述轻量化目标检测网络，包括：构建轻量化网络初始模型，基于开源车辆数据图像集对所述网络初始模型进行预训练，得到预训练网络模型；基于标记后的道路图像数据集对预训练网络模型进行迁移训练，以得到目标检测迁移训练网络模型。根据一种具体的实施方式，上述基于边缘计算的实时道路交通状态监测方法中，所述基于目标跟踪算法对多个所述目标车辆进行跟踪识别，包括：基于deepsort算法，根据目标车辆的外观特征进行目标轨迹信息的识别；其中，采用ShuffleNet网络提取目标车辆的外观特征。根据一种具体的实施方式，上述基于边缘计算的实时道路交通状态监测方法中，所述ShuffleNet网络为：轻量化ShuffleNet网络，通过网络模型算子的NPU适配和参数量化实现ShuffleNet网络的轻量化。根据一种具体的实施方式，上述基于边缘计算的实时道路交通状态监测方法中，根据所述轨迹信息、车速信息分析当前道路在设定统计时间间隔内的交通状态数据，包括：统计设定时间间隔内所有目标车辆的总体及分车道、分车型流量、车速、密度、车头间距、车头时距、空间占有率、时间占有率信息，对统计结果进行分析，得到当前道路在设定统计时间间隔内的交通状态数据，向云端服务器传输所述统计结果以及交通状态数据。本发明的另一方面，提供一种边缘计算设备，包括：包括处理器、网络接口和存储器，所述处理器、所述网络接口和所述存储器相互连接，其中，所述存储器用于存储计算机程序，所述计算机程序包括程序指令，所述处理器被配置用于调用所述程序指令，执行上述基于边缘计算的实时道路交通状态监测方法。本发明的另一方面，提供一种基于边缘计算的实时道路交通状态监测系统，所述系统包括：图像采集设备，用于采集当前道路的监测视频流数据，并传输至边缘计算设备；边缘计算设备，用于获取监测视频流数据，并采用上述基于边缘计算的实时道路交通状态监测方法分析当前道路在设定统计时间间隔内的交通状态数据。根据一种具体的实施方式，上述基于边缘计算的实时道路交通状态监测系统中，所述边缘计算设备为RK3588边缘计算开发板；所述系统还包括：云端服务器；所述云端服务器与所述边缘计算设备通讯连接，用于接收边缘计算设备传输的当前道路在设定统计时间间隔内的交通状态数据。与现有技术相比，本发明的有益效果：本发明实施例所提供的方法，通过对分析得到的道路背景图像进行语义分割，确定车道信息，基于轻量化目标检测网络从分割后的图像中锚定多个目标车辆，基于目标跟踪算法对目标车辆进行跟踪识别，确定目标车辆的车辆、轨迹信息；进而能够根据目标车辆的轨迹、车道信息确定道路中每个车道的车速信息与交通状态数据；本发明通过语义分割算法、配合目标检测算法与目标跟踪算法，进行车辆的跟踪识别，并根据经过的车道线进行车速测算，从而能够对设定统计时间间隔内当前时间间隔的交通状态进行实时监测分析；为对整个交通组网的统一调度运营提供数据基础，确保快速高效和交通参与者的生命财产安全；同时本算法应用于边缘计算设备，将算法布设在与监控感知设备距离更近的边缘端，能够在路侧实现交通流量调查，有效减小交通调查/监测系统构成的复杂性。附图说明图1为一个实施例中的基于边缘计算的实时道路交通状态监测方法流程图；图2为一个实施例中的道路语义分割效果图；图3为一个实施例中的道路路面、标线、背景语义分割效果图；图4为一个实施例中的目标检测效果图；图5为一个实施例中的目标跟踪效果图；图6为一个实施例中的统计分析结果图；图7为一个实施例中的边缘计算设备结构框图。具体实施方式下面结合具体实施方式对本发明作进一步的详细描述。但不应将此理解为本发明上述主题的范围仅限于以下的实施例，凡基于本发明内容所实现的技术均属于本发明的范围。实施例1图1示出了本发明示例性实施例的基于边缘计算的实时道路交通状态监测方法，应用于边缘计算设备，该方法包括：S1、获取当前道路的监测视频流数据，从所述监测视频流数据中实时提取道路图像；S2、从所述道路图像中提取背景图像，对所述背景图像进行语义分割，确定当前道路对应的多个车道区域；S3、基于轻量化目标检测网络从所述道路图像中锚定多个目标车辆，并根据锚定坐标和所述车道区域确定目标车辆所属车道，以及，基于目标跟踪算法对多个所述目标车辆进行跟踪识别，确定多个所述目标车辆的车辆信息及轨迹信息；S4、根据多个目标车辆的轨迹信息及车道信息确定多个所述车道的车速信息，根据所述轨迹信息、车速信息分析当前道路在设定统计时间间隔内的交通状态数据。本实施例中，通过对分析得到的道路背景图像进行语义分割，确定车道信息，基于轻量化目标检测网络从分割后的图像中锚定多个目标车辆，基于目标跟踪算法对目标车辆进行跟踪识别，确定目标车辆的车辆、轨迹信息；进而能够根据目标车辆的轨迹、车道信息确定道路中每个车道的车速信息与交通状态数据；本发明通过语义分割算法、配合目标检测算法与目标跟踪算法，进行车辆的跟踪识别，并根据经过的车道线进行车速测算，从而能够对设定统计时间间隔内当前时间间隔的交通状态进行实时监测分析；为对整个交通组网的统一调度运营提供数据基础，确保快速高效和交通参与者的生命财产安全；同时本算法布置在与监控感知设备距离更近的边缘端，能够有效减小交通调查/监测系统构成的复杂性。实施例2在一种可能的实现方式中，上述基于边缘计算的实时道路交通状态监测方法中，上述S2中，通过高斯混合背景建模方法对获取到的道路图像提取道路背景图像。采用SegNext神经网络，在包含车道线分割标注的交通数据集Camvid上进行训练，并对道路背景图像进行语义分割任务推断。分割道路区域包括路面区域和路面标线，分割后的路面区域，根据其行像素个数量以及目标可被准确可靠检测的行像素数量设定阈值，自动设定目标检测区域；分割路面标线结果经霍夫变换直线检测，归并属于同一车道线的分割区域，获取道路区域中车道子区域的划分，以此获得车辆目标的车道信息；同时，可利用车道线区域分割区域位置极值与道路标线实际对应关系，获取图像空间中任意坐标在世界空间中的坐标，以进一步获得车辆目标速度信息。如图2、图3所示，本发明实施例所提供的SegNext神经网络能够进行清晰准确的道路语义分割。本实施例中，采用高性能SegNext神经网络对道路图像进行精细语义分割，神经网络模型参数通过预训练过程获得，路侧设备安装好后，只需采集一段图像数据序列并计算道路背景，即可对道路场景进行语义分割任务推断。在一种可能的实现方式中，上述基于边缘计算的实时道路交通状态监测方法中，上述S3中，所述目标检测网络基于Yolov7多目标检测算法进行构建，用于识别car、truck、bus三类车辆目标，在训练过程中，使用BBD_100K大规模开放车辆检测数据集进行预训练，再使用实际路侧采集图像的标注数据进行迁移学习，以达到更高的检测准确率，如图4所示，本发明实施例所提供的yolov7神经网络能够进行清晰准确的目标检测锚定。本实施例中，通过Yolov7多目标检测算法准确地检测出图像中所有车辆的位置和车型，提升车辆目标跟踪的准确性。在一种可能的实现方式中，上述基于边缘计算的实时道路交通状态监测方法中，为了能在边缘计算设备的NPU计算平台实时地推理，对网络模型进行了量化与平台适配。量化过程是将原来网络参数的表示长度由32位映射到8位，以此减小运算量与内存消耗，同时保持较小的准确率下降；平台适配即将边缘计算平台NPU不支持的数组单维度处理操作交由CPU处理，如检测任务后处理中的锚框计算过程，检测结果数组的目标框、置信度数据处理需要交由CPU处理。目前检测时间在30ms以内，实现了超实时目标检测的速度，可满足实时检测跟踪的需求。在一种可能的实现方式中，上述基于边缘计算的实时道路交通状态监测方法中，上述S3中，所述基于目标跟踪算法对多个所述目标车辆进行跟踪识别，包括：使用deepsort算法，根据目标图像外观和目标轨迹信息进行重识别。在车辆外观特征提取时，使用目标分类神经网络的骨干网络部分提取车辆目标外观特征。本方法应用场景跟踪目标的种类较少且轨迹单调，因此使用了体量小、适合边缘计算、准确率高的ShuffleNet，并使用VeRi大规模车辆重识别数据集进行训练，用于准确辨识车辆差异，提高目标跟踪的准确率。在进行模型部署时，同样面临NPU计算平台网络结构适配问题，本方法移除ShuffleNet模型中NPU不支持的维度重排算子后，通过增加多通道1×1卷积变相实现网络结构所需要的维度重排效果，以保持模型在NPU上计算的并行能力与准确性；同时，模型推断时跳过模型训练时网络的高层全连接结构，以输出目标特征图替代目标类型判别结果，从而保证模型推断的高效性与准确性。最终每帧车辆特征提取时间在10ms左右，检测跟踪平均时间为50ms以内，满足了实时性需求。如图5所示，本发明实施例所提供的目标跟踪算法能够进行准确的目标轨迹跟踪。本实施例中，通过目标跟踪算法进行车辆目标跟踪，使每辆车出现后都有唯一一个ID与之对应，从而能够有效统计车辆行为信息，计算每辆车出现和消失的时间和轨迹，以此作为统计该车辆的速度、车道等信息的基础。在一种可能的实现方式中，上述基于边缘计算的实时道路交通状态监测方法中，在初始化时已得到车道检测区域和车道线划分，因此根据目标检测结果可直接得出车辆所在的车道。对比前后帧图像目标位置，可根据车辆ID计算出同一目标在图像中移动的距离和位置。再根据图像中车道线的划分以及《道路交通标志和标线》国家标准中车道标线的尺寸先验信息，可以得到图像中目标移动在现实世界中的距离，并根据帧时间间隔进一步计算出车速信息。根据所述车道信息、车辆信息、轨迹信息、车速信息分析当前道路在设定时间间隔内的交通状态，包括：总体及分车道、分车型流量、车速、密度、车头间距、车头时距、空间占有率、时间占有率等信息，并将交通状况数据与云端相连。除记录数据外，还根据跟踪数据、交通状态编写绘图程序，将记录数据可视化，以清晰观察每辆车的位置与轨迹，并直观展示当前统计周期内的交通状态，如图6所示，本发明实施例所采用的统计分析方法能够统计并展示交通流变化状态和对比结果。综上，本发明实施例所提供的方法具有以下优点：1.改进车辆目标检测和跟踪的网络结构，使其适合在边缘端进行部署和计算，在保证较高准确率的同时可以实时对车辆进行识别跟踪；2.初始化时自动分割道路区域和车道线，划分检测区域，在提升准确率的同时避免了繁琐的人工标注，节省时间和人力成本；3.能够更加灵活可靠地统计设定时间间隔内的各车道、各车型的流量、车速、密度、车头间距、车头时距、空间占有率、时间占有率等信息，判断当前交通状况，并有效通信至云端，方便进一步对整个路网交通进行统一调度，以确保交通运行的快速高效以及交通参与者的生命财产安全。实施例3本发明的另一方面，如图7所示，还提供一种边缘计算设备，该设备包括处理器、网络接口和存储器，所述处理器、所述网络接口和所述存储器相互连接，其中，所述存储器用于存储计算机程序，所述计算机程序包括程序指令，所述处理器被配置用于调用所述程序指令，执行上述基于边缘计算的实时道路交通状态监测方法。在一种可能的实现方式中，上述边缘计算设备采用瑞芯微RK3588边缘计算开发板。其中，RK3588是瑞芯微目前最强大的边缘计算设备，具有3个NPU核心，6TOPS计算性能，具有算力强，功耗小，成本低，便于部署的优点。本发明的另一方面，提供一种基于边缘计算的实时道路交通状态监测系统，包括：上述边缘计算设备、摄像头、屏幕、电源模块、通信模块，外壳，三脚架等设备。在使用时，使用三脚架放置在道路行驶右侧，安装设备到支架，使用电源模块供电，可实现单人放置，长时间自动工作。本实施例所提供的系统，将算法完全部署在了更接近前端采集设备边缘计算设备，与在云服务器、上位机的部署方式相比，传输成本更低，计算延时更低、云端服务器运算、存储压力更小。且边缘计算设备本身具有价格低，功耗小，部署方便等优点。具体的，本系统通过对屏幕图像的观察，确保设备安装无误后进行初始化，然后后对车辆进行实时检测跟踪、统计交通状态信息，并通过通信模块将记录结果传输。初始化时，对道路图像进行语义分割，分割出车道区域和车道线，自动计算各车道统计检测区域。在检测时，对视频进行实时逐帧分析，使用部署的改进yolov7进行车辆目标检测，后输入deepsort算法，使用部署的改进ShuffleNet进行重识别，进行目标跟踪，并根据相邻图像帧目标的移动距离以及图像空间与世界空间的变换关系计算车速，最后按照设定时间间隔对交通流参数进行分析和统计。在一种可能的实现方式中，上述监测系统还包括：云端服务器。所述云端服务器与所述边缘计算设备通讯连接，用于接收边缘计算设备传输的当前交通状态数据。本发明的另一方面，还提供一种计算机存储介质，所述计算机存储介质中存储有程序指令，所述程序指令被至少一个处理器执行时，用于实现上述基于边缘计算的实时道路交通状态监测。在本发明的实施例中，处理器可以是一种集成电路芯片，具有信号的处理能力。处理器可以是通用处理器、数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。可以实现或者执行本发明实施例中的公开的各方法、步骤及逻辑框图。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。结合本发明实施例所公开的方法的步骤可以直接体现为硬件译码处理器执行完成，或者用译码处理器中的硬件及软件模块组合执行完成。软件模块可以位于随机存储器，闪存、只读存储器，可编程只读存储器或者电可擦写可编程存储器、寄存器等本领域成熟的存储介质中。处理器读取存储介质中的信息，结合其硬件完成上述方法的步骤。存储介质可以是存储器，例如可以是易失性存储器或非易失性存储器，或可包括易失性和非易失性存储器两者。其中，非易失性存储器可以是只读存储器、可编程只读存储器、可擦除可编程只读存储器、电可擦除可编程只读存储器或闪存。易失性存储器可以是随机存取存储器，其用作外部高速缓存。通过示例性但不是限制性说明，许多形式的RAM可用，例如静态随机存取存储器、动态随机存取存储器、同步动态随机存取存储器、双倍数据速率同步动态随机存取存储器、增强型同步动态随机存取存储器、同步连接动态随机存取存储器和直接内存总线随机存取存储器。本发明实施例描述的存储介质旨在包括但不限于这些和任意其它适合类型的存储器。应该理解到，本发明所披露的系统，可通过其它的方式实现。例如所述模块的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，模块之间的通信连接可以是通过一些接口，服务器或单元的间接耦合或通信连接，可以是电性或其它的形式。另外，在本发明各个实施例中的各功能模块可以集成在一个处理单元中，也可以是各个模块单独物理存在，也可以两个或两个以上模块集成在一个处理单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。所述集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、只读存储器、随机存取存储器、移动硬盘、磁碟或者光盘等各种可以存储程序代码的介质。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
