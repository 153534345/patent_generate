标题title
网络设备的配置备份方法、网络设备及存储介质
摘要abst
本申请公开了一种网络设备的配置备份方法、网络设备及存储介质，该方法包括：在待备份设备的配置信息更新时，向所述待备份设备的邻设备发送备份协商请求；接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备；将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件。通过将配置文件备份到邻设备中，解决了配置文件不能提前备份的问题。
权利要求书clms
1.一种网络设备的配置备份方法，其特征在于，所述网络设备的配置备份方法包括以下步骤：在待备份设备的配置信息更新时，向所述待备份设备的邻设备发送备份协商请求；接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备；将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件。2.如权利要求1所述的网络设备的配置备份方法，其特征在于，所述将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件的步骤之后，还包括：在配置恢复进程被触发时，向邻设备发送配置信息获取请求；接收所述邻设备发送的配置响应信息，并根据所述配置响应信息确定目标邻设备；接收所述目标邻设备发送的版本号；通过预设算法对比得到目标版本号，向所述目标版本号对应的所述目标邻设备发送配置文件获取请求；基于链路层协议接收所述目标邻设备发送的保存有目标配置文件分片的目标报文。3.如权利要求2所述的网络设备的配置备份方法，其特征在于，所述接收所述邻设备响应的配置信息，并根据所述配置信息确定目标邻设备的步骤包括：接收所述邻设备发送的配置响应信息；选定配置响应信息为已备份信息的所述邻设备为所述目标邻设备，并向所述目标邻设备发送版本号获取请求，以使所述目标邻设备发送已备份配置文件所对应的版本号。4.如权利要求2所述的网络设备的配置备份方法，其特征在于，所述通过预设算法对比得到目标版本号，向所述目标版本号对应的所述目标邻设备发送配置文件获取请求的步骤包括：若通过预设算法对比得到的所述目标版本号至少有两个时，获取所述目标版本号对应的目标邻设备信息；获取所述目标邻设备信息中的端口号，并基于预设算法对比所述端口号得到目标端口号；向所述目标端口号对应的目标邻设备发送所述配置文件获取请求。5.如权利要求2所述的网络设备的配置备份方法，其特征在于，所述基于链路层协议接收所述目标邻设备发送的保存有目标配置文件分片的目标报文的步骤之后，还包括：获取所述目标报文所携带的目标配置文件分片和帧检验序列，并调取所述帧检验序列中的所述目标配置文件分片的存储量和所述目标配置文件分片的序号序列；根据所述存储量大小和所述序号序列验证所述目标配置文件分片的完整性；若验证结果为完整，将所述目标配置文件分片整合成目标配置文件，并基于所述目标配置文件完成配置动作。6.如权利要求1所述的网络设备的配置备份方法，其特征在于，所述接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备的步骤包括：接收所述邻设备针对所述备份协商请求的响应信息；根据所述响应信息确定发送所述响应信息的邻设备的剩余存储空间；当所述剩余存储空间大于或者等于预设阈值时，将所述邻设备作为所述备份邻设备。7.如权利要求1所述的网络设备的配置备份方法，其特征在于，所述将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备的步骤包括：生成或者获取更新后的所述配置信息对应的所述配置文件，并切分成配置文件分片；基于所述配置文件分片生成报文，并将所述报文发送至所述备份邻设备。8.如权利要求7所述的网络设备的配置备份方法，其特征在于，所述基于所述配置文件分片生成报文，并将所述报文发送至所述备份邻设备的步骤包括：获取所述配置信息中的存储量和所述配置文件的切片序号序列，并将所述存储量和所述切片序号序列存储在所述报文的帧检验序列中；执行将所述报文发送至所述备份邻设备的动作。9.一种网络设备，其特征在于，所述网络设备包括：存储器、处理器及存储在存储器上并可在所述处理器上运行的网络设备的配置备份方法的系统程序，所述网络设备的配置备份方法的系统程序被处理器执行实现如权利要求1至8任一项所述的网络设备的配置备份方法的步骤。10.一种存储介质，其特征在于，所述存储介质上存储有网络设备的配置备份方法的系统程序，所述网络设备的配置备份方法的系统程序被处理器执行实现如权利要求1至8任一项所述的网络设备的配置备份方法的步骤。
说明书desc
技术领域本申请涉及通信技术领域，尤其涉及一种网络设备的配置备份方法、网络设备及存储介质。背景技术网络设备一般是指数通设备以及安全设备，比如路由器、交换机等。网络设备的配置文件一般都存储在本地存储介质上。如果网络设备发生非恢复性故障，或者网络设备损坏需要更换网络设备时，即便用户对网络设备进行了更新和替换，也无法快速恢复本地存储介质上存储的配置文件，继而无法快速恢复用户业务。为了能使网络设备恢复业务，在备份网络设备的配置文件的相关方案中，由于备份在本地中的配置文件已丢失，所以需要手动完成网络设备的配置。因此，在网络设备需要配置时，由于配置文件不能提前备份，导致网络设备第一时间无配置文件可用。上述内容仅用于辅助理解本申请的技术方案，并不代表承认上述内容是现有技术。发明内容本申请提供一种网络设备的配置备份方法、网络设备及存储介质，旨在解决因配置文件不能提前备份或者备份不及时导致交换机第一时间无配置文件可用的问题。为实现上述目的，本申请提供的一种网络设备的配置备份方法，所述配置备份方法包括以下步骤：在待备份设备的配置信息更新时，向所述待备份设备的邻设备发送备份协商请求；接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备；将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件。可选地，所述将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件的步骤之后，还包括：在配置恢复进程被触发时，向邻设备发送配置信息获取请求；接收所述邻设备发送的配置响应信息，并根据所述配置响应信息确定目标邻设备；接收所述目标邻设备发送的版本号；通过预设算法对比得到目标版本号，向所述目标版本号对应的所述目标邻设备发送配置文件获取请求；基于链路层协议接收所述目标邻设备发送的保存有目标配置文件分片的目标报文。可选地，所述接收所述邻设备响应的配置信息，并根据所述配置信息确定目标邻设备的步骤包括：接收所述邻设备发送的配置响应信息；选定配置响应信息为已备份信息的所述邻设备为所述目标邻设备，并向所述目标邻设备发送版本号获取请求，以使所述目标邻设备发送已备份配置文件所对应的版本号。可选地，所述通过预设算法对比得到目标版本号，向所述目标版本号对应的所述目标邻设备发送配置文件获取请求的步骤包括：若通过预设算法对比得到的所述目标版本号至少有两个时，获取所述目标版本号对应的目标邻设备信息；获取所述目标邻设备信息中的端口号，并基于预设算法对比所述端口号得到目标端口号；向所述目标端口号对应的目标邻设备发送所述配置文件获取请求。可选地，所述基于链路层协议接收所述目标邻设备发送的保存有目标配置文件分片的目标报文的步骤之后，还包括：获取所述目标报文所携带的目标配置文件分片和帧检验序列，并调取所述帧检验序列中的所述目标配置文件分片的存储量和所述目标配置文件分片的序号序列；根据所述存储量大小和所述序号序列验证所述目标配置文件分片的完整性；若验证结果为完整，将所述目标配置文件分片整合成目标配置文件，并基于所述目标配置文件完成配置动作。可选地，所述接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备的步骤包括：接收所述邻设备针对所述备份协商请求的响应信息；根据所述响应信息确定发送所述响应信息的邻设备的剩余存储空间；当所述剩余存储空间大于或者等于预设阈值时，将所述邻设备作为所述备份邻设备。可选地，所述将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备的步骤包括：生成或者获取更新后的所述配置信息对应的所述配置文件，并切分成配置文件分片；基于所述配置文件分片生成报文，并将所述报文发送至所述备份邻设备。可选地，所述基于所述配置文件分片生成报文，并将所述报文发送至所述备份邻设备的步骤包括：获取所述配置信息中的存储量和所述配置文件的切片序号序列，并将所述存储量和所述切片序号序列存储在所述报文的帧检验序列中；执行将所述报文发送至所述备份邻设备的动作。此外，为实现上述目的，本申请还提供一种网络设备，所述网络设备包括：存储器、处理器及存储在存储器上并可在所述处理器上运行的网络设备的配置备份方法的系统程序，所述网络设备的配置备份方法的系统程序被处理器执行实现如上所述的网络设备的配置备份方法的步骤。此外，为实现上述目的，本申请还提供一种存储介质，所述存储介质上存储有网络设备的配置备份方法的系统程序，所述网络设备的配置备份方法的系统程序被处理器执行实现如上所述的网络设备的配置备份方法的步骤。本申请提供网络设备的配置备份方法、网络设备及存储介质，通过在待备份设备的配置信息更新时，向所述待备份设备的邻设备发送备份协商请求；接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备；将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件。即通过预先将配置文件备份在邻设备中，进而实现配置文件的提前备份。附图说明图1是本申请网络设备的配置备份方法的第一实施例的流程示意图；图2为本申请网络设备的配置备份方法的第二实施例的流程示意图；图3为本申请实施例涉及的网络设备的配置备份系统的硬件运行环境的架构示意图；本申请目的的实现、功能特点及优点将结合实施例，参照附图作进一步说明。具体实施方式本申请的网络设备的配置备份方法，通过将网络设备的配置文件以及更新后的新版配置文件，发送给周围的多台邻设备进行冗余备份，从而解决了配置文件不能提前备份或者备份不及时的问题。为了更好的理解上述技术方案，下面将参照附图更详细地描述本申请的示例性实施例。虽然附图中显示了本申请的示例性实施例，然而应当理解，可以以各种形式实现本申请而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更透彻地理解本申请，并且能够将本申请的范围完整的传达给本领域的技术人员。在网络中，两个设备之间是有连接的，对于以太网交换机或路由器，只要连接上就能通过链路层协议互相交换数据。本实施例采用LLDP链路层协议传递配置信息，使设备之间能感知并互相交换各自的配置版本信息，在两台设备开始建立链路之前，第一设备会先发送Configure-Request配置请求报文至另一设备，如果另一设备处于空闲状态，或者其内存空间充足，就会发送Configure-Ack配置确认报文至第一设备，同时该设备还会发送Configure-Request配置请求报文至第一设备，最后，在第一设备确认自身空闲后，发送Configure-Ack配置确认报文到另一设备之后，两台设备开始建立链路并可以传输数据。参照图1，在第一实施例中，所述网络设备的配置备份方法包括以下步骤：步骤S10：在待备份设备的配置信息更新时，向所述待备份设备的邻设备发送备份协商请求。在本实施例中，待备份设备指的是需要进行配置备份的网络设备。为便于描述，以下描述为待备份设备。可以由多种方式触发设备的配置信息更新，其中，这些方式可以是刚更换的待备份设备完成初始配置时，或者待备份设备接收到下发的更新包，并依据此更新包替换掉旧版本的配置文件时。当检测到设备执行了可以触发配置更新的动作时，将触发配置更新的设备作为待备份设备，进而由待备份设备向其邻设备发送备份协商请求。可选地，接收该协商信息的邻设备可以是一台网络设备，也可以是两台及两台以上的网络设备。并且当该备份设备所处的局域网中新增邻设备时，对该邻设备执行如上所述的动作。其中，待备份设备和邻设备包括但不限于交换机和路由器等。作为一种可选地实施方式，在执行可触发配置更新的动作后，先获取待备份设备中的配置文件，而后确定此配置文件的文件大小。进而依据文件大小生成用于与邻设备进行协商的互相协商的备份协商请求，并基于链路层协议将此备份协商请求发送至邻设备。在本实施例中，发送的备份协商请求可以是虚拟链路协商报文，虚拟链路协商报文的格式为，其中，domainId表示发送方设备所在的虚拟化域，memberId表示发送方设备在虚拟化域中的成员编号，vpId表示发送方物理端口所属的虚拟化端口，portId表示发送方物理端口的编号。作为另一种可选地实施方式，在执行可触发配置更新的动作后，待备份设备无需获取设备中的配置文件，直接向邻设备发送备份协商请求，其中，该备份协商请求用于获取邻设备的剩余存储空间。示例性的，假设在交换机利用预存的配置文件配置完成后，获取到该初始配置文件的大小为600kb，再通过生成协商报文，并把600kb的数值作为一串数组保存在报文中，最后将该协商报文发送给附近的所有交换机。步骤S20：接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备。在本实施例中，邻设备依据待备份设备发送的备份协商请求，反馈对应的响应信息，其中，如果发送的协商请求中包含有配置文件的存储量，则反馈的响应信息可以是协商成功，也可以是协商失败。将接收到的响应信息是协商成功的邻设备确定为备份邻设备，并与这些备份邻设备建立链路连接。可选地，如果响应信息是协商成功，则对应的接收到的报文信息可以是Configure-Ack配置确认报文。如果响应信息是协商失败，则对应的接收到的报文信息可以是Configure-Reject配置拒绝报文。进一步地，在本实施例中，所述步骤S20包括：接收所述邻设备针对所述备份协商请求的响应信息；根据所述响应信息确定发送所述响应信息的邻设备的剩余存储空间；当所述剩余存储空间大于或者等于预设阈值时，将所述邻设备作为所述备份邻设备。具体的，接收到邻设备反馈的响应信息可以包含有邻设备目前阶段的剩余存储空间，以及邻设备目前的状态，并根据以上条件判断邻设备是否能够成为可备份配置文件的目标邻设备。在本实施例中，通过响应信息确定备份邻设备的方式也可以是待备份设备将自身配置文件的存储量，发送至邻设备。而后邻设备根据此存储量判断是否可以存储，并根据设备状态是否空闲，最终确定是否支持备份待备份设备的配置文件。可选地，所述预设阈值可以是待备份设备中的配置文件的存储量，也可以是用户为了让备份设备预留更多的存储空间，将存储量加上预设的值，从而生成的预设阈值。示例性的，假设一台交换机需要将自身的配置文件发送给周围的交换机备份，此时，待备份的交换机会批量发送协商报文至周围的交换机。这些邻交换机接收到此协商报文后，根据此协商报文信息判断自身的设备状态，并将此状态信息以报文的形式反馈给待备份的交换机。待备份的交换机根据这些邻交换机的所反馈的状态信息，选取其中剩余存储空间充足且处于空闲状态的交换机，并将这些交换机作为可以备份配置文件的备份交换机。步骤S30：将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件。在本实施例中，配置信息更新后，网络设备也完成了配置动作，会自动将配置信息作为配置文件保存。并将已保存的文件基于链路层协议发送至备份设备，应当理解的是，此备份设备是之前协商完成并支持备份的设备。可选地，配置信息更新的过程，可以是接收到服务器下发的更新包，将其中的配置信息替换网络设备本地配置文件中的配置信息，也可以是一个新的网络设备完成初始配置的过程。可选地，在本实施例中，所述步骤S30包括：生成或者获取更新后的所述配置信息对应的所述配置文件，并将所述配置文件切分成配置文件分片；基于所述配置文件分片生成报文，并将所述报文发送至所述备份邻设备。具体的，通过链路层协议发送报文，将发送的数据存储在报文中，所以，需要将配置文件切分成多个配置文件切片，再将得到配置文件切片以序号排列并标志，并将排列好的配置文件切片存储在LLDP协议报文的TLV数据编码格式中。示例性的，其中的链路层协议可以是LLDP链路层发现协议，该链路层发现协议用于在局域网中发现和获取相邻设备的信息，它是一种开放标准协议，由IEEE802.1AB标准定义。通过在数据帧中携带信息元素的方式，向相邻设备发送链路信息，包括设备的标识、端口标识、设备能力、管理地址等。LLDP协议的主要作用是帮助网络管理员实现网络拓扑发现和管理，通过LLDP协议，管理员可以获取网络中设备的拓扑结构信息，包括设备之间的连接关系、设备的类型和能力等。将初始配置文件切分成配置文件分片后，保存在LLDP协议报文携带的信息元素TLV中，TLV是LLDP中用于传输链路层信息的基本单位，由三部分组成，包括Type：用于标识TLV的类型，不同的类型表示不同的链路层信息。例如，类型为1的TLV表示系统名称，类型为2的TLV表示端口标识符。Length：用于指示TLV值字段的长度，以字节为单位。Value：包含具体的链路层信息，长度由Length字段指示。LLDP协议报文中的TLV字段存储有配置文件版本号、配置文件分片序号、配置文件分片内容和配置文件总分片数等配置文件的信息。作为一种可选的实施方式，在通过配置文件切片生成报文的过程中，还包括以下的步骤：获取所述配置信息中的存储量和所述配置文件的切片序号序列，并将所述存储量和所述切片序号列存储在所述报文的帧检验序列中；执行所述将所述报文通过链路层协议发送至所述备份邻设备。在本实施例中，LLDP协议报文中包含FCS帧检验序列，可以用来检验传输数据的完整性，以防止传输过程中出现数据缺失的问题。用于验证传输数据完整性的方式还可以是，待备份设备将配置文件大小和序列号单独生成一个校验码，并将该校验码与配置文件相关联。示例性的，假设接收到的邻设备的信息是协商成功的信息，此时先将初始配置文件分为多个配置文件分片，将这些配置文件分片存储在LLDP链路层协议报文的TLV字段中，其中，配置文件分片具体是存储在TLV的Value中，并在TLV的Value中标注该配置文件分片的序号和内容。当上述步骤完成后，将保存好的配置文件分片通过该LLDP链路层协议发送至邻设备。在本实施例提供的技术方案中，通过将配置文件的存储量跟邻设备协商配置文件信息，以确保邻设备有足够的存储空间备份配置文件。通过将配置文件划分为配置文件分片，并将配置文件分片以报文形式传输，在报文的帧检验序列中添加存储量和分片序列号，提高了文件传输速率，并且可以对传输文件的完整性进行验证。参照图2，在第二实施例中，所述网络设备的配置备份方法包括以下步骤：步骤S40：在配置恢复进程被触发时，向邻设备发送配置信息获取请求。在本实施例中，更换网络设备，将网络设备连入局域网时会触发配置恢复进程；以及因为硬件的非恢复性障碍导致网络设备的配置文件的缺失，也会触发配置恢复进程。当配置恢复进程被触发时，检测处于同一局域网中的邻设备，并向这些邻设备发送配置信息获取请求。配置信息获取请求中包含有本设备的系统配置名称或ID等信息，可以供邻设备查询是否备份有与系统配置名称或ID所对应的配置文件。示例性的，假设在容灾场景下，由于交换机损坏需要更换交换机，因为之前保存在本地的配置文件已丢失，此时待备份交换机会基于链路层协议向处于同一局域网中的邻设备发送获取指令，以获取邻设备中所保存的配置文件的版本号。步骤S50：接收所述邻设备发送的配置响应信息，并根据所述配置响应信息确定目标邻设备；接收所述目标邻设备发送的版本号。在本实施例中，接收到的配置响应信息，是由接收配置信息获取请求的邻设备所反馈的。此配置响应信息是邻设备根据接收到的配置信息获取请求，检测自身是否备份有待备份设备的配置文件，并依据此检测结果所生成的配置响应信息。可选地，在本实施例中，所述步骤S50包括：接收所述邻设备发送的配置响应信息；选定配置响应信息为已备份信息的所述邻设备为所述目标邻设备，并向所述目标邻设备发送版本号获取请求，以使所述目标邻设备发送已备份配置文件所对应的版本号。具体的，接收完邻设备所反馈的配置响应信息后，通过对获取的响应信息进行判断，只选取已备份该设备的配置文件的邻设备，并向这些邻设备发送版本号获取请求，以获取这些设备所备份的配置文件的版本号。示例性的，接收交换机所反馈的响应报文，其中，报文中存储有对应请求报文的答复信号，当交换机备份有对应的配置文件时，可设置答复信号为1，反之则将答复信号设置为0。选取其中答复信号为1的交换机，并基于LLDP协议向此类交换机发送请求报文，其中请求报文中携带有获取配置文件版本号的指令。步骤S60：通过预设算法对比得到目标版本号，向所述目标版本号对应的所述目标邻设备发送配置文件获取请求。在本实施例中，利用预设算法对获取到的所有的版本号进行对比，从而获得最大的版本号，并将最大的版本号作为目标版本号。其中，该目标版本号所对应的版本文件，是该待备份设备最近时间传输给邻设备的配置文件。可选地，预设算法包括但不限于线性搜索算法：遍历版本列表，逐个比较版本号大小，找到最大的版本号。字典序比较算法：将版本号按照点号分隔成多个部分，逐个比较各个部分的大小，确定较大的版本号。二分搜索算法：如果版本号列表是有序的，可以使用二分搜索算法来快速找到最大版本号。版本号转化为整数比较算法：将版本号转化为整数进行比较，然后比较两个整数的大小。可选地，在本实施例中，所述步骤S50包括：若通过预设算法对比得到的所述目标版本号至少有两个时，获取所述目标版本号对应的目标邻设备信息；获取所述目标邻设备信息中的端口号，并基于预设算法对比所述端口号得到目标端口号；向所述目标端口号对应的目标邻设备发送所述配置文件获取请求。在本实施例中，端口号的大小会影响到数据的传输速率，当存在多个相同最新版本号，即对比结果存在多个邻设备备份了相同版本号的配置文件，则通过端口号筛选最大端口对应的邻设备，可以加快传输速率。作为一种可选地实施方式，当存在最新的版本号对应有多个邻设备时，可以通过获取这些邻设备的及时状态信息、带宽速率和网关的开启数量等设备基本信息，根据此信息对比，或者做加权平均值，取其中性能最优或者加权平均值最高的邻设备，并获取此设备所保存的配置文件。示例性的，假设一共有5台交换机备份了待备份交换机的配置文件，该交换机会获取这5台邻设备所备份的配置文件的版本号。假设5台交换机备份的配置文件的版本号分别是V2.1、V2.9、V2.8、V2.9和V2.8，通过线性搜索算法逐个比较版本号的大小，得到最大的版本号为V2.9，此时因为最大版本号为V2.9的交换机有两台，就需要再获取这两台交换机的端口号，取其中比较大的端口号所对应的交换机，并向该交换机发送报文以获取端口号所对应的配置文件。步骤S70：基于链路层协议接收所述目标邻设备发送的保存有目标配置文件分片的目标报文。在本实施例中，在接收目标报文之前，目标邻设备会先获取存储在存储介质中的配置文件和校验码，并基于此生成目标报文。该目标报文还保存有可以检验文件完整性的帧检验序列，并且目标邻设备发送完配置文件后，不会删除该配置文件。可选地，在本实施例中，所述步骤S70之后，还包括：获取所述目标报文所携带的目标配置文件分片和帧检验序列，并调取所述帧检验序列中的所述目标配置文件分片的存储量和所述目标配置文件分片的序号序列；根据所述存储量大小和所述序号序列验证所述目标配置文件分片的完整性；若验证结果为完整，将所述目标配置文件分片整合成目标配置文件，并基于所述目标配置文件完成配置动作。具体的，接收邻设备发送的LLDP协议报文信息，其中，该报文的TLV字段中存储有配置文件的各个分片，通过获取这些文件分片并将其整合可以得到完整的最新配置文件。将帧检验序列中的存储量具体数值与接收到的配置文件的存储量对比，若存储量相同，则判断该配置文件完整；若是不相同，则判断该配置文件不完整。帧检验序列中的序号序列也可以验证文件完整，以此序号序列与配置文件分片的所有序号对比，判断配置文件是否存在缺失分片的情况。示例性的，假设待备份交换机接收到保存有配置文件的LLDP协议报文，通过解析该报文可以获取到配置文件分片以及帧检验序列，其中，配置文件分片以TLV的形式存储在LLDP协议报文中。对解析完的LLDP协议报文中的配置文件分片进行验证，验证的方式是通过将帧检验序列中所保存的序号序列，挨个比对配置文件分片的序号是否缺失。最后按照配置文件分片的序号，对配置文件分片进行有序的整合，并以此配置文件完成对待配置交换机的配置。在本实施例提供的技术方案中，当更换交换机或者交换机损坏导致配置文件丢失时，向所有邻设备获取配置文件的版本号，并将所有版本号对比取最新的版本号，以保证获取到的配置文件是最新版本的配置文件，防止配置文件的版本过于老旧而无法配置的问题发生。当获取到多个最新版本号时，获取这些邻设备的端口号，并对比出端口号最大的邻设备，还可以对比这些邻设备的设备信息，选取设备性能最优的设备。采取此方式可以加快发送配置文件的速率以及确保发送配置文件的及时性。并且，通过报文中的帧检验序列验证配置文件的完整性，可以保证获取到的配置文件是完整的。由于本申请实施例所介绍的系统，为实施本申请实施例的方法所采用的系统，故而基于本申请实施例所介绍的方法，本领域所属人员能够了解该系统的具体结构及变形，故而在此不再赘述。凡是本申请实施例的方法所采用的系统都属于本申请所欲保护的范围。作为一种实施方案，图3为本发明实施例方案涉及的网络设备的硬件运行环境的架构示意图。如图3所示，该网络设备可以包括：处理器1001，例如中央处理器，通信总线1002，网络接口1003，存储器1004。其中，通信总线1002用于实现这些组件之间的连接通信。网络接口1003可选的可以包括标准的有线接口、无线接口接口）。存储器1004可以是高速的随机存取存储器存储器，也可以是稳定的非易失性存储器，例如磁盘存储器。存储器1004可选的还可以是独立于前述处理器1001的存储装置。本领域技术人员可以理解，图3中示出的结构并不构成对网络设备的配置备份系统的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。如图3所示，作为一种存储介质的存储器1004中可以包括操作系统、网络通信模块以及网络设备的配置备份程序。其中，操作系统是管理和控制网络设备的配置备份的硬件和软件资源的程序，网络设备的配置备份程序以及其他软件或程序的运行。在图3所示的网络设备的配置备份中，网络接口1003主要用于连接终端，与终端进行数据通信；处理器1001可以用于调用存储器1004存储的网络设备的配置备份程序。在本实施例中，网络设备包括：存储器1004、处理器1001及存储在所述存储器上并可在所述处理器上运行的网络设备的配置备份程序，其中：在一实施例中，处理器1001调用存储器1004中存储的网络设备的配置备份程序时，执行以下操作：在待备份设备的配置信息更新时，向所述待备份设备的邻设备发送备份协商请求；接收所述邻设备针对所述备份协商请求的响应信息，根据所述响应信息确定备份邻设备；将更新后的所述配置信息对应的配置文件，发送至所述备份邻设备，以使所述备份邻设备能备份所述配置文件。在一实施例中，处理器1001可以用于调用存储器1004中存储的网络设备的配置备份程序，并执行以下操作：在配置恢复进程被触发时，向邻设备发送配置信息获取请求；接收所述邻设备发送的配置响应信息，并根据所述配置响应信息确定目标邻设备；接收所述目标邻设备发送的版本号；通过预设算法对比得到目标版本号，向所述目标版本号对应的所述目标邻设备发送配置文件获取请求；基于链路层协议接收所述目标邻设备发送的保存有目标配置文件分片的目标报文。在一实施例中，处理器1001调用存储器1004中存储的网络设备的配置备份程序时，执行以下操作：接收所述邻设备发送的配置响应信息；选定配置响应信息为已备份信息的所述邻设备为所述目标邻设备，并向所述目标邻设备发送版本号获取请求，以使所述目标邻设备发送已备份配置文件所对应的版本号。在一实施例中，处理器1001调用存储器1004中存储的网络设备的配置备份程序时，执行以下操作：若通过预设算法对比得到的所述目标版本号至少有两个时，获取所述目标版本号对应的目标邻设备信息；获取所述目标邻设备信息中的端口号，并基于预设算法对比所述端口号得到目标端口号；向所述目标端口号对应的目标邻设备发送所述配置文件获取请求。在一实施例中，处理器1001调用存储器1004中存储的网络设备的配置备份程序时，执行以下操作：获取所述目标报文所携带的目标配置文件分片和帧检验序列，并调取所述帧检验序列中的所述目标配置文件分片的存储量和所述目标配置文件分片的序号序列；根据所述存储量大小和所述序号序列验证所述目标配置文件分片的完整性；若验证结果为完整，将所述目标配置文件分片整合成目标配置文件，并基于所述目标配置文件完成配置动作。在一实施例中，处理器1001调用存储器1004中存储的网络设备的配置备份程序时，执行以下操作：接收所述邻设备针对所述备份协商请求的响应信息；根据所述响应信息确定发送所述响应信息的邻设备的剩余存储空间；当所述剩余存储空间大于或者等于预设阈值时，将所述邻设备作为所述备份邻设备。在一实施例中，处理器1001调用存储器1004中存储的网络设备的配置备份程序时，执行以下操作：生成或者获取更新后的所述配置信息对应的所述配置文件，并切分成配置文件分片；基于所述配置文件分片生成报文，并将所述报文发送至所述备份邻设备。在一实施例中，处理器1001调用存储器1004中存储的网络设备的配置备份程序时，执行以下操作：获取所述配置信息中的存储量和所述配置文件的切片序号序列，并将所述存储量和所述切片序号序列存储在所述报文的帧检验序列中；执行将所述报文发送至所述备份邻设备的动作。此外，本领域普通技术人员可以理解的是实现上述实施例的方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成。该计算机程序包括程序指令，计算机程序可以存储于一存储介质中，该存储介质为计算机可读存储介质。该程序指令被设备中的至少一个处理器执行，以实现上述方法的实施例的流程步骤。因此，本申请还提供一种存储介质，所述存储介质存储有网络设备的配置备份程序，所述网络设备的配置备份程序被处理器执行时实现如上实施例所述的网络设备的配置备份方法的各个步骤。其中，所述存储介质可以是U盘、移动硬盘、只读存储器、磁碟或者光盘等各种可以存储程序代码的存储介质。需要说明的是，由于本申请实施例提供的存储介质，为实施本申请实施例的方法所采用的存储介质，故而基于本申请实施例所介绍的方法，本领域所属人员能够了解该存储介质的具体结构及变形，故而在此不再赘述。凡是本申请实施例的方法所采用的存储介质都属于本申请所欲保护的范围。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。应当注意的是，在权利要求中，不应将位于括号之间的任何参考符号构造成对权利要求的限制。单词“包含”不排除存在未列在权利要求中的部件或步骤。位于部件之前的单词“一”或“一个”不排除存在多个这样的部件。本申请可以借助于包括有若干不同部件的硬件以及借助于适当编程的计算机来实现。在列举了若干装置的单元权利要求中，这些装置中的若干个可以是通过同一个硬件项来具体体现。单词第一、第二、以及第三等的使用不表示任何顺序。可将这些单词解释为名称。尽管已描述了本申请的优选实施例，但本领域内的技术人员一旦得知了基本创造性概念，则可对这些实施例作出另外的变更和修改。所以，所附权利要求意欲解释为包括优选实施例以及落入本申请范围的所有变更和修改。显然，本领域的技术人员可以对本申请进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本申请的这些修改和变型属于本申请权利要求及其等同技术的范围之内，则本申请也意图包含这些改动和变型在内。
