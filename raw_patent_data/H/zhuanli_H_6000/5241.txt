标题title
一种自动适配不同通信路由表的方法
摘要abst
本发明涉及一种自动适配不同通信路由表的方法，当通信路由表变更时，对变更后的通信路表进行解析，生成协议数据表，然后将协议数据表下载到产品中进行解析并存储，然后依据存储的协议数据表进行信号的接收发送。本发明的方法可以直接快速应对通信路由表变更，可以实现不同车厂、不同车型产品都可以使用同一程序，从而降低开发和维护成本。
权利要求书clms
1.一种自动适配不同通信路由表的方法，其特征在于：所述方法包括以下步骤：步骤1、使用通信路由表自动解析工具加载新的通信路由表，自动生成协议数据表；生成的协议数据表内容包括帧接收配置表、帧发送配置表、报文帧直转路由表、报文字节直转路由表、信号路由表；步骤2、将步骤1生成的协议数据表下载到产品中，将协议数据表中的报文帧直转路由表、报文字节直转路由表、信号路由表直接存储到产品的指定数据区内，帧接收配置表、帧发送配置表则转换成处理器信号接收配置表、处理器信号发送配置表，然后存储到指定数据区内；步骤3、重启产品，自动适配新的通信路由表，并依据新的通信路由表进行信号接收发送；具体如下：首先，产品依据处理器信号接收表和处理器信号发送配置表，对相应的寄存器进行初始化配置；当接收中断信号接收时，查找处理器信号接收配置表，然后进行如下处理：判断此帧信号是否为报文帧直转路由，如果是则查找报文帧直转路由信息，将报文帧数据压入到对应的发送通道缓存列表中；判断此帧信号是都为报文字节直转路由，如果是则查找报文帧直转路由表信息，将报文帧数据里的需要字节压入到对应的发送通道缓存列表中；判断是否要接收到通道缓存中，如果是则将报文帧数据压入到本通道接收缓存列表中；周期扫描接收缓存列表时，进行如下处理：判断刺针信号是否为信号路由，如果是则查找信号路由表信息，将需要信号路由的数据传入给发送数据中；最后判断其他程序是否需要本信号数据，如果是则将报文数据传入到其他程序；当接收中断信号发送时，判断发送通道缓存列表是否为空，如果不是则将发送通道缓存列表数据压入发送寄存器中；周期扫描发送时，查找处理器信号发送配置表后，进行如下处理：判断周期报文是否达到发送要求，如果是将发送数据压入发送通断缓存列表中；判断事件报文是否达到发送要求，如果是将发送数据压入发送通道缓存列表中。2.根据权利要求1所述的一种自动适配不同通信路由表的方法，其特征在于：所述帧接收配置表用于存储所有的接收信息，包括通道、ID、数据长度、周期、是否为报文帧直转路由帧、是否为报文字节直转路由帧、是否为信号路由帧、是否存在接收通道缓存；所述帧发送配置表用于存储除报文帧直转路由信号和报文字节直转路由信号外的所有发送信息，包括通道、ID、数据长度、是否为周期报文、发送周期、是否为事件报文、发送间隔周期；所述报文帧直转路由表包括源通道、源ID、目标通道、目标ID、长度；所述报文字节直转路由表包含源通道、源ID、源起始位、目标通道、目标ID、目标起始位、长度；所述信号路由表包含源通道、源ID、源起始位、目标通道、目标ID、目标起始位、长度。
说明书desc
技术领域本发明涉及汽车通信技术领域，具体涉及一种自动适配不同通信路由表的方法。背景技术车厂在完成汽车硬件生产后，一般需要由专门的团队负责整车的通信开发及维护工作，对于不同品牌的汽车以及同一品牌的不同款式的汽车，其通信路由表是不同的，所以需要不同的软件去维护。而且随着车厂汽车车型改款或增加，整车通信路由表也会变更频繁，要实现通信矩阵变更功能一般都需要修改软件，效率低，易出错。特别是每到年度改款或者升级时，整车通信路欧标变更车型较多，每个车型都需要多人对应，软件无法平台化，人工成本高。发明内容针对现有技术存在的问题，本发明的目的在于提供一种自动适配不同通信路由表的方法，其可快速实现通信路由表变更，降低工作人员的维护成本。为实现上述目的，本发明采用的技术方案是：一种自动适配不同通信路由表的方法，其包括以下步骤：步骤1、使用通信路由表自动解析工具加载新的通信路由表，自动生成协议数据表；生成的协议数据表内容包括帧接收配置表、帧发送配置表、报文帧直转路由表、报文字节直转路由表、信号路由表；步骤2、将步骤1生成的协议数据表下载到产品中，将协议数据表中的报文帧直转路由表、报文字节直转路由表、信号路由表直接存储到产品的指定数据区内，帧接收配置表、帧发送配置表则转换成处理器信号接收配置表、处理器信号发送配置表，然后存储到指定数据区内；步骤3、重启产品，自动适配新的通信路由表，并依据新的通信路由表进行信号接收发送；具体如下：首先，产品依据处理器信号接收表和处理器信号发送配置表，对相应的寄存器进行初始化配置；当接收中断信号接收时，查找处理器信号接收配置表，然后进行如下处理：判断此帧信号是否为报文帧直转路由，如果是则查找报文帧直转路由信息，将报文帧数据压入到对应的发送通道缓存列表中；判断此帧信号是都为报文字节直转路由，如果是则查找报文帧直转路由表信息，将报文帧数据里的需要字节压入到对应的发送通道缓存列表中；判断是否要接收到通道缓存中，如果是则将报文帧数据压入到本通道接收缓存列表中；周期扫描接收缓存列表时，进行如下处理：判断刺针信号是否为信号路由，如果是则查找信号路由表信息，将需要信号路由的数据传入给发送数据中；最后判断其他程序是否需要本信号数据，如果是则将报文数据传入到其他程序；当接收中断信号发送时，判断发送通道缓存列表是否为空，如果不是则将发送通道缓存列表数据压入发送寄存器中；周期扫描发送时，查找处理器信号发送配置表后，进行如下处理：判断周期报文是否达到发送要求，如果是将发送数据压入发送通断缓存列表中；判断事件报文是否达到发送要求，如果是将发送数据压入发送通道缓存列表中。所述帧接收配置表用于存储所有的接收信息，包括通道、ID、数据长度、周期、是否为报文帧直转路由帧、是否为报文字节直转路由帧、是否为信号路由帧、是否存在接收通道缓存；所述帧发送配置表用于存储除报文帧直转路由信号和报文字节直转路由信号外的所有发送信息，包括通道、ID、数据长度、是否为周期报文、发送周期、是否为事件报文、发送间隔周期；所述报文帧直转路由表包括源通道、源ID、目标通道、目标ID、长度；所述报文字节直转路由表包含源通道、源ID、源起始位、目标通道、目标ID、目标起始位、长度；所述信号路由表包含源通道、源ID、源起始位、目标通道、目标ID、目标起始位、长度。采用上述方案后，当通信路由表变更时，对变更后的通信路表进行解析，生成协议数据表，然后将协议数据表下载到产品中进行解析并存储，然后依据存储的协议数据表进行信号的接收发送。本发明的方法可以直接快速应对通信路由表变更，可以实现不同车厂、不同车型产品都可以使用同一程序，从而降低开发和维护成本。附图说明图1为本发明产品加载协议数据表示意图；图2为本发明接收到中断信号发送和中断信号接收时的处理流程图；图3为本发明的周期扫描时的流程图。具体实施方式如图1所示，本发明揭示了一种自动适配不同通信路由表的方法，其包括以下步骤：步骤1、使用通信路由表自动解析工具加载新的通信路由表，自动生成协议数据表。生成的协议数据表内容包括：帧接收配置表，其存储所有的接收信息，包括通道、ID、数据长度、周期、是否为报文帧直转路由帧、是否为报文字节直转路由帧、是否为信号路由帧、是否存在接收通道缓存等；帧发送配置表，其存储除报文帧直转路由信号和报文字节直转路由信号外的所有发送信息，包括通道、ID、数据长度、是否为周期报文、发送周期、是否为事件报文、发送间隔周期等；报文帧直转路由表，包括源通道、源ID、目标通道、目标ID、长度等信息；报文字节直转路由表，包含源通道、源ID、源起始位、目标通道、目标ID、目标起始位、长度等信息；信号路由表，包含源通道、源ID、源起始位、目标通道、目标ID、目标起始位、长度等信息。步骤2、将步骤1生成的协议数据表下载到产品中，将协议数据表中的报文帧直转路由表、报文字节直转路由表、信号路由表直接存储到产品的指定数据区内，帧接收配置表、帧发送配置表则转换成处理器信号接收配置表、处理器信号发送配置表，然后存储到指定数据区内。步骤3、重启产品，自动适配新的通信路由表，并依据新的通信路由表进行信号接收发送。具体如图2和图3所示。首先，产品依据处理器信号接收表和处理器信号发送配置表，对相应的寄存器进行初始化配置；当接收中断信号接收时，查找处理器信号接收配置表，然后进行如下处理：判断此帧信号是否为报文帧直转路由，如果是则查找报文帧直转路由信息，将报文帧数据压入到对应的发送通道缓存列表中；判断此帧信号是都为报文字节直转路由，如果是则查找报文帧直转路由表信息，将报文帧数据里的需要字节压入到对应的发送通道缓存列表中；判断是否要接收到通道缓存中，如果是则将报文帧数据压入到本通道接收缓存列表中。当接收中断信号发送时，判断发送通道缓存列表是否为空，如果不是则将发送通道缓存列表数据压入发送寄存器中。周期扫描接收缓存列表时，进行如下处理：判断刺针信号是否为信号路由，如果是则查找信号路由表信息，将需要信号路由的数据传入给发送数据中；最后判断其他程序是否需要本信号数据，如果是则将报文数据传入到其他程序。周期扫描发送时，查找处理器信号发送配置表后，进行如下处理：判断周期报文是否达到发送要求，如果是将发送数据压入发送通断缓存列表中。判断事件报文是否达到发送要求，如果是将发送数据压入发送通道缓存列表中。综上，本发明的关键在于，当通信路由表变更时，对变更后的通信路表进行解析，生成协议数据表，然后将协议数据表下载到产品中进行解析并存储，然后依据存储的协议数据表进行信号的接收发送。本发明的方法可以直接快速应对通信路由表变更，可以实现不同车厂、不同车型产品都可以使用同一程序，从而降低开发和维护成本。以上所述，仅是本发明实施例而已，并非对本发明的技术范围作任何限制，故凡是依据本发明的技术实质对以上实施例所作的任何细微修改、等同变化与修饰，均仍属于本发明技术方案的范围内。
