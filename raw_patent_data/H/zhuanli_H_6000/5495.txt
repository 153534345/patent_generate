标题title
一种在模拟比较器中校正差分失配的数字校正装置和方法
摘要abst
本发明提供一种在模拟比较器中校正差分失配的数字校正装置和方法，涉及模拟比较器失配校正技术领域，包括：模拟电路，所述模拟电路包括模拟比较器，所述模拟比较器的P输入端和INPUT输入端口连接，所述模拟比较器的N输入端和参考电压端口连接，所述P输入端和INPUT输入端口的连接线上设置有SW0开关，所述P输入端和N输入端连接线上设置有SW1开关；数字电路，数字电路包括数字计数器和检测器，所述数字计数器和所述模拟比较器电性连接，用于接收所述模拟比较器的输出信号。因此可以区分和有效的消除输入对管失配和电流镜失配对比较器的影响，从而提高占空比检测电路的检测精度，减少模拟比较器由于输入对管的失配和电流镜的失配对其的影响。
权利要求书clms
1.一种在模拟比较器中校正差分失配的数字校正装置，其特征在于，包括：模拟电路，所述模拟电路包括模拟比较器，所述模拟比较器的P输入端和INPUT输入端口连接，所述模拟比较器的N输入端和参考电压端口连接，所述P输入端和INPUT输入端口的连接线上设置有SW0开关，所述P输入端和N输入端连接线上设置有SW1开关；数字电路，所述数字电路包括数字计数器和检测器，所述数字计数器和所述模拟比较器电性连接，用于接收所述模拟比较器的输出信号COMP_OUT，所述输出信号COMP_OUT用于控制所述数字计数器输出EN信号，所述EN信号用于控制数字计数器输出的OFFSET的二进制数逐一增加，当所述模拟比较器的输出产生从0到1的上升沿信号或从1到0的下降沿信号，所述检测器输出CALIB_DONE到所述模拟比较器，所述数字计数器停止计数；所述模拟比较器包括多路P管、多路N管和输出锁存器，所述多路P管和多路P开关一一连接，所述多路N管和多路N开关一一连接，所述锁存器的输出端OUTP和所述P输入端级联，所述锁存器的输出端OUTN和所述N输入端级联，所述锁存器，用于暂时锁存所述数字计数器输出的OFFSET的二进制数。2.根据权利要求1所述的一种在模拟比较器中校正差分失配的数字校正装置，其特征在于，所述模拟比较器的P输入端和N输入端始终保持短接，使SW0=0，SW1=1。3.根据权利要求1所述的一种在模拟比较器中校正差分失配的数字校正装置，其特征在于，所述EN 为0时，所述模拟比较器不工作，所述EN为1时，所述模拟比较器工作。4.根据权利要求1所述的一种在模拟比较器中校正差分失配的数字校正装置，其特征在于，所述OFFSET分为P极和N极，设置P极初始值为0000,为负失配，N极初始值为0000，为正失配。5.根据权利要求1所述的一种在模拟比较器中校正差分失配的数字校正装置，其特征在于，所述数字计数器为定时触发电路、锁存电路和计数电路搭建的数字逻辑电路。6.根据权利要求1所述的一种在模拟比较器中校正差分失配的数字校正装置，其特征在于，所述检测器为锁存电路和计数电路搭建的数字逻辑电路。7.根据权利要求1所述的一种在模拟比较器中校正差分失配的数字校正装置，其特征在于，所述多路P开关均为N-MOS管，所述多路P开关包括P0-P3，所述多路N开关均为N-MOS管，所述多路N开关包括N0-N3。8.一种在模拟比较器中校正差分失配的数字校正方法，其特征在于，所述在模拟比较器中校正差分失配的数字校正方法基于权利要求1-7任意一项所述的一种在模拟比较器中校正差分失配的数字校正装置，该方法包括如下步骤：S1.将SW0打开，SW1闭合，使模拟比较器的两个输入端短接，均为参考电压，初始状态时，设置P极为0000,N极为0000；S2-1初始时，模拟比较器输出是0，会把模拟比较器的输出COMP_OUT传递到数字计数器，控制数字计数器的增加，调整P极开关开启的数目，数字计数器输出向着P极=0000==》0001==》0011==》0111==》1111的方向进行，当数字计数器输出的EN信号为1时控制模拟比较器正端的P极增加，使P极=0001，模拟比较器的输出COMP_OUT是0，流通的N管个数为1，数字计数器输出会继续增加到0011，当模拟比较器的输出没有变化，流通的N管个数为2，数字计数器输出会继续增加到0111，流通的N管个数为3，数字计数器输出会继续增加到1111，流通的N管个数为4，直到模拟比较器的输出COMP_OUT发生翻转，即出现从0到1的上升沿，此时数字计数器停止计数，计数器的值会被锁存器锁存起来，暂时控制模拟比较器的P极增加，校正的过程中N极一直是0000，当然可能在数字计数器的输出增加到0111时，模拟比较器的输出CALIB_DONE实现了翻转，即出现从0到1的上升沿；S2-2.初始时，模拟比较器的输出是1，将模拟比较器的输出COMP_OUT传递到数字计数器，控制数字计数器的输出的增加，调整N极开关开启的数目，数字计数器输出向着N极=0000==》0001==》0011==》0111==》1111的方向进行，当数字计数器输出的EN信号为1时控制模拟比较器的负端N极增加，同时P极=0000保持不变，当N极=0001，模拟比较器的输出COMP_OUT是为1，流通的N管个数为1，数字计数器的输出会继续增加到0011，流通的N管个数为2，当模拟比较器的输出没有变化，数字计数器的输出会继续增加到0111，流通的N管个数为3，数字计数器的输出会继续增加到1111，流通的N管个数为4，直到模拟比较器的输出COMP_OUT发生翻转，即出现从1到0的下降沿，此时数字计数器停止计数，数字计数器的值会被锁存器锁存起来，暂时控制模拟比较器的N极增加，校正的过程中P极一直是0000，当然可能在数字计数器的输出增加到0111时，模拟比较器的输出CALIB_DONE实现了翻转，即出现从1到0的下降沿。
说明书desc
技术领域本发明涉及模拟比较器失配校正技术领域，具体为一种在模拟比较器中校正差分失配的数字校正装置和方法。背景技术随着对时钟信号速度的需求越来越快，我们需要占空比检测和校正电路来不断的检测和调整占空比。在占空比检测电路的设计中使用了模拟比较器，模拟比较器是一种电路设备，用于比较两个模拟电压信号，并输出一个数字信号表示哪个电压较大。这种电路通常用于模拟信号处理中，例如在模拟数字转换器前的电压检测和信号处理中，理想情况下，可以检测出占空比误差很低。但是还存在如下不足：在模拟电路中，真实的电路中存在输入对管的失配和电流镜的失配，从而导致比较器存在固定的失配，现有技术中，目前降低失配的方式主要是通过增加输入对的面积，但增加输入对的面积的方式只是减小正负失配，还是无法区分和有效的消除失配对比较器的影响，从而导致占空比检测电路由于模拟比较器自身的失配导致的检测的精度下降的问题。发明内容本发明的目的在于提供一种在模拟比较器中校正差分失配的数字校正装置和方法，以解决上述背景技术中提出的问题。为实现上述目的，本发明提供如下技术方案：一种在模拟比较器中校正差分失配的数字校正装置，包括：模拟电路，所述模拟电路包括模拟比较器，所述模拟比较器的P输入端和INPUT输入端口连接，所述模拟比较器的N输入端和参考电压端口连接，所述P输入端和INPUT输入端口的连接线上设置有SW0开关，所述P输入端和N输入端连接线上设置有SW1开关；数字电路，所述数字电路包括数字计数器和检测器，所述数字计数器和所述模拟比较器电性连接，用于接收所述模拟比较器的输出信号COMP_OUT，所述输出信号COMP_OUT用于控制所述数字计数器输出EN信号，所述EN信号用于控制数字计数器输出的OFFSET＜3:0＞二进制数逐一增加，当所述模拟比较器的输出产生从0到1的上升沿信号或从1到0的下降沿信号，所述检测器输出CALIB_DONE到所述模拟比较器，所述数字计数器停止计数；所述模拟比较器包括多路P管、多路N管和锁存器，所述多路P管和多路P开关一一连接，所述多路N管和多路N开关一一连接，所述锁存器的输出端OUTP和所述P输入端级联，所述锁存器的输出端OUTN和所述N输入端级联，所述锁存器，用于暂时锁存所述数字计数器输出的OFFSET＜3:0＞二进制数。进一步地，所述模拟比较器的P输入端和N输入端始终保持短接，使SW0=0，SW1=1。进一步地，所述EN为0时，所述模拟比较器不工作，所述EN为1时，所述模拟比较器工作。进一步地，所述OFFSET＜3:0＞分为P＜3:0＞和N＜3:0＞，设置P＜3:0＞=0000,为负失配，N＜3:0＞=0000，为正失配。进一步地，所述数字计数器为定时触发电路、锁存电路和计数电路搭建的数字逻辑电路。进一步地，所述检测器为锁存电路和计数电路搭建的数字逻辑电路。进一步地，所述多路P开关均为N-MOS管，所述多路P开关包括P＜X＞开关，所述多路N开关均为N-MOS管，所述多路N开关包括N＜X＞开关，所述P＜X＞开关和N＜X＞开关中的X的取值均为0到3。一种在模拟比较器中校正差分失配的数字校正方法，所述在模拟比较器中校正差分失配的数字校正方法基于上述任意一项所述的一种在模拟比较器中校正差分失配的数字校正装置，该方法包括如下步骤：S1.将SW0打开，SW1闭合，使模拟比较器的两个输入端短接，均为参考电压，初始状态时，设置P＜3:0＞=0000,N＜3:0＞=0000；S2-1初始时，模拟比较器输出是0，会把模拟比较器的输出COMP_OUT传递到数字计数器，控制数字计数器的增加，调整P＜X＞开关开启的数目，数字计数器输出向着P＜X＞=0000==》0001==》0011==》0111==》1111的方向进行，当数字计数器输出的EN信号控制模拟比较器正端的P＜3:0＞增加，使P＜3:0＞=0001，模拟比较器的输出COMP_OUT是0，流通的N管个数为1，数字计数器输出会继续增加到0011，当模拟比较器的输出没有变化，流通的N管个数为2，数字计数器输出会继续增加到0111，流通的N管个数为3，数字计数器输出会继续增加到1111，流通的N管个数为4，直到模拟比较器的输出COMP_OUT发生翻转，此时数字计数器停止计数，计数器的值会被锁存器锁存起来，暂时控制模拟比较器的P＜3:0＞增加，校正的过程中N＜3:0＞一直是0000，当然可能在数字计数器的输出增加到0111时，模拟比较器的输出CALIB_DONE实现了翻转；S2-2.初始时，模拟比较器的输出是1，将模拟比较器的输出COMP_OUT传递到数字计数器，控制数字计数器的输出的增加，调整N＜X＞开关开启的数目，数字计数器输出向着N＜X＞=0000==》0001==》0011==》0111==》1111的方向进行，当数字计数器输出的EN信号控制模拟比较器的负端N＜3:0＞增加，同时P＜3:0＞=0000保持不变，当N＜3:0＞=0001，如果模拟比较器的输出COMP_OUT是为1，流通的N管个数为1，数字计数器的输出会继续增加到0011，流通的N管个数为2，当模拟比较器的输出没有变化，数字计数器的输出会继续增加到0111，流通的N管个数为3，数字计数器的输出会继续增加到1111，流通的N管个数为4，直到模拟比较器的输出COMP_OUT发生翻转，此时数字计数器停止计数，数字计数器的值会被锁存器锁存起来，暂时控制模拟比较器的N＜3:0＞增加，校正的过程中P＜3:0＞一直是0000，当然可能在数字计数器的输出增加到0111时，模拟比较器的输出CALIB_DONE实现了翻转。与现有技术相比，本发明的有益效果是：本发明通过将模拟比较器的P输入端和INPUT输入端口连接，模拟比较器的N输入端和参考电压端口连接，在P输入端和INPUT输入端口的连接线上设置SW0开关，在P输入端和N输入端连接线上设置SW1开关，将数字计数器和模拟比较器电性连接，将多路P管和多路P开关一一连接，多路N管和多路N开关一一连接，锁存器的输出端OUTP和P输入端级联，锁存器的输出端OUTN和N输入端级联，利用模拟比较器和数字计数器、检测器、锁存器的电性连接，当模拟比较器的输出COMP_OUT为从0到1的上升沿信号或从1到0的下降沿信号，数字计数器停止计数，随后检测器发送一个上升沿信号，表示CALIB_DONE。因此可以区分和有效的消除输入对管失配和电流镜失配对比较器的影响，从而提高占空比检测电路的检测精度，减少模拟比较器由于输入对管的失配和电流镜的失配对其的影响。附图说明图1为本发明模拟比较器失配校正结构图；图2为本发明带模拟比较器电路图；图3为本发明模拟比较器校正的流程图；图4为本发明模拟比较器校正的失配为负的波形图；图5为本发明模拟比较器校正的失配为正的波形图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例：请参阅图1至图5，本发明提供一种技术方案：一种在模拟比较器中校正差分失配的数字校正装置，如图1和图2所示，包括：模拟电路，所述模拟电路包括模拟比较器，所述模拟比较器的P输入端和INPUT输入端口连接，所述模拟比较器的N输入端和参考电压端口连接，所述P输入端和INPUT输入端口的连接线上设置有SW0开关，所述P输入端和N输入端连接线上设置有SW1开关；数字电路，所述数字电路包括数字计数器和检测器，所述数字计数器和所述模拟比较器电性连接，用于接收所述模拟比较器的输出信号COMP_OUT，所述输出信号COMP_OUT用于控制所述数字计数器输出EN信号，所述EN信号用于控制数字计数器输出的OFFSET＜3:0＞二进制数逐一增加，当所述模拟比较器的输出产生从0到1的上升沿信号或从1到0的下降沿信号，所述检测器输出CALIB_DONE到所述模拟比较器，所述数字计数器停止计数；所述模拟比较器包括多路P管、多路N管和锁存器，所述多路P管和多路P开关一一连接，所述多路N管和多路N开关一一连接，所述锁存器的输出端OUTP和所述P输入端级联，所述锁存器的输出端OUTN和所述N输入端级联，所述锁存器，用于暂时锁存所述数字计数器输出的OFFSET＜3:0＞二进制数。在上述实施例的基础上，如图1所示，所述模拟比较器的P输入端和N输入端始终保持短接，使SW0=0，SW1=1。在上述实施例的基础上，如图2所示，所述EN为0时，所述模拟比较器不工作，所述EN为1时，所述模拟比较器工作。在上述实施例的基础上，所述数字计数器为定时触发电路、锁存电路和计数电路搭建的数字逻辑电路，所述数字计数器的计数过程：数字计数器在初始状态下，通常将计数值清零或预设为一个初始值，比如这里将数字计数器输出初始值设为0000，当外部触发信号到达时，数字计数器开始工作，在每个输入时钟信号的边沿到达时，数字计数器的计数值增加，计数器可以是递增或递减，数字计数器将当前计数值输出到相应的输出端口，输出可以是二进制数，当模拟比较器的输出CALIB_DONE发生翻转，此时数字计数器停止计数，计数器的值会被锁存器锁存起来。定时触发电路、锁存电路和计数电路均为现有技术，因此定时触发电路、锁存电路和计数电路搭建的数字逻辑电路为现有技术。在上述实施例的基础上，所述检测器为锁存电路和计数电路搭建的数字逻辑电路，所述检测器的检测过程：检测器首先监测模拟比较器的输出信号CALIB_DONE，这个输出信号CALIB_DONE通常是一个连续的模拟信号，在某个时刻产生上升沿或下降沿，检测器会检测模拟比较器输出信号的变化，特别是从0到1的上升沿或从1到0的下降沿，一旦检测到上升沿或下降沿，检测器会生成CALIB_DONE，CALIB_DONE是一个脉冲或持续的信号，生成的CALIB_DONE被发送到模拟比较器，通常通过电性连接。这个信号的作用是停止数字计数器的计数，计数器的值会被锁存器锁存起来，通过使能信号的控制实现，在接收到CALIB_DONE后，数字计数器停止计数，完成一个计数周期。锁存电路和计数电路均为现有技术，因此锁存电路和计数电路搭建的数字逻辑电路为现有技术。在上述实施例的基础上，如图4和图5所示，所述OFFSET＜3:0＞分为P＜3:0＞和N＜3:0＞，设置P＜3:0＞=0000,为负失配，N＜3:0＞=0000，为正失配。在上述实施例的基础上，如图2所示，所述多路P开关均为N-MOS管，所述多路P开关包括P＜X＞开关，所述多路N开关均为N-MOS管，所述多路N开关包括N＜X＞开关，所述P＜X＞开关和N＜X＞开关中的X的取值均为0到3，其中P＜X＞开关包括P＜3＞开关、P＜2＞开关、P＜1＞开关和P＜0＞开关，N＜X＞开关包括N＜3＞开关、N＜2＞开关、N＜1＞开关和N＜0＞开关。一种在模拟比较器中校正差分失配的数字校正方法，所述在模拟比较器中校正差分失配的数字校正方法基于上述任意一项所述的一种在模拟比较器中校正差分失配的数字校正装置，该方法包括如下步骤：S1.如图1和图4以及图5所示，将SW0打开，SW1闭合，使模拟比较器的两个输入端短接，均为参考电压，初始状态时，设置P＜3:0＞=0000,为负失配，N＜3:0＞=0000，为正失配；S2-1.如图3和图4所示，如果初始时，模拟比较器输出是0，会把模拟比较器的输出CALIB_DONE传递到数字计数器，控制数字计数器的增加，调整P＜X＞开关开启的数目，数字计数器输出向着P＜X＞=0000==》0001==》0011==》0111==》1111的方向进行，比如当数字计数器输出的EN信号控制模拟比较器正端的P＜3:0＞增加，使P＜3:0＞=0001，如果模拟比较器的输出CALIB_DONE是0，流通的N管个数为1，数字计数器输出会继续增加到0011，如果比较器的输出没有变化，流通的N管个数为2，数字计数器输出会继续增加到0111，流通的N管个数为3，数字计数器输出会继续增加到1111，流通的N管个数为4，直到模拟比较器的输出CALIB_DONE发生翻转，此时数字计数器停止计数，计数器的值会被锁存器锁存起来，暂时控制模拟比较器的P＜3:0＞增加，校正的过程中N＜3:0＞一直是0000，当然可能在数字计数器的输出增加到0111时，模拟比较器的输出CALIB_DONE实现了翻转；如图4表示模拟比较器先输出从0到1的上升沿信号，此时数字计数器停止计数，随后检测器发送一个上升沿信号，表示校正完成，从图中可知模拟比较器的输出信号COMP_OUT和CALIB_DONE有一个时间差。S2-2.如图3和图5所示，如果初始时，模拟比较器的输出CALIB_DONE是1，将模拟比较器的输出CALIB_DONE传递到数字计数器，控制数字计数器的输出的增加，调整N＜X＞开关开启的数目，数字计数器输出向着N＜X＞=0000==》0001==》0011==》0111==》1111的方向进行，比如当数字计数器输出的EN信号控制模拟比较器的负端N＜3:0＞增加，同时P＜3:0＞=0000保持不变，当N＜3:0＞=0001，如果模拟比较器的输出CALIB_DONE是为1，流通的N管个数为1，数字计数器的输出会继续增加到0011，流通的N管个数为2，如果模拟比较器的输出没有变化，数字计数器的输出会继续增加到0111，流通的N管个数为3，数字计数器的输出会继续增加到1111，流通的N管个数为4，直到模拟比较器的输出发生翻转，此时数字计数器停止计数，数字计数器的值会被锁存起来，暂时控制模拟比较器的N＜3:0＞增加，校正的过程中P＜3:0＞一直是0000，当然可能在数字计数器的输出增加到0111时，模拟比较器的输出CALIB_DONE实现了翻转。如图5表示模拟比较器先输出从1到0的下降沿信号，此时数字计数器停止计数，随后检测器发送一个上升沿信号，表示校正完成，从图中可知模拟比较器的输出信号COMP_OUT和CALIB_DONE有一个时间差。尽管已经示出和描述了本发明的实施例，对于本领域的普通技术人员而言，可以理解在不脱离本发明的原理和精神的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由所附权利要求及其等同物限定。
