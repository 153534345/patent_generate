标题title
直播方法和可读存储介质
摘要abst
本发明公开了一种直播方法和可读存储介质。其中，所述直播方法包括：在不同的摄录设备上增加封装NTP时间码到输出网络数据包；时码同步设备接收不同摄录设备发送的封装了NTP时间码的网络数据包；所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点；将对齐直播时间起点的直播内容输出给切换台。本发明减少各个直播机位时延不一致的情况，提高直播节目的同步效果。
权利要求书clms
1.一种直播方法，其特征在于，所述直播方法包括：时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包；所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点；将对齐直播时间起点的直播内容输出给切换台。2.如权利要求1所述的直播方法，其特征在于，所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点的步骤，包括：获取网络数据包并保存；提取所述网络数据包中的NTP时间码，并依据时间顺序对所述NTP时间码持续计数；若不同的所述网络数据包中包括相同的NTP时间码，则从该相同NTP时间码位置对齐直播时间点。3.如权利要求2所述的直播方法，其特征在于，所述从相同NTP时间码位置对齐直播时间点的步骤中，所述NTP时间码是连续的且连续数量大于等于3。4.如权利要求2或3所述的直播方法，其特征在于，所述将对齐直播时间起点的直播内容输出给切换台的步骤之前，包括：释放所述时码同步设备保存的网络数据包。5.一种直播方法，其特征在于，所述直播方法包括：不同摄录设备获取NTP时间码；所述摄录设备将带有所述NTP时间码的网络数据包发送给时码同步设备，其中，所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点，并将对齐直播时间起点的直播内容输出给切换台。6.如权利要求5所述的直播方法，其特征在于，所述不同摄录设备获取NTP时间码的步骤之后，包括：将所述摄录设备的摄录内容和所述NTP时间码进行封装；生成网络数据包并保存。7.如权利要求5或6所述的直播方法，其特征在于，所述不同摄录设备获取NTP时间码的步骤之前，包括：所述摄录设备获取运营基站的NTP授时。8.一种直播方法，其特征在于，所述直播方法包括：切换台接收时码同步设备发送的直播内容，其中，所述时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包，所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点，将对齐直播时间起点的直播内容输出给切换台；所述切换台依据所述直播内容进行直播切换。9.一种直播方法，其特征在于，所述直播方法包括：不同摄录设备获取NTP时间码；所述摄录设备将所述带有NTP时间码的网络数据包发送给时码同步设备；所述时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包；所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点；所述时码同步设备将对齐直播时间起点的直播内容输出给切换台；所述切换台接收时码同步设备发送的直播内容；所述切换台依据所述直播内容进行直播切换。10.一种可读存储介质，其特征在于，所述可读存储介质上存储有直播程序，所述直播程序被处理器执行时实现如权利要求1至9中任一项所述的直播方法的步骤。
说明书desc
技术领域本发明涉及互联网直播技术领域，尤其涉及一种直播方法和可读存储介质。背景技术随着移动互联网的发展，以及传统媒体向融合媒体转型，传统的电视、电台直播也开始连接互联网，来自流媒体设备的互联网内容和互联网直播成为新媒体时代越来越重要的核心功能。目前主流的互联网直播场景中，通常使用手机、4G/5G背包或民用级摄像机以及互联网传输设备等工具。通过普通的互联网接入和链路来进行流信号的传输，完成直播和实时的互动连线。但是在多机位直播或互动连线的场景下, 由于互联网带宽，延迟等方面的条件限制，经常会出现各个机位时延不一致的情况，影响直播节目效果。发明内容基于此，针对目前互联网直播经常会出现各个机位时延不一致的情况，影响直播节目效果的问题，有必要提供一种直播方法和可读存储介质，旨在减少各个机位时延不一致的情况，提高直播节目的同步效果。为实现上述目的，本发明提出的一种直播方法，所述直播方法包括：时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包；所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点；将对齐直播时间起点的直播内容输出给切换台。在本申请的一实施例中，所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点的步骤，包括：获取网络数据包并保存；提取所述网络数据包中的NTP时间码，并依据时间顺序对所述NTP时间码持续计数；若不同的所述网络数据包中包括相同的NTP时间码，则从该相同NTP时间码位置对齐直播时间点。在本申请的一实施例中，所述从相同NTP时间码位置对齐直播时间点的步骤中，所述NTP时间码是连续的且连续数量大于等于3。在本申请的一实施例中，所述将对齐直播时间起点的直播内容输出给切换台的步骤之前，包括：释放所述时码同步设备保存的网络数据包。此外，为了实现上述目的，本发明还提供一种直播方法，所述直播方法包括：不同摄录设备获取NTP时间码；所述摄录设备将带有所述NTP时间码的网络数据包发送给时码同步设备，其中，所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点，并将对齐直播时间起点的直播内容输出给切换台。在本申请的一实施例中，所述不同摄录设备获取NTP时间码的步骤之后，包括：将所述摄录设备的摄录内容和所述NTP时间码进行封装；生成网络数据包并保存。在本申请的一实施例中，所述不同摄录设备获取NTP时间码的步骤之前，包括：所述摄录设备获取运营基站的NTP授时。此外，为了实现上述目的，本发明还提供一种直播方法，所述直播方法包括：切换台接收时码同步设备发送的直播内容，其中，所述时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包，所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点，将对齐直播时间起点的直播内容输出给切换台；所述切换台依据所述直播内容进行直播切换。此外，为了实现上述目的，本发明还提供一种直播方法，所述直播方法包括：不同摄录设备获取NTP时间码；所述摄录设备将带有所述NTP时间码的网络数据包发送给时码同步设备；所述时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包；所述时码同步设备基于所述NTP时间码对齐所述摄录设备的直播时间起点；所述时码同步设备将对齐直播时间起点的直播内容输出给切换台；所述切换台接收时码同步设备发送的直播内容；所述切换台依据所述直播内容进行直播切换。此外，为了实现上述目的，本发明还提供一种可读存储介质，所述可读存储介质上存储有直播程序，所述直播程序被处理器执行时实现如上所述的直播方法的步骤。本发明提出的技术方案中，摄录设备可以理解为直播时使用的直播工具。不同摄录设备均将带有NTP时间码的信号传输给时码同步设备。时码同步设备接收摄录设备发送的NTP时间码，时码同步设备通过NTP时间码对齐摄录设备的直播时间起点。将直播内容的直播起点统一，再将对齐直播时间起点的直播内容输出给切换台，通过切换台进行直播切换。由此，通过本发明的技术方案，保证不同摄录设备能够同步播放时间，减少各个机位时延不一致的情况，提高直播节目的同步效果。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图示出的结构获得其他的附图。图1为本发明直播方法第一实施例的流程示意图；图2为本发明直播方法第二实施例的流程示意图；图3为本发明直播方法第三实施例的流程示意图；图4为本发明直播方法第四实施例的流程示意图；图5为本发明直播方法第五实施例的流程示意图；图6为本发明直播方法第六实施例的流程示意图；图7为本发明直播方法第七实施例的流程示意图；图8为本发明直播方法第八实施例的流程示意图；图9为本发明直播方法的原理示意图。本发明目的的实现、功能特点及优点将结合实施例，参照附图做进一步说明。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。随着移动互联网的发展，以及传统媒体向融合媒体转型，传统的电视、电台直播也开始连接互联网，来自流媒体设备的互联网内容和互联网直播成为新媒体时代越来越重要的核心功能。目前主流的互联网直播场景中，通常使用手机、4G/5G背包或民用级摄像机以及互联网传输设备等工具。通过普通的互联网接入和链路来进行流信号的传输，完成直播和实时的互动连线。但是在多机位直播或互动连线的场景下, 由于互联网带宽，延迟等方面的条件限制，经常会出现各个机位时延不一致的情况，影响直播节目效果。参阅图1和图9所示，本发明提出的一种直播方法的第一实施例。本实施例中，摄录设备理解为直播工具，例如摄录设备包括手机，平板电脑，摄像机等。具体地直播方法包括：步骤S10，时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包；NTP时间码是一种通过因特网服务于计算机时钟的时间同步协议。NTP提供了一种同步时间机制，能在庞大而复杂多样的因特网中用光速调整时间分配。它使用的是可返回时间设计，分布式子网内的时间服务器，能自我组织操作、分层管理配置，经过有线或无线方式同步子网内的逻辑时钟达到国家标准时间。此外，通过本地路由选择运算法则及时间后台程序，服务器可以重新分配标准时间。NTP时间码封装在直播内容中。不同的摄录设备都将带有NTP时间码的数据发送给时码同步设备，时码同步设备集中处理接收到的网络数据。步骤S11，时码同步设备基于NTP时间码对齐摄录设备的直播时间起点；通过时码同步设备，将接收到的网络数据中的直播时间点对齐，从而在直播时，不同摄录设备的播放时间可以同步进行, 减少因网络延迟导致的各个信号不同步。步骤S12，将对齐直播时间起点的直播内容输出给切换台。对齐了直播时间起点后，将直播内容输出给切换台。切换台在对齐后的信号上进行切换, 可确保直播节目的制作效果。 例如，通过NTP时间码显示，手机的直播播放时间起点是102，摄像机的时间起点也是102，麦克风的时间起点也是102，则在直播时手机、摄像机和麦克风的时间起点都对齐至102，从102这个时间点开始同步传输数据，进而保证直播播放的时间同步。不会出现画面和语音不同步的情况。由此可知本方案提供了一种时码同步设备，通过时码同步设备集中接收网络数据，并完成直播内容的同步播放。本实施例提出的技术方案中，摄录设备可以理解为直播时使用的直播工具。不同摄录设备均将带有NTP时间码的信号传输给时码同步设备。时码同步设备接收摄录设备发送的NTP时间码，时码同步设备通过NTP时间码对齐摄录设备的直播时间起点。将直播内容的直播起点统一，再将对齐直播时间起点的直播内容输出给切换台，通过切换台进行直播切换。由此，通过本发明的技术方案，保证不同摄录设备能够同步播放时间，减少各个机位时延不一致的情况，提高直播节目的同步效果。参阅图2所示，在本发明第一实施例的基础上，提出本发明的第二实施例。时码同步设备基于NTP时间码对齐摄录设备的直播时间起点的步骤，包括：步骤S110，获取网络数据包并保存；其中，网络数据包中包括NTP时间码。将NTP时间码和网络数据包中的对应内容建立对应关系，相应的NTP时间码代表相应的直播内容。通过确定NTP时间码，就代表了确定直播内容。将获取的网络数据包保存在时码同步设备的缓存区。步骤S111，提取网络数据包中的NTP时间码，并依据时间顺序对NTP时间码持续计数；在直播时，从时码同步设备的缓存区提取出NTP时间码。并按照时间的数据开始对提取的NTP时间码进行监测计数。步骤S112，若不同的网络数据包中包括相同的NTP时间码，则从该相同NTP时间码位置对齐直播时间点。监测到相同的NTP时间码后，说明不同的网络数据包是同时摄录的，说明从这个相同的NTP时间码开始直播内容是同步的，从这个相同的NTP时间码位置开始对比直播时间点。 需要说明的是一帧代表一个画面，一个网络数据包中的视音频信号通常包括多帧。相邻数据包的NTP不一定是连续的。通过计数来确定包内各帧的时码能够保证视音频顺序播放。进一步地，为了提高网络数据具有更高的连续性，从相同NTP时间码位置对齐直播时间点的步骤中，NTP时间码是连续的且连续数量大于等于3。也就是说，具有3个相同的NTP时间码，且这3个相同的NTP时间码都是连续的。例如，手机、摄像机和麦克风都具有3个相同的NTP时间码，分别是102、103和104，这3个NTP时间码是依次连续的。NTP时间码的连续，也表示直播视频内容的连续。参阅图3所示，在本发明第一实施例的基础上，提出本发明的第三实施例。为了充分利用时码同步设备的缓存区。将对齐直播时间起点的直播内容输出给切换台的步骤之前，包括：步骤S13，释放时码同步设备保存的网络数据包。直播时数据的传输量往往很大，时码同步设备的缓存区存储空间有限。在直播内容已经输出给切换台后，在时码同步设备的缓存区的网络数据包已经不需要再次传输。通过步骤S13，将时码同步设备保存的网络数据包释放掉，从而节约存储空间。释放掉，也可以理解为将网络数据包丢弃掉。参阅图4和图9所示，本发明还提供一种直播方法的第四实施例。本实施例中在不同摄录设备端也做了进一步的改进。具体地，直播方法包括：步骤S20，不同摄录设备获取NTP时间码；摄录设备理解为直播工具，例如摄录设备包括手机，平板电脑，摄像机等。在摄录设备中设置SDK，通过软件开发工具包来获取NTP时间码。SDK软件开发工具包也可以设置在独立的外接处理装置中，如此，摄录设备直接接收带有NTP时间码的网络数据包。步骤S21，摄录设备将带有NTP时间码的网络数据包发送给时码同步设备，其中，时码同步设备基于NTP时间码对齐摄录设备的直播时间起点，并将对齐直播时间起点的直播内容输出给切换台。通过时码同步设备，将接收到的网络数据中的直播时间点对齐，从而在直播时，不同摄录设备的播放时间可以同步进行。减少播放的延迟产生，提高播放效果。例如，通过NTP时间码显示，手机的直播播放时间起点是102，摄像机的时间起点也是102，麦克风的时间起点也是102，则在直播时手机、摄像机和麦克风的时间起点都对齐至102，从102这个时间点开始同步传输数据，进而保证直播播放的时间同步。不会出现画面和语音不同步的情况。对齐了直播时间起点后，将直播内容输出给切换台。切换台用于将播放直播内容，也可以用于中间转接保存的云平台。由此可知本方案提供了一种时码同步设备，通过时码同步设备集中接收网络数据，并完成直播内容的同步播放。参阅图5所示，为了保证NTP时间码能够准确的代表相应的直播内容。在本发明第四实施例的基础上，提出本发明的第五实施例。不同摄录设备获取NTP时间码的步骤之后，包括：步骤S22，将摄录设备的摄录内容和NTP时间码进行封装；由此NTP时间码就可以代表相应的摄录内容，即代表直播内容。步骤S23，生成网络数据包并保存。以将网络数据包发送给时码同步设备。将摄录内容和NTP时间码封装在一起，形成一个网络数据包。通过网络数据包进行数据传输，同时完成数据传递，由此可以节约数据分开传递的时间。参阅图6所示，为了能够顺利的获取NTP时间码。在本发明第四实施例的基础上，提出本发明的第六实施例。不同摄录设备获取NTP时间码的步骤之前，包括：步骤S24，摄录设备获取运营基站的NTP授时。通过SDK软件工具包获取网络运营基站的NTP授时，通过NTP授时后，摄录设备可以从网络运营基站获取NTP时间码。进一步地，还能够保证时间码来源的一致性，便于时间标准的统一。参阅图7所示，本发明还提供一种直播方法的第七实施例。为了使切换台能够同步直播视频内容。直播方法包括：步骤S30，切换台接收时码同步设备发送的直播内容，其中，时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包，时码同步设备基于NTP时间码对齐摄录设备的直播时间起点，将对齐直播时间起点的直播内容输出给切换台；通过时码同步设备，将接收到的网络数据中的直播时间点对齐，从而在直播时，不同摄录设备的播放时间可以同步进行。减少播放的延迟产生，提高播放效果。例如，通过NTP时间码显示，手机的直播播放时间起点是102，摄像机的时间起点也是102，麦克风的时间起点也是102，则在直播时手机、摄像机和麦克风的时间起点都对齐至102，从102这个时间点开始同步传输数据，进而保证直播播放的时间同步。不会出现画面和语音不同步的情况。对齐了直播时间起点后，将直播内容输出给切换台。切换台用于将播放直播内容，也可以用于中间转接保存的云平台。由此可知本方案提供了一种时码同步设备，通过时码同步设备集中接收网络数据，并完成直播内容的同步播放。步骤S31，切换台依据直播内容进行直播切换。其中，切换台可以理解为直播内容的中转站，可以理解为直接面向用户的显示终端，例如电脑或是智能手机。参阅图8所示，本发明还提供一种直播方法的第八实施例。直播方法包括：步骤S1，不同摄录设备获取NTP时间码；摄录设备理解为直播工具，例如摄录设备包括手机，平板电脑，摄像机等。在摄录设备中设置SDK，通过软件开发工具包来获取NTP时间码。SDK软件开发工具包也可以设置在独立的外接处理装置中，如此，摄录设备直接接收带有NTP时间码的网络数据包。步骤S2，摄录设备将带有NTP时间码的网络数据包发送给时码同步设备；此时可以将摄录内容和NTP时间码封装在一起，形成一个网络数据包。通过网络数据包进行数据传输，同时完成数据传递，由此可以节约数据分开传递的时间。步骤S3，时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包；NTP时间码封装在网络数据中。不同的摄录设备都将带有NTP时间码的数据发送给时码同步设备，时码同步设备集中处理接收到的网络数据。时码同步设备将网络数据保存在缓存区。步骤S4，时码同步设备基于NTP时间码对齐摄录设备的直播时间起点；通过时码同步设备，将接收到的网络数据中的直播时间点对齐，从而在直播时，不同摄录设备的播放时间可以同步进行。减少播放的延迟产生，提高播放效果。例如，通过NTP时间码显示，手机的直播播放时间起点是102，摄像机的时间起点也是102，麦克风的时间起点也是102，则在直播时手机、摄像机和麦克风的时间起点都对齐至102，从102这个时间点开始同步传输数据，进而保证直播播放的时间同步。不会出现画面和语音不同步的情况。步骤S5，时码同步设备将对齐直播时间起点的直播内容输出给切换台；对齐了直播时间起点后，将直播内容输出给切换台。切换台用于将播放直播内容，也可以用于中间转接保存的云平台。由此可知本方案提供了一种时码同步设备，通过时码同步设备集中接收网络数据，并完成直播内容的同步播放。步骤S6，切换台接收时码同步设备发送的直播内容；其中，切换台可以理解为直播内容的中转站，可以理解为直接面向用户的显示终端，例如电脑或是智能手机。步骤S7，切换台依据直播内容进行直播切换。切换台可以完成直播内容的播放，或者完成直播内容的切换。本发明还提供一种可读存储介质，可读存储介质上存储有直播程序，直播程序被处理器执行时实现如上的直播方法的步骤。处理器调取可读存储介质中的直播程序时，执行以下步骤：时码同步设备接收不同摄录设备发送的带有NTP时间码的网络数据包；NTP时间码是一种通过因特网服务于计算机时钟的时间同步协议。NTP提供了一种同步时间机制，能在庞大而复杂多样的因特网中用光速调整时间分配。它使用的是可返回时间设计，分布式子网内的时间服务器，能自我组织操作、分层管理配置，经过有线或无线方式同步子网内的逻辑时钟达到国家标准时间。此外，通过本地路由选择运算法则及时间后台程序，服务器可以重新分配标准时间。NTP时间码封装在直播内容中。不同的摄录设备都将带有NTP时间码的数据发送给时码同步设备，时码同步设备集中处理接收到的网络数据。时码同步设备基于NTP时间码对齐摄录设备的直播时间起点；通过时码同步设备，将接收到的网络数据中的直播时间点对齐，从而在直播时，不同摄录设备的播放时间可以同步进行。减少播放的延迟产生，提高播放效果。例如，通过NTP时间码显示，手机的直播播放时间起点是102，摄像机的时间起点也是102，麦克风的时间起点也是102，则在直播时手机、摄像机和麦克风的时间起点都对齐至102，从102这个时间点开始同步传输数据，进而保证直播播放的时间同步。不会出现画面和语音不同步的情况。将对齐直播时间起点的直播内容输出给切换台。对齐了直播时间起点后，将直播内容输出给切换台。切换台用于将播放直播内容，也可以用于中间转接保存的云平台。由此可知本方案提供了一种时码同步设备，通过时码同步设备集中接收网络数据，并完成直播内容的同步播放。本发明可读存储介质具体实施方式可以参照上述直播方法其他实施例，在此不再赘述。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者系统不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者系统所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者系统中还存在另外的相同要素。上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在如上所述的一个存储介质中，包括若干指令用以使得一台终端设备执行本发明各个实施例所述的方法。以上仅为本发明的优选实施例，并非因此限制本发明的专利范围，凡是在本发明的发明构思下，利用本发明说明书及附图内容所作的等效结构变换，或直接/间接运用在其他相关的技术领域均包括在本发明的专利保护范围内。
