标题title
智能进化物联网设备的威胁建模方法和装置
摘要abst
本申请提供了智能进化物联网设备的威胁建模方法和装置。在本实施例中，在进行威胁建模时，借助于语义增强模型智能化地从要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施，以及借助于语义增强模型，智能化地从安全风险级别高于设定级别的要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径，其避免现有通过人工方式查找缓解措施库、攻击路径库，实现智能化地进化物联网设备的威胁建模方法，避免通过人工方式进行威胁建模所带来的诸如成本高、效率低等问题。
权利要求书clms
1.一种智能进化物联网设备的威胁建模方法，其特征在于，该方法应用于电子设备，包括：确定与物联网设备相匹配的威胁建模数据流图；所述威胁建模数据流图是以图形形式描述数据流从进入所述物联网设备到所述物联网设备输出的变换过程，所述变换过程涉及到多个不同要素；针对所述威胁建模数据流图中每一被指定的要素，利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施；利用该要素匹配的至少一个参考缓解措施，确定该要素相匹配的安全风险级别；针对安全风险级别高于设定级别的每一要素，利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径；基于物联网设备被应用的业务场景，并结合威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施生成威胁建模文档库；威胁建模文档库包括各要素匹配的目标缓解措施以及各要素匹配的目标攻击路径；其中，在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库以使缓解措施库中新增该要素匹配的目标缓解措施；以及，在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库以使攻击路径库中新增该要素匹配的目标攻击路径。2.根据权利要求1所述的方法，其特征在于，所述变换过程涉及到的各个要素包括：与所述物联网设备进行通信的外部实体、数据流、所述物联网设备被配置的对数据流进行处理的处理操作、与所述物联网设备相关联的指定存储介质、信任边界；其中，所述信任边界是基于所述物联网设备的设备架构并结合威胁识别STRIDE模型对应的威胁划分的，所述设备架构描述了所述物联网设备中的软件逻辑和硬件结构；所述STRIDE模型对应以下六类威胁：仿冒Spoofing、篡改Tampering、抵赖Repudiation、信息泄露Information Disclosure、拒绝服务Denial of Service、权限提升Elevation ofPrivilege；所述威胁建模数据流图中被指定的要素包括除所述信任边界之外的要素。3.根据权利要求1所述的方法，其特征在于，任一缓解措施库中的缓解措施通过对应的语义信息表征；所述利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施包括：针对所述威胁建模数据流图中每一被指定的要素，利用深度学习训练出的第一语义增强模型，并结合该要素的特性，从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施。4.根据权利要求3所述的方法，其特征在于，所述从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施包括：从该要素匹配的缓解措施库中获得该特性匹配的且使用频率大于或等于第一设定频率阈值的至少一个参考缓解措施；或者，从该要素匹配的缓解措施库中获得该特性匹配的候选缓解措施；按照使用频率的大小对候选缓解措施进行排序，得到候选缓解措施序列；从所述候选缓解措施序列中选择至少一个参考缓解措施，被选择的任一参考缓解措施的使用频率大于或等于所述候选缓解措施序列中未被选择的其它候选缓解措施的使用频率。5.根据权利要求1所述的方法，其特征在于，任一攻击路径库中的攻击路径通过对应的语义信息表征；所述利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径包括：针对安全风险级别高于设定级别的每一要素，利用深度学习训练出的第二语义增强模型，并结合该要素的安全风险级别，从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径。6.根据权利要求5所述的方法，其特征在于，所述从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径包括：从该要素匹配的攻击路径库中获得该安全风险级别匹配的且使用频率大于或等于第二设定频率阈值的至少一个参考攻击路径；或者，从该要素匹配的攻击路径库中获得该安全风险级别匹配的候选攻击路径；按照使用频率的大小对候选攻击路径进行排序，得到候选攻击路径序列；从所述候选攻击路径序列中选择至少一个参考攻击路径，被选择的任一参考攻击路径的使用频率大于或等于所述候选攻击路径序列中未被选择的其它候选攻击路径的使用频率。7.根据权利要求1所述的方法，其特征在于，所述基于差分进化算法调整该要素匹配的缓解措施库包括：基于差分进化算法选择该要素匹配的满足第一条件的目标缓解措施，所述第一条件是指目标缓解措施与该要素匹配的参考缓解措施不满足第一设定相似要求且不存在于该要素匹配的缓解措施库中；将该选择出的目标缓解措施添加至该要素匹配的缓解措施库；和/或，基于差分进化算法确定出该要素匹配的缓解措施库中存在满足第一设定相似要求的至少两个缓解措施时，选择最优缓解措施继续记录在缓解措施库并从缓解措施库中删除非最优缓解措施；所述基于差分进化算法调整该要素匹配的攻击路径库包括：基于差分进化算法选择该要素匹配的满足第二要求的目标攻击路径，所述第二要求是指该目标攻击路径与该要素匹配的参考攻击路径不满足第二设定相似要求且不存在于该要素匹配的攻击路径库中；将该选择出的目标攻击路径添加至该要素匹配的攻击路径库；和/或，基于差分进化算法确定出该要素匹配的攻击路径库中存在满足第二设定相似要求的至少两个攻击路径时，选择最优攻击路径继续记录在攻击路径库并从该攻击路径库中删除非最优的攻击路径。8.一种智能进化物联网设备的威胁建模装置，其特征在于，该装置应用于电子设备，包括：确定单元，用于确定与物联网设备相匹配的威胁建模数据流图；所述威胁建模数据流图是以图形形式描述数据流从进入所述物联网设备到所述物联网设备输出的变换过程，所述变换过程涉及到多个不同要素；建模单元，用于针对所述威胁建模数据流图中每一被指定的要素，利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施；利用该要素匹配的至少一个参考缓解措施，确定该要素相匹配的安全风险级别；以及，针对安全风险级别高于设定级别的每一要素，利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径；以及，基于物联网设备被应用的业务场景，并结合威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施生成威胁建模文档库；威胁建模文档库包括各要素匹配的目标缓解措施以及各要素匹配的目标攻击路径；调整单元，用于在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库以使缓解措施库中新增该要素匹配的目标缓解措施；以及在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库以使攻击路径库中新增该要素匹配的目标攻击路径。9.根据权利要求8所述的装置，其特征在于，所述变换过程涉及到的各个要素包括：与所述物联网设备进行通信的外部实体、数据流、所述物联网设备被配置的对数据流进行处理的处理操作、与所述物联网设备相关联的指定存储介质、信任边界；其中，所述信任边界是基于所述物联网设备的设备架构并结合威胁识别STRIDE模型对应的威胁划分的，所述设备架构描述了所述物联网设备中的软件逻辑和硬件结构；所述STRIDE模型对应以下六类威胁：仿冒Spoofing、篡改Tampering、抵赖Repudiation、信息泄露Information Disclosure、拒绝服务Denial of Service、权限提升Elevation ofPrivilege；所述威胁建模数据流图中被指定的要素包括除所述信任边界之外的要素；任一缓解措施库中的缓解措施通过对应的语义信息表征；所述利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施包括：针对所述威胁建模数据流图中每一被指定的要素，利用深度学习训练出的第一语义增强模型，并结合该要素的特性，从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施；所述从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施包括：从该要素匹配的缓解措施库中获得该特性匹配的且使用频率大于或等于第一设定频率阈值的至少一个参考缓解措施；或者，从该要素匹配的缓解措施库中获得该特性匹配的候选缓解措施；按照使用频率的大小对候选缓解措施进行排序，得到候选缓解措施序列；从所述候选缓解措施序列中选择至少一个参考缓解措施，被选择的任一参考缓解措施的使用频率大于或等于所述候选缓解措施序列中未被选择的其它候选缓解措施的使用频率；任一攻击路径库中的攻击路径通过对应的语义信息表征；所述利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径包括：针对安全风险级别高于设定级别的每一要素，利用深度学习训练出的第二语义增强模型，并结合该要素的安全风险级别，从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径；所述从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径包括：从该要素匹配的攻击路径库中获得该安全风险级别匹配的且使用频率大于或等于第二设定频率阈值的至少一个参考攻击路径；或者，从该要素匹配的攻击路径库中获得该安全风险级别匹配的候选攻击路径；按照使用频率的大小对候选攻击路径进行排序，得到候选攻击路径序列；从所述候选攻击路径序列中选择至少一个参考攻击路径，被选择的任一参考攻击路径的使用频率大于或等于所述候选攻击路径序列中未被选择的其它候选攻击路径的使用频率；所述基于差分进化算法调整该要素匹配的缓解措施库包括：基于差分进化算法选择该要素匹配的满足第一条件的目标缓解措施，所述第一条件是指目标缓解措施与该要素匹配的参考缓解措施不满足第一设定相似要求且不存在于该要素匹配的缓解措施库中；将该选择出的目标缓解措施添加至该要素匹配的缓解措施库；和/或，基于差分进化算法确定出该要素匹配的缓解措施库中存在满足第一设定相似要求的至少两个缓解措施时，选择最优缓解措施继续记录在缓解措施库并从缓解措施库中删除非最优缓解措施；所述基于差分进化算法调整该要素匹配的攻击路径库包括：基于差分进化算法选择该要素匹配的满足第二要求的目标攻击路径，所述第二要求是指该目标攻击路径与该要素匹配的参考攻击路径不满足第二设定相似要求且不存在于该要素匹配的攻击路径库中；将该选择出的目标攻击路径添加至该要素匹配的攻击路径库；和/或，基于差分进化算法确定出该要素匹配的攻击路径库中存在满足第二设定相似要求的至少两个攻击路径时，选择最优攻击路径继续记录在攻击路径库并从该攻击路径库中删除非最优的攻击路径。10.一种电子设备，其特征在于，该电子设备包括：处理器和机器可读存储介质；所述机器可读存储介质存储有能够被所述处理器执行的机器可执行指令；所述处理器用于执行机器可执行指令，以实现权利要求1-7任一项的方法步骤。
说明书desc
技术领域本申请涉及物联网安全领域，特别涉及智能进化物联网设备的威胁建模方法和装置。背景技术在物联网中，所谓威胁建模，其是通过结构化的方式识别、量化物联网设备的安全威胁，并针对这些威胁采用对应的消减措施以消除上述威胁。目前，威胁建模主要依赖于缓解措施库和攻击路径库。缓解措施库记录了消减威胁的措施，攻击路径库记录威胁可能经由的路径，通过阻断攻击路径能够消减安全威胁。在物联网中，当威胁建模时常会基于上述缓解措施库并使用传统的人工方式确定缓解措施，以及，使用传统的人工方式从攻击路径库中确定攻击路径。但是，目前这种人工方式成本很高且效率比较低。发明内容本申请提供了智能进化物联网设备的威胁建模方法和装置，以实现智能化地进化物联网设备的威胁建模方法，避免通过人工方式进行威胁建模所带来的诸如成本高、效率低等问题。本申请提供的技术方案包括：一种智能进化物联网设备的威胁建模方法，该方法应用于电子设备，包括：确定与物联网设备相匹配的威胁建模数据流图；所述威胁建模数据流图是以图形形式描述数据流从进入所述物联网设备到所述物联网设备输出的变换过程，所述变换过程涉及到多个不同要素；针对所述威胁建模数据流图中每一被指定的要素，利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施；利用该要素匹配的至少一个参考缓解措施，确定该要素相匹配的安全风险级别；针对安全风险级别高于设定级别的每一要素，利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径；基于物联网设备被应用的业务场景，并结合威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施生成威胁建模文档库；威胁建模文档库包括各要素匹配的目标缓解措施以及各要素匹配的目标攻击路径；其中，在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库以使缓解措施库中新增该要素匹配的目标缓解措施；以及，在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库以使攻击路径库中新增该要素匹配的目标攻击路径。一种智能进化物联网设备的威胁建模装置，该装置应用于电子设备，包括：确定单元，用于确定与物联网设备相匹配的威胁建模数据流图；所述威胁建模数据流图是以图形形式描述数据流从进入所述物联网设备到所述物联网设备输出的变换过程，所述变换过程涉及到多个不同要素；建模单元，用于针对所述威胁建模数据流图中每一被指定的要素，利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施；利用该要素匹配的至少一个参考缓解措施，确定该要素相匹配的安全风险级别；以及，针对安全风险级别高于设定级别的每一要素，利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径；以及，基于物联网设备被应用的业务场景，并结合威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施生成威胁建模文档库；威胁建模文档库包括各要素匹配的目标缓解措施以及各要素匹配的目标攻击路径；调整单元，用于在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库以使缓解措施库中新增该要素匹配的目标缓解措施；以及，在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库以使攻击路径库中新增该要素匹配的目标攻击路径。一种电子设备，该电子设备包括：处理器和机器可读存储介质；所述机器可读存储介质存储有能够被所述处理器执行的机器可执行指令；所述处理器用于执行机器可执行指令，以实现如上方法中的步骤。由以上技术方案可以看出，在本实施例中，在进行威胁建模时，借助于语义增强模型智能化地从要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施，以及借助于语义增强模型，智能化地从安全风险级别高于设定级别的要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径，其避免现有通过人工方式查找缓解措施库、攻击路径库，实现智能化地进化物联网设备的威胁建模方法，避免通过人工方式进行威胁建模所带来的诸如成本高、效率低等问题；进一步地，在本实施中，在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库，以及在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库，实现了通过差分进化算法动态增强缓解措施库和攻击路径库，并结合差分进化算法，保证缓解措施库和攻击路径库的规模大小，以及保证内容更加准确。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本公开的实施例，并与说明书一起用于解释本公开的原理。图1为本申请实施例提供的方法流程图；图2为本申请实施例提供的威胁建模数据流图；图3为本申请实施例提供的装置结构图；图4为本申请实施例提供的装置硬件结构图。具体实施方式这里将详细地对示例性实施例进行说明，其示例表示在附图中。下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。以下示例性实施例中所描述的实施方式并不代表与本申请相一致的所有实施方式。相反，它们仅是与如所附权利要求书中所详述的、本申请的一些方面相一致的装置和方法的例子。在本申请使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本申请。在本申请和所附权利要求书中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义。还应当理解，本文中使用的术语“和/或”是指并包含一个或多个相关联的列出项目的任何或所有可能组合。应当理解，尽管在本申请可能采用术语第一、第二、第三等来描述各种信息，但这些信息不应限于这些术语。这些术语仅用来将同一类型的信息彼此区分开。例如，在不脱离本申请范围的情况下，第一信息也可以被称为第二信息，类似地，第二信息也可以被称为第一信息。取决于语境，如在此所使用的词语“如果”可以被解释成为“在……时”或“当……时”或“响应于确定”。下面对本申请实施例进行详细说明。参见图1，图1为本申请实施例提供的方法流程图。该流程可应用于电子设备。在一个例子中，这里的电子设备可为服务器或者其它被指定的物联网设备，本实施例并不具体限定。如图1所示，该流程可包括以下步骤：步骤101，确定与物联网设备相匹配的威胁建模数据流图。如前描述，威胁建模是一个结构化的过程，可以通过该过程识别物联网设备潜在的安全威胁和漏洞，并采用对应的措施消减威胁和漏洞。而在进行威胁建模时，最主要的先是构建数据流图，也即上述的确定与物联网设备相匹配的威胁建模数据流图。在本实施例中，威胁建模数据流图是以图形形式描述数据流从进入物联网设备到物联网设备输出的变换过程，整个变换过程涉及到多个不同要素。比如，涉及到以下几个要素：与物联网设备进行通信的外部实体、数据流、物联网设备被配置的对数据流进行处理的处理操作、与物联网设备相关联的指定存储介质、信任边界。作为一个实施例，上述外部实体可为上述物联网设备之外的实体，比如用户、其它设备等，本实施例并不具体限定。作为一个实施例，上述数据流可为外部实体通过网络连接发向物联网设备的数据流。作为一个实施例，上述处理操作可为物联网设备被配置的用于对数据流进行的某些操作或变换，其可通过采用各种编程语言比如c、cpp、python等编写的代码实现。作为一个实施例，上述指定存储介质可为文件、数据库、共享内存等用于存储数据的介质。在本实施例中，信任边界相当于数据流中的卡点，在该卡点上需要先对数据进行验证，然后再执行相应的处理。信任边界是用数据流程图如上述的威胁建模数据流图进行威胁建模的关键。作为一个实施例，上述信任边界是基于物联网设备的设备架构并结合威胁识别STRIDE模型对应的威胁划分的。在本实施例中，上述设备架构描述了物联网设备中的软件逻辑和硬件结构；STRIDE模型对应以下六类威胁：仿冒、篡改、抵赖、信息泄露、拒绝服务、权限提升。比如，信任边界可为进程、文件系统等，本实施例并不具体限定。基于如上描述，表1举例示出了上述各个要素：表1基于上述各要素的描述，图2举例示出了威胁建模数据流图。在图2中，虚线表示信任边界。另外，在图2中的处理过程、web应用、Write、Read为上述的处理操作，在图2中的数据存储、Database为上述的指定存储介质。步骤102，针对威胁建模数据流图中每一被指定的要素，利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施；利用该要素匹配的至少一个参考缓解措施，确定该要素相匹配的安全风险级别。基于如上要素的描述，这里，威胁建模数据流图中被指定的要素包括除上述信任边界之外的要素。也即，本步骤102是针对威胁建模数据流图中除上述信任边界之外的每一要素执行的。可选地，在本实施例中，任一缓解措施库中的缓解措施通过对应的语义信息表征。在此前提下，本实施例可借助于通过深度学习训练出的语义增强模型智能从缓解措施库中获取缓解措施，而非常规的通过人工方式在缓解措施库获取缓解措施。作为一个实施例，本实施例在利用已训练出的第一语义增强模型从缓解措施库中获得参考缓解措施时，会先基于第一语义增强模型识别该要素的特性。这里，要素的特性用于表征该要素，比如要素为外部实体，其具体为摄像头，则该要素的特性即为摄像头；再比如，要素为数据流，其具体为来自外部实体比如某一摄像头发送的，则该要素的特性即为数据流的源端即摄像头、数据流接收接口即接收到该数据流的接口等；再比如，要素为处理操作比如格式转换，则该要素的特性即为处理操作的类型比如格式转换等；再比如，要素为存储介质比如共享内存，则该要素的特性即为共享内存的标识、内存量等。之后，基于第一语义增强模型从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施。在本实施例中，缓解措施库中任一缓解措施被任一数据流图中的要素匹配成功，则会记录该缓解措施被匹配的次数。基于此，即可很容易基于已记录的各缓解措施的匹配次数即可确定出各缓解措施的使用频率。基于如上描述，作为一个实施例，上述从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施可包括：从该要素匹配的缓解措施库中获得该特性匹配的且使用频率大于或等于第一设定频率阈值的至少一个参考缓解措施；或者，从该要素匹配的缓解措施库中获得该特性匹配的候选缓解措施；按照使用频率的大小对候选缓解措施进行排序，得到候选缓解措施序列；从所述候选缓解措施序列中选择至少一个参考缓解措施，被选择的任一参考缓解措施的使用频率大于或等于所述候选缓解措施序列中未被选择的其它候选缓解措施的使用频率。通过步骤102，最终实现了为威胁建模数据流图中每一被指定的要素确定匹配的至少一个参考缓解措施。在确定出要素匹配的至少一个参考缓解措施之后，可基于该要素匹配的至少一个参考缓解措施，确定该要素相匹配的安全风险级别。可选地，在本实施例中，任一要素匹配的参考缓解措施与该要素相匹配的安全风险级别有关，至于如何基于要素匹配的参考缓解措施确定要素相匹配的安全风险级别，其有很多实现方式，比如通过显示要素匹配的参考缓解措施并接收外部基于该显示的参考缓解措施输入的该要素的安全风险级别等。步骤103，针对安全风险级别高于设定级别的每一要素，利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径。在本实施例中，任一攻击路径库中的攻击路径通过对应的语义信息表征。在此前提下，本实施例可借助于通过深度学习训练出的语义增强模型智能从该要素匹配的攻击路径库中获得与该要素匹配的至少一个攻击路径。作为一个实施例，本实施例在利用已训练出的第二语义增强模型从攻击路径库中获得参考攻击路径时，会从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径。在本实施例中，攻击路径库中任一攻击路径被任一数据流图中的要素匹配成功，则会记录该攻击路径被匹配的次数，基于各攻击路径的匹配次数即可确定出各攻击路径的使用频率。作为一个实施例，上述从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径可包括：从该要素匹配的攻击路径库中获得该安全风险级别匹配的且使用频率大于或等于第二设定频率阈值的至少一个参考攻击路径；或者，从该要素匹配的攻击路径库中获得该安全风险级别匹配的候选攻击路径；按照使用频率的大小对候选攻击路径进行排序，得到候选攻击路径序列；从所述候选攻击路径序列中选择至少一个参考攻击路径，被选择的任一参考攻击路径的使用频率大于或等于所述候选攻击路径序列中未被选择的其它候选攻击路径的使用频率。通过步骤103，最终实现了为安全风险级别高于设定级别的每一要素确定匹配的至少一个参考攻击路径。这里的安全风险级别高于设定级别比如为中、高级别，本实施例并不具体限定。步骤104，基于物联网设备被应用的业务场景，并结合威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施生成威胁建模文档库，威胁建模文档库包括各要素匹配的目标缓解措施以及各要素匹配的目标攻击路径；在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库，以及在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库。在本实施例中，在获得威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施后，可结合物联网设备应用的业务场景，确定是否调整威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施。比如，本实施例可基于上述业务场景识别出可能存在的潜在的威胁点。之后，基于威胁点生成对应的安全需求。之后基于该安全需求，则先针对每一要素，检查该要素匹配的参考缓解措施是否满足该安全需求，如果不满足，则根据安全需求调整该要素匹配的参考缓解措施，以使调整后的参考缓解措施满足该安全需求，这里可将满足安全需求的该调整后的参考缓解措施记为该要素匹配的目标缓解措施；当然，若该要素匹配的参考缓解措施满足该安全需求，则直接将该参考缓解措施记为该要素匹配的目标缓解措施。需要说明的是，本实施例中，根据安全需求调整该要素匹配的参考缓解措施有很多实现方式，比如删除不满足安全需求的参考缓解措施，并新增满足安全需求的参考缓解措施；或者根据安全需求修改该要素匹配的参考缓解措施，等，本实施例并不具体限定。同样的原理，本实施例还会针对每一要素，检查该要素匹配的参考攻击路径是否满足该安全需求，如果不满足，则根据安全需求调整该要素匹配的参考攻击路径，以使调整后的参考攻击路径满足该安全需求，这里可将满足安全需求的该调整后的参考攻击路径记为该要素匹配的目标攻击路径；当然，若该要素匹配的参考攻击路径满足该安全需求，则直接将该参考攻击路径记为该要素匹配的目标攻击路径。类似地，本实施例中，根据安全需求调整该要素匹配的参考攻击路径有很多实现方式，比如删除不满足安全需求的参考攻击路径，并新增满足安全需求的参考攻击路径；或者根据安全需求修改该要素匹配的参考攻击路径，等，本实施例并不具体限定。通过上面描述，最终会得到威胁建模文档库。上述威胁建模文档库包括各要素匹配的目标缓解措施以及各要素匹配的目标攻击路径。在本实施例中，任一要素匹配的目标缓解措施可能与该要素匹配的参考缓解措施相同，也可不同。当任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库以使缓解措施库中新增该要素匹配的目标缓解措施。比如，基于差分进化算法选择该要素匹配的满足第一条件的目标缓解措施，所述第一条件是指目标缓解措施与该要素匹配的参考缓解措施不满足第一设定相似要求且不存在于该要素匹配的缓解措施库中；将该选择出的目标缓解措施添加至该要素匹配的缓解措施库。和/或，在本实施例中，还可基于差分进化算法确定出任一要素匹配的缓解措施库中存在满足第一设定相似要求的至少两个缓解措施时，选择最优缓解措施继续记录在缓解措施库并从缓解措施库中删除非最优缓解措施。在本实施例中，任一要素匹配的目标攻击路径可能与该要素匹配的参考攻击路径相同，也可不同。当任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库以使攻击路径库中新增该要素匹配的目标攻击路径。比如，基于差分进化算法选择该要素匹配的满足第二要求的目标攻击路径，所述第二要求是指该目标攻击路径与该要素匹配的参考攻击路径不满足第二设定相似要求且不存在于该要素匹配的攻击路径库中；将该选择出的目标攻击路径添加至该要素匹配的攻击路径库。和/或，本实施例还会基于差分进化算法确定出该要素匹配的攻击路径库中存在满足第二设定相似要求的至少两个攻击路径时，选择最优攻击路径继续记录在攻击路径库并从该攻击路径库中删除非最优的攻击路径。基于上面描述，可以发现通过原本不用于威胁建模的差分进化算法应用于威胁建模，以实现了动态增强缓解措施库和攻击路径库的准确性，并结合差分进化算法，保证缓解措施库和攻击路径库的规模大小，以及保证内容更加准确。至此，完成图1所示流程。通过图1所示流程可以看出，在本实施例中，在进行威胁建模时，借助于语义增强模型智能化地从要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施，以及借助于语义增强模型，智能化地从安全风险级别高于设定级别的要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径，其避免现有通过人工方式查找缓解措施库、攻击路径库，实现智能化地进化物联网设备的威胁建模方法，避免通过人工方式进行威胁建模所带来的诸如成本高、效率低等问题；进一步地，在本实施中，在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库，以及在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库，实现了通过差分进化算法动态增强缓解措施库和攻击路径库，并结合差分进化算法，保证缓解措施库和攻击路径库的规模大小，以及保证内容更加准确。以上对本申请实施例提供的方法进行了描述，下面对本申请实施例提供的装置进行描述：参见图3，图3为本申请实施提供的装置结构图。该装置应用于电子设备，包括：确定单元，用于确定与物联网设备相匹配的威胁建模数据流图；所述威胁建模数据流图是以图形形式描述数据流从进入所述物联网设备到所述物联网设备输出的变换过程，所述变换过程涉及到多个不同要素；建模单元，用于针对所述威胁建模数据流图中每一被指定的要素，利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施；利用该要素匹配的至少一个参考缓解措施，确定该要素相匹配的安全风险级别；以及，针对安全风险级别高于设定级别的每一要素，利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径；以及，基于物联网设备被应用的业务场景，并结合威胁建模数据流图中各要素匹配的参考攻击路径和参考缓解措施生成威胁建模文档库；威胁建模文档库包括各要素匹配的目标缓解措施以及各要素匹配的目标攻击路径；调整单元，用于在任一要素匹配的目标缓解措施不同于该要素匹配的参考缓解措施时，基于差分进化算法调整该要素匹配的缓解措施库，以及在任一要素匹配的目标攻击路径不同于该要素匹配的参考攻击路径时，基于差分进化算法调整该要素匹配的攻击路径库。可选地，所述变换过程涉及到的各个要素包括：与所述物联网设备进行通信的外部实体、数据流、所述物联网设备被配置的对数据流进行处理的处理操作、与所述物联网设备相关联的指定存储介质、信任边界；其中，所述信任边界是基于所述物联网设备的设备架构并结合威胁识别STRIDE模型对应的威胁划分的，所述设备架构描述了所述物联网设备中的软件逻辑和硬件结构；所述STRIDE模型对应以下六类威胁：仿冒Spoofing、篡改Tampering、抵赖Repudiation、信息泄露Information Disclosure、拒绝服务Denial of Service、权限提升Elevation ofPrivilege；所述威胁建模数据流图中被指定的要素包括除所述信任边界之外的要素。可选地，任一缓解措施库中的缓解措施通过对应的语义信息表征；所述利用已训练出的第一语义增强模型，在该要素匹配的缓解措施库中获得与该要素匹配的至少一个参考缓解措施包括：针对所述威胁建模数据流图中每一被指定的要素，利用深度学习训练出的第一语义增强模型，并结合该要素的特性，从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施。可选地，所述从该要素匹配的缓解措施库中获得该特性匹配的、且使用频率满足设定要求的至少一个参考缓解措施包括：从该要素匹配的缓解措施库中获得该特性匹配的且使用频率大于或等于第一设定频率阈值的至少一个参考缓解措施；或者，从该要素匹配的缓解措施库中获得该特性匹配的候选缓解措施；按照使用频率的大小对候选缓解措施进行排序，得到候选缓解措施序列；从所述候选缓解措施序列中选择至少一个参考缓解措施，被选择的任一参考缓解措施的使用频率大于或等于所述候选缓解措施序列中未被选择的其它候选缓解措施的使用频率。可选地，任一攻击路径库中的攻击路径通过对应的语义信息表征；所述利用已训练出的第二语义增强模型，并结合该要素相匹配的安全风险级别在该要素匹配的攻击路径库中获得与该要素匹配的至少一个参考攻击路径包括：针对安全风险级别高于设定级别的每一要素，利用深度学习训练出的第二语义增强模型，并结合该要素的安全风险级别，从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径。可选地，所述从该要素匹配的攻击路径库中获得该安全风险级别匹配的、且使用频率满足设定要求的至少一个参考攻击路径包括：从该要素匹配的攻击路径库中获得该安全风险级别匹配的且使用频率大于或等于第二设定频率阈值的至少一个参考攻击路径；或者，从该要素匹配的攻击路径库中获得该安全风险级别匹配的候选攻击路径；按照使用频率的大小对候选攻击路径进行排序，得到候选攻击路径序列；从所述候选攻击路径序列中选择至少一个参考攻击路径，被选择的任一参考攻击路径的使用频率大于或等于所述候选攻击路径序列中未被选择的其它候选攻击路径的使用频率。可选地，所述基于差分进化算法调整该要素匹配的缓解措施库包括：基于差分进化算法选择该要素匹配的满足第一条件的目标缓解措施，所述第一条件是指目标缓解措施与该要素匹配的参考缓解措施不满足第一设定相似要求且不存在于该要素匹配的缓解措施库中；将该选择出的目标缓解措施添加至该要素匹配的缓解措施库；和/或，基于差分进化算法确定出该要素匹配的缓解措施库中存在满足第一设定相似要求的至少两个缓解措施时，选择最优缓解措施继续记录在缓解措施库并从缓解措施库中删除非最优缓解措施；所述基于差分进化算法调整该要素匹配的攻击路径库包括：基于差分进化算法选择该要素匹配的满足第二要求的目标攻击路径，所述第二要求是指该目标攻击路径与该要素匹配的参考攻击路径不满足第二设定相似要求且不存在于该要素匹配的攻击路径库中；将该选择出的目标攻击路径添加至该要素匹配的攻击路径库；和/或，基于差分进化算法确定出该要素匹配的攻击路径库中存在满足第二设定相似要求的至少两个攻击路径时，选择最优攻击路径继续记录在攻击路径库并从该攻击路径库中删除非最优的攻击路径。至此，完成图3所示装置的结构描述。对应地，本申请还提供了图3所示装置的硬件结构。参见图4，该硬件结构可包括：处理器和机器可读存储介质，机器可读存储介质存储有能够被所述处理器执行的机器可执行指令；所述处理器用于执行机器可执行指令，以实现本申请上述示例公开的方法。基于与上述方法同样的申请构思，本申请实施例还提供一种机器可读存储介质，所述机器可读存储介质上存储有若干计算机指令，所述计算机指令被处理器执行时，能够实现本申请上述示例公开的方法。示例性的，上述机器可读存储介质可以是任何电子、磁性、光学或其它物理存储装置，可以包含或存储信息，如可执行指令、数据，等等。例如，机器可读存储介质可以是：RAM、易失存储器、非易失性存储器、闪存、存储驱动器、固态硬盘、任何类型的存储盘，或者类似的存储介质，或者它们的组合。上述实施例阐明的系统、装置、模块或单元，具体可以由计算机或实体实现，或者由具有某种功能的产品来实现。一种典型的实现设备为计算机，计算机的具体形式可以是个人计算机、膝上型计算机、蜂窝电话、相机电话、智能电话、个人数字助理、媒体播放器、导航设备、电子邮件收发设备、游戏控制台、平板计算机、可穿戴设备或者这些设备中的任意几种设备的组合。为了描述的方便，描述以上装置时以功能分为各种单元分别描述。当然，在实施本申请时可以把各单元的功能在同一个或多个软件和/或硬件中实现。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请实施例可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可以由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其它可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其它可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。而且，这些计算机程序指令也可以存储在能引导计算机或其它可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或者多个流程和/或方框图一个方框或者多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其它可编程数据处理设备上，使得在计算机或者其它可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其它可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。以上所述仅为本申请的实施例而已，并不用于限制本申请。对于本领域技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本申请的权利要求范围之内。
