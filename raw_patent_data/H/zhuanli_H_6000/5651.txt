标题title
一种多路复用通信系统
摘要abst
本发明涉及一种多路复用通信系统。多路复用通信系统包括：M个主机和N个从机，其中M≥2，N≥M；解串器，解串器连接主机并且解串来自主机的信号，解串器有M个I2C接口，每个I2C接口分别连接一个不同的主机，并且解串器链接到N个串行器端口引入选择器，I2C接口中的每个均连接所有串行器端口引入选择器；N个串行器，串行器端口引入选择器分别通过所述串行器的I2C接口连接到从机，串行器串行化所述解串器解串的信号并传递至从机，并且，解串器具有优先级仲裁器用于协调所述I2C接口的任何一个通信至串行器和从机。本发明通过引入多路I2C路由访问多主机的架构，提供了更灵活、更高效的数据通信控制方式以实现高效、灵活和可扩展的设备连接。
权利要求书clms
1.一种多路复用通信系统，其特征在于，所述多路复用通信系统包括：M个主机和N个从机，其中M≥2，N≥M；解串器，所述解串器连接所述主机并且解串来自所述主机的信号，所述解串器具有M个I2C接口，每个所述I2C接口分别连接一个不同的所述主机，并且所述解串器链接到N个串行器端口引入选择器，所述串行器端口引入选择器呈多路复用器的形式，所述I2C接口中的每个均连接所有串行器端口引入选择器；N个串行器，所述串行器端口引入选择器分别通过所述串行器的I2C接口连接到所述从机，所述串行器串行化所述解串器解串的信号并传递至所述从机，并且，所述解串器具有优先级仲裁器，所述优先级仲裁器能够协调所述I2C接口的任何一个通信至所述串行器和所述从机。2.如权利要求1所述的多路复用通信系统，其特征在于，所述主机为控制单元，所述从机为车载摄像头。3.如权利要求2所述的多路复用通信系统，其特征在于，所述控制单元为中央处理单元、图形处理单元、图像信号处理器或现场可编程门阵列。4.如权利要求2所述的多路复用通信系统，其特征在于，所述解串器通过广播或单播的方式将指令或数据传输给所述摄像头。5.如权利要求1所述的多路复用通信系统，其特征在于，所述优先级仲裁器连接并且协调所述I2C接口访问所述解串器的本地寄存器，使得所述M个主机能够同时通信至所述解串器。6.如权利要求1所述的多路复用通信系统，其特征在于，所述从机和所述串行器之间通过能够实现双向通信的I2C总线连接。7.如权利要求1所述的多路复用通信系统，其特征在于，所述串行器能够接收来自所述主机和所述解串器的控制信号和配置信号并传输给所述从机，并且所述串行器能够将所述从机的状态信号实时反馈给所述解串器和所述主机。8.如权利要求1所述的多路复用通信系统，其特征在于，所述解串器具有I2C路由器，所述解串器内的I2C总线布设在所述I2C路由器内，并且所述I2C路由器接收来自所述主机的请求并将所述请求分配给正确的从机。9.如权利要求1所述的多路复用通信系统，其特征在于，所述解串器连接到所述串行器端口引入所述选择器，所述选择器能够选择所述I2C接口中的任意一个通信至远端的所述串行器和所述从机。10.如权利要求1所述的多路复用通信系统，其特征在于，所述解串器的I2C接口和所述串行器的I2C接口能够实现双向通信，并且，每个所述解串器的I2C接口和所述串行器的I2C接口均包括主机模块、从机模块和数据合并模块，所述从机模块包括与所述数据合并模块通信的从机物理收发层，所述主机模块包括主机物理收发层以及与所述主机物理收发层通信的发送缓冲区和接收缓冲区，用于接收发送远端的从机数据和主机数据打包到高速串行链路。
说明书desc
技术领域本公开涉及多路复用通信技术领域，具体涉及一种多路复用通信系统。背景技术汽车的多路复用通信系统是一种用于车辆内部各个电子控制单元之间进行数据通信和信息交换的技术。它通过在车辆内部共享一个物理通信总线来实现不同ECU之间的数据传输。这种系统可以将多个ECU连接在一起，实现各个系统之间的实时数据交互，能够满足现代汽车对高度智能化和互联互通的需求。车载摄像头是自动驾驶汽车的重要传感器，而配置多个摄像头通过不同类型的摄像头相互配合覆盖不同范围的场景，能够更精确地识别和分析环境。但是在目前市面上的桥接芯片往往只支持单个主机控制多个从机，在控制多类型摄像头时需要一个一个地进行配置，初始化的时间也花费较长，而且不能同时支持多个主机对多个从机进行控制，也不能多个桥接芯片同时配置多个摄像头。发明内容有鉴于此，本公开的目的是提供一种多路复用通信系统，从而解决或者至少缓解了现有技术中存在的上述问题和其他方面的问题中的一个或多个。为了实现前述目的，本公开提供了一种多路复用通信系统，其中，所述多路复用通信系统包括：M个主机和N个从机，其中M≥2，N≥M；解串器，所述解串器连接所述主机并且解串来自所述主机的信号，所述解串器具有M个I2C接口，每个所述I2C接口分别连接一个不同的所述主机，并且所述解串器链接到N个串行器端口引入选择器，所述串行器端口引入选择器呈多路复用器的形式，所述I2C接口中的每个均连接所有串行器端口引入选择器；N个串行器，所述串行器端口引入选择器分别通过所述串行器的I2C接口连接到所述从机，所述串行器串行化所述解串器解串的信号并传递至所述从机，并且，所述解串器具有优先级仲裁器，所述优先级仲裁器能够协调所述I2C接口的任何一个通信至所述串行器和所述从机。在如前所述的多路复用通信系统中，可选地，所述主机为控制单元，所述从机为车载摄像头。在如前所述的多路复用通信系统中，可选地，所述控制单元为中央处理单元、图形处理单元、图像信号处理器或现场可编程门阵列。在如前所述的多路复用通信系统中，可选地，所述解串器通过广播或单播的方式将指令或数据传输给所述摄像头。在如前所述的多路复用通信系统中，可选地，所述优先级仲裁器连接并且协调所述I2C接口访问所述解串器的本地寄存器，使得所述M个主机能够同时通信至所述解串器。在如前所述的多路复用通信系统中，可选地，所述从机和所述串行器之间通过能够实现双向通信的I2C总线连接。在如前所述的多路复用通信系统中，可选地，所述串行器能够接收来自所述主机和所述解串器的控制信号和配置信号并传输给所述从机，并且所述串行器能够将所述从机的状态信号实时反馈给所述解串器和所述主机。在如前所述的多路复用通信系统中，可选地，所述解串器具有I2C路由器，所述解串器内的I2C总线布设在所述I2C路由器内，并且所述I2C路由器接收来自所述主机的请求并将所述请求分配给正确的从机。在如前所述的多路复用通信系统中，可选地，所述解串器连接到所述串行器端口引入所述选择器，所述选择器能够选择所述I2C接口中的任意一个通信至远端的所述串行器和所述从机。在如前所述的多路复用通信系统中，可选地，所述解串器的I2C接口和所述串行器的I2C接口能够实现双向通信，并且，每个所述解串器的I2C接口和所述串行器的I2C接口均包括主机模块、从机模块和数据合并模块，所述从机模块包括与所述数据合并模块通信的从机物理收发层，所述主机模块包括主机物理收发层以及与所述主机物理收发层通信的发送缓冲区和接收缓冲区，用于接收发送远端的从机数据和主机数据打包到高速串行链路。本公开通过使用多个I2C总线可以实现高度灵活性，在不同的应用场景中进行自定义设置，也可以轻松地添加更多的主机和从机以满足不断变化的需求。本公开采用多路I2C总线路由访问提供了更高效的通信方式以最大限度地利用I2C总线和设备资源。综上所述，本公开提出了一种多路复用通信系统，通过引入多路I2C路由访问多主机的架构，提供了更灵活、更高效的数据通信控制方式以实现高效、灵活和可扩展的设备连接，解决了现有桥接芯片I2C总线只支持单主机和多从机的问题。附图说明参照附图，本发明的公开内容将更加显然。应当了解，这些附图仅仅用于说明目的，而并非意在对本发明的保护范围构成限制。图中：图1为本发明的多路复用通信系统的一个实施例的示意图；图2为本发明的多路复用通信系统的一个实施例中的桥接芯片的示意图。附图标记：1-主机；2-从机；3-解串器；4-串行器；5-选择器；6-优先级仲裁器；7-本地寄存器；8-主机模块；9-从机模块；10-数据合并模块；11-从机物理收发层；12-主机物理收发层；13-发送缓冲区；14-接收缓冲区；15-I2C路由器；16-地址转换器。具体实施方式参照附图和具体实施例，下面将以示例的方式来说明根据本发明的多路复用通信系统的组成、结构、特点和优点等，然而所有描述不应用于对本公开形成任何限制。此外，对于在本文提及的实施例中予以描述或隐含的任意单个技术特征，或者被显示或隐含在各个附图中的任意的单个技术特征，本公开仍然允许在这些技术特征之间继续进行任意组合或者删减而不存在任何的技术障碍，从而应当认为这些根据本公开的更多实施例也是在本文的记载范围之内。还需要说明的是，术语“内” 指示位置关系为基于附图所示的多路复用通信系统各组成部分的位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的模块或部件必须具有特定的位置关系、以特定的位置连接与设置，因此不能理解为对本公开的限制。此外，术语“多个”等的含义为至少两个及两个以上，除非另有明确具体的限定。图1为本发明的多路复用通信系统的一个实施例的示意图。在该实施例中示出了主机1、从机2、解串器3、串行器4及解串器3内的选择器5、仲裁器6、寄存器7等。从图1中可以看出，本公开的通信系统为桥接芯片多主机多从机的I2C控制系统。在该系统中，解串器3具有三组I2C接口，可以连接三个主机1，即三个处理单元，其可以是中央处理单元、图形处理单元、图像信号处理器或现场可编程门阵列。另外，在解串器端还引入了优先级仲裁器6，负责协调三个I2C访问解串器3内部寄存器，使三个处理单元可以同时控制解串器。解串器3链接到串行器端口引入选择器5，可以选择三个I2C任意一个I2C去控制远端的串行器4和从机2例如摄像头。解串器3可以通过广播或单播方式将指令和数据传输给各从机2。串行器、解串器的I2C接口模块可以实现双向通信。在该实施例中，在多主机多从机的I2C控制系统中，多个主机之间通过仲裁器同时操作解串器寄存器，并且解串器端仲裁操作本地寄存器和远程接口I2C链路选择器组成的串行解串控制系统。在其它实施例中，多路复用通信系统可以包括M个主机1、N个从机2、串行器4和解串器3。在图中示例中，M=3，N=4。所述串行器4用于把解串器3所解串的并行信号转化为串行信号传递给从机2，所述解串器3用于接收来自主机1的串行信号解串为并行信号。主机1和从机2是一个相对的概念，所述主机1负责整个系统的任务协调与分配，所述从机2一般通过接收主机1的指令从而完成某些特定的任务，主机1与从机2之间通过总线连接，进行数据通信。在该实施例中，主机1为控制单元，从机2为车载摄像头，控制单元负责管理所有I2C总线之间的通信以确保每个主机1和从机2都能够正确地相互通信，具体而言，所述控制单元通过发送控制指令来配置车载摄像头。所述I2C总线是一种简单、双向二线制同步串行总线。每个连接到总线上的器件都有唯一的地址，同一时刻只允许有一个主机1，在硬件上，它只需要两根线两根线即可在连接于总线上的器件之间传送信息，总线的接口已经集成在桥接芯片内部，不需要特殊的接口电路，而且片上接口电路的滤波器可以滤去总线数据上的毛刺，因此I2C总线简化了硬件电路PCB布线，降低了系统成本，提高了系统可靠性。在该实施例中，串行器4以及选择器5的数量都与从机2的数量保持一致为N个，解串器3与主机1相连，所述解串器3中设置有与主机1个数相同的M个I2C接口，其中，解串器3中的每个所述I2C接口分别连接一个不同的主机1，同时，在所述解串器3中还设置有与串行器4数量相同的N个选择器5与N个串行器4的端口一一对应连接再通过串行器4的N个I2C接口与N个从机2通过I2C总线相连，每个I2C总线都连接到对应的一个主机1和所有的多个从机2，在解串器3中的每个选择器5都与解串器3所连接的主机1通过I2C接口相连接用于选择多个主机1连接的任意一条I2C总线去控制远端的串行器4和从机2，呈多路复用器的形式，用于解串器3和串行器4之间的通信。在这里需要说明的是所述选择器5可以通过I2C总线实现与多个主机1的双向通信。在解串器3中还设置有本地寄存器7和优先级仲裁器6，所述优先级仲裁器6通过I2C总线连接至选择器5以及主机1的I2C端口用于协调任一I2C接口访问解串器3中的本地寄存器7并通信至串行器4和从机2，此时主机1输入I2C接口的配置从机2的指令信号也能够暂存在本地寄存器7中与解串器3通信。所述本地寄存器7内置在解串器3中与优先级仲裁器6相连用于储存解串器3中收发的信息。所述优先级仲裁器6负责协调I2C总线访问解串器3内部的本地寄存器7，使多个主机1可以同时控制解串器3。在本实施例中，所述优先级仲裁器6是一种用于确定多个任务或请求的执行顺序的工具，它可以帮助本实施例的多路复用通信系统在处理多个并发的任务指令时进行合理的调度和分配。当系统中存在多个任务同时竞争共享的执行时，优先级仲裁器6可以根据不同任务的优先级来决定执行的顺序，从而确保高优先级任务能够尽快得到满足从而提高系统的性能和效率，确保了重要的配置信号得到及时处理。优先级仲裁器6通常根据任务的重要性、紧急程度、资源需求等因素来确定任务的优先级，具体的算法和实现方式可以根据具体的工作环境需求进行选择和设计，比如当接收的数据占用很大时，优先级仲裁器6将优先选择适合处理大字节数据的部件，具体而言，在本实施例中采用多种图像处理单元的方式有利于处理多种情况的图像处理任务，比如在处理不同分辨率的图像时，可以选择其中最适合的处理单元来进行处理。在其他可选的实施例中也可以不设置优先级仲裁器6。在实际双向传输的通信过程中，串行器4接收来自主机1和解串器3的控制信号和配置从机2的指令信号并传输给所述从机2，并且所述串行器4再将所述从机2即刻的状态信号实时反馈给所述解串器3和所述主机1。在本实施例中，所述串行器4和所述解串器3之间通过R-Linc协议进行传输，所述R-Linc协议是发明人公司自行研发的用于汽车的私有通讯协议。在本实施例中，从机2与串行器4的通信采用的接口技术为CSI-2，所述CSI-2用于所述从机2即车载摄像头的视频信号传输，具有接口少，抗EMI强、速度快、功耗低等优点。在可选的实施例中，解串器3具有I2C路由器15，所述解串器3内的I2C总线都布设在所述I2C路由器15内，并且所述I2C路由器15接收来自所述主机1的配置指令请求并将所述请求分配给正确的从机2。所述I2C路由器15用于连接和管理I2C总线所连接的设备，它允许多个I2C总线所连接的设备通过共享同一条I2C总线进行通信，还具有处理和转发I2C总线通信的功能，可以根据需要来将数据从一个端口路由到另一个端口，能够实现更有效地管理和控制各种I2C总线所连接的设备之间的通信。所述I2C路由器15通常具有多个I2C的接发端口，每个端口都可以连接一个或多个含I2C接口的通信设备。因此，在本实施例中每个主机1只需要对应连接到一个I2C总线，而不需要连接多个I2C总线，当多个主机1需要访问从机2时，主机1会向连接的I2C总线发送请求，并由路由器将请求转发给正确的从机2。本实施例使用I2C路由器15简化了I2C总线的布线和连接，减少了硬件资源的占用，并提供了更为灵活的设备管理。在可选的实施例中，控制单元可以为中央处理单元、图形处理单元、图像信号处理器或现场可编程门阵列。所述CPU的计算核心可以有四个或八个，具有大量的缓存结构，单任务的处理速度非常快，具有多种如阈值运行图像、卷积滤镜等图像处理的功能，由于CPU采用的单行计算，当处理任务数量增多时，对应的处理时间也增长。所述GPU由大量相同的流式处理器组成，内存处理单元接口带宽好于传统的接口，可以更高效更迅速的同时处理大规模的图形处理任务，适用于并行计算。所述ISP在手机摄像头和车载摄像头等领域有着广泛应用，在该多路复用系统中能够接收并处理来自摄像头的图像信号，并对图像信号做一系列的算法处理，并统计出当前图像的实时信息。所述FPGA的图像处理方式是大规模并行运行的，含有大量的计算单元，计算能力很强，FPGA是可编程的，能够灵活地针对自己所用的算法修改电路，可以根据特定的应用去编程硬件，例如如果应用里面的加法运算非常多就可以把大量的逻辑资源去实现加法器。在其他的实施例中，控制单元也可以根据实际需要解决的工作问题以及期望效果来自由选择。在可选的实施例中，所述解串器3可以通过广播或单播的方式将指令或数据传输给车载摄像头。所述广播和单播都是用来描述网络节点之间通信方式的术语，分别为一对多或者一对一的通信形式。节点之间的通信就好像是人们之间的对话一样。如果一个人对另外一个人说话，那么用术语来描述就是“单播”，此时信息的接收和传递只在两个节点之间进行。“广播”可以理解为一个人通过广播喇叭对在场的全体说话，这样做的好处是通信效率高，信息一下子就可以传递到全体。图2为本发明的多路复用通信系统的一个实施例中的桥接芯片的示意图。桥接芯片是一种用于连接不同类型的总线或接口的集成电路。如前所述，I2C是一种串行通信协议，用于在电子设备之间进行数据传输。因此，本实施例中提到的桥接芯片I2C是指用于连接I2C总线的桥接芯片。桥接芯片I2C可以用来连接两个不同的I2C总线，或者将I2C总线与其他类型的总线进行连接，它起到了协议转换和信号级别转换的作用，使得不同类型的设备都可以进行双向的数据交换。本实施例使用桥接芯片I2C可以实现诸如扩展I2C总线长度、连接不同类型的设备、兼容不同的电压级别等功能。在本实施例中，所述桥接芯片是SERDES芯片，它是一种时分多路复用、点对点的串行通信技术，即在发送端多路低速并行信号被转换成高速串行信号，经过传输媒体最后在接收端高速串行信号重新转换成低速并行信号。这种点对点的串行通信技术充分利用传输媒体的信道容量，减少所需的传输信道和器件引脚数目，提升信号的传输速度，从而大大地降低了通信成本。在其他可选的实施例中，不同型号的桥接芯片I2C可能具有不同的特性和功能，可以根据实际需要来选择适合的型号。如图2所示，解串器3的I2C接口和串行器4的I2C接口都能够实现R-Linc的双向通信，并且，每个解串器3的I2C接口和串行器4的I2C接口均包括主机模块8、从机模块9和数据合并模块10，所述从机模块9包括与所述数据合并模块10通信的从机物理收发层11，所述主机模块8包括主机物理收发层12以及与所述主机物理收发层12通信的发送缓冲区13和接收缓冲区14，用于接收发送远端的从机2数据和主机1数据打包到高速串行链路。即，每个I2C接口包括从机和主机物理收发层，既可以作为主机发送数据，也可以作为从机接受数据。主机模块内建发送缓冲区和接收缓冲区，用于接收发送远端从机的I2C数据。数据合并模块把从机数据和主机数据打包到高速串行链路，实现双向通信。在该实施例中，解串器3和串行器4的任意一点都可以作为主机1用于双向发布控制请求的指令和配置车载摄像头的指令，主机1可以是控制单元，也可以是原先作为从机2的所述车载摄像头，从机2可以是车载摄像头，也可以是原先作为主机1的控制单元。在可选的实施例中，串行器4中可以包括本地寄存器7，解串器3中可以包括本地寄存器7用于暂存收发的信号指令。在主机模块8中，作为主机1的一端发布指令信号通过I2C发送缓冲区13存储到本地寄存器7并传输至地址转换器16用于确保将信号发送到正确的从机2处，随后经过数据合并模块10整合信息数据后通过R-Linc协议传输给从机模块9中的数据合并模块10经整合信息数据后传输给I2C从机物理收发层11并储存在从机模块9的本地寄存器7中。在硬件上，I2C的两根线两根线在主从设备之间传输数据，所述的两根线即为图中所示的SDA 是一种主机1和从机2发送和接收数据的线路，SCL 是一种承载时钟信号的线路。I2C是一种串行通信协议，因此数据沿着单线逐位传输。I2C是同步的，因此位输出通过主机1和从机2之间共享的时钟信号与位采样同步，其中时钟信号始终由主机1控制。在本公开中的多个I2C总线，每个I2C总线都连接到一个主机和多个从机，I2C路由器收到来自主机的请求并将请求分配给正确的从机，控制器负责管理所有I2C总线和路由器之间的通信，并确保每个主机和从机都能够正确地互相通信。在该本公开的技术方案中，每个主机只需要连接到一个I2C总线，而不需要连接到多个I2C总线。当主机需要访问从机时，它会向其连接的I2C总线发送请求，并由路由器将请求转发给正确的从机。如果存在多个主机，则每个主机都可以通过其连接的I2C总线向从机发送请求。本公开使用多个I2C总线和路由器可以实现高度灵活性，在不同的应用场景中进行自定义配置；可以轻松地添加更多的主机和从机，以满足不断变化的需求；多路I2C路由访问提供了高效的通信方式，可最大限度地利用I2C总线和设备资源。在本公开中，桥接芯片I2C控制能够支持多个主机多个从机，控制多类型摄像头时，可以实现同时多个摄像头配置，初始化时间短，能够同时支持多个主机对多个从机进行控制，能够多个I2C同时控制多个摄像头。因而，本公开通过引入多主机架构，提供了更灵活、更高效的数据通信控制方式。本公开的技术范围不仅仅局限于上述说明书中的内容。本领域技术人员可以在不脱离本公开技术思想的前提下，对上述实施例进行多种变形和修改，而这些变形和修改均应当属于本发明的范围内。
