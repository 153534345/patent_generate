标题title
一种总线扩展模组及使用该总线扩展模组的通信方法
摘要abst
本申请涉及一种总线扩展模组及使用该总线扩展模组的通信方法，属于总线通信技术领域，其中总线扩展模组包括主站扩展模块和从站扩展模块，所述主站扩展模块通信连接于上位机；所述从站扩展模块与工业设备对应设置，且所述从站扩展模块通信连接于对应的工业设备，以用于采集工业设备数据；主站扩展模块和从站扩展模块分别包括第一通信单元，所述第一通信单元用于建立主站扩展模块与从站扩展模块之间的通信；所述从站扩展模块中的第一通信单元还用于建立所属从站扩展模块与其他任意从站扩展模块之间的通信和数据交互。本申请具有采用树状拓扑连接结构从站扩展模块的数据转发功能来实现上位机与所有工业设备的通信和数据交互。
权利要求书clms
1.一种总线扩展模组，其特征在于，包括主站扩展模块和从站扩展模块，所述主站扩展模块通信连接于上位机；所述从站扩展模块与工业设备对应设置，且所述从站扩展模块通信连接于对应的工业设备，以用于采集工业设备数据；所述主站扩展模块和从站扩展模块分别包括第一通信单元，所述第一通信单元用于建立主站扩展模块与从站扩展模块之间的通信；所述从站扩展模块中的第一通信单元还用于建立所属从站扩展模块与其他任意从站扩展模块之间的通信和数据交互。2.根据权利要求1所述的总线扩展模组，其特征在于，所述从站扩展模块和主站扩展模块还包括第二通信单元，所述从站扩展模块和主站扩展模块通过第二通信单元通信连接有远程管理平台，所述从站扩展模块用于将所采集的工业设备数据传送至远程管理平台。3.根据权利要求1所述的总线扩展模组，其特征在于，所述主站扩展模块和从站扩展模块分别预存储有若干预设的通信链路，其中，所述通信链路包括以节点形式存在的从站扩展模块和/或主站扩展模块；所述主站扩展模块和从站扩展模块分别包括数据收发单元；所述数据收发单元用于在接收到数据帧时，将所属节点确定为中继始节点，并存储所述数据帧；还用于基于所述数据帧中的源节点和目的节点，确定所述中继始节点所对应的上级节点和下级节点，将所述数据帧转发至下级节点，并向上级节点发送反馈信息，以使得上级节点删除所述数据帧；还用于在接收到所述中继始节点的下级节点所发出的反馈信息后，删除数据帧。4.根据权利要求3所述的总线扩展模组，其特征在于，所述数据收发单元用于在向所述中继始节点的下级节点发送数据帧时，开始计时，直至接收到所述中继始节点的下级节点的反馈信息时，停止计时；还用于当计时时长达到指定时长，且未收到对应下级节点的反馈信息时，实时向所述中继始节点的下级节点发送续连信号，直至接收到所述中继始节点的下级节点发送的响应信号时，停止计时、停止发送续连信号，再次重复前述向所述中继始节点的下级节点发送所述数据帧并开始计时的步骤。5.根据权利要求4所述的总线扩展模组，其特征在于，所述数据收发单元还用于在向所述中继始节点的下级节点实时发送续连信号时，确定中继链路，通过所述第一通信单元广播带有中继链路的传送暂停指令；其中，所述中继链路是指所确定的中继始节点，与所述中继始节点的下级节点之间的链路；所述数据收发单元还用于当接收到所述中继始节点的下级节点发送的响应信号时，通过所述第一通信单元广播带有中继链路的传送恢复指令；所述数据收发单元还用于接收传送暂停指令、传送恢复指令，并在接收到传送暂停指令时，对需要经过中继链路的数据帧暂停传送；还用于在接收到传送恢复指令时，对需要经过中继链路的数据帧恢复传送。6.根据权利要求3所述的总线扩展模组，其特征在于，所述主站扩展模块和从站扩展模块预先通信连接有远程管理平台，所述主站扩展模块和从站扩展模块还分别包括有链路状态分析单元；所述链路状态分析单元用于在所属节点的数据收发单元停止计时时，将所述中继始节点的下级节点作为中继终节点，生成带有计时时长、计时属性、计时时段、中继始节点和中继终节点的链路状态信息，向所述远程管理平台发送所述链路状态信息；其中：所述链路状态分析单元用于在所述计时时长不大于指定时长时，确定计时属性为数据传送时长，将所述开始计时时的时间点、所述停止计时时的时间点作为计时时段的端点值；所述链路状态分析单元用于在所述计时时长大于指定时长时，确定计时属性为异常断连时长，将所述计时时长达到指定时长时所对应的时间点、所述停止计时时的时间点作为计时时段的端点值；所述远程管理平台用于接收并显示所述链路状态信息。7.根据权利要求6所述的总线扩展模组，其特征在于，所述链路状态分析单元还用于在计时时时长到达指定时长，且所属节点的数据收发单元未接收到中继终节点的反馈信息时，向所述远程管理平台发送异常排查请求；其中，所述异常排查请求至少包括从开始计时到到达指定时长时所对应的计时时段、中继始节点和中继终节点；所述远程管理平台用于在接收到异常排查请求时，生成并显示异常排查方案，并确定是否存在第一链路状态信息，若存在，则在所述异常排查方案中添加与链路异常相对应的内容；若不存在，则在所述异常排查方案中添加与链路、节点异常相对应的内容；最终显示异常排查方案；其中，所述第一链路状态信息是指包含异常排查请求中的中继终节点、且对应的计时属性为数据传送时长、且计时时段与所述异常排查请求中的计时时段存在交集的链路状态信息。8.根据权利要求6所述的总线扩展模组，其特征在于，所述远程管理平台用于每隔预设时长，基于预设时长内所接收到的链路状态信息，为每一节点生成时间调整表，将所述时间调整表发送至对应节点，以使得对应节点的数据收发单元按照所述时间调整表调整所述指定时长的具体数值；其中，所述时间调整表包括若干个时间段，以及每一时间段所对应的指定时长值；且每一节点所对应时间调整表中的所有时间段的总和即为预设时长。9.根据权利要求1所述的总线扩展模组，其特征在于，所有所述主站扩展模块和从站扩展模块还分别包括内存管理单元，所述内存管理单元用于存储数据帧，并实时将内存数据上传至预先通信连接的远程管理平台；所述远程管理平台用于每隔指定周期，基于每一内存管理单元实时上传的内存数据，生成并显示每一内存管理单元的内存调整方案。10.一种总线扩展模组的通信方法，应用于如权利要求3所述的总线扩展模组，其特征在于，包括：主站扩展模块与上位机之间、主站扩展模块与其直连的从站扩展模块之间、相互直连的从站扩展模块之间、从站扩展模块与其直连的工业设备之间进行实时通信和数据交互；当所述主站扩展模块或所述从站扩展模块接收到数据帧时，数据收发单元基于所述数据帧中的源节点和目的节点，确定传送所述数据帧的通信链路、中继始节点、中继始节点所对应的上级节点和下级节点；所述数据收发单元存储所述数据帧，并向所述上级节点发送所述反馈信息，以使得所述上级节点删除所述数据帧；并将所述数据帧传送给所述下级节点，当接收到所述下级节点所发出的所述反馈信息时，删除所述数据帧。
说明书desc
技术领域本申请涉及总线通信技术领域，尤其是涉及一种总线扩展模组及使用该总线扩展模组的通信方法。背景技术随着工业设备远程智能化控制水平的不断提高，工业设备数据的采集变得尤为重要；目前，用于远程获取工业设备数据的一种通信方式为：将IO扩展模块与工业设备电连接，同时IO扩展模块还电连接计算机或者PLC，在实施中，通过IO扩展模块作为中介来获取与之连接的工业设备的数据，然后将对应的数据发送至上位机，从而便于上位机对获取的工业设备的数据进行进一步的处理。但对于一些特殊应用场景，如带有大量工业设备的工业生产线，上位机需要与上述所有工业设备进行通信连接，才能实现对工业设备数据的采集和处理，但是上位机自身所携带的、用于与IO扩展模块通信连接的接口数量是有限的，因此上述通信方式无法适用于对大规模大数量的工业设备的远程控制。发明内容为了实现上位机对大量工业设备的远程通信，本申请提供一种总线扩展模组及使用该总线扩展模组的通信方法。第一方面，本申请提供了一种总线扩展模组，采用如下的技术方案：一种总线扩展模组，包括主站扩展模块和从站扩展模块，所述主站扩展模块通信连接于上位机；所述从站扩展模块与工业设备对应设置，且所述从站扩展模块通信连接于对应的工业设备，以用于采集工业设备数据；所述主站扩展模块和从站扩展模块分别包括第一通信单元，所述第一通信单元用于建立主站扩展模块与从站扩展模块之间的通信；所述从站扩展模块中的第一通信单元还用于建立所属从站扩展模块与其他任意从站扩展模块之间的通信和数据交互。通过采用上述技术方案，主站扩展模块用于与上位机通信连接，从而在通信过程中实现与上位机之间的数据传送，从站扩展模块可以与工业设备一一对应设置，以用于采集对应工业设备的数据，而第一通信单元则实现了主站扩展模块与从站扩展模块之间的通信和数据交互，且需要强调的是，从站扩展模块可以与主站扩展模块直连通信，也可以通过其他从站扩展模块来实现与主站扩展模块的间接通信，因为从站扩展模块中所包含的第一通信单元可实现不同从站扩展模块之间的通信连接，即可以使得主站扩展模块与从站扩展模块之间的连接关系形成树状拓扑连接结构。该通信连接的方式的好处是：当主站扩展模块的直连物理接口有限，以使得主站扩展模块只能与指定数量的从站扩展模块进行直连时，可通过从站扩展模块，以转发的方式来将数据传送给其他从站扩展模块，实现上位机与所有工业设备的通信。可选的，所述从站扩展模块和主站扩展模块还包括第二通信单元，所述从站扩展模块和主站扩展模块通过第二通信单元通信连接有远程管理平台，所述从站扩展模块用于将所采集的工业设备数据传送至远程管理平台。通过采用上述技术方案，当从站扩展模块采集到工业设备数据之后，可采用如下两种传送方式来将工业设备数据传送给上位机，其一为：从站扩展模块将采集的工业设备数据回传至主站扩展模块，再由主站扩展模块回传给上位机；其二为：也通过从站扩展模块所对应的第二通信单元无线传送给远程管理平台，远程管理平台可搭载于上位机；前述的第二种传送方式更加适用于回传链路较长的场景中，以提高数据传送效率。可选的，所述主站扩展模块和从站扩展模块分别预存储有若干预设的通信链路，其中，所述通信链路包括以节点形式存在的从站扩展模块和/或主站扩展模块；所述主站扩展模块和从站扩展模块分别包括数据收发单元；所述数据收发单元用于在接收到数据帧时，将所属节点确定为中继始节点，并存储所述数据帧；还用于基于所述数据帧中的源节点和目的节点，确定所述中继始节点所对应的上级节点和下级节点，将所述数据帧转发至下级节点，并向上级节点发送反馈信息，以使得上级节点删除所述数据帧；还用于在接收到所述中继始节点的下级节点所发出的反馈信息后，删除数据帧。通过采用上述技术方案，数据帧在某一通信链路上进行传送时，主要是由该通信链路上的各节点按照通信连接关系，以及数据帧中的源节点和目的节点，按照对应的数据传送顺序来传送数据帧；其中，示例性的，假设某一数据链路包括4个节点A、B、C、D；A与B直连，B与C直连，C与D直连，当A作为源节点向D发送数据帧时，D即为目的节点，那么按照上述4个节点的连接关系，则需要A将数据帧传给B，再由B转发给C，最后由C转发给D；相应的，在此过程中，对于节点B来说，A即为B的上级节点，C即为B的下级节点。此外，结合上述方案可知，本申请在将数据帧转发至下级节点的同时还将存储对应的数据帧，只有在接收到下级节点发出的反馈信息时，才会将暂存的数据帧删除，而下级节点发出反馈信息则说明下级节点已经顺利接收到数据帧，实现数据帧的稳定传送。可选的，所述数据收发单元用于在向所述中继始节点的下级节点发送数据帧时，开始计时，直至接收到所述中继始节点的下级节点的反馈信息时，停止计时；还用于当计时时长达到指定时长，且未收到对应下级节点的反馈信息时，实时向所述中继始节点的下级节点发送续连信号，直至接收到所述中继始节点的下级节点发送的响应信号时，停止计时、停止发送续连信号，再次重复前述向所述中继始节点的下级节点发送所述数据帧并开始计时的步骤。通过采用上述技术方案，基于接收到下级节点的反馈信息时的计时时长来确定下级节点是否异常，若计时时长超过指定时长，则可判定下级节点为异常，此时将向下级节点实时发送续连信息，以便在下级节点恢复正常后，重新向下级节点发送数据帧，并开始计时，并重复前述判断计时时长的步骤，直至接收到反馈信息或续连信息时停止计时，由此可知，满足以下任意条件即停止计时，条件一为接收到反馈信息，条件二是异常之后接收到响应信号。可选的，所述数据收发单元还用于在向所述中继始节点的下级节点实时发送续连信号时，确定中继链路，通过所述第一通信单元广播带有中继链路的传送暂停指令；其中，所述中继链路是指所确定的中继始节点，与所述中继始节点的下级节点之间的链路；所述数据收发单元还用于当接收到所述中继始节点的下级节点发送的响应信号时，通过所述第一通信单元广播带有中继链路的传送恢复指令；所述数据收发单元还用于接收传送暂停指令和传送恢复指令，并在接收到传送暂停指令时，对需要经过中继链路的数据帧暂停传送；还用于在接收到传送恢复指令时，对需要经过中继链路的数据帧恢复传送。通过采用上述技术方案，中继始节点在向其对应的下级节点发送了数据帧之后，如若在计时时长超过指定时长后还未接收到来自中继始节点的下级节点的响应信号，则说明该下级节点和/或对应的中继链路疑似异常，那么此时，则以广播的形式通知所有主站扩展模块和从站扩展模块，对需要经过上述中继链路的数据帧暂停传送，从而减轻各节点的内存压力。可选的，所述主站扩展模块和从站扩展模块预先通信连接有远程管理平台，所述主站扩展模块和从站扩展模块还分别包括有链路状态分析单元；所述链路状态分析单元用于在所属节点的数据收发单元停止计时时，将所述中继始节点的下级节点作为中继终节点，生成带有计时时长、计时属性、计时时段、中继始节点和中继终节点的链路状态信息，向所述远程管理平台发送所述链路状态信息；其中：所述链路状态分析单元用于在所述计时时长不大于指定时长时，确定计时属性为数据传送时长，将所述开始计时时的时间点、所述停止计时时的时间点作为计时时段的端点值；所述链路状态分析单元用于在所述计时时长大于指定时长时，确定计时属性为异常断连时长，将所述计时时长达到指定时长时所对应的时间点、所述停止计时时的时间点作为计时时段的端点值；所述远程管理平台用于接收并显示所述链路状态信息。通过采用上述技术方案，计时时长是指通信链路中的任意两个节点之间成功传送数据时所用的时长，其可用于反应上述两个节点之间的链路状态，若计时属性为数据传送时长，则该计时时长反应的即为无异常状态时，节点之间的数据传送时长，以及两个节点之间的链路的数据传送速度和效率；若计时属性为异常断连时长，则此时计时时长即可反应异常时的修复、重新连接所耗费的时长。可选的，所述链路状态分析单元还用于在计时时时长到达指定时长，且所属节点的数据收发单元未接收到中继终节点的反馈信息时，向所述远程管理平台发送异常排查请求；其中，所述异常排查请求至少包括从开始计时到到达指定时长时所对应的计时时段、中继始节点和中继终节点；所述远程管理平台用于在接收到异常排查请求时，生成并显示异常排查方案，并确定是否存在第一链路状态信息，若存在，则在所述异常排查方案中添加与链路异常相对应的内容；若不存在，则在所述异常排查方案中添加与链路、节点异常相对应的内容；最终显示异常排查方案；其中，所述第一链路状态信息是指包含异常排查请求中的中继终节点、且对应的计时属性为数据传送时长、且计时时段与所述异常排查请求中的计时时段存在交集的链路状态信息。通过采用上述技术方案，若中继始节点无法接收到中继终节点的反馈信息，则认为存在异常，而结合上述方案可知，本申请将异常原因分为了两类，其一是：中继终节点无异常、中继终节点与中继始节点之间的链路异常，其二是由于中继终节点、中继终节点与中继始节点之间的链路存在异常；通过确定异常原因来生成异常排查方案，以帮助操作人员排查异常位置和异常原因。可选的，所述远程管理平台用于每隔预设时长，基于预设时长内所接收到的链路状态信息，为每一节点生成时间调整表，将所述时间调整表发送至对应节点，以使得对应节点的数据收发单元按照所述时间调整表调整所述指定时长的具体数值；其中，所述时间调整表包括若干个时间段，以及每一时间段所对应的指定时长值；且每一节点所对应时间调整表中的所有时间段的总和即为预设时长。通过采用上述技术方案，当节点和链路均处于可正常传送数据的状态时，由于不同时刻时，节点所需传送的数据帧数量以及数据帧大小不定，相应的，当中继终节点接收到的数据帧数量越多、数据帧大小越大时，中继终节点向中继始节点回传反馈信息的速度也将变慢，相应的，计时时长也将被拉长，因此，可根据此种情况来适应性的调整指定时长的具体数值，以便更为准确地确定计时属性；具体的，本申请基于历史时期所得到的链路状态信息中的计时时段和计时属性来确定预设时长。可选的，所有所述主站扩展模块和从站扩展模块还分别包括内存管理单元，所述内存管理单元用于存储数据帧，并实时将内存数据上传至预先通信连接的远程管理平台；所述远程管理平台用于每隔指定周期，基于每一内存管理单元的内存管理单元实时上传的内存数据，生成并显示每一内存管理单元的内存调整方案。通过采用上述技术方案，主站扩展模块和从站扩展模块在不同时刻所接收到的的数据帧数量、数据帧字节大小不同，相应的，由于数据帧需要暂存于内存管理单元内，为了确保内存管理单元的内存能够实时满足存储需要，可定期根据内存管理单元的内存数据来确定是否需要扩增。第二方面，本申请提供了一种总线扩展模组的通信方法，采用如下的技术方案：主站扩展模块与上位机之间、主站扩展模块与其直连的从站扩展模块之间、相互直连的从站扩展模块之间、从站扩展模块与其直连的工业设备之间进行实时通信和数据交互；当所述主站扩展模块或所述从站扩展模块接收到数据帧时，数据收发单元基于所述数据帧中的源节点和目的节点，确定传送所述数据帧的通信链路、中继始节点、中继始节点所对应的上级节点和下级节点；所述数据收发单元存储所述数据帧，并向所述上级节点发送所述反馈信息，以使得所述上级节点删除所述数据帧；并将所述数据帧传送给所述下级节点，当接收到所述下级节点所发出的所述反馈信息时，删除所述数据帧。综上所述，本申请包括以下有益技术效果：在本申请中，总线扩展模组包括主站扩展模块和若干个从站扩展模块，将主站扩展模块实现与上位机的直连通信，将从站扩展模块一一对应地与工业设备相连；将从站扩展模块以直接或间接的形式与主站扩展模块相连接，且使得主站扩展模块与从站扩展模块之间形成树状拓扑连接结构，从而实现主站扩展模块与从站扩展模块之间、从站扩展模块与从站扩展模块之间的通信连接关系；此外，从站扩展模块具有采集工业设备工作数据的功能，以及数据转发功能，从而最终实现上位机与所有工业设备之间的数据交互，此外，主站扩展模块和从站扩展模块还具有自动分配地址功能、自动分析链路状态异常与否的功能。附图说明为了更清楚地说明本发明申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本申请实施例中公开的主站扩展模块与从站扩展模块之间的通信连接结构的结构框图。图2是本申请实施例中用于体现主站扩展模块和从站扩展模块的硬件架构图。图3是本申请实施例中用于体现主站扩展模块和从站扩展模块的具体功能的软件架构图。图4是本申请实施例中的数据传送单元传送数据帧时的流程示意图。附图标记说明：1、主站扩展模块；11、站号分配单元；12、数据收发单元；13、链路状态分析单元；14、第一通信单元；15、内存管理单元；16、第二通信单元；2、从站扩展模块；22、数据采集单元；3、远程管理平台。实施方式以下结合附图1-4对本申请作进一步详细说明。本申请实施例公开一种总线扩展模组。参照图1，总线扩展模组包括主站扩展模块1和从站扩展模块2，主站扩展模块1用于与上位机直连，实现与上位机实现通信和数据交互，从站扩展模块2用于直接或间接地与主站扩展模块1相连，具体连接结构可以为如图1所示的树形拓扑结构，且从站扩展模块2与工业设备一一对应设置，以用于采集对应工业设备的工作数据，并将该工作数据回传给主站扩展模块1，再由主站扩展模块1反馈给上位机；上述树形拓扑结构的连接方式能够在主站扩展模块1的直连接口数量有限的情况下，实现上位机与所有从站扩展模块2的通信。具体的，参照图1和图2，主站扩展模块1和从站模块均包括板卡、设置在板卡上的MCU，与MCU电连接的电源；其中主站扩展模块1还设有SPI接口，SPI接口为主站扩展模块1与上位机进行物理直连的接口，上位机具体可以为单片机、PLC或者PC等。当上位机插接在SPI接口上时，需要对上位机进行初始化，从而使得上位机与主站扩展模块1之间实现数据交互，相应的，上位机初始化的步骤如下：S11、使能SPI时钟。S12、配置SPI信息。其中，需要配置的SPI信息包括通信方式、主从模式、时钟极性与相位、NSS控制方式以及帧格式。在本申请实施例中，通信方式选择全双工；主从模式选择主模式；时钟极性与相位为空闲时为低电平，在第二跳变沿进行采样；NSS控制方式选择为软件控制；帧格式选择为8位。S13、使能SPI。S14、判断SPI是否初始化成功，若否则重新从S11开始执行；若是，则表征SPI初始化成功。参照图2和图3，主站扩展模块1和从站扩展模块2包括第一通信单元14，第一通信单元14通信连接于MCU，相应的，主站扩展模块1和从站扩展模块2的板卡上均设置有与第一通信单元14相对应的通信接口，通信接口为用于实现主站扩展模块与从站扩展模块物理直连，或实现从站扩展模块与其他从站扩展模块物理直连的硬件接口；且在本实施例中，每一主站扩展模块1的板卡为2通道板卡，即主站扩展模块1包括两个通信接口，每一从站扩展模块2包括2或3个通信接口。本实施例中，主站扩展模块1上的每个通道对应可连接4-8个从站扩展模块2。此外，主站扩展模块1和从站扩展模块2的MCU还通信连接有LED提示灯，以起到提示作用，如在通电时亮灯，或通过不同的灯光颜色来表面当前的工作状态，如正常工作时亮绿灯，异常时亮红灯等。参照图2和图3，当主站扩展模块1和从站扩展模块2上电之后，为了便于对从站扩展模块2进行区分，主站扩展模块1和从站扩展模块2均包括站号分配单元11，站号分配单元11用于在主站扩展模块1和从站扩展模块2上电之后，对直连的主站扩展模块1、从站扩展模块2分配通信地址，也即站号，站号可用于表征主站扩展模块1和从站扩展模块2的通信地址。参照图2和图3，主站扩展模块1和从站扩展模块2还包括第二通信单元16，第二通信单元16通信连接有远程管理平台3。从站扩展模块2还包括数据采集单元22，数据采集单元22用于定期对所属从站扩展模块2直连的工业设备进行数据采集，并通过第二通信单元16来将采集后的数据传送至远程管理平台3，远程管理平台3用于存储并显示所采集的数据，且从站扩展模块2还设置有与远程管理平台3相对应的从站APP，操作人员可通过登录从站APP来访问远程管理平台3，从而获知所采集的工业设备数据。当主站扩展模块1和从站扩展模块2实现了通信连接之后，即可开始数据交互，而主站扩展模块1与从站扩展模块2之间的数据交互一般是基于数据帧进行的，也即主站扩展模块1与从站扩展模块2之间、从站扩展模块2相互之间发送数据帧。而结合图1可知，主站扩展模块1与从站扩展模块2之间的连接关系形成了多条供数据帧传送的通信链路，通信链路包含了数据帧传送过程中所经过的所有主站扩展模块1和从站扩展模块2；本申请在定义通信链路时，将通信链路中的上述主站扩展模块1和从站扩展模块2定义为节点，相应的，通信链路还包括任意两个节点之间的连接线路。所有主站扩展模块1和从站扩展模块2均包括内存管理单元15，所有通信链路被预先存储于内存管理单元15内。此外，数据帧的组成可以具体为：1byte的源节点站号和目的节点站号、1byte的命令、1byte的帧类型、2byte的数据长度、nbyte的数据内容，以及2byte的校验码。参照图3和图4，主站扩展模块1和从站扩展模块2还分别包括数据收发单元12，顾名思义，数据收发单元12用于接收、发出数据帧，具体的收发步骤如图4所示，每当任一数据收发单元12接收到数据帧时，其先将数据帧暂存于所属节点的内存管理单元15中，并将所属的节点确定为中继始节点，然后根据数据帧中的源节点站号和目的节点站号，以及中继始节点所处的通信链路，确定出用于传输该数据帧的通信链路，再从确定出的通信链路中找到上级节点和下级节点，将该下级节点作为中继终节点。其中，上级节点和下级节点均是与中继始节点直接通信连接的节点，且在确定出的通信链路中，上级节点、中继始节点和下级节点三者沿着该数据帧的传送方向顺次分布。数据收发单元12用于将数据帧传送给中继终节点，并开始计时，与此同时，数据收发单元12还用于向上级节点发送反馈信息，以使上级节点的内存管理单元15在接收到反馈信息时，删除该数据帧；当数据收发单元12接收到来自中继终节点发出的反馈信息时，停止计时，并删除暂存的数据帧。即，每当数据收发单元12接收到任意数据帧时，会先将该数据帧暂存，待该数据收发单元12将该数据帧发送给对应的下级节点，且只有在收到来自下级节点的反馈信息时，才会删除原先暂存的数据帧。参照图4，数据收发单元12还用于在计时时长达到指定时长、且未收到对应中继终节点的反馈时，则认为数据传送失败，传送链路异常，此时数据收发单元12用于实时向中继终节点发送续连信号，直至接收到中继终节点回传的响应信号时，停止计时、停止发送续连信号，并再次重复前述步骤，即再次向中继终节点发送该数据帧并计时，直至接收到来自中继终节点的反馈信息时，停止计时。由上可知，计时时长可以用于反映传送数据帧的过程中是否出现异常，以及顺利传送数据帧时所需耗费的时长。具体的，若计时时长不大于指定时长，则认为传送数据帧的过程中并未出现异常，此时的计时时长即可反映数据帧被顺利传送时所耗费的时长，也可进一步用于说明中继始节点将数据帧发送至下级节点时的数据传送速度和效率。而若计时时长大于指定时长，则认为数据帧从中继始节点传送至中继终节点的过程中出现了卡顿、异常的情况，此时的计时时长则可用于说明异常修复、建立中继始节点与中继终节点之间重新建立通信所耗费的时长。相应的，参照图3，主站扩展模块1和从站扩展模块2还分别包括链路状态分析单元13，链路状态分析单元13用于在所属节点的数据收发单元12停止计时时，生成带有计时时长、计时属性、计时时段、中继始节点和中继终节点的链路状态信息，向远程管理平台3发送链路状态信息；其中：链路状态分析单元13用于：当计时时长不大于指定时长时，确定计时属性为数据传送时长，将开始计时时的时间点、停止计时时的时间点作为计时时段的两个端点值；即计时时段表示为：，时间点为0-24小时之内的任意时间点，且可以以X时X分的形式进行表示。链路状态分析单元13用于：当计时时长大于指定时长时，确定计时属性为异常断连时长，将计时时长达到指定时长时所对应的时间点、停止计时时的时间点作为计时时段的端点值；即计时时段表示为：。远程管理平台3用于接收并显示链路状态信息。链路状态分析单元13还用于在计时时时长达到指定时长，且所属节点的数据收发单元12还未接收到中继终节点的反馈信息时，向远程管理平台3发送异常排查请求，其中，异常排查请求至少包括从开始计时到计时时长达到指定时长时所对应的计时时段、中继始节点和中继终节点。远程管理平台3用于在接收到异常排查请求时，生成并显示异常排查方案，并确定是否存在第一链路状态信息，若存在，则在异常排查方案中添加与链路异常相对应的内容；若不存在，则在异常排查方案中添加与链路、节点异常相对应的内容；最终显示异常排查方案。其中，第一链路状态信息是指包含异常排查请求中的中继终节点、且对应的计时属性为数据传送时长、且计时时段与异常排查请求中的计时时段存在交集的链路状态信息。示例性的，假设远程管理平台3所接收到的异常排查请求中的计时时段为，对应的中继始节点为A，中继终节点为B；又存在一个链路状态信息，其对应的计时属性为数据传送时长，对应的计时时段为，对应的中继始节点为B，对应的中继终节点为C，那么该链路状态信息即为第一链路状态信息。此处需要解释的是，A向B传送数据帧，但在计时时长达到指定时长时还未接收到来自B的反馈信息，此时则认为数据传送链路出现了异常；而异常原因分为两类；其一是B节点自身出现异常，其二是A节点与B节点之间的通信链路出现了异常；为此，本申请特通过确定是否存在第二链路状态信息，来验证B是否出现异常，如若存在，则认为B没有问题，异常原因是链路异常，如若不存在，则说明B和/或链路都有可能出现了问题。结合上段所举例子可知，在期间， A并未收到来自B的反馈信息，但B却能成功向C传送数据帧，那么则说明B节点自身并不存在异常，而是A节点与B节点之间的通信链路出现了异常。参照图3，远程管理平台3用于每隔预设时长，基于预设时长内所接收到的链路状态信息，以及链路状态信息中的计时时段和计时属性，为每一节点生成时间调整表，将时间调整表发送至对应节点，以使得对应节点的数据收发单元12按照时间调整表调整指定时长；其中，时间调整表包括若干个时间段，以及每一时间段所对应的指定时长值；且每一节点所对应时间调整表中的所有时间段的总和即为预设时长。在实施中，本申请实施例中的预设时长具体可以为24小时，下文将计时属性为数据传送时长的链路状态信息简称为A信息，将计时属性为异常断连时长的链路状态信息简称为B信息。远程管理平台3对接收到的链路状态信息按照节点进行分类；对于同一节点的所有链路状态信息，远程管理平台3从所有A信息的计时时长中，找出最大计时时长；然后从预设时长中分割出与每一B信息中的计时时段相一致的时间段，将预设时长内除异常时段之外的时间作为正常时段，将最大计时时长作为正常时段时的指定时长值，而异常时段所对应的指定时长值为预设的指定时长值，以此实现对指定时长具体数值的适应性调整。示例性的，假设远程管理平台3在预设时长内接收到了Q节点所发出的所有链路状态信息如下：其中，A信息包括3条，其对应的计时时段分别为；B信息包括2条，其对应的计时时长分别为，；相应的，A信息的最大计时时长为4分钟，那么对于Q节点来说，其时间调整表中则包括了如下时间段，，，，；其中，、、这三个时间段所对应的指定时长值为4分钟，其余时段所对应的指定时长值为预设的指定时长值，即前文所示例性提到的5分钟。可选的，当某一节点或其所处的链路出现异常的情况时，如若其他节点仍然向异常节点或异常链路传送数据帧，则易导致异常节点或异常链路的上级节点所存储的数据帧激增，甚至易导致内存超载的情况的发生，为此，本申请中的数据收发单元12还用于：在向中继终节点实时发送续连信号时，确定中继链路；通过第一通信单元14广播带有中继链路的传送暂停指令；还用于当接收到中继始节点的下级节点发送的响应信号时，通过第一通信单元14广播带有中继链路的传送恢复指令；其中，中继链路是指所确定的中继始节点、所确定的中继始节点的下级节点之间的链路；数据收发单元12还用于接收传送暂停指令和传送恢复指令，并在接收到传送暂停指令时，对需要经过目标中继链路的数据帧暂停传送；还用于在接收到传送恢复指令时，对需要经过目标中继链路的数据帧恢复传送。在实施中，示例性的，当任一数据收发单元向中继终节点发送续连信号时，E还将确定中继链路，中继链路即为中继始节点与中继终节点之间的通信连接线路，E再向其他所有节点发送带有传送暂停指令的广播帧，传送暂停指令至少包括该中继链路；而当E接收到中继终节点发送的响应信号时，E再向其他所有节点发送带有传送恢复指令的广播帧，传送恢复指令中至少包括该中继链路。相应地，当其他节点的数据收发单元12接收到带有传送暂停指令或传送恢复指令的广播帧时，数据收发单元12将从生成或接收到的所有数据帧中，确定每一数据帧的通信链路，再确定中继链路是否存在于前述通信链路中，若存在，则筛选出该数据帧，最后对该数据帧执行暂停传送或恢复传送的操作。可选的，内存管理单元15还用于存储数据帧以及数据帧所占用的内存量，内存管理单元15还用于实时将内存量数据传送至预先通信连接的远程管理平台3；远程管理平台3用于每隔指定周期，基于每一节点的内存管理单元15实时上传的内存数据，生成并显示每一节点的内存调整方案。在实施中，远程管理平台3将实时接收来自各节点的内存管理单元15所上传的内存数据，并每隔指定周期，确定指定周期内所获取的各节点的所有内存数据中的最大内存数据，基于各节点对应的最大内存数据，若存在目标节点，其对应的最大内存数据与该目标节点的内存管理单元15的预设内存阈值之间的内存差值小于预设差值，则为该目标节点计算对应的理想内存阈值，理想内存阈值=目标节点的最大内存数据+预设差值，再将理想内存阈值添加至该目标节点的内存调整方案中，以使得操作人员基于所显示的内存调整方案，更换目标节点的内存管理单元15，以使得内存管理单元15的预设内存阈值得以扩增至与理想内存阈值相一致。本申请还公开了一种总线扩展模组的通信方法，包括如下步骤：主站扩展模块1与上位机之间、主站扩展模块1与其直连的从站扩展模块2之间、相互直连的从站扩展模块2之间、从站扩展模块2与其直连的工业设备之间进行实时通信和数据交互；当主站扩展模块1或从站扩展模块2接收到数据帧时，数据收发单元12基于数据帧中的源节点和目的节点，确定传送数据帧的通信链路、中继始节点、中继始节点所对应的上级节点和下级节点；数据收发单元12存储所述数据帧，并向上级节点发送反馈信息，以使得上级节点删除数据帧；并将数据帧传送给下级节点，当接收到下级节点所发出的反馈信息时，删除数据帧。本申请实施例还公开一种计算机可读存储介质，其存储有能够被处理器加载并执行如上述的总线扩展模组的通信方法的计算机程序，该计算机可读存储介质例如包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。以上实施例仅用以说明本申请的技术方案，而非对申请的保护范围进行限制。显然，所描述的实施例仅仅是本申请部分实施例，而不是全部实施例。基于这些实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请所要保护的范围。
