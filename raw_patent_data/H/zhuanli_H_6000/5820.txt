标题title
基于区块链的医疗信息共享系统及方法
摘要abst
本申请提供一种基于区块链的医疗信息共享系统及方法，该系统包括信息共享应用、区块链接入层和智能合约。信息共享应用用于根据第一私钥对预设请求携带的上传数据进行签名得到第一签名，根据第二私钥对上传数据进行签名得到第二签名，将上传数据、第一签名和第二签名发送至区块链接入层；区块链接入层用于若第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名，将上传数据、第一签名和第三签名发送至智能合约。智能合约用于若第一签名和第三签名验签通过，则响应预设请求执行相关操作。通过本申请，预设请求被响应的前提是上传数据来源合法且没有被篡改，以及预设请求的发起者具备操作权限，从而进一步提高数据安全性。
权利要求书clms
1.一种基于区块链的医疗信息共享系统，其特征在于，所述基于区块链的医疗信息共享系统包括信息共享应用、区块链接入层和智能合约；所述信息共享应用用于根据第一私钥对预设请求携带的上传数据进行签名得到第一签名，根据第二私钥对上传数据进行签名得到第二签名，将上传数据、第一签名和第二签名发送至所述区块链接入层，其中，第一私钥由预设请求的发起者提供，第二私钥预置于所述信息共享应用；所述区块链接入层用于根据上传数据和第二公钥对第二签名进行验签，若第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名，将上传数据、第一签名和第三签名发送至所述智能合约，其中，第二公钥和第三私钥预置于所述区块链接入层；所述智能合约用于根据上传数据和第三公钥对第三签名进行验签，若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作，其中，第三公钥和目标公钥预置于所述智能合约。2.如权利要求1所述的基于区块链的医疗信息共享系统，其特征在于，当预设请求为病历上传请求时，上传数据为病历数据，目标公钥为病历数据的所有者公钥；所述智能合约用于若第三签名验签通过，则根据病历数据中的患者信息从所有已注册患者的公钥中确定病历数据的所有者公钥，根据病历数据及其所有者公钥对第一签名进行验签，若第一签名验签通过，则存储病历数据，其中，所有已注册患者的公钥预置于所述智能合约。3.如权利要求1所述的基于区块链的医疗信息共享系统，其特征在于，当预设请求为病历授权请求时，上传数据为病历标识和待授权公钥，目标公钥为病历标识对应的目标病历数据的所有者公钥；所述智能合约用于若第三签名验签通过，则根据病历标识和目标病历数据的所有者公钥对第一签名进行验签，若第一签名验签通过，且待授权公钥为已注册医生的公钥，则将待授权公钥标记为目标病历数据的授权者公钥，其中，目标病历数据的所有者公钥和所有已注册医生的公钥预置于所述智能合约。4.如权利要求3所述的基于区块链的医疗信息共享系统，其特征在于，当预设请求为病历查看请求时，上传数据为病历标识，目标公钥为病历标识对应的目标病历数据的所有者公钥和授权者公钥；所述智能合约用于若第三签名验签通过，则根据病历标识及目标病历数据的所有者公钥和授权者公钥对第一签名进行验签，若第一签名验签通过，则将目标病历数据通过所述区块链接入层和所述信息共享应用返回至病历查看请求的发起者。5.如权利要求4所述的基于区块链的医疗信息共享系统，其特征在于，所述智能合约用于根据第一签名和病历标识计算得到第一公钥，若第一公钥为目标病历数据的所有者公钥或授权者公钥，则第一签名验签通过。6.如权利要求1至5中任一项所述的基于区块链的医疗信息共享系统，其特征在于，所述智能合约还用于根据第四私钥对下发数据进行签名得到第四签名，将下发数据和第四签名返回至所述区块链接入层，其中，第四私钥预置于所述智能合约；所述区块链接入层还用于根据下发数据和第四公钥对第四签名进行验签，若第四签名验签通过，则根据第三私钥对下发数据进行签名得到第五签名，将下发数据和第五签名返回至所述信息共享应用，其中，第四公钥预置于所述区块链接入层；所述信息共享应用还用于根据下发数据和第三公钥对第五签名进行验签，若第五签名验签通过，则针对下发数据执行相关操作，其中，第三公钥预置于所述信息共享应用。7.如权利要求6所述的基于区块链的医疗信息共享系统，其特征在于，所述信息共享应用还用于根据对称密钥对上传数据、第一签名和第二签名进行加密，以将上传数据、第一签名和第二签名以密文形式发送至所述区块链接入层，其中，对称密钥预置于所述信息共享应用；所述区块链接入层还用于根据对称密钥对密文形式的上传数据、第一签名和第二签名进行解密，其中，对称密钥预置于所述区块链接入层；所述区块链接入层还用于根据对称密钥对下发数据和第五签名进行加密，以将下发数据和第五签名以密文形式返回至所述信息共享应用；所述信息共享应用还用于根据对称密钥对密文形式的下发数据和第五签名进行解密。8.如权利要求7所述的基于区块链的医疗信息共享系统，其特征在于，所述信息共享应用还用于生成临时公私钥对，将临时公私钥对的公钥发送至所述区块链接入层；所述区块链接入层还用于生成对称密钥，根据临时公私钥对的公钥对对称密钥进行加密，加密后将密文形式的对称密钥返回至所述信息共享应用；所述信息共享应用还用于根据临时公私钥对的私钥对密文形式的对称公钥进行解密，解密后销毁临时公私钥对。9.如权利要求1至5中任一项所述的基于区块链的医疗信息共享系统，其特征在于，所述区块链接入层还用于验证上传数据、第一签名和第二签名对应的数据包的源IP，其中，若源IP与所述信息共享应用的IP一致，且第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名。10.一种基于区块链的医疗信息共享方法，其特征在于，应用于包括信息共享应用、区块链接入层和智能合约的基于区块链的医疗信息共享系统，所述基于区块链的医疗信息共享方法包括：所述信息共享应用根据第一私钥对预设请求携带的上传数据进行签名得到第一签名，根据第二私钥对上传数据进行签名得到第二签名，将上传数据、第一签名和第二签名发送至所述区块链接入层，其中，第一私钥由预设请求的发起者提供，第二私钥预置于所述信息共享应用；所述区块链接入层根据上传数据和第二公钥对第二签名进行验签，若第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名，将上传数据、第一签名和第三签名发送至所述智能合约，其中，第二公钥和第三私钥预置于所述区块链接入层；所述智能合约根据上传数据和第三公钥对第三签名进行验签，若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作，其中，第三公钥和目标公钥预置于所述智能合约。
说明书desc
技术领域本申请涉及区块链技术领域，具体涉及一种基于区块链的医疗信息共享系统及方法。背景技术当前，对于各级医院的医联体设计建设中，分级诊疗改革的实现以及优化医疗资源区域分布的均衡性都是亟需解决的问题。此外，各家医院内部的诊疗数据都遵循数据不出院的原则，因此，无法有效在多家医院之间共享医疗诊断数据，避免一病多诊等重复性的医疗资源浪费问题。相关技术中，在医疗信息共享系统中应用区块链技术，一方面，基于区块链技术的安全性、不可篡改性等，达到医联体内多家医院的数据共享目的，从而避免一病多诊的医疗资源浪费。另一方面，依靠区块链技术，达到数据的去中心化目的，提高数据的安全性与真实性。然而，现有的基于区块链的医疗信息共享系统在数据安全部分设计存在不足，无法保证数据在传输过程中的安全，也无法保证针对数据的操作具有相应的操作权限。发明内容本申请提供一种基于区块链的医疗信息共享系统及方法，可以解决现有技术中存在的基于区块链的医疗信息共享系统无法保证数据在传输过程中的安全，也无法保证针对数据的操作具有相应的操作权限的技术问题。第一方面，本申请实施例提供一种基于区块链的医疗信息共享系统，所述基于区块链的医疗信息共享系统包括信息共享应用、区块链接入层和智能合约；所述信息共享应用用于根据第一私钥对预设请求携带的上传数据进行签名得到第一签名，根据第二私钥对上传数据进行签名得到第二签名，将上传数据、第一签名和第二签名发送至所述区块链接入层，其中，第一私钥由预设请求的发起者提供，第二私钥预置于所述信息共享应用；所述区块链接入层用于根据上传数据和第二公钥对第二签名进行验签，若第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名，将上传数据、第一签名和第三签名发送至所述智能合约，其中，第二公钥和第三私钥预置于所述区块链接入层；所述智能合约用于根据上传数据和第三公钥对第三签名进行验签，若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作，其中，第三公钥和目标公钥预置于所述智能合约。进一步地，一实施例中，当预设请求为病历上传请求时，上传数据为病历数据，目标公钥为病历数据的所有者公钥；所述智能合约用于若第三签名验签通过，则根据病历数据中的患者信息从所有已注册患者的公钥中确定病历数据的所有者公钥，根据病历数据及其所有者公钥对第一签名进行验签，若第一签名验签通过，则存储病历数据，其中，所有已注册患者的公钥预置于所述智能合约。进一步地，一实施例中，当预设请求为病历授权请求时，上传数据为病历标识和待授权公钥，目标公钥为病历标识对应的目标病历数据的所有者公钥；所述智能合约用于若第三签名验签通过，则根据病历标识和目标病历数据的所有者公钥对第一签名进行验签，若第一签名验签通过，且待授权公钥为已注册医生的公钥，则将待授权公钥标记为目标病历数据的授权者公钥，其中，目标病历数据的所有者公钥和所有已注册医生的公钥预置于所述智能合约。进一步地，一实施例中，当预设请求为病历查看请求时，上传数据为病历标识，目标公钥为病历标识对应的目标病历数据的所有者公钥和授权者公钥；所述智能合约用于若第三签名验签通过，则根据病历标识及目标病历数据的所有者公钥和授权者公钥对第一签名进行验签，若第一签名验签通过，则将目标病历数据通过所述区块链接入层和所述信息共享应用返回至病历查看请求的发起者。进一步地，一实施例中，所述智能合约用于根据第一签名和病历标识计算得到第一公钥，若第一公钥为目标病历数据的所有者公钥或授权者公钥，则第一签名验签通过。进一步地，一实施例中，所述智能合约还用于根据第四私钥对下发数据进行签名得到第四签名，将下发数据和第四签名返回至所述区块链接入层，其中，第四私钥预置于所述智能合约；所述区块链接入层还用于根据下发数据和第四公钥对第四签名进行验签，若第四签名验签通过，则根据第三私钥对下发数据进行签名得到第五签名，将下发数据和第五签名返回至所述信息共享应用，其中，第四公钥预置于所述区块链接入层；所述信息共享应用还用于根据下发数据和第三公钥对第五签名进行验签，若第五签名验签通过，则针对下发数据执行相关操作，其中，第三公钥预置于所述信息共享应用。进一步地，一实施例中，所述信息共享应用还用于根据对称密钥对上传数据、第一签名和第二签名进行加密，以将上传数据、第一签名和第二签名以密文形式发送至所述区块链接入层，其中，对称密钥预置于所述信息共享应用；所述区块链接入层还用于根据对称密钥对密文形式的上传数据、第一签名和第二签名进行解密，其中，对称密钥预置于所述区块链接入层；所述区块链接入层还用于根据对称密钥对下发数据和第五签名进行加密，以将下发数据和第五签名以密文形式返回至所述信息共享应用；所述信息共享应用还用于根据对称密钥对密文形式的下发数据和第五签名进行解密。进一步地，一实施例中，所述信息共享应用还用于生成临时公私钥对，将临时公私钥对的公钥发送至所述区块链接入层；所述区块链接入层还用于生成对称密钥，根据临时公私钥对的公钥对对称密钥进行加密，加密后将密文形式的对称密钥返回至所述信息共享应用；所述信息共享应用还用于根据临时公私钥对的私钥对密文形式的对称公钥进行解密，解密后销毁临时公私钥对。进一步地，一实施例中，所述区块链接入层还用于验证上传数据、第一签名和第二签名对应的数据包的源IP，其中，若源IP与所述信息共享应用的IP一致，且第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名。第二方面，本申请实施例还提供一种基于区块链的医疗信息共享方法，应用于包括信息共享应用、区块链接入层和智能合约的基于区块链的医疗信息共享系统，所述基于区块链的医疗信息共享方法包括：所述信息共享应用根据第一私钥对预设请求携带的上传数据进行签名得到第一签名，根据第二私钥对上传数据进行签名得到第二签名，将上传数据、第一签名和第二签名发送至所述区块链接入层，其中，第一私钥由预设请求的发起者提供，第二私钥预置于所述信息共享应用；所述区块链接入层根据上传数据和第二公钥对第二签名进行验签，若第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名，将上传数据、第一签名和第三签名发送至所述智能合约，其中，第二公钥和第三私钥预置于所述区块链接入层；所述智能合约根据上传数据和第三公钥对第三签名进行验签，若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作，其中，第三公钥和目标公钥预置于所述智能合约。本申请中，第二签名验签通过说明区块链接入层接收的上传数据来源于信息共享应用且没有被篡改，第三签名验签通过说明智能合约接收的上传数据来源于区块链接入层且没有被篡改，第一签名验签通过说明预设请求的发起者具备操作权限。通过本申请，预设请求被响应的前提是上传数据来源合法且没有被篡改，以及预设请求的发起者具备操作权限，从而进一步提高数据安全性。附图说明图1为本申请一实施例中基于区块链的医疗信息共享系统的架构示意图；图2为本申请一实施例中数据上传的时序图；图3为本申请一实施例中数据下发的时序图；图4为本申请一实施例中对称密钥生成的时序图；图5为本申请一实施例中基于区块链的医疗信息共享方法的流程示意图。具体实施方式为了使本技术领域的人员更好地理解本申请方案，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。为使本申请的目的、技术方案和优点更加清楚，下面将结合附图对本申请实施方式作进一步地详细描述。第一方面，本申请实施例提供一种基于区块链的医疗信息共享系统。图1示出了本申请一实施例中基于区块链的医疗信息共享系统的架构示意图。参照图1，一实施例中，基于区块链的医疗信息共享系统包括信息共享应用、区块链接入层和智能合约。具体地，智能合约设置于区块链节点上，信息共享应用、区块链接入层和区块链节点均部署于各医联体的医院内部。医院内部系统中各科室独立的病历、诊断等数据经过信息共享应用传输至区块链接入层，然后经由区块链接入层传输至区块链节点上的智能合约内。操作信息共享应用的人员主要包括医院数据管理员、医生和患者，其中，患者的操作通常在医院数据管理员的指导下进行或由医院数据管理员代为进行。信息共享应用用于根据第一私钥对预设请求携带的上传数据进行签名得到第一签名，根据第二私钥对上传数据进行签名得到第二签名，将上传数据、第一签名和第二签名发送至区块链接入层，其中，第一私钥由预设请求的发起者提供，第二私钥预置于信息共享应用。具体地，预设请求的发起者主要包括医生和患者，预设请求携带的上传数据为病历、诊断等数据。第一私钥属于用户私钥，信息共享应用中不会保存第一私钥，在签名完毕后即删除记录，确保用户私钥的隐私性。区块链接入层用于根据上传数据和第二公钥对第二签名进行验签，若第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名，将上传数据、第一签名和第三签名发送至智能合约，其中，第二公钥和第三私钥预置于区块链接入层。智能合约用于根据上传数据和第三公钥对第三签名进行验签，若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作，其中，第三公钥和目标公钥预置于智能合约。本实施例中，第一签名用于表示预设请求的发起者的身份，第二签名和第三签名用于表示上传数据的来源。第二签名验签通过说明区块链接入层接收的上传数据来源于信息共享应用且没有被篡改，第三签名验签通过说明智能合约接收的上传数据来源于区块链接入层且没有被篡改，第一签名验签通过说明预设请求的发起者具备操作权限。通过本实施例，预设请求被响应的前提是上传数据来源合法且没有被篡改，以及预设请求的发起者具备操作权限，从而进一步提高数据安全性。此外，本实施例中的签名操作均在本地执行，不涉及私钥数据的传输，有助于降低私钥泄露风险，从而确保数据安全性。可选地，第二公私钥对和第三公私钥对由医院内部私下商议并保存，并进行定期更换，从而确保第二签名和第三签名对于数据合法来源的验证结果的可靠性。下面以医疗信息共享场景下常用的三种预设请求为例，即病历上传请求、病历授权请求和病历查看请求，进一步阐述本申请的细节。一实施例中，当预设请求为病历上传请求时，上传数据为病历数据，目标公钥为病历数据的所有者公钥。智能合约用于若第三签名验签通过，则根据病历数据中的患者信息从所有已注册患者的公钥中确定病历数据的所有者公钥，根据病历数据及其所有者公钥对第一签名进行验签，若第一签名验签通过，则存储病历数据，其中，所有已注册患者的公钥预置于智能合约。本实施例中，第一签名验签通过说明病历上传请求的发起者为病历数据的所有者，或者病历上传请求经过病历数据的所有者的同意，具备病历上传的操作权限。一实施例中，当预设请求为病历授权请求时，上传数据为病历标识和待授权公钥，目标公钥为病历标识对应的目标病历数据的所有者公钥。智能合约用于若第三签名验签通过，则根据病历标识和目标病历数据的所有者公钥对第一签名进行验签，若第一签名验签通过，且待授权公钥为已注册医生的公钥，则将待授权公钥标记为目标病历数据的授权者公钥，其中，目标病历数据的所有者公钥和所有已注册医生的公钥预置于智能合约。本实施例中，第一签名验签通过说明病历授权请求的发起者为病历数据的所有者，或者病历授权请求经过病历数据的所有者的同意，具备病历授权的操作权限。本实施例中除了验证请求发起者的操作权限外，还对待授权公钥对应的身份进行验证，需确保其授权者为已注册医生。具体地，病历标识包含于病历数据中，已注册医生的公钥对外公开，请求发起者可通过扫码等操作获取已注册医生的公钥作为待授权公钥。可选地，信息共享应用还用于供用户进行注册操作，在注册时生成用户公私钥对，注册完成后销毁用户公私钥对，其中，已注册用户的私钥由用户保管，已注册用户的公钥存储于智能合约。用户类型包括患者和医生。进一步地，一实施例中，当预设请求为病历查看请求时，上传数据为病历标识，目标公钥为病历标识对应的目标病历数据的所有者公钥和授权者公钥。智能合约用于若第三签名验签通过，则根据病历标识及目标病历数据的所有者公钥和授权者公钥对第一签名进行验签，若第一签名验签通过，则将目标病历数据通过区块链接入层和信息共享应用返回至病历查看请求的发起者。本实施例中，第一签名验签通过说明病历查看请求的发起者为病历数据的所有者或授权者，或者病历查看请求经过病历数据的所有者的同意，具备病历查看的操作权限。由于病历授权过程中已经确保授权者的身份为已注册医生，故本实施例中在请求发起者不为病历数据所有者的情况下，无需再验证请求发起者的身份是否为已注册医生，而是直接验证其是否为病历数据的授权者。可选地，为确保系统运行的安全性，可根据实际情况设置冗余验证环节。例如，先通过第一签名验证请求发起者的一般身份是否为已注册用户，再进一步验证其具体身份，避免所有者公钥或授权者公钥非常规途径标记所导致的数据安全隐患。进一步地，一实施例中，智能合约用于根据第一签名和病历标识计算得到第一公钥，若第一公钥为目标病历数据的所有者公钥或授权者公钥，则第一签名验签通过。常规的验签操作是使用公钥来对签名进行解密得到摘要A，使用哈希函数对原文进行哈希处理得到摘要B，对比摘要A和摘要B的内容。病历查看请求中对第一签名进行验签需要尝试从多个公钥中找出与第一私钥相匹配的公钥，若采用常规验签操作，除了多次比对外，还需要进行多次解密和哈希处理，运算量较大。通过本实施例，可通过一次反向计算和多次比对完成第一签名的验签，从而减少运算量，提高处理速度。示例地，用户公私钥对可通过椭圆曲线算法生成，其中公钥数据即可以由私钥数据经过椭圆曲线算法计算得到，还可以根据签名值的r、s、v三个数据以及原文经过椭圆曲线算法计算得到。进一步地，一实施例中，智能合约还用于根据第四私钥对下发数据进行签名得到第四签名，将下发数据和第四签名返回至区块链接入层，其中，第四私钥预置于智能合约。区块链接入层还用于根据下发数据和第四公钥对第四签名进行验签，若第四签名验签通过，则根据第三私钥对下发数据进行签名得到第五签名，将下发数据和第五签名返回至信息共享应用，其中，第四公钥预置于区块链接入层。信息共享应用还用于根据下发数据和第三公钥对第五签名进行验签，若第五签名验签通过，则针对下发数据执行相关操作，其中，第三公钥预置于信息共享应用。本实施例中，第四签名和第五签名用于表示下发数据的来源，第四签名验签通过说明区块链接入层接收的下发数据来源于智能合约且没有被篡改，第五签名验签通过说明信息共享应用接收的下发数据来源于区块链接入层且没有被篡改，从而进一步提高数据安全性。本实施例中的签名操作均在本地执行，不涉及私钥数据的传输，有助于降低私钥泄露风险，从而确保数据安全性。可选地，第二公私钥对、第三公私钥和第四公私钥对由医院内部私下商议并保存，并进行定期更换，从而确保第二签名至第五签名对于数据合法来源的验证结果的可靠性。图2示出了本申请一实施例中数据上传的时序图；图3示出了本申请一实施例中数据下发的时序图。进一步地，一实施例中，参照图2，信息共享应用还用于根据对称密钥对上传数据、第一签名和第二签名进行加密，以将上传数据、第一签名和第二签名以密文形式发送至区块链接入层，其中，对称密钥预置于信息共享应用。区块链接入层还用于根据对称密钥对密文形式的上传数据、第一签名和第二签名进行解密，其中，对称密钥预置于区块链接入层。参照图3，区块链接入层还用于根据对称密钥对下发数据和第五签名进行加密，以将下发数据和第五签名以密文形式返回至信息共享应用。信息共享应用还用于根据对称密钥对密文形式的下发数据和第五签名进行解密。本实施例中，对称密钥加密在SSL通信协议加密的基础上进行。由于信息共享应用涉及的通信包括内网通信和外网通信，通过对称密钥对信息共享应用与区块链接入层之间的数据传输进行额外加密，进一步提高数据安全性。区块链接入层和智能合约仅涉及内网通信，不需要额外加密。本实施例中的签名操作和加密操作均在本地执行，不涉及私钥数据的传输，有助于降低私钥泄露风险，从而确保数据安全性。图4示出了本申请一实施例中对称密钥生成的时序图。进一步地，一实施例中，参照图4，信息共享应用还用于生成临时公私钥对，将临时公私钥对的公钥发送至区块链接入层。区块链接入层还用于生成对称密钥，根据临时公私钥对的公钥对对称密钥进行加密，加密后将密文形式的对称密钥返回至信息共享应用。信息共享应用还用于根据临时公私钥对的私钥对密文形式的对称公钥进行解密，解密后销毁临时公私钥对。本实施例中，在对称密钥生成的全过程中，对称密钥都没有以明文的形式进行传输，且临时公私钥对在使用后被销毁，确保了对称密钥的安全性。可选地，本申请中涉及的对称加密算法可采用AES算法、国密SM4算法等，非对称加密算法可采用RSA算法、椭圆曲线算法、国密SM2算法等。进一步地，一实施例中，区块链接入层还用于验证上传数据、第一签名和第二签名对应的数据包的源IP，其中，若源IP与信息共享应用的IP一致，且第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名。本实施例中，针对信息共享应用存在外网通信的特点，通过验证数据包的源IP与信息共享应用的IP是否一致，从通信协议层验证数据包来源，进一步提高数据安全性，避免第二密钥外泄导致的安全隐患。第二方面，本申请实施例还提供一种基于区块链的医疗信息共享方法，应用于包括信息共享应用、区块链接入层和智能合约的基于区块链的医疗信息共享系统。图5示出了本申请一实施例中基于区块链的医疗信息共享方法的流程示意图。参照图5，基于区块链的医疗信息共享方法包括：S11、信息共享应用根据第一私钥对预设请求携带的上传数据进行签名得到第一签名，根据第二私钥对上传数据进行签名得到第二签名，将上传数据、第一签名和第二签名发送至区块链接入层，其中，第一私钥由预设请求的发起者提供，第二私钥预置于信息共享应用；S12、区块链接入层根据上传数据和第二公钥对第二签名进行验签，若第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名，将上传数据、第一签名和第三签名发送至智能合约，其中，第二公钥和第三私钥预置于区块链接入层；S13、智能合约根据上传数据和第三公钥对第三签名进行验签，若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作，其中，第三公钥和目标公钥预置于智能合约。进一步地，一实施例中，当预设请求为病历上传请求时，上传数据为病历数据，目标公钥为病历数据的所有者公钥；所述若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作的步骤包括：若第三签名验签通过，则根据病历数据中的患者信息从所有已注册患者的公钥中确定病历数据的所有者公钥，根据病历数据及其所有者公钥对第一签名进行验签，若第一签名验签通过，则存储病历数据，其中，所有已注册患者的公钥预置于智能合约。进一步地，一实施例中，当预设请求为病历授权请求时，上传数据为病历标识和待授权公钥，目标公钥为病历标识对应的目标病历数据的所有者公钥；所述若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作的步骤包括：若第三签名验签通过，则根据病历标识和目标病历数据的所有者公钥对第一签名进行验签，若第一签名验签通过，且待授权公钥为已注册医生的公钥，则将待授权公钥标记为目标病历数据的授权者公钥，其中，目标病历数据的所有者公钥和所有已注册医生的公钥预置于智能合约。进一步地，一实施例中，当预设请求为病历查看请求时，上传数据为病历标识，目标公钥为病历标识对应的目标病历数据的所有者公钥和授权者公钥；所述若第三签名验签通过，则根据上传数据和目标公钥对第一签名进行验签，若第一签名验签通过，则响应预设请求执行相关操作的步骤还包括：若第三签名验签通过，则根据病历标识及目标病历数据的所有者公钥和授权者公钥对第一签名进行验签，若第一签名验签通过，则将目标病历数据通过区块链接入层和信息共享应用返回至病历查看请求的发起者。进一步地，一实施例中，基于区块链的医疗信息共享方法还包括：智能合约根据第四私钥对下发数据进行签名得到第四签名，将下发数据和第四签名返回至区块链接入层，其中，第四私钥预置于智能合约；区块链接入层根据下发数据和第四公钥对第四签名进行验签，若第四签名验签通过，则根据第三私钥对下发数据进行签名得到第五签名，将下发数据和第五签名返回至信息共享应用，其中，第四公钥预置于区块链接入层；信息共享应用根据下发数据和第三公钥对第五签名进行验签，若第五签名验签通过，则针对下发数据执行相关操作，其中，第三公钥预置于信息共享应用。进一步地，一实施例中，在所述将上传数据、第一签名和第二签名发送至区块链接入层的步骤之前还包括：信息共享应用根据对称密钥对上传数据、第一签名和第二签名进行加密，以将上传数据、第一签名和第二签名以密文形式发送至区块链接入层，其中，对称密钥预置于信息共享应用；在所述根据上传数据和第二公钥对第二签名进行验签的步骤之前还包括：区块链接入层根据对称密钥对密文形式的上传数据、第一签名和第二签名进行解密，其中，对称密钥预置于区块链接入层；在所述将下发数据和第五签名返回至信息共享应用的步骤之前还包括：区块链接入层根据对称密钥对下发数据和第五签名进行加密，以将下发数据和第五签名以密文形式返回至信息共享应用；在所述根据下发数据和第三公钥对第五签名进行验签的步骤之前还包括：信息共享应用根据对称密钥对密文形式的下发数据和第五签名进行解密。进一步地，一实施例中，基于区块链的医疗信息共享方法还包括：信息共享应用生成临时公私钥对，将临时公私钥对的公钥发送至区块链接入层；区块链接入层生成对称密钥，根据临时公私钥对的公钥对对称密钥进行加密，加密后将密文形式的对称密钥返回至信息共享应用；信息共享应用根据临时公私钥对的私钥对密文形式的对称公钥进行解密，解密后销毁临时公私钥对。进一步地，一实施例中，在根据上传数据和目标公钥对第一签名进行验签的步骤之前还包括：区块链接入层验证上传数据、第一签名和第二签名对应的数据包的源IP，其中，若源IP与信息共享应用的IP一致，且第二签名验签通过，则根据第三私钥对上传数据进行签名得到第三签名。其中，上述基于区块链的医疗信息共享方法中各个步骤的分析与上述基于区块链的医疗信息共享系统中各组分的功能和实现过程相对应，在此处不再一一赘述。需要说明的是，上述本申请实施例序号仅仅为了描述，不代表实施例的优劣。本申请的说明书和权利要求书及上述附图中的术语“包括”和“具有”以及它们任何变形，意图在于覆盖不排他的包含。例如包含了一系列步骤或单元的过程、方法、系统、产品或设备没有限定于已列出的步骤或单元，而是可选地还包括没有列出的步骤或单元，或可选地还包括对于这些过程、方法、产品或设备固有的其他步骤或单元。术语“第一”、“第二”和“第三”等描述，是用于区分不同的对象等，其不代表先后顺序，也不限定“第一”、“第二”和“第三”是不同的类型。在本申请实施例的描述中，“示例性的”、“例如”或者“举例来说”等用于表示作例子、例证或说明。本申请实施例中被描述为“示例性的”、“例如”或者“举例来说”的任何实施例或设计方案不应被解释为比其它实施例或设计方案更优选或更具优势。确切而言，使用“示例性的”、“例如”或者“举例来说”等词旨在以具体方式呈现相关概念。在本申请实施例的描述中，除非另有说明，“/”表示或的意思，例如，A/B可以表示A或B；文本中的“和/或”仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况，另外，在本申请实施例的描述中，“多个”是指两个或多于两个。在本申请实施例描述的一些流程中，包含了按照特定顺序出现的多个操作或步骤，但是应该理解，这些操作或步骤可以不按照其在本申请实施例中出现的顺序来执行或并行执行，操作的序号仅用于区分开各个不同的操作，序号本身不代表任何的执行顺序。另外，这些流程可以包括更多或更少的操作，并且这些操作或步骤可以按顺序执行或并行执行，并且这些操作或步骤可以进行组合。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在如上所述的一个存储介质中，包括若干指令用以使得一台终端设备执行本申请各个实施例所述的方法。以上仅为本申请的优选实施例，并非因此限制本申请的专利范围，凡是利用本申请说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本申请的专利保护范围内。
