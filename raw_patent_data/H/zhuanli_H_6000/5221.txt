标题title
使用插值方法的UWB室内定位系统
摘要abst
本发明公开了一种使用插值方法的UWB室内定位系统，其特点是利用数个主从基站、交换机、定位标签、后台服务器和数据处理终端构建的高精度超宽带室内定位系统。通过各基站收集的SYNC包和TAG定位包，计算出定位标签到达每组主从基站的TDOA伪距，针对主要误差来源为多路径误差，利用趋势面分析对预先采集的TDOA伪距误差以及网格点位置信息进行建模，将多路径误差补偿的拟合参数结合位置信息储存在后台服务器，定位时结合改进的Taylor解算算法迭代求解定位标签的准确位置信息。本发明与现有技术相比具有更高的鲁棒性和定位精度，无需额外铺设大量的硬件设备，易于推广，在环境复杂的室内定位应用场景中具有较大优势和商业前景。
权利要求书clms
1.一种使用插值方法的UWB室内定位系统，其特征在于，该系统包括主基站、从基站、交换机、定位标签、后台服务器和数据处理终端，所述主基站、从基站为数个；所述交换机与主基站、从基站和后台服务器用光纤有线连接，后台服务器与数据处理终端用光纤有线连接，定位标签与主基站、从基站以无线方式传输信号；预先将待定位场地划分为数个网格区域，网格交点作为先验信息的采集点，所述定位标签以广播的方式发送TAG定位包，主基站发送SYNC同步包，接收定位标签发送的TAG定位包，并将其以UDP格式封装成数据包汇至交换机，从基站接收主基站发送同步包和定位标签发送的TAG定位包汇至交换机，所述交换机将所有数据发送到后台服务器；所述后台服务器通过各基站收集的SYNC包和TAG定位包，得到定位标签与各个基站的到达时间TOA数据，在数据处理终端利用TOA数据计算出定位标签到达每组主从基站的TDOA伪距，利用趋势面分析对预先在每个网格交点采集的TDOA伪距的多路径残差值进行建模，得到多项式函数形式的趋势面拟合系数，生成多路径改正表储存在后台服务器，定位时提取参数来优化TDOA伪距，以达到消除多路径误差的目的，然后利用改进的Taylor迭代解算算法求解定位标签的准确位置信息；所述到达时间TOA的单程观测方程由下述式计算：其中ti为基站i收到信号的时间；tj为定位标签j发出信号的时间；为基站i的真实坐标；为定位标签j的真实坐标；c为定位标签发射信号的传播速度；τi为基站i的时钟在其接收信号时刻的钟差；τj为定位标签j的时钟在其发射信号时刻的钟差；为定位标签到基站的多路径延迟项；为硬件延迟和观测误差项；所述定位标签j与主基站i1和从基站i2组成的TDOA由下述式计算的表示：其中为主基站i1收到信号的时刻；为从基站i2收到信号的时刻；tj为定位标签发射信号的时刻；为主基站i1的真实坐标；为从基站i2的真实坐标；为主基站i1的时钟在其接收信号时刻的钟差；为从基站i2的时钟在其接收信号时刻的钟差；为定位标签j到主基站i1的多路径延迟项；为定位标签j到从基站i2的多路径延迟项；为定位标签j和主基站i1的硬件误差和观测误差的残差项；为定位标签j和从基站i2的硬件延迟和观测误差项；所述改进的Taylor迭代解算算法由下述式表示：h＝GΔ+ε 其中表示定位标签j到主基站i1和到从基站in的TDOA测量值，表示定位标签j到主基站i1和到从基站in的TDOA计算值，为TDOA在x、y、z轴上的误差值，为转换矩阵，ε为误差矢量；式转化为最小二乘形式：Δ＝-1GTQ-1h 其中Q表示TDOA测量值的协方差矩阵；所述多路径残差值由下述表示：其中xi表示定位标签的x轴坐标；yi表示定位标签的y轴坐标；mi为定位标签位于坐标处的多路径观测值；为定位标签位于处的多路径估计值；εi为网格内拟合多路径剩余残差；所述多项式函数形式的趋势面拟合系数由线性、二次和三次趋势面拟合得到，分别由下述公式、、表示：其中b0，b1，b2...为多项式函数需要求解的系数；令下标P表示趋势面多项式中非常数项的个数；则坐标为的网格交点的趋势面分析由下述式表示：mi＝b0+b1N1i+b2N2i+…+bPNPi式转化为最小二乘形式：B＝NTM其中，所述趋势面拟合系数B由下述式计算：2.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述主基站集成主控与参考标签，主控同步参考标签与标签时钟，下发系统信息；参考标签发送本机时间至从基站，将接收的由定位标签发送的TAG定位包以用户数据报协议的格式封装成数据包。3.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述从基站判断同步时间，解算时间与相位差，并将接收的由主基站发送的SYNC同步包和定位标签发送的TAG定位包以用户数据报协议UDP的格式封装成数据包。4.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述定位标签以32Hz的频率广播含有本机时间和标签ID信息的超宽带脉冲信号作为TAG定位包到各主从基站。5.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述交换机为二层交换机，由超五类光纤连接主从基站和后台服务器，用于各基站和后台服务器间的数据交换。6.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述基站、网格交点的真实坐标采用毫米级激光测距仪测量记录。7.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述后台服务器包括控制模块、数据存储模块、数据解析及计算模块。8.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述定位标签发送的TAG定位包包括：标识字符串、区域信息、时间、标签ID、TDOA基站数量、各基站ID、各基站到主基站的TDOA伪距和序号。9.根据权利要求1所述的使用插值方法的UWB室内定位系统，其特征在于，所述主基站发送的SYNC同步包包括：时间、标识字符串、网络ID、序号、本基站ID、来源主基站ID、主基站发送时间、从基站接收时间和信号质量。
说明书desc
技术领域本发明涉及高精度室内定位导航技术领域，具体涉及使用插值方法的UWB室内定位系统。背景技术在科技迅速发展的今天，各个领域都呈现出蓬勃发展的趋势，移动通信己经在由4G向5G甚至6G迈进，智能机器人、无人车等智能工具的普及，更给人们的生活增添色彩。“位置”作为一类服务也开始融入到人们的生活当中，促使了许多依赖位置的服务产生，例如基于GPS定位的相关服务，包括室外行车导航、室内商场的查询等，这些涉及到生活中的角角落落、触及生活中的方方面面，无不利用了定位技术。在定位技术的推动和生活的强烈需求下，构建完整、精确的室内定位系统己经是迫在眉睫，成为现代学者的研究热点。阻碍室内定位快速的发展的原因有很多，主要原因是室内环境不同于室外，室内布置复杂，信号的传递会受家具、墙体、各种装饰物的阻碍，导致信号被折射、反射甚至被埋没等，这严重导致了传播信号的各种物理特性受到损耗。因此，有必要解决因复杂的室内布置导致室内定位不精确甚至无法定位等问题。现有的基于Bluetooth、WiFi、惯导等室内定位技术，在室内定位中应用比较广泛，但是定位精度不是很高。而超宽带定位技术，带宽达到几百兆赫兹，凭借其超强的穿墙能力抗干扰能力、多径分辨能力等在众多无线定位技术中脱颖而出，成为室内定位比较具有竞争力的技术。在高精度室内定位领域，强度衰减定位和自主定位都在米级精度上遇到了瓶颈，难以突破。其中强度衰减和距离经验关系的不确定度及易受室内环境影响、自主定位需要对时间积分造成的误差随时间累积的非线性增长是造成瓶颈的主要原因之一，这是定位技术本身的弱点。基于信号到达时间的室内定位技术的深入研究也能够为突破此瓶颈提供单项技术的支撑，但由于室内环境存在多路径因素的影响，导致基于时间的定位方法存在由多路径问题引起的误差，在现有基于时间的室内定位技术中，多路径误差的抑制一直被放在重点位置。根据不变环境多路径的时间和空间重复性，通过先验数据的建模对观测值优化以消除多路径误差对定位结果的干扰。发明内容本发明的目的是由于基于时间的室内定位信号容易受到非视距和多径效应的影响，针对现有技术的不足而提出使用插值方法的UWB室内定位系统，采用主从基站、定位标签、交换机和后台服务器构建的协同定位系统，对实验场景的多路径误差进行细致建模的方法，将模型参数储存在后台服务器，定位时优化TDOA伪距，以消除多路径误差的影响，提升定位精度。由于本发明无需额外铺设大量的硬件设备，也无需对现有硬件设备做出更改，因此易于推广，在高精度室内定位应用场景中具有较大优势和商业前景。本发明的目的是这样实现的：一种使用插值方法的UWB室内定位系统，其特点是该系统包括主基站、从基站、交换机、定位标签、后台服务器和数据处理终端，所述主基站、从基站为数个；所述交换机与主基站、从基站和后台服务器用光纤有线连接，后台服务器与数据处理终端用光纤有线连接，定位标签与主基站、从基站以无线方式传输信号；预先将待定位场地划分为数个网格区域，网格交点作为先验信息的采集点，所述定位标签以广播的方式发送TAG定位包，主基站发送SYNC同步包，接收定位标签发送的TAG定位包，并将其以UDP格式封装成数据包汇至交换机，从基站接收主基站发送同步包和定位标签发送的TAG定位包汇至交换机，所述交换机将所有数据发送到后台服务器；所述后台服务器通过各基站收集的SYNC包和TAG定位包，得到定位标签与各个基站的到达时间TOA数据，在数据处理终端利用TOA数据计算出定位标签到达每组主从基站的TDOA伪距，利用趋势面分析对预先在每个网格交点采集的TDOA伪距的多路径残差值进行建模，得到多项式函数形式的趋势面拟合系数，生成多路径改正表储存在后台服务器，定位时提取参数来优化TDOA伪距，以达到消除多路径误差的目的，然后利用改进的Taylor迭代解算算法求解定位标签的准确位置信息；所述到达时间TOA的单程观测方程由下述式计算：其中ti为基站i收到信号的时间；tj为定位标签j发出信号的时间；为基站i的真实坐标；为定位标签j的真实坐标；c为定位标签发射信号的传播速度；τi为基站i的时钟在其接收信号时刻的钟差；τj为定位标签j的时钟在其发射信号时刻的钟差；为定位标签到基站的多路径延迟项；为硬件延迟和观测误差项；所述定位标签j与主基站i1和从基站i2组成的TDOA由下述式计算的表示：其中为主基站i1收到信号的时刻；为从基站i2收到信号的时刻；tj为定位标签发射信号的时刻；为主基站i1的真实坐标；为从基站i2的真实坐标；为主基站i1的时钟在其接收信号时刻的钟差；为从基站i2的时钟在其接收信号时刻的钟差；为定位标签j到主基站i1的多路径延迟项；为定位标签j到从基站i2的多路径延迟项；为定位标签j和主基站i1的硬件误差和观测误差的残差项；为定位标签j和从基站i2的硬件延迟和观测误差项；所述改进的Taylor迭代解算算法由下述式表示：h＝GΔ+ε其中表示定位标签j到主基站i1和到从基站in的TDOA测量值，表示定位标签j到主基站i1和到从基站in的TDOA计算值，为TDOA在x、y、z轴上的误差值，为转换矩阵，ε为误差矢量；式转化为最小二乘形式：Δ＝-1GTQ-1h其中Q表示TDOA测量值的协方差矩阵；所述多路径残差值由下述表示：其中xi表示定位标签的x轴坐标；yi表示定位标签的y轴坐标；mi为定位标签位于坐标处的多路径观测值；为定位标签位于处的多路径估计值；εi为网格内拟合多路径剩余残差；所述多项式函数形式的趋势面拟合系数由线性、二次和三次趋势面拟合得到，分别由下述公式、、表示：其中b0，b1，b2...为多项式函数需要求解的系数；令N1i＝xi，N2i＝yi，下标P表示趋势面多项式中非常数项的个数；则坐标为的网格交点的趋势面分析由下述式表示：mi＝b0+b1N1i+b2N2i+…+bPNPi式转化为最小二乘形式：B＝NTM其中，所述趋势面拟合系数B由下述式计算：所述主基站集成主控与参考标签，主控同步参考标签与标签时钟，下发系统信息；参考标签发送本机时间至从基站，将接收的由定位标签发送的TAG定位包以用户数据报协议的格式封装成数据包。所述从基站判断同步时间，解算时间与相位差，并将接收的由主基站发送的SYNC同步包和定位标签发送的TAG定位包以用户数据报协议UDP的格式封装成数据包。所述定位标签以32Hz的频率广播含有本机时间和标签ID信息的超宽带脉冲信号作为TAG定位包到各主从基站。所述交换机为二层交换机，由超五类光纤连接主从基站和后台服务器，用于各基站和后台服务器间的数据交换。所述基站、网格交点的真实坐标采用毫米级激光测距仪测量记录。所述后台服务器包括控制模块、数据存储模块、数据解析及计算模块。所述定位标签发送的TAG定位包包括：标识字符串、区域信息、时间、标签ID、TDOA基站数量、各基站ID、各基站到主基站的TDOA伪距和序号。所述主基站发送的SYNC同步包包括：时间、标识字符串、网络ID、序号、本基站ID、来源主基站ID、主基站发送时间、从基站接收时间和信号质量。本发明利用先验信息构造多路径误差改正表，补偿TDOA测量值使定位精度提高，与现有技术相比具有较高和较稳定的定位精度，无需额外铺设大量的硬件设备，也无需对现有硬件设备做出更改，因此易于推广，在复杂环境的室内定位应用场景中具有较大优势和商业前景。附图说明图1为本发明结构示意图；图2为TMPM的二维布局示意图；图3为本发明的多路径建模和校正流程示意图；图4为本发明和现有定位技术的定位结果对比图。具体实施方式参阅图1，本发明基于数个主基站1、数个从基站2、定位标签3、交换机4、后台服务器5和数据处理终端6构建的室内定位系统，其中主基站1和从基站2由POE方式进行供电并向后台服务器5回传数据。交换机4汇集主基站1和从基站2接收到的TAG定位包以及从基站2收到的SYNC同步包发送至后台服务器5。后台服务器5负责基站同步、解析数据包，并将解析得到的数据发送给数据处理终端6。数据处理终端6承担计算多项式函数形式的趋势面拟合系数，存储TMPM改正表以及主基站l和从基站2的坐标信息和解算标签位置等功能。定位标签3以预设的频率稳定发送定位包，主基站1和从基站2接收到定位包和同步包后经由交换机4发送至后台服务器5。后台服务器5通过到达时间差计算定位标签3到从基站2与主基站1之间距离的差，而后数据处理终端6将利用TDOA解算定位标签3的位置信息。所述后台服务器5包括控制模块、数据存储模块、数据解析及计算模块。所述主基站1集成主控与参考标签，主控同步参考标签与标签时钟，下发系统信息，参考标签发送本机时间至从基站，并将接收的由定位标签发送的TAG定位包以用户数据报协议的格式封装成数据包。所述从基站2判断同步时间，解算时间与相位差，并将接收的由主基站发送的SYNC同步包和定位标签发送的TAG定位包以用户数据报协议UDP的格式封装成数据包。所述定位标签3以32Hz的频率广播含有本机时间和标签ID信息的超宽带脉冲信号作为TAG定位包到各主基站1和从基站2。所述交换机4由超五类光纤连接主基站1、从基站2和后台服务器5，用于主基站1、从基站2和后台服务器5间的数据交换。所述基站1、从基站2、网格点的真实坐标采用毫米级激光测距仪测量记录。所述定位标签3发送的TAG定位包包括：标识字符串、区域信息、时间、标签ID、TDOA基站数量、各基站ID、各基站到主基站的TDOA伪距和序号。所述主基站1发送的SYNC同步包包括：时间、标识字符串、网络ID、序号、本基站ID、来源主基站ID、主基站发送时间、从基站接收时间、信号质量。以下通过具体实施例对本发明作进一步的详细说明。实施例参阅图2，本发明在定位过程之前，预先在室内待定位区域为5m*6m矩形办公区域以1m*1m的分辨率划分网格，基站分别位于四个顶点，其中，主基站1在左上顶点，其高度为2.909m，三个从基站2在其余三个顶点，高度分别为2.868m、2.864m、2.868m，区域中间放置有若干桌椅，图中网格交点7位置表示先验数据采集点，五角星位置8代表测试点，定位标签的采集高度固定为1.3m。采用数个主基站、数个从基站、交换机、定位标签、后台服务器和数据处理终端架构的超宽带室内定位系统，所述基站中，主基站发送SYNC同步包，接收定位标签发送的TAG定位包将数据汇至交换机，从基站接收主基站发送同步包和标签发送的SYNC定位包汇至交换机，所述交换机将所有数据发送到后台服务器；所述后台服务器通过各基站收集的SYNC包和TAG定位包，计算出定位标签到达每组主从基站的TDOA伪距，将真实TDOA值与采集得到的伪距值作差得到多路径误差值，与网格交点的真实坐标一同保存到csv文件中，而后通过趋势面分析建模，拟合出趋势面多项式的系数，将每个网格交点的系数与位置序号一同存储于后台服务器中作为TMPM改正表。定位时运用改进的Taylor算法，代入采集TDOA值于定位算法中，解算出粗精度坐标，从TMPM改正表中取出对应网格交点的系数，对TDOA进行多路径误差补偿，再次代入定位算法中更新标签坐标，以欧氏距离的差值作为收敛阈值不断迭代，当收敛时即得到最终的解算坐标；参阅图3，其具体定位过程如下：a、将待定位区域在二维平面上进行均匀的矩形网格划分，以主基站为原点建立欧式坐标系，用激光测距仪测定主从基站以及每个网格交点的真实坐标，并在同一高度放置定位标签进行数据采集，通过采集的数据解算结果与真实坐标对比得到多路径误差。b、利用多路径误差符合时空重复性的特点，即同一位置下，对应同一基站的多路径误差是不变，并且各个网络点的位置与基站的实际空间坐标是已知的，即得到的多路径误差基本是稳定不变的，结合对应网格点的二维坐标将其储存下来作为建模的输入。c、对多路径误差进行二维的趋势面分析TMPM建模。1)对于模型中的网格点，具有相同x，y坐标的多路径残差值聚集在一起，TMPM模型运用趋势面分析来拟合网格点内的多路径残差值的二维空间变化，以获得该网格区域的多路径表达式，网格点内多路径残差值可表示为：其中，i为网格内第i个点，为该点的坐标，mi是多路径观测值，是多路径估计值，εi代表网格内拟合多路径剩余残差。2)所述多项式函数形式拟合，线性、二次和三次趋势面的拟合公式由下述表示其中b0，b1，b2...为趋势面方程需要求解的系数。令N1i＝xi，N2i＝yi，其中下标P表示表示趋势面多项式中非常数项的个数。由此，对于坐标为的网格点的趋势面分析的方程为：mi＝b0+b1N1i+b2N2i+…+bPNPi3)最小二乘矩阵解算方程为：B＝NTM其中，那么趋势面的拟合系数B可由此得到：分别获得线性、二次和三次趋势面的拟合系数。d、对拟合结果进行适度性检验然后选择最优的拟合系数。e、将所有最优拟合系数结合网格交点的真实坐标汇聚生成TMPM改正表，存储到后台服务器中。f、通过初次的改进Taylor算法解算得到定位标签的粗位置，进而得到标签所在网格区域。g、根据得到的网格区域位置，查询后台服务器保存的TPMP改正表中的对应区域数据。h、得到对应网格区域的趋势面系数。i、利用相应阶次的多项式函数与趋势面系数，返回定位标签对应位置的TDOA补偿值。j、将改正多路径误差后的TDOA伪距代入到坐标解算算法中，解算出新的位置信息，重复上述步骤f-i，迭代出多个新的坐标直至新坐标与上次的解算误差小于一定的阈值，此时输出标签的位置信息。参阅图4，本发明通过与已有定位技术对比，传统定位方法RAW的定位误差均值在88cm，累计分布函数在80％分位点的定位误差为95cm，MPM方法的定位误差均值在23cm，累计分布函数在80％分位点的定位误差为36cm，利用本发明T-MPM模型的解算结果误差均值17cm，累计分布函数在80％分位点的定位误差为25cm。可见本发明使用基于趋势面的多路径建模方法在室内定位伪距处理方面能够有效缓解多路径效应带来的定位误差，利用处理后TDOA伪距进行定位解算提升了定位精度及鲁棒性，优于已有定位技术。以上只是对本发明作进一步的说明，并非用以限制本发明，在不背离本发明构思的精神和范围下的等效实施，均应包含于本发明的权利要求范围之内。
