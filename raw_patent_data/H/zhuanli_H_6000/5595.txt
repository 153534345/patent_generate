标题title
一种施工工地监控方法及终端
摘要abst
本发明公开了一种施工工地监控方法及终端，使用训练完成的分割模型对待监测工地图像进行施工面分割，得到施工面区域，按照预设值调整对应的监控摄像头的摄像参数，根据初步调整后的摄像参数获取当前监测图像，并基于待监测工地图像和当前监测图像计算摄像参数与像素的映射关系，基于映射关系根据施工面区域和当前监测图像计算偏移值，按照偏移值调整初步调整后的摄像参数，使用最终调整后的摄像参数对所述施工面进行监控，以此在楼层高度上升过程中，装载在塔吊上的监控摄像头也能实现对施工面的自动定位和聚焦，无需人工干预，从而实现施工工地的动态监控。
权利要求书clms
1.一种施工工地监控方法，其特征在于，包括步骤：获取待监测工地图像，并使用训练完成的分割模型对所述待监测工地图像进行施工面分割，得到施工面区域；获取与所述待监测工地图像对应的监控摄像头的摄像参数，并按照预设值调整所述摄像参数，得到初步调整后的摄像参数；根据所述初步调整后的摄像参数获取当前监测图像，并基于所述待监测工地图像和所述当前监测图像计算摄像参数与像素的映射关系；基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值，并按照所述偏移值调整所述初步调整后的摄像参数，得到最终调整后的摄像参数；使用所述最终调整后的摄像参数对所述施工面进行监控；所述摄像参数包括P参数和T参数；所述按照预设值调整所述摄像参数，得到初步调整后的摄像参数包括：将所述P参数和所述T参数分别与所述预设值相加，得到初步调整后的P参数和T参数；所述基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值包括：确定所述施工面区域的几何中心点的第一坐标以及所述当前监测图像的中心点的第二坐标；计算所述第一坐标与所述第二坐标的坐标距离；根据所述坐标距离和所述映射关系计算第一偏移值；计算所述施工面区域的面积和所述当前监测图像的面积，并确定所述施工面区域的面积和所述当前监测图像的面积的比值；获取预设的倍数放大映射表；基于所述预设的倍数放大映射表和所述比值确定第二偏移值。2.根据权利要求1所述的一种施工工地监控方法，其特征在于，所述获取待监测工地图像之前包括：获取施工面分割知识库；使用所述施工面分割知识库对改进的SegFormer模型进行训练，得到训练完成的分割模型。3.根据权利要求1所述的一种施工工地监控方法，其特征在于，所述获取待监测工地图像包括：采集包括施工面的工地图像；对所述工地图像进行图像增强，得到增强后的工地图像；对所述增强后的工地图像进行亮度调整，得到待监测工地图像。4.根据权利要求1所述的一种施工工地监控方法，其特征在于，所述基于所述待监测工地图像和所述当前监测图像计算摄像参数与像素的映射关系包括：将所述待监测工地图像和所述当前监测图像进行特征点匹配，得到匹配后的特征点，并获取所述匹配后的特征点的像素偏移值；根据所述像素偏移值和所述预设值确定摄像参数与像素的映射关系。5.根据权利要求1所述的一种施工工地监控方法，其特征在于，所述摄像参数还包括Z参数；所述按照所述偏移值调整所述初步调整后的摄像参数，得到最终调整后的摄像参数包括：将所述初步调整后的P参数和T参数分别与所述第一偏移值相加，得到最终调整后的P参数和T参数；将所述Z参数与所述第二偏移值相加，得到最终调整后的Z参数。6.根据权利要求2所述的一种施工工地监控方法，其特征在于，所述获取施工面分割知识库包括：采集多张施工面监测图像；对所述多张施工面监测图像进行筛选，得到筛选后的施工面监测图像；对所述筛选后的施工面监测图像进行增强处理，得到增强后的施工面监测图像；对所述增强后的施工面监测图像中的施工面区域进行标注，生成施工面分割知识库。7.根据权利要求2所述的一种施工工地监控方法，其特征在于，所述获取施工面分割知识库之前包括：将SegFormer模型的原始特征融合模块修改为深度融合的特征融合模块，并在所述SegFormer模型的损失函数加入标签平滑正则化，得到改进的SegFormer模型。8.一种施工工地监控终端，包括存储器、处理器及存储在存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至7中任一项所述的一种施工工地监控方法中的各个步骤。
说明书desc
技术领域本发明涉及图像处理技术领域，尤其涉及一种施工工地监控方法及终端。背景技术施工工地常常需要安装摄像头，以对工地的安全和管理等问题进行监控。随着施工进度的增加，楼层的高度不断上升，装载监控摄像头的装置也会不断上升，摄像头在位移的过程中，往往会偏离原来的监控范围，一种情况是施工面被定位在偏离监控中心的位置，另一种情况是会处在不适当的焦距中，使得采集的监控视频不够合理。如果需要人工不断去巡视和调整，常常会浪费人力，因此，如何让监控摄像头在施工期间，能对施工面进行自动定位和聚焦，保证对施工工地的安全进行动态监控，是一个需要解决的问题。发明内容本发明所要解决的技术问题是：提供一种施工工地监控方法及终端，能够实现施工工地的动态监控。为了解决上述技术问题，本发明采用的技术方案为：一种施工工地监控方法，包括步骤：获取待监测工地图像，并使用训练完成的分割模型对所述待监测工地图像进行施工面分割，得到施工面区域；获取与所述待监测工地图像对应的监控摄像头的摄像参数，并按照预设值调整所述摄像参数，得到初步调整后的摄像参数；根据所述初步调整后的摄像参数获取当前监测图像，并基于所述待监测工地图像和所述当前监测图像计算摄像参数与像素的映射关系；基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值，并按照所述偏移值调整所述初步调整后的摄像参数，得到最终调整后的摄像参数；使用所述最终调整后的摄像参数对所述施工面进行监控；所述摄像参数包括P参数和T参数；所述按照预设值调整所述摄像参数，得到初步调整后的摄像参数包括：将所述P参数和所述T参数分别与所述预设值相加，得到初步调整后的P参数和T参数；所述基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值包括：确定所述施工面区域的几何中心点的第一坐标以及所述当前监测图像的中心点的第二坐标；计算所述第一坐标与所述第二坐标的坐标距离；根据所述坐标距离和所述映射关系计算第一偏移值；计算所述施工面区域的面积和所述当前监测图像的面积，并确定所述施工面区域的面积和所述当前监测图像的面积的比值；获取预设的倍数放大映射表；基于所述预设的倍数放大映射表和所述比值确定第二偏移值。为了解决上述技术问题，本发明采用的另一种技术方案为：一种施工工地监控终端，包括存储器、处理器及存储在存储器上并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现以下步骤：获取待监测工地图像，并使用训练完成的分割模型对所述待监测工地图像进行施工面分割，得到施工面区域；获取与所述待监测工地图像对应的监控摄像头的摄像参数，并按照预设值调整所述摄像参数，得到初步调整后的摄像参数；根据所述初步调整后的摄像参数获取当前监测图像，并基于所述待监测工地图像和所述当前监测图像计算摄像参数与像素的映射关系；基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值，并按照所述偏移值调整所述初步调整后的摄像参数，得到最终调整后的摄像参数；使用所述最终调整后的摄像参数对所述施工面进行监控；所述摄像参数包括P参数和T参数；所述按照预设值调整所述摄像参数，得到初步调整后的摄像参数包括：将所述P参数和所述T参数分别与所述预设值相加，得到初步调整后的P参数和T参数；所述基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值包括：确定所述施工面区域的几何中心点的第一坐标以及所述当前监测图像的中心点的第二坐标；计算所述第一坐标与所述第二坐标的坐标距离；根据所述坐标距离和所述映射关系计算第一偏移值；计算所述施工面区域的面积和所述当前监测图像的面积，并确定所述施工面区域的面积和所述当前监测图像的面积的比值；获取预设的倍数放大映射表；基于所述预设的倍数放大映射表和所述比值确定第二偏移值。本发明的有益效果在于：使用训练完成的分割模型对待监测工地图像进行施工面分割，得到施工面区域，按照预设值调整对应的监控摄像头的摄像参数，根据初步调整后的摄像参数获取当前监测图像，并基于待监测工地图像和当前监测图像计算摄像参数与像素的映射关系，基于映射关系根据施工面区域和当前监测图像计算偏移值，按照偏移值调整初步调整后的摄像参数，使用最终调整后的摄像参数对所述施工面进行监控，以此在楼层高度上升过程中，装载在塔吊上的监控摄像头也能实现对施工面的自动定位和聚焦，无需人工干预，从而实现施工工地的动态监控。附图说明图1为本发明实施例的一种施工工地监控方法的步骤流程图；图2为本发明实施例的一种施工工地监控终端的结构示意图。具体实施方式为详细说明本发明的技术内容、所实现目的及效果，以下结合实施方式并配合附图予以说明。请参照图1，一种施工工地监控方法，包括步骤：获取待监测工地图像，并使用训练完成的分割模型对所述待监测工地图像进行施工面分割，得到施工面区域；获取与所述待监测工地图像对应的监控摄像头的摄像参数，并按照预设值调整所述摄像参数，得到初步调整后的摄像参数；根据所述初步调整后的摄像参数获取当前监测图像，并基于所述待监测工地图像和所述当前监测图像计算摄像参数与像素的映射关系；基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值，并按照所述偏移值调整所述初步调整后的摄像参数，得到最终调整后的摄像参数；使用所述最终调整后的摄像参数对所述施工面进行监控。从上述描述可知，本发明的有益效果在于：使用训练完成的分割模型对待监测工地图像进行施工面分割，得到施工面区域，按照预设值调整对应的监控摄像头的摄像参数，根据初步调整后的摄像参数获取当前监测图像，并基于待监测工地图像和当前监测图像计算摄像参数与像素的映射关系，基于映射关系根据施工面区域和当前监测图像计算偏移值，按照偏移值调整初步调整后的摄像参数，使用最终调整后的摄像参数对所述施工面进行监控，以此在楼层高度上升过程中，装载在塔吊上的监控摄像头也能实现对施工面的自动定位和聚焦，无需人工干预，从而实现施工工地的动态监控。进一步地，所述获取待监测工地图像之前包括：获取施工面分割知识库；使用所述施工面分割知识库对改进的SegFormer模型进行训练，得到训练完成的分割模型。由上述描述可知，使用施工面分割知识库对改进的SegFormer模型进行训练，得到训练完成的分割模型，利用训练完成的分割模型可实现施工面的准确提取，从而提高了施工面定位聚焦的可靠性。进一步地，所述获取待监测工地图像包括：采集包括施工面的工地图像；对所述工地图像进行图像增强，得到增强后的工地图像；对所述增强后的工地图像进行亮度调整，得到待监测工地图像。由上述描述可知，对工地图像进行图像增强，能够增强边缘细节，且滤除采集过程中存在的噪声信息，然后再进行亮度调整，提升了待检测工地图像的质量，确保监控效果。进一步地，所述摄像参数包括P参数和T参数；所述按照预设值调整所述摄像参数，得到初步调整后的摄像参数包括：将所述P参数和所述T参数分别与所述预设值相加，得到初步调整后的P参数和T参数。由上述描述可知，先对摄像参数进行初步调整，以便快速获得摄像参数与像素的映射关系，提高施工面动态监测效率。进一步地，所述基于所述待监测工地图像和所述当前监测图像计算摄像参数与像素的映射关系包括：将所述待监测工地图像和所述当前监测图像进行特征点匹配，得到匹配后的特征点，并获取所述匹配后的特征点的像素偏移值；根据所述像素偏移值和所述预设值确定摄像参数与像素的映射关系。由上述描述可知，通过特征点匹配能够找出两张图像中对应的像素点，从而确定摄像参数与像素的映射关系。进一步地，所述基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值包括：确定所述施工面区域的几何中心点的第一坐标以及所述当前监测图像的中心点的第二坐标；计算所述第一坐标与所述第二坐标的坐标距离；根据所述坐标距离和所述映射关系计算第一偏移值；计算所述施工面区域的面积和所述当前监测图像的面积，并确定所述施工面区域的面积和所述当前监测图像的面积的比值；获取预设的倍数放大映射表；基于所述预设的倍数放大映射表和所述比值确定第二偏移值。由上述描述可知，根据坐标距离和映射关系计算第一偏移值，基于预设的倍数放大映射表和比值确定第二偏移值，根据确定的偏移值实现了施工面的自动定位聚焦。进一步地，所述摄像参数还包括Z参数；所述按照所述偏移值调整所述初步调整后的摄像参数，得到最终调整后的摄像参数包括：将所述初步调整后的P参数和T参数分别与所述第一偏移值相加，得到最终调整后的P参数和T参数；将所述Z参数与所述第二偏移值相加，得到最终调整后的Z参数。由上述描述可知，将初步调整后的P参数和T参数分别与第一偏移值相加，实现对施工面的自动定位，将Z参数与第二偏移值相加，实现对施工面的自动聚焦。进一步地，所述获取施工面分割知识库包括：采集多张施工面监测图像；对所述多张施工面监测图像进行筛选，得到筛选后的施工面监测图像；对所述筛选后的施工面监测图像进行增强处理，得到增强后的施工面监测图像；对所述增强后的施工面监测图像中的施工面区域进行标注，生成施工面分割知识库。由上述描述可知，对多张施工面监测图像进行筛选，能够剔除无益于模型训练的无效图像数据，对筛选后的施工面监测图像进行增强处理后再进行标注，能够对数据进行扩展以增强模型的鲁棒性和泛化能力。进一步地，所述获取施工面分割知识库之前包括：将SegFormer模型的原始特征融合模块修改为深度融合的特征融合模块，并在所述SegFormer模型的损失函数加入标签平滑正则化，得到改进的SegFormer模型。由上述描述可知，通过调整原有SegFormer模型的特征融合机制，使得高级特征和低级特征更好地进行融合，同时根据场景复杂性的特征，在损失函数引入标签平滑正则化，提升了分割模型的泛化能力，提升模型在不同场景中的分割效果。请参照图2，本发明另一实施例提供了一种施工工地监控终端，包括存储器、处理器及存储在存储器上并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述施工工地监控方法中的各个步骤。本发明上述的施工工地监控方法及终端能够适用于在施工楼层高度上升的过程中，需要对施工楼层上的施工面进行监控的场景，以下通过具体实施方式进行说明：请参照图1，本发明的实施例一为：一种施工工地监控方法，包括步骤：S1、将SegFormer模型的原始特征融合模块修改为深度融合的特征融合模块，并在所述SegFormer模型的损失函数加入标签平滑正则化，得到改进的SegFormer模型。SegFormer算法是一种由Transfomer优化而来的语义分割算法，对于复杂环境的目标分割具有良好的表现效果。模型主要分为四大部分：模型输入、编码器、解码器、多头注意力层；其中模型输入为序列数据，由词嵌入映射和位置嵌入相加得到；编码器由六个层级结构堆叠起来，每个层级结构由多头自注意力机制和全连接网络组成，层级结构之间由残差网络连接，之后进行批量归一化；解码器与编码器结构类似，但是多头注意力机制变为掩体，即当前位置信息只依赖于之前的序列信息，新添加多头注意力层对编码器每层输出向量进行特征提取；SegFormer模型的特点是Transfomer+特征融合+轻量级MLP，但是特征融合只是简单地将低级和高级特征做简单的拼接融合；由于语义层次不同并且空间分辨率存在差异，直接进行特征融合会导致分割效果不佳，低级特征具备丰富的细节信息，但缺乏高级语义信息；而高级特征则与之相反，具备丰富的高级语义但缺乏空间细节信息，因此这里需要一个合适的融合模块将高级特征和低级特征进行深度融合，所述深度融合的特征融合模块为将高级特征经过一个3x3的卷积模块，将卷积后的高级特征使用双线性插值算法进行上采样处理，得到和低级特征一样大小的特征图，并将处理后的高级特征图和低级特征图进行逐像素相乘，得到最后的深度融合特征。现有的SegFormer模型采用常见的交叉熵函数作为损失函数，即测量预测值和真实值之间的相似度。然而当预测标签与真实值标签差距较大的时候，损失函数的梯度可能变得非常小以至于难以优化，这里引入标签平滑正则化，在训练阶段预测正确时loss不会下降太快，预测错误时标签不会惩罚太多，不容易陷入局部最优点，可以较好地抑制网络过拟合现象。在每次迭代时，并不直接将每个像素点直接放入训练集，而是设置一个错误率ε，以1-ε的概率将像素点代入训练，以ε的概率将代入训练，这样模型在训练的时候既有正确标签又有错误标签输入，如果在标注的时候边缘出现错误标签，就会降低模型受到的影响，最后训练出来的模型泛化能力会更强。原有的交叉熵损失函数为：；在SegFormer模型的损失函数加入标签平滑正则化后，损失函数为：；式中，ε表示错误率，表示像素值/＞的真实标签，/＞表示像素值，P表示概率，/＞表示像素值/＞的预测标签；也就是说，当标签为0时，并不把它直接放入训练，而是直接替换成一个比较小的数ε，同样如果标签为1，也替换为较为接近的数1-ε。由于工地场景较为复杂，而且需要应用的范围比较广泛，所以要求模型具有较强的鲁棒性和泛化能力，使用标签平滑正则化可以产生更好的校准网络，从而产生更好的分割效果。S2、获取施工面分割知识库，具体包括S21-S24：S21、采集多张施工面监测图像。具体的，布设多个监测点，利用塔吊上的监控摄像头对监测点进行均匀采样，即每隔一段时间连续采集多张施工面监测图像。S22、对所述多张施工面监测图像进行筛选，得到筛选后的施工面监测图像。具体的，将所述多张施工面监测图像中的无效图像剔除，得到筛选后的施工面监测图像。以此剔除摄像头在抓摄过程中可能会存在一些模糊不清或者因为天气状况画面受到严重干扰的图片等。S23、对所述筛选后的施工面监测图像进行增强处理，得到增强后的施工面监测图像。在一种可选的实施方式中，所述增强处理包括旋转、裁剪、滤波等。S24、对所述增强后的施工面监测图像中的施工面区域进行标注，生成施工面分割知识库。具体的，使用图像标注工具对所述增强后的施工面监测图像中的施工面区域进行标注，即将增强后的施工面监测图像中施工面像素区域进行勾勒和描点，得到掩模数据，生成施工面分割知识库。S3、使用所述施工面分割知识库对改进的SegFormer模型进行训练，得到训练完成的分割模型。S4、获取待监测工地图像，并使用训练完成的分割模型对所述待监测工地图像进行施工面分割，得到施工面区域，具体包括：S41、采集包括施工面的工地图像。S42、对所述工地图像进行图像增强，得到增强后的工地图像。以此增强边缘细节，滤除采集过程中存在的噪声信息。S43、对所述增强后的工地图像进行亮度调整，得到待监测工地图像。具体的，从所述增强后的工地图像中确定低照度和高背光的工地图像，对低照度和高背光的工地图像进行亮度通道的伽玛校正，得到待监测工地图像。从而提升待监测工地图像的质量。S44、使用训练完成的分割模型对所述待监测工地图像进行施工面分割，得到施工面区域。S5、获取与所述待监测工地图像对应的监控摄像头的摄像参数，并按照预设值调整所述摄像参数，得到初步调整后的摄像参数，具体包括S51-S52：S51、获取与所述待监测工地图像对应的监控摄像头的摄像参数。其中，所述摄像参数包括P参数、T参数和Z参数，P参数表示相机水平方向上移动，即相机的旋转，T参数表示垂直方向上的移动，即相机镜头的高低俯仰，Z参数表示变焦，即相机的焦距。S52、将所述P参数和所述T参数分别与所述预设值相加，得到初步调整后的P参数和T参数。在一种可选的实施方式中，所述预设值的取值范围为10-20。S6、根据所述初步调整后的摄像参数获取当前监测图像，并基于所述待监测工地图像和所述当前监测图像计算摄像参数与像素的映射关系，具体包括S61-S63：S61、根据所述初步调整后的摄像参数获取当前监测图像。具体的，根据所述初步调整后的摄像参数调用相应接口控制监控摄像头获取当前监测图像，所述当前监测图像即调整摄像参数后监控摄像头拍摄到的图像。S62、将所述待监测工地图像和所述当前监测图像进行特征点匹配，得到匹配后的特征点，并获取所述匹配后的特征点的像素偏移值。所述匹配后的特征点即两张图像中相对应的点。S63、根据所述像素偏移值和所述预设值确定摄像参数与像素的映射关系。具体的，根据所有的所述像素偏移值计算均值，根据所述均值和所述预设值确定摄像参数与像素的映射关系p，具体为：p=；式中，表示所述预设值，dis表示所述均值。S7、基于所述映射关系根据所述施工面区域和所述当前监测图像计算偏移值，并按照所述偏移值调整所述初步调整后的摄像参数，得到最终调整后的摄像参数，具体包括S71-S78：S71、确定所述施工面区域的几何中心点的第一坐标以及所述当前监测图像的中心点的第二坐标。S72、计算所述第一坐标与所述第二坐标的坐标距离。S73、根据所述坐标距离和所述映射关系计算第一偏移值，具体为：；；式中，表示P参数的第一偏移值，/＞表示T参数的第一偏移值，disx表示所述第一坐标与所述第二坐标的第一坐标距离，disy表示所述第一坐标与所述第二坐标的第二坐标距离。S74、计算所述施工面区域的面积和所述当前监测图像的面积，并确定所述施工面区域的面积和所述当前监测图像的面积的比值。S75、获取预设的倍数放大映射表。所述预设的倍数放大映射表包括根据物体放大比例和z参数的调整范围建立的映射关系。S76、基于所述预设的倍数放大映射表和所述比值确定第二偏移值。S77、将所述初步调整后的P参数和T参数分别与所述第一偏移值相加，得到最终调整后的P参数和T参数；S78、将所述Z参数与所述第二偏移值相加，得到最终调整后的Z参数。S8、使用所述最终调整后的摄像参数对所述施工面进行监控。使用最终调整后的摄像参数对施工面进行监控所获取到的监测图像中，施工面能够位于画面中心且布满整个画面，实现了施工面的自动定位和聚焦，从而实现施工工地的动态监控。请参照图2，本发明的实施例二为：一种施工工地监控终端，包括存储器、处理器及存储在存储器上并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现实施例一中的施工工地监控方法中的各个步骤。综上所述，本发明提供的一种施工工地监控方法及终端，使用训练完成的分割模型对待监测工地图像进行施工面分割，得到施工面区域，按照预设值调整对应的监控摄像头的摄像参数，根据初步调整后的摄像参数获取当前监测图像，并基于待监测工地图像和当前监测图像计算摄像参数与像素的映射关系，基于映射关系根据施工面区域和当前监测图像计算偏移值，按照偏移值调整初步调整后的摄像参数，使用最终调整后的摄像参数对所述施工面进行监控，以此在楼层高度上升过程中，装载在塔吊上的监控摄像头也能实现对施工面的自动定位和聚焦，无需人工干预，从而实现施工工地的动态监控；另外，通过调整原有SegFormer模型的特征融合机制，使得高级特征和低级特征更好地进行融合，同时根据场景复杂性的特征，在损失函数引入标签平滑正则化，提升了分割模型的泛化能力，提升模型在不同场景中的分割效果。以上所述仅为本发明的实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等同变换，或直接或间接运用在相关的技术领域，均同理包括在本发明的专利保护范围内。
