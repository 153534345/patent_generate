标题title
一种网络异常流量精细化检测方法
摘要abst
本申请涉及一种网络异常流量精细化检测方法，该方法包括：获取有标签降维特征集合和无标签降维特征集合；将有标签降维特征集合输入至聚类模型中，得到多个聚类特征簇；对多个聚类特征簇分别添加特征标记，并将原始检测模型划分为多个子检测器；将带有不同特征标记的聚类特征簇分别输入至所属子检测器中，得到多个子检测模型；将无标签降维特征集合与多个聚类特征簇逐一进行特征符合度评估，得到与无标签降维特征集合最为匹配的聚类特征簇集合；将无标签降维特征集合输入至与其最为匹配的子检测模型中，最终得到异常流量检测结果。本申请提供的方法，能够解决现有异常流量检测技术难以精准捕捉流量特征偏差的问题，从而提高异常流量检测精度。
权利要求书clms
1.一种网络异常流量精细化检测方法，其特征在于，包括以下步骤:S1.根据原始流量数据样本库获取有标签降维特征集合和无标签降维特征集合；S2.将所述有标签降维特征集合输入至聚类模型中进行训练，得到多个聚类特征簇；S3.对所述多个聚类特征簇分别添加特征标记，并以特征标记和簇大小为划分依据将原始异常流量检测模型划分为多个子检测器；S4.将带有不同特征标记的聚类特征簇分别输入至所属子检测器中进行训练，得到多个子检测模型；S5.将所述无标签降维特征集合与所述多个聚类特征簇逐一进行特征符合度评估，得到与无标签降维特征集合最为匹配的聚类特征簇集合；S6.将所述无标签降维特征集合分别输入至与之最为匹配的聚类特征簇所属子检测模型中进行异常流量检测，最终得到异常流量检测结果。2.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S1中原始流量数据样本库，包括有标签非加密流量数据样本、有标签加密流量数据样本、无标签非加密流量数据样本和无标签加密流量数据样本。3.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S2中聚类模型包括经由改进正余弦优化算法引导簇生成的K-Means聚类模型。4.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S2中聚类特征簇的数量由预设簇阈值确定。5.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S2具体包括以下步骤：S21.定义聚类模型的初始化参数，并建立初始化样本簇；S22.将所述步骤S21中初始化参数及初始化样本簇输入至所述聚类模型中进行训练，得到数量小于或等于预设簇阈值的多个原始聚类特征簇；S23.计算所述步骤S22中初始化样本簇的适应度，并根据求解结果在每个所述原始聚类特征簇中展开寻优，获取原始聚类特征簇的簇内最优解；S24.根据所述步骤S23中原始聚类特征簇的簇内最大值和簇内最小值，将除原始聚类特征簇集合中的全局最优簇以外的其他样本簇展开柯西算子混沌变异，并更新全局最优簇集合；S25.将所述步骤S24中原始聚类特征簇中全局最优簇集合的适应度逐一与所述全局最优簇集合初始值的适应度进行比较，最终获得适应度最优的聚类特征簇集合。6.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S3中特征标记为某一聚类特征簇区别于其他聚类特征簇的典型特征的字符编号标记，便于对所述步骤S1中有标签降维特征集合和无标签降维特征集合进行特征符合度评估。7.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S3中簇大小具体表示所述聚类特征簇内包含的有标签流量数据样本量和无标签流量数据样本量。8.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S3中子检测器的划分维度等同于所述聚类特征簇的数量，子检测器的从属编号等同于所述特征标记所属聚类特征簇的字符编号。9.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S4中子检测模型用于精细化检测所述步骤S1中有标签降维特征集合和无标签降维特征集合中的异常流量，多个子检测模型的模型性能与步骤S3中所述原始异常流量检测模型的模型性能一致。10.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S5具体包括以下步骤：S51.将无标签降维特征集合中的某一无标签流量数据特征与特征标记字符编号为1的聚类特征簇进行特征符合度匹配，获得特征标记字符编号为1的聚类特征簇的特征符合度分数；S52.判断所述步骤S51中聚类特征簇的特征符合度分数是否低于预设阈值，若低于预设阈值，则将聚类特征簇与特征标记字符编号为2的聚类特征簇相整合，得到符合度评估特征簇；若高于预设阈值，则将聚类特征簇作为所述步骤S51中所述无标签流量数据特征最为匹配的聚类特征簇；S53.将所述步骤S51中无标签流量数据特征与所述步骤S52中符合度评估特征簇进行特征符合度匹配，获得符合度评估特征簇的特征符合度分数；S54.将所述步骤S51中特征符合度分数与所述步骤S53中特征符合度分数行加权平均，获得所述步骤S52中聚类特征簇的特征符合度分数；S55.比较所述步骤S54中特征符合度分数与特征符合度分数的大小，选择特征符合度数值较大的聚类特征簇作为与所述步骤S51中无标签流量数据特征最匹配的聚类特征簇；S56.将所述步骤S51中无标签降维特征集合与多个聚类特征簇逐一进行特征符合度评估，直到得到与无标签降维特征集合最为匹配的聚类特征簇集合。11.根据权利要求10所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S52中得到符合度评估特征簇的具体实现过程为：去除特征标记字符编号为2的聚类特征簇中包含的与聚类特征簇中特征完全相同的特征，并将特征标记字符编号为2的聚类特征簇中包含的与聚类特征簇中特征存在差异的特征补充至聚类特征簇中，得到符合度评估特征簇。12.根据权利要求1所述的一种网络异常流量精细化检测方法，其特征在于，所述步骤S6中聚类特征簇所属子检测模型具体表示与该聚类特征簇特征标记字符编号相等的子检测模型。
说明书desc
技术领域本申请涉及网络安全技术领域，尤其涉及一种网络异常流量精细化检测方法。背景技术随着6G技术的飞速发展，网络流量趋于复杂化和多样化，其中隐匿的恶意异常流量行为层出不穷，网络安全问题越来越突出。传统的异常流量检测方法需要交换机采集大量经由骨干网络的流量数据并输入到单一检测模型中进行训练，但经过不同网关的流量数据的特征分布往往因数据来源、传输目的、流经地点、时间等因素的不同存在一定的差异性，传统的单一检测模型不具备区分这种特征分布差异性的能力，导致针对异常流量的检测效果不够理想，可扩展性较差，无法针对经由各网关的复杂流量展开精细化的异常流量检测。此外，为躲避异常流量检测系统的检测，一些攻击者往往通过加密手段将恶意流量隐匿于正常流量中，这类加密异常流量往往不带有所属标签，传统的单一异常流量检测手段很难判断其所属攻击类别，导致从该流量数据中提取的特征与训练好的单一检测模型的匹配度较低，无法为相关检测人员提供有效的检测反馈结果，这一过程不仅大大降低了单一检测模型的检测精度，还导致检测效率低下。发明内容本申请涉及一种网络异常流量精细化检测方法，能够解决现有异常流量检测技术难以捕捉无标签流量间特征偏差导致异常流量检测结果准确率较低的问题。本申请涉及一种网络异常流量精细化检测方法，包括以下步骤：S1.根据原始流量数据样本库获取有标签降维特征集合和无标签降维特征集合；S2.将所述有标签降维特征集合输入至聚类模型中进行训练，得到多个聚类特征簇；S3.对所述多个聚类特征簇分别添加特征标记，并以特征标记和簇大小为划分依据将原始异常流量检测模型划分为多个子检测器；S4.将带有不同特征标记的聚类特征簇分别输入至所属子检测器中进行训练，得到多个子检测模型；S5.将所述无标签降维特征集合与所述多个聚类特征簇逐一进行特征符合度评估，得到与无标签降维特征集合最为匹配的聚类特征簇集合；S6.将所述无标签降维特征集合分别输入至与之最为匹配的聚类特征簇所属子检测模型中进行异常流量检测，最终得到异常流量检测结果。进一步地，所述步骤S1中原始流量数据样本库，包括有标签非加密流量数据样本、有标签加密流量数据样本、无标签非加密流量数据样本和无标签加密流量数据样本。进一步地，所述步骤S2中聚类模型包括经由改进正余弦优化算法引导簇生成的K-Means聚类模型。进一步地，所述步骤S2中聚类特征簇的数量由预设簇阈值确定。进一步地，所述步骤S2具体包括以下步骤：S21.定义聚类模型的初始化参数，并建立初始化样本簇；S22.将所述步骤S21中初始化参数及初始化样本簇输入至聚类模型中进行训练，得到数量小于或等于所述预设簇阈值的多个原始聚类特征簇；S23.计算所述步骤S22中初始化样本簇的适应度，并根据求解结果在每个原始聚类特征簇中展开寻优，获取原始聚类特征簇的簇内最优解。S24.根据所述步骤S23中原始聚类特征簇的簇内最大值和簇内最小值，将除原始聚类特征簇集合中的全局最优簇以外的其他样本簇展开柯西算子混沌变异，并更新全局最优簇集合；S25.将所述步骤S24中原始聚类特征簇中全局最优簇集合的适应度逐一与全局最优簇集合初始值的适应度进行比较，最终获得适应度最优的聚类特征簇集合。进一步地，所述步骤S3中特征标记为某一聚类特征簇区别于其他聚类特征簇的典型特征的字符编号标记，便于对所述步骤S1中有标签降维特征集合和无标签降维特征集合进行特征符合度评估。进一步地，所述步骤S3中簇大小具体表示聚类特征簇内包含的有标签流量数据样本量和无标签流量数据样本量。进一步地，所述步骤S3中子检测器的划分维度等同于所述聚类特征簇的数量，子检测器的从属编号等同于所述特征标记所属聚类特征簇的字符编号。进一步地，所述步骤S4中子检测模型用于精细化检测所述步骤S1中有标签降维特征集合和无标签降维特征集合中的异常流量，所述多个子检测模型的模型性能与步骤S3中原始异常流量检测模型的模型性能一致。进一步地，所述步骤S5具体包括以下步骤：S51.将无标签降维特征集合中的某一无标签流量数据特征与特征标记字符编号为1的聚类特征簇进行特征符合度匹配，获得特征标记字符编号为1的聚类特征簇的特征符合度分数；S52.判断所述步骤S51中聚类特征簇的特征符合度分数是否低于预设阈值，若低于预设阈值，则将聚类特征簇与特征标记字符编号为2的聚类特征簇相整合，得到符合度评估特征簇;若高于预设阈值，则将聚类特征簇作为所述步骤S51中无标签流量数据特征最匹配的聚类特征簇；S53.将所述步骤S51中无标签流量数据特征与所述步骤S52中符合度评估特征簇进行特征符合度匹配，获得符合度评估特征簇的特征符合度分数；S54.将所述步骤S51中特征符合度分数与所述步骤S53中特征符合度分数进行加权平均，获得所述步骤S52中聚类特征簇的特征符合度分数；S55.比较所述步骤S54中特征符合度分数与特征符合度分数的大小，选择特征符合度数值较大的聚类特征簇作为与所述步骤S51中无标签流量数据特征最匹配的聚类特征簇；S56.将所述步骤S51中无标签降维特征集合与多个聚类特征簇逐一进行特征符合度评估，直到得到与无标签降维特征集合最为匹配的聚类特征簇集合。进一步地，所述步骤S52中得到符合度评估特征簇的具体实现过程为：去除特征标记字符编号为2的聚类特征簇中包含的与聚类特征簇中特征完全相同的特征，并将特征标记字符编号为2的聚类特征簇中包含的与聚类特征簇中特征存在差异的特征补充至聚类特征簇中，得到符合度评估特征簇。进一步地，所述步骤S6中聚类特征簇所属子检测模型具体表示与该聚类特征簇特征标记字符编号相等的子检测模型。本申请实施例提供的技术方法与现有技术相比至少具有以下优点：本申请所涉及的一种网络异常流量精细化检测方法，通过生成聚类特征簇划分多个子检测模型实现异常流量的精细化检测，并通过提供一种特征符合度评估方法精准捕捉无标签流量间的特征偏差，降低了无标签流量特征偏差对异常流量检测结果的影响，从而提高了现有异常流量检测技术的检测准确度。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本申请的实施例，并与说明书一起用于解释本申请的原理。图1为本申请实施例提供的一种网络异常流量精细化检测方法的流程示意图；图2为本申请实施例提供的另一种网络异常流量精细化检测方法的流程示意图；图3为本申请实施例提供的又一种网络异常流量精细化检测方法的流程示意图；图4为本申请实施例提供的一种网络异常流量精细化检测模型的示意图。通过上述附图，已示出本申请明确的实施例，后文中将有更详细的描述。这些附图和文字描述并不是为了通过任何方式限制本申请构思的范围，而是通过参考特定实施例为本领域技术人员说明本申请的概念。具体实施方式这里将详细地对示例性实施例进行说明，其示例表示在附图中。下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。以下示例性实施例中所描述的实施方式并不代表与本申请相一致的所有实施方式。相反，它们仅是与如所附权利要求书中所详述的、本申请的一些方面相一致的方法的例子。传统的异常流量检测方法包括基于标签统计的异常流量检测算法、基于参数统计的异常流量检测算法以及基于信息熵的异常流量检测算法等。上述方法普遍存在流量检测过程繁琐、检测耗时长、检测准确度低，模型可扩展性差等问题。上述问题可采用机器学习的方法进行改善，通过利用大量流量数据样本训练初始化的异常流量检测模型，可实时针对未知异常流量展开检测，从而减少传统异常流量检测方法的检测时间、提高流量检测的准确性。然而，当前异常流量检测所采用的决策树、支持向量机、贝叶斯、神经网络等机器学习算法由于缺乏对无标签流量数据间特征偏差的捕捉能力，往往难以精准检测出无标签加密流量数据中的异常流量行为，从而导致异常流量检测模型的检测效果不够理想。有鉴于此，本申请提供了一种网络异常流量精细化检测方法，通过以聚类特征簇特征标记和簇大小为划分依据将原始异常流量检测模型划分为多个子检测器，通过将多个聚类特征簇输入至各自所属子检测器中进行训练，得到多个子检测模型，通过将无标签降维特征集合与多个聚类特征簇逐一进行特征符合度评估，得到与之最匹配的聚类特征簇集合，并通过将无标签降维特征集合输入至与之最匹配的子检测模型中进行异常流量检测，最终得到异常流量检测结果。该方法通过生成聚类特征簇划分多个子检测模型实现异常流量的精细化检测，并通过提供一种特征符合度评估方法精准捕捉无标签流量间的特征偏差，降低了无标签流量特征偏差对异常流量检测结果的影响，从而提高了现有异常流量检测模型的检测准确度。下面结合附图，通过具体的实施例对本申请的技术方案以及本申请的技术方案如何解决上述技术问题进行详细说明。图1为本申请实施例提供的一种网络异常流量精细化检测方法的流程示意图。如图1所示，该方法主要包括以下步骤：S101.根据原始流量数据样本库获取有标签降维特征集合和无标签降维特征集合。其中，该原始流量数据样本库中所包含的流量数据样本理应属于以下几种类别：有标签非加密流量数据样本、有标签加密流量数据样本、无标签非加密流量数据样本以及无标签加密流量数据样本。对于原始流量数据样本库中属于上述几种流量类别的数据样本的来源及特征，本申请不做限制。例如，组成该原始流量数据样本库的流量数据样本可以是电子邮件传送时产生的流量数据，也可以是网络音频传输时产生的流量数据；可以是图像格式的流量数据，也可以是文本格式的流量数据。根据应用场景需求的不同，在对有标签流量数据样本和无标签流量数据样本进行切割前，还可以对原始流量数据样本库中的流量数据样本进行清洗，去除原始流量数据样本库中含有缺失值、0值、非法值、重复值等无效特征信息的流量数据样本，得到清洗后的流量数据样本集合，以避免无效流量数据对异常流量检测模型的检测结果造成影响。其中，该流量数据样本特征提取的实现方式可以是现有的任意一种数据特征提取的实现方式，所采用的流量数据样本特征提取方法可以是现有的任意一种数据特征提取方法。例如，一种可能的实现方式可以是首先根据原始流量数据样本格式直接提取该流量数据的显含特征，之后通过基于Word2vec的特征提取算法进一步提取该流量数据的隐含特征；另一种可能的实现方式，可将有标签流量数据样本及无标签流量数据样本区分开来，对于有标签流量数据样本，根据原始有标签流量数据样本格式直接提取该有标签流量数据的显含特征，对于无标签流量数据样本，则通过基于Word2vec的特征提取算法提取该无标签流量数据的隐含特征。上述基于Word2vec的特征提取算法适用于文本格式的流量数据，该类流量数据还可以采用例如平权统计、TF-IDF等特征提取方法；对于以图像为格式的流量数据，则可以采用例如SIFT算法、HOG算法等。可选的，例如，利用Word2vec特征提取算法提取到的文本格式的无标签流量数据样本特征可以是样本采集时间、样本源IP地址、目的IP地址、样本字节长度、样本到达间隔、流量传输比特率等。该流量数据样本特征降维的实现方式也可以是现有的任意一种数据特征降维的实现方式，所采用的流量数据样本特征降维方法也可以是现有的任意一种数据特征降维方法。例如，针对该流量数据样本的的特征降维方法可以是多维尺度变换、等距特征映射、主成分分析、序列向后选择等。以利用SBS算法实现有标签流量数据样本特征降维为例，该有标签流量数据样本特征的降维可以包含以下过程：根据含有某一特征的样本量大小计算该有标签流量数据样本不同特征的权重，其中选择权重较大的个特征，形成重要特征集。定义为标准性能评估函数，根据保留某一特征与去除某一特征流量检测模型性能表现的差值计算标准性能评估函数，并在下一轮迭代训练时去除使的值最大的特征：。重复上述步骤，直到原始流量检测模型的性能损失达到峰值，或达到预设特征集合的特征维数。将迭代过程中产生的一个或多个特征从原始有标签流量特征集合中去除，得到有标签降维特征集合。S102.将有标签降维特征集合输入至聚类模型中进行训练，得到多个聚类特征簇；其中，有标签降维特征集合具体是指特征降维处理后的有标签流量数据样本训练集。该聚类模型包括经由改进正余弦优化算法引导簇生成的K-Means聚类模型。可选的，该优化算法也可以是能够对现有聚类模型的收敛速度、聚类精度、聚类簇大小等方面起到整体改善作用的其他优化算法或正余弦优化算法的变体。该初始聚类模型也可以是与K-Means聚类算法理论相似的其他聚类算法或K-Means聚类算法的相关变体。本申请对于所采用的优化算法和聚类算法不做严格的限制。在利用该经由优化算法引导簇生成的聚类模型得到聚类特征簇前，需要预先设定一个簇阈值参数，该簇阈值参数为一个不为零的正整数。聚类特征簇的数量由该预设簇阈值确定，合理情形下，聚类特征簇的数量应不大于预设簇阈值的上限。S103.对多个聚类特征簇分别添加特征标记，并以特征标记为划分依据将原始异常流量检测模型划分为多个子检测器；该聚类特征簇具体是指由带有典型特征或独有特征的有标签流量数据组成的样本集合，不同聚类特征簇之间所包含的特征不完全相同，且每个聚类特征簇理应包含至少一个可与其他聚类特征簇区别开来的典型特征或独有特征。例如，对于由个聚类特征簇组成的聚类特征簇集合，仅聚类特征簇包含特征“数据包时间间隔”，其余n-1个聚类特征簇均不包含特征“数据包时间间隔”，则该特征“数据包时间间隔”即为聚类特征簇区别于其他聚类特征簇的典型特征或独有特征。该特征“数据包时间间隔”为给聚类特征簇添加特征标记的主要依据。可选的，若某一聚类特征簇包含两个或两个以上的可与其他聚类特征簇区分的典型特征，则只选择其中一个典型特征给该聚类特征簇添加特征标记；可选的，考虑极端情形，若因聚类算法失效导致某一聚类特征簇不含有与其他聚类特征簇不同的典型特征或独有特征，则将该聚类特征簇与其他聚类特征簇相整合。该特征标记具体为某一聚类特征簇区别于其他聚类特征簇的典型特征或独有特征的字符编号标记，用于方便在无标签流量数据样本与有标签流量数据样本之间进行特征符合度评估。例如，假设某一聚类特征簇中所含有的某一有标签流量数据样本主要由七元组数据包组成，即该有标签流量数据样本格式为={源端口号，目的端口号，源IP地址，目的IP地址，传输协议，数据包长度，时间戳}，则在给该有标签流量数据样本所属聚类特征簇添加特征标记后，该有标签流量数据样本格式变更为八元组数据包：={字符编号，源端口号，目的端口号，源IP地址，目的IP地址，传输协议，数据包长度，时间戳}，该字符编号即为该有标签流量数据样本所属聚类特征簇的特征标记，为二进制编码形式，位于表头位置。该原始异常流量检测模型可以是现有的任意一种机器学习或深度学习模型，本申请对于原始异常流量检测模型的实现原理不做严格的限制。例如，该原始异常流量检测模型可以是支持向量机、决策树、XGBoost、随机森林等机器学习模型、也可以是循环神经网络RNN、长短期记忆网络LSTM、YOLO等深度学习模型。其中，该子检测器的划分维度等同于所生成的聚类特征簇的数量，子检测器的从属编号等同于特征标记所属聚类特征簇的字符编号。S104.将带有不同特征标记的聚类特征簇分别输入至所属子检测器中进行训练，得到多个子检测模型；该子检测模型用于精细化检测原始流量数据样本库中有标签流量数据样本与无标签流量数据样本中的异常流量，每个子检测模型所带有的从属编号与特征标记所属聚类特征簇的字符编号相同，每个子检测模型的模型性能与原始异常流量检测模型的模型性能一致，每个子检测模型均可以单独训练原始流量数据样本库中所有的有标签流量数据样本与无标签流量数据样本。在得到多个子检测模型后，利用特征降维处理后的有标签流量数据样本测试集测试所有子检测模型的检测效果，即将带有不同特征标记的有标签流量数据样本测试集合分别输入至与其所含特征标记相对应的子检测模型中，并输出子检测模型各自的测试结果，根据测试结果确定子检测模型的检测效果，包括检测精度、检测时长等方面。S105.将无标签降维特征集合与多个聚类特征簇逐一进行特征符合度评估，得到与无标签降维特征集合最为匹配的聚类特征簇集合；将无标签降维特征集合中所含有的无标签流量数据样本与所有聚类特征簇进行特征符合度评估，根据特征符合度分数得到与无标签降维特征集合中某一无标签流量数据样本最为匹配的聚类特征簇，根据无标签降维特征集合中的所有无标签流量数据样本集合得到与之最为匹配的聚类特征簇集合。根据所得到的与无标签降维特征集合最为匹配的聚类特征簇集合，为无标签流量数据样本分配对其检测效果最佳的子检测模型，用于无标签异常流量的精细化检测。S106.将无标签降维特征集合分别输入至与之最为匹配的聚类特征簇所属子检测模型中进行异常流量检测，最终得到异常流量检测结果。该聚类特征簇所属子检测模型具体表示与该聚类特征簇特征标记字符编号相等的子检测模型。根据每个无标签流量数据样本最为匹配的聚类特征簇特征标记，将无标签流量数据样本分别输入到与其最为匹配的聚类特征簇相对应的子检测模型中，该子检测模型为针对该无标签流量数据样本检测效果最佳的子检测模型。在完成无标签降维特征集合中所有无标签流量数据样本的模型分配后，每个子检测模型针对输入的无标签流量数据样本进行异常流量的精细化检测，并输出异常流量精细化检测结果。该异常流量精细化检测结果理应包括异常的无标签流量数据样本的所属标签，即异常流量的异常行为类别。本申请提供的网络异常流量精细化检测方法，通过以聚类特征簇特征标记和簇大小为划分依据将原始异常流量检测模型划分为多个子检测器，通过将多个聚类特征簇输入至各自所属子检测器中进行训练以得到多个子检测模型，通过将无标签降维特征集合与多个聚类特征簇逐一进行特征符合度评估以得到与之最匹配的聚类特征簇集合，并通过将无标签降维特征集合输入至与之最匹配的子检测模型中进行异常流量检测，最终得到异常流量检测结果。该方法通过生成聚类特征簇划分多个子检测模型实现异常流量的精细化检测，并通过提供一种特征符合度评估方法精准捕捉无标签流量间的特征偏差，降低了无标签流量特征偏差对异常流量检测结果的影响，从而提高了现有异常流量检测模型的检测准确度。下面，对于前述步骤S105中如何利用本申请提供的特征符合度评估方法得到与所述无标签降维特征集合最为匹配的聚类特征簇集合进行详细介绍。图2为本申请实施例提供的另一种网络异常流量精细化检测方法的流程示意图。如图2所示，前述步骤S105主要包括以下步骤：S201.将无标签降维特征集合中的某一无标签流量数据特征与特征标记字符编号为1的聚类特征簇进行特征符合度匹配，获得该特征标记字符编号为1的聚类特征簇的特征符合度分数；S202.判断该聚类特征簇的特征符合度分数是否低于预设阈值，若低于预设阈值，则将该聚类特征簇与特征标记字符编号为2的聚类特征簇相整合，得到符合度评估特征簇；若高于预设阈值，则将该聚类特征簇作为无标签流量数据特征最为匹配的聚类特征簇；S203.将该无标签流量数据特征与符合度评估特征簇进行特征符合度匹配，获得该符合度评估特征簇的特征符合度分数；S204.将特征符合度分数与该特征符合度分数进行加权平均，获得聚类特征簇的特征符合度分数；S205.比较特征符合度分数与特征符合度分数的大小，选择特征符合度数值较大的聚类特征簇作为与无标签流量数据特征最为匹配的聚类特征簇。S206.重复上述步骤S201-S205，直到无标签降维特征集合与所有带有特征标记的聚类特征簇完成特征符合度评估，最终得到与该无标签降维特征集合最为匹配的聚类特征簇集合。其中，以Jaccard相似度方法为例，前述步骤S201中获取聚类特征簇的特征符合度分数的具体实现过程可以包括：计算某一无标签流量数据特征与特征标记字符编号为1的聚类特征簇的相似性占比：，计算两者之间的Jaccard距离：，将该距离归一化为0到1之间的数值，该数值即为该无标签流量数据特征与特征标记字符编号为1的聚类特征簇的特征符合度分数。前述步骤S202中得到符合度评估特征簇的具体实现过程为：去除特征标记字符编号为2的聚类特征簇中包含的与特征标记字符编号为1的聚类特征簇中特征完全相同的特征，并将特征标记字符编号为2的聚类特征簇中包含的与特征标记字符编号为1的聚类特征簇中特征存在差异的特征补充至所述特征标记字符编号为1的聚类特征簇中，得到符合度评估特征簇。本申请实施例提供的方法，通过将无标签降维特征集合与多个聚类特征簇逐一进行特征符合度评估，得到与之最匹配的聚类特征簇集合，并通过将无标签降维特征集合输入至与之最匹配的子检测模型中进行异常流量检测，最终得到异常流量检测结果。该方法通过提供一种特征符合度评估方法，精准捕捉无标签流量间的特征偏差，降低了无标签流量特征偏差对异常流量检测结果的影响，从而提高了现有异常流量检测模型的检测准确度。下面，以经改进正余弦优化算法引导簇生成的K-Means聚类算法为例，对于前述步骤S102中如何将有标签降维特征集合输入至聚类模型中进行训练，得到多个聚类特征簇进行详细说明。图3为本申请实施例提供的又一种网络异常流量精细化检测方法的流程示意图。如图3所示，前述步骤S102主要包括以下步骤：S301.定义改进正余弦优化聚类模型的初始化参数，并建立初始化样本簇；S302.将初始化参数及初始化样本簇输入至K-Means聚类模型中进行训练，得到数量小于或等于聚类簇阈值参数的多个原始聚类特征簇；S303.计算初始化样本簇的适应度，并根据求解结果在每个原始聚类特征簇中展开寻优，获取原始聚类特征簇的簇内最优解。S304.根据原始聚类特征簇的簇内最大值和簇内最小值，将除原始聚类特征簇集合中的全局最优簇以外的其他样本簇展开柯西算子混沌变异，并更新全局最优簇集合。S305.将原始聚类特征簇中全局最优簇集合的适应度逐一与全局最优簇集合初始值的适应度进行比较，最终获得适应度最优的聚类特征簇集合。其中，前述步骤S301中的初始化参数主要包括样本量、簇大小、聚类迭代次数、聚类簇阈值参数、全局最优簇初始值以及全局最优簇集合初始值等。在定义初始化参数后，利用蒙特卡洛模拟方法建立分布均匀、无样本重叠的初始化簇，用于生成可划分多个子检测器的全局最优聚类特征簇集合。前述步骤S303中初始化样本簇的适应度主要用于评价该初始化样本簇的性能优劣，其计算的具体实现过程为:。其中，为适应度的最大取值范围，为适应度系数，为总的训练迭代次数，为当前的迭代次数，为适应度指数。原始聚类特征簇的簇内最优解包括每个原始聚类特征簇的簇内最大值和原始聚类特征簇的簇内最小值以及原始聚类特征簇集合中的全局最优簇和全局最优簇集合。前述步骤S304中进行柯西算子混沌变异的目的在于优化全局搜索收敛性能，获得更为理想的全局最优簇集合。其中，全局最优簇集合的更新具体是指全局最优簇集合中全局最优簇的坐标更新。前述步骤S305的具体实现过程为：选取全局最优簇集合适应度大于全局最优簇集合初始适应度的全局最优簇，并根据该全局最优簇更新原始聚类特征簇集合，直到遍历全局最优簇集合中的所有全局最优簇。其中，适应度最优的聚类特征簇集合将用于划分带有不同特征标记的子检测器。本申请实施例提供的方法，通过将有标签降维特征集合输入至经由全局优化算法引导簇生成的聚类模型中进行训练，得到多个可添加特征标记的聚类特征簇，为实现异常流量的精细化检测提供模型划分依据。相较于其他异常流量检测模型训练方法，该方法首先通过经优化算法引导簇生成的聚类模型生成聚类特征簇，从而有效识别不同流量数据间的特征偏差。下面，对于上述图1至图3描述的网络异常流量精细化检测方法所搭建的网络异常流量精细化检测模型的结构及功能进行介绍。图4为本申请实施例提供的一种网络异常流量精细化检测模型示意图。如图4所示，该网络异常流量精细化检测模型主要包括：经由改进正余弦优化算法引导簇生成的K-Means聚类模型、具有特征标记的聚类特征簇以及带有聚类特征簇标记的多个子检测模型。其中，有标签降维特征集合用于输入至经由改进正余弦优化算法引导簇生成的K-Means聚类模型中，生成多个聚类特征簇；利用聚类特征簇获取特征标记，得到带有聚类特征簇标记的多个子检测XGBoost模型；该多个子检测XGBoost模型用于训练有标签降维流量数据样本；之后，多个子检测XGBoost模型分别测试完成特征符合度评估后与之最为匹配的无标签降维流量数据样本，最终得到异常流量的精细化检测结果。本申请实施例提供的方法，通过以聚类特征簇特征标记和簇大小为划分依据将原始异常流量检测模型划分为多个子检测器，通过将多个聚类特征簇输入至各自所属子检测器中进行训练，得到多个子检测模型。相较于其他异常流量检测模型训练方法，该方法通过生成聚类特征簇划分多个子检测模型，可实现异常流量的精细化检测，有效提高异常流量检测模型的准确度。最后应说明的是：以上各实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述各实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围。
