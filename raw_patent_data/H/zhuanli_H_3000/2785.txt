标题title
一种流量统计方法、网卡及电子设备
摘要abst
本申请涉及一种流量统计方法、网卡及电子设备，属于网络通信技术领域。该方法应用于包括高速缓存和存储器的网卡，方法包括：获取待统计流量报文对应的特征信息，不同类型的流量报文对应的特征信息不同；根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型；若不能确定待统计流量报文所属的类型，根据待统计流量报文对应的特征信息与存储器中存储的特征信息，确定待统计流量报文所属的类型；对待统计流量报文所属类型的统计结果进行更新。本申请采用先访问高速缓存再访问存储器的方式，不仅可以减少存储器的访问频率，还可以极大的提高流量统计的效率。
权利要求书clms
1.一种流量统计方法，其特征在于，应用于网卡，所述网卡包括高速缓存和存储器，所述高速缓存中存储有不同类型的流量报文对应的特征信息中的关键信息，所述存储器中存储有所述不同类型的流量报文对应的特征信息中的全部信息；所述方法包括：获取待统计流量报文对应的特征信息，不同类型的流量报文对应的特征信息不同；根据所述待统计流量报文对应的特征信息与所述高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型；若不能确定所述待统计流量报文所属的类型，根据所述待统计流量报文对应的特征信息与所述存储器中存储的特征信息，确定所述待统计流量报文所属的类型；对所述待统计流量报文所属类型的统计结果进行更新。2.根据权利要求1所述的方法，其特征在于，根据所述待统计流量报文对应的特征信息与所述高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型，包括：将所述待统计流量报文对应的特征信息与从所述高速缓存中读取的关键信息进行匹配；根据匹配结果判断是否能确定所述待统计流量报文所属的类型，其中，若匹配结果不唯一，则不能确定所述待统计流量报文所属的类型。3.根据权利要求1所述的方法，其特征在于，所述待统计流量报文对应的特征信息包括：所述待统计流量报文的五元组信息的哈希运算结果、所述待统计流量报文的五元组信息的循环冗余校验结果，所述关键信息包括不同类型的流量报文的五元组信息的哈希运算结果中的指定部分和不同类型的流量报文的五元组信息的循环冗余校验结果。4.根据权利要求3所述的方法，其特征在于，根据所述待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型，包括：将所述待统计流量报文对应的哈希运算结果中的指定部分与从所述高速缓存中读取的不同类型的流量报文对应的哈希运算结果中的指定部分进行初次匹配；若初次匹配结果不唯一，将所述待统计流量报文对应的循环冗余校验结果与从所述高速缓存中读取的不同类型的流量报文对应的循环冗余校验结果进行二次匹配；其中，若初次匹配结果不唯一且二次匹配结果也不唯一，则不能确定所述待统计流量报文所属的类型。5.根据权利要求1所述的方法，其特征在于，根据所述待统计流量报文对应的特征信息与所述高速缓存中存储的关键信息，能确定所述待统计流量报文所属的类型，所述方法还包括：对所述待统计流量报文所属类型的统计结果进行更新。6.根据权利要求5所述的方法，其特征在于，所述统计结果包括字节数和报文数；对所述待统计流量报文所属类型的统计结果进行更新，包括：将所述待统计流量报文所属类型的统计结果中的当前字节数更新为当前字节数加所述待统计流量报文的字节数，将所述待统计流量报文所属类型的统计结果中的当前报文数更新为当前报文数加所述待统计流量报文的数量。7.一种网卡，其特征在于，包括：网络接口，用于接收待统计流量报文；高速缓存，用于存储不同类型的流量报文对应的特征信息中的关键信息；存储器，用于存储有不同类型的流量报文对应的特征信息中的全部信息；控制器，用于获取待统计流量报文对应的特征信息，不同类型的流量报文对应的特征信息不同，并根据所述待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型，若不能确定所述待统计流量报文所属的类型，根据所述待统计流量报文对应的特征信息与存储器中存储的特征信息，确定所述待统计流量报文所属的类型；对所述待统计流量报文所属类型的统计结果进行更新。8.根据权利要求7所述的网卡，其特征在于，所述控制器，还用于在根据所述待统计流量报文对应的特征信息与高速缓存中存储的关键信息，能确定所述待统计流量报文所属的类型时，对所述待统计流量报文所属类型的统计结果进行更新。9.根据权利要求7所述的网卡，其特征在于，所述控制器，还用于将中央处理单元下发的不同类型的流量报文对应的特征信息中的关键信息存储至所述高速缓存，以及将所述不同类型的流量报文对应的特征信息中的全部信息存储至所述存储器。10.一种电子设备，其特征在于，包括如权利要求7-9任一项所述的网卡。
说明书desc
技术领域本申请属于网络通信技术领域，具体涉及一种流量统计方法、网卡及电子设备。背景技术图1为FPGA网卡中常见的缓存装置的结构示意图，包括PCIE单元、两个DDR单元和两个DDR，一个DDR单元对应一个DDR，一个DDR对应一个数据通路。当前对DDR的读写控制的设计思路包括：中央处理器直接通过PCIE总线对DDR单元进行读写控制，从而对DDR进行访问。如果FPGA硬件资源紧张，只能提供一个DDR，需要对数据进行多路并行处理时，若采用现有这种方案，由于高频率读取DDR，受DDR多次充放电影响，会造成整个数据链路处理性能降低。发明内容鉴于此，本申请的目的在于提供一种流量统计方法、网卡及电子设备，以改善现有FPGA网卡因高频率读取DDR，受DDR多次充放电影响，会造成整个数据链路处理性能降低的问题。本申请的实施例是这样实现的：第一方面，本申请实施例提供了一种流量统计方法，应用于网卡，所述网卡包括高速缓存和存储器，所述高速缓存中存储有不同类型的流量报文对应的特征信息中的关键信息，所述存储器中存储有所述不同类型的流量报文对应的特征信息中的全部信息；所述方法包括：获取待统计流量报文对应的特征信息，不同类型的流量报文对应的特征信息不同；根据所述待统计流量报文对应的特征信息与所述高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型；若不能确定所述待统计流量报文所属的类型，根据所述待统计流量报文对应的特征信息与所述存储器中存储的特征信息，确定所述待统计流量报文所属的类型；对所述待统计流量报文所属类型的统计结果进行更新。本申请实施例中，在高速缓存中存储不同类型的流量报文对应的特征信息中的关键信息，在存储器中存储不同类型的流量报文对应的特征信息中的全部信息；在进行流量统计时，优先根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型，在不能确定待统计流量报文所属的类型，才根据待统计流量报文对应的特征信息与存储器中存储的特征信息，以此确定待统计流量报文所属的类型，从而实现对待统计流量报文的流量统计，这样不仅可以提高流量统计的效率，还可以减少存储器的访问频率，从而提高整体的处理性能。结合第一方面实施例的一种可能的实施方式，根据所述待统计流量报文对应的特征信息与所述高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型，包括：将所述待统计流量报文对应的特征信息与从所述高速缓存中读取的关键信息进行匹配；根据匹配结果判断是否能确定所述待统计流量报文所属的类型，其中，若匹配结果不唯一，则不能确定所述待统计流量报文所属的类型。本申请实施例中，通过将待统计流量报文对应的特征信息与从高速缓存中读取的关键信息进行匹配，由于高速缓存的访问速度很快，这样可以快速判断是否能确定待统计流量报文所属的类型。结合第一方面实施例的一种可能的实施方式，所述待统计流量报文对应的特征信息包括：所述待统计流量报文的五元组信息的哈希运算结果、所述待统计流量报文的五元组信息的循环冗余校验结果，所述关键信息包括不同类型的流量报文的五元组信息的哈希运算结果中的指定部分和不同类型的流量报文的五元组信息的循环冗余校验结果。本申请实施例中，通过增加五元组信息的循环冗余校验结果，相比于特征信息仅包括流量报文对应的五元组信息的哈希运算结果来说，可以避免因为冲突情况所带来的准确性下降的问题，通过增加循环冗余校验，即便出现五元组不同但是哈希运算结果相同的冲突情况，也可以准确的区分不同的报文类型，从而提高了数据查询的准确性。结合第一方面实施例的一种可能的实施方式，根据所述待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型，包括：将所述待统计流量报文对应的哈希运算结果中的指定部分与从所述高速缓存中读取的不同类型的流量报文对应的哈希运算结果中的指定部分进行初次匹配；若初次匹配结果不唯一，将所述待统计流量报文对应的循环冗余校验结果与从所述高速缓存中读取的不同类型的流量报文对应的循环冗余校验结果进行二次匹配；其中，若初次匹配结果不唯一且二次匹配结果也不唯一，则不能确定所述待统计流量报文所属的类型。本申请实施例中，优先将待统计流量报文对应的哈希运算结果中的指定部分与从高速缓存中读取的不同类型的流量报文对应的哈希运算结果中的指定部分进行初次匹配，只有在匹配结果不唯一，才进行二次匹配，这样可以在提高数据查询的准确性的同时，提高效率。结合第一方面实施例的一种可能的实施方式，根据所述待统计流量报文对应的特征信息与所述高速缓存中存储的关键信息，能确定所述待统计流量报文所属的类型，所述方法还包括：对所述待统计流量报文所属类型的统计结果进行更新。本申请实施例中，若能确定待统计流量报文所属的类型，则直接对待统计流量报文所属类型的统计结果进行更新，而无需再次查询存储器，从而可以减少存储器的访问频率，从而提高整体的处理性能。结合第一方面实施例的一种可能的实施方式，所述统计结果包括字节数和报文数；对所述待统计流量报文所属类型的统计结果进行更新，包括：将所述待统计流量报文所属类型的统计结果中的当前字节数更新为当前字节数加所述待统计流量报文的字节数，将所述待统计流量报文所属类型的统计结果中的当前报文数更新为当前报文数加所述待统计流量报文的数量。本申请实施例中，通过对统计结果中的字节数和报文数进行更新，从而可以快速获悉一段时间内该网卡所接收的同一类流量报文的字节数和报文数等关键信息。第二方面，本申请实施例还提供了一种网卡，包括：网络接口、高速缓存、存储器、控制器；网络接口，用于接收待统计流量报文；高速缓存，用于存储不同类型的流量报文对应的特征信息中的关键信息；存储器，用于存储有不同类型的流量报文对应的特征信息中的全部信息；控制器，用于获取待统计流量报文对应的特征信息，不同类型的流量报文对应的特征信息不同，并根据所述待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型，若不能确定所述待统计流量报文所属的类型，根据所述待统计流量报文对应的特征信息与存储器中存储的特征信息，确定所述待统计流量报文所属的类型；对所述待统计流量报文所属类型的统计结果进行更新。结合第一方面实施例的一种可能的实施方式，所述控制器，还用于在在根据所述待统计流量报文对应的特征信息与高速缓存中存储的关键信息，能确定所述待统计流量报文所属的类型时，对所述待统计流量报文所属类型的统计结果进行更新。结合第一方面实施例的一种可能的实施方式，所述控制器，还用于将中央处理单元下发的不同类型的流量报文对应的特征信息中的关键信息存储至所述高速缓存，以及将所述不同类型的流量报文对应的特征信息中的全部信息存储至所述存储器。第三方面，本申请实施例还提供了一种电子设备，包括：如上述第二方面实施例和/或结合第二方面实施例的任一种可能的实施方式提供的网卡。本申请的其他特征和优点将在随后的说明书阐述。本申请的目的和其他优点可通过在所写的说明书以及附图中所特别指出的结构来实现和获得。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。通过附图所示，本申请的上述及其它目的、特征和优势将更加清晰。在全部附图中相同的附图标记指示相同的部分。并未刻意按实际尺寸等比例缩放绘制附图，重点在于示出本申请的主旨。图1为现有技术中中央处理器与FPGA中的缓存装置相连接的结构示意图。图2示出了本申请实施例提供的一种网卡的结构示意图。图3示出了本申请实施例提供的又一种网卡的结构示意图。图4示出了本申请实施例提供的一种流量统计方法的流程示意图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行描述。应注意到：相似的标号和字母在下面的附图中表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中不需要对其进行进一步定义和解释。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。再者，本申请中术语“和/或”，仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。本申请实施例提供了一种网卡，如FPGA网卡，如图2所示。该FPGA网卡包括：网络接口、高速缓存和存储器、控制器以及PCIE接口。网络接口、高速缓存、存储器、控制器、PCIE接口各元件相互之间直接或间接地电性连接，以实现数据的传输或交互。例如，这些元件相互之间可通过一条或多条通讯总线或信号线实现电性连接。可以理解的是，该存储器除了可以是DDR外，还可以是其他类型的存储器，因此，不能将上述示例的DDR理解成是对存储器的限制。本申请中，通过增设高速缓存，与图1这种直接读取DDR数据的方式不同，采用先访问高速缓存再访问存储器的方式，即当要读取数据时，优先从高速缓存中查找，如果找到就立即处理，不必再访问下一级存储器，可以减少存储器的访问频率，从而可以极大的提高访问的效率。可选地，网络接口的数量可以为多个，如为2个，一个网络接口对应一个数据通路。网络接口用于接收待统计流量报文。一种实施方式下，可以是多个网络接口共用一个高速缓存和一个控制器。可选地，一个网络接口也可以仅对应一个高速缓存，相应地，高速缓存的数量也可以为多个，如为2个，一个网络接口对应一个高速缓存。多个高速缓存可以共用一个控制器。可选地，一个高速缓存也可以仅对应一个控制器，相应地，控制器的数量也可以为多个，如为2个，一个控制器对应一个高速缓存，多个控制器共用一个存储器。此时，该网卡的结构示意图如图3所示。在图3所示实施方式下，每个控制器仅负责对对应的网络接口所接收到的流量报文进行流量统计。例如，控制器1负责对网络接口1所接收到的流量报文进行流量统计，控制器2负责对网络接口2所接收到的流量报文进行流量统计。该网卡在进行流量统计时，为了提高流量统计的效率。本申请实施例中，在高速缓存中存储不同类型的流量报文对应的特征信息中的关键信息，在存储器中存储不同类型的流量报文对应的特征信息中的全部信息。当网络接口在接收到待统计流量报文时，优先根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型，在不能确定待统计流量报文所属的类型，才根据待统计流量报文对应的特征信息与存储器中存储的特征信息，以此确定待统计流量报文所属的类型，从而实现对待统计流量报文的流量统计，这样不仅可以提高流量统计的效率，还可以减少存储器的访问频率，从而提高整体的处理性能。一种可选实施方式下，不同类型的流量报文对应的特征信息可以仅包括：不同类型的流量报文对应的五元组信息的哈希运算结果。又一种可选实施方式下，不同类型的流量报文对应的特征信息可以包括：不同类型的流量报文对应的五元组信息的哈希运算结果、不同类型的流量报文对应的五元组信息的循环冗余校验结果。相比于特征信息仅包括流量报文对应的五元组信息的哈希运算结果来说，通过增加五元组信息的循环冗余校验结果，可以避免因为冲突情况所带来的准确性下降的问题，通过增加循环冗余校验，即便出现五元组不同但是哈希运算结果相同的冲突情况，也可以准确的区分不同的报文类型，从而提高了数据查询的准确性。其中，不同类型的流量报文具有唯一的标识，该流量ID可以是中央处理器生成的流量ID序号。不同的五元组信息对应的流量报文类型不同，例如不同的UDP报文或TCP报文中的五元组信息不同，则对应不同类型的流量报文。其中，五元组信息包括：源IP、目的IP、源端口、目的端口和协议号信息。假设某个业务场景中涉及5种不同类型的UDP报文或TCP报文，也即有五种不同的五元组信息。则可以针对每一种五元组信息分别进行哈希运算以及循环冗余校验，如进行CRC16校验，得到哈希运算结果以及循环冗余校验结果。之后中央处理器通过PCIE接口下发每一种五元组信息的哈希运算结果和循环冗余校验结果。高速缓存存储不同类型的流量报文对应的特征信息中的关键信息，如存储不同类型的流量报文的五元组信息的哈希运算结果中的指定部分和不同类型的流量报文的五元组信息的循环冗余校验结果。高速缓存，用于存储不同类型的流量报文对应的特征信息中的关键信息，例如存储中央处理器通过PICE接口下发的不同类型的流量报文对应的特征信息中的关键信息。例如，存储不同类型的流量报文的五元组信息的哈希运算结果中的高15bit的信息和不同类型的流量报文的五元组信息的循环冗余校验结果。即高速缓存只需要对哈希运算结果中的高15bit的数据、循环冗余校验结果以及对应的流量ID进行存储。存储地址可以取哈希运算结果的低9bit或10bit，这样可以增加512或者1024组存储空间，将剩余地址和对应的关键数据写入，这样可以大大减少消耗的资源。存储器，用于存储不同类型的流量报文对应的特征信息中的全部信息，例如，存储中央处理器通过PICE接口下发的不同类型的流量报文对应的特征信息中的全部信息。即存储器需要对整个哈希运算结果、循环冗余校验结果以及对应的流量ID进行存储。PCIE接口分别与高速缓存和存储器电连接，PCIE接口，用于接收中央处理单元下发的不同类型的流量报文对应的特征信息。控制器，用于将不同类型的流量报文对应的特征信息中的关键信息存储至高速缓存，以及将不同类型的流量报文对应的特征信息中的全部信息存储至存储器。其中，高速缓存和存储器均会对中央处理单元通过PCIE接口下发的数据进行存储，不同之处在于，高速缓存仅存储其中的关键信息，而存储器存储的是全部信息。在实际运用中需要存储的完整数据字节数往往很大，截取其中部分关键数据，这样可以减少高速缓存的资源消耗。控制器，还用于获取待统计流量报文对应的特征信息，不同类型的流量报文对应的特征信息不同，并根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型，若不能确定待统计流量报文所属的类型，根据待统计流量报文对应的特征信息与存储器中存储的特征信息，确定待统计流量报文所属的类型，对待统计流量报文所属类型的统计结果进行更新。网络接口接收到待统计流量报文后，控制器便可以去获取待统计流量报文对应的特征信息，之后根据该特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型，若不能确定待统计流量报文所属的类型，则需要进一步根据该特征信息与存储器中存储的特征信息，来确定待统计流量报文所属的类型，之后对待统计流量报文所属类型的统计结果进行更新。控制器获取待统计流量报文对应的特征信息的过程可以是：获取待统计流量报文对应的五元组信息，然后对五元组信息进行哈希运算，得到对应的哈希运算结果，以及对该五元组信息进行循环冗余校验，得到对应的循环冗余校验结果。可以理解的是，控制器在对待统计流量报文的五元组信息进行哈希运算以及循环冗余校验所使用的算法与上述中央处理器在对不同类型的流量报文的五元组信息进行哈希运算以及循环冗余校验所使用的算法需要保持一致。如果能根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，确定待统计流量报文所属的类型，则控制器还用于对待统计流量报文所属类型的统计结果进行更新，此时就无需再去访问存储器，可以减少存储器的访问频率。其中，控制器在根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型时，其过程可以是：将待统计流量报文对应的特征信息与从高速缓存中读取的关键信息进行匹配，根据匹配结果判断是否能确定待统计流量报文所属的类型，其中，若匹配结果不唯一，则不能确定待统计流量报文所属的类型。即首先从高速缓存中读取其存储的关键信息，然后将待统计流量报文对应的特征信息与从高速缓存中读取的关键信息进行匹配，之后根据匹配结果判断是否能确定待统计流量报文所属的类型。若匹配结果不唯一，说明至少匹配到2个及以上的关键信息。一种实施方式下，待统计流量报文对应的特征信息包括：待统计流量报文的五元组信息的哈希运算结果、待统计流量报文的五元组信息的循环冗余校验结果，关键信息包括不同类型的流量报文的五元组信息的哈希运算结果中的指定部分和不同类型的流量报文的五元组信息的循环冗余校验结果。在该种实施方式下，根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型的过程可以是：将待统计流量报文对应的哈希运算结果中的指定部分与从高速缓存中读取的不同类型的流量报文对应的哈希运算结果中的指定部分进行初次匹配；若初次匹配结果不唯一，将待统计流量报文对应的循环冗余校验结果与从高速缓存中读取的不同类型的流量报文对应的循环冗余校验结果进行二次匹配；其中，若初次匹配结果不唯一且二次匹配结果也不唯一，则不能确定待统计流量报文所属的类型。若初次匹配结果唯一，或者，初次匹配结果不唯一但二次匹配结果唯一，则能确定待统计流量报文所属的类型。其中，若初次匹配结果唯一，则可以不用将待统计流量报文对应的循环冗余校验结果与从高速缓存中读取的不同类型的流量报文对应的循环冗余校验结果进行二次匹配，便可直接确定待统计流量报文所属的类型，即确定待统计流量报文所属的流量ID。其中，根据待统计流量报文对应的特征信息与存储器中存储的特征信息，确定待统计流量报文所属的类型的原理与上述根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型的原理类似，此处不再展开进行说明。统计结果包括字节数和/或报文数，一种可选实施方式下，统计结果包括字节数和报文数，此时，对待统计流量报文所属类型的统计结果进行更新的过程可以是：将待统计流量报文所属类型的统计结果中的当前字节数更新为当前字节数加待统计流量报文的字节数，将待统计流量报文所属类型的统计结果中的当前报文数更新为当前报文数加待统计流量报文的数量。即更新后的字节数＝更新前的当前字节数+待统计流量报文的字节数；更新后的报文数＝更新前的报文数+待统计流量报文的数量。该网卡还可以将流量统计结果通过PCIE总线上报中央处理器。即将统计结果上报给中央处理器。传统设计一个数据通路只查询一个存储器，直接访问DDR，在FPGA网卡片内资源受限的情况下，比如只有一个DDR时，需要对数据进行多路并行处理，由于高频率读取DDR，受DDR多次充放电影响，会造成整个数据链路处理性能降低。本申请通过引入2个高速缓存，分别为高速缓存1和高速缓存2，采用先访问高速缓存再访问存储器的方式，即当要读取数据时，优先从高速缓存中查找，如果找到就立即处理，不必再访问下一级存储器，可以减少存储器的访问频率，从而可以极大的提高访问的效率。这样使得该FPGA网卡在进行流量统计时，可以极大的提高流量统计的效率。基于同样的发明构思，本申请实施例还提供了一种流量统计方法，该流量统计方法应用于上述的网卡，下面将结合图4，对本申请实施例提供的流量统计方法进行说明。S1：获取待统计流量报文对应的特征信息，不同类型的流量报文对应的特征信息不同。一种实施方式下，待统计流量报文对应的特征信息包括：待统计流量报文的五元组信息的哈希运算结果、待统计流量报文的五元组信息的循环冗余校验结果。获取待统计流量报文对应的特征信息的过程可以是，获取待统计流量报文对应的五元组信息，然后对五元组信息进行哈希运算，得到对应的哈希运算结果，以及对该五元组信息进行循环冗余校验，得到对应的循环冗余校验结果。S2：根据所述待统计流量报文对应的特征信息与所述高速缓存中存储的关键信息，判断是否能确定所述待统计流量报文所属的类型。一种实施方式下，根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型的过程可以是：将待统计流量报文对应的特征信息与从高速缓存中读取的关键信息进行匹配；根据匹配结果判断是否能确定待统计流量报文所属的类型，其中，若匹配结果不唯一，则不能确定待统计流量报文所属的类型。一种实施方式下，待统计流量报文对应的特征信息包括：待统计流量报文的五元组信息的哈希运算结果、待统计流量报文的五元组信息的循环冗余校验结果，关键信息包括不同类型的流量报文的五元组信息的哈希运算结果中的指定部分和不同类型的流量报文的五元组信息的循环冗余校验结果。在该种实施方式下，根据待统计流量报文对应的特征信息与高速缓存中存储的关键信息，判断是否能确定待统计流量报文所属的类型的过程可以是：将待统计流量报文对应的哈希运算结果中的指定部分与从高速缓存中读取的不同类型的流量报文对应的哈希运算结果中的指定部分进行初次匹配；若初次匹配结果不唯一，将待统计流量报文对应的循环冗余校验结果与从高速缓存中读取的不同类型的流量报文对应的循环冗余校验结果进行二次匹配；其中，若初次匹配结果不唯一且二次匹配结果也不唯一，则不能确定待统计流量报文所属的类型。S3：若不能确定所述待统计流量报文所属的类型，根据所述待统计流量报文对应的特征信息与所述存储器中存储的特征信息，确定所述待统计流量报文所属的类型。若S2不能确定待统计流量报文所属的类型，则根据待统计流量报文对应的特征信息与存储器中存储的特征信息，确定待统计流量报文所属的类型。若S2能确定待统计流量报文所属的类型，则该流量统计方法还包括：对待统计流量报文所属类型的统计结果进行更新。S4：对所述待统计流量报文所属类型的统计结果进行更新。若统计结果包括字节数和报文数；对待统计流量报文所属类型的统计结果进行更新的过程可以是：将待统计流量报文所属类型的统计结果中的当前字节数更新为当前字节数加待统计流量报文的字节数，将待统计流量报文所属类型的统计结果中的当前报文数更新为当前报文数加待统计流量报文的数量。本申请实施例所提供的流量统计方法，其实现原理及产生的技术效果和前述网卡实施例相同，为简要描述，方法实施例部分未提及之处，可参考前述网卡实施例中相应内容。基于同样的发明构思，本申请实施例还提供了一种电子设备，该电子设备包括前述的网卡。该电子设备可以为包含上述网卡的任意电子产品，包括但不限于手机、平板、电脑、工控机、车载设备等产品。本申请实施例所提供的电子设备，其实现原理及产生的技术效果和前述网卡实施例相同，为简要描述，电子设备实施例部分未提及之处，可参考前述网卡实施例中相应内容。需要说明的是，本说明书中的各个实施例均采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似的部分互相参见即可。以上所述，仅为本申请的具体实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本申请的保护范围之内。因此，本申请的保护范围应所述以权利要求的保护范围为准。
