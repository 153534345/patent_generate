标题title
解码装置、用于解码装置的认证方法和移动终端
摘要abst
本申请涉及数字解码技术领域，公开一种解码装置。该装置通过在安全芯片和主控芯片中内置相同的主密钥，共同对标识信息进行加密，实现了安全芯片对主控芯片的认证，无需与证书服务器进行通信，在避免非授权设备的违规操作的同时，节省了解码装置的认证时间，进而提高了解码装置的解码效率。本申请还公开一种用于解码装置的认证方法和移动终端。
权利要求书clms
1.一种解码装置，其特征在于，包括：安全芯片，内置有主密钥，用于读取内置于所述安全芯片的标识信息；主控芯片，内置有所述主密钥，与所述安全芯片连接，用于接收所述安全芯片发送的所述标识信息，对所述主密钥、第一随机数以及所述标识信息执行加密操作，生成第一主控摘要；其中，所述第一随机数由所述主控芯片生成，并传输给所述安全芯片；所述安全芯片，还用于接收所述主控芯片发送的所述第一随机数，对所述主密钥、所述标识信息以及所述第一随机数执行加密操作，生成第一安全摘要，并将所述第一安全摘要传输至所述主控芯片；所述主控芯片，还用于根据所述第一主控摘要和所述第一安全摘要进行初始化认证，如果认证结果为认证成功，允许所述安全芯片和所述主控芯片执行初始化。2.根据权利要求1所述的解码装置，其特征在于，所述主控芯片和所述安全芯片均内置有预设第一加密操作和预设第二加密操作：所述主控芯片具体用于，根据所述主密钥对所述标识信息执行预设第一加密操作，得到第一子摘要；使用所述第一随机数对所述第一子摘要执行预设第二加密操作，生成第一主控摘要；所述安全芯片具体用于，根据所述主密钥对所述标识信息执所述行预设第一加密操作，得到第二子摘要；使用所述第一随机数对所述第二子摘要执行所述预设第二加密操作，生成第一主控摘要。3.根据权利要求2所述的解码装置，其特征在于，所述第一加密操作和所述第二加密操作均为哈希运算消息认证码HMAC加密操作。4.根据权利要求1所述的解码装置，其特征在于，所述主控芯片还用于：如果所述认证结果为认证失败，控制所述解码装置终止解码操作。5.根据权利要求1-4任一项所述的解码装置，其特征在于，所述主控芯片和所述安全芯片均内置有预设第三加密操作；所述安全芯片还用于，在预设扫码认证时刻，接收摄像头芯片发送的待扫码图像，根据第二随机数对所述待扫码图像执行所述预设第三加密操作，生成第二安全子摘要，并将所述第二安全子摘要传输给所述主控芯片；其中，所述摄像头芯片与所述解码装置安装于同一移动终端，所述预设扫码认证时刻为所述解码装置开始扫码之前，或者所述解码装置从开始扫码到扫码结束之间的任意时刻；所述主控芯片还用于，在所述预设扫码认证时刻，接收所述摄像头芯片发送的所述待扫码图像，根据第三随机数对所述待扫码图像执行所述预设第三加密操作，生成第二主控子摘要，并根据所述第二主控子摘要和所述第二安全子摘要进行解码安全认证，如果认证结果为认证成功，继续执行解码操作；其中，所述第二随机数与所述第三随机数相同。6.根据权利要求5所述的解码装置，其特征在于，所述安全芯片具体用于：按照预设截取规则获得所述待扫码图像中的指定像素序列；根据所述第二随机数对所述指定像素序列执行所述预设第二加密操作，生成第二安全子摘要；其中，所述预设截取规则内置于所述安全芯片与所述主控芯片中；所述主控芯片具体用于：按照预设截取规则获得所述待扫码图像中的指定像素序列；根据所述第二随机数对所述指定像素序列执行所述预设第二加密操作，生成第二主控子摘要；其中，所述预设截取规则内置与所述安全芯片与所述主控芯片中。7.据权利要求5所述的解码装置，其特征在于，所述主控芯片和所述安全芯片均内置有随机数生成模块；所述主控芯片具体用于，通过所述随机数生成模块生成所述第二随机数；所述安全芯片具体用于，通过所述随机数生成模块生成所述第三随机数。8.一种用于解码装置的认证方法，其特征在于，应用于解码装置，所述解码装置包括安全芯片和主控芯片，所述安全芯片和所述主控芯片均内置有主密钥，所述方法包括：所述安全芯片读取内置于所述安全芯的标识信息；所述主控芯片接收所述安全芯片发送的所述标识信息；所述主控芯片生成第一随机数，并传输给所述安全芯片；所述主控芯片对所述主密钥、第一随机数以及所述标识信息执行加密操作，生成第一主控摘要；所述安全芯片接收所述主控芯片发送的所述第一随机数，并对所述主密钥、所述标识信息以及所述第一随机数执行加密操作，生成第一安全摘要，将所述第一安全摘要传输至所述主控芯片；所述主控芯片根据所述第一主控摘要和所述第一安全摘要进行初始化认证，如果认证结果为认证成功，允许所述安全芯片和所述主控芯片执行初始化。9.根据权利要求8所述的方法，其特征在于，所述主控芯片和所述安全芯片均内置有预设第三加密操作，所述方法还包括：所述安全芯片接收摄像头芯片发送的扫码指令和待扫码图像，根据第二随机数对所述待扫码图像执行所述预设第二加密操作，生成第二安全子摘要，并将所述第二安全子摘要传输给所述主控芯片；所述主控芯片接收所述摄像头芯片发送的所述扫码指令和所述待扫码图像，根据第三随机数对所述待扫码图像执行所述预设第二加密操作，生成第二主控子摘要，并根据所述第二主控子摘要和所述第二安全子摘要进行解码安全认证，如果认证结果为认证成功，继续执行解码操作；其中，所述第二随机数与所述第三随机数相同。10.一种移动终端，其特征在于，包括：根据权利要求1-7任一项所述的解码装置；以及摄像头芯片，用于获取待扫码图像，并向所述解码装置中的所述安全芯片和所述主控芯片发送扫码指令以及所述待扫码图像。
说明书desc
技术领域本申请涉及数字解码技术领域，例如涉及一种解码装置、用于解码装置的认证方法和移动终端。背景技术PDA扫码作为一种高效率的扫码应用方式，广泛应用于仓储管理、制造、零售、物流等行业中，其结实耐用，且便捷性高，极大地提升了管理效率。根据解码实现方式的不同，PDA的扫码实现方式分为由ASIC实现的硬解码和由解码算法库实现的软解码两种。软解码常由专门公司提供，并以授权的方式部署于PDA系统中。现有的授权方式分为纯软和基于安全芯片两种，其中的安全芯片的授权方案是通过非对称加密算法实现认证，每次授权需要访问CA请求授权证书，通过授权证书完成身份的识别和认证。在实现本公开实施例的过程中，发现相关技术中至少存在如下问题：设备使用方需要与CA之间频繁的通信，设备使用方无法完全自主可控，从而影响了PDA设备的认证效率。发明内容为了对披露的实施例的一些方面有基本的理解，下面给出了简单的概括。概括不是泛泛评述，也不是要确定关键／重要组成元素或描绘这些实施例的保护范围，而是作为后面的详细说明的序言。本公开实施例提供一种解码装置、用于解码装置的认证方法和移动终端，以提高解码效率。在一些实施例中，解码装置包括：安全芯片，内置有主密钥，用于读取内置于安全芯片的标识信息；主控芯片，内置有主密钥，与安全芯片连接，用于接收安全芯片发送的标识信息，对主密钥、第一随机数以及标识信息执行加密操作，生成第一主控摘要；其中，第一随机数由主控芯片生成，并传输给安全芯片；安全芯片，还用于接收主控芯片发送的第一随机数，对主密钥、标识信息以及第一随机数执行加密操作，生成第一安全摘要，并将第一安全摘要传输至主控芯片；主控芯片，还用于根据第一主控摘要和第一安全摘要进行初始化认证，如果认证结果为认证成功，允许安全芯片和主控芯片执行初始化。这样，通过在安全芯片和主控芯片中内置相同的主密钥，共同对标识信息进行加密，实现了安全芯片对主控芯片的认证，无需与证书服务器进行通信，避免非授权设备的违规操作的同时，节省了解码装置的认证时间，进而提高了解码装置的解码效率。可选地，主控芯片和安全芯片均内置有预设第一加密操作和预设第二加密操作：主控芯片具体用于，根据主密钥对标识信息执行预设第一加密操作，得到第一子摘要；使用第一随机数对第一子摘要执行预设第二加密操作，生成第一主控摘要；安全芯片具体用于，根据主密钥对标识信息执行预设第一加密操作，得到第二子摘要；使用第一随机数对第二子摘要执行预设第二加密操作，生成第一主控摘要。这样，执行相同的两次加密，避免了一次加密造成的偶然解密，进一步提高了解码装置的安全性。可选地，第一加密操作和第二加密操作均为HMAC加密操作。这样，两次加密采用相同的加密算法，且HMAC加密算法运算量较小，减少了初始化认证过程的计算量，提高了解码装置的初始化速度。可选地，主控芯片还用于：如果认证结果为认证失败，控制所述解码装置终止解码操作。可选地，主控芯片和安全芯片均内置有预设第三加密操作；安全芯片还用于，在预设扫码认证时刻，接收摄像头芯片发送的待扫码图像，根据第二随机数对待扫码图像执行预设第三加密操作，生成第二安全子摘要，并将第二安全子摘要传输给主控芯片；其中，摄像头芯片与解码装置安装于同一移动终端，所述预设扫码认证时刻为所述解码装置开始扫码之前，或者所述解码装置从开始扫码到扫码结束之间的任意时刻；主控芯片还用于，在所述预设扫码认证时刻，接收摄像头芯片发送的待扫码图像，根据第三随机数对待扫码图像执行预设第二加密操作，生成第二主控子摘要，并根据第二主控子摘要和第二安全子摘要进行解码安全认证，如果认证结果为认证成功，继续执行解码操作；其中，第二随机数与第三随机数相同。这样，在扫码开始或者扫码过程中，再次对解码装置中的主控芯片进行安全认证，即使非法操作完成了初始化，仍然不能保证扫码成功，有效提升了解码装置的安全性，保证了解码信息的准确安全。可选地，安全芯片具体用于：按照预设截取规则获得待扫码图像中的指定像素序列；根据第二随机数对指定像素序列执行预设第二加密操作，生成第二安全子摘要；其中，预设截取规则内置于安全芯片与主控芯片中；主控芯片具体用于：按照预设截取规则获得待扫码图像中的指定像素序列；根据第二随机数对指定像素序列执行预设第二加密操作，生成第二主控子摘要；其中，预设截取规则内置与安全芯片与主控芯片中。这样，并不是对待扫码图像整体进行加密，而是主控芯片和安全芯片均使用相同的截取规则，截取待扫码图像的指定像素序列，可以降低加密的运算量，提高解码装置的解码效率。可选地，主控芯片和安全芯片均内置有随机数生成模块；主控芯片具体用于，通过随机数生成模块生成第二随机数；安全芯片具体用于，通过随机数生成模块生成第三随机数。这样，在主控芯片和安全芯片中内置有相同的随机数生成模块，采用了与预存密钥不同的方式进行加密，对解码过程进行多重保护，提高了加密装置的安全性。在一些实施例中，用于解码装置的认证方法应用于解码装置，解码装置包括安全芯片和主控芯片，安全芯片和主控芯片均内置有主密钥，方法包括：安全芯片读取内置于安全芯的标识信息；主控芯片接收安全芯片发送的标识信息；主控芯片生成第一随机数，并传输给安全芯片；主控芯片对主密钥、第一随机数以及标识信息执行加密操作，生成第一主控摘要；安全芯片接收主控芯片发送的第一随机数，并对主密钥、标识信息以及第一随机数执行加密操作，生成第一安全摘要，将第一安全摘要传输至主控芯片；主控芯片根据第一主控摘要和第一安全摘要进行初始化认证，如果认证结果为认证成功，允许安全芯片和主控芯片执行初始化。可选地，主控芯片和安全芯片均内置有预设第三加密操作，方法还包括：安全芯片接收摄像头芯片发送的扫码指令和待扫码图像，根据第二随机数对待扫码图像执行预设第二加密操作，生成第二安全子摘要，并将第二安全子摘要传输给主控芯片；主控芯片接收摄像头芯片发送的扫码指令和待扫码图像，根据第三随机数对待扫码图像执行预设第二加密操作，生成第二主控子摘要，并根据第二主控子摘要和第二安全子摘要进行解码安全认证，如果认证结果为认证成功，继续执行解码操作；其中，第二随机数与第三随机数相同。在一些实施例中，移动终端包括：上述任一项的解码装置；以及摄像头芯片，用于获取待扫码图像，并向解码装置中的安全芯片和主控芯片发送扫码指令以及待扫码图像。本公开实施例提供的解码装置、用于解码装置的认证方法和移动终端，可以实现以下技术效果：通过在安全芯片和主控芯片中内置相同的主密钥，共同对标识信息进行加密，实现了安全芯片对主控芯片的认证，无需与证书服务器进行通信，在避免非授权设备的违规操作的同时，节省了解码装置的认证时间，进而提高了解码装置的解码效率。以上的总体描述和下文中的描述仅是示例性和解释性的，不用于限制本申请。附图说明一个或多个实施例通过与之对应的附图进行示例性说明，这些示例性说明和附图并不构成对实施例的限定，附图中具有相同参考数字标号的元件示为类似的元件，附图不构成比例限制，并且其中：图1是本公开实施例提供的一个解码装置结构示意图；图2是本公开实施例提供的一个解码装置的认证过程示意图；图3是本公开实施例提供的一个解码装置的解码安全认证过程示意图；图4是本公开实施例提供的一种加密算法的流程示意图；图5是本公开实施例提供的一个用于解码装置的认证方法的流程图；图6是本公开实施例提供的另一个用于解码装置的认证方法的流程图；图7是本公开实施例提供的一个移动终端的结构示意图。具体实施方式为了能够更加详尽地了解本公开实施例的特点与技术内容，下面结合附图对本公开实施例的实现进行详细阐述，所附附图仅供参考说明之用，并非用来限定本公开实施例。在以下的技术描述中，为方便解释起见，通过多个细节以提供对所披露实施例的充分理解。然而，在没有这些细节的情况下，一个或多个实施例仍然可以实施。在其它情况下，为简化附图，熟知的结构和装置可以简化展示。本公开实施例的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本公开实施例的实施例。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含。另外，术语“设置”、“连接”、“固定”应做广义理解。例如，“连接”可以是固定连接，可拆卸连接，或整体式构造；可以是机械连接，或电连接；可以是直接相连，或者是通过中间媒介间接相连，又或者是两个装置、元件或组成部分之间内部的连通。对于本领域普通技术人员而言，可以根据具体情况理解上述术语在本公开实施例中的具体含义。需要说明的是，在不冲突的情况下，本公开实施例中的实施例及实施例中的特征可以相互组合。结合图1所示，本公开实施例提供一种解码装置10，包括安全芯片01、主控芯片02，安全芯片01和主控芯片02相连，安全芯片01内置有主密钥，主控芯片也内置有主密钥。其中，安全芯片用于读取内置的安全芯片的标识信息。主控芯片02用于接收安全芯片发送的标识信息，对主密钥、第一随机数以及标识信息执行加密操作，生成第一主控摘要；其中，第一随机数由主控芯片生成，并传输给安全芯片。安全芯片，还用于接收主控芯片发送的第一随机数，对主密钥、标识信息以及第一随机数执行加密操作，生成第一安全摘要，并将第一安全摘要传输至主控芯片。主控芯片，还用于根据第一主控摘要和第一安全摘要进行初始化认证，如果认证结果为认证成功，允许安全芯片和主控芯片执行初始化。解码装置中的主控芯片是解码装置的核心部件，主控芯片连接解码装置中的其他部件，用于根据指令或者预先存储的算法，向其他部件发出执行某个动作的指示，以使解码装置完成解码操作。在主控芯片中，内置有解码算法库，解码算法库可以只包括一种解码算法，也可以包括多种解码算法，针对不同的应用场景，采用不同的解码算法进行编码解码操作。解码装置中的安全芯片是用于对解码装置进行安全认证，例如，验证解码装置是否被篡改等。安全芯片种也内置有解码算法，当进行认证时，安全芯片和主控芯片对相同的信息采用相同的解码算法进行加密和验证，从而不需要从解码装置外部获取认证证书。在对信息进行编码时，安全芯片和主控芯片均根据主密钥、第一随机数和标识信息执行相同的加密操作。其中，主密钥预存于安全芯片和主控芯片种，本公开实施例对主密钥的具体形式不进行限定。标识信息也可称为UID，用于唯一标识一个安全芯片，UID为安全芯片出厂时烧有的芯片序列号，其具有唯一性和不可改写特性。第一随机数由主控芯片生成，例如通过在主控芯片内置随机数生成器来生成一个第一随机数。具体实施过程中，安全芯片对第一随机数，主密钥，标识信息执行预存的加密算法，得到第一安全摘要。主控芯片同样对第一随机数，主密钥，标识信息执行预存的加密算法，得到第一主控摘要。如果设备没有被篡改，那么第一主控摘要与第一安全摘要的内容应该是一致的，基于此，可以根据第一主控摘要和第一安全摘要的一致性来确认设备是否被篡改。本公开实施例提供的解码装置，通过在安全芯片和主控芯片中内置相同的主密钥，共同对标识信息进行加密，实现了安全芯片对主控芯片的认证，无需与证书服务器进行通信，避免非授权设备的违规操作的同时，节省了解码装置的认证时间，进而提高了解码装置的解码效率。可选地，主控芯片02和安全芯片01均内置有预设第一加密操作和预设第二加密操作。主控芯片02具体用于，根据主密钥对标识信息执行预设第一加密操作，得到第一子摘要；使用第一随机数对第一子摘要执行预设第二加密操作，生成第一主控摘要。安全芯片具体用于，根据主密钥对标识信息执行预设第一加密操作，得到第二子摘要；使用第一随机数对第二子摘要执行预设第二加密操作，生成第一主控摘要。这样，主控芯片和安全芯片均执行两次加密，避免了一次加密造成的偶然解密，进一步提高了解码装置的安全性。可选地，第一加密操作和第二加密操作均为HMAC加密操作。这样，两次加密采用相同的加密算法，且HMAC加密算法运算量较小，减少了初始化认证过程的计算量，提高了解码装置的初始化速度。上述主控芯片的操作过程由解码算法库实现，安全芯片的操作过程由存放于安全芯片的初始化程序实现。具体应用时，对于主控芯片，执行第一加密操作，以第一加密操作为HMAC-SHA256为例，通过主密钥对标识信息执HMAC-SHA256加密操作，得到第一子摘要S。例如，S=HMAC-SHA256，其中，M为主密钥，UID为标识信息。同时，对于安全芯片，同样以第一加密操作为HMAC-SHA256为例，通过主密钥对标识信息执行HMAC-SHA256加密操作，得到第二子摘要S’。例如，S’=HMAC-SHA256，其中，M为主密钥，UID为标识信息。通过第一加密操作，分别得到了主控芯片对应的第一子摘要S和安全芯片对应的第二子摘要S’。接下来，针对主控芯片，首先生成第一随机数，第一随机数的生成方式本公开实施例在此不作限定。主控芯片继续使用主密钥，对第一子摘要和第一随机数执行第二加密操作。以第二加密操作仍然是HMAC-SHA256为例，通过主密钥对标识信息和第一随机数执HMAC-SHA256加密操作，得到第一主控摘要H。即，H=HMAC-SHA256，其中，R为第一随机数，S为第一子摘要。对于安全芯片，同样以第二加密操作为HMAC-SHA256为例，首先接收主控芯片发送过来的第一随机数，并通过主密钥对第一随机数、第二子摘要执行HMAC-SHA256加密操作，得到第一安全摘要H’。例如，H’=HMAC-SHA256，其中，R为第一随机数，S’为第一子摘要。最终，安全芯片经过两次加密，得到了第一安全摘要，主控芯片经过两次加密，得到了第一主控摘要。可选地，主控芯片还用于：如果认证结果为认证失败，控制所述解码装置终止解码操作。下面结合图2所示，详细介绍本公开实施例提供的解码器的认证过程示意图。如图2所示，在解码器进行上电后，主控芯片02和安全芯片01按以下过程实现身份认证：S201：安全芯片读取UID，并将UID信息传输给主控芯片。S202：主控芯片读入UID，结合系统主密钥M，执行HMAC算法，生成摘要S。即S=HMAC。S203：安全芯片，通过系统主密钥M，结合读取的UID，执行HMAC算法，生成摘要S’。S204：主控芯片通过内置的随机数生成器生成随机数R，并传输给安全芯片。S205：主控芯片利用随机数R，结合摘要S，执行HMAC算法，生成摘要H。S206：安全芯片读取R，结合摘要S’，执行HMAC算法，生成摘要H’。S207：主控芯片读取H’，并比较H与H’。若H与H’一致，执行步骤S208。否则，执行步骤S209。S208：认证通过，执行后续解码操作。S209：结束初始化。即，不进行后续的解码操作。在实际应用中，还可以在解码装置的显示屏幕上显示相应的提示信息，以便告知使用者初始化失败。为了确保解码装置在每次扫码之前都是安全的，未被篡改的装置，除了在开机时，进行身份认证，还可以在每次扫码任务执行之前或者扫码任务进行过程中，再次进行安全认证。基于此，本公开实施例提供的上述解码装置中的主控芯片和安全芯片均内置有预设第三加密操作。安全芯片还用于，在预设扫码认证时刻，接收摄像头芯片发送的待扫码图像，根据第二随机数对待扫码图像执行预设第三加密操作，生成第二安全子摘要，并将第二安全子摘要传输给主控芯片；其中，摄像头芯片与解码装置安装于同一移动终端，所述预设扫码认证时刻为所述解码装置开始扫码之前，或者所述解码装置从开始扫码到扫码结束之间的任意时刻。主控芯片还用于，在所述预设扫码认证时刻，接收摄像头芯片发送的待扫码图像，根据第三随机数对待扫码图像执行预设第三加密操作，生成第二主控子摘要，并根据第二主控子摘要和第二安全子摘要进行解码安全认证，如果认证结果为认证成功，继续执行解码操作；其中，第二随机数与第三随机数相同。具体地，上述扫码认证过程，可以是在初始化认证通过后，扫码开始之前执行，也可以是在扫码开始之后的任意时刻执行。可以理解的是，上述预设扫码认证时刻可以是一个时刻，也可以是多个时刻。在安全级别要求较高的情况下，可以通过在多个步骤中进行扫码认证，进一步加强扫码装置的安全性。这样，在扫码开始或者扫码过程中，再次对解码装置中的主控芯片进行安全认证，即使非法操作完成了初始化，仍然不能保证扫码成功，有效提升了解码装置的安全性，保证了解码信息的准确安全。可选地，安全芯片具体用于：按照预设截取规则获得待扫码图像中的指定像素序列；根据第二随机数对指定像素序列执行预设第二加密操作，生成第二安全子摘要；其中，预设截取规则内置与安全芯片与主控芯片中。主控芯片具体用于：按照预设截取规则获得待扫码图像中的指定像素序列；根据第二随机数对指定像素序列执行预设第二加密操作，生成第二主控子摘要；其中，预设截取规则内置于安全芯片与主控芯片中。这样，本实施例并不是对待扫码图像整体进行加密，而是主控芯片和安全芯片均使用相同的截取规则，截取待扫码图像的指定像素序列，可以降低加密的运算量，提高解码装置的解码效率。可选地，主控芯片和安全芯片均内置有随机数生成模块。主控芯片具体用于，通过随机数生成模块生成第二随机数。安全芯片具体用于，通过随机数生成模块生成第三随机数。这样，本实施例并不是对待扫码图像整体进行加密，而是主控芯片和安全芯片均使用相同的截取规则，截取待扫码图像的指定像素序列，可以降低加密的运算量，提高解码装置的解码效率。结合图3所示，为本公开实施例提供一种解码器在扫码过程中执行的解码安全认证过程，如图3所示，该过程包括：S301：通过预设的规则，主控芯片和安全芯片得到同一密钥值；解码安全认证过程中的随机数可来自预设于主控芯片和安全芯片中的随机源，按预设规则实现主控芯片和安全芯片的密钥同步。也可来自解码图片的像素值，主控芯片和安全芯片读取同一区块像素值，由同一映射生成计算密钥。S302：对预设的同一段数据，利用步骤S301得到的密钥，主控芯片和安全芯片分别执行HMAC算法，得到摘要D和D’。S303：安全芯片将摘要D’发送给主控芯片。S304：主控芯片读取安全芯片生成的摘要D’。S305：比较D与D’是否相同。若相同，则继续执行解码操作，否则结束运行。可以理解的是，上述解码安全认证的步骤可以按照预设的规则插入预设的解码算法步骤中。例如，可以在预设的解码算法执行之前，首先执行解码安全认证过程。也可以在解码算法中设置，当完成图像扫描后，执行解码安全认证。本公开实施例提供的用于PDA系统的解码算法库授权使用方法采用标准的消息认证函数，利用密码算法固有的安全性保证了认证的权威性。并利用HMAC执行效率高的特点，将其部署在解码过程中，实现了在解码过程中对执行环境的实时认证。该方法在兼顾解码算法执行效率的同时，保证了只有部署有合法安全芯片的执行环境才可获得解码算法库的使用授权，提升了解码算法库的安全性，并为PDA系统的解码算法库授权使用提供了可能性。下面结合图4，具体说明如何使用HMAC-SHA256对输入信息加密生成摘要信息的过程。如图4所示，加密算法包括：获得密钥K。判断密钥K的长度是否大于或者等于512bit，如果是，则进行SHA256的运算，使用运算结果更新密钥K。长度填充。在密钥K的末尾填充0，直到其长度达到512bit为止。内部填充。将密钥K与被称为ipad的序列进行异或运算，所形成的值为K1。将K1与消息M组合。即将K1附加在消息M的开头。计算散列值。将上述K1与M的组合结果输入SHA256函数，并计算出散列值D。外部填充。将密钥K与被称为opad的序列进行异或运算，所形成的值为K2。将K2与散列值D组合。即将散列值D拼在K2后面。计算散列值。上述K2与D组合后的结果输入SHA256函数，并计算出散列值，这个散列值就是最终的摘要内容。结合图5所示，本公开实施例提供一种用于解码装置的认证方法。该方法应用于解码装置，解码装置包括安全芯片和主控芯片，安全芯片和主控芯片均内置有主密钥，该方法包括：S501：安全芯片读取内置于安全芯片内的标识信息；S502：主控芯片接收安全芯片发送的标识信息；S503：主控芯片生成第一随机数，并传输给安全芯片；S504：主控芯片对主密钥、第一随机数以及标识信息执行加密操作，生成第一主控摘要；S505：安全芯片接收主控芯片发送的第一随机数，并对主密钥、标识信息以及第一随机数执行加密操作，生成第一安全摘要，将第一安全摘要传输至主控芯片；S506：主控芯片根据第一主控摘要和第一安全摘要进行初始化认证，如果认证结果为认证成功，允许安全芯片和主控芯片执行初始化。本公开实施例提供的上述用于解码装置的认证方法，通过在安全芯片和主控芯片中内置相同的主密钥，共同对标识信息进行加密，实现了安全芯片对主控芯片的认证，无需与证书服务器进行通信，避免非授权设备的违规操作的同时，提高了解码装置的认证效率。结合图6，本公开实施例还提供了另一种用于解码装置的认证方法，该方法侧重于描述在初始化认证已经通过的情况下，每次执行扫码解码任务时的解码安全认证。该方法在上述图5所示方法执行完毕，并且初始化认证通过后执行，如图6所示，该方法具体包括：S601：主控芯片和安全芯片均内置有预设第三加密操作。S602：安全芯片在预设扫码认证时刻接收摄像头芯片发送的待扫码图像，根据第二随机数对待扫码图像执行预设第三加密操作，生成第二安全子摘要，并将第二安全子摘要传输给主控芯片。S603：主控芯片在预设扫码认证时刻接收摄像头芯片发送的待扫码图像，根据第三随机数对待扫码图像执行预设第三加密操作，生成第二主控子摘要，并根据第二主控子摘要和第二安全子摘要进行解码安全认证，如果认证结果为认证成功，继续执行解码操作；其中，第二随机数与第三随机数相同。上述实施例在扫码开始或者扫码过程中，再次对解码装置中的主控芯片进行安全认证，即使非法操作完成了初始化，仍然不能保证扫码成功，有效提升了解码装置的安全性，保证了解码信息的准确安全。结合图7所示，本公开实施例提供一种移动终端，包括解码装置和摄像头芯片03。其中，解码装置为上述任意一个实施例公开的解码装置。该解码装置包括安全芯片01和主控芯片02。摄像头芯片03用于获取待扫码图像，并向所述解码装置中的所述安全芯片01和所述主控芯片02发送扫码指令以及所述待扫码图像。具体地，主控芯片02与安全芯片01之间可通过I2C进行双向通信，摄像头芯片03可被主控芯片和安全芯片分别访问，主控芯片02中内置解码算法库，用于支持初始化认证和解码过程认证以及常规解码功能。通过在安全芯片和主控芯片中内置相同的主密钥，共同对标识信息进行加密，实现了安全芯片对主控芯片的认证，无需与证书服务器进行通信，避免非授权设备的违规操作的同时，提高了解码装置的认证效率。以上描述和附图充分地示出了本公开的实施例，以使本领域的技术人员能够实践它们。其他实施例可以包括结构的以及其他的改变。实施例仅代表可能的变化。除非明确要求，否则单独的部件和功能是可选的，并且操作的顺序可以变化。一些实施例的部分和特征可以被包括在或替换其他实施例的部分和特征。本公开的实施例并不局限于上面已经描述并在附图中示出的结构，并且可以在不脱离其范围进行各种修改和改变。本公开的范围仅由所附的权利要求来限制。
