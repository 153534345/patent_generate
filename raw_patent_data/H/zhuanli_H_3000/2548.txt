标题title
一种基于5G的分布式光储集群控制方法
摘要abst
本发明公开了一种基于5G的分布式光储集群控制方法，通过自适应调节虚拟电阻使各虚拟同步机中均分有功功率，通过自适应调节谐波频率下的虚拟电阻来消除循环谐波电流，并采用基于动态一致性算法进行有功功率和谐波功率均分。本发明的有益效果是：首先，针对有功和谐波均分的分布式控制，开发了动态一致性算法，并给出了动态一致性算法在均分中的稳定性分析。其次，超扭曲滑模控制策略可以提高动态性能，减少即插即用过程中功率均分的超调。
权利要求书clms
1.一种基于5G的分布式光储集群控制方法，其特征是：通过自适应调节虚拟电阻使各虚拟同步机中均分有功功率，通过自适应调节谐波频率下的虚拟电阻来消除循环谐波电流，并采用基于动态一致性算法进行有功功率和谐波功率均分；通过超扭曲滑模控制策略调节虚拟电阻；有功功率均分的动态一致性算法为：其中为k+1时刻第i个虚拟同步机输出的有功功率，为第i个虚拟同步机输出的有功功率的初始值，为基波条件下的权重系数，为k次迭代时第i个虚拟同步机和第j个虚拟同步机之间的累积差异，为k+1次迭代时第i个虚拟同步机和第j个虚拟同步机之间的累积差异，是第i个虚拟同步机和第j个虚拟同步机之间之间的有功功率链接状态，为k次迭代时第i个虚拟同步机输出的有功功率，为k次迭代时第j个虚拟同步机输出的有功功率，N为虚拟同步机个数。2.根据权利要求1所述的一种基于5G的分布式光储集群控制方法，其特征是：谐波功率均分的动态一致性算法为：其中为k+1次迭代时第i个虚拟同步机输出的谐波功率，为第i个虚拟同步机输出的谐波功率的初始值，为谐波条件下的权重系数，为k+1次迭代时第i个虚拟同步机和第j个虚拟同步机之间的谐波累积差异，为k次迭代时第i个虚拟同步机和第j个虚拟同步机之间的谐波累积差异，为第i个虚拟同步机和第j个虚拟同步机之间的谐波功率链接状态，为k次迭代时第i个虚拟同步机输出的谐波功率，为k次迭代时第j个虚拟同步机输出的谐波功率，N为虚拟同步机个数。3.根据权利要求1所述的一种基于5G的分布式光储集群控制方法，其特征是：基波条件下的权重系数通过以下方程得到：其中为拉普拉斯矩阵L的特征值，定义为：，矩阵A的元素表示为：为第m行n列的矩阵A的元素，为矩阵A的转置矩阵。4.根据权利要求3所述的一种基于5G的分布式光储集群控制方法，其特征是：谐波条件下的权重系数通过以下方程得到：其中为拉普拉斯矩阵L的特征值，定义为：，矩阵A的元素表示为Amn。5.根据权利要求1所述的一种基于5G的分布式光储集群控制方法，其特征是：超扭曲滑模控制策略的过程中,选择一个滑动面，将控制系统状态驱动为零；设计控制规律，将系统状态带入滑动面上，并始终保持在滑动面上。6.根据权利要求5所述的一种基于5G的分布式光储集群控制方法，其特征是：其中是第i个虚拟同步机有功功率均分的控制输入，是第i个虚拟同步机谐波功率均分的控制输入，为平均有功功率和瞬时有功功率的差值，为平均谐波功率和瞬时谐波功率的差值，sgn表述为正负号，参数A和B被选择为：, , M是扰动的上界。
说明书desc
技术领域本发明涉及一种虚拟同步机领域，具体为一种基于5G的分布式光储集群控制方法。背景技术由于环境和经济效益，以燃料为基础的发电厂正在被可再生能源RES取代，尤其是风能，涡轮发电机和光伏电站等。这些断断续续的能源需要一个转换器接口，来传输生成的交流负载/电网的电源。间歇性的来源是采用下垂控制或虚拟同步机控制以模拟频率-有功功率和电压无功功率下垂控制的物理同步发电机。然而，与虚拟同步机控制一起使用的转换器接口的分布式发电机被随机地部署在不同的位置，从而创建孤岛式微电网。在远距离位置随机部署这些分布式发电机会在转换器输出点之间产生不相等的线路阻抗。因此，远方分布式电源不能根据其额定容量准确地分配无功功率。无功功率共享误差可能具有严重的后果，包括使一些分布式发电机超过其额定功率，保护装置不必要的触发，以及整个电网系统的不稳定。在虚拟同步机中并联虚拟同步机的正常运行状态下，主从控制、下垂控制、平均均流控制和循环链控制被提出用来调节虚拟同步机的电力输送。在这些控制策略中，下垂控制已被广泛应用虚拟同步机，因为下垂控制是一种分散控制方法，能够在虚拟同步机之间不通信的情况下调节电压幅值和频率。相应地，通过使用这种控制策略，实现了虚拟同步机的灵活、可扩展和可靠的特性。近期，有人提出集中控制器来解决虚拟同步机系统中的电能质量问题，但一旦通信链路故障，可靠性和控制性能将大大降低，导致有功功率不准确和谐波功率的均分错误。而且，当新的虚拟同步机连接到虚拟同步机时，中央控制器和新的虚拟同步机之间的通信链路要建立起来，这对于集成和扩展新模块来说可能过于复杂。为了克服上述限制，分布式控制方法已普遍应用于并联虚拟同步机，以提高系统的鲁棒性和可靠性。动态一致性算法是一种很有前途的分布式算法，已成功应用于直流微电网和交流微电网的能量管理和二次控制，以实现不同分布式发电机单元之间所需的信息共享。然而，它以前并未应用于虚拟同步机的功率均分。此外，比例积分控制器通常嵌入在二级分布式控制策略中。但 PI 控制器无法在可接受的和期望的时间内跟踪参考，导致一致性处理期间的超调量较大，在即插即用期间功率均分的动态性能不理想。在虚拟同步机中，由于线路电阻不匹配，虚拟同步机中可能存在不均等的功率分配，导致虚拟同步机出现环流、过载甚至跳闸。为了克服这个问题，本发明提出了一种基于5G的分布式光储集群控制方法来调节有功功率和谐波功率共享的虚拟电阻控制策略。发明内容本发明针对虚拟同步机中的有功功率和谐波功率均分，以及即插即用过程中功率共享的鲁棒和快速动态调节，提供了一种基于5G的分布式光储集群控制方法，这种方法不需要中央控制器，只需要相邻虚拟同步机之间的5G通信链路，增强了可靠性和灵活性。本方法设计了具有超扭曲律的无颤振有限时间滑模控制，以实现虚拟同步机的鲁棒行为，且提供了实验结果来验证所提出的控制策略的有效性。本发明采用的技术方案如下：一种基于5G的分布式光储集群控制方法，通过自适应调节虚拟电阻使各虚拟同步机中均分有功功率，通过自适应调节谐波频率下的虚拟电阻来消除循环谐波电流，并采用基于动态一致性算法进行有功功率和谐波功率均分。进一步的，基于5G的分布式光储集群控制方法通过超扭曲滑模控制策略调节虚拟电阻。进一步的，有功功率均分的动态一致性算法为：其中为k+1时刻第i个虚拟同步机输出的有功功率，为第i个虚拟同步机输出的有功功率的初始值，为基波条件下的权重系数，为k次迭代时第i个虚拟同步机和第j个虚拟同步机之间的累积差异，为k+1次迭代时第i个虚拟同步机和第j个虚拟同步机之间的累积差异，是第i个虚拟同步机和第j个虚拟同步机之间之间的有功功率链接状态，为k次迭代时第i个虚拟同步机输出的有功功率， 为k次迭代时第j个虚拟同步机输出的有功功率，N为虚拟同步机个数。进一步的，谐波功率均分的动态一致性算法为：其中为k+1次迭代时第i个虚拟同步机输出的谐波功率，为第i个虚拟同步机输出的谐波功率的初始值，为谐波条件下的权重系数，为k+1次迭代时第i个虚拟同步机和第j个虚拟同步机之间的谐波累积差异，为k次迭代时第i个虚拟同步机和第j个虚拟同步机之间的谐波累积差异，为第i个虚拟同步机和第j个虚拟同步机之间的谐波功率链接状态，为k次迭代时第i个虚拟同步机输出的谐波功率，为k次迭代时第j个虚拟同步机输出的谐波功率，N为虚拟同步机个数。进一步的，基波条件下的权重系数通过以下方程得到：其中为拉普拉斯矩阵L的特征值，定义为：，矩阵A的元素表示为：为第m行n列的矩阵A的元素，为矩阵A的转置矩阵。进一步的，谐波条件下的权重系数通过以下方程得到：其中为拉普拉斯矩阵L的特征值，定义为：，矩阵A的元素表示为：为第m行n列的矩阵A的元素，为矩阵A的转置矩阵。进一步的，超扭曲滑模控制策略的过程中,选择一个滑动面，将控制系统状态驱动为零；设计控制规律，将系统状态带入滑动面上，并始终保持在滑动面上。其中是第i个虚拟同步机有功功率均分的控制输入，是第i个虚拟同步机谐波功率均分的控制输入，为平均有功功率和瞬时有功功率的差值，为平均谐波功率和瞬时谐波功率的差值，sgn表述为正负号，参数A和B被选择为：, , M是扰动的上界。本发明的有益效果是：首先，针对有功和谐波均分的分布式控制，开发了动态一致性算法，并给出了动态一致性算法在均分中的稳定性分析。其次，超扭曲滑模控制是为在有功功率和谐波功率均分过程中有更快的收敛速度和更好的跟踪性能而设计的。这种控制策略可以提高动态性能，减少即插即用过程中功率均分的超调。采用所提出的控制器的系统稳定性分析也得到了证明。最后，提供了比较实验结果，以证明所提出的控制策略在实现有功和谐波功率均分方面具有良好的动态性能。附图说明图1为本发明带有线性负载的虚拟同步机的等效电路图。图2为本发明非线性负载下UPS 系统的等效电路图。图3为本发明基于PI的CA策略实现的有功功率均分性能图。图4为本发明基于ST-SMC的DCA策略实现的有功功率均分性能图。图5为本发明采用所提出的超扭曲滑模控制的有功功率均分前三个虚拟同步机的A相输出电流图。图6为本发明采用所提出的超扭曲滑模控制进行有功功率均分后三个虚拟同步机的A相输出电流图。图7为本发明采用基于PI的CA策略的即插即用过程图。图8为本发明采用所提出策略的即插即用过程图。具体实施方式下面对本发明的实施过程进一步详细说明。虚拟同步机的工作原理，正常情况下，虚拟同步机与120/220V低压配电系统相连，线路电阻呈现阻性特性。为了实现无线控制策略，在虚拟同步机中应用了改进的下垂控制策略，表示为：其中和是虚拟同步机的标称角频率和参考角频率，和分别是标称电压幅度和参考电压幅度，分别是调节有功的下垂参数和调节无功功率的下垂参数，是低通滤波器输出的有功功率和无功功率。在并联的各虚拟同步机中，有功功率均分的准确性受到线路电阻失配的影响。为了在各虚拟同步机中均分有功功率，虚拟同步机的线路电阻应设计为与虚拟同步机的额定值成反比，例如：其中为第1至n个物理线路电阻，为第1至n个虚拟同步机的额定输出有功功率。但是，从即插即用特性的角度来看，每个虚拟同步机的额定功率通常是相同的。因此，为了实现有功功率均分，必须在控制策略中加入虚拟电阻，以准确均分有功功率。图1为带有线性负载的虚拟同步机的等效电路图，提供了有功功率均分原理的详细信息。并联的虚拟同步机被建模为受控电压源，受控电压源包括第1个虚拟同步机输出电压幅度值Vref1和第2个虚拟同步机输出电压幅度值Vref2，RLine,f表示基频下的物理线路电阻，RV,f表示基频下的虚拟电阻，PCC线性负载被建模为无源RL负载。通常，当功率流经由电感和电阻组成的馈线时，馈线上的电压幅度下降采用以下表达式：其中P和Q是流出线路馈线的有功和无功瞬时功率，R和X是线路馈线的电阻和电感。是标称电压幅度，是馈线上的电压幅度下降。当这个方程应用于虚拟同步机时，电感通常被忽略，因为线路馈线显示电阻特性。因此，通过线路电阻的功率会导致馈线上的电压幅度下降，表示为：因此，将式中的压降方程应用于虚拟同步机时，两个虚拟同步机输出电压与PCC电压的关系表示为：其中，为第1个虚拟同步机输出电压幅度值，为第2个虚拟同步机输出电压幅度值，为PCC的电压值，为第1个虚拟同步机基频下的总电阻，，表示第1个基频下的物理线路电阻，RV,f1表示第1个基频下的虚拟电阻，为第2个虚拟同步机基频下的总电阻，，表示第2个基频下的物理线路电阻，RV,f2表示第2个基频下的虚拟电阻。通过结合和,发现有功功率差用式表示，并表示为：由式可知，有功功率差主要由两个因素引起，即总电阻差和虚拟同步机输出电压差。在实际情况下，各线路电阻由于杂散参数而具有不同的值。因此，在不调节虚拟电阻的情况下，虚拟同步机中不可避免地存在环流。因此，消除环流引起的有功功率差异的解决方案是自适应调整虚拟电阻。同时，非线性负载如敏感负载，可由虚拟同步机供电。因此，由于线路电阻不匹配，也可能存在谐波功率差异。因此，谐波频率下的等效电路如图2所示。谐波电阻表示为：其中是谐波频率下的物理线路电阻，是谐波频率下的虚拟电阻。需要注意的是，谐波频率的电压源在图2中没有显示，因为为了满足IEC 62020-3 标准，虚拟同步机的输出谐波电压应控制为零。循环谐波电流定义为：式中，为谐波频率下的PCC电压值，为第1个谐波频率下的虚拟电阻，为第1个谐波频率下的物理线路电阻，为第2个谐波频率下的虚拟电阻，为第2个谐波频率下的物理线路电阻；由以上分析发现，如果物理线路电阻相等，即使没有谐波频率下的虚拟电阻，也不存在循环谐波电流。然而，在实际中，杂散参数会导致线路电阻值不同。因此，自适应调节谐波频率下的虚拟电阻来消除循环谐波电流。基于上述原理，本实施例提出一种基于5G的分布式光储集群控制方法，通过自适应调节虚拟电阻使各虚拟同步机中均分有功功率，通过自适应调节谐波频率下的虚拟电阻来消除循环谐波电流，并采用基于动态一致性算法的功率共享控制策略实现有功功率和谐波功率均分。在集中控制系统中，中央控制器在信息共享方面起着关键作用。因此，系统的可靠性高度依赖于这个中央控制器。此外，随着虚拟同步机模块数量的增加，需要交换的信息量也越来越多，甚至可能导致通信堵塞。为了提高系统的灵活性和可靠性，本实施例采用基于动态一致性算法的自适应调节虚拟电阻，可以减轻通信负担，消除对唯一中央控制器的依赖。采用动态一致性算法策略，每个虚拟同步机只与相邻的虚拟同步机进行通信，有效降低了与中央控制器的通信负担。动态一致性算法最终使所有虚拟同步机的状态将收敛到所需的平均值。本实施例推导出的有功功率的动态一致性算法策略：其中为k+1时刻第i个虚拟同步机输出的有功功率， 为第i个虚拟同步机输出的有功功率的初始值，为基波条件下的权重系数为k次迭代时第i个虚拟同步机和第j个虚拟同步机之间的累积差异，为k+1次迭代时第i个虚拟同步机和第j个虚拟同步机之间的累积差异，是第i个虚拟同步机和第j个虚拟同步机之间的有功功率链接状态，为k次迭代时第i个虚拟同步机输出的有功功率， 为k次迭代时第j个虚拟同步机输出的有功功率。需要注意的是，每个虚拟同步机的有功功率的最终值将收敛到动态一致性算法 策略的平均有功功率。同时，谐波功率的动态一致性算法策略可表示为：其中为k+1次迭代时第i个虚拟同步机输出的谐波功率，为第i个虚拟同步机输出的谐波功率的初始值，为谐波条件下的权重系数，为k+1次迭代时第i个虚拟同步机和第j个虚拟同步机之间的谐波累积差异，为k次迭代时第i个虚拟同步机和第j个虚拟同步机之间的谐波累积差异，为第i个虚拟同步机和第j个虚拟同步机之间的谐波功率链接状态， 为k次迭代时第i个虚拟同步机输出的谐波功率，为k次迭代时第j个虚拟同步机输出的谐波功率。请注意，每个虚拟同步机的谐波功率的最终值会收敛到平均谐波功率。此外，基波条件下的权重系数和谐波条件下的权重系数影响收敛稳定性和收敛动态，和的参数选择通过以下方程得到：其中为拉普拉斯矩阵L的特征值，定义为：，矩阵A的元素表示为：为第m行n列的矩阵A的元素，为矩阵A的转置矩阵。当或在零和之间时，保证收敛。采用超扭曲滑模控制策略作为虚拟同步机中的分布式控制器，超扭曲滑模控制策略可以实现快速的动态响应，并且对系统的不确定性和干扰具有鲁棒性。本实施例通过超扭曲滑模控制策略来驱动动态一致性算法，通过产生虚拟电阻，驱动各虚拟同步机的有功功率和谐波功率相等。本发明基于分布式控制的有功功率和谐波功率均分是通过构建一阶线性多智能体系统来实现的，该控制问题可以认为是一阶多智能体系统的调节器同步问题。一阶线性多智能体系统可构造为：其中为第i个逆变器的有功功率，为第i个逆变器的谐波功率，ui,p是第i个虚拟同步机有功功率均分的控制输入，ui,H是第i个虚拟同步机谐波功率均分的控制输入,分别是第i个虚拟同步机的有功功率扰动量和谐波功率扰动量。为了实现有功和谐波功率均分，各虚拟同步机输出的有功功率和谐波功率应该跟踪系统的一致性，例如。因此，设计超扭曲滑模控制策略的过程中需要选择一个合适的滑动面，将控制系统状态驱动为零；设计控制规律，将系统状态带入滑动面上，并始终保持在滑动面上。首先，每个虚拟同步机中有功功率、谐波功率均分控制的滑动面方程定义为：式中，其中为平均有功功率和瞬时有功功率的差值，平均谐波功率和瞬时谐波功率的差值，为平均有功功率，为第i个逆变器的平均功率，为平均谐波功率，为第i个逆变器的平均谐波；控制规律是通过引入一个候选李雅普诺夫函数推导出来的：其中，W表示李雅普诺夫函数，表示的转置，表示的转置，通过上述李雅普诺夫函数的时间导数计算：推导出 的时间导数:其中表示为平均有功功率的导数，表示为平均谐波功率的导数；因此，只要在式中选择一个合适的A和B的正值，A和B为一个控制系数，式中中的STSMC就可以保证。从而保证了系统的稳定性。其中是第i个虚拟同步机有功功率均分的控制输入，是第i个虚拟同步机谐波功率均分的控制输入，为平均有功功率和瞬时有功功率的差值，为平均谐波功率和瞬时谐波功率的差值，sgn表述为正负号，参数A和B被选择为：, M是扰动的上界；因此，表示STSMC的动态行为，系统被扰动项和被扰动项抑制，有功功率和谐波功率被迫通过S-SMC跟踪在滑动表面上的参考值，从而具有最大的稳定性。每个虚拟同步机的完整控制图如图3所示，从中可以看出它包括初级和次级控制层。在初级控制层，采用下垂控制、电压控制器和电流控制器。同时，在次级控制层，采用基于ST-SMC的动态一致性算法控制策略来减轻系统的基波和谐波功率误差。值得注意的是，为了实现虚拟同步机的电压跟踪，采用了双环控制器，由电压控制和电流控制策略组成。为了验证所提出的控制策略的可行性，三个虚拟同步机组成虚拟同步机，控制算法在dSPACE 1006平台上实现实时控制，波形由示波器获取。为了验证所提出的控制策略的有效性，对传统的基于PI控制的一致性算法和所提出的基于STSMC的动态一致性算法进行了比较。首先，三个虚拟同步机的线路电阻不匹配，只有一个平衡的RL负载连接到 PCC。图3显示了基于PI的CA策略的有功功率共享性能。一开始，传统的下垂控制器被应用到虚拟同步机中。在t=t1之前，由于线路电阻不匹配，三台虚拟同步机之间的有功功率均分性能较差。当基于PI的CA策略在t=t1激活时，需要6s才能实现准确的有功功率共享。相反，当所提出的控制策略应用于有功功率均分时，如图4所示，动态响应比基于PI的CA策略快得多，并且只需3s即可实现无超调的有功功率共享。此外，图5和图6分别显示了三个虚拟同步机在激活有功功率均分之前和激活有功功率均分之后的A相电流。发现由于线路电阻不匹配，输出电流不匹配导致各虚拟同步机有功功率分配不准确，应用所提出的控制策略，在稳态时，三台虚拟同步机的A相电流模块几乎相同，实现有功功率均分。虚拟同步机的即插即用能力也通过基于PI的CA策略和所提出的控制策略得到验证，如图7所示，采用PI控制器提出的方法。在t=t2，分布式发电机DG2与微电网断开，分布式发电机DG1和分布式发电机DG3继续为负载供电。可以看出，分布式发电机DG1和分布式发电机DG3的无功和不平衡功率再次收敛到新的平均值。然后，在t=t3时刻分布式发电机DG2重新接入微电网，三台分布式发电机DG机组的无功功率和不平衡功率再次准确均分。采用所提出的控制策略，如图8所示，其可以看出，其动态响应更快，超调更小。
