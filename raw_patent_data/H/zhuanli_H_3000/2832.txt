标题title
一种流媒体数据传输方法和系统
摘要abst
本发明公开了一种流媒体数据传输方法和系统，涉及流媒体技术领域，所述方法包括：发布后端服务器接收发布终端上传的原始流媒体数据包进行解码处理，确定并根据音频、视频流数据的量化等级进行可伸缩视频编码处理和音频编码处理后打包发送至分发后端服务器；分发后端服务器对接收到的传输流媒体数据包进行解码获得SVC视频流数据包和音频流数据包，根据网络情况和接收终端能力将音频流数据和对应层数的解码视频数据包分发给接收终端。通过本发明使流媒体数据根据业务类型进行量化并根据用户增益进行SVC编码层数的选择，在服务器上解码后发送给终端，减少服务器计算压力，减少传输带宽，降低了终端处理要求，节省了终端功耗。
权利要求书clms
1.一种流媒体数据传输方法，所述方法包括：发布后端服务器接收发布终端上传的原始流媒体数据包，对所述原始流媒体数据包进行解码处理；所述发布后端服务器对解码后的所述原始流媒体数据包进行分析后确定其中音频流数据和视频流数据的量化等级，根据量化等级对所述视频流数据进行可伸缩视频编码SVC处理，以及根据所述量化等级对所述音频流数据进行编码处理，将编码后的SVC视频流数据和音频流数据打包成传输流媒体数据包发送至分发后端服务器；分发后端服务器对接收到的传输流媒体数据包进行解码，获得SVC视频流数据包和音频流数据包，根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端；其中，所述SVC视频流数据包的编码层数是根据以下方式确定的：在压力测试下，从基础层开始，使用递增的编码层数对流媒体视频数据进行编码，统计压力测试下编码层数为n时观看所述流媒体数据的各层用户数量之和，以及压力测试下编码层数为n时解码层分别在k层的各层用户数量，其中为1至n层中的任一解码层的层数，表明在视频流数据包的编码层数为n时使用第层的解码数据播放视频数据包的接收终端的数量，和之间的关系为， ，从第二层开始计算产生的总增益和改善增益，当总增益和改善增益的加权收益小于阈值时，使用n-1层编码层对流媒体数据包进行编码；其中，所述第n层的总增益和改善增益的计算方法如下：，其中，为第n层产生的总增益，为编码层数为n下的各层用户数量之和，为编码层数为n-1下的各层用户数量之和；，其中，为第n层产生的改善增益，为编码层数为n下第k层的用户数量，为编码层数为n-1下第k层的用户数量；其中，总增益和改善增益的加权收益小于阈值具体为，所述N为根据用户策略确定的目标用户数，所述为根据业务策略确定的总增益和改善增益对应的权重系数，所述。2.如权利要求1所述方法，其特征在于，所述量化等级是所述发布后端服务器对所述流媒体数据包进行解码分析后确定的，所述发布后端服务器根据所述流媒体数据包业务的内容类型确定所述量化等级。3.如权利要求1所述方法，其特征在于，发布后端服务器对解码后的所述原始流媒体数据包进行分析，包括对所述原始流媒体数据包的内容的场景、背景、特征物体、特效以及声音类型进行识别和分类；当所述原始流媒体数据包的业务的内容类型为颗粒度敏感业务类型时，使用高位数量化等级对视频流数据中SVC基础层中的残差进行量化编码，当原始流媒体数据包业务的内容类型为颗粒度不敏感业务类型时，使用低位数量化等级对视频流数据中SVC基础层中的残差进行量化编码；当原始流媒体数据包的业务的内容类型为噪声敏感业务类型时，使用高位数量化等级进行音频流量化编码，当原始流媒体数据包业务的内容类型为噪声不敏感业务类型时，使用低位数量化等级进行音频流量化编码。4.如权利要求1所述的方法，其特征在于，所述原始流媒体数据包和所述传输流媒体数据包的包头中包含有相同的时间序列信息，分发后端服务器对接收到的多个传输流媒体数据包解码后，根据包头中的时间序列，按序将多个音频流数据与无线侧终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端。5.如权利要求1所述的方法，其特征在于，分发后端服务器对根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端，包括：先确定接收终端处理能力的对应层数，再判断网络拥塞情况，若当前网络发送该层对应的解码数据延迟超过用户体验阈值时，判断低一层的解码数据延迟是否超过用户体验阈值，若低一层为基础层，则无需进行判断直接向接收终端发送基础层的解码后的视频流数据包；若确定的接收终端处理能力对应层数的解码层为基础层时，直接向接收终端发送基础层的解码后的视频流数据包。6.一种流媒体数据传输系统，所述系统包括：发布终端，所述发布终端上传的原始流媒体数据包；发布后端服务器，所述发布后端服务器接收发布终端上传的原始流媒体数据包，对所述原始流媒体数据包进行解码处理；所述发布后端服务器对解码后的所述原始流媒体数据包进行分析后确定其中音频流数据和视频流数据的量化等级，根据量化等级对所述视频流数据进行可伸缩视频编码SVC处理，以及根据所述量化等级对所述音频流数据进行编码处理，将编码后的视频流数据和音频流数据打包成传输流媒体数据包发送至分发后端服务器；分发后端服务器，所述分发后端服务器对接收到的传输流媒体数据包进行解码，获得SVC视频流数据包和音频流数据包，根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端；接收终端，所述接收终端接收音频流数据与接收终端处理能力对应层数的解码后的视频流数据包并播放；其中，所述SVC视频流数据包的编码层数是根据以下方式确定的：在压力测试下，从基础层开始，使用递增的编码层数对流媒体视频数据进行编码，统计压力测试下编码层数为n时观看所述流媒体数据的各层用户数量之和，以及压力测试下编码层数为n时解码层分别在k层的各层用户数量，其中为1至n层中的任一解码层的层数，表明在视频流数据包的编码层数为n时使用第层的解码数据播放视频数据包的接收终端的数量，和之间的关系为,，从第二层开始计算产生的总增益和改善增益，当总增益和改善增益的加权收益小于阈值时，使用n-1层编码层对流媒体数据包进行编码；其中，所述第n层的总增益和改善增益的计算方法如下：，其中，为第n层产生的总增益，为编码层数为n下的各层用户数量之和，为编码层数为n-1下的各层用户数量之和；，其中，为第n层产生的改善增益，为编码层数为n下第k层的用户数量，为编码层数为n-1下第k层的用户数量；其中，总增益和改善增益的加权收益小于阈值具体为，所述N为根据用户策略确定的目标用户数，所述为根据业务策略确定的总增益和改善增益对应的权重系数，所述。7.如权利要求6所述系统，其特征在于，所述量化等级是发布后端服务器对所述流媒体数据包进行解码分析后确定的，所述发布后端服务器根据所述流媒体数据包业务的内容类型确定所述量化等级。8.如权利要求6所述系统，其特征在于，发布后端服务器对解码后的所述原始流媒体数据包进行分析，包括对原始流媒体数据包内容的场景、背景、特征物体、特效以及声音类型进行识别和分类；当原始流媒体数据包业务的内容类型为颗粒度敏感业务类型时，使用高位数量化等级对视频流数据中SVC基础层中的残差进行量化编码，当原始流媒体数据包业务的内容类型为颗粒度不敏感业务类型时，使用低位数量化等级对视频流数据中SVC基础层中的残差进行量化编码；当原始流媒体数据包业务的内容类型为噪声敏感业务类型时，使用高位数量化等级进行音频流量化编码，当原始流媒体数据包业务的内容类型为噪声不敏感业务类型时，使用低位数量化等级进行音频流量化编码。9.如权利要求6所述的系统，其特征在于，所述原始流媒体数据包和所述传输流媒体数据包的包头中包含有相同的时间序列信息，所述分发后端服务器对接收到的多个传输流媒体数据包解码后，根据包头中的时间序列，按序将多个音频流数据与无线侧终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端。10.如权利要求6所述的系统，其特征在于，分发后端服务器对根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端，包括：先确定接收终端处理能力的对应层数，再判断网络拥塞情况，若当前网络发送该层对应的解码数据延迟超过用户体验阈值时，判断低一层的解码数据延迟是否超过用户体验阈值，若低一层为基础层，则无需进行判断直接向接收终端发送基础层的解码后的视频流数据包；若确定的接收终端处理能力对应层数的解码层为基础层时，直接向接收终端发送基础层的解码后的视频流数据包。
说明书desc
技术领域本发明属于流媒体技术领域，尤其涉及一种流媒体数据传输方法和系统。背景技术随着5G的发展，提供给用户业务的移动网络带宽不断增加，人们使用手机的时间也越来越长，视频解码通常需要大量的计算量，导致终端耗电量过大，同时，过高的计算量通常会导致计算芯片复杂量过大，造成手机卡顿、发烫、掉电快的问题。网络带宽的增加可以使得后端对视频解码再发送的方式有可行性，同时运营商也在边缘化部署业务下沉的云服务器，使得业务处理可以在下层网络侧得以实现。虽然空口端的资源丰富，但由于海量数据的不断产生和传输，网络对带宽的需求仍然十分紧张，在此情形下，需要提出一种对于当前网络架构下减少终端解码处理的方法。发明内容针对上述现有技术中存在的缺陷，本发明提供一种流媒体数据传输方法，所述方法包括：发布后端服务器接收发布终端上传的原始流媒体数据包，对所述原始流媒体数据包进行解码处理；发布后端服务器对解码后的所述原始流媒体数据包进行分析后确定其中音频流数据和视频流数据的量化等级，根据量化等级对所述视频流数据进行可伸缩视频编码SVC处理，以及根据所述量化等级对所述音频流数据进行编码处理，将编码后的视频流数据和音频流数据打包成传输流媒体数据包发送至分发后端服务器；分发后端服务器对接收到的传输流媒体数据包进行解码，获得SVC视频流数据包和音频流数据包，根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端；其中，所述SVC视频流数据包的编码层数是根据以下方式确定的：在压力测试下，从基础层开始，使用递增的编码层数对流媒体视频数据进行编码，统计压力测试下编码层数为n时观看所述流媒体数据的各层用户数量之和，以及压力测试下编码层数为n时解码层分别在k层的各层用户数量，其中为1至n层中的任一解码层的层数，表明在视频流数据包的编码层数为n时使用第层的解码数据播放视频数据包的接收终端的数量，和之间的关系为， ，从第二层开始计算产生的总增益和改善增益，当总增益和改善增益的加权收益小于阈值时，使用n-1层编码层对流媒体数据包进行编码；其中，所述第n层的总增益和改善增益的计算方法如下：，其中，为第n层产生的总增益，为编码层数为n下的各层用户数量之和，为编码层数为n-1下的各层用户数量之和；，其中，为第n层产生的改善增益，为编码层数为n下第k层的用户数量，为编码层数为n-1下第k层的用户数量；其中，总增益和改善增益的加权收益小于阈值具体为，所述N为根据用户策略确定的目标用户数，所述为根据业务策略确定的总增益和改善增益对应的权重系数，所述。其中，所述量化等级是发布后端服务器对所述流媒体数据包进行解码分析后确定的，所述发布后端服务器根据所述流媒体数据包业务的内容类型确定量化等级。其中，发布后端服务器对解码后的所述原始流媒体数据包进行分析，包括对原始流媒体数据包内容的场景、背景、特征物体、特效以及声音类型进行识别和分类；当原始流媒体数据包业务的内容类型为颗粒度敏感业务类型时，使用高位数量化等级对视频流数据中SVC基础层中的残差进行量化编码，当原始流媒体数据包业务的内容类型为颗粒度不敏感业务类型时，使用低位数量化等级对视频流数据中SVC基础层中的残差进行量化编码；当原始流媒体数据包业务的内容类型为噪声敏感业务类型时，使用高位数量化等级进行音频流量化编码，当原始流媒体数据包业务的内容类型为噪声不敏感业务类型时，使用低位数量化等级进行音频流量化编码。其中，所述原始流媒体数据包和所述传输流媒体数据包的包头中都包含有相同的时间序列信息，分发后端服务器对接收到的多个传输流媒体数据包解码后，根据包头中的时间序列，按序将多个音频流数据与无线侧终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端。其中，分发后端服务器对根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端，包括：先确定接收终端处理能力的对应层数，再判断网络拥塞情况，若当前网络发送该层对应的解码数据延迟超过用户体验阈值时，判断低一层的解码数据延迟是否超过用户体验阈值，若低一层为基础层，则无需进行判断直接向接收终端发送基础层的解码后的视频流数据包；若确定的接收终端处理能力对应层数的解码层为基础层时，直接向接收终端发送基础层的解码后的视频流数据包。本发明还提出了一种基于上述方法的流媒体数据传输系统，所述系统包括：发布终端，所述发布终端上传的原始流媒体数据包；发布后端服务器，所述发布后端服务器接收发布终端上传的原始流媒体数据包，对所述原始流媒体数据包进行解码处理；所述发布后端服务器对解码后的所述原始流媒体数据包进行分析后确定其中音频流数据和视频流数据的量化等级，根据量化等级对所述视频流数据进行可伸缩视频编码SVC处理，以及根据所述量化等级对所述音频流数据进行编码处理，将编码后的视频流数据和音频流数据打包成传输流媒体数据包发送至分发后端服务器；分发后端服务器，所述分发后端服务器对接收到的传输流媒体数据包进行解码，获得SVC视频流数据包和音频流数据包，根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端；接收终端，所述接收终端接收音频流数据与接收终端处理能力对应层数的解码后的视频流数据包并播放。其中，所述SVC视频流数据包的编码层数是根据以下方式确定的：在压力测试下，从基础层开始，使用递增的编码层数对流媒体视频数据进行编码，统计压力测试下编码层数为n时观看所述流媒体数据的各层用户数量之和，以及压力测试下编码层数为n时解码层分别在k层的各层用户数量，其中为1至n层中的任一解码层的层数，表明在视频流数据包的编码层数为n时使用第层的解码数据播放视频数据包的接收终端的数量，和之间的关系为， ，从第二层开始计算产生的总增益和改善增益，当总增益和改善增益的加权收益小于阈值时，使用n-1层编码层对流媒体数据包进行编码；其中，所述第n层的总增益和改善增益的计算方法如下：，其中，为第n层产生的总增益，为编码层数为n下的各层用户数量之和，为编码层数为n-1下的各层用户数量之和；，其中，为第n层产生的改善增益，为编码层数为n下第k层的用户数量，为编码层数为n-1下第k层的用户数量；其中，总增益和改善增益的加权收益小于阈值具体为，所述N为根据用户策略确定的目标用户数，所述为根据业务策略确定的总增益和改善增益对应的权重系数，所述。其中，所述量化等级是发布后端服务器对所述流媒体数据包进行解码分析后确定的，所述发布后端服务器根据所述流媒体数据包业务的内容类型确定所述量化等级。其中，发布后端服务器对解码后的所述原始流媒体数据包进行分析，包括对原始流媒体数据包内容的场景、背景、特征物体、特效以及声音类型进行识别和分类；当原始流媒体数据包业务的内容类型为颗粒度敏感业务类型时，使用高位数量化等级对视频流数据中SVC基础层中的残差进行量化编码，当原始流媒体数据包业务的内容类型为颗粒度不敏感业务类型时，使用低位数量化等级对视频流数据中SVC基础层中的残差进行量化编码；当原始流媒体数据包业务的内容类型为噪声敏感业务类型时，使用高位数量化等级进行音频流量化编码，当原始流媒体数据包业务的内容类型为噪声不敏感业务类型时，使用低位数量化等级进行音频流量化编码。其中，所述原始流媒体数据包和所述传输流媒体数据包的包头中都包含有相同的时间序列信息，所述分发后端服务器对接收到的多个传输流媒体数据包解码后，根据包头中的时间序列，按序将多个音频流数据与无线侧终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端。其中，分发后端服务器对根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端，包括：先确定接收终端处理能力的对应层数，再判断网络拥塞情况，若当前网络发送该层对应的解码数据延迟超过用户体验阈值时，判断低一层的解码数据延迟是否超过用户体验阈值，若低一层为基础层，则无需进行判断直接向接收终端发送基础层的解码后的视频流数据包；若确定的接收终端处理能力对应层数的解码层为基础层时，直接向接收终端发送基础层的解码后的视频流数据包。与现有技术相比，通过本发明的方法使流媒体数据根据业务类型进行量化同时根据用户增益进行SVC编码层数的选择，并在服务器上解码后发送给终端，减少服务器对编解码的计算压力，减少流媒体数据的传输带宽，降低了终端解码的处理要求节省了终端功耗。附图说明通过参考附图阅读下文的详细描述，本公开示例性实施方式的上述以及其他目的、特征和优点将变得易于理解。在附图中，以示例性而非限制性的方式示出了本公开的若干实施方式，并且相同或对应的标号表示相同或对应的部分，其中：图1是示出根据本发明实施例的一种流媒体数据传输方法流程图；图2是示出根据本发明实施例的一种流媒体数据传输系统的示意图。具体实施方式为了使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步地详细描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。在本发明实施例中使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本发明。在本发明实施例和所附权利要求书中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义，“多种”一般包含至少两种。应当理解，尽管在本发明实施例中可能采用术语第一、第二、第三等来描述……，但这些……不应限于这些术语。这些术语仅用来将……区分开。例如，在不脱离本发明实施例范围的情况下，第一……也可以被称为第二……，类似地，第二……也可以被称为第一……。应当理解，本文中使用的术语“和/或”仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。另外，本文中字符“/”，一般表示前后关联对象是一种“或”的关系。取决于语境，如在此所使用的词语“如果”、“若”可以被解释成为“在……时”或“当……时”或“响应于确定”或“响应于检测”。类似地，取决于语境，短语“如果确定”或“如果检测”可以被解释成为“当确定时”或“响应于确定”或“当检测时”或“响应于检测”。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的商品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种商品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的商品或者装置中还存在另外的相同要素。下面结合附图详细说明本发明的可选实施例。实施例一、如图1所示，本发明公开了本发明提供一种流媒体数据传输方法，所述方法包括：发布后端服务器接收发布终端上传的原始流媒体数据包，对所述原始流媒体数据包进行解码处理；发布后端服务器对解码后的所述原始流媒体数据包进行分析后确定其中音频流数据和视频流数据的量化等级，根据量化等级对所述视频流数据进行可伸缩视频编码SVC处理，以及根据所述量化等级对所述音频流数据进行编码处理，将编码后的视频流数据和音频流数据打包成传输流媒体数据包发送至分发后端服务器；分发后端服务器对接收到的传输流媒体数据包进行解码，获得SVC视频流数据包和音频流数据包，根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端；其中，所述SVC视频流数据包的编码层数是根据以下方式确定的：在压力测试下，从基础层开始，使用递增的编码层数对流媒体视频数据进行编码，统计压力测试下编码层数为n时观看所述流媒体数据的各层用户数量之和，以及压力测试下编码层数为n时解码层分别在k层的各层用户数量，其中为1至n层中的任一解码层的层数，表明在视频流数据包的编码层数为n时使用第层的解码数据播放视频数据包的接收终端的数量，和之间的关系为, ，从第二层开始计算产生的总增益和改善增益，当总增益和改善增益的加权收益小于阈值时，使用n-1层编码层对流媒体数据包进行编码；其中，所述第n层的总增益和改善增益的计算方法如下：，其中，为第n层产生的总增益，为编码层数为n下的各层用户数量之和，为编码层数为n-1下的各层用户数量之和；，其中，为第n层产生的改善增益，为编码层数为n下第k层的用户数量，为编码层数为n-1下第k层的用户数量；其中，总增益和改善增益的加权收益小于阈值具体为，所述N为根据用户策略确定的目标用户数，所述为根据业务策略确定的总增益和改善增益对应的权重系数，所述。由于至少使用基础层对流媒体数据包进行编码，所以在计算增益数据时从第二层的增益开始计算。其中，N为根据用户策略确定的目标用户数，例如，当平台目标用户数量为时，可以将N设置为，当平台目标用户数为是，可以将N设置为。所述为总增益和改善增益对应的权重，所述为根据业务策略确定的权重系数，所述。例如，当平台对该业务的目标倾向于为增长总用户数时，会被设置为更高的值如分别为0.9和0.1，当平台对该业务的目标倾向于为增长总用户数同时提升用户体验时，的设置会相对均衡，如0.65和0.35。在某一实施例中，所述量化等级是发布后端服务器对所述流媒体数据包进行解码分析后确定的，所述发布后端服务器根据所述流媒体数据包业务的内容类型确定量化等级。在某一实施例中，发布后端服务器对解码后的所述原始流媒体数据包进行分析，包括对原始流媒体数据包内容的场景、背景、特征物体、特效以及声音类型进行识别和分类；当原始流媒体数据包业务的内容类型为颗粒度敏感业务类型时，使用高位数量化等级对视频流数据中SVC基础层中的残差进行量化编码，当原始流媒体数据包业务的内容类型为颗粒度不敏感业务类型时，使用低位数量化等级对视频流数据中SVC基础层中的残差进行量化编码；当原始流媒体数据包业务的内容类型为噪声敏感业务类型时，使用高位数量化等级进行音频流量化编码，当原始流媒体数据包业务的内容类型为噪声不敏感业务类型时，使用低位数量化等级进行音频流量化编码。例如，当业务场景为风景欣赏，那么用户对颗粒度可接受程度比较低，应当设置更高的量化级，当业务场景为直播带货日用品时，用户由于对产品的内容较为熟悉，对颗粒度的可接受程度较高，此时可以用低位数量化级进行残差编码，当业务场景为直播带货服装或者饰品时，产品的细节清晰度不同用户的感受差别较大，对颗粒度的可接受程度较低，此时用高位数量化级进行残差编码较为合适，此外还可以对流媒体数据的特效进行分析，是否使用磨皮，人像美化等功能，通常这类流媒体视频数据的清晰度不是很高，低量化等级的使用不会对用户观感造成过大的影响。例如当识别音频为采访等仅存在人声的场景下，用户对噪声不敏感，对音质要求也不敏感，可以使用低位数量化级进行音频编码。当识别音频和场景为音乐会，用户对音质要求高，使用高位数量化级进行音频编码。在某一实施例中，所述原始流媒体数据包和所述传输流媒体数据包的包头中都包含有相同的时间序列信息，分发后端服务器对接收到的多个传输流媒体数据包解码后，根据包头中的时间序列，按序将多个音频流数据与无线侧终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端。在某一实施例中，分发后端服务器对根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端，包括：先确定接收终端处理能力的对应层数，再判断网络拥塞情况，若当前网络发送该层对应的解码数据延迟超过用户体验阈值时，判断低一层的解码数据延迟是否超过用户体验阈值，若低一层为基础层，则无需进行判断直接向接收终端发送基础层的解码后的视频流数据包；若确定的接收终端处理能力对应层数的解码层为基础层时，直接向接收终端发送基础层的解码后的视频流数据包。与现有技术相比，通过本发明的方法使流媒体数据根据业务类型进行量化同时根据用户增益进行SVC编码层数的选择，并在服务器上解码后发送给终端，减少服务器对编解码的计算压力，减少流媒体数据的传输带宽，降低了终端解码的处理要求节省了终端功耗。实施例二、本发明提出的一种基于上述方法的一种流媒体数据传输系统，所述系统包括：发布终端，所述发布终端上传的原始流媒体数据包；发布后端服务器，所述发布后端服务器接收发布终端上传的原始流媒体数据包，对所述原始流媒体数据包进行解码处理；所述发布后端服务器对解码后的所述原始流媒体数据包进行分析后确定其中音频流数据和视频流数据的量化等级，根据量化等级对所述视频流数据进行可伸缩视频编码SVC处理，以及根据所述量化等级对所述音频流数据进行编码处理，将编码后的视频流数据和音频流数据打包成传输流媒体数据包发送至分发后端服务器；分发后端服务器，所述分发后端服务器对接收到的传输流媒体数据包进行解码，获得SVC视频流数据包和音频流数据包，根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端；接收终端，所述接收终端接收音频流数据与接收终端处理能力对应层数的解码后的视频流数据包并播放；其中，所述SVC视频流数据包的编码层数是根据以下方式确定的：在压力测试下，从基础层开始，使用递增的编码层数对流媒体视频数据进行编码，统计压力测试下编码层数为n时观看所述流媒体数据的各层用户数量之和，以及压力测试下编码层数为n时解码层分别在k层的各层用户数量，其中为1至n层中的任一解码层的层数，表明在视频流数据包的编码层数为n时使用第层的解码数据播放视频数据包的接收终端的数量，和之间的关系为， ，从第二层开始计算产生的总增益和改善增益，当总增益和改善增益的加权收益小于阈值时，使用n-1层编码层对流媒体数据包进行编码；其中，所述第n层的总增益和改善增益的计算方法如下：，其中，为第n层产生的总增益，为编码层数为n下的各层用户数量之和，为编码层数为n-1下的各层用户数量之和；，其中，为第n层产生的改善增益，为编码层数为n下第k层的用户数量，为编码层数为n-1下第k层的用户数量；其中，总增益和改善增益的加权收益小于阈值具体为，所述N为根据用户策略确定的目标用户数，所述为根据业务策略确定的总增益和改善增益对应的权重系数，所述。在某一实施例中，所述量化等级是发布后端服务器对所述流媒体数据包进行解码分析后确定的，所述发布后端服务器根据所述流媒体数据包业务的内容类型确定量化等级。在某一实施例中，发布后端服务器对解码后的所述原始流媒体数据包进行分析，包括对原始流媒体数据包内容的场景、背景、特征物体、特效以及声音类型进行识别和分类；当原始流媒体数据包业务的内容类型为颗粒度敏感业务类型时，使用高位数量化等级对视频流数据中SVC基础层中的残差进行量化编码，当原始流媒体数据包业务的内容类型为颗粒度不敏感业务类型时，使用低位数量化等级对视频流数据中SVC基础层中的残差进行量化编码；当原始流媒体数据包业务的内容类型为噪声敏感业务类型时，使用高位数量化等级进行音频流量化编码，当原始流媒体数据包业务的内容类型为噪声不敏感业务类型时，使用低位数量化等级进行音频流量化编码。在某一实施例中，所述原始流媒体数据包和所述传输流媒体数据包的包头中都包含有相同的时间序列信息，分发后端服务器对接收到的多个传输流媒体数据包解码后，根据包头中的时间序列，按序将多个音频流数据与无线侧终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端。在某一实施例中，分发后端服务器对根据网络情况和预先获取的接收终端的处理能力，将音频流数据与接收终端处理能力对应层数的解码后的视频流数据包直接分发给对应接收终端，包括：先确定接收终端处理能力的对应层数，再判断网络拥塞情况，若当前网络发送该层对应的解码数据延迟超过用户体验阈值时，判断低一层的解码数据延迟是否超过用户体验阈值，若低一层为基础层，则无需进行判断直接向接收终端发送基础层的解码后的视频流数据包；若确定的接收终端处理能力对应层数的解码层为基础层时，直接向接收终端发送基础层的解码后的视频流数据包。编码层数越高的数据层的数据量会比较低层级的解码数据量大。因此网络拥塞程度较高时，分发后端服务器需要根据网络情况调整发送解码数据量大小以提高用户体验。例如，当接收终端处理能力对应三层，但发送第三层的解码数据延迟过高影响了用户体验，如超过了用户体验阈值，则分发后端服务器判断发送第二层对应的解码数据是否延迟较高，如果网络情况不佳拥塞程度较高导致第二层对应的解码数据到达延迟依然超过用户体验阈值，则直接发送基础层对应的解码数据。此外，如果服务器预存的终端处理能力高于数据流最高编码层的解码数据流所需的处理能力，向该终端发送该数据流最高编码层的解码数据流。与现有技术相比，通过本发明的方法使流媒体数据根据业务类型进行量化同时根据用户增益进行SVC编码层数的选择，并在服务器上解码后发送给终端，减少服务器对编解码的计算压力，减少流媒体数据的传输带宽，降低了终端解码的处理要求节省了终端功耗。需要说明的是，本公开上述的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本公开中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本公开中，计算机可读信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读信号介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：电线、光缆、RF等等，或者上述的任意合适的组合。上述计算机可读介质可以是上述电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。可以以一种或多种程序设计语言或其组合来编写用于执行本公开的操作的计算机程序代码，上述程序设计语言包括面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，可以连接到外部计算机。附图中的流程图和框图，图示了按照本公开各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，该模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本公开实施例中所涉及到的单元可以通过软件的方式实现，也可以通过硬件的方式来实现。其中，单元的名称在某种情况下并不构成对该单元本身的限定。以上介绍了本发明的较佳实施方式，旨在使得本发明的精神更加清楚和便于理解，并不是为了限制本发明，凡在本发明的精神和原则之内，所做的修改、替换、改进，均应包含在本发明所附的权利要求概括的保护范围之内。
