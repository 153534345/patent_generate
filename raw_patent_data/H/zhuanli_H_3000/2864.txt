标题title
通信方法及通信装置、通信系统及计算机可读存储介质
摘要abst
本申请公开了一种通信总线上的设备的通信方法、应用于通信总线上的设备的通信装置、通信系统及计算机可读存储介质。通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，设备还包括新从机，新从机作为第二主机的从机，第二主机是从原从机中选定的；通信方法包括：在通信总线接入新从机时，第一主机以轮询方式与原从机进行通信，且第二主机以轮询方式与新从机进行通信。通过这种方式，能够改善新从机接入后降低原主从机通信效率的问题，且提高从机的可扩展性。
权利要求书clms
1.一种通信总线上的设备的通信方法，其特征在于，所述设备包括第一主机及原从机，所述原从机作为所述第一主机的从机，所述设备还包括新从机，所述新从机作为第二主机的从机，所述第二主机是从所述原从机中选定的；所述通信方法包括：在所述通信总线接入所述新从机时，所述第一主机以轮询方式与所述原从机进行通信，且所述第二主机以轮询方式与所述新从机进行通信。2.根据权利要求1所述的通信方法，其特征在于，作为所述第二主机的所述原从机为所述通信总线上的必要设备。3.根据权利要求1所述的通信方法，其特征在于，作为所述第二主机的所述原从机为所述通信总线上的所有所述原从机中与所述第一主机通信频率最高的原从机。4.根据权利要求1所述的通信方法，其特征在于，作为所述第二主机的原从机是预先设定的。5.根据权利要求1所述的通信方法，其特征在于，所述通信方法还包括：在所述通信总线接入所述新从机时，从所述原从机中选定所述第二主机。6.根据权利要求5所述的通信方法，其特征在于，所述从所述原从机中选定所述第二主机，包括：从所述原从机中确定所述通信总线上的必要设备；选定所述必要设备为所述第二主机。7.根据权利要求5所述的通信方法，其特征在于，所述从所述原从机中选定所述第二主机，包括：获取所述第一主机与所述原从机之间的通信记录；基于所述通信记录计算所述第一主机与所述原从机之间的通信次数或者通信频率；确定通信次数最多或者通信频率最大的所述原从机为所述第二主机。8.根据权利要求1所述的通信方法，其特征在于，所述第一主机以轮询方式与所述原从机进行通信，且所述第二主机以轮询方式与所述新从机进行通信，包括：所述第一主机向所述第二主机发送第一轮询信号，并接收所述第二主机发送的对所述第一轮询信号的应答信号；所述第一主机向所述第二主机发送所述第一轮询信号；所述第二主机向所述新从机发送第二轮询信号，并接收所述新从机发送的对所述第二轮询信号的应答信号；所述第一主机接收所述第二主机发送的对所述第一轮询信号的应答信号。9.根据权利要求1所述的通信方法，其特征在于，所述第一主机以轮询方式与所述原从机进行通信，且所述第二主机以轮询方式与所述新从机进行通信，包括：所述第一主机向所述第二主机发送第一轮询信号；所述第二主机向所述新从机发送第二轮询信号，并接收所述新从机发送的对所述第二轮询信号的应答信号；所述第一主机接收所述第二主机发送的对所述第一轮询信号的应答信号。10.根据权利要求8或9所述的通信方法，其特征在于，所述第一主机以轮询方式与所述原从机进行通信，且所述第二主机以轮询方式与所述新从机进行通信，还包括：所述第一主机向其它所述原从机发送所述第三轮询信号，并接收其它所述原从机发送的对所述第三轮询信号的应答信号。11.根据权利要求1所述的通信方法，其特征在于，所述通信总线接入多个所述新从机，所述第一主机以轮询方式与所述原从机进行通信，且所述第二主机以轮询方式与所述新从机进行通信，包括：所述第一主机以轮询方式与所述原从机进行通信，且所述第二主机以轮询方式与多个所述新从机进行通信，其中，所述第二主机与任意两个所述新从机通信的时间点均不同，且不同的所述时间点分别位于所述第二主机与所述第一主机的不同通信周期内。12.根据权利要求1所述的通信方法，其特征在于，所述通信总线接入多个所述新从机，所述通信总线上的设备包括至少两个所述第二主机，每个所述第二主机对应至少一个所述新从机，所述第一主机以轮询方式与所述原从机进行通信，且所述第二主机以轮询方式与所述新从机进行通信，包括：所述通信总线的第一主机以轮询方式与所述原从机进行通信，且不同的所述第二主机以轮询方式分别与对应的至少一个所述新从机进行通信。13.一种通信总线上的设备的通信方法，其特征在于，所述设备包括第一主机及原从机，所述原从机作为所述第一主机的从机，所述设备还包括新从机，所述新从机作为所述第一主机的从机，所述通信方法包括：在所述通信总线接入所述新从机时，所述第一主机以轮询方式与所述原从机进行通信，并在所述第一主机与所述原从机的通信周期内，所述第一主机以轮询方式与所述新从机通信。14.根据权利要求13所述的通信方法，其特征在于，所述第一主机以轮询方式与所述原从机进行通信，并在所述第一主机与所述原从机的通信周期内，所述第一主机以轮询方式与所述新从机通信，包括：在所述第一主机与所述原从机的当前的通信周期内，所述第一主机向所述原从机发送第一轮询信号，并接收所述原从机发送的对所述第一轮询信号的应答信号；间隔预设时长后，所述第一主机向所述新从机发送第二轮询信号，并接收所述新从机发送的对所述第二轮询信号的应答信号。15.一种应用于通信总线上的设备的通信装置，其特征在于，所述设备包括第一主机及原从机，所述原从机作为所述第一主机的从机，所述设备还包括新从机，所述新从机作为第二主机的从机，所述第二主机是从所述原从机中选定的；所述通信装置包括：第一控制模块，用于在所述通信总线接入所述新从机时，控制所述第一主机以轮询方式与所述原从机进行通信，且控制所述第二主机以轮询方式与所述新从机进行通信。16.一种应用于通信总线上的设备的通信装置，其特征在于，所述设备包括第一主机及原从机，所述原从机作为所述第一主机的从机，所述设备还包括新从机，所述新从机作为所述第一主机的从机；所述通信装置包括：第二控制模块，用于在所述通信总线接入所述新从机时，控制所述第一主机以轮询方式与所述原从机进行通信，并在所述第一主机与所述原从机的通信周期内，控制所述第一主机以轮询方式与所述新从机通信。17.一种通信系统，其特征在于，包括处理器及与所述处理器连接的存储器，所述存储器上存储有程序指令，所述处理器执行所述程序指令时实现权利要求1至12任一项所述的通信方法和/或权利要求13至14任一项所述的通信方法。18.一种计算机可读存储介质，其特征在于，其上存储有程序指令，所述程序指令被处理器执行时实现权利要求1至12任一项所述的通信方法和/或权利要求13至14任一项所述的通信方法。
说明书desc
技术领域本申请涉及通信技术领域，特别是涉及一种通信总线上的设备的通信方法、应用于通信总线上的设备的通信装置、通信系统及计算机可读存储介质。背景技术现有的通信系统，如485总线系统中通常采用单主机方式，一个主机和多个从机。主机负责对通信总线上所有的从机进行轮询访问，然后从机按照主机要求的时序进行回复。当通信总线上增加新从机时，需要在主机中进行轮询新从机设备扩展，以方便新从机正常接入通信总线。但在主机中进行新从机的扩展会导致原主从机之间的通信效率下降，且随着新从机数量的增加，这种扩展方式的可扩展性较低。发明内容本申请提供一种通信总线上的设备的通信方法、应用于通信总线上的设备的通信装置、通信系统及计算机可读存储介质，以改善新从机接入后降低原主从机通信效率的问题，且提高从机的可扩展性。为解决上述技术问题，本申请提出一种通信总线上的设备的通信方法。通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，设备还包括新从机，新从机作为第二主机的从机，第二主机是从原从机中选定的；通信方法包括：在通信总线接入新从机时，第一主机以轮询方式与原从机进行通信，且第二主机以轮询方式与新从机进行通信。为解决上述技术问题，本申请提出一种通信总线上的设备的通信方法。通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，通信总线上的设备还包括新从机，新从机作为第一主机的从机，通信方法包括：在通信总线接入新从机时，第一主机以轮询方式与原从机进行通信，并在第一主机与原从机的通信周期内，第一主机以轮询方式与新从机通信。为解决上述技术问题，本申请提出一种应用于通信总线上的设备的通信装置。总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，设备还包括新从机，新从机作为第二主机的从机，第二主机是从原从机中选定的；该通信装置包括：第一控制模块，用于在通信总线接入新从机时，控制第一主机以轮询方式与原从机进行通信，且控制第二主机以轮询方式与新从机进行通信。为解决上述技术问题，本申请提出一种应用于通信总线上的设备的通信装置。总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，设备还包括新从机，新从机作为第一主机的从机；该通信装置包括：第二控制模块，用于在通信总线接入新从机时，控制第一主机以轮询方式与原从机进行通信，并在第一主机与原从机的通信周期内，控制第一主机以轮询方式与新从机通信。为解决上述技术问题，本申请提出一种通信系统。该通信系统包括处理器及与处理器连接的存储器，存储器上存储有程序指令，处理器执行程序指令时实现上述实施例的通信方法。为解决上述技术问题，本申请提出一种计算机可读存储介质。该计算机可读存储介质上存储有程序指令，程序指令被处理器执行时实现上述通信总线上的设备的通信方法。本申请通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，且通信总线上的设备还包括新从机，新从机作为第二主机的从机，第二主机是从原从机中选定的；本申请在通信总线接入新从机时，第一主机以轮询方式与原从机进行通信，且第二主机以轮询方式与新从机进行通信。通过这种方式，因本申请采用从原从机中选定的第二主机以轮询方式与新从机进行通信，因此，接入通信总线的新从机不会影响原主从机之间的通信频率、时序及效率，能够改善相关技术中新从机接入后降低原主从机通信效率的问题；且接入的新从机是直接与新的第二主机进行通信，新从机接入通信总线时，只需要在第二主机上拓展即可，后续也可以直接从第二主机上去掉新从机，而不影响通信总线上其它设备的通信，因此，本申请还能够提高从机的可扩展性。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图，其中：图1是本申请通信总线上的设备的通信方法一实施例的流程示意图；图2是图1实施例中步骤S11的一具体流程示意图；图3是图2实施例的信息交互示意图；图4是图1实施例中步骤S11的另一具体流程示意图；图5是图4实施例的时序示意图；图6是图4实施例的信息交互示意图；图7是本申请通信总线上的设备的通信方法一实施例的信息交互示意图；图8是本申请通信总线上的设备的通信方法一实施例的信息交互示意图；图9是本申请通信总线上的设备的通信方法一实施例的信息交互示意图；图10是本申请通信总线上的设备的通信方法一实施例的信息交互示意图；图11是本申请通信总线上的设备的通信方法一实施例的信息交互示意图；图12是本申请通信总线上的设备的通信方法一实施例的流程示意图；图13是图12实施例中步骤S121的一具体流程示意图；图14是图12实施例中步骤S121的一具体流程示意图；图15是本申请通信总线上的设备的通信方法一实施例的流程示意图；图16是图15实施例中步骤S151的一具体流程示意图；图17是图16实施例的信息交互示意图；图18是本申请应用于通信总线上的设备的通信装置一实施例的结构示意图；图19是本申请应用于通信总线上的设备的通信装置一实施例的结构示意图；图20是本申请通信系统一实施例的结构示意图；图21是本申请计算机可读存储介质一实施例的结构示意图。具体实施方式下面结合附图和实施例，对本申请作进一步的详细描述。特别指出的是，以下实施例仅用于说明本申请，但不对本申请的范围进行限定。同样的，以下实施例仅为本申请的部分实施例而非全部实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其它实施例，都属于本申请保护的范围。在本申请实施例的描述中，需要说明的是，除非另有明确的规定和限定，术语“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本申请实施例中的具体含义。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本申请实施例的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。本申请的技术方案可以应用于各种适用于主从通信方式的通信系统，如485总线系统等，本申请将以485总线系统为例进行介绍。相关技术中，485总线系统中通常采用单主机方式，即一个主机和多个从机。主机负责对通信总线上所有的从机进行轮询访问，然后从机按照主机要求的时序进行回复。单主机方式最大的问题在于，通信总线上接入新从机设备后，原主机除了需要发送轮询信号至原从机，还需要发送轮询信号至新从机，如此会对所有原主从机之间的通信频率和时序产生影响，随着新从机的加入，这一现象会更加严重，从机可扩展性不高。另外，单主机方式还会存在产品迭代更新混乱的问题，新一代产品主机已经兼容了新从机，但把新一代主机用在旧的不含新从机的485系统中，主机仍然还是空余出与新从机的通信时间，严重影响上一代产品的通信效率和产品体验。此外，同一代产品不同项目之间的从机可能并不完全一致，单主机方式无法做到两个项目的兼容，会以牺牲从机的通信效率为代价进行兼容，甚至直接不兼容，这对产品的可维护性和统一性造成不少的影响。为解决上述问题中的至少一个，本申请首先提出一种通信总线上的设备的通信方法，通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，通信总线上的设备还包括新从机，新从机作为第二主机的从机，第二主机是从原从机中选定的。如图1所示，图1是本申请通信总线上的设备的通信方法一实施例的流程示意图。本实施例的通信方法具体包括以下步骤：步骤S11：在通信总线接入新从机时，第一主机以轮询方式与原从机进行通信，且第二主机以轮询方式与新从机进行通信。其中，轮询方式是主机向其所在的通信总线上的从机发送轮询信号：从机接收对应的轮询信号后，向主机反馈针对对应的轮询信号的应答信号，以实现主机轮询、从机应答的通信方式。因本实施例采用从原从机中选定的第二主机以轮询方式与新从机进行通信，因此，接入通信总线的新从机不会影响原主从机之间的通信频率、时序及效率，能够改善相关技术中新从机接入后降低原主从机通信效率的问题；且接入的新从机是直接与新的第二主机进行通信，新从机接入通信总线时，只需要在第二主机上拓展即可，后续也可以直接从第二主机上去掉新从机，而不影响通信总线上其它设备的通信，因此，本实施例还能够提高从机的可扩展性。进一步地，本实施例还可以在步骤S11之前执行步骤S10。步骤S10：确定通信总线上是否接入新从机。具体地，通信总线上设有多个用于接入从机的端口，通信总线可以基于端口的状态，如忙状态或者空闲状态来确定端口是否接入新从机。其中，作为第二主机的原从机为通信总线上的必要设备。必要设备是指不会从通信总线上移除的设备，换句话说如果缺少必要设备，整个通信系统将无法正常工作。本实施例采用通信总线上的必要设备作为第二主机，能够保证通信系统的正常工作。可选地，本实施例中，作为第二主机的原从机为通信总线上的所有原从机中与第一主机通信频率最高的原从机，该原从机可以在通信系统的开发阶段预先确定好。本实施例采用通信总线上的所有原从机中与第一主机通信频率最高的原从机作为第二主机，能够使得第二主机传递更多的报文，便于第二主机扩展更多的新从机，从而能够进一步提高从机的可扩展性。可选地，本实施例可以通过如图2所示的方法实现步骤S11。本实施例的方法包括步骤S21至步骤S24。步骤S21：第一主机向第二主机发送第一轮询信号。第一轮询信号是指第一主机发送给第二主机的信号。在通信系统运行时，第一主机可以多次发送第一轮询信号至第二主机，该多个第一轮询信号中可以有相同的信号，也可以有不同的信号。步骤S22：第二主机向新从机发送第二轮询信号，并接收新从机发送的对第二轮询信号的应答信号。第二主机接收到第一主机发送的第一轮询信号后，第二主机可以向新从机发送第二轮询信号，并接收新从机发送的对第二轮询信号的应答信号。第二主机还可以发送对第一轮询信号的应答信号至第一主机。由于第一主机、第二主机、新从机连接到同一通信总线上，同一通信总线上的信号共享，新从机发送至第二主机的对第二轮询信号的应答信号也能够被第一主机所接收。步骤S23：第一主机接收第二主机发送的对第一轮询信号的应答信号。在一应用场景中，如图3所示：未接入新从机时，第一主机向第二主机发送报文1，第二主机发送回复报文1到第一主机；而在接入新从机后，在同样的时间内，第一主机发送报文1到第二主机，第二主机发送报文2到新从机，新从机发送回复报文2到第二主机，第二主机发送回复报文1到第一主机。进一步地，本实施例还包括步骤S24。步骤S24：第一主机向其它原从机发送第三轮询信号，并接收其它原从机发送的对第三轮询信号的应答信号。第三轮询信号指是第一主机发送给其它原从机的信号。在通信系统运行时，第一主机可以多次发送第三轮询信号至其他原从机，该多个第三轮询信号中可以有相同的信号，也可以有不同的信号。需要注意的是，本申请的轮询信号及应答信号可以以报文的形式存在。可选地，本实施例还可以通过如图4所示的方法实现步骤S11。本实施例的方法包括步骤S51至步骤S55。步骤S51：第一主机向第二主机发送第一轮询信号，并接收第二主机发送的对第一轮询信号的应答信号。第二主机接收到第一主机发送的第一轮询信号后，第二主机还可以发送对第一轮询信号的应答信号至第一主机，实现第一主机对第二主机的轮询。第一轮询信号指是第一主机发送给第二主机的信号，在通信系统运行时，第一主机可以多次发送第一轮询信号至第二主机，该多个第一轮询信号中可以有相同的信号，也可以有不同的信号。步骤S52：第一主机向第二主机发送第一轮询信号。步骤S53：第二主机向新从机发送第二轮询信号，并接收新从机发送的对第二轮询信号的应答信号。步骤S54：第一主机接收第二主机发送的对第一轮询信号的应答信号。步骤S52至步骤S54的具体实施例方式可以参阅上述实施例。本实施例与图2实施例的区别在于：图2实施例在每次第一主机轮询第二主机时，第二主机都要轮询新从机，可以提高新从机的轮询频率，适用于新从机的实时性要求较高的场景；而本实施例则是在第一主机轮询第二主机时，第二主机可以不轮询新从机，可以降低新从机的轮询频率，适用于新从机的实时性要求较低的场景。在一应用场景中，如图5和图6所示：在接入新从机后，第一主机向第二主机发送报文1，第二主机发送回复报文1到第一主机，第一主机发送报文1到第二主机，第二主机发送报文2到新从机，新从机发送回复报文2到第二主机，第二主机发送回复报文1到第一主机。其中，两个报文1可以是同一报文，也可以不是同一报文。进一步地，本实施例还包括步骤S55。步骤S55：第一主机向其它原从机发送第三轮询信号，并接收其它原从机发送的对第三轮询信号的应答信号。具体实施方式可以参阅上述实施例。在另一实施例中，通信总线接入多个新从机，第一主机以轮询方式与原从机进行通信，且第二主机以轮询方式与多个新从机进行通信，其中，第二主机与任意两个新从机通信的时间点均不同，且不同的时间点分别位于第二主机与第一主机的不同通信周期内。本实施例的具体通信方式可以参阅上述实施例。在一应用场景中，如图7所示，在一个通信周期内，第一主机发送报文1到第二主机，第二主机发送回复报文1到第一主机，第一主机发送报文1到第二主机，第二主机发送报文2到新从机1，新从机1发送回复报文2到第二主机，第二主机发送回复报文1到第一主机。在另一个通信周期内，第一主机发送报文1到第二主机，第二主机发送回复报文1到第一主机，第一主机发送报文1到第二主机，第二主机发送报文3到新从机2，新从机2发送回复报文3到第二主机，第二主机发送回复报文1到第一主机。在其它实施例中，可以采用上述通信方式实现对多个新从机的访问。在另一应用场景中，为了提高新从机通信的实时性，可以采用如图8所示的通信方式：在一个通信周期内，第一主机发送报文1到第二主机，第二主机发送报文2到新从机1，新从机1发送回复报文2到第二主机，第二主机发送回复报文1到第一主机。在另一通信周期内，第一主机发送报文1到第二主机，第二主机发送报文3到新从机2，新从机2回复报文3到第二主机，第二主机发送回复报文1到第一主机。在其它应用场景中，可以采用上述通信方式实现对多个新从机的访问。在另一实施例中，通信总线接入多个新从机，通信总线上的设备包括至少两个第二主机，每个第二主机对应至少一个新从机，通信总线的第一主机以轮询方式与原从机进行通信，且不同的第二主机以轮询方式分别与对应的至少一个新从机进行通信。本实施例的具体通信方式可以参阅上述实施例。下面以通信总线上的设备包括两个第二主机，每个第二主机对应一个新从机为例进行描述。在一应用场景中，如图9所示，第一主机发送报文1到第二主机1，第二主机1发送回复报文1到第一主机1，第一主机1发送报文1到第二主机1，第二主机1发送报文2到新从机1，新从机1发送回复报文2到第二主机1，第二主机1发送回复报文1到第一主机。接着，第一主机发送报文3到第二主机2，第二主机2发送回复报文3到第一主机，第一主机发送报文3到第二主机2，第二主机2发送报文4到新从机2，新从机2发送回复报文4到第二主机2，第二主机2发送回复报文3到第一主机。在另一应用场景中，为了提高新从机通信的实时性，可以采用如图10所示的通信方式：第一主机发送报文1到第二主机1，第二主机1发送报文2到新从机1，新从机1发送回复报文2到第二主机1，第二主机1发送回复报文1到第一主机。接着，第一主机发送报文3到第二主机2，第二主机2发送报文4到新从机2，新从机2发送回复报文4到第二主机2，第二主机2发送回复报文3到第一主机。。本实施例第一主机两次发送的报文1及报文3在时序上错开及从两个第二主机接收的回复报文1及回复报文3错开即可。本申请的上述循环方式可以任意排列，不局限于以上几种。在另一实施例中，如图11所示，在船控制系统中，第一主机为转接板，原从机包括驱动模块、电池模块及油门模块，新从机包括Evo显示屏及485-CAN设备，第二主机为油门模块。双主机轮询主要发生在第三阶段。如果仍然在转接板中进行从机扩展的话，势必会影响原从机设备的通信效率，尤其是驱动模块，它是整个船控制系统中的核心模块，它的稳定性直接关联产品的体验感，是不能被其它设备打扰的。为了解决以上问题，本实施例在船控制系统中找到第二主机，由第二主机间接与新从机通信。本实施例中选用了第二主机为油门模块，油门模块负责回复转接板的信息，同时还自扩展了轮询Evo显示屏和485-CAN的任务。顺利的将两个新从机接入到原有的485通信总线，同时没有影响到原主机及原从机的通信效率。另外，即使将新从机从485通信总线去掉变回原有的设备关联方式，依然不会对原有的项目产生影响。在船控制系统唤醒阶段，转接板发送唤醒给油门模块，油门模块反馈应答信号给转接板，且转接板发送版本给驱动模块，驱动模块反馈版本回复给转接板。在船控制系统准备阶段，转接板发送电池信号给电池，电池反馈电池回复给转接板，且转接板发送版本给油门模块，油门模块反馈版本回复给转接板。在船控制系统运行阶段，转接板发送油门数据给到油门模块，油门模块反馈当下的油门给转接板；转接板发送油门数据给到油门模块，油门模块发送油门数据给485-CAN，485-CAN反馈RTU数据给油门模块，油门模块反馈油门给转接板；转接板发送油门数据给到油门模块，油门模块发送油门数据给Evo显示屏，Evo显示屏反馈设置参数给油门模块，油门模块反馈油门给转接板。在船控制系统运行阶段，转接板发送油门给到驱动模块，驱动模块反馈当下的驱动信息给转接板，转接板发送电池信号给电池，电池反馈电池回复给转接板。图11所示实施例为新从机的实时性要求较低的场景。转接板发送数据1至油门模块时，油门模块不轮询新从机；转接板发送数据2至油门模块时，油门模块再轮询新从机。如此，油门模块无需每次收到转接板发送的第一轮询信号时就轮询一次新从机，新从机的轮询频率较低。本申请进一步提出另一实施例的通信总线上的设备的通信方法，如图12所示，图12是本申请通信总线上的设备的通信方法一实施例的流程示意图。本实施例的通信方法具体包括以下步骤：步骤S121：在通信总线接入新从机时，从原从机中选定第二主机。在所述通信总线接入所述新从机时，从所述原从机中选定所述第二主机可选地，本实施例可以通过如图13所示的方法实现步骤S121。本实施例的方法包括步骤S131及步骤S132。步骤S131：从原从机中确定通信总线上的必要设备。必要设备是指不会从通信总线上移除的设备，换句话说如果缺少必要设备，整个通信系统将无法正常工作。本实施例采用通信总线上的必要设备作为第二主机，能够保证通信系统的正常工作。步骤S132：选定必要设备为第二主机。可选地，本实施例可以通过如图14所示的方法实现步骤S121。本实施例的方法包括步骤S141至步骤S143。步骤S141：获取第一主机与原从机之间的通信记录。步骤S142：基于通信记录计算第一主机与原从机之间的通信次数或者通信频率。可以获取第一主机与原从机之间在预设历史时间段内的通信记录，并基于该通信记录统计第一主机与原从机相互之间数据交换的次数，即通信次数。具体地，若第一主机与原从机之间的两次数据交互之间的时间间隔大于预设间隔，可以将这两次数据交互认定为两次通信，若两次数据交互之间的时间间隔小于或者等于该预设间隔，可以将这两次数据交互认定为一次通信。计算该通信次数对应的预设历史时间段的时长的比值为第一主机与原从机之间的通信频率。步骤S143：确定通信次数最多或者通信频率最大的原从机为第二主机。确定通信次数最多或者通信频率最大的原从机为第二主机，能够使得第二主机传递更多的报文，便于第二主机扩展更多的新从机，从而能够进一步提高从机的可扩展性。在其它实施例中，可以利用图14的筛选方法从必备设备中确定第二主机。步骤S122：第一主机以轮询方式与原从机进行通信，且第二主机以轮询方式与新从机进行通信。具体实施方式可以参阅上述实施例。本实施例与上述实施例的区别在于：上述实施例的第二主机的确定是通信系统的开发阶段预先确定的，而本实施例的第二主机是在通信总线接入新从机时，基于通信系统的情况实时确定的。本申请进一步提出另一实施例的通信总线上的设备的通信方法，本实施例通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，通信总线上的设备还包括新从机，新从机作为第一主机的从机，如图15所示，图15是本申请通信总线上的设备的通信方法一实施例的流程示意图。本实施例的通信方法具体包括以下步骤：步骤S151：在通信总线接入新从机时，第一主机以轮询方式与原从机进行通信，并在第一主机与原从机的通信周期内，第一主机以轮询方式与新从机通信。本实施例无需从原从机中确定第二主机，直接在第一主机中采用定时触发的方式在原两帧报文中间插入一帧轮询新从机的报文及回复，即在第一主机原有时序上叠加了另外一个时序，通过另外一个时序完成第一主机与新从机的通信。因此本申请能够在不影响原来的时序的情况下叠加一个时序，询问新从机。可选地，本实施例可以通过如图16所示的方法实现步骤S151。本实施例的方法包括步骤S161及步骤S162。步骤S161：在第一主机与原从机的当前的通信周期内，第一主机向原从机发送第一轮询信号，并接收原从机发送的对第一轮询信号的应答信号。步骤S162：间隔预设时长后，第一主机向新从机发送第二轮询信号，并接收新从机发送的对第二轮询信号的应答信号。例如，如图17所示，第一主机发送报文1到原从机，原从机发送回复报文1到第一主机，延迟预设时长X，第一主机发送报文2到新从机，新从机发送回复报文2到第一主机。本实施例的报文的循环方式的扩展方案可以参阅上述实施例。进一步地，本实施例还可以在步骤S151之前执行步骤S150。步骤S150：确定通信总线上是否接入新从机。具体地，通信总线上设有多个用于接入从机的端口，通信总线可以基于端口的状态，如忙状态或者空闲状态来确定端口是否接入新从机。本申请进一步提出一种应用于通信总线上的设备的通信装置，如图18所示，图18是本申请应用于通信总线上的设备的通信装置一实施例的结构示意图。通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，设备还包括新从机，新从机作为第二主机的从机，第二主机是从原从机中选定的；通信装置180包括：第一控制模块181，用于在通信总线接入新从机时，控制第一主机以轮询方式与原从机进行通信，且控制第二主机以轮询方式与新从机进行通信。本实施例的通信装置180还用于实现上述图1至图14对应的任一实施例所示的通信方法。本申请进一步提出一种应用于通信总线上的设备的通信装置，如图19所示，图19是本申请应用于通信总线上的设备的通信装置一实施例的结构示意图。通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，设备还包括新从机，新从机作为第一主机的从机；通信装置190包括：第二控制模块191，用于在通信总线接入新从机时，控制第一主机以轮询方式与原从机进行通信，并在第一主机与原从机的通信周期内，控制第一主机以轮询方式与新从机通信。本实施例的通信装置190还用于实现上述图15至图17对应的任一实施例所示的通信方法。本申请进一步提出一种通信系统，如图20所示，图20是本申请通信系统一实施例的结构示意图。通信系统包括处理器201及与处理器201连接的存储器202，存储器202上存储有程序指令，处理器201执行程序指令时实现上述任一实施例的通信方法。在本实施例中，处理器201还可以称为CPU。处理器201可能是一种集成电路芯片，具有信号的处理能力。处理器201还可以是通用处理器、数字信号处理器、专用集成电路、现场可编程门阵列或者其它可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。通用处理器可以是微处理器或者该处理器201也可以是任何常规的处理器等。本申请进一步提出一种计算机可读存储介质，如图21所示，图21是本申请计算机可读存储介质一实施例的结构示意图。计算机可读存储介质210上存储有程序指令211，程序指令211被处理器执行时实现上述任一实施例的通信总线上的设备的通信方法。在流程图中表示或在此以其他方式描述的逻辑和/或步骤，例如，可以被认为是用于实现逻辑功能的可执行指令的定序列表，可以具体实现在任何计算机可读介质中，以供指令执行系统、装置或设备使用，或结合这些指令执行系统、装置或设备而使用。就本说明书而言，“计算机可读介质”可以是任何可以包含、存储、通信、传播或传输程序以供指令执行系统、装置或设备或结合这些指令执行系统、装置或设备而使用的装置。计算机可读介质的更具体的示例包括以下：具有一个或多个布线的电连接部，U盘，SD卡，PD光驱，移动硬盘，大容量软驱，多媒体记忆卡，服务器，便携式计算机盘盒，随机存取存储器，只读存储器，可擦除可编辑只读存储器，光纤装置，以及便携式光盘只读存储器。另外，计算机可读介质甚至可以是可在其上打印所述程序的纸或其他合适的介质，因为可以例如通过对纸或其他介质进行光学扫描，接着进行编辑、解译或必要时以其他合适方式进行处理来以电子方式获得所述程序，然后将其存储在计算机存储器中。本申请通信总线上的设备包括第一主机及原从机，原从机作为第一主机的从机，且通信总线上的设备还包括新从机，新从机作为第二主机的从机，第二主机是从原从机中选定的；本申请在通信总线接入新从机时，第一主机以轮询方式与原从机进行通信，且第二主机以轮询方式与新从机进行通信。通过这种方式，因本申请采用从原从机中选定的第二主机以轮询方式与新从机进行通信，因此，接入通信总线的新从机不会影响原主从机之间的通信频率、时序及效率，能够改善相关技术中新从机接入后降低原主从机通信效率的问题；且接入的新从机是直接与新的第二主机进行通信，新从机接入通信总线时，至需要在第二主机上拓展即可，后续也可以直接从第二主机上去掉新从机，而不影响通信总线上其它设备的通信，因此，本申请还能够提高从机的可扩展性。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本申请的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。流程图中或在此以其他方式描述的任何过程或方法描述可以被理解为，表示包括一个或更多个用于实现特定逻辑功能或过程的步骤的可执行指令的代码的模块、片段或部分，并且本申请的优选实施方式的范围包括另外的实现，其中可以不按所示出或讨论的顺序，包括根据所涉及的功能按基本同时的方式或按相反的顺序，来执行功能，这应被本申请的实施例所属技术领域的技术人员所理解。以上所述仅为本申请的实施方式，并非因此限制本申请的专利范围，凡是利用本申请说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本申请的专利保护范围内。
