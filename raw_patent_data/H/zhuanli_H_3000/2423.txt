标题title
一种智能化实验操作考试监控数据智能传输方法
摘要abst
本发明涉及加密传输领域，具体涉及一种智能化实验操作考试监控数据智能传输方法，包括：获取考试监控图像，根据历史数据获得的所有灰度值的先验概率，根据灰度值的先验概率获得每个层级的子序列，计算每个层级的子序列的混乱度，根据每个层级的子序列的混乱度获得每个层级的分配方式，根据每个层级的分配方式获得层级中所有元素的密文数量，根据每个层级中所有元素的密文数量构建密钥层级表；根据密钥层级表对考试监控图像进行加密获得密文图像。本发明根据灰度值的先验概率构建密钥层级表，根据密钥层级表对考试监控图像进行加密，使密文图像的灰度直方图是均匀的，并且完全不同于考试监控图像，使密文图像能够最大程度地抵御统计分析攻击。
权利要求书clms
1.一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述方法包括：获取考试监控图像；获得当前年份之前预设时间内的所有考试监控视频，对考试监控视频进行下采样，获得历史数据；统计历史数据获得的所有灰度值在不同时间的概率，结合不同时间的权值，获得所有灰度值的先验概率；设置一个层级表，设置层级表中每个层级中元素的数量；根据所有灰度值的先验概率获得每个层级的子序列，每个子序列的长度等于层级表中对应层级中元素的数量；计算每个层级的子序列的混乱度，根据每个层级的子序列的混乱度获得每个层级的分配方式，根据每个层级的分配方式获得层级中所有元素的密文数量，根据每个层级中所有元素的密文数量构建密钥层级表；根据密钥层级表对考试监控图像中所有像素点进行加密获得密文像素点，将所有密文像素点组成的图像记为密文图像。2.根据权利要求1所述的一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述结合不同时间的权值，获得所有灰度值的先验概率的步骤包括：灰度值的先验概率的计算公式为：式中，表示灰度值的先验概率，表示当前年份的前年的所有历史图像的数量，表示当前年份的前年的第个历史图像中灰度值的概率，表示当前年份的前年的权值。3.根据权利要求1所述的一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述计算每个层级的子序列的混乱度的步骤包括：第个层级的子序列的混乱度的计算公式为：式中，表示第个层级的子序列的混乱度，表示第个层级的子序列中所有元素的先验概率的均值，表示第层级的子序列中元素的数量，表示第层级对应的子序列中第个元素的先验概率。4.根据权利要求2所述的一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述根据每个层级的子序列的混乱度获得每个层级的分配方式的步骤包括：对于第个层级，如果第个层级的子序列的混乱度不大于预设阈值，则第个层级的分配方式为平均分配；如果第个层级的子序列的混乱度大于预设阈值，则第个层级的分配方式为概率分配。5.根据权利要求4所述的一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述根据每个层级的分配方式获得层级中所有元素的密文数量的步骤包括：对于分配方式为平均分配的层级，该层级中每个元素的密文数量相同，如果第层级的分配方式为平均分配，则第层级中第个元素的密文数量，如果第层级的分配方式为平均分配，则第层级中第个元素的密文数量；对于分配方式为概率分配的层级，获得层级的目标概率，对于第层级中的第个元素：如果第个元素的先验概率小于目标概率，则第个元素对应的密文数量；如果第个元素的先验概率大于目标概率，则第个元素对应的密文数量，表示第层级对应的子序列中第个元素的先验概率。6.根据权利要求5所述的一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述获得层级的目标概率的步骤包括：设置求解目标概率的方程，对方程进行求解，获得第层级的目标概率，求解第层级的目标概率的方程的表达式为：式中，表示第层级对应的子序列中元素的数量，表示第层级对应的子序列中先验概率小于目标概率的元素的数量，则表示第层级对应的子序列中先验概率大于目标概率的元素的数量，表示第层级对应的子序列中先验概率大于目标概率的第个元素的先验概率，表示第层级的目标概率，表示四舍五入取整，表示第7层级对应的子序列中元素的数量。7.根据权利要求1所述的一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述根据每个层级中所有元素的密文数量构建密钥层级表的步骤包括：将之间的所有整数随机设置在层级表的第7层级；对于层级表的第6层级，根据元素的密文数量，将第6层级对应的子序列中的所有元素随机设置在第6层级，且第6层级的每个元素对应的第7层级的元素的数量等于该元素的密文数量；按照从下到上的顺序，根据元素的密文数量，依次将第5层级到第1层级对应的子序列中的所有元素随机设置在对应的层级，且每个层级中每个元素对应的所有下级元素的密文数量之和尽可能与该元素的密文数量相等。8.根据权利要求1所述的一种智能化实验操作考试监控数据智能传输方法，其特征在于，所述根据密钥层级表对考试监控图像中所有像素点进行加密获得密文像素点的步骤包括：对于考试监控图像中的任意一个像素点，加密的过程为：在密钥层级表的明文层级中获得与该像素点的灰度值相等的元素，将该元素所在的层级作为上级层级获得对应的下级层级，获取该元素在下级层级中对应的多个下级元素；同理，逐层获得上级层级中的元素在下级层级中对应的元素，直至获得该元素在密文层级中对应的所有元素；随机从该元素在密文层级中对应的所有元素中选择一个元素作为该像素点的密文，将像素点的灰度值设置为密文，将设置灰度值后的像素点记为密文像素点；将考试监控图像中的所有像素点转换为密文像素点。
说明书desc
技术领域本发明涉及加密传输领域，具体涉及一种智能化实验操作考试监控数据智能传输方法。背景技术传统的实验操作考试系统，采用人盯人的监考方式，对于考生的实验操作不可追溯，导致传统的实验操作考试系统具有平性欠缺、管理混乱等诸多问题。随着云计算、大数据、物联网、人工智能等新信息技术逐步赋能数字化校园，推出了智能化实验操作考试系统，该系统包括智能化排考、电子巡查、视频监考、视频多级存档等功能，在考生端采用USB摄像头对考生的实验操作过程进行直录，将实验操作考试监控视频传输并存储在云端，使整个考试过程和结果更加智能公平。其中，电子巡查、视频监考、视频多级存档等多种功能的实现都建立在获得准确的考试监控图像的基础上，只有考试监控图像的准确性得到保障，才能够根据准确的考试监控图像发现作弊行为，并能够将准确的考试监控图像作为作弊行为的证据。考试监控图像是通过每个考试工位上配设的电脑的USB摄像头采集的，并传输至云服务器，在传输过程中，考试监控图像会受到人为攻击，攻击者试图获取修改考试监控图像，因此，需要对考试监控图像进行加密传输，保证考试监控图像的准确性。统计分析攻击是攻击者较常使用的攻击手段，如果想要加密后的密文图像能够最大程度的抵御攻击者的统计分析攻击，需要加密后的密文图像的灰度直方图的尽可能的均匀，即加密后的密文图像的灰度直方图的方差尽可能小。发明内容为了解决上述问题，本发明提供一种智能化实验操作考试监控数据智能传输方法，所述方法包括：获取考试监控图像；获得当前年份之前预设时间内的所有考试监控视频，对考试监控视频进行下采样，获得历史数据；统计历史数据获得的所有灰度值在不同时间的概率，结合不同时间的权值，获得所有灰度值的先验概率；设置一个层级表，设置层级表中每个层级中元素的数量；根据所有灰度值的先验概率获得每个层级的子序列，每个子序列的长度等于层级表中对应层级中元素的数量；计算每个层级的子序列的混乱度，根据每个层级的子序列的混乱度获得每个层级的分配方式，根据每个层级的分配方式获得层级中所有元素的密文数量，根据每个层级中所有元素的密文数量构建密钥层级表；根据密钥层级表对考试监控图像中所有像素点进行加密获得密文像素点，将所有密文像素点组成的图像记为密文图像。优选的，所述结合不同时间的权值，获得所有灰度值的先验概率的步骤包括：灰度值的先验概率的计算公式为：式中，表示灰度值的先验概率，表示当前年份的前年的所有历史图像的数量，表示当前年份的前年的第个历史图像中灰度值的概率，表示当前年份的前年的权值。优选的，所述计算每个层级的子序列的混乱度的步骤包括：第个层级的子序列的混乱度的计算公式为：式中，表示第个层级的子序列的混乱度，表示第个层级的子序列中所有元素的先验概率的均值，表示第层级的子序列中元素的数量，表示第层级对应的子序列中第个元素的先验概率。优选的，所述根据每个层级的子序列的混乱度获得每个层级的分配方式的步骤包括：对于第个层级，如果第个层级的子序列的混乱度不大于预设阈值，则说明第个层级的子序列中元素的先验概率的分布均匀，则第个层级的分配方式为平均分配；如果第个层级的子序列的混乱度大于预设阈值，则明第个层级的子序列中元素的先验概率的分布不均匀，则第个层级的分配方式为概率分配。优选的，所述根据每个层级的分配方式获得层级中所有元素的密文数量的步骤包括：对于分配方式为平均分配的层级，该层级中每个元素的密文数量相同，如果第层级的分配方式为平均分配，则第层级中第个元素的密文数量，如果第层级的分配方式为平均分配，则第层级中第个元素的密文数量；对于分配方式为概率分配的层级，获得层级的目标概率，对于第层级中的第个元素：如果第个元素的先验概率小于目标概率，则第个元素对应的密文数量；如果第个元素的先验概率大于目标概率，则第个元素对应的密文数量，表示第层级对应的子序列中第个元素的先验概率。优选的，所述获得层级的目标概率的步骤包括：设置求解目标概率的方程，对方程进行求解，获得第层级的目标概率，求解第层级的目标概率的方程的表达式为：式中，表示第层级对应的子序列中元素的数量，表示第层级对应的子序列中先验概率小于目标概率的元素的数量，则表示第层级对应的子序列中先验概率大于目标概率的元素的数量，表示第层级对应的子序列中先验概率大于目标概率的第个元素的先验概率，表示第层级的目标概率，表示四舍五入取整，表示第7层级对应的子序列中元素的数量。优选的，所述根据每个层级中所有元素的密文数量构建密钥层级表的步骤包括：将之间的所有整数随机设置在层级表的第7层级；对于层级表的第6层级，根据元素的密文数量，将第6层级对应的子序列中的所有元素随机设置在第6层级，且第6层级的每个元素对应的第7层级的元素的数量等于该元素的密文数量；按照从下到上的顺序，根据元素的密文数量，依次将第5层级到第1层级对应的子序列中的所有元素随机设置在对应的层级，且每个层级中每个元素对应的所有下级元素的密文数量之和尽可能与该元素的密文数量相等。优选的，所述根据密钥层级表对考试监控图像中所有像素点进行加密获得密文像素点的步骤包括：对于考试监控图像中的任意一个像素点，加密的过程为：在密钥层级表的明文层级中获得与该像素点的灰度值相等的元素，将该元素所在的层级作为上级层级获得对应的下级层级，获取该元素在下级层级中对应的多个下级元素；同理，逐层获得上级层级中的元素在下级层级中对应的元素，直至获得该元素在密文层级中对应的所有元素；随机从该元素在密文层级中对应的所有元素中选择一个元素作为该像素点的密文，将像素点的灰度值设置为密文，将设置灰度值后的像素点记为密文像素点；将考试监控图像中的所有像素点转换为密文像素点。本发明上述方法至少具有如下有益效果：1、根据密钥层级表对考试监控图像进行加密，对于灰度值相同的像素点，虽然在密钥层级表的明文层级中对应的元素相同，但是该元素在密文层级中对应多个密文，因此，随机从多个密文中选择一个作为像素点的密文，会导致加密后的密文像素点可能不同；同理，对于灰度值不同的像素点，虽然在密钥层级表的明文层级中对应的元素不同，但是不同元素在密文层级中对应的多个密文中可能会有相同的密文，因此，随机从多个密文中选择一个作为该像素点的密文，会导致加密后的密文像素点可能相同。因此，上述加密方法能够使最终获得的密文图像的统计特性和考试监控图像的统计特性完全不同，保证密文图像能够抵抗攻击者的统计分析攻击。2、本发明根据历史数据获得的所有灰度值的先验概率，将先验概率不同的灰度值设置在不同明文层级，进而根据先验概率获得每个层级的子序列，根据每个层级的子序列的混乱度获得每个层级的分配方式，根据每个层级的分配方式获得层级中所有元素的密文数量，根据每个层级中所有元素的密文数量构建密钥层级表，保证先验概率越大的灰度值加密后的密文的可选择性越多，进而保证列根据上述方法构建的密钥层级表进行加密获得的密文图像，其灰度直方图趋近于均匀的可能性大，使密文图像能够最大程度的抵抗攻击者的统计分析攻击。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明一个实施例提供的一种智能化实验操作考试监控数据智能传输方法的步骤流程图；图2为本发明一个实施例提供的一个密钥层级表；图3为本发明一个实施例提供的一个考试监控图像；图4为本发明一个实施例提供的图3的考试监控图像加密后的密文图像；图5为本发明一个实施例提供的图3的考试监控图像的灰度直方图；图6为本发明一个实施例提供的图4的密文图像的灰度直方图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种智能化实验操作考试监控数据智能传输方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构、或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种智能化实验操作考试监控数据智能传输方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的一种智能化实验操作考试监控数据智能传输方法的步骤流程图，该方法包括以下步骤：S001，获取考试监控图像。智能化实验操作考试系统包括智能化排考、电子巡查、视频监考、视频多级存档等功能，其中，电子巡查、视频监考、视频多级存档等多种功能的实现都建立在获得准确的考试监控图像的基础上，因此，本发明需要对考试监控图像进行加密。通过每个考试工位上配设的电脑的USB摄像头，采集考生在实验操作过程中的考试监控视频，将考试监控视频中的每帧图像记为考试监控图像，通过下面的加密算法进行加密，并传输至云服务器，进行分析和存储。S002，根据历史数据获得的所有灰度值的先验概率，根据灰度值的先验概率获得层级表的每个层级的子序列，计算每个层级的子序列的混乱度，根据每个层级的子序列的混乱度获得每个层级的分配方式，根据每个层级的分配方式获得层级中所有元素的密文数量，根据每个层级中所有元素的密文数量构建密钥层级表。需要说明的是，本发明通过密钥层级表对考试监控图像中的像素点进行加密，具体为：根据像素点的灰度值获得像素点在密钥层级表中明文层级对应的元素，随机选择该元素在密文层级中对应的所有密文中的一个，将像素点的灰度值设置为该密文，获得该像素点加密后的密文像素点。因此，对于密钥层级表中的元素，越高的明文层级中的元素在密文层级中对应的密文越多，因此，像素点对应的元素所在的明文层级越高，则对其进行加密时可以选择的密文就越多，最终的加密结果的可能性越多。通过上述方法对考试监控图像进行加密，对于灰度值相同的像素点，虽然在密钥层级表的明文层级中对应的元素相同，但是该元素在密文层级中对应多个密文，因此，随机从多个密文中选择一个作为像素点的密文，会导致加密后的密文像素点可能不同；同理，对于灰度值不同的像素点，虽然在密钥层级表的明文层级中对应的元素不同，但是不同元素在密文层级中对应的多个密文中可能会有相同的密文，因此，随机从多个密文中选择一个作为该像素点的密文，会导致加密后的密文像素点可能相同。因此，上述加密方法使得最终获得的密文图像的统计图像和考试监控图像的统计特性完全不同，保证密文图像能够抵抗攻击者的统计分析攻击；但是上述方法只是改变了密文图像相对于考试监控图像的统计特征，并没有使不同的考试监控图像加密后的不同的密文图像的灰度直方图都是均匀的，因此，不能在最大程度上抵抗攻击者的统计分析攻击。因此，为了保证加密后的密文图像能够在最大程度抵抗统计分析攻击，本发明根据历史数据获得所有灰度值的先验概率，根据所有灰度值的先验概率构建密钥层级表，将先验概率越大的灰度值设置在越高的明文层级，将先验概率越小的灰度值设置在越低的明文层级；由于像素点对应的明文层级越高，则可以选择的密文就越多，最终的加密结果的可能性越多，因此，根据上述构建的密钥层级表进行加密获得的密文图像，其灰度直方图趋近于均匀的可能性大。1、根据历史数据获得的所有灰度值的先验概率。将待加密的考试监控图像对应的年份记为当前年份，获取当前年份之前3年内的所有同类型的考试监控视频，对所有考试监控视频进行下采样，获得所有历史数据，下采样的方法具体为：对于任意一个考试监控视频，按照时间顺序将考试监控视频划分为多个子视频，每个子视频的时长为1分钟，从子视频对应的所有帧图像中随机选择一帧图像记为历史图像，将下采样后的所有考试监控视频的所有历史图像组成的集合记为历史数据。考虑到实验考场的环境会随着时间变化，因此，距离当前年份越近的年份的历史图像越具有参考意义，因此，根据历史图像的年份设置权值，加权获得所有灰度值的先验概率。灰度值的先验概率的计算公式为：式中，表示灰度值的先验概率，表示当前年份的前年的所有历史图像的数量，表示当前年份的前年的第个历史图像中灰度值的概率，表示当前年份的前年的权值，其中，，距离当前年份越近的年份，其权值越小，但是由于的取值范围为，因此，权值越小，概率加权后的结果越大。2、根据灰度值的先验概率获得层级表的每个层级的子序列。按照先验概率从大到小对所有灰度值进行排序，将排序后的序列记为第一序列。设置一个具有7个层级的层级表，层级表从上到下依次记为第1层级到第7层级，第1层级到第7层级中元素的数量分别为：；且层级表的第层级是第层级的上级层级，第层级是第层级的下级层级，则第层级中的元素是第层级中对应元素的上级元素，第层级中的元素是第层级中对应元素的下级元素。根据第1层级到第6层级中每个层级的元素的数量，按照从左到右的顺序将第一序列划分为6个子序列，具体为：将第一序列中的前8个灰度值组成的序列记为第1层级的子序列，将第一序列中的第9个灰度值到第16个灰度值组成的序列记为第2层级的子序列，将第一序列中的第17个灰度值到第32个灰度值组成的序列记为第3层级的子序列，将第一序列中的第33个灰度值到第64个灰度值组成的序列记为第4层级的子序列，将第一序列中的第65个灰度值到第128个灰度值组成的序列记为第5层级的子序列，将第一序列中的第129个灰度值到第256个灰度值组成的序列记为第6层级的子序列。3、计算每个层级的子序列的混乱度。需要说明的是，在层级表中，对于除了第1层级外的其他任意一个层级，该层级的下级层级中元素的数量均为该层级中的元素的数量的2倍，因此，该层级中的每个元素平均有2个下级元素，对应的下级元素的数量越多，则加密后密文像素点的可能情况越多，为了打破密文图像的统计特性，尽可能使密文图像的灰度直方图均匀，本发明考虑需要先验频率高的元素在密文层级中对应的密文的数量越多。但是，如果子序列中元素的先验概率的分布是均匀的，则在给每个元素平均分配2个下级元素即可，如果子序列中元素的先验概率的分布是不均匀的，则需要按照元素的先验概率进行分配。因此，需要首先获得每个层级的子序列的混乱度。在本实施例中，需要根据子序列中元素的先验概率计算每个层级的子序列的混乱度，其中，第个层级的子序列的混乱度的计算公式为：式中，表示第个层级的子序列的混乱度，表示第个层级的子序列中所有元素的先验概率的均值，表示第层级的子序列中元素的数量，表示第层级对应的子序列中第个元素的先验概率。子序列的混乱度越大，则子序列中元素的先验概率的分布越不均匀。4、根据每个层级的子序列的混乱度获得每个层级的分配方式。如果第个层级的子序列的混乱度不大于预设阈值，则说明第个层级的子序列中元素的先验概率的分布均匀，则第个层级的分配方式为平均分配；如果第个层级的子序列的混乱度大于预设阈值，则明第个层级的子序列中元素的先验概率的分布不均匀，则第个层级的分配方式为概率分配。在本实施例中，预设阈值为0.3，在其他实施例中，实施人员可根据需要设置预设阈值。5、根据每个层级的分配方式获得层级中所有元素的密文数量。需要说明的是，对于分配方式为平均分配的层级，则层级中每个元素对应的下级元素的数量相同；对于分配方式为概率分配的层级，为了保证后续对于任意一个像素点，都能够通过密钥层级表获得对应的密文，在进行分配时，需要保证每个上级元素至少有一个下级元素，为了实现上述要求，需要获得分配方式为概率分配的层级的目标频率，对于先验概率小于目标概率的元素分配一个下层元素，对于先验概率大于目标概率的元素，按照先验概率与目标概率的倍数分配相应数量的下层元素。在本实施例中，对于分配方式为平均分配的层级，该层级中每个元素的密文数量相同，如果第层级的分配方式为平均分配，则第层级中第个元素的密文数量，如果第层级的分配方式为平均分配，则第层级中第个元素的密文数量。在本实施例中，对于分配方式为概率分配的层级，获得层级的目标概率，设置求解目标概率的方程，方程的表达式具体为：式中，表示第层级对应的子序列中元素的数量，表示第层级对应的子序列中先验概率小于目标概率的元素的数量，则表示第层级对应的子序列中先验概率大于目标概率的元素的数量，表示第层级对应的子序列中先验概率大于目标概率的第个元素的先验概率，表示第层级的目标概率，表示四舍五入取整，表示第7层级对应的子序列中元素的数量。由于上述方程中，除目标概率以外，其他对象均已知，因此通过对上述方程进行求解，能够获得第层级的目标概率。对于第层级中的第个元素：如果第个元素的先验概率小于目标概率，则第个元素对应的密文数量；如果第个元素的先验概率大于目标概率，则第个元素对应的密文数量，表示第层级对应的子序列中第个元素的先验概率。6、根据每个层级中所有元素的密文数量构建密钥层级表。将之间的所有整数随机设置在层级表的第7层级。对于层级表的第6层级，根据元素的密文数量，将第6层级对应的子序列中的所有元素随机设置在第6层级，第6层级需要满足：第6层级的每个元素对应的第7层级的元素的数量等于该元素的密文数量，只存在第6层级的1个元素对应的第7层级中的1个或多个元素的情况，不存在第6层级的多个元素对应的第7层级中的1个元素的情况。例如，在图2所示的示例中，第6层级对应的子序列为，每个元素的密文数量分别为，将第6层级对应的子序列中的所有元素随机设置在第6层级，且第6层级的每个元素对应的第7层级的元素的数量等于该元素的密文数量，最终获得层级表的第6层级和第7层级如图2所示。按照从下到上的顺序，根据元素的密文数量，依次将第5层级到第1层级对应的子序列中的所有元素随机设置在对应的层级，每个层级需要满足：每个层级中每个元素对应的所有下级元素的密文数量之和尽可能与该元素的密文数量相等。例如，在图2所示的示例中，第5层级对应的子序列为，每个元素的密文数量分别为，将第5层级对应的子序列中的所有元素随机设置在第5层级，且第5层级的每个元素对应的第6层级的元素的数量等于该元素的密文数量，最终获得层级表的第5层级如图2所示。将根据上述步骤到获得的层级表记为密钥层级表，将密钥层级表中的第1层级到第6层级记为明文层级，将密钥层级表中的第7层级记为密文层级。需要说明的是，对于同一年份的所有考试监控图像，加密时使用的密钥层级表是相同的，因此密钥层级表在整个加密过程中只获取一次，并进行分别存储在发送端和接收端，在通过发送端向接收端传输加密后的密文图像时，不需要对密钥层级表进行传输，保障了密钥层级表的安全性。本发明根据历史数据获得的所有灰度值的先验概率，将先验概率越大的灰度值设置在越高的明文层级，将先验概率越小的灰度值设置在越低的明文层级，进而获得每个层级的子序列，根据每个层级的子序列的混乱度获得每个层级的分配方式，根据每个层级的分配方式获得层级中所有元素的密文数量，根据每个层级中所有元素的密文数量构建密钥层级表，保证先验概率越大的灰度值加密后的密文的可选择性越多，进而保证列根据上述方法构建的密钥层级表进行加密获得的密文图像，其灰度直方图趋近于均匀的可能性大，使密文图像能够最大程度的抵抗攻击者的统计分析攻击。S003，根据密钥层级表对考试监控图像进行加密。1、对于考试监控图像中的任意一个像素点，加密的过程为：在密钥层级表的明文层级中获得与该像素点的灰度值相等的元素，将该元素所在的层级作为上级层级获得对应的下级层级，获取该元素在下级层级中对应的多个下级元素；同理，逐层获得上级层级中的元素在下级层级中对应的元素，直至获得该元素在密文层级中对应的所有元素；随机从该元素在密文层级中对应的所有元素中选择一个元素作为该像素点的密文，将像素点的灰度值设置为密文，将设置灰度值后的像素点记为密文像素点；将考试监控图像中的所有像素点转换为密文像素点，将所有密文像素点组成的图像记为密文图像。例如，考试监控图像中第4行第10列的像素点的灰度值为77，在密钥层级表的明文层级中获得与该像素点的灰度值相等的元素为第4层级中的元素77，该元素对应的下级元素分别为第5层级中元素93和元素100，第5层级中元素93的下级元素为第6层级中元素27，第5层级中元素100的下级元素为第6层级中元素49和元素128，第6层级中元素27的下级元素为第7层级中元素11、元素203和元素254，第6层级中元素49的下级元素为第7层级中元素128，第6层级中元素27的下级元素为第7层级中元素196和元素73，则第4层级中的元素77在密文层级中对应的所有元素为：元素11、元素203、元素254、元素128、元素196和元素73，随机从第4层级中的元素77在密文层级中对应的所有元素中选择一个元素203作为该像素点的密文，将像素点的灰度值设置为密文，将设置灰度值后的像素点记为密文像素点。对于如图3所示的考试监控图像，将考试监控图像中的所有像素点转换为密文像素点，所有密文像素点组成的密文图像如图4所示。如图3所示的考试监控图像的灰度直方图如图5所示，图3所示的考试监控图像加密后的密文图像，即图4的灰度直方图如图6所示。根据密钥层级表对考试监控图像进行加密，对于灰度值相同的像素点，虽然在密钥层级表的明文层级中对应的元素相同，但是该元素在密文层级中对应多个密文，因此，随机从多个密文中选择一个作为像素点的密文，会导致加密后的密文像素点可能不同；同理，对于灰度值不同的像素点，虽然在密钥层级表的明文层级中对应的元素不同，但是不同元素在密文层级中对应的多个密文中可能会有相同的密文，因此，随机从多个密文中选择一个作为该像素点的密文，会导致加密后的密文像素点可能相同。因此，上述加密方法能够使最终获得的密文图像的统计特性和考试监控图像的统计特性完全不同，保证密文图像能够抵抗攻击者的统计分析攻击。2、根据密钥层级表对考试监控图像中的所有明文像素点进行加密时，需要将每个像素点在密钥层级表中对应的明文层级的序号记录下来，将所有像素点对应的明文层级的序号组成的序列记为明文序列，通过非对称加密算法对明文序列进行加密，获得密文序列。在本实施例中，非对称加密算法包括但不仅限于RSA算法、DSA算法或ECC算法等非对称加密算法。3、将密文图像和密文序列传输至云端。S004，根据密钥层级表对密文图像进行解密。对密文序列进行解密获得明文序列；对于密文图像中的任意一个密文像素点，解密的过程为：在明文序列中获得该密文像素点在密钥层级表中对应的明文层级的序号，将序号对应的层级记为该密文像素点的目标层级；在密钥层级表的密文层级中获得与该密文像素点的灰度值相等的元素，将该元素所在的层级作为下级层级获得对应的上级层级，获取该元素在上级层级中对应的一个上级元素；同理，逐层获得下级层级中的元素在上级层级中对应的元素，直至获得该元素在对应的目标层级中对应的元素记为目标元素；将目标元素作为该密文像素点的明文，将密文像素点的灰度值设置为明文，将设置灰度值后的密文像素点记为明文像素点；将密文图像中的所有密文像素点转换为明文像素点，将所有明文像素点组成的图像记为明文图像。例如，密文图像中第4行第10列的密文像素点的灰度值为203，对应的目标层级为第4层级，在密钥层级表的密文层级即第7层级中获得与该密文像素点的灰度值相等的元素203，该元素对应的上级元素为第6层级中的元素27，第6层级中的元素27对应的上级元素为第5层级中的元素93，第5层级中的元素93对应的上级元素为第4层级中的元素77，则密文像素点的目标元素为第4层级中的元素77，将目标元素作为该密文像素点的明文，将密文像素点的灰度值设置为明文，将设置灰度值后的密文像素点记为明文像素点；对于如图4所示的密文图像，将密文图像中的所有像素点转换为明文像素点，所有明文像素点组成的明文图像如图3所示。综上所述，本发明获取考试监控图像，根据历史数据获得的所有灰度值的先验概率，根据灰度值的先验概率获得每个层级的子序列，计算每个层级的子序列的混乱度，根据每个层级的子序列的混乱度获得每个层级的分配方式，根据每个层级的分配方式获得层级中所有元素的密文数量，根据每个层级中所有元素的密文数量构建密钥层级表；根据密钥层级表对考试监控图像进行加密获得密文图像。本发明根据灰度值的先验概率构建密钥层级表，根据密钥层级表对考试监控图像进行加密，使密文图像的灰度直方图是均匀的，并且完全不同于考试监控图像，使密文图像能够最大程度地抵御统计分析攻击。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。且上述对本说明书特定实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围，均应包含在本申请的保护范围之内。
