标题title
一种大规模组网扩展级联麦克风系统和方法
摘要abst
本发明公开了一种大规模组网扩展级联麦克风系统和方法，级联麦克风系统包括：多个级联麦克风，可进行拾音以及拾音后根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，并将处理后的音频数据送给上级设备的级联Hub；级联Hub，在收到一个或者多个下级设备的级联麦克风上传的声音数据后，将进行能量比较，选择能量最大的声音数据送给上级设备的会议一体机；会议一体机，根据从PC机接收的音频信号完成音频处理，将处理后的声音数据与从下级设备的级联Hub传上来的声音数据进行能量比较，选择能量较大的那一路数据送给PC机。本发明实现级联麦克风的大规模组网扩展，从而满足大型会议室或者教室中大规模部署级联麦克风的需求。
权利要求书clms
1.一种大规模组网扩展级联麦克风系统，其特征在于：包括有以下模块：多个级联麦克风，进行拾音以及拾音后根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，并将处理后的音频数据送给上级设备的级联Hub；级联Hub，在收到一个或者多个下级设备的级联麦克风上传的声音数据后，将进行能量比较，选择能量最大的声音数据送给上级设备的会议一体机；会议一体机，根据从PC机接收的音频信号完成音频处理，将处理后的声音数据与从下级设备的级联Hub传上来的声音数据进行能量比较，选择能量较大的那一路数据送给PC机。2.根据权利要求1所述的一种大规模组网扩展级联麦克风系统，其特征在于：所述级联麦克风包括音频处理模块，接收来自于本机的阵列麦克风的声音，完成声音处理后，将其与来自于本机的下行级联数据模块的声音数据进行能量比较，选择能量较大的那一路送给本机的上行级联数据模块，同时将来自于本机的上行级联数据模块的参考声音信号透传给本机的下行级联数据模块；上行级联数据模块，接收来自于上级设备的参考声音信号送给本机的音频处理模块；同时将本机的音频处理模块处理和比较后的声音数据送给上级设备；下行级联数据模块，接收来自于下级设备的声音数据送给本机的音频处理模块；同时将本机的音频处理模块透传的参考声音信号送给下级设备；阵列麦克风，采集外部声源的声音，并将数据传输给本机的音频处理模块。3.根据权利要求1所述的一种大规模组网扩展级联麦克风系统，其特征在于：所述级联Hub包括音频处理模块，接收来自于外来的多个下行级联数据模块的声音数据，进行能量比较，选择能量较大的那一路，送给本机的上行级联数据模块；同时将来自于本机的上行级联数据模块的参考声音信号透传给本机的下行级联数据模块；上行级联数据模块，接收来自于上级设备的参考声音信号送给本机的音频处理模块；同时将本机的音频处理模块处理和比较后的声音数据送给上级设备；下行级联数据模块，接收来自于下级设备的声音数据送给本机的音频处理模块；同时将本机的音频处理模块透传的参考声音信号送给下级设备。4.根据权利要求3所述的一种大规模组网扩展级联麦克风系统，其特征在于：一个级联Hub包括有多个本机的下行级联数据模块。5.根据权利要求1所述的一种大规模组网扩展级联麦克风系统，其特征在于：所述会议一体机包括音频处理模块，接收来自于本机的阵列麦克风的声音，并完成声音的处理，将其与来自于本机的级联数据模块的声音数据进行能量比较，选择能量较大的那一路，作为最终的采集声音信号送给外部的PC机；级联数据模块，将本机的音频处理模块传送来的声音参考信号传输到下级设备；同时接收来自于下级设备的级联麦克风的声音数据，送给本机的音频处理模块；阵列麦克风，采集外部声源的声音，并将数据传输给本机的音频处理模块；扬声器，从本机的音频处理模块接收音频数据，并发出声音。6.根据权利要求5所述的一种大规模组网扩展级联麦克风系统，其特征在于：所述会议一体机的音频处理模块将外部的PC机传输过来的音频数据，送给本机的级联数据模块，以便传递到下一级设备作为声音参考信号；所述会议一体机的音频处理模块将外部的PC机传输过来的音频数据送给本机的扬声器。7.一种大规模组网扩展级联麦克风的方法，其特征在于：包括以下步骤：步骤1，会议一体机通过广播寻址消息查询级联麦克风和级联Hub组网的情况，级联麦克风、级联Hub以及会议一体机形成三叉树结构的组网；步骤2，组网完成后，在实际工作时，最后一级的级联麦克风的阵列麦克风拾音后，根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，并将处理后的音频数据送给上级设备的级联Hub；步骤3，中间级的级联麦克风的阵列麦克风拾音后，根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，将处理后的声音数据与从下级设备的级联麦克风传上来的声音数据进行能量比较，选择能量较大的那一路数据，送给上级设备的级联Hub；步骤4，级联Hub在收到一个或者多个下级设备的级联麦克风上传的声音数据后，将进行能量比较，选择能量最大的声音数据送给上级设备的会议一体机；步骤5，会议一体机的级联麦克风的阵列麦克风拾音后，根据从PC机接收的音频信号完成音频处理，将处理后的声音数据与从下级设备的级联Hub传上来的声音数据进行能量比较，选择能量较大的那一路数据送给PC机。8.根据权利要求7所述的大规模组网扩展级联麦克风的方法，其特征在于：步骤1中，会议一体机发送寻址消息至级联麦克风和级联Hub，级联麦克风或级联Hub在收到寻址消息时，将在寻址消息中的级联麦克风或级联Hub的标志位增加自身的标志数据，下一台的级联麦克风或级联Hub收到寻址消息之后再增加自身的标志数据，遍历到组网中的所有设备，并且设备根据所在位置增加自身的标志数据进行回复消息至会议一体机，会议一体机收集所有设备返回的数据，形成整个组网的连接图。9.根据权利要求8所述的大规模组网扩展级联麦克风的方法，其特征在于：下一台的级联麦克风或级联Hub的标志数据为前一台的级联麦克风或级联Hub的标志数据加1。10.根据权利要求8所述的大规模组网扩展级联麦克风的方法，其特征在于：会议一体机定期发送寻址消息，来实时获取组网情况。
说明书desc
技术领域本发明涉及组网级联麦克风系统技术领域，尤其是一种大规模组网扩展级联麦克风系统和方法。背景技术传统会议室中部署会议一体机，即一种带扬声器和阵列麦克风的设备，形态可以是多样的。如图1所示，由于阵列麦克风的拾音距离有限，为了更好的拾取距离会议一体机较远的发言人的声音，通常会增加级联麦克风。该种形式的级联麦克风主要有几个问题：1、级联麦克风之间的同步性问题，多个级联麦克风以及会议一体机的阵列麦克风一起工作时，每个拾音单元之间的同步和比较；拾音单元如各级麦克风，包括会议一体机的麦克风，各自视为一个单元。传统的设计思路基本上是将级联麦克风仅作为拾取声音的物理设备，所有的声音处理都汇总到会议一体机来完成，这对会议一体机的性能就提出了比较高的要求，同时这客观上也限制了级联麦克风的最大数量，目前市面上的同类产品一般不超过8级。2、级联麦克风由于一般是菊花链连接的，对组网和部署都有一定的限制。另一传统的方案是将多个麦克风都汇聚到调音台，数量同样受到调音台的接口限制。而对于远程教育或者视频会议这样的应用场景越来越多，希望麦克风部署在教室或房间各个角落，现有的系统方案由于级联麦克风数量限制，整体的覆盖效果会有一些影响。中国发明专利CN2021106722942公开的一种麦克风级联系统、麦克风及终端，其中麦克风级联系统包括：母麦克风、多个子麦克风和预设终端；所述母麦克风中设置有第一网络通信模块，每个子麦克风中设置有第二网络通信模块，所述预设终端中设置有第三网络通信模块；所述母麦克风通过所述第一网络通信模块及网线分别与第一个子麦克风，以及所述预设终端联接；所述第一个子麦克风与其他各个子麦克风按照预设顺序通过各自的第二网络通信模块及网线串联；每一子麦克风，用于通过所述第二网络通信模块，获取所述预设顺序中与其联接的后一个麦克风发送的第一音频数据包；向所述预设顺序中与其联接的前一个麦克风发送所述第一音频数据包，以及基于网络传输音频协议采集到的第二音频数据包；所述母麦克风，用于通过所述第一网络通信模块，从第一接口获取所述第一个子麦克风发送的第三音频数据包；基于网络传输音频协议，根据所述第三音频数据包和采集到第一音频数据，得到混合音频数据包，并从第二接口向所述预设终端发送所述混合音频数据包；所述预设终端，用于通过所述第三网络通信模块，从所述母麦克风获取所述混合音频数据包；所述母麦克风和各个子麦克风中还设置有扬声器；所述预设终端，还用于向所述母麦克风下发待处理音频数据包；所述母麦克风，还用于通过所述第一网络通信模块获取所述待处理音频数据包；基于网络传输音频协议将所述待处理音频数据包恢复成待处理音频数据；通过扬声器播放所述待处理音频数据；通过所述第一网络通信模块，从所述第一接口向各个子麦克风发送所述待处理音频数据包；每一子麦克风，还用于通过所述第二网络通信模块，从所述预设顺序中与其联接的前一个麦克风获取所述待处理音频数据包；基于网络传输音频协议将所述待处理音频数据包恢复成待处理音频数据；通过扬声器播放所述待处理音频数据；通过所述第二网络通信模块，向所述预设顺序中与其联接的后一个麦克风发送所述待处理音频数据包。从上述技术方案中的说明书及其说明书附图可知，采用的链路结构仍然是一种串联式结构，无法做到大规模组网，麦克风的组网数量同样受到交换机的接口数量限制，因此对组网和部署都有一定的限制。发明内容本发明要解决的技术问题是：提供一种大规模组网扩展级联麦克风系统和方法，实现级联麦克风的大规模组网扩展。本发明解决上述技术问题所采用的技术方案是：一种大规模组网扩展级联麦克风系统，包括有以下模块：多个级联麦克风，进行拾音以及拾音后根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，并将处理后的音频数据送给上级设备的级联Hub；级联Hub，在收到一个或者多个下级设备的级联麦克风上传的声音数据后，将进行能量比较，选择能量最大的声音数据送给上级设备的会议一体机；会议一体机，根据从PC机接收的音频信号完成音频处理，将处理后的声音数据与从下级设备的级联Hub传上来的声音数据进行能量比较，选择能量较大的那一路数据送给PC机。优选的，所述级联麦克风包括音频处理模块，接收来自于本机的阵列麦克风的声音，完成声音处理后，将其与来自于本机的下行级联数据模块的声音数据进行能量比较，选择能量较大的那一路送给本机的上行级联数据模块，同时将来自于本机的上行级联数据模块的参考声音信号透传给本机的下行级联数据模块；上行级联数据模块，接收来自于上级设备的参考声音信号送给本机的音频处理模块；同时将本机的音频处理模块处理和比较后的声音数据送给上级设备；下行级联数据模块，接收来自于下级设备的声音数据送给本机的音频处理模块；同时将本机的音频处理模块透传的参考声音信号送给下级设备；阵列麦克风，采集外部声源的声音，并将数据传输给本机的音频处理模块。优选的，所述级联Hub包括音频处理模块，接收来自于外来的多个下行级联数据模块的声音数据，进行能量比较，选择能量较大的那一路，送给本机的上行级联数据模块；同时将来自于本机的上行级联数据模块的参考声音信号透传给本机的下行级联数据模块；上行级联数据模块，接收来自于上级设备的参考声音信号送给本机的音频处理模块；同时将本机的音频处理模块处理和比较后的声音数据送给上级设备；下行级联数据模块，接收来自于下级设备的声音数据送给本机的音频处理模块；同时将本机的音频处理模块透传的参考声音信号送给下级设备。更为优选的，一个级联Hub包括有多个本机的下行级联数据模块。优选的，所述会议一体机包括音频处理模块，接收来自于本机的阵列麦克风的声音，并完成声音的处理，将其与来自于本机的级联数据模块的声音数据进行能量比较，选择能量较大的那一路，作为最终的采集声音信号送给外部的PC机；级联数据模块，将本机的音频处理模块传送来的声音参考信号传输到下级设备；同时接收来自于下级设备的级联麦克风的声音数据，送给本机的音频处理模块；阵列麦克风，采集外部声源的声音，并将数据传输给本机的音频处理模块；扬声器，从本机的音频处理模块接收音频数据，并发出声音。更为优选的，所述会议一体机的音频处理模块将外部的PC机传输过来的音频数据，送给本机的级联数据模块，以便传递到下一级设备作为声音参考信号；所述会议一体机的音频处理模块将外部的PC机传输过来的音频数据送给本机的扬声器。一种大规模组网扩展级联麦克风的方法，包括以下步骤：步骤1，会议一体机通过广播寻址消息查询级联麦克风和级联Hub组网的情况，级联麦克风、级联Hub以及会议一体机形成三叉树结构的组网；优选的，会议一体机发送寻址消息至级联麦克风和级联Hub，级联麦克风或级联Hub在收到寻址消息时，将在寻址消息中的级联麦克风或级联Hub的标志位增加自身的标志数据，下一台的级联麦克风或级联Hub收到寻址消息之后再增加自身的标志数据，遍历到组网中的所有设备，并且设备根据所在位置增加自身的标志数据进行回复消息至会议一体机，会议一体机收集所有设备返回的数据，从而可以形成整个组网的连接图。优选的，下一台的级联麦克风或级联Hub的标志数据为前一台的级联麦克风或级联Hub的标志数据加1。更为优选的，会议一体机定期发送寻址消息，来实时获取组网情况。步骤2，组网完成后，在实际工作时，最后一级的级联麦克风的阵列麦克风拾音后，根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，并将处理后的音频数据送给上级设备的级联Hub；步骤3，中间级的级联麦克风的阵列麦克风拾音后，根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，将处理后的声音数据与从下级设备的级联麦克风传上来的声音数据进行能量比较，选择能量较大的那一路数据，送给上级设备的级联Hub；步骤4，级联Hub在收到一个或者多个下级设备的级联麦克风上传的声音数据后，将进行能量比较，选择能量最大的声音数据送给上级设备的会议一体机；步骤5，会议一体机的级联麦克风的阵列麦克风拾音后，根据从PC机接收的音频信号完成音频处理，将处理后的声音数据与从下级设备的级联Hub传上来的声音数据进行能量比较，选择能量较大的那一路数据送给PC机。本发明的有益效果是：级联麦克风、级联Hub以及会议一体机形成一个三叉树结构的组网，这样的组网是可以任意扩展的，从而实现任意级规模的扩展级联麦克风系统。使用本发明的大规模组网扩展级联麦克风系统，可以实现级联麦克风的大规模组网扩展，从而满足大型会议室或者教室中大规模部署级联麦克风的需求。三叉树的组网结构，有利于覆盖各种类型的会议室，特别是有多排座位的会议室以及教室。附图说明下面结合附图对本发明进一步说明。图1是现有的级联麦克风系统的组网结构；图2是本发明的级联麦克风系统的组网结构；图3是本发明的级联麦克风系统的组网寻址流程图；图4是本发明的级联麦克风系统的模块框架图；图5是本发明的级联麦克风方法的总体流程示意图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员基于本申请所获得的所有其他实施例，都属于本申请保护的范围。如图2所示，一种大规模组网扩展级联麦克风系统，包括有以下模块：多个级联麦克风，可进行拾音以及拾音后根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，并将处理后的音频数据送给上级设备的级联Hub；级联Hub，在收到一个或者多个下级设备的级联麦克风上传的声音数据后，将进行能量比较，选择能量最大的声音数据送给上级设备的会议一体机；会议一体机，根据从PC机接收的音频信号完成音频处理，将处理后的声音数据与从下级设备的级联Hub传上来的声音数据进行能量比较，选择能量较大的那一路数据送给PC机。具体的，作为本实施例中的一种可选实施方式，如图4所示，所述级联麦克风包括音频处理模块，接收来自于本机的阵列麦克风的声音，完成声音处理后，将其与来自于本机的下行级联数据模块的声音数据进行能量比较，选择能量较大的那一路送给本机的上行级联数据模块，同时将来自于本机的上行级联数据模块的参考声音信号透传给本机的下行级联数据模块；上行级联数据模块，接收来自于上级设备的参考声音信号送给本机的音频处理模块；同时将本机的音频处理模块处理和比较后的声音数据送给上级设备；下行级联数据模块，接收来自于下级设备的声音数据送给本机的音频处理模块；同时将本机的音频处理模块透传的参考声音信号送给下级设备；阵列麦克风，采集外部声源的声音，并将数据传输给本机的音频处理模块。具体的，作为本实施例中的一种可选实施方式，如图4所示，所述级联Hub包括音频处理模块，接收来自于外来的多个下行级联数据模块的声音数据，进行能量比较，选择能量较大的那一路，送给本机的上行级联数据模块；同时将来自于本机的上行级联数据模块的参考声音信号透传给本机的下行级联数据模块；上行级联数据模块，接收来自于上级设备的参考声音信号送给本机的音频处理模块；同时将本机的音频处理模块处理和比较后的声音数据送给上级设备；下行级联数据模块，接收来自于下级设备的声音数据送给本机的音频处理模块；同时将本机的音频处理模块透传的参考声音信号送给下级设备。具体的，作为本实施例中的一种可选实施方式，如图4所示，一个级联Hub包括有多个本机的下行级联数据模块。具体的，作为本实施例中的一种可选实施方式，如图4所示，所述会议一体机包括音频处理模块，接收来自于本机的阵列麦克风的声音，并完成声音的处理，将其与来自于本机的级联数据模块的声音数据进行能量比较，选择能量较大的那一路，作为最终的采集声音信号送给外部的PC机；级联数据模块，将本机的音频处理模块传送来的声音参考信号传输到下级设备；同时接收来自于下级设备的级联麦克风的声音数据，送给本机的音频处理模块；阵列麦克风，采集外部声源的声音，并将数据传输给本机的音频处理模块；扬声器，从本机的音频处理模块接收音频数据，并发出声音。具体的，作为本实施例中的一种可选实施方式，如图4所示，所述会议一体机的音频处理模块将外部的PC机传输过来的音频数据，送给本机的级联数据模块，以便传递到下一级设备作为声音参考信号；所述会议一体机的音频处理模块将外部的PC机传输过来的音频数据送给本机的扬声器。如图4所示，级联麦克风具备1个上行级联数据模块作为上行接口和1个下行级联数据模块作为下行接口。与传统级联麦克风相比，除了需要完成拾音采集外，还支持在本地完成音频处理和下级设备上传的声音数据进行能量比较后，将能量比较大的那一路送给上行接口的功能。级联Hub具备1个上行级联数据模块作为上行接口和多个下行级联数据模块作为下行接口，本文优选为3个下行级联数据模块作为下行接口，实际数量不局限于这个数量。级联Hub本身没有阵列麦克风，获取多个下行接口上传的声音数据，完成能量比较后，将能量比较大的那一路送给上行接口。级联麦克风和级联Hub可以位于组网中的任意一级，如图2所示，级联麦克风、级联Hub以及会议一体机形成一个三叉树结构的组网，这样的组网是可以任意扩展的，从而实现任意级规模的扩展级联麦克风系统。使用本发明的大规模组网扩展级联麦克风系统，可以实现级联麦克风的大规模组网扩展，从而满足大型会议室或者教室中大规模部署级联麦克风的需求。三叉树的组网结构，有利于覆盖各种类型的会议室，特别是有多排座位的会议室以及教室。如图5所示，一种大规模组网扩展级联麦克风的方法，包括以下步骤：步骤1，会议一体机通过广播寻址消息查询级联麦克风和级联Hub组网的情况，级联麦克风、级联Hub以及会议一体机形成三叉树结构的组网；具体的，作为本实施例中的一种可选实施方式，如图3所示，会议一体机发送寻址消息至级联麦克风和级联Hub，级联麦克风或级联Hub在收到寻址消息时，将在寻址消息中的级联麦克风或级联Hub的标志位增加自身的标志数据，下一台的级联麦克风或级联Hub收到寻址消息之后再增加自身的标志数据，遍历到组网中的所有设备，并且设备根据所在位置增加自身的标志数据进行回复消息至会议一体机，会议一体机收集所有设备返回的数据。具体的，作为本实施例中的一种可选实施方式，如图3所示，下一台的级联麦克风或级联Hub的标志数据为前一台的级联麦克风或级联Hub的标志数据加1。具体的，作为本实施例中的一种可选实施方式，如图3所示，会议一体机定期发送寻址消息。会议一体机通过广播消息查询级联麦克风组网的情况，由于是三叉树结构，级联麦克风在收到消息时，将在消息中的级联麦克风标志位增加1，这样下一台级联麦克风收到之后再增加1，以此类推。而消息到达级联Hub后，级联Hub将在级联Hub标志位增加1，同时转发到级联Hub的下级端口时，再分别在级联Hub下级端口位置做区分，例如第一个下级端口是1，第二个下级端口是2，第三个下级端口是3；依次类推，这样就可以遍历到组网中的所有设备，并且设备根据所在位置回复的消息增加自身的标志数据；会议一体机通过收集所有设备返回的数据，可以生成一个三叉树结构的组网图，从而直观的了解组网规模。更进一步会议一体机通过定期查询消息，知道组网的故障点和新增变化，从而达到管理整个扩展级联麦克风的系统。例如下一个的标志位，级联Hub占2个字节，下行口占一个字节，级联麦克风占2个字节；在下行口为3个时，如果系统中是纯级联麦克风组网，最大可以支持255个级联麦克风；而如果系统中有级联Hub时，组网规模可以高达255*3*255=195075个；如果扩展标志位，将支持更多的数量。步骤2，组网完成后，在实际工作时，最后一级的级联麦克风的阵列麦克风拾音后，根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，并将处理后的音频数据送给上级设备的级联Hub；步骤3，中间级的级联麦克风的阵列麦克风拾音后，根据从上级设备的级联Hub处接收的参考音频信号完成音频处理，将处理后的声音数据与从下级设备的级联麦克风传上来的声音数据进行能量比较，选择能量较大的那一路数据，送给上级设备的级联Hub；步骤4，级联Hub在收到一个或者多个下级设备的级联麦克风上传的声音数据后，将进行能量比较，选择能量最大的声音数据送给上级设备的会议一体机；步骤5，会议一体机的级联麦克风的阵列麦克风拾音后，根据从PC机接收的音频信号完成音频处理，将处理后的声音数据与从下级设备的级联Hub传上来的声音数据进行能量比较，选择能量较大的那一路数据送给PC机。使用本发明的大规模组网扩展级联麦克风的方法，基于麦克风hub可以实现三叉树形态的寻址和音频数据上下行传输，从而实现大规模的组网，从而满足大型会议室或者教室中大规模部署级联麦克风的需求。需要说明的是，在本文中，各个可选方案中的技术特征只要不矛盾均可组合来形成方案，这些方案均在本申请公开的范围内。诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。本说明书中的各个实施例均采用相关的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似的部分互相参见即可。以上所述仅为本申请的较佳实施例，并非用于限定本申请的保护范围。凡在本申请的精神和原则之内所作的任何修改、等同替换、改进等，均包含在本申请的保护范围内。
