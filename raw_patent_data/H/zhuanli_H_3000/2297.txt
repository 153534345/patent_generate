标题title
一种设备归属信息生成方法及系统
摘要abst
本申请公开了一种设备归属信息生成方法及系统，包括：物联网设备从制造站获取令牌并基于令牌以及从内部存储中获取的制造站信息、CSR数据组装凭证生成请求并发送给制造站；制造站验证令牌成功则判断本机是否存在设备证书，若不存在则根据CSR数据生成设备证书；制造站根据预先存储的制造站公钥、设备证书组装设备初始归属信息头报文并返回给物联网设备；物联网设备计算设备初始归属信息头报文的哈希消息认证码并组装凭证设置响应报文发送给制造站；制造站验证令牌成功则生成条目信息，根据设备初始归属信息头报文、设备证书以及条目信息组装设备初始归属信息。通过采用本申请提供的方法，可以确保物联网设备的合法性与安全性。
权利要求书clms
1.一种设备归属信息生成方法，其特征在于，所述方法应用于由物联网设备与制造站构成的系统中，包括：步骤S1：所述物联网设备从所述制造站获取令牌，并对所述令牌以及从内部存储中获取的制造站信息、CSR数据、设备描述信息、设备序列号、设备公钥信息进行组装，生成凭证请求核心报文，利用设备私钥对所述凭证请求核心报文进行加密，获得凭证生成请求，将所述凭证生成请求发送给所述制造站，所述设备公钥信息包括公钥类型与公钥编码；步骤S2：所述制造站利用预先存储的设备公钥解密所述凭证生成请求获得所述CSR数据、所述设备描述信息、所述设备公钥信息以及所述令牌，对所述令牌进行验证，若验证成功，则判断本机是否存在与所述物联网设备对应的设备证书，若不存在，根据解密获得的所述CSR数据生成与所述物联网设备对应的设备证书，将所述设备证书与所述设备描述信息对应保存，执行步骤S3，若验证失败，则结束；步骤S3：所述制造站获取预先存储的制造站公钥、设备标识以及服务器信息，并对所述设备证书进行哈希运算，获得第一哈希值，根据板载协议版本、所述第一哈希值、所述制造站公钥、解密获得的所述设备描述信息、所述设备标识以及所述服务器信息组装设备初始归属信息头报文，对所述设备初始归属信息头报文进行编码处理，获得第一编码结果，将所述第一编码结果返回给所述物联网设备，其中，所述服务器信息为认证中心服务器的信息，被用于物联网设备注册阶段；步骤S4：所述物联网设备对接收的所述第一编码结果进行解码处理，获得所述设备初始归属信息头报文，计算所述设备初始归属信息头报文的哈希消息认证码，基于所述哈希消息认证码以及所述令牌组装凭证设置响应报文，将所述凭证设置响应报文发送给所述制造站；步骤S5：所述制造站解析所述凭证设置响应报文获得所述哈希消息认证码以及所述令牌，对所述令牌进行验证，若验证成功，则生成条目信息，根据所述板载协议版本、所述设备初始归属信息头报文、所述哈希消息认证码、所述设备证书以及所述条目信息组装设备初始归属信息并保存，若验证失败，则结束。2.根据权利要求1所述的方法，其特征在于，所述系统还包括业务端以及所有者端，所述步骤S1之前，还包括：步骤Y1：所述业务端接收所述所有者端发送的应用申请请求，创建应用并生成应用信息，将所述应用信息下发给所述所有者端，所述应用信息包括应用标识与应用密钥；步骤Y2：所述所有者端对所述应用信息进行保存；所述步骤S5之后，还包括：步骤SA1：所述所有者端利用第一预设算法生成所有者公私密钥对并保存，根据订单、保存的应用标识以及所有者公钥生成订单信息，利用所述应用密钥对所述订单信息进行加密，将加密后的所述订单信息发送给所述业务端；步骤SA2：所述业务端利用内部存储的应用密钥对加密后的所述订单信息进行解密，获得所述应用标识与所述所有者公钥，将所述应用标识与所述所有者公钥对应保存，基于所述订单信息生成下单信息发送给所述制造站；步骤SA3：所述制造站解析所述下单信息获取所述所有者公钥并保存；步骤SA4：所述制造站对所述设备初始归属信息头报文与所述哈希消息认证码进行哈希运算，获得第二哈希值，对所述设备标识以及所述设备描述信息进行哈希运算，获得第三哈希值，利用制造站私钥对所述第二哈希值、所述第三哈希值以及所述所有者公钥进行签名，获得第一签名结果，根据保存的所述设备初始归属信息、所述所有者公钥、所述第二哈希值、所述第三哈希值以及所述第一签名结果生成扩展后的设备第一归属信息，将所述扩展后的设备第一归属信息下发给所述所有者端；步骤SA5：所述所有者端对所述扩展后的设备第一归属信息进行合法性验证，若验证合法，则保存所述扩展后的设备第一归属信息，若验证不合法，则结束。3.根据权利要求2所述的方法，其特征在于，所述步骤SA5包括：步骤SA5-1：所述所有者端解析所述扩展后的设备第一归属信息获得设备初始归属信息头报文、哈希消息认证码、设备证书、所有者公钥、第二哈希值、第三哈希值、第一签名结果；步骤SA5-2：所述所有者端从解析获得的设备初始归属信息头报文中获取制造站公钥，利用解析获取的制造站公钥计算解析获得的设备初始归属信息头报文的哈希消息认证码，将解析获得的哈希消息认证码与计算获得的哈希消息认证码进行对比，若一致，则执行步骤SA5-3，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；步骤SA5-3：所述所有者端从解析获得的设备初始归属信息头报文中获取第一哈希值，并对解析获得的设备证书进行哈希运算，获得第四哈希值，将获取的第一哈希值与运算获得的第四哈希值进行对比，若一致，则执行步骤SA5-4，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；步骤SA5-4：所述所有者端利用解析获取的制造站公钥对解析获得的第一签名结果进行验证，若验证通过，则执行步骤SA5-5，若验证未通过，则所述扩展后的设备第一归属信息不合法，结束；步骤SA5-5：所述所有者端从解析获得的设备初始归属信息头报文中获取设备描述信息与设备标识，对解析获得的设备描述信息与设备标识进行哈希运算，获得第五哈希值，将解析获得的第三哈希值与运算获得的第五哈希值进行对比，若一致，则执行步骤SA5-6，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；步骤SA5-6：所述所有者端将解析获得的所有者公钥与内部存储的公钥进行对比，若一致，则执行步骤SA5-7，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；步骤SA5-7：所述所有者端对解析获得的设备初始归属信息头报文与哈希消息认证码进行哈希运算，获得第六哈希值，将解析获得的第二哈希值与运算获得的第六哈希值进行对比，若一致，则验证合法，保存所述扩展后的设备第一归属信息，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束。4.根据权利要求2所述的方法，其特征在于，所述系统还包括客户端，所述步骤SA5之后，还包括：步骤SA6：所述所有者端根据所述订单从内部存储中查找对应的客户公钥，利用所述应用密钥对所述客户公钥进行加密获得归属信息扩展请求密文，将所述归属信息扩展请求密文发送给所述业务端；步骤SA7：所述业务端利用内部存储的应用密钥对所述归属信息扩展请求密文进行解密，将解密获得的客户公钥发送给所述制造站；步骤SA8：所述制造站对所述设备初始归属信息头报文与所述哈希消息认证码进行哈希运算，获得第二哈希值，对所述设备标识以及所述设备描述信息进行哈希运算，获得第三哈希值，利用所述制造站私钥对所述第二哈希值、所述第三哈希值、所述客户公钥进行签名，获得第二签名结果，根据保存的设备第一归属信息、所述客户公钥、所述第二哈希值、所述第三哈希值以及所述第二签名结果生成扩展后的设备第二归属信息，将所述扩展后的设备第二归属信息下发给所述客户端。5.根据权利要求2所述的方法，其特征在于，所述步骤SA5之后，还包括当所述所有者端密钥丢失时，执行：步骤SB1：所述所有者端利用所述第一预设算法重新生成新的所有者公私密钥对并保存，根据所述扩展后的设备第一归属信息、所述应用标识以及新的所有者公钥组装凭证损坏请求，利用所述应用密钥对所述凭证损坏请求进行加密，将加密后的所述凭证损坏请求发送给所述业务端；步骤SB2：所述业务端利用内部存储的应用密钥对加密后的所述凭证损坏请求进行解密，获得所述应用标识与所述新的所有者公钥，根据所述新的所有者公钥对本机内部存储的与所述应用标识对应的公钥进行更新，根据所述扩展后的设备第一归属信息、所述新的所有者公钥组装凭证重新生成请求发送给所述制造站；步骤SB3：所述制造站解析所述凭证重新生成请求获得所述扩展后的设备第一归属信息、所述新的所有者公钥，从所述扩展后的设备第一归属信息中获取第一签名结果，利用制造站公钥对获取的第一签名结果进行验证，若验证通过，则截断所述扩展后的设备第一归属信息并根据所述新的所有者公钥更新本机内部存储的所有者公钥，重新执行步骤SA4至步骤SA5生成新的设备归属信息并下发给所述所有者端进行合法性验证，若验证未通过，则结束。6.根据权利要求1所述的方法，其特征在于，所述步骤S1之前，还包括：步骤A1：所述物联网设备生成域名信息并获取设备的位置信息；步骤A2：所述物联网设备根据所述域名信息、所述位置信息以及第二预设算法生成CSR数据并保存。7.根据权利要求1所述的方法，其特征在于，所述步骤S1之前，还包括：步骤S1-1：所述物联网设备根据内部存储的设备标识以及设备公钥生成令牌获取请求，对所述令牌获取请求进行编码处理，获得第二编码结果，将所述第二编码结果发送给所述制造站；步骤S1-2：所述制造站解码所述第二编码结果获得所述令牌获取请求，根据所述令牌获取请求生成令牌，组装令牌响应报文，将所述令牌响应报文返回给所述物联网设备；步骤S1-3：所述物联网设备解析所述令牌响应报文获得所述令牌并保存。8.根据权利要求7所述的方法，其特征在于，所述步骤S1-1之前，还包括：所述物联网设备查询内部是否存储有设备密钥对，若否，则利用第一预设算法生成设备密钥对并保存，所述设备密钥对包括设备公钥与设备私钥。9.一种设备归属信息生成系统，其特征在于，所述系统包括物联网设备与制造站，所述物联网设备包括请求生成模块、响应模块，所述制造站包括证书生成模块、信息头组织模块、归属信息生成模块，其中：所述请求生成模块，用于从所述制造站获取令牌，并对所述令牌以及从内部存储中获取的制造站信息、CSR数据、设备描述信息、设备序列号、设备公钥信息进行组装，生成凭证请求核心报文，利用设备私钥对所述凭证请求核心报文进行加密，获得凭证生成请求，将所述凭证生成请求发送给所述制造站，所述设备公钥信息包括公钥类型与公钥编码；所述证书生成模块，用于利用预先存储的设备公钥解密所述凭证生成请求获得所述CSR数据、所述设备描述信息、所述设备公钥信息以及所述令牌，对所述令牌进行验证，若验证成功，则判断本机是否存在与所述物联网设备对应的设备证书，若不存在，根据解密获得的所述CSR数据生成与所述物联网设备对应的设备证书，将所述设备证书与所述设备描述信息对应保存，触发所述信息头组织模块，若验证失败，则结束；所述信息头组织模块，用于获取预先存储的制造站公钥、设备标识以及服务器信息，并对所述设备证书进行哈希运算，获得第一哈希值，根据板载协议版本、所述第一哈希值、所述制造站公钥、解密获得的所述设备描述信息、所述设备标识以及所述服务器信息组装设备初始归属信息头报文，对所述设备初始归属信息头报文进行编码处理，获得第一编码结果，将所述第一编码结果返回给所述物联网设备，其中，所述服务器信息为认证中心服务器的信息，被用于物联网设备注册阶段；所述响应模块，用于对接收的所述第一编码结果进行解码处理，获得所述设备初始归属信息头报文，计算所述设备初始归属信息头报文的哈希消息认证码，基于所述哈希消息认证码以及所述令牌组装凭证设置响应报文，将所述凭证设置响应报文发送给所述制造站；所述归属信息生成模块，用于解析所述凭证设置响应报文获得所述哈希消息认证码以及所述令牌，对所述令牌进行验证，若验证成功，则生成条目信息，根据所述板载协议版本、所述设备初始归属信息头报文、所述哈希消息认证码、所述设备证书以及所述条目信息组装设备初始归属信息并保存，若验证失败，则结束。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现所述权利要求1-8中任一项所述方法的步骤。11.一种物联网设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现所述权利要求1-8中任一项所述方法的步骤。
说明书desc
技术领域本申请涉及信息安全领域，尤其涉及一种设备归属信息生成方法及系统。背景技术目前正值物联网高速发展的阶段，各种物联网终端产品层出不穷且安全协议实现五花八门，有些终端产品甚至没有安全性可言，物联网终端产品的安全性正面临巨大的挑战。现有的物联网终端产品其生产过程大多为在工厂内直接烧录设备信息，设备信息一经烧录，所属关系基本不可变更，除非设备返厂维修等特殊情况。现有方式在设备生产安全性、设备所属关系的证明等方面均不友好。发明内容本申请实施例提供了一种设备归属信息生成方法及系统，所述技术方案如下：第一方面，本申请实施例提供了一种设备归属信息生成方法，所述方法应用于由物联网设备与制造站构成的系统中，包括：步骤S1：所述物联网设备从所述制造站获取令牌，并对所述令牌以及从内部存储中获取的制造站信息、CSR数据、设备描述信息、设备序列号、设备公钥信息进行组装，生成凭证请求核心报文，利用设备私钥对所述凭证请求核心报文进行加密，获得凭证生成请求，将所述凭证生成请求发送给所述制造站，所述设备公钥信息包括公钥类型与公钥编码；步骤S2：所述制造站利用预先存储的设备公钥解密所述凭证生成请求获得所述CSR数据、所述设备描述信息、所述设备公钥信息以及所述令牌，对所述令牌进行验证，若验证成功，则判断本机是否存在与所述物联网设备对应的设备证书，若不存在，根据解密获得的所述CSR数据生成与所述物联网设备对应的设备证书，将所述设备证书与所述设备描述信息对应保存，执行步骤S3，若验证失败，则结束；步骤S3：所述制造站获取预先存储的制造站公钥、设备标识以及服务器信息，并对所述设备证书进行哈希运算，获得第一哈希值，根据板载协议版本、所述第一哈希值、所述制造站公钥、解密获得的所述设备描述信息、所述设备标识以及所述服务器信息组装设备初始归属信息头报文，对所述设备初始归属信息头报文进行编码处理，获得第一编码结果，将所述第一编码结果返回给所述物联网设备，其中，所述服务器信息为认证中心服务器的信息，被用于物联网设备注册阶段；步骤S4：所述物联网设备对接收的所述第一编码结果进行解码处理，获得所述设备初始归属信息头报文，计算所述设备初始归属信息头报文的哈希消息认证码，基于所述哈希消息认证码以及所述令牌组装凭证设置响应报文，将所述凭证设置响应报文发送给所述制造站；步骤S5：所述制造站解析所述凭证设置响应报文获得所述哈希消息认证码以及所述令牌，对所述令牌进行验证，若验证成功，则生成条目信息，根据所述板载协议版本、所述设备初始归属信息头报文、所述哈希消息认证码、所述设备证书以及所述条目信息组装设备初始归属信息并保存，若验证失败，则结束。第二方面，本申请实施例提供了一种设备归属信息生成系统，所述系统包括物联网设备与制造站，所述物联网设备包括请求生成模块、响应模块，所述制造站包括证书生成模块、信息头组织模块、归属信息生成模块，其中：所述请求生成模块，用于从所述制造站获取令牌，并对所述令牌以及从内部存储中获取的制造站信息、CSR数据、设备描述信息、设备序列号、设备公钥信息进行组装，生成凭证请求核心报文，利用设备私钥对所述凭证请求核心报文进行加密，获得凭证生成请求，将所述凭证生成请求发送给所述制造站，所述设备公钥信息包括公钥类型与公钥编码；所述证书生成模块，用于利用预先存储的设备公钥解密所述凭证生成请求获得所述CSR数据、所述设备描述信息、所述设备公钥信息以及所述令牌，对所述令牌进行验证，若验证成功，则判断本机是否存在与所述物联网设备对应的设备证书，若不存在，根据解密获得的所述CSR数据生成与所述物联网设备对应的设备证书，将所述设备证书与所述设备描述信息对应保存，触发所述信息头组织模块，若验证失败，则结束；所述信息头组织模块，用于获取预先存储的制造站公钥、设备标识以及服务器信息，并对所述设备证书进行哈希运算，获得第一哈希值，根据板载协议版本、所述第一哈希值、所述制造站公钥、解密获得的所述设备描述信息、所述设备标识以及所述服务器信息组装设备初始归属信息头报文，对所述设备初始归属信息头报文进行编码处理，获得第一编码结果，将所述第一编码结果返回给所述物联网设备，其中，所述服务器信息为认证中心服务器的信息，被用于物联网设备注册阶段；所述响应模块，用于对接收的所述第一编码结果进行解码处理，获得所述设备初始归属信息头报文，计算所述设备初始归属信息头报文的哈希消息认证码，基于所述哈希消息认证码以及所述令牌组装凭证设置响应报文，将所述凭证设置响应报文发送给所述制造站；所述归属信息生成模块，用于解析所述凭证设置响应报文获得所述哈希消息认证码以及所述令牌，对所述令牌进行验证，若验证成功，则生成条目信息，根据所述板载协议版本、所述设备初始归属信息头报文、所述哈希消息认证码、所述设备证书以及所述条目信息组装设备初始归属信息并保存，若验证失败，则结束。第三方面，本申请实施例提供了一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现上述任一项方法的步骤。第四方面，本申请实施例提供了一种物联网设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现上述任一项方法的步骤。本申请一些实施例提供的技术方案带来的有益效果至少包括：本申请通过制造站生成、管理、分发设备归属信息，此机制可免去人工登记入库环节、使得设备归属关系可追溯、还可使物联网设备更加安全地运输和分发。通过采用本申请提供的所述方法，可以确保物联网设备的合法性与安全性。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1-图4是本申请实施例提供的一种设备归属信息生成方法的流程示意图。具体实施方式为使本申请的目的、技术方案和优点更加清楚，下面将结合附图对本申请实施例方式作进一步地详细描述。下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。以下示例性实施例中所描述的实施方式并不代表与本申请相一致的所有实施方式。相反，它们仅是如所附权利要求书中所详述的、本申请的一些方面相一致的系统和方法的例子。在本申请的描述中，需要理解的是，术语“第一”、“第二”等仅用于描述目的，而不能理解为指示或暗示相对重要性。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本申请中的具体含义。此外，在本申请的描述中，除非另有说明，“多个”是指两个或两个以上。“和/或”，描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。字符“/”一般表示前后关联对象是一种“或”的关系。下面将结合附图1-附图4，对本申请实施例提供的设备归属信息生成方法进行详细介绍。请参见图1-图4，为本申请实施例提供的一种设备归属信息生成方法的流程示意图。本申请提供的所述方法应用于由物联网设备、制造站、业务端、所有者端以及客户端构成的系统中，如图1-图4所示，该方法可以包括以下步骤：步骤S1：物联网设备对从内部存储中获取的制造站信息、CSR数据、设备描述信息、设备序列号、设备公钥信息以及令牌进行组装，生成凭证请求核心报文，利用设备私钥对凭证请求核心报文进行加密，获得凭证生成请求，将凭证生成请求发送给制造站。其中，设备公钥信息包括公钥类型与公钥编码。凭证请求核心报文例如为：{"manufacturingInfo"：{"certInfo": {"object":"-----BEGIN CERTIFICATE REQUEST-----MIIBKjCB0AIBADBGMQswCQYDVQQGEwJDTjEQMA4GA1UECBMHYmVpamluZzEQMA4GA1UEBxMHYmVpamluZzETMBEGA1UEAxMKZnRzYWZlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJ+ANejh8d6Y21sgxLa3017v41j9iTyCoQ4LqEbTZzf+7gPL+ExjJhTM8ghzset8ivcu+76CXWuMKx+d/wevcaOgKDAmBgkqhkiG9w0BCQ4xGTAXMBUGA1UdEQQOMAyCCmZ0c2FmZS5jb20wCgYIKoZIzj0EAwIDSQAwRgIhAKILqXiboZfI4xriwJsILxC4hEs7cdTjtplP1L9v/q9xAiEAj7yypzeh83r/OyQDcQuPPJhYT2b6lWoKQwMGqvz/eyY=-----END CERTIFICATE REQUEST-----"},"deviceInfo": "DemoDevice","keyEnc": "X509","keyType": "SECP256R1","serialNumber": "202208231515025"}}步骤S1之前，还包括：步骤Y1：业务端接收所有者端发送的应用申请请求，创建应用并生成应用信息，将应用信息下发给所有者端。应用信息包括应用标识与应用密钥。应用信息例如为：{"appkey":"4E9CD1672503C32B6162""appsecret":"m3jyUy6P3S7XKHHnktA=="}步骤Y2：所有者端对应用信息进行保存。可能的实施例中，步骤S1之前，还包括：步骤A1：物联网设备生成域名信息并获取设备的位置信息。域名信息例如为：CN。设备的位置信息例如为："Organization":"feitian","Locality":"beijing","State":"beijing","Country":"CN",步骤A2：物联网设备根据域名信息、位置信息以及第二预设算法生成CSR数据并保存。第二预设算法具体为ECDSA算法。生成的CSR数据例如为：-----BEGIN CERTIFICATE REQUEST-----MIIBKjCB0AIBADBGMQswCQYDVQQGEwJDTjEQMA4GA1UECBMHYmVpamluZzEQMA4GA1UEBxMHYmVpamluZzETMBEGA1UEAxMKZnRzYWZlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJ+ANejh8d6Y21sgxLa3017v41j9iTyCoQ4LqEbTZzf+7gPL+ExjJhTM8ghzset8ivcu+76CXWuMKx+d/wevcaOgKDAmBgkqhkiG9w0BCQ4xGTAXMBUGA1UdEQQOMAyCCmZ0c2FmZS5jb20wCgYIKoZIzj0EAwIDSQAwRgIhAKILqXiboZfI4xriwJsILxC4hEs7cdTjtplP1L9v/q9xAiEAj7yypzeh83r/OyQDcQuPPJhYT2b6lWoKQwMGqvz/eyY=-----END CERTIFICATE REQUEST-----步骤S1之前，还包括：步骤S1-1：物联网设备根据内部存储的设备标识以及设备公钥生成令牌获取请求，对令牌获取请求进行编码处理，获得第二编码结果，将第二编码结果发送给制造站。设备标识例如为：20010000001。设备公钥例如为：71b31bc0ae9264580d4846fe7f79d2fc0227dc23debd3d01c45fdecd0177ed94531346e54a9cb52d1d349f909e1007feba9e2e8961453329d6498850b2835a18947284650dfb8885984af57ae44115721bcd5e9bf0f04e3bbe0f926b4ae0d358f8b7f7791102869664a9da088c7c32230cd90399a35ae4a53f77e7849e9f983e对令牌获取请求的编码处理具体为CBOR编码。步骤S1-2：制造站解码第二编码结果获得令牌获取请求，根据令牌获取请求生成令牌，组装令牌响应报文，将令牌响应报文返回给物联网设备。生成的令牌例如为：3045022100a3b3225fe43e2a808d243b47f254777c354461121a6c5049914df780a539bc4302207506cfe5846223aa31935a95512e3613834932db92630e0ea7e692ff5447e8e1步骤S1-3：物联网设备解析令牌响应报文获得令牌并保存。可能的实施例中，步骤S1-1之前，还包括：步骤T：物联网设备查询内部是否存储有设备密钥对，若否，则利用第一预设算法生成设备密钥对并保存，执行步骤S1-1，若是，执行步骤S1-1。第一预设算法具体为ECC算法。设备密钥对包括设备公钥与设备私钥。步骤S2：制造站利用预先存储的设备公钥解密凭证生成请求获得CSR数据、设备描述信息、设备公钥信息以及令牌，对令牌进行验证，若验证成功，则判断本机是否存在与物联网设备对应的设备证书，若存在则结束，若不存在，根据解密获得的CSR数据生成与物联网设备对应的设备证书，将设备证书与设备描述信息对应保存，执行步骤S3，若验证失败，则结束。可选实施例中，步骤S2还包括：若判断本机存在与物联网设备对应的设备证书，则结束。步骤S3：制造站获取预先存储的制造站公钥、设备标识以及服务器信息，并对设备证书进行哈希运算，获得第一哈希值，根据板载协议版本、第一哈希值、制造站公钥、解密获得的设备描述信息、设备标识以及服务器信息组装设备初始归属信息头报文，对设备初始归属信息头报文进行编码处理，获得第一编码结果，将第一编码结果返回给物联网设备。其中，服务器信息为认证中心服务器的信息，被用于物联网设备注册阶段。制造站公钥例如为：BAgIIb2dAfABGSlYwCgYIKoZIzj0EAwIwFDESMBAGA1UEAwwJRmRvRW50aXR5MCAXDTIyMDcyODAxMzQzMVoYDzIwNTIwMjIxMDEzNDMxWjAUMRIwEAYDVQQDDAlGZG9FbnRpdHkwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATsQzhCHspLHBMtBjJkxU+93WTGpoEduhEpWzu1Qm3BoangzAbeiZwhcRQ1XGbdNOnYRfnCgpftPKnDaanM9dUPMAoGCCqGSM49BAMCA0cAMEQCIEvW7f3sjiE18HnG5BKDc1ytRZkR6hZrszkpO6Vu1J4LAiAwDRYUz9HyeV+atc2Id4klSKxRUPQVU1vBkrgGnuKLTDCCAR0wgcSgAwIBAgIIMv4Jn4ixRdAwCgYIKoZIzj0EAwIwFDESMBAGA1第一哈希值例如为：s9ZnEN7eMCrmADtdGhOG3982Sju+2coDk+TS+haPZIA=设备初始归属信息头报文例如为：{"voucherHeader": { "certHash": {"hashType": "SHA256","hashValue": "/cgPU8g6VNx3SheH41HPSTSlgccuqEty/7B8cmpeO8w=" }, "deviceInfo": "DemoDevice", "guid": {}, "publicKey": {"body": { "object": ""},"enc": "X509","type": "SECP256R1" }, "rendezvousInfo":  "version": "V101"}}步骤S4：物联网设备对接收的第一编码结果进行解码处理，获得设备初始归属信息头报文，计算设备初始归属信息头报文的哈希消息认证码，基于哈希消息认证码以及令牌组装凭证设置响应报文，将凭证设置响应报文发送给制造站。哈希消息认证码例如为：Juczi1QtAlkrvi3JTpHFc/pqQ2V3HF+ufZdqMm/v0Vs=步骤S5：制造站解析凭证设置响应报文获得哈希消息认证码以及令牌，对令牌进行验证，若验证成功，则生成条目信息，根据板载协议版本、设备初始归属信息头报文、哈希消息认证码、设备证书以及条目信息组装设备初始归属信息并保存，若验证失败，则结束。条目信息例如为："entries": 组装成的设备初始归属信息例如为："voucher": {"certChain": { "chain": ,"encoded": "MIIBHTCBxKADAgECAggy/gmfiLFF0DAKBggqhkjOPQQDAjAUMRIwEAYDVQQDDAlGZG9FbnRpdHkwIBcNMjIwNzI4MDEzNDMxWhgPMjA1MjAyMjEwMTM0MzFaMBQxEjAQBgNVBAMMCUZkb0VudGl0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABEa71ejdOBFuXSQMUbI0TiZ+jts9YSI5bQi87GOHx+HHUzdRYcke7yZR9BZuZcLdX2Fab7vdJaJLUnBbHUDrhIowCgYIKoZIzj0EAwIDSAAwRQIhAL4EDFUFv1JMoNZBQpz4LZs8qUktLg82dQjsTJl0lE2MAiBb+fQD7vv3QQI7VBz3ioa8Hz/m3jyUy6P3S7XKHHnktA==","encodedInternal": "MIIBHTCBxKADAgECAggy/gmfiLFF0DAKBggqhkjOPQQDAjAUMRIwEAYDVQQDDAlGZG9FbnRpdHkwIBcNMjIwNzI4MDEzNDMxWhgPMjA1MjAyMjEwMTM0MzFaMBQxEjAQBgNVBAMMCUZkb0VudGl0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABEa71ejdOBFuXSQMUbI0TiZ+jts9YSI5bQi87GOHx+HHUzdRYcke7yZR9BZuZcLdX2Fab7vdJaJLUnBbHUDrhIowCgYIKoZIzj0EAwIDSAAwRQIhAL4EDFUFv1JMoNZBQpz4LZs8qUktLg82dQjsTJl0lE2MAiBb+fQD7vv3QQI7VBz3ioa8Hz/m3jyUy6P3S7XKHHnktA==",......"payload": "hIIvWCBEqXfLX292SrawWgDqbHzMS3kAa7Qj6R5oQM5s6lN+uYIvWCCpYodNV6SilmgANxHNCAjMOSj+8i1TRhw3rARsqQY0TfaDCgFYWzBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABGNDwai+L6zgRxHgQzPNqKExP7r/BX2QWrf+g5TVNhPdLXInadFx7JdSBzcZDqNpswfsCH0KYrKKPR9Sf2wyB7g=", "protectedHeader": "oQEm", "signature": "mhujAJoU2qzmyPiZzMAWlPy1WD2RFWhn/j2V9RbQR0QnfOqfODb0AmlESmYpsPX4taBFazTojZSn/xLYGzXz4Q==", "tag": "COSE_SIGN_1", "unprotectedHeader": {}}],"header": "hhhlUEUJzgc4L0JEsfUGWlIdry2BhYIFSmkxMjcuMC4wLjGCA0MZH5CCDEEBggJFRH8AAAGCBEMZH5BqRGVtb0RldmljZYMKAVhbMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7EM4Qh7KSxwTLQYyZMVPvd1kxqaBHboRKVs7tUJtwaGp4MwG3omcIXEUNVxm3TTp2EX5woKX7Typw2mpzPXVD4IvWCD9yA9TyDpU3HdKF4fjUc9JNKWBxy6oS3L/sHxyal47zA==","hmac": { "hashType": "HMAC_SHA256", "hashValue": "Juczi1QtAlkrvi3JTpHFc/pqQ2V3HF+ufZdqMm/v0Vs="},"version": "V101" }步骤SA1：所有者端利用第一预设算法生成所有者公私密钥对并保存，根据订单、保存的应用标识以及所有者公钥生成订单信息，利用应用密钥对订单信息进行加密，将加密后的订单信息发送给业务端。保存的应用标识例如为：4E9CD1672503C32B6162订单例如为：10000所有者公钥如为：BFuXSQMUbI0TiZ+jts9YSI5bQi87GOHx+HHUzdRYcke7yZR9BZuZcLdX2Fab7vdJaJLUnBbHUDrhIowCgYIKoZIzj0EAwIDSAAwRQIhAL4EDFUFv1JMoNZBQpz4LZs8qUktLg82dQjsTJl0lE2MAiBb+fQD7vv3QQI7VBz3ioa8Hz/m3jyUy6P3S7XKHHnktA==应用密钥如为：m3jyUy6P3S7XKHHnktA==步骤SA2：业务端利用内部存储的应用密钥对加密后的订单信息进行解密，获得应用标识与所有者公钥，将应用标识与所有者公钥对应保存，基于订单信息生成下单信息并发送给制造站。步骤SA3：制造站解析下单信息获取所有者公钥并保存。步骤SA4：制造站对设备初始归属信息头报文与哈希消息认证码进行哈希运算，获得第二哈希值，对设备标识以及设备描述信息进行哈希运算，获得第三哈希值，利用制造站私钥对第二哈希值、第三哈希值、所有者公钥进行签名，获得第一签名结果，根据保存的设备初始归属信息、所有者公钥、第二哈希值、第三哈希值以及第一签名结果生成扩展后的设备第一归属信息，将扩展后的设备第一归属信息下发给所有者端。第二哈希值例如为：+08zSk0gtLKXttWLCEjMGtV+2bPRYm+n51mc1bKQUPc=第三哈希值例如为：//SO7ZCWUnOc1O+K9HzpwCGrcpYOtKkb4tjwr0IA3dE=制造站私钥例如为：-----BEGIN PRIVATE KEY-----MIIBVgIBADANBgkqhkiG9w0BAQEFAASCAUAwggE8AgEAAkEA0E7RAcyPyRwZZqp93Mipaplq6jTXXZGYojJgKsgKm5DOGVL279UlFqvA2bZFEoESGrt3fPWIWNzKgXwxgJYpxwIDAQABAkEAiqeb2a23G693fO4JPzfWBR2/m8u2exLZ3UTY3EExRmBF1iAdGU/NKoXb/qfDo2HpEIB/+hDoBxw40Mgq1w9M2QIhAPRLp3Kk5L0MbP+oeO+aJSIYlWTKKYebO+65ST83XnYFAiEA2knDyxTeHhJudlTJSgUZanaU4+rmbBMo5VR6l0JJPlsCIQDA28Dzts2FmXurUTs4HL7X7gRyr06d6aUkz03OBE4kaQIhAI8wgB0BTUrQsGEy8O97NNbffn+boRcX4mW86sW6F62tAiB820bMbeMBzofhtTfAOVol6cNDXrQozT3dv3+3PH8kVg==-----END PRIVATE KEY-----第一签名结果例如为：ZZoiOCtdZCNRWhGMX8i+Skmp2gX3ZrmoXT5uKy7f6dAIv6DhGyuQARtGzj3mWmCAYTsLZkePrPVA7+WLx501Ng==扩展后的设备第一归属信息例如为："voucher": {"certChain": { "chain": ,"encoded": "MIIBHTCBxKADAgECAggy/gmfiLFF0DAKBggqhkjOPQQDAjAUMRIwEAYDVQQDDAlGZG9FbnRpdHkwIBcNMjIwNzI4MDEzNDMxWhgPMjA1MjAyMjEwMTM0MzFaMBQxEjAQBgNVBAMMCUZkb0VudGl0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABEa71ejdOBFuXSQMUbI0TiZ+jts9YSI5bQi87GOHx+HHUzdRYcke7yZR9BZuZcLdX2Fab7vdJaJLUnBbHUDrhIowCgYIKoZIzj0EAwIDSAAwRQIhAL4EDFUFv1JMoNZBQpz4LZs8qUktLg82dQjsTJl0lE2MAiBb+fQD7vv3QQI7VBz3ioa8Hz/m3jyUy6P3S7XKHHnktA==","encodedInternal": "MIIBHTCBxKADAgECAggy/gmfiLFF0DAKBggqhkjOPQQDAjAUMRIwEAYDVQQDDAlGZG9FbnRpdHkwIBcNMjIwNzI4MDEzNDMxWhgPMjA1MjAyMjEwMTM0MzFaMBQxEjAQBgNVBAMMCUZkb0VudGl0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABEa71ejdOBFuXSQMUbI0TiZ+jts9YSI5bQi87GOHx+HHUzdRYcke7yZR9BZuZcLdX2Fab7vdJaJLUnBbHUDrhIowCgYIKoZIzj0EAwIDSAAwRQIhAL4EDFUFv1JMoNZBQpz4LZs8qUktLg82dQjsTJl0lE2MAiBb+fQD7vv3QQI7VBz3ioa8Hz/m3jyUy6P3S7XKHHnktA==",......"entries": "header": "hhhlUEUJzgc4L0JEsfUGWlIdry2BhYIFSmkxMjcuMC4wLjGCA0MZH5CCDEEBggJFRH8AAAGCBEMZH5BqRGVtb0RldmljZYMKAVhbMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7EM4Qh7KSxwTLQYyZMVPvd1kxqaBHboRKVs7tUJtwaGp4MwG3omcIXEUNVxm3TTp2EX5woKX7Typw2mpzPXVD4IvWCD9yA9TyDpU3HdKF4fjUc9JNKWBxy6oS3L/sHxyal47zA==","hmac": { "hashType": "HMAC_SHA256", "hashValue": "Juczi1QtAlkrvi3JTpHFc/pqQ2V3HF+ufZdqMm/v0Vs="},"version": "V101" }步骤SA5：所有者端对扩展后的设备第一归属信息进行合法性验证，若验证合法，则保存扩展后的设备第一归属信息，若验证不合法，则结束。具体的，步骤SA5可包括：步骤SA5-1：所有者端解析扩展后的设备第一归属信息获得设备初始归属信息头报文、哈希消息认证码、设备证书、所有者公钥、第二哈希值、第三哈希值、第一签名结果。步骤SA5-2：所有者端从解析获得的设备初始归属信息头报文中获取制造站公钥，利用解析获取的制造站公钥计算解析获得的设备初始归属信息头报文的哈希消息认证码，将解析获得的哈希消息认证码与计算获得的哈希消息认证码进行对比，若一致，则执行步骤SA5-3，若不一致，则验证扩展后的设备第一归属信息不合法，结束。步骤SA5-3：所有者端从解析获得的设备初始归属信息头报文中获取第一哈希值，并对解析获得的设备证书进行哈希运算，获得第四哈希值，将获取的第一哈希值与运算获得的第四哈希值进行对比，若一致，则执行步骤SA5-4，若不一致，则验证扩展后的设备第一归属信息不合法，结束。步骤SA5-4：所有者端利用解析获取的制造站公钥对解析获得的第一签名结果进行验证，若验证通过，则执行步骤SA5-5，若验证未通过，则扩展后的设备第一归属信息不合法，结束。步骤SA5-5：所有者端从解析获得的设备初始归属信息头报文中获取设备描述信息与设备标识，对解析获得的设备描述信息与设备标识进行哈希运算，获得第五哈希值，将解析获得的第三哈希值与运算获得的第五哈希值进行对比，若一致，则执行步骤SA5-6，若不一致，则验证扩展后的设备第一归属信息不合法，结束。步骤SA5-6：所有者端将解析获得的所有者公钥与内部存储的公钥进行对比，若一致，则执行步骤SA5-7，若不一致，则验证扩展后的设备第一归属信息不合法，结束。步骤SA5-7：所有者端对解析获得的设备初始归属信息头报文与哈希消息认证码进行哈希运算，获得第六哈希值，将解析获得的第二哈希值与运算获得的第六哈希值进行对比，若一致，则设备第一归属信息验证合法，保存扩展后的设备第一归属信息，若不一致，则验证扩展后的设备第一归属信息不合法，结束。步骤SA6：所有者端根据订单从内部存储中查找对应的客户公钥，利用应用密钥对客户公钥进行加密获得归属信息扩展请求密文，将归属信息扩展请求密文发送给业务端。步骤SA7：业务端利用内部存储的应用密钥对归属信息扩展请求密文进行解密，将解密获得的客户公钥发送给制造站。步骤SA8：制造站对设备初始归属信息头报文与哈希消息认证码进行哈希运算，获得第二哈希值，对设备标识以及设备描述信息进行哈希运算，获得第三哈希值，利用制造站私钥对第二哈希值、第三哈希值、客户公钥进行签名，获得第二签名结果，根据保存的设备第一归属信息、客户公钥、第二哈希值、第三哈希值以及第二签名结果生成扩展后的设备第二归属信息，将扩展后的设备第二归属信息下发给客户端。一个设备对应一个设备归属信息，该证明文件可以根据设备所属关系的转移而不断追加。本申请所给实施例对应的是客户端下单单个设备的情况。其他实施例中，客户端还可能下单多个设备，当下单多个设备时，制造站对应生成多个扩展后的设备第二归属信息下发给客户端。可能的实施例中，步骤SA5之后还存在所有者丢失密钥的情况，当密钥丢失时，执行如下步骤：步骤SB1：所有者端利用第一预设算法重新生成新的所有者公私密钥对并保存，根据扩展后的设备第一归属信息、应用标识以及新的所有者公钥组装凭证损坏请求，利用应用密钥对凭证损坏请求进行加密，将加密后的凭证损坏请求发送给业务端。新的所有者公钥例如为：-----BEGIN PUBLIC KEY-----MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALFdBCHzc88aTZsenekRo//Se4wyaPpPr3F3zbVl5ebrZ6SN4/hugPJmMa4gEUGo+c0n9tO8vl7T4jBB3u0ZlEUCAwEAAQ==-----END PUBLIC KEY-----组装的凭证损坏请求例如为：{"appkey":"4E9CD1672503C32B6162", "method":"voucherDamage", "pubkey":"MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALFdBCHzc88aTZsenekRo//Se4wyaPpPr3F3zbVl5ebrZ6SN4/hugPJmMa4gEUGo+c0n9tO8vl7T4jBB3u0ZlEUCAwEAAQ=="}步骤SB2：业务端利用内部存储的应用密钥对加密后的凭证损坏请求进行解密，获得应用标识与新的所有者公钥，根据新的所有者公钥对本机内部存储的与应用标识对应的公钥进行更新，根据扩展后的设备第一归属信息、新的所有者公钥组装凭证重新生成请求发送给制造站。组装的凭证重新生成请求例如为：{"appkey":"4E9CD1672503C32B6162", "method":"voucherDamage", "pubkey":"MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALFdBCHzc88aTZsenekRo//Se4wyaPpPr3F3zbVl5ebrZ6SN4/hugPJmMa4gEUGo+c0n9tO8vl7T4jBB3u0ZlEUCAwEAAQ=="， "voucher": {"certChain": { "chain": ,"encoded": "MIIBHTCBxKADAgECAggy/gmfiLFF0DAKBggqhkjOPQQDAjAUMRIwEAYDVQQDDAlGZG9FbnRpdHkwIBcNMjIwNzI4MDEzNDMxWhgPMjA1MjAyMjEwMTM0MzFaMBQxEjAQBgNVBAMMCUZkb0VudGl0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABEa71ejdOBFuXSQMUbI0TiZ+jts9YSI5bQi87GOHx+HHUzdRYcke7yZR9BZuZcLdX2Fab7vdJaJLUnBbHUDrhIowCgYIKoZIzj0EAwIDSAAwRQIhAL4EDFUFv1JMoNZBQpz4LZs8qUktLg82dQjsTJl0lE2MAiBb+fQD7vv3QQI7VBz3ioa8Hz/m3jyUy6P3S7XKHHnktA==","encodedInternal": "MIIBHTCBxKADAgECAggy/gmfiLFF0DAKBggqhkjOPQQDAjAUMRIwEAYDVQQDDAlGZG9FbnRpdHkwIBcNMjIwNzI4MDEzNDMxWhgPMjA1MjAyMjEwMTM0MzFaMBQxEjAQBgNVBAMMCUZkb0VudGl0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABEa71ejdOBFuXSQMUbI0TiZ+jts9YSI5bQi87GOHx+HHUzdRYcke7yZR9BZuZcLdX2Fab7vdJaJLUnBbHUDrhIowCgYIKoZIzj0EAwIDSAAwRQIhAL4EDFUFv1JMoNZBQpz4LZs8qUktLg82dQjsTJl0lE2MAiBb+fQD7vv3QQI7VBz3ioa8Hz/m3jyUy6P3S7XKHHnktA==","entries": "header": "hhhlUEUJzgc4L0JEsfUGWlIdry2BhYIFSmkxMjcuMC4wLjGCA0MZH5CCDEEBggJFRH8AAAGCBEMZH5BqRGVtb0RldmljZYMKAVhbMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7EM4Qh7KSxwTLQYyZMVPvd1kxqaBHboRKVs7tUJtwaGp4MwG3omcIXEUNVxm3TTp2EX5woKX7Typw2mpzPXVD4IvWCD9yA9TyDpU3HdKF4fjUc9JNKWBxy6oS3L/sHxyal47zA==","hmac": { "hashType": "HMAC_SHA256", "hashValue": "Juczi1QtAlkrvi3JTpHFc/pqQ2V3HF+ufZdqMm/v0Vs="},"version": "V101" }}步骤SB3：制造站解析凭证重新生成请求获得扩展后的设备第一归属信息、新的所有者公钥，从扩展后的设备第一归属信息中获取第一签名结果，利用制造站公钥对获取的第一签名结果进行验证，若验证通过，则截断扩展后的设备第一归属信息并根据新的所有者公钥更新本机内部存储的所有者公钥，重新执行步骤SA4至步骤SA5生成新的设备归属信息并下发给所有者端进行合法性验证，若验证未通过，则结束。制造站A生产物联网设备B，此时物联网设备B所属关系为制造站A，制造站A生成设备初始归属信息；客户C采购设备B并向代理方D下单，代理方D获得客户C公钥并根据自身公钥以及客户C公钥通过业务方E向制造站A申请转移设备B所属关系，制造站A根据代理方D公钥将设备初始归属信息扩展为设备第一归属信息，将设备B所属关系转移给代理方D，再根据客户C公钥将设备第一归属信息扩展为设备第二归属信息，将设备B所属关系转移到客户C，完成所属关系转移。本申请通过制造站生成、管理、分发设备归属信息，此机制可免去人工登记入库环节、使得设备归属关系可追溯、还可使物联网设备更加安全地运输和分发。通过采用本申请提供的所述方法，可以确保物联网设备的合法性与安全性。下述为本申请系统实施例，可以用于执行本申请方法实施例。对于本申请系统实施例中未披露的细节，请参照本申请方法实施例。本申请实施例中的设备初始归属信息生成系统包括物联网设备与制造站，所述物联网设备包括请求生成模块、响应模块，所述制造站包括证书生成模块、信息头组织模块、归属信息生成模块，其中：所述请求生成模块，用于从所述制造站获取令牌，并对所述令牌以及从内部存储中获取的制造站信息、CSR数据、设备描述信息、设备序列号、设备公钥信息进行组装，生成凭证请求核心报文，利用设备私钥对所述凭证请求核心报文进行加密，获得凭证生成请求，将所述凭证生成请求发送给所述制造站，所述设备公钥信息包括公钥类型与公钥编码；所述证书生成模块，用于利用预先存储的设备公钥解密所述凭证生成请求获得所述CSR数据、所述设备描述信息、所述设备公钥信息以及所述令牌，对所述令牌进行验证，若验证成功，则判断本机是否存在与所述物联网设备对应的设备证书，若不存在，根据解密获得的所述CSR数据生成与所述物联网设备对应的设备证书，将所述设备证书与所述设备描述信息对应保存，触发所述信息头组织模块，若验证失败，则结束；所述信息头组织模块，用于获取预先存储的制造站公钥、设备标识以及服务器信息，并对所述设备证书进行哈希运算，获得第一哈希值，根据板载协议版本、所述第一哈希值、所述制造站公钥、解密获得的所述设备描述信息、所述设备标识以及所述服务器信息组装设备初始归属信息头报文，对所述设备初始归属信息头报文进行编码处理，获得第一编码结果，将所述第一编码结果返回给所述物联网设备，其中，所述服务器信息为认证中心服务器的信息，被用于物联网设备注册阶段；所述响应模块，用于对接收的所述第一编码结果进行解码处理，获得所述设备初始归属信息头报文，计算所述设备初始归属信息头报文的哈希消息认证码，基于所述哈希消息认证码以及所述令牌组装凭证设置响应报文，将所述凭证设置响应报文发送给所述制造站；所述归属信息生成模块，用于解析所述凭证设置响应报文获得所述哈希消息认证码以及所述令牌，对所述令牌进行验证，若验证成功，则生成条目信息，根据所述板载协议版本、所述设备初始归属信息头报文、所述哈希消息认证码、所述设备证书以及所述条目信息组装设备初始归属信息并保存，若验证失败，则结束。可选实施例中，所述系统还包括业务端以及所有者端，业务端包括应用信息生成模块，所述所有者端包括存储模块，其中：所述应用信息生成模块，用于接收所述所有者端发送的应用申请请求，创建应用并生成应用信息，将所述应用信息下发给所述所有者端，所述应用信息包括应用标识与应用密钥；所述存储模块，用于对所述应用信息进行保存；所述所有者端还包括订单信息生成模块，用于：利用第一预设算法生成所有者公私密钥对并保存，根据订单、保存的应用标识以及所有者公钥生成订单信息，利用所述应用密钥对所述订单信息进行加密，将加密后的所述订单信息发送给所述业务端；所述业务端还包括下单信息生成模块，用于：利用内部存储的应用密钥对加密后的所述订单信息进行解密，获得所述应用标识与所述所有者公钥，将所述应用标识与所述所有者公钥对应保存，基于所述订单信息生成下单信息发送给所述制造站；所述制造站还包括所有者公钥获取模块，用于：解析所述下单信息获取所述所有者公钥并保存；所述制造站还包括归属信息扩展模块，用于：对所述设备初始归属信息头报文与所述哈希消息认证码进行哈希运算，获得第二哈希值，对所述设备标识以及所述设备描述信息进行哈希运算，获得第三哈希值，利用制造站私钥对所述第二哈希值、所述第三哈希值以及所述所有者公钥进行签名，获得第一签名结果，根据保存的所述设备初始归属信息、所述所有者公钥、所述第二哈希值、所述第三哈希值以及所述第一签名结果生成扩展后的设备第一归属信息，将所述扩展后的设备第一归属信息下发给所述所有者端；所述所有者端还包括归属信息验证模块，用于：对所述扩展后的设备第一归属信息进行合法性验证，若验证合法，则保存所述扩展后的设备第一归属信息，若验证不合法，则结束。可选实施例中，所述归属信息验证模块具体包括：解析单元，用于解析所述扩展后的设备第一归属信息获得设备初始归属信息头报文、哈希消息认证码、设备证书、所有者公钥、第二哈希值、第三哈希值、第一签名结果；第一对比单元，用于从解析获得的设备初始归属信息头报文中获取制造站公钥，利用解析获取的制造站公钥计算解析获得的设备初始归属信息头报文的哈希消息认证码，将解析获得的哈希消息认证码与计算获得的哈希消息认证码进行对比，若一致，则触发第二对比单元，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；第二对比单元，用于从解析获得的设备初始归属信息头报文中获取第一哈希值，并对解析获得的设备证书进行哈希运算，获得第四哈希值，将获取的第一哈希值与运算获得的第四哈希值进行对比，若一致，则执行步骤SA5-4，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；验签单元，用于利用解析获取的制造站公钥对解析获得的第一签名结果进行验证，若验证通过，则触发第三对比单元，若验证未通过，则所述扩展后的设备第一归属信息不合法，结束；第三对比单元，用于从解析获得的设备初始归属信息头报文中获取设备描述信息与设备标识，对解析获得的设备描述信息与设备标识进行哈希运算，获得第五哈希值，将解析获得的第三哈希值与运算获得的第五哈希值进行对比，若一致，则触发第四对比单元，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；第四对比单元，用于将解析获得的所有者公钥与内部存储的公钥进行对比，若一致，则触发第五对比单元，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束；第五对比单元，用于对解析获得的设备初始归属信息头报文与哈希消息认证码进行哈希运算，获得第六哈希值，将解析获得的第二哈希值与运算获得的第六哈希值进行对比，若一致，则验证合法，保存所述扩展后的设备第一归属信息，若不一致，则验证所述扩展后的设备第一归属信息不合法，结束。可选实施例中，所述归属信息扩展模块还用于：根据所述订单从内部存储中查找对应的客户公钥，利用所述应用密钥对所述客户公钥进行加密获得归属信息扩展请求密文，将所述归属信息扩展请求密文发送给所述业务端；利用内部存储的应用密钥对所述归属信息扩展请求密文进行解密，将解密获得的客户公钥发送给所述制造站；对所述设备初始归属信息头报文与所述哈希消息认证码进行哈希运算，获得第二哈希值，对所述设备标识以及所述设备描述信息进行哈希运算，获得第三哈希值，利用所述制造站私钥对所述第二哈希值、所述第三哈希值、所述客户公钥进行签名，获得第二签名结果，根据保存的设备第一归属信息、所述客户公钥、所述第二哈希值、所述第三哈希值以及所述第二签名结果生成扩展后的设备第二归属信息，将所述扩展后的设备第二归属信息下发给所述客户端。可选实施例中，所述所有者端还包括：损坏请求生成模块，用于利用所述第一预设算法重新生成新的所有者公私密钥对并保存，根据所述扩展后的设备第一归属信息、所述应用标识以及新的所有者公钥组装凭证损坏请求，利用所述应用密钥对所述凭证损坏请求进行加密，将加密后的所述凭证损坏请求发送给所述业务端；所述业务端还包括：公钥更新模块，用于利用内部存储的应用密钥对加密后的所述凭证损坏请求进行解密，获得所述应用标识与所述新的所有者公钥，根据所述新的所有者公钥对本机内部存储的与所述应用标识对应的公钥进行更新，根据所述扩展后的设备第一归属信息、所述新的所有者公钥组装凭证重新生成请求发送给所述制造站；所述制造站还包括：归属信息重新生成模块，用于解析所述凭证重新生成请求获得所述扩展后的设备第一归属信息、所述新的所有者公钥，从所述扩展后的设备第一归属信息中获取第一签名结果，利用制造站公钥对获取的第一签名结果进行验证，若验证通过，则截断所述扩展后的设备第一归属信息并根据所述新的所有者公钥更新本机内部存储的所有者公钥，重新触发所述响应模块与所述归属信息生成模块生成新的设备归属信息并下发给所述所有者端进行合法性验证，若验证未通过，则结束。可选实施例中，所述物联网设备还包括：信息处理模块，用于生成域名信息并获取设备的位置信息；CSR数据生成模块，用于根据所述域名信息、所述位置信息以及第二预设算法生成CSR数据并保存。可选实施例中，所述物联网设备还包括令牌请求模块，用于：根据内部存储的设备标识以及设备公钥生成令牌获取请求，对所述令牌获取请求进行编码处理，获得第二编码结果，将所述第二编码结果发送给所述制造站；所述制造站还包括：令牌生成模块，用于解码所述第二编码结果获得所述令牌获取请求，根据所述令牌获取请求生成令牌，组装令牌响应报文，将所述令牌响应报文返回给所述物联网设备；所述物联网设备还包括令牌保存模块，用于：解析所述令牌响应报文获得所述令牌并保存。可选实施例中，所述物联网设备还包括密钥生成模块，用于：查询内部是否存储有设备密钥对，若否，则利用第一预设算法生成设备密钥对并保存，所述设备密钥对包括设备公钥与设备私钥。需要说明的是，上述实施例提供的设备初始归属信息生成系统在执行设备初始归属信息生成方法时，仅以上述各功能模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将设备的内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能。另外，上述实施例提供的设备初始归属信息生成系统与设备初始归属信息生成方法实施例属于同一构思，其体现实现过程详见方法实施例，这里不再赘述。上述本申请实施例序号仅仅为了描述，不代表实施例的优劣。本申请通过制造站生成、管理、分发设备归属信息，此机制可免去人工登记入库环节、使得设备归属关系可追溯、还可使物联网设备更加安全地运输和分发。通过采用本申请提供的所述方法，可以确保物联网设备的合法性与安全性。本申请实施例还提供了一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现前述任一实施例方法的步骤。其中，计算机可读存储介质可以包括但不限于任何类型的盘，包括软盘、光盘、DVD、CD-ROM、微型驱动器以及磁光盘、ROM、RAM、EPROM、EEPROM、DRAM、VRAM、闪速存储器设备、磁卡或光卡、纳米装置，或适合于存储指令和/或数据的任何类型的媒介或设备。本申请实施例还提供了一种物联网设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，处理器执行程序时实现上述任一实施例方法的步骤。本申请实施例提供了一种物联网设备包括：处理器和存储器。本申请实施例中，处理器为计算机装置的控制中心，可以是实体机的处理器，也可以是虚拟机的处理器。处理器可以包括一个或多个处理核心，比如4核心处理器、8核心处理器等。处理器可以采用DSP、FPGA、PLA中的至少一种硬件形式来实现。处理器也可以包括主处理器和协处理器，主处理器是用于对在唤醒状态下的数据进行处理的处理器，也称CPU；协处理器是用于对在待机状态下的数据进行处理的低功耗处理器。存储器可以包括一个或多个计算机可读存储介质，该计算机可读存储介质可以是非暂态的。存储器还可包括高速随机存取存储器，以及非易失性存储器，比如一个或多个磁盘存储设备、闪存存储设备。在本申请的一些实施例中，存储器中的非暂态的计算机可读存储介质用于存储至少一个指令，该至少一个指令用于被处理器所执行以实现本申请实施例中的方法。一些实施例中，物联网设备还包括有：外围设备接口和至少一个外围设备。处理器、存储器和外围设备接口之间可以通过总线或信号线相连。各个外围设备可以通过总线、信号线或电路板与外围设备接口相连。具体地，外围设备包括：显示屏、摄像头和音频电路中的至少一种。外围设备接口可被用于将I/O相关的至少一个外围设备连接到处理器和存储器。在本申请的一些实施例中，处理器、存储器和外围设备接口被集成在同一芯片或电路板上；在本申请的一些其他实施例中，处理器、存储器和外围设备接口中的任意一个或两个可以在单独的芯片或电路板上实现。本申请实施例对此不作具体限定。显示屏用于显示UI。该UI可以包括图形、文本、图标、视频及其它们的任意组合。当显示屏是触摸显示屏时，显示屏还具有采集在显示屏的表面或表面上方的触摸信号的能力。该触摸信号可以作为控制信号输入至处理器进行处理。此时，显示屏还可以用于提供虚拟按钮和/或虚拟键盘，也称软按钮和/或软键盘。在本申请的一些实施例中，显示屏可以为一个，设置于物联网设备的前面板；在本申请的另一些实施例中，显示屏可以为至少两个，分别设置在物联网设备的不同表面；在本申请的再一些实施例中，显示屏可以是柔性显示屏，设置在物联网设备的弯曲表面上。甚至，显示屏还可以设置成非矩形的不规则图形，也即异形屏。显示屏可以采用LCD、OLED等材质制备。音频电路可以包括麦克风和扬声器。麦克风用于采集用户及环境的声波，并将声波转换为电信号输入至处理器进行处理。出于立体声采集或降噪的目的，麦克风可以为多个，分别设置在物联网设备的不同部位。麦克风还可以是阵列麦克风或全向采集型麦克风。电源用于为物联网设备中的各个组件进行供电。电源可以是交流电、直流电、一次性电池或可充电电池。当电源包括可充电电池时，该可充电电池可以是有线充电电池或无线充电电池。有线充电电池是通过有线线路充电的电池，无线充电电池是通过无线线圈充电的电池。该可充电电池还可以用于支持快充技术。本申请实施例中示出的客户端结构框图并不构成对物联网设备的限定，物联网设备可以包括比图示更多或更少的组件，或者组合某些组件，或者采用不同的组件布置。在本申请中，术语“第一”、“第二”等仅用于描述的目的，而不能理解为指示或暗示相对重要性或顺序；术语“多个”则指两个或两个以上，除非另有明确的限定。术语“安装”、“相连”、“连接”、“固定”等术语均应做广义理解，例如，“连接”可以是固定连接，也可以是可拆卸连接，或一体地连接；“相连”可以是直接相连，也可以通过中间媒介间接相连。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本申请中的具体含义。本申请的描述中，需要理解的是，术语“上”、“下”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本申请和简化描述，而不是指示或暗示所指的装置或单元必须具有特定的方向、以特定的方位构造和操作，因此，不能理解为对本申请的限制。以上所述，仅为本申请的具体实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本申请的保护范围之内。因此，依本申请权利要求所作的等同变化，仍属本申请所涵盖的范围。
