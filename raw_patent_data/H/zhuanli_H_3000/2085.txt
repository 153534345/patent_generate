标题title
自适应设备安全风险评估方法、装置、设备及系统
摘要abst
本申请提供一种自适应设备安全风险评估方法、装置、设备及系统，该方法包括：接收安全风险评估任务；确定与安全风险评估任务匹配的目标中继模块；与目标中继模块建立通信连接，并将目标地址发送给目标中继模块，以使目标中继模块依据目标地址，与被测目标建立通信连接，并将被测目标的监听端口信息发送给中心平台；在监听到安全评估扫描请求的情况下，依据被测目标的监听端口信息，通过目标中继模块，将安全评估扫描请求转发至被测目标的监听端口，并接收被测目标通过目标中继模块返回的扫描结果数据；依据获取到的扫描结果数据，确定安全风险评估结果。该方法可以简化跨网络、网段、隔离设备场景下的设备风险安全评估的实现。
权利要求书clms
1.一种自适应设备安全风险评估方法，其特征在于，应用于中心平台，所述方法包括：接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块，以使所述目标中继模块依据所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口，并接收所述被测目标通过所述目标中继模块返回的扫描结果数据；依据获取到的扫描结果数据，确定安全风险评估结果。2.根据权利要求1所述的方法，其特征在于，所述安全风险评估任务还包括目标中继模块的标识信息；所述确定与所述安全风险评估任务匹配的目标中继模块，包括：依据所述目标中继模块的标识信息，确定与所述安全风险评估任务匹配的目标中继模块。3.根据权利要求1所述的方法，其特征在于，所述安全风险评估任务还包括自动寻找模式选择指令；所述确定与所述安全风险评估任务匹配的目标中继模块，包括：依据所述安全风险评估任务包括的目标地址和中继模式，轮询该中继模式的全部中继模块对所述目标地址的连通性，得到该中继模式各中继模块对所述目标地址的连通时间；其中，所述连通时间包括连接超时或连接成功情况下使用的时间；将该中继模式的各中继模块中，对被测目标连通成功，且连通时间最短的中继模块，确定为所述目标中继模块。4.根据权利要求1所述的方法，其特征在于，在所述中心平台与所述目标地址之间存在网络隔离，或，所述中心平台与所述目标地址之间处于不同网络制式，所述中继模式包括代理中继模式；在所述中心平台与所述目标地址之间处于不同网络制式的情况下，所述目标中继模块分别接入所述中心平台所处网络和所述目标地址所处网络；在所述中心平台与所述目标地址之间存在网络隔离的情况下，所述目标中继模块运行在隔离设备上。5.根据权利要求1所述的方法，其特征在于，在被测目标不对外部开放访问的情况下，所述中继模块的模式包括注入模式；所述目标中继模块运行在所述被测目标所在的被测设备上。6.根据权利要求5所述的方法，其特征在于，所述安全风险评估任务还包括安全外壳SSH登录凭证信息；所述方法还包括：在所述中心平台与所述目标地址之间存在网络隔离，或，所述中心平台与所述目标地址之间处于不同网络制式的情况下，通过代理中继模式的中继模块，依据所述SSH登录凭证信息以及所述目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块；否则，依据所述SSH登录凭证信息以及所述目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块。7.一种自适应设备安全风险评估装置，其特征在于，部署于中心平台，所述装置包括：第一通信单元，用于接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；确定单元，用于确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；第二通信单元，用于与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块，以使所述目标中继模块依据所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；所述第二通信单元，还用于在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口，并接收所述被测目标通过所述目标中继模块返回的扫描结果数据；评估单元，用于依据获取到的扫描结果数据，确定安全风险评估结果。8.根据权利要求7所述的装置，其特征在于，所述安全风险评估任务还包括目标中继模块的标识信息；所述确定单元确定与所述安全风险评估任务匹配的目标中继模块，包括：依据所述目标中继模块的标识信息，确定与所述安全风险评估任务匹配的目标中继模块；或，所述安全风险评估任务还包括自动寻找模式选择指令；所述确定单元确定与所述安全风险评估任务匹配的目标中继模块，包括：依据所述安全风险评估任务包括的目标地址和中继模式，轮询该中继模式的全部中继模块对所述目标地址的连通性，得到该中继模式各中继模块对所述目标地址的连通时间；其中，所述连通时间包括连接超时或连接成功情况下使用的时间；将该中继模式的各中继模块中，对被测目标连通成功，且连通时间最短的中继模块，确定为所述目标中继模块；和/或，在所述中心平台与所述目标地址之间存在网络隔离，或，所述中心平台与所述目标地址之间处于不同网络制式，所述中继模式包括代理中继模式；在所述中心平台与所述目标地址之间处于不同网络制式的情况下，所述目标中继模块分别接入所述中心平台所处网络和所述目标地址所处网络；在所述中心平台与所述目标地址之间存在网络隔离的情况下，所述目标中继模块运行在隔离设备上；和/或，在被测目标不对外部开放访问的情况下，所述中继模块的模式包括注入模式；所述目标中继模块运行在所述被测目标所在的被测设备上；其中，所述安全风险评估任务还包括安全外壳SSH登录凭证信息；所述装置还包括：注入单元，用于在所述中心平台与所述目标地址之间存在网络隔离，或，所述中心平台与所述目标地址之间处于不同网络制式的情况下，通过代理中继模式的中继模块，依据所述SSH登录凭证信息以及所述目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块；否则，依据所述SSH登录凭证信息以及所述目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块。9.一种电子设备，其特征在于，包括处理器和存储器，其中，存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现权利要求1~6任一项所述的方法。10.一种自适应设备安全风险评估系统，其特征在于，包括：中心平台、中继模块，以及，被测目标；其中：所述中心平台，用于接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；所述中心平台，还用于确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；所述中心平台，还用于与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块；所述中继模块，用于在作为目标中继模块的情况下，依据接收到的所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；所述中心平台，还用于在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口；所述被测目标，用于依据接收到的所述安全评估扫描请求进行安全评估扫描，并通过所述目标中继模块向所述中心平台返回扫描结果数据；所述中心平台，还用于依据获取到的扫描结果数据，确定安全风险评估结果。
说明书desc
技术领域本申请涉及信息安全技术领域，尤其涉及一种自适应设备安全风险评估方法、装置、设备及系统。背景技术设备安全风险评估是指系统地评估设备所面临的安全风险，如存在的安全风险等，通常需要借助专门的安全评估扫描程序，如安全风险扫描程序。被测设备需测试的组件、模块、接口以不同形式运行在设备上，设备存在网络隔离或处于不同制式的通信网络的情况，导致测试设备安全情况需要分别适配对应的通信模式，在编写安全评估扫描程序时需重复实现相似逻辑，以处理设备被测试部分的通信问题。发明内容有鉴于此，本申请提供一种自适应设备安全风险评估方法、装置、设备及系统。具体地，本申请是通过如下技术方案实现的：根据本申请实施例的第一方面，提供一种自适应设备安全风险评估方法，包括：接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块，以使所述目标中继模块依据所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口，并接收所述被测目标通过所述目标中继模块返回的扫描结果数据；依据获取到的扫描结果数据，确定安全风险评估结果。根据本申请实施例的第二方面，提供一种自适应设备安全风险评估装置，部署于中心平台，所述装置包括：第一通信单元，用于接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；确定单元，用于确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；第二通信单元，用于与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块，以使所述目标中继模块依据所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；所述第二通信单元，还用于在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口，并接收所述被测目标通过所述目标中继模块返回的扫描结果数据；评估单元，用于依据获取到的扫描结果数据，确定安全风险评估结果。根据本申请实施例的第三方面，提供一种电子设备，包括处理器和存储器，其中，存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现第一方面提供的方法。根据本申请实施例的第四方面，提供一种自适应设备安全风险评估系统，包括：中心平台、中继模块，以及，被测目标；其中：所述中心平台，用于接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；所述中心平台，还用于确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；所述中心平台，还用于与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块；所述中继模块，用于在作为目标中继模块的情况下，依据接收到的所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；所述中心平台，还用于在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口；所述被测目标，用于依据接收到的所述安全评估扫描请求进行安全评估扫描，并通过所述目标中继模块向所述中心平台返回扫描结果数据；所述中心平台，还用于依据获取到的扫描结果数据，确定安全风险评估结果。本申请实施例的自适应设备安全风险评估方法，通过设置多种不同模式的中继模块，用户在提交安全风险评估任务的情况下，可以在安全风险评估任务的任务参数中携带目标地址以及中继模式等信息，以便中心平台自适应地确定与安全风险评估任务匹配的目标中继模块，中心平台可以与目标中继模块建立通信连接，并将目标地址发送给目标中继模块，以使目标中继模块依据目标地址，与被测目标建立通信连接，并将被测目标的监听端口信息发送给中心平台，进而，在监听到安全评估扫描请求的情况下，依据被测目标的监听端口信息，通过目标中继模块，将安全评估扫描请求转发至被测目标的监听端口，并接收被测目标通过目标中继模块返回的扫描结果数据，依据获取到的扫描结果数据，确定安全风险评估结果，基于中继模块，使用相对统一的方式进行设备端连接管理，统一处理网络链路通信，解决跨网络、网段、隔离设备连接的问题，简化了跨网络、网段、隔离设备场景下的设备风险安全评估的实现。附图说明图1为本申请一示例性实施例示出的一种自适应设备安全风险评估方法的流程示意图；图2A和图2B为本申请一示例性实施例示出的一种自适应设备安全风险评估系统的框架图；图3为本申请一示例性实施例示出的一种自适应设备安全风险评估装置的结构示意图；图4为本申请一示例性实施例示出的一种自适应设备安全风险评估装置的结构示意图；图5为本申请一示例性实施例示出的一种电子设备的硬件结构示意图；图6为本申请一示例性实施例示出的一种自适应设备安全风险评估系统的结构示意图。具体实施方式这里将详细地对示例性实施例进行说明，其示例表示在附图中。下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。以下示例性实施例中所描述的实施方式并不代表与本申请相一致的所有实施方式。相反，它们仅是与如所附权利要求书中所详述的、本申请的一些方面相一致的装置和方法的例子。在本申请使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本申请。在本申请和所附权利要求书中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义。为了使本领域技术人员更好地理解本申请实施例提供的技术方案，并使本申请实施例的上述目的、特征和优点能够更加明显易懂，下面结合附图对本申请实施例中技术方案作进一步详细的说明。需要说明的是，本申请实施例中各步骤的序号大小并不意味着执行顺序的先后，各过程的执行顺序应以其功能和内在逻辑确定，而不应对本申请实施例的实施过程构成任何限定。请参见图1，为本申请实施例提供的一种自适应设备安全风险评估方法的流程示意图，其中，该方法可以应用于中心平台，如图1所示，该自适应设备安全风险评估方法可以包括以下步骤：步骤S100、接收安全风险评估任务；其中，该安全风险评估任务包括目标地址、中继模式。本申请实施例中，用户可以创建安全风险评估任务，并提交任务参数。示例性的，该任务参数可以包括但不限于目标地址、中继模式等。示例性的，被测目标可以包括但不限于被测设备上的组件、模块以及接口等中的一个或多个。示例性的，中继模式可以包括但不限于直连模式、中继模式或注入模式。在中心平台与被测目标之间存在网络隔离，或，中心平台与被测目标处于不同制式的通信网络情况下，可以通过代理中继模式的中继模块分别连接中心平台与被测目标，以实现中心平台与被测目标之间的通信连接。示例性的，网络隔离可以包括使用特定设备造成相同制式的网络无法直接通讯。例如，使用防火墙拦截某公司内网和互联网的通讯。在被测目标不对外部开放访问，即需要从设备内部访问的情况下，可以通过注入模式的中继模块运行在被测目标所在被测设备上，中心平台可以通过该注入模式的中继模块，实现对被测目标的访问。步骤S110、确定与安全风险评估任务匹配的目标中继模块；其中，目标中继模块的模式与安全风险评估任务中包括的中继模式一致。本申请实施例中，在接收到安全风险评估任务的情况下，可以确定与安全风险评估任务匹配的中继模块。示例性的，目标中继模块的中继模式与安全风险评估任务中包括的中继模式一致。例如，在安全风险评估任务中包括的中继模式为代理中继模式的情况下，目标中继模块为代理中继模块；在安全风险评估任务中包括的中继模式为注入模式的情况下，目标中继模块为注入模块。步骤S120、与目标中继模块建立通信连接，并将目标地址发送给目标中继模块，以使目标中继模块依据目标地址，与被测目标建立通信连接，并将被测目标的监听端口信息发送给中心平台。本申请实施例中，中心平台可以与目标中继模块建立通信连接，并将目标地址发送给目标中继模块。目标中继模块可以依据目标地址与被测目标建立通信连接，并将被测目标的监听端口信息发送给中心平台。步骤S130、在监听到安全评估扫描请求的情况下，依据被测目标的监听端口信息，通过目标中继模块，将安全评估扫描请求转发至被测目标的监听端口，并接收被测目标通过目标中继模块返回的扫描结果数据。本申请实施例中，中心平台在监听到安全评估扫描请求的情况下，可以依据被测目标的监听端口信息，通过目标中继模块，将安全评估扫描请求重定向至被测目标的监听端口。被测目标监听到安全评估扫描请求的情况下，可以执行安全评估扫描操作，得到扫描结果数据，并通过目标中继模块将扫描结果数据返回给中心平台。步骤S140、依据获取到的扫描结果数据，确定安全风险评估结果。本申请实施例中，中心平台可以依据获取到的扫描结果数据，确定安全风险评估结果。可见，在图1所示方法流程中，通过设置多种不同模式的中继模块，用户在提交安全风险评估任务的情况下，可以在安全风险评估任务的任务参数中携带目标地址以及中继模式等信息，以便中心平台确定与安全风险评估任务匹配的目标中继模块，中心平台可以与目标中继模块建立通信连接，并将目标地址发送给目标中继模块，以使目标中继模块依据目标地址，与被测目标建立通信连接，并将被测目标的监听端口信息发送给中心平台，进而，在监听到安全评估扫描请求的情况下，依据被测目标的监听端口信息，通过目标中继模块，将安全评估扫描请求转发至被测目标的监听端口，并接收被测目标通过目标中继模块返回的扫描结果数据，依据获取到的扫描结果数据，确定安全风险评估结果，基于中继模块，使用相对统一的方式进行设备端连接管理，统一处理网络链路通信，解决跨网络、网段、隔离设备连接的问题，简化了跨网络、网段、隔离设备场景下的设备风险安全评估的实现。在一些实施例中，安全风险评估任务还可以包括目标中继模块的标识信息；上述确定与安全风险评估任务匹配的目标中继模块，可以包括：依据目标中继模块的标识信息，确定与安全风险评估任务匹配的目标中继模块。示例性的，为了提高通信连接效率，用户在创建安全风险评估任务的情况下，还可以指定使用的目标中继模块。相应地，在提交的任务参数中还可以包括目标中继模块的标识信息，如目标中继模块id。中心平台可以依据目标中继模块id，确定与安全风险评估任务匹配的目标中继模块。在另一些实施例中，安全风险评估任务还可以包括自动寻找模式选择指令；上述确定与安全风险评估任务匹配的目标中继模块，可以包括：依据安全风险评估任务包括的目标地址和中继模式，轮询该中继模式的全部中继模块对目标地址的连通性，得到该中继模式各中继模块对目标地址的连通时间；其中，连通时间包括连接超时或连接成功情况下使用的时间；将该中继模式各中继模块中，对被测目标连通成功，且连通时间最短的中继模块，确定为目标中继模块。示例性的，为了降低安全风险评估任务创建难度，对于目标中继模块的确定，可以选择自动寻找模式。相应地，在提交的任务参数中还可以包括自动寻找模式选择指令，在该情况下，中心平台可以依据安全风险评估任务包括的目标地址和中继模式，轮询该中继模式的全部中继模块对目标地址的连通性，得到该中继模式各中继模块对目标地址的连通时间；其中，连通时间包括连接超时或连接成功情况下使用的时间。在确定了该中继模式的各中继模块对目标地址的连通时间的情况下，可以将该中继模式的各中继模块中，对被测目标连通成功，且连通时间最短的中继模块，确定为目标中继模块。在一些实施例中，在中心平台与目标地址之间存在网络隔离，或，中心平台与目标地址之间处于不同网络制式的情况下，安全风险评估任务中包括的中继模式包括代理中继模式；在中心平台与目标地址之间处于不同网络制式的情况下，目标中继模块实例分别接入中心平台所处网络和目标地址所处网络；在中心平台与目标地址之间存在网络隔离的情况下，目标中继模块实例运行在隔离设备上。示例性的，对于中心平台与目标地址之间存在网络隔离或中心平台与目标地址之间处于不同网络制式的场景，可以通过代理中继模式的中继模块实现中心平台与目标地址之间的通信连接。示例性的，在中心平台与目标地址之间处于不同网络制式的情况下，目标中继模块实例需要能够连接到中心平台所处网络，且需要能够连接到目标地址所处网络。例如，假设被测试对象是一运行在嵌入式设备的Web站点，该站点只能通过接入该设备自己建立开设的Wi-Fi热点AP才能访问，无法通过一般的有线网络进行访问，则可以通过代理中继模块，同时接入以太网和使用Wi-Fi连接设备热点，完成连通该嵌入式设备的web站点，实现将测试数据从中心平台发送到该嵌入式设备Web站点。示例性的，在中心平台与目标地址之间存在网络隔离的情况下，目标中继模块实例需要运行在隔离设备上，以便中心平台可以通过隔离设备上运行的目标中继模块，实现对被测目标的访问。例如，被测目标是使用有线加密通信的专网设备的Web站点，在经过预先指定插有U盾的PC主机上才能访问，则可以通过代理中继模块，运行在插入U盾的PC主机，对下发的安全评估扫描请求转发给被测目标，以完成安全风险评估要求，得到对应安全风险评估结果。在一些实施例中，在被测目标不对外部开放访问的情况下，中继模块的模式包括注入模式；所述目标中继模块运行在所述被测目标所在的被测设备上。示例性的，对于被测目标不对外部开放的场景，即被测目标需要在被测目标所在被测设备内部访问，中继模块的中继模式可以包括注入模式，即将目标中继模块注入到被测目标所在被测设备，在该被测设备上运行目标中继模块。相应地，中心平台可以通过连接目标中继模块，实现对被测目标的访问。举例来说，假设被测目标为运行在设备内部本地127.0.0.1上的TCP服务程序，设备通过有线以太网连接局域网，但无法从网络外部直接访问设备内部TCP服务。则可以通过将注入模块注入被测目标所在被测设备，通过注入模块将从中心平台下发的安全评估扫描请求发送到被测设备内执行，不需对被测设备进行参数修改。示例性的，注入模块的程序退出后被测设备配置保持不变。在一个示例中，安全风险评估任务还包括SSH登录凭证信息；本申请实施例提供的自适应设备安全风险评估方案还可以包括：在中心平台与目标地址之间存在网络隔离，或，中心平台与目标地址之间处于不同网络制式的情况下，通过中继模式的中继模块，依据SSH登录凭证信息以及目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块；否则，依据SSH登录凭证信息以及目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块。示例性的，考虑到在被测目标不对外部开放访问的情况下，中心平台与目标地址之间也可能存在网络隔离，或，中心平台与目标地址之间处于不同网络制式，因而，中心平台需要通过代理中继模式的中继模块才能与目标地址建立通信连接。在该情况下，中心平台可以通过代理中继模块，依据SSH登录凭证信息以及目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块。示例性的，中心平台可以轮询代理中继模块，进行SSH命令执行，尝试向被测目标所在被测设备，使用SSH通道载入模块程序并启动注入程序，以便在被测设备上运行注入模块。在中心平台不需要通过代理中继模块与目标地址建立通信连接的情况，中心平台可以依据SSH登录凭证信息以及目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块。可见，在本申请实施例中，通过注入模块实现对被测设备内部服务无影响进行检测，与传统方案中对被测设备进行配置参数修改的实现方案相比，注入模块的使用可以减少用户人工操作修改配置参数，将被测设备内部服务开放到外部进行检测评估，扩大覆盖检测面，提升软件质量。为了使本领域技术人员更好地理解本申请实施例提供的技术方案，下面结合具体场景对本申请实施例提供的技术方案进行说明。如图2A和图2B所示，为本申请实施例提供的自适应设备安全风险评估系统的框架图，该框架可以包括中心平台、直连模块、代理中继模块、注入模块，以及，扫描程序。下面分别对各部分的功能进行简单说明。一、中心平台1.1、中心平台负责处理安全风险评估通讯任务，向外提供HTTP接口调用执行安全风险评估任务，接受第三方扫描评估程序传递的扫描请求。1.2、中心平台负责调度和控制测试过程；负责控制其他模块发送或转发第三方扫描评估程序的扫描请求、扫描结果数据等；中心平台运行在局域网的服务器，通过高速以太网接入网络。示例性的，中心平台运行在的服务器通常配置和性能均较优，例如，通常具备处理能力强、内存和存储容量大，以及，支持高速网络连接等特点。1.2.1、用户接口：提供用户访问提交创建安全风险评估任务；1.2.2、内部数据通信：使用HTTP + WebSocket进行模块内部数据交换，中继模块向中心平台使用HTTP请求注册后，后续通过Websocket传递流式数据和连续数据请求和载荷。示例性的，Websocket是HTTP的升级形式，可以实时感知Websocket连接变化，数据上下行，故可以实时确定中继模块的在线情况。其他模块通过主动发起HTTP请求连接中心平台，完成模块注册和连接链路建立。当其他模块注册完成开始中继后，中心平台提供开放监听的TCP/UDP端口提供对被测目标的访问，外部扫描程序、测试人员通过中心平台开放的端口访问被测目标。1.2.3、使用可用控制通道在适合的设备端部署、启动模块{支持中继模块：代理中继模块，注入模块}，向中继模块下发命令，如文件命令。需要说明的是，直连模块默认立即可用，其作用为对中心平台与被测目标之间进行数据透传，等价于从中心平台直接连接被测目标，故不需要配置，不需要额外启动。二、直连模块直连模块通过以太网连接被测试设备，发送TCP/UDP测试请求，获取测试结果。三、代理中继模块代理中继模块扩展了直连模块的能力，运行在同时可以访问被测设备和中心平台的边界网络设备，如支持有线以太网和Wi-Fi、蓝牙带有USB接口的笔记本电脑，负责转发测试任务请求到被测目标，获取测试结果。代理中继模块程序经过其他控制通道运行，如：3.1.1、SSH通过中心平台自动使用配置正确的设备账号载入中继边界网络设备运行；3.1.2、通过人工手动载入设备运行。代理中继模块支持的工作模式：3.2.1、代理中继模块支持中继转发中心平台接口，提供对中心平台接口的中继能力；3.2.2、代理中继模块执行中心平台下发的命令并返回执行结果；3.2.3、执行文件传输，上传下载文件；3.2.4、代理中继模块支持通过【局域网、COM串口、USB、Wi-Fi、蓝牙】连接被测目标建立通信，向被测目标转发测试请求数据，获取测试结果，具体支持情况如下：3.2.4.1、设备端连接方式1：局域网、Wi-Fi，支持测试TCP、UDP接口的被测目标；3.2.4.2、设备端连接方式2：COM串口、USB、蓝牙，硬件设备的文件描述符以，write）形式接口的被测目标，由代理中继模块所运行在的上位机打开注册在上位机中的设备文件描述符字节流，将字节流转换到网络通讯过程，通过代理中继模块中继到中心平台。示例性的，对于需要通过COM串口、USB、蓝牙等通信方式连接的被测目标，代理中继模块需要运行在支持COM串口、USB、蓝牙通信的主机上。其它情况下，代理中继模块可以运行在普通的主机上。四、注入模块注入模块程序经过其他控制通道运行，如：4.1.1、SSH通过中心平台自动使用配置正确的设备账号载入被测目标所在被测设备运行；4.1.2、通过人工手动载入被测目标所在被测设备运行。注入模块运行在被测设备内，得以访问设备内部资源、接口、文件等全部数据、进程，可以对仅开放在设备内部的服务接口进行测试，执行测试代码和测试功能。注入模块通过直连中心平台或通过代理中继模块的中继转发建立有效连接进行通信，向被测目标转发测试请求数据，以获取测试结果，读取测试结果。注入模块支持的工作模式：4.2.1、转发设备内部服务程序所监听的TCP、UDP端口；4.2.2、转发设备内部Unix套接字数据；4.2.3、执行中心平台下发的命令并返回执行结果；4.2.4、执行文件传输，上传下载文件。五、扫描程序扫描程序可以泛指对某个端口上运行的服务具有安全风险扫描能力的程序，通过HTTP接口调用安全风险扫描服务的方式进行集成。示例性的，扫描程序可以包括但不限于：商业扫描工具或内部研发的安全风险扫描程序。通过调用扫描程序，对开放在主平台的对应端口即对其开放服务进行扫描，完成对被测目标的安全风险评估。基于上述框架，自适应设备安全风险评估实现流程可以如下：6.1、用户创建安全评估任务，提交任务参数；示例性的，任务参数可以包括但不限于目标地址、中继模式、从可选安全风险扫描服务中选择评估扫描程序和执行顺序、指配的中继节点或选择自动寻找模式、SSH登录凭证等参数中的部分或全部。6.2、中心平台执行任务有效性检测。示例性的，可以检测扫描程序有效参数、中继模块在线情况、被测目标的可连接情况等，并根据需要选择有效的中继模块，或尝试寻找自动有效的中继模块，得到连接使用的中继模块id。需要说明的是，在不满足有可连接中继模块，即被测目标在各中继模块都无法访问的情况下，任务将返回失败。6.2.1、中继模块选择：6.2.1.1、用户指配：使用某一个中继模块进行通信转发；6.2.1.2、自动寻找模式：中心平台轮询指定模式的全部可用中继模块对被测目标的连通性，得到连接目标地址的耗时时间的结果的一个数组，选择连接成功使用的时间最小值对应中继模块作为后续选择的中继模块，后续由该中继模块进行中继转发通信。示例性的，对于注入模块，在用户选择注入模式的中继模块的情况下，中心平台可以通过直连或轮询代理中继模块进行SSH命令执行，尝试向被测设备所在被测设备，使用SSH通道载入模块程序并启动注入模块在被测设备上的运行，并测试目标的连通时间；在注入模块启动运行的情况下，将向SSH命令执行方的注册端口发起注册并上线；6.3、中心平台启动连接过程，通过目标中继模块id连接目标中继模块，目标中继模块依据目标地址连接被测目标，将被测目标的监听端口信息转发到中心平台提供转发的监听端口，完成建立中心平台端口到目标设备对应服务端口的通信链路。6.4、中心平台按照用户指定的顺序启动安全风险评估扫描程序，将扫描请求转发到对应服务的监听端口，安全风险评估扫描程序执行对被测目标的检测并得出评估结果。为了使本领域技术人员更好地理解本申请提供的技术方案的技术效果，下面结合具体场景对本申请实施例提供的技术方案的技术效果进行说明。场景1、被测试对象是一运行在嵌入式设备的Web站点，该站点只能通过接入该设备自己建立开设的Wi-Fi热点AP才能访问，无法通过一般的有线网络进行访问。针对该场景，传统方案在编写测试程序时需重复实现相似逻辑处理设备被测试部分的通信问题。而通过本申请实施例提供的代理中继模块，可以同时接入以太网和使用Wi-Fi连接设备热点，完成连通该嵌入式设备的web站点，实现将测试数据从中心平台发送到该嵌入式设备Web站点。场景2、被测目标是使用有线加密通信的专网设备的Web站点，在经过预先指定插有U盾的PC主机上才能访问。针对该场景，传统方案需要为每个扫描程序配置U盾进行访问。而通过本申请实施例提供的代理中继模块，通过将代理中继模块运行在插入U盾的PC主机，对下发的安全评估扫描请求转发给被测目标，以完成安全风险评估要求，得到对应安全风险评估结果。场景3、假设被测目标为运行在设备内部本地127.0.0.1上的TCP服务程序，设备通过有线以太网连接局域网，但无法从网络外部直接访问设备内部TCP服务。针对该场景，传统方案要修改配置参数到设备的全局可访问地址，或额外增加端口开放程序，即需要手工对设备执行修改，并在测试结束后要修改回原有配置。而通过本申请实施例提供的注入模块，通过将注入模块注入被测目标所在被测设备，通过注入模块将从中心平台下发的安全评估扫描请求发送到被测设备内执行，不需对被测设备进行参数修改。其中，注入模块的程序退出后被测设备配置保持不变。可见，在本申请实施例提供的自适应设备安全风险评估方案中，基于中继模块，使用相对统一的方式进行设备端连接管理，统一处理网络链路通信，解决跨网络、网段、隔离设备连接的问题，简化了跨网络、网段、隔离设备场景下的设备风险安全评估的实现；此外，通过注入模块实现对被测设备内部服务无影响进行检测，与传统方案中对被测设备进行配置参数修改的实现方案相比，注入模块的使用可以减少用户人工操作修改配置参数，将被测设备内部服务开放到外部进行检测评估，扩大覆盖检测面，提升软件质量。以上对本申请提供的方法进行了描述。下面对本申请提供的装置进行描述：请参见图3，为本申请实施例提供的一种自适应设备安全风险评估装置的结构示意图，其中，该自适应设备安全风险评估装置可以部署于中心平台，如图3所示，该自适应设备安全风险评估装置可以包括：第一通信单元310，用于接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；确定单元320，用于确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；第二通信单元330，用于与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块，以使所述目标中继模块依据所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；所述第二通信单元330，还用于在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口，并接收所述被测目标通过所述目标中继模块返回的扫描结果数据；评估单元340，用于依据获取到的扫描结果数据，确定安全风险评估结果。在一些实施例中，所述安全风险评估任务还包括目标中继模块的标识信息；所述确定单元320确定与所述安全风险评估任务匹配的目标中继模块，包括：依据所述目标中继模块的标识信息，确定与所述安全风险评估任务匹配的目标中继模块。在一些实施例中，所述安全风险评估任务还包括自动寻找模式选择指令；所述确定单元320确定与所述安全风险评估任务匹配的目标中继模块，包括：依据所述安全风险评估任务包括的目标地址和中继模式，轮询该中继模式的全部中继模块对所述目标地址的连通性，得到该中继模式各中继模块对所述目标地址的连通时间；其中，所述连通时间包括连接超时或连接成功情况下使用的时间；将该中继模式的各中继模块中，对被测目标连通成功，且连通时间最短的中继模块，确定为所述目标中继模块。在一些实施例中，在所述中心平台与所述目标地址之间存在网络隔离，或，所述中心平台与所述目标地址之间处于不同网络制式，所述中继模式包括代理中继模式；在所述中心平台与所述目标地址之间处于不同网络制式的情况下，所述目标中继模块分别接入所述中心平台所处网络和所述目标地址所处网络；在所述中心平台与所述目标地址之间存在网络隔离的情况下，所述目标中继模块运行在隔离设备上。在一些实施例中，在被测目标不对外部开放访问的情况下，所述中继模块的模式包括注入模式；所述目标中继模块运行在所述被测目标所在的被测设备上。在一些实施例中，所述安全风险评估任务还包括安全外壳SSH登录凭证信息。如图4所示，所述自适应设备安全风险评估装置还可以包括：注入单元350，用于在所述中心平台与所述目标地址之间存在网络隔离，或，所述中心平台与所述目标地址之间处于不同网络制式的情况下，通过代理中继模式的中继模块，依据所述SSH登录凭证信息以及所述目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块；否则，依据所述SSH登录凭证信息以及所述目标地址，使用SSH通道在被测目标所在被测设备上运行注入模块。本申请实施例还提供一种电子设备，包括处理器和存储器，其中，存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现上文描述的自适应设备安全风险评估方法。请参见图5，为本申请实施例提供的一种电子设备的硬件结构示意图。该电子设备可包括处理器501、存储有机器可执行指令的存储器502。处理器501与存储器502可经由系统总线503通信。并且，通过读取并执行存储器502中与自适应设备安全风险评估逻辑对应的机器可执行指令，处理器501可执行上文描述的自适应设备安全风险评估方法。本文中提到的存储器502可以是任何电子、磁性、光学或其它物理存储装置，可以包含或存储信息，如可执行指令、数据，等等。例如，机器可读存储介质可以是：RAM、易失存储器、非易失性存储器、闪存、存储驱动器、固态硬盘、任何类型的存储盘，或者类似的存储介质，或者它们的组合。在一些实施例中，还提供了一种机器可读存储介质，如图5中的存储器502，该机器可读存储介质内存储有机器可执行指令，所述机器可执行指令被处理器执行时实现上文描述的自适应设备安全风险评估方法。例如，所述机器可读存储介质可以是ROM、RAM、CD-ROM、磁带、软盘和光数据存储设备等。本申请实施例还提供了一种计算机程序产品，存储有计算机程序，并且当处理器执行该计算机程序时，促使处理器执行上文中描述的自适应设备安全风险评估方法。请参见图6，为本申请实施例提供的一种自适应设备安全风险评估系统的结构示意图，如图6所示，该自适应设备安全风险评估系统可以包括：中心平台、中继模块，以及，被测目标；其中：所述中心平台，用于接收安全风险评估任务；其中，所述安全风险评估任务包括目标地址、中继模式；所述中心平台，还用于确定与所述安全风险评估任务匹配的目标中继模块；其中，所述目标中继模块的模式与所述安全风险评估任务中包括的中继模式一致；所述中心平台，还用于与所述目标中继模块建立通信连接，并将所述目标地址发送给所述目标中继模块；所述中继模块，用于在作为目标中继模块的情况下，依据接收到的所述目标地址，与被测目标建立通信连接，并将所述被测目标的监听端口信息发送给所述中心平台；所述中心平台，还用于在监听到安全评估扫描请求的情况下，依据所述被测目标的监听端口信息，通过所述目标中继模块，将所述安全评估扫描请求转发至所述被测目标的监听端口；所述被测目标，用于依据接收到的所述安全评估扫描请求进行安全评估扫描，并通过所述目标中继模块向所述中心平台返回扫描结果数据；所述中心平台，还用于依据获取到的扫描结果数据，确定安全风险评估结果。示例性的，自适应设备安全风险评估系统中的中心平台、中继模块以及被测目标可以按照上述方法实施例中描述的方式实现自适应设备安全风险评估。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。以上所述仅为本申请的较佳实施例而已，并不用以限制本申请，凡在本申请的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本申请保护的范围之内。
