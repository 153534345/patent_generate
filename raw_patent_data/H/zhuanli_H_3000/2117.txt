标题title
一种PCB贴片机的精密贴装控制方法及装置
摘要abst
本发明公开一种PCB贴片机的精密贴装控制方法及装置，该方法在吸嘴带动工件以第一速度下降过程中，检测到吸嘴到达预设位置时，将下降速度调整为第二速度；其中，第二速度小于第一速度，吸嘴由第一电机驱动实现升降；在吸嘴带动工件以第二速度继续下降过程中，检测到第一电机的电流变化值超出预设电流范围时，向第一电机发出电机停止指令；其中，电机停止指令用于控制所述第一电机的转子停止转动。本发明利用半固体锡膏对下降中的芯片提供缓冲，并通过软件控制芯片或元件在半固体锡膏中的缓冲时间达到毫秒级别，虽然吸嘴在微秒级别产生了过冲问题，但是微秒级别过冲产生的冲量被半固体锡膏吸收和缓冲，降低过冲给芯片或元件带来的损伤。
权利要求书clms
1.一种PCB贴片机的精密贴装控制方法，其特征在于，包括：在吸嘴带动工件以第一速度下降过程中，检测到吸嘴到达预设位置时，将下降速度调整为第二速度；其中，第二速度小于第一速度，所述吸嘴由第一电机驱动实现升降；在吸嘴带动工件以第二速度继续下降过程中，检测到第一电机的电流变化值超出预设电流范围时，向第一电机发出电机停止指令；其中，所述电机停止指令用于控制所述第一电机的转子停止转动。2.根据权利要求1所述的一种PCB贴片机的精密贴装控制方法，其特征在于，所述吸嘴由升降机构驱动实现升降运动，所述升降机构包括依次传动连接的第一电机、传动机构和滚珠丝杠副；所述方法还包括，根据如下公式确定吸嘴带动工件以第二速度继续下降时，第一电机的电流：其中， /＞为半固体锡膏对压入工件产生的阻力， /＞为丝杠导程， /＞为第一电机转速， /＞为第一电机工作电压， /＞为传动机构减速比， /＞为第一电机对滚珠丝杠的传动效率， /＞为滚珠丝杠的传动效率。3.根据权利要求2所述的一种PCB贴片机的精密贴装控制方法，其特征在于，所述方法还包括，根据以下公式确定所述第二速度：其中， /＞为深度系数，所述 /＞为半固体锡膏的厚度， /＞为测定得到的延迟时长。4.根据权利要求3所述的一种PCB贴片机的精密贴装控制方法，其特征在于，所述方法还包括测定流程，在测定流程中，根据以下步骤测定得到所述延迟时长：在吸嘴带动工件以第二速度继续下降过程中，利用压力传感器监测吸嘴压力的变化，以所述压力传感器输出的数值突变的时刻作为第一时刻并在检测到第一电机的电流变化值超出预设电流范围时，向第一电机发出电机停止指令；在第一时刻之后，以压力传感器输出的数值稳定的时刻作为第二时刻；计算第二时刻与第一时刻的差值得到延迟时长 。5.根据权利要求4所述的一种PCB贴片机的精密贴装控制方法，其特征在于，所述方法还包括测定流程，在测定流程中，根据以下步骤测定半固体锡膏对压入工件产生的阻力：在测定所述延迟时长 的过程中，以压力传感器输出的最大值作为半固体锡膏对压入工件产生的阻力 /＞。6.根据权利要求5所述的一种PCB贴片机的精密贴装控制方法，其特征在于，所述方法还包括：获取测定半固体锡膏对压入工件产生的阻力 时的测定温度范围和测定湿度范围；在贴片时实时调节现场湿度处于测定温度范围，并实时调节现场湿度处于测定湿度范围。7.根据权利要求5所述的一种PCB贴片机的精密贴装控制方法，其特征在于，在检测到所述锡膏成分为目标成分时，并对第一点胶批次PCB板完成测定半固体锡膏对压入工件产生的阻力的步骤之后，所述方法还包括：依次对后续点胶批次的PCB板执行测定半固体锡膏对压入工件产生的阻力 的步骤；当检测到超过预设比例的阻力值大于第一点胶批次测得的阻力最大值时，将当前点胶批次的值设置为批次阈值A；在贴片时，监测已完成点胶处于待贴片状态的PCB板数量；当已完成点胶处于待贴片状态的PCB板数量达到预设数量时，暂停点胶；通过以下公式确定所述预设数量 :其中， /＞为当前处于工作状态的贴片工位数量。8.根据权利要求5所述的一种PCB贴片机的精密贴装控制方法，其特征在于，在将PCB板传输到贴片工位时，所述方法还包括：获取贴片工位上的PCB板的目标图像；将所述目标图像与预先设置的模板图像上对应的Mark点进行比较，确定是否存在偏差；所述模板图像为标准PCB板的图像，所述标准PCB板与贴片工位上的PCB板的形状及尺寸相同；若存在偏差，则计算贴片工位上的PCB板的各待贴装点相对于标准PCB板上标准位置的位移和角度偏移；利用所述位移和角度偏移对贴装坐标和旋转角度进行补偿。9.一种电子设备，包括：存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至8中任一项所述的一种PCB贴片机的精密贴装控制方法。10.一种计算机可读存储介质，所述计算机可读存储介质存储有计算机可执行指令，其特征在于，所述计算机可执行指令用于使计算机执行如权利要求1至8中任一项所述的一种PCB贴片机的精密贴装控制方法。
说明书desc
技术领域本发明涉及半导体制造技术领域，特别涉及一种PCB贴片机的精密贴装控制方法及装置。背景技术贴片机全自动生产线方案，如图1所示，PCB板依次经过点胶，以使芯片或元件能够被送到PCB板上各目标点实现贴片。贴片过程中，贴片装置的吸嘴通过负压拾取芯片并根据目标点的XY坐标移动到目标点正上方，然后控制吸嘴下降使得芯片或元件压入到焊盘上的锡膏中。为了监控贴片过程中芯片或元件受到的压力，参考文献1的压力检测模块通过检测所述电机的电流变化，当所述电机的电流大于预设值时，判断固晶吸嘴的压力变化达到设定值。该方法检测压力的原理是，利用电机扭矩与电流之间的正比关系，当芯片或元件的底部撞击到了PCB板而受到PCB板的阻挡时，电机的PID控制器为了达到目标值，检测到速度环路反馈的速度降低时，会增大电流以使扭矩增大从而克服芯片或元件受到的阻挡，所以通过检测电流是否达到预设值可以判断芯片或元件受到的压力。然而正如参考文献2所述，一般伺服电机的时间周期都在微秒级别。可知，若采用上述参考文献1中通过检测电流是否达到预设值来判断芯片或元件受到的压力的方案，容易导致过冲。芯片或元件存在损坏风险。对此，参考文献2方案的核心是从硬件层面解决，即采用超高采样频率的压力传感器以及匹配的机械结构对贴片装置的硬件进行改进以实现在纳秒级别的响应，来解决过冲问题。但是，参考文献2所示的方案只适用于特定机械结构的贴片机，硬件改进对于已投入使用的、机械结构已经定型的贴片机全自动生产线不太友好。此外，在贴片时，对于扭曲变形PCB板进行坐标补偿也是亟需解决的问题。参考文献1，授权公告号：CN113571429B专利名称：一种固晶方法及固晶机 公开日期：2021-10-29。参考文献2，申请公布号：CN115116898A专利名称：一种高精度低压力控制的ZR轴贴片装置 公开日期：2022-09-27。发明内容本发明的目的在于至少解决现有技术中存在的技术问题之一，提供一种PCB贴片机的精密贴装控制方法及装置， 能够通过软件方案降低贴片过程中过冲问题对芯片或元件造成的损伤，适用于已投入使用的、机械结构已经定型的贴片机全自动生产线。本发明的发明构思为：利用半固体锡膏对下降中的芯片提供缓冲，并通过软件控制芯片或元件在半固体锡膏中的缓冲时间达到毫秒级别，虽然吸嘴在微秒级别产生了过冲问题，但是微秒级别过冲产生的冲量被半固体锡膏吸收和缓冲，降低过冲给芯片或元件带来的损伤。本发明的技术方案如下：第一方面，本发明提供一种PCB贴片机的精密贴装控制方法，包括：在吸嘴带动工件以第一速度下降过程中，检测到吸嘴到达预设位置时，将下降速度调整为第二速度；其中，第二速度小于第一速度，所述吸嘴由第一电机驱动实现升降；在吸嘴带动工件以第二速度继续下降过程中，检测到第一电机的电流变化值超出预设电流范围时，向第一电机发出电机停止指令；其中，所述电机停止指令用于控制所述第一电机的转子停止转动。第二方面，本发明提供一种电子设备，包括：存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如上所述的一种PCB贴片机的精密贴装控制方法。第三方面，本发明提供一种计算机可读存储介质，所述计算机可读存储介质存储有计算机可执行指令，所述计算机可执行指令用于使计算机执行如上所述的一种PCB贴片机的精密贴装控制方法。本发明提供的一种PCB贴片机的精密贴装控制方法及装置至少具有如下有益效果：1.现有技术中的贴片机一般包括高速贴片模式和慢速贴片模式，一般全程恒定高速或慢速贴片，对于材质易碎的芯片或元件，一般采用慢速贴片模式，降低芯片撞击PCB板时损伤的风险，但是全程恒定慢速会导致贴片效率降低。相较于现有技术，本发明只需要在下降过程中到达预设位置时才进行减速，将高速和慢速模式融合，降低贴片效率的损失。2.本发明中，当芯片或元件的下端接触到半固体锡膏时，吸嘴会受到半固体锡膏的阻力，在微秒级别的响应时间之后，响应于该阻力第一电机的电流会变化，当该电流变化值超出预设电流范围时，第一电机会被控制停止转动。在理想状态下，芯片接触到半固体锡膏时就应该立即停止行进，但是由于伺服系统的延迟响应会导致过冲问题，即芯片在半固体锡膏中行进了微秒级别的时间，而本发明中由于吸嘴在微秒级别过冲产生的冲量作用于半固体锡膏，其动能被半固体锡膏吸收并缓冲，能够降低过冲给芯片或元件带来的损伤。本发明的附加方面和优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明下面结合附图和实施例对本发明进一步地说明；图1为一个实施例中PCB贴片机的精密贴装控制方法的应用环境图。图2为一个实施例中PCB贴片机的精密贴装控制方法的流程示意图。图3为一个实施例中PCB贴片机的精密贴装控制方法的流程示意图。图4为一个实施例中PCB贴片机的精密贴装控制方法的流程示意图。图5为一个实施例中PCB贴片机的精密贴装控制方法的流程示意图。图6为一个实施例中PCB贴片机的精密贴装控制方法的流程示意图。图7为一个实施例中使用的伺服电动缸的结构示意图。图8为4点基准Mark点补偿原理示意图。图9为4点基准Mark点补偿原理示意图。图10为4点基准Mark点补偿计算过程中不适用情况的示意图。图11为现有技术中伺服电机控制系统结构示意图。附图标记：10、生产线；11、全自动吸送板机；12、点胶机；13、接驳台；14、机械手；15、贴片机；16、回流焊设备；17、全自动收板机；20、伺服电动缸；21、第一电机；22、减速机；23、滚珠丝杠副；24、伸缩管前端接头。具体实施方式本部分将详细描述本发明的具体实施例，本发明之较佳实施例在附图中示出，附图的作用在于用图形补充说明书文字部分的描述，使人能够直观地、形象地理解本发明的每个技术特征和整体技术方案，但其不能理解为对本发明保护范围的限制。图1为一个实施例中PCB贴片机的精密贴装控制方法的应用环境图。参照图1，该PCB贴片机的精密贴装控制方法适用于贴片机全自动生产线10。该贴片机全自动生产线10方案按照工序依次包括全自动吸送板机11、点胶机12、接驳台13、机械手14、贴片机15、另一台接驳台、回流焊设备16、全自动收板机17，可以连接的是，上述生产线10中的各种硬件设备均是本领域被广泛应用的设备，此处不再赘述。需要说明的是，图1示出的仅为本发明适用的其中一种贴片机全自动生产线方案，对于其他的贴片机全自动生产线方案，本领域普通技术人员可以理解实现一下实施例方法中的全部或部分流程之后，在不需要付出创造性劳动情况下，将本发明提供的方法适用于其他的贴片机全自动生产线方案，因此本发明所提供的方法应用于其他的贴片机全自动生产线方案时，也落入本发明的保护范围。为了便于理解本发明，有必要对发明人做出本发明的背景再一次简要说明。参考文献2中披露了通过硬件解决过程问题的技术路线，其核心是从硬件层面解决，即采用超高采样频率的压力传感器以及匹配的机械结构对贴片装置的硬件进行改进以实现在纳秒级别的响应，来解决过冲问题。然而，硬件改进对于已投入使用的、机械结构已经定型的贴片机全自动生产线10不太友好，存在改造工程投入人力多、采购硬件设备成本高、硬件改造耗时久等问题，在与用户沟通中发现这些问题成为阻碍用户对贴片机全自动生产线10方案进行改进的重要因素。因此，发明人尝试开辟通过软件解决过程问题的技术路线，目的是能够通过软件方案降低贴片过程中过冲问题对芯片或元件造成的损伤，适用于已投入使用的、机械结构已经定型的贴片机全自动生产线。基于上述发明目的，本发明采用的发明构思为：利用半固体锡膏对下降中的芯片提供缓冲，并通过软件控制芯片或元件在半固体锡膏中的缓冲时间达到毫秒级别，虽然吸嘴在微秒级别产生了过冲问题，但是微秒级别过冲产生的冲量被半固体锡膏吸收和缓冲，降低过冲给芯片或元件带来的损伤。基于上述发明构思，下面，将通过几个具体的实施例对本发明实施例提供的一种PCB贴片机的精密贴装控制方法进行详细介绍和说明。如图2所示，在一个实施例中，提供了一种PCB贴片机的精密贴装控制方法。本实施例主要以该方法应用于上述图1中的贴片机15为例进行说明。参照图2，该PCB贴片机的精密贴装控制方法具体包括如下步骤：步骤S202，在吸嘴带动工件以第一速度下降过程中，检测到吸嘴到达预设位置时，将下降速度调整为第二速度；其中，第二速度小于第一速度，所述吸嘴由第一电机21驱动实现升降。需要说明的是，第一速度可以是贴片机15原先程序设定的下降速度，例如800mm/s，而检测到吸嘴到达预设位置时，例如伺服电机编码器的反馈来检测吸嘴是否到达预设位置。具体的，可以根据每个吸嘴的初始位置和工件的高度来设置预设位置的具体值，如定义吸嘴初始位置为0，吸嘴在初始位置距离PCB板距离为20cm，预先获取各吸嘴对应的元件或芯片高度，如1cm。如果设定元件或芯片底部与PCB板距离5cm时需要减速，则应该控制吸嘴在下降至距离初始位置=14cm时，认为到达预设位置，作为一个示例，此时将速度从800mm/s调整为50mm/s。可以理解的是，此时计算的吸嘴或芯片底部到达PCB板的距离是粗略估计，是根据贴片机15用于固定PCB板的固定座所处平面的高度加上PCB板厚度进行计算得到。此处PCB板与芯片底部距离的精度误差只需要控制在毫米级别或厘米即可。减速的目的是为了让芯片底部接触点在半固体锡膏中行进时，相同的行进深度需要更长的可行进时长，从而提供更多的可行进时长让微秒级别相应的伺服电机系统可以完成电流检测并发出电机停止指令，因此，可行进时长的目标应该是毫秒级别。本实施例中，取锡膏厚度为200微米计算，第二速度为50mm/s，即使认为第二速度在半固体锡膏中不下降，则芯片在半固体锡膏中可行进时长为。本示例中，以预设电流范围为0.1A为例，设置该预设电流范围可以避免由于系统电信号波动造成的误操作。本实施例的原理是，利用第一电机扭矩与电流之间的正比关系，当芯片或元件受到PCB板的阻挡时，电机的PID控制器为了达到目标值，检测到速度环路反馈的速度降低时，会增大电流以使扭矩增大从而克服芯片或元件受到的阻挡，所以检测到电流变化值超出预设电流范围就可以判断芯片或元件接触到了半固体锡膏，从而立即发出电机停止指令，配合上在步骤S202中设置的第二速度，可以确保芯片在半固体锡膏中可行进时长为之前发出电机停止指令，减少过冲给芯片或元件带来的损伤。可以理解的是，本实施例中，应该确保半固体锡膏阻力引起的第一电机21电流变化值超出预设电流范围，具体的，可以在测定阶段根据测定结果设置预设电流范围。综上所述，相较于现有技术，本实施例至少具有如下有益效果：1.现有技术中的贴片机一般包括高速贴片模式和慢速贴片模式，一般全程恒定高速或慢速贴片，对于材质易碎的芯片或元件，一般采用慢速贴片模式，降低芯片撞击PCB板时损伤的风险，但是全程恒定慢速会导致贴片效率降低。相较于现有技术，本发明只需要在下降过程中到达预设位置时才进行减速，将高速和慢速模式融合，降低贴片效率的损失。2.本发明中，当芯片或元件的下端接触到半固体锡膏时，吸嘴会受到半固体锡膏的阻力，在微秒级别的响应时间之后，响应于该阻力第一电机21的电流会变化，当该电流变化值超出预设电流范围时，第一电机21会被控制停止转动。在理想状态下，芯片接触到半固体锡膏时就应该立即停止行进，但是由于伺服系统的延迟响应会导致过冲问题，即芯片在半固体锡膏中行进了微秒级别的时间，而本发明中由于吸嘴在微秒级别过冲产生的冲量作用于半固体锡膏，其动能被半固体锡膏吸收并缓冲，能够降低过冲给芯片或元件带来的损伤。进一步的，在一个实施例中，所述吸嘴由升降机构驱动实现升降运动，所述升降机构包括依次传动连接的第一电机21、传动机构和滚珠丝杠副23，在贴片机15中，升降机构一般采用伺服电动缸20实现，如图7所示，伺服电动缸20一般由滚珠丝杠副23、伺服电机、伸缩管前端接头24、传动机构组成，传动机构多采用行星减速机22传动、同步带传动，或者两者组合的结构方式。本实施例中传动机构采用了减速机22，电机转子停止转动时的惯性作用会作用于减速机22输入端，但是由于减速机22具有制动效果，其减速机22的输出端不会受到影响，即不会将电机停止瞬间的惯性晃动传递到芯片处，保证发出停止转动指令之后芯片在半固体锡膏中的止动效果。适用于上述常用的升降机构，所述方法还包括，根据如下公式确定吸嘴带动工件以第二速度继续下降时，第一电机21的电流：其中，为半固体锡膏对压入工件产生的阻力，/＞为丝杠导程，/＞为第一电机21转速，/＞为第一电机21工作电压，/＞为传动机构减速比，/＞为第一电机21对滚珠丝杠的传动效率，/＞为滚珠丝杠的传动效率。本实施例中，设置吸嘴带动工件以第二速度下降时第一电机21的电流符合公式，从而确保滚珠丝杠给工件向下的推力大于半固体锡膏对压入工件产生的阻力，能够保证芯片背面的接触点被顺利压入到半固体锡膏中与半固体锡膏充分接触。需要说明的是，按照公式设置吸嘴带动工件以第二速度下降时的第一电机21电流很有必要。以科尔摩根  某款伺服驱动器为例，速度环路响应时间需要62.5微秒，若是并未按照公式设置吸嘴带动工件以第二速度下降时的第一电机21电流，有可能导致滚珠丝杠给工件向下的推力小于半固体锡膏对压入工件产生的阻力，由于速度环路以及伺服系统的其他时间延迟为500微秒，可能导致500微秒之内，工件受到锡膏阻力而无法继续压入锡膏中。显然，芯片受到阻力时，由于微米级别延迟，必须经过500微秒之后才能发出电机停止指令；而如果不按照公式设置吸嘴带动工件以第二速度下降时的第一电机21电流，会导致芯片背面的接触点无法顺利压入锡膏中，可能导致接触点与锡膏接触不充分。本实施例提供的公式正是旨在解决上述问题。基于上述实施例，本实施例中，所述方法还包括，根据以下公式确定所述第二速度：其中，为深度系数，所述/＞为半固体锡膏的厚度，/＞为测定得到的延迟时长。本实施例中，为了保证芯片底部的接触点与锡膏充分接触，将深度系数m设置为1/2，即让芯片压入到半固体锡膏厚度的1/2，本实施例中若半固体锡膏厚度h=200微米，测定得到的延迟时长为0.5毫秒，则可以计算得到第二速度为1/2*=200mm/s。本实施例中，可行进时长为1毫秒。如上所示，本实施例中提供了调节工件的接触点压入半固体锡膏深度的方案，便于根据不同生产场景需求调节具体的压入深度。具体的，如图3所示，在一个实施例中，提供了测定各参数的流程。在测定流程中，根据以下步骤测定得到所述延迟时长：步骤S302，在吸嘴带动工件以第二速度继续下降过程中，利用压力传感器监测吸嘴压力的变化，以所述压力传感器输出的数值突变的时刻作为第一时刻并在检测到第一电机21的电流变化值超出预设电流范围时，向第一电机21发出电机停止指令。需要说明的是，在测定延迟时长的时候，主要是测定对应升降机构的伺服系统的信号传输和处理延迟，因此对于一台贴片机生产线10上均采用同一型号的伺服系统的所有吸嘴可以仅对其中单个吸嘴进行测定，一般来说，出于一致性考虑，出厂的贴片机生产线10上的吸嘴采用相同型号的伺服系统。对于采用不同伺服系统的吸嘴，可以对每个型号伺服系统驱动的吸嘴分别测定即可，例如有三种型号的伺服系统，即可以将对应伺服系统中的电机定义为第一电机、第二电机和第三电机，分别对第一电机、第二电机和第三电机执行测定步骤。具体如何利用压力传感器监测吸嘴压力的变化，属于现有技术，具体可以参照参考文献2或其他文献，此处不再赘述。步骤S304，在第一时刻之后，以压力传感器输出的数值稳定的时刻作为第二时刻。可以连接的是，当第一电机21停止转动时，芯片或元件不再继续行进，此时压力传感器输出的数值稳定。步骤S306，计算第二时刻与第一时刻的差值得到延迟时长。本实施例中，工件触碰到半固体锡膏时，高采样频率的压力传感器可以很快检测到触碰的发生，例如采用采样频率为2Mhz的压力传感器，其响应时间为500纳秒。本实施例可以准确测定出纳米级别误差的延迟时长。在上述实施例基础上，在测定流程中，根据以下步骤测定半固体锡膏对压入工件产生的阻力：在测定所述延迟时长的过程中，以压力传感器输出的最大值作为半固体锡膏对压入工件产生的阻力/＞。本实施例中，以压力传感器输出的最大值作为半固体锡膏对压入工件产生的阻力，可以确保在符合公式的情况下，在锡膏中行进时推力可以大于最大的阻力，从而保证锡膏中的行进速度不会下降太多，进而保证行进深度。例如，假设延迟时长为0.5毫秒，压力传感器采用频率为每5微秒一次，每毫秒200次，则可以选取100个值中的最大值作为阻力值，保证工件下压的顺利进行。如图4所示，在一个实施例中，所述方法还包括：步骤S402，获取测定半固体锡膏对压入工件产生的阻力时的测定温度范围和测定湿度范围。例如，测定温度范围为20-25℃，测定湿度范围40％-60％。步骤S404，在贴片时实时调节现场湿度处于测定温度范围，并实时调节现场湿度处于测定湿度范围。本实施例中，考虑到温度和湿度对于锡膏的硬度产生较大影响，所以在贴片的现场对湿度和温度进行实时调节，保持温度和湿度处于测定时的范围内，保证控制方法在最佳环境中执行，以确保贴片的效果。在某些情况下，如果无铅锡膏中，硬化剂含量过多，会在室温下逐渐反应，导致锡膏逐渐硬化，而且硬化速度会随时间的延长而加快。例如对于一些高精度电子产品的生产，会采用硬化剂添加量较高的无铅锡膏来提高焊点的可靠性和耐久性。因此，对于这类贴片生产线10还需要考虑时间对锡膏硬度产生的影响。提供如下实施例：在检测到所述锡膏成分为目标成分时，并对第一点胶批次PCB板完成测定半固体锡膏对压入工件产生的阻力的步骤之后，如图5所示，本实施例中，所述方法还包括：步骤S502，依次对后续点胶批次的PCB板执行测定半固体锡膏对压入工件产生的阻力的步骤。本实施例中，对一片PCB板从完成点胶开始计时，统计其依次经过运输、缺陷检测、贴片坐标检测和补偿、完成贴片所经过的时长作为一个等待周期T。在得到等待周期T之后，按照PCB板距离完成点胶时间点所经过的时间，将各PCB板划分为对应的批次。举例而言，等待周期T=10秒，A、B、C、D四片点胶完成的PCB板距离完成点胶时间点经过的时间分别为1秒，12秒，21秒，33秒，则A、B、C、D四片PCB板的点胶批次依次分别是第一点胶批次、第二点胶批次、第三点胶批次、第四点胶批次，用公式表达为点胶批次=+1，其中为取整符号。按照点胶批次划分PCB板是为了测定不同等待时间下半固体锡膏硬化情况，因为在如图1所述的贴片机生产线10中，一般点胶耗时小于贴片耗时，就会造成点胶完成的大量PCB板堆积在接驳台13，而在接驳台13上停留时间越久，对于硬化剂含量过多的无铅锡膏而言，会在室温下逐渐反应，导致锡膏逐渐硬化，而且硬化速度会随时间的延长而加快。当半固体锡膏硬化到一定程度时，会导致在测定流程中测得的半固体锡膏对压入工件产生的阻力不再适用，因此，本实施例需要确定半固体锡膏对压入工件产生的阻力/＞在等待时间上的适用范围。步骤S504，当检测到超过预设比例的阻力值大于第一点胶批次测得的阻力最大值时，将当前点胶批次的值设置为批次阈值A。在一示例中，延迟时长为0.5毫秒，压力传感器采用频率为每5微秒一次，每毫秒200次，以A、B、C、D、E、F四片PCB板为例，在第一点胶批次测定的阻力最大值为2N，预设比例为20%，B板、第二点胶批次测定过程中有5个值大于2N，大于2N的比例为5%；C板、第三点胶批次测定过程中有8个值大于2N，大于2N的比例为8%；D板、第四点胶批次测定过程中有13个值大于2N，大于2N的比例为13%；E板、第五点胶批次测定过程中有17个值大于2N，大于2N的比例为17%；F板、第六点胶批次测定过程中有21个值大于2N，大于2N的比例为21%，大于预设比例20%；显然第六点胶批次符合条件，将批次阈值A设置为6。步骤S506，在贴片时，监测已完成点胶处于待贴片状态的PCB板数量。在点胶设备和贴片设备之间的接驳台13，可以统计位于接驳台13上的PCB板数量，例如可以使用光传感器统计送入和输出接驳台13的PCB板数量进行计数等，其具体计数方案属于现有技术，此处不再赘述。步骤S508，当已完成点胶处于待贴片状态的PCB板数量达到预设数量时，暂停点胶。步骤S510，通过以下公式确定所述预设数量:其中，为当前处于工作状态的贴片工位数量。需要说明的是，为了提高生产效率，一台贴片机15可能存在多个贴片工位，每个贴片工位都可以单独完成一片PCB板的贴片作业。可以理解的是，在贴片机生产线10中很难统计每一片点胶完成之后的PCB板的等待时间，但是利用生产线10现有的功能可以统计接驳台13上PCB板的数量，因此，可以通过转换PCB板等待时间与接驳台13上PCB板数量的关系，来充分利用生产线10的功能实现对点胶完成的PCB板等待时间的控制。本实施例通过步骤S510中的公式来实现。具体的，当有新的完成点胶的PCB板送入接驳台13时，已完成点胶处于待贴片状态的PCB板数量加一，将该最新送入接驳台13的PCB板成为G板，对于G板而言，因为其在经过A*T的时间之后锡膏就会硬化至不符合要求的情况，所以其允许等待的最长时间是*T，而对于有k个贴片工位的贴片机15而言，其每个周期T可以从接驳台13上消耗k个PCB板，所以经过个周期可以消耗N=*k片PCB板。反过来，如果接驳台13上的PCB板数量大于N=*k片PCB板,就会导致最新送入到接驳台13的PCB板上的锡膏硬化至不符合要求的情况，因此按照公式可以充分利用生产线10的功能实现对点胶完成的PCB板等待时间的控制，确保在测定流程中测得的半固体锡膏对压入工件产生的阻力能继续适用于硬化剂含量过多的无铅锡膏。另一方面，现有技术通过传送带或机械手14的方式将PCB板在各个加工工位中进行传输。一般无论是通过传送带或机械手14将点胶工位处理完的PCB板传输至贴片工位时，都认为PCB板能够被传输到贴片工位指定的位置，然后将PCB板固定在该位置上，贴片装置按照预先获取的该PCB板上需要贴片的各目标点的坐标控制贴片装置的气缸或电机在XYZ坐标上动作，以使元件能够被送到PCB板上各目标点实现贴片。然而，在实际操作中，按照预设的目标点坐标控制贴片装置进行贴片时，元件被送到PCB板上的位置与PCB板上实际的目标点位置存在偏差。其原因如下：1.机械误差：在传送带或机械手14将PCB板从点胶工位传输至贴片工位时，由于机械设备的精度限制，可能会导致PCB板在贴片工位上的实际位置与预设位置存在偏差。此外，贴片装置在XYZ坐标轴上的运动也可能因机械误差而导致元件贴片位置偏离目标点。2.PCB板形状变化：在加工过程中，由于各种原因可能导致PCB板在贴片过程中发生形状变化，这会使得贴片时实际的目标点位置发生偏移，导致贴片装置按照预设的目标点坐标进行贴片时出现误差。因此，为了解决元件被送到PCB板上的位置与PCB板上实际的目标点位置存在偏差的问题，如图6所示，提供如下实施例：在本实施例中，在将PCB板传输到贴片工位时，所述方法还包括：步骤S602，获取贴片工位上的PCB板的目标图像。步骤S604，将所述目标图像与预先设置的模板图像上对应的Mark点进行比较，确定是否存在偏差；所述模板图像为标准PCB板的图像，所述标准PCB板与贴片工位上的PCB板的形状及尺寸相同。步骤S606，若存在偏差，则计算贴片工位上的PCB板的各待贴装点相对于标准PCB板上标准位置的位移和角度偏移。步骤S608，利用所述位移和角度偏移对贴装坐标和旋转角度进行补偿。需要说明的是，步骤S602至步骤S608有两种实现方式，第一种是如参考文献3所述的2点基准Mark点补偿方案，这是现有技术中常用的方案，其具体实现方式可以参照参考文献3，此处不再赘述。参考文献3：许彦杰. 表面贴装技术实验平台软件系统关键技术研究.西安电子科技大学,2015.第二种则是本发明提出的4点基准Mark点补偿方案，四点基准Mark点的补偿方案的效果可以通过与2点基准Mark点补偿方案比较来了解。如表1所示，2点基准Mark点补偿，是通过使用2 点基板的基准Mark的图像识别结果，进行１次平面直角坐标变换取得位置补偿。也就是变换后的坐标系仍是平面直角坐标。此时，当PCB板有变形，扭曲时就产生问题了，PCB板上的坐标系已经不是平面直角坐标系了。由此，2 点基准Mark点的坐标变换方法不可能取得在PCB板扭曲变形时正常的高精度的位置补偿。此时，为了解决上述的问题，可以考虑使用本实施例提供的４点基准Mark点的补偿方案。４点基准Mark点的补偿是使用PCB板上的任意的平面坐标，变换至任意的平面坐标，对于扭曲的PCB板，仍可能取得高精度的位置补偿。坐标变换的详细参阅如下：4点坐标变换变换方法假设：A,B,C,D ---→ ４点基准Mark的理论坐标；a,b,c,d ------→ ４点基准Mark的实测坐标；M ------------→ 贴装点位置的理论坐标；m ------------→ 坐标变换后的贴装位置坐标。如图8和图9所示，①设四边形 ABCD 的对边 AD，BC 的各自任意内分点α:连接的直线为LINE1 。而 M 为经过LINE1 直线上的点，求α。②同样设四边形 ABCD 的对边，AB，DC的各自任意内分点β: 连接的直线为LINE2 。LINE2 也是经过点 M ，求β。③设四边形 abcd 的对边ad，bc 的各自任意内分点α: 连接的直线为line1 。④同样设四边形 abcd 的对边ab，dc 的各自任意内分点β: 连接的直线为line2 。⑤设直线 line1 和 line2 的交点为M坐标的变换点 m 的坐标，即变形，扭曲前后的坐标位置变换过程中其各点对应的α，β不变。⑥分别求得LINE1 与 line1 的倾角的差和 LINE2 与 line2 的倾角的差，以此两差值的平均值为坐标变换的角度偏差。实际计算①为了简化坐标计算，对点 A,B,C,D,和点a,b,c,d 需满足以下的条件。1）A,B,C,D 4点的其中 3 点以上需不在同一直线上。2）A,B,C,D 4点的顺序需能够围成一个四边形。如图10的情况是不允许的，即边 AD 和边 BC 不可交叉。3）四边形ABCD 的任一内角不能超过 180 度。如图10的情况是不允许的，即内角∠ABC 在 180 度以上。4）上述的 3 个条件，同样对应的4点 a,b,c,d 也需满足。②求AD线中的内分点位置坐标为AX+/＞DX, AY+/＞DY)， BC线中的内分点位置坐标为BX+/＞CX, BY+/＞CY) ，通过此 2 点的直线 LINE1 的方程式为：设此直线 LINE1通过点 M，将X=MX、Y=MY 代入整理，可得的2次方程式：其中，A=-B={-}-{-}C=-上述方程不一定是实数解，也有可能是虚数解。在此按实数解进行计算。 此方程式的实数解为：其中AD∥BC 时， A=0 ， 此时α=-C/B 。 又因为2 个α的解中的 1 个是直线 AD与 BC 的交点，此解需删除，此点往往可认为在贴装补偿位置的有效范围之外。③求β按求α时的同样方法进行计算。显示结果如下。β={-B±√}/2A其中A=-B={-}-{-}C=-AB∥DC时， A=0 ，此时，β=-C/B 。又因为2 个α的解中的 1 个是直线 AB 与DC的交点，此解需予以删除。④求点M经4点坐标变换之后得到的点m的坐标使用经②③求得的α、β值。设通过ad,bc 上各自内分点α:的直线为 line1 ，其方程式为:=其中，A=ax+αdx, B=ay+αdy, C=bx+αcx, D=by+αcy。同样设 ab,dc 上各自内分点β: 的直线为 line2，其方程式为:=其中，E=ax+βbx,F=ay+βby, G=dx+βcx, H=dy+βcy 。line1 和 line2 的交点为 m，将mx,my代入求解，C-A≈ 0, G-E≈ 0时,mx=/, my=/，其中J=/, K=A-J*B, L=/, M=E-L*F，C-A≈ 0, G-E≠0时,mx=, my=/，其中J=/, K=A-J*B, L=/, M=F-L*E， C-A≠0, G-E≈ 0时，mx=, my=/，其中J=/, K=B-J*A, L=/, M=E-L*F ， C-A≠0, G-E≠0 时，mx=/, my=/。其中J=/, K=B-J*A, L=/, M=F-L*E。⑤求点 m坐标的旋转角度设LINE1 的方向矢量为 L1设LINE2 的方向矢量为 L2设line1 的方向矢量为 l1设line2 的方向矢量为 l2LINE1 和 line1 的角度为θ1 由此，COS=/LINE2 和 line2 的角度为θ2 由此，COS=/设旋转角度为θ，θ=/2。实际计算：θ=/2.其中，A=BX +αCX - AX +αDX),B=BY +αCY - AY +αDY),C=DX +βCX - AX +βBX),D=DY +βCY - AY +βBY),E=bx +αcx - ax +αdx),F=by +αcy - ay +αdy),G=dx +βcx - ax +βbx),H=dy +βcy - ay +βby)。综上，通过本实施例提供的４点基准Mark点的补偿方案可以计算得到各贴装点需要补偿的旋转角度θ以及各贴装点补偿之后的坐标m，例如，标准PCB板上的贴装点坐标为M，在利用４点基准Mark点的补偿方案完成对M点的补偿之后，控制吸嘴移动到坐标m并旋转θ的角度进行贴片。本实施例提供的方案可以适用于扭曲变形的PCB板的坐标补偿。在一个实施例中，提供了一种电子设备，包括：存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时执行上述PCB贴片机的精密贴装控制方法的步骤。此处PCB贴片机的精密贴装控制方法的步骤可以是上述各个实施例的PCB贴片机的精密贴装控制方法中的步骤。在一个实施例中，提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机可执行指令，所述计算机可执行指令用于使计算机执行上述PCB贴片机的精密贴装控制方法的步骤。此处PCB贴片机的精密贴装控制方法的步骤可以是上述各个实施例的PCB贴片机的精密贴装控制方法中的步骤。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的程序可存储于一非易失性计算机可读取存储介质中，该程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、存储、数据库或其它介质的任何引用，均可包括非易失性和/或易失性存储器。非易失性存储器可包括只读存储器、可编程ROM、电可编程ROM、电可擦除可编程ROM或闪存。易失性存储器可包括随机存取存储器或者外部高速缓冲存储器。作为说明而非局限，RAM以多种形式可得，诸如静态RAM、动态RAM、同步DRAM、双数据率SDRAM、增强型SDRAM、同步链路DRAM、存储器总线直接RAM、直接存储器总线动态RAM、以及存储器总线动态RAM等。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。
