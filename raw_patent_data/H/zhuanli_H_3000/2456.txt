标题title
基于链路两端均衡参数的EQ降低延时方法、系统及装置
摘要abst
本发明公开了一种基于链路两端均衡参数的EQ降低延时方法、系统及装置，获取各分支链路的长度信息，并存储至各分支链路对应的寄存器中；对一分支链路进行均衡配置，获得被均衡配置的分支链路的发送端/接收端的均衡配置参数。本发明通过预先获取各分支链路的长度关系，而后对预先对一分支链路进行均衡配置，直接可通过预先配置的分支链路与其余各链路的长度关系结合，对预配置分支链路进行均衡配置，实现让预分支链路的发送端能够在粗调阶段进行直接配置，使发送端和接受端在协商过程中减少请求‑响应的次数，以使协商过程尽快完成，到达减少均衡配置时间。也即实现各分支链路能够根据各自链路的长度进行自主调节均衡配置参数。
权利要求书clms
1.一种基于链路两端均衡参数的EQ降低延时方法，其特征在于，所述方法包括：获取各分支链路的长度信息，并存储至各分支链路对应的寄存器中；对一分支链路进行均衡配置，获得被均衡配置的分支链路的发送端/接收端的均衡配置参数；获取被均衡配置的分支链路与预配置分支链路的长度比，同时获取被均衡配置分支链路的发送端/接收端的均衡配置参数；将被均衡配置分支链路的发送端/接收端的均衡配置参数结合被均衡配置的分支链路与预配置分支链路的长度比，获得预配置均衡参数；利用预配置均衡参数，对预配置分支链路直接进行均衡参数配置。2.根据权利要求1所述的一种基于链路两端均衡参数的EQ降低延时方法，其特征在于，将上行设备来/回传输中间设备的链路分别定义为：第一分支链路/第二分支链路；将中间设备来/回传输下行设备的链路分别定义为：第三分支链路/第四分支链路；在首先以第一分支链路进行均衡配置时，所述方法还包括如下步骤：步骤一：获取第一分支链路和第三分支链路的长度信息，得到第一分支链路与第三分支链路的长度比，并存储至各分支链路对应的寄存器中；步骤二：对第一分支链路进行链路均衡训练和配置，获取得到第一分支链路的发送端/接收端均衡参数，并将获取到的发送端均衡参数保存到存储器中；步骤三：对第三分支链路进行链路均衡配置时，获取第一分支链路与第三分支链路的长度比，同时调取第一分支链路的发送端/接收端均衡参数，第一分支链路的发送端/接收端均衡参数结合第一分支链路和第三分支链路的链路长度比，直接写入第三分支链路中进行均衡配置，完成对第三分支链路的均衡配置；步骤四：对第四分支链路进行链路均衡配置时，第四分支链路的发送端通过下行设备中的自身电路将第三分支链路的发送端/接收端均衡参数进行接收写入，第四分支链路的发送端/接收端均衡参数直接调取第三分支链路的发送端/接收端均衡参数写入，进行对第四分支链路的均衡配置；步骤五：对第二分支链路进行链路均衡配置时，第二分支链路通过上行设备的自身电路，获取第一分支链路的发送端/接收端均衡参数，第二分支链路利用获取到的第一分支链路的发送端/接收端均衡参数进行均衡配置。3.根据权利要求2所述的一种基于链路两端均衡参数的EQ降低延时方法，其特征在于，在首先以第四分支链路进行均衡配置时，所述方法包括：步骤一：获取第四分支链路和第二分支链路的长度信息，得到第四分支链路与第二分支链路的长度比，并存储至各分支链路对应的寄存器中；步骤二：对第四分支链路进行链路均衡训练和配置，获取得到第四分支链路的发送端/接收端均衡参数，并将获取到的发送端均衡参数保存到存储器中；步骤三：对第二分支链路进行链路均衡配置时，获取第四分支链路与第二分支链路的长度比，同时调取第四分支链路的发送端/接收端均衡参数，第四分支链路的发送端/接收端均衡参数结合第四分支链路和第二分支链路的链路长度比，直接写入第二分支链路中进行均衡配置，完成对第二分支链路的均衡配置；步骤四：对第三分支链路进行链路均衡配置时，第三分支链路的发送端通过下行设备中的自身电路将第四分支链路的发送端/接收端均衡参数进行接收写入，第三分支链路的发送端/接收端均衡参数直接调取第四分支链路的发送端/接收端均衡参数写入，进行对第三分支链路的均衡配置；步骤五：对第一分支链路进行链路均衡配置时，第一分支链路通过上行设备的自身电路，获取第二分支链路的发送端/接收端均衡参数，第一分支链路利用获取到的第二分支链路的发送端/接收端均衡参数进行均衡配置。4.根据权利要求1-3中任一项所述的一种基于链路两端均衡参数的EQ降低延时方法，其特征在于，获得被均衡配置的分支链路的发送端/接收端的均衡配置参数的方法包括：利用PCLE链路训练码型或者通过外围设备对被分支链路的发送端/接收端进行均衡配置。5.根据权利要求4所述的一种基于链路两端均衡参数的EQ降低延时方法，其特征在于，对所述被均衡配置的分支链路的接收端的配置方法包括：被均衡配置分支链路的发送端通过自身电路以内置的默认的均衡配置参数进行均衡配置后，向着被均衡配置的分支链路的接收端进行发送初期链路训练码型；被均衡配置的分支链路的接收端收到初期链路训练码型，让所述初期链路训练码型通过被均衡配置的分支链路的接收端的自身电路进行均衡配置后，同时参照被均衡配置的分支链路的接收端的默认参数判定接收误码率是否满足阈值要求。6.根据权利要求5所述的一种基于链路两端均衡参数的EQ降低延时方法，其特征在于，若被均衡配置的分支链路的接收端的默认参数判定接收误码率不满足阈值要求，则将与被均衡配置的分支链路的路径相反的分支链路的发送端通过自身分支链路进行反馈；与被均衡配置的分支链路的路径相反的分支链路的发送端通过自身分支链路反馈特殊码型至与被均衡配置的分支链路的相反对应的分支链路的接收端上，告知初期链路训练码型的均衡配置参数不满足要求，需要重新配置均衡参数；与被均衡配置的分支链路的路径相反的分支链路的接收端接到反馈的重新配置均衡参数的要求，与被均衡配置的分支链路的路径相反的分支链路的接收端通过自身电路根据特殊码型信息，通知被均衡配置的分支链路修改初期链路训练码型，然后再次发送修改后的链路训练码型，直至被均衡配置的分支链路的接收端满足误码率要求。7.根据权利要求1所述的一种基于链路两端均衡参数的EQ降低延时方法，其特征在于，将被均衡配置分支链路的发送端/接收端的均衡配置参数结合被均衡配置的分支链路与预配置分支链路的长度比的方法包括：将被均衡配置分支链路的发送端/接收端的均衡配置参数定义为EQ1，将被均衡配置的分支链路与预配置分支链路的长度比定义为：系数a，则预均衡配置分支链路的发送端/接收端的均衡配置参数：EQ2=EQ1*a；其中，所述。8.一种基于链路两端均衡参数的EQ降低延时的系统，其特征在于，采用了权利要求1-7中任一项所述的基于链路两端均衡参数的EQ降低延时方法,其中，上行设备包括：CPU芯片;中间设备包括：至少一个Retimer芯片；下行设备包括：终端芯片或显卡芯片；其中，所述上行设备、所述下行设备中均设置有寄存器，所述寄存器用于寄存各分支链路之间的长度比关系。9.一种基于链路两端均衡参数的EQ降低延时的系统，其特征在于，采用了权利要求1-7中任一项所述的基于链路两端均衡参数的EQ降低延时方法,其中，上行设备包括：CPU芯片;中间设备包括：至少一个Retimer芯片；下行设备包括：终端芯片或显卡芯片；其中，所述上行设备、所述下行设备中均设置有寄存器，所述寄存器用于寄存各分支链路之间的长度比关系。10.一种基于链路两端均衡参数的EQ降低延时装置，其特征在于，采用了权利要求8或9中所述的一种基于链路两端均衡参数的EQ降低延时的系统，或实现权利要求1-7中任一项所述的一种基于链路两端均衡参数的EQ降低延时方法。
说明书desc
技术领域本发明涉及芯片技术领域，尤其涉及基于链路两端均衡参数的EQ降低延时方法、系统及装置。背景技术信号从发送端发出，经信道传输，到达接收端。在传输过程中，信号会发生失真，影响接收端对信号的正确判决。为了在接收端获取到易于判决的优质信号，可以在发送端、传输链路途中或者接收端信号判决之前对信号进行调理改善，从而减小信号失真对通信性能的影响。这种对信号的调理，称作信号补偿，或称均衡。但由于实际产品中PCIE 信号的传输链路的长度是不一致的，有时候长，有时候短，有时可能只需要Tx发送端的均衡即可实现良好的补偿，而不需要Rx端的均衡;或者在Tx发送端与Rx接收端使用相应的均衡等级组合才可能得到最优的眼图。目前，现有技术中有公开号为“US20190034376A1”、名称为“serdes链接训练”的美国发明专利中，公开了“从先前的均衡过程获得的存储和检索的均衡参数来执行链路训练。作为链路训练序列的一部分，将上游端口与下游端口以及任何干预重定时器互连的链路进行均衡训练。来自每个系统组件的初始均衡参数值可以存储在非易失性存储器中。在后续链接训练过程中，存储在非易失性存储器中的均衡参数值可以写入与上游端口、下行端口和Retimer相关联的寄存器，以用于操作互连链路。均衡参数值可以代替执行新的均衡过程，减少初始配阶段的EQ延时，还可以用作减少与均衡过程关联的延迟的起点”在上述专利中，存在初始均衡参数值来自先前的均衡过程中获得的存储和检索的均衡参数，需要系统先进行配置。在PCIe链路长度每发生变化，需要再次进行初始均衡参数值的获取、存储以及写入每个系统组件相关联的寄存器中，过程繁琐。发明内容本发明的目的是为了实现各分支链路能够根据各自链路的长度进行自主调节均衡配置参数，而提出的一种基于链路两端均衡参数的EQ降低延时方法、系统及装置。为了实现上述目的，本发明采用了如下技术方案：本发明第一方面提供了一种基于链路两端均衡参数的EQ降低延时方法，包括：所述方法包括：获取各分支链路的长度信息，并存储至各分支链路对应的寄存器中；对一分支链路进行均衡配置，获得被均衡配置的分支链路的发送端/接收端的均衡配置参数；获取被均衡配置的分支链路与预配置分支链路的长度比，同时获取被均衡配置分支链路的发送端/接收端的均衡配置参数；将被均衡配置分支链路的发送端/接收端的均衡配置参数结合被均衡配置的分支链路与预配置分支链路的长度比，获得预配置均衡参数；利用预配置均衡参数，对预配置分支链路直接进行均衡参数配置。在一些可行的实施例中，将上行设备来/回传输中间设备的链路分别定义为：第一分支链路/第二分支链路；将中间设备来/回传输下行设备的链路分别定义为：第三分支链路/第四分支链路；在首先以第一分支链路进行均衡配置时，所述方法还包括如下步骤：步骤一：获取第一分支链路和第三分支链路的长度信息，得到第一分支链路与第三分支链路的长度比，并存储至各分支链路对应的寄存器中；步骤二：对第一分支链路进行链路均衡训练和配置，获取得到第一分支链路的发送端/接收端均衡参数，并将获取到的发送端均衡参数保存到存储器中；步骤三：对第三分支链路进行链路均衡配置时，获取第一分支链路与第三分支链路的长度比，同时调取第一分支链路的发送端/接收端均衡参数，第一分支链路的发送端/接收端均衡参数结合第一分支链路和第三分支链路的链路长度比，直接写入第三分支链路中进行均衡配置，完成对第三分支链路的均衡配置；步骤四：对第四分支链路进行链路均衡配置时，第四分支链路的发送端通过下行设备中的自身电路将第三分支链路的发送端/接收端均衡参数进行接收写入，第四分支链路的发送端/接收端均衡参数直接调取第三分支链路的发送端/接收端均衡参数写入，进行对第四分支链路的均衡配置；步骤五：对第二分支链路进行链路均衡配置时，第二分支链路通过上行设备的自身电路，获取第一分支链路的发送端/接收端均衡参数，第二分支链路利用获取到的第一分支链路的发送端/接收端均衡参数进行均衡配置。在一些可行的实施例中，在首先以第四分支链路进行均衡配置时，所述方法包括：步骤一：获取第四分支链路和第二分支链路的长度信息，得到第四分支链路与第二分支链路的长度比，并存储至各分支链路对应的寄存器中；步骤二：对第四分支链路进行链路均衡训练和配置，获取得到第四分支链路的发送端/接收端均衡参数，并将获取到的发送端均衡参数保存到存储器中；步骤三：对第二分支链路进行链路均衡配置时，获取第四分支链路与第二分支链路的长度比，同时调取第四分支链路的发送端/接收端均衡参数，第四分支链路的发送端/接收端均衡参数结合第四分支链路和第二分支链路的链路长度比，直接写入第二分支链路中进行均衡配置，完成对第二分支链路的均衡配置；步骤四：对第三分支链路进行链路均衡配置时，第三分支链路的发送端通过下行设备中的自身电路将第四分支链路的发送端/接收端均衡参数进行接收写入，第三分支链路的发送端/接收端均衡参数直接调取第四分支链路的发送端/接收端均衡参数写入，进行对第三分支链路的均衡配置；步骤五：对第一分支链路进行链路均衡配置时，第一分支链路通过上行设备的自身电路，获取第二分支链路的发送端/接收端均衡参数，第一分支链路利用获取到的第二分支链路的发送端/接收端均衡参数进行均衡配置。在一些可行的实施例中，获得被均衡配置的分支链路的发送端/接收端的均衡配置参数的方法包括：利用PCLE链路训练码型或者通过外围设备对被分支链路的发送端/接收端进行均衡配置。在一些可行的实施例中，对所述被均衡配置的分支链路的接收端的配置方法包括：被均衡配置的分支链路的发送端通过自身电路以内置的默认的均衡配置参数进行均衡配置后，向着被均衡配置的分支链路的接收端进行发送初期链路训练码型；被均衡配置的分支链路的接收端收到初期链路训练码型，让所述初期链路训练码型通过被均衡配置的分支链路的接收端的自身电路进行均衡配置后，同时参照被均衡配置的分支链路的接收端的默认参数判定接收误码率是否满足阈值要求。在一些可行的实施例中，若被均衡配置的分支链路的接收端的默认参数判定接收误码率不满足阈值要求，则将与被均衡配置的分支链路的路径相反的分支链路的发送端通过自身分支链路进行反馈；与被均衡配置的分支链路的路径相反的分支链路的发送端通过自身分支链路反馈特殊码型至与被均衡配置的分支链路的相反对应的分支链路的接收端上，告知初期链路训练码型的均衡配置参数不满足要求，需要重新配置均衡参数；与被均衡配置的分支链路的路径相反的分支链路的接收端接到反馈的重新配置均衡参数的要求，与被均衡配置的分支链路的路径相反的分支链路的接收端通过自身电路根据特殊码型信息，通知被均衡配置的分支链路修改初期链路训练码型，然后再次发送修改后的链路训练码型，直至被均衡配置的分支链路的接收端满足误码率要求。在一些可行的实施例中，将被均衡配置分支链路的发送端/接收端的均衡配置参数结合被均衡配置的分支链路与预配置分支链路的长度比的方法包括：将被均衡配置分支链路的发送端/接收端的均衡配置参数定义为EQ1，将被均衡配置的分支链路与预配置分支链路的长度比定义为：系数a，则预均衡配置分支链路的发送端/接收端的均衡配置参数：EQ2=EQ1*a；其中，所述。本发明第二方面提供了一种基于链路两端均衡参数的EQ降低延时的系统，采用了第一方面所述的基于链路两端均衡参数的EQ降低延时方法,其中，上行设备包括：CPU芯片;中间设备包括：至少一个Retimer芯片；下行设备包括：终端芯片或显卡芯片；其中，所述上行设备、所述下行设备中均设置有寄存器，所述寄存器用于寄存各分支链路之间的长度比关系。在一些可行的实施例中，所述系统还包括：温度采集模块，所述温度采集模块用于监测所述系统工作环境；控制器，所述控制器获取所述温度采集模块的监测温度，用于调整各链路关系。本发明第三方面提供了一种基于链路两端均衡参数的EQ降低延时装置，采用了第二方面所述的一种基于链路两端均衡参数的EQ降低延时的系统，或实现第一方面所述的一种基于链路两端均衡参数的EQ降低延时方法。本发明的有益效果为：本发明在实施例中通过预先获取各分支链路的长度关系，而后对预先对一分支链路进行均衡配置，直接可通过预先配置的分支链路与其余各链路的长度关系结合，对预配置分支链路进行均衡配置，实现让预分支链路的发送端能够在粗调阶段进行直接配置，使发送端和接受端在协商过程中减少请求-响应的次数，以使协商过程尽快完成，到达减少均衡配置时间。也即实现各分支链路能够根据各自链路的长度进行自主调节均衡配置参数。附图说明图1为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法的整体结构示意图；图2为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法的一种实施应用示意图；图3为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法的另一实施应用示意图;图4为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法的整体流程图；图5为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法的整体流程图；图6为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法中的实施例二应用示意图；图7为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法中的实施例三应用示意图；图8为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法中接收端的配置应用示意图；图9为本发明实施例中提供的基于链路两端均衡参数的EQ降低延时方法中的接收端的具体配置应用示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明，本发明实施例中所有方向性指示仅用于解释在某一特定姿态下各部件之间的相对位置关系、运动情况等，如果该特定姿态发生改变时，则该方向性指示也相应地随之改变。在本发明中，除非另有明确的规定和限定，术语“连接”、“固定”等应做广义理解，例如，“固定”可以是固定连接，也可以是可拆卸连接，或成一体；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通或两个元件的相互作用关系，除非另有明确的限定。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。另外，若本发明实施例中有涉及“第一”、“第二”等的描述，则该“第一”、“第二”等的描述仅用于描述目的，而不能理解为指示或暗示其相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。另外，全文中出现的“和/或”的含义，包括三个并列的方案，以“A和/或B”为例，包括A方案、或B方案、或A和B同时满足的方案。另外，各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当认为这种技术方案的结合不存在，也不在本发明要求的保护范围之内。EQ在通信系统的基带或中频部分插入的，能够校正传输信道幅度频率特性和相位频率特性，减少码间干扰，起到补偿作用的滤波器。分为频域均衡器和时域均衡器。Retimer就类似于一个PHY芯片，其信号在经过Retimer的时候，通过内部的时钟重构信号，使其信号传输能量增加，然后再继续传输。Retimer是内部具有CDR的IC，实现数据的恢复之后然后再此按照串行通道把信号发送出去。可以减轻信号的抖动。因此Retimer能够实现比Redriver更好的降低物理损耗的效果，但是复杂的Retimer也会增加更多的延时。PCIe的链路训练指的是通过初始化PCIe链路的物理层、端口配置信息、发送接收模块以及相关的链路的状态，并了解链路对端的拓扑结构，最终让PCIe链路两端的设备进行数据通信的过程。参照图1-图9，本发明第一方面提供了一种基于链路两端均衡参数的EQ降低延时方法，所述方法包括：获取各分支链路的长度信息，并存储至各分支链路对应的寄存器中；对一分支链路进行均衡配置，获得被均衡配置的分支链路的发送端/接收端的均衡配置参数；获取被均衡配置的分支链路与预配置分支链路的长度比，同时获取被均衡配置分支链路的发送端/接收端的均衡配置参数；将被均衡配置分支链路的发送端/接收端的均衡配置参数结合被均衡配置的分支链路与预配置分支链路的长度比，获得预配置均衡参数；利用预配置均衡参数，对预配置分支链路直接进行均衡参数配置。在本实施例中，所述方法主要应用在PCIE链路初始配置阶段、变换阶段和重新均衡的情况下。首先第一分支链路进行链路均衡，将部分均衡参数保存到存储器中，写入与组件相关联的寄存器，结合寄存器中第一分支链路和其他分支链路的长度比，将具有线性度的均衡参数通过寄存器直接分配给其他分支链路，减少其他分支链路的链路均衡配置的时间。同理可以运用到第二分支链路和其他分支链路的链路均衡配置中。即在本实施例中，本发明通过预先获取各分支链路的长度关系，而后对预先对一分支链路进行均衡配置，直接可通过预先配置的分支链路与其余各链路的长度关系结合，对预配置分支链路进行均衡配置，实现让预分支链路的发送端能够在粗调阶段进行直接配置，使发送端和接受端在协商过程中减少请求-响应的次数，以使协商过程尽快完成，到达减少均衡配置时间。也即实现各分支链路能够根据各自链路的长度进行自主调节均衡配置参数。具体的，在本实施例中，所述方法包括：如图2，通过将上行设备来/回传输中间设备的链路分别定义为：第一分支链路/第二分支链路；即上行设备传输至中间设备中的链路定义为第一分支链路，将中间设备反馈传输至上行设备中的链路定义为第二分支链路。将中间设备来/回传输下行设备的链路分别定义为：第三分支链路/第四分支链路。即中间设备传输至下行设备中的链路定义为第三分支链路，将下行设备传输至中间设备中的链路定义为第四分支链路。所述方法还包括如下步骤：在首先以第一分支链路进行均衡配置时，所述方法包括：步骤一：获取第一分支链路和第三分支链路的长度信息，得到第一分支链路与第三分支链路的长度比，并存储至各分支链路对应的寄存器中；步骤二：利用任何一种高速Serdes的训练码型或者通过外围设备对第一分支链路进行链路均衡训练和配置，获取得到第一分支链路的发送端/接收端均衡参数，并将获取到的发送端均衡参数保存到存储器中；步骤三：对第三分支链路进行链路均衡配置时，获取第一分支链路与第三分支链路的长度比，同时调取第一分支链路的发送端/接收端均衡参数，第一分支链路的发送端/接收端均衡参数结合第一分支链路和第三分支链路的链路长度比，直接写入第三分支链路中进行均衡配置，完成对第三分支链路的均衡配置；步骤四：对第四分支链路进行链路均衡配置时，第四分支链路的发送端通过下行设备中的自身电路将第三分支链路的发送端/接收端均衡参数进行接收写入，第四分支链路的发送端/接收端均衡参数直接调取第三分支链路的发送端/接收端均衡参数写入，进行对第四分支链路的均衡配置；步骤五：对第二分支链路进行链路均衡配置时，第二分支链路通过上行设备的自身电路，获取第一分支链路的发送端/接收端均衡参数，第二分支链路利用获取到的第一分支链路的发送端/接收端均衡参数进行均衡配置。在首先以第四分支链路进行均衡配置时，所述方法包括：步骤一：获取第四分支链路和第二分支链路的长度信息，得到第四分支链路与第二分支链路的长度比，并存储至各分支链路对应的寄存器中；步骤二：利用任何一种高速Serdes的训练码型或者通过外围设备对第四分支链路进行链路均衡训练和配置，获取得到第四分支链路的发送端/接收端均衡参数，并将获取到的发送端均衡参数保存到存储器中；步骤三：对第二分支链路进行链路均衡配置时，获取第四分支链路与第二分支链路的长度比，同时调取第四分支链路的发送端/接收端均衡参数，第四分支链路的发送端/接收端均衡参数结合第四分支链路和第二分支链路的链路长度比，直接写入第二分支链路中进行均衡配置，完成对第二分支链路的均衡配置；步骤四：对第三分支链路进行链路均衡配置时，第三分支链路的发送端通过下行设备中的自身电路将第四分支链路的发送端/接收端均衡参数进行接收写入，第三分支链路的发送端/接收端均衡参数直接调取第四分支链路的发送端/接收端均衡参数写入，进行对第三分支链路的均衡配置；步骤五：对第一分支链路进行链路均衡配置时，第一分支链路通过上行设备的自身电路，获取第二分支链路的发送端/接收端均衡参数，第一分支链路利用获取到的第二分支链路的发送端/接收端均衡参数进行均衡配置。在本实施例中，将被均衡配置分支链路的发送端/接收端的均衡配置参数结合被均衡配置的分支链路与预配置分支链路的长度比的方法包括：将被均衡配置分支链路的发送端/接收端的均衡配置参数定义为EQ1，将被均衡配置的分支链路与预配置分支链路的长度比定义为：系数a，则预均衡配置分支链路的发送端/接收端的均衡配置参数：EQ2=EQ1*a；其中，所述。为了便于理解利用各分支链路的长度比进行均衡参数配置的方式。在此，以第一分支链路与第三分支链路之间的长度比的配置进行举例，根据分支链路均衡配置的线性特征及传输信道为线性时不变系统，因此整个端到端链路基本呈现线性关系，即遵循“损耗越大，EQ越强”的基本原则。根据这个原则在确定链路长度的前提下，可根据 X 长度的第一分支链路均衡训练配置后得出的均衡参数定义为EQ1，通过线性计算得到系数 a，然后得到EQ2 = a*EQ1，再将 EQ2 通过寄存器写入等方式赋值给第三分支链路中，实现对第三分支链路的均衡配置，代替执行第三分支链路均衡的粗调过程，达到减少链路均衡配置时间的目的。而后对第二分支链路、第四分支链路的均衡配置分别利用各分支链路自身的寄存器和自身电路直接调取第一分支链路和第二分支链路的发送端/接收端均衡配置参数进行第二分支链路、第四分支链路的均衡参数配置。实施例一：在本实施例中，如图2和图3所示，将上行设备定义为CPU、中间设备定义为Retimer、下行设备定义为Endpoint。将第一分支链路和第三分支链路，第二分支链路和第四分支链路的链路长度信息存储到各自对应的寄存器中中。当各分支链路开始建立通信，第一分支链路利用PCLE链路训练码型或者通过外围设备正常进行链路均衡，将第一分支链路的发送端的均衡参数存储在存储器中。第三分支链路的寄存器读取存储器写入的第一分支链路的发送端的均衡参数，结合第一分支链路和第三分支链路的链路长度比，将第三分支链路发送端对应的均衡参数直接写入，代替执行的第三分支链路均衡的粗调过程，达到减少链路均衡配置时间的目的。同理，可以第二分支链路和第四分支链路的均衡配置过程。实施例二参照图6，本实例应用于第一分支链路、二分支链路和第三分支链路、四分支链路所在子系统的工作环境不同或者散热条件不同的场合。各分支链路的信道损耗与链路的温度呈正比，当环境温度越高，PCIE信道损耗越高。这种情况下，链路的初始均衡配置就不是最优配置。本实施例通过控制器监控温度采集模块对应的各子系统的温度，当子系统的温度与链路初始配置时的温度相差较大，或者两个子系统的温度差异明显扩大时，对链路进行重新均衡配置。控制器将两个子系统的温度信息写入存储器中，按照实施例一中所述方法重新进行均衡配置，达到链路对工作环境变化的自我适应，自我调整的目的。在本实施例中，为保证所述一种基于链路两端均衡参数的EQ降低延时方法能够根据工作环境温度进行设置相应的调节系数，在此进行调节系数的实际证明操作：在一种可行的实施例中，所述温度调节系数评测方法如下：1、制作一块 PCB，其上设计有 1inch，5inch，10inch 长度的走线，走线两端为测试点；2、使用两端口网络分析仪分别点测在以上走线两端；3、分别在 -40℃、25℃、85℃等温度下记录 step2 下的测量损耗值；4、用损耗值除以长度并做算数平均，得到单位长度在不同温度下的损耗值；5、将25℃作为系数 1，即可通过其他温度与该温度的损耗比值得出相应系数。有上述评测方法可得到如下表格：即，在本实施例中，为方便于理解如何利用检测到的温度值进行得到优化的均衡配置参数。在此进行举例，在此举例中，为便于区分链路两端的系数均衡配比，将与被均衡配置的分支链路对比的预配置分支链路上的发送端调整系数定义为a，将与被均衡配置的分支链路对比的预配置分支链路上的发送端调整系数为b，其中a=b。当温度检测模块检测到温度为-40℃时，对应的损耗系数为0.9，此时预配置分支链路上的损耗系数分配具备下列情况：一、只在发送端a上进行损耗系数分配，即与被均衡配置的分支链路对比的预配置分支链路中的两端均衡参数配置为0.9a、b；二、只在接收端b上进行损耗系数分配，即与被均衡配置的分支链路对比的预配置分支链路中的两端均衡参数配置为a、0.9b；发送端a、发生端b均进行损耗系数分配，即与被均衡配置的分支链路对比的预配置分支链路中的两端均衡参数配置为。实施例三本发明提供的一种基于链路两端均衡参数的EQ降低延时方法，在本实施例中还可以应用于级联Retimer芯片，即如图8所示，所述中间设备包括两个或两个以上的级联Retimer芯片，通过第一分支链路的初始配置信息，快速完成第三、第五分支链路的均衡配置。同理可以推广第二分支链路和第四、第六分支链路的均衡配置。同理可以推广到其他链路中不同分支链路的均衡配置。在本实施例中，为了进一步确保对被均衡配置分支链路的接收端的均衡参数准确性和实现最优。参照图8，对所述被均衡配置的分支链路的接收端的配置方法包括：被均衡配置的分支链路的发送端通过自身电路以内置的默认的均衡配置参数进行均衡配置后，向着被均衡配置的分支链路的接收端进行发送初期链路训练码型；被均衡配置的分支链路的接收端收到初期链路训练码型，让所述初期链路训练码型通过被均衡配置的分支链路的接收端的自身电路进行均衡配置后，同时参照被均衡配置的分支链路的接收端的默认参数判定接收误码率是否满足阈值要求；若被均衡配置的分支链路的接收端的默认参数判定接收误码率不满足阈值要求，则将与被均衡配置的分支链路的路径相反的分支链路的发送端通过自身分支链路进行反馈；与被均衡配置的分支链路的路径相反的分支链路的发送端通过自身分支链路反馈特殊码型至与被均衡配置的分支链路的相反对应的分支链路的接收端上，告知初期链路训练码型的均衡配置参数不满足要求，需要重新配置均衡参数；与被均衡配置的分支链路的路径相反的分支链路的接收端接到反馈的重新配置均衡参数的要求，与被均衡配置的分支链路的路径相反的分支链路的接收端通过自身电路根据特殊码型信息，通知被均衡配置的分支链路修改初期链路训练码型，然后再次发送修改后的链路训练码型，直至被均衡配置的分支链路的接收端满足误码率要求。需要说明的是，所述初期训练码型为利用任何一种高速Serdes的训练码型。即在本实施例中，为了便于理解上述，对所述均衡配置的分支链路的接收端的配置方法，在此以上述的第一分支链路和第二分支链路进行举例说明：在第一分支链路进行均衡配置阶段，RC在第一分支链路的发送端 TX 经由自身FFE 电路以默认 FFE 参数均衡后，向RT上的第一分支链路的接收端RX发送初期链路训练码型；RT上的第一分支链路接收端 RX 收到初期链路训练码型，经由自身 CTLE / DFE电路及对应默认参数均衡后，判定接收误码率是否满足阈值要求；如判定不满足，RT上的第二分支链路的发送端 TX 通过第二分支链路发送特殊码型至RC上的第二分支链路的接收端 RX上，告知其 FFE 默认参数不满足要求，需要调整为其他参数；RC 的第二分支链路上的接收端 RX 收到 RT 反馈的要求，根据其码型信息通知其第一分支链路上的发送端TX 修改FFE参数，然后再次发送修改后的链路训练码型，如此反复直至RT上的第一分支链路接收端误码率满足要求。本发明第二方面还提供了一种基于链路两端均衡参数的EQ降低延时的系统，采用了第一方面中所述的基于链路两端均衡参数的EQ降低延时方法，所述上行设备包括：CPU芯片;所述中间设备包括：至少一个Retimer芯片；所述下行设备包括：终端芯片或显卡芯片；其中，所述上行设备、所述下行设备中均设置有寄存器，所述寄存器用于寄存各分支链路之间的长度比关系。在一种可行的实施例中，为了实现对上行设备、下行设备和中间设备的工作环境温度进行实时监测，所述系统还包括：控制器和温度采集模块。所述温度采集模块用于监测所述系统工作环境。所述控制器获取所述温度采集模块的监测温度，用于调整各链路关系。即所述控制器通过获取监测温度，选择不同的温度调节系数。本发明第三方面还提供了一种基于链路两端均衡参数的EQ降低延时装置，采用上述中第二方面所述的一种基于链路两端均衡参数的EQ降低延时的系统，或实现第一方面所述的一种基于链路两端均衡参数的EQ降低延时方法。特别地，根据本公开的一些实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本公开的一些实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。需要说明的是，本公开的一些实施例中记载的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本公开的一些实施例中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本公开的一些实施例中，计算机可读信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读信号介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：电线、光缆、RF等等，或者上述的任意合适的组合。本发明第四方面提供了一种电子设备，包括：一个或多个处理器；存储装置，其上存储有一个或多个程序；当所述一个或多个程序被所述一个或多个处理器执行，使得所述一个或多个处理器实现如第一方面所述的方法。在一些实施方式中，所述处理系统可以利用诸如HTTP之类的任何当前已知或未来研发的网络协议进行通信，并且可以与任意形式或介质的数字数据通信互连。通信网络的示例包括局域网，广域网，网际网以及端对端网络，以及任何当前已知或未来研发的网络。上述计算机可读介质可以是上述电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被该电子设备执行时，使得该电子设备。可以以一种或多种程序设计语言或其组合来编写用于执行本公开的一些实施例的操作的计算机程序代码，上述程序设计语言包括面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网——连接到用户计算机，或者，可以连接到外部计算机。附图中的流程图和框图，图示了按照本公开各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，该模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。本文中以上描述的功能可以至少部分地由一个或多个硬件逻辑部件来执行。例如，非限制性地，可以使用的示范类型的硬件逻辑部件包括：现场可编程门阵列、专用集成电路、专用标准产品、片上系统、复杂可编程逻辑设备等等。即本发明第五方面提供了一种计算机可读介质，其上存储有计算机程序，其中，所述程序被处理器执行时实现如第一方面所述的方法。本发明第六方面提供了一种计算机程序产品，包括计算机程序，所述计算机程序在被处理器执行时实现如第一方面所述的方法。以上描述仅为本公开的一些较佳实施例以及对所运用技术原理的说明。本领域技术人员应当理解，本公开的实施例中所涉及的发明范围，并不限于上述技术特征的特定组合而成的技术方案，同时也应涵盖在不脱离上述发明构思的情况下，由上述技术特征或其等同特征进行任意组合而形成的其它技术方案。例如上述特征与本公开的实施例中公开的具有类似功能的技术特征进行互相替换而形成的技术方案。
