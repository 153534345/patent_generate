标题title
一种基于拓扑优化的无人机集群联邦学习模型优化方法
摘要abst
本发明公开了一种基于拓扑优化的无人机集群联邦学习模型优化方法，本发明面向无人机集群，根据带宽分配、计算时延、通信时延以及拓扑设计的约束条件，最小化无人机集群联邦学习每一轮的能量消耗和时延的加权和；进而获得每一轮无人机集群对应的关于模型参数传输的拓扑结构，基于拓扑结构，各跟随无人机的本地联邦学习模型参数传输至领头无人机；领头无人机进行参数聚合并更新，获得下一轮迭代中的全局联邦学习模型参数，当全局联邦学习模型参数对应的联邦学习模型精度达到要求，则获得无人机集群对应的联邦学习模型。本发明显著加快联邦学习过程，大大提高了无人机集群联邦学习的鲁棒性，使联邦学习能够更好地适应网络拓扑高动态的无人机集群。
权利要求书clms
1.一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，针对由领头无人机和与其通信的预设数量跟随无人机构成的无人机集群，基于各跟随无人机具有模型训练能力及本地数据集，通过以下步骤，获得无人机集群对应的联邦学习模型：步骤1：领头无人机将全局联邦学习模型参数广播至各跟随无人机，并判断全局联邦学习模型参数对应的联邦学习模型精度是否达到预设要求，若达到预设要求，迭代结束，则当前全局联邦学习模型参数对应的联邦学习模型作为无人机集群对应的联邦学习模型；若未达到预设要求，执行步骤2；步骤2：分别针对各跟随无人机，跟随无人机基于本地数据集、结合领头无人机广播的全局联邦学习模型参数进行联邦学习模型训练，完成训练后，获得各跟随无人机分别对应的本地联邦学习模型参数；执行步骤3；步骤3： 领头无人机基于当前无人机集群的能量消耗和时延，构建无人机集群对应的关于模型参数传输的拓扑结构，各跟随无人机基于拓扑结构，将本地联邦学习模型参数传输至领头无人机；执行步骤4；步骤4：领头无人机针对接收的各本地联邦学习模型参数，进行参数聚合并更新，获得下一轮迭代中的全局联邦学习模型参数，返回执行步骤1。2.根据权利要求1所述一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，所述步骤1中，判断联邦学习模型参数对应的联邦学习模型精度是否达到预设要求，通过全局损失函数与预设迭代次数进行判断，若全局损失函数收敛或达到预设迭代次数时，则联邦学习模型参数对应的联邦学习模型精度达到预设要求；否则联邦学习模型参数对应的联邦学习模型精度没有达到预设要求；全局损失函数如下所示；，式中，表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机总数；/＞表示全局联邦学习模型参数；/＞表示全局联邦学习模型参数为/＞下第/＞个数据样本的样本损失函数。3.根据权利要求1所述一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，所述步骤2中，跟随无人机基于本地数据集、结合领头无人机广播的联邦学习模型参数进行联邦学习模型训练时，通过以下公式，更新联邦学习模型参数，获得本地联邦学习模型参数；，式中，表示跟随无人机/＞在第/＞轮迭代中利用本地数据集训练获得的本地联邦学习模型参数；/＞表示第/＞轮迭代中跟随无人机广播的全局联邦学习模型参数；/＞表示预设学习率；表示全局联邦学习模型参数为/＞下跟随无人机/＞的本地联邦学习模型损失函数。4.根据权利要求1所述一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，所述步骤3中，包括以下步骤：步骤3.1：领头无人机基于当前无人机集群的能量消耗和时延，构建目标函数；步骤3.2：领头无人机基于目标函数，结合关于带宽、计算和通信时间、拓扑连接的约束条件，以目标函数最小化为目标，构建获得无人机集群对应的关于模型参数传输的树形拓扑结构，该树形拓扑结构以领头无人机作为根节点；步骤3.3：基于无人机集群对应的树形拓扑结构，以叶子节点对应的跟随无人机为起点，基于树形拓扑结构向根节点方向传输跟随无人机对应的本地联邦学习模型参数直至传输至领头无人机；树形拓扑结构中各节点对应的跟随无人机将接收的本地联邦学习模型参数与其本地联邦学习模型参数进行参数聚合，参数聚合后获得的模型参数更新为该节点跟随无人机的本地联邦学习模型参数。5.根据权利要求4所述一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，所述步骤3.1中，目标函数公式如下：，式中，，/＞，/＞，，其中，表示跟随无人机/＞的计算能耗；/＞表示跟随无人机/＞的计算时延；/＞表示跟随无人机/＞的通信能耗；/＞表示跟随无人机/＞的通信时延；/＞表示跟随无人机总数；/＞表示预设加权因子；/＞表示取决于芯片架构的系数；/＞表示第/＞轮迭代中跟随无人机/＞进行的本地训练轮次；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机/＞处理每个训练数据样本所需的浮点运算数；/＞表示跟随无人机/＞的计算速度；/＞表示跟随无人机/＞上传的模型参数数据量大小；/＞表示跟随无人机/＞的传输功率；/＞表示分配给跟随无人机/＞的子带宽；/＞表示除跟随无人机/＞之外的跟随无人机集合；/＞表示指示符，/＞表示跟随无人机/＞将其本地模型参数传输到跟随无人机/＞，/＞表示跟随无人机/＞没有将其本地模型参数传输到跟随无人机/＞；/＞表示路径损耗常数，/＞表示参考距离；/＞表示跟随无人机/＞和跟随无人机/＞之间的距离；/＞表示路径系数；/＞表示跟随无人机/＞处的信道噪声。6.根据权利要求5所述一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，所述步骤3.2中，关于带宽、计算和通信时间、拓扑连接的约束条件，具体如下：约束1：；约束2：；约束3：；式中，表示领头无人机可分配的总带宽；/＞表示跟随无人机可以分配到的最大通信子带宽；/＞表示领头无人机。7.根据权利要求5所述一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，所述步骤3.3中，树形拓扑结构中各节点对应的跟随无人机将接收的本地联邦学习模型参数与其本地联邦学习模型参数进行参数聚合，参数聚合后获得的模型参数更新为该节点跟随无人机的本地联邦学习模型参数，聚合公式如下；，其中，表示跟随无人机/＞进行参数聚合后获得的模型参数；/＞表示跟随无人机/＞进行参数聚合后获得的模型参数；/＞表示跟随无人机/＞处的聚合模型参数的个数；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机/＞的原联邦学习模型参数。8.根据权利要求1所述一种基于拓扑优化的无人机集群联邦学习模型优化方法，其特征在于，所述步骤4中，领头无人机针对接收的各本地联邦学习模型参数，通过以下公式，进行参数聚合并更新，获得下一轮迭代中的全局联邦学习模型参数：，式中，表示第/＞次迭代中的全局联邦学习模型参数；/＞表示基于无人机集群对应的关于模型参数传输的拓扑结构中与领头无人机相连的跟随无人机总数；/＞表示基于无人机集群对应的关于模型参数传输的拓扑结构中与领头无人机相连的跟随无人机；/＞表示跟随无人机/＞在第/＞轮迭代中的本地联邦学习模型参数；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示/＞个跟随无人机的本地数据集样本总数。
说明书desc
技术领域本发明属于无人机集群边缘智能技术领域，具体涉及一种基于拓扑优化的无人机集群联邦学习模型优化方法。背景技术由于无人机具有灵活、机动、自适应程度高、成本低等独特优势，在传感、目标跟踪、数据采集、提供通信服务等方面被认为是下一代网络中很有前途的技术。未来的无线网络需要无人机集群智能自主地执行任务，如远程监控和移动边缘计算。虽然通过将所有数据都需要传输到云数据中心并在其中进行机器学习 模型训练和推理的方式能够赋予无人机群智能的能力，但是这种方式并不适用于无人机集群，存在以下缺点：将图像和视频等巨大原始数据传输会消耗大量带宽和能量；原始感知数据会包含大量敏感信息，可能导致严重的隐私泄露和数据滥用；传统云计算难以满足无人机集群进行实时任务的低时延需求。分布式联邦学习能够为上述问题提供可行的解决方案；而现有的联邦学习范例大多仍然是集中式的，即一个中心实体负责整个网络上的机器学习模型聚合和融合，而在无人机集群中，节点和链路都不稳定，同时无人机的动态连接和离开导致网络拓扑变化，整个联邦学习造成影响。虽然有方法针对相关问题提出不需要中央服务器的无人机分布式联邦学习，但并不完全适用，存在以下缺点：缺乏中央控制器对整个学习过程进行收敛判断和调控；每个无人机会承担额外的聚合和传输任务，浪费无人机有限的能量；实际应用中的无人机集群往往存在领头无人机，而异构的无人机集群会拖慢联邦学习的收敛速度。发明内容本发明提出了一种基于拓扑优化的无人机集群联邦学习模型优化方法，不同于常规集中式的联邦学习方法需要每个节点都直接于中心服务器相连接以进行模型参数的传输和聚合，本发明基于领头无人机对整个学习过程进行收敛判断和调控，动态的调整每架跟随无人机本地模型参数的聚合路线和无人机集群联邦学习的拓扑结构，实现跟随无人机跟随领头无人机进行智能化任务，节约了无人机有限的能量，可以显著加快联邦学习过程，大大提高了无人机集群联邦学习的鲁棒性，优化无人机集群联邦学习的整体性能。本发明采用以下技术方案：一种基于拓扑优化的无人机集群联邦学习模型优化方法，针对由领头无人机和与其通信的预设数量跟随无人机构成的无人机集群，基于各跟随无人机具有模型训练能力及本地数据集，通过以下步骤，获得无人机集群对应的联邦学习模型：步骤1：领头无人机将全局联邦学习模型参数广播至各跟随无人机，并判断全局联邦学习模型参数对应的联邦学习模型精度是否达到预设要求，若达到预设要求，迭代结束，则当前全局联邦学习模型参数对应的联邦学习模型作为无人机集群对应的联邦学习模型；若未达到预设要求，执行步骤2；步骤2：分别针对各跟随无人机，跟随无人机基于本地数据集、结合领头无人机广播的全局联邦学习模型参数进行联邦学习模型训练，完成训练后，获得各跟随无人机分别对应的本地联邦学习模型参数；执行步骤3；步骤3： 领头无人机基于当前无人机集群的能量消耗和时延，构建无人机集群对应的关于模型参数传输的拓扑结构，各跟随无人机基于拓扑结构，将本地联邦学习模型参数传输至领头无人机；执行步骤4；步骤4：领头无人机针对接收的各本地联邦学习模型参数，进行参数聚合并更新，获得下一轮迭代中的全局联邦学习模型参数，返回执行步骤1。作为本发明的一种优选技术方案，所述步骤1中，判断联邦学习模型参数对应的联邦学习模型精度是否达到预设要求，通过全局损失函数与预设迭代次数进行判断，若全局损失函数收敛或达到预设迭代次数时，则联邦学习模型参数对应的联邦学习模型精度达到预设要求；否则联邦学习模型参数对应的联邦学习模型精度没有达到预设要求；全局损失函数如下所示；，式中，表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机总数；/＞表示全局联邦学习模型参数；/＞表示全局联邦学习模型参数为/＞下第/＞个数据样本的样本损失函数。作为本发明的一种优选技术方案，所述步骤2中，跟随无人机基于本地数据集、结合领头无人机广播的联邦学习模型参数进行联邦学习模型训练时，通过以下公式，更新联邦学习模型参数，获得本地联邦学习模型参数；，式中，表示跟随无人机/＞在第/＞轮迭代中利用本地数据集训练获得的本地联邦学习模型参数；/＞表示第/＞轮迭代中跟随无人机广播的全局联邦学习模型参数；/＞表示预设学习率；/＞表示全局联邦学习模型参数为/＞下跟随无人机/＞的本地联邦学习模型损失函数。作为本发明的一种优选技术方案，所述步骤3中，包括以下步骤：步骤3.1：领头无人机基于当前无人机集群的能量消耗和时延，构建目标函数；步骤3.2：领头无人机基于目标函数，结合关于带宽、计算和通信时间、拓扑连接的约束条件，以目标函数最小化为目标，构建获得无人机集群对应的关于模型参数传输的树形拓扑结构，该树形拓扑结构以领头无人机作为根节点；步骤3.3：基于无人机集群对应的树形拓扑结构，以叶子节点对应的跟随无人机为起点，基于树形拓扑结构向根节点方向传输跟随无人机对应的本地联邦学习模型参数直至传输至领头无人机；树形拓扑结构中各节点对应的跟随无人机将接收的本地联邦学习模型参数与其本地联邦学习模型参数进行参数聚合，参数聚合后获得的模型参数更新为该节点跟随无人机的本地联邦学习模型参数。作为本发明的一种优选技术方案，所述步骤3.1中，目标函数公式如下：，式中，，/＞，/＞，，其中，表示跟随无人机/＞的计算能耗；/＞表示跟随无人机/＞的计算时延；表示跟随无人机/＞的通信能耗；/＞表示跟随无人机/＞的通信时延；/＞表示跟随无人机总数；/＞表示预设加权因子；/＞表示取决于芯片架构的系数；/＞表示第/＞轮迭代中跟随无人机/＞进行的本地训练轮次；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机/＞处理每个训练数据样本所需的浮点运算数；/＞表示跟随无人机/＞的计算速度；/＞表示跟随无人机/＞上传的模型参数数据量大小；/＞表示跟随无人机/＞的传输功率；/＞表示分配给跟随无人机/＞的子带宽；/＞表示除跟随无人机/＞之外的跟随无人机集合；/＞表示指示符，/＞表示跟随无人机/＞将其本地模型参数传输到跟随无人机/＞，/＞表示跟随无人机/＞没有将其本地模型参数传输到跟随无人机/＞；/＞表示路径损耗常数，/＞表示参考距离；/＞表示跟随无人机/＞和跟随无人机/＞之间的距离；/＞表示路径系数；/＞表示跟随无人机/＞处的信道噪声。作为本发明的一种优选技术方案，所述步骤3.2中，关于带宽、计算和通信时间、拓扑连接的约束条件，具体如下：约束1：；约束2：；约束3：；式中，表示领头无人机可分配的总带宽；/＞表示跟随无人机可以分配到的最大通信子带宽；/＞表示领头无人机。作为本发明的一种优选技术方案，所述步骤3. 3中，树形拓扑结构中各节点对应的跟随无人机将接收的本地联邦学习模型参数与其本地联邦学习模型参数进行参数聚合，参数聚合后获得的模型参数更新为该节点跟随无人机的本地联邦学习模型参数，聚合公式如下；，其中，表示跟随无人机/＞进行参数聚合后获得的模型参数；/＞表示跟随无人机/＞进行参数聚合后获得的模型参数；/＞表示跟随无人机/＞处的聚合模型参数的个数；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机/＞的原联邦学习模型参数。作为本发明的一种优选技术方案，所述步骤4中，领头无人机针对接收的各本地联邦学习模型参数，通过以下公式，进行参数聚合并更新，获得下一轮迭代中的全局联邦学习模型参数：，式中，/＞表示第/＞次迭代中的全局联邦学习模型参数；/＞表示基于无人机集群对应的关于模型参数传输的拓扑结构中与领头无人机相连的跟随无人机总数；/＞表示基于无人机集群对应的关于模型参数传输的拓扑结构中与领头无人机相连的跟随无人机；/＞表示跟随无人机/＞在第/＞轮迭代中的本地联邦学习模型参数；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示/＞个跟随无人机的本地数据集样本总数。本发明的有益效果是：本发明提供了一种基于拓扑优化的无人机集群联邦学习模型优化方法，本发明基于拓扑优化的无人机集群联邦学习优化方法，面向无人机集群，在考虑无人机集群高移动性、可用性、同时性和可扩展性等特征，对领头无人机具有苛刻信道条件的跟随无人机可以灵活地选择附近具有有利信道的设备来聚合和转发其本地模型参数，根据带宽分配、计算时延、通信时延以及拓扑设计的约束条件，最小化无人机集群联邦学习每一轮的能量消耗和时延的加权和。并且动态的调整每架跟随无人机本地模型参数的聚合路线和无人机集群联邦学习的拓扑结构，避免了由于信道衰落，某些跟随无人机和领头无人机之间的连接可能会在某些迭代回合中遭受深度衰落的高能耗、高延迟传输，节约了无人机有限的能量，实现更高的能量效率。另外，通过本发明的方法来实现跟随无人机跟随领头无人机进行智能化任务，可以显著加快联邦学习过程，大大提高了无人机集群联邦学习的鲁棒性，同时也能提高无人机集群中联邦学习的灵活性和敏捷性，使联邦学习能够更好地适应网络拓扑高动态的无人机集群。附图说明图1为本发明的基于拓扑优化的无人机集群联邦学习场景示意图；图2为本发明中的无人机模块架构图；图3为本发明的基于拓扑优化的无人机集群联邦学习优化方法流程图；图4为本发明中的跟随无人机个体聚合拓扑优化的执行流程图。具体实施方式下面结合附图对本发明进行进一步说明。下面的实施例可使本专业技术人员更全面地理解本发明，但不以任何方式限制本发明。一种基于拓扑优化的无人机集群联邦学习模型优化方法，针对由领头无人机和与其通信的预设数量跟随无人机构成的无人机集群，基于各跟随无人机具有模型训练能力及本地数据集，通过以下步骤，获得无人机集群对应的联邦学习模型。本实施例中，联邦学习中模型参数的具体数据是由模型决定的，训练的模型不同，那么模型参数也就不同，本实施例中模型参数包括权重参数、偏置参数、正则化参数，权重参数是神经网络中的参数，用于计算神经元的输出。在联邦学习中，权重参数是模型的主要参数，它们的更新是通过跟随无人机上的训练来实现的。在每一轮训练结束后，本地设备将更新后的权重参数发送给领头无人机，领头无人机将这些参数进行平均化，并将平均化后的参数发送回每个跟随无人机。偏置参数是神经网络中的参数，用于调整神经元的输出。在联邦学习中，偏置参数通常与权重参数一起训练和更新。正则化参数的正则化是一种技术，用于避免模型过拟合。在联邦学习中，正则化参数通常与权重参数一起训练和更新。联邦学习中无人机集群对应的联邦学习模型可以采用各种神经网络模型结构，具体的选择取决于任务要求、数据特征和计算资源等因素。如采用用于进行图像识别的神经网络，通过联邦学习训练过程获得图像识别模型作为无人机集群对应的联邦学习模型。各跟随无人机采集图像作为本地数据集进行各跟随无人机分别对应的本地联邦学习模型训练。除此之外，还有许多其他的神经网络模型，如深度信念网络、自动编码器网络等，这些模型都可以在联邦学习中得到应用。本实施例中，我们考虑个跟随无人机的集合在领头无人机的管理下执行联邦学习任务。联邦学习过程包括迭代本地模型计算，上传和全局模型更新。无人机之间的数据通信是通过无线链路进行的。假设领头无人机对无线信道增益和跟随无人机的计算特性具有完善的知识，可以通过反馈获得。本方法如图3所示，通过步骤1-步骤4，获得无人机集群对应的联邦学习模型。步骤1：领头无人机将全局联邦学习模型参数广播至各跟随无人机，并判断全局联邦学习模型参数对应的联邦学习模型精度是否达到预设要求，若达到预设要求，迭代结束，则当前全局联邦学习模型参数对应的联邦学习模型作为无人机集群对应的联邦学习模型；若未达到预设要求，执行步骤2。本实施例中，全局联邦学习模型参数初始值为领头无人机初始化获得。所述步骤1中，判断联邦学习模型参数对应的联邦学习模型精度是否达到预设要求，通过全局损失函数与预设迭代次数进行判断，若全局损失函数收敛或达到预设迭代次数时，则联邦学习模型参数对应的联邦学习模型精度达到预设要求；否则联邦学习模型参数对应的联邦学习模型精度没有达到预设要求；全局损失函数如下所示；，式中，/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机总数；/＞表示全局联邦学习模型参数；/＞表示全局联邦学习模型参数为/＞下第/＞个数据样本的样本损失函数。步骤2：分别针对各跟随无人机，跟随无人机基于本地数据集、结合领头无人机广播的全局联邦学习模型参数进行联邦学习模型训练，完成训练后，获得各跟随无人机分别对应的本地联邦学习模型参数；执行步骤3。所述步骤2中，跟随无人机基于本地数据集、结合领头无人机广播的联邦学习模型参数进行联邦学习模型训练时，通过以下公式，更新联邦学习模型参数，获得本地联邦学习模型参数：，式中，/＞表示跟随无人机/＞在第/＞轮迭代中利用本地数据集训练获得的本地联邦学习模型参数；/＞表示第/＞轮迭代中跟随无人机广播的全局联邦学习模型参数；/＞表示预设学习率；/＞表示全局联邦学习模型参数为/＞下跟随无人机/＞的本地联邦学习模型损失函数；/＞表示向量微分算符，在高数中代表梯度算符。在第t轮训练中跟随无人机在收到领头无人机广播的模型参数/＞后，会在本地使用本地数据集独立完成对部分模型参数的更新。步骤3：领头无人机基于当前无人机集群的能量消耗和时延，构建无人机集群对应的关于模型参数传输的拓扑结构，各跟随无人机基于拓扑结构，将本地联邦学习模型参数传输至领头无人机；执行步骤4。所述步骤3中，包括以下步骤：步骤3.1：领头无人机基于当前无人机集群的能量消耗和时延，构建目标函数；所述步骤3.1中，目标函数公式如下：，式中，，/＞，/＞，，其中，表示跟随无人机/＞的计算能耗；/＞表示跟随无人机/＞的计算时延；表示跟随无人机/＞的通信能耗；/＞表示跟随无人机/＞的通信时延；/＞表示跟随无人机总数；/＞表示预设加权因子；/＞表示取决于芯片架构的系数；/＞表示第/＞轮迭代中跟随无人机/＞进行的本地训练轮次；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机/＞处理每个训练数据样本所需的浮点运算数；/＞表示跟随无人机/＞的计算速度；/＞表示跟随无人机/＞上传的模型参数数据量大小；/＞表示跟随无人机/＞的传输功率；/＞表示分配给跟随无人机/＞的子带宽；/＞表示除跟随无人机/＞之外的跟随无人机集合；/＞表示指示符，/＞表示跟随无人机/＞将其本地模型参数传输到跟随无人机/＞，/＞表示跟随无人机/＞没有将其本地模型参数传输到跟随无人机/＞；/＞表示路径损耗常数，/＞表示参考距离；/＞表示跟随无人机/＞和跟随无人机/＞之间的距离；/＞表示路径系数；/＞表示跟随无人机/＞处的信道噪声。无人机集群对应的关于模型参数传输的拓扑结构，具体为跟随无人机判断是否需要协助其他跟随无人机聚合传输本地模型参数和选择是否附近跟随无人机来聚合和转发其本地模型参数至领头无人机；流程如图4所示，包括以下流程：跟随无人机通过接收来自其他跟随无人机的拓扑选择信号，来判断是否需要协助其他跟随无人机聚合和转发其本地模型参数至领头无人机；若需要协助其他跟随无人机聚合和转发其本地模型参数至领头无人机，则先接收其他跟随无人机的本地模型参数与自身的本地模型参数进行聚合；否则直接进行下一步；跟随无人机进行拓扑选择，判断是否选择附近的跟随无人机/＞来聚合和转发其本地模型参数至领头无人机。定义作为拓扑选择信号指示符，唯一地指定了无人机集群联邦学习系统中的模型参数传输和聚合拓扑，如果跟随无人机/＞将其本地模型参数传输到跟随无人机/＞，则等于1，否则为0。拓扑选择信号指示符由领头无人机基于当前无人机集群的能量消耗和时延，构建无人机集群对应的关于模型参数传输的拓扑结构提供。进一步的，在设计拓扑选择的时候，即跟随无人机/＞在判断是否选择附近的跟随无人机/＞来聚合和转发其本地模型参数至领头无人机时，根据带宽分配、计算时延、通信时延以及拓扑设计的约束条件下，最小化无人机集群联邦学习每一轮的能量消耗和时延的加权和，如步骤3.2所示。所述每一轮的能量消耗包括：/＞架跟随无人机的总计算能耗和/＞架跟随无人机的总通信能耗；所述每一轮的总时延包括：/＞架跟随无人机的总计算时延和/＞架跟随无人机的总通信时延。步骤3.2：领头无人机基于目标函数，结合关于带宽、计算和通信时间、拓扑连接的约束条件，以目标函数最小化为目标，构建获得无人机集群对应的关于模型参数传输的树形拓扑结构，该树形拓扑结构以领头无人机作为根节点。所述步骤3.2中，关于带宽、计算和通信时间、拓扑连接的约束条件，具体如下：约束1：对所有无人机的带宽约束具体为：；约束2：对所有连接的无人机之间的计算和通信时间约束具体为：；其中，作为聚合转发的跟随无人机  应该从其相邻无人机接收并聚合本地模型参数，因此它只能在从具有/＞的跟随无人机/＞接收到所有模型参数后才开始传输。如果跟随无人机/＞的本地计算时间短于跟随无人机/＞的本地计算时间加上传输时间，则其必须有额外的等待时间，显然最优情况下额外等待时间必须为0，在这种情况下我们可以降低跟随无人机/＞的计算速度以减少能量消耗；约束3：对无人机拓扑约束具体为：；其中，假设每个跟随无人机只能将其本地模型参数传输到一个跟随无人机，并且至少有一个跟随无人机直接连接到领头无人机。所以将无人机集群联邦学习系统的拓扑定义为树形拓扑，该树形拓扑保证了所有局部模型参数聚合一次且仅聚合一次；式中，表示领头无人机可分配的总带宽；/＞表示跟随无人机可以分配到的最大通信子带宽；/＞表示领头无人机。步骤3.3：基于无人机集群对应的树形拓扑结构，以叶子节点对应的跟随无人机为起点，基于树形拓扑结构向根节点方向传输跟随无人机对应的本地联邦学习模型参数直至传输至领头无人机；树形拓扑结构中各节点对应的跟随无人机将接收的本地联邦学习模型参数与其本地联邦学习模型参数进行参数聚合，参数聚合后获得的模型参数更新为该节点跟随无人机的本地联邦学习模型参数。该拓扑结构如图1所示，图1所为基于拓扑优化的无人机集群联邦学习模型优化方法场景示意图。在示意场景中，领头无人机作为中央服务器接收其他无人机的本地模型进行模型聚合；对于1号无人机、4号无人机和6号无人机而言，它们分别与领头无人机直接建立无线链路以传输本地模型；对于3号无人机和5号无人机而言，分别灵活地选择附近具有有利信道的2号无人机和4号无人机来聚合和转发其梯度至领头无人机；对于2号无人机而言，它不仅需要接收来自3号无人机传输的本地模型，并在此基础上进行模型更新，之后选择将聚合更新后的本地模型转发到附近1号无人机来聚合和转发其梯度至领头无人机。所述步骤3.3中，树形拓扑结构中各节点对应的跟随无人机将接收的本地联邦学习模型参数与其本地联邦学习模型参数进行参数聚合，参数聚合后获得的模型参数更新为该节点跟随无人机的本地联邦学习模型参数，聚合公式如下；，其中，表示跟随无人机/＞进行参数聚合后获得的模型参数；/＞表示跟随无人机/＞进行参数聚合后获得的模型参数；/＞表示跟随无人机/＞处的聚合模型参数的个数；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示跟随无人机/＞的原联邦学习模型参数。步骤4：领头无人机针对接收的各本地联邦学习模型参数，进行参数聚合并更新，获得下一轮迭代中的全局联邦学习模型参数，返回执行步骤1。所述步骤4中，领头无人机针对接收的各本地联邦学习模型参数，通过以下公式，进行参数聚合并更新，获得下一轮迭代中的全局联邦学习模型参数：，式中，/＞表示第/＞次迭代中的全局联邦学习模型参数；/＞表示基于无人机集群对应的关于模型参数传输的拓扑结构中与领头无人机相连的跟随无人机总数；/＞表示基于无人机集群对应的关于模型参数传输的拓扑结构中与领头无人机相连的跟随无人机；/＞表示跟随无人机/＞在第/＞轮迭代中的本地联邦学习模型参数；/＞表示跟随无人机/＞的本地数据集样本数量；/＞表示/＞个跟随无人机的本地数据集样本总数。本发明提出的一种基于拓扑优化的无人机集群联邦学习模型优化方法，不同于常规集中式的联邦学习方法需要每个节点都直接于中心服务器相连接以进行模型参数的传输和聚合，本发明优化聚合拓扑，在带宽分配、计算时延、通信时延以及拓扑设计的约束条件下，最小化无人机集群联邦学习每一轮的能量消耗和时延的加权和，使联邦学习能够更好地适应无人机集群网络拓扑的高动态性，以提高无人机集群的通信效率和联邦学习进程，增强无人机自组网联邦学习的鲁棒性，优化无人机集群联邦学习的整体性能。基于上述方法，如图2所示，本实施例中，其中每个跟随无人机上都安装了用于参与联邦学习模型训练的学习系统，该学习系统包括：模型接收模块，用于在每一轮训练过程中，接收从其他无人机发送的模型参数；模型更新模块，用于使用无人机本地数据训练模型，更新本地模型参数；模型聚合模块，用于将从其他无人机接收的本地模型与该无人机自身的本地模型进行聚合；模型发送模块，用于将使用更新后的本地模型发送给其他无人机。其中领头无人机上安装了用于联邦学习模型训练管理的学习系统，该学习系统包括：模型接收模块，用于在每一轮训练过程中，接收从其他无人机发送的本地模型参数；聚合模块，用于将从其他无人机接收的本地模型参数进行聚合，更新全局模型；广播模块，用于将更新得到的新一轮模型参数广播给各个相邻跟随无人机；学习管理模块，用于对整个联邦学习模型训练过程进行收敛判断和调控。本发明设计了一种基于拓扑优化的无人机集群联邦学习模型优化方法，本发明基于拓扑优化的无人机集群联邦学习优化方法，面向无人机集群，在考虑无人机集群高移动性、可用性、同时性和可扩展性等特征，对领头无人机具有苛刻信道条件的跟随无人机可以灵活地选择附近具有有利信道的设备来聚合和转发其本地模型参数，根据带宽分配、计算时延、通信时延以及拓扑设计的约束条件，最小化无人机集群联邦学习每一轮的能量消耗和时延的加权和。并且动态的调整每架跟随无人机本地模型参数的聚合路线和无人机集群联邦学习的拓扑结构，避免了由于信道衰落，某些跟随无人机和领头无人机之间的连接可能会在某些迭代回合中遭受深度衰落的高能耗、高延迟传输，节约了无人机有限的能量，实现更高的能量效率。另外，通过本发明的方法来实现跟随无人机跟随领头无人机进行智能化任务，可以显著加快联邦学习过程，大大提高了无人机集群联邦学习的鲁棒性，同时也能提高无人机集群中联邦学习的灵活性和敏捷性，使联邦学习能够更好地适应网络拓扑高动态的无人机集群。以上仅为本发明的较佳实施例，但并不限制本发明的专利范围，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来而言，其依然可以对前述各具体实施方式所记载的技术方案进行修改，或者对其中部分技术特征进行等效替换。凡是利用本发明说明书及附图内容所做的等效结构，直接或间接运用在其他相关的技术领域，均同理在本发明专利保护范围之内。
