标题title
水下动态环境激光扫描的色彩还原方法和设备
摘要abst
本发明公开了一种水下动态环境激光扫描的色彩还原方法和设备，属于图像处理技术领域。该方法由搭载于水面或水下载体上的水下动态环境激光扫描设备对目标物进行两次扫描，根据水下动态环境激光扫描设备以及内置于水下动态环境激光扫描设备的彩色相机获取目标物结构的结构信息和图像信息，对两次扫描的结构信息和图像信息进行处理，还原目标物结构的真实颜色信息。该方法可以使水下动态环境激光扫描设备在动态环境下对目标物进行空间三维结构扫描的同时，同步获取被扫描目标物的真实颜色信息，从而为使用者提供包含真实颜色信息的更加丰富的目标物空间结构数据。
权利要求书clms
1.一种水下动态环境激光扫描的色彩还原方法，其特征在于，包括如下步骤：S1、水下动态环境激光扫描设备对目标物结构T进行两次扫描，获取目标物结构T的真实三维坐标，彩色相机同时获取两次扫描时目标物结构T的图像信息；S2、提取两张图像的特征值，对两张图像中相同的特征值进行匹配，以获取水下动态环境激光扫描设备第二次扫描相对于第一次扫描时的位置姿态变化；S3、根据对极几何原理、像素坐标关系获取第一次扫描时线激光所占的像素位置排序P1在第二次扫描获得的图像中所占像素的位置排序P2；S4、读取像素位置排序P2中的颜色数据对第一次扫描获得的目标物结构T进行颜色赋值，还原目标物结构T的真实颜色信息。2.根据权利要求1所述的水下动态环境激光扫描的色彩还原方法，其特征在于，步骤S1中，随着水下动态环境激光扫描设备的移动，在第二次扫描时，目标物结构T不再被线激光覆盖，彩色相机第二次所获取的图像信息包含目标物结构T的真实颜色信息。3.根据权利要求2所述的水下动态环境激光扫描的色彩还原方法，其特征在于，步骤S1中，两次扫描的时间间隔为45ms-55ms之间任一值，以使第二次扫描时目标物结构T仍在彩色相机的镜头视角范围内。4.根据权利要求1所述的水下动态环境激光扫描的色彩还原方法，其特征在于，对目标物结构T进行图像信息获取的彩色相机内置于水下动态环境激光扫描设备中。5.根据权利要求4所述的水下动态环境激光扫描的色彩还原方法，其特征在于，水下动态环境激光扫描设备搭载于水面或水下载体上。6.根据权利要求1所述的水下动态环境激光扫描的色彩还原方法，其特征在于，在步骤S1中，对第一次扫描时所获得的图像中的线激光所占的像素位置排序P1进行提取并存储记录。7.根据权利要求1所述的水下动态环境激光扫描的色彩还原方法，其特征在于，重复步骤S1至S4，以获取目标物的完整真实颜色信息。8.一种水下动态环境激光扫描设备，其特征在于，包括：舱体；激光器，所述激光器设于所述舱体中，位于所述舱体的一端；彩色相机，所述彩色相机设于所述舱体中，位于所述舱体的另一端；数据处理单元，所述数据处理单元与所述激光器和彩色相机信号连接，以接收并处理所述激光器和彩色相机传出的数据，包括：控制与接收模块，用于控制所述激光器和彩色相机工作，接收所述激光器扫描的结果和彩色相机拍摄的图像；真实坐标获取模块，用于根据接收到的扫描结果与拍摄图像，计算获得目标物体的真实坐标；像素位置排序模块，用于根据目标物体的真实坐标以及彩色相机的相机内参获取目标物体的像素坐标，并对其进行排序和存储记录；特征值匹配模块，用于根据彩色相机两次拍摄的图像，对两张图像中相同的特征值进行匹配，获取两次拍摄时彩色相机的位置姿态变化；像素位置排序计算模块，用于根据第一次扫描所获得的像素位置排序和两次拍摄时彩色相机的位置姿态变化，通过对极几何原理计算目标物体在第二次扫描时的像素位置排序；颜色赋值模块，用于根据彩色相机拍摄的图像中的颜色信息以及两次扫描目标物的像素位置排序，将第二次扫描时像素位置排序所包含的颜色数据赋值到第一次扫描时获得的像素位置排序上。
说明书desc
技术领域本发明属于图像处理技术领域，尤其涉及一种水下动态环境激光扫描的色彩还原方法和设备。背景技术当前国内外动态环境下水下动态环境激光扫描设备使用的激光器多为绿色/蓝色线激光，通过捕获被扫描物体上激光线条在图像中的位置变化来计算目标物体的空间三维结构，目标物体被照射部分所呈现的颜色多为线激光的颜色，其原本真实颜色信息被遮盖，不能反映真实的目标物颜色信息，因此当前所有的水下动态环境激光扫描设备扫描生成的目标结构数据均不包含被扫描目标物真实的颜色信息，其输出的目标物空间结构数据为便于观测，多为后期人为配色，其真实的色彩信息丢失。对此，中国专利201910259585.1公开了一种基于激光线扫描的实时彩色三维成像系统及成像方法，能够在扫描过程中，通过已扫描区域三维信息及色彩信息的实时重构，可实现目标强度图像、距离图像、三维图像及彩色图像的实时获取及显示；在扫描过程中，系统将色彩信息实时匹配到三维空间，能够实现降低匹配误差的目的；借助图像采集与图像处理程序的并行执行，能够实现目标彩色三维图像的实时显示。但是该方法是基于单一运动方向上的扫描，不是基于真正的动态环境，当设备搭载于水面或水下载体上时，在水下的工作状态处于动态环境，因此无法还原目标色彩；真正的动态环境是指搭载水下动态环境激光扫描设备的载体会在扫描的过程中会发生一系列的空间姿态和位移的变化，任何一个没有受约束的物体在空间内均具有六个自由度，即在笛卡尔坐标系内，沿x、y、z三个直角坐标轴方向的移动自由度和绕这三个坐标轴的转动自由度，因此，要完全确定物体的位置，就必须清楚这六个自由度。因此，有必要对现有的色彩还原方法进行改进。可以将获取色彩信息的相机内置于水下动态环境激光扫描设备中，水下动态环境激光扫描设备在上述动态环境下对目标物进行空间三维结构扫描的同时，可以同步获取被扫描目标物的真实颜色信息，从而为使用者提供包含真实颜色信息的更加丰富的目标物空间结构数据。发明内容针对相关技术中存在的不足之处，本发明的目的在于提供一种水下动态环境激光扫描的色彩还原方法和设备，以解决上述背景技术中提出的问题。为实现上述目的，本发明提供如下技术方案：一种水下动态环境激光扫描的色彩还原方法，包括如下步骤：S1、水下动态环境激光扫描设备对目标物结构T进行两次扫描，获取目标物结构T的真实三维坐标，彩色相机同时获取两次扫描时目标物结构T的图像信息；S2、提取两张图像的特征值，对两张图像中相同的特征值进行匹配，以获取水下动态环境激光扫描设备第二次扫描相对于第一次扫描时的位置姿态变化；S3、根据对极几何原理、像素坐标关系获取第一次扫描时线激光所占的像素位置排序P1在第二次扫描获得的图像中所占像素的位置排序P2；S4、读取像素位置排序P2中的颜色数据对第一次扫描获得的目标物结构T进行颜色赋值，还原目标物结构T的真实颜色信息。在其中一些实施例中，步骤S1中，随着水下动态环境激光扫描设备的移动，在第二次扫描时，目标物结构T不再被线激光覆盖，彩色相机第二次所获取的图像信息包含目标物结构T的真实颜色信息；在其中一些实施例中，步骤S1中，两次扫描的时间间隔为45ms-55ms之间任一值，以使第二次扫描时目标物结构T仍在彩色相机的镜头视角范围内。在其中一些实施例中，对目标物结构T进行图像信息获取的彩色相机内置于水下动态环境激光扫描设备中。在其中一些实施例中，水下动态环境激光扫描设备搭载于水面或水下载体上。在其中一些实施例中，在步骤S1中，对第一次扫描时所获得的图像中的线激光所占的像素位置排序P1进行提取并存储记录。在其中一些实施例中，重复步骤S1至S4，以获取目标物的完整真实颜色信息。一种水下动态环境激光扫描设备，包括：舱体；激光器，激光器设于舱体中，位于舱体的一端；彩色相机，彩色相机设于舱体中，位于舱体的另一端；数据处理单元，数据处理单元与激光器和彩色相机信号连接，以接收并处理激光器和彩色相机传出的数据，包括：控制与接收模块，用于控制激光器和彩色相机工作，接收激光器扫描的结果和彩色相机拍摄的图像；真实坐标获取模块，用于根据接收到的扫描结果与拍摄图像，计算获得目标物体的真实坐标；像素位置排序模块，用于根据目标物体的真实坐标以及彩色相机的相机内参获取目标物体的像素坐标，并对其进行排序和存储记录；特征值匹配模块，用于根据彩色相机两次拍摄的图像，对两张图像中相同的特征值进行匹配，获取两次拍摄时彩色相机的位置姿态变化；像素位置排序计算模块，用于根据第一次扫描所获得的像素位置排序和两次拍摄时彩色相机的位置姿态变化，通过对极几何原理计算目标物体在第二次扫描时的像素位置排序；颜色赋值模块，用于根据彩色相机拍摄的图像中的颜色信息以及两次扫描目标物的像素位置排序，将第二次扫描时像素位置排序所包含的颜色数据赋值到第一次扫描时获得的像素位置排序上。与现有技术相比，本发明的有益效果是：1、本发明提供的水下动态环境激光扫描的色彩还原方法和设备，可以解决当前动态环境下水下激光扫描无法实时生成目标物真实色彩信息的问题，使得水下动态环境激光扫描设备可以在搭载于水面或水下载体的条件下实现扫描目标的真实色彩信息还原，为使用者提供包含真实颜色信息的更加丰富的目标物空间结构数据。2、基于本发明提供的水下动态环境激光扫描的色彩还原方法和设备所输出的三维点云数据，因附带被扫描目标物的真实色彩信息，进而具有相比于单一色彩的三维点云数据更好的可视性。附图说明此处所说明的附图用来提供对本发明的进一步理解，构成本申请的一部分，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。在附图中：图1为本发明水下动态环境激光扫描的色彩还原方法和设备一个实施例的目标物色彩还原流程示意图；图2为本发明水下动态环境激光扫描的色彩还原方法和设备一个实施例的搭载示意图；图3为本发明水下动态环境激光扫描的色彩还原方法和设备一个实施例的ROV搭载水下动态环境激光扫描设备的扫描示意图；图4为本发明水下动态环境激光扫描的色彩还原方法和设备一个实施例的水下动态环境激光扫描设备的扫描示意图；图5为本发明水下动态环境激光扫描的色彩还原方法和设备一个实施例的第一次扫描的像素位置排序示意图；图6为本发明水下动态环境激光扫描的色彩还原方法和设备一个实施例的第二次扫描的像素位置排序示意图；图7为本发明水下动态环境激光扫描的色彩还原方法和设备一个实施例的控制原理框图。图中：1、ROV；2、水下动态环境激光扫描设备；21、激光器；22、彩色相机；3、目标物；31、目标物结构T；4、像素位置排序P1；5、像素位置排序P2；6、数据处理单元；61、控制与接收模块；62、真实坐标获取模块；63、像素位置排序模块；64、特征值匹配模块；65、像素位置排序计算模块；66、颜色赋值模块。具体实施方式下面将结合本发明实施例中的附图，对实施例中的技术方案进行清楚、完整的描述。显然，所描述的实施例仅仅是本发明的一部分实施例，而非全部的实施例。基于本发明的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要理解的是，术语“中心”、“横向”、“纵向”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。参见附图1至图7，给出了本发明所提出的水下动态环境激光扫描的色彩还原方法和设备的一个示意性实施例。参见附图2至图4，在对水下目标物3进行扫描时，水下动态环境激光扫描设备2的工作方式为挂载于ROV1上，所以水下动态环境激光扫描设备2在水下工作时是处于一个动态环境；水下动态环境激光扫描设备2跟随其载体ROV1运动，从而使得水下动态环境激光扫描设备2的激光器21所发射出的激光线条依次推进扫描覆盖目标物3，在此过程中集成于水下动态环境激光扫描设备2中的彩色相机22捕获对应的图像，再对图像进行后续处理以获得目标物3的结构与色彩信息，进而完成对水下目标物3的扫描。对于目标物3的每部分结构，均应捕获两张图像，以目标物结构T31为例，参见附图3、图5和图6，第一次扫描时，目标物结构T31本身的真实颜色被线激光的色彩所覆盖，无法观测到，提取本次扫描所获得的图像中线激光所占的像素位置排序P14并存储记录；随着ROV1在水下的运动，照射在目标物结构T31的线激光也在移动，第二次扫描时，原先被线激光扫描覆盖的目标物结构T31此时不再被线激光覆盖，同时在附带水下可见照明的情况下，目标物结构T31本身的色彩被集成于水下动态环境激光扫描设备2中的彩色相机22采集到，因为两次扫描的间隔为45ms-55ms之间任一值，因此目标物结构T31不会消失于彩色相机22的镜头视角范围内。动态环境是指搭载水下动态环境激光扫描设备2的ROV1会在扫描的过程中会发生一系列的空间姿态和位移的变化，任何一个没有受约束的物体在空间内均具有六个自由度，即在笛卡尔坐标系内，沿x、y、z三个直角坐标轴方向的移动自由度和绕这三个坐标轴的转动自由度，要完全确定物体的位置，就必须清楚这六个自由度；对第一次扫描和第二次扫描所获得的图像进行相同特征值提取，然后对两张图像中相同的特征值进行匹配，由此可以获取第二次扫描时相对于第一次扫描时的位置姿态变化，即可知旋转矩阵R和平移向量T；通过相机标定获取彩色相机22的相机内参K，通过激光三角测距原理，水下动态环境激光扫描设备2可以获取被扫描目标物结构T31上点P的真实三维坐标P，对于一个三维空间点，根据相机成像原理，其与对应图像上的点的像素坐标有如下对应关系：其中，fx、fy、cx和cy为相机内参，通过相机标定来获取。这个关系可以写成矩阵形，便于表示与计算：据此可以获得点P在第一次扫描时的像素坐标P1，根据对极几何原理，可以获得点P在第二次扫描时的像素坐标P2，将P2的颜色数据赋值到P1，即可实现对P1的颜色信息还原。根据上述原理，在获取第一次扫描时线激光所占的像素位置排序P14并存储记录后，获取第二次扫描获得的图像中目标物结构T31所占像素的位置排序P25，读取像素位置排序P25中的颜色数据对第一次扫描获得的目标物结构T31进行颜色赋值，便可以还原目标物结构T31的真实颜色信息。参见附图4和图7，该水下动态环境激光扫描设备2包括舱体、激光器21、彩色相机22和数据处理单元6。激光器21和彩色相机22均设于舱体中，使舱体对激光器21和彩色相机22提供一定保护作用，激光器21位于舱体的一端，彩色相机22位于舱体的另一端，激光器21和彩色相机22位于舱体的两端，可以保证彩色相机22在对目标物3进行拍摄时激光器21所发出的激光没有覆盖住目标物3的颜色。数据处理单元6与激光器21和彩色相机22信号连接，用以接收并处理激光器21和彩色相机22传出的数据。继续参见附图7，数据处理单元6包括控制与接收模块61、真实坐标获取模块62、像素位置排序模块63、特征值匹配模块64、像素位置排序计算模块65和颜色赋值模块66。控制与接收模块61用于控制激光器21和彩色相机22工作，接收激光器21扫描的结果和彩色相机22拍摄的图像；真实坐标获取模块62用于根据接收到的扫描结果与拍摄图像，通过激光三角测距原理计算获得目标物3的真实坐标；像素位置排序模块63用于根据目标物3的真实坐标以及彩色相机22的相机内参获取目标物3的像素坐标，并对其进行排序和存储记录；特征值匹配模块64用于根据彩色相机22两次拍摄的图像，对两张图像中相同的特征值进行匹配，获取两次拍摄时彩色相机22的位置姿态变化；像素位置排序计算模块65用于根据第一次扫描所获得的像素位置排序和两次拍摄时彩色相机22的位置姿态变化，通过对极几何原理计算目标物3在第二次扫描时的像素位置排序；颜色赋值模块66用于根据彩色相机22拍摄的图像中的颜色信息以及两次扫描目标物3的像素位置排序，将第二次扫描时像素位置排序所包含的颜色数据赋值到第一次扫描时获得的像素位置排序上。参见附图1至图7,对该实施例的步骤进行概括，包括：S1、水下动态环境激光扫描设备2对目标物结构T31进行两次扫描，根据激光三角测距原理获取目标物结构T31的真实三维坐标，彩色相机22同时获取两次扫描时目标物结构T31的图像信息；S2、提取两张图像的特征值，对两张图像中相同的特征值进行匹配，以获取水下动态环境激光扫描设备2第二次扫描相对于第一次扫描时的位置姿态变化；S3、根据对极几何原理、像素坐标关系获取第一次扫描时线激光所占的像素位置排序P14在第二次扫描获得的图像中所占像素的位置排序P25；S4、读取像素位置排序P25中的颜色数据对第一次扫描获得的目标物结构T31进行颜色赋值，还原目标物结构T31的真实颜色信息；S5重复步骤S1至S4，以获取目标物3的完整真实颜色信息。在上述示意性实施例中，水下动态环境激光扫描的色彩还原方法使水下动态环境激光扫描设备在动态环境下对目标物进行空间三维结构扫描的同时，同步获取被扫描目标物的真实颜色信息，为使用者提供包含真实颜色信息的更加丰富的目标物空间结构数据，具有更好的可视性。以上实施例仅用以说明本发明的技术方案而非对其限制；尽管参照较佳实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者对部分技术特征进行等同替换；而不脱离本发明技术方案的精神，其均应涵盖在本发明请求保护的技术方案范围当中。
