标题title
一种蜜罐部署方法
摘要abst
本发明提供了一种蜜罐部署方法。该方法包括：确定需要保护资产的目标网络，获取所述目标网络的资产类型和资产数目信息；根据所述目标网络中各个子网的关键资产位置和历史攻击信息，对子网的资产等级进行划分，计算出子网的设备重要性分数，根据各个子网设备的重要性分数计算出子网的资产密度；根据各个子网的资产密度和资产等级，根据部署公式将可用蜜罐部署到目标网络的各个子网中。本发明方法基于现有网络中的重点设备，贴合实际业务场景，对蜜罐进行不同场景下的动态部署，从而降低蜜罐部署的成本，并能达到欺骗攻击者，实现获取欺骗者更多信息和拖延攻击者的目的。
权利要求书clms
1.一种蜜罐部署方法，其特征在于，包括：确定需要保护资产的目标网络，获取所述目标网络的资产类型和资产数目信息；根据所述目标网络中各个子网的关键资产位置和历史攻击信息，对子网的资产等级进行划分，计算出子网的设备重要性分数，根据各个子网设备的重要性分数计算出子网的资产密度；根据各个子网的资产密度和资产等级，根据部署公式将可用蜜罐部署到目标网络的各个子网中。2.根据权利要求1所述的方法，其特征在于，所述的确定需要保护资产的目标网络，获取所述目标网络的资产类型和资产数目信息，包括：通过分析引擎对虚拟局域网进行探测，获取虚拟局域网中资产的数目和类型，根据不同资产类型和网段将虚拟局域网划分不同网络区域，生成需要保护资产的目标网络的架构，记录目标网络的资产类型和资产数目信息。3.根据权利要求1或者2所述的方法，其特征在于，所述的根据所述目标网络中各个子网的关键资产位置和历史攻击信息，对子网的资产等级进行划分，计算出子网的设备重要性分数，包括：将需要保护的目标网络中子网IP进行统计，将子网的重要程度F分别设置为多个等级，利用分析引擎汇总、统计目标网络上的历史攻击数据，利用历史攻击日志分析历史攻击时间和分布密度，获取目标网络中历史攻击次数的概率分布值M，将所述概率分布值M确定为目标网络中的子网设备被攻击测试的百分比；子网设备的重要性分数为D，计算方法为：D＝F×M，目标网段中所有子网设备都有一个设备重要性分数。4.根据权利要求3所述的方法，其特征在于，所述的根据各个子网设备的重要性分数计算出子网的资产密度，包括：密度引擎根据各个子网设备的重要性分数D，将要保护的目标网段IP划分为四个等级：Ap、Bp、Cp和Dp，将子网中主机重要性分数大于百分之七十五的子网划分为等级Ap，子网中主机重要性分数大于百分之五十的子网划分为划分为等级Bp，子网中主机重要性分数大于百分之二十五的子网划分为等级Cp，剩下的子网划分为等级Dp；子网的资产密度ρ是目标网络的子网中关键资产数除以目标网络中关键资产的总数。5.根据权利要求4所述的方法，其特征在于，所述的根据各个子网的资产密度和资产等级，根据部署公式将可用蜜罐部署到目标网络的各个子网中，包括：将现有蜜罐按照一定比例设置为空闲蜜罐和可用蜜罐，记可用蜜罐的数目为N，根据部署公式将可用蜜罐部署到目标网络的各个子网中，子网中不同资产等级将要部署的蜜罐的数目n的计算公式为：n＝N×G×ρρ为子网的资产密度，资产等级对应的分配比例G的计算公式如下表所示为：资产等级分配比例GAp40％Bp30％Cp20％Dp10％。
说明书desc
技术领域本发明涉及网络攻击技术领域，尤其涉及一种蜜罐部署方法。背景技术随着数字化技术发展，大规模针对性网络行动大幅增加，数据泄露、勒索软件、安全漏洞不断升级发展，网络安全已成为国家安全的重要因素。传统蜜罐以高甜诱捕和重定向等被动手段来影响攻击者做出错误判断，而仿真程度和部署位置直接影响到欺骗效果，如果蜜罐无法体现内网业务特征，将使攻击者躲过防御系统。同时，蜜罐陷阱部署后，如果周边网络环境没有信息指引的配合，也很难让攻击者主动接近陷阱，因此需要扩大蜜罐部署范围并提高密集度。但是现有保护网络中的业务系统多样，有服务类的对外开放系统，管理类的内部系统，保护单元和监控等工业系统，过度粉饰化的伪装，和过高的蜜罐部署广度和密度，不仅产生更高的成本，对现有网络信息系统资源造成负担，也容易被攻击者过早识破从而继续潜伏。并且在网络攻防体系中，攻防双方的力量和成本消耗也是不均衡的博弈过程，很容易在前期蜜罐的部署中投入大量的开销。因此针对上述问题，如何在降低防御系统的部署成本与难度时，并将欺骗效果的收益最大化实现，是构建一个严密的高诱惑性防御系统必须要解决的。发明内容本发明的实施例提供了一种蜜罐部署方法，以实现对蜜罐进行不同场景下的动态部署。为了实现上述目的，本发明采取了如下技术方案。一种蜜罐部署方法，包括：确定需要保护资产的目标网络，获取所述目标网络的资产类型和资产数目信息；根据所述目标网络中各个子网的关键资产位置和历史攻击信息，对子网的资产等级进行划分，计算出子网的设备重要性分数，根据各个子网设备的重要性分数计算出子网的资产密度；根据各个子网的资产密度和资产等级，根据部署公式将可用蜜罐部署到目标网络的各个子网中。优选地，所述的确定需要保护资产的目标网络，获取所述目标网络的资产类型和资产数目信息，包括：通过分析引擎对虚拟局域网进行探测，获取虚拟局域网中资产的数目和类型，根据不同资产类型和网段将虚拟局域网划分不同网络区域，生成需要保护资产的目标网络的架构，记录目标网络的资产类型和资产数目信息。优选地，所述的根据所述目标网络中各个子网的关键资产位置和历史攻击信息，对子网的资产等级进行划分，计算出子网的设备重要性分数，包括：将需要保护的目标网络中子网IP进行统计，将子网的重要程度F分别设置为多个等级，利用分析引擎汇总、统计目标网络上的历史攻击数据，利用历史攻击日志分析历史攻击时间和分布密度，获取目标网络中历史攻击次数的概率分布值M，将所述概率分布值M确定为目标网络中的子网设备被攻击测试的百分比；子网设备的重要性分数为D，计算方法为：D＝F×M，目标网段中所有子网设备都有一个设备重要性分数。优选地，所述的根据各个子网设备的重要性分数计算出子网的资产密度，包括：密度引擎根据各个子网设备的重要性分数D，将要保护的目标网段IP划分为四个等级：Ap、Bp、Cp和Dp，将子网中主机重要性分数大于百分之七十五的子网划分为等级Ap，子网中主机重要性分数大于百分之五十的子网划分为划分为等级Bp，子网中主机重要性分数大于百分之二十五的子网划分为等级Cp，剩下的子网划分为等级Dp；子网的资产密度ρ是目标网络的子网中关键资产数除以目标网络中关键资产的总数。优选地，所述的根据各个子网的资产密度和资产等级，根据部署公式将可用蜜罐部署到目标网络的各个子网中，包括：将现有蜜罐按照一定比例设置为空闲蜜罐和可用蜜罐，记可用蜜罐的数目为N，根据部署公式将可用蜜罐部署到目标网络的各个子网中，子网中不同资产等级将要部署的蜜罐的数目n的计算公式为：n＝N×G×ρρ为子网的资产密度，资产等级对应的分配比例G的计算公式如下表所示为：资产等级分配比例GAp40％Bp30％Cp20％Dp10％。由上述本发明的实施例提供的技术方案可以看出，本发明方法基于现有网络中的重点设备，贴合实际业务场景，对蜜罐进行不同场景下的动态部署，从而降低蜜罐部署的成本，并能达到欺骗攻击者，实现获取欺骗者更多信息和拖延攻击者的目的。本发明附加的方面和优点将在下面的描述中部分给出，这些将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的一种蜜罐部署模块与报警模块关系示意图；图2为本发明实施例提供的一种蜜罐部署方法的处理流程图。具体实施方式下面详细描述本发明的实施方式，所述实施方式的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施方式是示例性的，仅用于解释本发明，而不能解释为对本发明的限制。本技术领域技术人员可以理解，除非特意声明，这里使用的单数形式“一”、“一个”、“所述”和“该”也可包括复数形式。应该进一步理解的是，本发明的说明书中使用的措辞“包括”是指存在所述特征、整数、步骤、操作、元件和/或组件，但是并不排除存在或添加一个或多个其他特征、整数、步骤、操作、元件、组件和/或它们的组。应该理解，当我们称元件被“连接”或“耦接”到另一元件时，它可以直接连接或耦接到其他元件，或者也可以存在中间元件。此外，这里使用的“连接”或“耦接”可以包括无线连接或耦接。这里使用的措辞“和/或”包括一个或更多个相关联的列出项的任一单元和全部组合。本技术领域技术人员可以理解，除非另外定义，这里使用的所有术语具有与本发明所属领域中的普通技术人员的一般理解相同的意义。还应该理解的是，诸如通用字典中定义的那些术语应该被理解为具有与现有技术的上下文中的意义一致的意义，并且除非像这里一样定义，不会用理想化或过于正式的含义来解释。为便于对本发明实施例的理解，下面将结合附图以几个具体实施例为例做进一步的解释说明，且各个实施例并不构成对本发明实施例的限定。蜜罐是一个包含漏洞的系统，它模拟一个或多个易受攻击的主机，给黑客提供一个容易攻击的目标。本发明实施例根据当前要保护的目标网段，对蜜罐的数量、密度和位置进行动态部署。本发明实施例提供的一种蜜罐部署模块与报警模块关系示意图如图1所示，本发明实施例中的蜜罐部署由四个引擎实现，分别通过分析引擎、位置引擎、密度引擎和部署引擎组成。攻击者进入密网系统尝试攻击时，攻击流量会从密网中导入系统报警模块，系统报警模块记录攻击流量信息，根据用户需要将历史攻击信息进行整合，将整合后的攻击信息发送给蜜罐部署模块。然后，蜜罐部署模块将根据现有网段的资源与历史攻击信息，对现有空闲蜜罐进行动态部署，并将蜜罐部署策略实施到密网系统当中。本发明实施例提供的一种蜜罐部署方法的处理流程如图2所示，包括如下的处理步骤：步骤S10、对现有网络进行扫描，生成需要保护资产的目标网络的架构，获取目标网络的资产类型、资产数目等信息。分析引擎对现有网段进行扫描探测，获取VLAN当中资产的数目和类型，并根据不同资产类型和网段划分不同网络区域，生成需要保护资产的目标网络的架构，记录目标网络的资产类型、资产数目等信息。在蜜点仓库中设置了功能与类型丰富的蜜点模板，该蜜点模板包括路由器蜜点、web蜜点、数据库蜜点和邮箱蜜点等。根据当前的生成的目标网络的架构，在不同的服务主机的业务需求设置不同的蜜点，将不同类型的功能蜜罐划分到与其相关联的目标网络的网段当中，可以在这个蜜罐池当中实现对蜜罐的位置和数量部署配置，进而诱导攻击者释放攻击负荷。步骤S20、位置引擎根据目标网络中子网的关键资产位置、历史攻击信息，对子网的资产等级进行划分，并计算子网的设备重要性分数。将需要保护的目标网络中子网IP进行统计，重要程度F分别设置为3个等级，分别为重要、一般、普通三个等级。例如对于在公司研发部门子网当中，部门经理在这个子网网段当中，资产数据价值最高，将其划分为等级重要，副经理或业务组长等级为一般，普通员工等级为普通。但是这样分析难免会主观因素影响，因此我们将历史攻击分布考虑了进来。分析引擎汇总、统计目标网络上的历史攻击数据，利用历史攻击日志分析历史攻击时间和分布密度，将目标网络中历史攻击次数表示为概率分布的平均值、中值或众数。位置引擎将目标网络中历史攻击次数的概率分布值M确定为目标网络中的子网设备被攻击测试的百分比。优选地，上述历史攻击信息的追溯时间长短由用户自行配置，可以是一个月、也可以是一年，可根据攻击的迭代快慢来自行控制。子网设备的重要性分数为D，计算方法为：D＝F×M，F为重要程度的等级分数，由用户自行配置，用户可参考测试人员或者公司人员的意见对F的数值进行配置，因此这里交由用户进行控制。目标网段中所有子网设备都将有一个设备重要性分数。步骤S30、密度引擎根据各个子网设备的重要性分数D，将要保护的目标网段IP划分为四个等级：Ap、Bp、Cp和Dp。将子网中主机重要性分数大于百分之七十五的子网划分为等级Ap，子网中主机重要性分数大于百分之五十的子网划分为划分为等级Bp，子网中主机重要性分数大于百分之二十五的子网划分为等级Cp，剩下的子网划分为等级Dp。子网的资产密度是目标网络的子网中关键资产的总数除以目标网络中关键资产的总数。步骤S40、部署引擎根据子网的资产密度和资产等级，对现有蜜罐按照一定比例设置空闲蜜罐和可用蜜罐，并根据部署公式将可用蜜罐部署到目标网络的各个子网中。这里记可用蜜罐的数目为N，资产等级对应的分配比例G为：资产等级分配比例GAp40％Bp30％Cp20％Dp10％子网中不同资产等级的设备将要部署的蜜罐的数目的计算公式为：n＝N×G×ρ是因为，在子网中部署的欺骗机制的数量依赖于与网络中该部分子网相关的信息。例如，当子网上有更多的资产时，欺骗机制的数量会增加；当子网中攻击次数增加，会使整个网络中的欺骗机制数量增加。本发明实施例的蜜罐的部署方法依赖于历史攻击信息，因此当攻击者再次进入系统产生攻击，报警系统会不断生成报警日志，新生成的报警日志同样会引入到分析引擎当中，这样就可以根据攻击者的攻击目标实时部署蜜罐的位置与数目，从而达到蜜罐的动态部署的目的。本发明实施例中将要部署的蜜罐类型取决于攻击者所处的网络区域，并可以同一个网络区域部署多种蜜罐。综上所述，本发明实施例提出了一种能够根据各网络区域需要部署蜜罐的部署规则。根据实际网络中的网络架构，将不同类型的蜜罐划定归属相关的网络区域类型，贴合实际业务场景，实用性强普适性强。通过分析引擎、位置引擎、密度引擎和部署引擎这四个引擎相互合作并且与报警控制模块形成一个闭环，能够贴合不同的业务场景、不同资产的重要程度进行蜜罐的动态的部署本发明研究具有迷惑力蜜罐进行抛撒的方法，在攻击者进入网络后，提升踩中陷阱概率而尽早暴露。结合当前业务网中的服务器、客户机，业务特征、人员特征、确定符合企业日常办公生产特征的部署范围。并在成本前提下，最大化部署范围以扩大诱导面，做到不被攻击者识破，使得攻击者大概率被低成本广分布的蜜罐吸引，而被进一步牵引到陷阱。本领域普通技术人员可以理解：附图只是一个实施例的示意图，附图中的模块或流程并不一定是实施本发明所必须的。通过以上的实施方式的描述可知，本领域的技术人员可以清楚地了解到本发明可借助软件加必需的通用硬件平台的方式来实现。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在存储介质中，如ROM/RAM、磁碟、光盘等，包括若干指令用以使得一台计算机设备执行本发明各个实施例或者实施例的某些部分所述的方法。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于装置或系统实施例而言，由于其基本相似于方法实施例，所以描述得比较简单，相关之处参见方法实施例的部分说明即可。以上所描述的装置及系统实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性劳动的情况下，即可以理解并实施。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应该以权利要求的保护范围为准。
