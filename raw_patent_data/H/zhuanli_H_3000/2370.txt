标题title
一种摄像机聚焦控制方法及系统
摘要abst
本发明涉及图像处理技术领域，公开了一种摄像机聚焦控制方法及系统，其方法通过确定聚焦参数控制范围，将摄像机在聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧，并对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像，计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为摄像机拍摄目标物的最佳图像，从而无需进行出厂前的标定，也不依赖摄像机自身自动聚焦功能，即可对摄像机的聚焦进行控制，实现了摄像机聚焦控制可互换性，还提高了摄像机清晰度控制的可靠性和效率。
权利要求书clms
1.一种摄像机聚焦控制方法，其特征在于，包括以下步骤：在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围；将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧；对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像；计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。2.根据权利要求1所述的摄像机聚焦控制方法，其特征在于，在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围的步骤具体包括：获取所述摄像机相对所述目标物之间的物距，在恒定变焦倍数下，通过所述物距与聚焦参数之间的变化规律拟合为聚焦变化曲线；计算所述聚焦变化曲线上预设聚焦参数点的变化斜率作为单位物距聚焦参数变化率，通过单位物距聚焦参数变化率与预设物距容差进行相乘运算，得到运算结果，将所述运算结果与预设聚焦参数进行加减运算，得到聚焦参数控制范围。3.根据权利要求1所述的摄像机聚焦控制方法，其特征在于，将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧的步骤具体包括：在所述聚焦参数控制范围的约束下，将所述摄像机的初始聚焦参数设置为最低聚焦参数进行拍摄，获取初始聚焦参数对应的拍摄时刻；将所述摄像机的聚焦参数由最低聚焦参数以相同步长逐步调整至最高聚焦参数，获取最高聚焦参数对应的拍摄时刻，其中每个步长对应有不同的聚焦参数；获取不同聚焦参数分别对应的视频流。4.根据权利要求1所述的摄像机聚焦控制方法，其特征在于，计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像的步骤具体包括：对视频帧图像中预定区域图像进行灰度处理，得到二维灰度图像，对视频帧图像中除所述预定区域图像之外的图像进行模糊化处理；利用Laplacian剃度函数对所述二维灰度图像进行剃度处理，得到梯度图像；计算所述梯度图像的方差来表征清晰度值；将所有视频帧图像分别对应的清晰度值进行比对，根据比对结果获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。5.根据权利要求1所述的摄像机聚焦控制方法，其特征在于，计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像的步骤之后还包括：将视频帧图像与相应的聚焦参数构建映射关系；获取清晰度值最高的视频帧图像对应的聚焦参数，若其聚焦参数为所述最低聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FA-ΔF×0.9FB'＝FA+ΔF×0.1式中，FA'为更新后的最低聚焦参数，FA为更新前的最低聚焦参数，ΔF为单位聚焦参数变化量，FB'为更新后的最高聚焦参数，更新后的聚焦参数控制范围为；若其聚焦参数为所述最高聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FB-ΔF×0.1FB'＝FB+ΔF×0.9若其聚焦参数为中间聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FC-ΔF×0.4FB'＝FC+ΔF×0.4式中，FC为中间聚焦参数；根据更新后的聚焦参数控制范围，重新执行将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧的步骤。6.一种摄像机聚焦控制系统，其特征在于，包括：范围计算模块，用于在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围；调整模块，用于将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧；解码模块，用于对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像；清晰度计算模块，用于计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。7.根据权利要求6所述的摄像机聚焦控制系统，其特征在于，所述范围计算模块具体包括：拟合模块，用于获取所述摄像机相对所述目标物之间的物距，在恒定变焦倍数下，通过所述物距与聚焦参数之间的变化规律拟合为聚焦变化曲线；计算模块，用于计算所述聚焦变化曲线上预设聚焦参数点的变化斜率作为单位物距聚焦参数变化率，通过单位物距聚焦参数变化率与预设物距容差进行相乘运算，得到运算结果，将所述运算结果与预设聚焦参数进行加减运算，得到聚焦参数控制范围。8.根据权利要求6所述的摄像机聚焦控制系统，其特征在于，所述调整模块具体包括：设置模块，用于在所述聚焦参数控制范围的约束下，将所述摄像机的初始聚焦参数设置为最低聚焦参数进行拍摄，获取初始聚焦参数对应的拍摄时刻；聚焦调整模块，用于将所述摄像机的聚焦参数由最低聚焦参数以相同步长逐步调整至最高聚焦参数，获取最高聚焦参数对应的拍摄时刻，其中每个步长对应有不同的聚焦参数；视频流模块，用于获取不同聚焦参数分别对应的视频流。9.根据权利要求6所述的摄像机聚焦控制系统，其特征在于，所述清晰度计算模块具体包括：灰度模块，用于对视频帧图像中预定区域图像进行灰度处理，得到二维灰度图像，对视频帧图像中除所述预定区域图像之外的图像进行模糊化处理；梯度模块，用于利用Laplacian剃度函数对所述二维灰度图像进行剃度处理，得到梯度图像；方差计算模块，用于计算所述梯度图像的方差来表征清晰度值；比对模块，用于将所有视频帧图像分别对应的清晰度值进行比对，根据比对结果获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。10.根据权利要求6所述的摄像机聚焦控制系统，其特征在于，还包括：映射模块，用于将视频帧图像与相应的聚焦参数构建映射关系；更新模块，用于获取清晰度值最高的视频帧图像对应的聚焦参数，若其聚焦参数为所述最低聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FA-ΔF×0.9FB'＝FA+ΔF×0.1式中，FA'为更新后的最低聚焦参数，FA为更新前的最低聚焦参数，ΔF为单位聚焦参数变化量，FB'为更新后的最高聚焦参数，更新后的聚焦参数控制范围为；若其聚焦参数为所述最高聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FB-ΔF×0.1FB'＝FB+ΔF×0.9若其聚焦参数为中间聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FC-ΔF×0.4FB'＝FC+ΔF×0.4式中，FC为中间聚焦参数。
说明书desc
技术领域本发明涉及图像处理技术领域，尤其涉及一种摄像机聚焦控制方法及系统。背景技术智能巡检机器人常使用可见光摄像机等成像装置拍摄目标图像，并使用多种分类、识别算法提取图像中的信息，用于缺陷诊断等用途。由于拍摄距离变化较大，目标较小，一般会采用带有电动变焦、电动聚焦功能镜头的摄像机拍摄。但是，摄像机在不同的前景、背景纹理特征下，特别是变焦倍数较大的情况下，不一定能够可靠的依靠摄像机自动聚焦功能聚焦到期望的焦平面上，进而难以拍摄清晰的图像，后续的分类、识别准确度都会受到不良影响。现阶段巡检机器人使用摄像机拍摄照片，一般可能采用下面方式：1)手动聚焦拍摄，指的是将摄像机镜头设置到某套预设参数下拍摄的过程，这也是巡检机器人最常用的拍摄模式之一。但是，巡检机器人由于每次拍摄时并不能保证严格处于预设参数需要的位置上，如果拍照时的位置偏差超过了当前变焦倍数对应焦距的景深时，使用预设的聚焦参数就无法拍出清晰的照片。在焦距较大，目标较近的时候，这个现象较为显著。此外，镜头内镜片组的相对位置可能受环境温度影响而发生细微变化，改变镜头等效光学中心位置、物距和像距，也会导致在预设参数下无法清晰成像的问题。同时，从手动聚焦拍摄的问题还引伸出摄像机互换性问题。摄像机的镜头镜片组在装配中必然存在细微位置差别，导致相同的预设参数在同型号的另一台摄像机上不能保证相同的效果，也即是说，如果摄像机因为故障需要更换，必须要进行两个摄像机预设参数等价性的校验和转换，否则在手动聚焦模式下有很大概率无法获得清晰的图像。为保证摄像机的可互换性，要求对每一台摄像机在装配到机器人上并交付用户前，都做一次预设参数标定，将相关数据保存备用，返修更换后要重新标定，计算转换关系，增加了工作量。2)自动聚焦拍摄，指使用摄像机内置的自动调整聚焦的功能拍摄的过程。由于自动调整聚焦通常会使用边缘检测等手段判断聚焦是否准确，在特定条件下，比如目标的背景或者前景存在纹理十分清晰的物体，会让摄像机错误的聚焦到背景或者前景上。对于某些摄像机，即使目标在画面中的占比高达50％或者更高，摄像机仍会倾向于聚焦到背景或者前景上，用户可能也无法介入聚焦算法的参数调整去改善自动聚焦失败的情况。在变电站内，这种情况很普遍，也是巡检机器人不能采用自动聚焦的原因。应用自动聚焦拍摄的另一个弊端是自动聚焦的调整时间不确定，有时摄像机从长焦端到广角端反复几次遍历查找都无法找到正确聚焦的图像，消耗时间可长达十余秒，要确定拍摄时机，必须轮询摄像机的相关控制接口来检查聚焦过程是否停止，不仅消耗了额外的时间，降低了巡检效率，也一定程度上增加了上位控制程序的复杂性。3)手动加自动聚焦拍摄，指在将摄像机镜头设置到某套预设参数下再触发摄像机内置的自动调整聚焦的功能拍摄的过程。摄像机内置的自动聚焦功能会尝试在一定范围内调整并检测是否能够获得良好的聚焦，在预设参数下，由于与拍摄清晰图像所需参数的偏差相对较小，摄像机有可能比较容易获得期望的清晰图像，但方法的成功率取决于自动聚焦算法的具体实现，在某些情况下，摄像机依然会倾向于聚焦到背景或前景。这种方法一定程度上缓解了自动聚焦有时无法拍摄出清晰图片的问题，但是由于其综合应用了上述两种本身就不完善的方法，并未从根本上解决问题。发明内容本发明提供了一种摄像机聚焦控制方法及系统，解决了摄像机聚焦控制不可互换性以及清晰度较低且控制效率较低的技术问题。有鉴于此，本发明第一方面提供了一种摄像机聚焦控制方法，包括以下步骤：在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围；将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧；对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像；计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。优选地，在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围的步骤具体包括：获取所述摄像机相对所述目标物之间的物距，在恒定变焦倍数下，通过所述物距与聚焦参数之间的变化规律拟合为聚焦变化曲线；计算所述聚焦变化曲线上预设聚焦参数点的变化斜率作为单位物距聚焦参数变化率，通过单位物距聚焦参数变化率与预设物距容差进行相乘运算，得到运算结果，将所述运算结果与预设聚焦参数进行加减运算，得到聚焦参数控制范围。优选地，将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧的步骤具体包括：在所述聚焦参数控制范围的约束下，将所述摄像机的初始聚焦参数设置为最低聚焦参数进行拍摄，获取初始聚焦参数对应的拍摄时刻；将所述摄像机的聚焦参数由最低聚焦参数以相同步长逐步调整至最高聚焦参数，获取最高聚焦参数对应的拍摄时刻，其中每个步长对应有不同的聚焦参数；获取不同聚焦参数分别对应的视频流。优选地，计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像的步骤具体包括：对视频帧图像中预定区域图像进行灰度处理，得到二维灰度图像，对视频帧图像中除所述预定区域图像之外的图像进行模糊化处理；利用Laplacian剃度函数对所述二维灰度图像进行剃度处理，得到梯度图像；计算所述梯度图像的方差来表征清晰度值；将所有视频帧图像分别对应的清晰度值进行比对，根据比对结果获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。优选地，计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像的步骤之后还包括：将视频帧图像与相应的聚焦参数构建映射关系；获取清晰度值最高的视频帧图像对应的聚焦参数，若其聚焦参数为所述最低聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FA-ΔF×0.9FB'＝FA+ΔF×0.1式中，FA'为更新后的最低聚焦参数，FA为更新前的最低聚焦参数，ΔF为单位聚焦参数变化量，FB'为更新后的最高聚焦参数，更新后的聚焦参数控制范围为；若其聚焦参数为所述最高聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FB-ΔF×0.1FB'＝FB+ΔF×0.9若其聚焦参数为中间聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FC-ΔF×0.4FB'＝FC+ΔF×0.4式中，FC为中间聚焦参数；根据更新后的聚焦参数控制范围，重新执行将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧的步骤。第二方面，本发明还提供了一种摄像机聚焦控制系统，包括：范围计算模块，用于在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围；调整模块，用于将所述摄像机在所述聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧；解码模块，用于对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像；清晰度计算模块，用于计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。优选地，所述范围计算模块具体包括：拟合模块，用于获取所述摄像机相对所述目标物之间的物距，在恒定变焦倍数下，通过所述物距与聚焦参数之间的变化规律拟合为聚焦变化曲线；计算模块，用于计算所述聚焦变化曲线上预设聚焦参数点的变化斜率作为单位物距聚焦参数变化率，通过单位物距聚焦参数变化率与预设物距容差进行相乘运算，得到运算结果，将所述运算结果与预设聚焦参数进行加减运算，得到聚焦参数控制范围。优选地，所述调整模块具体包括：设置模块，用于在所述聚焦参数控制范围的约束下，将所述摄像机的初始聚焦参数设置为最低聚焦参数进行拍摄，获取初始聚焦参数对应的拍摄时刻；聚焦调整模块，用于将所述摄像机的聚焦参数由最低聚焦参数以相同步长逐步调整至最高聚焦参数，获取最高聚焦参数对应的拍摄时刻，其中每个步长对应有不同的聚焦参数；视频流模块，用于获取不同聚焦参数分别对应的视频流。优选地，所述清晰度计算模块具体包括：灰度模块，用于对视频帧图像中预定区域图像进行灰度处理，得到二维灰度图像，对视频帧图像中除所述预定区域图像之外的图像进行模糊化处理；梯度模块，用于利用Laplacian剃度函数对所述二维灰度图像进行剃度处理，得到梯度图像；方差计算模块，用于计算所述梯度图像的方差来表征清晰度值；比对模块，用于将所有视频帧图像分别对应的清晰度值进行比对，根据比对结果获取清晰度值最高的视频帧图像作为所述摄像机拍摄所述目标物的最佳图像。优选地，本系统还包括：映射模块，用于将视频帧图像与相应的聚焦参数构建映射关系；更新模块，用于获取清晰度值最高的视频帧图像对应的聚焦参数，若其聚焦参数为所述最低聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FA-ΔF×0.9FB'＝FA+ΔF×0.1式中，FA'为更新后的最低聚焦参数，FA为更新前的最低聚焦参数，ΔF为单位聚焦参数变化量，FB'为更新后的最高聚焦参数，更新后的聚焦参数控制范围为；若其聚焦参数为所述最高聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FB-ΔF×0.1FB'＝FB+ΔF×0.9若其聚焦参数为中间聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FC-ΔF×0.4FB'＝FC+ΔF×0.4式中，FC为中间聚焦参数。从以上技术方案可以看出，本发明具有以下优点：本发明通过确定聚焦参数控制范围，将摄像机在聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧，并对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像，计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为摄像机拍摄目标物的最佳图像，从而无需进行出厂前的标定，也不依赖摄像机自身自动聚焦功能，即可对摄像机的聚焦进行控制，实现了摄像机聚焦控制可互换性，还提高了摄像机清晰度控制的可靠性和效率。附图说明图1为本发明实施例提供的一种摄像机聚焦控制方法的流程图；图2为本发明实施例提供的一种摄像机聚焦控制系统的结构示意图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。为了便于理解，请参阅图1，本发明提供的一种摄像机聚焦控制方法，包括以下步骤：S1、在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围。S2、将摄像机在聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧。S3、对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像。S4、计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为摄像机拍摄目标物的最佳图像。本发明提供了一种摄像机聚焦控制方法，通过确定聚焦参数控制范围，将摄像机在聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧，并对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像，计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为摄像机拍摄目标物的最佳图像，从而无需进行出厂前的标定，也不依赖摄像机自身自动聚焦功能，即可对摄像机的聚焦进行控制，实现了摄像机聚焦控制可互换性，还提高了摄像机清晰度控制的可靠性和效率。在一个具体实施例中，步骤S1具体包括：S101、获取摄像机相对目标物之间的物距，在恒定变焦倍数下，通过物距与聚焦参数之间的变化规律拟合为聚焦变化曲线。具体地，在保持变焦倍数不变的情况下，可以等间距改变物距，在每个物距下调整摄像机聚焦，在目标物成像最清楚时记录聚焦参数，得到在该变焦倍数下，聚焦参数随物距变化的数据。由于变焦倍数和物距的取值，以及所记录的聚焦参数都是离散的，需要对数据进行拟合或者插值得到聚焦变化曲线。S102、计算聚焦变化曲线上预设聚焦参数点的变化斜率作为单位物距聚焦参数变化率，通过单位物距聚焦参数变化率与预设物距容差进行相乘运算，得到运算结果，将运算结果与预设聚焦参数进行加减运算，得到聚焦参数控制范围。需要说明的是，聚焦参数数随物距和变焦倍数的变化，在聚焦参数范围内应具有局部单调性，局部单调性保证范围设定具有如下的性质：1)聚焦参数在此范围内单调变化时，摄像机的像距也将单调变化；2)像距最小的点和最大的点，一定在聚焦参数范围的两个端点上；3)聚焦参数范围的两个端点，对应着最近和最远的两个物距；4)不会出现范围内不同的聚焦参数会让摄像机出现相同像距的情况。聚焦参数随物距和变焦倍数变化的单调性，在拟合聚焦变化曲线时即可确定，如果变化曲线不是单调的，可通过限制变焦倍数范围来确保聚焦参数的单调性。而确定聚焦参数范围是指设定自动调整聚焦参数变化的范围，一般不应当将聚焦参数范围两个端点到预设聚焦参数的差值设置为一个固定的数值，该差值应是和变焦倍数以及物距相关的一个参数，否则可能会出现设定的聚焦参数范围两个端点对应的两个物距间距过大或者过小的情况，进而导致清晰度检测范围过大或者过小的问题，前者可能导致不能在聚焦参数范围内以有限次数搜索到成像足够清晰的图像，后者可能不能可靠的包含能够清晰成像的聚焦参数。在一个示例中，是将聚焦参数范围的两个端点设定为待拍摄目标前和后各约1m处2个物距分别对应的聚焦参数。具体的，在聚焦变化曲线上找到拍摄目标物所需预设聚焦参数的点，根据聚焦变化曲线计算该点处聚焦变化曲线的变化斜率作为单位物距聚焦参数变化率，再通过单位物距聚焦参数变化率与预设的物距容差进行相乘运算，得到聚焦参数容差，在目标物预设聚焦参数上分别加、减聚焦参数容差，得到聚焦参数控制范围。在一个具体实施例中，步骤S2具体包括：S201、在聚焦参数控制范围的约束下，将摄像机的初始聚焦参数设置为最低聚焦参数进行拍摄，获取初始聚焦参数对应的拍摄时刻；S202、将摄像机的聚焦参数由最低聚焦参数以相同步长逐步调整至最高聚焦参数，获取最高聚焦参数对应的拍摄时刻，其中每个步长对应有不同的聚焦参数；其中，可以将聚焦参数控制范围均等分为若干份，如20份，以10ms为步长逐个设置摄像机由最低聚焦参数调整至最高聚焦参数。S203、获取不同聚焦参数分别对应的视频流。在一个具体实施例中，步骤S4具体包括：S401、对视频帧图像中预定区域图像进行灰度处理，得到二维灰度图像，对视频帧图像中除预定区域图像之外的图像进行模糊化处理。需要说明的是，对视频进行解帧存在时延，而步骤S4中的所有视频帧图像是为拍摄时刻+时延对应的时刻所得到的视频帧图像。其中，在视频帧图像上选取一个区域作为预定区域图像，以作为计算清晰度的区域，一用于限制检查清晰度的空间范围，在该区域外，即使可能会出现具有清晰纹理的前景或背景物体，也不会干扰需要保证拍摄清楚的物体的清晰度判定计算。假设需确保拍摄清楚的物体位于画面中央，约占画面高度的50％，物体在画面中长宽基本一致，则可以设置一个位于画面正中，长宽均为画面高度50％象素的矩形区域。预定区域的形状并不作为限定，如果预定区域为不规则图形，可通过将预定区域进行适当的扩张，并将区域外侧图像做模糊化处理。在一个示例中，当聚焦在瓷砖墙时，瓷砖墙的图像也能输出较高的聚焦清晰度数值，有可能会高于感兴趣区域图像聚焦清晰时输出的聚焦清晰度数值，进而导致聚焦位置判断失效。需要根据感兴趣目标的位置来大致设置这个区域避开瓷砖墙。S402、利用Laplacian剃度函数对二维灰度图像进行剃度处理，得到梯度图像。其中，Laplacian剃度函数是OpenCV库提供的函数，用于计算二维图像像素强度，强化图片的突变。S403、计算梯度图像的方差来表征清晰度值。其中，表征清晰度高低，对于同一个目标拍照，聚焦越清楚，图像中的像素的变化越显著。Laplacian剃度函数将图像转换成了凸显边缘或者像素突变程度的二维矩阵，还需要将这个二维矩阵单值化，并利用方差将二维数据计算为单个数值，以便于表征清晰度值。S404、将所有视频帧图像分别对应的清晰度值进行比对，根据比对结果获取清晰度值最高的视频帧图像作为摄像机拍摄目标物的最佳图像。在一个具体实施例中，步骤S4之后还包括：S5、将视频帧图像与相应的聚焦参数构建映射关系。其中，将视频帧图像与相应的聚焦参数构建映射关系，可以使得所有视频帧线性映射到聚焦参数控制范围内，即为每一帧图像绑定一个聚焦参数值。S6、获取清晰度值最高的视频帧图像对应的聚焦参数，若其聚焦参数为最低聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FA-ΔF×0.9FB'＝FA+ΔF×0.1式中，FA'为更新后的最低聚焦参数，FA为更新前的最低聚焦参数，ΔF为单位聚焦参数变化量，FB'为更新后的最高聚焦参数，更新后的聚焦参数控制范围为；若其聚焦参数为最高聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FB-ΔF×0.1FB'＝FB+ΔF×0.9若其聚焦参数为中间聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FC-ΔF×0.4FB'＝FC+ΔF×0.4式中，FC为中间聚焦参数；其中，聚焦值范围中的非最高和最低的某个聚焦参数，将其称为中间聚焦参数，而非限定最中心的聚焦参数。S7、根据更新后的聚焦参数控制范围，重新执行步骤S2～S4。以上为本发明提供的一种摄像机聚焦控制方法的实施例的详细描述，以下为本发明提供的一种摄像机聚焦控制系统的实施例的详细描述。为了方便理解，请参阅图2，本发明提供的一种摄像机聚焦控制系统，包括：范围计算模块100，用于在恒定变焦倍数下，根据摄像机拍摄目标物的预设聚焦参数、单位物距聚焦参数变化率以及预设物距容差计算聚焦参数控制范围；调整模块200，用于将摄像机在聚焦参数控制范围内，以相同的预设步长由最低聚焦参数调整至最高聚焦参数，得到不同聚焦参数分别对应的视频帧；解码模块300，用于对每一个视频帧进行解码，得到不同聚焦参数分别对应的视频帧图像；清晰度计算模块400，用于计算所有视频帧图像的清晰度值，获取清晰度值最高的视频帧图像作为摄像机拍摄目标物的最佳图像。在一个具体实施例中，范围计算模块具体包括：拟合模块，用于获取摄像机相对目标物之间的物距，在恒定变焦倍数下，通过物距与聚焦参数之间的变化规律拟合为聚焦变化曲线；计算模块，用于计算聚焦变化曲线上预设聚焦参数点的变化斜率作为单位物距聚焦参数变化率，通过单位物距聚焦参数变化率与预设物距容差进行相乘运算，得到运算结果，将运算结果与预设聚焦参数进行加减运算，得到聚焦参数控制范围。在一个具体实施例中，调整模块具体包括：设置模块，用于在聚焦参数控制范围的约束下，将摄像机的初始聚焦参数设置为最低聚焦参数进行拍摄，获取初始聚焦参数对应的拍摄时刻；聚焦调整模块，用于将摄像机的聚焦参数由最低聚焦参数以相同步长逐步调整至最高聚焦参数，获取最高聚焦参数对应的拍摄时刻，其中每个步长对应有不同的聚焦参数；视频流模块，用于获取不同聚焦参数分别对应的视频流。在一个具体实施例中，清晰度计算模块具体包括：灰度模块，用于对视频帧图像中预定区域图像进行灰度处理，得到二维灰度图像，对视频帧图像中除预定区域图像之外的图像进行模糊化处理；梯度模块，用于利用Laplacian剃度函数对二维灰度图像进行剃度处理，得到梯度图像；方差计算模块，用于计算梯度图像的方差来表征清晰度值；比对模块，用于将所有视频帧图像分别对应的清晰度值进行比对，根据比对结果获取清晰度值最高的视频帧图像作为摄像机拍摄目标物的最佳图像。在一个具体实施例中，本系统还包括：映射模块，用于将视频帧图像与相应的聚焦参数构建映射关系；更新模块，用于获取清晰度值最高的视频帧图像对应的聚焦参数，若其聚焦参数为最低聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FA-ΔF×0.9FB'＝FA+ΔF×0.1式中，FA'为更新后的最低聚焦参数，FA为更新前的最低聚焦参数，ΔF为单位聚焦参数变化量，FB'为更新后的最高聚焦参数，更新后的聚焦参数控制范围为；若其聚焦参数为最高聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FB-ΔF×0.1FB'＝FB+ΔF×0.9若其聚焦参数为中间聚焦参数，则通过下式更新聚焦参数控制范围：FA'＝FC-ΔF×0.4FB'＝FC+ΔF×0.4式中，FC为中间聚焦参数。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的系统，装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在本发明所提供的几个实施例中，应该理解到，所揭露的装置和方法，可以通过其它的方式实现。例如，以上所描述的装置实施例仅仅是示意性的，例如，单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
