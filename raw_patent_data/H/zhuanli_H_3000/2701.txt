标题title
一种基于互联网的线上教学数据传输系统
摘要abst
本发明提供一种基于互联网的线上教学数据传输系统，包括教师端、学生端、服务器；在上课上传演示文稿、初始头像服务器；上课时实时采集演示文稿的状态、书写笔迹、头像数据，并进行数据处理；上课前学生端下载演示文稿和初始头像；上课时，学生端实时获取演示文稿的状态、笔迹数据、表情数据，将笔迹数据、表情数据进行叠加显示。通过上述方案解决了教学直播时传输数据量过大的问题。
权利要求书clms
1.一种基于互联网的线上教学数据传输系统，所述系统包括教师端、学生端、服务器；其特征在于：在上课前由教师经所述教师端上传演示文稿至所述服务器；在上课前由所述教师端采集所述教师的初始头像，并传输至服务器；在上课时由所述教师端实时采集所述演示文稿的状态，并传输至所述服务器；在上课时由所述教师端实时采集教师在演示文稿上的书写笔迹，并将所述书写笔迹转换成坐标串，并传输至所述服务器；在上课时由所述教师端实时采集教师端实时采集教师的实时头像数据，并获取所述实时头像数据的表情区域，并将所述表情区域传输至所述服务器；在上课前由所述学生端从所述服务器下载所述演示文稿和所述初始头像；所述学生端将所述演示文稿显示于第一图层；在上课时，所述学生端实时从所述服务器获取所述演示文稿的状态，并根据所述演示文稿的状态修改所述第一图层的显示内容；所述学生端根据所述演示文稿生成第二图层；在上课时，所述学生端实时从所述服务器获取所述书写笔迹的坐标串，并将所述坐标串显示于第二图层；在上课时，所述学生端实时从所述服务器获取所述表情区域，根据所述表情区域修改所述初始头像，将得到的结果显示于第三图层；叠加所述第一图层，第二图层，第三图层，将得到的图像显示于所述学生端。2.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：所述演示文稿的状态包括文稿ID、当前显示页数、当前显示的行数。3.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：将所述书写笔迹转换成坐标串，并传输至所述服务器时还一并将笔迹对应的文稿ID、笔迹所在页面传输至所述服务器。4.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：以预设间隔对所述笔迹进行采样以得到所述坐标串。5.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：所述教师端和学生端的显示页面的分辨率设定为一致。6.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：所述根据所述演示文稿的状态修改所述第一图层的显示内容具体为学生端在接收到演示文稿的状态数据后，根据状态数据中的文稿ID判断当前的文稿是否是教师端正在显示的文稿，如果是继续根据页数将文稿翻页至相应的页数，并根据行数将文稿滚动至相应的位置，这样学生端的文稿的状态即与教师端的同步了，并将修改后的少于端的文稿图像数据显示于第一图层中。7.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：所述获取所述实时头像数据的表情区域具体为：通过所述教师端实时采集教师的头像图像，并对所述头像图像进行离散小波变化；经过一次小波变换后，将小波变换后的HH区域结果转换为高频图像，对所述高频图像以N*N的窗口进行遍历，其中N为不小于3的奇数，当所述N*N的窗口内像素值大于第一阈值的比例大于第一预设值时，将所述N*N窗口的全部数据标识为特征数据；遍历结束后，将所有被标识为特征数据的像素组成的区域确定为表情区域。8.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：所述学生端根据所述演示文稿生成第二图层具体为：根据演示文稿的每一页都生成一个透明掩膜，将所有的透明掩膜显示于第二图层上。9.根据权利要求1所述的基于互联网的线上教学数据传输系统，其特征在于：所述学生端实时从所述服务器获取所述书写笔迹的坐标串，并将所述坐标串显示于第二图层包括：在接收到笔迹数据后，将文稿页面上的笔迹坐标直接映射至文稿页面对应的透明掩膜上。10.权利要求4所述的基于互联网的线上教学数据传输系统，其特征在于：所述根据所述表情区域修改所述初始头像具体为：将所述表情区域与所述初始头像做相似度计算，以预设窗口遍历所述表情区域与所述初始头像，对所述表情区域窗口内的像素点与所述初始头像窗口内的像素点进行余弦相似度计算，当所述余弦相似度大于第二预设值时将所述表情区域窗口的中心点与所述初始头像窗口的中心点设为对应点；设初始头像像素点为B，表情区域对应点的像素点为F，其中m,n为像素的坐标点，采用如下方法进行融合：S＝ω1B+F+ω2B+F…ωkB+F其中S为融合结果，ωk为加权系数，k为融合范围，取值为正整数，优选地，k取值为1，2，3，4，5；其中kmax为k能够取的最大值。
说明书desc
技术领域本发明涉及互联网技术领域，具体而言涉及一种基于互联网的线 上教学数据传输系统。背景技术随着互联网的发展，互联网的线上教学已越来越普遍，但互联网 的线上教学过程中需要传输大量的图像信息，而图像信息非常地占宽 带，当网络拥挤时及容易出现卡顿问题；目前的卡顿的主要解决方案 是降低视频图像的清晰度，但线上教学经常需要学生关注图像上的文 字信息，而降低视频图像的清晰度会造成文字信息难以辨认，给上课 学生造成困扰。发明内容为了解决互联联网教学线上教学直播时的卡顿、图像不清晰等问 题，本发明提供一种基于互联网的线上教学数据传输系统。在本发明的一个方面，提供一种基于互联网的线上教学数据传输 系统，所述系统包括教师端、学生端、服务器；其特征在于：在上课 前由教师经所述教师端上传演示文稿至所述服务器；在上课前由所述 教师端采集所述教师的初始头像，并传输至服务器；在上课时由所述 教师端实时采集所述演示文稿的状态，并传输至所述服务器；在上课 时由所述教师端实时采集教师在演示文稿上的书写笔迹，并将所述书 写笔迹转换成坐标串，并传输至所述服务器；在上课时由所述教师端 实时采集教师端实时采集教师的实时头像数据，并获取所述实时头像 数据的表情区域，并将所述表情区域传输至所述服务器；在上课前由所述学生端从所述服务器下载所述演示文稿和所述初始头像；所述学 生端将所述演示文稿显示于第一图层；在上课时，所述学生端实时 从所述服务器获取所述演示文稿的状态，并根据所述演示文稿的状态 修改所述第一图层的显示内容；所述学生端根据所述演示文稿生成第 二图层；在上课时，所述学生端实时从所述服务器获取所述书写笔迹 的坐标串，并将所述坐标串显示于第二图层；在上课时，所述学生端 实时从所述服务器获取所述表情区域，根据所述表情区域修改所述初 始头像，将得到的结果显示于第三图层；叠加所述第一图层，第二图 层，第三图层，将得到的图像显示于所述学生端。进一步地，所述演示文稿的状态包括文稿ID、当前显示页数、 当前显示的行数。进一步地，将所述书写笔迹转换成坐标串，并传输至所述服务器 时还一并将笔迹对应的文稿ID、笔迹所在页面传输至所述服务器。进一步地，以预设间隔对所述笔迹进行采样以得到所述坐标串。进一步地，所述教师端和学生端的显示页面的分辨率设定为一致。进一步地，所述根据所述演示文稿的状态修改所述第一图层的显 示内容具体为学生端在接收到演示文稿的状态数据后，根据状态数据 中的文稿ID判断当前的文稿是否是教师端正在显示的文稿，如果是 继续根据页数将文稿翻页至相应的页数，并根据行数将文稿滚动至相 应的位置，这样学生端的文稿的状态即与教师端的同步了，并将修改 后的少于端的文稿图像数据显示于第一图层中。进一步地，所述获取所述实时头像数据的表情区域具体为：通过 所述教师端实时采集教师的头像图像，并对所述头像图像进行离散小 波变化；经过一次小波变换后，将小波变换后的HH区域结果转换为 高频图像，对所述高频图像以N*N的窗口进行遍历，其中N为不小于 3的奇数，当所述N*N的窗口内像素值大于第一阈值的比例大于第一 预设值时，将所述N*N窗口的全部数据标识为特征数据；遍历结束后， 将所有被标识为特征数据的像素组成的区域确定为表情区域。进一步地，所述学生端根据所述演示文稿生成第二图层具体为： 根据演示文稿的每一页都生成一个透明掩膜，将所有的透明掩膜显示 于第二图层上。进一步地，所述学生端实时从所述服务器获取所述书写笔迹的坐 标串，并将所述坐标串显示于第二图层包括：在接收到笔迹数据后， 将文稿页面上的笔迹坐标直接映射至文稿页面对应的透明掩膜上。进一步地，所述学生端根据所述演示文稿生成第二图层具体为： 根据演示文稿的每一页都生成一个透明掩膜，将所有的透明掩膜显示 于第二图层上。进一步地，所述根据所述表情区域修改所述初始头像具体为：将所述 表情区域与所述初始头像做相似度计算，以预设窗口遍历所述表情区 域与所述初始头像，对所述表情区域窗口内的像素点与所述初始头像 窗口内的像素点进行余弦相似度计算，当所述余弦相似度大于第二预 设值时将所述表情区域窗口的中心点与所述初始头像窗口的中心点设为对应点；设初始头像像素点为B，表情区域对应点的像素 点为F，其中m,n为像素的坐标点，采用如下方法进行融合：S＝ω1B+F+ω2B+F…ωkB+F其中S为融合结果，ωk为加权系数，k为融合范围，取值为正整 数，优选地，k取值为1，2，3，4，5；其中kmax为k能够取的最大值。本发明通过上述技术方案，将演示文稿提前传输至学生端，将笔 迹进行数字化，对教师头像进行处理，只在上课期间传输表情数据， 减少了上课期间的数据传输，可以缓解直播期间的卡顿问题，并且保 证直播的清晰度。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面 将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描 述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来 讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的 附图。图1本发明的系统结构图。具体实施方式下面，结合附图以及具体实施方式，对发明做出优选的描述。如图1所示，本发明的系统包括至少一个教师端，至少一个服务 器，以及多个学生端。在上课前由教师经所述教师端上传演示文稿至所述服务器。目前线上的直播教育都是直接将教师的整个屏幕内容直接传送 到客户端，当网络质量不佳时，将清晰度调低，这就导致学生无法看 清教师的演示的内容。在本实施例中，为了例学生能够清晰地看到显示内容，教师在上 课之前先将演示文稿上传至服务器以供学生下载。上课之前可以是正 式开始直播前的任意时间，演示文稿可以是PPT、Word、PDF等任意 格式的文稿，本实施方式不做任何限定。在上课前由所述教师端采集所述教师的初始头像，并传输至服务 器。为了让学生能够看到教师的表情变化，目前的教学直播通常会将 教师的实时头像显示于直播区域的一角，如右下角；但实时的头像传 输非常地占带宽，为了减少直播时的数据传输，本实施例事先将教师 的头像采集至服务器端，后续可由学生端事先下载，在直播时根据教 师端的采集到的教师表情变化实时修改头像的表情，以减少数据的传 输。在上课时由所述教师端实时采集所述演示文稿的状态，并传输至 所述服务器；由于上课时演示文稿的页面可能会变动，例如，教师从第3页翻 页至第5页后页面会产生变化，为了将文稿的页面变化传递至学生端， 保持教师端和学生端的一致，本实施例将文稿的当前状态同步至服务 器并同步至学生端，具体地，如下表所示，将文稿的的文稿I D、当 前显示页数、当前显示的行数传递至学生端。文稿ID当前显示页数行数 由于文稿ID、当前显示页数、行数均是以数字文本表示的，因 此数据量非常的地小，这样可以大大减少传输的数据量；进一步地， 教师端可以周期性地，例如每2秒一次将文稿的状态传送至学生端， 也可以仅在教师端的文稿状态有改变时才将当前的状态传输至学生 端。在上课时由所述教师端实时采集教师在演示文稿上的书写笔迹， 并将所述书写笔迹转换成坐标串，并传输至所述服务器。在教师上课时，难免在文件上写写画画，因此，传统线上教学系 统都是使用屏幕图像直接传输，图像的传输会导致传输数据过大的问 题，为了解决传输图像过大的问题，本实施例进一步地对书写的笔画 进行优化。通学教师的笔画是针对文稿页面的，因此传输的数据首先 需要确定是针对文稿的哪一页，对于特定的文件，每一页的页面大小 已确定，因此文稿中的每一个位置的的相对坐标就确定了具体的示例，以PPT为例，为了方便笔迹的定位，在教师和学生 的客户端中都将显示页面的分辨率设定为一致，这样，对于 PPT中的每一页均有相同的像素，每一页PPT中的元素都有相同的相 对坐标，在教师端都读取下划线的坐标；则教师端向学生端发送如下表所示的数据如上表所示，由于数据是文本类数据，因此数据量很小，可以减 少网格流量；类似的，当教师从PPT上擦除一条划线时将相应的数据进行类似 的修改，并将最后的操作字段修改为delete即可。在上课时由所述教师端实时采集教师端实时采集教师的实时头 像数据，并获取所述实时头像数据的表情区域，并将所述表情区域传 输至所述服务器；在教师上课时，学生最关注的是教师的表情变化，而人的表情主 要由眉毛、眼睛、嘴巴决定，为了能够实时获取教师的表情数据，通 过教师端实时采集教师的头像图像，并对所述头像进行离散小波变化； 经过一次小波变换后，结果中的HH区域主要是头像的轮廓数据，通 过HH区域可以明显地区分出人物的主要特征；由于人在进行表情变 化时会产生褶皱，而这些褶皱由于频域变化大，因此表情特征在被保 留在了HH区域；进一步地，为了获取表情丰富的区域，将所述HH区 域结果转换为高频图像，对所述高频图像以n*n的窗口进行遍历，其中n为不小于3的基数，当所 述n*n的窗口内像素值大于第一阈值的比例大于预设值时，将所述n*n窗口的全部数据格标为特征数据；通过上述遍历方式不仅保留了 高频像素，还将n*n窗口内的像素一并保留，类似于使用粗画笔描出 主要的表情轮廓，保留精细特征的同时保留周围的像素，以便在后续 融合时更加自然；遍历结束后，所有被标识为特征数据的数据像素即 为表情丰富的区域，将原始头像图像中的表情丰富的区域的的像素对 应的原始图像截取为表情区域，并将所述表情区域传输至服务器，以 便后续学生端进行头像的合成。经实验数据显示，表情区域的面积大幅减少后，整体的传输数据只有原始头像的不到20％，因此只传输表 情区域可以大大减少传输数据，从而减少网络压力。在上课前由所述学生端从所述服务器下载所述演示文稿和所述 初始头像。由于教师端在上课前已通过网络将演示文稿和初始头像传输至 服务器，则学生在上课前即可通过服务器下载演示文稿和教师的初始 头像；由于下载是在课前进行，并且不在乎延迟，因此下载这些数据 不会影响学生的上课体验。在课前下载演示文稿和初始头像后学生端 本地即有了清晰的演示文稿和教师头像，学生可以清晰地看到教学内 容以教师面容，避免出现因网络问题导致的不清晰问题。所述学生端将所述演示文稿显示于第一图层。为了能够方便地显示出最终的上课图像，本实施例将不同的图像 进行分层显示，以方便对不同的图层进行操作，对于演示文稿，其清 晰度决定了上课质量，由于演示文稿已下载至学生端本地，将其单独 显示一个图层可以保证演示文稿的清晰度。在上课时，所述学生端实时从所述服务器获取所述演示文稿的 状态，并根据所述演示文稿的状态修改所述第一图层的显示内容；由于教师端已将教师端处当前的演示文稿的状态传输至服务器， 学生端即可实时从服务器获取最新的演示文稿的状态，学生端在接收 到演示文稿的状态数据后，根据状态数据中的文稿I D判断当前的文 稿是否是教师端正在显示的文稿，如果是继续根据页数将文稿翻页至 相应的页数，并根据行数将文稿滚动至相应的位置，这样学生端的文 稿的状态即与教师端的同步了，并将修改后的少于端的文稿图像数据 显示于第一图层中。所述学生端根据所述演示文稿生成第二图层；由于教师的笔迹通常对应于演示文稿的一个页面，为了能够将笔 迹与演示文稿进行对应，根据演示文稿的每一页都生成一个透明掩膜， 将所有的透明掩膜显示于第二图层上，这样每一个掩膜就对应于一个 演示文稿页，演示文稿页面上的坐标也与一个透明掩膜一一对应。在上课时，所述学生端实时从所述服务器获取所述书写笔迹的坐 标串，并将所述坐标串显示于第二图层。教师端在书写后产生了多个与页面对应的笔迹，学生端在获得笔 迹后即可以根据文稿ID来确定当前显示的文稿是否是教师写字的文 稿，当当前的文稿是教师写字的文稿后根据文稿的页面确定与之对应 的透明掩膜，由于透明掩膜与文稿的一个页面是完全对应的，因此文 稿页面上的笔迹坐标可以直接映射至透明掩膜上，这样就可以在透明 掩膜上显示与教师端相同的笔迹了。在上课时，所述学生端实时从所述服务器获取所述表情区域，根 据所述表情区域修改所述初始头像，将得到的结果显示于第三图层；为了在学生端显示教师的实时表情数据，学生端实时从服务器下 载教师端上传的表情区域数据，由于表情区域数据并不是完整的教师 头像，因此需要将表情区域数据与初始的教师头像进行实时的融合， 以便实时显示教师的表情。具体地，融合采用如下方法进行：首先进行区域判断，由于教师在直播时会动，因此直播时从教师 端传输过来的表情区域与初始头像的坐标并不是完全对应的；因此首 先要进行区域匹配，如将眼睛区域与初始头像的眼匹配，将嘴巴区域 与初始图像的嘴匹配；虽然眼、嘴等会由于表情的不同导致变化，但 总体上，眼睛区域与原始图像的眼睛色调是一致的，总体上相似度极 高；因此首先将表情区域与初始头像做相似度计算，以预设窗口，遍 历所述表情区域与初始头像，对所述表情区域窗口内的像素点与所述 初始头像窗口区域内的像素点进行余弦相似度计算，当所述余弦相似 度大于第二预设值时将所述表情区域窗口的中心点与所述初始头像窗口的中心点设为对应点。设初始头像像素点为B，对应的表情区域的像素点为 F，其中m,n为像素的坐标点，由于与表情相关的人眼、眉毛、 嘴巴都是主要是水平分布，因此本实施例采用水平加权的方法时行整 合，具体算法如下：S＝ω1B+F+ω2B+F…ωkB+F其中S为融合结果，ωk为加权系数，k为融合范围，优选地， k取值为1，2，3，4，5；其中kmax为k能够取的最大值。通过本实施例的加权融合，可以将表情区域的像素更多地整合至 初始头像，使得融合保留了更多的表情的同时加入了原始底图，使得 融合边界不产生明显的融合痕迹。叠加所述第一图层，第二图层，第三图层，将得到的图像显示于 所述学生端。第一图层为演示文稿，第二图层为教师笔迹，第三图层为教师头 像，三个图层组合起来即为一个完整的课程直播图像，将三个图像叠 加后显示于学生端即可得到最终的直播效果。由于第一图层是事先下 载好的演示文稿、第三图层由于少量的文本化的坐标点生成、第三图 层由事先下载好的初始图像与实时传输的表情区域组合而成，因此三 个图层的变化均只会传输少量的数据，减少网络负担，并且最终生成 的直播画面非常清晰，保证了直播的效果。最后应当说明的是：以上实施例仅用以说明本发明的技术方案而 非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属 领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进 行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等 同替换，其均应涵盖在本发明的权利要求保护范围之内。本发明未特别明确的部分模块结构，以现有技术记载的内容为准。 本发明在前述背景技术部分以及具体实施例部分提及的现有技术可 作为本发明的一部分，用于理解部分技术特征或者参数的含义。本发 明的保护范围以权利要求实际记载的内容为准。
