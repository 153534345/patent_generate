标题title
确定IP地址的地理位置的方法及装置
摘要abst
本发明提供了一种确定IP地址的地理位置的方法及装置,应用于通信技术领域，所述确定IP地址的地理位置的方法通过获取IP数据后根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法；然后根据所述数据查找算法确定待查找IP地址的地理位置；所述IP数据包括IP地址和IP地址的地理位置；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；本发明通过分析IP数据的数据量、数据形式和数据热点选择合适的数据查找算法，避免因数据查找算法和数据特点不匹配而导致的数据查找效率低的问题，可以提高数据查找的效率，降低数据查找的成本。
权利要求书clms
1.一种确定IP地址的地理位置的方法，其特征在于，包括：获取IP数据；所述IP数据包括IP地址和IP地址的地理位置；根据所述I P数据的数据量和数据形式以及数据热点确定数据查找算法；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；根据所述数据查找算法确定待查找I P地址的地理位置。2.根据权利要求1所述的确定IP地址的地理位置的方法，其特征在于，所述根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法，包括：若所述IP数据的数据量大于或等于数量阈值并且存在数据热点，则以所述二分查找作为所述数据查找算法。3.根据权利要求1所述的确定IP地址的地理位置的方法，其特征在于，所述根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法，包括：若所述IP数据的数据量小于数量阈值并且数据分布均匀，则以所述平衡二叉树查找作为所述数据查找算法。4.根据权利要求1所述的确定IP地址的地理位置的方法，其特征在于，所述根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法，包括：若所述IP数据的数据量小于数量阈值并且存在数据热点，则以所述内存查找作为所述数据查找算法。5.根据权利要求1所述的确定IP地址的地理位置的方法，其特征在于，所述根据所述数据查找算法确定待查找I P地址的地理位置，包括：若根据所述内存查找来确定所述待查找IP地址的地理位置，则将所述IP数据加载到内存，使用二分查找查找所述待查找IP地址的地理位置。6.根据权利要求1-5中任一项所述的确定IP地址的地理位置的方法，其特征在于，在根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法之前，还包括：若所述IP数据的格式不符合IP地址库要求的格式，则将所述IP数据的格式转化为符合所述IP地址库要求的格式；所述IP地址库用于储存所述IP数据。7.一种确定IP地址的地理位置的装置，其特征在于，包括：获取模块，用于获取IP数据；所述IP数据包括IP地址和IP地址的地理位置；确定模块，根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；所述确定模块还用于根据所述数据查找算法确定待查找IP地址的地理位置。8.一种确定IP地址的地理位置的装置，其特征在于，还包括：格式转化模块，若所述IP数据的格式不符合IP地址库要求的格式，则所述格式转化模块将所述I P数据的格式转化为符合所述I P地址库要求的格式；所述IP地址库用于储存所述IP数据。9.一种电子设备，包括存储器和处理器，所述存储器上存储有计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1至6任一项所述的方法。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1至6任一项所述的方法。
说明书desc
技术领域本发明涉通信技术领域，尤其涉及一种确定IP地址的地理位置的方法及装置。背景技术在处理一些数据查询需求时，需求方会关注用户的地理维度，而定位权限属于敏感权限，很多情况下是得不到用户授权的。一般情况会根据IP的归属地得到一个较粗略的地区位置，然后统计数据后使用spark开发查询程序，查找时spark使用二分查找算法查找IP数据来获取地理位置信息，但需求很多的时候，每次有新要求就需要修改程序，处理较麻烦，而且spark利用二分查找算法查找IP数据的步骤较繁琐。发明内容本发明提供了一种确定IP地址的地理位置的方法、对话标注方法、装置、电子设备及存储介质；本发明通过分析IP数据的数据量、数据形式和数据热点选择合适的数据查找算法，避免因数据查找算法和数据特点不匹配而导致的数据查找效率低的问题，可以提高数据查找的效率，降低数据查找的成本。第一方面，本发明的实施例提供了一种确定IP地址的地理位置的方法，包括：获取IP数据；IP数据包括IP地址和IP地址的地理位置；根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；根据所述数据查找算法确定待查找IP地址的地理位置。可选地，根据IP数据的数据量和数据形式以及数据热点确定数据查找算法，包括：若IP数据的数据量大于或等于数量阈值并且存在数据热点，则以二分查找作为所述数据查找算法。可选地，根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法，包括：若IP数据的数据量小于数量阈值并且数据分布均匀，则以平衡二叉树查找作为所述数据查找算法。可选地，根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法，包括：若IP数据的数据量小于数量阈值并且存在数据热点，则以内存查找作为所述数据查找算法。可选地，根据数据查找算法确定待查找IP地址的地理位置，包括：若根据内存查找来确定待查找IP地址的地理位置，则将IP数据加载到内存，使用二分查找查找待查找IP地址的地理位置。可选地，在根据IP数据的数据量和数据形式以及数据热点确定数据查找算法之前，还包括：若IP数据的格式不符合IP地址库要求的格式，则将IP数据的格式转化为符合IP地址库要求的格式；所述IP地址库用于储存所述IP数据。第二方面，本发明的实施例提供了一种确定IP地址的地理位置的装置，包括：获取模块，用于获取IP数据；IP数据包括IP地址和IP地址的地理位置；确定模块，根据IP数据的数据量和数据形式以及数据热点确定数据查找算法；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；确定模块还可以用于根据所述数据查找算法确定待查找IP地址的地理位置。可选地，确定IP地址的地理位置的装置还包括：格式转化模块，若IP数据的格式不符合IP地址库要求的格式，则格式转化模块将IP数据的格式转化为符合IP地址库要求的格式；所述IP地址库用于储存所述IP数据。第三方面，本发明的实施例提供了一种电子设备，包括存储器和处理器，所述存储器上存储有计算机程序，所述处理器执行所述程序时实现如第一方面中任一实现方式所述的方法。第四方面，本发明的实施例提供了一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现如第一方面中任一实现方式所述的方法。本发明提供了一种确定IP地址的地理位置的方法及装置,所述确定IP地址的地理位置的方法通过获取IP数据后根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法；然后根据所述数据查找算法确定待查找IP地址的地理位置；所述IP数据包括IP地址和IP地址的地理位置；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；本发明通过分析IP数据的数据量、数据形式和数据热点选择合适的数据查找算法，避免因数据查找算法和数据特点不匹配而导致的数据查找效率低的问题，可以提高数据查找的效率，降低数据查找的成本。应当理解，发明内容部分中所描述的内容并非旨在限定本发明的实施例的关键或重要特征，亦非用于限制本发明的范围。本发明的其它特征将通过以下的描述变得容易理解。附图说明结合附图并参考以下详细说明，本发明各实施例的上述和其他特征、优点及方面将变得更加明显。在附图中，相同或相似的附图标记表示相同或相似的元素。图1为本发明实施例的一种确定IP地址的地理位置的方法的流程图；图2为本发明另一实施例的一种确定IP地址的地理位置的方法的流程图；图3为本发明实施例的一种确定IP地址的地理位置的装置的结构示意图；图4为本发明实施例的一种电子设备的结构图。具体实施方式为了使本技术领域的人员更好地理解本说明书一个或多个实施例中的技术方案，下面将结合本说明书一个或多个实施例中的附图，对本说明书一个或多个实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本说明书的一部分实施例，而不是全部的实施例。基于本说明书一个或多个实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都应当属于本文件的保护范围。需要说明的是，本发明实施例描述的仅仅是为了更加清楚的说明本发明实施例的技术方案，并不构成对本发明实施例提供的技术方案的限定。图1为本发明实施例的一种确定IP地址的地理位置的方法的流程图。如图1所示，包括：S101、获取IP数据。其中，IP数据包括IP地址和IP地址的地理位置。可选地，IP数据可以通过爬虫爬取获得也可以根据收集的历史IP数据统计获取。可选地，若获取的IP数据的格式不符合IP地址库要求的格式，则将IP数据的格式转化为符合IP地址库要求的格式；所述IP地址库用于储存IP数据。可选地，IP地址库可以使用IP2Location或IPv6数据库。S102、根据IP数据的数据量和数据形式以及数据热点确定数据查找算法。其中，所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找。可选地，若IP数据的数据量大于或等于数量阈值并且存在数据热点，则以二分查找作为数据查找算法；若IP数据的数据量小于数量阈值并且数据分布均匀，则以平衡二叉树查找作为数据查找算法；若IP数据的数据量小于数量阈值并且存在数据热点，则以内存查找作为数据查找算法。S103、根据数据查找算法确定待查找IP地址的地理位置。可选地，使用二分查找来确定待查找IP地址的地理位置时，将获取的IP数据以表的形式进行存储，且表中元素是按关键字值升序排列，将表中间位置记录的关键字值与待查找IP地址的关键字值比较，如果两者相等，则查找成功；若不相等则利用中间位置记录将表分成前、后两个子表，如果中间位置记录的关键字值大于待查找IP地址的关键字值，则进一步查找前一子表，否则进一步查找后一子表。重复以上过程，直到找到满足条件的记录，或直到子表不存在为止，结束查找。可选地，使用平衡二叉树查找来确定待查找IP地址的地理位置时，将获取的IP数据以平衡二叉树形式进行存储，平衡二叉树是一种结构平衡的二叉搜索树，即叶节点高度差的绝对值不超过1，并且左右两个子树都是一棵平衡二叉树，常见的平衡二叉搜索树包括：AVL树，红黑树，Treap，节点大小平衡树。根据平衡二叉树查找数据时，从根结点开始，沿某个分支逐层向下进行比较，若平衡二叉树非空，则将待查找数据的关键字与根结点的关键字比较，若相等，则查找成功；若不等，则当根结点的关键字值大于待查找数据的关键字值时，在根结点的左子树中查找；否则在根结点的右子树中查找。可选地，若选取内存查找来确定待查找IP地址的地理位置，则将IP数据加载到内存，使用二分查找确定待查找IP地址的地理位置。将内存中的IP数据以数组的形式进行存储并设置头下标、中值下标和尾部下标，其中，数组中元素以关键字值排序后存储，中值下标为数组中间元素的下标。然后将待查找IP地址与数组中的中间元素比较，若相同则找到，若不相同则比较中间元素的关键字值与待查找IP地址的关键字值，若待查找IP地址的关键字值大于数组中间元素的关键字值时，则将头下标作为中值下标，在重新选取中值下标，反之则将尾部下标作为中值下标，在重新选取中值下标。直到找到待查找IP地址或当头下标与尾部下标相邻时结束查找。示例性地，图2为本发明另一实施例的一种确定IP地址的地理位置的方法的流程图。如图所示：在确定待查找IP地址的地理位置时，调用函数并进行初始化，初始化包括：从IP地址库中获取IP数据文件，创建DBsearcher实例用于查找IP数据文件。然后根据IP数据文件中IP数据的数据量和数据形式以及数据热点确定数据查找算法，然后输入待查找IP地址。其中，如何根据IP数据的数据量和数据形式以及数据热点确定数据查找算法可以参考步骤S102，此处不再赘述。接着验证输入的IP地址是否合法，若合法则根据确定的查找算法查找并返回地理位置结果，进一步的去判断输入的待查找IP地址是否都完成查找，若全部完成则结束查找，若没有则继续下一个IP地址的查找；若不合法则报错并判断所有输入的IP地址是否都已经查找完成，若完成则结束查找，若没有则继续下一个IP地址的查找。本实施例提供了一种确定IP地址的地理位置的方法及装置，所述确定IP地址的地理位置的方法通过获取IP数据后根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法；然后根据所述数据查找算法确定待查找IP地址的地理位置；所述IP数据包括IP地址和IP地址的地理位置；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；本实施例通过分析IP数据的数据量、数据形式和数据热点选择合适的数据查找算法，避免因数据查找算法和数据特点不匹配而导致的数据查找效率低的问题，可以提高数据查找的效率，降低数据查找的成本。以下结合图3详细说明本申请实施例提供的可以执行上述确定IP地址的地理位置的装置。示例性地，图3为本发明实施例的一种确定IP地址的地理位置的装置的结构示意图；如图3所示，所述确定装置30包括：获取模块301，用于获取IP数据；IP数据包括IP地址和IP地址的地理位置.确定模块302，用于根据IP数据的数据量和数据形式以及数据热点确定数据查找算法；所述数据查找算法为如下之一：二分查找、平衡二叉树查找和内存查找；确定模块302，还用于根据所述数据查找算法确定待查找IP地址的地理位置。可选地，根据IP数据的数据量和数据形式以及数据热点确定数据查找算法，包括：若IP数据的数据量大于或等于数量阈值并且存在数据热点，则以二分查找作为数据查找算法。若IP数据的数据量小于数量阈值并且数据分布均匀，则以平衡二叉树查找作为数据查找算法。若IP数据的数据量小于数量阈值并且存在数据热点，则以内存查找作为数据查找算法。可选地，根据选取的数据查找算法确定待查找IP地址的地理位置，包括：若选取内存查找来确定待查找IP地址的地理位置，则将IP数据加载到内存，使用二分查找查找待查找IP地址的地理位置。可选地，确定装置30还包括格式转化模块303，格式转化模块303用于验证IP数据的格式，若IP数据的格式不符合IP地址库要求的格式，则将IP数据的格式转化为符合IP地址库要求的格式；所述IP地址库用于储存所述IP数据。本发明实施例还提供了一种计算机电子设备，图4示出了可以应用本发明实施例的电子设备的结构示意图，如图4所示，该计算机电子设备包括，中央处理模块401，其可以根据存储在只读存储器402中的程序或者从存储部分408加载到随机访问存储器403中的程序而执行各种适当的动作和处理。在RAM403中，还存储有系统操作所需的各种程序和数据。CPU 401、ROM 402以及RAM 403通过总线404彼此相连。输入/输出接口405也连接至总线404。以下部件连接至I/O接口405：包括键盘、鼠标等的输入部分406；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分407；包括硬盘等的存储部分408；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分409。通信部分409经由诸如因特网的网络执行通信处理。驱动器410也根据需要连接至I/O接口405。可拆卸介质411，诸如磁盘、光盘、磁光盘、半导体存储器等，根据需要安装在驱动器410上，以便于从其上读出的计算机程序根据需要被安装入存储部分408。附图中的流程图和框图，图示了按照本发明各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，所述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本发明实施例中所涉及到的模块或模块可以通过软件的方式实现，也可以通过硬件的方式来实现。所描述的模块或模块也可以设置在处理器中，例如，可以描述为：一种处理器包括获取模块301和确定模块302，其中，这些模块的名称在某种情况下并不构成对该模块本身的限定，例如，确定模块302还可以被描述为“根据所述IP数据的数据量和数据形式以及数据热点确定数据查找算法的确定模块302”。作为另一方面，本发明还提供了一种计算机可读存储介质，该计算机可读存储介质可以是上述实施例中所述一种确定IP地址的地理位置的装置中所包含的计算机可读存储介质；也可以是单独存在，未装配入电子设备中的计算机可读存储介质。计算机可读存储介质存储有一个或者一个以上程序，所述程序被一个或者一个以上的处理器用来执行描述于本发明的一种确定IP地址的地理位置的方法。以上描述仅为本发明的较佳实施例以及对所运用技术原理的说明。本领域技术人员应当理解，本发明中所涉及的发明范围，并不限于上述技术特征的特定组合而成的技术方案，同时也应涵盖在不脱离所述发明构思的情况下，由上述技术特征或其等同特征进行任意组合而形成的其它技术方案。例如上述特征与本发明中公开的具有类似功能的技术特征进行互相替换而形成的技术方案。
