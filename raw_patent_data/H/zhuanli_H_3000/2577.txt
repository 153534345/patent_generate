标题title
一种工业防火墙策略规划方法、系统及电子设备
摘要abst
本申请涉及一种工业防火墙策略规划方法、系统及电子设备，涉及网络安全的技术领域，其方法包括获取到达防火墙的数据包；基于数据包解析得到解析数据；判断端口号的源端口是否存在于白名单中；如果不存在于报名单中，则基于解析数据及BM模式匹配算法得到匹配项数；判断匹配项数是否大于预设项数；如果不大于预设项数，则接收数据包并对端口号的源端口在预设时长内的访问次数进行加一处理；判断加一后的访问次数是否大于应达次数；如果是，则将源端口加入白名单规则表中。本申请具有便于更好地进行工业防火墙策略规划的效果。
权利要求书clms
1.一种工业防火墙策略规划方法，其特征在于，包括：获取到达防火墙的数据包；基于所述数据包解析得到解析数据；所述解析数据包括IP地址、端口号、传输协议及数据信息；判断所述端口号的源端口是否存在于白名单中；如果不存在于报名单中，则基于所述解析数据及BM模式匹配算法得到匹配项数；所述匹配项数包括匹配项数依次增加的第一项数、第二项数、第三项数、第四项数及第五项数；所述第一项数的匹配项数为零；判断所述匹配项数是否大于预设项数；如果不大于所述预设项数，则接收所述数据包并对所述端口号的源端口在预设时长内的访问次数进行加一处理；判断加一后的所述访问次数是否大于应达次数；如果是，则将所述源端口加入白名单规则表中。2.根据权利要求1所述的一种工业防火墙策略规划方法，其特征在于，所述方法还包括：当判定所述匹配项数大于预设项数，将所述数据包过滤。3.根据权利要求1所述的一种工业防火墙策略规划方法，其特征在于，所述应达次数的获取方法包括：获取所述端口号的源端口上一次访问的时刻；基于所述上一次访问的时刻及当前时刻得到间隔时长；基于得到所述应达次数；其中，Q为应达次数；所述A、B为常系数；所述T为预设时长；所述为间隔时长；所述n+1为加一后的所述访问次数。4.根据权利要求1所述的一种工业防火墙策略规划方法，其特征在于，基于所述解析数据及BM模式匹配算法得到匹配项数，包括：将所述解析数据中的每一项数据分解为若干数据块；若干数据块的数目与所述数据的项的类别相关；将所述若干数据块与模式串进行匹配，基于完全匹配条件或停止条件得到所述项数据是否匹配。5.根据权利要求1所述的一种工业防火墙策略规划方法，其特征在于，将所述源端口加入白名单规则表中之后，还包括：生成添加日志；将所述添加日志发送至管理员端；判断在预设时长内是否接收到所述管理员端发送的确认信息；如果否，将所述源端口剔出所述白名单规则表；如果是，则在下一次接收到所述源端口发送的数据包直接进行响应。6.根据权利要求1所述的一种工业防火墙策略规划方法，其特征在于，所述方法还包括：若判定所述端口号的源端口存在于白名单中，则基于所述解析数据及BM模式匹配算法得到匹配项数；判断所述匹配项数是否大于预设项数；如果不大于所述预设项数，直接进行响应并生成工作日志。7.一种工业防火墙策略规划系统，其特征在于，包括：第一处理模块，用于：获取到达防火墙的数据包；第二处理模块，用于：基于所述数据包解析得到解析数据；所述解析数据包括IP地址、端口号、传输协议及数据信息；第三处理模块，用于：判断所述端口号的源端口是否存在于白名单中；第四处理模块，用于在所述端口号的源端口不存在于白名单中时，基于所述解析数据及BM模式匹配算法得到匹配项数；所述匹配项数包括匹配项数依次增加的第一项数、第二项数、第三项数、第四项数及第五项数；所述第一项数的匹配项数为零；第五处理模块，用于：判断所述匹配项数是否大于预设项数；如果不大于所述预设项数，则接收所述数据包并对所述端口号的源端口在预设时长内的访问次数进行加一处理；以及，第六处理模块，用于：判断加一后的所述访问次数是否大于应达次数；如果是，则将所述源端口加入白名单规则表中。8.根据权利要求7所述的一种工业防火墙策略规划系统，其特征在于，所述系统还包括用于获取应达次数的第七处理模块；所述第七处理模块包括：第一处理子模块，用于：获取所述端口号的源端口上一次访问的时刻；第二处理子模块，用于：基于所述上一次访问的时刻及当前时刻得到间隔时长；以及，第三处理子模块，用于：基于得到所述应达次数；其中，Q为应达次数；所述A、B为常系数；所述T为预设时长；所述为间隔时长；所述n+1为加一后的所述访问次数。9.根据权利要求7所述的一种工业防火墙策略规划系统，其特征在于，所述第四处理模块包括：第四处理子模块，用于：将所述解析数据中的每一项数据分解为若干数据块；若干数据块的数目与所述数据的项的类别相关；以及，第五处理子模块，用于：将所述若干数据块与模式串进行匹配，基于完全匹配条件或停止条件得到所述项数据是否匹配。10.一种电子设备，其特征在于：包括存储器和服务器，所述存储器上存储有被服务器加载并执行的如权利要求1至6中任一方法的计算机程序。
说明书desc
技术领域本申请涉及网络安全的技术领域，尤其是涉及一种工业防火墙策略规划方法、系统及电子设备。背景技术工业防火墙在工业网络安全领域具有非常重要的防护作用，目前的工业防火墙技术主要采用Internet网中传统的防火墙架构，加上针对工业协议专有的包过滤策略组合而成。在相关技术中，防火墙通常预先设定好过滤规则进而实现工业系统的安全防护策略。针对上述中的相关技术，发明人发现：防火墙过滤规则不容易设定，容易导致某些正常数据包也无法通过检测。发明内容为了便于更好地进行工业防火墙策略规划，本申请提供了一种工业防火墙策略规划方法、系统及电子设备。第一方面，本申请提供的一种工业防火墙策略规划方法采用如下的技术方案。一种工业防火墙策略规划方法，包括：获取到达防火墙的数据包；基于所述数据包解析得到解析数据；所述解析数据包括IP地址、端口号、传输协议及数据信息；判断所述端口号的源端口是否存在于白名单中；如果不存在于报名单中，则基于所述解析数据及BM模式匹配算法得到匹配项数；所述匹配项数包括匹配项数依次增加的第一项数、第二项数、第三项数、第四项数及第五项数；所述第一项数的匹配项数为零；判断所述匹配项数是否大于预设项数；如果不大于所述预设项数，则接收所述数据包并对所述端口号的源端口在预设时长内的访问次数进行加一处理；判断加一后的所述访问次数是否大于应达次数；如果是，则将所述源端口加入白名单规则表中。通过采用上述技术方案，服务器将加一后的访问次数与应达次数进行比较，当加一后的访问次数大于应达次数，说明该源端口发送足够量的判定为安全的数据包，此时，服务器将该源端口加入白名单规则表中，便于该源端口后续发送的数据包通过防火墙，进而能够自主对报名单规则表进行更新，减少正常数据包被过滤的可能性。可选的，所述方法还包括：当判定所述匹配项数大于预设项数，将所述数据包过滤。可选的，所述应达次数的获取方法包括：获取所述端口号的源端口上一次访问的时刻；基于所述上一次访问的时刻及当前时刻得到间隔时长；基于得到所述应达次数；其中，Q为应达次数；所述A、B为常系数；所述T为预设时长；所述为间隔时长；所述n+1为加一后的所述访问次数。可选的，基于所述解析数据及BM模式匹配算法得到匹配项数，包括：将所述解析数据中的每一项数据分解为若干数据块；若干数据块的数目与所述数据的项的类别相关；将所述若干数据块与模式串进行匹配，基于完全匹配条件或停止条件得到所述项数据是否匹配。可选的，将所述源端口加入白名单规则表中之后，还包括：生成添加日志；将所述添加日志发送至管理员端；判断在预设时长内是否接收到所述管理员端发送的确认信息；如果否，将所述源端口剔出所述白名单规则表；如果是，则在下一次接收到所述源端口发送的数据包直接进行响应。可选的，所述方法还包括：若判定所述端口号的源端口存在于白名单中，则基于所述解析数据及BM模式匹配算法得到匹配项数；判断所述匹配项数是否大于预设项数；如果不大于所述预设项数，直接进行响应并生成工作日志。第二方面，本申请提供的一种工业防火墙策略规划方法采用如下的技术方案。一种工业防火墙策略规划系统，包括：第一处理模块，用于：获取到达防火墙的数据包；第二处理模块，用于：基于所述数据包解析得到解析数据；所述解析数据包括IP地址、端口号、传输协议及数据信息；第三处理模块，用于：判断所述端口号的源端口是否存在于白名单中；第四处理模块，用于在所述端口号的源端口不存在于白名单中时，基于所述解析数据及BM模式匹配算法得到匹配项数；所述匹配项数包括匹配项数依次增加的第一项数、第二项数、第三项数、第四项数及第五项数；所述第一项数的匹配项数为零；第五处理模块，用于：判断所述匹配项数是否大于预设项数；如果不大于所述预设项数，则接收所述数据包并对所述端口号的源端口在预设时长内的访问次数进行加一处理；以及，第六处理模块，用于：判断加一后的所述访问次数是否大于应达次数；如果是，则将所述源端口加入白名单规则表中。可选的，所述系统还包括用于获取应达次数的第七处理模块；所述第七处理模块包括：第一处理子模块，用于：获取所述端口号的源端口上一次访问的时刻；第二处理子模块，用于：基于所述上一次访问的时刻及当前时刻得到间隔时长；以及，第三处理子模块，用于：基于得到所述应达次数；其中，Q为应达次数；所述A、B为常系数；所述T为预设时长；所述为间隔时长；所述n+1为加一后的所述访问次数。可选的，所述第四处理模块包括：第四处理子模块，用于：将所述解析数据中的每一项数据分解为若干数据块；若干数据块的数目与所述数据的项的类别相关；以及，第五处理子模块，用于：将所述若干数据块与模式串进行匹配，基于完全匹配条件或停止条件得到所述项数据是否匹配。第三方面，本申请公开一种电子设备，包括存储器和服务器，所述存储器上存储有被服务器加载并执行上述的任一方法的计算机程序。附图说明图1是本申请一种工业防火墙策略规划方法其中一种实施方式的流程图；图2是本申请一种工业防火墙策略规划系统其中一种实施方式的系统框图；图3是第七处理模块其中一种实施方式的框图；图4是第四处理模块其中一种实施方式的框图；图中，201、第一处理模块；202、第二处理模块；203、第三处理模块；204、第四处理模块；2041、第四处理子模块；2042、第五处理子模块；205、第五处理模块；206、第六处理模块；207、第七处理模块；2071、第一处理子模块；2072、第二处理子模块；2073、第三处理子模块；208、第八处理模块。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图1-4及实施例，对本申请进行进一步详细说明。应当理解，此处所描述的具体实施例仅用以解释本申请，并不用于限定本申请。本申请实施例公开一种工业防火墙策略规划方法，应用于服务器。参照图1，作为一种工业防火墙策略规划方法的一种实施方式，一种工业防火墙策略规划方法包括以下步骤：步骤101、获取到达防火墙的数据包。具体地，在步骤101中，获取数据包是实时进行的；获取到达防火墙的数据包可以是通过现有的数据采集设备采集的，也可以是服务器通过其内设置的采集单元进行采集的。数据到达防火墙后需要经过防火墙进行安全管理与筛选，进而保护工业控制系统。步骤102、基于数据包解析得到解析数据。解析数据包括IP地址、端口号、传输协议及数据信息。具体地，虽然数据包的内容千差万别，但每个数据包都具有固定的部分，包括IP地址、端口号、传输协议类型及数据信息等。IP地址、端口号和传输协议类型保证了数据包的正确传输和接收。IP地址是网络通讯的地址，IP地址保证了数据包的有效传输，每个传输的数据包中都包含目的IP地址和源IP地址。每个传输的数据包中都包含目的端口和源端口。传输协议是网络通讯的基础，是控制网络有序、正确传输数据的规则。用户网络行为可以通过解析得到的数据信息进行分析。步骤103、判断端口号的源端口是否存在于白名单中。具体地，服务器获取到端口号后，将获取的端口号中的源端口信息与白名单中的信息进行比对，进而判断该源端口是否存在于白名单中。步骤104、如果不存在于报名单中，则基于解析数据及BM模式匹配算法得到匹配项数；匹配项数包括匹配项数依次增加的第一项数、第二项数、第三项数、第四项数及第五项数；第一项数的匹配项数为零。具体地，当源端口不存在于白名单中时，需要对该源端口发送的数据包进行过滤。服务器内配置有数据包过滤模块，将解析后的各项解析数据与数据包过滤模块内配置的规则进行匹配。上述的四个解析数据中在规则匹配中若有一个匹配成功，则存在一个匹配数；上述的第一项数可以是零，第二项数可以是一，第三项数可以是二；第四项数可以是三；第五项数可以是四。通常情况下，若干存在一项匹配，则说明该数据包的通讯非法，该数据包的传输需要进行拦截。步骤105、判断匹配项数是否大于预设项数；如果不大于预设项数，则接收数据包并对端口号的源端口在预设时长内的访问次数进行加一处理。具体地，预设项数可以设置为零，此时防火墙的防护等级最高；在其它实施方式中，可以根据防火墙的防护等级需要，调整上述的预设项数。步骤106、判断加一后的访问次数是否大于应达次数；如果是，则将源端口加入白名单规则表中。具体地，服务器将加一后的访问次数与应达次数进行比较，当加一后的访问次数大于应达次数，说明该源端口发送足够量的判定为安全的数据包，此时，服务器将该源端口加入白名单规则表中，便于该源端口后续发送的数据包通过防火墙，进而能够自主对报名单规则表进行更新，减少正常数据包被过滤的可能性。作为一种工业防火墙策略规划方法的一种实施方式，该方法还包括：当判定匹配项数大于预设项数，将数据包过滤。具体地，通常情况下，预设项数配置为零，根据需要预设项数可以设置为一或者大于一的其他数值，这样设置会导致工业防火墙的防护能力降低，但是能够避免正常数据包被过滤的可能性，在预设项数确定后，当对数据包处理得到的匹配项数大于预设项数，则说明该数据包的通讯非法，此时为了保护工业控制系统，服务器将该数据包进行过滤。作为一种工业防火墙策略规划方法的一种实施方式，应达次数的获取方法包括：获取端口号的源端口上一次访问的时刻；基于上一次访问的时刻及当前时刻得到间隔时长；基于得到应达次数；或者， 基于 得到应达次数；其中，Q为应达次数；A、B及C为常系数，C＞B且C＞A；T为预设时长；为间隔时长；n+1为加一后的访问次数；m为在预设时长内该源端口发送的数据包匹配项数大于预设项数的次数。具体地，为了能够更加灵敏地对数据包进行判断，应达次数是实时调整的。上述的“源端口上一次访问的时刻”即“源端口上一次发送的数据包的匹配项数小于预设项数的时刻”，服务器在判定某一源端口发送的数据包的匹配项数小于预设项数后，针对该源端口记录访问时刻。服务器获取该端口号的源端口上一次访问的时刻后基于上一次访问的时刻及当前时刻得到间隔时长，即当前时刻减去上一次访问的时刻得到间隔时长，此后服务器基于得到应达次数；在上述的技术公式中，若间隔时长越大，则该数据包上一次匹配项数小于预设项数与本次的匹配项数小于预设项数，两者的关联性越低，因此间隔时长越长，应达次数越大；加一后的访问次数越大，应达次数越小。在其它实施方式中，，对于发送的数据包属于非法通讯的源端口，需要发送更多的有效数据包。作为一种工业防火墙策略规划方法的一种实施方式，基于解析数据及BM模式匹配算法得到匹配项数，包括：将解析数据中的每一项数据分解为若干数据块；若干数据块的数目与数据的项的类别相关；将若干数据块与模式串进行匹配，基于完全匹配条件或停止条件得到项数据是否匹配。具体地，服务器将解析数据中的每一项数据按照一定的数据长度分解为若干数据块，数据不同项如IP地址、端口号和传输协议类型由于类型及名称不同，分解得到的数据块的数目不同。此后，服务器将数据块与模式串进行匹配，当数据块与模式串完全匹配或者当次不匹配时基于BM模式匹配算法进行匹配。作为一种工业防火墙策略规划方法的一种实施方式，将源端口加入白名单规则表中之后，还包括：生成添加日志；将添加日志发送至管理员端；判断在预设时长内是否接收到管理员端发送的确认信息；如果否，将源端口剔出白名单规则表；如果是，则在下一次接收到源端口发送的数据包直接进行响应。具体地，为了便于管理人员对添加入白名单规则表的端口号进行查看，具体地，将源端口加入白名单规则表中之后，服务器生成添加日志并将添加日志发送至管理员端；管理员管需要进行人工审核，此时处理器判断在预设时长内是否接收到管理员端发送的确认信息；如果在预设时长内未接收到管理员端发送的确认信息或者接收到剔除信息，服务器将源端口剔出白名单规则表，进而进一步提高了防火墙的安全性。作为一种工业防火墙策略规划方法的一种实施方式，该方法还包括：若判定端口号的源端口存在于白名单中，则基于解析数据及BM模式匹配算法得到匹配项数；判断匹配项数是否大于预设项数；如果不大于预设项数，直接进行响应并生成工作日志。参照图2，本申请还提供了一种工业防火墙策略规划系统，作为一种工业防火墙策略规划系统的其中一种实施方式，该系统包括：第一处理模块201，用于：获取到达防火墙的数据包；第二处理模块202，用于：基于数据包解析得到解析数据；解析数据包括IP地址、端口号、传输协议及数据信息；第三处理模块203，用于：判断端口号的源端口是否存在于白名单中；第四处理模块204，用于在端口号的源端口不存在于白名单中时，基于解析数据及BM模式匹配算法得到匹配项数；匹配项数包括匹配项数依次增加的第一项数、第二项数、第三项数、第四项数及第五项数；第一项数的匹配项数为零；第五处理模块205，用于：判断匹配项数是否大于预设项数；如果不大于预设项数，则接收数据包并对端口号的源端口在预设时长内的访问次数进行加一处理；以及，第六处理模块206，用于：判断加一后的访问次数是否大于应达次数；如果是，则将源端口加入白名单规则表中。参照图3，作为一种工业防火墙策略规划系统的其中一种实施方式，系统还包括用于获取应达次数的第七处理模块207；第七处理模块207包括：第一处理子模块2071，用于：获取端口号的源端口上一次访问的时刻；第二处理子模块2072，用于：基于上一次访问的时刻及当前时刻得到间隔时长；以及，第三处理子模块2073，用于：基于得到应达次数；或者，第三处理子模块2073用于：基于得到应达次数；其中，Q为应达次数；A、B及C为常系数，C＞B且C＞A；T为预设时长；T_1为间隔时长；n+1为加一后的访问次数；m为在预设时长内该源端口发送的数据包匹配项数大于预设项数的次数。参照图4，作为一种工业防火墙策略规划系统的其中一种实施方式，第四处理模块204包括：第四处理子模块2041，用于：将解析数据中的每一项数据分解为若干数据块；若干数据块的数目与数据的项的类别相关；以及，第五处理子模块2042，用于：将若干数据块与模式串进行匹配，基于完全匹配条件或停止条件得到项数据是否匹配。作为一种工业防火墙策略规划系统的其中一种实施方式，该系统还包括：第八处理模块208，第八处理模块208用于：生成添加日志；将添加日志发送至管理员端；判断在预设时长内是否接收到管理员端发送的确认信息；如果否，将源端口剔出白名单规则表；如果是，则在下一次接收到源端口发送的数据包直接进行响应。本申请实施例还公开一种电子设备。具体来说，该设备包括存储器和服务器，存储器上存储有能够被服务器加载并执行上述任意一种工业防火墙策略规划方法的计算机程序。本申请实施例还公开一种计算机可读存储介质。具体来说，该计算机可读存储介质，其存储有能够被服务器加载并执行如上述任意一种工业防火墙策略规划方法的计算机程序，该计算机可读存储介质例如包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上均为本申请的较佳实施例，并非依此限制本申请的保护范围，本说明书中公开的任一特征，除非特别叙述，均可被其他等效或者具有类似目的的替代特征加以替换。即，除非特别叙述，每个特征只是一系列等效或类似特征中的一个例子而已。
