标题title
基于虚拟阻抗的多端口变换器稳定控制方法
摘要abst
本发明涉及新能源并网技术领域，具体地说，涉及一种基于虚拟阻抗的多端口变换器稳定控制方法。具体地，其通过控制单元对储能变换器的控制实现对该多端口变换器的稳定控制，控制单元具有电压控制器、电流控制器、虚拟阻抗单元及PWM调制器；电压控制器用于对母线输出电压Ubus和母线参考电压Ubus‑ref的差值进行处理并获取基准电流ibus‑ref；电流控制器用于基于母线电流ibus及基准电流ibus‑ref生成第一参考信号；虚拟阻抗单元用于基于母线输出电压Ubus生成第二参考信号；PWM调制器用于基于第一参考信号和第二参考信号生成第一开关信号，并通过对第一开关信号进行非运算获取第二开关信号；第一开关信号用于控制第一功率开关管Ds1通断，第二开关信号用于控制第二功率开关管Ds2通断。
权利要求书clms
1.基于虚拟阻抗的多端口变换器稳定控制方法，该多端口变换器具有并联于母线处的储能变换器和母线电容Cbus，储能变换器用于将储能单元接入母线，母线电容采用薄膜电容；储能变换器具有电感Lbat、第一功率开关管Ds1和第二功率开关管Ds2，电感Lbat和第一功率开关管Ds1串联连接且串联后的两端形成用于接入储能单元的输入端，第一功率开关管Ds1和第二功率开关管Ds2串联连接且串联后的两端形成用于接入母线电容Cbus的输出端；其通过控制单元对储能变换器的控制实现对该多端口变换器的稳定控制，控制单元具有电压控制器、电流控制器、虚拟阻抗单元及PWM调制器；电压控制器用于对母线输出电压Ubus和母线参考电压Ubus-ref的差值进行处理并获取基准电流ibus-ref；电流控制器用于基于母线电流ibus及基准电流ibus-ref生成第一参考信号；虚拟阻抗单元用于基于母线输出电压Ubus生成第二参考信号；PWM调制器用于基于第一参考信号和第二参考信号生成第一开关信号，并通过对第一开关信号进行非运算获取第二开关信号；第一开关信号用于控制第一功率开关管Ds1通断，第二开关信号用于控制第二功率开关管Ds2通断。2.根据权利要求1所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：电压控制器的传递函数Gv，其计算如下，其中，kp1_bat表示为电压控制器比例系数，ki1_bat表示为电压控制器积分系数，s表示为拉普拉斯算子。3.根据权利要求1所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：电流控制器的传递函数Gi，其计算如下，其中，kp2_bat表示为电压控制器比例系数，ki2_bat表示为电压控制器积分系数，s表示为拉普拉斯算子。4.根据权利要求1所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：虚拟阻抗的传递函数Gzvir，其计算如下，其中，Gv表示为电压控制器的传递函数，Gi表示为电流控制器的传递函数，Zoo表示为输出电流对输出电压的传递函数，Gii表示为母线电流对电感电流的传递函数，Gid表示为占空比对电感电流的传递函数，Gud表示为占空比对输出电压的传递函数，Zvir表示为加入的虚拟阻抗。5.根据权利要求4所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：若GVGiGud＞＞GidGi＞＞1，虚拟阻抗的传递函数Gzvir可简化为，其中，Zoo表示为输出电流对输出电压的传递函数，Gud表示为占空比对输出电压的传递函数，Zvir表示为加入的虚拟阻抗。6.根据权利要求4所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：输出电流对输出电压的传递函数Zoo，其计算如下，其中，D′表示为第一开关信号或第二开关信号的占空比。7.根据权利要求4所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：母线电流对电感电流的传递函数Gii，其计算如下，8.根据权利要求4所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：占空比对电感电流的传递函数Gid，其计算如下，9.根据权利要求4所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：占空比对输出电压的传递函数Gud，其计算如下，10.根据权利要求4所述的基于虚拟阻抗的多端口变换器稳定控制方法，其特征在于：虚拟阻抗Zvir，其计算如下，其中，s表示为拉普拉斯算子，ωo表示为基波频率，ωc表示为有效带宽，Kr表示为增益。
说明书desc
技术领域本发明涉及新能源并网技术领域，具体地说，涉及一种基于虚拟阻抗的多端口变换器稳定控制方法。背景技术随着全球范围的石油等化石资源不断地消耗，能源危机和环境问题日益突出。为了应对这一问题，分布式发电技术和微电网技术得到越来越多的关注和重视。分布式发电区域能够充分的利用当地清洁资源，方便快捷的为居民提供用电，大大较少了电能在传输过程中的能量损耗，且不会对环境造成很大的污染。然而新能源的能量输出具有随机性与波动性，对电网的稳定运行造成了较大危害，因而采用并联储能装置的方式可以有效平抑新能源的能量波动，提高电网稳定性，但储能的成本较高，制约了其大规模推广使用。采用储能、新能源多种能源互联的方式，可以将新能源、储能、用户负荷等设备组成一个能源网络。多端口变换器是将新能源、储能和用户负荷连接起来的关键设备，多端口变换器克服了传统分立变换器体积大、转换效率低的缺点，具有小体积高功率密度、高转换效率的特点，故而在微电网中及智能电网中应用广泛。而多端口变换器中常需要较大的电解电容来支撑直流母线电压，但该电解电容的寿命较短，耐压较低，故而降低了多端口变换器的可靠性。发明内容为了解决上述技术问题，本发明通过下述技术方案得以解决。基于虚拟阻抗的多端口变换器稳定控制方法，该多端口变换器具有并联于母线处的储能变换器和母线电容Cbus，储能变换器用于将储能单元接入母线，母线电容采用薄膜电容；储能变换器具有电感Lbat、第一功率开关管Ds1和第二功率开关管Ds2，电感Lbat和第一功率开关管Ds1串联连接且串联后的两端形成用于接入储能单元的输入端，第一功率开关管Ds1和第二功率开关管Ds2串联连接且串联后的两端形成用于接入母线电容Cbus的输出端；其通过控制单元对储能变换器的控制实现对该多端口变换器的稳定控制，控制单元具有电压控制器、电流控制器、虚拟阻抗单元及PWM调制器；电压控制器用于对母线输出电压Ubus和母线参考电压Ubus-ref的差值进行处理并获取基准电流ibus-ref；电流控制器用于基于母线电流ibus及基准电流ibus-ref生成第一参考信号；虚拟阻抗单元用于基于母线输出电压Ubus生成第二参考信号；PWM调制器用于基于第一参考信号和第二参考信号生成第一开关信号，并通过对第一开关信号进行非运算获取第二开关信号；第一开关信号用于控制第一功率开关管Ds1通断，第二开关信号用于控制第二功率开关管Ds2通断。本发明中，原储能变换器在未加入虚拟阻抗单元之前，是通过电压控制器、电流控制器以及PWM调制器实现对原储能变换器输出电压的控制，但是电压控制器、电流控制器以及PWM调制器的共同作用下所形成的PWM调制信号该PWM调制信号的波形呈一个正弦波形，其占空比不满足于现储能变换器输出电压稳定的需求，因此对于现储能变换器输出电压是不稳定的，故现储能变换器加入了虚拟阻抗单元之后，在电压控制器、电流控制器、虚拟阻抗单元及PWM调制器共同作用下所形成新的PWM调制信号，该新的PWM调制信号具有较低的占空比，以满足于现储能变换器输出电压稳定的需求，故而较佳地控制第一功率开关管Ds1通断或控制第二功率开关管Ds2通断，进而较佳地实现现储能变换器输出电压的稳定。作为优选，电压控制器的传递函数Gv，其计算如下，其中，kp1_bat表示为电压控制器比例系数，ki1_bat表示为电压控制器积分系数，s表示为拉普拉斯算子。通过上述公式，故而较佳地获取电压控制器的传递函数Gv。作为优选，电流控制器的传递函数Gi，其计算如下，其中，kp2_bat表示为电压控制器比例系数，ki2_bat表示为电压控制器积分系数，s表示为拉普拉斯算子。通过上述公式，故而较佳地获取电流控制器的传递函数Gi。作为优选，虚拟阻抗的传递函数Gzvir，其计算如下，其中，Gv表示为电压控制器的传递函数，Gi表示为电流控制器的传递函数，Zoo表示为输出电流对输出电压的传递函数，Gii表示为母线电流对电感电流的传递函数，Gid表示为占空比对电感电流的传递函数，Gud表示为占空比对输出电压的传递函数，Zvir表示为加入的虚拟阻抗。通过上述公式，故而较佳地获取虚拟阻抗的传递函数Gzvir。作为优选，若GVGiGud＞＞GidGi＞＞1，虚拟阻抗的传递函数Gzvir可简化为，其中，Zoo表示为输出电流对输出电压的传递函数，Gud表示为占空比对输出电压的传递函数，Zvir表示为加入的虚拟阻抗。通过上述公式，由于Zoo和Gud是储能变换器本身的传递函数，不需要进行改变，因而虚拟阻抗中只需设计Zvir即可。作为优选，输出电流对输出电压的传递函数Zoo，其计算如下，其中，D′表示为第一开关信号或第二开关信号的占空比。通过上述公式，故而较佳地获取输出电流对输出电压的传递函数Zoo。作为优选，母线电流对电感电流的传递函数Gii，其计算如下，通过上述公式，故而较佳地获取母线电流对电感电流的传递函数Gii。作为优选，占空比对电感电流的传递函数Gid，其计算如下，通过上述公式，故而较佳地获取占空比对电感电流的传递函数Gid。作为优选，占空比对输出电压的传递函数Gud，其计算如下，通过上述公式，故而较佳地获取占空比对输出电压的传递函数Gud。作为优选，虚拟阻抗Zvir，其计算如下，其中，s表示为拉普拉斯算子，ωo表示为基波频率，ωc表示为有效带宽，Kr表示为增益。通过上述公式，故而较佳地获取虚拟阻抗Zvir。附图说明图1为实施例1中的多端口变换器的架构示意图。图2为实施例1中的多端口变换器的电路示意图。图3为实施例1中的光伏变换器的输出阻抗和负荷变换器的输入阻抗并联后的阻抗、储能变换器的输出阻抗伯德图的示意图。图4为实施例1中的储能变换器拓扑图的示意图。图5为实施例1中的储能变换器加入虚拟阻抗的控制框图示意图。图6为实施例1中的储能变换器加入虚拟阻抗后系统稳态波形的仿真示意图。图7为实施例1中的储能变换器加入虚拟阻抗后系统动态波形的仿真示意图。图8为实施例2中的储能变换器加入实际阻抗的示意图。图9为实施例2中的储能变换器加入实际阻抗的控制框图示意图。具体实施方式为进一步了解本发明的内容，结合附图和实施例对本发明作详细描述。应当理解的是，实施例仅仅是对本发明进行解释而并非限定。实施例1如图1-2所示，多端口变换器是将新能源、储能和用户负荷连接起来的设备，本实施例中的多端口变换器包括光伏变换器、储能变换器及负荷变换器；光伏变换器采用Boost变换电路，Boost变换电路输入端设置有光伏端口，光伏端口用于接入光伏单元，Boost变换电路输出端用于接入母线电容Cbus；光伏变换器用于对光伏单元最大功率跟踪并输出能量；储能变换器采用Buck-Boost变换电路，Buck-Boost变换电路输入端设置有储能端口，储能端口用于接入储能单元，Buck-Boost变换电路输出端用于接入母线电容Cbus；储能变换器用于吸收或释放能量；负荷变换器采用Buck变换电路，Buck变换电路输入端设置有负载端口，负载端口用于接入负荷单元，Buck变换电路输出端用于接入母线电容Cbus；负荷变换器用于维持电压稳定并消耗能量；其中，光伏变换器、储能变换器及负荷变换器之间的解耦通过母线电容实现；由于传统的多端口变换器中常需要较大的电解电容来支撑直流母线电压，但该电解电容的寿命较短，耐压较低，因而本实施例提供的多端口变换器采用0.6mF的薄膜电容，薄膜电容具有寿命长，等效串联电阻小，以及具有良好的滤波作用，故而较佳地提高了多端口变换器的可靠性。使用薄膜电容作为母线电容，使得光伏变换器、储能变换器及负荷变换器之间的耦合性加强，且母线纹波会增大，因而采用传统的控制方法应用在本实施例提供的多端口变换器时会导致系统不稳定。如图3-7所示，为了进一步提高本实施例提供的多端口变换器时的系统的稳定，通过如下步骤进行分析，步骤S1、对光伏变换器的输出阻抗和负荷变换器的输入阻抗并联后的频率、储能变换器输出阻抗的频率进行分析，确定多端口变换器阻抗改善的类型；步骤S2、根据储能变换器输出阻抗值在低频段、中频段、高频段的大小，确定储能变换器输出阻抗改善的频段部分；步骤S3、改变储能变换器输出阻抗控制框图，将并联电阻的输出点转移到控制环上，实现虚拟阻抗；步骤S4、设计满足对交流信号起作用而对直流信号无衰减的虚拟阻抗特性；步骤S5、对虚拟阻抗的参数设计需考虑与系统其它函数的共同作用关系，如参数不满足要求再进行调整。步骤S1中，确定多端口变换器阻抗改善的类型是依据如下公式进行稳定性判据；其中，TM表示为多端口变换器的系统阻抗比，Zbat表示为储能变换器的闭环输出阻抗，Zpv表示为光伏变换器的闭环输出阻抗，Zload表示为负载的闭环输出阻抗。通过对公式进行分析可以获知，提高系统稳定性即减小TM的值，所以可提高光伏变换器或负荷变换器母线侧的阻抗，也可降低储能变换器的母线侧阻抗。然而，通过对图3中伯德图进行分析可以获知，光伏变换器的输出阻抗和负荷变换器的输入阻抗并联后的峰值最小时对应的频率远大于储能变换器峰值最大时对应的频率，因此，如果提高光伏变换器和负荷变换器的并联阻抗值，要将光伏变换器和负荷变换器两者频率最小值和最大值之间附近对应的阻抗值提高。但是根据稳定性判据，若提高的阻抗为两个变换器阻抗并联后的值，当只提高一个变换器的阻抗时，并联后的阻抗提升值并不明显，且实现起来比较复杂。而储能变换器的输出阻抗在中频段有最大值，在低频段和高频段的输出阻抗很小，因此就可以只对储能变换器输出阻抗中间段较高部分进行改善，从而达到提高系统稳定性的目的，这样只需对一个变换器进行阻抗改善，实施起来也较为简单。鉴于上述，如图4、图5所示，本实施例提供了基于虚拟阻抗的多端口变换器稳定控制方法，储能变换器具有电感Lbat、第一功率开关管Ds1和第二功率开关管Ds2，电感Lbat和第一功率开关管Ds1串联连接且串联后的两端形成用于接入储能单元的输入端，第一功率开关管Ds1和第二功率开关管Ds2串联连接且串联后的两端形成用于接入母线电容Cbus的输出端；其通过控制单元对储能变换器的控制实现对该多端口变换器的稳定控制，控制单元具有电压控制器、电流控制器、虚拟阻抗单元及PWM调制器；电压控制器用于对母线输出电压Ubus和母线参考电压Ubus-ref的差值进行处理并获取基准电流ibus-ref；电流控制器用于基于母线电流ibus及基准电流ibus-ref生成第一参考信号；虚拟阻抗单元用于基于母线输出电压Ubus生成第二参考信号；PWM调制器用于基于第一参考信号和第二参考信号生成第一开关信号，并通过对第一开关信号进行非运算获取第二开关信号；第一开关信号用于控制第一功率开关管Ds1通断，第二开关信号用于控制第二功率开关管Ds2通断。如图4的储能变换器控制框图可以获知，加入的虚拟阻抗单元，相当于在原储能变换器的控制框图中增加了一条反馈环节，因而现储能变换器的闭环输出阻抗Zbat，其公式如下，其中，Gv表示为电压控制器的传递函数，Gi表示为电流控制器的传递函数，Zoo表示为输出电流对输出电压的传递函数，Gii表示为母线电流对电感电流的传递函数，Gid表示为占空比对电感电流的传递函数，Gud表示为占空比对输出电压的传递函数，Gzvir表示为虚拟阻抗的传递函数。从上述公式可以获知，现储能变换器的闭环输出阻抗与原储能变换器的闭环输出阻抗的值相比，现储能变换器的闭环输出阻抗较低，故而降低了多端口变换器的系统阻抗比TM，进而提高系统的稳定性。进一步的说明，原储能变换器在未加入虚拟阻抗单元之前，是通过电压控制器、电流控制器以及PWM调制器实现对原储能变换器输出电压的控制，但是电压控制器、电流控制器以及PWM调制器的共同作用下所形成的PWM调制信号该PWM调制信号的波形呈一个正弦波形，其占空比不满足于现储能变换器输出电压稳定的需求，因此对于现储能变换器输出电压是不稳定的，故现储能变换器加入了虚拟阻抗单元之后，在电压控制器、电流控制器、虚拟阻抗单元及PWM调制器共同作用下所形成新的PWM调制信号，该新的PWM调制信号具有较低的占空比，以满足于现储能变换器输出电压稳定的需求，故而较佳地控制第一功率开关管Ds1通断或控制第二功率开关管Ds2通断，进而较佳地实现现储能变换器输出电压的稳定。如图6、图7所示，从仿真结果可以获知，图6中，1-2s为系统未加入虚拟阻抗时的输出波形，在2s时加入虚拟阻抗。可看到在未加入虚拟阻抗时，系统呈振荡状态，母线电压振荡幅值为50V，负载电压振荡幅值为20V，电池电流振荡幅值为70A，在加入虚拟阻抗后，母线电压在0.2s内恢复到稳定值，其他变换器的输出值也随之恢复到稳定值。可见虚拟阻抗能够在母线电容为0.6mF下保持系统稳定运行，有效地抑制了振荡，提高了系统抗干扰能力，提高了系统稳定性。图7中，系统开始为满载3000W运行，在1.5s减载2000W，可见母线电压及系统电压都出现了一定程度的波动，储能由放电状态转为充电状态，母线电压上升约27V，负载电压上升约40V，二者都在0.1s内恢复稳定，但负载电压的调节时间比母线电压的调节时间稍长，电池电流由放电20A变为充电20A。2.5s时系统加载2000W，此时负载变换器达到满载状态，可见母线电压及系统电压都出现了一定程度的下跌，储能由充电状态转为放电状态，母线电压下降约21V，负载电压下降约32V，但其调节时间很短，均小于0.1s，调节过程中，超调量很小，系统加减载几乎对光伏的输出功率没有影响。可看出，在电容较小的不稳定系统中加入虚拟阻抗后，系统从不稳定状态变为稳定状态，系统的动态特性还能保持较好，加减载过程中的波动在允许范围内，变换器能快速地完成调节使电压恢复稳定，虚拟阻抗策略可降低系统母线电容的使用。下表为储能变换器系统仿真参数，本实施例中，电压控制器的传递函数Gv，其计算如下，其中，kp1_bat表示为电压控制器比例系数，ki1_bat表示为电压控制器积分系数，s表示为拉普拉斯算子。通过上述公式，故而较佳地获取电压控制器的传递函数Gv。本实施例中，电流控制器的传递函数Gi，其计算如下，其中，kp2_bat表示为电压控制器比例系数，ki2_bat表示为电压控制器积分系数，s表示为拉普拉斯算子。通过上述公式，故而较佳地获取电流控制器的传递函数Gi。本实施例中，虚拟阻抗的传递函数Gzvir，其计算如下，其中，Gv表示为电压控制器的传递函数，Gi表示为电流控制器的传递函数，Zoo表示为输出电流对输出电压的传递函数，Gii表示为母线电流对电感电流的传递函数，Gid表示为占空比对电感电流的传递函数，Gud表示为占空比对输出电压的传递函数，Zvir表示为加入的虚拟阻抗。通过上述公式，故而较佳地获取虚拟阻抗的传递函数Gzvir。本实施例中，若GVGiGud＞＞GidGi＞＞1，虚拟阻抗的传递函数Gzvir可简化为，其中，Zoo表示为输出电流对输出电压的传递函数，Gud表示为占空比对输出电压的传递函数，Zvir表示为加入的虚拟阻抗。通过上述公式，由于Zoo和Gud是储能变换器本身的传递函数，不需要进行改变，因而虚拟阻抗中只需设计Zvir即可。本实施例中，输出电流对输出电压的传递函数Zoo，其计算如下，其中，D′表示为第一开关信号或第二开关信号的占空比。通过上述公式，故而较佳地获取输出电流对输出电压的传递函数Zoo。本实施例中，母线电流对电感电流的传递函数Gii，其计算如下，通过上述公式，故而较佳地获取母线电流对电感电流的传递函数Gii。本实施例中，占空比对电感电流的传递函数Gid，其计算如下，通过上述公式，故而较佳地获取占空比对电感电流的传递函数Gid。本实施例中，占空比对输出电压的传递函数Gud，其计算如下，通过上述公式，故而较佳地获取占空比对输出电压的传递函数Gud。本实施例中，虚拟阻抗Zvir，其计算如下，其中，s表示为拉普拉斯算子，ωo表示为基波频率，ωc表示为有效带宽，Kr表示为增益。通过上述公式，故而较佳地获取虚拟阻抗Zvir。实施例2如图7-8所示，由实施例1可以获知，要对储能变换器的阻抗进行改善，故而本实施例将一个实际阻抗Zvir并联在储能变换器的输出侧，以减小储能变换器的输出阻抗，也即降低了多端口变换器的系统阻抗比TM，进而提高系统的稳定性。加入实际阻抗Zvir后，储能变换器的闭环输出阻抗Zbat，其计算如下，其中，Zbat表示为储能变换器的闭环输出阻抗，ubus表示为储能变换器电容电压，ibus表示为储能变换器输出电流，ZOO表示为输出电流对输出电压的传递函数，Gi表示为电流控制器的传递函数，Gid表示为占空比对电感电流的传递函数，Gud表示为占空比对输出电压的传递函数，Zvir表示为加入的实际阻抗，Gii表示为母线电流对电感电流的传递函数，Gv表示为电压控制器的传递函数。与实施例1相比，本实施例虽能够提高系统的稳定，但是母线上并联一个实际阻抗Zvir，相当于增加了一个负载，增加了母线电流，故而增加了系统损耗，进一步使得整个系统的效率降低。而实施例1与本实施例相比，不仅提高系统的稳定且不增加额外损耗，较佳地可靠。总之，以上所述仅为本发明的较佳实施例，凡依本发明申请专利范围所作的均等变化与修饰，皆应属本发明专利的涵盖范围。
