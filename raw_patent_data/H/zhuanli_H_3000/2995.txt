标题title
车灯自适应调光方法、装置、智能终端及存储介质
摘要abst
本发明公开了一种车灯自适应调光方法、装置、智能终端及存储介质，本发明方案通过将两个摄像头分别安装在两侧的车前灯附近，采用神经网络模型分别对每个摄像头拍摄的视频进行目标检测，根据左右摄像头分别检测到的目标图像和目标类别计算出目标与当前车辆的距离，从而根据目标与当前车辆的距离实现对车前灯的灯光控制。由于摄像头的位置和车灯的位置相同，消除了摄像头拍摄的区域和车灯照射的区域的偏差，并且根据两个摄像头检测的目标图像来计算距离，使得距离的计算结果更加准确，生成的车灯信号更准确。
权利要求书clms
1.车灯自适应调光方法，其特征在于，包括：获取摄像头采集的视频数据，所述摄像头包括用于安装在左侧车前灯附近的左侧摄像头和用于安装在右侧车前灯附近的右侧摄像头；将所述视频数据分别输入神经网络模型进行目标检测，获得目标类别和目标图像；基于所述目标类别和所述目标图像，获得当前车辆与所述目标之间的距离；根据所述目标类别和所述距离，生成用于控制车前灯的灯光信号。2.如权利要求1所述的车灯自适应调光方法，其特征在于，所述基于所述目标类别和所述目标图像，获得当前车辆与所述目标之间的距离，包括：基于所述目标图像的高度、摄像头的高度，根据三角测距法获得第一距离；比较根据左侧的目标图像获得的第一距离和根据右侧的目标图像获得的第一距离，获得距离差；若所述距离差小于或等于设定阈值，计算所有第一距离的平均值，将该平均值设为所述距离；若所述距离差大于设定阈值：基于所述目标类别，获得所述目标的真实尺寸；基于所述目标图像的宽度、所述真实尺寸的宽度，根据三角测距法获得第二距离；计算所有第二距离的平均值，将该平均值设为所述距离。3.如权利要求2所述的车灯自适应调光方法，其特征在于，还设有与所述摄像头一一对应的处理终端，所述处理终端上部署有神经网络模型以分别对左侧摄像头采集的视频数据、右侧摄像头采集的视频数据进行处理，并在获得所述第一距离后，还在两个处理终端之间互传校准信息。4.如权利要求1所述的车灯自适应调光方法，其特征在于，所述左侧摄像头和所述右侧摄像头分别被配置为拍摄近处或拍摄远处，所述根据所述目标类别和所述距离，生成用于控制车前灯的灯光信号，包括：当所述距离小于预先标定的分界阈值，根据所述目标类别、所述距离生成与拍摄近处的摄像头对应的车前灯的灯光信号；当所述距离大于或等于预先标定的分界阈值，根据所述目标类别、所述距离生成与拍摄远处的摄像头对应的车前灯的灯光信号。5.如权利要求4所述的车灯自适应调光方法，其特征在于，所述左侧摄像头被配置为拍摄近处，所述右侧摄像头被配置为拍摄远处，预先确定所述分界阈值，包括：将测试目标放置在前方，位于两个摄像头连线的中垂线上；获取所述左侧摄像头拍摄的第一图像和所述右侧摄像头拍摄的第二图像；分别获取第一图像、第二图像的置信度；若第一图像的置信度大于第二图像的置信度，则沿着所述中垂线向远离摄像头的方向移动测试目标，否则，沿着所述中垂线向靠近摄像头的方向移动目标物体；当第一图像的置信度与第二图像的置信度之间差值的绝对值超过设定的阈值范围时，返回获取所述左侧摄像头拍摄的第一图像和所述右侧摄像头拍摄的第二图像，进行下一次迭代；计算测试目标与两个摄像头连线的垂直距离，获得所述分界阈值。6.车灯自适应调光装置，其特征在于，包括：摄像头和与摄像头耦合的主控芯片，用于安装在车前灯内；所述主控芯片与所述摄像头、所述车前灯的灯控板电连接，所述主控芯片被配置为运行如权利要求1至5任一项所述的车灯自适应调光方法并将生成的灯光信号传输至对应车灯的灯控板。7.如权利要求6所述的车灯自适应调光装置，其特征在于，所述摄像头包括安装于左侧车前灯内的左侧摄像头和安装于右侧车前灯内的右侧摄像头，所述左侧摄像头和所述右侧摄像头被配置为采集不同区域的视频，所述主控芯片与所述摄像头一一对应，左侧的所述主控芯片与右侧的所述主控芯片之间设有用于传输校准信号的传输通道；所述主控芯片还与车身控制器电连接，用于接收车身控制器的信号并将该信号传输至车灯的灯控板。8.如权利要求6所述的车灯自适应调光装置，其特征在于，所述摄像头包括安装于左侧车前灯内的左侧摄像头和安装于右侧车前灯内的右侧摄像头，所述左侧摄像头和所述右侧摄像头为两种配置的摄像头。9.智能终端，其特征在于，所述智能终端包括存储器、处理器以及存储在所述存储器上并可在所述处理器上运行的车灯自适应调光程序，所述车灯自适应调光程序被所述处理器执行时实现如权利要求1-5任意一项所述车灯自适应调光方法的步骤。10.计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有车灯自适应调光程序，所述车灯自适应调光程序被处理器执行时实现如权利要求1-5任意一项所述车灯自适应调光方法的步骤。
说明书desc
技术领域本发明涉及汽车车灯技术领域，尤其涉及的是一种车灯自适应调光方法、装置、智能终端及存储介质。背景技术在汽车行驶过程中，由于夜间行车光线不足，因此需要使用车灯进行照明，以提升行车时的安全。目前将摄像头装在车辆前方气格栅中间，通过将拍摄的视频传输到车辆的主控制器上以做图像的检测和识别，获得分析结果后，再将灯光信号传送给车灯。由于摄像头和车灯位置不同，导致摄像头拍摄的区域和车灯照射的区域有偏差，不能准确判断车距，获得的车灯信号不准确。因此，现有技术有待改进和提高。发明内容本发明的主要目的在于提供一种车灯自适应调光方法、装置、智能终端及存储介质，旨在解决现有技术中车距判断不准确、车灯信号不准确的问题。为了实现上述目的，本发明提供了一种车灯自适应调光方法，其中，上述方法包括：获取摄像头采集的视频数据，所述摄像头包括用于安装在左侧车前灯附近的左侧摄像头和用于安装在右侧车前灯附近的右侧摄像头；将所述视频数据分别输入神经网络模型进行目标检测，获得目标类别和目标图像；基于所述目标类别和所述目标图像，获得当前车辆与所述目标之间的距离；根据所述目标类别和所述距离，生成用于控制车前灯的灯光信号。可选的，所述基于所述目标类别和所述目标图像，获得当前车辆与所述目标之间的距离，包括：基于所述目标图像的高度、摄像头的高度，根据三角测距法获得第一距离；比较根据左侧的目标图像获得的第一距离和根据右侧的目标图像获得的第一距离，获得距离差；若所述距离差小于或等于设定阈值，计算所有第一距离的平均值，将该平均值设为所述距离；若所述距离差大于设定阈值：基于所述目标类别，获得所述目标的真实尺寸；基于所述目标图像的宽度、所述真实尺寸的宽度，根据三角测距法获得第二距离；计算所有第二距离的平均值，将该平均值设为所述距离。可选的，还设有与所述摄像头一一对应的处理终端，所述处理终端上部署有神经网络模型以分别对左侧摄像头采集的视频数据、右侧摄像头采集的视频数据进行处理，并在获得所述第一距离后，还在两个处理终端之间互传校准信息。可选的，所述左侧摄像头和所述右侧摄像头分别被配置为拍摄近处或拍摄远处，所述根据所述目标类别和所述距离，生成用于控制车前灯的灯光信号，包括：当所述距离小于预先标定的分界阈值，根据所述目标类别、所述距离生成与拍摄近处的摄像头对应的车前灯的灯光信号；当所述距离大于或等于预先标定的分界阈值，根据所述目标类别、所述距离生成与拍摄远处的摄像头对应的车前灯的灯光信号。可选的，所述左侧摄像头被配置为拍摄近处，所述右侧摄像头被配置为拍摄远处，预先确定所述分界阈值，包括：将测试目标放置在前方，位于两个摄像头连线的中垂线上；获取所述左侧摄像头拍摄的第一图像和所述右侧摄像头拍摄的第二图像；分别获取第一图像、第二图像的置信度；若第一图像的置信度大于第二图像的置信度，则沿着所述中垂线向远离摄像头的方向移动测试目标，否则，沿着所述中垂线向靠近摄像头的方向移动目标物体；当第一图像的置信度与第二图像的置信度之间差值的绝对值超过设定的阈值范围时，返回获取所述左侧摄像头拍摄的第一图像和所述右侧摄像头拍摄的第二图像，进行下一次迭代；计算测试目标与两个摄像头连线的垂直距离，获得所述分界阈值。为了实现上述目的，本发明第二方面还提供了一种车灯自适应调光装置，包括：摄像头和与摄像头耦合的主控芯片，用于安装在车前灯内；所述主控芯片与所述摄像头、所述车前灯的灯控板电连接，所述主控芯片被配置为运行上述任一项所述的车灯自适应调光方法并将生成的灯光信号传输至对应车灯的灯控板。可选的，所述摄像头包括安装于左侧车前灯内的左侧摄像头和安装于右侧车前灯内的右侧摄像头，所述左侧摄像头和所述右侧摄像头被配置为采集不同区域的视频，所述主控芯片与所述摄像头一一对应，左侧的所述主控芯片与右侧的所述主控芯片之间设有用于传输校准信号的传输通道；所述主控芯片还与车身控制器电连接，用于接收车身控制器的信号并将该信号传输至车灯的灯控板。可选的，所述摄像头包括安装于左侧车前灯内的左侧摄像头和安装于右侧车前灯内的右侧摄像头，所述左侧摄像头和所述右侧摄像头为两种配置的摄像头。本发明第三方面提供一种智能终端，上述智能终端包括存储器、处理器以及存储在上述存储器上并可在上述处理器上运行的车灯自适应调光程序，上述车灯自适应调光程序被上述处理器执行时实现任意一项上述车灯自适应调光方法的步骤。本发明第四方面提供一种计算机可读存储介质，上述计算机可读存储介质上存储有车灯自适应调光程序，上述车灯自适应调光程序被处理器执行时实现任意一项上述车灯自适应调光方法的步骤。由上述可见，本发明方案通过将两个摄像头分别安装在两侧的车前灯附近，采用神经网络模型分别对每个摄像头拍摄的视频进行目标检测，根据左右摄像头分别检测到的目标图像和目标类别计算出目标与当前车辆的距离，从而根据目标与当前车辆的距离实现对车前灯的灯光控制。由于摄像头的位置和车灯的位置相同，消除了摄像头拍摄的区域和车灯照射的区域的偏差，并且根据两个摄像头检测的目标图像来计算距离，使得距离的计算结果更加准确，生成的车灯信号更准确。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其它的附图。图1是本发明的车灯自适应调光方法实施例的具体流程图；图2是本发明图1实施例中的根据图像高度计算距离示意图；图3是摄像头重叠区域示意图；图4是预先标定分解阈值实施例的流程图；图5是图4实施例的标定装置示意图；图6是本发明图1实施例中步骤S300具体流程图；图7是根据图像宽度计算距离示意图；图8是车灯自适应装置安装在车前灯内示意图；图9是本发明实施例提供的一种智能终端的内部结构原理框图。附图标号说明：10、车灯，11、摄像头安装支架，12、摄像头。具体实施方式以下描述中，为了说明而不是为了限定，提出了诸如特定系统结构、技术之类的具体细节，以便透彻理解本发明实施例。然而，本领域的技术人员应当清楚，在没有这些具体细节的其它实施例中也可以实现本发明。在其它情况下，省略对众所周知的系统、装置、电路以及方法的详细说明，以免不必要的细节妨碍本发明的描述。应当理解，当在本说明书和所附权利要求书中使用时，术语“包括”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。还应当理解，在本发明说明书中所使用的术语仅仅是出于描述特定实施例的目的而并不意在限制本发明。如在本发明说明书和所附权利要求书中所使用的那样，除非上下文清楚地指明其它情况，否则单数形式的“一”、“一个”及“该”意在包括复数形式。还应当进一步理解，在本发明说明书和所附权利要求书中使用的术语“和/或”是指相关联列出的项中的一个或多个的任何组合以及所有可能组合，并且包括这些组合。如在本说明书和所附权利要求书中所使用的那样，术语“如果”可以依据上下文被解释为“当…时”或“一旦”或“响应于确定”或“响应于检测到”。类似的，短语“如果确定”或“如果检测到”可以依据上下文被解释为意指“一旦确定”或“响应于确定”或“一旦检测到”或“响应于检测到”。下面结合本发明实施例的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。在下面的描述中阐述了很多具体细节以便于充分理解本发明，但是本发明还可以采用其它不同于在此描述的其它方式来实施，本领域技术人员可以在不违背本发明内涵的情况下做类似推广，因此本发明不受下面公开的具体实施例的限制。目前在行驶过程中，由于车辆违规开启远光灯导致对面车辆视线受阻，出现交通事故的事情常有发生。而驾驶人员很容易忘记切换远近光灯造成对面车辆视线受阻的情况。因此，通过智能化控制车灯，保证安全、舒适的驾驶尤为重要。现有的车灯自适应调光方法，将摄像头装在车辆前方气格栅中间，通过将拍摄的视频传输到车辆的主控制器上以做图像的检测和识别，获得分析结果后，再将灯光信号传送给车灯。由于摄像头和车灯位置不同，导致摄像头拍摄的区域和车灯照射的区域有偏差，不能准确获得对方车辆的车距和位置，分析结果有偏差，对车灯的控制效果并不好。本发明通过将两个摄像头分别安装在两侧的车前灯附近，采用神经网络模型分别对每个摄像头拍摄的视频进行目标检测，根据左右摄像头分别检测到的目标图像和目标类别计算出车距，从而根据车距实现对车前灯的灯光控制。由于摄像头的位置和车灯的位置相同，消除了摄像头拍摄的区域和车灯照射的区域的偏差，并且根据两个摄像头检测的目标图像来计算距离，使得距离的计算结果更加准确。示例性方法本发明的车灯自适应调光方法优选部署在单独的控制板上，控制板与摄像头电连接，能够直接获取摄像头的数据并进行处理，以减少部署数据通信线路的成本。具体的，如图1所示，本实施例中的车灯自适应调光方法包括如下步骤：步骤S100：获取摄像头采集的视频数据，所述摄像头包括用于安装在左侧车前灯附近的左侧摄像头和用于安装在右侧车前灯附近的右侧摄像头；具体地，摄像头可以安装于车前灯周边或者车前灯内。本实施例设有两个控制板和两个摄像头，控制板与摄像头一一对应分别安装在左侧车前灯内和右侧车前灯内，车灯自适应调光程序烧录在控制板上的主控芯片内。控制板连接至摄像头的数据接口上，每隔设定的时间间隔获取摄像头采集到的视频数据。两个控制板分别获取左侧摄像头和右侧摄像头采集的视频数据，并保存在各自的存储器内。将摄像头安装在车灯内，摄像头拍摄区域与车灯的照射区域相同，使得分析拍摄视频数据后生成的灯光信号，不会由于拍摄区域坐标与照射区域坐标存在偏差而导致灯光信号不准确，并且相比于将摄像头装在车辆前进气格栅中间，摄像头没有暴露在外，不会被泥水弄脏而导致成像效果不佳。步骤S200：将视频数据分别输入神经网络模型进行目标检测，获得目标类别和目标图像；具体地，获得摄像头采集的视频数据后，获取视频数据中的图像帧，形成图像数据集，然后使用现有的各种图像识别网络模型对图像数据集进行识别和检测，获得识别结果。本实施例的应用场景为检测车灯前方的目标车辆或目标行人，从而操控车灯避开车辆区域的照射或闪烁行人区域以友好提示等，相应地，检测获得的目标类别为：行人和车辆，并进一步检测出目标车辆的车辆类型，如小汽车、重型卡车、两厢货车等等。神经网络模型的输出结果还包括根据图像数据集进行图像分割获得的目标图像，如行人图像和/或汽车图像。由于实时处理摄像头采集的视频数据，数据传输量大，优选如本实施例设置两个控制板来分别处理视频数据，可以实现对视频数据的同步处理，提高实时处理速度。需要说明的是，也可以采用一个控制板，并将控制板安装在前方车头内，通过通信线缆分别与左侧摄像头、右侧摄像头的数据接口连接。控制板上安装有性能较好的多任务处理芯片，以同时对左侧、右侧摄像头的视频数据进行检测识别。其中，神经网络模型不做限定，本实施例中为常用的卷积神经网络模型，也可以采用Transformer等其他类型的网络模型。步骤S300：基于目标类别和目标图像，获得当前车辆与目标之间的距离；具体地，根据已标定的安装在车灯内的摄像头的高度，目标图像的高度，摄像头的焦距，通过相似三角法可以计算出摄像头所在车辆与目标之间的距离。例如：目标类别为车辆时，参考图2所示，h为摄像头的高度，已知h’为前车BC在摄像头成像中的长度，f’为摄像头焦距，通过相似三角形计算出前车距离当目标类别为行人时，根据上述方法同样可以获取到当前车辆与行人之间的距离。本实施例中，分别在两个主控芯片上进行视频数据的检测处理，并根据各个摄像头采集的视频数据检测到的目标图像分别计算出摄像头所在车辆与目标车辆之间的距离，考虑到单个摄像头计算出的距离存在偏差，因此两个主控芯片之间设有信号传输通道，在计算出距离后，还在两个处理终端之间互传校准信息以对计算出来的距离进行校准。上述校准信息包括：计算出的距离。当目标类别为车辆时，还包括目标车辆的车辆类型。相比于通常将左右摄像头的大量图像数据互传来实现距离校准的方法，本发明只需要传输少量的校准信息，提高处理效率。具体的，利用另一侧计算出来的距离来校准距离的方法不做限制，可以如本实施例采用的简单采用取两者的平均值作为最终的距离。步骤S400：根据目标类别和距离，生成用于控制车前灯的灯光信号。具体地，当检测到的目标类别为行人时，生成车灯闪烁信号以提醒行人快速通过，当检测到的目标类别为车辆时，即会车时，根据车距，自动生成远光灯信号或近光灯信号，以实现远光灯与近光灯的自动切换。进一步地，还可以根据分割出的目标图像得出目标图像在整个图像中的位置，从而计算出目标在哪个车灯照射区域内，也即是目标位置相对于车灯照射的角度，从而可以根据该角度生成对应的车灯区域的控制信号，如切换该区域的远近灯光、亮度、或者关闭该照射区域的灯光等等。例如：现有的智能车灯包括多个区域照明灯组，本实施例中的远光照明灯组包括各7组左侧照射区域、右侧照射区域，一共14组。以左侧为例，第一左灯组为普通远光灯，照射范围角度为+/-7°，第二左灯组的照射范围角度为+2.0°～-2.5°；第三左灯组的照射范围角度为-2.5°～-6.5°，第四左灯组的照射范围角度为-5.5°～-9.5°，第五左灯组的照射范围角度为-9.5°～-13.5°，第六左灯组的照射范围角度为-12.5°～-16.5°，第七左灯组的照射范围角度为-16.5°～-20.0°。因此，可以根据计算出来的目标在哪个车灯照射区域的结果，选择对该照射区域的灯光进行控制，如会车时，生成对方车辆所属照射区域的近光信号，其余区域仍维持远光信号不变。在一个实施例中，当左侧摄像头检测到的目标对象和右侧摄像头检测到的目标对象不相同时，还可以根据目标与当前车辆的距离分别对左侧车灯、右侧车灯做不同的控制，以实现更加准确的灯光控制效果。进一步地，还可以从车身控制器获取当前车辆所属照明模式，如：城市道路照明模式、高速公路照明模式、市郊道路照明模式、弯道辅助照明模式、节能模式等，并根据照明模式的规律生成不同的灯光信号。例如：高速公路照明模式为：角灯关闭，远光灯模块的照射区域全部点亮；弯道辅助照明模式为：近光灯和角灯均100％点亮等。由上所述，通过将摄像头安装车前灯内以消除摄像头拍摄的区域和车灯照射的区域的偏差，并使用左侧摄像头和右侧摄像头分别检测左侧车灯照射区域、右侧车灯照射区域的目标物体，根据目标物体与车辆之间的距离，实现对车灯的准确控制。相比于现有的一个摄像头的车灯控制方案，车灯控制的准确率更高，效果更好。如图3所示，当左右两侧摄像头的视角一样时，存在少量的重叠区域B，对每个摄像头采集的视频分别进行处理时，车灯控制策略存在冲突的可能。例如：在重叠区域B假如有一辆车，左侧车灯检测到了，但是右侧车灯未检测到，此时，左侧车灯会将对应区域灯灭掉，而右侧还是维持远光，这样对于B区域的车灯控制效果就不理想了。因此，在一个实施例中，将左侧摄像头配置为拍摄近处，视角比较广，右侧摄像头配置为拍摄远处，视频比较窄但远处目标看得比较清楚。并预先根据左侧摄像头、右侧摄像头的焦距、FOV等参数标定出分界阈值。基于该分界阈值划出一条水线，使用右侧摄像头采集水线以外的区域的视频数据；使用左侧摄像头采集水线以内的区域的视频数据。使得左侧摄像头和右侧摄像头采集的区域不会互相干扰，然后分别获得左侧检测到的目标图像和右侧检测到的目标图像，将所有目标图像合并，根据各个目标的垂直距离和类别，生成用于控制左侧车前灯的灯光信号和用于控制右侧车前灯的灯光信号。其中，如图4所示，预先标定分界阈值的方法，具体包括如下步骤：步骤A100：将测试目标放置在前方，位于两个摄像头连线的中垂线上；步骤A200：获取左侧摄像头拍摄的第一图像和右侧摄像头拍摄的第二图像；具体地，如图5所示，测试目标可以是车辆、行人或交通标识等，将测试目标放在沿中垂线延伸的导轨上，分别使用左侧摄像头、右侧摄像头进行拍照，采用神经网络模型进行目标检测，获得第一图像和第二图像。步骤A300：分别获得第一图像、第二图像的置信度；具体地，在神经网络模型中输出一张表征置信度的灰度图，称之为置信度图；置信度为待检测的原图上各像素属于某个类别的概率，其值的范围为0到1；将置信度值乘以255做归一化处理后，以灰度图像保存。在该灰度图上找出目标对应的连通区域，在置信度图上计算该连通区域对应位置的所有像素值的平均值作为目标的置信度。就可以分别获得测试目标在第一图像、第二图像中的置信度。步骤A400：若第一图像的置信度大于第二图像的置信度，则沿着中垂线向远离摄像头的方向移动测试目标，否则，沿着中垂线向靠近摄像头的方向移动测试目标；步骤A500：当第一图像的置信度与第二图像的置信度之间差值的绝对值超过设定的阈值范围时，返回步骤A200，进行下一次迭代；具体地，每一个位置都测试一批数据，当第一图像的置信度与第二图像的置信度之间差值的绝对值超过设定的阈值范围时，比对左侧置信度的统计值高还是右侧置信度的统计值高，如果左侧高，则导轨往上移动，反之往下移动，重复迭代执行，最后获得一个最佳位置。步骤A600：计算测试目标与两个摄像头连线的垂直距离，获得分界阈值。具体地，获得最佳位置后，直接计算测试目标所在位置与两个摄像头连线的垂直距离就可以获得分界阈值。由上所述，通过使用采集不同区域的左右侧摄像头，来区分左右不同的职责，从而更精准的识别目标，获得更好的灯光控制效果。本实施例虽然以左右摄像头不同焦距为例，但是左右摄像头还可以采用其他的各种参数形成非对称布局，例如不同分辨率的摄像头：低分辨率的识别大物体，高分辨率的识别小物体；或不同感光度的摄像头：高感光的识别有灯光的车辆，低感光的识别无灯光的行人等等。由于摄像头安装的误差，可能导致摄像头存在俯仰角，目标图像的高度也就相应的不准确，存在偏差，因此，为了修正上述偏差，在一个实施例中，如图6所示，上述步骤S300具体包括如下步骤：步骤S310：基于目标图像的高度、摄像头的高度，根据三角测距法获得第一距离；步骤S320：比较根据左侧的目标图像获得的第一距离和根据右侧的目标图像获得的第一距离，获得距离差；具体地，参考步骤S300，首先根据三角测距法分别获得左侧的目标图像、右侧的目标图像对应的距离。然后，将两侧的车距相减，获得距离差。假定分别为左侧的目标图像、右侧的目标图像对应的第一距离，步骤S330：若距离差小于或等于设定阈值，计算所有第一距离的平均值，将该平均值设为当前车辆与目标之间的距离；具体地，当距离差小于或等于设定阈值时，计算两个距离的平均值，将该平均值设为当前车辆与目标之间的距离。步骤S340：若距离差大于设定阈值，基于目标类别，获得目标的真实尺寸，基于目标图像的宽度、真实尺寸的宽度，根据三角测距法分别获得第二距离，计算所有第二距离的平均值，将该平均值设为当前车辆与目标之间的距离。具体地，当距离差大于设定阈值时，根据目标类别，如前述的小轿车、两厢货车、重型卡车等等，在存储器中获得该类别对应的车辆的宽度。根据三角测距法对宽度信息进行处理，获得第二距离，并对获得的所有第二距离求平均，获得当前车辆与目标之间的距离。如图7所示，通过相似三角形计算出车距其中，L是根据已识别的目标车辆的类别检索获得的实际车宽。L′为目标车辆在摄像头成像中的宽度，f′为摄像头焦距。假定分别为左侧摄像头、右侧摄像头对应的第二距离。计算两个距离的平均值，将该平均值作为当前车辆与目标之间的距离。由上所述，通过根据三角测距法处理高度信息获得车距的距离差，以检测是否存在安装时的俯仰角导致的误差，当存在上述误差时，则根据三角测距法处理宽度信息以获得车距，使得计算的车距结果保持准确，车灯控制效果更好。示例性装置本实施例还提供了一种车灯自适应调光装置，包括：摄像头和与摄像头对应的主控芯片，摄像头和主控芯片均安装在车前灯内。其中，摄像头为常用的车载摄像头，摄像头的安装方式不做具体限制，本实施例如图8所示，在车灯10的透明区域用胶水粘接摄像头安装支架11，然后将摄像头12卡扣在摄像头安装支架11上，安装好摄像头后再进行整个车灯的安装。主控芯片为车载视频处理芯片，如：SAC8539。主控芯片优选如本实施例布设在车灯的灯控板上，以减少车灯内附件占用的空间。可选的，主控芯片也可以安装在单独的控制板上，然后将控制板固定在摄像头安装支架11上。主控芯片与摄像头、车前灯的灯控板电连接，在主控芯片上运行上述的车灯自适应调光方法并将生成的灯光信号传输至对应车灯的灯控板。通过将摄像头及主控芯片均安装在车灯内，摄像头数据不需要通过以太网传输，在车灯内的主控芯片中进行图像分析处理，获得车灯控制策略，最终控制车灯做ADB等相关的动作。而现有技术中将摄像头数据输入车身控制器中进行分析，而由于摄像头的数据量大，无法使用CAN总线来传输视频流数据，需要另外部署车载以太网来传输，不方便安装且增加了造车成本。为了使得摄像头拍摄的区域不重叠，减少因重叠区域导致的控制信号互相干扰的现象，在一个实施例中，摄像头包括安装于左侧车前灯内的左侧摄像头和安装于右侧车前灯内的右侧摄像头，并且左侧摄像头和右侧摄像头被配置为采集不同区域的视频。在每个车灯内都设置了一个摄像头和一个对应的主控芯片。可选的，主控芯片与灯控板之间可以通过CAN总线或LIN总线连接，以传输灯光信号。其中，CAN是控制器局域网络；LIN是针对汽车分布式电子系统而定义的一种低成本的串行通讯网络，是对控制器区域网络等其它汽车多路网络的一种补充。为了实现对车灯的统一控制，本实施例中的主控芯片还与车身控制器电连接，能够接收车身控制器对灯光的控制信号并将该信号传输至车灯的灯控板。优选的，为了使得视频数据接口标准化，摄像头与主控芯片之间采用基于摄像头和传感器的移动行业处理器接口规范或长距离串行器-解串器物理层接口规范的接口协议传输数据。在一个实施例中，还分别在左侧车后灯内、右侧车后灯内安装摄像头和主控芯片，用来实现对车后灯的灯光控制。本实施例将每一个车灯的智能处理，全在车灯内部处理。车灯接口上和以前非智能化车灯接口一致，方便在已有车型上的智能化车灯更新换代，另外，相比摄像头在车灯外和将视频传送至主控制器，减少了以太网连接线，在成本上有很大优势并且消除了由于车灯和摄像头位置带来的偏差，实现对车灯的准确控制。可选的，左右侧摄像头的镜头分别为长焦镜头和广角镜头。广角镜头用来拍摄近处的目标且视角比较广，长焦镜头用来拍摄远处的目标，虽然视角比较窄，但是可以看清远处的目标。本实施例中左侧使用广角镜头,右侧使用长焦镜头。可选的，左右侧摄像头的视角范围不同，如左侧摄像头的FOV为100～160°，右侧摄像头的FOV为30～50°。即使对向车辆有强光打过来时，由于右侧摄像头FOV较小，中间路段的车辆也能看清。这是左右不同规格摄像头所带来的优势。可选的，左右侧摄像头还可以在感光度上进行不同配置，如左侧为用于识别有灯光车辆的高感光摄像头，右侧为用于识别无灯光的行人的低感光摄像头。可选的，左右侧摄像头在分辨率上不同，低分辨率摄像头用来识别大物体，高分辨率摄像头用来识别小物体。由上所述，通过设置左右不同配置的摄像头，使得左右侧的摄像头能采集不同的视频，带来更多的信息量，从而实现更精准的识别。具体的，本实施例中，上述车灯自适应调光装置的具体功能可以参照上述车灯自适应调光方法中的对应描述，在此不再赘述。基于上述实施例，本发明还提供了一种智能终端，其原理框图可以如图9所示。上述智能终端包括通过系统总线连接的处理器、存储器、网络接口以及显示屏。其中，该智能终端的处理器用于提供计算和控制能力。该智能终端的存储器包括非易失性存储介质、内存储器。该非易失性存储介质存储有操作系统和车灯自适应调光程序。该内存储器为非易失性存储介质中的操作系统和车灯自适应调光程序的运行提供环境。该智能终端的网络接口用于与外部的终端通过网络连接通信。该车灯自适应调光程序被处理器执行时实现上述任意一种车灯自适应调光方法的步骤。该智能终端的显示屏可以是液晶显示屏或者电子墨水显示屏。本领域技术人员可以理解，图9中示出的原理框图，仅仅是与本发明方案相关的部分结构的框图，并不构成对本发明方案所应用于其上的智能终端的限定，具体的智能终端可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。在一个实施例中，提供了一种智能终端，上述智能终端包括存储器、处理器以及存储在上述存储器上并可在上述处理器上运行的车灯自适应调光程序，上述车灯自适应调光程序被上述处理器执行时进行以下操作指令：获取摄像头采集的视频数据，所述摄像头包括用于安装在左侧车前灯附近的左侧摄像头和用于安装在右侧车前灯附近的右侧摄像头；将所述视频数据分别输入神经网络模型进行目标检测，获得目标类别和目标图像；基于所述目标类别和所述目标图像，获得当前车辆与所述目标之间的距离；根据所述目标类别和所述距离，生成用于控制车前灯的灯光信号。可选的，所述基于所述目标类别和所述目标图像，获得当前车辆与所述目标之间的距离，包括：基于所述目标图像的高度、摄像头的高度，根据三角测距法获得第一距离；比较根据左侧的目标图像获得的第一距离和根据右侧的目标图像获得的第一距离，获得距离差；若所述距离差小于或等于设定阈值，计算所有第一距离的平均值，将该平均值设为所述距离；若所述距离差大于设定阈值：基于所述目标类别，获得所述目标的真实尺寸；基于所述目标图像的宽度、所述真实尺寸的宽度，根据三角测距法获得第二距离；计算所有第二距离的平均值，将该平均值设为所述距离。可选的，还设有与所述摄像头一一对应的处理终端，所述处理终端上部署有神经网络模型以分别对左侧摄像头采集的视频数据、右侧摄像头采集的视频数据进行处理，并在获得所述第一距离后，还在两个处理终端之间互传校准信息。可选的，所述左侧摄像头和所述右侧摄像头分别被配置为拍摄近处或拍摄远处，所述根据所述目标类别和所述距离，生成用于控制车前灯的灯光信号，包括：当所述距离小于预先标定的分界阈值，根据所述目标类别、所述距离生成与拍摄近处的摄像头对应的车前灯的灯光信号；当所述距离大于或等于预先标定的分界阈值，根据所述目标类别、所述距离生成与拍摄远处的摄像头对应的车前灯的灯光信号。可选的，所述左侧摄像头被配置为拍摄近处，所述右侧摄像头被配置为拍摄远处，预先确定所述分界阈值，包括：将测试目标放置在前方，位于两个摄像头连线的中垂线上；获取所述左侧摄像头拍摄的第一图像和所述右侧摄像头拍摄的第二图像；分别获取第一图像、第二图像的置信度；若第一图像的置信度大于第二图像的置信度，则沿着所述中垂线向远离摄像头的方向移动测试目标，否则，沿着所述中垂线向靠近摄像头的方向移动目标物体；当第一图像的置信度与第二图像的置信度之间差值的绝对值超过设定的阈值范围时，返回获取所述左侧摄像头拍摄的第一图像和所述右侧摄像头拍摄的第二图像，进行下一次迭代；计算测试目标与两个摄像头连线的垂直距离，获得所述分界阈值。本发明实施例还提供一种计算机可读存储介质，上述计算机可读存储介质上存储有车灯自适应调光程序，上述车灯自适应调光程序被处理器执行时实现本发明实施例提供的任意一种车灯自适应调光方法的步骤。应理解，上述实施例中各步骤的序号大小并不意味着执行顺序的先后，各过程的执行顺序应以其功能和内在逻辑确定，而不应对本发明实施例的实施过程构成任何限定。所属领域的技术人员可以清楚地了解到，为了描述的方便和简洁，仅以上述各功能单元、模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能单元、模块完成，即将上述装置的内部结构划分成不同的功能单元或模块，以完成以上描述的全部或者部分功能。实施例中的各功能单元、模块可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中，上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。另外，各功能单元、模块的具体名称也只是为了便于相互区分，并不用于限制本发明的保护范围。上述系统中单元、模块的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述或记载的部分，可以参见其它实施例的相关描述。本领域普通技术人员可以意识到，结合本文中所公开的实施例描述的各实例的单元及算法步骤，能够以电子硬件、或者计算机软件和电子硬件的结合来实现。这些功能究竟是以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同法来实现所描述的功能，但是这种实现不应认为超出本发明的范围。在本发明所提供的实施例中，应该理解到，所揭露的装置/终端设备和方法，可以通过其它的方式实现。例如，以上所描述的装置/终端设备实施例仅仅是示意性的，例如，上述模块或单元的划分，仅仅为一种逻辑功能划分，实际实现时可以由另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。上述集成的模块/单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读存储介质中。基于这样的理解，本发明实现上述实施例方法中的全部或部分流程，也可以通过计算机程序来指令相关的硬件来完成，上述计算机程序可存储于一计算机可读存储介质中，该计算机程序在被处理器执行时，可实现上述各个方法实施例的步骤。其中，上述计算机程序包括计算机程序代码，上述计算机程序代码可以为源代码形式、对象代码形式、可执行文件或某些中间形式等。上述计算机可读介质可以包括：能够携带上述计算机程序代码的任何实体或装置、记录介质、U盘、移动硬盘、磁碟、光盘、计算机存储器、只读存储器、随机存取存储器、电载波信号、电信信号以及软件分发介质等。需要说明的是，上述计算机可读存储介质包含的内容可以根据司法管辖区内立法和专利实践的要求进行适当的增减。以上所述实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解；其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不是相应技术方案的本质脱离本发明各实施例技术方案的精神和范围，均应包含在本发明的保护范围之内。
