标题title
一种用于分布式通信的非线性密钥更新方法
摘要abst
本发明涉及通信高数量密钥更新领域，尤其涉及一种用于分布式通信的非线性密钥更新方法，包括：S1、获取分布式通信线路基础架构；S2、根据所述分布式通信线路基础架构建立初始非线性密钥池；S3、利用所述初始非线性密钥池根据分布式通信线路基础架构完成非线性密钥更新，根据其连接端口、线路级别与密钥更新相结合，实现了非线性原理，其更新原理或更新结果均无法单独预测，有较好的保密性，而且考虑到实际应用中对于节点的需求不尽相同，在被动补充的同时，又可以根据本方案进行主动补充，同时本方案针对单次单节点的密钥更新提供了完整的闭环方法，在复杂分布式通信网络中具有较好更新实时性与高随机性。
权利要求书clms
1.一种用于分布式通信的非线性密钥更新方法，其特征在于，包括：S1、获取分布式通信线路基础架构；S2、根据所述分布式通信线路基础架构建立初始非线性密钥池；S3、利用所述初始非线性密钥池根据分布式通信线路基础架构完成非线性密钥更新。2.如权利要求1所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，所述获取分布式通信线路基础架构包括：S1-1、利用分布式通信线路的发送端划分为一级发送节点；S1-2、利用分布式通信线路的接收端划分为一级接收节点；S1-3、利用分布式通信线路的中转节点划分为二级节点；S1-4、利用所述一级发送节点、一级接收节点与二级节点得到分布式通信线路基础架构。3.如权利要求2所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，利用所述一级发送节点、一级接收节点与二级节点得到分布式通信线路基础架构包括：S1-4-1、判断所述一级发送节点与一级接收节点间是否存在二级节点，若是，则执行S1-4-2，否则，利用一级发送节点与一级接收节点间通信线路划分为一级通信线路；S1-4-2、判断所述一级发送节点与一级接收节点间二级节点的数量是否为1，若是，则执行S1-4-3，否则，所述二级节点对应通信线路划分为四级通信线路；S1-4-3、判断所述一级发送节点与一级接收节点间二级节点是否为双向数据传输，若是，则所述二级节点对应通信线路作为三级通信线路，否则，所述二级节点对应通信线路作为二级通信线路；S1-4-4、利用所述一级发送节点、一级接收节点、二级节点、一级通信线路、二级通信线路、三级通信线路与四级通信线路作为分布式通信线路基础架构。4.如权利要求2所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，根据所述分布式通信线路基础架构建立初始非线性密钥池包括：利用量子随机数生成器根据一级发送节点、一级接收节点与二级节点生成一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数；利用所述一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数建立初始非线性密钥池；其中，一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数相互均无关联。5.如权利要求4所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，利用所述一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数建立初始非线性密钥池包括：基于随机选择算法获取初始量子密钥编号；利用所述初始量子密钥编号对一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数进行密钥划分处理得到一级发送节点量子密钥、一级接收节点量子密钥与二级节点量子密钥；利用所述一级发送节点对应一级发送节点量子密钥建立一级发送节点密钥池；利用所述一级接收节点对应一级接收节点量子密钥建立一级接收节点密钥池；利用所述二级节点对应二级节点量子密钥建立二级节点密钥池；利用所述一级发送节点密钥池、一级接收节点密钥池与二级节点密钥池作为初始非线性密钥池；其中，二级节点密钥池的流动方向与二级节点数据传输方向一致。6.如权利要求1所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，利用所述初始非线性密钥池根据分布式通信线路基础架构完成非线性密钥更新包括：S3-1、当所述初始非线性密钥池为主动更新时，根据分布式通信线路基础架构对初始非线性密钥池进行外部更新完成非线性密钥更新；S3-2、当所述初始非线性密钥池为非主动更新时，利用初始非线性密钥池中各密钥池进行内部更新完成非线性密钥更新；其中，主动更新为当前时刻初始非线性密钥池为满足数据加密需求进行更新，非主动更新为当前时刻初始非线性密钥池无法满足数据加密需求进行更新。7.如权利要求6所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，所述根据分布式通信线路基础架构对初始非线性密钥池进行外部更新完成非线性密钥更新包括：S3-1-1、判断初始非线性密钥池中待更新密钥池是否为二级节点密钥池，若是，则执行S3-1-2，否则，执行S3-1-4；S3-1-2、判断所述待更新密钥池的流动方向是否为双向，若是，则复制获取全部与待更新密钥池相邻密钥池的量子密钥对待更新密钥池完成非线性密钥更新，否则，获取待更新密钥池相邻上一密钥中未使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-3；S3-1-3、判断所述待更新密钥池中量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对待更新密钥池中量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-3；S3-1-4、判断初始非线性密钥池中待更新密钥池是否为一级发送节点密钥池，若是，则根据所述待更新密钥池对应分布式通信线路基础架构进行外部更新完成非线性密钥更新，否则，执行S3-1-5；S3-1-5、根据一级接收节点密钥池对应的一级发送节点密钥池进行外部更新完成非线性密钥更新。8.如权利要求7所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，根据所述待更新密钥池对应分布式通信线路基础架构进行外部更新完成非线性密钥更新包括：S3-1-4-1、判断所述待更新密钥池是否对应一级通信线路，若是，则获取与其对应的一级接收节点密钥池中已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-4-2，否则，执行S3-1-4-3；S3-1-4-2、判断一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-4-2；S3-1-4-3、获取一级发送节点密钥池对应二级节点密钥池中已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-4-4；S3-1-4-4、判断一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-4-4。9.如权利要求7所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，根据一级接收节点密钥池对应的一级发送节点密钥池进行外部更新完成非线性密钥更新包括：S3-1-5-1、判断所述一级接收节点密钥池对应的一级发送节点密钥池中已使用量子密钥的去向是否为二级节点，若是，则获取已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-5-2，否则，返回S3-1-4-1；S3-1-5-2、判断所述一级接收节点密钥池对应的一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-5-2。10.如权利要求6所述的一种用于分布式通信的非线性密钥更新方法，其特征在于，所述利用初始非线性密钥池中各密钥池进行内部更新完成非线性密钥更新包括：S3-2-1、判断初始非线性密钥池中待更新密钥池是否对应四级通信线路，若是，则获取四级通信线路对应全部二级节点密钥池的未使用量子密钥对待更新密钥池进行内部更新完成非线性密钥更新，否则，执行S3-2-2；S3-2-2、判断所述待更新密钥池是否对应三级通信线路，若是，则获取三级通信线路中二级节点的历史中转量子密钥对应密钥编号作为更新密钥编号后，执行S3-2-3，否则，执行S3-2-4；S3-2-3、判断所述待更新密钥池中量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对待更新密钥池中量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-2-3；S3-2-4、判断所述待更新密钥池是否对应二级通信线路，若是，则获取二级通信线路中一级接收节点密钥池的未使用量子密钥对应密钥编号作为更新密钥编号，执行S3-2-5，否则，执行S3-1-4-1。
说明书desc
技术领域本发明涉及通信高数量密钥更新领域，具体涉及一种用于分布式通信的非线性密钥更新方法。背景技术分布式通信由于其数据端众多，分布广可靠性高，具有较为广泛的应用，但是在分布式通信网络中节点端口众多，无法对各节点中用于数据加密的密钥进行实时监控补充，同时现有补充方法在分布式通信网络中又存在一定风险，而将分布式通信网络结果与加密密钥处理相结合是现有技术的空缺。发明内容针对现有技术的不足，本发明提供了一种用于分布式通信的非线性密钥更新方法，通过将分布式通信网络结构与密钥更新手段相结合，提升更新效率与可靠性。为实现上述目的，本发明提供了一种用于分布式通信的非线性密钥更新方法，包括：S1、获取分布式通信线路基础架构；S2、根据所述分布式通信线路基础架构建立初始非线性密钥池；S3、利用所述初始非线性密钥池根据分布式通信线路基础架构完成非线性密钥更新。优选的，所述获取分布式通信线路基础架构包括：S1-1、利用分布式通信线路的发送端划分为一级发送节点；S1-2、利用分布式通信线路的接收端划分为一级接收节点；S1-3、利用分布式通信线路的中转节点划分为二级节点；S1-4、利用所述一级发送节点、一级接收节点与二级节点得到分布式通信线路基础架构。进一步的，利用所述一级发送节点、一级接收节点与二级节点得到分布式通信线路基础架构包括：S1-4-1、判断所述一级发送节点与一级接收节点间是否存在二级节点，若是，则执行S1-4-2，否则，利用一级发送节点与一级接收节点间通信线路划分为一级通信线路；S1-4-2、判断所述一级发送节点与一级接收节点间二级节点的数量是否为1，若是，则执行S1-4-3，否则，所述二级节点对应通信线路划分为四级通信线路；S1-4-3、判断所述一级发送节点与一级接收节点间二级节点是否为双向数据传输，若是，则所述二级节点对应通信线路作为三级通信线路，否则，所述二级节点对应通信线路作为二级通信线路；S1-4-4、利用所述一级发送节点、一级接收节点、二级节点、一级通信线路、二级通信线路、三级通信线路与四级通信线路作为分布式通信线路基础架构。进一步的，根据所述分布式通信线路基础架构建立初始非线性密钥池包括：利用量子随机数生成器根据一级发送节点、一级接收节点与二级节点生成一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数；利用所述一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数建立初始非线性密钥池；其中，一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数相互均无关联。进一步的，利用所述一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数建立初始非线性密钥池包括：基于随机选择算法获取初始量子密钥编号；利用所述初始量子密钥编号对一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数进行密钥划分处理得到一级发送节点量子密钥、一级接收节点量子密钥与二级节点量子密钥；利用所述一级发送节点对应一级发送节点量子密钥建立一级发送节点密钥池；利用所述一级接收节点对应一级接收节点量子密钥建立一级接收节点密钥池；利用所述二级节点对应二级节点量子密钥建立二级节点密钥池；利用所述一级发送节点密钥池、一级接收节点密钥池与二级节点密钥池作为初始非线性密钥池；其中，二级节点密钥池的流动方向与二级节点数据传输方向一致。优选的，利用所述初始非线性密钥池根据分布式通信线路基础架构完成非线性密钥更新包括：S3-1、当所述初始非线性密钥池为主动更新时，根据分布式通信线路基础架构对初始非线性密钥池进行外部更新完成非线性密钥更新；S3-2、当所述初始非线性密钥池为非主动更新时，利用初始非线性密钥池中各密钥池进行内部更新完成非线性密钥更新；其中，主动更新为当前时刻初始非线性密钥池为满足数据加密需求进行更新，非主动更新为当前时刻初始非线性密钥池无法满足数据加密需求进行更新。进一步的，所述根据分布式通信线路基础架构对初始非线性密钥池进行外部更新完成非线性密钥更新包括：S3-1-1、判断初始非线性密钥池中待更新密钥池是否为二级节点密钥池，若是，则执行S3-1-2，否则，执行S3-1-4；S3-1-2、判断所述待更新密钥池的流动方向是否为双向，若是，则复制获取全部与待更新密钥池相邻密钥池的量子密钥对待更新密钥池完成非线性密钥更新，否则，获取待更新密钥池相邻上一密钥中未使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-3；S3-1-3、判断所述待更新密钥池中量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对待更新密钥池中量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-3；S3-1-4、判断初始非线性密钥池中待更新密钥池是否为一级发送节点密钥池，若是，则根据所述待更新密钥池对应分布式通信线路基础架构进行外部更新完成非线性密钥更新，否则，执行S3-1-5；S3-1-5、根据一级接收节点密钥池对应的一级发送节点密钥池进行外部更新完成非线性密钥更新。进一步的，根据所述待更新密钥池对应分布式通信线路基础架构进行外部更新完成非线性密钥更新包括：S3-1-4-1、判断所述待更新密钥池是否对应一级通信线路，若是，则获取与其对应的一级接收节点密钥池中已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-4-2，否则，执行S3-1-4-3；S3-1-4-2、判断一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-4-2；S3-1-4-3、获取一级发送节点密钥池对应二级节点密钥池中已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-4-4；S3-1-4-4、判断一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-4-4。进一步的，根据一级接收节点密钥池对应的一级发送节点密钥池进行外部更新完成非线性密钥更新包括：S3-1-5-1、判断所述一级接收节点密钥池对应的一级发送节点密钥池中已使用量子密钥的去向是否为二级节点，若是，则获取已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-5-2，否则，返回S3-1-4-1；S3-1-5-2、判断所述一级接收节点密钥池对应的一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-5-2。进一步的，所述利用初始非线性密钥池中各密钥池进行内部更新完成非线性密钥更新包括：S3-2-1、判断初始非线性密钥池中待更新密钥池是否对应四级通信线路，若是，则获取四级通信线路对应全部二级节点密钥池的未使用量子密钥对待更新密钥池进行内部更新完成非线性密钥更新，否则，执行S3-2-2；S3-2-2、判断所述待更新密钥池是否对应三级通信线路，若是，则获取三级通信线路中二级节点的历史中转量子密钥对应密钥编号作为更新密钥编号后，执行S3-2-3，否则，执行S3-2-4；S3-2-3、判断所述待更新密钥池中量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对待更新密钥池中量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-2-3；S3-2-4、判断所述待更新密钥池是否对应二级通信线路，若是，则获取二级通信线路中一级接收节点密钥池的未使用量子密钥对应密钥编号作为更新密钥编号，执行S3-2-5，否则，执行S3-1-4-1。与最接近的现有技术相比，本发明具有的有益效果：将分布式通信网络中各节点与通信线路根据其复杂程度进行级别划分，而后根据其连接端口、线路级别与密钥更新相结合，实现了非线性原理，其更新原理或更新结果均无法单独预测，有较好的保密性，而且考虑到实际应用中对于节点的需求不尽相同，在被动补充的同时，又可以根据本方案进行主动补充，同时本方案针对单次单节点的密钥更新提供了完整的闭环方法，在复杂分布式通信网络中具有较好更新实时性与高随机性。附图说明图1是本发明提供的一种用于分布式通信的非线性密钥更新方法。具体实施方式下面结合附图对本发明的具体实施方式作进一步的详细说明。为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。实施例1：本发明提供了一种用于分布式通信的非线性密钥更新方法，如图1所示，包括：S1、获取分布式通信线路基础架构；S2、根据所述分布式通信线路基础架构建立初始非线性密钥池；S3、利用所述初始非线性密钥池根据分布式通信线路基础架构完成非线性密钥更新。S1具体包括：S1-1、利用分布式通信线路的发送端划分为一级发送节点；S1-2、利用分布式通信线路的接收端划分为一级接收节点；S1-3、利用分布式通信线路的中转节点划分为二级节点；S1-4、利用所述一级发送节点、一级接收节点与二级节点得到分布式通信线路基础架构。S1-4具体包括：S1-4-1、判断所述一级发送节点与一级接收节点间是否存在二级节点，若是，则执行S1-4-2，否则，利用一级发送节点与一级接收节点间通信线路划分为一级通信线路；S1-4-2、判断所述一级发送节点与一级接收节点间二级节点的数量是否为1，若是，则执行S1-4-3，否则，所述二级节点对应通信线路划分为四级通信线路；S1-4-3、判断所述一级发送节点与一级接收节点间二级节点是否为双向数据传输，若是，则所述二级节点对应通信线路作为三级通信线路，否则，所述二级节点对应通信线路作为二级通信线路；S1-4-4、利用所述一级发送节点、一级接收节点、二级节点、一级通信线路、二级通信线路、三级通信线路与四级通信线路作为分布式通信线路基础架构。S2具体包括：S2-1、利用量子随机数生成器根据一级发送节点、一级接收节点与二级节点生成一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数；S2-2、利用所述一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数建立初始非线性密钥池；其中，一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数相互均无关联。S2-2具体包括：S2-2-1、基于随机选择算法获取初始量子密钥编号；S2-2-2、利用所述初始量子密钥编号对一级发送节点量子随机数、一级接收节点量子随机数与二级节点量子随机数进行密钥划分处理得到一级发送节点量子密钥、一级接收节点量子密钥与二级节点量子密钥；S2-2-3、利用所述一级发送节点对应一级发送节点量子密钥建立一级发送节点密钥池；S2-2-4、利用所述一级接收节点对应一级接收节点量子密钥建立一级接收节点密钥池；S2-2-5、利用所述二级节点对应二级节点量子密钥建立二级节点密钥池；S2-2-6、利用所述一级发送节点密钥池、一级接收节点密钥池与二级节点密钥池作为初始非线性密钥池；其中，二级节点密钥池的流动方向与二级节点数据传输方向一致。S3具体包括：S3-1、当所述初始非线性密钥池为主动更新时，根据分布式通信线路基础架构对初始非线性密钥池进行外部更新完成非线性密钥更新；S3-2、当所述初始非线性密钥池为非主动更新时，利用初始非线性密钥池中各密钥池进行内部更新完成非线性密钥更新；其中，主动更新为当前时刻初始非线性密钥池为满足数据加密需求进行更新，非主动更新为当前时刻初始非线性密钥池无法满足数据加密需求进行更新。S3-1具体包括：S3-1-1、判断初始非线性密钥池中待更新密钥池是否为二级节点密钥池，若是，则执行S3-1-2，否则，执行S3-1-4；S3-1-2、判断所述待更新密钥池的流动方向是否为双向，若是，则复制获取全部与待更新密钥池相邻密钥池的量子密钥对待更新密钥池完成非线性密钥更新，否则，获取待更新密钥池相邻上一密钥中未使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-3；S3-1-3、判断所述待更新密钥池中量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对待更新密钥池中量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-3；S3-1-4、判断初始非线性密钥池中待更新密钥池是否为一级发送节点密钥池，若是，则根据所述待更新密钥池对应分布式通信线路基础架构进行外部更新完成非线性密钥更新，否则，执行S3-1-5；S3-1-5、根据一级接收节点密钥池对应的一级发送节点密钥池进行外部更新完成非线性密钥更新。S3-1-4具体包括：S3-1-4-1、判断所述待更新密钥池是否对应一级通信线路，若是，则获取与其对应的一级接收节点密钥池中已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-4-2，否则，执行S3-1-4-3；S3-1-4-2、判断一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-4-2；S3-1-4-3、获取一级发送节点密钥池对应二级节点密钥池中已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-4-4；S3-1-4-4、判断一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-4-4。S3-1-5具体包括：S3-1-5-1、判断所述一级接收节点密钥池对应的一级发送节点密钥池中已使用量子密钥的去向是否为二级节点，若是，则获取已使用量子密钥对应密钥编号作为更新密钥编号后，执行S3-1-5-2，否则，返回S3-1-4-1；S3-1-5-2、判断所述一级接收节点密钥池对应的一级发送节点密钥池中未使用量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对一级发送节点密钥池中未使用量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-1-5-2。S3-2具体包括：S3-2-1、判断初始非线性密钥池中待更新密钥池是否对应四级通信线路，若是，则获取四级通信线路对应全部二级节点密钥池的未使用量子密钥对待更新密钥池进行内部更新完成非线性密钥更新，否则，执行S3-2-2；S3-2-2、判断所述待更新密钥池是否对应三级通信线路，若是，则获取三级通信线路中二级节点的历史中转量子密钥对应密钥编号作为更新密钥编号后，执行S3-2-3，否则，执行S3-2-4；S3-2-3、判断所述待更新密钥池中量子密钥对应量子随机数是否大于更新密钥编号对应量子随机数，若是，则利用所述更新密钥编号对待更新密钥池中量子密钥对应量子随机数进行划分得到更新量子密钥完成非线性密钥更新，否则，利用量子随机数生成器对待更新密钥池进行量子随机数补充后，返回S3-2-3；S3-2-4、判断所述待更新密钥池是否对应二级通信线路，若是，则获取二级通信线路中一级接收节点密钥池的未使用量子密钥对应密钥编号作为更新密钥编号，执行S3-2-5，否则，执行S3-1-4-1。本实施例中，一种用于分布式通信的非线性密钥更新方法，本方案通过划分各节点与通信线路为不同级别，后续获取待更新密钥池对应各节点与线路进行相邻节点快速处理更新或单独补充更新，划分依据根据线路复杂程度，等级逐渐上升。本实施例中，一种用于分布式通信的非线性密钥更新方法，通过节点、线路、密钥三者在密钥更新时的协同处理，实现非线性原理，在原有量子加密的基础上，进一步提升密钥密级，保证线路和数据传输安全。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。最后应当说明的是：以上实施例仅用以说明本发明的技术方案而非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等同替换，其均应涵盖在本发明的权利要求保护范围之内。
