标题title
多媒体数据泄露溯源检测方法、装置及设备
摘要abst
本申请提供一种多媒体数据泄露溯源检测方法、装置及设备，该方法可以包括：从所有多媒体数据流中确定出泄露数据流和所述泄露数据流对应的关联数据流；确定所述泄露数据流对应的目标泄露路径，基于背景流量图和目标泄露路径生成数据流转图谱；其中，背景流量图包括内网各主机之间的拓扑关系，目标泄露路径包括关联数据流和泄露数据流经过的多个候选主机；其中，在背景流量图标记多个候选主机，并在背景流量图标记每个候选主机对应的节点属性，得到数据流转图谱；将数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。通过本申请方案，能够实现更精准的异常主机溯源。
权利要求书clms
1.一种多媒体数据泄露溯源检测方法，其特征在于，所述方法包括：从所有多媒体数据流中确定出泄露数据流和泄露数据流对应的关联数据流，泄露数据流是从内网主机到外网的数据流，关联数据流是从内网主机到内网主机的数据流，泄露数据流的流量特征与关联数据流的流量特征满足相似度条件；确定所述泄露数据流对应的目标泄露路径，并基于背景流量图和所述目标泄露路径生成数据流转图谱；其中，所述背景流量图包括内网各主机之间的拓扑关系，所述目标泄露路径包括所述关联数据流和所述泄露数据流经过的多个候选主机；其中，在所述背景流量图标记所述多个候选主机，并在所述背景流量图标记每个候选主机对应的节点属性，得到所述数据流转图谱；将所述数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。2.根据权利要求1所述的方法，其特征在于，所述从所有多媒体数据流中确定出泄露数据流和泄露数据流对应的关联数据流之前，所述方法还包括：针对已获取的每个第一网络流量，确定所述第一网络流量对应的第二网络流量，所述第二网络流量的目的地址与所述第一网络流量的源地址相同，且所述第二网络流量的源地址与所述第一网络流量的目的地址相同；若所述第一网络流量对应的字节数与所述第二网络流量对应的字节数的差值的绝对值大于第一阈值，则将所述第一网络流量确定为多媒体数据流。3.根据权利要求1所述的方法，其特征在于，所述从所有多媒体数据流中确定出泄露数据流，包括：针对每个多媒体数据流，若该多媒体数据流的源地址位于已配置的地址段，所述地址段包括内网所有主机的地址，且该多媒体数据流的目的地址不位于所述地址段，则确定该多媒体数据流是泄露数据流；若该多媒体数据流的源地址位于所述地址段，且该多媒体数据流的目的地址位于所述地址段，则确定该多媒体数据流是候选数据流。4.根据权利要求3所述的方法，其特征在于，所述从所有多媒体数据流中确定出泄露数据流对应的关联数据流，包括：针对每个泄露数据流，基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流；其中，流量特征包括获取时间和字节数；该关联数据流的获取时间与该泄露数据流的获取时间的差值的绝对值小于第二阈值，且该关联数据流的字节数与该泄露数据流的字节数的差值的绝对值小于第三阈值。5.根据权利要求4所述的方法，其特征在于，所述基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流，包括：计算该泄露数据流的流量特征与各候选数据流的流量特征之间的相似度；基于所述相似度，采用聚类算法确定以该泄露数据流为聚类中心的聚类集合，所述聚类集合包括该泄露数据流对应的关联数据流，且该泄露数据流的流量特征与关联数据流的流量特征之间的相似度满足相似度条件；其中，若所述相似度为欧式距离，则满足相似度条件是指：该泄露数据流的流量特征与关联数据流的流量特征之间的欧式距离小于预设距离阈值。6.根据权利要求1所述的方法，其特征在于，所述确定所述泄露数据流对应的目标泄露路径，包括：从所述泄露数据流对应的所有关联数据流中选取目标关联数据流；其中，所述目标关联数据流的获取时间早于所述泄露数据流的获取时间；基于所述泄露数据流的源地址、目标关联数据流的源地址和目的地址确定数据流排列顺序；前一个目标关联数据流的目的地址是后一个目标关联数据流的源地址，最后一个目标关联数据流的目的地址是所述泄露数据流的源地址；基于所述数据流排列顺序确定所述泄露数据流对应的目标泄露路径。7.根据权利要求1所述的方法，其特征在于，所述将所述数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，包括：若所述异常检测模型包括编码器和解码器，则将所述数据流转图谱输入给所述编码器，通过所述编码器将所述数据流转图谱转换为隐层特征；将所述隐层特征输入给所述解码器，通过所述解码器基于所述隐层特征对所述数据流转图谱的邻接矩阵和特征矩阵进行重建，得到邻接重建矩阵和特征重建矩阵；其中，所述邻接矩阵表示所述数据流转图谱的拓扑结构，所述特征矩阵表示所述数据流转图谱内的每个候选主机的节点属性；基于所述邻接重建矩阵与所述邻接矩阵的差值、所述特征重建矩阵与所述特征矩阵的差值，确定每个候选主机对应的异常分数。8.一种多媒体数据泄露溯源检测装置，其特征在于，所述装置包括：确定模块，用于从所有多媒体数据流中确定出泄露数据流和所述泄露数据流对应的关联数据流；其中，所述泄露数据流是从内网主机到外网的数据流，所述关联数据流是从内网主机到内网主机的数据流，且所述泄露数据流的流量特征与所述关联数据流的流量特征满足相似度条件；生成模块，用于确定所述泄露数据流对应的目标泄露路径，基于背景流量图和所述目标泄露路径生成数据流转图谱；其中，所述背景流量图包括内网各主机之间的拓扑关系，所述目标泄露路径包括所述关联数据流和所述泄露数据流经过的多个候选主机；其中，在所述背景流量图标记所述多个候选主机，并在所述背景流量图标记每个候选主机对应的节点属性，得到所述数据流转图谱；处理模块，用于将数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。9.根据权利要求8所述的装置，其特征在于，其中，所述确定模块，还用于针对已获取的每个第一网络流量，确定第一网络流量对应的第二网络流量，所述第二网络流量的目的地址与所述第一网络流量的源地址相同，且所述第二网络流量的源地址与所述第一网络流量的目的地址相同；若所述第一网络流量对应的字节数与所述第二网络流量对应的字节数的差值的绝对值大于第一阈值，则将所述第一网络流量确定为多媒体数据流；其中，所述确定模块从所有多媒体数据流中确定出泄露数据流时具体用于：针对每个多媒体数据流，若该多媒体数据流的源地址位于已配置的地址段，所述地址段包括内网所有主机的地址，且该多媒体数据流的目的地址不位于所述地址段，则确定该多媒体数据流是泄露数据流；若该多媒体数据流的源地址位于所述地址段，且该多媒体数据流的目的地址位于所述地址段，则确定该多媒体数据流是候选数据流；所述确定模块从所有多媒体数据流中确定出泄露数据流对应的关联数据流时具体用于：针对每个泄露数据流，基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流；其中，流量特征包括获取时间和字节数；该关联数据流的获取时间与该泄露数据流的获取时间的差值的绝对值小于第二阈值，且该关联数据流的字节数与该泄露数据流的字节数的差值的绝对值小于第三阈值；其中，所述确定模块基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流时具体用于：计算该泄露数据流的流量特征与各候选数据流的流量特征之间的相似度；基于所述相似度，采用聚类算法确定以该泄露数据流为聚类中心的聚类集合，其中，所述聚类集合包括该泄露数据流对应的关联数据流，且该泄露数据流的流量特征与关联数据流的流量特征之间的相似度满足相似度条件；其中，若所述相似度为欧式距离，则满足相似度条件是指：该泄露数据流的流量特征与关联数据流的流量特征之间的欧式距离小于预设距离阈值；其中，所述生成模块确定所述泄露数据流对应的目标泄露路径时具体用于：从所述泄露数据流对应的所有关联数据流中选取目标关联数据流；其中，所述目标关联数据流的获取时间早于所述泄露数据流的获取时间；基于所述泄露数据流的源地址、所述目标关联数据流的源地址和目的地址确定数据流排列顺序；前一个目标关联数据流的目的地址是后一个目标关联数据流的源地址，最后一个目标关联数据流的目的地址是所述泄露数据流的源地址；基于所述数据流排列顺序确定所述泄露数据流对应的目标泄露路径；其中，所述处理模块将数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数时具体用于：若所述异常检测模型包括编码器和解码器，则将所述数据流转图谱输入给所述编码器，通过所述编码器将所述数据流转图谱转换为隐层特征；将所述隐层特征输入给所述解码器，通过所述解码器基于所述隐层特征对所述数据流转图谱的邻接矩阵和特征矩阵进行重建，得到邻接重建矩阵和特征重建矩阵；其中，所述邻接矩阵表示所述数据流转图谱的拓扑结构，所述特征矩阵表示所述数据流转图谱内的每个候选主机的节点属性；基于所述邻接重建矩阵与所述邻接矩阵的差值、所述特征重建矩阵与所述特征矩阵的差值，确定每个候选主机对应的异常分数。10.一种电子设备，其特征在于，包括：处理器和机器可读存储介质，所述机器可读存储介质存储有能够被所述处理器执行的机器可执行指令；所述处理器用于执行机器可执行指令，以实现权利要求1-7任一所述的方法。
说明书desc
技术领域本申请涉及网络安全技术领域，尤其是涉及一种多媒体数据泄露溯源检测方法、装置及设备。背景技术物联网设备包括IPC、DVR和NVR等，随着物联网技术的快速发展，网络中的物联网设备越来越多，物联网设备的数据泄露也越来越多，物联网设备的多媒体数据的信息量非常丰富，一旦多媒体数据发生泄露，会造成大量隐私数据的泄露。在多媒体数据发生泄露时，需要及时检测出哪个物联网设备发生多媒体数据泄露，继而对这个物联网设备进行安全管理，避免多媒体数据再次泄露。但是，应该如何检测哪个物联网设备发生多媒体数据泄露，在相关技术中并没有有效的检测方式，无法准确检测哪个物联网设备发生多媒体数据泄露，继而导致多媒体数据的泄露无法避免。发明内容有鉴于此，本申请提供一种多媒体数据泄露溯源检测方法、装置及设备，能够准确检测哪个物联网设备发生多媒体数据泄露，保证数据的安全性。一方面，本申请提供一种多媒体数据泄露溯源检测方法，所述方法包括：从所有多媒体数据流中确定出泄露数据流和泄露数据流对应的关联数据流，泄露数据流是从内网主机到外网的数据流，关联数据流是从内网主机到内网主机的数据流，泄露数据流的流量特征与关联数据流的流量特征满足相似度条件；确定所述泄露数据流对应的目标泄露路径，并基于背景流量图和所述目标泄露路径生成数据流转图谱；其中，所述背景流量图包括内网各主机之间的拓扑关系，所述目标泄露路径包括所述关联数据流和所述泄露数据流经过的多个候选主机；其中，在所述背景流量图标记所述多个候选主机，并在所述背景流量图标记每个候选主机对应的节点属性，得到所述数据流转图谱；将所述数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。另一方面，本申请提供一种多媒体数据泄露溯源检测装置，所述装置包括：确定模块，用于从所有多媒体数据流中确定出泄露数据流和所述泄露数据流对应的关联数据流；其中，所述泄露数据流是从内网主机到外网的数据流，所述关联数据流是从内网主机到内网主机的数据流，且所述泄露数据流的流量特征与所述关联数据流的流量特征满足相似度条件；生成模块，用于确定所述泄露数据流对应的目标泄露路径，基于背景流量图和所述目标泄露路径生成数据流转图谱；其中，所述背景流量图包括内网各主机之间的拓扑关系，所述目标泄露路径包括所述关联数据流和所述泄露数据流经过的多个候选主机；其中，在所述背景流量图标记所述多个候选主机，并在所述背景流量图标记每个候选主机对应的节点属性，得到所述数据流转图谱；处理模块，用于将数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。另一方面，本申请提供一种电子设备，包括：处理器和机器可读存储介质，机器可读存储介质存储有能够被处理器执行的机器可执行指令；其中，处理器用于执行机器可执行指令，以实现上述的多媒体数据泄露溯源检测方法。另一方面，本申请提供一种机器可读存储介质，所述机器可读存储介质存储有能够被处理器执行的机器可执行指令；其中，所述处理器用于执行所述机器可执行指令，以实现上述的多媒体数据泄露溯源检测方法。另一方面，本申请提供一种计算机程序，所述计算机程序存储于机器可读存储介质，当处理器执行所述机器可读存储介质中的所述计算机程序时，促使所述处理器实现上述的多媒体数据泄露溯源检测方法。由以上技术方案可见，本申请实施例中，基于泄露数据流和泄露数据流对应的关联数据流确定目标泄露路径，并基于背景流量图和目标泄露路径生成数据流转图谱，继而基于数据流转图谱确定异常主机，即通过数据流转图谱进行异常主机的检测，从而实现更精准的异常主机溯源。通过将与数据泄露事件关联的数据传输事件聚合，绘制数据流转图谱，并检测目标泄露路径上的异常主机，从而能够定位整个目标泄露路径上的异常主机。附图说明为了更加清楚地说明本申请实施例或者现有技术中的技术方案，下面将对本申请实施例或者现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请中记载的一些实施例，对于本领域普通技术人员来讲，还可以根据本申请实施例的这些附图获得其他的附图。图1是本申请一种实施方式中的多媒体数据泄露溯源检测方法的流程图；图2是本申请一种实施方式中的应用场景示意图；图3是本申请另一种实施方式中的应用场景示意图；图4是本申请一种实施方式中的多媒体数据泄露溯源检测方法的流程图；图5A-图5C是本申请一种实施方式中的数据流转图谱的示意图；图6是本申请一种实施方式中的多媒体数据泄露溯源检测装置的结构图；图7是本申请一种实施方式中的电子设备的硬件结构图。具体实施方式在本申请实施例使用的术语仅仅是出于描述特定实施例的目的，而非限制本申请。本申请和权利要求书中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其它含义。还应当理解，本文中使用的术语“和/或”是指包含一个或多个相关联的列出项目的任何或所有可能组合。应当理解，尽管在本申请实施例可能采用术语第一、第二、第三等来描述各种信息，但这些信息不应限于这些术语。这些术语仅用来将同一类型的信息彼此区分开。例如，在不脱离本申请范围的情况下，第一信息也可以被称为第二信息，类似地，第二信息也可以被称为第一信息。取决于语境，此外，所使用的词语“如果”可以被解释成为“在……时”或“当……时”或“响应于确定”。本申请实施例中提出一种多媒体数据泄露溯源检测方法，可以应用于任意类型的设备，参见图1所示，为该方法的流程示意图，该方法可以包括：步骤101、从所有多媒体数据流中确定出泄露数据流和该泄露数据流对应的关联数据流。其中，该泄露数据流可以是从内网主机到外网的数据流，该关联数据流可以是从一个内网主机到另一个内网主机的数据流，该泄露数据流的流量特征与该关联数据流的流量特征满足相似度条件。步骤102、确定该泄露数据流对应的目标泄露路径，并基于背景流量图和该目标泄露路径生成数据流转图谱。其中，该背景流量图可以包括内网各主机之间的拓扑关系，该目标泄露路径可以包括关联数据流和泄露数据流经过的多个候选主机。其中，可以在该背景流量图标记多个候选主机，并在该背景流量图标记每个候选主机对应的节点属性，得到该数据流转图谱。步骤103、将该数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。示例性的，在步骤101之前，还可以从所有网络流量中确定出多媒体数据流。比如说，可以采用如下方式确定出多媒体数据流：针对已获取的每个第一网络流量，确定第一网络流量对应的第二网络流量，第二网络流量的目的地址与第一网络流量的源地址相同，且第二网络流量的源地址与第一网络流量的目的地址相同；若第一网络流量对应的字节数与第二网络流量对应的字节数的差值的绝对值大于第一阈值，则将第一网络流量确定为多媒体数据流。示例性的，针对步骤101，从所有多媒体数据流中确定出泄露数据流和泄露数据流对应的关联数据流，可以包括但不限于：针对每个多媒体数据流，若该多媒体数据流的源地址位于已配置的地址段，该地址段可以包括内网所有主机的地址，且该多媒体数据流的目的地址不位于地址段，则确定该多媒体数据流是泄露数据流；若该多媒体数据流的源地址位于地址段，且该多媒体数据流的目的地址位于地址段，则确定该多媒体数据流是候选数据流。示例性的，针对每个泄露数据流，基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流；其中，流量特征包括获取时间和字节数；该关联数据流的获取时间与该泄露数据流的获取时间的差值的绝对值小于第二阈值，该关联数据流的字节数与该泄露数据流的字节数的差值的绝对值小于第三阈值。示例性的，基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流，可以包括但不限于：计算该泄露数据流的流量特征与各候选数据流的流量特征之间的相似度；基于流量特征之间的相似度，可以采用聚类算法确定以该泄露数据流为聚类中心的聚类集合，该聚类集合可以包括该泄露数据流对应的关联数据流，且该泄露数据流的流量特征与关联数据流的流量特征之间的相似度满足相似度条件；其中，若相似度为欧式距离，则满足相似度条件是指：该泄露数据流的流量特征与关联数据流的流量特征之间的欧式距离小于预设距离阈值。示例性的，针对步骤102，确定该泄露数据流对应的目标泄露路径，可以包括但不限于：从该泄露数据流对应的所有关联数据流中选取出目标关联数据流；其中，目标关联数据流的获取时间可以早于该泄露数据流的获取时间；基于该泄露数据流的源地址、每个目标关联数据流的源地址和目的地址，确定数据流排列顺序；其中，前一个目标关联数据流的目的地址是后一个目标关联数据流的源地址，最后一个目标关联数据流的目的地址是该泄露数据流的源地址；基于该数据流排列顺序确定该泄露数据流对应的目标泄露路径。示例性的，针对步骤103，将该数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，可以包括但不限于：若异常检测模型包括编码器和解码器，则将数据流转图谱输入给编码器，通过编码器将数据流转图谱转换为隐层特征；将隐层特征输入给解码器，通过解码器基于隐层特征对数据流转图谱的邻接矩阵和特征矩阵进行重建，得到邻接重建矩阵和特征重建矩阵；其中，邻接矩阵表示数据流转图谱的拓扑结构，特征矩阵表示数据流转图谱内的每个候选主机的节点属性；基于邻接重建矩阵与邻接矩阵的差值、特征重建矩阵与特征矩阵的差值，确定每个候选主机对应的异常分数。由以上技术方案可见，本申请实施例中，基于泄露数据流和泄露数据流对应的关联数据流确定目标泄露路径，并基于背景流量图和目标泄露路径生成数据流转图谱，继而基于数据流转图谱确定异常主机，即通过数据流转图谱进行异常主机的检测，从而实现更精准的异常主机溯源。通过将与数据泄露事件关联的数据传输事件聚合，绘制数据流转图谱，并检测目标泄露路径上的异常主机，从而能够定位整个目标泄露路径上的异常主机。以下结合具体应用场景，对本申请实施例的技术方案进行说明。在多媒体数据发生泄露时，需要及时检测出哪个内网主机发生多媒体数据泄露，继而对这个内网主机进行安全管理，避免多媒体数据再次发生泄露。但是，应该如何检测哪个内网主机发生多媒体数据泄露，在相关技术中并没有有效的检测方式，无法准确检测出哪个内网主机发生多媒体数据泄露。针对上述发现，本申请实施例提出一种多媒体数据泄露溯源检测方法，可以基于数据流转图谱确定异常主机，即通过数据流转图谱进行异常主机的检测，从而实现更精准的异常主机溯源。参见图2所示，为该方法的应用场景示意图，内网包括大量主机，这些主机可以通过网关设备交互，也可以通过网关设备与外网设备交互。其中，主机可以为物联网设备，也可以为其它类型的设备，如个人计算机、笔记本电脑、智能手机等，对此不做限制。网关设备可以为路由器、交换机等。示例性的，多媒体数据泄露溯源检测方法可以应用于网关设备，网关设备可以获取主机之间交互的网络流量、主机与外网设备之间交互的网络流量，基于这些网络流量实现多媒体数据泄露溯源检测。或者，多媒体数据泄露溯源检测方法可以应用于智能分析设备，参见图3所示，为该方法的另一应用场景示意图，智能分析设备与网关设备连接，网关设备可以获取主机之间交互的网络流量、主机与外网设备之间交互的网络流量，并将这些网络流量发送给智能分析设备，由智能分析设备基于这些网络流量实现多媒体数据泄露溯源检测。在上述应用场景下，以多媒体数据泄露溯源检测方法应用于智能分析设备为例，多媒体数据泄露溯源检测方法的流程示意图可以参见图4所示。步骤401、获取针对内网主机的网络流量，该网络流量可以包括内网主机与内网主机之间交互的网络流量、内网主机与外网设备之间交互的网络流量。示例性的，智能分析设备可以采用流量旁路方式获取主机的网络流量，比如说，网关设备每次接收到网络流量时，在转发网络流量的基础上，复制一份网络流量给智能分析设备，这样，智能分析设备可以获取到网络流量。针对每个网络流量，智能分析设备还可以确定该网络流量对应的获取时间、流标识、源地址、目的地址、字节数等信息。其中，获取时间表示智能分析设备得到该网络流量的时间。流标识表示该网络流量的唯一标识，是智能分析设备为该网络流量分配。源地址可以包括源IP地址和源端口，或，源地址可以为源IP地址。目的地址可以包括目的IP地址和目的端口，或，目的地址可以为目的IP地址。字节数表示该网络流量的流传输字节数，即该网络流量的大小。步骤402、从所有网络流量中确定出多媒体数据流。示例性的，针对已获取的每个网络流量，可以将该网络流量记为第一网络流量，基于每个网络流量对应的源地址和目的地址，智能分析设备可以确定第一网络流量对应的第二网络流量，第二网络流量的目的地址与第一网络流量的源地址相同，且第二网络流量的源地址与第一网络流量的目的地址相同。比如说，假设第一网络流量是主机21发送给主机22的网络流量，则第二网络流量是主机22发送给主机21的网络流量，即第一网络流量的源地址是主机21的地址，第一网络流量的目的地址是主机22的地址，第二网络流量的目的地址是主机21的地址，第二网络流量的源地址是主机22的地址。示例性的，基于每个网络流量对应的字节数，若第一网络流量对应的字节数与第二网络流量对应的字节数的差值的绝对值大于第一阈值，则将第一网络流量确定为多媒体数据流。若第一网络流量对应的字节数与第二网络流量对应的字节数的差值的绝对值不大于第一阈值，则禁止将第一网络流量确定为多媒体数据流。显然，在针对每个第一网络流量进行上述处理之后，就可以从所有网络流量中确定出多媒体数据流。比如说，多媒体数据流可以包括但不限于语音、图片、视频等，在发生多媒体数据泄露时，是内网主机向外网设备发送多媒体数据流，而外网设备向内网主机发送非多媒体数据流，因此，若第一网络流量是内网主机向外网设备发送的多媒体数据流，而第二网络流量是外网设备向内网主机发送非多媒体数据流，那么，第一网络流量对应的字节数会远远大于第二网络流量对应的字节数。基于上述原理，若第一网络流量对应的字节数与第二网络流量对应的字节数的差值较大，则可以确定第一网络流量是多媒体数据流。反之，若第一网络流量对应的字节数与第二网络流量对应的字节数的差值较小，则可以确定第一网络流量不是多媒体数据流。在上述过程中，是基于网络流量对应的字节数确定网络流量是否为多媒体数据流，而不是对网络流量进行解析确定网络流量是否为多媒体数据流，这样，即使针对加密的网络流量，也可以获知是否为多媒体数据流。步骤403、针对每个多媒体数据流，确定该多媒体数据流对应的流量特征，该流量特征包括但不限于以下至少一种：获取时间和字节数。示例性的，智能分析设备已经得到每个网络流量的获取时间，在将某个网络流量确定为多媒体数据流时，该网络流量的获取时间就是该多媒体数据流对应的获取时间，该获取时间表示智能分析设备得到该多媒体数据流的时间。智能分析设备已经得到每个网络流量的字节数，在将某个网络流量确定为多媒体数据流时，该网络流量的字节数就是该多媒体数据流对应的字节数，该字节数表示该多媒体数据流的流传输字节数，即该多媒体数据流的大小。步骤404、从所有多媒体数据流中确定出泄露数据流，其中，该泄露数据流可以是从内网主机到外网的多媒体数据流。示例性的，可以预先配置一个地址段，该地址段可以包括内网所有主机的地址，但该地址段不包括外网设备的地址。基于此，针对每个多媒体数据流，若该多媒体数据流的源地址位于该地址段，且该多媒体数据流的目的地址不位于该地址段，即该多媒体数据流是从内网主机到外网设备的多媒体数据流，则确定该多媒体数据流是泄露数据流。或者，若该多媒体数据流的源地址位于该地址段，且该多媒体数据流的目的地址位于该地址段，即该多媒体数据流是从一个内网主机到另一个内网主机的多媒体数据流，则确定该多媒体数据流不是泄露数据流，可以确定该多媒体数据流是候选数据流。示例性的，若所有多媒体数据流中存在泄露数据流，即存在从内网主机到外网设备的多媒体数据流，则可以产生告警信息，如向指定设备发送告警信息，该告警信息用于表示存在内网主机到外网设备的数据泄露事件。步骤405、针对每个泄露数据流，从所有多媒体数据流中确定出该泄露数据流对应的关联数据流，该关联数据流是从一个内网主机到另一个内网主机的数据流，该泄露数据流的流量特征与该关联数据流的流量特征满足相似度条件。示例性的，针对每个泄露数据流，可以基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流。由于每个候选数据流均是从一个内网主机到另一个内网主机的多媒体数据流，因此，在从所有候选数据流中选取出关联数据流时，关联数据流也是从一个内网主机到另一个内网主机的多媒体数据流。在从所有候选数据流中选取关联数据流时，需要使关联数据流的流量特征与该泄露数据流的流量特征满足相似度条件，对此选取方式不做限制，只要关联数据流的流量特征与该泄露数据流的流量特征满足相似度条件即可。示例性的，流量特征可以包括获取时间和字节数，泄露数据流的流量特征与关联数据流的流量特征满足相似度条件，可以包括但不限于以下至少一种：该关联数据流的获取时间与该泄露数据流的获取时间的差值的绝对值小于第二阈值，该关联数据流的字节数与该泄露数据流的字节数的差值的绝对值小于第三阈值。比如说，针对某个候选数据流，若该候选数据流的获取时间与该泄露数据流的获取时间的差值的绝对值小于第二阈值，且该候选数据流的字节数与该泄露数据流的字节数的差值的绝对值小于第三阈值，则将该候选数据流作为该泄露数据流对应的关联数据流，否则，该候选数据流不作为该泄露数据流对应的关联数据流。在一种可能的实施方式中，基于该泄露数据流的流量特征和各候选数据流的流量特征，为了从所有候选数据流中选取出该泄露数据流对应的关联数据流，还可以采用如下方式：计算该泄露数据流的流量特征与各候选数据流的流量特征之间的相似度；基于该泄露数据流的流量特征与各候选数据流的流量特征之间的相似度，可以采用聚类算法确定以该泄露数据流为聚类中心的聚类集合，该聚类集合可以包括该泄露数据流对应的关联数据流，且该泄露数据流的流量特征与关联数据流的流量特征之间的相似度满足相似度条件。比如说，可以将该泄露数据流的流量特征转换为特征矩阵，并将候选数据流的流量特征转换为特征矩阵，继而计算两个特征矩阵之间的相似度，该相似度可以为欧式距离、余弦相似度等，对此相似度的类型不做限制。聚类算法是按照某个特定标准将一个数据集分割成不同的类或簇，使得同一个簇内的数据对象的相似性尽可能大，同时不在同一个簇中的数据对象的差异性也尽可能大，也即聚类后同一类的数据尽可能聚集到一起，不同类数据尽量分离，如K-means聚类算法、基于密度的聚类算法等。聚类算法的输入为多个泄露数据流的流量特征和所有候选数据流的流量特征，基于聚类算法，可以确定K个泄露数据流对应的K个聚类集合，针对每个泄露数据流对应的聚类集合，该聚类集合的聚类中心为该泄露数据流，该聚类集合还包括至少一个候选数据流，这些候选数据流作为该泄露数据流对应的关联数据流。显然，在基于聚类算法进行聚类时，会基于泄露数据流的流量特征与每个候选数据流的流量特征之间的相似度，确定以泄露数据流为聚类中心的聚类集合，且聚类集合内的候选数据流的流量特征与泄露数据流的流量特征之间的相似度满足相似度条件，对此聚类过程不做限制。示例性的，若相似度为欧式距离，则泄露数据流的流量特征与关联数据流的流量特征之间的相似度满足相似度条件是指：该泄露数据流的流量特征与关联数据流的流量特征之间的欧式距离小于预设距离阈值。比如说，在基于聚类算法进行聚类的过程中，若候选数据流的流量特征与某个泄露数据流的流量特征之间的欧式距离小于预设距离阈值，则可以将这个候选数据流添加到以该泄露数据流为聚类中心的聚类集合。综上所述，可以对数据泄露事件的关联事件进行归纳，即泄露数据流对应数据泄露事件，可以从所有多媒体数据流中确定出该泄露数据流对应的关联数据流，显然，由于相同数据泄露事件产生的流量特征具有较高的相似度，因此，可以通过聚类算法，将单位时间内属于相同数据泄露事件的多媒体数据流汇聚在一起，这些多媒体数据流就是关联事件。步骤406、针对每个泄露数据流，确定该泄露数据流对应的目标泄露路径，该目标泄露路径可以包括关联数据流和泄露数据流经过的多个候选主机。示例性的，可以从该泄露数据流对应的所有关联数据流中选取出目标关联数据流，目标关联数据流的获取时间可以早于该泄露数据流的获取时间。比如说，由于泄露数据流是从内网主机到外网设备的多媒体数据流，即内网最后一个节点到外网设备的多媒体数据流，因此，若关联数据流的获取时间早于该泄露数据流的获取时间，则可能属于同一个泄露路径，若关联数据流的获取时间晚于该泄露数据流的获取时间，则不属于同一个泄露路径。基于该泄露数据流的源地址、每个目标关联数据流的源地址和目的地址，确定数据流排列顺序，前一个目标关联数据流的目的地址是后一个目标关联数据流的源地址，最后一个目标关联数据流的目的地址是该泄露数据流的源地址。比如说，假设该泄露数据流的源地址为111，目标关联数据流A1的源地址为222，目的地址为111，目标关联数据流A2的源地址为333，目的地址为222，则数据流排列顺序为目标关联数据流A2、目标关联数据流A1和泄露数据流。基于该数据流排列顺序确定该泄露数据流对应的目标泄露路径。参见图3所示，假设主机21的地址为111，主机22的地址为222，主机23的地址为333，主机24的地址为444，主机25的地址为555，主机26的地址为666，目标关联数据流A2的源地址为333，对应主机23，目标关联数据流A1的源地址为222，对应主机22，泄露数据流的源地址为111，对应主机21，因此，可以确定目标泄露路径为主机23-主机22-主机21。综上所述，可以基于该泄露数据流的源地址、每个目标关联数据流的源地址和目的地址，重塑多媒体数据流的目标泄露路径，比如说，A向B传输多媒体数据流，B向外网设备传输多媒体数据流，则存在A-＞B-＞外网的泄露路径。步骤407、基于背景流量图和该目标泄露路径生成数据流转图谱。其中，该背景流量图可以包括内网各主机之间的拓扑关系。其中，为了生成数据流转图谱，可以在该背景流量图标记多个候选主机，并在该背景流量图标记每个候选主机对应的节点属性，得到该数据流转图谱。比如说，参见图5A所示，为背景流量图的示例，该背景流量图可以是基于所有网络流量生成的，如存在主机21到主机22的网络流量时，则主机21与主机22之间存在连接关系，不存在主机21到主机26的网络流量时，则主机21与主机26之间不存在连接关系，也可以是预先配置的，对此不做限制。参见图5B所示，假设目标泄露路径为主机23-主机22-主机21，则可以在背景流量图标记这些候选主机，即表示这些候选主机是目标泄露路径所经过的主机，并在背景流量图标记目标泄露路径的方向，显然，未被标记的主机，则不是目标泄露路径所经过的主机。在图5B中，通过椭圆表示候选主机，即对候选主机进行标记，也可以通过其它方式标记。参见图5C所示，还可以在该背景流量图标记每个候选主机对应的节点属性，当然，也可以在在该背景流量图标记每个非候选主机对应的节点属性。该节点属性可以包括但不限于以下至少一种：是否属于目标泄露路径；节点类型；流量特征；流量异常。当然，上述只是节点属性的几个示例，对此节点属性不做限制。在图5C中，通过f1、f2、f3、f4表示节点属性的类型，通过x11-x14、x21-x24、x31-x34、x41-x44、x51-x54、x61-x64表示节点属性的值，如x11的取值为1，表示主机21属于目标泄露路径，x21的取值为1，表示主机22属于目标泄露路径，x41的取值为0，表示主机24不属于目标泄露路径，以此类推。可以将已标记候选主机和节点属性的背景流量图称为数据流转图谱，数据流转图谱也称为多媒体数据流转图谱，该数据流转图谱可以参见图5C所示。步骤408、将该数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。示例性的，图异常检测模型可以是基于图学习的自编码器，也可以是其它类型的网络模型，对此图异常检测模型不做限制。其中，自编码器是一种无监督式学习模型，基于反向传播算法与最优化方法，利用输入数据X本身作为监督，来指导模型尝试学习一个映射关系，从而得到一个重构输出XR。在时间序列异常检测场景下，异常对于正常来说是少数，如果使用自编码器重构的输出XR与输入数据X的差异超出一定阈值，则原始时间序列存在异常。此外，图学习是指在图上的机器学习，将图的特征映射到嵌入空间中具有相同维度的特征向量，可以直接将图数据转化为图学习架构的输出，而无需将图映射到低维空间。深度学习技术可以将图数据编码并表示成向量，图学习的输出向量是在连续空间中，其目标是提取图的理想特征。以图异常检测模型是自编码器为例，图异常检测模型可以包括编码器和解码器，对此图异常检测模型的训练过程不做限制。基于已训练的图异常检测模型，可以将数据流转图谱输入给编码器，通过编码器将数据流转图谱转换为隐层特征，也可以称为中间特征。然后，将该隐层特征输入给解码器，通过解码器基于该隐层特征对数据流转图谱的邻接矩阵和特征矩阵进行重建，以得到邻接矩阵对应的邻接重建矩阵和特征矩阵对应的特征重建矩阵。比如说，数据流转图谱包括内网各主机之间的拓扑关系、目标泄露路径、目标泄露路径经过的各候选主机，这些信息反映数据流转图谱的拓扑结构，因此，可以通过图异常检测模型将数据流转图谱的拓扑结构转换为向量，将该向量称为数据流转图谱的邻接矩阵，邻接矩阵用于表示数据流转图谱的拓扑结构。数据流转图谱还包括每个候选主机对应的节点属性、每个非候选主机对应的节点属性，这些信息反映数据流转图谱内的每个主机的节点属性，因此，可以通过图异常检测模型将数据流转图谱的节点属性转换为向量，将该向量称为数据流转图谱的特征矩阵，特征矩阵用于表示数据流转图谱内的每个主机的节点属性，如每个候选主机的节点属性和每个非候选主机对应的节点属性。在将该隐层特征输入给解码器之后，可以通过解码器对该隐层特征进行处理，从而得到邻接矩阵对应的邻接重建矩阵和特征矩阵对应的特征重建矩阵。基于邻接重建矩阵与邻接矩阵的差值、特征重建矩阵与特征矩阵的差值，确定每个候选主机对应的异常分数。比如说，假设目标泄露路径为主机23-主机22-主机21，即主机23、主机22、主机21作为候选主机，那么，邻接重建矩阵包括主机21的邻接重建值，邻接矩阵包括主机21的邻接值，可以计算邻接重建值与邻接值的差值，特征重建矩阵包括主机21的特征重建值，特征矩阵包括主机21的特征值，可以计算特征重建值与特征值的差值，基于上述两个差值确定主机21对应的异常分数。显然，若这两个差值的和越大，则表示重建误差越大，这个主机21对应的异常分数越大，即主机21是异常节点的概率越大。同理，可以确定主机22对应的异常分数、主机23对应的异常分数。在得到每个候选主机对应的异常分数之后，可以将异常分数最大的候选主机作为异常主机。或者，基于每个候选主机对应的异常分数，若候选主机对应的异常分数大于预设分数阈值，则将该候选主机作为异常主机，若候选主机对应的异常分数不大于预设分数阈值，则不将该候选主机作为异常主机。综上所述，可以基于数据流转图谱进行内网异常主机的判定，结合目标泄露路径在背景流量图中的网络结构和节点属性，进行内网异常主机检测。为了发现明显偏离正常主机的异常主机，利用基于图学习算法的异常检测，输入网络结构和节点属性，基于自编码器构建模型，使用编码器学习网络结构和节点属性的隐含特征，再使用解码器重构网络结构和节点属性，最后利用网络结构和节点属性的重构误差来度量网络中的异常，基于异常值确定内网异常主机。在上述过程中，将与数据泄露事件关联的数据传输事件聚合，绘制数据流转图谱，基于数据流转图谱检测数据泄露事件的内网异常主机，根据网络结构和节点属性自适应地推断异常主机，定位整个数据泄露流转路径上的异常主机。基于与上述方法同样的申请构思，本申请实施例中提出一种多媒体数据泄露溯源检测装置，参见图6所示，为所述装置的结构示意图，所述装置包括：确定模块61，用于从所有多媒体数据流中确定出泄露数据流和所述泄露数据流对应的关联数据流；其中，所述泄露数据流是从内网主机到外网的数据流，所述关联数据流是从内网主机到内网主机的数据流，且所述泄露数据流的流量特征与所述关联数据流的流量特征满足相似度条件；生成模块62，用于确定所述泄露数据流对应的目标泄露路径，基于背景流量图和所述目标泄露路径生成数据流转图谱；其中，所述背景流量图包括内网各主机之间的拓扑关系，所述目标泄露路径包括所述关联数据流和所述泄露数据流经过的多个候选主机；其中，在所述背景流量图标记所述多个候选主机，并在所述背景流量图标记每个候选主机对应的节点属性，得到所述数据流转图谱；处理模块63，用于将数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数，基于每个候选主机对应的异常分数确定异常主机。示例性的，所述确定模块61，还用于针对已获取的每个第一网络流量，确定第一网络流量对应的第二网络流量，所述第二网络流量的目的地址与第一网络流量的源地址相同，且所述第二网络流量的源地址与第一网络流量的目的地址相同；若所述第一网络流量对应的字节数与所述第二网络流量对应的字节数的差值的绝对值大于第一阈值，则将所述第一网络流量确定为多媒体数据流。示例性的，所述确定模块61从所有多媒体数据流中确定出泄露数据流时具体用于：针对每个多媒体数据流，若该多媒体数据流的源地址位于已配置的地址段，所述地址段包括内网所有主机的地址，且该多媒体数据流的目的地址不位于所述地址段，则确定该多媒体数据流是泄露数据流；若该多媒体数据流的源地址位于所述地址段，且该多媒体数据流的目的地址位于所述地址段，则确定该多媒体数据流是候选数据流。示例性的，所述确定模块61从所有多媒体数据流中确定出泄露数据流对应的关联数据流时具体用于：针对每个泄露数据流，基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流；其中，流量特征包括获取时间和字节数；该关联数据流的获取时间与该泄露数据流的获取时间的差值的绝对值小于第二阈值，该关联数据流的字节数与该泄露数据流的字节数的差值的绝对值小于第三阈值。示例性的，所述确定模块61基于该泄露数据流的流量特征和各候选数据流的流量特征，从所有候选数据流中选取该泄露数据流对应的关联数据流时具体用于：计算该泄露数据流的流量特征与各候选数据流的流量特征之间的相似度；基于所述相似度，采用聚类算法确定以该泄露数据流为聚类中心的聚类集合，其中，所述聚类集合包括该泄露数据流对应的关联数据流，且该泄露数据流的流量特征与关联数据流的流量特征之间的相似度满足相似度条件；其中，若所述相似度为欧式距离，则满足相似度条件是指：该泄露数据流的流量特征与关联数据流的流量特征之间的欧式距离小于预设距离阈值。示例性的，所述生成模块62确定所述泄露数据流对应的目标泄露路径时具体用于：从所述泄露数据流对应的所有关联数据流中选取目标关联数据流；其中，所述目标关联数据流的获取时间早于所述泄露数据流的获取时间；基于所述泄露数据流的源地址、所述目标关联数据流的源地址和目的地址确定数据流排列顺序；前一个目标关联数据流的目的地址是后一个目标关联数据流的源地址，最后一个目标关联数据流的目的地址是所述泄露数据流的源地址；基于所述数据流排列顺序确定所述泄露数据流对应的目标泄露路径。示例性的，所述处理模块63将数据流转图谱输入给已训练的图异常检测模型，得到每个候选主机对应的异常分数时具体用于：若所述异常检测模型包括编码器和解码器，则将所述数据流转图谱输入给所述编码器，通过所述编码器将所述数据流转图谱转换为隐层特征；将所述隐层特征输入给所述解码器，通过所述解码器基于所述隐层特征对所述数据流转图谱的邻接矩阵和特征矩阵进行重建，得到邻接重建矩阵和特征重建矩阵；其中，所述邻接矩阵表示所述数据流转图谱的拓扑结构，所述特征矩阵表示所述数据流转图谱内的每个候选主机的节点属性；基于所述邻接重建矩阵与所述邻接矩阵的差值、所述特征重建矩阵与所述特征矩阵的差值，确定每个候选主机对应的异常分数。基于与上述方法同样的申请构思，本申请实施例提出一种电子设备，参见图7所示，电子设备包括处理器71和机器可读存储介质72，机器可读存储介质72存储有能够被处理器71执行的机器可执行指令；其中，处理器71用于执行机器可执行指令，以实现上述多媒体数据泄露溯源检测方法。基于与上述方法同样的申请构思，本申请实施例还提供一种机器可读存储介质，机器可读存储介质上存储有若干计算机指令，计算机指令被处理器执行时，能够实现上述示例的多媒体数据泄露溯源检测方法。其中，上述机器可读存储介质可以是任何电子、磁性、光学或其它物理存储装置，可以包含或存储信息，如可执行指令、数据，等等。例如，机器可读存储介质可以是：RAM、易失存储器、非易失性存储器、闪存、存储驱动器、固态硬盘、任何类型的存储盘，或者类似的存储介质，或者它们的组合。上述实施例阐明的系统、装置、模块或单元，具体可以由计算机实体实现，或者由具有某种功能的产品来实现。一种典型的实现设备为计算机，计算机的具体形式可以是个人计算机、膝上型计算机、蜂窝电话、相机电话、智能电话、个人数字助理、媒体播放器、导航设备、电子邮件收发设备、游戏控制台、平板计算机、可穿戴设备或者这些设备中的任意几种设备的组合。为了描述的方便，描述以上装置时以功能分为各种单元分别描述。当然，在实施本申请时可以把各单元的功能在同一个或多个软件和/或硬件中实现。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请实施例可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可以由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其它可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其它可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。而且，这些计算机程序指令也可以存储在能引导计算机或其它可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或者多个流程和/或方框图一个方框或者多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其它可编程数据处理设备上，使得在计算机或者其它可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其它可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。以上所述仅为本申请的实施例而已，并不用于限制本申请。对于本领域技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原理之内所作的任何修改、等同替换、改进等，均应包含在本申请的权利要求范围之内。
