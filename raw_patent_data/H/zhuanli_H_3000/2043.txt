标题title
基于动态时分双工通信的自回程毫米波蜂窝网络通信方法
摘要abst
本发明公开了一种基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，包括获取目标网络的网络参数数据信息；构建自回程毫米波蜂窝网络通信模型；构建求解模型；对基于求解模型的自回程毫米波蜂窝网络通信模型进行训练和求解；目标网络根据求解结果进行通信；实时重复以上步骤完成基于动态时分双工通信的自回程毫米波蜂窝网络通信。本发明能够较为准确地估算该类通信场景下可能存在的互干扰，能够为每个小基站的上下行通信的接入与回程链路分配合适的发送时间和发射功率，并能合理关联并调度用户接入网络以保障每个用户享受网络服务的公平性；而且本发明的可靠性高、效率较高且网络资源利用率高。
权利要求书clms
1.一种基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，包括如下步骤：S1.获取目标网络的网络参数数据信息；S2.根据步骤S1获取的数据信息，以网络总速率为优化目标，以网络吞吐量、传输时间、网络传输功率、网络节点连接数和网络速度为约束条件，构建自回程毫米波蜂窝网络通信模型；S3.基于CTDE架构和神经网络架构，构建求解模型；S4.对基于求解模型的自回程毫米波蜂窝网络通信模型进行训练和求解；S5.目标网络根据步骤S4得到的求解结果进行通信；S6.实时重复步骤S1～S5，完成基于动态时分双工通信的自回程毫米波蜂窝网络通信。2.根据权利要求1所述的基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，其特征在于步骤S1所述的获取目标网络的网络参数数据信息，具体包括如下步骤：目标网络为一个带无线自回程的毫米波异构蜂窝网络；所述网络包括一个宏蜂窝和N个小蜂窝；宏基站MBS作为宏蜂窝内所有小基站SBS的带内无线回程连接至核心网的枢纽；宏基站MBS用符号m0表示，宏基站范围内的所有小基站SBS用集合M-＝{1,2,...,N}表示；集合M＝M-∪{m0}表示所有基站，且集合元素个数为N+1；宏基站MBS范围内的所有用户设备UE表示为用户设备UE仅选择小基站SBS作为关联基站，并将数据通过小基站SBS中继到宏基站MBS从而进入核心网，或者接收小基站SBS从宏基站MBS转发的数据；设定宏基站MBS、小基站SBS和用户设备UE均同时配备了毫米波频段和sub-6GHz频段的无线接口，其中毫米波频段用于数据传输，sub-6GHz频段用于控制信息交换；设定每个小基站SBS均配备了Qsbs个毫米波天线，以便具有与最多Qsbs个用户设备UE同时连接的能力；每个用户设备UE仅配备一根毫米波天线来连接最多一个小基站SBS；宏基站MBS配备了足够多的毫米波天线以保证自身能够同时向所有小基站SBS发送数据，或者同时从所有小基站SBS接收数据；设定每个小基站SBS的上下行数据到达过程遵守泊松分布；每个小基站SBS需要为自身的每一个关联的用户设备维护一个DL缓冲区，来满足用户设备的下行流量缓存需求；同时，每一个用户设备均设置一个UL缓冲区，来满足自身的上行流量的缓存需求；设定任何时刻，针对每个小基站都至少有Qsbs个用户设备的DL缓冲区和UL缓冲区非空，以保证上下行通信行到处于非空闲状态；采用分时长期演进方案，通过配置DL子帧和UL子帧的比例来适应不对称的上下行流量需求；一个通信帧包括7种无线帧配置，每帧长度为10ms，由10个连续的帧长的1ms的子帧组成；每个子帧有三种类型，U子帧、D子帧和S子帧，其中U子帧表示UL流量，D子帧表示DL流量，S子帧表示从D子帧到U子帧的转换子帧；将S子帧视为D子帧；根据无线频谱的使用模式，采用带内传输模式进行传输，接入链路和回程链路共享相同的频谱资源；采用扇形天线模型进行夹角的计算；仅对接入链路的发射功率进行调节，并认定回程链路的发射功率为固定值。3.根据权利要求2所述的基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，其特征在于步骤S2所述的根据步骤S1获取的数据信息，以网络总速率为优化目标，以网络吞吐量、传输时间、网络传输功率、网络节点连接数和网络速度为约束条件，构建自回程毫米波蜂窝网络通信模型，具体包括如下步骤：采用如下算式构建优化目标：式中Xt为第t个子帧期间的用户设备关联情况，且表示第t个子帧期间第u个用户设备与第n个小基站互相关联，/＞表示第t个子帧期间第u个用户设备与第n个小基站无关联；Γ为任意小基站在第t个子帧归一化后的RA/BH段传输持续时间/＞的取值集合，且Z为每个子帧的时隙数；PUE为第i个用户设备在第t个子帧期间分配给接收节点j的发射功率/＞的取值集合，且/＞L为设定的正整数，/＞为用户设备的最大功率；PBS为第i个小基站在第t个子帧期间分配给接收节点j的发射功率/＞的取值集合，且/＞K为设定的正整数，/＞为小基站的最大功率；Tt为目标网络在第i个子帧期间的总速率，且表示第n个小基站的第t个子帧类型为上行子帧，/＞表示第n个小基站的第t个子帧类型为下行子帧，/＞为属于集合/＞的第n个小基站在第t个子帧期间的UL接入数据率，集合/＞为第t个子帧的类型为U子帧的小基站集合，/＞为第n个小基站的索引，/＞为集合/＞中的第i个元素，/＞为将与N个小基站所对应的RA/BH段传输持续时间序列Ωt中元素按升序排列后的集合，Ωt表示为/＞表示为/＞为N个小基站中在第t个子帧期间最小的RA/BH段传输持续时间，/＞为N个小基站中在第t个子帧期间最大的RA/BH段传输持续时间，/＞为第u个用户设备与第n个小基站之间的UL接入链路能够达到的数据速率，/＞W为毫米波频段的带宽，/＞为第u个用户设备与第n个小基站之间的UL接入链路的信号干扰噪声比，N0为毫米波频段的背景噪声功率密度，/＞为第u个用户设备在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，发射波束/＞为从第u个用户设备到第n个小基站的发射波束，接收波束/＞为从第u个用户设备到第n个小基站的接收波束，为发射波束/＞的波束宽度，z为旁瓣增益，/＞为发射波束/＞的波束中心线与第u个用户设备到第n个小基站视距方向之间的夹角，/＞为从第u个用户设备到第n个小基站的信道增益，B为参数为x的伯努利随机变量，/＞为LoS链路的概率，/＞ρLoS为平均LoS距离，du,n为第u个用户设备到第n个小基站的距离，/＞为LoS链路损耗，/＞d0为自由空间参考距离，α为损失指数参数，Xσ为服从均值为0、标准差为σ的高斯随机变量，/＞为第u个用户设备到第n个小基站的LoS距离，PL为载波频率f的函数且c为光速，/＞为NLoS链路损耗，/＞为第u个用户设备到第n个小基站的NLoS距离，/＞为NLoS链路的概率，/＞ρNLoS为平均NLoS距离，/＞为接收波束/＞对发射波束/＞的接收增益，为接收波束/＞的波束带宽，/＞为接收波束/＞的波束中心线与第u个用户设备到第n个小基站视距方向之间的夹角，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自UL接入链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自UL回程链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自DL回程链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自DL接入链路的干扰，n为第n个小基站，/＞为在期间处于U_RA时期的小基站集合，u为第u个用户设备，U{u}表示用户设备集合U剔除掉第u个用户设备后的集合，/＞为第t个子帧期间第u个用户设备与第n个小基站之间的关联变量，/＞为第u个用户设备在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，为在/＞期间处于U_BH时期的小基站集合，/＞为在第t个子帧期间第n个小基站分配给宏基站m0的发射功率，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为在期间处于D_BH时期的小基站集合，/＞为在第t个子帧期间宏基站分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为宏基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，为在/＞期间处于D_RA时期的小基站集合，/＞为在第t个子帧期间第n个小基站分配给第u个用户设备的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为属于集合/＞的第n个小基站在第t个子帧期间的DL回程数据率，集合/＞为第t个子帧的类型为D子帧的小基站集合，/＞为宏基站与第n个小基站之间的DL回程链路的数据速率，/＞为宏基站与第n个小基站之间DL回程链路信号干扰噪声比，为宏基站在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，为从宏基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自UL接入链路的干扰，为宏基站与第n个小基站的DL回程链路所遭受到的来自UL回程链路的干扰，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自DL回程链路的干扰，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自DL接入链路的干扰，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益；采用如下算式构建约束条件：约束条件1：约束条件2：约束条件3：约束条件4：约束条件5：约束条件6：约束条件7：式中为第u个用户设备在调度时刻t结束并更新后的平均传输速率，tf为在当前调度时刻之前需要参考的时隙数量，1{UL}表示第n个小基站的第t-1个子帧的类型为上行子帧，1{DL}表示第n个小基站的第t-1个子帧的类型为下行子帧，/＞为第t个子帧期间第u个用户设备的上行吞吐量，/＞为第t个子帧期间第u个用户设备的下行吞吐量，Tth为设定的吞吐量阈值，/＞为在第t个子帧期间第n个小基站分配给第u个用户设备的发射功率，为在第t个子帧期间第u个用户设备分配给第n个小基站的发射功率，/＞为属于集合/＞的第n个小基站在第t个子帧期间的回程数据率，/＞为第n个小基站与宏基站之间的UL回程链路能够达到的数据速率，为第n个小基站与宏基站之间的UL回程链路的信号干扰噪声比，/＞为第n个小基站在第t个子帧期间分配给宏基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到宏基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自UL回程链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自DL回程链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自DL接入链路的干扰，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到宏基站的信道增益，为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到宏基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，ξ为自干扰消除因子，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从宏基站到宏基站的信道增益，为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为属于集合/＞的第n个小基站在第t个子帧期间的接入数据率，为第n个小基站与第u个用户设备之间的DL接入链路能够达到的数据速率，/＞为第n个小基站与第u个用户设备之间的DL接入链路的信号干扰噪声比，为第n个小基站在第t个子帧期间分配给第u个用户设备的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，为从第n个小基站到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为第n个小基站与第u个用户设备之间的DL接入链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的UL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的DL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的DL接入链路所遭受到的来自UL接入链路的干扰，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束的发射增益，/＞为从宏基站到第u个用户设备的信道增益，/＞为接收波束对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益。4.根据权利要求3所述的基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，其特征在于所述的步骤S2，具体还包括如下步骤：在期间，当1≤i≤N：若小基站的在第t个子帧期间的子帧类型为U子帧，则采用如下方式进行更新：若小基站的在第t个子帧期间的子帧类型为D子帧，则采用如下方式进行更新：采用为每个用户设备定义PF优先级，Ru为第u个用户设备在调度时刻t时能够达到的瞬时传输速率，/＞为第u个用户设备在调度时刻t之前设定时间段内的平均传输速率；采用长期平均干扰来估算SINR值，从而得到瞬时传输速率；定义第u个用户设备在调度时刻t的SINR值为：式中为第u个用户设备在调度时刻t之前的长期平均干扰，且计算式为最后，得到如下算式对PFu'进行修正，得到修正后的PF值PFu为：在每次调度时刻t，每个小基站选取PFu值最大的Qsbs个用户设备进行关联：针对上行子帧，选择PFu值最大的Qsbs个上行发送用户设备，对于下行子帧，选择PFu值最大的Qsbs个下行接收用户设备。5.根据权利要求4所述的基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，其特征在于步骤S3所述的基于CTDE架构和神经网络架构，构建求解模型，具体包括如下步骤：采用元组g＝＜N,S,A,Z,P,r,γ＞描述多智能体强化学习的环境；N＝{1,2,...,N}表示所有智能体的集合，s∈S表示环境的全局状态信息，在时间t，每个智能体n∈N同时选择一个动作所有智能体选择的行动构成联合行动/＞在执行联合动作at后，下一个时间状态st+1产生于状态转移方程P:S×AN×S→；最后，每一个智能体都会收到奖励/＞S×AN→R；每个智能体n∈N得到一个单独的局部观察且不能得到整个全局状态st；所有智能体部分观察构成联合观测/＞智能体的部分观察和行动的历史由表示；所有智能体历史集合由/＞表示；每个智能体n∈N选择动作时都使用一个仅基于该智能体个人历史/＞的去中心化策略/＞智能体们的目的在于学习一个联合策略/＞最大化对应的期望折扣回报/＞其中γ∈本发明属于通信技术领域，具体涉及一种基于动态时分双工通信的自回程毫米波蜂窝网络通信方法。背景技术随着经济技术的发展和人们生活水平的提高，无线通信技术已经广泛应用于人们的生产和生活当中。未来的无线和移动网络服务必须适应高度动态的下行和上行流量不对称场景。为此，第三代合作伙伴项目引入了动态时分双工来满足动态的流量需求。动态TDD通过自适应无线电帧配置来改变每个小蜂窝覆盖区下行链路和上行链路所用的时间之比，即上下行子帧配置，以增强对上下行流量变化的适应性。对于孤立的蜂窝覆盖区，动态TDD确实能够很好地适应流量变化。然而，针对宏蜂窝中部署的若干小蜂窝覆盖区，动态TDD的使用可能导致相邻小蜂窝覆盖区中共享同一频段资源的上行和下行链路之间的传输时间存在部分重叠。于是，除了相邻小蜂窝覆盖区之间同向链路可能互相干扰外，该方案也可能导致交叉链路干扰，即非同向链路之间的互相干扰。自适应RFC机制带来的益处可能会因为严重的CLI而被抵消。若规定每个小蜂窝覆盖区都使用相同的RFC，则虽然可避免CLI，但也可能难以使得各个小蜂窝完美匹配各自上下行流量变化。有研究开发了一种基于深度强化学习的动态TDD框架，可根据上下行业务流量情况给每个小蜂窝分配相适应的RFC以满足各种流量需求，在提升时域资源利用效率的同时有效地控制了CLI的负面影响。然而，该方案无法应用到蜂窝网的无线自回程的场景。异构超密集网络的部署能显著提升网络的频谱效率和能源效率。在宏蜂窝中重叠部署异构小蜂窝成为营运商提升网络容量的一种有效手段。在异构蜂窝部署实施过程中，必须为每个小蜂窝解决回程链路设置问题以便实现与骨干网联通。尽管光纤通信介质是回程链路的理想选择，但小蜂窝的数量庞大以及受基站部署环境限制，并非每个小蜂窝都适合配置光纤回程链路。因此，无线回程链路，特别是大容量的毫米波无线回程链路成为光纤回程链路的理想替代。考虑到频段的有效利用，3GPP提出集成接入与回程方案，允许每个小蜂窝的接入与回程链路以时分复用模式共享同一频段资源，于是产生了无线自回程场景。但是，现有基于IAB的方案并非针对动态TDD通信场景设计，其多数实际应用场景存在双向上下行流量。因此，无论是仅考虑上行还是下行通信场景的通信方案，都难以应用在此类实际应用场景中。发明内容本发明的目的在于提供一种可靠性高、效率较高且网络资源利用率高的基于动态时分双工通信的自回程毫米波蜂窝网络通信方法。本发明提供的这种基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，包括如下步骤：S1.获取目标网络的网络参数数据信息；S2.根据步骤S1获取的数据信息，以网络总速率为优化目标，以网络吞吐量、传输时间、网络传输功率、网络节点连接数和网络速度为约束条件，构建自回程毫米波蜂窝网络通信模型；S3.基于CTDE架构和神经网络架构，构建求解模型；S4.对基于求解模型的自回程毫米波蜂窝网络通信模型进行训练和求解；S5.目标网络根据步骤S4得到的求解结果进行通信；S6.实时重复步骤S1～S5，完成基于动态时分双工通信的自回程毫米波蜂窝网络通信。步骤S1所述的获取目标网络的网络参数数据信息，具体包括如下步骤：目标网络为一个带无线自回程的毫米波异构蜂窝网络；所述网络包括一个宏蜂窝和N个小蜂窝；宏基站MBS作为宏蜂窝内所有小基站SBS的带内无线回程连接至核心网的枢纽；宏基站MBS用符号m0表示，宏基站范围内的所有小基站SBS用集合M-＝{1,2,...,N}表示；集合M＝M-∪{m0}表示所有基站，且集合元素个数为N+1；宏基站MBS范围内的所有用户设备UE表示为用户设备UE仅选择小基站SBS作为关联基站，并将数据通过小基站SBS中继到宏基站MBS从而进入核心网，或者接收小基站SBS从宏基站MBS转发的数据；设定宏基站MBS、小基站SBS和用户设备UE均同时配备了毫米波频段和sub-6GHz频段的无线接口，其中毫米波频段用于数据传输，sub-6GHz频段用于控制信息交换；设定每个小基站SBS均配备了Qsbs个毫米波天线，以便具有与最多Qsbs个用户设备UE同时连接的能力；每个用户设备UE仅配备一根毫米波天线来连接最多一个小基站SBS；宏基站MBS配备了足够多的毫米波天线以保证自身能够同时向所有小基站SBS发送数据，或者同时从所有小基站SBS接收数据；设定每个小基站SBS的上下行数据到达过程遵守泊松分布；每个小基站SBS需要为自身的每一个关联的用户设备维护一个DL缓冲区，来满足用户设备的下行流量缓存需求；同时，每一个用户设备均设置一个UL缓冲区，来满足自身的上行流量的缓存需求；设定任何时刻，针对每个小基站都至少有Qsbs个用户设备的DL缓冲区和UL缓冲区非空，以保证上下行通信行到处于非空闲状态；采用分时长期演进方案，通过配置DL子帧和UL子帧的比例来适应不对称的上下行流量需求；一个通信帧包括7种无线帧配置，每帧长度为10ms，由10个连续的帧长的1ms的子帧组成；每个子帧有三种类型，U子帧、D子帧和S子帧，其中U子帧表示UL流量，D子帧表示DL流量，S子帧表示从D子帧到U子帧的转换子帧；将S子帧视为D子帧；根据无线频谱的使用模式，采用带内传输模式进行传输，即接入链路和回程链路共享相同的频谱资源；采用扇形天线模型进行夹角的计算；仅对接入链路的发射功率进行调节，并认定回程链路的发射功率为固定值。步骤S2所述的根据步骤S1获取的数据信息，以网络总速率为优化目标，以网络吞吐量、传输时间、网络传输功率、网络节点连接数和网络速度为约束条件，构建自回程毫米波蜂窝网络通信模型，具体包括如下步骤：采用如下算式构建优化目标：式中Xt为第t个子帧期间的用户设备关联情况，且表示第t个子帧期间第u个用户设备与第n个小基站互相关联，/＞表示第t个子帧期间第u个用户设备与第n个小基站无关联；Γ为任意小基站在第t个子帧归一化后的RA/BH段传输持续时间/＞的取值集合，且Z为每个子帧的时隙数；PUE为第i个用户设备在第t个子帧期间分配给接收节点j的发射功率/＞的取值集合，且/＞L为设定的正整数，/＞为用户设备的最大功率；PBS为第i个小基站在第t个子帧期间分配给接收节点j的发射功率/＞的取值集合，且/＞K为设定的正整数，/＞为小基站的最大功率；Tt为目标网络在第i个子帧期间的总速率，且表示第n个小基站的第t个子帧类型为上行子帧，/＞表示第n个小基站的第t个子帧类型为下行子帧，/＞为属于集合/＞的第n个小基站在第t个子帧期间的UL接入数据率，集合/＞为第t个子帧的类型为U子帧的小基站集合，/＞为第n个小基站的索引，/＞为集合/＞中的第i个元素，/＞为将与N个小基站所对应的RA/BH段传输持续时间序列Ωt中元素按升序排列后的集合，Ωt表示为/＞表示为/＞为N个小基站中在第t个子帧期间最小的RA/BH段传输持续时间，/＞为N个小基站中在第t个子帧期间最大的RA/BH段传输持续时间，/＞为第u个用户设备与第n个小基站之间的UL接入链路能够达到的数据速率，/＞W为毫米波频段的带宽，/＞为第u个用户设备与第n个小基站之间的UL接入链路的信号干扰噪声比，N0为毫米波频段的背景噪声功率密度，/＞为第u个用户设备在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，发射波束/＞为从第u个用户设备到第n个小基站的发射波束，接收波束/＞为从第u个用户设备到第n个小基站的接收波束，为发射波束/＞的波束宽度，z为旁瓣增益，/＞为发射波束/＞的波束中心线与第u个用户设备到第n个小基站视距方向之间的夹角，/＞为从第u个用户设备到第n个小基站的信道增益，B为参数为x的伯努利随机变量，/＞为LoS链路的概率，/＞ρLoS为平均LoS距离，du,n为第u个用户设备到第n个小基站的距离，/＞为LoS链路损耗，/＞d0为自由空间参考距离，α为损失指数参数，Xσ为服从均值为0、标准差为σ的高斯随机变量，/＞为第u个用户设备到第n个小基站的LoS距离，PL为载波频率f的函数且c为光速，/＞为NLoS链路损耗，/＞为第u个用户设备到第n个小基站的NLoS距离，/＞为NLoS链路的概率，/＞ρNLoS为平均NLoS距离，/＞为接收波束/＞对发射波束/＞的接收增益，为接收波束/＞的波束带宽，/＞为接收波束/＞的波束中心线与第u个用户设备到第n个小基站视距方向之间的夹角，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自UL接入链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自UL回程链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自DL回程链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自DL接入链路的干扰，n为第n个小基站，/＞为在期间处于U_RA时期的小基站集合，u为第u个用户设备，U{u}表示用户设备集合U剔除掉第u个用户设备后的集合，/＞为第t个子帧期间第u个用户设备与第n个小基站之间的关联变量，/＞为第u个用户设备在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，为在/＞期间处于U_BH时期的小基站集合，/＞为在第t个子帧期间第n个小基站分配给宏基站m0的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为在/＞期间处于D_BH时期的小基站集合，/＞为在第t个子帧期间宏基站分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为宏基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，为在/＞期间处于D_RA时期的小基站集合，/＞为在第t个子帧期间第n个小基站分配给第u个用户设备的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为属于集合/＞的第n个小基站在第t个子帧期间的DL回程数据率，集合/＞为第t个子帧的类型为D子帧的小基站集合，/＞为宏基站与第n个小基站之间的DL回程链路的数据速率，/＞为宏基站与第n个小基站之间DL回程链路信号干扰噪声比，为宏基站在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，为从宏基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自UL接入链路的干扰，为宏基站与第n个小基站的DL回程链路所遭受到的来自UL回程链路的干扰，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自DL回程链路的干扰，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自DL接入链路的干扰，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益；采用如下算式构建约束条件：约束条件1：约束条件2：约束条件3：约束条件4：约束条件5：约束条件6：约束条件7：式中/＞为第u个用户设备在调度时刻t结束并更新后的平均传输速率，tf为在当前调度时刻之前需要参考的时隙数量，1{UL}表示第n个小基站的第t-1个子帧的类型为上行子帧，1{DL}表示第n个小基站的第t-1个子帧的类型为下行子帧，/＞为第t个子帧期间第u个用户设备的上行吞吐量，/＞为第t个子帧期间第u个用户设备的下行吞吐量，Tth为设定的吞吐量阈值，/＞为在第t个子帧期间第n个小基站分配给第u个用户设备的发射功率，为在第t个子帧期间第u个用户设备分配给第n个小基站的发射功率，/＞为属于集合/＞的第n个小基站在第t个子帧期间的回程数据率，/＞为第n个小基站与宏基站之间的UL回程链路能够达到的数据速率，为第n个小基站与宏基站之间的UL回程链路的信号干扰噪声比，/＞为第n个小基站在第t个子帧期间分配给宏基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到宏基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自UL回程链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自DL回程链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自DL接入链路的干扰，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到宏基站的信道增益，为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到宏基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，ξ为自干扰消除因子，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从宏基站到宏基站的信道增益，为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为属于集合/＞的第n个小基站在第t个子帧期间的接入数据率，为第n个小基站与第u个用户设备之间的DL接入链路能够达到的数据速率，/＞为第n个小基站与第u个用户设备之间的DL接入链路的信号干扰噪声比，为第n个小基站在第t个子帧期间分配给第u个用户设备的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，为从第n个小基站到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为第n个小基站与第u个用户设备之间的DL接入链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的UL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的DL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的DL接入链路所遭受到的来自UL接入链路的干扰，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束的发射增益，/＞为从宏基站到第u个用户设备的信道增益，/＞为接收波束对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益。所述的步骤S2，具体还包括如下步骤：在期间，当1≤i≤N：若小基站的在第t个子帧期间的子帧类型为U子帧，则采用如下方式进行更新：若小基站的在第t个子帧期间的子帧类型为D子帧，则采用如下方式进行更新：采用为每个用户设备定义PF优先级，Ru为第u个用户设备在调度时刻t时能够达到的瞬时传输速率，/＞为第u个用户设备在调度时刻t之前设定时间段内的平均传输速率；采用长期平均干扰来估算SINR值，从而得到瞬时传输速率；定义第u个用户设备在调度时刻t的SINR值为：式中为第u个用户设备在调度时刻t之前的长期平均干扰，且计算式为最后，得到如下算式对PFu'进行修正，得到修正后的PF值PFu为：在每次调度时刻t，每个小基站选取PFu值最大的Qsbs个用户设备进行关联：针对上行子帧，选择PFu值最大的Qsbs个上行发送用户设备，对于下行子帧，选择PFu值最大的Qsbs个下行接收用户设备。步骤S3所述的基于CTDE架构和神经网络架构，构建求解模型，具体包括如下步骤：采用元组g＝＜N,S,A,Z,P,r,γ＞描述多智能体强化学习的环境；N＝{1,2,...,N}表示所有智能体的集合，s∈S表示环境的全局状态信息，在时间t，每个智能体n∈N同时选择一个动作所有智能体选择的行动构成联合行动/＞在执行联合动作at后，下一个时间状态st+1产生于状态转移方程P:S×AN×S→；最后，每一个智能体都会收到奖励/＞每个智能体n∈N得到一个单独的局部观察且不能得到整个全局状态st；所有智能体部分观察构成联合观测/＞智能体的部分观察和行动的历史由/＞表示；所有智能体历史集合由/＞表示；每个智能体n∈N选择动作时都使用一个仅基于该智能体个人历史/＞的去中心化策略/＞智能体们的目的在于学习一个联合策略/＞最大化对应的期望折扣回报/＞其中γ∈对步骤S2构建的模型进行建模时，关注若干个关键要素；所述的关键要素包括局部观察空间以及全局状态空间、动作空间和即时奖励：局部观察空间以及全局状态空间：将小基站作为智能体，智能体之间没有信息交换；用Un表示位于第n个小基站范围内的用户设备集合；第n个小基站在第t子帧时刻的局部状态表示为：/＞式中表示第n个小基站的第t个子帧的类型，若当前子帧为上行子帧则否则/＞为第n个小基站在第t-1个子帧时期的RA/BH段持续传输时间，且当t＝1时/＞为第n个小基站在第t-1个子帧时期的总速率，且当t＝1时为第n个小基站在第t个子帧时期所关联的用户设备的ID，且为第u个用户设备在第t个子帧时期的三维位置坐标信息；/＞为第u个用户设备在第t个子帧时期的PF值，且当t＝1时/＞为第u个用户设备在第t-1个子帧时期的速率，且当t＝1或/＞时/＞为第t-1个子帧时期的接入发射功率，当第t-1个子帧为上行子帧时/＞表示第u个用户设备向第n个小基站的上行接入发射功率，当第t-1个子帧为下行子帧时/＞表示第n个小基站向第u个用户设备的下行接入发射功率，且当t＝1或/＞时/＞第i个子帧时期的全局状态空间st为所有智能体局部状态的集合，并表示为/＞动作空间：在第t个子帧时，第n个小基站根据用户关联状态得到自身所关联的用户集合然后根据当前策略πn及对应的局部观察/＞第n个小基站从自身的动作空间中选择一个动作；第n个小基站在第t个子帧时刻的动作/＞表示为第n个小基站根据自身的第t个子帧的类型决定功率的发射方向与RA/BH段的持续传输时间：当第n个小基站的第t个子帧为上行帧时，给第n个小基站所关联的上行传输用户设备分配向小基站传输的上行接入发射功率，此时同时给第n个小基站分配RA段的持续传输时间；当第n个小基站的第t个子帧为下行帧时，给第n个小基站分配向其所关联的下行用户设备发送数据的下行接入发射功率，此时/＞同时给第n个小基站分配BH段的持续传输时间。即时奖励：当所有小基站采取联合动作时，所有小基站都会获取一个奖励；将第n个小基站的即时奖励描述为：/＞式中δ1和δ2为设置的权重系数；每个小基站采用独立的策略更新裁剪来学习自身的策略πn；每个小基站基于局部观察学习critic网络式中γ为折扣因子，λ为用于权衡精度与方差的超参数，为t时刻的时间差分误差；每个小基站的策略损失为/＞clip为裁剪函数，若/＞取值位于1-ε与1+ε之间，则该函数取值为/＞若/＞取值小于1-ε，则该函数取值为1-ε；若/＞取值大于1+ε，则该函数取值为1+ε，πθ为新的策略函数，/＞为旧的策略函数；采用裁剪值限制每个小基站的critic网络的更新小于设定值ε：式中φold为更新前的参数，为折扣奖励且/＞以上更新方程将网络的更新限制在设定范围内，从而避免对最近一批数据的过拟合；对于每个小基站，整体学习损失为/＞其中H为策略πn的熵，λcritic和λentropy为设定的权重值；将宏基站作为作为信息收集和集中训练的场所；集中式critic网络采用全局信息st作出评估，分布式actor网络仅采用局部状态信息/＞作出决策；θn为第n个小基站的acter网络参数；每个小基站的策略损失函数表示为：/＞第n个小基站的actor网络参数θn，通过策略梯度更新：式中为采样期望函数；集中式critic网络表示为/＞并描述为状态价值函数，其中φn为第n个小基站的critic网络参数；通过最小化以下损失函数来更新φn：其中为折扣奖励且/＞门控制循环单元：门控制循环单元包括更新门和复位门；在时刻t，更新状态信息为先前状态信息信息ht-1和当前候选状态信息的线性插值，表示为/＞其中zt为更新门，⊙为Hadamard乘积符号；zt的值越大，则保留先前状态的信息越多；zt的更新公式为zt＝σ，其中xt为时刻t的输入向量，σ为Sigmoid函数，Wz、Uz和bz为神经网络的参数；/＞的更新公式为式中Wh、Uh和bh为神经网络参数，rt为复位门，且更新公式为rt＝σ，Wr、Ur和br为神经网络的参数；多头注意力机制：在critic网络的多层感知器前插入多头注意力单元；critic网络函数的表达式为/＞其中fn为两层MLP，/＞为嵌入函数且由一层MLP组成，xn为除第n个小基站外的其他小基站的贡献值，且计算公式为n-为n-除第n个小基站外其他所有小基站的集合，为第/＞个小基站的注意力权重，/＞为第/＞个小基站的编码值；的计算过程为：通过嵌入函数/＞对第/＞个小基站的局部观察/＞编码，然后通过左乘矩阵Wv进行线性变换，最后将线性变换结果带入非线性激活函数h得到编码值；注意力权重/＞通过比较嵌入特征en和/＞的相似度得到；通过双线性映射机制，用Wq将en映射为query，用Wk将/＞映射为key，然后将相似度结果传递到softmax层进行归一化；无效动作屏蔽：采用无效工作屏蔽机制，进行无效动作的屏蔽；无效动作屏蔽机制表示为：式中为logits函数，j表示策略网络/＞输出的是第n个小基站的第j个动作的logits，mask为依赖状态的可微函数；M为设定的一个小于设定值值的负数。步骤S4所述的对基于求解模型的自回程毫米波蜂窝网络通信模型进行训练和求解，具体包括如下步骤：训练过程：输入：折扣因子γ，训练时长ε，小批量大小|B|，GAE权重λ，学习率α，最大步长；输出：每个小基站的actor网络模型参数θn；步骤1：初始化actor网络参数θn，critic网络参数φn，经验缓存Dn；步骤2：初始化ε为0；步骤3：初始化当前调度时期t＝0，初始状态s0，以及范围内所用户设备的步骤4：计算集合Un内所有用户设备的PFu；步骤5:根据PFu的大小，从大到小选取前Qsbs个上行或下行用户设备进行用户关联；步骤6：从环境中获得局部观测步骤7：根据actor网络以及局部观测产生动作步骤8：获取其它智能体的局部观测并组成全局状态st并输入到critic网络得到步骤9：所有小基站执行动作后，获得奖励系统转至下一状态st+1；步骤10：计算得到下一调度时刻的集合Un内所有用户设备的以及步骤11：如果t＝T，则跳转至步骤12，否则令t增加1，并跳转至步骤4；步骤12：获取智能体的轨迹以及critic网络的输出值步骤13：计算优势函数并存储样本数据/＞到经验缓存Dn中；步骤14：从经验缓存Dn中随机选取小批量|B|个数据步骤15：计算得到计算得到/＞步骤16：计算梯度并利用Adam优化器更新actor网络；步骤17：计算梯度利用Adam优化器更新critic网络；步骤18：如果e＝ε，则训练完成并输出θn，否则令e增加1，跳转至步骤3；决策过程：输入：第n个小基站的局部观测输出：第n个小基站的动作根据actor网络以及局部观测直接输出动作本发明公开的这种基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，针对动态TDD通信场景下联合接入与回程资源分配问题，提出了一组新的互干扰估算公式，能够较为准确地估算该类通信场景下可能存在的互干扰；同时提出了一种链路数据率估算方案和资源分配方法，能够为每个小基站的上下行通信的接入与回程链路分配合适的发送时间和发射功率，并能合理关联并调度用户接入网络以保障每个用户享受网络服务的公平性；而且本发明的可靠性高、效率较高且网络资源利用率高。附图说明图1为本发明方法的方法流程示意图。图2为本发明方法的目标网络结构示意图。图3为本发明方法的基于子帧的接入与回程传输时间划分示例示意图。图4为本发明方法的波束角度示意图。图5为本发明方法中的求解模型的结构示意图。图6为本发明方法实施例中的模型训练过程中系统平均奖励的变化示意图。图7为本发明方法实施例中的模型训练过程中系统平均总速率的变化示意图。图8为本发明方法实施例中的型训练过程中平均满足约束率的变化示意图。具体实施方式如图1所示为本发明方法的方法流程示意图：本发明提供的这种基于动态时分双工通信的自回程毫米波蜂窝网络通信方法，包括如下步骤：S1.获取目标网络的网络参数数据信息；具体包括如下步骤：目标网络为一个带无线自回程的毫米波异构蜂窝网络；所述网络包括一个宏蜂窝和N个小蜂窝；宏基站MBS作为宏蜂窝内所有小基站SBS的带内无线回程连接至核心网的枢纽；宏基站MBS用符号m0表示，宏基站范围内的所有小基站SBS用集合M-＝{1,2,...,N}表示；集合M＝M-∪{m0}表示所有基站，且集合元素个数为N+1；宏基站MBS范围内的所有用户设备UE表示为用户设备UE仅选择小基站SBS作为关联基站，并将数据通过小基站SBS中继到宏基站MBS从而进入核心网，或者接收小基站SBS从宏基站MBS转发的数据；设定宏基站MBS、小基站SBS和用户设备UE均同时配备了毫米波频段和sub-6GHz频段的无线接口，其中毫米波频段用于数据传输，sub-6GHz频段用于控制信息交换；设定每个小基站SBS均配备了Qsbs个毫米波天线，以便具有与最多Qsbs个用户设备UE同时连接的能力；每个用户设备UE仅配备一根毫米波天线来连接最多一个小基站SBS；宏基站MBS配备了足够多的毫米波天线以保证自身能够同时向所有小基站SBS发送数据，或者同时从所有小基站SBS接收数据；设定每个小基站SBS的上下行数据到达过程遵守泊松分布；每个小基站SBS需要为自身的每一个关联的用户设备维护一个DL缓冲区，来满足用户设备的下行流量缓存需求；同时，每一个用户设备均设置一个UL缓冲区，来满足自身的上行流量的缓存需求；设定任何时刻，针对每个小基站都至少有Qsbs个用户设备的DL缓冲区和UL缓冲区非空，以保证上下行通信行到处于非空闲状态；采用分时长期演进方案，通过配置DL子帧和UL子帧的比例来适应不对称的上下行流量需求；一个通信帧包括7种无线帧配置，每帧长度为10ms，由10个连续的帧长的1ms的子帧组成；每个子帧有三种类型，U子帧、D子帧和S子帧，其中U子帧表示UL流量，D子帧表示DL流量，S子帧表示从D子帧到U子帧的转换子帧；将S子帧视为D子帧；根据无线频谱的使用模式，采用带内传输模式进行传输，即接入链路和回程链路共享相同的频谱资源；采用扇形天线模型进行夹角的计算；仅对接入链路的发射功率进行调节，并认定回程链路的发射功率为固定值；每个小基站需要为它的每个关联用户维护一个DL缓冲区来满足用户的下行流量缓存需求。同时每个UE都设置一个UL缓冲区来存储其上行流量缓存需求。我们采纳该流量模型和相应的缓冲区设置，并假设任何时刻针对每个SBS都至少有个用户的上下行缓冲区非空以确保上下行通信信道总是处于非空闲状态；本发明方案规定的一种特殊的TDD无线帧结构，通过配置DL子帧和UL子帧的比例来适应不对称的上下行流量需求。如图3所示，TD-LTE帧包含7种无线帧配置，其中每帧长度为10ms，由10个连续的帧长为1ms的子帧组成。每个子帧有三种类型。子帧U和D分别表示UL和DL流量，而子帧S表示从DL到UL的转换子帧。为了简单起见，子帧S可以视作子帧D；针对基于IAB架构的无线频谱的使用模式，其无线接入段与回程段可采用两种无线频谱使用模式，即带内和带外。带内传输是指接入链路和回程链路共享相同的频谱资源，带外传输则相反。考虑带外频段的不可控性，本发明采用带内传输方式进行接入与回程传输。基于TD-LTE无线帧结构，在确定的无线帧配置的基础上，本发明分别针对每个子帧U进行接入传输时间和回程传输时间的划分，即在原有的TD-LTE无线帧的基础上将每个子帧分为无线接入传输和回程传输两部分；同时，本发明会在后续步骤建立互干扰和数据率的估计模型，使用扇形天线模型来近似实际天线模式。这个简单的模型捕捉了方向性增益、前后比和半功率波束宽度，这些被认为是天线图的最重要特征。在理想的扇形天线图中，增益对于主瓣的所有角度都是一个常数，而在旁瓣中则等于另一个较小的常数。模型结构和一些参数如图4所示，并且在后续计算中会被用到，图4中实心箭头表示波束主瓣的中心方向，虚线表示干扰源节点与被干扰节点之间的视轴方向；通信过程汇总，由于毫米波的波长较短，因此毫米波通信链路对建筑物、树叶甚至人体等物理障碍物非常敏感。在本发明中，考虑了视距和非视距路径损失；通信时，每个SBS可能会经历4个时段，即U子帧的RA传输时段、U子帧的BH传输时段、D子帧的BH传输时段以及D子帧的RA传输时段。因此，每条链路最多会受到4种不同类型的干扰；S2.根据步骤S1获取的数据信息，以网络总速率为优化目标，以网络吞吐量、传输时间、网络传输功率、网络节点连接数和网络速度为约束条件，构建自回程毫米波蜂窝网络通信模型；具体包括如下步骤：采用如下算式构建优化目标：式中Xt为第t个子帧期间的用户设备关联情况，且表示第t个子帧期间第u个用户设备与第n个小基站互相关联，/＞表示第t个子帧期间第u个用户设备与第n个小基站无关联；Γ为任意小基站在第t个子帧归一化后的RA/BH段传输持续时间/＞的取值集合，且Z为每个子帧的时隙数；PUE为第i个用户设备在第t个子帧期间分配给接收节点j的发射功率/＞的取值集合，且/＞L为设定的正整数，/＞为用户设备的最大功率；PBS为第i个小基站在第t个子帧期间分配给接收节点j的发射功率/＞的取值集合，且/＞K为设定的正整数，/＞为小基站的最大功率；Tt为目标网络在第i个子帧期间的总速率，且表示第n个小基站的第t个子帧类型为上行子帧，/＞表示第n个小基站的第t个子帧类型为下行子帧，/＞为属于集合/＞的第n个小基站在第t个子帧期间的UL接入数据率，集合/＞为第t个子帧的类型为U子帧的小基站集合，/＞为第n个小基站的索引，/＞为集合/＞中的第i个元素，/＞为将与N个小基站所对应的RA/BH段传输持续时间序列Ωt中元素按升序排列后的集合，Ωt表示为/＞表示为/＞为N个小基站中在第t个子帧期间最小的RA/BH段传输持续时间，/＞为N个小基站中在第t个子帧期间最大的RA/BH段传输持续时间，/＞为第u个用户设备与第n个小基站之间的UL接入链路能够达到的数据速率，/＞W为毫米波频段的带宽，/＞为第u个用户设备与第n个小基站之间的UL接入链路的信号干扰噪声比，N0为毫米波频段的背景噪声功率密度，/＞为第u个用户设备在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，发射波束/＞为从第u个用户设备到第n个小基站的发射波束，接收波束/＞为从第u个用户设备到底n个小基站的接收波束，为发射波束/＞的波束宽度，z为旁瓣增益，/＞为发射波束/＞的波束中心线与第u个用户设备到第n个小基站视距方向之间的夹角，/＞为从第u个用户设备到第n个小基站的信道增益，B为参数为x的伯努利随机变量，/＞为LoS链路的概率，/＞ρLoS为平均LoS距离，du,n为第u个用户设备到第n个小基站的距离，/＞为LoS链路损耗，/＞d0为自由空间参考距离，α为损失指数参数，Xσ为服从均值为0、标准差为σ的高斯随机变量，/＞为第u个用户设备到第n个小基站的LoS距离，PL为载波频率f的函数且c为光速，/＞为NLoS链路损耗，/＞为第u个用户设备到第n个小基站的NLoS距离，/＞为NLoS链路的概率，/＞ρNLoS为平均NLoS距离，/＞为接收波束/＞对发射波束/＞的接收增益，为接收波束/＞的波束带宽，/＞为接收波束/＞的波束中心线与第u个用户设备到第n个小基站视距方向之间的夹角，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自UL接入链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自UL回程链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自DL回程链路的干扰，/＞为第u个用户设备与第n个小基站之间UL接入链路所受到的来自DL接入链路的干扰，n为第n个小基站，/＞为在期间处于U_RA时期的小基站集合，u为第u个用户设备，U{u}表示用户设备集合U剔除掉第u个用户设备后的集合，/＞为第t个子帧期间第u个用户设备与第n个小基站之间的关联变量，/＞为第u个用户设备在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，为在/＞期间处于U_BH时期的小基站集合，/＞为在第t个子帧期间第n个小基站分配给宏基站m0的发射功率，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为在期间处于D_BH时期的小基站集合，/＞为在第t个子帧期间宏基站分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为宏基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为在/＞期间处于D_RA时期的小基站集合，/＞为在第t个子帧期间第n个小基站分配给第u个用户设备的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为属于集合/＞的第n个小基站在第t个子帧期间的DL回程数据率，集合/＞为第t个子帧的类型为D子帧的小基站集合，/＞为宏基站与第n个小基站之间的DL回程链路的数据速率，/＞为宏基站与第n个小基站之间DL回程链路信号干扰噪声比，为宏基站在第t个子帧期间分配给第n个小基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，为从宏基站到第n个小基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自UL接入链路的干扰，为宏基站与第n个小基站的DL回程链路所遭受到的来自UL回程链路的干扰，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自DL回程链路的干扰，/＞为宏基站与第n个小基站的DL回程链路所遭受到的来自DL接入链路的干扰，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益；采用如下算式构建约束条件：约束条件1：约束条件2：约束条件3：约束条件4：约束条件5：约束条件6：约束条件7：式中约束条件1为为每个用户设备提供最小吞吐量保障，即一段时间内的平均吞吐量不低于吞吐量阈值；约束条件2为每个小基站提供可选RA/BH段持续传输时间集；约束条件3为为每个小基站和用户设备提供可选的离散功率集；约束条件4和5为每个用户设备最多只能与一个小基站相关联且与一个小基站相关联的用户设备数量不能超过小基站最大的并发连接数；约束条件6为每个小基站的UL回程数据率不小于接入数据率。约束条件7为DL回程数据率不大于接入数据率；/＞为第u个用户设备在调度时刻t结束并更新后的平均传输速率，tf为在当前调度时刻之前需要参考的时隙数量，1{UL}表示第n个小基站的第t-1个子帧的类型为上行子帧，1{DL}表示第n个小基站的第t-1个子帧的类型为下行子帧，/＞为第t个子帧期间第u个用户设备的上行吞吐量，/＞为第t个子帧期间第u个用户设备的下行吞吐量，Tth为设定的吞吐量阈值，/＞为在第t个子帧期间第n个小基站分配给第u个用户设备的发射功率，为在第t个子帧期间第u个用户设备分配给第n个小基站的发射功率，/＞为属于集合/＞的第n个小基站在第t个子帧期间的回程数据率，/＞为第n个小基站与宏基站之间的UL回程链路能够达到的数据速率，为第n个小基站与宏基站之间的UL回程链路的信号干扰噪声比，/＞为第n个小基站在第t个子帧期间分配给宏基站的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到宏基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自UL回程链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自DL回程链路的干扰，/＞为第n个小基站与宏基站之间的UL回程链路所遭受到的来自DL接入链路的干扰，/＞为发射波束对接收波束/＞的发射增益，/＞为从第u个用户设备到宏基站的信道增益，为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到宏基站的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，ξ为自干扰消除因子，/＞为发射波束/＞对接收波束/＞的发射增益，/＞为从宏基站到宏基站的信道增益，为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为属于集合/＞的第n个小基站在第t个子帧期间的接入数据率，为第n个小基站与第u个用户设备之间的DL接入链路能够达到的数据速率，/＞为第n个小基站与第u个用户设备之间的DL接入链路的信号干扰噪声比，为第n个小基站在第t个子帧期间分配给第u个用户设备的发射功率，/＞为发射波束/＞对接收波束/＞的发射增益，为从第n个小基站到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益，/＞为第n个小基站与第u个用户设备之间的DL接入链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的UL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的DL回程链路所遭受到的来自UL接入链路的干扰，/＞为第n个小基站与第u个用户设备之间的DL接入链路所遭受到的来自UL接入链路的干扰，为发射波束/＞对接收波束/＞的发射增益，/＞为从第u个用户设备到第u个用户设备的信道增益，为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束的发射增益，/＞为接收波束/＞对发射波束/＞的接收增益，为发射波束/＞对接收波束的发射增益，/＞为从宏基站到第u个用户设备的信道增益，/＞为接收波束对发射波束/＞的接收增益，为发射波束/＞对接收波束/＞的发射增益，/＞为从第n个小基站到第u个用户设备的信道增益，/＞为接收波束/＞对发射波束/＞的接收增益；同时，在期间，当1≤i≤N：/＞若小基站的在第t个子帧期间的子帧类型为U子帧，则采用如下方式进行更新：若小基站的在第t个子帧期间的子帧类型为D子帧，则采用如下方式进行更新：采用为每个用户设备定义PF优先级，Ru为第u个用户设备在调度时刻t时能够达到的瞬时传输速率，/＞为第u个用户设备在调度时刻t之前设定时间段内的平均传输速率；采用长期平均干扰来估算SINR值，从而得到瞬时传输速率；定义第u个用户设备在调度时刻t的SINR值为：式中为第u个用户设备在调度时刻t之前的长期平均干扰，且计算式为最后，得到如下算式对PFu'进行修正，得到修正后的PF值PFu为：在每次调度时刻t，每个小基站选取PFu值最大的Qsbs个用户设备进行关联：针对上行子帧，选择PFu值最大的Qsbs个上行发送用户设备，对于下行子帧，选择PFu值最大的Qsbs个下行接收用户设备；S3.基于CTDE架构和神经网络架构，构建求解模型；具体包括如下步骤：由于多离散变量的存在和函数形式的非线性，所建立的问题是一个混合整数非线性规划问题。一般此类问题是一个NP-hard组合问题，因为它结合了离散变量优化的难度和非线性函数处理的挑战。因此，严格的数学建模方法很难解决这类问题。深度强化学习为解决此类问题提供了一种新的解决思路。由于该问题基于深度强化学习建模的动作空间规模较大以及获取全局信道状态信息的难度较大，单智能体强化学习算法的收敛速度慢甚至很难收敛。因此，采用如下步骤建立求解模型；采用元组g＝＜N,S,A,Z,P,r,γ＞描述多智能体强化学习的环境；N＝{1,2,...,N}表示所有智能体的集合，s∈S表示环境的全局状态信息，在时间t，每个智能体n∈N同时选择一个动作所有智能体选择的行动构成联合行动/＞在执行联合动作at后，下一个时间状态st+1产生于状态转移方程P:S×AN×S→；最后，每一个智能体都会收到奖励/＞每个智能体n∈N得到一个单独的局部观察且不能得到整个全局状态st；所有智能体部分观察构成联合观测/＞智能体的部分观察和行动的历史由/＞表示；所有智能体历史集合由/＞表示；，每个智能体n∈N选择动作时都使用一个仅基于该智能体个人历史/＞的去中心化策略/＞智能体们的目的在于学习一个联合策略/＞最大化对应的期望折扣回报/＞其中γ∈对步骤S2构建的模型进行建模时，关注若干个关键要素；所述的关键要素包括局部观察空间以及全局状态空间、动作空间和即时奖励：局部观察空间以及全局状态空间：将小基站作为智能体，智能体之间没有信息交换；用Un表示位于第n个小基站范围内的用户设备集合；第n个小基站在第t子帧时刻的局部状态表示为：式中表示第n个小基站的第t个子帧的类型，若当前子帧为上行子帧则否则/＞为第n个小基站在第t-1个子帧时期的RA/BH段持续传输时间，且当t＝1时/＞为第n个小基站在第t-1个子帧时期的总速率，且当t＝1时为第n个小基站在第t个子帧时期所关联的用户设备的ID，且为第u个用户设备在第t个子帧时期的三维位置坐标信息；/＞为第u个用户设备在第t个子帧时期的PF值，且当t＝1时/＞为第u个用户设备在第t-1个子帧时期的速率，且当t＝1或/＞时/＞为第t-1个子帧时期的接入发射功率，当第t-1个子帧为上行子帧时/＞表示第u个用户设备向第n个小基站的上行接入发射功率，当第t-1个子帧为下行子帧时/＞表示第n个小基站向第u个用户设备的下行接入发射功率，且当t＝1或/＞时/＞第i个子帧时期的全局状态空间st为所有智能体局部状态的集合，并表示为/＞动作空间：在第t个子帧时，第n个小基站根据用户关联状态得到自身所关联的用户集合然后根据当前策略πn及对应的局部观察/＞第n个小基站从自身的动作空间中选择一个动作；第n个小基站在第t个子帧时刻的动作/＞表示为第n个小基站根据自身的第t个子帧的类型决定功率的发射方向与RA/BH段的持续传输时间：当第n个小基站的第t个子帧为上行帧时，给第n个小基站所关联的上行传输用户设备分配向小基站传输的上行接入发射功率，此时同时给第n个小基站分配RA段的持续传输时间；当第n个小基站的第t个子帧为下行帧时，给第n个小基站分配向其所关联的下行用户设备发送数据的下行接入发射功率，此时/＞同时给第n个小基站分配BH段的持续传输时间。；即时奖励：当所有小基站采取联合动作时，所有小基站都会获取一个奖励；将第n个小基站的即时奖励描述为：式中δ1和δ2为设置的权重系数；最终，本发明基于引入循环神经网络层、多头注意力机制，无效动作掩蔽机制来改进模型，以适应本发明的应用场景；每个小基站采用独立的策略更新裁剪来学习自身的策略πn；每个小基站基于局部观察学习critic网络式中γ为折扣因子，λ为用于权衡精度与方差的超参数，为t时刻的时间差分误差；每个小基站的策略损失为/＞clip为裁剪函数，若/＞取值位于1-ε与1+ε之间，则该函数取值为/＞若/＞取值小于1-ε，则该函数取值为1-ε；若/＞取值大于1+ε，则该函数取值为1+ε，πθ为新的策略函数，/＞为旧的策略函数；采用裁剪值限制每个小基站的critic网络的更新小于设定值ε：式中φold为更新前的参数，为折扣奖励且/＞以上更新方程将网络的更新限制在设定范围内，从而避免对最近一批数据的过拟合；对于每个小基站，整体学习损失为/＞其中H为策略πn的熵，λcritic和λentropy为设定的权重值；将宏基站作为作为信息收集和集中训练的场所；集中式critic网络采用全局信息st作出评估，分布式actor网络仅采用局部状态信息/＞作出决策；θn为第n个小基站的acter网络参数；每个小基站的策略损失函数表示为：第n个小基站的actor网络参数θn，通过策略梯度更新：式中为采样期望函数；集中式critic网络表示为/＞并描述为状态价值函数，其中φn为第n个小基站的critic网络参数；通过最小化以下损失函数来更新φn：其中为折扣奖励且/＞门控制循环单元：门控制循环单元包括更新门和复位门；在时刻t，更新状态信息为先前状态信息信息ht-1和当前候选状态信息的线性插值，表示为/＞其中zt为更新门，⊙为Hadamard乘积符号；zt的值越大，则保留先前状态的信息越多；zt的更新公式为zt＝σ，其中xt为时刻t的输入向量，σ为Sigmoid函数，Wz、Uz和bz为神经网络的参数；/＞的更新公式为式中Wh、Uh和bh为神经网络参数，rt为复位门，且更新公式为rt＝σ，Wr、Ur和br为神经网络的参数；多头注意力机制：在critic网络的多层感知器前插入多头注意力单元；critic网络函数的表达式为/＞其中fn为两层MLP，/＞为嵌入函数且由一层MLP组成，xn为除第n个小基站外的其他小基站的贡献值，且计算公式为n-为n-除第n个小基站外其他所有小基站的集合，为第/＞个小基站的注意力权重，/＞为第/＞个小基站的编码值；的计算过程为：通过嵌入函数/＞对第/＞个小基站的局部观察/＞编码，然后通过左乘矩阵Wv进行线性变换，最后将线性变换结果带入非线性激活函数h得到编码值；注意力权重/＞通过比较嵌入特征en和/＞的相似度得到；通过双线性映射机制，用Wq将en映射为query，用Wk将/＞映射为key，然后将相似度结果传递到softmax层进行归一化；无效动作屏蔽：由于本发明使用单个深度强化学习网络模型来建模UL和DL的接入和回程资源分配问题，所以每个SBS要采取的动作由当前子帧的类型决定。例如，如果当前子帧的类型是U子帧，则SBS只能为上行通信配置其RA传输持续时间和其关联用户的UL接入发射功率。否则，SBS只能为下行通信配置其BH传输持续时间和DL接入发射功率。因此，需要根据当前子帧的类型避免选择无效动作。解决无效动作问题的方法大致分为两类：一类是软约束，设置合理的奖励函数，在执行器网络输出无效动作时给予较差的奖励；另一种是硬约束，直接屏蔽无效动作，仅对有效动作进行采样。无效动作屏蔽的过程可以看作是一个状态依赖的可微函数，用于策略网络计算logits输出；因此，本发明采用无效工作屏蔽机制，进行无效动作的屏蔽；无效动作屏蔽机制表示为：式中为logits函数，j表示策略网络/＞输出的是第n个小基站的第j个动作的logits，mask为依赖状态的可微函数；M为设定的一个小于设定值值的负数；最后，本发明构建的求解模型结构如图5所示；S4.对基于求解模型的自回程毫米波蜂窝网络通信模型进行训练和求解；具体包括如下步骤：训练过程：输入：折扣因子γ，训练时长ε，小批量大小|B|，GAE权重λ，学习率α，最大步长；输出：每个小基站的actor网络模型参数θn；步骤1：初始化actor网络参数θn，critic网络参数φn，经验缓存Dn；步骤2：初始化ε为0；步骤3：初始化当前调度时期t＝0，初始状态s0，以及范围内所用户设备的步骤4：计算集合Un内所有用户设备的PFu；步骤5:根据PFu的大小，从大到小选取前Qsbs个上行或下行用户设备进行用户关联；步骤6：从环境中获得局部观测步骤7：根据actor网络以及局部观测产生动作步骤8：获取其它智能体的局部观测并组成全局状态st并输入到critic网络得到步骤9：所有小基站执行动作后，获得奖励系统转至下一状态st+1；步骤10：计算得到下一调度时刻的集合Un内所有用户设备的以及步骤11：如果t＝T，则跳转至步骤12，否则令t增加1，并跳转至步骤4；步骤12：获取智能体的轨迹以及critic网络的输出值步骤13：计算优势函数并存储样本数据/＞到经验缓存Dn中；步骤14：从经验缓存Dn中随机选取小批量|B|个数据步骤15：计算得到计算得到/＞步骤16：计算梯度并利用Adam优化器更新actor网络；步骤17：计算梯度利用Adam优化器更新critic网络；/＞步骤18：如果e＝ε，则训练完成并输出θn，否则令e增加1，跳转至步骤3；决策过程：输入：第n个小基站的局部观测输出：第n个小基站的动作根据actor网络以及局部观测直接输出动作S5.目标网络根据步骤S4得到的求解结果进行通信；S6.实时重复步骤S1～S5，完成基于动态时分双工通信的自回程毫米波蜂窝网络通信。以下结合一个实施例，对本发明方法进行说明：使用python+pytorch工具实现上述方案。根据3GPP的簇模型描述，在MBS覆盖区范围内各个小蜂窝簇彼此独立，其中簇中心和MBS之间的距离为150m，每个簇的半径为70m。本发明关注由|M-|个小蜂窝组成的一个簇，每个SBS在簇内均匀分布，且任意两个SBSs之间的最小距离为30m。每个SBS覆盖范围内都分布有足够数量的UEs。在每个调度子帧中，每个SBS基于比例公平机制根据其区域内UEs的PF值来执行用户关联。每个SBS基于RA-MAPPO多智能体强化学习的功率控制与接入回程传输时间分配算法进行资源分配。其它仿真参数详见表1和表2：表1毫米波通信的仿真参数示意表表2求解模型仿真参数示意表符号DescriptionValueγ折扣因子0.99ξ学习率0.0005Dn回访缓冲区大小64|B|小批量的大小32λGAE权重参数0.97ε梯度裁剪比例0.2T每一轮的时间步数10EpisodeεEpisode轮数20000M无效动作屏蔽参数-1×108δ1奖励函数权重5×10-9δ2奖励函数权重1×10-10-RNN隐藏层大小128-MLP隐藏层大小128-注意力头的数量8仿真过程图如图6～图8所示；从图6中可以看到，模型训练过程中系统的平均奖励在2500轮的时候已经趋于平稳并收敛于5左右；从图7中可以看到，模型训练过程中系统平均总速率在2000轮的时候已经趋于平稳并收敛于5.25Mbps左右；从图8中可以看到，模型训练过程中系统的平均满足约束率在2000轮的时候已经趋于平稳并收敛于0.97左右。通过图6～图8的仿真结果表明，本发明方法确实能够实现基于动态时分双工通信的自回程毫米波蜂窝网络通信，而且效率较高。
