标题title
一种时间的同步方法、装置、设备及存储介质
摘要abst
本发明公开了一种时间的同步方法、装置、设备及存储介质，该方法包括：接收公交车在到达站点时上传的到站报文，到站报文包括公交车所处的第一坐标与第一时间戳；根据第一坐标与第一时间戳筛选出同时到达同一站点的多辆公交车，作为多辆候选车；对多辆候选车创建在本次同时到达同一站点有效的会话；生成在本次会话有效的加密信息；在会话中将加密信息分发至多辆候选车；在会话中通知多辆候选车之间使用加密信息进行无线加密通信，以确定多辆候选车之间在同一站点排列的顺序；按照顺序对多辆候选车的第一时间戳进行同步。本实施例对同时到达同一站点的公交车的第一时间戳进行同步，保障后续的业务正常运行。
权利要求书clms
1.一种时间的同步方法，其特征在于，包括：接收公交车在到达站点时上传的到站报文，所述到站报文包括公交车所处的第一坐标与第一时间戳；根据所述第一坐标与所述第一时间戳筛选出同时到达同一所述站点的多辆所述公交车，作为多辆候选车；对多辆所述候选车创建在本次同时到达同一所述站点有效的会话；生成在本次所述会话有效的加密信息；在所述会话中将所述加密信息分发至多辆所述候选车；在所述会话中通知多辆所述候选车之间使用所述加密信息进行无线加密通信，以确定多辆所述候选车之间在同一所述站点排列的顺序；按照所述顺序对多辆所述候选车的所述第一时间戳进行同步。2.根据权利要求1所述的方法，其特征在于，所述根据所述第一坐标与所述第一时间戳筛选出同时到达同一所述站点的多辆所述公交车，作为多辆候选车，包括：对每个所述站点生成以所述站点为中心的区域；将所述公交车所处的所述第一坐标与所述区域进行比较；若所述公交车所处的所述第一坐标位于所述区域，则按照所述公交车的所述第一时间戳之间的差异筛选同时到达同一所述站点的多辆所述公交车，作为多辆候选车。3.根据权利要求2所述的方法，其特征在于，所述按照所述公交车的所述第一时间戳之间的差异筛选同时到达同一所述站点的多辆所述公交车，作为多辆候选车，包括：将所述公交车的所述第一时间戳标记在时间轴上；在所述时间轴上添加时间窗口，所述时间窗口的起始点与数值最小的所述第一时间戳对齐；确定位于所述时间窗口内的多个所述第一时间戳对应的多辆所述公交车同时到达同一所述站点，作为多辆候选车。4.根据权利要求1-3中任一项所述的方法，其特征在于，所述加密信息包括随机生成的数值、密钥；所述在所述会话中通知多辆所述候选车之间使用所述加密信息进行无线加密通信，以确定多辆所述候选车之间在同一所述站点排列的顺序，包括：依据所述第一坐标选择其中一辆所述候选车作为第一目标车；在所述会话中通知所述第一目标车调用对称密钥函数、使用所述密钥将所述数值加密至定位报文，并作为无线热点将所述定位报文广播至第二目标车，所述第二目标车为除所述第一目标车之外的其他所述候选车；在所述会话中通知所述第二目标车作为无线设备探测所述定位报文；若所述第二目标车向所述第一目标车发送验证报文，则接收所述第一目标车在所述会话中发送的强度报文，其中，所述验证报文表示所述第二目标车调用所述对称密钥函数、使用所述密钥从所述定位报文解密出所述数值，所述强度报文包括所述第二目标车对所述无线热点探测到的信号强度；判断所述信号强度是否表征所述第一目标车与所述第二目标车顺序排列；若是，则按照所述信号强度确定所述第一目标车与所述第二目标车在同一所述站点排列的顺序；若否，则依据所述信号强度选择至少一辆所述候选车作为新的第一目标车，返回执行所述在所述会话中通知所述第一目标车调用对称密钥函数、使用所述密钥将所述数值加密至定位报文，并作为无线热点将所述定位报文广播至第二目标车。5.根据权利要求4所述的方法，其特征在于，所述依据所述第一坐标选择其中一辆所述候选车作为第一目标车，包括：查询多辆所述候选车同时到达的同一所述站点所处的道路；对所述道路生成切线；将多辆所述候选车对应的所述第一坐标分别投影至所述切线上；在所述切线上沿所述道路前进的方向筛选出选择排序首位的所述第一坐标，作为候选点；将所述候选点所属的所述候选车设置为第一目标车。6.根据权利要求5所述的方法，其特征在于，所述判断所述信号强度是否表征所述第一目标车与所述第二目标车顺序排列，包括：对所述信号强度进行排序，得到强度序列；在所述强度序列中，计算相邻两个所述信号强度之间的差值，作为强度差；判断是否所有所述强度差均大于或等于预设的阈值；若是，则确定所述信号强度表征所述第一目标车与所述第二目标车顺序排列；若否，则确定所述信号强度并非表征所述第一目标车与所述第二目标车顺序排列；所述按照所述信号强度确定所述第一目标车与所述第二目标车在同一所述站点排列的顺序，包括：确定所述第一目标车在所述站点排列在首位；将所述强度序列中所述信号强度的顺序赋值为所述信号强度对应的所述第二目标车在同一所述站点排列的顺序；所述依据所述信号强度选择至少一辆所述候选车作为新的第一目标车，包括：若所述强度差小于预设的阈值，则将所述强度差对应的所述候选车设置为新的第一目标车。7.根据权利要求6所述的方法，其特征在于，所述按照所述顺序对多辆所述候选车的所述第一时间戳进行同步，包括：查询所述第一目标车在到达所述站点之前上报的行驶报文，所述行驶报文包括第二坐标与第二时间戳；分别对所述第二坐标与所述第二时间戳进行插值处理；若完成所述插值处理，则对每辆所述第二目标车生成坐标对，所述坐标对包括所述第一坐标、与所述第一坐标最近的所述第二坐标；针对每个所述坐标对，在所述第二坐标对应的所述第二时间戳的基础上分别加上目标极大值、目标极小值，获得时间范围，所述目标极大值为所述第二目标车的顺序与预设的候选极大值之间的乘积，所述目标极小值为所述第二目标车的顺序与预设的候选极小值之间的乘积；若所述第一坐标对应的所述第一时间戳在所述时间范围内，则维持所述第一坐标对应的所述第一时间戳不变；若所述第一坐标对应的所述第一时间戳在所述时间范围外，则在所述时间范围内随机选择时间戳、更新为所述第一坐标对应的所述第一时间戳。8.一种时间的同步装置，其特征在于，包括：到站报文接收模块，用于接收公交车在到达站点时上传的到站报文，所述到站报文包括公交车所处的第一坐标与第一时间戳；候选车筛选模块，用于根据所述第一坐标与所述第一时间戳筛选出同时到达同一所述站点的多辆所述公交车，作为多辆候选车；会话创建模块，用于对多辆所述候选车创建在本次同时到达同一所述站点有效的会话；加密信息生成模块，用于生成在本次所述会话有效的加密信息；加密信息分发模块，用于在所述会话中将所述加密信息分发至多辆所述候选车；到站顺序确定模块，用于在所述会话中通知多辆所述候选车之间使用所述加密信息进行无线加密通信，以确定多辆所述候选车之间在同一所述站点排列的顺序；时间戳同步模块，用于按照所述顺序对多辆所述候选车的所述第一时间戳进行同步。9. 一种电子设备，其特征在于，所述电子设备包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的计算机程序，所述计算机程序被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-7中任一项所述的时间的同步方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机程序，所述计算机程序用于使处理器执行时实现权利要求1-7中任一项所述的时间的同步方法。
说明书desc
技术领域本发明涉及通信的技术领域，尤其涉及一种时间的同步方法、装置、设备及存储介质。背景技术公交车是用户出行的公共交通工具之一，公交车沿固定的线路行驶，在公交车行驶至站点时短暂停靠，让用户上下车，由于站点的范围较小，经常出现多辆公交车同时到达站点的情况，并且公交车往往首尾相接。在到达站点时，公交车会实时上传时间戳等信息同步到云端，云端利用时间戳等信息进行实时安全监控、后期仿真测试等业务。不同公交车计算的时间戳之间存在一定的误差，在多辆公交车到达同一站点时，时间戳之间的误差可能引起不合理的情况，导致业务出错。例如，公交车A在时间戳A到达站点，公交车B在时间戳B到达同一站点，公交车B位于公交车A的尾部，时间戳A略大于时间戳B，在仿真测试时，模拟公交车A到站的过程，公交车A在时间戳B行驶时处于公交车B的位置，此时，公交车A与公交车B因位置重叠而认为发生碰撞。发明内容本发明提供了一种时间的同步方法、装置、设备及存储介质，以解决如何公交车到站时的时间戳不合理的问题。根据本发明的一方面，提供了一种时间的同步方法，包括：接收公交车在到达站点时上传的到站报文，所述到站报文包括公交车所处的第一坐标与第一时间戳；根据所述第一坐标与所述第一时间戳筛选出同时到达同一所述站点的多辆所述公交车，作为多辆候选车；对多辆所述候选车创建在本次同时到达同一所述站点有效的会话；生成在本次所述会话有效的加密信息；在所述会话中将所述加密信息分发至多辆所述候选车；在所述会话中通知多辆所述候选车之间使用所述加密信息进行无线加密通信，以确定多辆所述候选车之间在同一所述站点排列的顺序；按照所述顺序对多辆所述候选车的所述第一时间戳进行同步。根据本发明的另一方面，提供了一种时间的同步装置，包括：到站报文接收模块，用于接收公交车在到达站点时上传的到站报文，所述到站报文包括公交车所处的第一坐标与第一时间戳；候选车筛选模块，用于根据所述第一坐标与所述第一时间戳筛选出同时到达同一所述站点的多辆所述公交车，作为多辆候选车；会话创建模块，用于对多辆所述候选车创建在本次同时到达同一所述站点有效的会话；加密信息生成模块，用于生成在本次所述会话有效的加密信息；加密信息分发模块，用于在所述会话中将所述加密信息分发至多辆所述候选车；到站顺序确定模块，用于在所述会话中通知多辆所述候选车之间使用所述加密信息进行无线加密通信，以确定多辆所述候选车之间在同一所述站点排列的顺序；时间戳同步模块，用于按照所述顺序对多辆所述候选车的所述第一时间戳进行同步。根据本发明的另一方面，提供了一种电子设备，所述电子设备包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的计算机程序，所述计算机程序被所述至少一个处理器执行，以使所述至少一个处理器能够执行本发明任一实施例所述的时间的同步方法。根据本发明的另一方面，提供了一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序用于使处理器执行时实现本发明任一实施例所述的时间的同步方法。在本实施例中，接收公交车在到达站点时上传的到站报文，到站报文包括公交车所处的第一坐标与第一时间戳；根据第一坐标与第一时间戳筛选出同时到达同一站点的多辆公交车，作为多辆候选车；对多辆候选车创建在本次同时到达同一站点有效的会话；生成在本次会话有效的加密信息；在会话中将加密信息分发至多辆候选车；在会话中通知多辆候选车之间使用加密信息进行无线加密通信，以确定多辆候选车之间在同一站点排列的顺序；按照顺序对多辆候选车的第一时间戳进行同步。本实施例对同时到达同一站点的公交车的第一时间戳进行同步，修正不合理的第一时间戳，消除第一时间戳之间引起不合理的情况，保障后续的业务正常运行。应当理解，本部分所描述的内容并非旨在标识本发明的实施例的关键或重要特征，也不用于限制本发明的范围。本发明的其它特征将通过以下的说明书而变得容易理解。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是根据本发明实施例一提供的一种时间的同步方法的流程图；图2是根据本发明实施例二提供的一种时间的同步装置的结构示意图；图3是实现本发明实施例三提供的一种电子设备的结构示意图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分的实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本发明保护的范围。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。实施例一图1为本发明实施例一提供的一种时间的同步方法的流程图，本实施例可适用于对公交车到站时提交的时间戳同步修正的情况，该方法可以由时间的同步装置来执行，该时间的同步装置可以采用硬件和/或软件的形式实现，该时间的同步装置可配置于电子设备中。如图1所示，该方法包括：步骤101、接收公交车在到达站点时上传的到站报文。公交车，指在城市道路上循固定路线，该路线上设置有多个站点，有或者无固定班次时刻，有专属路号，在站点停靠让乘客上下车、承载乘客出行的机动车辆。公交车的外形一般为方型，有窗，设置座位、扶手。在城区，公交车的时速一般在25-50公里/小时，在郊区，公交车的时速可达80公里/小时。在本实施例中，每辆公交车中均配置有卫星定位系统、时钟芯片，公交车在行驶的过程中，卫星定位系统为实时定位公交车所处的坐标，时钟芯片实时计时。每辆公交车在到达站点时，均会生成到站报文，到站报文包括公交车所处的坐标、记为第一坐标，与，得到该第一坐标的时间戳、记为第一时间戳，公交车通过蜂窝网络将到站报文上报至云端。步骤102、根据第一坐标与第一时间戳筛选出同时到达同一站点的多辆公交车，作为多辆候选车。云端可以接收到众多公交车在到站时上报的第一坐标与第一时间戳，遍历多辆公交车的第一坐标与第一时间戳，将众多公交车的第一坐标与第一时间戳进行对比，划分出满足同时到达同一站点的多辆公交车，记为多辆候选车。在本发明的一个实施例中，步骤102可以包括如下步骤：步骤1021、对每个站点生成以站点为中心的区域。云端维护的所有站点均已预先标记经纬度，针对每个站点，均可以以站点为中心、生成指定形状的区域，这个区域属于公交车停靠该站点较为置信的范围。步骤1022、将公交车所处的第一坐标与区域进行比较。云端在维护所有公交车在到站时上报的第一时间戳，忽略已经同步第一时间戳的公交车，对未同步第一时间戳的公交车，将其所处的第一坐标与区域进行比较。步骤1023、若公交车所处的第一坐标位于区域，则按照公交车的第一时间戳之间的差异筛选同时到达同一站点的多辆公交车，作为多辆候选车。如果某些公交车所处的第一坐标位于区域，则可以认为该公交车到达该区域对应的站点是置信的，此时，计算这些公交车的公交车的第一时间戳之间的差异，依据该差异筛选出同时到达同一站点的多辆公交车，记为多辆候选车。在具体实现中，可以创建一条时间轴，将公交车的第一时间戳标记在时间轴上，在时间轴上添加预设长度的时间窗口，时间窗口的起始点与数值最小的第一时间戳对齐，时间窗口的长度属于默认的经验值，在同一时间窗口内的时间戳均可以认为在合理的误差范围内。因此，可以确定位于时间窗口内的多个第一时间戳对应的多辆公交车同时到达同一站点，作为多辆候选车。步骤103、对多辆候选车创建在本次同时到达同一站点有效的会话。在本实施例中，云端可以对同时到达同一站点的多辆候选车窗口临时的会话，该会话在本次到站有效，即，多辆候选车均驶离站点时，会话取消。步骤104、生成在本次会话有效的加密信息。为了保障在本次到站中各辆候选车之间通信的安全性，云端可以生成在本次会话有效的加密信息，该加密信息用于各辆候选车之间进行加密通信。步骤105、在会话中将加密信息分发至多辆候选车。云端在会话中执行消息的群发操作，通过蜂窝网络将加密信息发送至会话中的每一辆候选车。步骤106、在会话中通知多辆候选车之间使用加密信息进行无线加密通信，以确定多辆候选车之间在同一站点排列的顺序。云端在会话中发送控制指令，控制多辆候选车之间使用加密信息进行无线加密通信，基于无效加密通信的情况确定多辆候选车之间在同一站点排列的顺序。一般情况下，多辆候选车是沿道路的前进方向排列，得到排列的顺序。在本发明的一个实施例中，加密信息包括随机生成的数值、密钥；则在本实施例中，步骤106可以包括如下步骤：步骤1061、依据第一坐标选择其中一辆候选车作为第一目标车。将各辆候选车的第一坐标进行比较，选择有较高概率排序首位的候选车，记为第一目标车。在具体实现中，可以在预先绘制的电子地图中查询多辆候选车同时到达的同一站点所处的道路，对道路生成切线，以体现其大致的前进方向。将多辆候选车对应的第一坐标分别投影至该切线上，在切线上沿道路前进的方向筛选出选择排序首位的第一坐标，作为候选点，将候选点所属的候选车设置为第一目标车。虽然多辆候选车的卫星定位系统在小范围存在一定的误差，但是，这种误差是可控的，一般情况下，误差是不会超过公交车的尺寸，因此，多辆公交车是有小概率在相邻位置之间顺序颠倒，排序的顺序可以大体上保持精确度，不会严重打乱排序的顺序。步骤1062、在会话中通知第一目标车调用对称密钥函数、使用密钥将数值加密至定位报文，并作为无线热点将定位报文广播至第二目标车。云端在会话中执行消息的单发操作，向第一目标车发送控制指令，第一目标车在接收到控制指令时，调用等对称密钥函数、使用密钥将数值进行加密，将加密之后的密文封装至定位报文。其中，对称密钥函数指发送方和接收方用相同的密钥对明文进行加密和解密，包括AES、IDEA等。每辆公交车中均配置有无线芯片，如WiFi芯片等。第一目标车启动无线芯片，开启局域网中的无线热点，作为无线热点将定位报文广播至第二目标车，其中，第二目标车为除第一目标车之外的其他候选车。步骤1063、在会话中通知第二目标车作为无线设备探测定位报文。云端在会话中执行消息的群发操作，向第二目标车发送控制指令，第二目标车在接收到控制指令时，启动无线芯片，探测无线热点广播的定位报文。第二目标车在接收到定位报文时，从定位报文中读取密文，调用对称密钥函数、使用密钥对该密文进行解密，如果解密后的数据为云端发布的数值，即表示定位成功，此时，第二目标车将对无线热点探测到的信号强度封装至验证报文中，通过局域网将验证报文发送至第一目标车，那么，验证报文表示二目标车调用对称密钥函数、使用密钥从定位报文解密出数值。步骤1064、若第二目标车向第一目标车发送验证报文，则接收第一目标车在会话中发送的强度报文。第一目标车在接收各辆第二目标车的验证报文，从验证报文读取第二目标车对无线热点探测到的信号强度，将所有第二目标车对无线热点探测到的信号强度封装至强度报文中，即，强度报文包括第二目标车对无线热点探测到的信号强度，在会话中通过蜂窝网络将强度报文发送至云端，云端在接收到强度报文时，从强度报文中读取所有第二目标车对无线热点探测到的信号强度。步骤1065、判断信号强度是否表征第一目标车与第二目标车顺序排列；若是，则执行步骤1066，若否，则执行步骤1067。多辆候选车同时到达同一站点时依次排列，每辆候选车之间间隔的距离基本相同，因此，假设排序在首位的候选车作为无线热点发出定位报文，其他候选车对无线热点探测到的信号强度会依据其他候选车排序的位置依次递减，递减的幅度恒定。因此，可以依据信号强度的分布信息判断是否表征第一目标车与第二目标车顺序排列，即，第一目标车排序在首位、第二目标车依次排序在第一目标车之后。在具体实现中，对所有信号强度进行排序，得到强度序列。在强度序列中，计算相邻两个信号强度之间的差值，作为强度差。判断是否所有强度差均大于或等于预设的阈值；若是，则确定信号强度表征第一目标车与第二目标车顺序排列；若否，则确定信号强度并非表征第一目标车与第二目标车顺序排列，在第一目标车、第二目标车排序时，维持了大体上的精确度，若第一目标车并非排序在首位，则第一目标车有较大的概率是排序在第二位，第一目标车排序在第三位及之后的顺序的概率较低。步骤1066、按照信号强度确定第一目标车与第二目标车在同一站点排列的顺序。如果信号强度的分布信息表征第一目标车与第二目标车顺序排列，那么，可以按照信号强度的分布信息设定第一目标车与第二目标车在同一站点排列的顺序。在具体实现中，确定第一目标车在站点排列在首位，将强度序列中信号强度的顺序赋值为信号强度对应的第二目标车在同一站点排列的顺序。步骤1067、依据信号强度选择至少一辆候选车作为新的第一目标车，返回执行步骤1062-步骤1065。如果信号强度的分布信息未能表征第一目标车与第二目标车顺序排列，那么，可以参考信号强度的分布信息选择至少一辆较大概率排序首位的候选车，作为新的第一目标车，重新进行判断。在具体实现中，若强度差小于预设的阈值，则表示第一目标车与强度差对应的两辆候选车之间的排序错乱，强度差对应的两辆候选车有较高概率排序首位，那么，将强度差对应的两辆候选车设置为新的第一目标车。步骤107、按照顺序对多辆候选车的第一时间戳进行同步。在确定多辆候选车之间在同一站点排列的顺序时，可以从运动学的角度合理地推测出多辆候选车之间的运动情况，以此对多辆候选车的第一时间戳进行同步，将不合理的第一时间戳进行修正。在具体实现中，可查询第一目标车在到达站点之前上报的行驶报文，其中，行驶报文包括第二坐标与第二时间戳。由于上报频率较低，第二坐标与第二时间戳均较为稀疏，因此，可以沿站点所处的道路分别对第二坐标与第二时间戳进行插值处理，使得第二坐标与第二时间戳更加稠密，方便作为锚点给第二目标车进行锚定。若完成插值处理，则对每辆第二目标车生成坐标对，其中，坐标对包括第一坐标、与第一坐标最近的第二坐标，此时，可以认为第一坐标与第二坐标相同，第一目标车与第二目标车依次到达相同的地点。针对每个坐标对，在第二坐标对应的第二时间戳的基础上分别加上目标极大值、目标极小值，第二时间戳与目标极大值之间的和值为上限值、第二时间戳与目标极小值之间的和值为下限值，获得由上限值与下限值组成的时间范围。其中，目标极大值为第二目标车的顺序与预设的候选极大值之间的乘积，目标极小值为第二目标车的顺序与预设的候选极小值之间的乘积。公交车在到站时，为保障乘客的安全，其速度通常会明显降低，以低速并近似匀速曲线/直线的方式移动，直至到站停止，那么，多个候选车在依次到达相同的地点间隔的时间是比较稳定的，以时间范围进行表征。若第一坐标对应的第一时间戳在时间范围内，则维持第一坐标对应的第一时间戳不变。若第一坐标对应的第一时间戳在时间范围外，则在时间范围内随机选择一个时间戳、更新为第一坐标对应的第一时间戳，提高真实性。在针对站点处理与公交车到站相关的业务时，可使用各公交车同步后的第一时间戳，保证业务的正常运行，在针对公交车处理业务时，可使用该公交车同步前的第一时间戳及其他时间戳，保证业务的精确度。在本实施例中，接收公交车在到达站点时上传的到站报文，到站报文包括公交车所处的第一坐标与第一时间戳；根据第一坐标与第一时间戳筛选出同时到达同一站点的多辆公交车，作为多辆候选车；对多辆候选车创建在本次同时到达同一站点有效的会话；生成在本次会话有效的加密信息；在会话中将加密信息分发至多辆候选车；在会话中通知多辆候选车之间使用加密信息进行无线加密通信，以确定多辆候选车之间在同一站点排列的顺序；按照顺序对多辆候选车的第一时间戳进行同步。本实施例对同时到达同一站点的公交车的第一时间戳进行同步，修正不合理的第一时间戳，消除第一时间戳之间引起不合理的情况，保障后续的业务正常运行。实施例二图2为本发明实施例二提供的一种时间的同步装置的结构示意图。如图2所示，该装置包括：到站报文接收模块201，用于接收公交车在到达站点时上传的到站报文，所述到站报文包括公交车所处的第一坐标与第一时间戳；候选车筛选模块202，用于根据所述第一坐标与所述第一时间戳筛选出同时到达同一所述站点的多辆所述公交车，作为多辆候选车；会话创建模块203，用于对多辆所述候选车创建在本次同时到达同一所述站点有效的会话；加密信息生成模块204，用于生成在本次所述会话有效的加密信息；加密信息分发模块205，用于在所述会话中将所述加密信息分发至多辆所述候选车；到站顺序确定模块206，用于在所述会话中通知多辆所述候选车之间使用所述加密信息进行无线加密通信，以确定多辆所述候选车之间在同一所述站点排列的顺序；时间戳同步模块207，用于按照所述顺序对多辆所述候选车的所述第一时间戳进行同步。在本发明的一个实施例中，所述候选车筛选模块202还用于：对每个所述站点生成以所述站点为中心的区域；将所述公交车所处的所述第一坐标与所述区域进行比较；若所述公交车所处的所述第一坐标位于所述区域，则按照所述公交车的所述第一时间戳之间的差异筛选同时到达同一所述站点的多辆所述公交车，作为多辆候选车。在本发明的一个实施例中，所述候选车筛选模块202还用于：将所述公交车的所述第一时间戳标记在时间轴上；在所述时间轴上添加时间窗口，所述时间窗口的起始点与数值最小的所述第一时间戳对齐；确定位于所述时间窗口内的多个所述第一时间戳对应的多辆所述公交车同时到达同一所述站点，作为多辆候选车。在本发明的一个实施例中，所述加密信息包括随机生成的数值、密钥；所述到站顺序确定模块206还用于：依据所述第一坐标选择其中一辆所述候选车作为第一目标车；在所述会话中通知所述第一目标车调用对称密钥函数、使用所述密钥将所述数值加密至定位报文，并作为无线热点将所述定位报文广播至第二目标车，所述第二目标车为除所述第一目标车之外的其他所述候选车；在所述会话中通知所述第二目标车作为无线设备探测所述定位报文；若所述第二目标车向所述第一目标车发送验证报文，则接收所述第一目标车在所述会话中发送的强度报文，其中，所述验证报文表示所述第二目标车调用所述对称密钥函数、使用所述密钥从所述定位报文解密出所述数值，所述强度报文包括所述第二目标车对所述无线热点探测到的信号强度；判断所述信号强度是否表征所述第一目标车与所述第二目标车顺序排列；若是，则按照所述信号强度确定所述第一目标车与所述第二目标车在同一所述站点排列的顺序；若否，则依据所述信号强度选择至少一辆所述候选车作为新的第一目标车，返回执行所述在所述会话中通知所述第一目标车调用对称密钥函数、使用所述密钥将所述数值加密至定位报文，并作为无线热点将所述定位报文广播至第二目标车。在本发明的一个实施例中，所述到站顺序确定模块206还用于：查询多辆所述候选车同时到达的同一所述站点所处的道路；对所述道路生成切线；将多辆所述候选车对应的所述第一坐标分别投影至所述切线上；在所述切线上沿所述道路前进的方向筛选出选择排序首位的所述第一坐标，作为候选点；将所述候选点所属的所述候选车设置为第一目标车。在本发明的一个实施例中，所述到站顺序确定模块206还用于：对所述信号强度进行排序，得到强度序列；在所述强度序列中，计算相邻两个所述信号强度之间的差值，作为强度差；判断是否所有所述强度差均大于或等于预设的阈值；若是，则确定所述信号强度表征所述第一目标车与所述第二目标车顺序排列；若否，则确定所述信号强度并非表征所述第一目标车与所述第二目标车顺序排列；所述到站顺序确定模块206还用于：确定所述第一目标车在所述站点排列在首位；将所述强度序列中所述信号强度的顺序赋值为所述信号强度对应的所述第二目标车在同一所述站点排列的顺序；所述到站顺序确定模块206还用于：若所述强度差小于预设的阈值，则将所述强度差对应的所述候选车设置为新的第一目标车。在本发明的一个实施例中，所述时间戳同步模块207还用于：查询所述第一目标车在到达所述站点之前上报的行驶报文，所述行驶报文包括第二坐标与第二时间戳；分别对所述第二坐标与所述第二时间戳进行插值处理；若完成所述插值处理，则对每辆所述第二目标车生成坐标对，所述坐标对包括所述第一坐标、与所述第一坐标最近的所述第二坐标；针对每个所述坐标对，在所述第二坐标对应的所述第二时间戳的基础上分别加上目标极大值、目标极小值，获得时间范围，所述目标极大值为所述第二目标车的顺序与预设的候选极大值之间的乘积，所述目标极小值为所述第二目标车的顺序与预设的候选极小值之间的乘积；若所述第一坐标对应的所述第一时间戳在所述时间范围内，则维持所述第一坐标对应的所述第一时间戳不变；若所述第一坐标对应的所述第一时间戳在所述时间范围外，则在所述时间范围内随机选择时间戳、更新为所述第一坐标对应的所述第一时间戳。本发明实施例所提供的时间的同步装置可执行本发明任意实施例所提供的时间的同步方法，具备执行时间的同步方法相应的功能模块和有益效果。实施例三图3示出了可以用来实施本发明的实施例的电子设备10的结构示意图。电子设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。电子设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴设备和其它类似的计算装置。本文所示的部件、它们的连接和关系、以及它们的功能仅仅作为示例，并且不意在限制本文中描述的和/或者要求的本发明的实现。如图3所示，电子设备10包括至少一个处理器11，以及与至少一个处理器11通信连接的存储器，如只读存储器12、随机访问存储器13等，其中，存储器存储有可被至少一个处理器执行的计算机程序，处理器11可以根据存储在只读存储器12中的计算机程序或者从存储单元18加载到随机访问存储器13中的计算机程序，来执行各种适当的动作和处理。在RAM 13中，还可存储电子设备10操作所需的各种程序和数据。处理器11、ROM 12以及RAM 13通过总线14彼此相连。输入/输出接口15也连接至总线14。电子设备10中的多个部件连接至I/O接口15，包括：输入单元16，例如键盘、鼠标等；输出单元17，例如各种类型的显示器、扬声器等；存储单元18，例如磁盘、光盘等；以及通信单元19，例如网卡、调制解调器、无线通信收发机等。通信单元19允许电子设备10通过诸如因特网的计算机网络和/或各种电信网络与其他设备交换信息/数据。处理器11可以是各种具有处理和计算能力的通用和/或专用处理组件。处理器11的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的处理器、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。处理器11执行上文所描述的各个方法和处理，如时间的同步方法。在一些实施例中，时间的同步方法可被实现为计算机程序，其被有形地包含于计算机可读存储介质，例如存储单元18。在一些实施例中，计算机程序的部分或者全部可以经由ROM 12和/或通信单元19而被载入和/或安装到电子设备10上。当计算机程序加载到RAM13并由处理器11执行时，可以执行上文描述的时间的同步方法的一个或多个步骤。备选地，在其他实施例中，处理器11可以通过其他任何适当的方式而被配置为执行时间的同步方法。本文中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、负载可编程逻辑设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本发明的方法的计算机程序可以采用一个或多个编程语言的任何组合来编写。这些计算机程序可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器，使得计算机程序当由处理器执行时使流程图和/或框图中所规定的功能/操作被实施。计算机程序可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本发明的上下文中，计算机可读存储介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合地使用的计算机程序。计算机可读存储介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或设备，或者上述内容的任何合适组合。备选地，计算机可读存储介质可以是机器可读信号介质。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储存设备、磁储存设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在电子设备上实施此处描述的系统和技术，该电子设备具有：用于向用户显示信息的显示装置或者LCD监视器）；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给电子设备。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网、区块链网络和互联网。计算系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，又称为云计算服务器或云主机，是云计算服务体系中的一项主机产品，以解决了传统物理主机与VPS服务中，存在的管理难度大，业务扩展性弱的缺陷。实施例四本发明实施例还提供了一种计算机程序产品，该计算机程序产品包括计算机程序，该计算机程序在被处理器执行时实现如本发明任一实施例所提供的时间的同步方法。计算机程序产品在实现的过程中，可以以一种或多种程序设计语言或其组合来编写用于执行本发明操作的计算机程序代码，程序设计语言包括面向对象的程序设计语言，诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言，诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，可以连接到外部计算机。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本发明中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本发明的技术方案所期望的结果，本文在此不进行限制。上述具体实施方式，并不构成对本发明保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本发明的精神和原则之内所作的修改、等同替换和改进等，均应包含在本发明保护范围之内。
