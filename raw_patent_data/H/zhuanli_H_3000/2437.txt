标题title
面向低通信带宽下远程操控的操控端建图方法
摘要abst
本发明公开了一种面向低通信带宽下远程操控的操控端建图方法，机器人端通过同步定位与建图算法进行同步定位与建图，并使用双缓存八叉树维护前后两帧子地图以求取增量点云；增量点云经过编码压缩后，与同步定位与建图算法输出的机器人位姿一同发送至操控端；操控端进行增量点云重建得到3D点云地图，通过地图质量评估与反馈模块评估建图质量并反馈至机器人端，从而自适应地调整增量点云求取参数。本发明以操控端使用增量点云重建三维地图的方式，大大降低了人机协同远程操控系统的通信带宽要求；在操控端生成三维地图，又极大地减轻了操控人员的操控负担，提高了操控人员的操控准确度。
权利要求书clms
1.一种面向低通信带宽下远程操控的操控端建图方法，其特征在于，包括如下步骤：S1：机器人端获取多传感器数据，通过同步定位与建图算法实时解算机器人在全局坐标系下的位姿，并维护一个全局坐标系下的地图；S2：机器人端通过增量点云获取算法得到增量点云，对增量点云编码压缩，并与机器人当前位姿一同发送至操控端；S3：操控端解码增量点云，创建三维点云地图，执行地图质量评估与反馈模块，评估建图质量并反馈至机器人端。2.根据权利要求1所述的面向低通信带宽下远程操控的操控端建图方法，其特征在于，机器人端获取多传感器数据，通过同步定位与建图算法实时解算机器人在全局坐标系下的位姿，并维护一个全局坐标系下的地图的具体方法为：S11：以激光雷达起始位姿作为全局坐标系位姿S12：第k时刻，无人车端实时采集激光点云数据Pk与IMU数据Ik，并通过标定参数将IMU数据转换到激光雷达坐标系下的到激光雷达坐标系下的IMU数据I′k；S13：第k时刻，激光点云数据Pk与IMU数据I′k通过迭代卡尔曼滤波器框架融合计算激光惯性里程计，得到激光雷达第k时刻在全局坐标系下的位姿S14：第k时刻，激光雷达坐标系下的激光点云数据Pk根据Tk转换到全局坐标系下，得到全局坐标系下激光点云数据S15：第k时刻全局坐标系下激光点云数据叠加到第k-1时刻的全局地图Qk-1上，得到第k时刻的全局地图Qk。3.根据权利要求1所述的面向低通信带宽下远程操控的操控端建图方法，其特征在于，机器人端通过增量点云获取算法得到增量点云具体包括以下步骤：S21：设定增量点云获取算法相关参数，包括八叉树分辨率r、点云视场角α；S22：每一时刻从当前全局地图中截取机器人正前方范围内的子地图；S23：利用分辨率为r的双缓存八叉树组织第k时刻与第k+1时刻的子地图，通过双缓存区进行异或操作得到两子地图的差异，即第k+1时刻的增量点云。4.根据权利要求1所述的面向低通信带宽下远程操控的操控端建图方法，其特征在于：S21步骤中，设定增量点云获取算法相关参数时，初始参数通过配置文件设定，之后通过操控端的反馈结果自适应调整相关参数，进而动态控制增量点云的数量。5.根据权利要求1所述的面向低通信带宽下远程操控的操控端建图方法，其特征在于：S3步骤中，创建三维点云地图的过程是在操控端进行，具体通过全局坐标系下的多帧增量点云直接叠加得到与机器人端同步的三维点云地图。6.根据权利要求1所述的面向低通信带宽下远程操控的操控端建图方法，其特征在于，执行地图质量评估与反馈模块，评估建图质量的具体方法为：S31：初始化相关参数，包括执行帧率f、局部子地图半径R、地图密度因子最小阈值Mmin与最大阈值Mmax、八叉树分辨率调整系数Δr、点云视场角调整系数Δα；S32：每间隔f帧，操控端对半径R范围内的局部子地图进行统计，包括子地图中点云数量n和每个点与最近邻域点的距离di；S33：计算点云地图密度因子S34：若满足M＞Mmax，则点云地图质量较差，调整八叉树分辨率为r＝r-Δr，调整点云视场角为α＝α+Δα；S35：若满足M＜Mmin，则点云地图较稠密，调整八叉树分辨率为r＝r+Δr，调整点云视场角为α＝a-Δα；S36：将调整后的参数发送至机器人端进行反馈。
说明书desc
技术领域本发明属于人机协同技术领域，尤其是一种面向低通信带宽下远程操控的操控端建图方法。背景技术对于人机协同远程操控系统，为便于操控人员观察机器人周围环境、减轻操纵人员负荷，通常会将机器人端采集的图像等传感器数据发送至操控端。其中，如果操控端能够获取到激光雷达点云数据，对于人机协同远程操控系统有多方面的好处。一方面，其他传感器数据在某些场景下会失效，如在室内无光照情况下或地下空间，通过相机采集的图像往往漆黑一片，操控人员无法通过相机判断机器人周围情况，而通过激光点云构建三维点云地图则不受光照条件等影响；另一方面，三维点云地图能更直观地反映机器人周围环境情况，减轻操控人员的操控负担，提高操控人员的操控准确度。然而，由于点云数据量十分庞大，目前的人机协同远程操控系统往往只是将压缩后的图像数据传输至操控端，而并没有向操控端传输点云数据，尤其是在低通信带宽条件下，点云数据传输至操控端变得更加遥不可及。一些多机协同系统中选择在机器人之间、机器人与基站之间传输点云数据。文献“Complementary multi–modal sensor fusion for resilient robot pose estimationin subterranean environments”利用DRACO算法压缩单个点云因子图至2MB左右，并将点云因子图发送到基站执行全局优化；文献“LOCUS 2.0:Robust and computationallyefficient lidar odometry for real-time underground 3D mapping”对点云关键帧进行体素栅格下采样后传送到其他机器人与基站；田栢苓等人提出的卫星拒止环境下多无人机分布式协同定位与建图方法在多个无人机间相互发送点云特征。这些方法主要用于多机协同系统中点云数据在各机器人以及基站之间的传输，且强调的是各机器人位姿的优化问题。另外，这些方法要么没有进行点云数据压缩，要么点云数据压缩算法不够高效，例如，即使帧率为1帧/s，DRACO算法压缩单个点云因子图至2MB左右也需要2MB/s的传输带宽，体素栅格下采样在多帧之间也会积累很多重复冗余点，点云数据的传输仍然会占用极大的带宽，如果再加上图像等数据，整个传输链路将变得不堪重负，这在低通信带宽条件下是不可行的。综上所述，在低通信带宽条件下，操控端构建三维点云地图具有重要的意义，但目前还存在诸多技术问题。发明内容为了解决现有技术中的上述技术缺陷，本发明提出了一种面向低通信带宽下远程操控的操控端建图方法。实现本发明目的的技术方案为：一种面向低通信带宽下远程操控的操控端建图方法，包括如下步骤：S1：机器人端获取多传感器数据，通过同步定位与建图算法实时解算机器人在全局坐标系下的位姿，并维护一个全局坐标系下的地图；S2：机器人端通过增量点云获取算法得到增量点云，对增量点云编码压缩，并与机器人当前位姿一同发送至操控端；S3：操控端解码增量点云，创建三维点云地图，执行地图质量评估与反馈模块，评估建图质量并反馈至机器人端。优选地，机器人端获取多传感器数据，通过同步定位与建图算法实时解算机器人在全局坐标系下的位姿，并维护一个全局坐标系下的地图的具体方法为：S11：以激光雷达起始位姿作为全局坐标系位姿S12：第k时刻，无人车端实时采集激光点云数据Pk与IMU数据Ik，并通过标定参数将IMU数据转换到激光雷达坐标系下的到激光雷达坐标系下的IMU数据I′k；S13：第k时刻，激光点云数据Pk与IMU数据I′k通过迭代卡尔曼滤波器框架融合计算激光惯性里程计，得到激光雷达第k时刻在全局坐标系下的位姿S14：第k时刻，激光雷达坐标系下的激光点云数据Pk根据Tk转换到全局坐标系下，得到全局坐标系下激光点云数据S15：第k时刻全局坐标系下激光点云数据叠加到第k-1时刻的全局地图Qk-1上，得到第k时刻的全局地图Qk。优选地，机器人端通过增量点云获取算法得到增量点云具体包括以下步骤：S21：设定增量点云获取算法相关参数，包括八叉树分辨率r、点云视场角α；S22：每一时刻从当前全局地图中截取机器人正前方范围内的子地图；S23：利用分辨率为r的双缓存八叉树组织第k时刻与第k+1时刻的子地图，通过双缓存区进行异或操作得到两子地图的差异，即第k+1时刻的增量点云。优选地，S21步骤中，设定增量点云获取算法相关参数时，初始参数通过配置文件设定，之后通过操控端的反馈结果自适应调整相关参数，进而动态控制增量点云的数量。优选地，S3步骤中，创建三维点云地图的过程是在操控端进行，具体通过全局坐标系下的多帧增量点云直接叠加得到与机器人端同步的三维点云地图。优选地，执行地图质量评估与反馈模块，评估建图质量的具体方法为：S31：初始化相关参数，包括执行帧率f、局部子地图半径R、地图密度因子最小阈值Mmin与最大阈值Mmax、八叉树分辨率调整系数Δr、点云视场角调整系数Δα；S32：每间隔f帧，操控端对半径R范围内的局部子地图进行统计，包括子地图中点云数量n和每个点与最近邻域点的距离di；S33：计算点云地图密度因子S34：若满足M＞Mmax，则点云地图质量较差，调整八叉树分辨率为r＝r-Δr,调整点云视场角为α＝α+Δα；S35：若满足M＜Mmin，则点云地图较稠密，调整八叉树分辨率为r＝r+Δr,调整点云视场角为α＝α-Δα；S36：将调整后的参数发送至机器人端进行反馈。本发明与现有技术相比，其显著优点为：1、本发明开创性地在人机协同远程操控系统中使用增量点云传输技术，大大降低了人机协同远程操控系统的通信带宽要求；2、本发明在机器人端与操控端同步建图，减轻了操控人员的操控负担，提高了操控人员的操控准确度；3、本发明通过多个参数自适应地控制增量点云数量，具有更高的灵活性；4、本发明对操控端三维点云地图进行质量评估并反馈给机器人端，能够在保证操控端三维点云地图质量的情况下，节省出更多的通信链路带宽。本发明的其他特征和优点将在随后的说明书中阐述，并且，部分的从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点可通过在所写的说明书、权利要求书、以及附图中所特别指出的结构来实现和获得。附图说明附图仅用于示出具体实施例的目的，而并不认为是对本发明的限制，在整个附图中，相同的参考符号表示相同的部件。图1为面向低通信带宽下远程操控的操控端点云同步建图方法的流程图；图2为原始点云构建的三维点云地图局部示意图；图3为增量点云构建的三维点云地图局部示意图；图4为增量点云构建的三维点云地图整体示意图。附图标记说明：1-起点；2-区域1；3-区域2。具体实施方式容易理解，依据本发明的技术方案，在不变更本发明的实质精神的情况下，本领域的一般技术人员可以想象出本发明的多种实施方式。因此，以下具体实施方式和附图仅是对本发明的技术方案的示例性说明，而不应当视为本发明的全部或者视为对本发明技术方案的限制或限定。相反，提供这些实施例的目的是为了使本领域的技术人员更透彻地理解本发明。下面结合附图来具体描述本发明的优选实施例，其中，附图构成本申请一部分，并与本发明的实施例一起用于阐释本发明的创新构思。机器人端为一辆搭载40线机械式激光雷达与IMU的无人车；操控端为一台笔记本电脑。其中，无人车与操控端之间通过电台进行通信。如图1所示，面向低通信带宽下远程操控的操控端建图方法，包括如下步骤：S1：机器人端获取多传感器数据，通过同步定位与建图算法实时解算机器人在全局坐标系下的位姿，并维护一个全局坐标系下的地图；S2：机器人端通过增量点云获取算法得到增量点云，对增量点云编码压缩，并与机器人当前位姿一同发送至操控端；S3：操控端解码增量点云，创建三维点云地图，执行地图质量评估与反馈模块，评估建图质量并反馈至机器人端。具体的，步骤S1实施过程如下：S11：以激光雷达起始位姿作为全局坐标系位姿S12：第k时刻，无人车端实时采集激光点云数据Pk与IMU数据Ik，并通过标定参数将IMU数据转换到激光雷达坐标系下的到激光雷达坐标系下的IMU数据I′k；S13：第k时刻，激光点云数据Pk与IMU数据I′k通过迭代卡尔曼滤波器框架融合计算激光惯性里程计，得到激光雷达第k时刻在全局坐标系下的位姿S14：第k时刻，激光雷达坐标系下的激光点云数据Pk根据Tk转换到全局坐标系下，得到全局坐标系下激光点云数据S15：第k时刻全局坐标系下激光点云数据叠加到第k-1时刻的全局地图Qk-1上，得到第k时刻的全局地图Qk。若操控端想要与无人车端同步建图，则无人车端必须将点云数据传输至操控端，然而点云数据量是十分庞大。经实验测算，激光雷达以10帧/s的帧率运行，无人车以20km/h的速度行驶10分钟，平均每帧点云数据量达到55447个点。若只保留“x”、“y”、“z”三个表示坐标的字段且每个字段以4字节的float类型保存，则平均每帧点云占据665364字节，通信速率约为6.3454MB/s，即最少需要的通信带宽约为6.3454MB，这在低通信带宽情况下是无法满足的。增量点云传输技术可以解决上述问题，具体的，步骤S2中的增量点云获取算法在无人车端执行，实施过程如下：S21：第0时刻，从配置文件中读取八叉树分辨率r、点云视场角α等参数，其他时刻根据操控端的反馈调整八叉树分辨率r、点云视场角α等参数；S22：第k+1时刻，从当前全局地图中截取机器人正前方范围内的子地图；S23：利用分辨率为r的双缓存八叉树组织第k时刻与第k+1时刻的子地图，其中八叉树每个分支节点都有两个缓冲区，当需要创建新的子节点时，会在当前分支节点中执行对前面指针缓冲区的查找，如果找不到相关的引用指针，则创建新的子节点，且两个缓冲区都初始化为0，如果在前面的指针缓冲区中可以找到对应的子节点指针，就采用它的引用，并只是初始化所选的子指针缓冲区为0；通过双缓存区进行异或操作得到两子地图的差异，即第k+1时刻的增量点云。具体的，经实验测算，激光雷达以10帧/s的帧率运行，无人车以20km/h的速度行驶10分钟，且八叉树分辨率设为0.3m，点云视场角设为180°，平均每帧增量点云数据量为4672个点。若只保留“x”、“y”、“z”三个表示坐标的字段且每个字段以4字节的float类型保存，则平均每帧增量点云占据56064字节，通信速率约为0.5346MB/s。相同条件下，传输增量点云所需要的通信带宽要求远远小于传输原始点云所需要的通信带宽要求，且在操控端的增量建图效果与原始点云建图效果也接近一致，如图2和图3所示。此外，增量点云还可以进一步编码压缩，以无损ZIP压缩为例，平均每帧56064字节的增量点云可以压缩至51578字节，通信速率降低至约为0.4919MB/s。若使用其他更高效的压缩编码方式，所需的通信带宽要求将会更低。更具体的，激光雷达以10帧/s的帧率运行，无人车以20km/h的速度行驶10分钟，经多组实验测算，步骤S21中的读取八叉树分辨率r和点云视场角α参数能有效调整增量点云的数据量，从而灵活调整点云传输所占的通信带宽：实验一：八叉树分辨率r＝0.1m，点云视场角α＝180°，则增量点云数为10411个点，增量点云占据124932字节，ZIP编码后占据1157916字节，通信速率约为1.1035MB/s；实验二：八叉树分辨率r＝0.3m，点云视场角α＝180°，则增量点云数为4672个点，增量点云占据56064字节，ZIP编码后占据51578字节，通信速率约为0.4919MB/s；实验三：八叉树分辨率r＝0.5m，点云视场角α＝180°，则增量点云数为2547个点，增量点云占据30564字节，ZIP编码后占据28035字节，通信速率约为0.2674MB/s；实验四：八叉树分辨率r＝1.0m，点云视场角α＝180°，则增量点云数为1036个点，增量点云占据12432字节，ZIP编码后占据11592字节，通信速率约为0.1106MB/s；实验五：八叉树分辨率r＝0.5m，点云视场角α＝90°，则增量点云数为1686个点，增量点云占据20232字节，ZIP编码后占据18593字节，通信速率约为0.1773MB/s。实验一到实验四验证了八叉树分辨率能有效调整增量点云的数据量，实验三与实验五对比验证了点云视场角能有效调整增量点云的数据量。对于操控端，其建图过程十分简单。由于增量点云是在全局坐标系下求取，操控端接收编码的增量点云并进行解码，然后直接叠加到操控端维护的全局地图中即可。为保证操控端构建三维点云地图的质量，同时系统拥有更高的灵活性，引入地图质量评估与反馈模块。具体的，步骤S3中的地图质量评估与反馈模块在操控端执行，实施过程如下：S31：初始化相关参数，包括执行帧率f、局部子地图半径R、地图密度因子最小阈值Mmin与最大阈值Mmax、八叉树分辨率调整系数Δr、点云视场角调整系数Δα；S32：每间隔f帧，从操控端维护的全局地图中截取机器人半径R范围内的局部子地图，统计子地图中点云数量n，使用PCL中的KD树最近邻搜索统计子地图中每个点与最近邻域点的距离di；S33：计算点云地图密度因子S34：若满足M＞Mmax，则点云地图质量较差，调整八叉树分辨率为r＝r-Δr,调整点云视场角为α＝α+Δα；S35：若满足M＜Mmin，则点云地图较稠密，调整八叉树分辨率为r＝r+Δr,调整点云视场角为α＝α-Δα；S36：将调整后的八叉树分辨率r和点云视场角α发送至无人车端进行反馈。具体的，如图4所示，无人车以平均20km/h的速度行驶，无人车上激光雷达运行帧率为10帧/s，初始八叉树分辨率r＝0.3m，初始点云视场角为α＝180°。地图质量评估与反馈模块参数设置为：执行帧率f＝20、局部子地图半径R＝50m、地图密度因子最小阈值Mmin＝0.05与最大阈值Mmax＝0.3、八叉树分辨率调整系数Δr＝0.3m、点云视场角调整系数Δα＝90°。无人车从起点出发，绕地图一圈后第k帧回到区域1，由于区域1在之前经过时已经构建了较完整的点云地图，再叠加上第k帧的增量点云，区域1的局部子地图较稠密，经计算点云地图密度因子Mk为0.0429，由于Mk＜Mmin,调整八叉树分辨率为r＝r+Δr＝0.6m,调整点云视场角为α＝α-Δα＝90°。此时，增量点云数据的通信速率得到进一步降低。进一步的，无人车第k+20n帧到达区域2，由于此前参数调整，区域2的局部子地图较稀疏，经计算点云地图密度因子Mk为0.4355，由于Mk＞Mmax,调整八叉树分辨率为r＝r-Δr＝0.3m,调整点云视场角为α＝α+Δα＝180°。进一步的，无人车第k+20帧经计算点云地图密度因子Mk为0.0933，点云地图质量自适应地得到调整。以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。应当理解，为了精简本发明并帮助本领域的技术人员理解本发明的各个方面，在上面对本发明的示例性实施例的描述中，本发明的各个特征有时在单个实施例中进行描述，或者参照单个图进行描述。但是，不应将本发明解释成示例性实施例中包括的特征均为本专利权利要求的必要技术特征。应当理解，可以对本发明的一个实施例的设备中包括的模块、单元、组件等进行自适应性地改变以把它们设置在与该实施例不同的设备中。可以把实施例的设备包括的不同模块、单元或组件组合成一个模块、单元或组件，也可以把它们分成多个子模块、子单元或子组件。
