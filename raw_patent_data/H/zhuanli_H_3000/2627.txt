标题title
隐私数据同态加密方法、装置及系统
摘要abst
本发明涉及数据处理技术领域，提供一种隐私数据同态加密方法、装置及系统，该方法获取待加密的隐私数据；确定加密密钥以及加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对加密密钥以及目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；基于第一变换结果与第二变换结果的备选乘积结果，确定加密密钥与目标乘数的目标乘积结果；最后基于加密密钥以及目标乘积结果，对隐私数据进行同态加密。该方法通过对隐私数据进行同态加密，可以保证隐私数据的安全性。而且，利用图形处理器中的流式多处理器进行并行FFT，可以大大提升确定加密密钥与目标乘数的目标乘积结果的效率，进而可以提高对隐私数据的同态加密效率。
权利要求书clms
1.一种隐私数据同态加密方法，其特征在于，包括：获取待加密的隐私数据；确定加密密钥以及所述加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对所述加密密钥以及所述目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果；基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密。2.根据权利要求1所述的隐私数据同态加密方法，其特征在于，所述第一变换结果基于如下步骤得到：基于所述加密密钥的位数以及所述目标乘数的位数，确定FFT点数以及FFT中蝶形变换操作的轮次个数；将所述加密密钥表示为多项式，并将所述加密密钥的每个多项式系数分配至一个流式多处理器中；对于任一轮次，基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，基于所述任一轮次中每个蝶形变换操作的旋转因子以及所述多个流式多处理器，并行执行所述任一轮次中的每个蝶形变换操作。3.根据权利要求2所述的隐私数据同态加密方法，其特征在于，所述基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，包括：基于所述任一轮次，确定所述任一轮次中各蝶形变换操作的输入节点下标间隔；基于所述输入节点下标间隔以及所述FFT点数，计算所述任一轮次后的节点规模，并基于所述节点规模，确定所述任一轮次中每个蝶形变换操作的旋转因子；基于所述输入节点下标间隔以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，筛选出所述多个流式多处理器。4.根据权利要求1所述的隐私数据同态加密方法，其特征在于，所述确定加密密钥以及所述加密密钥对应的目标乘数，包括：从加密密钥集合中选取所述加密密钥，并从目标乘数集合中选取所述目标乘数；其中，所述加密密钥集合基于量子随机数发生器产生的随机数集合中位数为2的指数次幂的奇数构建，所述目标乘数集合基于所述随机数集合中位数为2的指数次幂的整数构建。5.根据权利要求1-4中任一项所述的隐私数据同态加密方法，其特征在于，所述基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密，包括：基于所述加密密钥，生成目标随机数；基于所述目标随机数以及所述目标乘积结果，对所述隐私数据进行同态加密。6.根据权利要求1-4中任一项所述的隐私数据同态加密方法，其特征在于，所述基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果，包括：将所述备选乘积结果进行IFFT，得到所述目标乘积结果。7.一种隐私数据同态加密装置，其特征在于，包括：数据获取模块，用于获取待加密的隐私数据；变换模块，用于确定加密密钥以及所述加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对所述加密密钥以及所述目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；乘积模块，用于基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果；加密模块，用于基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密。8.一种隐私数据同态加密系统，其特征在于，包括：量子随机数发生器、图形处理器及如权利要求7所述的隐私数据同态加密装置；所述量子随机数发生器、所述图形处理器以及所述隐私数据同态加密装置中任意两个均通过接口连接；所述量子随机数发生器用于为所述隐私数据同态加密装置提供加密密钥以及所述加密密钥对应的目标乘数；所述隐私数据同态加密装置用于调用所述图形处理器。9.一种电子设备，包括存储器、处理器及存储在所述存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1-6中任一项所述的隐私数据同态加密方法。10.一种非暂态计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1-6中任一项所述的隐私数据同态加密方法。
说明书desc
技术领域本发明涉及数据处理技术领域，尤其涉及一种隐私数据同态加密方法、装置及系统。背景技术随着人们对隐私数据的保护意识逐步强烈，同态加密作为广泛应用的安全技术，在隐私计算领域有巨大的功能和实用价值。同态加密的核心思想是密文可计算，指对经过同态加密的数据进行密文运算处理得到一个输出，将该输出进行解密，得到的解密结果与用同一方法处理未加密的原始数据得到的输出结果是一样的。在对隐私数据进行同态加密过程中，通常需要大量的乘法运算以及线性组合运算，过程复杂，这将大大降低对隐私数据的加密效率。为此，现急需提供一种隐私数据同态加密方法。发明内容本发明提供一种隐私数据同态加密方法、装置及系统，用以解决现有技术中存在的缺陷。本发明提供一种隐私数据同态加密方法，包括：获取待加密的隐私数据；确定加密密钥以及所述加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对所述加密密钥以及所述目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果；基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密。根据本发明提供的一种隐私数据同态加密方法，所述第一变换结果基于如下步骤得到：基于所述加密密钥的位数以及所述目标乘数的位数，确定FFT点数以及FFT中蝶形变换操作的轮次个数；将所述加密密钥表示为多项式，并将所述加密密钥的每个多项式系数分配至一个流式多处理器中；对于任一轮次，基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，基于所述任一轮次中每个蝶形变换操作的旋转因子以及所述多个流式多处理器，并行执行所述任一轮次中的每个蝶形变换操作。根据本发明提供的一种隐私数据同态加密方法，所述基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，包括：基于所述任一轮次，确定所述任一轮次中各蝶形变换操作的输入节点下标间隔；基于所述输入节点下标间隔以及所述FFT点数，计算所述任一轮次后的节点规模，并基于所述节点规模，确定所述任一轮次中每个蝶形变换操作的旋转因子；基于所述输入节点下标间隔以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，筛选出所述多个流式多处理器。根据本发明提供的一种隐私数据同态加密方法，所述确定加密密钥以及所述加密密钥对应的目标乘数，包括：从加密密钥集合中选取所述加密密钥，并从目标乘数集合中选取所述目标乘数；其中，所述加密密钥集合基于量子随机数发生器产生的随机数集合中位数为2的指数次幂的奇数构建，所述目标乘数集合基于所述随机数集合中位数为2的指数次幂的整数构建。根据本发明提供的一种隐私数据同态加密方法，所述基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密，包括：基于所述加密密钥，生成目标随机数；基于所述目标随机数以及所述目标乘积结果，对所述隐私数据进行同态加密。根据本发明提供的一种隐私数据同态加密方法，所述基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果，包括：将所述备选乘积结果进行IFFT，得到所述目标乘积结果。本发明还提供一种隐私数据同态加密装置，包括：数据获取模块，用于获取待加密的隐私数据；变换模块，用于确定加密密钥以及所述加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对所述加密密钥以及所述目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；乘积模块，用于基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果；加密模块，用于基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密。本发明还提供一种隐私数据同态加密系统，包括：量子随机数发生器、图形处理器及上述的隐私数据同态加密装置；所述量子随机数发生器、所述图形处理器以及所述隐私数据同态加密装置中任意两个均通过接口连接；所述量子随机数发生器用于为所述隐私数据同态加密装置提供加密密钥以及所述加密密钥对应的目标乘数；所述隐私数据同态加密装置用于调用所述图形处理器。本发明还提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如上述任一种所述的隐私数据同态加密方法。本发明还提供一种非暂态计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如上述任一种所述的隐私数据同态加密方法。本发明还提供一种计算机程序产品，包括计算机程序，所述计算机程序被处理器执行时实现如上述任一种所述的隐私数据同态加密方法。本发明提供的隐私数据同态加密方法、装置及系统，该方法首先获取待加密的隐私数据；然后确定加密密钥以及加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对加密密钥以及目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；此后基于第一变换结果与第二变换结果的备选乘积结果，确定加密密钥与目标乘数的目标乘积结果；最后基于加密密钥以及目标乘积结果，对隐私数据进行同态加密。该方法通过对隐私数据进行同态加密，可以保证隐私数据的安全性。而且，利用图形处理器中的流式多处理器进行并行FFT，可以大大提升确定加密密钥与目标乘数的目标乘积结果的效率，进而可以提高对隐私数据的同态加密效率。附图说明为了更清楚地说明本发明或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明提供的隐私数据同态加密方法的流程示意图；图2是本发明提供的隐私数据同态加密方法中采用的图形处理器的线程模型与硬件结构层级的对应图；图3是本发明提供的隐私数据同态加密方法中8个点的多项式的FFT变换过程示意图；图4是本发明提供的隐私数据同态加密装置的结构示意图；图5是本发明提供的隐私数据同态加密系统的结构示意图之一；图6是本发明提供的隐私数据同态加密系统的结构示意图之二；图7是本发明提供的电子设备的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。由于现有的同态加密方法在对隐私数据进行同态加密过程中，通常需要大量的乘法运算以及线性组合运算，过程复杂，这将大大降低对隐私数据的加密效率。为此，本发明实施例中提供了一种隐私数据同态加密方法。图1为本发明实施例中提供了一种隐私数据同态加密方法的流程示意图，如图1所示，该方法包括：S1，获取待加密的隐私数据；S2，确定加密密钥以及所述加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对所述加密密钥以及所述目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；S3，基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果；S4，基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密。具体地，本发明实施例中提供的隐私数据同态加密方法，其执行主体为隐私数据同态加密装置，该装置可以是中央处理器可以配置于计算机内，该计算机可以为本地计算机或云计算机，本地计算机可以是电脑、平板等，此处不作具体限定。首先执行步骤S1，获取待加密的隐私数据，该隐私数据可以是用户需要加密的数据，该隐私数据可以是十进制数据。用户可以是个人、也可以是公司、企业等，隐私数据可以是个人的人脸特征数据、身份证号码、手机号、银行卡号、银行卡密码、网页浏览记录等，也可以是公司或企业的财务数据、资金流向数据、重要客户信息等。然后执行步骤S2，确定加密密钥以及加密密钥对应的目标乘数，该加密密钥以及目标乘数均可以是随机数，均可以通过量子随机数发生器生成，此处不作具体限定。加密密钥可以为大整奇数，加密密钥对应的目标乘数可以为大整数。大整奇数即为奇数的大整数，大整数则是指其范围已经超出了基本数据类型能够表示的范围的数。图形处理器是一种专用图像渲染硬件，对各硬件具有较好的通用性和较高的性能。如图2所示GPU的线程模型21可以包括Grid、Block、Thread和Warp。Grid、Block、Thread是一种软件组织结构，是线程组织的三个层次，分别对应于硬件结构层级22的器件、流式多处理器以及统一计算设备架构核心。GPU工作时的最小单位是Thread。多个Thread可以组成一个Block，执行相同程序的多个Block，可以组成Grid。多个Block共享存储器，因此各Block间通信可视为全连通模式。基于此，在通过GPU中的SM，分别对加密密钥以及目标乘数进行并行快速傅里叶变换时，可以将FFT的并行化蝶形变换操作按层次结构分配至不同的SM中进行执行，以提高FFT的并行度。即进行并行FFT的基本思想是将FFT根据蝶形变换操作的迭代轮次进行拆分，每一轮次将相同的蝶形变换操作进行并行化，然后将GPU中的每个SM作为并行计算的一个计算节点，将并行化蝶形变换操作分配至不同的SM中从而提升FFT的并行度、提高转换效率。在通过GPU中的SM分别对加密密钥以及目标乘数进行并行FFT之前，可以先将加密密钥以及目标乘数分别表示为多项式，多项式的次数可以是加密密钥以及目标乘数的位数减一。进而，进行并行FFT的过程，即将多项式由系数表示法表示形式变换为点值表示法表示形式。设一个位的大整数，可以表示为一个次多项式，该多项式有系数表示法与点值表示法两种表示方法。系数表示法：，其中，为自变量，为因变量，为指数是的自变量的多项式系数，为次多项式中的一项，由所有项的多项式系数组成的系数向量唯一确定了这个多项式，即大整数。按系数表示法计算两个大整数相乘即两个次多项式相乘，其复杂度为。点值表示法：将一组互不相同的插值节点分别带入，得到个取值，其中。根据代数基本定理，一个次的多项式在复数域上有且仅有个根，因此一个次的多项式的个不同取值点唯一确定了该多项式。FFT是一种可在时间内完成的离散傅里叶变换算法。DFT将给定多项式的系数向量，转换为，其计算公式为:其中，为次单位根，。使用FFT将点值表示法表示形式的多项式转化为系数表示法表示形式，这个过程叫做离散傅里叶反变换，其计算公式为：其中，为次单位根，。利用单位原根的周期性、对称性和折半性，可以将多项式的多项式序列根据下标分成偶数下标项和奇数下标项两部分，分别做FFT后得到和，则的多项式序列的FFT变换结果为：这样就将点的FFT分解成了两个点的FFT，令为2的指数次幂，如此递归分解，则算法复杂度为。在上述递归过程中，从顶端开始，一层一层循环不断地拆分数组，到最底层产生最小粒度的运算结果，然后再逐层往上形成最终结果。分离下标过程中需要额外的存储空间，提升了空间复杂度。为了降低空间复杂度，从底端的结果逐层做特殊运算回到顶端。该运算称为蝴蝶操作，该操作可以将一个序列原地转换成，其空间复杂度为。为了实现蝴蝶操作，需要对序列下标进行位逆序，如下标。完成位逆序对原序列元素进行转换后，再按循环逐层进行FFT运算即可。这样算法的时间复杂度为，空间复杂度为。通过GPU中的SM对加密密钥进行并行FFT可以得到第一变换结果，通过GPU中的SM对目标乘数进行并行FFT可以得到第二变换结果。此后执行步骤S3，可以先对第一变换结果与第二变换结果进行相乘，得到第一变换结果与第二变换结果的备选乘积结果。由于第一变换结果可以看作是加密密钥的多项式的点值表示法表示形式，第二变换结果可以看作是目标乘数的多项式的点值表示法表示形式，因此对第一变换结果与第二变换结果进行相乘即对二者进行点积计算。此后，根据备选乘积结果可以确定目标乘积结果。由于备选乘积结果依然是点值表示法表示形式，因此可以通过对备选乘积结果进行快速傅里叶逆变换，得到备选乘积结果的系数表示法表示形式，即得到加密密钥与目标乘数的目标乘积结果，该目标乘积结果即为加密密钥的多项式的系数表示法表示形式与目标乘数的多项式的系数表示法表示形式的乘积。最后执行步骤S4，根据加密密钥以及目标乘积结果，通过同态加密算法对隐私数据进行同态加密。同态加密算法可以包括全同态加密算法、部分同态加密算法以及近似同态加密算法等。若某一同态加密算法得到的密文数据能够执行无限次加法和乘法运算操作，则该同态加密算法为完全同态加密算法，简称全同态加密算法。以整数上的全同态加密方案为例，DGHV属于对称加密，通常包括密钥生成阶段、加密算法阶段、解密算法阶段和同态计算阶段等。密钥生成阶段根据安全参数λ，KeyGen选取N位的奇数作为加密密钥p，为了提高算法安全性，p应为大整数。该加密秘钥可以通过随机数发生器产生。加密阶段的加密方案可表示为c=p×q+2r+m，m为待加密的隐私数据，p为加密密钥，q为目标乘数，p×q为目标乘积结果，p、q均为随机大整数，r为目标随机数，通常为小整数，可以通过p确定。r与p的关系可以表示为|2r|＜|p/2|。c为对隐私数据m进行同态加密得到的加密结果。在对隐私数据进行同态加密过程中，可以按位对隐私数据进行同态加密，即m是隐私数据的任意一位，m的取值空间为{0，1}，c的取值空间即密文空间为整数。需要说明的是，先基于图形处理器中的流式多处理器，分别对加密密钥以及目标乘数进行并行FFT，得到第一变换结果以及第二变换结果，即用系数表示法分别将加密密钥以及目标乘数表示为一个多项式，并将加密密钥的多项式以及目标乘数的多项式均由系数表示法表示形式变换为点值表示法表示形式。该过程的时间复杂度为，N为加密密钥的多项式系数的个数。此后，确定第一变换结果与第二变换结果的备选乘积结果，即在点值表示法表示形式下计算多项式乘法，该过程的时间复杂度为。最后，通过备选乘积结果确定加密密钥与目标乘数的目标乘积结果，即通过IFFT将备选乘积结果的点值表示法表示形式转化为系数表示法表示形式，得到最终的目标乘积结果，该过程的时间复杂度为。通过上述三个过程，确定加密密钥以及目标乘数的目标乘积结果时的总时间复杂度为。由此可知，由于通过图形处理器中的流式多处理器，分别对加密密钥以及目标乘数进行并行FFT，可以将确定加密密钥与目标乘数的目标乘积结果的时间复杂度降到了，而现有的基于分治法确定两个大整数的乘积结果的方案，其时间复杂度高达，本发明实施例中提供的隐私数据同态加密方法相比于现有方案，可以大大提升同态加密效率。本发明实施例中提供的隐私数据同态加密方法，首先获取待加密的隐私数据；然后确定加密密钥以及加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对加密密钥以及目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；此后基于第一变换结果与第二变换结果的备选乘积结果，确定加密密钥与目标乘数的目标乘积结果；最后基于加密密钥以及目标乘积结果，对隐私数据进行同态加密。该方法通过对隐私数据进行同态加密，可以保证隐私数据的安全性。而且，利用图形处理器中的流式多处理器进行并行FFT，可以大大提升确定加密密钥与目标乘数的目标乘积结果的效率，进而可以提高对隐私数据的同态加密效率。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密方法，所述第一变换结果基于如下步骤得到：基于所述加密密钥的位数以及所述目标乘数的位数，确定FFT点数以及FFT中蝶形变换操作的轮次个数；将所述加密密钥表示为多项式，并将所述加密密钥的每个多项式系数分配至一个流式多处理器中；对于任一轮次，基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，基于所述任一轮次中每个蝶形变换操作的旋转因子以及所述多个流式多处理器，并行执行所述任一轮次中的每个蝶形变换操作。具体地，本发明实施例中，在基于GPU中的SM，对加密密钥进行并行FFT得到第一变换结果时，可以先基于加密密钥的位数以及目标乘数的位数，确定FFT点数以及FFT中蝶形变换操作的轮次个数。例如，可以根据加密密钥的位数以及目标乘数的位数，确定加密密钥与目标乘数的目标乘积结果的最大位数。由于FFT点数N需要是2的指数次幂，因此可以选取大于或等于该最大位数的2的指数次幂中的最小值作为FFT点数N。FFT中蝶形变换操作的轮次个数则可以直接根据FFT点数N确定，即为。此后，可以将加密密钥表示为多项式，该多项式的项数与FFT点数N相等。相应地，该多项式的每一项均对应有一个多项式系数，多项式系数的个数与多项式的项数相等。对于具有个点的多项式的FFT，有如下特点：1）FFT过程整体可以分为轮蝶形变换操作，每一轮次中有个蝶形变换单元；2）每一轮次中，不同蝶形变换单元之间的蝶形变换操作并行执行；3）在FFT的每一轮次中，单位根也称为旋转因子。每一轮次的旋转因子为，，其中t是指每一轮次递归分解后的节点规模，取值随递归的轮次逐级减半。4）令，则在轮，每个蝶形变换单元的输入节点相隔个点，即蝶形变换操作的输入节点下标间隔为。以具有个点的多项式的FFT为例，如图3所示：1）FFT过程整体分为轮蝶形变换操作，每一轮次中有个蝶形变换单元，即图3中的矩形框。2）每一轮次中，不同蝶形变换单元之间的计算可以并行开展；3）在轮，该轮次对应递归分解的最底层，所以节点规模，即，因此该轮次的旋转因子为；在轮，该轮次节点规模为上一轮次的2倍，所以，即，因此该轮次的旋转因子为、；在轮，该轮次对应递归分解的最顶层，所以节点规模，即，因此该轮次的旋转因子为；4）在轮，每个蝶形变换单元的输入节点相隔个点，节点下标间隔为；在轮，每个蝶形变换单元的输入节点相隔个点，节点下标间隔为2；在轮，每个蝶形变换单元的输入节点相隔个点，节点下标间隔为1。需要说明的是，图3中均为多项式系数的系数表示法表示形式，均为多项式系数的点值表示法表示形式。此后，可以将加密密钥的每个多项式系数分配至一个流式多处理器中，例如将加密密钥的第k个多项式系数分配至第k个流式多处理器中。进而，对于任一轮次，基于任一轮次、FFT点数N以及每个流式多处理器中分配的多项式系数在多项式中的位置，确定出任一轮次h中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器。例如，可以先根据任一轮次h以及FFT点数N，确定出任一轮次h中每个蝶形变换操作的旋转因子，然后再根据每个流式多处理器中分配的多项式系数在多项式中的位置k，筛选出可以用于进行任一轮次h中各蝶形变换操作的多个流式多处理器。筛选出的流式多处理器的个数与任一轮次h中蝶形变换操作的个数相等。最后，根据任一轮次h中每个蝶形变换操作的旋转因子以及多个流式多处理器，并行执行任一轮次h中的每个蝶形变换操作。即对于任一轮次h，筛选出的每个流式多处理器对应一个蝶形变换单元，任一轮次h中的所有蝶形变换单元的蝶形变换操作通过对应的流式多处理器并行执行，每个流式多处理器则通过对应的Block实现执行动作。本发明实施例中，在每一轮次中，通过筛选出的多个流式多处理器，结合每一轮次中每个蝶形变换操作的旋转因子，并行执行每一轮次中的每个蝶形变换操作，如此可以大大提高蝶形变换操作的执行效率，进而提高第一变换结果的确定效率。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密方法，所述第二变换结果基于如下步骤得到：基于所述加密密钥的位数以及所述目标乘数的位数，确定FFT点数以及FFT中蝶形变换操作的轮次个数；将所述目标乘数表示为多项式，并将所述目标乘数的每个多项式系数分配至一个流式多处理器中；对于任一轮次，基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，基于所述任一轮次中每个蝶形变换操作的旋转因子以及所述多个流式多处理器，并行执行所述任一轮次中的每个蝶形变换操作。具体地，本发明实施例中，确定第二变换结果的步骤与上述实施例中确定第一变换结果的步骤是一致的，不同点仅在于上述实施例中是将加密密钥表示为多项式并利用其多项式系数的位置，而本发明实施例中是将目标乘数表示为多项式并利用其多项式系数的位置，详细内容参见上述实施例，此处不再赘述。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密方法，所述基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，包括：基于所述任一轮次，确定所述任一轮次中各蝶形变换操作的输入节点下标间隔；基于所述输入节点下标间隔以及所述FFT点数，计算所述任一轮次后的节点规模，并基于所述节点规模，确定所述任一轮次中每个蝶形变换操作的旋转因子；基于所述输入节点下标间隔以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，筛选出所述多个流式多处理器。具体地，本发明实施例中，在确定任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器时，可以先根据任一轮次h，确定任一轮次h中各蝶形变换操作的输入节点下标间隔s，即各蝶形变换单元的输入节点下标间隔，例如可以有。此后，可以根据输入节点下标间隔s以及FFT点数N，计算任一轮次h后的节点规模t，例如可以有。根据该节点规模t，则可以确定出任一轮次h中每个蝶形变换操作的旋转因子。最后，根据输入节点下标间隔t以及每个流式多处理器中分配的多项式系数在所述多项式中的位置k，可以筛选出多个流式多处理器。例如，对于第k个流式多处理器，筛选条件可以是，即若满足筛选条件，则说明可以在任一轮次h中通过对应的执行一个蝶形变换单元的蝶形变换操作，任一轮次h中所有满足筛选条件的流式多处理器通过对应的并行执行任一轮次h中各蝶形变换单元的蝶形变换操作。在上述实施例的基础上，并行FFT算法的伪代码可以表示为：//将中的按顺序进行编号//输入数组用于存放加密密钥或目标乘数的多项式系数//结果数组用于存放第一变换结果或第二变换结果//分配至中，分配至中，为定义的变量用于协助计算{ //所有并行执行 //快速傅里叶变换，共进行轮 //表示本轮次蝶形变换单元的输入节点下标间隔； //表示本轮次对应的递归分解的节点规模； //本轮次的 //筛选出本轮次满足筛选条件的，每个对应本轮次中一个蝶形变换单元，所有的蝶形变换单元的蝶形变换操作并行执行为的位取反为的位取反；//将第一变换结果或第二变换结果存入数组B，为的位取反}对并行FFT算法的时间复杂度分析：并行FFT算法针对每个迭代轮次的蝶形变换操作均实现了并行化，其时间复杂度为常数即，按二分法递归迭代了轮，因此复杂度为。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密方法，所述确定加密密钥以及所述加密密钥对应的目标乘数，包括：从加密密钥集合中选取所述加密密钥，并从目标乘数集合中选取所述目标乘数；其中，所述加密密钥集合基于量子随机数发生器产生的随机数集合中位数为2的指数次幂的奇数构建，所述目标乘数集合基于所述随机数集合中位数为2的指数次幂的整数构建。具体地，本发明实施例中，在确定加密密钥以及加密密钥对应的目标乘数时，可以直接从加密密钥集合中选取加密密钥，并从目标乘数集合中选取目标乘数。加密密钥集合以及目标乘数集合均为随机大整数构成的集合。加密密钥集合可以通过量子随机数发生器产生的随机数集合中位数为2的指数次幂的奇数构建得到，即加密密钥集合中的加密密钥均是位数为2的指数次幂的奇数，且是随机数。目标乘数集合通过量子随机数发生器产生的随机数集合中位数为2的指数次幂的整数构建得到，即目标乘数集合中的目标乘数均是位数为2的指数次幂的整数，且是随机数。可以理解的是，随机数集合中存储有量子随机数发生器产生的量子随机数。与伪随机数相比，量子随机数的随机性是来源于经典物理的随机源，该随机源能产生完全不可预知的随机序列。量子随机数发生器采用激光相位波动作为随机源，激光相位波动本质来源于自发辐射，属于非确定性的量子噪声，其测量结果符合高斯分布，是良好的量子随机源。量子随机数发生器上电后独立工作，不依靠任何外部触发信号源，上电后即可持续对外输出二进制随机数序列。本发明实施例中，可以从随机数集合中筛选出位数为2的指数次幂的奇数作为加密密钥存入加密密钥集合，可以从随机数集合中筛选出位数为2的指数次幂的整数作为目标乘数存入目标乘数集合。本发明实施例中，在同态加密过程中可以直接从加密密钥集合中读取加密密钥，并从目标乘数集合中读取目标乘数，产生物理真随机数的同时提升随机数生成效率，也进一步提高了同态加密效率。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密方法，所述基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密，包括：基于所述加密密钥，生成目标随机数；基于所述目标随机数以及所述目标乘积结果，对所述隐私数据进行同态加密。具体地，本发明实施例中，在结合加密密钥以及目标乘积结果，对隐私数据进行同态加密时，可以先根据加密密钥，生成目标随机数。即对于加密密钥p，由于目标随机数r与加密密钥p的关系为|2r|＜|p/2|，因此在生成目标随机数r时，需要借助于加密密钥p，只要能够满足上述关系的小整数均可，如此可以确保同态加密结果能被正确解密。此后，可以根据目标随机数r以及目标乘积结果p×q，对隐私数据m进行同态加密，即利用公式c=p×q+2r+m计算出隐私数据m的同态加密结果c。本发明实施例中，目标随机数的引入，可以进一步保证对隐私数据的加密效果。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密方法，所述基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果，包括：将所述备选乘积结果进行IFFT，得到所述目标乘积结果。具体地，本发明实施例中，由于第一变换结果与第二变换结果均是并行FFT得到的，因此需要将二者的备选乘积结果进行快速傅里叶逆变换，进而得到加密密钥与目标乘数的目标乘积结果。在上述实施例的基础上，本发明实施例中给出并行FFT算法的运行示例，其中仅以计算小整数相乘为例，而对于大整数同样使用，且加速效果更明显。例如：通过并行FFT算法，计算。31与24相乘，结果最大位数为4，即。对于一个4位的整数，可以表示为。因此被乘数31的多项式系数表达向量为：；乘数24的多项式系数表达向量为：。并行FFT算法的执行过程如下：初始：，所有Block并行执行赋值操作，中；中；中；中。第轮次：；满足 的Block为和；中；中；第轮：；满足的Block为和；中，；中 ，；并行FFT算法的运算结果为：，，，。即根据并行FFT算法，的多项式系数转化为点值表达式表示形式为：，此时。因此，被乘数31的并行FFT结果为；乘数24的并行FFT结果为。对被乘数31的并行FFT结果与乘数24的并行FFT结果进行点积，得到点积结果为。对于点积结果进行IFFT，变换公式为。IFFT结果计算公式可以表示为：，，，。此时，，，，，，带入IFFT结果计算公式，可以得到IFFT结果为。即有。如图4所示，在上述实施例的基础上，本发明实施例中提供了一种隐私数据同态加密装置，包括：数据获取模块41，用于获取待加密的隐私数据；变换模块42，用于确定加密密钥以及所述加密密钥对应的目标乘数，并基于图形处理器中的流式多处理器，分别对所述加密密钥以及所述目标乘数进行并行FFT，得到第一变换结果以及第二变换结果；乘积模块43，用于基于所述第一变换结果与所述第二变换结果的备选乘积结果，确定所述加密密钥与所述目标乘数的目标乘积结果；加密模块44，用于基于所述加密密钥以及所述目标乘积结果，对所述隐私数据进行同态加密。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密装置，所述变换模块具体用于：基于所述加密密钥的位数以及所述目标乘数的位数，确定FFT点数以及FFT中蝶形变换操作的轮次个数；将所述加密密钥表示为多项式，并将所述加密密钥的每个多项式系数分配至一个流式多处理器中；对于任一轮次，基于所述任一轮次、所述FFT点数以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，确定所述任一轮次中每个蝶形变换操作的旋转因子，并筛选出多个流式多处理器，基于所述任一轮次中每个蝶形变换操作的旋转因子以及所述多个流式多处理器，并行执行所述任一轮次中的每个蝶形变换操作。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密装置，所述变换模块具体用于：基于所述任一轮次，确定所述任一轮次中各蝶形变换操作的输入节点下标间隔；基于所述输入节点下标间隔以及所述FFT点数，计算所述任一轮次后的节点规模，并基于所述节点规模，确定所述任一轮次中每个蝶形变换操作的旋转因子；基于所述输入节点下标间隔以及每个流式多处理器中分配的多项式系数在所述多项式中的位置，筛选出所述多个流式多处理器。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密装置，所述变换模块具体用于：从加密密钥集合中选取所述加密密钥，并从目标乘数集合中选取所述目标乘数；所述隐私数据同态加密装置还包括集合构建模块，用于：基于量子随机数发生器产生的随机数集合中位数为2的指数次幂的奇数，构建所述加密密钥集合，并基于所述随机数集合中位数为2的指数次幂的整数，构建所述目标乘数集合。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密装置，所述加密模块具体用于：基于所述加密密钥，生成目标随机数；基于所述目标随机数以及所述目标乘积结果，对所述隐私数据进行同态加密。在上述实施例的基础上，本发明实施例中提供的隐私数据同态加密装置，所述乘积模块具体用于：将所述备选乘积结果进行IFFT，得到所述目标乘积结果。具体地，本发明实施例中提供的隐私数据同态加密装置中各模块的作用与上述方法类实施例中各步骤的操作流程是一一对应的，实现的效果也是一致的，具体参见上述实施例，本发明实施例中对此不再赘述。隐私数据同态加密装置的CPU级主程序可以包括：main//分别从加密密钥集合中选取N位加密密钥以及从目标乘数集合中选取N位目标乘数；//N位加密密钥；//N位目标乘数Q；//数组A用于存放加密密钥的多项式系数；//数组B用于存放加密密钥的第一变换结果的多项式系数；//数组C用于存放目标乘数Q的第二变换结果的多项式系数将的多项式系数存入A，即；；//利用并行FFT转换乘数将的多项式系数存入A，即；；//利用并行FFT转换乘数//*计算点积相乘得到的备选乘积结果*////将备选乘积结果进行IFFT，得到转换结果存入数组C，将数组C用系数表达式表示得到目标乘积结果。如图5所示，在上述实施例的基础上，本发明实施例中提供了一种隐私数据同态加密系统，包括：量子随机数发生器51、图形处理器52以及上述各实施例中提供的隐私数据同态加密装置53；量子随机数发生器51、图形处理器52以及隐私数据同态加密装置53中任意两个均通过接口连接；量子随机数发生器51用于为隐私数据同态加密装置提供加密密钥以及加密密钥对应的目标乘数；隐私数据同态加密装置53用于调用图形处理器52。具体地，本发明实施例中，如图6所示，量子随机数发生器51可以配置于随机数生成设备61中，随机数生成设备61中还包括判断单元611、存储单元612以及第一I/O接口613，通过判断单元611对量子随机数发生器51产生的随机数进行判断筛选，分别确定出加密密钥集合、目标乘数集合以及目标随机数集合，并通过存储单元612进行存储。隐私数据同态加密装置53可以配置于计算机62中，计算机62中还包括内存621以及第二I/O接口622，通过第二I/O接口622与第一I/O接口613，可以从存储单元612中存储的加密密钥集合、目标乘数集合以及目标随机数集合中分别选取加密密钥、目标乘数以及目标随机数。图形处理器52可以配置于图形处理器设备63中，图形处理器设备63还包括存储631以及第三I/O接口632，隐私数据同态加密装置53可以通过第二I/O接口622与第三I/O接口632，调用图形处理器52。本发明实施例中提供的隐私数据同态加密系统，通过量子随机数发生器、图形处理器以及上述各实施例中提供的隐私数据同态加密装置相结合，不仅能够实现在对隐私数据进行同态加密过程中进行并行FFT，可以大大提高同态加密的效率。而且，引入量子随机数发生器，可以保证同态加密的效果。图7示例了一种电子设备的实体结构示意图，如图7所示，该电子设备可以包括：处理器710、通信接口720、存储器730和通信总线740，其中，处理器710，通信接口720，存储器730通过通信总线740完成相互间的通信。处理器710可以调用存储器730中的逻辑指令，以执行上述各实施例中提供的隐私数据同态加密方法。此外，上述的存储器730中的逻辑指令可以通过软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。另一方面，本发明还提供一种计算机程序产品，所述计算机程序产品包括计算机程序，计算机程序可存储在非暂态计算机可读存储介质上，所述计算机程序被处理器执行时，计算机能够执行上述各实施例中提供的隐私数据同态加密方法。又一方面，本发明还提供一种非暂态计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现以执行上述各实施例中提供的隐私数据同态加密方法。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到各实施方式可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在计算机可读存储介质中，如ROM/RAM、磁碟、光盘等，包括若干指令用以使得一台计算机设备执行各个实施例或者实施例的某些部分所述的方法。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
