标题title
一种在智能网卡/DPU内对多服务大流量功耗优化方法及装置
摘要abst
本发明提出了一种在智能网卡/DPU内对多服务大流量数据流功耗优化的方法。针对5G eMBB场景应用对网络的带宽要求高，对延迟不敏感的特点，对智能网卡/DPU内RAMs存储区间不使用单一频率，而创建三种不同频率的RAMs存储区间，同时，根据多服务大流量数据流的延迟及吞吐率需求，计算出数据流所对应的存储区域的频率，由此，降低芯片内部分RAMs的频率，从而降低芯片内的功率损耗。
权利要求书clms
1.一种在智能网卡/DPU内对多服务大流量功耗优化方法，其特征在于：包括如下步骤：S1、根据智能网卡/DPU所支持速率的最大值所对应的RAMs频率，在智能网卡/DPU内创建若干个不同频率的RAMs存储区间；S2、当有报文进入智能网卡/DPU，对报文进行解析，根据流表匹配出多服务大流量数据流；S3、根据S2中多服务大流量数据流的延迟需求，计算权重值；S4、根据S2中多服务大流量数据流的带宽需求以及S3中的权重值，计算出多服务大流量数据流对应频率的RAMs存储区间；S5、根据S4的计算结果，令多服务大流量数据流进入对应频率的RAMs存储区间；将数据发送至服务器端。2.如权利要求1所述的一种在智能网卡/DPU内对多服务大流量功耗优化方法，其特征在于：步骤S1中，根据智能网卡/DPU所支持速率的最大值所对应的RAM频率，在智能网卡/DPU内创建三个RAMs存储区间；三个RAMs存储区间的频率分别为， /2和/4。3.如权利要求1所述的一种在智能网卡/DPU内对多服务大流量功耗优化方法，其特征在于，步骤S3具体包括如下子步骤：S31、获取智能网卡/DPU最大延迟；获取多服务大流量数据流的延迟；S32、根据智能网卡/DPU最大延迟与多服务大流量数据流的延迟的比值，计算权重值。4.如权利要求3所述的一种在智能网卡/DPU内对多服务大流量功耗优化方法，其特征在于，所述S32中，若多服务大流量数据流的延迟大于智能网卡/DPU最大延迟的四倍，则令多服务大流量数据流的延迟等于智能网卡/DPU最大延迟的四倍。5.如权利要求1所述的一种在智能网卡/DPU内对多服务大流量功耗优化方法，其特征在于，步骤S4具体包括如下子步骤：S41、获取多服务大流量数据流的吞吐率和多服务大流量数据流的个数，结合智能网卡/DPU所支持速率的最大值所对应的RAMs频率和多服务大流量数据流的权重值，计算区间参数；S42、根据区间参数和步骤S1中不同频率的RAMs存储区间的大小关系，确定多服务大流量数据流对应频率的RAMs存储区间。6.一种在智能网卡/DPU内对多服务大流量功耗优化装置，其特征在于，包括存储器和一个或多个处理器，所述存储器中存储有可执行代码，所述一个或多个处理器执行所述可执行代码时，用于实现权利要求1-5任一项所述的一种在智能网卡/DPU内对多服务大流量功耗优化方法。7.一种计算机可读存储介质，其特征在于：其上存储有程序，该程序被处理器执行时，实现权利要求1-5任一项所述的一种在智能网卡/DPU内对多服务大流量功耗优化方法。
说明书desc
技术领域本发明涉及智能网卡/DPU技术领域，特别涉及一种在智能网卡/DPU内对多服务大流量功耗优化方法及装置。背景技术5G的关键目标主要集中在对三大应用场景的支持，比如 uRLLC场景应用对网络的响应时间及延迟有着很高的要求，mMTC场景对带宽及延迟不敏感，但是对海量的连接有着很高的要求， eMBB场景应用对网络的带宽有着很高的要求，对延迟不敏感，而智能网卡/DPU做为网络的终端，目前为满足eMBB多服务大流量场景，需要内部大量的存储空间，这些存储空间按照对延迟敏感的频率配置，这就增加了芯片内布局布线的难度，且增加了芯片内的功率损耗。发明内容本发明的目的在于提供一种在智能网卡/DPU内对多服务大流量功耗优化方法及装置，以克服现有技术中的不足。为实现上述目的，本发明提供如下技术方案：本申请公开了一种在智能网卡/DPU内对多服务大流量功耗优化的方法，包括如下步骤：S1、根据智能网卡/DPU所支持速率的最大值所对应的RAMs频率，在智能网卡/DPU内创建若干个不同频率的RAMs存储区间；S2、当有报文进入智能网卡/DPU，对报文进行解析，根据流表匹配出多服务大流量数据流；S3、根据S2中多服务大流量数据流的延迟需求，计算权重值；S4、根据S2中多服务大流量数据流的带宽需求以及S3中的权重值，计算出多服务大流量数据流对应频率的RAMs存储区间；S5、根据S4的计算结果，令多服务大流量数据流进入对应频率的RAMs存储区间；将数据发送至服务器端。作为优选，步骤S1中，根据智能网卡/DPU所支持速率的最大值所对应的RAM频率，在智能网卡/DPU内创建三个RAMs存储区间；三个RAMs存储区间的频率分别为， /2和/4。作为优选，步骤S3具体包括如下子步骤：S31、获取智能网卡/DPU最大延迟；获取多服务大流量数据流的延迟；S32、根据智能网卡/DPU最大延迟与多服务大流量数据流的延迟的比值，计算权重值。作为优选，所述S32中，若多服务大流量数据流的延迟大于智能网卡/DPU最大延迟的四倍，则令多服务大流量数据流的延迟等于智能网卡/DPU最大延迟的四倍。作为优选，步骤S4具体包括如下子步骤：S41、获取多服务大流量数据流的吞吐率和多服务大流量数据流的个数，结合智能网卡/DPU所支持速率的最大值所对应的RAMs频率和多服务大流量数据流的权重值，计算区间参数；S42、根据区间参数和步骤S1中不同频率的RAMs存储区间的大小关系，确定多服务大流量数据流对应频率的RAMs存储区间。本发明一种在智能网卡/DPU内对多服务大流量功耗优化的装置，包括存储器和一个或多个处理器，所述存储器中存储有可执行代码，所述一个或多个处理器执行所述可执行代码时，用于实现上述的一种在智能网卡/DPU内对多服务大流量功耗优化的方法。本发明一种计算机可读存储介质，其上存储有程序，该程序被处理器执行时，实现上述的一种在智能网卡/DPU内对多服务大流量功耗优化的方法。本发明的有益效果：本发明一种在智能网卡/DPU内对多服务大流量功耗优化方法及装置，通过在智能网卡/DPU内创建若干个不同频率的RAMs存储区间，令多服务大流量数据流进入对应频率的RAMs存储区间，由此，降低芯片内部分RAMs的频率，从而降低芯片内的功率损耗。本发明的特征及优点将通过实施例结合附图进行详细说明。附图说明图1是本发明一种在智能网卡/DPU内对多服务大流量功耗优化的方法的流程示意图；图2是本发明一种在智能网卡/DPU内对多服务大流量功耗优化的装置的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚明了，下面通过附图及实施例，对本发明进行进一步详细说明。但是应该理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限制本发明的范围。此外，在以下说明中，省略了对公知结构和技术的描述，以避免不必要地混淆本发明的概念。参阅图1，一种在智能网卡/DPU内对多服务大流量功耗优化的方法的流程示意图：1、如有报文进入智能网卡/DPU内，对报文进行解析，根据流表匹配出多服务大流量数据流类型；例如：一个25GbE智能网卡/DPU，最大延迟为2us，根据流表规则，源IP地址为192.168.0.0/16的流为多服务大流量数据流类型，其中数据流1为192.168.0.1延迟需求为3us，吞吐率为6Gbps，数据流2为192.168.0.2延迟需求为4us，吞吐率为2Gbps，数据流3为192.168.0.2延迟需求为10us，吞吐率为8Gbps。2、针对多服务大流量数据，在智能网卡/DPU内创建三种不同频率的RAMs存储区间， /2， /4，其中为智能网卡/DPU所支持速率的最大值所对应的RAM频率；例如，对25GbE智能网卡/DPU来说，，/2=161MHz，/4=81MHz。3、针对多服务大流量数据流的延迟需求，按照延迟需求计算权重值，则数据流1权重值，数据流2权重值，数据流3权重值 。4、针对数据流的吞吐率需求，计算出数据流对应的频率参数 ，举例中，数据流1：，=6Gbps，数据流2：，=2Gbps，数据流3: ，=8Gbps，则；；；当＜=/4，则/4；当，则/2 ；当，则，则数据流1对应的RAMs存储区间的频率为322MHz，数据流2对应的RAMs存储区间的频率为81MHz，数据流3对应的RAMs存储区间的频率为161MHz。5、相应数据流进入相应频率的RAMs，然后发送数据至服务器端。通过在基于Xilinx Ultrascale的FPGA中实现 600个Block RAMs为例，如果都运行在322MHz时钟下，功耗为0.495W，如果实现200个运行在322MHz时钟下，200个运行在161MHz下，200个运行在81MHz下，功耗为0.398W。 因此可以降低/0.495=19.6%的功耗。本发明一种在智能网卡/DPU内对多服务大流量功耗优化的装置的实施例可以应用在任意具备数据处理能力的设备上，该任意具备数据处理能力的设备可以为诸如计算机等设备或装置。装置实施例可以通过软件实现，也可以通过硬件或者软硬件结合的方式实现。以软件实现为例，作为一个逻辑意义上的装置，是通过其所在任意具备数据处理能力的设备的处理器将非易失性存储器中对应的计算机程序指令读取到内存中运行形成的。从硬件层面而言，如图2所示，为本发明一种在智能网卡/DPU内对多服务大流量功耗优化的装置所在任意具备数据处理能力的设备的一种硬件结构图，除了图2所示的处理器、内存、网络接口、以及非易失性存储器之外，实施例中装置所在的任意具备数据处理能力的设备通常根据该任意具备数据处理能力的设备的实际功能，还可以包括其他硬件，对此不再赘述。上述装置中各个单元的功能和作用的实现过程具体详见上述方法中对应步骤的实现过程，在此不再赘述。对于装置实施例而言，由于其基本对应于方法实施例，所以相关之处参见方法实施例的部分说明即可。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本发明方案的目的。本领域普通技术人员在不付出创造性劳动的情况下，即可以理解并实施。本发明实施例还提供一种计算机可读存储介质，其上存储有程序，该程序被处理器执行时，实现上述实施例中的一种在智能网卡/DPU内对多服务大流量功耗优化的装置。所述计算机可读存储介质可以是前述任一实施例所述的任意具备数据处理能力的设备的内部存储单元，例如硬盘或内存。所述计算机可读存储介质也可以是任意具备数据处理能力的设备的外部存储设备，例如所述设备上配备的插接式硬盘、智能存储卡、SD卡、闪存卡(Flash Card）等。进一步的，所述计算机可读存储介质还可以既包括任意具备数据处理能力的设备的内部存储单元也包括外部存储设备。所述计算机可读存储介质用于存储所述计算机程序以及所述任意具备数据处理能力的设备所需的其他程序和数据，还可以用于暂时地存储已经输出或者将要输出的数据。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换或改进等，均应包含在本发明的保护范围之内。
