标题title
一种SSL VPN转发方法、装置、系统及存储介质
摘要abst
本发明公开了一种SSL VPN转发方法、装置、系统及存储介质，应用于VPN领域，包括：客户端和服务端的虚拟网卡均配置了I Pv4和I Pv6格式的I P地址，且能够转换为相同的十六进制整数；当应答包为I Pv4格式时，或者当应答包为I Pv6格式且目的I P的前96位为全零时，根据数据包的目的I P转化为十六进制整数并从信息表中确定节点，根据节点信息将应答包转发到客户端虚拟网卡，以使用户接收应答包。本方法避免了服务端与客户端管理维护多个虚拟网卡及多种格式虚拟I P，对于服务端运维人员及客户端用户而言，降低了使用难度，在实现同时支持I Pv4与I Pv6数据包转发的同时，并未额外增加专用网络设备，不会提高运营成本。
权利要求书clms
1.一种SSL VPN转发方法，其特征在于，应用于服务端，包括：接收与所述服务端建立隧道的客户端发送的数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；将所述数据包发送到用户服务上；接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；当所述应答包为IPv4格式，则执行查找步骤；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤；其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。2.根据权利要求1所述的SSL VPN转发方法，其特征在于，所述根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，包括：根据所述整数从所述信息表中查找对应的所述节点；利用所述节点的隧道信息对所述应答包进行加密得到加密应答包；利用所述节点的TCP链接信息将所述加密应答包转发到所述客户端虚拟网卡；其中所述信息表包括：所述TCP链接信息和所述隧道信息构成的节点信息，以及登录认证后自动生成的IPv4格式IP地址转换为十六进制的整数构成的键值信息。3.一种SSL VPN转发方法，其特征在于，应用于客户端，包括：向与所述客户端建立隧道的服务端发送数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使所述服务端将所述数据包发送到用户服务上，接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；接收所述服务端利用节点转发的应答包；其中所述节点为当所述应答包为IPv4格式，则所述服务端执行查找步骤确定的节点；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤确定的节点，其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找；将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。4.根据权利要求3所述的SSL VPN转发方法，其特征在于，所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包，包括：根据所述数据包的目的IP与VPN资源的路由地址筛选属于所述VPN资源的数据包作为所述数据包。5.根据权利要求4所述的SSL VPN转发方法，其特征在于，所述根据所述数据包的目的IP与VPN资源的路由地址筛选属于所述VPN资源的数据包作为所述数据包，包括：若所述数据包为IPv4格式，则根据IPv4规范的子网掩码位数进行比较筛选属于所述VPN资源的数据包作为所述数据包；若所述数据包为IPv6格式，则根据IPv6规范的前缀标识长度进行比较筛选属于所述VPN资源的数据包作为所述数据包。6.根据权利要求3所述的SSL VPN转发方法，其特征在于，所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包，包括：若路由地址为IPv4格式，则将所述路由地址添加到终端的IPv4路由表中,并指定所述路由地址的下一跳为所述客户端虚拟网卡；若所述路由地址为IPv6格式，则将所述路由地址添加到所述终端的IPv6路由表中,并指定所述路由地址的下一跳为所述客户端虚拟网卡；所述操作系统根据所述IPv4路由表和所述IPv6路由表确定所述用户访问地址对应的数据包，并根据所述指定所述路由地址的下一跳为所述客户端虚拟网卡，将所述数据包发送到所述客户端虚拟网卡。7.一种SSL VPN转发装置，其特征在于，应用于服务端，包括：第一接收模块，用于接收与所述服务端建立隧道的客户端发送的数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；第一发送模块，用于将所述数据包发送到用户服务上；第二接收模块，用于接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；第二发送模块，用于当所述应答包为IPv4格式，则执行查找步骤；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零,则执行所述查找步骤；其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。8.一种SSL VPN转发装置，其特征在于，应用于客户端，包括：第三发送模块，用于向与所述客户端建立隧道的服务端发送数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使所述服务端将所述数据包发送到用户服务上，接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；第三接收模块，用于接收所述服务端利用节点转发的应答包；其中所述节点为当所述应答包为IPv4格式，则所述服务端执行查找步骤确定的节点；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤确定的节点，其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找；转发模块，用于将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。9.一种SSL VPN转发系统，其特征在于，包括：客户端，用于向与所述客户端建立隧道的服务端发送数据包，接收所述服务端利用节点转发的应答包，将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；所述服务端，用于将所述数据包发送到用户服务上；接收所述用户服务发出的应答包并发送到服务端虚拟网卡；当所述应答包为IPv4格式，则执行查找步骤；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤；其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包；其中所述客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数。10.一种存储介质，其特征在于，所述存储介质中存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1至2和/或3至6任一项所述的SSL VPN转发方法的步骤。
说明书desc
技术领域本发明涉及VPN领域，特别涉及一种SSLVPN转发方法、装置、系统及存储介质。背景技术IPv4使用32位地址，因为长度过短，随着全球互联网设备急剧增长，IPv4地址枯竭问题随之产生。因此诞生出IPv6，用于取代IPv4。由于IPv4与IPv6协议地址格式不相同导致无法互相兼容。根据调研发现，市面上现有SSL VPN技术在处理同时支持IPv6和IPv4时，一种方式是采用租借购买专用网络设备进行协议转换，即在VPN专网内部统一处理IPv4或IPv6之间协议转换，当数据包经过专用网络设备访问目的资源网络时，再由虚拟网络设备根据预先配置进行协议转换，这种方式虽然SSL VPN改造很小，但由于增加了专用网络设备，运营成本很高，而且脱离了SSL VPN产品，运维难度加大；还有一种方式是在客户端设定单选模式，即采用IPv4登录服务端时只能访问IPv4的L3VPN资源，IPv6登录服务端时，只能访问IPv6的L3VPN资源，无法满足同时访问IPv4与IPv6的L3VPN资源的业务需求。因此，需要一种IPv4与IPv6融合的SSL VPN转发方法，满足低成本需求以及同时支持IPv4与IPv6的L3VPN资源访问的业务需求。发明内容有鉴于此，本发明的目的在于提供一种SSL VPN转发方法，解决了同时支持IPv4与IPv6的L3VPN资源访问的业务需求高成本的问题。为解决上述技术问题，本发明提供了一种SSL VPN转发方法，应用于服务端，包括：接收与所述服务端建立隧道的客户端发送的数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；将所述数据包发送到用户服务上；接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的I P地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；当所述应答包为IPv4格式，则执行查找步骤；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤；其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。可选的，所述根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，包括：根据所述整数从所述信息表中查找对应的所述节点；利用所述节点的隧道信息对所述应答包进行加密得到加密应答包；利用所述节点的TCP链接信息将所述加密应答包转发到所述客户端虚拟网卡；其中所述信息表包括：所述TCP链接信息和所述隧道信息构成的节点信息，以及登录认证后自动生成的IPv4格式IP地址转换为十六进制的整数构成的键值信息。本发明还提供了另一种SSL VPN转发方法，应用于客户端，包括：向与所述客户端建立隧道的服务端发送数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使所述服务端将所述数据包发送到用户服务上，接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；接收所述服务端利用节点转发的应答包；其中所述节点为当所述应答包为IPv4格式，则所述服务端执行查找步骤确定的节点；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤确定的节点，其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找；将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。可选的，所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包，包括：根据所述数据包的目的IP与VPN资源的路由地址筛选属于所述VPN资源的数据包作为所述数据包。可选的，所述根据所述数据包的目的IP与VPN资源的路由地址筛选属于所述VPN资源的数据包作为所述数据包，包括：若所述数据包为IPv4格式，则根据IPv4规范的子网掩码位数进行比较筛选属于所述VPN资源的数据包作为所述数据包；若所述数据包为IPv6格式，则根据IPv6规范的前缀标识长度进行比较筛选属于所述VPN资源的数据包作为所述数据包。可选的，所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包，包括：若路由地址为IPv4格式，则将所述路由地址添加到终端的IPv4路由表中,并指定所述路由地址的下一跳为所述客户端虚拟网卡；若所述路由地址为IPv6格式，则将所述路由地址添加到所述终端的IPv6路由表中,并指定所述路由地址的下一跳为所述客户端虚拟网卡；所述操作系统根据所述IPv4路由表和所述IPv6路由表确定所述用户访问地址对应的数据包，并根据所述指定所述路由地址的下一跳为所述客户端虚拟网卡，将所述数据包发送到所述客户端虚拟网卡。本发明还提供了一种SSL VPN转发装置，应用于服务端，包括：第一接收模块，用于接收与所述服务端建立隧道的客户端发送的数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；第一发送模块，用于将所述数据包发送到用户服务上；第二接收模块，用于接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；第二发送模块，用于当所述应答包为IPv4格式，则执行查找步骤；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤；其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。本发明还提供了另一种SSL VPN转发装置，应用于客户端，包括：第三发送模块，用于向与所述客户端建立隧道的服务端发送数据包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使所述服务端将所述数据包发送到用户服务上，接收所述用户服务发出的应答包并发送到服务端虚拟网卡；其中所述客户端虚拟网卡和所述服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数；第三接收模块，用于接收所述服务端利用节点转发的应答包；其中所述节点为当所述应答包为IPv4格式，则所述服务端执行查找步骤确定的节点；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤确定的节点，其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找；转发模块，用于将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包。本发明还提供了一种SSL VPN转发系统，包括：客户端，用于向与所述客户端建立隧道的服务端发送数据包，接收所述服务端利用节点转发的应答包，将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包；其中所述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；所述服务端，用于将所述数据包发送到用户服务上；接收所述用户服务发出的应答包并发送到服务端虚拟网卡；当所述应答包为IPv4格式，则执行查找步骤；当所述应答包为IPv6格式，若所述应答包的目的IP的前96位为全零，则执行所述查找步骤；其中所述查找步骤包括：将所述数据包的目的IP转化为十六进制的整数，根据所述整数从信息表中查找对应的节点，利用所述节点将所述应答包转发到所述客户端虚拟网卡，以使用户接收所述应答包；其中所述客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且所述IPv6格式的IP地址和所述IPv4格式的IP地址能够转换为相同的十六进制的整数。本发明还提供了一种存储介质，所述存储介质中存储有计算机程序，所述计算机程序被处理器执行时实现上述的SSL VPN转发方法的步骤。可见，本发明通过在客户端虚拟网卡和服务端虚拟网卡上均配置了2个格式IP：IPv4格式和IPv6格式，且两个格式IP能够转换为相同的十六进制整数，极大的避免了服务端与客户端管理维护多个虚拟网卡及多种格式虚拟IP带来的系统复杂度，对于服务端运维人员及客户端用户而言，无需额外进行IPv6的相关操作，降低了使用难度，即满足了市场对SSL VPN要求同时支持IPvv4与IPv6的需求，并且在实现同时支持IPv4与IPv6数据包转发的同时，并未额外增加专用网络设备，不会提高运营成本。此外，本发明还提供了一种SSL VPN转发装置、系统及存储介质，同样具有上述有益效果。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图获得其他的附图。图1为本发明实施例提供的一种SSL VPN转发方法的流程图；图2为本发明实施例提供的另一种SSL VPN转发方法的流程图；图3为本发明实施例提供的一种SSL VPN转发装置的结构示意图；图4为本发明实施例提供的另一种SSL VPN转发装置的结构示意图；图5为本发明实施例提供的一种SSL VPN转发系统的结构示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。VPN是一种虚拟专用网络，其是通过VPN技术在公共网络中构建专用的虚拟网络。按工作网络层次可划分应用层、网络层、数据链路层，分别对应SSL VPN建立远程安全访问通道的VPN技术)、IPSEC VPN建立远程安全访问通道的VPN技术)、L2TP VPN建立远程安全访问通道的VPN技术)等主流VPN技术。具体而言，VPN技术的基本原理就是用的隧道技术，在公共网络和VPN之间建立隧道，完成网络数据的传输。这种技术解决了两个异地远程网络之间的跨省、跨海专线租用费用，降低运营成本，同时在隧道发起建立前进行身份认证，在隧道传输过程中对数据包进行加密，充分保证了网络访问的安全问题。IPv4又称互联网通信协议第四版，是互联网的核心，也是目前使用最广泛的网际协议版本，它工作在链路层，常被用在以太网链路上进行数据转发。IPv4使用32位地址，因为长度过短，随着全球互联网设备急剧增长，IPv4地址枯竭问题随之产生。因此诞生出IPv6，又称互联网协议第六版，用于取代IPv4。但由于IPv4与IPv6协议地址格式不相同导致无法互相兼容。市面上现有SSL VPN技术在处理同时支持IPv6和IPv4时，增加了专用网络设备，运营成本很高，而且脱离了SSL VPN产品，运维难度加大；或者是在客户端设定单选模式，即采用IPv4登录服务端时只能访问IPv4的L3VPN资源，IPv6登录服务端时，只能访问IPv6的L3VPN资源，无法满足同时访问IPv4与IPv6的L3VPN资源的业务需求。因此，需要一种IPv4与IPv6融合的SSL VPN转发方法和系统，满足低成本需求以及同时支持IPv4与IPv6的L3VPN资源访问的业务需求。本发明提供了一种SSL VPN转发方法，避免了服务端与客户端管理维护多个虚拟网卡及多种格式虚拟IP带来的系统复杂度，对于服务端运维人员及客户端用户而言，降低了使用难度，在实现同时支持IPv4与IPv6数据包转发的同时，并未额外增加专用网络设备，不会提高运营成本。实施例1：请参考图1，图1为本发明实施例提供的一种SSL VPN转发方法的流程图。该方法可以包括：S101：接收与服务端建立隧道的客户端发送的数据包，其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包。本实施例的执行主体为服务端。服务端是指为客户端提供TCP链接受理、登录业务处理、资源下发、隧道建立、数据包转发的服务程序，需要安装在linux服务器上运行并为客户端提供服务。客户端是指与服务端相对应，为客户提供本地服务的程序，需要安装在客户物理机上与服务端建立TCP链接并互相配合运行。虚拟网卡又称虚拟网络适配器，是指利用软件创建虚拟网络适配器，创建成功后，在操作系统中会多出一张新网卡。隧道是指在客户端与服务端之间建立的用来传输虚拟专用网络内数据包的虚拟的点对点的连接。虚拟IP是指专为虚拟网卡配置的IP地址。本实施例建立隧道的过程为服务端启动TCP监听，创建虚拟网卡，配置虚拟IP，客户端发起TCP链接，服务端受理TCP链接，客户端发起登录认证，服务端受理登录认证，服务端下发客户端虚拟IP和VPN资源，客户端创建虚拟网卡，配置虚拟IP，客户端解析VPN资源，添加IPv4或IPv6路由地址，客户端发起隧道建立请求，服务端受理隧道建立请求，客户端与服务端建立隧道成功后，开始隧道加密传输。S102：将数据包发送到用户服务上。服务端将接收的数据包发送到用户服务上。S103：接收用户服务发出的应答包并发送到服务端虚拟网卡，客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数。服务端接收用户服务发出的应答包，并将应答包发送到服务端虚拟网卡。客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数。服务端从数据库中获取的配置服务端虚拟网卡的IPv4格式的IP地址按照转换标准转换为IPv6格式的IP地址，并将其写入到服务端虚拟网卡，以使IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数；当服务端与客户端登录认证成功后，服务端会自动生成IPv4格式的IP地址，并将其下发给客户端，客户端将自动生成IPv4格式的IP地址按照转换标准转换为IPv6格式的IP地址，并写入到客户端虚拟网卡，以使IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数，完成了客户端虚拟网卡和服务端虚拟网卡配置了双格式的IP地址，且可以转换为相同的十六进制的整数。S104：判断应答包是否为IPv4格式。根据应答包的包头判断应答包为IPv4格式还或是IPv6格式，若应答包为IPv4格式，则执行S106；若应答包为IPv6格式，则执行S105。S105：判断应答包的目的IP的前96位是否为全零。应答包IPv6格式，对应答包进行解析，得到目的IP，目的IP是指IPv4或IPv6协议头格式中规定的数据包发往对方目标机器的目的IP地址，判断应答包的目的IP的前96位是否为全零，若是，则执行S106；若否，则执行S107。S106：数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找对应的节点，利用节点将应答包转发到客户端虚拟网卡，以使用户接收应答包。本实施例并不限定信息表的建立方式，例如可以采用自选ID的方式建立信息表；或者是按照顺序的方式建立信息表。本实施例并不限定信息表的存储方式，例如可以存储在磁盘，或者还可以存储在信息表。本实施例并不对信息表做限定，例如可以是二维列表，或者还可以是哈希链表，哈希链表是指一个由键值对维护的双向链表，可以用于服务端在于客户端隧道建立成功后存放客户端链接信息。将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找对应的节点，利用节点将应答包转发到客户端虚拟网卡，以使用户接收应答包。进一步的，为了提高服务端查找效率，上述根据整数从信息表中查找对应的节点，利用节点将应答包转发到客户端虚拟网卡，可以包括以下步骤，具体可以包括：根据整数从信息表中查找对应的节点；利用节点的隧道信息对应答包进行加密得到加密应答包；利用节点的TCP链接信息将加密应答包转发到客户端虚拟网卡；其中信息表包括：TCP链接信息和隧道信息构成的节点信息，以及登录认证后自动生成的IPv4格式IP地址转换为十六进制的整数构成的键值信息。根据客户端登录认证完成后，服务端自动生成IPv4格式IP地址，服务端将其转换为十六进制整数构成键值，将TCP链接信息和隧道信息作为节点信息，以此构成信息表，根据整数从信息表中查找到对应的节点，利用节点的隧道信息对应答包进行加密得到加密应答包，利用节点的TCP链接信息将加密应答包转发到客户端虚拟网卡。S107：将数据包丢弃。应用本发明实施例提供的一种SSL VPN转发方法，本方法通过接收与服务端建立隧道的客户端发送的数据包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；将数据包发送到用户服务上；接收用户服务发出的应答包并发送到服务端虚拟网卡；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数；当应答包为IPv4格式，则执行查找步骤；当应答包为IPv6格式，若应答包的目的IP的前96位为全零，则执行查找步骤；其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找对应的节点，利用节点将应答包转发到客户端虚拟网卡，以使用户接收应答包。本方法通过在客户端虚拟网卡和服务端虚拟网卡上均配置了2个格式IP：IPv4格式和IPv6格式，且两个格式IP能够转换为相同的十六进制整数，极大的避免了服务端与客户端管理维护多个虚拟网卡及多种格式虚拟IP带来的系统复杂度，对于服务端运维人员及客户端用户而言，无需额外进行IPv6的相关操作，降低了使用难度，即满足了市场对SSL VPN要求同时支持IPvv4与IPv6的需求，并且在实现同时支持IPv4与IPv6数据包转发的同时，并未额外增加专用网络设备，不会提高运营成本。建立信息表，提高服务端查找效率，其中信息表包括TCP链接信息和隧道信息构成的节点信息，登录认证后自动生成的IPv4格式IP地址转换为十六进制的整数构成的键值信息。实施例2：请参考图2，图2为本发明实施例提供的另一种SSL VPN转发方法的流程图。该方法可以包括：S301：向与客户端建立隧道的服务端发送数据包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使服务端将数据包发送到用户服务上，接收用户服务发出的应答包并发送到服务端虚拟网卡；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数。本实施例的执行主体为客户端。本实施例中对客户端与服务端建立隧道的过程与S101一致，请参考S101。本实施例并不限定客户端接收到操作系统发送的数据包，例如可以不做处理；或者还可以对数据进行筛选。进一步的，为了保证数据传输效率、安全性和可控性，上述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包，可以包括以下步骤，具体可以包括：根据数据包的目的IP与VPN资源的路由地址筛选属于VPN资源的数据包作为数据包。VPN资源是指在VPN服务端事先储存的，需要下发到客户端的路由地址，这些路由地址可以是IPv4格式或IPv6格式，多个路由地址组成列表，该地址列表被称为VPN资源。VPN资源是根据客户端登录账号的权限查询获得VPN资源。对数据包进行解析，得到目的IP，根据数据包的目的IP与VPN资源的路由地址筛选属于VPN资源的数据包作为数据包。本实施例并不限定筛选的过程，例如可以直接筛选，或者还可以先对数据包进行判断后再筛选。进一步的，为了筛选的有效性以及保证筛选效率，上述根据数据包的目的IP与VPN资源的路由地址筛选属于VPN资源的数据包作为数据包，可以包括以下步骤，具体可以包括：若数据包为IPv4格式，则根据IPv4规范的子网掩码位数进行比较筛选属于VPN资源的数据包作为数据包；若数据包为IPv6格式，则根据IPv6规范的前缀标识长度进行比较筛选属于VPN资源的数据包作为数据包。根据数据包的包头判断数据包的IP格式，若数据包为IPv4格式，则根据IPv4规范的子网掩码位数进行比较筛选属于VPN资源的数据包作为数据包；若数据包为IPv6格式，则根据IPv6规范的前缀标识长度进行比较筛选属于VPN资源的数据包作为数据包。本实施例并不限定确定用户访问地址对应的数据包的方式，例如可以采用根据路由表确定；或者还可以采用LSP技术确定。进一步的，为了更有效准确的确定用户访问地址对应的数据包，上述数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包，可以包括以下步骤，具体可以包括：若路由地址为IPv4格式，则将路由地址添加到终端的IPv4路由表中，并指定路由地址的下一跳为客户端虚拟网卡；若路由地址为IPv6格式，则将路由地址添加到终端的IPv6路由表中，并指定路由地址的下一跳为客户端虚拟网卡；操作系统根据IPv4路由表和IPv6路由表确定用户访问地址对应的数据包，并根据指定路由地址的下一跳为客户端虚拟网卡，将数据包发送到客户端虚拟网卡。根据路由表确定用户访问地址对应的数据包，判断服务端下发的VPN资源中路由地址的格式，若路由地址为IPv4格式，则将路由地址添加到终端的IPv4路由表中，并指定路由地址的下一跳为客户端虚拟网卡；若路由地址为IPv6格式，则将路由地址添加到终端的IPv6路由表中，并指定路由地址的下一跳为客户端虚拟网卡；操作系统根据IPv4路由表和IPv6路由表确定用户访问地址对应的数据包，并根据指定路由地址的下一跳为客户端虚拟网卡，将数据包发送到客户端虚拟网卡。路由转发是指操作系统根据自身维护的路由表，实现在本机内两个不同子网之间的数据包转发和接收。S302：接收服务端利用节点转发的应答包；其中节点为当应答包为IPv4格式，则服务端执行查找步骤确定的节点；当应答包为IPv6格式，若应答包的目的IP的前96位为全零，则执行查找步骤确定的节点，其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找。S303：将应答包转发到客户端虚拟网卡，以使用户接收应答包。应用本发明实施例提供的一种SSL VPN转发方法，通过向与客户端建立隧道的服务端发送数据包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使服务端将数据包发送到用户服务上，接收用户服务发出的应答包并发送到服务端虚拟网卡；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数；接收服务端利用节点转发的应答包；其中节点为当应答包为IPv4格式，则服务端执行查找步骤确定的节点；当应答包为IPv6格式，若应答包的目的IP的前96位为全零,则执行查找步骤确定的节点，其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找；将应答包转发到客户端虚拟网卡，以使用户接收应答包。对数据包进行筛选，保证数据传输效率、安全性和可控性；先对数据包进行判断，再进行筛选，保证筛选的有效性和筛选的效率；根据路由表确定用户访问地址对应的数据包，更有效准确的确定用户访问地址对应的数据包。为了使本发明更便于理解，举例说明，具体可以包括：创建TCP监听端口，创建服务端虚拟网卡，设置虚拟网卡的IPv4地址，根据IPv4地址转换出IPv6地址，设置至服务端虚拟网卡；客户端发起TCP链接，服务端接受链接，客户端发起登录认证，服务端验证认证；认证通过服务端下发客户端虚拟IPv4地址及VPN资源至客户端；客户端创建客户端虚拟网卡，设置客户端虚拟网卡的IPv4地址，根据IPv4地址转换出IPv6地址，设置至客户端虚拟网卡；客户端发起隧道建立请求，服务端接收隧道建立请求，建立隧道完成；经过验证成功与客户端建立隧道后，服务端将分配给客户端的虚拟IPv4地址转化为十六进制的整数，作为唯一键值，将客户端的TCP链接信息及隧道信息作为节点，存放于哈希链表中。用户在客户端所在终端上访问属于VPN资源列表内的IPv4格式的服务地址时，客户端截取到客户端虚拟网卡上IPv4格式的数据包，客户端经过筛选过滤VPN资源列表，将合法的数据包加密后转发至服务端；服务端从隧道读取到数据包，解密后发送至服务端虚拟网卡；服务端虚拟网卡上数据包发送到用户服务上，用户服务给出应答包；服务端截取到服务端虚拟网卡IPv4格式的应答包，根据应答包头内IPv4地址转换为十六进制的整数，从哈希链表内查找到对应客户端链接信息，将应答包加密转发至客户端；客户端从隧道读取加密包并解密，将应答包写入至客户端虚拟网卡；用户收到访问服务的应答包。用户在客户端所在终端上访问属于VPN资源列表内的IPv6格式的服务地址时，客户端截取到客户端虚拟网卡上IPv6格式的数据包，客户端经过筛选过滤VPN资源列表，将合法的数据包加密后转发至服务端；服务端从隧道读取到数据包，解密后发送至服务端虚拟网卡；服务端虚拟网卡上数据包发送到用户服务上，用户服务给出应答包；服务端截取到服务端虚拟网卡IPv6格式的应答包，根据应答包头内IPv6地址判断前96位是否是全零，如果是，则将此IPv6地址转换为十六进制整数，从哈希链表内查找到对应客户端链接信息，将应答包加密转发至客户端；客户端从隧道读取加密包并解密，将应答包写入至客户端虚拟网卡；用户收到访问服务的应答包。下面对本发明实施例提供的一种SSL VPN转发装置进行介绍，下文描述的一种SSLVPN转发装置与上文描述的一种SSL VPN转发方法可相互对应参照。具体请参考图3，图3为本发明实施例提供的一种SSL VPN转发装置的结构示意图，可以包括：第一接收模块100，用于接收与服务端建立隧道的客户端发送的数据包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；第一发送模块200，用于将数据包发送到用户服务上；第二接收模块300，用于接收用户服务发出的应答包并发送到服务端虚拟网卡；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数；第二发送模块400，用于当应答包为IPv4格式，则执行查找步骤；当应答包为IPv6格式，若应答包的目的IP的前96位为全零，则执行查找步骤；其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找对应的节点，利用节点将应答包转发到客户端虚拟网卡，以使用户接收应答包。基于上述实施例，其中第二发送模块400，可以包括：查找单元，用于根据整数从信息表中查找对应的节点；加密单元，用于利用节点的隧道信息对应答包进行加密得到加密应答包；转发单元，用于利用节点的TCP链接信息将加密应答包转发到客户端虚拟网卡；其中信息表包括：TCP链接信息和隧道信息构成的节点信息，登录认证后自动生成的IPv4格式IP地址转换为十六进制的整数构成的键值信息。应用本发明实施例提供的一种SSL VPN转发装置，本装置通过第一接收模块100，用于接收与服务端建立隧道的客户端发送的数据包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；第一发送模块200，用于将数据包发送到用户服务上；第二接收模块300，用于接收用户服务发出的应答包并发送到服务端虚拟网卡；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数；第二发送模块400，用于当应答包为IPv4格式，则执行查找步骤；当应答包为IPv6格式，若应答包的目的IP的前96位为全零，则执行查找步骤；其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找对应的节点，利用节点将应答包转发到客户端虚拟网卡，以使用户接收应答包。本装置通过在客户端虚拟网卡和服务端虚拟网卡上均配置了2个格式IP：IPv4格式和IPv6格式，且两个格式IP能够转换为相同的十六进制整数，极大的避免了服务端与客户端管理维护多个虚拟网卡及多种格式虚拟IP带来的系统复杂度，对于服务端运维人员及客户端用户而言，无需额外进行IPv6的相关操作，降低了使用难度，即满足了市场对SSL VPN要求同时支持IPvv4与IPv6的需求，并且在实现同时支持IPv4与IPv6数据包转发的同时，并未额外增加专用网络设备，不会提高运营成本。具体请参考图4，图4为本发明实施例提供的另一种SSL VPN转发装置的结构示意图，可以包括：第三发送模块500，用于向与客户端建立隧道的服务端发送数据包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使服务端将数据包发送到用户服务上，接收用户服务发出的应答包并发送到服务端虚拟网卡；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数；第三接收模块600，用于接收服务端利用节点转发的应答包；其中节点为当应答包为IPv4格式，则服务端执行查找步骤确定的节点；当应答包为IPv6格式，若应答包的目的IP的前96位为全零，则执行查找步骤确定的节点，其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找；转发模块700，用于将应答包转发到客户端虚拟网卡，以使用户接收应答包。基于上述实施例，其中第三发送模块500，可以包括：筛选单元，用于根据数据包的目的IP与VPN资源的路由地址筛选属于VPN资源的数据包作为数据包。基于上述实施例，其中筛选单元，可以包括：第一筛选子单元，用于若数据包为IPv4格式，则根据IPv4规范的子网掩码位数进行比较筛选属于VPN资源的数据包作为数据包；第二筛选子单元，用于若数据包为IPv6格式，则根据IPv6规范的前缀标识长度进行比较筛选属于VPN资源的数据包作为数据包。基于上述实施例，其中第三发送模块500，可以包括：第一添加单元，用于若路由地址为IPv4格式，则将路由地址添加到终端的IPv4路由表中，并指定路由地址的下一跳为客户端虚拟网卡；第二添加单元，用于若路由地址为IPv6格式，则将路由地址添加到终端的IPv6路由表中，并指定路由地址的下一跳为客户端虚拟网卡；确定单元，用于操作系统根据IPv4路由表和IPv6路由表确定用户访问地址对应的数据包，并根据指定路由地址的下一跳为客户端虚拟网卡，将数据包发送到客户端虚拟网卡。应用本发明实施例提供的另一种SSL VPN转发装置，本装置通过第三发送模块500，用于向与客户端建立隧道的服务端发送数据包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；以使服务端将数据包发送到用户服务上，接收用户服务发出的应答包并发送到服务端虚拟网卡；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数；第三接收模块600，用于接收服务端利用节点转发的应答包；其中节点为当应答包为IPv4格式，则服务端执行查找步骤确定的节点；当应答包为IPv6格式，若应答包的目的IP的前96位为全零，则执行查找步骤确定的节点，其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找；转发模块700，用于将应答包转发到客户端虚拟网卡，以使用户接收应答包。本装置通过在客户端虚拟网卡和服务端虚拟网卡上均配置了2个格式IP：IPv4格式和IPv6格式，且两个格式IP能够转换为相同的十六进制整数，极大的避免了服务端与客户端管理维护多个虚拟网卡及多种格式虚拟IP带来的系统复杂度，对于服务端运维人员及客户端用户而言，无需额外进行IPv6的相关操作，降低了使用难度，即满足了市场对SSL VPN要求同时支持IPvv4与IPv6的需求，并且在实现同时支持IPv4与IPv6数据包转发的同时，并未额外增加专用网络设备，不会提高运营成本。下面对本发明实施例提供的一种SSL VPN转发系统进行介绍，下文描述的一种SSLVPN转发系统与上文描述的一种SSL VPN转发方法可相互对应参照。请参考图5，图5为本发明实施例提供的一种SSL VPN转发系统的结构示意图，可以包括：客户端，用于向与客户端建立隧道的服务端发送数据包，接收服务端利用节点转发的应答包，将应答包转发到客户端虚拟网卡，以使用户接收应答包；其中数据包为操作系统将用户访问地址对应的数据包发送到客户端虚拟网卡的数据包；服务端，用于将数据包发送到用户服务上；接收应答包并发送到服务端虚拟网卡；当应答包为IPv4格式，则执行查找步骤；当应答包为IPv6格式，若应答包的目的IP的前96位为全零，则执行查找步骤；其中查找步骤包括：将数据包的目的IP转化为十六进制的整数，根据整数从信息表中查找对应的节点，利用节点将应答包转发到客户端虚拟网卡，以使用户接收应答包；其中客户端虚拟网卡和服务端虚拟网卡均配置了IPv4格式的IP地址和IPv6格式的IP地址，且IPv6格式的IP地址和IPv4格式的IP地址能够转换为相同的十六进制的整数。当然，需要说明的是，图5所示的结构并不构成对本申请实施例中一种SSL VPN转发系统的限定，在实际应用中一种SSL VPN转发系统可以包括比图5所示的更多或更少的部件，或者组合某些部件。下面对本发明实施例提供的存储介质进行介绍，下文描述的存储介质与上文描述的一种SSL VPN转发方法可相互对应参照。本发明还提供一种存储介质，存储介质上存储有计算机程序，计算机程序被处理器执行时实现上述的一种SSL VPN转发方法的步骤。该存储介质可以包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其它实施例的不同之处，各个实施例之间相同或相似部分互相参见即可。对于实施例公开的装置而言，由于其与实施例公开的方法相对应，所以描述的比较简单，相关之处参见方法部分说明即可。专业人员还可以进一步意识到，结合本文中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、计算机软件或者二者的结合来实现，为了清楚地说明硬件和软件的可互换性，在上述说明中已经按照功能一般性地描述了各示例的组成及步骤。这些功能究竟以硬件还是软件的方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应该认为超出本发明的范围。最后，还需要说明的是，在本文中，诸如第一和第二等之类的关系属于仅仅用来将一个实体或者操作与另一个实体或者操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其他任何变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。以上对本发明所提供的一种SSL VPN转发方法、装置、系统及存储介质进行了详细介绍，本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处，综上所述，本说明书内容不应理解为对本发明的限制。
