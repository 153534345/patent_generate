标题title
一种分布式存储磁盘分组方法、系统、计算机及存储介质
摘要abst
本发明提供一种分布式存储磁盘分组方法、系统、计算机及存储介质，方法包括：当接收到视频对象时，将视频对象切分为若干个重要数据；对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘；以待选磁盘所属的上位机为区隔条件将若干个待选磁盘分隔为若干个初选队列；通过上位机的IP负载对初选队列进行队列优先排序，通过待选磁盘的能力值，对初选队列内的待选磁盘进行磁盘优先排序；基于重要数据的数量、队列优先排序及磁盘优先排序，自不同的初选队列中提取最大容量相同的待选磁盘，以获取存储磁盘组。通过IP负载对初选队列进行排序，规避上位机负载过高的情况，通过磁盘排序保障视频对象循环写入的均衡性，确保磁盘容量的最大化应用。
权利要求书clms
1.一种分布式存储磁盘分组方法，其特征在于，包括以下步骤：当接收到视频对象时，将所述视频对象切分为若干个重要数据；对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘；以所述待选磁盘所属的上位机为区隔条件，将若干个所述待选磁盘分隔为若干个初选队列；通过所述上位机的IP负载对所述初选队列进行队列优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序；基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组。2.根据权利要求1所述的分布式存储磁盘分组方法，其特征在于，所述对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘的步骤包括：提取机动组内可使用的磁盘，以获取若干个初选磁盘；基于所述初选磁盘的能力值及存储周期对若干个所述初选磁盘进行过滤，以获取若干个待选磁盘。3.根据权利要求1所述的分布式存储磁盘分组方法，其特征在于，所述待选磁盘的能力值的计算公式为：，其中，表示待选磁盘的能力值，/＞表示待选磁盘的最大容量，/＞表示待选磁盘的已用容量。4.根据权利要求1所述的分布式存储磁盘分组方法，其特征在于，所述通过所述上位机的IP负载对所述初选队列进行优先值排序的具体步骤包括：通过待选磁盘的写入速度计算所述待选磁盘的磁盘负载；统计同一所述上位机下的所述待选磁盘的磁盘负载，以获取所述上位机的IP负载，基于不同的所述IP负载对所述初选队列进行优先排序。5.根据权利要求1所述的分布式存储磁盘分组方法，其特征在于，所述基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组的步骤包括：若所述初选队列的数量大于或等于所述重要数据的数量，则基于所述队列优先排序，提取与所述重要数据的数量对应的所述初选队列为候选队列;基于所述磁盘优先排序，自不同的所述候选队列中分别提取最大容量相同的所述待选磁盘为第一候选磁盘；组合若干个所述第一候选磁盘为存储磁盘组。6.根据权利要求1所述的分布式存储磁盘分组方法，其特征在于，所述基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组的步骤还包括：若所述初选队列的数量小于所述重要数据的数量，则将若干个所述初选队列均判定为候选队列；基于所述磁盘优先排序，自不同的所述候选队列中分别一次提取最大容量相同的所述待选磁盘为第二候选磁盘；基于所述队列优先排序及所述磁盘优先顺序，自不同的所述候选队列中二次提取与所述第二候选磁盘的最大容量相同的所述待选磁盘为第三候选磁盘；组合若干个所述第二候选磁盘及若干个所述第三候选磁盘为存储磁盘组。7.根据权利要求1所述的分布式存储磁盘分组方法，其特征在于，在所述基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组的步骤之后，还包括：若所述存储磁盘组内的某一所述待选磁盘满载，则通过所述存储磁盘组内其他的所述待选磁盘的能力值计算需求值；于满载的所述待选磁盘所属的初选队列中，提取最大容量与满载的所述待选磁盘的最大容量相同的所述待选磁盘为候选替换磁盘，将所述候选替换磁盘的能力值与所述需求值进行比对，以确定替换磁盘；将所述替换磁盘替换满载的所述待选磁盘。8.一种分布式存储磁盘分组系统，应用如权利要求1~7任一项所述的分布式存储磁盘分组方法，其特征在于，所述系统包括：切分模块，用于当接收到视频对象时，将所述视频对象切分为若干个重要数据；选择模块，用于对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘；划分模块，用于以所述待选磁盘所属的上位机为区隔条件，将若干个所述待选磁盘分隔为若干个初选队列；排列模块，用于通过所述上位机的IP负载对所述初选队列进行队列优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序；组合模块，用于基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组。9.一种计算机，包括存储器、处理器以及存储在所述存储器上并可在所述处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1至7中任一项所述的分布式存储磁盘分组方法。10.一种存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时实现如权利要求1至7中任一项所述的分布式存储磁盘分组方法。
说明书desc
技术领域本申请涉及数据处理技术领域，特别是涉及一种分布式存储磁盘分组方法、系统、计算机及存储介质。背景技术随着AI、大数据、云计算等技术的发展，智能视频云的使用已逐渐成熟，智能视频云是基于云计算技术的理念，采用视频作为“云端”向“终端”呈现处理结果的一种云计算方案，其主要的功能有视频储存、视频处理、视频直播、内容分发等。智能视频云最核心的视频存储，其需要大量的磁盘服务器硬件资源构建一个分布式的存储集群来做技术支撑。分布式存储一般都是采用纠删编码，即一个视频对象切成大小相同的若干份重要数据，然后将每份数据分别发送到一个磁盘组下的不同的磁盘中。现有的磁盘分组方式，一般随机将最大容量不同的磁盘混合分组至同一存储磁盘组下使用，这将导致该存储磁盘组在视频写入的过程中，最大容量较大的磁盘内的剩余空间被浪费，难以保证容量的最大化利用，且随机混合磁盘的方式，也将导致在视频对象写入磁盘的过程中，不同磁盘所归属的上位机的负载难以平衡，进而使不同磁盘的写入效率不均，影响存储效果。发明内容本申请实施例提供了一种分布式存储磁盘分组方法、系统、计算机及存储介质，以解决现有技术中将不同最大容量的磁盘随机混合分组至同一磁盘组，难以保证磁盘容量的最大化利用，且因随机分布的方式，不同磁盘所属的上位机的负载难以均衡，影响磁盘写入效率，进而影响存储效果的技术问题。第一方面，本申请实施例提供了一种分布式存储磁盘分组方法，包括以下步骤：当接收到视频对象时，将所述视频对象切分为若干个重要数据；对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘；以所述待选磁盘所属的上位机为区隔条件，将若干个所述待选磁盘分隔为若干个初选队列；通过所述上位机的IP负载对所述初选队列进行队列优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序；基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组。进一步地，所述对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘的步骤包括：提取机动组内可使用的磁盘，以获取若干个初选磁盘；基于所述初选磁盘的能力值及存储周期对若干个所述初选磁盘进行过滤，以获取若干个待选磁盘。进一步地，所述待选磁盘的能力值的计算公式为：，其中，表示待选磁盘的能力值，/＞表示待选磁盘的最大容量，/＞表示待选磁盘的已用容量。进一步地，所述通过所述上位机的IP负载对所述初选队列进行优先值排序的具体步骤包括：通过待选磁盘的写入速度计算所述待选磁盘的磁盘负载；统计同一所述上位机下的所述待选磁盘的磁盘负载，以获取所述上位机的IP负载，基于不同的所述IP负载对所述初选队列进行优先排序。进一步地，所述基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组的步骤包括：若所述初选队列的数量大于或等于所述重要数据的数量，则基于所述队列优先排序，提取与所述重要数据的数量对应的所述初选队列为候选队列;基于所述磁盘优先排序，自不同的所述候选队列中分别提取最大容量相同的所述待选磁盘为第一候选磁盘；组合若干个所述第一候选磁盘为存储磁盘组。进一步地，所述基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组的步骤还包括：若所述初选队列的数量小于所述重要数据的数量，则将若干个所述初选队列均判定为候选队列；基于所述磁盘优先排序，自不同的所述候选队列中分别一次提取最大容量相同的所述待选磁盘为第二候选磁盘；基于所述队列优先排序及所述磁盘优先顺序，自不同的所述候选队列中二次提取与所述第二候选磁盘的最大容量相同的所述待选磁盘为第三候选磁盘；组合若干个所述第二候选磁盘及若干个所述第三候选磁盘为存储磁盘组。进一步地，在所述基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组的步骤之后，还包括：若所述存储磁盘组内的某一所述待选磁盘满载，则通过所述存储磁盘组内其他的所述待选磁盘的能力值计算需求值；于满载的所述待选磁盘所属的初选队列中，提取最大容量与满载的所述待选磁盘的最大容量相同的所述待选磁盘为候选替换磁盘，将所述候选替换磁盘的能力值与所述需求值进行比对，以确定替换磁盘；将所述替换磁盘替换满载的所述待选磁盘。第二方面，本申请实施例提供了一种分布式存储磁盘分组系统，应用如上述技术方案中的分布式存储磁盘分组方法，所述系统包括：切分模块，用于当接收到视频对象时，将所述视频对象切分为若干个重要数据；选择模块，用于对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘；划分模块，用于以所述待选磁盘所属的上位机为区隔条件，将若干个所述待选磁盘分隔为若干个初选队列；排列模块，用于通过所述上位机的IP负载对所述初选队列进行队列优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序；组合模块，用于基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组。第三方面，本申请实施例提供了一种计算机，包括存储器、处理器以及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现如上述第一方面所述的分布式存储磁盘分组方法。第四方面，本申请实施例提供了一种存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如上述第一方面所述的分布式存储磁盘分组方法。相比于相关技术，本发明的有益效果在于：在完成所述初选队列的获取后，通过所述IP负载对所述初选队列进行排序，其目的是在后续的磁盘选择中，优先选取负载较低的所述初选队列，一定程度规避所述上位机负载过高，影响写入效率的情况；以所述待选磁盘的能力值对所述初选队列内进行磁盘排序，可优先选择剩余存储空间较多的磁盘，保障视频对象循环写入过程中的均衡性，同时确保磁盘容量的最大化应用；在进行磁盘选取前，以所述上位机为条件将若干个所述待选磁盘进行分隔，自不同的所述初选队列中分别提取所述待选磁盘，可避免过多分属于同一所述上位机的所述待选磁盘组合为所述存储磁盘组，导致某一所述上位机的IP负载过高，影响写入效率，进而影响存储效果的情况，同时，通过此种方式，可便于对不同磁盘所归属的所述上位机的负载进行均衡化调控；选取相同最大容量的所述待选磁盘，同样可保障磁盘容量的最大化利用。本申请的一个或多个实施例的细节在以下附图和描述中提出，以使本申请的其他特征、目的和优点更加简明易懂。附图说明图1为本发明第一实施例中分布式存储磁盘分组方法的流程图；图2为本发明第二实施例中分布式存储磁盘分组方法的流程图；图3为本发明第三实施例中分布式存储磁盘分组系统的结构框图；如下具体实施方式将结合上述附图进一步说明本发明。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行描述和说明。应当理解，此处所描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。基于本申请提供的实施例，本领域普通技术人员在没有作出创造性劳动的前提下所获得的所有其他实施例，都属于本申请保护的范围。显而易见地，下面描述中的附图仅仅是本申请的一些示例或实施例，对于本领域的普通技术人员而言，在不付出创造性劳动的前提下，还可以根据这些附图将本申请应用于其他类似情景。此外，还可以理解的是，虽然这种开发过程中所作出的努力可能是复杂并且冗长的，然而对于与本申请公开的内容相关的本领域的普通技术人员而言，在本申请揭露的技术内容的基础上进行的一些设计，制造或者生产等变更只是常规的技术手段，不应当理解为本申请公开的内容不充分。在本申请中提及“实施例”意味着，结合实施例描述的特定特征、结构或特性可以包含在本申请的至少一个实施例中。在说明书中的各个位置出现该短语并不一定均是指相同的实施例，也不是与其它实施例互斥的独立的或备选的实施例。本领域普通技术人员显式地和隐式地理解的是，本申请所描述的实施例在不冲突的情况下，可以与其它实施例相结合。请参阅图1，本发明第一实施例提供的分布式存储磁盘分组方法，包括以下：步骤S10：当接收到视频对象时，将所述视频对象切分为若干个重要数据；一般情况下，当接收到所述视频对象时，采用纠删编码将所述视频对象切分为若干个重要数据及若干个亢余数据，可以理解地，若干个所述重要数据为所述视频对象的重要组成部分，通过若干个所述重要数据即可完成所述视频对象的读取。所述重要数据的数量，是后续选择磁盘的数量的依据，若某一所述视频对象的容量为8M，将其切分为8个1M的所述重要数据，则需将8个所述重要数据分别写入8个磁盘中，每个磁盘保存所述视频对象的原始数据的1/8。步骤S20：对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘；所述机动组指可被调度的磁盘的集合，一般情况下，首次初始化后的磁盘会进入所述机动组内；满载的磁盘被替换后，也会进入所述机动组内；部分未满载，但因其他原因被替换后的磁盘，同样会进入所述机动组内，进行初步过滤的目的，是将适合的磁盘自所述机动组内提取后待选。步骤S30：以所述待选磁盘所属的上位机为区隔条件，将若干个所述待选磁盘分隔为若干个初选队列；为保障所述待选磁盘的正常运行，每个所述待选磁盘分别归属于某一所述上位机，而某一所述上位机，均下挂了若干个所述待选磁盘。步骤S40：通过所述上位机的IP负载对所述初选队列进行队列优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序；在完成所述初选队列的获取后，通过所述IP负载对所述初选队列进行排序，其目的是在后续的磁盘选择中，优先选取负载较低的所述初选队列，一定程度规避所述上位机负载过高，影响写入效率的情况。以所述待选磁盘的能力值对所述初选队列内进行磁盘排序，可优先选择剩余存储空间较多的磁盘，保障视频对象循环写入过程中的均衡性，同时确保磁盘容量的最大化应用。所述待选磁盘的能力值具体指代所述待选磁盘的剩余存储能力，具体地，所述待选磁盘的能力值的计算公式为：，其中，表示待选磁盘的能力值，/＞表示待选磁盘的最大容量，/＞表示待选磁盘的已用容量。可以理解地，若所述待选磁盘的最大容量为8000G，已使用容量为6000G，则所述待选磁盘的能力值100。步骤S50：基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组。在进行磁盘选取前，以所述上位机为条件将若干个所述待选磁盘进行分隔，自不同的所述初选队列中分别提取所述待选磁盘，可避免过多分属于同一所述上位机的所述待选磁盘组合为所述存储磁盘组，导致某一所述上位机的IP负载过高，影响写入效率，进而影响存储效果的情况，同时，通过此种方式，可便于对不同的所述待选磁盘所归属的所述上位机的负载进行均衡化调控。而选取相同最大容量的所述待选磁盘，同样可一定程度保障所述待选磁盘的容量的最大化利用。请参阅图2，本发明第二实施例提供的分布式存储磁盘分组方法，所述方法包括以下步骤：步骤S100：当接收到视频对象时，将所述视频对象切分为若干个重要数据；步骤S101：提取机动组内可使用的磁盘，以获取若干个初选磁盘；可使用的磁盘指状态为在线，且未被锁定的磁盘。步骤S102：基于所述初选磁盘的能力值及存储周期对若干个所述初选磁盘进行过滤，以获取若干个待选磁盘所述初选磁盘的能力值与所述待选磁盘的能力值的计算方式相同，此处不再进行赘述，所述存储周期即所述初选磁盘的格式化周期，针对不同的数据类型，所选择的所述存储周期也不相同，如重要的视频对象，其存储周期为30天，而重要性交底的视频对象，其存储周期为7天。根据所述视频对象的不同，优先选择与其适配的所述存储周期的所述初选磁盘，并选取其中能力值大于1的所述初选磁盘为所述待选磁盘。能力值大于1及指所述初选磁盘仍有剩余容量空间可供视频数据写入。步骤S103：以所述待选磁盘所属的上位机为区隔条件，将若干个所述待选磁盘分隔为若干个初选队列；可以理解地，每个所述初选队列内均包括了若干个所述待选磁盘。步骤S104：通过待选磁盘的写入速度计算所述待选磁盘的磁盘负载；步骤S105：统计同一所述上位机下的所述待选磁盘的磁盘负载，以获取所述上位机的IP负载，基于不同的所述IP负载对所述初选队列进行优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序；所述上位机的IP负载与其下挂的所述待选磁盘的写入速度相同，随下挂的所述待选磁盘的数量越多，其IP负载也随之升高，不同的所述初选队列之间，根据所述IP负载不同，将其由小到大进行优先排序，在后续选择过程中，即可优先选择负载较小的所述初选队列内的所述待选磁盘，以达到控制负载的目的。进一步地，在完成所述初选队列的排序后，依据所述初选队列内的所述待选磁盘的能力值，进行二次优先排序，将所述初选队列内的所述待选磁盘依据剩余存储容量由多到少进行排序，可确保后续选择时，优先选择到剩余存储量较多的所述待选磁盘，以达到磁盘容量最大化利用的作用。步骤S106：若所述初选队列的数量大于或等于所述重要数据的数量，则基于所述队列优先排序，提取与所述重要数据的数量对应的所述初选队列为候选队列；步骤S107：基于所述磁盘优先排序，自不同的所述候选队列中分别提取最大容量相同的所述待选磁盘为第一候选磁盘；步骤S108：组合若干个所述第一候选磁盘为存储磁盘组；在进行磁盘选取的过程中，若所述初选队列的数量比所述重要数据的数量多，则可实现每个选取的所述待选磁盘所归属的上位机不同，如所述重要数据的数量为8个，所述初选队列的数量为10个，则将所述IP负载较低的前8个所述初选队列选定为所述候选队列。并于每个所述候选队列内选择一个所述待选磁盘。在进行所述待选磁盘的选择时，优先保证不同的所述候选队列内选择的所述待选磁盘的最大容量一致，而后，将每个所述候选队列内最大容量相同的所述待选磁盘中剩余存储量最多的所述待选磁盘选定为所述第一候选磁盘，最优情况下，若需存储8个所述重要数据，则自8个所述候选队列中分别选取一个最大容量及剩余容量均为4T的所述待选磁盘，以确保在后续循环写入的过程中，无需换盘，保障所述存储磁盘组数据写入速度和过期数据释放速度之间的平衡。步骤S109：若所述初选队列的数量小于所述重要数据的数量，则将若干个所述初选队列均判定为候选队列；即在进行磁盘选取的过程中，所述重要数据的数量为8个，所述初选队列的数量为6个，则将全部的所述初选队列选定为所述候选队列。步骤S110：基于所述磁盘优先排序，自不同的所述候选队列中分别一次提取最大容量相同的所述待选磁盘为第二候选磁盘；在进行一次提取时，自6个所述初选队列中分别选取一个最大容量相同的所述待选磁盘，可以理解地，在选择过程中，基于所述磁盘优先排序，同样选择剩余容量最多的所述待选磁盘，以获取6个所述第二候选磁盘。此时，所述第二候选磁盘的数量不足以对应所述重要数据的数量。步骤S111：基于所述队列优先排序及所述磁盘优先顺序，自不同的所述候选队列中二次提取与所述第二候选磁盘的最大容量相同的所述待选磁盘为第三候选磁盘；在二次提取时，基于所述队列优先排序，自IP负载较低的前两个所述候选队列中再次分别提取所述待选磁盘，所述待选磁盘的选择规则不便，即可获取2个所述第三候选磁盘。步骤S112：组合若干个所述第二候选磁盘及若干个所述第三候选磁盘为存储磁盘组。步骤S113：若所述存储磁盘组内的某一所述待选磁盘满载，则通过所述存储磁盘组内其他的所述待选磁盘的能力值计算需求值；在完成所述存储磁盘组的获取后，无法保证所述存储磁盘组内的每个所述待选磁盘的剩余容量均相同，即满载的时间无法保持一致，在某一所述待选磁盘满载后，需要更换以保障后续的写入存储工作。在需要更换时，根据所述存储磁盘组内其他的所述待选磁盘的能力值计算需求值，所述需求值为所述存储磁盘组内其他的所述待选磁盘的能力值的均值。步骤S114：于满载的所述待选磁盘所属的初选队列中，提取最大容量与满载的所述待选磁盘的最大容量相同的所述待选磁盘为候选替换磁盘，将所述候选替换磁盘的能力值与所述需求值进行比对，以确定替换磁盘；直接于满载的所述待选磁盘所述的初选队列中进行替换磁盘的选择，可延续所述待选磁盘所属的上位机的非一致性，确保对负载的均衡化控制。在选取过程中，优先提取最大容量与满载的所述待选磁盘的最大容量相同的所述待选磁盘为候选替换磁盘，可以理解地，此时将获取若干个所述候选替换磁盘，计算若干个所述候选替换磁盘的能力值，并将其与所述需求值之间进行比对，将能力值与所述需求值最接近的所述候选替换磁盘确定为所述替换磁盘。以所述需求值为依据，可更好的保持磁盘更换的一致性，使剩余容量及负载的控制更为均衡。步骤S115：将所述替换磁盘替换满载的所述待选磁盘。请参阅图3，本发明第三实施例提供了一种分布式存储磁盘分组系统，该系统应用如述实施例中的所述分布式存储磁盘分组方法，已经进行过说明的不再赘述。如以下所使用的，术语“模块”、“单元”、“子单元”等可以实现预定功能的软件和/或硬件的组合。尽管以下实施例所描述的装置较佳地以软件来实现，但是硬件，或者软件和硬件的组合的实现也是可能并被构想的。所述系统包括：切分模块10，用于当接收到视频对象时，将所述视频对象切分为若干个重要数据；选择模块20，用于对机动组内的磁盘进行初步过滤，以获取若干个待选磁盘；所述选择模块20包括：第一单元，用于提取机动组内可使用的磁盘，以获取若干个初选磁盘；第二单元，用于基于所述初选磁盘的能力值及存储周期对若干个所述初选磁盘进行过滤，以获取若干个待选磁盘。划分模块30，用于以所述待选磁盘所属的上位机为区隔条件，将若干个所述待选磁盘分隔为若干个初选队列；排列模块40，用于通过所述上位机的IP负载对所述初选队列进行队列优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序；所述排列模块40包括：第三单元，用于通过待选磁盘的写入速度计算所述待选磁盘的磁盘负载；第四单元，用于统计同一所述上位机下的所述待选磁盘的磁盘负载，以获取所述上位机的IP负载，基于不同的所述IP负载对所述初选队列进行优先排序，并通过所述待选磁盘的能力值，对所述初选队列内的所述待选磁盘进行磁盘优先排序。组合模块50，用于基于所述重要数据的数量、所述队列优先排序及所述磁盘优先排序，自不同的所述初选队列中提取最大容量相同的所述待选磁盘，以获取存储磁盘组。所述组合模块50包括：第五单元，用于若所述初选队列的数量大于或等于所述重要数据的数量，则基于所述队列优先排序，提取与所述重要数据的数量对应的所述初选队列为候选队列；第六单元，用于基于所述磁盘优先排序，自不同的所述候选队列中分别提取最大容量相同的所述待选磁盘为第一候选磁盘；第七单元，用于组合若干个所述第一候选磁盘为存储磁盘组；优选地，所述组合模块50还包括：第八单元，用于若所述初选队列的数量小于所述重要数据的数量，则将若干个所述初选队列均判定为候选队列；第九单元，用于基于所述磁盘优先排序，自不同的所述候选队列中分别一次提取最大容量相同的所述待选磁盘为第二候选磁盘；第十单元，用于基于所述队列优先排序及所述磁盘优先顺序，自不同的所述候选队列中二次提取与所述第二候选磁盘的最大容量相同的所述待选磁盘为第三候选磁盘；第十一单元，用于组合若干个所述第二候选磁盘及若干个所述第三候选磁盘为存储磁盘组。进一步地，所述系统还包括：替换模块60，用于若所述存储磁盘组内的某一所述待选磁盘满载，则通过所述存储磁盘组内其他的所述待选磁盘的能力值计算需求值；于满载的所述待选磁盘所属的初选队列中，提取最大容量与满载的所述待选磁盘的最大容量相同的所述待选磁盘为候选替换磁盘，将所述候选替换磁盘的能力值与所述需求值进行比对，以确定替换磁盘；将所述替换磁盘替换满载的所述待选磁盘。本发明还提供了一种计算机，包括存储器、处理器以及存储在所述存储器上并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现如上述技术方案中所述的分布式存储磁盘分组方法。本发明还提供了一种存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如上述技术方案中所述的分布式存储磁盘分组方法。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
