标题title
一种用于高速卫星链路的高能效LDPC译码器
摘要abst
一种用于高速卫星链路的高能效LDPC译码器，采用了流水线长度更短资源利用效率更高的变量节点外信息计算电路，根据校验矩阵行重较大的特点，针对校验节点外信息计算过程，利用一种简化的最小、次小值计算电路，大幅减少了译码器实现所需的FPGA资源，有效降低了高速卫星链路LDPC译码器实现所需的成本和功耗。在译码迭代计算过程中，垂直运算部分使用一种复杂度更低的4输入变量节点外信息计算流水线处理电路；水平运算部分使用一种复杂度极低的最小、次小值近似计算电路。
权利要求书clms
1.一种用于高速卫星链路的高能效LDPC译码器，其特征在于，包括垂直运算模块和水平运算模块；垂直运算模块采用二级流水线，用a、b、c、d分别表示输入的4路变量节点外信息，li表示当前变量节点对应的信道接收外信息；垂直运算第一级流水线用于确定a+b、c+d、a+li、b+li、c+li和d+li，同时对信道接收外信息li进行采样缓存；垂直运算第二级流水线用于确定return_a、return_b、return_c和return_d，其中return_a由b+li和c+d相加得到，return_b由a+li和c+d相加得到，return_c由d+li和a+b相加得到，return_d由c+li和a+b相加得到，同时将a+b、c+d、li进行加和，取最高位为符号判决值，并输出为判决比特；水平运算模块采用五级流水线，din1、din2、…、din32分别表示输入的32路校验节点外信息；水平运算第一级流水线用于确定32路校验节点外信息中的16个较小值记为m1、m2、…、m16；水平运算第二级流水线将m1、m2、…、m16分为6组，其中5组包含3个值，另外1组只含1个值，在5组中确定每组的最小值和次小值记为、、…、，另外1组经过延迟处理后产生信号m16_d2；水平运算第三级流水线将m2_1、m2_2、…、m2_5、s2_1、s2_2、…、s2_5和m16_d2分为六个分组，m2_1和s2_2为一组，m2_2和s2_1为一组，m2_3和s2_4为一组，m2_4和s2_3为一组，s2_5和m16_d2为一组，m2_5单独为一组；每组比较后产生5个较小值记为m3_1、m3_2、…、m3_5，m2_5经过延迟处理后产生信号m3_6；水平运算第四级流水线将m3_1、m3_2、…、m3_6分为两个分组，m3_1、m3_2、m3_3为一组，m3_4、m3_5、m3_6为一组，确定每组的最小值和次小值记为和；水平运算第五级流水线将m4_1和m4_2比较，较小值作为最小值min输出；如果m4_1＜m4_2，将m4_2和s4_1中的较小值作为次小值sub输出，否则将m4_1和s4_2中的较小值作为次小值sub输出。2.根据权利要求1所述的高能效LDPC译码器，其特征在于，所述水平运算第二级流水线通过两两比较确定每组的最小值和次小值。3.根据权利要求1所述的高能效LDPC译码器，其特征在于，所述水平运算第四级流水线通过两两比较确定每组的最小值和次小值。4.根据权利要求1所述的高能效LDPC译码器，其特征在于，所述译码器基于FPGA实现。5.根据权利要求1所述的高能效LDPC译码器，其特征在于，所述译码器共采用10个2输入加法器和1个3输入加法器，电路流水线级数为2级。6.一种用于高速卫星链路的高能效LDPC译码器，其特征在于，包括垂直运算模块和水平运算模块；垂直运算模块采用二级流水线，用a、b、c、d分别表示输入的4路变量节点外信息，li表示当前变量节点对应的信道接收外信息；垂直运算第一级流水线用于确定a+b、c+d、a+li、b+li、c+li和d+li，同时对信道接收外信息li进行采样缓存；垂直运算第二级流水线用于确定return_a、return_b、return_c和return_d，其中return_a由b+li和c+d相加得到，return_b由a+li和c+d相加得到，return_c由d+li和a+b相加得到，return_d由c+li和a+b相加得到，同时将a+b、c+d、li进行加和，取最高位为符号判决值，并输出为判决比特；水平运算模块采用五级流水线；水平运算第一级流水线用于从32路校验节点外信息中选取较小的16路记为m1、m2、…、m16；水平运算第二级流水线将m1、m2、…、m16分为6组，每组不超过3个值，确定每组的最小值和次小值，共计11个或12个值；水平运算第三级流水线将上述11个或12个值分为6组，每组不超过2个值，确定每组的最小值，共计6个值；对包括两个值的组，该两个值分别来自水平运算第二级流水线中不同组的最小值和次小值；水平运算第四级流水线将上述6个值分为两个分组，每组3个值，确定每组的最小值和次小值记，共计4个值；水平运算第五级流水线从上述4个值中选出最小值min和次小值sub输出。7.根据权利要求6所述的高能效LDPC译码器，其特征在于，所述水平运算第二级流水线通过两两比较确定每组的最小值和次小值。8.根据权利要求6所述的高能效LDPC译码器，其特征在于，所述水平运算第四级流水线通过两两比较确定每组的最小值和次小值。9.根据权利要求6所述的高能效LDPC译码器，其特征在于，所述译码器基于FPGA实现。10.根据权利要求6所述的高能效LDPC译码器，其特征在于，所述译码器共采用10个2输入加法器和1个3输入加法器，电路流水线级数为2级。
说明书desc
技术领域本发明涉及一种用于高速卫星链路的高能效LDPC译码器，属于LDPC码译码器技术领域。背景技术CCSDS近地标准的LDPC码，由于码率较高，所需的校验冗余开销低，并且编码增益达到约7dB，在卫星通信中应用非常广泛。但因为 LDPC软判决译码算法的计算复杂度高，需要多次迭代才能获得优异的译码性能，其高速译码器实现所需的硬件资源十分可观，特别是当译码吞吐量超过1G bps时，必须使用规模较大的FPGA进行实现，且会带来明显的功耗负担。对于星载应用，由于可靠性要求更高，器件规模往往落后商用器件一代甚至几代，且热耗和功耗要求也更加苛刻，LDPC码高速译码器的资源利用效率提升问题，是卫星数据传输领域需要解决的一个重要问题。LDPC码的译码计算分为垂直运算和水平运算两部分，垂直运算通过输入的变量节点外信息和信道接收信息计算产生校验节点外信息，水平运算则通过输入的校验节点外信息计算产生新的变量节点外信息，通过多次循环迭代计算，对接收码字进行修正。对于LDPC码译码器，在垂直运算上，现有的变量节点外信息计算电路一般通过三级流水线电路完成4个变量节点外信息和1个信道接收外信息的加和计算，然后再通过一级流水线电路将加和值分别减去各变量节点的外信息，产生4路校验节点外信息输出，这种设计由于使用的流水线级数较多，所需的缓存寄存器数量大，使得FPGA的slice资源利用率较低，附图1是现有的变量节点外信息计算电路；在水平运算上，现有设计一般通过对各输入校验节点外信息进行符号和绝对值分离，然后通过多级流水线求出各校验节点外信息绝对值的最小值和次小值，最后通过判断当前外信息的绝对值是否为最小值进行数据重组，同时将除本节点外的所有校验节点外信息的符号异或和作为该节点的外信息符号，产生各变量节点外信息输出。但对于LDPC码，由于水平运算输入的校验节点外信息数量多达32 个，使得求解各输入外信息绝对值的最小值和次小值所需的流水线电路级数很长，需要的逻辑资源和寄存器资源数量也十分庞大，同时还会产生明显的计算时延。发明内容本发明要解决的技术问题是：克服现有技术的不足，减少了译码器实现所需的FPGA资源。本发明目的通过以下技术方案予以实现：一种用于高速卫星链路的高能效LDPC译码器，包括垂直运算模块和水平运算模块；垂直运算模块采用二级流水线，用a、b、c、d分别表示输入的4路变量节点外信息，li表示当前变量节点对应的信道接收外信息；垂直运算第一级流水线用于确定a+b、c+d、a+li、b+li、c+li和d+li，同时对信道接收外信息li进行采样缓存；垂直运算第二级流水线用于确定return_a、return_b、return_c和 return_d，其中return_a由b+li和c+d相加得到，return_b由a+li和c+d相加得到，return_c由d+li和a+b相加得到，return_d由c+li和a+b相加得到，同时将 a+b、c+d、li进行加和，取最高位为符号判决值，并输出为判决比特；水平运算模块采用五级流水线，din1、din2、…、din32分别表示输入的32 路校验节点外信息；水平运算第一级流水线用于确定32路校验节点外信息中的 16个较小值记为m1、m2、…、m16；水平运算第二级流水线将m1、m2、…、m16分为6组，其中5组包含3 个值，另外1组只含1个值，在5组中确定每组的最小值和次小值记为、、…、，另外1组经过延迟处理后产生信号 m16_d2；水平运算第三级流水线将m2_1、m2_2、…、m2_5、s2_1、s2_2、…、s2_5 和m16_d2分为六个分组，m2_1和s2_2为一组，m2_2和s2_1为一组，m2_3 和s2_4为一组，m2_4和s2_3为一组，s2_5和m16_d2为一组，m2_5单独为一组；每组比较后产生5个较小值记为m3_1、m3_2、…、m3_5，m2_5经过延迟处理后产生信号m3_6；水平运算第四级流水线将m3_1、m3_2、…、m3_6分为两个分组，m3_1、 m3_2、m3_3为一组，m3_4、m3_5、m3_6为一组，确定每组的最小值和次小值记为和；水平运算第五级流水线将m4_1和m4_2比较，较小值作为最小值min输出；如果m4_1＜m4_2，将m4_2和s4_1中的较小值作为次小值sub输出，否则将 m4_1和s4_2中的较小值作为次小值sub输出。优选的，所述水平运算第二级流水线通过两两比较确定每组的最小值和次小值。优选的，所述水平运算第四级流水线通过两两比较确定每组的最小值和次小值。优选的，所述译码器基于FPGA实现。优选的，所述译码器共采用10个2输入加法器和1个3输入加法器，电路流水线级数为2级。一种用于高速卫星链路的高能效LDPC译码器，包括垂直运算模块和水平运算模块；垂直运算模块采用二级流水线，用a、b、c、d分别表示输入的4路变量节点外信息，li表示当前变量节点对应的信道接收外信息；垂直运算第一级流水线用于确定a+b、c+d、a+li、b+li、c+li和d+li，同时对信道接收外信息li进行采样缓存；垂直运算第二级流水线用于确定return_a、return_b、return_c和 return_d，其中return_a由b+li和c+d相加得到，return_b由a+li和c+d相加得到，return_c由d+li和a+b相加得到，return_d由c+li和a+b相加得到，同时将a+b、c+d、li进行加和，取最高位为符号判决值，并输出为判决比特；水平运算模块采用五级流水线；水平运算第一级流水线用于从32路校验节点外信息中选取较小的16路记为m1、m2、…、m16；水平运算第二级流水线将m1、m2、…、m16分为6组，每组不超过3个值，确定每组的最小值和次小值，共计11个或12个值；水平运算第三级流水线将上述11个或12个值分为6组，每组不超过2个值，确定每组的最小值，共计6个值；对包括两个值的组，该两个值分别来自水平运算第二级流水线中不同组的最小值和次小值；水平运算第四级流水线将上述6个值分为两个分组，每组3个值，确定每组的最小值和次小值记，共计4个值；水平运算第五级流水线从上述4个值中选出最小值min和次小值sub输出。本发明相比于现有技术具有如下有益效果：本发明在规模有限的宇航FPGA器件上可实现更高的LDPC译码处理能力，或在实现相同LDPC译码处理能力时，降低对宇航FPGA器件规模的要求，节约产品成本；本发明译码器电路更加精简，功耗下降，使得产品的供电设计要求降低；本发明译码器的总体门电路规模明显减少，热耗降低，产品可靠性更高；本发明垂直运算和水平运算都使用了级数更低的流水线，减少了译码处理延时，提高了信令传输应用的时效性；本发明中最小、次小值近似计算电路在性能无明显损失的情况下，大幅降低了水平运算的实现复杂度。附图说明图1是现有的变量节点外信息计算流水线处理电路；图2是本发明提供的变量节点外信息计算流水线处理电路；图3是本发明提供的最小、次小值近似计算电路。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明的实施方式作进一步详细描述。一种用于高速卫星链路的高能效LDPC译码器，设计了流水线长度更短资源利用效率更高的变量节点外信息计算电路，根据校验矩阵行重较大的特点，针对校验节点外信息计算过程，设计了一种简化的最小、次小值计算电路，大幅减少了译码器实现所需的FPGA资源，有效降低了高速卫星链路LDPC译码器实现所需的成本和功耗。在译码迭代计算过程中，垂直运算部分使用一种复杂度更低的4输入变量节点外信息计算流水线处理电路；水平运算部分使用一种复杂度极低的最小、次小值近似计算电路。复杂度更低的4输入变量节点外信息计算流水线处理电路，其具体组成如图2所示。计算电路共使用二级流水线，用a、b、c、d分别表示输入的4路变量节点外信息，li表示当前变量节点对应的信道接收外信息。第一级流水线通过两两加和，分别产生a+b、c+d、a+li、b+li、c+li和d+li共六路外信息加和值，同时对信道接收外信息li进行采样缓存；第二级流水线通过对第一级流水线产生的六路外信息加和值进行组合相加，得到return_a、return_b、return_c和 return_d共4路校验节点外信息，并由寄存器缓存后输出，其中return_a由b+li和c+d两路外信息加和值相加得到，return_b由a+li和c+d两路外信息加和值相加得到，return_c由d+li和a+b两路外信息加和值相加得到，return_d由c+li和a+b两路外信息加和值相加得到，同时将a+b、c+d和缓存的li进行加和，取最高位为符号判决值，并由寄存器缓存后输出为判决比特。所述的水平运算部分使用一种复杂度极低的最小、次小值近似计算电路，具体组成如图3所示，其特征在于：计算电路共使用五级流水线，用din1、din2、…、 din32分别表示输入的32路校验节点外信息。第一级流水线通过两两比较产生16个较小值m1、m2、…、m16。第二级流水线将16个值m1、m2、…、m16分为6组，前5组包含3个值，第6组只含1个值，前5组的三个值分别用dat2_1、dat2_2和dat2_3表示。前五组的三个值通过两两对比较后选出最小和次小值，将a、b和c表示过两两对比较的结果，如果dat2_1＜dat2_2将a置为1否则置为0；如果dat2_2＜dat2_3 将b置为1否则置为0如果dat2_3＜dat2_1将c置为1否则置为0，当abc为"000" 时，最小值为dat2_1，次小值为dat2_2；当abc为"001"时，最小值为dat2_3，次小值为dat2_2；当abc为"010"时，最小值为dat2_2，次小值为dat2_1；当abc 为"011"时，最小值为dat2_2，次小值为dat2_3；当abc为"100"时，最小值为dat2_1，次小值为dat2_3；当abc为"101"时，最小值为dat2_3，次小值为dat2_1；当abc 为"110"时，最小值为dat2_1，次小值为dat2_2；前五个分组经过运算后共产生五组最小和次小值、、…、。第六个分组只含m16一个数，经过延迟处理后产生信号m16_d2。第三级流水线将m2_1、m2_2、…、m2_5、s2_1、s2_2、…、s2_5和m16_d2 分为六个分组，m2_1和s2_2为一组，m2_2和s2_1为一组，m2_3和s2_4为一组，m2_4和s2_3为一组，s2_5和m16_d2为一组，m2_5单独为一组。2个数组成的分组两两比较产生5个较小值m3_1、m3_2、…、m3_5，m2_5经过延迟处理后产生信号m3_6。第四级流水将m3_1、m3_2、…、m3_6分为两个分组，m3_1、m3_2、m3_3 为一组，m3_4、m3_5、m3_6为一组，每组的三个值分别用dat4_1、dat4_2和 dat4_3表示，三个值通过两两对比较后选出最小和次小值，将A、B和C表示过两两对比较的结果，如果dat4_1＜dat4_2将A置为1否则置为0；如果 dat4_2＜dat4_3将B置为1否则置为0如果dat4_3＜dat4_1将C置为1否则置为 0，当ABC为"000"时，最小值为dat4_1，次小值为dat4_2；当ABC为"001"时，最小值为dat4_3，次小值为dat4_2；当ABC为"010"时，最小值为dat4_2，次小值为dat4_1；当ABC为"011"时，最小值为dat4_2，次小值为dat4_3；当ABC 为"100"时，最小值为dat4_1，次小值为dat4_3；当ABC为"101"时，最小值为 dat4_3，次小值为dat4_1；当ABC为"110"时，最小值为dat4_1，次小值为dat4_2。经过运算后共产生两组最小和次小值，分别为和。第五级流水将m4_1和m4_2比较，较小值作为最小值min输出。如果 m4_1＜m4_2，将m4_2和s4_1中的较小值作为次小值sub输出，否则将m4_1 和s4_2中的较小值作为次小值sub输出。实施例：下面给出了一个基于FPGA的16路并行CCSDSLDPC码高速译码器，时钟主频为160M，数据吞吐量为2.5G bps。分别采用本发明提供的变量节点外信息计算流水线处理电路和最小、次小值近似计算电路，为了便于比较还列出了使用传统电路实现相同吞吐量译码器所需的资源，结果如表1所示，表1为16路并行CCSDSLDPC码高速译码器的FPGA资源占用情况。表1资源类型Flip FlopsLUTsSlices36kbits BRAM传统电路实现164,678131,80054,096648本发明电路实现101,23392,56036,217648 本发明的变量节点外信息计算流水线处理电路共使用了10个2输入加法器和1个3输入加法器，与现有电路使用的8个加法/减法器相比略有增加，但电路流水线级数从原来的4级降低为2级，大幅度减少的寄存器使用的数量。对于FPGA来说，基本的逻辑资源单元为slice，现有电路中虽然加法运算更少，但缓存的寄存器资源则非常多，寄存器单独用作缓存数据的情况下，寄存器前端的查找表资源被闲置，且不能再分配给其它电路使用，得Slices资源的利用效能极低。另外，由于现有电路在完成5个数据加和后与各校验节点外信息相减，为了保证该4个减法操作不溢出需要扩展3比特位宽，而本发明计算外信息输出的4路加法运算仅需要扩展2比特位宽，且多出的4 个加法操作为输入前端的外信息两两加和，位宽只需扩展1比特，因此本发明的变量节点外信息计算流水线处理电路虽然加法器个数更多，但加法器所需的平均位宽更小，单个加法器的复杂度更低。由于LDPC码的行重达到了32，因此计算绝对值的最小次小值时所需的电路资源十分庞大，本发明通过在第一级比较时舍弃次小值来减少电路的复杂度，由于次小值刚好在第一轮比较中被最小值排除的概率仅有1/31，在被排除的情况下求解的次小值与其实际误差也较小，并且该误差仅影响32 个输出外信息中的一个，因此对迭代结果的影响极低。由表1可见，本发明设计的一种用于高速卫星链路的高能效LDPC译码器虽然对存储块资源没有改善，但由于变量节点外信息计算流水线处理电路和最小、次小值近似计算电路的优化改进，译码器实现所需的FPGA Slices资源数量由54096降低为36217，节省了约33％。本发明说明书中未作详细描述的内容属本领域技术人员的公知技术。本发明虽然已以较佳实施例公开如上，但其并不是用来限定本发明，任何本领域技术人员在不脱离本发明的精神和范围内，都可以利用上述揭示的方法和技术内容对本发明技术方案做出可能的变动和修改，因此，凡是未脱离本发明技术方案的内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化及修饰，均属于本发明技术方案的保护范围。
