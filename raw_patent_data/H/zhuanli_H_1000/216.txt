标题title
一种基于域标识的变长报文处理时延探测方法
摘要abst
本发明公开了一种基于域标识的变长报文处理时延探测方法，属于网络通信技术领域，具体包括：控制单元启动收集功能，获取不同长度报文处理时延，并检查收集情况，若收集齐全，则结束收集；若未收集齐全，则挑选缺失数据的节点属性，并查看相同设备属性的节点收集情况，若已收集到，则整合数据；若未收集到，则启用IOAM功能，通过控制单元依据收集需求改变前序节点的N‑ID，让报文长度符合要收集的报文长度；下发N‑ID的配置到沿途节点；上报节点将IOAM信息上送控制单元。本发明采用IOAM，基于N‑ID的变化，对每个节点，探测不同长度报文的处理时延，并依据这些时延值推导未知长度的时延，探测变长报文处理时延，进而提高探测效率。
权利要求书clms
1.一种基于域标识的变长报文处理时延探测方法，其特征在于，包括：步骤1，控制单元启动报文处理时延收集功能，获取不同长度报文处理时延；步骤2，控制单元检查不同长度报文处理时延收集情况，若收集齐全，则结束收集，输出报文处理时延；若未收集齐全，则挑选缺失数据的节点属性，并进入步骤3；步骤3，控制单元查看相同设备属性的节点收集缺少报文处理时延情况，若已收集到，则控制单元整合信息，并进入步骤2；若未收集到，则进入步骤4；步骤4，控制单元查找经过缺失节点的业务流，用以计算前序节点配置不同的N-ID，改变N-ID，使进入本节点的报文长度符合要收集的报文长度；步骤5，控制单元下发N-ID的配置到沿途节点，由最终上报节点将IOAM信息上送控制单元，控制单元获取缺失节点对应长度的报文处理时延，探测变长报文处理时延。2.根据权利要求1所述的一种基于域标识的变长报文处理时延探测方法，其特征在于，步骤1中，所述报文处理时延收集功能，控制单元采用精确匹配与范围匹配一种或两种相结合的方式进行不同长度报文处理时延收集。3.根据权利要求1所述的一种基于域标识的变长报文处理时延探测方法，其特征在于，步骤3中，所述设备属性，具体包括：厂商，设备型号，版本号。4.根据权利要求1所述的一种基于域标识的变长报文处理时延探测方法，其特征在于，步骤3中，所述整合信息，具体包括：将同一个厂商同一个型号同一个版本的不同节点整合成一个全集，并更新各相同属性的节点各长度处理时延信息。5.根据权利要求4所述的一种基于域标识的变长报文处理时延探测方法，其特征在于，所述整合成全集的不同节点，控制单元不需要探测每个节点所有的长度处理时延信息。6.根据权利要求1所述的一种基于域标识的变长报文处理时延探测方法，其特征在于，步骤4中，所述计算前序节点配置不同的N-ID，具体为：所述控制单元查找经过此节点的业务流，检查业务流报文长度，叠加经过本节点前叠加的IOAM信息长度：；其中，为业务流的长度，/＞为缺少报文处理时延的长度，/＞为/＞前面的跳数，/＞为每跳插入的IOAM报文信息长度，满足以上公式，则这个/＞成为候选的业务流；；其中，为上下浮动范围，/＞，delta为变量，满足以上公式，则选定业务流/＞和/＞个节点配置相同的N-ID，其余的前序节点配置不同的N-ID。7.根据权利要求1所述的一种基于域标识的变长报文处理时延探测方法，其特征在于，所述每个节点的报文处理时延，都要放到IOAM信息中。
说明书desc
技术领域本发明涉及网络通信技术领域，具体为一种基于域标识的变长报文处理时延探测方法。背景技术确定性网络技术目前是业界研究的重点领域，是未来6G通信的4大支撑技术之一。目前在多个标准组织进行标准化相关工作。同时业务也越来越需要感知网络的特性，其中时延是其中最为重要的一个指标。业界目前在分组数据通信领域，发明了众多的OAM技术，用来测量端到端以及单点时延，如OWAMP  、TWAMP ，是端到端测量技术，IOAM，可以测量单节点时延。但是，需要注意到，实际上，网络节点处理报文的时延，实际上是和报文长度相关的。而上述技术都没有考虑报文长度，认为是一个固定的时延值。为了探测不同长度报文的处理时延，并依据这些时延值去拟合，形成一个拟合函数，并去推导未知长度的时延。探测不同长度的节点处理时延，在网络比较大时，依靠固定长度报文依次去探测，效率比较大，采用IOAM方式是比较快速的方法。IOAM的报文格式是标准的报文格式定义，其中的Namespace-ID就是本方案所说的域标识，本方案中会使用域标识或者N-ID来标识。如图1所示，转发节点R1-R8都配置了相同的域标识N1，那么flow1经过每个节点时，配置为插入20字节的信息，会发现，从R2开始，进入的报文长度就逐次增加20字节，R8会先封装IOAM信息，并按照配置，上送给控制单元，然后在出接口会剥离IOAM信息。从图中，我们看到，每经过一个节点，报文长度会变化一次，但是，对于独立的节点，譬如R3，每次进来处理的报文长度都是不变。发明内容为了对于每个节点，我们都能探测到不同长度的报文处理时间，本发明提供一种基于域标识的变长报文处理时延探测方法，以解决上述问题。技术方案：一种基于域标识的变长报文处理时延探测方法，包括：步骤1，控制单元启动报文处理时延收集功能，获取不同长度报文处理时延；步骤2，控制单元检查不同长度报文处理时延收集情况，若收集齐全，则结束收集，输出报文处理时延，若未收集齐全，则挑选缺失数据的节点属性，并进入步骤3；步骤3，控制单元查看相同设备属性的节点收集缺少报文处理时延情况，若已收集到，则控制单元整合信息，并进入步骤2，若未收集到，则进入步骤4；步骤4，控制单元查找经过缺失节点的业务流，用以计算前序节点配置不同的N-ID，改变N-ID，使进入本节点的报文长度符合要收集的报文长度；步骤5，控制单元下发N-ID的配置到沿途节点，由最终上报节点将IOAM信息上送控制单元，控制单元获取缺失节点对应长度的报文处理时延，探测变长报文处理时延。进一步地，在步骤1中，所述报文处理时延收集功能，控制单元采用精确匹配与范围匹配一种或两种相结合的方式进行不同长度报文处理时延收集。进一步地，在步骤3中，所述设备属性，具体包括：厂商，设备型号，版本号。进一步地，在步骤3中，所述整合信息，具体包括：将同一个厂商同一个型号同一个版本的不同节点整合成一个全集，并更新各相同属性的节点各长度处理时延信息。进一步地，在所述整合成全集的不同节点，控制单元不需要探测每个节点所有的长度处理时延信息。进一步地，步骤4中，所述计算前序节点配置不同的N-ID，具体为：所述控制单元查找经过此节点的业务流，检查业务流报文长度，叠加经过本节点前叠加的IOAM信息长度：；其中，为业务流的长度，为缺少报文处理时延的长度，为前面的跳数，为每跳插入的IOAM报文信息长度，满足以上公式，则这个成为候选的业务流；；其中，为上下浮动范围，，delta为变量，满足以上公式，则选定业务流和个节点配置相同的N-ID，其余的前序节点配置不同的N-ID。进一步地，所述每个节点的报文处理时延，要放到IOAM信息中。本发明有益效果：本发明采用IOAM方式，控制单元依据收集需求改变域标识N-ID的值，影响IOAM报文在本节点的处理行为，从而改变本节点收到的报文长度，从而对于每个节点，都能探测得到本节点不同长度的报文处理时间，进而提高探测效率。附图说明图1是本发明IOAM测量组网示意图。图2是本发明IOAM测量报文封装示例。图3是本发明流程示意图。图4是本发明各节点配置及报文长度示意图。具体实施方式在下文的描述中，给出了大量具体的细节以便提供对本发明更为彻底的理解。然而，对于本领域技术人员而言显而易见的是，本发明可以无需一个或多个这些细节而得以实施。在其他的例子中，为了避免与本发明发生混淆，对于本领域公知的一些技术特征未进行描述。本发明所提到的IOAM是一种网络测量和监控技术，Namespace-ID为域标识N-ID，参照图1，转发节点R1-R8都配置了相同的域标识，那么经过每个节点时，配置为插入20字节的信息，会发现，从R2开始，进入的报文长度就逐次增加20字节，R8会先封装IOAM信息，并按照配置，上送给控制单元，然后在出接口会剥离IOAM信息。可以看到，每经过一个节点，报文长度会变化一次，但是，对于独立的节点，每次进来处理的报文长度都是不变。本实施例提供一种基于域标识的变长报文处理时延探测方法，改变沿路节点的N-ID，探测节点设备对于不同的长度报文处理时延。因为IOAM报文会先匹配本节点的N-ID是否和报文里面的N-ID一致，一致的话，就会插入本节点的相关IOAM信息，否则，就不插入。这样，每次改变不同节点的N-ID的值，就会影响IOAM报文在本节点的处理行为，相应的后续节点收到的报文的长度也会变化。就能通过改变前序节点的N-ID，来变相改变本节点收到的报文长度，也就能探测到本节点不同长度的报文处理时间。参照图2，本发明除了基本的IOAM信息外，还要求每个节点把此报文的处理时延放到IOAM信息中。其具体方法为：步骤1，控制单元启动报文处理时延收集功能，获取不同长度报文处理时延；步骤2，控制单元检查不同长度报文处理时延收集情况，若收集齐全，则结束收集，输出报文处理时延，若未收集齐全，则挑选缺失数据的节点属性，并进入步骤3；步骤3，控制单元查看相同设备属性的节点收集缺少报文处理时延情况，若已收集到，则控制单元整合信息，并进入步骤2，若未收集到，则进入步骤4；步骤4，控制单元查找经过缺失节点的业务流，用以计算前序节点配置不同的N-ID，改变N-ID，使进入本节点的报文长度符合要收集的报文长度；步骤5，控制单元下发N-ID的配置到沿途节点，由最终上报节点将IOAM信息上送控制单元，控制单元获取缺失节点对应长度的报文处理时延，探测变长报文处理时延。在本申请的另一实施例中，参照图4所示的组网图，其中，R4缺少240字节长度报文处理时延，而节点R6缺少256字节长度报文处理时延。参考图3的发明流程，该报文处理过程为：控制单元启动每个节点不同长度报文处理时延的收集工作，在收集R6节点256字节长度的报文处理时延时，250-260范围内的字节长度都符合收集要求，通过精确匹配与范围匹配相结合的方式，收集各节点不同长度的报文处理时延。控制单元检查所管理节点收集的报文处理时延情况，其中R4和R6分别缺少240和256字节长度的报文处理时延，报文长度上下浮动为5字节。控制单元查看R4与R6节点的厂商、设备型号、版本相关的设备属性信息。控制单元查看与R4、R6相同的设备属性的节点收集R4与R6节点长度的报文处理时延，发现没有相同的设备属性的节点收集到240、256长度的报文处理时延数据。控制单元查找经过R4、R6的业务流，找到一条同时经过这两个节点的业务流。控制单元获取业务流的长度，R4的报文处理时延，上下浮动范围，前面有个节点，每节点插入的IOAM长度。按照公式： 满足条件；按照公式：，此时，大于1，小于3，满足条件。只需在R4之前设置2个节点相同的N-ID=1，此业务流便满足R4测量要求。同样方法计算R6，R6的报文处理时延，下浮动范围，前面有个节点，每节点插入的IOAM长度。按照公式： ，满足条件；按照公式：，此时，大于1，小于5，满足条件。得到，只需在R6之前设置3个节点相同的N-ID=1，此业务流满足R6的测量要求。控制单元将和2个节点配置相同的N-ID=1，和3个节点配置相同的N-ID=1，下发到沿途R4和R6节点。在节点R4，进入的报文长度为240字节，在R6节点，进入的报文长度为260字节。在上报节点R8将IOAM收集的信息上送控制单元，R4、R6就收集到对应的240、256对应的处理时延信息。控制单元所控制的节点收集到足够的不同长度报文的处理时延，结束收集，探测获取该报文处理时延信息。如上所述，尽管参照特定的优选实施例已经表示和表述了本发明，但其不得解释为对本发明自身的限制。在不脱离所附权利要求定义的本发明的精神和范围前提下，可对其在形式上和细节上做出各种变化。
