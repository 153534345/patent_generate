标题title
一种物联网终端功耗策略在线优化的方法
摘要abst
本发明公开了一种物联网终端功耗策略在线优化的方法，包括对用户终端和链路进行全面扫描，并根据链路的行为数据得到链路行为图；将链路行为图输入到仿真优化系统中，得到用户终端功耗最小功耗参数；将链路行为图和最小的功耗参数进行集中存储，并按照其对应关系构建链路行为库；用户终端定期向服务器发送自身的运行数据和采集到的用户链路行为数据，服务器评估用户终端的功耗策略是否需要优化，若无需优化则维持原状直到用户终端下一次数据采集，若优化则需获得最小功耗参数；服务器将最小功耗参数联网传输到用户终端，并下发参数更新指令，完成用户终端的功耗策略升级。本发明可以更快速的传达用户终端功耗策略的更新，更加高效。
权利要求书clms
1.一种物联网终端功耗策略在线优化的方法，其特征在于，包括：S1、对用户终端和链路进行全面扫描，并根据链路的行为数据得到链路行为图；S2、将步骤S1中的链路行为图输入到仿真优化系统中，得到使得用户终端功耗最小的功耗参数；S3、将步骤S1中的链路行为图和步骤S2中的功耗参数进行集中存储，并按照其对应关系构建链路行为库；S4、用户终端定期向服务器发送自身的运行数据和采集到的用户链路行为数据，服务器评估用户终端的功耗策略是否需要优化，若无需优化则维持原状直到用户终端下一次数据采集，否则转到步骤S5；S5、服务器根据用户终端采集到的链路行为数据生成链路行为子图，利用相似度算法将其与步骤S3中的链路行为库进行匹配，若匹配成功，则从链路行为库中获取匹配的链路行为图对应的最小功耗的功耗参数并转到步骤S7，否则转到步骤S6；S6、通过图神经网络的生成算法对步骤S5中生成的链路行为子图进行二次生成得到完整的链路行为图，将该链路行为图输入到步骤S2中的仿真优化系统中，得到新链路的最小功耗的功耗参数；S7、服务器将最小功耗的功耗参数联网传输到用户终端，并下发参数更新指令，完成用户终端的功耗策略升级。2.根据权利要求1所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S1中，得到链路行为图包括以下子步骤：S101、使用链路分析工具对用户终端与链路之间的交互行为及相关数据进行监测，包括但不限于交互行为的种类、具体内容、行为时间、处理时延和传输时延；使用功耗分析设备和逻辑分析设备对用户终端的实时电流和工作状态进行采样分析，获取各用户终端行为的分段工作状态和平均电流；S102、控制用户终端保持被动响应状态，使用抓包器对链路的主动发包行为进行监测并记录后续用户终端与链路发生的交互行为及相关数据；S103、根据链路协议将链路中发生的交互行为进行汇总，获得链路测试行为集，依次选取测试行为集中的每一项作为待测行为，控制用户终端向链路发起待测行为，使用链路分析工具对用户终端与链路之间的交互行为进行监测并记录相关数据；S104、对步骤S102、S103中获取到的交互行为进行分类汇总，属于用户终端行为的部分构成用户终端行为表，该表的字段内容包括但不限于种类、具体内容、行为时间、处理时延和传输时延、该用户终端行为的分段工作状态和对应的平均电流；属于链路行为的部分则生成该链路的链路行为图；S105、重复步骤S101~S104，直到所有待测链路均生成链路行为图。3.根据权利要求2所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S104中，链路行为图由节点和边构成，其中节点表示链路的行为内容，通常就是一种发包行为；节点包括但不限于行为种类、行为时间、处理时延和传输时延；边表示行为的触发条件。4.根据权利要求1所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S2中，得到使得用户终端功耗最小的功耗参数包括以下子步骤：S201、定义用户终端在n种工作状态s1、s2…sn下的平均电流分别为c1、c2…cn，则用户终端的平均功耗P=/*V，其中，t1、t2…tn分别表示用户终端处于不同工作状态下的时间，V表示用户终端的输入电压；S202、使用参数表征用户终端的功耗策略；S203、选取遗传算法作为仿真优化系统的优化算法，在参数范围内搜索使功耗最小的一组功耗参数，不断迭代直至迭代搜索的次数大于预设次数阈值或相邻两次迭代间功耗结果的变化误差小于设定数值。5.根据权利要求1所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S4中，判断是否需要优化包括以下内容：记录用户终端一段时间内处于休眠状态下的时间占比，当时间占比低于阈值时，则需要进行优化，否则不需要进行优化。6.根据权利要求2所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S5中，匹配包括以下子步骤：S501、服务器根据用户终端在单个采样周期内采集到的链路行为数据生成链路行为子图；S502、遍历链路行为库中的所有链路行为图，计算与链路行为子图的相似度，得到相似度最高的链路行为图；若最高相似度达到预设的相似度阈值，则链路行为子图在链路行为库中匹配成功，获取匹配的链路行为图对应的最小功耗的功耗参数，转到步骤S7，否则转到步骤S6。7.根据权利要求6所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S501中，生成链路行为子图包括以下子步骤：S5011、遍历链路行为数据中的所有用户终端行为，在用户终端行为表中找到对应项并更新参数的属性使用户终端行为表中的属性数据与链路行为数据中的一致；S5012、遍历链路行为数据中的所有链路行为，每一个链路行为对应一个节点，节点的属性包括但不限于节点行为的发送时间和传输时延；S5013、根据链路行为数据解析每个链路行为对应的触发条件并在行为图中用边的形式进行构造。8.根据权利要求7所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S502中，匹配包括以下子步骤：S5021、将链路行为子图和匹配的链路行为图表示为图的邻接矩阵和节点特征矩阵；S5022、构建基于图卷积网络的图匹配模型，将链路行为子图作为输入图，匹配的链路行为图作为目标图，学习到节点的匹配特征；S5023、利用学习到的匹配特征计算节点间的余弦相似度，具体公式为：；其中，表示两个向量/＞和/＞之间的余弦相似度，/＞表示第i个向量，表示/＞邻居节点集合中的第j个向量，k表示向量中的维度索引，G表示向量的维数，/＞表示向量/＞在第k维的分量，/＞表示向量/＞在第k维的分量；S5024、根据余弦相似度，输出链路行为子图与匹配的链路行为图之间的节点匹配结果；通过迭代和优化调整模型参数，完成链路行为子图和匹配的链路行为图间节点的匹配。9.根据权利要求8所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S5022中，学习节点的匹配特征包括以下内容：聚合节点的邻居信息，具体表示为：；其中，表示第l层的权重矩阵，/＞表示第l-1层/＞的特征，/＞表示向量/＞的邻居信息聚合，/＞表示向量/＞的邻居节点集合；将向量的自身特征考虑进去，具体表示为：；其中，表示第l层的自身特征的权重矩阵，/＞表示向量/＞在第l层的自身特征向量，/＞表示第l-1层/＞的特征；将聚合的邻居信息和自身特征更新结合，得到向量在第l层的新特征，具体表示为：；其中，表示向量/＞在第l层的总特征向量。10.根据权利要求8所述的物联网终端功耗策略在线优化的方法，其特征在于，步骤S6中，得到完整的链路行为图包括以下子步骤：S601、对链路行为子图进行编码，将邻接矩阵和节点特征矩阵输入到基于图卷积网络的图匹配模型中，经过多层的节点特征传播和聚合学习子图的节点特征；S602、对链路行为子图节点特征进行融合，得到整体子图的特征表示；S603、利用生成对抗网络模型，生成新节点和边，构建完整链路行为图的结构；生成节点特征，将该特征和子图节点特征进行融合，获得完整链路行为图的特征表示；S604、通过去除重复边，对完整链路行为图的结构进行优化和修复，获得完整的链路行为图。
说明书desc
技术领域本发明涉及图神经网络技术领域，具体涉及一种物联网终端功耗策略在线优化的方法。背景技术现有的物联网在线设备中有大量使用电池供电的用户终端设备，这些设备在要求保持链路的稳定连接的同时对用户终端设备的功耗也有需求。为了使用户终端设备的功耗尽可能地低，用户终端设备厂商开发了众多支持低功耗的硬件设备，搭配相应的软件低功耗策略以及支持低功耗的链路协议，使得用户终端可以在大部分时候进入待机休眠状态，而只在需要的时候醒来处理事务以节省用户终端功耗并延长电池的使用寿命。然而，由于提供通讯支持的链路设备厂商存在着实现上的差异，用户终端设备厂商在制定低功耗策略时会面临众多的链路兼容性问题，这些问题严重影响用户终端设备在部分链路上的功耗，导致用户终端设备需要频繁地更换电池，引发能源的浪费和用户的投诉。为了尽可能避免上述情况的发生，用户终端设备厂商在低功耗策略的制定上会尽可能地选用更加保守和容错的功耗策略，以实现用户终端功耗与链路兼容性之间的平衡。此外，一些用户终端设备厂商会尝试通过链路设备的型号采取一些针对性的策略以缩减用户终端功耗对兼容性的让步，选用一些更为激进的功耗参数以节省功耗。例如在WiFi链路中，不少用户设备厂商就会根据不同型号路由器采取针对性的低功耗策略，因此出于对路由器兼容性的考量，终端设备的功耗策略算法越来越复杂，非常占用本就紧张的代码空间和终端计算资源，另一方面，随着链路配套产品的更新迭代，用户终端设备的功耗参数也需要不断更新调整，由于当前业界主流的做法就是通过ota远程下载，重新烧写设备固件，因此要求用户频繁地升级固件，对用户体验也有不小的影响。发明内容本发明所要解决的技术问题：提供一种物联网终端功耗策略在线优化的方法，根据链路的行为数据得到链路行为图，输入到SBO系统中，利用相似度算法、图神经网络的生成算法得到用户终端功耗最小功耗参数，完成用户终端的功耗策略升级，更为高效快速。本发明为解决以上技术问题而采用以下技术方案：本发明提出的一种物联网终端功耗策略在线优化的方法，包括：S1、在实验环境下对用户终端和链路进行全面扫描，并根据链路的行为数据对链路进行建模得到链路行为图。S2、将步骤S1中获得的链路行为图输入到SBO系统中，得到使得用户终端功耗最小的功耗参数。S3、将步骤S1中的所有用户终端链路的链路行为图和步骤S2中的行为图对应的功耗参数进行集中存储，按照其一一对应的关系构建链路行为库。该链路行为库包含了所有通过步骤S1获取到的链路行为图。构建链路行为库的主要目的是为了便于生产阶段可以通过链路行为图直接获取到对应的最小功耗的功耗参数，从而节省通过仿真优化系统获取最小功耗的功耗参数的时间，提高生产环境下的功耗优化效率。S4、在生产环境下，用户终端定期向服务器发送自身的运行数据和采集到的用户链路行为数据，服务器评估用户终端的功耗策略是否需要优化，如果评估认为无需优化则维持原状直到用户终端下一次数据采集，否则转到步骤S5。S5、服务器根据用户终端采集到的链路行为数据生成链路行为子图，利用相似度算法将其与链路行为库进行行为图匹配，若匹配成功，则从链路行为库中获取匹配的链路行为图对应的最小功耗的功耗参数并转到步骤S7，否则转到步骤S6。S6、通过图神经网络的生成算法对步骤S5中生成的链路行为子图进行二次生成得到完整的链路行为图，将该链路行为图再次输入步骤S2的SBO系统中，得到新链路的最小功耗的功耗参数。S7、服务器将最小功耗的功耗参数联网传输到用户终端，并下发参数更新指令，完成用户终端的功耗策略升级。进一步的，步骤S1中，得到链路行为图包括以下子步骤：S101、选取某个待测链路搭建测试环境，控制用户终端和待测链路保持稳定的连接状态，使用链路分析工具对用户终端与链路之间的交互行为及相关数据进行监测，包括但不限于交互行为的种类、具体内容、行为时间、处理时延和传输时延；使用功耗分析设备和逻辑分析设备对用户终端的实时电流和工作状态进行采样分析，获取各用户终端行为的分段工作状态和分段统计电流。功耗分析设备要确保拥有正常的电流采样功能即可，市面上大部分功耗分析设备均可满足要求，该设备会测算出用户终端处于不同工作状态下的平均电流，以此作为仿真系统计算功耗的依据，因此理论上功耗分析设备的精度越高，后续功耗的仿真计算以及最终的优化参数也越准确。逻辑分析设备只要采样率足够高可以使软件桩点被正确采样即可。S102、控制用户终端保持被动响应状态，使用抓包器对链路的主动发包行为进行监测并记录后续用户终端与链路发生的交互行为及相关数据。S103、根据链路协议将链路中可能发生的交互行为进行汇总，获得链路测试行为集，依次选取测试行为集中的每一项作为待测行为，控制用户终端向链路发起待测行为，使用抓包器对用户终端与链路之间的交互行为进行监测并记录相关数据。S104、对步骤S102、S103中获取到的交互行为进行分类汇总，属于用户终端行为的部分构成用户终端行为表，表的字段内容包括但不限于种类、具体内容、行为时间、处理时延和传输时延、该用户终端行为的分段工作状态和对应平均电流；属于链路行为的部分则生成该链路的链路行为图。S105、重复步骤S101~S104直到所有待测链路均生成了链路行为图。需要注意的是，不同的待测链路生成不同的链路行为图，这些链路行为图将组成链路行为库以备后续使用。与链路行为图不同的是，用户终端行为表只有一个，由所有待测链路的测试共同维护。进一步的，步骤S104中，链路行为图由节点和边构成，其中节点表示链路的行为内容，通常就是一种发包行为；节点包括但不限于行为种类、行为时间、处理时延和传输时延。边表示行为的触发条件，根据触发方式的不同边可以分为两类，第一类边表示指向的链路行为由用户终端的行为触发，通常作为用户终端某请求的回复发包，其特征是边上的权重对应于用户终端行为表中的一项；第二类边是链路自身的主动行为，规定链路的所有主动行为均由定时器触发，边上的权重即定时器的当前值，为配合仿真的进行，权重归零即表示行为的立即触发；根据第二类边归零即触发的机制，实际上还实现了链路上多个主动行为的顺序触发，这样可以满足对一些复杂的链路和场景进行建模而不丢失功耗计算的准确度。进一步的，步骤S4中，判断是否需要优化包括以下内容：根据用户终端运行数据评估其功耗策略是否需要优化的主要方法是阈值检测，即记录用户终端一段时间内处于休眠状态下的时间占比，当时间占比低于阈值时，则需要进行优化，否则不需要进行优化。进一步的，步骤S5中，匹配包括以下子步骤：S501、服务器根据用户终端采集到的链路行为数据进行链路行为图的生成，这里由于用户终端在单个采样周期内的采样时间有限，从而生成的链路行为图一般只含有一部分链路行为，故称为链路行为子图的生成。S502、遍历链路行为库中的所有链路行为图，计算与链路行为子图的相似度，得到相似度最高的链路行为图，若最高相似度达到预设的相似度阈值，则可以认为链路行为子图在链路行为库中匹配成功，获取匹配的链路行为图对应的最小功耗的功耗参数，转到步骤S7，否则转到步骤S6。进一步的，步骤S501中，生成链路行为子图包括以下子步骤：S5011、遍历链路行为数据中的所有用户终端行为，在用户终端行为表中找到对应项并更新参数的属性使用户终端行为表中的属性数据与链路行为数据中的一致。S5012、遍历链路行为数据中的所有链路行为，每一个链路行为对应一个节点，节点的属性包括但不限于节点行为的发送时间和传输时延。S5013、根据链路行为数据解析每个链路行为对应的触发条件并在行为图中用边的形式进行构造。进一步的，步骤S502中，匹配包括以下子步骤：S5021、将链路行为子图和匹配的链路行为图表示为图的邻接矩阵和节点特征矩阵。S5022、构建一个基于GCNs的图匹配模型，用于学习链路行为子图和匹配的链路行为图之间的匹配关系。将链路行为子图作为输入图，匹配的链路行为图作为目标图，通过基于GCNs的图匹配模型学习节点的匹配特征。S5023、利用学习到的匹配特征计算节点间的匹配得分。S5024、根据计算得到的匹配得分，输出链路行为子图与匹配的链路行为图之间的节点匹配结果。通过多轮迭代和优化，可以根据匹配结果调整模型参数，以提高匹配准确性和优化效果。整个过程旨在不断优化匹配，确保链路行为子图和匹配的链路行为图间节点的准确匹配。进一步的，步骤S5023中，余弦相似度的计算公式为：；其中，表示两个向量/＞和/＞之间的余弦相似度，/＞表示第i个向量，/＞表示/＞邻居节点集合中的第j个向量，k表示向量中的维度索引，G表示向量的维数，/＞表示向量/＞在第k维的分量，/＞表示向量/＞在第k维的分量。进一步的，步骤S6中，得到完整的链路行为图包括以下子步骤：S601、首先着重对链路行为子图进行编码，将子图数据以邻接矩阵和节点特征矩阵的形式输入到基于GCNs的图匹配模型中，图神经网络经过多层的节点特征传播和聚合学习子图的节点特征表示。S602、接着在GCNs进行前向传播的过程中，得到链路行为子图节点的特征并对该特征进行融合，选择对节点特征取平均或进行池化操作，以得到整体子图的特征表示。S603、随后进入图生成阶段，选取生成对抗网络，逐步构建完整图的结构，包括新节点和边的生成。同时通过随机初始化或其他方式生成节点特征，为生成的节点赋予特征，将生成的节点特征和链路行为子图的节点特征进行融合从而获得最终完整链路行为图的特征表示。S604、通过去除重复边、保证图的连通性，对完整链路行为图的结构进行优化和修复，获得更符合实际和满足链路行为图应用要求的完整的链路行为图。本发明采用以上技术方案，与现有技术相比，其显著技术效果如下：本发明构建了链路行为图，利用此图结合图神经网络以及相关深度学习技术，在线地对用户终端功耗问题进行优化。利用图网可以处理复杂问题的特性，将用户终端链路的行为嵌入，并且通过训练模型，可以将市面上绝大部分的链路行为构建出来，因此此方法具备很大的兼容性；由于在线技术的使用，使得用户终端功耗策略的更新可以快速传达，更加高效；基于这两点，此方法可以在原有基础上对功耗进行进一步的优化，将电量消耗进一步降低，以达到具有竞争力的功耗优化效果。附图说明图1是本发明的整体实施流程图。图2是本发明实施例中实验环境下的硬件连接图。图3是本发明实施例中链路行为图的示例图。图4是本发明实施例中生产环境下的硬件连接图。具体实施方式下面将结合说明书附图和具体实施方式对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员所获得的所有其他实施例，都属于本发明保护的范围。以物联网链路中较为典型的WiFi链路为例，本发明提出了一种物联网终端功耗策略在线优化的方法，如图1所示，包括以下步骤：S1、对用户终端和链路进行全面扫描，并根据链路的行为数据得到链路行为图，具体内容为：S101、对于WiFi链路，使用WiFi抓包卡和WiFi协议分析软件对用户终端与链路之间的交互行为及相关数据进行监测，包括但不限于交互行为的种类、具体内容、行为时间、处理时延和传输时延；使用功耗分析设备和逻辑分析设备对用户终端的实时电流和工作状态进行采样分析，获取各用户终端行为的分段工作状态和分段统计电流。本实施例中使用WiFi抓包卡和WiFi协议分析软件工具，搭建如图2所示的实验环境，除了用户终端与链路外，还包括主机、抓包器、功耗分析计和逻辑分析仪，主机一方面与抓包器、功耗分析计和逻辑分析仪相连，充当测试仪器的主控端，另一方面主机自身运行着链路行为图生成程序和仿真优化系统，以便在实验环境下完成链路行为库的构建任务。此外，为了得到用户终端行为的分段状态，在控制用户终端状态切换的软件代码中添加桩点，桩点的插入通过添加控制GPIO信号翻转的代码来实现。使用逻辑分析仪抓取GPIO信号的翻转并统计两次翻转之间的时间间隔作为用户终端行为中处于不同工作状态下的时间，为确保用户终端状态时间统计正确，应该确保逻辑分析仪的采样率至少高于两倍的GPIO信号翻转频率。S102、控制用户终端保持被动响应状态，使用抓包器对链路的主动发包行为进行监测并记录后续用户终端与链路发生的交互行为及相关数据。S103、根据链路协议将链路中可能发生的交互行为进行汇总，获得链路测试行为集，依次选取测试行为集中的每一项作为待测行为，控制用户终端向链路发起待测行为，使用抓包器对用户终端与链路之间的交互行为进行监测并记录相关数据。S104、对步骤S102、S103中获取到的交互行为进行分类汇总，属于用户终端行为的部分构成用户终端行为表，表的字段内容包括但不限于种类、具体内容、行为时间、处理时延和传输时延、该用户终端行为的分段工作状态和对应平均电流；属于链路行为的部分则生成该链路的链路行为图。链路行为图由节点和边构成，其中节点表示链路的行为内容，通常就是一种发包行为；节点包括但不限于行为种类、行为时间、处理时延和传输时延。边表示行为的触发条件，根据触发方式的不同边可以分为两类，第一类边表示指向的链路行为由用户终端的行为触发，通常作为用户终端某请求的回复发包，其特征是边上的权重对应于用户终端行为表中的一项；第二类边是链路自身的主动行为，规定链路的所有主动行为均由定时器触发，边上的权重即定时器的当前值，为配合仿真的进行，权重归零即表示行为的立即触发；根据第二类边归零即触发的机制，实际上还实现了链路上多个主动行为的顺序触发，这样可以满足对一些复杂的链路和场景进行建模而不丢失功耗计算的准确度。根据本实施例中的WiFi链路，链路行为图的生成规则如下：规则1、链路行为图的节点表示路由器的任意发包行为，要求包的数量必须为1，如有多个包同时按顺序发送，需要使用权重为0的有向边连接的多个节点表示。规则2、链路行为图中权重为0的有向边表示所指节点发包行为的触发方式为立即触发，链路在完成上一个发包行为后会立即开始下一次发包行为，而无需等待其他的触发条件。规则3、链路行为图上权重为正整数n的有向边表示延迟触发的行为，权重n表示延迟时间，随着仿真的进行，边上的权重会自动减小直到为0，减为0表示该行为可以触发；如果该有向边指向节点自身，则表示该节点是一个周期的链路行为，权重n同样可以视作延迟时间，与指向其它节点的行为不同的是指向自身的行为在完成触发后，边上的权重会立即重置为行为周期；权重为用户终端行为表中索引的有向边表示该链路行为的触发条件为用户终端行为，有向边指向的节点行为作为用户终端行为的响应由用户终端行为触发。本实施例中，如图3所示，其中一个链路的链路行为图为：节点P0表示路由器每隔102.4ms会发送一次beacon帧；SP1表示终端发送probe request侦听请求；P1表示路由器回复probe response；SP2表示终端发送认证请求authentication open seq1；P2表示路由器回复authentication open seq2；SP3表示终端发送association request；P3表示路由器回复association response；P4表示路由器在终端接入网络后会每隔30s发送一次null数据包以确认终端是否仍在网络中；SP4表示终端发送data数据包；P5表示路由器回复ack应答包；P6表示路由器在x秒后发送一个data数据包；SP5表示终端发送ack应答包。上述SP1~SP5均为用户终端行为表中的项，用户终端行为表包含了所有可以由终端发起的通信行为，此外还记录了每个发包行为需要的执行时间和发送时延信息。保持用户终端和链路稳定的连接状态，控制用户终端不做任何的主动行为，此时使用抓包器监测链路的主动行为以及用户终端的响应行为将它们分别记录在链路行为图和用户终端行为表中。对测试行为集中的每一项进行测试，测试行为集由链路协议中规定的包交互构建，可能包括数百项待测行为，并且通常会随链路供应商实现方式的不同而产生差异，通过对测试行为集进行全量测试，得以对链路的实际行为有明确的认知，它们都会以链路行为图的方式存储在数据库中。S105、重复步骤S101~S104，直到所有待测链路均生成链路行为图。S2、将步骤S1中的链路行为图输入到SBO系统中，得到使得用户终端功耗最小的功耗参数，具体内容为：S201、定义用户终端在四种工作状态s1=Active状态、s2=Sleep状态、s3=Transmit状态、s4=Receive状态，通过功耗分析设备得到用户终端处于不同状态下的平均电流分别为c1=5mA/min、c2=0.1mA/min、c3=50mA/min、c4=20mA/min，通过统计仿真过程中用户终端处于各个状态的时间t1=10s、t2=75s、t3=5s、t4=10s，则用户终端的平均功耗P=/*V=/100*3.3=16.7475mW，其中V是用户终端的输入电压，仿真假设用户终端输入电压固定不变，且与实验环境下用户终端的输入电压一致，均为3.3V。S202、使用仿真参数表征用户终端的功耗策略。S203、选取遗传算法作为仿真优化系统的优化算法，初始化种群，种群中的个体即为功耗策略，一组功耗参数表示为T=，pN表示第N个功耗参数，这些功耗参数将对仿真中用户终端和链路的行为产生影响，进而影响用户终端的仿真功耗，种群的初始化由符合功耗参数边界条件的随机数产生。S204、计算种群的适应度：将各个个体的功耗参数向量T输入到仿真系统的用户终端程序中，启动仿真并计算用户终端的平均功耗，根据适应度的计算公式：，其中/＞为预设的适应度计算参数，且/＞＞1即可得到种群中个体的适应度，在上述WI-FI链路示例中，/＞=2，则/＞。如果种群中已经存在满足适应度要求的个体，则输出当前适应度最高的个体，否则执行步骤S205。S205、执行选择、交叉、变异操作后得到新的种群，重复执行步骤S204直至满足迭代搜索的次数大于1000或相邻两次迭代间功耗结果的变化误差小于0.5%。选择操作即根据适应度选择个体，选取适应度得分最高的m个个体，m为预设的选择参数；交叉操作随机选择两个个体作为父代，随机交换他们的一个功耗参数，将新产生的个体加入到种群中；变异操作随机选择a个个体，随机替换他们的一个功耗参数并将产生的个体加入到种群中，替换后的功耗参数应当满足参数的边界条件。S3、将步骤S1中的链路行为图和步骤S2中的最小的功耗参数进行集中存储，并按照其对应关系构建链路行为库。S4、如图4所示，构建客户物联网设备的实际应用场景，用户终端需要通过互联网与服务器进行数据通讯，定期向服务器发送自身的运行数据和采集到的用户链路行为数据，其中，用户终端自身的运行数据主要包括用户终端处于不同状态下的时间统计，采集到的用户链路行为数据主要包括包的交互信息，收发包的时刻等。服务器评估用户终端的功耗策略是否需要优化，评估方法一方面根据用户终端处于不同状态下的时间乘以不同状态下的理论平均电流再除以总时间估算出用户终端的平均功耗，当估算的功耗小于经验值时，可直接判定评估结果为优，取平均功耗低于20mW的判断为优，平均功耗等于或高于20mW的则需要进行优化；另一方面会根据采集到的链路行为数据，分析链路行为的类型，是否有正常业务交互之外的其它链路交互开销，如果发现有其它的链路交互开销，可直接判定评估结果为优以下；对于未发现有其它链路交互开销且估算的功耗大于经验值时，则可能是客户应用场景的业务交互频繁导致的估测功耗超过阈值，对于这种情况，需要进一步计算估测的功耗与业务包交互个数之间的比值，若最终的比值处在合理范围区间内，可同样评估结果为优，若比值结果在经验值以外，则评估结果为优以下。评估结果为优则无需进行策略优化，评估结果在优以下，则转到步骤S5。S5、服务器根据用户终端采集到的链路行为数据生成链路行为子图，利用相似度算法将其与链路行为库进行匹配，若匹配成功，则从链路行为库中获取匹配的链路行为图对应的最小的功耗参数并转到步骤S7，否则转到步骤S6，具体内容为：S501、服务器根据用户终端在单个采样周期内采集到的链路行为数据生成链路行为子图，具体内容为：S5011、遍历链路行为数据中的所有用户终端行为，在用户终端行为表中找到对应项并更新参数的属性使用户终端行为表中的属性数据与链路行为数据中的一致；S5012、遍历链路行为数据中的所有链路行为，每一个链路行为对应一个节点，节点的属性包括但不限于节点行为的发送时间和传输时延；S5013、根据链路行为数据解析每个链路行为对应的触发条件并在行为图中用边的形式进行构造。S502、遍历链路行为库中的所有链路行为图，计算与链路行为子图的相似度，得到相似度最高的链路行为图；若最高相似度达到0.85，则链路行为子图在链路行为库中匹配成功，获取匹配的链路行为图对应的最优功耗参数，转到步骤S7，否则转到步骤S6，具体内容为：S5021、将链路行为子图和匹配的链路行为图表示为图的邻接矩阵和节点特征矩阵；链路行为子图S和匹配的链路行为图T被表示为图数据结构，包括节点特征矩阵和邻接矩阵/＞。S5022、构建一个基于GCNs的图匹配模型，将链路行为子图作为输入图，匹配的链路行为图作为目标图，通过基于GCNs的图匹配模型学习节点的匹配特征，具体内容为：在每一层，通过聚合节点的邻居信息并结合自身特征，更新节点的表示。假设表示/＞的邻居节点集合，那么/＞的邻居信息聚合可以表示为：；其中，表示第i个向量，/＞表示第l层的权重矩阵，/＞表示第l-1层/＞的特征，/＞表示向量/＞的邻居信息聚合，/＞表示向量/＞邻居节点集合中的第j个向量；GCNs考虑节点自身的特征，将向量的自身特征考虑进去：；其中，表示第l层的自身特征的权重矩阵，/＞表示/＞在第l层的自身特征向量，/＞表示第l-1层/＞的特征；将邻居信息聚合和自身特征更新结合起来，得到在第l层的新特征：；其中，表示/＞在第l层的总特征向量；通过多层GCNs网络堆叠，每一层的节点表示都可以作为下一层的输入；多层网络堆叠可以逐步提取更高级的特征，用于表达图的结构和信息。S5023、利用学习到的匹配特征计算节点间的余弦相似度，具体公式为：；其中，表示两个向量/＞和/＞之间的余弦相似度，k表示向量中的维度索引，G表示向量的维数，/＞表示向量/＞在第k维的分量，/＞表示向量/＞在第k维的分量。S5024、根据余弦相似度，输出链路行为子图与匹配的链路行为图之间的节点匹配结果；通过多轮迭代和优化，根据匹配结果调整模型参数，完成链路行为子图和匹配的链路行为图间节点的匹配。S6、通过图神经网络的生成算法对步骤S5中生成的链路行为子图进行二次生成得到完整的链路行为图，将该链路行为图输入到步骤S2中的仿真优化系统中，得到新链路的最小的功耗参数，具体内容为：S601、对链路行为子图进行编码，将子图数据以邻接矩阵和节点特征矩阵的形式输入到图神经网络GCN中，图神经网络经过多层的节点特征传播和聚合学习子图的节点特征表示。S602、对链路行为子图节点特征进行融合，得到整体子图的特征表示。S603、利用生成对抗网络模型，生成新节点和边，构建完整链路行为图的结构；生成节点特征，将该特征和子图节点特征进行融合，获得完整链路行为图的特征表示。S604、通过去除重复边、保证图的连通性，对完整链路行为图的结构进行优化和修复，获得更符合实际和满足链路行为图应用要求的完整的链路行为图。综合而言，步骤S6子图生成完整图的整体流程包括子图输入、子图特征编码、生成图结构、生成节点特征、图特征融合和图结构优化等关键步骤。这些步骤共同完成了子图到完整图的生成过程，通过图神经网络和生成模型的协同作用，实现了高效而准确的子图生成完整图的目标。S7、服务器将最小的功耗参数联网传输到用户终端，并下发参数更新指令，完成用户终端的功耗策略升级。以上所述仅为本发明的示例性实施例，并非因此限制本发明的保护范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的保护范围内。
