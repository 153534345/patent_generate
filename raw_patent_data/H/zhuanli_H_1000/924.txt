标题title
密钥协商方法、装置、系统及电子设备
摘要abst
本申请提供一种密钥协商方法、装置、系统及电子设备。本申请协商双方，也即第一通信端和第二通信端，各自生成随机数组并加密发送给对方，这样没有密钥的非法窃听者无法判断出发送的协商比特，也就无法由窃取信号统计误码率，这是密钥协商安全性的基本保证。且通过相应的接收信号判决结果与发送随机数组比较并将结果反馈给对方，解决了难以找到相同时间窗的难题，并且协商的第一通信端和第二通信端各自加入了对误码起较大作用的第一噪声或第二噪声，这样即使非法方窃取到了光纤链路噪声，也无法计算出第一通信端和第二通信端得到的误码率，从而很好地保证了密钥协商方法的安全性。
权利要求书clms
1.一种密钥协商方法，其特征在于，应用于第一通信端，所述方法包括：生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；根据所述第一数组确定第一种子密钥。2.根据权利要求1所述的方法，其特征在于，所述将所述第一加密信息帧发送至所述第二通信端，包括：将所述第一加密信息帧加载到载波光波以将所述第一加密信息帧调制为光信号形式，并将光信号形式的第一加密信息帧发送至所述第二通信端。3.根据权利要求1所述的方法，其特征在于，所述根据所述第七随机数组和所述第二随机数组确定第三比特异或数组，包括：比较所述第七随机数组和所述第二随机数组中相对应位置的比特；响应于所述第七随机数组和所述第二随机数组中相对应位置的比特相同，则所述相对应位置的输出结果为0；和/或，响应于所述第七随机数组和所述第二随机数组中相对应位置的比特不同，则所述相对应位置的输出结果为1；根据所述第七随机数组和所述第二随机数组中每个相对应位置的输出结果确定所述第三比特异或数组。4.根据权利要求1所述的方法，其特征在于，所述根据所述第一数组确定第一种子密钥，包括：响应于所述第一数组中的第一数量的个数达到预设数量，则计算所述第一数组的第一均值和第一标准方差，并根据所述第一均值和所述第一标准方差确定第一目标范围；将所述第一数组中位于所述第一目标范围内的元素剔除以确定第一候选数组；获取与所述第二通信端对应的保留元素信息，并将所述第一候选数组和所述第二候选数组中都保留的元素组成第一中间数组；其中，所述第二通信端对应的保留元素信息用于表征与所述第二通信端对应的第二候选数组中所保留的元素信息；对于所述第一中间数组中的每个元素，响应于所述元素大于所述第一均值，则将所述元素的判定结果置为1，和/或，响应于所述元素小于所述第一均值，则将所述元素的判定结果置为0；根据所述第一中间数组中每个元素的判定结果确定第一密钥材料；根据所述第一密钥材料计算纠错监督码，并将所述纠错监督码发送至所述第二通信端；响应于确定所述第二通信端中的第二密钥材料完成纠错操作，则对第一密钥材料进行隐私放大以及对应处理以得到所述第一种子密钥；和/或，响应于确定所述第二通信端中的第二密钥材料无法完成纠错操作，则重新执行确定第一种子密钥的全部步骤。5.一种密钥协商方法，其特征在于，应用于第二通信端，所述方法包括：接收来自于第一通信端的第一加密信息帧，分别在所述第一加密信息帧中与第一随机数组和第二随机数组对应的位置添加第二噪声，进行数据判决以恢复出第五加密信息帧，并利用由所述第一通信端指向第二通信端的第一会话密钥对所述第五加密信息帧进行解密以确定第三随机数组和第四随机数组；其中，所述第一加密信息帧是根据所述第一随机数组和所述第二随机数组确定的；生成第五随机数组和第六随机数组，并根据所述第三随机数组和所述第六随机数组确定第一比特异或数组；根据所述第五随机数组、第六随机数组以及所述第一比特异或数组进行组帧以确定第二待发送信息帧，并利用由第二通信端指向第一通信端的第二会话密钥对所述第二待发送信息帧进行加密以确定第二加密信息帧，并将所述第二加密信息帧发送至第一通信端；接收来自于第一通信端的第三加密信息帧，利用所述第一会话密钥对所述第三加密信息帧进行解密以确定第四比特异或数组；根据所述第四随机数组和所述第五随机数组确定第五比特异或数组，并根据所述第五比特异或数组和所述第四比特异或数组确定第六比特异或数组；计算所述第六比特异或数组中数值1对应的第二数量，并将所述第二数量保存于第二数组；根据所述第二数组确定第二种子密钥。6.根据权利要求5所述的方法，所述根据所述第二数组确定第二种子密钥，包括：响应于所述第二数组中的第二数量的个数达到预设数量，则计算所述第二数组的第二均值和第二标准方差，并根据所述第二均值和所述第二标准方差确定第二目标范围；将所述第二数组中位于所述第二目标范围内的元素剔除以确定第二候选数组；获取与所述第一通信端对应的保留元素信息，并根据所述第一候选数组和所述第二候选数组中都保留的元素组成第二中间数组；其中，所述第一通信端对应的保留元素信息用于表征与所述第一通信端对应的第一候选数组中所保留的元素信息；对于所述第二中间数组中的每个元素，响应于所述元素大于所述第二均值，则将所述元素的判定结果置为1，和/或，响应于所述元素小于所述第二均值，则将所述元素的判定结果置为0；根据所述第二中间数组中每个元素的判定结果确定第二密钥材料；接收来自于所述第一通信端中根据第一密钥材料计算得到的纠错监督码，根据所述纠错监督码对第二密钥材料进行纠错；将用于表征所述第二通信端能否完成纠错操作的指示信息发送至第一通信端；响应于所述第二通信端能够完成纠错操作，则将所述第二密钥材料纠错后的数组确定为第三密钥材料，对第三密钥材料进行隐私放大及对应处理以得到所述第二种子密钥。7.一种密钥协商装置，其特征在于，应用于第一通信端，所述装置包括：生成模块，被配置为生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；第一发送模块，被配置为利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；第一确定模块，被配置为接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；第二确定模块，被配置为根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；第二发送模块，被配置为根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；第三确定模块，被配置为根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算模块，被配置为计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；第四确定模块，被配置为根据所述第一数组确定第一种子密钥。8.一种密钥协商装置，其特征在于，应用于第二通信端，所述装置包括：第一确定模块，被配置为接收来自于第一通信端的第一加密信息帧，分别在所述第一加密信息帧中与第一随机数组和第二随机数组对应的位置添加第二噪声，进行数据判决以恢复出第五加密信息帧，并利用由所述第一通信端指向第二通信端的第一会话密钥对所述第五加密信息帧进行解密以确定第三随机数组和第四随机数组；其中，所述第一加密信息帧是根据所述第一随机数组和所述第二随机数组确定的；生成模块，被配置为生成第五随机数组和第六随机数组，并根据所述第三随机数组和所述第六随机数组确定第一比特异或数组；发送模块，被配置为根据所述第五随机数组、第六随机数组以及所述第一比特异或数组进行组帧以确定第二待发送信息帧，并利用由第二通信端指向第一通信端的第二会话密钥对所述第二待发送信息帧进行加密以确定第二加密信息帧，并将所述第二加密信息帧发送至第一通信端；第二确定模块，被配置为接收来自于第一通信端的第三加密信息帧，利用所述第一会话密钥对所述第三加密信息帧进行解密以确定第四比特异或数组；第三确定模块，被配置为根据所述第四随机数组和所述第五随机数组确定第五比特异或数组，并根据所述第五比特异或数组和所述第四比特异或数组确定第六比特异或数组；计算模块，被配置为计算所述第六比特异或数组中数值1对应的第二数量，并将所述第二数量保存于第二数组；第四确定模块，被配置为根据所述第二数组确定第二种子密钥。9.一种密钥协商系统，其特征在于，所述系统包括：第一通信端，被配置为执行如权利要求1至4中任意一项所述的方法；第二通信端，被配置为执行如权利要求5至6中任意一项所述的方法。10.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至4任意一项所述的方法或如权利要求5至6任意一项所述的方法。
说明书desc
技术领域本申请涉及计算机技术领域，尤其涉及一种密钥协商方法、装置、系统及电子设备。背景技术相关技术中，通常将光纤链路部署在野外，因此光信号容易被窃取，而协商规则是公开的，可以通过模拟合法通信端进行分析处理，利用光纤链路中噪声特性，在光纤链路两端窃取光信号，利用信号处理技术也能得到类似的噪声特性，因此相关技术中的密钥协商方式存在着安全性较低的问题。发明内容有鉴于此，本申请的目的在于提出一种密钥协商方法、装置、系统及电子设备。基于上述目的，在第一方面，本申请提供了一种密钥协商方法，应用于第一通信端，所述方法包括：生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；根据所述第一数组确定第一种子密钥。在第二方面，本申请提供了一种密钥协商方法，应用于第二通信端，所述方法包括：接收来自于第一通信端的第一加密信息帧，分别在所述第一加密信息帧中与第一随机数组和第二随机数组对应的位置添加第二噪声，进行数据判决以恢复出第五加密信息帧，并利用由所述第一通信端指向第二通信端的第一会话密钥对所述第五加密信息帧进行解密以确定第三随机数组和第四随机数组；其中，所述第一加密信息帧是根据所述第一随机数组和所述第二随机数组确定的；生成第五随机数组和第六随机数组，并根据所述第三随机数组和所述第六随机数组确定第一比特异或数组；根据所述第五随机数组、第六随机数组以及所述第一比特异或数组进行组帧以确定第二待发送信息帧，并利用由第二通信端指向第一通信端的第二会话密钥对所述第二待发送信息帧进行加密以确定第二加密信息帧，并将所述第二加密信息帧发送至第一通信端；接收来自于第一通信端的第三加密信息帧，利用所述第一会话密钥对所述第三加密信息帧进行解密以确定第四比特异或数组；根据所述第四随机数组和所述第五随机数组确定第五比特异或数组，并根据所述第五比特异或数组和所述第四比特异或数组确定第六比特异或数组；计算所述第六比特异或数组中数值1对应的第二数量，并将所述第二数量保存于第二数组；根据所述第二数组确定第二种子密钥。在第三方面，本申请提供了一种密钥协商装置，应用于第一通信端，所述装置包括：生成模块，被配置为生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；第一发送模块，被配置为利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；第一确定模块，被配置为接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；第二确定模块，被配置为根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；第二发送模块，被配置为根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；第三确定模块，被配置为根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算模块，被配置为计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；第四确定模块，被配置为根据所述第一数组确定第一种子密钥。在第四方面，本申请提供了一种密钥协商装置，应用于第二通信端，所述装置包括：第一确定模块，被配置为接收来自于第一通信端的第一加密信息帧，分别在所述第一加密信息帧中与第一随机数组和第二随机数组对应的位置添加第二噪声，进行数据判决以恢复出第五加密信息帧，并利用由所述第一通信端指向第二通信端的第一会话密钥对所述第五加密信息帧进行解密以确定第三随机数组和第四随机数组；其中，所述第一加密信息帧是根据所述第一随机数组和所述第二随机数组确定的；生成模块，被配置为生成第五随机数组和第六随机数组，并根据所述第三随机数组和所述第六随机数组确定第一比特异或数组；发送模块，被配置为根据所述第五随机数组、第六随机数组以及所述第一比特异或数组进行组帧以确定第二待发送信息帧，并利用由第二通信端指向第一通信端的第二会话密钥对所述第二待发送信息帧进行加密以确定第二加密信息帧，并将所述第二加密信息帧发送至第一通信端；第二确定模块，被配置为接收来自于第一通信端的第三加密信息帧，利用所述第一会话密钥对所述第三加密信息帧进行解密以确定第四比特异或数组；第三确定模块，被配置为根据所述第四随机数组和所述第五随机数组确定第五比特异或数组，并根据所述第五比特异或数组和所述第四比特异或数组确定第六比特异或数组；计算模块，被配置为计算所述第六比特异或数组中数值1对应的第二数量，并将所述第二数量保存于第二数组；第四确定模块，被配置为根据所述第二数组确定第二种子密钥。在第五方面，本申请提供了一种密钥协商系统，所述系统包括：第一通信端，被配置为执行如第一方面所述的密钥协商方法；第二通信端，被配置为执行如第二方面所述的密钥协商方法。在第六方面，本申请提供了一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如第一方面或第二方面所述的密钥协商方法。从上面所述可以看出，本申请提供的一种密钥协商方法、装置、系统及电子设备，第一通信端生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；根据所述第一数组确定第一种子密钥。本申请通过相应的接收信号判决结果与发送随机数组比较并将结果反馈给对方，解决了难以找到相同时间窗的难题，并且协商的第一通信端和第二通信端各自加入了对误码起较大作用的第一噪声或第二噪声，这样即使非法方窃取到了光纤链路噪声，也无法计算出第一通信端和第二通信端得到的误码率，从而很好地保证了密钥协商方法的安全性。附图说明为了更清楚地说明本申请或相关技术中的技术方案，下面将对实施例或相关技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1示出了本申请实施例所提供的一种应用于第一通信端的密钥协商方法的示例性流程示意图。图2示出了本申请实施例所提供的一种应用于第二通信端的密钥协商方法的示例性流程示意图。图3示出了根据本申请的实施例中的第一通信端和第二通信端密钥协商交互过程的示例性流程示意图。图4示出了本申请实施例所提供的一种应用于第一通信端的密钥协商装置的示例性结构示意图。图5示出了本申请实施例所提供的一种应用于第二通信端的密钥协商装置的示例性结构示意图。图6示出了本申请实施例所提供的一种密钥协商系统的示例性结构示意图。图7示出了本申请实施例所提供的一种电子设备的示例性结构示意图。具体实施方式为使本申请的目的、技术方案和优点更加清楚明白，以下结合具体实施例，并参照附图，对本申请进一步详细说明。需要说明的是，除非另外定义，本申请实施例使用的技术术语或者科学术语应当为本申请所属领域内具有一般技能的人士所理解的通常意义。本申请实施例中使用的“第一”、“第二”以及类似的词语并不表示任何顺序、数量或者重要性，而只是用来区分不同的组成部分。“包括”或者“包含”等类似的词语意指出现该词前面的元件或者物件涵盖出现在该词后面列举的元件或者物件及其等同，而不排除其他元件或者物件。“连接”或者“相连”等类似的词语并非限定于物理的或者机械的连接，而是可以包括电性的连接，不管是直接的还是间接的。“上”、“下”、“左”、“右”等仅用于表示相对位置关系，当被描述对象的绝对位置改变后，则该相对位置关系也可能相应地改变。如背景技术部分所述，相关技术中，通常将光纤链路部署在野外，因此光信号容易被窃取，而协商规则是公开的，可以通过模拟合法通信端进行分析处理，利用光纤链路中噪声特性，在光纤链路两端窃取光信号，利用信号处理技术也能得到类似的噪声特性。通过发明人的研究发现，该相关技术中，密钥协商方式存在着安全性较低的问题。而另一种相关技术中，合法双方利用光纤传输系统物理特性在相同时刻存在强相关性，但事实上所谓的相同时刻并不存在，因为光在光纤中传输时延约5微妙/千米，而高速光纤传输系统都是几十千米、甚至几千千米，光信号从发送到达对端需要数十微妙到数毫秒时间，这个时延对密钥协商而言就太大了。例如，利用双方本地的光源测量接收到的光信号相位噪声特性，如没有传输系统时延，则双方各自独立测量得到的相位噪声特性强相关。但通过发明人的研究发现，该相关技术中，时延的存在就无法满足同一时刻测量，因而影响其可行性。正因如此，本申请提供了一种密钥协商方法、装置、系统及电子设备，第一通信端生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；根据所述第一数组确定第一种子密钥。本申请通过相应的接收信号判决结果与发送随机数组比较并将结果反馈给对方，解决了难以找到相同时间窗的难题，并且协商的第一通信端和第二通信端各自加入了对误码起较大作用的第一噪声或第二噪声，这样即使非法方窃取到了光纤链路噪声，也无法计算出第一通信端和第二通信端得到的误码率，从而很好地保证了密钥协商方法的安全性。在一些具体的应用场景中，本申请的密钥协商方法可以应用于各种涉及密钥协商的系统中，该系统可以通过PC端来运行，也可以通过手机或者平板电脑等移动端来运行。在一些具体的应用场景中，本申请的密钥协商方法可以直接应用在本地运行，也可以在云端服务器中运行。当在云端服务器运行时，将获取的待处理数据通过网络发送到云端服务器，由服务器对待处理数据通过本申请的密钥协商方法进行处理，并将处理结果通过网络发送到本地。下面结合具体的应用场景，来描述根据本申请示例性实施方式的密钥协商方法。需要注意的是，上述应用场景仅是为了便于理解本申请的精神和原理而示出，本申请的实施方式在此方面不受任何限制。相反，本申请的实施方式可以应用于适用的任何场景。下面通过具体的实施例来对本申请实施例所提供的密钥协商方法进行具体说明。图1示出了本申请实施例所提供的一种应用于第一通信端的密钥协商方法的示例性流程示意图。参考图1，本申请实施例所提供的一种密钥协商方法，应用于第一通信端，所述方法具体包括以下步骤：S102：生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧。S104：利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端。S106：接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的。S108：根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组。S110：根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端。S112：根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组。S114：计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组。S116：根据所述第一数组确定第一种子密钥。图2示出了本申请实施例所提供的一种应用于第二通信端的密钥协商方法的示例性流程示意图。参考图2，本申请实施例所提供的一种密钥协商方法，应用于第二通信端，所述方法具体包括以下步骤：S202：接收来自于第一通信端的第一加密信息帧，分别在所述第一加密信息帧中与第一随机数组和第二随机数组对应的位置添加第二噪声，进行数据判决以恢复出第五加密信息帧，并利用由所述第一通信端指向第二通信端的第一会话密钥对所述第五加密信息帧进行解密以确定第三随机数组和第四随机数组；其中，所述第一加密信息帧是根据所述第一随机数组和所述第二随机数组确定的。S204：生成第五随机数组和第六随机数组，并根据所述第三随机数组和所述第六随机数组确定第一比特异或数组。S206：根据所述第五随机数组、第六随机数组以及所述第一比特异或数组进行组帧以确定第二待发送信息帧，并利用由第二通信端指向第一通信端的第二会话密钥对所述第二待发送信息帧进行加密以确定第二加密信息帧，并将所述第二加密信息帧发送至第一通信端。S208：接收来自于第一通信端的第三加密信息帧，利用所述第一会话密钥对所述第三加密信息帧进行解密以确定第四比特异或数组。S210：根据所述第四随机数组和所述第五随机数组确定第五比特异或数组，并根据所述第五比特异或数组和所述第四比特异或数组确定第六比特异或数组。S212：计算所述第六比特异或数组中数值1对应的第二数量，并将所述第二数量保存于第二数组。S214：根据所述第二数组确定第二种子密钥。图3示出了根据本申请的实施例中的第一通信端和第二通信端密钥协商交互过程的示例性流程示意图。参考图3，可以假设第一通信端为Alice，第二通信端为Bob，Alice和Bob通过认证已相互确认为合法通信的双方，并且协商出了两对初始种子密钥，可分别用作Alice到Bob方向和Bob到Alice方向加解密密钥，也即由第一通信端指向第二通信端的第一会话密钥，以及由第二通信端指向第一通信端的第二会话密钥。这两对初始种子密钥通过约定的规则由Alice和Bob各自生成会话密钥用于信息的流加密/解密。假定Alice到Bob方向密钥协商由Alice主导生成，同样Bob到Alice方向密钥协商由Bob主导生成。在一些实施例中，以Alice到Bob方向密钥协商，也即以第一通信端到第二通信端方向的密钥协商为例。具体地，Alice生成两组预设长度的随机二进制数组，也即第一随机数组XA1和第二随机数组XA2，可以将第一随机数组、第二随机数组与Alice侧其他需要发送的信息复用组帧后，得到第一待发送信息帧，利用由Alice指向Bob的第一会话密钥K1进行加密得到第一加密信息帧，对第一加密信息帧进行光调制后发送给Bob。对于第二通信端Bob，将接收到的Alice发送来的加密光信号转换为电信号，对信号帧队列中与XA1和XA2对应位置的信号添加Bob本地产生的高斯噪声，之后进行信号判决等处理，用会话密钥K1进行解密，相应恢复出分别与XA1和XA2对应的第三随机数组XA3和第四随机数组XA4。其中，信号判决与通常的光解调判决完全相同。进一步地，Bob也生成两组长度各为m比特的随机二进制数组，也即第五随机数组XB1和第六随机数组XB2，Bob对第三随机数组XA3和第六随机数组XB2相应比特进行比较，也即计算如相同为0，不同为1，得到长度为m比特的第一比特异或数组C2，Bob将XB1、XB2、C2及Bob侧其他需要发送的信息复用组帧以确定第二待发送信息帧，用由Bob指向Alice方向的第二会话密钥K2进行加密以确定第二加密信息帧，光调制后发送给Alice。再进一步地，在第一通信端Alice处将接收到的Bob发送来的加密光信号转换为电信号，对信号帧队列中与XB1和XB2对应位置的信号添加上Alice本地产生的高斯噪声，之后进行信号判决等处理，从而回复得到第四加密信息帧，并可以用第二会话密钥K2对其进行解密，相应恢复出分别与XB1和XB2对应的第七随机数组XB3和第八随机数组XB4，由C2恢复出第二比特异或数组C4。Alice对第七随机数组XB3和第二随机数组XA2进行比特异或，也即计算得到长度为m比特的第三比特异或数组C1，Alice将C1及Alice侧其他需要发送的信息复用组帧以确定第三待发送信息帧，用由Alice指向Bob方向的第一会话密钥K1进行加密以确定第三加密信息帧，光调制后发送给Bob。再进一步地，Bob接收Alice发来第三加密信息帧，利用第一会话密钥对所述第三加密信息帧进行解密以确定第四比特异或数组C3，Bob对数组第四随机数组XA4和第五随机数组XB1进行比特异或，也即计算得到第五比特异或数组D2；对第五比特异或数组D2和第四比特异或数组C3进行比特异或，也即计算/＞得到长度为m比特的第六比特异或数组E2，计算二进制数组E2中数值1的数量作为一个元素按顺序保存此值于第二数组F2中。而对于第一通信端而言，Alice对第八随机数组XB4和第一随机数组XA1进行比特异或，也即计算得到第七比特异或数组D1；对第七比特异或数组D1和第二比特异或数组C4进行比特异或，也即计算/＞得到长度为m比特的第八比特异或数组E1，计算二进制数组E1中数值1的数量作为一个元素按顺序保存此值于第一数组F1中。需要说明的是，可以重复上述步骤，直至数组F1和F2的元素个数达到预设的n个。并且，其中比特异或的操作例如可以以第三比特异或数组的确定过程为例：比较第七随机数组和第二随机数组中相对应位置的比特；如果第七随机数组和第二随机数组中相对应位置的比特相同，则相对应位置的输出结果为0；如果第七随机数组和第二随机数组中相对应位置的比特不同，则相对应位置的输出结果为1。进一步地，根据第七随机数组和第二随机数组中每个相对应位置的输出结果确定第三比特异或数组。再进一步地，Alice的数组F1和Bob的数组F2作为原始密钥材料各自开启后处理。对于第一通信端而言，可以为响应于所述第一数组中的第一数量的个数达到预设数量，则计算所述第一数组的第一均值和第一标准方差，并根据所述第一均值和所述第一标准方差确定第一目标范围；将所述第一数组中位于所述第一目标范围内的元素剔除以确定第一候选数组；获取与所述第二通信端对应的保留元素信息，并根据所述第一候选数组和所述第二候选数组中的元素确定第一密钥材料；根据所述第一密钥材料计算纠错监督码，并将所述纠错监督码发送至所述第二通信端；响应于确定所述第二通信端中的所述第二密钥材料完成纠错操作，则对第一密钥材料进行隐私放大以及其他对应处理以得到所述第一种子密钥。如果确定第二通信端中的第二密钥材料无法完成纠错操作，则重新开始整个密钥协商流程，也即重新执行步骤S102-S116。其中，与所述第二通信端对应的保留元素信息用于表征与第二通信端对应的第二候选数组中所保留的元素信息。对于第二通信端而言，可以为响应于所述第二数组中的第二数量的个数达到预设数量，则计算所述第二数组的第二均值和第二标准方差，并根据所述第二均值和所述第二标准方差确定第二目标范围；将所述第二数组中位于所述第二目标范围内的元素剔除以确定第二候选数组；获取与所述第一通信端对应的保留元素信息，并根据所述第一候选数组和所述第二候选数组中的元素确定第二密钥材料；接收来自于所述第一通信端中根据所述第一密钥材料计算得到的纠错监督码，根据所述纠错监督码对第二密钥材料进行纠错操作，，完成纠错操作的数组确定为第三密钥材料进行隐私放大以及其他对应处理以得到所述第二种子密钥。其中，第一通信端对应的保留元素信息用于表征与第一通信端对应的第一候选数组中所保留的元素信息。并且，可以由第二通信端将用于表征其是否能够完成纠错操作的指示信息发送至第一通信端，如果第二通信端能够完成纠错操作，则可以将第二密钥材料纠错后得到的数组确定为第三密钥材料，再对第三密钥材料进行隐私放大以及其他对应处理以得到所述第二种子密钥。具体地，对于任意一个通信端而言，可以计算数组均值和标准方差，把均值附近的元素丢弃，Alice和Bob都不丢弃位置的元素、各自组成一个新数组，将其量化为0或1，即为Alice和Bob协商成的第一密钥材料和第二密钥材料。进一步地，按双方商定的纠错规则，Alice对第一密钥材料计算纠错监督码，并将监督码传送给Bob用于纠正第二密钥材料与第一密钥材料双方不一致的比特。进一步进行隐私放大等处理，产生预定长度双方相同的种子密钥，即第一种子密钥和第二种子密钥。需要说明的是，Alice和Bob协商成的第一密钥材料和第二密钥材料包括：将第一候选数组和第二候选数组中相同的元素组成第一中间数组和第二中间数组，并且对于所述中间数组中的每个元素而言，如果元素大于第二均值，则将元素的判定结果置为1；如果元素小于第二均值，则将元素的判定结果置为0。进而根据中间数组中每个元素的判定结果确定第一密钥材料和第二密钥材料。重复上述过程，可以不断生成新的种子密钥，种子密钥按规则扩展为新的会话密钥，光纤传输系统就能持续加密/解密、更新密钥。由Bob到Alice方向的密钥协商原理相同，也即将第一通信端和第二通信端对调，执行本申请所提出的方法，即可得到由Bob到Alice方向的密钥协商方法。在一些实施例中，本地高斯噪声的产生可以由硬件电路或逻辑电路实现。通常光纤传输系统误码率都比较低，如2E-2以下，而且比较平稳且变化缓慢，而本发明的密钥协商希望各个误码统计时段内误码比特数量变化明显，需要依靠本地添加的噪声来实现，也就是说本地产生的这个噪声需要有较好的随机性，同时不同的统计时段内噪声方差随机变化要比较大。随机数组长度m值设定原则：相同的噪声方差下，系统的误码比特数量比较稳定，建议m值大于200，但太长会加长密钥协商时间，降低密钥更新速度。第一数组和第二数组元素个数n值默认为种子密钥长度的2倍以上。随机数组长度m值和第一数组和第二数组元素个数n值，可以采用人工智能技术自动优化。下面，以一个具体的实施方式为例，例如以最常见的10G强度调制直接检测光传输系统为例。业务按OTN标准映射到OTU2帧中，增加OTU层开销，在4*4080字节标准OTU2帧结构外增加2*255字节，其中一个255字节用于传输密钥协商数据比特；另一个255字节中239字节用于传输密钥协商中的交互信息，16字节作为RS前向纠错编码生成的监督比特，整个帧结构如表1所示。表1加密光传输信号帧结构通信双方假定为Alice和Bob，Alice和Bob在上电后要启动身份认证，通过认证相互确认为合法通信的双方，可采用SM2国密标准协商出两对初始种子密钥，这两对初始种子密钥通过约定的规则由Alice和Bob各自生成会话密钥分别用作Alice到Bob方向和Bob到Alice方向加解密密钥，用于OTU2帧中除帧头和OTU2OH外所有数据的流加密/解密。本发明方法是用于继续协商出新的种子密钥，满足密钥持续定期或不定期更新之要求。以Alice到Bob方向密钥协商为例，密钥协商基本步骤为：Alice生成两组预设长度的随机二进制数组XA1和XA2，两数组按字节复用后插入到帧中的协商数据1位置，协商数据区结构如表2所示。除了帧头和OTU2 OH外，都用Alice到Bob的会话密钥K1进行流加密，光强度调制后发送给Bob；表2协商数据区结构状态指示发送序号协商数据1响应序号协商数据2保留1byte2byte 124byte2byte 124byte2byte表2中的状态指示表示有无协商数据；发送序号从1开始增加到65535循环，后面跟的协商数据1即为数组XA1和XA2，序号0表示无协商数据发送；响应序号是对端发送序号，后面跟的协商数据2即为相对应的反馈，同样序号0表示无协商数据。更进一步说，Alice发送出的协商数据区的协商数据1是用于Alice到Bob方向的密钥协商，而协商数据区2是响应Bob到Alice方向的密钥协商。Bob将接收到的Alice发送来的加密光信号转换为电信号，对信号帧队列XA1和XA2位置信号添加Bob本地产生的高斯噪声，之后进行信号判决等处理，用会话密钥K1进行流解密，相应恢复出XA3和XA4；Bob也生成两组长度各为496比特的随机二进制数组XB1和XB2，两数组按字节复用后插入到帧中的协商数据2位置；计算62字节的C2增加包头插入到帧的交互信息区，除了帧头和部分OTU2开销外，都用Bob到Alice方向的会话密钥K2进行流加密，光强度调制后发送给Alice；Alice将接收到的Bob发送来的加密光信号转换为电信号，对信号帧队列XB1和XB2位置信号添加上Alice本地产生的高斯噪声，之后进行信号判决等处理，用会话密钥K2进行流解密，相应恢复出XB3、XB4，由C2恢复出C4；Alice计算62字节的C1增加包头插入到帧的交互信息区，除了帧头和部分OTU2开销外，用Alice到Bob方向的会话密钥K1进行流加密，光强度调制后发送给Bob；/＞Bob接收Alice发来信号C1，处理、用K1解密后为数组C3，计算计算统计E2中1的数量作为一个元素按顺序保存此值于第二数组F2；Alice计算统计E1中1的数量作为一个元素按顺序保存此值于第一数组F1；重复步骤到，直至数组F1和F2的元素个数达到预设值，如1000个；Alice的第一数组F1和Bob的第二数组F2各自开启后处理，包括①计算数组均值和标准方差，把均值附近0.5倍标准方差内的元素丢弃，Alice和Bob都不丢弃位置的元素、各自组成一个中间数组，将其量化为0或1，即为Alice和Bob协商成的第一密钥材料和第二密钥材料；②按双方商定的纠错规则，Alice对第一密钥材料计算纠错监督码，并将监督码传送给Bob用于纠正双方不一致的比特。如能完成纠错，则进一步进行隐私放大等处理，产生预定长度256比特双方相同的种子密钥；否则重新开始密钥协商。重复上述过程，可以不断生成新的种子密钥，种子密钥采用祖冲之序列密钥算法扩展为新的会话密钥，光纤传输系统就能持续加密/解密、更新密钥。本申请中协商双方各自生成两组二进制随机数组并加密发送给对方，这样没有密钥的非法窃听者无法判断出发送的协商比特，也就无法由窃取信号统计误码率，这是密钥协商安全性的基本保证。并且，本申请的密钥协商方法依赖于整个系统噪声高斯统计特性：在同一个时间窗口具有相同的噪声标准方差，即误码率比较接近；不同时间窗口之间不同的噪声标准方差，即误码率不同。合法协商的双方各自在接收端加入了对误码起较大作用的高斯噪声，这样即使非法方窃取到了光纤链路噪声，也无法计算出合法方得到的误码率，从而很好地保证了本专利密钥协商方法的安全性。通过相应的接收信号判决结果与发送随机数组比较并将信息反馈给对方，保证误码率的统计是在相同的时间窗口。双向要用不同的种子密钥，即不同的会话密钥进行信息加解密，提升密钥协商的安全性。本申请的优点包括但不限于以下几点：同一时间窗口是基于系统特性的密钥协商方法的基本要求，光纤链路普遍较长，信号传输时间远大于信号周期，如何找到合适的同一时间窗是一个难题。本专利通过相应的接收信号判决结果与发送随机数组比较并将结果反馈给对方，完美解决了相同时间窗的难题。合法协商的双方各自在接收端加入了对误码起较大作用的高斯噪声，这样即使非法方窃取到了光纤链路噪声，也无法计算出合法方得到的误码率，从而很好地保证了本专利密钥协商方法的安全性。双向要用不同的种子密钥，即不同的会话密钥进行信息加解密，提升密钥协商的安全性。从上面所述可以看出，本申请提供的一种密钥协商方法、装置、系统及电子设备，第一通信端生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；根据所述第一数组确定第一种子密钥。本申请通过相应的接收信号判决结果与发送随机数组比较并将结果反馈给对方，解决了难以找到相同时间窗的难题，并且协商的第一通信端和第二通信端各自加入了对误码起较大作用的第一噪声或第二噪声，这样即使非法方窃取到了光纤链路噪声，也无法计算出第一通信端和第二通信端得到的误码率，从而很好地保证了密钥协商方法的安全性。需要说明的是，本申请实施例的方法可以由单个设备执行，例如一台计算机或服务器等。本实施例的方法也可以应用于分布式场景下，由多台设备相互配合来完成。在这种分布式场景的情况下，这多台设备中的一台设备可以只执行本申请实施例的方法中的某一个或多个步骤，这多台设备相互之间会进行交互以完成所述的方法。需要说明的是，上述对本申请的一些实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于上述实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。图4示出了本申请实施例所提供的一种应用于第一通信端密钥协商装置的示例性结构示意图。基于同一发明构思，与上述任意实施例方法相对应的，本申请还提供了一种密钥协商装置。参考图4，所述密钥协商装置包括：生成模块、第一发送模块、第一确定模块、第二确定模块、第二发送模块、第三确定模块、计算模块以及第四确定模块；其中，生成模块，被配置为生成第一随机数组和第二随机数组，并根据所述第一随机数组和所述第二随机数组进行组帧以确定第一待发送信息帧；第一发送模块，被配置为利用由所述第一通信端指向第二通信端的第一会话密钥对所述第一待发送信息帧进行加密以确定第一加密信息帧，并将所述第一加密信息帧发送至所述第二通信端；第一确定模块，被配置为接收来自于所述第二通信端的第二加密信息帧，分别在所述第二加密信息帧中与第五随机数组和第六随机数组对应的位置添加第一噪声，进行数据判决以恢复出第四加密信息帧，并利用由所述第二通信端指向所述第一通信端的第二会话密钥对所述第四加密信息帧进行解密以确定第七随机数组和第八随机数组；其中，所述第二加密信息帧是根据所述第五随机数组、所述第六随机数组以及第一比特异或数组确定的；第二确定模块，被配置为根据所述第一比特异或数组确定第二比特异或数组，并根据所述第七随机数组和所述第二随机数组确定第三比特异或数组；第二发送模块，被配置为根据所述第三比特异或数组进行组帧以确定第三待发送信息帧，并利用所述第一会话密钥对所述第三待发送信息帧进行加密以确定第三加密信息帧，并将所述第三加密信息帧发送至第二通信端；第三确定模块，被配置为根据所述第八随机数组和所述第一随机数组确定第七比特异或数组，并根据所述第七比特异或数组和所述第二比特异或数组确定第八比特异或数组；计算模块，被配置为计算所述第八比特异或数组中数值1对应的第一数量，并将所述第一数量保存于第一数组；第四确定模块，被配置为根据所述第一数组确定第一种子密钥。在一种可能的实现方式中，所述第一发送模块进一步被配置为：将所述第一加密信息帧加载到载波光波以将所述第一加密信息帧调制为光信号形式，并将光信号形式的第一加密信息帧发送至所述第二通信端。在一种可能的实现方式中，所述第二确定模块进一步被配置为：比较所述第七随机数组和所述第二随机数组中相对应位置的比特；响应于所述第七随机数组和所述第二随机数组中相对应位置的比特相同，则所述相对应位置的输出结果为0；和/或，响应于所述第七随机数组和所述第二随机数组中相对应位置的比特不同，则所述相对应位置的输出结果为1；根据所述第七随机数组和所述第二随机数组中每个相对应位置的输出结果确定所述第三比特异或数组。在一种可能的实现方式中，所述第四确定模块进一步被配置为：响应于所述第一数组中的第一数量的个数达到预设数量，则计算所述第一数组的第一均值和第一标准方差，并根据所述第一均值和所述第一标准方差确定第一目标范围；将所述第一数组中位于所述第一目标范围内的元素剔除以确定第一候选数组；获取与所述第二通信端对应的保留元素信息，并将所述第一候选数组和所述第二候选数组中都保留的元素组成第一中间数组；其中，所述第二通信端对应的保留元素信息用于表征与所述第二通信端对应的第二候选数组中所保留的元素信息；对于所述第一中间数组中的每个元素，响应于所述元素大于所述第一均值，则将所述元素的判定结果置为1，和/或，响应于所述元素小于所述第一均值，则将所述元素的判定结果置为0；根据所述第一中间数组中每个元素的判定结果确定第一密钥材料；根据所述第一密钥材料计算纠错监督码，并将所述纠错监督码发送至所述第二通信端；响应于确定所述第二通信端中的第二密钥材料完成纠错操作，则对第一密钥材料进行隐私放大以及对应处理以得到所述第一种子密钥；和/或，响应于确定所述第二通信端中的第二密钥材料无法完成纠错操作，则重新执行确定第一种子密钥的全部步骤。为了描述的方便，描述以上装置时以功能分为各种模块分别描述。当然，在实施本申请时可以把各模块的功能在同一个或多个软件和/或硬件中实现。上述实施例的装置用于实现前述任一实施例中相应的应用于第一通信端的密钥协商方法，并且具有相应的方法实施例的有益效果，在此不再赘述。图5示出了本申请实施例所提供的一种应用于第二通信端密钥协商装置的示例性结构示意图。基于同一发明构思，与上述任意实施例方法相对应的，本申请还提供了一种密钥协商装置。参考图5，所述密钥协商装置包括：第一确定模块、生成模块、发送模块、第二确定模块、第三确定模块、计算模块以及第四确定模块；其中，第一确定模块，被配置为接收来自于第一通信端的第一加密信息帧，分别在所述第一加密信息帧中与第一随机数组和第二随机数组对应的位置添加第二噪声，进行数据判决以恢复出第五加密信息帧，并利用由所述第一通信端指向第二通信端的第一会话密钥对所述第五加密信息帧进行解密以确定第三随机数组和第四随机数组；其中，所述第一加密信息帧是根据所述第一随机数组和所述第二随机数组确定的；生成模块，被配置为生成第五随机数组和第六随机数组，并根据所述第三随机数组和所述第六随机数组确定第一比特异或数组；发送模块，被配置为根据所述第五随机数组、第六随机数组以及所述第一比特异或数组进行组帧以确定第二待发送信息帧，并利用由第二通信端指向第一通信端的第二会话密钥对所述第二待发送信息帧进行加密以确定第二加密信息帧，并将所述第二加密信息帧发送至第一通信端；第二确定模块，被配置为接收来自于第一通信端的第三加密信息帧，利用所述第一会话密钥对所述第三加密信息帧进行解密以确定第四比特异或数组；第三确定模块，被配置为根据所述第四随机数组和所述第五随机数组确定第五比特异或数组，并根据所述第五比特异或数组和所述第四比特异或数组确定第六比特异或数组；计算模块，被配置为计算所述第六比特异或数组中数值1对应的第二数量，并将所述第二数量保存于第二数组；第四确定模块，被配置为根据所述第二数组确定第二种子密钥。在一种可能的实现方式中，所述第四确定模块进一步被配置为：响应于所述第二数组中的第二数量的个数达到预设数量，则计算所述第二数组的第二均值和第二标准方差，并根据所述第二均值和所述第二标准方差确定第二目标范围；将所述第二数组中位于所述第二目标范围内的元素剔除以确定第二候选数组；获取与所述第一通信端对应的保留元素信息，并根据所述第一候选数组和所述第二候选数组中都保留的元素组成第二中间数组；其中，所述第一通信端对应的保留元素信息用于表征与所述第一通信端对应的第一候选数组中所保留的元素信息；对于所述第二中间数组中的每个元素，响应于所述元素大于所述第二均值，则将所述元素的判定结果置为1，和/或，响应于所述元素小于所述第二均值，则将所述元素的判定结果置为0；根据所述第二中间数组中每个元素的判定结果确定第二密钥材料；接收来自于所述第一通信端中根据第一密钥材料计算得到的纠错监督码，根据所述纠错监督码对第二密钥材料进行纠错；将用于表征所述第二通信端能否完成纠错操作的指示信息发送至第一通信端；响应于所述第二通信端能够完成纠错操作，则将所述第二密钥材料纠错后的数组确定为第三密钥材料，对第三密钥材料进行隐私放大及对应处理以得到所述第二种子密钥。为了描述的方便，描述以上装置时以功能分为各种模块分别描述。当然，在实施本申请时可以把各模块的功能在同一个或多个软件和/或硬件中实现。上述实施例的装置用于实现前述任一实施例中相应的应用于第二通信端的密钥协商方法，并且具有相应的方法实施例的有益效果，在此不再赘述。图6示出了本申请实施例所提供的一种密钥协商系统的示例性结构示意图。基于同一发明构思，与上述任意实施例方法相对应的，本申请还提供了一种密钥协商系统。参考图6，所述密钥协商装置包括：第一通信端以及第二通信端；其中，第一通信端，被配置为执行如第一方面所述的应用于第一通信端的密钥协商方法；第二通信端，被配置为执行如第二方面所述的应用于第二通信端的密钥协商方法。为了描述的方便，描述以上系统时以功能分为各种模块分别描述。当然，在实施本申请时可以把各模块的功能在同一个或多个软件和/或硬件中实现。上述实施例的系统用于实现前述任一实施例中相应的应用于第一通信端和或第二通信端的密钥协商方法，并且具有相应的方法实施例的有益效果，在此不再赘述。图7示出了本申请实施例所提供的一种电子设备的示例性结构示意图。基于同一发明构思，与上述任意实施例方法相对应的，本申请还提供了一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现上任意一实施例所述的应用于第一通信端或第二通信端的密钥协商方法。图7示出了本实施例所提供的一种更为具体的电子设备硬件结构示意图，该设备可以包括：处理器710、存储器720、输入/输出接口730、通信接口740和总线750。其中处理器710、存储器720、输入/输出接口730和通信接口740通过总线750实现彼此之间在设备内部的通信连接。处理器710可以采用通用的CPU、微处理器、应用专用集成电路、或者一个或多个集成电路等方式实现，用于执行相关程序，以实现本说明书实施例所提供的技术方案。存储器720可以采用ROM、RAM、静态存储设备，动态存储设备等形式实现。存储器720可以存储操作系统和其他应用程序，在通过软件或者固件来实现本说明书实施例所提供的技术方案时，相关的程序代码保存在存储器720中，并由处理器710来调用执行。输入/输出接口730用于连接输入/输出模块，以实现信息输入及输出。输入/输出模块可以作为组件配置在设备中，也可以外接于设备以提供相应功能。其中输入设备可以包括键盘、鼠标、触摸屏、麦克风、各类传感器等，输出设备可以包括显示器、扬声器、振动器、指示灯等。通信接口740用于连接通信模块，以实现本设备与其他设备的通信交互。其中通信模块可以通过有线方式实现通信，也可以通过无线方式实现通信。总线750包括一通路，在设备的各个组件之间传输信息。需要说明的是，尽管上述设备仅示出了处理器710、存储器720、输入/输出接口730、通信接口740以及总线750，但是在具体实施过程中，该设备还可以包括实现正常运行所必需的其他组件。此外，本领域的技术人员可以理解的是，上述设备中也可以仅包含实现本说明书实施例方案所必需的组件，而不必包含图中所示的全部组件。上述实施例的电子设备用于实现前述任一实施例中相应的应用于第一通信端或第二通信端的密钥协商方法，并且具有相应的方法实施例的有益效果，在此不再赘述。基于同一发明构思，与上述任意实施例方法相对应的，本申请还提供了一种非暂态计算机可读存储介质，所述非暂态计算机可读存储介质存储计算机指令，所述计算机指令用于使所述计算机执行如上任一实施例所述的应用于第一通信端或第二通信端的密钥协商方法。本实施例的计算机可读介质包括永久性和非永久性、可移动和非可移动媒体可以由任何方法或技术来实现信息存储。信息可以是计算机可读指令、数据结构、程序的模块或其他数据。计算机的存储介质的例子包括，但不限于相变内存、静态随机存取存储器、动态随机存取存储器、其他类型的随机存取存储器、只读存储器、电可擦除可编程只读存储器、快闪记忆体或其他内存技术、只读光盘只读存储器、数字多功能光盘或其他光学存储、磁盒式磁带，磁带磁磁盘存储或其他磁性存储设备或任何其他非传输介质，可用于存储可以被计算设备访问的信息。上述实施例的存储介质存储的计算机指令用于使所述计算机执行如上任一实施例所述的应用于第一通信端或第二通信端的密钥协商方法，并且具有相应的方法实施例的有益效果，在此不再赘述。基于同一发明构思，与上述任意实施例所述的应用于第一通信端或第二通信端的密钥协商方法相对应的，本公开还提供了一种计算机程序产品，其包括计算机程序指令。在一些实施例中，所述计算机程序指令可以由计算机的一个或多个处理器执行以使得所述计算机和/或所述处理器执行所述的应用于第一通信端或第二通信端的密钥协商方法。对应于所述的应用于第一通信端或第二通信端的密钥协商方法各实施例中各步骤对应的执行主体，执行相应步骤的处理器可以是属于相应执行主体的。上述实施例的计算机程序产品用于使所述计算机和/或所述处理器执行如上任一实施例所述的应用于第一通信端或第二通信端的密钥协商方法，并且具有相应的方法实施例的有益效果，在此不再赘述。所属领域的普通技术人员应当理解：以上任何实施例的讨论仅为示例性的，并非旨在暗示本申请的范围被限于这些例子；在本申请的思路下，以上实施例或者不同实施例中的技术特征之间也可以进行组合，步骤可以以任意顺序实现，并存在如上所述的本申请实施例的不同方面的许多其它变化，为了简明它们没有在细节中提供。另外，为简化说明和讨论，并且为了不会使本申请实施例难以理解，在所提供的附图中可以示出或可以不示出与集成电路芯片和其它部件的公知的电源/接地连接。此外，可以以框图的形式示出装置，以便避免使本申请实施例难以理解，并且这也考虑了以下事实，即关于这些框图装置的实施方式的细节是高度取决于将要实施本申请实施例的平台的。在阐述了具体细节以描述本申请的示例性实施例的情况下，对本领域技术人员来说显而易见的是，可以在没有这些具体细节的情况下或者这些具体细节有变化的情况下实施本申请实施例。因此，这些描述应被认为是说明性的而不是限制性的。尽管已经结合了本申请的具体实施例对本申请进行了描述，但是根据前面的描述，这些实施例的很多替换、修改和变型对本领域普通技术人员来说将是显而易见的。例如，其它存储器架构)可以使用所讨论的实施例。本申请实施例旨在涵盖落入所附权利要求的宽泛范围之内的所有这样的替换、修改和变型。因此，凡在本申请实施例的精神和原则之内，所做的任何省略、修改、等同替换、改进等，均应包含在本申请的保护范围之内。
