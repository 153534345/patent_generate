标题title
图像压缩系统、图像压缩方法、存储介质与芯片
摘要abst
本发明涉及通信技术领域，公开一种图像压缩系统、图像压缩方法、存储介质与芯片。图像压缩系统包括：非线性变换网络，所述非线性变换网络包括特征提取网络，特征提取网络包括：移位卷积层，用于提取目标图像的局部特征，以及注意力机制，用于根据局部特征提取潜在表示特征，注意力机制中的查询向量等于键向量；编码器，用于对潜在表示特征进行编码，以获取相应的码流；解码器，用于对码流进行解码，以获取与码流相对应的潜在表示特征；以及非线性反变换网络，用于对潜在表示特征进行解压缩，以获取与目标图像相对应的重构图像，其中非线性反变换网络与非线性变换网络为对称结构。本发明在保持相同的压缩性能的前提下，可极大地提升图像压缩速度。
权利要求书clms
1.一种图像压缩系统，其特征在于，所述图像压缩系统包括：非线性变换网络，所述非线性变换网络包括特征提取网络，其中，所述特征提取网络包括：移位卷积层，用于提取目标图像的局部特征，以及注意力机制，用于根据所述局部特征提取所述目标图像的潜在表示特征，其中，所述注意力机制中的查询向量等于键向量；第一编码器，用于对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流；第一解码器，用于对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征；以及非线性反变换网络，用于对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像，其中，所述非线性反变换网络与所述非线性变换网络为对称结构。2.根据权利要求1所述的图像压缩系统，其特征在于，所述注意力机制包括：两个1×1卷积层；和/或两个批归一化层。3.根据权利要求1所述的图像压缩系统，其特征在于，所述图像压缩系统还包括：超先验变换网络，用于对所述目标图像的潜在表示特征进行压缩，以获取所述目标图像的潜在表示特征的边信息；第二编码器，用于对所述边信息进行编码，以获取相应的第二码流；第二解码器，用于对所述第二码流进行解码，以获取与所述第二码流相对应的第二潜在表示特征；超先验反变换网络，用于对所述第二潜在表示特征进行解码，以获取所述目标图像的潜在表示特征的方差参数与第一均值参数；以及上下文模型，用于根据所述目标图像的潜在表示特征预测所述目标图像的潜在表示特征的第二均值参数，并根据所述第一均值参数、所述第二均值参数与所述方差参数重构所述目标图像的潜在表示特征的高斯分布模型，相应地，所述第一编码器用于对所述目标图像的潜在表示特征进行编码包括：根据所述高斯分布模型对所述目标图像的潜在表示特征进行编码，以及所述第一解码器用于对所述第一码流进行解码包括：根据所述高斯分布模型对所述第一码流进行解码。4.根据权利要求3所述的图像压缩系统，其特征在于，所述超先验变换网络包括：多个卷积层与多个所述特征提取网络，所述超先验反变换网络与所述超先验变换网络为对称结构。5.根据权利要求4所述的图像压缩系统，其特征在于，所述图像压缩系统还包括：第一量化器，位于所述超先验变换网络与所述第二编码器之间。6.根据权利要求1所述的图像压缩系统，其特征在于，所述特征提取网络为多个特征提取网络，相应地，所述非线性变换网络还包括：多个卷积层，所述多个卷积层与所述多个特征提取网络交替分布。7.根据权利要求1所述的图像压缩系统，其特征在于，所述移位卷积层包括：第一移位卷积层与第二移位卷积层，所述特征提取网络还包括：第一残差结构，用于连接所述第一移位卷积层的输入与所述第二移位卷积层的输出；和/或第二残差结构，用于连接所述注意力机制的输入与输出。8.根据权利要求7所述的图像压缩系统，其特征在于，所述特征提取网络还包括：激活层，位于所述第一移位卷积层与所述第二移位卷积层之间。9.根据权利要求1所述的图像压缩系统，其特征在于，所述图像压缩系统还包括：第二量化器，位于所述非线性变换网络与所述第一编码器之间。10.一种图像压缩方法，其特征在于，所述图像压缩方法包括：通过非线性变换网络执行以下操作：提取目标图像的局部特征，以及根据所述局部特征提取所述目标图像的潜在表示特征，其中，所述非线性变换网络包括特征提取网络，所述特征提取网络包括：移位卷积层以及注意力机制，其中，所述注意力机制中的查询向量等于键向量；通过第一编码器对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流；通过第一解码器对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征；以及通过非线性反变换网络对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像，其中，所述非线性反变换网络与所述非线性变换网络为对称结构。11.根据权利要求10所述的图像压缩方法，其特征在于，所述注意力机制包括：两个1×1卷积层；和/或两个批归一化层。12.根据权利要求10所述的图像压缩方法，其特征在于，所述图像压缩方法还包括：通过超先验变换网络对所述目标图像的潜在表示特征进行压缩，以获取所述目标图像的潜在表示特征的边信息；通过第二编码器对所述边信息进行编码，以获取相应的第二码流；通过第二解码器对所述第二码流进行解码，以获取与所述第二码流相对应的第二潜在表示特征；通过超先验反变换网络对所述第二潜在表示特征进行解码，以获取所述目标图像的潜在表示特征的方差参数与第一均值参数；以及通过上下文模型根据所述目标图像的潜在表示特征预测所述目标图像的潜在表示特征的第二均值参数，并根据所述第一均值参数、所述第二均值参数与所述方差参数重构所述目标图像的潜在表示特征的高斯分布模型，相应地，所述通过第一编码器对所述目标图像的潜在表示特征进行编码包括：根据所述高斯分布模型对所述目标图像的潜在表示特征进行编码，以及所述通过第一解码器对所述第一码流进行解码包括：根据所述高斯分布模型对所述第一码流进行解码。13.根据权利要求12所述的图像压缩方法，其特征在于，所述超先验变换网络包括：多个卷积层与多个所述特征提取网络，所述超先验反变换网络与所述超先验变换网络为对称结构。14.根据权利要求10所述的图像压缩方法，其特征在于，所述特征提取网络为多个特征提取网络，相应地，所述非线性变换网络还包括：多个卷积层，所述多个卷积层与所述多个特征提取网络交替分布。15.根据权利要求10所述的图像压缩方法，其特征在于，所述移位卷积层包括：第一移位卷积层与第二移位卷积层，所述特征提取网络还包括：第一残差结构，用于连接所述第一移位卷积层的输入与所述第二移位卷积层的输出；和/或第二残差结构，用于连接所述注意力机制的输入与输出。16.根据权利要求15所述的图像压缩方法，其特征在于，所述特征提取网络还包括：激活层，位于所述第一移位卷积层与所述第二移位卷积层之间。17.一种芯片，其特征在于，所述芯片包括根据权利要求1-9中任一项所述的图像压缩系统。18.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有计算机程序，该计算机程序被处理器执行时实现权利要求10-16中任一项所述的图像压缩方法。
说明书desc
技术领域本发明涉及通信技术领域，具体地涉及一种图像压缩系统、图像压缩方法、存储介质与芯片。背景技术5G将开启万物互联的新时代，同时，作为第四次工业革命的重要基石，工业物联网是5G最重要的应用场景。目前，5G+工业视觉已成为工业领域最为广泛的应用之一，广泛应用于电力巡检、电子制造、半导体、轨道交通、光伏及汽车制造等行业领域的安防监控、质量检测、自动分拣等场景。所以，高效的图像压缩对于物联网业务起着至关重要的作用。传统的图像编码标准等得到了广泛应用，但市场依然希望有一种更好的图像编码方法，既能更少地消耗带宽，又能达到更高的重建质量。目前，性能优秀的基于深度学习的图像编码方法都是在变分自编码器框架下进行工作，而性能最优的端到端图像编码方法依然存在模型复杂度较高，解码时间长的特点，并不能最好满足在硬件上的应用。发明内容本发明的目的是提供一种图像压缩系统、图像压缩方法、存储介质与芯片，其与现有的最优性能的神经网络图像压缩算法相比，在保持相同的压缩性能的前提下，可极大地提升图像压缩速度。并且，由于端到端图像压缩方法不需要手动设计相关参数，相比于传统图像编码方法，本发明具有更好的迭代能力和扩展性。为了实现上述目的，本发明第一方面提供一种图像压缩系统，所述图像压缩系统包括：非线性变换网络，所述非线性变换网络包括特征提取网络，其中，所述特征提取网络包括：移位卷积层，用于提取目标图像的局部特征，以及注意力机制，用于根据所述局部特征提取所述目标图像的潜在表示特征，其中，所述注意力机制中的查询向量等于键向量；第一编码器，用于对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流；第一解码器，用于对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征；以及非线性反变换网络，用于对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像，其中，所述非线性反变换网络与所述非线性变换网络为对称结构。优选地，所述注意力机制包括：两个1×1卷积层；和/或两个批归一化层。优选地，所述图像压缩系统还包括：超先验变换网络，用于对所述目标图像的潜在表示特征进行压缩，以获取所述目标图像的潜在表示特征的边信息；第二编码器，用于对所述边信息进行编码，以获取相应的第二码流；第二解码器，用于对所述第二码流进行解码，以获取与所述第二码流相对应的第二潜在表示特征；超先验反变换网络，用于对所述第二潜在表示特征进行解码，以获取所述目标图像的潜在表示特征的方差参数与第一均值参数；以及上下文模型，用于根据所述目标图像的潜在表示特征预测所述目标图像的潜在表示特征的第二均值参数，并根据所述第一均值参数、所述第二均值参数与所述方差参数重构所述目标图像的潜在表示特征的高斯分布模型，相应地，所述第一编码器用于对所述目标图像的潜在表示特征进行编码包括：根据所述高斯分布模型对所述目标图像的潜在表示特征进行编码，以及所述第一解码器用于对所述第一码流进行解码包括：根据所述高斯分布模型对所述第一码流进行解码。优选地，所述超先验变换网络包括：多个卷积层与多个所述特征提取网络，所述超先验反变换网络与所述超先验变换网络为对称结构。优选地，所述图像压缩系统还包括：第一量化器，位于所述超先验变换网络与所述第二编码器之间。优选地，所述特征提取网络为多个特征提取网络，相应地，所述非线性变换网络还包括：多个卷积层，所述多个卷积层与所述多个特征提取网络交替分布。优选地，所述移位卷积层包括：第一移位卷积层与第二移位卷积层，所述特征提取网络还包括：第一残差结构，用于连接所述第一移位卷积层的输入与所述第二移位卷积层的输出；和/或第二残差结构，用于连接所述注意力机制的输入与输出。优选地，所述特征提取网络还包括：激活层，位于所述第一移位卷积层与所述第二移位卷积层之间。优选地，所述图像压缩系统还包括：第二量化器，位于所述非线性变换网络与所述第一编码器之间。通过上述技术方案，本发明创造性地设置非线性变换网络用于获取潜在表示特征，设置第一编码器用于对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流，设置第一解码器用于对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征，设置非线性反变换网络用于对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像，并且在所述非线性变换网络中设置移位卷积层与注意力机制，其中，所述注意力机制中的查询向量等于键向量。与现有的最优性能的神经网络图像压缩算法相比，本发明在保持相同的压缩性能的前提下，可极大地提升图像压缩速度，并且由于端到端图像压缩方法不需要手动设计相关参数，相比于传统图像编码方法，本发明具有更好的迭代能力和扩展性。本发明第二方面提供一种图像压缩方法，所述图像压缩方法包括：通过非线性变换网络执行以下操作：提取所述目标图像的局部特征，以及根据所述局部特征提取所述目标图像的潜在表示特征，其中，所述非线性变换网络包括特征提取网络，所述特征提取网络包括：移位卷积层以及注意力机制，其中，所述注意力机制中的查询向量等于键向量；通过第一编码器对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流；通过第一解码器对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征；以及通过非线性反变换网络对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像，其中，所述非线性反变换网络与所述非线性变换网络为对称结构。优选地，所述注意力机制包括：两个1×1卷积层；和/或两个批归一化层。优选地，所述图像压缩方法还包括：通过超先验变换网络对所述目标图像的潜在表示特征进行压缩，以获取所述目标图像的潜在表示特征的边信息；通过第二编码器对所述边信息进行编码，以获取相应的第二码流；通过第二解码器对所述第二码流进行解码，以获取与所述第二码流相对应的第二潜在表示特征；通过超先验反变换网络对所述第二潜在表示特征进行解码，以获取所述目标图像的潜在表示特征的方差参数与第一均值参数；以及通过上下文模型根据所述目标图像的潜在表示特征预测所述目标图像的潜在表示特征的第二均值参数，并根据所述第一均值参数、所述第二均值参数与所述方差参数重构所述目标图像的潜在表示特征的高斯分布模型，相应地，所述通过第一编码器对所述目标图像的潜在表示特征进行编码包括：根据所述高斯分布模型对所述目标图像的潜在表示特征进行编码，以及所述通过第一解码器对所述第一码流进行解码包括：根据所述高斯分布模型对所述第一码流进行解码。优选地，所述超先验变换网络包括：多个卷积层与多个所述特征提取网络，所述超先验反变换网络与所述超先验变换网络为对称结构。优选地，所述特征提取网络为多个特征提取网络，相应地，所述非线性变换网络还包括：多个卷积层，所述多个卷积层与所述多个特征提取网络交替分布。优选地，所述移位卷积层包括：第一移位卷积层与第二移位卷积层，所述特征提取网络还包括：第一残差结构，用于连接所述第一移位卷积层的输入与所述第二移位卷积层的输出；和/或第二残差结构，用于连接所述注意力机制的输入与输出。优选地，所述特征提取网络还包括：激活层，位于所述第一移位卷积层与所述第二移位卷积层之间。有关本发明提供的图像压缩方法的具体细节及益处可参阅上述针对图像压缩系统的描述，于此不再赘述。本发明第三方面提供一种芯片，所述芯片包括所述的图像压缩系统。本发明第四方面提供一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，该计算机程序被处理器执行时实现所述的图像压缩方法。本发明的其它特征和优点将在随后的具体实施方式部分予以详细说明。附图说明附图是用来提供对本发明实施例的进一步理解，并且构成说明书的一部分，与下面的具体实施方式一起用于解释本发明实施例，但并不构成对本发明实施例的限制。在附图中：图1是本发明一实施例提供的图像压缩系统的结构示意图；图2A是本发明一实施例提供的图像压缩系统的结构示意图；图2B是本发明一实施例提供的图像压缩系统的结构示意图；图3是本发明一实施例提供的轻量级特征提取网络的结构示意图；图4是本发明一实施例提供的轻量级特征提取网络的结构示意图；图5是本发明一实施例提供的移位卷积的示意图；图6是本发明一实施例提供的轻量级注意力机制的示意图；以及图7是本发明一实施例提供的图像压缩方法的流程图。具体实施方式以下结合附图对本发明的具体实施方式进行详细说明。应当理解的是，此处所描述的具体实施方式仅用于说明和解释本发明，并不用于限制本发明。图1是本发明一实施例提供的图像压缩系统的结构示意图。如图1所示，所述图像压缩系统可包括：非线性变换网络10、第一编码器20、第一解码器30以及非线性反变换网络40。下面分别对上述各个模块的具体情况进行解释和说明。如图2A所示，所述非线性变换网络10可包括特征提取网络100。如图3所示，所述特征提取网络100可包括：移位卷积层110，用于提取目标图像的局部特征，以及注意力机制120，用于根据所述局部特征提取所述目标图像的潜在表示特征。其中，所述注意力机制120中的查询向量等于键向量。注意力机制120的三个参数-查询向量、键向量、值向量是输入x的三个映射，需要三个1×1卷积和三个批归一化。对于一个注意力过程，若设置q=k，则减少了一个1×1卷积的参数量和计算量。当n个RLAB模块叠加，就减少了n个1×1卷积的参数，由此，非线性变换/反变换网络可极大地提升压缩/解压缩的速度。轻量级注意力机制将特征图通道分为三组进行特征提取，每个组的注意力窗大小固定。经过窗口间信息移动交互后，在每个注意力窗中训练计算注意力参数查询向量、键向量、值向量时，设置q=k，在不降低模型性能的条件下，显著降低网络复杂度。相应地，所述注意力机制120可称为轻量级注意力机制，由所述注意力机制120组成的特征提取网络100也称为轻量级特征提取单元。所述注意力机制120可包括：两个1×1卷积层；和/或两个批归一化层。如图6所示，轻量级注意力机制使用批归一化代替各种注意力模型普遍使用的层归一化。经过实验注意力机制中使用BN，能使模型训练更稳定，并且BN能在推理阶段和卷积神经网络聚合在一起，进一步提升推理速度，也没有额外的计算复杂度开销。然后，注意力窗中的参数矩阵q、k、v不再分别计算，而是使q=k。经过实验，以上措施在端到端图像压缩网络中十分有效。经过特征映射后分别通过两个1*1卷积和BN，然后分别对参数矩阵进行维度重构后，经过矩阵乘法得到经过注意力权重分配的特征图。在进行注意力操作前，对各个窗的像素进行顺时针移位操作，交换全局信息。如图4所示，所述移位卷积层110包括：第一移位卷积层111与第二移位卷积层112。所述特征提取网络100还可包括：第一残差结构130，用于连接所述第一移位卷积层111的输入与所述第二移位卷积层112的输出；和/或第二残差结构140，用于连接所述注意力机制120的输入与输出，如图4所示。如图5所示，移位卷积将通道分为5组，在每个组的卷积核上进行相应的移位操作，然后使用1×1卷积实现跨通道信息聚合。移位卷积在1×1卷积的计算复杂度下具有3×3卷积的感受野。通过残差增加网络深度，否则网络不好学习，例如可通过第一残差结构将原始图像信息与第二移位卷积的输出相结合，由此可进一步输出更为全面的特征信息。然后，在通过轻量级注意力机制，灵活捕捉全局特征与局部特征的关系，提取关键信息，借助残差连接，可以使用更深的网络构造多跳注意力机制，使得模型在得到下一个注意力时，能够考虑到之前的已经关注过的特征。优选地，所述特征提取网络100还可包括：激活层150，位于所述第一移位卷积层111与所述第二移位卷积层112之间，如图4所示。其中，激活层由激活函数组成，主要用于对特征进行非线性变换。通过非线性映射，网络将特征映射到高维的非线性区间，增强网络的表达能力。在两个移位卷积操作之间加入Relu激活层，同时加入残差结构，使网络能够更好学习图像特征。具体地，所述特征提取网络100可为多个特征提取网络100。如图2A所示，所述非线性变换网络10还可包括：多个卷积层101，所述多个卷积层101与所述多个特征提取网络100交替分布。其中，所述多个卷积层101可以相同，也可以不同。如图2B所示，所述非线性变换网络10包括Conv与RLAB、Conv与RLAB、Conv与RLAB、Conv与RLAB。其中，卷积层和特征提取网络组成的网络主要作用就是进行特征提取、下采样，减少冗余，潜在表示特征数据的维度促使网络学习紧凑特征。需要注意的是，所述非线性变换网络10所包含的各个部分的数目可根据实际情况进行设置，并不限于图2B所示的具体数目。例如，x为输入图像，经过Conv进行特征初步提取，并进行下采样。也即是说，卷积操作使得图像变小，降低后续操作复杂度，即潜在表示特征数据的维度促使网络学习紧凑特征。而RLAB能够进一步提取图像细节的信息而忽略不相关的信息，可以更好的学习特征表示，并行化程度增强，运行速度比较高。经过多个类似模块，输出隐含变量y是表示在loss函数指导下，模型经过学习得到的输入图像的特征图。此外，所述图像压缩系统还可包括：第二量化器2，位于所述非线性变换网络10与所述第一编码器20之间，如图2A所示。其中，所述第二量化器2使得连续的隐含变量变为离散值，分布更加集中，方便后续进行熵编码。原来的y是连续值，所需的存储bit多，而/＞需要的存储bit少。如图2A所示，所述第一编码器20用于对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流。其中，所述第一编码器20可为熵编码器。使用熵编码技术对进行无损压缩进一步减少编码冗余，形成二进制图像压缩文件。/＞越紧凑，熵编码使用的比特越少。如图2A所示，所述第一解码器30用于对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征。其中，所述第一解码器30可为熵解码器。AD是AE的逆过程，输入码流再得到。如图2A所示，所述非线性反变换网络40用于对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像。其中，所述非线性反变换网络40与所述非线性变换网络10为对称结构，如图2A所示。所述非线性反变换网络40的具体结构可参见上述关于所述非线性变换网络10的具体结构的相关描述。所述非线性反变换网络40是上述非线性变换网络10执行的非线性变换的逆过程，也即是说，输入，得到重构图像。原始图像数据 x 经过变换后得到y，再对其进行量化得到，其中量化后的数据概率模型一般被认为是一个已知的分布，故通常通过假设的概率模型对图像进行熵编码。不过该模型与实际的分布存在差距，因为实际分布是未知的，则需要尽可能的使概率模型分布与实际的分布接近。为了减小概率模型与实际模型的差距，引入边信息z这个新的变量，来实现概率模型的精确估计。具体地，为了提升压缩性能，在本实施例中可通过加入边信息来辅助解码，通过超先验变换网络-编码器-解码器-超先验反变换网络得到量化后潜在表示特征的方差与第一均值，另一方面通过上下文模型预测第二均值并融合两个均值，根据方差与融合均值构造高斯分布模型，利用这些高斯分布模型来辅助解码器重构图像。在一实施例中，所述图像压缩系统还可包括：超先验变换网络50、第二编码器60、第二解码器70、超先验反变换网络80以及上下文模型90，如图2A所示。下面分别针对上述各个模块的具体情况进行解释和说明。所述超先验变换网络50用于对所述目标图像的潜在表示特征进行压缩，以获取所述目标图像的潜在表示特征的边信息。具体地，所述超先验变换网络50可包括：多个卷积层与多个所述特征提取网络。如图2B所示，所述超先验变换网络50包括Conv与RLAB、Conv与RLAB。其中，卷积层和特征提取网络组成的网络主要作用就是进行特征提取、下采样，减少冗余，以获取相应的边信息z。通过边信息来辅助解码，从而可更进一步地提升压缩性能。关于卷积层与RLAB的具体信息可参见上述关于非线性变换网络中的相关内容的描述。此外，所述图像压缩系统还可包括：第一量化器1，位于所述超先验变换网络50与所述第二编码器60之间，如图2A所示。其中，所述第一量化器1使得连续的边信息变为离散值，方便后续进行编码。原来的z是连续值，所需的存储bit多，而/＞需要的存储bit少。如图2A所示，所述第二编码器60用于对所述边信息进行编码，以获取相应的第二码流。其中，所述第二编码器60可为熵编码器。使用熵编码技术对进行无损压缩进一步减少编码冗余，形成二进制图像压缩文件。/＞越紧凑，编码使用的比特越少。如图2A所示，所述第二解码器70用于对所述第二码流进行解码，以获取与所述第二码流相对应的第二潜在表示特征。其中，所述第二解码器70可为熵解码器。AD是AE的逆过程，输入码流再得到。如图2A所示，所述超先验反变换网络80用于对所述第二潜在表示特征进行解码，以获取所述目标图像的潜在表示特征的方差参数与第一均值参数。相应地，所述超先验反变换网络80与所述超先验变换网络50为对称结构，如图2A所示。所述超先验反变换网络80的具体结构可参见上述关于所述超先验变换网络50的具体结构的相关描述。只不过所述超先验反变换网络80执行的是非线性变换的逆过程，也即是说，输入，得到方差参数/＞与第一均值参数/＞。如图2A所示，所述上下文模型90用于根据所述目标图像的潜在表示特征预测所述目标图像的潜在表示特征的第二均值参数，并根据所述第一均值参数、所述第二均值参数与所述方差参数重构所述目标图像的潜在表示特征的高斯分布模型。相应地，所述第一编码器20用于对所述目标图像的潜在表示特征进行编码包括：根据所述高斯分布模型对所述目标图像的潜在表示特征进行编码，以及所述第一解码器30用于对所述第一码流进行解码包括：根据所述高斯分布模型对所述第一码流进行解码。上下文模型根据潜在表示特征采用自回归预测法获取第二均值参数，然后根据对两个均值参数进行融合以得到高斯分布模型的均值参数，其中，/＞为权重系数，并且/＞，由此，其可输出的是用于计算假设的分布/＞的参数/＞的信息。在输出参数/＞之后，所述熵编码器可根据实际的高斯分布来对潜在表示特征进行编码，所述熵解码器可根据实际的高斯分布来对第一码流进行解码，由此，上下文模型可有效地辅助解码器重构图像。由此，本实施例可实现图像更高效的压缩和更好的复原。通过超先验编码器-量化器-熵编码器获取二进制码流，重构图像时通过熵解码器-超先验解码器得到量化后潜在表示特征的方差、第一均值，另一方面通过上下文模型利用自回归预测法预测第二均值并将两个均值信息进行融合，根据方差与融合均值构造高斯分布模型，利用这些高斯分布模型来辅助解码器重构图像。在现有技术中，解码器是根据假设的分布来重构图像，没有网络学习的分布效果好。并且，本实施例采用的均值参数使用的是融合后的结果，根据高斯分布重构图像的可靠性更高，计算简单，且不需要重新构造网络去学习高斯分布参数，减少模型复杂性，进一步实现压缩模型的轻量化目标。与现有的最优性能的神经网络图像编码方法在大量测试图片上的同等比较中，本发明能在保证性能不下降的前提下，可以使图像编码和解码的推理速度提升3-4倍，具有更好的硬件应用前景。此外，由于端到端图像压缩方法不需要手动设计相关参数，本发明相比于传统图像编码方法具有更好的迭代能力和扩展性。在使用上述图像压缩系统之前，可对所述系统进行构建与训练。首先，构建具有内容多样性的高清图像，包括人、自然景观、动物等，在数据集的基础上划分训练集、验证集和测试集。其次，构建由移位卷积和轻量级注意力机制组成的轻量级特征提取单元，如图3或图4所示。轻量级特征提取单元包括具有残差结构的移位卷积和轻量级注意力机制。在两个移位卷积操作之间加入Relu激活层，同时加入残差结构，使网络能够更好学习图像特征。接着，使用轻量级特征提取单元轻量级构建非线性变换、反变换网络，并训练模型。在一实施例中，还可使用卷积神经网络进行特征初步提取，并进行下采样；然后，叠加若干轻量级特征提取单元，构成非线性变换网络、非线性反变换网络、超先验变换网络、超先验反变换网络。设计超先验网络，将输出z作为边信息辅助图像编码，进一步减少隐层变量y的冗余，提高压缩率。最后，将图像输入到非线性变换网络中，通过超先验网络获取高斯分布模型，根据高斯分布模型经过熵编码与熵解码过程，并通过非线性反变换网络解码图像，获得解码后的重构图像。训练模型时，使用损失函数：L=λ1∙D+R，其中D为原始图像与重构图像的均方误差，R为码率。使用λ1权衡系数，联合优化均方误差与码率，实现端到端训练。相比于目前性能最好的神经网络图像压缩模型，本发明各个实施例在压缩性能不下降的前提下，参数量降低5%，编码推理时间降低40%以上，解码推理时间降低为原来的1/3，如表1所示。由此，本发明各个实施例提供的图像压缩系统可应用5G系统，形成用于5G系统的轻量级神经网络图像压缩系统。表1PSNR及MS-SSIM性能对比表综上所述，本发明创造性地设置非线性变换网络用于获取潜在表示特征，设置第一编码器用于对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流，设置第一解码器用于对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征，设置非线性反变换网络用于对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像，并且在所述非线性变换网络中设置移位卷积层与注意力机制，其中，所述注意力机制中的查询向量等于键向量。与现有的最优性能的神经网络图像压缩算法相比，本发明在保持相同的压缩性能的前提下，可极大地提升图像压缩速度，并且由于端到端图像压缩方法不需要手动设计相关参数，相比于传统图像编码方法，本发明具有更好的迭代能力和扩展性。图7是本发明一实施例提供的一种图像压缩方法的流程图。如图7所示，所述图像压缩方法可包括：步骤S701，通过非线性变换网络获取目标图像的潜在表示特征；步骤S702，通过第一编码器对所述目标图像的潜在表示特征进行编码，以获取相应的第一码流；步骤S703，通过第一解码器对所述第一码流进行解码，以获取与所述第一码流相对应的第一潜在表示特征；以及步骤S704，通过非线性反变换网络对所述第一潜在表示特征进行解压缩，以获取与所述目标图像相对应的重构图像，其中，所述非线性反变换网络与所述非线性变换网络为对称结构。其中，所述非线性变换网络包括特征提取网络。所述特征提取网络包括：移位卷积层，用于提取目标图像的局部特征；以及注意力机制，用于根据所述局部特征提取所述目标图像的潜在表示特征。其中，所述注意力机制中的查询向量等于键向量。优选地，所述注意力机制包括：两个1×1卷积层；和/或两个批归一化层。优选地，所述图像压缩方法还包括：通过超先验变换网络对所述目标图像的潜在表示特征进行压缩，以获取所述目标图像的潜在表示特征的边信息；通过第二编码器对所述边信息进行编码，以获取相应的第二码流；通过第二解码器对所述第二码流进行解码，以获取与所述第二码流相对应的第二潜在表示特征；通过超先验反变换网络对所述第二潜在表示特征进行解码，以获取所述目标图像的潜在表示特征的方差参数与第一均值参数；以及通过上下文模型根据所述目标图像的潜在表示特征预测所述目标图像的潜在表示特征的第二均值参数，并根据所述第一均值参数、所述第二均值参数与所述方差参数重构所述目标图像的潜在表示特征的高斯分布模型，相应地，所述通过第一编码器对所述目标图像的潜在表示特征进行编码包括：根据所述高斯分布模型对所述目标图像的潜在表示特征进行编码，以及所述通过第一解码器对所述第一码流进行解码包括：根据所述高斯分布模型对所述第一码流进行解码。优选地，所述超先验变换网络包括：多个卷积层与多个所述特征提取网络，所述超先验反变换网络与所述超先验变换网络为对称结构。优选地，所述特征提取网络为多个特征提取网络，相应地，所述非线性变换网络还包括：多个卷积层，所述多个卷积层与所述多个特征提取网络交替分布。优选地，所述移位卷积层包括：第一移位卷积层与第二移位卷积层，所述特征提取网络还包括：第一残差结构，用于连接所述第一移位卷积层的输入与所述第二移位卷积层的输出；和/或第二残差结构，用于连接所述注意力机制的输入与输出。优选地，所述特征提取网络还包括：激活层，位于所述第一移位卷积层与所述第二移位卷积层之间。有关本发明提供的图像压缩方法的具体细节及益处可参阅上述针对图像压缩系统的描述，于此不再赘述。本发明一实施例提供一种芯片，所述芯片包括所述的图像压缩系统。本发明一实施例提供一种芯片，包括：处理器；用于存储所述处理器执行的计算机程序的存储器；所述处理器，用于从所述存储器中读取所述计算机程序，并执行所述计算机程序以实现所述的图像压缩方法。本发明一实施例提供一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，该计算机程序被处理器执行时实现所述的图像压缩方法。本发明一实施例提供一种计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现所述的图像压缩方法。以上结合附图详细描述了本发明的优选实施方式，但是，本发明并不限于上述实施方式中的具体细节，在本发明的技术构思范围内，可以对本发明的技术方案进行多种简单变型，这些简单变型均属于本发明的保护范围。另外需要说明的是，在上述具体实施方式中所描述的各个具体技术特征，在不矛盾的情况下，可以通过任何合适的方式进行组合，为了避免不必要的重复，本发明对各种可能的组合方式不再另行说明。本领域技术人员可以理解实现上述实施例方法中的全部或部分步骤是可以通过程序来指令相关的硬件来完成，该程序存储在一个存储介质中，包括若干指令用以使得单片机、芯片或处理器执行本申请各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。此外，本发明的各种不同的实施方式之间也可以进行任意组合，只要其不违背本发明的思想，其同样应当视为本发明所公开的内容。
