标题title
一种基于RPA机器人数据分析的网络攻击拦截方法及系统
摘要abst
本发明涉及网络防护技术领域，尤其是涉及一种基于RPA机器人数据分析的网络攻击拦截方法及系统。一种基于RPA机器人数据分析的网络攻击拦截方法，包括获取网络数据；对获取的网络数据进行预处理，包括数据去重、异常值处理和缺失值填充；对预处理后的网络数据进行特征提取，对提取的特征利用主成分分析进行特征变量降维；将降维后的网络数据构成训练集和测试集；构建贝叶斯网络模型的网络架构。通过RPA机器人的自动化辅助拦截功能，可以快速响应具有特定攻击行为的网络攻击事件，提高网络安全响应的整体效率。
权利要求书clms
1.一种基于RPA机器人数据分析的网络攻击拦截方法，其特征在于，包括：获取网络访问日志和网络攻击行为规则；基于网络攻击行为规则得到网络访问日志中的可疑网络；对可疑网络的网络数据进行特征提取，得到特征因子；利用主成分分析对特征因子进行降维处理；构建贝叶斯网络模型，并对贝叶斯网络模型进行训练优化；利用优化的贝叶斯网络模型对可疑网络进行监测，并将相应的拦截策略推送至RPA机器人；基于拦截策略，利用RPA机器人进行网络攻击辅助拦截。2.根据权利要求1所述的一种基于RPA机器人数据分析的网络攻击拦截方法，其特征在于，所述获取网络访问日志和网络攻击行为规则，包括获取企业边界交换机、防火墙的访问日志信息，并结合业务常识及经验自定义多种类型的网络攻击行为规则。3.根据权利要求2所述的一种基于RPA机器人数据分析的网络攻击拦截方法，其特征在于，所述对可疑网络的网络数据进行特征提取，得到特征因子，包括提取可疑网络的访问时间、源区域、源IP地址、源端口、协议类型、方法、目的区域、目的IP地址、目的端口、访问顺序是否是WAN到LAN、威胁类型和威胁等级。4.根据权利要求3所述的一种基于RPA机器人数据分析的网络攻击拦截方法，其特征在于，所述利用主成分分析对特征因子进行降维处理，包括根据特征因子计算特征向量的相关系数矩阵，根据相关系数矩阵的特征根、方差占比和成分系数，结合碎石图得到主成分特征，将主成分特征作为数据集。5.根据权利要求4所述的一种基于RPA机器人数据分析的网络攻击拦截方法，其特征在于，所述构建贝叶斯网络模型的网络架构，包括基于特征向量构建多分类贝叶斯网络结构图，定义贝叶斯网络结构图节点之间的概率依赖关系，初始化贝叶斯网络结构时限定根节点，其中，所述贝叶斯网络模型的网络结构具有相同的根节点，不同的是下属分支节点的划分。6.根据权利要求5所述的一种基于RPA机器人数据分析的网络攻击拦截方法，其特征在于，所述对贝叶斯网络模型进行训练优化，包括将数据集划分为训练集和测试集，利用训练集计算贝叶斯网络模型结构下的每个节点对应的条件概率表，得到完整的贝叶斯网络模型，利用测试集对贝叶斯网络模型的准确性进行验证，其中，G为定义在上的一个贝叶斯网络，其联合概率分布表示为各个节点的条件概率分布的乘积，即：,其中，为贝叶斯网络的节点，/＞为节点/＞的父节点，/＞为节点条件概率表。7.根据权利要求6所述的一种基于RPA机器人数据分析的网络攻击拦截方法，其特征在于，所述对贝叶斯网络模型进行训练优化，还包括分别计算贝叶斯网络模型的准确率、精准率、召回率和F1分值，其中，F1分值是精确率和召回率的加权调和平均数。8.一种基于RPA机器人数据分析的网络攻击拦截系统，其特征在于，包括：数据获取模块，被配置为，获取网络访问日志和网络攻击行为规则；基于网络攻击行为规则得到网络访问日志中的可疑网络；特征分析模块，被配置为，对可疑网络的网络数据进行特征提取，得到特征因子；利用主成分分析对特征因子进行降维处理；模型模块，被配置为，构建贝叶斯网络模型，并对贝叶斯网络模型进行训练优化；利用优化的贝叶斯网络模型对可疑网络进行监测，并将相应的拦截策略推送至RPA机器人；拦截模块，被配置为，基于拦截策略，利用RPA机器人进行网络攻击辅助拦截。9.一种计算机可读存储介质，其中存储有多条指令，其特征在于，所述指令适于由终端设备的处理器加载并执行如权利要求1所述的一种基于RPA机器人数据分析的网络攻击拦截方法。10.一种终端设备，包括处理器和计算机可读存储介质，处理器用于实现各指令；计算机可读存储介质用于存储多条指令，其特征在于，所述指令适于由处理器加载并执行如权利要求1所述的一种基于RPA机器人数据分析的网络攻击拦截方法。
说明书desc
技术领域本发明涉及网络防护技术领域，尤其是涉及一种基于RPA机器人数据分析的网络攻击拦截方法及系统。背景技术目前网络攻击监测及防护主要是通过网络安全预警监测系统、网络安全防护系统及人工干预方式完成网络攻击的拦截，已实现网络安全被动式防御。在此过程中主要存在以下问题或缺陷：被动式网络安全防护工作难以快速的处理网络安全攻击事件，尤其是在当前互联网时代，网络攻击的隐蔽性、分散性、全天候性给网络安全管理人员带来了巨大挑战，企业很难实现全天候24小时监测及处理；目前市面上主流的网络安全预警监测系统技术相对封闭，产品功能结构相对固化，企业很难通过产品底层技术实现一些特性化的网络预警规则设置，如按照针对某一类业务场景的网络攻击；目前常规的网络安全防护系统都有各自产品特性和配置规则，在日常工作中网络安全运维人员需要适配不同的安全产品的操作规则，这对于产品的适配性和员工的专业技能提出更高的要求，同时也增加了操作得出错率。当前机器学习算法如朴素贝叶斯、决策树、支持向量机等，已经在预测网络攻击方面得到了较为广泛的应用。尽管都能通过学习历史攻击行为数据，构建攻击行为模型，但是随着数据规模及攻击复杂度、隐蔽性的升级，上述算法构建的分类预测模型已经无法更准确、高效地识别网络攻击行为，且对于新攻击行为的学习代价较高。因此亟需一种新的网络攻击辅助拦截方法。发明内容名词解释：RPA：即机器人流程自动化，它是一种基于软件的自动化技术，旨在模拟人类操作计算机的行为，以执行重复性高、规则性强的工作。为了解决定制化网络攻击行为规则，弥补现有网络安全监测产品的功能缺失，本发明提供一种基于RPA机器人数据分析的网络攻击拦截方法及系统，可减轻企业网络安全运维人员工作强度和压力，降低企业用工成本，并且通过当前较为成熟的RPA机器人技术实现主动式网络攻击防护拦截行为，为传统的人工操作为主的网络安全防护提供自动化辅助功能第一方面，本发明提供的一种基于RPA机器人数据分析的网络攻击拦截方法，采用如下的技术方案：一种基于RPA机器人数据分析的网络攻击拦截方法，包括：获取网络访问日志和网络攻击行为规则；基于网络攻击行为规则得到网络访问日志中的可疑网络；对可疑网络的网络数据进行特征提取，得到特征因子；利用主成分分析对特征因子进行降维处理；构建贝叶斯网络模型，并对贝叶斯网络模型进行训练优化；利用优化的贝叶斯网络模型对可疑网络进行监测，并将相应的拦截策略推送至RPA机器人；基于拦截策略，利用RPA机器人进行网络攻击辅助拦截。进一步地，所述获取网络访问日志和网络攻击行为规则，包括获取企业边界交换机、防火墙的访问日志信息，并结合业务常识及经验自定义多种类型的网络攻击行为规则。进一步地，所述对可疑网络的网络数据进行特征提取，得到特征因子，包括提取可疑网络的访问时间、源区域、源IP地址、源端口、协议类型、方法、目的区域、目的IP地址、目的端口、访问顺序是否是WAN到LAN、威胁类型和威胁等级。进一步地，所述利用主成分分析对特征因子进行降维处理，包括根据特征因子计算特征向量的相关系数矩阵，根据相关系数矩阵的特征根、方差占比和成分系数，结合碎石图得到主成分特征，将主成分特征作为数据集。进一步地，所述构建贝叶斯网络模型的网络架构，包括基于特征向量构建多分类贝叶斯网络结构图，定义贝叶斯网络结构图节点之间的概率依赖关系，初始化贝叶斯网络结构时限定根节点，其中，所有可能的网络结构都有相同的根节点，不同的是下属分支节点的划分。进一步地，所述对贝叶斯网络模型进行训练优化，包括将数据集划分为训练集和测试集，利用训练集计算贝叶斯网络模型结构下的每个节点对应的条件概率表，得到完整的贝叶斯网络模型，利用测试集对贝叶斯网络模型的准确性进行验证，其中，G为定义在上的一个贝叶斯网络，其联合概率分布表示为各个节点的条件概率分布的乘积，即：/＞,其中，为贝叶斯网络的节点，/＞为节点/＞的父节点，/＞为节点条件概率表。进一步地，所述对贝叶斯网络模型进行训练优化，还包括分别计算贝叶斯网络模型的准确率、精准率、召回率和F1分值，其中，F1分值是精确率和召回率的加权调和平均数。第二方面，一种基于RPA机器人数据分析的网络攻击拦截系统，包括：数据获取模块，被配置为，获取网络访问日志和网络攻击行为规则；基于网络攻击行为规则得到网络访问日志中的可疑网络；特征分析模块，被配置为，对可疑网络的网络数据进行特征提取，得到特征因子；利用主成分分析对特征因子进行降维处理；模型模块，被配置为，构建贝叶斯网络模型，并对贝叶斯网络模型进行训练优化；利用优化的贝叶斯网络模型对可疑网络进行监测，并将相应的拦截策略推送至RPA机器人；拦截模块，被配置为，基于拦截策略，利用RPA机器人进行网络攻击辅助拦截。第三方面，本发明提供一种计算机可读存储介质，其中存储有多条指令，所述指令适于由终端设备的处理器加载并执行所述的一种基于RPA机器人数据分析的网络攻击拦截方法。第四方面，本发明提供一种终端设备，包括处理器和计算机可读存储介质，处理器用于实现各指令；计算机可读存储介质用于存储多条指令，所述指令适于由处理器加载并执行所述的一种基于RPA机器人数据分析的网络攻击拦截方法。综上所述，本发明具有如下的有益技术效果：1、通过辅助拦截提高网络攻击响应效率。传统的被动式网络攻击防御措施存在响应的滞后性，给网络安全、信息安全带来了较大的安全隐患，通过RPA机器人的自动化辅助拦截功能，可以快速响应具有特定攻击行为的网络攻击事件，提高网络安全响应的整体效率。2、扩展传统网络安全拦截规则库封闭性。传统的网络安全产品自带技术封闭性特征，个性化的攻击特征规则开发依赖于安全厂商的配合力度，对企业而言会面临开发周期的不确定性和开发费用支出，通过采集日志、外部特征算法的方式，可以有效的规避安全厂商的制约，同时可以根据企业业务场景定制化自有的攻击防护规则库。3、降低企业用工成本，减轻相关从业人员工作压力。由于网络安全攻击的隐蔽性、攻击时间的随机性，要提高网络安全防护的效率就需要投入更多的人力、全天候的开展网络安全监测及应用处理工作，通过RPA机器人的网络攻击辅助拦截方法，可以有效减少人员投入，同时适当缓解从业人员工作压力。4、提升网络安全拦截误操作率。在流程化、重复性的操作场景下，人为操作的准确性由诸多因素影响，如员工的技术能力、从业经验、责任心、工作状态等，各方因素都会影响到操作准确性，而通过PRA机器人脚本录制及自动执行的方式基本可以规避上述各类因素造成的出错情况，提高准确度。附图说明图1是本发明实施例1的一种基于RPA机器人数据分析的网络攻击拦截方法的示意图。图2是本发明实施例的一种基于RPA机器人数据分析的网络攻击拦截系统的示意图。图3是本发明实施例的贝叶斯网络模型示意图。具体实施方式以下结合附图对本发明作进一步详细说明。实施例1参照图1，本实施例的一种基于RPA机器人数据分析的网络攻击拦截方法，包括：获取网络访问日志和网络攻击行为规则；基于网络攻击行为规则得到网络访问日志中的可疑网络；对可疑网络的网络数据进行特征提取，得到特征因子；利用主成分分析对特征因子进行降维处理；构建贝叶斯网络模型，并对贝叶斯网络模型进行训练优化；利用优化的贝叶斯网络模型对可疑网络进行监测，并将相应的拦截策略推送至RPA机器人；基于拦截策略，利用RPA机器人进行网络攻击辅助拦截。所述获取网络访问日志和网络攻击行为规则，包括获取企业边界交换机、防火墙的访问日志信息，并结合业务常识及经验自定义多种类型的网络攻击行为规则。所述对获取的访问日志信息进行特征提取，得到特征向量作为特征因子，包括提取可疑网络的访问时间、源区域、源IP地址、源端口、协议类型、方法、目的区域、目的IP地址、目的端口、访问顺序是否是WAN到LAN、威胁类型和威胁等级。所述利用主成分分析对特征因子进行降维处理，包括根据特征因子计算特征向量的相关系数矩阵，根据相关系数矩阵的特征根、方差占比和成分系数，结合碎石图得到主成分特征，将主成分特征作为数据集。所述构建贝叶斯网络模型的网络架构，包括基于特征向量构建多分类贝叶斯网络结构图，定义贝叶斯网络结构图节点之间的概率依赖关系，初始化贝叶斯网络结构时限定根节点，其中，所有可能的网络结构都有相同的根节点，不同的是下属分支节点的划分。所述对贝叶斯网络模型进行训练优化，包括将数据集划分为训练集和测试集，利用训练集计算贝叶斯网络模型结构下的每个节点对应的条件概率表，得到完整的贝叶斯网络模型，利用测试集对贝叶斯网络模型的准确性进行验证，其中，G为定义在上的一个贝叶斯网络，其联合概率分布表示为各个节点的条件概率分布的乘积，即：，其中，/＞为贝叶斯网络的节点，/＞为节点/＞的父节点，/＞为节点条件概率表。所述对贝叶斯网络模型进行训练优化，还包括分别计算贝叶斯网络模型的准确率、精准率、召回率和F1分值，其中，F1分值是精确率和召回率的加权调和平均数。具体地，本实施例的一种基于RPA机器人数据分析的网络攻击拦截方法，包括以下步骤：S1. 获取网络访问日志和网络攻击行为规则；其中，获取企业边界交换机、防火墙的访问日志信息，并结合业务常识及经验自定义多种类型的网络攻击行为规则。S2.基于网络攻击行为规则得到网络访问日志中的可疑网络；其中，结合业务常识及专家经验自定义多种类型网络攻击行为规则，包括一定时间范围内相同IP地址的访问频次、周期；根据产业地址规划表，是否是同一产业的、是否是正常业务访问时间，如线上业务属于24小时允许访问，常规线下任务7~22点可以访问，活动大促等特殊业务场景时7~24点等；是否属于因开发不规范或常规设置等原因所致的触发规则；访问行为是否属于拦截规则库；目的业务单元的日常访问量是否属于正常范围，以及访问量暴增暴跌的正常阈值范围等。S3.对可疑网络的网络数据进行特征提取，得到特征因子；其中，对获取的网络数据进行预处理，提取可疑网络攻击IP及日志特征等，包括提取可疑网络攻击的访问时间、源区域、源IP地址、源端口、协议类型、方法、目的区域、目的IP地址、目的端口、访问顺序是否是WAN→LAN、威胁类型、威胁等级等。S4.利用主成分分析对特征因子进行降维处理；其中，对获取的网络攻击行为影响因子进行数据处理，并利用主成分分析对网络攻击行为特征因子进行降维处理。经过上述两个步骤获取的网络攻击行为可能的影响特征，首先进行缺失值测算，对于访问时间、源区域、源IP地址、源端口、协议类型、方法、目的区域、目的IP地址、目的端口等关键特征缺失的日志数据进行删除处理，对于其他特征的缺失值概率小于95%的进行保留并以均值进行缺失值的填充，大于95%的予以删除；对于威胁类型、威胁等级、是否类特征等离散数据进行独热编码处理等，最终形成n个特征变量，以及一个因变量Y，即网络威胁类型。为了降低预测模型的复杂性，提高预测结果的准确性及稳定性，对上述提取的特征利用主成分分析进行特征变量降维，包括：步骤1、获取一定时间范围内的日志及规则数据集D1，其中D1为m*n维矩阵，，其他/＞作为贝叶斯网络机构的中间节点，节点间的依赖关系可以调整。步骤3、将数据集划分为训练集、测试集，训练集与测试集的占比为8:2。步骤4、利用训练集样本计算所构件的贝叶斯网络模型结构下的条件概率表。定义G为定义在上的一个贝叶斯网络，其联合概率分布可以表示为各个节点的条件概率分布的乘积：，其中，为节点/＞为节点/＞为节点条件概率表。每一个节点的条件概率表的计算，一般是以其父节点的条件概率为依据，没有父节点的用先验概率进行数据表示。每个节点可能的取值个数有多个，如“源iP区域”取值可能有成百上千个，“是否属于拦截规则库”有是和否两个结果值，如果用枚举法进行概率测算，那么模型的整体参数个数将以幂级的体量增加。假设n个二元随机变量的联合概率分布，表示该分布需要2n-1个参数，如果用贝叶斯网络建模，假设每个节点最多有k个父节点，所需要的参数最多为n*2k，一般地每个变量局部依赖于少数变量。为了降低参数个数及模型计算复杂度，利用联合概率分布结构化分解方法进行拆解。假设以图3为贝叶斯网络结构，那么节点yj的最终取值为：P=p*p*p*p*p*p*p*p*p*p*p*p*p)每一个节点的条件概率表计算完成之后，即完成了基于贝叶斯网络结构模型的构建，如图3所示。S6.对贝叶斯网络模型进行训练优化；其中，重复步骤3及步骤4，构建M个不同的贝叶斯网络模型，作为一种概率图模型，利用测试集对其进行准确性的验证测试。分别计算各个贝叶斯网络模型的准确率A、精准率P、召回率R及F1分值。因为本研究为多分类预测模型，即预测结果为可疑网络攻击行为时，不同贝叶斯网络模型对同类型网络攻击类型的预测准确率不同，本研究考虑对所有可疑攻击类型的整体识别能力。定义TP为“是某类威胁，且准确预测其为某类威胁”，TN为“非某类威胁，且准确预测其非某类威胁”，FP为“非某类威胁，但预测其为某类威胁”，FN为“是某类威胁，但预测其为某类威胁”。准确率是指预测分类正确的样本占总样本个数的比例，即Accuracy=/；精确率是指模型中正确的正样本个数占预测分类器判定为正样本的样本个数的比例。精确率容易与准确率混淆，精确率只针对预测正确的正样本而不是所有预测正确的样本。即Precision=TP/；召回率是指分类正确的正样本个数占真正的正样本个数的比例。即Recall=TP/；F1值是精确率和召回率的加权调和平均数，精确率和召回率都是越高越好，但两者往往是矛盾的，F1-score可以综合评价预测分类器的效果，它的取值范围为0到1，越接近1效果越好。F1=2*Precision*Recall/。将不同分类器的评估结果填入表2，综合评估选定最佳分类器，如表2所示为不同预测分类器的评估结果表。表2模型的评估和选定，不仅仅依赖于以上量化的评估指标，应充分结合网络安全专家实际运维经验和实际应用场景进行选定，并根据环境的变化进行调整，调整后的模型需进一步的验证评估后，应用于访问日志的实时数据分析。S7.利用优化的贝叶斯网络模型对可疑网络进行监测，并将相应的拦截策略推送至RPA机器人；基于拦截策略，利用RPA机器人进行网络攻击辅助拦截。如图2所示，步骤1、确定需要RPA机器人进行辅助拦截的可疑网络攻击类型，如SQL注入，提权，非授权访问，命令执行，文件上传，漏洞攻击，Webshell，代码执行，XSS，可疑工具，冰蝎，蚁剑，哥斯拉，一句话木马，反弹shell，信息泄露，溢出攻击，勒索，0DAY漏洞，文件下载等；步骤2、针对每一类型地不同等级的网络攻击行为或可疑网络攻击行为，利用RPA机器人录制人工处理时的处理方法、步骤脚本。制定不同场景下，RPA机器人操作及网络安全管理人员操作的优先顺序；步骤3、模拟攻击行为，测试RPA执行情况。实施例2本实施例提供一种基于RPA机器人数据分析的网络攻击拦截系统，包括：数据获取模块，被配置为，获取网络访问日志和网络攻击行为规则；基于网络攻击行为规则得到网络访问日志中的可疑网络；特征分析模块，被配置为，对可疑网络的网络数据进行特征提取，得到特征因子；利用主成分分析对特征因子进行降维处理；模型模块，被配置为，构建贝叶斯网络模型，并对贝叶斯网络模型进行训练优化；利用优化的贝叶斯网络模型对可疑网络进行监测，并将相应的拦截策略推送至RPA机器人；拦截模块，被配置为，基于拦截策略，利用RPA机器人进行网络攻击辅助拦截。一种计算机可读存储介质，其中存储有多条指令，所述指令适于由终端设备的处理器加载并执行所述的一种基于RPA机器人数据分析的网络攻击拦截方法。一种终端设备，包括处理器和计算机可读存储介质，处理器用于实现各指令；计算机可读存储介质用于存储多条指令，所述指令适于由处理器加载并执行所述的一种基于RPA机器人数据分析的网络攻击拦截方法。以上均为本发明的较佳实施例，并非依此限制本发明的保护范围，故：凡依本发明的结构、形状、原理所做的等效变化，均应涵盖于本发明的保护范围之内。
