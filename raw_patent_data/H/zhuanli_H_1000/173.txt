标题title
支持数据完整性审计的属性加密方法、系统及装置
摘要abst
本申请实施例提供支持数据完整性审计的属性加密方法、系统及装置。本实施例中，通过第一终端在注册阶段与KGC进行协商以获得KGC基于本第一终端的属性集合生成的第一终端的解密密钥，以及在第一终端请求第二终端的数据时，借助于第一终端的属性集合与第二终端已上传的第二终端的第二访问策略是否匹配决策是否允许第一终端获得第二终端的数据，在决策出第一终端具有权限访问第二终端的第二数据信息时，利用与KGC进行协商获得的解密密钥从第二密文中解密出第二目标数据，并从区块链中下载第二令牌，以基于第二令牌进行第二目标数据的数据完整性审计，实现了支持数据完整性审计的属性加密。
权利要求书clms
1.一种支持数据完整性审计的属性加密方法，其特征在于，所述方法应用于第一终端，所述方法包括：在注册至密钥生成中心KGC的阶段，与KGC进行协商以获得KGC基于第一终端的属性集合生成的第一终端的解密密钥；在对第一目标数据进行加密的阶段，基于第一秘密值、第一目标数据和KGC已广播的公共安全元素生成第一令牌，以及，基于第一秘密值和所述公共安全元素对第一目标数据进行加密得到第一密文，将第一数据信息上传至云服务器并将第一令牌上传至区块链；其中，第一数据信息至少包括：第一终端的第一访问策略、第一密文以及第一变量参数；第一访问策略指示第一终端的访问权限；第一变量参数用于解密端基于解密密钥和该第一变量参数获得第一秘密值，第一令牌用于解密端进行数据完整性审计；在第一终端请求第二终端的数据时发送数据请求给云服务器，以由云服务器验证第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配；获得云服务器在验证匹配时发送的第二数据信息；第二数据信息由第二终端按照第一终端生成第一数据信息的方式生成，第二数据信息包括：第二访问策略、第二密文以及第二变量参数；利用所述解密密钥并结合第二变量参数解析出第二秘密值，依据第二秘密值从第二密文中解密出第二目标数据；从区块链中下载第二令牌以基于第二令牌进行数据完整性审计；第二令牌由第二终端按照第一终端生成第一令牌的方式生成并上传至区块链。2.根据权利要求1所述的方法，其特征在于，所述与KGC进行协商以获得所述KGC基于所述属性集合生成的解密密钥包括：将本第一终端的属性集合提交给KGC，以由KGC生成解密密钥Key；其中，Key至少包括：，S表示所述属性集合中属性总数量；依据KGC已生成的目标随机数r和KGC已广播的第一公共安全元素w、以及KGC已广播的第二公共安全元素进行第一指定运算得到；第二公共安全元素通过/＞得到；e表示从第一数据域G1至第二数据域G2的映射函数，g为KGC随机选取的第三公共安全元素，/＞表示KGC的主私钥；依据KGC已生成的目标随机数r和KGC已广播的第三公共安全元素g进行第二指定运算得到；包括所述属性集合中每一属性对应的第一关键字，任一属性对应的第一关键字依据KGC为该属性生成的随机数和KGC已广播的第三公共安全元素g进行第二指定运算得到；包括所述属性集合中每一属性对应的第二关键字，任一属性对应的第二关键字依据KGC为该属性生成的随机数、该属性对应的数值、KGC已广播的第四公共安全元素u、第五公共安全元素h、第六公共安全元素v以及目标随机数r进行第三指定运算得到。3.根据权利要求1所述的方法，其特征在于，所述第一访问策略包括：属性描述信息矩阵和属性映射函数；其中，所述属性描述信息矩阵中每一目标描述信息用于描述对应的属性，所述目标描述信息为任一行或列中的数据，所述属性映射函数用于将属性描述信息矩阵中每一目标描述信息映射至对应的属性。4.根据权利要求1所述的方法，其特征在于，所述基于第一秘密值、第一目标数据和所述KGC已广播的公共安全元素生成第一令牌包括：按照下式计算第一令牌：；其中，/＞表示第一令牌，/＞表示第一秘密值，H表示KGC已广播的作为公共安全元素的哈希函数，/＞表示第一目标数据，/＞表示KGC已广播的第三公共安全元素；所述基于第二令牌进行数据完整性审计包括：基于第二秘密值、第二目标数据和所述KGC已广播的公共安全元素生成第三令牌；基于第二令牌和第三令牌进行数据完整性审计；其中，第三令牌按照下式计算：；其中，/＞表示第三令牌，/＞表示第二秘密值，H表示KGC在初始化阶段已广播的作为公共安全元素的哈希函数，/＞2表示第二目标数据，/＞表示KGC已广播的第三公共安全元素。5.根据权利要求1所述的方法，其特征在于，所述基于第一秘密值和所述公共安全元素对第一目标数据进行加密得到第一密文包括：按照下式对第一目标数据进行加密：；其中，/＞表示第一密文，m表示第一目标数据，/＞表示KGC在初始化阶段已广播的第七公共安全元素，s1表示第一秘密值。6.根据权利要求4所述的方法，其特征在于，所述基于第二令牌和第三令牌进行数据完整性审计包括：检查所述第二令牌和所述第三令牌是否满足设定匹配要求，如果是，确定第二目标数据通过数据完整性审计，否则，确定第二目标数据未通过数据完整性审计。7.一种支持数据完整性审计的属性加密系统，其特征在于，包括：密钥生成中心KGC，用于广播公共安全元素，并在任一终端注册至本密钥生成中心KGC的阶段，与终端进行协商以基于终端的属性集合生成终端的解密密钥；任一终端的属性集合中的属性用于描述该终端；任一终端，按照如权利要求1至6任一方法中的步骤执行；云服务器，用于存储任一终端上传的数据信息，并基于第一终端的数据请求验证所述第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配，在验证所述第一终端的属性集合与第二访问策略匹配时发送的第二数据信息匹配时，发送第二终端上传的第二数据信息给第一终端；区块链，通过其中的节点存储任一终端上传的令牌。8.一种支持数据完整性审计的属性加密装置，其特征在于，所述装置应用于第一终端，所述装置包括：注册模块，用于在第一终端注册至密钥生成中心KGC的阶段，与KGC进行协商以获得KGC基于第一终端的属性集合生成的第一终端的解密密钥；加密模块，用于在第一终端对第一目标数据进行加密的阶段，基于第一秘密值、第一目标数据和KGC已广播的公共安全元素生成第一令牌，以及，基于第一秘密值和所述公共安全元素对第一目标数据进行加密得到第一密文，将第一数据信息上传至云服务器并将第一令牌上传至区块链；其中，第一数据信息至少包括：第一终端的第一访问策略、第一密文以及第一变量参数；第一访问策略指示第一终端的访问权限；第一变量参数用于解密端基于解密密钥和该第一变量参数获得第一秘密值，第一令牌用于解密端进行数据完整性审计；解密模块，用于在第一终端请求第二终端的数据时发送数据请求给云服务器，以由云服务器验证第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配；获得云服务器在验证匹配时发送的第二数据信息；第二数据信息由第二终端按照第一终端生成第一数据信息的方式生成，第二数据信息包括：第二访问策略、第二密文以及第二变量参数；利用所述解密密钥并结合第二变量参数解析出第二秘密值，依据第二秘密值从第二密文中解密出第二目标数据；从区块链中下载第二令牌以基于第二令牌进行数据完整性审计；第二令牌由第二终端按照第一终端生成第一令牌的方式生成并上传至区块链。9.一种电子设备，其特征在于，电子设备包括：处理器和存储器；其中，所述存储器，用于存储机器可执行指令；所述处理器，用于读取并执行所述存储器存储的机器可执行指令，以实现如权利要求1至6任一项所述的方法。10.一种计算机程序产品，其特征在于，所述计算机程序产品内存储有计算机程序，所述计算机程序被处理器执行时实现权利要求1~ 6任一项所述的方法。
说明书desc
技术领域本申请涉及数据安全领域，尤其涉及支持数据完整性审计的属性加密方法、系统及装置。背景技术在数据安全领域，常通过传统的非对称加密技术对待加密的数据进行加密。比如，针对待加密的数据，加密端利用公钥对待加密数据进行加密得到密文并发送至解密端，而解密端利用与上述公钥匹配的私钥对密文进行解密，得到上述数据。但是，在非对称加密技术应用中，一旦上述私钥被泄露，攻击者就可以解密所有通过上述公钥解密的数据，危害性大。发明内容有鉴于此，本申请实施例提供支持数据完整性审计的属性加密方法、系统及装置，以实现支持数据完整性审计的属性加密，避免应用传统加密技术带来的问题比如非对称加密技术下由于私钥被泄露引起的攻击危害。根据本申请实施例的第一方面，提供一种支持数据完整性审计的属性加密方法，所述方法应用于第一终端，所述方法包括：在注册至密钥生成中心KGC的阶段，与KGC进行协商以获得KGC基于第一终端的属性集合生成的第一终端的解密密钥；在对第一目标数据进行加密的阶段，基于第一秘密值、第一目标数据和KGC已广播的公共安全元素生成第一令牌，以及，基于第一秘密值和所述公共安全元素对第一目标数据进行加密得到第一密文，将第一数据信息上传至云服务器并将第一令牌上传至区块链；其中，第一数据信息至少包括：第一终端的第一访问策略、第一密文以及第一变量参数；第一访问策略指示第一终端的访问权限；第一变量参数用于解密端基于解密密钥和该第一变量参数获得第一秘密值，第一令牌用于解密端进行数据完整性审计；在第一终端请求第二终端的数据时发送数据请求给云服务器，以由云服务器验证第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配；获得云服务器在验证匹配时发送的第二数据信息；第二数据信息由第二终端按照第一终端生成第一数据信息的方式生成，第二数据信息包括：第二访问策略、第二密文以及第二变量参数；利用所述解密密钥并结合第二变量参数解析出第二秘密值，依据第二秘密值从第二密文中解密出第二目标数据；从区块链中下载第二令牌以基于第二令牌进行数据完整性审计；第二令牌由第二终端按照第一终端生成第一令牌的方式生成并上传至区块链。根据本申请实施例的第二方面，提供一种支持数据完整性审计的属性加密系统，包括：密钥生成中心KGC，用于广播公共安全元素，并在任一终端注册至本密钥生成中心KGC的阶段，与终端进行协商以基于终端的属性集合生成终端的解密密钥；任一终端的属性集合中的属性用于描述该终端；任一终端，按照如上第一方面所述的方法中的步骤执行；云服务器，用于存储任一终端上传的数据信息，并基于第一终端的数据请求验证所述第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配，在验证所述第一终端的属性集合与第二访问策略匹配时发送的第二数据信息匹配时，发送第二终端上传的第二数据信息给第一终端；区块链，用于通过其中的节点存储任一终端上传的令牌。根据本申请实施例的第三方面，提供一种支持数据完整性审计的属性加密装置，所述装置应用于第一终端，所述装置包括：注册模块，用于在第一终端注册至密钥生成中心KGC的阶段，与KGC进行协商以获得KGC基于第一终端的属性集合生成的第一终端的解密密钥；加密模块，用于在第一终端对第一目标数据进行加密的阶段，基于第一秘密值、第一目标数据和KGC已广播的公共安全元素生成第一令牌，以及，基于第一秘密值和所述公共安全元素对第一目标数据进行加密得到第一密文，将第一数据信息上传至云服务器并将第一令牌上传至区块链；其中，第一数据信息至少包括：第一终端的第一访问策略、第一密文以及第一变量参数；第一访问策略指示第一终端的访问权限；第一变量参数用于解密端基于解密密钥和该第一变量参数获得第一秘密值，第一令牌用于解密端进行数据完整性审计；解密模块，用于在第一终端请求第二终端的数据时发送数据请求给云服务器，以由云服务器验证第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配；获得云服务器在验证匹配时发送的第二数据信息；第二数据信息由第二终端按照第一终端生成第一数据信息的方式生成，第二数据信息包括：第二访问策略、第二密文以及第二变量参数；利用所述解密密钥并结合第二变量参数解析出第二秘密值，依据第二秘密值从第二密文中解密出第二目标数据；从区块链中下载第二令牌以基于第二令牌进行数据完整性审计；第二令牌由第二终端按照第一终端生成第一令牌的方式生成并上传至区块链。根据本申请实施例的第四方面，提供一种电子设备，电子设备包括：处理器和存储器；其中，所述存储器，用于存储机器可执行指令；所述处理器，用于读取并执行所述存储器存储的机器可执行指令，以实现如第一方面所述的方法。根据本申请实施例的第五方面，提供一种计算机程序产品，所述计算机程序产品内存储有计算机程序，所述计算机程序被处理器执行时实现如第一方面所述的方法。本申请实施例提供的技术方案可以包括以下有益效果：由以上技术方案可以看出，本申请实施例中，通过第一终端在注册阶段与KGC进行协商以获得所述KGC基于本第一终端的属性集合生成的第一终端的解密密钥，以及在第一终端请求第二终端的数据时，借助于第一终端的属性集合与第二终端已上传的第二终端的第二访问策略是否匹配决策是否允许第一终端获得第二终端的数据，并在决策出第一终端具有权限访问第二终端的第二数据信息时，利用在注册阶段与KGC进行协商获得的解密密钥从第二密文中解密出第二目标数据，并从区块链中下载第二令牌，以基于第二令牌进行第二目标数据的数据完整性审计，实现了支持数据完整性审计的属性加密，避免应用传统加密技术带来的问题比如非对称加密技术下由于私钥被泄露引起的攻击危害；进一步地，在本实施例中，将用于数据完整性审计的令牌存放至区块链，借助于区块链的不可篡改链式结构来存储任一终端发送的令牌，保证了令牌不被篡改，提高数据共享安全，同时，也可将本实施例拓展至分布式场景，满足用户去中心化需求。进一步地，本实施例中，借助于第一终端的属性集合与第二终端已上传的第二终端的第二访问策略是否匹配决策是否允许第一终端获得第二终端的数据，能够实现数据在云存储中细粒度访问权限控制，保护数据隐私安全。这里，细粒度控制是指在系统或应用程序中实现一种能够精确地控制访问权限或资源使用的技术，它允许管理员或用户按照特定的需求来定义和控制对系统或资源的访问方式。进一步地，本实施例中，基于第一秘密值和KGC在初始化阶段已广播的公共安全元素对第一目标数据进行加密得到第一密文，其相当于借助KGC自身通过双线性配对运算完成加密，无需额外成本。附图说明图1是本申请实施例示出的系统示例图。图2是本申请实施例示出的方法流程图。图3是本申请实施例示出的具体示例图。图4是本申请实施例示出的装置结构图。图5是本申请实施例示出的电子设备结构图。具体实施方式这里将详细地对示例性实施例进行说明，其示例表示在附图中。下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。以下示例性实施例中所描述的实施方式并不代表与本申请相一致的所有实施方式。相反，它们仅是与如所附权利要求书中所详述的、本申请的一些方面相一致的装置和方法的例子。在本申请使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本申请。在本申请和所附权利要求书中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义。还应当理解，本文中使用的术语“和/或”是指并包含一个或多个相关联的列出项目的任何或所有可能组合。应当理解，尽管在本申请可能采用术语第一、第二、第三等来描述各种信息，但这些信息不应限于这些术语。这些术语仅用来将同一类型的信息彼此区分开。例如，在不脱离本申请范围的情况下，第一信息也可以被称为第二信息，类似地，第二信息也可以被称为第一信息。取决于语境，如在此所使用的词语“如果”可以被解释成为“在……时”或“当……时”或“响应于确定”。接下来对本说明书实施例进行详细说明。如图1所示，图1为本申请实施例示出的系统结构图。在本实施例中，该系统可包括：密钥生成中心、云服务器、区块链上各节点、多个终端。作为一个实施例，KGC负责终端的注册，并在终端注册至本KGC的阶段，为合法终端生成基于该终端的属性集合的解密密钥。作为一个实施例，云服务器，其存储资源丰富，用于存储终端上传的数据信息，并提供数据共享功能即当接收到其他终端发送的数据请求时，基于该数据请求返回对应的数据信息。区块链，一种去中心化的数字账本技术，由多个节点组成的网络维护，每个节点都存储着该网络上的完整副本。区块链上的交易被封装在一个区块中，每个区块都包含先前区块的哈希值，形成了一个不可篡改的链条。这种技术的安全性来自于加密技术和共识机制，其中所有节点必须达成一致才能更新区块链。本实施例借助于区块链的不可篡改链式结构来存储任一终端发送的令牌，保证了令牌不被篡改。任一终端，与KGC、云服务器以及区块链上各节点相配合，实现支持数据完整性审计的属性加密方式，下述图2举例示意了支持数据完整性审计的属性加密方式。可以看出，在本实施例中，终端与KGC、云服务器以及区块链上各节点相配合，共同实现了支持数据完整性审计的属性加密方式。其借助于区块链不可篡改等特性，提高数据共享安全，同时，并实现将本实施例拓展至分布式场景，满足用户去中心化需求。下面对图2所示流程进行描述：参见图2，图2是本申请实施例示出的方法流程图。该方法应用于任一终端，如图2所示，该流程可包括以下步骤：S210：在本第一终端注册至KGC的阶段，与KGC进行协商以获得KGC基于本第一终端的属性集合生成的第一终端的解密密钥。在本实施例中，第一终端的属性集合中的属性用于描述第一终端。比如在公司数据共享的应用场景中，第一终端的属性集合可包括如下多个属性：第一终端的终端标识、所在部门、第一终端的终端用户的职位、年龄等，本申请实施例并不具体限定。至于KGC如何基于第一终端的属性集合生成第一终端的解密密钥，下文会举例描述，这里暂不赘述。S220：在本第一终端对待加密的第一目标数据进行加密的阶段，获得本第一终端的第一访问策略，并基于随机选取的第一秘密值、第一目标数据和所述KGC在初始化阶段已广播的公共安全元素生成第一令牌，以及，基于第一秘密值和所述KGC在初始化阶段已广播的公共安全元素对第一目标数据进行加密得到第一密文，将第一密文携带在第一数据信息中上传至云服务器，并将第一令牌上传至区块链。作为一个实施例，第一访问策略用于指示第一终端的访问权限，比如对第一数据信息的访问权限。可选地，第一访问策略包括：属性描述信息矩阵和属性映射函数；其中，属性描述信息矩阵中每一目标描述信息用于描述对应的属性，所述目标描述信息为任一行或列中的数据，所述属性映射函数用于将属性描述信息矩阵中每一目标描述信息映射至对应的属性。比如，属性描述信息矩阵中某一行描述了姓名，则属性映射函数/＞用于将属性描述信息矩阵中该行上的元素组织映射出姓名这一属性。作为一个实施例，本步骤S220中，基于随机选取的第一秘密值、第一目标数据和所述KGC在初始化阶段已广播的公共安全元素生成第一令牌可包括：按照下式计算第一令牌：；其中，/＞表示第一令牌，/＞表示第一秘密值，H表示KGC在初始化阶段已广播的作为公共安全元素的哈希函数，/＞表示第一目标数据，/＞表示KGC已广播的第三公共安全元素。下文会举例描述KGC在初始化阶段广播公共安全元素，这里暂不赘述。在本实施例中，第一令牌用于解密端进行数据完整性审计。步骤S230举例描述了如何借助令牌比如第二令牌进行数据完整性审计，这里暂不赘述。需要说明的是，本实施例中将第一令牌上传至区块链，其具体是将第一令牌上传至区块链中任一节点。作为一个实施例，本步骤S220中，基于第一秘密值和所述KGC在初始化阶段已广播的公共安全元素对第一目标数据进行加密得到第一密文可包括：按照下式对第一目标数据进行加密：；其中，/＞表示第一密文，m表示第一目标数据，/＞表示KGC在初始化阶段已广播的第七公共安全元素，s1表示第一秘密值。在本实施例中，上述第一数据信息至少包括：第一访问策略、第一密文以及第一变量参数；第一变量参数用于解密端基于解密密钥和该第一变量参数获得第一秘密值，解密端是指用于请求第一数据信息的终端。下文会举例描述解密端基于解密密钥和该第一变量参数获得第一秘密值，这里暂不赘述。S230：在本第一终端需要请求第二终端的数据时，发送数据请求给云服务器，以由云服务器验证所述第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配；获得所述云服务器在验证所述第一终端的属性集合与第二访问策略匹配时发送的第二数据信息；所述第二数据信息至少包括：第二访问策略、第二密文以及第二变量参数；利用在注册至KGC阶段时与所述KGC进行协商获得的解密密钥并结合第二变量参数解析出第二秘密值，依据第二秘密值从第二密文中解密出第二目标数据；并从区块链中下载第二令牌以基于第二令牌进行数据完整性审计。作为一个实施例，云服务器验证第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配可包括：基于第二终端已上传的第二终端的第二访问策略得到第二终端的属性集合；若第一终端的属性集合为第二终端的属性集合的子集或者第一终端的属性集合与第二终端的属性集合一致，则确定第一终端的属性集合与第二访问策略匹配，否则，确定第一终端的属性集合与第二访问策略不匹配。这里，基于第二终端已上传的第二终端的第二访问策略得到第二终端的属性结合具体可见上述第一访问策略的描述，比如，通过第二访问策略中的属性映射函数将属性描述信息矩阵中每一目标描述信息映射至对应的属性，得到第二终端的属性集合。在本实施例中，第二数据信息是由第二终端按照如步骤S220中第一终端生成第一数据信息的方式生成。下文会举例描述第二变量参数。同样，在本实施例中，第二令牌由第二终端按照如步骤S220中第一终端生成第一令牌的方式生成并上传至区块链。示例性地，在本实施例中，从区块链中下载第二令牌可包括：向区块链发送令牌查询请求，这里，令牌查询请求携带令牌标识，接收区块链基于令牌查询请求反馈的令牌。最终实现了从区块链中下载第二令牌。可选地，这里的令牌标识可以根据解密后的第二目标数据确定，例如对解密后的第二目标数据进行哈希处理后得到令牌标识，本申请实施例并不具体限定。可选地，当区块链中任一节点接收到令牌查询请求，其会遍历各个区块，以查找到与令牌查询请求携带的令牌标识匹配的第二令牌。作为一个实施例，基于第二令牌进行数据完整性审计可包括：基于第一终端基于第二秘密值、第二目标数据和KGC在初始化阶段已广播的公共安全元素生成第三令牌，基于第二令牌和第三令牌进行数据完整性审计。这里，可按照下式计算第三令牌：；其中，/＞表示第三令牌，/＞表示第二秘密值，H表示KGC在初始化阶段已广播的作为公共安全元素的哈希函数，/＞2表示第二目标数据，/＞表示KGC已广播的第三公共安全元素。作为一个实施例，基于第二令牌和第三令牌进行数据完整性审计包括：检查所述第二令牌和所述第三令牌是否满足设定匹配要求，如果是，确定第二目标数据通过数据完整性审计，否则，确定第二目标数据未通过数据完整性审计。最终实现了支持数据完整性审计的属性加密。至此，完成图2所示方法的描述。对应图2所示流程，图3从整体上举例示出了整个流程。通过图2所示流程可以看出，本申请实施例中，通过第一终端在注册阶段与KGC进行协商以获得所述KGC基于本第一终端的属性集合生成的第一终端的解密密钥，以及在第一终端请求第二终端的数据时，借助于第一终端的属性集合与第二终端已上传的第二终端的第二访问策略是否匹配决策是否允许第一终端获得第二终端的数据，并在决策出第一终端具有权限访问第二终端的第二数据信息时，利用在注册阶段与KGC进行协商获得的解密密钥从第二密文中解密出第二目标数据，并从区块链中下载第二令牌，以基于第二令牌进行第二目标数据的数据完整性审计，实现了支持数据完整性审计的属性加密，避免应用传统加密技术带来的问题比如非对称加密技术下由于私钥被泄露引起的攻击危害；进一步地，在本实施例中，将用于数据完整性审计的令牌存放至区块链，借助于区块链的不可篡改链式结构来存储任一终端发送的令牌，保证了令牌不被篡改，提高数据共享安全，同时，也可将本实施例拓展至分布式场景，满足用户去中心化需求。进一步地，本实施例中，借助于第一终端的属性集合与第二终端已上传的第二终端的第二访问策略是否匹配决策是否允许第一终端获得第二终端的数据，能够实现数据在云存储中细粒度访问权限控制，保护数据隐私安全。这里，细粒度控制是指在系统或应用程序中实现一种能够精确地控制访问权限或资源使用的技术，它允许管理员或用户按照特定的需求来定义和控制对系统或资源的访问方式。进一步地，本实施例中，基于第一秘密值和KGC在初始化阶段已广播的公共安全元素对第一目标数据进行加密得到第一密文，其相当于借助KGC自身通过双线性配对运算完成加密，无需额外成本。作为一个实施例，假若第二变量参数为，n为第二访问策略中属性描述信息矩阵中的列数。第二变量参数携带在第二终端上传至云服务器的第二数据信息中。另外，假若第一终端的解密密钥为/＞，S表示所述属性集合中属性总数量。则上述步骤S230中，最终通过下式可得到第二秘密值/＞：；其中，/＞为KGC已广播的第二公共安全元素。即，最终实现了利用在注册至KGC阶段时与KGC进行协商获得的解密密钥并结合第二变量参数解析出第二秘密值s2。下面描述KGC如何广播公共安全元素：作为一个实施例，在初始阶段，KGC会选择系统安全参数和安全的双线性映射。其中，G1、G2为数据域，e数据域映射函数，用于从G1映射至G2，或者从G2映射至G1，p为已选择的大素数。此外，KGC还会在/＞中随机选取五个元素/＞并生成随机数/＞作为主私钥。之后，KGC生成公共安全参数并广播给其它实体比如与该KGC处于同一局域网内的所有终端。H表示哈希函数。需要说明的是，为保证安全性，主私钥/＞被本地单独保留，不会被KGC广播。以上对KGC广播公共安全元素进行了描述。下面对第一终端的解密密钥进行描述：基于如上描述的第一终端的解密密钥为，S表示所述属性集合中属性总数量，则作为一个实施例，上述/＞依据KGC已生成的目标随机数r和KGC已广播的第一公共安全元素w、以及KGC已广播的第二公共安全元素进行第一指定运算得到；第二公共安全元素通过/＞得到；e表示从第一数据域G1至第二数据域G2的映射函数，g为KGC随机选取的第三公共安全元素，/＞表示KGC的主私钥。比如，/＞。依据KGC已生成的目标随机数r和KGC已广播的第三公共安全元素g进行第二指定运算得到。比如，/＞。包括所述属性集合中每一属性对应的第一关键字，任一属性对应的第一关键字依据KGC为该属性生成的随机数和KGC已广播的第三公共安全元素g进行第二指定运算得到。比如，/＞。其中，j表示任一属性，/＞表示KGC为该属性j生成的随机数。包括所述属性集合中每一属性对应的第二关键字，任一属性对应的第二关键字依据KGC为该属性生成的随机数、该属性对应的数值、KGC已广播的第四公共安全元素u、第五公共安全元素h、第六公共安全元素v以及目标随机数r进行第三指定运算得到。比如，。其中，j表示任一属性，/＞表示KGC为该属性j生成的随机数，/＞表示该属性j对应的数值。需要说明的是，上述解密密钥只是为便于理解而进行的举例，并非用于限定。下面描述第二变量参数：作为一个实施例，第二访问策略中属性描述信息矩阵包含m行n列。为便于计算第二变量参数，需要先获得第二秘密值s2，并基于第二秘密值s1和随机选取的n-1个随机数组成向量，并计算属性描述信息矩阵与向量/＞的乘积，得到/＞。在此前提下下，上述第二变量参数中依据第二秘密值s2和KGC已广播的第三公共安全元素g进行第二指定运算得到。比如，/＞。依据第一秘密值s2和KGC已广播的第一公共安全元素w进行第二指定运算得到。比如，/＞。包括向量/＞中每一元素对应的第一参数。其中，任一元素i对应的第一参数通过下式确定：/＞；w表示第一公共安全元素，/＞表示/＞中第i个值，/＞表示随机数矩阵t中第i个值，v表示第六公共安全元素。包括向量/＞中每一元素对应的第二参数，其中，任一元素i对应的第二参数通过下式确定：/＞；u表示第四公共安全元素，/＞表示/＞中第i个值，/＞表示随机数矩阵t中第i个值，h表示第五公共安全元素。包括向量/＞中每一元素对应的第三参数，其中，任一元素i对应的第三参数通过下式确定：/＞。g表示第二公共安全元素，/＞表示随机数矩阵t中第i个值。需要说明的是，上述第二变量参数只是为便于理解而进行的举例，并非用于限定。对应地，第一终端生成第一变量参数的方式类似上述第二变量参数的生成方式，这里不再赘述。以上对本申请实施例提供的方法进行了描述，下面对本申请实施例提供的系统和装置进行描述：本申请实施例提供的系统可包括：密钥生成中心KGC，用于广播公共安全元素，并在任一终端注册至本密钥生成中心KGC的阶段，与终端进行协商以基于终端的属性集合生成终端的解密密钥；任一终端的属性集合中的属性用于描述该终端；任一终端，按照如上方法中的步骤执行；云服务器，用于存储任一终端上传的数据信息，并基于第一终端的数据请求验证所述第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配，在验证所述第一终端的属性集合与第二访问策略匹配时发送的第二数据信息匹配时，发送第二终端上传的第二数据信息给第一终端；区块链，通过其中的节点存储任一终端上传的令牌。对应地，本申请实施例还提供了图4所示装置的结构图。参见图4，图4是本申请实施例提供的装置结构图，该装置应用于第一终端，可包括：注册模块，用于在第一终端注册至密钥生成中心KGC的阶段，与所述KGC进行协商以获得所述KGC基于本第一终端的属性集合生成的第一终端的解密密钥；所述属性集合中的属性用于描述所述第一终端；加密模块，用于在第一终端对待加密的第一目标数据进行加密的阶段，获得本第一终端的第一访问策略，并基于随机选取的第一秘密值、第一目标数据和所述KGC在初始化阶段已广播的公共安全元素生成第一令牌，以及，基于第一秘密值和所述KGC在初始化阶段已广播的公共安全元素对第一目标数据进行加密得到第一密文，将第一密文携带在第一数据信息中上传至云服务器，并将第一令牌上传至区块链；其中，所述第一终端的第一访问策略指示第一终端的访问权限；所述第一数据信息至少包括：第一访问策略、第一密文以及第一变量参数；第一变量参数用于解密端基于解密密钥和该第一变量参数获得第一秘密值，第一令牌用于解密端进行数据完整性审计，解密端是指用于请求第一数据信息的终端；解密模块，用于在第一终端需要请求第二终端的数据时，发送数据请求给云服务器，以由云服务器验证所述第一终端的属性集合是否与第二终端已上传的第二终端的第二访问策略匹配；获得所述云服务器在验证所述第一终端的属性集合与第二访问策略匹配时发送的第二数据信息；所述第二数据信息至少包括：第二访问策略、第二密文以及第二变量参数；利用在注册至KGC阶段时与所述KGC进行协商获得的解密密钥并结合第二变量参数解析出第二秘密值，依据第二秘密值从第二密文中解密出第二目标数据；并从区块链中下载第二令牌以基于第二令牌进行数据完整性审计。可选地，所述与KGC进行协商以获得所述KGC基于所述属性集合生成的解密密钥包括：将本第一终端的属性集合提交给KGC，以由KGC生成解密密钥Key；其中，Key至少包括：，S表示所述属性集合中属性总数量；依据KGC已生成的目标随机数r和KGC已广播的第一公共安全元素w、以及KGC已广播的第二公共安全元素进行第一指定运算得到；第二公共安全元素通过/＞得到；e表示从第一数据域G1至第二数据域G2的映射函数，g为KGC随机选取的第三公共安全元素，/＞表示KGC的主私钥；依据KGC已生成的目标随机数r和KGC已广播的第三公共安全元素g进行第二指定运算得到；包括所述属性集合中每一属性对应的第一关键字，任一属性对应的第一关键字依据KGC为该属性生成的随机数和KGC已广播的第三公共安全元素g进行第二指定运算得到；包括所述属性集合中每一属性对应的第二关键字，任一属性对应的第二关键字依据KGC为该属性生成的随机数、该属性对应的数值、KGC已广播的第四公共安全元素u、第五公共安全元素h、第六公共安全元素v以及目标随机数r进行第三指定运算得到。可选地，所述第一访问策略包括：属性描述信息矩阵和属性映射函数；其中，所述属性描述信息矩阵中每一目标描述信息用于描述对应的属性，所述目标描述信息为任一行或列中的数据，所述属性映射函数用于将属性描述信息矩阵中每一目标描述信息映射至对应的属性。可选地，所述基于随机选取的第一秘密值、第一目标数据和所述KGC在初始化阶段已广播的公共安全元素生成第一令牌包括：按照下式计算第一令牌：；其中，/＞表示第一令牌，/＞表示第一秘密值，H表示KGC在初始化阶段已广播的作为公共安全元素的哈希函数，/＞表示第一目标数据，/＞表示KGC已广播的第三公共安全元素；所述基于第二令牌进行数据完整性审计包括：基于第二秘密值、第二目标数据和所述KGC已广播的公共安全元素生成第三令牌；基于第二令牌和第三令牌进行数据完整性审计；其中，第三令牌按照下式计算：；其中，/＞表示第三令牌，/＞表示第二秘密值，H表示KGC在初始化阶段已广播的作为公共安全元素的哈希函数，/＞2表示第二目标数据，/＞表示KGC已广播的第三公共安全元素。可选地，所述基于第一秘密值和所述KGC在初始化阶段已广播的公共安全元素对第一目标数据进行加密得到第一密文包括：按照下式对第一目标数据进行加密：；其中，/＞表示第一密文，m表示第一目标数据，/＞表示KGC在初始化阶段已广播的第七公共安全元素，s1表示第一秘密值。可选地，所述基于第二令牌和第三令牌进行数据完整性审计包括：检查所述第二令牌和所述第三令牌是否满足设定匹配要求，如果是，确定第二目标数据通过数据完整性审计，否则，确定第二目标数据未通过数据完整性审计。对应地，本申请实施例还提供了图4所示装置的硬件结构图，具体如图5所示，该电子设备可以为上述实施方法的设备。如图5所示，该硬件结构包括：处理器和存储器。其中，所述存储器，用于存储机器可执行指令；所述处理器，用于读取并执行所述存储器存储的机器可执行指令，以实现如上所示的方法实施例。对应地，本申请实施例还提供一种计算机程序产品，所述计算机程序产品内存储有计算机程序，所述计算机程序被处理器执行时实现如上所示的方法实施例。作为一个实施例，存储器可以是任何电子、磁性、光学或其它物理存储装置，可以包含或存储信息，如可执行指令、数据，等等。例如，存储器可以是：易失存储器、非易失性存储器或者类似的存储介质。具体地，存储器可以是RAM、闪存、存储驱动器、固态硬盘、任何类型的存储盘，或者类似的存储介质，或者它们的组合。至此，完成图5所示电子设备的描述。上述对本说明书特定实施例进行了描述。其它实施例在所附权利要求书的范围内。在一些情况下，在权利要求书中记载的动作或步骤可以按照不同于实施例中的顺序来执行并且仍然可以实现期望的结果。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本领域技术人员在考虑说明书及实践这里申请的发明后，将容易想到本说明书的其它实施方案。本说明书旨在涵盖本说明书的任何变型、用途或者适应性变化，这些变型、用途或者适应性变化遵循本说明书的一般性原理并包括本说明书未申请的本技术领域中的公知常识或惯用技术手段。说明书和实施例仅被视为示例性的，本说明书的真正范围和精神由下面的权利要求指出。应当理解的是，本说明书并不局限于上面已经描述并在附图中示出的精确结构，并且可以在不脱离其范围进行各种修改和改变。本说明书的范围仅由所附的权利要求来限制。以上所述仅为本说明书的较佳实施例而已，并不用以限制本说明书，凡在本说明书的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本说明书保护的范围之内。
