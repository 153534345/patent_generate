标题title
一种用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法
摘要abst
本发明涉及数据存储安全技术领域，尤其是提供了一种用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法。该算法包括将JPEG原始图像进行分块并量化，获取量化后的DCT系数，并将图像矩阵分成64×64个8×8的DCT系数块；对每个8×8的DCT系数块中的AC系数中值为0的系数数量进行统计，并按统计的结果进行从大到小的排序以及按排序进行嵌入；对每个8×8的DCT系数块中的DC系数采用一维正切混沌加密，AC系数采用Paillier同态加密，生成密文图像，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，通过Paillier同态加密技术提高了加密的安全性和图像质量的稳定性，提升了在压缩图像上嵌入附加信息的容量，并实现了可分离提取敏感信息，不影响解密结果。
权利要求书clms
1.一种用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法，其特征在于，所述算法包括：步骤一、对JPEG原始图像进行处理，采用512×512将JPEG原始图像进行分块并量化，获取量化后的离散余弦变换DCT系数，并将图像矩阵分成64×64个8×8的DCT系数块，其中，每个所述8×8的DCT系数块包括直流DC系数和交流AC系数；步骤二、根据步骤一中的64×64个8×8的DCT系数块，对每个所述8×8的DCT系数块中的AC系数中值为0的系数数量进行统计，并按统计的结果进行从大到小的排序以及按所述排序进行嵌入；步骤三、根据步骤二中的嵌入，对每个所述8×8的DCT系数块中的DC系数采用一维正切混沌加密，AC系数采用Paillier同态加密，生成密文图像；步骤四、根据步骤三中的加密，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像。2.根据权利要求1所述的算法，其特征在于，所述AC系数采用Paillier同态加密包括：选取AC系数中值为1或-1的系数，采取Paillier同态加密并同时嵌入敏感信息；对值为1或-1以外的正系数，采用Paillier同态加密；以及对值为1或-1以外的负系数，采用改进的Paillier同态加密。3.根据权利要求2所述的算法，其特征在于，所述选取AC系数中值为1或-1的系数，采取Paillier同态加密并同时嵌入敏感信息，包括：步骤S1、根据每个所述8×8的DCT系数块中AC系数的值为1或-1的系数，与其他值为非零的系数数量大小的占比进行比较，以分配密文值分布的范围；步骤S2、根据步骤S1中密文值分布的范围，选取二进制数据0或者1进行嵌入，对0和1分别进行Paillier同态加密。4.根据权利要求3所述的算法，其特征在于，在步骤S2之后还包括：选取对0和1加密后的密文并进行记录，分别记为 和/＞，将/＞和/＞作为密钥，用于提取敏感信息。5.根据权利要求1所述的算法，其特征在于，所述根据步骤三中的加密，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，包括：步骤V1、根据扩展的欧几里得，计算密钥和/＞的模乘法逆元/＞和/＞；步骤V2、根据步骤V1中的模乘法逆元和/＞，将其与密文值相乘，计算出嵌入的敏感信息，恢复JPEG原始图像。6.根据权利要求1所述的算法，其特征在于，所述根据步骤三中的加密，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，包括：步骤W1、根据Paillier同态加密的私钥，对密文图像进行解密，生成解密后的明文值；步骤W2、根据步骤W1中的明文值，通过Paillier同态加密的性质，计算出嵌入的敏感信息，恢复JPEG原始图像。7.根据权利要求6所述的算法，其特征在于，所述私钥的生成过程包括：a、随机生成两个素数p和q，其中，p和q满足与/＞的最大公约数为1，其公式为：；b、生成私钥系数，系数/＞的公式为：；其中，lcm为计算最小公倍数；c、构造L函数，其公式如下：；d、计算私钥系数，系数/＞的公式为：；其中，mod为模运算，求取余数；e、根据私钥系数和/＞生成私钥为/＞。8.根据权利要求5所述的算法，其特征在于，密文值c的公式为：；其中，m为待加密的明文值，且在云端收到用户发送的公钥为；n为p和q的乘积，随机选取整数g，g满足，取值范围为/＞，且最大公约数/＞，即g与/＞互质；取g=n+1，则公钥为；r为数据加密方随机生成的随机数，r满足，且/＞，即r与n互质。9.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质包括存储的程序，其中，在所述程序运行时控制所述计算机可读存储介质所在设备执行权利要求1至8中任一项所述的用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法。10.一种电子设备，其特征在于，包括：一个或多个处理器；存储器；以及一个或多个计算机程序，其中所述一个或多个计算机程序被存储在所述存储器中，所述一个或多个计算机程序包括指令，当所述指令被所述设备执行时，使得所述设备执行权利要求1至8中任一项所述的用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法。
说明书desc
技术领域本发明涉及数据存储安全技术领域，尤其涉及一种用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法。背景技术随着云计算的发展，云存储成为数据存储的主要方式，公众无需购买专门的存储设备，存储大量的个人数据，而是选择云存储的方式将大量的个人数据进行存储，这大大节省了存储数据带来的花销，但与此同时，云存储的数据也存在着不可估量的风险，如个人隐私数据被泄露、篡改以及传播。为了解决此类问题，加密域可逆信息隐藏应运而生。加密域可逆信息隐藏是指为了更安全的存储数据文件，内容所有者在上传多媒体文件之前会将文件数据进行加密，使数据不可见，而云平台管理人员为了方便对加密的多媒体数据进行管理存储，会在加密的多媒体数据中嵌入一些附加的敏感信息，从而更方便的管理云平台存储资源。大多数的加密域可逆信息隐藏方法都应用在未压缩的图像中，未压缩的图像中存在的嵌入空间较多，且嵌入容量较大，有良好的嵌入额外数据的性能。而当今较流行的便是联合摄影专家组图像，其通过一定的方式将图像压缩，使得在JPEG图像中嵌入的额外信息变少。在内容所有者将上传的多媒体文件进行加密时，大多数采用的是对称加密或者流加密的方式，其加密的方式过于简单，容易被攻击者破解加密的内容，从而获取用户上传的隐私数据，同时，这些传统的加密方式无法在加密后对密文数据进行修改，嵌入附加信息。发明内容有鉴于此，本发明提供了一种用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法，用以提高加密的安全性和图像质量的稳定性，提升在压缩图像上嵌入附加信息的容量，实现可分离提取敏感信息，并对加密后的密文进行操作时而不影响解密结果。第一方面，本发明提供了一种用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法，所述算法包括：步骤一、对JPEG原始图像进行处理，采用512×512将JPEG原始图像进行分块并量化，获取量化后的离散余弦变换DCT系数，并将图像矩阵分成64×64个8×8的DCT系数块，其中，每个所述8×8的DCT系数块包括直流DC系数和交流AC系数；步骤二、根据步骤一中的64×64个8×8的DCT系数块，对每个所述8×8的DCT系数块中的AC系数中值为0的系数数量进行统计，并按统计的结果进行从大到小的排序以及按所述排序进行嵌入；步骤三、根据步骤二中的嵌入，对每个所述8×8的DCT系数块中的DC系数采用一维正切混沌加密，AC系数采用Paillier同态加密，生成密文图像；步骤四、根据步骤三中的加密，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像。可选地，所述AC系数采用Paillier同态加密包括：选取AC系数中值为1或-1的系数，采取Paillier同态加密并同时嵌入敏感信息；对值为1或-1以外的正系数，采用Paillier同态加密；以及对值为1或-1以外的负系数，采用改进的Paillier同态加密。可选地，所述选取AC系数中值为1或-1的系数，采取Paillier同态加密并同时嵌入敏感信息，包括：步骤S1、根据每个所述8×8的DCT系数块中AC系数的值为1或-1的系数，与其他值为非零的系数数量大小的占比进行比较，以分配密文值分布的范围；步骤S2、根据步骤S1中密文值分布的范围，选取二进制数据0或者1进行嵌入，对0和1分别进行Paillier同态加密。可选地，在步骤S2之后还包括：选取对0和1加密后的密文并进行记录，分别记为和/＞，将/＞和/＞作为密钥，用于提取敏感信息。可选地，所述对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，包括：步骤V1、根据扩展的欧几里得，计算密钥和/＞的模乘法逆元/＞和/＞；步骤V2、根据步骤V1中的模乘法逆元和/＞，将其与密文值相乘，计算出嵌入的敏感信息，恢复JPEG原始图像。可选地，所述对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，包括：步骤W1、根据Paillier同态加密的私钥，对密文图像进行解密，生成解密后的明文值；步骤W2、根据步骤W1中的明文值，通过Paillier同态加密的性质，计算出嵌入的敏感信息，恢复JPEG原始图像。可选地，所述私钥的生成过程包括：a、随机生成两个素数p和q，其中，p和q满足与/＞的最大公约数为1，其公式为：；b、生成私钥系数，系数/＞的公式为：；其中，lcm为计算最小公倍数；c、构造L函数，其公式如下：；d、计算私钥系数，系数/＞的公式为：；其中，mod为模运算，求取余数；e、根据私钥系数和/＞生成私钥为/＞。可选地，密文值c的公式为：；其中，m为待加密的明文值，且在云端收到用户发送的公钥为；n为p和q的乘积，随机选取整数g，g满足，取值范围为/＞，且最大公约数，即g与/＞互质；取g=n+1，则公钥为；r为数据加密方随机生成的随机数，r满足/＞，且/＞，即r与n互质。第三方面，本发明提供一种计算机可读存储介质，所述计算机可读存储介质包括存储的程序，其中，在所述程序运行时控制所述计算机可读存储介质所在设备执行第一方面或第一方面任一可能的实现方式中的用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法。第四方面，本发明提供一种电子设备，包括：一个或多个处理器；存储器；以及一个或多个计算机程序，其中所述一个或多个计算机程序被存储在所述存储器中，所述一个或多个计算机程序包括指令，当所述指令被所述设备执行时，使得所述设备执行第一方面或第一方面任一可能的实现方式中的用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法。本发明提供的技术方案中，该算法包括对JPEG原始图像进行处理，采用512×512将JPEG原始图像进行分块并量化，获取量化后的DCT系数，并将图像矩阵分成64×64个8×8的DCT系数块，其中，每个8×8的DCT系数块包括DC系数和AC系数；对每个8×8的DCT系数块中的AC系数中值为0的系数数量进行统计，并按统计的结果进行从大到小的排序以及按排序进行嵌入；对每个8×8的DCT系数块中的DC系数采用一维正切混沌加密，AC系数采用Paillier同态加密，生成密文图像，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，本发明通过Paillier同态加密技术提高了加密的安全性和图像质量的稳定性，提升了在压缩图像上嵌入附加信息的容量，并实现了可分离提取敏感信息，并对加密后的密文进行操作时而不影响解密结果。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1为本发明实施例提供的生成密文图像方法的流程图；图2为本发明实施例提供的离散余弦变换系数块的示意图；图3为本发明实施例提供的另一离散余弦变换系数块的示意图；图4为本发明实施例提供的单峰混沌映射的分岔图；图5为本发明实施例提供的切比雪夫映射的分岔图；图6为本发明实施例提供的一维正切混沌映射的分岔图；图7为本发明实施例提供的三种混沌映射的LE比较的示意图；图8为本发明实施例提供的一维正切混沌映射的LE的示意图；图9为本发明实施例提供的三种混沌映射的SE比较的示意图；图10为本发明实施例提供的解密密文图像方法的流程图；图11为本发明实施例提供的对明文数据10加密的示意图；图12为本发明实施例提供的对明文数据50加密的示意图；图13为本发明实施例提供的对明文数据1加密的示意图；图14为本发明实施例提供的另一对明文数据1加密的示意图；图15为本发明实施例提供的筛选10000-45000密文值的示意图；图16为本发明实施例提供的一种电子设备的示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。应当明确，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。在本发明实施例中使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本发明。在本发明实施例中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义。应当理解，本文中使用的术语“和/或”仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，甲和/或乙，可以表示：单独存在甲，同时存在甲和乙，单独存在乙这三种情况。另外，本文中字符“/”，一般表示前后关联对象是一种“或”的关系。取决于语境，如在此所使用的词语“如果”可以被解释成为“在……时”或“当……时”或“响应于确定”或“响应于检测”。类似地，取决于语境，短语“如果确定”或“如果检测”可以被解释成为“当确定时”或“响应于确定”或“当检测时”或“响应于检测”。为了保证超算云平台的媒体数据的安全，保障信息安全可靠的存储和转发，用户在上传图像数据之前，为了不让他人看到其上传的数据，会先将图像进行加密操作，超算云平台管理员为方便管理云平台上的数据信息，会对用户加密后的图像数据额外嵌入敏感信息，在用户需要下载原始图像时，系统将嵌入的敏感信息提取出来，并恢复出原始图像数据，从而实现信息安全可靠的存储和转发。本发明针对用户上传到云平台上的最流行的JPEG图像格式进行处理，保障在云平台存储下的图像数据的安全。对JPEG图像进行处理，将敏感信息嵌入到JPEG图像中，实现可逆信息隐藏共有三种方式，分别为基于量化DCT系数操作的可逆信息隐藏，基于修改量化表的RDH以及基于修改哈夫曼Huffman编码的RDH。本发明采用基于量化离散余弦变换系数操作的RDH这类方法，实现在加密域下的JPEG图像可逆信息隐藏。本发明采用Paillier同态加密技术实现在JPEG图像中的可逆信息隐藏，利用Paillier同态加密的性质：密文乘等于明文加，在JPEG图像中，用量化DCT系数的RDH方法，将敏感信息进行边加密边嵌入。同时，在将DCT系数中的交流分量进行加密时，控制生成的密文值的分布范围，控制密文值大小，与此同时，将密文进行溢出处理，形成密文图像，存储在云平台中。本发明实施例中，Paillier基于复合剩余类的困难问题，发明了Paillier同态加密，该加密算法满足加法和数乘同态，因此该Paillier同态加密以Paillier人名命名。图1为本发明实施例提供的生成密文图像方法的流程图，如图1所示，该方法包括：步骤一、对JPEG原始图像进行处理，采用512×512将JPEG原始图像进行分块并量化，获取量化后的离散余弦变换DCT系数，并将图像矩阵分成64×64个8×8的DCT系数块，其中，每个8×8的DCT系数块包括直流DC系数和交流AC系数。本发明实施例中，如图2所示，每一个DCT系数块中包含最左上角的1个DC系数和剩余的63个AC系数，其中DC系数称为直流系数，其代表图像的平均亮度值，且对图像质量影响较大，对其修改可能会对图像造成损失和不可逆变化，所以在进行可逆信息隐藏的过程中，尽量不去修改DC系数的值，只对其进行加密操作；而AC系数称为交流系数，对图像质量影响较小，且变化范围更大，可以嵌入更多信息，其中包含大多数的零和趋于零的其他数据构成。如图3所示，随机选取的一个8×8的DCT系数块，其中-58为DC系数，剩余的数据为AC系数，其包含的数据为大多数的0和1以及-1。步骤二、根据步骤一中的64×64个8×8的DCT系数块，对每个8×8的DCT系数块中的AC系数中值为0的系数数量进行统计，并按统计的结果进行从大到小的排序以及按排序进行嵌入。本发明实施例中，对于随机选取的一个8×8的DCT系数块，如图3所示，经统计发现，AC系数中包含0系数越多的DCT系数块，其包含的数字１和-1便越多。所以采用对每一个8×8块中的AC系数中值为0的数量进行统计，并进行排序，按0系数的数量进行从大到小的排序，选择0系数多的AC系数先进行嵌入操作，提高嵌入容量。步骤三、根据步骤二中的嵌入，对每个8×8的DCT系数块中的DC系数采用一维正切混沌加密，AC系数采用Paillier同态加密，生成密文图像。本发明实施例中，在对DC系数混沌加密时，采用一维正切混沌加密将DC系数加密成具有良好混沌性能的混沌序列；在对AC系数Paillier同态加密的同时，嵌入二进制数据0或1同态加密后的密文和/＞，形成密文DCT系数，在进行同态加密的过程中，采用一种控制AC系数密文值范围的方法，将含嵌入敏感信息的AC系数控制密文值范围为，其他AC系数控制密文值范围为/＞，形成密文图像。本发明实施例中，采用边加密边嵌入信息的方式，先对每一个8×8的DCT系数块中的DC系数进行一维正切混沌加密，保证数据的安全，然后选取AC系数中的1和-1进行Paillier同态加密并同时嵌入敏感信息，其余的AC系数只进行Paillier同态加密。本发明实施例中，AC系数采用Paillier同态加密包括：选取AC系数中值为1或-1的系数，采取Paillier同态加密并同时嵌入敏感信息；对值为1或-1以外的正系数，采用Paillier同态加密；以及对值为1或-1以外的负系数，采用改进的Paillier同态加密。本发明实施例中，选取AC系数中值为1或-1的系数，采取Paillier同态加密并同时嵌入敏感信息，包括：步骤S1、根据每个8×8的DCT系数块中AC系数的值为1或-1的系数，与其他值为非零的系数数量大小的占比进行比较，以分配密文值分布的范围。本发明实施例中，在对于AC系数中1和-1的加密过程中，根据每一个8×8的DCT系数块中AC系数值为1和-1与其他非零数值的数据量大小的占比比较，分配密文值分布的范围，使得图像加密后的含密数据值的直方图分布更加均匀，保证了加密后的密文图像不易被攻击者检测出变化，从而保证了信息的安全。步骤S2、根据步骤S1中密文值分布的范围，选取二进制数据0或者1进行嵌入，对0和1分别进行Paillier同态加密。本发明实施例中，在步骤S2之后还包括：选取对0和1加密后的密文并进行记录，分别记为和/＞，将/＞和/＞作为密钥，用于提取敏感信息。需注意，对于负系数的加密采用改进的Paillier同态加密算法，从而能够实现负数数据的正确解密。本发明实施例中，采用了一种新的一维正切混沌映射，对DC系数进行混沌加密，相较于两类传统的混沌映射，本发明采用的一维正切混沌映射能产生更好的混沌序列，具有较好的混沌性能，且对DC系数混沌加密后的密文更安全，不易被攻击者破解，增强存储数据的安全性。经典的一维混沌映射有单峰混沌映射和切比雪夫映射，以下是二者的计算公式：分析这两种传统映射的分岔图可知，如图4所示，横坐标为控制参数，纵坐标/＞为第n个单峰混沌映射值，单峰混沌映射中的/＞，/＞时，系统进入混沌状态，如图5所示，横坐标/＞为控制参数，/＞为第n个切比雪夫混沌映射值，切比雪夫映射中的/＞，/＞时,系统进入混沌状态。可以看出，两种混沌映射进入混沌状态时参数范围较小，具有一定的限制性。本发明实施例中，如图6所示，本文采用一种新的一维正切混沌映射对DC系数进行混沌加密，其相较前两种传统的混沌映射系统具有良好的混沌性能，且其混沌序列呈伪随机的形式均匀分布，克服了前两种混沌映射进入混沌状态参数范围较小的问题，具有较大的参数区间，其公式如下：式中，/＞为控制参数，/＞，且/＞时，一维正切混沌映射具有较好的混沌性能。本发明实施例中，混沌系统加密测试比较：本发明采用李雅普诺夫指数和香农熵进行混沌系统测试比较，将本文采用的一维正切混沌映射与单峰混沌映射和切比雪夫映射比较分析。其中Lyapunov指数和Shannon熵的计算公式如下：Lyapunov指数中当为负值时，表示系统沿该方向收缩，当/＞为正值时，系统进入混沌状态。如图7和图8所示，三种混沌映射的LE比较，当/＞，系统进入混沌状态, 可以看出一维正切混沌映射比单峰混沌映射和切比雪夫映射正值范围更大，混沌的性能更好。Shannon熵中当熵值越大，表示混沌系统产生的混沌序列越无序，混沌序列越无序则表明混沌性能越好。如图9所示，三种混沌映射的SE比较，一维正切混沌映射的熵值/＞最大，且比较稳定，则表明其混沌序列无序性最好，混沌性能最好。经过将一维正切混沌映射与两种传统的混沌映射的LE和SE的比较，一维正切混沌映射的混沌序列最无序，混沌性能最好，加密后的密文最安全。故本发明采用一维正切混沌映射对JPEG图像的DC系数加密，保障密文数据安全。步骤四、根据步骤三中的加密，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像。超算云平台的管理员在管理密文图像数据时，需要查看先前嵌入到密文图像的敏感信息，以用来分类管理密文图像数据，超算云平台管理员可以直接从密文图像中提取敏感信息，不需要解密密文图像。而用户在从超算云平台中获取自己上传到密文图像后，可进行解密操作，恢复原始图像，解析出敏感信息。对于图像的恢复和提取嵌入的敏感信息，是可分离的操作，第一种可以先直接解密密文图像，在解密后进行提取嵌入的敏感信息，第二种是先对密文图像提取敏感信息，之后再进行解密密文图像，恢复原始图像。对于这两种方式，都可以提取到嵌入的敏感信息并恢复原始密文图像。图10为本发明实施例提供的解密密文图像方法的流程图，如图10所示，本发明提出的是可分离的可逆信息隐藏算法，即提取敏感信息和解密原始图像是可分别进行的，且能完全恢复原始图像，实现真同态可逆。云平台管理人员可在未知解密密钥的前提下，利用嵌入密钥和/＞提取嵌入的敏感信息，计算嵌入密钥的模乘法逆元并与密文值相乘，计算分析出嵌入的敏感信息，并恢复原始图像。用户可直接利用解密密钥将密文图像同态解密为含嵌入信息的原始图像，并根据同态加密的特殊性质，将嵌入图像中的敏感信息提取出来，并恢复原始图像。本发明实施例中，根据步骤三中的加密，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，包括：步骤V1、根据扩展的欧几里得，计算密钥和/＞的模乘法逆元/＞和/＞。本发明实施例中，Paillier同态加密算法涉及到模乘法逆元和扩展的欧几里得算法，其在加密、解密和运算中起到了关键作用。模乘法逆元：两个互质的整数x和n，存在一个整数满足：；从公式中可以看出除n的余数为1，且存在乘法逆元的充分必要条件是/＞与n互质。即：最大公约数/＞，其中x叫做/＞的乘法逆元，可记为/＞。而/＞可利用扩展的欧几里得算法求得。扩展的欧几里得算法：欧几里得算法又称辗转相除法，即求x和y的最大公约数。而扩展的欧几里得算法便是在欧几里得算法基础上给定一个线性方程：；给出a，b和m的值，求解x和y的值。只有时，即：当且仅当m为a和b两者最大公约数的倍数时，该线性方程才有解。而当m为1时，只有a和b互质才有解。步骤V2、根据步骤V1中的模乘法逆元和/＞，将其与密文值相乘，计算出嵌入的敏感信息，恢复JPEG原始图像。本发明实施例中，密文图像中直接提取敏感信息：从图像加密和嵌入的过程中得知，对于解析AC系数加密和嵌入信息后的密文，根据密文值的范围，能明确得知在1.0×104-2×104之间的密文一定嵌入了敏感信息，而在2×104-4.5×104之间的密文，只是进行了Paillier同态加密。只需要根据对敏感信息加密后形成的密钥和/＞，并计算出二者的模乘法逆元/＞和/＞，与同态加密后形成的密文/＞或/＞相乘即可计算分析出嵌入的敏感信息。即：其中和/＞是AC系数中的1和-1与敏感信息的0或1进行加法同态的结果，公式如下：而密钥和/＞与各自的模乘法逆元相乘结果如下：因此据公式可知，只要使用或/＞能对AC系数加密的密文恢复到原始的密文值范围1.0×104-2×104内，即上述公式中计算出的/＞或/＞的值在1.0×104-2×104之间，根据密钥/＞或/＞便可确认嵌入了0或1。若利用/＞或/＞据上述公式计算出的结果范围在2.0×104-4.5×104之间，便认为没有进行嵌入信息操作，只进行了Paillier同态加密。提取完嵌入的敏感信息后，便恢复了原始密文图像，在用户需要下载时，将原始密文图像传给用户，用户可用私钥对密文图像进行解密并恢复原始图像。本发明实施例中，根据步骤三中的加密，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，包括：步骤W1、根据Paillier同态加密的私钥，对密文图像进行解密，生成解密后的明文值；本发明实施例中，私钥的生成过程包括：a、随机生成两个素数p和q，其中，p和q满足与/＞的最大公约数为1，其公式为：；b、生成私钥系数，系数/＞的公式为：；其中，lcm为计算最小公倍数；c、构造L函数，其公式如下：；d、计算私钥系数，系数/＞的公式为：；其中，mod为模运算，求取余数；e、根据私钥系数和/＞生成私钥为/＞。本发明实施例中，密文值c的公式为：；其中，m为待加密的明文值，且在云端收到用户发送的公钥为；n为p和q的乘积，随机选取整数g，g满足，取值范围为/＞，且最大公约数/＞，即g与/＞互质；取g=n+1，则公钥为；r为数据加密方随机生成的随机数，r满足/＞，且/＞，即r与n互质。步骤W2、根据步骤W1中的明文值，通过Paillier同态加密的性质，计算出嵌入的敏感信息，恢复JPEG原始图像。本发明实施例中，根据从云端获得的密文值c，以及私钥，进行密文解密。根据以下公式可得到明文值m：。本发明实施例中，首先加密生成两个数据的密文，分别为和/＞。其中，/＞。根据公式：；其中Paillier加法同态加密的性质：对于两个密文c1和c2，在密文域内相乘等于在明文域内相加。即：其中，相当于/＞中的m，即对于c进行解密得到的明文结果为/＞。本发明实施例中，解密图像后提取敏感信息：在密文图像嵌入信息后，若拥有Paillier同态加密的私钥，便可先对密文图像进行解密，解密后的图像是包含嵌入信息的，可利用同态加密算法的性质，将包含嵌入敏感信息的图像进行处理，提取嵌入敏感信息并恢复原始图像。先利用同态加密算法，根据私钥对原始密文图像进行解密。根据同态加密的性质：密文乘等于明文加，即有如下公式：其中，D函数为解密函数，对两个同态加密中相乘的密文解密，结果为两个明文相加。若对1进行同态加密生成的密文为12972，密钥为29533，/＞为21487。当N为209，g为210，r为48，则有：若对-1进行同态加密生成的密文为17481，密钥为29533，/＞为21487。当N为209，g为210，r为48，则有：如上述公式，根据同态加密的性质，密文乘等于明文加，可根据解密后的数值来判断嵌入的信息和原始的AC系数，如若嵌入的敏感信息为0，而AC系数的值为1，则解密后的值为1，因嵌入的信息和选取的AC系数相加后的数值各不一致，所以可根据解密后的数值推断嵌入的数据和恢复原始的AC系数，因此可完整的提取出嵌入的信息以及恢复原始图像。本发明实施例中，对于负系数的处理：当m为负数的情况下，对于以上所提及的Paillier同态加密算法，无法实现加密后解密出原始的明文。所以需改进Paillier同态加密算法中加密的部分，对于加密公式：，改为：用来代替负数的操作，即先求出g的乘法逆元，根据简化剩余系/＞以及欧拉定理有：从而可利用扩展的欧几里得算法来计算乘法逆元，从而可以支持负数的加密，可以利用Paillier同态加密算法对负数数据进行操作。对于两个负数进行同态加法加密时，可先利用以上步骤将和/＞转化成密文/＞和/＞，再根据/＞进行加法同态加密。但需注意，若/＞，且，计算出来的结果若为负数，则进行加法同态加密后，解密出来的明文结果并不是负数值，而是answer的值。本发明实施例中，解密密文图像方法中第一种方式是根据先前同态加密控制密文值的分布范围，找到嵌入敏感信息的密文值范围，并根据嵌入的密钥和/＞计算模乘法逆元，并与密文值相乘，分析提取嵌入的敏感信息，根据加密密钥将密文图像解密，然后恢复原始图像。第二种方式是获取同态加密的密钥对密文图像进行解密，形成明文，利用同态加密的性质：密文乘等于明文加，对明文数据进行分析，提取到嵌入的敏感信息，并恢复原始图像。本发明实施例中，可筛选符合条件的密文值，控制密文值范围，保证对明文数据加密后的密文值的直方图均匀分布，保障数据的安全，不易被监测者发现。根据上述的Paillier同态加密算法，可知与密文生成有关的参数有p、q、g、r、n、，根据同态加密的公式得知控制密文数据生成大小的是参数p、q、r，其它的参数都与之相关。其中r为随机产生的数据，r满足/＞，且/＞，即r与n要互质。而大素数p和q是最主要的控制密文值大小范围的参数。如图11和图12可知，r从10000中随机生成，将p和q的值固定后，不管怎样随机产生r值，对明文进行加密后密文值的大小范围是确定的。例如图11和图12中将p=11，q=19，则密文值的范围不超过4.5×104。同态加密中参数p、q对密文值范围的影响：据Paillier同态加密的公式得知，其加密过程中的参数的确定都与大素数p和q有关，通过将其他参数固定，来研究p和q对密文值范围大小的影响。如图13和图14可知，r从10000中随机生成，对明文数据1进行Paillier同态加密，图13中当p=17，q=19时，密文值范围最大到1.05×105，图14中当p=23，q=29时，密文值范围最大到4.5×104。与此同时，当参数p和q的值越来越大时，生成的密文值范围越来越大，所以可以将p和q控制在一定的数据范围内，从而使得密文值的范围不至于过大，导致数据量过大，节省存储空间。本发明中选取控制密文范围大小的流程如下：首先，如图15所示，r从10000中随机生成，将密文值的范围控制在1.0×104-4.5×104之间，保证加密后的密文值数据都为5位数。对于AC系数中的1和-1进行边加密边嵌入敏感信息，将对1和-1进行加密和嵌入敏感信息后的密文值数据控制在范围为1.0×104-2.0×104之间。对于AC系数中的其他数据，将密文数据控制在2.0×104-4.5×104之间。对嵌入的敏感信息0和1进行Paillier同态加密，记录加密后的密文值记为和。若对于1加密后的密文数据值分别为和/＞，其中/＞和/＞满足密文值数据的范围，对于1嵌入二进制数据0，根据Paillier同态加密则有：对于1嵌入二进制数据1，根据Paillier同态加密则有：。本发明实施例中，在将AC系数同态加密后，形成了具有一定范围的且为五位数的密文数据值，而AC系数的范围是有一定限制的，它的范围为之间，对于进行Paillier同态加密后AC系数的密文数据值范围在1.0×104到4.5×104之间，显然远远超出了AC系数范围值的限制，无法将DCT系数反量化后形成密文图像。所以需要将进行同态加密后的密文数据值进行溢出处理，使之符合AC系数范围的要求，从而能够形成密文图像。溢出处理的具体步骤如下：假设对AC系数加密后形成的密文值为，其中下标n为对n个AC系数进行加密，为进行溢出处理后的满足范围要求的数值，/＞为密文值除以5的余数。有以下公式：因量化后的AC系数中有许多0系数，所以将加密后的密文值处理到0系数附近，使之没有太大的数据波动，更好的保证图像数据的安全。将同态加密后的密文值进行模5操作，这样仅含有0到4之间的数，且符合AC系数的范围，将/＞写入到AC系数中，并通过反量化形成密文图像。通过记录余数/＞来进行将密文图像解密。与此同时，溢出处理操作大大减小了因同态加密造成的密文数据太大，对图像文件增量的影响，可以保证图像的文件增量保持在较小的范围内。本发明实施例中，各步骤可以由电子设备执行。例如，电子设备包括但不限于平板电脑、便携式PC、台式PC等。本发明相比于现有技术的有益效果包括：提出利用Paillier同态加密算法对JPEG图像进行加密，并在加密过程中嵌入敏感数据。具体而言，只对JPEG图像中合适的量化AC系数进行同态加密，实现敏感数据的嵌入。提出了一种可以控制Paillier同态加密生成密文值范围的方法，从而防止密文值过大而占用过多的存储空间。该方法保证了同态加密的密文值落在一定的范围内，避免了密文值的数值范围过宽。实现了同态加密后密文的均匀分布，增强了数据的安全性。在加密JPEG图像的过程中，对DCT系数采用单独的数据加密算法。在嵌入敏感数据时，直流系数采用一维正切混沌加密，交流系数采用同态加密。因此，该方案不仅增强了加密的安全性，而且可以实现更多的敏感数据嵌入，增加了数据嵌入容量。本发明提供的技术方案中，该算法包括对JPEG原始图像进行处理，采用512×512将JPEG原始图像进行分块并量化，获取量化后的DCT系数，并将图像矩阵分成64×64个8×8的DCT系数块，其中，每个8×8的DCT系数块包括DC系数和AC系数；对每个8×8的DCT系数块中的AC系数中值为0的系数数量进行统计，并按统计的结果进行从大到小的排序以及按排序进行嵌入；对每个8×8的DCT系数块中的DC系数采用一维正切混沌加密，AC系数采用Paillier同态加密，生成密文图像，对密文图像进行解密，分离提取嵌入的敏感信息，以获取JPEG原始图像，本发明通过Paillier同态加密技术提高了加密的安全性和图像质量的稳定性，提升了在压缩图像上嵌入附加信息的容量，并实现了可分离提取敏感信息，并对加密后的密文进行操作时而不影响解密结果。本发明实施例提供了一种计算机可读存储介质，计算机可读存储介质包括存储的程序，其中，在程序运行时控制计算机可读存储介质所在电子设备执行上述用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法。图16为本发明实施例提供的一种电子设备的示意图，如图16所示，电子设备21包括：处理器211、存储器212以及存储在存储器212中并可在处理器211上运行的计算机程序213，该计算机程序213被处理器211执行时实现实施例中的用于分离提取敏感信息的JPEG加密域可逆信息隐藏算法，为避免重复，此处不一一赘述。电子设备21包括，但不仅限于，处理器211、存储器212。本领域技术人员可以理解，图5仅仅是电子设备21的示例，并不构成对电子设备21的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件，例如电子设备还可以包括输入输出设备、网络接入设备、总线等。所称处理器211可以是中央处理单元，还可以是其他通用处理器、数字信号处理器 、专用集成电路、现场可编程门阵列  或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。存储器212可以是电子设备21的内部存储单元，例如电子设备21的硬盘或内存。存储器212也可以是电子设备21的外部存储设备，例如电子设备21上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，存储器212还可以既包括电子设备21的内部存储单元也包括外部存储设备。存储器212用于存储计算机程序以及网络设备所需的其他程序和数据。存储器212还可以用于暂时地存储已经输出或者将要输出的数据。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的系统，装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明保护的范围之内。
