标题title
一种基于区块链的电子病历分布式共享方法及装置
摘要abst
本发明提供了一种基于区块链的电子病历分布式共享方法及装置，涉及电子病历的共享领域，本方法包括：获取每个节点所对应的电子病历数据、操作信息和病历索引信息；对每个节点所对应的电子病历数据通过预设的智能合约模型进行判定，当电子病历数据满足预设的判定要求时，得到原始病历数据集；对原始病历数据集进行分类计算，得到原始病历摘要和脱敏数据集；对电子病历数据提取描述信息，得到病历描述数据集；将脱敏病历文件和病历描述数据集进行存储，得到文件存储信息，并返回文件存储信息的索引地址；将操作信息、病历索引信息、原始病历摘要以及脱敏病历摘要上链。本方法保证了电子病历数据的存储安全，加强了电子病历数据的共享性。
权利要求书clms
1.一种基于区块链的电子病历分布式共享方法，其特征在于，包括：获取每个节点所对应的电子病历数据、操作信息和病历索引信息；对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行判定，当所述电子病历数据满足预设的判定要求时，得到原始病历数据集；对所述原始病历数据集进行分类计算，得到原始病历摘要和脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要；对所述电子病历数据提取描述信息，得到病历描述数据集；将所述脱敏病历文件和所述病历描述数据集进行存储，得到文件存储信息，并返回文件存储信息的索引地址；将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链，当上链成功后返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。2.根据权利要求1所述的基于区块链的电子病历分布式共享方法，其特征在于，对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行判定，当所述电子病历数据满足预设的判定要求时，得到原始病历数据集，包括：对每个所述节点所对应的电子病历数据进行一次匹配，得到一次匹配数据，所述一次匹配数据用于对所述电子病历数据进行完整性检查；对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行二次匹配，得到二次匹配数据，所述二次匹配数据为智能合约模型中的约定编码协议所匹配输出的数据；当所述二次匹配数据满足预设的判定要求时，得到原始病历数据集。3.根据权利要求2所述的基于区块链的电子病历分布式共享方法，其特征在于，对每个所述节点所对应的电子病历数据进行一次匹配，得到一次匹配数据，所述一次匹配数据包括文字匹配数据，所述电子病历数据包括病人的基本信息、诊断信息以及住院信息的文字记录，包括：将所述病人的基本信息、所述诊断信息以及所述住院信息的文字记录构建为输入数据；将所述输入数据输入至预设的语义相似度模型中，所述语义相似度模型根据所述输入数据进行计算，输出相似度结果；当所述相似度结果大于预设文字数据阈值时，得到文字匹配数据。4.根据权利要求3所述的基于区块链的电子病历分布式共享方法，其特征在于，将所述输入数据输入至预设的语义相似度模型中，其中所述语义相似度模型为：；上式中，表示相似度结果，/＞输入数据所对应的向量，/＞表示预设的标准数据库所对应的向量，/＞表示输入数据的向量模长，/＞表示预设的标准数据库所对应的向量模长。5.根据权利要求2所述的基于区块链的电子病历分布式共享方法，其特征在于，当所述二次匹配数据满足预设的判定要求时，得到原始病历数据集，包括：将所述二次匹配数据通过预设的安全散列算法进行数据提取，得到原始病历摘要；对所述原始病历摘要调用所述智能合约模型对区块链各区块体所对应的原始病历存储摘要进行对照；当所述原始病历摘要与所有区块体所对应的原始病历存储摘要均不一致时，保留所述电子病历数据为原始病历数据。6.根据权利要求1所述的基于区块链的电子病历分布式共享方法，其特征在于，将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链，当上链成功后返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中，包括：将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行打包，得到待上链的病历信息；对所述待上链的病历信息中的所述操作信息和所述病历索引信息进行验证；当所述操作信息和所述病历索引信息满足预设的验证条件时，对所述待上链的病历信息进行上链，在上链过程中依次进行签名、验证签名、区块打包、区块广播，所述签名用于将待上链的病历信息封装于区块中形成分布式数字账本；当所述待上链的病历信息上链成功后，返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。7.根据权利要求6所述的基于区块链的电子病历分布式共享方法，其特征在于，当区块链中增加新的区块时，各节点对所述文件存储信息中的本地脱敏库进行同步更新，包括：获取新区块所对应的块体数值序列；将所述新区块所对应的块体数值序列与预设的标识符进行比对；当所述新区块所对应的块体数值序列与预设的标识符一致时，根据预设的解析模型对所述新区块所对应的块体数值序列进行解析，得到解析信息，所述解析信息包括解析的操作信息、解析的病历索引信息、解析的原始病历摘要和解析的脱敏病历摘要；将所述解析的操作信息与操作发起节点ID进行一致性判断。8.根据权利要求7所述的基于区块链的电子病历分布式共享方法，其特征在于，将所述解析的操作信息与操作发起节点ID进行一致性判断，当所述解析的操作信息中的ID与操作发起节点ID不一致时，对本地脱敏库进行同步更新，包括：根据所述解析的操作信息从对应的ID节点下载脱敏文件；根据所述脱敏文件进行脱敏摘要计算，得到脱敏摘要信息；将所述脱敏摘要信息与区块链中已存储的脱敏病历摘要进行比对；当所述脱敏摘要信息与区块链中已存储的脱敏病历摘要一致时，将所述脱敏文件存入本地脱敏库，并设置相同的索引地址。9.一种基于区块链的电子病历分布式共享装置，其特征在于，包括：获取模块，用于获取每个节点所对应的电子病历数据、操作信息和病历索引信息；第一处理模块，用于对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行判定，当所述电子病历数据满足预设的判定要求时，得到原始病历数据集；第二处理模块，用于对所述原始病历数据集进行分类计算，得到原始病历摘要和脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要；第三处理模块，用于对所述电子病历数据提取描述信息，得到病历描述数据集；第四处理模块，用于将所述脱敏病历文件和所述病历描述数据集进行存储，得到文件存储信息，并返回文件存储信息的索引地址；第五处理模块，用于将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链，当上链成功后返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。10.根据权利要求9所述的基于区块链的电子病历分布式共享装置，其特征在于，所述第一处理模块包括：第一匹配单元，用于对每个所述节点所对应的电子病历数据进行一次匹配，得到一次匹配数据，所述一次匹配数据用于对所述电子病历数据进行完整性检查；第二匹配单元，用于对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行二次匹配，得到二次匹配数据，所述二次匹配数据为智能合约模型中的约定编码协议所匹配输出的数据；判定单元，用于当所述二次匹配数据满足预设的判定要求时，得到原始病历数据集。
说明书desc
技术领域本发明涉及电子病历的共享领域，具体而言，涉及一种基于区块链的电子病历分布式共享方法及装置。背景技术在现有技术中，电子病历是指以计算机数据方式记录的病人病情诊断信息与治疗信息。相比于传统的纸质病历，电子病历更便于管理与共享。由于医疗信息的敏感性，电子病历如被篡改或泄露，将会对病人产生严重影响；此外，电子病历存在极大的研究价值，基于电子病历的医学大数据分析是当前的热点研究方向。因此电子病历的安全存储、便捷管理与可靠分享是智慧医疗的基础之一。但当前电子病历一方面存储安全性较差，对于病人的隐私保护普遍不足，存在泄露风险；另一方面，既有电子病历的共享方法都以单个医疗机构为中心，存在信息壁垒，数据共享困难。因此，亟需一种电子病历分布式共享方法，一方面需保证电子病历数据的存储安全，加强对病人的隐私保护，另一方面需加强电子病历数据的共享性。发明内容本发明的目的在于提供一种基于区块链的电子病历分布式共享方法及装置，以改善上述问题。为了实现上述目的，本发明采取的技术方案如下：第一方面，本申请提供了一种基于区块链的电子病历分布式共享方法，所述方法包括：获取每个节点所对应的电子病历数据、操作信息和病历索引信息；对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行判定，当所述电子病历数据满足预设的判定要求时，得到原始病历数据集；对所述原始病历数据集进行分类计算，得到原始病历摘要和脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要；对所述电子病历数据提取描述信息，得到病历描述数据集；将所述脱敏病历文件和所述病历描述数据集进行存储，得到文件存储信息，并返回文件存储信息的索引地址；将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链，当上链成功后返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。第二方面，本申请还提供了一种基于区块链的电子病历分布式共享装置，所述装置包括：获取模块，用于获取每个节点所对应的电子病历数据、操作信息和病历索引信息；第一处理模块，用于对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行判定，当所述电子病历数据满足预设的判定要求时，得到原始病历数据集；第二处理模块，用于对所述原始病历数据集进行分类计算，得到原始病历摘要和脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要；第三处理模块，用于对所述电子病历数据提取描述信息，得到病历描述数据集；第四处理模块，用于将所述脱敏病历文件和所述病历描述数据集进行存储，得到文件存储信息，并返回文件存储信息的索引地址；第五处理模块，用于将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链，当上链成功后返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。本发明的有益效果为：本发明提出了一种基于区块链的电子病历分布式共享方法，应用安全散列算法提取原始病历数据集中的摘要信息，并存入区块链，杜绝了原始病历数据被篡改的风险，保证了数据的安全性与透明性；本方法应用脱敏算法从原始病历数据集生成脱敏数据集，并将脱敏数据集中的脱敏病历文件和电子病历数据所对应的病历描述数据集进行存储，得到文件存储信息，其中本方法将所述病历描述数据集存储在原始库中，将所述脱敏病历文件存储在脱敏库内，所述脱敏库在所有节点同步，所述原始库只存于生成节点，该方法既发挥了电子病历的研究价值，同时也降低了隐私信息的泄漏风险；最后，在本方法中共享中心由接入互联网的共享节点构成，各共享节点间通过区块链实现同步与防篡改功能，提高了电子病历数据的共享性。本发明的其他特征和优点将在随后的说明书阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明实施例了解。本发明的目的和其他优点可通过在所写的说明书、权利要求书、以及附图中所特别指出的结构来实现和获得。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1为本发明实施例中所述的基于区块链的电子病历分布式共享方法流程示意图;图2为本发明实施例中区块头和区块体的结构示意图；图3为本发明实施例中各共享节点接入互联网区块链的结构示意图；图4为本发明实施例中所述的基于区块链的电子病历分布式共享装置结构示意图；图5为本发明实施例中所述的基于区块链的电子病历分布式共享设备结构示意图；图中标记：1、获取模块；2、第一处理模块；3、第二处理模块；4、第三处理模块；5、第四处理模块；6、第五处理模块；800、基于区块链的电子病历分布式共享设备；801、处理器；802、存储器；803、多媒体组件；804、I/O接口；805、通信组件。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。通常在此处附图中描述和示出的本发明实施例的组件可以以各种不同的配置来布置和设计。因此，以下对在附图中提供的本发明的实施例的详细描述并非旨在限制要求保护的本发明的范围，而是仅仅表示本发明的选定实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。应注意到：相似的标号和字母在下面的附图中表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中不需要对其进行进一步定义和解释。同时，在本发明的描述中，术语“第一”、“第二”等仅用于区分描述，而不能理解为指示或暗示相对重要性。实施例1：本实施例提供了一种基于区块链的电子病历分布式共享方法。参见图1，图中示出了本方法包括步骤S1至S6，包括：S1:获取每个节点所对应的电子病历数据、操作信息和病历索引信息；在步骤S1中，电子病历数据的获取可以为：根据所属医院HIS系统或EMRS系统推送的数据内容进行获取。所述电子病历数据包括病人的基本信息、诊断信息、住院信息以及相关影像资料。所述操作信息包括操作标识符、操作类型以及操作发起方节点的ID信息。其中，所述操作标识符是一串固定长度及固定内容的数值序列，表示当前系统所记录的病历处理信息。所述操作类型包括新增、删除与更新等。分布式共享系统由若干个共享节点构成，每个节点都由互不相同的ID信息进行区分，以明确不同操作发起方。在本申请中，所述操作标识符可占用14位，所述操作类型可占用2位，所述操作发起方节点的ID信息可占用20位。所述病历索引信息为固定长度的数值序列，后期根据所述病历索引信息可从分布式共享系统中任一节点下载对应的脱敏病历文件，也可在通过身份认证后从生成该病历的节点下载对应的电子病历数据。本方法中的病历索引信息包括节点ID与文件序号，其中所述节点ID对应为该病历生成方的节点，文件序号也由该节点给出，可约定文件序号为由0开始的递增序列。本方法索引长度设定为220，其中节点ID占20位，文件序号占200位。S2:对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行判定，当所述电子病历数据满足预设的判定要求时，得到原始病历数据集；在步骤S2中包括步骤S21和步骤S23，具体有：S21:对每个所述节点所对应的电子病历数据进行一次匹配，得到一次匹配数据，所述一次匹配数据用于对所述电子病历数据进行完整性检查；在步骤S21中，由于电子病历数据包括病人的基本信息、诊断信息、住院信息以及相关影像资料，因此一次匹配采用文字识别算法和图像识别算法，所述一次匹配数据包括文字匹配数据和图像匹配数据。在本方法中，所述文字识别算法采用语义相似度模型，所述图像识别算法采用视觉目标检测算法。具体有：针对病人的基本信息、诊断信息以及住院信息的文字记录根据语义相似度模型进行数据匹配时，所述一次匹配数据包括文字匹配数据，所述电子病历数据包括病人的基本信息、诊断信息以及住院信息的文字记录，步骤S21包括步骤S211至步骤S213:S211:将所述病人的基本信息、所述诊断信息以及所述住院信息的文字记录构建为输入数据；S212:将所述输入数据输入至预设的语义相似度模型中，所述语义相似度模型根据所述输入数据进行计算，输出相似度结果；在步骤S212中，所述语义相似度模型为：;上式中，表示相似度结果，/＞输入数据所对应的向量，/＞表示预设的标准数据库所对应的向量，/＞表示输入数据的向量模长，/＞表示预设的标准数据库所对应的向量模长。S213:当所述相似度结果大于预设文字数据阈值时，得到文字匹配数据。步骤S213中，预设文字数据阈值为病人的基本信息、诊断信息以及住院信息的文字记录均存在数据时所设定的目标值。针对电子病历数据中的相关影像资料：将所述电子病历数据中的相关影像资料输入至视觉目标检测算法中，视觉目标检测算法输出识别结果，若识别结果中包含各个影像资料的识别标签，则表明当前相关影像资料完整；若识别结果中缺失部分标签，则表明当前相关影像资料不完整。当相关影像资料完整时，保存为图像匹配数据。当系统接收到文字匹配数据和图像匹配数据时，则表明所述电子病历数据完成了完整性检查。当系统缺少文字匹配数据、图像匹配数据时，则表明电子病历数据不完整，需舍弃该电子病历数据。S22:对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行二次匹配，得到二次匹配数据，所述二次匹配数据为智能合约模型中的约定编码协议所匹配输出的数据；在步骤S22中，当电子病历数据通过一次匹配后，对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行二次匹配，其中预设的智能合约模型存储有合约，所述合约包括约定编码协议，以判别医院HIS/EMRS系统输入的电子病历数据是否合格以及电子病历数字的处理结果是否能入链。S23:当所述二次匹配数据满足预设的判定要求时，得到原始病历数据集；在步骤S23中，包括步骤S231至步骤S233，具体有：S231:将所述二次匹配数据通过预设的安全散列算法进行数据提取，得到原始病历摘要；其中，预设的安全散列算法以较短的信息作为原始文件的唯一性标志，这种标志与文件的每一个字节都相关，本步骤采用的安全散列算法为SHA256算法，每个二次匹配数据提取256位哈希值，基于区块链的防篡改特性，通过提取二次匹配数据可保证病历数据的完整性。S232:对所述原始病历摘要调用所述智能合约模型对区块链各区块体所对应的原始病历存储摘要进行对照；S233:当所述原始病历摘要与所有区块体所对应的原始病历存储摘要均不一致时，保留所述电子病历数据为原始病历数据。在步骤S233中，当所述原始病历摘要与所有区块体所对应的原始病历存储摘要均不一致时，则表明当前电子病历数据不存在已重复上链的情况。S3:对所述原始病历数据集进行分类计算，得到原始病历摘要和脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要；在本方法中，为明确分类计算的具体内容，步骤S3包括步骤S31至步骤S32，具体有：S31:对所述原始病历数据集进行摘要计算，得到原始病历摘要；本步骤进行摘要计算时与步骤S231中的算法相同，即对所述原始病历数据集采用安全散列算法为SHA256算法，以得到原始病历摘要。S32:对所述原始病历数据集进行脱敏计算，得到脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要。在步骤S32中，在进行脱敏计算时采用现有的脱敏算法，以对原始病历数据集中的隐私与敏感信息进行处理，生成脱敏病历文件，其中隐私与敏感信息包括姓名、身份证号、电话号码与家庭住址等；在得到脱敏病历文件后，对所述脱敏病历文件采用安全散列算法为SHA256算法，以得到脱敏病历摘要。上述脱敏数据集，一方面既保留了对患者治疗的有用信息，另一方面又防止了患者隐私信息的泄漏。S4:对所述电子病历数据提取描述信息，得到病历描述数据集；在步骤S4中，对所述电子病历数据中的疾病类型、医疗机构以及采集时间进行关键词提取，以得到病历描述数据集。S5:将所述脱敏病历文件和所述病历描述数据集进行存储，得到文件存储信息，并返回文件存储信息的索引地址；在步骤S5中，所述文件存储信息包括原始库和脱敏库，本方法将所述病历描述数据集存储在所述原始库中，将所述脱敏病历文件存储在所述脱敏库内，并分别返回各自存储信息的索引地址。其中：原始库的作用是实现原始电子病历数据的高速存取与冗余保护，且原始库只保存当前节点生成的原始电子病历数据。脱敏库的作用是实现对所述脱敏病历文件的高速存取与冗余保护，且脱敏库保存当前网络所有节点生成的脱敏病历文件。此外，文件存储信息还提供所有电子病历数据的访问列表信息，以为合法用户提供电子病历数据的下载服务。S6:将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链，当上链成功后返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。为明确将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链的具体过程，步骤S6包括步骤S611至S614，具体有：S611:将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行打包，得到待上链的病历信息；S612:对所述待上链的病历信息中的所述操作信息和所述病历索引信息进行验证；在步骤S612中，对所述操作信息进行标识符验证，以验证其是否符合预设的约定规则；对所述病历索引信息进行节点ID数值与当前节点数值的一致性验证。S613:当所述操作信息和所述病历索引信息满足预设的验证条件时，对所述待上链的病历信息进行上链，在上链过程中依次进行签名、验证签名、区块打包、区块广播，所述签名用于将待上链的病历信息封装于区块中形成分布式数字账本；在步骤S613中，预设的验证条件为：当所述操作信息中的标识符满足预设的约定规则，且所述病历索引信息的节点ID数值与当前节点数值的一致时，对所述待上链的病历信息进行上链。如图2所示，区块链的每个区块都是由区块头与区块体组成，区块头含有连接上一区块的哈希值，区块体用于存储相关信息，本方法并不在区块链上直接存储原始病历数据集，而是将操作信息、病历索引信息、脱敏病历摘要与原始病历摘要进行存储，以此实现各节点的病历文件同步及防篡改功能。在上链过程中依次进行签名、验证签名、区块打包、区块广播，其中，在签名过程中，首先将待上链的病历信息通过密码学签名得到签名处理信息，之后将签名处理信息封装于区块中形成分布式数字账本；在验证签名完成后，将签名处理信息记录于区块链的下一待入链区块中，最后经过验证和共识算法选择，被选中的待入链区块作为新区块入链。S614:当所述待上链的病历信息上链成功后，返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。如图3所示，本分布式共享方法由若干共享节点构成，各共享节点接入互联网，通过区块链实现电子病历数据的同步与防篡改。为最大限度发挥电子病历数据的研究价值，同时降低隐私信息的泄漏风险，当区块链中增加新的区块时，各节点对所述文件存储信息中的本地脱敏库进行同步更新，步骤S6还包括步骤S621至S624，具体有：S621:获取新区块所对应的块体数值序列；S622:将所述新区块所对应的块体数值序列与预设的标识符进行比对；在步骤S622中，可重点比对块体数值序列的起始部分与预设的标识符是否一致。在本步骤中，预设的标识符占用14位，需比较前14位是否完全一致。S623:当所述新区块所对应的块体数值序列与预设的标识符一致时，根据预设的解析模型对所述新区块所对应的块体数值序列进行解析，得到解析信息，所述解析信息包括解析的操作信息、解析的病历索引信息、解析的原始病历摘要和解析的脱敏病历摘要；在步骤S623中，预设的解析模型为对各节点的智能合约模型按编码规则对块体数值序列进行解析后创建。S624:将所述解析的操作信息与操作发起节点ID进行一致性判断。在步骤S624中，将所述解析的操作信息与操作发起节点ID进行一致性判断，当所述解析的操作信息中的ID与操作发起节点ID不一致时，对本地脱敏库进行同步更新，其包括步骤S6241至S6244，具体有：S6241:根据所述解析的操作信息从对应的ID节点下载脱敏文件；S6242:根据所述脱敏文件进行脱敏摘要计算，得到脱敏摘要信息；在步骤S6242中进行脱敏摘要计算时，其与步骤S231中的算法相同，即对所述脱敏文件采用安全散列算法为SHA256算法，以得到脱敏摘要信息。S6243:将所述脱敏摘要信息与区块链中已存储的脱敏病历摘要进行比对；S6244: 当所述脱敏摘要信息与区块链中已存储的脱敏病历摘要一致时，将所述脱敏文件存入本地脱敏库，并设置相同的索引地址。对于删除操作：当前操作发起节点ID根据解析的病历索引信息，将对应的电子病历数据置为无效状态，并从脱敏库中删除对应的脱敏病历文件。在本方法中，用户通过Web浏览器或专用软件接入任一节点，查找所需的电子病历数据，并下载相应病历文件。对于医学研究类应用场景，用户可通过任一节点访问并下载全部脱敏病历文件；对于多方会诊或跨院就诊等应用场景，用户在通过病历生成节点的身份验证后，可从生成节点下载原始电子病历数据。实施例2：如图4所示，本实施例提供了一种基于区块链的电子病历分布式共享装置，所述装置包括：获取模块1，用于获取每个节点所对应的电子病历数据、操作信息和病历索引信息；第一处理模块2，用于对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行判定，当所述电子病历数据满足预设的判定要求时，得到原始病历数据集；第二处理模块3，用于对所述原始病历数据集进行分类计算，得到原始病历摘要和脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要；第三处理模块4，用于对所述电子病历数据提取描述信息，得到病历描述数据集；第四处理模块5，用于将所述脱敏病历文件和所述病历描述数据集进行存储，得到文件存储信息，并返回文件存储信息的索引地址；第五处理模块6，用于将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行上链，当上链成功后返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。在本发明所公开的一种实施方法中，所述第一处理模块2包括：第一匹配单元，用于对每个所述节点所对应的电子病历数据进行一次匹配，得到一次匹配数据，所述一次匹配数据用于对所述电子病历数据进行完整性检查；第二匹配单元，用于对每个所述节点所对应的电子病历数据通过预设的智能合约模型进行二次匹配，得到二次匹配数据，所述二次匹配数据为智能合约模型中的约定编码协议所匹配输出的数据；判定单元，用于当所述二次匹配数据满足预设的判定要求时，得到原始病历数据集；在本发明所公开的一种实施方法中，所述判定单元包括：提取单元，用于将所述二次匹配数据通过预设的安全散列算法进行数据提取，得到原始病历摘要；对照单元，用于对所述原始病历摘要调用所述智能合约模型对区块链各区块体所对应的原始病历存储摘要进行对照；保留单元，用于当所述原始病历摘要与所有区块体所对应的原始病历存储摘要均不一致时，保留所述电子病历数据为原始病历数据。在本发明所公开的一种实施方法中，所述第二处理模块3包括：第一计算单元，用于对所述原始病历数据集进行摘要计算，得到原始病历摘要；第二计算单元，用于对所述原始病历数据集进行脱敏计算，得到脱敏数据集，所述脱敏数据集包括脱敏病历文件和脱敏病历摘要。在本发明所公开的一种实施方法中，所述第五处理模块6包括上链模块，所述上链模块包括：第一处理单元，用于将所述操作信息、所述病历索引信息、所述原始病历摘要以及所述脱敏病历摘要进行打包，得到待上链的病历信息；第二处理单元，用于对所述待上链的病历信息中的所述操作信息和所述病历索引信息进行验证；第三处理单元，用于当所述操作信息和所述病历索引信息满足预设的验证条件时，对所述待上链的病历信息进行上链，在上链过程中依次进行签名、验证签名、区块打包、区块广播，所述签名用于将待上链的病历信息封装于区块中形成分布式数字账本；第四处理单元，用于当所述待上链的病历信息上链成功后，返回对应新增的区块哈希值，并根据所述病历索引信息存储至本地磁盘阵列中。在本发明所公开的一种实施方法中，所述第五处理模块6还包括同步模块，当区块链中增加新的区块时，各节点对所述文件存储信息中的本地脱敏库进行同步更新，所述同步模块包括：获取单元，用于获取新区块所对应的块体数值序列；第五处理单元，用于将所述新区块所对应的块体数值序列与预设的标识符进行比对；第六处理单元，用于当所述新区块所对应的块体数值序列与预设的标识符一致时，根据预设的解析模型对所述新区块所对应的块体数值序列进行解析，得到解析信息，所述解析信息包括解析的操作信息、解析的病历索引信息、解析的原始病历摘要和解析的脱敏病历摘要；第七处理单元，将所述解析的操作信息与操作发起节点ID进行一致性判断。在本发明所公开的一种实施方法中，将所述解析的操作信息与操作发起节点ID进行一致性判断，当所述解析的操作信息中的ID与操作发起节点ID不一致时，对本地脱敏库进行同步更新，所述第七处理单元包括：第一子处理单元，用于根据所述解析的操作信息从对应的ID节点下载脱敏文件；第二子处理单元，用于根据所述脱敏文件进行脱敏摘要计算，得到脱敏摘要信息；第三子处理单元，用于将所述脱敏摘要信息与区块链中已存储的脱敏病历摘要进行比对；第四子处理单元，用于当所述脱敏摘要信息与区块链中已存储的脱敏病历摘要一致时，将所述脱敏文件存入本地脱敏库，并设置相同的索引地址。实施例3：相应于上面的方法实施例，本实施例中还提供了一种基于区块链的电子病历分布式共享设备，下文描述的一种基于区块链的电子病历分布式共享设备与上文描述的一种基于区块链的电子病历分布式共享方法可相互对应参照。图5是根据示例性实施例示出的一种基于区块链的电子病历分布式共享设备800的框图。如图5所示，该基于区块链的电子病历分布式共享设备800可以包括：处理器801，存储器802。该基于区块链的电子病历分布式共享设备800还可以包括多媒体组件803，I/O接口804，以及通信组件805中的一者或多者。其中，处理器801用于控制该基于区块链的电子病历分布式共享设备800的整体操作，以完成上述的基于区块链的电子病历分布式共享方法中的全部或部分步骤。存储器802用于存储各种类型的数据以支持在该基于区块链的电子病历分布式共享设备800的操作，这些数据例如可以包括用于在该基于区块链的电子病历分布式共享设备800上操作的任何应用程序或方法的指令，以及应用程序相关的数据，例如联系人数据、收发的消息、图片、音频、视频等等。该存储器802可以由任何类型的易失性或非易失性存储设备或者它们的组合实现，例如静态随机存取存储器，电可擦除可编程只读存储器，可擦除可编程只读存储器，可编程只读存储器，只读存储器，磁存储器，快闪存储器，磁盘或光盘。多媒体组件803可以包括屏幕和音频组件。其中屏幕例如可以是触摸屏，音频组件用于输出和/或输入音频信号。例如，音频组件可以包括一个麦克风，麦克风用于接收外部音频信号。所接收的音频信号可以被进一步存储在存储器802或通过通信组件805发送。音频组件还包括至少一个扬声器，用于输出音频信号。I/O接口804为处理器801和其他接口模块之间提供接口，上述其他接口模块可以是键盘，鼠标，按钮等。这些按钮可以是虚拟按钮或者实体按钮。通信组件805用于该基于区块链的电子病历分布式共享设备800与其他设备之间进行有线或无线通信。无线通信，例如Wi-Fi，蓝牙，近场通信，2G、3G或4G，或它们中的一种或几种的组合，因此相应的该通信组件805可以包括：Wi-Fi模块，蓝牙模块，NFC模块。在一示例性实施例中，基于区块链的电子病历分布式共享设备800可以被一个或多个应用专用集成电路、数字信号处理器、数字信号处理设备、可编程逻辑器件、现场可编程门阵列、控制器、微控制器、微处理器或其他电子元件实现，用于执行上述的基于区块链的电子病历分布式共享方法。在另一示例性实施例中，还提供了一种包括程序指令的计算机可读存储介质，该程序指令被处理器执行时实现上述的基于区块链的电子病历分布式共享方法的步骤。例如，该计算机可读存储介质可以为上述包括程序指令的存储器802，上述程序指令可由基于区块链的电子病历分布式共享设备800的处理器801执行以完成上述的基于区块链的电子病历分布式共享方法。实施例4：相应于上面的方法实施例，本实施例中还提供了一种可读存储介质，下文描述的一种可读存储介质与上文描述的一种基于区块链的电子病历分布式共享方法可相互对应参照。一种可读存储介质，可读存储介质上存储有计算机程序，计算机程序被处理器执行时实现上述方法实施例的基于区块链的电子病历分布式共享方法的步骤。该可读存储介质具体可以为U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可存储程序代码的可读存储介质。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以权利要求的保护范围为准。
