标题title
一种低延迟的无线网络短信视频传输方法
摘要abst
本发明涉及视频传输技术领域，具体涉及一种低延迟的无线网络短信视频传输方法，该方法包括：采集短信传输视频在各通道下的视频数据；获取视频数据中每帧图像的各预测区域；根据匹配区域链条中相邻预测区域之间的光流稠密效果获取每个预测区域与后一个预测区域之间的匹配区域链条匹配度；结合帧内残差尺度、帧间残差尺度以及匹配区域链条匹配度，获取各预测区域的分割积累量；基于各预测区域的分割积累量实现预测块划分，优化H.264视频压缩算法。本发明提高了无线网络短信视频传输的压缩效果，加快压缩效率。
权利要求书clms
1.一种低延迟的无线网络短信视频传输方法，其特征在于，该方法包括以下步骤：采集短信传输视频并进行处理，得到各通道下的视频数据；采用视频压缩算法对各通道下视频数据的每帧图像进行区域划分，得到每帧图像的各预测区域；基于Lucas-Kanade算法获取每帧图像与后一帧图像中的预测区域匹配对；针对每帧图像与后一帧图像中的预测区域匹配对，构建各通道下视频数据的匹配区域链条；对于各通道下视频数据的各条匹配区域链条，根据匹配区域链条中相邻预测区域之间的光流稠密效果，获取匹配区域链条中每个预测区域与后一个预测区域之间的匹配区域链条匹配度；获取匹配区域链条中各预测区域的帧内残差尺度，各预测区域与后一个预测区域之间的帧间残差尺度；结合帧内残差尺度以及帧间残差尺度构建匹配区域链条中各预测区域与后一个预测区域之间的残差积累项；将匹配区域链条各预测区域以及之前所有预测区域组成各预测区域的预测区域链条；根据预测区域链条内相邻预测区域之间的残差累计项以及匹配区域链条匹配度，获取各预测区域的分割积累量；基于各预测区域的分割积累量实现预测块划分，优化H.264视频压缩算法。2.如权利要求1所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述采集短信传输视频并进行处理，得到各通道下的视频数据，包括：将采集的短信传输视频中每帧图像，按照R、G、B三种通道分解为对应通道下的灰度图像；将短信传输视频中各通道下的所有灰度图像组成各通道下的视频数据。3.如权利要求2所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述采用视频压缩算法对各通道下视频数据的每帧图像进行区域划分，得到每帧图像的各预测区域包括：采用H.264视频压缩算法对图像进行帧内预测，获取图像中的区域，记为预测区域。4.如权利要求3所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述基于Lucas-Kanade算法获取每帧图像与后一帧图像中的预测区域匹配对，包括：采用Lucas-Kanade算法获取视频数据中任意相邻两帧图像之间的光流场，所述光流场由光流向量组成，所述光流向量为每帧图像中的起点指向相邻后一帧图像中的终点；将每帧图像中各预测区域的所有光流向量在后一帧图像中的终点最多的预测区域，记为各预测区域的被匹配预测区域；将所述被匹配预测区域由光流向量在前一帧图像中对应的各预测区域中，包含光流向量起点最多的预测区域作为所述被匹配预测区域的匹配预测区域；将每帧图像与后一帧图像中，存在互为匹配、被匹配预测区域关系的预测区域，记为每帧图像与后一帧图像中的预测区域匹配对。5.如权利要求4所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述针对每帧图像与后一帧图像中的预测区域匹配对，构建各通道下视频数据的匹配区域链条，包括：对于各通道下视频数据中的每帧图像，将所有相邻帧图像之间存在交集的预测区域匹配对构成一个集合，将集合中的所有预测区域按照视频数据中帧与帧之间的顺序，组成匹配区域链条。6.如权利要求5所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述根据匹配区域链条中相邻预测区域之间的光流稠密效果，获取匹配区域链条中每个预测区域与后一个预测区域之间的匹配区域链条匹配度，包括：对于匹配区域链条中第p个预测区域，第p个预测区域与后一个预测区域之间的匹配区域链条匹配度的表达式为：式中，是匹配区域链条上第p个预测区域与第p+1个预测区域之间的匹配区域链条匹配度，/＞是以第p个预测区域为起点的光流向量数量，/＞是以第p个预测区域为起点以第p+1个预测区域为终点的光流向量数量，/＞是以第p个预测区域为起点光流向量中终点在第p+1个预测区域之外的光流向量的向量标准差，/＞是以第p个预测区域为起点光流向量中终点在第p+1个预测区域之内的光流向量的向量标准差。7.如权利要求5所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述获取匹配区域链条中各预测区域的帧内残差尺度，各预测区域与后一个预测区域之间的帧间残差尺度，包括：对于匹配区域链条中各预测区域，将各预测区域内所有残差块中所有数据的标准差的均值，作为各预测区域的帧内残差尺度；将各预测区域与后一个预测区域的预测块进行相减，得到各预测区域的帧间残差块；将所述帧间残差块中所有数据的标准差作为各预测区域与后一个预测区域之间的帧间残差尺度。8.如权利要求7所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述结合帧内残差尺度以及帧间残差尺度构建匹配区域链条中各预测区域与后一个预测区域之间的残差积累项，包括：对于匹配区域链条中各预测区域，计算各预测区域与后一个预测区域的帧内残差尺度的差值绝对值；将各预测区域与后一个预测区域之间的帧间残差尺度与所述差值绝对值的和值，作为各预测区域与后一个预测区域之间的残差积累项。9.如权利要求1所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述根据预测区域链条内相邻预测区域之间的残差累计项以及匹配区域链条匹配度，获取各预测区域的分割积累量，表达式为：式中，是第S个预测区域链条的分割积累量，/＞是匹配区域链条中第p个预测区域和第p+1个预测区域之间的残差积累项，/＞是第p个预测区域与第p+1个预测区域之间的匹配区域链条匹配度，/＞、/＞分别是第p个预测区域和第p+1个预测区域的宏块数量，S是选取的预测区域链条中的预测区域数量，P是匹配区域链条中的预测区域总数。10.如权利要求9所述的一种低延迟的无线网络短信视频传输方法，其特征在于，所述基于各预测区域的分割积累量实现预测块划分，优化H.264视频压缩算法，包括：当预测区域的分割积累量大于预设灰度等级差异阈值时，将其之前所有的预测区域作为一个预测区域链条，将其及其之后所有的预测区域作为一个预测区域链条；当不存在预测区域的分割积累量大于预设灰度等级差异阈值时，停止分割。
说明书desc
技术领域本申请涉及视频传输技术领域，具体涉及一种低延迟的无线网络短信视频传输方法。背景技术随着移动通信和互联网技术的快速发展，人们对无线网络短信视频传输的需求不断增加。传统的文本短信已经不能满足人们多样化的沟通需求，因此视频通话、视频短信等新型通信方式逐渐成为人们生活中不可或缺的部分。然而，无线网络环境下的短信视频传输面临着诸多挑战，其中之一就是延迟问题。在无线网络中，数据传输需要经过无线信号传输、路由器处理、传输链路、服务器处理等多个环节，这些环节都会对数据传输产生一定的延迟。特别是对于视频传输，延迟问题更加突出，会导致画面卡顿、声音不同步等问题，影响用户体验。在基于短信的多媒体数据传输过程中，视频数据占用的数据量远远大于其它多媒体数据的数据量，因此为了降低无线网络短信视频传输的延迟，有必要对短信视频进行压缩，减少视频数据占用的数据量，提高传输速度。传统的短信视频传输常采用H.264视频压缩编码进行压缩，但是传统的H.264压缩算法采用的是固定长度的GOP图像组结构，在进行帧间压缩时会导致某些帧间变化较小的宏块位置采用了不同的预测块，使传输的预测块过多，导致压缩效率降低，进而导致短信视频传输出现较大的延迟。发明内容为了解决上述技术问题，本发明提供一种低延迟的无线网络短信视频传输方法，以解决现有的问题。本发明的一种低延迟的无线网络短信视频传输方法采用如下技术方案：本发明一个实施例提供了一种低延迟的无线网络短信视频传输方法，该方法包括以下步骤：采集短信传输视频并进行处理，得到各通道下的视频数据；采用视频压缩算法对各通道下视频数据的每帧图像进行区域划分，得到每帧图像的各预测区域；基于Lucas-Kanade算法获取每帧图像与后一帧图像中的预测区域匹配对；针对每帧图像与后一帧图像中的预测区域匹配对，构建各通道下视频数据的匹配区域链条；对于各通道下视频数据的各条匹配区域链条，根据匹配区域链条中相邻预测区域之间的光流稠密效果，获取匹配区域链条中每个预测区域与后一个预测区域之间的匹配区域链条匹配度；获取匹配区域链条中各预测区域的帧内残差尺度，各预测区域与后一个预测区域之间的帧间残差尺度；结合帧内残差尺度以及帧间残差尺度构建匹配区域链条中各预测区域与后一个预测区域之间的残差积累项；将匹配区域链条各预测区域以及之前所有预测区域组成各预测区域的预测区域链条；根据预测区域链条内相邻预测区域之间的残差累计项以及匹配区域链条匹配度，获取各预测区域的分割积累量；基于各预测区域的分割积累量实现预测块划分，优化H.264视频压缩算法。优选的，所述采集短信传输视频并进行处理，得到各通道下的视频数据，包括：将采集的短信传输视频中每帧图像，按照R、G、B三种通道分解为对应通道下的灰度图像；将短信传输视频中各通道下的所有灰度图像组成各通道下的视频数据。优选的，所述采用视频压缩算法对各通道下视频数据的每帧图像进行区域划分，得到每帧图像的各预测区域包括：采用H.264视频压缩算法对图像进行帧内预测，获取图像中的区域，记为预测区域。优选的，所述基于Lucas-Kanade算法获取每帧图像与后一帧图像中的预测区域匹配对，包括：采用Lucas-Kanade算法获取视频数据中任意相邻两帧图像之间的光流场，所述光流场由光流向量组成，所述光流向量为每帧图像中的起点指向相邻后一帧图像中的终点；将每帧图像中各预测区域的所有光流向量在后一帧图像中的终点最多的预测区域，记为各预测区域的被匹配预测区域；将所述被匹配预测区域由光流向量在前一帧图像中对应的各预测区域中，包含光流向量起点最多的预测区域作为所述被匹配预测区域的匹配预测区域；将每帧图像与后一帧图像中，存在互为匹配、被匹配预测区域关系的预测区域，记为每帧图像与后一帧图像中的预测区域匹配对。优选的，所述针对每帧图像与后一帧图像中的预测区域匹配对，构建各通道下视频数据的匹配区域链条，包括：对于各通道下视频数据中的每帧图像，将所有相邻帧图像之间存在交集的预测区域匹配对构成一个集合，将集合中的所有预测区域按照视频数据中帧与帧之间的顺序，组成匹配区域链条。优选的，所述根据匹配区域链条中相邻预测区域之间的光流稠密效果，获取匹配区域链条中每个预测区域与后一个预测区域之间的匹配区域链条匹配度，包括：对于匹配区域链条中第p个预测区域，第p个预测区域与后一个预测区域之间的匹配区域链条匹配度的表达式为：式中，是匹配区域链条上第p个预测区域与第p+1个预测区域之间的匹配区域链条匹配度，/＞是以第p个预测区域为起点的光流向量数量，/＞是以第p个预测区域为起点以第p+1个预测区域为终点的光流向量数量，/＞是以第p个预测区域为起点光流向量中终点在第p+1个预测区域之外的光流向量的向量标准差，/＞是以第p个预测区域为起点光流向量中终点在第p+1个预测区域之内的光流向量的向量标准差。优选的，所述获取匹配区域链条中各预测区域的帧内残差尺度，各预测区域与后一个预测区域之间的帧间残差尺度，包括：对于匹配区域链条中各预测区域，将各预测区域内所有残差块中所有数据的标准差的均值，作为各预测区域的帧内残差尺度；将各预测区域与后一个预测区域的预测块进行相减，得到各预测区域的帧间残差块；将所述帧间残差块中所有数据的标准差作为各预测区域与后一个预测区域之间的帧间残差尺度。优选的，所述结合帧内残差尺度以及帧间残差尺度构建匹配区域链条中各预测区域与后一个预测区域之间的残差积累项，包括：对于匹配区域链条中各预测区域，计算各预测区域与后一个预测区域的帧内残差尺度的差值绝对值；将各预测区域与后一个预测区域之间的帧间残差尺度与所述差值绝对值的和值，作为各预测区域与后一个预测区域之间的残差积累项。优选的，所述根据预测区域链条内相邻预测区域之间的残差累计项以及匹配区域链条匹配度，获取各预测区域的分割积累量，表达式为：式中，是第S个预测区域链条的分割积累量，/＞是匹配区域链条中第p个预测区域和第p+1个预测区域之间的残差积累项，/＞是第p个预测区域与第p+1个预测区域之间的匹配区域链条匹配度，/＞、/＞分别是第p个预测区域和第p+1个预测区域的宏块数量，S是选取的预测区域链条中的预测区域数量，P是匹配区域链条中的预测区域总数。优选的，所述基于各预测区域的分割积累量实现预测块划分，优化H.264视频压缩算法，包括：当预测区域的分割积累量大于预设灰度等级差异阈值时，将其之前所有的预测区域作为一个预测区域链条，将其及其之后所有的预测区域作为一个预测区域链条；当不存在预测区域的分割积累量大于预设灰度等级差异阈值时，停止分割。本发明至少具有如下有益效果：本发明针对传统的H.264算法中，采用固定长度的GOP图像结构，导致传输的预测块过多、残差块灰度等级差异过大的缺点，将视频数据的匹配区域作为采用同一预测块的匹配区域，减少了预测块的数量，加快了压缩效率。通过计算稠密光流场的算法在两帧图片之间获得光流向量，通过光流向量的表达的图像运动特征，对不同帧之间的预测区域进行了匹配，构建匹配区域链条，完成了帧之间相似预测区域的关联，根据光流向量的在帧与帧之间的分布特征，计算匹配区域链条匹配度，表征相邻帧之间的预测区域匹配效果；进一步根据两个预测区域内部残差块的标准差之差、以及两个预测区域的预测块的残差块的标准差之差，得到残差积累项，表征对两个预测区域使用同一个预测块时，带来的残差块灰度值差异大小；最后以匹配区域链条匹配度为权重，结合预测区域的宏块数量，将残差积累项加权相加，得到匹配区域链条分割积累量，表征将多个预测区域块采用同一个预测块时，导致的残差块灰度值差异大小，借此对匹配区域链条进行分割，得到预测区域链条，并以预测区域链条为单位进行H.264视频编码压缩算法进行压缩，避免直接对匹配区域链条采用同一个预测块，导致的残差块灰度值差异过大，使压缩效果下降的情况。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案和优点，下面将对实施例或现有技术描述中所需要使用的附图作简单的介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它附图。图1为本发明提供的一种低延迟的无线网络短信视频传输方法的步骤流程图；图2为匹配区域链条示意图；图3为视频压缩过程的指标构建流程图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的一种低延迟的无线网络短信视频传输方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的一种低延迟的无线网络短信视频传输方法的具体方案。本发明一个实施例提供的一种低延迟的无线网络短信视频传输方法，具体的，提供了如下的一种低延迟的无线网络短信视频传输方法，请参阅图1，该方法包括以下步骤：步骤S001，采集短信传输视频，并进行处理。获取短信传输的视频，其中的每一帧图像是RGB色彩空间，本实施例进一步对传输的视频中的每一帧按照R、G、B三种通道分解为三张灰度图像，并将所有位于同一色彩通道的灰度图像进行组合，构成各通道下的短信多媒体传输时的视频数据。因此，短信多媒体传输时的视频数据为三段，在进行压缩或加密操作时，会对三段分别进行计算处理。步骤S002，构建匹配区域链条。针对传统H.264视频压缩编码在划分GOP图像组结构时，因为以帧为单位划分GOP图像组结构而产生的压缩效率较低的缺点，本实施例将根据图像与图像之间相似的结构区域划分GOP图像组结构，即传统算法中，一帧图像内的所有像素点会处于同一个GOP图像组结构，而本实施例将一帧图像的不同区域像素点划分到不同的GOP图像组结构当中，使预测块对宏块的预测效果更好，达到更好的H.264视频压缩效率。对于获得的各通道下视频数据的每一帧，将其均匀分割为8×8大小的宏块，并采用传统的H.264视频压缩算法进行帧内预测。最终，将视频中的每一帧图像划分为了多个区域，每一个区域共享一个预测块，其中，第m个区域称为第m个预测区域。对于各预测区域中的每个宏块，宏块与所述区域的预测块的差值为对应宏块的残差块。其中，H.264视频压缩算法为本领域公知技术，本实施例不再赘述。进一步，以视频数据中的任意相邻两帧图像作为输入，采用Lucas-Kanade算法进行计算，输出为两帧图像之间的光流场，若原始视频数据一共有N帧图像，那么得到的光流场图像一共有N-1张。其中，Lucas-Kanade算法为公知技术，本实施例不再赘述。进一步根据光流场的稠密对图像进行匹配，具体为：对第n帧图像的第m个预测区域内光流向量，获取其在第n+1帧中的终点，将第n帧图像第m个预测区域内光流向量终点最多的第n+1帧图像预测区域记为被匹配预测区域。需要说明的是，第n+1帧图像的预测区域可能是第n帧图像中多个预测区域的被匹配预测区域。当出现此种情况时，将第n+1帧图像中的被匹配预测区域记为，将其在第n帧图像中的K个对应匹配预测区域分别记为/＞，获取以/＞为终点的所有光流向量在第n帧图像中的起点，判断包含起点数量最多的匹配预测区域/＞为/＞的匹配预测区域，而除/＞以外的匹配预测区域没有被匹配预测区域。最终，通过前一帧图像的预测区域，可在后一帧图像中找到其对应的被匹配区域，这样帧与帧之间的预测区域构建成了一个匹配区域链条，匹配区域链条上，后一个预测区域是前一个预测区域的被匹配预测区域，前一个预测区域是后一个预测区域的匹配预测区域。如图2所示，黑色方块区域是一系列匹配的预测区域，其中第一个匹配区域在第n+1帧出现，最后一个被匹配区域在第n+6帧出现，由于光流向量的指向，使其构成了一个匹配区域链条。如果对匹配区域链条上的所有预测区域使用同一个预测块进行预测，替代传统的H.264算法采用固定GOP图像组结构使用同一个预测块进行预测的方式，能够有效降低压缩后数据中的残差块标准差与预测块数量，达到更好的H.264压缩效果。步骤S003，计算匹配区域链条匹配度。上述步骤中的匹配区域链条是根据帧与帧之间的图像运动匹配情况构建链条，而通过运动构建的链条无法保证其宏块的相似程度足够大，而要获取好的H.264视频压缩效果，必须保证链条中的每一个宏块有较大的相似程度，因此进一步计算匹配区域链条匹配度，对匹配区域链条进一步分割。以其中视频数据中的其中一条匹配区域链条为例，计算匹配区域链条中第p个预测区域的匹配区域链条匹配度：式中，是匹配区域链条上第p个预测区域与第p+1个预测区域之间的匹配区域链条匹配度，/＞是以第p个预测区域为起点的光流向量数量，/＞是以第p个预测区域为起点以第p+1个预测区域为终点的光流向量数量，/＞是以第p个预测区域为起点光流向量中终点在第p+1个预测区域之外的光流向量的向量标准差，/＞是以第p个预测区域为起点光流向量中终点在第p+1个预测区域之内的光流向量的向量标准差。需要说明的是，光流向量的向量标准差是计算向量长度的标准差，计算向量方向的弧度值标准差，而后两者相乘得到的，值越大代表参与计算的向量越混乱。在公式中，终点在p+1预测区域之内的光流向量是匹配成功的光流向量，其向量标准差越大，代表匹配成功的向量越混乱，预测区域匹配效果越差；终点在p+1预测区域之外的光流向量是匹配失败的光流向量，其向量标准差/＞越大，代表匹配失败的向量越混乱，代表匹配失败的向量约有可能是光流计算时出现错误的向量，越应该忽视该部分向量，对应的预测区域匹配效果越好，除以两者之和是归一化处理； /＞与/＞之比，是第p个预测区域的光流向量落入第p+1个预测区域的比例，比值越大代表匹配效果越好。最终获得匹配区域链条匹配度，值越大代表通过光流场计算获得的匹配区域链条的匹配效果越好。需要说明的是，由于是成功匹配的光流向量标准差，而/＞计算不成功匹配的光流向量标准差，通常后者的向量几何比前者混乱，两者之差通过为正数，当两者差为负数时，认为通过光流向量得到的匹配结果出现错误，在匹配区域链条的第p个预测区域和第p+1个预测区域截断，分为两个匹配区域链条。步骤S004，计算匹配区域链条分割积累量，压缩短信视频。首先，计算第p个预测区域的帧内残差尺度：先计算第p个预测区域的每一个残差块中所有数据的标准差，而后对所有残差块的标准差求均值得到的。帧内残差尺度表征了第p个预测区域的预测块对每个宏块的预测效果，值越大预测效果越差。帧间残差尺度是通过第p个预测区域的预测块和第p+1个区域的预测块之间相减得到帧间残差块，而后对帧间残差块中所有数据计算标准差得到的，值越大代表通过匹配区域链条进行帧间预测的效果越差。进一步，计算匹配区域链条中第p个预测区域与后一个预测区域之间的残差积累项：式中，是匹配区域链条中第p个预测区域和第p+1个预测区域之间的残差积累项，/＞、/＞分别是第p个预测区域和第p+1个预测区域的帧内残差尺度，/＞是第p个预测区域和第p+1个预测区域之间的帧间残差尺度。式中，两个预测区域之间的帧内残差尺度差异越大，或者帧间残差尺度越大，代表两个预测区域中的宏块互相进行预测的效果越差，对应的匹配区域链条中，对第p个预测区域和第p+1个预测区域使用同一个预测块时，对第p+1个预测区域的预测效果越差，对应的越应该将匹配区域链条中第p个预测区域和第p+1个预测区域截开，使残差块的灰度等级差异减小，获得更好的压缩效果。本实施例通过将匹配区域链条中前S个预测区域组成预测区域链条，针对预测区域链条，计算匹配区域链条中各预测区域链条的分割积累量：式中，是第S个预测区域链条的分割积累量，/＞是匹配区域链条中第p个预测区域和第p+1个预测区域之间的残差积累项，/＞是第p个预测区域与第p+1个预测区域之间的匹配区域链条匹配度，/＞、/＞分别是第p个预测区域和第p+1个预测区域的宏块数量，S是选取的预测区域链条中的预测区域数量，P是匹配区域链条中的预测区域总数。需要说明的是，将匹配区域链条从第一个预测区域开始，不断增加预测区域，构建预测区域链条，试图对预测区域链条采用同一个预测块，减少预测块数量的同时，减少残差块的灰度等级差异，得到更好的压缩效果；作为残差积累项，随着预测区域链条的增加，其使匹配区域链条分割积累量/＞变大，代表对预测区域链条使用同一个预测块时，残差块的灰度等级差异可能会越来越大，因此当匹配区域链条分割积累量/＞达到一定阈值时，应该对将匹配区域链条进行切割，防止最终压缩时残差块的灰度等级差异过大。匹配区域链条匹配度和连续两个预测区域的宏块数量之差都是残差积累项的权重。当匹配区域链条匹配度大时，在预测区域链条后加上的预测区域与前一个预测区域的匹配效果越好，对应的残差积累项的累计值应给减少，因此以匹配区域链条匹配度的导数作为权重，对残差积累项进行累加；连续两个预测区域的宏块数量之差同样代表了两个预测区域的匹配程度，差值越小匹配程度越好，对应的残差积累项就小。其中，得到匹配区域链条分割积累量，其值越大，越应该停止在当前的预测区域链条上增加新的预测区域。本实施例设置预设灰度等级差异阈值G，取值G=16，其值代表了参数设置者希望压缩后得到的残差块的最大灰度值为16。当/＞时，在匹配区域链条的第S和S-1个预测区域之间设置断点，将前S-1个预测区域作为一个预测区域链条；同时将第S个预测区域作为新的预测区域链条的第一个预测区域，继续对匹配区域链条进行分割。最终，根据匹配区域链条分割积累量将短信多媒体传输时的视频数据的所有预测块都进行了划分，划分为了多个预测区域链条。进一步，对预测区域链条中的宏块采用相同的预测块，使用H.264视频压缩编码进行压缩，H.264视频压缩算法为本领域公知技术不再赘述，其中，视频压缩过程的指标构建流程图如图3所示。至此，本实施例完成对短信多媒体传输时的视频数据的压缩。需要说明的是：上述本发明实施例先后顺序仅仅为了描述，不代表实施例的优劣。且上述对本说明书特定实施例进行了描述。另外，在附图中描绘的过程不一定要求示出的特定顺序或者连续顺序才能实现期望的结果。在某些实施方式中，多任务处理和并行处理也是可以的或者可能是有利的。本说明书中的各个实施例均采用递进的方式描述，各个实施例之间相同或相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。以上所述实施例仅用以说明本申请的技术方案，而非对其限制；对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的范围，均应包含在本申请的保护范围之内。
