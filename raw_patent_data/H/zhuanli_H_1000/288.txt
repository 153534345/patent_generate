标题title
一种基于聚簇的车联网信任管理方法
摘要abst
本发明属于车联网网络安全领域，公开了一种基于聚簇的车联网信任管理方法。包括一种基于簇结构的分层式信任管理模型和基于权重的多属性分簇算法，簇结构通过基于权重的多属性分簇算法生成；本发明通过在簇结构的基础上设计相应的信任管理方案，兼顾节点区域性的局部信任和网络整体的全局信任，能有效提升信任管理的有效性。同时，本发明综合考虑多种属性对簇结构的影响，设计了新的基于权重的多属性分簇算法，构建稳定可靠的簇结构，给信任管理方案的稳定运行提供了基础。
权利要求书clms
1.一种基于聚簇的车联网信任管理方法，其特征在于，包括基于簇结构的分层式信任管理模型和基于权重的多属性分簇算法；所述基于簇结构的分层式信任管理模型，以簇结构为基础，根据车联网实体角色的不同，将车联网实体划分为不同的信任管理层次；各信任管理层次的车联网实体在基于簇结构的分层式信任管理模型中承担不同的信任管理功能，通过各信任管理层次间的相互合作，完成整个车联网的信任管理；所述基于簇结构的分层式信任管理模型分为两个部分，分别为云端中心和道路系统；所述云端中心为可信的中央机构，负责完成整个车联网的管理，进行证书处理、全局信任管理和恶意节点处理；所述道路系统包括独立簇结构的车辆集群和沿道路部署的路侧单元RSU，车辆节点根据在簇结构内的不同角色，被划分为簇头节点或簇成员节点；所述簇成员节点对其他簇成员节点的运行状况进行监测，根据簇成员节点间的直接交互历史以及邻居节点的推荐信息评估其他簇成员节点的信任度，并将信任度信息上报到簇头节点；所述簇头节点维护当前簇结构的局部信任信息，根据簇成员节点上报的信任度信息进行综合计算，管理当前簇结构中各簇成员节点的局部信任值，并上报到云端中心，辅助完成全局信任的更新；所述路侧单元RSU是沿着道路进行部署的基础设施，具备与车辆节点及云端中心通信的能力，是车辆节点与云端中心进行信息交互的桥梁；所述基于簇结构的分层式信任管理模型基于信任评估方案对信任度进行评估，不同信任管理层次的角色承担不同的信任管理功能，具有不同的信任评估方案；簇成员节点的信任评估方案由直接信任和间接信任综合计算而成，表示对其他簇成员节点的信任评价；所述直接信任是簇成员节点对待评估节点的主观信任评价，簇成员节点在运行过程中实时收集与其他簇成员节点的交互信息，结合贝叶斯推理思想对其他簇成员节点进行直接信任评估；一段时间内，簇成员节点和/＞进行交互，统计二者的交互结果，成功的次数为/＞，失败的次数为/＞，则簇成员节点/＞对/＞的直接信任值/＞根据下式计算而得：当进行直接信任值计算时，对于统计到的失败交互次数，通过惩罚因子进行加强，即：其中为惩罚因子，且满足/＞；所述间接信任为共同邻居节点的意见，计算公式如下：其中，表示簇成员节点/＞对簇成员节点/＞的直接信任值，/＞表示簇成员节点对簇成员节点/＞的直接信任值，/＞表示节点/＞和/＞的共同邻居数量；在簇成员节点得出簇成员节点/＞的直接信任值和间接信任值后，计算其综合信任值，综合信任值随簇成员节点的维护信息上传到簇头节点：其中，表示直接信任所占的权重，且满足/＞；簇头节点层的每个簇头节点维护当前簇结构的局部信任值表，该表中存储着当前簇所有簇成员节点的局部信任值；当簇成员节点层的信任评估完成后，簇头节点接收簇成员节点上报的信息并构建一个含所有簇成员节点综合信任值的矩阵，根据该矩阵进行综合计算，得到簇成员节点在当前簇中过去一段时间的信任信息，并更新到局部信任值表中；设当前簇的节点数量为，包括1个簇头节点及/＞个簇成员节点，则形成的综合信任值的矩阵/＞如下所示：其中，表示节点/＞对节点/＞的综合信任值，当某对节点间不存在交互关系，则该综合信任值为0，对角线上的值表示节点对自身的信任评估，均设置为0；根据综合信任值的矩阵，簇头节点得出其簇成员节点过去一段时间在簇内的信任表现，以局部信任值/＞表示，计算公式如下：其中，表示当前簇成员节点的数量，/＞表示节点/＞对节点/＞的综合信任值，/＞表示所有簇成员节点中对节点/＞的综合信任值不为0的节点个数；所述簇结构通过基于权重的多属性分簇算法生成；所述基于权重的多属性分簇算法，根据车辆节点与其邻居节点间的相对速度、车辆节点与其邻居节点间的相对距离以及节点的连接性和信任度构建多属性的簇头得分计算方案，基于多属性的簇头得分计算方案进行簇头选举策略和簇生成方案。2.根据权利要求1所述的基于聚簇的车联网信任管理方法，其特征在于，所述云端中心的信任评估方案具体为：当簇头节点进入RSU的通信范围时，其将局部信任信息更新到最近的RSU，RSU与其他的RSU以及云端中心配合，将这些局部信任信息进行汇总，去除掉其中的重复数据、无效数据以及不完整的数据，最终在云端中心形成全局信任值；在云端中心进行节点的全局信任更新包括两种情况：单个簇和多个簇；单个簇情况表示节点在该段时间内，仅在一个簇中进行了活动，该节点的全局信任值与簇头节点上报的簇成员节点局部信任值一致；多个簇情况下，当节点在该段时间内不仅在一个簇中进行了活动，其运行轨迹涉及多个簇时，云端中心从RSU收集到来自多个簇头上报的目标节点局部信任信息，该节点的全局信任值计算公式如下：/＞其中，表示该节点所涉及的簇数量，/＞表示每个簇头节点上报的关于节点/＞的局部信任值信息。3.根据权利要求2所述的基于聚簇的车联网信任管理方法，其特征在于，所述基于权重的多属性分簇算法，其聚簇过程如下：1）邻居构建：车联网中车辆节点实时获取当前车辆节点的位置信息、速度信息，获取的信息封装成HELLO报文在车联网中周期性广播；周围接受到这些HELLO报文的车辆节点进行运动方向的验证，运动方向一致的车辆节点加入至邻居表，完成邻居构建；设定节点运动方向一致性的夹角阈值，结合车辆节点在道路上的运动模型，判断当前车辆节点的运动方向一致性；车辆节点运动夹角的计算如公式所示：其中，为车辆节点/＞和/＞的运动夹角，/＞和/＞为车辆节点/＞在时间/＞内的位移；2）得分交换：车辆节点根据相关的簇头选举指标进行节点簇头得分的计算，将簇头得分在车辆节点周围进行交换；簇头得分计算公式如公式所示：/＞其中，表示簇头得分，/＞为各属性所占权重，且满足；/＞表示车辆节点与其邻居节点的相对速度因素；/＞表示车辆节点与其邻居节点的相对距离因素；/＞表示车辆节点的连接度，/＞代表车辆节点的信任属性；3）簇头选举：进入簇头选举阶段，寻找簇头得分最高的节点成为簇头；当出现多个节点的簇头得分相同时，信任值更高、节点ID更小的节点优先成为簇头节点；4）簇头声明：当车辆节点的簇头得分最高时，其被选中为簇头节点，并向邻居节点发送clusterInviteMsg报文，邀请这些邻居节点加入该簇；等待邀请报文的节点接收到clusterInviteMsg报文时，首先向RSU验证节点的可靠性，为恶意节点则忽略该信息，为正常节点则向簇头节点发送willJoinMsg报文，申请加入当前簇；收到多个clusterInviteMsg报文，则选择簇头得分最高的簇加入；完成聚簇：当簇头节点接收到willJoinMsg报文，将该节点加入自己的簇成员列表，并向其发送clusterMsg报文，表示成功收到该信息；当节点接收到clusterMsg报文，其将自身状态更改为簇成员，完成簇的构建。4.根据权利要求3所述的基于聚簇的车联网信任管理方法，其特征在于，所述计算公式如下： /＞其中，表示车辆节点/＞的邻居节点数量，/＞和/＞为车辆节点/＞和车辆节点/＞的速度/＞表示车辆节点与邻居节点的平均相对速度，计算公式如下：其中，表示车辆节点/＞的邻居节点数量，车辆节点/＞为车辆节点/＞的邻居，和/＞为车辆节点/＞和车辆节点/＞的速度；计算公式如下：其中，表示车辆节点/＞的邻居节点数量，/＞表示车辆节点与邻居节点间的距离，计算公式见公式，/＞表示车辆节点与邻居节点的平均相对距离，计算公式见公式；其中，为车辆节点/＞的位置，/＞为某一个邻居节点/＞的位置；其中，表示车辆节点/＞的邻居节点数量，/＞为车辆节点/＞与其邻居节点的距离；指当前车联网中所有与其具有连接关系的车辆节点数量，其计算公式为：/＞其中，表示车联网内车辆节点的数量，/＞表示车联网中车辆节点/＞与车辆节点/＞之间的连接关系，计算如公式所示：其中，为车辆节点/＞与其邻居节点/＞的距离，与车辆节点/＞运动方向相同且距离小于最大通信传输距离的节点表示与节点/＞有连接关系；表示节点信任度，初始阶段将网络中运行的车辆节点设置为三种不同角色，并根据角色的不同分配不同的初始信任值，设置的车辆角色和初始信任值如公式所示：。5.根据权利要求4所述的基于聚簇的车联网信任管理方法，其特征在于，所述节点运动方向一致性的夹角阈值为18度。
说明书desc
技术领域本发明涉及车联网网络安全技术领域，尤其涉及一种基于聚簇的车联网信任管理方法。背景技术车联网作为一个包含人员、车辆、路侧单元以及基站等多元素的复杂智能网络，人与车之间、车与车之间、车与路侧单元之间的关系错综复杂，这使得车联网的安全受到很大威胁。过去的几年中，也有一些研究人员提出了各种各样的方案来保护车联网中通信的安全。有人提出类似于传统网络的方案，采用基于密码学的方法来保证车辆间通信的安全性，车辆节点间使用证书和公钥等来管理节点身份，通过证书验证的方式，确保信息由授权车辆发送，以此来提高网络的整体安全性。但是，这种基于密码学认证的方案在车联网环境中并没有取得很好的效果。原因有很多，首先，由于车联网中车辆行为的动态性较高，网络节点间需要更加频繁地检查身份信息；其次，由于缺乏普及可靠的网络基础设施，网络节点的身份控制消息无法可靠地共享，给网络认证带来了巨大的压力。此外，车联网受到的内部安全威胁比外部攻击更多，网络内部的授权车辆会恶意广播虚假或篡改后的信息，这些虚假或篡改后的信息不仅会降低交通运输效率，还有可能会造成交通事故，威胁到人们的生命安全。因此，近些年来以信任思想为核心的信任管理机制在车联网中的研究逐渐增加。通过信任管理机制构建可信的网络通信环境，帮助车辆节点快速准确地判断出消息的可信度，从而提高车联网的整体安全性，成为众多研究人员的共识。然而，由于车联网环境的复杂性和独特性，当前提出的各种信任管理方案并不完善。例如，常见的集中式信任管理机制通过第三方可信机构完成信任管理，在车联网这样密度大且高度动态的环境中容易出现网络负载大、信任管理机制的可扩展性较差等问题；而分散式的信任管理机制，每个节点与其他节点的历史信任信息仅保留在本地，在节点移动性较大的车联网环境中，车辆节点难以获取目标节点的过往信任信息，因此无法得到准确的信任评估结果。由于存在这些问题，目前业内尚未形成通用的信任管理机制。本发明设计了一种基于聚簇的车联网信任管理方法，其为车联网中基于聚簇的信任管理机制，通过聚簇的方式优化信任管理，使其更适用于车联网的这一新兴的独特网络环境。发明内容本发明的主要目的是构建一种基于聚簇的车联网信任管理方法，其为适用于车联网环境的基于簇结构的信任管理机制。本发明的技术方案如下：一种基于聚簇的车联网信任管理方法，包括基于簇结构的分层式信任管理模型和基于权重的多属性分簇算法；所述基于簇结构的分层式信任管理模型，以簇结构为基础，根据车联网实体角色的不同，将车联网实体划分为不同的信任管理层次；各信任管理层次的车联网实体在基于簇结构的分层式信任管理模型中承担不同的信任管理功能，通过各信任管理层次间的相互合作，完成整个车联网的信任管理；所述基于簇结构的分层式信任管理模型分为两个部分，分别为云端中心和道路系统；所述云端中心为可信的中央机构，负责完成整个车联网的管理，进行证书处理、全局信任管理和恶意节点处理；所述道路系统包括独立簇结构的车辆集群和沿道路部署的路侧单元RSU，车辆节点根据在簇结构内的不同角色，被划分为簇头节点或簇成员节点；所述簇成员节点对其他簇成员节点的运行状况进行监测，根据簇成员节点间的直接交互历史以及邻居节点的推荐信息评估其他簇成员节点的信任度，并将信任度信息上报到簇头节点；所述簇头节点维护当前簇结构的局部信任信息，根据簇成员节点上报的信任度信息进行综合计算，管理当前簇结构中各簇成员节点的局部信任值，并上报到云端中心，辅助完成全局信任的更新；所述路侧单元RSU是沿着道路进行部署的基础设施，具备与车辆节点及云端中心通信的能力，是车辆节点与云端中心进行信息交互的桥梁。所述基于簇结构的分层式信任管理模型基于信任评估方案对信任度进行评估，不同信任管理层次的角色承担不同的信任管理功能，具有不同的信任评估方案；簇成员节点的信任评估方案由直接信任和间接信任综合计算而成，表示对其他簇成员节点的信任评价；所述直接信任是簇成员节点对待评估节点的主观信任评价，簇成员节点在运行过程中实时收集与其他簇成员节点的交互信息，结合贝叶斯推理思想对其他簇成员节点进行直接信任评估；一段时间内，簇成员节点和/＞进行交互，统计二者的交互结果，成功的次数为，失败的次数为/＞，则簇成员节点/＞对/＞的直接信任值/＞根据下式计算而得：/＞当进行直接信任值计算时，对于统计到的失败交互次数，通过惩罚因子进行加强，即： /＞其中为惩罚因子，且满足/＞；所述间接信任为共同邻居节点的意见，计算公式如下： /＞其中，表示簇成员节点/＞对簇成员节点/＞的直接信任值，/＞表示簇成员节点/＞对簇成员节点/＞的直接信任值，/＞表示节点/＞和/＞的共同邻居数量；在簇成员节点得出簇成员节点/＞的直接信任值和间接信任值后，计算其综合信任值/＞，综合信任值随簇成员节点的维护信息上传到簇头节点： /＞其中，表示直接信任所占的权重，且满足/＞；簇头节点层的每个簇头节点维护当前簇结构的局部信任值表，该表中存储着当前簇所有簇成员节点的局部信任值；当簇成员节点层的信任评估完成后，簇头节点接收簇成员节点上报的信息并构建一个含所有簇成员节点综合信任值的矩阵，根据该矩阵进行综合计算，得到簇成员节点在当前簇中过去一段时间的信任信息，并更新到局部信任值表中；设当前簇的节点数量为，包括1个簇头节点及/＞个簇成员节点，则形成的综合信任值的矩阵/＞如下所示：其中，表示节点/＞对节点/＞的综合信任值，当某对节点间不存在交互关系，则该综合信任值为0，对角线上的值表示节点对自身的信任评估，均设置为0；根据综合信任值的矩阵，簇头节点得出其簇成员节点过去一段时间在簇内的信任表现，以局部信任值/＞表示，计算公式如下： /＞其中，表示当前簇成员节点的数量，/＞表示节点/＞对节点/＞的综合信任值，/＞表示所有簇成员节点中对节点/＞的综合信任值不为0的节点个数。所述簇结构通过基于权重的多属性分簇算法生成；所述基于权重的多属性分簇算法，根据车辆节点与其邻居节点间的相对速度、车辆节点与其邻居节点间的相对距离以及节点的连接性和信任度构建多属性的簇头得分计算方案，基于多属性的簇头得分计算方案进行簇头选举策略和簇生成方案。所述云端中心的信任评估方案具体为：当簇头节点进入RSU的通信范围时，其将局部信任信息更新到最近的RSU，RSU与其他的RSU以及云端中心配合，将这些局部信任信息进行汇总，去除掉其中的重复数据、无效数据以及不完整的数据，最终在云端中心形成全局信任值；在云端中心进行节点的全局信任更新包括两种情况：单个簇和多个簇；单个簇情况表示节点在该段时间内，仅在一个簇中进行了活动，该节点的全局信任值与簇头节点上报的簇成员节点局部信任值一致；多个簇情况下，当节点在该段时间内不仅在一个簇中进行了活动，其运行轨迹涉及多个簇时，云端中心从RSU收集到来自多个簇头上报的目标节点局部信任信息，该节点的全局信任值计算公式如下： /＞其中，表示该节点所涉及的簇数量，/＞表示每个簇头节点上报的关于节点/＞的局部信任值信息。所述基于权重的多属性分簇算法，其聚簇过程如下：1）邻居构建：车联网中车辆节点实时获取当前车辆节点的位置信息、速度信息，获取的信息封装成HELLO报文在车联网中周期性广播；周围接受到这些HELLO报文的车辆节点进行运动方向的验证，运动方向一致的车辆节点加入至邻居表，完成邻居构建；设定节点运动方向一致性的夹角阈值，结合车辆节点在道路上的运动模型，判断当前车辆节点的运动方向一致性；车辆节点运动夹角的计算如公式所示：/＞其中，为车辆节点/＞和/＞的运动夹角，/＞和/＞为车辆节点/＞在时间/＞内的位移；2）得分交换：车辆节点根据相关的簇头选举指标进行节点簇头得分的计算，将簇头得分在车辆节点周围进行交换；簇头得分计算公式如公式所示： /＞其中，表示簇头得分，/＞，/＞，/＞，/＞为各属性所占权重，且满足；/＞表示车辆节点与其邻居节点的相对速度因素；/＞表示车辆节点与其邻居节点的相对距离因素；/＞表示车辆节点的连接度，/＞代表车辆节点的信任属性；3）簇头选举：进入簇头选举阶段，寻找簇头得分最高的节点成为簇头；当出现多个节点的簇头得分相同时，信任值更高、节点ID更小的节点优先成为簇头节点；4）簇头声明：当车辆节点的簇头得分最高时，其被选中为簇头节点，并向邻居节点发送clusterInviteMsg报文，邀请这些邻居节点加入该簇；等待邀请报文的节点接收到clusterInviteMsg报文时，首先向RSU验证节点的可靠性，为恶意节点则忽略该信息，为正常节点则向簇头节点发送willJoinMsg报文，申请加入当前簇；收到多个clusterInviteMsg报文，则选择簇头得分最高的簇加入；完成聚簇：当簇头节点接收到willJoinMsg报文，将该节点加入自己的簇成员列表，并向其发送clusterMsg报文，表示成功收到该信息；当节点接收到clusterMsg报文，其将自身状态更改为簇成员，完成簇的构建。所述计算公式如下：/＞其中，表示车辆节点/＞的邻居节点数量，/＞和/＞为车辆节点/＞和车辆节点/＞的速度/＞表示车辆节点与邻居节点的平均相对速度，计算公式如下：/＞其中，表示车辆节点/＞的邻居节点数量，车辆节点/＞为车辆节点/＞的邻居，/＞和/＞为车辆节点/＞和车辆节点/＞的速度；计算公式如下： /＞其中，表示车辆节点/＞的邻居节点数量，/＞表示车辆节点与邻居节点间的距离，计算公式见公式，/＞表示车辆节点与邻居节点的平均相对距离，计算公式见公式；/＞其中，为车辆节点/＞的位置，/＞为某一个邻居节点/＞的位置；/＞其中，表示车辆节点/＞的邻居节点数量，/＞为车辆节点/＞与其邻居节点/＞的距离；指当前车联网中所有与其具有连接关系的车辆节点数量，其计算公式为： /＞其中，表示车联网内车辆节点的数量，/＞表示车联网中车辆节点/＞与车辆节点/＞之间的连接关系，计算如公式所示： /＞其中，为车辆节点/＞与其邻居节点/＞的距离，与车辆节点/＞运动方向相同且距离小于最大通信传输距离的节点表示与节点/＞有连接关系；表示节点信任度，初始阶段将网络中运行的车辆节点设置为三种不同角色，并根据角色的不同分配不同的初始信任值，设置的车辆角色和初始信任值如公式所示： /＞所述节点运动方向一致性的夹角阈值为18度。本发明的有益效果：本发明在簇结构的基础上设计相应的信任管理方案，兼顾节点区域性的局部信任和网络整体的全局信任，能有效提升信任管理的有效性。同时，本发明综合考虑多种属性对簇结构的影响，设计了新的基于权重的多属性分簇算法，构建稳定可靠的簇结构，给信任管理方案的稳定运行提供了基础。附图说明图1为分层式信任管理模型的结构示意图；图2为分层式信任管理模型流程示意图；图3为系统层次架构示意图；图4为城市交通轨迹模拟图；图5为图4虚线框部分放大的交通模拟运行示意图；图6为车联网信息配置流程；图7为平均簇头持续时间对比图；图7为平均簇成员持续时间对比图；图8为车联网中簇的数量对比图；图9为车辆全局信任值变化情况示意图。具体实施方式构建基于簇结构的分层式信任管理模型，如图1和图2所示；分层式信任管理模型结构：在综合考虑簇结构的网络特点和车联网环境的特性基础上，设计了一种适用于车联网环境的基于簇结构的分层式信任管理方案。根据车辆节点在簇结构中的不同角色以及路侧单元和云端中心等基础设施的特点，将其在信任管理方案中划分为不同的网络层次，各层次的网络节点承担着不同的信任管理功能，并通过相互协作完成整体的信任管理。该信任管理模型整体可分为两个部分，即云端中心和道路系统。1）云端中心被设置为可信的中央机构，负责完成整个网络的管理，主要具有以下几方面功能：a）证书处理：主要负责车联网中运行的车辆节点的证书管理等工作，主要包括车辆节点的长期数字证书和车辆节点的短期数字证书。其中，长期数字证书是车辆节点在网络内运行的必要条件，是车辆节点第一次加入网络时由云端中心分配的，只有具备该证书的车辆节点才能在网络中运行。短期数字证书是车辆节点的假名，用来保护车联网内通信节点的隐私。通过短期数字证书保护车辆节点由云端中心分配的全局唯一标识，可确保系统内参与者车辆的匿名性。b）全局信任管理：主要负责网络中所有节点的全局信任值的更新和维护等操作，是解决信任跨区问题的重要手段。在车联网中运行时，车辆节点可能会脱离当前区域到达一个新的区域，新区域的节点可根据云端中心的全局信任信息获取该车辆节点的历史表现，作为后续操作的参考依据。c）恶意节点处理：主要负责处理车联网中的恶意节点等工作。当接收到RSU上传的恶意节点信息时，云端中心会撤销该恶意节点的数字证书，并将被撤销数字证书的节点信息告知整个车联网，收到消息的网络节点将拒绝与被撤销数字证书的节点通信，从而完成将恶意节点从车联网中驱逐的功能。2）道路系统由独立簇结构的车辆集群和沿道路部署的RSU组成，其中车辆节点根据在簇结构内的不同角色，又被划分为簇头节点和簇成员节点。a）簇成员节点主要对车联网中其他簇成员节点的运行状况进行监测，根据节点间的直接交互历史以及邻居节点的推荐信息评估其他成员节点的可信度，并及时将相关的信任信息等上报到簇头节点。b）簇头节点主要负责维护当前簇网络的局部信任信息，其根据簇成员节点上报的信任信息进行综合计算，管理当前簇网络中各簇成员节点的局部信任值，并及时上报到云端中心，辅助完成全局信任的更新。c）RSU是沿着道路进行部署的基础设施，具备与车辆节点及云端中心通信的能力，是车辆节点与云端中心进行信息交互的桥梁。车辆节点可以通过RSU上传和接收各种信息，例如：车辆节点可通过RSU进行局部信任信息的上传、恶意节点信息的上报以及接收云端中心的证书撤销列表等。分层式信任评估方案，不同信任管理层次的角色承担不同的信任管理功能，具有不同的信任评估方案。1）簇成员节点层的信任评估方案由直接信任和间接信任综合而计算成，表示对其他成员节点的信任评价。a）直接信任评估：直接信任是节点对待评估节点的主观信任评价，簇成员节点在运行过程中将实时收集与网络中其他节点的交互信息，并结合贝叶斯推理的思想对其他成员节点进行直接信任评估。假设一段时间内，簇成员节点和/＞进行交互，统计它们的交互结果，成功的次数为/＞，失败的次数为/＞，则成员节点/＞对/＞的直接信任值/＞可用下式计算：此外，为了在真实应用场景中体现信任“上升慢下降快”的性质，引入了惩罚因子的思想。通过惩罚因子提高恶意行为的权重，来强化节点恶意行为对信任的影响，具体方法如下：当进行直接信任值计算时，对于统计到的失败交互次数，需要通过惩罚因子进行加强，即：其中为惩罚因子，且满足/＞。以惩罚后的失败交互次数作为直接信任计算中的失败交互次数输入，表示节点间交互失败的记录比交互成功的记录具有更大的权重，当节点运行过程中表现出恶意行为时，会导致节点的直接信任值下降更加明显。b）间接信任评估：在簇成员节点层的信任管理中，对目标节点的信任评估，除了考虑节点间的直接信任外，还考虑了节点的间接信任属性。即，在节点对节点/＞进行信任评估时，除了根据以往的交互历史评估其直接信任值外，它们之间的共同邻居的意见也很重要，将共同邻居节点的意见作为间接信任值/＞，计算公式如下：其中，表示簇成员节点/＞对簇成员节点/＞的直接信任值，/＞表示簇成员节点/＞对簇成员节点/＞的直接信任值，/＞表示节点/＞和/＞的共同邻居数量。c）综合信任计算：在簇成员节点得出节点/＞的直接信任值和间接信任值后，会计算其综合信任值/＞，该信任值将会随簇的维护信息上传到簇头节点：其中，表示直接信任所占的权重，且满足/＞。该值越大说明直接信任值在综合信任值中占据的比重越高。2）在簇头节点层，每个簇头节点将维护当前簇的局部信任值表，该表中存储着当前簇所有簇成员的局部信任值。当簇成员层的信任评估完成后，簇成员节点会将这些综合信任值随着簇的维护信息一起发送给簇头节点。簇头节点将接收这些上报的信息并构建一个含所有簇成员综合信任值的矩阵，接着根据该矩阵进行综合计算，得到簇成员在当前簇中过去一段时间的信任信息，并更新到局部信任值表中。设当前簇的节点数量为，其中包括1个簇头节点及/＞个簇成员节点，则形成的综合信任值矩阵/＞如下所示：其中，表示节点/＞对节点/＞的综合信任值，若某对节点间不存在交互关系，则值为0，对角线上的值表示节点对自身的信任评估，此处中认为节点对自身的评估无效，因此均设置为0。根据上述的综合信任值矩阵，簇头节点可得出其簇成员节点过去一段时间在簇内的信任表现，以局部信任值/＞表示，计算公式如下：其中，表示当前簇成员节点的数量，/＞表示节点/＞对节点/＞的综合信任值，/＞表示所有簇成员节点中对节点/＞的综合信任值不为0的节点个数。3）云端中心的信任评估方案：当簇头节点进入RSU的通信范围时，其会尽快将局部信任信息更新到最近的RSU，RSU会与其他的RSU以及云端中心配合，将这些信任信息进行汇总，去除掉其中的重复数据、无效数据以及不完整的数据，最终在云端中心形成全局的信任值，为后续的决策等提供支持。在云端中心进行节点的全局信任更新主要包括两种情况：单个簇和多个簇。a）单个簇：表示节点在该段时间内，仅在一个簇中进行了活动，此时节点的全局信任值与簇头节点上报的簇成员局部信任值一致。b）多个簇：当节点在该段时间内不仅在一个簇中进行了活动，其运行轨迹涉及多个簇时，云端中心将会从RSU收集到来自多个簇头上报的目标节点局部信任信息，此时该节点的全局信任值计算公式如下：其中，表示该节点所涉及的簇的数量，/＞表示每个簇头节点上报的关于节点的局部信任值信息。构建簇结构；稳定可靠的簇结构是信任管理的基础，在综合考虑了车联网环境特点的基础上设计了基于权重的多属性分簇算法，通过构建合适的簇头选举指标，构建稳定可靠的簇结构，为信任管理提供必要基础。聚簇的过程如下：邻居构建：车联网中车辆节点实时获取当前节点的位置、速度等信息，并将这些信息封装成HELLO报文在网络中周期性的广播。周围接受到这些HELLO报文的节点将进行运动方向的验证，运动方向一致的节点会被加入邻居表，完成邻居构建的操作。结合车辆节点在道路上的运动模型，此处将节点运动方向一致性的夹角阈值设置为18度，即当邻居节点与当前车辆节点运动方向夹角不超过18度时，则认为运动方向一致性；否则认为节点的运动方向不一致。节点运动夹角的计算所示：其中，为车辆节点/＞和/＞的运动夹角，/＞和/＞为车辆节点/＞在时间/＞内的位移。得分交换：车辆节点将根据相关的簇头选举指标进行节点簇头得分的计算，并将簇头得分在节点周围进行交换。簇头得分是节点成为簇头的主要参考依据，其计算公式所示：其中，表示簇头得分，/＞为各属性所占权重，且满足。1）表示节点与其邻居节点的相对速度因素，计算公式如下：其中，表示车辆节点/＞的邻居节点数量，/＞和/＞为车辆节点/＞和车辆节点/＞的速度/＞表示节点与邻居节点的平均相对速度，计算公式如下：其中，表示车辆节点/＞的邻居节点数量，车辆节点/＞为车辆节点/＞的邻居，/＞和为车辆节点/＞和车辆节点/＞的速度。/＞2）表示节点与其邻居节点的相对距离因素，计算公式如下：其中，表示车辆节点/＞的邻居节点数量，/＞表示节点与邻居节点间的距离，表示节点与邻居节点的平均相对距离。其中，为车辆节点/＞的位置，/＞为某一个邻居节点/＞的位置。其中，表示车辆节点/＞的邻居节点数量，/＞为车辆节点/＞与其邻居节点/＞的距离。3）表示车辆节点的连接度，指当前网络中所有与其具有连接关系的节点数量，其计算公式为：其中，表示车联网内节点的数量，/＞表示网络中车辆节点/＞与车辆节点/＞之间的连接关系，计算如下所示：其中，为车辆节点/＞与其邻居节点/＞的距离，即与车辆节点/＞运动方向相同且距离小于最大通信传输距离的节点表示与节点/＞有连接关系。4）代表节点的信任属性，表示节点的可信度，初始阶段参考基于车辆角色的思想，将网络中运行的车辆节点设置为三种不同角色，并根据角色的不同分配不同的初始信任值，设置的车辆角色和初始信任值如下所示：其中，管理机构车辆是指道路上运行的诸如警车、消防车等，其往往更值得被信任，因此设置有最高的初始信任值；熟悉道路车辆指运行的公交车、出租车等，其长期规律运行，对道路情况更为熟悉，因此设置为中等的初始信任值；剩下的车辆均为普通车辆，将其初始信任值设置为0.5，处于初始状态。簇头选举：进入簇头选举阶段，节点将寻找簇头得分最高的节点成为簇头；当出现多个节点的簇头得分相同时，信任值更高、节点ID更小的节点优先成为簇头；簇头声明：当节点的簇头得分最高时，其将被选中为簇头，并向邻居节点发送clusterInviteMsg报文，邀请这些节点加入该簇；当网络中等待邀请报文的节点接收到clusterInviteMsg报文，首先向RSU验证节点的可靠性，若为恶意节点则忽略该信息，若为正常节点则向簇头节点发送willJoinMsg报文，申请加入当前簇；若收到多个clusterInviteMsg报文，则选择簇头得分最高的簇加入；完成聚簇：当簇头节点接收到willJoinMsg报文，其将该节点加入自己的簇成员列表，并向其发送clusterMsg报文，表示成功收到该信息；当节点接收到clusterMsg报文，其将自身状态更改为簇成员，完成簇的构建。下表算法1是基于权重的多属性分簇算法的伪代码。/＞本实施方案的软硬件环境如表1所示。表1 软硬件配置环境下面结合附图对本发明的具体实施做详细说明。步骤一，系统结构：如图3所示，是系统实施方式的结构图，该系统是建立在ns-3网络仿真平台之上的。自上而下可以划分为数据服务层、功能应用层和平台支撑层。数据服务层主要完成对各类功能应用的数据收集、预处理以及分析等功能。功能应用层提供相应的具体功能应用，本系统中主要分为两个功能模块，即进行网络结构构建的聚簇模块以及在该结构基础上进行的信任管理模块。其中，聚簇模块可划分为邻居构建、簇头选举和簇的维护三个主要的功能模块；信任管理模块又可以划分为信息收集、信任评估和恶意节点检测三个功能模块等。最底层为平台支撑层，提供上述功能应用运行的环境支撑工作，其是由运行中Linux系统之上的ns-3网络仿真平台和SUMO交通仿真平台共同搭建而成。步骤二，车辆轨迹构建：构建路网信息：如图4所示是使用的道路信息示意图，是使用SUMO自带的道路编辑软件netedit进行编辑的，描述了模拟使用的道路信息。在该道路信息中，根据城市道路环境的特点，构建了多条双向的城市道路环境，并设置了多个十字路口、弯道等来模拟实际的城市交通场景。构建车流信息：根据需要在网络中设置了两种运行车辆信息，并为网络中的各个车辆节点设置了相应的运行轨迹，其运行示意图如图5所示。步骤三，构建网络环境：网络信息配置：如图6的流程所示，给ns-3中的网络节点设置网络设备、安装相关通信协议栈、应用并将上述介绍的车辆运行轨迹与网络节点结合，完成网络信息的配置工作，接着启动网络仿真，收集网络数据并进行相关的分析。步骤四，结果分析：图7和图7分别表示平均簇头持续时间和平均簇成员持续时间，从图中可明显看出，本发明在平均簇头持续时间和平均簇成员持续时间上与传统算法相比，均具有较大的优势，簇结构的维持时间更长，即簇更稳定。这是因为在簇头选举时考虑了节点与其邻居节点的相对速度、相对距离等因素，这使得选取的簇头节点具有较好的稳定性，实验结果也表明设计的方案是合理的。图8是车联网中簇的数量与车辆节点数量间的关系，从实验结果可知，随着车辆数量的增加，网络中形成的簇的数量也在增加，这是由于车辆数量的增加导致地图环境中车辆的存在状况更加复杂，节点更加分散，这些分散的节点就会形成新的簇。此外，还可以看出提出的聚簇方案与传统方案相比，形成的簇的数量较少，这将有助于降低云端中心的通信负载，提升网络性能。图9展示了车辆节点在网络中运行时其全局信任值的变化情况，选取了三个车辆作为代表，观察其信任值随着实验轮次的推进而变化的情况。其中，车辆v6为正常车辆，其初始信任值为0.5，运行过程中，随着其一直良好的表现，节点的信任值不断增加，最终一直保持在0.95以上，变化较小。车辆v8和车辆v10均为恶意节点，其初始信任值与v6相同，且运行初期，其并未表现出异常行为，故信任值一直处于累加的过程，约在第10轮开始，车辆节点v6开始表现出异常行为，体现在信任值上即其信任值开始下降，约在第14轮左右，节点又开始正常表现，节点的信任值重新开始上升。车辆节点v10与之类似，不同处在于其表现出异常行为的时间较晚，约为第15轮开始，且其异常行为的持续时间更长，体现在图中便是其信任下降的更加明显，信任值更低。此外，值得注意的是，从图中可以很明显的看出，节点的异常行为导致的节点信任值下降的曲线比信任值上升的曲线陡峭的多，这由于使用惩罚因子增强了节点异常行为对信任值的影响，更真实的体现了节点恶意行为对信任的破坏效果。综上所述，本发明设计的基于簇结构的信任管理方案和分簇算法已经实现，信任管理的有效性和聚簇方案的优越性已得到验证。
