标题title
一种全链路数据安全保护方法及系统
摘要abst
本发明公开了一种全链路数据安全保护方法及系统，该方法包括下述步骤：在数据采集阶段构建数据安全标识，在数据传输存储阶段对密文文件分块并生成密文分量，计算虚拟索引和数据标签，将密文分量发送到DHT网络中，将虚拟索引、数据块和数据标签构成的元组上传至云服务器，在数据处理与数据交换阶段基于重加密密钥生成算法进行重加密，解密后得到标识符和秘密值，获取密文分量关联索引的元组，基于属性代理重加密实现云端存储的细粒度访问控制，在数据销毁阶段使用DHT网络自动更新功能实现数据自毁，本发明能实现数据生命周期全流程安全保护，能有效保障数据的保密性、数据完整性、实现细粒度访问控制，并保障数据的使用、流动和存储安全。
权利要求书clms
1.一种全链路数据安全保护方法，其特征在于，包括下述步骤：密钥生成中心初始化，生成公开参数；数据拥有者使用自身的身份 向密钥生成中心注册，密钥生成中心计算验证数据拥有者签名的公钥，数据拥有者生成私钥，基于私钥对密文进行签名；数据用户使用自身的身份向密钥生成中心注册，密钥生成中心为数据用户生成用于签名的私钥，数据用户基于私钥对操作消息进行签名；数据产生和采集阶段：根据客体数据的类别和所属安全等级，构建数据安全标识并校验签发标识符；中心节点获取数据安全属性集合，数据拥有者基于对称加密算法生成对称密钥，基于对称密钥加密明文文件，生成密文文件，将对称密钥与加密数据的安全属性相关联，用于实现访问控制；中心节点生成解密密钥；数据传输和数据存储阶段：数据拥有者对密文文件分块并生成密文分量，数据拥有者计算数据块的虚拟索引和数据标签，将密文分量发送到DHT网络中，将虚拟索引、数据块和数据标签构成的元组上传至云服务器；数据处理与数据交换阶段：中心节点基于重加密密钥生成算法进行重加密，生成重加密的密文，数据用户获取密文，解密后得到标识符和秘密值，基于标识符生成多个分发索引，从DHT网络中获取密文分量关联索引的元组，数据用户基于标识符计算虚拟索引，从云服务器中获取由虚拟索引、数据块和数据标签构成的元组，通过数据签名和密文的标签，数据用户进行密文的完整性验证，利用拉格朗日插值法重构出密文分量所对应的密文文件数据块，组合得到完整的密文文件，基于对称密钥解密得到明文文件；在数据销毁阶段：在预设的条件下，DHT网络基于数据安全标识丢弃所存的密文分量关联的索引元组。2.根据权利要求1所述的全链路数据安全保护方法，其特征在于，密钥生成中心的公开参数表示为：；其中，表示循环加法群，/＞表示循环乘法群，/＞表示素数，/＞表示双线性映射，/＞表示循环加法群/＞的一个生成元，/＞表示密钥生成中心的公钥，/＞表示密钥计算算法，/＞、/＞、/＞分别表示哈希函数。3.根据权利要求1所述的全链路数据安全保护方法，其特征在于，密钥生成中心收到数据拥有者的注册请求后，选取一个随机数，选择与数据拥有者的共享秘密值/＞，选择数据拥有者与数据用户的共享秘密值/＞，计算验证数据拥有者签名的公钥，表示为：；其中，表示异或；密钥生成中心将发送给数据拥有者；其中，，/＞，/＞，/＞，/＞表示循环加法群/＞的一个生成元，/＞表示哈希函数，/＞表示随机数，随机数/＞作为密钥生成中心的私钥，/＞表示正整数中的素数。4.根据权利要求3所述的全链路数据安全保护方法，其特征在于，数据拥有者计算自己的私钥为：；其中，表示位串的串接，/＞是私钥的生成时间。5.根据权利要求1所述的全链路数据安全保护方法，其特征在于，数据拥有者基于对称加密算法生成对称密钥，基于对称密钥加密明文文件，生成密文文件，为了实现细粒度访问控制，将对称密钥加密形成密文，密文表示为：；；；；其中，表示数据安全属性集合，/＞表示对称密钥，/＞表示标识符，/＞表示随机数，/＞表示位串的串接，/＞表示对于数据安全集合中的/＞个属性选择/＞个随机数，/＞，/＞，表示正整数中的素数，/＞为循环乘法群/＞的生成元，/＞表示双线性映射，/＞表示随机数。6.根据权利要求3所述的全链路数据安全保护方法，其特征在于，数据拥有者对密文文件分块并生成密文分量，数据拥有者计算数据块的虚拟索引和数据标签，具体包括：数据拥有者将密文文件分为个数据块，从数据块中提取出数据块/＞，剩下的数据块表示为/＞；虚拟索引表示为：；其中，c表示消息块对应的索引，/＞，/＞表示标识符；数据标签表示为：；；；；其中，表示数据拥有者的私钥，/＞表示循环加法群/＞的一个生成元，/＞表示哈希函数，表示随机数，/＞是签名时间戳。7.根据权利要求6所述的全链路数据安全保护方法，其特征在于，将密文分量发送到DHT网络中，密文分量表示为：；；；；；；；；其中，表示有限域中选择的/＞个数，/＞表示哈希函数；将数据标识SID作为安全伪随机数产生器的种子，生成N个分发索引，密文分量关联索引产生N个元组/＞，将所有元组分发到DHT网络节点进行保存。8.根据权利要求1所述的全链路数据安全保护方法，其特征在于，中心节点基于重加密密钥生成算法进行重加密，生成重加密的密文，具体表示为：；；；；；其中，表示数据安全属性集合，/＞表示数据安全属性集合中选择的随机数，/＞和/＞分别表示数据属性定义的访问控制结构和用户属性定义的访问控制结构，/＞表示对称密钥，表示标识符，/＞表示随机数，/＞表示位串的串接，/＞为循环乘法群/＞的生成元，/＞表示双线性映射，/＞表示随机数。9.根据权利要求7所述的全链路数据安全保护方法，其特征在于，数据用户进行密文的完整性验证，具体包括：数据用户验证提取到的密文分量重新生成的，判断是否等于/＞；验证云服务器返回对应的v个元组，对于每个元组，计算，批量验证等式：；其中，表示哈希函数，/＞表示数据拥有者签名的公钥，/＞表示数据拥有者与数据用户的共享秘密值。10.一种全链路数据安全保护系统，其特征在于，包括：初始化模块、密钥生成中心、数据拥有者、数据用户、中心节点、云服务器、DHT网络、标识符构建模块；所述初始化模块用于进行密钥生成中心初始化；所述密钥生成中心用于生成公开参数、计算验证数据拥有者签名的公钥，为数据用户生成用于签名的私钥；所述数据拥有者用于使用自身的身份向密钥生成中心注册，数据拥有者生成私钥，基于私钥对密文进行签名；所述数据用户用于使用自身的身份向密钥生成中心注册，数据用户基于私钥对操作消息进行签名；所述标识符构建模块用于根据客体数据的类别和所属安全等级，构建数据安全标识并校验签发标识符；所述中心节点用于获取数据安全属性集合，生成解密密钥；所述数据拥有者用于基于对称加密算法生成对称密钥，基于对称密钥加密明文文件，生成密文文件，将对称密钥与加密数据的安全属性相关联，用于实现访问控制；所述数据拥有者用于对密文文件分块并生成密文分量，计算数据块的虚拟索引和数据标签，将密文分量发送到DHT网络中，将虚拟索引、数据块和数据标签构成的元组上传至云服务器；所述中心节点用于基于重加密密钥生成算法进行重加密，生成重加密的密文，数据用户获取密文，解密后得到标识符和秘密值，基于标识符生成多个分发索引，从DHT网络中获取密文分量关联索引的元组；所述数据用户用于基于标识符计算虚拟索引，从云服务器中获取由虚拟索引、数据块和数据标签构成的元组，通过数据签名和密文的标签，数据用户进行密文的完整性验证，利用拉格朗日插值法重构出密文分量所对应的密文文件数据块，组合得到完整的密文文件，基于对称密钥解密得到明文文件；所述云服务器用于存储由虚拟索引、数据块和数据标签构成的元组；所述DHT网络用于存储密文分量生成的元组，在预设的条件下，基于数据安全标识丢弃所存的密文分量关联的索引元组。
说明书desc
技术领域本发明涉及数据安全技术领域，具体涉及一种全链路数据安全保护方法及系统。背景技术数据生命周期六个阶段的安全包括数据采集安全、数据传输安全、数据存储安全、数据处理安全、数据交换安全、数据销毁安全，一方面，数据需要经历生命周期各阶段，每个阶段数据可能遇到的安全威胁不同，这给数据的安全保护带来了极大的挑战；另一方面，在大数据的环境下，随着网络技术的发展，数据的产生到使用等阶段的动态演进也十分迅速，数据量急增，对数据安全保护不容忽视。而密码技术在数据生命周期各个环节中扮演着关键角色，为数据安全保护提供了坚实的支撑。为了确保数据在各个阶段的安全得到有效保障，急需建立一种全链路数据保护技术，针对数据生命周期不同阶段面临的安全风险提供分阶段和全方位的保护。数据的流动和应用涉及到多个参与方和机构，数据必须在存储、传输和处理的各个关键环节中进行共享，以支持各种业务需求和创新应用。然而，当前的数据安全保护技术主要集中在特定场景或阶段的设计，缺乏全面性和整体性，存在一定的局限性。在数据的整个生命周期中，从采集、存储、传输、处理直到销毁，各个环节都面临着潜在的安全威胁。现有技术主要着眼于特定阶段的保护，而缺乏综合应对的全链路安全保护方案，少有方案综合运用访问控制、数据加密、数据销毁等技术设计全链路的数据安全保护方案，来为数据的整个生命周期提供保护。如在数据销毁阶段，熊金波等人提出了一种数据的安全自毁方案，特点是利用网络节点自动更新功能进而丢弃密文分量，导致密文不可恢复，但是这个方案中并没有使用代理重加密，也没有考虑数据的安全属性，更没有考虑到对数据的完整性校验技术。因此，如何设计一种能够在保证数据安全存储，考虑到数据安全属性，同时校验数据完整性，并实现数据按需销毁、自动销毁的全链路数据安全保护技术是亟需解决的技术难题。发明内容为了克服现有技术存在的缺陷与不足，本发明提供一种全链路数据安全保护方法及系统，本发明以数据安全属性作为属性输入，建立数据安全策略，再转换为用户属性实现访问控制，利用这种属性代理重加密方案进行加密，以此在数据存储阶段进行云端数据存储，实现细粒度访问控制，能够在保证数据安全存储，考虑到数据安全属性，同时校验数据完整性，并实现数据按需销毁、自动销毁。为了达到上述目的，本发明采用以下技术方案：本发明提供一种全链路数据安全保护方法，包括下述步骤：密钥生成中心初始化，生成公开参数；数据拥有者使用自身的身份向密钥生成中心注册，密钥生成中心计算验证数据拥有者签名的公钥，数据拥有者生成私钥，基于私钥对密文进行签名；数据用户使用自身的身份向密钥生成中心注册，密钥生成中心为数据用户生成用于签名的私钥，数据用户基于私钥对操作消息进行签名；数据产生和采集阶段：根据客体数据的类别和所属安全等级，构建数据安全标识并校验签发标识符；中心节点获取数据安全属性集合，数据拥有者基于对称加密算法生成对称密钥，基于对称密钥加密明文文件，生成密文文件，将对称密钥与加密数据的安全属性相关联，用于实现访问控制；中心节点生成解密密钥；数据传输和数据存储阶段：数据拥有者对密文文件分块并生成密文分量，数据拥有者计算数据块的虚拟索引和数据标签，将密文分量发送到DHT网络中，将虚拟索引、数据块和数据标签构成的元组上传至云服务器；数据处理与数据交换阶段：中心节点基于重加密密钥生成算法进行重加密，生成重加密的密文，数据用户获取密文，解密后得到标识符和秘密值，基于标识符生成多个分发索引，从DHT网络中获取密文分量关联索引的元组，数据用户基于标识符计算虚拟索引，从云服务器中获取由虚拟索引、数据块和数据标签构成的元组，通过数据签名和密文的标签，数据用户进行密文的完整性验证，利用拉格朗日插值法重构出密文分量所对应的密文文件数据块，组合得到完整的密文文件，基于对称密钥解密得到明文文件；在数据销毁阶段：在预设的条件下，DHT网络基于数据安全标识丢弃所存的密文分量关联的索引元组。作为优选的技术方案，密钥生成中心的公开参数表示为：；其中，表示循环加法群，/＞表示循环乘法群，/＞表示素数，/＞表示双线性映射，/＞表示循环加法群/＞的一个生成元，/＞表示密钥生成中心的公钥，/＞表示密钥计算算法，/＞、/＞、/＞分别表示哈希函数。作为优选的技术方案，密钥生成中心收到数据拥有者的注册请求后，选取一个随机数，选择与数据拥有者的共享秘密值/＞，选择数据拥有者与数据用户的共享秘密值/＞，计算验证数据拥有者签名的公钥，表示为：；其中，表示异或；密钥生成中心将发送给数据拥有者；其中，，/＞，/＞，/＞，/＞表示循环加法群/＞的一个生成元，/＞表示哈希函数，/＞表示随机数，随机数/＞作为密钥生成中心的私钥，/＞表示正整数中的素数。作为优选的技术方案，数据拥有者计算自己的私钥为：；其中，表示位串的串接，/＞是私钥的生成时间。作为优选的技术方案，数据拥有者基于对称加密算法生成对称密钥，基于对称密钥加密明文文件，生成密文文件，为了实现细粒度访问控制，将对称密钥加密形成密文，密文表示为：；；；；其中，表示数据安全属性集合，/＞表示对称密钥，/＞表示标识符，/＞表示随机数，表示位串的串接，/＞表示对于数据安全集合中的/＞个属性选择/＞个随机数，/＞，，/＞表示正整数中的素数，/＞为循环乘法群/＞的生成元，/＞表示双线性映射，/＞表示随机数。作为优选的技术方案，数据拥有者对密文文件分块并生成密文分量，数据拥有者计算数据块的虚拟索引和数据标签，具体包括：数据拥有者将密文文件分为个数据块，从数据块中提取出数据块/＞，剩下的数据块表示为/＞；虚拟索引表示为：；其中，c表示消息块对应的索引，/＞，/＞表示标识符；数据标签表示为：；；；；其中，表示数据拥有者的私钥，/＞表示循环加法群/＞的一个生成元，/＞表示哈希函数，/＞表示随机数，/＞是签名时间戳。作为优选的技术方案，将密文分量发送到DHT网络中，密文分量表示为：；；；；；；；；其中，表示有限域中选择的/＞个数，/＞表示哈希函数；将数据标识SID作为安全伪随机数产生器的种子，生成N个分发索引，密文分量关联索引产生N个元组/＞，将所有元组分发到DHT网络节点进行保存。作为优选的技术方案，中心节点基于重加密密钥生成算法进行重加密，生成重加密的密文，具体表示为：；；；；；其中，表示数据安全属性集合，/＞表示数据安全属性集合中选择的随机数，/＞和分别表示数据属性定义的访问控制结构和用户属性定义的访问控制结构，/＞表示对称密钥，/＞表示标识符，/＞表示随机数，/＞表示位串的串接，/＞为循环乘法群/＞的生成元，/＞表示双线性映射，/＞表示随机数。作为优选的技术方案，数据用户进行密文的完整性验证，具体包括：数据用户验证提取到的密文分量重新生成的，判断是否等于/＞；验证云服务器返回对应的v个元组，对于每个元组，计算，批量验证等式：；其中，表示哈希函数，/＞表示数据拥有者签名的公钥，/＞表示数据拥有者与数据用户的共享秘密值。本发明还提供一种全链路数据安全保护系统，包括：初始化模块、密钥生成中心、数据拥有者、数据用户、中心节点、云服务器、DHT网络、标识符构建模块；所述初始化模块用于进行密钥生成中心初始化；所述密钥生成中心用于生成公开参数、计算验证数据拥有者签名的公钥，为数据用户生成用于签名的私钥；所述数据拥有者用于使用自身的身份向密钥生成中心注册，数据拥有者生成私钥，基于私钥对密文进行签名；所述数据用户用于使用自身的身份向密钥生成中心注册，数据用户基于私钥对操作消息进行签名；所述标识符构建模块用于根据客体数据的类别和所属安全等级，构建数据安全标识并校验签发标识符；所述中心节点用于获取数据安全属性集合，生成解密密钥；所述数据拥有者用于基于对称加密算法生成对称密钥，基于对称密钥加密明文文件，生成密文文件，将对称密钥与加密数据的安全属性相关联，用于实现访问控制；所述数据拥有者用于对密文文件分块并生成密文分量，计算数据块的虚拟索引和数据标签，将密文分量发送到DHT网络中，将虚拟索引、数据块和数据标签构成的元组上传至云服务器；所述中心节点用于基于重加密密钥生成算法进行重加密，生成重加密的密文，数据用户获取密文，解密后得到标识符和秘密值，基于标识符生成多个分发索引，从DHT网络中获取密文分量关联索引的元组；所述数据用户用于基于标识符计算虚拟索引，从云服务器中获取由虚拟索引、数据块和数据标签构成的元组，通过数据签名和密文的标签，数据用户进行密文的完整性验证，利用拉格朗日插值法重构出密文分量所对应的密文文件数据块，组合得到完整的密文文件，基于对称密钥解密得到明文文件；所述云服务器用于存储由虚拟索引、数据块和数据标签构成的元组；所述DHT网络用于存储密文分量生成的元组，在预设的条件下，基于数据安全标识丢弃所存的密文分量关联的索引元组。本发明与现有技术相比，具有如下优点和有益效果：本发明采用数据安全标识技术提供了基础的信息支撑，可以在数据生命周期中的各个环节提供安全防护。通过标识数据、明确流程、分级控制、按需销毁等数据安全理念，可以确保数据的安全性。本发明使用了基于属性的重加密技术可以实现细粒度的访问控制，通过将数据属性和用户属性作为输入，利用属性代理重加密方案进行加密，可以在数据存储阶段实现云端数据存储，还设计了签名验证方法，确保数据的保密性和完整性。本发明使用了数据自毁技术，具有较高的可应用性和适用性，通过自动丢弃存储在网络节点上的密文分量，原始密文无法被恢复，从而保护了数据的机密性。附图说明图1为本发明全链路数据安全保护方法的实现架构示意图；图2为本发明数据安全标识结构图图3为本发明加密存储的流程示意图；图4为本发明解密验证的流程示意图；图5为本发明全链路数据安全保护系统的框架示意图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。实施例1如图1所示，本发明提供一种全链路数据安全保护方法，包括下述步骤：S1：系统初始化，具体包括：S101：密钥生成中心初始化，密钥生成中心KGC选择具有双线性映射性质的循环加法群和循环乘法群/＞，/＞表示密钥计算算法。/＞，/＞是阶数为素数/＞的循环群，双线性映射/＞，/＞为/＞的一个生成元，选择一个随机数作为密钥生成中心KGC的私钥，其中/＞代表正整数中的素数。计算密钥生成中心KGC的公钥/＞，选择三个安全哈希函数，/＞代表单向哈希加密函数，代表单向哈希加密函数，/＞代表单向哈希加密函数，密钥生成中心KGC公开参数表示为：/＞；S102、数据拥有者向密钥生成中心KGC注册，数据拥有者/＞使用自己的身份向密钥生成中心KGC注册，数据拥有者/＞生成用于签名的私钥，数据拥有者/＞完成加密数据后，用自己的私钥对密文其进行签名，数据拥有者/＞将其身份/＞发送给密钥生成中心KGC。密钥生成中心KGC收到/＞的注册请求后，选取一个随机数/＞，然后，密钥生成中心KGC选择与数据拥有者/＞的共享秘密值/＞，密钥生成中心KGC选择数据拥有者/＞与数据用户的共享秘密值/＞，密钥生成中心KGC计算验证/＞的签名的公钥/＞，其中/＞是异或的数学符号，计算/＞，/＞，/＞，然后计算，KGC将/＞发送给数据拥有者/＞。数据拥有者/＞计算自己的私钥为/＞，其中/＞表示位串的串接，/＞是私钥的生成时间。S103、数据用户向密钥生成中心KGC注册，一个机构可能有多个数据用户，数据用户/＞使用自己的身份/＞向密钥生成中心KGC注册，密钥生成中心KGC为这个数据用户生成用于签名的私钥/＞，数据用户对数据进行操作之后，用私钥对其操作消息进行签名，实现数据的安全流程追溯，密钥生成中心KGC通过安全信道发送/＞给数据用户/＞用于后续对数据的验证。S2：数据产生和采集阶段，设置数据安全标识，数据拥有者在本地加密数据；在本实施例中，数据安全标识是数据属性的载体，基于数据的价值和数据的敏感性设置安全属性，数据的敏感性取决于数据的是否能够公开，以及数据的保密程度。数据安全标识用于明确数据的属性信息，属性内容包括数据来源、数据发布时间、数据名称、数据分类、数据价值级别、数据敏感度等等。这些属性进一步明确了数据所需的安全等级与所需的保护等级。数据类别不同内容也不同，若收集的数据涉及用户隐私，则要使用K匿名的方式切断数据集中的标识属性和敏感属性之间一对一，或者一对多的联系，预防链接攻击，以取得保护数据隐私不被窃取。数据安全标识的格式包括：标识符、属性、校验值。S201：数据的产生或采集阶段建立数据安全标识。数据来源于数据采集器，主要有各类传感器和信息软件等，采集到的数据存储在数据拥有者本地存储设备中。在此阶段进行数据安全标识的建立。数据安全标识的建立过程：首先依据客体数据的类别和所属安全等级，构建数据安全标识并校验签发标识符，具体来说，客体数据类别可根据数据业务内容等进行划分，而所属安全级别等级可划分为短期保密、长期绝密、公开等，数据拥有者根据事先约定好的标识编码规则生成数字标识符，形式为二进制数据结构的组织编码，是该数据的唯一识别号。设置数据属性集合/＞，标识符/＞将存在于数据的全生命周期中。如图2所示，将数据标识符和数据绑定在一起，最后做一个校验值，这样就完成了数据安全标识的建立与绑定。以此划分数据的安全等级，为不同安全等级的数据建立不同的访问控制策略。数据拥有者将可以按照数据不同的安全等级对数据进行加密。S202：加密参数初始化，使用属性代理重加密技术加密实现细粒度访问控制。数据拥有者上传数据安全属性集合到中心节点。数据安全属性集合为/＞。中心节点HN选择安全参数/＞作为输入，选择一个阶为/＞循环乘法群/＞，/＞为/＞生成元。中心节点HN获取数据安全属性集合/＞，数据安全属性集合/＞是数据属性/＞的子集，是属性个数，集合中的/＞个元素/＞均表示数据属性，对于/＞中的属性选择/＞个随机数，其中/＞，再选择随机数/＞，由此得到主密钥MK为：/＞，/＞表示/＞个随机数，/＞，/＞；公共参数PK为：。其中/＞表示双线性映射。S203：数据加密，数据拥有者选取一种安全的对称加密算法，对称密钥是/＞，用对称密钥/＞来加密明文文件M生成密文文件/＞。中心节点HN加密密钥/＞，令秘密值为/＞。为了加密/＞，选择数据的安全属性集合/＞，安全属性集合/＞为数据属性/＞的子集，安全属性集合/＞用于访问控制，选择一个随机数/＞，得到密文。对称密钥/＞与它加密的数据安全属性相关联，而数据用户的私钥与一个访问结构相关联，当用户私钥中的访问策略满足数据的安全属性集时，数据用户才能得到对称密钥/＞与数据标识符/＞。S204：解密密钥生成，这一步由中心节点HN来完成。方案所采用的访问策略是通过访问控制树实现的，该树的每个非叶子节点代表一个门限，每一个叶子节点描述一个属性。/＞是一个根节点为/＞的访问树，/＞表示为根节点为/＞的/＞的子树。如果一个属性集合/＞满足该访问结构树时，记为/＞。计算/＞的递归如下：如果/＞是非叶子节点，计算/＞的所有子节点/＞的访问结构树/＞，当且仅当至少/＞个子节点返回1时，；如果/＞是叶子节点，当且仅当/＞时，/＞。当且仅当/＞时，访问控制树算法才会输出一个密钥，这意味着属性加密方法使得解密用户的属性以及访问策略符合访问控制树的访问策略才能够解密，数据用户能够解密在一组属性/＞下计算的消息。在访问控制树中，非节点/＞的孩子节点的个数为/＞，/＞是/＞的阈值，/＞。如果至少有/＞个孩子节点被赋值为真，那么该节点将被赋值为真。特别地，当/＞时，该节点便成为了OR门；当/＞时，该节点便成为了AND门。而叶子结点有/＞。定义如下函数: ①/＞表示结点/＞的父结点；②/＞表示与/＞关联的属性值，此时的/＞表示叶子结点；③对于树/＞中的每个结点的子结点定义顺序，按1到/＞的顺序编号，函数/＞返回与/＞相关联的编号，其中索引值是在给定键的访问结构中以任意方式唯一分配给节点的。具体来说，建立访问控制树/＞，对于树中的每个节点/＞，设置/＞是节点/＞阈值，计算多项式的次数/＞。自上而下，为每个非叶子节点/＞选择/＞阶的多项式/＞，根节点/＞有/＞，/＞表示随机数，设置其他内部节点/＞。对每个叶节点/＞，设置秘密值：/＞，其中/＞，只有当/＞是叶节点并且表达与树中的叶节点/＞相关联的属性时，才定义函数/＞，上述秘密值的集合是解密密钥/＞。依据数据安全标识中的保密等级信息，对用户的数据访问实施制约，避免用户访问超越其访问等级的数据。S3：数据传输和数据存储阶段，产生密文分量，将数据上传到云服务器和DHT网络，具体步骤包括：S301：数据拥有者对密文数据分块并生成密文分量。首先，数据拥有者/＞将加密好的数据文件/＞分为v个数据块/＞。从v个数据块中提取出，意味着从每一数据块中都各自提取一定不同的比特数，计算/＞，/＞，剩下的部分为。产生密文分量后，云服务器CS中存入的密文就不再是完整密文，这一步为数据销毁做准备。S302：数据拥有者计算数据块虚拟索引。数据拥有者/＞上传到云服务器CS的数据格式为的元组。以索引为c的消息块/＞作为输入，，计算虚拟索引/＞，上传到云服务器上的数据块使用虚拟索引进行索引存储。S303：数据拥有者计算数据块的标签。数据拥有者/＞的私钥/＞以及虚拟索引为/＞的已加密数据块/＞作为输入，计算数据块标签，而标签具有/＞的签名。/＞选择一个随机的/＞并计算/＞，/＞。其中，/＞是签名时间戳。然后/＞生成相关签名/＞，计算标签/＞。S304：数据拥有者将/＞生成密文分量发送到DHT网络中。由于DHT网络的特点是分布式的，因此要使用秘密共享方案来存储CM。设置密文分量个数为N，取大素数bb，从1到bb的有限域中，选择/＞个数/＞，设置门限值为k，构建v+1个拉格朗日多项式：；；；；计算密文分量，其中/＞。算法选择数据标识SID作为安全伪随机数产生器的种子，生成N个分发索引，然后密文分量关联索引产生N个元组/＞，将所有元组分发到DHT网络节点进行保存。S305：数据拥有者将数据上传到云服务器并向数据用户发送消息。如图3所示，在数据加密存储中，数据拥有者将数据上传到云服务器上，就是将v个的元组/＞也上传至云服务器CS。云服务器对这v个元组进行存储。云服务器和数据拥有者/＞的认证是经过账户注册，输入密码的传统方式进行认证。数据拥有者/＞将/＞发送给数据用户，其中/＞。云服务器CS存储这v个元组以及数据过期时间/＞。数据存储可以基于数据标识符的安全等级实施不同的保存措施，安全等级高的数据设置更长的保存时间或者进行备份。S4：数据处理与数据交换阶段，数据用户获取解密密钥，验证数据完整性，对数据进行解密和使用，具体步骤包括：S401：中心节点HN进行重加密。属性代理重加密意味着可以使用数据用户的属性来重新定义访问结构获取解密密钥。首先是重密钥生成。使用重加密密钥生成算法输出一个单向重加密密钥。输入用户属性，对于/＞所有的属性选择/＞，/＞，计算。其中，Alice和Bob的访问控制结构分别为/＞和/＞，且/＞中包含的属性数不超过/＞中包含的属性数，意味着从数据属性/＞定义的访问控制结构/＞转化为用户属性/＞定义的访问控制结构/＞。每个叶子节点的秘密值为/＞，其中/＞，解密密钥就成了/＞。中心节点HN可以利用一些附加信息将数据属性下加密的密文转换成用户属性下的新密文。中心节点HN重新加密得到密文：，其中/＞是具有数据用户的完全属性的有限集，而/＞。S402：数据用户获取数据。数据用户/＞解密验证的过程，如图4所示，数据用户收到数据拥有者/＞的消息之后，向中心节点HN申请获取密文/＞，/＞上传自身的属性集合，中心节点HN先判断属性集合是否达到阈值，达到后中心节点HN返回/＞给数据用户/＞，用户解密步骤在S404，数据用户/＞解密后获取得到SID和s，SID作为安全伪随机数产生器的种子，生成N个分发索引/＞，从DHT网络中获取密文分量关联索引的N个元组。然后/＞利用SID计算虚拟索引/＞，从云服务器CS中获取v个元组/＞。S403：密文的完整性验证。数据用户先验证提取到的密文分量重新生成的，计算并判断/＞是否等于/＞。然后数据用户/＞验证云服务器CS返回对应的v个元组/＞。数据用户/＞对于每个元组，计算，批量验证等式：。等式的推导如下：通过数据签名和密文数据的标签，数据用户验证了数据的完整性。S404：数据用户解密。当数据用户符合访问策略，已经从DHT网络中获取密文分量关联索引的N个元组/＞，以及从云服务器获取到了v个元组/＞。数据用户/＞可以得到/＞，利用拉格朗日插值法重构出/＞，此时结合/＞和/＞，可以获得完整密文文件/＞。有了密文文件还要有解密密文文件的对称密钥/＞，因此需要获取秘密值/＞，算法如下：先重构，从根节点开始，做递归计算，计算过程中，中间节点的秘密分片的计算形式是将每个子节点的分片基于拉格朗日差值因子做指数运算后，再进行连乘运算。在此补充拉格朗日系数定义：/＞, 其中/＞，/＞是属于/＞的成员集。当x为叶子结点可以直接重构出/＞，当x为非叶子结点，令/＞为x的子结点，/＞，，/＞为拉格朗日系数；计算后续计算出，再根据/＞，可以解出/＞，由于SID有固定长度，数据用户可解出由于解密出密钥为/＞，有了/＞意味着可以将密文文件/＞解密出明文文件M。因此不同数据用户能够访问不同安全级别文件，实现数据生命周期内的细粒度访问控制。S405：数据使用。数据得到明文文件后可以对数据进行操作，操作完成后选择随机数，并用自己的私钥对数据操作进行签名，这个操作可以计入日志。如果这个数据属于保护等级较高的数据，那么对于数据的拷贝和其他方式传播需要进行控制，防止保护等级较高的数据泄露。S5：数据销毁阶段；数据生命周期的最后一环即是数据销毁，这一阶段可以根据数据安全标识进行精细化的销毁控制。具体来说，数据安全标识实现可以与实体数据分开存储，并且数据安全标识已经对数据属性进行显示描述，在数据全生命周期中，可利用其追踪数据的访问情况以及流动情况，由此进行分析处理，而决定数据销毁方式的标准则取决于数据的保密等级、类别等核心信息。根据数据安全等级制定合适的保存时间和数据过期时间，在本实施例中，当文档时间过期，云服务器会实现数据的自动销毁，为了保证数据完全不可恢复，利用了DHT网络节点数据的自动更新功能丢弃所存的密文分量关联的索引元组，使得无法重构出/＞，没有了CM，即使有另一部分/＞，也无法解密出明文，因为只有完整的原始密文/＞，才能用对称密钥/＞解密出明文文件M，这样就实现数据安全自毁。为了保障重要数据的安全性，在数据销毁之前可对其进行数据备份。数据销毁后，其恢复会极其困难，要防止任何重要信息的意外丢失。在数据销毁过程中，必须依据数据的保密等级和类别制定详尽的销毁策略，不同的数据有不同的处理方式，以满足其特定的保密需求。当涉及到高保密等级的文件，采取额外的措施，以保证其被彻底抹除，这类涉密数据，可以执行多次擦写，以确保其无法被恢复。实施例2如图5所示，本实施例提供一种全链路数据安全保护系统，用于实现上述实施例1的全链路数据安全保护方法，该系统包括：初始化模块、密钥生成中心、数据拥有者、数据用户、中心节点、云服务器、DHT网络、标识符构建模块；在本实施例中，初始化模块用于进行密钥生成中心初始化；在本实施例中，密钥生成中心用于生成公开参数、计算验证数据拥有者签名的公钥，为数据用户生成用于签名的私钥；在本实施例中，数据拥有者用于使用自身的身份向密钥生成中心注册，数据拥有者生成私钥，基于私钥对密文进行签名；在本实施例中，数据用户，即数据使用者，用于使用自身的身份向密钥生成中心注册，数据用户基于私钥对操作消息进行签名；在本实施例中，标识符构建模块用于根据客体数据的类别和所属安全等级，构建数据安全标识并校验签发标识符；在本实施例中，中心节点用于获取数据安全属性集合，生成解密密钥，本实施例假设中心节点是诚实可信的，通过用户属性生成用户解密私钥；在本实施例中，数据拥有者用于基于对称加密算法生成对称密钥，基于对称密钥加密明文文件，生成密文文件，所述对称密钥与加密数据的安全属性相关联；在本实施例中，数据拥有者用于对密文文件分块并生成密文分量，计算数据块的虚拟索引和数据标签，将密文分量发送到DHT网络中，将虚拟索引、数据块和数据标签构成的元组上传至云服务器；在本实施例中，中心节点用于基于重加密密钥生成算法进行重加密，生成重加密的密文，数据用户获取密文，解密后得到标识符和秘密值，基于标识符生成多个分发索引，从DHT网络中获取密文分量关联索引的元组；在本实施例中，数据用户用于基于标识符计算虚拟索引，从云服务器中获取由虚拟索引、数据块和数据标签构成的元组，通过数据签名和密文的标签，数据用户进行密文的完整性验证，利用拉格朗日插值法重构出密文分量所对应的密文文件数据块，组合得到完整的密文文件，基于对称密钥解密得到明文文件；在本实施例中，云服务器用于存储由虚拟索引、数据块和数据标签构成的元组，本实施例假设云服务器是不可信但诚实的；在本实施例中，DHT网络，即分布式哈希表网络，是分布式冗余存储的网络，由键值对唯一标识的信息可以分散在多个节点上，用于存储密文分量生成的元组，具有数据自动更新功能，在预设的条件下，基于数据安全标识丢弃所存的密文分量关联的索引元组，自动更新后删除原有数据信息，删除后不可恢复。上述实施例为本发明较佳的实施方式，但本发明的实施方式并不受上述实施例的限制，其他的任何未背离本发明的精神实质与原理下所作的改变、修饰、替代、组合、简化，均应为等效的置换方式，都包含在本发明的保护范围之内。
