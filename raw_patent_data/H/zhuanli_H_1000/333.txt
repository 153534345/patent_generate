标题title
一种基于PUF和可撤销生物特征的高效认证方法
摘要abst
本发明涉及密码技术领域，提供一种基于PUF和可撤销生物特征的高效认证方法，在注册过程中，注册中心为用户端和服务器生成唯一的身份标识，并基于用户端的生物特征数据和设备的PUF响应生成用户端的身份注册信息，通过秘密共享技术的分发过程实现身份注册信息的安全存储和分发，并设置访问限制次数和认证有效期，允许用户端“一次认证，多次访问”；在认证过程中，基于可撤销生物特征模板和秘密共享技术的重构过程实现用户端与服务器的双向认证与密钥协商，为合法用户端安全访问服务器提供保障。当用户端频繁访问服务器时，用户端通过服务器的初步认证、再次认证和最终认证，即可通过验证访问服务器，提高了身份验证的效率和安全性。
权利要求书clms
1.一种基于PUF和可撤销生物特征的高效认证方法，其特征在于，包括：用户端利用PUF和生物特征生成初始标识，根据所述初始标识进行注册，得到与所述用户端绑定的智能卡身份和用户端身份；服务器发起注册请求，获取智能卡身份和所述用户端身份，并利用密钥共享技术与所述用户端生成共享密钥，设置所述用户端的访问限制次数和认证有效期；所述用户端利用所述用户端身份和所述共享密钥生成用户端加密身份，响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果，利用服务器身份认证所述服务器；所述服务器响应于所述用户端的认证结果，利用共享密钥重构可撤销生物特征模板，并利用所述共享密钥和所述用户端身份向所述用户端发起认证，响应于所述用户端根据实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥和所述共享密钥生成的认证信息，认证所述用户端，当认证成功时，更新所述智能卡身份，并设置认证时间戳和访问计数器；当所述用户端再次访问所述服务器时，所述用户端根据本次时间戳、更新后的智能卡身份、所述用户端身份、所述会话密钥和所述共享密钥生成验证信息，将所述验证信息和所述本次时间戳发送至所述服务器；所述服务器根据所述本次时间戳、所述认证时间戳和所述认证有效期进行初步认证，根据所述验证信息进行再次认证，根据所述访问计数器获取的访问次数和所述访问限制次数进行最终认证，根据所述初步认证、所述再次认证和所述最终认证的认证结果允许或拒绝所述用户端的访问请求。2.根据权利要求1所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，在所述用户端根据所述初始标识进行注册之后，包括：注册中心响应于所述用户端的注册请求，生成所述智能卡及对应的所述智能卡身份，并对所述用户端进行身份标识，得到所述用户端身份，利用随机数发生器生成多项式系数构建多项式；所述注册中心将所述初始标识输入所述多项式生成可撤销生物模板；所述注册中心获取随机数，并将所述随机数输入所述多项式，得到份额集合，将所述份额集合拆分得到第一集合和第二集合；所述注册中心将所述集合、所述智能卡身份和所述第一集合存入智能卡后发送至所述用户端；在所述服务器发起注册请求之后，还包括：所述注册中心响应于所述服务器的注册请求，对所述服务器进行身份标识，得到所述服务器身份；所述注册中心设置所述用户端的初始状态，将所述初始状态、所述智能卡身份和所述第二集合发送至所述服务器。3.根据权利要求2所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，所述获取智能卡身份和所述用户端身份，并利用密钥共享技术与所述用户端生成共享密钥，设置所述用户端的访问限制次数和认证有效期，包括：构建用户端访问日志，将所述共享密钥、所述初始状态、所述智能卡身份、所述用户端身份和所述第二集合存入所述用户端访问日志。4.根据权利要求3所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，所述利用所述用户端身份和所述共享密钥生成用户端加密身份，响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果，利用服务器身份认证所述服务器，包括：选取第一随机数，利用所述用户端身份和所述共享密钥生成所述用户端加密身份，将所述第一随机数、所述用户端加密身份和所述智能卡身份发送至所述服务器；响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果、所述服务器根据所述比较结果、所述第一随机数、选取的第二随机数和所述共享密钥生成的第一密文，利用所述用户端身份和所述共享密钥解密所述第一密文得到所述第二随机数，其中，所述第一密文包括服务器加密身份；利用所述服务器加密身份、所述第二随机数和所述共享密钥得到待验证服务器身份，若所述待验证服务器身份标识与所述服务器身份标识相同，则所述服务器认证成功；选取第三随机数，利用所述第三随机数和所述共享密钥加密所述第一集合，利用所述服务器身份和所述共享密钥加密所述第三随机数，得到第二密文，将所述第二密文发送至所述服务器。5.根据权利要求4所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，在所述响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果、所述服务器根据所述比较结果、所述第一随机数、选取的第二随机数和所述共享密钥生成的第一密文之前，还包括：所述服务器根据所述智能卡身份从所述用户端访问日志中检索得到所述用户端身份、所述共享密钥和所述第二集合；所述服务器利用所述共享密钥、所述第一随机数和所述用户端加密身份得到待验证用户端身份；所述服务器比较所述待验证用户端身份和所述用户端身份，若不相同，则终止认证，若相同，则认证所述用户端；所述服务器选取所述第二随机数，利用所述第二随机数、所述用户端加密身份、所述共享密钥和所述第一随机数生成所述第一密文。6.根据权利要求4所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，所述服务器响应于所述用户端的认证结果，利用共享密钥重构可撤销生物特征模板，并利用所述共享密钥和所述用户端身份向所述用户端发起认证，响应于所述用户端根据实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥和所述共享密钥生成的认证信息，认证所述用户端，包括：根据所述服务器身份和所述共享密钥解密所述第二密文得到所述第三随机数，利用所述第三随机数和所述共享密钥恢复所述第一集合；根据所述第一集合和所述第二集合得到所述多项式上的真实点，根据所述真实点构建克莱姆法则求解范德蒙矩阵，求解得到多项式系数，利用所述多项式系数恢复所述多项式；根据重构的多项式、所述第一集合和所述第二集合恢复所述可撤销生物特征模板；选取第四随机数，根据所述用户端身份、所述共享密钥和所述第四随机数加密所述多项式系数，得到第三密文，将所述第三密文发送至所述用户端；响应于所述用户端根据所述第三密文、实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥、所述共享密钥和第五随机数生成的第四密文，利用所述服务器身份和所述共享密钥解密所述第四密文得到所述第五随机数；使用所述用户端身份、所述服务器身份、所述可撤销生物模板、所述第四随机数和解密得到的第五随机数生成所述会话密钥；根据所述会话密钥、所述共享密钥和所述解密得到的第五随机数得到验证密文，比较所述验证密文和所述第四密文，若相同，则所述用户端认证成功；与所述用户端使用所述会话密钥加和/或解密通信数据。7.根据权利要求6所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，在所述响应于所述用户端根据所述第三密文、实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥、所述共享密钥和第五随机数生成的第四密文之前，包括：所述用户端利用所述用户端身份和所述共享密钥解密所述第三密文得到所述第四随机数；所述用户端根据所述第四随机数和所述共享密钥得到所述多项式系数，得到重构多项式；所述用户端利用模糊提取器提取实时生物特征的实时生物密钥，根据所述PUF和所述实时生物密钥生成实时初始标识；所述用户端根据所述重构多项式和所述实时初始标识生成实时可撤销生物特征模板；所述用户端选取所述第五随机数，利用所述用户端身份、所述服务器身份、所述实时可撤销生物特征模板、所述第四随机数和所述第五随机数生成所述会话密钥；所述用户端利用所述服务器身份、所述共享密钥、所述会话密钥和所述第五随机数得到所述第四密文，并将所述第四密文发送至所述服务器。8.根据权利要求6所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，所述与所述用户端使用所述会话密钥加和/或解密通信数据之后，还包括：根据所述第五随机数和所述智能卡身份得到更新后的智能卡身份；设置所述用户端的认证时间戳和访问计数器，其中，所述访问计数器记为0；将所述初始状态更新为认证状态。9.根据权利要求8所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，所述验证信息包括第五密文和第六密文，所述服务器根据所述本次时间戳、所述认证时间戳和所述认证有效期进行初步认证，根据所述验证信息进行再次认证，根据所述访问计数器获取的访问次数和所述访问限制次数进行最终认证，根据所述初步认证、所述再次认证和所述最终认证的认证结果允许或拒绝所述用户端的访问请求，包括：判断所述本次时间戳与所述认证时间戳的差值是否大于所述认证有效期，若是，则拒绝访问，若否，则进行再次认证；根据所述本次时间戳、所述服务器身份和所述第五密文得到恢复智能卡身份；根据所述会话密钥、所述共享密钥、所述恢复智能卡身份和所述本次时间戳生成第六验证密文，比较所述第六验证密文和所述第六密文，若不相同，则拒绝访问，若相同，则进行最终认证；根据所述访问计数器得到所述访问次数，当所述用户端为认证状态，且所述访问次数大于或等于所述访问限制次数时，拒绝所述用户端的访问请求，并将所述用户端的所述认证状态修改为所述初始状态，以使所述用户端重新进行身份认证；当所述用户端为认证状态，且所述访问次数小于所述访问限制次数时，允许所述用户端的访问请求，所述访问计数器计数加一，并利用所述会话密钥将相关数据进行加密后发送至所述用户端。10.根据权利要求2所述的基于PUF和可撤销生物特征的高效认证方法，其特征在于，还包括：所述注册中心响应于所述用户端发出的模板撤销命令时，更改所述多项式系数以更新所述多项式，根据更新的多项式生成新的可撤销生物特征模板，并发送至所述用户端和服务器；当所述智能卡丢失时，所述注册中心响应于所述用户端发出所述智能卡身份和所述初始标识，重新执行注册过程，以生成新的智能卡身份、新的第一集合和新的第二集合，并将所述智能卡身份、所述新的智能卡身份、所述新的第一集合和所述新的第二集合发送至所述服务器以更新所述用户端访问日志。
说明书desc
技术领域本发明涉及密码技术领域，具体而言，涉及一种基于PUF和可撤销生物特征的高效认证方法。背景技术在工业物联网系统中，大量包含设备、产品或用户的数据传递到服务器中进行存储。然而，请求数据资源的实体并不是完全诚实可靠的。恶意实体可能会冒用他人身份访问服务器，故意泄露数据。由于这些数据可能涉及商业或军事机密，这些数据的泄露可能导致合作方机密信息的泄露，给相关部门带来巨大的人员或财力损失。现有的身份认证方案通常采用“一次认证，一次访问”的方式，并不适合用户连续访问服务的场景，例如当用户需要频繁访问服务器资源时，服务器也需要频繁地对用户进行身份认证，在每次认证中，用户必须向服务器证明其身份的合法性，随着访问次数的增加，通信双方的计算和通信开销将大幅增长，生物信息泄露的风险也会大大增加。发明内容本发明解决的问题是如何在保证身份认证安全的前提下，提高身份认证效率。为解决上述问题，本发明提供了一种基于PUF和可撤销生物特征的高效认证方法，包括：用户端利用PUF和生物特征生成初始标识，根据所述初始标识进行注册，得到与所述用户端绑定的智能卡身份和用户端身份；服务器发起注册请求，获取智能卡身份和所述用户端身份，并利用密钥共享技术与所述用户端生成共享密钥，设置所述用户端的访问限制次数和认证有效期；所述用户端利用所述用户端身份和所述共享密钥生成用户端加密身份，响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果，利用服务器身份认证所述服务器；所述服务器响应于所述用户端的认证结果，利用共享密钥重构可撤销生物特征模板，并利用所述共享密钥和所述用户端身份向所述用户端发起认证，响应于所述用户端根据实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥和所述共享密钥生成的认证信息，认证所述用户端，当认证成功时，更新所述智能卡身份，并设置认证时间戳和访问计数器；当所述用户端再次访问所述服务器时，所述用户端根据本次时间戳、更新后的智能卡身份、所述用户端身份、所述会话密钥和所述共享密钥生成验证信息，将所述验证信息和所述本次时间戳发送至所述服务器；所述服务器根据所述本次时间戳、所述认证时间戳和所述认证有效期进行初步认证，根据所述验证信息进行再次认证，根据所述访问计数器获取的访问次数和所述访问限制次数进行最终认证，根据所述初步认证、所述再次认证和所述最终认证的认证结果允许或拒绝所述用户端的访问请求。可选地，在所述用户端根据所述初始标识进行注册之后，包括：注册中心响应于所述用户端的注册请求，生成所述智能卡及对应的所述智能卡身份，并对所述用户端进行身份标识，得到所述用户端身份，利用随机数发生器生成多项式系数构建多项式；所述注册中心将所述初始标识输入所述多项式生成可撤销生物模板；所述注册中心获取随机数，并将所述随机数输入所述多项式，得到份额集合，将所述份额集合拆分得到第一集合和第二集合；所述注册中心将所述集合、所述智能卡身份和所述第一集合存入智能卡后发送至所述用户端；在所述服务器发起注册请求之后，还包括：所述注册中心响应于所述服务器的注册请求，对所述服务器进行身份标识，得到所述服务器身份；所述注册中心设置所述用户端的初始状态，将所述初始状态、所述智能卡身份和所述第二集合发送至所述服务器。可选地，所述获取智能卡身份和所述用户端身份，并利用密钥共享技术与所述用户端生成共享密钥，设置所述用户端的访问限制次数和认证有效期，包括：构建用户端访问日志，将所述共享密钥、所述初始状态、所述智能卡身份、所述用户端身份和所述第二集合存入所述用户端访问日志。可选地，所述利用所述用户端身份和所述共享密钥生成用户端加密身份，响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果，利用服务器身份认证所述服务器，包括：选取第一随机数，利用所述用户端身份和所述共享密钥生成所述用户端加密身份，将所述第一随机数、所述用户端加密身份和所述智能卡身份发送至所述服务器；响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果、所述服务器根据所述比较结果、所述第一随机数、选取的第二随机数和所述共享密钥生成的第一密文，利用所述用户端身份和所述共享密钥解密所述第一密文得到所述第二随机数，其中，所述第一密文包括服务器加密身份；利用所述服务器加密身份、所述第二随机数和所述共享密钥得到待验证服务器身份，若所述待验证服务器身份标识与所述服务器身份标识相同，则所述服务器认证成功；选取第三随机数，利用所述第三随机数和所述共享密钥加密所述第一集合，利用所述服务器身份和所述共享密钥加密所述第三随机数，得到第二密文，将所述第二密文发送至所述服务器。可选地，在所述响应于所述服务器根据所述用户端加密身份与所述用户端身份的比较结果、所述服务器根据所述比较结果、所述第一随机数、选取的第二随机数和所述共享密钥生成的第一密文之前，还包括：所述服务器根据所述智能卡身份从所述用户端访问日志中检索得到所述用户端身份、所述共享密钥和所述第二集合；所述服务器利用所述共享密钥、所述第一随机数和所述用户端加密身份得到待验证用户端身份；所述服务器比较所述待验证用户端身份和所述用户端身份，若不相同，则终止认证，若相同，则认证所述用户端；所述服务器选取所述第二随机数，利用所述第二随机数、所述用户端加密身份、所述共享密钥和所述第一随机数生成所述第一密文。可选地，所述服务器响应于所述用户端的认证结果，利用共享密钥重构可撤销生物特征模板，并利用所述共享密钥和所述用户端身份向所述用户端发起认证，响应于所述用户端根据实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥和所述共享密钥生成的认证信息，认证所述用户端，包括：根据所述服务器身份和所述共享密钥解密所述第二密文得到所述第三随机数，利用所述第三随机数和所述共享密钥恢复所述第一集合；根据所述第一集合和所述第二集合得到所述多项式上的真实点，根据所述真实点构建克莱姆法则求解范德蒙矩阵，求解得到多项式系数，利用所述多项式系数恢复所述多项式；根据重构的多项式、所述第一集合和所述第二集合恢复所述可撤销生物特征模板；选取第四随机数，根据所述用户端身份、所述共享密钥和所述第四随机数加密所述多项式系数，得到第三密文，将所述第三密文发送至所述用户端；响应于所述用户端根据所述第三密文、实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥、所述共享密钥和第五随机数生成的第四密文，利用所述服务器身份和所述共享密钥解密所述第四密文得到所述第五随机数；使用所述用户端身份、所述服务器身份、所述可撤销生物模板、所述第四随机数和解密得到的第五随机数生成所述会话密钥；根据所述会话密钥、所述共享密钥和所述解密得到的第五随机数得到验证密文，比较所述验证密文和所述第四密文，若相同，则所述用户端认证成功；与所述用户端使用所述会话密钥加和/或解密通信数据。可选地，在所述响应于所述用户端根据所述第三密文、实时生物特征得到的实时生物特征模板生成的会话密钥、所述用户端根据所述会话密钥、所述共享密钥和第五随机数生成的第四密文之前，包括：所述用户端利用所述用户端身份和所述共享密钥解密所述第三密文得到所述第四随机数；所述用户端根据所述第四随机数和所述共享密钥得到所述多项式系数，得到重构多项式；所述用户端利用模糊提取器提取实时生物特征的实时生物密钥，根据所述PUF和所述实时生物密钥生成实时初始标识；所述用户端根据所述重构多项式和所述实时初始标识生成实时可撤销生物特征模板；所述用户端选取所述第五随机数，利用所述用户端身份、所述服务器身份、所述实时可撤销生物特征模板、所述第四随机数和所述第五随机数生成所述会话密钥；所述用户端利用所述服务器身份、所述共享密钥、所述会话密钥和所述第五随机数得到所述第四密文，并将所述第四密文发送至所述服务器。可选地，所述与所述用户端使用所述会话密钥加和/或解密通信数据之后，还包括：根据所述第五随机数和所述智能卡身份得到更新后的智能卡身份；设置所述用户端的认证时间戳和访问计数器，其中，所述访问计数器记为0；将所述初始状态更新为认证状态。可选地，所述验证信息包括第五密文和第六密文，所述服务器根据所述本次时间戳、所述认证时间戳和所述认证有效期进行初步认证，根据所述验证信息进行再次认证，根据所述访问计数器获取的访问次数和所述访问限制次数进行最终认证，根据所述初步认证、所述再次认证和所述最终认证的认证结果允许或拒绝所述用户端的访问请求，包括：判断所述本次时间戳与所述认证时间戳的差值是否大于所述认证有效期，若是，则拒绝访问，若否，则进行再次认证；根据所述本次时间戳、所述服务器身份和所述第五密文得到恢复智能卡身份；根据所述会话密钥、所述共享密钥、所述恢复智能卡身份和所述本次时间戳生成第六验证密文，比较所述第六验证密文和所述第六密文，若不相同，则拒绝访问，若相同，则进行最终认证；根据所述访问计数器得到所述访问次数，当所述用户端为认证状态，且所述访问次数大于或等于所述访问限制次数时，拒绝所述用户端的访问请求，并将所述用户端的所述认证状态修改为所述初始状态，以使所述用户端重新进行身份认证；当所述用户端为认证状态，且所述访问次数小于所述访问限制次数时，允许所述用户端的访问请求，所述访问计数器计数加一，并利用所述会话密钥将相关数据进行加密后发送至所述用户端。可选地，所述基于PUF和可撤销生物特征的高效认证方法还包括：所述注册中心响应于所述用户端发出的模板撤销命令时，更改所述多项式系数以更新所述多项式，根据更新的多项式生成新的可撤销生物特征模板，并发送至所述用户端和服务器；当所述智能卡丢失时，所述注册中心响应于所述用户端发出所述智能卡身份和所述初始标识，重新执行注册过程，以生成新的智能卡身份、新的第一集合和新的第二集合，并将所述智能卡身份、所述新的智能卡身份、所述新的第一集合和所述新的第二集合发送至所述服务器以更新所述用户端访问日志。本发明中，基于用户端的生物特征数据和设备的PUF响应生成隐藏生物特征模板的身份注册信息，通过秘密共享技术的分发过程实现身份注册信息的安全存储和分发，并设置所述用户端的访问限制次数和认证有效期，允许用户端“一次认证，多次访问”，为后续认证过程的执行奠定基础；基于生物特征模板和秘密共享技术的重构过程实现了用户端与服务器的双向认证与密钥协商，防止恶意用户端发起冒充、密码猜测、中间人等多种攻击，为合法用户端安全访问服务器提供保障。当用户端紧急情况下需要频繁访问服务器时，只要用户端通过服务器的初步认证、再次认证和最终认证，即访问次数和时间戳分别满足访问限制次数和认证有效期，认证信息通过服务器的认证，用户端即可通过验证访问服务器，无需重复整个认证过程即可实现快速访问，有效避免多次认证带来的安全风险，提高了身份验证的安全性，也有效降低了物联网设备多次认证的计算开销和通信开销。附图说明图1为本发明实施例的基于PUF和可撤销生物特征的高效认证方法的流程示意图；图2为本发明实施例的基于PUF和可撤销生物特征的高效认证方法的系统的结构示意图；图3为本发明实施例与其它三种方案在一次认证过程中计算开销的对比结果；图4为本发明实施例与其它三种方案在多次访问过程中计算开销的对比结果；图5为本发明实施例与其它三种方案在一次身份认证过程中通信开销的对比结果；图6为本发明实施例与其它三种方案在多次访问过程中通信开销的对比结果。具体实施方式为使本发明的上述目的、特征和优点能够更为明显易懂，下面结合附图对本发明的具体实施例做详细的说明。在本发明实施例的描述中，术语“一些实施例”的描述意指结合该实施例或示例描述的具体特征、结构、材料或特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不一定指的是相同的实施或实例。而且，描述的具体特征、结构、材料或特点可以在任何的一个或多个实施例或示例中以合适的方式结合。应当理解，本发明的方法实施方式中记载的各个步骤可以按照不同的顺序执行，和/或并行执行。此外，方法实施方式可以包括附加的步骤和/或省略执行示出的步骤。本发明的范围在此方面不受限制。本文使用的术语“包括”及其变形是开放性包括，即“包括但不限于”。术语“基于”是“至少部分地基于”。术语“一个实施例”表示“至少一个实施例”；术语“另一实施例”表示“至少一个另外的实施例”；术语“一些实施例”表示“至少一些实施例”；术语“可选地”表示“可选的实施例”。其他术语的相关定义将在下文描述中给出。需要注意，本发明中提及的“第一”、“第二”等概念仅用于对不同的装置、模块或单元进行区分，并非用于限定这些装置、模块或单元所执行的功能的顺序或者相互依存关系。需要注意，本发明中提及的“一个”、“多个”的修饰是示意性而非限制性的，本领域技术人员应当理解，除非在上下文另有明确指出，否则应该理解为“一个或多个”。可以理解的是，本发明中涉及到的任何关于数据获取或采集的部分，均已获得用户授权。如图1所示，本发明提供了一种基于PUF和可撤销生物特征的高效认证方法，包括：注册过程：用户端利用PUF和生物特征生成初始标识，根据所述初始标识进行注册，得到与所述用户端绑定的智能卡身份和用户端身份，包括：注册中心对用户端、服务器和智能卡进行身份标识，响应于所述用户端和所述服务器的注册请求，以及所述用户端根据PUF和所述生物特征生成的初始标识，生成可撤销生物特征模板，并将智能卡和用户端身份发送至所述用户端，将所述智能卡身份和服务器身份和所述服务器。具体地，在注册中心C进行注册过程之前，用户端向注册中心C发起注册请求：用户端首次获取的生物特征信息Bio引入模糊提取器中，模糊提取器根据生物特征信息生成生物密钥Ci和辅助数据P，表示为：=FE.Gen。生物密钥Ci利用PUF生成初始标识Ri，表示为：Ri=PUFi，用户端将初始标识发送至注册中心C，发起注册请求。服务器直接向注册中心C发起注册请求。需要说明的是，智能卡中存储着用户端的身份注册信息，当进行验证时，用户将智能卡插入响应装置，则响应装置可将携带生物特征等的认证信息发送至服务器进行验证。注册中心在接收到用户端的注册请求后，首先生成与用户端绑定的智能卡，并对该智能卡进行身份标识，得到智能卡身份IDSC，而后对所述用户进行身份标识，得到所述用户身份IDi，并利用随机数发生器生成多项式系数a0,…,at-1构建t-1次多项式：f=a0+a1x+…+at-1xt-1。将所述初始标识Ri输入所述多项式f生成可撤销生物模板pf=f，并将f视作秘密。而后注册中心C执行秘密分发过程，即获取t+1个随机数x1,…,xt+1，并将所述随机数x1,…,xt+1输入所述多项式f，得到t+1个二维平面上的点)，…，)，)，构成份额集合，将所述份额集合拆分得到第一集合和第二集合，第一集合包含份额S1=x1，…，St=xt, St+1=xt+1，第二集合包含份额St+2=f，…，S2t+1=f，S2t+2=f+f，其中S1,…,St和St+2,…,S2t+1用于在后续认证过程中恢复多项式系数。注册中心将所述智能卡身份IDSC和所述第一集合存入智能卡后分发给所述用户端，用于后续的身份认证。服务器发起注册请求，获取智能卡身份和所述用户端身份，并利用密钥共享技术与所述用户端生成共享密钥，设置所述用户端的访问限制次数和认证有效期，包括：注册中心在接收到服务器的注册请求后，对所述服务器进行身份标识，得到所述服务器身份IDS；设置所述用户端的初始状态Auth_state，将所述初始状态Auth_state、所述用户端身份IDi、所述智能卡身份IDSC和所述第二集合发送至所述服务器。所述服务器利用密钥共享技术与所述用户端生成共享密钥SViS并设置所述用户端的访问限制次数b和认证有效期△T。而后所述服务器构建用户端访问日志LOG，将所述共享密钥SViS、所述初始状态Auth_state、所述智能卡身份IDSC、所述用户端身份IDi和所述第二集合存入所述用户端访问日志LOG，并将所述初始状态Auth_state调制为0，即Auth_state=0。需要说明的是，注册过程的交互信息在安全信道中传输。所述用户端身份IDi、所述共享密钥SViS均存储于所述用户端的一次可编程非易失性存储器中，用于后续的身份认证。用户端与服务器相互认证与密钥协商过程：为了实现身份认证和会话密钥协商，服务器解密用户端发来的集合并重新构建多项式，利用重构的多项式和集合来恢复注册中心生成的可撤销生物特征模板pf；而用户端利用重构的多项式和实时生物特征重新生成可撤销的实时生物特征模板pf'，实时生物特征模板pf'将用于生成会话密钥SSKiS，认证过程中的交互信息在公开信道中传输，具体认证过程包括：所述用户端利用所述用户端身份和所述共享密钥生成用户端加密身份，响应于所述服务器根据所述用户端加密身份与用户端身份的比较结果，利用服务器身份认证所述服务器，包括：用户端将智能卡插入读卡器，利用所述共享密钥和所述用户端身份IDi生成用户端加密身份PIDi，表示为：，其中，h表示哈希函数。选取第一随机数n0，将所述第一随机数n0、所述用户端加密身份PIDi和所述智能卡身份IDSC发送至所述服务器，即将认证请求＜IDSC, n0, PIDi＞发送至服务器。服务器收到认证请求＜IDSC, n0, PIDi＞后，根据所述智能卡身份IDSC从所述用户端访问日志LOG中检索得到所述用户端身份IDi、所述共享密钥SViS和所述第二集合；利用所述共享密钥SViS、所述第一随机数n0和所述用户端加密身份PIDi得到待验证用户端身份IDi'，表示为：；比较所述待验证用户端身份IDi'和所述用户端身份IDi，若不相同，则终止认证，即认证不通过，若相同，则认证所述用户端；认证成功后，选取所述第二随机数n1，利用所述第二随机数n1、所述共享密钥SViS和所述份额S2t+2生成所述第一密文＜M1，M2，PIDS＞，第一密文包括服务器加密身份PIDS、M1和M2，PIDS表示为：/＞、M1表示为：/＞，M2表示为/＞。将第一密文发送至用户端。用户端利用所述用户端身份IDi和所述共享密钥SViS解密所述第一密文＜M1，M2，PIDS＞得到所述第二随机数n1，表示为：；利用所述服务器加密身份PIDS、所述第二随机数n1和所述共享密钥SViS得到待验证服务器身份IDi'，表示为：/＞；若所述待验证服务器身份IDi'与所述服务器身份IDS相同，则所述服务器认证成功，若不相同，则终止认证。当认证成功时，选取第三随机数n2，利用所述第三随机数n2和所述共享密钥SViS加密所述第一集合，利用所述服务器身份IDS和所述共享密钥SViS加密所述第三随机数n2，得到第二密文＜E1,…,Et+2＞，具体表示为：/＞，/＞，，/＞。将所述第二密文＜E1,…,Et+2＞发送至所述服务器。需要说明的是，在本发明实施例中，若服务器与用户端之间的信息传输无干扰，则服务器选取的第二随机数和用户端解密得到的第二随机数相同。若服务器与用户端之间的信息传输有干扰，则服务器选取的第二随机数和用户端解密得到的第二随机数不相同，则在后续的认证过程中，或导致认证失败。所述服务器响应于所述用户端的认证结果，利用共享密钥重构所述可撤销生物特征模板，并利用所述共享密钥和所述用户端身份向所述用户端发起认证，响应于所述用户端根据实时指纹信息得到的实时生物特征模板生成的会话密钥，以及根据所述会话密钥和所述共享密钥生成的认证信息认证所述用户端，当认证成功时，更新所述智能卡身份，并设置认证时间戳和访问计数器，具体包括：服务器根据所述服务器身份IDS和所述共享密钥SViS解密所述第二密文＜E1,…,Et+2＞得到所述第三随机数n2，利用所述第三随机数n2和所述共享密钥SViS恢复所述第一集合，表示为：，/＞，/＞，；根据所述第一集合和所述第二集合得到所述多项式f上的t个真实点,…,，根据所述真实点,…,构建克莱姆法则求解范德蒙矩阵：，根据克莱姆法则求解范德蒙矩阵得到多项式系数a0,…,at-1，利用所述多项式系数a0,…,at-1重构所述多项式f；根据重构的多项式f、所述第一集合和所述第二集合计算f，恢复可撤销生物特征模板pf=f=S2t+2-f；选取第四随机数n3，根据所述用户端身份IDi、所述共享密钥SViS和所述第四随机n3数加密所述多项式系数a0,…,at-1，得到第三密文＜M3,…,Mt+3＞，表示为：，/＞，，/＞；将所述第三密文＜M3,…,Mt+3＞发送至所述用户端。用户端利用所述用户端身份IDi和所述共享密钥SViS解密所述第三密文中的M3得到所述第四随机数n3，表示为：；根据所述第四随机数n3和所述共享密钥SViS得到用户端中的多项式系数a0',…,at-1'，以得到重构多项式f '，表示为：，/＞，/＞；利用模糊提取器FE提取实时生物特征Bio'的实时生物密钥Ci'和辅助数据P，表示为：/＞，根据所述PUF和所述实时生物密钥Ci'生成实时初始标识Ri'，表示为：/＞；根据所述重构多项式f'和所述实时初始标识Ri'生成实时可撤销生物特征模板pf’=f '；选取所述第五随机数n4，利用所述用户端身份IDi、所述服务器身份IDS、所述实时可撤销生物特征模板pf’、所述第四随机数n3和所述第五随机数n4生成所述会话密钥SSKiS，表示为：；利用所述服务器身份IDS、所述共享密钥SViS、所述会话密钥SSKiS和所述第五随机n4数得到所述第四密文＜Et+3, Et+4＞，表示为：/＞，，并将所述第四密文＜Et+3, Et+4＞发送至所述服务器。服务器利用所述服务器身份IDS和所述共享密钥SViS解密所述第四密文＜Et+3, Et+4＞得到所述第五随机数n4，表示为：；使用所述用户端身份IDi、所述服务器身份IDS、可撤销生物模板pf、所述第四随机数n3和解密得到的第五随机数n4生成所述会话密钥SSKiS'，表示为：/＞，需要说明的是，该会话密钥为服务器生成的会话密钥与用户端生成的会话密钥SSKiS相同；根据所述会话密钥SSKiS'、所述共享密钥SViS和所述解密得到的第五随机数n4得到验证密文Et+4'，比较所述验证密文Et+4'和所述第四密文中的Et+4，若Et+4'与Et+4相同，则所述用户端认证成功，若不相同，则终止认证。当用户端和服务器均认证成功时，根据所述第五随机数n4和所述智能卡身份IDSC得到更新后的智能卡身份IDSC'，表示为：IDSC'=IDSC⊕n4。服务器设置所述用户端的认证时间戳T和访问计数器counti=0，将所述初始状态Auth_state=0更新为认证状态Auth_state=1。服务器和用户端使用所述会话密钥SSKiS'=SSKiS加和/或解密通信数据。多次访问场景下用户端身份认证过程：当所述用户端进行再次访问所述服务器时，所述用户端根据本次时间戳T1、所述更新后的智能卡身份IDSC'、所述用户端身份IDi、所述会话密钥SSKiS和所述共享密钥SViS生成验证信息，验证信息包括第五密文Et+5=IDSC'⊕h和第六密文Et+6=h，将Et+5、Et+6和所述本次时间戳T1发送至所述服务器。所述服务器根据所述本次时间戳T1、所述认证时间戳T和所述认证有效期△T进行初步认证，根据所述验证信息Et+5、Et+6进行再次认证，根据所述访问计数器获取的访问次数counti和所述访问限制次数b进行最终认证，根据所述初步认证、所述再次认证和所述最终认证的认证结果允许或拒绝所述用户端的访问请求，包括：判断所述本次时间戳T1与所述认证时间戳T的差值是否大于所述认证有效期△T，若是，则服务器拒绝该用户端访问，若否，则进行再次认证；根据所述本次时间戳T1、所述服务器身份IDS和所述第五密文Et+5得到恢复智能卡身份IDSC''，表示为：IDSC''=Et+5⊕h；根据恢复智能卡身份IDSC''检索用户端访问日志LOG，根据所述会话密钥SSKiS、所述共享密钥SViS、所述恢复智能卡身份IDSC''和所述本次时间戳T1生成第六验证密文Et+6'，表示为：Et+6'=h；比较所述第六验证密文Et+6'和所述第六密文Et+6，若不相同，则拒绝用户端访问，若相同，则进行最终认证；根据所述访问计数器得到所述访问次数counti，当所述用户端为认证状态，即Auth_state=1，且所述访问次数counti大于或等于所述访问限制次数时，即counti≥b，服务器拒绝所述用户端的访问请求，并将所述用户端的所述认证状态Auth_state=1修改为所述初始状态Auth_state=0，以使所述用户端重新进行身份认证；当所述用户端为认证状态，即Auth_state=1，且所述访问次数小于所述访问限制次数时，即counti＜b，允许所述用户端的访问请求，所述访问计数器计数加一，即counti=counti+1，并利用所述会话密钥SSKiS将相关数据进行加密后发送至所述用户端。生物模板撤销过程：在完成验证后，若用户端想要撤销可撤销生物模板时，所述注册中心更改所述多项式系数中的一个或多个系数以更新所述多项式，根据更新的多项式生成新的可撤销生物特征模板，并发送至所述用户端和服务器。当所述智能卡丢失时，用户端将进行注册时的智能卡身份IDSC和初始标识Ri发送至注册中心，注册中心根据所述智能卡身份IDSC和所述初始标识Ri，重新执行注册过程，以生成新的智能卡身份、新的第一集合和新的第二集合，并将所述智能卡身份、所述新的智能卡身份、所述新的第一集合和所述新的第二集合发送至所述服务器以更新所述用户端访问日志。另外地，如图2所示，为应用本实施例基于PUF和可撤销生物特征的高效认证方法的系统的结构图，本实施例以用户端UDi进行说明，但在实际应用中，也可与其他用户端进行使用。为了验证本实施例的有效性，采用本实施例和Chatterjee方案、Gaba方案和Bian方案在计算和通信上的开销。如图3所示，为本实施例与其它三种方案在一次认证过程中计算开销的对比结果。在一次身份认证过程中，Chatterjee方案的计算开销最低，约为1.74ms；Bian方案的计算开销最高，约为338.44ms。本实施例包括轻量级哈希操作、标量乘法以及模糊提取器的重构操作等，认证阶段的执行大约需要290.18ms，接近Gaba方案所涉及的时间开销。图4为本实施例与其它三种方案在多次访问过程中计算开销的对比结果。由图4所示的实验结果可知，在一次认证后的多次访问过程中，本发明显示出最小的计算开销，即k×4Th，其中k是访问次数，Th为一次哈希操作的运行时间，而其它三种认证方案的计算开销远高于本实施例。图5为本实施例与其它三种方案在一次身份认证过程中通信开销的对比结果。由图5可知，本实施例中的用户端和服务器在认证过程中总共传输了3904比特数据，高于其它三种方案的通信开销。对于大多数实际应用来说，本实施例的通信成本仍然在可接受范围内。图6为本发明与其它三种方案在多次访问过程中通信开销的对比结果。由图6所示的实验结果可知，在一次认证后的多次访问过程中，本实施例的通信开销最低，为k×，其中|x|为x的比特长度，而其它三种方案的通信成本远高于本实施例。因此，本实施例在保证安全性的同时，从计算和通信两个方面提高了多次认证的效率。虽然本发明披露如上，但本发明的保护范围并非仅限于此。本领域技术人员在不脱离本发明的精神和范围的前提下，可进行各种变更与修改，这些变更与修改均将落入本发明的保护范围。
