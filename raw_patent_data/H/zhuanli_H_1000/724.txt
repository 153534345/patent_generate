标题title
基于回归和时序融合的光伏发电功率/量预测方法及设备
摘要abst
本发明的一种基于回归和时序融合的光伏发电功率/量预测方法及设备，方法包括构建模型：发电量预测模型是深度神经网络模型；预训练：使用大量光场数据集对发电量进行预训练，旨在让模型了解光伏发电场站的一般趋势和关联性；微调：预训练后，将模型应用于本任务的发电量数据，以微调模型，使其适应场景一的具体特点和要求。本发明采用了直方图梯度提升回归等模型和基于Transformer的时序预测模型，通过加权融合二者的预测结果，并采用自适应学习的方式优化组合系数，从而有效提升模型性能。该方法具有高准确性、鲁棒性和自动特征选择的优点；其可解释性强，能够输出特征的重要性排序，助于理解哪些特征对预测结果有更大影响。
权利要求书clms
1.一种基于回归和时序融合的光伏发电功率/量预测方法，其特征在于，包括以下步骤：S1、数据处理与特征工程；数据处理包括对收集到的光伏发电场站的历史功率数据、气象数据及相关时间数据进行处理；特征工程部分包括提取与发电功率相关的时间、日期和季节信息，以及气象因素；S2、预测模型的构建与应用；结合了直方图梯度提升回归模型HGBR和基于Transformer的时序预测模型；HGBR模型用于短期功率预测，能够处理时间序列数据的特殊性质；Transformer模型则用于长期功率趋势的预测；S3、模型验证与优化；通过使用实际功率输出数据对所构建的模型进行验证和调整，模型验证过程包括对比预测结果与实际数据，以及根据反馈调整模型参数；最后采用优化后的模型对光伏发电功率/量进行预测。2.根据权利要求1所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：步骤S1中数据处理包括：异常值处理即使用统计学方法识别数据中的异常值，针对不同种类的异常分别采取删除、用中位数或平均值替换离群点检测算法进行处理；缺失值处理即使用随机森林算法填补光伏发电场站历史功率数据中的缺失值，对于环境参数，采用多重插补法进行处理；引入损耗系数即针对预测长时间发电量对应设计了损耗系数特征，提高了模型性能。3.根据权利要求1所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：步骤S1中的特征工程包括根据光伏发电的特点，提取与发电量密切相关的时间序列特征，这些特征包括月份、日、小时、分钟、一天中的分钟数、一周中的天数、一年中的天数、星期几、时间段，同时，考虑季节性因素，包括季节、月初、月末、季度初、季度末及周末的标记。4.根据权利要求1所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：步骤S1中还包括数据归一化即对所有数值型特征进行归一化处理，以消除不同量级数据间的影响，归一化方法包括最小-最大标准化和Z分数标准化。5.根据权利要求1所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：步骤S2包括模型选择与训练，具体如下，模型选择：采用直方图梯度提升回归模型HGBR、基于Transformer的时序预测模型、随机森林、深度神经网络DNN，以及Informer模型，最后分别采用Attention融合、Stacking策略来融合最终预测结果；其中直方图梯度提升回归模型HGBR用于处理复杂的非线性关系，Transformer的时序预测模型优化长期趋势预测，随机森林和深度神经网络DNN用于特征提取和预测，Informer模型则应用于时序预测；模型训练：使用预处理的数据集进行训练，对每个模型进行参数调整和优化；直方图梯度提升回归模型HGBR和随机森林模型通过分箱和直方图表示特征分布进行训练；Transformer的时序预测模型和Informer模型利用自注意力机制处理时间序列数据，深度神经网络DNN用于提取复杂特征。6.根据权利要求5所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：在发电功率/发电量预测中，随机森林的构造过程如下：①假如有N个样本，则有放回的随机选择个样本即每次随机选择一个样本，然后返回继续选择；这选择好了的个样本用来训练一个决策树，作为决策树根节点处的样本；②当每样本有M个属性时，在决策树的每个节点需要分裂时，随机以这M个属性中选取出m个属性，满足条m＜M，然后以这m个属性中采用设定的策略来选择1个属性作为该节点的分裂属性；③决策树形成过程中每个节点都要按照步骤②分裂，如果下一次该节点选出来的那一个属性是刚刚其父节点分裂时用过的属性，则该节点已经达到了叶子节点，无须继续分裂，一直到不能够再分裂为止，整个决策树形成过程中没有进行剪枝；④按照步骤①-③建立大量的决策树，这样就构成了随机森林。7.根据权利要求5所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：Informer模型的训练过程：①输入数据构建：将输入的序列数据进行切分，并进行时间序列的构建；②遮盖或替换：在构建的时间窗口中，对其中的指定元素进行遮盖或替换，形成辅助任务；③辅助任务的训练：将遮盖或替换后的时间窗口作为输入，通过模型的预测能力来恢复遮盖或替换的元素；④主任务的训练：在辅助任务的训练完成后，继续使用原始的序列数据进行主任务的训练。8.根据权利要求5所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：在发电量预测中，深度神经网络DNN的训练过程如下：①加载数据：对数据进行加载、处理，创建数据加载器，将整块数据用数据加载器处理成小块形式，后续进行迭代循环，并输入到模型中进行训练；②定义网络格式：随后定义自己的模型，并实例化，随后定义使用的损失函数、优化器；③训练、验证和测试：训练之前设置随机固定的随机种子，保证可复现性；参数调整和交叉验证：对每个模型的关键参数进行调整，包括学习率、树的数量、层数和头的数量，并使用交叉验证来评估模型的准确性和泛化能力。9.根据权利要求1所述的基于回归和时序融合的光伏发电功率/量预测方法，其特征在于：在发电功率/发电量模型得到预测结果后，采用了三次样条插值的方法进行非预测点上采样，包括：定义：设区间上给定一个剖分：为/＞上满足下列条件的函数：；在每个子区间/＞上是三次多项式那么称/＞为关于剖分/＞的一个三次样条函数，如果再给定某个函数 /＞在剖分的节点上的函数值；，且满足插值条件；那么称为/＞在/＞上关于剖分/＞的三次样条插值函数；利用三次样条插值函数来对生成的预测数据进行相应的插值，最后数据量会增大到四倍。10.一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，所述计算机程序被所述处理器执行时，使得所述处理器执行如权利要求1至9中任一项所述方法的步骤。
说明书desc
技术领域本发明涉及光伏发电预测技术领域，具体涉及一种基于回归和时序融合的光伏发电功率/量预测方法及设备。背景技术光伏发电作为一种清洁、可再生的能源，在全球范围内得到了迅速发展。随着光伏技术的不断进步和成本的降低，光伏发电的装机容量逐年增加，对电网的影响日益显著。然而，光伏发电具有高度的不确定性和可变性，主要因素包括太阳辐射的波动、气候条件的变化和设备的性能。因此，准确预测光伏发电功率成为电力系统运行和管理中的一个重要课题。传统的光伏发电预测方法主要基于物理模型，例如气象模型和光伏系统的性能模型。这些方法依赖于精确的气象数据和设备参数，但在实际应用中面临数据获取困难、计算成本高、适应性差等问题。随着气候变化和环境复杂性的增加，这些传统方法在预测准确性和稳定性方面面临着挑战。近年来，随着大数据技术和人工智能的发展，机器学习在光伏发电预测中显示出了巨大的潜力。机器学习方法能够处理大量的历史数据，从中学习模式和趋势，以预测未来的发电量。这些方法不仅可以提高预测的准确性，还可以在数据缺失或不完整的情况下提供有效的预测。机器学习在光伏发电预测中的应用包括多种算法，如人工神经网络、支持向量机、随机森林和深度学习等。这些算法具有处理复杂、非线性数据的能力，能够适应不同的气象条件和设备特性。此外，机器学习方法还可以结合传统的物理模型，提供更为准确和可靠的预测。然而，机器学习方法在光伏发电预测中也面临着一些挑战。例如，模型的过度拟合、数据质量的影响、以及算法的透明度和可解释性。这些问题需要通过更精细的数据处理、模型优化和算法创新来解决。综上所述，光伏发电功率预测技术正在从传统的物理模型向基于数据驱动的机器学习方法转变。这一转变为提高预测准确性、降低运营成本和优化电网管理提供了新的可能性，同时也带来了新的技术挑战。发明内容本发明提出的一种基于回归和时序融合的光伏发电功率/量预测方法、设备及存储介质，可至少解决背景技术中的技术问题之一，此方法旨在解决传统光伏发电预测中存在的不准确性和不稳定性问题，提供更为精确和可靠的预测结果。为实现上述目的，本发明采用了以下技术方案：一种基于回归和时序融合的光伏发电功率/量预测方法，包括以下步骤，步骤1，数据处理与特征工程：本发明首先对收集到的光伏发电场站的历史功率数据、气象数据及相关时间数据进行处理。这包括使用随机森林算法处理数据中的缺失值，并对数据进行归一化。特征工程部分涉及提取与发电功率相关的时间、日期和季节信息，以及气象因素如温度、湿度等；步骤2，预测模型的构建与应用；本发明结合了直方图梯度提升回归模型和基于Transformer的时序预测模型。HGBR模型用于短期功率预测，能够处理时间序列数据的特殊性质。Transformer模型则用于长期功率趋势的预测，利用其强大的时序数据处理能力来提高预测的准确度；步骤3，模型验证与优化；通过使用实际功率输出数据对所构建的模型进行验证和调整，本发明进一步提升了预测模型的准确性和适应性。模型验证过程包括对比预测结果与实际数据，以及根据反馈调整模型参数。又一方面，本发明还公开一种计算机可读存储介质，存储有计算机程序，所述计算机程序被处理器执行时，使得所述处理器执行如上述方法的步骤。再一方面，本发明还公开一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，所述计算机程序被所述处理器执行时，使得所述处理器执行如上方法的步骤。由上述技术方案可知，本发明提供了一种基于时序预测和回归预测相结合的光伏发电预测方法，旨在提高发电功率/发电量预测的准确性和可靠性。该方法采用了直方图梯度提升回归等模型和基于Transformer的时序预测模型，通过加权融合二者的预测结果，并采用自适应学习的方式优化组合系数，从而有效提升模型性能。该方法具有高准确性、鲁棒性和自动特征选择的优点。其可解释性强，能够输出特征的重要性排序，助于理解哪些特征对预测结果有更大影响。这一技术的实施在发电功率/发电量预测方面取得了显著成效。本发明的核心创新在于综合利用了多种先进的机器学习技术来解决光伏发电预测中的关键问题。这不仅提高了预测的准确性，也增强了模型的适应性和可靠性，对光伏发电领域的发展具有重要意义。附图说明图1为本发明实施例发电功率预测系统框图；图2为本发明实施例发电量预测系统框图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。如图1和图2所示，本实施例所述的基于回归和时序融合的光伏发电功率/量预测方法，包括以下步骤，步骤一，数据处理与特征工程：本发明首先对收集到的光伏发电场站的历史功率数据、气象数据及相关时间数据进行处理。这包括使用随机森林算法处理数据中的缺失值，并对数据进行归一化。特征工程部分涉及提取与发电功率相关的时间、日期和季节信息，以及气象因素如温度、湿度等。步骤二，预测模型的构建与应用；本发明结合了直方图梯度提升回归模型和基于Transformer的时序预测模型。HGBR模型用于短期功率预测，能够处理时间序列数据的特殊性质。Transformer模型则用于长期功率趋势的预测，利用其强大的时序数据处理能力来提高预测的准确度。步骤三，模型验证与优化；通过使用实际功率输出数据对所构建的模型进行验证和调整，本发明进一步提升了预测模型的准确性和适应性。模型验证过程包括对比预测结果与实际数据，以及根据反馈调整模型参数。以下分别具体说明：步骤1，数据预处理，其中包含：异常值处理：使用如箱线图等统计学方法识别数据中的异常值，针对不同种类的异常分别采取删除、用中位数或平均值替换等离群点检测算法进行处理。缺失值处理：使用随机森林算法填补光伏发电场站历史功率数据中的缺失值。对于环境参数，采用多重插补法进行处理。这些方法可以有效减少缺失数据对模型预测性能的影响；引入损耗系数：考虑到设备性能会随着时间有一定损耗，本发明针对预测长时间发电量这个特定问题设计了损耗系数特征，有效提高了模型性能。特征工程：根据光伏发电的特点，提取与发电量密切相关的时间序列特征；这些特征包括月份、日、小时、分钟、一天中的分钟数、一周中的天数、一年中的天数、星期几、时间段等。同时，考虑季节性因素，如季节、月初、月末、季度初、季度末及周末的标记。数据归一化：对所有数值型特征进行归一化处理，以消除不同量级数据间的影响。常用的归一化方法包括最小-最大标准化和Z分数标准化。步骤2，模型选择与训练，其中包含：模型选择：采用直方图梯度提升回归、基于Transformer的时序预测模型、随机森林、深度神经网络，以及Informer模型。最后分别采用Attention融合、Stacking等策略来融合最终预测结果。其中HGBR用于处理复杂的非线性关系，Transformer模型优化长期趋势预测，随机森林和DNN用于特征提取和预测，Informer模型则应用于时序预测；模型训练：使用预处理的数据集进行训练，对每个模型进行参数调整和优化。HGBR和随机森林模型通过分箱和直方图表示特征分布进行训练。Transformer模型和Informer模型利用自注意力机制处理时间序列数据。DNN用于提取复杂特征。在发电功率/发电量预测中，随机森林的构造过程如下：①假如有N个样本，则有放回的随机选择个样本。这选择好了的个样本用来训练一个决策树，作为决策树根节点处的样本。②当每样本有M个属性时，在决策树的每个节点需要分裂时，随机以这M个属性中选取出m个属性，满足条m＜M。然后以这m个属性中采用某种策略比如说信息增益)来选择1个属性作为该节点的分裂属性。③决策树形成过程中每个节点都要按照步骤2分裂，如果下一次该节点选出来的那一个属性是刚刚其父节点分裂时用过的属性，则该节点已经达到了叶子节点，无须继续分裂。一直到不能够再分裂为止。注意整个决策树形成过程中没有进行剪枝。④按照步骤1-3建立大量的决策树，这样就构成了随机森林。Informer的训练过程：Informer原理指的是一种基于自监督学习的方法，主要用于处理自然语言处理任务。其核心思想是通过对输入数据进行遮盖或替换，构建一个辅助任务并利用模型自身的预测能力来进行训练，从而获得更好的表示学习结果。具体而言，Informer原理包括以下几个步骤：①输入数据构建：将输入的序列数据进行切分，并进行时间序列的构建。②遮盖或替换：在构建的时间窗口中，对其中的某些元素进行遮盖或替换，形成辅助任务。③辅助任务的训练：将遮盖或替换后的时间窗口作为输入，通过模型的预测能力来恢复遮盖或替换的元素。这个过程可以使用自监督学习方法进行训练，比如使用对比学习或生成模型的方法。④主任务的训练：在辅助任务的训练完成后，继续使用原始的序列数据进行主任务的训练。在发电量预测中，DNN的训练过程如下：①加载数据：需要对数据进行加载、处理，创建数据加载器，可以将整块数据用数据加载器处理成小块形式，后续进行迭代循环，并输入到模型中进行训练。②定义网络格式：随后定义自己的模型，并实例化，随后定义使用的损失函数、优化器。③训练、验证和测试：训练之前需要注意设置随机固定的随机种子，保证可复现性。参数调整和交叉验证：对每个模型的关键参数进行调整，如学习率、树的数量、层数和头的数量，并使用交叉验证来评估模型的准确性和泛化能力。在发电量预测中，本发明的方法是将预训练后的模型在特定任务的数据集上进行微调。具体来说主要包含以下步骤：构建模型：本发明的发电量预测模型是深度神经网络模型；预训练：本发明使用大量光场数据集对发电量进行预训练；这一步旨在让模型了解光伏发电场站的一般趋势和关联性。微调：预训练后，本发明将模型应用于本任务的发电量数据，以微调模型，使其适应场景一的具体特点和要求。需要注意的是，在发电功率/发电量模型得到预测结果后，本发明采用了三次样条插值的方法进行非预测点上采样，三次样条插值简称Spline插值，是通过一系列形值点的一条光滑曲线，数学上通过求解三弯矩方程组得出曲线函数组的过程。实际计算时还需要引入边界条件才能完成计算。定义：设区间上给定一个剖分：为/＞上满足下列条件的函数：；在每个子区间/＞上是三次多项式那么称/＞为关于剖分/＞的一个三次样条函数。如果再给定某个函数/＞在剖分的节点上的函数值，且满足插值条件。那么称为/＞在/＞上关于剖分/＞的三次样条插值函数；本发明就是利用三次样条插值函数来对生成的预测数据进行相应的插值，最后数据量会增大到四倍。步骤3，模型评估与预测，其中包含：评估指标：为了全面评估模型性能，采用了多种指标，如均方根误差、平均绝对误差和R²分数等。这些指标可以全面反映模型在预测准确性和泛化能力方面的表现；模型评估：使用验证集对模型进行评估，观察模型在不同指标下的表现。对于每个模型，特别关注其在预测未来发电量方面的准确性和稳定性；预测应用：在模型训练和评估完成后，使用模型进行实际的发电量预测。这包括短期和长期的预测。预测结果可以应用于发电站的运行管理，优化电力资源分配；模型优化：根据评估结果对模型进行进一步的调整和优化，以提高预测的准确性。这可能包括参数调整、模型结构优化等。本发明通过综合利用多种机器学习模型，设计了一种基于回归预测和时序预测相结合的预测方案，有效提升了光伏发电预测的准确性和可靠性。以下举例说明：实施例一为分布式，即一种基于回归预测和时序预测相结合的光伏发电功率/发电量预测方法，包括以下步骤：步骤1，采集光伏发电场站的历史功率数据，气象数据，以及相关时间数据；步骤2，使用随机森林算法处理发电功率数据中的缺失值，并对数据进行归一化处理；步骤3，进行特征工程，提取与发电功率相关的时间、日期和季节信息，包括但不限于月份、日、小时、分钟、一天中的分钟数、一周中的天数、一年中的天数、星期几、时间段、季节、月初、月末、季度初、季度末及周末的信息；步骤4，结合直方图梯度提升回归模型和基于Transformer的时序预测模型，对发电功率进行预测，其中HGBR模型用于预测短期功率输出，Transformer模型用于预测长期功率趋势；步骤5，利用实际功率输出数据对模型进行验证和调整，以提高预测精度。其中所述的特征工程进一步包括环境温度、湿度、风速、风向、太阳辐射量等气象因素的数据。实施例二为集中式，即一种区域场群中电站集群的发电功率预测方法，包括以下步骤：步骤1，收集多个光伏电站的历史发电数据及气象数据；步骤2，使用多重插补方法处理数据中的缺失值，并进行数据归一化；步骤3，采用Stacking集成方法，结合随机森林、HGBR和深度神经网络模型进行预测，其中随机森林用于处理非线性和高维数据，HGBR用于处理时间序列数据，DNN用于提取复杂特征；步骤4，利用Informer模型进行长期时序预测，特别是在数据量大和序列长的情况下，以提高预测的准确性和效率；步骤5，利用交叉验证和实际发电数据来调整和验证模型的准确性。综上所述，本发明实施例的该方法采用了直方图梯度提升回归等模型和基于Transformer的时序预测模型，通过加权融合二者的预测结果，并采用自适应学习的方式优化组合系数，从而有效提升模型性能。该方法具有高准确性、鲁棒性和自动特征选择的优点。其可解释性强，能够输出特征的重要性排序，助于理解哪些特征对预测结果有更大影响。这一技术的实施在发电功率/发电量预测方面取得了显著成效。又一方面，本发明还公开一种计算机可读存储介质，存储有计算机程序，所述计算机程序被处理器执行时，使得所述处理器执行如上述方法的步骤。再一方面，本发明还公开一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，所述计算机程序被所述处理器执行时，使得所述处理器执行如上方法的步骤。在本申请提供的又一实施例中，还提供了一种包含指令的计算机程序产品，当其在计算机上运行时，使得计算机执行上述实施例中任一基于回归和时序融合的光伏发电功率/量预测方法。可理解的是，本发明实施例提供的系统与本发明实施例提供的方法相对应，相关内容的解释、举例和有益效果可以参考上述方法中的相应部分。本申请实施例还提供了一种电子设备，包括处理器、通信接口、存储器和通信总线，其中，处理器，通信接口，存储器通过通信总线完成相互间的通信，存储器，用于存放计算机程序；处理器，用于执行存储器上所存放的程序时，实现上述基于回归和时序融合的光伏发电功率/量预测方法。上述电子设备提到的通信总线可以是外设部件互连标准总线或扩展工业标准结构总线等。该通信总线可以分为地址总线、数据总线、控制总线等。通信接口用于上述电子设备与其他设备之间的通信。存储器可以包括随机存取存储器，也可以包括非易失性存储器，例如至少一个磁盘存储器。可选的，存储器还可以是至少一个位于远离前述处理器的存储装置。上述的处理器可以是通用处理器，包括中央处理器、网络处理器等；还可以是数字信号处理器、专用集成电路、现场可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。在上述实施例中，可以全部或部分地通过软件、硬件、固件或者其任意组合来实现。当使用软件实现时，可以全部或部分地以计算机程序产品的形式实现。所述计算机程序产品包括一个或多个计算机指令。在计算机上加载和执行所述计算机程序指令时，全部或部分地产生按照本申请实施例所述的流程或功能。所述计算机可以是通用计算机、专用计算机、计算机网络、或者其他可编程装置。所述计算机指令可以存储在计算机可读存储介质中，或者从一个计算机可读存储介质向另一个计算机可读存储介质传输，例如，所述计算机指令可以从一个网站站点、计算机、服务器或数据中心通过有线）或无线方式向另一个网站站点、计算机、服务器或数据中心进行传输。所述计算机可读存储介质可以是计算机能够存取的任何可用介质或者是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。所述可用介质可以是磁性介质，、光介质、或者半导体介质等。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。本说明书中的各个实施例均采用相关的方式描述，各个实施例之间相同相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于系统实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
