标题title
一种RIS辅助NOMA系统中多变量联合优化方法
摘要abst
本发明公开了一种RIS辅助NOMA系统中多变量联合优化方法，属于无线通信技术领域。本发明包括：获取非正交多址接入NOMA通信系统中基站、可重构人工表面RIS和用户的相对位置，并结合基站阵列天线结构、RIS无源阵列结构构建基站到RIS、RIS到用户的信道；以最大化通信系统的合速率为优化目标构建基站总发射功率优化模型；采用交替迭代法对基站总发射功率优化模型进行优化求解，得到通信系统最优的功率分配、基站阵列信号激励和RIS无源阵列激励。本发明结合实际工程条件与需求构建基站总发射功率优化模型，采用交替迭代法求解通信系统最优的功率分配、基站阵列信号激励和RIS无源阵列激励，其降低了发射功率优化处理的计算复杂度，提高了通信系统响应速度。
权利要求书clms
1.一种RIS辅助NOMA系统中多变量联合优化方法，其特征在于，包括下列步骤：步骤1，获取非正交多址接入NOMA通信系统中基站、可重构人工表面RIS和用户的相对位置；步骤2，根据基站阵列天线结构、RIS无源阵列结构及步骤1获取的相对位置构建基站到RIS、RIS到用户的信道；步骤3，以最大化通信系统的合速率为优化目标构建基站总发射功率优化模型，该优化模型的约束条件包括：用户的服务质量约束、基站阵列天线激励约束、发射信号的功率约束和RIS无源阵列的硬件约束；步骤4，采用交替迭代法对基站总发射功率优化模型进行优化求解，得到通信系统最优的功率分配、基站阵列天线激励和RIS无源阵列激励。2.如权利要求1所述的一种RIS辅助NOMA系统中多变量联合优化方法，其特征在于，步骤3中，基站总发射功率优化模型为：；其中，表示基站阵列天线激励，/＞表示复数域，Nt表示基站的阵列天线单元数，RIS相位激励/＞，/＞表示RIS的第i个无源反射单元的移相器相位，Nr表示RIS的无源反射单元数，/＞表示功率分配因子，R表示所有用户的总频谱效率，、/＞、/＞分别表示用户k的频谱效率、信号功率、频谱效率阈值，K表示用户数，/＞表示系统总功率，用户k的频谱效率/＞，/＞表示用户k的接收信号的信号与干扰加噪声比。3.如权利要求1所述的一种RIS辅助NOMA系统中多变量联合优化方法，其特征在于，步骤3中，基站总发射功率优化模型的目标优化函数设置为：；其中，表示第一目标优化函数，/＞表示基站阵列天线激励，/＞表示复数域，Nt表示基站的阵列天线单元数，RIS相位激励/＞，/＞表示RIS的第i个无源反射单元的移相器相位，/＞，Nr表示RIS的无源反射单元数，/＞表示功率分配因子，/＞、/＞分别表示用户k的信号功率、接收信号的信号与干扰加噪声比，K表示用户数，/＞表示参与计算的分布式规划中的两个辅助变量，其初始值为预置值，/＞、表示用户k的分布式规划中的两个辅助变量，/＞表示用户k的信道增益，/＞，用户k的信道增益辅助量/＞，/＞表示RIS与第k个用户之间的信道增益，上标r用于标识RIS，/＞表示基站到RIS之间的信道增益，/＞表示用户j的信号功率，/＞表示噪声方差，上标“/＞”表示矩阵的共轭转置，/＞表示对角矩阵。4.如权利要求3所述的一种RIS辅助NOMA系统中多变量联合优化方法，其特征在于，基站总发射功率优化模型设置为：定义表示引入辅助变量/＞的第二目标优化函数，其表达式为：；基于第二目标优化函数设置基站总发射功率优化模型为：；其中，表示用户m的信号功率，/＞表示系统总功率，/＞表示惩罚因子，/＞表示噪声方差，辅助变量/＞为优化对象，/＞、/＞表示辅助变量/＞的不同元素，下标k、m用于标识用户编号，辅助变量/＞的初始值基于初始RIS相位激励/＞、初始基站阵列天线激励/＞、用户的信号功率的初始值计算得到：/＞、/＞，其中，/＞、/＞分别表示用户m、k的信号功率的初始值。5.如权利要求4所述的一种RIS辅助NOMA系统中多变量联合优化方法，其特征在于，步骤4中，采用交替迭代法对基站总发射功率优化模型进行优化求解具体包括：步骤4-1，初始化基站阵列天线激励、RIS相位激励/＞、功率分配因子/＞、辅助变量/＞，以及初始化迭代次数；步骤4-2，基于第二目标优化函数，按照依次更新辅助变量/＞、功率分配因子/＞、基站阵列天线激励/＞、RIS相位激励/＞和辅助变量/＞的更新顺序进行迭代求解；步骤4-3，检测是否满足预置的迭代收敛条件，若是，则基于当前迭代求解得到的功率分配因子、基站阵列天线激励和RIS相位激励得到最优的功率分配、基站阵列天线激励和RIS无源阵列激励；若否，则迭代次数自增1后继续执行步骤4-2；其中，迭代收敛条件为迭代次数达到预置上限或者第二目标优化函数的函数值收敛。6.如权利要求5所述的一种RIS辅助NOMA系统中多变量联合优化方法，其特征在于，步骤4-3中，第二目标优化函数的函数值收敛的具体判别方式为：定义表示根据当前次迭代求解得到的/＞计算出的第二目标优化函数的函数值；定义表示根据上一次迭代求解得到的/＞计算出的第二目标优化函数的函数值；若，则表示第二目标优化函数/＞的函数值收敛，其中，/＞表示预置常数。7.如权利要求6所述的一种RIS辅助NOMA系统中多变量联合优化方法，其特征在于，常数的数量级为10-6。
说明书desc
技术领域本发明涉及无线通信技术领域，尤其涉及一种RIS辅助NOMA系统中多变量联合优化方法。背景技术由于5G网络频段sub-6GHz频段现在较为拥挤，毫米波通信已经成为第五代无线通信系统中前景广阔的技术。然而由于毫米波波长短，传播信号损耗大，极易受到障碍物影响。因此采用可重构人工表面来重构信号传播信道，基站向RIS发射信号然后RIS将信号发射给用户，以使得非视距信道转为视距信道，绕过障碍物来提高信噪比系统性能，从而提高系统频谱效率。虽然 RIS 类似于全双工放大-前向中继器，但它利用无源反射波束成形来转发射频信号，因此 RIS 的功耗比 AF 中继器低得多，而且在反射过程中几乎不会增加额外的热噪声，因此RIS可大大提高无线系统的性能。非正交多址接入技术通过在功率域区分信号，使得在同一时间得同一个波束内可以传播多个数据流信号，极大得提高了频谱利用率。在RIS辅助NOMA系统中，系统性能取决于不同用户间的功率分配、发射基站的有源阵列波束赋形、RIS的无源阵列波束赋形。然而，在这个系统设计问题中，待优化变量高度耦合在目标函数与约束中，现有方法计算复杂度高，算法迭代较慢，导致系统响应速度较慢。发明内容本发明针对现有技术在RIS辅助NOMA系统的功率分配优化处理时的计算复杂度高而影响系统响应速度的技术问题，公开了一种RIS辅助NOMA系统中多变量联合优化方法，以有效提升系统响应速度。本发明采用的技术方案为：一种RIS辅助NOMA系统中多变量联合优化方法，该方法包括下列步骤：步骤1，获取非正交多址接入NOMA通信系统中基站、可重构人工表面RIS和用户的相对位置；步骤2，根据基站阵列天线结构、RIS无源阵列结构及步骤1获取的相对位置构建基站到RIS、RIS到用户的信道；步骤3，以最大化通信系统的合速率为优化目标构建基站总发射功率优化模型，该优化模型的约束条件包括：用户的服务质量约束、基站阵列天线激励约束、发射信号的功率约束和RIS无源阵列的硬件约束；步骤4，采用交替迭代法对基站总发射功率优化模型进行优化求解，得到通信系统最优的功率分配、基站阵列天线激励和RIS无源阵列激励。进一步的，步骤3中，基站总发射功率优化模型为：；其中，表示基站阵列天线激励，/＞表示复数域，Nt表示基站的阵列天线单元数，RIS相位激励/＞，/＞表示RIS的第i个无源反射单元的移相器相位，Nr表示RIS的无源反射单元数，/＞表示功率分配因子，R表示所有用户的总频谱效率，/＞、/＞、/＞分别表示用户k的频谱效率、信号功率、频谱效率阈值，K表示用户数，/＞表示系统总功率，用户k的频谱效率/＞，/＞表示用户k的接收信号的信号与干扰加噪声比。进一步的，步骤3中，基站总发射功率优化模型的目标优化函数设置为：；其中，表示第一目标优化函数，/＞表示基站阵列天线激励，/＞表示复数域，Nt表示基站的阵列天线单元数，RIS相位激励/＞，/＞表示RIS的第i个无源反射单元的移相器相位，/＞，Nr表示RIS的无源反射单元数，表示功率分配因子，/＞、/＞分别表示用户k的信号功率、接收信号的信号与干扰加噪声比，K表示用户数，/＞表示参与计算的分布式规划中的两个辅助变量，其初始值为预置值，/＞、/＞表示用户k的分布式规划中的两个辅助变量，/＞表示用户k的信道增益，/＞，用户k的信道增益辅助量/＞，/＞表示RIS与第k个用户之间的信道增益，上标r用于标识RIS，/＞表示基站到RIS之间的信道增益，/＞表示用户j的信号功率，/＞表示噪声方差，上标“/＞”表示矩阵的共轭转置，/＞表示对角矩阵。进一步的，步骤3中，基站总发射功率优化模型设置为：定义表示引入辅助变量/＞的第二目标优化函数，其表达式为：；基于第二目标优化函数设置基站总发射功率优化模型为：；其中，表示用户m的信号功率，/＞表示系统总功率，/＞表示惩罚因子，/＞表示噪声方差，辅助变量/＞为优化对象，/＞、/＞表示辅助变量/＞的不同元素，下标k、m用于标识用户编号，辅助变量/＞的初始值基于初始RIS相位激励/＞、初始基站阵列天线激励/＞、用户的信号功率的初始值计算得到：/＞、/＞，其中，/＞、/＞分别表示用户m、k的信号功率的初始值。进一步的，步骤4中，采用交替迭代法对基站总发射功率优化模型进行优化求解具体包括：步骤4-1，初始化基站阵列天线激励、RIS相位激励/＞、功率分配因子/＞、辅助变量，以及初始化迭代次数；步骤4-2，基于第二目标优化函数，按照依次更新辅助变量/＞、功率分配因子/＞、基站阵列天线激励/＞、RIS相位激励/＞和辅助变量/＞的更新顺序进行迭代求解；步骤4-3，检测是否满足预置的迭代收敛条件，若是，则基于当前迭代求解得到的功率分配因子、基站阵列天线激励和RIS相位激励得到最优的功率分配、基站阵列天线激励和RIS无源阵列激励；若否，则迭代次数自增1后继续执行步骤4-2；其中，迭代收敛条件为迭代次数达到预置上限或者第二目标优化函数的函数值收敛。进一步的，步骤4-3中，第二目标优化函数的函数值收敛的具体判别方式为：定义表示根据当前次迭代求解得到的/＞计算出的第二目标优化函数/＞的函数值；定义表示根据上一次迭代求解得到的/＞计算出的第二目标优化函数/＞的函数值；若，则表示第二目标优化函数/＞的函数值收敛，其中，/＞表示预置常数。本发明提供的技术方案至少带来如下有益效果：本发明以提高通信系统中所有用户的频谱效率之和为目标，并结合实际工程条件与需求构建基站总发射功率优化模型，采用交替迭代法求解通信系统最优的功率分配、基站阵列天线激励和RIS无源阵列激励，本发明降低了发射功率优化处理的计算复杂度，提高了系统响应速度。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1为本发明实施例提供的一种RIS辅助NOMA系统中多变量联合优化方法的流程图。图2为本发明实施例对不同频率载波的频谱效率对比示意图。图3为本发明实施例对不同发射功率下频谱效率对比示意图。具体实施方式为使本发明实施例的目的、技术方案和优势更加清楚，下面将结合本发明实施中的附图，对本发明实施例中的技术方案进行详细、完整地描述。显然，所描述的实施例仅是本申请一部分实施例，而不是全部的实施例。通常情况下，在附图中描述和展示的本发明实施例的组件能够使用不同的配置来布置和设计。因此，以下对在附图中提供的本发明的实施例的详细描述并非只在限制要求保护的本申请的范围，而是仅仅表示本发明的选定实施例。以两用户下行RIS辅助的NOMA通信系统为例，描述本发明实施例提供的一种RIS辅助NOMA系统中多变量联合优化方法的具体实现过程。在本发明实施例所应用的通信系统中，基站配备具有Nt个单元的阵列天线，RIS有Nr个无源的反射单元，它们由移相器控制。假设基站的发射信号s1与s2分别对应用户U1与U2的所需信号，在NOMA通信系统中，第k个用户的接收信号为： 其中，表示RIS与第k个用户间的信道参数，/＞表示复数域，上标r用于标识RIS，/＞表示基站到RIS间的信道参数，上标“/＞”表示矩阵的共轭转置，表示无波束赋形矩阵，/＞表示对角矩阵，/＞表示第i个无源反射单元的移相器相位，即第i个RIS相位激励值，/＞表示有源波束赋形矩阵，/＞表示功率分配因子，/＞表示基站的发射信号矢量，/＞表示加性高斯白噪声，/＞表示噪声方差，/＞表示高斯分布。基站到RIS间的信道增益，以及RIS与第k个用户间的信道增益/＞的表达式如下：  其中，分别表示从基站到RIS、RIS到基站、以及和基站到用户的角度，/＞分别表示对应于/＞与/＞的路径损耗，/＞、/＞分别表示基站和RIS的导向矢量，/＞表示信道衰落因子，用于表征无线多径信道的衰落程度，本发明实施例中，取信道衰落因子的值为10，实际应用时，可基于具体应用场景进行自定义。本发明实施例假设在基站可以获得精确的信道状态信息，令RIS相位激励，用户k的信道增益辅助量/＞ ，则公式可改写为： 其中，表示用户k的信号功率，/＞表示基站对用户k的发射信号。在NOMA通信系统中，通常根据信号功率大小选择解码顺序。本发明实施例针对双用户的情况，假设p1＞p2，在接收端优先在接收信号中解码功率较大的信号s1，再使用接收信号减去解码出的信号得到功率较小的信号s2, 这个过程也叫连续干扰消除技术，因此在解码接收信号中获得信号s1时，信号s2被视作干扰信号；而s1不会被视作s2的干扰信号。本发明实施例中，任意用户k的接收信号的信号与干扰加噪声比为： 其中，频谱效率表达式可以写为，其中/＞表示用户k的接收信号的信号与干扰加噪声比，/＞表示用户m的信号功率。本发明实施例旨在最大化下行通信的频谱效率，因此QoS约束下的功率分配因子、基站阵列天线激励/＞和无源波束赋形矩阵/＞设计问题可以变换： 其中，R表示所有用户的总频谱效率，、/＞、/＞分别表示用户k的频谱效率、信号功率、频谱效率阈值，/＞表示系统总功率。公式中所限定的约束从上到下依次为：用户k的QoS约束、信号功率约束、基站发射功率约束与RIS上移相器引入的恒模约束，由于三个待优化变量高度耦合在目标函数与用户k的QoS约束内，且目标函数、用户k的QoS约束与RIS恒模约束是非凸的，导致该问题较难求解。对公式所展示的基站总发射功率优化模型进行求解时，可以采用的求解方法包括但不限于：方式1：步骤：输入信道增益与/＞、高斯白噪声/＞，初始化/＞；步骤：利用泰勒展开将非凸的数学模型近似为凸形式；步骤3：利用凸优化工具设计、/＞和/＞，直到优化目标模型收敛；步骤4：输出最优的、/＞和/＞。方式2：与方式1相同，在RIS无源波束赋形的求解上针对恒模约束使用黎曼流形优化方法，其中，迭代求解步骤与方式1相同。作为一种可能的实现方式，如图1所示，本发明实施例提供的一种RIS辅助NOMA系统中多变量联合优化方法包括系列步骤：步骤S1：根据信道估计技术估计通信系统中基站位置、RIS位置、用户位置，并根据此位置信息、基站阵列天线结构、RIS无源阵列结构构建基站到RIS、RIS到用户的信道参数，得到信道增益与/＞，以及根据实际设置情况初始化高斯白噪声/＞：   其中，表示噪声方差，/＞表示高斯分布。步骤S2：以最大化通信系统合速率目标，以实际需求与系统硬件条件为约束条件建立基站总发射功率优化模型，如公式所示；步骤S3：利用交替最小化法优化最优的功率分配、基站阵列天线激励和RIS无源阵列激励。其中，步骤S2中，还包括对公式进行简化处理，得到如公式所示的基站总发射功率优化模型的目标优化函数：其中，用户k的信道增益 ，/＞、/＞表示用户k的分布式规划中的两个辅助变量，/＞表示用户j的信号功率；进一步的，对公式所示的目标优化函数的约束进行简化处理：对于QoS约束，本发明实施例引入辅助变量，并定义表示第二目标优化函数，其表达式为：基于第二目标优化函数将公式所示的基站总发射功率优化模型进一步变换为：其中，表示用户m的信号功率，/＞表示系统总功率，/＞表示惩罚因子，/＞表示噪声方差，辅助变量/＞为优化对象，/＞、/＞表示辅助变量/＞的不同元素，下标k、m用于标识用户编号，辅助变量/＞的初始值基于初始RIS相位激励/＞、初始基站阵列天线激励/＞、用户的信号功率的初始值计算得到：/＞、/＞，其中，/＞、/＞分别表示用户m、k的信号功率的初始值。公式所示的基站总发射功率优化模型可以进一步分解为如下所示的五个子优化模型：其中，各参数的上标和/＞分别表示第/＞次迭代和第/＞次迭代，例如，/＞、/＞分别表示第/＞次迭代时辅助变量/＞的元素/＞、/＞的值。且本实施例中，迭代次数/＞的初始值为0。基于上述五个子优化模型可以完成第次迭代时的各参量对象的更新，具体如下：1）第次迭代时的辅助变量/＞与/＞的更新为：其中，表示计算的中间量，/＞表示实部，/＞、/＞分别表示第/＞次迭代时用户k的分布式规划中的两个辅助变量，/＞表示第/＞次迭代时用户k的信号功率。2）第次迭代时，功率分配因子/＞的更新为： 其中，表示忽略功率约束时功率分配的当前迭代最优解，/＞表示用户n从基站到用户的信道因子，/＞表示用户n从RIS到用户的信道因子，/＞表示第/＞次迭代时辅助变量/＞的元素/＞的值，上标d、r分别用于标识基站和RIS，上标“/＞”表示矩阵的共轭转置。/＞、/＞分别表示第/＞次迭代时用户k的分布式规划中的两个辅助变量。/＞、/＞分别表示第/＞次迭代时的RIS相位激励和基站阵列天线激励。2）第次迭代时的基站阵列天线激励/＞的更新为： 其中，表示第/＞次迭代时忽略基站阵列天线激励约束时基站阵列天线激励的最优解，中间变量/＞，/＞表示/＞次迭代时第k个用户的功率分配因子，中间变量/＞，/＞表示用户m的信道增益辅助量。例如对于两用户，则。3）第次迭代时的RIS相位激励/＞的更新：  其中，中间变量，中间变量/＞，/＞表示第/＞次迭代时第m个用户的功率分配因子，/＞表示第/＞次迭代时的基站阵列天线激励，e表示自然底数，上标/＞表示虚数单位，k、m用于标识用户编号。4）第次迭代时的辅助变量/＞的更新为：  其中，，/＞，/＞与/＞分别表示忽略约束时/＞的元素/＞、/＞的最优解，令/＞即可得到参数/＞的值，上标“/＞”表示矩阵的共轭转置。综上所述，本发明实施例提供的一种RIS辅助NOMA系统中多变量联合优化方法采用交替迭代法对所构建的基站总发射功率优化模型所示）进行优化求解，该优化求解方式定义为方法3，其具体优化求解步骤包括：步骤S301：初始化基站阵列天线激励、RIS相位激励/＞、功率分配因子/＞、辅助变量，初始化迭代次数/＞，从而得到初始基站阵列天线激励/＞、初始RIS相位激励/＞、初始功率分配因子/＞，以及三个初始辅助变量/＞；步骤S302：计算第次迭代时的辅助变量/＞与/＞；步骤S303：计算第次迭代时的功率分配因子/＞；步骤S304：计算第次迭代时的基站阵列天线激励/＞；步骤S305：计算第次迭代时的RIS相位激励/＞；步骤S306：计算第次迭代时的辅助变量/＞；步骤S307：判断是否迭代收敛，例如迭代次数达到预置上限或者最近两次迭代得到的基站总发射功率优化模型的目标优化函数值收敛；若迭代收敛，则基于当前迭代得到的功率分配因子、基站阵列天线激励/＞和RIS相位激励/＞得到最优的功率分配、基站阵列天线激励和RIS无源阵列激励；若未迭代收敛，则更新迭代次数，将迭代次数自增1后返回步骤S302。本发明实施例中，最近两次迭代得到的基站总发射功率优化模型的目标优化函数值收敛的具体判别方式为：其中，表示预置常数，自定义参数，基于实际应用场景而取值不同，通常可以设置为/＞，/＞表示根据当前次迭代求解结果计算出的目标优化函数的函数值，/＞ 表示根据上一次迭代求解结果计算出的目标优化函数的函数值。本发明实施例中，针对上述三种模型的求解优化方式进行了对比实验，以进一步验证其优化性能，图2为不同频率载波的频谱效率对比，该应用场景涉及的用户数为2，图2的参数配置为：，/＞，/＞，/＞，，/＞。图3为不同发射功率下频谱效率对比，该应用场景涉及的用户数为2，图3的参数配置为：/＞，/＞，/＞，/＞，/＞，。由图2可知，方法3的收敛速度更快，且频谱效率优于方法1，与方法2持平。此外方法2中的流行优化算法计算复杂度很高，导致系统响应速度较慢。图3为不同信噪比下频谱效率对比，方法3的平均频谱效率在所有信噪比下的频谱效率均要优于方法1，与方法2相当。/＞
