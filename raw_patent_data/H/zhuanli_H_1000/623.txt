标题title
相位插值器非线性响应校正方法
摘要abst
本发明公开了一种相位插值器非线性响应校正方法。为解决相位插值器的非线性响应会直接反应在输出抖动中的技术问题，本发明将单频模拟信号输入模数转换器，所述模数转换器接收所述相位插值器输出的时钟信号；对模数转换器输出的数字信号执行时域至频域变换，获得实测频率点；根据实测频率点和滤波器输出的相位插值器控制码，获得校正值；根据滤波器输出的所述相位插值器控制码和所述校正值，获得应用于相位插值器的校正后的控制码。本发明以非线性响应补偿与校正为技术手段，克服了相位插值器非线性响应的不利影响，提升了相位插值器的线性度和时钟数据恢复电路性能。本发明适于数据通信领域。
权利要求书clms
1.一种相位插值器非线性响应校正方法，应用于基于相位插值器的时钟数据恢复电路之中，特征在于，包括如下步骤：将单频模拟信号输入模数转换器，所述模数转换器接收所述相位插值器输出的时钟信号；对模数转换器输出的数字信号执行时域至频域变换，获得实测频率点；根据实测频率点和滤波器输出的相位插值器控制码，获得校正值；根据滤波器输出的所述相位插值器控制码，以及所述校正值，获得应用于相位插值器的校正后的控制码。2.根据权利要求1所述的相位插值器非线性响应校正方法，其特征在于：根据实测频率点与单频模拟信号之间的频率差值，得到当前相位插值器控制码所对应的校正值。3.根据权利要求1或2所述的相位插值器非线性响应校正方法，其特征在于：将不同频率的单频模拟信号输入模数转换器，遍历所有相位插值器控制码，获得任一相位插值器控制码所对应的校正值。4.根据权利要求3所述的相位插值器非线性响应校正方法，其特征在于：所述单频模拟信号的频率在所述模数转换器采样频率的二分之一以下。5.根据权利要求4所述的相位插值器非线性响应校正方法，其特征在于：所述滤波器是数字低通滤波器。6.根据权利要求1或2所述的相位插值器非线性响应校正方法，其特征在于：将不同频率的单频模拟信号输入模数转换器，以非遍历的方式测试部分相位插值器控制码，并通过数据拟合的方式获得任一相位插值器控制码所对应的校正值。7.根据权利要求5所述的相位插值器非线性响应校正方法，其特征在于：所述数字低通滤波器接收波特率相位检测器的输出信号；所述数字低通滤波器是时钟数据恢复电路的鉴相环路中的数字低通滤波器。8.根据权利要求7所述的相位插值器非线性响应校正方法，其特征在于：所述波特率相位检测器接收前馈均衡器和判决反馈均衡器的输出信号。9.根据权利要求8所述的相位插值器非线性响应校正方法，其特征在于：前馈均衡器和判决反馈均衡器接收所述模数转换器的输出信号。10.根据权利要求9所述的相位插值器非线性响应校正方法，其特征在于：相位插值器接收锁相环的输出信号。
说明书desc
技术领域本发明涉及数据通信领域，具体涉及一种在时钟数据恢复电路中应用相位插值器非线性响应校正方法。背景技术相位插值器，是一种用于对相位进行插值的电路模块，是高速时钟数据恢复电路关键电路模块。相位插值器接收多个不同相位的时钟作为输入，比如常见的4相时钟输入或8相时钟输入，然后选取其中两个相位相邻的时钟，对其进行加权插值，通过调整加权权重，相位插值器就可以输出任意相位的时钟。图1展示了传统相位插值器在时钟数据恢复电路的应用示意图。该相位插值器所包含的低通滤波器输入n比特相位插值器的代码，模数转换器共有N路输出，其中n和N均为正整数。由于相位插值器完全使用外界输入的时钟作为激励，不需要振荡器，它在噪声表现上优于压控振荡器，可以用更低的功耗实现同样的随机抖动性能。此外，相位插值器是直接进行相位反馈而不是频率反馈，相对于压控振荡器，它的锁定会更为准确、稳定。但相位插值器的缺点是需要多相时钟作为输入，并需要联合延迟锁相环一起工作，且相位插值器的非线性响应会直接反应在输出抖动上，因此非线性响应的标定和补偿对提升相位插值器的线性度和系统时钟性能十分重要。本发明中，相位插值器的非线性响应包括积分非线性响应和微分非线性响应。基于此，如何提升相位插值器的线性度，提升时钟数据恢复电路性能，则成为本领域亟需解决的技术问题。发明内容为了缓解或部分缓解上述技术问题，本发明的解决方案如下所述：一种相位插值器非线性响应校正方法，应用于基于相位插值器的时钟数据恢复电路之中，包括如下步骤：将单频模拟信号输入模数转换器，所述模数转换器接收所述相位插值器输出的时钟信号；对模数转换器输出的数字信号执行时域至频域变换，获得实测频率点；根据实测频率点和滤波器输出的相位插值器控制码，获得校正值；根据滤波器输出的所述相位插值器控制码，以及所述校正值，获得应用于相位插值器的校正后的控制码。在某实施例中，根据实测频率点与单频模拟信号之间的频率差值，得到当前相位插值器控制码所对应的校正值。在某实施例中，将不同频率的单频模拟信号输入模数转换器，遍历所有相位插值器控制码，获得任一相位插值器控制码所对应的校正值。在某实施例中，所述单频模拟信号的频率在所述模数转换器采样频率的二分之一以下。在某实施例中，所述滤波器是数字低通滤波器。在某实施例中，将不同频率的单频模拟信号输入模数转换器，以非遍历的方式测试部分相位插值器控制码，并通过数据拟合的方式获得任一相位插值器控制码所对应的校正值。在某实施例中，所述数字低通滤波器接收波特率相位检测器的输出信号；所述数字低通滤波器是时钟数据恢复电路的鉴相环路中的数字低通滤波器。在某实施例中，所述波特率相位检测器接收前馈均衡器和判决反馈均衡器的输出信号。在某实施例中，前馈均衡器和判决反馈均衡器接收所述模数转换器的输出信号。在某实施例中，相位插值器接收锁相环的输出信号。本发明技术方案，具有如下有益的技术效果之一或多个：通过标定测量相位插值器的非线性响应，并进行补偿，可以有效提升基于相位插值器架构的时钟数据恢复电路的性能，降低了误码率；当前的相位插值器的非线性响应没有可靠的测量方案，本方案可以通过非线性响应标定和补偿，不依靠仪器，测量速度快，精度高。此外，本发明还具有的其它有益效果将在具体实施例中提及。附图说明图1是现有技术中相位插值器在时钟数据恢复电路的应用示意图；图2是相位插值器的非线性响应特性示意图；图3是本发明相位插值器应用原理框图；图4是本发明获得校正值的信息处理流程图；图5是本发明非线性补偿响应原理示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。为了便于清楚描述本发明实施例的技术方案，在本发明的实施例中，采用了“第一”、“第二”等字样对功能和作用基本相同的相同项或相似项进行区分。本领域技术人员可以理解“第一”、“第二”等字样并不对数量和执行次序进行限定，并且“第一”、“第二”等字样也并不限定一定不同。图2展示了相位插值器的非线性响应特性。由于相位插值器是模拟电路，其固有的非线性响应会直接反映在输出抖动上。但这种非线性响应特点缺乏测量方案，因而难以测量和标定相位插值器的非线性响应。为此，本发明披露一种相位插值器的非线性响应标定和补偿方法，通过测量和标定相位插值器的非线性响应，进行相应的补偿，提升相位插值器的线性度，提升相位插值器架构下的时钟数据恢复电路的性能。图3展示了本发明在时钟数据恢复电路中应用相位插值器的方案框图。基于相位插值器的时钟数据恢复电路的一般原理，是已知的，因此对于本领域技术人员熟知的该些技术内容，本发明中不再赘述。在本发明的方案中，通过引入了非线性校正模块和非线性补偿模块，用于提升相位插值器的线性度，提高时钟数据恢复电路的性能。举例而言，时钟数据恢复电路中的滤波器输出相位插值器控制码，其为n比特数据，该控制码的数值范围是0~N-1，其中N、n均为正整数。现有技术通常会直接使用相位插值器控制码控制相位插值器，但这会导致背景技术所提及的缺陷：相位插值器的非线性响应会直接反应在输出抖动上。示例地，所述滤波器为低通滤波器、带通滤波器或者高通滤波器。优选地，所述滤波器为低通滤波器，尤其是数字低通滤波器。本发明中，相位插值器控制码并不直接应用于相位插值器。替代地，非线性补偿模块的输出信号，直接应用于相位插值器，是相位插值器的输入之一。如同现有技术那样，锁相环，尤其是延迟锁相环输出的多相时钟，也作为相位插值器的输入之一。举例地，延迟锁相环接收参考时钟作为输入信号。此外，本发明的非线性校正模块输出的信号，作为非线性补偿系数，应用于非线性补偿模块。非线性补偿模块，至少根据滤波器输出的相位插值器控制码和校正值，获得应用于相位插值器的校正后的控制码。所述校正值，是根据实测频率点和滤波器输出的相位插值器控制码而获得的。相位插值器，其输出信号应用于模数转换器。该模数转换器的另一个输入是模拟信号。举例地，该模拟信号是单频信号，尤其是高精度的单频信号。模数转换器的输出信号，是非线性校正模块的输入信号之一。非线性校正模块还接收所述滤波器的输出信号，作为另一输入。此外，非线性补偿模块，也接收滤波器的输出信号作为输入。时钟数据恢复电路中的波特率相位检测器的输出信号，是所述滤波器的输入信号。此外，波特率相位检测器的输入信号来自前馈均衡器和判决反馈均衡器的输出。可选地，时钟数据恢复电路中还可以报考时钟数据恢复路径自适应模块，其接收模数转换器、前馈均衡器和判决反馈均衡器的输出信号，并将输出信号传输至前馈均衡器和判决反馈均衡器。相位插值器输出的时钟用于模数转换器的时钟，而模数转换器则将输入的模拟信号转换为N比特数字信号，N为正整数。本发明的非线性校正方法，可以分为两个阶段：非线性响应测量阶段和实时校正阶段。图4是本发明获得校正值的信息处理流程图。在非线性响应测量阶段，模数转换器接收高精度的单频模拟信号作为输入，并将其转换为N比特数字信号。而模数转换器的时钟来自相位插值器输出的时钟，且相位插值器受控于相位插值器控制码。当相位插值器控制码为第一控制码时，模数转换器在相位插值器输出的时钟控制下，对前述单频模拟信号进行采集，输出N比特数字信号。接着，通过对采集获得的数据执行时域至频域变换，获得第一控制码控制下的关于该单频模拟信号的频率点，该频率点是系统的实测第一频率点。示例地，所述时域至频域变换为快速傅里叶变换。然后转变第一控制码为第二控制码，其不同于第一控制码。受控于第二控制码，相位插值器输出的时钟用于模数转换器，并接着对前述单频模拟信号进行采集。与受控于第一控制码时的情形类似，依然对模数转换器采集的数据执行时域至频域变换，并获得第二控制码控制下的关于该单频模拟信号的实测第二频率点。继续转变相位插值器控制码为其它控制码，直至遍历所有的相位插值器控制码。关于输入的单频模拟信号，按前述方法，对于任一相位插值器控制码均可获得以一个对应的实测频率点。对于任一个相位插值器控制码，根据前述方法，获得对应的实测频率点，然后根据该实测频率点与输入单频模拟信号频率之间的差值，获得对应的校正值。即在本发明该实施例中，根据相位插值器控制码和实测频率点便可获得对应的校正值。可选地，在某实施例中，为了加快对不同相位插值器控制码测试，在转变相位插值器控制码时，采用非遍历的方式，仅测试其中部分相位插值器控制码，比如每次转变相位插值器控制码时，按一定步长抽样测试，最后对于获得的各种测试数值，通过数据拟合的方式，获得相位插值器的非线性响应曲线，以及最终的任一相位插值器控制码所对应的校正值。由于非线性响应曲线和非线性补偿响应曲线关于线性响应曲线对称，故而在获得非线性响应曲线时，即可容易得知非线性补偿响应曲线，以及相应的校正值。此外，还可以变换不同的单频模拟信号的频率，通过对不同频率的单频模拟信号执行前述的获取校正值的方法，可以获得频段范围内的全部单频模拟信号对应的校正值。优选地，单频模拟信号的频率，应在模数转换器采样频率的二分之一以下。换言之，根据前述方法，在本发明的实时校正阶段，非线性校正模块在获得当前实测频率点和相位插值器控制码后，即可获知对应的校正值。非线性校正模块将该校正值传输至非线性补偿模块，非线性补偿模块根据滤波器输出的相位插值器控制码和该校正值，输出应用于相位插值器的校正后的控制码，并应用于相位插值器，由此弥补相位插值器的非线性响应，使得整个系统运行时更贴近线性特性，提升时钟数据恢复电路的性能。在本发明中，非线性校正模块基于相位插值器的输出和时钟数据恢复电路的鉴相环路中的滤波器的输出进行标定，获得非线性响应补偿系数，输出至非线性补偿模块，并用于非线性响应补偿。优选地，滤波器是通过数字电路实现的数字滤波器，其输出相位插值器控制码。图5展示了本发明非线性补偿响应原理。对于相位插值器的非线性响应，其于线性响应之间存在偏差，而非线性补偿响应曲线上的值和非线性响应曲线上的值的算术平均则与线性响应曲线上的值相等。根据该原理，本发明所披露的技术方案，实现了非线性响应至线性响应的改变，提升了时钟数据恢复电路的整体性能。表1展示本发明性能提升的一个实例。在插入损耗为33dB的信道中，在均为8比特相位量化比特数的前提下，线性相位插值器的误码率为7.70E-07，而7GHz非线性相位插值器的误码率为1.45E-05，误码率提高了18.8倍，而应用本发明后的误码率则为8.60E-07，比线性相位插值器的误码率仅提高至1.1倍，大幅优于非线性相位插值器的性能。表1:本发明与其它实例的性能对比表为了更好的说明本发明，在上文的具体实施方式中给出了众多的具体细节。本领域技术人员应当理解，没有某些具体细节，本发明同样可以实施。在一些实例中，对于本领域技术人员熟知的方法、手段、元件和电路未作详细描述，以便于凸显本发明的主旨。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以所述权利要求的保护范围为准。
