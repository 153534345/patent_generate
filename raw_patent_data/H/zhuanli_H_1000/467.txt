标题title
零知识证明方法、安全多方计算系统
摘要abst
本申请实施例公开了一种零知识证明方法、安全多方计算系统，该零知识证明方法包括：安全多方计算的各参与方共同选取中心参与方；其中，中心参与方为安全多方计算的部分参与方；中心参与方获取同态密文，并基于同态密文得到密文计算结果；其中，同态密文由中心参与方和/或非中心参与方生成，非中心参与方为安全多方计算中除中心参与方之外的所有其他参与方；中心参与方将密文计算结果发送至非中心参与方；非中心参与方对接收的密文计算结果进行验证；在非中心参与方对密文计算结果验证通过的情况下，中心参与方和/或非中心参与方确定密文计算结果为可信的共享数据。这样，可以减少安全多方计算过程中整体的数据计算量和通信数据量。
权利要求书clms
1.一种零知识证明方法，其特征在于，应用于安全多方计算，所述方法包括：所述安全多方计算的各参与方共同选取中心参与方；其中，所述中心参与方为所述安全多方计算的部分参与方；所述中心参与方获取同态密文，并基于所述同态密文得到密文计算结果；其中，所述同态密文由所述中心参与方和/或非中心参与方生成，所述非中心参与方为所述安全多方计算中除所述中心参与方之外的所有其他参与方；所述中心参与方将所述密文计算结果发送至所述非中心参与方；所述非中心参与方对接收的所述密文计算结果进行验证；在所述非中心参与方对所述密文计算结果验证通过的情况下，所述中心参与方和/或所述非中心参与方确定所述密文计算结果为可信的共享数据。2.根据权利要求1所述的零知识证明方法，其特征在于，所述密文计算结果包括密文计算结果Z和密文计算结果B；所述基于所述同态密文得到密文计算结果，包括：所述安全多方计算的各参与方获取同态密文Y和随机数e；其中，所述同态密文Y为所述安全多方计算中各参与方共享的同态密文；所述中心参与方基于所述同态密文Y与同态密文X之间的乘积，生成所述密文计算结果Z，并基于所述同态密文Y与同态密文A之间的乘积，生成所述密文计算结果B；所述非中心参与方对接收的所述密文计算结果进行验证，包括：所述非中心参与方基于所述密文计算结果Z、所述密文计算结果B、所述同态密文Y和同态密文D创建第一乘法证明，以证明所述密文计算结果Z是否基于所述同态密文Y与所述同态密文X之间的乘积生成。3.根据权利要求2所述的零知识证明方法，其特征在于，所述中心参与方获取同态密文，包括：所述非中心参与方或所述安全多方计算的各参与方共同确定所述随机数e；所述中心参与方或所述安全多方计算的各参与方对随机数据x进行同态加密得到所述同态密文X，对随机数据a进行同态加密得到所述同态密文A；所述中心参与方或所述安全多方计算的各参与方对所述随机数据x与所述随机数e之间的乘积、与所述随机数据a进行求和得到随机数据d；所述非中心参与方或所述安全多方计算的各参与方对所述随机数据d进行同态加密得到所述同态密文D。4.根据权利要求2所述的零知识证明方法，其特征在于，所述第一乘法证明的验证过程包括：对所述密文计算结果Z与所述随机数e之间的乘积、与所述密文计算结果B进行求和，得到第一验证数据；对所述同态密文D与所述同态密文Y求乘积，得到第二验证数据；在所述第一验证数据与所述第二验证数据相等的情况下，证明所述密文计算结果Z通过验证。5.根据权利要求2所述的零知识证明方法，其特征在于，所述中心参与方基于所述同态密文Y与同态密文X之间的乘积，生成所述密文计算结果Z，包括：所述中心参与方将所述同态密文Y与所述同态密文X之间的乘积、与同态密文H进行求和，得到密文计算结果Z；所述中心参与方基于所述同态密文Y与同态密文A之间的乘积，生成所述密文计算结果B，包括：所述中心参与方将所述同态密文Y与所述同态密文A之间的乘积、与同态密文L进行求和，得到密文计算结果B；所述非中心参与方基于所述密文计算结果Z、所述密文计算结果B、所述同态密文Y和同态密文D创建第一乘法证明，包括：所述非中心参与方基于所述密文计算结果Z、所述密文计算结果B、所述同态密文Y、所述同态密文D和同态密文F创建第一乘法证明，以证明所述密文计算结果Z是否为通过将所述同态密文Y与所述同态密文X之间的乘积、与所述同态密文H进行求和得到的。6.根据权利要求5所述的零知识证明方法，其特征在于，所述方法还包括：所述中心参与方或所述安全多方计算的各参与方对随机数据h进行同态加密得到所述同态密文H；所述中心参与方或所述安全多方计算的各参与方对随机数据l进行同态加密得到所述同态密文L；所述中心参与方或所述安全多方计算的各参与方对所述随机数据h与所述随机数e之间的乘积、与所述随机数据l进行求和得到随机数据f；所述中心参与方或所述安全多方计算的各参与方对所述随机数据f进行同态加密得到所述同态密文F。7.根据权利要求5所述的零知识证明方法，其特征在于，所述第一乘法证明的验证过程包括：对所述密文计算结果Z与所述随机数e之间的乘积、与所述密文计算结果B进行求和，得到第一验证数据；对所述同态密文D与所述同态密文Y之间的乘积、与所述同态密文F进行求和，得到第三验证数据；在所述第一验证数据与所述第三验证数据相等的情况下，证明所述密文计算结果Z通过验证。8.根据权利要求2所述的零知识证明方法，其特征在于，所述方法还包括：所述中心参与方从明文域中选取随机数据x和随机数据a；所述中心参与方对所述随机数据x进行同态加密处理，得到所述同态密文X，并对所述随机数据a进行同态加密处理，得到所述同态密文A；所述中心参与方对所述随机数据x与所述随机数e之间的乘积、与所述随机数据a进行求和，得到随机数据d；所述中心参与方将所述同态密文X、所述同态密文A和所述随机数据d发送至所述非中心参与方；所述非中心参与方对所述随机数据d进行同态加密处理，得到所述同态密文D；所述非中心参与方基于所述同态密文X、所述同态密文A、所述同态密文D和所述随机数e创建第二乘法证明，以对所述同态密文X进行验证。9.根据权利要求2所述的零知识证明方法，其特征在于，所述非中心参与方的数量为至少一个，所述同态密文X包括至少两个同态密文分片，所述同态密文A包括至少两个同态密文分片，所述同态密文D包括至少两个同态密文分片，所述方法还包括：所述中心参与方对每一所述同态密文X的同态密文分片进行求和，得到所述同态密文X；所述中心参与方对每一所述同态密文A的同态密文分片进行求和，得到所述同态密文A；所述安全多方计算的各参与方对每一所述同态密文D的同态密文分片进行求和，得到所述同态密文D；所述中心参与方基于所述同态密文X、所述同态密文A、所述同态密文D和所述随机数e创建第二乘法证明，以对所述同态密文X进行验证。10.根据权利要求9所述的零知识证明方法，其特征在于，随机数据x包括至少两个随机数据分片，随机数据a包括至少两个随机数据分片，随机数据d包括至少两个随机数据分片，所述方法包括：所述安全多方计算的各参与方对各自从明文域中选取的所述随机数据x的随机数据分片进行同态加密处理，得到所述同态密文X的同态密文分片，对各自从明文域中选取的所述随机数据a的随机数据分片进行同态加密处理，得到所述同态密文A的同态密文分片；所述非中心参与方将生成的所述同态密文X的同态密文分片和所述同态密文A的同态密文分片发送至所述中心参与方；所述安全多方计算的各参与方对各自选取的所述随机数据x的随机数据分片与所述随机数e之间的乘积、与各自选取的所述随机数据a的随机数据分片进行求和得到所述随机数据d的随机数据分片；所述安全多方计算的各参与方对各自生成的所述随机数据d的随机数据分片进行同态加密处理，得到所述同态密文D的同态密文分片，并广播各自得到的所述随机数据d的随机数据分片和所述同态密文D的同态密文分片。11.根据权利要求8或9所述的零知识证明方法，其特征在于，所述第二乘法证明的验证过程包括：对所述同态密文X与所述随机数e之间的乘积、与所述同态密文A进行求和，得到第四验证数据；在所述第四验证数据与所述同态密文D相等的情况下，证明所述同态密文X是基于所述随机数据x生成的有效同态密文。12.一种安全多方计算系统，其特征在于，包括：中心参与方和非中心参与方；其中，所述中心参与方为所述安全多方计算的部分参与方；所述中心参与方是由安全多方计算的各参与方共同选取的；所述非中心参与方为所述安全多方计算中除所述中心参与方之外的所有其他参与方；所述中心参与方，用于：获取同态密文，并基于所述同态密文进行密文计算，得到密文计算结果；其中，所述同态密文由所述中心参与方和/或非中心参与方生成；将所述密文计算结果发送至所述非中心参与方；在所述非中心参与方对所述密文计算结果验证通过的情况下，确定所述密文计算结果为可信的共享数据；所述非中心参与方，用于：对接收的所述密文计算结果进行验证；在所述非中心参与方对所述密文计算结果验证通过的情况下，确定所述密文计算结果为可信的共享数据。
说明书desc
技术领域本申请涉及但不限于信息技术领域，尤其涉及一种零知识证明方法、安全多方计算系统。背景技术安全多方计算为数据共享交换打造了一个“数据可用不可见”的安全共享环境，解决各实体和各领域之间的数据安全与隐私保护问题，为不同行业、不同机构、不同部门之间的数据共享保驾护航。MPC的一般概念是在多个参与方之间，协同计算一个公开函数。这项技术在云、大数据和人工智能等领域有着非常重要的应用。零知识证明是指一种密码学工具，允许互不信任的通信双方之间证明某个命题的有效性，同时不泄露任何额外信息。在安全多方计算中，可以利用零知识证明，来验证多个参与方之间协同计算的一个约定函数的结果的有效性。例如，在MPC协议中，可以基于乘法深度为1的全同态加密算法，采用全局零知识证明验证明文知识。然而，在相关技术的MPC协议中生成随机数据材料时，要求各个参与方将本地随机数据的同态密文发送给其他所有参与方，使得各方完成相同的密文计算，并采用全局情况下的零知识证明验证各随机数据以及密文计算结果的有效性，以抵抗恶意攻击。在这一过程中，由于各参与方都需要参加密文的计算及验证，导致协议中整体的数据计算量过大，且各参与方之间的通信数据量也过大。发明内容有鉴于此，本申请实施例提供一种零知识证明方法、安全多方计算系统。本申请实施例的技术方案是这样实现的：本申请实施例提供一种零知识证明方法，应用于安全多方计算，所述零知识证明方法包括：所述安全多方计算的各参与方共同选取中心参与方；其中，所述中心参与方为所述安全多方计算的部分参与方；所述中心参与方获取同态密文，并基于所述同态密文得到密文计算结果；其中，所述同态密文由所述中心参与方和/或非中心参与方生成，所述非中心参与方为所述安全多方计算中除所述中心参与方之外的所有其他参与方；所述中心参与方将所述密文计算结果发送至所述非中心参与方；所述非中心参与方对接收的所述密文计算结果进行验证；在所述非中心参与方对所述密文计算结果验证通过的情况下，所述中心参与方和/或所述非中心参与方确定所述密文计算结果为可信的共享数据。本申请实施例提供一种安全多方计算系统，所述安全多方计算系统包括：中心参与方和非中心参与方；其中，所述中心参与方为所述安全多方计算的部分参与方；所述中心参与方是由安全多方计算的各参与方共同选取的；所述非中心参与方为所述安全多方计算中除所述中心参与方之外的所有其他参与方；所述中心参与方，用于：获取同态密文，并基于所述同态密文进行密文计算，得到密文计算结果；其中，所述同态密文由所述中心参与方和/或非中心参与方生成；将所述密文计算结果发送至所述非中心参与方；在所述非中心参与方对所述密文计算结果验证通过的情况下，确定所述密文计算结果为可信的共享数据；所述非中心参与方，用于：对接收的所述密文计算结果进行验证；在所述非中心参与方对所述密文计算结果验证通过的情况下，确定所述密文计算结果为可信的共享数据。根据本申请实施例提供的技术方案，在安全多方计算中，中心参与方进行密文计算，并将结果发送至非中心参与方，非中心参与方接收中心参与方计算出的密文结果，并通过零知识证明验证密文结果，以抵抗恶意攻击。这样，一方面，无需各参与方都进行密文计算，可以减少安全多方计算过程中整体的数据计算量；另一方面，由于仅需中心参与方将密文计算结果发送至非中心参与方以进行验证，无需各参与方都验证密文计算结果，从而可以降低各参与方之间通信的数据量。附图说明图1为本申请实施例提供的一种零知识证明方法的流程示意图一；图2A为本申请实施例提供的一种安全多方计算系统的组成架构示意图一；图2B为本申请实施例提供的一种零知识证明方法的流程示意图二；图3A为本申请实施例提供的一种安全多方计算系统的组成架构示意图二；图3B为本申请实施例提供的一种零知识证明方法的流程示意图三；图4为本申请实施例提供的一种安全多方计算协议离线阶段的通信方法的流程示意图；图5为本申请实施例提供的一种安全多方计算系统的组成结构示意图。具体实施方式为了使本申请的目的、技术方案和优点更加清楚，下面结合附图和实施例对本申请的技术方案进一步详细阐述，所描述的实施例不应视为对本申请的限制，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本申请保护的范围。在以下的描述中，所涉及的术语“第一/第二/第三”仅仅是区别类似的对象，不代表针对对象的特定排序，可以理解地，“第一/第二/第三”在允许的情况下可以互换特定的顺序或先后次序，以使这里描述的本申请实施例能够以除了在这里图示或描述的以外的顺序实施。除非另有定义，本文所使用的所有的技术和科学术语与属于本申请的技术领域的技术人员通常理解的含义相同。本文中所使用的术语只是为了描述本申请的目的，不是旨在限制本申请。另外还需要说明的是，为了便于描述，附图中仅示出了与有关申请相关的部分。为了更好地理解本申请实施例提供的零知识证明方法，下面先对相关技术中的加密方案进行说明。MPC协议有很多种，其中，SPDZ系列协议的应用较为广泛。SPDZ系列协议是比较重要的MPC协议，采用了有限域上的加法秘密共享方案和信息理论安全的消息认证码技术共同保证了抵抗恶意敌手的安全性。SPDZ系列协议包含两个阶段：离线阶段和在线阶段。其中，在不同的SPDZ协议中，在线阶段的设计是相似的，离线阶段可以通过不经意传输协议或同态加密实现。在本申请实施例中，对随机数据进行加密的方式为同态加密。在同态加密和解密算法中常用的分布有：模固定的均匀随机分布和离散高斯分布。模固定的均匀随机分布用于选取基于密钥生成加密数据的随机数据，离散高斯分布用于选取协同密钥对随机数据加密的噪音数据。在本申请实施例中，对随机数据进行加密的方式可以为引入噪音数据协同密钥进行加密，即同态密文由密钥和噪音数据协同计算生成，其中，密钥可以为公钥或私钥。在一些实施方式中，在该零知识证明方法的各步骤中涉及的加密方式可以是保持一致的，同一实施例中的同态密文均可以为使用同类型密钥和噪音数据协同加密的；同一实施例中的加密所采用的噪音数据均可以通过方差与底层同态加密算法中相同的离散高斯分布选取，也可以基于噪音数据通过计算获得；同一实施例中由参与方选取的随机数据均可以通过模相同的均匀随机分布选取。在一些实施方式中，可以采用全同态公钥加密算法、其他同态公钥加密算法或同态算法的私钥加密算法进行数据加密处理。在一些实施方式中，当实施例中各参与方的数量为多个时，被加密的随机数据可以为每个参与方选取或计算得到的随机数据分片，每个参与方加密随机数据分片后得到的加密数据可以为加密数据分片，各参与方使用公钥加密时，密钥可以为每个参与方所持有的一个共同公钥，各参与方使用私钥加密时，密钥可以为每个参与方所持有的私钥分片，引入的噪音数据可以为每个参与方选取或计算得到的噪音数据分片，由密钥分片和噪音数据分片协同加密的同态密文可以为同态密文分片。在本申请实施例中，各参与方之间可以通过广播或定向传输等方式进行数据的发送与接收。在此基础上，本申请实施例提供了一种零知识证明方法，由安全多方计算中的参与方来实现。图1为本申请实施例提供的一种零知识证明方法的流程示意图一，如图1所示，该零知识证明方法包括以下步骤S101至步骤S105：步骤S101、安全多方计算的各参与方共同选取中心参与方；其中，中心参与方为安全多方计算的部分参与方。安全多方计算是指在无可信第三方的情况下，多个参与方协同计算一个约定的函数。在本申请实施例中，安全多方计算的参与方包括两部分：一部分为用于完成密文计算的中心参与方，另一部分为对中心参与方基于密文计算出的结果进行验证的非中心参与方。步骤S102、中心参与方获取同态密文，并基于同态密文得到密文计算结果；其中，同态密文由中心参与方和/或非中心参与方生成，非中心参与方为安全多方计算中除中心参与方之外的所有其他参与方。在一些实施方式中，同态密文可以对数据进行同态加密得到；其中，数据可以包括但不限于明文域中随机选取的随机数据。在一些实施方式中，同态密文可以由中心参与方生成，也可以由中心参与方和非中心参与方生成。步骤S103、中心参与方将密文计算结果发送至非中心参与方。步骤S104、非中心参与方对接收的密文计算结果进行验证。步骤S105、在非中心参与方对密文计算结果验证通过的情况下，中心参与方和/或非中心参与方确定密文计算结果为可信的共享数据。根据本申请实施例提供的零知识证明方法，在安全多方计算中，中心参与方进行密文计算，并将结果发送至非中心参与方，非中心参与方接收中心参与方计算出的密文结果，并通过零知识证明验证密文结果，以抵抗恶意攻击。这样，一方面，无需各参与方都进行密文计算，可以减少安全多方计算过程中整体的数据计算量；另一方面，由于仅需中心参与方将密文计算结果发送至非中心参与方以进行验证，无需各参与方都验证密文计算结果，从而可以降低各参与方之间通信的数据量。在一些实施方式中，密文计算结果包括密文计算结果Z和密文计算结果B。上述步骤S102中所述中心参与方获取同态密文，可以包括以下步骤S111至步骤S114：步骤S111、非中心参与方或安全多方计算的各参与方共同确定随机数e。其中，随机数e的值可以从0和1中选取。在一些实施方式中，随机数e还可以包括但不限于一个由非中心参与方确定并发送至中心参与方的随机数；其中，随机数的值可以从0和1中选取。步骤S112、中心参与方或安全多方计算的各参与方对随机数据x进行同态加密得到同态密文X，对随机数据a进行同态加密得到同态密文A。步骤S113、中心参与方或安全多方计算的各参与方对随机数据x与随机数e之间的乘积、与随机数据a进行求和得到随机数据d。步骤S114、非中心参与方或安全多方计算的各参与方对随机数据d进行同态加密得到同态密文D。示例性地，确定同态密文D的方式参见公式：；其中，Enc表示对中的数据进行同态加密处理，噪音数据t为对噪音数据r与随机数e之间的乘积、与噪音数据u进行求和得到的噪音数据，噪音数据r为协同密钥对随机数据x进行同态加密的噪音数据，噪音数据u为协同密钥对随机数据a进行同态加密的噪音数据。上述步骤S102中所述基于同态密文得到密文计算结果，可以包括以下步骤S115和步骤S116：步骤S115、安全多方计算的各参与方获取同态密文Y和随机数e；其中，同态密文Y为安全多方计算中各参与方共享的同态密文。在一些实施方式中，同态密文Y可以包括但不限于密文计算的结果密文或安全多方计算的各参与方各自从有限域内选择随机数进行加密处理后的密文和。步骤S116、中心参与方基于同态密文Y与同态密文X之间的乘积，生成密文计算结果Z，并基于同态密文Y与同态密文A之间的乘积，生成密文计算结果B。在一些实施方式中，密文计算结果Z可以为同态密文Y与同态密文X之间的乘积。示例性地，确定密文计算结果Z的方式参见公式： ；在一些实施方式中，密文计算结果B可以为同态密文Y与同态密文A之间的乘积。示例性地，确定密文计算结果B的方式参见公式： ；上述步骤S104中所述非中心参与方对接收的密文计算结果进行验证，可以包括以下步骤S117：步骤S117、非中心参与方基于密文计算结果Z、密文计算结果B、同态密文Y和同态密文D创建第一乘法证明，以证明密文计算结果Z是否基于同态密文Y与同态密文X之间的乘积生成。在一些实施方式中，上述步骤S117中所述第一乘法证明的验证过程，可以包括以下步骤S121至步骤S123：步骤S121、对密文计算结果Z与随机数e之间的乘积、与密文计算结果B进行求和，得到第一验证数据。步骤S122、对同态密文D与同态密文Y求乘积，得到第二验证数据。步骤S123、在第一验证数据与第二验证数据相等的情况下，证明密文计算结果Z通过验证。可以理解的是，第一乘法证明可以通过验证第一验证数据与第二验证数据是否相等，来证明密文计算结果Z是否基于同态密文Y与同态密文X之间的乘积生成。示例性地，在利用第一乘法证明验证第一验证数据与第二验证数据相等的情况下，若如下公式成立，则可以证明第一加密乘积数据是基于共享加密数据与第一加密数据之间的乘积生成的：；其中，密文和为第一验证数据，密文乘积/＞为第二验证数据。在一些实施方式中，上述步骤S116可以包括以下步骤S131和步骤S132：步骤S131、中心参与方将同态密文Y与同态密文X之间的乘积、与同态密文H进行求和，得到密文计算结果Z。示例性地，确定密文计算结果Z的方式参见公式：；其中，随机数据h为同态密文H被同态加密前的随机数据，噪音数据s为协同密钥对随机数据h进行同态加密的噪音数据。步骤S132、中心参与方将同态密文Y与同态密文A之间的乘积、与同态密文L进行求和，得到密文计算结果B。示例性地，确定密文计算结果B的方式参见公式：；其中，随机数据l为同态密文L被同态加密前的随机数据，噪音数据v为协同密钥对随机数据l进行同态加密的噪音数据。上述步骤S117中所述非中心参与方基于密文计算结果Z、密文计算结果B、同态密文Y和同态密文D创建第一乘法证明，可以包括以下步骤S133：步骤S133、非中心参与方基于密文计算结果Z、密文计算结果B、同态密文Y、同态密文D和同态密文F创建第一乘法证明，以证明密文计算结果Z是否为通过将同态密文Y与同态密文X之间的乘积、与同态密文H进行求和得到的。在一些实施方式中，上述步骤S133中所述第一乘法证明的验证过程，可以包括以下步骤S141至步骤S143：步骤S141、对密文计算结果Z与随机数e之间的乘积、与密文计算结果B进行求和，得到第一验证数据。步骤S142、对同态密文D与同态密文Y之间的乘积、与同态密文F进行求和，得到第三验证数据。步骤S143、在第一验证数据与第三验证数据相等的情况下，证明密文计算结果Z通过验证。可以理解的是，第一乘法证明可以通过验证第一验证数据与第三验证数据是否相等，来证明密文计算结果Z是否为通过将同态密文Y与同态密文X之间的乘积、与同态密文H进行求和得到的。示例性地，在利用第一乘法证明验证第一验证数据与第三验证数据相等的情况下，若如下公式成立，则可以证明密文计算结果Z是通过将同态密文Y与同态密文X之间的乘积、与同态密文H进行求和得到的：；其中，密文和为第三验证数据，随机数据f为同态密文F被同态加密前的随机数据，噪音数据w是对噪音数据s与随机数e之间的乘积、与噪音数据v进行求和得到的噪音数据。在一些实施方式中，上述零知识证明方法还可以包括以下步骤S151至步骤S154：S151、中心参与方或安全多方计算的各参与方对随机数据h进行同态加密得到同态密文H。S152、中心参与方或安全多方计算的各参与方对随机数据l进行同态加密得到同态密文L。S153、中心参与方或安全多方计算的各参与方对随机数据h与随机数e之间的乘积、与随机数据l进行求和得到随机数据f。S154、中心参与方或安全多方计算的各参与方对随机数据f进行同态加密得到同态密文F。在一些实施方式中，非中心参与方的数量为至少一个，随机数据h包括至少两个随机数据分片，随机数据l包括至少两个随机数据分片，随机数据f包括至少两个随机数据分片，同态密文H包括至少两个同态密文分片，同态密文L包括至少两个同态密文分片，同态密文F包括至少两个同态密文分片；随机数据h可以为安全多方计算的各参与方各自从明文域中选取的每一随机数据h的随机数据分片的和，随机数据l可以为安全多方计算的各参与方各自从明文域中选取的每一随机数据l的随机数据分片的和，随机数据f可以为安全多方计算的各参与方对各自选取的随机数据h的随机数据分片与随机数e之间的乘积、与各自选取的随机数据l的随机数据分片进行求和得到的每一随机数据f的随机数据分片的和；同态密文H可以为安全多方计算的各参与方对各自从明文域中选取的随机数据h的随机数据分片进行同态加密处理，得到的每一同态密文H的同态密文分片的和，同态密文L可以为安全多方计算的各参与方对各自从明文域中选取的随机数据l的随机数据分片进行同态加密处理，得到的每一同态密文L的同态密文分片的和，同态密文F可以为安全多方计算的各参与方对各自生成的随机数据f的随机数据分片进行同态加密处理，得到的每一同态密文F的同态密文分片的和；非中心参与方可以将生成的同态密文H的同态密文分片和同态密文L的同态密文分片发送至中心参与方，非中心参与方可以接收其他各参与方发送的同态密文F的同态密文分片，可以对得到的每一同态密文F的同态密文分片求和，得到同态密文F。在一些实施方式中，该零知识证明方法还可以包括以下步骤S161至步骤S166：S161、中心参与方从明文域中选取随机数据x和随机数据a。S162、中心参与方对随机数据x进行同态加密处理，得到同态密文X，并对随机数据a进行同态加密处理，得到同态密文A。S163、中心参与方对随机数据x与随机数e之间的乘积、与随机数据a进行求和，得到随机数据d。S164、中心参与方将同态密文X、同态密文A和随机数据d发送至非中心参与方。S165、非中心参与方对随机数据d进行同态加密处理，得到同态密文D。S166、非中心参与方基于同态密文X、同态密文A、同态密文D和随机数e创建第二乘法证明，以对同态密文X进行验证。在一些实施方式中，非中心参与方的数量为至少一个，随机数据x包括至少两个随机数据分片，随机数据a包括至少两个随机数据分片，随机数据d包括至少两个随机数据分片，同态密文X包括至少两个同态密文分片，同态密文A包括至少两个同态密文分片，同态密文D包括至少两个同态密文分片。该零知识证明方法还可以包括以下步骤S171至步骤S178：步骤S171、安全多方计算的各参与方对各自从明文域中选取的随机数据x的随机数据分片进行同态加密处理，得到同态密文X的同态密文分片，对各自从明文域中选取的随机数据a的随机数据分片进行同态加密处理，得到同态密文A的同态密文分片。步骤S172、非中心参与方将生成的同态密文X的同态密文分片和同态密文A的同态密文分片发送至中心参与方。步骤S173、安全多方计算的各参与方对各自选取的随机数据x的随机数据分片与随机数e之间的乘积、与各自选取的随机数据a的随机数据分片进行求和得到随机数据d的随机数据分片。步骤S174、安全多方计算的各参与方对各自生成的随机数据d的随机数据分片进行同态加密处理，得到同态密文D的同态密文分片，并广播各自得到的随机数据d的随机数据分片和同态密文D的同态密文分片。步骤S175、中心参与方对每一同态密文X的同态密文分片进行求和，得到同态密文X。示例性地，确定同态密文X的方式参见公式： ；其中，同态密文X^)为第i个非中心参与方生成的同态密文X的同态密文分片，同态密文X^)为第j个中心参与方生成的同态密文X的同态密文分片，随机数据x^)为第i个非中心参与方选取的随机数据x的随机数据分片，随机数据x^)为第j个中心参与方选取的随机数据x的随机数据分片，Σ为执行求和操作。步骤S176、中心参与方对每一同态密文A的同态密文分片进行求和，得到同态密文A。步骤S177、安全多方计算的各参与方对每一同态密文D的同态密文分片进行求和，得到同态密文D。步骤S178、中心参与方基于同态密文X、同态密文A、同态密文D和随机数e创建第二乘法证明，以对同态密文X进行验证。在一些实施方式中，上述步骤S166和步骤S178中所述第二乘法证明的验证过程，可以包括以下步骤S181和步骤S182：步骤S181、对同态密文X与随机数e之间的乘积、与同态密文A进行求和，得到第四验证数据。步骤S182、在第四验证数据与同态密文D相等的情况下，证明同态密文X是基于随机数据x生成的有效同态密文。可以理解的是，第二乘法证明可以通过验证第四验证数据与同态密文D是否相等，来证明同态密文X是否为基于随机数据x生成的有效同态密文。示例性地，在利用第二乘法证明验证第四验证数据与同态密文D相等的情况下，若如下公式成立，则可以证明同态密文X是基于随机数据x生成的有效同态密文：；本申请实施例提供一种安全多方计算系统，图2A为本申请实施例提供的一种安全多方计算系统的组成架构示意图一，如图2A所示，该安全多方计算系统200包括证明者P和验证者V。其中，证明者P和验证者V分别对应上述实施例中的中心参与方和非中心参与方，证明者P与验证者V之间进行数据交互。证明者P用于数据的生成、加密和计算。验证者V用于基于证明者P发送的数据创建乘法证明并进行数据有效性的验证。基于上述实施例提供的安全多方计算系统，本申请实施例提供一种零知识证明方法，该方法可以应用于安全多方计算协议中的离线阶段。图2B为本申请实施例提供的一种零知识证明方法的流程示意图二，如图2B所示，该方法包括如下步骤S201至步骤S216：步骤S201、选取。其中，由证明者P选取随机数据x和噪音数据r，记作，随机数据x按模为q的均匀随机分布随机选取自明文域，q为预先设定的值；噪音数据r按与底层同态加密算法相同的离散高斯分布选取。步骤S202、选取。其中，由证明者P选取随机数据h和噪音数据s，可记作；随机数据h按模为q的均匀随机分布随机选取自明文域，噪音数据s按与底层同态加密算法相同的离散高斯分布选取。步骤S203、计算X，X=Enc。其中，证明者P使用密钥和噪音数据r加密随机数据x得到同态密文X，得到的同态密文X可记作Enc。步骤S204、计算Z，。其中，证明者P对同态密文X和同态密文Y之间的乘积、与使用密钥和噪音数据s加密随机数据h得到的同态密文Enc求和，得到密文计算结果Z；同态密文Y为密文计算的结果密文或输入系统中的证明者P和验证者V各自选随机数据加密后的密文和。步骤S205、将X和Z发送至验证者V。其中，证明者P将同态密文X和密文计算结果Z发送至验证者V。步骤S206、选取。其中，由证明者P选取随机数据a和噪音数据u，记作；随机数据a按模为q的均匀随机分布随机选取自明文域，噪音数据u按与底层同态加密算法相同的离散高斯分布选取。步骤S207、选取。其中，由证明者P选取随机数据l和噪音数据v，可记作；随机数据l按模为q的均匀随机分布随机选取自明文域，噪音数据v按与底层同态加密算法相同的离散高斯分布选取。步骤S208、计算A，A=Enc。其中，证明者P使用密钥和噪音数据u加密随机数据a得到同态密文A，得到的同态密文A可记作Enc。步骤S209、计算B，。其中，证明者P对同态密文A和同态密文Y之间的乘积、与使用密钥和噪音数据v加密随机数据l得到的同态密文Enc求和，得到密文计算结果B。步骤S210、将A和B发送至验证者V。其中，证明者P将同态密文A和密文计算结果B发送至验证者V。步骤S211、选取e。其中，验证者V确定一个随机数e，e∈{0,1}。步骤S212、将e发送至证明者P。其中，验证者V将随机数e发送至证明者P。步骤S213、计算d，；计算t，/＞；计算f，/＞；计算w，。其中，证明者P对随机数e和随机数据x之间的乘积、与随机数据a求和得到随机数据d，对随机数e和噪音数据r之间的乘积、与噪音数据u求和得到噪音数据t，对随机数e和随机数据h之间的乘积、与随机数据l求和得到随机数据f，对随机数e和噪音数据s之间的乘积、与噪音数据v求和得到噪音数据w。步骤S214、将d、t、f、w发送至验证者V。其中，证明者P将随机数据d、随机数据t、噪音数据f、噪音数据w发送至验证者V。步骤S215、计算D，D=Enc；计算F，F=Enc。其中，验证者V使用密钥和噪音数据t加密随机数据d得到同态密文D，使用密钥和噪音数据w加密随机数据f得到同态密文F。步骤S216、验证；验证/＞。其中，验证者V对随机数e和同态密文X之间的乘积、与同态密文A求和得到第四验证数据，对随机数e和密文计算结果Z之间的乘积、与密文计算结果B求和得到第一验证数据/＞，对同态密文Y和同态密文D之间的乘积、与同态密文F求和得到第三验证数据/＞，创建第二乘法证明验证第四验证数据/＞与同态密文D相等，创建第一乘法证明验证第一验证数据/＞与第三验证数据/＞相等，且随机数据d和随机数据f的绝对值在二倍的明文域内，噪音数据t和噪音数据w的绝对值在二倍的用于加密的高斯噪音域内。本申请实施例中，在证明者P与验证者V已知同态密文Y的前提下，通过验证者V对第一乘法证明和第二乘法证明的验证，可以在证明者P未暴露原始数据的情况下，证明该证明者P正确计算了密文计算结果Z，从而实现了证明者P与验证者V之间验证密文计算结果的零知识证明。其中，步骤S216中通过利用第二乘法证明验证第四验证数据与同态密文D相等，验证了同态密文X的有效性。本申请实施例提供一种安全多方计算系统，图3A为本申请实施例提供的一种安全多方计算系统的组成架构示意图二，如图3A所示，该安全多方计算系统300包括中心参与方310和多个非中心参与方320。其中，中心参与方310与非中心参与方320之间进行数据交互。中心参与方310用于数据的生成、加密、计算以及基于非中心参与方320发送的数据创建乘法证明并进行数据有效性的验证。非中心参与方320用于数据的生成、加密、计算以及基于中心参与方310发送的数据创建乘法证明并进行数据有效性的验证。基于上述实施例提供的安全多方计算系统，本申请实施例提供一种零知识证明方法，该方法可以应用与安全多方计算协议中的离线阶段。图3B为本申请实施例提供的一种零知识证明方法的流程示意图三，如图3B所示，该方法包括如下步骤S301至步骤S311：步骤S301、中心参与方P_j和非中心参与方P_i获取同态密文Y和随机数e。其中，中心参与方P_j对应为上述安全多方计算系统中的中心参与方310，非中心参与方P_i对应为上述安全多方计算系统中的非中心参与方320，且满足j∈{j_1,j_2,…,j_k }，，/＞，其中， k为中心参与方P_j的数量，n为所有参与方的数量，i为第i个非中心参与方，且i为1≤i≤n的正整数。同态密文Y为密文计算的结果密文或输入系统中的中心参与方P_j和非中心参与方P_i各自选随机数据加密后的密文和，中心参与方P_j和非中心参与方P_i共同确定一个随机数e，其中e∈{0,1}。步骤S302、非中心参与方P_i选取随机数据分片x^)和噪音数据分片r^)，使用密钥和噪音数据分片r^)加密随机数据分片x^)得到同态密文分片X^)，并将同态密文分片X^)发送至中心参与方P_j；中心参与方P_j选取随机数据分片x^)和噪音数据分片r^)，使用密钥和噪音数据分片r^)加密随机数据分片x^)得到同态密文分片X^)。其中，随机数据分片x^)和x^)按模为q的均匀随机分布随机选取自明文域，噪音数据分片r^)和r^)按与底层同态加密算法相同的离散高斯分布选取，示例性地，非中心参与方P_i得到的同态密文分片X^)可记作X^)=Enc),r^))。步骤S303、非中心参与方P_i选取随机数据分片h^)和噪音数据分片s^)，使用密钥和噪音数据分片s^)加密随机数据分片h^)得到同态密文分片H^)，并将同态密文分片H^)发送至中心参与方P_j；中心参与方P_j选取随机数据分片h^)和噪音数据分片s^)，使用密钥和噪音数据分片s^)加密随机数据分片h^)得到同态密文分片H^)。其中，随机数据分片h^)和h^)按模为q的均匀随机分布随机选取自明文域，噪音数据分片s^)和s^)按与底层同态加密算法相同的离散高斯分布选取。步骤S304、中心参与方P_j对同态密文分片X^)和X^)求和得到同态密文X，对同态密文分片H^)和H^)求和得到同态密文H，对同态密文X和同态密文Y之间的乘积、与同态密文H求和，得到密文计算结果Z，并将密文计算结果Z发送至非中心参与方P_i。步骤S305、非中心参与方P_i选取随机数据分片a^)和噪音数据分片u^)，使用密钥和噪音数据分片u^)加密随机数据分片a^)得到同态密文分片A^)，并将同态密文分片A^)发送至中心参与方P_j；中心参与方P_j选取随机数据分片a^)和噪音数据分片u^)，使用密钥和噪音数据分片u^)加密随机数据分片a^)得到同态密文分片A^)。其中，随机数据分片a^)和a^)按模为q的均匀随机分布随机选取自明文域，噪音数据分片u^)和u^)按方差与底层同态加密算法相同的离散高斯分布选取。步骤S306、非中心参与方P_i选取随机数据分片l^)和噪音数据分片v^)，使用密钥和噪音数据分片v^)加密随机数据分片l^)得到同态密文分片L^)，并将同态密文分片L^)发送至中心参与方P_j；中心参与方P_j选取随机数据分片l^)和噪音数据分片v^)，使用密钥和噪音数据分片v^)加密随机数据分片l^)得到同态密文分片L^)。其中，随机数据分片l^)和l^)按模为q的均匀随机分布随机选取自明文域，噪音数据分片v^)和v^)按方差与底层同态加密算法相同的离散高斯分布选取。步骤S307、中心参与方P_j对同态密文分片A^)和A^)求和得到同态密文A，对同态密文分片L^)和L^)求和得到同态密文L，对同态密文A和同态密文Y之间的乘积、与同态密文L求和，得到密文计算结果B，并将密文计算结果B发送至非中心参与方P_i。步骤S308、非中心参与方P_i对随机数e和随机数据分片x^)之间的乘积、与随机数据分片a^)求和得到随机数据分片d^)，对随机数e和随机数据分片h^)之间的乘积、与随机数据分片l^)求和得到随机数据分片f^)，对随机数e和噪音数据分片r^)之间的乘积、与噪音数据分片u^)求和得到噪音数据分片t^)，对随机数e和噪音数据分片s^)之间的乘积、与噪音数据分片v^)求和得到噪音数据分片w^)，并广播随机数据分片d^)、随机数据分片f^)、噪音数据分片t^)以及噪音数据分片w^)；中心参与方P_j对随机数e和随机数据分片x^)之间的乘积、与随机数据分片a^)求和得到随机数据分片d^)，对随机数e和随机数据分片h^)之间的乘积、与随机数据分片l^)求和得到随机数据分片f^)，对随机数e和噪音数据分片r^)之间的乘积、与噪音数据分片u^)求和得到噪音数据分片t^)，对随机数e和噪音数据分片s^)之间的乘积、与噪音数据分片v^)求和得到噪音数据分片w^)。步骤S309、非中心参与方P_i使用密钥和噪音数据分片t^)加密随机数据分片d^)得到同态密文分片D^)，使用密钥和噪音数据分片w^)加密随机数据分片f^)得到同态密文分片F^)，并广播同态密文分片D^)；中心参与方P_j使用密钥和噪音数据分片t^)加密随机数据分片d^)得到同态密文分片D^)，使用密钥和噪音数据分片w^)加密随机数据分片f^)得到同态密文分片F^)，并广播同态密文分片D^)和同态密文分片F^)。步骤S310、中心参与方P_j对随机数据分片d^)和d^)、随机数据分片f^)和f^)、噪音数据分片t^)和t^)以及噪音数据分片w^)和w^)分别求和得到随机数据d、随机数据f、噪音数据t以及噪音数据w，对同态密文分片D^)和D^)求和得到同态密文D，对随机数e和同态密文X之间的乘积、与同态密文A求和得到第四验证数据，创建第二乘法证明验证第四验证数据/＞与同态密文D相等。其中，随机数据d和随机数据f的绝对值在2n倍的明文域内，噪音数据t和噪音数据w的绝对值在2n倍的用于加密的高斯噪音域内。步骤S311、非中心参与方P_i对随机数据分片d^)和d^)、随机数据分片f^)和f^)、噪音数据分片t^)和t^)以及噪音数据分片w^)和w^)分别求和得到随机数据d、随机数据f、噪音数据t以及噪音数据w，对同态密文分片D^)和D^)、同态密文分片F^)和F^)分别求和得到同态密文D和同态密文F，对随机数e和密文计算结果Z之间的乘积、与密文计算结果B求和得到第一验证数据，对同态密文Y和同态密文D之间的乘积、与同态密文F求和得到第三验证数据/＞，创建第一乘法证明验证第一验证数据/＞与第三验证数据/＞相等。其中，随机数据d和随机数据f的绝对值在2n倍的明文域内，噪音数据t和噪音数据w的绝对值在2n倍的用于加密的高斯噪音域内。本申请实施例中，将上一个实施例扩展到了多方全局情况，在数量可能为多个的中心参与方P_j与非中心参与方P_i已知同态密文Y的前提下，给出了多方全局情况下验证密文计算结果的零知识证明方法。其中，在步骤S310中通过利用第二乘法证明验证第四验证数据与同态密文D相等，验证了同态密文X为基于中心参与方P_j未知的随机数据分片得到的同态加密数据和，即验证了同态密文X的有效性。在步骤S311中通过利用第一乘法证明验证第一验证数据与第三验证数据相等，验证了密文计算结果Z为基于同态密文X和同态密文Y得到的，即验证了密文计算结果Z的有效性。当本申请实施例中只选取一个中心参与方P_j，即k=1时，整个系统需要传输6n+2n^2个同态密文。SPDZ系列协议为了保护私有数据x∈F不泄漏给除了数据拥有者之外的其他参与方并同时验证其合法性，x具有数据结构_F= ),…,x^ ),m^ ),…,m^ ),Δ^ ),…,Δ^))。其中，n为参与方的个数，各参与方P_n持有随机数据分片x^ )，随机MAC分片m^ )和MAC密钥分片Δ^ )，在有限域F上，，，/＞，并满足MAC关系/＞。HighGear协议采用全同态公钥加密算法、其他同态加密算法或同态算法的私钥加密算法进行数据加密。以HighGear协议中Triple数据的生成协议为例，随机数据c为随机数据a和随机数据b之间的乘积。其中，随机数据a为随机数据分片a^)的和，随机数据b为随机数据分片b^)的和，随机数据c为随机数据分片c^)的和，各参与方P_n在本地选取随机数据分片a^)和随机数据分片b^)作为输入，输出随机数据分片c^)、随机数据分片〖am〗^)、随机数据分片〖bm〗^)以及随机数据分片〖cm〗^)。其中，随机数据分片〖am〗^)、随机数据分片〖bm〗^)以及随机数据分片〖cm〗^)分别为随机数据分片a^)和随机数据分片b^)以及随机数据分片c^)的MAC分片，随机数据am为随机数据a和随机数据Δ之间的乘积，随机数据bm为随机数据b和随机数据Δ之间的乘积，随机数据cm为随机数据c和随机数据Δ之间的乘积，随机数据Δ为随机数据分片Δ^)的和，随机数据分片Δ^)为各参与方P_i持有的MAC密钥分片。在此基础上，本申请实施例提供一种安全多方计算协议离线阶段的通信方法，用于HighGear协议中生成Triple数据，采用了多方全局情况下的零知识证明，其中，各参与方通过广播来保证协议每一步的数据同步。图4为本申请实施例提供的一种安全多方计算协议离线阶段的通信方法的流程示意图，如图4所示，该方法包括如下步骤S401至步骤S405：步骤S401、中心参与方P_j和非中心参与方P_i通过零知识证明方法得到同态密文Enc并验证同态密文Enc的有效性。其中，中心参与方P_j对应为上述安全多方计算系统中的中心参与方，非中心参与方P_i对应为上述安全多方计算系统中的非中心参与方，且满足j∈{j_1,j_2,…,j_k }，，/＞，其中， k为中心参与方P_j的数量，n为所有参与方的数量，i为第i个非中心参与方，且i为1≤i≤n的正整数。同态密文Enc为对随机数据Δ进行同态加密处理后的密文结果，随机数据Δ为MAC密钥，随机数据Δ为随机数据分片Δ^ )和Δ^ )的和，随机数据分片 Δ^ )和Δ^ )为MAC密钥分片，随机数据分片 Δ^ )和Δ^ )由非中心参与方P_i和中心参与方P_j按模为q的均匀随机分布随机选取自明文域。步骤S402、中心参与方P_j计算并广播密文计算结果，非中心参与方P_i验证其有效性。其中，密文计算结果为同态密文Enc与同态密文Enc的乘积，同态密文Enc为对随机数据a进行同态加密处理后的密文结果，随机数据a为随机数据分片a^ )和a^ )的和，随机数据分片a^ )和a^ )分别由非中心参与方P_i和中心参与方P_j按模为q的均匀随机分布随机选取自明文域。步骤S403、中心参与方P_j计算并广播密文计算结果Enc∙Enc，非中心参与方P_i验证其有效性。其中，密文计算结果为同态密文Enc与同态密文Enc的乘积，同态密文Enc为对随机数据b进行同态加密处理后的密文结果，随机数据b为随机数据分片b^ )和b^ )的和，随机数据分片b^ )和b^ )分别由非中心参与方P_i和中心参与方P_j按模为q的均匀随机分布随机选取自明文域。/＞步骤S404、中心参与方P_j生成并广播同态密文Enc，非中心参与方P_i验证其有效性。其中，同态密文Enc为密文计算结果，即同态密文Enc与同态密文Enc的乘积。步骤S405、中心参与方P_j计算并广播密文计算结果，非中心参与方P_i验证其有效性。其中，密文计算结果为同态密文Enc与同态密文Enc的乘积。在一些实施方式中，上述步骤S401可以包括如下步骤S411至步骤S418：步骤S411、中心参与方P_j和非中心参与方P_i获取随机数e，其中e∈{0,1}。步骤S412、非中心参与方P_i选取随机数据分片Δ^ )，加密随机数据分片Δ^ )得到同态密文分片Enc ))，并将同态密文分片Enc ))发送至中心参与方P_j；中心参与方P_j选取随机数据分片Δ^ )，加密随机数据分片Δ^ )得到加密数据分片Enc ))。其中，随机数据分片Δ^ )和Δ^ )以及同态密文分片Enc ))和Enc ))分别对应为上述实施例中的随机数据x的随机数据分片以及同态密文X的同态密文分片。步骤S413、中心参与方P_j对同态密文分片Enc ))和Enc ))求和得到同态密文Enc。其中，同态密文Enc对应为上述实施例中的同态密文X。步骤S414、非中心参与方P_i选取随机数据分片g^)，加密随机数据分片g^)得到同态密文分片Enc ))，并将同态密文分片Enc ))发送至中心参与方P_j；中心参与方P_j选取随机数据分片g^)，加密随机数据分片g^)得到同态密文分片Enc ))。其中，随机数据分片g^)和g^)以及同态密文分片Enc ))和Enc ))分别对应为上述实施例中的随机数据a的随机数据分片以及同态密文A的同态密文分片，且随机数据分片g^)和g^)按模为q的均匀随机分布随机选取自明文域。步骤S415、中心参与方P_j对同态密文分片Enc ))和Enc ))求和得到同态密文Enc。其中，同态密文Enc对应为上述实施例中的同态密文A。步骤S416、非中心参与方P_i对随机数e和随机数据分片Δ^)之间的乘积、与随机数据分片g^)求和得到随机数据分片d^)，并广播随机数据分片d^)，中心参与方P_j对随机数e和随机数据分片Δ^)之间的乘积、与随机数据分片g^)求和得到随机数据分片d^)。步骤S417、非中心参与方P_i加密随机数据分片d^)得到同态密文分片Enc ))，并广播同态密文分片Enc ))；中心参与方P_j加密随机数据分片d^)得到同态密文分片Enc ))。步骤S418、中心参与方P_j对随机数据分片d^)和d^)求和得到随机数据d，对同态密文分片Enc ))和Enc ))求和得到同态密文Enc，对随机数e和同态密文Enc之间的乘积、与同态密文Enc求和得到验证数据，创建乘法证明验证验证数据/＞与同态密文Enc相等，且随机数据d的绝对值在2n倍的明文域内，若验证通过，将同态密文Enc发送至非中心参与方P_i。其中，验证数据对应为上述实施例中第四验证数据。中心参与方P_j利用乘法证明验证同态密文Enc与验证数据/＞相等验证了同态密文Enc为基于未暴露的随机数据分片Δ^)得到的同态密文，即验证了同态密文Enc的有效性。在一些实施方式中，上述步骤S402可以包括如下步骤S421至步骤S429：步骤S421、中心参与方P_j和非中心参与方P_i共同确定一个随机数y， y∈{0,1}。其中，随机数y对应为上述实施例中的随机数e。步骤S422、非中心参与方P_i选取随机数据分片a^)和噪音数据分片r^)，使用密钥和噪音数据分片r^)加密随机数据分片a^)得到同态密文分片Enc ))，并将同态密文分片Enc ))发送至中心参与方P_j；中心参与方P_j选取随机数据分片a^ )和噪音数据分片r^)，使用密钥和噪音数据分片r^)加密随机数据分片a^ )得到同态密文Enc ))。其中，随机数据分片a^ )和a^ )以及同态密文分片 Enc ))和Enc ))分别对应为上述实施例中的随机数据x的随机数据分片以及同态密文X的同态密文分片，噪音数据分片r^)和r^)按与底层同态加密算法相同的离散高斯分布选取。步骤S423、中心参与方P_j对同态密文分片Enc ))和Enc ))求和得到同态密文Enc，对同态密文Enc和同态密文Enc求乘积，得到密文计算结果并将密文计算结果/＞发送至非中心参与方P_i。其中，同态密文Enc、同态密文Enc以及密文计算结果分别对应为上述实施例中的同态密文X、同态密文Y以及密文计算结果Z。步骤S424、非中心参与方P_i选取随机数据分片h^)和噪音数据分片u^)，使用密钥和噪音数据分片u^)加密数据分片h^)得到同态密文分片Enc ))，并将同态密文分片Enc ))发送至中心参与方P_j；中心参与方P_j选取随机数据分片h^)和噪音数据分片u^)，使用密钥和噪音数据分片u^)加密随机数据分片h^)得到同态密文分片Enc ))。其中，随机数据分片h^)和h^)以及同态密文分片Enc )) 和Enc ))分别对应为上述实施例中的随机数据a的随机数据分片以及同态密文A的同态密文分片，随机数据分片h^)和h^)按模为q的均匀随机分布随机选取自明文域，噪音数据分片u^)和u^)按与底层同态加密算法相同的离散高斯分布选取。步骤S425、中心参与方P_j对同态密文分片Enc ))和Enc ))求和得到同态密文Enc，对同态密文Enc和同态密文Enc求乘积，得到密文计算结果Enc∙Enc，并将密文计算结果Enc∙Enc发送至非中心参与方P_i。其中，同态密文Enc和密文计算结果Enc∙Enc分别对应为上述实施例中的同态密文A和密文计算结果B。步骤S426、非中心参与方P_i对随机数y和随机数据分片a^)之间的乘积、与随机数据分片h^)求和得到随机数据分片t^)，并广播随机数据分片t^)，中心参与方P_j对随机数y和随机数据分片a^)之间的乘积、与随机数据分片h^)求和得到随机数据分片t^)，并广播随机数据分片t^)。其中，随机数据分片t^)和t^)对应为上述实施例中的随机数据d的随机数据分片。步骤S427、非中心参与方P_i加密随机数据分片t^)得到同态密文分片Enc ))，并广播同态密文分片Enc ))；中心参与方P_j加密随机数据分片t^)得到同态密文分片Enc ))，并广播同态密文分片Enc ))。其中，同态密文分片Enc ))和Enc ))对应为上述实施例中的同态密文D的同态密文分片。步骤S428、中心参与方P_j对随机数据分片t^)和t^)求和得到随机数据t，对同态密文分片Enc ))和Enc ))求和得到同态密文Enc，对随机数y和同态密文Enc之间的乘积、与同态密文Enc求和得到验证数据，创建乘法证明验证同态密文Enc与验证数据/＞相等，且随机数据t的绝对值在2n倍的明文域内。其中，随机数据t、同态密文Enc以及验证数据 分别对应为上述实施例中的随机数据d、同态密文D以及第四验证数据。中心参与方P_j利用乘法证明验证同态密文Enc与验证数据/＞相等验证了同态密文Enc为基于未暴露的随机数据分片a^)得到的同态密文，即验证了同态密文Enc的有效性。步骤S429、非中心参与方P_i对随机数据分片t^)和t^)求和得到随机数据t，对同态密文分片Enc ))和Enc ))求和得到同态密文Enc，对随机数y和密文计算结果之间的乘积、与密文计算结果/＞求和得到验证数据/＞，对同态密文Enc和同态密文Enc求乘积得到验证数据/＞，创建乘法证明验证验证数据/＞与验证数据/＞相等，且随机数据t的绝对值在2n倍的明文域内。其中，验证数据和验证数据/＞分别对应为上述实施例中的第一验证数据和第二验证数据。在步骤S428验证了同态密文Enc有效性的前提下，非中心参与方P_i利用乘法证明验证验证数据与验证数据/＞相等验证了密文计算结果/＞为基于同态密文Enc和同态密文Enc得到的，即验证了密文计算结果/＞的有效性。在一些实施方式中，上述步骤S403可以包括如下步骤S431：步骤S431、重复步骤S421至步骤S429，所有随机数据分片由中心参与方P_j和非中心参与方P_i重新选取或计算，随机数由中心参与方P_j和非中心参与方P_i共同重新确定。其中，随机数据分片b^ )和b^ )对应为上述实施例中的随机数据x的随机数据分片。与生成并验证同态密文Enc和密文计算结果同理，可生成并验证同态密文Enc和密文计算结果/＞。在一些实施方式中，上述步骤S404可以包括如下步骤S441至步骤S446：步骤S441、中心参与方P_j和非中心参与方P_i共同确定一个随机数z，z∈{0,1}。其中，随机数z对应为上述实施例中的随机数e。步骤S442、非中心参与方P_i选取随机数据分片m^)和噪音数据分片l^)，使用密钥和噪音数据分片l^)加密数据分片m^)得到同态密文分片Enc ))，并将同态密文分片Enc ))发送至中心参与方P_j；中心参与方P_j选取随机数据分片m^)和噪音数据分片l^)，使用密钥和噪音数据分片l^)加密随机数据分片m^)得到同态密文分片Enc ))。其中，随机数据分片m^)和m^)以及同态密文分片Enc ))和Enc ))分别对应为上述实施例中的随机数据a的随机数据分片以及同态密文A的同态密文分片，随机数据分片m^)和m^)按模为q的均匀随机分布随机选取自明文域，噪音数据分片l^)和l^)按与底层同态加密算法相同的离散高斯分布选取。步骤S443、中心参与方P_j对同态密文分片Enc ))和Enc ))求和得到同态密文Enc，对同态密文Enc和同态密文Enc求乘积，得到密文计算结果，对同态密文Enc和同态密文Enc求乘积得到同态密文Enc，并将密文计算结果/＞和同态密文Enc发送至非中心参与方P_i。其中，同态密文Enc为的密文计算结果，随机数据c为对同态密文Enc进行解密计算得到的数据，随机数据c为随机数据分片c^ )和c^ )的和，同态密文Enc、同态密文Enc、密文计算结果Enc∙Enc以及同态密文Enc分别对应为上述实施例中的同态密文A、同态密文Y、密文计算结果B以及密文计算结果Z。步骤S444、非中心参与方P_i对随机数z和随机数据分片a^)之间的乘积、与随机数据分片m^)求和得到随机数据分片v^)，并广播随机数据分片v^)，中心参与方P_j对随机数z和随机数据分片a^)之间的乘积、与随机数据分片m^)求和得到随机数据分片v^)，并广播随机数据分片v^)。其中，随机数据分片v^)和v^)以及随机数据分片a^)和a^)分别对应为上述实施例中的随机数据d为随机数据分片和随机数据x为随机数据分片。步骤S445、非中心参与方P_i加密随机数据分片v^)得到同态密文分片Enc ))，并广播同态密文分片Enc ))；中心参与方P_j加密随机数据分片v^)得到同态密文分片Enc ))，并广播同态密文分片Enc ))。其中，同态密文分片Enc ))和Enc ))对应为上述实施例中的同态密文D的同态密文分片。步骤S446、非中心参与方P_i对随机数据分片v^)和v^)求和得到随机数据v，对同态密文分片Enc )) 和Enc ))求和得到同态密文Enc，对随机数z和同态密文Enc之间的乘积、与密文计算结果求和得到验证数据，对同态密文Enc和同态密文Enc求乘积得到验证数据，创建乘法证明验证验证数据/＞与验证数据相等，且随机数据v的绝对值在2n倍的明文域内。其中，随机数据v、同态密文Enc以及验证数据分别对应为上述实施例中的随机数据d、同态密文D以及第四验证数据，乘法证明对应为上述实施例中的第一乘法证明。在步骤S402和步骤S403验证了同态密文Enc和同态密文Enc的有效性的前提下，中心参与方P_j利用乘法证明验证验证数据与验证数据/＞相等，从而可以验证同态密文Enc为基于同态密文Enc和同态密文Enc得到的，即验证了同态密文Enc的有效性。在一些实施方式中，上述步骤S405可以包括如下步骤S451：步骤S451、重复步骤S421至步骤S429，除随机数据分片c^ )和c^ )外所有随机数据分片由中心参与方P_j和非中心参与方P_i重新选取或计算，随机数由中心参与方P_j和非中心参与方P_i共同重新确定。其中，随机数据分片c^ )和c^ )对应为上述实施例中的随机数据x为随机数据分片，是基于同态密文 Enc计算得到的。与生成并验证密文计算结果同理，可生成并验证密文计算结果/＞。在本申请实施例中，通过各参与方之间采用多次零知识证明方法在步骤S401、步骤S402、步骤S403、步骤S404以及步骤S405中分别生成并验证同态密文Enc、密文计算结果、密文计算结果/＞、密文计算结果/＞以及密文计算结果/＞，其中，密文计算结果/＞计算为同态密文Enc，再对以上五种数据分别进行解密计算得到其数据分片，作为HighGear协议中的Triple数据。其中，生成并验证同态密文Enc需要通信3n^2个同态密文与3n^2个环多项式，计算密文计算结果与密文计算结果/＞及其数据分片分别需要通信n^2+4个同态密文和3n^2个环多项式，计算同态密文Enc与密文计算结果及其数据分片需要2n^2个环多项式，整个生成过程仅需5n^2+8n个同态密文以及11n^2个环多项式。若通过所有参与方各自生成并验证同态密文Enc、Enc、Enc、Enc、Enc、Enc以及Enc的方式生成数据，则需要通信9n^2个同态密文以及13n^2个环多项式。由此，本申请实施例提供的零知识证明方法可以有效降低HighGear协议中离线阶段的通信复杂度。本申请实施例提供了一种安全多方计算系统。图5为本申请实施例提供的一种安全多方计算系统的组成结构示意图，如图5所示，该安全多方计算系统500包括：中心参与方501和非中心参与方502；其中，所述中心参与方501为所述安全多方计算的部分参与方；所述中心参与方501是由安全多方计算的各参与方共同选取的；所述非中心参与方502为所述安全多方计算中除所述中心参与方之外的所有其他参与方；中心参与方501，用于获取同态密文，并基于所述同态密文进行密文计算，得到密文计算结果；其中，所述同态密文由所述中心参与方501和/或非中心参与方502生成；将所述密文计算结果发送至所述非中心参与方502；在所述非中心参与方502对所述密文计算结果验证通过的情况下，确定所述密文计算结果为可信的共享数据；非中心参与方502，用于对接收的所述密文计算结果进行验证；在所述非中心参与方502对所述密文计算结果验证通过的情况下，确定所述密文计算结果为可信的共享数据。在一些实施例中，所述密文计算结果包括密文计算结果Z和密文计算结果B；所述安全多方计算的各参与方获取同态密文Y和随机数e；其中，所述同态密文Y为所述安全多方计算中各参与方共享的同态密文；所述中心参与方，用于基于所述同态密文Y与同态密文X之间的乘积，生成所述密文计算结果Z，并基于所述同态密文Y与同态密文A之间的乘积，生成所述密文计算结果B；所述非中心参与方，用于基于所述密文计算结果Z、所述密文计算结果B、同态密文Y和同态密文D创建第一乘法证明，以证明所述密文计算结果Z是否基于所述同态密文Y与所述同态密文X之间的乘积生成。在一些实施例中，所述非中心参与方或所述安全多方计算的各参与方共同确定所述随机数e；所述中心参与方或所述安全多方计算的各参与方对随机数据x进行同态加密得到所述同态密文X，对随机数据a进行同态加密得到所述同态密文A；所述中心参与方或所述安全多方计算的各参与方对所述随机数据x与所述随机数e之间的乘积、与所述随机数据a进行求和得到随机数据d；所述非中心参与方或所述安全多方计算的各参与方对所述随机数据d进行同态加密得到所述同态密文D。在一些实施例中，所述第一乘法证明的验证过程包括：对所述密文计算结果Z与所述随机数e之间的乘积、与所述密文计算结果B进行求和，得到第一验证数据；对所述同态密文D与所述同态密文Y求乘积，得到第二验证数据；在所述第一验证数据与所述第二验证数据相等的情况下，证明所述密文计算结果Z通过验证。在一些实施例中，所述中心参与方，用于将所述同态密文Y与所述同态密文X之间的乘积、与同态密文H进行求和，得到密文计算结果Z；将所述同态密文Y与所述同态密文A之间的乘积、与同态密文L进行求和，得到密文计算结果B；所述非中心参与方，用于基于所述密文计算结果Z、所述密文计算结果B、所述同态密文Y、所述同态密文D和同态密文F创建第一乘法证明，以证明所述密文计算结果Z是否为通过将所述同态密文Y与所述同态密文X之间的乘积、与所述同态密文H进行求和得到的。在一些实施例中，所述中心参与方或所述安全多方计算的各参与方对随机数据h进行同态加密得到所述同态密文H；所述中心参与方或所述安全多方计算的各参与方对随机数据l进行同态加密得到所述同态密文L；所述中心参与方或所述安全多方计算的各参与方对所述随机数据h与所述随机数e之间的乘积、与所述随机数据l进行求和得到随机数据f；所述中心参与方或所述安全多方计算的各参与方对所述随机数据f进行同态加密得到所述同态密文F。在一些实施例中，所述第一乘法证明的验证过程包括：对所述密文计算结果Z与所述随机数e之间的乘积、与所述密文计算结果B进行求和，得到第一验证数据；对所述同态密文D与所述同态密文Y之间的乘积、与所述同态密文F进行求和，得到第三验证数据；在所述第一验证数据与所述第三验证数据相等的情况下，证明所述密文计算结果Z通过验证。在一些实施例中，所述中心参与方，还用于从明文域中选取随机数据x和随机数据a；对所述随机数据x进行同态加密处理，得到所述同态密文X，并对所述随机数据a进行同态加密处理，得到所述同态密文A；对所述随机数据x与所述随机数e之间的乘积、与所述随机数据a进行求和，得到随机数据d；将所述同态密文X、所述同态密文A和所述随机数据d发送至所述非中心参与方；所述非中心参与方，还用于对所述随机数据d进行同态加密处理，得到所述同态密文D；所述非中心参与方基于所述同态密文X、所述同态密文A、所述同态密文D和所述随机数e创建第二乘法证明，以对所述同态密文X进行验证。在一些实施例中，所述非中心参与方的数量为至少一个，所述同态密文X包括至少两个同态密文分片，所述同态密文A包括至少两个同态密文分片，所述同态密文D包括至少两个同态密文分片；所述安全多方计算的各参与方对每一所述同态密文D的同态密文分片进行求和，得到所述同态密文D；所述中心参与方，还用于对每一所述同态密文X的同态密文分片进行求和，得到所述同态密文X；对每一所述同态密文A的同态密文分片进行求和，得到所述同态密文A；基于所述同态密文X、所述同态密文A、所述同态密文D和所述随机数e创建第二乘法证明，以对所述同态密文X进行验证。在一些实施例中，随机数据x包括至少两个随机数据分片，随机数据a包括至少两个随机数据分片，随机数据d包括至少两个随机数据分片；所述安全多方计算的各参与方对各自从明文域中选取的所述随机数据x的随机数据分片进行同态加密处理，得到所述同态密文X的同态密文分片，对各自从明文域中选取的所述随机数据a的随机数据分片进行同态加密处理，得到所述同态密文A的同态密文分片；所述安全多方计算的各参与方对各自选取的所述随机数据x的随机数据分片与所述随机数e之间的乘积、与各自选取的所述随机数据a的随机数据分片进行求和得到所述随机数据d的随机数据分片；所述安全多方计算的各参与方对各自生成的所述随机数据d的随机数据分片进行同态加密处理，得到所述同态密文D的同态密文分片，并广播各自得到的所述随机数据d的随机数据分片和所述同态密文D的同态密文分片；所述非中心参与方，用于将生成的所述同态密文X的同态密文分片和所述同态密文A的同态密文分片发送至所述中心参与方。在一些实施例中，所述第二乘法证明的验证过程包括：对所述同态密文X与所述随机数e之间的乘积、与所述同态密文A进行求和，得到第四验证数据；在所述第四验证数据与所述同态密文D相等的情况下，证明所述同态密文X是基于所述随机数据x生成的有效同态密文。本申请是参照根据本申请实施例的方法和系统的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。以上所述，仅为本申请的具体实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本申请的保护范围之内。以上系统实施例的描述，与上述方法实施例的描述是类似的，具有同方法实施例相似的有益效果。对于本申请系统实施例中未披露的技术细节，请参照本申请方法实施例的描述而理解。应理解，说明书通篇中提到的“一个实施例”或“一实施例”意味着与实施例有关的特定特征、结构或特性包括在本申请的至少一个实施例中。因此，在整个说明书各处出现的“在一个实施例中”或“在一实施例中”未必一定指相同的实施例。此外，这些特定的特征、结构或特性可以任意适合的方式结合在一个或多个实施例中。应理解，在本申请的各种实施例中，上述各过程的序号的大小并不意味着执行顺序的先后，各过程的执行顺序应以其功能和内在逻辑确定，而不应对本申请实施例的实施过程构成任何限定。上述本申请实施例序号仅仅为了描述，不代表实施例的优劣。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者装置中还存在另外的相同要素。在本申请所提供的几个实施例中，应该理解到，所揭露的设备和方法，可以通过其它的方式实现。以上所描述的设备实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，如：多个单元或组件可以结合，或可以集成到另一个系统，或一些特征可以忽略，或不执行。另外，所显示或讨论的各组成部分相互之间的耦合、或直接耦合、或通信连接可以是通过一些接口，设备或单元的间接耦合或通信连接，可以是电性的、机械的或其它形式的。上述作为分离部件说明的单元可以是、或也可以不是物理上分开的，作为单元显示的部件可以是、或也可以不是物理单元；既可以位于一个地方，也可以分布到多个网络单元上；可以根据实际的需要选择其中的部分或全部单元来实现本实施例方案的目的。另外，在本申请各实施例中的各功能单元可以全部集成在一个处理单元中，也可以是各单元分别单独作为一个单元，也可以两个或两个以上单元集成在一个单元中；上述集成的单元既可以采用硬件的形式实现，也可以采用硬件加软件功能单元的形式实现。本领域普通技术人员可以理解：实现上述方法实施例的全部或部分步骤可以通过程序指令相关的硬件来完成，前述的程序可以存储于计算机可读取存储介质中，该程序在执行时，执行包括上述方法实施例的步骤；而前述的存储介质包括：移动存储设备、只读存储器、磁碟或者光盘等各种可以存储程序代码的介质。或者，本申请上述集成的单元如果以软件功能模块的形式实现并作为独立的产品销售或使用时，也可以存储在一个计算机可读取存储介质中。基于这样的理解，本申请实施例的技术方案本质上或者说对相关技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本申请各个实施例所述方法的全部或部分。而前述的存储介质包括：移动存储设备、ROM、磁碟或者光盘等各种可以存储程序代码的介质。以上所述，仅为本申请的实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本申请的保护范围之内。
