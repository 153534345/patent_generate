标题title
贴片机飞达排布优化方法及系统、存储介质
摘要abst
本发明涉及贴装优化技术领域，具体公开了一种贴片机飞达排布优化方法及系统、存储介质，所述方法将元件按类型排列，得到飞达初始排列顺序；依据贴装坐标计算序列里相邻类型元件之间的类型距离总和；统计某类型元件在排列顺序中不同排位下的类型距离总和，取最小值所对应的排位作为调整所述第k个位置的元件类型的排列顺序；在前次调整后的排列顺序基础上，调整其余各类型元件的排列顺序，得到飞达最终排布顺序。该方案从分析PCB物料元件的特征出发，设计了一种决策策略，根据不同元件之间的位置相互关系，进行飞达的排布和调整，优化飞达的物料和顺序的分配，计算简单且快速，耗时短，没有复杂的迭代过程，鲁棒性强，结果稳定。
权利要求书clms
1.一种贴片机飞达排布优化方法，其特征在于，包括以下步骤：获取待贴装的元件类型以及各元件的贴装坐标，将元件按类型排列，得到飞达初始排列顺序；依据贴装坐标计算序列里相邻类型元件之间的类型距离总和；依据相邻类型元件之间的类型距离总和，统计某类型元件在排列顺序中不同排位下的类型距离总和，取所有类型距离总和的最小值所对应的排位作为调整第k个位置的元件类型的排列顺序；在前次调整后的排列顺序基础上，调整其余各类型元件的排列顺序，得到飞达最终排布顺序。2.根据权利要求1所述的方法，其特征在于，所述依据贴装坐标计算序列里相邻类型元件之间的类型距离总和包括以下过程：计算序列里第k个位置的元件类型里的第r个元件到序列里第k+1个位置的元件类型里所有元件的距离，并取其中距离的最小值作为第r个元件到序列里第k+1个位置的元件类型里所有元件的距离值，即点到类型距离；取序列里第k个位置的元件类型里所有元件的点到类型距离的中值作为第k个位置的元件类型到第k+1个位置的元件类型的类型到类型距离；根据排列顺序，依次计算相邻序列元件之间的类型到类型距离，然后求和，得到类型距离总和。3.根据权利要求2所述的方法，其特征在于，所述点到类型距离BDis公式为：BDis = min)，BDis = ||Btk,r - Btk+1,s ||其中，Ptk,r、Btk,r分别表示第k个位置的元件类型里的第r个元件及其坐标，Ptk+1,s、Btk+1,s分别表示第k+1个位置的元件类型里的第s个元件及其坐标，BDis表示元件Ptk,r到元件Ptk+1,s的欧式距离。4.根据权利要求2所述的方法，其特征在于，所述类型到类型距离BDis公式为：BDis = media)，所述类型距离总和BDis公式为：BDis =∑k)。5.根据权利要求1所述的方法，其特征在于，所述方法还包括：根据待贴装元件的贴装坐标获取贴装中心，根据贴装中心确定飞达排布在飞达基座的站位。6.根据权利要求5所述的方法，其特征在于，所述根据待贴装元件的贴装坐标获取贴装中心计算公式如下：BC=∑k∑rBtk,r/N，N表示待贴装元件个数，Btk,r表示第k个位置的元件类型里的第r个元件坐标，BC表示贴装中心坐标；所述飞达排布在飞达基座的站位具体如下：，其中，Nbfd表示放置飞达的起始站位号，Pmark表示预设的贴装标记点，Pfd表示飞达站位起始位置，Spfd飞达站位间隔。7.根据权利要求1-6中任一所述的方法，其特征在于，所述方法还包括获取待贴装的元件类型对应的数量，将各类型元件按数量降序排列，得到所述飞达初始排列顺序。8.根据权利要求7所述的方法，其特征在于，通过获取并解析PCB板上元件类型的BOM表，获取待贴装的元件类型及对应的数量；通过获取并解析PCB板的坐标文件获取各元件的贴装坐标。9.一种贴片机飞达排布优化系统，其特征在于，包括：初始排列顺序解析模块，用于获取待贴装的元件类型以及各元件的贴装坐标，将元件按类型排列，得到飞达初始排列顺序；飞达排布优化计算模块，用于依据贴装坐标计算相邻类型元件之间的类型距离总和，计算某类型元件在不同排位下的类型距离总和，取类型距离总和最小值的排位调整该类型元件的排列顺序；以及用于在前次调整后的排列顺序基础上，调整各类型元件的排列顺序，得到飞达排布顺序；飞达站位优化模块，用于根据待贴装元件的贴装坐标获取贴装中心，根据贴装中心确定飞达排布在飞达基座的站位。10.一种计算机存储介质，其特征在于，包括：存储器，其上存储有计算机程序；处理器，用于执行所述存储器中的所述计算机程序，以实现如权利要求1-8中任一所述的方法的步骤。
说明书desc
技术领域本发明涉及贴装优化技术领域，具体地涉及一种贴片机飞达排布优化方法及系统、存储介质。背景技术贴片机是一种自动化设备，是SMT组装生产线中的重要组成部分，也是SMT生产线中成本最高，技术要求最高的一款设备。随着电子行业的发展，在SMT工艺中对PCB的贴装要求越来越高，对贴片机的要求也越来越高，贴片机的效率决定着整条生产线的工作效率。贴装效率除了取决于电机执行效率外，还取决于贴装的顺序，即先贴哪些物料，后贴哪些物料，例如如何从飞达上按照什么顺序获取这些物料，以及在PCB板上按照什么顺序放置。该过程的规划不同，会导致移动距离不同，进而导致贴装耗时不同，从而影响生产效率。对于贴片机的生产过程来说，为了获得最优生产效率，需要找到全局最优解。为了得到全局最优解，通常的处理算法为智能算法，例如神经网络、遗传算法、蛙跳算法、蚁群算法等。以遗传算法为例，处理过程如下：1）对问题的解进行编码；2）根据编码样式，随机生成一定数量的解，组成种群；3）选择一个交叉的规则，以一定的概率，对种群里的解进行交叉；4）选择一个变异规则，以一定的概率，对种群里的解进行变异；5）设计评价函数；6）根据评价函数，对种群的所有个体进行计算，根据评价函数的值进行筛选，淘汰差的保留好的；7）重复步骤3）-6），直到满足迭代次数或者达到理想评价函数值。然而以上智能方法从原理上存在以下缺陷：1、基于随机性原理设计，结果不稳定；2、随着处理的PCB板卡的复杂度增加，计算的复杂度急剧增大；3、计算耗时长，且很难降低。因此现有技术缺少一种能够快速且稳定获得较优生产效率的方法。发明内容本发明的目的是克服现有技术存在的问题，提供一种贴片机飞达排布优化方法及系统、存储介质。为了实现上述目的，本发明第一方面提供一种贴片机飞达排布优化方法，包括以下步骤：获取待贴装的元件类型以及各元件的贴装坐标，将元件按类型排列，得到飞达初始排列顺序；依据贴装坐标计算序列里相邻类型元件之间的类型距离总和；依据相邻类型元件之间的类型距离总和，统计某类型元件在排列顺序中不同排位下的类型距离总和，取所有类型距离总和的最小值所对应的排位作为调整所述第k个位置的元件类型的排列顺序；在前次调整后的排列顺序基础上，调整其余各类型元件的排列顺序，得到飞达最终排布顺序。优选地，所述依据贴装坐标计算序列里相邻类型元件之间的类型距离总和包括以下过程：计算序列里第k个位置的元件类型里的第r个元件到序列里第k+1个位置的元件类型里所有元件的距离，并取其中距离的最小值作为第r个元件到序列里第k+1个位置的元件类型里所有元件的距离值，即点到类型距离；取序列里第k个位置的元件类型里所有元件的点到类型距离的中值作为第k个位置的元件类型到第k+1个位置的元件类型的类型到类型距离；根据排列顺序，依次计算相邻序列元件之间的类型到类型距离，然后求和，得到类型距离总和。本发明第二方面提供一种贴片机飞达排布优化系统，包括：初始排列顺序解析模块，用于获取待贴装的元件类型以及各元件的贴装坐标，将元件按类型排列，得到飞达初始排列顺序；飞达排布优化计算模块，用于依据贴装坐标计算相邻类型元件之间的类型距离总和，计算某类型元件在不同排位下的类型距离总和，取类型距离总和最小值的排位调整该类型元件的排列顺序；以及用于在前次调整后的排列顺序基础上，调整各类型元件的排列顺序，得到飞达排布顺序；飞达站位优化模块，用于根据待贴装元件的贴装坐标获取贴装中心，根据贴装中心确定飞达排布在飞达基座的站位。本发明第三方面提供一种计算机存储介质，包括：存储器，其上存储有计算机程序；处理器，用于执行所述存储器中的所述计算机程序，以实现上述方法的步骤。通过上述技术方案，从分析PCB物料元件的特征出发，设计了一种决策策略，根据不同元件之间的位置相互关系，进行飞达的排布、调整和放置，优化飞达的物料和顺序的分配，使得后续的贴装顺序得到改善，减少贴装耗时；计算简单且快速，耗时短，没有复杂的迭代过程，鲁棒性强，结果稳定。附图说明图1是贴片机PCB贴装生产过程示意图；图2是本发明实施例贴片机飞达排布优化方法示意图；图3是本发明实施例计算飞达放置站位原理示意图。具体实施方式以下结合附图对本发明实施例的具体实施方式进行详细说明。应当理解的是，此处所描述的具体实施方式仅用于说明和解释本发明实施例，并不用于限制本发明实施例。贴片机进行PCB贴装生产过程如图1所示，包括以下过程：1）放置PCB板到图中PCB固定位置；2）依次放置飞达到飞达站位，如图中所示1-60位置；3）贴装头HEAD运动到前侧飞达上方，对应图中1的过程；4）在飞达上方移动，依次吸取PCB板所需物料，对应图中2的过程；5）飞行相机识别后，进行旋转等误差补偿，同时得到新的目标位置；移动到PCB上第一个目标位置，对应图中3的过程；6）贴装头HEAD上物料依次放置到PCB对应位置上，再运动到下一个取料位置，开始从第3步循环，对应图中4的过程；7）重复以上过程，直到PCB上所有的元件都被贴装完成。一台贴片机上飞达数量多，同时不同PCB板上物料类型、数量、位置都不一样，贴装过程的顺序也可以有很多选择，因此可行的贴装顺序方案很多。此外，以上各个顺序的确定相互有影响，属于NP-hard问题；NP-hard问题到目前为止，还没有一个可以处理NP-hard问题的通用算法，不能在多项式时间内计算精确解。为了得到合理的贴装顺序，需要首先对物料放置在哪些位置进行分配，对吸嘴进行分配等，根据以上的分配结果，才能决定后续的顺序。其中飞达的物料和顺序的分配尤为重要，是决定后续顺序的最主要条件，直接影响了物料获取的顺序，以及吸取物料时移动的距离。为了快速且稳定获得最优生产效率的方法，本发明第一方面提出一种贴片机飞达排布优化方法，如图2所示，包括以下步骤：S1、获取待贴装的元件类型以及各元件的贴装坐标，将元件按类型排列，得到飞达初始排列顺序；值得注意的是，元件按类型排列可以是按元件的不同种类排列，如MCU和传感器分属两列，可以是按元件不同阻值排列，还可以是按其他不同指标特点进行分类排列，主要目的是得到飞达初始排列顺序。S2、依据贴装坐标计算相邻类型元件之间的类型距离总和；进一步地，步骤S2包括以下过程：S21、计算序列里第k个位置的元件类型里的第r个元件到序列里第k+1个位置的元件类型里所有元件的距离，并取其中距离的最小值作为第r个元件到序列里第k+1个位置的元件类型里所有元件的距离值，即点到类型距离；点到类型距离BDis公式为：BDis = min)，BDis = ||Btk,r - Btk+1,s ||其中，Ptk,r、Btk,r分别表示第k个位置的元件类型里的第r个元件及其坐标，Ptk+1,s、Btk+1,s分别表示第k+1个位置的元件类型里的第s个元件及其坐标，BDis表示元件Ptk,r到元件Ptk+1,s的“点到点”欧式距离；S22、取序列里第k个位置的元件类型里所有元件的点到类型距离的中值作为第k个位置的元件类型到第k+1个位置的元件类型的类型到类型距离；类型到类型距离BDis公式为：BDis = media)。S23、根据排列顺序，依次计算相邻序列元件之间的类型到类型距离，然后求和，得到类型距离总和BDis，公式为：BDis =∑k)。S3、依据相邻类型元件之间的类型距离总和，统计某类型元件在排列顺序中不同排位下的类型距离总和，取所有类型距离总和的最小值所对应的排位作为调整所述第k个位置的元件类型的排列顺序；进一步地，步骤S3包括以下过程：S31、依次调整所述第k个位置的元件类型在排列顺序中的不同排位，得到不同的类型距离总和；S34、统计所有类型距离总和，取最小值所对应的排位作为调整所述第k个位置的元件类型的排列顺序。S4、在前次调整后的排列顺序基础上，调整各类型元件的排列顺序，得到飞达排布顺序。示例性地，通过获取PCB板上元件类型的BOM表；解析BOM表，得到不同元件的数量，记为{PtN1 PtN2 PtN3 PtN4 ...}，对应的器件类型记为{Pt1 Pt2 Pt3 Pt4 ...}。根据数量，对元件类型进行排序作为飞达的“初始排列顺序”，示例性采用“降序”排列，例如为{Pt3 Pt2 Pt4 Pt1 ...}，即排列的飞达上依次放置上述类型的元件。示例性地，获取PCB板的坐标文件，解析坐标文件，获得各个元件位置坐标。例如Pt3类型元件有N个{1 2 3 ... n}，对应的坐标位置有{  ...}。于是将第p个类型的元件的第r个元件定义为Ptp,r，该点的坐标取为Btp,r。再取第q个类型的元件的第s个元件Ptq,s，该点的坐标取为Btq,s。根据坐标位置，可以计算“点到点”欧氏距离，记为BDis = ||Btp,r - Btq,s ||。根据“点到点”距离，可以计算点到类型距离，即点Ptp,r这个点的位置到Ptq这个元件类型距离，该距离取为“点到点”所有距离中的最小值：BDis = min)。进一步地，可以获得类型距离，即“类型到类型”之间的距离，亦即点到类型距离所有值中的中值：BDis = media)。计算排序总距离：初始排序为:{Pt3 Pt2 Pt4 Pt1 ...}，计算总距离如下：BDis = BDis + BDis + BDis +... =∑k)。对排序进行调整：对于初始排序{Pt3 Pt2 Pt4 Pt1 ...}，计算得到相邻元件之间的类型距离总和BDis_1。取Pt3进行位置调整，得到新位置：{ Pt2 Pt3 Pt4 Pt1 ...}，得到类型距离总和BDis_2。再次调整位置为{ Pt2 Pt4 Pt3 Pt1 ...}，得到总距离BDis_3。依次计算下去，直到Pt3遍历了所有为止。取最小值对应的位置，作为物料Pt3的最优位置，即当BDis_n为所有值中的最小时，Pt3类型元件的飞达就应位于第n个排序位置处。接下来取第二种元件Pt2，依次重复以上计算，得到自己应处于的位置。例如最终调整后的位置为{ Pt1 Pt4 Pt2 Pt3 ...}。进一步地本发明另一实施例中，完成以上飞达排序后，还需要放到飞达的基座的具体站位上。因此需要计算应该放置的起始站位。通过获取并解析PCB板上元件类型的BOM表，获取待贴装的元件类型及对应的数量；通过获取并解析PCB板的坐标文件获取各元件的贴装坐标。示例性地，如图3所示，首先计算PCB板上所有点位的坐标中心，即BC=∑p∑rBtp,r/N，N为总的元件数。取PCB是上“MARK点”位置为Pmark_1，飞达站位起始位置为Pfd，飞达站位间隔Spfd，可以计算得到需要放置的起始站位号为由操作人员从起始站位Nbfd开始，依次放置排好顺序的飞达。基于同一发明构思，本发明实施例第二方面提供一种贴片机飞达排布优化系统，包括：初始排列顺序解析模块，用于获取待贴装的元件类型以及各元件的贴装坐标，将元件按类型排列，得到飞达初始排列顺序；飞达排布优化计算模块，用于依据贴装坐标计算相邻类型元件之间的类型距离总和，计算某类型元件在不同排位下的类型距离总和，取类型距离总和最小值的排位调整该类型元件的排列顺序；以及用于在前次调整后的排列顺序基础上，调整各类型元件的排列顺序，得到飞达排布顺序；飞达站位优化模块，用于根据待贴装元件的贴装坐标获取贴装中心，根据贴装中心确定飞达排布在飞达基座的站位。基于同一发明构思，本发明实施例第二方面提供一种计算机存储介质，包括：存储器，其上存储有计算机程序；处理器，用于执行所述存储器中的所述计算机程序，以实现上述贴片机飞达排布优化方法的步骤。测试例：使用同一个PCB进行优化飞达排列对比测试，结果如下所示：经测试，相同的计算时间下，采用本发明方法优化飞达排列后进行贴装，总距离为11238.44mm，所用贴装时间24.4s，本发明方法的计算时间耗时11.1s；采用遗传算法优化飞达排列后进行贴装，总距离为11244.18mm，所用贴装时间25.47s，优化的计算时间耗时109.92s。可见，本发明方法的测试结果明显优于遗传算法优化的测试结果。并且，本发明方法优化后的测试结果稳定，不会因为重新计算得到不一样的结果，从而导致结果有时优，有时劣。综上所述，本发明技术方案通过分析PCB物料元件的特征出发，设计了一种决策策略，根据不同元件之间的位置相互关系，进行飞达的排布、调整和放置，优化飞达的物料和顺序的分配，使得后续的贴装顺序得到改善，减少贴装耗时；计算简单且快速，耗时短，没有复杂的迭代过程，鲁棒性强，结果稳定。以上结合附图详细描述了本发明的优选实施方式，但是，本发明并不限于此。在本发明的技术构思范围内，可以对本发明的技术方案进行多种简单变型包括各个具体技术特征以任何合适的方式进行组合。为了避免不必要的重复，本发明对各种可能的组合方式不再另行说明。但这些简单变型和组合同样应当视为本发明所公开的内容，均属于本发明的保护范围。
