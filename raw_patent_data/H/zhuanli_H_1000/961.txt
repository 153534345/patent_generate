标题title
一种四桥臂逆变器最优电压支撑参考电流计算方法
摘要abst
一种四桥臂逆变器最优电压支撑参考电流计算方法，属于储能逆变器控制技术领域，解决现有技术无法以最小化PCC点不平衡度为控制目标的问题；计算PCC点故障的正序、负序和零序电压幅值和初始相角以及电压不平衡度；通过定义有功、无功电流关系，优先计算零序电流幅值并进行转化得到目标函数和限制条件；将最优解问题转换为类型I点和类型II点的求解问题，分别计算得到类型I点和类型II点的极值点的值，通过对比取得最优解；应用本发明提出的参考电流计算方法后，PCC点不平衡度下降效果显著，不平衡度降低接近0。
权利要求书clms
1.一种四桥臂逆变器最优电压支撑参考电流计算方法，其特征在于，包括以下步骤：步骤1、计算PCC点故障的正序、负序和零序电压幅值和初始相角以及电压不平衡度；所述的计算PCC点故障的正序、负序和零序电压幅值和初始相角的方法如下：在αβ0坐标系下PCC点电压表示为：其中，、/＞、/＞分别为PCC点α轴、β轴、0轴电压分量；/＞、/＞、/＞分别为电网α轴、β轴、0轴电压分量；/＞、/＞、/＞为输出的α轴、β轴、0轴电流分量；不平衡情况下，PCC点电压分解为正序、负序以及零序分量；对于四桥臂并网逆变器，网侧电流ig分解为：式中，、/＞分别表示正序有功电流幅值和正序无功电流幅值，/＞、/＞分别表示负序有功电流幅值及负序无功电流幅值，/＞、/＞表示零序有功、无功电流幅值，/＞为角速度，/＞、/＞、/＞分别为PCC点正、负、零序电压初相位；将式中α轴、β轴表达式电压及电流分解为正序、负序分量，得正序PCC点电压表达式为：其中，分别为PCC点正序电压α、β轴分量，电网正序电压α、β轴分量以及输出电流α、β轴分量；将式可得，电压不平衡度包含PCC点正序、负序和零序电压，以其为目标函数进行优化不失整体性。
说明书desc
技术领域本发明属于储能逆变器控制技术领域，涉及一种四桥臂逆变器最优电压支撑参考电流计算方法。背景技术发展光伏风力等清洁能源，可以大大减小对传统化石能源的依赖；随着越来越多的分布式低功率发电系统连接到电网，电网故障也变得更加频繁，此时满足入网准则的要求以保证电网的稳定性和可靠性，维护电力基础设施的安全变得极为重要。电压骤降是主要电能质量问题，其中可能产生零序电压的双相接地故障是导致电压骤降的常见原因。低电压穿越能力是降低故障电网下电力设施断开风险的最重要的要求。为了提高处理电压骤降的能力，如今入网准则已经从穿越策略发展到电压支持策略。近年来，相关研究人员已经提出了几种策略来解决支持故障电网的并网逆变器的控制问题。公开日期为2014年1月20日的文献《Reactive Power Control for DistributedGeneration Power Plants to Comply With Voltage Limits During Grid Faults》中提出一种三线制逆变器电压支撑控制策略，该方法将电压支持目标设定为将公共耦合点电压提高到入网准则允许的可行范围。公开日期为2017年8月日的文献《Control Strategy for Distribution Generation Inverters to Maximize theVoltage Support in the Lowest Phase During Voltage Sags》中提到的控制策略目标为使最低相位的电压最大化，然而在该策略中只有正序电流被注入，忽略了负序电流的注入，没有对负序电压采取措施，并且没有提出对PCC点不平衡度降低的目标。公开日期为2019年10月30日的文献《OptimalVoltage-SupportControlforDistributedGeneration Inverters in RL Grid-Faulty Networks》提供了一种针对三线制逆变器的电压支撑控制方法，该方法可以避免APO，并用充分利用正序和负序电流注入能力，最大化地支持电网，然而，由于没有零序电流通道，在该文献中忽略了零序电流。受限于缺少零序通道，三线逆变器几乎没有文献考虑零序电压。四桥臂逆变器由于其拥有第四桥臂可对零序电流实施精准控制，逐渐成为研究热点。公开日期为2021年10月10日的文献《Asymmetrical Voltage Support Control of Three- Phase Four-Wire Inverterswith Zero Active Power Oscillation during Grid Faults》中提出的方法充分利用了四支路逆变器的灵活性，以最大化正序电压，最小化零序电压并消除有功功率振荡，然而，没有以不平衡度最小作为电压支撑目标。发明内容本发明的目的在于如何设计一种四桥臂逆变器最优电压支撑参考电流计算方法，以解决现有技术的四桥臂逆变器的电压支撑控制参考电流计算方法，无法以最小化PCC点不平衡度为控制目标的问题。本发明是通过以下技术方案解决上述技术问题的：一种四桥臂逆变器最优电压支撑参考电流计算方法，包括以下步骤：步骤1、计算PCC点故障的正序、负序和零序电压幅值和初始相角以及电压不平衡度；步骤2、通过定义有功、无功电流关系，优先计算零序电流幅值并进行转化得到目标函数和限制条件；步骤3、将最优解问题转换为类型I点和类型II点的求解问题，分别计算得到类型I点和类型II点的极值点的值，通过对比取得最优解。进一步地，步骤1中所述的计算PCC点故障的正序、负序和零序电压幅值和初始相角的方法如下：在αβ0坐标系下PCC点电压表示为：其中，、/＞、/＞分别为PCC点α轴、β轴、0轴电压分量；/＞、/＞、/＞分别为电网α轴、β轴、0轴电压分量；/＞、/＞、/＞为输出的α轴、β轴、0轴电流分量；不平衡情况下，PCC点电压分解为正序、负序以及零序分量；对于四桥臂并网逆变器，网侧电流ig分解为：式中，、/＞分别表示正序有功电流幅值和正序无功电流幅值，/＞、/＞分别表示负序有功电流幅值及负序无功电流幅值，/＞、/＞表示零序有功、无功电流幅值，/＞为角速度，、/＞、/＞分别为PCC点正、负、零序电压初相位；将式中α轴、β轴表达式电压及电流分解为正序、负序分量，得正序PCC点电压表达式为：其中，分别为PCC点正序电压α、β轴分量，电网正序电压α、β轴分量以及输出电流α、β轴分量；将式可得，电压不平衡度包含PCC点正序、负序和零序电压，以其为目标函数进行优化不失整体性。进一步地，步骤2中所述的通过定义有功、无功电流关系，优先计算零序电流幅值并进行转化得到目标函数和限制条件的方法具体如下：将所述目标函数和限制条件表示为：其中分别为a相，b相，c相，中线电流幅值；为了简化注入电流关系，对正序、负序和零序有功、无功电流做如下规定：,/＞,/＞当满足式时，正序、负序和零序有功、无功电流比值固定，此时目标函数以及等数约束中的变量变为正序、负序和零序电流幅值、/＞、/＞，六元优化问题简化至三元优化问题；且当式满足时，PCC点正序、负序和零序电压将保持不变；将式代入式、式、式中，则PCC点正序、负序和零序电压幅值表示为：从式~可得，当电网阻抗以及正序、负序和零序有功电流与无功电流比值固定时，PCC点正序、负序和零序电压只受正序、负序和零序电流幅值影响；由于零序电流阻抗为正序负序电流的四倍，故优先考虑零序电流注入降低零序电压，得零序电流幅值参考值为：其中，为安全阈值，当零序电流幅值确认后，中线电流将控制在安全阈值/＞之内；而式中目标函数将只和正序、负序电流幅值,/＞相关，等式约束也只关于三相电流幅值与安全阈值/＞，此时，优化问题简化为：。进一步地，步骤3中所述的将最优解问题转换为类型I点和类型II点的求解问题，分别计算得到类型I点和类型II点的极值点的值，通过对比取得最优解的方法如下：1) 类型I点定义类型I点为三相电流幅值曲线上使得目标函数最大的点，下面给出类型I点/＞求解方式；由于三相电流幅值曲线是非标准椭圆方程在第一象限中图形，假设在非标准椭圆方程曲线上，使得目标函数最大的点/＞恰好位于第一象限内，则此时三相电流幅值曲线上类型I点即是类型I点；对于/＞可通过Lagrange乘数法得到；整理得/＞的表达式为：式中，，；当根据式求解得到的,/＞不能同时满足非负值时，类型I点/＞求三相电流幅值/＞曲线与坐标轴的交点得到：2) 类型II点定义类型II点为三相电流幅值曲线在第一象限中的交点，通过联立三相电流幅值表达式求解：由于物理意义的规定，,/＞都是非负实数，所以只能保留在实数域中位于第一象限的点；在对消元处理后，采用费拉里法对一元四次方程进行求解，最后排除非正实数的解，得到类型II点，只要比较落于等数约束曲线上的类型I点和类型II点的目标函数值，其中使目标函数最大的点既是最优解；当得到之后，此时正序、负序和零序有功、无功电流参考值根据式推导得到：。本发明的优点在于：本发明以降低PCC点不平衡度为目标，在满足三相电流与中线电流幅值不超过三相四桥臂并网逆变器可允许最大输出电流幅值的情况下，将PCC点电压尽可能恢复至不平衡故障发生前的状态；本发明的方法通过解非线性不等式约束最优问题得到正序、负序和零序有功、无功电流参考值，为此，通过数学证明与适当的简化得到最有数值解求解算法；通过硬件在环实验平台进行实验对比，验证了本发明的计算方法的最优性与有效性；应用本发明提出的参考电流计算方法后，PCC点不平衡度下降效果显著，不平衡度降低接近0。附图说明图1是本发明实施例的四桥臂逆变器典型拓扑结构图；图2是本发明实施例定义的两类数值点示意图；图3是本发明实施例定义的类型I点计算流程图；图4是本发明实施例定义的类型II点计算流程图；图5是本发明实施例的四桥臂逆变器最优电压支撑参考电流计算方法流程图；图6是本发明实施例的电压支撑效果实验图；图6是本发明实施例的abc相输出电流实验图；图6是本发明实施例的中线输出电流实验图；图6是本发明实施例的不平衡度降低效果实验图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。下面结合说明书附图以及具体的实施例对本发明的技术方案作进一步描述：实施例一本发明实施例的四桥臂逆变器最优电压支撑参考电流计算方法包括以下内容：1、计算PCC点故障的正序、负序和零序电压幅值和初始相角以及电压不平衡度为分析三相四桥臂并网逆变器的电压支撑基础原理，考虑电网不再是纯电压源模型，同时包含电网阻抗，此时，电路等效模型如图1所示，其中，Vdc是直流链路电压，为恒定值。逆变器使用阻尼LCL型滤波器来获得具有低谐波含量的网侧电流，并在PCC处连接到电网；当电网故障发生，电压支撑控制介入补偿PCC点电压。假设各相电网阻抗相同，采用电阻Rg与Lg电感模拟等效电网阻抗，电网电压vga、vgb、vgc模拟不平衡电压跌落。其中，等效电网阻抗可以采用阻抗测算器测得，具体可参见文献：《A method for identification of the equivalent inductance and resistancein the plant model of current-controlled grid-tied converters》。在αβ0坐标系下PCC点电压可以表示为：其中，、/＞、/＞分别为PCC点α轴、β轴、0轴电压分量；/＞、/＞、/＞分别为电网α轴、β轴、0轴电压分量；/＞、/＞、/＞为输出的α轴、β轴、0轴电流分量。从式可得，PCC点电压与注入电网电流以及等效电网阻抗相关，二者是电压支撑控制的关键。不平衡情况下，PCC点电压可以分解为正序、负序以及零序分量；对于四桥臂并网逆变器，充分利用其灵活的可控性，网侧电流ig可以分解为：式中，、/＞分别表示正序有功电流幅值和正序无功电流幅值，/＞、/＞分别表示负序有功电流幅值及负序无功电流幅值。但值得注意的是，/＞、/＞在物理意义上并不代表零序有功、无功电流幅值，二者只是表征零序电流中的两部分，/＞与零序电压同向，/＞滞后零序电压90°，但为统一形式，还是称其为零序有功、无功电流，/＞为角速度。、/＞、/＞为PCC点正、负、零序电压初相位。根据对称分量法，将式中α轴、β轴表达式电压及电流分解为正序、负序分量，可得正序PCC点电压表达式为：其中，分别为PCC点正序电压α、β轴分量，电网正序电压α、β轴分量以及输出电流α、β轴分量。将式中已有证明。换句话说，当改变最大可输出电流幅值时，只需有功、无功电流比值保持以上比值时，就可以对提升最多的PCC点正序电压。对于负序以及零序也可以一样分析。所以，为了简化注入电流关系，对正序、负序和零序有功、无功电流做如下规定：,/＞,/＞当满足式时，正序、负序和零序有功、无功电流比值固定，此时目标函数以及等数约束中的变量变为正序，负序和零序电流幅值,/＞,/＞，也就是六元优化问题简化至三元优化问题。且当式满足时，PCC点正序、负序和零序电压将保持不变。将式代入式、式、式中，则PCC点正序、负序和零序电压幅值表示为：从式~可得，当电网阻抗以及正序、负序和零序有功电流与无功电流比值固定时，PCC点正序、负序和零序电压只受正序、负序和零序电流幅值影响。由于零序电流阻抗为正序负序电流的四倍，故优先考虑零序电流注入降低零序电压，可得零序电流幅值参考值：其中，为安全阈值，当零序电流幅值确认后，中线电流将控制在安全阈值/＞之内。而式中目标函数将只和正序、负序电流幅值/＞,/＞相关，等式约束也只关于三相电流幅值与安全阈值/＞。此时，优化问题简化为：3、将最优解问题转换为定义的两类点求解问题，分别计算得到两类极值点的值，通过对比取得最优解；当零序电流幅值固定时，各相电流幅值是关于正序、负序电流幅值,/＞是非标准椭圆方程在第一象限中的表达式。因此，式中等式约束可用图2表示；图2为特定电网情况下的示意图，图中三条曲线曲线分别表示三相电流幅值曲线，各相电流幅值曲线中的部分组成的虚线代表式中的等式约束，也就是说需要从虚线曲线上寻找式的最大目标函数/＞的最优解/＞。本发明将可能的最优值点分为类型I点、类型II点。最终最优点在类型I点和类型II点中寻找。1) 类型I点定义类型I点为三相电流幅值曲线上使得目标函数最大的点，下面给出类型I点/＞求解方式。由于三相电流幅值曲线是非标准椭圆方程在第一象限中图形，假设在非标准椭圆方程曲线上，使得目标函数最大的点/＞恰好位于第一象限内，则此时三相电流幅值曲线上类型I点即是类型I点。对于/＞可通过Lagrange乘数法得到。综合整理可得/＞的表达式为：式中，，。当根据式求解得到的,/＞不能同时满足非负值时，类型I点/＞可求三相电流幅值/＞曲线与坐标轴的交点得到：/＞综上所述，三相电流幅值曲线上类型I点计算流程图如图3所示。2) 类型II点定义类型II点为三相电流幅值曲线在第一象限中的交点。都可通过联立三相电流幅值表达式求解。由于物理意义的规定，,/＞都是非负实数，所以只能保留在实数域中位于第一象限的点。在对消元处理后，采用费拉里法对一元四次方程进行求解，最后排除非正实数的解，得到类型II点，计算流程可见图4。只要比较落于等数约束曲线上的类型I点和类型II点的目标函数值，其中使目标函数最大的点既是最优解；其中，费拉里法对一元四次方程进行求解是现有技术，具体可参见文献《Current Minimizing Torque Control of theIPMSM Using Ferrari’s Method》。当得到之后，此时正序、负序和零序有功、无功电流参考值可根据式推导得到：综合上述分析，改进型最优电压支撑控制算法流程如图5所示。4、仿真试验验证通过Typhoon HIL404以及TI TMS320F28335DSP控制器对本发明的方法进行硬件在环仿真实验验证，具体仿真实验参数如下表1所示。表1 仿真试验参数本次实验中故障电网设置为正序、负序、零序，电网电压幅值为226.27V、61.09V、30.49V,初始相角为0、π/6、-π/3。本发明的方法在定义的故障电网条件下对于PCC点电压支撑效果、abc三相输出电流、中线输出电流以及不平衡度降低的效果如图6、图6、图6、图6所示；在阶段一，三相四桥臂并网逆变器不向电网注入电流，此时PCC点电压既是电网电压；在阶段二，四桥臂逆变器采取文献《An AdvancedVoltage Support Scheme Considering the Impact of Zero-Sequence Voltage UnderMicrogrid Faults Using Model Predictive Control》中的传统电压支撑控制策略，该文献的电压支撑控制策略没有以最小不平衡度为控制目标；在阶段三，采取本发明所提最优电压支撑参考电流计算方法的控制策略。图6可以看出应用本发明提出的参考电流计算方法后，PCC点电压明显更加平衡；图6可以看出本发明的计算方法三相电流峰值没有超过最大值，符合最大电流约束；图6可以看出本发明的计算方法中线电流峰值没有超过最大值，符合最大电流约束；图6可以看出应用本发明提出的参考电流计算方法后，PCC点不平衡度下降效果显著，不平衡度降低接近0。本发明以降低PCC点不平衡度为目标，在满足三相电流与中线电流幅值不超过三相四桥臂并网逆变器可允许最大输出电流幅值的情况下，将PCC点电压尽可能恢复至不平衡故障发生前的状态。本发明的方法通过解非线性不等式约束最优问题得到正序、负序和零序有功、无功电流参考值，为此，通过数学证明与适当的简化得到最有数值解求解算法。通过硬件在环实验平台进行实验对比，验证了本发明的计算方法的最优性与有效性。以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
