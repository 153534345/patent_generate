标题title
一种局部异常因子检测的安全外包计算方法及系统
摘要abst
本发明公开一种局部异常因子检测的安全外包计算方法及系统，包括：根据加密后的待测点运维数据和历史聚类中心点，执行同态加密运算，将同态加密运算结果发送至服务器，以使服务器对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。实现对欧氏距离高效的安全外包计算，加快CBLOF算法预测阶段的判断速度，并保证数据安全。
权利要求书clms
1.一种局部异常因子检测的安全外包计算方法，其特征在于，应用于第三方计算中心端，包括：接收加密后的待测点运维数据和历史聚类中心点，以此执行同态加密运算；将同态加密运算结果发送至服务器，以使服务器对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。2.一种局部异常因子检测的安全外包计算方法，其特征在于，应用于服务器端，包括：接收由第三方计算中心发送的同态加密运算结果；所述第三方计算中心接收加密后的待测点运维数据和历史聚类中心点，以此执行同态加密运算；对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。3.一种局部异常因子检测的安全外包计算方法，其特征在于，包括：客户端发送加密后的待测点运维数据至第三方计算中心；边缘计算器发送加密后的历史聚类中心点至第三方计算中心；第三方计算中心根据加密后的待测点运维数据和历史聚类中心点，执行同态加密运算，将同态加密运算结果发送至服务器；服务器对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。4.如权利要求1-3任一项所述的局部异常因子检测的安全外包计算方法，其特征在于，待测点运维数据由客户端进行加密后发送至第三方计算中心，历史聚类中心点由边缘计算器存储并进行加密后发送至第三方计算中心，客户端和边缘计算器进行加密时所采用的公钥以及对同态加密运算结果进行解密时所采用的私钥均由服务器生成。5.如权利要求4所述的局部异常因子检测的安全外包计算方法，其特征在于，对待测点运维数据和历史聚类中心点进行加密的过程包括，其中，/＞为公钥参数，/＞是随机数，m为待加密数据，/＞为加密函数。6.如权利要求1-3任一项所述的局部异常因子检测的安全外包计算方法，其特征在于，第三方计算中心根据加密后的待测点运维数据和历史聚类中心点执行乘法同态运算的过程包括：对于加密后的待测点运维数据，计算/＞；对于加密后的历史聚类中心点/＞，计算/＞；以及计算/＞，其中，/＞为第i个数据，/＞为第i个中心点，/＞是加密/＞后的密文，/＞是加密/＞后的密文，/＞为加密函数。7.如权利要求6所述的局部异常因子检测的安全外包计算方法，其特征在于，服务器对同态加密运算结果的过程包括：；其中，m为待加密数据，/＞是加密m后的密文，/＞是私钥参数，/＞为解密函数。8.如权利要求7所述的局部异常因子检测的安全外包计算方法，其特征在于，服务器将解密后的数据对应进行加和处理，计算、/＞和/＞；n为总数据量；待测点相对于每个历史聚类中心点的异常值为待测点与每个历史聚类中心点的欧氏距离的平方：；/＞为待测点运维数据，/＞为历史聚类中心点。9.如权利要求1-3任一项所述的局部异常因子检测的安全外包计算方法，其特征在于，以最小的异常值为待测点的异常分数，将异常分数与设定阈值进行比较，若异常分数高于设定阈值，则待测点运维数据异常，否则待测点运维数据正常。10.一种局部异常因子检测的安全外包计算系统，其特征在于，包括：客户端，用于发送加密后的待测点运维数据至第三方计算中心；边缘计算器，用于发送加密后的历史聚类中心点至第三方计算中心；第三方计算中心，用于根据加密后的待测点运维数据和历史聚类中心点，执行同态加密运算，将同态加密运算结果发送至服务器；服务器，用于对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。
说明书desc
技术领域本发明涉及人工智能的数据安全技术领域，特别是涉及一种局部异常因子检测的安全外包计算方法及系统。背景技术智能巡检是通过机器学习等人工智能算法，从海量的设备运维数据中学习并进行建模，并根据建立的机器学习模型，对新产生的运维数据进行故障检测和分类的方式，能够提高设备巡检效率，节省人工成本，同时通过对多类数据的综合分析，避免人工的错检、漏检等问题。在实际应用中，针对单个故障因子进行检测时，常使用机器学习中基于聚类的故障检测算法，根据海量的历史数据构建聚类模型，判断待测数据是否异常。基于聚类的局部异常因子检测算法是通过对数据聚类，区分出大簇和小簇，再计算待测数据的异常分数，从而判断其是否是异常因子的检测方法，适用于具有簇状结构的数据集，即正常数据簇状聚集、异常数据孤立存在的模型，在智能巡检方面有广泛的应用，尤其是在网络安全和金融领域的异常检测中取得了良好的效果。在传统的计算过程中，通过聚类、分簇得到算法模型后，为了评估新的待测点是否异常，需要求出待测点与模型中各个中心点的欧氏距离，最小的欧氏距离即为待测点的异常分数，再将异常分数与阈值比较，得出结论。在实际应用场景中，考虑到运维数据的复杂性，用户可能需要对数量大、维数高的数据进行检测，需要耗费大量时间执行乘法运算来计算欧氏距离，算法模型也会占用一定的存储空间，由此本地的计算负载高，评估效率低。发明内容为了解决上述问题，本发明提出了一种局部异常因子检测的安全外包计算方法及系统，实现对欧氏距离高效的安全外包计算，加快CBLOF算法预测阶段的判断速度，并保证数据安全。为了实现上述目的，本发明采用如下技术方案：第一方面，本发明提供一种局部异常因子检测的安全外包计算方法，应用于第三方计算中心端，包括：接收加密后的待测点运维数据和历史聚类中心点，以此执行同态加密运算；将同态加密运算结果发送至服务器，以使服务器对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。第二方面，本发明提供一种局部异常因子检测的安全外包计算方法，应用于服务器端，包括：接收由第三方计算中心发送的同态加密运算结果；所述第三方计算中心接收加密后的待测点运维数据和历史聚类中心点，以此执行同态加密运算；对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。第三方面，本发明提供一种局部异常因子检测的安全外包计算方法，包括：客户端发送加密后的待测点运维数据至第三方计算中心；边缘计算器发送加密后的历史聚类中心点至第三方计算中心；第三方计算中心根据加密后的待测点运维数据和历史聚类中心点，执行同态加密运算，将同态加密运算结果发送至服务器；服务器对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。作为可选择的实施方式，待测点运维数据由客户端进行加密后发送至第三方计算中心，历史聚类中心点由边缘计算器存储并进行加密后发送至第三方计算中心，客户端和边缘计算器进行加密时所采用的公钥以及对同态加密运算结果进行解密时所采用的私钥均由服务器生成。作为可选择的实施方式，对待测点运维数据和历史聚类中心点进行加密的过程包括，其中，/＞为公钥参数，/＞是随机数，m为待加密数据，/＞为加密函数。作为可选择的实施方式，第三方计算中心根据加密后的待测点运维数据和历史聚类中心点执行乘法同态运算的过程包括：对于加密后的待测点运维数据，计算/＞；对于加密后的历史聚类中心点/＞，计算/＞；以及计算/＞，其中，/＞为第i个数据，/＞为第i个中心点，/＞是加密/＞后的密文，/＞是加密/＞后的密文，/＞为加密函数。作为可选择的实施方式，服务器对同态加密运算结果的过程包括：；其中，m为待加密数据，/＞是加密m后的密文，c为私钥参数，/＞为解密函数。作为可选择的实施方式，服务器将解密后的数据对应进行加和处理，计算、和/＞；n为总数据量；待测点相对于每个历史聚类中心点的异常值为待测点与每个历史聚类中心点的欧氏距离的平方：/＞；为待测点运维数据，/＞为历史聚类中心点。作为可选择的实施方式，以最小的异常值为待测点的异常分数，将异常分数与设定阈值进行比较，若异常分数高于设定阈值，则待测点运维数据异常，否则待测点运维数据正常。第四方面，本发明提供一种局部异常因子检测的安全外包计算系统，包括：客户端，用于发送加密后的待测点运维数据至第三方计算中心；边缘计算器，用于发送加密后的历史聚类中心点至第三方计算中心；第三方计算中心，用于根据加密后的待测点运维数据和历史聚类中心点，执行同态加密运算，将同态加密运算结果发送至服务器；服务器，用于对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。与现有技术相比，本发明的有益效果为：本发明针对基于聚类的局部异常因子检测算法的预测阶段，设计一种外包式的安全计算方法，客户端负责采集运维数据，边缘计算器存储聚类模型，计算量较大的向量乘法运算在第三方计算中心完成，客户端和边缘计算器将加密后的待测点运维数据和历史聚类中心点发送至第三方计算中心，使第三方计算中心无法获取原始数据，只对加密数据进行同态加密运算，实现对欧氏距离的安全外包计算，在保证数据隐私安全的前提下，减少客户端的时间和空间消耗，提高计算效率。本发明将算法模型保存在与客户端延迟较低的边缘计算器中，将复杂计算外包至第三方计算中心完成，显著降低了客户端和监测中心的计算负载，客户端只进行数据采集，监测中心对其他参与方返回的数据解密后进行求和、比较，不影响异常因子检测算法的正确性，保证数据的安全可靠，提高评估效率，更快速地定位异常点，避免异常数据产生的损害。本发明附加方面的优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明构成本发明的一部分的说明书附图用来提供对本发明的进一步理解，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。图1为本发明实施例1提供的局部异常因子检测的安全外包计算方法整体流程示意图。具体实施方式下面结合附图与实施例对本发明做进一步说明。应该指出，以下详细说明都是示例性的，旨在对本发明提供进一步的说明。除非另有指明，本文使用的所有技术和科学术语具有与本发明所属技术领域的普通技术人员通常理解的相同含义。需要注意的是，这里所使用的术语仅是为了描述具体实施方式，而非意图限制根据本发明的示例性实施方式。如在这里所使用的，除非上下文另外明确指出，否则单数形式也意图包括复数形式，此外，还应当理解的是，术语“包括”和“包含”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。实施例1本实施例提供一种局部异常因子检测的安全外包计算方法，应用于第三方计算中心端，包括：接收加密后的待测点运维数据和历史聚类中心点，以此执行同态加密运算；将同态加密运算结果发送至服务器，以使服务器对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。在本实施例中，局部异常因子检测的安全外包计算方法由客户端、边缘计算器、第三方计算中心和服务器多方共同实现安全计算过程。其中，客户端按照预设频率采集待测点运维数据，为了提高计算效率，将采集的待测点运维数据上传至第三方计算中心，然后再由监测中心判断待测点运维数据是否异常。边缘计算器保存对历史运维数据执行CBLOF算法得到的算法模型，即聚类中心点向量列表。第三方计算中心是具有弹性计算资源、能够高效处理数据的第三方平台，接收的是加密后的待测点运维数据和历史聚类中心点，避免损害客户的数据隐私。监测中心不直接进行计算，而是接收其他参与方计算出的加密数据，经解密后得到异常值，并根据异常值来判断待测点运维数据是否异常。下面结合图1对本实施例方法进行详细阐述。用户指定算法参数，对历史运维数据执行CBLOF算法中的无监督聚类算法，得到/＞个中心点和/＞个球形簇。用户指定算法参数和/＞，用于CBLOF算法中区分大小簇，其中/＞，/＞；具体方法为：在聚类完成后，将所有簇/＞按照其包含的数据点数量进行排序，得到；记数据点总数为/＞，基于参数/＞的区分：从大到小，将/＞依次相加，直至/＞首次大于/＞，则将此时的簇判断为大簇；基于参数/＞的区分：对于排序后的每个簇，依次计算/＞，直至首次满足/＞，则将此时的簇/＞判断为大簇。一般情况下，优先按照参数/＞区分大小簇。边缘计算器保存聚类模型，即所有大簇的中心点向量，其中，/＞为大簇的个数。预测阶段，监测中心生成公钥和私钥/＞，其中，/＞为公钥参数，，/＞是私钥参数，将公钥/＞分发给其他各参与方。客户端采集待测点运维数据，n为总数据量，根据ElGamal加密算法，使用公钥/＞进行加密，得到加密后的待测点运维数据/＞，将/＞发送到第三方计算中心；其中，/＞，/＞是随机数，m为待加密数据，为加密函数。边缘计算器使用ElGamal加密算法对其保存的历史聚类中心点进行加密，得到加密后的历史聚类中心点/＞，将/＞发送到第三方计算中心。第三方计算中心接收客户端和边缘计算器发送的加密数据并在加密数据上执行乘法同态运算；具体地：对于，计算/＞，其中，/＞是加密/＞后的密文；对于/＞，计算/＞，其中，/＞是加密/＞后的密文；以及计算/＞，其中，/＞为第i个数据，/＞为第i个中心点。第三方计算中心将、/＞和/＞发送给监测中心。监测中心使用私钥对上述同态加密运算结果进行解密得到/＞、/＞和/＞；即对于/＞，其中/＞是加密m后的密文，计算得到/＞；其中，/＞是私钥参数，/＞为加密函数，/＞为解密函数。监测中心将解密后的数据对应加和，计算、/＞和/＞。监测中心根据CBLOF算法，计算异常值，即待测点与中心点的欧氏距离的平方：/＞。对边缘计算器中保存的每个中心点都执行步骤至步骤，只需要重新计算并发送、/＞即可，待测点的数据无需重复传输，得到待测点对于各个中心点的异常值/＞，其中最小的异常值/＞即为待测点的异常分数。监测中心将异常分数与预先设定的异常阈值进行比较，如果异常分数高于阈值，则认为待测点异常，需要通知人工进一步处理；否则认为待测点正常。实施例2本实施例提供一种局部异常因子检测的安全外包计算方法，应用于服务器端，包括：接收由第三方计算中心发送的同态加密运算结果；所述第三方计算中心接收加密后的待测点运维数据和历史聚类中心点，以此执行同态加密运算；对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。实施例3本实施例提供一种局部异常因子检测的安全外包计算方法，包括：客户端发送加密后的待测点运维数据至第三方计算中心；边缘计算器发送加密后的历史聚类中心点至第三方计算中心；第三方计算中心根据加密后的待测点运维数据和历史聚类中心点，执行同态加密运算，将同态加密运算结果发送至服务器；服务器对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。实施例4本实施例提供一种局部异常因子检测的安全外包计算系统，包括：客户端，用于发送加密后的待测点运维数据至第三方计算中心；边缘计算器，用于发送加密后的历史聚类中心点至第三方计算中心；第三方计算中心，用于根据加密后的待测点运维数据和历史聚类中心点，执行同态加密运算，将同态加密运算结果发送至服务器；服务器，用于对同态加密运算结果进行解密，计算待测点相对于每个历史聚类中心点的异常值，将最小的异常值与设定阈值进行比较，由此判断待测点运维数据是否存在异常。此处需要说明的是，上述模块对应于实施例1中所述的步骤，上述模块与对应的步骤所实现的示例和应用场景相同，但不限于上述实施例1所公开的内容。需要说明的是，上述模块作为系统的一部分可以在诸如一组计算机可执行指令的计算机系统中执行。在更多实施例中，还提供：一种电子设备，包括存储器和处理器以及存储在存储器上并在处理器上运行的计算机指令，所述计算机指令被处理器运行时，完成实施例1或实施例2或实施例3中所述的方法。为了简洁，在此不再赘述。应理解，本实施例中，处理器可以是中央处理单元CPU，处理器还可以是其他通用处理器、数字信号处理器DSP、专用集成电路ASIC，现成可编程门阵列FPGA或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。存储器可以包括只读存储器和随机存取存储器，并向处理器提供指令和数据、存储器的一部分还可以包括非易失性随机存储器。例如，存储器还可以存储设备类型的信息。一种计算机可读存储介质，用于存储计算机指令，所述计算机指令被处理器执行时，完成实施例1或实施例2或实施例3中所述的方法。上述实施例中的方法可以直接体现为硬件处理器执行完成，或者用处理器中的硬件及软件模块组合执行完成。软件模块可以位于随机存储器、闪存、只读存储器、可编程只读存储器或者电可擦写可编程存储器、寄存器等本领域成熟的存储介质中。该存储介质位于存储器，处理器读取存储器中的信息，结合其硬件完成上述方法的步骤。为避免重复，这里不再详细描述。本领域普通技术人员可以意识到，结合本实施例描述的各示例的单元及算法步骤，能够以电子硬件或者计算机软件和电子硬件的结合来实现。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本申请的范围。上述虽然结合附图对本发明的具体实施方式进行了描述，但并非对本发明保护范围的限制，所属领域技术人员应该明白，在本发明的技术方案的基础上，本领域技术人员不需要付出创造性劳动即可做出的各种修改或变形仍在本发明的保护范围以内。
