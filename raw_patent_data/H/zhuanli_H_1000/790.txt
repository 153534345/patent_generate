标题title
一种安全探测系统及方法
摘要abst
本发明公开了一种安全探测系统及方法，包括：安全探测模块、安全标识模块和上位机；所述安全探测模块与所述安全标识模块、所述上位机进行信息交互；所述安全探测模块包括：安全探测模块密码处理单元、电源单元、总线隔离单元、通道选择单元、协议转换单元、通信接口单元和天线单元；所述安全标识模块为有源RFID安全标识模块，包括MCU中央控制单元、微波收发信机、电池、安全标识模块密码处理单元和天线。本发明方法能够用于典型应用场景下物联网终端的安全防护，为终端模块和接入点提供双向安全接入认证功能，提供传输数据加密保护功能，提供终端权限访问控制功能。
权利要求书clms
1.一种安全探测系统，其特征在于，包括：安全探测模块、安全标识模块和上位机；所述安全探测模块与所述安全标识模块、所述上位机进行信息交互；所述安全探测模块包括：安全探测模块密码处理单元、电源单元、总线隔离单元、通道选择单元、协议转换单元、通信接口单元和天线单元；所述安全探测模块密码处理单元与所述电源单元、所述天线单元、所述总线隔离单元信息交互；所述总线隔离单元与所述通道选择单元信息交互；所述协议转换单元与所述通道选择单元、所述通信接口单元信息交互；所述安全探测模块密码处理单元用于对安全标识模块进行数据管理；所述电源单元用于为所述安全探测模块密码处理单元供电；所述总线隔离单元用于保护所述安全探测模块密码处理单元和所述通道选择单元；所述通道选择单元用于进行通道选择；所述协议转换单元用于进行协议转换；所述通信接口单元包括CAN接口、RJ45以太网接口、RS232接口和TTL接口，用于进行信号转换；所述安全标识模块为有源RFID安全标识模块，包括MCU中央控制单元、微波收发信机、电池、安全标识模块密码处理单元和天线。2.根据权利要求1所述的安全探测系统，其特征在于，所述安全探测模块密码处理单元，用于对安全标识模块进行数据管理，得到加密数据信息；所述安全探测模块密码处理单元，用于将所述加密数据信息发送至天线单元；所述天线单元，用于将所述加密数据信息发射出去。3.根据权利要求1所述的安全探测系统，其特征在于，所述天线单元包括射频接口芯片；所述安全探测模块密码处理单元包括安全芯片；所述安全探测模块，用于利用所述射频接口芯片和所述安全芯片与上位机进行安全通信；所述安全探测模块密码处理单元，用于与所述射频接口芯片进行SPI通信。4.一种安全探测方法，其特征在于，应用于如权利要求1～3所述的安全探测系统，所述方法包括：S1，利用第一认证模型，对安全探测模块和上位机之间进行双向认证；S2，利用第二认证模型，对安全探测模块和安全标识模块之间进行双向认证；S3，双向认证通过后，所述安全探测模块和所述安全标识模块进行数据交互；所述数据交互包括盘点、读取数据和写入数据；S4，利用对称密钥管理模型，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息；S5，将所述加密数据信息发送至天线单元；S6，利用所述天线单元将所述加密数据信息发送出去。5.根据权利要求4所述的安全探测方法，其特征在于，所述利用第二认证模型，对安全探测模块和安全标识模块之间进行双向认证，包括：S21，利用所述安全探测模块对所述安全标识模块进行实体鉴别，得到第一实体鉴别信息；S22，利用所述安全标识模块，向所述安全探测模块发送所述第一实体鉴别信息；S23，利用所述安全探测模块，对所述第一实体鉴别信息进行处理，得到第二实体鉴别信息；S24，利用所述安全探测模块，将所述第二实体鉴别信息发送至所述安全标识模块；S25，利用所述安全标识模块，对所述第二实体鉴别信息进行处理，得到实体鉴别结果，实现安全探测模块和安全标识模块之间的双向认证。6.根据权利要求5所述的安全探测方法，其特征在于，所述利用所述安全探测模块对所述安全标识模块进行实体鉴别，得到第一实体鉴别信息，包括：S211，利用所述安全探测模块，向所述安全探测模块密码处理单元申请第一随机数；S212，所述安全探测模块密码处理单元返回所述第一随机数；S213，所述安全探测模块向所述安全标识模块发送鉴别请求和所述第一随机数；S214，所述安全标识模块将所述第一随机数发送至所述安全标识模块密码处理单元；S215，所述安全标识模块密码处理单元生成第二随机数和鉴别请求应答；所述第二随机数和鉴别请求应答构成第一实体鉴别信息。7.根据权利要求5所述的安全探测方法，其特征在于，所述利用所述安全探测模块，对所述第一实体鉴别信息进行处理，得到第二实体鉴别信息，包括S231，所述安全探测模块，将所述第一实体鉴别信息发送至所述安全探测模块密码处理单元；S232，所述安全探测模块密码处理单元，对所述第一实体鉴别信息进行鉴别，得到第一鉴别结果和32位消息校验码；所述第一鉴别结果和32位消息校验码构成第二实体鉴别信息。8.根据权利要求5所述的安全探测方法，其特征在于，所述利用所述安全标识模块，对所述第二实体鉴别信息进行处理，得到实体鉴别结果，实现安全探测模块和安全标识模块之间的双向认证，包括：S251，利用所述安全标识模块，将所述第二实体鉴别信息发送至所述安全标识模块密码处理单元；S252，所述安全标识模块密码处理单元，对所述第二实体鉴别信息进行处理，得到实体鉴别结果；S253，所述安全标识模块，将所述实体鉴别结果发送至所述安全探测模块，实现安全探测模块和安全标识模块之间的双向认证。9.根据权利要求4所述的安全探测方法，其特征在于，所述利用对称密钥管理模型，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息，包括：S41，利用所述安全探测模块，获取所述安全标识模块的安全参数；所述安全标识模块的安全参数包括安全标识模块的安全能力和基密钥索引；S42，所述安全探测模块，根据获取的基密钥索引和安全探测模块保存的基密钥，导出与安全标识模块对应的共享密钥PSK；S43，所述安全探测模块和所述安全标识模块，根据所述共享密钥PSK导出完整性校验密钥和加密密钥，对认证过程中的鉴别码进行完整性校验和数据加密；S44，认证完成后，所述安全探测模块和所述安全标识模块根据所述共享密钥PSK和RID,TID,RNr和RNt导出会话密钥，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息。
说明书desc
技术领域本发明涉及密码学技术领域，尤其涉及一种安全探测系统及方法。背景技术传统的无线射频识别技术，利用无线电射频信号识别特定物体并读写相关数据，在读写过程中不需要系统与指定物体建立机械或光学接触，而且RFID成本极低，广泛应用在工业场景中。但是，由于数据在空中传输，数据的机密性、完整性难以保证，经典的非轻量级加密方式，需要使用额外的供电系统，在物流管理、工业制造、航空包裹管理、文件追踪、图书馆管理、生物特征识别、运动计时、门禁管理、交通控制等领域受到限制。发明内容本发明所要解决的技术问题在于，提供一种安全探测系统及方法，能够克服现有技术的不足，通过混合密码的方式保证存储信息的机密性、完整性以及与电子安全标识模块传输信息的机密性。为了解决上述技术问题，本发明实施例第一方面公开了一种安全探测系统，所述系统包括：安全探测模块、安全标识模块和上位机；所述安全探测模块与所述安全标识模块、所述上位机进行信息交互；所述安全探测模块包括：安全探测模块密码处理单元、电源单元、总线隔离单元、通道选择单元、协议转换单元、通信接口单元和天线单元；所述安全探测模块密码处理单元与所述电源单元、所述天线单元、所述总线隔离单元信息交互；所述总线隔离单元与所述通道选择单元信息交互；所述协议转换单元与所述通道选择单元、所述通信接口单元信息交互；所述安全探测模块密码处理单元用于对安全标识模块进行数据管理；所述电源单元用于为所述安全探测模块密码处理单元供电；所述总线隔离单元用于保护所述安全探测模块密码处理单元和所述通道选择单元；所述通道选择单元用于进行通道选择；所述协议转换单元用于进行协议转换；所述通信接口单元包括CAN接口、RJ45以太网接口、RS232接口和TTL接口，用于进行信号转换；所述安全标识模块为有源RFID安全标识模块，包括MCU中央控制单元、微波收发信机、电池、安全标识模块密码处理单元和天线。作为一种可选的实施方法，本发明实施例第一方面中，所述安全探测模块密码处理单元，用于对安全标识模块进行数据管理，得到加密数据信息；所述安全探测模块密码处理单元，用于将所述加密数据信息发送至天线单元；所述天线单元，用于将所述加密数据信息发射出去。作为一种可选的实施方法，本发明实施例第一方面中，所述天线单元包括射频接口芯片；所述安全探测模块密码处理单元包括安全芯片；所述安全探测模块，用于利用所述射频接口芯片和所述安全芯片与上位机进行安全通信；所述安全探测模块密码处理单元，用于与所述射频接口芯片进行SPI通信。本发明实施例第二方面公开了一种安全探测方法，所述方法包括：S1，利用第一认证模型，对安全探测模块和上位机之间进行双向认证；S2，利用第二认证模型，对安全探测模块和安全标识模块之间进行双向认证；S3，双向认证通过后，所述安全探测模块和所述安全标识模块进行数据交互；所述数据交互包括盘点、读取数据和写入数据；S4，利用对称密钥管理模型，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息；S5，将所述加密数据信息发送至天线单元；S6，利用所述天线单元将所述加密数据信息发送出去。作为一种可选的实施方法，本发明实施例第二方面中，所述利用第二认证模型，对安全探测模块和安全标识模块之间进行双向认证，包括：S21，利用所述安全探测模块对所述安全标识模块进行实体鉴别，得到第一实体鉴别信息；S22，利用所述安全标识模块，向所述安全探测模块发送所述第一实体鉴别信息；S23，利用所述安全探测模块，对所述第一实体鉴别信息进行处理，得到第二实体鉴别信息；S24，利用所述安全探测模块，将所述第二实体鉴别信息发送至所述安全标识模块；S25，利用所述安全标识模块，对所述第二实体鉴别信息进行处理，得到实体鉴别结果，实现安全探测模块和安全标识模块之间的双向认证。作为一种可选的实施方法，本发明实施例第二方面中，所述利用所述安全探测模块对所述安全标识模块进行实体鉴别，得到第一实体鉴别信息，包括：S211，利用所述安全探测模块，向所述安全探测模块密码处理单元申请第一随机数；S212，所述安全探测模块密码处理单元返回所述第一随机数；S213，所述安全探测模块向所述安全标识模块发送鉴别请求和所述第一随机数；S214，所述安全标识模块将所述第一随机数发送至所述安全标识模块密码处理单元；S215，所述安全标识模块密码处理单元生成第二随机数和鉴别请求应答；所述第二随机数和鉴别请求应答构成第一实体鉴别信息。作为一种可选的实施方法，本发明实施例第二方面中，所述利用所述安全探测模块，对所述第一实体鉴别信息进行处理，得到第二实体鉴别信息，包括S231，所述安全探测模块，将所述第一实体鉴别信息发送至所述安全探测模块密码处理单元；S232，所述安全探测模块密码处理单元，对所述第一实体鉴别信息进行鉴别，得到第一鉴别结果和32位消息校验码；所述第一鉴别结果和32位消息校验码构成第二实体鉴别信息。作为一种可选的实施方法，本发明实施例第二方面中，所述利用所述安全标识模块，对所述第二实体鉴别信息进行处理，得到实体鉴别结果，实现安全探测模块和安全标识模块之间的双向认证，包括：S251，利用所述安全标识模块，将所述第二实体鉴别信息发送至所述安全标识模块密码处理单元；S252，所述安全标识模块密码处理单元，对所述第二实体鉴别信息进行处理，得到实体鉴别结果；S253，所述安全标识模块，将所述实体鉴别结果发送至所述安全探测模块，实现安全探测模块和安全标识模块之间的双向认证。作为一种可选的实施方法，本发明实施例第二方面中，所述利用对称密钥管理模型，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息，包括：S41，利用所述安全探测模块，获取所述安全标识模块的安全参数；所述安全标识模块的安全参数包括安全标识模块的安全能力和基密钥索引；S42，所述安全探测模块，根据获取的基密钥索引和安全探测模块保存的基密钥，导出与安全标识模块对应的共享密钥PSK；S43，所述安全探测模块和所述安全标识模块，根据所述共享密钥PSK导出完整性校验密钥和加密密钥，对认证过程中的鉴别码进行完整性校验和数据加密；S44，认证完成后，所述安全探测模块和所述安全标识模块根据所述共享密钥PSK和RID,TID,RNr和RNt导出会话密钥，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息。与现有技术相比，本发明实施例具有以下有益效果：本发明设计一种安全探测系统及方法，包括安全探测模块、安全标识模块和上位机；所述安全探测模块与所述安全标识模块、所述上位机进行信息交互；所述安全探测模块包括：安全探测模块密码处理单元、电源单元、总线隔离单元、通道选择单元、协议转换单元、通信接口单元和天线单元；所述安全标识模块为有源RFID安全标识模块，包括MCU中央控制单元、微波收发信机、电池、安全标识模块密码处理单元和天线。通过本发明的技术方案，能够用于典型应用场景下物联网终端的安全防护，为终端模块和接入点提供双向安全接入认证功能，提供传输数据加密保护功能，提供终端权限访问控制功能。本发明通过混合密码的方式保证存储信息的机密性、完整性以及与安全标识模块传输信息的机密性。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例公开的一种安全探测系统的结构框图；图2是本发明实施例公开的安全探测模块电路原理的示意框图；图3是本发明实施例公开的一种安全探测方法的流程示意图；图4是本发明实施例公开的盘点安全标识模块流程的整体示意框图；图5是本发明实施例公开的安全探测模块读取数据流程的示意框图；图6是本发明实施例公开的安全探测模块写入数据流程的示意框图；图7是本发明实施例公开的安全标识模块示意图；图8是本发明实施例公开的安全探测模块对称密钥管理的示意框图；图9是本发明实施例公开的密钥使用和销毁流程的示意框图；图10是本发明实施例公开的双向认证流程规定的示意框图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别不同对象，而不是用于描述特定顺序。此外，术语“包括”和“具有”以及它们任何变形，意图在于覆盖不排他的包含。例如包含了一系列步骤或单元的过程、方法、装置、产品或设备没有限定于已列出的步骤或单元，而是可选地还包括没有列出的步骤或单元，或可选地还包括对于这些过程、方法、产品或设备固有的其他步骤或单元。在本文中提及“实施例”意味着，结合实施例描述的特定特征、结构或特性可以包含在本发明的至少一个实施例中。在说明书中的各个位置出现该短语并不一定均是指相同的实施例，也不是与其它实施例互斥的独立的或备选的实施例。本领域技术人员显式地和隐式地理解的是，本文所描述的实施例可以与其它实施例相结合。本发明公开了一种安全探测系统及方法，包括：安全探测模块、安全标识模块和上位机；所述安全探测模块与所述安全标识模块、所述上位机进行信息交互；所述安全探测模块包括：安全探测模块密码处理单元、电源单元、总线隔离单元、通道选择单元、协议转换单元、通信接口单元和天线单元；所述安全标识模块为有源RFID安全标识模块，包括MCU中央控制单元、微波收发信机、电池、安全标识模块密码处理单元和天线。本发明方法能够用于典型应用场景下物联网终端的安全防护，为终端模块和接入点提供双向安全接入认证功能，提供传输数据加密保护功能，提供终端权限访问控制功能。以下分别进行详细说明。实施例一请参阅图1，图1是本发明实施例公开的一种安全探测系统的结构框图。其中，图1所描述的安全探测系统通过混合密码的方式保证存储信息的机密性、完整性以及与电子安全标识模块传输信息的机密性，本发明实施例不做限定。如图1所示，该安全探测系统包括安全探测模块、安全标识模块和上位机；所述安全探测模块与所述安全标识模块、所述上位机进行信息交互；如图2所示，所述安全探测模块包括：安全探测模块密码处理单元、电源单元、总线隔离单元、通道选择单元、协议转换单元、通信接口单元和天线单元；所述安全探测模块密码处理单元与所述电源单元、所述天线单元、所述总线隔离单元信息交互；所述总线隔离单元与所述通道选择单元信息交互；所述协议转换单元与所述通道选择单元、所述通信接口单元信息交互；所述安全探测模块密码处理单元用于对安全标识模块进行数据管理；所述电源单元用于为所述安全探测模块密码处理单元供电；所述总线隔离单元用于保护所述安全探测模块密码处理单元和所述通道选择单元；所述通道选择单元用于进行通道选择；所述协议转换单元用于进行协议转换；所述通信接口单元包括CAN接口、RJ45以太网接口、RS232接口和TTL接口，用于进行信号转换；所述安全标识模块为有源RFID安全标识模块，包括MCU中央控制单元、微波收发信机、电池、安全标识模块密码处理单元和天线。可选的，所述安全探测模块密码处理单元，用于对安全标识模块进行数据管理，得到加密数据信息；所述安全探测模块密码处理单元，用于将所述加密数据信息通过射频接口芯片发送至天线单元；所述天线单元，用于将所述加密数据信息发射出去。可选的，安全探测模块密码处理单元进行密码算法的调用以及通信接口单元的处理，提供安全探测模块与安全标识模块认证的可靠通信，可选的，所述天线单元包括射频接口芯片；所述安全探测模块密码处理单元包括安全芯片；所述安全探测模块，用于利用所述射频接口芯片和所述安全芯片与上位机进行安全通信；可选的，安全探测模块密码处理单元的安全芯片选用ST半导体STM32F207ZGCORTEX-M3 ARM内核；所述安全探测模块密码处理单元，用于与所述射频接口芯片进行SPI通信。安全探测模块支持如下安全要素：a)存储信息的机密性b)存储信息的完整性c)与安全标识模块传输信息的机密性d)抗安全标识模块原发抵赖e)安全探测模块与安全标识模块双向挑战响应身份鉴别f)访问控制g)此外，安全探测模块应支持与上位机之间的传输信息的机密性和完整性、身份鉴别、访问控制、抗抵赖等安全要素。可见，通过本发明的技术方案，能够用于典型应用场景下物联网终端的安全防护，为终端模块和接入点提供双向安全接入认证功能，提供传输数据加密保护功能，提供终端权限访问控制功能。本发明通过混合密码的方式保证存储信息的机密性、完整性以及与安全标识模块传输信息的机密性。实施例二请参阅图3，图3是本发明实施例公开的一种安全探测方法的示意图。其中，图3所描述的安全探测方法通过混合密码的方式保证存储信息的机密性、完整性以及与电子安全标识模块传输信息的机密性，本发明实施例不做限定。如图3所示，该安全探测方法包括：S1，利用第一认证模型，对安全探测模块和上位机之间进行双向认证；S1的具体步骤包括：采用SM1对称密码算法实现安全探测模块与上位机的双向身份鉴别。双向鉴别前，安全探测模块读取上位机的UID，使用该UID对根密钥分散得到与该上位机存储的个性化密钥一致的分散密钥K1。①安全探测模块向上位机发送鉴别指令。②上位机接收到鉴别指令后，产生随机数RT，发送给安全探测模块。③安全探测模块产生随机数RR，用上位机的个性化密钥K1对RR和RT进行加密得到Token1＝Enc；安全探测模块将Token1发送给电子安全标识模块。④上位机用个性化密钥K1解密Token1得到RR’和RT’。比较RT’和RT，若RT’＝RT，则上位机将RR’发送给安全探测模块。⑤安全探测模块比较RR’和RR，若RR’＝RR，则双向鉴别通过。S2，利用第二认证模型，对安全探测模块和安全标识模块之间进行双向认证；S3，双向认证通过后，所述安全探测模块和所述安全标识模块进行数据交互；所述数据交互包括盘点、读取数据和写入数据；安全探测模块盘点安全标识模块流程如下：①控制主板通过串口发出盘点命令。②安全探测模块首先持续发送一段时间的就绪指令，以唤醒休眠的安全标识模块。③安全探测模块发出接入指令，为在通信范围内的所有安全标识模块分配收集时隙。④安全探测模块发出收集命令。⑤安全标识模块按照分配的时隙应答收集命令，返回安全标识模块ID。⑥安全探测模块通过串口返回收到的安全标识模块ID。⑦安全探测模块判断没有新的安全标识模块后通过串口通知主控板盘点安全标识模块结束。安全探测模块读取数据安全标识模块流程如下：①主控板通过串口发出读取数据的命令，指定安全标识模块ID，读取的文件ID，地址和长度。②安全探测模块首先选择文件，根据文件的安全属性，安全探测模块会执行与安全标识模块的双向认证。③认证通过后，安全探测模块与安全标识模块之间通过安全通信读取数据。④安全探测模块将数据解密后通过串口返回给主控板。安全探测模块写入数据安全标识模块流程如下：①主控板通过串口发出写入数据的命令，指定安全标识模块ID，写入的文件ID，地址、长度和数据内容。②安全探测模块首先选择文件，根据文件的安全属性，安全探测模块会执行与安全标识模块的双向认证。③认证通过后，安全探测模块与安全标识模块之间通过安全通信读取数据，安全探测模块将数据加密后发送给安全标识模块。④安全探测模块将写入的执行结果返回给主控板。S4，利用对称密钥管理模型，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息；S5，将所述加密数据信息发送至天线单元；S6，利用所述天线单元将所述加密数据信息发送出去。可选的，对称密钥管理模型包含密钥生命周期的密钥生成、密钥分发、密钥使用和密钥销毁的四个主要过程。安全探测模块是安全标识模块的读写控制器，由安全芯片和射频接口芯片和TCP/IP等通讯接口等组成，以微波无线传递手段，实现与安全标识模块的之间安全可靠的信息交换目的。可选的，可以采用的加密算法为：1)对称密码算法用于身份鉴别、访问控制、机密性保护、完整性保护、密钥协商和密钥分散。2)非对称密码算法用于抗抵赖、身份鉴别、机密性保护、完整性保护、密钥协商和密钥交换。3)密码杂凑函数用于产生数据摘要信息，进行完整性校验。所述安全标识模块与安全探测模块的通信采用密码安全实现方式，需要满足传输信息的机密性；传输信息的完整性以及身份鉴别。传输信息机密性是指安全探测模块和安全标识模块之间进行数据加密传输之前，采用分组密码算法的密钥协商；所述传输信息的完整性是双方通信过程中，使用HMAC的方式进行完整性校验；所述身份鉴别可以采用SM7对称分组密码算法的双向身份鉴别。HMAC是基于哈希函数和密钥的一种消息认证算法，全称为“Hash-based Message AuthenticationCode”。可选的，可以采用SM1密码算法实现安全探测模块与上位机的双向身份鉴别；采用SM1密码算法对数据加密并计算校验值，以实现安全探测模块与上位机之间传输信息的机密性和完整性。安全标识模块中的物资运输信息保存在文件中，文件要求认证后进入安全会话才能进行读写访问，安全探测模块中封装文件的访问过程，外部的上位机通过串口通信驱动安全探测模块完成对安全标识模块的盘点和安全探测模块操作。图4是本发明实施例公开的盘点安全标识模块流程的整体示意框图：1)控制主板通过串口发出盘点命令；2)安全探测模块首先持续发送一段时间的就绪指令，以唤醒休眠的安全标识模块；3)安全探测模块发出接入指令，为在通信范围内的所有安全标识模块分配收集时隙；4)安全探测模块发出收集命令；5)安全标识模块按照分配的时隙应答收集命令，返回安全标识模块ID；6)安全探测模块通过串口返回收到的安全标识模块ID；7)安全探测模块判断没有新的安全标识模块后通过串口通知主控板盘点安全标识模块结束。图5是本发明实施例公开的安全探测模块读取数据流程的示意框图：1)主控板通过串口发出读取数据的命令，指定安全标识模块ID，读取的文件ID，地址和长度；2)安全探测模块首先选择文件，根据文件的安全属性，安全探测模块会执行与安全标识模块的双向认证；3)认证通过后，安全探测模块与安全标识模块之间通过安全通信读取数据；4)安全探测模块将数据解密后通过串口返回给主控板。图6是本发明实施例公开的安全探测模块写入数据流程的示意框图：1)主控板通过串口发出写入数据的命令，指定安全标识模块ID，写入的文件ID，地址、长度和数据内容；2)安全探测模块首先选择文件，根据文件的安全属性，安全探测模块会执行与安全标识模块的双向认证；3)认证通过后，安全探测模块与安全标识模块之间通过安全通信读取数据，安全探测模块将数据加密后发送给安全标识模块；4)安全探测模块将写入的执行结果返回给主控板。图7是本发明实施例公开的安全标识模块示意图，安全标识模块初始化或发行时，存储根公钥Pu、电子安全标识模块的私钥Pr_T和用根私钥签发的证书CER_T。安全探测模块存储根公钥Pu、安全探测模块的私钥Pr_R和用根私钥签发的证书CER_R。选择国家密码管理部门认可的密码算法，用于产生数据摘要信息，进行完整性校验。可选的，所述利用第二认证模型，对安全探测模块和安全标识模块之间进行双向认证，包括：S21，利用所述安全探测模块对所述安全标识模块进行实体鉴别，得到第一实体鉴别信息；S22，利用所述安全标识模块，向所述安全探测模块发送所述第一实体鉴别信息；S23，利用所述安全探测模块，对所述第一实体鉴别信息进行处理，得到第二实体鉴别信息；S24，利用所述安全探测模块，将所述第二实体鉴别信息发送至所述安全标识模块；S25，利用所述安全标识模块，对所述第二实体鉴别信息进行处理，得到实体鉴别结果，实现安全探测模块和安全标识模块之间的双向认证。可选的，所述利用所述安全探测模块对所述安全标识模块进行实体鉴别，得到第一实体鉴别信息，包括：S211，利用所述安全探测模块，向所述安全探测模块密码处理单元申请第一随机数；S212，所述安全探测模块密码处理单元返回所述第一随机数；S213，所述安全探测模块向所述安全标识模块发送鉴别请求和所述第一随机数；S214，所述安全标识模块将所述第一随机数发送至所述安全标识模块密码处理单元；S215，所述安全标识模块密码处理单元生成第二随机数和鉴别请求应答；鉴别请求应答为32字节的鉴别请求应答MAC，MAC＝E，MIK为完整性校验密钥，MEK为消息加密密钥；所述第二随机数和鉴别请求应答构成第一实体鉴别信息。可选的，所述利用所述安全探测模块，对所述第一实体鉴别信息进行处理，得到第二实体鉴别信息，包括S231，所述安全探测模块，将所述第一实体鉴别信息发送至所述安全探测模块密码处理单元；S232，所述安全探测模块密码处理单元，对所述第一实体鉴别信息进行鉴别，得到第一鉴别结果和32位消息校验码；所述第一鉴别结果和32位消息校验码构成第二实体鉴别信息。可选的，所述利用所述安全标识模块，对所述第二实体鉴别信息进行处理，得到实体鉴别结果，实现安全探测模块和安全标识模块之间的双向认证，包括：S251，利用所述安全标识模块，将所述第二实体鉴别信息发送至所述安全标识模块密码处理单元；S252，所述安全标识模块密码处理单元，对所述第二实体鉴别信息进行处理，得到实体鉴别结果；S253，所述安全标识模块，将所述实体鉴别结果发送至所述安全探测模块，实现安全探测模块和安全标识模块之间的双向认证。可选的，所述利用对称密钥管理模型，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息，包括：S41，利用所述安全探测模块，获取所述安全标识模块的安全参数；所述安全标识模块的安全参数包括安全标识模块的安全能力和基密钥索引；S42，所述安全探测模块，根据获取的基密钥索引和安全探测模块保存的基密钥，导出与安全标识模块对应的共享密钥PSK；S43，所述安全探测模块和所述安全标识模块，根据所述共享密钥PSK导出完整性校验密钥和加密密钥，对认证过程中的鉴别码进行完整性校验和数据加密；S44，认证完成后，所述安全探测模块和所述安全标识模块根据所述共享密钥PSK和RID,TID,RNr和RNt导出会话密钥，对所述安全探测模块读取的数据进行加密管理，得到加密数据信息。RID是Request Identity的缩写，即请求ID。TID是RFID标签中存在的全球唯一性码，每个码都是独一无二的。每个RFID都带有唯一的UID/TID码。图8是本发明实施例公开的安全探测模块对称密钥管理的示意框图，密钥生成系统完成射频识别系统中密钥的生成和密钥的分散，密钥分发系统完成对安全标识模块和安全探测模块的密钥分发与注入；密钥在安全密码设备中使用，安全密码设备包括安全探测模块内安全存取模块和安全标识模块。图9是本发明实施例公开的密钥使用和销毁流程的示意框图：安全探测模块和安全标识模块具备自毁能力，可自毁保存的用户区数据和所有的安全数据。图10是本发明实施例公开的双向认证流程规定的示意框图。所述对称密钥管理模型包含了密钥生命周期的密钥生成、密钥分发、密钥使用和密钥销毁的四个主要过程。需要说明的是，本发明提供的安全探测系统中的安全探测模块，预留了丰富的接口，便于与外部系统集成。可见，通过本发明的技术方案，能够用于典型应用场景下物联网终端的安全防护，为终端模块和接入点提供双向安全接入认证功能，提供传输数据加密保护功能，提供终端权限访问控制功能。本发明通过混合密码的方式保证存储信息的机密性、完整性以及与安全标识模块传输信息的机密性。以上所描述的装置实施例仅是示意性的，其中作为分离部件说明的模块可以是或者也可以不是物理上分开的，作为模块显示的部件可以是或者也可以不是物理模块，即可以位于一个地方，或者也可以分布到多个网络模块上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。通过以上的实施例的具体描述，本领域的技术人员可以清楚地了解到各实施方式可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件。基于这样的理解，上述技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品可以存储在计算机可读存储介质中,存储介质包括只读存储器、随机存储器、可编程只读存储器、可擦除可编程只读存储器、一次可编程只读存储器、电子抹除式可复写只读存储器、只读光盘或其他光盘存储器、磁盘存储器、磁带存储器、或者能够用于携带或存储数据的计算机可读的任何其他介质。最后应说明的是：本发明实施例公开的一种安全探测系统及方法所揭露的仅为本发明较佳实施例而已，仅用于说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解；其依然可以对前述各项实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或替换，并不使相应的技术方案的本质脱离本发明各项实施例技术方案的精神和范围。
