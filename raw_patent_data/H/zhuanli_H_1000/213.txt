标题title
用于构网型变流器的虚拟同步机有功功率控制方法及装置
摘要abst
本发明公开了一种用于构网型变流器的虚拟同步机有功功率控制方法及装置，在虚拟同步机输出功率和角频率满足一定条件时，触发积分器，使其在稳态时将阻尼功率调整为零，从而解决了常规构网型变流器虚拟同步机有功功率控制存在的动态功率震荡与稳态功率偏差之间的矛盾问题。该发明根据虚拟同步机输出的角频率和设定的角频率之间的误差以及虚拟同步机输出的有功功率和设定的有功功率与第一功率偏差之间的误差关系，动态触发积分器，从而动态调整阻尼功率，使其在稳态时缓慢减小为零，从而在阻尼系数不为零的前提下可在稳态时将阻尼功率调整为零，消除稳态有功功率偏差，提高构网型变流器虚拟同步机有功功率控制精度。
权利要求书clms
1.一种用于构网型变流器的虚拟同步机有功功率控制方法，其特征在于，包括如下步骤：步骤1、将设定的电网额定角频率ω0与构网型变流器虚拟同步机控制策略输出的角频率ω做差，并乘以下垂系数kω得到第一功率偏差，满足：其中，为电网额定角频率ω0与虚拟同步机输出的角频率ω的差值，电网额定角频率ω0为100π rad/s；步骤2、将设定的虚拟同步机有功功率参考值Pref与步骤1得到的第一功率偏差相加，并减去虚拟同步机输出的有功功率Pe，得到第二功率偏差/＞，满足：步骤3、将步骤2得到的第二功率偏差减去阻尼功率PD，并按照下式进行积分运算，得到第一频率偏差/＞，满足：其中，s表示拉普莱斯算子，J表示虚拟同步机的虚拟惯量；阻尼功率PD根据第一频率偏差和第二频率偏差/＞获取，第二频率偏差/＞根据阻尼功率PD和积分器的积分系数获取；步骤4、将步骤3得到第一频率偏差的与设定的电网额定角频率ω0相加，得到虚拟同步机输出的角频率ω，满足：步骤5、将步骤4得到的虚拟同步机输出的角频率ω减去电网的实际角频率ωg之后，再进行积分运算，得到虚拟同步机输出的功角δ，满足：。2.根据权利要求1所述的一种用于构网型变流器的虚拟同步机有功功率控制方法，其特征在于，步骤2中的虚拟同步机输出的有功功率Pe的计算公式满足：其中，，U为电网电压幅值，E为虚拟同步机输出电压的幅值，X为电网等效线路阻抗。3.根据权利要求1所述的一种用于构网型变流器的虚拟同步机有功功率控制方法，其特征在于，步骤3中的阻尼功率PD采用如下公式计算：其中，D为虚拟同步机的虚拟阻尼系数，为第二频率偏差。4.根据权利要求3所述的一种用于构网型变流器的虚拟同步机有功功率控制方法，其特征在于，第二频率偏差的计算方法如下：当时，积分器输出端开关S闭合，此时，第二频率偏差/＞的计算方法满足：其中， ki为积分系数；当时，积分器输出端开关S断开，此时，令第二频率偏差/＞为零。5.一种用于构网型变流器的虚拟同步机有功功率控制装置，其特征在于，包括：第一功率偏差计算模块，用于将设定的电网额定角频率ω0与构网型变流器虚拟同步机控制策略输出的角频率ω做差，并乘以下垂系数kω得到第一功率偏差，满足：其中，为电网额定角频率ω0与虚拟同步机输出的角频率ω的差值，电网额定角频率ω0为100π rad/s；第二功率偏差计算模块，用于将设定的虚拟同步机有功功率参考值Pref与步骤1得到的第一功率偏差相加，并减去虚拟同步机输出的有功功率Pe，得到第二功率偏差/＞，满足：第一频率偏差计算模块，用于将第二功率偏差减去阻尼功率PD，并按照下式进行积分运算，得到第一频率偏差/＞，满足：其中，s表示拉普莱斯算子，J表示虚拟同步机的虚拟惯量；阻尼功率PD根据第一频率偏差和第二频率偏差/＞获取，第二频率偏差/＞根据阻尼功率PD和积分器的积分系数获取；角频率计算模块，用于将第一频率偏差的与设定的电网额定角频率ω0相加，得到虚拟同步机输出的角频率ω，满足：功角计算模块，用于将虚拟同步机输出的角频率ω减去电网的实际角频率ωg之后，再进行积分运算，得到虚拟同步机输出的功角δ，满足：。6.根据权利要求5所述的一种用于构网型变流器的虚拟同步机有功功率控制装置，其特征在于，虚拟同步机输出的有功功率Pe的计算公式满足：其中，，U为电网电压幅值，E为虚拟同步机输出电压的幅值，X为电网等效线路阻抗。7.根据权利要求5所述的一种用于构网型变流器的虚拟同步机有功功率控制装置，其特征在于，阻尼功率PD采用如下公式计算：其中，D为虚拟同步机的虚拟阻尼系数，为第二频率偏差。8.根据权利要求5所述的一种用于构网型变流器的虚拟同步机有功功率控制装置，其特征在于，第二频率偏差的计算方法如下：当时，积分器输出端开关S闭合，此时，第二频率偏差/＞的计算方法满足：其中， ki为积分系数；当时，积分器输出端开关S断开，此时，令第二频率偏差/＞为零。
说明书desc
技术领域本发明涉及新能源并网发电技术领域，具体是一种用于构网型变流器的虚拟同步机有功功率控制方法及装置。背景技术为了增强新能源并网逆变器对电网的适应能力和支撑能力，近年来，构网型逆变器及其控制技术得到广泛关注和研究。虚拟同步机技术是一种典型的可实现新能源并网逆变器以构网模式运行的新型控制策略，既可以实现离网运行，也可以实现并网运行。同时，通过引入虚拟惯量和阻尼，虚拟同步机控制技术还可以使新能源并网逆变器模拟同步发电机的特性，增强其运行稳定性。然而，由于惯量和阻尼的引入，现有的虚拟同步机在有功功率参考值突变时往往会存在功率震荡和超调，动态性能较差。此外，当电网频率偏移时，虚拟同步机会主动调整输出的有功功率，以实现对电网频率偏移的支撑。然而，阻尼系数的引入会增大电网频率偏移时的有功功率稳态偏差，降低控制精度。发明专利“颜湘武,王德胜,王雨薇等. 大扰动情况下虚拟同步机惯量参数自适应控制. 北京: CN108494002A, 2018-09-04.” 提出一种大扰动情况下虚拟同步机惯量参数自适应控制方法，通过惯量自适应，显著减小了暂态时的有功功率震荡。发明专利“张兴,陈思宇,巫宇航等. 基于分段自适应虚拟惯量的虚拟同步机频率调节方法. 安徽省: CN114914912A, 2022-08-16.”提出一种虚拟惯量分段自适应设计方法，改善了电网频率偏移时的频率动态特性。发明专利“王骏海,杨翾,尹建兵等. 一种自适应惯量的光储虚拟同步发电机控制方法及装置. 浙江省: CN116780640A, 2023-09-19.”提出了一种自适应惯量设计方法，减小了负载突变或故障场景等工况下的频率变化率。上述文献虽然可以降低功率和频率的震荡和超调，但未考虑电网频率偏移时的有功功率稳态偏差问题。文献“石荣亮,王斌,黄冀等.储能虚拟同步机的并网阻尼特性分析与改进策略.太阳能学报,2023,44:30-38.”提出了一种基于有功功率微分反馈的暂态阻尼改进策略。该方法可以同时实现动态有功功率震荡抑制和稳态有功功率偏差消除。然而，该方法需要使用微分算法，这会放大噪声的影响，严重时会降低系统的稳定性。发明专利“构网型变流器虚拟同步发电机有功功率控制方法及装置”提出一种引入比例积分控制器对阻尼功率进行调整的构网型变流器虚拟同步发电机有功功率控制方法。该方法主要存在如下两方面缺点：1. 引入的比例积分控制器包含两个待设计的参数，即比例系数和积分系数。因此，若要得到较好的控制效果，需要同时合理设计和选择比例系数和积分系数。这会增大系统的设计和调试复杂度。2. 引入的比例积分控制器会实时调整阻尼功率，在稳态及有功功率突变和电网频率突变动态过程中，引入的比例积分控制器和构网型变流器虚拟同步发电机控制本身的阻尼系数D相互耦合、相互影响，对系统的稳定性运行也有一定的影响。由上述分析可知，现有技术虽然可以解决传统构网型变流器虚拟同步机有功功率动态振荡、超调和静差问题，但大部分算法主要关注的是动态功率震荡和频率震荡抑制，未充分考虑电网频率偏移时的有功功率稳态偏差问题。虽然部分文献同时考虑了动态有功功率震荡抑制和稳态有功功率偏差消除问题，但这种方法存在需要引入微分运算、易引起系统不稳定和需要设计多个控制器参数等问题。发明内容为了克服常规构网型变流器虚拟同步机有功功率控制动态存在震荡和稳态存在功率偏差的矛盾问题，本发明公开了一种用于构网型变流器的虚拟同步机有功功率控制方法及装置。为达到上述目的，本发明所采用的技术方案是：一种用于构网型变流器的虚拟同步机有功功率控制方法，包括如下步骤：步骤1、将设定的电网额定角频率ω0与构网型变流器虚拟同步机控制策略输出的角频率ω做差，并乘以下垂系数kω得到第一功率偏差，满足：其中，为电网额定角频率ω0与虚拟同步机输出的角频率ω的差值，电网额定角频率ω0为100π rad/s；步骤2、将设定的虚拟同步机有功功率参考值Pref与步骤1得到的第一功率偏差相加，并减去虚拟同步机输出的有功功率Pe，得到第二功率偏差/＞，满足：步骤3、将步骤2得到的第二功率偏差减去阻尼功率PD，并按照下式进行积分运算，得到第一频率偏差/＞，满足：其中，s表示拉普莱斯算子，J表示虚拟同步机的虚拟惯量；阻尼功率PD根据第一频率偏差和第二频率偏差/＞获取，第二频率偏差/＞根据阻尼功率PD和积分器的积分系数获取；步骤4、将步骤3得到第一频率偏差的与设定的电网额定角频率ω0相加，得到虚拟同步机输出的角频率ω，满足：步骤5、将步骤4得到的虚拟同步机输出的角频率ω减去电网的实际角频率ωg之后，再进行积分运算，得到虚拟同步机输出的功角δ，满足：。进一步的，步骤2中的虚拟同步机输出的有功功率Pe的计算公式满足：其中，，U为电网电压幅值，E为虚拟同步机输出电压的幅值，X为电网等效线路阻抗。进一步的，步骤3中的阻尼功率PD采用如下公式计算：其中，D为虚拟同步机的虚拟阻尼系数，为第二频率偏差。进一步的，第二频率偏差的计算方法如下：当时，积分器输出端开关S闭合，此时，第二频率偏差/＞的计算方法满足：其中， ki为积分系数；当时，积分器输出端开关S断开，此时，令第二频率偏差/＞为零。一种用于构网型变流器的虚拟同步机有功功率控制装置，包括：第一功率偏差计算模块，用于将设定的电网额定角频率ω0与构网型变流器虚拟同步机控制策略输出的角频率ω做差，并乘以下垂系数kω得到第一功率偏差，满足：其中，为电网额定角频率ω0与虚拟同步机输出的角频率ω的差值，电网额定角频率ω0为100π rad/s；第二功率偏差计算模块，用于将设定的虚拟同步机有功功率参考值Pref与步骤1得到的第一功率偏差相加，并减去虚拟同步机输出的有功功率Pe，得到第二功率偏差，满足：第一频率偏差计算模块，用于将第二功率偏差减去阻尼功率PD，并按照下式进行积分运算，得到第一频率偏差/＞，满足：其中，s表示拉普莱斯算子，J表示虚拟同步机的虚拟惯量；阻尼功率PD根据第一频率偏差和第二频率偏差/＞获取，第二频率偏差/＞根据阻尼功率PD和积分器的积分系数获取；角频率计算模块，用于将第一频率偏差的与设定的电网额定角频率ω0相加，得到虚拟同步机输出的角频率ω，满足：功角计算模块，用于将虚拟同步机输出的角频率ω减去电网的实际角频率ωg之后，再进行积分运算，得到虚拟同步机输出的功角δ，满足：。进一步的，虚拟同步机输出的有功功率Pe的计算公式满足：其中，，U为电网电压幅值，E为虚拟同步机输出电压的幅值，X为电网等效线路阻抗。进一步的，阻尼功率PD采用如下公式计算：其中，D为虚拟同步机的虚拟阻尼系数，为第二频率偏差。进一步的，第二频率偏差的计算方法如下：当时，积分器输出端开关S闭合，此时，第二频率偏差/＞的计算方法满足：其中， ki为积分系数；当时，积分器输出端开关S断开，此时，令第二频率偏差/＞为零。与现有技术相比，本发明具有以下有益效果：1. 本发明仅有一个待设计的参数，即触发积分器的积分系数ki，只要合理选择ki，即可使改进后的构网型变流器虚拟同步机控制策略同时实现动态有功功率震荡抑制和稳态有功功率偏差消除，系统的设计和调试复杂度得到简化。2. 本发明仅在动态过程中满足一定条件时才会触发积分器作用。在稳态时，所引入的积分器输出的第二频率偏差为0，即稳态时所引入的积分器不起作用。此时，虚拟同步发电机工作方式与常规方法相同，保证了系统具有较高的稳定性。3. 本发明无需使用微分运算，不会放大系统噪声，稳定性更好。附图说明图1为常规的构网型变流器虚拟同步机有功功率控制框图；图2为本发明实施例用于构网型变流器的虚拟同步机有功功率控制方法的控制框图；图3为常规虚拟同步机和本发明所提构网型变流器虚拟同步机有功功率控制对比仿真结果。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。如图2所示，本发明实施例提供一种用于构网型变流器的虚拟同步机有功功率控制方法，包括如下步骤：步骤1、将设定的电网额定角频率ω0与构网型变流器虚拟同步机控制策略输出的角频率ω做差，并乘以下垂系数kω得到第一功率偏差，满足：其中，为电网额定角频率ω0与虚拟同步机输出的角频率ω的差值，电网额定角频率ω0为100π rad/s；步骤2、将设定的虚拟同步机有功功率参考值Pref与步骤1得到的第一功率偏差相加，并减去虚拟同步机输出的有功功率Pe，得到第二功率偏差/＞，满足：其中，虚拟同步机输出的有功功率Pe的计算公式满足：其中，，U为电网电压幅值，E为虚拟同步机输出电压的幅值，X为电网等效线路阻抗。步骤3、将步骤2得到的第二功率偏差减去阻尼功率PD，并按照下式进行积分运算，得到第一频率偏差/＞，满足：其中，s表示拉普莱斯算子，J表示虚拟同步机的虚拟惯量；其中阻尼功率PD采用如下公式计算：其中，D为虚拟同步机的虚拟阻尼系数，为第二频率偏差。其中，第二频率偏差的计算方法如下：当时，积分器输出端开关S闭合，此时，第二频率偏差/＞的计算方法满足：其中， ki为积分系数；当时，积分器输出端开关S断开，此时，令第二频率偏差/＞为零。步骤4、将步骤3得到第一频率偏差的与设定的电网额定角频率ω0相加，得到虚拟同步机输出的角频率ω，满足：步骤5、将步骤4得到的虚拟同步机输出的角频率ω减去电网的实际角频率ωg之后，再进行积分运算，得到虚拟同步机输出的功角δ，满足：。本发明实施例还提供一种用于构网型变流器的虚拟同步机有功功率控制装置，包括：第一功率偏差计算模块，用于将设定的电网额定角频率ω0与构网型变流器虚拟同步机控制策略输出的角频率ω做差，并乘以下垂系数kω得到第一功率偏差，满足：其中，为电网额定角频率ω0与虚拟同步机输出的角频率ω的差值，电网额定角频率ω0为100π rad/s；第二功率偏差计算模块，用于将设定的虚拟同步机有功功率参考值Pref与第一功率偏差相加，并减去虚拟同步机输出的有功功率Pe，得到第二功率偏差/＞，满足：其中虚拟同步机输出的有功功率Pe的计算公式满足：其中，，U为电网电压幅值，E为虚拟同步机输出电压的幅值，X为电网等效线路阻抗。第一频率偏差计算模块，用于将第二功率偏差减去阻尼功率PD，并按照下式进行积分运算，得到第一频率偏差/＞，满足：其中，s表示拉普莱斯算子，J表示虚拟同步机的虚拟惯量；阻尼功率PD根据第一频率偏差和第二频率偏差/＞获取，第二频率偏差/＞根据阻尼功率PD和积分器的积分系数获取；阻尼功率PD采用如下公式计算：其中，D为虚拟同步机的虚拟阻尼系数，为第二频率偏差。第二频率偏差的计算方法如下：当时，积分器输出端开关S闭合，此时，第二频率偏差/＞的计算方法满足：其中， ki为积分系数；当时，积分器输出端开关S断开，此时，令第二频率偏差/＞为零。角频率计算模块，用于将第一频率偏差的与设定的电网额定角频率ω0相加，得到虚拟同步机输出的角频率ω，满足：功角计算模块，用于将虚拟同步机输出的角频率ω减去电网的实际角频率ωg之后，再进行积分运算，得到虚拟同步机输出的功角δ，满足：。为了验证本发明所提方法的有效性，与常规的构网型变流器虚拟同步机有功功率控制策略进行了对比仿真研究。仿真时，有功功率参考值Pref在2s之前为5kW，在2s时Pref由5kW突增为10kW，在4s时Pref由10kW突减为5kW，在6s时电网的实际角频率ωg由100π rad/s 突减为99.8π rad/s 。虚拟惯量J为0.5kg/m2，电网额定角频率ω0为100π rad/s，下垂系数kω为2000，电网相电压峰值为311V，虚拟同步机输出电压峰值311。电网线路电阻为0.2Ω，线路电感为20mH。图3给出了常规构网型变流器虚拟同步机和本发明所提构网型变流器虚拟同步机有功功率控制对比仿真结果。仿真时，常规虚拟同步机有功功率控制方法的虚拟阻尼系数D分别取0和10Ws/rad。本发明方法的虚拟阻尼系数设为10Ws/rad，积分系数ki为0.01。由图3可见，在虚拟阻尼系数D为零时，常规虚拟同步机控制策略输出的有功功率出现了明显的震荡和超调。当虚拟阻尼系数D增大到10时，震荡得到明显抑制。然而，由图3可见，虚拟阻尼系数的增大也会导致电网频率出现偏差时，有功功率稳态偏差也明显增大。可见，常规的虚拟同步机有功功率控制策略无法通过调节虚拟阻尼系数同时实现有功功率动态震荡抑制和稳态静差消除。然而，由图3可见，虚拟阻尼系数D增大到10，采用本发明所提方法时，不仅有功功率震荡得到了抑制，而且在电网频率出现偏差时，有功功率稳态偏差在所设计的触发积分算法的作用下趋近于零。可见，本发明所提方法可以通过调节虚拟阻尼系数D和所引入积分器的积分系数，同时实现有功功率动态震荡抑制和稳态静差消除。这证明了本发明所提方法的有效性。本发明根据虚拟同步机输出的角频率和设定的角频率之间的误差以及虚拟同步机输出的有功功率和设定的有功功率与第一功率偏差之间的误差关系，动态触发积分器，从而动态调整阻尼功率，使其在稳态时缓慢减小为零，从而在阻尼系数不为零的前提下可在稳态时将阻尼功率调整为零，消除稳态有功功率偏差，提高虚拟同步机有功功率控制精度。与常规方法不同的是，本发明引入了一种触发积分算法，在满足一定条件时，触发积分器作用，从而在稳态时将阻尼功率调整为零，进而消除稳态功率静差。因此，改进后的构网型变流器虚拟同步机有功功率控制策略既具有惯量和阻尼特性，又没有功率稳态误差。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何属于本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应该以权利要求的保护范围为准。
