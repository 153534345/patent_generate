标题title
一种基于模型级联的网络公害网站发现方法及系统
摘要abst
本发明公开了一种基于模型级联的网络公害网站发现方法及系统，属于网络安全领域，第一步，通过网站数据库来对待测网站进行初步判断，初步判断如有结果则输出网站类型，如无结果则进行下一步；第二步，进行特征对比，若满足特征对比则输出网站类型，不满足则进行下一步；第三步，进行关键点对比，若达到关键点数量则输出网站类型，未达到则进行下一步；第四步，进行分类对比，通过不同的网站特征表现，将无害网站归类为无效样本，然后进行下一步；第五步，进行同源对比，判断待测网站信息和注册域名是否一致，若一致则判断为公害网站，否则保持前面四步的判断结果；解决了现有技术对公害网站的识别准确率较低的技术问题。
权利要求书clms
1.一种基于模型级联的网络公害网站发现方法，其特征在于，第一步，通过网站数据库来对待测网站进行初步判断，初步判断如有结果则输出网站类型，如无结果则进行下一步；第二步，进行特征对比，若满足特征对比则输出网站类型，不满足则进行下一步；第三步，进行关键点对比，若达到关键点数量则输出网站类型，未达到则进行下一步；第四步，进行分类对比，通过不同的网站特征表现，将无害网站归类为无效样本，然后进行下一步；第五步，进行同源对比，判断待测网站信息和注册域名是否一致，如若一致则判断为公害网站，否则保持前面四步的判断结果；至此流程结束。2.根据权利要求1所述的一种基于模型级联的网络公害网站发现方法，其特征在于，所述网站数据库采集并记录公害网站的基本信息，包括：网站地址、网站IP、网站源码、网站图片、注册域名、网页结构hash、Whois 信息。3.根据权利要求1所述的一种基于模型级联的网络公害网站发现方法，其特征在于，所述特征对比步骤，首先对采集的公害网站的图片进行基于AutoEncoder算法的特征对比模型构建，并基于构建的模型进行公害网站图片的特征提取，然后将提取的特征存入特征数据库；通过特征对比模型对待识别网站的截图提取图片特征，并在特征数据库对提取的图片特征进行搜索对比，若满足预设阈值则输出结果，不满足则进行下一步。4.根据权利要求3所述的一种基于模型级联的网络公害网站发现方法，其特征在于，所述关键点对比步骤，首先通过已有的公害网站图片进行基于 SuperPoint 算法的关键点模型构建，并通过该关键点模型提取待识别网站的图片，和特征对比步骤中不满足预设阈值但和待识别网站的图片最相近的公害网站的图片，然后通过该关键点模型提取这两张图片的关键点特征和关键点数，如果该关键点数满足预设的关键点对比阈值，则该待识别网站和最相近的公害网站为同一类型，不满足则进行下一步。5.根据权利要求4所述的一种基于模型级联的网络公害网站发现方法，其特征在于，所述关键点对比步骤，使用了k-最近邻算法，将待识别网站的关键点特征和最相近的公害网站的关键点特征进行对比。6.根据权利要求1所述的一种基于模型级联的网络公害网站发现方法，其特征在于，所述分类对比步骤，首先构建基于 swin-transformerV2算法的多标签分类模型，从图片细粒度特征信息、文本特征信息和不同涉诈类型的网站特征表现形式来判断该待识别网站的涉诈类型，将无公害元素的网站判定为无效样本，将不满足分类模型的样本进行下一步判断。7.根据权利要求6所述的一种基于模型级联的网络公害网站发现方法，其特征在于，构建多标签分类模型之前，需要对已有的公害网站图片进行分析、人工标注以及多标签标注。8.根据权利要求1所述的一种基于模型级联的网络公害网站发现方法，其特征在于，所述同源对比步骤，将公害网站的关系数据构建同源分析模型，将待识别网站的关系数据和已有公害网站的关系数据进行关系规则匹配，用于判断关系数据是否一致，如果一致则说明待识别的网站和已有的公害网站为同样的公害类型。9.根据权利要求8所述的一种基于模型级联的网络公害网站发现方法，其特征在于，所述关系数据包括网站地址、网站注册域名、网站的跳转地址、网站 IP以及网站的网页结构hash。10.一种基于模型级联的网络公害网站发现系统，其特征在于，包括以下模块：数据库模块：采集公害网站相关的数据并存入数据库；获取待识别网站的信息，并于数据库中进行检索，如若存在则输出结果，如若不存在则进入特征对比模块；特征对比模块：对公害网站进行特征提取，建立特征数据库将提取的特征存入，提取待识别网站的特征，并在特征数据库进行搜索比对，若满足预设阈值则输出结果，不满足则进入关键点对比模块；关键点对比模块：在数据库中检索与待识别网站相似的网站，并一同与待识别网站进行关键点提取，然后进行关键点比对，若满足预设阈值则输出结果，如不满足则进入分类对比模块；分类对比模块：从图片细粒度特征信息、文本特征信息和不同涉诈类型的网站特征表现形式来判断该待识别网站的涉诈类型，并将无公害元素的网站判定为无效样本，并将不满足以上条件的待识别网站输出到同源对比模块；同源对比模块：将待识别网站的信息与已有公害网站的信息进行关系规则的匹配，判断待识别网站的网站hash、跳转地址、网站IP、注册域名和已有公害网站的网站hash、跳转地址、网站IP、注册域名是否一致，如若一致则输出为公害网站，不一致则判定为无效样本，流程结束。
说明书desc
技术领域本发明属于网络安全技术领域，具体涉及一种基于模型级联的网络公害网站发现方法及系统。背景技术随着互联网的快速发展和普及，人们越来越依赖于网络，从而带来了许多好处和便利。然而，与此同时，互联网也带来了一些负面影响，其中之一就是网络公害。网络公害是指通过互联网传播的各种有害信息和行为，对个人、社会和环境产生不利影响的现象。但是，现有的技术都是利用网络公害网站的一种或者两种特征进行识别，由于随着技术的升级和公害团伙的发展，该识别方式存在一定的片面性，不能更好的发现公害网站，导致对网络公害网站的识别结果的准确率比较低。发明内容针对现有技术中存在的识别准确率低问题，本发明提出了一种基于模型级联的网络公害网站发现方法，其目的为：提高对公害网站的识别率。第一步，通过网站数据库来对待测网站进行初步判断，初步判断如有结果则输出网站类型，如无结果则进行下一步；第二步，进行特征对比，若满足特征对比则输出网站类型，不满足则进行下一步；第三步，进行关键点对比，若达到关键点数量则输出网站类型，未达到则进行下一步；第四步，进行分类对比，通过不同的网站特征表现，将无害网站归类为无效样本，然后进行下一步；第五步，进行同源对比，判断待测网站信息和注册域名是否一致，如若一致则判断为公害网站，否则保持前面四步的判断结果；至此流程结束。较优的，网站数据库采集并记录公害网站的基本信息，包括：网站地址、网站 IP、网站源码、网站图片、注册域名、网页结构hash、Whois 信息。较优的，特征对比首先对采集的公害网站的图片进行基于AutoEncoder算法的特征对比模型构建，并基于构建的模型进行公害网站图片的特征提取，然后将提取的特征存入特征数据库；通过特征对比模型对待识别网站的截图提取图片特征，并在特征数据库对提取的图片特征进行搜索对比，若满足预设阈值则输出结果，不满足则进行下一步。较优的，关键点对比首先通过已有的公害网站图片进行基于 SuperPoint 算法的关键点模型构建，并通过该关键点模型提取待识别网站的图片，和特征对比步骤中不满足预设阈值但和待识别网站的图片最相近的公害网站的图片，然后通过该关键点模型提取这两张图片的关键点特征和关键点数，如果该关键点数满足预设的关键点对比阈值，则该待识别网站和最相近的公害网站为同一类型，不满足则进行下一步。较优的，关键点对比使用了k-最近邻算法，将待识别网站的关键点特征和最相近的公害网站的关键点特征进行对比。较优的，分类对比首先构建基于 swin-transformerV2算法的多标签分类模型，从图片细粒度特征信息、文本特征信息和不同涉诈类型的网站特征表现形式来判断该待识别网站的涉诈类型，将无公害元素的网站判定为无效样本，将不满足分类模型的样本进行下一步判断。较优的，构建多标签分类模型之前，需要对已有的公害网站图片进行分析、人工标注以及多标签标注。较优的，同源对比是将公害网站的关系数据构建同源分析模型，将待识别网站的关系数据和已有公害网站的关系数据进行关系规则匹配，用于判断关系数据是否一致，如果一致则说明待识别的网站和已有的公害网站为同样的公害类型。较优的，关系数据包括网站地址、网站注册域名、网站的跳转地址、网站 IP以及网站的网页结构 hash。较优的，采集公害网站的多维结构数据，包含网站基本信息、网站注册信息、公害类型、时序信息，然后构建网站数据库，该网站数据库可以记录公害网站的时序变化过程，提高对公害网站的研判能力和分析能力。较优的，基于AutoEncoder算法构建的特征对比模型，可以从公害网站图片的直观展示来提取公害网站的全局表示特征，然后通过该模型按照公害类型构建公害网站特征数据库，可以提高公害网站的识别结果准确度。较优的，基于 SuperPoint 算法构建的关键点模型，是从公害网站图片的关键点来提取公害网站的关键表示特征，并结合图片间的关键点特征相似性对比策略构成关键点比对模型，从关键特征的角度，识别各种公害网站的变体，提高了对新生或者变异后的公害网站的识别准确率。较优的，通过对公害网站的分析结合已有的公害类型，对具有相同特性或者特定公害类型的公害网站构建不同的分类模型，并将这些模型融合成一个分类模型组对公害网站进行补充识别，降低了对公害网站识别的误报率和漏报率。较优的，网站数据库会随着数据的更新，根据最终的识别结果进行构建对应的数据形式去补充给网站数据库，同时特征数据库也会根据识别结果不断的自动更新，自动添加涉诈网站的新样本特征。一种基于模型级联的网络公害网站发现系统，包括以下模块：数据库模块：采集公害网站相关的数据并存入数据库；获取待识别网站的信息，并于数据库中进行检索，如若存在则输出结果，如若不存在则进入特征对比模块；特征对比模块：对公害网站进行特征提取，建立特征数据库将提取的特征存入，提取待识别网站的特征，并在特征数据库进行搜索比对，若满足预设阈值则输出结果，不满足则进入关键点对比模块。关键点对比模块：在数据库中检索与待识别网站相似的网站，并一同与待识别网站进行关键点提取，然后进行关键点比对，若满足预设阈值则输出结果，如不满足则进入分类对比模块；分类对比模块：从图片细粒度特征信息、文本特征信息和不同涉诈类型的网站特征表现形式来判断该待识别网站的涉诈类型，并将无公害元素的网站判定为无效样本，并将不满足以上条件的待识别网站输出到同源对比模块；同源对比模块：将待识别网站的信息与已有公害网站的信息进行关系规则的匹配，判断待识别网站的网站hash、跳转地址、网站IP、注册域名和已有公害网站的网站hash、跳转地址、网站IP、注册域名是否一致，如若一致则输出为公害网站，不一致则判定为无效样本，流程结束。相比现有技术，本发明的技术方案具有如下优点/有益效果：1.从关键特征的角度，识别各种公害网站的变体，提高了对新生或者变异后的公害网站的识别准确率。2.构建分类模型组对公害网站进行补充识别，降低了对公害网站识别的误报率和漏报率。3.通过网站数据库的建立，提高了对网络公害网站的研判能力和分析能力。4. 基于AutoEncoder算法构建的特征对比模型，可以从公害网站图片的直观展示来提取公害网站的全局表示特征，然后通过该模型按照公害类型构建公害网站特征数据库，可以提高公害网站的识别结果准确度。5. 基于 SuperPoint 算法构建的关键点模型，是从公害网站图片的关键点来提取公害网站的关键表示特征，并结合图片间的关键点特征相似性对比策略构成关键点比对模型，从关键特征的角度，识别各种公害网站的变体，提高了对新生或者变异后的公害网站的识别准确率。附图说明为了更清楚地说明本发明实施方式的技术方案，下面将对实施方式中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1是一种基于模型级联的网络公害网站发现方法的结构示意图。图2是一种基于模型级联的网络公害网站发现系统的结构示意图。图3是本发明实施例所用的关系规则匹配图。具体实施方式为使本发明目的、技术方案和优点更加清楚，下面对本发明实施方式中的技术方案进行清楚、完整地描述，显然，所描述的实施方式是本发明的一部分实施方式，而不是全部的实施方式。基于本发明中的实施方式，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施方式，都属于本发明保护的范围。因此，以下提供的本发明的实施方式的详细描述并非旨在限制要求保护的本发明的范围，而是仅仅表示本发明的选定实施方式。应注意到：相似的标号和字母在下面的附图中表示类似项，因此，一旦某一项在一个附图中被定义，则在随后的附图中可以不对其进行进一步定义和解释。实施例1：如图1、图3所示，一种基于模型级联的网络公害网站发现方法，第一步，通过网站数据库来对待测网站进行初步判断，初步判断如有结果则输出网站类型，如无结果则进行下一步；第二步，进行特征对比，若满足特征对比则输出网站类型，不满足则进行下一步；第三步，进行关键点对比，若达到关键点数量则输出网站类型，未达到则进行下一步；第四步，进行分类对比，通过不同的网站特征表现，将无害网站归类为无效样本，然后进行下一步；第五步，进行同源对比，判断待测网站信息和注册域名是否一致，如若一致则判断为公害网站，否则保持前面四步的判断结果；至此流程结束。网站数据库采集并记录公害网站的基本信息，包括：网站地址、网站 IP、网站源码、网站图片、注册域名、网页结构hash、Whois 信息，对积累的网络公害网站数据进行整理和分类，并过滤清洗脏数据。特征对比步骤首先对网络公害网站数据中的公害网站截图和涉诈信息进行对齐，然后对采集的公害网站的图片进行基于AutoEncoder算法的特征对比模型构建，直到模型收敛、学习到公害网站的截图信息的特征分布；并基于构建的模型进行公害网站图片的特征提取，然后将提取的特征存入特征数据库；通过特征对比模型对待识别网站的截图提取图片特征，并在特征数据库对提取的图片特征进行搜索对比，若满足预设阈值则输出结果，不满足则进行下一步。关键点对比步骤首先对对网络公害网站数据中的公害网站截图和涉诈信息进行对齐，然后对通过已有的公害网站图片进行基于 SuperPoint 算法的关键点模型构建直到模型收敛，并通过该关键点模型提取待识别网站的图片，和特征对比步骤中不满足预设阈值但和待识别网站的图片最相近的公害网站的图片，然后通过该关键点模型提取这两张图片的关键点特征和关键点数，如果该关键点数满足预设的关键点对比阈值，则该待识别网站和最相近的公害网站为同一类型，不满足则进行下一步。关键点对比使用了k-最近邻算法，将待识别网站的关键点特征和最相近的公害网站的关键点特征进行对比。分类对比首先构建基于 swin-transformerV2算法的多标签分类模型，从图片细粒度特征信息、文本特征信息和不同涉诈类型的网站特征表现形式来判断该待识别网站的涉诈类型，将无公害元素的网站判定为无效样本，将不满足分类模型的样本进行下一步判断。构建多标签分类模型之前，需要对已有的公害网站图片进行分析、人工标注以及多标签标注。如图3所示，同源对比是将公害网站的关系数据构建同源分析模型，将待识别网站的关系数据和已有公害网站的关系数据进行关系规则匹配，通过待识别网站的统一资源标识符URI，获得待识别网站的网站IP、跳转地址、page-hash、注册域名，并判断待识别网站和已有的公害网站的网站IP、跳转地址、page-hash、注册域名是否一致，如果一致则说明待识别的网站和已有的公害网站是同源的为一样的公害类型。关系数据包括网站地址、网站注册域名、网站的跳转地址、网站 IP以及网站的网页结构hash。通过采集公害网站的多维结构数据，包含网站基本信息、网站注册信息、公害类型、时序信息构建网站数据库，该网站数据库可以记录公害网站的时序变化过程，提高对公害网站的研判能力和分析能力。基于AutoEncoder算法构建的特征对比模型，可以从公害网站图片的直观展示来提取公害网站的全局表示特征，然后通过该模型按照公害类型构建公害网站图片特征库，可以提高公害网站的识别结果准确度。基于 SuperPoint 算法构建的关键点模型，是从公害网站图片的关键点来提取公害网站的关键表示特征，并结合图片间的关键点特征相似性对比策略构成关键点比对模型，从关键特征的角度，识别各种公害网站的变体，提高了对新生或者变异后的公害网站的识别准确率。通过对公害网站的分析结合其已有的公害类型，对具有相同特性或者特定的公害类型的公害网站构建不同的分类模型，并将这些模型融合成一个分类模型组对公害网站进行补充识别，降低了对公害网站识别的误报率和漏报率。网站数据库会随着数据的更新，根据最终的识别结果进行构建对应的数据形式去补充给网站数据库，同时特征数据库也会根据识别结果不断的自动更新，自动添加涉诈网站的新样本特征。本发明可以通过模型级联的方式，从文本、图像、关联关系去判别公害网站。本发明通过对公害网站的关系数据进行分析和构建同源分析模型，从公害网站的关联数据信息和公害网站间的关联关系来判定该网站是否是公害网站，也可以从多维数据的和关联关系的角度去综合判定是否是公害网站。本发明所用AutoEncoder算法是一种无监督式学习模型。它基于反向传播算法，利用输入数据本身作为监督，来指导神经网络尝试学习一个映射关系，从而得到一个重构输出。算法模型包含两个主要的部分：Encoder和Decoder。本发明所用SuperPoint 算法是一种基于深度学习的自监督特征点检测算法。本发明所用swin-transformerV2算法，为swin-transformerV1算法的改进版本，解决了原有模型不够大的问题和模型不适配的问题。本发明使用的k-最近邻算法工作过程如下：1. 计算待分类样本与训练集中所有样本之间的距离，常用的距离度量方法包括欧氏距离、曼哈顿距离等。2. 选择K个距离最近的样本，即K个最近邻。3. 对于分类问题，统计K个最近邻中不同类别的样本数量，并将待分类样本归为数量最多的那个类别。实施例2：如图2所示，一种基于模型级联的网络公害网站发现系统，包括以下模块：数据库模块：采集公害网站相关的数据并存入数据库；获取待识别网站的信息，并于数据库中进行检索，如若存在则输出结果，如若不存在则进入特征对比模块；特征对比模块：对公害网站进行特征提取，建立特征数据库将提取的特征存入，提取待识别网站的特征，并在特征数据库进行搜索比对，如若满足预设阈值则输出结果，如若不满足则进入关键点对比模块。关键点对比模块：在数据库中检索与待识别网站相似的网站，并一同与待识别网站进行关键点提取，然后进行关键点比对，若满足预设阈值则输出结果，如不满足则进入分类对比模块；分类对比模块：从图片细粒度特征信息、文本特征信息和不同涉诈类型的网站特征表现形式来判断该待识别网站的涉诈类型，并将无公害元素的网站判定为无效样本，并将不满足以上条件的输出到同源对比模块；同源对比模块：将待识别网站的信息与已有公害网站的信息进行关系规则的匹配，判断待识别网站的网站hash、跳转地址、网站IP、注册域名和已有公害网站的网站hash、跳转地址、网站IP、注册域名是否一致，如若一致则输出为公害网站，不一致则判定为无效样本，流程结束。以上仅是本发明的优选实施方式，应当指出的是，上述优选实施方式不应视为对本发明的限制，本发明的保护范围应当以权利要求所限定的范围为准。对于本技术领域的普通技术人员来说，在不脱离本发明的精神和范围内，还可以做出若干改进和润饰，这些改进和润饰也应视为本发明的保护范围。
