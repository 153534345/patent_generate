标题title
回声消除方法、装置、电子设备及存储介质
摘要abst
本申请公开了一种回声消除方法、装置、电子设备及存储介质。本发明实施例可应用于各种场景，包括但不限于云技术、人工智能、智慧交通、辅助驾驶等。该方法包括：分别对近端语音信号以及近端语音信号对应的远端语音信号进行移频处理以及下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号；根据目标远端复信号以及目标近端复信号，确定近端语音信号与远端语音信号之间的互相关函数；根据互相关函数，确定回声信号的回声延迟；基于回声信号的回声延迟，对近端语音信号进行回声消除。通过本申请的方法，实现了近端语音信号的回声消除。
权利要求书clms
1.一种回声消除方法，其特征在于，所述方法包括：分别对近端语音信号以及所述近端语音信号对应的远端语音信号进行移频处理，得到所述远端语音信号对应的远端复信号以及所述近端语音信号对应的近端复信号，所述近端语音信号中叠加了因播放所对应的所述远端语音信号产生的回声信号；分别对所述远端复信号以及所述近端复信号进行下采样处理，得到所述远端语音信号对应的目标远端复信号以及所述近端语音信号对应的目标近端复信号；根据所述目标远端复信号以及所述目标近端复信号，确定所述近端语音信号与所述远端语音信号之间的互相关函数；根据所述互相关函数，确定所述回声信号的回声延迟；基于所述回声信号的回声延迟，对所述近端语音信号进行回声消除。2.根据权利要求1所述的方法，其特征在于，所述根据所述目标远端复信号以及所述目标近端复信号，确定所述近端语音信号与所述远端语音信号之间的互相关函数，包括：对所述目标远端复信号进行变换，得到所述目标远端复信号对应的远端频谱；对所述目标近端复信号进行变换，得到所述目标近端复信号对应的近端频谱；根据所述远端频谱和所述近端频谱，确定所述近端语音信号与所述远端语音信号之间的互相关函数。3.根据权利要求2所述的方法，其特征在于，所述近端语音信号为实时采集的近端语音信号序列中的一个近端语音信号片段；所述对所述目标远端复信号进行变换，得到所述目标远端复信号对应的远端频谱，包括：响应于与所述近端语音信号的结束时间的延迟时长达到第一时长，对所述目标远端复信号进行变换，得到所述目标远端复信号对应的远端频谱；所述对所述目标近端复信号进行变换，得到所述目标近端复信号对应的近端频谱，包括：响应于与所述结束时间的延迟时长达到第二时长，对所述目标近端复信号进行变换，得到所述目标近端复信号对应的近端频谱；所述第二时长大于所述第一时长；所述根据所述远端频谱和所述近端频谱，确定所述近端语音信号与所述远端语音信号之间的互相关函数，包括：响应于与所述结束时间的延迟时长达到第三时长，根据所述远端频谱和所述近端频谱，确定所述近端语音信号与所述远端语音信号之间的互相关函数；所述第三时长大于所述第二时长；所述根据所述互相关函数，确定所述回声信号的回声延迟，包括：响应于与所述结束时间的延迟时长达到第四时长，根据所述互相关函数，确定所述回声信号的回声延迟；所述第四时长大于所述第三时长。4.根据权利要求3所述的方法，其特征在于，所述近端语音信号包括至少一个近端语音帧；所述第二时长与所述第一时长的时间差、所述第三时长与所述第二时长的时间差、以及所述第四时长与所述第三时长的时间差相等，所述时间差等于预设采集时长的N倍，N为正整数，所述预设采集时长为采集获得的每个近端语音帧的时长。5.根据权利要求1所述的方法，其特征在于，所述近端语音信号包括连续的K个近端语音帧，K为大于1的正整数。6.根据权利要求1所述的方法，其特征在于，所述分别对所述远端复信号以及所述近端复信号进行下采样处理，得到所述远端语音信号对应的目标远端复信号以及所述近端语音信号对应的目标近端复信号，包括：分别对所述远端复信号以及所述近端复信号进行多次下采样处理，得到所述远端语音信号对应的目标远端复信号以及所述近端语音信号对应的目标近端复信号。7.根据权利要求6所述的方法，其特征在于，关注频带位于所述目标远端复信号的频带和所述目标近端复信号的频带中；所述分别对所述远端复信号以及所述近端复信号进行多次下采样处理，得到所述远端语音信号对应的目标远端复信号以及所述近端语音信号对应的目标近端复信号，包括：分别对所述远端复信号以及所述近端复信号进行第一倍数的下采样，得到所述远端语音信号对应的中间远端复信号以及所述近端语音信号对应的中间近端复信号；分别对所述中间远端复信号以及所述中间近端复信号进行第二倍数的下采样，得到所述远端语音信号对应的目标远端复信号以及所述近端语音信号对应的目标近端复信号；其中，所述第一倍数高于所述第二倍数；所述第一倍数与所述第二倍数的乘积等于目标倍数，所述目标倍数等于所述近端复信号的最高频率与所述关注频带的上限频率的比值。8.根据权利要求7所述的方法，其特征在于，所述分别对所述远端复信号以及所述近端复信号进行第一倍数的下采样，得到所述远端语音信号对应的中间远端复信号以及所述近端语音信号对应的中间近端复信号，包括：基于所述关注频带的上限频率、所述第一倍数以及所述近端复信号的最高频率，确定对应所述第一倍数的抗混叠滤波器的过渡带；所述过渡带的下限频率等于所述关注频带的上限频率，所述过渡带的上限频率不小于参考频率的一半，所述参考频率等于所述近端复信号的最高频率与所述第一倍数的商；基于所述过渡带，通过所述抗混叠滤波器分别对所述远端复信号以及所述近端复信号进行滤波，得到所述远端复信号对应的参考中间远端复信号以及所述近端复信号对应的参考中间近端复信号；其中，所述远端复信号以及所述近端复信号中位于所述过渡带中的信号在滤波后被衰减；按照所述第一倍数对应的采样间隔分别对所述参考中间远端复信号以和所述参考中间近端复信号进行抽取，得到所述远端语音信号对应的中间远端复信号以及所述近端语音信号对应的中间近端复信号。9.根据权利要求2所述的方法，其特征在于，所述根据所述远端频谱和所述近端频谱，确定所述近端语音信号与所述远端语音信号之间的互相关函数，包括：根据所述远端频谱以及所述近端频谱，确定互功率谱以及权重；基于所述权重对所述互功率谱进行加权，得到加权互功率频谱；对所述加权互功率频谱进行逆傅里叶变换处理，得到所述近端语音信号与所述远端语音信号之间的互相关函数。10.根据权利要求1-9任一项所述的方法，其特征在于，所基于所述回声信号的回声延迟，对所述近端语音信号进行回声消除，包括：根据所述回声信号的回声延迟对所述远端语音信号进行延迟处理，得到延迟远端语音信号；根据所述延迟远端语音信号，对所述近端语音信号进行回声消除处理。11.根据权利要求1-9中任一项所述的方法，其特征在于，所述分别对近端语音信号以及所述近端语音信号对应的远端语音信号进行移频处理，得到所述远端语音信号对应的远端复信号以及所述近端语音信号对应的近端复信号，包括：根据所述近端语音信号的语音场景，确定目标移频量；分别对所述远端语音信号以及所述近端语音信号进行目标移频量的移频处理，得到所述远端语音信号对应的远端复信号以及所述近端语音信号对应的近端复信号。12.一种回声消除装置，其特征在于，所述装置包括：移频模块，用于分别对近端语音信号以及所述近端语音信号对应的远端语音信号进行移频处理，得到所述远端语音信号对应的远端复信号以及所述近端语音信号对应的近端复信号，所述近端语音信号中叠加了因播放所对应的所述远端语音信号产生的回声信号；采样模块，用于分别对所述远端复信号以及所述近端复信号进行下采样处理，得到所述远端语音信号对应的目标远端复信号以及所述近端语音信号对应的目标近端复信号；函数确定模块，用于根据所述目标远端复信号以及所述目标近端复信号，确定所述近端语音信号与所述远端语音信号之间的互相关函数；延迟确定模块，用于根据所述互相关函数，确定所述回声信号的回声延迟；消除模块，用于基于所述回声信号的回声延迟，对所述近端语音信号进行回声消除。13.一种电子设备，其特征在于，包括：处理器；存储器，所述存储器上存储有计算机可读指令，所述计算机可读指令被所述处理器执行时，实现如权利要求1-11中任一项所述的方法。14.一种计算机可读取存储介质，其特征在于，其上存储有计算机可读指令，当所述计算机可读指令被处理器执行时，实现如权利要求1-11中任一项所述的方法。
说明书desc
技术领域本申请涉及电子信息技术领域，更具体地，涉及一种回声消除方法、装置、电子设备及存储介质。背景技术在语音通话中，回声是指通话对端发送到终端的远端语音信号由终端的扬声器播放后，被麦克风采集再传回通话对端的现象。其中，远端语音信号播放过程中被麦克风所采集到的信号称为回声信号，麦克风采集到的近端语音信号中除了包含回声信号之外，还包含本地产生的声音信号。因此，亟需有一种手段来消除近端语音信号中的回声信号。发明内容有鉴于此，本申请实施例提出了一种回声消除方法、装置、电子设备及存储介质。第一方面，本申请实施例提供了一种回声消除方法，方法包括：分别对近端语音信号以及近端语音信号对应的远端语音信号进行移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号，近端语音信号中叠加了因播放所对应的远端语音信号产生的回声信号；分别对远端复信号以及近端复信号进行下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号；根据目标远端复信号以及目标近端复信号，确定近端语音信号与远端语音信号之间的互相关函数；根据互相关函数，确定回声信号的回声延迟；基于回声信号的回声延迟，对近端语音信号进行回声消除。第二方面，本申请实施例提供了一种回声消除装置，装置包括：移频模块，用于分别对近端语音信号以及近端语音信号对应的远端语音信号进行移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号，近端语音信号中叠加了因播放所对应的远端语音信号产生的回声信号；采样模块，用于分别对远端复信号以及近端复信号进行下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号；函数确定模块，用于根据目标远端复信号以及目标近端复信号，确定近端语音信号与远端语音信号之间的互相关函数；延迟确定模块，用于根据互相关函数，确定回声信号的回声延迟；消除模块，用于基于回声信号的回声延迟，对近端语音信号进行回声消除。可选地，函数确定模块，还用于对目标远端复信号进行变换，得到目标远端复信号对应的远端频谱；对目标近端复信号进行变换，得到目标近端复信号对应的近端频谱；根据远端频谱和近端频谱，确定近端语音信号与远端语音信号之间的互相关函数。可选地，近端语音信号为实时采集的近端语音信号序列中的一个近端语音信号片段；可选地，函数确定模块，还用于响应于与近端语音信号的结束时间的延迟时长达到第一时长，对目标远端复信号进行变换，得到目标远端复信号对应的远端频谱；响应于与结束时间的延迟时长达到第二时长，对目标近端复信号进行变换，得到目标近端复信号对应的近端频谱；第二时长大于第一时长；响应于与结束时间的延迟时长达到第三时长，根据远端频谱和近端频谱，确定近端语音信号与远端语音信号之间的互相关函数；第三时长大于第二时长；相应的，延迟确定模块，还用于响应于与结束时间的延迟时长达到第四时长，根据互相关函数，确定回声信号的回声延迟；第四时长大于第三时长。可选地，采样模块，还用于分别对远端复信号以及近端复信号进行多次下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号。可选地，关注频带位于目标远端复信号的频带和目标近端复信号的频带中；采样模块，还用于分别对远端复信号以及近端复信号进行第一倍数的下采样，得到远端语音信号对应的中间远端复信号以及近端语音信号对应的中间近端复信号；分别对中间远端复信号以及中间近端复信号进行第二倍数的下采样，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号；其中，第一倍数高于第二倍数；第一倍数与第二倍数的乘积等于目标倍数，目标倍数等于近端复信号的最高频率与关注频带的上限频率的比值。可选地，采样模块，还用于基于关注频带的上限频率、第一倍数以及近端复信号的最高频率，确定对应第一倍数的抗混叠滤波器的过渡带；过渡带的下限频率等于关注频带的上限频率，过渡带的上限频率不小于参考频率的一半，参考频率等于近端复信号的最高频率与第一倍数的商；基于过渡带，通过抗混叠滤波器分别对远端复信号以及近端复信号进行滤波，得到远端复信号对应的参考中间远端复信号以及近端复信号对应的参考中间近端复信号；其中，远端复信号以及近端复信号中位于过渡带中的信号在滤波后被衰减；按照第一倍数对应的采样间隔分别对参考中间远端复信号以和参考中间近端复信号进行抽取，得到远端语音信号对应的中间远端复信号以及近端语音信号对应的中间近端复信号。可选地，函数确定模块，还用于根据远端频谱以及近端频谱，确定互功率谱以及权重；基于权重对互功率谱进行加权，得到加权互功率频谱；对加权互功率频谱进行逆傅里叶变换处理，得到近端语音信号与远端语音信号之间的互相关函数。可选地，消除模块，还用于根据回声信号的回声延迟对远端语音信号进行延迟处理，得到延迟远端语音信号；根据延迟远端语音信号，对近端语音信号进行回声消除处理。可选地，移频模块，还用于根据近端语音信号的语音场景，确定目标移频量；分别对远端语音信号以及近端语音信号进行目标移频量的移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号。第三方面，本申请实施例提供了一种电子设备，包括处理器以及存储器；存储器上存储有计算机可读指令，计算机可读指令被处理器执行时，实现上述的方法。第四方面，本申请实施例提供了一种计算机可读存储介质，其上存储有计算机可读指令，当计算机可读指令被处理器执行时，实现上述的方法。第五方面，本申请实施例提供了一种计算机程序产品或计算机程序，包括计算机指令，计算机指令被处理器执行时实现上述的方法。本申请实施例提供的一种回声消除方法、装置、电子设备及存储介质，在本申请中，首先分别对近端语音信号以及近端语音信号对应的远端语音信号进行移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号，然后分别对远端复信号以及近端复信号进行下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号，并通过目标远端复信号以及目标近端复信号，确定近端语音信号与远端语音信号之间的互相关函数，之后，根据基于互相干函数确定的回声延迟近端语音信号进行回声消除，实现了近端语音信号的回声消除。同时，通过移频处理将实信号的近端语音信号以及远端语音信号转换为复信号，近端复信号和远端复信号是分别利用近端语音信号以及远端语音信号的所有频带得到，保证近端复信号和远端复信号所携带信息的完整性，而且，通过将实信号的近端语音信号和远端语音信号转换到复数域，相对而言，远端复信号和近端复信号的带宽更小，减少了所要处理信号的带宽，减少了数据处理量。其后，对近端复信号和远端复信号进行下采样，并基于下采样之后的信号确定近端语音信号与远端语音信号之间的互相关函数，这样，可以进一步减少数据处理量。而且，基于人声特性的影响，低频带的信息是无效且甚至有害的，通过将实信号变换为复信号，而且进行下采样，可以减少低频带的影响，保证了确定的互相关函数的准确性，提高了回声消除的效果，由于减少了数据处理量，从而提高了回声消除的效率。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1示出了适用于本申请实施例所适用的应用场景的示意图；图2示出了本申请一个实施例提出的一种回声消除方法的流程图；图3示出了本申请实施例中一种回声信号的冲激响应的示意图；图4示出了本申请实施例中一种抗混叠滤波器的滤波原理的示意图；图5示出了本申请实施例中一种滤波以及下采样原理的示意图；图6示出了本申请实施例中一种回声延迟的确定过程的示意图；图7示出了本申请实施例中一种回声消除过程的示意图；图8示出了图2对应的实施例中步骤S103以及S104在一实施例中的流程图；图9示出了本申请实施例中又一种回声消除过程的示意图；图10示出了本申请一个实施例提出的一种回声消除装置的框图；图11示出了用于执行根据本申请实施例的回声消除方法的电子设备的结构框图。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。根据本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。在以下的描述中，所涉及的术语“第一第二”仅仅是是区别类似的对象，不代表针对对象的特定排序，可以理解地，“第一第二”在允许的情况下可以互换特定的顺序或先后次序，以使这里描述的本申请实施例能够以除了在这里图示或描述的以外的顺序实施。除非另有定义，本文所使用的所有的技术和科学术语与属于本申请的技术领域的技术人员通常理解的含义相同。本文中所使用的术语只是为了描述本申请实施例的目的，不是旨在限制本申请。需要说明的是：在本文中提及的“多个”是指两个或两个以上。“和/或”描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。字符“/”一般表示前后关联对象是一种“或”的关系。本申请公开了一种回声消除方法、装置、电子设备及存储介质，涉及智能交通系统以及车联网技术。智能交通系统又称智能运输系统，是将先进的科学技术有效地综合运用于交通运输、服务控制和车辆制造，加强车辆、道路、使用者三者之间的联系，从而形成一种保障安全、提高效率、改善环境、节约能源的综合运输系统。智能车路协同系统，简称车路协同系统，是智能交通系统的一个发展方向。车路协同系统是采用先进的无线通信和新一代互联网等技术，全方位实施车车、车路动态实时信息交互，并在全时空动态交通信息采集与融合的基础上开展车辆主动安全控制和道路协同管理，充分实现人车路的有效协同，保证交通安全，提高通行效率，从而形成的安全、高效和环保的道路交通系统。如图1所示，本申请实施例所适用的应用场景包括第一终端20和第二终端10，第一终端20和第二终端10通过有线网络或者无线网络通信连接。第一终端20和第二终端10可以是智能手机、平板电脑、笔记本电脑、台式电脑、智能家电、车载、飞行器、可穿戴设、虚拟现实设备以及其他可以进行语音交互的设备。其中，第一终端20可以采集远端语音信号，然后第一终端20向第二终端10发送远端语音信号，并由第二终端10播放远端语音信号，第二终端10可以在播放远端语音信号的同时采集近端语音信号，然后第二终端10根据远端语音信号以及近端语音信号对近端语音信号中叠加的回声信号进行回声消除，得到消除回声信号后的目标近端语音信号，然后第二终端10可以将干净近端语音信号发送给第一终端20。可以理解的是，第二终端10可以采集远端语音信号，然后第二终端10向第一终端20发送远端语音信号，并由第一终端20播放远端语音信号，第一终端20可以在播放远端语音信号的同时采集近端语音信号，然后第一终端20根据远端语音信号以及近端语音信号对近端语音信号中叠加的回声信号进行回声消除，得到消除回声信号后的干净近端语音信号，然后第一终端20可以将干净近端语音信号发送给第二终端10。为了方便表述，下述各个实施例中，以回声消除方法由电子设备执行为例进行说明。请参阅图2，图2示出了本申请一个实施例提出的一种回声消除方法的流程图，方法可以用于电子设备，电子设备可以是图1中的第二终端10或第一终端20，方法可以包括：S101、分别对近端语音信号以及近端语音信号对应的远端语音信号进行移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号。其中，近端语音信号中叠加了因播放所对应的远端语音信号产生的回声信号。远端语音信号可以是指电子设备需要播放的语音信号，近端语音信号可以是指电子设备播放远端语音信号的过程中，电子设备采集到的语音信号。例如，在语音通话过程中，语音通话的双方分别作为远端和近端，远端采集到的语音信号作为远端语音信号，在近端采集到的语音信号作为近端语音信号。又如，电子设备播放存储的演讲音频时，该演讲音频的音频信号可以作为远端语音信号，电子设备演讲音频时采集的使用者的语音信号作为近端语音信号。在电子设备播放的远端语音信号时，远端语音信号在电子设备所在环境中传播从而产生了回声信号，电子设备采集语音信号时也采集到了该回声信号，从而使得电子设备采集到的近端语音信号中还叠加了因播放所对应的远端语音信号产生的回声信号。忽略电子设备中的麦克风以及操作系统对远端语音信号的非线性影响，将回声信号建模为远端语音信号与有限长的冲激响应的线性卷积，也即，因播放远端语音信号所产生的回声信号可以表示为：，/＞表示远端语音信号，/＞表示冲激响应。冲激响应与时间关系如图3所示，该冲激响应的前半段的全零部分来自电子系统的操作系统的延迟，后半段的非零部分是由于电子设备中扬声器和麦克风的硬件特性，以及所在环境的混响特性而产生，显然，冲激响应中的前半段全零部分是冗余的，在本申请中所估计的回声信号的回声延迟即为冲激响应/＞中前半段全零部分的时长。在一些实施方式中，远端语音信号可以是按照预设采样率对原始远端语音信号进行采样得到的，近端语音信号可以是按照预设采样率对原始近端语音信号进行采样得到的；其中，预设采样率可以是基于需求设定的，例如16Khz。例如，在语音通话过程中，语音通话的双方分别作为远端和近端，远端采集到的语音信号作为原始远端语音信号，远端按照预设采样率对原始远端语音信号进行采样，得到远端语音信号，近端采集到的语音信号作为原始近端语音信号，近端按照预设采样率对原始近端语音信号进行采样，得到近端语音信号。在得到近端语音信号以及远端语音信号之后，可以对近端语音信号进行移频处理，得到近端语音信号对应的近端复信号，同时，远端语音信号进行移频处理，得到远端语音信号对应的远端复信号，以将近端语音信号以及远端语音信号中的高频信号转移至低频区域。由于人声特性以及低频底噪的影响，低频带的信息是无效甚至有害的，因此，为了能够充分利用所有频带的信息，需要对近端语音信号以及远端语音信号进行移频处理，以使得近端语音信号以及远端语音信号中的高频信号转移至中低频区域，以将高频信号的信息转移至低频带区域，以降低低频带的影响，使得移频后的远端复信号和近端复信号可以包括高频带的信息。本实施例中，可以通过震荡信号对近端语音信号以及远端语音信号进行调制，实现对近端语音信号以及远端语音信号的移频处理，得到移频后的近端复信号以及远端复信号。其中，震荡信号可以是指，/＞是指移频处理时的移频量。为了叙述简洁，这里用离散时间傅里叶变换来解释移频操作：移频处理前的信号为，其离散时间傅里叶变换为/＞，那么移频性质可以表示为，左边为时域的表示，右边为频域的表示。也即，移频处理相当于在时域上通过震荡信号/＞对时域信号进行调制。可选地，S101可以包括：根据近端语音信号的语音场景，确定目标移频量；分别对远端语音信号以及近端语音信号进行目标移频量的移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号。语音场景可以是指近端语音信号所处的场景，例如，语音场景可以是仅语音通话场景、视频通话场景、会议场景以及音频录制场景，其中，音频录制场景可以是指播放远端语音信号的同时，需要录制语音信号的场景。不同的语音场景的目标移频量可能不同，用户可以基于需求设定对应的目标移频量，本身不做限定。具体的，可以根据目标移频量，确定目标震荡信号/＞，然后通过目标震荡信号分别对近端语音信号以及远端语音信号进行调制，实现对近端语音信号以及远端语音信号的移频处理，得到移频后的近端复信号以及远端复信号。S102、分别对远端复信号以及近端复信号进行下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号。可以对远端复信号进行下采样，以降低数据量，得到目标近端复信号，同时，对近端复信号进行下采样，以降低数据量，得到目标近端复信号。其中，下采样的倍数作为目标倍数，可以将近端复信号的最高频率与关注频带的上限频率的比值作为下采样的目标倍数。其中，关注频带可以是基于需求设定的，例如，近端复信号的最高频率为8Khz，关注频带为-500hz~500hz，则目标倍数为16倍。通过实验发现，若最终采样到的信号的最高频率为1kHz的情况下，回声信号的最大回声延迟为512ms，因此，在本申请的方案中，针对近端语音信号和与远端语音信号，若想要覆盖512ms的延迟，下采样过程中的时间窗的长度至少为512ms，而考虑到互相关函数在语音帧边缘的不稳定性，因此，可以将加宽下采样的时间窗，以减少因语音帧的边缘的不稳定性对延迟估计的影响，例如，可以设定下采样的时间窗为1024ms。当然，在其他实施例中，最终所确定的下采样的时间窗还可以确定为其他大于512ms的时间窗，例如1.2倍512ms、1.5倍512ms、1.8倍512ms、2.2倍512ms、2.5倍512ms等等。值得一提的是，下采样的时间窗越大，则覆盖的信号的长度越长，后续需要进行处理的数据量越多，因此，实际中，需要在减少因语音帧的边缘的不稳定性对延迟估计的影响，以及减少处理的数据量之间进行折中。在一些实施方式中，S102可以包括：基于关注频带的上限频率、目标倍数以及近端复信号的最高频率，确定对应目标倍数的目标抗混叠滤波器的过渡带；目标抗混叠滤波器的过渡带的下限频率等于关注频带的上限频率，目标抗混叠滤波器的过渡带的上限频率不小于第一参考频率的一半，第一参考频率等于近端复信号的最高频率与目标倍数的商；基于目标抗混叠滤波器的过渡带，通过目标抗混叠滤波器分别对远端复信号以及近端复信号进行滤波，得到远端复信号对应的第一参考中间远端复信号以及近端复信号对应的第一参考中间近端复信号，其中，远端复信号以及近端复信号中位于目标抗混叠滤波器的过渡带中的信号在滤波后被衰减；按照目标倍数对应的采样间隔分别对第一参考中间远端复信号以和第一参考中间近端复信号进行抽取，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号。其中，目标抗混叠滤波器可以为低通滤波器，从而通过目标抗混叠滤波器分别对远端复信号以及近端复信号进行滤波处理，以滤除高频部分，避免下采样过程中发生混叠，然后，以采样间隔进行抽取，得到目标远端复信号以及目标近端复信号。采样间隔等于采样频率的倒数，对应于目标倍数的采样间隔等于目标采样频率的倒数，目标采样频率为近端复信号的最高频率与目标倍数的商。近端复信号的最高频率即为采样获得近端语音信号的采样频率。目标抗混叠滤波器的滤波原理如图4所示，横坐标为待滤波的信号的频率；纵坐标为插入损耗，指示目标抗混叠滤波器对信号的损耗程度，单位为dB表示；通带是指目标抗混叠滤波器允许通过的频率范围，阻带是指目标抗混叠滤波器不允许通过的频率范围，过渡带是指通带与阻带之间的频率范围。根据关注频带的上限频率以及第一参考频率确定目标抗混叠滤波器的过渡带之后，基于目标抗混叠滤波器的过渡带，通过目标抗混叠滤波器分别对远端复信号以及近端复信号进行滤波，以滤除目标抗混叠滤波器的阻带以及衰减过渡带中的信号，得到滤波后的远端复信号作为第一参考中间远端复信号以及滤波后的近端复信号作为第一参考中间近端复信号，然后，在第一参考中间远端复信号中每M个信号点采样一个信号点构建信号，实现对第一参考中间远端复信号进行抽取，得到远端语音信号对应的目标远端复信号，同理，在第一参考中间近端复信号中每M个信号点采样一个信号点构建信号，实现对第一参考中间近端复信号进行抽取，得到近端语音信号对应的目标近端复信号。本实施例中，前述下采样过程的采样原理如图5所示，输入目标抗混叠滤波器的信号为，目标抗混叠滤波器输出的信号为/＞，两者满足的关系为：其中，为目标抗混叠滤波器的系数，/＞为目标抗混叠滤波器的长度。然后，对目标抗混叠滤波器的输出进行M倍抽取，得到下采样后的/＞，两者满足的关系为：其中，M为目标倍数，表示每M点取1点作为输出。通过前述的移频处理将高频信号移动至低频区域，使得高频信号携带的信息转移至低频区域，然后再对移频后的远端复信号以及近端复信号进行下采样处理，得到目标远端复信号以及目标近端复信号，通过移频处理，使得下采样后的目标远端复信号以及目标近端复信号包括高频信号所携带的信息，实现了有效的保留高频信号所携带的信息的目的。在一些实施方式中，S102还可以包括分别对远端复信号以及近端复信号进行多次下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号。其中，多次下采样处理每次下采样处理的单次下采样倍数的乘积为前述目标倍数，也即，将下采样处理划分为多个下采样过程。在多次下采样处理时，每次下采样均先通过抗混叠滤波器进行滤波，然后对滤波后的信号进行每个Q点数据抽取1点数据构建信号，以实现Q倍下采样。每次下采样的倍数可以不同，也即，针对不同的下采样过程，选取的Q值可能不同。例如，下采样次数为3，第一次下采样的Q为2，第二次下采样的Q为2，第三次下采样的Q为2，也即，通过3次下采样实现了8倍下采样。其中，每次滤波处理的抗混叠滤波器的过渡带的下限频率等于关注频带的上限频率，每次滤波处理的抗混叠滤波器的过渡带的上限频率不小于对应的参考频率的一半，每次滤波处理对应的参考频率等于该次滤波前的信号的最高频率与该次下采样的倍数的比值。相较于一次下采样过程，多次下采样过程中每次下采样过程所使用的抗混叠滤波器可以设置较宽的过渡带，从而降低抗混叠滤波器的数据处理量，提高了抗混叠滤波器的滤波效率，从而大大提高了下整个下采样过程的采样效率。可选地，可以分别对远端复信号以及近端复信号进行第一倍数的下采样，得到远端语音信号对应的中间远端复信号以及近端语音信号对应的中间近端复信号；然后，分别对中间远端复信号以及中间近端复信号进行第二倍数的下采样，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号；其中，第一倍数高于第二倍数；第一倍数与第二倍数的乘积等于目标倍数，目标倍数等于近端复信号的最高频率与关注频带的上限频率的比值。也就是说，分别对滤波远端复信号以及滤波近端复信号进行高倍数的下采样，得到中间远端复信号以及中间近端复信号，然后再进行低倍数的下采样，得到目标远端复信号以及目标近端复信号。例如，远端复信号以及目标远端复信号之间的下采样倍数为16倍时，第一倍数可以是8倍，第二倍数可以是2倍。可以理解的是，为了避免下采样过程中出现混叠，在分别对远端复信号以及近端复信号进行第一倍数的下采样，得到远端语音信号对应的中间远端复信号以及近端语音信号对应的中间近端复信号，包括：基于关注频带的上限频率、第一倍数以及近端复信号的最高频率，确定对应第一倍数的抗混叠滤波器的过渡带；过渡带的下限频率等于关注频带的上限频率，过渡带的上限频率不小于参考频率的一半，参考频率等于近端复信号的最高频率与第一倍数的商；基于过渡带，通过抗混叠滤波器分别对远端复信号以及近端复信号进行滤波，得到远端复信号对应的参考中间远端复信号以及近端复信号对应的参考中间近端复信号，其中，远端复信号以及近端复信号中位于过渡带中的信号在滤波后被衰减；按照第一倍数对应的采样间隔分别对参考中间远端复信号以和参考中间近端复信号进行抽取，得到远端语音信号对应的中间远端复信号以及近端语音信号对应的中间近端复信号。同理，分别对中间远端复信号以及中间近端复信号进行第二倍数的下采样，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号，包括：基于关注频带的上限频率、第二倍数以及中间近端复信号的最高频率，确定对应第二倍数的抗混叠滤波器的过渡带；该抗混叠滤波器的过渡带的下限频率等于关注频带的上限频率，该抗混叠滤波器的过渡带的上限频率不小于第二参考频率的一半，第二参考频率等于中间近端复信号的最高频率与第二倍数的商；基于该第二抗混叠滤波器的过渡带，通过该抗混叠滤波器分别对中间远端复信号以及中间近端复信号进行滤波，得到远端复信号对应的第二参考中间远端复信号以及近端复信号对应的第二参考中间近端复信号，其中，中间远端复信号以及中间近端复信号中位于第二抗混叠滤波器的过渡带中的信号在滤波后被衰减；按照第二倍数对应的采样间隔分别对第二参考中间远端复信号以和第二参考中间近端复信号进行抽取，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号。其中，两次滤波处理的抗混叠滤波器可以均为低通滤波器，从而分别对远端复信号以及近端复信号进行两次滤波处理，以滤除高频部分，避免下采样过程中发生混叠。其中，对应于第一倍数的采样间隔等于第一采样频率的倒数，第一采样频率为近端复信号的最高频率与第一倍数的商，近端复信号的最高频率即为采样获得近端语音信号的采样频率；对应于第二倍数的采样间隔等于第二采样频率的倒数，第二采样频率为中间近端复信号的最高频率与第二倍数的商，中间近端复信号的最高频率即为采样获得近端语音信号的采样频率与第一倍数的商。根据关注频带的上限频率以及参考频率确定抗混叠滤波器的过渡带之后，基于该过渡带，通过所确定的抗混叠滤波器分别对远端复信号以及近端复信号进行滤波，以滤除该抗混叠滤波器对应的阻带以及衰减过渡带中的信号，得到滤波后的远端复信号作为参考中间远端复信号以及滤波后的近端复信号作为参考中间近端复信号，然后，在参考中间远端复信号中每P个信号点采样一个信号点构建信号，实现对参考中间远端复信号进行抽取，得到远端语音信号对应的中间远端复信号，同理，在参考中间近端复信号中每P个信号点采样一个信号点构建信号，实现对参考中间近端复信号进行抽取，得到近端语音信号对应的中间近端复信号。根据关注频带的上限频率以及第二参考频率确定抗混叠滤波器的过渡带之后，基于该过渡带，通过所确定的抗混叠滤波器分别对中间远端复信号以及中间近端复信号进行滤波，以滤除该抗混叠滤波器对应的阻带以及衰减过渡带中的信号，得到滤波后的中间远端复信号作为第二参考中间远端复信号以及滤波后的中间近端复信号作为第二参考中间近端复信号，然后，在第二参考中间远端复信号中每R个信号点采样一个信号点构建信号，实现对第二参考中间远端复信号进行抽取，得到远端语音信号对应的目标远端复信号，同理，在第二参考中间近端复信号中每R信号点采样一个信号点构建信号，实现对第二参考中间近端复信号进行抽取，得到近端语音信号对应的目标近端复信号。本实施例中，确定互相关函数主要利用关注频带中的信号所携带的信息，因此，将下采样过程拆分为前述两个下采样过程，且第一次下采样过程的第一倍数高于第二次下采样的第二倍数，使得第一次下采样之前选取的抗混叠滤波器可以具有较宽的过渡带，从而减少抗混叠滤波器进行滤波处理的数据处理量，提高了抗混叠滤波器的滤波效率，从而提高了整个下采样过程的采样效率。例如，远端语音信号以及近端语音信号均为参照采样率16Khz采样得到的信号，得到的远端复信号以及近端复信号的信号频带则均为-8khz～8Khz，若远端复信号以及目标远端复信号之间的下采样倍数为16倍，以及互相关函数主要利用的关注频带为-500Hz～500Hz，此时，可以将下采样过程拆分为前述两个下采样过程，且第一次下采样过程的第一倍数为8,第二次下采样的第二倍数为2，使得第一次下采样选取的抗混叠滤波器可以具有较宽的过渡带，从而节省抗混叠滤波器滤波过程中的数据量，提高滤波效率。S103、根据目标远端复信号以及目标近端复信号，确定近端语音信号与远端语音信号之间的互相关函数。本实施例中，可以对目标远端复信号进行变换，得到目标远端复信号对应的远端频谱，对目标近端复信号进行变换，得到目标近端复信号对应的近端频谱；根据远端频谱和近端频谱，确定近端语音信号与远端语音信号之间的互相关函数。具体的，对目标远端复信号进行傅里叶变换，得到目标远端复信号对应的远端频谱；对目标近端复信号进行傅里叶变换，得到目标近端复信号对应的近端频谱。然后，根据远端频谱以及近端频谱，确定互功率谱以及权重；基于权重对互功率谱进行加权，得到加权互功率频谱；对加权互功率频谱进行逆傅里叶变换处理，得到近端语音信号与远端语音信号之间的互相关函数。本实施例中，可以通过公式一计算互功率谱以及权重，公式一如下：，/＞其中，为互功率谱，/＞为权重，/＞为远端频谱，/＞为近端频谱，通过对/＞进行复数的共轭运算得到，/＞为信号的能量。得到互功率谱以及权重之后，可以直接对互功率谱以及权重求乘积，实现基于权重对互功率谱进行加权，得到加权互功率频谱。然后，在对加权互功率频谱进行逆傅里叶变换处理，得到近端语音信号与远端语音信号之间的互相关函数。其中，基于权重对互功率谱进行加权，得到加权互功率频谱的计算过程查找公式二，公式二如下： 其中，为加权互功率频谱。示例性的，语音信号的采样率为16kHz情况下，若想要覆盖512ms的延迟范围，并考虑互相关函数在信号边缘的不稳定性，则需要1024ms的时间窗，这意味着需要做16384点的实信号的傅里叶变换，计算量巨大，由于语音信号的能量主要集中在低频部分，可以将远端语音信号以及近端语音信号下采样至2kHz，从而可以减少数据量的同时，也能获取到足够多的具有能量的信号；而此时则需要2048点的实信号傅里叶变换。但是，2kHz采样率的实信号的有效带宽是0～1000Hz，由于人声特性以及低频底噪的影响，近端语音信号以及远端语音信号中低频带的低频底噪是无效甚至有害的，因此通过移频处理将高频信号移动至低频区域，然后对移频后的信号进行下采样，得到目标远端复信号和目标近端复信号，目标远端复信号和目标近端复信号中包括了高频信号的信息，从而可以充分利用所有频带，通过对携带了高频信号的信息的目标远端复信号和目标近端复信号进行处理，虽然没有滤除低频底噪，但是目标远端复信号和目标近端复信号中增加了高频信号所携带的信息，从而降低了近端语音信号以及远端语音信号中低频带底噪的影响，提高了确定的互相关函数的准确率。S104、根据互相关函数，确定回声信号的回声延迟。互相关函数用于描述两个信号在任意两个不同时刻的取值之间的相关程度，得到互相关函数之后，对互相关函数进行峰值检测，所检测到的峰值所在的时间T表示近端语音信号导前T的信号与远端语音信号最相似，该时间T即为近端语音信号中回声信号的回声延迟。本实施例中，根据目标远端复信号以及目标近端复信号确定回声延迟的过程如图6所示，对目标远端复信号进行傅里叶变换，得到远端频谱，对目标近端复信号进行傅里叶变换，得到近端频谱，然后根据近端频谱以及远端频谱确定权重以及互功率谱，并根据权重对互功率谱进行加权，得到加权互功率谱。再之后，对加权互功率谱进行逆傅里叶变换，得到互相关函数，对互相关函数进行峰值检测，得到回声延迟。S105、基于回声信号的回声延迟，对近端语音信号进行回声消除。得到回声延迟之后，可以对远端语音信号根据回声信号的回声延迟对远端语音信号进行延迟处理，得到延迟远端语音信号；根据延迟远端语音信号，对近端语音信号进行回声消除处理，得到目标近端语音信号。在可以对远端语音信号进行信号延迟，延迟的时长为回声延迟，得到延迟后的远端语音信号作为延迟远端语音信号。在一些实施方式中，可以确定与延迟远端语音信号对应的反延迟远端语音信号，将反延迟远端语音信号与近端语音信号进行叠加，实现对近端语音信号进行回声消除处理，得到目标近端语音信号。在另一些实施方式中，可以直接将近端语音信号减去延迟远端语音信号，以实现对近端语音信号进行回声消除处理，得到目标近端语音信号。在实时语音通话场景中，回声消除过程如图7所示，远端设备中的远端应用通过麦克风采集远端说话人的语音，以得到远端语音信号，然后通过网络将远端语音信号发送给近端设备中的近端应用，近端应用通过近端设备的操作系统控制近端设备的扬声器播放远端语音信号，远端语音信号经过回声路径传播时，得到回声信号/＞，同时，近端设备采集近端说话人的说话语音信号/＞，由于，存在回声信号，此时，采集到的近端语音信号/＞，即为说话语音信号/＞叠加了回声信号之后的结果。之后，按照前述S101-S104的过程，根据近端语音信号以及远端语音信号/＞进行延迟估计，得到回声信号的回声延迟，然后根据会回声延迟对远端语音信号/＞进行延迟处理，得到延迟远端语音信号/＞，之后，再通过延迟远端语音信号对近端语音信号/＞进行回声消除，得到目标近端语音信号/＞，并将目标近端语音信号/＞发送给远端应用，以使得远端应用通过远端设备的操作系统控制远端设备的扬声器播放目标近端语音信号/＞，此时，目标近端语音信号经过回声消除处理，不包括回声信号或包括极少的回声信号。本实施例中，首先分别对近端语音信号以及近端语音信号对应的远端语音信号进行移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号，然后分别对远端复信号以及近端复信号进行下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号，并通过目标远端复信号以及目标近端复信号，确定近端语音信号与远端语音信号之间的互相关函数，之后，根据基于互相干函数确定的回声延迟近端语音信号进行回声消除，实现了近端语音信号的回声消除。同时，通过移频处理将实信号的近端语音信号以及远端语音信号转换为复信号，近端复信号和远端复信号是分别利用近端语音信号以及远端语音信号的所有频带得到，保证近端复信号和远端复信号所携带信息的完整性，而且，通过将实信号的近端语音信号和远端语音信号转换到复数域，相对而言，远端复信号和近端复信号的带宽更小，减少了所要处理信号的带宽，减少了数据处理量。其后，对近端复信号和远端复信号进行下采样，并基于下采样之后的信号确定近端语音信号与远端语音信号之间的互相关函数，这样，可以进一步减少数据处理量。而且，基于人声特性的影响，低频带的信息是无效且甚至有害的，通过将实信号变换为复信号，而且进行下采样，可以减少低频带的影响，保证了确定的互相关函数的准确性，提高了回声消除的效果，由于减少了数据处理量，从而提高了回声消除的效率。在一实施例中，近端语音信号为实时采集的近端语音信号序列中的一个近端语音信号片段，相应的，远端语音信号为远端语音信号序列中的一个远端语音信号片段，一个远端语音信号片段与一个近端语音信号片段相对应，远端语音信号片段与相对应的近端语音信号片段的时长相同。如图8所示，步骤S103包括：S201、响应于与近端语音信号的结束时间的延迟时长达到第一时长，对目标远端复信号进行变换，得到目标远端复信号对应的远端频谱。在一些实施方式中，在开始播放远端语音信号之后，即可以按照目标采集时长采集近端语音信号片段，每个采集到的近端语音信号片段按照采集顺序依次排列，构成近端语音信号序列，近端语音信号序列中的任意一个近端语音信号片段可以作为一个近端语音信号。其中，目标采集时长可以是基于需求设定的，例如，1s。同理，将远端语音信号即是对采集到的整个初始远端语音信号按照目标采集时长划分后的一个语音信号片段，各个远端语音信号按照在初始远端语音信号中的顺序依次排列，得到远端语音信号序列。在一些实施方式中，远端语音信号序列也可以是实时采集的，按照目标采集时长采集的一个远端语音信号片段作为一个远端语音信号。本实施例中，可以按照预设采集时长采集近端语音帧，采集到的近端语音帧按照采集顺序依次排列，构成近端语音信号序列；可以在近端语音信号序列中选取任意连续K个近端语音帧构建一个近端语音信号片段，K为大于1的正整数。其中，预设采集时长可以是10ms。这样，可以每K个近端语音帧进行一次回声延迟估计，而不用对每个近端语音帧进行一次回声延迟估计，这样整体上可以减少回声消除的计算量。近端语音信号的结束时间是指近端语音信号采集结束的时间，若按照目标采集时长采集近端语音信号片段，并将一个近端语音信号片段作为一个近端语音信号的情况下，近端语音信号的结束时间是指该近端语音信号采集完毕的时刻；若按照预设采集时长采集语音帧，近端语音信号的结束时间是指近端语音信号中时序最后的一个语音帧的采集结束时刻。在一些实施方式中，远端语音信号序列也可以是实时采集的，按照预设采集时长采集远端语音帧，采集到的远端语音帧按照采集顺序依次排列，构成远端语音信号序列；可以在远端语音信号序列中选取任意连续K个远端语音帧构建一个远端语音信号片段，该远端语音信号片段可以作为一个远端语音信号。第一时长可以是基于需求设定的值。例如，若按照目标采集时长采集近端语音信号片段，然后将一个近端语音信号片段作为一个近端语音信号的情况下，第一时长可以是不少于第一数据处理时长的时长，第一数据处理时长可以是指对近端语音信号进行移频以及下采样处理得到目标近端复信号的时长；又如，若按照预设采集时长采集近端语音帧，然后选取任意连续K个近端语音帧构建一个近端语音信号的情况下，第一时长可以是不少于第二数据处理时长的时长，第二数据处理时长可以是指对近端语音信号中时序最后的一个语音帧进行移频以及下采样处理得到该近端语音信号中时序最后的一个语音帧对应的复信号的时长。S202、响应于与结束时间的延迟时长达到第二时长，对目标近端复信号进行变换，得到目标近端复信号对应的近端频谱。S203、响应于与结束时间的延迟时长达到第三时长，根据远端频谱和近端频谱，确定近端语音信号与远端语音信号之间的互相关函数。相应地，步骤S104包括：响应于与结束时间的延迟时长达到第四时长，根据互相关函数，确定回声信号的回声延迟。其中，第二时长大于第一时长，第三时长大于第二时长，第四时长大于第三时长。前述S201-S203以及S104是计算量较高的四个步骤，将该四个步骤在不同时间进行处理，从而可以降低四个步骤同时处理的负载消耗，实现负载均衡的目的。在一些实施方式中，若近端语音信号包括至少一个近端语音帧；第二时长与第一时长的时间差、第三时长与第二时长的时间差、以及第四时长与第三时长的时间差相等，时间差等于预设采集时长的N倍，N为正整数，预设采集时长为每个近端语音帧的时长。在一些实施例中，在时间差可以等于预设采集时长的一倍的情况下，与当前处理的近端语音信号的结束时间的延迟时长达到第一时长的时刻可以是新采集到一个近端语音帧的时刻，对应的，与当前处理的近端语音信号的结束时间的延迟时长达到第二时长的时刻为在近端语音帧S1之后采集到的下一个近端语音帧S2；与当前处理的近端语音信号的结束时间的延迟时长达到第三时长的时刻为在近端语音帧S2之后采集到的下一个近端语音帧S3；同理，与当前处理的近端语音信号的结束时间的延迟时长达到第四时长的时刻为在近端语音帧S3之后采集到的下一个近端语音帧S4。在另一些实施方式中，还可以将近端语音信号序列中的每个近端语音信号片段作为一个近端语音信号，按照各个近端语音信号的顺序依次确定每个近端语音信号对应的回声延迟，针对每个近端语音信号，若该语音信号的回声延迟与前一个语音信号的回声延迟的差异小于预设差异，确定该语音信号的回声延迟作为最终的目标回声延迟，然后通过目标回声延迟对近端语音信号进行回声消除。预设差异例如可以是10ms。值得一提的是，在实时通话场景中，近端语音信号也会实时传送给远端进行播放，可以在确定目标回声延迟之后，对得到目标回声延迟之后得到的近端语音信号进行回声消除处理，并将回声消除之后的目标近端语音信号发送给远端进行播放。在音频录制场景中，近端语音信号可能不会实时传送给远端进行播放，可以在确定目标回声延迟之后，对得到所有的近端语音信号进行回声消除处理，并将回声消除之后的目标近端语音信号进行存储。在一些场景中，实时采集近端语音帧，并将近端语音帧进行移频和下采样处理，得到近端语音帧对应的近端语音帧复信号，可以将近端语音帧复信号实时缓存，同时，还可以将远端语音信号片段中与近端语音帧对应的远端语音帧进行移频和下采样处理，得到远端语音帧对应的远端语音帧复信号，并将远端语音帧复信号实时缓存。如图9所示，当任意一个近端语音帧y1采集完毕时，即在该近端语音帧采集完毕时刻t1从已缓存的远端语音帧复信号中选取远端语音帧复信号作为远端复信号数据q1，该选取的远端复信号数据所对应的远端语音帧构成的语音信号片段作为远端语音信号c1，然后对远端复信号数据q1进行傅里叶变换，得到远端频谱；在y1的下一个近端语音帧y2采集完毕时，即在近端语音帧采y2集完毕时刻t2，从已缓存的远端语音帧复信号中选取远端语音信号c1对应的近端语音信号c2，近端语音信号c2包括所有近端语音帧对应的近端语音帧复信号作为近端复信号数据q2，然后对近端复信号数据q2进行傅里叶变换，得到近端频谱；在y2的下一个近端语音帧y3采集完毕时，即在近端语音帧采y3集完毕时刻t3根据远端频谱以及近端频谱进行加权互功率谱的计算以及逆傅里叶变换的处理，得到互相关函数；在y3的下一个近端语音帧y4采集完毕时，即在近端语音帧采y4集完毕时刻t4根据对互相关函数进行峰值检测，得到回声信号的回声延迟。本实施例中，将回声消除中负载消耗较高的多个高负载步骤分散在不同的时刻进行处理，避免了对多个高负载步骤同时处理导致的负载较高，数据处理缓慢的情况发生，实现了负载均衡的目的，减少了数据处理缓慢的情况发生。请参阅图10，图10示出了本申请一个实施例提出的一种回声消除装置的框图，装置1100包括：移频模块1110，用于分别对近端语音信号以及近端语音信号对应的远端语音信号进行移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号，近端语音信号中叠加了因播放所对应的远端语音信号产生的回声信号；采样模块1120，用于分别对远端复信号以及近端复信号进行下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号；函数确定模块1130，用于根据目标远端复信号以及目标近端复信号，确定近端语音信号与远端语音信号之间的互相关函数；延迟确定模块1140，用于根据互相关函数，确定回声信号的回声延迟；消除模块1150，用于基于回声信号的回声延迟，对近端语音信号进行回声消除。可选地，函数确定模块1130，还用于对目标远端复信号进行变换，得到目标远端复信号对应的远端频谱；对目标近端复信号进行变换，得到目标近端复信号对应的近端频谱；根据远端频谱和近端频谱，确定近端语音信号与远端语音信号之间的互相关函数。可选地，近端语音信号为实时采集的近端语音信号序列中的一个近端语音信号片段；可选地，函数确定模块1130，还用于响应于与近端语音信号的结束时间的延迟时长达到第一时长，对目标远端复信号进行变换，得到目标远端复信号对应的远端频谱；响应于与结束时间的延迟时长达到第二时长，对目标近端复信号进行变换，得到目标近端复信号对应的近端频谱；第二时长大于第一时长；响应于与结束时间的延迟时长达到第三时长，根据远端频谱和近端频谱，确定近端语音信号与远端语音信号之间的互相关函数；第三时长大于第二时长；相应的，延迟确定模块1140，还用于响应于与结束时间的延迟时长达到第四时长，根据互相关函数，确定回声信号的回声延迟；第四时长大于第三时长。可选地，采样模块1120，还用于分别对远端复信号以及近端复信号进行多次下采样处理，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号。可选地，关注频带位于目标远端复信号的频带和目标近端复信号的频带中；采样模块1120，还用于分别对远端复信号以及近端复信号进行第一倍数的下采样，得到远端语音信号对应的中间远端复信号以及近端语音信号对应的中间近端复信号；分别对中间远端复信号以及中间近端复信号进行第二倍数的下采样，得到远端语音信号对应的目标远端复信号以及近端语音信号对应的目标近端复信号；其中，第一倍数高于第二倍数；第一倍数与第二倍数的乘积等于目标倍数，目标倍数等于近端复信号的最高频率与关注频带的上限频率的比值。可选地，采样模块1120，还用于基于关注频带的上限频率、第一倍数以及近端复信号的最高频率，确定对应第一倍数的抗混叠滤波器的过渡带；过渡带的下限频率等于关注频带的上限频率，过渡带的上限频率不小于参考频率的一半，参考频率等于近端复信号的最高频率与第一倍数的商；基于过渡带，通过抗混叠滤波器分别对远端复信号以及近端复信号进行滤波，得到远端复信号对应的参考中间远端复信号以及近端复信号对应的参考中间近端复信号，其中，远端复信号以及近端复信号中位于过渡带中的信号在滤波后被衰减；按照第一倍数对应的采样间隔分别对参考中间远端复信号以和参考中间近端复信号进行抽取，得到远端语音信号对应的中间远端复信号以及近端语音信号对应的中间近端复信号。可选地，函数确定模块1130，还用于根据远端频谱以及近端频谱，确定互功率谱以及权重；基于权重对互功率谱进行加权，得到加权互功率频谱；对加权互功率频谱进行逆傅里叶变换处理，得到近端语音信号与远端语音信号之间的互相关函数。可选地，消除模块1150，还用于根据回声信号的回声延迟对远端语音信号进行延迟处理，得到延迟远端语音信号；根据延迟远端语音信号，对近端语音信号进行回声消除处理。可选地，移频模块1110，还用于根据近端语音信号的语音场景，确定目标移频量；分别对远端语音信号以及近端语音信号进行目标移频量的移频处理，得到远端语音信号对应的远端复信号以及近端语音信号对应的近端复信号。需要说明的是，本申请中装置实施例与前述方法实施例是相互对应的，装置实施例中具体的原理可以参见前述方法实施例中的内容，此处不再赘述。图10示出了用于执行根据本申请实施例的回声消除方法的电子设备的结构框图。该电子设备可以是图1中第二终端10或第一终端20等，需要说明的是，图10示出的电子设备的计算机系统1200仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图10所示，计算机系统1200包括中央处理单元1201，其可以根据存储在只读存储器1202中的程序或者从存储部分1208加载到随机访问存储器1203中的程序而执行各种适当的动作和处理，例如执行上述实施例中的方法。在RAM 1203中，还存储有系统操作所需的各种程序和数据。CPU1201、ROM1202以及RAM 1203通过总线1204彼此相连。输入/输出接口1205也连接至总线1204。以下部件连接至I/O接口1205：包括键盘、鼠标等的输入部分1206；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分1207；包括硬盘等的存储部分1208；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分1209。通信部分1209经由诸如因特网的网络执行通信处理。驱动器1210也根据需要连接至I/O接口1205。可拆卸介质1211，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器1210上，以使于从其上读出的计算机程序根据需要被安装入存储部分1208。特别地，根据本申请的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本申请的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分1209从网络上被下载和安装，和/或从可拆卸介质1211被安装。在该计算机程序被中央处理单元1201执行时，执行本申请的系统中限定的各种功能。需要说明的是，本申请实施例所示的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、闪存、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本申请中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、有线等等，或者上述的任意合适的组合。附图中的流程图和框图，图示了按照本申请各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。其中，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本申请实施例中所涉及到的单元可以通过软件的方式实现，也可以通过硬件的方式来实现，所描述的单元也可以设置在处理器中。其中，这些单元的名称在某种情况下并不构成对该单元本身的限定。作为另一方面，本申请还提供了一种计算机可读存储介质，该计算机可读介质可以是上述实施例中描述的电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述计算机可读存储介质承载计算机可读指令，当该计算机可读存储指令被处理器执行时，实现上述任一实施例中的方法。根据本申请实施例的一个方面，提供了计算机程序产品或计算机程序，该计算机程序产品或计算机程序包括计算机指令，该计算机指令存储在计算机可读存储介质中。电子设备的处理器从计算机可读存储介质读取该计算机指令，处理器执行该计算机指令，使得该电子设备执行上述任一实施例中的方法。本申请实施例中，术语“模块”或“单元”是指有预定功能的计算机程序或计算机程序的一部分，并与其他相关部分一起工作以实现预定目标，并且可以通过使用软件、硬件或其组合来全部或部分实现，同样的，一个处理器可以用来实现一个或多个模块或单元。此外，每个模块或单元都可以是该模块或单元功能的整体模块或单元的一部分。应当注意，尽管在上文详细描述中提及了用于动作执行的设备的若干模块或者单元，但是这种划分并非强制性的。实际上，根据本申请的实施方式，上文描述的两个或更多模块或者单元的特征和功能可以在一个模块或者单元中具体化。反之，上文描述的一个模块或者单元的特征和功能可以进一步划分为由多个模块或者单元来具体化。通过以上的实施方式的描述，本领域的技术人员易于理解，这里描述的示例实施方式可以通过软件实现，也可以通过软件结合必要的硬件的方式来实现。因此，根据本申请实施方式的技术方案可以以软件产品的形式体现出来，该软件产品可以存储在一个非易失性存储介质中或网络上，包括若干指令以使得一台电子设备执行根据本申请实施方式的方法。本领域技术人员在考虑说明书及实践这里公开的实施方式后，将容易想到本申请的其它实施方案。本申请旨在涵盖本申请的任何变型、用途或者适应性变化，这些变型、用途或者适应性变化遵循本申请的一般性原理并包括本申请未公开的本技术领域中的公知常识或惯用技术手段。应当理解的是，本申请并不局限于上面已经描述并在附图中示出的精确结构，并且可以在不脱离其范围进行各种修改和改变。本申请的范围仅由所附的权利要求来限制。最后应说明的是：以上实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不驱使相应技术方案的本质脱离本申请各实施例技术方案的精神和范围。
