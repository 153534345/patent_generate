标题title
基于机器视觉的贴装平面坐标热补偿方法及系统、存储介质
摘要abst
本发明涉及贴装误差补偿技术领域，具体公开了基于机器视觉的贴装平面坐标热补偿方法及系统、存储介质，所述方法包括以下步骤：在贴装平面上确定4个标记点，机器识别标记点坐标作为基准参考坐标点以及识别贴装点位置坐标；贴装生产中每隔预设时间段识别标记点当前坐标；根据基准参考坐标点和当前坐标分别计算坐标系下X轴和Y轴方向的伸缩比例；根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量，将偏移量补偿到贴装点的位置坐标。该方案实时补偿贴装平面上的平面坐标，从而达到保证到位精度的目的，克服温度变化带来的到位精度变差问题，提高了贴装精度，并且方法简单。
权利要求书clms
1.一种基于机器视觉的贴装平面坐标热补偿方法，其特征在于，包括以下步骤：在贴装平面上确定4个标记点，机器识别标记点坐标作为基准参考坐标点以及识别贴装点位置坐标；贴装生产中每隔预设时间段识别标记点当前坐标；根据基准参考坐标点和当前坐标分别计算坐标系下X轴和Y轴方向的伸缩比例，X轴和Y轴方向的伸缩比例包括4个标记点中左上角和右上角标记点之间的伸缩比例、左下角和右下角标记点之间的伸缩比例/＞、左下角和左上角标记点之间的伸缩比例/＞和右下角和右上角标记点之间的伸缩比例/＞，计算公式如下：，，，，其中，、/＞和分别为4个标记点的当前坐标，/＞、/＞分别为4个标记点的当前坐标相对应的基准参考坐标点；根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量，将偏移量补偿到贴装点的位置坐标。2.根据权利要求1所述的方法，其特征在于，所述4个标记点分布设置在贴装平面上贴装点区域的外围位置。3.根据权利要求1所述的方法，其特征在于，所述根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量公式如下：，其中，为贴装点位置坐标，ΔX为X轴方向的偏移量，ΔY为Y轴方向的偏移量。4.根据权利要求2所述的方法，其特征在于，4个所述标记点成矩形分布，分布设置在贴装平面的4个角落位置，且所述坐标系的X轴和Y轴分别与所述矩形的两相邻直角边平行。5.根据权利要求1-4中任一所述的方法，其特征在于，所述将偏移量补偿到贴装点的位置坐标，补偿后的坐标为。6.根据权利要求5所述的方法，其特征在于，所述方法还包括：首先预热使贴装平面达到预设温度。7.一种基于机器视觉的贴装平面坐标热补偿系统，其特征在于，包括：图像采集和识别模块，用于识别在贴装平面上确定的4个标记点坐标作为基准参考坐标点以及识别贴装点位置坐标；还用于贴装生产中每隔预设时间段识别标记点当前坐标；计算模块，用于根据基准参考坐标点和当前坐标分别计算坐标系下X轴和Y轴方向的伸缩比例，X轴和Y轴方向的伸缩比例包括4个标记点中左上角和右上角标记点之间的伸缩比例、左下角和右下角标记点之间的伸缩比例/＞、左下角和左上角标记点之间的伸缩比例/＞和右下角和右上角标记点之间的伸缩比例/＞，计算公式如下：，，，，其中，、/＞和分别为4个标记点的当前坐标，/＞、/＞分别为4个标记点的当前坐标相对应的基准参考坐标点；补偿模块，用于根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量，将偏移量补偿到贴装点的位置坐标。8.根据权利要求7所述的系统，其特征在于，还包括：运动控制模块，用于驱动图像采集和识别模块在贴片机平面坐标系中运动到指定的坐标位置。9.一种计算机可读存储介质，其特征在于，其上存储有程序，所述程序能够被处理器执行以实现如权利要求1-6中任一所述方法的步骤。10.一种处理器，其特征在于，用于运行程序，其中，所述程序被运行时用于执行：如权利要求1-6中任意一项所述的基于机器视觉的贴装平面坐标热补偿方法。
说明书desc
技术领域本发明涉及贴装误差补偿技术领域，具体地涉及一种基于机器视觉的贴装平面坐标热补偿方法及系统、存储介质。背景技术在贴片机器暖机后，通过对贴片机关键部件进行校正，如申请号为202211681882.3的发明专利，进而在实际的机器运行过程中保证到位位置的精确程度。但是随着运行环境状况的变化，尤其是温度的变化，导致机器部件产生受热膨胀或收缩，进而引发贴装头运动到指定位置的到位精度变差甚至丢失的状况。因此，对贴片机进行标定后，在一定环境温度下，贴片机运行的到位精度可以得到保证，在温度过低或者温度过高情况下，贴装头的到位精度丢失。现有技术无法解决温度变化带来的到位精度变差从而导致贴装误差的问题。发明内容本发明的目的是为了克服现有技术存在的问题，提供一种基于机器视觉的贴装平面坐标热补偿方法及系统、存储介质。为了实现上述目的，本发明第一方面提供一种基于机器视觉的贴装平面坐标热补偿方法，包括以下步骤：在贴装平面上确定4个标记点，机器识别标记点坐标作为基准参考坐标点以及识别贴装点位置坐标；贴装生产中每隔预设时间段识别标记点当前坐标；根据基准参考坐标点和当前坐标分别计算坐标系下X轴和Y轴方向的伸缩比例，所述X轴和Y轴方向的伸缩比例包括4个标记点中左上角和右上角标记点之间的伸缩比例、左下角和右下角标记点之间的伸缩比例/＞、左下角和左上角标记点之间的伸缩比例/＞和右下角和右上角标记点之间的伸缩比例/＞，计算公式如下：，，，，其中，、/＞和分别为4个标记点的当前坐标，/＞、/＞分别为4个标记点的当前坐标相对应的基准参考坐标点；根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量，将偏移量补偿到贴装点的位置坐标。优选地，所述标记点的数量为4个，分布设置在贴装平面上贴装点区域的外围位置。优选地，所述根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量公式如下：其中，为贴装点位置坐标，ΔX为X轴方向的偏移量，ΔY为Y轴方向的偏移量。优选地，4个所述标记点成矩形分布，分布设置在贴装平面的4个角落位置，且所述坐标系的X轴和Y轴分别与所述矩形的两相邻直角边平行。优选地，所述将偏移量补偿到贴装点的位置坐标，补偿后的坐标为。优选地，所述方法还包括：首先预热使贴装平面达到预设温度。本发明第二方面提供一种基于机器视觉的贴装平面坐标热补偿系统，包括：图像采集和识别模块，用于识别在贴装平面上确定的4个标记点坐标作为基准参考坐标点以及识别贴装点位置坐标；还用于贴装生产中每隔预设时间段识别标记点当前坐标；计算模块，用于根据基准参考坐标点和当前坐标分别计算坐标系下X轴和Y轴方向的伸缩比例，X轴和Y轴方向的伸缩比例包括4个标记点中左上角和右上角标记点之间的伸缩比例、左下角和右下角标记点之间的伸缩比例/＞、左下角和左上角标记点之间的伸缩比例/＞和右下角和右上角标记点之间的伸缩比例/＞，计算公式如下：，，，，其中，、/＞和分别为4个标记点的当前坐标，/＞、/＞分别为4个标记点的当前坐标相对应的基准参考坐标点；补偿模块，用于根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量，将偏移量补偿到贴装点的位置坐标。优选地，还包括：运动控制模块，用于驱动图像采集和识别模块在贴片机平面坐标系中运动到指定的坐标位置。本发明第三方面提供一种计算机可读存储介质，包括程序，所述程序能够被处理器执行以实现上述基于机器视觉的贴装平面坐标热补偿方法的步骤。本发明第四方面提供一种处理器，用于运行程序，其中，所述程序被运行时用于执行：如上述基于机器视觉的贴装平面坐标热补偿方法。通过上述技术方案，在机器运行过程中，使用贴装头上的相机按照一定的时间间隔拍摄贴装平面上固定的标记点，根据标记点识别坐标漂移情况，实时补偿贴装平面上的平面坐标，从而达到保证到位精度的目的，克服温度变化带来的到位精度变差问题，提高了贴装精度，并且方法简单。附图说明图1是本发明提出的基于机器视觉的贴装平面坐标热补偿流程示意图；图2是本发明实施例提出的贴装平面标记点设置示意图。具体实施方式为了进一步说明本发明的特征，下面通过具体的实施方式对本发明的技术方案进行更加详细的说明。但是本发明能够以很多不同于此描述地在其他地方展开实施，本领域技术人员可以在不违背本发明内涵的情况下做类似改进，因此本发明不受下面公开的具体实施的限制。在贴片机机台上设置固定的标记点，设置高度使得贴装头上的相机可以清晰拍摄。实际测试发现，单独对该固定标记点加热不会引发其识别位置偏移。但是在整机运行一段时间或者冷却一段时间后，识别该标记点，发现其位置产生偏移，在控制环境温度后，识别的标记点坐标又可以恢复，因此，本技术方案考虑通过对该固定标记点的位置变化来补偿平面坐标。另外，在机器上电后，贴装头标记识别用相机温度快速升高，后续一直趋于平稳，在实际生产中，相机的热膨胀可忽略不计。基于上述发现，本发明第一方面提供一种基于机器视觉的贴装平面坐标热补偿方法，如图1所示，包括以下步骤：S1、在贴装平面上确定若干标记点，机器识别标记点坐标作为基准参考坐标点以及识别贴装点位置坐标；在贴片机贴装过程中，所述机器采用贴装头上的标记识别相机来识别，驱动贴装头运动到位坐标为固定标记点的理论机械坐标，使用标记识别相机拍摄标记点图像，识别标记点中心距离图像中心的像素偏差，以如图2所示的左下角标记点为例，识别出的标记点中心距离图像中心的像素偏差记为相机X向像素标尺记为/＞，相机Y向像素标尺记为/＞。则左下角标记基准参考标记点计算公式为：其中，为左下角标记点理论机械坐标，/＞是标记识别相机安装角度偏差。其他标记点及贴装点位置坐标识别方法同理。S2、贴装生产中每隔预设时间段识别标记点当前坐标；S3、根据基准参考坐标点和当前坐标分别计算坐标系下X轴和Y轴方向的伸缩比例；S4、根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量，将偏移量补偿到贴装点的位置坐标。本发明的标记点可以是3个、4个、5个或者更多。在本发明的一个实施例中，所述标记点的数量为4个，分布设置在贴装平面上贴装点区域的外围位置。步骤S3中，所述X轴和Y轴方向的伸缩比例包括4个标记点中左上角和右上角标记点之间的伸缩比例、左下角和右下角标记点之间的伸缩比例/＞、左下角和左上角标记点之间的伸缩比例/＞和右下角和右上角标记点之间的伸缩比例/＞，计算公式如下：，，，，其中，、/＞和分别为4个标记点的当前坐标，/＞、/＞分别为4个标记点的当前坐标相对应的基准参考坐标点。值得说明的是，4个标记点可以以任意4边形分布，如平行四边形、矩形和梯形。优选地，如图2所示，4个所述标记点成矩形分布，分布设置在贴装平面的4个角落位置，且所述坐标系的X轴和Y轴分别与所述矩形的两相邻直角边平行。示例性地，本发明实施例中基于机器视觉的贴装平面坐标热补偿方法如下：步骤1：贴片机上电后，先进行半小时左右暖机；步骤2：驱动贴装头运动，使用标记识别相机拍摄4个标记点的图像，计算出每个标记点在机台平面上的坐标，这4个坐标点作为基准参考坐标点，如图2所示，记为、/＞、/＞、/＞。步骤3：在实际生产中，每隔固定的时间，驱动贴装头运动，使用标记识别相机拍摄4个标记点的图像。计算出每个标记点在机台平面上的坐标，分别记为、/＞、、/＞。步骤4：计算左上角和右上角标记点之间的伸缩比例，计算左下角和右下角标记点之间的伸缩比例/＞，计算左下角和左上角标记点之间的伸缩比例/＞，计算右下角和右上角标记点之间的伸缩比例。步骤5：根据伸缩比例计算贴装点位P的X向偏移量和贴装点位P的Y向偏移量。步骤6：贴装点位P在机台平面的理论坐标记为，则贴装点位P补偿后的坐标为/＞。测试例：在机器各项参数标定完成后，首先直接测试贴装精度数据，样本点数为640，得到表1中“初次标定后测试结果”，当室温发生变化后，在同一温度下分别进行不采用热补偿方案的贴装精度测试得到表1中“不加热补偿测试结果”和采用本申请热补偿方法的贴装精度测试得到表1中“热补偿后测试结果”，样本点数为640。各个测试数据如表1所示：表1 贴装精度测试结果CP：制程精密度，表征制程满足规格公差的能力，即反映离散程度；Cp值越大，表征制程变异越小，制程能力越强。CPK：过程能力指数：表示过程能力满足技术标准的程度。贴片机厂商常用来描述机器贴装的精准度，Cpk越大，过程能力越强。由以上结果可知，采用热补偿后，贴装精度明显高于不采用加热补偿的贴装测试精度，接近初次标定后的测试结果，说明采用热补偿后贴装精度显著恢复。通过上述技术方案，在机器运行过程中，使用贴装头上的相机按照一定的时间间隔拍摄贴装平面上固定的标记点，根据标记点识别坐标漂移情况，实时补偿贴装平面上的平面坐标，从而达到保证到位精度的目的，克服温度变化带来的到位精度变差问题，提高了贴装精度，并且方法简单。基于同一发明构思，本发明第二方面提供一种基于机器视觉的贴装平面坐标热补偿系统，包括：图像采集和识别模块，用于识别在贴装平面上确定的若干标记点坐标作为基准参考坐标点以及识别贴装点位置坐标；还用于贴装生产中每隔预设时间段识别标记点当前坐标；计算模块，用于根据基准参考坐标点和当前坐标分别计算坐标系下X轴和Y轴方向的伸缩比例；补偿模块，用于根据伸缩比例和贴装点的位置坐标计算贴装点在X轴和Y轴方向的偏移量，将偏移量补偿到贴装点的位置坐标。进一步地，还包括：运动控制模块，用于驱动图像采集和识别模块在贴片机平面坐标系中运动到指定的坐标位置。基于同一发明构思，本发明第三方面提供一计算机可读存储介质，其特征在于，其上存储有程序，所述程序能够被处理器执行以实现上述方法的步骤。综上所述，在机器运行过程中，使用贴装头上的相机按照一定的时间间隔拍摄贴装平面上固定的标记点，根据标记点识别坐标漂移情况，实时补偿贴装平面上的平面坐标，从而达到保证到位精度的目的，克服温度变化带来的到位精度变差问题，提高了贴装精度，并且方法简单，有效提高了工作效率。以上结合附图详细描述了本发明的优选实施方式，但是，本发明并不限于此。在本发明的技术构思范围内，可以对本发明的技术方案进行多种简单变型包括各个具体技术特征以任何合适的方式进行组合。为了避免不必要的重复，本发明对各种可能的组合方式不再另行说明。但这些简单变型和组合同样应当视为本发明所公开的内容，均属于本发明的保护范围。
