标题title
基于平均场博弈的虚拟电厂实时调峰优化调控方法及系统
摘要abst
本发明公开一种基于平均场博弈的虚拟电厂实时调峰优化调控方法及系统，涉及虚拟电厂实时调峰调度优化领域，基于虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率，根据聚合可调功率应用同质集群动态聚合方法将虚拟电厂的分布式资源划分为多个同质集群；利用平均场博弈论确定每一同质集群的调峰调度电量，闵可夫斯基和以及内嵌直角棱锥评估法的应用建立了精度更高的聚合可调功率评估模型从而减少聚合资源的调度误差，基于平均场博弈对虚拟电厂内的同质集群进行分布式资源分配，实现对聚合资源的精确控制。
权利要求书clms
1.一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，其特征在于，包括：建立虚拟电厂运行模型；所述虚拟电厂运行模型包括可再生能源运行模型、温控负荷运行模型和电储能系统运行模型；基于所述虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率；根据所述聚合可调功率应用同质集群动态聚合方法将所述虚拟电厂的分布式资源划分为多个同质集群；各所述同质集群具有相同的调峰外特性；利用平均场博弈论确定每一所述同质集群的调峰调度电量。2.根据权利要求1所述的一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，其特征在于，基于所述虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率，具体包括：基于所述虚拟电厂运行模型，将所述虚拟电厂的每一分布式资源的时间耦合功率约束等效为T维的凸集；其中，/＞；式中，/＞为系数矩阵；/＞表示实数集；K代表一个时间间隔内的约束数量；/＞为常数矩阵；/＞表示给定的置信度；T为时间间隔总数；/＞分别为分布式资源i的功率和能量向量；对所述凸集应用闵可夫斯基和得到随机聚合功率集；将所述随机聚合功率集等效为聚合功率多面体，并从空间几何角度简化聚合功率空间约束；基于所述聚合功率空间约束，将所述虚拟电厂的虚拟储能模型等效为所述聚合功率多面体中最大内嵌T维直角棱锥；将所述最大内嵌T维直角棱锥映射到时间坐标上，得到所述虚拟电厂的所述聚合可调功率。3.根据权利要求2所述的一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，其特征在于，所述随机聚合功率集的表达式为：式中，表示虚拟电厂在给定置信度/＞下的随机聚合功率集；n为分布式资源的数量；是闵可夫斯基和；/＞表示分布式资源n的运行功率；PVPP表示虚拟电厂的运行功率。4.根据权利要求3所述的一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，其特征在于，所述聚合功率空间约束为：其中，表示虚拟电厂在给定置信度/＞下t时刻的运行功率可调范围大小；表示虚拟电厂在给定置信度/＞下的初始功率；/＞表示虚拟电厂在给定置信度下t时刻运行功率的上限值。5.根据权利要求4所述的一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，其特征在于，所述聚合可调功率的表达式为：式中，表示在给定置信度/＞下的聚合可调功率；/＞表示虚拟电厂在给定置信度/＞下t时刻运行功率的下限值。6.根据权利要求5所述的一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，其特征在于，根据所述聚合可调功率应用同质集群动态聚合方法将所述虚拟电厂的分布式资源划分为多个同质集群，具体包括：将所述虚拟电厂的各所述分布式资源构成分布式资源集合；并根据基准的聚合功率上调量和基准的聚合功率下调量确定集群划分中心的第一特征向量；对当前所述分布式资源集合中的各所述分布式资源进行随机组合，得到分布式资源组合；计算当前所述分布式资源组合的所述聚合可调功率，并根据所述分布式资源组合的所述聚合可调功率等效出当前所述分布式资源组合的虚拟储能模型；根据当前所述分布式资源组合的虚拟储能模型的调峰外特性的聚合可上调功率和聚合可下调功率计算当前所述分布式资源组合的第二特征向量；根据所述第一特征向量和所述第二特征向量计算所述集群划分中心和当前所述分布式资源组合的欧式距离；判断所述欧式距离是否小于预设值，得到第一判断结果；若所述第一判断结果为否，则返回步骤“对当前所述分布式资源集合中的各所述分布式资源进行随机组合”；若所述第一判断结果为是，则将当前所述分布式资源组合视为一个所述同质集群；将当前所述分布式资源组合的各所述分布式资源从当前所述分布式资源集合中去除；判断当前去除后的分布式资源集合是否为空集，得到第二判断结果；若所述第二判断结果为否，则令当前所述去除后的分布式资源集合为当前所述分布式资源集合，返回步骤“对当前所述分布式资源集合中的各所述分布式资源进行随机组合”；若所述第二判断结果为是，则输出所有所述同质集群。7.根据权利要求6所述的一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，其特征在于，利用平均场博弈论确定每一所述同质集群的调峰调度电量，具体包括：对每一所述同质集群，令所述同质集群的能量存储表示所述同质集群的状态；令所述同质集群的削峰功率和填谷功率表示所述同质集群的控制变量；在给定时间窗口内，以所述同质集群的平均激励报酬为值函数；所述平均激励报酬的表达式的参数中包括所述削峰功率和所述填谷功率以及各自对应的激励价格；对每一所述同质集群，根据所述同质集群的当前状态和当前调峰奖励电价，确定最大化平均激励报酬的最优控制策略的表达式；根据每一所述同质集群的当前状态确定所有所述同质集群的平均场概率密度函数；所述平均场概率密度函数用于描述所有所述同质集群整体的状态动态；对每一所述同质集群，根据所述同质集群的当前状态和贝尔曼价值函数得到表示同质集群最优控制的HJB方程，并求解所述HJB方程得到每一所述同质集群当前最优调峰量；所述贝尔曼价值函数是根据当前最大化平均激励报酬的所述最优控制策略的表达式和贝尔曼最优控制理论定义得出的；对每一所述同质集群，将当前所述最优调峰量带入所述同质集群的调峰外特性表达式中，得到所述同质集群的更新状态；将每一所述同质集群的更新状态带入所述平均场概率密度函数中，得到当前平均场概率密度函数值；判断当前所述平均场概率密度函数值是否满足FPK等式方程，得到第三判断结果；若所述第三判断结果为是，则输出每一所述同质集群的当前所述最优调峰量，得到最优的调峰调度电量；若所述第三判断结果为否，则对每一所述同质集群，根据当前所述最优调峰量和当前所述平均场概率密度函数值得到每一所述同质集群的激励价格；所述激励价格包括削峰激励价格和填谷激励价格；令所述同质集群的更新状态为所述同质集群的当前状态，返回步骤“根据所述同质集群的当前状态和贝尔曼价值函数得到表示同质集群最优控制的HJB方程”。8.一种基于平均场博弈的虚拟电厂实时调峰优化调控系统，其特征在于，包括：虚拟电厂运行模型建立模块，用于建立虚拟电厂运行模型；所述虚拟电厂运行模型包括可再生能源运行模型、温控负荷运行模型和电储能系统运行模型；聚合可调功率评估模块，用于基于所述虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率；集群划分模块，用于根据所述聚合可调功率应用同质集群动态聚合方法将所述虚拟电厂的分布式资源划分为多个同质集群；各所述同质集群具有相同的调峰外特性；调峰调度电量确定模块，用于利用平均场博弈论确定每一所述同质集群的调峰调度电量。
说明书desc
技术领域本发明涉及虚拟电厂实时调峰调度优化领域，特别是涉及一种基于平均场博弈的虚拟电厂实时调峰优化调控方法及系统。背景技术虚拟电厂概念的提出和逐步应用使得大量分布式资源越来越多地参与市场，利用其潜在灵活性为电网提供调峰服务等。评估聚合功率灵活性为VPP在实时调峰市场参与竞标提供重要的科学决策依据，然而目前大多数工作都将聚合功率灵活性描述为确定性优化模型，没有考虑它们的不确定性，无法满足分布式资源参与系统调度的实际需要。因此，如何描述DERs响应行为的不确定性，建立精度更高的灵活性评估模型以减少调度误差，实现对聚合资源的精确控制，还需要进一步研究。另外，由于VPP聚合的DER通常归属于不同的利益主体，当DER响应实时调峰信号并追求自身利益最大化时，就会发生利益冲突。在这种情况下，博弈论被广泛用于DER参与VPP的调令分解过程。但以往的博弈模型的计算复杂度会随着博弈者数量增加，有时只能达到局部最优解，当博弈者数量相当多时，可能会陷入"维度灾难"问题。在这种情况下，无法保证VPP收入分配的公平性和合理性。平均场博弈将无穷多玩家的非合作博弈转变为玩家自己与整个群体的博弈，可以克服维度灾难，保证收入分配的公平高效。然而，传统MFG的应用前提是假设参与者的响应能力是同质的，因此不适用于处理聚合大量异质DERs的VPP收益分配问题，无法对虚拟电厂各分布式资源进行精准调度。发明内容本发明的目的是提供一种基于平均场博弈的虚拟电厂实时调峰优化调控方法及系统，能够更准确的量化分布式资源的动态响应能力，实现VPP聚合功率灵活性的可信评估，能够准确的对虚拟电厂各分布式资源进行精准调度，减少调度误差。为实现上述目的，本发明提供了如下方案。第一方面，本申请提供一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，具体包括如下步骤。建立虚拟电厂运行模型；所述虚拟电厂运行模型包括可再生能源运行模型、温控负荷运行模型和电储能系统运行模型。基于所述虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率。根据所述聚合可调功率应用同质集群动态聚合方法将所述虚拟电厂的分布式资源划分为多个同质集群；各所述同质集群具有相同的调峰外特性；利用平均场博弈论确定每一所述同质集群的调峰调度电量。第二方面，本申请提供一种基于平均场博弈的虚拟电厂实时调峰优化调控系统，具体包括如下模块。虚拟电厂运行模型建立模块，用于建立虚拟电厂运行模型；所述虚拟电厂运行模型包括可再生能源运行模型、温控负荷运行模型和电储能系统运行模型。聚合可调功率评估模块，用于基于所述虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率。集群划分模块，用于根据所述聚合可调功率应用同质集群动态聚合方法将所述虚拟电厂的分布式资源划分为多个同质集群；各所述同质集群具有相同的调峰外特性。调峰调度电量确定模块，用于利用平均场博弈论确定每一所述同质集群的调峰调度电量。根据本发明提供的具体实施例，本发明公开了以下技术效果。本发明提供一种基于平均场博弈的虚拟电厂实时调峰优化调控方法及系统，基于虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率，根据聚合可调功率应用同质集群动态聚合方法将虚拟电厂的分布式资源划分为多个同质集群；利用平均场博弈论确定每一同质集群的调峰调度电量。其中，闵可夫斯基和以及内嵌直角棱锥评估法的应用建立了精度更高的灵活性评估模型从而减少聚合资源的调度误差，基于平均场博弈对虚拟电厂内的同质集群进行分布式资源分配，实现对聚合资源的精确控制及调度。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例1提供的一种基于平均场博弈的虚拟电厂实时调峰优化调控方法流程图。图2为本发明实施例1提供的具有大规模异构DERs的VPP架构。图3为本发明实施例1提供的闵可夫斯基和运算示意图。图4为本发明实施例1提供的内嵌直角棱锥近似的二维示意图。图5为本发明实施例1提供的同质集群的动态划分流程图。图6为本发明实施例1提供的基于MFG的激励机制示意图。图7为本发明实施例1提供的不同近似方法下的功率灵活性评估对比示意图。图8为本发明实施例1提供的存储电量变化曲线。图9为本发明实施例1提供的DER平均日收益随初始荷电量的变化曲线。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。本发明的目的是提供一种基于平均场博弈的虚拟电厂实时调峰优化调控方法及系统，能够更准确的量化分布式资源的动态响应能力，实现VPP聚合功率灵活性的可信评估，能够准确的对虚拟电厂各分布式资源进行精准调度，减少调度误差。为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图和具体实施方式对本发明作进一步详细的说明。实施例1如图1所示，本实施例提供一种基于平均场博弈的虚拟电厂实时调峰优化调控方法，具体包括如下步骤。S1：建立虚拟电厂运行模型；所述虚拟电厂运行模型包括可再生能源运行模型、温控负荷运行模型和电储能系统运行模型。首先建立虚拟电厂运行模型，如图2所示，聚合的分布式资源包含可再生能源、电储能系统和温控负荷。1）RESs运行模型。一般来说，由于不确定性的自然因素和人为因素，RESs的实际输出会围绕其预测值上下波动。根据概率论，RESs发电量可视为服从一定的概率分布的随机变量，满足如下式示出的模糊机会约束。 。式中，Pr{•}表示在{•}中事件“•”的置信度；和/＞分别为光伏发电和风力发电在t时刻的输出功率；/＞，/＞，和/＞分别代表PVs和WTs在给定置信度/＞下的出力上限/下限。在一定的置信度下，满足约束条件式的上限和下限是一定范围内的不确定值。为了找到随机变量/＞和/＞的最大波动区间，利用乐观值sup{•}和悲观值inf{•}，模糊机会约束被转化为其等效的确定性约束，如式。。式中，和/＞分别代表随机变量/＞和/＞的逆分布函数。从历史数据来看，WTs和PVs的在每个时间间隔的发电功率呈现正态分布。因此，随机变量和/＞的逆分布函数可用功率基线/＞，/＞和标准差/＞，/＞表示为式的表达式。。2）TCLs运行模型。在不同的室外温度下，TCL会切换到不同的运行模式。以夏季制冷模式为例进行分析。室内外温差引起的热传导是通过传统的房间集中式等效热参数模型来模拟的，制冷量引起的室温变化由TCL的连续模型描述，如下式所示。。其中，Troom表示室内温度；Tout表示室外温度；Prated表示空调额定功率；R表示房间等效热阻；C表示房间等效热容；表示空调能效比。Pcont表示TCL的运行功率。当TCL没有外部控制信号的情况下处于稳态时，制冷量与室内外传导的热量相平衡，因此室温Troom和TCL的运行功率Pcont在用户最舒适点保持不变。此时，TCL的稳态运行功率可根据如下式求解。。当施加外部控制信号时，考虑到房间的热惯性，TCL会迅速改变运行功率Pcont，使Troom达到设定温度。TCL的性能与储能设备类似，因此被建模为虚拟储能。以用户最舒适的状态作为储能的零点，可以得到单个TCL的虚拟储能模型，如下式。。式中，表示TCL的运行功率；/＞表示TCL的基线功率；/＞表示TCL的虚拟储能容量；Tcomf表示人体最舒适温度。由于用户对室温范围的偏好具有分布性，因此结合式可以得到给定置信度的Troom上下限，如式。。式中，表示Troom的下限；/＞表示Troom的上限；/＞表示人体舒适温度标准差。因此，TCL虚拟储能容量的上下限如式。。3）ESSs运行模型。ESSs作为可控资源有明确的参数，如容量、功率输出范围等，虚拟电厂VPP运营商根据其资源参数确定其可调容量，调度后表现为可控资源的充放电功率，如式。。式中，和/＞分别为ESS的消耗功率和基准功率；/＞和代表充/放电功率，满足如下式的约束。。式中，为ESS的储能荷电状态；/＞为储能充放电效率；PL和EL分别为功率限值和能量限值。本发明的方法描述DERs响应行为的不确定性，进行建立精度更高的灵活性评估模型从而减少聚合资源的调度误差，实现对聚合资源的精确控制。描述DERs响应行为的不确定性：对于可再生能源发电的不确定性，用模糊机会约束描述，如式；对于TCL的用能不确定性，用随机分布函数描述用户对室温范围的偏好，如式。S2：基于所述虚拟电厂运行模型应用闵可夫斯基和以及内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率。首先基于虚拟电厂的运行模型，DERi的时间耦合功率约束可以看作T维凸集。。式中，为系数矩阵；/＞表示实数集；K代表一个时间间隔内的约束数量；为常数矩阵；T为时间间隔总数；/＞和/＞分别为DER i的功率和能量向量。接着，采用闵可夫斯基和将凸集/＞映射到随机聚合功率集/＞。。式中，表示虚拟电厂在给定置信度/＞下的随机聚合功率集；n为分布式资源的数量；/＞表示分布式资源n的运行功率；PVPP表示虚拟电厂的运行功率；闵可夫斯基和/＞是欧几里得空间中点集的总和。以点集M和N为例，闵可夫斯基和被定义为式。。对于连续集M和N而言，如图3所示，对应集合M的几何表达，/＞对应集合N的几何表达。闵科夫斯基和的几何表达是集合M沿着集合N的边缘做一次连续运动所扫过的区域与集合N本身的并集。。式中，pM,t，pM,t+1，pN,t和pN,t+1分别代表集合M和集合N在t时刻和t+1时刻的运行功率。pt和pt+1对应到本发明中可理解为由两类DERs构成的虚拟电厂在t时刻和t+1时刻的运行功率。由于VPP的运行模型中储能随时间变化，用闵可夫斯基和得到的随机聚合灵活性具有时间耦合性，可以将抽象为一个高维聚合功率多面体。然而，随着时间间隔数量的增加，用闵可夫斯基和获得聚合功率多面体/＞在计算上比较困难。因此，从空间几何角度简化聚合功率约束空间，如下式。。式中，t=1，2，...，T；表示给定置信度/＞下，VPP在t时刻的运行功率可调范围大小。/＞表示给定置信度/＞下，VPP的初始功率。/＞表示给定置信度/＞下，VPP在t时刻的运行功率最大值。下面公式描绘了一个在不规则的高维聚合功率多面体中最大内嵌T维直角棱锥/＞，其直角顶点位于初始功率点/＞。此时，基于所述聚合功率空间约束，将所述虚拟电厂的虚拟储能模型等效为所述聚合功率多面体中最大T维直角棱锥。VPP等效为虚拟储能的建模如下式。。式中，表示在给定置信度/＞下的聚合可调功率；/＞为时间间隔集合；和/＞为给定置信度α下，虚拟电厂VPP的运行功率上下限值；EVPP表示虚拟电厂VPP的能量存储；/＞和/＞为给定置信度α下，虚拟电厂VPP的能量存储上下限值，计算如下式。。内嵌直角棱锥在不同时间间隔的功率上下限相互独立，实现了随机聚合功率的时间解耦。因此，最大的内嵌直角棱锥可以映射到时间坐标上，每个时间段的功率区间组合成一个盒形的可行区域，如图4所示，即VPP的近似随机聚合功率灵活性。。S3：根据所述聚合可调功率应用同质集群动态聚合方法将所述虚拟电厂的分布式资源划分为多个同质集群；各所述同质集群具有相同的调峰外特性。可再生能源出力和TCL需求的不确定性使得聚合功率区域具有随机性，从而导致了VPP在实时调峰市场中的收益伴随着一定风险。由于VPP倾向于在降低风险的同时追求自身效益最大化，因此基于多目标优化理论，VPP的最优调峰竞价可表述为条件风险值优化模型。。式中，为决策变量；b为函数f的阈值；表示VPP在实时调峰市场的投标功率；/＞为考虑源-荷双端不确定性的随机向量；/＞为随机变量y的概率密度函数；Mcos和Mpro分别为VPP的成本和收益；/＞为VPP的功率基线；/＞，/＞，/＞和/＞表示VPP提供削峰和填谷服务的单位成本和投标价格；/＞表示最大值运算/＞；同理表示最大值运算/＞。/＞表示充电基准功率；表示放电基准功率。根据VPP和其他市场参与者的投标量和投标价格，实时调峰市场运营商分析得到出清结果，即出清功率和削峰及填谷对应的出清价格/＞。典型MFG应用的基本假设是参与者的同质性，即只有当不同参与者具有相似的动态方程和参数时，平均场才能用于描述海量参与者之间的相互作用。事实上，在实际应用中，由VPP管理的大量DERs很少是完全同质的。因此，为了在平均场方程中处理大规模分散DERs的异质性，首先利用同质集群的动态划分技术将大规模DERs聚类为具有相似响应特性的较小子集，在任意时段的划分流程如图5所示。作为一种可选的实施方式，步骤S3具体包括：：将所述虚拟电厂的各所述分布式资源构成分布式资源集合V。：根据基准的聚合功率上调量和基准的聚合功率下调量确定集群划分中心的第一特征向量。：对当前所述分布式资源集合中的各所述分布式资源进行随机组合，得到分布式资源组合。：计算当前所述分布式资源组合的所述聚合可调功率，并根据所述分布式资源组合的所述聚合可调功率等效当前所述分布式资源组合的虚拟储能模型；根据当前所述分布式资源组合的虚拟储能模型的调峰外特性的聚合可上调功率和聚合可下调功率计算当前所述分布式资源组合的第二特征向量。根据式-对随机选取的DERs进行聚合功率计算，将分布式资源组合等效为满足以下功率约束的虚拟储能模型。。式中，和/＞表示分布式资源组合/＞的运行功率上下限；Pc和Ec表示分布式资源组合/＞的运行功率和虚拟储能量。本实施中，DER聚合指标主要服务于VPP内部调峰激励机制，DER获得的激励应当取决于其对VPP提供调峰服务的经济贡献。因此，选取体现分布式资源组合调峰外特性的聚合可上调功率、可下调功率为动态聚类指标并利用下式计算。。其中，表示分布式资源组合/＞的基准功率；/＞表示分布式资源组合/＞的运行功率下限；/＞表示分布式资源组合/＞的运行功率上限。由于各指标数据大小相差较远，需要进行归一化处理。。式中，和/＞分别为样本点和集群划分中心的归一化聚类指标；/＞和/＞，分别为基准的聚合功率下调量和上调量；，表示最大上调功率；/＞，表示最大下调功率。样本点和集群划分中心的特征向量由归一化的特征量构成，如式所示。。：根据所述第一特征向量和所述第二特征向量计算所述集群划分中心和当前所述分布式资源组合的欧式距离。每个时间间隔内样本点和集群划分中心欧氏距离计算公式如下：。：判断所述欧式距离是否小于预设值，得到第一判断结果。若所述第一判断结果为否，则返回步骤“对当前所述分布式资源集合中的各所述分布式资源进行随机组合”。若所述第一判断结果为是，则执行步骤：将当前所述分布式资源组合Ac视为一个所述同质集群Ah；将当前所述分布式资源组合的各所述分布式资源从当前所述分布式资源集合中去除。：判断当前去除后的分布式资源集合是否为空集，得到第二判断结果。若所述第二判断结果为否，则令当前所述去除后的分布式资源集合为当前所述分布式资源集合，返回步骤“对当前所述分布式资源集合中的各所述分布式资源进行随机组合”，继续确定下一个同质集群Ah+1。若所述第二判断结果为是，则执行步骤：输出所有所述同质集群，记为N个同质集群。在的约束下，集群划分得到的N个组合可视为调峰外特性相同的同质集群，其调峰外特性如下式。。式中，h=1，2，...，N；Ph和Eh为同质集群的充/放电功率和能量存储。/＞表示同质集群运行功率下限绝对值；/＞表示同质集群运行功率上限。S4：利用平均场博弈论确定每一所述同质集群的调峰调度电量。1）平均场VPP各时段的调峰电量应分解分配给理性的DER集群，DER集群在追求自身利益最大化的同时，有义务承担VPP的调峰任务。DER集群之间的博弈本质上是通过协商确定最优的电量和利益分配方案。根据式中的动态方程，DER集群的控制策略随时间变化。因此，最大化各个聚合商激励报酬的过程可以表示为一个动态博弈模型，即，其中，/＞表示参与博弈的DER集群集合，/＞表示同质集群/＞的控制空间，/＞表示同质集群/＞的状态，表示同质集群/＞的值函数。d=1，2，...，N。定义状态：令表示所有同质集群的联合状态，在时间t下聚合商/＞的状态表示为同质集群/＞的能量存储/＞。定义控制空间：令表示所有同质集群的联合控制空间，在时间t下聚合商的控制空间表示为/＞。/＞和/＞表示同质集群/＞的削峰功率和填谷功率。定义值函数：在给定时间窗口内，以聚合商的平均激励报酬为值函数。。式中，为期望函数；/＞即为/＞，表示为同质集群/＞在时间t的控制空间；/＞即为/＞，表示为除了集群/＞以外的集群在时间t的控制向量；/＞和/＞为同质集群/＞的单位削峰和填谷激励。同质集群根据自己在时间t的虚拟荷电状态以及当前的调峰激励电价，寻求能够最大化平均激励报酬的充放电策略/＞。因此，本发明将该最优控制问题定义为P1。。至此构建出MFG模型。式中，为除了集群/＞之外的所有DER集群的控制策略。为了求解P1得到最佳策略，首先基于MFG模型和贝尔曼最优控制理论，定义贝尔曼价值函数为：。接着，代入状态变量Ed，通过偏微分方程建模得到表述DER集群最优控制的Hamilton-Jacobi-Bellman 方程为：。令HJB方程等于0求解得出集群当前最优的控制空间/＞和/＞。当动态博弈涉及大量参与者时，单个参与者的行动对其他参与者的影响变得微不足道。然而，大规模对每个参与者决策的影响是显著的，可将其模拟为集体效应，即平均场。平均场用所有DER集群的状态概率分布来描述整个群体的状态动态。。式中，为平均场概率密度函数；/＞为狄拉克函数，满足给定条件时取值为1，否则取值为0。2)平均场项首先，激励价格不是临时设计的，而是根据DER集群的谈判过程得出的。假设VPP运营商采用动态激励定价机制，即调峰量越多，调峰激励也随之增长，反之亦然。当有多个DER集群提供调峰服务时，除了本身的削峰和填谷基本价格和/＞外，还需要考虑其他集群竞争带来的价格增益。因此，本实施例中，根据DER集群的调整量定义每个集群的调峰激励价格为式。。式中，和/＞为将平均调峰量转换为削峰和填谷激励价格的参数；/＞和表示除集群/＞以外的其他集群/＞的削峰功率和填谷功率。接着，由于DER集群经过动态同质集群划分，均满足MFG中参与者同质性的假设。因此在本实施例中，DER集群变量的下标d可以去掉。因为参与者的状态具有互换性，即两个状态相同的参与者具有一样的的决策结果。因此，状态/＞的下标可以去掉，且最优策略可以定义为/＞，该策略适合每一个参与者。根据MFG的最佳策略/＞和平均场概率密度函数/＞，重新定义受到平均场影响的平均场项，即激励价格函数/＞和为式。。此外，DER的调峰量和调峰激励必须考虑VPP在调峰市场中的出清结果。。式中，表示预期的单位削峰成本；/＞表示预期的单位填谷成本。/＞表示出清功率；/＞表示削峰及填谷对应的出清价格。根据平均场项，DER集群在时间t的激励报酬最终为下式。。其中，和/＞表示每一同质集群的单位削峰激励和填谷激励；/＞和表示每一同质集群的削峰功率和填谷功率。3）偏微分方程组如图6所示，VPP的投标调峰电力分配问题可模拟为一个MFG。在MFG中，每个DER聚合器代表代理DER的利益，旨在独立、合理地优化自身效用。为此，每个聚合器与平均场互动，而不是参与点对点互动，从而将N体复杂性简化为2体复杂性，根植于两个基本偏微分方程HJB和FPK。从本质上讲，HJB方程控制着DER聚合器与平均场之间的相互作用，而FPK方程则控制着平均场响应聚合器行动的演变。这两个方程是强耦合的，也分别称为后向方程和前向方程。根据式，MFG模型下的HJB方程如下，去掉了式中下角标d。。描述DER集群状态分布的Fokker-Planck-Kolmogorov方程可表示为：。式中，和/＞分别表示拉普拉斯算子和梯度。将状态的动态方程代入，FPK方程可进一步表示为：。式是为了验证平均场m是否满足式的等式，从而确定当前求解得出的控制空间是否是最终的最优策略。作为一种可选的实施方式，步骤S4具体包括：：对每一所述同质集群，令所述同质集群的能量存储表示所述同质集群的状态；令所述同质集群的削峰功率和填谷功率表示所述同质集群的控制变量；在给定时间窗口内，以所述同质集群的平均激励报酬为值函数；所述平均激励报酬的表达式的参数中包括所述削峰功率和所述填谷功率以及各自对应的激励价格。：对每一所述同质集群，根据所述同质集群的当前状态和当前调峰奖励电价，确定最大化平均激励报酬的最优控制策略的表达式。：根据每一所述同质集群的当前状态确定所有所述同质集群的平均场概率密度函数）；所述平均场概率密度函数用于描述所有所述同质集群整体的状态动态。：对每一所述同质集群，根据所述同质集群的当前状态和贝尔曼价值函数）得到表述同质集群最优控制的HJB方程），并求解所述HJB方程得到每一所述同质集群当前最优调峰量；所述贝尔曼价值函数是根据当前最大化平均激励报酬的所述最优控制策略的表达式和贝尔曼最优控制理论定义得出的。：对每一所述同质集群，将当前所述最优调峰量带入所述同质集群的调峰外特性表达式）中，得到所述同质集群的更新状态。：将每一所述同质集群的更新状态带入所述平均场概率密度函数）中，得到当前平均场概率密度函数值。：判断当前所述平均场概率密度函数值是否满足FPK等式方程，得到第三判断结果。若所述第三判断结果为是，则执行：输出每一所述同质集群的当前所述最优调峰量，得到最优的调峰调度电量。进而根据式计算对应的平均场概率密度函数值，再应用式得到最优的激励价格。若所述第三判断结果为否，则执行：对每一所述同质集群，根据当前所述最优调峰量和当前所述平均场概率密度函数值得到每一所述同质集群的激励价格；所述激励价格包括削峰激励价格和填谷激励价格；并令所述同质集群的更新状态为所述同质集群的当前状态，返回步骤“根据所述同质集群的当前状态和贝尔曼价值函数得到表述同质集群最优控制的HJB方程”。本实施例中，解决的是VPP聚合功率灵活性的可信评估及其收益分配问题。首先，将可再生能源发电量和温控负荷用电量建模为满足模糊机会约束的随机变量。接着利用闵可夫斯基将DERs的约束集加和成为高维多面体，通过寻找多面体中最大内嵌直角棱锥，将VPP在不同时间间隔的调峰外特性解耦，得到VPP的随机聚合功率灵活性。然后，采用同质集群的动态聚合方法将VPP内部的异质DERs划分为多个具有同质集群。最后基于MFG确定VPP内同质集群的最优的调峰调度电量以实现收益分配，通过这种方法，每个DER可以独立地优化其控制策略而无需与其他DER进行任何信息交换，既可以保证对聚合资源的精确控制及调度，也保障了VPP收入分配的公平性和合理性。本实施例的有益效果：1）基于聚合可调功率灵活性可信评估进行同质集群的动态划分方法充分考虑了分布式资源发电与负荷用能行为的随机性，从几何角度将VPP划分为大量具有相同功率灵活性的DER集群，为DERs进行MFG提供前提条件；2）基于MFG理论和动态集群的可调功率评估结果，进一步提出了VPP参与实时调峰的收益分配和调令分解模型。与传统博弈方式相比，MFG大大减少了计算量，为VPP的投标决策提供了新方案。以下基于本实施例方法的仿真结果。在配备Intel Xeon CPU和12GB RAM的HP Z600机器上，在MATLAB环境中运行了仿真模型，时间步长设置为15 min。单次仿真在大约4小时内完成，如果拉长时间步长，仿真时间会明显缩短，当时间步长设置为1h时，单次仿真在大约10min内完成。图7给出了不同近似方法下的VPP聚合功率灵活性的可信评估结果，其中，图7中，部分-部分使用了内嵌长方体法，图7中，部分-部分使用了内嵌直角棱锥法。图7中，部分中Tvf1和Tvf2分别为填谷时段1和填谷时段2，Tpf1和Tpf2分别为削峰时段1和削峰时段2。对比同一置信度下的评估结果，可以看出采用内嵌直角棱锥法后，填谷时段的上调功率范围和削峰时段的下调功率范围的聚类结果都得到了改善，仿真结果表明，在=50%、/＞=70%和/＞=90%的情况下，采用内嵌直角棱锥法的整体可调度功率范围比内嵌长方体法分别增加了3.42%、3.75%和4.29%，这反映了内嵌直角棱锥法对灵活性评估准确度的提升。为了体现集群额定功率对收益分配的影响，设置以下两个场景。场景A：同质集群总数NA=5×105，虚拟储能额定容量ErA=20 kwh，虚拟储能额定充放电功率PrA=2 kw。场景B：同质集群总数NB=5×105，虚拟储能额定容量ErB=30 kwh，虚拟储能额定充放电功率PrB=3 kw。对于建模为虚拟储能的DER集群来说，不同初始存储电量对应的能量轨迹如图8所示。正如预期的那样，每个集群都基于当前的调峰价格进行充电/放电，在24小时内返回其初始充电状态。一般来说，由于调峰时段约束，对于以低充电状态开始的集群来说更有利可图。如图9所示，在场景A和场景B中，JDA表示场景A下的日收益，JDB表示场景B下的日收益，日收益均随初始荷电量S=E/Er的降低而下降，E表示虚拟储能初始荷电容量，Er指ErA或ErB。对比场景A和场景B发现，具有较低额定功率的DER集群利润也较低，这与实际情况相符，进一步验证了MFG模型的可行性。实施例2本实施例提供一种基于平均场博弈的虚拟电厂实时调峰优化调控系统，所述系统包括：虚拟电厂运行模型建立模块，用于建立虚拟电厂运行模型；所述虚拟电厂运行模型包括可再生能源运行模型、温控负荷运行模型和电储能系统运行模型。聚合可调功率评估模块，用于基于所述虚拟电厂运行模型应用闵可夫斯基和和内嵌直角棱锥评估法评估虚拟电厂的聚合可调功率；所述聚合可调功率用于实现对所述虚拟电厂中各分布式资源的调峰电量进行调度。所述系统还包括：集群划分模块，用于根据所述聚合可调功率应用同质集群动态聚合方法将所述虚拟电厂的分布式资源划分为多个同质集群；各所述同质集群具有相同的调峰外特性。调峰调度电量确定模块，用于利用平均场博弈论确定每一所述同质集群的调峰调度电量。每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似部分互相参见即可。对于实施例公开的系统而言，由于其与实施例公开的方法相对应，所以描述的比较简单，相关之处参见方法部分说明即可。本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处。综上所述，本说明书内容不应理解为对本发明的限制。
