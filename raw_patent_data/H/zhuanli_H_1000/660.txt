标题title
风电场电池容量优化配置方法、装置、设备及介质
摘要abst
本发明涉及储能优化配置技术领域，尤其涉及一种风电场电池容量优化配置方法、装置、设备及介质，包括：结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建考虑储能成本的规划层模型；以风机与储能的调频功率最佳分配为目标，构建考虑风机储能协同调频成本的运行层模型；联合规划层模型和运行层模型，构建容量优化配置模型，并嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法，嵌套数学规划优化器求解电池容量最优配置方案。本发明在实现平抑波动需求的同时利用储能剩余功率参与风电场调频备用，可以有效提高电池利用率和储能效益。
权利要求书clms
1.一种风电场电池容量优化配置方法，其特征在于，包括如下步骤：结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建考虑储能成本的规划层模型；以风机与储能的调频功率最佳分配为目标，构建考虑风机储能协同调频成本的运行层模型；联合所述规划层模型和运行层模型，构建容量优化配置模型，并嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法，嵌套数学规划优化器求解电池容量最优配置方案。2.根据权利要求1所述的风电场电池容量优化配置方法，其特征在于，所述规划层模型包括：构建储能参与双场景的目标函数：；其中，fou为储能年均效用，Sflu为储能平抑风功率波动效用，Bfre为储能辅助一次调频效用，Clife为储能等年值成本；其中：；；式中，S1为惩罚减免费用；S2为增发上网电量效用；PW为t时刻的风机原始出力；PG为t时刻风电场实际并网功率；cqf为单位弃风惩罚费用；cqd单位缺电惩罚费用；Δt为采样周期；T全年运行时间；cw为风电场单位上网电价，当配置储能后风电场所年均增加的发电量为正时，此项为正，即获得效用；反之为负，即承担成本；；；其中，B1为调频服务效用；B2储能购电成本；B3储能调频充放电损耗成本；ktp为调频服务费用；Pbup、Pbdown为储能向上、向下调频功率；abuy、asell 分别为储能购电和售电单价；ηc和ηd分别为储能的充电和放电效率；；；其中，Cinve为储能建设投资成本；Cmain为储能运行维护成本；LY为现值系数，表示储能维护成本随使用寿命的变化系数，Creco为回收成本；Etotal为储能电池组最大额定总容量；Pr为储能电池组最大额定充放电功率；cei为单位容量电池的投资成本；cpi为单位功率变流器的投资成本；cem为单位容量电池的运行维护成本；cpm为单位功率电池的运行维护成本；crec为报废成本比；b为折现率；Y为储能电池的寿命；电池使用寿命为电池以额定放电深度在寿命周期下的总放电量与折算成额定放电深度的年放电量之比：；其中，DODr为额定放电深度；Er为电池额定容量；E为电池第i次切换阶段实际放电量；Nr为额定放电深度下的电池循环次数；I为放电阶段计数；N 为第i个放电阶段实际放电深度下的电池循环次数。3.根据权利要求2所述的风电场电池容量优化配置方法，其特征在于，所述规划层模型还包括：风电并网功率波动约束条件：；其中，PG为风电机组实际出力；PWN为风电场装机容量；ab为并网波动率限制值，表示风电场出力在固定时间间隔内功率变化率不应超过其装机容量某个比例；储能约束条件：；；；其中，Smin为电池剩电量下限；S为t时刻电池剩余电量，Er为电池额定容量；Pmin为使风电功率波动满足限定标准所需的平抑功率；Pr为储能电池组最大额定充放电功率；Ψmax、Ψmin为电池SOC的最大值、最小值。4.根据权利要求1所述的风电场电池容量优化配置方法，其特征在于，所述运行层模型包括：考虑全年一次调频综合成本的目标函数：；；其中，fin为全年一次调频综合成本；W1为风电减载备用成本，W2为风电调频成本； B2为储能调频购电成本；B3为储能调频充放电损耗成本；B4为调频不足惩罚成本，cw为风电场单位上网电价；Pgref为第t时刻风电场理论并网初始参考功率；Pwdown为风电机组向下调频功率；ape为系统调频不足惩罚单价；Pp2为储能一次调频功率，Pde为风电场最优减载有功输出，表达式如下所示；；式中，Pact为风储系统提供的实际总调频功率；Pins为风电场调频需求功率，表达式如下所示；；；其中，dopt为风电场最优减载率；Pwup、Pwdown为风机向上向下调频功率；f为t时刻系统实际采样频率；fN为系统额定频率；Rt为调差系数。5.根据权利要求4所述的风电场电池容量优化配置方法，其特征在于，所述运行层模型还包括：储能调频功率约束条件：；；其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为向上、向下调频的状态控制变量，为1时表示参与系统调频，为0时表示不参与系统调频，Pup_max、Pdown_max为储能向上、向下调频功率不能超过的申报上限，表达式如下所示：；其中，Pimax、Pomax为设定的储能最大总充电、放电功率；δin、δout为储能调频充放电功率分配系数；Ps为抑波功率作用域，计算式如下：；风电场减载功率约束条件：；其中， dmax为最大减载率；Pde_max为风电场最大减载功率；风机调频功率约束条件：；其中，Pgref为风电场理论出力；Pde为最优减载功率；Pde_max为最大减载功率；调频能力约束条件：要求风储系统满足调频需求的概率大于设定的置信度β1，对于第i次调频，设置 0-1 变量m：；若风储系统满足调频需求，则m取1，否则取0，以频率代替概率，调频能力约束为：。6.根据权利要求1所述的风电场电池容量优化配置方法，其特征在于，所述更新并网优化参考功率，包括如下步骤：采用变分模态分解法分解风电原始功率后，基于中心频率区分高频、中频和低频分量，根据风电场接入电力系统规定波动指标，取中低频分量为理论并网初始参考功率Pgref，变分模型如下：；其中，{uk}为IMF分量；{ωk}为中心频率；δ为脉冲函数；f为原始输入信号；将理论并网初始参考功率传入嵌入的电池分组控制策略与变分模态分解法，优化计算得到风电场需要执行的向上向下调频量与动态减载量，更新并网初始参考功率获得并网优化参考功率Pgopt，进而获得储能平抑波动所需的最优充放电功率Pp1；当平抑功率为正值时，需要电池放电以补充缺额；当平抑功率为负值时，电池充电以吸收余额；并网优化参考功率Pgopt与储能最优抑波功率Pp1计算式如下：；；其中，Pde风电场最优减载有功输出；Pwup、Pwdown为风机向上向下调频功率；PW为风机原始出力；内层模型同时还计算得到储能所需提供的一次调频功率Pp2；当系统频率过高，储能向下调频即吸收功率；当系统频率过低，储能向上调频时即发出功率，因此储能调频功率表达式为：；其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为储能向上、向下调频的状态控制变量；储能跟踪的总充放电功率Psum包括储能抑波功率Pp1以及储能调频功率Pp2，其整体充放电功率表达式如下所示：；；其中，Pch、Pdis为t时刻的储能总计充电功率、放电功率；嵌入分组充放电电池控制策略：初始时刻BESS1从电网吸收功率，作为充电电池组；BESS2向电网输出功率，为放电电池组；表达式如下所示：；若BESS2放电量多，率先达到SOC下限，则BESS2立即与BESS1交换充放电角色，即BESS1担任放电电池组，BESS2担任充电电池组，表达式如下所示：；其中，Pb1、Pb2为BESS1、BESS2在t时刻的出力。7.根据权利要求1所述的风电场电池容量优化配置方法，其特征在于，所述改进粒子群算法，包括如下步骤：粒子群算法中粒子更新过程如下：；其中，w为惯性权重；c1、c2为学习因子；r1、r2为区间中的随机数；为第i个粒子第d维第k次迭代的位置和速度；/＞为个体极值和全局极值；在完成个体更新和群体最优更新后，前期进行反向学习，同时考虑当前方向和相反方向的解以更快逼近全局最优，公式如下所示：；若粒子超出范围，则重新初始化：；其中，是当下种群最优个体由反向学习策略得到的新解；/＞与/＞是最大边界值和最小边界值；k为区间中的随机数；后期采用差分进化的变异和交叉策略进行改进寻优，变异过程如下所示：；交叉操作如下所示：；其中，zi,d为变异向量；F为缩放因子；m1、m2为区间中的随机数，N为种群总规模；ui,d为试探向量ui的第d维；C为交叉概率；ni为区间中的随机整数，D为粒子群的总维度。8.一种风电场电池容量优化配置装置，其特征在于，使用如权利要求1至7中任一项所述的方法，包括：规划模型建立单元，所述规划模型建立单元用于结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建考虑储能成本的规划层模型；运行模型建立单元，所述运行单元建立单元用于以风机与储能的调频功率最佳分配为目标，构建考虑风机储能协同调频成本的运行层模型；双层模型单元，所述双层模型单元用于联合所述规划层模型和运行层模型，构建容量优化配置模型，并嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；求解单元，所述求解单元用于采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法，嵌套数学规划优化器求解电池容量最优配置方案。9.一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时，实现如权利要求1-7中任一项所述的方法。10.一种存储介质，其上存储有计算机程序，其特征在于，该计算机程序被处理器执行时实现如权利要求1-7中任一项所述的方法。
说明书desc
技术领域本发明涉及储能优化配置技术领域，尤其涉及一种风电场电池容量优化配置方法、装置、设备及介质。背景技术随着风电的大规模并网，其出力的不确定特性对电网的安全稳定运行是一大挑战，为了提升安全稳定性，新标准要求风电并网技术由“被动适应”向“主动支持”“自主运行”转变，风力发电厂的参与调频调节的能力有逐渐提高的趋势。对此可以装配储能设备并制定合理的运行策略，不仅能够有效平滑风电场的功率输出波动，还能辅助一次调频，从而增强电网运行安全稳定性。而考虑到系统总体经济性，储能配置容量应在满足需求的前提下尽可能小，因此，风储系统中的电池储能最优配置方案具有重要的研究意义。为了使风电场具备快速频率调节能力，主要有预留后备和增设储能两种方式。传统的备用方式成本和弃风量大，因此，发展风储联合系统是一种更经济实用的方案。现有技术中大多研究储能参与单一工况的配置问题，储能的作用没有得到充分的利用。并且现有研究中抑波工况下的并网参考功率通常只在考虑波动指标的情况下采用分段平均、滤波、分解等方法平抑风电高频出力，但实际风电场可能还需要参与一次调频，以上传统方法不能根据系统实际情况实时更新并网参考功率。公开于该背景技术部分的信息仅仅旨在加深对本发明的总体背景技术的理解，而不应当被视为承认或以任何形式暗示该信息构成已为本领域技术人员所公知的现有技术。发明内容本发明提供了一种风电场电池容量优化配置方法、装置、设备及介质，从而有效解决背景技术中的问题。为了达到上述目的，本发明所采用的技术方案是：一种风电场电池容量优化配置方法，包括如下步骤：结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建考虑储能成本的规划层模型；以风机与储能的调频功率最佳分配为目标，构建考虑风机储能协同调频成本的运行层模型；联合所述规划层模型和运行层模型，构建容量优化配置模型，并嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法，嵌套数学规划优化器求解电池容量最优配置方案。进一步地，所述规划层模型包括：构建储能参与双场景的目标函数：；其中，fou为储能年均效用，Sflu为储能平抑风功率波动效用，Bfre为储能辅助一次调频效用，Clife为储能等年值成本；其中：；；式中，S1为惩罚减免费用；S2为增发上网电量效用；PW为t时刻的风机原始出力；PG 为t时刻风电场实际并网功率；cqf为单位弃风惩罚费用；cqd单位缺电惩罚费用；Δt为采样周期；T全年运行时间；cw为风电场单位上网电价，当配置储能后风电场所年均增加的发电量为正时，此项为正，即获得效用；反之为负，即承担成本；；；其中，B1为调频服务效用；B2储能购电成本；B3储能调频充放电损耗成本；ktp为调频服务费用；Pbup、Pbdown为储能向上、向下调频功率；abuy、asell分别为储能购电和售电单价；ηc和ηd分别为储能的充电和放电效率；；；其中，Cinve为储能建设投资成本；Cmain为储能运行维护成本；LY为现值系数，表示储能维护成本随使用寿命的变化系数，Creco为回收成本；Etotal为储能电池组最大额定总容量；Pr为储能电池组最大额定充放电功率；cei为单位容量电池的投资成本；cpi为单位功率变流器的投资成本；cem为单位容量电池的运行维护成本；cpm为单位功率电池的运行维护成本；crec为报废成本比；b为折现率；Y为储能电池的寿命；电池使用寿命为电池以额定放电深度在寿命周期下的总放电量与折算成额定放电深度的年放电量之比：；其中，DODr为额定放电深度；Er为电池额定容量；E为电池第i次切换阶段实际放电量；Nr为额定放电深度下的电池循环次数；I为放电阶段计数；N 为第i个放电阶段实际放电深度下的电池循环次数。进一步地，所述规划层模型还包括：风电并网功率波动约束条件：；其中，PG为风电机组实际出力；PWN为风电场装机容量；ab为并网波动率限制值，表示风电场出力在固定时间间隔内功率变化率不应超过其装机容量某个比例；储能约束条件：；；；其中，Smin为电池剩电量下限；S为t时刻电池剩余电量，Er为电池额定容量；Pmin为使风电功率波动满足限定标准所需的平抑功率；Pr为储能电池组最大额定充放电功率；Ψmax、Ψmin为电池SOC的最大值、最小值。进一步地，所述运行层模型包括：考虑全年一次调频综合成本的目标函数：；；其中，fin为全年一次调频综合成本；W1为风电减载备用成本，W2为风电调频成本；B2为储能调频购电成本；B3为储能调频充放电损耗成本；B4为调频不足惩罚成本，cw为风电场单位上网电价；Pgref为第t时刻风电场理论并网初始参考功率；Pwdown为风电机组向下调频功率；ape为系统调频不足惩罚单价；Pp2为储能一次调频功率，Pde为风电场最优减载有功输出，表达式如下所示；；式中，Pact为风储系统提供的实际总调频功率；Pins为风电场调频需求功率，表达式如下所示；；；其中，dopt为风电场最优减载率；Pwup、Pwdown为风机向上向下调频功率；f为t时刻系统实际采样频率；fN为系统额定频率；Rt为调差系数。进一步地，所述运行层模型还包括：储能调频功率约束条件：；；其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为向上、向下调频的状态控制变量，为1时表示参与系统调频，为0时表示不参与系统调频，Pup_max、Pdown_max为储能向上、向下调频功率不能超过的申报上限，表达式如下所示：；其中，Pimax、Pomax为设定的储能最大总充电、放电功率；δin、δout为储能调频充放电功率分配系数；Ps为抑波功率作用域，计算式如下：；风电场减载功率约束条件：；其中，dmax为最大减载率；Pde_max为风电场最大减载功率；风机调频功率约束条件：；其中，Pgref为风电场理论出力；Pde为最优减载功率；Pde_max为最大减载功率；调频能力约束条件：要求风储系统满足调频需求的概率大于设定的置信度β1，对于第i次调频，设置0-1 变量m：；若风储系统满足调频需求，则m取1，否则取0，以频率代替概率，调频能力约束为：。进一步地，所述更新并网优化参考功率，包括如下步骤：采用变分模态分解法分解风电原始功率后，基于中心频率区分高频、中频和低频分量，根据风电场接入电力系统规定波动指标，取中低频分量为理论并网初始参考功率Pgref，变分模型如下：；其中，{uk}为IMF分量；{ωk}为中心频率；δ为脉冲函数；f为原始输入信号；将理论并网初始参考功率传入嵌入的电池分组控制策略与变分模态分解法，优化计算得到风电场需要执行的向上向下调频量与动态减载量，更新并网初始参考功率获得并网优化参考功率Pgopt，进而获得储能平抑波动所需的最优充放电功率Pp1；当平抑功率为正值时，需要电池放电以补充缺额；当平抑功率为负值时，电池充电以吸收余额；并网优化参考功率Pgopt与储能最优抑波功率Pp1计算式如下：；；其中，Pde风电场最优减载有功输出；Pwup、Pwdown为风机向上向下调频功率；PW为风机原始出力；内层模型同时还计算得到储能所需提供的一次调频功率Pp2；当系统频率过高，储能向下调频即吸收功率；当系统频率过低，储能向上调频时即发出功率，因此储能调频功率表达式为：；其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为储能向上、向下调频的状态控制变量；储能跟踪的总充放电功率Psum包括储能抑波功率Pp1以及储能调频功率Pp2，其整体充放电功率表达式如下所示：；；其中，Pch、Pdis为t时刻的储能总计充电功率、放电功率；嵌入分组充放电电池控制策略：初始时刻BESS1从电网吸收功率，作为充电电池组；BESS2向电网输出功率，为放电电池组；表达式如下所示：；若BESS2放电量多，率先达到SOC下限，则BESS2立即与BESS1交换充放电角色，即BESS1担任放电电池组，BESS2担任充电电池组，表达式如下所示：；其中，Pb1、Pb2为BESS1、BESS2在t时刻的出力。进一步地，所述改进粒子群算法，包括如下步骤：粒子群算法中粒子更新过程如下：；其中，w为惯性权重；c1、c2为学习因子；r1、r2为区间中的随机数；为第i个粒子第d维第k次迭代的位置和速度；/＞为个体极值和全局极值；在完成个体更新和群体最优更新后，前期进行反向学习，同时考虑当前方向和相反方向的解以更快逼近全局最优，公式如下所示：；若粒子超出范围，则重新初始化：；其中，是当下种群最优个体由反向学习策略得到的新解；/＞与/＞是最大边界值和最小边界值；k为区间中的随机数；后期采用差分进化的变异和交叉策略进行改进寻优，变异过程如下所示：；交叉操作如下所示：；其中，zi,d为变异向量；F为缩放因子；m1、m2为区间中的随机数，N为种群总规模；ui,d为试探向量ui的第d维；C为交叉概率；ni为区间中的随机整数，D为粒子群的总维度。本发明还包括一种风电场电池容量优化配置装置，使用如上述的方法，包括：规划模型建立单元，所述规划模型建立单元用于结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建考虑储能成本的规划层模型；运行模型建立单元，所述运行单元建立单元用于以风机与储能的调频功率最佳分配为目标，构建考虑风机储能协同调频成本的运行层模型；双层模型单元，所述双层模型单元用于联合所述规划层模型和运行层模型，构建容量优化配置模型，并嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；求解单元，所述求解单元用于采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法，嵌套数学规划优化器求解电池容量最优配置方案。本发明还包括一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时，实现如上述的方法。本发明还包括一种存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如上述的方法。本发明的有益效果为：1、本发明控制储能在实现平抑波动需求的同时利用储能剩余功率参与风电场调频备用，可以有效提高电池利用率和储能效益，进一步减小并网波动系数，且风机功率备用与储能控制相结合可以大幅减小风电减载成本与弃风量，增强风电场调频能力；2、本发明将双电池组控制策略嵌入双重工况下运行。该策略可以有效减小储能配置总容量，延长电池使用寿命；3、本发明结合变分模态分解法，提出一种考虑风电场参与调频工况时并网参考功率优化的方法。该方法更新计算获得的风电并网优化参考功率更合理，更贴近实际运行情况；4、本发明采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法嵌套数学规划优化器优化计算。该算法获得可行解所经历的评估次数较少，收敛速度较快。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明中记载的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为实施例1中方法的流程图；图2为实施例1中装置的结构示意图；图3为实施例2中风储联合系统示意图；图4为实施例2中算法流程图；图5为实施例2中收敛曲线对比图；图6为实施例2中风电场功率平抑效果图；图7为实施例2中风电场调频效果图；图8为实施例2中分组电池荷电状态示意图；图9为实施例2中分组电池充放电功率示意图；图10为计算机设备的结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。如图1所示：一种风电场电池容量优化配置方法，包括如下步骤：结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建考虑储能成本的规划层模型；以风机与储能的调频功率最佳分配为目标，构建考虑风机储能协同调频成本的运行层模型；联合规划层模型和运行层模型，构建容量优化配置模型，并嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法，嵌套数学规划优化器求解电池容量最优配置方案。在本实施例中，规划层模型包括：构建储能参与双场景的目标函数：；其中，fou为储能年均效用，Sflu为储能平抑风功率波动效用，Bfre为储能辅助一次调频效用，Clife为储能等年值成本；其中：；；式中，S1为惩罚减免费用；S2为增发上网电量效用；PW为t时刻的风机原始出力；PG 为t时刻风电场实际并网功率；cqf为单位弃风惩罚费用；cqd单位缺电惩罚费用；Δt为采样周期；T全年运行时间；cw为风电场单位上网电价，当配置储能后风电场所年均增加的发电量为正时，此项为正，即获得效用；反之为负，即承担成本；；；其中，B1为调频服务效用；B2储能购电成本；B3储能调频充放电损耗成本；ktp为调频服务费用；Pbup、Pbdown为储能向上、向下调频功率；abuy、asell分别为储能购电和售电单价；ηc和ηd分别为储能的充电和放电效率；；；其中，Cinve为储能建设投资成本；Cmain为储能运行维护成本；LY为现值系数，表示储能维护成本随使用寿命的变化系数，Creco为回收成本；Etotal为储能电池组最大额定总容量；Pr为储能电池组最大额定充放电功率；cei为单位容量电池的投资成本；cpi为单位功率变流器的投资成本；cem为单位容量电池的运行维护成本；cpm为单位功率电池的运行维护成本；crec为报废成本比；b为折现率；Y为储能电池的寿命；电池使用寿命为电池以额定放电深度在寿命周期下的总放电量与折算成额定放电深度的年放电量之比：；其中，DODr为额定放电深度；Er为电池额定容量；E为电池第i次切换阶段实际放电量；Nr为额定放电深度下的电池循环次数；I为放电阶段计数；N 为第i个放电阶段实际放电深度下的电池循环次数。规划层模型还包括：风电并网功率波动约束条件：；其中，PG为风电机组实际出力；PWN为风电场装机容量；ab为并网波动率限制值，表示风电场出力在固定时间间隔内功率变化率不应超过其装机容量某个比例；储能约束条件：；；；其中，Smin为电池剩电量下限；S为t时刻电池剩余电量，Er为电池额定容量；Pmin为使风电功率波动满足限定标准所需的平抑功率；Pr为储能电池组最大额定充放电功率；Ψmax、Ψmin为电池SOC的最大值、最小值。在本实施例中，运行层模型包括：考虑全年一次调频综合成本的目标函数：；；其中，fin为全年一次调频综合成本；W1为风电减载备用成本，W2为风电调频成本；B2为储能调频购电成本；B3为储能调频充放电损耗成本；B4为调频不足惩罚成本，cw为风电场单位上网电价；Pgref为第t时刻风电场理论并网初始参考功率；Pwdown为风电机组向下调频功率；ape为系统调频不足惩罚单价；Pp2为储能一次调频功率，Pde为风电场最优减载有功输出，表达式如下所示；；式中，Pact为风储系统提供的实际总调频功率；Pins为风电场调频需求功率，表达式如下所示；；；其中，dopt为风电场最优减载率；Pwup、Pwdown为风机向上向下调频功率；f为t时刻系统实际采样频率；fN为系统额定频率；Rt为调差系数。运行层模型还包括：储能调频功率约束条件：；/＞；其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为向上、向下调频的状态控制变量，为1时表示参与系统调频，为0时表示不参与系统调频，Pup_max、Pdown_max为储能向上、向下调频功率不能超过的申报上限，表达式如下所示：；其中，Pimax、Pomax为设定的储能最大总充电、放电功率；δin、δout为储能调频充放电功率分配系数；Ps为抑波功率作用域，计算式如下：；风电场减载功率约束条件：；其中，dmax为最大减载率；Pde_max为风电场最大减载功率；风机调频功率约束条件：；其中，Pgref为风电场理论出力；Pde为最优减载功率；Pde_max为最大减载功率；调频能力约束条件：要求风储系统满足调频需求的概率大于一定的置信度β1，对于第i次调频，设置0-1 变量m：；若风储系统满足调频需求，则m取1，否则取0，以频率代替概率，调频能力约束为：。本实施例中更新并网优化参考功率，包括如下步骤：采用变分模态分解法分解风电原始功率后，基于中心频率区分高频、中频和低频分量，根据风电场接入电力系统规定波动指标，取中低频分量为理论并网初始参考功率Pgref，变分模型如下：；其中，{uk}为IMF分量；{ωk}为中心频率；δ为脉冲函数；f为原始输入信号；将理论并网初始参考功率传入嵌入的电池分组控制策略与变分模态分解法，优化计算得到风电场需要执行的向上向下调频量与动态减载量，更新并网初始参考功率获得并网优化参考功率Pgopt，进而获得储能平抑波动所需的最优充放电功率Pp1；当平抑功率为正值时，需要电池放电以补充缺额；当平抑功率为负值时，电池充电以吸收余额；并网优化参考功率Pgopt与储能最优抑波功率Pp1计算式如下：；；其中，Pde风电场最优减载有功输出；Pwup、Pwdown为风机向上向下调频功率；PW为风机原始出力；内层模型同时还计算得到储能所需提供的一次调频功率Pp2；当系统频率过高，储能向下调频即吸收功率；当系统频率过低，储能向上调频时即发出功率，因此储能调频功率表达式为：；其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为储能向上、向下调频的状态控制变量；储能跟踪的总充放电功率Psum包括储能抑波功率Pp1以及储能调频功率Pp2，其整体充放电功率表达式如下所示：；；其中，Pch、Pdis为t时刻的储能总计充电功率、放电功率；嵌入分组充放电电池控制策略：初始时刻BESS1从电网吸收功率，作为充电电池组；BESS2向电网输出功率，为放电电池组；表达式如下所示：；若BESS2放电量多，率先达到SOC下限，则BESS2立即与BESS1交换充放电角色，即BESS1担任放电电池组，BESS2担任充电电池组，表达式如下所示：；其中，Pb1、Pb2为BESS1、BESS2在t时刻的出力。作为上述实施例的优选，改进粒子群算法，包括如下步骤：粒子群算法中粒子更新过程如下：；其中，w为惯性权重；c1、c2为学习因子；r1、r2为区间中的随机数；为第i个粒子第d维第k次迭代的位置和速度；/＞为个体极值和全局极值；在完成个体更新和群体最优更新后，前期进行反向学习，同时考虑当前方向和相反方向的解以更快逼近全局最优，公式如下所示：；若粒子超出范围，则重新初始化：；其中，是当下种群最优个体由反向学习策略得到的新解；/＞与/＞是最大边界值和最小边界值；k为区间中的随机数；后期采用差分进化的变异和交叉策略进行改进寻优，变异过程如下所示：；交叉操作如下所示：；其中，zi,d为变异向量；F为缩放因子；m1、m2为区间中的随机数，N为种群总规模；ui,d为试探向量ui的第d维；C为交叉概率；ni为区间中的随机整数，D为粒子群的总维度。本实施例中方案的有益效果为：1、本发明控制储能在实现平抑波动需求的同时利用储能剩余功率参与风电场调频备用，可以有效提高电池利用率和储能效益，进一步减小并网波动系数，且风机功率备用与储能控制相结合可以大幅减小风电减载成本与弃风量，增强风电场调频能力。2、本发明将双电池组控制策略嵌入双重工况下运行。该策略可以有效减小储能配置总容量，延长电池使用寿命。3、本发明结合变分模态分解法，提出一种考虑风电场参与调频工况时并网参考功率优化的方法。该方法更新计算获得的风电并网优化参考功率更合理，更贴近实际运行情况。4、本发明采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法嵌套数学规划优化器优化计算。该算法获得可行解所经历的评估次数较少，收敛速度较快。如图2所示，本实施例中还包括一种风电场电池容量优化配置装置，使用如上述的方法，包括：规划模型建立单元，规划模型建立单元用于结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建考虑储能成本的规划层模型；运行模型建立单元，运行单元建立单元用于以风机与储能的调频功率最佳分配为目标，构建考虑风机储能协同调频成本的运行层模型；双层模型单元，双层模型单元用于联合规划层模型和运行层模型，构建容量优化配置模型，并嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；求解单元，求解单元用于采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法，嵌套数学规划优化器求解电池容量最优配置方案。实施例2：如图3所示，本实施例中包括计及双重工况的风电场电池容量优化配置方法，包括以下步骤：步骤1：结合储能平抑功率波动与一次调频的工况需求，根据净现值法构建一种考虑储能成本-效益的规划层模型；1.1：构建储能参与双场景的成本-效益目标函数。其中，fou为储能年均净收益，Sflu为储能平抑风功率波动净收益，Bfre为储能辅助一次调频净收益，Clife为储能等年值投资成本。平抑风功率波动净收益表达式如下：其中，S1为惩罚减免费用；S2为增发上网电量效益；PW为t时刻的风机原始出力；PG 为t时刻风电场实际并网功率；cqf为单位弃风惩罚费用；cqd单位缺电惩罚费用；Δt为采样周期；T全年运行时间；cw为风电场单位上网电价。当配置储能后风电场所年均增加的发电量为正时，此项为正，即获得收益；反之为负，即承担成本。一次调频净收益表达式如下：/＞其中，B1为调频服务收益；B2储能购电成本；B3储能调频充放电损耗成本；ktp为调频服务费用；Pbup、Pbdown为储能向上、向下调频功率；abuy、asell分别为储能购电和售电单价；ηc和ηd分别为储能的充电和放电效率。储能等年值投资成本表达式如下：其中，Cinve为储能建设投资费用；Cmain为储能运行维护成本；LY为现值系数，表示储能维护成本随使用寿命的变化系数。Creco为回收成本；Etotal为储能电池组最大额定总容量；Pr为储能电池组最大额定充放电功率；cei为单位容量电池的投资成本；cpi为单位功率变流器的投资成本；cem为单位容量电池的运行维护成本；cpm为单位功率电池的运行维护成本；crec为报废成本比；b为折现率；Y为储能电池的寿命。电池使用寿命为电池以额定放电深度在寿命周期下的总放电量与折算成额定放电深度的年放电量之比。其中，DODr为额定放电深度；Er为电池额定容量；E为电池第i次切换阶段实际放电量；Nr为额定放电深度下的电池循环次数；I为放电阶段计数；N 为第i个放电阶段实际放电深度下的电池循环次数。1.2：构建风电并网功率波动约束条件。其中，PG为风电机组实际出力为；PWN为风电场装机容量；ab为并网波动率限制值，表示风电场出力在固定时间间隔内功率变化率不应超过其装机容量某个比例。1.3：构建储能约束条件。/＞其中，Smin为电池剩电量下限；S为t时刻电池剩余电量，Er为电池额定容量；Pmin为使风电功率波动满足GB/T 19963.1—2021中限定标准的所需平抑功率；Pr为储能电池组最大额定充放电功率；Ψmax、Ψmin为电池SOC的最大值、最小值。步骤2：为确定风机与储能的调频功率最佳分配，构建一种考虑风机储能协同调频成本的运行层模型；2.1：构建考虑全年一次调频综合成本的目标函数。其中，fin为全年一次调频综合成本；W1为风电减载备用成本，W2为风电调频成本；B2为储能调频购电成本；B3为储能调频充放电损耗成本；B4为调频不足惩罚成本。cw为风电场单位上网电价；Pgref为第t时刻风电场理论并网初始参考功率；Pwdown为风电机组向下调频功率；ape为系统调频不足惩罚单价；Pp2为储能一次调频功率。Pde为风电场最优减载有功输出，表达式如下所示；Pact为风储系统提供的实际总调频功率；Pins为风电场调频需求功率，表达式如下所示；其中，dopt为风电场最优减载率；Pwup、Pwdown为风机向上向下调频功率；f为t时刻系统实际采样频率；fN为系统额定频率；Rt为调差系数。2.2：构建储能调频功率约束条件。/＞其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为向上、向下调频的状态控制变量，为1时表示参与系统调频，为0时表示不参与系统调频。Pup_max、Pdown_max为储能向上、向下调频功率不能超过的申报上限，表达式如下所示：其中，Pimax、Pomax为设定的储能最大总充电、放电功率；δin、δout为储能调频充放电功率分配系数；Ps为抑波功率申报作用域，计算式如下：2.3：构建风电场减载功率约束条件。其中，dmax为最大减载率；Pde_max为风电场最大减载功率。2.4：构建风机调频功率约束条件。其中，Pgref为风电场理论出力；Pde为最优减载功率；Pde_max为最大减载功率。2.5：构建调频能力约束条件。储能对调频需求完全跟踪会大幅增加成本，而收益增长有限，所以根据机会约束规划理论，由于随机变量的出现，在一定程度上允许所做决策在不利情况发生时可能不满足约束。要求风储系统满足调频需求的概率大于一定的置信度β1，对于第i次调频，设置 0-1 变量m：若风储系统满足调频需求，则m取1，否则取0。以频率代替概率，调频能力约束为：步骤3：在模型中嵌入电池分组控制策略与变分模态分解法，以更新并网优化参考功率；3.1：采用变分模态分解方法分解风电原始功率后，基于中心频率区分高频中频率低频分量，进而根据风电场接入电力系统技术规定波动指标取中低频分量为理论并网初始参考功率Pgref。变分模型如下：其中，{uk}为IMF分量；{ωk}为中心频率；δ为脉冲函数；f为原始输入信号。3.2：将理论并网初始参考功率传入内层模型优化计算得到风电场需要执行的向上向下调频量与动态减载量，更新并网初始参考功率获得并网优化参考功率Pgopt，进而获得储能平抑波动所需的最优充放电功率Pp1。当平抑功率为正值时，需要电池放电以补充缺额；当平抑功率为负值时，电池充电以吸收余额。并网优化参考功率Pgopt与储能最优抑波功率Pp1计算式如下：其中，Pde风电场最优减载有功输出；Pwup、Pwdown为风机向上向下调频功率；PW为风机原始出力。3.3：内层模型同时还计算得到储能所需提供的一次调频功率Pp2。当系统频率过高，储能向下调频即吸收功率；当系统频率过低，储能向上调频时即发出功率，因此储能调频功率表达式为：其中，Pbup、Pbdown为储能向上、向下调频功率；uup、udown为储能向上、向下调频的状态控制变量。3.4：储能跟踪的总充放电功率Psum包括储能抑波功率Pp1以及储能调频功率Pp2，其整体充放电功率表达式如下所示：其中，Pch、Pdis为t时刻的储能总计充电功率、放电功率。3.5：嵌入分组充放电电池控制策略。初始时刻BESS1从电网吸收功率，作为充电电池组；BESS2向电网输出功率，为放电电池组。表达式如下所示：/＞若BESS2放电量多，率先达到SOC下限，则BESS2立即与BESS1交换充放电角色，即BESS1担任放电电池组，BESS2担任充电电池组，表达式如下所示：其中，Pb1、Pb2为BESS1、BESS2在t时刻的出力。步骤4：如图4所示，采用反向学习前期寻优结合变异交叉后期寻优的改进粒子群算法嵌套Gurobi求解年净收益最大化的储能最佳配置方案。4.1：改进的粒子群算法中粒子更新过程如下：其中，w为惯性权重；c1、c2为学习因子；r1、r2为区间中的随机数；为第i个粒子第d维第k次迭代的位置和速度；/＞为个体极值和全局极值。4.2：在完成个体更新和群体最优更新后，前期进行反向学习，同时考虑当前方向和相反方向的解以更快逼近全局最优，公式如下所示：若粒子超出范围，则重新初始化：其中，是当下种群最优个体由反向学习策略得到的新解；/＞与/＞是最大边界值和最小边界值；k为区间中的随机数。4.3：后期采用差分进化的变异和交叉策略进行改进寻优，变异过程如下所示：交叉操作如下所示：其中，zi,d为变异向量；F为缩放因子；m1、m2为区间中的随机数，N为种群总规模；ui,d为试探向量ui的第d维；C为交叉概率；ni为区间中的随机整数，D为粒子群的总维度。本例选取江苏某450MW风电场为例。采用改进粒子群算法嵌套Gurobi优化器求解，相较于传统粒子群算法的收敛曲线对比图见图5。得到最佳配置方案为：装配两个额定容量40.6MWh的电池组以及额定功率为32.9MW的DC/AC变流器。此时电池使用寿命为16年，平均年收益为5075.4万元, 其中储能抑波净收益为3395.2万元、储能调频净收益为5512.6万元、储能等年值投资成本为3832.3万元。风电场出力在某一天平抑前后的功率波动与风储系统一次调频前后的系统频率调节效果分别见图6和图7。可见得到的储能配置方案既能有效平滑风电出力波动，又能使超过调频死区的系统频率得到有效调节。表1为储能在双重工况应用场景与单一工况应用场景下的配置结果及相关参数的对比表。表1不同工况配置方案对比由表可见，将储能应用于双重工况的场景下时，寿命期间内总净收益远大于单一工况。并且该情况下的储能得到了充分利用，其并网波动系数、风电场减载容量、风电场调频综合成本均小于单一应用场景，参与平抑与调频的满足度与完成度更高。将分组电池与传统整体电池的配置方案相比较，分组电池最佳配置两个容量为40.6MWh的电池组，总共即81.2MWh；而单电池组需配置108.6MWh。可见分组控制策略减小了储能需配置的总容量，进而减少了储能投资成本。本例配置的分组电池荷电状态与充放电功率见图8和图9。可见电池切换频率减小，因而分组电池的寿命较整体电池组多了三年。请参见图10示出的本申请实施例提供的计算机设备的结构示意图。本申请实施例提供的一种计算机设备400，包括：处理器410和存储器420，存储器420存储有处理器410可执行的计算机程序，计算机程序被处理器410执行时执行如上的方法。本申请实施例还提供了一种存储介质430，该存储介质430上存储有计算机程序，该计算机程序被处理器410运行时执行如上的方法。其中，存储介质430可以由任何类型的易失性或非易失性存储设备或者它们的组合实现，如静态随机存取存储器，电可擦除可编程只读存储器，可擦除可编程只读存储器，可编程只读存储器，只读存储器，磁存储器，快闪存储器，磁盘或光盘。在本发明的描述中，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。“多个”的含义是两个或两个以上，除非另有明确具体的限定。在本发明中，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”、“固定”等术语应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或成一体；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通或两个元件的相互作用关系。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必针对相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。流程图中或在此以其他方式描述的任何过程或方法描述可以被理解为，表示包括一个或更多个用于实现特定逻辑功能或过程的步骤的可执行指令的代码的模块、片段或部分，并且本发明的优选实施方式的范围包括另外的实现，其中可以不按所示出或讨论的顺序，包括根据所涉及的功能按基本同时的方式或按相反的顺序，来执行功能，这应被本发明的实施例所属技术领域的技术人员所理解。在流程图中表示或在此以其他方式描述的逻辑和/或步骤，例如，可以被认为是用于实现逻辑功能的可执行指令的定序列表，可以具体实现在任何计算机可读介质中，以供指令执行系统、装置或设备使用，或结合这些指令执行系统、装置或设备而使用。就本说明书而言，“计算机可读介质”可以是任何可以包含、存储、通信、传播或传输程序以供指令执行系统、装置或设备或结合这些指令执行系统、装置或设备而使用的装置。计算机可读介质的更具体的示例包括以下：具有一个或多个布线的电连接部，便携式计算机盘盒，随机存取存储器，只读存储器，可擦除可编辑只读存储器，光纤装置，以及便携式光盘只读存储器。另外，计算机可读介质甚至可以是可在其上打印所述程序的纸或其他合适的介质，因为可以例如通过对纸或其他介质进行光学扫描，接着进行编辑、解译或必要时以其他合适方式进行处理来以电子方式获得所述程序，然后将其存储在计算机存储器中。应当理解，本发明的各部分可以用硬件、软件、固件或它们的组合来实现。在上述实施方式中，多个步骤或方法可以用存储在存储器中且由合适的指令执行系统执行的软件或固件来实现。例如，如果用硬件来实现，和在另一实施方式中一样，可用本领域公知的下列技术中的任一项或他们的组合来实现：具有用于对数据信号实现逻辑功能的逻辑门电路的离散逻辑电路，具有合适的组合逻辑门电路的专用集成电路，可编程门阵列，现场可编程门阵列等。本技术领域的普通技术人员可以理解实现上述实施例方法携带的全部或部分步骤是可以通过程序来指令相关的硬件完成，所述的程序可以存储于一种计算机可读存储介质中，该程序在执行时，包括方法实施例的步骤之一或其组合。上述提到的存储介质可以是只读存储器，磁盘或光盘等。尽管上面已经示出和描述了本发明的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本发明的限制，本领域的普通技术人员在本发明的范围内可以对上述实施例进行变化、修改、替换和变型。
