标题title
连续时间线性均衡器
摘要abst
本发明公开了一种连续时间线性均衡器。为解决数据输入速率过窄、芯片占用面积大、鲁棒性差的技术问题，本发明通过对CTLE单元和限幅器输出信号的低频分量和高频分量分别进行比较，并根据比较结果分别控制CTLE单元低频增益和限幅器输出摆幅，直至比较结果符合预定信号模式。本发明以频谱比较单元分别比较CTLE单元和限幅器输出信号的高频分量和低频分量，并调节限幅器输出摆幅和CTLE单元低频增益为技术手段，自适应均衡收敛过程更加可控，鲁棒性更强，适用于较宽的数据输入速率。本发明适于数据通信领域。
权利要求书clms
1.一种连续时间线性均衡器，包括CTLE单元、频谱比较单元和数字控制单元，其特征在于：所述频谱比较单元包括第一比较器、第二比较器和限幅器；通过第一比较器比较CTLE单元输出信号的低频分量与限幅器输出信号的低频分量，获得低频分量比较结果；通过第二比较器比较CTLE单元输出信号的高频分量与限幅器输出信号的高频分量，获得高频分量比较结果；数字控制单元对低频分量比较结果和高频分量比较结果进行采样，并根据低频分量比较结果输出用于降低CTLE单元低频增益的第一均衡调节信号或提高CTLE单元低频增益的第二均衡调节信号，以及根据高频分量比较结果输出用于提高限幅器输出摆幅的第一摆幅调节信号或降低限幅器输出摆幅的第二摆幅调节信号。2.根据权利要求1所述的连续时间线性均衡器，其特征在于：当且仅当在预设周期内，低频分量比较结果符合预定信号模式时，数字控制单元停止输出第一均衡调节信号或第二均衡调节信号。3.根据权利要求2所述的连续时间线性均衡器，其特征在于：当且仅当在预设周期内，高频分量比较结果符合预定信号模式时，数字控制单元停止输出第一摆幅调节信号或第二摆幅调节信号。4.根据权利要求3所述的连续时间线性均衡器，其特征在于：在预设周期内，若高频分量比较结果和低频分量比较结果均符合预定信号模式，则判定CTLE单元已经均衡收敛，结束自适应均衡收敛任务。5.根据权利要求4所述的连续时间线性均衡器，其特征在于：当完成自适应均衡收敛后，将数字控制单元当前输出的第一摆幅调节信号或第二摆幅调节信号，以及第一均衡调节信号或第二均衡调节信号，均锁定预设时长。6.根据权利要求5所述的连续时间线性均衡器，其特征在于：当完成自适应均衡收敛后，数字控制单元输出掉电控制信号以控制频谱比较单元暂时掉电。7.根据权利要求5所述的连续时间线性均衡器，其特征在于：所述预设周期是数字控制单元的8至16个采样时钟周期中的任意一个。8.根据权利要求5所述的连续时间线性均衡器，其特征在于：所述频谱比较单元还包括第一低通滤波器和第一整流器，以及第二低通滤波器和第二整流器；CTLE单元输出信号的低频分量，是通过第一低通滤波器和第一整流器获得；限幅器输出信号的低频分量，是通过第二低通滤波器和第二整流器获得。9.根据权利要求8所述的连续时间线性均衡器，其特征在于：所述频谱比较单元还包括第一高通滤波器和第三整流器，以及第二高通滤波器和第四整流器；CTLE单元输出信号的高频分量，是通过第一高通滤波器和第三整流器获得；限幅器输出信号的高频分量，是通过第二高通滤波器和第四整流器获得。10.根据权利要求9所述的连续时间线性均衡器，其特征在于：所述预定信号模式是“1010”信号模式，即出现连续两次的高低电平信号。
说明书desc
技术领域本发明涉及数据通信领域，具体涉及一种连续时间线性均衡器。背景技术在高速信号传输系统中，由于信号传输速率越来越高，信号传输介质的寄生分布参数会对高频信号产生严重的插入损耗，使得高频信号受到严重的码间串扰影响，导致眼图质量变差、误码率增加。为了弥补由信道带来的插入损耗缺陷，一般在接收机前端使用连续时间线性均衡单元。CTLE单元的作用是抵消信道插入损耗的影响。典型的CTLE单元结构如图1所示，包括两条对称的支路，每条支路包括依次连接的电感、电阻、开关管和电流源。两条支路上的开关管分别接收第一输入信号 VinP和第二输入信号VinN。在开关管和电流源连接的端点之间还并联一个可调电容和一个可调电阻。两条支路中的电阻和开关管连接的端点作为输出端子，并输出信号Vout。该CTLE单元通过源极负反馈电阻和电容实现高通传输特性，与信道的低通特性互补实现频率补偿，最终产生较为平坦的频率响应。由于不同的信道其插入损耗不同，因此一般是预设电阻阵列、电容阵列，通过可编程开关控制，来调节均衡程度，使其满足不同信道的插入损耗。但在很多应用场景下，接收机很难提前预估信道的插入损耗，仅依靠上述办法很难有效地补偿信道的插入损耗，因此需要CTLE单元能够自动根据输入信号的高频损耗程度来调整均衡的程度，达到自适应的效果。常见的CTLE单元自适应均衡结构有两种：一种是频谱平衡结构，另一种是频谱比较结构。频谱平衡结构基于一个预设截止频率，通过高通滤波器、低通滤波器将CTLE单元输出的信号频谱分成能量相同的高频分量和低频分量，比较器比较这两个分量，通过比较结果反馈控制CTLE单元的均衡程度。当输入信号经过信道的插入损耗之后高频成分减弱，比较器输入的高频分量低于低频分量，比较器反馈控制CTLE单元提高均衡程度，直到CTLE单元输出的高频分量和低频分量的能量接近相同，完成自适应均衡的收敛。该结构的问题在于预设截止频率是固定的，这会导致自适应的适用输入速率较窄，无法满足不同输入速率的应用。在频谱比较结构中，在CTLE单元的输出端接限幅器，限幅器输出的信号接近理想信号，通过比较CTLE单元的输出信号和限幅器的输出信号，用比较的结果基于电荷泵而去控制CTLE单元的均衡程度以实现自适应。可以认为信号经过限幅器整形后，高频分量和低频分量的能量相同，通过比较CTLE单元和限幅器输出的高频分量，并用比较结果反馈去控制限幅器，使CTLE单元和限幅器输出的高频分量的能量相同，然后再比较CTLE单元和限幅器输出的低频分量，用比较结果反馈去控制CTLE单元的均衡程度以实现自适应，直到CTLE单元输出的信号频谱能量分布与限幅器输出的信号频谱能量分布接近一致时，完成自适应均衡的收敛。该结构的问题在于相比于频谱平衡结构，需要增加限幅器和额外的滤波器、整流器、比较器以及反馈控制模块，一方面会占用更大的芯片面积和功耗，另一方面还会因电荷泵等模拟器件存在失配而导致鲁棒性差的缺点。基于此，数据输入速率过窄、芯片占用面积大、功耗高、鲁棒性差等技术问题，是本领域亟待解决的难题。发明内容为了缓解或部分缓解上述技术问题，本发明的解决方案如下所述：一种连续时间线性均衡器，包括CTLE单元、频谱比较单元和数字控制单元，所述频谱比较单元包括第一比较器、第二比较器和限幅器；通过第一比较器比较CTLE单元输出信号的低频分量与限幅器输出信号的低频分量，获得低频分量比较结果；通过第二比较器比较CTLE单元输出信号的高频分量与限幅器输出信号的高频分量，获得高频分量比较结果；数字控制单元对低频分量比较结果和高频分量比较结果进行采样，并根据低频分量比较结果输出用于降低CTLE单元低频增益的第一均衡调节信号或提高CTLE单元低频增益的第二均衡调节信号，以及根据高频分量比较结果输出用于提高限幅器输出摆幅的第一摆幅调节信号或降低限幅器输出摆幅的第二摆幅调节信号。在某实施例中，当且仅当在预设周期内，低频分量比较结果符合预定信号模式时，数字控制单元停止输出第一均衡调节信号或第二均衡调节信号。在某实施例中，当且仅当在预设周期内，高频分量比较结果符合预定信号模式时，数字控制单元停止输出第一摆幅调节信号或第二摆幅调节信号。在某实施例中，在预设周期内，若高频分量比较结果和低频分量比较结果均符合预定信号模式，则判定CTLE单元已经均衡收敛，结束自适应均衡收敛任务。在某实施例中，当完成自适应均衡收敛后，将数字控制单元当前输出的第一摆幅调节信号或第二摆幅调节信号，以及第一均衡调节信号或第二均衡调节信号，均锁定预设时长。在某实施例中，当完成自适应均衡收敛后，数字控制单元输出掉电控制信号以控制频谱比较单元暂时掉电。在某实施例中，所述预设周期是数字控制单元的8至16个采样时钟周期中的任意一个。在某实施例中，所述频谱比较单元还包括第一低通滤波器和第一整流器，以及第二低通滤波器和第二整流器；CTLE单元输出信号的低频分量，是通过第一低通滤波器和第一整流器获得；限幅器输出信号的低频分量，是通过第二低通滤波器和第二整流器获得。在某实施例中，所述频谱比较单元还包括第一高通滤波器和第三整流器，以及第二高通滤波器和第四整流器；CTLE单元输出信号的高频分量，是通过第一高通滤波器和第三整流器获得；限幅器输出信号的高频分量，是通过第二高通滤波器和第四整流器获得。在某实施例中，所述预定信号模式是“1010”信号模式，即出现连续两次的高低电平信号。本发明技术方案，具有如下有益的技术效果之一或多个：1、本发明采用了频谱比较结构，与传统的频谱平衡结构相比，可以适用于较宽的输入速率。2、本发明在自适应均衡收敛完成之后，可以通过数字控制单元将自适应相关电路暂时掉电，因而具有更低的功耗优势。3、采用了数字控制单元来进行自适应均衡收敛，与传统的采用电荷泵等模拟单元来控制收敛过程相比，数字电路受工艺、电压、温度的影响更小，自适应均衡收敛过程更加可控，鲁棒性更强，收敛的精度更高。此外，本发明还具有的其它有益效果将在具体实施例中提及。附图说明图1是现有技术中典型CTLE单元电路图；图2是本发明宽速率范围的低功耗自适应连续时间线性均衡器的结构图；图3是本发明宽速率范围的低功耗自适应连续时间线性均衡器的工作流程图。具体实施方式为使本发明的目的、技术方案和优点更加清楚，下面将结合本发明中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。为了便于清楚描述本发明实施例的技术方案，在本发明的实施例中，采用了“第一”、“第二”等字样对功能和作用基本相同的相同项或相似项进行区分。本领域技术人员可以理解“第一”、“第二”等字样并不对数量和执行次序进行限定，并且“第一”、“第二”等字样也并不限定一定不同。图2展示了一种连续时间线性均衡器，其包括CTLE单元、数字控制单元和频谱比较单元。频谱比较单元包括限幅器、第一低通滤波器、第二低通滤波器、第一高通滤波器、第二高通滤波器、第一整流器、第二整流器、第三整流器、第四整流器，以及第一比较器、第二比较器。所述CTLE单元的输入端接收外部输入信号，比如是经过信道传输后的输入信号。数字控制单元的信号输入端与频谱比较单元的信号输出端连接，具体而言，是第一比较器和第二比较器的输出信号作为数字控制单元的输入信号。数字控制单元的信号输出端分别与CTLE单元的控制信号输入端、频谱比较单元中限幅器的控制信号输入端连接，并分别构成均衡调节环路和摆幅调节环路。CTLE单元的输出信号连接整个系统的输出端，也作为限幅器的输入信号，也作为第一低通滤波器和第一高通滤波器的输入信号。所述限幅器的输出信号作为第二低通滤波器和第二高通滤波器的输入信号。第一低通滤波器的输出信号经第一整流器整流后，传输至第一比较器的同相输入端，第二低通滤波器的输出信号经第二整流器整流后，传输至第一比较器的反相输入端。第一高通滤波器的输出信号经第三整流器整流后，传输至第二比较器的同相输入端，第二高通滤波器的输出信号经第四整流器整流后，传输至第二比较器的反相输入端。在时钟控制下，数字控制单元第一比较器和第二比较器输出结果进行采样。此外，数字控制单元还控制频谱比较单元的掉电控制功能。当CTLE单元自适应均衡收敛完成后，所述数字控制单元产生掉电控制信号控制频谱比较单元掉电。本发明中，经过CTLE单元的控制信号输入端，数字控制单元、CTLE单元和频谱比较单元形成的第一环路用于调节CTLE单元的均衡程度。而另一方面，经过限幅器的控制信号输入端，数字控制单元和限幅器、频谱比较单元，以及前述多个滤波器、整流器和比较器所形成的第二环路用于调节频谱比较单元中限幅器的输出摆幅，完成CTLE单元自适应均衡收敛。参考图3，其展示了前述自适应连续时间线性均衡器的工作流程。所述工作流程，包括如下步骤：步骤1：数字控制单元发出启用信号，启用自适应均衡收敛功能。开启该功能之后，为了快速的完成收敛，第一环路和第二环路同步工作。步骤2：通过数字控制单元判断第二比较器输出的高频分量比较结果和第一比较器输出的低频分量比较结果在预设周期内是否均符合预定信号模式，比如均出现连续两次的高低电平信号，以判定CTLE单元是否均衡收敛。若是，则认为已实现CTLE单元自适应均衡收敛，结束自适应均衡收敛任务。若否，则进入步骤3。进一步地，当CTLE单元完成自适应均衡收敛后，将摆幅调节信号和均衡调节信号均锁定预设时长，比如将该时间设置为0.8秒，并通过数字控制单元输出掉电控制信号以控制频谱比较单元暂时掉电，节省功耗，结束自适应均衡收敛任务。进一步地，所述预设周期是数字控制单元采样第一比较器和第二比较器输出结果的时钟周期。优选地，所述预设周期是数字控制单元的8至16个采样时钟周期中的任意一个。步骤3：对CTLE单元输出信号的高频分量和限幅器输出信号的高频分量进行比较，并对CTLE单元输出信号的低频分量和限幅器输出信号的低频分量进行比较，然后执行步骤4。具体地，将CTLE单元和限幅器的输出信号分别经过第一高通滤波器和第二高通滤波器过滤掉低频信号，再分别通过第三整流器和第四整流器将剩下的高频信号转化成在第二比较器中用来比较的信号，第二比较器执行比较之后输出高频分量比较结果。将CTLE单元和限幅器的输出信号分别经过第一低通滤波器和第二低通滤波器过滤掉高频信号，再分别通过第一整流器和第二整流器将剩下的低频信号转化成在第一比较器中用来比较的信号，第一比较器执行比较之后输出低频分量比较结果。值得一提的是，图2仅仅是本发明用于描述的某个示例。图2中所示的同相输入端和反相输入端的接法也可调换顺序，对于数字控制单元而言，其需要检测的信号模式也会发生相应的变化，这是本领域技术人员惯用手段的置换，本发明不以某种具体信号模式为限。步骤4：根据高频分量比较结果和低频分量比较结果，数字控制单元分别输出第一摆幅调节信号或第二摆幅调节信号，以及第一均衡调节信号或第二均衡调节信号，以分别控制限幅器的输出摆幅和CTLE单元的低频增益。具体地，当高频分量比较结果为高电平信号时，通过数字控制单元输出第一摆幅调节信号，以提高限幅器输出摆幅。当高频分量比较结果为低电平信号时，通过数字控制单元输出第二摆幅调节信号降低限幅器输出摆幅。第一摆幅调节信号和第二摆幅调节信号，均为摆幅调节控制码。当且仅当在预设周期内，高频分量比较结果符合预定信号模式时，数字控制单元停止输出第一摆幅调节信号或第二摆幅调节信号。比如，当高频分量比较结果在预设周期内符合预定信号模式，举例地，出现连续两次的高低电平信号，此时认为CTLE单元和限幅器输出的高频分量相等，然后返回步骤2。当低频分量比较结果为高电平信号时，通过数字控制单元输出第一均衡调节信号，以降低CTLE单元低频增益。当低频分量比较结果为低电平信号时，通过数字控制单元输出第二均衡调节信号，以提高CTLE单元低频增益。第一均衡调节信号和第二均衡调节信号，均为均衡调节控制码。当且仅当在预设周期内，低频分量比较结果符合预定信号模式时，数字控制单元停止输出第一均衡调节信号或第二均衡调节信号。比如，当低频分量的比较结果在预设周期内符合预定信号模式，举例地，出现连续两次的高低电平信号，此时可以认为CTLE单元和限幅器输出的低频分量相等，再返回步骤2。为了更好的说明本发明，在上文的具体实施方式中给出了众多的具体细节。本领域技术人员应当理解，没有某些具体细节，本发明同样可以实施。在一些实例中，对于本领域技术人员熟知的方法、手段、元件和电路未作详细描述，以便于凸显本发明的主旨。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以所述权利要求的保护范围为准。
