标题title
一种基于物联网的数据管理系统及方法
摘要abst
本发明公开了一种基于物联网的数据管理系统及方法，属于路径规划技术领域。系统包括数据采集模块、传输分析模块、路径规划模块和可视化模块；数据采集模块用于采集关系图谱和每个设备的参数，参数异常则作为故障设备；传输分析模块为故障设备生成探测数据包，按照关系图谱中的连接关系发送至其他设备上流转，流转完成后进行回传，故障设备根据回传的探测数据包规划代理路径并计算传输指数；路径规划模块根据传输指数选择传输路径，并生成导航数据包发送至传输路径下各设备，数据传输过程中实时监测传输速度，对比导航数据包内数据判断是否异常，异常情况则调整传输路径；可视化模块通过可视化大屏实时展示故障设备的传输信息。
权利要求书clms
1.一种基于物联网的数据管理方法，其特征在于：该方法包括以下步骤：S100、采集关系图谱和每个设备的参数，设备根据参数判断自身是否发生故障，故障设备自动生成探测数据包，按照关系图谱中的连接关系将探测数据包传输到其他设备；S200、其他设备接收到探测数据包后自动解析，分析数据包状态选择原封不动回传至故障设备，或者在探测数据包中添加记录后再次传输至具有连接关系的其他设备；S300、故障设备接收到回传的探测数据包后自动解析，分析探测数据包中保存的记录为故障设备规划不同的代理路径，根据每条代理路径中设备的参数计算传输指数；S400、每个故障设备根据传输指数选择传输路径，按照传输路径进行数据传输，并在传输过程中实时调整传输路径，通过可视化大屏展示故障设备的传输信息。2.根据权利要求1所述的一种基于物联网的数据管理方法，其特征在于：在S100中，关系图谱表示每台设备和与之具有蓝牙连接关系的其他设备之间的实际距离，在关系图谱中每台设备都存在一个或一个以上与之具有蓝牙连接关系的其他设备；每台设备都各自保存一份关系图谱，不同设备保存的关系图谱相同；参数包括设备的标识符和空闲速度，标识符用于区分不同设备，空闲速度是指设备当前可提供数据传输的最高网速；判断设备是否故障及探测数据的传输具体步骤如下：S101、设备未在传输采集数据时的空闲速度小于网速阈值则为网络故障，将发生网络故障的设备定义为故障设备；S102、为每个故障设备生成具有唯一识别码的探测数据包，将探测数据包的状态设定为扩散，记录当前时间T1作为发送时间，将故障设备作为发送方，发送方的标识符和发送时间一起存入对应探测数据包中，并加入填充数据使得探测数据包的数据量为Q；S103、在关系图谱中分别检索与每个故障设备具有蓝牙连接关系的其他设备作为扩散设备，每个故障设备通过蓝牙方式将各自的探测数据包分别传输到对应扩散设备上。3.根据权利要求2所述的一种基于物联网的数据管理方法，其特征在于：在S200中，具体步骤如下：S201、其他设备接收到探测数据包后记录接收时间并解析获取探测数据包的状态，状态为回传则进入S204步骤，状态为扩散则获取探测数据包中发送方的标识符和发送时间，将本设备作为接收方，接收方的标识符和接收时间与发送方的标识符和发送时间一起生成传输记录，获取本设备的空闲速度，记录当前时间T2作为采集时间，本设备的标识符、采集时间和空闲速度一起生成网速记录；S202、建立一个对比集合，将探测数据包中所有网速记录的标识符都放入对比集合中，在关系图谱中检索与本设备具有蓝牙连接关系的其他设备标识符，判断这些标识符是否都存在于对比集合中，结果为否则进入S203步骤，结果为是则将探测数据包状态设定为回传并进入S204步骤；S203、将与本设备具有蓝牙连接关系且不存在于对比集合中的设备作为扩散设备，记录当前时间T3作为发送时间，将本设备作为发送方，发送方的标识符和发送时间、所有传输记录和网速记录一起存入探测数据包中，加入填充数据使探测数据包的数据量为Q，将探测数据包使用蓝牙分别传输至各扩散设备，进入S201步骤在扩散设备上继续为探测数据包生成传输记录和网速记录；S204、按照时间倒序对回传状态探测数据包内所有传输记录的发送方标识符进行排列，按照标识符排列顺序将探测数据包原封不动顺次回传至故障设备。4.根据权利要求3所述的一种基于物联网的数据管理方法，其特征在于：在S300中，故障设备接收到其他设备传递过来的探测数据包后，分析每个数据包的唯一识别码，将与之前生成探测数据包相同唯一识别码的探测数据包进行解析，规划代理路径并计算传输指数，具体步骤如下：S301、解析每个与之前生成探测数据包相同唯一识别码的探测数据包，将这些探测数据包中所有传输记录和所有网速记录分别进行数据汇总，将每条传输记录的接收时间减去发送时间得到传输时长，数据量Q除以传输时长得到该传输记录中发送方与接收方之间的传输速度；S302、不同传输记录存在相同发送方和接收方时，选择接收时间最晚的传输记录所对应的传输速度作为发送方与接收方之间的传输速度；不同网速记录存在相同标识符时，选择采集时间最晚的网速记录中空闲速度作为该网速记录中标识符对应设备的空闲速度；以故障设备为起点，其他设备为中间点或终点，按照关系图谱中各设备之间的蓝牙连接关系为故障设备规划不同的代理路径；S303、代理路径内各设备之间的实际距离进行求和后作为传输总距离，各设备之间的传输速度以及终点对应设备的空闲速度中选择最小的速度作为上传速度；将每条代理路径的传输总距离和上传速度代入公式中计算传输指数，公式如下：，式中，/＞为传输指数，/＞为常数，/＞为上传速度，/＞为网速阈值，/＞为传输总距离，/＞为中间点对应设备数量，/＞为设备之间最佳传输距离。5.根据权利要求4所述的一种基于物联网的数据管理方法，其特征在于：在S400中，每个故障设备选择传输指数最高的代理路径作为传输路径，通过传输路径将故障设备的采集数据上传至数据中心；具体传输步骤如下：S401、传输路径、上传速度和探测数据包组合为导航数据包，将导航数据包分别传输至传输路径内各设备，传输路径内中间点对应设备作为代理节点，终点对应设备作为上传节点，代理节点将故障设备的采集数据使用蓝牙传输至其他代理节点或上传节点，上传节点将采集数据与导航数据包使用无线网络上传至数据中心；S402、传输过程中，实时监测代理节点的蓝牙传输速度和上传节点的网络传输速度；蓝牙传输速度小于上传速度的代理节点标记异常，网络传输速度小于上传速度的上传节点标记异常；以异常代理节点或异常上传节点为调整点，非异常代理节点为中间点，非异常上传节点为终点，从调整点到终点重新规划出不同预调路径，分别计算每条预调路径的传输指数，选择传输指数最高的预调路径作为调整路径；S403、将原传输路径中起点到调整点的部分路径加上调整路径后作为新的传输路径，进入S401步骤继续传输采集数据并实时调整传输路径，直到故障设备的采集数据全部上传至数据中心则停止传输；导航数据包每次变动后都会重新上传至数据中心，数据中心解析导航数据包并通过可视化大屏实时展示故障设备的传输路径和采集数据传输进度。6.一种基于物联网的数据管理系统，其特征在于：该系统包括数据采集模块、传输分析模块、路径规划模块和可视化模块；数据采集模块用于采集关系图谱和每个设备的参数，参数异常则作为故障设备；传输分析模块为故障设备生成探测数据包，按照关系图谱中的连接关系发送至其他设备上流转，流转完成后进行回传，故障设备根据回传的探测数据包规划代理路径并计算传输指数；路径规划模块根据传输指数选择传输路径，并生成导航数据包发送至传输路径下各设备，数据传输过程中实时监测传输速度，对比导航数据包内数据判断是否异常，异常情况则调整传输路径；可视化模块通过可视化大屏实时展示故障设备的传输信息。7.根据权利要求6所述的一种基于物联网的数据管理系统，其特征在于：数据采集模块包括参数采集单元和图谱采集单元；参数采集单元用于采集每台设备的标识符和空闲速度；设备是指监测仪，空闲速度是指设备当前可提供数据传输的最高网速，将未在传输采集数据时空闲速度小于网速阈值的设备定义为故障设备；图谱采集单元用于采集关系图谱，关系图谱表示每台设备和与之具有蓝牙连接关系的其他设备之间的实际距离，在关系图谱中每台设备都存在一个或一个以上与之具有蓝牙连接关系的其他设备。8.根据权利要求7所述的一种基于物联网的数据管理系统，其特征在于：传输分析模块包括数据包流转单元和代理路径分析单元；数据包流转单元用于生成探测数据包并流转；首先，为故障设备生成状态为扩散的探测数据包，将与故障设备具有蓝牙连接关系的其他设备作为扩散设备，将探测数据包分别传输至各扩散设备；其次，其他设备接收到探测数据包后解析并获取状态；状态为扩散则生成传输记录和网速记录并放入探测数据包中；判断与本设备具有蓝牙连接关系设备的标识符是否都存在于探测数据包中，结果为是则将探测数据包状态设定为回传，结果为否则将与本设备具有蓝牙连接关系且不存在于探测数据包中的标识符对应设备作为扩散设备，通过蓝牙方式将探测数据包传输至各扩散设备；最后，若探测数据包状态为回传，则按照时间倒序对探测数据包内所有传输记录进行排列，按照排列顺序将探测数据包原封不动顺次传输至故障设备；代理路径分析单元用于规划代理路径并计算传输指数；故障设备接收并解析探测数据包，根据传输记录计算两设备之间的传输速度，并获取各网速记录中标识符对应设备的空闲速度；以故障设备为起点，其他设备为中间点或终点为故障设备规划代理路径；将代理路径内各设备之间的实际距离求和后作为传输总距离，从各设备之间的传输速度以及终点对应设备的空闲速度中选择最小的速度作为上传速度；通过每条代理路径的传输总距离和上传速度计算得到传输指数。9.根据权利要求8所述的一种基于物联网的数据管理系统，其特征在于：路径规划模块包括传输路径选择单元和传输路径调整单元；传输路径选择单元为故障设备选择传输指数最高的代理路径作为传输路径；传输路径调整单元用于实时调整故障设备的传输路径；首先，将传输路径中各中间点对应设备作为代理节点，终点对应设备作为上传节点，代理节点通过蓝牙将故障设备的采集数据传输至其他代理节点或上传节点，上传节点将采集数据通过无线网络上传至数据中心；其次，在传输过程中代理节点实时判断蓝牙传输速度是否小于上传速度，结果为是则作为异常代理节点；上传节点实时判断网络传输速度是否小于上传速度，结果为是则作为异常上传节点；以异常代理节点或异常上传节点为调整点，非异常代理节点为中间点，非异常上传节点为终点，从调整点到终点规划出不同的预调路径并计算传输指数，选择传输指数最高的预调路径作为调整路径；最后，将原传输路径中起点到调整点的部分路径加上调整路径后作为新的传输路径，继续传输采集数据并根据实际情况实时调整传输路径。10.根据权利要求9所述的一种基于物联网的数据管理系统，其特征在于：可视化模块通过数据中心的可视化大屏实时展示故障设备的传输路径和采集数据传输进度。
说明书desc
技术领域本发明涉及路径规划技术领域，具体为一种基于物联网的数据管理系统及方法。背景技术户外监测仪是一种用于监测环境数据的设备，包括气象环境监测或生态环境监测等。这些监测仪器通常被安置在户外环境中，用于实时采集并部署环境数据。因此，研究户外监测仪的数据管理，对于实时监测环境数据、提高环境数据的准确性和可靠性具有重要意义。现阶段，户外监测仪通常大量部署在户外环境中，出于安装便捷的目的每个户外监测仪通常采用独立的数据部署。然而，这种方案存在一定的弊端。例如：1、在一些偏远或复杂地形的户外环境中，网络覆盖可能存在不均匀或者盲区的情况，导致部分户外监测仪无法正常工作。2、户外环境可能存在较大的干扰源，如天气、植被、地形等因素都可能影响网络质量，使采集的环境数据无法按正常时间完成部署。3、当监测仪受到外界破坏或自身质量问题出现故障时，没有其他可用于协助工作的渠道，有效数据无法及时部署，数据中心丢失该监测仪所在区域的实时数据。所以，现阶段需要一种更加智能高效的数据管理技术方案来解决上述问题。发明内容本发明的目的在于提供一种基于物联网的数据管理系统及方法，以解决上述背景技术中提出的问题。为了解决上述技术问题，本发明提供如下技术方案：一种基于物联网的数据管理方法，该方法包括以下步骤：S100、采集关系图谱和每个设备的参数，设备根据参数判断自身是否发生故障，故障设备自动生成探测数据包，按照关系图谱中的连接关系将探测数据包传输到其他设备。S200、其他设备接收到探测数据包后自动解析，分析数据包状态选择原封不动回传至故障设备，或者在探测数据包中添加记录后再次传输至具有连接关系的其他设备。S300、故障设备接收到回传的探测数据包后自动解析，分析探测数据包中保存的记录为故障设备规划不同的代理路径，根据每条代理路径中设备的参数计算传输指数。S400、每个故障设备根据传输指数选择传输路径，按照传输路径进行数据传输，并在传输过程中实时调整传输路径，通过可视化大屏展示故障设备的传输信息。在S100中，关系图谱表示每台设备和与之具有蓝牙连接关系的其他设备之间的实际距离，在关系图谱中每台设备都存在一个或一个以上与之具有蓝牙连接关系的其他设备。设备是指监测仪，负责采集周边环境数据并通过无线网络将采集数据上传到数据中心，每台设备都各自保存一份关系图谱，不同设备保存的关系图谱相同。参数包括设备的标识符和空闲速度，标识符用于区分不同设备，空闲速度是指设备当前可提供数据传输的最高网速。判断设备是否故障及探测数据的传输具体步骤如下：S101、设备未在传输采集数据时的空闲速度小于网速阈值则为网络故障，将发生网络故障的设备定义为故障设备。每台监测仪都有两套通讯系统，包括近距离蓝牙信号通讯和远距离无线网络通讯；近距离蓝牙信号通讯用于监测仪之间的通信，远距离无线网络通讯用于监测仪与数据中心之间的通信。S102、为每个故障设备生成具有唯一识别码的探测数据包，将探测数据包状态设定为扩散，记录当前时间T1作为发送时间，将故障设备作为发送方，发送方的标识符和发送时间一起存入对应探测数据包中，并加入填充数据使得探测数据包的数据量为Q。探测数据包由每个故障设备自主生成，当设备检测到自身出现网络故障时，自动生成具有唯一识别码的探测数据包并保存唯一识别码，以便后续判定接收到的探测数据包是否为本设备所生成的。填充数据是指无实际意义仅充当数据量填充的数据，主要目的是为了使探测数据包在各设备之间传输过程中的数据量保持一致，方便后续传输速度的统一计算，避免由于探测数据包的数据量过小或不稳定所导致的传输速度计算不够精准的问题发生。S103、在关系图谱中分别检索与每个故障设备具有蓝牙连接关系的其他设备作为扩散设备，每个故障设备通过蓝牙方式将各自的探测数据包分别传输到对应扩散设备上。在S200中，具体步骤如下：S201、设备接收到其他设备传递过来的探测数据包后记录接收时间，解析探测数据包后获取探测数据包的状态，状态为回传则进入S204步骤，状态为扩散则获取探测数据包中发送方的标识符和发送时间，将本设备作为接收方，接收方的标识符和接收时间与发送方的标识符和发送时间一起生成一条传输记录，再获取当前时间T2以及当前时间T2下本设备的空闲速度，当前时间T2作为采集时间，将本设备的标识符、采集时间和空闲速度一起生成一条网速记录。S202、建立一个对比集合，将探测数据包中每条网速记录的标识符依次放入对比集合中，在关系图谱中检索与本设备具有蓝牙连接关系的其他设备标识符，判断这些标识符是否都存在于对比集合中，结果为否则进入S203步骤，结果为是则将探测数据包状态设定为回传并进入S204步骤。S203、获取关系图谱中与本设备具有蓝牙连接关系且不存在于对比集合中的设备作为扩散设备，记录当前时间T3作为发送时间，将本设备作为发送方，发送方的标识符与发送时间、传输记录和网速记录一起存入对应探测数据包中，并加入填充数据使得探测数据包的数据量为Q，通过蓝牙方式将探测数据包分别传输到对应扩散设备上，进入S201步骤在扩散设备上继续为探测数据包生成传输记录和网速记录。S204、对探测数据包内所有传输记录中发送方的标识符按照发送时间倒序进行排列，将本设备标识符之后的下一个标识符对应设备作为回传设备，通过蓝牙方式将探测数据包传输到回传设备上后再次重复S204步骤继续传输，直到探测数据包传输至排序最后一个标识符对应设备上，则传输终止。在S300中，故障设备接收到其他设备传递过来的探测数据包后，分析每个数据包的唯一识别码，将与之前生成探测数据包相同唯一识别码的探测数据包进行解析，规划代理路径并计算传输指数，具体步骤如下：S301、解析每个与之前生成探测数据包相同唯一识别码的探测数据包，将这些探测数据包中所有传输记录和所有网速记录分别进行数据汇总，将每条传输记录的接收时间减去发送时间得到传输时长，数据量Q除以传输时长得到该传输记录中发送方与接收方之间的传输速度。S302、不同传输记录存在相同发送方和接收方时，选择接收时间最晚的传输记录所对应的传输速度作为发送方与接收方之间的传输速度。不同网速记录存在相同标识符时，选择采集时间最晚的网速记录中空闲速度作为该网速记录中标识符对应设备的空闲速度。以故障设备为起点，其他设备为中间点或终点，按照关系图谱中各设备之间的蓝牙连接关系为故障设备规划不同的代理路径。代理路径的数量由设备数量决定，除故障设备以外的每台设备都能充当中间点或终点来建立代理路径，故有些代理路径存在中间点，有些代理路径不存在中间点。不存在中间点的代理路径是与故障设备直连的设备，关系图谱中有多少条与故障设备存在蓝牙连接关系的其他设备就有多少条无中间点的代理路径。S303、当代理路径中不存在中间点时，在关系图谱中获取起点和终点对应两设备之间的实际距离作为传输总距离，在起点与终点之间的传输速度和终点对应设备的空闲速度中选择最小的速度作为上传速度；当代理路径中存在中间点时，在关系图谱中获取从起点到终点所经过的各设备之间的实际距离进行求和后作为传输总距离，从起点到终点所经过的各设备之间的传输速度以及终点对应设备的空闲速度中选择最小的速度作为上传速度；将每条代理路径的传输总距离和上传速度代入公式中计算传输指数，公式如下：式中，为传输指数，/＞为常数，/＞为上传速度，/＞为网速阈值，为传输总距离，/＞为中间点对应设备数量，/＞为设备之间最佳传输距离。中间点对应设备接收到数据后会立即传输至下一个中间点或终点对应设备，终点对应设备接收到其他设备通过蓝牙传输过来的数据后也会立即通过无线网络传输至数据中心。整个代理路径中，能够决定上传速度的只有从起点到终点所经过的各设备之间的传输速度以及终点对应设备的空闲速度中最小的速度。蓝牙传输数据时，数据传输质量和效率容易受到设备之间的实际距离影响，实际距离越大，数据传输质量和效率也就越低。计算每条代理路径的传输指数时，不光需要考虑上传速度对数据传输的影响，同时也需要考虑代理路径下各设备之间的实际距离对数据传输的影响。在S400中，每个故障设备选择传输指数最高的代理路径作为传输路径，通过传输路径将故障设备的采集数据上传至数据中心。具体传输步骤如下：S401、先将传输路径、上传速度和探测数据包一起打包后作为导航数据包，按照传输路径对应设备的传输顺序将导航数据包依次传输到各设备后，再将传输路径中各中间点对应设备作为代理节点，终点对应设备作为上传节点，代理节点通过蓝牙方式将故障设备采集数据传输至下一个代理节点或上传节点，上传节点将接收到的采集数据与导航数据包一起通过无线网络上传至数据中心。S402、传输过程中，代理节点实时监测并分析采集数据通过蓝牙传输到下一个代理节点或上传节点的蓝牙传输速度是否小于导航数据包中的上传速度，结果为否则不做处理，结果为是则将对应代理节点作为异常代理节点。上传节点实时监测并分析采集数据通过无线网络传输到数据中心的网络传输速度是否小于导航数据包中的上传速度，结果为否则不做处理，结果为是则将对应上传节点作为异常上传节点。故障设备能够作为其他故障设备的代理节点，但由于空闲速度原因不能作为其他故障设备的上传节点。当代理节点或上传节点作为异常代理节点或异常上传节点时，需要记录异常类型和标识符存入导航数据包中。导航数据包发生变动后第一时间通过蓝牙传输至传输路径下其他代理节点或上传节点，保证每个节点设备的导航数据包内容一致，同时也方便传输路径的实时调整。传输路径调整时，优先调整距离故障设备最近的异常代理节点或异常上传节点。S403、以异常代理节点或异常上传节点为调整点，非异常代理节点为中间点，非异常上传节点为终点，按照关系图谱中各设备之间的蓝牙连接关系从调整点到终点规划出不同的预调路径，根据导航数据包内探测数据包中的数据分别计算每条预调路径的传输总距离和上传速度，带入公式计算传输指数，选择传输指数最高的预调路径作为调整路径。S404、将原传输路径中起点到调整点的部分路径加上调整路径后作为新的传输路径，进入S401步骤继续传输采集数据并根据实际情况实时调整传输路径，直到故障设备的所有采集数据都全部上传至数据中心则停止传输。S405、导航数据包每次变动后都会重新上传至数据中心，数据中心解析导航数据包并通过可视化大屏实时展示故障设备的传输路径和采集数据传输进度。一种基于物联网的数据管理系统，系统包括数据采集模块、传输分析模块、路径规划模块和可视化模块。数据采集模块用于采集关系图谱和每个设备的参数，参数异常则作为故障设备。传输分析模块为故障设备生成探测数据包，按照关系图谱中的连接关系发送至其他设备上流转，流转完成后进行回传，故障设备根据回传的探测数据包规划代理路径并计算传输指数。路径规划模块根据传输指数选择传输路径，并生成导航数据包发送至传输路径下各设备，数据传输过程中实时监测传输速度，对比导航数据包内数据判断是否异常，异常情况则调整传输路径。可视化模块通过可视化大屏实时展示故障设备的传输信息。数据采集模块包括参数采集单元和图谱采集单元。参数采集单元用于采集每台设备的标识符和空闲速度。设备是指监测仪，空闲速度是指设备当前可提供数据传输的最高网速，将未在传输采集数据时空闲速度小于网速阈值的设备定义为故障设备。图谱采集单元用于采集关系图谱，关系图谱表示每台设备和与之具有蓝牙连接关系的其他设备之间的实际距离，在关系图谱中每台设备都存在一个或一个以上与之具有蓝牙连接关系的其他设备。传输分析模块包括数据包流转单元和代理路径分析单元。数据包流转单元用于生成探测数据包并流转。首先，为故障设备生成状态为扩散的探测数据包，在关系图谱中检索与故障设备具有蓝牙连接关系的其他设备作为扩散设备，将探测数据包分别传输至各扩散设备。其次，设备接收到探测数据包后解析并获取探测数据包的状态；状态为扩散则根据本设备的参数生成传输记录和网速记录放入探测数据包中；在关系图谱中检索与本设备具有蓝牙连接关系设备的标识符，判断这些标识符是否都存在于探测数据包内所有网速记录中，结果为是则将探测数据包状态设定为回传，结果为否则获取与本设备具有蓝牙连接关系且不存在于探测数据包内所有网速记录中的标识符对应设备作为扩散设备，通过蓝牙方式将探测数据包分别传输至各扩散设备。最后，若探测数据包状态为回传，则按照时间倒序对探测数据包内所有传输记录进行排列，按照排列顺序将探测数据包原封不动顺次传输至故障设备。代理路径分析单元用于规划代理路径并计算传输指数。首先，故障设备接收并解析探测数据包，将发送方与接收方都相同的传输记录化为同类，标识符相同的网速记录化为同类，计算每条传输记录的传输速度，同类中选择接收时间最晚传输记录的传输速度作为发送方与接收方之间的传输速度，同类中选择采集时间最晚的网速记录的空闲速度作为标识符对应设备的空闲速度。其次，以故障设备为起点，其他设备为中间点或终点，按照关系图谱中蓝牙连接关系为故障设备规划代理路径，代理路径中不存在中间点则获取起点和终点对应两设备之间的实际距离作为传输总距离，在起点与终点之间的传输速度和终点对应设备的空闲速度中选择最小的速度作为上传速度；代理路径中存在中间点则获取从起点到终点所经过的各设备之间的实际距离求和后作为传输总距离，从起点到终点所经过的各设备之间的传输速度以及终点对应设备的空闲速度中选择最小的速度作为上传速度。最后，将传输总距离和上传速度代入公式：中，分别计算每条代理路径的传输指数；其中，/＞为常数，/＞为上传速度，/＞为网速阈值，为传输总距离，/＞为中间点对应设备数量，/＞为设备之间最佳传输距离。路径规划模块包括传输路径选择单元和传输路径调整单元。传输路径选择单元为故障设备选择传输指数最高的代理路径作为传输路径。传输路径调整单元用于实时调整故障设备的传输路径。首先，将传输路径中各中间点对应设备作为代理节点，终点对应设备作为上传节点，代理节点通过蓝牙将故障设备的采集数据传输至其他代理节点或上传节点，上传节点将采集数据通过无线网络上传至数据中心。其次，在传输过程中代理节点实时判断蓝牙传输速度是否小于上传速度，结果为是则作为异常代理节点；上传节点实时判断网络传输速度是否小于上传速度，结果为是则作为异常上传节点；以异常代理节点或异常上传节点为调整点，非异常代理节点为中间点，非异常上传节点为终点，从调整点到终点规划出不同的预调路径并计算传输指数，选择传输指数最高的预调路径作为调整路径。最后，将原传输路径中起点到调整点的部分路径加上调整路径后作为新的传输路径，继续传输采集数据并根据实际情况实时调整传输路径。可视化模块通过数据中心的可视化大屏实时展示故障设备的传输路径和采集数据传输进度。与现有技术相比，本发明所达到的有益效果是：1、分布式数据处理：本申请通过设备实时检测自身空闲速度来定义是否为故障设备，故障设备通过蓝牙传输探测数据包来获取其他设备信息。采用分布式数据处理实现各故障设备为自身规划传输路径且不需要固定数据处理平台，相比于传统的固定数据处理平台更加灵活分配和利用算力资源。2、智能化数据传输：本申请采用蓝牙方式来连接各设备，多个设备搭建代理线路进行数据传输，不会干扰其他设备通过无线网络传输自身的采集数据。通过计算各代理路径的传输指数也能快速找到稳定高速的传输路径进行传输，相比于传统的单一传输渠道更加智能化，减少数据丢失概率风险。3、高效化路径调整：本申请在故障设备的采集数据传输过程中，实时监测并分析各代理节点和上传节点的速度。当某个节点的速度小于之前获取的上传速度时，及时从异常节点开始重新规划调整路径实现传输路径的调整，相比于传统技术采用的固定传输路径更加高效化，提高数据传输效率。综上所述，本发明相比于传统技术具有分布式数据处理、智能化数据传输和高效化路径调整的优势，能够提高传输效率。附图说明附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。在附图中：图1是本发明一种基于物联网的数据管理方法的流程示意图；图2是本发明一种基于物联网的数据管理系统的结构示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。请参阅图1，本发明提供一种基于物联网的数据管理方法，该方法包括以下步骤：S100、采集关系图谱和每个设备的参数，设备根据参数判断自身是否发生故障，故障设备自动生成探测数据包，按照关系图谱中的连接关系将探测数据包传输到其他设备。S200、其他设备接收到探测数据包后自动解析，分析数据包状态选择原封不动回传至故障设备，或者在探测数据包中添加记录后再次传输至具有连接关系的其他设备。S300、故障设备接收到回传的探测数据包后自动解析，分析探测数据包中保存的记录为故障设备规划不同的代理路径，根据每条代理路径中设备的参数计算传输指数。S400、每个故障设备根据传输指数选择传输路径，按照传输路径进行数据传输，并在传输过程中实时调整传输路径，通过可视化大屏展示故障设备的传输信息。在S100中，关系图谱表示每台设备和与之具有蓝牙连接关系的其他设备之间的实际距离，在关系图谱中每台设备都存在一个或一个以上与之具有蓝牙连接关系的其他设备。设备是指监测仪，负责采集周边环境数据并通过无线网络将采集数据上传到数据中心，每台设备都各自保存一份关系图谱，不同设备保存的关系图谱相同。参数包括设备的标识符和空闲速度，标识符用于区分不同设备，空闲速度是指设备当前可提供数据传输的最高网速。判断设备是否故障及探测数据的传输具体步骤如下：S101、设备未在传输采集数据时的空闲速度小于网速阈值则为网络故障，将发生网络故障的设备定义为故障设备。每台监测仪都有两套通讯系统，包括近距离蓝牙信号通讯和远距离无线网络通讯；近距离蓝牙信号通讯用于监测仪之间的通信，远距离无线网络通讯用于监测仪与数据中心之间的通信。S102、为每个故障设备生成具有唯一识别码的探测数据包，将探测数据包状态设定为扩散，记录当前时间T1作为发送时间，将故障设备作为发送方，发送方的标识符和发送时间一起存入对应探测数据包中，并加入填充数据使得探测数据包的数据量为Q。探测数据包由每个故障设备自主生成，当设备检测到自身出现网络故障时，自动生成具有唯一识别码的探测数据包并保存唯一识别码，以便后续判定接收到的探测数据包是否为本设备所生成的。填充数据是指无实际意义仅充当数据量填充的数据，主要目的是为了使探测数据包在各设备之间传输过程中的数据量保持一致，方便后续传输速度的统一计算，避免由于探测数据包的数据量过小或不稳定所导致的传输速度计算不够精准的问题发生。S103、在关系图谱中分别检索与每个故障设备具有蓝牙连接关系的其他设备作为扩散设备，每个故障设备通过蓝牙方式将各自的探测数据包分别传输到对应扩散设备上。在S200中，具体步骤如下：S201、设备接收到其他设备传递过来的探测数据包后记录接收时间，解析探测数据包后获取探测数据包的状态，状态为回传则进入S204步骤，状态为扩散则获取探测数据包中发送方的标识符和发送时间，将本设备作为接收方，接收方的标识符和接收时间与发送方的标识符和发送时间一起生成一条传输记录，再获取当前时间T2以及当前时间T2下本设备的空闲速度，当前时间T2作为采集时间，将本设备的标识符、采集时间和空闲速度一起生成一条网速记录。S202、建立一个对比集合，将探测数据包中每条网速记录的标识符依次放入对比集合中，在关系图谱中检索与本设备具有蓝牙连接关系的其他设备标识符，判断这些标识符是否都存在于对比集合中，结果为否则进入S203步骤，结果为是则将探测数据包状态设定为回传并进入S204步骤。S203、获取关系图谱中与本设备具有蓝牙连接关系且不存在于对比集合中的设备作为扩散设备，记录当前时间T3作为发送时间，将本设备作为发送方，发送方的标识符与发送时间、传输记录和网速记录一起存入对应探测数据包中，并加入填充数据使得探测数据包的数据量为Q，通过蓝牙方式将探测数据包分别传输到对应扩散设备上，进入S201步骤在扩散设备上继续为探测数据包生成传输记录和网速记录。S204、对探测数据包内所有传输记录中发送方的标识符按照发送时间倒序进行排列，将本设备标识符之后的下一个标识符对应设备作为回传设备，通过蓝牙方式将探测数据包传输到回传设备上后再次重复S204步骤继续传输，直到探测数据包传输至排序最后一个标识符对应设备上，则传输终止。在S300中，故障设备接收到其他设备传递过来的探测数据包后，分析每个数据包的唯一识别码，将与之前生成探测数据包相同唯一识别码的探测数据包进行解析，规划代理路径并计算传输指数，具体步骤如下：S301、解析每个与之前生成探测数据包相同唯一识别码的探测数据包，将这些探测数据包中所有传输记录和所有网速记录分别进行数据汇总，将每条传输记录的接收时间减去发送时间得到传输时长，数据量Q除以传输时长得到该传输记录中发送方与接收方之间的传输速度。S302、不同传输记录存在相同发送方和接收方时，选择接收时间最晚的传输记录所对应的传输速度作为发送方与接收方之间的传输速度。不同网速记录存在相同标识符时，选择采集时间最晚的网速记录中空闲速度作为该网速记录中标识符对应设备的空闲速度。以故障设备为起点，其他设备为中间点或终点，按照关系图谱中各设备之间的蓝牙连接关系为故障设备规划不同的代理路径。代理路径的数量由设备数量决定，除故障设备以外的每台设备都能充当中间点或终点来建立代理路径，故有些代理路径存在中间点，有些代理路径不存在中间点。不存在中间点的代理路径是与故障设备直连的设备，关系图谱中有多少条与故障设备存在蓝牙连接关系的其他设备就有多少条无中间点的代理路径。S303、当代理路径中不存在中间点时，在关系图谱中获取起点和终点对应两设备之间的实际距离作为传输总距离，在起点与终点之间的传输速度和终点对应设备的空闲速度中选择最小的速度作为上传速度；当代理路径中存在中间点时，在关系图谱中获取从起点到终点所经过的各设备之间的实际距离进行求和后作为传输总距离，从起点到终点所经过的各设备之间的传输速度以及终点对应设备的空闲速度中选择最小的速度作为上传速度；将每条代理路径的传输总距离和上传速度代入公式中计算传输指数，公式如下：式中，为传输指数，/＞为常数，/＞为上传速度，/＞为网速阈值，为传输总距离，/＞为中间点对应设备数量，/＞为设备之间最佳传输距离。中间点对应设备接收到数据后会立即传输至下一个中间点或终点对应设备，终点对应设备接收到其他设备通过蓝牙传输过来的数据后也会立即通过无线网络传输至数据中心。整个代理路径中，能够决定上传速度的只有从起点到终点所经过的各设备之间的传输速度以及终点对应设备的空闲速度中最小的速度。蓝牙传输数据时，数据传输质量和效率容易受到设备之间的实际距离影响，实际距离越大，数据传输质量和效率也就越低。计算每条代理路径的传输指数时，不光需要考虑上传速度对数据传输的影响，同时也需要考虑代理路径下各设备之间的实际距离对数据传输的影响。在S400中，每个故障设备选择传输指数最高的代理路径作为传输路径，通过传输路径将故障设备的采集数据上传至数据中心。具体传输步骤如下：S401、先将传输路径、上传速度和探测数据包一起打包后作为导航数据包，按照传输路径对应设备的传输顺序将导航数据包依次传输到各设备后，再将传输路径中各中间点对应设备作为代理节点，终点对应设备作为上传节点，代理节点通过蓝牙方式将故障设备采集数据传输至下一个代理节点或上传节点，上传节点将接收到的采集数据与导航数据包一起通过无线网络上传至数据中心。S402、传输过程中，代理节点实时监测并分析采集数据通过蓝牙传输到下一个代理节点或上传节点的蓝牙传输速度是否小于导航数据包中的上传速度，结果为否则不做处理，结果为是则将对应代理节点作为异常代理节点。上传节点实时监测并分析采集数据通过无线网络传输到数据中心的网络传输速度是否小于导航数据包中的上传速度，结果为否则不做处理，结果为是则将对应上传节点作为异常上传节点。故障设备能够作为其他故障设备的代理节点，但由于空闲速度原因不能作为其他故障设备的上传节点。当代理节点或上传节点作为异常代理节点或异常上传节点时，需要记录异常类型和标识符存入导航数据包中。导航数据包发生变动后第一时间通过蓝牙传输至传输路径下其他代理节点或上传节点，保证每个节点设备的导航数据包内容一致，同时也方便传输路径的实时调整。传输路径调整时，优先调整距离故障设备最近的异常代理节点或异常上传节点。S403、以异常代理节点或异常上传节点为调整点，非异常代理节点为中间点，非异常上传节点为终点，按照关系图谱中各设备之间的蓝牙连接关系从调整点到终点规划出不同的预调路径，根据导航数据包内探测数据包中的数据分别计算每条预调路径的传输总距离和上传速度，带入公式计算传输指数，选择传输指数最高的预调路径作为调整路径。S404、将原传输路径中起点到调整点的部分路径加上调整路径后作为新的传输路径，进入S401步骤继续传输采集数据并根据实际情况实时调整传输路径，直到故障设备的所有采集数据都全部上传至数据中心则停止传输。S405、导航数据包每次变动后都会重新上传至数据中心，数据中心解析导航数据包并通过可视化大屏实时展示故障设备的传输路径和采集数据传输进度。请参阅图2，本发明提供一种基于物联网的数据管理系统，系统包括数据采集模块、传输分析模块、路径规划模块和可视化模块。数据采集模块用于采集关系图谱和每个设备的参数，参数异常则作为故障设备。传输分析模块为故障设备生成探测数据包，按照关系图谱中的连接关系发送至其他设备上流转，流转完成后进行回传，故障设备根据回传的探测数据包规划代理路径并计算传输指数。路径规划模块根据传输指数选择传输路径，并生成导航数据包发送至传输路径下各设备，数据传输过程中实时监测传输速度，对比导航数据包内数据判断是否异常，异常情况则调整传输路径。可视化模块通过可视化大屏实时展示故障设备的传输信息。数据采集模块包括参数采集单元和图谱采集单元。参数采集单元用于采集每台设备的标识符和空闲速度。设备是指监测仪，空闲速度是指设备当前可提供数据传输的最高网速，将未在传输采集数据时空闲速度小于网速阈值的设备定义为故障设备。图谱采集单元用于采集关系图谱，关系图谱表示每台设备和与之具有蓝牙连接关系的其他设备之间的实际距离，在关系图谱中每台设备都存在一个或一个以上与之具有蓝牙连接关系的其他设备。传输分析模块包括数据包流转单元和代理路径分析单元。数据包流转单元用于生成探测数据包并流转。首先，为故障设备生成状态为扩散的探测数据包，在关系图谱中检索与故障设备具有蓝牙连接关系的其他设备作为扩散设备，将探测数据包分别传输至各扩散设备。其次，设备接收到探测数据包后解析并获取探测数据包的状态；状态为扩散则根据本设备的参数生成传输记录和网速记录放入探测数据包中；在关系图谱中检索与本设备具有蓝牙连接关系设备的标识符，判断这些标识符是否都存在于探测数据包内所有网速记录中，结果为是则将探测数据包状态设定为回传，结果为否则获取与本设备具有蓝牙连接关系且不存在于探测数据包内所有网速记录中的标识符对应设备作为扩散设备，通过蓝牙方式将探测数据包分别传输至各扩散设备。最后，若探测数据包状态为回传，则按照时间倒序对探测数据包内所有传输记录进行排列，按照排列顺序将探测数据包原封不动顺次传输至故障设备。代理路径分析单元用于规划代理路径并计算传输指数。首先，故障设备接收并解析探测数据包，将发送方与接收方都相同的传输记录化为同类，标识符相同的网速记录化为同类，计算每条传输记录的传输速度，同类中选择接收时间最晚传输记录的传输速度作为发送方与接收方之间的传输速度，同类中选择采集时间最晚的网速记录的空闲速度作为标识符对应设备的空闲速度。其次，以故障设备为起点，其他设备为中间点或终点，按照关系图谱中蓝牙连接关系为故障设备规划代理路径，代理路径中不存在中间点则获取起点和终点对应两设备之间的实际距离作为传输总距离，在起点与终点之间的传输速度和终点对应设备的空闲速度中选择最小的速度作为上传速度；代理路径中存在中间点则获取从起点到终点所经过的各设备之间的实际距离求和后作为传输总距离，从起点到终点所经过的各设备之间的传输速度以及终点对应设备的空闲速度中选择最小的速度作为上传速度。最后，将传输总距离和上传速度代入公式：中，分别计算每条代理路径的传输指数；其中，/＞为常数，/＞为上传速度，/＞为网速阈值，为传输总距离，/＞为中间点对应设备数量，/＞为设备之间最佳传输距离。路径规划模块包括传输路径选择单元和传输路径调整单元。传输路径选择单元为故障设备选择传输指数最高的代理路径作为传输路径。传输路径调整单元用于实时调整故障设备的传输路径。首先，将传输路径中各中间点对应设备作为代理节点，终点对应设备作为上传节点，代理节点通过蓝牙将故障设备的采集数据传输至其他代理节点或上传节点，上传节点将采集数据通过无线网络上传至数据中心。其次，在传输过程中代理节点实时判断蓝牙传输速度是否小于上传速度，结果为是则作为异常代理节点；上传节点实时判断网络传输速度是否小于上传速度，结果为是则作为异常上传节点；以异常代理节点或异常上传节点为调整点，非异常代理节点为中间点，非异常上传节点为终点，从调整点到终点规划出不同的预调路径并计算传输指数，选择传输指数最高的预调路径作为调整路径。最后，将原传输路径中起点到调整点的部分路径加上调整路径后作为新的传输路径，继续传输采集数据并根据实际情况实时调整传输路径。可视化模块通过数据中心的可视化大屏实时展示故障设备的传输路径和采集数据传输进度。实施例1：假设某故障设备共规划A1和A2两条代理路径，A1代理路径中存在2个中间点，传输总距离为12m，上传速度为2MB/S；A2代理路径中存在3个中间点，传输总距离为20m，上传速度为1.5MB/S；当常数为0.2，网速阈值为1MB/S，设备之间最佳传输距离为3m时，带入公式分别计算A1和A2代理路径的传输指数：A1传输指数：/＞A2传输指数：故障设备选择A1代理路径作为传输路径。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。最后应说明的是：以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
