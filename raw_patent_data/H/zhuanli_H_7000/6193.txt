标题title
一种利用VSG的微网系统多状态对象协同控制的方法
摘要abst
本发明公开了一种利用VSG的微网系统多状态对象协同控制的方法，属于微网系统联合控制技术领域。构建水轮发电机组弹性水击下的非线性模型、VSG五阶模型及风电一阶惯性模型；建立在VSG下的水轮发电机组与风电机组构成的微网系统的功率平衡方程，并得到此多源微网系统的母线频率计算公式；引入协同控制理论，分别选取了联合有功和无功的宏变量，代入到协同控制宏观变量收敛的动态中；导出控制率Pref和Qref，将得到的值引入到VSG模型中进行实时调节。本发明引入具有快速响应能力的VSG参与调节，并将协同控制理论应用到微网系统联合控制中，能够建立多源系统之间的联系，及时反馈调节信息，实现对变化的快速调节，使得控制效果更优。
权利要求书clms
1.一种利用VSG的微网系统多状态对象协同控制的方法，其特征在于：引入协同控制理论，对多源微网系统进行联合控制，具体包括如下步骤：S1.构建水轮发电机组弹性水击下的非线性模型、VSG五阶模型及风电一阶惯性模型；S2.建立在VSG下的水轮发电机组与风电机组构成的微网系统的功率平衡方程，并得到此多源微网系统的母线频率计算公式；S3.引入协同控制理论，分别选取了联合有功和无功的宏变量，代入到协同控制宏观变量收敛的动态中；S4.导出控制率Pref和Qref，将得到的值引入到VSG模型中进行实时调节。2.根据权利要求1所述的一种利用VSG的微网系统多状态对象协同控制的方法，其特征在于：所述步骤S1的具体步骤如下：S101.水轮发电机组弹性水击下的非线性模型构建步骤如下：水电机单机单管弹性水击非线性模型表示为：其中，x1、x2和x3是管道瞬态水力计算的状态变量；Zn是管道水力冲击阻抗的归一化值，Te是管道的弹性时间常数；h0为水电站静压头的相对值；fp是管道水头损失系数；q是管道流量；Ty是机组主伺服电机的时间常数；u是机组调速器控制回路的输出控制信号；y0是机组主伺服马达的初始位移值，y为主接力器位移标幺值；yr为额定负荷时主接力器位移标幺值；水轮机力矩原有模型为微分化后可得其中，At是水轮发电机组的涡轮增益系数；qnl是水轮机空载流量的单位值；结合发电机三阶模型，得到水轮发电机组弹性水击下的非线性模型，表示为：其中，δh是转子q轴与发电机x轴的电角度；ωB是发电机转子的同步速度；ωh是发电机角速度的相对值；Tj是发电机组的惯性时间常数；pt是发电机涡轮的输出扭矩，即有效扭矩；pg是发电机的电磁转矩；D是发电机的阻尼因数；E'q是发电机的q轴瞬态电动势；Ef是励磁系统的输出励磁电压；Xd∑是d轴同步电抗；X'd∑为d轴瞬态电抗；Us是机器终端电压；Td0是发电机的励磁时间常数；S201.五阶VSG模型表示如下：其中，δ是VSG转子q轴与发电机x轴的电角度；ω是VSG角速度的相对值；TJ为VSG的惯性时间常数；Pref为VSG有功参考值；Eq是VSG的q轴瞬态电动势；LBD为VSG发电机阻尼系数；bpB为VSG有功下垂系数；bQB为VSG无功下垂系数；ΔEq是VSG的q轴瞬态电动势差；Xl为VSG电抗；TE为VSG无功调节系数；KE为VSG无功参考系数；Qref为VSG无功参考值；Id为VSG的d轴电流；Iq为VSG的q轴电流；R为VSG虚拟电阻；E0为VSG空载内电势；S103.风电一阶惯性模型可简化表示为其中，Pw为风电机的输出有功功率；P*w为有功功率参考值；τw为发电机等效时间常数。3.根据权利要求1所述的一种VSG参与下的微网系统的多状态对象协同控制方法，其特征在于：所述步骤S2中建立系统功率平衡方程及给出母线频率计算公式的具体步骤如下：S201.根据母线能量平衡可得：Pvsg+pg+Pw＝PLQvsg+Qg+Qw＝QL式中，pg，Qg为水轮发电机组输出有功和无功功率；Pvsg，Qvsg为VSG输出有功和无功功率；Pw，Qw为风电机组输出有功和无功功率；PL，QL为系统集成负荷的有功和无功功率，为目标定值，根据用户的负荷和需求设定一个具体的值；S202.母线频率BUSω为各发电机的加权平均值，权系数为Mi，即各发电机的惯性时间常数，可得其中，BUSω为母线频率，MT为各发电机的惯性时间常数之和，ωi为发电机转子角速度；S203.微网系统实际运行时的联合输出功率表示为PZ＝Pvsg+pg+PwQZ＝Qvsg+Qg+Qw其中，PZ、QZ为系统实际运行时的联合有功和无功输出。4.根据权利要求1所述的一种利用VSG的微网系统多状态对象协同控制的方法，其特征在于：所述步骤S3具体步骤如下：S301.选择状态变量ωh、ω和Pw的线性组合作为微网系统中电源联合有功控制部分的宏变量，得到：其中，ωhref是水轮发电机组转子角速度参考值；ωref是VSG角速度参考值；P*w是风电机组有功功率参考值；将选取的宏变量代入到协同控制宏观变量收敛的动态中可得S302.选择状态变量Eq和E’q的线性组合作为微网系统中电源联合无功控制部分的宏观变量：ψ2＝k1+k2其中，E’qref是水轮发电机组q轴瞬态电动势参考值；Eq是VSG的q轴瞬态电动势参考值；代入协同控制宏观变量收敛的动态中可得其中，ψ1和ψ2分别为系统有功和无功控制部分的宏变量；K1、K2、K3分别为水轮发电机组的角速度偏差、VSG的角速度偏差、风电机组的输出有功功率偏差的设计参数；k1和k2分别为水轮发电机组的q轴励磁电势偏差和VSG的q轴虚拟励磁电势偏差的设计参数；T1和T2分别为两个控制部分的时间控制参数。5.根据权利要求1所述的一种VSG参与下的微网系统的多状态对象协同控制方法，其特征在于：所述步骤S4中VSG的有功和无功参考值Pref和Qref具体如下：
说明书desc
技术领域本发明属于微网系统联合控制技术领域，具体涉及一种利用VSG的微网系统多状态对象协同控制的方法。背景技术微电网也译为微网，是指由分布式电源、储能装置、能量转换装置、负荷、监控和保护装置等组成的小型发配电系统，微电网是解决部分地区电力不足的新型方式。在由水轮发电机组与风电机组组成的微网系统里，水电机组与风电机组均与母线连接，向用电负载进行供电。其中，风电新能源受环境因素的影响，其随机性和波动性都比较大，导致供电稳定性较差，会给电网的安全稳定运行带来挑战，而水电机组由于惯性大、调解慢也会影响到用电质量，因此对于微网此类多状态多对象的控制变得极为重要。现有技术中采用的是传统PID控制技术，但在出现波动特别是风电机组功率受环境因素出现波动时，风电机组与水电机组功率都会出现较大波动，直接影响微网系统的供电稳定性，纠其原因在于PID控制技术应用到此类微网系统中时调节仍具有滞后性，且忽略了水电机组与风电机组间的相互影响，无法满足系统快速响应的需求。因此，亟需优化PID控制技术，开发一种调节更为快速、考虑两者件协同关系的控制方法。发明内容本发明的目的在于提供一种利用VSG的微网系统多状态对象协同控制的方法，解决现有技术在对微电网进行联合控制时效果不理想的问题。为解决上述的技术问题，本发明采用以下技术方案：一种利用VSG的微网系统多状态对象协同控制的方法，其特征在于：引入协同控制理论，对多源微网系统进行联合控制，具体包括如下步骤：S1.构建水轮发电机组弹性水击下的非线性模型、VSG五阶模型及风电一阶惯性模型；S2.建立在VSG下的水轮发电机组与风电机组构成的微网系统的功率平衡方程，并得到此多源微网系统的母线频率计算公式；S3.引入协同控制理论，分别选取了联合有功和无功的宏变量，代入到协同控制宏观变量收敛的动态中；S4.导出控制率Pref和Qref，将得到的值引入到VSG模型中进行实时调节。更进一步的技术方案是所述步骤S1的具体步骤如下：S101.水轮发电机组弹性水击下的非线性模型构建步骤如下：水电机单机单管弹性水击非线性模型表示为：其中，x1、x2和x3是管道瞬态水力计算的状态变量；Zn是管道水力冲击阻抗的归一化值，Te是管道的弹性时间常数；h0为水电站静压头的相对值；fp是管道水头损失系数；q是管道流量；Ty是机组主伺服电机的时间常数；u是机组调速器控制回路的输出控制信号；y0是机组主伺服马达的初始位移值，y为主接力器位移标幺值；yr为额定负荷时主接力器位移标幺值；水轮机力矩原有模型为微分化后可得其中，At是水轮发电机组的涡轮增益系数；qnl是水轮机空载流量的单位值；结合发电机三阶模型，得到水轮发电机组弹性水击下的非线性模型，表示为：其中，δh是转子q轴与发电机x轴的电角度；ωB是发电机转子的同步速度；ωh是发电机角速度的相对值；Tj是发电机组的惯性时间常数；pt是发电机的输出扭矩，即有效扭矩；pg是发电机的电磁转矩；D是发电机的阻尼因数；E'q是发电机的q轴瞬态电动势；Ef是励磁系统的输出励磁电压；Xd∑是d轴同步电抗；X'd∑为d轴瞬态电抗；Us是机器终端电压；Td0是发电机的励磁时间常数；S201.五阶VSG模型表示如下：其中，δ是VSG转子q轴与发电机x轴的电角度；ω是VSG角速度的相对值；TJ为VSG的惯性时间常数；Pref为VSG有功参考值；Eq是VSG的q轴瞬态电动势；LBD为VSG发电机阻尼系数；bpB为VSG有功下垂系数；bQB为VSG无功下垂系数；ΔEq是VSG的q轴瞬态电动势差；Xl为VSG电抗；TE为VSG无功调节系数；KE为VSG无功参考系数；Qref为VSG无功参考值；Id为VSG的d轴电流；Iq为VSG的q轴电流；R为VSG虚拟电阻；E0为VSG空载内电势；S103.风电一阶惯性模型可简化表示为其中，Pw为风电机的输出有功功率；P*w为有功功率参考值；τw为发电机等效时间常数。更进一步的技术方案是所述步骤S2中建立系统功率平衡方程及给出母线频率计算公式的具体步骤如下：S201.根据母线能量平衡可得：Pvsg+pg+Pw＝PLQvsg+Qg+Qw＝QL式中，pg，Qg为水轮发电机组输出有功和无功功率；Pvsg，Qvsg为VSG输出有功和无功功率；Pw，Qw为风电机组输出有功和无功功率；PL，QL为系统集成负荷的有功和无功功率，为目标定值，根据用户的负荷和需求设定一个具体的值。S202.母线频率BUSω为各发电机的加权平均值，权系数为Mi，即各发电机的惯性时间常数，可得其中，BUSω为母线频率，MT为各发电机的惯性时间常数之和，ωi为发电机转子角速度。S203.微网系统实际运行时的联合输出功率表示为PZ＝Pvsg+pg+PwQZ＝Qvsg+Qg+Qw其中，PZ、QZ为系统实际运行时的联合有功和无功输出。更进一步的技术方案是所述步骤S3具体步骤如下：S301.选择状态变量ωh、ω和Pw的线性组合作为微网系统中电源联合有功控制部分的宏变量，得到：其中，ωhref是水轮发电机组转子角速度参考值；ωref是VSG角速度参考值；P*w是风电机组有功功率参考值；将选取的宏变量代入到协同控制宏观变量收敛的动态中可得S302.选择状态变量Eq和E’q的线性组合作为微网系统中电源联合无功控制部分的宏变量：ψ2＝k1+k2其中，E’qref是水轮发电机组q轴瞬态电动势参考值；Eq是VSG的q轴瞬态电动势参考值；代入协同控制宏观变量收敛的动态中可得其中，ψ1和ψ2分别为系统有功和无功控制部分的宏变量；K1、K2、K3分别为水轮发电机组的角速度偏差、VSG的角速度偏差、风电机组的输出有功功率偏差的设计参数；k1和k2分别为水轮发电机组的q轴励磁电势偏差和VSG的q轴虚拟励磁电势偏差的设计参数；T1和T2分别为两个控制部分的时间控制参数。更进一步的技术方案是所述步骤S4中VSG的有功和无功参考值Pref和Qref具体如下：可以看出，得到的VSG有功和无功参考值里面包含着水轮发电机组、风电机组的主要变量，这些变量之间的相互联系通过协同控制输出体现，这种形式有助于整体控制。本发明的有益效果是：1.本发明将VSG引入到了微网系统中，建立水轮发电机组、风电机组与虚拟同步发电机间的功率平衡关系，引入协同控制理论，通过有功和无功宏变量将三个模型联系在一起，通过将三个模型所涉及的状态变量引入到选取的宏变量构成的协同控制器中，三个模型的状态变量变化和负荷通过控制器整合，得到所需响应最快的VSG的功率参考值，再将其反馈给VSG进行调节，这时候的VSG就可以按照微网系统所需的变化进行跟踪调节，从而实现整个系统的快速稳定。2.利用VSG其快速反应的特点对输出端口的功率进行补偿，使得功率输出能快速达到所需状态，缩短调节时间，运行更加平稳；引入了协同控制理论，采用多状态对象协同控制方法设计了多源微网系统的联合控制器，建立了各电源系统状态变量之间的联系，可降低忽略变量相互作用的影响；控制只对有快速反应能力的VSG进行反馈，降低了对其他系统的影响，从而减小整个微网系统的功率震荡。附图说明图1是本发明的系统结构示意图。图2是本发明的控制方法原理图；图3是风机有功参考值在阶跃扰动下PID控制与引入VSG控制的功率输出对比图；图4是风机有功参考值在阶跃扰动下引入VSG控制与本申请的功率输出对比图。具体实施方式下面结合附图和具体实施方式，对本发明作进一步说明。本发明是一种利用VSG的微网系统多状态对象协同控制的方法，其应用到微网系统的控制领域，具有重要的工程应用意义，在微网中使用可快速实现系统的稳定控制，减小震荡。具体地，引入协同控制理论，对多源微网系统进行联合控制，具体步骤为：S1.构建水轮发电机组弹性水击下的非线性模型、VSG五阶模型及风电一阶惯性模型。更为具体的步骤如下：S101.水轮发电机组弹性水击下的非线性模型构建步骤如下：水电机单机单管弹性水击非线性模型表示为：其中，x1、x2和x3是管道瞬态水力计算的状态变量；Zn是管道水力冲击阻抗的归一化值，Te是管道的弹性时间常数；h0为水电站静压头的相对值；fp是管道水头损失系数；q是管道流量；Ty是机组主伺服电机的时间常数；u是机组调速器控制回路的输出控制信号；y0是机组主伺服马达的初始位移值，y为主接力器位移标幺值；yr为额定负荷时主接力器位移标幺值。水轮机力矩原有模型为微分化后可得其中，At是水轮发电机组的涡轮增益系数；qnl是水轮机空载流量的单位值。结合发电机三阶模型，得到水轮发电机组弹性水击下的非线性模型，表示为：其中，δh是转子q轴与发电机x轴的电角度；ωB是发电机转子的同步速度；ωh是发电机角速度的相对值；Tj是发电机组的惯性时间常数；pt是发电机涡轮的输出扭矩，即有效扭矩；pg是发电机的电磁转矩；D是发电机的阻尼因数；E'q是发电机的q轴瞬态电动势；Ef是励磁系统的输出励磁电压；Xd∑是d轴同步电抗；X'd∑为d轴瞬态电抗；Us是机器终端电压；Td0是发电机的励磁时间常数。S102.五阶VSG模型表示如下：其中，δ是VSG转子q轴与发电机x轴的电角度；ω是VSG角速度的相对值；TJ为VSG的惯性时间常数；Pref为VSG有功参考值；Eq是VSG的q轴瞬态电动势；LBD为VSG发电机阻尼系数；bpB为VSG有功下垂系数；bQB为VSG无功下垂系数；ΔEq是VSG的q轴瞬态电动势差；Xl为VSG电抗；TE为VSG无功调节系数；KE为VSG无功参考系数；Qref为VSG无功参考值；Id为VSG的d轴电流；Iq为VSG的q轴电流；R为VSG虚拟电阻；E0为VSG空载内电势。S103.风电一阶惯性模型可简化表示为其中，Pw为风电机的输出有功功率；P*w为有功功率参考值；τw为发电机等效时间常数。S2.建立在VSG下的水轮发电机组与风电机组构成的微网系统的功率平衡方程，并得到此多源微网系统的母线频率计算公式。具体步骤如下：S201.根据母线能量平衡可得：Pvsg+pg+Pw＝PLQvsg+Qg+Qw＝QL式中，pg，Qg为水轮发电机组输出有功和无功功率；Pvsg，Qvsg为VSG输出有功和无功功率；Pw，Qw为风电机组输出有功和无功功率；PL，QL为系统集成负荷的有功和无功功率，为目标定值，根据用户的负荷和需求设定一个具体的值。S202.母线频率BUSω为各发电机的加权平均值，权系数为Mi，即各发电机的惯性时间常数，可得其中，BUSω为母线频率，MT为各发电机的惯性时间常数之和，ωi为发电机转子角速度。S203.微网系统实际运行时的联合输出功率表示为PZ＝Pvsg+pg+PwQZ＝Qvsg+Qg+Qw其中，PZ、QZ为系统实际运行时的联合有功和无功输出。S3.引入协同控制理论，分别选取了联合有功和无功的宏变量，代入到协同控制宏观变量收敛的动态中；更为具体的步骤如下：S301.选择状态变量ωh、ω和Pw的线性组合微网系统中电源联合有功控制部分的宏变量，得到：其中，ωhref是水轮发电机组转子角速度参考值；ωref是VSG角速度参考值；P*w是风电机组有功功率参考值；将选取的宏变量代入到协同控制宏观变量收敛的动态中可得S302.选择状态变量Eq和E’q的线性组合作为微网系统中电源联合无功控制部分的宏变量：ψ2＝k1+k2其中，E’qref是水轮发电机组q轴瞬态电动势参考值；Eq是VSG的q轴瞬态电动势参考值；代入协同控制宏观变量收敛的动态中可得其中，ψ1和ψ2分别为系统有功和无功控制部分的宏变量；K1、K2、K3分别为水轮发电机组的角速度偏差、VSG的角速度偏差、风电机组的输出有功功率偏差的设计参数；k1和k2分别为水轮发电机组的q轴励磁电势偏差和VSG的q轴虚拟励磁电势偏差的设计参数；T1和T2分别为两个控制部分的时间控制参数。S4.导出VSG的有功和无功参考值Pref和Qref，将得到的值引入到VSG模型中进行实时调节。VSG的有功和无功参考值Pref和Qref具体如下：可以看出，得到的VSG有功和无功参考值里面包含着水轮发电机组、风电机组的主要变量，这些变量之间的相互联系通过协同控制输出体现，这种形式有助于整体控制。接下来以某水轮发电机组的数据进行测试，具体过程如下：其特征参数为：Zn＝2.5062，fp＝0.0046。其他参数：Hr＝312m，Qr＝53.5m3/s，h0＝1.0166，Ty＝0.5，At＝1.1364，qnl＝0.12，Tj＝5，Td0＝5.4，Us＝1，D＝5，ωB＝314，TJ＝6.573，TE＝0.2，KE＝1，bpB＝10；bQB＝-35，LBD＝2，R＝0.001，Xl＝0.6，E0＝1，τw＝3。PID控制参数：KP＝8，KI＝5.5，KD＝1。通过本发明设计了微网多源状态对象协同控制器，获得风电机组功率参考值在阶跃波动下的输出功率图，如图3，4所示。从图中可以看出，水轮发电机组的初始运行为Pt＝0.6。工况设置：当t＝10s时，负载不变，风电机组有功功率参考值在发生阶跃变化下，由原来的0.8降低为0.6，此时水轮发电机组功率则由原来的0.6变为0.8。从图中可见，当风电机组输出功率发生变化时，本发明中的控制器能实时跟踪变化，在水轮发电机组达到所需调节状态前，利用VSG的快速反应先给予功率补给，减小了系统功率震荡。对比传统PID控制的系统，本发明中利用VSG的微网系统多状态对象协同控制的方法具有一定的控制优越性。
