标题title
一种LDPC码速率匹配最大层数的确定方法及装置
摘要abst
本发明公开了一种LDPC码速率匹配最大层数的确定方法及装置。在UE接入5G NR网络的过程中，网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于特定参数为最小值时的参考码块长度；UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值。在UE接入5G NR网络后，网络下发RRC配置消息，其中记载了网络是否选择配置maxMIMO‑Layers参数、maxRank参数。如果是，UE接收RRC配置消息，取得网络配置参数的取值，并将LDPC码速率匹配时使用的最大层数改为网络配置参数的取值与4中的较小者。如果否，UE接收RRC配置消息。本发明保证了速率匹配过程的准确。
权利要求书clms
1.一种LDPC码速率匹配最大层数的确定方法，其特征是，包括如下步骤；步骤S1：在UE接入5G NR网络的过程中，网络令maxMIMO-Layers参数或maxRank参数之一取最小值1并计算对应的参考码块长度；网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值；步骤S2：在UE接入5G NR网络后，网络下发RRC配置消息，其中记载了网络是否选择配置maxMIMO-Layers参数、maxRank参数；如果是，还记载所配置参数的取值；如果网络选择配置任一个或全部参数，进入步骤S3；否则进入步骤S4；步骤S3：UE接收RRC配置消息，取得网络配置参数的取值，并将LDPC码速率匹配时使用的最大层数改为网络配置参数的取值与4中的较小者；步骤S4：UE接收RRC配置消息，网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值。2.根据权利要求1所述的LDPC码速率匹配最大层数的确定方法，其特征是，下行场景中仅有maxMIMO-Layers参数；上行场景中有maxMIMO-Layers参数和/或maxRank参数；如上行场景中同时配置有maxMIMO-Layers参数和maxRank参数，则两者被配置为相同取值。3.根据权利要求1所述的LDPC码速率匹配最大层数的确定方法，其特征是，所述步骤S2中，如网络选择配置maxMIMO-Layers参数，其取值是1；如网络选择配置maxRank参数，其取值也是1。4.根据权利要求1所述的LDPC码速率匹配最大层数的确定方法，其特征是，以步骤S1a和步骤S1b的总和替代步骤S1；以步骤S4a替代步骤S4；步骤S1a：网络和UE预先约定在LDPC码速率匹配时使用的最大层数；步骤S1b：在UE接入5G NR网络的过程中，网络和UE在LDPC码速率匹配时使用的最大层数为约定值；所述步骤S2中的“进入步骤S4”改为“进入步骤S4a”；步骤S4a：UE接收RRC配置消息，网络和UE在LDPC码速率匹配时使用的最大层数为约定值。5.根据权利要求4所述的LDPC码速率匹配最大层数的确定方法，其特征是，所述步骤S1a中，网络和UE预先约定在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为Z1、上行共享信道的一个传输块使用的最大层数为Z2；对所有类型的UE，Z1是相同值，Z2也是相同值。6.根据权利要求5所述的LDPC码速率匹配最大层数的确定方法，其特征是，所述步骤S1a中，约定方式改为：不同类型的UE的Z1各自取值，不同类型的UE的Z2各自取值。7.根据权利要求5所述的LDPC码速率匹配最大层数的确定方法，其特征是，所述步骤S1a中，约定方式改为：不同类型的UE的Z1各自取值，不同类型的UE的Z2各自取值，且Z1的值为本小区所在的工作频段要求的UE最少接收天线端口数。8.根据权利要求1或2所述的LDPC码速率匹配最大层数的确定方法，其特征是，所述步骤S3、步骤S4或步骤S4a之后还包括如下步骤；步骤S5：网络接收UE的UE能力信息消息，从中获知UE支持的最大层数；网络准备发送RRC重配置消息给UE，其中记载了网络是否选择配置maxMIMO-Layers参数、maxRank参数；如果是，还记载所配置参数的取值；如果网络选择配置任一个或全部参数，进入步骤S6；否则进入步骤S7；步骤S6：网络下发RRC重配置消息；UE接收RRC重配置消息，取得网络配置参数的取值，并将LDPC码速率匹配时使用的最大层数改为网络配置参数的取值与4中的较小者；步骤S7：网络下发RRC重配置消息；UE接收RRC重配置消息，并将LDPC码速率匹配时使用的最大层数改为UE支持的最大层数与4中的较小者。9.一种LDPC码速率匹配最大层数的确定装置，其特征是，包括接入过程处理单元一、配置消息下发单元、配置消息处理单元一、配置消息处理单元二；所述接入过程处理单元一用于在UE接入5G NR网络的过程中，网络令maxMIMO-Layers参数或maxRank参数之一取最小值1并计算对应的参考码块长度；网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值；所述配置消息下发单元用于在UE接入5G NR网络后，网络下发RRC配置消息，其中记载了网络是否选择配置maxMIMO-Layers参数、maxRank参数；如果是，还记载所配置参数的取值；如果网络选择配置任一个或全部参数，进入配置消息处理单元一；否则进入配置消息处理单元二；所述配置消息处理单元一用于UE接收RRC配置消息，取得网络配置参数的取值，并将LDPC码速率匹配时使用的最大层数改为网络配置参数的取值与4中的较小者；所述配置消息处理单元二用于UE接收RRC配置消息，网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值。10.根据权利要求9所述的LDPC码速率匹配最大层数的确定装置，其特征是，以预先约定单元和接入过程处理单元二的总和替代接入过程处理单元一，以配置消息处理单元三替代配置消息处理单元二；所述预先约定单元用于网络和UE预先约定在LDPC码速率匹配时使用的最大层数；所述接入过程处理单元二用于在UE接入5G NR网络的过程中，网络和UE在LDPC码速率匹配时使用的最大层数为约定值；所述配置消息下发单元中的“进入配置消息处理单元二”改为“进入配置消息处理单元三”；所述配置消息处理单元三用于UE接收RRC配置消息，网络和UE在LDPC码速率匹配时使用的最大层数为约定值。
说明书desc
技术领域本发明涉及一种移动通信技术，特别是涉及一种LDPC码的速率匹配技术。背景技术5G NR。5G NR网络在下行共享信道、寻呼信道、上行共享信道中使用LDPC码来增加通信的可靠性。5G NR网络中，由于实际传输资源有限，需要通过速率匹配操作将LDPC编码后的数据和实际的传输资源对齐。网络侧和终端侧需要使用相同的速率匹配参数来对齐数据，以保证接收的数据能被正确地解速率匹配和解码。请参阅图1，5G NR网络进行LDPC码速率匹配中的比特选择过程时，首先需要获取速率匹配参数。所述速率匹配参数包括传输信道使用的最大层数v、最大调制阶数Qm、物理资源块个数nPRB、资源单元个数NRE、最高码率R。随后计算有限缓存速率匹配时的传输块大小TBSLBRM，进一步得到参考码块长度，其中/＞表示向下取整，C表示码块个数，有限缓存速率匹配时的参考码率RLBRM固定为2/3。所述参考码块长度是指速率匹配时用于参考的码块的长度。随后计算每个码块的循环缓存大小Ncb，Ncb＝min。其中min表示取最小值函数，N表示编码后的码块长度。随后根据Ncb获取不同冗余版本对应的起始位置k0值。最后根据k0值得到不同rv对应的速率匹配比特选择的输出序列。图1所示流程中，有一步骤需确定每个码块的循环缓存大小Ncb。Ncb的取值和传输信道使用的最大层数相关。如果是在下行共享信道中进行LDPC码速率匹配，传输信道使用的最大层数是指下行共享信道的一个传输块的最大层数，具体是指网络向UE发送PDSCH时使用的最大MIMO层数。如果是在上行共享信道中进行LDPC码速率匹配，传输信道使用的最大层数是指上行共享信道的一个传输块的最大层数，具体是指UE向网络发送PUSCH时使用的最大MIMO层数。传输信道使用的最大层数由网络配置和UE的能力共同决定。网络通过UE上报的能力信息获知UE支持的最大层数。所述UE支持的最大层数是指UE接收PDSCH或发送PUSCH时支持的最大MIMO层数，可能取值为1到8之间的整数或1到4之间的整数。在UE上报能力之后，网络按照UE的能力配置maxMIMO-Layers参数和/或maxRank参数，这两个参数均用于指示本小区级别的该UE的PDSCH或PUSCH使用的最大MIMO层数。但在UE上报能力之前，网络无法得知UE支持的最大层数，在此阶段网络和UE在计算Ncb时使用的最大层数可能并不匹配。因此在网络获得UE的能力信息之前，网络和UE的速率匹配参数可能存在差异，容易导致上下行数据传输出现错误，重传数据可能无法正确合并和解码。请参阅图2，UE和5G NR网络之间交互的基本流程先后包括T1、T2、T3、T4四个阶段。T1阶段为UE接入流程，在UE随机接入成功之后，网络下发RRC配置消息，向UE提供配置信息。T2阶段是UE收到RRC配置消息到上发UE能力信息消息之间，UE通过发送UE能力信息消息将自身的能力信息发送给网络。T3阶段是网络收到UE能力信息消息到发送RRC重配置消息之间，网络结合UE能力下发RRC重配置消息，配置传输信道使用的最大层数。T4阶段是UE成功接收RRC重配置消息之后。以上只列举和本专利申请相关的流程和消息，并不涉及全部的信令交互。发明内容本发明所要解决的技术问题是：在网络得知UE支持的最大层数之前，如何确定网络和UE在LDPC码速率匹配时传输信道使用的最大层数才能避免传输出错。为解决上述技术问题，本发明提出了一种LDPC码速率匹配最大层数的确定方法，包括如下步骤。步骤S1：在UE接入5G NR网络的过程中，网络令maxMIMO-Layers参数或maxRank参数之一取最小值1并计算对应的参考码块长度；网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值。步骤S2：在UE接入5G NR网络后，网络下发RRC配置消息，其中记载了网络是否选择配置maxMIMO-Layers参数、maxRank参数；如果是，还记载所配置参数的取值。如果网络选择配置任一个或全部参数，进入步骤S3；否则进入步骤S4。步骤S3：UE接收RRC配置消息，取得网络配置参数的取值，并将LDPC码速率匹配时使用的最大层数改为网络配置参数的取值与4中的较小者。步骤S4：UE接收RRC配置消息，网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值。进一步地，下行场景中仅有maxMIMO-Layers参数；上行场景中有maxMIMO-Layers参数和/或maxRank参数；如上行场景中同时配置有maxMIMO-Layers参数和maxRank参数，则两者被配置为相同取值。进一步地，所述步骤S2中，如网络选择配置maxMIMO-Layers参数，其取值是1；如网络选择配置maxRank参数，其取值也是1。这是一种优选取值方式，优势在于能适用于各种类型的UE。可选地，以步骤S1a和步骤S1b的总和替代步骤S1；以步骤S4a替代步骤S4。步骤S1a：网络和UE预先约定网络和UE在LDPC码速率匹配时使用的最大层数。步骤S1b：在UE接入5G NR网络的过程中，网络和UE在LDPC码速率匹配时使用的最大层数为约定值。所述步骤S2中的“进入步骤S4”改为“进入步骤S4a”。步骤S4a：UE接收RRC配置消息，网络和UE在LDPC码速率匹配时使用的最大层数为约定值。优选地，所述步骤S1a中，网络和UE预先约定网络和UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为Z1、上行共享信道的一个传输块使用的最大层数为Z2；对所有类型的UE，Z1是相同值，Z2也是相同值。优选地，所述步骤S1a中，约定方式改为：不同类型的UE的Z1各自取值，不同类型的UE的Z2各自取值。优选地，所述步骤S1a中，约定方式改为：不同类型的UE的Z1各自取值，不同类型的UE的Z2各自取值，且Z1的值为本小区所在的工作频段要求的UE最少接收天线端口数。进一步地，所述步骤S3、步骤S4或步骤S4a之后还包括如下步骤。步骤S5：网络接收UE的UE能力信息消息，从中获知UE支持的最大层数；网络准备发送RRC重配置消息给UE，其中记载了网络是否选择配置maxMIMO-Layers参数、maxRank参数；如果是，还记载所配置参数的取值。如果网络选择配置任一个或全部参数，进入步骤S6；否则进入步骤S7。步骤S6：网络下发RRC重配置消息；UE接收RRC重配置消息，取得网络配置参数的取值，并将LDPC码速率匹配时使用的最大层数改为网络配置参数的取值与4中的较小者。步骤S7：网络下发RRC重配置消息；UE接收RRC重配置消息，并将LDPC码速率匹配时使用的最大层数改为UE支持的最大层数与4中的较小者。本申请还提出了一种LDPC码速率匹配最大层数的确定装置，包括接入过程处理单元一、配置消息下发单元、配置消息处理单元一、配置消息处理单元二。所述接入过程处理单元一用于在UE接入5G NR网络的过程中，网络令maxMIMO-Layers参数或maxRank参数之一取最小值1并计算对应的参考码块长度；网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值。所述配置消息下发单元用于在UE接入5G NR网络后，网络下发RRC配置消息，其中记载了网络是否选择配置maxMIMO-Layers参数、maxRank参数；如果是，还记载所配置参数的取值；如果网络选择配置任一个或全部参数，进入配置消息处理单元一；否则进入配置消息处理单元二。所述配置消息处理单元一用于UE接收RRC配置消息，取得网络配置参数的取值，并将LDPC码速率匹配时使用的最大层数改为网络配置参数的取值与4中的较小者。所述配置消息处理单元二用于UE接收RRC配置消息，网络通过调整调制阶数和/或物理资源块个数以使编码后的码块长度小于或等于所述参考码块长度；此时UE在LDPC码速率匹配时使用的最大层数为1、2、3、4中的任意值。可选地，以预先约定单元和接入过程处理单元二的总和替代接入过程处理单元一，以配置消息处理单元三替代配置消息处理单元二。所述预先约定单元用于网络和UE预先约定网络和UE在LDPC码速率匹配时使用的最大层数。所述接入过程处理单元二用于在UE接入5G NR网络的过程中，网络和UE在LDPC码速率匹配时使用的最大层数为约定值。所述配置消息下发单元中的“进入配置消息处理单元二”改为“进入配置消息处理单元三”。所述配置消息处理单元三用于UE接收RRC配置消息，网络和UE在LDPC码速率匹配时使用的最大层数为约定值。本发明取得的技术效果是：在网络得知UE支持的最大层数之前，通过网络和UE相互配合，保证了UE和网络之间在各信令阶段都有明确的速率匹配最大层数，保证了速率匹配过程的准确。附图说明图1是5G NR网络进行速率匹配中比特选择过程的流程示意图。图2是UE和5G NR网络之间的信令交互流程的示意图。图3是本发明提出的LDPC码速率匹配最大层数的确定方法的实施例一的流程示意图。图4是本发明提出的LDPC码速率匹配最大层数的确定方法的实施例二的流程示意图。图5是图3和图4的后续流程示意图。图6是本发明提出的LDPC码速率匹配最大层数的确定装置的实施例一的结构示意图。图7是本发明提出的LDPC码速率匹配最大层数的确定装置的实施例二的结构示意图。图中附图标记说明：1为接入过程处理单元一、1a为预先约定单元、1b为接入过程处理单元二、2为配置消息下发单元、3为配置消息处理单元一、4为配置消息处理单元二、4a为配置消息处理单元三。具体实施方式请参阅图3，本发明提出的LDPC码速率匹配最大层数的确定方法的实施例一包括如下步骤。步骤S1：在UE接入5G NR网络的过程中。针对下行场景，此时UE还未从网络获取maxMIMO-Layers参数。maxMIMO-Layers参数是网络给UE配置的一个高层参数，在这里用于指示本小区级别的该UE的PDSCH使用的最大MIMO层数。网络令maxMIMO-Layers参数取最小值1，计算对应的参考码块长度。所述参考码块长度/＞是根据maxMIMO-Layers参数的当前取值、最大调制阶数Qm、物理资源块个数nPRB、资源单元个数NRE、最高码率R，结合5G NR协议计算得到的。网络通过调整下行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于/＞。此时UE计算得到的每个码块的循环缓存大小，因此不论UE在速率匹配时下行共享信道的一个传输块使用的最大层数为1、2、3、4中的任何一个值，均可以保证UE正确地解速率匹配。此时，UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值均可。针对上行场景，此时UE还未从网络获取maxMIMO-Layers参数或maxRank参数。maxMIMO-Layers参数、maxRank参数是网络给UE配置的两个高层参数，在这里用于指示本小区级别的该UE的PUSCH使用的最大MIMO层数。maxMIMO-Layers参数同时存在于下行场景和上行场景中。maxRank参数仅存在于上行场景中。网络令maxMIMO-Layers参数或maxRank参数之一取最小值1，计算对应的参考码块长度。所述参考码块长度Nref是根据maxMIMO-Layers参数或maxRank参数的当前取值、最大调制阶数Qm、物理资源块个数nPRB、资源单元个数NRE、最高码率R，结合5G NR协议计算得到的。网络通过调整上行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于/＞。此时UE计算得到的每个码块的循环缓存大小/＞，因此不论UE在速率匹配时上行共享信道的一个传输块使用的最大层数为1、2、3、4中的任何一个值，均可以保证UE正确地解速率匹配。此时，UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值均可。步骤S2：在UE接入5G NR网络后，网络下发RRC配置消息。针对下行场景，所述RRC配置消息中包含物理下行共享信道PDSCH的配置信息PDSCH-ServingCellConfig。在PDSCH的配置信息中记载了网络是否选择配置maxMIMO-Layers参数。如果网络在RRC配置消息中选择配置maxMIMO-Layers参数，在PDSCH的配置信息中还记载了网络配置的maxMIMO-Layers参数的取值为X。X的取值范围是1到8之间的任一个整数。考虑到UE的能力并不相同，支持的层数不同，优选地，X的取值是1，这样能适用所有类型的UE。针对上行场景，所述RRC配置消息中包含物理上行共享信道PUSCH的配置信息PUSCH-Config和PUSCH服务小区的配置信息PUSCH-ServingCellConfig。在PUSCH服务小区的配置信息中记载了网络是否选择配置maxMIMO-Layers参数，在PUSCH的配置信息中记载了网络是否选择配置maxRank参数。如果网络在RRC配置消息中选择配置maxMIMO-Layers参数，在PUSCH服务小区的配置信息中还记载了网络配置的maxMIMO-Layers参数的取值为X0。如果网络在RRC配置消息中选择配置maxRank参数，在PUSCH的配置信息中还记载了网络配置的maxRank参数的取值为X1。如果网络选择同时配置maxMIMO-Layers参数和maxRank参数，根据协议规定，maxRank参数会被配置成与maxMIMO-Layers参数具有相同取值，即此时X0＝X1。X0、X1的取值范围都是1到4之间的任一个整数。考虑到UE的能力并不相同，支持的层数不同，优选地，X0的取值是1，X1的取值是1，这样能适用所有类型的UE。如果网络在RRC配置消息中已配置maxMIMO-Layers参数或maxRank参数的任一个或全部，进入步骤S3。如果网络在RRC配置消息中未配置maxMIMO-Layers参数，也未配置maxRank参数，进入步骤S4。步骤S3：UE接收RRC配置消息。此时的RRC配置消息中已配置maxMIMO-Layers参数或maxRank参数的任一个或全部。针对下行场景，UE取得PDSCH的配置信息中记载的maxMIMO-Layers参数的值X。UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数改为min。针对上行场景，UE取得PUSCH服务小区的配置信息中记载的maxMIMO-Layers参数的值X0、或者UE取得PUSCH的配置信息中记载的maxRank参数的值X1。UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数改为min或min。如果同时存在X0、X1，则根据协议规定X0＝X1，因此min＝min。步骤S4：UE接收RRC配置消息。此时的RRC配置消息中未配置maxMIMO-Layers参数，也未配置maxRank参数。针对下行场景，网络通过调整下行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于。此时，UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值均可。针对上行场景，网络通过调整上行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于。此时，UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值均可。请参阅图4，本发明提出的LDPC码速率匹配最大层数的确定方法的实施例二包括如下步骤。实施例二以步骤S1a和步骤S1b的总和替代了实施例一中的步骤S1。实施例二以步骤S4a替代了实施例一中的步骤S4。步骤S1a：网络和UE预先约定在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为Z1、上行共享信道的一个传输块使用的最大层数为Z2，Z1、Z2的取值范围都是1到4之间的任一个整数。第一种约定方式是：对所有类型的UE，网络和UE约定Z1是相同值，Z2也是相同值，例如取值均为1。第二种约定方式是：如果网络能获知UE的类型，例如eMBB终端、URLLC终端、mMTC终端、RedCap终端等，则网络和UE约定不同类型的UE的Z1各自取值，可以是相同值或不同值；不同类型的UE的Z2各自取值，可以是相同值或不同值。第三种约定方式是：如果网络能获知UE的类型，则网络和UE约定不同类型的UE的Z1各自取值，不同类型的UE的Z2各自取值，且Z1的值为本小区所在的工作频段要求的UE最少接收天线端口数。步骤S1b：在UE接入5G NR网络的过程中，此时UE还未从网络获取maxMIMO-Layers参数或maxRank参数。针对下行场景，网络和UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为预先约定的Z1。针对上行场景，网络和UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为预先约定的Z2。步骤S2、步骤S3均与实施例一相同。只是将步骤S2记载的“进入步骤S4”改为“进入步骤S4a”。步骤S4a：UE接收RRC配置消息。此时的RRC配置消息中未配置maxMIMO-Layers参数，也未配置maxRank参数。针对下行场景，网络和UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为预先约定的Z1。针对上行场景，网络和UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为预先约定的Z2。以上两个实施例对应于图2中UE向网络发送UE能力信息消息之前。图2中的剩余部分是以上两个实施例的后续处理流程，该后续处理流程如图5所示，在所述步骤S3、步骤S4或步骤S4a之后还包括如下步骤。步骤S5：网络接收UE的UE能力信息消息，其中记载了UE上报的能力信息。网络从UE上报的能力信息中获知UE所支持的最大层数M。若网络没有成功接收UE能力信息消息，则重复步骤S5直至网络成功接收UE能力信息消息。若网络成功接收UE能力信息消息，则网络准备发送RRC重配置消息给UE。针对下行场景，所述RRC重配置消息中包含物理下行共享信道PDSCH的配置信息PDSCH-ServingCellConfig。在PDSCH的配置信息中记载了网络是否选择配置maxMIMO-Layers参数。如果网络在RRC配置消息中选择配置maxMIMO-Layers参数，在PDSCH的配置信息中还记载了网络配置的maxMIMO-Layers参数的取值为M，即等于UE所支持的最大层数。下行场景中M的取值范围是1到8之间的任一个整数。针对上行场景，所述RRC重配置消息中包含物理上行共享信道PUSCH的配置信息PUSCH-Config和PUSCH服务小区的配置信息PUSCH-ServingCellConfig。在PUSCH服务小区的配置信息中记载了网络是否选择配置maxMIMO-Layers参数，在PUSCH的配置信息中记载了网络是否选择配置maxRank参数。如果网络在RRC配置消息中选择配置maxMIMO-Layers参数，在PUSCH服务小区的配置信息中还记载了网络配置的maxMIMO-Layers参数的取值为M，即等于UE所支持的最大层数。如果网络在RRC配置消息中选择配置maxRank参数，在PUSCH的配置信息中还记载了网络配置的maxRank参数的取值为M，即等于UE所支持的最大层数。如果网络选择同时配置maxMIMO-Layers参数和maxRank参数，根据协议规定，maxRank参数会被配置成与maxMIMO-Layers参数具有相同取值M，即等于UE所支持的最大层数。上行场景中M的取值范围是1到4之间的任一个整数。如果网络在RRC重配置消息中已配置maxMIMO-Layers参数或maxRank参数的任一个或全部，进入步骤S6。如果网络在RRC重配置消息中未配置maxMIMO-Layers参数，也未配置maxRank参数，进入步骤S7。步骤S6：网络下发RRC重配置消息。此时RRC重配置消息中已配置maxMIMO-Layers参数或maxRank参数的任一个或全部。UE接收RRC重配置消息。针对下行场景，UE取得PDSCH的配置信息中记载的maxMIMO-Layers参数的值M。UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数改为min。针对上行场景，UE取得PUSCH服务小区的配置信息中记载的maxMIMO-Layers参数的值M、或者UE取得PUSCH的配置信息中记载的maxRank参数的值M。UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数改为min。步骤S7：网络下发RRC重配置消息。此时RRC重配置消息中未配置maxMIMO-Layers参数，也未配置maxRank参数。UE接收RRC重配置消息。UE知晓自己在该5G NR小区支持的最大层数记为M。针对下行场景，UE将LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数改为min。针对上行场景，UE将LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数改为min。RRC配置消息、RRC重配置消息是网络调度的不同阶段下的消息。网络通过RRC重配置消息向UE更新部分配置消息，这不是重发RRC配置消息。对于RRC配置消息和RRC重配置消息中的maxMIMO-Layers参数、maxRank参数，网络可以选择全部不配置、或部分配置、或全部配置。通常情况下，网络在RRC配置消息中不会配置maxMIMO-Layers参数，因为此时网络还未获知UE支持的最大层数。通常情况下，网络在RRC配置消息中会配置maxRank参数的取值为1。在获得UE的能力消息之后，网络获知UE支持的最大层数，网络会在RRC重配置消息中配置maxMIMO-Layers参数和/或maxRank参数。这属于现有5G NR网络大多数情况下的配置情况。UE在收到RRC配置消息和RRC重配置消息之后均需要根据网络的配置更新LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数。请参阅图6，本发明提出的LDPC码速率匹配最大层数的确定装置的实施例一包括接入过程处理单元一1、配置消息下发单元2、配置消息处理单元一3、配置消息处理单元二4。图6所示装置的实施例一对应于图3所示方法的实施例一。所述接入过程处理单元一1用于在UE接入5G NR网络的过程中，针对下行场景，网络令maxMIMO-Layers参数取最小值1，计算对应的参考码块长度。网络通过调整下行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于/＞。此时UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值。针对上行场景，网络令maxMIMO-Layers参数或maxRank参数之一取最小值1，计算对应的参考码块长度/＞。网络通过调整上行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于/＞。此时UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值。所述配置消息下发单元2用于在UE接入5G NR网络后，网络下发RRC配置消息。针对下行场景，所述RRC配置消息中记载了网络是否选择配置maxMIMO-Layers参数。如果是，所述RRC配置消息中还记载了maxMIMO-Layers参数的取值为X。针对上行场景，所述RRC配置消息中记载了网络是否选择配置maxMIMO-Layers参数、maxRank参数。如果是，所述RRC配置消息中还记载了maxMIMO-Layers参数的取值为X0和/或记载了maxRank参数的取值为X1。如果网络在RRC配置消息中已配置maxMIMO-Layers参数或maxRank参数的任一个或全部，后续交给配置消息处理单元一3继续处理。如果网络在RRC配置消息中未配置maxMIMO-Layers参数，也未配置maxRank参数，后续交给配置消息处理单元二4继续处理。所述配置消息处理单元一3用于UE接收RRC配置消息。针对下行场景，UE取得maxMIMO-Layers参数的值X。UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数改为min。针对上行场景，UE取得maxMIMO-Layers参数的值X0、或者取得maxRank参数的值X1。UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数改为min或min。所述配置消息处理单元二4用于UE接收RRC配置消息。针对下行场景，网络通过调整下行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于。此时UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值。针对上行场景，网络通过调整上行调度的调制阶数和/或物理资源块个数nPRB以使编码后的码块长度N小于或等于/＞。此时UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为1、2、3、4中的任意值。请参阅图7，本发明提出的LDPC码速率匹配最大层数的确定装置的实施例二包括预先约定单元1a、接入过程处理单元二1b、配置消息下发单元2、配置消息处理单元一3、配置消息处理单元三4a。图7所示装置的实施例二对应于图4所示方法的实施例二。所述预先约定单元1a用于网络和UE预先约定UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为Z1、上行共享信道的一个传输块使用的最大层数为Z2。第一种约定方式是：对所有类型的UE，网络和UE约定Z1是相同值，Z2也是相同值。第二种约定方式是：如果网络能获知UE的类型，则不同类型的UE的Z1各自取值，不同类型的UE的Z2各自取值。第三种约定方式是：如果网络能获知UE的类型，则网络和UE约定不同类型的UE的Z1各自取值，不同类型的UE的Z2各自取值，且Z1的值为本小区所在的工作频段要求的UE最少接收天线端口数。所述接入过程处理单元二1b用于在UE接入5G NR网络的过程中，针对下行场景，网络和UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为预先约定的Z1。针对上行场景，网络和UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为预先约定的Z2。所述配置消息下发单元2、配置消息处理单元一3均与实施例一相同。只是将所述配置消息下发单元2记载的“后续交给配置消息处理单元二4继续处理”改为“后续交给配置消息处理单元三4a继续处理”。所述配置消息处理单元三4a用于UE接收RRC配置消息。针对下行场景，网络和UE在LDPC码速率匹配时下行共享信道的一个传输块使用的最大层数为预先约定的Z1。针对上行场景，网络和UE在LDPC码速率匹配时上行共享信道的一个传输块使用的最大层数为预先约定的Z2。5G NR协议中，在UE上报UE能力信息消息前，UE用于LDPC码速率匹配的最大层数存在模糊的地方。本申请对此进行了改进，提出了确定LDPC码速率匹配时传输信道使用的最大层数的方法，能有效解决各种不同能力的终端设备在5G NR小区中进行上下行传输时遇到的速率匹配问题，保证终端设备正常使用。以上仅为本发明的优选实施例，并不用于限定本发明。对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
