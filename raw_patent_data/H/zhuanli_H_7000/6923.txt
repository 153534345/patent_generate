标题title
一种多电平变换器的调制型双层模型预测控制方法及装置
摘要abst
本发明公开了一种多电平变换器的调制型双层模型预测控制方法及装置，包括：采用比例积分控制实现整体电压控制；将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB变换器的可选矢量，在保证模型预测快速响应速度的同时，减少了所需评估电压矢量的数量；预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；选择每个周期内3个自适应零序电压矢量作为可选矢量；预测相直流电压，设计评估目标函数，选择最优零序电压矢量；采用模型预测的零序电压注入方法实现相间电容电压均衡控制，提高动态响应速度；计算级联H桥多电平变换器各子模块调制信号，采用移相载波调制实现调制环节。本发明所提出的方法可使级联H桥变换器获得固定的开关频率，显著降低控制器所需计算量，并提高相间电容电压的均衡速度。
权利要求书clms
1.一种多电平变换器的调制型双层模型预测控制方法，其特征在于，所述方法包括：采用比例积分控制实现整体电压控制；将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为级联H桥多电平变换器的可选矢量；预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；选择每个周期内3个自适应零序电压矢量作为可选矢量；预测相直流电压，设计评估目标函数，选择最优零序电压矢量；采用模型预测的零序电压注入方法实现相间电容电压均衡控制；计算级联H桥多电平变换器各子模块调制信号，采用移相载波调制实现调制环节；通过三相级联H桥多电平变换器-静止同步无功补偿器实验样机验证所提双层模型预测控制方法的有效性。2.根据权利要求1所述的一种多电平变换器的调制型双层模型预测控制方法，其特征在于，所述将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量具体为：设CHB-STATCOM每个相单元含有N个子模块，则三相拓扑共存在3个可选电压矢量。为了减少可选电压矢量的数量，将每个相单元视为一个整体，则每相等效输出电压为记为{-4,0,4}。CHB-STATCOM包含三个相单元，此时可选电压矢量数量为27。进一步将上述电压矢量从abc坐标系映射到αβ坐标系，对应电压矢量数量下降为19。19个电压矢量可分为大矢量、中矢量和小矢量，中矢量和小矢量可以由大矢量和零矢量合成。因此，可将可选电压矢量数量进一步减小至8，各矢量下的开关状态示于表1中。此时，每个周期仅需对6个非零矢量进行评估，从中选取两个最优矢量用于合成目标电压矢量。通过电压矢量简化，减少了单位时间内模型预测控制方法所需评估的电压矢量的数量。3.根据权利要求1所述的一种多电平变换器的调制型双层模型预测控制方法，其特征在于，所述预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量具体为：将abc坐标下的控制方程离散后，可得输出电流的预测方程为式中，Ts为控制周期，iα和iβ分别为k时刻输出电流测量值在α轴和β轴的分量，uα和uβ分别为k时刻输出电压在α轴和β轴的分量，ugα和ugβ分别为k时刻电网电压在α轴和β轴的分量。根据上式可计算6个非零矢量下，k+1时刻输出电流在α轴和β轴分量的预测值。为实现对输出电流的精确跟踪，将目标函数设计为式中，J为目标函数，和/＞可利用三阶拉格朗日差值法表示为/＞式中，和/＞为k、k-1、k-2和k-3时刻输出电流参考值在α轴的分量，/＞和/＞为k、k-1、k-2和k-3时刻输出电流参考值在β轴的分量。设Jx和Jy为两个最小的目标函数值式中，JΩ为除Jx和Jy外任意的目标函数值。两个最优的电压矢量可选取为Uopt1＝Ux,Uopt2＝Uy。4.根据权利要求1所述的一种多电平变换器的调制型双层模型预测控制方法，其特征在于，所述根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制具体为：为跟踪输出电流矢量，设计两个最优电压矢量的停延时间为式中，topt1和topt2分别为k时刻最优电压矢量Uopt1和Uopt2的停延时间，uopt1α和uopt1β分别为电压矢量Uopt1在α轴和β轴的分量，uopt2α和uopt2β分别为电压矢量Uopt2在α轴和β轴的分量。设6个非零向量的停延时间分别为t1、t2、t3、t4、t5和t6，则两个最优向量的停延时间将被赋值为topt1和topt2，其余矢量的停延时间则记为0。为避免三相有功功率波动，两个零矢量U0和U7的停延时间配置为则输出电流预测控制环节中，三相输出电压参考值可表示为5.根据权利要求1所述的一种多电平变换器的调制型双层模型预测控制方法，其特征在于，所述预测相直流电压，设计评估目标函数，选择最优零序电压矢量具体为：将相直流电压的控制方程离散后，可得相直流电压的预测方程为式中，Vdcj_ave和Vdcj_ave分别为k时刻相直流电压的测量值和k+1时刻相直流电压的预测值。为实现相间电容电压的均衡控制，将目标函数设计为式中，G为所提控制方法的目标函数，Gu为a相与b相之间相直流电压差值的绝对值，Gv为b相与c相之间相直流电压差值的绝对值，Gw为c相与a相之间相直流电压差值的绝对值。设Gz为式中最小的目标函数值式中，GΩ为除Gz外任意的目标函数值。最优零序电压矢量可选取为6.一种模块化多电平变换器等效空间矢量模型预测控制装置，其特征在于，所述装置包括：整体电压控制模块，用于计算有功电流参考值，进而控制所有子模块电容电压的平均值，实现整体电压控制；电压矢量简化模块，用于将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB变换器的可选矢量；输出电流预测模块，用于预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；输出电流控制模块，用于根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；零序电压矢量更新模块，用于选择每个周期内3个自适应零序电压矢量作为可选矢量；相直流电压预测模型，用于预测相直流电压，设计评估目标函数，选择最优零序电压矢量；相间电容电压均衡控制模块，用于采用模型预测的零序电压注入方法实现相间电容电压均衡控制；调制模块，用于采用载波移相调制方式生成开关信号，控制变换器生成多电平电压输出信号，实现调制环节。
说明书desc
技术领域本发明涉及多电平变换器模型预测控制技术领域，尤其涉及一种多电平变换器的调制型双层模型预测控制方法及装置。背景技术级联H桥多电平变换器具有模块化程度高，谐波特性好、易拓展等优点，且无需工频变压器，可直接与中高压交流电网相连，被广泛应用于静止同步无功补偿器中。CHB-STATCOM通常采用线性级联控制结构，其动态响应速度收到限制。模型预测控制方法具有快速的动态响应，别广泛应用于电力电子变换器中。模型预测控制主要包括两种，即有限集模型预测控制方法和调制型模型预测控制方法。发明人在实现本发明的过程中，发现现有技术中至少存在以下缺点和不足：1、有限集型模型预测控制多适用于电压数量或开关状态组合数量较少的两电平或三电平变换器应用场合中，其在应用于CHB多电平变换器时，面临所需预测的矢量众多，控制器计算负担重等问题；2、调制型模型预测控制方法在CHB多电平变换器中的研究相对较少，且难以同时实现交流输出电流和相间电容电压的快速控制；上述两方面局限性限制了模型预测控制在CHB多电平变换器中的推广应用。发明内容本发明提供了一种多电平变换器的调制型双层模型预测控制方法，本发明通过将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量，在保证模型预测快速响应速度的同时，减少了所需评估电压矢量的数量；根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测精确控制；通过模型预测的零序电压注入方法实现相间电容电压均衡控制，提高动态响应速度，详见下文描述：第一方面，一种多电平变换器的调制型双层模型预测控制方法，所述方法包括：采用比例积分控制实现整体电压控制；将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量；预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；选择每个周期内3个自适应零序电压矢量作为可选矢量；预测相直流电压，设计评估目标函数，选择最优零序电压矢量；采用模型预测的零序电压注入方法实现相间电容电压均衡控制；计算级联H桥多电平变换器各子模块调制信号，采用移相载波调制实现调制环节；通过三相CHB-STATCOM实验样机验证所提双层模型预测控制方法的有效性。其中，所述采用比例积分控制实现整体电压控制具体为：采用比例积分控制器计算有功电流参考值，进而控制所有子模块电容电压的平均值，实现整体电压控制。其中，所述将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量具体为：如图4所示，设CHB-STATCOM每个相单元含有N个子模块，则三相拓扑共存在3个可选电压矢量。为了减少可选电压矢量的数量，将每个相单元视为一个整体，则每相等效输出电压为记为{-4,0,4}。如图4所示，CHB-STATCOM包含三个相单元，此时可选电压矢量数量为27。如图4所示，进一步将上述电压矢量从abc坐标系映射到αβ坐标系，对应电压矢量数量下降为19。图中，19个电压矢量可分为大矢量、中矢量和小矢量，中矢量和小矢量可以由大矢量和零矢量合成。因此，如图4所示，可将可选电压矢量数量进一步减小至8，各矢量下的开关状态示于表1中。此时，每个周期仅需对6个非零矢量进行评估，从中选取两个最优矢量用于合成目标电压矢量。其中，所述预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量具体为：将abc坐标下的控制方程离散后，可得输出电流的预测方程为式中，Ts为控制周期，iα和iβ分别为k时刻输出电流测量值在α轴和β轴的分量，uα和uβ分别为k时刻输出电压在α轴和β轴的分量，ugα和ugβ分别为k时刻电网电压在α轴和β轴的分量。根据上式可计算6个非零矢量下，k+1时刻输出电流在α轴和β轴分量的预测值。为实现对输出电流的精确跟踪，将目标函数设计为式中，J为目标函数，和/＞可利用三阶拉格朗日差值法表示为式中，和/＞为k、k-1、k-2和k-3时刻输出电流参考值在α轴的分量，/＞和/＞为k、k-1、k-2和k-3时刻输出电流参考值在β轴的分量。设Jx和Jy为两个最小的目标函数值式中，JΩ为除Jx和Jy外任意的目标函数值。两个最优的电压矢量可选取为Uopt1＝Ux,Uopt2＝Uy其中，所述根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制具体为：为跟踪输出电流矢量，设计两个最优电压矢量的停延时间为式中，topt1和topt2分别为k时刻最优电压矢量Uopt1和Uopt2的停延时间，uopt1α和uopt1β分别为电压矢量Uopt1在α轴和β轴的分量，uopt2α和uopt2β分别为电压矢量Uopt2在α轴和β轴的分量。设6个非零向量的停延时间分别为t1、t2、t3、t4、t5和t6，则两个最优向量的停延时间将被赋值为topt1和topt2，其余矢量的停延时间则记为0。为避免三相有功功率波动，两个零矢量U0和U7的停延时间配置为则输出电流预测控制环节中，三相输出电压参考值可表示为其中，所述选择每个周期内3个自适应零序电压矢量作为可选矢量具体为：为避免功率振荡，每个周期内3个自适应零序电压矢量被选为可选矢量，具体可表示为＝式中，uOM1、uOM2和uOM3为可选的零序电压矢量，Uadp为用于确定零序电压矢量的自适应幅值，具体可表示为式中，KZSV为零序电压注入系数，δ为允许注入的最大零序电压幅值占比，f为用于计算自适应零序电压矢量的函数，具体可表示为f＝|Vdca_ave-Vdcb_ave|+|Vdcb_ave-Vdcc_ave|+|Vdcc_ave-Vdca_ave|其中，所述预测相直流电压，设计评估目标函数，选择最优零序电压矢量具体为：将相直流电压的控制方程离散后，可得相直流电压的预测方程为式中，Vdcj_ave和Vdcj_ave分别为k时刻相直流电压的测量值和k+1时刻相直流电压的预测值。为实现相间电容电压的均衡控制，将目标函数设计为式中，G为所提控制方法的目标函数，Gu为a相与b相之间相直流电压差值的绝对值，Gv为b相与c相之间相直流电压差值的绝对值，Gw为c相与a相之间相直流电压差值的绝对值。设Gz为式中最小的目标函数值式中，GΩ为除Gz外任意的目标函数值。最优零序电压矢量可选取为其中，所述采用模型预测的零序电压注入方法实现相间电容电压均衡控制具体为：如图2和图3所示，通过上述选择每个周期内3个自适应零序电压矢量作为可选矢量；预测相直流电压，设计评估目标函数，选择最优零序电压矢量；采用模型预测的零序电压注入方法实现相间电容电压均衡控制，实现相间电容电压均衡预测控制。其中，所述计算级联H桥多电平变换器各子模块调制信号，采用移相载波调制实现调制环节具体为：采用载波移相调制方式生成开关信号，控制变换器生成多电平电压输出信号，实现调制环节。图2中，为所有子模块电容电压的平均值，/＞和/＞分别为有功和无功电流参考值，和/＞分别为输出电流参考值在α轴和β轴的分量，Δujp为各模块电压参考值的调整量，mjp为各模块的最终调制信号，具体可表示为第二方面，一种多电平变换器的调制型双层模型预测控制方法装置，所述装置包括：整体电压控制模块，用于计算有功电流参考值，进而控制所有子模块电容电压的平均值，实现整体电压控制；电压矢量简化模块，用于将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量；输出电流预测模块，用于预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；输出电流控制模块，用于根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；零序电压矢量更新模块，用于选择每个周期内3个自适应零序电压矢量作为可选矢量；相直流电压预测模型，用于预测相直流电压，设计评估目标函数，选择最优零序电压矢量；相间电容电压均衡控制模块，用于采用模型预测的零序电压注入方法实现相间电容电压均衡控制；调制模块，用于采用载波移相调制方式生成开关信号，控制变换器生成多电平电压输出信号，实现调制环节。本发明提供的技术方案的有益效果是：1、本发明所提多电平变换器的调制型双层模型预测控制方法通过电压矢量简化，减少了单位时间内模型预测控制方法所需评估的电压矢量的数量；2、本发明所提多电平变换器的调制型双层模型预测控制方法设计2个最优电压矢量的停延时间，降低输出电流的跟踪误差；3、本发明所提多电平变换器的调制型双层模型预测控制方法可同时实现对交流输出电流的快速跟踪和相间电容电压的快速均衡，可以提高动态响应能力；4、本发明所提多电平变换器的调制型双层模型预测控制方法可使变换器获得固定的开关频率，且可提高电压利用率。为进一步验证所提出CHB多电平变换器的调制型双层模型预测方法的有效性和实用性，通过实验室三相CHB-STATCOM样机进行了实验。采用的样机如图5所示。实验参数如表2所示。CHB多电平变换器的交流输出端连接到三相可编程交流电源，CHB多电平变换器的直流侧则连接到直流电源。dSPACE1006被用作为中央控制器，PSS15S92F6-AG用作功率模块的开关器件。实验结果通过示波器采集的波形给出。附图说明图1为级联H桥多电平变换器—静止同步无功补偿器拓扑结构；图2为级联H桥多电平变换器—静止同步无功补偿器整体控制框图；图3为调制型双层模型预测控制方法框图；图4为电压矢量简化原理示意图；其中，图为3个可选电压矢量；图为27个可选电压矢量；图为19个可选电压矢量；图为8个可选电压矢量。图5为三相级联H桥多电平变换器—静止同步无功补偿器样机图；图6为级联H桥多电平变换器—静止同步无功补偿器实验波形；其中，图为a相电网电压和三相输出电流；图为输出电流的谐波频谱；图为三相输出电压参考值和注入的零序电压；图为三相输出电压；图为三相电容电压；图为a相子模块开关信号。具体实施方法为使本发明的目的、技术方案和优点更加清楚，下面对本发明实施方式作进一步地详细描述。为了解决背景技术中存在的问题，减少所需评估电压矢量的数量，提高动态响应能力，提高电压利用率，降低控制器所需计算量，提高相间电容电压的均衡速度，本发明以CHB结构多电平变换器为实施例，研发一种CHB多电平变换器的调制型双层模型预测控制方法。实施例1一种多电平变换器的调制型双层模型预测控制方法，该方法包括以下步骤：步骤101：采用比例积分控制实现整体电压控制；步骤102：将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量；步骤103：预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；步骤104：根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；步骤105：选择每个周期内3个自适应零序电压矢量作为可选矢量；步骤106：预测相直流电压，设计评估目标函数，选择最优零序电压矢量；步骤107：采用模型预测的零序电压注入方法实现相间电容电压均衡控制；步骤108：计算级联H桥多电平变换器各子模块调制信号，采用移相载波调制实现调制环节；步骤109：通过三相CHB-STATCOM实验样机验证所提双层模型预测控制方法的有效性。实施例2下面结合具体的计算公式、附图、实例对实施例1中的方案进行进一步地介绍，详见下文描述：步骤201：采用比例积分控制实现整体电压控制；CHB-STATCOM的拓扑结构如图1所示，其包括三个相单元，每个相单元包括N个串联的H桥模块和一个滤波电感L。每个H桥模块包含四个开关、四个反并联二极管和一个电容。三个相单元的一侧连接到公共耦合点M，另一侧连分别连接到交流电网。通过调节CHB多电平变换器各个模块的开关信号，可以生成多电平电压波形，从而为电网提供无功电流。将基尔霍夫定律应用于CHB多电平变换器，可得控制方程如下L＝uj-ugj-Rij式中，R为交流滤波电感的等效电阻，uj为的交流等效输出电压，ugj为电网电压，ij为输出电流，j指示相序，j＝{a,b,c}。利用帕克变换，可进一步将abc坐标下的控制方程转换到αβ坐标系式中，iα和iβ分别为输出电流i在α轴和β轴上的分量；uα和uβ分别为输出电压在α轴和β轴上的分量，ugα和ugβ分别为电网电压在α轴和β轴上的分量。此外，将各相单元直流电压定义为该相所有H桥模块电容电压的平均值式中，Vdcjp为各模块的电容电压，p指示各模块的序号，p＝{1,2,…,N}，Vdcj_ave为各相子模块电容电压的平均值，即相直流电压。考虑零序电压注入的情况下，相直流电压满足如下条件式中，为输出电压参考值，/＞为零序电压参考值，C为各子模块电容容值，/＞为各相单元的平均导通时间占比，/＞为子模块电容电压的参考值。采用比例积分控制器计算有功电流参考值，进而控制所有子模块电容电压的平均值，实现整体电压控制。图2中，为所有子模块电容电压的平均值，/＞和/＞分别为有功和无功电流参考值，和/＞分别为输出电流参考值在α轴和β轴的分量，Δujp为各模块电压参考值的调整量，mjp为各模块的最终调制信号，具体可表示为步骤202：将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量；所提调制型双层模型预测控制方法如图3所示，其包括两层预测控制。第一层输出电流预测控制在提高输出电流动态响应速度的同时，显著降低了所需预测电压矢量的数量；第二层相间电压均衡预测控制显著提高了相间电容电压均衡控制的动态响应速度。图中，iα和iβ分别为k+1时刻预测的输出电流在α轴和β轴的分量，和/＞分别为k+1时刻输出电流参考值在α轴和β轴的分量，J为所需评估的用于控制输出电流的目标函数，Uopt1和Uopt2分别为所选的两个最优矢量，topt1和topt2分别为最优矢量的停延时间，Vdcj为k+1时刻预测的相直流电压，G为所需评估的用于控制相间电容电压的目标函数。如图4所示，设CHB-STATCOM每个相单元含有N个子模块，则三相拓扑共存在3个可选电压矢量。为了减少可选电压矢量的数量，将每个相单元视为一个整体，则每相等效输出电压为记为{-4,0,4}。如图4所示，CHB-STATCOM包含三个相单元，此时可选电压矢量数量为27。如图4所示，进一步将上述电压矢量从abc坐标系映射到αβ坐标系，对应电压矢量数量下降为19。图中，19个电压矢量可分为大矢量、中矢量和小矢量，中矢量和小矢量可以由大矢量和零矢量合成。因此，如图4所示，可将可选电压矢量数量进一步减小至8，各矢量下的开关状态示于表1中。此时，每个周期仅需对6个非零矢量进行评估，从中选取两个最优矢量用于合成目标电压矢量。6个非零矢量可表示为：Upre＝{U1,U2,U3,U4,U5,U6} 式中，Upre为用于预测输出电流的电压矢量集。表1简化电压矢量下的三相输出电压状态步骤203：预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；将式中的控制方程离散后，可得输出电流的预测方程为式中，Ts为控制周期，iα和iβ分别为k时刻输出电流测量值在α轴和β轴的分量，uα和uβ分别为k时刻输出电压在α轴和β轴的分量，ugα和ugβ分别为k时刻电网电压在α轴和β轴的分量。根据式可计算6个非零矢量下，k+1时刻输出电流在α轴和β轴分量的预测值。为实现对输出电流的精确跟踪，将目标函数设计为式中，J为目标函数，和/＞可利用三阶拉格朗日差值法表示为式中，和/＞为k、k-1、k-2和k-3时刻输出电流参考值在α轴的分量，/＞和/＞为k、k-1、k-2和k-3时刻输出电流参考值在β轴的分量。设Jx和Jy为式中两个最小的目标函数值式中，JΩ为除Jx和Jy外任意的目标函数值。此时，两个最优的电压矢量可选取为Uopt1＝Ux,Uopt2＝Uy步骤204：根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；为跟踪输出电流矢量，设计两个最优电压矢量的停延时间为式中，topt1和topt2分别为k时刻最优电压矢量Uopt1和Uopt2的停延时间，uopt1α和uopt1β分别为电压矢量Uopt1在α轴和β轴的分量，uopt2α和uopt2β分别为电压矢量Uopt2在α轴和β轴的分量。设6个非零向量的停延时间分别为t1、t2、t3、t4、t5和t6，则两个最优向量的停延时间将被赋值为topt1和topt2，其余矢量的停延时间则记为0。为避免三相有功功率波动，两个零矢量U0和U7的停延时间配置为则输出电流预测控制环节中，三相输出电压参考值可表示为步骤205：选择每个周期内3个自适应零序电压矢量作为可选矢量；为避免功率振荡，每个周期内3个自适应零序电压矢量被选为可选矢量，具体可表示为＝式中，uOM1、uOM2和uOM3为可选的零序电压矢量，Uadp为用于确定零序电压矢量的自适应幅值，具体可表示为式中，KZSV为零序电压注入系数，δ为允许注入的最大零序电压幅值占比，f为用于计算自适应零序电压矢量的函数，具体可表示为f＝|Vdca_ave-Vdcb_ave|+|Vdcb_ave-Vdcc_ave|+|Vdcc_ave-Vdca_ave|步骤206：预测相直流电压，设计评估目标函数，选择最优零序电压矢量；将式中的控制方程离散后，可得相直流电压的预测方程为式中，Vdcj_ave和Vdcj_ave分别为k时刻相直流电压的测量值和k+1时刻相直流电压的预测值。为实现相间电容电压的均衡控制，将目标函数设计为式中，G为所提控制方法的目标函数，Gu为a相与b相之间相直流电压差值的绝对值，Gv为b相与c相之间相直流电压差值的绝对值，Gw为c相与a相之间相直流电压差值的绝对值。设Gz为式中最小的目标函数值式中，GΩ为除Gz外任意的目标函数值。最优零序电压矢量可选取为步骤207：采用模型预测的零序电压注入方法实现相间电容电压均衡控制；如图2和图3所示，通过上述选择每个周期内3个自适应零序电压矢量作为可选矢量；预测相直流电压，设计评估目标函数，选择最优零序电压矢量；采用模型预测的零序电压注入方法实现相间电容电压均衡控制，实现相间电容电压均衡预测控制。步骤208：计算级联H桥多电平变换器各子模块调制信号，采用移相载波调制实现调制环节；如式，采用载波移相调制方式生成开关信号，控制变换器生成多电平电压输出信号，实现调制环节。步骤209：通过三相CHB-STATCOM实验样机，验证所提双层模型预测控制方法的有效性。为进一步验证所提控制方法的有效性，利用图5所示的三相CHB-STATCOM实验平台进行实验验证，其主回路参数列于表2中。表2实验参数所提双层模型预测控制方法下，CHB-STATCOM的实验结果如图6所示。其中输出电流的幅值设置为5A，相位超前电网电压90°。如图6所示，变换器输出电流的幅值约为5A。如图6所示，输出电流的总谐波畸变率约为3.99％。输出电压参考值和实际值波形分别如图6和6所示，其具备空间矢量控制下的特征波形。零序电压注入分量同样示于图6中。如图6所示，三相电容电压稳定在约50V。a相第一个模块和最后一个模块的开关信号波形如图6所示，其频率保持在约5kHz。上述实验结果验证了所提方法的有效性。综上所述，该多电平变换器的调制型双层模型预测控制方法的优点如下：1、本发明所提多电平变换器的调制型双层模型预测控制方法通过电压矢量简化，减少了单位时间内模型预测控制方法所需评估的电压矢量的数量；2、本发明所提多电平变换器的调制型双层模型预测控制方法设计2个最优电压矢量的停延时间，降低输出电流的跟踪误差；3、本发明所提多电平变换器的调制型双层模型预测控制方法可同时实现对交流输出电流的快速跟踪和相间电容电压的快速均衡，可以提高动态响应能力；4、本发明所提多电平变换器的调制型双层模型预测控制方法可使变换器获得固定的开关频率，且可提高电压利用率。一种多电平变换器的调制型双层模型预测控制装置，该装置包括：整体电压控制模块，用于计算有功电流参考值，进而控制所有子模块电容电压的平均值，实现整体电压控制；电压矢量简化模块，用于将级联H桥多电平变换器每个相单元视为一个整体，将其输出状态映射为27个三电平空间矢量，选取6个大矢量作为CHB多电平变换器的可选矢量；输出电流预测模块，用于预测其输出电流的跟踪误差，设计评估目标函数，优化选取2个最优矢量；输出电流控制模块，用于根据预测结果计算2个最优矢量的停延时间，计算输出电压参考值，实现输出电流模型预测控制；零序电压矢量更新模块，用于选择每个周期内3个自适应零序电压矢量作为可选矢量；相直流电压预测模型，用于预测相直流电压，设计评估目标函数，选择最优零序电压矢量；相间电容电压均衡控制模块，用于采用模型预测的零序电压注入方法实现相间电容电压均衡控制；调制模块，用于采用载波移相调制方式生成开关信号，控制变换器生成多电平电压输出信号，实现调制环节。上述各个模块、单元的执行主体可以是计算机、单片机、微控制器等具有计算功能的器件，具体实现时，本发明实施例对执行主体不做限制，根据实际应用中的需要进行选择。本发明实施例对各器件的型号除做特殊说明的以外，其他器件的型号不做限制，只要能完成上述功能的器件均可。本领域技术人员可以理解附图只是一个优选实施例的示意图，上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
