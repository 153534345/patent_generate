标题title
一种基于恶意域名检测方法的网络安全防御系统
摘要abst
本发明提供了一种基于恶意域名检测方法的网络安全防御系统，涉及网络安全防御技术领域，包括：获取域名参数，随机匹配查询方法列表，且基于证书透明度协议，得到搜索引擎的检测规则；基于搜索引擎censys提供的API查询函数以及检测规则，得到相对应的域名详细信息；获取域名以及返回域名相对应的网页内容，进行网页内容相似分析，得到网页内容相似度特征值；基于所述域名详细信息以及网页内容相似度特征值，进行权重设置处理，得到域名关联度分值；基于所述域名关联度分值以及预设关联门限值，分析恶意域名是否存在关联关系，通过计算网页内容相似度，生成域名关联度分值，从而发现恶意域名之间关联关系，及时发出警报，防御恶意域名的攻击。
权利要求书clms
1.一种基于恶意域名检测方法的网络安全防御系统，其特征在于，包括：预备模块：获取域名参数，随机匹配查询方法列表，且基于证书透明度协议，得到搜索引擎的检测规则；检测模块：基于搜索引擎censys提供的API查询函数以及所述检测规则，得到相对应的域名详细信息；分析模块：获取域名以及返回域名相对应的网页内容，进行网页内容相似分析，得到网页内容相似度特征值；设置模块：基于所述域名详细信息以及网页内容相似度特征值，进行权重设置处理，得到域名关联度分值；关联模块：基于所述域名关联度分值以及预设关联门限值，分析恶意域名是否存在关联关系。2.根据权利要求1所述的系统，其特征在于，预备模块，包括：域名类型获取单元：获取域名参数并分析，得到域名类型；查询规则获取单元：基于所述域名类型以及类型-查询规则对照表，得到相对应的全部查询规则；查询列表获取单元：随机排列全部查询规则，得到查询方法列表。3.根据权利要求2所述的系统，其特征在于，预备模块，还包括：证书参数获取单元：基于证书透明度协议以及域名参数，得到相对应的证书参数；安全验证单元：对证书参数进行安全验证，得到安全验证结果；规则构建单元：若安全验证结果通过，则根据所述查询方法列表中每个查询规则相对应的查询参数，构建搜索引擎的检测规则。4.根据权利要求1所述的系统，其特征在于，检测模块，还包括：请求获取单元：基于所述检测规则中的每个查询参数，得到相对应的请求信息；搜索单元：在搜索引擎censys提供的API查询函数中输入请求信息，得到相对应的域名详细信息。5.根据权利要求1所述的系统，其特征在于，分析模块，包括：文本抓取单元：基于任意两个输入界面的同输入域名所对应的返回域名的网页的网页内容进行抓取，得到相对应的第一文本内容以及第二文本内容；文本筛选单元：基于结构文本数据库，匹配第一文本内容以及第二文本内容中的第一结构文本以及第二结构文本并删除；分句单元：基于处理后的第一文本内容以及第二文本内容的标点符号，进行初步分句，得到相对应的第一子句集合以及第二子句集合；子串提取单元：按照预设子串长度，获取第一子句集合中每个第一子句中相同长度的第一子串；词典匹配单元：将每个第一子串与词典进行词语匹配；子串处理单元：将直接匹配成功的第一子串保留，同时，去掉直接匹配不成功的第一子串的最后一个字符，且再次与词典进行词语匹配，直到匹配成功并保留去掉字符后的子串；分词集合构建单元：基于所保留的所有子串，构建第一分词集合；语法分析单元：将所述第一分词集合中的每个第一分词依次输入至移入-规约语法分析器进行LR文法解析，得到相对应的第一语法分析结果；分词筛选单元：删除第一分词集合中第一语法分析结果不合格的第一分词；向量获取单元：基于处理后的第一分词集合以及相应匹配的输入界面的分词-空间对照表，得到相对应的第一向量集合；第二分析单元：获取所述第二子句集合的第二向量集合；向量组构建单元：基于第一向量集合以及第二向量集合，匹配距离最近的第一向量以及第二向量，构建向量组；距离计算单元：基于每个向量组，计算相对应的切比雪夫距离；特征值计算单元：基于每个切比雪夫距离，计算得到两个网页内容相似度特征值。6.根据权利要求5所述的系统，其特征在于，特征值计算单元，包括：；其中，/＞表示网页内容相似度特征值；/＞指的是第/＞组向量组中第一向量；/＞指的是第/＞组向量组中第二向量；/＞表示全部向量组的数量；/＞表示全部向量组中第/＞组向量组的切比雪夫距离；/＞表示向量组的特征系数；/＞表示全部向量组中第/＞组向量组的向量权重，表示第/＞组向量组中的第一向量经过相对应的向量权重的调整得到的新向量；/＞表示第/＞组向量组中的第二向量经过相对应的向量权重的调整得到的新向量；/＞表示切比雪夫距离的定义函数；log表示对数函数符号。7.根据权利要求1所述的系统，其特征在于，设置模块，包括：配置选项获取单元：基于所述域名详细信息以及网页内容相似度特征值，确定配置选项；权重设置单元：向每个配置选项进行权重设置处理，得到域名关联度分值V；；其中，/＞表示域名关联度值，/＞为域名关联配置项数,/＞表示第/＞个配置选项加权值；/＞表示第i个配置选项的关联项取值；其中，配置选项与证书序号、证书签署结束时间、预证书的时间戳、网页相似度、证书更新时间以及证书生成时间相关。8.根据权利要求1所述的系统，其特征在于，量化模块，用于：门限值判断单元：若域名关联度值大于预设关联门限值，则域名以及返回域名有关联关系，判定有关联关系的域名和返回域名为恶意域名；警报发送单元：发送恶意域名至系统管理员，拒绝恶意域名的访问。
说明书desc
技术领域本发明涉及网络安全防御技术领域，特别涉及一种基于恶意域名检测方法的网络安全防御系统。背景技术目前，随着科学技术的发展，网络技术水平的发展也越来越快速。随之而来的是网络安全问题，网络攻击层出不穷，攻击者使用的域名和网站，称为恶意域名。恶意域名检测方法，经历了正则匹配和深度学习检测方法的演进，取得一定效果。为了规避上述已有检测方法，攻击者使用相对独立账户在多个的域名注册商处购买域名，每个域名使用一个单独的帐户，这些域名从特征、邮箱、联系方式方面都不具备关联性。通常攻击者在一段时间注册多个恶意域名，同时域名更新时间也具有相关性。因此，本发明提供一种基于恶意域名检测方法的网络安全防御系统。发明内容本发明提供一种基于恶意域名检测方法的网络安全防御系统，用以通过对攻击者的一个或多个域名，设置过滤规则，通过正则匹配，分析查询证书透明度中证书生成时间、更新时间、证书序号、证书签署结束时间、预证书的时间戳存在关联度，比较域名网站承载的内容，计算网页内容相似度，关联匹配模块对证书、域名、时间戳、序号信息和网页相似度分值进行加权处理，生成域名关联度分值，从而发现恶意域名之间关联关系，及时发出警报，防御恶意域名的攻击。本发明提供一种基于恶意域名检测方法的网络安全防御系统，包括：预备模块：获取域名参数，随机匹配查询方法列表，且基于证书透明度协议，得到搜索引擎的检测规则；检测模块：基于搜索引擎censys提供的API查询函数以及所述检测规则，得到相对应的域名详细信息；分析模块：获取域名以及返回域名相对应的网页内容，进行网页内容相似分析，得到网页内容相似度特征值；设置模块：基于所述域名详细信息以及网页内容相似度特征值，进行权重设置处理，得到域名关联度分值；关联模块：基于所述域名关联度分值以及预设关联门限值，分析恶意域名是否存在关联关系。优选的，本发明提供一种基于恶意域名检测方法的网络安全防御系统，预备模块，包括：域名类型获取单元：获取域名参数并分析，得到域名类型；查询规则获取单元：基于所述域名类型以及类型-查询规则对照表，得到相对应的全部查询规则；查询列表获取单元：随机排列全部查询规则，得到查询方法列表。优选的，本发明提供一种基于恶意域名检测方法的网络安全防御系统，预备模块，还包括：证书参数获取单元：基于证书透明度协议以及域名参数，得到相对应的证书参数；安全验证单元：对证书参数进行安全验证，得到安全验证结果；规则构建单元：若安全验证结果通过，则根据所述查询方法列表中每个查询规则相对应的查询参数，构建搜索引擎的检测规则。优选的，本发明提供一种基于恶意域名检测方法的网络安全防御系统，还包括：请求获取单元：基于所述检测规则中的每个查询参数，得到相对应的请求信息；搜索单元：在搜索引擎censys提供的API查询函数中输入请求信息，得到相对应的域名详细信息。优选的，本发明提供一种基于恶意域名检测方法的网络安全防御系统，分析模块，包括：文本抓取单元：基于任意两个输入界面的同输入域名所对应的返回域名的网页的网页内容进行抓取，得到相对应的第一文本内容以及第二文本内容；文本筛选单元：基于结构文本数据库，匹配第一文本内容以及第二文本内容中的第一结构文本以及第二结构文本并删除；分句单元：基于处理后的第一文本内容以及第二文本内容的标点符号，进行初步分句，得到相对应的第一子句集合以及第二子句集合；子串提取单元：按照预设子串长度，获取第一子句集合中每个第一子句中相同长度的第一子串；词典匹配单元：将每个第一子串与词典进行词语匹配；子串处理单元：将直接匹配成功的第一子串保留，同时，去掉直接匹配不成功的第一子串的最后一个字符，且再次与词典进行词语匹配，直到匹配成功并保留去掉字符后的子串；分词集合构建单元：基于所保留的所有子串，构建第一分词集合；语法分析单元：将所述第一分词集合中的每个第一分词依次输入至移入-规约语法分析器进行LR文法解析，得到相对应的第一语法分析结果；分词筛选单元： 删除第一分词集合中第一语法分析结果不合格的第一分词；向量获取单元：基于处理后的第一分词集合以及相应匹配的输入界面的分词-空间对照表，得到相对应的第一向量集合；第二分析单元：同时，获取所述第二子句集合的第二向量集合；向量组构建单元：基于第一向量集合以及第二向量集合，匹配距离最近的第一向量以及第二向量，构建向量组；距离计算单元：基于每个向量组，计算相对应的切比雪夫距离；特征值计算单元：基于每个切比雪夫距离，计算得到两个网页内容相似度特征值。优选的，本发明提供一种基于恶意域名检测方法的网络安全防御系统，特征值计算单元，包括：；其中，/＞表示网页内容相似度特征值；/＞指的是第/＞组向量组中第一向量；/＞指的是第/＞组向量组中第二向量；/＞表示全部向量组的数量；/＞表示全部向量组中第/＞组向量组的切比雪夫距离；/＞表示向量组的特征系数；/＞表示全部向量组中第/＞组向量组的向量权重，表示第/＞组向量组中的第一向量经过相对应的向量权重的调整得到的新向量；/＞表示第/＞组向量组中的第二向量经过相对应的向量权重的调整得到的新向量；/＞表示切比雪夫距离的定义函数；log表示对数函数符号。优选的，本发明提供一种基于恶意域名检测方法的网络安全防御系统，设置模块，包括：配置选项获取单元：基于所述域名详细信息以及网页内容相似度特征值，确定配置选项；权重设置单元：向每个配置选项进行权重设置处理，得到域名关联度分值V；；其中，/＞表示域名关联度值，/＞为域名关联配置项数,表示第/＞个配置选项加权值；/＞表示第i个配置选项的关联项取值；其中，配置选项与证书序号、证书签署结束时间、预证书的时间戳、网页相似度、证书更新时间以及证书生成时间相关。优选的，本发明提供一种基于恶意域名检测方法的网络安全防御系统，量化模块，用于：门限值判断单元：若域名关联度值大于预设关联门限值，则域名以及返回域名有关联关系，判定有关联关系的域名和返回域名为恶意域名；警报发送单元：发送恶意域名至系统管理员，拒绝恶意域名的访问。本发明的其它特征和优点将在随后的说明书中阐述，并且，部分地从说明书中变得显而易见，或者通过实施本发明而了解。本发明的目的和其他优点可通过在所写的说明书、权利要求书、以及附图中所特别指出的结构来实现和获得。下面通过附图和实施例，对本发明的技术方案做进一步的详细描述。附图说明附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。在附图中：图1为本发明实施例中一种基于恶意域名检测方法的网络安全防御系统的结构图。具体实施方式以下结合附图对本发明的优选实施例进行说明，应当理解，此处所描述的优选实施例仅用于说明和解释本发明，并不用于限定本发明。实施例1：本发明实施例提供一种基于恶意域名检测方法的网络安全防御系统，如图1所述包括：预备模块：获取域名参数，随机匹配查询方法列表，且基于证书透明度协议，得到搜索引擎的检测规则；检测模块：基于搜索引擎censys提供的API查询函数以及所述检测规则，得到相对应的域名详细信息；分析模块：获取域名以及返回域名相对应的网页内容，进行网页内容相似分析，得到网页内容相似度特征值；设置模块：基于所述域名详细信息以及网页内容相似度特征值，进行权重设置处理，得到域名关联度分值；关联模块：基于所述域名关联度分值以及预设关联门限值，分析恶意域名是否存在关联关系。该实施例中，域名参数指的是指向某一个IP地址的一串字符，比如：taobao.com，baidu.com。该实施例中，查询方法列表指的是通过对域名参数进行分析，得到域名类型相对应的查询规则，随机排列全部查询规则，得到的查询方法列表。其中，域名类型包括顶级域名、二级域名以及三级域名，顶级域名例如：.com代表商业，.org代表组织，二级域名例如：a.com，b.org，三级域名包括：ju.taobao.com，sf.taobao.com；查询规则指的是包含查询条件、查询内容的语句，例如：City= "Chicago" AND BirthDate＜DateAdd )。该实施例中，证书透明度协议指的是提供一个公开的、只具备附加属性的数据结构，它可以记录由证书颁发机构颁发的证书，在该协议中，一旦有日志接受了某个证书，该日志的加密属性即可保证相应条目永远不会被移除或修改。该实施例中，检测规则指的是包括查询方法列表中每个查询规则以及相对应的查询参数的规则集合。该实施例中，域名详细信息包括：证书透明度中证书生成时间、更新时间、证书序号、证书签署结束时间、预证书的时间戳。该实施例中，网页内容相似分析指的是通过提取用户输入的域名以及返回域名的网页文本内容，对提取的文本进行分词，进行语法分析，使用数值向量描述文本在语义空间中位置，度量两个网页向量空间距离，计算得到网页内容相似度特征值，表示两个网页内容的相似程度。该实施例中，网页内容相似度特征值指的是通过对网页文本内容的分词进行向量表示，进行计算，得到的能够表示两个网页内容的相似程度的数值。该实施例中，权重设置指的是按照预先设置的规则，对每个域名详细信息设置权重，规则包括：证书序号：加权值20；证书签署结束时间：加权值15 ；预证书的时间戳：加权值 25；网页相似度：加权值50；证书更新时间：加权值30；证书生成时间：加权值 30；时间50秒内/序号相差小于10：加权值 120；时间100秒内/相差小于20加权值：加权值100；时间200秒内/序号相差小于40内：加权值80；时间300 秒内/序号相差小于60内：加权值60；时间400秒内/序号相差小于80内：加权值40；时间大于500 秒/序号相差大于100或未查询到 ：加权值50。该实施例中，域名关联度分值指的是通过对生成时间、更新时间、证书序号、证书签署结束时间、预证书的时间戳和网页相似度分值进行权重设置处理后，进行计算得到的能够代表两个域名关联程度的数值。该实施例中，预设关联门限值指的是预先设置的表示域名以及返回域名之间之间有关联关系的最小值，大于预设关联门限值则域名以及返回域名之间之间有关联关系。上述技术方案的工作原理及有益效果是：通过对攻击者的一个或多个域名，设置过滤规则，通过正则匹配，分析查询证书透明度中证书生成时间、更新时间、证书序号、证书签署结束时间、预证书的时间戳存在关联度，比较域名网站承载的内容，计算网页内容相似度，关联匹配模块对证书、域名、时间戳、序号信息和网页相似度分值进行加权处理，生成域名关联度分值，从而发现恶意域名之间关联关系，及时发出警报，防御恶意域名的攻击。实施例2：基于实施例1的基础上，预备模块，包括：域名类型获取单元：获取域名参数并分析，得到域名类型；查询规则获取单元：基于所述域名类型以及类型-查询规则对照表，得到相对应的全部查询规则；查询列表获取单元：随机排列全部查询规则，得到查询方法列表。该实施例中，域名类型包含顶级域名、二级域名以及三级域名，顶级域名例如：.com代表商业，.org代表组织，二级域名例如：a.com，b.org，三级域名包括：ju.taobao.com，sf.taobao.com。该实施例中，类型-查询规则对照表指的是域名类型以及相对应的多个查询规则的对照表。该实施例中，查询规则包含查询条件、查询内容的语句，例如：City= "Chicago"AND BirthDate＜DateAdd )。上述技术方案的工作原理及有益效果是：通过对域名参数进行分析，得到域名类型，匹配相对应的多个查询规则，随机排列得到查询方法列表，随机进行查询，全面查询，有利于后续对域名关联的分析。实施例3：基于实施例1的基础上，预备模块，还包括：证书参数获取单元：基于证书透明度协议以及域名参数，得到相对应的证书参数；安全验证单元：对证书参数进行安全验证，得到安全验证结果；规则构建单元：若安全验证结果通过，则根据所述查询方法列表中每个查询规则相对应的查询参数，构建搜索引擎的检测规则。该实施例中，证书参数指的是基于域名参数在有证书透明度协议的网络中查找到的证书的关键参数，例如：密钥。该实施例中，安全验证指的是对证书参数中的密钥进行验证，若成功解码密钥，则该访问请求安全。该实施例中，安全验证结果指的是证书参数中的密钥合格或者不合格的结果，其中，安全验证结果为合格则相对应的域名安全。该实施例中，查询参数指的是查询规则中查询的关键参数，例如City= "Chicago"AND BirthDate＜DateAdd )中的City，BirthDate＜DateAdd。上述技术方案的工作原理及有益效果是：通过对证书参数进行安全验证，初步筛选恶意域名，阻止攻击简单的恶意域名的攻击，保证网站的安全。实施例4：基于实施例3的基础上，规则构建单元，用于：根据所述查询方法列表中的每个查询规则对应的第一设定公式，从公式-类型数据库中确定与相应查询规则匹配的查询兼容类型；根据每个查询规则的查询兼容类型，构建第一兼容向量，其中，所述第一兼容向量是通过对空白向量中的匹配元素进行兼容类型匹配以及兼容值填充获取得到的，对空白元素进行0填充；基于所有第一兼容向量，构建得到第一兼容矩阵，其中，所述第一兼容矩阵中的每行向量分别与对应查询规则匹配，同时，在所述第一兼容矩阵中的首行之前补充针对查询规则的查询列向量，得到第二兼容矩阵；分析所述查询列向量中包含的查询类型，当查询类型为满类型时，将所有查询规则进行并行设置，并根据每个查询规则相对应的主查询参数，构建搜索引擎的检测规则；当所述查询类型不为满类型时，从所述第二兼容矩阵中锁定第一缺失类型，并从每个第一缺失类型对应的列向量中锁定最大兼容值以及第二大兼容值；基于对每行向量的锁定结果，确定最大锁定数量的第一行以及第二大锁定数量的第二行；当所述第一行与第二行的锁定类型能全补充缺失类型时，获取第一行以及第二行所对应查询规则的次查询参数，并结合所获取的所有主查询参数，构建搜索引擎的检测规则；当当所述第一行与第二行的锁定类型不能全补充缺失类型时，根据第二缺失类型，且根据剩余行的锁定结果，来筛选与每个第二缺失类型分别一致的最大兼容值，并将提取每个最大兼容值所对应的查询规则中的待补充参数，且结合所有次查询参数以及主查询参数，构建搜索引擎的检测规则。该实施例中，查询规则的第一设定公式，是从规则-公式数据库中匹配得到的，因为查询规则一般都是按照有规律的公式确定出来的，是由专家预先设计好的，是基于数据库将规则与公式的映射关系存储起来，方便直接调用。该实施例中，公式-类型数据库是包括不同的设定公式以及与该设定公式匹配的兼容类型在内，因为在进行规则构建的过程是无疑会涉及到很多公式，公式对应的运行类型之间可以相互兼容才能保证引擎的合理运行，比如，公式1的兼容类型：运行类型1-0.3，用表示，运行类型2-0.3，用/＞表示，运行类型3-0.5，用/＞表示；公式1的兼容类型：运行类型1-0.2，用表示，运行类型2-0.1，用/＞表示，运行类型3不存在，此时进行0填充，用/＞表示；因此：第一兼容向量为以及/＞，第一兼容矩阵=/＞；该实施例中，查询列向量是针对对应查询规则的查询类型构建得到的，则第二兼容矩阵=。该实施例中，满类型指的是该查询列中的所有查询类型满足设定的类型，全部的设定的类型为满类型，也即是判断所有查询类型基于所有设定类型是否存在缺失，不存在，则视为满足满类型，否则，视为存在缺失类型。比如，设定的类型包含类型1、2、3，查询的类型包含类型1、2，此时，缺失类型为类型3，如果设定的类型包含类型1、2，此时，就视为满类型。该实施例中，并行设置的目的是为了可以将每个规则按照并列顺序进行规则构建，且主参数表示可以完全代表该查询规则的查询类型的参数，也就是将该查询规则中的无关参数剔除，只保留与该查询类型一致的参数，可以有效的保证规则构建的完整性。该实施例中，比如，存在针对类型3的缺失类型，此时，就从第二兼容矩阵中确定兼容值最大和第二大的元素进行锁定，比如是对与/＞的锁定，因为，第二兼容矩阵至少是包含不止两行的，上边的为举例说明。该实施例中，次查询参数指的是对应查询规则中与缺失类型一致的补充参数，由该参数来进行补充，因为，存在兼容，所以，肯定存在类型一致的参数，待补充参数与该原理类似。上述技术方案的有益效果是：通过对查询规则进行类型以及类型的兼容性分析，来保证检测规则在构建过程中所涉及到的类型的完整性，其中，通过对查询规则的列向量进行满类型的分析，来确定采用的参数构建方式，且部位满类型时，通过锁定大的兼容值来进行规则的筛选，进而来实现对缺失类型的参数的补充，尽可能保证检测规则构建的完整性，最大程度阻止恶意域名的攻击。实施例5：基于实施例1的基础上，检测模块，包括：请求获取单元：基于所述检测规则中的每个查询参数，得到相对应的请求信息；搜索单元：在搜索引擎censys提供的API查询函数中输入请求信息，得到相对应的域名详细信息。该实施例中，请求信息指的是查询参数转化而成的请求查询的详细信息，例如City= "Chicago" AND BirthDate＜DateAdd )中的City，BirthDate＜DateAdd；"Chicago"，" yyyy ", -40, Date。上述技术方案的工作原理及有益效果是：通过按照检测规则以及搜索引擎censys提供的API查询函数进行查找，得到相对应的域名详细信息，有利于后续对域名以及返回域名之间的关联分析。实施例6：基于实施例1的基础上，分析模块，包括：文本抓取单元：基于任意两个输入界面的同输入域名所对应的返回域名的网页的网页内容进行抓取，得到相对应的第一文本内容以及第二文本内容；文本筛选单元：基于结构文本数据库，匹配第一文本内容以及第二文本内容中的第一结构文本以及第二结构文本并删除；分句单元：基于处理后的第一文本内容以及第二文本内容的标点符号，进行初步分句，得到相对应的第一子句集合以及第二子句集合；子串提取单元：按照预设子串长度，获取第一子句集合中每个第一子句中相同长度的第一子串；词典匹配单元：将每个第一子串与词典进行词语匹配；子串处理单元：将直接匹配成功的第一子串保留，同时，去掉直接匹配不成功的第一子串的最后一个字符，且再次与词典进行词语匹配，直到匹配成功并保留去掉字符后的子串；分词集合构建单元：基于所保留的所有子串，构建第一分词集合；语法分析单元：将所述第一分词集合中的每个第一分词依次输入至移入-规约语法分析器进行LR文法解析，得到相对应的第一语法分析结果；分词筛选单元： 删除第一分词集合中第一语法分析结果不合格的第一分词；向量获取单元：基于处理后的第一分词集合以及相应匹配的输入界面的分词-空间对照表，得到相对应的第一向量集合；第二分析单元：同时，获取所述第二子句集合的第二向量集合；向量组构建单元：基于第一向量集合以及第二向量集合，匹配距离最近的第一向量以及第二向量，构建向量组；距离计算单元：基于每个向量组，计算相对应的切比雪夫距离；特征值计算单元：基于每个切比雪夫距离，计算得到两个网页内容相似度特征值。该实施例中，第一文本内容指的是任意两个输入界面的同输入域名所对应的返回域名的网页的网页内容中，按照目标所需要求抓取的第一个网页内容中的文本内容。该实施例中，第二文本内容指的是任意两个输入界面的同输入域名所对应的返回域名的网页的网页内容中，抓取的第二个网页的系统自定义展示内容中的文本内容。该实施例中，结构文本数据库指的是由结构文本构成的数据库，结构文本指的是无实际含义只是用于结构区分的文本，例如：概念，技术背景，一，二，三。该实施例中，第一结构文本指的是第一文本内容中与结构文本数据库中的结构文本相同的文本。该实施例中，第二结构文本指的是第二文本内容中与结构文本数据库中的结构文本相同的文本。该实施例中，初步分句指的是按照处理后的第一文本内容以及第二文本内容的标点符号，将第一文本内容以及第二文本内容分成多个独立句子。该实施例中，第一子句集合指的是按照处理后的第一文本内容的标点符号，将第一文本内容分成多个独立句子的集合。该实施例中，第二子句集合指的是按照处理后的第二文本内容的标点符号，将第二文本内容分成多个独立句子的集合。该实施例中，预设子串长度指的是按照词典里的词语最长长度预先设置的需要匹配的句子串的长度，例如：Max_len = 5。该实施例中，第一子串指的是按照预设子串长度，获取第一子句集合中每个第一子句中相同长度的句子串。该实施例中，词语匹配指的是将每个第一子串与词典中的与第一子串的长度相同的词语进行相同匹配。该实施例中，第一分词集合指的是匹配成功的所有的子串构建的集合。该实施例中，移入-规约语法分析器指的是自底向上语法分析的一种形式，使用一个栈来保存文发符号，并用一个输入缓冲区来存放将要进行语法分析的其余符号，移入：将下一个输入符号移入到栈顶端，规约：被归约的符号串右端必然是栈顶。语法分析器在栈中确定这个串的左端并决定用哪个非终结符号来替换这个串。该实施例中，LR文法解析指的是从语法分析树的叶子节点开始，逐渐向上到达根节点，反向构造出一个最右推导序列，从而构建完整的语法分析树，LR文法的L是输入从左到右，R是反向最右推导，k是前瞻符号数量。该实施例中，第一语法分析结果指的是第一分词集合中每个第一分词符合语法结构或者不符合语法结构的分析结果，包括语法分析结果合格以及语法分析结果不合格。该实施例中，分词-空间对照表指的是分词以及相对应的空间向量一一对应的对照表。该实施例中，第一向量集合指的是第一分词集合中每个第一分词与在分词-空间对照表中相对应的第一向量的集合。该实施例中，第二向量集合指的是对第二子句集合按照与第一子句集合相同的处理方法处理得到的第二分词集合中每个第二分词与在分词-空间对照表中相对应的第二向量的集合。该实施例中，向量组指的是按照顺序为每个第一向量匹配一个最近的第二向量，若第一向量或者第二向量数量不相等，则匹配不到第一向量或者第二向量的另一向量与0组成向量组。该实施例中，切比雪夫距离指的是L∞度量，是向量空间中的一种度量，二个点之间的距离定义是其各坐标数值差绝对值的最大值，是由一致范数所衍生的度量，也是超凸度量的一种：；其中，/＞指的是第/＞组向量组中第一向量；/＞指的是第/＞组向量组中第二向量。上述技术方案的工作原理及有益效果是：通过对任意两个输入界面的同输入域名所对应的返回域名的网页的网页内容进行抓取，得到相对应的第一文本内容以及第二文本内容，对第一文本内容以及第二文本内容进行进行分词，进行语法分析，使用数值向量描述文本在语义空间中位置，得到第一向量集合以及第二向量集合，构建向量组，计算相对应的网页内容相似度特征值，精准地分析网页内容相似度，有利于后续对域名关联度进行分析，及时进行预警，有效抵御恶意域名的攻击。实施例7：基于实施例1的基础上，特征值计算单元，包括：；其中，/＞表示网页内容相似度特征值；/＞指的是第/＞组向量组中第一向量；/＞指的是第/＞组向量组中第二向量；/＞表示全部向量组的数量；/＞表示全部向量组中第/＞组向量组的切比雪夫距离；/＞表示向量组的特征系数；/＞表示全部向量组中第/＞组向量组的向量权重，表示第/＞组向量组中的第一向量经过相对应的向量权重的调整得到的新向量；/＞表示第/＞组向量组中的第二向量经过相对应的向量权重的调整得到的新向量；/＞表示切比雪夫距离的定义函数；log表示对数函数符号。上述技术方案的工作原理及有益效果是：通过计算任意两个输入界面的同输入域名所对应的返回域名的网页的网页内容的相似度特征值，精准地分析相似度，有利于后续对域名关联度进行分析，及时进行预警，有效抵御恶意域名的攻击。实施例8：基于实施例1的基础上，设置模块，包括：配置选项获取单元：基于所述域名详细信息以及网页内容相似度特征值，确定配置选项；权重设置单元：向每个配置选项进行权重设置处理，得到域名关联度分值V；；其中，/＞表示域名关联度值，/＞为域名关联配置项数,表示第/＞个配置选项加权值；/＞表示第i个配置选项的关联项取值；其中，配置选项与证书序号、证书签署结束时间、预证书的时间戳、网页相似度、证书更新时间以及证书生成时间相关；其中，加权值参考值如下：证书序号：加权值20；证书签署结束时间：加权值15；预证书的时间戳：加权值 25；网页相似度：加权值50；证书更新时间：加权值30；证书生成时间：加权值 30；Si参考值如下:时间50秒内/序号相差小于10：加权值 120；时间100秒内/相差小于20加权值：100；时间200 秒内/序号相差小于40内：加权值80；时间300 秒内/序号相差小于60内：加权值60；时间400 秒内/序号相差小于80内：加权值40；时间大于500 秒/序号相差大于100或未查询到 ：加权值50。该实施例中，配置选项指的是证书序号、证书签署结束时间、预证书的时间戳、网页相似度、证书更新时间以及证书生成时间在域名详细信息中的相对应的数值。上述技术方案的工作原理及有益效果是：通过对域名详细信息以及网页内容相似度特征值进行分析，确定配置选项，向每个配置选项进行权重设置处理，计算得到得到域名关联度分值，精准分析，及时进行预警，有效抵御恶意域名的攻击。实施例9：基于实施例1的基础上，量化模块，用于：门限值判断单元：若域名关联度值大于预设关联门限值，则域名以及返回域名有关联关系，判定有关联关系的域名和返回域名为恶意域名；警报发送单元：发送恶意域名至系统管理员，拒绝恶意域名的访问。上述技术方案的工作原理及有益效果是：通过对域名关联度值以及预设关联门限值进行对比，得到域名以及返回域名是否有关联关系，精准判断恶意域名，及时进行预警，有效抵御恶意域名的攻击。显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围之内，则本发明也意图包含这些改动和变型在内。
