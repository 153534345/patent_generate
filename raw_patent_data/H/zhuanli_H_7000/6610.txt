标题title
可信DCS终端间数据同步方法、系统、电子设备及存储介质
摘要abst
一种可信DCS终端间数据同步方法、系统、电子设备及存储介质，方法包括主控制器向可信管理平台发送获取备控制器可信状态请求；可信管理平台向主控制器回复备控制器的当前可信状态信息；主控制器根据当前可信状态信息判断备控制器当前是否可信，若可信，则采用哈希算法对主备同步数据进行完整性度量；根据主备同步数据的完整性度量判断主备同步数据是否完整，若主备同步数据完整则将主备同步数据与度量结果一起进行加密后发送至备控制器；等待备控制器数据同步回复，若收到同步完成回复，则主控制器进行切备控制器操作。本发明只有在备机可信时才可以进行主备数据的同步，保证了同步数据的安全性和完整性，为主备切换提供了数据保障。
权利要求书clms
1.一种可信DCS终端间数据同步方法，其特征在于，包括：主控制器向可信管理平台发送获取备控制器可信状态请求；可信管理平台向主控制器回复备控制器的当前可信状态信息；主控制器根据当前可信状态信息，判断备控制器当前是否可信，若可信，则采用SHA1哈希算法对主备同步数据进行完整性度量；根据主备同步数据的完整性度量，判断主备同步数据是否完整，若主备同步数据完整，则将主备同步数据与由完整性度量得到的度量结果一起进行加密后发送至备控制器；等待备控制器数据同步完成回复，若收到同步完成回复，则主控制器进行切备控制器操作。2.根据权利要求1所述的可信DCS终端间数据同步方法，其特征在于，所述主控制器向可信管理平台发送获取备控制器可信状态请求的步骤中，主控制器构造备控制器可信状态查询命令，对备控制器可信状态查询命令进行非对称加密算法加密后发送可信管理平台；所述可信管理平台向主控制器回复备控制器的当前可信状态信息的步骤中，可信管理平台对备控制器可信状态查询命令进行解密和解析，并将备控制器可信状态信息进行非对称加密算法加密后返回主控制器；所述主控制器根据当前可信状态信息，判断备控制器当前是否可信的步骤中，主控制器对可信管理平台返回的经过非对称加密算法加密的备控制器可信状态信息进行解密，并根据备控制器可信状态信息判断备控制器当前是否可信。3.根据权利要求2所述的可信DCS终端间数据同步方法，其特征在于，所述采用SHA1哈希算法对主备同步数据进行完整性度量的步骤中，主控制器周期性的对主备同步数据进行SHA1哈希度量，并将度量结果存储在可信芯片的存储空间，在发生主备切换时对主备同步数据进行SHA1哈希度量并与可信芯片中存储的度量结果进行对比来确定数据的完整性。4.根据权利要求3所述的可信DCS终端间数据同步方法，其特征在于，所述主控制器根据当前可信状态信息，判断备控制器当前是否可信的步骤中，若备控制器当前不可信，则生成备控制器不可信告警信息，流程结束；在所述将主备同步数据与由完整性度量得到的度量结果一起进行加密后发送至备控制器的步骤中，备控制器对主控制器发送的加密数据进行解密；通过主控制器发送的SHA1哈希度量结果对主备同步数据进行完整性校验，如校验不通过则生成备控制器数据完整性校验失败告警，请求主控制器重新发送主备同步数据，直至校验通过；如校验通过则备控制器升级为主控制器，给主控制器发送切换完成回复，完成备控制器数据同步处理；所述通过主控制器发送的SHA1哈希度量结果对主备同步数据进行完整性校验包括：获取并解密主控器发送的非对称加密算法加密主备同步数据和SHA1哈希度量结果，对解密的主备同步数据进行SHA1哈希度量，并将得到的SHA1度量值与解密的SHA1哈希度量结果进行对比来确定数据的完整性。5.根据权利要求1所述的可信DCS终端间数据同步方法，其特征在于，所述根据主备同步数据的完整性度量，判断主备同步数据是否完整的步骤中，若主备同步数据不完整，则表明主备同步数据被篡改，完整性校验不通过，生成主备数据完整性校验错告警，流程结束。6.根据权利要求1所述的可信DCS终端间数据同步方法，其特征在于，所述将主备同步数据与由完整性度量得到的度量结果一起进行加密的步骤中，采用非对称加密算法进行加密，包括如下步骤：任意选取两个不同的素数p和q，计算乘积，式中/＞为取p和q的最小公倍数；任意选取一个大于素数p和q的整数e，满足，整数e用于加密钥，式中为取参数的最大公约数；确定解密钥d，满足，mod表示取模运算，/＞则表示对d和e相乘后进行取模运算，即/＞，/＞是一个任意的整数；将明文m加密成密文c，m是一个整数，m＜n，加密算法为，式中，E表示对明文m进行加密运算；将密文c解密为明文m，解密算法为，式中，D为对密文c进行解密运算。7.根据权利要求1所述的可信DCS终端间数据同步方法，其特征在于，所述等待备控制器数据同步完成回复的步骤中，若未收到同步完成回复或收到重发回复，则跳转至采用SHA1哈希算法对主备同步数据进行完整性度量，重复执行至等待备控制器数据同步回复；设定重复次数阈值，若达到重复次数阈值仍未收到同步完成回复，生成主备控制器数据同步超时告警。8.一种可信DCS终端间数据同步系统，其特征在于，包括：请求发送模块，用于主控制器向可信管理平台发送获取备控制器可信状态请求；状态回复模块，用于可信管理平台向主控制器回复备控制器的当前可信状态信息；同步数据完整性度量模块，用于主控制器根据当前可信状态信息，判断备控制器当前是否可信，若可信，则采用SHA1哈希算法对主备同步数据进行完整性度量；加密模块，用于根据主备同步数据的完整性度量，判断主备同步数据是否完整，若主备同步数据完整，则将主备同步数据与由完整性度量得到的度量结果一起进行加密后发送至备控制器；备控制器切换模块，用于等待备控制器数据同步完成回复，若收到同步完成回复，则主控制器进行切备控制器操作。9.一种电子设备，其特征在于，包括：存储器，存储至少一个指令；及处理器，执行所述存储器中存储的指令以实现如权利要求1至7中任一项所述的可信DCS终端间数据同步方法。10.一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如权利要求1至7中任一项所述的可信DCS终端间数据同步方法。
说明书desc
技术领域本发明属于DCS控制器安全运行技术领域，具体涉及一种可信DCS终端间数据同步方法、系统、电子设备及存储介质。背景技术DCS是分布式控制系统的英文缩写，是相对于集中式控制系统而言的一种新型计算机控制系统，综合了计算机、通讯、显示和控制等4C技术，其基本思想是分散控制、集中操作、分级管理、配置灵活以及组态方便。DCS冗余技术就是增加多余的设备，以保证系统更加可靠、安全地工作。DCS系统冗余的设计目的是为了使系统运行不受局部故障的影响，而且故障部件的维护对整个系统的功能实现没有影响，并可以实现在线维护，使故障部件得到及时的修复。冗余是一种高级的可靠性设计技术，1:1热冗余也就是所谓的双重化，是其中一种有效的冗余方式，但它并不是两个部件简单的并联运行，而是需要硬件、软件、通讯等协同工作来实现。将互为冗余的两个部件构成一个有机的整体，通常包括以下多个技术要点：信息同步技术、故障检测技术、故障仲裁技术和切换技术、热插拔技术以及故障隔离技术。在安全级别要求很高的发电行业，为了提高DCS控制器的可靠性，系统通常采用双余度架构设计，然而，在主控制器发生故障需要启用备控制器时，如何在主备控制器间实现高效的数据同步，是DCS控制系统研究的重点和难点。在可信DCS控制系统中，如何将主备控制器可信状态与数据同步进行有效融合是一个需要研究的重要课题。发明内容本发明的目的在于针对上述现有技术中的问题，提供一种可信DCS终端间数据同步方法、系统、电子设备及存储介质，通过对主备控制器的可信状态进行实时获取，以作为发生主备切换时数据同步的重要依据，为系统主备切换提供了数据保障。为了实现上述目的，本发明有如下的技术方案：第一方面，提供一种可信DCS终端间数据同步方法，包括：主控制器向可信管理平台发送获取备控制器可信状态请求；可信管理平台向主控制器回复备控制器的当前可信状态信息；主控制器根据当前可信状态信息，判断备控制器当前是否可信，若可信，则采用SHA1哈希算法对主备同步数据进行完整性度量；根据主备同步数据的完整性度量，判断主备同步数据是否完整，若主备同步数据完整，则将主备同步数据与由完整性度量得到的度量结果一起进行加密后发送至备控制器；等待备控制器数据同步完成回复，若收到同步完成回复，则主控制器进行切备控制器操作。作为一种优选的方案，所述主控制器向可信管理平台发送获取备控制器可信状态请求的步骤中，主控制器构造备控制器可信状态查询命令，对备控制器可信状态查询命令进行非对称加密算法加密后发送可信管理平台；所述可信管理平台向主控制器回复备控制器的当前可信状态信息的步骤中，可信管理平台对备控制器可信状态查询命令进行解密和解析，并将备控制器可信状态信息进行非对称加密算法加密后返回主控制器；所述主控制器根据当前可信状态信息，判断备控制器当前是否可信的步骤中，主控制器对可信管理平台返回的经过非对称加密算法加密的备控制器可信状态信息进行解密，并根据备控制器可信状态信息判断备控制器当前是否可信。作为一种优选的方案，所述采用SHA1哈希算法对主备同步数据进行完整性度量的步骤中，主控制器周期性的对主备同步数据进行SHA1哈希度量，并将度量结果存储在可信芯片的存储空间，在发生主备切换时对主备同步数据进行SHA1哈希度量并与可信芯片中存储的度量结果进行对比来确定数据的完整性。作为一种优选的方案，所述主控制器根据当前可信状态信息，判断备控制器当前是否可信的步骤中，若备控制器当前不可信，则生成备控制器不可信告警信息，流程结束；在所述将主备同步数据与由完整性度量得到的度量结果一起进行加密后发送至备控制器的步骤中，备控制器对主控制器发送的加密数据进行解密；通过主控制器发送的SHA1哈希度量结果对主备同步数据进行完整性校验，如校验不通过则生成备控制器数据完整性校验失败告警，请求主控制器重新发送主备同步数据，直至校验通过；如校验通过则备控制器升级为主控制器，给主控制器发送切换完成回复，完成备控制器数据同步处理；所述通过主控制器发送的SHA1哈希度量结果对主备同步数据进行完整性校验包括：获取并解密主控器发送的非对称加密算法加密主备同步数据和SHA1哈希度量结果，对解密的主备同步数据进行SHA1哈希度量，并将得到的SHA1度量值与解密的SHA1哈希度量结果进行对比来确定数据的完整性。作为一种优选的方案，所述根据主备同步数据的完整性度量，判断主备同步数据是否完整的步骤中，若主备同步数据不完整，则表明主备同步数据被篡改，完整性校验不通过，生成主备数据完整性校验错告警，流程结束。作为一种优选的方案，所述将主备同步数据与由完整性度量得到的度量结果一起进行加密的步骤中，采用非对称加密算法进行加密，包括如下步骤：任意选取两个不同的素数p和q，计算乘积，式中为取p和q的最小公倍数；任意选取一个大于素数p和q的整数e，满足，整数e用于加密钥，式中/＞为取参数的最大公约数；确定解密钥d，满足，mod表示取模运算，/＞则表示对d和e相乘后进行取模运算，即/＞，/＞是一个任意的整数；将明文m加密成密文c，m是一个整数，m＜n，加密算法为，式中，E表示对明文m进行加密运算；将密文c解密为明文m，解密算法为，式中，D为对密文c进行解密运算。作为一种优选的方案，所述等待备控制器数据同步完成回复的步骤中，若未收到同步完成回复或收到重发回复，则跳转至采用SHA1哈希算法对主备同步数据进行完整性度量，重复执行至等待备控制器数据同步回复；设定重复次数阈值，若达到重复次数阈值仍未收到同步完成回复，生成主备控制器数据同步超时告警。第二方面，提供一种可信DCS终端间数据同步系统，包括：请求发送模块，用于主控制器向可信管理平台发送获取备控制器可信状态请求；状态回复模块，用于可信管理平台向主控制器回复备控制器的当前可信状态信息；同步数据完整性度量模块，用于主控制器根据当前可信状态信息，判断备控制器当前是否可信，若可信，则采用SHA1哈希算法对主备同步数据进行完整性度量；加密模块，用于根据主备同步数据的完整性度量，判断主备同步数据是否完整，若主备同步数据完整，则将主备同步数据与由完整性度量得到的度量结果一起进行加密后发送至备控制器；备控制器切换模块，用于等待备控制器数据同步完成回复，若收到同步完成回复，则主控制器进行切备控制器操作。第三方面，提供一种电子设备，包括：存储器，存储至少一个指令；及处理器，执行所述存储器中存储的指令以实现所述的可信DCS终端间数据同步方法。第四方面，提供一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现所述的可信DCS终端间数据同步方法。相较于现有技术，本发明至少具有如下的有益效果：可信管理平台是运行于发电控制系统上位机的管理软件，可实现对发电控制系统中的计算设备、通信网络设备、区域边界设备进行统一的可信安全管理。本发明利用可信管理平台对主备控制器的可信状态进行实时获取，以作为发生主备切换时数据同步的重要依据。本发明方法在可信管理平台中管理所有可信终端的可信状态，当主控制器因故需要进行主备切换时，需要在可信管理平台中获取备控制器的可信状态，只有在备控制器可信时才可以进行主备数据的同步。通过本发明方法可以有效的将可信DCS控制器的可信状态与主备数据同步业务进行融合，同时采用SHA1哈希算法及数据加密传输，保证了同步数据的安全性和完整性，为系统主备切换提供了数据保障，保护了DCS控制器间同步数据不被恶意篡改，进而保障了发电系统的安全性。附图说明为了更加清楚地说明本发明实施例的技术方案，下面将对实施例中所需要使用的附图作以简单地介绍，应当理解，以下附图仅示出了本发明部分实施例，对于本领域普通技术人员而言，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1 本发明实施例可信管理平台与主控制器之间的交互示意图；图2 本发明实施例可信DCS终端间数据同步方法主控制器执行流程图；图3 本发明实施例可信DCS终端间数据同步方法备控制器执行流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员还可以在没有做出创造性劳动的前提下获得其他实施例。本发明实施例提出一种可信DCS终端间数据同步方法，利用可信管理平台对主备控制器的可信状态进行实时获取，以作为发生主备切换时数据同步的重要依据。主要步骤包括备控制器可信状态获取、主控制器数据同步处理以及备控制器数据同步处理。S1、备控制器可信状态获取流程，如图1所示。1.1 主控制器向可信管理平台发送获取备控制器可信状态请求；1.2 可信管理平台向主控制器回复备控制器的当前可信状态信息；S2、主控制器数据同步处理流程，如图2所示。2.1 主控制器判断备控制器当前是否为可信状态，可信则跳转至步骤2.3，不可信则跳转至步骤2.2；主控制器判断备控制器当前是否为可信状态的步骤如下：a.主控制器构造备控制器可信状态查询命令，对备控制器可信状态查询命令进行非对称加密算法加密后发送可信管理平台；b.可信管理平台对备控制器可信状态查询命令进行解密和解析，并将备控制器可信状态信息进行非对称加密算法加密后返回主控制器；c.主控制器对可信管理平台返回的经过非对称加密算法加密的备控制器可信状态信息进行解密，并根据备控制器可信状态信息判断备控制器当前是否可信。2.2 当前备控制器不可信，系统产生备控制器不可信告警信息，流程结束；2.3 采用SHA1哈希算法对主备同步数据进行完整性度量，具体步骤如下：主备同步数据为发电控制系统关键数据，如主备IP地址数据等，主控制器会周期性的对主备同步数据进行SHA1哈希度量，并将度量结果存储在可信芯片的存储空间，在发生主备切换时对主备同步数据进行SHA1哈希度量并与可信芯片中存储的度量值进行对比来确定数据的完整性。2.4 判断同步数据是否完整，完整则跳转至步骤2.6，不完整则跳转至步骤2.5；2.5 同步数据被篡改，完整性校验不通过，生成主备数据完整性校验错告警，流程结束；2.6 同步数据完整，将同步数据与度量结果一起进行非对称加密算法加密，将加密后的数据发送至备控制器；所述非对称加密算法具体包括如下步骤：任意选取两个不同的素数p和q，计算乘积，式中为取p和q的最小公倍数；任意选取一个大于素数p和q的整数e，满足，整数e用于加密钥，式中/＞为取参数的最大公约数；确定解密钥d，满足，mod表示取模运算，/＞则表示对d和e相乘后进行取模运算，即/＞，/＞是一个任意的整数；将明文m加密成密文c，m是一个整数，m＜n，加密算法为，式中，E表示对明文m进行加密运算；将密文c解密为明文m，解密算法为，式中，D为对密文c进行解密运算。然而，只根据公开整数n和e要计算出密钥d是不可能的。因此，任何人都可对明文进行加密，但只有授权用户才可对密文解密。2.7 等待备控制器数据同步回复，收到同步完成回复则跳转至步骤2.8，未收到同步完成回复或收到重发回复则跳转至步骤2.9；2.8 主控制器进行切备控制器操作；2.9 跳转至步骤2.3，重复3次主备同步操作，如3次同步后仍超时，则跳转至步骤2.10；2.10、主备控制器数据同步超时告警。S3、备控制器数据同步处理流程，如图3所示。3.1对主控制器发送的加密数据进行解密；3.2 通过主控制器发送的SHA1哈希度量结果对同步数据进行完整性校验，如校验通过则跳转至步骤3.4，如校验不通过则跳转至步骤3.3；通过主控制器发送的SHA1哈希度量结果对主备同步数据进行完整性校验包括：获取并解密主控器发送的非对称加密算法加密主备同步数据和SHA1哈希度量结果；对步骤中解密的主备同步数据进行SHA1哈希度量；对步骤中计算出的SHA1哈希度量结果与步骤中解密出的SHA1哈希度量结果进行对比来确定数据的完整性。3.3备控制器数据完整性校验失败告警，请求主控制器重新发送同步收据；3.4备控制器升级为主控制器；3.5给主控制器发送切换完成回复，完成备控制器数据同步处理。通过本发明可信DCS终端间数据同步方法能够有效的将可信DCS控制器的可信状态与主备数据同步业务进行融合。同时，采用SHA1哈希算法及非对称加密算法保证了同步数据的安全性和完整性，为系统主备切换提供了数据保障，保护了DCS控制器间同步数据不被恶意篡改，保障发电系统的安全性。本发明在可信管理平台中管理所有可信终端的可信状态，当主控制器因故需要进行主备切换时，需要在管理平台中获取备控制器的可信状态，备机不可信时系统产生备机不可信告警，只有在备机可信时才可以进行主备数据的同步。主备间数据同步采用网络通讯，SHA1哈希算法较CRC循环冗余校核校验算法具有更高的安全性，为了防止主备同步数据发生篡改，采用了SHA1哈希算法对同步数据进行完整性度量，并将度量结果与同步数据一起进行非对称加密算法加密处理后发送给备控制器，充分保证了同步数据的安全性和完整性，为系统主备切换提供了数据保障。本发明的另一实施例还提出一种可信DCS终端间数据同步系统，包括：请求发送模块，用于主控制器向可信管理平台发送获取备控制器可信状态请求；状态回复模块，用于可信管理平台向主控制器回复备控制器的当前可信状态信息；同步数据完整性度量模块，用于主控制器根据当前可信状态信息，判断备控制器当前是否可信，若可信，则采用SHA1哈希算法对主备同步数据进行完整性度量；加密模块，用于根据主备同步数据的完整性度量，判断主备同步数据是否完整，若主备同步数据完整，则将主备同步数据与由完整性度量得到的度量结果一起进行加密后发送至备控制器；备控制器切换模块，用于等待备控制器数据同步完成回复，若收到同步完成回复，则主控制器进行切备控制器操作。本发明的另一实施例还提出一种电子设备，包括：存储器，存储至少一个指令；及处理器，执行所述存储器中存储的指令以实现所述的可信DCS终端间数据同步方法。本发明的另一实施例还提出一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现所述的可信DCS终端间数据同步方法。示例性的，所述存储器中存储的指令可以被分割成一个或多个模块/单元，所述一个或者多个模块/单元被存储在计算机可读存储介质中，并由所述处理器执行，以完成本发明实施例的可信DCS终端间数据同步方法。所述一个或多个模块/单元可以是能够完成特定功能的一系列计算机可读指令段，该指令段用于描述所述计算机程序在服务器中的执行过程。所述电子设备可以是智能手机、笔记本、掌上电脑及云端服务器等计算设备。所述电子设备可包括，但不仅限于，处理器、存储器。本领域技术人员可以理解，所述电子设备还可以包括更多或更少的部件，或者组合某些部件，或者不同的部件，例如所述电子设备还可以包括输入输出设备、网络接入设备、总线等。所述处理器可以是中央处理单元，还可以是其他通用处理器、数字信号处理器、专用集成电路、现成可编程门阵列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器等。所述存储器可以是所述服务器的内部存储单元，例如服务器的硬盘或内存。所述存储器也可以是所述服务器的外部存储设备，例如所述服务器上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，所述存储器还可以既包括所述服务器的内部存储单元也包括外部存储设备。所述存储器用于存储所述计算机可读指令以及所述服务器所需的其他程序和数据。所述存储器还可以用于暂时地存储已经输出或者将要输出的数据。需要说明的是，上述模块单元之间的信息交互、执行过程等内容，由于与方法实施例基于同一构思，其具体功能及带来的技术效果，具体可参见方法实施例部分，此处不再赘述。所属领域的技术人员可以清楚地了解到，为了描述的方便和简洁，仅以上述各功能单元、模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能单元、模块完成，即将所述装置的内部结构划分成不同的功能单元或模块，以完成以上描述的全部或者部分功能。实施例中的各功能单元、模块可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中，上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。另外，各功能单元、模块的具体名称也只是为了便于相互区分，并不用于限制本申请的保护范围。上述系统中单元、模块的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。所述集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本申请实现上述实施例方法中的全部或部分流程，可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一计算机可读存储介质中，该计算机程序在被处理器执行时，可实现上述各个方法实施例的步骤。其中，所述计算机程序包括计算机程序代码，所述计算机程序代码可以为源代码形式、对象代码形式、可执行文件或某些中间形式等。所述计算机可读介质至少可以包括：能够将计算机程序代码携带到拍照装置/终端设备的任何实体或装置、记录介质、计算机存储器、只读存储器、随机存取存储器、电载波信号、电信信号以及软件分发介质。例如U盘、移动硬盘、磁碟或者光盘等。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述或记载的部分，可以参见其它实施例的相关描述。以上所述实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的精神和范围，均应包含在本申请的保护范围之内。
