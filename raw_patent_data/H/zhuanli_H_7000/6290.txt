标题title
一个基于WebRTC技术的云会议音视频传输系统及方法
摘要abst
本申请公开了一种基于WebRTC技术的云会议音视频传输系统及方法，其中系统包括：通信模块、媒体协商模块、网络传输模块。通信模块负责与其它参与者进行音视频通信，又可以细分为点对点音视频通话子模块、多人会议子模块，基于WebRTC技术，分别用于建立一对一、多人音视频连接关系；媒体协商模块用于协商通信双方之间的媒体参数，保证一致；网络传输模块负责处理音视频数据的传输。该系统还可包括自适应调整模块，能够根据网络带宽、延迟情况动态调整编解码器、分辨率、帧率等参数，保证音视频质量和流畅性。本发明解决了全面的功能覆盖，满足用户不同场景的沟通和协作需求。
权利要求书clms
1.一种基于WebRTC技术的云会议音视频传输系统，其特征在于，该系统包括：通信模块、媒体协商模块、网络传输模块；其中，所述通信模块，用于根据用户在终端交互界面上输入的指令，采用WebRTC技术处理音视频流，建立当前用户与其它参与者之间的一对一或多人音视频通信连接；所述媒体协商模块，用于协商通信多方之间的媒体参数，并保持一致；所述网络传输模块，用于对音视频数据进行传输。2.根据权利要求1所述的基于WebRTC技术的云会议音视频传输系统，其特征在于，所述通信模块包括：点对点音视频通话子模块，用于根据用户选择的网关或SIP方式建立点对点的音视频通话连接，并对音频和视频进行捕获、编解码、传输、播放、渲染；优选地，所述通信模块采用的webRTC库增加两种编解码能力OMX.IMG和OMX.hisi的支持。3.根据权利要求1所述的基于WebRTC技术的云会议音视频传输系统，其特征在于，所述通信模块还包括：多人会议子模块，用于提供多人视频会议功能，包括创建会议房间、邀请其他参与者、管理会议；优选地，所述多人会议模块使用Videoroom插件或MCU会议来实现多人视频通信。4.根据权利要求1所述的基于WebRTC技术的云会议音视频传输系统，其特征在于，该系统还包括：自适应调整模块，用于根据网络条件对音视频数据的相关参数进行动态调整；优选地，所述网络条件包括以下至少一种：网络带宽、延迟情况；优选地，所述音视频数据的相关参数包括以下至少一种：动态调整编解码器、分辨率、帧率；优选地，所述自适应调整模块循环调用WebRTC提供的peerConnection.getStats方法实时监听所述通信模块中audioTrack中的googRtt参数变化；如果googRtt＞＝300±5，并连续超过3次，则控制关闭当前摄像头；如果googRtt＞100±5，并连续超过3次，则将摄像头分辨率改为当前设备支持最低分辨率，帧率改为15；如果googRtt＜80±5，并连续超过10次，则提示打开摄像头；如果googRtt＜50±5，并连续超过10次，则恢复为用户设置的分辨率；以上判断使用if else方法从上至下顺序，满足任一条件则其他不执行。5.根据权利要求3所述的基于WebRTC技术的云会议音视频传输系统，其特征在于，该系统还包括：直播和录播模块，用所述多人会议子模块产生的会议内容进行直播和录播，包括流媒体服务器的连接与推送、观看链接的生成与分享、录制内容的存储与回放；优选地，所述直播和录播分别通过Streaming插件和Recordplay插件实现。6.根据权利要求1所述的基于WebRTC技术的云会议音视频传输系统，其特征在于，所述媒体参数包括以下至少一种：解码器、分辨率、帧率。7.根据权利要求1所述的基于WebRTC技术的云会议音视频传输系统，其特征在于，所述网络传输模块使用ICE协议发现最佳的网络路径，并进行候选项选择。8.一种基于权利要求1-7任一项所述的基于WebRTC技术的云会议音视频传输系统的传输方法，其特征在于，包括步骤：通信模块在接收到用户从用户界面发起的指令后，建立一对一音视频通话，或创建多人视频会议；媒体协商模块协商通信双方之间的媒体参数，并保持一致；网络传输模块对音视频数据进行传输。9.根据权利要求8所述的传输方法，其特征在于，对于所述一对一音视频通话，系统根据用户选择的使用网关或SIP方式进行通信，应用会建立音视频连接，并通过WebRTC技术实现音视频传输；优选地，对于所述多人视频会议，系统根据用户选择的使用Videoroom插件或MCU会议方式建立多人视频会议；其中，所述Videoroom插件通过建立多人视频房间，并邀请其他参与者加入实现多人通信；所述MCU会议通过中央控制单元处理多个参与者之间的音视频流，实现多人视频会议。10.根据权利要求8所述的传输方法，其特征在于，该方法还包括：自适应调整模块根据网络条件对音视频数据的相关参数进行动态调整；优选地，所述动态调整包括：循环调用WebRTC提供的peerConnection.getStats方法实时监听audioTrack中的googRtt参数变化；如果googRtt＞＝300±5，并连续超过3次，则提示关闭当前摄像头；如果googRtt＞100±5，并连续超过3次，则将摄像头分辨率改为当前设备支持最低分辨率，帧率改为15；如果googRtt＜80±5，并连续超过10次，则提示打开摄像头；如果googRtt＜50±5，并连续超过10次，则恢复为用户设置的分辨率；以上判断使用if else方法从上至下顺序，满足任一条件则其他不执行；优选地，该方法还包括：直播和录播模块对多人视频会议的会议内容进行直播和录播；优选地，所述直播和录播模块通过Streaming插件进行会议内容的实时直播；使用Recordplay插件对会议内容进行录制。
说明书desc
技术领域本申请涉及一种视频会议系统，属于音视频传输领域，尤其涉及一个基于WebRTC技术的云会议音视频传输系统及方法。背景技术WebRTC已经被广泛应用于实时通信领域，包括视频会议应用。相对于市场上存在许多其他的通信平台或软件，如Zoom、Microsoft Teams、腾讯会议等。尽管WebRTC作为现有技术方案在实时通信领域取得了显著进展，但仍存在网络兼容性、信令服务器依赖、网络传输性能、会议规模限制和缺乏定制化功能等方面的缺点。在网络兼容性方面，由于WebRTC依赖于浏览器和设备的支持，不同浏览器和设备之间的WebRTC实现可能存在兼容性问题。这可能导致在某些浏览器或设备上无法实现完全兼容的音视频通信，限制了用户的选择和体验。在信令服务器依赖方面，WebRTC需要使用信令服务器来建立通信双方之间的连接。信令服务器能够起到协调和交换媒体相关信息的作用。然而，信令服务器的部署和维护可能需要额外的成本和复杂性。在网络传输性能方面，WebRTC在传输音视频数据时通常使用UDP协议，UDP虽然快速，但对网络稳定性要求较高。在不稳定或高丢包率的网络环境下，音视频质量可能受到影响，导致延迟、抖动和丢帧等问题。在会议规模限制方面，在WebRTC的原生实现中，多人视频会议的规模受到设备和网络的限制。当参与会议的人数增加时，需要更大的带宽和处理能力，这可能导致性能下降或无法满足大规模会议的需求。在定制化功能方面，现有的WebRTC视频会议应用通常缺乏灵活的定制化功能。用户可能无法根据自己的需求进行带宽、分辨率、编解码器等参数的调整，以优化会议体验。发明内容根据本申请的一个方面，为提供更好的音视频会议体验，提供了一种基于WebRTC技术的云会议音视频传输系统，该系统包括通信模块、媒体协商模块、网络传输模块；其中，所述通信模块，用于根据用户在终端交互界面上输入的指令，采用WebRTC技术处理音视频流，建立当前用户与其它参与者之间的一对一或多人音视频通信连接；所述媒体协商模块，用于协商通信多方之间的媒体参数，并保持一致；所述网络传输模块，用于对音视频数据进行传输。可选地，所述终端可以为智能手机或平板电脑。可选地，所述通信模块包括：点对点音视频通话子模块，用于根据用户选择的网关或SIP方式建立点对点的音视频通话连接，并对音频和视频进行捕获、编解码、传输、播放、渲染。可选地，所述通信模块采用的webRTC库增加两种编解码能力OMX.IMG和OMX.hisi的支持。可选地，所述通信模块还包括：多人会议子模块，用于提供多人视频会议功能，包括创建会议房间、邀请其他参与者、管理会议。可选地，所述多人会议模块使用Videoroom插件或MCU会议来实现多人视频通信。可选地，该系统还包括：自适应调整模块，用于根据网络条件对音视频数据的相关参数进行动态调整。可选地，所述网络条件包括但不限于：网络带宽、延迟情况。可选地，所述音视频数据的相关参数包括但不限于：动态调整编解码器、分辨率、帧率。可选地，所述自适应调整模块循环调用WebRTC提供的peerConnection.getStats方法实时监听audioTrack中的googRtt参数变化；如果googRtt＞＝300±5，并连续超过3次，则提示关闭当前摄像头；如果googRtt＞100±5，并连续超过3次，则将摄像头分辨率改为当前设备支持最低分辨率，帧率改为15；如果googRtt＜80±5，并连续超过10次，则提示打开摄像头；如果googRtt＜50±5，并连续超过10次，则恢复为用户设置的分辨率；以上判断使用if else方法从上至下顺序，满足任一条件则其他不执行。可选地，该系统还包括：直播和录播模块，用所述多人会议子模块产生的会议内容进行直播和录播，包括流媒体服务器的连接与推送、观看链接的生成与分享、录制内容的存储与回放。可选地，所述直播和录播分别通过Streaming插件和Recordplay插件实现。可选地，所述媒体参数包括但不限于：解码器、分辨率、帧率。可选地，所述网络传输模块使用ICE协议发现最佳的网络路径，并进行候选项选择。根据本申请的另一个方面，提供了一种基于WebRTC技术的云会议音视频传输方法，包括：通信模块在接收到用户从用户界面发起的指令后，建立一对一音视频通话，或创建多人视频会议；媒体协商模块协商通信双方之间的媒体参数，并保持一致；网络传输模块对音视频数据进行传输。可选地，对于所述一对一音视频通话，系统根据用户选择的使用网关或SIP方式进行通信，应用会建立音视频连接，并通过WebRTC技术实现音视频传输。可选地，对于所述多人视频会议，系统根据用户选择的使用Videoroom插件或MCU会议方式建立多人视频会议；其中，所述Videoroom插件通过建立多人视频房间，并邀请其他参与者加入实现多人通信；所述MCU会议通过中央控制单元处理多个参与者之间的音视频流，实现多人视频会议。可选地，该方法还包括：自适应调整模块根据网络条件对音视频数据的相关参数进行动态调整。可选地，所述动态调整包括：循环调用WebRTC提供的peerConnection.getStats方法实时监听audioTrack中的googRtt参数变化；如果googRtt＞＝300±5，并连续超过3次，则控制关闭当前摄像头，同时可以向用户提示；如果googRtt＞100±5，并连续超过3次，则将摄像头分辨率改为当前设备支持最低分辨率，帧率改为15；如果googRtt＜80±5，并连续超过10次，则提示打开摄像头；如果googRtt＜50±5，并连续超过10次，则恢复为用户设置的分辨率；以上判断使用if else方法从上至下顺序，满足任一条件则其他不执行。可选地，该方法还包括：直播和录播模块对多人视频会议的会议内容进行直播和录播。可选地，所述直播和录播模块通过Streaming插件进行会议内容的实时直播；使用Recordplay插件对会议内容进行录制。本申请能产生的有益效果包括：1)全面的功能覆盖：本申请提供了点对点音视频通话、多人视频会议、直播录播等多种功能，满足用户在不同场景下的沟通和协作需求。相比于其他仅具备部分功能的现有技术方案，本申请的综合功能覆盖更全面。2)基于WebRTC技术：本申请采用WebRTC技术作为底层实现，这使得音视频通信更加稳定、高效。WebRTC通过使用UDP和TCP等协议，以及自适应调整和网络传输优化等功能，提供了较低的延迟和更好的网络适应性。3)移动应用平台：本申请的系统可以在智能手机和平板电脑等移动设备上运行。这使得用户能够随时随地进行会议和沟通，增加了灵活性和便利性。4)自适应调整和个性化设置：本申请具备自适应调整功能，根据网络条件动态调整编解码器、分辨率、帧率等参数，以提供最佳的音视频质量和流畅性。同时，用户还可以根据个性化需求，在应用设置中调整传输方式、带宽限制、分辨率等参数，以满足不同用户的特定需求。5)实时直播和录播功能：本申请的app支持实时直播和录播功能，用户可以将会议内容实时直播给其他人观看，或将会议录制下来以便后续回放和分享。这为用户提供了更多的沟通和共享选项。附图说明图1为本申请一种实施方式中所述基于WebRTC技术的云会议音视频传输系统的内部结构关系框图；图2为本申请一种实施方式中所述基于WebRTC技术的云会议音视频传输系统的工作流程图；图3、图3分别为本申请一个实施例中音视频效果对比图。具体实施方式下面结合实施例详述本申请，但本申请并不局限于这些实施例。如图1所示，本申请一种实施方式中所述基于WebRTC技术的云会议音视频传输系统的内部结构关系框图，该系统包括：通信模块、媒体协商模块、网络传输模块。所述通信模块，用于根据用户在终端交互界面上输入的指令，采用WebRTC技术处理音视频流，建立当前用户与其它参与者之间的一对一或多人音视频通信连接；所述媒体协商模块，用于协商通信双方之间的媒体参数，并保持一致；所述网络传输模块，用于对音视频数据进行传输。在一个实施方式中，所述通信模块还包括：点对点音视频通话子模块，用于根据用户选择的网关或SIP方式建立点对点的音视频通话连接，并对音频和视频进行捕获、编解码、传输、播放、渲染。在一种实施方式中，所述通信模块采用的WebRTC的库文件较现有技术进行了优化：修改webrtc源码，增加对OMX.IMG、OMX.hisi的判断处理；修改sdp协商内容。由于WebRTC默认的是采用软解，因此会产生卡顿、花屏的情况。在一个实施例中，WebRTC源码修改方式如下：本申请可有效解决音视频卡顿或花屏问题，尤其是针对华为解码H264格式卡顿。在一种实施方式中，所述通信模块还包括：多人会议子模块，用于提供多人视频会议功能，包括创建会议房间、邀请其他参与者、管理会议。在一种实施方式中，所述多人会议模块可使用Videoroom插件或MCU会议来实现多人视频通信。在一种实施方式中，该系统还包括自适应调整模块，用于根据网络带宽、延迟情况动态调整编解码器、分辨率、帧率等参数，以保证最佳的音视频质量和流畅性。为保证音频质量，尤其是针对于弱网时音频质量不佳问题，本申请的自适应调整模块采用循环调用方式，如每隔一秒调用一次WebRTC提供的peerConnection.getStats方法实时监听audioTrack中的googRtt参数变化，并根据googRtt参数变化做出判断：如果googRtt＞＝300±5，并连续超过3次，则提示关闭当前摄像头；如果googRtt＞100±5，并连续超过3次，则将摄像头分辨率改为当前设备支持最低分辨率，帧率改为15；如果googRtt＜80±5，并连续超过10次，则提示打开摄像头；如果googRtt＜50±5，并连续超过10次，则恢复为用户设置的分辨率；以上判断使用if else方法从上至下顺序，满足任一条件则其他不执行。在一种实施方式中，该系统还包括直播和录播模块，支持将会议内容进行直播和录播，包括流媒体服务器的连接与推送、观看链接的生成与分享、录制内容的存储与回放。所述支持将会议内容进行直播和录播，分别通过Streaming插件和Recordplay插件实现。在一种实施方式中，所述网络传输模块，使用ICE协议来发现最佳的网络路径和进行候选项选择。在一种实施方式中，所述媒体协商模块中用于协商通信双方之间的媒体参数，使其保持一致。所述参数包括但不限于：编解码器、分辨率、帧率。请参见图2，其示出了一种实施方式中上述系统内部的工作流程图。用户交互界面用户在终端启动app应用并登录。用户打开app，并输入登录凭据进行身份验证；应用验证用户身份并加载主界面。点对点音视频通话用户选择点对点音视频通话功能；系统调用设备的音视频捕获功能，如麦克风和摄像头，以获取用户的音频和视频数据；系统通过WebRTC技术建立与另一用户的音视频连接；系统通过编解码器对音视频数据进行编码和解码；解码后的数据在接收端进行播放，实现双方之间的实时音视频通话。多人视频会议。用户选择多人视频会议功能；系统创建一个会议房间，并生成一个唯一的房间ID；系统通过邀请其他参与者，将他们加入会议房间；每个参与者的音视频数据通过WebRTC技术进行传输；系统在接收端将不同参与者的音视频流进行合并和渲染，实现多人视频通话。直播和录播。用户选择直播或录播功能；如果选择直播，系统通过Streaming插件将会议内容实时推送到流媒体服务器；其他用户可以通过观看直播链接来观看会议内容；如果选择录播，系统通过Recordplay插件将会议内容录制下来；录制的内容可以在后续进行回放、分享或存档。自适应调整和个性化设置。系统根据网络条件进行自适应调整，如根据带宽和延迟动态调整编解码器、分辨率和帧率等参数，以优化音视频质量和流畅性。用户可以在系统设置中对传输方式、带宽限制、分辨率等进行个性化设置，以满足特定需求和优化用户体验。图3为利用现有系统进行会议时的截图，会发现出现了卡屏情况，存在延迟，视频流畅性较差。而同样场景下，使用本申请所述的基于WebRTC技术的云会议音视频传输系统进行会议，会议时的视频截图状态如图3所示，不难看出视频质量更优。本申请还提供了一种基于WebRTC技术的云会议音视频传输方法，包括：通信模块在接收到用户从用户界面发起的指令后，建立一对一音视频通话，或创建多人视频会议；媒体协商模块协商通信双方之间的媒体参数，并保持一致；网络传输模块对音视频数据进行传输。在一种实施方式中，对于所述一对一音视频通话，系统根据用户选择的使用网关或SIP方式进行通信，应用会建立音视频连接，并通过WebRTC技术实现音视频传输。在一种实施方式中对于所述多人视频会议，系统根据用户选择的使用Videoroom插件或MCU会议方式建立多人视频会议；其中，所述Videoroom插件通过建立多人视频房间，并邀请其他参与者加入实现多人通信；所述MCU会议通过中央控制单元处理多个参与者之间的音视频流，实现多人视频会议。在一种实施方式中，该方法还包括：自适应调整模块根据网络条件对音视频数据的相关参数进行动态调整。在一种实施方式中，所述动态调整包括：循环调用WebRTC提供的peerConnection.getStats方法实时监听audioTrack中的googRtt参数变化；如果googRtt＞＝300±5，并连续超过3次，则提示关闭当前摄像头；如果googRtt＞100±5，并连续超过3次，则将摄像头分辨率改为当前设备支持最低分辨率，帧率改为15；如果googRtt＜80±5，并连续超过10次，则提示打开摄像头；如果googRtt＜50±5，并连续超过10次，则恢复为用户设置的分辨率；以上判断使用if else方法从上至下顺序，满足任一条件则其他不执行。在一种实施方式中，该方法还包括：直播和录播模块对多人视频会议的会议内容进行直播和录播。在一种实施方式中，所述直播和录播模块通过Streaming插件进行会议内容的实时直播；使用Recordplay插件对会议内容进行录制。本申请的技术方案相比现有技术方案具有更全面的功能覆盖、基于WebRTC技术、移动应用平台、自适应调整和个性化设置以及实时直播和录播功能等优点和有益效果。这些优点和效果使得本申请能够提供更好的音视频通信体验和更广泛的应用场景。以上所述，并非对本申请做任何形式的限制，虽然本申请以较佳实施例揭示如上，然而并非用以限制本申请，任何熟悉本专业的技术人员，在不脱离本申请技术方案的范围内，利用上述揭示的技术内容做出些许的变动或修饰均等同于等效实施案例，均属于技术方案范围内。
