标题title
一种弱口令检测的方法、装置、电子设备及介质
摘要abst
本申请涉及一种弱口令检测的方法、装置、电子设备及介质，涉及数据安全检测的领域，该方法包括获取影子文件接口，根据影子文件接口确定影子文件存储区域；通过影子文件存储区域提取影子文件；将第一密码密文通过字符哈希运算得到唯一哈希值；从预设弱口令字典文件中获取预设弱口令明文数据；提取影子文件中加密数据中的加密算法；将预设弱口令明文数据经过加密算法处理得到第二密码密文集合；将第二密码密文集合进行字符哈希运算得到哈希值集合；将唯一哈希值与哈希值集合进行比对，判断唯一哈希值是否存在于哈希值集合；若唯一哈希值存在于哈希值集合中，则确定用户的密码为弱口令密码。本申请具有提高弱口令检测效率的效果。
权利要求书clms
1.一种弱口令检测方法，其特征在于，包括：检测到用户登录后，获取影子文件接口，根据所述影子文件接口确定所述影子文件存储区域；通过所述影子文件存储区域提取影子文件，所述影子文件包括所述用户的密码对应的加密数据；所述加密数据包括加密算法、密码对应的第一密码密文；将所述第一密码密文通过字符哈希运算得到唯一哈希值；从预设弱口令字典文件中获取预设弱口令明文数据；提取影子文件中所述加密数据中的所述加密算法；将所述预设弱口令明文数据经过所述加密算法处理得到第二密码密文集合；将所述第二密码密文集合进行字符哈希运算得到哈希值集合；将所述唯一哈希值与所述哈希值集合进行比对，判断所述唯一哈希值是否存在于所述哈希值集合；若所述唯一哈希值存在于所述哈希值集合中，则确定所述用户的密码为弱口令密码。2.根据权利要求1所述的方法，其特征在于，所述判断所述唯一哈希值是否存在于所述哈希值集合的步骤之后，还包括：若所述唯一哈希值不存在于所述哈希值集合中，则将所述第一密码密文通过加密算法确定密码明文；将所述密码明文进行字符分割函数提取多段密码字符；通过所述加密算法获取所述多段密码字符的多个第三密码密文；将所述多个第三密码密文进行字符哈希运算得到多个哈希值；将所述多个哈希值与所述哈希值集合进行一一比对，判断所述多个哈希值是否存在于所述哈希值集合，若所述多个哈希值均存在于所述哈希值集合中，则确定用户密码为弱口令密码。3.根据权利要求1所述的方法，其特征在于，所述将所述第二密码密文集合进行字符哈希运算得到哈希值集合的步骤，包括：遍历所述第二密码密文集合，提取第二密码密文集合中包含的每个第二密码密文；针对每一个所述第二密码密文，将所述每个第二密码密文通过字符哈希运算得到哈希值；将所述哈希值存储至哈希值集合。4.根据权利要求3所述的方法，其特征在于，所述将所述每个第二密码密文通过字符哈希运算得到哈希值的步骤，包括：设置第一底数以及第一模数；根据所述第一底数、第一模数以及所述第二密码密文确定第一子数值；设置第二底数以及第二模数；根据所述第二底数、第二模数以及所述第二密码密文确定第二子数值；将所述第一子数值以及第二子数值拼接为待比对字符串；设置第三底数以及第三模数；根据所述第三底数以及第三模数以及所述待比对字符串确定哈希值。5.根据权利要求1所述的方法，其特征在于，所述检测到用户登录后，获取影子文件接口的步骤，包括：获取用户登录国产化系统的登录信息，并通过所述登录信息确定用户是否登录成功；在用户登录成功的情况下，获取国产化系统中用户登录存储文件路径；根据所述用户登录存储文件路径生成影子文件接口。6.根据权利要求1所述的方法，其特征在于，所述将所述唯一哈希值与所述哈希值集合进行比对，判断所述唯一哈希值是否存在于所述哈希值集合的步骤，包括：将所述哈希值集合进行遍历操作，获取子元素哈希值；将所述唯一哈希值与所述子元素哈希值进行比对，若相等，则确定所述唯一哈希值存在于所述哈希值集合；若不相等，则继续将所述哈希值集合进行遍历操作，获取子元素哈希值，将所述唯一哈希值与所述子元素哈希值进行比对，直至确定所述唯一哈希值与所述子元素哈希值相等或者遍历到最后一个子元素哈希值。7.根据权利要求1-6任一项所述的方法，其特征在于，所述确定所述用户的密码为弱口令密码的步骤之后，还包括：生成密码警告信息推送至用户登录界面。8.一种弱口令检测装置，其特征在于，包括：密文采集模块，用于检测到用户登录后，获取影子文件接口，根据所述影子文件接口确定所述影子文件存储区域；所述密文采集模块，还用于通过所述影子文件存储区域提取影子文件，所述影子文件包括所述用户的密码对应的加密数据；所述加密数据包括加密算法、密码对应的第一密码密文；哈希转换模块，用于将所述第一密码密文通过字符哈希运算得到唯一哈希值；所述哈希转换模块，还用于从预设弱口令字典文件中获取预设弱口令明文数据；所述哈希转换模块，还用于提取影子文件中所述加密数据中的所述加密算法；所述哈希转换模块，还用于将所述预设弱口令明文数据经过所述加密算法处理得到第二密码密文集合；所述哈希转换模块，还用于将所述第二密码密文集合进行字符哈希运算得到哈希值集合；决策处理模块，用于将所述唯一哈希值与所述哈希值集合进行比对，判断所述唯一哈希值是否存在于所述哈希值集合；所述决策处理模块，还用于若所述唯一哈希值存在于所述哈希值集合中，则确定所述用户的密码为弱口令密码。9.一种电子设备，其特征在于，包括：存储器和处理器；所述存储器，用于存储程序指令；所述处理器，用于调用并执行所述存储器中的程序指令，执行如权利要求1-7任一项所述的弱口令检测方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有计算机程序；所述计算机程序被处理器执行时，实现如权利要求1-7任一项所述的弱口令检测方法。
说明书desc
技术领域本申请涉及数据安全检测的领域，尤其是涉及一种弱口令检测的方法、装置、电子设备及介质。背景技术随着政府、金融、教育、医疗、制造业、能源等行业越来越多提倡使用国产化设备的办公系统和服务器系统，不论为了维护技术工程人员的开发安全，还是保护企业信息和财产安全，国产化系统的安全防护都日益重要。而弱口令是一种容易被人猜测或者破解的口令，长期以来弱口令一直是各种安全检查和风险评估必需的检测项，并且危害等级较高。一旦弱口令被破解，将给企业带来无法估量的损失，作为系统防护的基本组成部分，加强对弱口令的检测也势在必行。针对弱口令检测，现有技术中一般采取的方式为通过ssh协议模拟登录，但是这种方式需要网络访问，占用带宽，ssh端口必须启用，因而会依赖网络，增加数据收发时间的消耗，导致检测效率不高。因此如何提高弱口令检测效率成为一个问题。发明内容为了能够提高弱口令检测效率，本申请提供一种弱口令检测的方法、装置、电子设备及介质。第一方面，本申请提供一种弱口令检测的方法，采用如下的技术方案：一种弱口令检测的方法，包括：检测到用户登录后，获取影子文件接口，根据所述影子文件接口确定所述影子文件存储区域；通过所述影子文件存储区域提取影子文件，所述影子文件包括所述用户的密码对应的加密数据；所述加密数据包括加密算法、密码对应的第一密码密文；将所述第一密码密文通过字符哈希运算得到唯一哈希值；从预设弱口令字典文件中获取预设弱口令明文数据；提取影子文件中所述加密数据中的所述加密算法；将所述预设弱口令明文数据经过所述加密算法处理得到第二密码密文集合；将所述第二密码密文集合进行字符哈希运算得到哈希值集合；将所述唯一哈希值与所述哈希值集合进行比对，判断所述唯一哈希值是否存在于所述哈希值集合；若所述唯一哈希值存在于所述哈希值集合中，则确定所述用户的密码为弱口令密码。通过采用上述技术方案，得到影子文件接口，用以定位影子文件的存储区域，在确定影子文件存储区域后进行提取，采集影子文件数据，影子文件的数据中已经包括了用户对应的加密数据，而加密数据中包括了加密算法和第一密码密文，第一密码密文用于后续与弱口令字典里的密文进行比对，加密算法作为密文的加密方式是用于还原明文数据。之后将第一密码密文通过散列算法中的字符哈希公式转换为唯一哈希值，直接以哈希值进行比较，减少字符比较增加的资源消耗时间。同时弱口令字典中存储了明文数据，在把获取到的多个明文数据通过影子文件中加密数据中的加密算法进行加密得到多个第二密码密文，也就是第二密码密文的集合，同时将多个第二密码密文的集合遍历进行字符哈希运算，从而获得哈希值集合，由于之前获得了第一密码密文转换后的唯一哈希值，因此得到的哈希值集合就可以用来与唯一哈希值进行比对，这个过程中由于已将第一密码密文经过字符哈希转换得到了唯一哈希值，只需要进行哈希值数值的比较，大大减少算法的时间复杂度。在比对结束后如果唯一哈希值存在于哈希值集合中，则认为密码属于弱口令密码，通过上述方式，从本地影子文件中直接提取第一密码密文并进行哈希转换，同时将弱口令中的第二密码密文进行哈希转换，将转换后的哈希值进行对比，不进行网络访问，占用带宽，从而减少数据收发时间的消耗，从而达到提高弱口令检测效率的效果。可选的，所述判断所述唯一哈希值是否存在于所述哈希值集合的步骤之后，还包括：若所述唯一哈希值不存在于所述哈希值集合中，则将所述第一密码密文通过加密算法确定密码明文；将所述密码明文进行字符分割函数提取多段密码字符；通过所述加密算法获取所述多段密码字符的多个第三密码密文；将所述多个第三密码密文进行字符哈希运算得到多个哈希值；将所述多个哈希值与所述哈希值集合进行一一比对，判断所述多个哈希值是否存在于所述哈希值集合，若所述多个哈希值均存在于所述哈希值集合中，则确定用户密码为弱口令密码。通过采用上述技术方案，可理解的是，由于用户密码即使不存在于弱口令集合中，也会有比较容易被破解的部分密码特征存在于弱口令集合，因此在唯一哈希值不存在于哈希值集合时，即用户密码不属于弱口令字典里的密码时，通过提取影子文件中加密数据的加密算法，从而能够通过加密算法将第一密码密文还原为用户密码，再将用户密码通过提取得到多段子密码，子密码加密得到多个第三密码密文，再进行字符哈希转换确定多个哈希值，以便于将多个哈希值与哈希值集合进行比对，确认是否存在于弱口令字典中。如果同时存在于弱口令字典中，证明用户密码的密码强度也不高。也就是说即使用户的完整密码不存在于用户的弱口令字典中，但是由于通过上述方式检测到用户密码的拆分的部分密码特征同时属于弱口令字典中的数据，能认定用户密码是容易被破解的，也将这种密码认为是弱口令，进而对用户进行警示提醒，保证弱口令检测的完整性。可选的，所述将所述第二密码密文集合进行字符哈希运算得到哈希值集合的步骤，包括：遍历所述第二密码密文集合，提取第二密码密文集合中包含的每个第二密码密文；针对每一个所述第二密码密文，将所述每个第二密码密文通过字符哈希运算得到哈希值；将所述哈希值存储至哈希值集合。通过采用上述技术方案，将第二密码密文集合中的每个第二密码密文都进行字符哈希转换得到哈希值，由于哈希函数不可逆，因此将密文转换为哈希值可以保证密文的机密性，同时将所有哈希值存储至哈希值集合，方便在后续步骤中将每个哈希值与唯一哈希值进行比对，从而减少数据存储空间和传输时间。可选的，所述将所述每个第二密码密文通过字符哈希运算得到哈希值的步骤，包括：设置第一底数以及第一模数；根据所述第一底数、第一模数以及所述第二密码密文确定第一子数值；设置第二底数以及第二模数；根据所述第二底数、第二模数以及所述第二密码密文确定第二子数值；将所述第一子数值以及第二子数值拼接为待比对字符串；设置第三底数以及第三模数；根据所述第三底数以及第三模数以及所述待比对字符串确定哈希值。通过采用上述技术方案，经过两次字符哈希转换得到第一子数值和第二子数值，这两个子数值均为哈希值，这是因为在实际字符哈希转换中可能会出现两个不同的密文转换成为了同一个哈希值的情况，这种情况就是哈希比对冲突，因此设置两个不同底数和模数对同一个密文得到两个哈希值，再将同一个密文中的两个哈希值继续拼接成为一个字符串，再进行一次字符哈希转换得到最终的哈希值。经过上述方式得到哈希值，能减少哈希比对冲突出现的情况，进而提高弱口令检测中的准确性。可选的，所述检测到用户登录后，获取影子文件接口的步骤，包括：获取用户登录国产化系统的登录信息，并通过所述登录信息确定用户是否登录成功；在用户登录成功的情况下，获取国产化系统中用户登录存储文件路径；根据所述用户登录存储文件路径生成影子文件接口。通过采用上述技术方案，获取用户登录信息，这个过程可以通过页面表单或 API接口进行。在登录成功的情况下才可以获取用户登录存储文件路径，而用户登录存储文件用来管理用户的访问控制和操作权限，因此通过用户登录存储文件路径生成影子文件接口的过程，可以提高系统的安全性和可靠性，从而能够避免用户信息泄露的情况发生。可选的，所述将所述唯一哈希值与所述哈希值集合进行比对，判断所述唯一哈希值是否存在于所述哈希值集合的步骤，包括：将所述哈希值集合进行遍历操作，获取子元素哈希值；将所述唯一哈希值与所述子元素哈希值进行比对，若相等，则确定所述唯一哈希值存在于所述哈希值集合；若不相等，则继续将所述哈希值集合进行遍历操作，获取子元素哈希值，将所述唯一哈希值与所述子元素哈希值进行比对，直至确定所述唯一哈希值与所述子元素哈希值相等或者遍历到最后一个子元素哈希值。通过采用上述技术方案，可以实现对哈希值集合中是否存在指定唯一哈希值的验证，进而快速查找唯一哈希值，从而提高弱口令的检测效率。可选的，所述确定所述用户的密码为弱口令密码的步骤之后，还包括：生成密码警告信息推送至用户登录界面。通过采用上述技术方案，在确定用户的密码为弱口令密码，说明当前的用户密码强度不高，生成密码警告信息推送至用户登录界，也就是说用户输入了密码，检测到当前密码为弱口令，对用户进行警示，及时地发现用户密码的潜在风险，进而对用户进行提醒，从而提高用户对系统的信任，并帮助用户改善密码，提高系统的安全性。第二方面，本申请提供一种弱口令检测的装置，采用如下的技术方案：一种弱口令检测的装置，包括：密文采集模块，用于检测到用户登录后，获取影子文件接口，根据所述影子文件接口确定所述影子文件存储区域；所述密文采集模块，还用于通过所述影子文件存储区域提取影子文件，所述影子文件包括所述用户的密码对应的加密数据；所述加密数据包括加密算法、密码对应的第一密码密文；哈希转换模块，用于将所述第一密码密文通过字符哈希运算得到唯一哈希值；所述哈希转换模块，还用于从预设弱口令字典文件中获取预设弱口令明文数据；所述哈希转换模块，还用于提取影子文件中所述加密数据中的所述加密算法；所述哈希转换模块，还用于将所述预设弱口令明文数据经过所述加密算法处理得到第二密码密文集合；所述哈希转换模块，还用于将所述第二密码密文集合进行字符哈希运算得到哈希值集合；决策处理模块，用于将所述唯一哈希值与所述哈希值集合进行比对，判断所述唯一哈希值是否存在于所述哈希值集合；所述决策处理模块，还用于若所述唯一哈希值存在于所述哈希值集合中，则确定所述用户的密码为弱口令密码。可选的，所述装置还包括第二检测模块，用于：若所述唯一哈希值不存在于所述哈希值集合中，则将所述第一密码密文通过加密算法确定密码明文；将所述密码明文进行字符分割函数提取多段密码字符；通过所述加密算法获取所述多段密码字符的多个第三密码密文；将所述多个第三密码密文进行字符哈希运算得到多个哈希值；将所述多个哈希值与所述哈希值集合进行一一比对，判断所述多个哈希值是否存在于所述哈希值集合，若所述多个哈希值均存在于所述哈希值集合中，则确定用户密码为弱口令密码。可选的，所述哈希转换模块在将所述第二密码密文集合进行字符哈希运算得到哈希值集合时，具体用于：遍历所述第二密码密文集合，提取第二密码密文集合中包含的每个第二密码密文；针对每一个所述第二密码密文，将所述每个第二密码密文通过字符哈希运算得到哈希值；将所述哈希值存储至哈希值集合。可选的，所述哈希转换模块在所述每个第二密码密文通过字符哈希运算得到哈希值时，具体用于：设置第一底数以及第一模数；根据所述第一底数、第一模数以及所述第二密码密文确定第一子数值；设置第二底数以及第二模数；根据所述第二底数、第二模数以及所述第二密码密文确定第二子数值；将所述第一子数值以及第二子数值拼接为待比对字符串；设置第三底数以及第三模数；根据所述第三底数以及第三模数以及所述待比对字符串确定哈希值。可选的，所述密文采集模块在检测到用户登录后，获取影子文件接口时，具体用于：获取用户登录国产化系统的登录信息，并通过所述登录信息确定用户是否登录成功；在用户登录成功的情况下，获取国产化系统中用户登录存储文件路径；根据所述用户登录存储文件路径生成影子文件接口。可选的，所述决策处理模块在将所述唯一哈希值与所述哈希值集合进行比对，判断所述唯一哈希值是否存在于所述哈希值集合时，具体用于：将所述哈希值集合进行遍历操作，获取子元素哈希值；将所述唯一哈希值与所述子元素哈希值进行比对，若相等，则确定所述唯一哈希值存在于所述哈希值集合；若不相等，则继续将所述哈希值集合进行遍历操作，获取子元素哈希值，将所述唯一哈希值与所述子元素哈希值进行比对，直至确定所述唯一哈希值与所述子元素哈希值相等或者遍历到最后一个子元素哈希值。可选的，所述装置还包括警告推送模块，用于：生成密码警告信息推送至用户登录界面。第三方面，本申请提供一种电子设备，采用如下的技术方案：一种电子设备，该电子设备包括：存储器，用于存储程序指令；处理器，用于调用并执行所述存储器中的程序指令，执行根据第一方面任一种可能的实现方式所示的弱口令检测方法。第四方面，本申请提供一种计算机可读存储介质，采用如下的技术方案：所述计算机可读存储介质中存储有计算机程序；所述计算机程序被处理器执行时，执行第一方面任一项所述的弱口令检测方法。综上所述，本申请包括以下至少一种有益技术效果：将第一密码密文通过散列算法中的字符哈希公式转换为唯一哈希值，直接以哈希值进行比较，减少字符比较增加的资源消耗时间；弱口令字典中存储了明文数据，在把获取到的多个明文数据通过影子文件中加密数据中的加密算法进行加密得到多个第二密码密文，也就是第二密码密文的集合，同时将多个第二密码密文的集合遍历进行字符哈希运算，从而获得哈希值集合，由于之前获得了第一密码密文转换后的唯一哈希值，因此得到的哈希值集合就可以用来与唯一哈希值进行比对，这个过程中由于已将第一密码密文经过字符哈希转换得到了唯一哈希值，只需要进行哈希值数值的比较，大大减少算法的时间复杂度；在比对结束后如果唯一哈希值存在于哈希值集合中，则认为密码属于弱口令密码，通过上述方式，从本地影子文件中直接提取第一密码密文并进行哈希转换，同时将弱口令中的第二密码密文进行哈希转换，将转换后的哈希值进行对比，不进行网络访问，占用带宽，从而减少数据收发时间的消耗，从而达到提高弱口令检测效率的效果；在唯一哈希值不存在于哈希值集合时，即用户密码不属于弱口令字典里的密码时，通过提取影子文件中加密数据的加密算法，从而能够通过加密算法将第一密码密文还原为用户密码，再将用户密码通过提取得到多段子密码，子密码加密得到多个第三密码密文，再进行字符哈希转换确定多个哈希值，以便于将多个哈希值与哈希值集合进行比对，确认是否存在于弱口令字典中。如果同时存在于弱口令字典中，证明用户密码的密码强度也不高。也就是说即使用户的完整密码不存在于用户的弱口令字典中，但是由于通过上述方式检测到用户密码的拆分的部分密码特征同时属于弱口令字典中的数据，能认定用户密码是容易被破解的，也将这种密码认为是弱口令，进而对用户进行警示提醒，保证弱口令检测的完整性。附图说明图1是本申请实施例的一种弱口令检测的方法的流程示意图。图2是本申请实施例的一种弱口令检测的方法的功能结构图。图3是本申请实施例的一种弱口令检测的方法的采集功能流程图。图4是本申请实施例的一种弱口令检测的方法的决策功能流程图。图5是本申请实施例的一种弱口令检测的装置的结构示意图。图6是本申请实施例的一种电子设备的结构示意图。具体实施方式以下结合附图1-6对本申请作进一步详细说明。本领域技术人员在阅读完本说明书后可以根据需要对本实施例做出没有创造性贡献的修改，但只要在本申请的范围内都受到专利法的保护。为使本申请实施例的目的、技术方案和优点更加清楚，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。另外，本文中术语“和/或”，仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。另外，本文中字符“/”，如无特殊说明，一般表示前后关联对象是一种“或”的关系。下面结合说明书附图对本申请实施例作进一步详细描述。本申请实施例提供了一种弱口令检测的方法，如图1所示，该方法包括步骤S101-S109；其中：步骤S101，检测到用户登录后，获取影子文件接口，根据影子文件接口确定影子文件存储区域。对于本申请实施例，影子文件接口指的是获取影子文件存储区域并能进行影子文件提取的接口，获取影子文件接口主要用于保护和提取用户数据。影子文件存储区域指的是包含所有影子文件元数据的存储区域。可以理解的是，在用户登录的情况下，用户登录的信息才会被存储到设备中，才能在后续步骤中确定影子文件存储区域。进一步的，检测到用户登录后，获取影子文件接口，包括：获取用户登录国产化系统的登录信息，并通过登录信息确定用户是否登录成功；在用户登录成功的情况下，获取国产化系统中用户登录存储文件路径；根据用户登录存储文件路径生成影子文件接口。对于本申请实施例，用户登录信息指的是用户在登录系统时提供的身份验证信息，用户登录信息用以确定用户身份并授权访问系统资源。用户登录存储文件路径指的是用户被成功授权访问系统资源后，用户登录信息被加密存储的位置对应的路径。可以理解的是，设备在检测到用户登录信息已经被确定用户身份并授权访问系统资源的情况下，国产化系统中用户的登录存储文件已经生成，根据用户登录存储文件路径再确定影子文件接口。例如：设备可以是台式电脑，用户在配置有国产化系统的台式电脑进行登录操作，在用户登录系统成功后，电脑设备获取国产化系统中用户登录存储文件路径“/etc/shadow/file”，通过os.path.join方法生成影子文件接口。上述步骤生成的影子文件接口可以实现后续步骤中提取影子文件的需求。步骤S102，通过影子文件存储区域提取影子文件。对于本申请实施例，影子文件指的是在国产化系统上存储加密用户密码的文件，影子文件包括用户的密码对应的加密数据；加密数据包括加密算法、密码对应的第一密码密文；其中，第一密码密文指的是用户密码明文加密后的用户密码密文，加密算法指的是从用户密码明文得到用户密码密文的对应算法。具体的，以步骤S101中的例子继续进行说明，在生成影子文件接口后，通过接口确定影子文件存储区域，而影子文件存储区域中包含影子文件，每个影子文件后缀带有对应用户登录时间的时间戳，而提取影子文件前先确定目标影子文件的时间戳，再对目标影子文件进行提取。步骤S103，将第一密码密文通过字符哈希运算得到唯一哈希值。对于本申请实施例，字符哈希运算指的是可以将任意长度的消息压缩到固定长度的函数算法，本质就是采用字符哈希公式将密文字符串转换为哈希值，其中字符哈希公式指的是一种将字符串转换为数字的公式。在本申请实施例中，采用字符哈希公式将一定长度的密文字符串转换为固定长度的数值。例如，获取到字符串为“abcdef”，通过如下公式获取唯一哈希值：；其中P为底数，Q为模数，hash为最终转换得到的固定长度的数值。需要说明的是，上述公式为字符哈希公式的实现方式，而在本申请中将第一密码密文通过字符哈希运算得到唯一哈希值与将第二密码密文集合进行字符哈希运算得到哈希值集合中的字符哈希运算方式相同。步骤S104，从预设弱口令字典文件中获取预设弱口令明文数据。对于本申请实施例，预设弱口令字典文件指的是包含常见、简单、易猜测的密码的集合的文本文件，常见的弱口令包括日常单词，数字序列，常见人名，日期等，本申请实施例对此不作限制。明文数据指的是存储在弱口令字典文件中的未经过加密或隐藏处理的原始密码数据。步骤S105，提取影子文件中加密数据中的加密算法。对于本申请实施例，可以理解的是，在上述步骤中已经得到了加密数据，而加密数据中又存储加密算法和对应加密后的密文，若在后续步骤中进行与弱口令字典中的密文比对，则需要将弱口令字典中的明文数据也进行相同加密算法的处理得到密文，因此提取加密数据中的加密算法以便于后续进行弱口令字典密文的加密。步骤S106，将预设弱口令明文数据经过加密算法处理得到第二密码密文集合。对于本申请实施例，加密算法中包含了用于加密的密钥，密钥只有发送方和接收方才能明确。在上述步骤中得到弱口令字典中的明文数据，弱口令中包含多个明文数据，因此将每个明文数据都经过加密算法中密钥处理得到最终的密文集合，即将明文数据按照加密算法中密钥特定的格式进行编码和填充，得到多个第二密码密文，生成第二密码密文集合。步骤S107，将第二密码密文集合进行字符哈希运算得到哈希值集合。对于本申请实施例，字符哈希运算处理指的是根据上述步骤中说明的散列算法中的字符哈希公式对第二密码密文集合进行处理。具体的，将第二密码密文集合中的每个密码密文依次进行字符哈希运算，即将每个密码密文转化为字节数组，然后将字节数组输入到字符哈希算法中，得到相应的哈希值，将得到的哈希值集合作为输出结果。步骤S108，将唯一哈希值与哈希值集合进行比对，判断唯一哈希值是否存在于哈希值集合。对于本申请实施例，先遍历哈希值集合，依次取出每个哈希值，将取出的哈希值与唯一哈希值进行比对，看是否相等，这个过程可以使用字符串比对函数来实现，如果唯一哈希值与某个哈希值相等，则说明唯一哈希值存在于哈希值集合中。进一步的，唯一哈希值与哈希值集合进行比对，判断唯一哈希值是否存在于哈希值集合的步骤，包括：将哈希值集合进行遍历操作，获取子元素哈希值；将唯一哈希值与子元素哈希值进行比对，若相等，则确定唯一哈希值存在于哈希值集合；若不相等，则继续将哈希值集合进行遍历操作，获取子元素哈希值，将唯一哈希值与子元素哈希值进行比对，直至确定唯一哈希值与子元素哈希值相等或者遍历到最后一个子元素哈希值。对于本申请实施例，例如：首先可以创建循环，遍历哈希值集合中的所有子元素。在每次循环中，获取当前子元素的哈希值。将唯一哈希值 hash01 与当前子元素的哈希值hash02进行比对，如果相等，表示唯一哈希值存在于哈希值集合中。步骤S109，若唯一哈希值存在于哈希值集合中，则确定用户的密码为弱口令密码。对于本申请实施例，可以理解为，唯一哈希值存在于哈希值集合，证明第一密码密文与第二密码密文集合中的某个集合相同，进而说明用户的密码符合弱口令的规则，因此认定用户密码为弱口令密码。进一步的确定用户的密码为弱口令密码的步骤之后，还包括：生成密码警告信息推送至用户登录界面。对于本申请实施例，可以理解为如果用户密码为弱口令，需要进行警告提示，如果唯一哈希值不存在于哈希值集合中，则说明用户密码强度较高，可以放心使用该密码。为了提醒用户密码保护强度不高，在用户登录界面添加一个弹窗提示，提示用户密码存在风险建议用户修改密码。在一些实施例中，上述方法判断唯一哈希值是否存在于哈希值集合的步骤之后，还可以包括：若唯一哈希值不存在于哈希值集合中，则将第一密码密文通过加密算法确定密码明文；将密码明文进行字符分割函数提取多段密码字符；通过加密算法获取多段密码字符的多个第三密码密文；将多个第三密码密文进行字符哈希运算得到多个哈希值；将多个哈希值与哈希值集合进行一一比对，判断多个哈希值是否存在于哈希值集合，若多个哈希值均存在于哈希值集合中，则确定用户密码为弱口令密码。对于本申请实施例，字符分割函数指的是将一个字符串按照指定的分隔符进行分割，并返回一个由分割后的子字符串组成的列表或数组的函数。可以理解的是，在确定唯一哈希值不存在于哈希值集合的情况下，并不能确定用户密码的强度足够高，由于用户密码可以是由一些简单的密码特征构成的，而这些简单的密码特征属于弱口令字典中的范围，因此在用户密码的多个特征部分均属于弱口令字典里的情况下，认定此用户密码也为弱口令密码。具体的，使用字符分割函数对密码明文进行分割，得到多段密码字符，使用对应的加密算法对每个密码字符进行加密，得到多个第三密码密文，通过这个步骤实现对密码特征进行提取。同样使用散列算法中的字符哈希公式对每个第三密码密文进行哈希运算，得到多个哈希值。遍历多个哈希值，将每个哈希值与哈希值集合中的每个哈希值进行比对，判断是否存在相同的哈希值。如果所有哈希值都存在于哈希值集合中，则认定用户密码为弱口令密码。例如：将“abc123”分割得到“abc”和“123”使用算法对两个数据进行加密得到两个第三密码密文，将两个第三密码密文进行加密得到多个哈希值100和101，再获取到弱口令字典转换的哈希值集合，经过遍历查找后确认100和101均存在于弱口令集合中，因此用户密码保护强度不高，也认定其为弱口令密码。上述两种哈希值比较的方式中，均是针对密码中的字符加密得到的哈希值。哈希值的大小直接体现密码字符与预设弱口令字符的一致性。这样，弱口令的检测结果会比较依赖于预设弱口令集合的数据量。预设弱口令越多越全面，就有越高的概率存在与用户的密码一致的弱口令。但是，弱口令的数量繁多，难以枚举，导致前述方式检测准确性受到限制。并且，预设弱口令数量增多后，在一定程度上也会加大检测过程中比较的数据量。因此，在另一些实现方式中，还可以针对密码中的特征进行加密后确定哈希值，以此哈希值进行比较，只要密码中的特征与预设弱口令的特征一致，则会表现为哈希值相同。这样，弱口令检测结果的准确性可以得到进一步的提升。具体的，可以利用深度学习模型进行特征提取。例如，选取部分预设弱口令作为样本，输入构建好的深度学习模型中，进行特征提取，并将提取到的特征作为结果输出，如此进行模型训练。可以理解的是，作为输入和输出的都是向量。通过一定的对应方式，可以将向量转化为对应的字符。这样，经过训练好的深度学习模型，可以对用户的密码、预设弱口令进行特征提取，提取到的特征可以被表征为字符，从而可以进行加密、哈希运算等进一步的处理，最终得到哈希值，用于比较确定用户的密码是否属于弱口令。在一些实施例中，上述方法将第一密码密文通过字符哈希运算得到唯一哈希值的步骤，还可以包括：将第一密码密文通过加密算法确定密码明文；将密码明文输入训练后的卷积神经网络模型得到密码特征向量；将密码特征向量经过哈希运算转换为具有密码特征的唯一哈希值。在一些实施例中，上述方法将第二密码密文集合进行字符哈希运算得到哈希值集合的步骤，还可以包括：将第二密码密文集合转换为弱口令密码明文；将弱口令密码明文输入训练后的卷积神经网络模型得到弱口令特征向量集合；将弱口令特征向量集合经过哈希运算转换为具有弱口令特征的哈希值集合。对于本申请实施例，密码特征向量指的是对用户密码明文通过训练后的卷积神经网络模型识别后得到的数值合成的向量。弱口令特征向量集合指的是将弱口令集合的每个数据通过卷积神经网络模型识别得到的数值合成的向量。具体的，本申请实施例中的卷积网络模型可以是LeNet-5、VGGNet、GoogLeNet等，本申请对此不作限制。将用户密码明文输入训练后的卷积神经网络模型，得到此用户密码明文的特征向量，以相同的识别方式得到弱口令特征向量集合，分别进行哈希运算得到具有密码特征的唯一哈希值和具有弱口令特征的哈希值集合，这里的哈希运算方式可以是LSH、SIMHash等，本申请对此不作限制。判断具有密码特征的唯一哈希值是否存在于具有弱口令特征的哈希值集合中，若具有密码特征的唯一哈希值存在于具有弱口令特征的哈希值集合中，则确认用户密码为弱口令密码。在一些实施例中，上述方法将第二密码密文集合进行字符哈希运算得到哈希值集合的步骤，具体包括：遍历第二密码密文集合，提取第二密码密文集合中包含的每个第二密码密文；针对每一个第二密码密文，将每个第二密码密文通过字符哈希运算得到哈希值；将哈希值存储至哈希值集合。对于本申请实施例，可以理解为将第二密码密文全部转换成哈希值并存储为哈希值集合的过程，提取每个密文内容并将其进行字符哈希转换，得到多个哈希值，然后存储至哈希值集合。具体的，使用循环遍历第二密码密文集合，依次取出每个密码密文，将取出的密码密文进行字符哈希公式转换得到多个固定长度的数值并进行存储。进一步的，将每个第二密码密文通过字符哈希运算得到哈希值的步骤，包括：设置第一底数以及第一模数；根据第一底数、第一模数以及第二密码密文确定第一子数值；设置第二底数以及第二模数；根据第二底数、第二模数以及第二密码密文确定第二子数值；将第一子数值以及第二子数值拼接为待比对字符串；设置第三底数以及第三模数；根据第三底数以及第三模数以及待比对字符串确定哈希值。对于本申请实施例，可以理解为，将哈希算法进行优化，在进行哈希转换时，通过两次字符哈希运算，确定两个数值，再将两个数值拼接为同一个字符串再次进行哈希运算得到最终的哈希值，这是由于在实现哈希值集合的比对时，为了避免哈希冲突，需要选择优化哈希算法，这种方式可以减少哈希比对冲突，从而提高效率。例如：获取到一串字符为“abcdef”，设置第一底数为37，第一模数为2147483647，设置第二底数为31，第二模数为8388607，通过两次字符哈希转换得到两个哈希值分别为143、97，再将两个数字拼接成新的字符串“14397”再通过第三底数17和第三模数51796451进行运算得到最终的哈希值为49。这种方式得到的哈希值更加精准在进行哈希比对的时候能减少冲突。在一些实施例中，参照图2，图2为本申请方法的功能结构图。具体包括：字典维护模块，用于读取本地存储弱口令字典到内存队列，方便快速比对查找。决策模块，用于比对排查当前用户口令是否弱口令字典内的数据，如果是则及时通知用户并产生相应告警信息。采集模块用于获取当前系统的用户信息及影子文件存储的对应密码密文信息。弱口令字典，用于文件形式存储的弱口令集合。图中还包括交互路径1、交互路径2以及交互路径3。其中交互路径1用于字典维护模块读取本地弱口令字典文件，并序列化到内存。交互路径2，用于决策模块判定当前用户信息是否为弱口令字典内信息。交互路径3，用于定时采集当前用户账号及密码信息，并推送给决策模块决策。在一些实施例中，参照图3，图3 为本申请方法的采集功能流程图。上述方法具体还可以包括：获取当前国产化系统所有用户名称信息。获取每个用户的登录信息，如果该用户的登录获取成功，则进入密码获取阶段。获取影子文件中用户对应的密码密文信息。获取成功则将用户及对应密码信息存储并推送给决策模块。在一些实施例中，参照图4，图4为本申请方法的决策功能流程图。上述方法具体还可以包括：读取内存中已序列化的弱口令字典明文数据。获取检测用户的密钥，并使用密钥对弱口令字典的明文数据加密得到密文字符串。判断从影子文件获取到的密码密文是否同弱口令字典加密后的字符串相同。如果是弱口令则产生告警并通知用户。上述实施例从方法流程的角度介绍一种弱口令检测的方法，下述实施例从虚拟模块或者虚拟单元的角度介绍了一种弱口令检测的装置20，具体详见下述实施例。本申请实施例提供一种弱口令检测的装置20，如图5所示，该弱口令检测的装置20具体可以包括：密文采集模块201，用于检测到用户登录后，获取影子文件接口，根据影子文件接口确定影子文件存储区域；密文采集模块201，还用于通过影子文件存储区域提取影子文件，影子文件包括用户的密码对应的加密数据；加密数据包括加密算法、密码对应的第一密码密文；哈希转换模块202，用于将第一密码密文通过字符哈希运算得到唯一哈希值；哈希转换模块202，还用于从预设弱口令字典文件中获取预设弱口令明文数据；哈希转换模块202，还用于提取影子文件中加密数据中的加密算法；哈希转换模块202，还用于将预设弱口令明文数据经过加密算法处理得到第二密码密文集合；哈希转换模块202，还用于将第二密码密文集合进行字符哈希运算得到哈希值集合；决策处理模块203，用于将唯一哈希值与哈希值集合进行比对，判断唯一哈希值是否存在于哈希值集合；决策处理模块203，还用于若唯一哈希值存在于哈希值集合中，则确定用户的密码为弱口令密码。通过采用上述技术方案，得到影子文件接口，用以定位影子文件的存储区域，在确定影子文件存储区域后进行提取，采集影子文件数据，影子文件的数据中已经包括了用户对应的加密数据，而加密数据中包括了加密算法和第一密码密文，第一密码密文用于后续与弱口令字典里的密文进行比对，加密算法作为密文的加密方式是用于还原明文数据。之后将第一密码密文通过散列算法中的字符哈希公式转换为唯一哈希值，直接以哈希值进行比较，减少字符比较增加的资源消耗时间。同时弱口令字典中存储了明文数据，在把获取到的多个明文数据通过影子文件中加密数据中的加密算法进行加密得到多个第二密码密文，也就是第二密码密文的集合，同时将多个第二密码密文的集合遍历进行字符哈希运算，从而获得哈希值集合，由于之前获得了第一密码密文转换后的唯一哈希值，因此得到的哈希值集合就可以用来与唯一哈希值进行比对，这个过程中由于已将第一密码密文经过字符哈希转换得到了唯一哈希值，只需要进行哈希值数值的比较，大大减少算法的时间复杂度。在比对结束后如果唯一哈希值存在于哈希值集合中，则认为密码属于弱口令密码，通过上述方式，从本地影子文件中直接提取第一密码密文并进行哈希转换，同时将弱口令中的第二密码密文进行哈希转换，将转换后的哈希值进行对比，不进行网络访问，占用带宽，从而减少数据收发时间的消耗，从而达到提高弱口令检测效率的效果。可选的，装置还包括第二检测模块，用于：若唯一哈希值不存在于哈希值集合中，则将第一密码密文通过加密算法确定密码明文；将密码明文进行字符分割函数提取多段密码字符；通过加密算法获取多段密码字符的多个第三密码密文；将多个第三密码密文进行字符哈希运算得到多个哈希值；将多个哈希值与哈希值集合进行一一比对，判断多个哈希值是否存在于哈希值集合，若多个哈希值均存在于哈希值集合中，则确定用户密码为弱口令密码。可选的，哈希转换模块202在将第二密码密文集合进行字符哈希运算得到哈希值集合时，具体用于：遍历第二密码密文集合，提取第二密码密文集合中包含的每个第二密码密文；针对每一个第二密码密文，将每个第二密码密文通过字符哈希运算得到哈希值；将哈希值存储至哈希值集合。可选的，哈希转换模块202在每个第二密码密文通过字符哈希运算得到哈希值时，具体用于：设置第一底数以及第一模数；根据第一底数、第一模数以及第二密码密文确定第一子数值；设置第二底数以及第二模数；根据第二底数、第二模数以及第二密码密文确定第二子数值；将第一子数值以及第二子数值拼接为待比对字符串；设置第三底数以及第三模数；根据第三底数以及第三模数以及待比对字符串确定哈希值。可选的，密文采集模块201在检测到用户登录后，获取影子文件接口时，具体用于：获取用户登录国产化系统的登录信息，并通过登录信息确定用户是否登录成功；在用户登录成功的情况下，获取国产化系统中用户登录存储文件路径；根据用户登录存储文件路径生成影子文件接口。可选的，决策处理模块203在将唯一哈希值与哈希值集合进行比对，判断唯一哈希值是否存在于哈希值集合时，具体用于：将哈希值集合进行遍历操作，获取子元素哈希值；将唯一哈希值与子元素哈希值进行比对，若相等，则确定唯一哈希值存在于哈希值集合；若不相等，则继续将所述哈希值集合进行遍历操作，获取子元素哈希值，将所述唯一哈希值与所述子元素哈希值进行比对，直至确定所述唯一哈希值与所述子元素哈希值相等或者遍历到最后一个子元素哈希值。可选的，装置还包括警告推送模块，用于：生成密码警告信息推送至用户登录界面。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。本申请实施例中提供了一种电子设备30，如图6所示，图6所示的电子设备30包括：处理器301和存储器303。其中，处理器301和存储器303相连，如通过总线302相连。可选地，电子设备30还可以包括收发器304。需要说明的是，实际应用中收发器304不限于一个，该电子设备30的结构并不构成对本申请实施例的限定。处理器301可以是CPU，通用处理器，DSP，ASIC，FPGA或者其他可编程逻辑器件、晶体管逻辑器件、硬件部件或者其任意组合。其可以实现或执行结合本申请公开内容所描述的各种示例性的逻辑方框，模块和电路。处理器301也可以是实现计算功能的组合，例如包含至少一个微处理器组合，DSP和微处理器的组合等。总线302可包括一通路，在上述组件之间传送信息。总线302可以是PCI总线或EISA总线等。总线302可以分为地址总线、数据总线、控制总线等。为便于表示，图6中仅用一条粗线表示，但并不表示仅有一根总线或一型的总线。存储器303可以是ROM或可存储静态信息和指令的其他类型的静态存储设备，RAM或者可存储信息和指令的其他类型的动态存储设备，也可以是EEPROM、CD-ROM或其他光盘存储、光碟存储、磁盘存储介质或者其他磁存储设备、或者能够用于携带或存储具有指令或数据结构形式的期望的程序代码并能够由计算机存取的任何其他介质，但不限于此。存储器303用于存储执行本申请方案的应用程序代码，并由处理器301来控制执行。处理器301用于执行存储器303中存储的应用程序代码，以实现前述方法实施例所示的内容。其中，电子设备包括但不限于：移动电话、笔记本电脑、数字广播接收器、PDA、PAD、PMP、车载终端等等的移动终端以及诸如数字TV、台式计算机等等的固定终端。还可以为服务器等。图6示出的电子设备仅仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。应该理解的是，虽然附图的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，其可以以其他的顺序执行。而且，附图的流程图中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，其执行顺序也不必然是依次进行，而是可以与其他步骤或者其他步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。以上仅是本申请的部分实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本申请原理的前提下，还可以做出若干改进和润饰，这些改进和润饰也应视为本申请的保护范围。
