标题title
一种工商业园区光储充微电网的控制策略优化方法及系统
摘要abst
本发明公开了一种工商业园区光储充微电网的控制策略优化方法及系统，包括，获取目标工商业园区的历史光伏发电输出，筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型；通过出力预测指标及出力预测模型预测目标工商业园区的光伏出力数据；获取预设时间内目标工商业园区中用户的多源充电数据，分析用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；根据光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据最优解对当前时段的充电进行调度。本发明提高了光伏系统及储能系统的利用率，提升预测精度并优化运营成本，有效降低了微电网的系统综合运行成本保证光储充微电网运行更加合理稳定。
权利要求书clms
1.一种工商业园区光储充微电网的控制策略优化方法，其特征在于，包括以下步骤：获取目标工商业园区的历史光伏发电输出，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据；获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对光储充微电网当前时段的充电进行调度；根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，将所述推荐充电时段按照预设方式进行发送。2.根据权利要求1所述的一种工商业园区光储充微电网的控制策略优化方法，其特征在于，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据，具体为：通过数据检索获取历史光伏发电输出提取历史光伏出力数据，将所述历史光伏出力数据进行数据清洗及数据标准化，获取目标工商业园区所在地的气象数据，分析影响因素；计算预处理后的历史光伏出力数据与各影响因素的皮尔逊相关系数，根据所述皮尔逊相关系数对影响因素进行初筛，获取影响因素初筛集合；利用大数据方法获取光伏出力分析实例，统计影响因素初筛集合中各影响因素在所述光伏出力分析实例中的使用次数，通过所述使用次数为各影响因素设置初始权重；根据预设时间步长将历史光伏出力数据进行分段，将分段后的历史光伏出力数据及影响因素作为节点进行图表示，获取无向图，利用图神经网络对无向图进行学习表示；构建邻接矩阵，结合初始权重通过邻居聚合获取光伏出力节点及影响因素节点的向量表示，计算节点向量表示的内积，根据内积排序获取预设数量的影响因素；根据所述影响因素获取出力预测指标，根据所述出力预测指标获取当前输入数据，通过时间卷积网络构建光伏出力预测模型，获取预设时间步长各个时刻的光伏出力数据。3.根据权利要求1所述的一种工商业园区光储充微电网的控制策略优化方法，其特征在于，获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，具体为：根据目标工商业园区内的充电设备读取用户的充电开始时间、充电时长、充电功率、充电需求量，获取用户的多源充电数据，根据所述多源充电数据提取充电特征；将所述充电特征结合电动汽车基础信息设置用户标签，根据所述用户标签进行用户聚类，通过聚类过程中的聚类误差构建损失函数，训练至损失函数收敛，输出聚类中心对应的用户类簇；在用户类簇中将充电特征中利用主成分分析获取累计贡献度高的充电特征作为主成分方向，将用户类簇中不同充电特征在所述主成分方向上进行投影，获取充电特征散点分布图；通过所述充电特征散点分布图获取用户充电行为，根据各充电特征散点分布图结合时序生成不同时序的热力图，获取用户充电低谷期及用户充电高峰期。4.根据权利要求1所述的一种工商业园区光储充微电网的控制策略优化方法，其特征在于，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷，具体为：基于LSTM-CNN构建充电负荷预测模型，获取当前时刻电动汽车充电数量，根据用户充电低谷期或用户充电高峰期赋予不同的权重信息，通过所述当前时刻电动汽车充电数量结合权重信息获取电动汽车预测充电数量；获取当前时刻电动汽车的电池容量状态，根据所述电池容量状态计算充电需求量，并通过用户充电行为分析用户平均充电时长，根据所述平均充电时长更新充电需求量；将当前时间步长内各时刻的电动汽车预测充电数据及充电需求量导入所述充电负荷预测模型，通过LSTM网络学习时间依赖性，获取时间维度的非线性特征；将所述非线性特征导入CNN网络获取目标工商业园区内不同位置充电设备的空间特征，利用全连接层获取预设时间步长各时间戳的充电总负荷，叠加后获取充电总负荷。5.根据权利要求1所述的一种工商业园区光储充微电网的控制策略优化方法，其特征在于，根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对当前时段的充电进行调度，具体为：根据目标工商业园区光储充微电网的充电负荷峰谷差及运行成本获取优化需求信息，并设置优化目标，并根据优化目标结合优化需求信息设定约束条件；根据优化目标构建目标函数，根据所述光伏出力数据及各个时刻充电总负荷对约束信息及相关参数进行设置；初始化粒子群的种群参数，设置参数的运动范围、速度范围、最大迭代次数及学习因子，通过适应度计算获取迭代优化后粒子的最优解及所在群体的最优解，判断粒子是否满足约束条件，若满足则引入混沌算子更新粒子的速度及位置；计算更新后粒子的适应度，将获取的适应度与历史最优解进行比较，将历史最优解进行更新，直到满足迭代结束要求，输出最优解设置光伏系统及储能系统的功率进行电动汽车的充电调度。6.根据权利要求1所述的一种工商业园区光储充微电网的控制策略优化方法，其特征在于，根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，具体为：获取历史时间步长内用户在目标工商业园区中的历史到达时间及充电开始时间，根据所述历史到达时间及充电开始时间统计用户能够接受的最大等待时间，根据用户充电行为及最大等待时间获取用户的充电偏好；获取目标工商业园区光储充微电网中当前电动汽车各时刻的充电总负荷，判断各时刻的充电总负荷是否形成负荷尖峰，获取负荷尖峰时间戳，并根据充电调度策略获取调度时间戳；将所述负荷尖峰时间戳及调度时间戳进行汇总获取时间戳总数，选取时间戳总数小于预设阈值的时间段进行标记，根据标记时间段基于用户的期望充电时间进行再次筛选；将再次筛选的标记时间段与用户的充电偏好进行相似度计算，根据相似度获取推荐充电时段。7.一种工商业园区光储充微电网的控制策略优化系统，其特征在于，该系统包括：存储器、处理器，所述存储器中包括工商业园区光储充微电网的控制策略优化方法程序，所述工商业园区光储充微电网的控制策略优化方法程序被所述处理器执行时实现如下步骤：获取目标工商业园区的历史光伏发电输出，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据；获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对当前时段的充电进行调度；根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，将所述推荐充电时段按照预设方式进行发送。8.根据权利要求7所述的一种工商业园区光储充微电网的控制策略优化系统，其特征在于，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷，具体为：基于LSTM-CNN构建充电负荷预测模型，获取当前时刻电动汽车充电数量，根据用户充电低谷期或用户充电高峰期赋予不同的权重信息，通过所述当前时刻电动汽车充电数量结合权重信息获取电动汽车预测充电数量；获取当前时刻电动汽车的电池容量状态，根据所述电池容量状态计算充电需求量，并通过用户充电行为分析用户平均充电时长，根据所述平均充电时长更新充电需求量；将当前时间步长内各时刻的电动汽车预测充电数据及充电需求量导入所述充电负荷预测模型，通过LSTM网络学习时间依赖性，获取时间维度的非线性特征；将所述非线性特征导入CNN网络获取目标工商业园区内不同位置充电设备的空间特征，利用全连接层获取预设时间步长各时间戳的充电总负荷，叠加后获取充电总负荷。9.根据权利要求7所述的一种工商业园区光储充微电网的控制策略优化系统，其特征在于，根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对当前时段的充电进行调度，具体为：根据目标工商业园区光储充微电网的充电负荷峰谷差及运行成本获取优化需求信息，并设置优化目标，并根据优化目标结合优化需求信息设定约束条件；根据优化目标构建目标函数，根据所述光伏出力数据及各个时刻充电总负荷对约束信息及相关参数进行设置；初始化粒子群的种群参数，设置参数的运动范围、速度范围、最大迭代次数及学习因子，通过适应度计算获取迭代优化后粒子的最优解及所在群体的最优解，判断粒子是否满足约束条件，若满足则引入混沌算子更新粒子的速度及位置；计算更新后粒子的适应度，将获取的适应度与历史最优解进行比较，将历史最优解进行更新，直到满足迭代结束要求，输出最优解设置光伏系统及储能系统的功率进行电动汽车的充电调度。10.根据权利要求7所述的一种工商业园区光储充微电网的控制策略优化系统，其特征在于，根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，具体为：获取历史时间步长内用户在目标工商业园区中的历史到达时间及充电开始时间，根据所述历史到达时间及充电开始时间统计用户能够接受的最大等待时间，根据用户充电行为及最大等待时间获取用户的充电偏好；获取目标工商业园区光储充微电网中当前电动汽车各时刻的充电总负荷，判断各时刻的充电总负荷是否形成负荷尖峰，获取负荷尖峰时间戳，并根据充电调度策略获取调度时间戳；将所述负荷尖峰时间戳及调度时间戳进行汇总获取时间戳总数，选取时间戳总数小于预设阈值的时间段进行标记，根据标记时间段基于用户的期望充电时间进行再次筛选；将再次筛选的标记时间段与用户的充电偏好进行相似度计算，根据相似度获取推荐充电时段。
说明书desc
技术领域本发明涉及微电网技术领域，更具体的，涉及一种工商业园区光储充微电网的控制策略优化方法及系统。背景技术电动汽车对于推动节能减排具有巨大作用，但大规模电动汽车接入电网后，其充电负荷会给电网带来短时负荷冲击，影响电网安全运行。目前面向环保、便捷和安全等目标的“光伏+储能+充电站”一体化系统逐渐受到了人们的青睐，光储充一体化电站可利用光伏和储能来平衡电动汽车充电负荷，有效降低大规模电动汽车充电对电网资源的占用。光储充一体化系统通常是由供配电系统、充电系统、监控系统、光伏系统和储能系统组成的微电网系统。对于光储充一体化系统要想准确地求解充电站的最佳光伏装机容量和储能装机容量，需要对区域内的电动汽车充电需求及其分布进行模拟与预测，但是每个电动汽车的充电时间、充电时长、日均行驶里程数和用户习惯等数据都是相互孤立的，并且存在一定的无序性与不确定性，所以想要建立准确度较高的电动汽车充电负荷预测模型难度较大。因此，如何准确预测充电负荷，对光储充一体化充电系统进行协同配置优化是需要解决的问题之一。发明内容为了解决上述技术问题，本发明提出了一种工商业园区光储充微电网的控制策略优化方法及系统。本发明第一方面提供了一种工商业园区光储充微电网的控制策略优化方法，包括：获取目标工商业园区的历史光伏发电输出，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据；获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对光储充微电网当前时段的充电进行调度；根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，将所述推荐充电时段按照预设方式进行发送。本方案中，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据，具体为：通过数据检索获取历史光伏发电输出提取历史光伏出力数据，将所述历史光伏出力数据进行数据清洗及数据标准化，获取目标工商业园区所在地的气象数据，分析影响因素；计算预处理后的历史光伏出力数据与各影响因素的皮尔逊相关系数，根据所述皮尔逊相关系数对影响因素进行初筛，获取影响因素初筛集合；利用大数据方法获取光伏出力分析实例，统计影响因素初筛集合中各影响因素在所述光伏出力分析实例中的使用次数，通过所述使用次数为各影响因素设置初始权重；根据预设时间步长将历史光伏出力数据进行分段，将分段后的历史光伏出力数据及影响因素作为节点进行图表示，获取无向图，利用图神经网络对无向图进行学习表示；构建邻接矩阵，结合初始权重通过邻居聚合获取光伏出力节点及影响因素节点的向量表示，计算节点向量表示的内积，根据内积排序获取预设数量的影响因素；根据所述影响因素获取出力预测指标，根据所述出力预测指标获取当前输入数据，通过时间卷积网络构建光伏出力预测模型，获取预设时间步长各个时刻的光伏出力数据。本方案中，获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，具体为：根据目标工商业园区内的充电设备读取用户的充电开始时间、充电时长、充电功率、充电需求量，获取用户的多源充电数据，根据所述多源充电数据提取充电特征；将所述充电特征结合电动汽车基础信息设置用户标签，根据所述用户标签进行用户聚类，通过聚类过程中的聚类误差构建损失函数，训练至损失函数收敛，输出聚类中心对应的用户类簇；在用户类簇中将充电特征中利用主成分分析获取累计贡献度高的充电特征作为主成分方向，将用户类簇中不同充电特征在所述主成分方向上进行投影，获取充电特征散点分布图；通过所述充电特征散点分布图获取用户充电行为，根据各充电特征散点分布图结合时序生成不同时序的热力图，获取用户充电低谷期及用户充电高峰期。本方案中，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷，具体为：基于LSTM-CNN构建充电负荷预测模型，获取当前时刻电动汽车充电数量，根据用户充电低谷期或用户充电高峰期赋予不同的权重信息，通过所述当前时刻电动汽车充电数量结合权重信息获取电动汽车预测充电数量；获取当前时刻电动汽车的电池容量状态，根据所述电池容量状态计算充电需求量，并通过用户充电行为分析用户平均充电时长，根据所述平均充电时长更新充电需求量；将当前时间步长内各时刻的电动汽车预测充电数据及充电需求量导入所述充电负荷预测模型，通过LSTM网络学习时间依赖性，获取时间维度的非线性特征；将所述非线性特征导入CNN网络获取目标工商业园区内不同位置充电设备的空间特征，利用全连接层获取预设时间步长各时间戳的充电总负荷，叠加后获取充电总负荷。本方案中，根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对当前时段的充电进行调度，具体为：根据目标工商业园区光储充微电网的充电负荷峰谷差及运行成本获取优化需求信息，并设置优化目标，并根据优化目标结合优化需求信息设定约束条件；根据优化目标构建目标函数，根据所述光伏出力数据及各个时刻充电总负荷对约束信息及相关参数进行设置；初始化粒子群的种群参数，设置参数的运动范围、速度范围、最大迭代次数及学习因子，通过适应度计算获取迭代优化后粒子的最优解及所在群体的最优解，判断粒子是否满足约束条件，若满足则引入混沌算子更新粒子的速度及位置；计算更新后粒子的适应度，将获取的适应度与历史最优解进行比较，将历史最优解进行更新，直到满足迭代结束要求，输出最优解设置光伏系统及储能系统的功率进行电动汽车的充电调度。本方案中，根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，具体为：获取历史时间步长内用户在目标工商业园区中的历史到达时间及充电开始时间，根据所述历史到达时间及充电开始时间统计用户能够接受的最大等待时间，根据用户充电行为及最大等待时间获取用户的充电偏好；获取目标工商业园区光储充微电网中当前电动汽车各时刻的充电总负荷，判断各时刻的充电总负荷是否形成负荷尖峰，获取负荷尖峰时间戳，并根据充电调度策略获取调度时间戳；将所述负荷尖峰时间戳及调度时间戳进行汇总获取时间戳总数，选取时间戳总数小于预设阈值的时间段进行标记，根据标记时间段基于用户的期望充电时间进行再次筛选；将再次筛选的标记时间段与用户的充电偏好进行相似度计算，根据相似度获取推荐充电时段。本发明第二方面还提供了一种工商业园区光储充微电网的控制策略优化系统，该系统包括：存储器、处理器，所述存储器中包括工商业园区光储充微电网的控制策略优化方法程序，所述工商业园区光储充微电网的控制策略优化方法程序被所述处理器执行时实现如下步骤：获取目标工商业园区的历史光伏发电输出，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据；获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对光储充微电网当前时段的充电进行调度；根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，将所述推荐充电时段按照预设方式进行发送。本发明公开了一种工商业园区光储充微电网的控制策略优化方法及系统，包括，获取目标工商业园区的历史光伏发电输出，筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型；通过出力预测指标及出力预测模型预测目标工商业园区的光伏出力数据；获取预设时间内目标工商业园区中用户的多源充电数据，分析用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；根据光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据最优解对当前时段的充电进行调度。本发明提高了光伏系统及储能系统的利用率，提升预测精度并优化运营成本，有效降低了微电网的系统综合运行成本保证光储充微电网运行更加合理稳定，实现对电动汽车的合理充电分配，提升充电站的充电效率及充电安全性。根据用户充电行为生成推荐充电时段，为用户提供科学的充电决策，提高了用户的充电体验。附图说明图1示出了本发明一种工商业园区光储充微电网的控制策略优化方法的流程图；图2示出了本发明构建充电负荷预测模型模拟充电总负荷的流程图；图3示出了本发明生成用户推荐充电时段的流程图；图4示出了本发明一种工商业园区光储充微电网的控制策略优化系统的框图。具体实施方式为了能够更清楚地理解本发明的上述目的、特征和优点，下面结合附图和具体实施方式对本发明进行进一步的详细描述。需要说明的是，在不冲突的情况下，本申请的实施例及实施例中的特征可以相互组合。在下面的描述中阐述了很多具体细节以便于充分理解本发明，但是，本发明还可以采用其他不同于在此描述的其他方式来实施，因此，本发明的保护范围并不受下面公开的具体实施例的限制。图1示出了本发明一种工商业园区光储充微电网的控制策略优化方法的流程图。如图1所示，本发明第一方面提供了一种工商业园区光储充微电网的控制策略优化方法，包括：S102，获取目标工商业园区的历史光伏发电输出，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据；S104，获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；S106，根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对光储充微电网当前时段的充电进行调度；S108，根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，将所述推荐充电时段按照预设方式进行发送。需要说明的是，在光伏数据空间中通过数据检索获取历史光伏发电输出提取历史光伏出力数据，将所述历史光伏出力数据进行数据清洗及数据标准化，数据清理涉及剔除异常值并补充缺失值。数据标准化将数据进行归一化处理，加快梯度下降的收敛速度，获取目标工商业园区所在地的气象数据，分析光伏出力的影响因素，包括环境温度、风速、湿度及水平散射辐射度等；计算预处理后的历史光伏出力数据与各影响因素的皮尔逊相关系数，根据所述皮尔逊相关系数对影响因素进行初筛，获取影响因素初筛集合。利用大数据方法获取光伏出力分析实例，统计影响因素初筛集合中各影响因素在所述光伏出力分析实例中的使用次数，通过所述使用次数为各影响因素设置初始权重；根据预设时间步长将历史光伏出力数据进行分段，将分段后的历史光伏出力数据及影响因素作为节点进行图表示，获取无向图，利用图神经网络对无向图进行学习表示；构建邻接矩阵，结合初始权重通过邻居聚合获取光伏出力节点及影响因素节点的向量表示，计算节点向量表示的内积，根据内积排序获取预设数量的影响因素；根据所述影响因素获取出力预测指标，根据所述出力预测指标获取当前输入数据，通过时间卷积网络构建光伏出力预测模型，获取预设时间步长各个时刻的光伏出力数据。图2示出了本发明构建充电负荷预测模型模拟充电总负荷的流程图。根据本发明实施例，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷，具体为：S202，基于LSTM-CNN构建充电负荷预测模型，获取当前时刻电动汽车充电数量，根据用户充电低谷期或用户充电高峰期赋予不同的权重信息，通过所述当前时刻电动汽车充电数量结合权重信息获取电动汽车预测充电数量；S204，获取当前时刻电动汽车的电池容量状态，根据所述电池容量状态计算充电需求量，并通过用户充电行为分析用户平均充电时长，根据所述平均充电时长更新充电需求量；S206，将当前时间步长内各时刻的电动汽车预测充电数据及充电需求量导入所述充电负荷预测模型，通过LSTM网络学习时间依赖性，获取时间维度的非线性特征；S208，将所述非线性特征导入CNN网络获取目标工商业园区内不同位置充电设备的空间特征，利用全连接层获取预设时间步长各时间戳的充电总负荷，叠加后获取充电总负荷。需要说明的是，根据目标工商业园区内的充电设备读取用户的充电开始时间、充电时长、充电功率、充电需求量，获取用户的多源充电数据，根据所述多源充电数据提取充电特征；将所述充电特征结合电动汽车基础信息设置用户标签，基础信息包括电池容量、充电功率等，根据所述用户标签进行用户聚类，通过聚类过程中的聚类误差构建损失函数，训练至损失函数收敛，输出聚类中心对应的用户类簇；在用户类簇中将充电特征中利用主成分分析获取累计贡献度高的充电特征作为主成分方向，将用户类簇中不同充电特征在所述主成分方向上进行投影，获取充电特征散点分布图；通过所述充电特征散点分布图获取用户充电行为，根据各充电特征散点分布图结合时序生成不同时序的热力图，获取用户充电低谷期及用户充电高峰期。需要说明的是，根据目标工商业园区光储充微电网的充电负荷峰谷差及运行成本获取优化需求信息，并设置优化目标，所述优化目标可以为最小化运行成本或者最小化充电负荷峰谷差，其中运行成本包括光伏发电成本、设备退化成本及配电网电价，充电负荷峰谷差通过调度前后的负荷峰谷值获取；也可以考虑两项优化，设置最小化运行成本及最小化充电负荷峰谷差，并根据优化目标结合优化需求信息设定约束条件包括，功率平衡约束、电动汽车充能约束及储能系统约束等；根据优化目标构建目标函数，根据所述光伏出力数据及各个时刻充电总负荷对约束信息及相关参数进行设置；初始化粒子群的种群参数，设置参数的运动范围、速度范围、最大迭代次数及学习因子，通过适应度计算获取迭代优化后粒子的最优解及所在群体的最优解，判断粒子是否满足约束条件，若满足则引入混沌算子更新粒子的速度及位置；计算更新后粒子的适应度，将获取的适应度与历史最优解进行比较，将历史最优解进行更新，直到满足迭代结束要求，输出最优解设置光伏系统及储能系统的功率进行电动汽车的充电调度。通常优先采用光伏系统对电动汽车进行供电；在电价低谷时段时，优先使用光伏系统对电动汽车进行供电，光伏系统出力大于充电负荷时，则对储能系统进行充能并且向配电网进行售电，否则，从配电网进行购电对电动汽车及储能系统进行供能；在电价高峰时，优先使用储能系统进行供电，储能系统容量小于预设阈值时，则从配电网进行购电对电动汽车进行供电；在电价平峰时，优先使用光伏系统对电动汽车进行供电，光伏系统出力大于充电负荷时，则对储能系统进行充能并且向配电网进行售电，否则，从配电网进行购电对电动汽车进行供能。图3示出了本发明生成用户推荐充电时段的流程图。根据本发明实施例，根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，具体为：S302，获取历史时间步长内用户在目标工商业园区中的历史到达时间及充电开始时间，根据所述历史到达时间及充电开始时间统计用户能够接受的最大等待时间，根据用户充电行为及最大等待时间获取用户的充电偏好；S304，获取目标工商业园区光储充微电网中当前电动汽车各时刻的充电总负荷，判断各时刻的充电总负荷是否形成负荷尖峰，获取负荷尖峰时间戳，并根据充电调度策略获取调度时间戳；S306，将所述负荷尖峰时间戳及调度时间戳进行汇总获取时间戳总数，选取时间戳总数小于预设阈值的时间段进行标记，根据标记时间段基于用户的期望充电时间进行再次筛选；S308，将再次筛选的标记时间段与用户的充电偏好进行相似度计算，根据相似度获取推荐充电时段。需要说明的是，在用户充电行为中提取历史充电时段，获取历史充电时段的电价分析充电电价偏好，在再次筛选的标记时间段过程中整合充电电价偏好进行筛选标记。根据本发明实施例，根据光储充微电网的接入情况生成用户充电推荐，包括：在目标地区中，获取具备光储充微电网工商业园区的位置信息，基于所述位置信息设备目标工商业园区的邻接园区，根据目标工商业园区光储充微电网的接入情况及充电负荷进行充电桩位置及充电时段推荐；根据目标工商业园区及邻接园区构建城市级微电网，通过所述城市级微电网查询邻近园区光储充微电网的接入情况，并且通过同一网络系统进行结算；当目标工商业园区中无空闲充电桩时，则通过城市级微电网查询当前符合用户充电偏好的空闲充电桩位置，根据所述空闲充电桩位置生成路线导航信息及路线对应时长；获取目标工商业园区光储充微电网中充电桩的最低等待时间，判断路线对应时长是否小于最低等待时间，若小于，则通过城市级微电网进行充电桩预约。图4示出了本发明一种工商业园区光储充微电网的控制策略优化系统的框图。本发明第二方面还提供了一种工商业园区光储充微电网的控制策略优化系统4，该系统包括：存储器41、处理器42，所述存储器中包括工商业园区光储充微电网的控制策略优化方法程序，所述工商业园区光储充微电网的控制策略优化方法程序被所述处理器执行时实现如下步骤：获取目标工商业园区的历史光伏发电输出，根据所述历史光伏发电输出筛选光伏发电出力的影响因素确定出力预测指标，构建光伏出力预测模型，预测目标工商业园区的光伏出力数据；获取预设时间内目标工商业园区中用户的多源充电数据，根据所述多源充电数据分析用户充电行为，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷；根据所述光伏出力数据及各个时刻充电总负荷基于粒子群算法获取最优解，根据所述最优解对光储充微电网当前时段的充电进行调度；根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，将所述推荐充电时段按照预设方式进行发送。需要说明的是，在光伏数据空间中通过数据检索获取历史光伏发电输出提取历史光伏出力数据，将所述历史光伏出力数据进行数据清洗及数据标准化，数据清理涉及剔除异常值并补充缺失值。数据标准化将数据进行归一化处理，加快梯度下降的收敛速度，获取目标工商业园区所在地的气象数据，分析光伏出力的影响因素，包括环境温度、风速、湿度及水平散射辐射度等；计算预处理后的历史光伏出力数据与各影响因素的皮尔逊相关系数，根据所述皮尔逊相关系数对影响因素进行初筛，获取影响因素初筛集合。利用大数据方法获取光伏出力分析实例，统计影响因素初筛集合中各影响因素在所述光伏出力分析实例中的使用次数，通过所述使用次数为各影响因素设置初始权重；根据预设时间步长将历史光伏出力数据进行分段，将分段后的历史光伏出力数据及影响因素作为节点进行图表示，获取无向图，利用图神经网络对无向图进行学习表示；构建邻接矩阵，结合初始权重通过邻居聚合获取光伏出力节点及影响因素节点的向量表示，计算节点向量表示的内积，根据内积排序获取预设数量的影响因素；根据所述影响因素获取出力预测指标，根据所述出力预测指标获取当前输入数据，通过时间卷积网络构建光伏出力预测模型，获取预设时间步长各个时刻的光伏出力数据。根据本发明实施例，根据所述用户充电行为构建充电负荷预测模型，模拟各个时刻充电总负荷，具体为：基于LSTM-CNN构建充电负荷预测模型，获取当前时刻电动汽车充电数量，根据用户充电低谷期或用户充电高峰期赋予不同的权重信息，通过所述当前时刻电动汽车充电数量结合权重信息获取电动汽车预测充电数量；获取当前时刻电动汽车的电池容量状态，根据所述电池容量状态计算充电需求量，并通过用户充电行为分析用户平均充电时长，根据所述平均充电时长更新充电需求量；将当前时间步长内各时刻的电动汽车预测充电数据及充电需求量导入所述充电负荷预测模型，通过LSTM网络学习时间依赖性，获取时间维度的非线性特征；将所述非线性特征导入CNN网络获取目标工商业园区内不同位置充电设备的空间特征，利用全连接层获取预设时间步长各时间戳的充电总负荷，叠加后获取充电总负荷。需要说明的是，根据目标工商业园区内的充电设备读取用户的充电开始时间、充电时长、充电功率、充电需求量，获取用户的多源充电数据，根据所述多源充电数据提取充电特征；将所述充电特征结合电动汽车基础信息设置用户标签，基础信息包括电池容量、充电功率等，根据所述用户标签进行用户聚类，通过聚类过程中的聚类误差构建损失函数，训练至损失函数收敛，输出聚类中心对应的用户类簇；在用户类簇中将充电特征中利用主成分分析获取累计贡献度高的充电特征作为主成分方向，将用户类簇中不同充电特征在所述主成分方向上进行投影，获取充电特征散点分布图；通过所述充电特征散点分布图获取用户充电行为，根据各充电特征散点分布图结合时序生成不同时序的热力图，获取用户充电低谷期及用户充电高峰期。需要说明的是，根据目标工商业园区光储充微电网的充电负荷峰谷差及运行成本获取优化需求信息，并设置优化目标，所述优化目标可以为最小化运行成本或者最小化充电负荷峰谷差，其中运行成本包括光伏发电成本、设备退化成本及配电网电价，充电负荷峰谷差通过调度前后的负荷峰谷值获取；也可以考虑两项优化，设置最小化运行成本及最小化充电负荷峰谷差，并根据优化目标结合优化需求信息设定约束条件包括，功率平衡约束、电动汽车充能约束及储能系统约束等；根据优化目标构建目标函数，根据所述光伏出力数据及各个时刻充电总负荷对约束信息及相关参数进行设置；初始化粒子群的种群参数，设置参数的运动范围、速度范围、最大迭代次数及学习因子，通过适应度计算获取迭代优化后粒子的最优解及所在群体的最优解，判断粒子是否满足约束条件，若满足则引入混沌算子更新粒子的速度及位置；计算更新后粒子的适应度，将获取的适应度与历史最优解进行比较，将历史最优解进行更新，直到满足迭代结束要求，输出最优解设置光伏系统及储能系统的功率进行电动汽车的充电调度。根据本发明实施例，根据目标工商业园区的充电调度策略及用户充电行为生成推荐充电时段，具体为：获取历史时间步长内用户在目标工商业园区中的历史到达时间及充电开始时间，根据所述历史到达时间及充电开始时间统计用户能够接受的最大等待时间，根据用户充电行为及最大等待时间获取用户的充电偏好；获取目标工商业园区光储充微电网中当前电动汽车各时刻的充电总负荷，判断各时刻的充电总负荷是否形成负荷尖峰，获取负荷尖峰时间戳，并根据充电调度策略获取调度时间戳；将所述负荷尖峰时间戳及调度时间戳进行汇总获取时间戳总数，选取时间戳总数小于预设阈值的时间段进行标记，根据标记时间段基于用户的期望充电时间进行再次筛选；将再次筛选的标记时间段与用户的充电偏好进行相似度计算，根据相似度获取推荐充电时段。本发明第三方面还提供一种计算机可读存储介质，所述计算机可读存储介质中包括工商业园区光储充微电网的控制策略优化方法程序，所述工商业园区光储充微电网的控制策略优化方法程序被处理器执行时，实现如上述任一项所述的工商业园区光储充微电网的控制策略优化方法的步骤。在本申请所提供的几个实施例中，应该理解到，所揭露的设备和方法，可以通过其它的方式实现。以上所描述的设备实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，如：多个单元或组件可以结合，或可以集成到另一个系统，或一些特征可以忽略，或不执行。另外，所显示或讨论的各组成部分相互之间的耦合、或直接耦合、或通信连接可以是通过一些接口，设备或单元的间接耦合或通信连接，可以是电性的、机械的或其它形式的。上述作为分离部件说明的单元可以是、或也可以不是物理上分开的，作为单元显示的部件可以是、或也可以不是物理单元；既可以位于一个地方，也可以分布到多个网络单元上；可以根据实际的需要选择其中的部分或全部单元来实现本实施例方案的目的。另外，在本发明各实施例中的各功能单元可以全部集成在一个处理单元中，也可以是各单元分别单独作为一个单元，也可以两个或两个以上单元集成在一个单元中；上述集成的单元既可以采用硬件的形式实现，也可以采用硬件加软件功能单元的形式实现。本领域普通技术人员可以理解：实现上述方法实施例的全部或部分步骤可以通过程序指令相关的硬件来完成，前述的程序可以存储于计算机可读取存储介质中，该程序在执行时，执行包括上述方法实施例的步骤；而前述的存储介质包括：移动存储设备、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。或者，本发明上述集成的单元如果以软件功能模块的形式实现并作为独立的产品销售或使用时，也可以存储在一个计算机可读取存储介质中。基于这样的理解，本发明实施例的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本发明各个实施例所述方法的全部或部分。而前述的存储介质包括：移动存储设备、ROM、RAM、磁碟或者光盘等各种可以存储程序代码的介质。以上所述，仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应以所述权利要求的保护范围为准。
