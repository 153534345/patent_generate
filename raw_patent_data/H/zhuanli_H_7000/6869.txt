标题title
一种用于5G异构网络业务安全性提升的用户面方法及装置
摘要abst
本发明公开了一种用于5G异构网络业务安全性提升的用户面方法及装置,属于移动通信技术领域，解决了现有5G核心网仅对用户终端而不对使用终端用户进行鉴权而造成的业务面网元被大量用户发起的非法业务进行资源占用的问题。该方法兼容现有3GPP TS23.502及TS29.244系统流程及信令结构。本发明符合CCSA TC12工作组“天地一体5G网络总体技术要求”第11.3项“天地一体5G网络安全方案”范围，能广泛适用于各类需要5G管道对使用合法注册终端的用户合法性鉴权所需的方法。
权利要求书clms
1.一种用于5G异构网络业务安全性提升的用户面方法，包括卫星核心网或5G核心网的控制面和用户面，其特征在于，包括如下步骤：S1、在PFCP会话建立/更新请求中增加用户合法性校验结果上报触发条件用于携带用户面用户合法性检验指示及上报控制；在PFCP会话上报请求中增加用户校验结果用于携带用户合法性校验结果；S2、控制面将携带有用户面用户合法性检验指示及上报控制的PFCP会话建立/更新请求发送给用户面；S3、用户面接收到PFCP会话建立/更新请求，根据用户面用户合法性检验指示及上报控制，判断是否需要加载用户合法性校验及上报触发条件；若需要，进入步骤S4；反之，则忽略用户合法性校验；S4、用户面对用户合法性进行校验得到用户合法性校验结果，根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面；若需要，进入步骤S5；反之，进入步骤S6；S5、控制面接收到PFCP会话上报请求后，检查用户校验结果的信元内容，根据信元内容得到用户合法性校验结果；S6、若用户合法性校验结果为校验失败，则触发用户会话释放流程；若用户合法性校验结果为校验合格，则忽略。2.如权利要求1所述的一种用于5G异构网络业务安全性提升的用户面方法，其特征在于：步骤S1中，在PFCP会话建立/更新请求中的创建/更新用量上报中的上报触发条件中增加用户合法性校验结果上报触发条件。3.如权利要求1所述的一种用于5G异构网络业务安全性提升的用户面方法，其特征在于，步骤S3中根据用户面用户合法性检验指示及上报控制，判断是否需要加载用户合法性校验及上报触发条件的具体操作如下：若PFCP会话建立/更新请求中的用户合法性校验结果上报触发条件被设置为“1”，则需要加载用户合法性校验及上报触发条件；反之，则忽略用户合法性校验。4.如权利要求1所述的一种用于5G异构网络业务安全性提升的用户面方法，其特征在于，步骤S4中根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面的具体操作如下：若用户合法性校验结果为校验失败，则需要发送；若用户合法性校验结果为校验合格，则无需发送。5.如权利要求1所述的一种用于5G异构网络业务安全性提升的用户面方法，其特征在于，步骤S4中根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面的具体操作如下：无论用户合法性校验结果为校验失败或校验合格，均需要发送。6.如权利要求1所述的一种用于5G异构网络业务安全性提升的用户面方法，其特征在于，步骤S5中，检查用户校验结果的信元内容，根据信元内容得到用户合法性校验结果的具体操作如下：S51、检查用户校验结果的信元内容中报告类型是否为用户校验结果报告；若是，则进入步骤S52；反之，则无需触发会话释放流程；S52、检查用户校验结果的信元内容中是否存在用户合法性校验结果；若存在，直接得到用户合法性校验结果；若不存在，则判断校验失败。7.一种用于5G异构网络业务安全性提升的用户面装置，其特征在于：包括存储器和一个或多个处理器，所述存储器中存储有可执行代码，所述一个或多个处理器执行所述可执行代码时，用于实现权利要求1-6任一项所述的一种用于5G异构网络业务安全性提升的用户面方法。8.一种计算机可读存储介质，其特征在于：其上存储有程序，该程序被处理器执行时，实现权利要求1-6任一项所述的一种用于5G异构网络业务安全性提升的用户面方法。
说明书desc
技术领域本发明涉及移动通信技术领域，特别涉及一种用于5G异构网络业务安全性提升的用户面方法及装置。背景技术目前3GPP第五代通信系统仅提出无线侧卫星组网尚无核心网侧研究内容，同时CCSA TC12工作组“天地一体5G网络总体技术要求”第11.3项“天地一体5G网络安全方案”也对天地一体化架构和安全需求进行了概括性描述:天地一体5G网络安全应从物理安全、数据安全和网络运行安全几个方面全面进行考虑，内容可以包括但不限于终端连接安全、天基接入网连接安全、天基核心网连接安全、地基接入网连接安全、地基核心网连接安全、网络功能安全、用户数据安全、网络物理隔离和逻辑隔离、网络管理安全、网络配置安全、天地一体业务安全等。可采用的技术手段包括但不限于抗毁技术、抗干扰技术、安全接入和安全路由技术、安全传输、安全存储及密钥管理技术等网络安全防护技术来构建天地一体网络安全架构，保障网络体系安全运行。现有星地一体化架构基于卫星用户面转发架构，5G终端通过空口连接到5G基站,5G基站的回传网络由卫星中继通过卫星核心网业务管道提供连接到远端5G核心网，用户最终通过由卫星中继的5G数据管道连接到数据网络，5G核心网仅提供对5G终端的注册鉴权，无对使用经过5G注册鉴权合法终端的非法用户的鉴权以及由此带来的网络管道安全性提升的方法。现有5G系统控制面和用户面分离架构下控制面对用户面业务流的业务流检测及控制的包转发协议如图2所示，具体步骤如下1、控制面会话管理功能通过PFCP会话建立/修改请求下发流量检测及流量控制规则到用户面功能。2、用户面UPF执行控制面下发的流检测及流量控制规则。3、用户面UPF根据流量检测规则检测到业务流，根据流控规则进行流量控制，并触发PFCP会话上报请求对该检测到的业务流进行上报。4、控制面SMF通过PFCP会话修改请求下发更新用户面业务流检测及流量控制规则。如图3所示，现有与5G组网构成空地一体化的卫星系统存在以下几点问题：1、非法用户使用经过5G系统合法注册的终端发起非法业务对卫星核心网用于5G中继管道的用户面、5G核心网的控制面和用户面的有限硬件处理资源进行抢占，例如采用拒绝服务攻击来降低用户面及控制面的业务处理能力。此外，非法用户也可通过星地一体网络中由卫星核心网用户面和5G核心网用户面构成的业务中继管道对数据网络端发起攻击；2、3GPP 5G NTN研究内容尚未开始核心网侧技术讨论，CCSA TC12提出的“天地一体5G网络总体技术要求”第11.3项“天地一体5G网络安全方案”尚无具体攻防场景及技术；如上所述，现有与5G组网的星地一体系统亟需一种对使用合法终端的用户合法性进行鉴权从而提升网络管道安全性，同时提升数据网络服务器端安全性防护能力的方法。发明内容本发明的目的在于提供一种用于5G异构网络业务安全性提升的用户面方法及装置，以克服现有技术中的不足。为实现上述目的，本发明提供如下技术方案：本申请公开了一种用于5G异构网络业务安全性提升的用户面方法，包括卫星核心网或5G核心网的控制面和用户面，包括如下步骤：S1、在PFCP会话建立/更新请求中增加用户合法性校验结果上报触发条件用于携带用户面用户合法性检验指示及上报控制；在PFCP会话上报请求中增加用户校验结果用于携带用户合法性校验结果；S2、控制面将携带有用户面用户合法性检验指示及上报控制的PFCP会话建立/更新请求发送给用户面；S3、用户面接收到PFCP会话建立/更新请求，根据用户面用户合法性检验指示及上报控制，判断是否需要加载用户合法性校验及上报触发条件；若需要，进入步骤S4；反之，则忽略用户合法性校验；S4、用户面对用户合法性进行校验得到用户合法性校验结果，根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面；若需要，进入步骤S5；反之，进入步骤S6；S5、控制面接收到PFCP会话上报请求后，检查用户校验结果的信元内容，根据信元内容得到用户合法性校验结果；S6、若用户合法性校验结果为校验失败，则触发用户会话释放流程；若用户合法性校验结果为校验合格，则忽略。作为优选，步骤S1中，在PFCP会话建立/更新请求中的创建/更新用量上报中的上报触发条件中增加用户合法性校验结果上报触发条件。作为优选，步骤S3中根据用户面用户合法性检验指示及上报控制，判断是否需要加载用户合法性校验及上报触发条件的具体操作如下：若PFCP会话建立/更新请求中的用户合法性校验结果上报触发条件被设置为“1”，则需要加载用户合法性校验及上报触发条件；反之，则忽略用户合法性校验。作为优选，步骤S4中根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面的具体操作如下：若用户合法性校验结果为校验失败，则需要发送；若用户合法性校验结果为校验合格，则无需发送。作为优选，步骤S4中根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面的具体操作如下：无论用户合法性校验结果为校验失败或校验合格，均需要发送。作为优选，步骤S5中，检查用户校验结果的信元内容，根据信元内容得到用户合法性校验结果的具体操作如下：S51、检查用户校验结果的信元内容中报告类型是否为用户校验结果报告；若是，则进入步骤S52；反之，则无需触发会话释放流程；S52、检查用户校验结果的信元内容中是否存在用户合法性校验结果；若存在，直接得到用户合法性校验结果；若不存在，则判断校验失败。本申请一种用于5G异构网络业务安全性提升的用户面装置，包括存储器和一个或多个处理器，所述存储器中存储有可执行代码，所述一个或多个处理器执行所述可执行代码时，用于上述的一种用于5G异构网络业务安全性提升的用户面方法。本申请一种计算机可读存储介质，其上存储有程序，该程序被处理器执行时，实现上述的一种用于5G异构网络业务安全性提升的用户面方法。本发明的有益效果：本发明对使用终端的用户及发起的业务合法性提出了基于卫星管道用户面网元部署校验功能并进行鉴权的方法，可有效提升数据网络端在不进行安全防护升级基础上对伪用户及非法业务攻击业务服务器的防范等级。此外新提出的流程及信令结构进一步完善了3GPP星地一体化场景及需求、同时对CCSA提出的星地一体化安全技术架构进行了有效技术补充。本发明的特征及优点将通过实施例结合附图进行详细说明。附图说明图1是5G系统结合卫星中继管道架构；图2是5G PFCP控制面与用户面分离的业务控制系统流程；图3是5G天地一体架构非法用户攻击网络管道；图4是本发明5G核心网用户面校验功能部署架构；图5是本发明的一种用于5G异构网络业务安全性提升的用户面方法的流程示意图；图6是本发明一种用于5G异构网络业务安全性提升的用户面装置的结构示意图。具体实施方式为使本发明的目的、技术方案和优点更加清楚明了，下面通过附图及实施例，对本发明进行进一步详细说明。但是应该理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限制本发明的范围。此外，在以下说明中，省略了对公知结构和技术的描述，以避免不必要地混淆本发明的概念。参阅图5，本发明一种用于5G异构网络业务安全性提升的用户面方法，包括卫星核心网或5G核心网的控制面和用户面，包括如下步骤：S1、在PFCP会话建立/更新请求中增加用户合法性校验结果上报触发条件用于携带用户面用户合法性检验指示及上报控制；在PFCP会话上报请求中增加用户校验结果用于携带用户合法性校验结果；S2、控制面将携带有用户面用户合法性检验指示及上报控制的PFCP会话建立/更新请求发送给用户面；S3、用户面接收到PFCP会话建立/更新请求，根据用户面用户合法性检验指示及上报控制，判断是否需要加载用户合法性校验及上报触发条件；若需要，进入步骤S4；反之，则忽略用户合法性校验；S4、用户面对用户合法性进行校验得到用户合法性校验结果，根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面；若需要，进入步骤S5；反之，进入步骤S6；S5、控制面接收到PFCP会话上报请求后，检查用户校验结果的信元内容，根据信元内容得到用户合法性校验结果；S6、若用户合法性校验结果为校验失败，则触发用户会话释放流程；若用户合法性校验结果为校验合格，则忽略。在一种可行的实施例中，步骤S1中，在PFCP会话建立/更新请求中的创建/更新用量上报中的上报触发条件中增加用户合法性校验结果上报触发条件。在一种可行的实施例中，步骤S3中根据用户面用户合法性检验指示及上报控制，判断是否需要加载用户合法性校验及上报触发条件的具体操作如下：若PFCP会话建立/更新请求中的用户合法性校验结果上报触发条件被设置为“1”，则需要加载用户合法性校验及上报触发条件；反之，则忽略用户合法性校验。在一种可行的实施例中，步骤S4中根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面的具体操作如下：若用户合法性校验结果为校验失败，则需要发送；若用户合法性校验结果为校验合格，则无需发送。在一种可行的实施例中，步骤S4中根据用户合法性校验结果判断是否需要发送PFCP会话上报请求给控制面的具体操作如下：无论用户合法性校验结果为校验失败或校验合格，均需要发送。在一种可行的实施例中，步骤S5中，检查用户校验结果的信元内容，根据信元内容得到用户合法性校验结果的具体操作如下：S51、检查用户校验结果的信元内容中报告类型是否为用户校验结果报告；若是，则进入步骤S52；反之，则判断校验合格；S52、检查用户校验结果的信元内容中是否存在用户合法性校验结果；若存在，直接得到用户合法性校验结果；若不存在，则判断校验失败。实施例：本发明对5G终端的入网合法性鉴权沿用5G核心网已有注册流程。如图4，将用于使用成功注册到5G系统终端的用户合法性鉴权功能部署在本发明新增的网络融合架构中卫星核心网的用户面。卫星核心网控制面会话管理网元及用户面网元沿用现有5G会话管理网元SMF与用户面网元UPF间网络架构及协议，同时由于S-UPF对5G控制面和用户面消息采用不同转发管道，在业务面消息中携带的用于用户合法性校验的信息采用仅在控制头部分插入的方式，从而避免对业务面消息中用户业务负载部分的信息泄露。通过卫星核心网S-UPF部署的用户合法性校验功能，S-SMF下发的新的用户合法性校验结果触发条件，S-UPF可在用户及业务合法性进行校验后，由增强型业务流上报内容触发S-SMF的控制面的会话管理流程，实现了卫星中继管道对5G用户业务和用户合法性的鉴权，有效提升5G网络管道及数据网络端由于非法用户发起业务的安全防护，具体步骤如下:1、卫星核心网用户面S-UPF上部署对5G终端使用用户的合法性校验功能。该校验功能通过增强控制面下发的PFCP会话创建/修改请求中创建/更新用量上报规则消息中的上报触发信元结构，实现控制面将根据用户面对用户合法性校验的结果触发从用户面到控制面的用量上报消息。表1:PFCP会话创建修改请求中的创建/更新上报规则信元表2:上报触发条件中新增触发条件表2通过对“上报触发”信元新增触发条件“用户鉴权信息验证结果”，实现用户面部署的用户合法性校验功能通过对用户合法性进行鉴权后触发对控制面的PFCP会话上报流程。表2中上报触发条件的第7个八位组的第2个比特的“UAIVR”被设置为“1”时，指示为用户合法性校验结果触发的上报。2、当用户面收到PFCP会话创建/修改请求且“创建/更新上报规则”信元中的“上报触发条件”中第7个八位组的第2个比特的“UAIVR”被设置为“1”时，则当用户面部署的用户合法性校验功能对携带在用户面业务消息中的用于用户合法性校验的信息进行校验后，触发对控制面的检测结果上报。用户面S-UPF在PFCP会话上报请求消息中新增的“用户校验结果”用于携带用户合法性校验结果，以及新增的“用户校验信息结果报告”类型用于指示当前的PFCP Session Report Request中携带的报告内容类型为用户合法性校验结果。当报告类型中新增的第5个八位组的第8个比特“UVRR”被设置为“1”时，新增的“用户校验结果”可选的出现在PFCP会话报告请求中。表3.PFCP上报请求新增信元结构表4.新增上报类型表4中对“PFCP会话报告请求”中新增的“用户校验结果”的信元结构在表5中给出。通过设置“用户校验结果”的第5个八位组中的第1和第2比特位来实现对用户合法性校验结果的指示:-比特1–VS:当设置为"1"时,该标志位指示用户合法性信息在用户面校验成功.-比特2–VF:当设置为"1"时,该标志位指示用户合法性信息在用户面校验失败.-比特3到比特8空闲位,未使用并设置为"0".表5新增可选用户校验结果信元结构注意，即使在“PFCP Session Report Request”中“报告类型”的“用户校验结果报告类型”被设置为“1”，“用户校验结果”仍然为可选项出现在“PFCP上报请求”中。用户面S-UPF可选的仅在用户合法性信息校验失败后，通过单独设置表4中“报告类型”中的“用户校验结果类型”为“1”，而无需携带表5中新增的“用户校验结果”信元，从而实现仅在用户合法性校验失败情况下UPF对校验结果进行上报，而用户合法性校验成功情况下无需上报，从而减少控制面和用户面间信令开销。控制面只需通过用户面UPF发送的“PFCP会话报告请求”中的“报告类型”是否设置“UVRR”＝“1”来决定是否触发该用户的会话释放流程。该会话释放流程沿用现有5G系统流程。本发明一种用于5G异构网络业务安全性提升的用户面装置的实施例可以应用在任意具备数据处理能力的设备上，该任意具备数据处理能力的设备可以为诸如计算机等设备或装置。装置实施例可以通过软件实现，也可以通过硬件或者软硬件结合的方式实现。以软件实现为例，作为一个逻辑意义上的装置，是通过其所在任意具备数据处理能力的设备的处理器将非易失性存储器中对应的计算机程序指令读取到内存中运行形成的。从硬件层面而言，如图6所示，为本发明一种用于5G异构网络业务安全性提升的用户面装置所在任意具备数据处理能力的设备的一种硬件结构图，除了图6所示的处理器、内存、网络接口、以及非易失性存储器之外，实施例中装置所在的任意具备数据处理能力的设备通常根据该任意具备数据处理能力的设备的实际功能，还可以包括其他硬件，对此不再赘述。上述装置中各个单元的功能和作用的实现过程具体详见上述方法中对应步骤的实现过程，在此不再赘述。对于装置实施例而言，由于其基本对应于方法实施例，所以相关之处参见方法实施例的部分说明即可。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本发明方案的目的。本领域普通技术人员在不付出创造性劳动的情况下，即可以理解并实施。本发明实施例还提供一种计算机可读存储介质，其上存储有程序，该程序被处理器执行时，实现上述实施例中的一种用于5G异构网络业务安全性提升的用户面装置。所述计算机可读存储介质可以是前述任一实施例所述的任意具备数据处理能力的设备的内部存储单元，例如硬盘或内存。所述计算机可读存储介质也可以是任意具备数据处理能力的设备的外部存储设备，例如所述设备上配备的插接式硬盘、智能存储卡、SD卡、闪存卡等。进一步的，所述计算机可读存储介质还可以既包括任意具备数据处理能力的设备的内部存储单元也包括外部存储设备。所述计算机可读存储介质用于存储所述计算机程序以及所述任意具备数据处理能力的设备所需的其他程序和数据，还可以用于暂时地存储已经输出或者将要输出的数据。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换或改进等，均应包含在本发明的保护范围之内。
