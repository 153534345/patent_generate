标题title
一种基于领域自适应的半导体加工工艺异常检测方法
摘要abst
本发明涉及半导体生产领域，具体涉及一种基于领域自适应的半导体加工工艺异常检测方法。本发明相对于源域和目标域所在的原始空间，构建一个映射子空间，将源域和目标域对应的加工工艺数据映射到映射子空间，使源域和目标域的加工工艺数据在映射子空间中具有相似的分布，从而可以为不同设备不同时期的目标工艺的加工工艺数据建立统一的异常检测模型，以根据目标工艺的加工工艺数据预测目标工艺是否出现异常。本发明通过映射和自适应变换，使得源域和目标域的数据在映射子空间中具有相似的分布，从而使得异常检测模型能在源域和目标域都表现出良好的预测性能，有效解决了领域偏移问题，提高了模型的预测精度。
权利要求书clms
1.一种基于领域自适应的半导体加工工艺异常检测方法，根据目标工艺的加工工艺数据，预测目标工艺是否发生异常，其特征在于，包括以下步骤：步骤一，将条目标工艺的加工工艺数据及对应的监测数据分别经过数据处理得到源生产数据集/＞和源标签集/＞，源生产数据集/＞与源标签集/＞组成源域/＞；将/＞条与源生产数据集/＞中工艺相同但设备不同的工艺数据经过数据处理得到目标生产数据集/＞；以目标生产数据集/＞作为目标域/＞；步骤二，将源生产数据集与目标生产数据集/＞进行拼接得到原始空间数据矩阵/＞，定义总方差目标函数/＞，并基于原始空间数据矩阵/＞求解总方差目标函数/＞得到特征映射矩阵/＞；步骤三，使用分类器为目标域的数据生成伪标签集/＞；步骤四，定义缩小源域和目标域/＞的数据间差异的联合求解目标函数/＞；步骤五，基于原始空间数据矩阵与特征映射矩阵/＞求解联合求解目标函数/＞，将求解联合求解目标函数/＞得到的特征映射矩阵/＞作为最优自适应变换矩阵/＞；步骤六，基于最优自适应变换矩阵将源生产数据集/＞的数据进行特征映射得到映射源生产数据集/＞；基于最优自适应变换矩阵/＞将目标生产数据集/＞的数据进行特征映射得到映射目标生产数据集/＞；步骤七，基于卷积神经网络构建异常检测模型，将映射源生产数据集及源标签集/＞输入异常检测模型，对异常检测模型进行训练；基于映射目标生产数据集/＞及伪标签集/＞对异常检测模型的训练结果进行验证；得到完成训练的异常检测模型；步骤八，将目标工艺的加工工艺数据使用最优自适应变换矩阵进行特征映射后输入完成训练的异常检测模型，得到目标工艺是否异常的预测。2.根据权利要求1所述一种基于领域自适应的半导体加工工艺异常检测方法，其特征在于，步骤二具体包括：步骤二A，将源生产数据集与目标生产数据集/＞拼接得到原始空间数据矩阵/＞；步骤二B，定义总方差目标函数为：；其中，表示矩阵转置变换，/＞表示矩阵的迹操作，/＞表示单位矩阵，/＞表示约束条件为特征映射矩阵/＞是一个正交矩阵，/＞表示在满足约束条件/＞的前提下对后面的表达式求最大值，/＞表示中心矩阵：；步骤二C，求解总方差目标函数，得到特征映射矩阵/＞。3.根据权利要求1所述一种基于领域自适应的半导体加工工艺异常检测方法，其特征在于，步骤四具体包括：定义源域的数据和目标域/＞的数据边缘分布的最大均值差异为/＞，定义源域/＞的数据和目标域/＞的数据条件分布的最大均值差异为/＞，基于源域/＞的数据和目标域的数据边缘分布的最大均值差异/＞与源域/＞的数据和目标域/＞的数据条件分布的最大均值差异/＞定义联合求解目标函数/＞。4.根据权利要求3所述一种基于领域自适应的半导体加工工艺异常检测方法，其特征在于，源域的数据和目标域/＞的数据边缘分布的最大均值差异/＞为：；其中，表示矩阵转置变换，/＞表示矩阵范数，/＞表示原始空间数据矩阵/＞中第/＞条源加工工艺数据，/＞表示原始空间数据矩阵/＞中第/＞条目标加工工艺数据；定义为伪标签集/＞和源标签集/＞的一个标签类型，将源域/＞的数据和目标域/＞的数据按照标签类型各划分为两个子集，则源域/＞的数据和目标域/＞的数据条件分布的最大均值差异/＞为：；其中，表示源域/＞中标签类型为/＞的子集中源加工工艺数据的数量，/＞表示源域/＞中标签类型为/＞的子集，/＞表示目标域/＞中标签类型为/＞的子集中目标加工工艺数据的数量，/＞表示目标域/＞中标签类型为/＞的子集。5.根据权利要求4所述一种基于领域自适应的半导体加工工艺异常检测方法，其特征在于，步骤五具体包括：将源域的数据和目标域/＞的数据边缘分布的最大均值差异/＞和源域/＞的数据和目标域/＞的数据条件分布的最大均值差异/＞进行联合求解，定义联合求解目标函数为：；其中，代表正则化系数，/＞代表弗罗贝尼乌斯范数，/＞为特征映射矩阵/＞的正则项，表示在满足约束条件/＞的前提下对/＞后面的表达式求最小值，/＞表示中心矩阵；将求解联合求解目标函数得到的特征映射矩阵/＞作为最优自适应变换矩阵/＞。6.根据权利要求5所述一种基于领域自适应的半导体加工工艺异常检测方法，其特征在于，联合求解目标函数的求解方式为：计算联合求解目标函数关于特征映射矩阵/＞的偏导数；将特征映射矩阵的偏导数设为0，得到约束方程；求解约束方程得到最优自适应变换矩阵。7.根据权利要求1所述一种基于领域自适应的半导体加工工艺异常检测方法，其特征在于，步骤六具体包括：基于最优自适应变换矩阵将源生产数据集/＞的数据进行特征映射得到映射源生产数据集/＞：；基于最优自适应变换矩阵将目标生产数据集/＞的数据进行特征映射得到映射目标生产数据集/＞：。
说明书desc
技术领域本发明涉及半导体生产领域，具体涉及一种基于领域自适应的半导体加工工艺异常检测方法。背景技术半导体产品是高科技技术的一个关键组成部分，从电子产品到汽车和飞机的制造，半导体产品无处不在。半导体加工是一种复杂且精密的制造过程，涉及到多种物理和化学反应，过程复杂。半导体加工中，一个工艺对应一个生产步骤，如蚀刻，半导体加工往往需要涉及成百上千个工艺，某个工艺出现异常可能导致最终的半导体产品质量不合格，检测某个特定工艺是否出现异常对半导体加工至关重要。传统的半导体加工工艺异常检测方法采用成品检测的方法，通过测试最终加工完成的半导体产品的各项参数是否满足预定要求来实现工艺异常检测。这种方法效率低下，不能及时发现半导体加工过程中发生的工艺异常。为了解决这个问题，目前的半导体加工工艺异常检测方法通过监测加工过程来提前发现工艺异常，例如通过监测半导体加工过程中的温度，压强，光强等工艺参数的变化情况来推断是否发生了工艺异常。机器学习由于其强大的数据分析能力目前已广泛应用于半导体加工工艺异常检测领域并取得了不错的效果。具体而言，机器学习方法通过学习大量半导体加工的历史数据中的工艺正常和工艺异常时的工艺参数的变化情况，从而推理出半导体加工过程的各工艺参数在工艺异常和工艺正常的分类边界从而实现半导体加工工艺异常检测。然而，半导体加工工艺的数据通常具有领域特性。也就是说，同一个工艺的数据在不同的时间段或不同的设备之间可能会有所不同。这种现象也被称为领域偏移。例如，随着设备的老化，或者由于环境条件的变化，同一个工艺在不同时间点产生的数据可能会有所不同。现有通过机器学习构建模型以检测半导体加工工艺异常的方法都有领域偏移问题，即模型在面对不同设备、不同老化磨损程度的相同设备和新设备时，会因为这些设备的工艺参数分布和历史数据中的分布不同，导致模型的预测精度下降。发明内容为解决上述问题，本发明提供一种基于领域自适应的半导体加工工艺异常检测方法。该方法根据目标工艺的加工工艺数据，预测目标工艺是否发生异常，包括以下步骤：步骤一，将条目标工艺的加工工艺数据及对应的监测数据分别经过数据处理得到源生产数据集/＞和源标签集/＞，源生产数据集/＞与源标签集/＞组成源域/＞；将/＞条与源生产数据集/＞中工艺相同但设备不同的工艺数据经过数据处理得到目标生产数据集/＞；以目标生产数据集/＞作为目标域/＞；步骤二，将源生产数据集与目标生产数据集/＞进行拼接得到原始空间数据矩阵，定义总方差目标函数/＞，并基于原始空间数据矩阵/＞求解总方差目标函数/＞得到特征映射矩阵/＞；步骤三，使用分类器为目标域的数据生成伪标签集/＞；步骤四，定义缩小源域和目标域/＞的数据间差异的联合求解目标函数/＞；步骤五，基于原始空间数据矩阵与特征映射矩阵/＞求解联合求解目标函数/＞，将求解联合求解目标函数/＞得到的特征映射矩阵/＞作为最优自适应变换矩阵/＞；步骤六，基于最优自适应变换矩阵将源生产数据集/＞的数据进行特征映射得到映射源生产数据集/＞；基于最优自适应变换矩阵/＞将目标生产数据集/＞的数据进行特征映射得到映射目标生产数据集/＞；步骤七，基于卷积神经网络构建异常检测模型，将映射源生产数据集及源标签集/＞输入异常检测模型，对异常检测模型进行训练；基于映射目标生产数据集/＞及伪标签集/＞对异常检测模型的训练结果进行验证；得到完成训练的异常检测模型；步骤八，将目标工艺的加工工艺数据使用最优自适应变换矩阵进行特征映射后输入完成训练的异常检测模型，得到目标工艺是否异常的预测。进一步的，步骤二具体包括：步骤二A，将源生产数据集与目标生产数据集/＞拼接得到原始空间数据矩阵/＞；步骤二B，定义总方差目标函数为：；其中，表示矩阵转置变换，/＞表示矩阵的迹操作，/＞表示单位矩阵，/＞表示约束条件为特征映射矩阵/＞是一个正交矩阵，/＞表示在满足约束条件/＞的前提下对/＞后面的表达式求最大值，/＞表示中心矩阵：；步骤二C，求解总方差目标函数，得到特征映射矩阵/＞。进一步的，步骤四具体包括：定义源域的数据和目标域/＞的数据边缘分布的最大均值差异为/＞，定义源域/＞的数据和目标域/＞的数据条件分布的最大均值差异为/＞，基于源域/＞的数据和目标域/＞的数据边缘分布的最大均值差异/＞与源域/＞的数据和目标域/＞的数据条件分布的最大均值差异/＞定义联合求解目标函数/＞。进一步的，源域的数据和目标域/＞的数据边缘分布的最大均值差异/＞为：；其中，表示矩阵转置变换，/＞表示矩阵范数，/＞表示原始空间数据矩阵/＞中第/＞条源加工工艺数据，/＞表示原始空间数据矩阵/＞中第/＞条目标加工工艺数据；定义为伪标签集/＞和源标签集/＞的一个标签类型，将源域/＞的数据和目标域/＞的数据按照标签类型各划分为两个子集，则源域/＞的数据和目标域/＞的数据条件分布的最大均值差异/＞为：；其中，表示源域/＞中标签类型为/＞的子集中源加工工艺数据的数量，/＞表示源域/＞中标签类型为/＞的子集，/＞表示目标域/＞中标签类型为/＞的子集中目标加工工艺数据的数量，/＞表示目标域/＞中标签类型为/＞的子集。进一步的，步骤五具体包括：将源域的数据和目标域/＞的数据边缘分布的最大均值差异/＞和源域/＞的数据和目标域/＞的数据条件分布的最大均值差异/＞进行联合求解，定义联合求解目标函数/＞为：；其中，代表正则化系数，/＞代表弗罗贝尼乌斯范数，/＞为特征映射矩阵/＞的正则项，/＞表示在满足约束条件/＞的前提下对/＞后面的表达式求最小值，表示中心矩阵；将求解联合求解目标函数得到的特征映射矩阵/＞作为最优自适应变换矩阵/＞。进一步的，联合求解目标函数的求解方式为：计算联合求解目标函数关于特征映射矩阵/＞的偏导数；将特征映射矩阵的偏导数设为0，得到约束方程；求解约束方程得到最优自适应变换矩阵。进一步的，步骤六具体包括：基于最优自适应变换矩阵将源生产数据集/＞的数据进行特征映射得到映射源生产数据集/＞：；基于最优自适应变换矩阵将目标生产数据集/＞的数据进行特征映射得到映射目标生产数据集/＞：。本申请实施例中提供的一个或多个技术方案，至少具有如下技术效果或优点：本申请提出的基于领域自适应的半导体加工工艺异常检测方法确定一个映射子空间，通过求解最优自适应变换矩阵，将源域和目标域的数据映射到映射子空间中，使源域和目标域的数据的分布差异小于阈值。在此基础上，在映射子空间中训练一个异常检测模型同时处理映射后的源域和目标域的数据。通过映射和自适应变换，使得源域和目标域的数据在映射子空间中具有相似的分布，从而使得异常检测模型能在源域和目标域都表现出良好的预测性能，有效解决了领域偏移问题，提高了异常检测模型的预测精度。附图说明图1为本发明实施例提供的基于领域自适应的半导体加工工艺异常检测方法流程图。具体实施方式以下结合附图和具体实施例，对本发明进行详细说明，在详细说明本发明各实施例的技术方案前，对所涉及的名词和术语进行解释说明，在本说明书中，名称相同或标号相同的部件代表相似或相同的结构，且仅限于示意的目的。本发明定义源域对应目标工艺的历史加工工艺数据，即有标签的数据；目标域对应包括新设备或者旧设备在新环境下目标工艺的加工工艺数据，即无标签的数据。本发明在现有基于机器学习的半导体加工工艺异常检测方法的基础上，相对于源域和目标域所在的原始空间，构建一个映射子空间，将源域和目标域对应的目标工艺加工工艺数据映射到映射子空间，使源域和目标域的加工工艺数据在映射子空间中具有相似的分布，从而可以为不同设备不同时期的目标工艺加工工艺数据建立统一的异常检测模型，以根据目标工艺相关的加工工艺数据预测目标工艺是否出现异常。目标工艺指需要使用本发明提供的方法来检测是否出现异常的半导体加工工艺。如图1所示，本发明提供的基于领域自适应的半导体加工工艺异常检测方法主要包括映射子空间规模确定，最优自适应变换矩阵求解以及异常检测模型构建三个阶段。具体而言，具有标签的源域的加工工艺数据和无标签的目标域的加工工艺数据在特征分布方面并不相同，映射子空间规模确定阶段利用无监督方法确定映射子空间的规模大小。最优自适应变换矩阵求解阶段建立并求解最优自适应变换矩阵，使得源域的加工工艺数据和目标域的加工工艺数据在映射子空间的差异小于阈值。异常检测模型构建阶段在映射子空间构建异常检测模型，通过映射后的源域的加工工艺数据和映射后的目标域的加工工艺数据分别对异常检测模型进行训练和验证，利用完成训练的异常检测模型判断目标工艺是否出现异常。本发明的具体步骤包括：1.数据准备从半导体加工的历史数据中读取条目标工艺的加工工艺数据，加工工艺数据指半导体加工工艺参数组成的数据，如设备运行数据、生产过程数据等，将/＞条加工工艺数据经过数据处理得到源生产数据集/＞，/＞，/＞，/＞代表第/＞条源加工工艺数据，/＞的特征维度为/＞，代表每条源加工工艺数据中工艺参数的数量为/＞。从半导体加工的历史数据中读取源生产数据集中每条源加工工艺数据对应的监测数据，经过数据处理得到源标签集/＞，/＞。/＞代表第/＞条源加工工艺数据/＞对应的监测数据标签。监测数据指能够用来判断采集源加工工艺数据时目标工艺是否异常的数据，此处选用半导体产品的质量检测结果作为监测数据来解释本发明，将半导体产品的质量检测结果分为合格与不合格，对应的监测数据标签/＞也分为合格与不合格两个维度。源生产数据集与源标签集/＞共同组成源域/＞。将条与源生产数据集/＞中工艺相同但设备不同的加工工艺数据经过数据处理后作为目标加工工艺数据组成目标生产数据集/＞，/＞，/＞，/＞代表第/＞条目标加工工艺数据，/＞的特征维度为/＞，代表每条目标加工工艺数据中工艺参数的数量为/＞。以目标生产数据集/＞作为目标域/＞。2、映射子空间规模确定机器学习算法通常情况下要求输入数据和训练的数据维度一致，对于数据维度不同的数据进行验证时难以达到训练过程中的精确度，而本发明的主要任务是做迁移学习，因此需要扩充异常检测模型的泛化性，将原始空间中源域和目标域/＞的数据映射到一个固定维度的映射子空间。将源生产数据集与目标生产数据集/＞进行拼接得到原始空间数据矩阵/＞，原始空间数据矩阵/＞为/＞行，/＞列，每行对应一类工艺参数，前/＞列中每一列对应一条源加工工艺数据，后/＞列中每一列对应一条目标加工工艺数据。本发明利用主成分分析方法对原始空间数据矩阵的高维数据进行降维。定义主成分分析的总方差目标函数/＞，通过求解总方差目标函数/＞获得特征映射矩阵/＞。总方差目标函数为：；其中，表示矩阵转置变换，/＞表示矩阵的迹操作，/＞表示单位矩阵，/＞表示约束条件为特征映射矩阵/＞是一个正交矩阵，/＞表示在满足约束条件/＞的前提下对/＞后面的表达式求最大值，/＞表示中心矩阵：；通过求解总方差目标函数，得到特征映射矩阵/＞，利用特征映射矩阵/＞对维的原始空间数据矩阵/＞进行降维处理得到降维后的原始空间数据矩阵/＞，降维后的原始空间数据矩阵/＞的维度为/＞维，/＞。映射子空间规模即为维。利用特征映射矩阵对原始空间数据矩阵/＞进行降维为本领域公知常识，本发明不再赘述。3.最优自适应变换矩阵求解源域的数据和目标域/＞的数据在边缘分布和条件分布中均存在一定的差异，直接使用特征映射矩阵/＞对源域/＞的数据和目标域/＞的数据进行特征映射可能会放大源域的数据和目标域/＞的数据在边缘分布和条件分布中的差异，进而影响后续的分类结果。本发明应用领域自适应技术来缩小源域/＞的数据和目标域/＞的数据差异，以通过找到一个最优的映射方式，使得源域/＞的数据和目标域/＞的数据在映射子空间中的分布尽可能接近。缩小源域的数据和目标域/＞的数据差异可以分别通过边缘分布适配和条件分布适配实现。定义源域/＞的数据和目标域/＞的数据边缘分布的最大均值差异为/＞，定义源域/＞的数据和目标域/＞的数据条件分布的最大均值差异为/＞。源域的数据和目标域/＞的数据边缘分布的最大均值差异/＞为：；其中，表示矩阵范数，/＞表示原始空间数据矩阵/＞中第/＞条源加工工艺数据，/＞表示原始空间数据矩阵/＞中第/＞条目标加工工艺数据。计算源域的数据和目标域/＞的数据条件分布的最大均值差异/＞前，需要使用分类器为目标域/＞的数据生成伪标签集/＞。本发明选用k-NN算法作为分类器为目标域/＞的数据生成伪标签集/＞。如何使用k-NN算法对数据进行分类并生成伪标签集为本领域公知常识，本发明不再赘述。目标域的伪标签集/＞与源标签集/＞一样，也分为合格与不合格两个维度。定义/＞为伪标签集/＞和源标签集/＞的一个标签类型。将源域/＞的数据和目标域/＞的数据按照标签类型各划分为两个子集，则源域/＞的数据和目标域/＞的数据条件分布的最大均值差异为：；其中，表示源域/＞中标签类型为/＞的子集中源加工工艺数据的数量，/＞表示源域/＞中标签类型为/＞的子集，/＞表示目标域/＞中标签类型为/＞的子集中目标加工工艺数据的数量，/＞表示目标域/＞中标签类型为/＞的子集。将源域的数据和目标域/＞的数据边缘分布的最大均值差异/＞和源域/＞的数据和目标域/＞的数据边缘分布的最大均值差异/＞进行联合求解，定义联合求解目标函数/＞为：；其中，代表正则化系数，/＞代表弗罗贝尼乌斯范数，/＞为特征映射矩阵/＞的正则项，/＞表示在满足约束条件/＞的前提下对/＞后面的表达式求最小值。联合求解目标函数的求解方式为计算联合求解目标函数/＞关于特征映射矩阵/＞的偏导数；将特征映射矩阵/＞的偏导数设为0，得到约束方程；求解约束方程得到最优自适应变换矩阵/＞。基于最优自适应变换矩阵将源生产数据集/＞的数据映射到映射子空间中得到映射源生产数据集/＞：；基于最优自适应变换矩阵将目标生产数据集/＞的数据映射到映射子空间中得到映射目标生产数据集/＞：。源生产数据集中第/＞条源加工工艺数据/＞在映射子空间中被映射为映射源生产数据集/＞中的第/＞条源映射工艺数据/＞。目标生产数据集/＞中第/＞条目标加工工艺数据/＞在映射子空间中被映射为映射目标生产数据集/＞中的第/＞条目标映射工艺数据/＞。4.异常检测模型构建本发明基于卷积神经网络构建异常检测模型。将映射源生产数据集及源标签集输入异常检测模型，对异常检测模型进行训练。基于映射目标生产数据集及伪标签集/＞对异常检测模型的训练结果进行验证。最终，得到完成训练的异常检测模型。卷积神经网络的构建、训练与验证为本领域公知常识，本发明不再赘述。5.加工工艺异常监测将半导体加工过程中采集得到的目标工艺的加工工艺数据映射到映射子空间后输入完成训练的异常检测模型，得到目标工艺是否异常的预测。以上所述实施方式仅仅是对本发明的优选实施方式进行描述，并非对本发明的范围进行限定，在不脱离本发明设计精神的前提下，本领域普通技术人员对本发明的技术方案做出的各种变形和改进，均应落入本发明的权利要求书确定的保护范围内。
