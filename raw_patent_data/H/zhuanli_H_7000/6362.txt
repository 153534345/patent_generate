标题title
一种综合能源系统下基于状态转移的多目标预测方法
摘要abst
一种综合能源系统下基于状态转移的多目标预测方法，属于综合能源系统的数据预测技术领域，解决综合能源系统下多目标预测方法参数敏感性的问题，预测电力负荷和太阳能发电，缓解综合能源系统中电力需求供给的不匹配现象；本发明首先将输入数据经FPCA算法分解，提取数据的总体趋势并识别其主要的变化模式，然后计算所有预测特征之间的状态转移矩阵，判断预测目标之间是否存在相关信息；基于状态转移矩阵，分析各个状态变量对其余状态变量预测的影响程度；最后通过状态转移方程输出预测结果；提取综合能源系统中各个部分耦合特征的能力强、预测精度高。
权利要求书clms
1.一种综合能源系统下基于状态转移的多目标预测方法，其特征在于，包括以下步骤：S1、输入的综合能源系统不同预测目标历史数据，构建FPCA分解算法来提取数据的总体趋势并识别变化模式；所述的构建FPCA分解算法来提取数据的总体趋势并识别变化模式的方法如下：设为综合能源系统中某一预测目标的第i条观测曲线，其中，i=1，…，N,N为日曲线条数，t=1，…，T,T为每条曲线的观测时间点数；则所述的FPCA分解算法表示为：其中，K表示特征函数的数量；表示均值函数，即观测曲线的总体变化趋势；/＞表示特征函数；/＞表示信号特征，表示与/＞对应的FPC scores，其为独立随机变量，均值为零，方差为/＞；/＞服从标准正态分布；S2、通过构建状态转移方程来挖掘综合能源系统中多个预测目标之间的耦合效应；S3、输出电力负荷和太阳能发电的预测结果。2.根据权利要求1所述的综合能源系统下基于状态转移的多目标预测方法，其特征在于，所述的特征函数的数量K的估计公式如下：其中，表示特征函数的数量K的估计最小值。3.根据权利要求2所述的一种综合能源系统下基于状态转移的多目标预测方法，其特征在于，所述的均值函数与特征函数/＞的估计公式如下：其中，表示/＞的期望；/＞表示综合能源系统中某一预测目标的观测曲线。4.根据权利要求3所述的一种综合能源系统下基于状态转移的多目标预测方法，其特征在于，所述的特征函数与方差/＞的估计公式如下：其中，表示/＞的协方差，/＞服从/＞，且当m＜k时，/＞。5.根据权利要求4所述的一种综合能源系统下基于状态转移的多目标预测方法，其特征在于，步骤S2中所述的构建状态转移方程的方法如下：以提取的FPC scores作为状态变量，公式如下：其中,表示综合能源系统中第1部分在第i天的第1个FPC scores；/＞表示综合能源系统中第i部分在第i天的第K个FPC scores；/＞表示综合能源系统中第j部分在第i天的第1个FPC scores；/＞表示综合能源系统中第j部分在第i天的第K个FPC scores；基于多元状态变量，建立的状态转移方程如下：其中，、/＞、/＞均为/＞的向量；/＞服从标准正态分布，即/＞；c是一个常数矩阵，反映了状态变量中不随时间变化的底层信息；A、B表示状态转移矩阵，分别描述了状态变量从时间点/＞和/＞到/＞的转移关系；建立参数估计算法，获取参数A、B、c、，具体流程如下：设有一组训练数据，依据公式，/＞的分布为n维多元正态分布，令，则/＞的分布表述为：然后根据公式计算训练集中第i天的对数似然函数为：进而根据公式计算整个训练集的对数似然函数为：最后采用期望最大化估计未知参数，具体公式如下：获取参数后，通过公式预测未来的状态变量，然后基于已经提取的均值函数和特征函数，依据公式计算预测值。6.根据权利要求5所述的综合能源系统下基于状态转移的多目标预测方法，其特征在于，所述的预测结果的评价指标的计算公式如下：其中，表示电力负荷的平均绝对百分比误差；/＞表示太阳能发电的平均绝对百分比误差；/＞表示标准化均方根误差；/＞和/＞分别表示实际的电力负荷和太阳能发电；/＞和/＞分别表示预测的电力负荷和太阳能发电；/＞和/＞分别表示实际值和预测值；/＞和/＞分别表示最大的实际值和最小的实际值。
说明书desc
技术领域本发明属于综合能源系统的数据预测技术领域，涉及一种综合能源系统下基于状态转移的多目标预测方法。背景技术随着化石燃料的严重滥用和环境问题的日益突出，可再生能源的应用规模大幅度提升。综合能源系统作为容纳大规模可再生能源和实现环境可持续性的有效途径，是重要举措。然而，可再生能源的间歇性和波动性，使其无法像传统化石能源发电稳定。因此，必须对电力负荷和可再生能源发电进行高质量的预测，以提高能源利用效率和维护综合能源系统的安全稳定运行。近年来，由于深度学习方法强大的大数据环境下非线性复杂结构的揭示能力，从而可以更全面地描述时间序列的变化，进而准确地建立未来一段时间预测目标的变化与历史数据的映射关系。然而，大多数深度学习方法仅仅关注综合能源系统中的单目标预测，例如负荷预测或者风力发电预测，忽视了各目标之间的相关信息，进而导致较低的预测精度。为了解决这个问题，研究人员针对多目标预测进行了一些探索。现有技术中文献《An integrated decision support system for multi-targetforecasting: A case study of energy load prediction for a solar-poweredresidential house》和文献《Data driven model improved by multi-objective optimisation for prediction of building energy loads》以及文献《Comparing deep learning models for multi energy vectors prediction onmultiple types of building》中均提出了基于信息融合技术的多目标预测方法。获取综合能源系统中各个部分的历史数据后，利用神经网络单元对每个目标序列进行特征提取，然后赋予每个目标特征不同的权重，通过多目标优化算法优化参数，最后将融合后的特征送入不同的完全连接层，用于不同目标的预测。从上述的文献调研结果来看，还存在一些尚未解决的问题。首先，受限于“黑箱”性质，目前这些结合了深度学习的方法不能解释综合能源系统中各个目标的耦合效应机理。其次，现有方法通常需要结合优化算法选择合适的模型参数来解决参数敏感性问题，但这会增加预测的复杂性、计算成本和时间，并限制其鲁棒性和稳定性。发明内容本发明的技术方案用于解决综合能源系统下多目标预测方法参数敏感性的问题，预测电力负荷和太阳能发电，缓解综合能源系统中电力需求供给的不匹配现象。本发明是通过以下技术方案解决上述技术问题的：一种综合能源系统下基于状态转移的多目标预测方法，包括以下步骤：S1、输入的综合能源系统不同预测目标历史数据，构建FPCA分解算法来提取数据的总体趋势并识别变化模式；S2、通过构建状态转移方程来挖掘综合能源系统中多个预测目标之间的耦合效应；S3、输出电力负荷和太阳能发电的预测结果。进一步地，步骤S1中所述的构建FPCA分解算法来提取数据的总体趋势并识别变化模式的方法如下：设为综合能源系统中某一预测目标的第i条观测曲线，其中，i=1，…，N,N为日曲线条数，t=1，…，T,T为每条曲线的观测时间点数；则所述的FPCA分解算法表示为：其中，K表示特征函数的数量；表示均值函数，即观测曲线的总体变化趋势；表示特征函数；/＞表示信号特征，表示与/＞对应的FPC scores，其为独立随机变量，均值为零，方差为/＞；/＞服从标准正态分布。进一步地，所述的特征函数的数量K的估计公式如下：其中，表示特征函数的数量K的估计最小值。进一步地，所述的均值函数与特征函数/＞的估计公式如下：其中，表示/＞的期望；/＞表示综合能源系统中某一预测目标的观测曲线。进一步地，所述的特征函数与方差/＞的估计公式如下：其中，表示/＞的协方差，/＞服从/＞，且当m＜k时，/＞。进一步地，步骤S2中所述的构建状态转移方程的方法如下：以提取的FPC scores作为状态变量，公式如下：其中,表示综合能源系统中第1部分在第i天的第1个FPC scores；/＞表示综合能源系统中第i部分在第i天的第K个FPC scores；/＞表示综合能源系统中第j部分在第i天的第1个FPC scores；/＞表示综合能源系统中第j部分在第i天的第K个FPC scores；基于多元状态变量，建立的状态转移方程如下：其中，、/＞、/＞均为/＞的向量；/＞服从标准正态分布，即/＞；c是一个常数矩阵，反映了状态变量中不随时间变化的底层信息；A、B表示状态转移矩阵，分别描述了状态变量从时间点/＞和/＞到/＞的转移关系；建立参数估计算法，获取参数A、B、c、，具体流程如下：设有一组训练数据，依据公式，/＞的分布为n维多元正态分布，令，则/＞的分布表述为：然后根据公式计算训练集中第i天的对数似然函数为：进而根据公式计算整个训练集的对数似然函数为：最后采用期望最大化估计未知参数，具体公式如下：获取参数后，通过公式预测未来的状态变量，然后基于已经提取的均值函数和特征函数，依据公式计算预测值。进一步地，所述的预测结果的评价指标的计算公式如下：其中，表示电力负荷的平均绝对百分比误差；/＞表示太阳能发电的平均绝对百分比误差；/＞表示标准化均方根误差；/＞和/＞分别表示实际的电力负荷和太阳能发电；/＞和/＞分别表示预测的电力负荷和太阳能发电；/＞和分别表示实际值和预测值；/＞和/＞分别表示最大的实际值和最小的实际值。本发明的优点在于：本发明首先将输入数据经FPCA算法分解，提取数据的总体趋势并识别其主要的变化模式，然后计算所有预测特征之间的状态转移矩阵，判断预测目标之间是否存在相关信息；基于状态转移矩阵，分析各个状态变量对其余状态变量预测的影响程度；最后通过状态转移方程输出预测结果；提取综合能源系统中各个部分耦合特征的能力强、预测精度高。附图说明图1是本发明方法的流程示意图；图2是本发明方法的FPCA分解算法的流程示意图；图3是本发明方法的参数估计算法的流程示意图；图4是某综合能源系统数据集某个时间段每天的电力负荷；图4是某综合能源系统数据集某个时间段每天的太阳能发电曲线；图5是某综合能源系统数据集某个时间段的状态转移矩阵；图6是某综合能源系统数据集2月份典型电力负荷模式的预测曲线效果；图6是某综合能源系统数据集6月份典型电力负荷模式的预测曲线效果；图6是某综合能源系统数据集8月份典型电力负荷模式的预测曲线效果；图6是某综合能源系统数据集2月份典型太阳能发电模式的预测曲线效果；图6是某综合能源系统数据集3月份典型太阳能发电模式的预测曲线效果；图6是某综合能源系统数据集8月份典型太阳能发电模式的预测曲线效果。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。下面结合说明书附图以及具体的实施例对本发明的技术方案作进一步描述：实施例一如图1所示，本实施例的综合能源系统下基于状态转移的多目标预测方法的主要内容如下：首先构建了非参数函数主成分分析来提取不同预测目标历史数据的总体趋势并识别主要的变化模式，然后通过状态转移矩阵挖掘不同预测目标之间的耦合效应并提取耦合特征，进而通过状态转移方程建立预测目标与特征之间的映射关系，最后输出电力负荷和可再生能源发电的预测值。1、FPCA分解算法FPCA分解算法能够识别原始数据模式变化的重要部分，帮助预测方法获得稳定的预测趋势，并且可以使其适应不同的数据变化模式，提高预测方法的稳定性和鲁棒性。同时，其非参数特性有效地避免了参数敏感性问题。此外，FPCA可以将高维数据转换为一组功能主成分分数，进而为其提供简洁的低维表示方法，从而有效降低计算成本。如图2所示，构建FPCA分解算法提取综合能源系统中各个部分的特征的方法如下：假设为综合能源系统中某一预测目标的观测曲线，其中，i=1，…，N,N为日曲线条数，t=1，…，T,T为每条曲线的观测时间点数；其FPCA分解算法表示为：其中，K表示特征函数的数量；表示均值函数，即观测曲线的总体趋势；/＞表示特征函数；/＞是信号特征，表示与/＞对应的FPC scores，其为独立随机变量，均值为零，方差为/＞；/＞服从标准正态分布。K可以通过公式估计；和/＞可以通过公式和估计；/＞和/＞可以通过特征方程公式估计。其中，服从/＞，且当m＜k时，/＞。其中，表示/＞的期望；/＞表示综合能源系统中某一预测目标的观测曲线，例如电力负荷或者太阳能发电曲线；/＞表示/＞的协方差，/＞服从/＞，且当m＜k时，/＞。2、基于状态转移的多目标预测方法通过构建状态转移方程来挖掘综合能源系统中各个预测目标之间的耦合效应。在方法框架中，以提取的FPC scores作为状态变量，表述为公式。其中,表示综合能源系统中第1部分在第i天的第1个FPC scores；/＞表示综合能源系统中第i部分在第i天的第K个FPC scores；/＞表示综合能源系统中第j部分在第i天的第1个FPC scores；/＞表示综合能源系统中第j部分在第i天的第K个FPC scores。基于多元状态变量，建立的状态转移方程如下：其中，是一个/＞的向量，n表示状态变量个数；/＞服从标准正态分布，即；c是一个常数矩阵，反映了状态变量中不随时间变化的底层信息；A、B表示状态转移矩阵，分别描述了状态变量从时间点/＞和/＞到/＞的转移关系。特别地，为了使公式中的矩阵具有可计算性，A、B和c的大小必须为，/＞和/＞。其中A和B为状态转移矩阵，描述状态变量在不同时间的状态转移关系。如果状态转移矩阵为对角矩阵，表明状态变量之间不存在耦合效应，即各个预测目标之间不存在相关信息。但是，一旦状态转移矩阵为非对角矩阵，此时耦合效应就不能被忽视，即各个状态变量对其余状态变量的预测有影响，且这种影响程度可以通过状态转移矩阵中的元素描述。在实际应用中，这些方法参数不能直接获取，因此需要进一步建立参数估计算法，其流程如图3所示。首先假设有一组训练数据，依据公式，/＞的分布为n维多元正态分布。令，则/＞的分布可以表述为：然后根据公式计算训练集中第i天的对数似然函数。进而根据公式计算整个训练集的对数似然函数最后采用期望最大化算法估计未知参数，具体公式如下：获取方法参数后，通过公式预测未来的状态变量，然后基于已经提取的均值函数和特征函数，依据公式计算预测值。3、试验验证实验数据来自某综合能源系统数据集，采样间隔为5分钟。从中选取了2020年1月1日至2021年12月31日的电力负荷和太阳能发电数据，用于验证综合能源系统下基于状态转移的多目标预测方法的有效性。图4描绘了某个时间段每天的电力负荷和太阳能发电曲线。图5展示了该综合能源管理系统中电力负荷和太阳能发电的状态转移矩阵，其元素数值大小表示各个状态变量对其余状态变量预测的影响程度。可以观察到，这是一个非对角矩阵，因此预测目标之间存在相关信息。这些现象证实了电力负荷和太阳能发电之间存在耦合效应。因此本发明的方法可以有效地挖掘数据之间的相关信息，进一步提高预测精度。公式、公式和公式给出了预测效果的评价指标。表1展示了本发明的方法在某综合能源系统数据集的表现结果，图6至图6展示了本发明的方法在不同月份的典型电力负荷模式的预测曲线效果及典型太阳能发电模式的预测曲线效果，可以观察到，本发明的方法总体上能够很好地预测电力负荷和太阳能发电曲线，预测误差在不同月份都能控制在较低的水平。由于本发明的方法可以识别不同的数据变化模式，因此其在不同数据模式下都能取得较好的预测结果。其中，表示电力负荷的平均绝对百分比误差；/＞表示太阳能发电的平均绝对百分比误差；/＞表示标准化均方根误差；/＞和/＞分别表示实际的电力负荷和太阳能发电；/＞和/＞分别表示预测的电力负荷和太阳能发电；/＞和分别表示实际值和预测值；/＞和/＞分别表示最大的实际值和最小的实际值。表1 本发明的方法在某综合能源系统数据集的表现结果4、结论本发明的方法整体上分为特征提取和状态转移两个部分。首先将输入数据经FPCA算法分解，提取数据的总体趋势并识别其主要的变化模式，然后计算所有预测特征之间的状态转移矩阵，判断预测目标之间是否存在相关信息。基于状态转移矩阵，分析各个状态变量对其余状态变量预测的影响程度。最后通过状态转移方程输出预测结果。解决了综合能源系统下多目标预测方法参数敏感性问题：针对现有多目标预测方法的不足进行了改进。原有方法受限于人工或经验选择参数，导致其结果波动性较大，进而需要结合优化算法选择合适的模型参数，但这会增加预测方法的复杂性、计算成本和时间。因此，原有方法在处理复杂多变数据进行特征提取方面存在困难。针对该问题，我们引入了一个非参数特征提取模型，该模型能够有效地解决原有方法的通病，不仅能够通过提取数据的总体趋势并识别其主要的变化模式，使预测方法可以适应不同的数据变化模式，有效地增强了特征提取方法在面对复杂多变数据的泛化能力，而且可以通过将高维数据转化为低维数据，进而有效地降低计算复杂性。提取综合能源系统中各个部分耦合特征的能力强、预测精度高：基于状态转移方程，充分考虑了各个预测目标之间的耦合效应对预测任务的影响。通过状态转移矩阵判断预测目标之间是否存在相关信息，并通过其元素描述各个状态变量对其余状态变量预测的影响程度。最后通过状态空间方程对耦合特征进行融合并输出预测结果。因此，该方法可以提取到各个预测目标之间存在的相关信息，并提供精确的预测结果。以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中，部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
