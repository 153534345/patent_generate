标题title
短路检测方法和充电系统
摘要abst
本发明涉及开关电容变换器技术领域，具体涉及一种开关电容转换器的短路检测方法和充电系统，该方法包括在第一短路检测步骤中，通过将在所述第三开关和所述上部电路的公共节点上的电压与第一预设参考电压进行比较，确定所述第三开关是否短路；以及在通过第一短路检测步骤后，在第二短路检测步骤中，通过将在所述第一开关和所述第二开关的公共节点上的电压分别与第二预设参考电压和第三预设参考电压进行比较，确定所述第一开关和所述第二开关是否短路。通过上述方式，能够提高短路检测的可靠性。
权利要求书clms
1.一种短路检测方法，其特征在于，用于开关电容变换器，所述开关电容变换器包括串联连接在地和输入电压总线之间的第一开关、第二开关、第三开关和上部电路，以及连接在所述第一开关和所述第二开关的第一公共节点、所述第三开关和所述上部电路的第二公共节点之间的第一飞跨电容，其中，所述第二开关和所述第三开关的公共节点为所述开关电容变换器的输出端，所述开关电容变换器被配置为通过所述输出端为电池充电，所述上部电路包括至少一个开关；所述方法包括：将所述开关电容变换器的输出端连接到电池；在第一短路检测步骤中，通过比较所述第二公共节点上的电压与第一预设参考电压，确定所述第三开关是否短路；以及，在通过所述第一短路检测步骤后，在第二短路检测步骤中，通过比较所述第一公共节点上的电压与第二预设参考电压，确定所述第一开关是否短路，以及，通过比较所述第一公共节点上的电压与第三预设参考电压，确定所述第二开关是否短路。2.根据权利要求1所述的方法，其特征在于，还包括：在通过所述第二短路检测步骤后，导通所述第三开关；以及，在第三短路检测步骤中，通过比较所述第一公共节点上的电压与第四预设参考电压，确定所述第一飞跨电容是否短路。3.根据权利要求2所述的方法，其特征在于，所述通过比较所述第一公共节点上的电压与第四预设参考电压，确定所述第一飞跨电容是否短路，包括：导通所述第一公共节点和地，以为所述第一公共节点放电；以及，在预设的飞跨电容短路检测时间后，将所述第一公共节点上的电压与所述第四预设参考电压进行比较，以确定所述第一飞跨电容是否短路。4.根据权利要求1所述的方法，其特征在于，还包括：在执行所述第一短路检测步骤之前，通过电阻将所述第二公共节点上的电压放电到地。5.根据权利要求1所述的方法，其特征在于，其中：在所述第二短路检测步骤的第一子步骤中，导通所述电池和所述第一公共节点，以为所述第一公共节点充电；在预设的第一开关短路检测时间后，将所述第一公共节点上的电压与所述第二预设参考电压进行比较，以确定所述第一开关是否短路。6.根据权利要求5所述的方法，其特征在于，所述第一子步骤中，在导通所述电池和所述第一公共节点，以为所述第一公共节点充电之前，所述第一子步骤还包括：导通所述第一公共节点和地，以为所述第一公共节点放电，并持续预设的第一开关测试时间。7.根据权利要求1所述的方法，其特征在于，其中：在所述第二短路检测步骤的第二子步骤中，导通所述第一公共节点和地，以为所述第一公共节点放电；在预设的第二开关短路检测时间后，将所述第一公共节点上的电压与所述第三预设参考电压进行比较，以确定所述第二开关是否短路。8.根据权利要求1-7任一项所述的方法，其特征在于，其中：所述第三开关包括连接在所述第三开关的漏极和体端子之间的第一二极管，以及连接在所述第三开关的源极和体端子之间的第二二极管，且所述第一二极管和所述第二二极管为背对背连接，且通过调整所述第三开关的体端子处的电压电位来控制所述第三开关的导通特性。9.根据权利要求1所述的方法，其特征在于， 所述开关电容变换器还包括串联连接在所述地和输出端之间的第四开关和第五开关，以及连接在所述第四开关和所述第五开关的第三公共节点和所述上部电路之间的第二飞跨电容。10.根据权利要求9所述的方法，其特征在于，其中：在所述第二短路检测步骤的第一子步骤中，导通所述第一公共节点和所述电池，以对所述第一公共节点充电，以及，导通所述第三公共节点和地，以为所述第三公共节点放电；在预设的第一开关短路检测时间后，将在所述第一公共节点上的电压与所述第二预设参考电压进行比较，以确定所述第一开关是否短路，并将所述第三公共节点上的电压与所述第三预设参考电压进行比较，以确定所述第五开关是否短路。11.根据权利要求9所述的方法，其特征在于，其中：在所述第二短路检测步骤的第二子步骤中，导通所述第一公共节点和地，以为所述第一公共节点放电，以及，导通所述第三公共节点和电池，以为所述第三公共节点充电；在预设的第二开关短路检测时间后，将所述第一公共节点上的电压与所述第三预设参考电压进行比较，以确定所述第二开关是否短路，并将所述第三公共节点上的电压与所述第二预设参考电压进行比较，以确定所述第四开关是否短路。12.根据权利要求10所述的方法，其特征在于，所述上部电路包括串联连接在所述输入电压总线和所述第二公共节点之间的至少一个开关；在所述第二短路检测步骤的第一子步骤中，将在所述第一公共节点上的电压与所述第二预设参考电压进行比较，还能确定所述上部电路中与所述输入电压总线相邻的开关是否短路。13.根据权利要求11所述的方法，其特征在于，其中：所述上部电路包括串联连接在所述输入电压总线和所述第二公共节点之间的至少一个开关；所述至少一个开关至少包括第六开关、第七开关和第八开关；所述第二飞跨电容连接在所述第三公共节点、所述第六开关和所述第七开关的公共节点之间，所述开关电容变换器还包括连接在所述第一公共节点、所述第七开关和所述第八开关的公共节点之间的第三飞跨电容；在所述第二子步骤中，将所述第一公共节点上的电压与所述第三预设参考电压进行比较，还确定所述第六开关和/或所述第七开关是否短路。14.一种充电系统，其特征在于，包括：开关电容变换器，其包括串联连接在地和输入电压总线之间的第一开关、第二开关、第三开关和上部电路，以及连接在所述第一开关和所述第二开关的第一公共节点、所述第三开关和所述上部电路的第二公共节点之间的第一飞跨电容，其中，所述第二开关和所述第三开关的公共节点为所述开关电容变换器的输出端，所述开关电容变换器被配置为通过所述输出端为电池充电，所述上部电路包括至少一个开关；以及，第一专用电路，所述第一专用电路包括第一控制开关和第一电阻，连接在所述第一公共节点以及地之间，且所述第一专用电路被配置为为所述第一公共节点放电，以进行短路检测。15.根据权利要求14所述的系统，其特征在于，还包括：第二专用电路，其包括第二电阻和第二控制开关，连接在所述第一公共节点以及所述输出端之间，且所述第二专用电路被配置为使电池为所述第一公共节点充电，以进行短路检测：控制单元，包括至少一个处理器，以及，与所述至少一个处理器通信连接的存储器，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1至8任一项所述的方法；其中，所述控制单元通过控制所述第一控制开关导通，为所述第一公共节点放电，通过控制所述第二控制开关导通，使电池为所述第一公共节点充电。16.根据权利要求15所述的系统，其特征在于，所述开关电容变换器还包括串联连接在所述地和输出端之间的第四开关和第五开关，以及连接在所述第四开关和所述第五开关的第三公共节点和所述上部电路之间的第二飞跨电容；所述控制单元还用于执行权利要求10或11所述的方法。17.根据权利要求16所述的系统，其特征在于，所述上部电路包括串联连接在所述输入电压总线和所述第二公共节点之间的至少一个开关；所述控制单元还用于执行权利要求12所述的方法。18.根据权利要求17所述的系统，其特征在于，所述上部电路中的至少一个开关至少包括第六开关、第七开关和第八开关；所述第二飞跨电容连接在所述第三公共节点、所述第六开关和所述第七开关的公共节点之间，所述开关电容变换器还包括连接在所述第一公共节点、所述第七开关和所述第八开关的公共节点之间的第三飞跨电容；所述控制单元还用于执行权利要求13所述的方法。
说明书desc
技术领域本发明涉及开关电容变换器技术领域，特别是涉及一种开关电容变换器的短路检测方法和充电系统。背景技术随着技术的进一步发展，诸如移动电话、平板电脑、数码相机、MP3播放器等的各种便携式设备已经变得流行。每个便携式设备可以使用一个或多个可充电电池单元以形成用于存储电能的可充电电池组。随着功耗变得越来越重要，缩短电池充电时间的需求日益明显。快速充电已成为满足消费者不断变化的需求的真正解决方案。在快速充电系统中，可以使用开关电容转换器向电池提供高电流，同时保持低输入电流。开关电容变换器具有多个优点，包括变换器单片集成无需外接电感器、功率变换效率高等。开关电容转换器能够实现对大容量电池的安全快速充电。在快充系统中，短路检测测试对于保证电池和电池充电系统的安全性和长期可靠性至关重要。短路检测测试对于开关电容转换器尤为重要，因为开关电容转换器的电源开关通常具有超低电阻。现有的短路检测可靠性较低。发明内容本发明实施例旨在提供一种开关电容转换器的短路检测方法和充电系统，能够提高短路检测的可靠性。为实现上述目的，第一方面，本发明提供一种短路检测方法，用于开关电容变换器，所述开关电容变换器包括串联连接在地和输入电压总线之间的第一开关、第二开关、第三开关和上部电路，以及连接在所述第一开关和所述第二开关的第一公共节点、所述第三开关和所述上部电路的第二公共节点之间的第一飞跨电容，其中，所述第二开关和所述第三开关的公共节点为所述开关电容变换器的输出端，所述开关电容变换器被配置为通过所述输出端为电池充电，所述上部电路包括至少一个开关；所述方法包括：将所述开关电容变换器的输出端连接到电池；在第一短路检测步骤中，通过比较所述第二公共节点上的电压与第一预设参考电压，确定所述第三开关是否短路；以及，在通过所述第一短路检测步骤后，在第二短路检测步骤中，通过比较所述第一公共节点上的电压与第二预设参考电压，确定所述第一开关是否短路，以及，通过比较所述第一公共节点上的电压与第三预设参考电压，确定所述第二开关是否短路。第二方面，本发明提供一种充电系统，该系统包括：开关电容变换器，其包括串联连接在地和输入电压总线之间的第一开关、第二开关、第三开关和上部电路，以及连接在所述第一开关和所述第二开关的第一公共节点、所述第三开关和所述上部电路的第二公共节点之间的第一飞跨电容，其中，所述第二开关和所述第三开关的公共节点为所述开关电容变换器的输出端，所述开关电容变换器被配置为通过所述输出端为电池充电，所述上部电路包括至少一个开关；以及，第一专用电路，所述第一专用电路包括第一控制开关和第一电阻，连接在所述第一公共节点以及地之间，且所述第一专用电路被配置为为所述第一公共节点放电，以进行短路检测。所述系统还包括：第二专用电路，其包括第二电阻和第二控制开关，连接在所述第一公共节点以及所述输出端之间，且所述第二专用电路被配置为为所述第一公共节点充电，以进行短路检测：控制单元，包括至少一个处理器，以及，与所述至少一个处理器通信连接的存储器，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行上述第一方面所述的方法；其中，所述控制单元通过控制所述第一控制开关导通，为所述第一公共节点放电，通过控制所述第二控制开关导通，为所述第一公共节点充电。本发明实施例的有益效果是：本发明实施例提供的短路检测方法包括：在第一短路检测步骤中，通过将所述第三开关和所述上部电路的公共节点上的电压与第一预设参考电压进行比较，确定所述第三开关是否短路；以及，在通过第一短路检测步骤后，在第二短路检测步骤中，通过将所述第一开关和所述第二开关的公共节点上的电压分别与第二预设参考电压和第三预设参考电压进行比较，确定所述第一开关和所述第二开关是否短路。通过上述方式，能够提高短路测试的可靠性。附图说明为了更全面地理解本公开及其优点，现在结合附图参考以下描述，图中：图1示出开关电容转换器的一个实施例的电路结构示意图；图2示出本发明实施例开关电容转换器的等效电路结构示意图；图3示出本发明实施例中的短路检测装置的示意图；图4示出本发明实施例中的短路检测装置的电路结构示意图；图5示出本发明实施例中弱下拉电路结构示意图；图6示出本发明实施例中弱下拉电路结构示意图；图7示出开关电容变换器的一个实施例的电路结构示意图；图8示出开关电容变换器的一个实施例的等效电路图；图9示出了开关电容变换器的一种短路检测装置的电路结构示意图；图10示出了本发明实施例中的弱下拉电路的电路结构示意图；图11示出开关电容变换器的一个实施例的电路结构示意图；图12示出开关电容变换器的一个实施例的等效电路图；图13示出了开关电容变换器的一种短路检测装置的电路结构示意图；图14示出了本发明实施例中的弱下拉电路的电路结构示意图；图15a、图15b示出了本发明各实施例的双相开关电容电路拓扑的广义模型；图16示出了本发明短路检测方法的一个实施例的流程示意图。除非另外指示，否则不同图中的对应数字和符号一般指对应部分。绘制附图是为了清楚地说明各种实施例的相关方面，它们不一定按比例绘制。具体实施方式下文详细论述目前较佳的实施例的制作和使用。但是，应明白，本公开提供可在各种各样的特定背景中实施的许多适用的发明概念。论述的特定实施例只是说明制作和使用本公开的特定方式，而不是限制本公开的范围。本发明将结合具体的优选实施例，即开关电容变换器的短路检测装置进行说明。然而，本发明也可以应用于各种功率变换器。在下文中，将参考附图详细解释各种实施例。图１图示了根据本公开不同实施例的双相2:1开关电容变换器。第一相包括开关Q4A、Q3A、Q2A和Q1A，这些开关串联连接在VIN和地之间。第一相还包括飞跨电容C1A，该电容器连接在开关Q4A和Q3A的公共节点与开关Q2A和Q1A的公共节点之间。第二相包括开关Q4B、Q3B、Q2B和Q1B，这些开关串联连接在VIN和地之间。第二相还包括飞跨电容C1B，该电容器连接在开关Q4B和Q3B的公共节点与开关Q2B和Q1B的公共节点之间。第一相的开关Q3A和第二相的开关Q3B被配置为体端子可变开关。在开关电容变换器通电之前，这两个开关Q3A和Q3B的体端子连接到它们各自的漏极。如图１所示，开关Q3A包括第一二极管和第二二极管，第一二极管连接在开关Q3A的漏极和体端子之间，第二二极管连接在开关Q3A的源极和体端子之间。开关Q3A的两个二极管背靠背连接。如图１所示，第一二极管和第二二极管的阳极均连接到开关Q3A的体端子。其中，体端子是指开关结构中半导体材料的主体部分，能通过改变其电位来控制开关的导通特性。在本实施例中，开关Q3A的导通特性由体端子控制电路通过调整开关Q3A的体端子的电位来控制。Q3B的结构类似于Q3A，因此在此不再讨论。在正常操作中，开关Q1A、Q3A、Q2B、Q4B以及开关Q1B、Q3B、Q2A、Q4A交替地以50%的占空比导通和关断，以实现与单相2:1开关电容电路相比，两倍的电流输出和更小的输出电压纹波。从短路检测的角度来看，第一相和第二相可以独立处理。可以将图１所示的双相2:1开关电容电路简化为如图２所示的单相2:1开关电容电路。如图2所示，开关电容转换器的输入电压总线为VIN。开关电容转换器的输出端VBAT与电池相连。输入电容Cin连接在电源VIN和地之间。开关电容转换器包括串联连接在地GND和输入电压总线VIN和地之间的开关Q1A、开关Q2A、开关Q3A和开关Q4A。开关电容转换器还包括飞跨电容C1A和输出电容Co。飞跨电容C1A连接在开关Q4A和开关Q3A的公共节点P2A与开关Q2A和开关Q1A的公共节点P1A之间。输出电容Co连接在输出端VBAT和地之间。输出电容Co与负载并联。在一些实施例中，开关Q3A用隔离开关实现。特别的，开关Q3A提供了电池和电源VIN之间的隔离。如图2所示，开关Q3A的体端子没有连接到开关Q3A的源极。开关Q3A包括两个体二极管。第一个体二极管位于开关Q3A的体端子和开关Q3A的源极之间。第二个体二极管位于开关Q3A的体端子和开关Q3A的漏极之间。这两个体二极管背靠背连接。由于具有背靠背连接的体二极管，开关Q3A可以用作隔离开关。在开关Q3A的栅极施加关断信号后，开关Q3A可以提供电池与公共节点P2A之间的隔离。更具体地，当公共节点P2A对地短路时，开关Q3A可以防止从电池汲取过高的电流。如图1,2所示，体端子控制电路连接到两个背对背连接的体二极管的公共节点。体端子控制电路用于通过调节开关Q3A的体端子的电压电位来控制开关Q3A的导通特性。在一实施例中，图1,2的开关元件可以是金属氧化物半导体场效应晶体管器件。或者，开关元件可以是任何可控开关，例如绝缘栅双极晶体管器件、集成栅极换向晶闸管器件、栅极可关断晶闸管器件、可控硅器件、结栅场效应晶体管器件、MOS控制晶闸管器件、氮化镓基功率器件、碳化硅基功率器件等。可以理解的是，虽然图2示出了开关Q4A、开关Q3A、开关Q2A和开关Q1A均被实现为单个NMOS晶体管，但是本领域技术人员将认识到可以存在许多变化、修改和替代。例如，根据不同的应用和设计需要，开关Q4A、开关Q3A、开关Q2A和开关Q1A中的全部或至少一些可以实现为PMOS晶体管。此外，图2中所示的每个开关可以实现为并联连接的多个开关。此外，电容可以与一个开关并联以实现零电压开关/零电流开关。在一实施例中，在正常工作中，开关电容转换器可以以两个不同的阶段操作。在第一阶段，开关Q4A和开关Q2A导通，开关Q3A和开关Q1A关断。由于开关Q4A和开关Q2A导通，充电电源VIN对飞跨电容C1A和输出电容Co进行充电。在第一阶段，飞跨电容C1A和输出电容Co串联。在第二阶段，开关Q3A和开关Q1A导通，开关Q4A和开关Q2A关断。由于开关Q3A和开关Q1A导通，飞跨电容C1A与输出电容Co并联，飞跨电容C1A和输出电容Co中储存的能量向负载放电。图3图示了根据本发明的各种实施例的短路检测装置。短路检测装置用于判断开关电容变换器的开关与飞跨电容是否短路。在一些实施例中，开关的短路指其源极和漏极之间的短路。在给开关电容转换器上电之前，可以利用短路检测装置检测开关电容转换器是否短路。如图3所示，短路检测装置包括第一专用电路、第二专用电路和有源放电电路。其中，第一专用电路与开关Q1A并联连接，用于建立开关Q1A和开关Q2A的公共节点P1A对地的放电路径。第二专用电路与开关Q2A并联连接，用于建立通过VBAT对开关Q1A和开关Q2A的公共节点P1A的充电路径。有源放电电路与飞跨电容C1A并联。有源放电电路用于在开关电容转换器关闭后对飞跨电容C1A上的电压进行放电。需要注意的是，图３中所示的有源放电电路在短路检测过程中保持关断。具体的，有源放电电路在短路检测过程中可以等效为开路。如图４所示，短路检测装置用于确定开关电容变换器中的开关和飞跨电容是否短路。具体的，第一专用电路包括开关S1A和电阻R1A。电阻R1A和开关S1A串联连接在公共节点P1A和地之间。第二专用电路包括开关S2A和电阻R2A。开关S2A和电阻R2A串联连接在VBAT和公共节点P1A之间。在操作中，在给开关电容变换器供电之前，可以通过两个短路检测步骤实现开关电容变换器的短路检测。在短路检测方法的第一步中，可以通过对开关Q3A和开关Q4A的公共节点P2A进行电压测量来进行开关Q3A的短路检测。特别地，在开关电容变换器通电之前，将配置体端子可变开关开关Q3A，使得其体端子连接到开关Q3A的漏极。因为其体端子连接到开关Q3A的漏极，施加于开关Q3A源极的电池电压不能通过开关Q3A传递到其漏极。因此，除非开关Q3A短路，否则公共节点P2A上的电压应该很低。换句话说，公共节点P2A上的电压应该接近于零。如果公共节点P2A上的电压高于预设阈值，表明开关Q3A短路。在一些实施例中，在执行第一短路检测步骤之前，可以先通过电阻将第二公共节点P2A上的电压放电到地，例如可以在第二公共节点和地之间设置放电通路，放电通路包括开关和电阻，通过闭合开关为第二公共节点放电。在短路检测方法的第二步的一个子步骤中，首先导通开关S1A以将公共节点P1A逐渐放电。在预设时间间隔之后，关断S1A，并导通开关S2A，使电池电压VBAT开始为公共节点P1A充电。经过第一开关短路检测时间后，测量公共节点P1A上的电压并与预设阈值进行比较。如果公共节点P1A上的电压高于预设阈值，则表明开关Q1A和开关Q4A均未短路。值得指出，公共节点P1A上的电压高于预设阈值还表明开关Q4A未短路。这是因为当预设时间间隔非常短时，飞跨电容C1A的大容值可以视为短路。能够将公共节点P1A上拉，表明开关Q4A没有在公共节点P2A与被视为交流地的电压总线VIN之间短路。在短路检测方法的第二步的另一个子步骤中，关断开关S2A，导通开关S1A以将公共节点P1A放电。经过第二开关短路检测时间后，再次测量公共节点P1A上的电压。如果公共节点P1A上的电压低于预设阈值，则可以确定开关Q2A未短路。实际上，短路检测方法第二步中的两个子步骤的顺序是可以互换的。例如，在导通开关S1A以将公共节点P1A放电后，可以将公共节点P1A上的电压测量值与预设阈值电压进行比较。如果公共节点P1A上的电压无法被拉低到接近零的值，则表明开关Q2A无法阻止电池电压VBAT达到公共节点P1A。换句话说，开关Q2A短路。上述t0、t1、t2的取值可以事先设定，示例性的， t0可以表示为：t0=R1A××ln在等式中，Cpar1是从公共节点P1A到交流地的总寄生电容。在计算Cpar1时，所有直流电源都被视为交流接地。。Cpar2是从公共节点P2A到交流地的总寄生电容。需要注意的是，虽然公共节点P2A并不直接与公共节点P1A相连，由于飞跨电容C1A的容值往往比较大,其在交流分析中等效为在P1A和P2A公共节点之间的一个低阻抗的通路。所以，P2A公共节点上的对交流地的寄生电容Cpar2也需要纳入P1A公共节点对交流地的总寄生电容计算中。Vo1是该系统中允许的最大电池电压。R1A为电阻R1A的阻值，而R1A× 则为为P1A公共节点放电的时间常数。Vref1为第一参考电压，如0.1V。通过表达式可以计算出公共节点P1A的电压下拉到第一参考电压Vref1以下时所需要的最少时间。例如，在一些实施例中，Cpar1等于500pF。Cpar2等于500pF。Vo1等于4.6V。R1A为1KOhm。根据等式，t0 约为3.8us。在实际应用中，考虑到开关的栅极电压的建立时间，t0可设置为大于计算值。第二专用电路导通的最小时长为t1min1。在一些实施例中，t1min1可以由以下等式表示：t1min1=τ×ln在等式中，τ是由R2A×决定的时间常数。例如，R2A等于100kΩ。Cpar1等于500pF，Cpar2等于500pF。因此，τ等于100us。在一些实施例中，Vo1等于4.6V,Vref2等于0.3V。根据等式，t1min1大约等于6.7us。在实际应用中，可能会在t1min1上增加一个裕量来得到t1。例如，t1可以等于10us。时间t1的上限被确定为使得第二专用电路不能将飞跨电容C1A充电至第二预设参考电压Vref2。这个原则给出了时间t1的最大允许值。t1的最大允许值可以由以下等式表示：t1max1=R2A×C1A×ln在短路检测的第二步的另一个子步骤中，第一专用电路导通的时长，即第二开关短路检测时间为t2，其最小值t2min由以下等式给出：t2min=R1A××ln其中，Vo2为公共节点P1A上在短路检测的第二步中第一个子步骤完成后的剩余电压。在一些实施例中，Cpar1等于500pF，并且Cpar2等于500pF。Vo2等于0.5V，Vref3为第三预设参考电压，可以等于0.1V。根据等式，t2的最小值等于1.6us。在实际应用中，可以向时间t2添加裕量以考虑开关的栅极电压的建立时间。在一些实施例中，t2的最大允许值t2max由以下等式给出：t2max=R1A×C1A×ln由于飞跨电容C1A的容值远大于公共节点P1A和P2A上的寄生电容之和，所以t1,t2的选择范围相对比较宽，可以选择尽量接近其各自所允许的最小值以缩短短路检测过程所需要的时间。在开关的短路检测完成后，如果未检测到短路故障，则下一步是检测飞跨电容C1A的短路。此短路检测通过导通开关Q3A来使电池电压通过开关Q3A达到公共节点P2A。然后，将连接到公共节点P1A的弱下拉电路使能，将公共节点P1A以有限的电流能力与地连接，以为公共节点P1A放电。其中，如图５所示，弱下拉电路包括参考电流源IREFA和第一控制开关QRA。第一控制开关QRA和开关Q1A形成一个电流镜。如图5所示，参考电流源IREFA连接在输出端VBAT和第一控制开关Q1的漏极之间。流经第一控制开关QRA的电流与流经开关Q1A的电流之比等于1:M，其中，M为预设数值,可以以通过设计第一控制开关QRA和开关Q1A的晶体管的宽长比的比值来实现。经过足够长的时间为公共节点P1A放电后，如果没有飞跨电容短路，则公共节点P1A上的电压应足够接近低电位。如果公共节点P1A上的电压大于预设阈值，则表示相应的飞跨电容短路。具体的，弱下拉电路的使能时长t3可以表示为将公共节点P1A和P2A上的寄生电荷充分放电的时长，即：t3=×Vo1/其中，IREFA是参考电流源的电流。例如，在一些实施例中，Cpar1等于500pF。Cpar2等于500pF。Vo1等于4.6V。IREFA等于10uA,M=100。根据等式，t3 约为4.6us。在实际应用中，考虑到开关Q1A的栅极电压的建立时间，t3可设置为大于计算值。与上述相同的短路检测过程适用于如图1所示的双相2:1开关电容转换器的每一相。在第一步中，通过测量公共节点P2A和P2B上的电压，可以确定开关Q3A和开关Q3B的短路状态。特别地，如果公共节点P2A和P2B上的电压低于预设电压阈值，则开关Q3A和开关Q3B未短路。第二步中的两个子步骤可以互换。在这两个子步骤中，通过R1A/S1A和R1B/S1B分别将公共节点P1A和P1B放电，并通过R2A/S2A和R2B/S2B将双相2:1开关电容变换器的输出端的电池连接到公共节点P1A和P1B，为公共节点P1A和P1B充电。在此过程中，通过监测并将公共节点P1A和P1B上的电压与各自的预设电压阈值进行比较，以确定Q1A、Q2A、Q3A和Q4A中的任何开关是否短路。需要注意的是，一相电路中的短路检测顺序不需要与另一个相相同。例如，开关Q2A的短路检测可能与开关Q1B同时发生，反之亦然。如果前面的短路检测步骤未检测到短路故障，在短路检测的第三步中，检测飞跨电容C1A、C1B是否短路。这里用到分别与两相电路连接的弱下拉电路，如图６所示,其中，与第一相电路相连的弱下拉电路包括参考电流源IREFA和第一控制开关QRA，与第二相电路相连的弱下拉电路包括参考电流源IREFB和第二控制开关QRB。飞跨电容的短路检测通过导通开关Q3A、开关Q3B来使电池电压通过开关Q3A和开关Q3B达到公共节点P2A和P2B。然后，将连接到公共节点P1A和P1B的弱下拉电路使能，将公共节点P1A和P1B以有限的电流能力与地连接。经过足够长的时间后，如果没有飞跨电容短路，则公共节点P1A和P1B上的电压应足够接近低电位。如果公共节点P1A或P1B上的电压大于预设阈值，则表示相应的飞跨电容短路。需要注意的是，第一相电路的弱下拉电路也可以通过将电阻R1A连接到电路中来实现，第二相电路的弱下拉电路也可以通过将电阻R1B连接到电路中来实现。图7说明了根据本公开不同实施例的双相迪克森4:1变换器。第一相包括开关Q6A、Q5A、Q4A、Q3A、Q2A和Q1A，这些开关串联连接在VIN和地之间。第二相包括开关Q6B、Q5B、Q4B、Q3B、Q2B和Q1B，这些开关串联连接在VIN和地之间。双相迪克森4:1变换器还包括飞跨电容C1A、C2A、C3A、C1B、C2B和C3B。飞跨电容C1A连接在开关Q4A和Q3A的公共节点与开关Q2A和Q1A的公共节点之间。飞跨电容C2A连接在开关Q5A和Q4A的公共节点与开关Q2B和Q1B的公共节点之间。飞跨电容C3A连接在开关Q6A和Q5A的公共节点与开关Q2A和Q1A的公共节点之间。飞跨电容C1B连接在开关Q4B和Q3B的公共节点与开关Q2B和Q1B的公共节点之间。飞跨电容C2B连接在开关Q5B和Q4B的公共节点与开关Q2A和Q1A的公共节点之间。飞跨电容C3B连接在开关Q6B和Q5B的公共节点与开关Q2B和Q1B的公共节点之间。与图6所示的变换器相比，引入了额外的飞跨电容C2A、C2B、C3A和C3B，以及开关Q5A、Q5B、Q6A和Q6B来将电压变换比从2:1提升至4:1。第一相的开关Q3A和第二相的开关Q3B被配置为体端子可变开关。在开关电容变换器通电之前，开关Q3A和开关Q3B的体端子连接到这两个开关的各自漏极。图8示出了根据本公开不同实施例的图7所示的双相迪克森4:1变换器的单相等效电路。为了描述短路检测过程，图7所示的双相迪克森4:1变换器可以简化为如图8所示的单相等效电路。基于这个单相等效电路，上述短路检测过程通常适用于两个电路相。图8中包括了双相迪克森4:1变换器的第一相以及第二相的两个开关Q1B和Q2B。这个单相等效电路用于描述第一相的短路检测过程。双相迪克森4:1变换器的第二相的单相等效电路类似于图8所示的情况，为避免重复不再显示。图9说明了根据本公开不同实施例的双相迪克森4:1变换器中用于检测短路元件的短路检测装置。引入了辅助电路来辅助进行短路检测。辅助电路包括电阻R1A、R2A、R1B、R2B、R0、RC1A、RC2A、RC3A以及开关S1A、S2A、S1B、S2B、S0、SC1A、SC2A、SC3A。其中R1A、S1A的组合为第一相的第一专用电路，R2A、S2A的组合为第一相的第二专用电路，R1B、S1B的组合为第二相第一专用电路，R2B、S2B的组合为第二相的第二专用电路，RC1A、SC1A的组合为第一有源放电电路，RC2A、SC2A的组合为第二有源放电电路，RC3A、SC3A的组合为第三有源放电电路。这些辅助电路形成多个放电电路，用于为飞跨电容和关键电路节点放电。特别地，在执行短路检测测试之前，飞跨电容C1A可以通过第一有源放电电路来放电，方法是在预设时间内导通开关SC1A使电阻RC1A与飞跨电容C1A并联连接，然后关断开关SC1A。类似地，在执行短路检测测试之前，飞跨电容C2A通过第二有源放电电路来放电，飞跨电容C3A通过第三有源放电电路来进行放电。与前面对图4的讨论类似，短路检测方法的第一步中，短路检测装置被配置为确定开关Q3A是否短路。通过测量公共节点P2A上的电压，可以完成这一步骤，如果开关Q3A能够阻止电池电压连接到开关Q3A的源极，则公共节点P2A上的电压应该接近于零。如果公共节点P2A上的电压大于预设阈值，则表明开关Q3A短路，或图9中的多个元件短路。例如，Q6A、Q5A和Q4A短路。在这两种情况下，系统将被通知检测到短路故障，并且供电将停止。在此过程中，如果公共节点P3A和P4A上的电压高于预设阈值，则表明开关Q3A处于短路状态。另一方面，如果公共节点P4A是唯一一个电压高于预设阈值的节点，则表明开关Q6A短路。与前面对图4的讨论类似，短路检测方法的第二步中，短路检测装置被配置为确定底部开关是否短路。与图6中的电路的主要区别在于，图8中的公共节点P3A和P4A都没有连接到电压总线。因此，需要采取独特的步骤组合来检测开关电容变换器的其他开关的短路。第二步包括两个子步骤。在第一个子步骤中，保持电阻R2A和R1B不接入电路，通过导通开关S1A和开关S2B将电阻R1A和R2B接入电路，在预设时间后，测量公共节点P1A和P1B上的电压。如果开关Q2A能够阻断电池电压，则公共节点P1A上的电压应该足够低。如果任何测量电压大于预设阈值，则表明一个或多个开关短路。可以很容易理解，如果开关Q2A短路，则公共节点P1A无法通过电阻R1A被拉至低电位。在短路检测的预设时间内，考虑到飞跨电容的大电容量，飞跨电容C1A、C2A和C3A被视为交流短路。通过在VBAT和公共节点P1B之间连接电阻R2B，可能存在VBAT通过电阻R2B、短路的开关Q4A和交流短路的飞跨电容C1A和C2A将公共节点P1A的电压拉升的路径。因此，公共节点P1A上的低电压也表明Q4A未短路。类似地，公共节点P1A的另一个上拉路径是通过短路的Q6A和交流短路的飞跨电容C3A。因此，公共节点P1A上的低电压也表明Q6A未短路。在第一个子步骤中，还测量公共节点P1B上的电压。如果开关Q1B未短路，则公共节点P1B上的电压应足够高，因为这个公共节点通过电阻R2B由电池充电。如果测量电压小于预设阈值，则表明开关Q1B短路。在第二个子步骤中，保持电阻R1A和R2B不与电路连接，通过导通开关S2A和开关S1B将电阻R2A和电阻R1B接入电路，在预设时间后，测量公共节点P1A和P1B上的电压。如果开关Q2B能够阻止电池电压，则公共节点P1B上的电压应该足够低。如果测量电压大于预设阈值，则表明一个或多个开关短路。可以很容易理解，如果开关Q2B短路，则公共节点P1B无法通过电阻R1B被拉至低电位。由于通过电阻R2A将VBAT和公共节点P1A连接，可能存在VBAT通过电阻R2A、短路的开关Q5A、交流短路的飞跨电容C3A和C2A将公共P1B节点电压拉升的路径。因此，公共节点P1B上的低电压也表明Q5A未短路。在第二个子步骤中，还测量公共节点P1A上的电压。如果开关Q1A未短路，则公共节点P1A上的电压应足够高，因为这个公共节点通过电阻R2A由电池充电。如果测量电压小于预设阈值，则表明开关Q1A短路。需要注意的是，上述步骤不需要按照完全相同的顺序执行，一相电路的第一个开关的短路检测可以与另一相电路的第二个开关的短路检测同时进行。在开关的短路检测完成后，如果未检测到短路故障，则下一步是检测飞跨电容C1A、C2A和C3A的短路。此短路检测通过导通开关Q3A来使电池电压通过开关Q3A和开关Q4A、Q5A的体二极管达到公共节点P2A、P3A和P4A。可以选择性地控制开关Q4A和Q5A导通，以为来自电池的充电电流提供导电路径。然后，将连接到公共节点P1A和P1B的弱下拉电路使能，将公共节点P1A和P1B以有限的电流能力与地连接。经过足够长的时间后，如果没有飞跨电容短路，则公共节点P1A和P1B上的电压应足够接近低电位。如果公共节点P1A或P1B上的电压大于预设阈值，则表示相应的飞跨电容短路。图10说明了根据本公开不同实施例的双相迪克森4:1变换器中用于检测飞跨电容短路的弱下拉电路。弱下拉电路包括参考电流源IREFA、IREFB和开关QRA、QRB。弱下拉电路是通过以有限的电流导通开关Q1A或Q1B来实现的，以抑制冲击电流。开关QRA和Q1A形成电流镜。如图10所示，开关QRA和IREFA可用于在开关Q1A的弱导通期间限制流过Q1A的电流。操作原理与上面关于图6的讨论类似，因此在此不再重复。同样，开关QRB和Q1B形成电流镜。开关QRB和IREFB可用于在弱导通Q1B时限制流过Q1B的电流。需要注意的是，弱下拉电路也可以通过将电阻R1A和/或R1B连接到电路中来实现。操作原理与上面关于图6的讨论类似，因此在此不再重复。图11示出了根据本公开的不同实施例的双相混合4:1变换器。第一相包括开关Q7A、Q6A、Q5A、Q4A、Q3A、Q2A和Q1A。开关Q7A、Q6A、Q3A、Q2A和Q1A在VIN和地之间串联连接。第二相包括开关Q7B、Q6B、Q5B、Q4B、Q3B、Q2B和Q1B。开关Q7B、Q6B、Q3B、Q2B和Q1B在VIN和地之间串联连接。双相混合4:1变换器还包括飞跨电容CFLA和CFLB。飞跨电容CFLA连接在开关Q6A和Q3A的公共节点与开关Q2A和Q1A的公共节点之间。飞跨电容CFLB连接在开关Q6B和Q3B的公共节点与开关Q2B和Q1B的公共节点之间。第一相的开关Q3A和第二相的开关Q3B被配置为体端子可变开关。在开关电容变换器通电之前，开关Q3A和开关Q3B的体端子连接到这两个开关的各自漏极。双相混合4:1变换器还包括第一辅助接地支路和第二辅助接地支路。第一辅助接地支路包括两个串联的开关Q4A和Q5A。这两个开关与第二相的串联连接的三个开关Q1B、Q2B和Q3B并联连接。飞跨电容CSA连接在开关Q4A和Q7A之间。第二辅助接地支路包括两个串联的开关Q4B和Q5B。这两个开关与第一相的串联连接的三个开关Q1A、Q2A和Q3A并联连接。飞跨电容CSB连接在开关Q4B和Q7B之间。在图11中，额外的飞跨电容CSA、CSB和开关Q4A、Q4B、Q5A和Q5B形成一个用于提升电压变换比的开关电容电路。图12说明了根据本公开不同实施例的双相混合4:1变换器的单相等效电路。为了描述短路检测过程，可以将图11中所示的双相混合4:1变换器简化为图12所示的单相电路。基于这个单相等效电路，上述描述的短路检测过程通常适用于两个电路相位，方法相同。图12说明了双相混合4:1变换器的第一相和第二相的三个开关Q1B、Q2B和Q3B。图12所示的这个单相等效电路用于描述第一相的短路检测过程。双相混合4:1变换器的第二相的单相等效电路类似于图12所示的电路，为避免重复，不再展示。图13说明了根据本公开不同实施例的双相混合4:1变换器中用于检测短路元件的短路检测装置。引入辅助电路以辅助短路检测。辅助电路包括电阻R1A、R2A、R3A、R4A、R5A、R1B、R2B、R3B、R0和开关S1A、S2A、S3A、S4A、S5A、S1B、S2B、S3B、S0。其中R2A、S2A的组合为第一相的第一专用电路，R3A、S3A的组合为第一相的第二专用电路，R2B、S2B的组合为第二相第一专用电路，R3B、S3B的组合为第二相的第二专用电路，R1A、S1A的组合为第一有源放电电路，R1B、S1B的组合为第二有源放电电路，R1、SR1的组合为第三有源放电电路。这些辅助电路形成多个放电电路，用于为飞跨电容和关键电路节点放电。特别地，在执行短路检测测试之前，飞跨电容CFLA可以通过第一有源放电电路来放电，方法是在预设时间内导通开关S1A使电阻R1A与飞跨电容CFLA并联连接，然后关断开关S1A。类似地，在执行短路检测测试之前，飞跨电容CFLB通过第二有源放电电路来放电，飞跨电容CSA通过第三有源放电电路来进行放电。与前面在图4中讨论的示例类似，短路检测方法的第一步是，配置短路检测装置以确定开关Q3A和Q3B是否短路。这是通过测量公共节点P2A和P2B上的电压来实现的，如果开关Q3A和Q3B能够阻挡与开关Q3A和Q3B的源极连接的电池电压VBAT，那么这两个公共节点的电压应该接近于零。如果公共节点P2A或P2B上的电压大于预设阈值，则表示开关Q3A或Q3B短路，或者图13所示电路中的多个元件短路。例如，Q6A和Q7A短路。在这两种情况下，系统将通知检测到短路故障，并停止向电路供电。在这个过程中，如果公共节点P4上的电压大于预设阈值，说明开关Q3A存在短路。另一方面，如果公共节点P4是唯一一个电压高于预设阈值的节点，说明开关Q7A短路。与前面在图4中讨论的示例类似，短路检测方法的第二步是，配置短路检测装置以确定底部开关是否短路。第二步包括两个子步骤。在第一个子步骤中，通过导通开关S2A和S2B将电阻R2A和R2B连接到电路中，同时通过关断开关S3A和S3B将电阻R3A和R3B从电路中断开。经过预设时间间隔后，测量公共节点P1A和P1B上的电压。如果开关Q2A和Q2B能够阻挡电池电压，那么公共节点P1A和P1B上的电压应该足够低。如果任何测量电压大于预设阈值，则表示相应的开关短路。在第二个子步骤中，通过导通开关S3A和S3B将电阻R3A和R3B连接到电路中，同时通过关断开关S2A和S2B将电阻R2A和R2B断开。经过预设时间间隔后，测量公共节点P1A和P1B上的电压。如果开关Q1A和Q1B未短路，公共节点P1A和P1B上的电压应足够高，因为这两个公共节点通过电阻R3A和R3B由电池充电。如果任何测量电压小于预设阈值，则表示相应的开关短路。需要注意的是，上述步骤不需要按照完全相同的顺序执行，一相电路的第一个开关的短路检测可以与另一个相的第二个开关的短路检测同时进行。在完成底部三个开关的短路检测后，下一步是检测飞跨电容CFLA和CFLB的短路。此短路检测通过导通开关Q3A和Q3B来使电池电压通过开关Q3A、Q3B和开关Q6A的体二极管达到公共节点P2A、P2B和P4。然后，将连接到公共节点P1A和P1B的弱下拉电路使能，将公共节点P1A和P1B与地以有限的电流能力连接。经过足够长的时间后，如果没有飞跨电容短路，则公共节点P1A和P1B上的电压应足够接近低电位。如果公共节点P1A或P1B上的电压大于预设阈值，则表示相应的飞跨电容短路。图14说明了根据本公开不同实施例的双相混合4:1变换器中用于检测短路飞跨电容的弱下拉电路。弱下拉电路包括电流参考IREFA、IREFB和开关QRA、QRB。弱下拉电路通过限流方式导通Q1A或Q1B来抑制冲击电流。QRB和Q1A形成一个电流镜。如图14所示，QRB和IREFB可用于在Q1A弱导通时限制通过Q1A的电流。其工作原理与上述与图6有关的原理类似，因此在此不再重复阐述。同样，QRA和Q1B也形成一个电流镜。QRA和IREFA可用于在Q1B弱导通时限制通过Q1B的电流。需要注意的是，弱下拉电路可以通过将电阻R2A和/或R2B连接到电路中来实现。其工作原理与上述与图6有关的原理类似，因此在此不再重复阐述。在确认底部的六个开关Q1A、Q1B、Q2A、Q2B、Q3A和Q3B未短路之后，可以使用与短路检测开关Q1B、Q2B和飞跨电容CFLB类似的过程来检测包括开关Q5A、Q4A和飞跨电容CSA的接地支路中的短路。在检测开关Q1B、Q2B和飞跨电容CFLB的短路时，导通开关Q3B，而开关Q3A保持关断。电池电压VBAT施加在公共节点P2B上。对开关Q5A和Q4A的短路检测分两步进行。在检测开关Q5A和Q4A的短路的第一步中，通过导通开关S4A将电阻R4A连接到电路中，同时通过关断开关S5A将电阻R5A断开。经过预设时间间隔后，测量公共节点P3上的电压。如果开关Q5A能够阻挡来自公共节点P2B的电压，那么公共节点P3上的电压应该足够低。如果测量的公共节点P3上的电压大于预设阈值，则表示相应的开关Q5A短路。在检测Q5A和Q4A的短路的第二步中，通过导通开关S5A将电阻R5A连接到电路中，同时关断开关S4A将电阻R4A从电路中断开。经过预设时间间隔后，测量公共节点P3上的电压。如果开关Q4A未短路，公共节点P3上的电压应该足够高，因为它是由电池通过Q3B和R5A充电的。如果测量的公共节点P3上的电压小于预设阈值，则表示相应的开关Q4A短路。对开关管Q6A的短路检测可以在Q3B导通时进行，通过导通开关Q5A或导通开关S5A将电阻R5A接入电路，使得公共节点P3与VBAT达到同样的电位。之后，通过导通开关S2A以将电阻R2A与电路连接，在预设时间后，测量公共节点P1A上的电压。如果开关Q6A能够阻止公共节点P3上的电池电压，则公共节点P1A上的电压应该足够低。如果测量电压大于预设阈值，则表明开关Q6A短路。由于通过电阻R2A将公共节点P1A接地，可能存在VBAT通过导通的开关Q3B、Q5A、短路的开关Q6A、交流短路的飞跨电容CSA和CFLA将P1A公共节点电压拉升的路径。因此，公共节点P1A上的低电压也表明Q6A未短路。然后，飞跨电容CSA的短路检测可以遵循与上述用于短路检测飞跨电容CFLA和CFLB的类似步骤。首先，保持开关Q3B关断，导通开关Q3A以使公共节点P4具有与VBAT大致相等的电位。然后，启用公共节点P3的弱下拉电路，将公共节点P3以有限的电流能力连接到地。经过足够长的时间后，如果飞跨电容CSA未短路，则公共节点P3上的电压应足够接近低电位。如果公共节点P3上的电压大于预设阈值，则飞跨电容CSA短路。实现弱下拉电路的一种方法是通过限流方式导通开关Q4A以抑制冲击电流。QRA和Q4A形成一个电流镜。如图14所示，QRA和IREFA可用于在Q4A的弱导通过程中限制通过Q4A的电流。其工作原理与上述与图2有关的原理类似，因此在此不再重复阐述。需要注意的是，弱下拉电路也可以通过将电阻R4A连接到电路中来实现。其工作原理与上述与图6有关的原理类似，因此在此不再重复阐述。类似地，双相混合4:1电路的另一相可以使用相同的短路检测程序，在完全导通电路进行功率转换操作之前，确保没有开关或飞跨电容短路。图15a说明了根据本公开不同实施例的双相开关电容电路拓扑的广义模型。所有上述双相开关电容电路拓扑都可以归纳为图15a所示的电路。图15a所示的开关电容电路包括串联连接在地和输入电压总线VIN之间的开关Q1A、开关Q2A、开关Q3A和上部电路。回顾图2、8和12，其中，上部电路可以包括多个开关。图15a所示的开关电容电路还包括连接在开关Q1A和开关Q2A的公共节点与开关Q3A和上部电路的公共节点之间的飞跨电容C1A。开关Q2A和开关Q3A的公共节点处为开关电容变换器的输出端，开关电容变换器被配置为为连接到其输出端的电池充电。短路检测方法可以概括为以下步骤。在第一短路检测步骤中，该方法包括通过将上部电路和第三开关的公共节点上的电压与第一预设参考电压进行比较，来确定第三开关是否短路。在通过第一短路检测步骤后，即确定第三开关未短路后，在第二短路检测步骤的一个子步骤中，该方法包括通过将第一开关和第二开关的公共节点上的电压与第二预设参考电压进行比较，来确定第一开关是否短路。在第二短路检测步骤的另一个子步骤中，该方法包括通过将第一开关和第二开关的公共节点上的电压与第三预设参考电压进行比较，来确定第二开关是否短路。图15b所示的开关电容电路还包括串联连接在地和开关电容变换器的输出端之间的第四开关和第五开关，还包括连接在第四开关和第五开关的公共节点与上部电路的公共节点之间的第二飞跨电容C2A。短路检测方法可以概括为以下步骤。在第一短路检测步骤中，该方法包括通过将上部电路和第三开关的公共节点上的电压与第一预设参考电压进行比较，来确定第三开关是否短路。在通过第一短路检测步骤后，即确定第三开关未短路后，在第二短路检测步骤的一个子步骤中，该方法包括通过将第一开关和第二开关的公共节点上的电压与第二预设参考电压进行比较，来确定第一开关是否短路，还包括通过将第四开关和第五开关的公共节点上的电压与第三预设参考电压进行比较，来确定第五开关是否短路。在第二短路检测步骤的另一个子步骤中，该方法包括通过将第一开关和第二开关的公共节点上的电压与第三预设参考电压进行比较，来确定第二开关是否短路，还包括通过将第四开关和第五开关的公共节点上的电压与第二预设参考电压进行比较，来确定第四开关是否短路。在第二步骤的每个子步骤中，同时完成两个开关的短路检测，则在第二步骤中，可以完成四个开关的短路检测，提高了短路检测的效率。本领域技术人员可以理解的，在第一短路检测步骤中，将上部电路和第三开关的公共节点上的电压与第一预设参考电压进行比较，来确定第三开关是否短路。由于电路的连通特性，在上部电路内部可能存在与该公共节点具有大致相同电压的节点，则在第一短路检测步骤中不应局限于只能检测上部电路和第三开关的某一公共节点处的电压，而应理解为，检测与该公共节点连接的可以指示该公共节点的电压的节点均可。例如，在开关具有体二极管的场合，上部电路中的体二极管阳极在下，阴极在上，则上部电路中其他开关的公共节点、与上述上部电路与第三开关的公共节点是连通的。当上部电路与第三开关的公共节点是高电平时，其他开关的公共节点也是高电平。则在第一短路检测步骤中，也可以通过检测上部电路中其他开关的公共节点处的电压，并与第一预设参考电压进行比较，来确定第三开关是否短路。以图8为例，在第一短路检测步骤中，除检测P2A处的电压，也可以检测P3A或P4A的电压来确定第三开关是否短路。上部电路可以包括至少一个开关，示例性的，上部电路可以包括串联连接在输入电压总线和第三开关与上部电路的公共节点之间的至少一个开关，开关的数量可以大于或者等于1。当然，在另一些实施例中，上部电路也可以采用其他电路结构，例如，图12所示的电路结构。图16示意了根据本公开的不同实施例，用于图15a、图15b所示的开关电容变换器的短路检测方法的流程图。图16中所示的流程图仅为示例，不应过分限制权利要求的范围。普通技术人员会认识到有许多变化、替代和修改。例如，图16中所示的各个步骤可以添加、删除、替换、重新排列和重复。在步骤1702中，将开关电容变换器的输出连接到电池。在步骤1704中，在短路检测的第一个步骤中，控制电路通过将第三开关和上部电路的公共节点的电压与第一预设参考电压进行比较来确定第三开关是否短路。在步骤1706中，在通过短路检测的第一个步骤后，即确定第三开关未短路后，在短路检测的第二个步骤中，控制电路确定第一开关和第二开关是否短路，通过将第一开关和第二开关的公共节点的电压分别与第二预设参考电压和第三预设参考电压进行比较。在通过短路检测的第二个步骤后，即确定第一开关和第二开关未短路后，导通第三开关，并在短路检测的第三个步骤中，通过将第一开关和第二开关的公共节点的电压与第四预设参考电压进行比较，确定飞跨电容是否短路。该方法还包括对第一开关和第二开关的公共节点的电压进行放电，经过预设的飞跨电容短路检测时间后，将第一开关和第二开关的公共节点的电压与第四预设参考电压进行比较，以确定飞跨电容是否短路。在执行短路检测的第一个步骤之前，通过电阻将第三开关和上部电路的公共节点进行放电，在短路检测的第一个步骤中，通过将第三开关和上部电路的公共节点的电压与第一预设参考电压进行比较，以确定第三开关是否短路。在短路检测的第二个步骤的子步骤中，导通第一开关和第二开关公共节点和电池，将第一开关和第二开关的公共节点的电压进行充电，经过预设的第一开关短路检测时间后，将第一开关和第二开关的公共节点的电压与第二预设参考电压进行比较，以确定第一开关是否短路。在短路检测的第二个步骤的另一个子步骤中，导通第一开关和第二开关的公共节点和地，以为该公共节点放电，持续预设的第二开关短路检测时间，将第一开关和第二开关的公共节点的电压与第三预设参考电压进行比较，以确定第二开关是否短路。开关电容电路还包括第四开关和第五开关，第四开关和第五开关串联连接在地和开关电容变换器的输出端之间，第二飞跨电容连接在第四开关和第五开关的公共节点和上部电路之间。该方法还包括在短路检测的第二个步骤的子步骤中，同时对第一开关和第二开关的公共节点的电压进行充电，以使该节点电压向VBAT趋近,并对第四开关和第五开关的公共节点的电压进行放电，以使该节点电压向0V趋近。经过预设的第一开关短路检测时间后，将第一开关和第二开关的公共节点的电压与第二预设参考电压进行比较，以确定第一开关是否短路，并将第四开关和第五开关的公共节点的电压与第三预设参考电压进行比较，以确定第五开关是否短路。在短路检测的第二个步骤的另一个子步骤中，同时对第一开关和第二开关的公共节点的电压进行放电，以使该节点电压向0V趋近，并对第四开关和第五开关的公共节点的电压进行充电,以使该节点的电压向VBAT趋近。经过预设的第二开关短路检测时间后，将第一开关和第二开关的公共节点的电压与第三预设参考电压进行比较，以确定第二开关是否短路，并将第四开关和第五开关的公共节点的电压与第二预设参考电压进行比较，以确定第四开关是否短路。在某些实施例中，第三开关包括连接在第三开关的漏极和体端子之间的第一二极管，以及连接在第三开关的源极和体端子之间的第二二极管，其中第一二极管和第二二极管是背对背连接的，并且通过调整第三开关体端子处的电位来控制第三开关的导通特性。根据某一实施例，一种方法包括将开关电容变换器的输出连接到电池，开关电容变换器包括串联连接在地和输入电压总线之间第一开关、第二开关、第三开关和上部电路，和一个连接在第一开关和第二开关的公共节点以及第三开关和上部电路的公共节点之间的飞跨电容，开关电容变换器被配置为为电池充电，在短路检测的第一个步骤中，通过将第三开关和上部电路的公共节点的电压与第一预设参考电压进行比较，确定第三开关是否短路，在通过短路检测的第一个步骤后，在短路检测的第二个步骤中，通过将第一开关和第二开关的公共节点的电压分别与第二预设参考电压和第三预设参考电压进行比较，确定第一开关和第二开关是否短路。根据另一实施例，一种系统包括开关电容变换器，该开关电容变换器包括串联连接在地和输入电压总线之间第一开关、第二开关、第三开关和上部电路和连接在第一开关和第二开关的公共节点以及第三开关和上部电路的公共节点之间的飞跨电容，开关电容变换器被配置为为电池充电，该电池连接到开关电容变换器的输出端，而输出端位于第二开关和第三开关的公共节点，还包括一个短路检测装置，该装置包括第一专用电路，该第一专用电路包括第一控制开关和第一电阻，连接在第二开关和第一开关之间的公共节点和地之间，第一专用电路被配置为为第一开关和第二开关的公共节点的电压放电以进行短路检测。该装置还包括第二专用电路，该第二专用电路包括第二控制开关和第二电阻，连接在第二开关和第一开关之间的公共节点和输出端之间，第二专用电路被配置为为第一开关和第二开关的公共节点充电以建立该公共节点的电压以进行短路检测。需要说明的，上述对各开关的控制可以通过装载有软件程序的控制单元通过向各开关发出控制信号来实现，当然也可以由控制单元来实现。在另一些实施例中，对各开关的控制、电压比较和各种计算均可以统一由控制单元实行。虽然已经详细描述了本发明的实施例及其优点，但是应当理解，在不脱离由所附权利要求限定的本发明的精神和范围的情况下，可以在本文中进行各种改变、替换和变更。此外，本申请的范围不旨在限于说明书中描述的过程、机器、制造、物质组成、手段、方法和步骤的特定实施例。作为本领域的普通技术人员，从本发明的公开内容中将容易理解目前存在的或以后将开发的执行基本相同功能的过程、机器、制造、物质组合物、手段、方法或步骤或者实现与根据本发明可以利用的在此描述的相应实施例基本相同的结果。因此，所附权利要求旨在将这样的过程、机器、制造、物质组成、手段、方法或步骤包括在它们的范围内。
