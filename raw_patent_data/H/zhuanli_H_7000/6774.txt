标题title
一种可插播的广告同步播放方法、系统、设备及介质
摘要abst
本发明提供一种可插播的广告同步播放方法、系统、设备及介质，该方法包括定时通过NTP协议与远程时间服务器进行时间同步；通过MQTT协议实时订阅远程业务服务器的广告临时插播请求，若接收到远程业务服务器广告临时插播任务，下载要临时插播的广告内容，将其添加到待插播列表内；启用广告播放执行组件，完成广告同步播放。通过广告播放执行组件，可自行完成广告纠偏，保证广告严格按计划按时间点执行，实现与其他电子广告屏同步播放。不需要消耗服务器资源，有效地减轻服务器负载压力，降低系统部署、运营成本，且只有在预加载广告素材为公益广告时，才会进行广告临时插播，满足实际使用场景的广告临时性插播需求，具备实用性。
权利要求书clms
1.一种可插播的广告同步播放方法，其特征在于,应用于电子广告屏设备，所述方法包括以下步骤：S1：定时通过NTP协议与远程时间服务器进行时间同步；S2：通过MQTT协议实时订阅远程业务服务器的广告临时插播请求，若接收到远程业务服务器广告临时插播任务，下载要临时插播的广告内容，将其添加到待插播列表内，其中，待插播列表初始化为空，长度为0；S3：启用广告播放执行组件，完成广告同步播放。2.根据权利要求1所述的一种可插播的广告同步播放方法，其特征在于，步骤S1具体包括：S11：设置一个定时间隔，其中，/＞的取值范围为正整数，单位为秒；S12：当达到定时间隔时，获取远程时间服务器的UTC毫秒级时间戳为/＞，获取本地UTC毫秒级时间戳为/＞；S13：计算远程时间服务器的UTC毫秒级时间戳和本地UTC毫秒级时间戳/＞的毫秒级时间差/＞；S14：当的大小超过预设阈值T时，更新时间为远程时间服务器的时间。3.根据权利要求1所述的一种可插播的广告同步播放方法，其特征在于，步骤S3具体包括：S31：创建两个同样大小，属性相同的空组件和/＞；S32：组件和/＞都设置两个事件触发，分别为播放开始事件Start和播放结束事件End；S33：电子广告屏设备首次启动时，组件默认加载播放列表/＞中的第一个广告素材，当广告素材/＞加载完毕后，调用组件/＞的开始播放事件/＞ Start，当组件/＞播放完广告素材时，调用播放结束事件/＞ End，组件/＞播放结束事件/＞ End，调用组件/＞的播放开始事件/＞ Start，当组件/＞播放完广告素材时，调用播放结束事件/＞ End，组件/＞播放结束事件/＞ End，调用组件/＞的播放开始事件/＞ Start,通过组件/＞和/＞之间的递归调用，实现两个组件/＞和/＞轮流交替预加载广告素材，轮流交替渲染播放广告素材,其中，电子广告屏设备设置有同一个播放列表/＞，播放列表内含有n个广告素材，其播放顺序用集合表示为/＞，播放列表M内的每个广告元素播放占用的耗时集合为/＞，集合表示为/＞，耗时集合/＞的总耗时为 /＞，广告素材播放耗时的单位为秒，取值范围为正整数。4.根据权利要求3所述的一种可插播的广告同步播放方法，其特征在于，当前组件的播放开始事件Start的实现逻辑为：将另一组件显示状态设置为隐藏状态；将当前组件显示状态设置为显示状态；执行单机自校验逻辑，得到另一组件的预加载广告素材、当前组件自校验后的当前广告素材播放进度/＞，当前组件自校验后的当前广告素材剩余播放时长/＞；若待插播列表非空，且预加载广告素材/＞的广告类型为公益广告，则取出待插播列表/＞的第一个待插播广告/＞，并触发另一组件预加载该待插播广告/＞；若待插播列表非空且预加载广告素材/＞的广告类型为非公益广告类型，或待插播列表/＞为空，则触发另一组件预加载广告素材/＞；当前组件按自校验后得到的当前广告素材播放进度，当前广告素材剩余播放时长/＞，播放已预加载的广告素材内容，其中，若当前组件为/＞，则另一组件为/＞，若当前组件为/＞，则另一组件为/＞。5.根据权利要求4所述的一种可插播的广告同步播放方法，其特征在于，单机自校验逻辑具体过程如下：S41：获取当前的本地UTC毫秒级时间戳为，获取当天日期0点0分0秒对应的UTC毫秒级时间戳为/＞；S42：计算当前时间按计划周期性循环执行播放列表，目前应当处于的播放位置时间戳/＞，有/＞，其中，mod表示取余运算；S43：计算按计划当前应该播放的广告素材；S44：计算按计划当前播放广告素材，已播放的毫秒级时间戳进度/＞，有如下公式：；S45、计算另外一个组件的预加载广告素材、当前组件自校验后的广告素材播放进度/＞，当前组件自校验后的广告素材剩余播放时长/＞。6.根据权利要求5所述的一种可插播的广告同步播放方法，其特征在于，步骤S45的实现逻辑为：S451：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材不是同一个广告素材，并且/＞，将剩余播放毫秒级时长调整为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞，其中，/＞为广告素材预加载耗时毫秒级时间戳阈值，单位为毫秒，取值范围为正整数；S452：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材不是同一个广告素材，并且/＞，将剩余播放毫秒级时长调整为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞；S453：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材是同一个广告素材，并且/＞，将当前播放毫秒级进度/＞设置为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞，其中，/＞为广告素材播放进度偏差毫秒级时间戳阈值，单位为毫秒，取值范围为正整数；/＞S454：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材是同一个广告素材，并且/＞，则无需调整设备/＞当前播放毫秒级进度/＞，并指定另外一个组件要预加载的广告素材/＞为/＞。7.根据权利要求5所述的一种可插播的广告同步播放方法，其特征在于，步骤S43中：计算按计划当前应该播放的广告素材的实现逻辑如下：按计划当前该播放的广告素材位置为第i个，满足如下公式：；根据不等式，计算出i的值，即确定按计划当前该播放的广告素材；其中，播放列表M内的每个广告元素播放占用的耗时集合为，按照播放顺序，集合表示为/＞，且广告素材播放耗时的单位为秒，取值范围为正整数。8.一种可插播的广告同步播放系统，其特征在于，包括：时间同步模块：定时通过NTP协议与远程时间服务器进行时间同步；广告插播监听模块：通过MQTT协议实时订阅远程业务服务器的广告临时插播请求，若接收到远程业务服务器广告临时插播任务，下载要临时插播的广告内容，将其添加到待插播列表内，其中，待插播列表初始化为空，长度为0；广告播放执行模块：启用广告播放执行组件，完成广告同步播放。9.一种电子设备，其特征在于，所述电子设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述电子设备实现如权利要求1至7中任一项所述的一种可插播的广告同步播放方法。10.一种计算机可读存储介质，其特征在于，其上存储有计算机程序，当所述计算机程序被计算机的处理器执行时，使计算机执行权利要求1至7中任一项所述的一种可插播的广告同步播放方法。
说明书desc
技术领域本发明涉及广告同步播放领域，具体为一种可插播的广告同步播放方法、系统、设备及介质。背景技术电子广告屏在传媒行业的应用越来越广，在同一场景下，多个电子广告屏播放若不同步显示，对广告展示效果会大打折扣。因此同步播放技术在广告投放中，尤为重要。在目前已有的同步播放系统中，同步过程都需要与服务器进行频繁通信，设置多台设备的主从属性，并将设备的播放信息与服务器信息进行比对，计算播放时间戳差值后进行播放控制调整。其中，设备与服务器通信方式有网络、串口等方式，主要通过广播的方式进行。现有技术提出一种多台广告机同步播放的方法以及系统， 不仅需要服务器，还需要一台同步主机，向至少一同步从机广播ID，同步从机接收到ID后播放与其匹配的素材文件，从而达到同步播放效果。现有技术提出一种多个播放终端播放内容同步播放方法及系统，用户需要通过用户终端设定多个播放终端的主从属性，服务器对待同步播放内容进行时间数据抽取，得到相应的时间数据；服务器向多个播放终端发送多个播放终端的主从属性信息及待同步播放内容的时间数据；主播放终端进入主机模式，向从属播放终端发送同步播放信息，从属播放终端禁用其音频模块，根据收到的同步播放信息，控制播放内容及播放进度，使其播放内容及播放进度与主播放终端播放内容及播放进度同步。现有技术提出一种同步播放方法及服务器、播放器，公开了同步播放方法、服务器及播放器。方法包括：从多台目标多媒体设备中任选一台作为主控设备，在主控设备上配置目标多媒体设备的总数；各设备播放器连接主控设备上的同步播放服务器，连接成功，向同步播放服务器发送播放开始请求消息；当同步播放服务器接收到所有设备播放器发来的播放开始请求消息时，根据自身维护的当前播放系统时钟curSysTick确定当前播放时刻curPlayTime，向所有设备播放器发送播放开始时钟消息，该消息携带curPlayTime，各设备播放器接收该播放开始时钟消息，根据该消息中的curPlayTime开始同步播放多媒体文件。在上述已有同步播放方法中，均需要预先设定或通过选举的方式确定一台主设备，主设备再通过与服务器通信或广播的方式，经服务器传递播放状态信息到其他从设备，从设备依据主设备的播放状态信息，对其播放进度进行调整。这种方式需要频繁与服务器进行通信，同步播放过程无法离线单机执行，若服务器出现故障，则无法进行同步播放。若需要同步的设备量越多，给服务器的压力会越大，通过广播方式甚至还可能会出现局域网网络风暴问题。已有同步播放方法中，没有考虑插播的情况，无法满足临时插播需求;没有考虑视频播放内容在不同设备上，加载所需时间不同的情况，为此已有同步播放方法中，需要在视频播放过程中，定时广播主设备视频播放时间戳状态，用于确保不同设备播放同步。发明内容鉴于以上所述现有技术的缺点，本发明提供一种可插播的广告同步播放方法、系统、设备及介质，以解决上述技术问题。本发明提供的一种可插播的广告同步播放方法，所述方法包括以下步骤：一种可插播的广告同步播放方法，其特征在于,应用于电子广告屏设备，所述方法包括以下步骤：S1：定时通过NTP协议与远程时间服务器进行时间同步；S2：通过MQTT协议实时订阅远程业务服务器的广告临时插播请求，若接收到远程业务服务器广告临时插播任务，下载要临时插播的广告内容，将其添加到待插播列表内，其中，待插播列表初始化为空，长度为0；S3：启用广告播放执行组件，完成广告同步播放。于本发明的一实施例中，步骤S1具体包括：S11：设置一个定时间隔，其中，/＞的取值范围为正整数，单位为秒；S12：当达到定时间隔时，获取远程时间服务器的UTC毫秒级时间戳为/＞，获取本地UTC毫秒级时间戳为/＞；S13：计算远程时间服务器的UTC毫秒级时间戳和本地UTC毫秒级时间戳的毫秒级时间差/＞；S14：当的大小超过预设阈值T时，更新时间为远程时间服务器的时间。于本发明的一实施例中，步骤S3具体包括：S31：创建两个同样大小，属性相同的空组件和/＞；S32：组件和/＞都设置两个事件触发，分别为播放开始事件Start和播放结束事件End；S33：电子广告屏设备首次启动时，组件默认加载播放列表/＞中的第一个广告素材/＞，当广告素材/＞加载完毕后，调用组件/＞的开始播放事件/＞ Start，当组件/＞播放完广告素材时，调用播放结束事件/＞ End，组件/＞播放结束事件/＞ End，调用组件/＞的播放开始事件/＞ Start，当组件/＞播放完广告素材时，调用播放结束事件/＞ End，组件/＞播放结束事件/＞ End，调用组件/＞的播放开始事件/＞ Start,通过组件/＞和/＞之间的递归调用，实现两个组件/＞和/＞轮流交替预加载广告素材，轮流交替渲染播放广告素材,其中，电子广告屏设备设置有同一个播放列表/＞，播放列表内含有n个广告素材，其播放顺序用集合表示为/＞，播放列表M内的每个广告元素播放占用的耗时集合为/＞，集合表示为/＞，耗时集合/＞的总耗时为 /＞，广告素材播放耗时的单位为秒，取值范围为正整数。于本发明的一实施例中，当前组件的播放开始事件Start的实现逻辑为：将另一组件显示状态设置为隐藏状态；将当前组件显示状态设置为显示状态；执行单机自校验逻辑，得到另一组件的预加载广告素材、当前组件自校验后的当前广告素材播放进度/＞，当前组件自校验后的当前广告素材剩余播放时长；若待插播列表非空，且预加载广告素材/＞的广告类型为公益广告，则取出待插播列表/＞的第一个待插播广告/＞，并触发另一组件预加载该待插播广告/＞；若待插播列表非空且预加载广告素材/＞的广告类型为非公益广告类型，或待插播列表/＞为空，则触发另一组件预加载广告素材/＞；当前组件按自校验后得到的当前广告素材播放进度，当前广告素材剩余播放时长/＞，播放已预加载的广告素材内容，其中，若当前组件为/＞，则另一组件为/＞，若当前组件为/＞，则另一组件为/＞。于本发明的一实施例中，单机自校验逻辑具体过程如下：S41：获取当前的本地UTC毫秒级时间戳为，获取当天日期0点0分0秒对应的UTC毫秒级时间戳为/＞；S42：计算当前时间按计划周期性循环执行播放列表，目前应当处于的播放位置时间戳/＞，有/＞，其中，mod表示取余运算；S43：计算按计划当前应该播放的广告素材；S44：计算按计划当前播放广告素材，已播放的毫秒级时间戳进度/＞，有如下公式：；S45、计算另外一个组件的预加载广告素材、当前组件自校验后的广告素材播放进度/＞，当前组件自校验后的广告素材剩余播放时长/＞。于本发明的一实施例中，步骤S45的实现逻辑为：S451：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材/＞不是同一个广告素材，并且/＞，将剩余播放毫秒级时长调整为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞，其中，/＞为广告素材预加载耗时毫秒级时间戳阈值，单位为毫秒，取值范围为正整数；S452：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材/＞不是同一个广告素材，并且/＞，将剩余播放毫秒级时长调整为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞；S453：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材/＞是同一个广告素材，并且/＞，将当前播放毫秒级进度/＞设置为，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞，其中，为广告素材播放进度偏差毫秒级时间戳阈值，单位为毫秒，取值范围为正整数；S454：若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材/＞是同一个广告素材，并且/＞，则无需调整设备/＞当前播放毫秒级进度，并指定另外一个组件要预加载的广告素材/＞为/＞。/＞于本发明的一实施例中，步骤S43中：计算按计划当前应该播放的广告素材的实现逻辑如下：按计划当前该播放的广告素材位置为第i个，满足如下公式：；根据不等式，计算出i的值，即确定按计划当前该播放的广告素材；其中，播放列表M内的每个广告元素播放占用的耗时集合为，按照播放顺序，集合表示为/＞，且广告素材播放耗时的单位为秒，取值范围为正整数。本发明还提供一种可插播的广告同步播放系统，包括：时间同步模块：定时通过NTP协议与远程时间服务器进行时间同步；广告插播监听模块：通过MQTT协议实时订阅远程业务服务器的广告临时插播请求，若接收到远程业务服务器广告临时插播任务，下载要临时插播的广告内容，将其添加到待插播列表内，其中，待插播列表初始化为空，长度为0；广告播放执行模块：启用广告播放执行组件，完成广告同步播放。本发明还提供一种电子设备，所述电子设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述电子设备实现如上述实施例中任一项所述的一种可插播的广告同步播放方法。本发明还提供一种计算机可读存储介质，其上存储有计算机程序，当所述计算机程序被计算机的处理器执行时，使计算机执行如上述实施例中任一项所述的一种可插播的广告同步播放方法。本发明的有益效果：本发明提出的一种可插播的广告同步播放方法，其中包含时间同步模块，基于的是标准的NTP时钟同步协议，在实际应用中，对于小微型团体使用方，可直接使用互联网上已有的可靠时间同步服务器，有效降低部署运营成本。时间同步服务器也可以通过DNS负载均衡的方式，批量解析连接到一批服务器，实现集群化高可用，提高时间同步可靠性。本发明提出的一种可插播的广告同步播放方法，当需要在一批电子广告屏设备进行广告同步播放控制时，无需通过选举或指定的方式，选择出一个主设备，并将其他设备设置为从设备。即每台设备并没有主从之分，处于同等地位。并且，在广告播放执行模块中，设备可执行自校验逻辑是单机运行的。在自校验逻辑中，并不需要与服务器进行任何交互，即设备通过单机自校验逻辑，即可单机自行完成广告纠偏，保证广告严格按计划按时间点执行，进而实现与其他电子广告屏同步播放。广告同步播放控制均不需要消耗服务器资源，可以有效地从根本上减轻服务器负载压力，进而降低系统部署、运营成本。本发明提出的一种可插播的广告同步播放方法，在广告播放执行模块中，设备采用双组件的方式进行轮流预加载、渲染播放显示，充分考虑到设备预加载广告素材需要时间，且不同设备性能不同的问题。可兼容不同配置电子广告屏设备的，减少由于设备性能不同导致的频繁修正当前播放进度的情况，达到更好的广告同步显示播放效果。本发明提出的一种可插播的广告同步播放方法，在广告播放执行模块中，只有在预加载广告素材为公益广告时，才会进行广告临时插播。可以在保证商业广告同步播放的前提下，允许广告临时插播，可满足实际使用场景的广告临时性插播需求，更具备实用性。本发明提出的一种可插播的广告同步播放方法，在广告播放执行模块的单机自校验逻辑中，统一由当前日期的零时零分零秒开始，即使不同设备组定时开关时间不同，只要设备的播放列表内容相同，即可实现跨多个设备组，跨多个地域的广告同步播放。上述说明仅是本申请技术方案的概述，为了能够更清楚了解本申请的技术手段，而可依照说明书的内容予以实施，并且为了让本申请的上述和其它目的、特征和优点能够更明显易懂，以下特举本申请的具体实施方式。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。在附图中：图1为本发明的一示例性实施例示出的一种可插播的广告同步播放方法的流程图；图2为本发明的一示例性实施例示出的一种可插播的广告同步播放方法中步骤S1的流程图；图3为本发明的一示例性实施例示出的一种可插播的广告同步播放方法中步骤S3的逻辑流程图；图4为本发明的一示例性实施例示出的一种可插播的广告同步播放系统结构示意图；图5为本发明的一示例性实施例示出的电子设备的计算机系统的结构示意图。具体实施方式以下将参照附图和优选实施例来说明本发明的实施方式，本领域技术人员可由本说明书中所揭露的内容轻易地了解本发明的其他优点与功效。本发明还可以通过另外不同的具体实施方式加以实施或应用，本说明书中的各项细节也可以基于不同观点与应用，在没有背离本发明的精神下进行各种修饰或改变。应当理解，优选实施例仅为了说明本发明，而不是为了限制本发明的保护范围。需要说明的是，以下实施例中所提供的图示仅以示意方式说明本发明的基本构想，遂图式中仅显示与本发明中有关的组件而非按照实际实施时的组件数目、形状及尺寸绘制，其实际实施时各组件的型态、数量及比例可为一种随意的改变，且其组件布局型态也可能更为复杂。在下文描述中，探讨了大量细节，以提供对本发明实施例的更透彻的解释，然而，对本领域技术人员来说，可以在没有这些具体细节的情况下实施本发明的实施例是显而易见的，在其他实施例中，以方框图的形式而不是以细节的形式来示出公知的结构和设备，以避免使本发明的实施例难以理解。图1为本发明的一示例性实施例示出的一种可插播的广告同步播放方法的流程图；如图1所示，本发明提供的一种可插播的广告同步播放方法，所述方法包括：S1：定时通过NTP协议与远程时间服务器进行时间同步；S2：通过MQTT协议实时订阅远程业务服务器的广告临时插播请求，若接收到远程业务服务器广告临时插播任务，下载要临时插播的广告内容，将其添加到待插播列表内，其中，待插播列表初始化为空，长度为0；S3：启用广告播放执行组件，完成广告同步播放。设置有一个播放列表，列表内含有n个广告素材，其播放顺序可用集合表示为，每个广告素材可以是图片或者视频，并且广告素材在播放列表内可以重复出现。每个广告素材的广告类型可以是商业素材，也可以是公益素材，但不能同时是商业素材和公益素材。播放列表M内的每个广告元素播放占用的耗时集合定义为/＞，按照播放顺序，集合表示为/＞。耗时集合/＞的总耗时定义为。其中，广告素材播放耗时的单位为秒，取值范围为正整数。设置有一批电子广告屏设备，每台设备当前的播放列表都是/＞。设置有一台电子广告屏设备，该设备为这一批电子广告屏设备中的任意一台，将其定义为设备S。设备S上搭载的系统，包括但不限于安卓系统、Linux系统、Windows系统、鸿蒙系统。图2为本发明的一示例性实施例示出的一种可插播的广告同步播放方法中步骤S1的流程图；如图2所示，本发明提供的一种可插播的广告同步播放方法，所述方法中步骤S1具体包括：S11：设置一个定时间隔，其中，/＞的取值范围为正整数，单位为秒；S12：当达到定时间隔时，获取远程时间服务器的UTC毫秒级时间戳为/＞，获取本地UTC毫秒级时间戳为/＞；S13：计算远程时间服务器的UTC毫秒级时间戳和本地UTC毫秒级时间戳/＞的毫秒级时间差/＞；S14：当的大小超过预设阈值T时，更新时间为远程时间服务器的时间。在一示例性的实施例中，定时间隔的最优值为30秒。当设备达到定时间隔/＞时，设备/＞获取远程时间服务器的UTC毫秒级时间戳为，设备/＞获取本地UTC毫秒级时间戳为/＞，计算两者之间的毫秒级时间差，若/＞的大小超过预设阈值T时，则马上修改设备/＞的时间为时钟服务器的时间。若/＞的大小没有超过预设阈值T时，设备/＞不执行修改时间操作。其中，预设阈值/＞的取值范围为正整数，单位为毫秒。在一示例性的实施例中，预设阈值T的最优值为80毫秒。图3为本发明的一示例性实施例示出的一种可插播的广告同步播放方法中步骤S3的逻辑流程图；如图3所示，步骤S3具体包括：S31：创建两个同样大小，属性相同的空组件和/＞；/＞S32：组件和/＞都设置两个事件触发，分别为播放开始事件Start和播放结束事件End；S33：电子广告屏设备首次启动时，组件默认加载播放列表/＞中的第一个广告素材/＞，当广告素材/＞加载完毕后，调用组件/＞的开始播放事件/＞ Start，当组件/＞播放完广告素材时，调用播放结束事件/＞ End，组件/＞播放结束事件/＞ End，调用组件/＞的播放开始事件/＞ Start，当组件/＞播放完广告素材时，调用播放结束事件/＞ End，组件/＞播放结束事件/＞ End，调用组件/＞的播放开始事件/＞ Start,通过组件/＞和/＞之间的递归调用，实现两个组件/＞和/＞轮流交替预加载广告素材，轮流交替渲染播放广告素材。在一示例性的实施例中，当前组件的播放开始事件Start的实现逻辑为：将另一组件显示状态设置为隐藏状态；将当前组件显示状态设置为显示状态；执行单机自校验逻辑，得到另一组件的预加载广告素材、当前组件自校验后的当前广告素材播放进度/＞，当前组件自校验后的当前广告素材剩余播放时长；若待插播列表非空，且预加载广告素材/＞的广告类型为公益广告，则取出待插播列表/＞的第一个待插播广告/＞，并触发另一组件预加载该待插播广告/＞；若待插播列表非空且预加载广告素材/＞的广告类型为非公益广告类型，或待插播列表/＞为空，则触发另一组件预加载广告素材/＞；当前组件按自校验后得到的当前广告素材播放进度，当前广告素材剩余播放时长/＞，播放已预加载的广告素材内容，其中，若当前组件为/＞，则另一组件为/＞，若当前组件为/＞，则另一组件为/＞。在一示例性的实施例中，当前组件的播放结束事件End的实现逻辑为：当前组件播放结束后调用另一组件播放开始事件，其中，若当前组件为，则另一组件为/＞，若当前组件为/＞，则另一组件为/＞。组件和/＞执行的单机自校验逻辑，具体过程如下：假设当前组件已预加载的广告素材为，初始化当前广告素材播放毫秒级进度/＞的值为0，单位为毫秒，当前广告素材剩余播放毫秒级时长/＞初始化值为已预加载的广告素材/＞对应的耗时/＞×1000，单位为毫秒。获取当前设备/＞的本地UTC毫秒级时间戳为/＞，获取当天日期0点0分0秒对应的UTC毫秒级时间戳为/＞，结合播放列表/＞对应耗时集合/＞的总耗时/＞，单位为毫秒。计算设备/＞按计划周期性循环执行播放列表/＞，目前应当处于的播放位置时间戳/＞，有：；其中，mod表示取余数。接下来计算，设备按计划当前应该播放第几个广告素材。由于播放列表M内的每个广告元素播放占用的耗时集合为，按照播放顺序，可用集合表示为/＞。且广告素材播放耗时的单位为秒，取值范围为正整数。假设设备/＞按计划当前该播放的广告素材位置为第i个，那么存在如下公式：；根据上述不等式，可以计算出i的值，即设备按计划当前该播放的广告素材/＞。此时，进一步计算设备当前按计划播放广告素材/＞，已播放的毫秒级时间戳进度/＞，有如下公式：；假设广告素材播放进度偏差毫秒级时间戳阈值为，广告素材预加载耗时毫秒级时间戳阈值为/＞，单位均为毫秒，取值范围为正整数。若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材不是同一个广告素材，并且/＞，将剩余播放毫秒级时长调整为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞。若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材不是同一个广告素材，并且/＞，将剩余播放毫秒级时长调整为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞。即由于预加载广告素材与当前应该播放的广告素材不是同一个，并且剩余播放毫秒级时长没有超过阈值/＞，即剩余时间不足以让另外一个组件预加载广告素材，那么默认将剩余播放时长累加下一个广告素材的耗时，让另外一个组件预加载下下个素材。若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材是同一个广告素材，并且/＞，将当前播放毫秒级进度/＞设置为/＞，并指定另外一个组件要预加载的广告素材/＞为广告素材/＞。若当前组件已预加载的广告素材与设备/＞按计划当前该播放的广告素材是同一个广告素材，并且/＞，则无需调整设备/＞当前播放毫秒级进度/＞，并指定另外一个组件要预加载的广告素材/＞为/＞。在一示例性的实施例中，播放进度偏差毫秒级时间戳阈值的最优取值为100毫秒，广告素材预加载耗时毫秒级时间戳阈值/＞的最优取值为3000毫秒。以上，组件和/＞执行单机自校验逻辑的具体过程结束。图4为本发明的一示例性实施例示出的一种可插播的广告同步播放系统结构示意图；如图4所示，该示例性的一种可插播的广告同步播放系统包括：时间同步模块401：定时通过NTP协议与远程时间服务器进行时间同步；广告插播监听模块402：通过MQTT协议实时订阅远程业务服务器的广告临时插播请求，若接收到远程业务服务器广告临时插播任务，下载要临时插播的广告内容，将其添加到待插播列表内，其中，待插播列表初始化为空，长度为0；广告播放执行模块403：启用广告播放执行组件，完成广告同步播放。需要说明的是，上述实施例所提供的一种可插播的广告同步播放系统与上述实施例所提供的一种可插播的广告同步播放方法属于同一构思，其中各个模块和单元执行操作的具体方式已经在方法实施例中进行了详细描述，此处不再赘述。上述实施例所提供的一种可插播的广告同步播放系统在实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将系统的内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能，本处也不对此进行限制。本申请的实施例还提供了一种电子设备，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述电子设备实现上述各个实施例中提供的一种可插播的广告同步播放方法。图5示出了适于用来实现本申请实施例的电子设备的计算机系统的结构示意图。需要说明的是，图5示出的电子设备的计算机系统500仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图5所示，计算机系统500包括中央处理单元501，其可以根据存储在只读存储器502中的程序或者从储存部分508加载到随机访问存储器503中的程序而执行各种适当的动作和处理，例如执行上述实施例中所述的方法。在RAM 503中，还存储有系统操作所需的各种程序和数据。CPU 501、ROM 502以及RAM 503通过总线504彼此相连。输入/输出接口505也连接至总线504。以下部件连接至I/O接口505：包括键盘、鼠标等的输入部分506；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分507；包括硬盘等的储存部分508；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分509。通信部分509经由诸如因特网的网络执行通信处理。驱动器510也根据需要连接至I/O接口505。可拆卸介质511，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器510上，以便于从其上读出的计算机程序根据需要被安装入储存部分508。特别地，根据本申请的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本申请的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的计算机程序。在这样的实施例中，该计算机程序可以通过通信部分509从网络上被下载和安装，和/或从可拆卸介质511被安装。在该计算机程序被中央处理单元501执行时，执行本申请的系统中限定的各种功能。需要说明的是，本申请实施例所示的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、闪存、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的计算机程序。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的计算机程序可以用任何适当的介质传输，包括但不限于：无线、有线等等，或者上述的任意合适的组合。附图中的流程图和框图，图示了按照本申请各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。其中，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本申请实施例中所涉及到的单元可以通过软件的方式实现，也可以通过硬件的方式来实现，所描述的单元也可以设置在处理器中。其中，这些单元的名称在某种情况下并不构成对该单元本身的限定。本申请的另一方面还提供了一种计算机可读存储介质，其上存储有计算机程序，该计算机程序被处理器执行时实现如前所述的一种可插播的广告同步播放方法。该计算机可读存储介质可以是上述实施例中描述的电子设备中所包含的，也可以是单独存在，而未装配入该电子设备中。本申请的另一方面还提供了一种计算机程序产品或计算机程序，该计算机程序产品或计算机程序包括计算机指令，该计算机指令存储在计算机可读存储介质中。计算机设备的处理器从计算机可读存储介质读取该计算机指令，处理器执行该计算机指令，使得该计算机设备执行上述各个实施例中提供的一种可插播的广告同步播放方法。上述实施例仅示例性说明本发明的原理及其功效，而非用于限制本发明。任何熟悉此技术的人士皆可在不违背本发明的精神及范畴下，对上述实施例进行修饰或改变。因此，但凡所属技术领域中具有通常知识者在未脱离本发明所揭示的精神与技术思想下所完成的一切等效修饰或改变，仍应由本发明的权利要求所涵盖。
