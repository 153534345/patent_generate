标题title
扫描设备的电子扫描方向校正方法、校正装置及扫描设备
摘要abst
本公开是关于一种扫描设备的电子扫描方向校正方法、扫描设备的电子扫描方向校正装置、存储介质及扫描设备。该扫描设备的电子扫描方向校正方法，包括获取由扫描设备对光栅标样扫描得到的光栅扫描图像；对光栅扫描图像进行图像处理，得到光栅扫描图像的图像形变参数；基于光栅扫描图像的图像形变参数，确定出扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；根据线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正，将电机控制信号的校正系数，下发到硬件系统中，完成图像形变校正，从而有利于获得正确的反映实际样品形貌的扫描图像。
权利要求书clms
1.一种扫描设备的电子扫描方向校正方法，其特征在于，包括：获取由所述扫描设备对光栅标样扫描得到的光栅扫描图像；对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数；基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。2.根据权利要求1所述的扫描设备的电子扫描方向校正方法，其特征在于，所述对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数，包括：对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像所对应的二值图像；对所述二值图像进行反相处理，并进行距离变换及图像分割，得到目标栅格图像；其中，所述目标栅格图像为所述光栅扫描图像中能够表征所述光栅扫描图像整体偏移特征的局部图像；获取所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角；将所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，作为所述光栅扫描图像的图像形变参数。3.根据权利要求2所述的扫描设备的电子扫描方向校正方法，其特征在于，所述对所述二值图像进行反相处理，并进行距离变换及图像分割，得到目标栅格图像，包括：对所述二值图像进行反相处理，得到二值反相图像；对所述二值图像和所述二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选预定数量的小栅格，得到所述预定数量的小栅格的平均尺寸；基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到所述目标栅格图像。4.根据权利要求3所述的扫描设备的电子扫描方向校正方法，其特征在于，所述基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到所述目标栅格图像，包括：基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到被分割后的第一类栅格和第二类栅格；在所述第一类栅格中确定出中心点连在一起构成菱形的四个第一类目标栅格；确定被所述四个第一类目标栅格环绕的所述第二类栅格为所述目标栅格图像。5.根据权利要求2所述的扫描设备的电子扫描方向校正方法，其特征在于，所述基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数，包括：基于所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，确定出控制电子束移动的X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比；将所述X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比，作为所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数。6.根据权利要求5所述的扫描设备的电子扫描方向校正方法，其特征在于，其中，X方向扫描线圈和Y方向扫描线圈之间的夹角θ为：，X方向扫描线圈和Y方向扫描线圈之间的扫描速度比k为：，其中，a和c均为中间系数；其中，， /＞，width为两个相邻边长的第一边长的长度，height为两个相邻边长的第二边长的长度，/＞为第一边长与水平方向的夹角，/＞为第二边长与水平方向的夹角。7.根据权利要求6所述的扫描设备的电子扫描方向校正方法，其特征在于，当所述X方向扫描线圈和Y方向扫描线圈之间的具有夹角θ和扫描速度比k时，所述电机驱动线圈移动所具有的线圈形变校正模型为：；其中，A、B、C、D均为控制信号的校正系数，Sx是扫描线圈控制水平方向的电流驱动信号、Sy是扫描线圈控制垂直方向的电流驱动信号，/＞为电机输出的扫描线圈实际控制信号，/＞为电机输出的扫描线圈理论控制信号；所述根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，包括：基于所述X方向扫描线圈和Y方向扫描线圈之间的夹角θ和扫描速度比k，及所述电机驱动线圈移动所具有的线圈形变校正模型，得到所述校正系数；其中，所述校正系数包括：A=1；B=-tan；C=0；D=k/cos。8.一种扫描设备的电子扫描方向校正装置，其特征在于，包括：图像获取模块，用于获取由所述扫描设备对光栅标样扫描得到的光栅扫描图像；图像处理模块，用于对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数；参数确定模块，用于基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；信号校正模块，用于根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。9.一种计算机可读存储介质，其特征在于，其上存储有扫描设备的电子扫描方向校正程序，该扫描设备的电子扫描方向校正程序被处理器执行时，实现权利要求1-7中任一项所述的扫描设备的电子扫描方向校正方法。10.一种扫描设备，其特征在于，包括存储器、处理器及存储在存储器上并可在处理器上运行的扫描设备的电子扫描方向校正程序，所述处理器执行所述扫描设备的电子扫描方向校正程序时，实现权利要求1-7中任一项所述的扫描设备的电子扫描方向校正方法。
说明书desc
技术领域本公开涉及图像扫描技术领域，尤其涉及一种扫描设备的电子扫描方向校正方法、扫描设备的电子扫描方向校正装置、存储介质及扫描设备。背景技术随着扫描电子显微镜的发展，电镜使用者可以方便地对样品做真实的微观观察。但是在成像过程中，由于控制成像的扫描线圈安装的工艺偏差或者线圈工作时产生固定异常，导致x和y线圈控制的扫描磁场的夹角偏离正常的90°，并且步长不同步时，扫描出来的图像就会表现出角度偏移和纹理拉伸现象，造成扫描图像相较于真实形貌产生变形。对于这种情况的出现，需要对扫描设备的电子扫描方向进行校正，以校正图像产生的形变。发明内容有鉴于此，本公开实施例期望提供一种扫描设备的电子扫描方向校正方法、扫描设备的电子扫描方向校正装置、存储介质及扫描设备。本公开的技术方案是这样实现的：第一方面，本公开提供一种扫描设备的电子扫描方向校正方法。本公开实施例提供的扫描设备的电子扫描方向校正方法，包括：获取由所述扫描设备对光栅标样扫描得到的光栅扫描图像；对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数；基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。在一些实施例中，所述对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数，包括：对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像所对应的二值图像；对所述二值图像进行反相处理，并进行距离变换及图像分割，得到目标栅格图像；其中，所述目标栅格图像为所述光栅扫描图像中能够表征所述光栅扫描图像整体偏移特征的局部图像；获取所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角；将所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，作为所述光栅扫描图像的图像形变参数。在一些实施例中，所述对所述二值图像进行反相处理，并进行距离变换及图像分割，得到目标栅格图像，包括：对所述二值图像进行反相处理，得到二值反相图像；对所述二值图像和所述二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选预定数量的小栅格，得到所述预定数量的小栅格的平均尺寸；基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到所述目标栅格图像。在一些实施例中，所述基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到所述目标栅格图像，包括：基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到被分割后的第一类栅格和第二类栅格；在所述第一类栅格中确定出中心点连在一起构成菱形的四个第一类目标栅格；确定被所述四个第一类目标栅格环绕的所述第二类栅格为所述目标栅格图像。在一些实施例中，所述基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数，包括：基于所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，确定出控制电子束移动的X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比；将所述X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比，作为所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数。在一些实施例中，X方向扫描线圈和Y方向扫描线圈之间的夹角θ为：，X方向扫描线圈和Y方向扫描线圈之间的扫描速度比k为：，其中，a和c均为中间系数；其中，，/＞，width为两个相邻边长的第一边长的长度，height为两个相邻边长的第二边长的长度，/＞为第一边长与水平方向的夹角，/＞为第二边长与水平方向的夹角。在一些实施例中，当所述X方向扫描线圈和Y方向扫描线圈之间的具有夹角θ和扫描速度比k时，所述电机驱动线圈移动所具有的线圈形变校正模型为：；其中，A、B、C、D均为控制信号的校正系数，Sx是扫描线圈控制水平方向的电流驱动信号、Sy是扫描线圈控制垂直方向的电流驱动信号，/＞为电机输出的扫描线圈实际控制信号，/＞为电机输出的扫描线圈理论控制信号；所述根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，包括：基于所述X方向扫描线圈和Y方向扫描线圈之间的夹角θ和扫描速度比k，及所述电机驱动线圈移动所具有的线圈形变校正模型，得到所述校正系数；其中，所述校正系数包括：A=1；B=-tan；C=0；D=k/cos。第二方面，本公开提供一种扫描设备的电子扫描方向校正装置，包括：图像获取模块，用于获取由所述扫描设备对光栅标样扫描得到的光栅扫描图像；图像处理模块，用于对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数；参数确定模块，用于基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；信号校正模块，用于根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。第三方面，本公开提供一种计算机可读存储介质，其上存储有扫描设备的电子扫描方向校正程序，该扫描设备的电子扫描方向校正程序被处理器执行时，实现上述第一方面所述的扫描设备的电子扫描方向校正方法。第四方面，本公开提供一种扫描设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的扫描设备的电子扫描方向校正程序，所述处理器执行所述扫描设备的电子扫描方向校正程序时，实现上述第一方面所述的扫描设备的电子扫描方向校正方法。根据本公开实施例的扫描设备的电子扫描方向校正方法，包括获取由扫描设备对光栅标样扫描得到的光栅扫描图像；对光栅扫描图像进行图像处理，得到光栅扫描图像的图像形变参数；基于光栅扫描图像的图像形变参数，确定出扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；根据线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。本申请中通过扫描设备对光栅标样扫描得到光栅扫描图像，通过对光栅扫描图像进行图像处理，得到光栅扫描图像的图像形变参数，再经过线圈形变校正模型，转换得到电机控制信号的校正系数，以下发到硬件系统中，完成图像形变校正，从而有利于获得正确的反映实际样品形貌的扫描图像。本公开附加的方面和优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本公开的实践了解到。附图说明图1是根据一示例性实施例示出的扫描设备的电子扫描方向校正方法流程图；图2是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像；图3是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像降噪后的降噪图像；图4是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像对应的二值图；图5是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像对应的二值反相图；图6是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像对应的图像分割示意图；图7是根据一示例性实施例示出的图像分割后的光栅扫描图像；图8是根据一示例性实施例示出的图像分割后的光栅扫描图像中第一类栅格与第二类栅格分类图；图9是根据一示例性实施例示出的形变前后对应坐标变换示意图；图10是根据一示例性实施例示出的相对坐标系示意图；图11是根据一示例性实施例示出的网格夹角示例示意图；图12是根据一示例性实施例示出的硬件结构示意图；图13是根据一示例性实施例示出的扫描设备的电子扫描方向校正装置结构示意图。具体实施方式下面详细描述本公开的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，旨在用于解释本公开，而不能理解为对本公开的限制。随着扫描电子显微镜的发展，电镜使用者可以方便地对样品做真实的微观观察。但是在成像过程中，由于控制成像的扫描线圈安装的工艺偏差或者线圈工作时产生固定异常，导致x和y线圈控制的扫描磁场的夹角偏离正常的90°，并且步长不同步时，扫描出来的图像就会表现出角度偏移和纹理拉伸现象，造成扫描图像相较于真实形貌产生变形。对于这种情况的出现，需要对扫描设备的电子扫描方向进行校正，以校正图像产生的形变。针对上述情况，本公开提供一种扫描设备的电子扫描方向校正方法。图1是根据一示例性实施例示出的扫描设备的电子扫描方向校正方法流程图。如图1所示，该扫描设备的电子扫描方向校正方法，包括：步骤10、获取由所述扫描设备对光栅标样扫描得到的光栅扫描图像；步骤11、对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数；步骤12、基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；步骤13、根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。在示例性实施例中，扫描设备可以是扫描电子显微镜。可以在电镜中放置光栅标样，拍摄一帧清晰的光栅扫描图像，来进行参数标定。图2是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像。如图2所示，标定过程中采取的标样为光栅样品，光栅样品中包含有大量正方向的栅格及黑色背景方格，其中一个栅格四周环绕四个黑色背景方格。当样品光栅放置时边长与扫描线圈x轴平行，网格边长夹角等价于线圈夹角。由于该位置难以控制，因此校正时可不限定光栅摆放位置。在标定过程中，形变图像中网格长宽比能够反映拉伸系数，其方形栅格形成的角度能反映线圈夹角。然后对光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数。图像形变参数能够用于表征光栅扫描图像的整体图像特征。线圈形变参数主要包括线圈间的夹角和扫描速度比。再根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。本公开中通过扫描设备对光栅标样扫描得到光栅扫描图像，通过对光栅扫描图像进行图像处理，得到光栅扫描图像的图像形变参数，再经过线圈形变校正模型，转换得到电机控制信号的校正系数，以下发到硬件系统中，完成图像形变校正，从而有利于获得正确的反映实际样品形貌的扫描图像。在一些实施例中，所述对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数，包括：对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像所对应的二值图像；对所述二值图像进行反相处理，并进行距离变换及图像分割，得到目标栅格图像；其中，所述目标栅格图像为所述光栅扫描图像中能够表征所述光栅扫描图像整体偏移特征的局部图像；获取所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角；将所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，作为所述光栅扫描图像的图像形变参数。在示例性实施例中，对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像所对应的二值图像，包括：对所述光栅扫描图像进行平滑去噪处理，得到降噪图像；对所述降噪图像，进行二值化处理，得到所述光栅扫描图像所对应的二值图像。通过平滑去噪处理可减少图像噪声干扰。对所述二值图像进行反相处理前，可对二值图像进行开运算去除细小噪点干扰，然后对降噪后的二值图像进行反相处理，得到二值反相图像。图3是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像降噪后的降噪图像。如图3所示为光栅扫描图像降噪后的降噪图像。图4是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像对应的二值图。如图4所示为光栅扫描图像对应的二值图。在示例性实施例中，所述对所述二值图像进行反相处理，并进行距离变换及图像分割，得到目标栅格图像，包括：对所述二值图像进行反相处理，得到二值反相图像；对所述二值图像和所述二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选预定数量的小栅格，得到所述预定数量的小栅格的平均尺寸；基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到所述目标栅格图像。在示例性实施例中，对所述二值图像和所述二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选出尽量多的小栅格。根据小栅格的尺寸求取平均尺寸。基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，以将光栅扫描图像中的栅格和黑色背景方格分割开来，得到大量独立具有轮廓坐标的栅格，以便于在分割后的图像中确定出目标栅格图像。其中，图5是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像对应的二值反相图。对图4的二值图和图5的二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选出尽量多的小栅格。此处的小栅格指图中的黑白格。在一些实施例中，所述基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到所述目标栅格图像，包括：基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到被分割后的第一类栅格和第二类栅格；在所述第一类栅格中确定出中心点连在一起构成菱形的四个第一类目标栅格；确定被所述四个第一类目标栅格环绕的所述第二类栅格为所述目标栅格图像。在示例性实施例中，基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到被分割后的第一类栅格和第二类栅格，包括：基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到二值分割图像；所述二值分割图像中包含有分割后的黑色四边形和白色四边形；将所述二值分割图像中的黑色四边形和白色四边形进行图像拟合，得到图像分割后的光栅扫描图像；对所述图像分割后的光栅扫描图像进行边缘四边形剔除处理，得到轮廓完整的光栅扫描图像；其中，所述图像分割后的光栅扫描图像中包含有被分割后的第一类栅格和第二类栅格；其中，第一类栅格可以为黑色背景方格。第二类栅格可以为图2所示的白色栅格。图6是根据一示例性实施例示出的扫描设备扫描出的光栅扫描图像对应的图像分割示意图。如图6所示，由小栅格边长对方块背景目标进行剪边，将粘连的白色方块缩小使其分割。图7是根据一示例性实施例示出的图像分割后的光栅扫描图像。如图7所示，目标四边形拟合，得到图像分割后的光栅扫描图像。图8是根据一示例性实施例示出的图像分割后的光栅扫描图像中第一类栅格与第二类栅格分类图。如图8所示，得到光栅扫描图像中第一类栅格与第二类栅格分类图。在一些实施例中，所述基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数，包括：基于所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，确定出控制电子束移动的X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比；将所述X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比，作为所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数。在示例性实施例中，X方向扫描线圈和Y方向扫描线圈之间的夹角θ为：，X方向扫描线圈和Y方向扫描线圈之间的扫描速度比k为：，其中，a和c均为中间系数；其中，，/＞，width为两个相邻边长的第一边长的长度，height为两个相邻边长的第二边长的长度，/＞为第一边长与水平方向的夹角，/＞为第二边长与水平方向的夹角。在示例性实施例中，通过上述a和c中间系数，结合目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，确定出控制电子束移动的X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比。在示例性实施例中，由于图像产生形变是由于扫描线圈夹角不为90°，以及扫描速度不一致造成的，以下说明上述实施例的推导原理：图9是根据一示例性实施例示出的形变前后对应坐标变换示意图。如图9所示，y’偏移后的与x’形成的夹角为，原来的正方形ABCD变成了右侧的平行四边形A’B’C’D’，需要通过图像算法测量出边A’B’与边A’D’的夹角，然后经过推理得出/＞。图10是根据一示例性实施例示出的相对坐标系示意图。将变换前后坐标系置于相同视野中，如图10所示，假设变换前坐标系中一点A坐标为，变换后图像坐标系中与其对应的点A’的坐标则为/＞，坐标轴Y’与X’的夹角为/＞，Y’方向拉伸系数为k，则变换前后的关系如下公式所示：；设向量，/＞，则理论上在原来坐标系应有如下关系：/＞，且。然后在原坐标系下可以用两点表示一向量，如下：则变换之后的与相对应的/＞，就可以通过将坐标变换代入上式和得出：此时，假设正方形两条边的向量为，/＞， a＞0转化到变换后的坐标系中，则结合由公式得到，；图11是根据一示例性实施例示出的网格夹角示例示意图。如图11所示，经图像处理算法可以得出网格的长宽比与夹角大小，及如网格长宽对应关系：边长A’B’与水平线的夹角，边长A’D’与水平线的夹角/＞，/＞，，先求系数a，根据公式、，可得到下式。求解方式为变换后两个向量纵坐标绝对值相除如下：公式；同上，根据公式、，通过坐标变换后两个向量的横坐标相除求出，如下，其中c为中间假设值，令/＞，则由，结合公式，则有：；从而可以求得线圈夹角为：；最后求拉伸系数k，先假设,/＞分别为/＞、/＞的斜率，可表达为下式：，；综上可得，；；；。在一些实施例中，当所述X方向扫描线圈和Y方向扫描线圈之间的具有夹角θ和扫描速度比k时，所述电机驱动线圈移动所具有的线圈形变校正模型为：；其中，A、B、C、D均为控制信号的校正系数，Sx是扫描线圈控制水平方向的电流驱动信号、Sy是扫描线圈控制垂直方向的电流驱动信号，/＞为电机输出的扫描线圈实际控制信号，/＞为电机输出的扫描线圈理论控制信号；所述根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，包括：基于所述X方向扫描线圈和Y方向扫描线圈之间的夹角θ和扫描速度比k，及所述电机驱动线圈移动所具有的线圈形变校正模型，得到所述校正系数；其中，所述校正系数包括：A=1；B=-tan；C=0；D=k/cos。在示例性实施例中，图12是根据一示例性实施例示出的硬件结构示意图。如图12所示，Sx、Sy是扫描线圈控制水平方向和垂直方向的电流驱动信号，经过A,B,C,D四个系数控制，再输出实际的控制电流Cx’,Cy’。其中=Cx’，以及=Cy’，通过校正系数对电流驱动信号的校正，可以实现安装扫描方向的旋转以及校正。理想情况下Sx、Sy应该保持正交，并且速度比为1。此时不用做校正，输出的Cx’和Cy’与Sx、Sy相等。实际情况下，Sx、Sy存在偏离90°的夹角，以及速度比k。此时，需要通过校正系数A、B、C、D，给予校正，使其输出的Cx’、Cy’与理论一致。由于硬件x，y方向扫描成一定夹角导致扫描出现形变。除了角度的变化，x、y每走一步的长度会导致y方向的拉伸或压缩。设理论硬件x、y方向的扫描分别为Cx、Cy，安装的硬件扫描方向为Sx、Sy，而实际输出的扫描方向为Cx’、Cy’。如果不做校正，则；此时输出Cx’、Cy’不正交，并且存在速度差，反应在图像上即会产生形变。如果要做校正，使Cx、Cy’与Cx、Cy一致，则图像不会产生形变。推导过程可用一个图例简单说明：如上图，假设上图代表真实的位置，为了从Pa扫到点Pb，真实的扫描方向是图中线Sx、Sy所指示的方向，其夹角为且Sx的速度为Sy的k倍。设正方形边长L，则从Pb-＞Pa, Sx 需要走L长度, Sy 不需要走；从Pa-＞Pc，则需要Sx走-L*tan, Sy需要走L/cos。同理可以知道，如果要从扫描到,Sx, Sy分别需要走。因为Sx的步长为Sy的k倍，则需要走；根据Sx，Sy的偏离夹角，和速度比k，可推导出，即得到A=1；B=-tan；C=0；D=k/cos。本公开提供的扫描设备的电子扫描方向校正方法，能自动完成扫描线圈导致的形变问题，校正过程简单快速并且准确。同时参数检测算法快速且准确，对于不同质量的图像均能准确检测所需参数。本公开提供一种扫描设备的电子扫描方向校正装置。图13是根据一示例性实施例示出的扫描设备的电子扫描方向校正装置结构示意图。如图13所示，扫描设备的电子扫描方向校正装置，包括：图像获取模块20，用于获取由所述扫描设备对光栅标样扫描得到的光栅扫描图像；图像处理模块21，用于对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数；参数确定模块22，用于基于所述光栅扫描图像的图像形变参数，确定出所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数；信号校正模块23，用于根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。在示例性实施例中，扫描设备可以是扫描电子显微镜。可以在电镜中放置光栅标样，拍摄一帧清晰的光栅扫描图像，来进行参数标定。如图2所示，标定过程中采取的标样为光栅样品，光栅样品中包含有大量正方向的栅格及黑色背景方格，其中一个栅格四周环绕四个黑色背景方格。当样品光栅放置时边长与扫描线圈x轴平行，网格边长夹角等价于线圈夹角。由于该位置难以控制，因此校正时可不限定光栅摆放位置。在标定过程中，形变图像中网格长宽比能够反映拉伸系数，其方形栅格形成的角度能反映线圈夹角。然后对光栅扫描图像进行图像处理，得到所述光栅扫描图像的图像形变参数。图像形变参数能够用于表征光栅扫描图像的整体图像特征。线圈形变参数主要包括线圈间的夹角和扫描速度比。再根据所述线圈形变参数及电机驱动线圈移动所具有的线圈形变校正模型，得到校正系数，以对电机驱动线圈时控制线圈移动的控制信号进行信号校正。本申请中通过扫描设备对光栅标样扫描得到光栅扫描图像，通过对光栅扫描图像进行图像处理，得到光栅扫描图像的图像形变参数，再经过线圈形变校正模型，转换得到电机控制信号的校正系数，以下发到硬件系统中，完成图像形变校正，从而有利于获得正确的反映实际样品形貌的扫描图像。在一些实施例中，所述图像处理模块21，用于对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像所对应的二值图像；对所述二值图像进行反相处理，并进行距离变换及图像分割，得到目标栅格图像；其中，所述目标栅格图像为所述光栅扫描图像中能够表征所述光栅扫描图像整体偏移特征的局部图像；获取所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角；将所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，作为所述光栅扫描图像的图像形变参数。在示例性实施例中，对所述光栅扫描图像进行图像处理，得到所述光栅扫描图像所对应的二值图像，包括：对所述光栅扫描图像进行平滑去噪处理，得到降噪图像；对所述降噪图像，进行二值化处理，得到所述光栅扫描图像所对应的二值图像。通过平滑去噪处理可减少图像噪声干扰。对所述二值图像进行反相处理前，可对二值图像进行开运算去除细小噪点干扰，然后对降噪后的二值图像进行反相处理，得到二值反相图像。如图3所示为光栅扫描图像降噪后的降噪图像。如图4所示为光栅扫描图像对应的二值图。在示例性实施例中，所述图像处理模块21，用于对所述二值图像进行反相处理，得到二值反相图像；对所述二值图像和所述二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选预定数量的小栅格，得到所述预定数量的小栅格的平均尺寸；基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到所述目标栅格图像。在示例性实施例中，对所述二值图像和所述二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选出尽量多的小栅格。根据小栅格的尺寸求取平均尺寸。基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，以将光栅扫描图像中的栅格和黑色背景方格分割开来，得到大量独立具有轮廓坐标的栅格，以便于在分割后的图像中确定出目标栅格图像。其中，对图4的二值图和图5的二值反相图像进行图像轮廓搜索，在所述二值图像和所述二值反相图像中筛选出尽量多的小栅格。此处的小栅格指图中的黑白格。在一些实施例中，所述图像处理模块21，用于基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到被分割后的第一类栅格和第二类栅格；在所述第一类栅格中确定出中心点连在一起构成菱形的四个第一类目标栅格；确定被所述四个第一类目标栅格环绕的所述第二类栅格为所述目标栅格图像。在示例性实施例中，基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到被分割后的第一类栅格和第二类栅格，包括：基于所述小栅格的平均尺寸，对距离变换后的二值反相图像，进行图像分割，得到二值分割图像；所述二值分割图像中包含有分割后的黑色四边形和白色四边形；将所述二值分割图像中的黑色四边形和白色四边形进行图像拟合，得到图像分割后的光栅扫描图像；对所述图像分割后的光栅扫描图像进行边缘四边形剔除处理，得到轮廓完整的光栅扫描图像；其中，所述图像分割后的光栅扫描图像中包含有被分割后的第一类栅格和第二类栅格；其中，第一类栅格可以为黑色背景方格。第二类栅格可以为图2所示的白色栅格。如图6所示，由小栅格边长对方块背景目标进行剪边，将粘连的白色方块缩小使其分割。如图7所示，目标四边形拟合，得到图像分割后的光栅扫描图像。如图8所示，得到光栅扫描图像中第一类栅格与第二类栅格分类图。在一些实施例中，所述参数确定模块22，用于基于所述目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，确定出控制电子束移动的X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比；将所述X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比，作为所述扫描设备对光栅标样扫描时控制电子束移动的线圈所具有的线圈形变参数。在示例性实施例中，X方向扫描线圈和Y方向扫描线圈之间的夹角θ为：，X方向扫描线圈和Y方向扫描线圈之间的扫描速度比k为：，其中，a和c均为中间系数；其中，，/＞，width为两个相邻边长的第一边长的长度，height为两个相邻边长的第二边长的长度，/＞为第一边长与水平方向的夹角，/＞为第二边长与水平方向的夹角。在示例性实施例中，通过上述a和c中间系数，结合目标栅格图像的两个相邻边长及所述两个相邻边长分别与水平线的夹角，确定出控制电子束移动的X方向扫描线圈和Y方向扫描线圈之间的夹角和扫描速度比。在示例性实施例中，由于图像产生形变是由于扫描线圈夹角不为90°，以及扫描速度不一致造成的，以下说明上述实施例的推导原理：如图9所示，y’偏移后的与x’形成的夹角为，原来的正方形ABCD变成了右侧的平行四边形A’B’C’D’，需要通过图像算法测量出边A’B’与边A’D’的夹角，然后经过推理得出。将变换前后坐标系置于相同视野中，如图10所示，假设变换前坐标系中一点A坐标为，变换后图像坐标系中与其对应的点A’的坐标则为/＞，坐标轴Y’与X’的夹角为，Y’方向拉伸系数为k，则变换前后的关系如下公式所示：；设向量，/＞，则理论上在原来坐标系应有如下关系：/＞，且。然后在原坐标系下可以用两点表示一向量，如下：则变换之后的与相对应的/＞，就可以通过将坐标变换代入上式和得出：此时，假设正方形两条边的向量为，/＞， a＞0转化到变换后的坐标系中，则结合由公式得到，；如图11所示，经图像处理算法可以得出网格的长宽比与夹角大小，及如网格长宽对应关系：边长A’B’与水平线的夹角，边长A’D’与水平线的夹角/＞，/＞，，先求系数a，根据公式、，可得到下式。求解方式为变换后两个向量纵坐标绝对值相除如下：公式；同上，根据公式、，通过坐标变换后两个向量的横坐标相除求出，如下，其中c为中间假设值，令/＞，则由，结合公式，则有：；从而可以求得线圈夹角为：；最后求拉伸系数k，先假设,/＞分别为/＞、/＞的斜率，可表达为下式：，；综上可得，；；；。在一些实施例中，当所述X方向扫描线圈和Y方向扫描线圈之间的具有夹角θ和扫描速度比k时，所述电机驱动线圈移动所具有的线圈形变校正模型为：；其中，A、B、C、D均为控制信号的校正系数，Sx是扫描线圈控制水平方向的电流驱动信号、Sy是扫描线圈控制垂直方向的电流驱动信号，/＞为电机输出的扫描线圈实际控制信号，/＞为电机输出的扫描线圈理论控制信号；所述信号校正模块23，用于基于所述X方向扫描线圈和Y方向扫描线圈之间的夹角θ和扫描速度比k，及所述电机驱动线圈移动所具有的线圈形变校正模型，得到所述校正系数；其中，所述校正系数包括：A=1；B=-tan；C=0；D=k/cos。在示例性实施例中，如图12所示，Sx、Sy是扫描线圈控制水平方向和垂直方向的电流驱动信号，经过A,B,C,D四个系数控制，再输出实际的控制电流Cx’,Cy’。其中=Cx’，以及=Cy’，通过校正系数对电流驱动信号的校正，可以实现安装扫描方向的旋转以及校正。理想情况下Sx、Sy应该保持正交，并且速度比为1。此时不用做校正，输出的Cx’和Cy’与Sx、Sy相等。实际情况下，Sx、Sy存在偏离90°的夹角，以及速度比k。此时，需要通过校正系数A、B、C、D，给予校正，使其输出的Cx’、Cy’与理论一致。由于硬件x，y方向扫描成一定夹角导致扫描出现形变。除了角度的变化，x、y每走一步的长度会导致y方向的拉伸或压缩。设理论硬件x、y方向的扫描分别为Cx、Cy，安装的硬件扫描方向为Sx、Sy，而实际输出的扫描方向为Cx’、Cy’。如果不做校正，则；此时输出Cx’、Cy’不正交，并且存在速度差，反应在图像上即会产生形变。如果要做校正，使Cx、Cy’与Cx、Cy一致，则图像不会产生形变。推导过程可用一个图例简单说明：如上图，假设上图代表真实的位置，为了从Pa扫到点Pb，真实的扫描方向是图中线Sx、Sy所指示的方向，其夹角为且Sx的速度为Sy的k倍。设正方形边长L，则从Pb-＞Pa, Sx 需要走L长度, Sy 不需要走；从Pa-＞Pc，则需要Sx走-L*tan, Sy需要走L/cos。同理可以知道，如果要从扫描到,Sx, Sy分别需要走。因为Sx的步长为Sy的k倍，则需要走；根据Sx，Sy的偏离夹角，和速度比k，可推导出，即得到A=1；B=-tan；C=0；D=k/cos。本公开提供一种计算机可读存储介质，其上存储有扫描设备的电子扫描方向校正程序，该扫描设备的电子扫描方向校正程序被处理器执行时，实现上述各实施例所述的扫描设备的电子扫描方向校正方法。本公开提供一种扫描设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的扫描设备的电子扫描方向校正程序，所述处理器执行所述扫描设备的电子扫描方向校正程序时，实现上述各实施例所述的扫描设备的电子扫描方向校正方法。需要说明的是，在流程图中表示或在此以其他方式描述的逻辑和/或步骤，例如，可以被认为是用于实现逻辑功能的可执行指令的定序列表，可以具体实现在任何计算机可读介质中，以供指令执行系统、装置或设备使用，或结合这些指令执行系统、装置或设备而使用。就本说明书而言，“计算机可读介质”可以是任何可以包含、存储、通信、传播或传输程序以供指令执行系统、装置或设备或结合这些指令执行系统、装置或设备而使用的装置。计算机可读介质的更具体的示例包括以下：具有一个或多个布线的电连接部，便携式计算机盘盒，随机存取存储器，只读存储器，可擦除可编辑只读存储器，光纤装置，以及便携式光盘只读存储器。另外，计算机可读介质甚至可以是可在其上打印程序的纸或其他合适的介质，因为可以例如通过对纸或其他介质进行光学扫描，接着进行编辑、解译或必要时以其他合适方式进行处理来以电子方式获得程序，然后将其存储在计算机存储器中。应当理解，本公开的各部分可以用硬件、软件、固件或它们的组合来实现。在上述实施方式中，多个步骤或方法可以用存储在存储器中且由合适的指令执行系统执行的软件或固件来实现。例如，如果用硬件来实现，和在另一实施方式中一样，可用本领域公知的下列技术中的任一项或他们的组合来实现：具有用于对数据信号实现逻辑功能的逻辑门电路的离散逻辑电路，具有合适的组合逻辑门电路的专用集成电路，可编程门阵列，现场可编程门阵列等。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本公开的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不一定指的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任何的一个或多个实施例或示例中以合适的方式结合。在本公开的描述中，需要理解的是，术语“中心”、“纵向”、“横向”、“长度”、“宽度”、“厚度”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”“内”、“外”、“顺时针”、“逆时针”、“轴向”、“径向”、“周向”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本公开和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本公开的限制。此外，本公开实施例中所使用的“第一”、“第二”等术语，仅用于描述目的，而不可以理解为指示或者暗示相对重要性，或者隐含指明本实施例中所指示的技术特征数量。由此，本公开实施例中限定有“第一”、“第二”等术语的特征，可以明确或者隐含地表示该实施例中包括至少一个该特征。在本公开的描述中，词语“多个”的含义是至少两个或者两个及以上，例如两个、三个、四个等，除非实施例中另有明确具体的限定。在本公开中，除非实施例中另有明确的相关规定或者限定，否则实施例中出现的术语“安装”、“相连”、“连接”和“固定”等应做广义理解，例如，连接可以是固定连接，也可以是可拆卸连接，或成一体，可以理解的，也可以是机械连接、电连接等；当然，还可以是直接相连，或者通过中间媒介进行间接连接，或者可以是两个元件内部的连通，或者两个元件的相互作用关系。对于本领域的普通技术人员而言，能够根据具体的实施情况理解上述术语在本公开中的具体含义。在本公开中，除非另有明确的规定和限定，第一特征在第二特征“上”或“下”可以是第一和第二特征直接接触，或第一和第二特征通过中间媒介间接接触。而且，第一特征在第二特征“之上”、“上方”和“上面”可是第一特征在第二特征正上方或斜上方，或仅仅表示第一特征水平高度高于第二特征。第一特征在第二特征“之下”、“下方”和“下面”可以是第一特征在第二特征正下方或斜下方，或仅仅表示第一特征水平高度小于第二特征。尽管上面已经示出和描述了本公开的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本公开的限制，本领域的普通技术人员在本公开的范围内可以对上述实施例进行变化、修改、替换和变型。
