标题title
一种高通量网络环境下的信标植入检测方法
摘要abst
本发明公开了一种高通量网络环境下的信标植入检测方法，该方法包括：将信标应用在DPDK+VPP网络框架，支持高通量的网络通信环境；在VPP原有节点的基础上加入信标植入节点和信标检测节点，对符合策略的矢量数据包进行信标植入和检测；在网络层、传输层和应用层，基于处理框架VPP的信标植入节点进行网络信标植入；支持IP、TCP、HTTP和DNS协议网络数据包植入；可基于处理框架VPP的信标检测节点进行网络信标检测，当检测到信标数据后进行信标提取并存储。该方法将网络信标与DPDK+VPP结合起来，应用于高吞吐率的网络环境中，实现矢量数据包的批量处理，降低了网络信标产生的时间开销。
权利要求书clms
1.一种高通量网络环境下的信标植入检测方法，其特征在于，包括以下步骤：构建框架：将信标应用在DPDK+VPP网络框架，支持高通量的网络通信环境；在VPP原有节点的基础上加入信标植入节点和信标检测节点，对符合策略的矢量数据包进行信标植入和检测；信标植入：在网络层、传输层和应用层，基于处理框架VPP的信标植入节点进行网络信标植入；支持IP、TCP、HTTP和DNS协议网络数据包植入；信标检测：在网络层、传输层和应用层，基于处理框架VPP的信标检测节点进行网络信标检测，当检测到信标数据后进行信标提取并存储。2.根据权利要求1所述的一种高通量网络环境下的信标植入检测方法，其特征在于，该方法还包括以下步骤：信标数据压缩：在单包溯源场景中，当单个信标数据长度大于阈值时，使用哈希算法进行信标数据压缩处理。3.根据权利要求1所述的一种高通量网络环境下的信标植入检测方法，其特征在于，在所述DPDK+VPP网络框架中：DPDK运行在用户空间，通过大页内存、轮询方法进行矢量数据包处理，绕过Linux内核协议栈的处理；在DPDK的基础上加入矢量数据包处理框架VPP作为虚拟路由或交换机，矢量数据包向量依次通过VPP数据包处理节点，在各节点实现矢量数据包的批量处理。4.根据权利要求1所述的一种高通量网络环境下的信标植入检测方法，其特征在于，在所述信标植入步骤中，还包括：在信标植入之前，引入信标数据包过滤机制，根据配置的信标策略对矢量数据包进行过滤筛选，对符合信标策略的矢量数据包进行信标植入。5.根据权利要求1所述的一种高通量网络环境下的信标植入检测方法，其特征在于，在所述信标植入步骤中，IP协议网络数据包植入具体包括：IP协议信标通过修改矢量数据包报文头部的id字段和tos字段植入信标，id字段用于植入8 bit信标数据，tos字段用于植入16 bit信标数据，植入完成后更新IP头部的校验值，完成IP信标的植入。6.根据权利要求1所述的一种高通量网络环境下的信标植入检测方法，其特征在于，在所述信标植入步骤中，TCP协议网络数据包植入具体包括：TCP协议信标选择在TCP报文首部的Options字段进行信标植入，单个矢量数据包选取20 bytes进行信标数据标记，植入完成后更新IP和TCP头部的校验值，并更新矢量数据包长度字段，完成TCP信标的植入。7.根据权利要求1所述的一种高通量网络环境下的信标植入检测方法，其特征在于，在所述信标植入步骤中，HTTP协议网络数据包植入具体包括：HTTP协议信标在HTTP协议请求包的User-Agent字段植入信标，对信标数据进行bash64可见字符编码，将编码后的可见字符串信标植入到数据包User-Agent字段中，植入完成后更新IP和TCP头部的校验值，并更新矢量数据包长度字段，完成HTTP信标的植入。8.根据权利要求1所述的一种高通量网络环境下的信标植入检测方法，其特征在于，在所述信标植入步骤中，DNS协议网络数据包植入具体包括：DNS协议信标通过DNS数据包中的Queries字段进行信标植入，单个矢量数据包选取18bytes进行信标数据标记，植入完成后更新IP和UDP头部的校验值，并更新矢量数据包长度字段，完成DNS信标的植入。9.根据权利要求2所述的一种高通量网络环境下的信标植入检测方法，其特征在于，所述信标数据压缩步骤具体包括：在单包溯源场景中，当单个信标数据长度大于单个数据包所能植入的最大长度时，调用哈希函数对信标数据进行压缩；将哈希压缩后的信标数据植入到矢量数据包中，并将哈希前的信标数据作为哈希表中的value值存入，将哈希之后的信标数据作为对应的key值存入哈希表。10.根据权利要求9所述的一种高通量网络环境下的信标植入检测方法，其特征在于，在所述信标检测步骤中：信标检测节点根据提取的信标数据，作为key值在所述哈希表查找对应的value值，获取原始的信标数据。
说明书desc
技术领域本发明涉及计算机网络安全技术领域，更具体的说是涉及一种高通量网络环境下的信标植入检测方法。背景技术互联网是把双刃剑，提高生活质量与便利的同时，网络安全的问题也一直存在。随着互联网的不断发展，网络安全越来越成为人们关注的焦点，网络入侵者为了自身利益，通过各种攻击手段非法侵占他人资源。这些网络攻击给个人、企业等带来了严重的损害，如何追踪攻击流量，识别攻击来源成为一个重要问题。由于TCP/IP协议本身不具备对攻击路径进行溯源的能力，导致在现实网络环境中不能对数据包的来源进行认证，难以分析出入侵行为的攻击路径。为了解决上述问题，研究者提出了许多方法针对目标流量进行路径追踪溯源，其中数据包标记法发展较为迅速，该方法通过在目标网络流的数据包中植入网络信标，实现对数据包的标记，在网络其他位置进行网络信标的检测，从而实现针对目标网络流的追踪溯源。网络信标利用数据包冗余字段传输信标信息，具有较高的准确性和抗干扰性，可以应用于网络环境较差的场景，为解决攻击者路径追踪问题提供了一种有效的手段。现有方案使用网络信标植入检测技术可以初步实现网络流量追踪的需求，但该方案有以下缺点：1.传统的网络信标技术时间开销较大，影响网络传输性能，不能用于高吞吐率的网络环境中。2.在流量溯源场景中，单个数据包承载的信标数据有限，信标单包溯源效率较低。发明内容有鉴于此，本发明提供了一种高通量网络环境下的信标植入检测方法，可以至少部分解决上述技术问题，通过将网络信标与DPDK+VPP框架结合起来，在高通量网络环境下实现网络信标的高性能植入检测。为了实现上述目的，本发明采用如下技术方案：本发明提供一种高通量网络环境下的信标植入检测方法，包括以下步骤：构建框架：将信标应用在DPDK+VPP网络框架，支持高通量的网络通信环境；在VPP原有节点的基础上加入信标植入节点和信标检测节点，对符合策略的矢量数据包进行信标植入和检测；信标植入：在网络层、传输层和应用层，基于处理框架VPP的信标植入节点进行网络信标植入；支持IP、TCP、HTTP和DNS协议网络数据包植入；信标检测：在网络层、传输层和应用层，基于处理框架VPP的信标检测节点进行网络信标检测，当检测到信标数据后进行信标提取并存储。进一步地，该方法还包括以下步骤：信标数据压缩：在单包溯源场景中，当单个信标数据长度大于阈值时，使用哈希算法进行信标数据压缩处理。进一步地，在所述DPDK+VPP网络框架中：DPDK运行在用户空间，通过大页内存、轮询方法进行矢量数据包处理，绕过Linux内核协议栈的处理；在DPDK的基础上加入矢量数据包处理框架VPP作为虚拟路由或交换机，矢量数据包向量依次通过VPP数据包处理节点，在各节点实现矢量数据包的批量处理。进一步地，在所述信标植入步骤中，还包括：在信标植入之前，引入信标数据包过滤机制，根据配置的信标策略对矢量数据包进行过滤筛选，对符合信标策略的矢量数据包进行信标植入。进一步地，在所述信标植入步骤中，IP协议网络数据包植入具体包括：IP协议信标通过修改矢量数据包报文头部的id字段和tos字段植入信标，id字段用于植入8 bit信标数据，tos字段用于植入16 bit信标数据，植入完成后更新IP头部的校验值，完成IP信标的植入。进一步地，在所述信标植入步骤中，TCP协议网络数据包植入具体包括：TCP协议信标选择在TCP报文首部的Options字段进行信标植入，单个矢量数据包选取20 bytes进行信标数据标记，植入完成后更新IP和TCP头部的校验值，并更新矢量数据包长度字段，完成TCP信标的植入。进一步地，在所述信标植入步骤中，HTTP协议网络数据包植入具体包括：HTTP协议信标在HTTP协议请求包的User-Agent字段植入信标，对信标数据进行bash64可见字符编码，将编码后的可见字符串信标植入到数据包User-Agent字段中，植入完成后更新IP和TCP头部的校验值，并更新矢量数据包长度字段，完成HTTP信标的植入。进一步地，在所述信标植入步骤中，DNS协议网络数据包植入具体包括：DNS协议信标通过DNS数据包中的Queries字段进行信标植入，单个矢量数据包选取18 bytes进行信标数据标记，植入完成后更新IP和UDP头部的校验值，并更新矢量数据包长度字段，完成DNS信标的植入。进一步地，所述信标数据压缩步骤具体包括：在单包溯源场景中，当单个信标数据长度大于单个数据包所能植入的最大长度时，调用哈希函数对信标数据进行压缩；将哈希压缩后的信标数据植入到矢量数据包中，并将哈希前的信标数据作为哈希表中的value值存入，将哈希之后的信标数据作为对应的key值存入哈希表。进一步地，在所述信标检测步骤中：信标检测节点根据提取的信标数据，作为key值在所述哈希表查找对应的value值，获取原始的信标数据。经由上述的技术方案可知，与现有技术相比，本发明公开提供了一种高通量网络环境下的信标植入检测方法，弥补了当前已有网络信标方案的多个缺陷，具体包括：1.传统的网络信标技术时间开销较大，影响网络传输性能，不能用于高吞吐率的网络环境中。本发明将网络信标与DPDK+VPP结合起来，在高吞吐率的网络环境中，实现矢量数据包的批量处理，降低了网络信标产生的时间开销，在高吞吐率的网络环境中也具有很好的性能。2.在流量溯源场景中，单个数据包承载的信标数据有限，信标单包溯源效率较低。针对这个问题，本发明将较长的信标数据进行哈希压缩后植入到数据包中，并将哈希前后的结果存入哈希表用于溯源追踪，从而提升单包溯源的效率和实用性。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图获得其他的附图。图1为本发明提供的高通量网络环境下的信标植入检测方法流程图；图2为本发明提供的网络信标整体框架图；图3为本发明提供的高通量信标植入流程图；图4为本发明提供的高通量信标检测流程图；图5为本发明提供的单包溯源场景下信标数据压缩流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。首先对本发明所用到的技术术语进行如下解释：1）. DPDK：数据平面开发套件是由6WIND,Intel等多家公司开发，主要基于Linux系统运行，用于快速数据包处理的函数库与驱动集合，可以极大提高数据处理性能和吞吐量，提高数据平面应用程序的工作效率。2）. VPP：VPP平台是一个可扩展的框架，可提供开箱即用的生产质量交换机 / 路由器功能。它是思科矢量数据包处理技术的开源版本：一种高性能的数据包处理堆栈，可以在商用 CPU 上运行。如图1所示，本发明实施例公开了一种高通量网络环境下的信标植入检测方法，包括以下步骤：构建框架：将信标应用在DPDK+VPP网络框架，支持高通量的网络通信环境；在VPP原有节点的基础上加入信标植入节点和信标检测节点，对符合策略的矢量数据包进行信标植入和检测；信标植入：在网络层、传输层和应用层，基于处理框架VPP的信标植入节点进行网络信标植入；支持IP、TCP、HTTP和DNS协议网络数据包植入；信标检测：在网络层、传输层和应用层，基于处理框架VPP的信标检测节点进行网络信标检测，当检测到信标数据后进行信标提取并存储。本实施例中，将网络信标与DPDK+VPP结合起来，在高吞吐率的网络环境中，实现矢量数据包的批量处理，降低了网络信标产生的时间开销，在高吞吐率的网络环境中也具有很好的性能。为了提高单包溯源的实用性，针对单个数据包承载的信标数据有限的问题，该方法进一步地，还包括：信标数据压缩：在单包溯源场景中，当单个信标数据长度大于阈值时，使用哈希算法进行信标数据压缩处理。基于此，在单包溯源场景中，为了提高信标承载容量，将信标数据进行哈希压缩，并通过哈希表存储压缩前后的信标数据，提高信标溯源的效率。下面分别针对上述4个步骤进行详细说明：1.结合DPDK和VPP的网络信标框架为了提高信标植入检测性能，将信标应用在DPDK+VPP网络框架，支持高通量的网络通信环境。DPDK运行在用户空间，通过大页内存、轮询方法进行数据包的高效处理，绕过Linux内核协议栈的处理过程，在一定程度上解决性能问题。为了进一步提升转发性能，在DPDK的基础上加入矢量数据包处理框架VPP作为虚拟路由或交换机，数据包向量依次通过VPP数据包处理节点，在各节点可以实现数据包的批量处理。结合DPDK和VPP的网络信标框架如图2所示，多个矢量数据包输入DPDK的dpdk-input节点，进而由dpdk-input节点输入VPP的Ethernet-input节点；而VPP包括：Ethernet-input节点；Ethernet-input节点下设5个节点，分别是：MPLS-Ethernet-input、Ip6-input、Ip4-input、Arp-input、llc-input节点；且在Ip6-input节点下设Ip6-lookup节点，并在Ip4-input节点下设信标植入节点和信标检测节点。通过在VPP原有节点的基础上加入信标植入节点和信标检测节点，对符合策略的数据包向量进行信标植入/检测，绕过内核层面，实现批量的数据包信标处理，提高网络信标的整体性能，将网络信标应用于高通量的网络环境中。2.高通量信标植入信标植入包含网络层、传输层和应用层的网络信标植入，共支持四种协议的网络数据包植入，分别为IP、TCP、HTTP和DNS协议。在信标植入之前，引入信标数据包过滤机制，根据配置的信标策略首先对数据包进行过滤筛选，其中信标策略主要包含筛选数据包的五元组信息以及信标的植入概率，以一定的概率将符合信标筛选条件的数据包向量发送至VPP中的信标植入节点进行并发处理，单指令批量处理多个数据包，实现高通量环境下信标的高效植入。其中IP协议信标通过修改数据包报文头部的id字段和tos字段植入信标，id字段可以植入8 bit信标数据，tos字段可以植入16 bit信标数据，植入完成后更新IP头部的校验值，完成IP信标的植入。TCP协议信标选择在TCP报文首部的Options字段进行信标植入，Options字段最大长度为40 bytes，可以存储大量的报文控制信息，单个数据包选取20 bytes进行信标数据标记，植入完成后更新IP和TCP头部的校验值，并更新数据包长度字段，完成TCP信标的植入。HTTP协议信标在HTTP协议请求包的User-Agent字段植入信标，单个数据包可植入20 bytes的信标信息，User-Agent字段存储的是明文字符串数据，所以植入信标必须是可见字符形式，为此，首先要对信标数据进行bash64可见字符编码，将编码后的可见字符串信标植入到数据包User-Agent字段中，植入完成后更新IP和TCP头部的校验值，并更新数据包长度字段，完成HTTP信标的植入。DNS协议信标通过DNS数据包中的Queries字段进行信标植入，单个数据包选取18bytes进行信标数据标记，植入完成后更新IP和UDP头部的校验值，并更新数据包长度字段，完成DNS信标的植入。以上四种协议信标在VPP信标植入处理节点中实现，结合DPDK的零拷贝数据包收发和VPP的矢量数据包处理指令，实现矢量数据包的信标植入。高通量信标植入流程如图3所示，结合信标策略，对符合过滤机制的数据包进行单指令批量信标植入，并发更新数据包校验位，实现高通量网络的高性能信标植入。当不符合信标策略时，则直接转发矢量数据包即可。3.高通量信标检测信标检测与植入对应，同样包含网络层、传输层和应用层的网络信标检测，支持IP、TCP、HTTP和DNS协议。高通量信标检测流程如图4所示，首先对流量进行过滤筛选，根据配置的信标策略，对比数据包五元组信息筛选出目标数据包，将符合筛选策略的目标数据包向量发送至VPP的信标检测节点进行信标检测，批量检测数据包信标数据，实现矢量数据包的信标检测。检测到信标数据后进行信标提取，并实时将提取的信标数据并发存储到日志文档中，实现高通量网络的高性能信标检测。当不符合信标策略时，则直接转发矢量数据包即可。4. 单包溯源场景下信标数据压缩在高通量网络环境中进行单包路径溯源时，在单个数据包中需要植入包含路径信息的信标数据，当数据包路径复杂时，单个信标数据的长度往往会很大，超出了数据包所能植入的最大信标长度。为此，在单包溯源场景中使用哈希算法进行信标数据压缩处理，信标数据压缩流程如图5所示。当信标数据长度大于单个数据包所能植入的最大长度时，调用哈希函数对信标数据进行压缩，将哈希压缩后的信标数据植入到数据包中，同时将哈希前的信标数据作为哈希表中的value值存入，并将哈希之后的信标数据作为对应的key值存入哈希表。而当信标数据长度小于单个数据包所能植入的最大长度时，则直接植入信标即可，无需哈希压缩。针对采用哈希植入的信标，则信标检测节点根据提取的信标数据，作为key值去哈希表查找对应的value值，即可快速准确的获取原始的信标数据，从而解决了单包溯源中信标容量有限的问题，实现了高通量网络环境下的高效率单包溯源。本发明将网络信标与DPDK+VPP结合起来，应用于高吞吐率的网络环境中，实现矢量数据包的批量处理，降低了网络信标产生的时间开销，在高吞吐率的网络环境中也具有较好的性能。此外，为了提高单包溯源的实用性，针对单个数据包承载的信标数据有限的问题，将较长的信标数据进行哈希压缩计算后植入到数据包中，并将哈希前后的结果存入哈希表用于溯源追踪，从而提升单包溯源的效率和实用性。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似部分互相参见即可。对于实施例公开的装置而言，由于其与实施例公开的方法相对应，所以描述的比较简单，相关之处参见方法部分说明即可。对所公开的实施例的上述说明，使本领域专业技术人员能够实现或使用本发明。对这些实施例的多种修改对本领域的专业技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所示的这些实施例，而是要符合与本文所公开的原理和新颖特点相一致的最宽的范围。
