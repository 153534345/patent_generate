标题title
基于边缘联邦学习的水域异常监管方法及系统
摘要abst
本发明公开了一种基于边缘联邦学习的水域异常监管方法及系统，属于图像处理技术领域，方法包括以下步骤：采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；构建水域分割模型，采用训练集及其分割标注训练水域分割模型；采用训练后的水域分割模型对全部数据进行水域抠取；构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。本发明有效提升了水域异常检测模型的性能，保障了用户或居民的隐私。
权利要求书clms
1.一种基于边缘联邦学习的水域异常监管方法，其特征在于，包括以下步骤：采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；构建水域分割模型，采用训练集及其分割标注训练水域分割模型；采用训练后的水域分割模型对全部数据进行水域抠取；构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。2.根据权利要求1所述的基于边缘联邦学习的水域异常监管方法，其特征在于，所述样本分类包括非异常水域、人员入侵水域和脏乱水域3个类别，所述人员入侵水域类别包括戏水、游泳、溺水和船只四种水域包含人员的场景，所述脏乱水域类别包括排污、浮萍、水面垃圾、植物秸秆和枯枝枯叶五种影响水环境的场景。3.根据权利要求1所述的基于边缘联邦学习的水域异常监管方法，其特征在于，所述构建水域分割模型，采用训练集及其分割标注训练水域分割模型，包括：构建水域分割模型；采用包含水域分割标注的训练集通过下式对水域分割模型中可学习的参数/＞进行水域分割训练：其中，，，/＞为水域分割模型/＞对输入图像x的最终预测特征图/＞中第i行j列的预测值，/＞、/＞，/＞表示实数空间，h、w分别表示输入或输出的高和宽，/＞为掩膜标签第i行j列的值，/＞为调整/＞和损失占比的超参数。4.根据权利要求1所述的基于边缘联邦学习的水域异常监管方法，其特征在于，所述采用训练后的水域分割模型对全部数据进行水域抠取，包括：采用训练后的水域分割模型对全部数据进行推理，通过指示函数获得输入图像x的水域掩膜M，即水域像素值为1，非水域像素值为0的单通道二值图像，所述指示函数/＞为：通过式对图像x中的水域像素进行抠取，/＞为抠取后的图像。5.根据权利要求1所述的基于边缘联邦学习的水域异常监管方法，其特征在于，所述构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化，包括：构建水域异常检测模型；采用水域异常检测模型在训练集上的交叉熵损失函数对水域异常检测模型/＞的可学习参数进行迭代更新，直至收敛为止，所述交叉熵损失函数为：其中，pz为水域异常检测模型将样本x预测为类别z的概率，yz为样本x的one-hot标签第z个位置的值，z∈{1, 2, 3}。6.根据权利要求1-5任意一项所述的基于边缘联邦学习的水域异常监管方法，其特征在于，所述将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管，包括：服务端按照预设比例r对所有客户端进行随机采样；被采样的客户端采用各自收集的数据自动对水域异常检测模型/＞进行训练，其中，n为客户端总数；对客户端中水域异常检测模型/＞的参数分别进行拼接及压缩，并将压缩后的模型参数上传至服务端；服务端对客户端上传的模型参数进行重构、聚合，并分发至客户端对水域异常检测模型进行参数更新；重复执行上述步骤，直至达到预设迭代次数e为止。7.根据权利要求6所述的基于边缘联邦学习的水域异常监管方法，其特征在于，所述对客户端中水域异常检测模型/＞的参数分别进行拼接及压缩，并将压缩后的模型参数上传至服务端，包括：客户端Ct将水域异常检测模型的可学习参数拼接为一个近似于矩阵的形状，并采用0值进行填充使其恰好能够形成一个参数矩阵/＞，其中，/＞表示实数空间，t∈{1, 2,3, ..., nr}，/＞；采用奇异值分解算法将拼接后的参数矩阵分解为特征矩阵/＞、特征矩阵和奇异值矩阵/＞的乘积，即/＞；根据动态的能量阈值选取奇异值矩阵/＞中的前k个奇异值，其中，c为当前迭代轮次，/＞、/＞分别为自定义的能量最大值、最小值，，/＞即第s个奇异值，s∈{0, 1, 2, ...,h}，能量阈值E与迭代轮次成正比；特征矩阵的前k个特征向量/＞、特征矩阵/＞的前k个特征向量/＞和奇异值矩阵/＞中的前k个奇异值构成压缩后的参数矩阵/＞，当＜hw时，客户端传递压缩后的参数矩阵/＞，当＞hw时，客户端传递原始参数矩阵/＞。8.根据权利要求7所述的基于边缘联邦学习的水域异常监管方法，其特征在于，所述服务端对客户端上传的模型参数进行重构、聚合，并分发至客户端对水域异常检测模型进行参数更新，包括：根据指示函数将客户端水域异常检测模型的参数矩阵/＞重构为/＞，其中，/＞为根据/＞重构的奇异值矩阵，/＞；对重构的模型参数进行均值聚合：将均值聚合后的模型参数下发至所有客户端对客户端水域异常检测模型/＞进行参数更新。9.一种基于边缘联邦学习的水域异常监管系统，其特征在于，包括：数据采集模块，用于采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；水域分割模型构建模块，用于构建水域分割模型，采用训练集及其分割标注训练水域分割模型；水域抠取模块，用于采用训练后的水域分割模型对全部数据进行水域抠取；水域异常检测模型构建模块，用于构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；水域异常监管模块，用于将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。10.一种计算机设备，其特征在于，包括处理器、存储器和总线，所述存储器存储有所述处理器可执行的机器可读指令，当所述计算机设备运行时，所述处理器与所述存储器之间通过总线通信，所述处理器执行所述机器可读指令，以执行如权利要求1-8任一所述的基于边缘联邦学习的水域异常监管方法的步骤。
说明书desc
技术领域本发明涉及一种基于边缘联邦学习的水域异常监管方法及系统，属于图像处理技术领域。背景技术水资源是生命的基础，对人类的饮水、农业、工业和生态系统的健康都至关重要。随着工业化和城市化的迅速发展，水污染成为一个严重的问题。生活垃圾、有害化学物质和废水都可能污染水域，对水质造成威胁，危害人类健康和生态系统的稳定性。因此，有效的水资源管理和监管变得至关重要。智慧水利建设作为推进水利现代化的着力点和突破口，以实现水利业务流程优化，水利工作模式创新，水利治理能力现代化为目标，开始成为各地水利项目的必选项。智慧水利利用先进的自动化技术和系统来监测、检测和应对水域中出现的异常情况，不仅能够实现实时监测，还能够有效降低人工巡查成本，更好地管理水资源。基于深度学习的水域异常检测模型能够实时检测水域中的异常现象或行为，例如水面漂浮物、排污、游泳、溺水等，对检测到的异常现象或行为在水域管控平台界面上实施告警，使得管理部门或人员能够及时对危险或影响水环境的行为进行干预。但非水域区域往往会对模型的决策造成一定程度的干扰，导致水域异常检测模型性能不加。其次，模型的优化大多是直接采集监控的误漏报数据，进而对模型进行集中式训练、升级，然而视频监控采集的图像通常涉及用户或居民的隐私，上述模型的优化方式通常会使用户或居民隐私得不到保障。因此，如何在不侵犯用户或居民隐私的条件下，有效提升水域异常检测模型的性能是一个亟待解决的问题。发明内容为了解决上述问题，本发明提出了一种基于边缘联邦学习的水域异常监管方法及系统，能够有效提升水域异常检测模型的性能，保障用户或居民的隐私。本发明解决其技术问题采取的技术方案是：第一方面，本发明实施例提供的一种基于边缘联邦学习的水域异常监管方法，包括以下步骤：采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；构建水域分割模型，采用训练集及其分割标注训练水域分割模型；采用训练后的水域分割模型对全部数据进行水域抠取；构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。作为本实施例一种可能的实现方式，所述样本分类包括非异常水域、人员入侵水域和脏乱水域3个类别，所述人员入侵水域类别包括戏水、游泳、溺水和船只四种水域包含人员的场景，所述脏乱水域类别包括排污、浮萍、水面垃圾、植物秸秆和枯枝枯叶五种影响水环境的场景。作为本实施例一种可能的实现方式，所述构建水域分割模型，采用训练集及其分割标注训练水域分割模型，包括：构建水域分割模型；采用包含水域分割标注的训练集通过下式对水域分割模型中可学习的参数/＞进行水域分割训练：其中，，，/＞为水域分割模型/＞对输入图像x的最终预测特征图/＞中第i行j列的预测值，/＞、/＞，/＞表示实数空间，h、w分别表示输入或输出的高和宽，/＞为掩膜标签第i行j列的值，/＞为调整/＞和损失占比的超参数。作为本实施例一种可能的实现方式，所述采用训练后的水域分割模型对全部数据进行水域抠取，包括：采用训练后的水域分割模型对全部数据进行推理，通过指示函数获得输入图像x的水域掩膜M，即水域像素值为1，非水域像素值为0的单通道二值图像，所述指示函数为：通过式对图像x中的水域像素进行抠取，/＞为抠取后的图像。作为本实施例一种可能的实现方式，所述构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化，包括：构建水域异常检测模型；采用水域异常检测模型在训练集上的交叉熵损失函数对/＞的可学习参数进行迭代更新，直至收敛为止，所述交叉熵损失函数为：其中，pz为水域异常检测模型将样本x预测为类别z的概率，yz为样本x的one-hot标签第z个位置的值，z∈{1, 2, 3}。作为本实施例一种可能的实现方式，所述将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管，包括：服务端按照预设比例r对所有客户端进行随机采样；被采样的客户端采用各自收集的数据自动对水域异常检测模型/＞进行训练，其中，n为客户端总数；对客户端中水域异常检测模型/＞的参数分别进行拼接及压缩，并将压缩后的模型参数上传至服务端；服务端对客户端上传的模型参数进行重构、聚合，并分发至客户端对水域异常检测模型进行参数更新；重复执行上述步骤，直至达到预设迭代次数e为止。作为本实施例一种可能的实现方式，所述对客户端中水域异常检测模型/＞的参数分别进行拼接及压缩，并将压缩后的模型参数上传至服务端，包括：客户端Ct将水域异常检测模型的可学习参数拼接为一个近似于矩阵的形状，并采用0值进行填充使其恰好能够形成一个参数矩阵/＞，其中，/＞表示实数空间，t∈{1, 2, 3, ...,nr}，/＞；采用奇异值分解算法将拼接后的参数矩阵分解为特征矩阵/＞、特征矩阵/＞和奇异值矩阵/＞的乘积，即/＞；根据动态的能量阈值选取奇异值矩阵/＞中的前k个奇异值，其中，c为当前迭代轮次，/＞、/＞分别为自定义的能量最大值、最小值，，/＞即第s个奇异值，s∈{0, 1, 2, ...,h}，能量阈值E与迭代轮次成正比；特征矩阵的前k个特征向量/＞、特征矩阵/＞的前k个特征向量和奇异值矩阵/＞中的前k个奇异值构成压缩后的参数矩阵/＞，当＜hw时，客户端传递压缩后的参数矩阵/＞，当＞hw时，客户端传递原始参数矩阵/＞。作为本实施例一种可能的实现方式，所述服务端对客户端上传的模型参数进行重构、聚合，并分发至客户端对水域异常检测模型进行参数更新，包括：根据指示函数将客户端水域异常检测模型/＞的参数矩阵/＞重构为/＞，其中，/＞为根据/＞重构的奇异值矩阵，/＞；对重构的模型参数进行均值聚合：将均值聚合后的模型参数下发至所有客户端对客户端水域异常检测模型/＞进行参数更新。第二方面，本发明实施例提供的一种基于边缘联邦学习的水域异常监管系统，包括：数据采集模块，用于采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；水域分割模型构建模块，用于构建水域分割模型，采用训练集及其分割标注训练水域分割模型；水域抠取模块，用于采用训练后的水域分割模型对全部数据进行水域抠取；水域异常检测模型构建模块，用于构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；水域异常监管模块，用于将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。第三方面，本发明实施例提供的一种计算机设备，包括处理器、存储器和总线，所述存储器存储有所述处理器可执行的机器可读指令，当所述计算机设备运行时，所述处理器与所述存储器之间通过总线通信，所述处理器执行所述机器可读指令，以执行如上述任意基于边缘联邦学习的水域异常监管方法的步骤。第四方面，本发明实施例提供的一种存储介质，该存储介质上存储有计算机程序，该计算机程序被处理器运行时执行如上述任意基于边缘联邦学习的水域异常监管方法的步骤。本发明实施例的技术方案可以具有的有益效果如下：本发明实施例的技术方案的一种基于边缘联邦学习的水域异常监管方法，包括以下步骤：采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；构建水域分割模型，采用训练集及其分割标注训练水域分割模型；采用训练后的水域分割模型对全部数据进行水域抠取；构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。本发明有效提升了水域异常检测模型的性能，保障了用户或居民的隐私。本发明基于边缘联邦学习进行水域异常检测，有效保障了用户的隐私，充分利用众多边缘设备收集的异常数据，增加模型训练数据中的水域异常模式，提升了水域异常检测模型的泛化性能。本发明采用水域分割模型对边缘设备采集的图像中的水体像素进行抠取，消除了非水域区域对水域异常检测模型产生的负面影响，显著提升了水域异常检测模型对水域异常检测的能力。本发明对传输的水域异常检测模型参数实施动态压缩，能够在不影响模型收敛的条件下减少通信参数量，降低带宽占用，提升联邦学习的通信效率。本发明实施例的技术方案的一种基于边缘联邦学习的水域异常监管系统，利用水域分割模型将收集的图像中的水域进行分割、抠取；利用水域异常检测模型对抠取的水域图像进行异常检测，若存在异常则将结果返回至水域管控平台界面实施告警；并定期对水域异常检测模型进行联邦训练以优化检测性能，能够根据服务端指令自动采用本地数据对异常检测模型进行训练，训练后对模型参数进行拼接、压缩，并上传至服务端，亦能够接收服务端下发的参数自动对异常检测模型参数进行更新；通过定期自动进行联邦训练以不断提升模型水域异常检测能力。附图说明图1是根据一示例性实施例示出的一种基于边缘联邦学习的水域异常监管方法的流程图；图2是根据一示例性实施例示出的一种基于边缘联邦学习的水域异常监管系统的示意图；图3是根据一示例性实施例示出的一种利用水域异常监管系统进行水域异常监管的具体流程图；图4是根据一示例性实施例示出的另一种水域抠取的示意图；图5是根据一示例性实施例示出的另一种联邦训练的示意图。具体实施方式下面结合附图与实施例对本发明做进一步说明：为能清楚说明本方案的技术特点，下面通过具体实施方式，并结合其附图，对本发明进行详细阐述。下文的公开提供了许多不同的实施例或例子用来实现本发明的不同结构。为了简化本发明的公开，下文中对特定例子的部件和设置进行描述。此外，本发明可以在不同例子中重复参考数字和/或字母。这种重复是为了简化和清楚的目的，其本身不指示所讨论各种实施例和/或设置之间的关系。应当注意，在附图中所图示的部件不一定按比例绘制。本发明省略了对公知组件和处理技术及工艺的描述以避免不必要地限制本发明。如图1所示，本发明实施例提供了一种基于边缘联邦学习的水域异常监管方法，包括以下步骤：采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；构建水域分割模型，采用训练集及其分割标注训练水域分割模型；采用训练后的水域分割模型对全部数据进行水域抠取；构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。作为本实施例一种可能的实现方式，所述样本分类包括非异常水域、人员入侵水域和脏乱水域3个类别，所述人员入侵水域类别包括戏水、游泳、溺水和船只四种水域包含人员的场景，所述脏乱水域类别包括排污、浮萍、水面垃圾、植物秸秆和枯枝枯叶五种影响水环境的场景。作为本实施例一种可能的实现方式，所述构建水域分割模型，采用训练集及其分割标注训练水域分割模型，包括：构建水域分割模型；采用包含水域分割标注的训练集通过下式对水域分割模型中可学习的参数/＞进行水域分割训练：其中，，，/＞为水域分割模型/＞对输入图像x的最终预测特征图/＞中第i行j列的预测值，/＞、/＞，/＞表示实数空间，h、w分别表示输入或输出的高和宽，/＞为掩膜标签第i行j列的值，/＞为调整/＞和损失占比的超参数。作为本实施例一种可能的实现方式，所述采用训练后的水域分割模型对全部数据进行水域抠取，包括：采用训练后的水域分割模型对全部数据进行推理，通过指示函数获得输入图像x的水域掩膜M，即水域像素值为1，非水域像素值为0的单通道二值图像，所述指示函数为：通过式对图像x中的水域像素进行抠取，/＞为抠取后的图像。作为本实施例一种可能的实现方式，所述构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化，包括：构建水域异常检测模型；采用水域异常检测模型在训练集上的交叉熵损失函数对/＞的可学习参数进行迭代更新，直至收敛为止，所述交叉熵损失函数为：其中，pz为水域异常检测模型将样本x预测为类别z的概率，yz为样本x的one-hot标签第z个位置的值，z∈{1, 2, 3}。作为本实施例一种可能的实现方式，所述将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管，包括：服务端按照预设比例r对所有客户端进行随机采样；被采样的客户端采用各自收集的数据自动对水域异常检测模型/＞进行训练，其中，n为客户端总数；对客户端中水域异常检测模型/＞的参数分别进行拼接及压缩，并将压缩后的模型参数上传至服务端；服务端对客户端上传的模型参数进行重构、聚合，并分发至客户端对水域异常检测模型进行参数更新；重复执行上述步骤，直至达到预设迭代次数e为止。作为本实施例一种可能的实现方式，所述对客户端中水域异常检测模型/＞的参数分别进行拼接及压缩，并将压缩后的模型参数上传至服务端，包括：客户端Ct将水域异常检测模型的可学习参数拼接为一个近似于矩阵的形状，并采用0值进行填充使其恰好能够形成一个参数矩阵/＞，其中，/＞表示实数空间，t∈{1, 2, 3, ...,nr}，/＞；采用奇异值分解算法将拼接后的参数矩阵分解为特征矩阵/＞、特征矩阵/＞和奇异值矩阵/＞的乘积，即/＞；根据动态的能量阈值选取奇异值矩阵/＞中的前k个奇异值，其中，c为当前迭代轮次，/＞、/＞分别为自定义的能量最大值、最小值，，/＞即第s个奇异值，s∈{0, 1, 2, ...,h}，能量阈值E与迭代轮次成正比；特征矩阵的前k个特征向量/＞、特征矩阵/＞的前k个特征向量和奇异值矩阵/＞中的前k个奇异值构成压缩后的参数矩阵/＞，当＜hw时，客户端传递压缩后的参数矩阵/＞，当＞hw时，客户端传递原始参数矩阵/＞。作为本实施例一种可能的实现方式，所述服务端对客户端上传的模型参数进行重构、聚合，并分发至客户端对水域异常检测模型进行参数更新，包括：根据指示函数将客户端水域异常检测模型/＞的参数矩阵/＞重构为/＞，其中，/＞为根据/＞重构的奇异值矩阵，/＞；对重构的模型参数进行均值聚合：将均值聚合后的模型参数下发至所有客户端对客户端水域异常检测模型/＞进行参数更新。本发明采集包含水域的图像数据，对其进行分割标注及样本分类，并划分训练集和测试集；构建水域分割模型并采用训练集及其分割标注训练水域分割模型；采用训练完备的水域分割模型对全部数据进行水域抠取；构建水域异常检测模型，并采用水域抠取后的训练集对其进行微调；将训练完备的水域分割及异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，定期自动进行联邦训练以不断提升模型水域异常检测能力。本发明有效提升了水域异常检测模型的性能，保障了用户或居民的隐私。如图2所示，本发明实施例提供的一种基于边缘联邦学习的水域异常监管系统，包括：数据采集模块，用于采集待监管水域的图像数据，进行分割标注及样本分类，划分训练集和测试集；水域分割模型构建模块，用于构建水域分割模型，采用训练集及其分割标注训练水域分割模型；水域抠取模块，用于采用训练后的水域分割模型对全部数据进行水域抠取；水域异常检测模型构建模块，用于构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行优化；水域异常监管模块，用于将训练后的水域分割和优化后的水域异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，进行定期联邦训练，从而实现水域异常监管。如图3所示，利用水域异常监管系统进行水域异常监管的具体流程如下。采集包含水域的图像数据，对其进行分割标注及样本分类，并划分训练集和测试集。样本分类包括非异常水域、人员入侵水域、脏乱水域3个类别，其中人员入侵水域类别包括戏水、游泳、溺水、船只等水域包含人员的场景，脏乱水域类别包括排污、浮萍、水面垃圾、植物秸秆、枯枝枯叶等影响水环境的场景。构建水域分割模型并采用训练集及其分割标注训练水域分割模型。构建语义分割模型DeepLabv3+作为水域分割模型，其包括非对称的编码器和解码器两部分，编码器由骨干网络B和采用深度可分离卷积的空洞空间金字塔池化ASPP构成，解码器则包括由双线性插值实现的4倍上采样U和卷积模块CBR、CBRC构成，CBR依次由卷积层、批量归一化层和ReLU激活层构成，CBRC依次由第一卷积层、批量归一化层、ReLU激活层和第二卷积层构成；B包括四个模块，每个模块均实现两倍下采样，其中B可采用ResNet、Xception等卷积神经网络；B中第2个模块的输出B2作为解码器的输入之一，第4个模块的输出B4作为ASPP的输入，解码器输出/＞可由式得到，其中/＞表示特征图合并，S表示Sigmoid激活函数，/＞即为分割模型对输入图像x的最终预测结果，、/＞，/＞表示实数空间，h、w分别表示输入或输出的高和宽。加载其在CityScapes数据集上的预训练权重对进行参数初始化。采用包含水域分割标注的训练集通过下式对DeepLabv3+可学习的参数进行水域分割训练：其中，，，/＞为最终输出特征图/＞第i行j列的预测值，/＞为掩膜标签第i行j列的值，/＞为调整/＞和/＞损失占比的超参数。采用训练完备的水域分割模型对全部数据进行水域抠取。采用训练完备的对全部数据进行推理，通过指示函数/＞获得输入图像x的水域掩膜M，即水域像素值为1，非水域像素值为0的单通道二值图像，指示函数/＞定义如下：通过式对图像x中的水域像素进行抠取，如图4所示。构建水域异常检测模型，并加载预训练权重，采用水域抠取后的训练集对其进行微调。构建视觉Transformer作为水域异常检测模型，其由12个相同的Transformer编码器及一个分类器堆叠而成，每个编码器依次由层归一化、多头自注意力机制、层归一化和多层感知机MLP构成；其中，编码器的输入I与多头注意力机制的输出Oh之间存在残差连接，即多头注意力机制的最终输出Yh=I+Oh，第二个层归一化的输入Yh与MLP的输出Om存在残差连接，即编码器的最终输出Y=Yh+Om；分类器则依次由层归一化、全连接层、GELU激活层、Dropout层、全连接层和Softmax激活层构成；加载其在ImageNet-21K图像数据集上的预训练权重对的参数进行初始化；采用模型在训练集上的交叉熵损失函数对的参数进行迭代更新，直至收敛，其中，pz为水域异常检测模型/＞将样本x预测为类别z的概率，yz为样本x的one-hot标签第z个位置的值，z∈{1, 2, 3}。将训练完备的水域分割及异常检测模型分发至所有客户端，客户端不定期收集异常检测模型的误漏报数据，定期进行联邦训练，如图5所示。服务端按照预设比例r对所有客户端进行随机采样；被采样的客户端采用各自收集的数据自动对水域异常检测模型/＞进行训练，其中，n为客户端总数；对客户端中/＞的参数分别进行拼接及压缩，并将压缩后的模型参数上传至服务端，以减少参数传递的时延及占用的网络带宽；服务端对客户端上传的模型参数进行重构、聚合，并分发至客户端对进行参数更新；重复步骤至步骤直至达到预设迭代次数e。在本发明的实施例中，步骤包括如下步骤：以客户端Ct为例，t∈{1, 2, 3, ...,nr}，将其水域异常检测模型的可学习参数拼接为一个近似于矩阵的形状，并采用0值进行填充使其恰好能够形成一个参数矩阵/＞，其中，/＞表示实数空间，/＞；采用奇异值分解将拼接后的参数矩阵分解为两个特征矩阵/＞、/＞和一个奇异值矩阵/＞的乘积，即/＞；根据动态的能量阈值选取/＞中的前k个奇异值，其中，c为当前迭代轮次，/＞、/＞分别为自定义的能量最大值、最小值，，/＞即第s个奇异值，s∈{0, 1, 2, ...,h}，能量阈值E与迭代轮次成正比，即随着迭代轮次的增加，参数压缩重构的还原度越高，避免给模型收敛造成较大负面影响；的前k个特征向量/＞、/＞的前k个特征向量/＞和/＞中的前k个奇异值/＞构成压缩后的参数矩阵/＞，当＜hw时，客户端传递压缩后的参数矩阵/＞，当＞hw时，客户端传递原始参数矩阵/＞。在本发明的实施例中，步骤包括如下步骤：根据指示函数将客户端水域异常检测模型/＞的参数矩阵/＞重构为/＞，其中，/＞为根据/＞重构的奇异值矩阵，/＞；采用下式对重构的模型参数进行均值聚合：将下发至所有客户端对客户端水域异常检测模型/＞进行参数更新。本发明实施例提供了一种计算机设备，包括处理器、存储器和总线，所述存储器存储有所述处理器可执行的机器可读指令，当所述装置运行时，所述处理器与所述存储器之间通过总线通信，所述处理器执行所述机器可读指令，以执行如上述任意基于边缘联邦学习的水域异常监管方法的步骤。具体地，上述存储器和处理器能够为通用的存储器和处理器，这里不做具体限定，当处理器运行存储器存储的计算机程序时，能够执行上述基于边缘联邦学习的水域异常监管方法。本领域技术人员可以理解，所述计算机设备的结构并不构成对计算机设备的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者拆分某些部件，或者不同的部件布置。在一些实施例中，该计算机设备还可以包括触摸屏可用于显示图形用户界面和接收用户针对图形用户界面的操作。具体的触摸屏可包括显示面板和触控面板。其中显示面板可以采用LCD、OLED等形式来配置。触控面板可收集用户在其上或附近的接触或者非接触操作，并生成预先设定的操作指令，例如，用户使用手指、触笔等任何适合的物体或附件在触控面板上或在触控面板附近的操作。另外，触控面板可包括触摸检测装置和触摸控制器两个部分。其中，触摸检测装置检测用户的触摸方位、姿势，并检测触摸操作带来的信号，将信号传送给触摸控制器；触摸控制器从触摸检测装置上接收触摸信息，并将它转换成处理器能够处理的信息，再送给处理器，并能接收处理器发来的命令并加以执行。此外，可以采用电阻式、电容式、红外线以及表面声波等多种类型实现触控面板，也可以采用未来发展的任何技术实现触控面板。进一步的，触控面板可覆盖显示面板，用户可以根据显示面板显示的图形用户界面，在显示面板上覆盖的触控面板上或者附近进行操作，触控面板检测到在其上或附近的操作后，传送给处理器以确定用户输入，随后处理器响应于用户输入在显示面板上提供相应的视觉输出。另外，触控面板与显示面板可以作为两个独立的部件来实现也可以集成而来实现。对应于上述应用程序的启动方法，本发明实施例还提供了一种存储介质，该存储介质上存储有计算机程序，该计算机程序被处理器运行时执行如上述任意基于边缘联邦学习的水域异常监管方法的步骤。本申请实施例所提供的应用程序的启动装置可以为设备上的特定硬件或者安装于设备上的软件或固件等。本申请实施例所提供的装置，其实现原理及产生的技术效果和前述方法实施例相同，为简要描述，装置实施例部分未提及之处，可参考前述方法实施例中相应内容。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，前述描述的系统、装置和单元的具体工作过程，均可以参考上述方法实施例中的对应过程，在此不再赘述。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。在本申请所提供的实施例中，应该理解到，所揭露装置和方法，可以通过其它的方式实现。以上所描述的装置实施例仅仅是示意性的，例如，模块的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，又例如，多个模块或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另外，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些通信接口，装置或模块的间接耦合或通信连接，可以是电性，机械或其它的形式。作为分离部件说明的模块可以是或者也可以不是物理上分开的，作为模块显示的部件可以是或者也可以不是物理模块，即可以位于一个地方，或者也可以分布到多个网络模块上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。另外，在本申请提供的实施例中的各功能模块可以集成在一个处理模块中，也可以是各个模块单独物理存在，也可以两个或两个以上模块集成在一个模块中。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。最后应当说明的是：以上实施例仅用以说明本发明的技术方案而非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等同替换，其均应涵盖在本发明的权利要求保护范围之内。
