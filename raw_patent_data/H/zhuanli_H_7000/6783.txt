标题title
矿用移动设备组网的通信方法及相关装置
摘要abst
本申请涉及一种矿用移动设备组网的通信方法及相关装置，该通信方法包括以下步骤：初始化各通信渠道的接口；基于各通信渠道的接口接收数据采集信息；基于预设规则统一封装数据采集信息；基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息。本申请解决了传感系统数据连接不灵活的问题，实现采煤机对传感器组件快速连接使用的功能。
权利要求书clms
1.一种矿用移动设备组网的通信方法，其特征在于，包括以下步骤：初始化各通信渠道的接口，其中，通信渠道具有多种类型且预先设定；基于各通信渠道的接口接收数据采集信息；基于预设规则统一封装数据采集信息；基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息。2.根据权利要求1所述的通信方法，其特征在于，所述的初始化各通信渠道的接口的步骤，包括：对各通信渠道上电；读取预配置参数信息，并基于预配置参数配置相应渠道的接口；等待数据接收。3.根据权利要求1所述的通信方法，其特征在于，所述的基于预设规则统一封装数据采集信息的步骤，包括：设定一个抽象基类，用于表示所有数据类型的共同特征；定义公共方法于抽象基类中；基于该抽象基类来创建总线数据和以太网数据的子类，并在所述子类中相应进行属性和方法的定义。4.根据权利要求1所述的通信方法，其特征在于，所述的基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息的步骤，包括：基于无线连接状态判定组网的路由信息更新；基于协议栈库自动建立路由，选择相应路由进行数据传输。5.根据权利要求1或4所述的通信方法，其特征在于，所述的基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息的步骤，包括：基于数据采集信息轮询通信渠道，以获得通信渠道的负荷情况；基于通信渠道的负荷情况选择相应的通信渠道转发封装好的数据采集信息。6.根据权利要求1所述的通信方法，其特征在于，所述各通信渠道包括以太网路由渠道和总线渠道；所述以太网路由渠道包括有线路由渠道和无线路由渠道。7.根据权利要求6所述的通信方法，其特征在于，所述总线渠道用于接收总线式传感器信号，所述以太网路由渠道用于接收网络业务信号。8.根据权利要求1所述的通信方法，其特征在于，还包括以下步骤：设定参数化配置接口；设定数据转发规则设定接口。9.一种电子设备，其特征在于，其包括：一个或多个处理器；存储器；一个或多个应用程序，其中所述一个或多个应用程序被存储在所述存储器中并被配置为由所述一个或多个处理器执行，所述一个或多个程序配置用于：执行根据权利要求1至8任一项所述的矿用移动设备组网的通信方法。10.一种计算机可读存储介质，其特征在于，所述存储介质存储有至少一条指令、至少一段程序、代码集或指令集，所述至少一条指令、所述至少一段程序、所述代码集或指令集由所述处理器加载并执行以实现：如权利要求1至8任一项所述的矿用移动设备组网的通信方法。
说明书desc
技术领域本申请涉及通信技术的领域，尤其是涉及一种矿用移动设备组网的通信方法及相关装置。背景技术当前，采煤机装备的智能化建设越来越重要，其中智能化的一个体现是设备对环境的感知能力，从而，越来越多的传感器构建了越来越强大的感知系统，随着系统的感知负载越来越多，数据的传输成为一个很大的问题。采煤机被测点分散，安装需要布置大量的线缆，造成传感系统线缆故障高发，检修困难。当前的设备厂商设计的传感系统多是总线结构，且较为固定，当需要增加新的传感设备且总线不一致时，还需要增加转换设备，导致其适应能力低，面对工作面日益变化的需求，不够灵活。发明内容为了解决传感系统数据连接不灵活的问题，实现采煤机对传感器组件快速连接使用的目的，本申请提供一种矿用移动设备组网的通信方法及相关装置。第一方面，本申请提供的一种矿用移动设备组网的通信方法，采用如下的技术方案：一种矿用移动设备组网的通信方法，包括以下步骤：初始化各通信渠道的接口，其中，通信渠道具有多种类型且预先设定；基于各通信渠道的接口接收数据采集信息；基于预设规则统一封装数据采集信息；基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息。通过采用上述技术方案，事先对硬件进行配置，得到多种类型的通信渠道。除了总线数据渠道外，还包括以太网数据渠道或其它渠道。总线数据渠道可以与采煤机现有的分布式系统的采集单元相对应，能够实现模拟量及现场总线的接入。以太网数据渠道，用于与采煤机的传感器网络接入需求对应，主要分为视频类的以太网数据，温度、角度等现场总线数据，电流等模拟量的数据。在以太网的数据支持方面，主要考虑大带宽数据的无线转发需求。针对综采工作面的应用场景，能够满足煤机与综采设备的信息交互需要。总线数据和以太网数据是两种不同的数据传输技术，它们在传输方式和常用应用场景方面有所不同。主要区别在于传输方式和常用应用场景，总线数据使用单条电线，适用于在系统内部传输数据，而以太网数据使用多条电线，适用于在计算机之间传输数据。因此需要对其进行统一封装，从而使得数据能够被通用地读取、识别和传输。最后再基于数据类型选择相应的通信渠道转发封装好的数据采集信息。综上，该节点性能相比单个现场总线的装置要更为灵活，其以太网支持有线和无线网络，其无线网络可以实现多个节点设备的自动组网，无需额外配置，解决传感系统数据连接不灵活、分享操作繁琐的问题，大大提供装备的数据传输性能。可选的，所述的初始化各通信渠道的接口的步骤，包括：对各通信渠道上电；读取预配置参数信息，并基于预配置参数配置相应渠道的接口；等待数据接收。通过采用上述技术方案，对不同接口进行初始化设置，现场总线端口针对性地配置参数，在上电后进行初始化配置，进而转入中断等待，当有数据被接收后，将数据进行统一规则封装，方便后期转发接收。可选的，所述的基于预设规则统一封装数据采集信息的步骤，包括：设定一个抽象基类，用于表示所有数据类型的共同特征；定义公共方法于抽象基类中；基于该抽象基类来创建总线数据和以太网数据的子类，并在所述子类中相应进行属性和方法的定义。通过采用上述技术方案，该方法采用使用对象封装数据的方法，其通过创建两个类分别表示总线数据和以太网数据，并使用类的属性来表示数据中的各个字段。然后，可以使用类的实例来表示具体的数据，抽象基类来表示所有数据类型的共同特征。这样，就可以在这个基类中定义公共的方法，例如序列化和反序列化方法。可选的，所述的基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息的步骤，包括：基于无线连接状态判定组网的路由信息更新；基于协议栈库自动建立路由，选择相应路由进行数据传输。通过采用上述技术方案，在所有路由器上安装协议栈库，协议栈库是一种软件工具，用于实现网络协议的编程。然后，在协议栈库中实现路由信息更新的功能，可以使用协议栈库提供的接口来获取路由信息，并根据连接状态来决定是否更新路由信息。之后，在路由器上实现路由的自动建立功能，使用协议栈库提供的接口来获取路由信息，并根据连接状态来决定是否建立路由。最后，使用协议栈库提供的接口来实现数据的发送和接收，并使用路由信息来决定数据包的路径。可选的，所述的基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息的步骤，包括：基于数据采集信息轮询通信渠道，以获得通信渠道的负荷情况；基于通信渠道的负荷情况选择相应的通信渠道转发封装好的数据采集信息。通过采用上述技术方案，在使用总线模式和以太网模式同时接收数据时，可以使用负载均衡技术来提高系统的性能。负载均衡是一种通过分发工作负荷来平衡系统资源的使用情况的技术。可选的，所述各通信渠道包括以太网路由渠道和总线渠道。通过采用上述技术方案，总线数据是一种串行数据传输技术，它使用单条电线来传输数据。总线数据通常用于在系统内部传输数据，例如在计算机的各个部件之间传输数据。总线数据的传输速率较慢，通常在几千至几十万位/秒之间。以太网数据是一种并行数据传输技术，它使用多条电线来传输数据。以太网数据通常用于在计算机之间传输数据，例如在局域网或互联网上传输数据。以太网数据的传输速率较快，通常在几百兆位/秒至几十兆位/秒之间。可选的，所述以太网路由渠道包括有线路由渠道和无线路由渠道。可选的，所述总线渠道用于接收总线式信号，所述以太网路由渠道用于接收网络业务信号。通过采用上述技术方案，总线渠道用于接收总线式传感器信号如温度、角度、行程、介电常数等固定编码信号，以太网路由渠道用于接收UDPTCP等网络业务信号如视频信号、网页访问、WEB服务等信号。可选的，还包括以下步骤：设定参数化配置接口；设定数据转发规则设定接口。通过采用上述技术方案，预留参数化配置接口和数据转发规则设定接口，方便后期运维调试和客户自定义配置。第二方面，本申请提供的一种电子设备，采用如下的技术方案：一种电子设备，其包括：一个或多个处理器；存储器；一个或多个应用程序，其中所述一个或多个应用程序被存储在所述存储器中并被配置为由所述一个或多个处理器执行，所述一个或多个程序配置用于：执行上述的矿用移动设备组网的通信方法。第三方面，本申请提供的一种计算机可读存储介质，采用如下的技术方案：一种计算机可读存储介质，存储有能够被处理器加载并执行如上的上述方法的计算机程序。所述存储介质存储有至少一条指令、至少一段程序、代码集或指令集，所述至少一条指令、所述至少一段程序、所述代码集或指令集由所述处理器加载并执行以实现：如上述的矿用移动设备组网的通信方法。附图说明图1是本申请实施例中一种矿用移动设备组网的通信方法的流程示意图。图2是本申请实施例中一种矿用移动设备组网的通信方法的程序框图。图3是本申请实施例中S1子步骤的流程示意图。图4是本申请实施例中S3子步骤的流程示意图。图5是本申请实施例中S4子步骤的流程示意图。图6是本申请实施例中S422子步骤的流程示意图。具体实施方式以下结合附图，对本申请作进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。图1为某一个实施例中一种矿用移动设备组网的通信方法的流程示意图。应该理解的是，虽然流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行；除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行；并且各流程图中的至少一部分步骤可以包括多个子步骤或者多个阶段，这些子步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些子步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤的子步骤或者阶段的至少一部分轮流或者交替地执行。另外，本实施例中各步骤的标号仅为方便说明，不代表对各步骤执行顺序的限定，在实际应用时，可以根据需要各步骤执行顺序进行调整，或同时进行，这些调整或者替换均属于本发明的保护范围。在以下描述中，为了解释的目的，阐述了很多具体细节，以便提供对发明构思的彻底理解。作为本说明书的一部分，本公开的附图中的一些附图以框图形式表示结构和设备，以避免使所公开的原理复杂难懂。为了清晰起见，实际具体实施的并非所有特征都有必要进行描述。此外，本公开中所使用的语言已主要被选择用于可读性和指导性目的，并且可能没有被选择为划定或限定本发明的主题，从而诉诸所必需的权利要求以确定此类发明主题。在本公开中对“一个具体实施”或“具体实施”的提及意指结合该具体实施所述的特定特征、结构或特性被包括在至少一个具体实施中，并且对“一个具体实施”或“具体实施”的多个提及不应被理解为必然地全部是指同一具体实施。除非明确限定，否则术语“一个”、“一种”和“该”并非旨在指代单数实体，而是包括其特定示例可以被用于举例说明的一般性类别。因此，术语“一个”或“一种”的使用可以意指至少一个的任意数目，包括“一个”、“一个或多个”、“至少一个”和“一个或不止一个”。术语“或”意指可选项中的任意者以及可选项的任何组合，包括所有可选项，除非可选项被明确指示是相互排斥的。短语“中的至少一者”在与项目列表组合时是指列表中的单个项目或列表中项目的任何组合。所述短语并不要求所列项目的全部，除非明确如此限定。本申请实施例公开一种矿用移动设备组网的通信方法。参照图1和图2，该矿用移动设备组网的通信方法包括以下步骤：S1.初始化各通信渠道的接口，其中，通信渠道具有多种类型且预先设定。事先对硬件进行配置，得到多种类型的通信渠道。通信渠道包括以太网路由渠道和总线渠道，以太网路由渠道包括有线路由渠道和无线路由渠道。总线数据是一种串行数据传输技术，它使用单条电线来传输数据。总线数据通常用于在系统内部传输数据，例如在计算机的各个部件之间传输数据。总线数据的传输速率较慢，通常在几千至几十万位/秒之间。总线数据渠道可以与采煤机现有的分布式系统的采集单元相对应，能够实现模拟量及现场总线的接入。以太网数据是一种并行数据传输技术，它使用多条电线来传输数据。以太网数据通常用于在计算机之间传输数据，例如在局域网或互联网上传输数据。以太网数据的传输速率较快，通常在几百兆位/秒至几十兆位/秒之间。以太网数据渠道，用于与采煤机的传感器网络接入需求对应，主要分为视频类的以太网数据，温度、角度等现场总线数据，电流等模拟量的数据。在以太网的数据支持方面，主要考虑大带宽数据的无线转发需求。针对综采工作面的应用场景，能够满足煤机与综采设备的信息交互需要。在配置时，还可以包括以下步骤：设定参数化配置接口和设定数据转发规则设定接口。预留参数化配置接口和数据转发规则设定接口，能够方便后期运维调试和客户自定义配置。具体的，参照图3，S1可以包括以下步骤：S11.对各通信渠道上电。S12.读取预配置参数信息，并基于预配置参数配置相应渠道的接口。S13.等待数据接收。对不同接口进行初始化设置，现场总线端口针对性地配置参数，在上电后进行初始化配置，进而转入中断等待，当有数据被接收后，将数据进行统一规则封装，方便后期转发接收。S2.基于各通信渠道的接口接收数据采集信息。具体的，无线路由通信渠道的建立和使用可以包括以下步骤：首先，需要在所有路由器上安装Link-State QoS协议。Link-State QoS协议是一种用于优化无线网络性能的协议，它可以根据当前的网络情况来自动调整网络的路由。然后，在所有路由器上配置Link-State QoS协议。配置时，需要指定各个路由器的网络信息，包括路由器的IP地址、子网掩码、默认网关等。在所有路由器上启动Link-State QoS协议。启动后，路由器会自动发现周围的其他路由器，并建立网络拓扑图。根据网络拓扑图，路由器会自动计算出最优的路由路径，并将数据包按照最优路径发送出去。在路由器之间传输数据时，Link-State QoS协议会根据数据包的优先级和网络的实时性能情况来决定是否丢弃数据包。这样可以避免网络拥塞，保证网络的稳定性。为了保证网络的安全性，可以在Link-State QoS协议中使用加密技术来保证数据传输的安全性。当网络拓扑图发生变化时，Link-State QoS协议会自动重新计算路由路径，以确保数据包能够按照最优路径发送。Link-State QoS协议还可以支持路由负载均衡，以提高网络的性能。具体的，有线路由通信渠道的建立和使用可以包括以下步骤：在所有路由器上安装MQTT/UDP协议栈构件。MQTT/UDP协议栈构件是一种软件工具，可以实现有线路由功能。在所有路由器上配置MQTT/UDP协议栈构件。配置时，需要指定各个路由器的网络信息，包括路由器的IP地址、子网掩码、默认网关等。然后在所有路由器上启动MQTT/UDP协议栈构件。启动后，路由器会自动发现周围的其他路由器，并建立网络拓扑图。根据网络拓扑图，路由器会自动计算出最优的路由路径，并将数据包按照最优路径发送出去。在路由器之间传输数据时，MQTT/UDP协议栈构件会根据数据包的优先级和网络的实时性能情况来决定是否丢弃数据包。这样可以避免网络拥塞，保证网络的稳定性。为了保证网络的安全性，可以在MQTT/UDP协议栈构件中使用加密技术来保证数据传输的安全性。当网络拓扑图发生变化时，MQTT/UDP协议栈构件会自动重新计算路由路径，以确保数据包能够按照最优路径发送。对于总线渠道而言，总线模式是一种软件设计模式，它用于在多个对象之间传递消息或事件。在总线模式中，一个对象发布一条消息或事件，多个对象可以订阅这条消息或事件，并在收到消息或事件时执行特定的操作。在总线模式中，接收数据的流程如下：a.发布者发布消息或事件，并将消息或事件发送到总线；b.订阅者订阅消息或事件，并在总线上注册一个回调函数；c.当发布者发布消息或事件时，总线会调用所有已注册的回调函数；d.订阅者的回调函数接收到消息或事件后，会执行特定的操作。S3.基于预设规则统一封装数据采集信息。数据封装是指将数据和相关的操作封装在一起，形成一个独立的单元。数据封装可以使得数据和操作组合在一起，方便管理和使用。统一封装可以使得数据结构更加清晰，方便维护和使用。对数据进行统一封装还可以让数据之间的调用变得更加方便，提高程序的可维护性。封装数据接口获得的数据的一种常见方法是使用对象封装数据。这样可以使用对象的属性来表示数据中的每个字段，并使用对象的方法来操作这些数据。作为示例的，参照图4，所述S3包括以下步骤：S31.设定一个抽象基类，用于表示所有数据类型的共同特征。S32.定义公共方法于抽象基类中。S33.基于该抽象基类来创建总线数据和以太网数据的子类，并在所述子类中相应进行属性和方法的定义。该方法采用使用对象封装数据的方法，其通过创建两个类分别表示总线数据和以太网数据，并使用类的属性来表示数据中的各个字段。然后，可以使用类的实例来表示具体的数据，抽象基类来表示所有数据类型的共同特征。这样，就可以在这个基类中定义公共的方法，例如序列化和反序列化方法。另外，可选的，数据封装上，考虑到对传输安全性的考虑，还可以会对信息进行统一标准化处理，增加数据标签、密钥前后缀及令牌标识等，通过统一的协议约定实现不同方式的标准输出。具体的，在封装中添加数据标签、密钥前后缀及令牌标识的步骤具体方法如下：a.在封装的数据结构中添加标签字段。标签字段是用来描述数据的一个字段，常用来区分不同类型的数据；b.在封装的数据结构中添加密钥前后缀字段。密钥前后缀字段是用来保护数据的安全性的，可以在数据传输过程中使用；c.在封装的数据结构中添加令牌标识字段。令牌标识字段是用来标识数据的一个字段，常用来区分不同的数据包。S4.基于数据采集信息的类型选择相应的通信渠道转发封装好的数据采集信息。作为示例的，参照图4，所述S4包括以下步骤：S41.基于无线连接状态判定组网的路由信息更新。S42.基于协议栈库自动建立路由，选择相应路由进行数据传输。在所有路由器上安装协议栈库，协议栈库是一种软件工具，用于实现网络协议的编程。然后，在协议栈库中实现路由信息更新的功能，可以使用协议栈库提供的接口来获取路由信息，并根据连接状态来决定是否更新路由信息。之后，在路由器上实现路由的自动建立功能，使用协议栈库提供的接口来获取路由信息，并根据连接状态来决定是否建立路由。最后，使用协议栈库提供的接口来实现数据的发送和接收，并使用路由信息来决定数据包的路径。作为示例的，参照图5，所述S42包括以下步骤：S421.基于数据采集信息轮询通信渠道，以获得通信渠道的负荷情况。S422.基于通信渠道的负荷情况选择相应的通信渠道转发封装好的数据采集信息。在使用总线模式和以太网模式同时接收数据时，可以使用负载均衡技术来提高系统的性能。负载均衡是一种通过分发工作负荷来平衡系统资源的使用情况的技术。本申请实施例还公开一种电子设备，包括存储器和处理器，所述存储器上存储有能够被处理器加载并执行如上述矿用移动设备组网的通信方法的计算机程序。本实施例方法的执行主体可以是一种控制装置，该控制装置设置在电子设备上，当前设备可以是具有WIFI功能的手机，平板电脑，笔记本电脑等电子设备，本实施例方法的执行主体也可以直接是电子设备的CPU。本申请实施例还公开一种计算机可读存储介质，存储有能够被处理器加载并执行如上的矿用移动设备组网的通信方法的计算机程序。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在如上的一个存储介质中，包括若干指令用以使得一台设备执行本申请每个实施例的方法。以上均为本申请的较佳实施例，并非依此限制本申请的保护范围，故：凡依本申请的结构、形状、原理所做的等效变化，均应涵盖于本申请的保护范围之内。
