标题title
一种端到端可信通信方法及系统
摘要abst
本发明公开一种端到端可信通信方法及系统，其中，所述系统包括信任度评价单元、策略管理单元和标识管理单元；信任度评价单元与策略管理单元通信连接，策略管理单元与标识管理单元通信连接，策略管理单元和标识管理单元分别与第一终端和第二终端通信连接，第一终端和第二终端中均内置有用于生成可信通信标识的标识生成单元。本发明可实现用户/终端在信任程度动态变化情况下的实时可信通信，并保证通信的真实性、安全性和私密性。
权利要求书clms
1.一种端到端可信通信方法，其特征在于，在同一个信任域内，因第一终端的信任度发生变化而无法再与第二终端进行直接可信通信时，通过如下步骤实现第一终端与第二终端之间的可信通信：S100)第一终端向端到端可信通信管理系统发送与第二终端可信通信请求；S200）端到端可信通信管理系统根据可信通信请求由端到端可信通信管理系统中的信任度评价单元对第一终端进行信任度评价；S300）端到端可信通信管理系统的策略管理单元根据信任度评价单元对第一终端的信任度评价结果进行如下操作：当第一终端的信任度评价结果满足继续可信通信的要求，则由策略管理单元确定通信策略和策略规则，并由策略管理单元将确定的通信策略分别下发至第一终端和第二终端，由策略管理单元将策略规则下发至端到端可信通信管理系统的标识管理单元，然后跳转至S400）继续执行，反之，则拒绝可信通信请求；S400）由标识管理单元根据策略规则将标识生成规则分别下发至第一终端和第二终端；S500）由第一终端中的标识生成单元和第二终端中的标识生成单元分别根据标识生成规则分别生成第一可信通信标识和第二可信通信标识；S600）第一终端和第二终端基于通信策略、第一可信通信标识和第二可信通信标识建立可信通信。2.根据权利要求1所述的方法，其特征在于，在步骤S200）中，可信通信管理系统中的信任度评价单元通过如下步骤对第一终端进行信任度评价：S201）数据采集模块采集与第一设备相关的信任度评价用数据信息并将采集到的信任度评价用数据发送至数据处理模块进行处理，其中，信任度评价用数据信息包括已有信息数据和实时信息数据，已有数据包括终端设备信息、网络状态信息、安全威胁信息、历史活动信息、数据变化信息和信任度评价单元记录信息；S202）数据处理模块对接收到的信任度评价用数据信息进行数据处理并将处理后的信任度评价用数据信息分别发送至监测分析模块和信任度评价模块，其中，数据处理包括数据清洗、数据归类和数据整合；S203）监测分析模块对接收到的信任度评价用数据信息进行监测分析并给出监测分析报告，且将监测分析报告分别发送至信任度评价模块和策略管理单元；S204）信任度评价模块根据信任度评价用数据信息和监测分析报告对第一终端的信任度进行评价并得出信任度评价报告，且信任度评价报告发送至策略管理单元。3.根据权利要求2所述的方法，其特征在于，在步骤S204）中，信任度评价模块通过内置的信任函数对第一终端当前信任度进行评价，其中，信任函数定义如下：式中，B为第一终端当前信任度，Fi为当前评价时刻信任度影响因子函数值，n为信任度影响因子的数量，x为第i种信任度影响因子对当前信任度B的影响值；其中，Fi包括安全类影响因子函数值和威胁类影响因子函数值/＞，和/＞通过下列算式计算得到：式中，为第/＞种安全类影响因子的阈值，/＞为第/＞种威胁类影响因子的阈值，/＞的取值范围和/＞的取值范围均为。4.根据权利要求3所述的方法，其特征在于，当第一终端多次因信任度发生变化而无法再与第二终端进行直接可信通信时，对第一终端进行信任度评价时，通过下式计算第一终端的当前综合信任度：式中，为第一终端当前综合信任度，/＞为第一终端历史信任度综值，/＞为第一终端当前信任度，a%为/＞在/＞中所占的百分比，b%为/＞在/＞中所占的百分比,a%与b%之和为100%；其中，和/＞通过下列算式计算得到：式中，为第j次历史信任度在/＞中的权重，/＞为第j次历史信任度对当前信任度的时间衰减度，m为历史信任度评价次数；其中，时间衰减度通过下式计算得到：式中，为当前信任度评价时刻/＞与第j次历史信任度评价时刻/＞之间的时间间隔，e为自然常数，λ为历史信任度衰减速度。5.根据权利要求2所述的方法，其特征在于，接收到监测分析报告和信任度评价报告后，策略管理单元对监测分析报告和信任度评价报告进行分析并结合模块化分类与选择的策略生成因素生成策略规则链。6.根据权利要求1所述的方法，其特征在于，策略管理单元下发至第一终端和第二终端的通信策略具有时效性，当第一终端和第二终端之间的可信通信时间超过通信策略的有效期，第一终端或/和第二终端需要重新进行信任度评价。7.一种端到端可信通信管理系统，其特征在于，利用权利要求1所述的端到端可信通信方法实现两个终端再次通信，所述系统包括信任度评价单元、策略管理单元和标识管理单元；信任度评价单元与策略管理单元通信连接，策略管理单元与标识管理单元通信连接，策略管理单元和标识管理单元分别与第一终端和第二终端通信连接，第一终端和第二终端中均内置有用于生成可信通信标识的标识生成单元。8.根据权利要求7所述的系统，其特征在于，信任度评价单元内设置有数据采集模块、数据处理模块、监测分析模块和信任度评价模块，数据采集模块与数据处理模块通信连接，数据处理模块分别与监测分析模块和信任度评价模块通信连接，监测分析模块分别与信任度评价模块和策略管理单元通信连接，信任度评价模块与策略管理单元通信连接。9.根据权利要求8所述的系统，其特征在于，信任度评价模块内置有用于对终端当前信任度进行评价的信任函数，其中，信任函数定义如下：式中，B为第一终端当前信任度，Fi为当前评价时刻信任度影响因子函数值，n为信任度影响因子的数量，x为第i种信任度影响因子对当前信任度B的影响值；其中，Fi包括安全类影响因子函数值和威胁类影响因子函数值/＞，和/＞通过下列算式计算得到：式中，为第/＞种安全类影响因子的阈值，/＞为第/＞种威胁类影响因子的阈值，/＞的取值范围和/＞的取值范围均为。10.根据权利要求8所述的系统，其特征在于，所述系统与终端基于安全交互机制进行通信，安全交互机制包括特定交互协议、有效交互凭证和动态交互口令。
说明书desc
技术领域本发明涉及网络通信技术领域，具体地说是一种端到端可信通信方法及系统。背景技术IP地址既标志着主机在网络中的位置同时又标识着主机的身份，对移动节点及其安全性有严重限制：在不中断传输层连接的情况下，直接更改主机地址是不可能的；互联网上没有一致且可信任的匿名或隐私；缺乏对数据报和系统的正确身份验证导致IP欺骗。随着智能设备的不断出现和无线通信技术的快速发展，IP地址代表“身份”和“位置”的双重属性阻碍了终端移动便利性，也为网络安全带来巨大的隐患。在两个终端通过IP密码标识实现可信通信之后，当终端访问权限变化、业务需求变化、网络环境变化等引起信任关系的动态变化出现时，两个终端需要重新建立信任关系并实现可信通信，而如何在引起信任关系的动态变化出现时确保两个终端能够方便快捷地建立信任关系并实现可信通信成为人们所关注的一个问题。发明内容为此，本发明所要解决的技术问题在于提供一种端到端可信通信方法及系统，可实现用户/终端在信任程度动态变化情况下的实时可信通信，并保证通信的真实性、安全性和私密性。为解决上述技术问题，本发明提供如下技术方案：一种端到端可信通信方法，在同一个信任域内，因第一终端的信任度发生变化而无法再与第二终端进行直接可信通信时，通过如下步骤实现第一终端与第二终端之间的可信通信：S100)第一终端向端到端可信通信管理系统发送与第二终端可信通信请求；S200）端到端可信通信管理系统根据可信通信请求由端到端可信通信管理系统中的信任度评价单元对第一终端进行信任度评价；S300）端到端可信通信管理系统的策略管理单元根据信任度评价单元对第一终端的信任度评价结果进行如下操作：当第一终端的信任度评价结果满足继续可信通信的要求，则由策略管理单元确定通信策略和策略规则，并由策略管理单元将确定的通信策略分别下发至第一终端和第二终端，由策略管理单元将策略规则下发至端到端可信通信管理系统的标识管理单元，然后跳转至S400）继续执行，反之，则拒绝可信通信请求；S400）由标识管理单元根据策略规则将标识生成规则分别下发至第一终端和第二终端；S500）由第一终端中的标识生成单元和第二终端中的标识生成单元分别根据标识生成规则分别生成第一可信通信标识和第二可信通信标识；S600）第一终端和第二终端基于通信策略、第一可信通信标识和第二可信通信标识建立可信通信。上述方法，在步骤S200）中，可信通信管理系统中的信任度评价单元通过如下步骤对第一终端进行信任度评价：S201）数据采集模块采集与第一设备相关的信任度评价用数据信息并将采集到的信任度评价用数据发送至数据处理模块进行处理，其中，信任度评价用数据信息包括已有信息数据和实时信息数据，已有数据包括终端设备信息、网络状态信息、安全威胁信息、历史活动信息、数据变化信息和信任度评价单元记录信息；S202）数据处理模块对接收到的信任度评价用数据信息进行数据处理并将处理后的信任度评价用数据信息分别发送至监测分析模块和信任度评价模块，其中，数据处理包括数据清洗、数据归类和数据整合；S203）监测分析模块对接收到的信任度评价用数据信息进行监测分析并给出监测分析报告，且将监测分析报告分别发送至信任度评价模块和策略管理单元；S204）信任度评价模块根据信任度评价用数据信息和监测分析报告对第一终端的信任度进行评价并得出信任度评价报告，且信任度评价报告发送至策略管理单元。上述方法，在步骤S204）中，信任度评价模块通过内置的信任函数对第一终端当前信任度进行评价，其中，信任函数定义如下：式中，B为第一终端当前信任度，Fi为当前评价时刻信任度影响因子函数值，n为信任度影响因子的数量，x为第i种信任度影响因子对当前信任度B的影响值；其中，Fi包括安全类影响因子函数值和威胁类影响因子函数值，/＞和/＞通过下列算式计算得到：式中，为第/＞种安全类影响因子的阈值，/＞为第/＞种威胁类影响因子的阈值，的取值范围和/＞的取值范围均为。上述方法，当第一终端多次因信任度发生变化而无法再与第二终端进行直接可信通信时，对第一终端进行信任度评价时，通过下式计算第一终端的当前综合信任度：式中，为第一终端当前综合信任度，/＞为第一终端历史信任度综值，/＞为第一终端当前信任度，a%为/＞在/＞中所占的百分比，b%为/＞在/＞中所占的百分比,a%与b%之和为100%；其中，和/＞通过下列算式计算得到：式中，为第j次历史信任度在/＞中的权重，/＞为第j次历史信任度对当前信任度的时间衰减度，m为历史信任度评价次数；其中，时间衰减度通过下式计算得到：式中，为当前信任度评价时刻/＞与第j次历史信任度评价时刻/＞之间的时间间隔，e为自然常数，λ为历史信任度衰减速度。上述方法，接收到监测分析报告和信任度评价报告后，策略管理单元对监测分析报告和信任度评价报告进行综合分析并结合模块化分类与选择的策略生成因素生成策略规则链，其中，策略规则链由多个策略规则按照一定的顺序组合而成的策略规则组合。上述方法，策略管理单元下发至第一终端和第二终端的通信策略具有时效性，当第一终端和第二终端之间的可信通信时间超过通信策略的有效期，第一终端或/和第二终端需要重新进行信任度评价。一种端到端可信通信管理系统，利用上述端到端可信通信方法实现两个终端再次通信，所述系统包括信任度评价单元、策略管理单元和标识管理单元；信任度评价单元与策略管理单元通信连接，策略管理单元与标识管理单元通信连接，策略管理单元和标识管理单元分别与第一终端和第二终端通信连接，第一终端和第二终端中均内置有用于生成可信通信标识的标识生成单元。上述系统，信任度评价单元内设置有数据采集模块、数据处理模块、监测分析模块和信任度评价模块，数据采集模块与数据处理模块通信连接，数据处理模块分别与监测分析模块和信任度评价模块通信连接，监测分析模块分别与信任度评价模块和策略管理单元通信连接，信任度评价模块与策略管理单元通信连接。上述系统，信任度评价模块内置有用于对终端当前信任度进行评价的信任函数，其中，信任函数定义如下：式中，B为第一终端当前信任度，Fi为当前评价时刻信任度影响因子函数值，n为信任度影响因子的数量，x为第i种信任度影响因子对当前信任度B的影响值；其中，Fi包括安全类影响因子函数值和威胁类影响因子函数值，/＞和/＞通过下列算式计算得到：式中，为第/＞种安全类影响因子的阈值，/＞为第/＞种威胁类影响因子的阈值，的取值范围和/＞的取值范围均为。上述系统，所述系统与终端基于安全交互机制进行通信，安全交互机制包括特定交互协议、有效交互凭证和动态交互口令。本发明的技术方案取得了如下有益的技术效果：1.本发明可实现用户/终端在信任程度动态变化情况下的实时可信通信，并保证通信的真实性、安全性和私密性。2.本发明提出了信任关系模型，实现可变信任-可变策略-可变标识-可信通信的动态关系的自动化建立过程，满足在当前5G、云等新兴应用场景下，实时保障访问权限变化、业务需求变化、网络环境变化等情况下的安全通信。3.本发明提出了一种基于历史评价和时间变化的信任函数，用于评价信任影响因素在动态变化情况下的定量信任评价方法，客观准确分析当前访问端的信任程度水平，并依此评价得分自动关联信任策略规则。4.本发明提出的动态信任策略机制可以根据终端/用户信息、历史活动、环境因素等多个变量影响信任程度和授权请求的结果，从而大大提高了网络的安全性，通过这些机制的会话比没有通过的会话更值得信任。基于上述机制，我们可以适当减少基于用户对于身份验证方法的依赖，以获得访问资源所需的信任，从而改善整体用户体验。附图说明图1为本发明中端到端可信通信管理系统的工作原理图；图2为本发明中实现端到端可信通信的流程示意图；图3为本发明中对终端进行信任度评价的流程示意图。具体实施方式下面结合示例，针对本发明进行进一步说明。如图1所示，本发明端到端可信通信管理系统，包括信任度评价单元、策略管理单元和标识管理单元；信任度评价单元与策略管理单元通信连接，策略管理单元与标识管理单元通信连接，策略管理单元和标识管理单元分别与第一终端和第二终端通信连接，第一终端和第二终端中均内置有用于生成可信通信标识的标识生成单元。其中，信任度评价单元内设置有数据采集模块、数据处理模块、监测分析模块和信任度评价模块，数据采集模块与数据处理模块通信连接，数据处理模块分别与监测分析模块和信任度评价模块通信连接，监测分析模块分别与信任度评价模块和策略管理单元通信连接，信任度评价模块与策略管理单元通信连接。本实施例中，信任度评价模块内置有用于对终端当前信任度进行评价的信任函数，其中，信任函数定义如下：式中，B为第一终端当前信任度，Fi为当前评价时刻信任度影响因子函数值，n为信任度影响因子的数量，x为第i种信任度影响因子对当前信任度B的影响值；其中，信任影响因子用来表征某事项对信任的影响程度，信任影响因子越大，表明该事项对信任值的影响越大；反之，该事项对信任值的影响越小，本实施例中，Fi包括安全类影响因子函数值和威胁类影响因子函数值/＞，/＞和/＞通过下列算式计算得到：式中，为第/＞种安全类影响因子的阈值，/＞为第/＞种威胁类影响因子的阈值，/＞和的值可以根据实际情况进行设定，/＞的取值范围和/＞的取值范围均为。鉴于第一终端与第二终端之间的可信通信存在多次因为起信任关系的动态变化出现而发生中断的情况，仅依靠单次的信任度评价作为建立第一终端与第二终端之间的信任关系存在一定程度上的偏差，为此，需要综合考虑历史评价情况，并最终得出受评者的当前综合信任度，故而，在对受评者的信任度进行评价时引入历史信任度综值，并计算每一次历史信任度在历史信任度综值中所占的权重，然后再结合受评者当前的信任度计算得出受评者的当前综合信任度。本实施例中，第一终端的当前综合信任度可以通过下式计算得到：式中，为第一终端当前综合信任度，/＞为第一终端历史信任度综值，/＞为第一终端当前信任度，a%为/＞在/＞中所占的百分比，b%为/＞在/＞中所占的百分比,a%与b%之和为100%；其中，和/＞通过下列算式计算得到：式中，为第j次历史信任度在/＞中的权重，/＞为第j次历史信任度对当前信任度的时间衰减度，m为历史信任度评价次数；其中，时间衰减度通过下式计算得到：式中，为当前信任度评价时刻/＞与第j次历史信任度评价时刻/＞之间的时间间隔，e为自然常数，λ为历史信任度衰减速度。本发明中，在计算第一终端历史信任度综值Bh时引入时间衰减，其原因在于考虑了历史信任度对当前信任度评价结果的影响会随着时间的推移逐渐衰减，历史信任度评价时刻距离当前信任度评价时刻越久远，历史信任度对当前信任度的影响越小。同时，对于经过多次信任度的终端的当前信任度评价，依据当前信任度评价时刻与每次历史信任度评价时刻的距离，通过参数对信任因子权重进行调配。即Δt越大，此时的信任因子历史信任度评价权重越小；Δt越小，则此时的信任因子历史信任度评价权重越大。/＞∈，，/＞数值可按需设定，以下为一种权重参数设定示例：th1为第一次历史信任度评价时刻，th2为第二次历史信任度评价时刻，th3为第三次历史信任度评价时刻，tr为当前信任的评价时刻，Δt1=tr−th1、Δt2=tr−th2、Δt3=tr−th3。Δt3的指数高于Δt2，说明第3次次历史评价对当前评价信任度影响大于2次历史信任度评价；同理，Δt2的指数高于Δt1，说明第2次历史信任度评价对当前评价信任度影响大于第1次历史信任度评价。如图2所示，在同一个信任域内，因第一终端的信任度发生变化而无法再与第二终端进行直接可信通信时，利用所述端到端可信通信管理系统通过如下步骤实现第一终端与第二终端之间的可信通信：S100)第一终端向端到端可信通信管理系统发送与第二终端可信通信请求；S200）端到端可信通信管理系统根据可信通信请求由端到端可信通信管理系统中的信任度评价单元对第一终端进行信任度评价；S300）端到端可信通信管理系统的策略管理单元根据信任度评价单元对第一终端的信任度评价结果进行如下操作：当第一终端的信任度评价结果满足继续可信通信的要求，则由策略管理单元确定通信策略和策略规则，并由策略管理单元将确定的通信策略分别下发至第一终端和第二终端，由策略管理单元将策略规则下发至端到端可信通信管理系统的标识管理单元，然后跳转至S400）继续执行，反之，则拒绝可信通信请求；S400）由标识管理单元根据策略规则将标识生成规则分别下发至第一终端和第二终端；S500）由第一终端中的标识生成单元和第二终端中的标识生成单元分别根据标识生成规则分别生成第一可信通信标识和第二可信通信标识；S600）第一终端和第二终端基于通信策略、第一可信通信标识和第二可信通信标识建立可信通信。在步骤S200）中，可信通信管理系统中的信任度评价单元通过如下步骤对第一终端进行信任度评价：S201）数据采集模块采集与第一设备相关的信任度评价用数据信息并将采集到的信任度评价用数据发送至数据处理模块进行处理，其中，信任度评价用数据信息包括已有信息数据和实时信息数据，已有数据包括终端设备信息、网络状态信息、安全威胁信息、历史活动信息、数据变化信息和信任度评价单元记录信息；S202）数据处理模块对接收到的信任度评价用数据信息进行数据处理并将处理后的信任度评价用数据信息分别发送至监测分析模块和信任度评价模块，其中，数据处理包括数据清洗、数据归类和数据整合；S203）监测分析模块对接收到的信任度评价用数据信息进行监测分析并给出监测分析报告，且将监测分析报告分别发送至信任度评价模块和策略管理单元；S204）信任度评价模块根据信任度评价用数据信息和监测分析报告通过内置的信任函数对第一终端当前信任度进行评价并得出信任度评价报告，且将信任度评价报告发送至策略管理单元。接收到监测分析报告和信任度评价报告后，策略管理单元对监测分析报告和信任度评价报告进行综合分析并结合模块化分类与选择的策略生成因素生成策略规则链。策略管理单元生成通信策略和策略规则采用两种策略机制：一是结合信任评价单元给出的信任度评价结果，根据信任度与策略规则的预定义关联关系，快速、动态制定和调整通信策略；二是综合分析信任度评价结果和监测分析结果，结合策略生成因素的模块化分类与选择，生成个性化、细粒度的策略规则链。策略管理单元基于监测分析结果和信任评价结果对通信终端每个网络流设置通信策略和策略规则，保障可信通信。通信策略和策略规则制定完成后，在整个网络中自动分发通信策略给通信终端。表1 策略机制一表2 策略机制二策略管理单元将动态变化的策略规则/策略规则链发送给标识管理单元，标识管理单元根据策略规则/策略规则链更新标识生成规则并发送给终端的标识生成单元指导可信通信标识更新。终端建立端到端可信通信时：基于策略规则明确通信策略、通信范围、通信粒度等，通过通信策略引导终端/用户业务数据传输处于符合业务需求的、最小权限范围内的安全可信路径中；基于IPv6密码标识构建端到端会话连接，实现真实数据传输。而且策略管理单元下发至第一终端和第二终端的通信策略具有时效性，当第一终端和第二终端之间的可信通信时间超过通信策略的有效期，第一终端或/和第二终端需要重新进行信任度评价。为了提高端到端可信通信管理系统与终端之间的通信安全，将所述端到端可信通信管理系统与终端基于安全交互机制进行通信，安全交互机制包括特定交互协议、有效交互凭证和动态交互口令，这样可以最大程度减轻网络物理攻击。因终端访问权限变化、业务需求变化、网络环境变化等引起信任关系的动态变化，通过本发明中端到端可信通信方法将新的信任关系动态映射到可信通信标识，建立可变信任-可变策略-可变标识的动态关系，通过可信通信标识的变化实现通信范围、通信权限的变化，实现基于可变信任策略的通信，同时保证用户使用真实身份通信，并可验证和溯源。显然，上述实施例仅仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引伸出的显而易见的变化或变动仍处于本专利申请权利要求的保护范围之中。
