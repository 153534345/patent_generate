标题title
反激变换器的控制方法以及反激变换器
摘要abst
本申请关于反激变换器的控制方法以及反激变换器，涉及开关电源控制方法领域。该控制电路包括峰值电流控制模块、比较器、脉冲宽度记录模块、脉冲宽度检测模块、关断时间计算模块、关断时间控制模块以及驱动模块。在对于反激变换器进行工作频率以及工作状态的控制的过程中，通过比较器进行反馈信号脉冲宽度的确定，并基于实时的脉冲宽度生成用于控制关断时间以及工作模式的控制信号，使得反激变换器的工作频率以及工作模式能够与当前工作状态实时对应，进而提高了反激变换器的工作频率与工作状态的切换效率，提高了反激变换器的工作稳定性。
权利要求书clms
1.一种反激变换器的控制方法，其特征在于，所述方法应用于反激变换器的自适应断续和连续电流模式控制电路中，所述控制电路包括峰值电流控制模块、比较器、脉冲宽度记录模块、脉冲宽度检测模块、关断时间计算模块、关断时间控制模块以及驱动模块；所述峰值电流控制模块与所述比较器的正极输入端连接，所述比较器的输出端与所述脉冲宽度记录模块连接；所述脉冲宽度记录模块与所述脉冲宽度检测模块以及所述关断时间计算模块连接；所述关断时间计算模块与所述关断时间控制模块连接；所述关断时间控制模块与所述驱动模块连接；所述驱动模块用于生成并输出驱动信号；所述脉冲宽度检测模块用于接收过零检测ZCD信号；所述峰值电流控制模块用于接收反馈环路输出信号；所述方法包括：接收反馈信号；将所述反馈信号通过所述峰值电流控制模块，生成峰值电流控制量；将所述峰值电流控制量输入所述比较器的正极输入端，输出得到比较脉冲信号；获取ZCD脉冲信号；通过所述脉冲宽度检测模块对所述ZCD脉冲信号进行宽度检测，得到脉冲信号宽度；将所述脉冲信号宽度输入脉冲宽度记录模块进行宽度记录；将所述脉冲信号宽度输入所述关断时间计算模块，生成关断时间数据，所述关断时间数据用于指示在连续导通模式CCM下每个工作周期内的关断时间；将所述关断时间数据输入所述关断时间控制模块以及驱动模块，输出与所述关断时间数据对应的驱动信号，所述驱动信号用于控制所述反激变换器的工作模式及工作频率。2.根据权利要求1所述的方法，其特征在于，所述将所述峰值电流控制量输入所述比较器的正极输入端，输出得到比较脉冲信号，包括：将所述峰值电流控制量输入所述比较器的正端，并将所述峰值电流控制量阈值输入所述比较器的负端，输出得到所述比较脉冲信号。3.根据权利要求1所述的方法，其特征在于，所述将所述脉冲信号宽度输入所述关断时间计算模块，生成关断时间数据，包括：获取CCM深度控制量数据；将所述CCM深度控制量数据以及所述脉冲信号宽度输入所述关断时间计算模块；通过所述关断时间计算模块，基于关断时间计算规则生成所述关断时间数据。4.根据权利要求3所述的方法，其特征在于，所述关断时间计算规则包括减法规则；所述通过所述关断时间计算模块，基于关断时间计算规则生成所述关断时间数据，包括：通过所述关断时间计算模块，确定与所述CCM深度控制量数据对应的深度控制常数；基于所述减法规则，确定所述深度控制常数以及所述脉冲信号宽度的差值为所述关断时间数据。5.根据权利要求3所述的方法，其特征在于，所述关断时间计算规则包括乘法规则，所述通过所述关断时间计算模块，基于关断时间计算规则生成所述关断时间数据，包括：通过所述关断时间计算模块，确定与所述CCM深度控制量数据对应的深度数据百分比常数；基于所述乘法规则，确定所述深度数据百分比常数与所述脉冲信号宽度的乘积为所述关断时间数据。6.一种反激变换器，其特征在于，所述反激变换器包括反激变换器的控制电路，所述反激变换器的控制电路用于执行如权利要求1所述的反激变换器的控制方法。
说明书desc
技术领域本申请涉及开关电源控制方法领域，特别涉及一种反激变换器的控制方法以及反激变换器。背景技术反激变换器广泛用于各类消费电子产品，是中小功率电源的主要拓扑。高效率，低噪音的方案对降低系统成本，提高用户体验极其重要。图1是典型的反激变换器电路示意图。其中输入为AC交流电压，C1是输入电压整流后滤波电容。Q1是原边的主开关管。变压器T1有一个原边绕组Np，一个副边绕组Ns，一个辅助绕组Na。D1是输出整流管。控制器从辅助绕组通过整流管D2提供获取供电VCC。控制器输出信号DRV驱动Q1的开通和关断。当Q1 开通时，变压器从输入存储能量。当Q1关断后，变压器释放能量到输出端。控制电路通过检测辅助绕组Na的信号到ZCD可以获取变压器工作的电压信息。控制电路通过检测Rcs电压到CS获取Q1的工作电流信息。FB为反馈环路输出，用以控制输出电压或者电流。为了简化控制，降低主功率开关管和输出整流管的应力，中小功率反激电路通常工作在非连续导通模式，如图2所示，其中DRV是开关管的驱动信号，Ip是变压器原边的电流，Is是变压器副边的电流，Vdrain是开关管漏极的信号。在DCM模式下，驱动信号DRV的开通发生在副边电流结束到零之后。图2所示为一种通常的准谐振工作波形图，即开通信号等到Vdrain信号到最低点开通。而图3所示为在副边电流归零后有较长死区时间的DCM模式。与DCM模式对应的是电流连续模式，即连续导通模式，如图4所示。在CCM模式下，驱动信号DRV的开通发生在副边电流结束到零之前。CCM模式下的开关管和整流管电压应力较高，但是CCM模式提高了开关频率，可以在同样的开关工作电流情况下，提高输出功率。在很多低成本DCM工作的反激变换器应用中，如果为了降低成本采用较小的输入电容，而输出功率要求大，则输入电压较低的时候，由于峰值电流被控制器最大值所限制，导致输出失调而产生超出指标要求的工频纹波。为了能够减小输出纹波，CCM控制方式被引入，通过CCM增加输出功率来降低纹波。而在输入电压较低的情况下，开关管和整流管的电压应力即使在CCM模式下也相对较低，因此这是一种比较有利的控制方法。在CCM模式下，需要确定关断的时间Toff。现通常有2种做法如下。做法1：采用固定预设的关断时间Toff。如图4所示，toff为开关管的关断部分时间。控制器决定一个固定的关断时间Toff。当控制器发现环路反馈信号FB已经到达极限而无法实现输出调节功能的时候，改变开关过程迫使开关管按照预定的toff时间开通下一个驱动信号。做法2：采用可变的关断时间Toff。如图5所示。在每个周期内，控制器都会记录当前周期的的关断时间Toff。当控制器发现环路反馈信号FB已经接近极限的时候，把这个Toff时间作为CCM模式下所控制的关断时间。这个比较的FB的阈值可以根据控制目标来定，较深的CCM可以采用较低的FB_a值。如图5所示，当FB到达FB_a之后，记录关断时间toff3。在进入CCM后，开关管按照所记录的预定的toff3时间开通下一个驱动信号。当前的做法1和做法2都能够实现降低纹波的目的，但在实际应用中都有一定的限制。做法1中，由于Toff时间是固定的，当反激变换器温度升高时，采样电阻Rcs的阻值会升高。同样的开关电流Ip，CS的采样值上升。这会导致同样的峰值电流控制量下，原边的电流降低，降低了输出功率，减弱了CCM降低输出纹波的力度。在实际应用中表现为在温度升高后，输出纹波增大。做法2可以实时检测Toff时间。当温度升高后，如果DCM控制模式采用准谐振方式，相对的Toff时间会减小，从而自动提高了CCM的深度，提高但是当检测点FB_a的值时候，并不工作在准谐振第一个波谷的情况下，或者并不工作在准谐振状态情况下，所对应的Toff时间会发生变化，而记录了错误或者过大的值。在这种控制方法中，要求FB必须对应相应的工作频率,比如频率升高为2倍，频率比较高，系统效率反而降低。因此，对反激变换器的控制产生了限制，减小了这种控制方法的应用范围。也即，相关技术中的控制方法难以对应反激变换器的实际工作状态，高效选择与切换合适的工作模式。发明内容本申请关于反激变换器的控制方法以及反激变换器，根据反激变换器的实际工作状态，高效选择与切换合适的工作模式。该技术方案如下：一方面，提供了一种反激变换器的控制方法，该方法应用于反激变换器的控制电路中，控制电路包括峰值电流控制模块、比较器、脉冲宽度记录模块、脉冲宽度检测模块、关断时间计算模块、关断时间控制模块以及驱动模块；峰值电流控制模块与比较器的正极输入端连接，比较器的输出端与脉冲宽度记录模块连接；脉冲宽度记录模块与脉冲宽度检测模块以及关断时间计算模块连接；关断时间计算模块与关断时间控制模块连接；关断时间控制模块与驱动模块连接；驱动模块用于生成并输出驱动信号；脉冲宽度检测模块用于接收过零检测信号；峰值电流控制模块用于接收反馈环路输出信号；该方法包括：接收反馈信号；将反馈信号通过峰值电流控制模块，生成峰值电流控制量；将峰值电流控制量输入比较器的正极输入端，输出得到比较脉冲信号；获取ZCD脉冲信号；通过脉冲宽度检测模块对ZCD脉冲信号进行宽度检测，得到脉冲信号宽度；将脉冲信号宽度输入脉冲宽度记录模块进行宽度记录；将脉冲信号宽度输入关断时间计算模块，生成关断时间数据，关断时间数据用于指示在连续导通模式CCM下每个工作周期内的关断时间；将关断时间数据输入关断时间控制模块以及驱动模块，输出与关断时间数据对应的驱动信号，驱动信号用于控制反激变换器的工作状态及工作频率。在一个可选的实施例中，将峰值电流控制量输入比较器的正极输入端，输出得到比较脉冲信号，包括：将峰值电流控制量输入比较器的正端，并将峰值电流控制量阈值输入比较器的负端，输出得到比较脉冲信号。在一个可选的实施例中，将脉冲信号宽度输入关断时间计算模块，生成关断时间数据，包括：获取CCM深度控制量数据；将CCM深度控制量数据以及脉冲信号宽度输入关断时间计算模块；通过关断时间计算模块，基于关断时间计算规则生成关断时间数据。在一个可选的实施例中，关断时间计算规则包括减法规则；通过关断时间计算模块，基于关断时间计算规则生成关断时间数据，包括：通过关断时间计算模块，确定与CCM深度控制量数据对应的深度控制常数；基于减法规则，确定深度控制常数以及脉冲信号宽度的差值为关断时间数据。在一个可选的实施例中，关断时间计算规则包括乘法规则，通过关断时间计算模块，基于关断时间计算规则生成关断时间数据，包括：通过关断时间计算模块，确定与CCM深度控制量数据对应的深度数据百分比常数；基于乘法规则，确定深度数据百分比常数与脉冲信号宽度的乘积为关断时间数据。另一方面，提供了一种反激变换器，反激变换器中包括如上的反激变换器的控制电路。本申请提供的技术方案带来的有益效果至少包括：在对于反激变换器进行工作频率以及工作状态的控制的过程中，通过比较器进行反馈信号脉冲宽度的确定，并基于实时的脉冲宽度生成用于控制关断时间以及工作模式的控制信号，逐步升高工作频率，使得反激变换器的工作频率以及工作模式能够与当前工作状态实时对应。提高了反激变换器的工作频率与工作状态的切换效率，提高了反激变换器的工作稳定性。显著减小了输入滤波电容较小时的输出纹波。实现方式简单，无需斜率补偿，简化芯片设计。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1示出了相关技术中反激变换器的结构示意图。图2示出了相关技术中反激变换器的工作波形示意图。图3示出了相关技术中DCM工作波形示意图。图4示出了相关技术中的CCM工作波形示意图。图5示出了相关技术中DCM到CCM过渡的工作波形示意图。图6示出了本申请一个示例性实施例提供的一种反激变换器的控制电路的结构示意图。图7示出了本申请一个示例性实施例提供的一种反激变换器的控制方法的流程示意图。图8示出了本申请一个示例性实施例提供的一种反激变换器的工作波形示意图。图9示出了本申请一个示例性实施例提供的另一种反激变换器的控制方法的流程示意图。具体实施方式为使本申请的目的、技术方案和优点更加清楚，下面将结合附图对本申请实施方式作进一步地详细描述。图6示出了本申请一个示例性实施例提供的一种反激变换器的控制电路的结构示意图。请参考图6，该控制电路包括峰值电流控制模块610、比较器620、脉冲宽度记录模块630、脉冲宽度检测模块640、关断时间计算模块650、关断时间控制模块660以及驱动模块670；峰值电流控制模块610与比较器620的正极输入端连接，比较器620的输出端与脉冲宽度记录模块630连接；脉冲宽度记录模块630与脉冲宽度检测模块640以及关断时间计算模块650连接；关断时间计算模块650与关断时间控制模块660连接；关断时间控制模块660与驱动模块670连接；驱动模块670用于生成并输出驱动信号；脉冲宽度检测模块640用于接收ZCD信号；峰值电流控制模块610用于接收反馈环路输出信号。本申请与上述控制电路中的各个模块的具体实现形态不做限定，仅记载上述各个模块的模块功能以及连接关系。需要说明的是，图6即示出了一种反激变换器的电路结构，其是将图1所示的相关技术中的反激变换器的结构进行了控制电路的替换得到的。结合图6，图7示出了本申请一个示例性实施例提供的一种反激变换器的控制方法的流程示意图，该方法包括：步骤701，接收反馈信号。该过程即为反馈过程进入如图6所示的反激变换器的控制电路的过程。该信号即为图6中所示的环形反馈信号FB。步骤702，将反馈信号通过峰值电流控制模块，生成峰值电流控制量。在接收到反馈信号后，通过峰值电流控制模块，反馈信号将会变换，生成峰值电流控制量Ipk_reg。步骤703，将峰值电流控制量输入比较器的正极输入端，输出得到比较脉冲信号。在本申请实施例中，比较器用于将峰值电流控制量与负极输入的参数进行比较，以生成比较脉冲信号。如图6所示，比较脉冲信号为p1。步骤704，获取ZCD脉冲信号。在本申请实施例中，对应图6所示情况，本申请所示的控制电路具有两个数据输入端，在另一数据输入端，控制电路将会从反激变换器的其他模块中获取ZCD脉冲信号。步骤705，通过脉冲宽度检测模块对ZCD脉冲信号进行宽度检测，得到脉冲信号宽度。本申请实施例中，通过脉冲宽度检测模块，即可对于ZCD脉冲信号的脉冲宽度进行确定。步骤706，将脉冲信号宽度输入脉冲宽度记录模块进行宽度记录。在本申请实施例中，在一个宽度记录周期内，基于比较脉冲信号的生成周期，对于脉冲信号宽度进行记录。也即，在接收到一个比较脉冲信号p1时，对于脉冲信号宽度进行一次记录，以进行时序的统一，进而生成匹配的工作波形。步骤707，将脉冲信号宽度输入关断时间计算模块，生成关断时间数据。在本申请实施例中，关断时间数据用于指示在连续导通模式CCM下每个工作周期内的关断时间。步骤708，将关断时间数据输入关断时间控制模块以及驱动模块，输出与关断时间数据对应的驱动信号。在确定关断时间后，控制电路即生成对应的驱动信号DRV，并进行驱动信号的输出。对应上述过程，请参考图8，其示出了驱动信号与变压器的原边电流Ip，变压器的副边电流Is以及开关管漏极的信号Vdrain的对应关系。本申请实施例所依据的技术方案是，在不同的控制策略中，虽然峰值电流和工作频率都会发生变化，但存在如下公式1所示的恒等式：，式中，Lm为变压器励磁电感，Ipk为原边峰值电流，n为变压器原副边匝比，Vout为输出电压，Tr为变压器磁恢复时间。在一个稳定的工作电路中，Lm， n,和Vout都是确定的，因此Ipk与Tr有固定的关系，不随着频率控制方法而改变。不管控制曲线如何变化，只要在Ipk_a点记录ZCD的宽度，总是可以有一致的Tz值。因此，当采用本申请方法，根据Ipk_a来记录ZCD的宽度，就避免了当前现有技术中所涉及的做法2中，通过记录Toff时间带来的由于频率控制方法不同而带来的不确定性。同时，当温度发生变化后，采样电阻Rcs的阻值会升高。虽然在同样的Ipk_reg控制量下，原边的电流也会降低，减弱了CCM提供输出功率的力度。但是在本申请方法工作情况下，由前述公式，当实际开关电流下降后，变压器磁恢复时间Tr也会减小，即检测到的tz3会减小。因此，关断时间计算得出的量自动变小，从而自动加深CCM的程度，提高了输出功率。在本申请实施例中，驱动信号用于控制反激变换器的工作模式及工作频率。综上所述，本申请实施例提供的方法，在对于反激变换器进行工作频率以及工作状态的控制的过程中，通过比较器进行反馈信号脉冲宽度的确定，并基于实时的脉冲宽度生成用于控制关断时间以及工作模式的控制信号，使得反激变换器的工作频率以及工作模式能够与当前工作状态实时对应，进而提高了反激变换器的工作频率与工作状态的切换效率，提高了反激变换器的工作稳定性。图9示出了本申请一个示例性实施例提供的另一种反激变换器的控制方法的流程示意图，以该方法应用于如图6所示的反激变换器的控制电路中为例进行说明，该方法包括：步骤901，接收反馈信号。该过程与步骤701所示的过程对应，在此不做赘述。步骤902，将反馈信号通过峰值电流控制模块，生成峰值电流控制量。该过程与步骤702所示的过程对应，在此不做赘述。步骤903，将峰值电流控制量输入比较器的正端，并将峰值电流控制量阈值输入比较器的负端，输出得到比较脉冲信号。在本申请实施例中，比较器负极输入端的输入量为峰值电流控制量阈值，以进行比较脉冲信号的生成。步骤904，获取ZCD脉冲信号。步骤905，通过脉冲宽度检测模块对ZCD脉冲信号进行宽度检测，得到脉冲信号宽度。步骤906，将脉冲信号宽度输入脉冲宽度记录模块进行宽度记录。步骤904至步骤906与步骤704至步骤706对应，在此不做赘述。步骤907，获取CCM深度控制量数据。本申请实施例中，CCM深度控制量数据为与反激变换器的控制电路相对应的预设值，该CCM深度控制量数据可以实现为数值形式的控制常数，或，CCM深度控制量数据实现为数据组合。步骤908，将CCM深度控制量数据以及脉冲信号宽度输入关断时间计算模块。该过程即为数据输入过程。步骤909，通过关断时间计算模块，基于关断时间计算规则生成关断时间数据。在本申请实施例中，关断时间计算规则包括减法规则以及乘法规则。对应减法规则，如下公式2所示：，对应乘法规则，如下公式3所示：，上述公式2以及公式3中，toff为关断时间，tz为脉冲信号宽度，tc为由CCM深度控制量数据确定得到的深度控制常数，m为CCM深度控制量数据对应的深度数据百分比常数。也即，对应减法规则，通过关断时间计算模块，确定与CCM深度控制量数据对应的深度控制常数，并基于减法规则，确定深度控制常数以及脉冲信号宽度的差值为关断时间数据。对应乘法规则，通过关断时间计算模块，确定与CCM深度控制量数据对应的深度数据百分比常数，并基于乘法规则，确定深度数据百分比常数与脉冲信号宽度的乘积为关断时间数据。步骤910，将关断时间数据输入关断时间控制模块以及驱动模块，输出与关断时间数据对应的驱动信号。该过程与步骤708对应。本申请实施例对应的有益效果至少包括：在对于反激变换器进行工作频率以及工作状态的控制的过程中，通过比较器进行反馈信号脉冲宽度的确定，并基于实时的脉冲宽度生成用于控制关断时间以及工作模式的控制信号，逐步升高工作频率，使得反激变换器的工作频率以及工作模式能够与当前工作状态实时对应。提高了反激变换器的工作频率与工作状态的切换效率，提高了反激变换器的工作稳定性。显著减小了输入滤波电容较小时的输出纹波。实现方式简单，无需斜率补偿，简化芯片设计。上述仅为本申请的可选实施例，并不用以限制本申请，凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
