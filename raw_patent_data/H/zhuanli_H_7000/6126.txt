标题title
一种电力系统数据采集系统及方法
摘要abst
本发明提供一种电力系统数据采集系统及方法，涉及电力通信技术领域，电力系统数据采集系统根据的电力系统的数据类型和通讯报文，得到OPC标准协议的数据分组；根据通讯报文和数据分组，设置OPC标准协议的数据位号参数；根据数据分组和数据位号参数得到电力系统的电力数据；根据OPC标准协议的数据分组和数据位号参数，得到电力数据在OPC标准协议中对应的OPC数据并根据OPC数据得到OPC数据源；最后数据读取请求提供对应的OPC数据源的电力数据。本发明通过针对每个电力系统设置OPC标准协议的数据分组和参数，以适配不同的电力规约类型，减少不同通讯规约类型的接口软件应用，从而减轻服务器硬件设备的负担，避免出现系统运行缓慢的情况。
权利要求书clms
1.一种电力系统数据采集系统，其特征在于，所述电力系统数据采集系统包括数据采集配置单元、数据转换单元和服务单元，所述数据采集配置单元包括通讯端口配置子单元、采集数据配置子单元和数据采集子单元；所述通讯端口配置子单元用于：根据电力系统设置串口通讯和网络通讯的通讯配置；所述采集数据配置子单元用于：根据所述电力系统的电力规约协议，得到所述电力规约协议的通讯报文；根据所述电力系统的数据类型和所述通讯报文，得到OPC标准协议的数据分组；根据所述通讯报文和所述数据分组，设置所述OPC标准协议的数据位号参数；所述数据采集子单元用于：根据所述串口通讯和所述网络通讯的所述通讯配置与所述电力系统建立连接，再根据所述数据分组和所述数据位号参数得到所述电力系统的电力数据；所述数据转换单元用于：根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中对应的OPC数据；根据所述OPC数据得到所述电力系统的OPC数据源；所述服务单元用于：当接收到数据读取请求时，根据所述数据读取请求提供对应的所述OPC数据源的所述电力数据。2.根据权利要求1所述的电力系统数据采集系统，其特征在于，所述通讯端口配置子单元具体用于：获取所述串口通讯的串口号；根据所述电力系统的设备参数，得到所述串口通讯的波特率；根据所述电力系统的所述电力规约协议，得到所述串口通讯的校验方式；根据所述电力系统的数据通讯标准，得到所述串口通讯的数据位和停止位；根据所述串口号、所述波特率、所述校验方式、所述数据位和所述停止位，设置所述串口通讯的所述通讯配置。3.根据权利要求1所述的电力系统数据采集系统，其特征在于，所述通讯端口配置子单元具体还用于：根据所述电力系统的通讯方式，得到所述网络通讯的主机的IP地址和端口号；判断所述网络通讯是否需要备机；若是，则根据所述通讯方式，得到所述备机的IP地址，根据所述主机的IP地址、端口号和所述备机的IP地址，设置所述网络通讯的所述通讯配置；若否，则根据所述主机的IP地址和端口号，设置所述网络通讯的所述通讯配置。4.根据权利要求1所述的电力系统数据采集系统，其特征在于，所述采集数据配置子单元具体用于：根据所述通讯报文和所述OPC标准协议，得到所述电力规约协议的帧类别定义；根据所述帧类别定义的上行数据和所述电力系统的所述数据类型，得到所述数据分组；根据所述电力规约协议中所述数据分组中每个组别的定义标准，得到每个所述组别对应的位号的名称和描述并获取所述位号对应的地址序号和比例因子；根据所述地址序号和所述比例因子，设置所述OPC标准协议的所述数据位号参数。5.根据权利要求4所述的电力系统数据采集系统，其特征在于，所述根据所述帧类别定义的上行数据和所述电力系统的所述数据类型，得到所述数据分组，包括：根据所述上行数据和所述数据类型，得到所述上行数据中每个所述数据类型对应的帧；根据所述数据类型对应的帧，设置所述数据分组。6.根据权利要求4所述的电力系统数据采集系统，其特征在于，所述根据所述电力规约协议中所述数据分组中每个组别的定义标准，得到每个所述组别对应的位号名称和描述并获取所述位号对应的地址序号和比例因子，包括：根据所述定义标准，得到每个所述组别的参数对应的功能码；根据所述功能码，得到每个所述组别对应位号的名称和描述；根据所述功能码在所述定义标准中的排列顺序，得到每个所述位号的地址序号；根据所述定义标准中的所述功能码对应的系数作为所述比例因子。7.根据权利要求4所述的电力系统数据采集系统，其特征在于，所述数据转换单元具体用于：根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中的所述数据值；根据所述电力数据的采集时间，得到时间戳；根据所述电力数据的可信度，得到所述质量码信息；为所述数据值增加所述时间戳和所述质量码信息，得到所述电力数据在所述OPC标准协议中对应的所述OPC数据；根据所述OPC数据得到所述电力系统的OPC数据源。8.根据权利要求7所述的电力系统数据采集系统，其特征在于，所述根据所述OPC数据得到所述电力系统的OPC数据源，包括：将所述OPC数据按照所述数据分组进行分类并储存，得到所述电力数据的数据包并将所述数据包作为所述OPC数据源。9.根据权利要求7所述的电力系统数据采集系统，其特征在于，所述服务单元具体用于：根据所述数据读取请求，得到所述电力数据的时间范围；从所述OPC数据源中获取所述时间范围内的所述电力数据。10.一种电力系统数据采集方法，其特征在于，包括：根据电力系统设置串口通讯和网络通讯的通讯配置；根据所述电力系统的电力规约协议，得到所述电力规约协议的通讯报文；根据所述电力系统的数据类型和所述通讯报文，得到OPC标准协议的数据分组；根据所述通讯报文和所述数据分组，设置所述OPC标准协议的数据位号参数；根据所述串口通讯和所述网络通讯的所述通讯配置与所述电力系统建立连接，再根据所述数据分组和所述数据位号参数得到所述电力系统的电力数据；根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中对应的OPC数据；根据所述OPC数据得到所述电力系统的OPC数据源；当接收到数据读取请求时，根据所述数据读取请求提供对应的所述OPC数据源的所述电力数据。
说明书desc
技术领域本发明涉及电力通信技术领域，具体而言，涉及一种电力系统数据采集系统及方法。背景技术在电力行业中，存在很多相互独立的电力系统，每个电力系统通过与其相关的电力规约控制电力仪表和设备间的通讯，通常电力仪表和设备的数据需要汇集到实时数据库或其他数据采集系统软件中，再统一提供给对应的上层应用系统，实现电力系统数据的监控。在现有技术中，由于电力规约的标准种类繁多，导致上层应用系统与电力仪表及设备的数据通讯非常困难，只能通过电力规约转换器等硬件设备或电力监控软件等软件系统对接入电力规约转换器或电力监控软件系统的电力仪表和设备进行数据封装打包，统一转换为相对标准的国标电力规约标准，再对外通讯，实现电力系统数据的监控。但是，由于多套不同通讯规约类型的接口软件来支持电力系统数据的采集，对服务器硬件设备的要求也随之变大，进而出现实时数据库的服务器或其他数据采集系统的服务器因运行的接口软件过多而出现系统运行缓慢的情况。发明内容本发明解决的技术问题是如何改善上层应用系统与电力系统的通讯效果。本发明提供一种电力系统数据采集系统，所述电力系统数据采集系统包括数据采集配置单元、数据转换单元和服务单元，所述数据采集配置单元包括通讯端口配置子单元、采集数据配置子单元和数据采集子单元；所述通讯端口配置子单元用于：根据电力系统设置串口通讯和网络通讯的通讯配置；所述采集数据配置子单元用于：根据所述电力系统的电力规约协议，得到所述电力规约协议的通讯报文；根据所述电力系统的数据类型和所述通讯报文，得到OPC标准协议的数据分组；根据所述通讯报文和所述数据分组，设置所述OPC标准协议的数据位号参数；所述数据采集子单元用于：根据所述串口通讯和所述网络通讯的所述通讯配置与所述电力系统建立连接，再根据所述数据分组和所述数据位号参数得到所述电力系统的电力数据；所述数据转换单元用于：根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中对应的OPC数据；根据所述OPC数据得到所述电力系统的OPC数据源；所述服务单元用于：当接收到数据读取请求时，根据所述数据读取请求提供对应的所述OPC数据源的所述电力数据。可选地，所述通讯端口配置子单元具体用于：获取所述串口通讯的串口号；根据所述电力系统的设备参数，得到所述串口通讯的波特率；根据所述电力系统的所述电力规约协议，得到所述串口通讯的校验方式；根据所述电力系统的数据通讯标准，得到所述串口通讯的数据位和停止位；根据所述串口号、所述波特率、所述校验方式、所述数据位和所述停止位，设置所述串口通讯的所述通讯配置。可选地，所述通讯端口配置子单元具体还用于：根据所述电力系统的通讯方式，得到所述网络通讯的主机的IP地址和端口号；判断所述网络通讯是否需要备机；若是，则根据所述通讯方式，得到所述备机的IP地址，根据所述主机的IP地址、端口号和所述备机的IP地址，设置所述网络通讯的所述通讯配置；若否，则根据所述主机的IP地址和端口号，设置所述网络通讯的所述通讯配置。可选地，所述采集数据配置子单元具体用于：根据所述通讯报文和所述OPC标准协议，得到所述电力规约协议的帧类别定义；根据所述帧类别定义的上行数据和所述电力系统的所述数据类型，得到所述数据分组；根据所述电力规约协议中所述数据分组中每个组别的定义标准，得到每个所述组别对应的位号的名称和描述并获取所述位号对应的地址序号和比例因子；根据所述地址序号和所述比例因子，设置所述OPC标准协议的所述数据位号参数。可选地，所述根据所述帧类别定义的上行数据和所述电力系统的所述数据类型，得到所述数据分组，包括：根据所述上行数据和所述数据类型，得到所述上行数据中每个所述数据类型对应的帧；根据所述数据类型对应的帧，设置所述数据分组。可选地，所述根据所述电力规约协议中所述数据分组中每个组别的定义标准，得到每个所述组别对应的位号名称和描述并获取所述位号对应的地址序号和比例因子，包括：根据所述定义标准，得到每个所述组别的参数对应的功能码；根据所述功能码，得到每个所述组别对应位号的名称和描述；根据所述功能码在所述定义标准中的排列顺序，得到每个所述位号的地址序号；根据所述定义标准中的所述功能码对应的系数作为所述比例因子。可选地，所述数据转换单元具体用于：根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中的所述数据值；根据所述电力数据的采集时间，得到时间戳；根据所述电力数据的可信度，得到所述质量码信息；为所述数据值增加所述时间戳和所述质量码信息，得到所述电力数据在所述OPC标准协议中对应的所述OPC数据；根据所述OPC数据得到所述电力系统的OPC数据源。可选地，所述根据所述OPC数据得到所述电力系统的OPC数据源，包括：将所述OPC数据按照所述数据分组进行分类并储存，得到所述电力数据的数据包并将所述数据包作为所述OPC数据源。可选地，所述服务单元具体用于：根据所述数据读取请求，得到所述电力数据的时间范围；从所述OPC数据源中获取所述时间范围内的所述电力数据。本发明还提供一种电力系统数据采集方法，包括：根据电力系统设置串口通讯和网络通讯的通讯配置；根据所述电力系统的电力规约协议，得到所述电力规约协议的通讯报文；根据所述电力系统的数据类型和所述通讯报文，得到OPC标准协议的数据分组；根据所述通讯报文和所述数据分组，设置所述OPC标准协议的数据位号参数；根据所述串口通讯和所述网络通讯的所述通讯配置与所述电力系统建立连接，再根据所述数据分组和所述数据位号参数得到所述电力系统的电力数据；根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中对应的OPC数据；根据所述OPC数据得到所述电力系统的OPC数据源；当接收到数据读取请求时，根据所述数据读取请求提供对应的所述OPC数据源的所述电力数据。本发明的电力系统数据采集系统及方法，根据电力系统的电力规约协议，得到电力规约协议的通讯报文，再根据的电力系统的数据类型和通讯报文，得到OPC标准协议的数据分组；根据数据分组和数据位号参数得到电力系统的电力数据，并根据OPC标准协议的数据分组和数据位号参数，得到电力数据在OPC标准协议中对应的OPC数据；本发明根据电力系统的不同规约协议，设置通讯配置和获得通讯报文，然后转换为OPC标准协议的数据分组和参数，以适配不同的电力规约类型，不需要依赖硬件设备或额外的转换器来进行数据转换，减少多套不同通讯规约类型的接口软件，从而减轻服务器硬件设备的负担，避免出现系统运行缓慢的情况。在与电力系统建立连接后，根据通讯配置和数据分组，与电力系统建立连接并获取电力数据，将获取的电力数据转换为OPC标准协议的数据，进而可以根据数据读取请求提供对应的OPC数据源的电力数据，使电力系统的数据通讯更加灵活，能够有效地提供所需的电力数据。附图说明图1为本发明一实施例中电力系统数据采集系统的结构示意图；图2为本发明另一实施例中多路通讯配置界面的示意图；图3为本发明另一实施例中IP地址和端口号的设置界面的示意图；图4为本发明另一实施例中对于CDT规约的帧类别定义的示意图；图5为本发明另一实施例中对于CDT规约的定义标准的示意图；图6为本发明另一实施例中遥测数据分组配置界面的示意图；图7为本发明又一实施例中电力系统数据采集方法的流程示意图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整的描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。结合图1所示，本发明提供一种电力系统数据采集系统，所述电力系统数据采集系统包括数据采集配置单元、数据转换单元和服务单元，所述数据采集配置单元包括通讯端口配置子单元、采集数据配置子单元和数据采集子单元。具体地，数据采集配置单元、数据转换单元和服务单元依次连接，所述数据采集配置单元包括通讯端口配置子单元、采集数据配置子单元和数据采集子单元。所述通讯端口配置子单元用于：根据电力系统设置串口通讯和网络通讯的通讯配置。具体地，通讯端口配置子单元根据电力系统设置串口通讯和网络通讯的通讯配置，通讯端口配置设置与电力系统相匹配的通讯参数，以构建软件系统与电力系统之间的通讯链路，其设置对象分为串口和网络口两种不同通讯端口，由于不同的电力规约具有其特有的通讯特点，并且不同版本的同种电力规约也有不同的通讯特点，因此需要根据电力系统不同电力规约协议的特点进行针对性的配置。所述采集数据配置子单元用于：根据所述电力系统的电力规约协议，得到所述电力规约协议的通讯报文。具体地，根据电力规约协的定义，可以解析出通讯报文的结构、数据字段、校验方式等关键信息。根据所述电力系统的数据类型和所述通讯报文，得到OPC标准协议的数据分组。具体地，结合上述解析出的通讯报文的关键信息结合电力系统的数据类型，得到OPC标准协议要求的数据分组，在本发明的优选实施例中，数据分组为可以根据电力系统的数据类型分为遥信、遥测、遥脉等不同类别数据分组。其中，OPC标准协议为工业标准，OPC标准协议包括一整套接口、属性和方法的标准集，用于过程控制和制造业自动化系统。根据所述通讯报文和所述数据分组，设置所述OPC标准协议的数据位号参数。具体地，根据通讯报文的解析后的数据以及数据分组，设置符合OPC标准协议的数据位号参数，确保数据在OPC协议中能够被正确地识别和处理。所述数据采集子单元用于：根据所述串口通讯和所述网络通讯的所述通讯配置与所述电力系统建立连接，再根据所述数据分组和所述数据位号参数得到所述电力系统的电力数据。具体地，如果所述通讯配置包括了串口通讯，系统将根据串口的通讯配置来建立与电力系统的串口连接。对于网络通讯，使用通讯配置来建立网络连接，以便与电力系统进行通讯。根据数据分组和数据位号参数，系统使用上述信息向电力系统发送请求并解析返回的数据，以获取所需的电力数据。所述数据转换单元用于：根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中对应的OPC数据。具体地，将采集到的电力系统数据结合配置OPC标准协议的数据分组和数据位号参数，依据OPC协议标准进行实时转换并进行存储，得到电力数据在OPC标准协议中对应的OPC数据。根据所述OPC数据得到所述电力系统的OPC数据源。具体地，将OPC数据进行整合，形成OPC数据源，其中，OPC数据源包括实时数据源和历史数据源。所述服务单元用于：当接收到数据读取请求时，根据所述数据读取请求提供对应的所述OPC数据源的所述电力数据。具体地，当接收到数据读取请求时，根据数据读取请求提供对应的OPC数据源的电力数据，即从OPC数据源中获取相应的电力数据。在本发明的优选实施例中，服务单元为OPC服务，OPC服务依据OPC协议标准为实时数据库系统等第三方数据采集系统提供实时数据读取服务，并且在网络异常中断恢复后提供暂存历史数据读取服务。本发明的电力系统数据采集系统，根据电力系统的电力规约协议，得到电力规约协议的通讯报文，再根据的电力系统的数据类型和通讯报文，得到OPC标准协议的数据分组；根据数据分组和数据位号参数得到电力系统的电力数据，并根据OPC标准协议的数据分组和数据位号参数，得到电力数据在OPC标准协议中对应的OPC数据；本发明根据电力系统的不同规约协议，设置通讯配置和获得通讯报文，然后转换为OPC标准协议的数据分组和参数，以适配不同的电力规约类型，不需要依赖硬件设备或额外的转换器来进行数据转换，减少多套不同通讯规约类型的接口软件，从而减轻服务器硬件设备的负担，避免出现系统运行缓慢的情况。在与电力系统建立连接后，根据通讯配置和数据分组，与电力系统建立连接并获取电力数据，将获取的电力数据转换为OPC标准协议的数据，进而可以根据数据读取请求提供对应的OPC数据源的电力数据，使电力系统的数据通讯更加灵活，能够有效地提供所需的电力数据。本发明实施例中，所述通讯端口配置子单元具体用于：获取所述串口通讯的串口号；根据所述电力系统的设备参数，得到所述串口通讯的波特率；根据所述电力系统的所述电力规约协议，得到所述串口通讯的校验方式；根据所述电力系统的数据通讯标准，得到所述串口通讯的数据位和停止位；根据所述串口号、所述波特率、所述校验方式、所述数据位和所述停止位，设置所述串口通讯的所述通讯配置。在本实施例中，通过系统或硬件配置，可以获得用于通信的串口号。通常串口号是一个整数，例如1、2或3，以表示不同的串口。通过电力系统的设备参数，可以获得串口通讯的波特率。波特率表示每秒传输的位数，通常以每秒位数表示。根据所述电力系统的电力规约协议，您可以获得串口通讯的校验方式。通常校验方式为奇偶校验、无校验和偶校验等。根据电力系统的数据通讯标准，获得串口通讯的数据位和停止位。通常数据位可以是5、6、7或8，停止位可以为1或2。当获取了串口号、波特率、校验方式、数据位和停止位时，可以使用上述信息来设置串口通讯的通讯配置。这些参数将用于后续与电力系统建立串口通讯连接。本发明的电力系统数据采集系统，通过获取串口通讯所需的参数并设置通讯配置，以便与电力系统进行正确的串口通讯。本发明实施例中，所述通讯端口配置子单元具体还用于：根据所述电力系统的通讯方式，得到所述网络通讯的主机的IP地址和端口号；判断所述网络通讯是否需要备机；若是，则根据所述通讯方式，得到所述备机的IP地址，根据所述主机的IP地址、端口号和所述备机的IP地址，设置所述网络通讯的所述通讯配置；若否，则根据所述主机的IP地址和端口号，设置所述网络通讯的所述通讯配置。在本实施例中，根据电力系统的通讯方式，获取网络通讯的主机IP地址和端口号。主机IP地址和端口号是在网络通讯中用于标识通讯目标的重要参数。判断网络通讯是否需要备机，如果需要备机，则根据通讯方式获取备机的IP地址。备机通常是用于冗余和故障切换的设备，以确保通讯的可靠性和连续性。使用获取的主机IP地址、端口号和备机IP地址，来设置网络通讯的通讯配置，与串口通讯类似，网络通讯的配置需要包括主机IP地址、端口号等信息，以便建立与目标设备的网络连接。在本发明实施例中，本发明软件系统支持不同电力规约的多个电力系统的多路通讯，即不但支持采用CDT、IEC104等不同电力规约进行数据通讯的多个电力系统数据采集和通讯，而且同时支持采用相同电力规约进行数据通讯的多个电力系统数据采集和通讯，在软件管理上以不同的名称和ID地址进行区分和统一管理，名称和ID地址可根据需求自由命名，同时形成以名称为区别的OPC服务名。结合图2所示的多路通讯配置界面示意图，显示同时支持两个采用IEC104电力规约的电力系统、1个采用IEC101电力规约的电力系统和1个采用CDT电力规约的电力系统；两个采用IEC104电力规约的电力系统设置不同的名称、从站公共地址和IP地址等基本属性，以进行区分；其中，结合图3所示，采用IEC104电力规约的电力系统的主站基本属性配置界面示意图中进行IP地址和端口号的设置；本发明的电力系统数据采集系统，通讯端口配置子单元可以根据所述电力系统的通讯方式，获取并设置网络通讯所需的通讯配置，以确保系统能够与目标设备进行正确的网络通讯。本发明实施例中，所述采集数据配置子单元具体用于：根据所述通讯报文和所述OPC标准协议，得到所述电力规约协议的帧类别定义；根据所述帧类别定义的上行数据和所述电力系统的所述数据类型，得到所述数据分组；根据所述电力规约协议中所述数据分组中每个组别的定义标准，得到每个所述组别对应的位号的名称和描述并获取所述位号对应的地址序号和比例因子；根据所述地址序号和所述比例因子，设置所述OPC标准协议的所述数据位号参数。在本实施例中，根据所述通讯报文和OPC标准协议，获取电力规约协议中的帧类别定义。在本发明的优选实施例中，CDT规约进行配置的帧类别定义为图4所示，根据OPC协议标准和CDT规约设定的通讯报文控制字帧类别定义。根据帧类别定义的上行数据和所述电力系统的数据类型设置了遥测、总加遥测、遥信和电能脉冲四个数据分组，不同组别分别对应图4的上行数据即上行的重要遥测、次要遥测和一般遥测C帧、遥信状态、电能脉冲数值进行帧类别解析，为下一步的数据采集进行通讯准备。根据电力规约协议中数据分组中每个组别的定义标准，得到每个组别对应的位号的名称和描述并获取位号对应的地址序号和比例因子，在本发明的优选实施例中，结合图5所示，针对重要遥测，根据图5的定义标准中的功能码以及遥测信息的每个信息字传送2路遥测量，每个遥测量包含2字节，先送高字节，后送低字节等CDT规约中的设定。本发明的电力系统数据采集系统，采集数据配置子单元根据电力规约协议中的定义和电力系统数据类型，设置适当的数据分组和数据位号参数，以确保在OPC协议中正确表示和传输电力系统的数据。本发明实施例中，所述根据所述帧类别定义的上行数据和所述电力系统的所述数据类型，得到所述数据分组，包括：根据所述上行数据和所述数据类型，得到所述上行数据中每个所述数据类型对应的帧；根据所述数据类型对应的帧，设置所述数据分组。在本实施例中，首先根据数据类型，将上行数据进行分类，得到每个数据类型对应的帧。然后根据每个数据类型对应的帧，进行数据分组设置。在本发明的优选实施例中，根据帧类别定义的上行数据和所述电力系统的数据类型设置了遥测、总加遥测、遥信和电能脉冲四个数据分组，不同组别分别对应图4的上行数据即上行的重要遥测、次要遥测和一般遥测C帧、遥信状态、电能脉冲数值进行帧类别解析，从而实现设置数据分组。本发明的电力系统数据采集系统，通过对数据类型和帧类别的定义，可以实现对数据进行有效的分类和分组，从而更好地满足电力系统对数据传输的需求。本发明实施例中，所述根据所述电力规约协议中所述数据分组中每个组别的定义标准，得到每个所述组别对应的位号名称和描述并获取所述位号对应的地址序号和比例因子，包括：根据所述定义标准，得到每个所述组别的参数对应的功能码；根据所述功能码，得到每个所述组别对应位号的名称和描述；根据所述功能码在所述定义标准中的排列顺序，得到每个所述位号的地址序号；根据所述定义标准中的所述功能码对应的系数作为所述比例因子。在本实施例中，根据定义标准，得到每个组别的参数对应的功能码，在本发明的优选实施例中，以CDT规约为例，结合图5所示的定义标准中，即可得到每个组别对应的功能码，并在每个分组中进行位号设置时，按照统一管理要求设置好位号名称和描述，结合图6所示，例如在遥测数据分组中进行位号设置时，按照统一管理要求设置对应的位号名称和位号描述，然后依据图5的定义标准，按顺序对照填写地址序号以及对应的比例因子，即比对图5中的系数，即可由内嵌的重要遥测规约报文解析程序在软件系统运行时实现相关数据的采集，再通过如图6所示的遥测数据分组配置界面，配置地址序号和比例因子，以此实现OPC标准协议的数据位号参数的设置。其中，在根据CDT规约按照数据分组分别内嵌了重要遥测、次要遥测和一般遥测、遥信和电能脉冲数值的规约报文解析程序，仅通过设置简单的地址序号即可实现相关数据的采集。本发明的电力系统数据采集系统，直接利用内嵌的解析程序进行数据采集和处理，无需额外开发复杂的数据解析算法。简化了数据采集过程，使得系统操作更加方便快捷。本发明实施例中，所述数据转换单元具体用于：根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中的所述数据值；根据所述电力数据的采集时间，得到时间戳；根据所述电力数据的可信度，得到所述质量码信息；为所述数据值增加所述时间戳和所述质量码信息，得到所述电力数据在所述OPC标准协议中对应的所述OPC数据；根据所述OPC数据得到所述电力系统的OPC数据源。在本实施例中，根据已经获取的数据分组和数据位号参数，将电力数据转换为OPC标准协议中相应的数据值，确保数据的格式和类型符合OPC标准的要求；根据电力数据的采集时间，得到时间戳，电力数据的采集时间可以作为时间戳与数据值关联，表明数据采集的时间信息，有助于记录数据的时序特性和追溯数据的采集时间点；根据电力数据的可信度，得到质量码信息，其中，根据OPC协议使用一个16bit长度的质量码来标识采样数据是否可靠，比如OPC标准规定当质量码为192时表示数据正常，当质量码为0时表示数据无效，实际上从0–65535每个质量码的值都对应着数据的不同状态。本发明的电力系统数据采集系统，数据转换单元依据OPC标准协议，结合采集数据配置设置的位号名称和描述信息，实时将采集到的数据值附加时间戳和质量码信息，从而形成OPC数据源。本发明实施例中，所述根据所述OPC数据得到所述电力系统的OPC数据源，包括：将所述OPC数据按照所述数据分组进行分类并储存，得到所述电力数据的数据包并将所述数据包作为所述OPC数据源。在本实施例中，数据转换单元依据OPC标准协议，结合采集数据配置设置的位号名称和描述，实时将采集到的数据值附加时间戳和质量码信息，按照数据分组进行分组组织和存储，作为完整的数据包对外提供，从而形成OPC实时及历史数据源，作为OPC数据源。本发明的电力系统数据采集系统，通过对数据值进行附加时间戳和质量码，从而建立OPC数据源，方便服务单元利用OPC数据源进行数据存储。本发明实施例中，所述服务单元具体用于：根据所述数据读取请求，得到所述电力数据的时间范围；从所述OPC数据源中获取所述时间范围内的所述电力数据。在本实施例中，OPC服务部分模块通过注册不同的电力系统数据采集OPC服务名称，运行相应的OPC服务，实时侦测外部数据读取请求，根据请求按照OPC协议提供实时数据或历史数据。本发明的电力系统数据采集系统，根据解析得到的时间范围参数，在OPC数据源中查询对应时间范围内的电力数据，然后将查询结果返回给数据读取请求的发起者。结合图7所示，本发明还提供一种电力系统数据采集方法，包括：S1：根据电力系统设置串口通讯和网络通讯的通讯配置；S2：根据所述电力系统的电力规约协议，得到所述电力规约协议的通讯报文；S3：根据所述电力系统的数据类型和所述通讯报文，得到OPC标准协议的数据分组；S4：根据所述通讯报文和所述数据分组，设置所述OPC标准协议的数据位号参数；S5：根据所述串口通讯和所述网络通讯的所述通讯配置与所述电力系统建立连接，再根据所述数据分组和所述数据位号参数得到所述电力系统的电力数据；S6：根据所述OPC标准协议的所述数据分组和所述数据位号参数，得到所述电力数据在所述OPC标准协议中对应的OPC数据；S7：根据所述OPC数据得到所述电力系统的OPC数据源；S8：当接收到数据读取请求时，根据所述数据读取请求提供对应的所述OPC数据源的所述电力数据。本发明的电力系统数据采集方法，根据电力系统的电力规约协议，得到电力规约协议的通讯报文，再根据的电力系统的数据类型和通讯报文，得到OPC标准协议的数据分组；根据数据分组和数据位号参数得到电力系统的电力数据，并根据OPC标准协议的数据分组和数据位号参数，得到电力数据在OPC标准协议中对应的OPC数据；本发明根据电力系统的不同规约协议，设置通讯配置和获得通讯报文，然后转换为OPC标准协议的数据分组和参数，以适配不同的电力规约类型，不需要依赖硬件设备或额外的转换器来进行数据转换，减少多套不同通讯规约类型的接口软件，从而减轻服务器硬件设备的负担，避免出现系统运行缓慢的情况。在与电力系统建立连接后，根据通讯配置和数据分组，与电力系统建立连接并获取电力数据，将获取的电力数据转换为OPC标准协议的数据，进而可以根据数据读取请求提供对应的OPC数据源的电力数据，使电力系统的数据通讯更加灵活，能够有效地提供所需的电力数据。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的程序可存储于一非易失性计算机可读取存储介质中，该程序在执行时，可包括如上述各方法的实施例的流程。其中，本发明所提供的各实施例中所使用的对存储器、存储、数据库或其它介质的任何引用，均可包括非易失性和/或易失性存储器。非易失性存储器可包括只读存储器、可编程ROM、电可编程ROM、电可擦除可编程ROM或闪存。易失性存储器可包括随机存取存储器或者外部高速缓冲存储器。作为说明而非局限，RAM以多种形式可得，诸如静态RAM、动态RAM、同步DRAM、双数据率SDRAM、增强型SDRAM、同步链路 DRAM、存储器总线直接RAM、直接存储器总线动态RAM、以及存储器总线动态RAM等。需要说明的是，在本文中，诸如“第一”和“第二”等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。以上所述仅是本发明的具体实施方式，使本领域技术人员能够理解或实现本发明。对这些实施例的多种修改对本领域的技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所示的这些实施例，而是要符合与本文所申请的原理和新颖特点相一致的最宽的范围。
