标题title
一种风力发电功率预测方法
摘要abst
本发明公开了一种风力发电功率预测方法，包括：S1、采集风电发电厂的历史风电数据和气象预测数据；S2、对采集数据进行CEEMD处理，获得IMF分量；S3、基于IMF分量，利用PSO算法处理确定LSTM模型的最优超参数；S4、基于最优超参数构建LSTM模型，并利用IMF分量对其训练，获得训练好的风电功率预测模型；S5、利用风电功率预测模型对历史风电功率数据和气象数据进行处理，获得功率预测结果。本发明在对风电功率预测时，通过异常值处理、CEEMD算法对历史风电数据进行预处理，用PSO寻找LSTM最优超参数，LSTM模型可结合数据时间相关性对长序列数据进行预测，提高了短期风电功率预测的精度。
权利要求书clms
1.一种风力发电功率预测方法，其特征在于，包括以下步骤：S1、采集风电发电厂的历史风电数据和气象预测数据；S2、对历史风电数据和气象预测数据进行CEEMD处理，获得对应的IMF分量；S3、基于IMF分量，利用PSO算法处理确定LSTM模型的最优超参数；S4、基于确定的最优超参数构建结合注意力机制的LSTM模型，并利用IMF分量对其训练，获得训练好的风电功率预测模型；S5、利用风电功率预测模型对历史风电功率数据和气象数据进行处理，获得功率预测结果。2.根据权利要求1所述的风力发电功率预测方法，其特征在于，所述步骤S1中，历史风电数据为电机实际功率，气象预测数据为电机实际功率对应不同高度下的空气湿度、风速和风向数据，且采集数据的时间分辨率为15分钟，数据时间尺度不少于10天。3.根据权利要求2所述的风力发电功率预测方法，其特征在于，所述步骤S2具体为：S21、使用CEEMD将正态分布的正负成对的白噪声添加至各采集数据中；S22、对添加白噪声的采集数据进行EMD分解，将其分解为若干IMF分量；S23、将各采集数据的IMF分量进行集总平均处理，获得忽略白噪声的对应IMF分量。4.根据权利要求3所述的风力发电功率预测方法，其特征在于，所述步骤S21中，添加白噪声的采集数据为：式中，分别为添加了正、负白噪声的采集数据，xi为采集数据，为符合正态分布的正、负白噪声；所述步骤S23中，忽略白噪声的对应IMF分量X为：式中，分别为添加了正、负白噪声后的IMF分量，n为IMF分量总数。5.根据权利要求3所述的风力发电功率预测方法，其特征在于，所述步骤S3具体为：S31、将IMF分量划分为训练集、测试集和验证集；S32、利用训练集训练PSO算法，获得对应最优解；S32、根据PSO算法的最优解，确定LSTM模型中的最优超参数；其中，最优超参数包括批处理大小和隐藏层单元数量。6.根据权利要求5中的风力发电功率预测方法，其特征在于，所述步骤S32中，在训练所述PSO算法时，速度更新的公式为：式中，为粒子i在第k+1次迭代中第d维的速度向量，ω为惯性权重，c1为个体学习因子，/＞为粒子i在第k次迭代中第d维的历史最优位置，/＞为粒子i在第k次迭代中第d维的位置向量，c2为群体学习因子，r1、r2为区间内的随机数，使搜索具有随机性，为粒子群在第k次迭代中第d维的历史最优位置，i为粒子序号，D为粒子维度，d为粒子维度序号，k为迭代次数；位置更新的公式为：惯性权重更新的公式为：式中，ωmax为最大惯性权重；ωmin为最小惯性权重；iter为当前迭代次数；itermax为最大迭代次数；学习因子更新的公式为：7.根据权利要求5所述的风力发电功率预测方法，其特征在于，所述步骤S4中，构建的结合注意力机制的LSTM模型包括依次连接的LSTM层和注意力层，所述LSTM层包括记忆元，每个记忆元包括输入门、遗忘门和输出门。8.根据权利要求7所述的风力发电功率预测方法，其特征在于，在所述LSTM层中，输入门It的表达式为：It＝σ式中，σ为带有ReLU激活函数的全连接层，Xt为输入数据，Wxi为输入门中输入数据的权重参数，Ht-1为前一时间步的隐状态，Whi为输入门中隐状态的权重参数，bi为输入门偏置参数；遗忘门Ft的表达式为：Ft＝σ式中，Wxf为遗忘门中输入数据的权重参数，Whf为遗忘门中隐状态的权重参数，bf为遗忘门偏置参数；输出门Ot的表达式为：Ot＝σ式中，Wxo为输出门中输入数据的权重参数，Who为输入门中隐状态的权重参数，bo为输出门偏置参数；候选记忆元的运行表达式为：式中，Wxc为候选记忆元中输入数据的权重参数，Whc为后续记忆元中隐状态的权重参数，bc为后续记忆元偏置参数；记忆元Ct的运行表达式为：隐状态Ht的表达式为：Ht＝Ot⊙tanh式中，⊙为Hadamard积，tanh为tanh非线性激活函数。9.根据权利要求7所述的风力发电功率预测方法，其特征在于，所述注意力层采用非参数注意力汇聚，其表达式为：式中，xi为第i项历史风电数据或气象数据，xm为输入到LSTM层中的矩阵并从Xt中获得，ym为xm对应的风电功率并从Ot中获得，Dt为LSTM模型的最终输出结果，ki为第i项元素为ωi其余元素为零的列矩阵，Ht为t时间步的隐状态，ωi为记忆元运行各时间步隐状态分配对应权重。10.根据权利要求1所述的风力发电功率预测方法，其特征在于，所述步骤S4中，在训练结合注意力机制的LSTM模型时，设置早停函数和DropOut层，损失函数为预测值与真实值之差的平方。
说明书desc
技术领域本发明属于风电功率预测技术领域，具体涉及一种风力发电功率预测方法。背景技术为响应国家新能源建设、发展新型清洁能源的需要，风电作为一种绿色能源，在新能源开发建设中起着重要作用。随着大型风力发电组并入电网，风力发电的间歇性、随机性和波动性等特性导致的安全问题日益凸显。为了实现安全并网、保证国家电网的稳定运行，提升风电功率的预测精度成为风力发电中的一个重要课题。此外，预测精度的提升还可以降低运行成本，优化调度，便于安排机组的维护和检修，从而实现调度的经济合理性。短期风电预测作为风电并网安全稳定运行的重要组成部分，优化预测模型，提高预测精度尤为重要。现有风电功率预测技术主要分为物理方法、统计方法、人工智能方法。物理方法使用物理因素、气象数据来实现超短期功率预测。该方法不需要大量历史数据，可以在一定程度上避免数据不足、数据缺失带来的影响，但是模型复杂，计算难度大且对初始信息引起的初始误差敏感等。如在模型建立过程中会涉及到地形、地旋风等难以被描述的物理现象，导致预测误差较大。统计方法统计模型常用多个样本特征作为输入，通过挖掘数据的内在数学和物理特性来实现预测。然而，传统的统计模型是以数据具有线性相关性的假设为前提进行试验的，这显然与大部分预测研究工作的实际情况相悖，因此很难保证其预测性能。人工智能方法则对初始误差信息敏感度低，具有良好的非线性数据拟合能力以及参数学习能力，故使用人工智能方法进行风电功率预测。人工神经网络、自回归移动平均法、卡尔曼滤波法、支持向量机等利用历史风电数据的统计方法，不适合像风能发电功率这样的非线性较强数据的预测。此外，由于风电功率的预测与当前和历史数据相关，而传统的机器学习模型，诸如支持向量机、BP神经网络等统计方法难以处理长时间序列的数据，并且存在梯度爆炸、梯度消失等问题，所以其预测的效果尚有待提高。现代循环网络算法，如循环神经网络可以有效保存历史信息，在预测方面应用广泛。但若时间步长较长，RNN可能会发生梯度消失问题；长短期记忆网络是基于RNN的改进，通过遗忘门单元可以有效避免梯度消失问题，可以处理时序数据中的长期数据以来问题，适用于处理时间差较长的序列。但在时间序列输入过长的情况下，LSTM网络存在容易丢失序列的信息，而且传统的长短期记忆网络局限于数据进行前向预测而忽略了数据本身的反向时间相关性，其时间相关性不能够被充分地挖掘，从而使模型的准确率降低。组合模型现在备受推崇，将在预测中表现较好的模型组合起来以提高风功率预测精度，以下为几种常见的符合模型。基于EMD-SA-SVR的超短期风电功率预测模型，采用经验模态分解对数据进行预处理，并用支持向量回归进行预测，自适应数据驱动性使得经验模态分解在非平稳信号的处理中具有优秀表现，但分解后得到的IMF分量存在模态混叠，使预测增加了难度。利用copula函数进行特征提取，将提取的特征作为LSTM的输入，建立单一的光伏功率和风电功率预测模型，但是模型预测精度较低。LSTM-Attention网络的短期风电功率预测方法，利用LSTM进行特征提取，同时引入注意力机制分析输入和输出的相关性，得到最终的预测结果，但模型的预测精度有待进一步提升。基于VMD-Conv LSTM的风电功率预测模型，通过叠加各分量的预测值得到最终的预测结果，然而并未对风电功率的预测误差进行进一步修正。发明内容针对现有技术中的上述不足，本发明提供的一种风力发电功率预测方法解决了现有风力发电功率预测过程算法时间长、准确度低的问题。为了达到上述发明目的，本发明采用的技术方案为：一种风力发电功率预测方法，包括以下步骤：S1、采集风电发电厂的历史风电数据和气象预测数据；S2、对历史风电数据和气象预测数据进行CEEMD处理，获得对应的IMF分量；S3、基于IMF分量，利用PSO算法处理确定LSTM模型的最优超参数；S4、基于确定的最优超参数构建结合注意力机制的LSTM模型，并利用IMF分量对其训练，获得训练好的风电功率预测模型；S5、利用风电功率预测模型对历史风电功率数据和气象数据进行处理，获得功率预测结果。进一步地，所述步骤S1中，历史风电数据为电机实际功率，气象预测数据为电机实际功率对应不同高度下的空气湿度、风速和风向数据，且采集数据的时间分辨率为15分钟，数据时间尺度不少于10天。进一步地，所述步骤S2具体为：S21、使用CEEMD将正态分布的正负成对的白噪声添加至各采集数据中；S22、对添加白噪声的采集数据进行EMD分解，将其分解为若干IMF分量；S23、将各采集数据的IMF分量进行集总平均处理，获得忽略白噪声的对应IMF分量。进一步地，所述步骤S21中，添加白噪声的采集数据为：式中，分别为添加了正、负白噪声的采集数据，xi为采集数据，为符合正态分布的正、负白噪声；所述步骤S23中，忽略白噪声的对应IMF分量X为：式中，分别为添加了正、负白噪声后的IMF分量，n为IMF分量总数。进一步地，所述步骤S3具体为：S31、将IMF分量划分为训练集、测试集和验证集；S32、利用训练集训练PSO算法，获得对应最优解；S32、根据PSO算法的最优解，确定LSTM模型中的最优超参数；其中，最优超参数包括批处理大小和隐藏层单元数量。进一步地，所述步骤S32中，在训练所述PSO算法时，速度更新的公式为：式中，为粒子i在第k+1次迭代中第d维的速度向量，ω为惯性权重，c1为个体学习因子，/＞为粒子i在第k次迭代中第d维的历史最优位置，/＞为粒子i在第k次迭代中第d维的位置向量，c2为群体学习因子，t1、r2为区间内的随机数，使搜索具有随机性，/＞为粒子群在第k次迭代中第d维的历史最优位置，i为粒子序号，D为粒子维度，d为粒子维度序号，k为迭代次数；位置更新的公式为：惯性权重更新的公式为：式中，ωmax为最大惯性权重；ωmin为最小惯性权重；iter为当前迭代次数；itermax为最大迭代次数；学习因子更新的公式为：进一步地，所述步骤S4中，构建的结合注意力机制的LSTM模型包括依次连接的LSTM层和注意力层，所述LSTM层包括记忆元，每个记忆元包括输入门、遗忘门和输出门。进一步地，在所述LSTM层中，输入门It的表达式为：It＝σ式中，σ为带有ReLU激活函数的全连接层，Xt为输入数据，Wxi为输入门中输入数据的权重参数，Ht-1为前一时间步的隐状态，Whi为输入门中隐状态的权重参数，bi为输入门偏置参数；遗忘门Ft的表达式为：Ft＝σ式中，Wxf为遗忘门中输入数据的权重参数，Whf为遗忘门中隐状态的权重参数，bf为遗忘门偏置参数；输出门Ot的表达式为：Ot＝σ式中，Wxo为输出门中输入数据的权重参数，Who为输入门中隐状态的权重参数，bo为输出门偏置参数；候选记忆元的运行表达式为：式中，Wxc为候选记忆元中输入数据的权重参数，Whc为后续记忆元中隐状态的权重参数，bc为后续记忆元偏置参数；记忆元Ct的运行表达式为：隐状态Ht的表达式为：Ht＝Ot⊙tanh式中，⊙为Hadamard积，tanh为tanh非线性激活函数。进一步地，所述注意力层采用非参数注意力汇聚，其表达式为：式中，xi为第i项历史风电数据或气象数据，xm为输入到LSTM层中的矩阵并从Xt中获得，ym为xm对应的风电功率并从Ot中获得，Dt为LSTM模型的最终输出结果，ki为第i项元素为ωi其余元素为零的列矩阵，Ht为t时间步的隐状态，ωi为记忆元运行各时间步隐状态分配对应权重。进一步地，所述步骤S4中，在训练结合注意力机制的LSTM模型时，设置早停函数和DropOut层，损失函数为预测值与真实值之差的平方。本发明的有益效果为：本发明提出一种基于注意力机制的LSTM模型，对风电功率预测，通过异常值处理、CEEMD算法对历史风电数据进行预处理，用PSO寻找LSTM最优超参数，LSTM模型可结合数据时间相关性对长序列数据进行预测，提高了短期风电功率预测的精度。本发明在模型训练过程中，通过设置早停函数、建立验证集、添加DropOut层等方式，防止了模型产生过拟合、梯度爆炸或梯度消失等现象的出现，减少了模型的泛化误差。附图说明图1为本发明提供的风力发电功率预测方法流程图。具体实施方式下面对本发明的具体实施方式进行描述，以便于本技术领域的技术人员理解本发明，但应该清楚，本发明不限于具体实施方式的范围，对本技术领域的普通技术人员来讲，只要各种变化在所附的权利要求限定和确定的本发明的精神和范围内，这些变化是显而易见的，一切利用本发明构思的发明创造均在保护之列。本发明实施例提供了一种风力发电功率预测方法，如图1所示，包括以下步骤：S1、采集风电发电厂的历史风电数据和气象预测数据；S2、对历史风电数据和气象预测数据进行CEEMD处理，获得对应的IMF分量；S3、基于IMF分量，利用PSO算法处理确定LSTM模型的最优超参数；S4、基于确定的最优超参数构建结合注意力机制的LSTM模型，并利用IMF分量对其训练，获得训练好的风电功率预测模型；S5、利用风电功率预测模型对历史风电功率数据和气象数据进行处理，获得功率预测结果。在本发明实施例的步骤S1中，历史风电数据为电机实际功率，气象预测数据为电机实际功率对应不同高度下的空气湿度、风速和风向数据；其中，气象预测数据具体为10米、30米、50米、70米以及轮毂高下的空气湿度、风速和风向数据；在本实施例中，采集数据的时间分辨率为15分钟，数据时间尺度不少于10天，该时间分辨率和时间尺度符合现在绝大多数风力发电厂的数据采集情况，后续可以较为方便的与风电厂进行数据对应，将获得数据进行模型的训练、测试及验证。在本实施例中，风电数据和气象数据的大小有明确的物理意义，且不同地区不同时间下数据大小有明显差别，不可进行归一化操作，因此，在进行后续数据处理与模型训练之前，需要对其进行异常值补全；由于时间分辨率为15分钟，除极端情况下风电数据和气象数据在15分钟内不会发生剧烈变化，所以对缺失值采取平均值填充的方法进行处理，即在缺失处填充前一时间和后一时间的相应数据的平均值，若前一或后一时间的相应数据不存在，则填充与其相邻时间的相应数据的相同值，公式为：式中，Xt为某一时刻的风电数据或气象数据，Xt-1为前一时刻的风电数据或气象数据，Xt+1为后一时刻的风电数据或气象数据。在本发明实施例的步骤S2中利用信号分解思想，即通过信号分解可以更好的解释信号的组成以及为信号处理提供题录，利用CEEMD进行数据分解更好的解释、寻找各数据与最终预测结果的关系，首先利用EMD算法将非平稳信号逐级分解为若干个IMF分量和一个残余量，之后对IMD分量进行Hilbert变换得到输入数据在时间尺度上的分布规律。在风电功率预测中，模型的输入量没有明确的行业规定，各个风电厂收集数据不同，风力发电机型号不同，导致输入数据复杂，且输入数据可能会出现耦合等情况，无法完成对数据预先分析和研究，通过EMD处理则可直接将数据自动拆成多个IMD分量之和，更好的体现出数据特征，还可以解决小波分析过程中小波分析的基函数缺乏适应性的问题。但风电数据和气象数据不确定程度大、不稳定、易受影响，此时EMD分解后可能出现模态混叠现象，即一个单独的IMF分量中含有不同的时间尺度而相同的时间尺度又会出现在不同的IMF分量中，导致假错的时频分布，使IMF失去物理意义；基于此，本实施例使用CEEMD将正态分布的、正负成对的白噪声加到原始数据，并将得到的IMF分量做集成平均处理得到可忽略白噪声的最终结果。该方法可抑制模态混叠，与常规的EEMD方法相比，可以克服EEMD重构误差大、分解完备性差的问题，并且有集总平均次数由百量级减少到几十量级和重建后数据噪声明显减小的优点。基于此，本发明实施例的步骤S2具体为：S21、使用CEEMD将正态分布的正负成对的白噪声添加至各采集数据中；S22、对添加白噪声的采集数据进行EMD分解，将其分解为若干IMF分量；S23、将各采集数据的IMF分量进行集总平均处理，获得忽略白噪声的对应IMF分量。在本实施例步骤S21中，添加白噪声的采集数据为：式中，分别为添加了正、负白噪声的采集数据，xi为采集数据，为符合正态分布的正、负白噪声；在本实施例步骤S22中，在进行EMD分解时，任何信号都可以拆分成若干个内涵模态分量之和。内涵模态分量即IMF分量，其满足以下两个条件：在整个数据段内，极值点的个数和过零点的个数必须相等或相差最多不能超过一个；在任意时刻，由局部极大值点形成的上包络线和由局部极小值点形成的下包络线的平均值为零，即上、下包络线相对于时间轴局部对称。在本实施例中，步骤S22中进行EMD分解的过程具体为：1.寻找数据y全部极值点，通过三次样条曲线拟合原始信号的波动包络，将局部极大值点连成上包络线，将局部极小值点连成下包络线；2.计算此时上下包络线均值u1，将数据减去均值得到新的数据序列m1，即：m1＝y-u1；3.判断m1是否符合IMF条件，若不符合则重复进行上面两步直至满足IMF条件；4.从m1中分离出第一个IMF分量c1，m1的残差数据为：r1＝y-m15.将r1作为输入，重复进行上面四步，直至残差数据为单调函数，这个过程中将获得IMF分量cj，其中h＝1,2,…,n。在本实施例步骤S23中，忽略白噪声的对应IMF分量X为：式中，分别为添加了正、负白噪声后的IMF分量，n为IMF分量总数。在本发明实施例中，在进行后续模型训练之前，将前面获得的IMF分量数据集按6:2:2的比例划分为训练集、测试集、验证集，训练集数据用于训练模型，测试集数据用于评估训练模型的预测精度，验证集数据用于评估模型的泛化能力，以防模型产生过拟合，最终导致模型不能进行实际应用。在本发明实施例的步骤S3中，由于进行风电功率预测的输入数据种类多、数量庞大，大量的数据在为预测风电功率预测提供了充足的信息的同时无法改变风电功率预测误差常大于10％的事实，导致对预测精度的不断逼近会使得模型出现严重的过拟合现象，甚至出现梯度爆炸或梯度消失，这使得预测风电功率的模型要进行大量的调试。在模型调试过程，合理的模型超参数可以大幅减少调试速度缩短调试时间，而且使调试效果更加明显方便调试者进行调试。对此本实施例中利用PSO算法寻求LSTM模型的最优解超参数，为后续进行调试LSTM模型防止过拟合或出现其他异常状况做铺垫。LSTM算法中的批处理大小、神经网络隐藏层单元数量对模型的输出结果、迭代时间、调试效果有较大影响，故本实施例选择这两个参数作为优化对象并构建相应的粒子群。本实施例中构建的PSO算法主要由速度更新、位置更新、权重因子和学习因子更新组成。速度更新控制粒子的迭代移动距离合方向，位置更新控制PSO模型输出结果，权重因子和学习因子帮助PSO算法更快、更精准找到全局最优位置，PSO算法的目的是找到全局最优位置。基于此，本实施例的所述步骤S3具体为：S31、将IMF分量划分为训练集、测试集和验证集；S32、利用训练集训练PSO算法，获得对应最优解；S32、根据PSO算法的最优解，确定LSTM模型中的最优超参数；其中，最优超参数包括批处理大小和隐藏层单元数量。在本实施例中，将IMF分量划分为不同的数据集以防止算法训练过程中的过拟合；本实施例中PSO算法训练的参数是LSTM的批处理大小和隐藏层单元数量，在训练是，将批处理大小和隐藏层单元数量作为粒子群。在LSTM算法预测结果好、耗时短的情况下，此时PSO算法输出的粒子群所在位置作为输出。其中，批处理太大会占用过多计算机内存，减慢算法收敛速度，最终导致算法不能正常运行得不到最终结果；批处理太小会导致计算机内存利用率低，算法迭代次数增加，同样会减慢算法收敛速度，此外还会出现小批量数据无法代表整体数据的特征，导致算法收敛方向是错误的，最终会导致错误的输出结果。隐藏层单元越多算法的复杂度就越高，越容易出现过拟合的现象，同时导致算法运行速度减慢，我们目标是尽可能使用较少的隐藏层单元，同时可以得到较好的预测结果。在训练过程中，PSO算法一开始初始化一对m、n，之后根据LSTM算法运行的准确度和运行时间进行m、n优劣的判断，因此批处理大小和隐藏层单元数量由PSO算法输出的m、n数字大小决定。在本实施例步骤S32中，在训练所述PSO算法时，速度更新的公式为：式中，为粒子i在第k+1次迭代中第d维的速度向量，ω为惯性权重，c1为个体学习因子，/＞为粒子i在第k次迭代中第d维的历史最优位置，/＞为粒子i在第k次迭代中第d维的位置向量，c2为群体学习因子，r1、r2为区间内的随机数，使搜索具有随机性，/＞为粒子群在第k次迭代中第d维的历史最优位置，i为粒子序号，D为粒子维度，d为粒子维度序号，k为迭代次数；其中，第一项为惯性部分，表示粒子对上一时刻运动状态的信任，即多大程度上按照上一时刻的速度大小、方向进行运动；第二项/＞为认知部分，表示粒子当前位置与自身历史最优位置之间的距离和方向，即多大程度上向自身历史最优值运动；第三项/＞为社会部分，表示粒子当前位置与该粒子群中粒子的最优位置间的距离，与第二项保证算法逐渐向当前最优值迭代，同时保证结果不会陷入局部最优中。在本实施例中，PSO算法的位置更新可表示为当前位置与下一时刻的速度之间的加和，其公式为：本实施例中本发明选择采取线性变化策略改变惯性权重，即惯性权重ω随迭代的进行而不算减小，使得PSO算法在初期具有较强的全局收敛能力，在后期具有较强得局部收敛的能力；因此，在线性策略下惯性权重更新的公式为：式中，ωmax为最大惯性权重；ωmin为最小惯性权重；iter为当前迭代次数；itermax为最大迭代次数。在本实施例中，根据粒子自身最优位置和历史最优位置更新学习因子，其表达式为：在本实施例中通过更新学习因子用来确保粒子不会过度倾向于自身最有位置、历史最优位置进行更新，可帮助粒子在二者之间寻找是否有更优值，以防陷入小取值范围下的局部最优解。在本实施例中，基于上述PSO算法设置，在运行算法时，粒子群规模N为100，粒子维度D为2，迭代次数K为100，最大惯性权重初始值ωmax设置为2，最小惯性权重初始值ωmin设置为0.4，学习因子初始值c1c2分别设置为1.6、1.8。PSO算法按照框架进行迭代更新，以找到LSTM算法中的批处理大小、神经网络隐藏层单元数量的最优值，并把最优值传入到LSTM算法中帮助其构建模型框架。在本发明实施例的步骤S4中，构建的结合注意力机制的LSTM模型包括依次连接的LSTM层和注意力层，所述LSTM层包括记忆元，每个记忆元包括输入门、遗忘门和输出门。在本实施例中，风电功率预测相比于其他回归问题需要更大时间跨度下的数据，通过LSTM模型通过引入记忆元可以实现该要求并且可以遗弃部分无用数据的影响，从而提高风电功率预测精度。记忆元与隐状态具有相同的形状，其设计目的用于记录附加的信息，解决长期信息保存和短期输入缺失的问题。记忆元中包含输入门、输出门、遗忘门，输入门决定何时将数据读入单元，输出门用来从单元中输出条目，遗忘门用于重置单元信息，记忆元可通过决定什么时候记忆或忽略隐状态的输入。具体地，在本实施例中的LSTM层中，输入门It的表达式为：It＝σ式中，σ为带有ReLU激活函数的全连接层，Xt为输入数据，Wxi为输入门中输入数据的权重参数，Ht-1为前一时间步的隐状态，Whi为输入门中隐状态的权重参数，bi为输入门偏置参数；在本实施例中批处理量n为32，输入数d为14，X为历史风电数据和气象预测数据，即经过VMD算法处理过的训练集中的历史风电数据和气象预测数据，其中每个时间分辨率中包含14项数据。在本实施例中，遗忘门Ft的表达式为：Ft＝σ式中，Wxf为遗忘门中输入数据的权重参数，Whf为遗忘门中隐状态的权重参数，bf为遗忘门偏置参数；本实施例中遗忘门输入的数据会经过此门处理后输入给记忆元。在本实施例中，输出门Ot的表达式为：Ot＝σ式中，Wxo为输出门中输入数据的权重参数，Who为输入门中隐状态的权重参数，bo为输出门偏置参数；本实施例中的输出门输出预测结果，即短期内的风电功率。在本实施例中，候选记忆元的运行表达式为：式中，Wxc为候选记忆元中输入数据的权重参数，Whc为后续记忆元中隐状态的权重参数，bc为后续记忆元偏置参数；在本实施例中候选记忆元使用tanh函数作为激活函数，函数值为。在本实施例中，记忆元Ct的运行表达式为：在本实施例中，记忆元运行时决定输入门It至采用多少来自的新数据，而遗忘门Ft控制保留多少过去的记忆元/＞的内容；该结构可以捕获长序列中的依赖关系，还可以缓解梯度消失，记忆元Ct不直接参与模型输出计算。在本实施例中，隐状态Ht的表达式为：Ht＝Ot⊙tanh式中，⊙为Hadamard积，tanh为tanh非线性激活函；。此部分运行中会使用tanh非线性激活函数确保隐状态中的值保持在区间中；若输入门接近1，则模型将所有记忆信息传递给预测部分；若接近于0，则只保留记忆元内的所有信息，不更新隐状态。在本实施例中，将将注意力层置于LSTM层之后，将当前LSTM的输出数据输入到注意力层中；为了防止整体模型过于复杂，尤其是防止LSTM和注意力机制耦合，导致模型调试难度骤升；本实施例中，注意力层采用非参数注意力汇聚，其表达式为：式中，xi为第i项历史风电数据或气象数据，xm为输入到LSTM层中的矩阵并从Xt中获得，ym为xm对应的风电功率并从Ot中获得，Dt为LSTM模型的最终输出结果，ki为第i项元素为ωi其余元素为零的列矩阵，Ht为t时间步的隐状态，ωi为记忆元运行各时间步隐状态分配对应权重。在本实施例中，经过结合注意力机制的LSTM模型能够捕捉到输入数据的时序信息，并且能够处理不同时间步之间的依赖关系，这对于预测短期风电功率的连续性变化非常重要。在本发明实施例步骤S4中，在训练LSTM模型时，设置早停函数与DropOut层，损失函数选择为预测值与真实值之差的平方。训练过程中的评价指标为均方根误差和平均绝对百分比误差，表达式为：如上述所提到的风电功率预测可能会出现严重的过拟合，该模型利用DropOut层随机缺失神经元，并结合后续的测试集测试模型过程，以防止训练过程中产生过拟合，提高模型的泛化能力。其中训练次数设置为1000，若小于某设定均方根误差值，或多次训练迭代的损失函数值小于早定函数中预设值的大小，则模型提前中止训练，保存训练过程中平均绝对百分比误差值最小的模型。在利用测试集测试模型时，将测试集中的历史风电数据和气象预测数据输入训练过模型，将输出结果与真实结果进行对比，计算值，反复进行15次，若模型平均绝对百分比误差值不大，或出去异常值后误差不大则停止。选择平均绝对百分比值最小的三个模型保存，其中均方根误差最小的模型作为最终模型，进行泛化能力检验。进一步地，利用验证集来验证模型的泛化能力，将验证集中的历史风电数据和气象预测数据，若经训练后最终模型的平均绝对百分比值与测试集作为输出时的值相比，小于2个百分点则该模型通过泛化能力检验，可以应用于实际风场进行短期风电功率预测；反之，则模型未通过泛化能力检验，选择平均绝对百分比值最小的模型进行泛化能力检验。在国家电网出台的行业标准中，要求超短期预测平均绝对百分比误差低于15％，短期预测平均绝对百分比误差低于20％。本发明实施例提供的为短期风电功率预测模型，主要进行0至72小时的风电功率预测，精度可达10.7％，满足行业标准。本发明实施例提供的LTSM模型在测试集的验证集的上表现如下表所示；本发明中应用了具体实施例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处，综上所述，本说明书内容不应理解为对本发明的限制。本领域的普通技术人员将会意识到，这里所述的实施例是为了帮助读者理解本发明的原理，应被理解为本发明的保护范围并不局限于这样的特别陈述和实施例。本领域的普通技术人员可以根据本发明公开的这些技术启示做出各种不脱离本发明实质的其它各种具体变形和组合，这些变形和组合仍然在本发明的保护范围内。
