标题title
电源系统及DC/DC变换器控制方法与控制装置
摘要abst
本发明公开了一种电源系统及DC/DC变换器控制方法与控制装置，所述控制方法包括根据储能元件充电电流阈值与储能侧电流之间的误差产生第一输出电流；根据储能元件充放电压阈值与储能侧电压之间的误差产生第二输出电流；根据母线电压以及下垂控制曲线得到第三输出电流；再根据第一输出电流、第二输出电流以及第三输出电流，得到参考电流；根据参考电流与储能侧电流之间的误差产生第一输出电压，根据0.5倍母线电压与飞跨电容电压之间的误差得到第二输出电压，根据第一输出电压和第二输出电压生成驱动信号。本发明能够实现飞跨电容均压功能，且母线侧采用下垂控制，当母线侧多DC/DC变换器并联时，具备自动均流功能。
权利要求书clms
1.一种DC/DC变换器控制方法，所述DC/DC变换器采用飞跨电容型三电平拓扑结构，且其第一端与母线连接，其第二端与储能元件连接，其特征在于，所述控制方法包括以下步骤：获取母线电压、储能侧电流、储能侧电压以及飞跨电容电压；根据所述母线电压、第一电压阈值以及第二电压阈值判断装置处于充电模式或放电模式；在充电模式下，根据储能元件充电电流阈值与储能侧电流之间的误差得到第一输出电流；在放电模式下，根据储能元件放电电流阈值与储能侧电流之间的误差得到第一输出电流；在充电模式下，根据储能元件充电电压阈值与储能侧电压之间的误差得到第二输出电流；在放电模式下，根据储能元件放电电压阈值与储能侧电压之间的误差得到第二输出电流；根据所述母线电压以及母线电压下垂控制曲线得到第三输出电流；根据所述第一输出电流、第二输出电流、第三输出电流、储能侧电压以及母线电压，得到参考电流；根据所述参考电流与储能侧电流之间的误差得到第一输出电压；根据0.5倍母线电压与飞跨电容电压之间的误差得到第二输出电压；根据所述第一输出电压和第二输出电压得到驱动信号，根据所述驱动信号控制DC/DC变换器中开关管的工作。2.根据权利要求1所述的DC/DC变换器控制方法，其特征在于，当母线电压＞第一电压阈值时，装置处于充电模式；当母线电压＜第二电压阈值时，装置处于放电模式，其中，第一电压阈值＞第二电压阈值。3.根据权利要求1所述的DC/DC变换器控制方法，其特征在于，所述储能元件充电电流阈值的上限值为储能元件的额定充电电流；所述储能元件放电电流阈值的上限值为储能元件的额定放电电流；所述储能元件充电电压阈值的上限值为回馈能量充电限值，所述储能元件放电电压阈值的上限值为储能元件的放电电压限值。4.根据权利要求2所述的DC/DC变换器控制方法，其特征在于，充电模式下，当第一电压阈值＜母线电压＜第三电压阈值时，装置处于下垂控制阶段，随着母线电压的升高，储能元件的充电电流增大；当第三电压阈值＜母线电压时，母线电压与储能侧电压之间的比值与第三输出电流之积等于额定充电电流，装置处于恒流控制阶段；放电模式下，当第四电压阈值＜母线电压＜第二电压阈值时，装置处于下垂控制阶段，随着母线电压的降低，储能元件的放电电流增大；当母线电压＜第四电压阈值时，装置处于恒流控制阶段，储能元件的放电电流达到额定放电电流。5.根据权利要求1~4中任一项所述的DC/DC变换器控制方法，其特征在于，根据所述第一输出电流、第二输出电流、第三输出电流、储能侧电压以及母线电压，得到参考电流，具体包括：计算出母线电压与储能侧电压之间的比值，然后计算出所述比值与所述第三输出电流之积，得到第四输出电流；在充电模式下，取所述第一输出电流、第二输出电流以及第四输出电流中的最小值，并将所述最小值进行饱和处理，得到所述参考电流；在放电模式下，取所述第一输出电流、第二输出电流以及第四输出电流中的最大值，并将所述最大值进行饱和处理，得到所述参考电流。6.根据权利要求5所述的DC/DC变换器控制方法，其特征在于，设充电模式下储能侧电流的方向为正，放电模式下储能侧电流的方向为负，所述饱和处理的具体过程为：在充电模式下，当最小值＞额定充电电流时，所述参考电流等于额定充电电流；当最小值＜额定充电电流时，所述参考电流等于最小值；在放电模式下，当最大值＞额定放电电流时，所述参考电流等于最大值；当最大值＜额定放电电流时，所述参考电流等于额定放电电流。7.根据权利要求1~4中任一项所述的DC/DC变换器控制方法，其特征在于，所述DC/DC变换器的开关管包括自上至下依次连接的开关管S1、开关管S2、开关管S3和开关管S4，根据所述驱动信号控制DC/DC变换器中开关管的工作，具体包括：充电模式下，所述驱动信号控制开关管S1和开关管S2导通、开关管S3和开关管S4关断；充电模式下且0.5倍母线电压＞飞跨电容电压时，所述驱动信号控制开关管S1的占空比增大、开关管S2的占空比减小；充电模式下且0.5倍母线电压＜飞跨电容电压时，所述驱动信号控制开关管S1的占空比减小、开关管S2的占空比增大；放电模式下，所述驱动信号控制开关管S1和开关管S2关断、开关管S3和开关管S4导通；放电模式下且0.5倍母线电压＞飞跨电容电压时，所述驱动信号控制开关管S4的占空比增大、开关管S3的占空比减小；放电模式下且0.5倍母线电压＜飞跨电容电压时，所述驱动信号控制开关管S4的占空比减小、开关管S3的占空比增大。8.根据权利要求1~4中任一项所述的DC/DC变换器控制方法，其特征在于，在装置启动之前，先给飞跨电容充电，使飞跨电容电压接近0.5倍母线电压。9.一种DC/DC变换器控制装置，所述DC/DC变换器采用飞跨电容型三电平拓扑结构，且其第一端与母线连接，其第二端与储能元件连接，其特征在于，所述控制装置包括：储能侧电流控制外环，用于在充电模式下根据储能元件充电电流阈值与储能侧电流之间的误差得到第一输出电流；或者，在放电模式下根据储能元件放电电流阈值与储能侧电流之间的误差得到第一输出电流；储能侧电压控制外环，用于在充电模式下根据储能元件充电电压阈值与储能侧电压之间的误差得到第二输出电流；或者，在放电模式下根据储能元件放电电压阈值与储能侧电压之间的误差得到第二输出电流；母线电压下垂控制单元，用于根据母线电压以及母线电压下垂控制曲线得到第三输出电流；参考电流产生单元，用于根据所述第一输出电流、第二输出电流、第三输出电流、储能侧电压以及母线电压，得到参考电流；储能侧电流控制内环，用于根据所述参考电流与储能侧电流之间的误差得到第一输出电压；飞跨电容电压控制单元，用于根据0.5倍母线电压与飞跨电容电压之间的误差得到第二输出电压；驱动信号生成单元，用于根据所述第一输出电压和第二输出电压生成用于控制DC/DC变换器中开关管的驱动信号。10.一种电源系统，其特征在于，所述电源系统包括如权利要求9所述的DC/DC变换器控制装置。
说明书desc
技术领域本发明属于电力电子技术领域，尤其涉及一种电源系统及DC/DC变换器控制方法与控制装置。背景技术当前，在工程机械车辆以及有轨电车领域，均开始大量向“油改电”的纯电驱系统转型和升级，新能源正在加速取代传统的化石能源。新能源车辆常用的储能元件有：铅酸电池、锂电池、超级电容等。目前储能元件的容量、电压等级、电流等参数已逐渐标准化，储能元件的额定电压通常在1000V以下，而且随着储能元件的放电，储能元件的电压逐渐降低，通常储能元件放电的最低电压设定为额定电压的30%，最高回馈制动电压设定为额定电压的70%。工程机械车辆或者有轨电车的动力母线电压通常在1500V～1800V，动力母线电压允许在一定范围内的波动，但是波动范围太大会影响负载的运行。双向DC/DC作为直流牵引网和储能元件的中间电压转换媒介，可以提高储能元件的利用率，实现各种复杂的控制目标。除此之外，双向DC/DC在储能领域、基于储能型的再生制动能量吸收和再利用领域、直流微电网等均具有广泛的应用和市场前景。三电平拓扑结构是双向DC/DC的一种拓扑结构，三电平拓扑结构主要分二极管钳位型、飞跨电容型。通常，二极管钳位型的三电平拓扑结构用于AC/DC系统中，而飞跨电容型的三电平拓扑结构用于DC/DC系统中。相对于二极管钳位型，由于飞跨电容型减少两个二极管，因此自身损耗会降低；由于三电平拓扑结构主要的开关器件耐压只有两电平拓扑结构的一半，从成本来看，三电平拓扑结构比两电平拓扑结构要低；另外三电平拓扑结构能多输出一个电平。因此，在同样条件下，输出纹波电流也比两电平拓扑结构小一倍，但是在控制策略上三电平拓扑结构要比两电平拓扑结构复杂一些，因为三电平拓扑结构需要控制飞跨电容的电压稳定，且为母线电压的1/2。目前，针对三电平双向DC/DC拓扑结构，以及针对飞跨电容三电平这一通用拓扑结构的控制策略已经有很多，但是并没有针对矿用工程车辆或者有轨电车领域有特殊需求的控制策略，这些特殊需求包括负荷功率比较大；启动或者制动过程中惯性比较大，极易对DC/DC造成冲击；要求动态过程平稳、可靠。这些特殊需求还包括多拓扑结构并联均流，按照斜坡电压启动或者斜坡电流启动，以减少启动冲击等。胡斌等提出的“用于超级电容储能系统的三电平双向直流变换器及其控制”，其中公开的控制策略采用电压外环、电流内环的串联结构，依靠电流内环来控制输出电流，通常内环响应速度快，但是波动较大，精度低，对于大惯性负载，当需要控制输出电流时，控制过程波动较大，且精度低。陈挺等提出的“飞跨电容型三电平电路在超级电容能馈系统中的应用研究”，其中公开了飞跨电容型三电平拓扑结构工作原理，但是没有涉及具体控制策略。金科等提出的“三电平双向变换器”，采用硬件实现方式，没有软件方式灵活。此外，上述方案均没有考虑双向变换器并联均流的情况。发明内容本发明的目的在于提供一种电源系统及DC/DC变换器控制方法与控制装置，以解决传统控制装置或方法极易对DC/DC变换器造成冲击，动态控制过程波动较大、精度低，以及无法实现多个双向变换器并联时均流的问题中的至少一个。本发明是通过如下的技术方案来解决上述技术问题的：一种DC/DC变换器控制方法，所述DC/DC变换器采用飞跨电容型三电平拓扑结构，且其第一端与母线连接，其第二端与储能元件连接，所述控制方法包括以下步骤：获取母线电压、储能侧电流、储能侧电压以及飞跨电容电压；根据所述母线电压、第一电压阈值以及第二电压阈值判断装置处于充电模式或放电模式；在充电模式下，根据储能元件充电电流阈值与储能侧电流之间的误差得到第一输出电流；在放电模式下，根据储能元件放电电流阈值与储能侧电流之间的误差得到第一输出电流；在充电模式下，根据储能元件充电电压阈值与储能侧电压之间的误差得到第二输出电流；在放电模式下，根据储能元件放电电压阈值与储能侧电压之间的误差得到第二输出电流；根据所述母线电压以及母线电压下垂控制曲线得到第三输出电流；根据所述第一输出电流、第二输出电流、第三输出电流、储能侧电压以及母线电压，得到参考电流；根据所述参考电流与储能侧电流之间的误差得到第一输出电压；根据0.5倍母线电压与飞跨电容电压之间的误差得到第二输出电压；根据所述第一输出电压和第二输出电压得到驱动信号，根据所述驱动信号控制DC/DC变换器中开关管的工作。进一步地，当母线电压＞第一电压阈值时，装置处于充电模式；当母线电压＜第二电压阈值时，装置处于放电模式，其中，第一电压阈值＞第二电压阈值。进一步地，所述储能元件充电电流阈值的上限值为储能元件的额定充电电流，所述储能元件放电电流阈值的上限值为额定放电电流；所述储能元件充电电压阈值的上限值为回馈能量充电限值，所述储能元件放电电压阈值的上限值为储能元件的放电电压限值。进一步地，充电模式下，当第一电压阈值＜母线电压＜第三电压阈值时，装置处于下垂控制阶段，随着母线电压的升高，储能元件的充电电流增大；当第三电压阈值＜母线电压时，母线电压与储能侧电压之间的比值与第三输出电流之积等于额定充电电流，装置处于恒流控制阶段；放电模式下，当第四电压阈值＜母线电压＜第二电压阈值时，装置处于下垂控制阶段，随着母线电压的降低，储能元件的放电电流增大；当母线电压＜第四电压阈值时，装置处于恒流控制阶段，储能元件的放电电流达到额定放电电流。进一步地，根据所述第一输出电流、第二输出电流、第三输出电流、储能侧电压以及母线电压，得到参考电流，具体包括：计算出母线电压与储能侧电压之间的比值，然后计算出所述比值与所述第三输出电流之积，得到第四输出电流；在充电模式下，取所述第一输出电流、第二输出电流以及第四输出电流中的最小值，并将所述最小值进行饱和处理，得到所述参考电流；在放电模式下，取所述第一输出电流、第二输出电流以及第四输出电流中的最大值，并将所述最大值进行饱和处理，得到所述参考电流。进一步地，设充电模式下储能侧电流的方向为正，放电模式下储能侧电流的方向为负，所述饱和处理的具体过程为：在充电模式下，当最小值＞额定充电电流时，所述参考电流等于额定充电电流；当最小值＜额定充电电流时，所述参考电流等于最小值；在放电模式下，当最大值＞额定放电电流时，所述参考电流等于最大值；当最大值＜额定放电电流时，所述参考电流等于额定放电电流。进一步地，所述DC/DC变换器的开关管包括自上至下依次连接的开关管S1、开关管S2、开关管S3和开关管S4，根据所述驱动信号控制DC/DC变换器中开关管的工作，具体包括：充电模式下，所述驱动信号控制开关管S1和开关管S2导通、开关管S3和开关管S4关断；充电模式下且0.5倍母线电压＞飞跨电容电压时，所述驱动信号控制开关管S1的占空比增大、开关管S2的占空比减小；充电模式下且0.5倍母线电压＜飞跨电容电压时，所述驱动信号控制开关管S1的占空比减小、开关管S2的占空比增大；放电模式下，所述驱动信号控制开关管S1和开关管S2关断、开关管S3和开关管S4导通；放电模式下且0.5倍母线电压＞飞跨电容电压时，所述驱动信号控制开关管S4的占空比增大、开关管S3的占空比减小；放电模式下且0.5倍母线电压＜飞跨电容电压时，所述驱动信号控制开关管S4的占空比减小、开关管S3的占空比增大。进一步地，在装置启动之前，先给飞跨电容充电，使飞跨电容电压接近0.5倍母线电压。基于同一构思，本发明还提供一种DC/DC变换器控制装置，所述DC/DC变换器采用飞跨电容型三电平拓扑结构，且其第一端与母线连接，其第二端与储能元件连接，所述控制装置包括：储能侧电流控制外环，用于在充电模式下根据储能元件充电电流阈值与储能侧电流之间的误差得到第一输出电流；或者，在放电模式下根据储能元件放电电流阈值与储能侧电流之间的误差得到第一输出电流；储能侧电压控制外环，用于在充电模式下根据储能元件充电电压阈值与储能侧电压之间的误差得到第二输出电流；或者，在放电模式下根据储能元件放电电压阈值与储能侧电压之间的误差得到第二输出电流；母线电压下垂控制单元，用于根据母线电压以及母线电压下垂控制曲线得到第三输出电流；参考电流产生单元，用于根据所述第一输出电流、第二输出电流、第三输出电流、储能侧电压以及母线电压，得到参考电流；储能侧电流控制内环，用于根据所述参考电流与储能侧电流之间的误差得到第一输出电压；飞跨电容电压控制单元，用于根据0.5倍母线电压与飞跨电容电压之间的误差得到第二输出电压；驱动信号生成单元，用于根据所述第一输出电压和第二输出电压生成用于控制DC/DC变换器中开关管的驱动信号。基于同一构思，本发明还提供一种电源系统，所述电源系统包括如上所述的DC/DC变换器控制装置。有益效果与现有技术相比，本发明的优点在于：本发明在母线侧采用下垂控制，能够根据母线电压调整储能元件的充放电功率，当母线侧多DC/DC变换器并联时，具备自动均流功能；本发明通过对0.5倍母线电压与飞跨电容电压之间的误差进行调节，实现了飞跨电容均压功能，均压目标值为母线电压的1/2；相对于电压外环、电流内环的串联结构，本发明多一个与电压外环并联的电流外环，控制过程更加稳定、精度更高。本发明具有恒压/恒流控制自动切换功能，预先设定好各电压阈值后，当充电达到对应电压阈值时，相应的外环起到决定作用，实现恒压/恒流控制自动切换。本发明可以在装置启动前，先给飞跨电容充电，使飞跨电容电压接近0.5倍母线电压，实现启动电流或启动电压的独立控制，避免了瞬时启动电流冲击或开关管过压导致装置损坏。附图说明为了更清楚地说明本发明的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一个实施例，对于本领域普通技术人员来说，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例中飞跨电容型三电平拓扑结构；图2是本发明实施例中DC/DC变换器控制方法原理图；图3是本发明实施例中母线电压下垂控制曲线；图4是本发明实施例中控制方法仿真框图；图5是本发明实施例中放电状态下母线电压波形；其中，a表示空载启动，b表示母线加载，c表示下垂控制阶段，d表示恒流控制阶段；图6是本发明实施例中放电状态下电池输出电流波形，其中，a表示空载启动，b表示母线加载，c表示下垂控制阶段，d表示恒流控制阶段。具体实施方式下面结合本发明实施例中的附图，对本发明中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。下面以具体地实施例对本申请的技术方案进行详细说明。下面这几个具体的实施例可以相互结合，对于相同或相似的概念或过程可能在某些实施例不再赘述。本发明提供一种DC/DC变换器控制方法与控制装置，相对于二极管钳位型，飞跨电容型自身损耗更低，成本更低，且能多输出一个电平。因此，本发明的DC/DC变换器采用飞跨电容型三电平拓扑结构，且其第一端与母线连接，其第二端与储能元件连接，如图1所示。图1中，Cfly为飞跨电容，up为母线电压，ip为母线电流，ub为电池侧电压，ib为电池侧电流，开关管S1～S4自上至下依次连接。电压和电流的正方向如图1所示，即以充电模式下的电流方向为正向性，以放电模式下的电流方向为负方向。本实施例中，储能元件为电池包，每个电池包对应一个DC/DC变换器。如图2所示，本发明实施例所提供的一种DC/DC变换器控制方法，包括以下步骤：步骤1：获取母线电压up、储能侧电流ib、储能侧电压ub以及飞跨电容电压UCfly；步骤2：根据母线电压up、第一电压阈值Uh1以及第二电压阈值Ul1判断装置处于充电模式或放电模式；步骤3：在充电模式下，对储能元件充电电流阈值Iset1与储能侧电流ib之间的误差ei进行PI调节，得到第一输出电流ibi；在放电模式下，对储能元件放电电流阈值Iset2与储能侧电流ib之间的误差ei进行PI调节，得到第一输出电流ibi；步骤4：在充电模式下，对储能元件充电电压阈值Uset1与储能侧电压之间的误差eu进行PI调节，得到第二输出电流ibu；在放电模式下，对储能元件放电电压阈值Uset2与储能侧电压之间的误差eu进行PI调节，得到第二输出电流ibu；步骤5：根据母线电压up以及母线电压下垂控制曲线得到第三输出电流ipref；步骤6：根据第一输出电流ibi、第二输出电流ibu、第三输出电流ipref、储能侧电压ub以及母线电压up，得到参考电流ibref；步骤7：对参考电流ibref与储能侧电流ib之间的误差进行PI调节，得到第一输出电压u1；步骤8：对0.5倍母线电压up与飞跨电容电压UCfly之间的误差进行PI调节，得到第二输出电压u2；步骤9：根据第一输出电压u1和第二输出电压u2得到驱动信号，根据驱动信号控制DC/DC变换器中开关管S1～S4的工作。由图2可知，步骤3~5、步骤8为并列步骤。本实施例中，误差调节均采用PI调节。在本发明的一个具体实施方式中，当母线电压up＞第一电压阈值Uh1时，装置处于充电模式；当母线电压up＜第二电压阈值Ul1时，装置处于放电模式，其中，第一电压阈值＞第二电压阈值。步骤3中，利用储能侧电流控制外环在充电模式下，对储能元件充电电流阈值Iset1与储能侧电流ib之间的误差ei进行PI调节，得到第一输出电流ibi；在放电模式下，对储能元件放电电流阈值Iset2与储能侧电流ib之间的误差ei进行PI调节，得到第一输出电流ibi。Iset为储能元件充放电流曲线，其中充电模式下的储能元件充电电流阈值Iset1为Iset＞0的部分，放电模式下的储能元件放电电流阈值Iset2为Iset＜0的部分，Iset的上限值为储能元件的额定充电电流，Iset的下限值为额定放电电流。储能元件充放电曲线Iset可以是斜坡信号，当Iset为斜坡信号时，开始充电时，储能元件充电电流阈值Iset1随着充电时间的增加而增大，一段时间后，储能元件充电电流阈值Iset1达到其上限值，即储能元件充电电流阈值Iset1为储能元件的额定充电电流；开始放电时，储能元件放电电流阈值Iset2随着放电时间的增加而增大，一段时间后，储能元件放电电流阈值Iset2达到其上限值，即储能元件放电电流阈值Iset2为储能元件的额定放电电流。储能元件充放电曲线Iset也可以是方波信号，当Iset为方波信号时，充电时，储能元件充电电流阈值Iset1为储能元件的额定充电电流；放电时，储能元件放电电流阈值Iset2为储能元件的额定放电电流。启动时，为了降低冲击，设置一个电流上升斜率，可以控制储能侧电流ib缓慢达到对应的额定值。为储能侧电流反馈信号的平均值，因为控制外环的速度比较慢，因此此处取平均值可以去除干扰，提高控制精度。储能侧电流控制外环的误差ei经过PI控制后输出第一输出电流ibi，当反馈信号ib低于储能元件充放电阈值时，ibi变大，当反馈信号ib高于储能元件充放电阈值时，ibi变小。在充电模式时，当ib达到储能元件充电电流阈值Iset1时，ibi将逐渐变小，经过Min函数后，储能侧电流控制外环将起决定作用；同理，在放电模式时，储能元件放电电流阈值Iset2和反馈信号ib都为负值，当反馈信号ib达到储能元件放电电流阈值Iset2，ibi将变大，经过Max函数后，储能侧电流控制外环将起决定作用。步骤4中，储能侧电压控制外环在充电模式下，对储能元件充电电压阈值Uset1与储能侧电压之间的误差eu进行PI调节，得到第二输出电流ibu；在放电模式下，对储能元件放电电压阈值Uset2与储能侧电压之间的误差eu进行PI调节，得到第二输出电流ibu。Uset为储能元件充放电压曲线，Uset的上限值为回馈能量充电限值，Uset的下限值为储能元件的放电电压限值，储能元件充电电压阈值Uset1为储能元件当前电压到回馈能量充电限值之间的部分，储能元件放电电压阈值Uset2为储能元件当前电压到放电电压限值之间的部分。本实施例中，回馈能量充电限值为储能元件额定电压的70%，放电电压限值为储能元件额定电压的30%。为储能侧电压反馈信号的平均值，ibu为储能侧电压控制外环的控制输出。储能侧电压控制外环的工作原理与储能侧电流控制外环相似，在充电或放电模式下，当ub达到对应的储能元件充放电压阈值时，储能侧电压控制外环将起决定作用。步骤5中，利用母线电压下垂控制单元根据母线电压up以及母线电压下垂控制曲线得到第三输出电流ipref。如图3所示，母线电压下垂控制曲线由第一电压阈值Uh1、第三电压阈值Uh2、第二电压阈值Ul1以及第四电压阈值Ul2来确定，其中，第三电压阈值Uh2＞第一电压阈值Uh1＞第二电压阈值Ul1＞第四电压阈值Ul2。这四个电压阈值是根据车辆对应的母线电压工作范围来确定的，这四个电压阈值确定后，母线电压下垂控制曲线即可确定，同时可以根据储能元件SOC来设置下垂控制曲线的斜率，通过控制斜率差异实现多台DC/DC变换器并联时储能元件SOC均衡。母线电压下垂控制曲线分为三个阶段：充电阶段、放电阶段以及待机阶段。当母线电压up＞第一电压阈值Uh1时，母线对储能元件充电，装置处于充电模式；当母线电压up＜第二电压阈值Ul1时，储能元件对母线放电，装置处于放电模式；当第二电压阈值Ul1＜母线电压up＜第一电压阈值Uh1时，装置处于待机模式，待机模式下，开关管S1~S4都关断。充电模式又分为两个阶段，当第一电压阈值Uh1＜母线电压up＜第三电压阈值Uh2时，处于下垂控制阶段，在下垂控制阶段，随着母线电压的升高，储能元件的充电电流增大，由于采用下垂控制，多台DC/DC变换器并联时，基本上能达到均流，即各DC/DC变换器输出的电流ip基本相等；当第三电压阈值Uh2＜母线电压up时，母线电压up与储能侧电压ub之间的比值与第三输出电流ipref之积/ub等于额定充电电流，装置处于恒流控制阶段，储能元件充电电流达到额定充电电流，此时母线电压升高，储能元件充电电流也不增加。放电模式也分为两个阶段，当第四电压阈值Ul2＜母线电压up＜第二电压阈值Ul1时，装置处于下垂控制阶段，在下垂控制阶段，随着母线电压up的降低，储能元件的放电电流增大；当母线电压up＜第四电压阈值Ul2时，装置处于恒流控制阶段，储能元件的放电电流达到额定放电电流。步骤6中，根据第一输出电流ibi、第二输出电流ibu、第三输出电流ipref、储能侧电压ub以及母线电压up，得到参考电流ibref，具体包括：计算出母线电压up与储能侧电压ub之间的比值，然后计算出该比值与第三输出电流ipref之积，得到第四输出电流ibp；在充电模式下，取第一输出电流ibi、第二输出电流ibu以及第四输出电流ibp中的最小值min，并将该最小值进行饱和处理，得到参考电流ibref；在放电模式下，取第一输出电流ibi、第二输出电流ibu以及第四输出电流ibp中的最大值max，并将该最大值进行饱和处理，得到参考电流ibref。本实施例中，设充电模式下储能侧电流的方向为正，放电模式下储能侧电流的方向为负，饱和处理的具体过程为：在充电模式下，当最小值＞额定充电电流时，参考电流ibref等于额定充电电流；当最小值＜额定充电电流时，参考电流ibref等于最小值；在放电模式下，当最大值＞额定放电电流时，参考电流ibref等于最大值；当最大值＜额定放电电流时，参考电流ibref等于额定放电电流。步骤7中，利用储能侧电流控制内环对参考电流ibref与储能侧电流ib之间的误差进行PI调节，得到第一输出电压u1。ibref来自外环控制的输出，为储能侧电流控制内环的参考信号，ib为储能侧电流的瞬时值反馈信号。步骤8和9是对飞跨电容电压UCfly进行控制以及驱动信号的产生和分配，也分为充电模式和放电模式。步骤8中，利用飞跨电容电压控制单元对0.5倍母线电压up与飞跨电容电压UCfly之间的误差进行PI调节，得到第二输出电压u2。在充电模式下，开关管S1和开关管S2导通，开关管S3和开关管S4一直关断，相当于BUCK电路，一共有四种工作状态：当开关管S1和开关管S2占空比变大时，储能元件的充电电流越大；当开关管S1和开关管S2占空比变小时，储能元件的充电电流越小；当开关管S1占空比变大、开关管S2占空比变小时，飞跨电容Cfly充电；当开关管S1占空比变小、开关管S2占空比变大时，飞跨电容Cfly放电。所以，当0.5倍母线电压up＞飞跨电容电压UCfly时，驱动信号控制开关管S1的占空比增大、开关管S2的占空比减小，以提升飞跨电容电压UCfly；当0.5倍母线电压up＜飞跨电容电压UCfly时，驱动信号控制开关管S1的占空比减小、开关管S2的占空比增大，以降低飞跨电容电压UCfly。同理，在放电模式下，开关管S1和开关管S2一直关断，开关管S3和开关管S4导通，相当于BOOST电路，也有四种工作状态：当开关管S3和开关管S4的占空比变大时，储能元件的放电电流越大；当开关管S3和开关管S4的占空比变小时，储能元件的放电电流越小；当开关管S4占空比变大、开关管S3占空比变小时，飞跨电容Cfly充电，当开关管S4占空比变小、开关管S3占空比变大时，飞跨电容Cfly放电。所以，当0.5倍母线电压up＞飞跨电容电压UCfly时，驱动信号控制开关管S4的占空比增大、开关管S3的占空比减小，以提升飞跨电容电压；当0.5倍母线电压up＜飞跨电容电压UCfly时，驱动信号控制开关管S4的占空比减小、开关管S3的占空比增大，以降低飞跨电容电压。根据所述第一输出电压u1和第二输出电压u2得到驱动信号，根据驱动信号控制DC/DC变换器中开关管S1~S4的工作。如图2所示，当0.5倍母线电压up＞飞跨电容电压UCfly时，0.5倍母线电压up与飞跨电容电压UCfly之间的误差ec为正，第二输出电压u2为正，充电模式下，第一输出电压与第二输出电压之和增大，使开关管S1的占空比增大，第一输出电压与第二输出电压之差减小，使开关管S2的占空比减小；-1为取反，放电模式下，第一输出电压与第二输出电压之和增大，使开关管S4的占空比增大，第一输出电压与第二输出电压之差减小，使开关管S3的占空比减小。当0.5倍母线电压up＜飞跨电容电压UCfly时，0.5倍母线电压up与飞跨电容电压UCfly之间的误差ec为负，第二输出电压u2为负，充电模式下，第一输出电压与第二输出电压之和减小，使开关管S1的占空比减小，第一输出电压与第二输出电压之差增大，使开关管S2的占空比增大；放电模式下，第一输出电压与第二输出电压之和减小，使开关管S4的占空比减小，第一输出电压与第二输出电压之差增大，使开关管S3的占空比增大。图2中的三角波为PWM调制波，PWM调制波的调制周期与开关管的开关频率一致。飞跨电容电压控制单元在电流环的外面，没有参与电流控制，很容易导致过流，特别是启动时，因此在装置启动之前，需要给飞跨电容充电，使飞跨电容电压尽量接近up/2，才能启动，否则瞬时启动过流或者开关管过压有可能损坏装置。为了验证本发明方法的有效性，利用仿真平台matlab/simulink搭建仿真模型，如图4所示，其中R1为负载电阻，KM1为继电器，用于模拟负载动态切换过程。控制方法需要输入4个反馈信号，即需要采样母线电压up、储能侧电流ib、储能侧电压ub以及飞跨电容电压UCfly。根据控制方法需要对采样值求取多点平均值，可以大大降低随机误差干扰的影响，提高控制精度。仿真参数如表1所示。表1仿真模型参数列表以重型卡车为例，由于卡车DC/DC变换器主要工作在电池对母线放电状态，所以只图示放电状态下的仿真波形，如图5和图6所示。其中，图5为母线电压波形，图6为电池输出电流波形。在空载启动阶段a，储能侧电流控制外环起决定作用，从图6可以看出放电电流为负值，且放电电流按照斜坡上升，一段时间后，当母线电压上升到Ul1，装置进入到待机模式，输出电流下降到0，然后KM1闭合，母线突然带载启动，装置进入下垂控制阶段c，下垂控制阶段c的特点是随着母线电压的下降，电池放电电流越来越大，图5和图6中下垂控制阶段c，母线电压下降是由于电池容量小的缘故，随着放电的过程，电池电压下降，输出功率也下降，所以出现母线电压持续下降的过程。从图5和图6可以看出，下垂控制阶段c母线电压基本上能维持稳定，电池放电电流逐渐增大。当电池放电电流达到额定放电电流时，就进入恒流控制阶段d，恒流控制阶段d，电池的输出电流恒定，随着电池电压的下降，电池放电功率和母线电压都加速下降。本发明实施例还提供一种DC/DC变换器控制装置，DC/DC变换器采用飞跨电容型三电平拓扑结构，且其第一端与母线连接，其第二端与储能元件连接，所述控制装置包括：储能侧电流控制外环、储能侧电压控制外环、母线电压下垂控制单元、参考电流产生单元、储能侧电流控制内环、飞跨电容电压控制单元以及驱动信号生成单元。储能侧电流控制外环，用于在充电模式下对储能元件充电电流阈值与储能侧电流之间的误差进行PI调节，得到第一输出电流；或者，在放电模式下对储能元件放电电流阈值与储能侧电流之间的误差进行PI调节，得到第一输出电流；储能侧电压控制外环，用于在充电模式下对储能元件充电电压阈值与储能侧电压之间的误差进行PI调节，得到第二输出电流；或者，在放电模式下对储能元件放电电压阈值与储能侧电压之间的误差进行PI调节，得到第二输出电流；母线电压下垂控制单元，用于根据母线电压以及母线电压下垂控制曲线得到第三输出电流；参考电流产生单元，用于根据第一输出电流、第二输出电流、第三输出电流、储能侧电压以及母线电压，得到参考电流；储能侧电流控制内环，用于对参考电流与储能侧电流之间的误差进行PI调节，得到第一输出电压；飞跨电容电压控制单元，用于对0.5倍母线电压与飞跨电容电压之间的误差进行PI调节，得到第二输出电压；驱动信号生成单元，用于根据第一输出电压和第二输出电压生成用于控制DC/DC变换器中开关管的驱动信号。以上所揭露的仅为本发明的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明揭露的技术范围内，可轻易想到变化或变型，都应涵盖在本发明的保护范围之内。
