标题title
一种基于改进蚁群算法的光伏阵列全局重构装置及其方法
摘要abst
本发明涉及光伏发电技术领域，公开了一种基于改进蚁群算法的光伏阵列全局重构装置，该装置包括多个光伏电池组，每个光伏电池组均包括光伏电池、电流采样电路、上继电器组、下继电器组和译码器。还公开了一种基于改进蚁群算法的光伏阵列全局重构方法，该方法包括基于光伏阵列的短路电流值判定重构；需要重构时对各光伏电池短路电流进行测量；将光伏阵列结构转换为树状结构基于蚁群算法建立树状结构路径，生成光伏阵列的重构方法；FPGA芯片获取重构方法，将重构方案发送到主控芯片，主控芯片通过译码器对上继电器组和下继电器组进行控制。本发明有效提高光伏阵列的输出功率和整体性能，减少能量损失，并引入蚁群算法降低重构算法的复杂度。
权利要求书clms
1.一种基于改进蚁群算法的光伏阵列全局重构装置，其特征在于，包括多个光伏电池组、译码器、总电流采样电路、主控芯片和FPGA芯片，每个光伏电池组均包括光伏电池、电流采样电路、上继电器组、下继电器组和译码器；光伏电池与电流采样电路、上继电器组、下继电器组分别连接，译码器与上继电器组、下继电器组分别连接；重构时多个光伏电池并联后再串联组成光伏阵列，光伏阵列连接总电流采样电路；FPGA芯片连接主控芯片，主控芯片分别连接所有的电流采样电路和译码器。2.根据权利要求1所述的一种基于改进蚁群算法的光伏阵列全局重构装置，其特征在于，上继电器组与光伏电池正极连接，下继电器组与光伏电池负极连接。3.一种基于改进蚁群算法的光伏阵列全局重构方法，基于权利要求1所述的重构装置，其特征在于，包括步骤如下：步骤a，基于光伏阵列的短路电流值判定重构；步骤b，需要重构时利用电流采样电路对各光伏电池短路电流进行测量；步骤c，将光伏阵列结构转换为树状结构基于蚁群算法建立树状结构路径，生成光伏阵列的重构方法；步骤d，FPGA芯片获取重构方法，将重构方案发送到主控芯片，主控芯片通过译码器对上继电器组和下继电器组进行控制。4.根据权利要求3所述的一种基于改进蚁群算法的光伏阵列全局重构方法，其特征在于，采用的光伏阵列结构为网状连接方式结构。5.根据权利要求3所述的一种基于改进蚁群算法的光伏阵列全局重构方法，其特征在于，所述步骤a包括：步骤a1，读取光伏电池两端的短路电压值，采集整个光伏阵列的短路电流值；步骤a2，根据短路电流值判断光伏阵列是否存在遮挡情况，若短路电流值低于设定阈值则存在遮挡进行重构，若短路电流值高于等于设定阈值则正常运行。6.根据权利要求3所述的一种基于改进蚁群算法的光伏阵列全局重构方法，其特征在于，所述步骤b包括：步骤b1，进行重构时，主控芯片控制光伏阵列断开连接；步骤b2，电流采样电路读取光伏阵列内每个光伏电池的短路电流，将读取的短路电流参数通过总线传输给FPGA芯片。7.根据权利要求3所述的一种基于改进蚁群算法的光伏阵列全局重构方法，其特征在于，所述步骤c包括：步骤c1，建立光伏阵列的分配模型，获取分配模型中光伏阵列串联数和需要重构的光伏电池数；步骤c2，将光伏阵列串联数作为树状图的节点分支数，将需要重构的光伏电池数作为树状图层数，将光伏阵列的分配模型转化为树状图模型；步骤c3，选择当前节点i对路径进行选择，当前节点i选择下一节点j的方法为：；其中，J为路径选择方法，I为当前节点i到下个连接的所有节点的集合，k属于集合I，q为区间的随机数，q0为区间可调的选择概率参数，为当前节点i选择k路径的启发值，/＞为区间固定参数，用于调试启发值与信息素作用权重占比，/＞为当前节点i选择k路径的信息素；其中，；La为蚁群算法中当前蚂蚁已经选择过的所有光伏电池集合，n属于集合La，B为步骤b中采样的所有光伏电池短路电流集合，Bn为n光伏电池短路电流，Lk为当前蚂蚁选择k节点所对应阵列行的所有光伏电池集合，m属于集合Lk，Bm为m光伏电池短路电流；依次计算当前节点i的选择概率，然后根据选择概率采用轮盘赌选择法找到下一个节点j的路径：；为蚂蚁从当前节点i选择下一节点j的概率，/＞为当前节点i到下一节点j的信息素，/＞为当前节点i到下一节点j的启发值；步骤c4，一轮蚁群算法迭代完后，对每只蚂蚁得到的方案带入期望函数进行运算：；D为期望函数值，A为光伏阵列行数集合，q属于集合A，Lq为光伏阵列q行上所有光伏电池，n属于集合Lq，Bn为n光伏电池短路电流；统计出所有蚂蚁的期望函数值，选出最大期望函数值的蚂蚁，获取蚂蚁选择的路径为集合L，集合L为本轮算法迭代最优路径，并构建本轮非最优路径为集合Q；对所有路径上的信息素进行更新，更新方法为：；其中，la属于集合L，为下一轮算法迭代la路径上的信息素，/＞为当前la路径上的信息素，n为当前树层级，m为总层级，/＞为信息素初始值，ρ为区间可调的信息素更新参数；对未选中的路径进行信息素挥发，挥发方法为：；其中，为下一轮算法迭代lb路径上的信息素，lb属于集合Q，/＞，为目前最优值；步骤c5，重复步骤c3到步骤c4进行多次迭代，得到优解的整条路径为当前光伏阵列的重构方案。8.根据权利要求3所述的一种基于改进蚁群算法的光伏阵列全局重构方法，其特征在于，所述步骤d包括：步骤d1，将光伏阵列的重构方案通过总线传输到主控芯片，主控芯片根据重构方案对译码器发出信号，译码器根据信号控制对应的光伏电池上的继电器组完成连接；步骤d2，上继电器组与光伏电池正极连接，下继电器组与光伏电池负极连接，采用译码器实现光伏电池正负极连接的切换，进行光伏阵列重构。
说明书desc
技术领域本发明属于光伏发电技术领域，具体涉及一种基于改进蚁群算法的光伏阵列全局重构装置及其方法。背景技术光伏电池的转换效率较低，容易受到外部环境和制造工艺的影响。光伏阵列在运行中也很容易受到各种随机因素的干扰，如飞鸟、云层、附近建筑物以及不合理的布局，导致部分区域出现阴影遮挡问题，使光伏输出不稳定。传统光伏阵列为了减轻阴影效应对光伏系统的不利影响，通常在多个光伏电池之间并联旁路二极管。当单个或多个光伏电池处于阴影中时，由于电池两端产生负电压，旁路二极管会从反向偏置状态切换到正向导通状态。这使得被阴影覆盖的光伏电池可以形成自身回路，而不会对整个光伏阵列的电力输出造成损失，避免了热斑效应的产生。然而使用旁路二极管会引入额外的导通损耗和功耗，降低系统的整体效率，还会引发光伏阵列的多峰值问题，所以采用全局最大功率跟踪，即GMPPT算法来解决，但是在面对复杂的阴影或者故障时，算法的精度不足会降低整体的输出功率，存在局限性。发明内容本发明提供一种基于改进蚁群算法的光伏阵列全局重构装置及其方法，以解决上述出现的技术问题。为实现上述目的，本发明采用的技术方案如下：一种基于改进蚁群算法的光伏阵列全局重构装置，包括多个光伏电池组、译码器、总电流采样电路、主控芯片和FPGA芯片，每个光伏电池组均包括光伏电池、电流采样电路、上继电器组、下继电器组和译码器；光伏电池与电流采样电路、上继电器组、下继电器组分别连接，译码器与上继电器组、下继电器组分别连接；重构时多个光伏电池并联后再串联组成光伏阵列，光伏阵列连接总电流采样电路；FPGA芯片连接主控芯片，主控芯片分别连接所有的电流采样电路和译码器。进一步地，上继电器组与光伏电池正极连接，下继电器组与光伏电池负极连接。一种基于改进蚁群算法的光伏阵列全局重构方法，基于上述改进蚁群算法的光伏阵列全局重构装置，包括步骤如下：步骤a，基于光伏阵列的短路电流值判定重构；步骤b，需要重构时利用电流采样电路对各光伏电池短路电流进行测量；步骤c，将光伏阵列结构转换为树状结构基于蚁群算法建立树状结构路径，生成光伏阵列的重构方法；步骤d，FPGA芯片获取重构方法，将重构方案发送到主控芯片，主控芯片通过译码器对上继电器组和下继电器组进行控制。进一步地，采用的光伏阵列结构为网状连接方式结构。进一步地，所述步骤a包括：步骤a1，读取光伏电池两端的短路电压值，采集整个光伏阵列的短路电流值；步骤a2，根据短路电流值判断光伏阵列是否存在遮挡情况，若短路电流值低于设定阈值则存在遮挡进行重构，若短路电流值高于等于设定阈值则正常运行。进一步地，所述步骤b包括：步骤b1，进行重构时，主控芯片控制光伏阵列断开连接；步骤b2，电流采样电路读取光伏阵列内每个光伏电池的短路电流，将读取的短路电流参数通过总线传输给FPGA芯片。进一步地，所述步骤c包括：步骤c1，建立光伏阵列的分配模型，获取分配模型中光伏阵列串联数和需要重构的光伏电池数；步骤c2，将光伏阵列串联数作为树状图的节点分支数，将需要重构的光伏电池数作为树状图层数，将光伏阵列的分配模型转化为树状图模型；步骤c3，选择当前节点i对路径进行选择，当前节点i选择下一节点j的方法为：；其中，J为路径选择方法，I为当前节点i到下个连接的所有节点的集合，k属于集合I，q为区间的随机数，q0为区间可调的选择概率参数，为当前节点i选择k路径的启发值，/＞为区间固定参数，用于调试启发值与信息素作用权重占比，/＞为当前节点i选择k路径的信息素；其中，；La为蚁群算法中当前蚂蚁已经选择过的所有光伏电池集合，n属于集合La，B为步骤b中采样的所有光伏电池短路电流集合，Bn为n光伏电池短路电流，Lk为当前蚂蚁选择k节点所对应阵列行的所有光伏电池集合，m属于集合Lk，Bm为m光伏电池短路电流；依次计算当前节点i的选择概率，然后根据选择概率采用轮盘赌选择法找到下一个节点j的路径：；为蚂蚁从当前节点i选择下一节点j的概率，/＞为当前节点i到下一节点j的信息素，/＞为当前节点i到下一节点j的启发值；步骤c4，一轮蚁群算法迭代完后，对每只蚂蚁得到的方案带入期望函数进行运算：；D为期望函数值，A为光伏阵列行数集合，q属于集合A，Lq为光伏阵列q行上所有光伏电池，n属于集合Lq，Bn为n光伏电池短路电流；统计出所有蚂蚁的期望函数值，选出最大期望函数值的蚂蚁，获取蚂蚁选择的路径为集合L，集合L为本轮算法迭代最优路径，并构建本轮非最优路径为集合Q；对所有路径上的信息素进行更新，更新方法为：；其中，la属于集合L，为下一轮算法迭代la路径上的信息素，/＞为当前la路径上的信息素，n为当前树层级，m为总层级，/＞为信息素初始值，ρ为区间可调的信息素更新参数；对未选中的路径进行信息素挥发，挥发方法为：；其中，为下一轮算法迭代lb路径上的信息素， lb属于集合Q，，/＞为目前最优值；步骤c5，重复步骤c3到步骤c4进行多次迭代，得到优解的整条路径为当前光伏阵列的重构方案。进一步地，所述步骤d包括：步骤d1，将光伏阵列的重构方案通过总线传输到主控芯片，主控芯片根据重构方案对译码器发出信号，译码器根据信号控制对应的光伏电池上的继电器组完成连接；步骤d2，上继电器组与光伏电池正极连接，下继电器组与光伏电池负极连接，采用译码器实现光伏电池正负极连接的切换，进行光伏阵列重构。与现有技术相比，本发明具有以下有益效果：本发明采用TCT网状连接方式结构，基于光伏阵列的短路电流值进行重构判断，判定需要重构时，利用蚁群算法对光伏阵列进行了全局动态重构，用于解决部分阴影遮挡的问题。本发明有效提高了光伏阵列的输出功率和整体性能，减少了能量损失，并引入蚁群算法降低了重构的复杂度。附图说明图1为本发明一种基于改进蚁群算法的光伏阵列全局重构装置示意图。图2为本发明一种基于改进蚁群算法的光伏阵列全局重构方法示意图。其中，附图标记对应的名称为：1-光伏电池；2-电流采样电路；3-上继电器组；4-下继电器组；5-译码器；6-光伏阵列；7-总电流采样电路；8-主控芯片；9-FPGA芯片。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图，对本发明进一步详细说明。显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；当然的，还可以是机械连接，也可以是电连接；另外的，还可以是直接相连，也可以是通过中间媒介间接相连，或者可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。如图1所示，一种基于改进蚁群算法的光伏阵列全局重构装置，包括多个光伏电池组、译码器5、总电流采样电路7、主控芯片8和FPGA芯片9，每个光伏电池组均包括光伏电池1、电流采样电路2、上继电器组3、下继电器组4和译码器5；光伏电池1与电流采样电路2、上继电器组3、下继电器组4分别连接，译码器5与上继电器组3、下继电器组4分别连接；重构时多个光伏电池并联后再串联组成光伏阵列6，光伏阵列6连接总电流采样电路7；FPGA芯片9连接主控芯片8，主控芯片8分别连接所有的电流采样电路2和译码器5。优选地，上继电器组3与光伏电池1正极连接，下继电器组4与光伏电池1负极连接。如图2所示，一种基于改进蚁群算法的光伏阵列全局重构方法，包括步骤如下：步骤a，基于光伏阵列的短路电流值判定重构；步骤b，需要重构时利用电流采样电路对各光伏电池短路电流进行测量；步骤c，将光伏阵列结构转换为树状结构基于蚁群算法建立树状结构路径，生成光伏阵列的重构方法；步骤d，FPGA芯片获取重构方法，将重构方案发送到主控芯片，主控芯片通过译码器对上继电器组和下继电器组进行控制。优选地，采用的光伏阵列结构为网状连接方式结构。所述光伏电池为用于重构使用的光伏电池，全重构完后得到光伏阵列。每次进行光伏阵列重构时，每个光伏电池会互相断开连接，再根据当前重构策略进行并联后再串联重新组成光伏阵列。相对于其它结构，光伏阵列的网状连接方式结构具有更好的抑制失配损失的效果。优选地，所述步骤a包括：步骤a1，读取光伏电池两端的短路电压值，采集整个光伏阵列的短路电流值；步骤a2，根据短路电流值判断光伏阵列是否存在遮挡情况，若短路电流值低于设定阈值则存在遮挡进行重构，若短路电流值高于等于设定阈值则正常运行。所述步骤a1中，当出现阴影遮挡的情况后，被遮挡的光伏电池的发电功率会产生下降，经研究，光伏电池发电的最大功率与其两端短路电流呈现正比关系，与其两端的开路电压呈现对数关系，因此通过读取光伏电池两端的短路电压就可以得到此时最大功率的情况；当有光伏电池存在被阴影遮挡的情况时，整个光伏阵列的功率会下降，因此采集整个光伏阵列的短路电流值就可以判断出是否存在被阴影遮挡的情况。读取短路电流值的方式为使用一个短路电流采样电路，该短路电流采样电路会使光伏电池产生短路，并在该短路电路里加入采样电阻，该采样电阻大小取值不能影响光伏电池最大短路电流的产生。当短路电流经过采样电阻后，会在采样电阻两端产生压差，采用运算放大器组成电阻跟随器，通过电阻跟随器将采样电阻两端的电压连接至模数转换器进行模数转换，得到电阻两端的压差与采样电阻的阻值。通过欧姆定律得到该光伏电池此时的短路电流值。在采集电压时使用运算放大器，根据运算放大器输入电阻大和输出电阻小的特性搭建电压跟随器，使其短路电流采样电路对短路回路影响减少，得到更准确的短路电流值。所述步骤a2中，设定阈值要根据现场情况和光伏电池情况进行设置。参考3个方面：1、根据光伏电池参数可以得到相应的额定功率，根据该额定功率可以得出正常工作时的短路电流值，当测量的短路电流值低于该值就说明光伏电池非正常工作，有被阴影遮挡的情况出现；2、根据使用场景来设置，有些地方可能在正常使用时就无法使光伏电池全功率输出，就可以减小该阈值防止误触；3、根据触发灵敏度来设置，阈值设置越大触发灵敏度就越高，反之阈值设置越小触发灵敏度就越低。优选地，所述步骤b包括：步骤b1，进行重构时，主控芯片控制光伏阵列断开连接；步骤b2，电流采样电路读取光伏阵列内每个光伏电池的短路电流，将读取的短路电流参数通过总线传输给FPGA芯片。所述步骤b1中，光伏阵列所采用的TCT网状连接方式结构，宏观上是需要控制光伏电池并入到指定阵列行中，因此光伏电池两端都需要进行跳转，上继电器组用于光伏电池正极的跳转，下继电器组用于光伏电池负极的跳转，若要发生重构则需要将上继电器组和下继电器组都断开，使该光伏电池脱离光伏阵列。所述步骤b2为单个光伏电池的短路电流值采样，在进行重构运算时需要每个光伏电池的当前功率参数，因此需要对每个光伏电池短路电流进行采样得到功率参数。采集全部光伏电池的短路电流后，会存储在FPGA芯片指定的寄存器中，其代表了每个光伏电池的功率参数，并参与到阵列重构运算中去改进蚁群算法期望函数的计算，直到该期望函数达到近似的最优值，此时的方案就为当前重构的最优方案，其中，期望函数为将光伏阵列输出的短路电流中最小短路电流值最大化。优选地，所述步骤c包括：步骤c1，建立光伏阵列的分配模型，获取分配模型中光伏阵列串联数和需要重构的光伏电池数；其中所述步骤c1，其中光伏阵列串联数为光伏阵列中光伏电池并联后再串联后的串联数，光伏阵列中串联数决定了整个阵列的电压输出范围大小，再根据具体的应用环境来决定串联数；步骤c2，将光伏阵列串联数作为树状图的节点分支数，将需要重构的光伏电池数作为树状图层数，将光伏阵列的分配模型转化为树状图模型；步骤c3，选择当前节点i对路径进行选择，当前节点i选择下一节点j的方法为：；其中，J为路径选择方法，I为当前节点i到下个连接的所有节点的集合，k属于集合I，q为区间的随机数，q0为区间可调的选择概率参数，为当前节点i选择k路径的启发值，/＞为区间固定参数，用于调试启发值与信息素作用权重占比，/＞为当前节点i选择k路径的信息素；其中，；La为蚁群算法中当前蚂蚁已经选择过的所有光伏电池集合，n属于集合La，B为步骤b中采样的所有光伏电池短路电流集合，Bn为n光伏电池短路电流，Lk为当前蚂蚁选择k节点所对应阵列行的所有光伏电池集合，m属于集合Lk，Bm为m光伏电池短路电流；依次计算当前节点i的选择概率，然后根据选择概率采用轮盘赌选择法找到下一个节点j的路径：；为蚂蚁从当前节点i选择下一节点j的概率，/＞为当前节点i到下一节点j的信息素，/＞为当前节点i到下一节点j的启发值；所述步骤c3中，启发值和信息素为蚁群算法中的计算方法。蚁群算法是一种模拟蚂蚁行为的计算方法，当一只蚂蚁在选择下一个路径时，会在启发值和信息素的共同作用下来完成下一路径的选择。该启发值在不同的应用场景中会有不同的设置方法，本实施例是将当前光伏阵列每行的短路电流值进行取值，得到的值作为启发值；每只蚂蚁对该路径进行选择就会增加该路径的信息素，未选择的路径就会减少信息素，相当于信息素的挥发，用于模拟蚁群觅食行为的规律，该路径的信息素会影响其它蚂蚁对该路径的选择；步骤c4，一轮蚁群算法迭代完后，对每只蚂蚁得到的方案带入期望函数进行运算：；D为期望函数值，A为光伏阵列行数集合，q属于集合A，Lq为光伏阵列q行上所有光伏电池，n属于集合Lq，Bn为n光伏电池短路电流；统计出所有蚂蚁的期望函数值，选出最大期望函数值的蚂蚁，获取蚂蚁选择的路径为集合L，集合L为本轮算法迭代最优路径，并构建本轮非最优路径为集合Q；对所有路径上的信息素进行更新，更新方法为：；其中，la 属于集合L，为下一轮算法迭代la 路径上的信息素，/＞为当前la路径上的信息素，n为当前树层级，m为总层级，/＞为信息素初始值，ρ为区间可调的信息素更新参数；对未选中的路径进行信息素挥发，挥发方法为：；其中，为下一轮算法迭代lb路径上的信息素，lb属于集合Q，，/＞为目前最优值；所述步骤c4中，对所有路径进行更新。传统蚁群算法常用于多节点路径的选择，同时对传统的信息素更新进行了改进。信息素的更新变化幅度会随着树的层级增加而增加，能有效避免树顶层过早收敛陷入局部最优；步骤c5，重复步骤c3到步骤c4进行多次迭代，得到优解的整条路径为当前光伏阵列的重构方案。优选地，所述步骤d包括：步骤d1，将光伏阵列的重构方案通过总线传输到主控芯片，主控芯片根据重构方案对译码器发出信号，译码器根据信号控制对应的光伏电池上的继电器组完成连接；步骤d2，上继电器组与光伏电池正极连接，下继电器组与光伏电池负极连接，采用译码器实现光伏电池正负极连接的切换，进行光伏阵列重构。所述步骤d1，本发明使用译码器实现较少引线完成多个继电器的控制，以满足光伏电池并入TCT网状连接方式结构光伏阵列的条件。所述步骤d2，采用的光伏阵列结构为TCT网状连接方式结构，是通过多个光伏电池并联后再串联组成，若有光伏电池在光伏阵列中发生变动，其正负极都要重新连接，且只能连接光伏阵列的某一行，不能单独跨行连接，便于控制采用译码器来实现该规则。译码器的输出端只会有一个有效端口，通过较少的引线来完成光伏电池的切换，译码器范围的选择取决于光伏阵列的串联数。最后应说明的是：以上各实施例仅仅为本发明的较优实施例用以说明本发明的技术方案，而非对其限制，当然更不是限制本发明的专利范围；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围；也就是说，但凡在本发明的主体设计思想和精神上作出的毫无实质意义的改动或润色，其所解决的技术问题仍然与本发明一致的，均应当包含在本发明的保护范围之内；另外，将本发明的技术方案直接或间接的运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。
