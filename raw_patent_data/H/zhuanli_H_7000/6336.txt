标题title
基于VPP的国标IPsec VPN实现方法、装置、系统及电子设备
摘要abst
本申请提供一种基于VPP的国标IPsec VPN实现方法、装置、系统及电子设备，涉及网络安全领域，用于使IPsec VPN调用硬件密码设备。该方法包括：接收到第一发送设备发送的第一网络数据包，第一网络数据包为IPsec VPN数据包，第一网络数据包的约定加密算法为包括在硬件密码设备上实现的国家商用密码算法；基于VPP框架，对第一网络数据包解密和解封装，获得解封装数据包。基于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装第七网络数据包；根据封装后的第七网络数据包的目的地址，基于VPP框架转发封装后的第七网络数据包。
权利要求书clms
1.一种基于VPP的国标IPsec VPN实现方法，其特征在于，应用于Linux系统的服务器，包括：接收到第一发送设备发送的第一网络数据包，所述第一发送设备与所述服务器存在安全关联，所述第一网络数据包为IPsec VPN数据包，所述第一网络数据包的目的地址指向所述服务器，所述第一网络数据包的约定封装方式为基于ESP协议和/或AH协议的封装方式，所述第一网络数据包的约定加密算法包括在硬件密码设备上实现的国家商用密码算法，所述硬件密码设备与所述服务器通信连接，所述第一网络数据包为IPsec流量；基于VPP框架，按照所述约定封装方式、所述约定加密算法和约定密钥，对所述第一网络数据包进行解密和解封装，获得解封装数据包。2.根据权利要求1所述的基于VPP的国标IPsec VPN实现方法，其特征在于，在所述接收到第一发送设备发送的第一网络数据包之前，所述方法还包括：接收到所述第一发送设备发送的第二网络数据包，所述第二网络数据包的目的地址指向所述服务器，所述第二网络数据包的目的端口指向预设端口；基于所述VPP框架，与所述第一发送设备基于网络密钥交换协议建立所述安全关联，并生成安全关联信息，所述安全关联信息包括所述约定封装方式、所述约定加密算法和所述约定密钥。3.根据权利要求1或2所述的基于VPP的国标IPsec VPN实现方法，其特征在于，所述基于VPP框架，按照所述约定封装方式、所述约定加密算法和约定密钥，对所述第一网络数据包进行解密和解封装，获得解封装数据包，包括：基于所述VPP框架，将所述第一网络数据包发送到所述硬件密码设备的待处理数据包队列；基于所述VPP框架，接收到所述硬件密码设备发送的所述解封装数据包，所述解封装数据包为所述硬件密码设备基于所述约定封装方式、所述约定加密算法和所述约定密钥对所述待处理数据包队列中的所述第一网络数据包进行解封装和解密获得。4.根据权利要求1所述的基于VPP的国标IPsec VPN实现方法，其特征在于，所述服务器的物理网口属于所述VPP框架所处的第一网络命名空间，所述服务器的Linux内核协议栈属于第二网络命名空间；所述第一网络命名空间还包括虚拟主机接口和第一虚拟以太网设备，所述虚拟主机接口与所述物理网口桥接，所述虚拟主机接口与所述第一虚拟以太网设备通信连接；所述第二网络命名空间还包括第二虚拟以太网设备，所述第一虚拟以太网设备和所述第二虚拟以太网设备通信连接。5.根据权利要求1所述的基于VPP的国标IPsec VPN实现方法，其特征在于，所述服务器的物理网口属于所述VPP框架所处的第一网络命名空间，所述服务器的Linux内核协议栈属于第二网络命名空间；所述方法还包括：在所述第一网络命名空间中创建虚拟主机接口，并基于所述VPP框架桥接所述虚拟主机接口与所述服务器的物理网口；在所述第一网络命名空间创建第一虚拟以太网设备，在所述第二网络命名空间创建第二虚拟以太网设备，所述第一虚拟以太网设备与所述虚拟主机接口通信连接，所述第二虚拟以太网设备与所述第一虚拟以太网设备通信连接。6.根据权利要求4或5所述的基于VPP的国标IPsec VPN实现方法，其特征在于，所述方法还包括：接收到第二发送设备发送的第三网络数据包，所述第三网络数据包指示的目的地址为所述第二虚拟以太网设备；基于所述服务器的物理网口、所述虚拟主机接口、所述第一虚拟以太网设备和所述第二虚拟以太网设备的通信连接，将所述第三网络数据包发送至所述第二虚拟以太网设备所属的所述第二网络命名空间中，并通过所述Linux内核协议栈转发给所述Linux系统对应的应用进行处理。7.根据权利要求1所述的基于VPP的国标IPsec VPN实现方法，其特征在于，所述方法还包括：接收到第三发送设备发送的第四网络数据包，所述第四网络数据包的目的地址指向所述服务器，所述第四网络数据包的封装方式为基于ESP协议和/或AH协议的封装方式，所述第三发送设备与所述服务器不存在安全关联；基于所述VPP框架，根据预设策略转发所述第四网络数据包；和/或，接收到第四发送设备发送的第五网络数据包，所述第五网络数据包为基于除所述约定封装方式封装以外的其他封装方式封装；基于所述VPP框架，将所述第五网络数据包转发至除所述IPsec VPN以外的虚拟网络的协议栈中处理；和/或，接收到第五发送设备发送的第六网络数据包，所述第六网络数据包的目的地址不指向所述服务器；基于所述VPP框架，根据所述第六网络数据包的所述目的地址，转发所述网络数据包。8.根据权利要求1所述的基于VPP的国标IPsec VPN实现方法，其特征在于，所述方法还包括：接收到第七网络数据包，所述第七网络数据包的目的地址指示的接收设备与所述服务器存在安全关联，所述第七网络数据包为IPsec流量；基于所述VPP框架，根据所述基于ESP协议和/或AH协议的封装方式、所述国家商用密码算法和与目的设备的约定密钥，封装所述第七网络数据包，所述国家商用密码为在所述硬件密码设备上实现；根据封装后的所述第七网络数据包的目的地址，基于所述VPP框架转发封装后的所述第七网络数据包。9.一种基于VPP的国标IPsec VPN实现方法，其特征在于，应用于Linux系统的服务器，包括：接收网络数据包，所述网络数据包的目的地址指示的接收设备与所述服务器存在安全关联，所述网络数据包为IPsec流量；基于所述VPP框架根据所述安全关联对应的封装方式、加密算法和密钥，封装所述网络数据包；所述安全关联对应的封装方式为基于ESP协议和/或AH协议的封装方式，所述安全关联对应的加密算法包括在硬件密码设备上实现的国家商用密码算法，所述硬件密码设备与所述服务器通信连接；根据封装后的所述网络数据包的目的地址，基于所述VPP框架转发封装后的所述网络数据包。10.一种基于VPP的国标IPsec VPN实现装置，其特征在于，所述装置包括：数据包接收单元、解封装单元；所述数据包接收单元，用于接收到第一发送设备发送的第一网络数据包，所述第一网络数据包为IPsec VPN数据包，所述发送设备与所述装置存在安全关联，所述第一网络数据包的目的地址指向所述装置，所述第一网络数据包的约定封装方式为基于ESP协议和/或AH协议的封装方式，所述第一网络数据包的约定加密算法为包括在硬件密码设备上实现的国家商用密码算法，所述硬件密码设备与所述装置通信连接，所述第一网络数据包对应的安全策略指示所述网络数据包为IPsec流量；所述解封装单元，用于基于VPP框架，按照所述约定封装方式、所述约定加密算法和约定密钥，对所述第一网络数据包解密和解封装，获得解封装数据包。11.一种基于VPP的国标IPsec VPN实现装置，其特征在于，所述装置包括：数据包接收单元、封装单元和转发单元；所述数据包接收单元，用于接收网络数据包，所述网络数据包的目的地址指示的接收设备与所述装置存在安全关联，所述网络数据包对应的安全策略指示所述网络数据包为IPsec流量；所述封装单元，用于基于所述VPP框架根据所述安全关联对应的封装方式、加密算法和密钥，封装所述网络数据包；所述安全关联对应的封装方式为基于ESP协议和/或AH协议的封装方式，所述安全关联对应的加密算法为包括在硬件密码设备上实现的国家商用密码算法，所述硬件密码设备与所述装置通信连接；所述转发单元，用于根据封装后的所述网络数据包的目的地址，基于所述VPP框架转发封装后的所述网络数据包。12.一种基于VPP的国标IPsec VPN实现系统，其特征在于，包括:发送设备、第一服务器、第二服务器和硬件密码设备；所述发送设备与所述第一服务器存在安全关联，所述第一服务器与所述第二服务器存在安全关联；所述第一服务器和所述第二服务器上搭载Linux系统；所述发送设备，用于基于VPP框架，向所述第一服务器发送原始网络数据包，所述原始网络数据包为IPsec流量；所述第一服务器，用于基于所述VPP框架，根据所述安全关联对应的约定封装方式、约定加密算法和约定密钥，封装所述原始网络数据包，得到第一网络数据包；以及，根据所述第一网络数据包的目的地址，基于所述VPP框架转发所述第一网络数据包至所述第二服务器；所述约定封装方式为基于ESP协议和/或AH协议的封装方式，所述约定加密算法包括在所述硬件密码设备上实现的国家商用密码算法；所述第二服务器，用于接收所述第一网络数据包，基于所述VPP框架，按照所述约定封装方式、所述约定加密算法和约定密钥，对所述第一网络数据包进行解密和解封装，获得解封装数据包。13.一种电子设备，其特征在于，包括处理器和存储器，所述存储器用于存储计算机指令，所述处理器用于从存储器中调用并运行所述计算机指令，实现权利要求1-9任一项所述的基于VPP的国标IPsec VPN实现方法。
说明书desc
技术领域本申请涉及网络安全领域，尤其涉及一种基于VPP的国标IPsec VPN实现方法、装置、系统及电子设备。背景技术IPsec作为一种开放标准的安全框架结构，可以用来保证IP数据报文在网络上传输的机密性、完整性和防重放。IPsec不是一个单独的协议，它通过AH和ESP这两个安全协议来实现IP数据报文的安全传送，再通过IKE协议提供密钥协商，建立和维护安全联盟/安全关联等服务。基于IPsec的IPsec VPN技术具有在网络层灵活透明部署的优势，是普遍使用的主流VPN技术之一。IPsecVPN体系结构主要由AH、ESP和IKE协议套件组成。通常，IPsec VPN可通过Linux内核协议栈和XFRM框架协同实现搭建。国密标准下，IPsec VPN需要使用国家商用密码进行加密和解密，比如IPsec VPN在安全连接建立阶段，需要调用国家商用密码中的SM2算法鉴别通信方身份与保护信息交换，但由于SM2运算基于GF下椭圆曲线点运算，涉及运算密集的大数运算，因此通过软件实现SM2算法复杂并且效率较低。又由于XFRM框架处理ESP报文或AH报文时，需调用Linux内核中注册的加密算法实现对报文的加密与解密，从而引起Linux内核的软中断。软中断期间不允许出现空等待时间，否则会导致内核崩溃，而调用硬件密码设备对报文进行加密和解密会出现空等待时间。因此，Linux内核协议栈和XFRM框架协同实现的IPsec VPN只能在软件层面实现部分国家商用密码算法，无法使用硬件密码设备对报文进行加密和解密。因此，如何在IPsec VPN中调用硬件密码设备实现国家商用密码算法成为亟待解决的技术问题。发明内容本申请提供一种基于VPP的国标IPsec VPN实现方法、装置、系统及电子设备，用于解决在IPsec VPN中调用硬件密码设备的问题。第一方面，本申请提供一种基于VPP的国标IPsec VPN实现方法，应用于Linux系统的服务器，该方法包括：接收到第一发送设备发送的第一网络数据包，第一发送设备与服务器存在安全关联，第一网络数据包为IPsec VPN数据包，第一网络数据包的目的地址指向服务器，第一网络数据包的约定封装方式为基于ESP协议和/或AH协议的封装方式，第一网络数据包的约定加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与服务器通信连接，第一网络数据包对应的安全策略指示网络数据包为IPsec流量；基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包。由上述技术方案可知，在本申请实施例提供的基于VPP的国标IPsec VPN实现方法中，本方法基于VPP框架，接收第一网络数据包，并对IPsec VPN传输的第一网络数据包进行解密和解封装。相比相近技术中，对数据包的解密和解封装都是通过Linux内核协议栈进行处理，但由于Linux内核协议栈处理数据包时存在软中断而无法调用硬件密码设备，本方法则将对数据包的解密和解封装放在了Linux内核协议栈外的VPP框架中进行处理，从而在实现IPsec VPN时可以调用硬件密码设备。在一种可能的实现方式中，在接收到第一发送设备发送的第一网络数据包之前，基于VPP的国标IPsec VPN实现方法还包括：接收到第一发送设备发送的第二网络数据包，第二网络数据包的目的地址指向服务器，第二网络数据包的目的端口指向预设端口；基于VPP框架，与第一发送设备基于网络密钥交换协议建立安全关联，并生成安全关联信息，安全关联信息包括约定封装方式、约定加密算法和约定密钥。在一种可能的实现方式中，基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包，包括：基于VPP框架，将第一网络数据包发送到硬件密码设备的待处理数据包队列；基于VPP框架，接收到硬件密码设备发送的解封装数据包，解封装数据包为硬件密码设备基于约定封装方式、约定加密算法和约定密钥对待处理数据包队列中的第一网络数据包进行解封装和解密获得。在一种可能的实现方式中，服务器的物理网口属于VPP框架所处的第一网络命名空间，服务器的Linux内核协议栈属于第二网络命名空间；第一网络命名空间还包括虚拟主机接口和第一虚拟以太网设备，虚拟主机接口与物理网口桥接，虚拟主机接口与第一虚拟以太网设备通信连接；第二网络命名空间还包括第二虚拟以太网设备，第一虚拟以太网设备和第二虚拟以太网设备通信连接。在一种可能的实现方式中，服务器的物理网口属于VPP框架所处的第一网络命名空间，服务器的Linux内核协议栈属于第二网络命名空间；方法还包括：在第一网络命名空间中创建虚拟主机接口，并基于VPP框架桥接虚拟主机接口与服务器的物理网口；在第一网络命名空间创建第一虚拟以太网设备，在第二网络命名空间创建第二虚拟以太网设备，第一虚拟以太网设备与虚拟主机接口通信连接，第二虚拟以太网设备与第一虚拟以太网设备通信连接。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法还包括：接收到第二发送设备发送的第三网络数据包，第三网络数据包指示的目的地址为第二虚拟以太网设备；在第三网络数据包指示的目的地址为第二虚拟以太网设备的情况下，基于服务器的物理网口、虚拟主机接口、第一虚拟以太网设备和第二虚拟以太网设备的通信连接，将第三网络数据包发送至第二虚拟以太网设备所属的第二网络命名空间中，并通过Linux内核协议栈转发给Linux系统对应的应用进行处理。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法还包括：接收到第三发送设备发送的第四网络数据包，第四网络数据包的目的地址指向服务器，第四网络数据包的封装方式为基于ESP协议和/或AH协议的封装方式，第三发送设备与服务器不存在安全关联；基于VPP框架，根据预设策略转发第四网络数据包。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法还包括：接收到第四发送设备发送的第五网络数据包，第五网络数据包为基于除约定封装方式封装以外的其他封装方式封装；基于VPP框架，将第五网络数据包转发至除IPsec VPN以外的虚拟网络的协议栈中处理。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，还包括：接收到第五发送设备发送的第六网络数据包，第六网络数据包的目的地址不指向服务器；基于VPP框架，根据第六网络数据包的目的地址，转发网络数据包。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，还包括：接收到第七网络数据包，第七网络数据包的目的地址指示的接收设备与服务器存在安全关联，第七网络数据包对应的安全策略指示第七网络数据包为IPsec流量；基于VPP框架，根据基于ESP协议和/或AH协议的封装方式和国家商用密码算法，封装第七网络数据包；根据封装后的第七网络数据包的目的地址，基于VPP框架转发封装后的第七网络数据包。第二方面，本申请提供一种基于VPP的国标IPsec VPN实现方法，应用于Linux系统的服务器，包括：接收网络数据包，网络数据包的目的地址指示的接收设备与服务器存在安全关联，网络数据包对应的安全策略指示网络数据包为IPsec流量；基于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装网络数据包；安全关联对应的封装方式为基于ESP协议和/或AH协议的封装方式，安全关联对应的加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与服务器通信连接；根据封装后的网络数据包的目的地址，基于VPP框架转发封装后的网络数据包。第三方面，本申请提供一种基于VPP的国标IPsec VPN实现装置，该基于VPP的国标IPsec VPN实现装置包括：数据包接收单元、解封装单元；数据包接收单元，用于接收到第一发送设备发送的第一网络数据包，发送设备与服务器存在安全关联，第一网络数据包为IPsec VPN数据包，第一网络数据包的目的地址指向服务器，第一网络数据包的约定封装方式为基于ESP协议和/或AH协议的封装方式，第一网络数据包的约定加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与服务器通信连接，第一网络数据包对应的安全策略指示网络数据包为IPsec流量；解封装单元，用于基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包。在一种可能的实现方式中， 基于VPP的国标IPsec VPN实现装置还包括信息约定单元，用于在接收到第一发送设备发送的第一网络数据包之前，接收到第一发送设备发送的第二网络数据包，第二网络数据包的目的地址指向服务器，第二网络数据包的目的端口指向预设端口；基于VPP框架，与第一发送设备基于网络密钥交换协议建立安全关联，并生成安全关联信息，安全关联信息包括约定封装方式、约定加密算法和约定密钥。在一种可能的实现方式中，解封装单元，具体用于基于VPP框架，将第一网络数据包发送到硬件密码设备的待处理数据包队列；基于VPP框架，接收到硬件密码设备发送的解封装数据包，解封装数据包为硬件密码设备基于约定封装方式、约定加密算法和约定密钥对待处理数据包队列中的第一网络数据包进行解封装和解密获得。在一种可能的实现方式中，装置的物理网口属于VPP框架所处的第一网络命名空间，装置的Linux内核协议栈属于第二网络命名空间；第一网络命名空间还包括虚拟主机接口和第一虚拟以太网设备，虚拟主机接口与物理网口桥接，虚拟主机接口与第一虚拟以太网设备通信连接；第二网络命名空间还包括第二虚拟以太网设备，第一虚拟以太网设备和第二虚拟以太网设备通信连接。在一种可能的实现方式中，数据包接收单元，还用于接收到第二发送设备发送的第三网络数据包，第三网络数据包指示的目的地址为第二虚拟以太网设备。基于VPP的国标IPsec VPN实现装置还包括转发单元，转发单元用于在第三网络数据包指示的目的地址为第二虚拟以太网设备的情况下，基于装置的物理网口、虚拟主机接口、第一虚拟以太网设备和第二虚拟以太网设备的通信连接，将第三网络数据包发送至第二虚拟以太网设备所属的第二网络命名空间中，并通过Linux内核协议栈转发给Linux系统对应的应用进行处理。在一种可能的实现方式中，数据包接收单元，还用于接收到第三发送设备发送的第四网络数据包，第四网络数据包的目的地址指向装置，第四网络数据包的封装方式为基于ESP协议和/或AH协议的封装方式，第三发送设备与装置不存在安全关联；转发单元，还用于基于VPP框架，根据预设策略转发第四网络数据包。在一种可能的实现方式中，数据包接收单元，还用于接收到第四发送设备发送的第五网络数据包，第五网络数据包为基于除约定封装方式封装以外的其他封装方式封装；基于VPP框架，将第五网络数据包转发至除IPsec VPN以外的虚拟网络的协议栈中处理。在一种可能的实现方式中，数据包接收单元，还用于接收到第五发送设备发送的第六网络数据包，第六网络数据包的目的地址不指向装置；转发单元，还用于基于VPP框架，根据第六网络数据包的目的地址，转发网络数据包。在一种可能的实现方式中，数据包接收单元，还用于接收到第七网络数据包，第七网络数据包的目的地址指示的接收设备与服务器存在安全关联，第七网络数据包对应的安全策略指示第七网络数据包为IPsec流量；基于VPP的国标IPsec VPN实现装置还包括封装单元，封装单元用于基于VPP框架，根据基于ESP协议和/或AH协议的封装方式和国家商用密码算法，封装第七网络数据包；转发单元，还用于根据封装后的第七网络数据包的目的地址，基于VPP框架转发封装后的第七网络数据包。第四方面，本申请提供一种基于VPP的国标IPsec VPN实现装置，包括：数据包接收单元、封装单元和转发单元；数据包接收单元，用于接收网络数据包，网络数据包的目的地址指示的接收设备与服务器存在安全关联，网络数据包对应的安全策略指示网络数据包为IPsec流量；封装单元，用于基于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装网络数据包；安全关联对应的封装方式为基于ESP协议和/或AH协议的封装方式，安全关联对应的加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与装置通信连接；转发单元，用于根据封装后的网络数据包的目的地址，基于VPP框架转发封装后的网络数据包。第五方面，本申请提供一种基于VPP的国标IPsec VPN实现系统，包括:发送设备、第一服务器、第二服务器和硬件密码设备；发送设备与第一服务器存在安全关联，第一服务器与第二服务器存在安全关联；第一服务器和第二服务器上搭载Linux系统；发送设备，用于基于VPP框架，向第一服务器发送原始网络数据包，原始网络数据包为IPsec流量；第一服务器，用于基于VPP框架，根据安全关联对应的约定封装方式、约定加密算法和约定密钥，封装原始网络数据包，得到第一网络数据包；以及，根据第一网络数据包的目的地址，基于VPP框架转发第一网络数据包至第二服务器；约定封装方式为基于ESP协议和/或AH协议的封装方式，约定加密算法包括在硬件密码设备上实现的国家商用密码算法；第二服务器，用于接收第一网络数据包，基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包。第六方面，本申请实施例提供一种电子设备，包括：存储器和处理器；存储器和处理器耦合；存储器用于存储计算机程序代码，计算机程序代码包括计算机指令；其中，当处理器执行计算机指令时，使得电子设备执行如第一方面及其任一种可能的设计方式的基于VPP的国标IPsec VPN实现方法。第七方面，本申请提供一种计算机可读存储介质，该计算机可读存储介质包括：计算机软件指令；当计算机软件指令在基于VPP的国标IPsec VPN实现装置中运行时，使得基于VPP的国标IPsec VPN实现装置实现上述第一方面的方法。第八方面，本申请提供一种计算机程序产品，当该计算机程序产品在基于VPP的国标IPsec VPN实现装置上运行时，使得基于VPP的国标IPsec VPN实现装置执行上述第一方面描述的相关方法的步骤，以实现上述第一方面的方法。上述第二方面至第八方面的有益效果可以参考第一方面的对应描述，不再赘述。附图说明图1为本申请提供的一种基于VPP的国标IPsec VPN实现系统的结构示意图；图2为本申请提供的一种基于VPP的国标IPsec VPN实现系统中服务器101和任意一个发送设备的计算装置硬件配置示意图；图3为本申请提供的一种基于VPP的国标IPsec VPN实现方法的流程示意图一；图4为本申请提供的一种基于VPP的国标IPsec VPN实现方法提供的网络数据包传输示意图；图5为本申请提供的一种基于VPP的国标IPsec VPN实现方法中网络数据包在VPP框架中处理的流程示意图一；图6为本申请提供的一种基于VPP的国标IPsec VPN实现方法中网络数据包在VPP框架中处理的流程示意图二；图7为本申请提供的一种基于VPP的国标IPsec VPN实现方法的服务器的网络结构图；图8为本申请提供的一种基于VPP的国标IPsec VPN实现方法的数据包处理流程图一；图9为本申请提供的一种基于VPP的国标IPsec VPN实现方法的数据包处理流程图二；图10为本申请提供的一种基于VPP的国标IPsec VPN实现方法的流程示意图二；图11为本申请提供的一种基于VPP的国标IPsec VPN实现装置的结构示意图一；图12为本申请提供的一种基于VPP的国标IPsec VPN实现装置的结构示意图二。具体实施方式下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。需要说明的是，本申请实施例中，“示例性地”或者“例如”等词用于表示作例子、例证或说明。本申请实施例中被描述为“示例性地”或者“例如”的任何实施例或设计方案不应被解释为比其它实施例或设计方案更优选或更具优势。确切而言，使用“示例性地”或者“例如”等词旨在以具体方式呈现相关概念。为了便于清楚描述本申请实施例的技术方案，在本申请的实施例中，采用了“第一”、“第二”等字样对功能和作用基本相同的相同项或相似项进行区分，本领域技术人员可以理解“第一”、“第二”等字样并不是在对数量和执行次序进行限定。由背景技术可知，IPsec VPN可通过Linux内核协议栈和XFRM框架协同实现搭建。但在国密标准下，IPsec VPN需要使用国家商用密码进行加密和解密，比如IPsecVPN在安全连接建立阶段，需要调用国家商用密码中的SM2算法鉴别通信方身份与保护信息交换，但由于SM2运算基于GF下椭圆曲线点运算，涉及运算密集的大数运算，因此通过软件实现SM2算法复杂并且效率较低。又由于XFRM框架处理ESP报文或AH报文时，需调用Linux内核中注册的加密算法实现对报文的加密与解密，从而会引起Linux内核的软中断，如果调用硬件密码设备对报文进行加密和解密，则会在软中断中出现空等待。软中断期间不允许出现空等待时间，否则会导致内核崩溃，而调用硬件密码设备对报文进行加密和解密会出现空等待时间。因此，Linux内核协议栈和XFRM框架协同实现的IPsec VPN只能在软件层面实现部分国家商用密码算法，无法使用硬件密码设备对报文进行加密和解密。针对该问题，本申请提供一种基于VPP的国标IPsec VPN实现方法、装置、系统及电子设备，用于解决在IPsec VPN中调用硬件密码设备的问题。在一种可能的实现方式中，本申请实施例提供一种基于VPP的国标IPsec VPN实现方法可应用于如图1所示的基于VPP的国标IPsec VPN实现系统中，该系统包括服务器101和多个发送设备，其中服务器101和多个发送设备通信连接。应理解，上述服务器101和发送设备的数量可以为多个，在图1中以一个服务器101和一个第一发送设备102为例，进行说明。服务器101可以接收到第一发送设备102发送的第一网络数据包，第一发送设备102与服务器101存在安全关联，第一网络数据包为IPsec VPN数据包，第一网络数据包的目的地址指向服务器101，第一网络数据包的约定封装方式为基于ESP协议和/或AH协议的封装方式，第一网络数据包的约定加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与服务器101通信连接，第一网络数据包对应的安全策略指示网络数据包为IPsec流量；基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包。在一种可能的实现方式中，服务器101可以在接收到第一发送设备102发送的第一网络数据包之前，接收到第一发送设备102发送的第二网络数据包，第二网络数据包的目的地址指向服务器101，第二网络数据包的目的端口指向预设端口；基于VPP框架，与第一发送设备102基于网络密钥交换协议建立安全关联，并生成安全关联信息，安全关联信息包括约定封装方式、约定加密算法和约定密钥。在一种可能的实现方式中，服务器101可以基于VPP框架，将第一网络数据包发送到硬件密码设备的待处理数据包队列；基于VPP框架，接收到硬件密码设备发送的解封装数据包，解封装数据包为硬件密码设备基于约定封装方式、约定加密算法和约定密钥对待处理数据包队列中的第一网络数据包进行解封装和解密获得。在一种可能的实现方式中，服务器101可以在第一网络命名空间中创建虚拟主机接口，并基于VPP框架桥接虚拟主机接口与服务器101的物理网口；在第一网络命名空间创建第一虚拟以太网设备，在第二网络命名空间创建第二虚拟以太网设备，第一虚拟以太网设备与虚拟主机接口通信连接，第二虚拟以太网设备与第一虚拟以太网设备通信连接。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现系统还包括一个第二发送设备。服务器101可以接收到第二发送设备发送的第三网络数据包，第三网络数据包指示的目的地址为第二虚拟以太网设备；在网络数据包指示的目的地址为第二虚拟以太网设备的情况下，基于服务器101的物理网口、虚拟主机接口、第一虚拟以太网设备和第二虚拟以太网设备的通信连接，将第三网络数据包发送至第二虚拟以太网设备所属的第二网络命名空间中，并通过Linux内核协议栈转发给Linux系统对应的应用进行处理。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现系统还包括一个第三发送设备。服务器101可以接收到第三发送设备发送的第四网络数据包，第四网络数据包的目的地址指向服务器101，第四网络数据包的封装方式为基于ESP协议和/或AH协议的封装方式，第三发送设备与服务器101不存在安全关联；基于VPP框架，根据预设策略转发第四网络数据包。在一种可能的实现方式中，服务器101可以在网络数据包为基于除约定封装方式封装以外的其他封装方式封装的情况下，基于VPP框架，将网络数据包转发至除IPsec VPN以外的虚拟网络的协议栈中处理。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现系统还包括一个第四发送设备。服务器101可以接收到第四发送设备发送的第五网络数据包，第五网络数据包的目的地址不指向服务器101；基于VPP框架，根据第五网络数据包的目的地址，转发网络数据包。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现系统还包括一个服务器101连接的子网中的设备。服务器101可以接收到第六网络数据包，第六网络数据包为服务器101连接的子网中的设备发送的网络数据包，第六网络数据包的目的地址指示的接收设备与服务器101存在安全关联，第六网络数据包对应的安全策略指示第六网络数据包为IPsec流量；基于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装第六网络数据包；根据封装后的第六网络数据包的目的地址，基于VPP框架转发封装后的第六网络数据包。应理解，上述第一发送设备102、第二发送设备、第三发送设备、第四发送设备和第五发送设备可能是不同的发送设备，其中两个发送设备也可能是同一个发送设备。上述服务器101和任意一个发送设备可以是台式电脑、平板电脑、笔记本电脑、手持计算机、可穿戴电子设备、手持计算机和超级移动个人计算机等电子设备，本申请实施例对此不做任何限制。本申请实施例中的服务器101和任意一个发送设备可以为如图2所示的计算装置，该计算装置包括处理器201，存储器202、通信接口203、总线204。处理器201，存储器202以及通信接口203之间可以通过总线204连接。处理器201是计算装置的控制中心，可以是一个处理器，也可以是多个处理元件的统称。例如，处理器201可以是一个通用中央处理单元，也可以是其他通用处理器等。其中，通用处理器可以是微处理器或者是任何常规的处理器等。作为一种实施例，处理器201可以包括一个或多个CPU，例如图2中所示的CPU 0和CPU 1。存储器202可以是只读存储器或可存储静态信息和指令的其他类型的静态存储设备，随机存取存储器或者可存储信息和指令的其他类型的动态存储设备，也可以是电可擦可编程只读存储器、磁盘存储介质或者其他磁存储设备、或者能够用于携带或存储具有指令或数据结构形式的期望的程序代码并能够由计算机存取的任何其他介质，但不限于此。一种可能的实现方式中，存储器202可以独立于处理器201存在，存储器202可以通过总线204与处理器201相连接，用于存储指令或者程序代码。处理器201调用并执行存储器202中存储的指令或程序代码时，能够实现本申请实施例提供的模型部署方法。在本申请实施例中，对于训练设备而言，存储器202中存储的软件程序不同，实现的功能不同。关于各设备所执行的功能将结合下面的流程图进行描述。另一种可能的实现方式中，存储器202也可以和处理器201集成在一起。通信接口203，用于计算装置与其他设备通过通信网络连接，所述通信网络可以是以太网，无线接入网，无线局域网等。通信接口203可以包括用于接收数据的接收单元，以及用于发送数据的发送单元。总线204，可以是工业标准体系结构总线、外部设备互连总线或扩展工业标准体系结构总线等。该总线可以分为地址总线、数据总线、控制总线等。为便于表示，图2中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。需要指出的是，图2中示出的结构并不构成对该计算装置的限定，除图2所示部件之外，该计算装置可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。本申请提出一种基于VPP的国标IPsec VPN实现方法，可应用于如图2所示的计算装置，如图3所示，本方法实施例的基于VPP的国标IPsec VPN实现方法可以包括S101至S102。S101，接收到第一发送设备发送的第一网络数据包。其中，第一发送设备与服务器存在安全关联，第一网络数据包为IPsec VPN数据包，第一网络数据包的目的地址指向服务器，第一网络数据包的约定封装方式为基于ESP协议和/或AH协议的封装方式，第一网络数据包的约定加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与服务器通信连接，第一网络数据包对应的安全策略指示网络数据包为IPsec流量。IPsec是一种基于网络层与应用密码学的安全通信协议族，是一种实现VPN的技术之一。IPsec保护的是点对点的通信，例如主机与主机、主机和网关之间的通信，其工作在IP层，对IP层的数据包进行加密和验证。通信双方通过IPsec建立一条IPsec隧道，IP数据包通过IPsec隧道进行加密传输，有效保证了数据在不安全的网络环境如Internet中传输的安全性。在IPsec VPN通信流程中重要的三个协议为IKE协议、AH 协议和ESP协议。在IPsec VPN中任意两点，例如第一实体和第二实体之间真正进行荷载数据的传输之前，第一实体和第二实体会通过IKE协议建立安全关联，并生成至少一个SA参数，一个SA参数由3个参数唯一决定，包括安全参数索引、源/目的IP地址和安全协议标志。约定好的SA参数可在第一实体和第二实体在IPsec VPN通信期间用于加解密和认证数据。由于SA参数中源/目的IP地址固定，不可逆反，因此一个SA参数只能支持一个单向通信，双向通信则可能生成一对SA参数。除此之外，在IKE协议阶段中，第一实体和第二实体还会约定通信时的加密算法和密钥。当然，通过IKE协议，第一实体和第二实体还可能进行更多的信息约定，以进一步保证IPsec VPN通信期间的数据安全，本申请对此不做具体描述和限定。以本申请中的服务器和第一发送设备为点对点的两个对等通信主体的通信为例，第一发送设备与服务器存在安全关联，第一网络数据包的约定封装方式即为对应在安全关联中安全协议标志的基于ESP协议和/或AH协议的封装方式，第一网络数据包的约定加密算法和约定密钥，即对应于上述第一实体和第二实体在IKE协议阶段中还会约定的通信时的加密算法和密钥。除此之外，IPsec VPN中的通信实体接收到数据包后，通信实体会根据安全策略管理数据包流量通过IPsec 边界时的策略。例如，对于入站流量，会先根据IP首部协议字段判断网络数据包是未经保护的网络数据包，还是经过 ESP/AH 协议保护的IPsec流量。只有是IPsec流量的数据包，才能进一步查询两个通信实体之间的SA，从而根据SA参数进行相应的处理。可见，在S101中这样的第一网络数据包是发送设备通过IPsec VPN发送给服务器，需要经过IPsec VPN处理的数据包。S102，基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包。上述VPP框架是一个可扩展的开源框架，提供开箱即用的网络交换机或路由器的功能，支持很多标准的网络功能。VPP也被称作高性能网络数据平面，旨在为网络功能虚拟化、SD-WAN、边缘路由器等应用场景提供强大的网络数据处理能力。VPP框架对插件的支持，也扩充了其可实现的功能。可见，VPP框架可以用于构建任何类型的数据包处理应用，比如负载均衡、防火墙、IDS、主机栈。因此，VPP框架可替代Linux内核协议栈，尤其是网络协议栈中的功能，例如通过网络对数据包的接收、转发、解封装等功能。因此，基于VPP框架可实现根据第一网络数据包的安全关联对应的约定封装方式、约定加密算法和约定密钥，对第一网络数据包解密和解封装，获得解封装数据包。由上述技术方案可知，在本申请实施例提供的基于VPP的国标IPsec VPN实现方法中，本方法接收IPsec VPN中的第一网络数据包，并基于VPP框架对IPsec VPN传输的第一网络数据包进行解密和解封装。相比相近技术中，对数据包的解密和解封装都是通过Linux内核协议栈进行处理，但由于Linux内核协议栈处理数据包时存在软中断而无法调用硬件密码设备，本方法则将对数据包的解密和解封装放在了Linux内核协议栈外的VPP框架中进行处理，从而在实现IPsec VPN时可以调用硬件密码设备。在一种可能的实现方式中，在接收到第一发送设备发送的第一网络数据包之前，方法还包括：接收到第一发送设备发送的第二网络数据包，第二网络数据包的目的地址指向服务器，第二网络数据包的目的端口指向预设端口。基于VPP框架，与第一发送设备基于网络密钥交换协议建立安全关联，并生成安全关联信息，安全关联信息包括约定封装方式、约定加密算法和约定密钥。应理解，IPsec中IKE阶段，通信实体可通过固定端口，例如端口号为500的端口接收IKE阶段中的协商数据包。在传输路径中存在NAT的情况下，也可以通过端口号为4500的端口接收IKE阶段中的协商数据包。上述预设端口即指上述端口号为500的端口或者端口号为4500的端口这样预设的端口，一般发送至该端口的数据包即为IKE阶段的协商数据包，可用于建立安全关联，并交换安全关联信息。建立安全关联的流程可基于VPP框架实现，安全关联信息的SAD也可由VPP框架进行管理。例如，如图4所示，服务器可通过端口号为500的端口接收到第一发送设备发送的第二网络数据包，通过Unix Socket处理第二网络数据包。如，服务器将第二网络数据包发送给IKE软件，调用硬件密码设备的算法接口，生成服务器与第一发送设备之间的约定密钥。又例如，如图4所示，服务器要与第一发送设备建立由服务器至第一发送设备之间的安全关联，则可通过IKE软件生成IKE协商报文，并通过Punt套接字将其发送至VPP框架中，VPP框架则会将IKE协商报文从绑定的发送网口发送给第一发送设备。在一种可能的实现方式中，基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包，包括：基于VPP框架，将第一网络数据包发送至硬件密码设备；接收到硬件密码设备发送的解封装数据包，解封装数据包为硬件密码设备基于约定封装方式、约定加密算法和约定密钥对待处理数据包队列中的第一网络数据包进行解封装和解密获得。由上述技术方案可知，由图4可见，在本实施例提供的基于VPP的国标IPsec VPN实现方法中，网络数据包的处理并不经过Linux内核协议栈，相比相近技术中，IKE协商需要通过Linux内核协议栈进行，本方法中的IPsec VPN的SAD也由VPP框架进行管理，因此本方法在后续IPsec VPN的通信过程中也可仅基于VPP框架进行处理。由于本方法的实现不需要通过Linux内核协议栈，因此也不需要因数据包的处理需求和修改Linux内核协议栈的源码，方便应用于各种版本的Linux系统中。在一种可能的实现方式中，基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包，包括：基于VPP框架，将第一网络数据包发送给硬件密码设备。接收到硬件密码设备发送的解封装数据包，解封装数据包为硬件密码设备基于约定封装方式、约定加密算法和约定密钥对待处理数据包队列中的第一网络数据包进行解封装和解密获得。VPP框架中node节点是数据包的处理流程，数据包在不同节点之间流动进行处理，VPP框架中包括三种节点，Internal节点、Process节点及Input节点。如图5所示，即为第一网络数据包的在VPP框架中各个节点中的处理流程。先通过数据包获取节点获取数据包，进一步的，数据包将进入数据包处理判断节点，即Esp4-Encrypt-Tun，Esp4-Encrypt-Tun是VPP框架的IPsec数据面处理的Graph Node，可判断数据包是否需要处理。在数据包需要处理的情况下，它将对接收到的网络数据进行SA查表，并将SA中预存的crypto key索引号连同要加密的数据指针和长度一起提交给加密算法的缺省处理函数进行加密。其中，SA查找节点即为对第一网络数据包进行SA查表，在找到第一网络数据包对应的SA后，第一网络数据包和SA中的结果都送入加密处理节点、VPP加密实例节点和硬件加密节点中进行处理，在加密结束后原路返回至加密处理节点，并传输至输出节点输出。处理失败的数据包则会由丢弃节点节点丢弃。在数据包无需被加密时，数据包处理判断节点会通过输出节点将数据包输出。在一种可能的实现方式中，基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包，包括：基于VPP框架，将第一网络数据包发送到硬件密码设备的待处理数据包队列。基于VPP框架，接收到硬件密码设备发送的解封装数据包，解封装数据包为硬件密码设备基于约定封装方式、约定加密算法和约定密钥对待处理数据包队列中的第一网络数据包进行解封装和解密获得。如图6所示，在通过SA查找节点处理之后，加密队列节点为将数据包放入硬件密码设备的待处理数据包队列，在通过注册加密实例注册加密算法接口后，即可使用加密算法的接口，调用硬件密码设备中的加密算法。硬件密码设备会将需要加密的数据包进行和SA对应的加密处理，并调用回调节点将加密处理后的数据包通过数据包返发节点返回，通过输出节点将加密处理后的数据包输出。由上述实施例可知，由于本实施例提供的基于VPP的国标IPsec VPN实现方法中，数据包是放入队列后，由Handware即硬件密码设备进行处理，并且处理过程中无需等待待处理的数据包返回，属于异步处理的流程，因此能够提升数据包的处理效率。在一种可能的实现方式中，服务器的物理网口属于VPP框架所处的第一网络命名空间，服务器的Linux内核协议栈属于第二网络命名空间。第一网络命名空间还包括虚拟主机接口和第一虚拟以太网设备，虚拟主机接口与物理网口桥接，虚拟主机接口与第一虚拟以太网设备通信连接。第二网络命名空间还包括第二虚拟以太网设备，第一虚拟以太网设备和第二虚拟以太网设备通信连接。应理解，网络命名空间是为了隔离网络设备和协议栈的，所有网络设备都只能属于一个命名空间，虚拟网络设备则可以被关联到指定的命名空间中。Veth是一对虚拟以太网设备，一对veth设备通过一个虚拟链路连接在一起。它们通常用于创建类似网桥或隧道的网络拓扑结构。其中一个设备可以被看作是虚拟机或容器的网络接口，另一个设备则连接到主机的网络栈。由于VPP框架和Linux内核协议栈分属两个网络命名空间，而VPP框架基于IPsecVPN的需要，会占用服务器的物理网口。那么，对于第二网络命名空间中的Linux内核协议栈，以及Linux系统对应的上层应用，无法直接通过网络连接获得对应的网络数据包，因此通过建立物理网口、虚拟主机接口、第一虚拟以太网设备和第二虚拟以太网设备，这样分属两个网络命名空间中的接口通信连接，从而使属于第二网络命名空间中的Linux内核协议栈以及Linux系统对应的上层应用，也能够通过这样的连接传输线路获得网络数据包。如图7所示，服务器的两个物理网口，物理网口GR1和物理网口GR2都属于VPP框架所处的第一网络命名空间，服务器的内核协议栈和上层应用属于第二网络命名空间。图7还包括第一虚拟以太网设备，第二虚拟以太网设备，以及虚拟主机接口。其中，物理网口GR1为接收数据网口，物理网口GR2为发送数据网口，对应的网络1和网络2分别可以是子网或者公网中的任一个。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，服务器的物理网口属于VPP框架所处的第一网络命名空间，服务器的Linux内核协议栈属于第二网络命名空间。方法还包括：在第一网络命名空间中创建虚拟主机接口，并基于VPP框架桥接虚拟主机接口与服务器的物理网口。在第一网络命名空间创建第一虚拟以太网设备，在第二网络命名空间创建第二虚拟以太网设备，第一虚拟以太网设备与虚拟主机接口通信连接，第二虚拟以太网设备与第一虚拟以太网设备通信连接。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，还包括：接收到第二发送设备发送的第三网络数据包，第三网络数据包指示的目的地址为第二虚拟以太网设备。在第三网络数据包指示的目的地址为第二虚拟以太网设备的情况下，基于服务器的物理网口、虚拟主机接口、第一虚拟以太网设备和第二虚拟以太网设备的通信连接，将第三网络数据包发送至第二虚拟以太网设备所属的第二网络命名空间中，并通过Linux内核协议栈转发给Linux系统对应的应用进行处理。可知，在第三网络数据包指示的目的地址为第二虚拟以太网设备的情况下，表征该第三网络数据包为Linux内核协议栈或者Linux上层应用需要接收的数据包。延用上述实施例以及图7的示意图，在接收数据的网口物理网口GR1接收到第三网络数据包后，可以通过VPP桥接域将数据包通过虚拟主机接口，和第一虚拟以太网设备以及第二虚拟以太网设备之间的通信连接，将第三网络数据包发送至第二网络命名空间，从而Linux内核协议栈或者Linux上层应用可以接收到对应的第三网络数据包。由上述实施例可知，本申请提供的基于VPP的国标IPsec VPN实现方法，在VPP框架占用服务器的网口的情况下，通过本申请实施例的方式，能够不影响Linux内核协议栈以及Linux系统的上层应用的网络功能的正常使用，在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，还包括：接收到第三发送设备发送的第四网络数据包，第四网络数据包的目的地址指向服务器，第四网络数据包的封装方式为基于ESP协议和/或AH协议的封装方式，第三发送设备与服务器不存在安全关联。基于VPP框架，根据预设策略转发第四网络数据包。应理解，在网络传输中接收到的数据包，可基于转发策略对符合条件的数据包进行转发。例如，可在服务器中设置预设策略，预设策略为对封装方式为基于ESP协议和/或AH协议的封装方式，但是数据包的发送设备与服务器并不存在安全管理的情况下，基于VPP框架，将该数据包转发至服务器的其他端口，或者转发至另一个服务器。在上述技术方案中，由于在数据包是通过ESP协议和/或AH协议的封装方式的情况下，该数据包通常为IPsec流量的数据包，但是第四网络数据包虽然基于ESP协议和/或AH协议的封装方式进行封装，但是发送的第四网络数据包的第三发送设备与服务器不存在安全关联，那么该数据包并不符合通过被服务器接收并通过IPsec VPN处理的条件，那么通常可以将这样的第四网络数据包丢弃，或者根据预设策略进行转发。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，还包括：接收到第四发送设备发送的第五网络数据包，第五网络数据包为基于除约定封装方式封装以外的其他封装方式封装。基于VPP框架，将第五网络数据包转发至除IPsec VPN以外的虚拟网络的协议栈中处理。由于服务器中还可能存在其他虚拟网络的协议栈，而IPsec VPN只会以ESP协议和/或AH协议进行封装，因此在接收到以其他方式进行封装的第五网络数据包时，可将第五网络数据包转发至对应的其他的协议栈中进行对应的处理。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，还包括：接收到第五发送设备发送的第六网络数据包，第六网络数据包的目的地址不指向服务器。基于VPP框架，根据第六网络数据包的目的地址，转发网络数据包。根据上述实施例，可得到在VPP的国标IPsec VPN实现方法中，对于不同的数据包的处理可以如图8所示。在一种可能的实现方式中，基于VPP的国标IPsec VPN实现方法，还包括：接收到第七网络数据包，第七网络数据包的目的地址指示的接收设备与服务器存在安全关联，第七网络数据包对应的安全策略指示第七网络数据包为IPsec流量；基于VPP框架，根据基于ESP协议和/或AH协议的封装方式和国家商用密码算法，封装第七网络数据包；根据封装后的第七网络数据包的目的地址，基于VPP框架转发封装后的第七网络数据包。根据上述实施例，可得到在VPP的国标IPsec VPN实现方法中，对于封装数据包的处理可以如图9所示。在数据包为第七网络数据包的情况下，即该数据包的目的地址指示的接收设备与服务器存在安全关联，对应的安全策略指示第七网络数据包为IPsec流量，服务器则会基于VPP框架，根据安全关联对应的封装方式、加密算法和密钥，以ESP协议和/或AH协议的封装方式对数据包进行封装，以及调用密码算法接口对数据包进行加密。在数据包不为第七数据包的情况下，如数据包不为IPsec流量，那么可根据数据包的路由转发对数据包进行路由。例如，在数据包指向第一虚拟以太网设备的情况下，该数据包数据服务器的Linux上层应用的数据包，因此应将该数据包发送至Linux内核协议栈中。在数据包没有指向任何地址的情况下，可将该数据包丢弃。在数据包指向其他路由地址的情况下，可将数据包根据路由地址进行转发。进一步的，如果数据包属于IPsec流量，但其指向的目标地址于服务器不存在安全关联和安全策略，那么该数据包也不是第七网络数据包，则可被丢弃，或者通过预设好的转发策略进行转发。在另一种可能的实现方式中，本申请提出另一种基于VPP的国标IPsec VPN实现方法，包括下述S201至S203，如图10所示。S201，接收网络数据包。其中，网络数据包的目的地址指示的接收设备与服务器存在安全关联，网络数据包对应的安全策略指示网络数据包为IPsec流量。S202，基于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装网络数据包。其中，安全关联对应的约定封装方式为基于ESP协议和/或AH协议的封装方式，安全关联对应的加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与服务器通信连接。应理解，由于网络数据包的目的地址指示的接收设备与服务器存在安全关联，网络数据包对应的安全策略指示网络数据包为IPsec流量，因此该网络数据包为应当经过IPsec VPN处理，发送至接收设备的数据包。而安全关联在建立时期，通常还会约定封装方式、加密算法和密钥，服务器即可基于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装网络数据包。S203，根据封装后的网络数据包的目的地址，基于VPP框架转发封装后的网络数据包。由上述技术方案可知，本申请通过判断网络数据包的目的地址指示的接收设备是否与服务器存在安全关联，网络数据包对应的安全策略是否指示网络数据包为IPsec流量。确定网络数据包是否需要经过IPsec VPN处理，发送至接收设备的数据包后，在确定网络数据包为需要经过IPsec VPN处理时，则会基于于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装网络数据包，并根据封装后的网络数据包的目的地址，基于VPP框架转发封装后的网络数据包。可见，在该过程中，本方法不需要经过Linux内核，而可以基于VPP框架完成操作，因此避免了Linux内核协议栈处理数据包时存在软中断而无法调用硬件密码设备的问题，本方法可调用硬件密码设备对网络数据包进行加密。在一种可能的实施例中，本申请提供一种基于VPP的国标IPsec VPN实现装置，如图11所示，该基于VPP的国标IPsec VPN实现装置包括：数据包接收单元301，用于接收到第一发送设备发送的第一网络数据包，发送设备与服务器存在安全关联，第一网络数据包的目的地址指向服务器，第一网络数据包的约定封装方式为基于ESP协议和/或AH协议的封装方式，第一网络数据包的约定加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与装置通信连接，第一网络数据包对应的安全策略指示网络数据包为IPsec流量。解封装单元302，用于基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包。在一种可能的实现方式中， 基于VPP的国标IPsec VPN实现装置还包括信息约定单元，用于在接收到第一发送设备发送的第一网络数据包之前，接收到第一发送设备发送的第二网络数据包，第二网络数据包的目的地址指向服务器，第二网络数据包的目的端口指向预设端口；基于VPP框架，与第一发送设备基于网络密钥交换协议建立安全关联，并生成安全关联信息，安全关联信息包括约定封装方式、约定加密算法和约定密钥。在一种可能的实现方式中，解封装单元302，具体用于基于VPP框架，将第一网络数据包发送到硬件密码设备的待处理数据包队列；基于VPP框架，接收到硬件密码设备发送的解封装数据包，解封装数据包为硬件密码设备基于约定封装方式、约定加密算法和约定密钥对待处理数据包队列中的第一网络数据包进行解封装和解密获得。在一种可能的实现方式中，装置的物理网口属于VPP框架所处的第一网络命名空间，装置的Linux内核协议栈属于第二网络命名空间；第一网络命名空间还包括虚拟主机接口和第一虚拟以太网设备，虚拟主机接口与物理网口桥接，虚拟主机接口与第一虚拟以太网设备通信连接；第二网络命名空间还包括第二虚拟以太网设备，第一虚拟以太网设备和第二虚拟以太网设备通信连接。在一种可能的实现方式中，数据包接收单元301，还用于接收到第二发送设备发送的第三网络数据包，第三网络数据包指示的目的地址为第二虚拟以太网设备。基于VPP的国标IPsec VPN实现装置还包括转发单元，转发单元用于在第三网络数据包指示的目的地址为第二虚拟以太网设备的情况下，基于装置的物理网口、虚拟主机接口、第一虚拟以太网设备和第二虚拟以太网设备的通信连接，将第三网络数据包发送至第二虚拟以太网设备所属的第二网络命名空间中，并通过Linux内核协议栈转发给Linux系统对应的应用进行处理。在一种可能的实现方式中，数据包接收单元301，还用于接收到第三发送设备发送的第四网络数据包，第四网络数据包的目的地址指向装置，第四网络数据包的封装方式为基于ESP协议和/或AH协议的封装方式，第三发送设备与装置不存在安全关联；转发单元，还用于基于VPP框架，根据预设策略转发第四网络数据包。在一种可能的实现方式中，数据包接收单元301，还用于接收到第四发送设备发送的第五网络数据包，第五网络数据包为基于除约定封装方式封装以外的其他封装方式封装；基于VPP框架，将第五网络数据包转发至除IPsec VPN以外的虚拟网络的协议栈中处理。在一种可能的实现方式中，数据包接收单元301，还用于接收到第五发送设备发送的第六网络数据包，第六网络数据包的目的地址不指向装置；转发单元，还用于基于VPP框架，根据第六网络数据包的目的地址，转发网络数据包。在一种可能的实现方式中，数据包接收单元301，还用于接收到第七网络数据包，第七网络数据包的目的地址指示的接收设备与服务器存在安全关联，第七网络数据包对应的安全策略指示第七网络数据包为IPsec流量；基于VPP的国标IPsec VPN实现装置还包括封装单元，封装单元用于基于VPP框架，根据基于ESP协议和/或AH协议的封装方式和国家商用密码算法，封装第七网络数据包；转发单元，还用于根据封装后的第七网络数据包的目的地址，基于VPP框架转发封装后的第七网络数据包。在另一种可能的实施例中，如图12所示，本申请提供一种基于VPP的国标IPsecVPN实现装置，装置包括：数据包接收单元401、封装单元402和转发单元403。数据包接收单元401，用于接收网络数据包，网络数据包的目的地址指示的接收设备与服务器存在安全关联，网络数据包对应的安全策略指示网络数据包为IPsec流量。封装单元402，用于基于VPP框架根据安全关联对应的封装方式、加密算法和密钥，封装网络数据包；安全关联对应的封装方式为基于ESP协议和/或AH协议的封装方式，安全关联对应的加密算法为包括在硬件密码设备上实现的国家商用密码算法，硬件密码设备与装置通信连接。转发单元403，用于根据封装后的网络数据包的目的地址，基于VPP框架转发封装后的网络数据包。在一种可能的实现方式中，本申请还提供一种基于VPP的国标IPsec VPN实现系统，包括:发送设备、第一服务器、第二服务器和硬件密码设备；发送设备与第一服务器存在安全关联，第一服务器与第二服务器存在安全关联；第一服务器和第二服务器上搭载Linux系统。发送设备，用于基于VPP框架，向第一服务器发送原始网络数据包，原始网络数据包为IPsec流量。第一服务器，用于基于VPP框架，根据安全关联对应的约定封装方式、约定加密算法和约定密钥，封装原始网络数据包，得到第一网络数据包；以及，根据第一网络数据包的目的地址，基于VPP框架转发第一网络数据包至第二服务器；约定封装方式为基于ESP协议和/或AH协议的封装方式，约定加密算法包括在硬件密码设备上实现的国家商用密码算法。第二服务器，用于接收第一网络数据包，基于VPP框架，按照约定封装方式、约定加密算法和约定密钥，对第一网络数据包进行解密和解封装，获得解封装数据包。通过以上的实施方式的描述，所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，仅以上述各功能模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将基于VPP的国标IPsec VPN实现装置的内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能。本申请实施例还提供了一种计算机可读存储介质。上述方法实施例中的全部或者部分流程可以由计算机指令来指示相关的硬件完成，该程序可存储于上述计算机可读存储介质中，该程序在执行时，可包括如上述各方法实施例的流程。计算机可读存储介质可以是前述任一实施例的或内存。上述计算机可读存储介质也可以是上述基于VPP的国标IPsecVPN实现装置的外部存储设备，例如上述基于VPP的国标IPsec VPN实现装置上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，上述计算机可读存储介质还可以既包括上述基于VPP的国标IPsec VPN实现装置的内部存储单元也包括外部存储设备。上述计算机可读存储介质用于存储上述计算机程序以及上述基于VPP的国标IPsec VPN实现装置所需的其他程序和数据。上述计算机可读存储介质还可以用于暂时地存储已经输出或者将要输出的数据。本申请实施例还提供一种计算机程序产品，该计算机产品包含计算机程序，当该计算机程序产品在计算机上运行时，使得该计算机执行上述实施例中所提供的任一项基于VPP的国标IPsec VPN实现方法。尽管在此结合各实施例对本申请进行了描述，然而，在实施所要求保护的本申请过程中，本领域技术人员通过查看附图、公开内容、以及所附权利要求书，可理解并实现公开实施例的其他变化。在权利要求中，“包括”一词不排除其他组成部分或步骤，“一”或“一个”不排除多个的情况。单个处理器或其他单元可以实现权利要求中列举的若干项功能。相互不同的从属权利要求中记载了某些措施，但这并不表示这些措施不能组合起来产生良好的效果。尽管结合具体特征及其实施例对本申请进行了描述，显而易见的，在不脱离本申请的精神和范围的情况下，可对其进行各种修改和组合。相应地，本说明书和附图仅仅是所附权利要求所界定的本申请的示例性说明，且视为已覆盖本申请范围内的任意和所有修改、变化、组合或等同物。显然，本领域的技术人员可以对本申请进行各种改动和变型而不脱离本申请的精神和范围。这样，倘若本申请的这些修改和变型属于本申请权利要求及其等同技术的范围之内，则本申请也意图包含这些改动和变型在内。以上，仅为本申请的具体实施方式，但本申请的保护范围并不局限于此，任何在本申请揭露的技术范围内的变化或替换，都应涵盖在本申请的保护范围之内。因此，本申请的保护范围应该以权利要求的保护范围为准。
