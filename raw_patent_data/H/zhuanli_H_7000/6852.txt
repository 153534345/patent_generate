标题title
一种基于模型预测控制的配电网实时碳排放优化控制方法
摘要abst
本发明公开了一种基于模型预测控制的配电网实时碳排放优化控制方法。属于电力系统需求响应技术领域。包括以下步骤：首先构建计及用户舒适度约束的配电网柔性负荷模型；其次，基于模型预测方法协调不同类型柔性的负荷优化周期与控制周期；接着，根据台区变压器处的实时能源占比构建配电网碳中和因子；然后，基于碳中和因子与模型预测方法，构建配电网实时碳排放优化模型；最后，基于滚动优化的思想，利用实时的启发式算法进行优化问题的求解，对柔性负荷进行控制。本发明可在碳达峰碳中和的目标前景下，充分利用电力系统中负荷侧的需求响应资源，实现配电网实时碳排放优化控制，推动双碳政策在配电网中的落地，具有重要学术意义和工程实用价值。
权利要求书clms
1.一种基于模型预测控制的配电网实时碳排放优化控制方法，其特征在于，包括以下步骤：S1：构建计及用户舒适度约束的配电网柔性负荷模型；S2：基于模型预测方法协调不同类型柔性的负荷优化周期与控制周期；S3：根据台区变压器处的实时能源占比构建配电网碳中和因子；S4：基于碳中和因子与模型预测方法，构建配电网实时碳排放优化模型；S5：基于滚动优化的思想，利用实时的启发式算法进行优化问题的求解，对柔性负荷进行控制。2.根据权利要求1所述的一种基于模型预测控制的配电网实时碳排放优化控制方法，其特征在于，所述步骤S1具体为：构建电动汽车负荷模型如下：E＝E+Pc·ηc-Pd/ηd-EroadEroad＝0,t∈Emin≤E≤Emax0≤Pc≤Pmax0≤Pd≤Pmax式中，E为电动汽车t时刻能量，Pc与Pd分别为t时刻的电动汽车充放电功率，ηc与ηd分别为电动汽车充放电效率，Eroad为电动汽车在t时刻在行驶中消耗的能量，在充电时间窗内Eroad为0，Emin与Emax是电动汽车能量的最小最大值约束，Pmax为电动汽车充放电功率最大值约束；构建电动汽车用户舒适度约束条件如下：E≥Eroadsum其中，E指电动汽车在用户规定的结束充电时刻的能量，其必须大于第d天在路上行驶所需的能量Eroadsum，且其与用户出行习惯有关，服从均匀分布，受最小出行所需能量与最大出行能量/＞约束，电动汽车的决策变量为Pc与Pd；构建计及用户舒适度的空调负荷模型如下：Tin＝γTin-*s*COP*R*Pac+)Tout+ω0≤Pac≤Pacmax式中，Tin与Tout分别为t时刻的室内及室外温度，COP为空调能效系数，Pac为空调在t时刻的功率，其受空调最大功率Pacmax约束，ω为由于建筑墙体材料热传导导致的室内温度温差，γ为空调制冷时延系数，其由空调等效热阻R与等效热容C决定，s为空调用户舒适度系数：式中，Tset为空调温度设定值，ζ为空调温度上下浮动容忍值，这两个数值反映用户舒适度，只有当室外温度高于最高容忍温度空调才会启动，反之当温度下降到最低容忍温度时空调就会关闭，空调的决策变量为Tset。3.根据权利要求2所述的一种基于模型预测控制的配电网实时碳排放优化控制方法，其特征在于，所述步骤S2具体为：基于模型预测方法控制电动汽车与空调两类负荷，模型预测方法与控制周期与优化周期的概念如下：模型预测方法：空调的优化周期为1小时，控制周期为5分钟；1)以优化周期1进行优化计算一次，获取共计60分钟/5分钟＝12个控制周期的决策变量结果，仅选取控制周期1的决策变量结果对电动汽车与空调进行控制；2)时间窗向后移动15分钟，以优化周期2进行优化计算一次，仅选取控制周期2的决策变量结果对电动汽车与空调进行控制；3)重复上述步骤直到最后；由于电动汽车与空调的控制成本及数据传输速率不同，因此两种负荷的控制周期与优化周期不同，然而使用模型预测控制算法时需要协调这两类负荷的控制周期与优化周期，即两者的控制周期与优化周期相同，否则两类负荷的用户舒适度条件与模型运行条件无法被同时满足，空调1h优化周期、5min控制周期与电动汽车3h优化周期、15min控制周期，说明提出的优化周期与控制周期协调方法：1)优化周期统一为两类负荷优化周期较短的数值，即为1h；2)控制周期统一为两类负荷控制周期较短的数值，即为5min，为减少运算量，将电动汽车原控制周期15min的初始决策变量直接拓展为3个5min的决策变量，即若原始决策变量为，那么新的决策变量为，即将电动汽车15min内的充电功率拓展为每隔5min都是，那么拓展前后15min内的总充电能量是不变的，Pc1*15min＝Pc1*；此处直接拓展的原因是因为后续要采用遗传算法，是一种启发式算法，即先生成随机解再寻优，由于电动汽车决策变量较复杂，因此采用此种决策变量拓展方法，相当于以原先的15min控制周期变量维度，即1h内共有4个决策变量点，生成了5min控制周期变量维度，即1h内共有12个决策变量点，即将4个决策变量生成12个决策变量，而并不增加模型的复杂程度，也不影响模型的计算精度；电动汽车在时段内，需恢复优化周期为3h，控制周期不改变依旧与空调的5min控制周期保持一致；原因是需要满足用户的出行需求，即在最大充电功率Pmax前提下保证到充电结束te时刻的能量大于出行能量需求与最小能量之和Eroadsum+Emin，同时空调也需要和电动汽车保持一样的优化周期为3h。4.根据权利要求3所述的一种基于模型预测控制的配电网实时碳排放优化控制方法，其特征在于，所述步骤S3具体为：ratioi为该时刻的能源i占比，i属于火电TP，光伏PV，风电WP，核电NP，水电HP里的一种，θi为该能源的电碳因子：式中，CEi是单位重量该能源发电所产生的碳排放量，Ei是单位重量该能源的发电量；θi越高表示在发电量相等的前提下，该能源产生的碳排放量越大；因此碳中和因子C表示该时刻配电网内的能源的清洁程度，其值越小，表示该时刻整个台区变压器下产生的碳排放量越少。5.根据权利要求4所述的一种基于模型预测控制的配电网实时碳排放优化控制方法，其特征在于，所述步骤S4具体为：min C*Ps.t.E＝E+Pc·ηc-Pd/ηd-EroadEroad＝0,t∈Emin≤E≤Emax0≤Pc≤Pmax0≤Pd≤PmaxE≥EroadsumTin＝γTin-*s*COP*R*Pac+)Tout+ω该优化模型的目的是最小化配电网实时碳排放量，约束条件包括电动汽车的运行条件约束、电动汽车用户舒适度约束、空调运行条件、空调用户舒适度约束。6.根据权利要求5所述的一种基于模型预测控制的配电网实时碳排放优化控制方法，其特征在于，所述步骤S5具体为：基于步骤S2的模型预测方法与不同类型负荷的优化周期控制周期的协调方法，利用启发式算法对柔性负荷进行滚动优化与实时控制；启发式算法包含遗传算法、粒子群算法、蚁群算法，滚动优化及实时控制方法如下：即一开始采用优化周期对电动汽车与空调负荷进行优化，优化过程采用启发式算法进行求解，并只选取控制周期的单个决策变量优化结果对负荷进行控制，当时间在区间内，为了考虑电动汽车用户的出行能量需求，空调也与电动汽车保持一样的优化周期，直到达到最后的时刻，优化与控制结束。
说明书desc
技术领域本发明涉及电力系统需求响应技术领域，具体涉及一种基于模型预测控制的配电网实时碳排放优化控制方法。背景技术近年来，由于社会经济发展对化石能源的过度依赖，能源资源日渐枯竭，同时大量碳排放也导致温室效应日益加重，极端天气的频繁出现，高比例可再生能源的接入等对电网运行带来越来越严峻的挑战。国际社会一致认为需要对气候变化采取紧迫行动和强有力的国际合作。目前已有数十个国家和地区提出了“碳中和”目标。2021年3月1日，国家电网有限公司发布“碳达峰、碳中和”行动方案，提出六个方面18项重要举措，主要内容有：推动电网向能源互联网升级，着力打造清洁能源优化配置平台，加快构建坚强智能电网；推动网源协调发展和调度交易机制优化、推动网源协调发展和调度交易机制优化，着力做好清洁能源并网消纳持续提升系统调节能力；推动全社会节能提效推动全社会节能提效，着力提高终端消费电气化水平拓展电能替代广度深度；推动公司节能减排加快实施推动公司节能减排加快实施，着力降低自身碳排放水平全面实施电网节能管理；推动能源电力技术创新推动能源电力技术创新，着力提升运行安全和效率水平统筹开展重大科技攻关；推动深化国际交流合作推动深化国际交流合作，着力集聚能源绿色转型最大合力深化国际合作与宣传引导。在电网低碳研究上，需要掌握电网运行过程中碳流动情况、电网碳分布情况，根据阶段性双碳目标，推进电网碳减排。配电网作为输电网到用户侧的关键环节，一直缺乏双碳相关的研究。而配电网存在大量柔性负荷等需求响应资源，该类资源具有重要的碳减排潜力，研究如何优化调度这些资源，对降低配电网的碳排放量具有重要的意义。发明内容本发明公开了一种基于模型预测控制的配电网实时碳排放优化控制方法。属于电力系统需求响应技术领域。所述方法包括以下步骤：首先构建计及用户舒适度约束的配电网柔性负荷模型；其次，基于模型预测方法协调不同类型柔性的负荷优化周期与控制周期；接着，根据台区变压器处的实时能源占比构建配电网碳中和因子；然后，基于碳中和因子与模型预测方法，构建配电网实时碳排放优化模型；最后，基于滚动优化的思想，利用实时的启发式算法进行优化问题的求解，对柔性负荷进行控制。本发明所要解决的技术问题是：本发明提供的一种基于模型预测控制的配电网实时碳排放优化控制方法，可在碳达峰碳中和的目标前景下，充分利用电力系统中负荷侧的需求响应资源，协调各类实现配电网实时碳排放优化控制，推动双碳政策在配电网中的落地，具有重要学术意义和工程实用价值。本发明为解决上述技术问题采用以下技术方案：首先构建计及用户舒适度约束的配电网柔性负荷模型。电动汽车具有可调节及可转移潜力，能够在用户规定的可允许充电时间窗内根据控制策略进行灵活充放电，电动汽车允许必须满足一定的用户舒适度要求，因此构建电动汽车负荷模型如下：E＝E+Pc·ηc-Pd/ηd-EroadEroad＝0,t∈Emin≤E≤Emax0≤Pc≤Pmax0≤Pd≤Pmax式中，E为电动汽车t时刻能量，Pc与Pd分别为t时刻的电动汽车充放电功率，ηc与ηd分别为电动汽车充放电效率，Eroad为电动汽车在t时刻在行驶中消耗的能量，在充电时间窗内Eroad为0，Emin与Emax是电动汽车能量的最小最大值约束，Pmax为电动汽车充放电功率最大值约束。并构建电动汽车用户舒适度约束条件如下：E≥Eroadsum其中，E指电动汽车在用户规定的结束充电时刻的能量，其必须大于第d天在路上行驶所需的能量Eroadsum，且其与用户出行习惯有关，服从均匀分布，受最小出行所需能量与最大出行能量/＞约束。电动汽车的决策变量为Pc与Pd。空调也是一类具有丰富调节潜力的柔性负荷，构建计及用户舒适度的空调负荷模型如下：Tin＝γTin-*s*COP*R*Pac+)Tout+ω0≤Pac≤Pacmax式中，Tin与Tout分别为t时刻的室内及室外温度，COP为空调能效系数，Pac为空调在t时刻的功率，其受空调最大功率Pacmax约束，ω为由于建筑墙体材料热传导导致的室内温度温差，γ为空调制冷时延系数，其由空调等效热阻R与等效热容C决定。s为空调用户舒适度系数：式中，Tset为空调温度设定值，ζ为空调温度上下浮动容忍值，这两个数值反映用户舒适度。只有当室外温度高于最高容忍温度空调才会启动，反之当温度下降到最低容忍温度时空调就会关闭。空调的决策变量为Tset。其次，基于模型预测方法协调不同类型柔性的负荷优化周期与控制周期。本专利基于模型预测方法控制电动汽车与空调两类负荷，模型预测方法与控制周期与优化周期的概念如下：模型预测方法：以空调为例，优化周期为1小时，控制周期为5分钟。1)以优化周期1进行优化计算一次，获取共计60分钟/5分钟＝12个控制周期的决策变量结果，仅选取控制周期1的决策变量结果对电动汽车与空调进行控制。2)时间窗向后移动15分钟，以优化周期2进行优化计算一次，仅选取控制周期2的决策变量结果对电动汽车与空调进行控制。3)重复上述步骤直到最后。由于电动汽车与空调的控制成本及数据传输速率不同，因此两种负荷的控制周期与优化周期不同，然而使用模型预测控制算法时需要协调这两类负荷的控制周期与优化周期，否则两类负荷的用户舒适度条件与模型运行条件无法被同时满足。本专利以空调1h优化周期、5min控制周期与电动汽车3h优化周期、15min控制周期为例，说明提出的优化周期与控制周期协调方法：1)优化周期统一为两类负荷优化周期较短的数值，即为1h。2)控制周期统一为两类负荷控制周期较短的数值，即为5min。为减少运算量，将电动汽车原控制周期15min的初始决策变量直接拓展为3个5min的决策变量，即若原始决策变量为，那么新的决策变量为)。此处直接拓展的原因是因为后续要采用遗传算法，是一种启发式算法，即先生成随机解再寻优。由于电动汽车决策变量较复杂，因此采用此种决策变量拓展方法，相当于以原先的15min控制周期变量维度生成了5min控制周期变量维度，，而并不增加模型的复杂程度，也不影响模型的计算精度。电动汽车在时段内，需恢复优化周期为3h，控制周期不改变依旧与空调的5min控制周期保持一致。原因是需要满足用户的出行需求，即在最大充电功率Pmax前提下保证到充电结束te时刻的能量大于出行能量需求与最小能量之和Eroadsum+Emin。同时空调也需要和电动汽车保持一样的优化周期为3h。接着，根据台区变压器处的实时能源占比构建配电网碳中和因子。ratioi为该时刻的能源i占比，i属于火电TP，光伏PV，风电WP，核电NP，水电HP里的一种，为该能源的电碳因子：式中，CEi是单位重量该能源发电所产生的碳排放量，Ei是单位重量该能源的发电量。越高表示在发电量相等的前提下，该能源产生的碳排放量越大。因此碳中和因子C表示该时刻配电网内的能源的清洁程度，其值越小，表示该时刻整个台区变压器下产生的碳排放量越少。然后，基于碳中和因子与模型预测方法，构建配电网实时碳排放优化模型。min C*Ps.t.E＝E+Pc·ηc-Pd/ηd-EroadEroad＝0,t∈Emin≤E≤Emax0≤Pc≤Pmax0≤Pd≤PmaxE≥EroadsumTin＝γTin-*s*COP*R*Pac+)Tout+ω该优化模型的目的是最小化配电网实时碳排放量，约束条件包括电动汽车的运行条件约束、电动汽车用户舒适度约束、空调运行条件、空调用户舒适度约束。最后，基于滚动优化的思想，利用实时的启发式算法进行优化问题的求解，对柔性负荷进行控制。基于步骤的模型预测方法与不同类型负荷的优化周期控制周期的协调方法，利用启发式算法对柔性负荷进行滚动优化与实时控制。启发式算法包含遗传算法、粒子群算法、蚁群算法等，本专利在具体实施案例中采用遗传算法，但本专利所指启发式算法包含但不仅限于遗传算法。滚动优化及实时控制方法如下：即一开始采用优化周期为1h对电动汽车与空调负荷进行优化，并只选取控制周期5min的单个决策变量优化结果对负荷进行控制，当时间在区间内，为了考虑电动汽车用户的出行能量需求，电动汽车的优化周期变为3h，空调也与电动汽车保持一样的优化周期。直到达到最后的时刻，优化与控制结束。本发明采用以上技术方案与现有技术相比，具有以下技术效果：相比较传统配电网碳排放控制措施，该方案提出了实时降低碳排放措施，能够通过提出的碳中和因子准确评估实时配电网的碳排放量。该方案充分利用配电网现有的柔性负荷需求响应资源，能够在不违反用户对于负荷的使用舒适度的前提下，充分调度与调整负荷使用方式，经济、有效的降低碳排放量。该方法虽然采用实时优化与控制方案，但采用启发式算法，且采用协调两类负荷的优化周期、控制周期的方案，能够在有限的时间内获取最优解。附图说明图1是本发明的流程图。图2是空调负荷的优化周期及控制周期示意图。图3是电动汽车与空调的优化周期及控制周期协调策略。图4是实施例中优化前后碳排放量对比图。图5是实施例某地区某时刻能源构成。具体实施方式下面结合附图和具体实施方式，进一步阐明本发明，应理解下述具体实施方式仅用于说明本发明而不用于限制本发明的范围。一种基于模型预测控制的配电网实时碳排放优化控制方法，可在碳达峰碳中和的目标前景下，充分利用电力系统中负荷侧的需求响应资源，协调各类实现配电网实时碳排放优化控制，推动双碳政策在配电网中的落地，具有重要学术意义和工程实用价值。具体步骤如下：首先构建计及用户舒适度约束的配电网柔性负荷模型。电动汽车具有可调节及可转移潜力，能够在用户规定的可允许充电时间窗内根据控制策略进行灵活充放电，电动汽车允许必须满足一定的用户舒适度要求，因此构建电动汽车负荷模型如下：E＝E+Pc·ηc-Pd/ηd-EroadEroad＝0,t∈Emin≤E≤Emax0≤Pc≤Pmax0≤Pd≤Pmax式中，E为电动汽车t时刻能量，Pc与Pd分别为t时刻的电动汽车充放电功率，ηc与ηd分别为电动汽车充放电效率，Eroad为电动汽车在t时刻在行驶中消耗的能量，在充电时间窗内Eroad为0，Emin与Emax是电动汽车能量的最小最大值约束，Pmax为电动汽车充放电功率最大值约束。并构建电动汽车用户舒适度约束条件如下：E≥Eroadsum其中，E指电动汽车在用户规定的结束充电时刻的能量，其必须大于第d天在路上行驶所需的能量Eroadsum，且其与用户出行习惯有关，服从均匀分布，受最小出行所需能量与最大出行能量/＞约束。电动汽车的决策变量为Pc与Pd。空调也是一类具有丰富调节潜力的柔性负荷，构建计及用户舒适度的空调负荷模型如下：Tin＝γTin-*s*COP*R*Pac+)Tout+ω0≤Pac≤Pacmax式中，Tin与Tout分别为t时刻的室内及室外温度，COP为空调能效系数，Pac为空调在t时刻的功率，其受空调最大功率Pacmax约束，ω为由于建筑墙体材料热传导导致的室内温度温差，γ为空调制冷时延系数，其由空调等效热阻R与等效热容C决定。s为空调用户舒适度系数：式中，Tset为空调温度设定值，ζ为空调温度上下浮动容忍值，这两个数值反映用户舒适度。只有当室外温度高于最高容忍温度空调才会启动，反之当温度下降到最低容忍温度时空调就会关闭。空调的决策变量为Tset。其次，基于模型预测方法协调不同类型柔性的负荷优化周期与控制周期。本专利基于模型预测方法控制电动汽车与空调两类负荷，模型预测方法与控制周期与优化周期的概念如下：模型预测方法：以空调为例，附图2中所示的优化周期为1小时，控制周期为5分钟。1)以优化周期1进行优化计算一次，获取共计60分钟/5分钟＝12个控制周期的决策变量结果，仅选取控制周期1的决策变量结果对电动汽车与空调进行控制。2)时间窗向后移动15分钟，以优化周期2进行优化计算一次，仅选取控制周期2的决策变量结果对电动汽车与空调进行控制。3)重复上述步骤直到最后。由于电动汽车与空调的控制成本及数据传输速率不同，因此两种负荷的控制周期与优化周期不同，然而使用模型预测控制算法时需要协调这两类负荷的控制周期与优化周期，否则两类负荷的用户舒适度条件与模型运行条件无法被同时满足。本专利以空调1h优化周期、5min控制周期与电动汽车3h优化周期、15min控制周期为例，说明提出的优化周期与控制周期协调方法：1)优化周期统一为两类负荷优化周期较短的数值，即为1h。2)控制周期统一为两类负荷控制周期较短的数值，即为5min。为减少运算量，将电动汽车原控制周期15min的初始决策变量直接拓展为3个5min的决策变量，即若原始决策变量为，那么新的决策变量为)。此处直接拓展的原因是因为后续要采用遗传算法，是一种启发式算法，即先生成随机解再寻优。由于电动汽车决策变量较复杂，因此采用此种决策变量拓展方法，相当于以原先的15min控制周期变量维度生成了5min控制周期变量维度，，而并不增加模型的复杂程度，也不影响模型的计算精度。电动汽车在时段内，需恢复优化周期为3h，控制周期不改变依旧与空调的5min控制周期保持一致。原因是需要满足用户的出行需求，即在最大充电功率Pmax前提下保证到充电结束te时刻的能量大于出行能量需求与最小能量之和Eroadsum+Emin。同时空调也需要和电动汽车保持一样的优化周期为3h。接着，根据台区变压器处的实时能源占比构建配电网碳中和因子。ratioi为该时刻的能源i占比，i属于火电TP，光伏PV，风电WP，核电NP，水电HP里的一种，为该能源的电碳因子：式中，CEi是单位重量该能源发电所产生的碳排放量，Ei是单位重量该能源的发电量。越高表示在发电量相等的前提下，该能源产生的碳排放量越大。因此碳中和因子C表示该时刻配电网内的能源的清洁程度，其值越小，表示该时刻整个台区变压器下产生的碳排放量越少。然后，基于碳中和因子与模型预测方法，构建配电网实时碳排放优化模型。min C*Ps.t.E＝E+Pc·ηc-Pd/ηd-EroadEroad＝0,t∈Emin≤E≤Emax0≤Pc≤Pmax0≤Pd≤PmaxE≥EroadsumTin＝γTin-*s*COP*R*Pac+)Tout+ω该优化模型的目的是最小化配电网实时碳排放量，约束条件包括电动汽车的运行条件约束、电动汽车用户舒适度约束、空调运行条件、空调用户舒适度约束。最后，基于滚动优化的思想，利用实时的启发式算法进行优化问题的求解，对柔性负荷进行控制。基于步骤的模型预测方法与不同类型负荷的优化周期控制周期的协调方法，利用启发式算法对柔性负荷进行滚动优化与实时控制。启发式算法包含遗传算法、粒子群算法、蚁群算法等，本专利在具体实施案例中采用遗传算法，但本专利所指启发式算法包含但不仅限于遗传算法。滚动优化及实时控制方法如下：即一开始采用优化周期为1h对电动汽车与空调负荷进行优化，并只选取控制周期5min的单个决策变量优化结果对负荷进行控制，当时间在区间内，为了考虑电动汽车用户的出行能量需求，电动汽车的优化周期变为3h，空调也与电动汽车保持一样的优化周期。直到达到最后的时刻，优化与控制结束。实施例本发明一种基于模型预测控制的配电网实时碳排放优化控制方法，采用IEEE标准13节点系统对所提出的方法进行验证。电动汽车及空调数量及连接节点如下表所示：该地区碳中和因子计算结果如下：以某一时刻的能源构成为例：结合图4某地区某时刻能源构成，则该地区的碳中和因子为：C＝∑1.2*32％+0.025*13％+0.01*18％+0.07*21％+0.02*16％＝0.384+0.00325+0.0018+0.0147+0.0032＝0.40695采用启发式算法为遗传算法，本专利包括但不仅限于此算法，该算法的模型参数如下所示：采用模型预测方案，电动汽车及空调的控制周期与优化周期如表所示：负荷优化周期控制周期电动汽车3h15min空调1h5min方案效果评价：结合图5优化前后碳排放量对比图，可以看出，采用该专利的方案能够有效降低该地区的碳排放量。
