标题title
基于ZigBee的舞台灯光分布式管理方法、系统、设备和介质
摘要abst
本申请涉及舞台灯的技术领域，尤其涉及一种基于ZigBee的舞台灯光分布式管理方法、系统、设备和介质。本申请通过手持终端发送广播信号，然后接收预设范围内所有灯具反馈的地址，确定出一个目标地址，然后获取与目标地址相对应的目标灯具的设备参数，操作人员能够在手持终端上获取到设备参数信息，并根据设备参数信息在手持终端上进行操作，从而对目标灯具的调试，手持终端根据操作人员的控制操作生成操作指令，并将操作指令发送到目标灯具以对目标灯具进行调试，通过多个手持终端在不同的现场进行近距离调试和诊断，从而使现场管理更有弹性，提高了舞台灯光的现场管理效果。
权利要求书clms
1.一种基于ZigBee的舞台灯光分布式管理方法，其特征在于，应用于基于ZigBee的舞台灯光分布式管理系统，所述系统包括手持终端和多个灯具，所述手持终端和所述灯具通过ZigBee网络模块通信连接，所述方法由所述手持终端执行，所述方法包括如下步骤：发送广播信号，并接收预设范围内所有灯具根据所述广播信号反馈的地址集合，其中，ZigBee网络中每个灯具均对应一个地址，所述地址集合中包括所述预设范围内所有灯具对应的地址；根据所述地址集合确定一个目标地址；根据所述目标地址获取目标灯具的设备参数信息，所述目标灯具为与所述目标地址相对应的灯具；根据操作人员以所述设备参数信息进行的控制操作，生成控制指令；发送所述控制指令到所述目标灯具以对所述目标灯具进行调试。2.根据权利要求1所述的基于ZigBee的舞台灯光分布式管理方法，其特征在于，所述根据所述地址集合从所述预设范围内的所有灯具中确定一个目标地址之前，所述方法还包括如下步骤：获取灯具安装位置场景图；根据所述灯具安装位置场景图标定所述预设范围内所有灯具的位置坐标；获取第一灯具对应的第一信号强度值、第二灯具对应的第二信号强度值和第三灯具对应的第三信号强度值，所述第一灯具、所述第二灯具和所述第三灯具为所述预设范围内的所有灯具中的任意三个灯具；根据所述第一信号强度值、第二信号强度值和第三信号强度值，计算所述第一灯具与所述手持终端的第一距离、所述第二灯具与所述手持终端的第二距离、所述第三灯具与所述手持终端的第三距离；根据所述第一灯具的位置坐标、所述第二灯具的位置坐标、所述第三灯具的位置坐标、所述第一距离、所述第二距离和所述第三距离确定手持终端的当前位置信息。3.根据权利要求2所述的基于ZigBee的舞台灯光分布式管理方法，其特征在于，所述确定手持终端的当前位置信息之后，所述方法还包括如下步骤：对所述当前位置信息进行平滑处理和滤波；根据平滑处理和滤波之后的当前位置信息，结合标定的所述预设范围内所有灯具的位置坐标，绘制手持终端的所述预设范围内的灯具位置分布图，所述灯具位置分布图用于在所述手持终端进行显示；根据所述地址集合和所述预设范围内各个灯具对应的信号强度，在所述灯具位置分布图中标注各个位置的灯具对应的地址信息。4.根据权利要求2所述的基于ZigBee的舞台灯光分布式管理方法，其特征在于，所述发送所述控制指令到所述目标灯具以对所述目标灯具进行调试之后，所述方法还包括如下步骤:接收所述目标灯具反馈的执行确认信息;根据所述执行确认信息判断所述控制指令是否执行成功;在判断为执行不成功时,手持终端向所述目标灯具重发所述控制指令。5.根据权利要求2所述的基于ZigBee的舞台灯光分布式管理方法，其特征在于，所述发送所述控制指令到所述目标灯具以对所述目标灯具进行调试之后，所述方法还包括如下步骤：手持终端将所述目标灯具的状态信息标记为已控制状态；手持终端向其他手持终端同步所述目标灯具的已控制状态信息，以使所述其他手持终端根据所述已控制状态信息更新所述目标灯具的最新状态。6.一种基于ZigBee的舞台灯光分布式管理方法，其特征在于，应用于基于ZigBee的舞台灯光分布式管理系统，系统包括手持终端和多个灯具，所述手持终端和所述灯具通过ZigBee网络模块通信连接，所述方法由所述灯具执行，所述方法包括如下步骤：接收手持终端发送的广播信号；根据所述广播信号反馈与所述目标灯具对应的目标地址；接收手持终端根据所述目标地址反馈的信息获取指令，并发送所述目标灯具对应的设备参数信息；接收手持终端反馈的控制指令，所述控制指令由操作人员以所述设备参数信息进行的控制操作生成；根据所述控制指令调节灯具状态。7.根据权利要求6所述的基于ZigBee的舞台灯光分布式管理方法，其特征在于，所述灯具根据控制指令调节灯具状态，包括：在同时获取到多个控制指令的情况下，比较所述多个控制指令中每个控制指令的优先级；根据比较结果确定所述优先级最高的控制指令为目标控制指令；根据所述目标控制指令控制灯具状态。8.一种基于ZigBee的舞台灯光分布式管理系统，其特征在于，系统包括手持终端和多个灯具，所述手持终端和所述灯具通过ZigBee网络模块通信连接；所述手持终端用于执行如权利要求1-5中任一项所述的基于ZigBee的舞台灯光分布式管理方法；所述灯具用于执行如权利要求6-7中任一项所述的基于ZigBee的舞台灯光分布式管理方法。9.一种电子设备，其特征在于，包括存储器、处理器以及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现权利要求1-7中任一项所述的基于ZigBee的舞台灯光分布式管理方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1-7中任一项所述的基于ZigBee的舞台灯光分布式管理方法的步骤。
说明书desc
技术领域本申请涉及舞台灯的技术领域，尤其是涉及一种基于ZigBee的舞台灯光分布式管理方法、系统、设备和介质。背景技术在当前的大型舞台表演现场，不仅灯具的数量与类型增多，灯具的功能也日益增多。比如一个中等类型的演唱会，灯具的数量高达1000台以上，每台灯具包含的可选特殊功能也随着灯光师的需求逐渐增多，对于现场施工和调试带来巨大的挑战。现有的舞台灯光控制普遍采用RDM控制协议，但RDM 协议是基于RS422 的有线网络的单一控制设备，近距离的现场调试和诊断只能由单一的灯光师在控制室对其进行操作，现场管理效果较差，对此情况有待进一步改善。发明内容为了解决现有的采用RDM 控制协议的舞台灯光控制方法现场管理效果较差的问题，本申请提供一种基于ZigBee的舞台灯光分布式管理方法、系统、设备和介质，采用如下的技术方案：第一方面，本申请提供一种基于ZigBee的舞台灯光分布式管理方法，应用于基于ZigBee的舞台灯光分布式管理系统，所述系统包括手持终端和多个灯具，所述手持终端和所述灯具通过ZigBee网络模块通信连接，所述方法由所述手持终端执行，所述方法包括如下步骤：发送广播信号，并接收预设范围内所有灯具根据所述广播信号反馈的地址集合，其中，ZigBee网络中每个灯具均对应一个地址，所述地址集合中包括所述预设范围内所有灯具对应的地址；根据所述地址集合确定一个目标地址；根据所述目标地址获取目标灯具的设备参数信息，所述目标灯具为与所述目标地址相对应的灯具；根据操作人员以所述设备参数信息进行的控制操作，生成控制指令；发送所述控制指令到所述目标灯具以对所述目标灯具进行调试。通过采用上述技术方案，本申请通过手持终端发送广播信号，然后接收预设范围内所有灯具反馈的地址，确定出一个目标地址，然后获取与目标地址相对应的目标灯具的设备参数，操作人员能够在手持终端上获取到设备参数信息，并根据设备参数信息在手持终端上进行操作，从而对目标灯具的调试，手持终端根据操作人员的控制操作生成操作指令，并将操作指令发送到目标灯具以对目标灯具进行调试，通过多个手持终端在不同的现场进行近距离调试和诊断，从而使现场管理更有弹性，提高了舞台灯光的现场管理效果。可选的，所述根据所述地址集合从所述预设范围内的所有灯具中确定一个目标地址之前，所述方法还包括如下步骤：获取灯具安装位置场景图；根据所述灯具安装位置场景图标定所述预设范围内所有灯具的位置坐标；获取第一灯具对应的第一信号强度值、第二灯具对应的第二信号强度值和第三灯具对应的第三信号强度值，所述第一灯具、所述第二灯具和所述第三灯具为所述预设范围内的所有灯具中的任意三个灯具；根据所述第一信号强度值、第二信号强度值和第三信号强度值，计算所述第一灯具与所述手持终端的第一距离、所述第二灯具与所述手持终端的第二距离、所述第三灯具与所述手持终端的第三距离；根据所述第一灯具的位置坐标、所述第二灯具的位置坐标、所述第三灯具的位置坐标、所述第一距离、所述第二距离和所述第三距离确定手持终端的当前位置信息。通过采用上述技术方案，当存在大量灯具需要调试时，若定位偏差较大，则操作人员无法准确判定各个灯具的实际方位，增加管理难度，在调试和控制的过程中容易因为定位不准导致误操作其他非目标设备，且当定位误差较大时，无法实现精确的灯光聚束和光影控制，本申请通过在灯具安装位置场景图中标定预设范围内各个灯具的位置坐标，然后结合预设范围内三个灯具的信号强度值，通过三边量测法精确定位出手持终端的位置信息，从而解决了无线网络定位不准确的问题，减少因定位误差过大导致的调试失误。可选的，所述确定手持终端的当前位置信息之后，所述方法还包括如下步骤：对所述当前位置信息进行平滑处理和滤波；根据平滑处理和滤波之后的当前位置信息，结合标定的所述预设范围内所有灯具的位置坐标，绘制手持终端的所述预设范围内的灯具位置分布图，所述灯具位置分布图用于在所述手持终端进行显示；根据所述地址集合和所述预设范围内各个灯具对应的信号强度，在所述灯具位置分布图中标注各个位置的灯具对应的地址信息。通过采用上述技术方案，本申请通过对手持终端的当前位置信息进行平处理和滤波，然后结合标定的预设范围内所有灯具的位置坐标，绘制出手持终端的预设范围内的灯具位置分布图，用以在手持终端中显示，然后根据地址集合和预设范围内各个灯具对应的信号强度，在灯具位置分布图中标注各个灯具的地址信息，从而便于操作人员利用手持终端对预设范围内的所有灯具进行调试。可选的，所述发送所述控制指令到所述目标灯具以对所述目标灯具进行调试之后，所述方法还包括如下步骤:接收所述目标灯具反馈的执行确认信息;根据所述执行确认信息判断所述控制指令是否执行成功;在判断为执行不成功时,手持终端向所述目标灯具重发所述控制指令。通过采用上述技术方案，当手持终端和目标灯具之间进行通信时，手持终端与目标灯具之间建立通信连接，手持设备在通信连接上发送控制指令，目标灯具在接收到控制指令时返回执行确认信息，手持终端通过接收目标灯具反馈的执行确认信息，判断控制指令是否执行成功，在不成功时重发控制指令，从而确保手持终端与目标灯具之间的通信正常，以便于操作人员通过手持终端对目标灯具进行调试。可选的，所述发送所述控制指令到所述目标灯具以对所述目标灯具进行调试之后，所述方法还包括如下步骤：手持终端将所述目标灯具的状态信息标记为已控制状态；手持终端向其他手持终端同步所述目标灯具的已控制状态信息，以使所述其他手持终端根据所述已控制状态信息更新所述目标灯具的最新状态。通过采用上述技术方案，本申请通过在对目标灯具进行调试之后，将目标灯具的状态信息标记为已控制状态，然后向其他手持终端同步目标灯具的已控制状态信息，以使其他手持终端根据已控制状态信息更新目标灯具的最新状态。通过此，多个手持终端之间能够自动同步已控制灯具状态，从而使得每个操作人员对灯具状态的认知一致，避免操作人员之间重复操作，从而快速进行现场调试，解决多个操作人员并行调试协调困难的问题。第二方面，本申请提供一种基于ZigBee的舞台灯光分布式管理方法，应用于基于ZigBee的舞台灯光分布式管理系统，系统包括手持终端和多个灯具，所述手持终端和所述灯具通过ZigBee网络模块通信连接，所述方法由所述灯具执行，所述方法包括如下步骤：接收手持终端发送的广播信号；根据所述广播信号反馈与所述目标灯具对应的目标地址；接收手持终端根据所述目标地址反馈的信息获取指令，并发送所述目标灯具对应的设备参数信息；接收手持终端反馈的控制指令，所述控制指令由操作人员以所述设备参数信息进行的控制操作生成；根据所述控制指令调节灯具状态。通过采用上述技术方案，灯具通过接收手持终端发送的广播信号，然后反馈与灯具对应的地址，然后接收手持终端根据地址反馈的信息获取指令，并发送灯具对应的设备参数信息，从而使手持终端能够接收到灯具的设备参数信息，使得操作人员能够在手持终端上查看到灯具的设备参数信息，从而根据设备参数信息对灯具进行控制操作，手持设备根据操作人员的控制操作生成控制指令并发送给灯具，灯具在接收到控制指令后，根据控制指令调节状态，从而实现对灯具的调试。可选的，所述灯具根据控制指令调节灯具状态，包括：在同时获取到多个控制指令的情况下，比较所述多个控制指令中每个控制指令的优先级；根据比较结果确定所述优先级最高的控制指令为目标控制指令；根据所述目标控制指令控制灯具状态。通过采用上述技术方案，本申请还设置有优先级机制，在灯具同时获取到多个控制指令的情况下，比较多个控制指令中每个控制指令的优先级，确定优先级最高的控制指令为目标控制指令，然后根据目标控制指令控制灯具状态，从而解决多个操作人员并行调试协调困难的问题。第三方面，本申请提供一种基于ZigBee的舞台灯光分布式管理系统，系统包括手持终端和多个灯具，所述手持终端和所述灯具通过ZigBee网络模块通信连接；所述手持终端用于执行上述手持终端执行的基于ZigBee的舞台灯光分布式管理方法；所述灯具用于执行上述灯具执行的基于ZigBee的舞台灯光分布式管理方法。第四方面，本申请提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现上述基于ZigBee的舞台灯光分布式管理方法的步骤。第五方面，本申请提供一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述基于ZigBee的舞台灯光分布式管理方法的步骤。综上所述，本申请包括以下至少一种有益技术效果：1.本申请通过手持终端发送广播信号，然后接收预设范围内所有灯具反馈的地址，确定出一个目标地址，然后获取与目标地址相对应的目标灯具的设备参数，操作人员能够在手持终端上获取到设备参数信息，并根据设备参数信息在手持终端上进行操作，从而对目标灯具的调试，手持终端根据操作人员的控制操作生成操作指令，并将操作指令发送到目标灯具以对目标灯具进行调试，通过多个手持终端在不同的现场进行近距离调试和诊断，从而使现场管理更有弹性，提高了舞台灯光的现场管理效果；2.本申请通过在灯具安装位置场景图中标定预设范围内各个灯具的位置坐标，然后结合预设范围内三个灯具的信号强度值，通过三边量测法精确定位出手持终端的位置信息，从而解决了无线网络定位不准确的问题，减少因定位误差过大导致的调试失误；3.本申请的多个手持终端之间自动同步已控制灯具状态，从而使得每个操作人员对灯具状态的认知一致，避免操作人员之间重复操作，从而快速进行现场调试，解决多个操作人员并行调试协调困难的问题。附图说明图1是本申请实施例手持终端的模块示意图；图2是本申请实施例一种基于ZigBee的舞台灯光分布式管理系统的应用场景图；图3是本申请实施例一种基于ZigBee的舞台灯光分布式管理方法的示例性流程图；图4是本申请实施例一种基于ZigBee的舞台灯光分布式管理方法的另一个示例性流程图；图5是本申请实施例一种基于ZigBee的舞台灯光分布式管理方法的又一个示例性流程图；图6是本申请实施例电子设备的内部结构图。具体实施方式本申请以下实施例中所使用的术语只是为了描述特定实施例的目的，而并非旨在作为对本申请的限制。如在本申请的说明书和所附权利要求书中所使用的那样，单数表达形式“一个”、“一种”、“所述”、“上述”、“该”和“这一”旨在也包括复数表达形式，除非其上下文中明确地有相反指示。还应当理解，本申请中使用的术语“和/或”是指包含一个或多个所列出项目的任何或所有可能组合。以下，术语“第一”、“第二”仅用于描述目的，而不能理解为暗示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征，在本申请实施例的描述中，除非另有说明，“多个”的含义是两个或两个以上。在大型的舞台表演现场，灯具的数量、类型和功能繁多，给现场的施工和调试带来巨大的挑战，现有的舞台灯光控制普遍采用DM 控制协议，但RDM 协议是基于RS422 的有线网络的单一控制设备，现场管理效果较差。本申请提供一种基于ZigBee的舞台灯光分布式管理系统、方法、设备和介质，利用ZigBee无线通讯，通过手持终端进行分布式控制，操作人员可以近距离现场调试和诊断，并且能够由多人进行管理，使现场管理更有弹性，提高了舞台灯光的现场管理效果。下面结合说明书附图对本申请实施例做进一步详细描述。参照图1，图1是本申请实施例手持终端的模块示意图。手持终端包括处理器、存储器、电池和第一ZigBee网络模块，存储器和第一ZigBee网络模块均与处理器电通信连接，电池用于为处理器、存储器和第一ZigBee网络模块供电。可以理解的是，手持终端安装有安卓操作系统和人机界面，并且配置有自有灯具管理协议，以使操作人员能够通过手持终端对灯具进行调试和诊断。进一步的，手持终端也可以通过无线网络将数据传输到云端数据中心，手持终端可以设置有电池管理模块，用于对电池功耗进行管理，同时可以设有应用层，以对灯具进行调试。本申请实施例提供一种基于ZigBee的舞台灯光分布式管理方法，应用于基于ZigBee的舞台灯光分布式管理系统，参照图2，图2为本申请实施例一种基于ZigBee的舞台灯光分布式管理系统的应用场景图。一种基于ZigBee的舞台灯光分布式管理系统，包括上述手持终端以及多灯具，其中，每个灯具均设置有第二ZigBee网络模块，第二ZigBee网络模块与第一ZigBee网络模块通信连接，灯具通过第二ZigBee网络模块发送灯具的设备参数到手持终端，并接收手持终端通过第一ZigBee网络模块下发的控制指令。如图2所示，在实际应用场景中，手持终端一般包括多个，由不同操作人员携带，操作人员可以携带手持终端在舞台的不同位置对灯具进行调试，从而使多个操作人员能够对灯具进行近距离调试和诊断，提高舞台现场管理效果和管理效率。参照图3，图3是本申请实施例一种基于ZigBee的舞台灯光分布式管理方法的示例性流程图。第一方面，本申请提供一种基于ZigBee的舞台灯光分布式管理方法，应用于上述基于ZigBee的舞台灯光分布式管理系统，方法包括如下步骤：S310、发送广播信号，并接收预设范围内所有灯具根据广播信号反馈的地址集合。其中，ZigBee网络中每个灯具均对应一个地址，地址集合中包括所述预设范围内所有灯具对应的地址；其中，预设范围为移动终端的第一ZigBee网络模块的通信范围。具体的，在每个灯具的第二ZigBee网络模块中，配置成终端节点设备，在生产和安装时，为每个灯具的第二ZigBee网络模块烧录一个全网唯一的16位短地址，采用二进制编码，一共可以编码约65万个地址，满足大中型舞台的需要；其中，地址可以存储在网络模块的制度存储器中，在重启时自动加载，通过此唯一确定ZigBee网络中每个灯具的节点。S320、根据地址集合确定一个目标地址。S330、根据目标地址获取目标灯具的设备参数信息。其中，目标灯具为与目标地址相对应的灯具，在确定好一个目标地址之后，手持终端可以通过目标地址与目标灯具之间建立通信连接，然后接收目标灯具反馈的设备参数信息，从而使操作人员在手持终端中对目标灯具的设备参数信息进行查看。S340、根据操作人员以所述设备参数信息进行的控制操作，生成控制指令。其中，在操作人员查看到设备参数信息之后，针对设备参数信息中存在的问题，可以对手持终端进行操作控制，手持终端根据操作人员的操作控制生成控制指令，并发送给目标灯具，从而对目标灯具进行调试和诊断。S350、发送控制指令到目标灯具以对目标灯具进行调试。上述实施例中，通过手持终端执行的步骤，实现了手持终端对目标灯具的管理，在实际应用场景中，通过多个手持终端分别对多个灯具的管理，使操作人员能够利用手持终端对灯具进行近距离调试和诊断，实现了对舞台灯光的分布式管理，提高舞台灯光的现场管理效果。在一些实施例中，传统的通过无线网络定位的方法对手持终端的定位可能存在定位偏差，当存在大量灯具设备需要调试时，若定位偏差较大，则操作人员无法准确判定各个灯具的实际方位，在调试和控制的过程中容易因为定位不准导致误操作其他非目标设备，特别是在多个工作人员需要协调工作的情况下，控制出错很容易造成最后的舞台灯光效果不好。参照图4，图4为本申请实施例一种基于ZigBee的舞台灯光分布式管理方法的另一个示例性流程图。在一个可选的实施例中，在步骤S320之前，所述方法还包括：S410、获取灯具安装位置场景图。其中，灯具安装位置场景图为舞台区域的二维或三维图纸，标明了舞台的大小、形状以及灯具、布景的安装位置。S420、根据灯具安装位置场景图标定预设范围内所有灯具的位置坐标。其中，在获取到场景图之后，根据手持终端的预设范围，以手持终端为圆心，标注出预设范围内确定已知的所有灯具安装的精确位置，在场景图中标注出所有灯具的坐标，例如，在二维空间坐标系中，通过X-Y轴表示每个灯具的位置，在三维空间坐标系中，通过X-Y-Z轴来表示每个灯具的空间位置。S430、获取第一灯具对应的第一信号强度值、第二灯具对应的第二信号强度值和第三灯具对应的第三信号强度值。其中，第一灯具、第二灯具和第三灯具为预设范围内的所有灯具中的任意三个灯具。S440、根据第一信号强度值、第二信号强度值和第三信号强度值计算第一灯具与手持终端的第一距离、第二灯具与手持终端的第二距离、第三灯具与手持终端的第三距离。其中，本申请预先建立了信号强度值与距离之间的关系方程，在手持终端获取到多个灯具的信号时，可以通过其中部分灯具的信号强度值，确定手持终端与灯具之间的距离。S450、根据第一灯具的位置坐标、第二灯具的位置坐标、第三灯具的位置坐标、第一距离、第二距离和第三距离确定手持终端的位置信息。其中，通过三边量测法可以精确定位出手持终端的位置信息，具体的，以每个灯具的坐标为圆心，每个灯具与手持终端的距离为半径画圆，三个圆的交点即为手持终端的位置信息。进一步的，在一些实施例中，方法还包括：S460、对手持终端的当前位置信息进行平滑处理和滤波。S470、根据平滑处理和滤波之后的当前位置信息，结合标定的预设范围内所有灯具的位置坐标，绘制手持终端的预设范围内的灯具位置分布图。其中，灯具位置分布图用于在手持终端进行显示。具体的，当操作人员要对灯具进行控制之前，需要选择一个目标灯具，操作人员通过点击按钮等，可以获取当前位置信息的灯具位置分布图，然后可以从灯具位置分布图上清晰地获知当前位置信息的各个灯具的位置以及地址，然后可以针对需要操作的目标灯具进行选择，以获取目标灯具对应的设备参数信息。S480、根据地址集合和预设范围内各个灯具对应的信号强度，在灯具位置分布图中标注各个位置的灯具对应的地址信息。值得注意的是，灯具安装位置场景图包括整个舞台区域的范围，手持终端的灯具分布图只包括手持终端的实时位置的预设范围内的灯具，且只包含灯具位置信息，不包含人员、布景等其他舞台信息，从而便于操作人员利用手持终端对实时位置的预设范围内的所有灯具进行调试。进一步的，在一些实施例中，方法还包括：S360、接收目标灯具反馈的执行确认信息。其中，目标灯具在接收到控制指令时反馈执行确认信息。S370、根据执行确认信息判断控制指令是否执行成功。S380、在判断为执行不成功时，手持终端向目标灯具重发控制指令。可以理解的是，通过此，手持设备在通信连接上发送控制指令，目标灯具在接收到控制指令时返回执行确认信息，手持终端通过接收目标灯具反馈的执行确认信息，判断控制指令是否执行成功，在不成功时重发控制指令，从而确保手持终端与目标灯具之间的通信正常，以便于操作人员通过手持终端对目标灯具进行调试。值得注意的是，本申请的手持终端在对目标灯具进行调试之后，将目标灯具的状态信息标记为已控制状态，然后向其他手持终端同步目标灯具的已控制状态信息，以使其他手持终端根据已控制状态信息更新目标灯具的最新状态，通过此，使多个手持终端之间自动同步已控制灯具状态，从而使得每个操作人员对灯具状态的认知一致，避免操作人员之间重复操作，解决多个操作人员并行调试协调困难的问题。参照图5，图5为本申请实施例一种基于ZigBee的舞台灯光分布式管理方法的又一个示例性流程图。第二方面，本申请提供一种基于ZigBee的舞台灯光分布式管理方法，应用上述基于ZigBee的舞台灯光分布式管理系统，以灯具为执行主体。一种基于ZigBee的舞台灯光分布式管理方法，系统包括手持终端和多个灯具，手持终端和灯具通过ZigBee网络模块通信连接，方法由灯具执行，方法包括如下步骤：S510、接收手持终端发送的广播信号。S520、根据广播信号反馈与目标灯具对应的目标地址。其中，每个灯具均对应一个16位短地址。S530、接收手持终端根据目标地址反馈的信息获取指令，并发送目标灯具对应的设备参数信息。其中，设备参数信息包括灯具类型、灯具品牌和型号、灯具电源电压/电流工作参数，灯具的色温、亮度等，灯具的各路通道参数，如RGB值、色彩参数等，灯具的运动控制参数如电机转速、方向等，灯具的控制信号接口参数、工作状态和故障代码，硬件版本、固件版本、软件版本信息，使用时长和维护记录等。具体的根据各个灯具的不同进行设置。S540、接收手持终端反馈的控制指令。其中，控制指令由操作人员以设备参数信息为参考进行的控制操作生成。S550、根据控制指令调节灯具状态。在一个可选的实施例中，为了解决多个操作人员并行调试协调困难的问题，在根据控制指令调节灯具状态的过程中，还包括：S560、在同时获取到多个控制指令的情况下，比较多个控制指令中每个控制指令的优先级。S570、根据比较结果确定优先级最高的控制指令为目标控制指令。S580、根据目标控制指令控制灯具状态。在一个可选实施例中，当目标灯具同时获取到多个手持终端发送的广播信号时，目标灯具根据向多个发出广播信号的手持终端发出重复覆盖的通知，手持终端在接收到重复覆盖通知时，在灯具位置分布图中将目标灯具所在区域标记为重复覆盖区域，并根据覆盖灯具的手持终端的数量通过不同颜色进行标识，从而进一步减少了操作人员协同工作时协调困难的问题。第三方面，本申请提供一种基于ZigBee的舞台灯光分布式管理系统，系统包括手持终端和多个灯具，手持终端和灯具通过ZigBee网络模块通信连接；手持终端用于执行上述手持终端执行的基于ZigBee的舞台灯光分布式管理方法；灯具用于执行上述灯具执行的基于ZigBee的舞台灯光分布式管理方法。在一个实施例中，本申请提供了一种电子设备，电子设备可以为手持终端或灯具中的一个模块。该电子设备可以是服务器，其内部结构图可以如图6所示。该电子设备包括通过系统总线连接的处理器、存储器和网络接口。其中，该电子设备的处理器用于提供计算和控制能力。该电子设备的存储器包括非易失性存储介质、内存储器。该非易失性存储介质存储有操作系统、计算机程序和数据库。该内存储器为非易失性存储介质中的操作系统和计算机程序的运行提供环境。该电子设备的数据库用于存储数据。该电子设备的网络接口用于与外部的终端通过网络连接通信。该计算机程序被处理器执行时以实现一种基于ZigBee的舞台灯光分布式管理方法。本领域技术人员可以理解，图6中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的电子设备的限定，具体的电子设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。在一个实施例中，还提供了一种电子设备，包括存储器和处理器，存储器中存储有计算机程序，该处理器执行计算机程序时实现上述各方法实施例中的步骤。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，上述的计算机程序可存储于一非易失性计算机可读取存储介质中，该计算机程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、存储、数据库或其它介质的任何引用，均可包括非易失性和易失性存储器中的至少一种。非易失性存储器可包括只读存储器、磁带、软盘、闪存或光存储器等。易失性存储器可包括随机存取存储器或外部高速缓冲存储器。作为说明而非局限，RAM可以是多种形式，比如静态随机存取存储器或动态随机存取存储器等。以上均为本申请的较佳实施例，并非依此限制本申请的保护范围，故：凡依本申请的结构、形状、原理所做的等效变化，均应涵盖于本申请的保护范围之内。
