标题title
一种IPv6校园网的异常数据监测方法、设备和介质
摘要abst
本发明公开了一种IPv6校园网的异常数据监测方法、设备和介质，包括以下具体步骤：从IPv6校园网中捕获传输的数据包，获取数据包中与IPv6规则链表节点匹配的网络数据；获取节点匹配的网络数据地址，基于地址对网络数据报头信息进行解析；对解析的网络数据进行特征提取，基于数据特征消除数据包的结构的异构性；基于消除异构性的网络数据进行数据拟合，得到识别差值序列进行漂移区间识别；计算漂移区间平移距离，基于平移距离对数据包进行异常数据和误用数据检测。通过对IPv6校园网中的网络数据进行特征提取，对网络数据的异构性进行消除，基于漂移区间的平移距离进行数据异常检测，发现数据包的潜在威胁，提高数据传输的安全性。
权利要求书clms
1.一种IPv6校园网的异常数据监测方法，其特征在于，包括以下具体步骤：从IPv6校园网中捕获传输的数据包，获取数据包中与IPv6规则链表节点匹配的网络数据；获取节点匹配的网络数据地址，基于地址对网络数据报头信息进行解析；对解析的网络数据进行特征提取，基于数据特征消除数据包的结构的异构性；基于消除异构性的网络数据进行数据拟合，得到识别差值序列进行漂移区间识别；计算漂移区间平移距离，基于平移距离对数据包进行异常数据和误用数据检测。2.根据权利要求1所述的IPv6校园网的异常数据监测方法，其特征在于，所述与IPv6规则链表节点匹配的判断步骤包括：获取数据包，解析数据包命令行和规则库，得到该数据包的规则链表；获取IPv6规则链表，将该数据包的规则链表与IPv6规则链表节点进行匹配；若匹配，则响应对该数据的解析命令。3.根据权利要求1所述的IPv6校园网的异常数据监测方法，其特征在于，所述获取节点匹配的网络数据地址包括：收集IPv6网络中活跃的IPv6地址集，对地址集中的地址进行预处理，筛选标准地址：其中，对地址集中的地址进行预处理包括：对活跃的IPv6地址集中的地址进行位熵和十六进制位信息量的计算，得到各地址段的无序值；结合十六进制位信息量的值，将无序值连续且在阈值内的十六进制位划分为同一段，对根据每段的十六进制位的值，得到各段之间不同值的出现频率；根据各段之间不同值的出现频率进行地址段关联，输出网络数据的标准地址。4.根据权利要求1所述的IPv6校园网的异常数据监测方法，其特征在于，所述对网络数据报头信息进行解析包括：获取当前地址的数据处理函数，基于处理函数对网络数据包的报头进行提取；将报头信息存入到数据结构中，判断下一个报头是否存在扩展报头，若是，则调用扩展报头解析报文；若否，则调用上层协议解析函数对网络数据进行解析。5.根据权利要求4所述的IPv6校园网的异常数据监测方法，其特征在于，所述对解析的网络数据进行特征提取包括获取报文入口，对业务报文头中某一个染色位进行标识，确定报文特征。6.根据权利要求1所述的IPv6校园网的异常数据监测方法，其特征在于，所述基于数据特征消除数据包的结构的异构性包括：获取数据特征的特征向量，对特征向量进行归一化；计算特征向量的协方差矩阵；计算协方差矩阵的特征值和特征向量；根据需求选取协方差矩阵前n列作为降维矩阵；获得的降维矩阵映射到低维空间完成降维计算，得到消除异构性的数据包。7.根据权利要求1所述的IPv6校园网的异常数据监测方法，其特征在于，所述进行漂移区间识别包括：获取目标数据段，计算消除异构性后网络数据的相关系数，选取相关性最强的两组数据；利用最小二乘法将两组数据进行拟合，计算目标数据与拟合曲线的差值；设置置信区间，识别差值序列中合理范围以外的部分，确定为漂移段位置。8.根据权利要求7所述的IPv6校园网的异常数据监测方法，其特征在于，所述基于平移距离对数据包进行异常数据和误用数据检测包括：计算首个漂移位置数据与相邻的前一个数据的差值，得到平移距离；基于平移距离对数据包进行分类，检测数据数据包个数与此次分类的所检测的所有数据包的总数的比值与预设的阈值A和B进行比较；如果大于阈值B，则确定该类的所有数据包为用户在网络中的正常行为所产生的网络传输数据包；如果小于某个阈值A，则确定该类的所有的数据包为网络入侵攻击行为所产生的网络传输数据包；如果该比值介于A和B之间，则根据规则库比对，判断该数据包的合法性。9.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1至8任一项所述的IPv6校园网的异常数据监测方法。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现如权利要求1至8任一项所述的IPv6校园网的异常数据监测方法。
说明书desc
技术领域本发明涉及IPv6网络应用技术领域，具体涉及一种IPv6校园网的异常数据监测方法、设备和介质。背景技术随着网络教育的不断发展和完善，校园信息化得到了突飞猛进的发展，由于大学学习环境更加开放，校园网面向用户群体的特点，在校园网的图书馆、行政办公楼等校园子网内的用户群体较为单一，网络结构也较为简单。而对于学生宿舍等以学生用户为主的校园网子网中，学生用户群体较多，而且在周末、晚上等上网时间较为集中的时间段内，子网中的网络数据量会非常大，为此在这些时间段需要对大量的数据进行检测处理，校园网的这种开放性也给高校校园网络安全带来了很大的安全隐患。当前以IPv4为基础的互联网之所以遭受信任危机，是由于现有互联网体系结构从设计、实现到维护技术都存在先天的缺陷，这些缺陷决定了其不可信任性是难以克服的。目前的互联网是不强调真实源地址认证的，只强调信息发到哪里，并不强调信息从哪里来，造成了很多网络安全问题。IPv6引入以后，在协议安全性上有了显著的提高，但它仍然没有完全解决源地址欺骗所带来的安全问题。一方面加密认证机制可能被攻击者所利用，成为被攻击的漏洞；而无法对网络基础设施进行保护，无法在传输过程中保证数据源地址的真实性和数据的安全性。发明内容本发明所要解决的技术问题是校园网的数据传输安全性低，目的在于提供一种IPv6校园网的异常数据监测方法、设备和介质，通过对IPv6校园网中捕获的数据包进行预处理，抽取有用数据，整合为一个通用的数据结构体，同时对网络数据的异构性进行消除，通过漂移区间识别，计算漂移区间平移距离进行异常数据和误用数据检测，发现数据包中包含的潜在威胁，提高数据传输的安全性。本发明通过下述技术方案实现：一种IPv6校园网的异常数据监测方法，包括以下具体步骤：从IPv6校园网中捕获传输的数据包，获取数据包中与IPv6规则链表节点匹配的网络数据；获取节点匹配的网络数据地址，基于地址对网络数据报头信息进行解析；对解析的网络数据进行特征提取，基于数据特征消除数据包的结构的异构性；基于消除异构性的网络数据进行数据拟合，得到识别差值序列进行漂移区间识别；计算漂移区间平移距离，基于平移距离对数据包进行异常数据和误用数据检测。本发明通过对IPv6校园网中捕获的数据包进行预处理，对解析的网络数据进行特征提取，基于数据特征消除数据包的结构的异构性，抽取有用数据，整合为一个通用的数据结构体，同时通过漂移区间识别，计算漂移区间平移距离进行异常数据和误用数据检测，发现数据包中包含的潜在威胁，提高数据传输的安全性。进一步的，所述与IPv6规则链表节点匹配的判断步骤包括：获取数据包，解析数据包命令行和规则库，得到该数据包的规则链表；获取IPv6规则链表，将该数据包的规则链表与IPv6规则链表节点进行匹配；若匹配，则响应对该数据的解析命令。进一步的，所述获取节点匹配的网络数据地址包括：收集IPv6网络中活跃的IPv6地址集，对地址集中的地址进行预处理，筛选标准地址：其中，对地址集中的地址进行预处理包括：对活跃的IPv6地址集中的地址进行位熵和十六进制位信息量的计算，得到各地址段的无序值；结合十六进制位信息量的值，将无序值连续且在阈值内的十六进制位划分为同一段，对根据每段的十六进制位的值，得到各段之间不同值的出现频率；根据各段之间不同值的出现频率进行地址段关联，输出网络数据的标准地址。进一步的，所述对网络数据报头信息进行解析包括：获取当前地址的数据处理函数，基于处理函数对网络数据包的报头进行提取；将报头信息存入到数据结构中，判断下一个报头是否存在扩展报头，若是，则调用扩展报头解析报文；若否，则调用上层协议解析函数对网络数据进行解析。进一步的，所述对解析的网络数据进行特征提取包括获取报文入口，对业务报文头中某一个染色位进行标识，确定报文特征。进一步的，所述基于数据特征消除数据包的结构的异构性包括：获取数据特征的特征向量，对特征向量进行归一化；计算特征向量的协方差矩阵；计算协方差矩阵的特征值和特征向量；根据需求选取协方差矩阵前n列作为降维矩阵；获得的降维矩阵映射到低维空间完成降维计算，得到消除异构性的数据包。进一步的，所述进行漂移区间识别包括：获取目标数据段，计算消除异构性后网络数据的相关系数，选取相关性最强的两组数据；利用最小二乘法将两组数据进行拟合，计算目标数据与拟合曲线的差值；设置置信区间，识别差值序列中合理范围以外的部分，确定为漂移段位置。进一步的，所述基于平移距离对数据包进行异常数据和误用数据检测包括：计算首个漂移位置数据与相邻的前一个数据的差值，得到平移距离；基于平移距离对数据包进行分类，检测数据数据包个数与此次分类的所检测的所有数据包的总数的比值与预设的阈值A和B进行比较；如果大于阈值B，则确定该类的所有数据包为用户在网络中的正常行为所产生的网络传输数据包；如果小于某个阈值A，则确定该类的所有的数据包为网络入侵攻击行为所产生的网络传输数据包；如果该比值介于A和B之间，则根据规则库比对，判断该数据包的合法性。本发明第二方面提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现一种IPv6校园网的异常数据监测方法。本发明第三方面提供一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现一种IPv6校园网的异常数据监测方法。本发明与现有技术相比，具有如下的优点和有益效果：通过对IPv6校园网中捕获的数据包进行预处理，对解析的网络数据进行特征提取，基于数据特征消除数据包的结构的异构性，抽取有用数据，整合为一个通用的数据结构体，同时对网络数据的异构性进行消除，通过漂移区间识别，计算漂移区间平移距离进行异常数据和误用数据检测，发现数据包中包含的潜在威胁，提高数据传输的安全性。附图说明为了更清楚地说明本发明示例性实施方式的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。在附图中：图1为本发明实施例中的监测方法流程图。具体实施方式为使本发明的目的、技术方案和优点更加清楚明白，下面结合实施例和附图，对本发明作进一步的详细说明，本发明的示意性实施方式及其说明仅用于解释本发明，并不作为对本发明的限定。实施例1如图1所示，本实施例第一方面提供一种IPv6校园网的异常数据监测方法，包括以下具体步骤：从IPv6校园网中捕获传输的数据包，获取数据包中与IPv6规则链表节点匹配的网络数据；获取节点匹配的网络数据地址，基于地址对网络数据报头信息进行解析；对解析的网络数据进行特征提取，基于数据特征消除数据包的结构的异构性；基于消除异构性的网络数据进行数据拟合，得到识别差值序列进行漂移区间识别；计算漂移区间平移距离，基于平移距离对数据包进行异常数据和误用数据检测。本实施例通过对IPv6校园网中捕获的数据包进行预处理，对解析的网络数据进行特征提取，基于数据特征消除数据包的结构的异构性，抽取有用数据，整合为一个通用的数据结构体，通过漂移区间识别，计算漂移区间平移距离进行异常数据和误用数据检测，发现数据包中包含的潜在威胁，提高数据传输的安全性。在一些可能的实施例中，与IPv6规则链表节点匹配的判断步骤包括：获取数据包，解析数据包命令行和规则库，得到该数据包的规则链表；获取IPv6规则链表，将该数据包的规则链表与IPv6规则链表节点进行匹配；若匹配，则响应对该数据的解析命令。在一些可能的实施例中，获取节点匹配的网络数据地址包括：收集IPv6网络中活跃的IPv6地址集，对地址集中的地址进行预处理，筛选标准地址：其中，对地址集中的地址进行预处理包括：对活跃IPv6地址集中的地址进行位熵和十六进制位信息量的计算，以区分无序程度不同的各地址段；随后根据十六进制位信息量的值将连续且值大小接近的十六进制位划分为同一段，对每段的十六进制位的值进行统计分析，得到各段之间的统计结果与不同值的出现频率；接下来根据段内的值的出现频率训练贝叶斯网络分类器，发现不同分段之间的关联，寻找其间的依赖关系和依赖程度，输出网络数据的标准地址。在一些可能的实施例中，在进行数据包异常检测的过程中，需要构建一个统一的数据结构Packet来存储网络数据包传输过程中，可以用于辨别数据包是否为入侵网络数据的相关信息。使之能够处理IPv6网络数据包的第一步就是要在Packe数据结构中增加IPv6数据包的报头结构和IPv6扩展报头结构，在完善了IPv6的数据结构之后，才能对网络数据报头信息进行解析，对网络数据报头信息进行解析包括：获取当前地址的数据处理函数，基于处理函数对网络数据包的报头进行提取；将报头信息存入到数据结构中，判断下一个报头是否存在扩展报头，若是，则调用扩展报头解析报文；若否，则调用上层协议解析函数对网络数据进行解析。在一些可能的实施例中，对解析的网络数据进行特征提取包括获取报文入口，对业务报文头中某一个染色位进行标识，确定报文特征。在一些可能的实施例中，在降低向量维数时，可能会损失原始数据中具有可变性的一些特征向量，但同时会带来很多积极作用，能够消除数据结构的异构性，它是一种基于投影的方法，将一组相关变量转换为较小的n个特征子空间，同时尽可能多地保留原始文本的主要特征。在处理相似度匹配任务时，进行降维操作可以有效增加模型准确度，减少运算复杂性。因此，本实施例通过降低向量维数消除数据包的结构的异构性：获取数据特征的特征向量，对特征向量进行归一化；计算特征向量的协方差矩阵；计算协方差矩阵的特征值和特征向量；根据需求选取协方差矩阵前n列作为降维矩阵；获得的降维矩阵映射到低维空间完成降维计算，得到消除异构性的数据包。在一些可能的实施例中，进行漂移区间识别包括：获取目标数据段，计算消除异构性后网络数据的相关系数，选取相关性最强的两组数据；利用最小二乘法将两组数据进行拟合，计算目标数据与拟合曲线的差值；设置置信区间，识别差值序列中合理范围以外的部分，确定为漂移段位置。基于平移距离对数据包进行异常数据和误用数据检测包括：计算首个漂移位置数据与相邻的前一个数据的差值，得到平移距离；基于平移距离对数据包进行分类，检测数据数据包个数与此次分类的所检测的所有数据包的总数的比值与预设的阈值A和B进行比较；如果大于阈值B，则确定该类的所有数据包为用户在网络中的正常行为所产生的网络传输数据包；如果小于某个阈值A，则确定该类的所有的数据包为网络入侵攻击行为所产生的网络传输数据包；如果该比值介于A和B之间，则根据规则库比对，判断该数据包的合法性。本实施例第二方面提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，处理器执行程序时实现一种IPv6校园网的异常数据监测方法。本实施例第三方面提供一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现一种IPv6校园网的异常数据监测方法。以上所述的具体实施方式，对本发明的目的、技术方案和有益效果进行了进一步详细说明，所应理解的是，以上所述仅为本发明的具体实施方式而已，并不用于限定本发明的保护范围，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
