标题title
一种可信DCS上位机节点快速添加方法、系统、设备及介质
摘要abst
本发明公开一种可信DCS上位机节点快速添加方法、系统、设备及介质，属于工控安全部署领域，包括：接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；验证通过后，将可信设备信息导入到可信设备IP列表中；发送可信设备状态请求，基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。本发明降低设备入侵可信网络的风险。
权利要求书clms
1.一种可信DCS上位机节点快速添加方法，其特征在于，包括：接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。2.根据权利要求1所述的一种可信DCS上位机节点快速添加方法，其特征在于，所述接收可信设备的IP及连接请求之前，还包括：权限部署管理步骤，所述权限部署管理步骤具体包括：创建安全管理员账户和创建设备管理员账户；录入可信设备清单，包含设备名称和IP列表，可信设备清单经安全管理员批准后导入；可信设备包含可信校验证书。3.根据权利要求1所述的一种可信DCS上位机节点快速添加方法，其特征在于，所述登录请求还包括加密算法和计算机名，计算机名以密文的形式发送；所述加密算法采用SM1或SM4算法。4.根据权利要求1所述的一种可信DCS上位机节点快速添加方法，其特征在于，所述验证通过后针对登录请求进行回应，发送可信设备状态请求包括计算机名和状态字，计算机名以明文的形式发送。5.根据权利要求1所述的一种可信DCS上位机节点快速添加方法，其特征在于，所述验证用户名、密码和用户权限中，若验证不通过，则禁止可信设备接入。6.根据权利要求1所述的一种可信DCS上位机节点快速添加方法，其特征在于，所述基于可信设备状态请求获取可信设备的可信状态中，若读取设备可信状态为不可信，则禁止可信设备接入；所述批准可信设备入网包括：接收可信设备发送的心跳链接建立请求，心跳链接建立成功后，进行可信消息互动。7.根据权利要求1所述的一种可信DCS上位机节点快速添加方法，其特征在于，所述批准可信设备入网后，还包括确认可信设备状态和日志，并获取可信设备的相关度量值。8.一种可信DCS上位机节点快速添加系统，其特征在于，包括：接收模块，用于接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；验证模块，用于接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；导入模块，用于验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；批准模块，用于基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。9.一种电子设备，其特征在于，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现权利要求1-7任一项所述可信DCS上位机节点快速添加方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现权利要求1-7任一项所述可信DCS上位机节点快速添加方法。
说明书desc
技术领域本发明属于工控安全部署领域，涉及一种可信DCS上位机节点快速添加方法、系统、设备及介质。背景技术可信DCS控制器具备可信计算功能，可以对引导程序、操作系统内核、应用程序、配置文件及进程等进行可信验证，以保证控制器软硬件环境的可信性。随着工业系统的日益复杂化，工业管理系统对现场及数据单元设备进行接入通信管理。否则整个工业系统可能因为不安全的节点设备接入和病毒注入导致瘫痪，甚至数据泄露。在基于可信技术的火电厂工控系统工程实践中，大约电厂有20台以上的电脑，依靠在可信管理平台手动验证、录入和链接的效率较低并且安全性较差。尤其是现有的方法需要电厂安全管理员进行安全确认，整个确认过程复杂，操作难度大。为了快速安全的完成可信DCS部署，需要提供一种基于可信技术的快速部署方案。发明内容针对上述存在的不足，本发明的目的是提供一种可信DCS上位机节点快速添加方法、系统、设备及介质，该方法解决了现有设备部署过程中存在的安全性问题。为实现上述目的，本发明采用如下技术手段：本发明第一方面是提供一种可信DCS上位机节点快速添加方法，包括：接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。作为本发明进一步改进，所述接收可信设备的IP及连接请求之前，还包括：权限部署管理步骤，所述权限部署管理步骤具体包括：创建安全管理员账户和创建设备管理员账户；录入可信设备清单，包含设备名称和IP列表，可信设备清单经安全管理员批准后导入；可信设备包含可信校验证书。作为本发明进一步改进，所述登录请求还包括加密算法和计算机名，计算机名以密文的形式发送；所述加密算法采用SM1或SM4算法。作为本发明进一步改进，所述验证通过后针对登录请求进行回应，发送可信设备状态请求包括计算机名和状态字，计算机名以明文的形式发送。作为本发明进一步改进，所述验证用户名、密码和用户权限中，若验证不通过，则禁止可信设备接入。作为本发明进一步改进，所述基于可信设备状态请求获取可信设备的可信状态中，若读取设备可信状态为不可信，则禁止可信设备接入；所述批准可信设备入网包括：接收可信设备发送的心跳链接建立请求，心跳链接建立成功后，进行可信消息互动。作为本发明进一步改进，所述批准可信设备入网后，还包括确认可信设备状态和日志，并获取可信设备的相关度量值。本发明第二方面是提供一种可信DCS上位机节点快速添加系统，包括：接收模块，用于接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；验证模块，用于接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；导入模块，用于验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；批准模块，用于基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。本发明第三方面是提供一种电子设备，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现所述可信DCS上位机节点快速添加方法。本发明第四方面是提供一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现所述可信DCS上位机节点快速添加方法。与现有技术相比，本发明具有如下有益效果：本发明的方法在可信DCS组网的过程中，通过设备校验、人员权限校验、计算机可信校验，尤其是接收登录请求后进行验证，确保接入电厂网络的可信设备都是安全可靠并且经过审批的，整个节点添加过程降低外部人员的设备入侵可信网络的风险，降低电厂安全管理员的工作难度。附图说明图1为本发明给出的一种可信DCS上位机节点快速添加方法流程图；图2是本发明实施例给出的可信管理平台添加设备流程图；图3是本发明实施例给出的可信设备与可信管理平台信息交互图；图4为本发明提供的一种可信DCS上位机节点快速添加系统；图5为本发明提供的一种电子设备示意图。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分的实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本发明保护的范围。需要说明的是，本发明的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本发明的实施例能够以除了在这里图示或描述的那些以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。术语解释：分散控制系统是以微处理器为基础，采用控制功能分散、显示操作集中、兼顾分而自治和综合协调的设计原则的新一代仪表控制系统。集散控制系统简称DCS，也可为“分散控制系统”或“分布式计算机控制系统”。可信进程是能够影响系统安全性的进程，可信进程的保护能力或性质必须根据系统需求可靠地。如图1所示，本发明第一个目的是提供一种可信DCS上位机节点快速添加方法，应用于可信管理平台，包括以下步骤：S1，接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；S2，接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；S3，验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；S4，基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。本发明实施例的方法提供的可信DCS上位机节点快速添加方法，解决了现有设备部署过程中存在的安全性问题。该方案需要从操作人员权限管理、可信设备认证加密、数据加密安全同步等方面确保部署过程每个步骤都安全高效。当然，上述方法是以可信设备为主体进行限定，这里不再重复。作为可选实施例，本发明实施例步骤S1中的接收可信设备的IP及连接请求之前，还包括：权限部署管理步骤，所述权限部署管理步骤具体包括：创建安全管理员账户和创建设备管理员账户；录入可信设备清单，包含设备名称和IP列表，可信设备清单经安全管理员批准后导入；可信设备包含可信校验证书。该步骤能够提前进行权限部署，做到后续验证有证可查，确保整个部署的风险降低。作为一些实施例，步骤S2中，接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；接收登录请求后进行验证，具体是：对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；包括：接收可信设备发送的登录请求，登录请求包括加密算法和计算机名，计算机名以密文的形式发送；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；验证通过后针对登录请求进行回应，发送计算机名和状态字，计算机名以明文的形式发送；批准可信设备入网包括：接收可信设备发送的心跳链接建立请求，心跳链接建立成功后，进行可信消息互动。如下结合具体实施例对本发明的方法做进一步说明。如图2所示，在部署过程中，主要的安全影响因素包括部署人员权限管理，硬件设备可信验证，可信策略的可视化配置等方面。因此主要从这三个方面着手进行快速部署。具体的部署步骤如下：1）电厂业主任命一位安全管理员，创建安全管理员账户；DCS系统安装工程人员创建设备管理员账户。2）安全管理员和设备管理员录入可信管理平台。3）设备厂商提供可信设备，其中包含可信校验证书。4）录入可信设备清单，包含设备名称和IP列表，可信设备清单经安全管理员批准后导入可信管理平台。5）可信设备设置IP并通过设备管理员账户连接可信管理平台，可信管理平台通过IP对比，确认接入设备为目标设备。6）可信设备发送登录请求时，明文显示加密算法。作为可选实施例，加密算法采用SM1或SM4等对称加密国密算法，通过可信校验证书秘钥加密计算机名、用户名和密码并发送给可信管理平台。7）可信管理平台采用可信校验证书对应算法进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备一致，验证用户名、密码和用户权限，验证通过后将可信设备导入到可信设备IP列表，并发起首次可信设备状态请求。其中，作为具体实施例，验证包括可信校验证书、计算机名和用户权限。如果验证失败，则禁止可信设备接入。8）可信管理平台通过加密通信获取可信状态，确认可信状态正常的情况下，批准可信设备入网。其中，作为具体实施例，可信状态包括可信校验证书、计算机名和用户权限。若读取设备可信状态为不可信，则禁止可信设备接入。9）安全管理员在可信管理平台确认可信设备状态和日志，并重新获取度量值，更新后并进行存储。如图3所示，本发明具体实施例中给出可信设备与可信管理平台信息交互流程，具体包括：S31，可信设备发送登录请求，登录请求包括加密算法和计算机名，计算机名以密文的形式发送；S32，可信管理平台针对登录请求进行回应，发送计算机名和状态字，计算机名以明文的形式发送；S33，可信设备发送建立心跳链接；S34，可信设备与可信管理平台心跳链接建立成功；S35，可信设备与可信管理平台可信消息互动；S36，可信设备发送断链请求；S37，可信管理平台答复断开链接。至此完成可信设备与可信管理平台信息交互全部过程。如图4所示，本发明还提供一种可信DCS上位机节点快速添加系统，包括：接收模块，用于接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；验证模块，用于接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；导入模块，用于验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；批准模块，用于基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。如图4所示，本发明提供一种电子设备，包括存储器、处理器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现所述可信DCS上位机节点快速添加方法。所述可信DCS上位机节点快速添加方法包括以下步骤：S1，接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；S2，接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；S3，验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；S4，基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。本发明还提供一种计算机可读存储介质，所述计算机可读存储介质存储有计算机程序，所述计算机程序被处理器执行时实现所述可信DCS上位机节点快速添加方法。所述可信DCS上位机节点快速添加方法包括以下步骤：S1，接收可信设备的IP及连接请求，基于预先录入的IP列表进行IP对比，对比通过后，接入可信设备；S2，接收可信设备的登录请求，登录请求包括可信校验证书、计算机名、用户名和密码；对可信校验证书进行解密并校验，校验通过后对比计算机名和IP与批准接入的可信设备的一致性，并验证用户名、密码和用户权限；S3，验证通过后，将可信设备信息导入到可信设备IP列表中，并发送可信设备状态请求；S4，基于可信设备状态请求获取可信设备的可信状态，确认可信状态正常的情况下，批准可信设备入网，节点添加完成。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明是参照根据本发明实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。
