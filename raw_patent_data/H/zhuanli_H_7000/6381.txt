标题title
基于权重分配相关系数的黑启动过电压预测方法及系统
摘要abst
本公开属于黑启动过电压预测技术领域，具体提出一种基于权重分配相关系数的黑启动过电压预测方法及系统，该方法获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，利用皮尔逊相关系数、余弦相似度计算第一相关系数集和第二相关系数集；利用循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于合闸过电压、过电压预测值集、两个相关系数集获得目标相关系数集；采用改进的鲸鱼算法获得神经网络模型中各神经元的最优权值和最优阈值进而得到目标神经网络模型；基于多种电压影响参数和目标相关系数集获得目标输入数据以输入目标神经网络模型输出合闸过电压目标预测值。根据本公开的方法提高了黑启动过电压预测的准确性。
权利要求书clms
1.一种基于权重分配相关系数的黑启动过电压预测方法，其特征在于，包括：获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，所述多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；利用皮尔逊相关系数计算所述合闸过电压和所述多种电压影响参数的第一相关系数集；利用余弦相似度计算所述合闸过电压和所述多种电压影响参数的第二相关系数集；基于所述多种电压影响参数、所述第一相关系数集、所述第二相关系数集获得模型输入数据，将所述模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于所述合闸过电压、所述过电压预测值集、所述第一相关系数集和所述第二相关系数集获得目标相关系数集；构建神经网络模型，将所述神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；基于所述多种电压影响参数和所述目标相关系数集获得目标输入数据，将所述目标输入数据输入所述目标神经网络模型输出合闸过电压目标预测值。2.如权利要求1所述的基于权重分配相关系数的黑启动过电压预测方法，其特征在于，利用收敛因子的初始值和终值、非线性均衡系数和最大迭代次数对鲸鱼算法的收敛因子进行优化，以得到所述改进的鲸鱼算法。3.如权利要求1所述的基于权重分配相关系数的黑启动过电压预测方法，其特征在于，所述神经网络模型采用BP神经网络。4.如权利要求1所述的基于权重分配相关系数的黑启动过电压预测方法，其特征在于，所述模型输入数据包括第一模型输入数据和第二模型输入数据，所述过电压预测值集包括第一过电压预测值集和第二过电压预测值集；所述基于所述多种电压影响参数、所述第一相关系数集、所述第二相关系数集获得模型输入数据，将所述模型输入数据输入循环神经网络模型得到过电压预测值集，包括：基于所述多种电压影响参数和所述第一相关系数集获得第一模型输入数据，将所述第一模型输入数据输入循环神经网络模型得到第一过电压预测值集；基于所述多种电压影响参数和所述第二相关系数集获得第二模型输入数据，将所述第二模型输入数据输入循环神经网络模型得到第二过电压预测值集。5.如权利要求4所述的基于权重分配相关系数的黑启动过电压预测方法，其特征在于，所述采用权重分配相关系数法，基于所述合闸过电压、所述过电压预测值集、所述第一相关系数集和所述第二相关系数集获得目标相关系数集，包括：基于所述合闸过电压和所述第一过电压预测值集获得第一误差；基于所述合闸过电压和所述第二过电压预测值集获得第二误差；采用权重分配相关系数法，基于所述第一误差、所述第二误差、所述第一相关系数集和所述第二相关系数集获得目标相关系数集。6.一种基于权重分配相关系数的黑启动过电压预测系统，其特征在于，包括：获取模块，用于获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，所述多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；系数计算模块，用于利用皮尔逊相关系数计算所述合闸过电压和所述多种电压影响参数的第一相关系数集；利用余弦相似度计算所述合闸过电压和所述多种电压影响参数的第二相关系数集；权重分配模块，用于基于所述多种电压影响参数、所述第一相关系数集、所述第二相关系数集获得模型输入数据，将所述模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于所述合闸过电压、所述过电压预测值集、所述第一相关系数集和所述第二相关系数集获得目标相关系数集；建模模块，用于构建神经网络模型，将所述神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；预测模块，用于基于所述多种电压影响参数和所述目标相关系数集获得目标输入数据，将所述目标输入数据输入所述目标神经网络模型输出合闸过电压目标预测值。7.如权利要求6 所述的基于权重分配相关系数的黑启动过电压预测系统，其特征在于，在所述建模模块中，利用收敛因子的初始值和终值、非线性均衡系数和最大迭代次数对鲸鱼算法的收敛因子进行优化，以得到所述改进的鲸鱼算法。8.如权利要求6 所述的基于权重分配相关系数的黑启动过电压预测系统，其特征在于，所述模型输入数据包括第一模型输入数据和第二模型输入数据，所述过电压预测值集包括第一过电压预测值集和第二过电压预测值集，所述权重分配模块，具体用于：基于所述多种电压影响参数和所述第一相关系数集获得第一模型输入数据，将所述第一模型输入数据输入循环神经网络模型得到第一过电压预测值集；基于所述多种电压影响参数和所述第二相关系数集获得第二模型输入数据，将所述第二模型输入数据输入循环神经网络模型得到第二过电压预测值集。9.如权利要求8 所述的基于权重分配相关系数的黑启动过电压预测系统，其特征在于，所述权重分配模块，具体用于：基于所述合闸过电压和所述第一过电压预测值集获得第一误差；基于所述合闸过电压和所述第二过电压预测值集获得第二误差；采用权重分配相关系数法，基于所述第一误差、所述第二误差、所述第一相关系数集和所述第二相关系数集获得目标相关系数集。10.一种基于权重分配相关系数的黑启动过电压预测设备，其特征在于，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行权利要求1-5中任一项所述的基于权重分配相关系数的黑启动过电压预测方法。
说明书desc
技术领域本公开属于黑启动过电压预测技术领域，尤其涉及一种基于权重分配相关系数的黑启动过电压预测方法及系统。背景技术黑启动是在整个系统全停后进行的自救和恢复，整个过程中电力系统处于十分薄弱的状态，任何微小的偏差和扰动都有可能造成黑启动的失败。因此制定后的黑启动方案需要经过严格的审核和仿真校验方能实施。其中，对黑启动过电压的校验是黑启动方案校验的重要组成部分。现有技术中虽然有提出用人工智能方法对空载合闸过电压进行快速预测。但是，影响黑启动过电压的因素众多，现有技术未考虑线路参数、断路器合闸初相角等因素对过电压的影响，造成预测结果不准确，此外也没有考虑不同的因素对过电压的影响程度的不同，从而影响预测结果。发明内容本公开旨在至少在一定程度上解决相关技术中的技术问题之一。为此，本公开提供了一种基于权重分配相关系数的黑启动过电压预测方法及系统，主要目的在于提高黑启动过电压预测的准确性。根据本公开的第一方面，提供了一种基于权重分配相关系数的黑启动过电压预测方法，包括：获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，所述多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；利用皮尔逊相关系数计算所述合闸过电压和所述多种电压影响参数的第一相关系数集；利用余弦相似度计算所述合闸过电压和所述多种电压影响参数的第二相关系数集；基于所述多种电压影响参数、所述第一相关系数集、所述第二相关系数集获得模型输入数据，将所述模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于所述合闸过电压、所述过电压预测值集、所述第一相关系数集和所述第二相关系数集获得目标相关系数集；构建神经网络模型，将所述神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；基于所述多种电压影响参数和所述目标相关系数集获得目标输入数据，将所述目标输入数据输入所述目标神经网络模型输出合闸过电压目标预测值。在本公开第一方面提供的基于权重分配相关系数的黑启动过电压预测方法中，利用收敛因子的初始值和终值、非线性均衡系数和最大迭代次数对鲸鱼算法的收敛因子进行优化，以得到所述改进的鲸鱼算法。在本公开第一方面提供的基于权重分配相关系数的黑启动过电压预测方法中，所述神经网络模型采用BP神经网络。在本公开第一方面提供的基于权重分配相关系数的黑启动过电压预测方法中，所述模型输入数据包括第一模型输入数据和第二模型输入数据，所述过电压预测值集包括第一过电压预测值集和第二过电压预测值集；所述基于所述多种电压影响参数、所述第一相关系数集、所述第二相关系数集获得模型输入数据，将所述模型输入数据输入循环神经网络模型得到过电压预测值集，包括：基于所述多种电压影响参数和所述第一相关系数集获得第一模型输入数据，将所述第一模型输入数据输入循环神经网络模型得到第一过电压预测值集；基于所述多种电压影响参数和所述第二相关系数集获得第二模型输入数据，将所述第二模型输入数据输入循环神经网络模型得到第二过电压预测值集。在本公开第一方面提供的基于权重分配相关系数的黑启动过电压预测方法中，所述采用权重分配相关系数法，基于所述合闸过电压、所述过电压预测值集、所述第一相关系数集和所述第二相关系数集获得目标相关系数集，包括：基于所述合闸过电压和所述第一过电压预测值集获得第一误差；基于所述合闸过电压和所述第二过电压预测值集获得第二误差；采用权重分配相关系数法，基于所述第一误差、所述第二误差、所述第一相关系数集和所述第二相关系数集获得目标相关系数集。根据本公开的第二方面，还提供了一种基于权重分配相关系数的黑启动过电压预测系统，包括：获取模块，用于获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，所述多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；系数计算模块，用于利用皮尔逊相关系数计算所述合闸过电压和所述多种电压影响参数的第一相关系数集；利用余弦相似度计算所述合闸过电压和所述多种电压影响参数的第二相关系数集；权重分配模块，用于基于所述多种电压影响参数、所述第一相关系数集、所述第二相关系数集获得模型输入数据，将所述模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于所述合闸过电压、所述过电压预测值集、所述第一相关系数集和所述第二相关系数集获得目标相关系数集；建模模块，用于构建神经网络模型，将所述神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；预测模块，用于基于所述多种电压影响参数和所述目标相关系数集获得目标输入数据，将所述目标输入数据输入所述目标神经网络模型输出合闸过电压目标预测值。在本公开第二方面提供的基于权重分配相关系数的黑启动过电压预测系统中，在所述建模模块中，利用收敛因子的初始值和终值、非线性均衡系数和最大迭代次数对鲸鱼算法的收敛因子进行优化，以得到所述改进的鲸鱼算法。在本公开第二方面提供的基于权重分配相关系数的黑启动过电压预测系统中，所述模型输入数据包括第一模型输入数据和第二模型输入数据，所述过电压预测值集包括第一过电压预测值集和第二过电压预测值集，所述权重分配模块，具体用于：基于所述多种电压影响参数和所述第一相关系数集获得第一模型输入数据，将所述第一模型输入数据输入循环神经网络模型得到第一过电压预测值集；基于所述多种电压影响参数和所述第二相关系数集获得第二模型输入数据，将所述第二模型输入数据输入循环神经网络模型得到第二过电压预测值集。在本公开第二方面提供的基于权重分配相关系数的黑启动过电压预测系统中，所述权重分配模块，具体用于：基于所述合闸过电压和所述第一过电压预测值集获得第一误差；基于所述合闸过电压和所述第二过电压预测值集获得第二误差；采用权重分配相关系数法，基于所述第一误差、所述第二误差、所述第一相关系数集和所述第二相关系数集获得目标相关系数集。根据本公开的第三方面，还提供了一种基于权重分配相关系数的黑启动过电压预测设备，包括：至少一个处理器；以及与所述至少一个处理器通信连接的存储器；其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行本公开的第一方面实施例提出的基于权重分配相关系数的黑启动过电压预测方法。在本公开一个或多个方面中，获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；利用皮尔逊相关系数计算合闸过电压和多种电压影响参数的第一相关系数集；利用余弦相似度计算合闸过电压和多种电压影响参数的第二相关系数集；基于多种电压影响参数、第一相关系数集、第二相关系数集获得模型输入数据，将模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于合闸过电压、过电压预测值集、第一相关系数集和第二相关系数集获得目标相关系数集；构建神经网络模型，将神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；基于多种电压影响参数和目标相关系数集获得目标输入数据，将目标输入数据输入目标神经网络模型输出合闸过电压目标预测值。在这种情况下，综合考虑合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角对合闸过电压的影响，结合皮尔逊相关系数、余弦相似度和权重分配相关系数法充分考虑不同的因素对过电压的影响程度，提高了黑启动过电压预测的准确性，另外还采用改进的鲸鱼算法提高神经网络模型的精度，进一步提高了黑启动过电压预测的准确性。本公开附加的方面和优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本公开的实践了解到。附图说明本公开上述的和/或附加的方面和优点从下面结合附图对实施例的描述中将变得明显和容易理解，其中：图1示出本公开实施例提供的一种基于权重分配相关系数的黑启动过电压预测方法的流程示意图；图2示出本公开实施例提供的另一种基于权重分配相关系数的黑启动过电压预测方法的流程示意图；图3示出本公开实施例提供的基于权重分配相关系数的黑启动过电压预测系统的框图；图4是用来实现本公开实施例的基于权重分配相关系数的黑启动过电压预测方法的基于权重分配相关系数的黑启动过电压预测设备的框图。具体实施方式这里将详细地对示例性实施例进行说明，其示例表示在附图中。下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。以下示例性实施例中所描述的实施方式并不代表与本公开实施例相一致的所有实施方式。相反，它们仅是与如所附权利要求书中所详述的、本公开实施例的一些方面相一致的装置和方法的例子。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本公开的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本公开的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。还应当理解，本公开中使用的术语“和/或”是指并包含一个或多个相关联的列出项目的任何或所有可能组合。下面详细描述本公开的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，旨在用于解释本公开，而不能理解为对本公开的限制。本公开提供了一种基于权重分配相关系数的黑启动过电压预测方法及系统，主要目的在于提高黑启动过电压预测的准确性。在第一个实施例中，图1示出本公开实施例提供的一种基于权重分配相关系数的黑启动过电压预测方法的流程示意图。图2示出本公开实施例提供的另一种基于权重分配相关系数的黑启动过电压预测方法的流程示意图。如图1所示，该基于权重分配相关系数的黑启动过电压预测方法，包括：步骤S11，获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角。在步骤S11中，获取的电网黑启动过程中空载线路的合闸过电压的数量可以是n个。获取的所有的合闸过电压可以称为合闸过电压集。由n个合闸过电压组成的合闸过电压集可以用符号Y表示。在步骤S11中，多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角7种电压影响参数。在步骤S11中，多种电压影响参数为对应合闸过电压下的多种电压影响参数。例如在获取每个合闸过电压时获取该合闸过电压下的7种电压影响参数。故n个合闸过电压对应7n个电压影响参数，其中7n个电压影响参数包含7种电压影响参数，每种电压影响参数包括n个该种电压影响参数。在步骤S11中，多种电压影响参数可以称为影响参数原始数据集。例如7n个电压影响参数对应的影响参数原始数据集X为一个n×7的矩阵。影响参数原始数据集可以表示为，其中，X1为n个合闸线路长度，X2为n个线路并联电抗器补偿值，X3为n个电源电阻，X4为n个电源漏抗，X5为n个线路每千米电阻，X6为n个线路每千米正序电抗，X7为n个合闸初相角。步骤S12，利用皮尔逊相关系数计算合闸过电压和多种电压影响参数的第一相关系数集；利用余弦相似度计算合闸过电压和多种电压影响参数的第二相关系数集。易于理解地，皮尔逊相关系数能衡量2个特征之间有无线性相关性及相关程度大小，故步骤S12中使用皮尔逊相关系数衡量黑启动过电压与其他的特征的相关性，皮尔逊相关系数满足：其中，表示第i种电压影响参数与合闸过电压的相关性强弱，/＞值为正表示第i种电压影响参数与合闸过电压之间呈正相关，/＞值为负表示第i种电压影响参数与合闸过电压之间呈负相关。i=1、2、…、7，即第一相关系数集/＞为/＞。第一相关系数集/＞可以看做一个7×1的矩阵。/＞表示影响参数原始数据集中第i种电压影响参数的n个数值的和，/＞表示n个合闸过电压的和。E是协方差。易于理解地，余弦相似度通过计算两个向量间的夹角余弦度值来衡量2个特征之间有无线性相关性及相关程度大小。故步骤S12中使用余弦相似度衡量黑启动过电压与其他特征的相关性，余弦相似度满足：式中，表示第i种电压影响参数与合闸过电压的相关性强弱，i=1、2、…、7，即第二相关系数集/＞为/＞第二相关系数集/＞可以看做一个7×1的矩阵。其中表示余弦函数。步骤S13，基于多种电压影响参数、第一相关系数集、第二相关系数集获得模型输入数据，将模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于合闸过电压、过电压预测值集、第一相关系数集和第二相关系数集获得目标相关系数集。在步骤S13中，考虑到皮尔逊相关系数有一个明显的缺点，即其接近于1的程度与样本容量相关，在样本容量较小时，仅凭相关系数较大就判定变量与/＞之间有密切的线性关系误差较大。余弦相似度对具体数值的绝对值大小不敏感。因此，结合循环神经网络模型和权重分配相关系数法构成新的相关系数，以更加准确地挖掘特征值与合闸过电压之间的相关性的问题，进而提高后续预测的准确性。具体地，在步骤S13中，循环神经网络模型可以选用GRU网络模型。易于理解地，GRU网络模型的表达式如下：其中，为s时刻的重置门，/＞为内部状态，/＞为重置门中的第一参数，/＞为重置门中的第二参数，hs-1为相对于当前时刻的上一时刻的隐层状态，/＞为当前时刻GRU的输入；/＞为s时刻的更新门，/＞为更新门中的第一参数，/＞为更新门中的第二参数，/＞为经过重置门处理后的输出候选值，为求取输出候选值/＞过程中的第一参数，/＞为求取输出候选值/＞过程中的第二参数；运算符“/＞”表示进行数组元素依次相乘。/＞为s时刻的隐层状态，/＞为s时刻的候选隐藏层。另外，重置门和更新门都是一个简单的神经网络，为了使门的输出固定在0～1之间，神经网络的激活函数采用sigmoid函数。在步骤S13中，模型输入数据包括第一模型输入数据和第二模型输入数据，过电压预测值集包括第一过电压预测值集和第二过电压预测值集。其中，第一模型输入数据可以用X’表示，第一过电压预测值集可以用Y’表示，第二模型输入数据可以用X”表示，第二过电压预测值集可以用Y”表示。在步骤S13中，基于多种电压影响参数、第一相关系数集、第二相关系数集获得模型输入数据，将模型输入数据输入循环神经网络模型得到过电压预测值集，包括：基于多种电压影响参数和第一相关系数集获得第一模型输入数据，将第一模型输入数据输入循环神经网络模型得到第一过电压预测值集；基于多种电压影响参数和第二相关系数集获得第二模型输入数据，将第二模型输入数据输入循环神经网络模型得到第二过电压预测值集。具体地，第一模型输入数据X’满足，第二模型输入数据X”满足/＞，其中，X表示影响参数原始数据集，/＞为第一相关系数集，/＞为第二相关系数集。将X’和X”分别代入GRU网络模型中进行预测得到第一过电压预测值集Y’和第二过电压预测值集Y”。在步骤S13中，采用权重分配相关系数法，基于合闸过电压、过电压预测值集、第一相关系数集和第二相关系数集获得目标相关系数集，包括：基于合闸过电压和第一过电压预测值集获得第一误差；基于合闸过电压和第二过电压预测值集获得第二误差；采用权重分配相关系数法，基于第一误差、第二误差、第一相关系数集和第二相关系数集获得目标相关系数集。具体地，可以采用平均相对误差计算第一误差、第二误差。其中平均相对误差满足：其中，为实际值，该实际值为合闸过电压集Y中第i个值，/＞为预测值，当/＞第一过电压预测值集Y’中第i个值时计算得到第一误差/＞，当/＞第二过电压预测值集Y”中第i个值时计算得到第二误差/＞，n为样本总数，即合闸过电压集Y中合闸过电压的数量。采用权重分配相关系数法分别基于第一误差和第二误差得到第一相关系数集的第一权重和第二相关系数集的第二权重，基于第一权重、第二权重、第一相关系数集和第二相关系数集获得目标相关系数集。其中第一权重满足：，第二权重满足：。目标相关系数集满足：其中，表示第i个目标相关系数，i=1、2、…、7，也即目标相关系数集/＞表示为目标相关系数集/＞可以看做一个7×1的矩阵。目标相关系数集/＞也称惯性权重相关系数。步骤S14，构建神经网络模型，将神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型。在步骤S14中，构建的神经网络模型采用BP神经网络。易于理解地，BP神经网络是一种由误差反向传播算法训练的多层前馈网络，BP神经网络包含输入层、隐含层、输出层，分为前向传递和反向传播两个阶段，前向传递中信号经过一系列计算从输入层经隐含层传递到输出层计算预测值，若输出层的预测值与输入层的实际值误差未达到阈值，再通过误差反向传播来更新网络的权值与偏置大小，降低误差。其中，BP神经网络包含的输入层、隐含层、输出层中每层都包括至少一个神经元，每个神经元都有初始权值和初始阈值。在步骤S14中，采用的改进的鲸鱼算法是在传统的鲸鱼算法的基础上进行改进得到的。易于理解地，传统的鲸鱼算法一般包括包围目标猎物、螺旋线位置更新和搜寻猎物。其中，在包围目标猎物中以距离猎物位置最近的座头鲸位置为最优解，剩余座头鲸以向该最优解位置靠拢为目的，逐渐更新自身位置，其中，包围目标猎物的数学模型的计算式为：式中，D为鲸鱼个体与当前最优解的距离，是第t次迭代对应的全局最优解，为第t次迭代对应的鲸鱼的位置，A为第一系数，C为第二系数，/＞为第t+1次迭代对应的鲸鱼的位置，其中，/＞、/＞，/＞为第一随机向量，/＞为第二随机向量，/＞,均属于，/＞为收敛因子，/＞，/＞为最大迭代次数。在螺旋线位置更新中，以螺旋上升的形式游向猎物，螺旋形路径的数学表达如下：式中，=|X*-X|，/＞表示鲸鱼与猎物之间的距离，b是一个常数，l是位于之间的随机数。鲸鱼狩猎时假设有鲸鱼有50%的概率在收缩包围和螺旋上升之间进行随机选择,优化鲸鱼的位置。表达式如下：在搜寻猎物中，搜寻猎物阶段的数学模型的计算式如下：式中，为当前迭代t随机选取的鲸鱼个体的位置。考虑到WOA算法在进化搜索过程中却是非线性变化的，收敛因子a线性递减策略不能完全体现出算法实际的优化搜索过程，因此在步骤S14中，利用收敛因子的初始值和终值、非线性均衡系数和最大迭代次数对鲸鱼算法的收敛因子进行优化，以得到改进的鲸鱼算法。具体地，优化后的收敛因子a’满足：式中，和/＞分别为收敛因子的初始值和终值，/＞为非线性均衡系数，其值位于，将优化后的收敛因子替换传统鲸鱼算法中的收敛因子，得到改进的鲸鱼算法，改进后平衡了WOA的全局和局部搜索能力。在步骤S14中，将神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型。具体地，得到目标神经网络模型过程如下：1）BP神经网络初始化：确定神经网络初始结构，以及连接神经元的初始权值和初始阈值；2）鲸鱼算法初始化: 将第一步的初始权值和初始阈值转化为座头鲸的位置向量，设置种群规模、最大迭代次数、初始最小权重和最大权重以及收敛因子，选取均方误差作为优化的目标函数；3）计算个体适应度值: 找出并记录最优适应度值的个体位置，将其作为最优个体位置；4）将优化得到的权值和阈值参数赋给BP神经网络；5）根据位置更新策略更新个体位置；6）设置终止策略，满足最大迭代次数或达到精度要求后终止运算，将最优权值和最优阈值赋给 BP 神经网络得到目标神经网络模型。步骤S15，基于多种电压影响参数和目标相关系数集获得目标输入数据，将目标输入数据输入目标神经网络模型输出合闸过电压目标预测值。在步骤S15中，基于多种电压影响参数和目标相关系数集获得目标输入数据。目标输入数据用M表示，目标输入数据M满足，将目标输入数据M输入到IWOA-BP模型进行预测得到最终的预测结果，该最终的预测结果即为所需的合闸过电压目标预测值。为了验证本公开的方法的效果，构建了黑启动过程中 500 kV 空载线路合闸过电压计算的等值网络。下面用该网络作为算例来验证基于组合模型的黑启动空充线路统计过电压快速预测方法的有效性。设置电源电阻 Rs=10Ω～ 40Ω，间隔为 10 Ω；合闸线路长度l=260km～340km，间隔为40km；并联电抗器补偿值Q=50 MVAR～60MVAR，间隔为5 MVAR；电源漏抗xs=125Ω～140Ω，间隔5Ω。多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每km电阻、线路每km正序电抗和合闸初相角7种电压影响参数。选择平均绝对误差、平均绝对百分比误差及均方根误差为模型评价标准，其中所有模型均使用MAE作为训练时的损失函数。在实验时分别利用皮尔逊系数-IWOA-BP模型、余弦相似度-IWOA-BP模型、以及惯性权重相关系数-WOA-BP与本公开的模型进行了对比。结果如表1所示。表1模型评价标准表模型MAEMAPERMSE皮尔逊系数-IWOA-BP0.07020.03920.267余弦相似度-IWOA-BP0.06980.04300.244惯性权重相关系数-WOA-BP0.04320.02110.201惯性权重相关系数-IWOA-BP0.02210.01980.187从表1中可以看出采用惯性权重系数的模型比单独采用皮尔逊系数或者余弦相似度的预测准确度要高，证明了惯性权重系数对提高精确度的重要性。采用惯性权重相关系数-IWOA-BP模型的预测精度比惯性权重相关系数-WOA-BP模型的预测精度高，证明了采用非线性收敛因子能够平衡WOA的全局和局部搜索能力。在本公开实施例的基于权重分配相关系数的黑启动过电压预测方法中，获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；利用皮尔逊相关系数计算合闸过电压和多种电压影响参数的第一相关系数集；利用余弦相似度计算合闸过电压和多种电压影响参数的第二相关系数集；基于多种电压影响参数、第一相关系数集、第二相关系数集获得模型输入数据，将模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于合闸过电压、过电压预测值集、第一相关系数集和第二相关系数集获得目标相关系数集；构建神经网络模型，将神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；基于多种电压影响参数和目标相关系数集获得目标输入数据，将目标输入数据输入目标神经网络模型输出合闸过电压目标预测值。在这种情况下，综合考虑合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角对合闸过电压的影响，结合皮尔逊相关系数、余弦相似度和权重分配相关系数法充分考虑不同的因素对过电压的影响程度，提高了黑启动过电压预测的准确性，另外还采用改进的鲸鱼算法提高神经网络模型的精度，进一步提高了黑启动过电压预测的准确性。在本公开的方法是一种基于权重分配相关系数的组合预测模型的黑启动操作过电压预测方法，其采用权重分配相关系数法，采用皮尔逊相关系数法和余弦相似度分别提取关联度高的特征，然后依据已知特征构造出新的特征，分别放入GRU进行预测，依据预测结果设立权重系数，构成新的相关系数，最后用已知新的相关系数与原始数据相乘输入IWOA-BP进行预测。由此，解决了单独采用皮尔逊相关系数或余弦相似度时其本身方法存在的缺陷，即解决了不能准确的挖掘特征值与过电压之间的相关性的问题。另外利用改进的鲸鱼算法克服了传统鲸鱼算法在处理复杂全局优化问题时存在解精度低和收敛速度慢等缺点。下述为本公开系统实施例，可以用于执行本公开方法实施例。对于本公开系统实施例中未披露的细节，请参照本公开方法实施例。请参见图3，图3示出本公开实施例提供的基于权重分配相关系数的黑启动过电压预测系统的框图。该基于权重分配相关系数的黑启动过电压预测系统可以通过软件、硬件或者两者的结合实现成为系统的全部或一部分。该基于权重分配相关系数的黑启动过电压预测系统10包括获取模块11、系数计算模块12、权重分配模块13、建模模块14和预测模块15，其中：获取模块11，用于获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；系数计算模块12，用于利用皮尔逊相关系数计算合闸过电压和多种电压影响参数的第一相关系数集；利用余弦相似度计算合闸过电压和多种电压影响参数的第二相关系数集；权重分配模块13，用于基于多种电压影响参数、第一相关系数集、第二相关系数集获得模型输入数据，将模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于合闸过电压、过电压预测值集、第一相关系数集和第二相关系数集获得目标相关系数集；建模模块14，用于构建神经网络模型，将神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；预测模块15，用于基于多种电压影响参数和目标相关系数集获得目标输入数据，将目标输入数据输入目标神经网络模型输出合闸过电压目标预测值。可选地，在建模模块14中，利用收敛因子的初始值和终值、非线性均衡系数和最大迭代次数对鲸鱼算法的收敛因子进行优化，以得到改进的鲸鱼算法。可选地，在建模模块14中，神经网络模型采用BP神经网络。可选地，模型输入数据包括第一模型输入数据和第二模型输入数据，过电压预测值集包括第一过电压预测值集和第二过电压预测值集。可选地，权重分配模块13，具体用于：基于多种电压影响参数和第一相关系数集获得第一模型输入数据，将第一模型输入数据输入循环神经网络模型得到第一过电压预测值集；基于多种电压影响参数和第二相关系数集获得第二模型输入数据，将第二模型输入数据输入循环神经网络模型得到第二过电压预测值集。可选地，权重分配模块13，具体用于：基于合闸过电压和第一过电压预测值集获得第一误差；基于合闸过电压和第二过电压预测值集获得第二误差；采用权重分配相关系数法，基于第一误差、第二误差、第一相关系数集和第二相关系数集获得目标相关系数集。要说明的是，上述实施例提供的基于权重分配相关系数的黑启动过电压预测系统在执行基于权重分配相关系数的黑启动过电压预测方法时，仅以上述各功能模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将基于权重分配相关系数的黑启动过电压预测设备的内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能。另外，上述实施例提供的基于权重分配相关系数的黑启动过电压预测系统与基于权重分配相关系数的黑启动过电压预测方法实施例属于同一构思，其体现实现过程详见方法实施例，这里不再赘述。上述本公开实施例序号仅仅为了描述，不代表实施例的优劣。在本公开实施例的基于权重分配相关系数的黑启动过电压预测系统，获取模块用于获取电网黑启动过程中空载线路的合闸过电压和多种电压影响参数，多种电压影响参数包括合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角；系数计算模块用于利用皮尔逊相关系数计算合闸过电压和多种电压影响参数的第一相关系数集；利用余弦相似度计算合闸过电压和多种电压影响参数的第二相关系数集；权重分配模块用于基于多种电压影响参数、第一相关系数集、第二相关系数集获得模型输入数据，将模型输入数据输入循环神经网络模型得到过电压预测值集，采用权重分配相关系数法，基于合闸过电压、过电压预测值集、第一相关系数集和第二相关系数集获得目标相关系数集；建模模块用于构建神经网络模型，将神经网络模型的各神经元的初始权值和初始阈值作为座头鲸的位置向量，误差函数作为适应度函数，采用改进的鲸鱼算法获得各神经元的最优权值和最优阈值，基于最优权值和最优阈值得到目标神经网络模型；预测模块用于基于多种电压影响参数和目标相关系数集获得目标输入数据，将目标输入数据输入目标神经网络模型输出合闸过电压目标预测值。在这种情况下，综合考虑合闸线路长度、线路并联电抗器补偿值、电源电阻、电源漏抗、线路每千米电阻、线路每千米正序电抗和合闸初相角对合闸过电压的影响，结合皮尔逊相关系数、余弦相似度和权重分配相关系数法充分考虑不同的因素对过电压的影响程度，提高了黑启动过电压预测的准确性，另外还采用改进的鲸鱼算法提高神经网络模型的精度，进一步提高了黑启动过电压预测的准确性。根据本公开的实施例，本公开还提供了一种基于权重分配相关系数的黑启动过电压预测设备、一种可读存储介质和一种计算机程序产品。图4是用来实现本公开实施例的基于权重分配相关系数的黑启动过电压预测方法的基于权重分配相关系数的黑启动过电压预测设备的框图。基于权重分配相关系数的黑启动过电压预测设备旨在表示各种形式的数字计算机，诸如，膝上型计算机、台式计算机、工作台、个人数字助理、服务器、刀片式服务器、大型计算机、和其它适合的计算机。基于权重分配相关系数的黑启动过电压预测设备还可以表示各种形式的移动装置，诸如，个人数字处理、蜂窝电话、智能电话、可穿戴电子设备和其它类似的计算装置。本公开所示的部件、部件的连接和关系、以及部件的功能仅仅作为示例，并且不意在限制本公开中描述的和/或者要求的本公开的实现。如图4所示，基于权重分配相关系数的黑启动过电压预测设备20包括计算单元21，其可以根据存储在只读存储器22中的计算机程序或者从存储单元28加载到随机存取存储器23中的计算机程序，来执行各种适当的动作和处理。在RAM 23中，还可存储基于权重分配相关系数的黑启动过电压预测设备20操作所需的各种程序和数据。计算单元21、ROM 22以及RAM 23通过总线24彼此相连。输入/输出接口25也连接至总线24。基于权重分配相关系数的黑启动过电压预测设备20中的多个部件连接至I/O接口25，包括：输入单元26，例如键盘、鼠标等；输出单元27，例如各种类型的显示器、扬声器等；存储单元28，例如磁盘、光盘等，存储单元28与计算单元21通信连接；以及通信单元29，例如网卡、调制解调器、无线通信收发机等。通信单元29允许基于权重分配相关系数的黑启动过电压预测设备20通过诸如因特网的计算机网络和/或各种电信网络与其他基于权重分配相关系数的黑启动过电压预测设备交换信息/数据。计算单元21可以是各种具有处理和计算能力的通用和/或专用处理组件。计算单元21的一些示例包括但不限于中央处理单元、图形处理单元、各种专用的人工智能计算芯片、各种运行机器学习模型算法的计算单元、数字信号处理器、以及任何适当的处理器、控制器、微控制器等。计算单元21执行上述所描述的各个方法和处理，例如执行基于权重分配相关系数的黑启动过电压预测方法。例如，在一些实施例中，基于权重分配相关系数的黑启动过电压预测方法可被实现为计算机软件程序，其被有形地包含于机器可读介质，例如存储单元28。在一些实施例中，计算机程序的部分或者全部可以经由ROM 22和/或通信单元29而被载入和/或安装到基于权重分配相关系数的黑启动过电压预测设备20上。当计算机程序加载到RAM 23并由计算单元21执行时，可以执行上述描述的基于权重分配相关系数的黑启动过电压预测方法的一个或多个步骤。备选地，在其他实施例中，计算单元21可以通过其他任何适当的方式而被配置为执行基于权重分配相关系数的黑启动过电压预测方法。本公开中以上描述的系统和技术的各种实施方式可以在数字电子电路系统、集成电路系统、场可编程门阵列、专用集成电路、专用标准产品、芯片上系统的系统、负载可编程逻辑电子设备、计算机硬件、固件、软件、和/或它们的组合中实现。这些各种实施方式可以包括：实施在一个或者多个计算机程序中，该一个或者多个计算机程序可在包括至少一个可编程处理器的可编程系统上执行和/或解释，该可编程处理器可以是专用或者通用可编程处理器，可以从存储系统、至少一个输入装置、和至少一个输出装置接收数据和指令，并且将数据和指令传输至该存储系统、该至少一个输入装置、和该至少一个输出装置。用于实施本公开的方法的程序代码可以采用一个或多个编程语言的任何组合来编写。这些程序代码可以提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器或控制器，使得程序代码当由处理器或控制器执行时使流程图和/或框图中所规定的功能/操作被实施。程序代码可以完全在机器上执行、部分地在机器上执行，作为独立软件包部分地在机器上执行且部分地在远程机器上执行或完全在远程机器或服务器上执行。在本公开中，机器可读介质可以是有形的介质，其可以包含或存储以供指令执行系统、装置或基于权重分配相关系数的黑启动过电压预测设备使用或与指令执行系统、装置或基于权重分配相关系数的黑启动过电压预测设备结合地使用的程序。机器可读介质可以是机器可读信号介质或机器可读储存介质。机器可读介质可以包括但不限于电子的、磁性的、光学的、电磁的、红外的、或半导体系统、装置或电子设备，或者上述内容的任何合适组合。机器可读存储介质的更具体示例会包括基于一个或多个线的电气连接、便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、光纤、便捷式紧凑盘只读存储器、光学储电子设备、磁储存电子设备、或上述内容的任何合适组合。为了提供与用户的交互，可以在计算机上实施此处描述的系统和技术，该计算机具有：用于向用户显示信息的显示装置或者LCD监视器）；以及键盘和指向装置，用户可以通过该键盘和该指向装置来将输入提供给计算机。其它种类的装置还可以用于提供与用户的交互；例如，提供给用户的反馈可以是任何形式的传感反馈；并且可以用任何形式来接收来自用户的输入。可以将此处描述的系统和技术实施在包括后台部件的计算系统、或者包括中间件部件的计算系统、或者包括前端部件的计算系统、或者包括这种后台部件、中间件部件、或者前端部件的任何组合的计算系统中。可以通过任何形式或者介质的数字数据通信来将系统的部件相互连接。通信网络的示例包括：局域网、广域网、互联网和区块链网络。计算机系统可以包括客户端和服务器。客户端和服务器一般远离彼此并且通常通过通信网络进行交互。通过在相应的计算机上运行并且彼此具有客户端-服务器关系的计算机程序来产生客户端和服务器的关系。服务器可以是云服务器，又称为云计算服务器或云主机，是云计算服务体系中的一项主机产品，以解决了传统物理主机与VPS服务中，存在的管理难度大，业务扩展性弱的缺陷。服务器也可以为分布式系统的服务器，或者是结合了区块链的服务器。应该理解，可以使用上面所示的各种形式的流程，重新排序、增加或删除步骤。例如，本公开中记载的各步骤可以并行地执行也可以顺序地执行也可以不同的次序执行，只要能够实现本公开公开的技术方案所期望的结果，本公开在此不进行限制。上述具体实施方式，并不构成对本公开保护范围的限制。本领域技术人员应该明白的是，根据设计要求和其他因素，可以进行各种修改、组合、子组合和替代。任何在本公开的精神和原则之内所作的修改、等同替换和改进等，均应包含在本公开保护范围之内。
