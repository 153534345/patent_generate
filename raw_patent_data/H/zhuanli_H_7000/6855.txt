标题title
基于TPM的数据保护方法、电子设备及存储介质
摘要abst
本申请涉及基于TPM的数据保护方法、电子设备及存储介质。第一设备的应用向TPM发送加密请求，其中加密请求包括第一鉴权口令及待加密数据。TPM响应加密请求，获取第一鉴权口令及待加密数据，并判断第一鉴权口令是否正确。TPM在确定第一鉴权口令正确时根据第一设备的核心资料、应用发送的第二鉴权口令对待加密数据进行加密生成密文，将密文进行存储或发送给第一设备的应用。本方案中第一设备访问TPM对待加密数据进行加密时，第一设备的应用需向TPM提供第一鉴权口令，TPM在第一鉴权口令正确时利用核心资料对待加密数据进行加密，如此使得第一设备对数据的加密不依赖于操作系统，使得第一设备可以抵御操作系统无法防御的高级攻击，提高了数据的安全性。
权利要求书clms
1.一种基于TPM的数据保护方法，其特征在于，所述方法包括：第一设备的应用向TPM发送加密请求，所述加密请求包括第一鉴权口令及待加密数据；所述TPM响应所述加密请求，获取所述第一鉴权口令及所述待加密数据，并判断所述第一鉴权口令是否正确；所述第一设备的应用设定第二鉴权口令，并将所述第二鉴权口令发送给所述TPM；所述TPM在确定所述第一鉴权口令正确时根据所述第一设备的核心资料、所述第二鉴权口令对所述待加密数据进行加密生成密文，将所述密文进行存储或发送给所述第一设备的应用。2.如权利要求1所述的基于TPM的数据保护方法，其特征在于，所述TPM将所述密文发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用向所述TPM发送解密请求，所述解密请求包括所述第一鉴权口令及所述密文；所述TPM响应所述解密请求，获取所述第一鉴权口令及所述密文，并判断所述第一鉴权口令是否正确；所述TPM在确定所述第一鉴权口令正确时，根据所述核心资料对所述密文进行解密得到所述待加密数据，并将所述待加密数据发送给所述第一设备的应用。3.如权利要求2所述的基于TPM的数据保护方法，其特征在于，所述待加密数据为加密密钥，所述第一设备的应用向TPM发送加密请求包括：所述第一设备的应用响应加密操作向所述TPM发送加密请求，并根据所述加密密钥将数据明文进行加密生成数据密文。4.如权利要求3所述的基于TPM的数据保护方法，其特征在于，所述TPM将所述待加密数据发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用根据所述加密密钥对所述数据密文进行解密得到数据明文。5.如权利要求3所述的基于TPM的数据保护方法，其特征在于，所述TPM将所述待加密数据发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用销毁所述加密密钥。6.如权利要求1所述的基于TPM的数据保护方法，其特征在于，所述TPM将所述密文进行存储之后，所述方法还包括：所述第一设备的应用向所述TPM发送解密请求，所述解密请求包括第一鉴权口令；所述TPM响应所述解密请求，获取所述第一鉴权口令，并判断所述第一鉴权口令是否正确；所述TPM在确定所述第一鉴权口令正确时，根据所述核心资料对所述密文进行解密后发送给所述第一设备的应用。7.如权利要求6所述的基于TPM的数据保护方法，其特征在于，所述待加密数据为人脸数据，所述TPM根据所述核心资料对所述密文进行解密后发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用根据解密后的所述密文对采集的人脸数据进行验证。8.如权利要求7所述的基于TPM的数据保护方法，其特征在于，所述第一设备的应用向TPM发送加密请求之前，所述方法包括：所述第一设备的应用响应人脸识别操作，与第二设备进行协同连接；所述第一设备的应用接收所述第二设备同步发送的人脸数据。9.如权利要求1所述的基于TPM的数据保护方法，其特征在于，所述TPM判断所述第一鉴权口令是否正确包括：确定所述第一设备的验证密码是否与预设密码一致；确定所述第一设备的身份标识是否与预设身份标识一致；确定所述第一设备的当前运行环境代码的哈希值是否与预设哈希值一致；若所述第一设备的验证密码与所述预设密码一致，所述第一设备的身份标识与所述预设身份标识一致及所述第一设备的当前运行环境代码的哈希值与所述预设哈希值一致确定所述第一鉴权口令正确；及若所述第一设备的验证密码与所述预设密码不一致，获取所述第一设备的身份标识与所述预设身份标识不一致，或者所述第一设备的当前运行环境代码的哈希值与所述预设哈希值不一致，确定所述第一鉴权口令错误。10.如权利要求1所述的基于TPM的数据保护方法，其特征在于，所述TPM判断所述第一鉴权口令是否正确之后，所述方法还包括：所述TPM在确定所述第一鉴权口令错误时，向所述第一设备的应用发送鉴权错误提醒。11.如权利要求1所述的基于TPM的数据保护方法，其特征在于，所述第一设备的应用向TPM发送加密请求或解密请求包括：所述第一设备的应用优先向支持高速密码运算的TPM发送所述加密请求或所述解密请求。12.如权利要求1所述的基于TPM的数据保护方法，其特征在于，所述方法还包括：所述第一设备的应用通过TSS协议栈、tpm2-tss协议栈、ibmtss协议栈、go-tpm协议栈、wolfTPM协议栈或TSS.MSR协议栈中的至少一种协议栈与所述TPM进行交互。13.如权利要求1所述的基于TPM的数据保护方法，其特征在于，所述核心资料包括硬件唯一密钥。14.一种基于TPM的数据保护方法，其特征在于，所述方法包括：第一设备的应用向公钥服务器发送第一登录请求，其中所述第一登录请求包括预设账号；所述第一设备的应用接收所述公钥服务器对所述预设账号验证通过后发送的公钥列表，所述公钥列表包括所述预设账号下的所有设备的公钥；所述第一设备的应用从所述第一设备的TPM中获所述第一设备的私钥，从所述公钥列表中获取第二设备的公钥，并基于所述第一设备的私钥及所述第二设备的公钥对所述第一设备的身份与所述第二设备的身份进行认证；在所述第一设备的身份与所述第二设备的身份认证通过后，所述第一设备的应用根据所述第一设备的私钥及所述第二设备的公钥进行密钥协商得到会话密钥；所述第一设备的应用根据所述会话密钥对发送给所述第二设备的数据进行加密，及根据所述会话密钥对所述第二设备发送的数据进行解密。15.如权利要求14所述的基于TPM的数据保护方法，其特征在于，所述第一设备的应用从所述第一设备的TPM中获所述第一设备的私钥包括：所述第一设备的应用向所述TPM发送获取私钥请求，其中，所述获取私钥请求包括第一鉴权口令；所述TPM响应所述获取私钥请求，判断所述第一鉴权口令是否正确；若所述第一鉴权口令正确，所述TPM从存储的设备证书中提取出所述第一设备的私钥，并将所述第一设备的私钥发送给所述第一设备的应用。16.如权利要求14所述的基于TPM的数据保护方法，其特征在于，所述第一设备的应用根据所述第一设备的私钥及所述第二设备的公钥进行密钥协商得到会话密钥包括：所述第一设备的应用根据所述第一设备的私钥及所述第二设备的公钥通过Diffie-Hellman算法或椭圆曲线迪菲-赫尔曼秘钥交换算法行密钥协商得到所述会话密钥。17.一种基于TPM的数据保护方法，其特征在于，所述方法包括：第一设备的第一应用响应下载第二应用的操作，获取所述第二应用的数据签名；所述第一设备的第一应用向TPM发送获取公钥请求，所述获取公钥请求包括第一鉴权口令；所述TPM响应所述获取公钥请求，判断所述第一鉴权口令是否正确；如确定若第一鉴权口令正确，所述TPM从设备证书中提取出所述第一设备的公钥，并将所述第一设备的公钥发送给所述第一设备的第一应用；所述第一设备的第一应用根据所述第一设备的公钥对所述第二应用的数据签名进行验证，并在验证成功后允许下载所述第二应用。18.如权利要求17所述的基于TPM的数据保护方法，其特征在于，所述获取所述应用的数据签名包括：从所述应用的应用程序包中获取应用的数据签名。19.如权利要求17所述的基于TPM的数据保护方法，其特征在于，所述第一设备的公钥为所述第一设备的生产厂商的公钥。20.一种电子设备，其特征在于，包括处理器、存储器；其中所述处理器与所述存储器相耦合；所述存储器，用于存储程序指令；所述处理器，用于读取所述存储器中存储的所述程序指令，以实现如权利要求1至19中任一项所述的基于TPM的数据保护方法。21.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有程序指令，当所述程序指令在电子设备上运行时，使得电子设备执行如权利要求1至19中任一项所述的基于TPM的数据保护方法。
说明书desc
技术领域本申请涉及数据安全技术领域，具体而言，涉及一种基于TPM的数据保护方法、电子设备及存储介质。背景技术PC作为重要的生产力工具之一，往往保存着许多重要的数据资料。在考虑PC上的数据安全保护方案时，不仅仅需要考虑远程攻击的威胁，而且因为PC存在便携式携带的形态，还需考虑攻击者直接接触设备进行攻击的可能性。目前市场上也有数据资料的保护产品，例如加密文件夹等应用。然而，这些应用的加解密能力依赖操作系统且应用的关键资产保存在受操作系统控制的文件系统中。一旦攻击者获得管理员权限，这些应用的关键资产可以被攻击者获取，从而使得用户的数据资料被解密而造成信息泄露。发明内容鉴于以上内容，有必要提供一种基于TPM的数据保护方法、电子设备及存储介质以提高数据保护的安全性。第一方面，本申请实施例提供一种基于TPM的数据保护方法，所述方法包括：第一设备的应用向TPM发送加密请求，所述加密请求包括第一鉴权口令及待加密数据；所述TPM响应所述加密请求，获取所述第一鉴权口令及所述待加密数据，并判断所述第一鉴权口令是否正确；所述第一设备的应用设定第二鉴权口令，并将所述第二鉴权口令发送给所述TPM；所述TPM在确定所述第一鉴权口令正确时根据所述第一设备的核心资料、第二鉴权口令对待加密数据进行加密生成密文，将密文进行存储或发送给所述第一设备的应用。上述技术方案中第一设备的应用访问TPM对待加密数据进行加密时，第一设备的应用需向TPM提供第一鉴权口令，TPM在第一鉴权口令正确时利用核心资料对待加密数据进行加密，如此使得第一设备对数据的加密不依赖于操作系统，使得第一设备可以抵御操作系统无法防御的高级攻击，提高了数据的安全性。在本申请的一实施例中，所述TPM将密文发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用向所述TPM发送解密请求，所述解密请求包括所述第一鉴权口令及所述密文；所述TPM响应所述解密请求，获取所述第一鉴权口令及密文，并判断所述第一鉴权口令是否正确；所述TPM在确定所述第一鉴权口令正确时，根据所述核心资料对所述密文进行解密得到所述待加密数据，并将所述待加密数据发送给所述第一设备的应用。上述技术方案中，在第一设备的应用访问TPM对密文进行解密时，第一设备的应用向TPM提供第一鉴权口令及密文，TPM在第一鉴权口令正确时利用核心资料对加密密钥密文进行解密后发送给第一设备的应用，如此使得第一设备对密文的解密不依赖于操作系统，使得第一设备可以抵御操作系统无法防御的高级攻击。在本申请的一实施例中，所述待加密数据为加密密钥，所述第一设备的应用向TPM发送加密请求包括：所述第一设备的应用响应加密操作向所述TPM发送加密请求，并根据所述加密密钥将数据明文进行加密生成数据密文。在本申请的一实施例中，所述TPM根据所述核心资料对所述密文进行解密后发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用根据所述加密密钥对所述数据密文进行解密得到数据明文。上述技术方案中，第一设备的应用根据TPM发送的加密密钥对数据密文进行解密得到数据明文，保障了数据密文的安全性。在本申请的一实施例中，所述TPM将密文发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用销毁所述加密密钥。上述技术方案中，将加密密钥销毁可以避免加密密钥在第一设备被攻击时被攻击者获取。在本申请的一实施例中，所述TPM将密文进行存储之后，所述方法还包括：所述第一设备的应用向所述TPM发送解密请求，所述解密请求包括第一鉴权口令；所述TPM响应所述解密请求，获取所述第一鉴权口令，并判断所述第一鉴权口令是否正确；所述TPM在确定所述第一鉴权口令正确时，根据所述核心资料对所述密文进行解密后发送给所述第一设备的应用。上述技术方案中，在第一设备的应用访问TPM对密文进行解密时，第一设备的应用向TPM提供第一鉴权口令，TPM在第一鉴权口令正确时利用核心资料对TPM中的加密密钥密文进行解密后发送给第一设备的应用，如此使得第一设备对密文的解密不依赖于操作系统，使得第一设备可以抵御操作系统无法防御的高级攻击。在本申请的一实施例中，所述待加密数据为人脸数据，所述TPM根据所述核心资料对所述密文进行解密后发送给所述第一设备的应用之后，所述方法还包括：所述第一设备的应用根据解密后的所述密文对采集的人脸数据进行验证。上述技术方案中，第一设备的应用根据TPM发送的人脸数据对采集的人脸数据进行验证，保障了人脸识别功能的安全性。在本申请的一实施例中，所述第一设备的应用向TPM发送加密请求之前，所述方法还包括：所述第一设备的应用响应人脸识别操作，与第二设备进行协同连接；所述第一设备的应用接收所述第二设备同步发送的人脸数据。上述技术方案中，第二设备中的人脸数据能够同步到第一设备中进行人脸识别。在本申请的一实施例中，所述判断所述第一鉴权口令是否正确包括：确定所述第一设备的验证密码是否与预设密码一致；确定所述第一设备的身份标识是否与预设身份标识一致；确定所述第一设备的当前运行环境代码的哈希值是否与预设哈希值一致；若所述第一设备的验证密码与所述预设密码一致，所述第一设备的身份标识与所述预设身份标识一致及所述第一设备的当前运行环境代码的哈希值与所述预设哈希值一致确定所述第一鉴权口令正确；及若所述第一设备的验证密码与所述预设密码不一致，或者所述第一设备的身份标识与所述预设身份标识不一致，或者所述第一设备的当前运行环境代码的哈希值与所述预设哈希值不一致，确定所述第一鉴权口令错误。在本申请的一实施例中，所述判断所述第一鉴权口令是否正确之后，所述方法还包括：所述TPM在确定所述第一鉴权口令错误时，向所述第一设备的应用发送鉴权错误提醒。上述技术方案中，TPM在确定所述第一鉴权口令错误时，能够向第一设备发送鉴权错误提醒。在本申请的一实施例中，所述第一设备的应用向TPM发送加密请求或解密请求包括：所述第一设备的应用优先向支持高速密码运算的TPM发送所述加密请求或所述解密请求。上述技术方案，第一设备的应用优先向支持高速密码运算的TPM发送加密请求或解密请求，使得支持高速密码运算的TPM根据核心资料对待加密数据进行加密或根据核心资料对密文进行解密，提高第一设备的加密或解密运算的效率。在本申请的一实施例中，所述方法还包括：所述第一设备的应用通过TSS协议栈、tpm2-tss协议栈、ibmtss协议栈、go-tpm协议栈、wolfTPM协议栈或TSS.MSR协议栈中的至少一种协议栈与所述TPM进行交互。上述技术方案，通过TSS协议栈、tpm2-tss协议栈、ibmtss协议栈、go-tpm协议栈、wolfTPM协议栈或TSS.MSR协议栈中的至少一种协议栈实现第一设备的应用与TPM之间的交互。在本申请的一实施例中，所述核心资料包括硬件唯一密钥。第二方面，本申请实施例提供一种基于TPM的数据保护方法，所述方法包括：第一设备的应用向公钥服务器发送第一登录请求，其中所述第一登录请求包括预设账号；所述第一设备接收所述公钥服务器对所述预设账号验证通过后发送的公钥列表，所述公钥列表包括所述预设账号下的所有设备的公钥；所述第一设备的应用从所述第一设备的TPM中获所述第一设备的私钥，从所述公钥列表中获取第二设备的公钥，并基于所述第一设备的私钥及所述第二设备的公钥对所述第一设备的身份与所述第二设备的身份进行认证；在所述第一设备的身份与所述第二设备的身份认证通过后，所述第一设备的应用根据所述第一设备的私钥及所述第二设备的公钥进行密钥协商得到会话密钥；所述第一设备的应用根据所述会话密钥对发送给所述第二设备的数据进行加密，及根据所述会话密钥对所述第二设备发送的数据进行解密。上述技术方案中，第一设备的应用将第一设备的私钥在TPM中进行安全存储，防止第一设备的私钥被泄露后出现非认证的设备也可以加入第一设备与第二设备构成的信任环的情况，相比于在操作系统中进行第一设备与第二设备建立信任环的操作，本申请中第一设备的私钥泄露的风险被降低。在本申请的一实施例中，所述第一设备的应用从所述第一设备的TPM中获所述第一设备的私钥包括：所述第一设备的应用向所述TPM发送获取私钥请求，其中，所述获取私钥请求包括第一鉴权口令；所述TPM响应所述获取私钥请求，判断所述第一鉴权口令是否正确；若所述第一鉴权口令正确，所述TPM从存储的设备证书中提取出所述第一设备的私钥，并将所述第一设备的私钥发送给所述第一设备的应用。在本申请的一实施例中，所述第一设备的应用根据所述第一设备的私钥及所述第二设备的公钥进行密钥协商得到会话密钥包括：所述第一设备的应用根据所述第一设备的私钥及所述第二设备的公钥通过Diffie-Hellman算法或椭圆曲线迪菲-赫尔曼秘钥交换算法行密钥协商得到所述会话密钥。第三方面，本申请实施例提供一种基于TPM的数据保护方法，所述方法包括：第一设备的第一应用响应下载第二应用的操作，获取所述应用的数据签名；所述第一设备的第一应用向TPM发送获取公钥请求，所述获取公钥请求包括第一鉴权口令；所述TPM响应所述获取公钥请求，判断所述第一鉴权口令是否正确；如确定若第一鉴权口令正确，所述TPM从设备证书中提取出所述第一设备的公钥，并将所述第一设备的公钥发送给所述第一设备的第一应用；所述第一设备的第一应用根据所述第一设备的公钥对所述第二应用的数据签名进行验证，并在验证成功后允许下载所述第二应用。上述技术方案，第一设备从TPM中获取第一设备的公钥对第二应用的数据签名进行验证，从而实现利用TPM对第一设备的公钥进行数据保护，在实现对第二应用进行验证的同时能够抵御操作系统无法防御的高级攻击，提升了公钥数据的安全性。在本申请的一实施例中，所述获取所述应用的数据签名包括：从所述应用的应用程序包中获取应用的数据签名。第四方面，本申请实施例提供一种电子设备，包括处理器、存储器；其中所述处理器与所述存储器相耦合；所述存储器，用于存储程序指令；所述处理器，用于读取所述存储器中存储的所述程序指令，以实现上述基于TPM的数据保护方法。第五方面，本申请实施例提供一种计算机可读存储介质，计算机可读存储介质存储有程序指令，当程序指令被处理器执行时，执行上述基于TPM的数据保护方法。另外，第四方面至第五方面所带来的技术效果可参见上述方法部分各设计的方法相关的描述，此处不再赘述。附图说明为了更清楚地说明本申请实施例的技术方案，下面将对实施例中的附图作简单地介绍，应当理解，以下附图仅示出了本申请的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。图1为本申请一实施例中第一设备的软件结构框图。图2为本申请一实施例中基于TPM的数据保护系统的示意图。图3为本申请一实施例中基于TPM的数据保护方法的流程示意图。图4为本申请一实施例中对数据进行加密及解密的示意图。图5为本申请一实施例中TPM进行关键信息预置方法的流程示意图。图6为本申请一实施例中基于TPM的数据保护系统的示意图。图7为本申请另一实施例中基于TPM的数据保护方法的流程示意图。图8为本申请另一实施例中基于TPM的数据保护方法的流程示意图。图9为本申请一实施例中第一设备进行人脸数据存储的示意图。图10为本申请另一实施例中基于TPM的数据保护方法的流程示意图。图11为本申请另一实施例中基于TPM的数据保护方法的流程示意图。图12为本申请一实施例中对应用进行验证的示意图。图13为本申请一实施例中电子设备的示意图。具体实施方式以下，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本申请实施例的描述中，“示例性的”或者“例如”等词用于表示作例子、例证或说明。本申请实施例中被描述为“示例性的”或者“例如”的任何实施例或设计方案不应被解释为比其它实施例或设计方案更优选或更具优势。确切而言，使用“示例性的”或者“例如”等词旨在以具体方式呈现相关概念。除非另有定义，本文所使用的所有的技术和科学术语与属于本申请中的技术领域的技术人员通常理解的含义相同。本申请的说明书中所使用的术语只是为了描述具体的实施例的目的，不是旨在于限制本申请。应理解，本申请中除非另有说明，“/”表示或的意思。例如，A/B可以表示A或B。本申请中的“和/或”仅仅是一种描述关联对象的关联关系，表示可以存在三种关系。例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B三种情况。“至少一个”是指一个或者多个。“多个”是指两个或多于两个。例如，a、b或c中的至少一个，可以表示：a，b，c，a和b，a和c，b和c，a、b和c七种情况。为便于下文描述各个实施例，对本申请实施例中涉及的用户界面先进行简单描述。UI是应用程序或操作系统与用户之间进行交互和信息交换的介质接口，可实现信息的内部形式与用户可以接受形式之间的转换。应用程序的用户界面是通过JAVA、可扩展标记语言等特定计算机语言编写的源代码，界面源代码在电子设备上经过解析、渲染，最终呈现为用户可以识别的内容，比如图片、文字、按钮等控件。控件，是用户界面的基本元素，典型的控件有按钮、小工具、工具栏、菜单栏、文本框、滚动条、图片和文本。界面中的控件的属性和内容是通过标签或者节点来定义的，比如XML通过＜Textview＞、＜ImgView＞、＜VideoView＞等节点来规定界面所包含的控件。一个节点对应界面中一个控件或属性，节点经过解析和渲染之后呈现为用户可视的内容。此外，很多应用程序，比如混合应用的界面中通常还包含有网页。网页，也称为页面，可以理解为内嵌在应用程序界面中的一个特殊的控件，网页是通过特定计算机语言编写的源代码，例如超文本标记语言，层叠样式表，JAVA脚本等，网页源代码可以由浏览器或与浏览器功能类似的网页显示组件加载和显示为用户可识别的内容。网页所包含的具体内容也是通过网页源代码中的标签或者节点来定义的，比如HTML通过＜p＞、＜img＞、＜video＞、＜canvas＞来定义网页的元素和属性。用户界面常用的表现形式是图形用户界面，是指采用图形方式显示的与计算机操作相关的用户界面。它可以是在电子设备的显示屏中显示的一个图标、窗口、控件等界面元素。目前市场上用于电子设备的数据资料保护的关键资产保存在受操作系统控制的文件系统中。一旦攻击者获得电子设备的管理员权限，这些关键资产可以被攻击者获取从而造成用户的数据资料的泄露。本申请提供一种基于TPM的数据保护方法，能够解决上述技术问题，提高电子设备的数据资料的安全性。以图1为例，所述基于TPM的数据保护方法可应用在第一设备10中。具体地，参考图1所示，为本申请一实施例中第一设备10的软件结构框图。基于分层架构，软件可分成若干个层，每一层都有清晰的角色和分工。层与层之间通过软件接口通信。在一些实施例中，以操作系统为WINDOWSTM系统为例进行说明，将第一设备10的WINDOWSTM系统分为四层，从上至下分别为应用层，系统服务层，内核及驱动层和硬件层。应用层可以包括一系列应用。如图1所示，应用可以包括电脑管家。系统服务层包括一系列系统服务。系统服务是一种应用程序类型，它在后台运行，并为应用层的应用提供系统服务能力。如MagicLinkSDK服务、信任环服务、人脸识别服务、密钥管理服务。所述密钥管理服务为信任环、人脸识别、MagicLinkSDK服务提供加密、解密或数据存储功能。需要说明的是，密钥管理服务也是一种应用程序，本申请中的基于TPM的数据保护方法可以应用在应用层的应用或系统服务层的密钥管理服务中。内核及驱动层用于为系统服务提供访问硬件的接口及调用硬件的功能。内核及驱动层包括可信计算组织协议栈和基本输入输出系统。硬件层可包括可信平台模块和基本输入输出系统。在本申请的一实施例中，电脑管家或密钥管理服务通过TSS协议栈与TPM进行交互。在本申请的另一实施例中，电脑管家或密钥管理服务通过tpm2-tss协议栈、ibmtss协议栈、go-tpm协议栈、wolfTPM协议栈或TSS.MSR协议栈与TPM进行交互。需要说明的是，本申请中的TSS协议栈、tpm2-tss协议栈、ibmtss协议栈、go-tpm协议栈、wolfTPM协议栈及TSS.MSR协议栈为TPM协议栈，所述TPM协议栈用于供系统服务层与硬件层的TPM进行交互。在本申请的一实施例中，电脑管家或密钥管理服务通过BIOS实现数据的安全备份，例如通过BIOS对TPM的初始设置数据进行备份。在本申请的另一实施例中，电脑管家或密钥管理服务通过Windows管理工具、扩展WMI实现数据的安全备份。参考图2所示，为本申请一实施例中基于TPM的数据保护系统200的示意图。所述基于TPM的数据保护系统200包括第一设备10。所述第一设备10包括至少一可信平台模块TPM。所述TPM包括基于独立芯片实现的可信平台模块或固件可信平台模块。所述TPM能够提供一个安全的密钥管理环境，该环境中的密钥资产、运算可以抵御篡改攻击。本实施例中，所述第一设备10可以是平板电脑、笔记本电脑、个人电脑等装置。参考图3所示，为本申请一实施例中基于TPM的数据保护方法的流程示意图。所述方法应用在上述数据保护系统200中，加密密钥用于对数据进行加密，所述方法利用第一设备10的TPM中的核心资料对加密密钥进行加密并生成加密密钥密文，及对加密密钥密文进行解密得到加密密钥，实现对数据的加密及解密。所述方法具体包括如下步骤。步骤S300，第一设备10的应用响应加密操作根据加密密钥将待加密的数据明文进行加密生成数据密文。步骤S301，第一设备10的应用向TPM发送加密请求，所述加密请求中包括第一鉴权口令及加密密钥。在本申请的一实施例中，加密密钥包括KDK密钥。KDK密钥存储在第一设备10的磁盘中。加密密钥用于对数据明文进行加密或对数据密文进行解密。参考图4所示，为本申请一实施例中对数据进行加密及解密的示意图，其中图4中的为对数据明文进行加密的示意图。在本申请的一实施例中，第一设备10的电脑管家应用响应用户输入的对数据明文的加密操作，根据第一鉴权口令及加密密钥生成加密请求，将生成的加密请求发送给TPM，并根据加密密钥将待加密的数据明文进行加密生成数据密文。在本申请的一实施例中，第一鉴权口令包括第一设备10的验证密码、设备的身份标识及当前运行环境代码的哈希值。所述第一鉴权口令用于对访问TPM的设备的身份进行验证以鉴别设备是否具有获取核心资料的权限。所述当前运行环境代码可以为密钥管理服务所对应的代码。步骤S302，TPM响应所述加密请求，从所述加密请求中获取第一鉴权口令及加密密钥。步骤S303，TPM判断所述第一鉴权口令是否正确。若所述第一鉴权口令正确，执行步骤S305。若所述第一鉴权口令错误，执行步骤S313。在本申请的一实施例中，TPM判断所述第一鉴权口令是否正确，至少包括如下一种或多种的判断：确定第一设备10的验证密码是否与预设密码一致；确定第一设备10的身份标识是否与预设身份标识一致；确定第一设备10的当前运行环境代码的哈希值是否与预设哈希值一致。若第一设备10的验证密码与预设密码一致，第一设备10的身份标识与预设身份标识一致及第一设备10的当前运行环境代码的哈希值与预设哈希值一致，确定所述第一鉴权口令正确。若上述多种判断中有任一种判断结果为否，例如，第一设备10的验证密码与预设密码不一致，或者第一设备10的身份标识与预设身份标识不一致，或者第一设备10的当前运行环境代码的哈希值与预设哈希值之间不一致，确定所述第一鉴权口令错误。步骤S304，应用设定第二鉴权口令，并将第二鉴权口令发送给TPM。在本申请的一实施例中，第二鉴权口令包括第一设备10的验证密码、设备的身份标识及/或当前运行环境代码的哈希值。步骤S304执行完后，执行步骤S305。步骤S305，TPM获取核心资料及第二鉴权口令，并根据核心资料、第二鉴权口令对加密密钥进行加密生成加密密钥密文。需要说明的是，所述第二鉴权口令用于对访问TPM的设备的身份进行验证以鉴别设备是否具有访问核心资料的权限。步骤S306，TPM将加密密钥密文发送给第一设备10的应用。在本申请的一实施例中，TPM中的核心资料包括硬件唯一密钥或设备群体密钥。例如，TPM获取存储在TPM中的硬件唯一密钥及接收应用发送的第二鉴权口令，根据获取的硬件唯一密钥、第二鉴权口令对加密密钥进行加密，生成加密密钥密文，并将所述加密密钥密文发送给第一设备10的应用。需要说明的是，在本申请的一实施例中，响应用户的加密操作，第一设备10可优先向支持高速密码运算的TPM发送加密请求。支持高速密码运算的TPM响应所述加密请求，对所述加密请求中的第一鉴权口令进行验证，及在第一鉴权口令验证正确后，根据核心资料、第二鉴权口令对加密密钥进行加密生成加密密钥密文。如此，通过使用支持高速密码运算的TPM的运算能力，提高第一设备10对数据明文进行加密运算的效率。步骤S307，第一设备10的应用存储所述加密密钥密文并销毁加密密钥。需要说明的是，第一设备10中存储加密密钥密文，加密密钥已销毁。若第一设备10需要对数据密文进行解密，则需访问TPM获取加密密钥，并根据加密密钥对已加密的数据密文进行解密。步骤S308，第一设备10的应用响应对数据密文的解密操作，向TPM发送解密请求，所述解密请求中包括第一鉴权口令及加密密钥密文。参考图4中的，为对数据密文进行解密的示意图。在本申请的一实施例中，第一设备10的电脑管家应用响应用户输入的数据明文的解密操作。第一设备10响应对数据密文的解密操作，根据第三鉴权口令及加密密钥密文生成解密请求，并向TPM发送解密请求。步骤S309，TPM响应所述解密请求，从所述加密请求中获取第一鉴权口令及加密密钥密文，并判断所述第一鉴权口令是否正确。需要说明的是，判断第一鉴权口令是否正确可参照上述步骤S303对第一鉴权口令进行验证的具体内容，这里不再重复描述。若所述第一鉴权口令正确，执行步骤S310，若所述第一鉴权口令错误，执行步骤S313。步骤S310，TPM获取核心资料，并根据核心资料对加密密钥密文进行解密得到加密密钥。步骤S311，TPM将加密密钥发送给第一设备10的应用。步骤S312，第一设备10的应用根据加密密钥对数据密文进行解密得到数据明文。步骤313，TPM向第一设备10的应用发送第一鉴权口令的错误信息。需要说明的是，在本申请的一实施例中，响应用户的解密操作，第一设备10优先向支持高速密码运算的TPM发送解密请求。支持高速密码运算的TPM响应所述解密请求，对所述解密请求中的第一鉴权口令进行验证，及在第一鉴权口令验证正确后，根据核心资料对加密密钥密文进行解密得到加密密钥。如此，提高第一设备10对数据密文进行解密运算的效率。本申请的实施例中，在第一设备10访问TPM对数据密文进行解密时，第一设备10需向TPM提供第一鉴权口令及加密密钥密文，TPM在第一鉴权口令正确时利用核心资料对加密密钥密文进行解密，生成加密密钥并发送给第一设备10进行数据密文的解密，如此使得对数据密文的解密不依赖于操作系统，使得第一设备10可以抵御操作系统无法防御的高级攻击，提高了数据的安全性。需要说明的是，本申请的实施例中，第一设备10的核心资料在第一设备10的生产过程中预先写入到TPM中进行保存，如此实现基于TPM保护重要的最小核心资料。第一设备10访问TPM的第一鉴权口令在第一设备10的生产过程中也可进行预先设置。参考图5所示，为本申请一实施例中TPM进行关键信息预置方法的流程示意图。所述方法包括如下步骤。步骤S501，通过安全数据通道将第一设备10的核心资料传输到生产测试系统中。所述生产测试系统与第一设备10通信连接。所述生产测试系统用于对第一设备10进行生产及完成对相关数据交互的测试。步骤S502，通过生产测试系统将第一设备10的核心资料写入到TPM中进行存储。在本申请的一实施例中，通过生产测试系统将第一设备10的核心资料写入到TPM中进行存储包括：确定第一设备10是否包括多种类型的TPM；从多种类型的TPM中选择安全级别最高的TPM；将第一设备10的核心资料写入到具有最高安全级别的TPM中进行存储。需要说明的是，将第一设备10的核心资料写入到具有最高安全级别的TPM中进行存储，可以提高核心资料的安全保证能力。步骤S503，通过生产测试系统设置访问TPM的第一鉴权口令。在本申请的一实施例中，所述方法在步骤S503之后还包括：设置访问TPM时，不可对TPM进行写操作及设置访问TPM的有效期限。例如，可设置访问TPM的有效期限为3年。本申请的实施例中，在通过生产测试系统写入核心资料到TPM的同时，也会对TPM的第一鉴权口令进行初始化设置，第一鉴权口令确保了只有经过授权的应用才可以使用写入到TPM中的核心资料，并利用核心资料进行加密或解密。参考图6所示，为本申请一实施例中基于TPM的数据保护系统200的示意图。所述基于TPM的数据保护系统300包括第一设备10、第二设备20及公钥服务器30。所述第一设备10包括可信平台模块。所述第一设备10与所述第二设备20分别与公钥服务器30建立通信连接。在一实施例中，第二设备20及第一设备10通过4G LET协议或5G SA协议与公钥服务器30通信连接。本实施例中，所述第一设备10可以是平板电脑、笔记本电脑、个人电脑等装置。所述第二设备20可以是手机、平板电脑、笔记本电脑、个人电脑、显示器等装置。所述公钥服务器30可以是云服务器。参考图7所示，为本申请另一实施例中基于TPM的数据保护方法的流程示意图。所述方法应用在如图6所示的数据保护系统300中，所述方法从第一设备10的TPM中获取第一设备10的私钥，从公钥服务器30下发的公钥列表中获取第二设备20的公钥，并基于第一设备10的私钥及第二设备20的公钥进行密钥协商得到会话密钥，第二设备20根据第二设备20的私钥及公钥服务器30下发的公钥列表中获取第一设备10的公钥协商得到会话密钥，如此第一设备10与第二设备20根据协商密钥进行数据通信，从而在第一设备10与第二设备20之间构成信任环的通信通道。所述方法具体包括如下步骤。步骤S701，第一设备10的应用响应调用信任环服务的操作，向公钥服务器30发送第一登录请求，其中第一登录请求包括预设账号。在本申请的一实施例中，第一设备10的电脑管家应用响应用户输入的调用信任环服务的操作，调用信任环服务。第一设备10通过预设账号向公钥服务器30发送第一登录请求，其中所述第一登录请求中包括所述预设账号。步骤S702，公钥服务器30响应第一登录请求，判断第一设备10是否通过账号认证。若第一设备10通过账号认证，执行步骤S703，否则，若第一设备10没有通过账号认证，则向第一设备10发送认证未通过的提醒。本实施例中，判断第一设备10是否通过账号认证包括：若确定第一设备10的预设账号记录在公钥服务器30中，确定第一设备10通过账号验证。步骤S703，第一设备10接收公钥服务器30发送的公钥列表，所述公钥列表中包括所述预设账号下所有设备的公钥。例如，手机与PC通过预设账号登录到公钥服务器30，则所述预设账号下的设备包括手机与PC，公钥服务器30发送给手机或PC的公钥列表中包括手机的公钥与PC的公钥。步骤S704，第二设备20向公钥服务器30发送第二登录请求，其中第二登录请求包括所述预设账号。步骤S705，公钥服务器30响应第二登录请求，判断第二设备20是否通过账号认证。若第二设备20通过账号认证，执行步骤S706，否则，若第二设备20没有通过账号认证，则向第二设备20发送认证未通过的提醒。本实施例中，判断第二设备20是否通过账号认证包括：若确定第二设备10的预设账号记录在公钥服务器30中确定第二设备20通过账号验证。步骤S706，第二设备20接收公钥服务器30发送的公钥列表，所述公钥列表中包括所述预设账号下所有设备的公钥。步骤S707，第一设备10的应用从TPM中获第一设备10的私钥，从公钥列表中获取第二设备20的公钥，并基于第一设备10的私钥及第二设备20的公钥对所述第一设备10的身份与第二设备20的身份进行认证。在本申请的一实施例中，第一设备10的应用从TPM中获第一设备10的私钥包括：第一设备10的应用向TPM发送获取私钥请求，其中，所述获取私钥请求包括第一鉴权口令；所述TPM响应所述获取私钥请求，判断所述第一鉴权口令是否正确；若所述第一鉴权口令正确，所述TPM从存储的设备证书中提取出第一设备10的私钥，并将第一设备10的私钥发送给所述第一设备10。步骤S708，在第一设备10的身份与第二设备20的身份认证通过后，第一设备10的应用根据第一设备10的私钥及第二设备20的公钥进行密钥协商得到会话密钥，第一设备10根据会话密钥对发送给第二设备20的数据进行加密，及根据会话密钥对第二设备20发送的数据进行解密。具体地，第一设备10根据第一设备10的私钥及第二设备20的公钥进行密钥协商得到会话密钥包括：第一设备10根据第一设备10的私钥及第二设备20的公钥通过Diffie-Hellman算法或椭圆曲线迪菲-赫尔曼秘钥交换算法进行密钥协商得到会话密钥。步骤S709，第二设备20获取第二设备20的私钥，从公钥列表中获取第一设备10的公钥，并基于第二设备20的私钥及第一设备10的公钥对第二设备20的身份与第一设备10的身份进行认证。在本申请的一实施例中，第二设备20获取第二设备20的私钥包括：第二设备20从可信任执行环境或TPM中获取第二设备20的私钥。例如，若第二设备20为手机，则第二设备20从TEE中获取第二设备20的私钥。若第二设备20为PC，则第二设备20从TPM中获取第二设备20的私钥。步骤S710，在第一设备10的身份与第二设备20的身份之间的认证通过后，第二设备20根据第二设备20的私钥及第一设备10的公钥进行密钥协商得到会话密钥，第二设备20根据会话密钥对发送给第一设备10的数据进行加密，及根据会话密钥对第一设备10发送的数据进行解密。如此，第一设备10与第二设备20之间构成信任环的通信通道。本申请中第一设备10将第一设备10的私钥存储在TPM中进行安全存储，防止第一设备10的私钥被泄露后出现非认证的设备也可以加入信任环的情况，相比于在操作系统中进行第一设备10与第二设备20建立信任环的操作，本申请中的设备私钥泄露的风险被降低。参考图8所示，为本申请一实施例中基于TPM的数据保护系统310的示意图。所述基于TPM的数据保护系统310包括第一设备10、第二设备20。所述第一设备10包括可信平台模块。所述第一设备10与所述第二设备20建立通信连接。在一实施例中，第一设备10通过4GLET协议或5G SA协议与第二设备20通信连接。本实施例中，所述第一设备10可以是平板电脑、笔记本电脑、个人电脑等装置。所述第二设备20可以是手机、平板电脑、笔记本电脑、个人电脑、显示器等装置。参考图8所示，为本申请另一实施例中基于TPM的数据保护方法的流程示意图。所述方法中第一设备10从第二设备20中获取人脸信息，并将获取的人脸信息存储在第一设备10的TPM中。所述方法具体包括如下步骤。步骤S801，第一设备20的应用响应人脸识别操作，与第二设备20进行协同连接。参考图9所示，为本申请一实施例中第一设备进行人脸数据存储的示意图。在本申请的一实施例中，第一设备10的电脑管家应用响应用户输入的人脸识别操作，调用人脸识别服务。在人脸识别服务中，所述第一设备10响应人脸识别操作与第二设备20进行协同连接。步骤S802，第二设备20将采集的第一人脸数据同步发送到第一设备10中。本申请实施例中，第二设备20通过配置的摄像头采集用户的第一人脸数据，并将第一人脸数据存储在TEE中。步骤S803，第一设备10的应用向TPM发送加密请求，所述加密请求包括第一鉴权口令及第一人脸数据。步骤S804，TPM响应加密请求，获取第一鉴权口令及第一人脸数据，并判断第一鉴权口令是否正确。若第一鉴权口令正确，执行步骤S806，否则，若第一鉴权口令不正确，向第一设备10发送鉴权错误提醒。本实施例中，判断第一鉴权口令是否正确可以参照上述相关内容，这里不再详述。步骤S805，应用设定第二鉴权口令，并将第二鉴权口令发送给TPM。步骤S804执行完后，执行步骤S806。步骤S806，TPM获取核心资料及第二鉴权口令，并根据核心资料、第二鉴权口令对第一人脸数据进行加密后存储。步骤S807，第一设备10的应用响应采集人脸数据的操作，采集用户的第二人脸数据。本实施例中，第一设备10的应用响应用户输入的采集人脸数据的操作通过配置的摄像头采集用户的第二人脸数据。步骤S808，第一设备10的应用向TPM发送解密请求，所述解密请求包括第一鉴权口令。步骤S809，TPM响应解密请求，获取第一鉴权口令，并判断第一鉴权口令是否正确。若第一鉴权口令正确，执行步骤S810，否则，若第一鉴权口令不正确，向第一设备10发送鉴权错误提醒。步骤S810，TPM根据核心资料对加密的第一人脸数据进行解密后发送给第一设备10。步骤S811，第一设备10的应用根据第一人脸数据对第二人脸数据进行验证。本申请中在第一设备与第二设备协同连接的场景下，第二设备20采集的第一人脸数据会被同步到第一设备10中，用于第一设备10进行的人脸识别。第一设备10将第一人脸数据在TPM中进行加密后存储，确保用户人脸识别的第一人脸数据由TPM进行保护，提高了第一设备10的人脸识别能力的安全性。参考图10，所示为本申请另一实施例中基于TPM的数据保护方法的流程示意图。所述方法包括如下步骤。步骤S1001，第一设备10的应用向TPM发送加密请求，所述加密请求包括第一鉴权口令及待加密数据。步骤S1002，所述TPM响应所述加密请求，获取所述第一鉴权口令及所述待加密数据，并判断所述第一鉴权口令是否正确。若确定所述第一鉴权口令正确，执行步骤S1004，否则，若确定所述第一鉴权口令错误，执行步骤S1005，向第一设备10发出第一鉴权口令错误提醒。步骤S1003，第一设备10的应用设定第二鉴权口令，并将第二鉴权口令发送给TPM。步骤S1003执行完后，执行步骤S1004。步骤S1004，所述TPM在确定所述第一鉴权口令正确时，根据所述第一设备的核心资料、第二鉴权口令对待加密数据进行加密生成密文，将密文进行存储或发送给所述第一设备10的应用。在本申请的一实施例中，所述将密文发送给所述第一设备之后，所述方法还包括：所述第一设备10向所述TPM发送解密请求，所述解密请求包括所述第一鉴权口令及所述密文；所述TPM响应所述解密请求，获取所述第一鉴权口令及密文，并判断所述第一鉴权口令是否正确；所述TPM在确定所述第一鉴权口令正确时，根据所述核心资料对所述密文进行解密后发送给所述第一设备10。在本申请的一实施例中，所述将密文进行存储之后，所述方法还包括：所述第一设备10向所述TPM发送解密请求，所述解密请求包括第一鉴权口令；所述TPM响应所述解密请求，获取所述第一鉴权口令，并判断所述第一鉴权口令是否正确；所述TPM在确定所述第一鉴权口令正确时，根据所述核心资料对所述密文进行解密后发送给所述第一设备10。参考图11，所示为本申请另一实施例中基于TPM的数据保护方法的流程示意图。所述方法对第一设备10下载的应用进行验证，并在验证应用为合法应用时允许下载所述应用。所述方法具体包括如下步骤。步骤S1101，第一设备10的第一应用响应下载第二应用的操作，获取第二应用的数据签名。参考图12所示，为本申请一实施例中对应用进行验证的示意图。在本申请的一实施例中，第一设备10从第二应用的应用程序包中获取应用的数据签名。步骤S1102，第一设备10的应用向TPM发送获取公钥请求，所述获取公钥请求包括第一鉴权口令。步骤S1103，TPM响应所述获取公钥请求，判断第一鉴权口令是否正确。若第一鉴权口令正确，执行步骤S1104，否则，若第一鉴权口令不正确，向第一设备10发送第一鉴权口令错误提醒。步骤S1104，TPM从设备证书中提取出第一设备10的公钥，并将第一设备10的公钥发送给第一设备10。在本申请的一实施例中，第一设备10的公钥为第一设备10的生产厂商的公钥。步骤S1105，第一设备10的应用根据第一设备10的公钥对第二应用的数据签名进行验证，并在验证成功后允许下载所述第二应用。本申请中，第一设备10的第一应用从TPM中获取第一设备10的公钥对第二应用的数据签名进行验证，从而实现利用TPM对第一设备10的公钥进行数据保护，在实现对第二应用进行验证的同时能够抵御操作系统无法防御的高级攻击，提升了公钥数据的安全性。下面对本申请实施例涉及的电子设备400进行介绍。参考图13，所示为本申请一实施例中电子设备400的硬件结构示意图。所述电子设备400可以是手机、平板电脑、桌面型计算机、膝上型计算机、手持计算机、笔记本电脑、超级移动个人计算机、上网本，以及蜂窝电话、个人数字助理、增强现实设备、虚拟现实设备、人工智能设备、可穿戴式设备、车载设备、智能家居设备和/或智慧城市设备，本申请的一些实施例对该电子设备400的具体类型不作特殊限制。在其他实施例中，所述电子设备400包括第二设备20及第一设备10。本实施例中，电子设备400可以包括处理器110，外部存储器接口120，内部存储器121，通用串行总线接口130，充电管理模块140，电源管理模块141，电池142，天线1，天线2，移动通信模块150，无线通信模块160，音频模块170，扬声器170A，受话器170B，麦克风170C，耳机接口170D，传感器模块180，按键190，马达191，指示器192，摄像头193，显示屏194，以及用户标识模块卡接口195等。其中传感器模块180可以包括压力传感器180A，陀螺仪传感器180B，气压传感器180C，磁传感器180D，加速度传感器180E，距离传感器180F，接近光传感器180G，指纹传感器180H，温度传感器180J，触摸传感器180K，环境光传感器180L，骨传导传感器180M等。可以理解的是，本申请实施例示意的结构并不构成对电子设备400的具体限定。在本申请另一些实施例中，电子设备400可以包括比图示更多或更少的部件，或者组合某些部件，或者拆分某些部件，或者不同的部件布置。图示的部件可以以硬件，软件或软件和硬件的组合实现。处理器110可以包括一个或多个处理单元，例如：处理器110可以包括应用处理器，调制解调处理器，图形处理器，图像信号处理器，控制器，视频编解码器，数字信号处理器，基带处理器，和/或神经网络处理器等。其中，不同的处理单元可以是独立的器件，也可以集成在一个或多个处理器中。控制器可以根据指令操作码和时序信号，产生操作控制信号，完成取指令和执行指令的控制。处理器110中还可以设置存储器，用于存储指令和数据。在一些实施例中，处理器110中的存储器为高速缓冲存储器。该存储器可以保存处理器110刚用过或循环使用的指令或数据。如果处理器110需要再次使用该指令或数据，可从所述存储器中直接调用。避免了重复存取，减少了处理器110的等待时间，因而提高了系统的效率。在一些实施例中，处理器110可以包括一个或多个接口。接口可以包括集成电路接口，集成电路内置音频接口，脉冲编码调制接口，通用异步收发传输器接口，移动产业处理器接口，通用输入输出接口，用户标识模块接口，和/或通用串行总线接口等。I2C接口是一种双向同步串行总线，包括一根串行数据线和一根串行时钟线。在一些实施例中，处理器110可以包含多组I2C总线。处理器110可以通过不同的I2C总线接口分别耦合触摸传感器180K，充电器，闪光灯，摄像头193等。例如：处理器110可以通过I2C接口耦合触摸传感器180K，使处理器110与触摸传感器180K通过I2C总线接口通信，实现电子设备400的触摸功能。I2S接口可以用于音频通信。在一些实施例中，处理器110可以包含多组I2S总线。处理器110可以通过I2S总线与音频模块170耦合，实现处理器110与音频模块170之间的通信。在一些实施例中，音频模块170可以通过I2S接口向无线通信模块160传递音频信号，实现通过蓝牙耳机接听电话的功能。PCM接口也可以用于音频通信，将模拟信号抽样，量化和编码。在一些实施例中，音频模块170与无线通信模块160可以通过PCM总线接口耦合。在一些实施例中，音频模块170也可以通过PCM接口向无线通信模块160传递音频信号，实现通过蓝牙耳机接听电话的功能。所述I2S接口和所述PCM接口都可以用于音频通信。UART接口是一种通用串行数据总线，用于异步通信。该总线可以为双向通信总线。它将要传输的数据在串行通信与并行通信之间转换。在一些实施例中，UART接口通常被用于连接处理器110与无线通信模块160。例如：处理器110通过UART接口与无线通信模块160中的蓝牙模块通信，实现蓝牙功能。在一些实施例中，音频模块170可以通过UART接口向无线通信模块160传递音频信号，实现通过蓝牙耳机播放音乐的功能。MIPI接口可以被用于连接处理器110与显示屏194，摄像头193等外围器件。MIPI接口包括摄像头串行接口，显示屏串行接口等。在一些实施例中，处理器110和摄像头193通过CSI接口通信，实现电子设备400的拍摄功能。处理器110和显示屏194通过DSI接口通信，实现电子设备400的显示功能。GPIO接口可以通过软件配置。GPIO接口可以被配置为控制信号，也可被配置为数据信号。在一些实施例中，GPIO接口可以用于连接处理器110与摄像头193，显示屏194，无线通信模块160，音频模块170，传感器模块180等。GPIO接口还可以被配置为I2C接口，I2S接口，UART接口，MIPI接口等。USB接口130是符合USB标准规范的接口，具体可以是Mini USB接口，Micro USB接口，USB Type C接口等。USB接口130可以用于连接充电器为电子设备400充电，也可以用于电子设备400与外围设备之间传输数据。也可以用于连接耳机，通过耳机播放音频。该接口还可以用于连接其他电子设备400，例如AR设备等。可以理解的是，本申请实施例示意的各模块间的接口连接关系，只是示意性说明，并不构成对电子设备400的结构限定。在本申请另一些实施例中，电子设备400也可以采用上述实施例中不同的接口连接方式，或多种接口连接方式的组合。充电管理模块140用于从充电器接收充电输入。其中，充电器可以是无线充电器，也可以是有线充电器。在一些有线充电的实施例中，充电管理模块140可以通过USB接口130接收有线充电器的充电输入。在一些无线充电的实施例中，充电管理模块140可以通过电子设备400的无线充电线圈接收无线充电输入。充电管理模块140为电池142充电的同时，还可以通过电源管理模块141为电子设备400供电。电源管理模块141用于连接电池142，充电管理模块140与处理器110。电源管理模块141接收电池142和/或充电管理模块140的输入，为处理器110，内部存储器121，显示屏194，摄像头193，和无线通信模块160等供电。电源管理模块141还可以用于监测电池容量，电池循环次数，电池健康状态等参数。在其他一些实施例中，电源管理模块141也可以设置于处理器110中。在另一些实施例中，电源管理模块141和充电管理模块140也可以设置于同一个器件中。电子设备400的无线通信功能可以通过天线1，天线2，移动通信模块150，无线通信模块160，调制解调处理器以及基带处理器等实现。天线1和天线2用于发射和接收电磁波信号。电子设备400中的每个天线可用于覆盖单个或多个通信频带。不同的天线还可以复用，以提高天线的利用率。例如：可以将天线1复用为无线局域网的分集天线。在另外一些实施例中，天线可以和调谐开关结合使用。移动通信模块150可以提供应用在电子设备400上的包括2G/3G/4G/5G等无线通信的解决方案。移动通信模块150可以包括至少一个滤波器，开关，功率放大器，低噪声放大器等。移动通信模块150可以由天线1接收电磁波，并对接收的电磁波进行滤波，放大等处理，传送至调制解调处理器进行解调。移动通信模块150还可以对经调制解调处理器调制后的信号放大，经天线1转为电磁波辐射出去。在一些实施例中，移动通信模块150的至少部分功能模块可以被设置于处理器110中。在一些实施例中，移动通信模块150的至少部分功能模块可以与处理器110的至少部分模块被设置在同一个器件中。调制解调处理器可以包括调制器和解调器。其中，调制器用于将待发送的低频基带信号调制成中高频信号。解调器用于将接收的电磁波信号解调为低频基带信号。随后解调器将解调得到的低频基带信号传送至基带处理器处理。低频基带信号经基带处理器处理后，被传递给应用处理器。应用处理器通过音频设备输出声音信号，或通过显示屏194显示图像或视频。在一些实施例中，调制解调处理器可以是独立的器件。在另一些实施例中，调制解调处理器可以独立于处理器110，与移动通信模块150或其他功能模块设置在同一个器件中。无线通信模块160可以提供应用在电子设备400上的包括无线局域网网络)，蓝牙，全球导航卫星系统，调频，近距离无线通信技术，红外技术等无线通信的解决方案。无线通信模块160可以是集成至少一个通信处理模块的一个或多个器件。无线通信模块160经由天线2接收电磁波，将电磁波信号调频以及滤波处理，将处理后的信号发送到处理器110。无线通信模块160还可以从处理器110接收待发送的信号，对其进行调频，放大，经天线2转为电磁波辐射出去。在一些实施例中，电子设备400的天线1和移动通信模块150耦合，天线2和无线通信模块160耦合，使得电子设备400可以通过无线通信技术与网络以及其他设备通信。所述无线通信技术可以包括全球移动通讯系统，通用分组无线服务，码分多址接入，宽带码分多址，时分码分多址，长期演进，BT，GNSS，WLAN，NFC，FM，和/或IR技术等。所述GNSS可以包括全球卫星定位系统，全球导航卫星系统，北斗卫星导航系统，准天顶卫星系统和/或星基增强系统。电子设备400通过GPU，显示屏194，以及应用处理器等实现显示功能。GPU为图像处理的微处理器，连接显示屏194和应用处理器。GPU用于执行数学和几何计算，用于图形渲染。处理器110可包括一个或多个GPU，其执行程序指令以生成或改变显示信息。显示屏194用于显示图像，视频等。显示屏194包括显示面板。显示面板可以采用液晶显示屏，有机发光二极管，有源矩阵有机发光二极体或主动矩阵有机发光二极体，柔性发光二极管，Miniled，MicroLed，Micro-oLed，量子点发光二极管等。在一些实施例中，电子设备400可以包括1个或N个显示屏194，N为大于1的正整数。电子设备400可以通过ISP，摄像头193，视频编解码器，GPU，显示屏194以及应用处理器等实现拍摄功能。ISP用于处理摄像头193反馈的数据。例如，拍照时，打开快门，光线通过镜头被传递到摄像头感光元件上，光信号转换为电信号，摄像头感光元件将所述电信号传递给ISP处理，转化为肉眼可见的图像。ISP还可以对图像的噪点，亮度，肤色进行算法优化。ISP还可以对拍摄场景的曝光，色温等参数优化。在一些实施例中，ISP可以设置在摄像头193中。摄像头193用于捕获静态图像或视频。物体通过镜头生成光学图像投射到感光元件。感光元件可以是电荷耦合器件或互补金属氧化物半导体光电晶体管。感光元件把光信号转换成电信号，之后将电信号传递给ISP转换成数字图像信号。ISP将数字图像信号输出到DSP加工处理。DSP将数字图像信号转换成标准的RGB，YUV等格式的图像信号。在一些实施例中，电子设备400可以包括1个或N个摄像头193，N为大于1的正整数。数字信号处理器用于处理数字信号，除了可以处理数字图像信号，还可以处理其他数字信号。例如，当电子设备400在频点选择时，数字信号处理器用于对频点能量进行傅里叶变换等。视频编解码器用于对数字视频压缩或解压缩。电子设备400可以支持一种或多种视频编解码器。这样，电子设备400可以播放或录制多种编码格式的视频，例如：动态图像专家组1，MPEG2，MPEG3，MPEG4等。NPU为神经网络计算处理器，通过借鉴生物神经网络结构，例如借鉴人脑神经元之间传递模式，对输入信息快速处理，还可以不断的自学习。通过NPU可以实现电子设备400的智能认知等应用，例如：图像识别，人脸识别，语音识别，文本理解等。内部存储器121可以包括一个或多个随机存取存储器和一个或多个非易失性存储器。随机存取存储器可以包括静态随机存储器、动态随机存储器、同步动态随机存储器、双倍资料率同步动态随机存取存储器等；非易失性存储器可以包括磁盘存储器件、快闪存储器。快闪存储器按照运作原理划分可以包括NOR FLASH、NAND FLASH、3D NAND FLASH等，按照存储单元电位阶数划分可以包括单阶存储单元、多阶存储单元、三阶储存单元、四阶储存单元等，按照存储规范划分可以包括通用闪存存储、嵌入式多媒体存储卡等。随机存取存储器可以由处理器110直接进行读写，可以用于存储操作系统或其他正在运行中的程序的可执行程序，还可以用于存储用户及应用程序的数据等。非易失性存储器也可以存储可执行程序和存储用户及应用程序的数据等，可以提前加载到随机存取存储器中，用于处理器110直接进行读写。外部存储器接口120可以用于连接外部的非易失性存储器，实现扩展电子设备400的存储能力。外部的非易失性存储器通过外部存储器接口120与处理器110通信，实现数据存储功能。例如将音乐，视频等文件保存在外部的非易失性存储器中。内部存储器121或外部存储器接口120用于存储一个或多个计算机程序。一个或多个计算机程序被配置为被该处理器110执行。该一个或多个计算机程序包括多个指令，多个指令被处理器110执行时，可实现上述实施例中在电子设备400上执行基于TPM的数据保护方法，以实现电子设备400的数据保护功能。电子设备400可以通过音频模块170，扬声器170A，受话器170B，麦克风170C，耳机接口170D，以及应用处理器等实现音频功能。例如音乐播放，录音等。音频模块170用于将数字音频信息转换成模拟音频信号输出，也用于将模拟音频输入转换为数字音频信号。音频模块170还可以用于对音频信号编码和解码。在一些实施例中，音频模块170可以设置于处理器110中，或将音频模块170的部分功能模块设置于处理器110中。扬声器170A，也称“喇叭”，用于将音频电信号转换为声音信号。电子设备400可以通过扬声器170A收听音乐，或收听免提通话。受话器170B，也称“听筒”，用于将音频电信号转换成声音信号。当电子设备400接听电话或语音信息时，可以通过将受话器170B靠近人耳接听语音。麦克风170C，也称“话筒”，“传声器”，用于将声音信号转换为电信号。当拨打电话或发送语音信息时，用户可以通过人嘴靠近麦克风170C发声，将声音信号输入到麦克风170C。电子设备400可以设置至少一个麦克风170C。在另一些实施例中，电子设备400可以设置两个麦克风170C，除了采集声音信号，还可以实现降噪功能。在另一些实施例中，电子设备400还可以设置三个，四个或更多麦克风170C，实现采集声音信号，降噪，还可以识别声音来源，实现定向录音功能等。耳机接口170D用于连接有线耳机。耳机接口170D可以是USB接口130，也可以是3.5mm的开放移动电子设备400平台标准接口，美国蜂窝电信工业协会标准接口。压力传感器180A用于感受压力信号，可以将压力信号转换成电信号。在一些实施例中，压力传感器180A可以设置于显示屏194。压力传感器180A的种类很多，如电阻式压力传感器，电感式压力传感器，电容式压力传感器等。电容式压力传感器可以是包括至少两个具有导电材料的平行板。当有力作用于压力传感器180A，电极之间的电容改变。电子设备400根据电容的变化确定压力的强度。当有触摸操作作用于显示屏194，电子设备400根据压力传感器180A检测所述触摸操作强度。电子设备400也可以根据压力传感器180A的检测信号计算触摸的位置。在一些实施例中，作用于相同触摸位置，但不同触摸操作强度的触摸操作，可以对应不同的操作指令。例如：当有触摸操作强度小于第一压力阈值的触摸操作作用于短消息应用图标时，执行查看短消息的指令。当有触摸操作强度大于或等于第一压力阈值的触摸操作作用于短消息应用图标时，执行新建短消息的指令。陀螺仪传感器180B可以用于确定电子设备400的运动姿态。在一些实施例中，可以通过陀螺仪传感器180B确定电子设备400围绕三个轴的角速度。陀螺仪传感器180B可以用于拍摄防抖。示例性的，当按下快门，陀螺仪传感器180B检测电子设备400抖动的角度，根据角度计算出镜头模组需要补偿的距离，让镜头通过反向运动抵消电子设备400的抖动，实现防抖。陀螺仪传感器180B还可以用于导航，体感游戏场景。气压传感器180C用于测量气压。在一些实施例中，电子设备400通过气压传感器180C测得的气压值计算海拔高度，辅助定位和导航。磁传感器180D包括霍尔传感器。电子设备400可以利用磁传感器180D检测翻盖皮套的开合。在一些实施例中，当电子设备400是翻盖机时，电子设备400可以根据磁传感器180D检测翻盖的开合。进而根据检测到的皮套的开合状态或翻盖的开合状态，设置翻盖自动解锁等特性。加速度传感器180E可检测电子设备400在各个方向上加速度的大小。当电子设备400静止时可检测出重力的大小及方向。还可以用于识别电子设备400姿态，应用于横竖屏切换，计步器等应用。距离传感器180F，用于测量距离。电子设备400可以通过红外或激光测量距离。在一些实施例中，拍摄场景，电子设备400可以利用距离传感器180F测距以实现快速对焦。接近光传感器180G可以包括例如发光二极管和光检测器，例如光电二极管。发光二极管可以是红外发光二极管。电子设备400通过发光二极管向外发射红外光。电子设备400使用光电二极管检测来自附近物体的红外反射光。当检测到充分的反射光时，可以确定电子设备400附近有物体。当检测到不充分的反射光时，电子设备400可以确定电子设备400附近没有物体。电子设备400可以利用接近光传感器180G检测用户手持电子设备400贴近耳朵通话，以便自动熄灭屏幕达到省电的目的。接近光传感器180G也可用于皮套模式，口袋模式自动解锁与锁屏。环境光传感器180L用于感知环境光亮度。电子设备400可以根据感知的环境光亮度自适应调节显示屏194亮度。环境光传感器180L也可用于拍照时自动调节白平衡。环境光传感器180L还可以与接近光传感器180G配合，检测电子设备400是否在口袋里，以防误触。指纹传感器180H用于采集指纹。电子设备400可以利用采集的指纹特性实现指纹解锁，访问应用锁，指纹拍照，指纹接听来电等。温度传感器180J用于检测温度。在一些实施例中，电子设备400利用温度传感器180J检测的温度，执行温度处理策略。例如，当温度传感器180J上报的温度超过阈值，电子设备400执行降低位于温度传感器180J附近的处理器的性能，以便降低功耗实施热保护。在另一些实施例中，当温度低于另一阈值时，电子设备400对电池142加热，以避免低温导致电子设备400异常关机。在其他一些实施例中，当温度低于又一阈值时，电子设备400对电池142的输出电压执行升压，以避免低温导致的异常关机。触摸传感器180K，也称“触控器件”。触摸传感器180K可以设置于显示屏194，由触摸传感器180K与显示屏194组成触摸屏，也称“触控屏”。触摸传感器180K用于检测作用于其上或附近的触摸操作。触摸传感器可以将检测到的触摸操作传递给应用处理器，以确定触摸事件类型。可以通过显示屏194提供与触摸操作相关的视觉输出。在另一些实施例中，触摸传感器180K也可以设置于电子设备400的表面，与显示屏194所处的位置不同。骨传导传感器180M可以获取振动信号。在一些实施例中，骨传导传感器180M可以获取人体声部振动骨块的振动信号。骨传导传感器180M也可以接触人体脉搏，接收血压跳动信号。在一些实施例中，骨传导传感器180M也可以设置于耳机中，结合成骨传导耳机。音频模块170可以基于所述骨传导传感器180M获取的声部振动骨块的振动信号，解析出语音信号，实现语音功能。应用处理器可以基于所述骨传导传感器180M获取的血压跳动信号解析心率信息，实现心率检测功能。按键190包括开机键，音量键等。按键190可以是机械按键。也可以是触摸式按键。电子设备400可以接收按键输入，产生与电子设备400的用户设置以及功能控制有关的键信号输入。马达191可以产生振动提示。马达191可以用于来电振动提示，也可以用于触摸振动反馈。例如，作用于不同应用的触摸操作，可以对应不同的振动反馈效果。作用于显示屏194不同区域的触摸操作，马达191也可对应不同的振动反馈效果。不同的应用场景也可以对应不同的振动反馈效果。触摸振动反馈效果还可以支持自定义。指示器192可以是指示灯，可以用于指示充电状态，电量变化，也可以用于指示消息，未接来电，通知等。SIM卡接口195用于连接SIM卡。SIM卡可以通过插入SIM卡接口195，或从SIM卡接口195拔出，实现和电子设备400的接触和分离。电子设备400可以支持1个或N个SIM卡接口，N为大于1的正整数。SIM卡接口195可以支持Nano SIM卡，Micro SIM卡，SIM卡等。同一个SIM卡接口195可以同时插入多张卡。所述多张卡的类型可以相同，也可以不同。SIM卡接口195也可以兼容不同类型的SIM卡。SIM卡接口195也可以兼容外部存储卡。电子设备400通过SIM卡和网络交互，实现通话以及数据通信等功能。在一些实施例中，电子设备400采用eSIM，即：嵌入式SIM卡。eSIM卡可以嵌在电子设备400中，不能和电子设备400分离。本实施例还提供一种计算机存储介质，该计算机存储介质中存储有计算机指令，当该计算机指令在电子设备400上运行时，使得电子设备400执行上述相关方法步骤实现上述实施例中的基于TPM的数据保护方法。本实施例还提供了一种计算机程序产品，当该计算机程序产品在计算机上运行时，使得计算机执行上述相关步骤，以实现上述实施例中的基于TPM的数据保护方法。另外，本申请的实施例还提供一种装置，这个装置具体可以是芯片，组件或模块，该装置可包括相连的处理器和存储器；其中，存储器用于存储计算机执行指令，当装置运行时，处理器可执行存储器存储的计算机执行指令，以使芯片执行上述各方法实施例中的基于TPM的数据保护方法。其中，本实施例提供的电子设备400、计算机存储介质、计算机程序产品或芯片均用于执行上文所提供的对应的方法，因此，其所能达到的有益效果可参考上文所提供的对应的方法中的有益效果，此处不再赘述。通过以上的实施方式的描述，所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，仅以上述各功能模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能模块完成，即将装置的内部结构划分成不同的功能模块，以完成以上描述的全部或者部分功能。在本申请所提供的几个实施例中，应该理解到，所揭露的装置和方法，可以通过其它的方式实现。例如，以上所描述的装置实施例仅仅是示意性的，例如，该模块或单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个装置，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。该作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是一个物理单元或多个物理单元，即可以位于一个地方，或者也可以分布到多个不同地方。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本申请各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。该集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个可读取存储介质中。基于这样的理解，本申请实施例的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的全部或部分可以以软件产品的形式体现出来，该软件产品存储在一个存储介质中，包括若干指令用以使得一个设备或处理器执行本申请各个实施例方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上实施方式仅用以说明本申请的技术方案而非限制，尽管参照以上较佳实施方式对本申请进行了详细说明，本领域的普通技术人员应当理解，可以对本申请的技术方案进行修改或等同替换都不应脱离本申请技术方案的精神和范围。
