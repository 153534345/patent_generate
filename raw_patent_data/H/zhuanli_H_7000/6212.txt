标题title
一种软件定义网络中的DDoS攻击风险量化防御方法及系统
摘要abst
本发明主要在SDN架构下设计了一套DDoS攻击风险量化防御方法及系统，目的在于如何快速应对攻击以及确保DDoS攻击检测的识别率，在用户拥有正常服务体验的前提下，处理来自DDoS攻击的威胁。本发明使用SDN网络架构，相较于大多数在SDN上DDoS攻击检测研究均是在控制器上进行判断与解析，本发明将初步的判断与解析设置在交换机上，由SDN架构中的数据转发层就率先对流量进行初步的处理，该层位于处理数据包流量的第一线，因此在此层实施初步的攻击风险量化处理便能有效且快速的应对攻击流量，进而配合上机器学习进行攻击识别，能够形成两阶段的攻击防御，这样既确保了较高的攻击识别率，又能使用户的正常访问流量不受影响。
权利要求书clms
1.一种软件定义网络中的DDoS攻击风险量化防御方法，其特征在于：所述软件定义网络包括应用层、控制层和数据转发层，其中应用层包括机器学习缓解服务器和资料收集模块，控制层包括网络控制器和路由控制模块，数据转发层包括若干交换机，每个交换机上均设置有熵判断模块；所述方法包括第一阶段攻击风险量化处理阶段和第二阶段机器学习攻击识别阶段，具体包括如下步骤：其中，第一阶段攻击风险量化处理阶段包括：步骤1：接收到数据包后，判断数据包类型是ARP数据包还是IP数据包，若数据包为ARP数据包则进入步骤2，若数据包为IP数据包则进入步骤5；步骤2：当接收到ARP数据包时，首先比对系统中IP地址来源表，判断所述ARP数据包来源是否记录于系统中，若是则进入步骤3，若否则将所述ARP数据包的源IP记录于系统中并协助转发至目的地址，结束识别判断；步骤3：判断所述ARP数据包数量是否小于上限PktNumA，若小于则将所述ARP数据包协助转发至目的地址，结束识别判断；若大于或等于则进入步骤4；步骤4：熵判断模块判断所述ARP数据包是否为正常，若是则将所述ARP数据包协助转发至目的地址，结束识别判断；若否则进一步判断是否为攻击数据包，若是则直接丢弃数据包，若否则将所述ARP数据包协助转发至目的地址，结束识别判断；步骤5：熵判断模块判断所述IP数据包是否为攻击数据包，若是则直接丢弃数据包，并将源IP地址列入黑名单，若否则进入步骤6；步骤6：熵判断模块判断所述IP数据包是否为正常，若是则由路由控制模块寻找最佳转发路径转发所述IP数据包，若判断为疑似攻击则由路由控制模块寻找最差转发路径转发所述IP数据包；第二阶段机器学习攻击识别阶段，具体包括：资料收集模块定时向网络控制器请求数据转发层的数据资料，并交由机器学习缓解服务器采用机器学习算法判断是否有攻击发生，当系统判断有攻击时，发送识别结果让网络控制器把攻击源列入黑名单，后续来自攻击源的数据包流量一律丢弃处理；当执行完第一阶段攻击识别后会开始第二阶段的攻击判断，此时下一轮进来的数据包流量会开始下一轮的第一阶段攻击识别并不断循环，第二阶段会对数据包流量定时进行高精度的攻击判断。2.根据权利要求1所述的一种软件定义网络中的DDoS攻击风险量化防御方法，其特征在于，所述熵判断模块对数据包判断是否为正常具体包括：S1、熵判断模块接收到数据包后首先计算业务提供服务器端的熵值，并判断转发到业务提供服务器端的所述数据包数量是否小于阈值PktNumB，若是则判定所述数据包为正常流量，若否则进入步骤S2；S2、判断转发到业务提供服务器端的所述数据包是否为同一个来源，若是则所述数据包为正常流量，若否则进入步骤S3；S3、熵判断模块根据所述熵值给予不同的量化分级，当熵值大于阈值EntropyX时判断为正常流量，当熵值小于等于阈值EntropyX且大于阈值EntropyY时判断为疑似攻击，当熵值小于等于阈值EntropyY判断为攻击流量；S4、对于判断为疑似攻击或攻击流量的数据包进行判断是否存在误判，若否则保持原有判断结果，若是则将结果修改为正常流量。3.根据权利要求2所述的一种软件定义网络中的DDoS攻击风险量化防御方法，其特征在于，熵判断模块接收到数据包后首先计算业务提供服务器端的熵值具体包括：根据公式计算熵值，其中H为欲计算的熵值，N为数据包流量来源总数，Pi为数据包流量来源i流向业务提供服务器的概率；采用公式计算数据包流量来源i流向业务提供服务器的概率Pi，其中fi为数据包流量来源i流向业务提供服务器的数据包数量，ft则为业务提供服务器接收到所有数据包流量来源的数据包总量，采用公式计算得出。4.根据权利要求3所述的一种软件定义网络中的DDoS攻击风险量化防御方法，其特征在于，所述对于判断为疑似攻击或攻击流量的数据包进行判断是否存在误判，具体包括：检测所述判断为疑似攻击或攻击流量的数据包数量占数据总流量的比率，若比率大于等于阈值PT，则将结果判断为不存在误判，若小于阈值则将结果修改为正常流量；或者，检测所述判断为疑似攻击或攻击流量的数据包每5秒钟的访问次数，判断所述访问次数是否大于等于阈值PktNumc，若是则将结果判断为不存在误判，若否则将结果修改为正常流量；或者，检测所述判断为疑似攻击或攻击流量的数据包每5秒钟的访问次数，判断所述访问次数是否大于等于阈值PktNumc，若否则将结果修改为正常流量，若是则进一步检测所述判断为疑似攻击或攻击流量的数据包来源首次访问时间，并根据首次访问时间距离当前检测时间的长短动态设置阈值X，当所述判断为疑似攻击或攻击流量的数据包从首次访问时间到当前检测时间的访问次数大于等于所述阈值X时，将结果判断为不存在误判。5.根据权利要求1所述的一种软件定义网络中的DDoS攻击风险量化防御方法，其特征在于，熵判断模块对数据包进行量化分级后，交由路由控制模块寻找转发路径，具体包括：基于每条路径的负载率，从所述数据包到业务提供服务器的所有转发路径中进行挑选，对判定为正常流量的数据包，选择负载率最低的路径为最佳转发路径；对判定为疑似攻击的数据包，选择负载率最高的路径为最差转发路径；选择完转发路径后，依据选择的路径将负责率更新，使之后的数据包能够以最新的负载率为依据进行路径选择。6.根据权利要求1-5任一项所述的一种软件定义网络中的DDoS攻击风险量化防御方法，其特征在于，所述机器学习算法包括：SVM算法、决策树算法或随机森林算法。7.一种软件定义网络中的DDoS攻击风险量化防御系统，其特征在于，所述系统包括应用层、控制层和数据转发层，其中应用层包括机器学习缓解服务器和资料收集模块，控制层包括网络控制器和路由控制模块，数据转发层包括若干交换机，每个交换机上均设置有熵判断模块；所述交换机接收到数据包后，判断数据包类型是ARP数据包还是IP数据包，当接收到ARP数据包时，首先比对系统中IP地址来源表，判断所述ARP数据包来源是否记录于系统中，若否则将所述ARP数据包的源IP记录于系统中并协助转发至目的地址，结束识别判断，若是则进一步判断所述ARP数据包数量是否小于上限PktNumA，若小于则将所述ARP数据包协助转发至目的地址，结束识别判断，若大于或等于则交由熵判断模块；熵判断模块判断所述ARP数据包是否为正常，若是则将所述ARP数据包协助转发至目的地址，结束识别判断；若否则进一步判断是否为攻击数据包，若是则直接丢弃数据包，若否则将所述ARP数据包协助转发至目的地址，结束识别判断；熵判断模块判断IP数据包是否为攻击数据包，若是则直接丢弃数据包，并将源IP地址列入黑名单，若否则进一步判断所述IP数据包是否为正常，若为正常则由路由控制模块寻找最佳转发路径转发所述IP数据包，若判断为疑似攻击则由路由控制模块寻找最差转发路径转发所述IP数据包；资料收集模块定时向网络控制器请求数据转发层的数据资料，并交由机器学习缓解服务器采用机器学习算法判断是否有攻击发生，当系统判断有攻击时，所述机器学习缓解服务器发送识别结果让网络控制器把攻击源列入黑名单，后续来自攻击源的数据包流量一律丢弃处理。8.一种电子设备，其特征在于包括：一个或多个处理器，计算机可读存储介质，用于存储一个或多个程序，其中，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现权利要求1-6任一项所述的方法步骤。9.一种计算机可读存储介质，其特征在于存储有计算机可执行指令，所述指令在被执行时用于实现权利要求1-6任一项所述的方法步骤。
说明书desc
技术领域本申请涉及计算机网络安全领域，具体来说，涉及一种软件定义网络中的DDoS攻击风险量化防御方法及系统。背景技术拒绝服务攻击，是指故意攻击网络协议实现的缺陷或直接耗尽被攻击对象的资源，让目标计算机或网络无法提供正常的服务或资源访问的行为。DDoS则是指借助于客户/服务器技术，将多个计算机联合起来作为攻击平台，对一个或多个目标发动DoS攻击，从而成倍地提高拒绝服务攻击的威力。DDoS攻击是目前网络环境下最严重的威胁之一。SDN是一种新型的网络架构，设计理念是将网络的控制平面与数据转发层面分离，并实现可编程化控制。SDN架构通常分为三层，最上层为应用层，包括不同的业务和应用；控制层主要负责处理数据资源的编排，维护网络拓扑，信息状态等；数据转发层负责基于流表的数据处理，转发和状态收集。在SDN架构下可以通过深层次的数据包分析，实现更加灵活的更新流量策略，在复杂的网络环境中可以实现更高级的网络监控，为细粒度的网络攻击识别提供了基础，并且SDN的可编程性为在网络攻击识别中应用机器学习模块提供了良好的接口。与传统路由网络相比，SDN支持可编程和动态的网络。虽然它拥有更灵活的网络管理，但我们应该了解当前和即将到来的安全威胁以及其部署。现有对SDN研究中不乏针对服务器DDoS攻击的研究。早在2010年，Braga等人提出通过训练SMO分类器，来检测DDoS攻击，但是只讨论了DDoS检测方法，并没有考虑到缓解机制。2014年，K.Giotis et等人提出利用sFlow和OpenFlow来实现异常入侵检测的方法。利用sFlow的抽样能力进行流量的采集，利用统计熵的方法来进行异常检测。OpenFlow协议用于通过修改现有流的优先级值和安装带有drop动作和高优先级的新的流规则来减轻攻击。但是，熵方法有一个强有力的假设，即交通数据遵循一定的正态分布。如果假设不正确，检测率就会降低。2015年，Rui Wang等人提出了一种基于熵的轻量级DDoS攻击检测模型并且运行在控制器中。该方案针的是受害者主机的攻击，他们将控制器的功能进行了拓展，使得控制器机能够记录最近一次流表中目的地址的变化量，然后进行熵值的计算，通过与阈值的比较做出判断。该方案仅仅依靠目的地址的变化量的熵值来判断攻击，会对一些正常的流量请求产生误判，并且将判断程序运行在控制器硬件上，日后的更新会比较麻烦且对控制器的运行造成较大的负担从而产生较高的处理时延。对于具有较高识别率的DDoS检测系统，必须通过SDN网络架构中的应用层收集足够的数据资料才能够正常运行，然而在收集数据资料并加以实施的过程中，势必会产生处理上的延迟。相对的，找出DDoS攻击并同时能够缓解攻击对网络系统的影响，让网络系统能够在保有应对攻击流量能力的同时，使正常用户的访问不受影响，这种兼顾攻击检测与缓解的问题还有待解决。发明内容本发明主要在SDN架构下设计了一套DDoS攻击风险量化防御方法及系统，目的在于如何快速应对攻击以及确保DDoS攻击检测的识别率，在用户拥有正常服务体验的前提下，处理来自DDoS攻击的威胁。本发明使用SDN网络架构，相较于大多数在SDN上DDoS攻击检测研究均是在控制器上进行判断与解析，本发明将初步的判断与解析设置在交换机上，由SDN架构中的数据转发层就率先对流量进行初步的处理，该层位于处理数据包流量的第一线，因此在此施展初步的攻击风险量化处理便能有效且快速的应对攻击流量，进而配合上机器学习进行攻击识别，能够形成两阶段的攻击防御，这样既确保了较高的攻击识别率，又能使用户的正常访问流量不受影响。为了实现上述目的，本发明采用了如下技术方案：本发明第一方面公开了一种软件定义网络中的DDoS攻击风险量化防御方法，所述软件定义网络包括应用层、控制层和数据转发层，其中应用层包括机器学习缓解服务器和资料收集模块，控制层包括网络控制器和路由控制模块，数据转发层包括若干交换机，每个交换机上均设置有熵判断模块；所述方法包括第一阶段攻击风险量化处理阶段和第二阶段机器学习攻击识别阶段，具体包括如下步骤：其中，第一阶段攻击风险量化处理阶段包括：步骤1：接收到数据包后，判断数据包类型是ARP数据包还是IP数据包，若数据包为ARP数据包则进入步骤2，若数据包为IP数据包则进入步骤5；步骤2：当接收到ARP数据包时，首先比对系统中IP地址来源表，判断所述ARP数据包来源是否记录于系统中，若是则进入步骤3，若否则将所述ARP数据包的源IP记录于系统中并协助转发至目的地址，结束识别判断；步骤3：判断所述ARP数据包数量是否小于上限PktNumA，若小于则将所述ARP数据包协助转发至目的地址，结束识别判断；若大于或等于则进入步骤4；步骤4：熵判断模块判断所述ARP数据包是否为正常，若是则将所述ARP数据包协助转发至目的地址，结束识别判断；若否则进一步判断是否为攻击数据包，若是则直接丢弃数据包，若否则将所述ARP数据包协助转发至目的地址，结束识别判断；步骤5：熵判断模块判断所述IP数据包是否为攻击数据包，若是则直接丢弃数据包，并将源IP地址列入黑名单，若否则进入步骤6；步骤6：熵判断模块判断所述IP数据包是否为正常，若是则由路由控制模块寻找最佳转发路径转发所述IP数据包，若判断为疑似攻击则由路由控制模块寻找最差转发路径转发所述IP数据包；第二阶段机器学习攻击识别阶段，具体包括：资料收集模块定时向网络控制器请求数据转发层的数据资料，并交由机器学习缓解服务器采用机器学习算法判断是否有攻击发生，当系统判断有攻击时，发送识别结果让网络控制器把攻击源列入黑名单，后续来自攻击源的数据包流量一律丢弃处理；当执行完第一阶段攻击识别后会开始第二阶段的攻击判断，此时下一轮进来的数据包流量会开始下一轮的第一阶段攻击识别并不断循环，第二阶段会对数据包流量定时进行高精度的攻击判断。进一步的，所述熵判断模块对数据包进行量化分级具体包括：S1、熵判断模块接收到数据包后首先计算业务提供服务器端的熵值，并判断转发到业务提供服务器端的所述数据包数量是否小于阈值PktNumB，若是则判定所述数据包为正常流量，若否则进入步骤S2；S2、判断转发到业务提供服务器端的所述数据包是否为同一个来源，若是则所述数据包为正常流量，若否则进入步骤S3；S3、熵判断模块根据所述熵值给予不同的量化分级，当熵值大于阈值EntropyX时判断为正常流量，当熵值小于等于EntropyX且大于等于EntropyY时判断为疑似攻击，当熵值小于EntropyY判断为攻击流量；S4、对于判断为疑似攻击或攻击流量的数据包进行判断是否存在误判，若否则保持原有判断结果，若是则将结果修改为正常流量。进一步的，熵判断模块接收到数据包后首先计算业务提供服务器端的熵值具体包括：采用公式计算熵值，其中H为欲计算的熵值，N为数据包流量来源总数，Pi为数据包流量来源i流向业务提供服务器的概率；采用公式计算数据包流量来源i流向业务提供服务器的概率Pi，其中fi为数据包流量来源i流向业务提供服务器的数据包数量，ft则为业务提供服务器接收到所有数据包流量来源的数据包总量，采用公式计算得出；进一步的，所述对于判断为疑似攻击或攻击流量的数据包进行判断是否存在误判，具体包括：检测所述判断为疑似攻击或攻击流量的数据包数量占数据总流量的比率，若比率大于等于阈值PT，则将结果判断为不存在误判，若小于阈值则将结果修改为正常流量；或者，检测所述判断为疑似攻击或攻击流量的数据包每5秒钟的访问次数，判断所述访问次数是否大于等于阈值PktNumc，若是则将结果判断为不存在误判，若否则将结果修改为正常流量；或者，检测所述判断为疑似攻击或攻击流量的数据包每5秒钟的访问次数，判断所述访问次数是否大于等于阈值PktNumc，若否则将结果修改为正常流量，若是则进一步检测所述判断为疑似攻击或攻击流量的数据包来源首次访问时间，并根据首次访问时间距离当前检测时间的长短动态设置阈值X，当所述判断为疑似攻击或攻击流量的数据包从首次访问时间到当前检测时间的访问次数大于等于所述阈值X时，将结果判断为不存在误判。进一步的，熵判断模块对数据包进行量化分级后，交由路由控制模块寻找转发路径，具体包括：基于每条路径的负载率，从所述数据包到业务提供服务器的所有转发路径中进行挑选，对判定为正常流量的数据包，选择负载率最低的路径为最佳转发路径；对判定为疑似攻击的数据包，选择负载率最高的路径为最差转发路径；选择完转发路径后，依据选择的路径将负责率更新，使之后的数据包能够以最新的负载率为依据进行路径选择。进一步的，所述机器学习算法包括：SVM算法、决策树算法或随机森林算法。本发明第二方面公开了一种软件定义网络中的DDoS攻击风险量化防御系统，所述软件定义网络包括应用层、控制层和数据转发层，其中应用层包括机器学习缓解服务器和资料收集模块，控制层包括网络控制器和路由控制模块，数据转发层包括若干交换机，每个交换机上均设置有熵判断模块；所述交换机接收到数据包后，判断数据包类型是ARP数据包还是IP数据包，当接收到ARP数据包时，首先比对系统中IP地址来源表，判断所述ARP数据包来源是否记录于系统中，若否则将所述ARP数据包的源IP记录于系统中并协助转发至目的地址，结束识别判断，若是则进一步判断所述ARP数据包数量是否小于上限PktNumA，若小于则将所述ARP数据包协助转发至目的地址，结束识别判断，若大于或等于则交由熵判断模块；熵判断模块判断所述ARP数据包是否为正常，若是则将所述ARP数据包协助转发至目的地址，结束识别判断；若否则进一步判断是否为攻击数据包，若是则直接丢弃数据包，若否则将所述ARP数据包协助转发至目的地址，结束识别判断；熵判断模块判断IP数据包是否为攻击数据包，若是则直接丢弃数据包，并将源IP地址列入黑名单，若否则进一步判断所述IP数据包是否为正常，若为正常则由路由控制模块寻找最佳转发路径转发所述IP数据包，若判断为疑似攻击则由路由控制模块寻找最差转发路径转发所述IP数据包；资料收集模块定时向网络控制器请求数据转发层的数据资料，并交由机器学习缓解服务器采用机器学习算法判断是否有攻击发生，当系统判断有攻击时，所述机器学习缓解服务器发送识别结果让网络控制器把攻击源列入黑名单，后续来自攻击源的数据包流量一律丢弃处理。本发明第三方面公开了一种电子设备，包括：一个或多个处理器，计算机可读存储介质，用于存储一个或多个程序，其中，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现上述的方法步骤。本发明第四方面公开了一种计算机可读存储介质，存储有计算机可执行指令，所述指令在被执行时用于实现上述的方法步骤。总体而言，通过本发明所构思的以上技术方案与现有技术相比，具有以下有益效果：本发明通过采用两阶段的DDoS攻击检测的方式，第一阶段通过在数据转发层的交换机上设置熵判断模块对熵值和阈值的比较进行攻击判断，过滤大量攻击流量，在底层网络架构就行攻击防御识别，让攻击流量在第一时间就进行缓解处理，减轻了网络控制器的处理压力，第二阶段通过在应用层设置机器学习缓解服务器采用机器学习算法高精度判别网络中是否还存在攻击，定位并及时采取防御措施，进一步过滤大量恶意流量，保护SDN控制器和交换机，检测准确率更高。通过两阶段的攻击识别，使检测方法同时具有攻击快速识别和高识别准确率两项优点。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明一种软件定义网络中的DDoS攻击风险量化防御系统架构图；图2为本发明提供的一种软件定义网络中的DDoS攻击风险量化防御方法流程图；图3为本发明提供的熵判断模块对数据包进行量化分级的流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。下面结合实施例对本发明做进一步说明。需要理解的是，术语“长度”、“宽度”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本发明的描述中，“多个”的含义是两个或两个以上，除非另有明确具体的限定。为使本发明的目的、技术方案和优点更加清楚明白，以下结合具体实施例，并参照附图，对本发明进一步详细说明。需要说明的是，除非另外定义，本公开实施例使用的技术术语或者科学术语应当为本公开所属领域内具有一般技能的人士所理解的通常意义。本公开实施例中使用的“第一”、“第二”以及类似的词语并不表示任何顺序、数量或者重要性，而只是用来区分不同的组成部分。“包括”或者“包含”等类似的词语意指出现该词前面的元件或者物件涵盖出现在该词后面列举的元件或者物件及其等同，而不排除其他元件或者物件。“连接”或者“相连”等类似的词语并非限定于物理的或者机械的连接，而是可以包括电性的连接，不管是直接的还是间接的。“上”、“下”、“左”、“右”等仅用于表示相对位置关系，当被描述对象的绝对位置改变后，则该相对位置关系也可能相应地改变。本发明所涉及的名词解释如下：DDoS攻击：分布式拒绝服务攻击指处于不同位置的多个攻击者同时向一个或数个目标发动攻击，或者一个攻击者控制了位于不同位置的多台机器并利用这些机器对受害者同时实施攻击。IP地址：IP地址指互联网协议地址，又译为网际协议地址，P地址是IP协议提供的一种统一的地址格式。MAC地址：MAC地址，也称为局域网地址，以太网地址或物理地址，它是一个用来确认网络设备位置的位址。ARP协议：地址解析协议，是根据IP地址获取物理地址的一个TCP/IP协议。图1为本发明一种软件定义网络中的DDoS攻击风险量化防御系统架构图，根据SDN网络的特性可分为三层，分别为应用层、控制层和数据转发层。应用层：负责处理应用程序服务，同时也是机器学习缓解服务器所在的一层。由于DDoS攻击类型众多，若想要达到多类型的检测与防御，则必须收集更多的数据资料，若仅在数据转发层进行检测除了无法正确判断之外，也会加重控制器的负担，因此相比较之下，机器学习缓解服务器更适合放在应用层。控制层：负责控制数据转发层，网络控制器所在的一层，此层有路由控制模块负责执行路由策略。数据转发层：收到未知数据包时会询问控制层，并根据控制层下发的信息执行数据包流向处理，客户端发送服务请求会先经过数据转发层，待控制层回复后转发用户服务数据包。在此层中，本发明设计了熵判断模块，负责计算流经数据转发层的数据包熵，计算熵能够快速检测系统是否处于异常状态，熵的计算公式会受到几个因素影响：客户端来源IP地址、接收端IP地址、客户端请求数据包数量等等。当检测到网络正在被攻击时，熵判断模块会发现攻击，并禁止攻击来源的服务请求。禁止攻击端服务请求能确保其他客户端不用攻击影响。正常流量客户端：向业务提供服务器产生正常用户流量的设备。攻击流量客户端：向业务提供服务器产生攻击流量的设备，期要求的服务带宽和发送的数据包数量会远远超过正常客户端的流量，如不处理将会占用大量网络资源，使其他正常设备运行受到影响。业务提供服务器：负责提供各种网络服务的服务器，当客户端访问服务器时会回应客户端的请求。网络控制器：所有客户端与业务提供服务器都会使用到数据转发层的资源，如果数据转发层被攻击后没有做任何处理，网络将会产生严重的丢包情形，使用户体验收到影响。因此会需要有设备负责管理整个网络的情形，也就是控制层中的网络控制器。网络控制器是SDN网络中不可或缺的存在，能通过openflow协议管理交换机中的数据包流向或禁止数据包转发。当控制器收到熵判断模块的分析结果后，会对客户端进行一次量化分级，总共有三个量化级别，分别是：正常、疑似攻击、攻击。根据不同的分级网络控制器会采取不同的处理策略。正常：当网络控制器判断为正常时，给予分配最佳转发路径已确保其使用体验。疑似攻击：当网络控制器判断为疑似攻击时，会给予分配最差转发路径，如此一来便能不影响正常客户端的服务，同时也不会导致误判让正常客户端的体验收到严重影响。攻击：当网络控制器判断为攻击时，会直接丢弃来自客户端的数据包请求，确保数据转发层资源不受攻击占用。网络控制器会对交换机发送openflow信息，让交换机根据发送的信息确定数据包流向，此时路由控制模块会根据不同的量化分级给予不同的路有策略，将攻击数据包丢弃，并给予正常流量最佳转发路径，给予疑似攻击流量最差转发路径。最后业务提供服务器会收到客户端请求并响应请求，至此便完成第一阶段的攻击识别流程。当第一阶段攻击识别完成后会进入第二阶段，也就是机器学习缓解阶段。资料收集模块会定时向网络控制器请求数据转发层的数据资料，并交由机器学习缓解服务器判断是否有攻击发生。本发明可以使用SVM算法、决策树算法、随机森林算法或其他深度学习模型来对客户端分类，当系统判断有攻击时，发送识别结果让网络控制器把攻击源列入黑名单，后续来自攻击源的数据包流量一律丢弃处理。当系统执行完第一阶段攻击识别后会开始第二阶段的攻击判断，此时下一轮进来的数据包流量会开始下一轮的第一阶段攻击识别并不断循环，第二阶段的系统会定时进行高精度的攻击判断，以实现攻击检测的快速反应并同时具有高准确率的系统。图2为本发明提供的一种软件定义网络中的DDoS攻击风险量化防御方法流程图，如图2所示本方法包括第一阶段攻击风险量化处理阶段和第二阶段机器学习攻击识别阶段，具体包括如下步骤：其中，第一阶段攻击风险量化处理阶段包括：步骤1：接收到数据包后，判断数据包类型是ARP数据包还是IP数据包，若数据包为ARP数据包则进入步骤2，若数据包为IP数据包则进入步骤5；步骤2：当接收到ARP数据包时，首先比对系统中IP地址来源表，判断所述ARP数据包来源是否记录于系统中，若是则进入步骤3，若否则将所述ARP数据包的源IP记录于系统中并协助转发至目的地址，结束识别判断；步骤3：判断所述ARP数据包数量是否小于上限PktNumA，若小于则将所述ARP数据包协助转发至目的地址，结束识别判断；若大于或等于则进入步骤4；步骤4：熵判断模块判断所述ARP数据包是否为正常，若是则将所述ARP数据包协助转发至目的地址，结束识别判断；若否则进一步判断是否为攻击数据包，若是则直接丢弃数据包，若否则将所述ARP数据包协助转发至目的地址，结束识别判断；步骤5：熵判断模块判断所述IP数据包是否为攻击数据包，若是则直接丢弃数据包，并将源IP地址列入黑名单，若否则进入步骤6；步骤6：熵判断模块判断所述IP数据包是否为正常，若是则由路由控制模块寻找最佳转发路径转发所述IP数据包，若判断为疑似攻击则由路由控制模块寻找最差转发路径转发所述IP数据包；第二阶段机器学习攻击识别阶段，具体包括：资料收集模块定时向网络控制器请求数据转发层的数据资料，并交由机器学习缓解服务器采用机器学习算法判断是否有攻击发生，当系统判断有攻击时，发送识别结果让网络控制器把攻击源列入黑名单，后续来自攻击源的数据包流量一律丢弃处理；当执行完第一阶段攻击识别后会开始第二阶段的攻击判断，此时下一轮进来的数据包流量会开始下一轮的第一阶段攻击识别并不断循环，第二阶段会对数据包流量定时进行高精度的攻击判断。图3为熵判断模块对数据包进行量化分级的流程图，具体包括：S1、熵判断模块接收到数据包后首先计算业务提供服务器端的熵值，并判断转发到业务提供服务器端的所述数据包数量是否小于阈值PktNumB，若是则判定所述数据包为正常流量，若否则进入步骤S2；设定阈值PktNumB是为了防止熵值判断出现误判，设定该条件能确保转发到业务提供服务器的数据包数量太小时必定判断为正常流量；S2、判断转发到业务提供服务器端的所述数据包是否为同一个来源，若是则所述数据包为正常流量，若否则进入步骤S3；S3、熵判断模块根据所述熵值给予不同的量化分级，当熵值大于阈值EntropyX时判断为正常流量，当熵值小于等于EntropyX且大于等于EntropyY时判断为疑似攻击，当熵值小于EntropyY判断为攻击流量；S4、对于判断为疑似攻击或攻击流量的数据包进行判断是否存在误判，若否则保持原有判断结果，若是则将结果修改为正常流量。关于熵值的说明：熵是在物理热力学中的概念，而信息论的创始人香农引进了信息熵这个概念，表示对随机事件不确定性的度量。熵一般用H来表示，假设某个系统X由这n个变量组成，每个变量的概率分别为。则根据信息熵H的定义表示为：在DDoS攻击的检测网络信息流中，通过熵值的分散程度来表示流量的集中程度，熵值越小表示流量越集中，说明存在DDoS攻击的可能性大；熵值越大表示流量越分散，说明存在DDoS的可能性小。根据信息熵的定义，把流表项中的某个属性记为X，其特征值记为N，则数据包的流表项中属性X出现的次数记为ni，X的表示记为X＝{ni,i＝1,2,…,N}，特征值出现的总次数记为根据信息熵中概率的计算方法，则/＞下述公式表示在SDN转发流中属性X的信息熵：将计算出的信息熵值与阈值进行比较，比阈值高说明流表正常，比阈值低说明流表异常。本发明与机器学习和聚类算法相比，不需要进行大量的训练和部署时间，节省了系统的计算负载，以及节约了系统的计算资源。此外，在SDN中网络的动态变化对固定的阈值影响很大，例如，业务量和服务量增加需要添加大量的客户端主机和交换机，导致阈值不再准确，同时在受到DDoS攻击时，交换机或者客户端主机的宕机也会影响阈值的改变。因此在DDoS检测算法中采用动态更新的加权平均阈值来进行网络异常的判断，能够保证检测的准确率，同时可以减少资源利用率，降低误报率。当网络规模一定时，网络控制器根据网络中客户端主机数目和熵值公式计算最大的源IP熵值。SDN网络控制器集中管理SDN网络，能动态感知网络中主机数量，因此，本发明每隔1s更新一次阈值。基于上述分析，熵判断模块接收到数据包后首先计算业务提供服务器端的熵值具体包括：采用公式计算熵值，其中H为欲计算的熵值，N为数据包流量来源总数，Pi为数据包流量来源i流向业务提供服务器的概率；采用公式计算数据包流量来源i流向业务提供服务器的概率Pi，其中fi为数据包流量来源i流向业务提供服务器的数据包数量，ft则为业务提供服务器接收到所有数据包流量来源的数据包总量，采用公式计算得出；熵判断模块根据所述熵值给予不同的量化分级之后，有时候会因为客户端刚开始请求服务，数据包数量太少导致熵判断模块认定为是异常数据包，但是数量少的数据包并一定是攻击，此时还需进一步进行校验，因此所述对于判断为疑似攻击或攻击流量的数据包进行判断是否存在误判，具体包括：方法一：检测所述判断为疑似攻击或攻击流量的数据包数量占数据总流量的比率，若比率大于等于阈值PT，则将结果判断为不存在误判，若小于阈值则将结果修改为正常流量；方法二：检测所述判断为疑似攻击或攻击流量的数据包每5秒钟的访问次数，判断所述访问次数是否大于等于阈值PktNumc，若是则将结果判断为不存在误判，若否则将结果修改为正常流量；方法三：检测所述判断为疑似攻击或攻击流量的数据包每5秒钟的访问次数，判断所述访问次数是否大于等于阈值PktNumc，若否则将结果修改为正常流量，若是则进一步检测所述判断为疑似攻击或攻击流量的数据包来源首次访问时间，并根据首次访问时间距离当前检测时间的长短动态设置阈值X，当所述判断为疑似攻击或攻击流量的数据包从首次访问时间到当前检测时间的访问次数大于等于所述阈值X时，将结果判断为不存在误判。为了确保正常流量不被影响，进一步使用不同方式进行校验避免正常数据包被误判为攻击数据包。首先是上述方法一，该方法会计算疑似攻击或攻击流量的数据包数量占数据总流量的比率，目的是在过滤因数量太少导致熵值误判为攻击的流量。由于刚开始进入系统的数据包流量一定是最少的，熵判断模块检测到此包相对于其他数据包与众不同，因此计算出来的熵值就会偏低。此时，检测所述判断为疑似攻击或攻击流量的数据包数量占数据总流量的比率，若比率大于等于阈值PT，则将结果判断为不存在误判，若小于阈值则将结果修改为正常流量。对于方法二，会每5秒计算一次数据包的访问次数，并将小于阈值PktNumc的结果修改为正常流量。该方式的好处在于可以考虑到该流量请求的频率，并将请求频率过高的流量排除。对于方法三则是方法二的延伸，该方法考虑到数据包从首次访问时间到当前检测时间的访问次数，而仅在5秒内的次数，重点在于评估数据包总时间内的发送频率，能排除因为其他攻击流量被过滤后导致正常流量在短时间内增多的情况。熵判断模块对数据包进行量化分级后，交由路由控制模块寻找转发路径，由于网络拓扑往往较为复杂，选择路径需要有专门的路由方法处理，本发明从转发路径的负载率来考虑，基于每条路径的负载率，从所述数据包到业务提供服务器的所有转发路径中进行挑选，对判定为正常流量的数据包，选择负载率最低的路径为最佳转发路径；对判定为疑似攻击的数据包，选择负载率最高的路径为最差转发路径；选择完转发路径后，依据选择的路径将负责率更新，使之后的数据包能够以最新的负载率为依据进行路径选择。基于机器学习的攻击检测作为第二阶段检测，本发明选用SVM算法、决策树算法或随机森林算法。以SVM算法为例，该算法作为一种经典的模式识别算法，泛化能力强，无论对大样本还是小样本都有较好的分类效果。具体包括以下步骤：S1.资料收集模块收集网络中正常流量和攻击流量，结合DARPA数据集中正常流量和攻击流量，作为训练数据；训练数据采用离线数据和SDN网络在线数据相结合。离线数据采用DARPA2000中的LLS_DDOS_2.0.2的攻击流量作为负样本，DARPA1999中第一周的部分正常流量作为正样本；在线数据采用实验拓扑中的模拟流量数据，在实验SDN网络环境中基于正常网络通信流量的特性，制造背景流量作为正样本，在网络中发起synflood、udpflood和icmpflood不同混合比例的攻击，数据收集模块收集此时的数据作为负样本。将离线和在线的数据混合，提取训练样本的五元组特征。S2.机器学习缓解服务器使用SVM算法对训练数据进行训练，得到SVM攻击检测模型；本发明采用RBF核函数，该核函数的参数更少，能有效的降低模型的复杂程度，还能减少数值上的运算难度。为了确定RBF核函数最优的C和g，使C在范围内，g在范围内，采用三层交叉验证，使用网格参数寻优的方法，确定范围内最优的C和g。训练过程：将SDN网络中DDoS攻击训练样本映射到高维空间中，利用SVM算法思想在特征空间中寻找最优化的DDoS攻击检测超平面，形成DDoS攻击检测函数。S3.机器学习缓解服务器利用SVM攻击检测模型判别将疑似攻击流量是否存在攻击，若是，则判定为攻击流量。相应的，一种软件定义网络中的DDoS攻击风险量化防御系统，所述软件定义网络包括应用层、控制层和数据转发层，其中应用层包括机器学习缓解服务器和资料收集模块，控制层包括网络控制器和路由控制模块，数据转发层包括若干交换机，每个交换机上均设置有熵判断模块；所述交换机接收到数据包后，判断数据包类型是ARP数据包还是IP数据包，当接收到ARP数据包时，首先比对系统中IP地址来源表，判断所述ARP数据包来源是否记录于系统中，若否则将所述ARP数据包的源IP记录于系统中并协助转发至目的地址，结束识别判断，若是则进一步判断所述ARP数据包数量是否小于上限PktNumA，若小于则将所述ARP数据包协助转发至目的地址，结束识别判断，若大于或等于则交由熵判断模块；熵判断模块判断所述ARP数据包是否为正常，若是则将所述ARP数据包协助转发至目的地址，结束识别判断；若否则进一步判断是否为攻击数据包，若是则直接丢弃数据包，若否则将所述ARP数据包协助转发至目的地址，结束识别判断；熵判断模块判断IP数据包是否为攻击数据包，若是则直接丢弃数据包，并将源IP地址列入黑名单，若否则进一步判断所述IP数据包是否为正常，若为正常则由路由控制模块寻找最佳转发路径转发所述IP数据包，若判断为疑似攻击则由路由控制模块寻找最差转发路径转发所述IP数据包；资料收集模块定时向网络控制器请求数据转发层的数据资料，并交由机器学习缓解服务器采用机器学习算法判断是否有攻击发生，当系统判断有攻击时，所述机器学习缓解服务器发送识别结果让网络控制器把攻击源列入黑名单，后续来自攻击源的数据包流量一律丢弃处理。相应的，一种电子设备，包括：一个或多个处理器，计算机可读存储介质，用于存储一个或多个程序，其中，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现上述的方法步骤。本发明第四方面公开了一种计算机可读存储介质，存储有计算机可执行指令，所述指令在被执行时用于实现上述的方法步骤。本发明通过采用两阶段的DDoS攻击检测的方式，第一阶段通过在数据转发层的交换机上设置熵判断模块对熵值和阈值的比较进行攻击判断，过滤大量攻击流量，在底层网络架构就行攻击防御识别，让攻击流量在第一时间就进行缓解处理，减轻了网络控制器的处理压力，第二阶段通过在应用层设置机器学习缓解服务器采用机器学习算法高精度判别网络中是否还存在攻击，定位并及时采取防御措施，进一步过滤大量恶意流量，保护SDN控制器和交换机，检测准确率更高。通过两阶段的攻击识别，使检测方法同时具有攻击快速识别和高识别准确率两项优点。虽然上面已经参考各种实施例描述了本发明，但是应当理解，在不脱离本发明的范围的情况下，可以进行许多改变和修改。也就是说上面讨论的方法，系统和设备是示例。各种配置可以适当地省略，替换或添加各种过程或组件。例如，在替代配置中，可以以与所描述的顺序不同的顺序执行方法，和/或可以添加，省略和/或组合各种部件。而且，关于某些配置描述的特征可以以各种其他配置组合，如可以以类似的方式组合配置的不同方面和元素。此外，随着技术发展其中的元素可以更新，即许多元素是示例，并不限制本公开或权利要求的范围。在说明书中给出了具体细节以提供对包括实现的示例性配置的透彻理解。然而，可以在没有这些具体细节的情况下实践配置例如，已经示出了众所周知的电路、过程、算法、结构和技术而没有不必要的细节，以避免模糊配置。该描述仅提供示例配置，并且不限制权利要求的范围，适用性或配置。相反，前面对配置的描述将为本领域技术人员提供用于实现所描述的技术的使能描述。在不脱离本公开的精神或范围的情况下，可以对元件的功能和布置进行各种改变。以上对本发明的一个实施例进行了详细说明，但所述内容仅为本发明的较佳实施例，不能被认为用于限定本发明的实施范围。凡依本发明申请范围所作的均等变化与改进等，均应仍归属于本发明的专利涵盖范围之内。
