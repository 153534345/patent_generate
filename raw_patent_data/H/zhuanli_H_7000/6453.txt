标题title
基于互联微电网的虚拟电厂参与辅助服务调控方法及装置
摘要abst
一种基于互联微电网的虚拟电厂参与辅助服务调控方法及装置，方法包括：考虑分布式发电机组、光伏系统和储能系统的运行特性，以日前总运行成本最小为目标，建立虚拟电厂日前调度模型，得到虚拟电厂的分时基准用电量和可调节容量；电网根据实时运行情况，向虚拟电厂下达调节信号，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号；基于分配的调节信号，微电网以预测时域内包含调节偏差考核成本、分布式发电机组发电运行成本和储能系统运行成本在内的总运行成本最小化为目标，建立微电网实时能量滚动优化模型，得到分布式发电机组和储能系统的最优调度方案。本发明能显著提高微电网的能源效益，并能满足电网的实时调节需求。
权利要求书clms
1.一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，包括：考虑分布式发电机组、光伏系统和储能系统的运行特性，以日前总运行成本最小为目标，建立虚拟电厂日前调度模型，得到虚拟电厂的分时基准用电量和可调节容量；电网根据实时运行情况，向虚拟电厂下达调节信号，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号；基于分配的调节信号，微电网以预测时域内包含调节偏差考核成本、分布式发电机组发电运行成本和储能系统运行成本在内的总运行成本最小化为目标，建立微电网实时能量滚动优化模型，得到分布式发电机组和储能系统的最优调度方案；所述微电网实时能量滚动优化模型的目标函数为：；式中，为预测时域中的步长；/＞为调节偏差考核成本系数；/＞为时刻/＞的调节偏差；/＞和/＞分别为第/＞个微电网中分布式发电机组和储能系统的台数；为微电网第/＞个分布式发电机组在时刻/＞的发电成本；/＞为储能系统的成本系数；/＞为整个预测时域内第/＞个储能系统的使用情况；时刻的调节偏差/＞为：；式中，为第/＞个微电网中第/＞个分布式发电机组的发电功率；为第/＞个储能系统的充放电功率；/＞为光伏系统的出力预测；为第/＞个微电网在时刻/＞分配到的调节功率；/＞为用电负荷。2.根据权利要求1所述的一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，所述虚拟电厂日前调度模型的目标函数为：；式中，为时段/＞虚拟电厂从电网购电的价格；/＞为时段/＞虚拟电厂的基准用电量；/＞和/＞分别表示虚拟电厂中分布式发电机组和储能系统的总台数；/＞为第个分布式发电机组在时段/＞的运行成本；/＞为第/＞个储能系统运行日的总调用量；/＞为储能系统的成本系数。3.根据权利要求1所述的一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，所述分布式发电机组的运行特性为：；；式中，为第/＞个分布式发电机组在时段/＞的运行成本；/＞、/＞和/＞为第/＞个分布式发电机组的发电成本系数；/＞为第/＞个分布式发电机组在时段/＞的发电功率；和/＞分别为第/＞个分布式发电机组的发电功率上下限。4.根据权利要求1所述的一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，所述储能系统的运行特性为：；；；；；式中，为第/＞个储能系统运行日的总调用量；/＞为第/＞个储能系统在时段/＞的荷电状态；/＞为第/＞个储能系统初始荷电状态；/＞为第/＞个储能系统在时段/＞的充放电功率，/＞表示充电，/＞表示放电；/＞为储能系统的充放电成本系数；/＞为充放电功率；/＞为时段/＞的时间间隔；/＞为储能系统的容量；/＞和/＞分别为第/＞个储能系统充放电功率的上下限；/＞和分别为第/＞个储能系统荷电状态上下限。5.根据权利要求1所述的一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，所述虚拟电厂的分时基准用电量和可调节容量分别为：；；式中，为时段/＞虚拟电厂的基准用电量；/＞为虚拟电厂在时段/＞的总用电负荷；/＞为第/＞个分布式发电机组在时段/＞的发电功率；/＞为第/＞个储能系统在时段/＞的充放电功率；/＞为光伏系统发电功率预测；/＞和/＞分别表示虚拟电厂中分布式发电机组和储能系统的总台数；/＞为可调节容量；/＞为所有电器均开启时虚拟电厂的最大用电负荷；/＞为第/＞个储能系统充放电功率的上限。6.根据权利要求1所述的一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，所述电网根据实时运行情况，向虚拟电厂下达调节信号为：；式中，为时段/＞虚拟电厂的基准用电量；/＞为时刻/＞无量纲的调节信号；/＞为可调节容量；所述虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号的优化模型为：；；式中，为虚拟电厂中互联微电网的个数；/＞为第/＞个微电网在时刻分配到的调节功率；/＞为第/＞个微电网在时刻/＞的单位用电成本。7.根据权利要求6所述的一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，所述第个微电网在时刻/＞的单位用电成本/＞为：；；式中，为单个微电网从电网购电的固定价格；/＞为单个微电网自发电的单位成本；为时刻/＞的供需比；/＞为第/＞个微电网在时刻/＞的用电负荷。8.根据权利要求1所述的一种基于互联微电网的虚拟电厂参与辅助服务调控方法，其特征在于，所述微电网实时能量滚动优化模型的约束条件包括分布式发电机组的发电功率约束、爬坡约束以及储能系统的充放电功率约束和荷电状态约束。9.一种基于互联微电网的虚拟电厂参与辅助服务调控装置，其特征在于，该装置应用于权利要求1-8任一项所述的方法，所述装置包括：虚拟电厂日前调度模型建立模块，用于考虑分布式发电机组、光伏系统和储能系统的运行特性，以日前总运行成本最小为目标，建立虚拟电厂日前调度模型，得到虚拟电厂的分时基准用电量和可调节容量；微电网分配调节信号获取模块，用于电网根据实时运行情况，向虚拟电厂下达调节信号，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号；最优调度方案获取模块，用于基于分配的调节信号，微电网以预测时域内包含调节偏差考核成本、分布式发电机组发电运行成本和储能系统运行成本在内的总运行成本最小化为目标，建立微电网实时能量滚动优化模型，得到分布式发电机组和储能系统的最优调度方案。
说明书desc
技术领域本发明涉及电气工程技术领域，尤其涉及一种基于互联微电网的虚拟电厂参与辅助服务调控方法及装置。背景技术微电网是促进分布式新能源大规模接入和实现对负荷多种能源形式可靠供给的有效手段。然而，单个微电网中新能源发电的不确定性会增加其运行成本，且没有足够的容量为电网提供辅助服务获取经济效益。多个互联的微电网构成虚拟电厂，通过动态聚合和优化协调为电力系统提供辅助服务，能显著提高微电网的可靠性和能源效益。现有研究主要考虑多个微电网通过组成虚拟电厂进行集中式的能量管理和参与电能量市场，而忽略了基于互联微电网的虚拟电厂可为电力系统提供快速、灵活的辅助服务。未来，面对源侧新能源出力和荷侧用电需求的双重不确定性，电力系统对灵活性调节资源的需求将不断递增。因此，有必要考虑互联微电网组成的虚拟电厂通过参与辅助服务市场为电网提供灵活调节能力，并获取经济效益。发明内容本发明的目的是克服现有技术中存在的以上缺陷与问题，提供一种基于互联微电网的虚拟电厂参与辅助服务调控方法及装置，其目的在于解决现有基于互联微电网的虚拟电厂能量优化方法中忽略了为电网提供辅助服务的问题。为实现以上目的，本发明的技术解决方案是：一种基于互联微电网的虚拟电厂参与辅助服务调控方法，包括：考虑分布式发电机组、光伏系统和储能系统的运行特性，以日前总运行成本最小为目标，建立虚拟电厂日前调度模型，得到虚拟电厂的分时基准用电量和可调节容量；电网根据实时运行情况，向虚拟电厂下达调节信号，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号；基于分配的调节信号，微电网以预测时域内包含调节偏差考核成本、分布式发电机组发电运行成本和储能系统运行成本在内的总运行成本最小化为目标，建立微电网实时能量滚动优化模型，得到分布式发电机组和储能系统的最优调度方案。所述虚拟电厂日前调度模型的目标函数为：；式中，为时段/＞虚拟电厂从电网购电的价格；/＞为时段/＞虚拟电厂的基准用电量；/＞和/＞分别表示虚拟电厂中分布式发电机组和储能系统的总台数；/＞为第/＞个分布式发电机组在时段/＞的运行成本；/＞为第/＞个储能系统运行日的总调用量；为储能系统的成本系数。所述分布式发电机组的运行特性为：；；式中，、/＞和/＞为第/＞个分布式发电机组的发电成本系数；/＞为第/＞个分布式发电机组在时段/＞的发电功率；/＞和/＞分别为第/＞个分布式发电机组的发电功率上下限。所述储能系统的运行特性为：；；；；；式中，为第/＞个储能系统在时段/＞的荷电状态；/＞为第/＞个储能系统初始荷电状态；/＞为第/＞个储能系统在时段/＞的充放电功率，表示充电，/＞表示放电；/＞为储能系统的充放电成本系数；/＞为充放电功率；/＞为时段/＞的时间间隔；/＞为储能系统的容量；/＞和分别为第/＞个储能系统充放电功率的上下限；/＞和/＞分别为第/＞个储能系统荷电状态上下限。所述虚拟电厂的分时基准用电量和可调节容量分别为：；；式中，为虚拟电厂在时段/＞的总用电负荷；/＞为光伏系统发电功率预测；/＞为可调节容量；/＞为所有电器均开启时虚拟电厂的最大用电负荷。所述电网根据实时运行情况，向虚拟电厂下达调节信号为：；式中，为时刻/＞无量纲的调节信号；所述虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号的优化模型为：；；式中，为虚拟电厂中互联微电网的个数；/＞为第/＞个微电网在时刻/＞分配到的调节功率；/＞为第/＞个微电网在时刻/＞的单位用电成本。所述第个微电网在时刻/＞的单位用电成本/＞为：；；式中，为单个微电网从电网购电的固定价格；/＞为单个微电网自发电的单位成本；/＞为第/＞个微电网在时刻/＞的用电负荷；/＞为时刻的供需比。所述微电网实时能量滚动优化模型的目标函数为：；式中，为预测时域中的步长；/＞为调节偏差考核成本系数；/＞为时刻的调节偏差；/＞和/＞分别为第/＞个微电网中分布式发电机组和储能系统的台数；/＞为微电网第/＞个分布式发电机组在时刻/＞的发电成本；/＞为整个预测时域内第/＞个储能系统的使用情况；时刻的调节偏差/＞为：；式中，为第/＞个微电网中第/＞个分布式发电机组的发电功率；为第/＞个储能系统的充放电功率；/＞为光伏系统的出力预测；为用电负荷。所述微电网实时能量滚动优化模型的约束条件包括分布式发电机组的发电功率约束、爬坡约束以及储能系统的充放电功率约束和荷电状态约束。一种基于互联微电网的虚拟电厂参与辅助服务调控装置，该装置应用于上述所述的方法，所述装置包括：虚拟电厂日前调度模型建立模块，用于考虑分布式发电机组、光伏系统和储能系统的运行特性，以日前总运行成本最小为目标，建立虚拟电厂日前调度模型，得到虚拟电厂的分时基准用电量和可调节容量；微电网分配调节信号获取模块，用于电网根据实时运行情况，向虚拟电厂下达调节信号，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号；最优调度方案获取模块，用于基于分配的调节信号，微电网以预测时域内包含调节偏差考核成本、分布式发电机组发电运行成本和储能系统运行成本在内的总运行成本最小化为目标，建立微电网实时能量滚动优化模型，得到分布式发电机组和储能系统的最优调度方案。与现有技术相比，本发明的有益效果为：本发明一种基于互联微电网的虚拟电厂参与辅助服务调控方法及装置，能够通过日前和实时两阶段优化调控提高由多个互联微电网组成的虚拟电厂整体的能源效益，同时能为电网提供灵活、响应迅速的辅助服务，整个优化调控方法相较于现有技术更加完善、合理、接近实际。因此，本发明不仅能显著提高微电网的能源效益，而且能满足电网的实时调节需求。附图说明图1是本发明一种基于互联微电网的虚拟电厂参与辅助服务调控方法的流程图。图2是本发明的实施例中的基于互联微电网的虚拟电厂框架示意图。图3是本发明一种基于互联微电网的虚拟电厂参与辅助服务调控装置的结构框图。图4是本发明一种基于互联微电网的虚拟电厂参与辅助服务调控设备的结构框图。具体实施方式以下结合附图说明和具体实施方式对本发明作进一步详细的说明。参见图1，一种基于互联微电网的虚拟电厂参与辅助服务调控方法，包括：S1、考虑分布式发电机组、光伏系统和储能系统的运行特性，以日前总运行成本最小为目标，建立虚拟电厂日前调度模型，得到虚拟电厂的分时基准用电量和可调节容量。参见图2，多个互相连接的微电网构成一个虚拟电厂为电网提供辅助服务，其中每个微电网包含分布式发电机组、光伏系统、储能系统和负荷，虚拟电厂以总运行成本最小为目标进行所有可控资源的日前优化调度，调度模型的目标函数为：；式中，为时段/＞虚拟电厂从电网购电的价格；/＞为时段/＞虚拟电厂的基准用电量；/＞和/＞分别表示虚拟电厂中分布式发电机组和储能系统的总台数；/＞为第/＞个分布式发电机组在时段/＞的运行成本；/＞为第/＞个储能系统运行日的总调用量；为储能系统的成本系数。分布式发电机组的运行特性为：；；式中，、/＞和/＞为第/＞个分布式发电机组的发电成本系数；/＞为第/＞个分布式发电机组在时段/＞的发电功率；/＞和/＞分别为第/＞个分布式发电机组的发电功率上下限。采用循环神经网络模型对虚拟电厂中所有光伏系统总的分时发电功率进行预测，预测模型为：。储能系统的运行特性为：；；；；；式中，为第/＞个储能系统在时段/＞的荷电状态；/＞为第/＞个储能系统初始荷电状态；/＞为第/＞个储能系统在时段/＞的充放电功率，表示充电，/＞表示放电；/＞为储能系统的充放电成本系数；/＞为充放电功率；/＞为时段/＞的时间间隔；/＞为储能系统的容量；/＞和分别为第/＞个储能系统充放电功率的上下限；/＞和/＞分别为第/＞个储能系统荷电状态上下限。由功率平衡可得虚拟电厂的分时基准用电量为：；式中，为虚拟电厂在时段/＞的总用电负荷；/＞为第/＞个分布式发电机组在时段/＞的发电功率；/＞为第/＞个储能系统在时段/＞的充放电功率；/＞为光伏系统发电功率预测。根据分时基准用电量，虚拟电厂向上调节容量为，向下调节容量为/＞，于是虚拟电厂在时段/＞的调节容量为：；式中，为可调节容量；/＞为所有电器均开启时虚拟电厂的最大用电负荷。根据日前优化调度结果，虚拟电厂向电网上报其分时基准用电量和调节容量/＞。S2、电网根据实时运行情况，向虚拟电厂下达调节信号，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号。实时运行中，电网每5分钟向虚拟电厂下达一次调节信号，时段的调节信号为：；式中，为时刻/＞无量纲的调节信号；随后，虚拟电厂将该调节信号分解到每个微电网，若第个微电网分配到的调节功率为/＞，其用电负荷为/＞，则供需比/＞为：；通常微电网使用内部发电资源供电比从电网购电的成本更低，根据供需比，第/＞个微电网的单位用电价格为：；式中，为单个微电网从电网购电的固定价格；/＞为单个微电网自发电的单位成本。特别地，当/＞时，/＞，微电网的调节功率为0，用电成本为/＞；当时，/＞，微电网的用电负荷都由电网以价格/＞提供；当时，调节功率大于用电负荷，多余的电量由储能系统充电平衡。在时刻，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号的优化模型为：；；式中，为虚拟电厂中互联微电网的个数；/＞为第/＞个微电网在时刻/＞分配到的调节功率；/＞为第/＞个微电网在时刻/＞的单位用电成本。第个微电网在时刻/＞的单位用电成本/＞为：；；式中，为第/＞个微电网在时刻/＞的用电负荷；为时刻/＞的供需比。S3、基于分配的调节信号，微电网以预测时域内包含调节偏差考核成本、分布式发电机组发电运行成本和储能系统运行成本在内的总运行成本最小化为目标，建立微电网实时能量滚动优化模型，得到分布式发电机组和储能系统的最优调度方案。微电网在时刻接收到虚拟电厂分配的实时调节信号/＞后，先采用自回归滑动平均模型估计预测时域内分配到的调节信号和光伏系统的发电功率，然后进行实时滚动优化，第/＞个微电网在时刻/＞实时能量滚动优化模型的目标函数为：；式中，为预测时域中的步长；/＞为调节偏差考核成本系数；/＞为时刻的调节偏差；/＞和/＞分别为第/＞个微电网中分布式发电机组和储能系统的台数；/＞为微电网第/＞个分布式发电机组在时刻/＞的发电成本；/＞为整个预测时域内第/＞个储能系统的使用情况；时刻的调节偏差/＞为：；式中，为第/＞个微电网中第/＞个分布式发电机组的发电功率；为第/＞个储能系统的充放电功率；/＞为光伏系统的出力预测；为用电负荷。微电网实时能量滚动优化模型的约束条件包括分布式发电机组的发电功率约束、爬坡约束以及储能系统的充放电功率约束和荷电状态约束。第个微电网中第/＞个储能系统在整个预测时域内的运行和约束建模为：；；；；；式中，为第/＞个微电网中第/＞个储能系统在时刻/＞的荷电状态；为当前时刻初始的荷电状态；/＞为储能系统的容量；和/＞分别为第/＞个微电网中第/＞个储能系统充放电功率的上下限；和/＞分别为第/＞个储能系统荷电状态的上下限。第个微电网中第/＞个分布式发电机组在时刻/＞的发电成本和运行约束为：；；；式中，和/＞为第/＞个微电网中第/＞个分布式发电机组发电功率的上下限；/＞为每个时段最大向上向下爬坡能力占最大最小功率的百分比。参见图3，本发明还提供一种基于互联微电网的虚拟电厂参与辅助服务调控装置，该装置应用于上述基于互联微电网的虚拟电厂参与辅助服务调控方法，所述装置包括：虚拟电厂日前调度模型建立模块，用于考虑分布式发电机组、光伏系统和储能系统的运行特性，以日前总运行成本最小为目标，建立虚拟电厂日前调度模型，得到虚拟电厂的分时基准用电量和可调节容量；微电网分配调节信号获取模块，用于电网根据实时运行情况，向虚拟电厂下达调节信号，虚拟电厂以实时总用电成本最小化为目标向微电网分配调节信号；最优调度方案获取模块，用于基于分配的调节信号，微电网以预测时域内包含调节偏差考核成本、分布式发电机组发电运行成本和储能系统运行成本在内的总运行成本最小化为目标，建立微电网实时能量滚动优化模型，得到分布式发电机组和储能系统的最优调度方案。参见图4，本发明还提供一种基于互联微电网的虚拟电厂参与辅助服务调控设备，包括存储器和处理器；所述存储器，用于存储计算机程序代码，并将所述计算机程序代码传输给所述处理器；所述处理器，用于根据所述计算机程序代码中的指令执行上述基于互联微电网的虚拟电厂参与辅助服务调控方法。本发明还提供一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，所述计算机程序被处理器执行时实现基于互联微电网的虚拟电厂参与辅助服务调控方法。一般来说，用以实现本发明方法的计算机指令的可以采用一个或多个计算机可读的存储介质的任意组合来承载。非临时性计算机可读存储介质可以包括任何计算机可读介质，除了临时性地传播中的信号本身。计算机可读存储介质例如可以是，但不限于电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本发明中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。可以以一个或多个程序设计语言或其组合来编写用以执行本发明操作的计算机程序代码，所述程序设计语言包括面向对象的程序设计语言—诸如Java、Snalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言，特别是可以使用适于神经网络计算的Kython语言和基于TensorFlow、KyTorch等平台框架。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意个类的网络，包括局域网或广域网，连接到用户计算机，或连接到外部计算机。上述设备和非临时性计算机可读存储介质，可以参见对一种基于互联微电网的虚拟电厂参与辅助服务调控方法及有益效果的具体描述，在此不再赘述。尽管上面已经示出和描述了本发明的实施例，应当理解的是，上述实施例是示例性的，不能解释为对本发明的限制，本领域的普通技术人员在本发明的范围内可以对上述实施例进行变化、修改、替换和变型。
