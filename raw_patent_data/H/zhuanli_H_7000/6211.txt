标题title
基于主从博弈和改进Shapley值法的风光水火多源调频方法
摘要abst
本发明提供了一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，属于二次调频技术领域；解决了现有多源调频技术无法协调各机组调频容量和收益分配的问题；分析参与调频各机组的调频特性，构建策略需求曲线函数；构建多源调频系统的主从博弈结构模型；利用参与调频各机组的目标函数和约束条件，设置多源调频系统主从博弈模型参数；初始化参与调频各机组的功率分配方案，开始多源调频系统主从博弈过程；在多源调频系统中根据主从博弈理论优化分配调频容量，输出最佳决策集，完成对总调频指令的经济性调度；采用改进的Shapley值法对多源调频系统按照调频容量比例分配的调频收益进行优化；本发明应用于多源系统调频。
权利要求书clms
1.一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，其特征在于：包括如下步骤：步骤S1：分析参与调频各机组的调频特性，包括目标函数和约束条件，构建策略需求曲线函数；步骤S2：构建多源调频系统的主从博弈结构模型；步骤S3：利用步骤S1中得到的参与调频各机组的目标函数和约束条件，设置多源调频系统主从博弈模型参数；步骤S4：初始化参与调频各机组的功率分配方案，开始多源调频系统主从博弈过程；步骤S5：在多源调频系统中根据主从博弈理论优化分配调频容量，输出最佳决策集，完成对总调频指令的经济性调度；步骤S6：采用改进的Shapley值法对多源调频系统按照调频容量比例分配的调频收益进行优化，得到最优的调频收益分配策略。2.根据权利要求1所述的一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，其特征在于：所述步骤S1中，根据风光水火多源调频系统中各机组的调频特性以及主从博弈的基本结构，风光水机组在已知火电机组调频信息的前提下给出决策，得到主从博弈模型上下层间的策略需求曲线函数，其表达式如下：；上式中：为主从博弈模型上下层间的策略需求曲线函数；D1、D2为需求参数且D1＞0、D2＞0；/＞为火电机组在决策下的调频功率，T表示上层领导者火电机组；/＞为风光水机组i在对应策略下的调频功率，i表示下层跟随者的成员个数，NE表示下层跟随者风光水机组。3.根据权利要求2所述的一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，其特征在于：所述步骤S2中，选择火电机组作为上层领导者，风光水机组作为下层跟随者，其中上层领导者策略选择规则为：上层领导者通过申报调频容量引导下层跟随者进行调频容量申报从而保证自身调频收益最大；下层跟随者策略选择规则为：在已知上层领导者预申报调频容量的基础上，下层跟随者通过调整申报调频容量实现自身调频收益最大，并且根据自身申报信息构造出策略需求曲线函数返回至上层领导者；上层领导者基于下层跟随者更新的策略选择，重新更新自身策略。4.根据权利要求3所述的一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，其特征在于：所述步骤S3中参与调频各机组的目标函数和约束条件包括：步骤S3-1，确定火电机组的目标函数：火电机组的目标函数为：；上式中：为火电机组的调频收益；/＞为火电机组的调频单位成本费用；步骤S3-2，确定火电机组的约束条件：火电机组的约束条件为：；上式中：为火电机组在t时刻出力；/＞为火电机组在t时刻最大出力；/＞为火电机组在t时刻最小出力；/＞为火电机组申报的调频容量；/＞为t时刻风光水火多源调频系统所需负荷的调频容量；步骤S3-3，确定风光水机组的目标函数：风光水机组的目标函数为：；上式中：为风光水机组i的调频收益；/＞为风光水机组i的辅助调频单位成本费用；步骤S3-4，确定风光水机组的约束条件：风光水机组的约束条件为：；上式中：为风光水机组i在t时刻的出力；/＞为风光水机组i在t时刻的最大出力；为风光水机组i在t时刻的最小出力；/＞为风光水机组i申报的调频容量；将火电机组和风光水机组的目标函数和约束条件分别注入到主从博弈模型中，设置多源调频系统主从博弈模型参数。5.根据权利要求4所述的一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，其特征在于：所述步骤S4中初始化参与调频各机组的功率分配方案通过确定多源调频系统的功率平衡条件进行功率分配，多源调频系统的功率平衡条件根据以下方法确定：将需求曲线函数代入风光水机组的调频收益函数，在策略空间的范围内更新决策，从而得到更新决策后的调频容量，使风光水机组的调频收益函数更新为：；上式中：表示更新后的风光水机组i的调频收益，/＞表示更新后的风光水机组i的调频容量；则风光水火多源调频系统的功率平衡条件为：；上式中：表示t时刻火电机组最优调频容量，/＞表示t时刻风光水机组最优调频容量，/＞表示t时刻风光水火多源调频系统所需负荷的调频容量。6.根据权利要求5所述的一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，其特征在于：所述步骤S5利用步骤S4中得到的平衡条件，将风光水机组i基于主从博弈理论反复更新策略，直至达到最优调频容量，其表达式如下：；火电机组根据风光水机组更新后的最优调频容量更新自身决策，用更新后的决策替换初始决策得到最优调频容量为：。7.根据权利要求6所述的一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，其特征在于：所述步骤S6具体过程如下：在Shapley值理论基础上，引入如下指标：平均调频速度k1，响应时间k2和平均调频精度k3；平均调频速度k1为机组响应调度指令的速度与调频机组的调节速度之比，其表示形式为：；上式中：PS、PE分别为机组开始和结束响应过程时的出力，TS、TE分别为机组开始和结束的时刻；为所有调频机组调节速度的平均值；响应时间k2为调频机组的响应时间与调频指令响应时间之比，其表示形式为：；上式中：t为机组调频指令的响应时间，为所有调频机组响应时间平均值；平均调频精度k3为机组进入稳定阶段后，机组调频功率和目标指令的偏差，其计算公式为：；上式中：P1为调节目标，Pi为不同时间功率采样值，N为采样点个数；得到风电W、光伏Pv、水电机组H的如下指标：平均调频速度，响应时间，平均调频精度/＞；根据风电、光伏、水电机组的实际调频特性构造修正系数矩阵B和权重系数分别为：；；令K*为综合性能指标，则：；上式中：分别为风电、光伏和水电机组的综合性能指标；根据综合性能指标K*，得到改进Shapley值法优化后的风电、光伏、水电机组调频收益分别为：；上式中：分别为修正后的风电、光伏和水电机组收益；n为风光水火多源调频系统中的成员个数。
说明书desc
技术领域本发明提供了一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，属于二次调频技术领域。背景技术在“碳达峰”与“碳中和”的目标下，新能源机组装机容量日益增长。然而，新能源发电具有无法准确预测和波动性等特点，完全依赖新能源发电不利于电网的安全稳定运行。因此，风电、光伏、水电、火电共同参与的多源调频系统成为了解决问题的方法之一，多源调频系统具有可以在完成调频任务的同时最大程度的减少碳排放，保证电力系统的安全高效运行的巨大优势。现有的多源调频技术大都是仅考虑传统能源或新能源，并没有综合考虑新能源并网条件下不同类型机组的协调问题。一方面，在多源调频系统中，火电机组作为传统调频能源具有充足的可调容量和可调范围，能够满足电网最大的负荷增减变量需求。另一方面，风电、光伏、水电机组需要根据火电机组的调频容量来确定各自申报的调频容量，并且它们的申报结果又将影响火电机组的申报容量。此外，现有分配方法大多采用按调频容量比例进行分配，调频收益的分配也将影响各机组参与调频的积极性。发明内容为了克服现有技术的不足，本发明提出了一种基于主从博弈和改进Shapley值法的风光水火多源调频方法。为了解决上述技术问题，本发明采用的技术方案为：一种基于主从博弈和改进Shapley值法的风光水火多源调频方法，包括如下步骤：步骤S1：分析参与调频各机组的调频特性，包括目标函数和约束条件，构建策略需求曲线函数；步骤S2：构建多源调频系统的主从博弈结构模型；步骤S3：利用步骤S1中得到的参与调频各机组的目标函数和约束条件，设置多源调频系统主从博弈模型参数；步骤S4：初始化参与调频各机组的功率分配方案，开始多源调频系统主从博弈过程；步骤S5：在多源调频系统中根据主从博弈理论优化分配调频容量，输出最佳决策集，完成对总调频指令的经济性调度；步骤S6：采用改进的Shapley值法对多源调频系统按照调频容量比例分配的调频收益进行优化，得到最优的调频收益分配策略。所述步骤S1中，根据风光水火多源调频系统中各机组的调频特性以及主从博弈的基本结构，风光水机组在已知火电机组调频信息的前提下给出决策，得到主从博弈模型上下层间的策略需求曲线函数，其表达式如下：；上式中：为主从博弈模型上下层间的策略需求曲线函数；D1、D2为需求参数且D1＞0、D2＞0；/＞为火电机组在决策下的调频功率，T表示上层领导者火电机组；/＞为风光水机组i在对应策略下的调频功率，i表示下层跟随者的成员个数，NE表示下层跟随者风光水机组。所述步骤S2中，选择火电机组作为上层领导者，风光水机组作为下层跟随者，其中上层领导者策略选择规则为：上层领导者通过申报调频容量引导下层跟随者进行调频容量申报从而保证自身调频收益最大；下层跟随者策略选择规则为：在已知上层领导者预申报调频容量的基础上，下层跟随者通过调整申报调频容量实现自身调频收益最大，并且根据自身申报信息构造出策略需求曲线函数返回至上层领导者；上层领导者基于下层跟随者更新的策略选择，重新更新自身策略。所述步骤S3中参与调频各机组的目标函数和约束条件包括：步骤S3-1，确定火电机组的目标函数：火电机组的目标函数为：；上式中：为火电机组的调频收益；/＞为火电机组的调频单位成本费用；步骤S3-2，确定火电机组的约束条件：火电机组的约束条件为：；上式中：为火电机组在t时刻出力；/＞为火电机组在t时刻最大出力；/＞为火电机组在t时刻最小出力；/＞为火电机组申报的调频容量；/＞为t时刻风光水火多源调频系统所需负荷的调频容量；步骤S3-3，确定风光水机组的目标函数：风光水机组的目标函数为：；上式中：为风光水机组i的调频收益；/＞为风光水机组i的辅助调频单位成本费用；步骤S3-4，确定风光水机组的约束条件：风光水机组的约束条件为：；上式中：为风光水机组i在t时刻的出力；/＞为风光水机组i在t时刻的最大出力；/＞为风光水机组i在t时刻的最小出力；/＞为风光水机组i申报的调频容量；将火电机组和风光水机组的目标函数和约束条件分别注入到主从博弈模型中，设置多源调频系统主从博弈模型参数。所述步骤S4中初始化参与调频各机组的功率分配方案通过确定多源调频系统的功率平衡条件进行功率分配，多源调频系统的功率平衡条件根据以下方法确定：将需求曲线函数代入风光水机组的调频收益函数，在策略空间的范围内更新决策，从而得到更新决策后的调频容量，使风光水机组的调频收益函数更新为：；上式中：表示更新后的风光水机组i的调频收益，/＞表示更新后的风光水机组i的调频容量；则风光水火多源调频系统的功率平衡条件为：；上式中：表示t时刻火电机组最优调频容量，/＞表示t时刻风光水机组最优调频容量，/＞表示t时刻风光水火多源调频系统所需负荷的调频容量。所述步骤S5利用步骤S4中得到的平衡条件，将风光水机组i基于主从博弈理论反复更新策略，直至达到最优调频容量，其表达式如下：；火电机组根据风光水机组更新后的最优调频容量更新自身决策，用更新后的决策替换初始决策得到最优调频容量为：。所述步骤S6具体过程如下：在Shapley值理论基础上，引入如下指标：平均调频速度k1，响应时间k2和平均调频精度k3；平均调频速度k1为机组响应调度指令的速度与调频机组的调节速度之比，其表示形式为：；上式中：PS、PE分别为机组开始和结束响应过程时的出力，TS、TE分别为机组开始和结束的时刻；为所有调频机组调节速度的平均值；响应时间k2为调频机组的响应时间与调频指令响应时间之比，其表示形式为：；上式中：t为机组调频指令的响应时间，为所有调频机组响应时间平均值；平均调频精度k3为机组进入稳定阶段后，机组调频功率和目标指令的偏差，其计算公式为：；上式中：P1为调节目标，Pi为不同时间功率采样值，N为采样点个数；得到风电W、光伏Pv、水电机组H的如下指标：平均调频速度，响应时间，平均调频精度/＞；根据风电、光伏、水电机组的实际调频特性构造修正系数矩阵B和权重系数分别为：；；令K*为综合性能指标，则：；上式中：分别为风电、光伏和水电机组的综合性能指标；根据综合性能指标K*，得到改进Shapley值法优化后的风电、光伏、水电机组调频收益分别为：；上式中：分别为修正后的风电、光伏和水电机组收益；n为风光水火多源调频系统中的成员个数。本发明相对于现有技术具备的有益效果为：本发明主要应用主从博弈理论和改进的Shapley值法，使参与调频各机组的容量分配更加合理，同时也能够使风光水机组内部的调频收益分配更为均衡，有利于提高各机组参与电力系统调频的积极性与经济性。附图说明下面结合附图对本发明做进一步说明：图1是本发明中搭建的多源调频系统主从博弈结构模型图；图2是本发明中多源调频系统主从博弈模型求解流程图；图3-4是本发明实施例中主从博弈模型与优化前的调频容量分配对比图；图5-6是本发明实施例中应用主从博弈模型前后的调频收益分配对比图；图7是本发明实施例中采用改进Shapley值法的调频收益分配对比图。具体实施方式如图1至图7所示，为了更好的协调多源调频系统中各参与调频机组的调频容量配置和收益分配，本发明提出了一种基于主从博弈和改进Shapley值法的风光水火多源调频方法。首先对参与调频各机组的调频特性进行分析，然后搭建多源调频系统主从博弈模型，进而通过求解主从博弈均衡解得到参与调频各机组的调频容量分配，最后利用改进的Shapley值法对调频收益分配进行优化。在决策过程中，采用主从博弈和改进的Shapley法作为多源调频系统中的网络结构，提高了系统模型的决策能力。本发明方法包括以下步骤：步骤S1：分析参与调频各机组的调频特性，包括目标函数和约束条件，构建策略需求曲线函数；步骤S2：构建多源调频系统的主从博弈结构模型；步骤S3：利用步骤S1中得到的参与调频各机组的目标函数和约束条件，设置多源调频系统主从博弈模型参数；步骤S4：初始化参与调频各机组的功率分配方案，开始多源调频系统主从博弈过程；步骤S5：在多源调频系统中根据主从博弈理论优化分配调频容量，输出最佳决策集，完成对总调频指令的经济性调度；步骤S6：采用改进的Shapley值法对多源调频系统按照调频容量比例分配的调频收益进行优化，得到最优的调频收益分配策略；步骤S7：得出基于主从博弈和改进的Shapley值下参与调频各机组的调频容量和调频收益分配方法。作为本发明的进一步改进，步骤S1中，根据风光水火多源调频系统中各机组的调频特性以及主从博弈的基本结构，风光水机组在已知火电机组调频信息的前提下给出决策，得到主从博弈模型上下层间的策略需求曲线函数：其表达式如下：；上式中：为主从博弈模型上下层间的策略需求曲线函数；D1、D2为需求参数且D1＞0、D2＞0；/＞为火电机组在决策下的调频功率，T表示上层领导者火电机组；/＞为风光水机组i在对应策略下的调频功率，i表示下层跟随者的成员个数，NE表示下层跟随者风光水机组。作为本发明的进一步改进，步骤S2中，选择火电机组作为上层领导者，风光水机组作为下层跟随者。上层领导者策略选择规则为：上层领导者通过申报调频容量引导下层跟随者进行调频容量申报从而保证自身调频收益最大。下层跟随者策略选择规则为：在已知上层领导者预申报调频容量的基础上，下层跟随者通过调整申报调频容量实现自身调频收益最大，并且根据自身申报信息构造出策略需求曲线函数返回至上层领导者。进一步地，上层领导者基于下层跟随者更新的策略选择，重新更新自身策略。作为本发明的进一步改进，步骤S3中，利用步骤S1中得到的参与调频各机组的目标函数和约束条件如下：步骤S3-1，确定火电机组的目标函数：火电机组的目标函数为：；上式中：为火电机组的调频收益；/＞为火电机组的调频单位成本费用。步骤S3-2，确定火电机组的约束条件：火电机组的约束条件为：；上式中：为火电机组在t时刻出力；/＞为火电机组在t时刻最大出力；/＞为火电机组在t时刻最小出力；/＞为火电机组申报的调频容量；/＞为t时刻风光水火多源调频系统所需负荷的调频容量。步骤S3-3，确定风光水机组的目标函数：风光水机组的目标函数为：；上式中：为风光水机组i的调频收益；/＞为风光水机组i的辅助调频单位成本费用。步骤S3-4，确定风光水机组的约束条件：风光水机组的约束条件为：；上式中：为风光水机组i在t时刻的出力；/＞为风光水机组i在t时刻的最大出力；/＞为风光水机组i在t时刻的最小出力；/＞为风光水机组i申报的调频容量。将火电机组和风光水机组的目标函数和约束条件分别注入到主从博弈模型中，设置多源调频系统主从博弈模型参数。作为本发明的进一步改进，步骤S4中，多源调频系统的功率平衡条件根据以下方法确定：将需求曲线函数代入风光水机组的调频收益函数，在策略空间的范围内更新决策，从而得到更新决策后的调频容量，使风光水机组的调频收益函数更新为：；上式中：表示更新后的风光水机组i的调频收益，/＞表示更新后的风光水机组i的调频容量；则风光水火多源调频系统的功率平衡条件为：；上式中：表示t时刻火电机组最优调频容量，/＞表示t时刻风光水机组最优调频容量，/＞表示t时刻风光水火多源调频系统所需负荷的调频容量。作为本发明的进一步改进，步骤S5中，利用步骤S4中得到的平衡条件，将风光水机组i基于主从博弈理论反复更新策略，直至达到最优调频容量，其表达式如下：。与此同时，火电机组根据风光水机组更新的最优调频容量更新自身决策，用更新后的决策替换初始决策得到最优调频容量为：；以上分别为火电机组与风光水机组的最佳决策集。作为本发明的进一步改进，步骤S6中，在Shapley值理论基础上，引入如下指标：平均调频速度k1，响应时间k2和平均调频精度k3。平均调频速度k1为机组响应调度指令的速度与调频机组的调节速度之比，其表示形式为：；上式中：PS、PE分别为机组开始和结束响应过程时的出力，TS、TE分别为机组开始和结束的时刻；为所有调频机组调节速度的平均值。响应时间k2为调频机组的响应时间与调频指令响应时间之比，其表示形式为：；上式中：t为机组调频指令的响应时间，为所有调频机组响应时间平均值。平均调频精度k3为机组进入稳定阶段后，机组调频功率和目标指令的偏差，其计算公式为：；上式中：P1为调节目标，Pi为不同时间功率采样值，N为采样点个数。得到风电、光伏、水电机组的如下指标：平均调频速度，响应时间/＞，平均调频精度/＞。根据风电、光伏、水电机组的实际调频特性构造修正系数矩阵B和权重系数分别为：；。令K*为综合性能指标，则：；上式中：分别为风电、光伏和水电机组的综合性能指标。根据综合性能指标K*，得到改进Shapley值法优化后的风电、光伏、水电机组调频收益分别为：；上式中：分别为修正后的风电、光伏和水电机组收益；n为风光水火多源调频系统中的成员个数。下面根据具体实施例对本发明进行进一步说明。如图1所示，本实施例搭建多源调频系统主从博弈模型的步骤如下：步骤S1：分析参与调频各机组的调频特性。本实施例中，各类型电源的报价和调频性能指标参考中国中部某内陆地区各场站的数据，包括风光水火机组的调频信息：单位调频成本、平均调频速度、平均调频精度，其数据如下表1所示：表1。根据表1提供的数据可以得到参与调频各机组的如下相关信息如下：火电机组具有调频精度较高的优势，但是其调频成本也相对较高且调频速度较慢。风光水机组中风电机组和光伏机组具有调频速度和响应时间较快的优势，水电机组则具有调频成本较低的优势。步骤S2：根据参与调频各机组之间的相互作用关系，搭建多源调频系统的主从博弈结构模型；图2是本发明中多源调频系统主从博弈模型求解流程图。步骤S3：利用步骤S1中得到的参与调频各机组的目标函数和约束条件，设置多源调频系统主从博弈模型参数。步骤S4：初始化参与调频各机组的功率分配方案，开始多源调频系统主从博弈过程。步骤S5：在多源调频系统中根据主从博弈理论优化分配调频容量，输出最佳决策集，完成对总调频指令的经济性调度。在本实施例中，利用MATLABr2020a中的CPLEX求解器进行求解，通过设定最大迭代次数，得到多源调频系统主从博弈模型的均衡解即参与调频各机组的最优调频容量。步骤S6：采用改进的Shapley值法对多源调频系统按照调频容量比例分配的调频收益进行优化，得到最优的调频收益分配策略。在本实施例中，设置了不同场景下参与调频各机组调频容量分配方法进行对比分析，其场景划分如下：电网的总调节功率为100MW，使用表1中各场站1数据，各参与调频机组按照装机容量比例进行调频容量分配；电网的总调节功率为100MW，使用表1中各场站1数据，各参与调频机组按照文中提出的主从博弈模型进行调频容量分配；电网的总调节功率为100MW，使用表1中各场站2数据，参与调频各机组按照装机容量比例进行调频容量分配；电网的总调节功率为100MW，使用表1中各场站2数据，参与调频各机组按照文中提出的主从博弈模型进行调频容量分配。图3和4所示为本发明实施例中将场景与场景进行对比和将场景与场景进行对比得到的调频容量分配对比图。经过主从博弈后，火电机组、风电机组和光伏机组的调频容量增加，水电机组的调频容量下降，这与案例的实际情况相符合。由于地理位置导致中部地区降水量不稳定，因此按照本发明提出的方法所得到的调频容量分配能够在保证调频经济性和质量的同时兼顾调频系统整体的稳定性。图5和图6所示为本发明实施例中应用主从博弈模型前后的调频收益分配对比图。与按照装机容量比例进行调频容量分配相比，经过主从博弈后的火电机组与风光水机组调频收益均增加。由于风电机组和光伏机组相较于水电机组调频速度与调频精度更高，因此当风电机组和光伏机组调频容量增加时，风光水机组整体收益增加。应用主从博弈模型后，火机组1调频经济收益提高4.68%，火机组2调频经济收益提高2.97%；风1-光1-水机组调频经济收益提高13.71%，风2-光2-水机组调频经济收益提高5.08%。对于本实施例中的场景，由于风光水机组部分为主从博弈的跟随者，但是风光水机组内部属于合作关系，所以对风光水机组部分进行利益再分配时应用改进的Shapley值法进行优化。图7所示为本发明实施例中采用改进Shapley值法的调频收益分配对比图。改进的Shapley值法使风电机组1调频经济收益提高4.92%，光伏机组1调频经济收益减少7.54%，水电机组调频经济收益提高3.29%。这是由于应用改进Shapley值法进行调频收益分配时充分考虑了风电、光伏、水电的综合调频指标，对调频收益分配进行系数修正与调整，使得风光水机组内部调频收益分配更为合理和均衡。在本实施例中，相较于传统方法，采用主从博弈理论和改进Shapley值法的多源调频系统优化分配方法会使参与调频各机组的容量分配更加合理，风光水机组内部调频收益分配更为均衡，有利于最大限度实现新能源消纳，以及保证电网安全有效运行并提高各机组参与电力系统调频的积极性与经济性。最后应说明的是：以上各实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述各实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分或者全部技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的范围。
