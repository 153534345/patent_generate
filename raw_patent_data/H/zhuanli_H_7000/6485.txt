标题title
用于主业务系统的密钥动态切换方法、系统、装置及介质
摘要abst
本发明提出的一种用于主业务系统的密钥动态切换方法、系统、装置及介质，属于数据加密技术领域。所述方法包括：获取主业务系统升级后的新密钥；监听文件的打开事件；当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型；如果加密文件采用旧密钥加密，利用旧密钥对该文件进行解密；利用新密钥对解密后的文件进行重新加密。本发明能够在主业务系统中，使用内核重定向密钥文件的方式，完成加密文件的新旧密钥的转换操作，有效提高了系统升级的效率。
权利要求书clms
1.一种用于主业务系统的密钥动态切换方法，其特征在于，包括：获取主业务系统升级后的新密钥；监听文件的打开事件；当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型；如果加密文件采用旧密钥加密，利用旧密钥对该文件进行解密；利用新密钥对解密后的文件进行重新加密。2.根据权利要求1所述的用于主业务系统的密钥动态切换方法，其特征在于，所述在执行文件打开动作前识别文件是否为加密文件，包括：获取文件的存储路径；读取文件的文件头信息；根据文件头信息中的预设字段识别该文件是否为加密文件。3.根据权利要求2所述的用于主业务系统的密钥动态切换方法，其特征在于，所述利用新密钥识别加密文件的密钥类型，包括：利用新密钥解析加密文件；如果解析成功，加密文件采用新密钥加密；如果解析失败，加密文件采用旧密钥加密。4.根据权利要求3所述的用于主业务系统的密钥动态切换方法，其特征在于，所述利用旧密钥对该文件进行解密，包括：获取旧密钥文件的存储路径；根据所述存储路径读取旧密钥文件；利用旧密钥对加密文件进行解密。5.根据权利要求2所述的用于主业务系统的密钥动态切换方法，其特征在于，所述根据文件头信息中的预设字段识别该文件是否为加密文件，包括：在文件头信息中识别出Extraarea区域位置；读取Extraarea区域位置的值；如果Extraarea区域位置的值符合加密文件规则，则该文件为加密文件。6.根据权利要求1所述的用于主业务系统的密钥动态切换方法，其特征在于，所述方法还包括：响应于终端发出的密钥动态切换请求；读取终端的文件，并识别出终端上所有采用旧密钥的加密文件；利用旧密钥对采用旧密钥的加密文件进行批量解密；利用新密钥对解密后的文件进行批量加密。7.根据权利要求6所述的用于主业务系统的密钥动态切换方法，其特征在于，所述识别出终端上所有采用旧密钥的加密文件，包括：启动文件检索功能，将终端内的加密文件通过列表的方式展示出来，并将采用旧密钥的加密文件进行标识。8.一种用于主业务系统的密钥动态切换系统，其特征在于，系统采用如权利要求1至7任一项权利要求所述的用于主业务系统的密钥动态切换方法，所述系统包括：密钥获取模块，配置用于获取主业务系统升级后的新密钥；监听模块，配置用于监听文件的打开事件；文件识别模块，配置用于当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型；密钥转换模块，配置用于利用旧密钥对该文件进行解密，并利用新密钥对解密后的文件进行重新加密。9.一种用于主业务系统的密钥动态切换装置，其特征在于，包括：存储器，用于存储用于主业务系统的密钥动态切换程序；处理器，用于执行所述用于主业务系统的密钥动态切换程序时实现如权利要求1至7任一项权利要求所述的用于主业务系统的密钥动态切换方法的步骤。10.一种可读存储介质，其特征在于：所述可读存储介质上存储有用于主业务系统的密钥动态切换程序，所述用于主业务系统的密钥动态切换程序被处理器执行时实现如权利要求1至7任一项权利要求所述的用于主业务系统的密钥动态切换方法的步骤。
说明书desc
技术领域本发明涉及数据加密技术领域，更具体的说是涉及一种用于主业务系统的密钥动态切换方法、系统、装置及介质。背景技术业务系统是指为了支持企业的日常运营活动而开发的软件系统，它通过自动化和集成不同的业务流程和功能模块，提供高效、准确的业务处理和数据管理。业务系统可以根据企业的需求定制开发，也可以选择现成的商业软件进行部署和使用。当前，主业务系统由于存在大量密钥加密的文件，在完成系统升级后，由于系统采用了新的密钥，会产生系统无法识别之前加密的文件的问题。为了避免此类问题，需要在系统升级之前，挨个将文件进行签出操作，将加密文件改为用公共密钥进行加密。可见，现有技术在进行主业务系统升级时，存在以下缺陷：1、为了避免历史文件出现无法识别的问题，必须先对终端的文件进行处理，才能进行升级，导致系统升级的前期准备工作较多。2、签出文件步骤复杂，且每次只能对单个文件进行签出，如果当前主业务系统的加密文件数量较多，会极大的影响系统升级的效率。发明内容针对以上问题，本发明的目的在于提供一种用于主业务系统的密钥动态切换方法，能够在主业务系统中，使用内核重定向密钥文件的方式，完成加密文件的新旧密钥的转换操作，有效提高了系统升级的效率。本发明为实现上述目的，通过以下技术方案实现：一种用于主业务系统的密钥动态切换方法，包括：获取主业务系统升级后的新密钥；监听文件的打开事件；当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型；如果加密文件采用旧密钥加密，利用旧密钥对该文件进行解密；利用新密钥对解密后的文件进行重新加密。进一步，在执行文件打开动作前识别文件是否为加密文件，包括：获取文件的存储路径；读取文件的文件头信息；根据文件头信息中的预设字段识别该文件是否为加密文件。进一步，利用新密钥识别加密文件的密钥类型，包括：利用新密钥解析加密文件；如果解析成功，加密文件采用新密钥加密；如果解析失败，加密文件采用旧密钥加密。进一步，利用旧密钥对该文件进行解密，包括：获取旧密钥文件的存储路径；根据所述存储路径读取旧密钥文件；利用旧密钥对加密文件进行解密。进一步，根据文件头信息中的预设字段识别该文件是否为加密文件，包括：读取文件头的固定长度信息；对头部信息进行解密，解析的数据如果符合加密文件规则，则为加密文件。进一步，所述方法还包括：响应于终端发出的密钥动态切换请求；读取终端的文件，并识别出终端上所有采用旧密钥的加密文件；利用旧密钥对采用旧密钥的加密文件进行批量解密；利用新密钥对解密后的文件进行批量加密。进一步，识别出终端上所有采用旧密钥的加密文件，包括：启动文件检索功能，将终端内的加密文件通过列表的方式展示出来，并将采用旧密钥的加密文件进行标识。相应的，本发明还公开了一种用于主业务系统的密钥动态切换系统，包括：密钥获取模块，配置用于获取主业务系统升级后的新密钥；监听模块，配置用于监听文件的打开事件；文件识别模块，配置用于当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型；密钥转换模块，配置用于利用旧密钥对该文件进行解密，并利用新密钥对解密后的文件进行重新加密。相应的，本发明公开了一种用于主业务系统的密钥动态切换装置，包括：存储器，用于存储用于主业务系统的密钥动态切换程序；处理器，用于执行所述用于主业务系统的密钥动态切换程序时实现如上文任一项所述用于主业务系统的密钥动态切换方法的步骤。相应的，本发明公开了一种可读存储介质，所述可读存储介质上存储有用于主业务系统的密钥动态切换程序，所述用于主业务系统的密钥动态切换程序被处理器执行时实现如上文任一项所述用于主业务系统的密钥动态切换方法的步骤。对比现有技术，本发明有益效果在于：本发明公开了一种用于主业务系统的密钥动态切换方法、系统、装置及介质，能够在主任务系统中，在用户无感的情况下，使用内核重定向密钥文件的方式，完成新旧密钥的转换操作。并且提供了一种批量转换的方式，可一次性的完成对终端所有旧密钥文件的转换工作。由此可见，本发明与现有技术相比，具有突出的实质性特点和显著的进步，其实施的有益效果也是显而易见的。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图获得其他的附图。图1是本发明实施例一的方法流程图。图2是本发明实施例二的方法流程图。图3是本发明实施例三的系统结构图。图中，1、密钥获取模块；2、监听模块；3、文件识别模块；4、密钥转换模块；5、批量识别模块。具体实施方式为了使本技术领域的人员更好地理解本发明方案，下面结合附图和具体实施方式对本发明作进一步的详细说明。显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。实施例一：如图1所示，本实施例提供了一种用于主业务系统的密钥动态切换方法，包括如下步骤：S101：获取主业务系统升级后的新密钥。在具体实施方式中，根据新版本主业务系统的升级文件，获取新系统采用的新密钥文件，并将该文件存储到当前主业务系统的预设路径下。S102：监听文件的打开事件。在具体实施方式中，可采用脚本或预设的监听工具，配置文件的监听路径，并创建监听文件打开事件，以实时监听文件的打开操作。S103：当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件。在具体实施方式中，当监听到文件的打开命令时，在执行文件打开动作前先获取该文件的存储路径。根据其存储路径获取文件并读取文件的文件头信息。然后，在文件头信息中识别出Extraarea区域位置，并读取Extraarea区域位置的值；如果Extraarea区域位置的值为0x01，则该文件为加密文件。S104：如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型。在具体实施方式中，当待打开的文件为加密文件时，首先利用新密钥解析加密文件；如果解析成功，加密文件采用新密钥加密；如果解析失败，加密文件采用旧密钥加密。需要特别说明的是，本步骤的目的在于利用密钥尝试进行文件解析，以确定该文件当前采用的密钥。因此，也可以用旧密钥进行解析尝试，如果旧密钥可以解析成功，则该文件采用旧密钥加密。S105：如果加密文件采用旧密钥加密，利用旧密钥对该文件进行解密。在具体实施方式中，首先获取旧密钥文件的存储路径。然后根据所述存储路径读取旧密钥文件。最后，利用旧密钥对加密文件进行解密，生成文件的明文。S106：利用新密钥对解密后的文件进行重新加密。在具体实施方式中，直接利用新密钥文件对文件的明文进行加密。实施例二：基于实施例一，如图2所示，本发明还公开了一种用于主业务系统的密钥动态切换方法，本方法主要适用于外置终端存在大量文件，且终端内的文件需要进行密钥的批量转换时。本方法具体包括如下步骤：S201：响应于终端发出的密钥动态切换请求。S202：读取终端的文件，并识别出终端上所有采用旧密钥的加密文件。作为示例的，直接在主业务系统中启动文件检索功能，检索出加密文件，将终端内的加密文件通过列表的方式展示出来，并将采用旧密钥的加密文件进行标识。S203：利用旧密钥对采用旧密钥的加密文件进行批量解密；S204：利用新密钥对解密后的文件进行批量加密。实施例三：基于上述实施例，如图3所示，本发明还公开了一种用于主业务系统的密钥动态切换系统，包括：密钥获取模块1、监听模块2、文件识别模块3、密钥转换模块4和批量识别模块5。密钥获取模块1，配置用于获取主业务系统升级后的新密钥；监听模块2，配置用于监听文件的打开事件；文件识别模块3，配置用于当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型。在具体实施方式中，文件识别模块3具体用于：获取文件的存储路径；读取文件的文件头信息；根据文件头信息中的预设字段识别该文件是否为加密文件。利用新密钥解析加密文件；如果解析成功，加密文件采用新密钥加密；如果解析失败，加密文件采用旧密钥加密。密钥转换模块4，配置用于利用旧密钥对该文件进行解密，并利用新密钥对解密后的文件进行重新加密。在具体实施方式中，密钥转换模块4具体用于：获取旧密钥文件的存储路径；根据所述存储路径读取旧密钥文件；利用旧密钥对加密文件进行解密。批量识别模块5，配置用于响应于终端发出的密钥动态切换请求，读取终端的文件，并识别出终端上所有采用旧密钥的加密文件。在具体实施方式中，批量识别模块5具体用于：启动文件检索功能，将终端内的加密文件通过列表的方式展示出来，并将采用旧密钥的加密文件进行标识。实施例四：本实施例公开了一种用于主业务系统的密钥动态切换装置，包括处理器和存储器；其中，所述处理器执行所述存储器中保存的用于主业务系统的密钥动态切换程序时可以实现：获取主业务系统升级后的新密钥；监听文件的打开事件；当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型；如果加密文件采用旧密钥加密，利用旧密钥对该文件进行解密；利用新密钥对解密后的文件进行重新加密；响应于终端发出的密钥动态切换请求；读取终端的文件，并识别出终端上所有采用旧密钥的加密文件。进一步的，本实施例中的用于主业务系统的密钥动态切换装置，还可以包括：输入接口，用于获取外界导入的用于主业务系统的密钥动态切换程序，并将获取到的用于主业务系统的密钥动态切换程序保存至所述存储器中，还可以用于获取外界终端设备传输的各种指令和参数，并传输至处理器中，以便处理器利用上述各种指令和参数展开相应的处理。本实施例中，所述输入接口具体可以包括但不限于USB接口、串行接口、语音输入接口、指纹输入接口、硬盘读取接口等。输出接口，用于将处理器产生的各种数据输出至与其相连的终端设备，以便于与输出接口相连的其他终端设备能够获取到处理器产生的各种数据。本实施例中，所述输出接口具体可以包括但不限于USB接口、串行接口等。通讯单元，用于在用于主业务系统的密钥动态切换装置和外部服务器之间建立远程通讯连接，以便于用于主业务系统的密钥动态切换装置能够将镜像文件挂载到外部服务器中。本实施例中，通讯单元具体可以包括但不限于基于无线通讯技术或有线通讯技术的远程通讯单元。键盘，用于获取用户通过实时敲击键帽而输入的各种参数数据或指令。显示器，用于运行用于主业务系统的密钥动态切换过程的相关信息进行实时显示。鼠标，可以用于协助用户输入数据并简化用户的操作。实施例五：本实施例还公开了一种可读存储介质，这里所说的可读存储介质包括随机存储器、内存、只读存储器、电可编程ROM、电可擦除可编程ROM、寄存器、硬盘、可移动硬盘、CD-ROM或技术领域内所公知的任意其他形式的存储介质。可读存储介质中存储有用于主业务系统的密钥动态切换程序，所述用于主业务系统的密钥动态切换程序被处理器执行时可以实现：获取主业务系统升级后的新密钥；监听文件的打开事件；当监听到文件的打开命令时，在执行文件打开动作前识别文件是否为加密文件；如果待打开的文件为加密文件，利用新密钥识别加密文件的密钥类型；如果加密文件采用旧密钥加密，利用旧密钥对该文件进行解密；利用新密钥对解密后的文件进行重新加密；响应于终端发出的密钥动态切换请求；读取终端的文件，并识别出终端上所有采用旧密钥的加密文件。综上所述，本发明能够在主业务系统中，使用内核重定向密钥文件的方式，完成加密文件的新旧密钥的转换操作，有效提高了系统升级的效率。本说明书中各个实施例采用递进的方式描述，每个实施例重点说明的都是与其它实施例的不同之处，各个实施例之间相同或相似部分互相参见即可。对于实施例公开的方法而言，由于其与实施例公开的系统相对应，所以描述的比较简单，相关之处参见方法部分说明即可。专业人员还可以进一步意识到，结合本文中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、计算机软件或者二者的结合来实现，为了清楚地说明硬件和软件的可互换性，在上述说明中已经按照功能一般性地描述了各示例的组成及步骤。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本发明的范围。在本发明所提供的几个实施例中，应该理解到，所揭露的系统、系统和方法，可以通过其它的方式实现。例如，以上所描述的系统实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，系统或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能模块可以集成在一个处理单元中，也可以是各个模块单独物理存在，也可以两个或两个以上模块集成在一个单元中。同理，在本发明各个实施例中的各处理单元可以集成在一个功能模块中，也可以是各个处理单元物理存在，也可以两个或两个以上处理单元集成在一个功能模块中。结合本文中所公开的实施例描述的方法或算法的步骤可以直接用硬件、处理器执行的软件模块，或者二者的结合来实施。软件模块可以置于随机存储器、内存、只读存储器、电可编程ROM、电可擦除可编程ROM、寄存器、硬盘、可移动磁盘、CD-ROM、或技术领域内所公知的任意其它形式的存储介质中。最后，还需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。以上对本发明所提供的用于主业务系统的密钥动态切换方法、系统、装置及可读存储介质进行了详细介绍。本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想。应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以对本发明进行若干改进和修饰，这些改进和修饰也落入本发明权利要求的保护范围内。
