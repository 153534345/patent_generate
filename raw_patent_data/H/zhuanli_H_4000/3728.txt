标题title
用于加密通话的方法及装置、存储介质及电子设备
摘要abst
本公开提供了一种用于加密通话的方法、装置、电子设备及存储介质，该方法包括：在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和密钥标识信息；向被叫方终端发送携带主叫方终端所支持的第一加密算法集合和密钥标识信息的更新参数请求消息；接收被叫方终端响应于更新参数请求消息返回的携带会话密钥同步成功的指示信息和目标加密算法的更新参数应答消息；对更新参数应答消息进行解析，确定会话密钥同步成功以及获得目标加密算法，进而基于目标加密算法和会话密钥与被叫方终端进行加密通话。该方法可以通过在呼叫信令中携带相关信息以实现对终端能力、状态和密钥协商信息的判断，确保VoLTE终端正常呼叫、接续和通话。
权利要求书clms
1.一种用于加密通话的方法，其特征在于，应用于主叫方终端，包括：在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和相应的密钥标识信息；向被叫方终端发送携带第一通话加密信息的更新参数请求消息；其中，所述第一通话加密信息包括：所述主叫方终端所支持的第一加密算法集合和所述密钥标识信息；接收所述被叫方终端响应于所述更新参数请求消息返回的携带第二通话加密信息的更新参数应答消息；其中，所述第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法；对所述更新参数应答消息进行解析，确定会话密钥同步成功以及获得所述目标加密算法，进而基于所述目标加密算法和所述会话密钥与所述被叫方终端进行加密通话。2.根据权利要求1所述的方法，其特征在于，所述通话加密条件包括：所述主叫方与被叫方均已签约语音加密业务，所述主叫方终端与所述被叫方终端均处于指定驻网状态，以及所述主叫方终端与所述被叫方终端均支持密话功能；所述方法还包括按照如下方法确定所述主叫方与所述被叫方满足所述通话加密条件：在所述主叫方终端处于指定驻网状态且支持密话功能的情况下，向应用服务器发送携带第一指示信息的呼叫请求消息，以使所述应用服务器在确定主叫方与被叫方满足第一条件的情况下将所述呼叫请求消息转发至所述被叫方终端；其中，所述第一指示信息包括：所述主叫方终端支持密话功能；所述第一条件包括：所述主叫方与所述被叫方均已签约语音加密业务，以及所述被叫方终端处于指定驻网状态；接收所述被叫方终端响应于所述呼叫请求消息返回的呼叫应答消息，并对所述呼叫应答消息进行解析；在解析所述呼叫应答消息获得第二指示信息的情况下，确定所述主叫方与所述被叫方满足通话加密条件；其中，所述第二指示信息包括：所述被叫方终端支持密话功能。3.根据权利要求1或2所述的方法，其特征在于，向密钥服务器申请获得会话密钥和相应的密钥标识信息，包括：向所述密钥服务器发送携带呼叫信息的主叫会话密钥申请，以使所述密钥服务器基于所述呼叫信息对所述主叫方进行第一认证鉴权；其中，所述呼叫信息包括：主叫方码号、被叫方码号和会话标识；接收所述密钥服务器在确定所述第一认证鉴权通过后返回的所述会话密钥和所述密钥标识信息。4.一种用于加密通话的方法，其特征在于，应用于被叫方终端，包括：接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息；其中，所述更新参数请求消息是所述主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；所述第一通话加密信息包括：所述主叫方终端所支持的第一加密算法集合和密钥标识信息；响应于所述更新参数请求消息从密钥服务器获取会话密钥，以确定会话密钥同步成功，并基于所述更新参数请求消息确定目标加密算法；其中，所述会话密钥是所述主叫方终端向所述密钥服务器申请后存储于所述密钥服务器上的；向所述主叫方终端发送携带第二通话加密信息的更新参数应答消息；其中，所述第二通话加密信息包括：会话密钥同步成功的指示信息和所述目标加密算法。5.根据权利要求4所述的方法，其特征在于，在接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息之前，所述方法还包括：接收应用服务器在确定主叫方与被叫方满足第一条件的情况下转发的携带第一指示信息的呼叫请求消息；其中，所述呼叫请求消息是由所述主叫方终端发送的，所述第一指示信息包括：所述主叫方终端支持密话功能；所述第一条件包括：所述主叫方与被叫方均已签约语音加密业务，以及所述被叫方终端处于指定驻网状态；解析所述呼叫请求消息，响应于解析获得的所述第一指示信息，查询所述被叫方终端是否支持密话功能；在确定所述被叫方终端支持密话功能的情况下，向所述主叫方终端发送携带第二指示信息的呼叫应答消息；其中，所述第二指示信息包括：所述被叫方终端支持密话功能。6.根据权利要求4或5所述的方法，其特征在于，响应于所述更新参数请求消息从密钥服务器获取会话密钥，包括：解析所述更新参数请求消息，获得所述主叫方终端所支持的所述第一加密算法集合和所述密钥标识信息；向所述密钥服务器发送携带呼叫信息和所述密钥标识信息的被叫会话密钥申请，以使所述密钥服务器基于所述呼叫信息对被叫方进行第二认证鉴权；其中，所述呼叫信息包括：主叫方码号、被叫方码号和会话标识；接收所述密钥服务器在确定所述第二认证鉴权通过后基于所述密钥标识信息返回的所述会话密钥。7.根据权利要求6所述的方法，其特征在于，基于所述更新参数请求消息确定目标加密算法，包括：查询所述被叫方终端所支持的第二加密算法集合；基于所述第一加密算法集合和所述第二加密算法集合确定目标加密算法。8.一种用于加密通话的方法，其特征在于，应用于应用服务器，包括：接收主叫方终端发送的携带第一指示信息的呼叫请求消息；其中，所述呼叫请求消息是所述主叫方终端在确认所述主叫方终端处于指定驻网状态且支持密话功能的情况下发送的，所述第一指示信息包括：所述主叫方终端支持密话功能；查询主叫方与被叫方是否满足第一条件；所述第一条件包括：所述主叫方与所述被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；在确定所述主叫方与所述被叫方满足第一条件的情况下，将携带所述第一指示信息的所述呼叫请求消息转发至所述被叫方终端。9.根据权利要求8所述的方法，其特征在于，查询主叫方与被叫方是否满足第一条件，包括：向统一数据管理网元UDM和/或归属用户服务器HSS进行查询，获得所述主叫方与所述被叫方的用户签约数据，以及获得所述被叫方终端的当前驻网情况；根据所述用户签约数据判断所述主叫方与所述被叫方是否签约所述语音加密业务，以及根据所述当前驻网情况判断所述被叫方终端是否处于指定驻网状态；其中，处于指定驻网状态包括：驻网在4G网络或5G网络上。10.根据权利要求8所述的方法，其特征在于，还包括：在确定所述主叫方与所述被叫方不满足第一条件的情况下，去除所述呼叫请求消息中的所述第一指示信息，以获得普通呼叫请求消息；将所述普通呼叫请求消息转发至所述被叫方终端。11.一种用于加密通话的方法，其特征在于，应用于密钥服务器，包括：响应于主叫方终端发送的主叫会话密钥申请，向所述主叫方终端发送会话密钥和相应的密钥标识信息；其中，所述主叫会话密钥申请是所述主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；以及，响应于被叫方终端发送的携带所述密钥标识信息的被叫会话密钥申请，向所述被叫方终端发送与所述密钥标识信息对应的所述会话密钥；其中，所述被叫会话密钥申请是所述被叫方终端响应于所述主叫方终端发送的更新参数请求消息发送的。12.根据权利要求11所述的方法，其特征在于，响应于主叫方终端发送的主叫会话密钥申请，向所述主叫方终端发送会话密钥和相应的密钥标识信息，包括：接收主叫方终端发送的携带呼叫信息的主叫会话密钥申请；其中，所述呼叫信息包括：主叫方码号、被叫方码号和会话标识；基于所述呼叫信息对主叫方进行第一认证鉴权；在确定所述第一认证鉴权通过后，生成并存储会话密钥和相应的密钥标识信息；向所述主叫方终端发送所述会话密钥和所述密钥标识信息。13.根据权利要求11所述的方法，其特征在于，响应于被叫方终端发送的携带所述密钥标识信息的被叫会话密钥申请，向所述被叫方终端发送与所述密钥标识信息对应的所述会话密钥，包括：接收被叫方终端发送的携带呼叫信息和所述密钥标识信息的被叫会话密钥申请；其中，所述呼叫信息包括：主叫方码号、被叫方码号和会话标识；基于所述呼叫信息对被叫方进行第二认证鉴权；在确定所述第二认证鉴权通过后，确定与所述密钥标识信息对应的所述会话密钥；向所述被叫方终端发送所述会话密钥。14.一种用于加密通话的装置，其特征在于，应用于主叫方终端，包括：第一密钥获取模块，用于在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和相应的密钥标识信息；第一发送模块，用于向被叫方终端发送携带第一通话加密信息的更新参数请求消息；其中，所述第一通话加密信息包括：所述主叫方终端所支持的第一加密算法集合和所述密钥标识信息；第一接收模块，用于接收所述被叫方终端响应于所述更新参数请求消息返回的携带第二通话加密信息的更新参数应答消息；其中，所述第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法；解析模块，用于对所述更新参数应答消息进行解析，确定会话密钥同步成功以及获得所述目标加密算法，进而基于所述目标加密算法和所述会话密钥与所述被叫方终端进行加密通话。15.一种用于加密通话的装置，其特征在于，应用于被叫方终端，包括：第二接收模块，用于接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息；其中，所述更新参数请求消息是所述主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；所述第一通话加密信息包括：所述主叫方终端所支持的第一加密算法集合和密钥标识信息；第二密钥获取模块，用于响应于所述更新参数请求消息从密钥服务器获取会话密钥，以确定会话密钥同步成功，并基于所述更新参数请求消息确定目标加密算法；其中，所述会话密钥是所述主叫方终端向所述密钥服务器申请后存储于所述密钥服务器上的；第二发送模块，用于向所述主叫方终端发送携带第二通话加密信息的更新参数应答消息；其中，所述第二通话加密信息包括：会话密钥同步成功的指示信息和所述目标加密算法。16.一种用于加密通话的装置，其特征在于，应用于应用服务器，包括：第三接收模块，用于接收主叫方终端发送的携带第一指示信息的呼叫请求消息；其中，所述呼叫请求消息是所述主叫方终端在确认所述主叫方终端处于指定驻网状态且支持密话功能的情况下发送的，所述第一指示信息包括：所述主叫方终端支持密话功能；查询模块，用于查询主叫方与被叫方是否满足第一条件；所述第一条件包括：所述主叫方与所述被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；第三发送模块，用于在确定所述主叫方与所述被叫方满足第一条件的情况下，将携带所述第一指示信息的所述呼叫请求消息转发至所述被叫方终端。17.一种用于加密通话的装置，其特征在于，应用于密钥服务器，包括：第四发送模块，用于响应于主叫方终端发送的主叫会话密钥申请，向所述主叫方终端发送会话密钥和相应的密钥标识信息；其中，所述主叫会话密钥申请是所述主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；以及，所述第四发送模块还用于响应于被叫方终端发送的携带所述密钥标识信息的被叫会话密钥申请，向所述被叫方终端发送与所述密钥标识信息对应的所述会话密钥；其中，所述被叫会话密钥申请是所述被叫方终端响应于所述主叫方终端发送的更新参数请求消息发送的。18.一种用于加密通话的系统，其特征在于，所述系统包括：主叫方终端、被叫方终端、应用服务器以及密钥服务器；主叫方终端，被配置为执行如权利要求1至3任一项所述的用于加密通话的方法；被叫方终端，被配置为执行如权利要求4至7任一项所述的用于加密通话的方法；应用服务器，被配置为执行如权利要求8至10任一项所述的用于加密通话的方法；密钥服务器，被配置为执行如权利要求11至13任一项所述的用于加密通话的方法。19.一种计算机可读存储介质，其上存储有计算机程序，所述程序被处理器执行时实现如权利要求1至13任一项所述的用于加密通话的方法。20.一种电子设备，其特征在于，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现如权利要求1至13任一项所述的用于加密通话的方法。
说明书desc
技术领域本公开涉及移动通信技术领域，尤其涉及一种用于加密通话的方法及装置、存储介质及电子设备。背景技术VoLTE是一个高速无线通信标准。其可以基于IMS网络使语音数据在LTE数据承载网络中传输。在VoLTE提供语音数据传输服务的同时，如何确保VoLTE语音数据传输的安全，是急需解决的问题。常见的VoLTE语音密话技术方案有以下两种：在IMS呼叫信令中携带密钥协商信息。在呼叫接通后，利用用户面媒体流进行密钥协商。如果协商成功，进入密话状态；如果协商失败，则继续保持明话。在相关技术中，方案中存在主叫无法确定被叫终端是否支持VoLTE语音加密业务，且呼叫时主叫无法确定被叫终端是否驻网在4G/5G网络的问题。方案中存在保密通信延迟的问题，而且发起密钥协商的一方无法确定对方终端是否驻网在4G/5G网络。需要说明的是，在上述背景技术部分公开的信息仅用于加强对本公开的背景的理解，因此可以包括不构成对本领域普通技术人员已知的现有技术的信息。发明内容本公开的目的在于提供一种用于加密通话的方法、装置、电子设备及存储介质，至少在一定程度上克服相关技术中呼叫时无法确定被叫终端状态、保密通信延迟的问题。本公开的其他特性和优点将通过下面的详细描述变得显然，或部分地通过本公开的实践而习得。根据本公开的一个方面，提供一种用于加密通话的方法，应用于主叫方终端，包括：在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和相应的密钥标识信息；向被叫方终端发送携带第一通话加密信息的更新参数请求消息；其中，第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；接收被叫方终端响应于更新参数请求消息返回的携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法；对更新参数应答消息进行解析，确定会话密钥同步成功以及获得目标加密算法，进而基于目标加密算法和会话密钥与被叫方终端进行加密通话。在本公开一个实施例中，通话加密条件包括：主叫方与被叫方均已签约语音加密业务，主叫方终端与被叫方终端均处于指定驻网状态，以及主叫方终端与被叫方终端均支持密话功能；方法还包括按照如下方法确定主叫方与被叫方满足通话加密条件：在主叫方终端处于指定驻网状态且支持密话功能的情况下，向应用服务器发送携带第一指示信息的呼叫请求消息，以使应用服务器在确定主叫方与被叫方满足第一条件的情况下将呼叫请求消息转发至被叫方终端；其中，第一指示信息包括：主叫方终端支持密话功能；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；接收被叫方终端响应于呼叫请求消息返回的呼叫应答消息，并对呼叫应答消息进行解析；在解析呼叫应答消息获得第二指示信息的情况下，确定主叫方与被叫方满足通话加密条件；其中，第二指示信息包括：被叫方终端支持密话功能。在本公开一个实施例中，向密钥服务器申请获得会话密钥和相应的密钥标识信息，包括：向密钥服务器发送携带呼叫信息的主叫会话密钥申请，以使密钥服务器基于呼叫信息对主叫方进行第一认证鉴权；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；接收密钥服务器在确定第一认证鉴权通过后返回的会话密钥和密钥标识信息。根据本公开的另一个方面，提供一种用于加密通话的方法，应用于被叫方终端，包括：接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息；其中，更新参数请求消息是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；响应于更新参数请求消息从密钥服务器获取会话密钥，以确定会话密钥同步成功，并基于更新参数请求消息确定目标加密算法；其中，会话密钥是主叫方终端向密钥服务器申请后存储于密钥服务器上的；向主叫方终端发送携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法。在本公开一个实施例中，在接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息之前，方法还包括：接收应用服务器在确定主叫方与被叫方满足第一条件的情况下转发的携带第一指示信息的呼叫请求消息；其中，呼叫请求消息是由主叫方终端发送的，第一指示信息包括：主叫方终端支持密话功能；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；解析呼叫请求消息，响应于解析获得的第一指示信息，查询被叫方终端是否支持密话功能；在确定被叫方终端支持密话功能的情况下，向主叫方终端发送携带第二指示信息的呼叫应答消息；其中，第二指示信息包括：被叫方终端支持密话功能。在本公开一个实施例中，响应于更新参数请求消息从密钥服务器获取会话密钥，包括：解析更新参数请求消息，获得主叫方终端所支持的第一加密算法集合和密钥标识信息；向密钥服务器发送携带呼叫信息和密钥标识信息的被叫会话密钥申请，以使密钥服务器基于呼叫信息对被叫方进行第二认证鉴权；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；接收密钥服务器在确定第二认证鉴权通过后基于密钥标识信息返回的会话密钥。在本公开一个实施例中，基于更新参数请求消息确定目标加密算法，包括：查询被叫方终端所支持的第二加密算法集合；基于第一加密算法集合和第二加密算法集合确定目标加密算法。根据本公开的又一个方面，提供一种用于加密通话的方法，应用于应用服务器，包括：接收主叫方终端发送的携带第一指示信息的呼叫请求消息；其中，呼叫请求消息是主叫方终端在确认主叫方终端处于指定驻网状态且支持密话功能的情况下发送的，第一指示信息包括：主叫方终端支持密话功能；查询主叫方与被叫方是否满足第一条件；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；在确定主叫方与被叫方满足第一条件的情况下，将携带第一指示信息的呼叫请求消息转发至被叫方终端。在本公开一个实施例中，查询主叫方与被叫方是否满足第一条件，包括：向统一数据管理网元UDM和/或归属用户服务器HSS进行查询，获得主叫方与被叫方的用户签约数据，以及获得被叫方终端的当前驻网情况；根据用户签约数据判断主叫方与被叫方是否签约语音加密业务，以及根据当前驻网情况判断被叫方终端是否处于指定驻网状态；其中，处于指定驻网状态包括：驻网在4G网络或5G网络上。在本公开一个实施例中，用于加密通话的方法还包括：在确定主叫方与被叫方不满足第一条件的情况下，去除呼叫请求消息中的第一指示信息，以获得普通呼叫请求消息；将普通呼叫请求消息转发至被叫方终端。根据本公开的又一个方面，提供一种用于加密通话的方法，应用于密钥服务器，包括：响应于主叫方终端发送的主叫会话密钥申请，向主叫方终端发送会话密钥和相应的密钥标识信息；其中，主叫会话密钥申请是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；以及，响应于被叫方终端发送的携带密钥标识信息的被叫会话密钥申请，向被叫方终端发送与密钥标识信息对应的会话密钥；其中，被叫会话密钥申请是被叫方终端响应于主叫方终端发送的更新参数请求消息发送的。在本公开一个实施例中，响应于主叫方终端发送的主叫会话密钥申请，向主叫方终端发送会话密钥和相应的密钥标识信息，包括：接收主叫方终端发送的携带呼叫信息的主叫会话密钥申请；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；基于呼叫信息对主叫方进行第一认证鉴权；在确定第一认证鉴权通过后，生成并存储会话密钥和相应的密钥标识信息；向主叫方终端发送会话密钥和密钥标识信息。在本公开一个实施例中，响应于被叫方终端发送的携带密钥标识信息的被叫会话密钥申请，向被叫方终端发送与密钥标识信息对应的会话密钥，包括：接收被叫方终端发送的携带呼叫信息和密钥标识信息的被叫会话密钥申请；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；基于呼叫信息对被叫方进行第二认证鉴权；在确定第二认证鉴权通过后，确定与密钥标识信息对应的会话密钥；向被叫方终端发送会话密钥。根据本公开的又一个方面，提供一种用于加密通话的装置，应用于主叫方终端，包括：第一密钥获取模块，用于在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和相应的密钥标识信息；第一发送模块，用于向被叫方终端发送携带第一通话加密信息的更新参数请求消息；其中，第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；第一接收模块，用于接收被叫方终端响应于更新参数请求消息返回的携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法；解析模块，用于对更新参数应答消息进行解析，确定会话密钥同步成功以及获得目标加密算法，进而基于目标加密算法和会话密钥与被叫方终端进行加密通话。根据本公开的又一个方面，提供一种用于加密通话的装置，应用于被叫方终端，包括：第二接收模块，用于接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息；其中，更新参数请求消息是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；第二密钥获取模块，用于响应于更新参数请求消息从密钥服务器获取会话密钥，以确定会话密钥同步成功，并基于更新参数请求消息确定目标加密算法；其中，会话密钥是主叫方终端向密钥服务器申请后存储于密钥服务器上的；第二发送模块，用于向主叫方终端发送携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法。根据本公开的又一个方面，提供一种用于加密通话的装置，应用于应用服务器，包括：第三接收模块，用于接收主叫方终端发送的携带第一指示信息的呼叫请求消息；其中，呼叫请求消息是主叫方终端在确认主叫方终端处于指定驻网状态且支持密话功能的情况下发送的，第一指示信息包括：主叫方终端支持密话功能；查询模块，用于查询主叫方与被叫方是否满足第一条件；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；第三发送模块，用于在确定主叫方与被叫方满足第一条件的情况下，将携带第一指示信息的呼叫请求消息转发至被叫方终端。根据本公开的又一个方面，提供一种用于加密通话的装置，应用于密钥服务器，包括：第四发送模块，用于响应于主叫方终端发送的主叫会话密钥申请，向主叫方终端发送会话密钥和相应的密钥标识信息；其中，主叫会话密钥申请是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；以及，第四发送模块还用于响应于被叫方终端发送的携带密钥标识信息的被叫会话密钥申请，向被叫方终端发送与密钥标识信息对应的会话密钥；其中，被叫会话密钥申请是被叫方终端响应于主叫方终端发送的更新参数请求消息发送的。根据本公开的又一个方面，提供一种用于加密通话的系统，该系统包括：主叫方终端、被叫方终端、应用服务器以及密钥服务器；主叫方终端，被配置为执行应用于主叫方终端的用于加密通话的方法；被叫方终端，被配置为执行应用于被叫方终端的用于加密通话的方法；应用服务器，被配置为执行应用于应用服务器的用于加密通话的方法；密钥服务器，被配置为执行应用于密钥服务器的用于加密通话的方法。根据本公开的又一个方面，提供一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述的用于加密通话的方法。根据本公开的再一个方面，提供一种电子设备，包括：处理器；以及存储器，用于存储所述处理器的可执行指令；其中，所述处理器配置为经由执行所述可执行指令来执行上述的用于加密通话的方法。本公开的实施例所提供的用于加密通话的方法，一方面主叫方终端和被叫方终端可以分别在各自发出的消息中携带本机对于是否支持密话功能的指示信息；另一方面，可以由应用服务器响应于主叫方终端发送的请求消息查询主叫方与被叫方均是否均已签约语音加密业务，以及查询被叫方终端是否处于指定驻网状态，并进行后续的消息转发处理；再一方面，主叫方终端和被叫方终端可以分别在各自发出的消息中携带与会话密钥及加密算法相关的标识信息，以对加密算法和会话密钥进行协商，进而可以利用协商好的加密算法和会话密钥进行后续的呼叫流程以实现加密通话。可见，通过本公开提供的用于加密通话的方法，可以在不改变现有语音业务模式和用户体验的前提下，在呼叫信令中携带终端能力、驻网状态及密钥协商等标识信息，并通过终端与网络协同的方式对呼叫信令中携带的标识信息进行处理，实现对终端能力、驻网状态、签约业务和密钥协商信息的判断，确保终端正常呼叫、接续和通话，实现语音加密业务，同时还避免了保密通信延迟的问题。应当理解的是，以上的一般描述和后文的细节描述仅是示例性和解释性的，并不能限制本公开。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本公开的实施例，并与说明书一起用于解释本公开的原理。显而易见地，下面描述中的附图仅仅是本公开的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1示出了本公开实施例的一种用于加密通话的方法的网络架构示意图；图2示出了本公开实施例中一种应用于主叫方终端的用于加密通话的方法的流程图；图3示出了本公开实施例中一种应用于被叫方终端的用于加密通话的方法的流程图；图4示出了本公开实施例中一种应用于应用服务器的用于加密通话的方法的流程图；图5示出了本公开实施例中一种应用于密钥服务器的用于加密通话的方法的流程图；图6示出了本公开一个实施例的用于加密通话的方法的交互流程图；图7示出了本公开又一个实施例的用于加密通话的方法的流程图；图8示出了本公开实施例中一种应用于主叫方终端的用于加密通话的装置的框图；图9示出了本公开实施例中一种应用于被叫方终端的用于加密通话的装置的框图；图10示出了本公开实施例中一种应用于应用服务器的用于加密通话的装置的框图；图11示出了本公开实施例中一种应用于密钥服务器的用于加密通话的装置的框图；和图12示出了本公开实施例中一种用于加密通话的计算机设备的结构框图。具体实施方式现在将参考附图更全面地描述示例实施方式。然而，示例实施方式能够以多种形式实施，且不应被理解为限于在此阐述的范例；相反，提供这些实施方式使得本公开将更加全面和完整，并将示例实施方式的构思全面地传达给本领域的技术人员。所描述的特征、结构或特性可以以任何合适的方式结合在一个或更多实施方式中。此外，附图仅为本公开的示意性图解，并非一定是按比例绘制。图中相同的附图标记表示相同或类似的部分，因而将省略对它们的重复描述。附图中所示的一些方框图是功能实体，不一定必须与物理或逻辑上独立的实体相对应。可以采用软件形式来实现这些功能实体，或在一个或多个硬件模块或集成电路中实现这些功能实体，或在不同网络和/或处理器装置和/或微控制器装置中实现这些功能实体。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括一个或者更多个该特征。在本公开的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。针对上述相关技术中存在的技术问题，本公开实施例提供了一种用于加密通话的方法，以用于至少解决上述技术问题中的一个或者全部。图1示出了本公开实施例的一种用于加密通话的方法的网络架构示意图。如图1所示，该系统架构可以包括主叫方终端101、被叫方终端102、应用服务器103以及密钥服务器104。其中，终端与服务器之间可以通过网络进行数据通信，该网络例如可以包括数据网络、IMS和4G/5G网络进行数据通信；该网络可以是有线网络，也可以是无线网络。在示例性实施例中，上述的有线网络或无线网络使用标准通信技术和/或协议。网络通常为因特网，但也可以是任何网络，包括但不限于局域网、城域网、广域网、移动、有线或者无线网络、专用网络或者虚拟专用网络的任何组合。在一些实施例中，可以使用包括超文本标记语言、可扩展标记语言等技术和/或格式来代表通过网络交换的数据。此外，还可以使用诸如安全套接字层、传输层安全、虚拟专用网络、网际协议安全等常规加密技术来加密所有或者一些链路。在另一些实施例中，还可以使用定制和/或专用数据通信技术取代或者补充上述数据通信技术。在示例性实施例中，主叫方终端101、被叫方终端102可以是各种电子设备，包括但不限于智能手机、平板电脑、膝上型便携计算机、台式计算机、可穿戴设备、增强现实设备、虚拟现实设备等类型的电子设备。可选地，主叫方终端101、被叫方终端102上运行的操作系统可以包括但不限于安卓系统、IOS系统、Linux系统、Windows系统等。示例性地，主叫方终端101实现用于加密通话的方法的过程可以是：主叫方终端101在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和相应的密钥标识信息；主叫方终端101向被叫方终端发送携带第一通话加密信息的更新参数请求消息；其中，第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；主叫方终端101接收被叫方终端响应于更新参数请求消息返回的携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法；主叫方终端101对更新参数应答消息进行解析，确定会话密钥同步成功以及获得目标加密算法，进而基于目标加密算法和会话密钥与被叫方终端进行加密通话。示例性地，被叫方终端102实现用于加密通话的方法的过程可以是：被叫方终端102接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息；其中，更新参数请求消息是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；被叫方终端102响应于更新参数请求消息从密钥服务器获取会话密钥，以确定会话密钥同步成功，并基于更新参数请求消息确定目标加密算法；其中，会话密钥是主叫方终端向密钥服务器申请后存储于密钥服务器上的；被叫方终端102向主叫方终端发送携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法。在示例性实施例中，应用服务器103与密钥服务器104均可以是独立的物理服务器，也可以是多个物理服务器构成的服务器集群或者分布式系统，还可以是提供云服务、云数据库、云计算、云函数、云存储、网络服务、云通信、中间件服务、域名服务、安全服务、CDN、以及大数据和人工智能平台等基础云计算服务的云服务器。示例性地，应用服务器103实现用于加密通话的方法的过程可以是：应用服务器103接收主叫方终端发送的携带第一指示信息的呼叫请求消息；其中，呼叫请求消息是主叫方终端在确认主叫方终端处于指定驻网状态且支持密话功能的情况下发送的，第一指示信息包括：主叫方终端支持密话功能；应用服务器103查询主叫方与被叫方是否满足第一条件；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；应用服务器103在确定主叫方与被叫方满足第一条件的情况下，将携带第一指示信息的呼叫请求消息转发至被叫方终端。示例性地，密钥服务器104实现用于加密通话的方法的过程可以是：密钥服务器104响应于主叫方终端发送的主叫会话密钥申请，向主叫方终端发送会话密钥和相应的密钥标识信息；其中，主叫会话密钥申请是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；以及，密钥服务器104响应于被叫方终端发送的携带密钥标识信息的被叫会话密钥申请，向被叫方终端发送与密钥标识信息对应的会话密钥；其中，被叫会话密钥申请是被叫方终端响应于主叫方终端发送的更新参数请求消息发送的。本领域技术人员可以知晓，图1中的主叫方终端101、被叫方终端102、应用服务器103以及密钥服务器104的数量仅仅是示意性的，根据实际需要，可以具有任意数目的主叫方终端101、被叫方终端102、应用服务器103以及密钥服务器104，本公开对此不做限定。为了使本领域普通人员更好地理解本公开的技术方案，下面将结合附图及实施例对本公开示例实施例中的用于加密通话的方法方法的各个步骤进行更详细的说明。图2示出了本公开实施例中一种应用于主叫方终端的用于加密通话的方法的流程图。本公开实施例提供的方法可以由如图1所示的主叫方终端101执行，但本公开并不限定于此。如图2所示，本公开实施例提供的用于加密通话的方法可以包括以下步骤。步骤S201，在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和相应的密钥标识信息。在一些实施例中，通话加密条件可以包括：主叫方与被叫方均已签约语音加密业务，主叫方终端与被叫方终端均处于指定驻网状态，以及主叫方终端与被叫方终端均支持密话功能。在一些实际应用中，终端处于指定驻网状态，可以是驻网在4G网络或5G网络上；支持密话功能可以是支持VoLTE加密通信功能。在一些实际应用中，若主叫方终端确定双方不满足通话加密条件，则可以直接按照普通呼叫流程进行，如：直接向被叫方终端发送普通的更新参数请求消息，而无需执行向密钥服务器请求会话密钥和相应的密钥标识信息的步骤，从而避免了不必要的流程步骤。在一些实施例中，向密钥服务器申请获得会话密钥和相应的密钥标识信息的步骤，可以包括：向密钥服务器发送携带呼叫信息的主叫会话密钥申请，以使密钥服务器基于呼叫信息对主叫方进行第一认证鉴权；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；接收密钥服务器在确定第一认证鉴权通过后返回的会话密钥和密钥标识信息。主叫方终端可以先确定主叫方与被叫方是否满足通话加密条件，再根据不同的情况发送不同的信令。例如，若主叫方终端确定双方满足通话加密条件，则可以根据本公开提供的用于加密通话的方法与被叫终端进行加密算法与会话密钥的协商确定；若主叫方终端确定双方不满足通话加密条件，则可以按照普通呼叫流程进行后续处理，从而避免了不必要的协商，也避免了在呼叫接通后再协商是否进行加密通话而导致的通信延迟。本步骤中，从密钥服务器申请获得的会话密钥和密钥标识信息是成对的，密钥标识信息可以用于在后续步骤中使被叫方终端同步会话密钥，会话密钥可以在双方实际通话时对通信数据进行加密。在一些实施例中，在向密钥服务器申请获得会话密钥和相应的密钥标识信息之前，用于加密通话的方法还可以包括按照如下方法确定主叫方与被叫方满足通话加密条件：在主叫方终端处于指定驻网状态且支持密话功能的情况下，向应用服务器发送携带第一指示信息的呼叫请求消息，以使应用服务器在确定主叫方与被叫方满足第一条件的情况下将呼叫请求消息转发至被叫方终端；其中，第一指示信息可以包括：主叫方终端支持密话功能；第一条件可以包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；接收被叫方终端响应于呼叫请求消息返回的呼叫应答消息，并对呼叫应答消息进行解析；在解析呼叫应答消息获得第二指示信息的情况下，确定主叫方与被叫方满足通话加密条件；其中，第二指示信息包括：被叫方终端支持密话功能。由本实施例可以看出，在主叫方终端接收被叫方终端响应于呼叫请求消息返回的呼叫应答消息后，可以确定双方是否已满足通话加密条件。其中，在主叫方终端向被叫方终端发送呼叫请求消息、被叫方终端向主叫方终端返回呼叫应答消息的过程中，可以由主叫方终端、应用服务器和被叫方终端分别承担对上述通话加密条件中各个条件的判断。具体地，可以由主叫方终端对“主叫方终端是否处于指定驻网状态”和“主叫方终端是否支持密话功能”进行判断，可以由应用服务器对“主叫方与被叫方是否均已签约语音加密业务”和“被叫方终端是否处于指定驻网状态”进行判断，以及，可以由被叫方终端对“被叫方终端是否支持密话功能”进行判断。此外，在一些实际应用中，本实施例中的呼叫请求消息可以是请求行方法格式为Invite的SIP请求消息，呼叫应答消息可以是状态行状态代码为183的SIP应答消息。步骤S203，向被叫方终端发送携带第一通话加密信息的更新参数请求消息；其中，第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息。本步骤中，可以先将更新参数请求消息发送至应用服务器，再由应用服务器将更新参数请求消息转发至被叫方终端。在一些实际应用中，主叫方终端所支持的第一加密算法集合可以是主叫方终端自身查询获得的，加密算法例如可以包括传统的分组加密算法，国密分组加密算法等，本公开对此不做限定。此外，在一些实际应用中，本步骤中的更新参数请求消息可以是请求行方法格式为Update的SIP请求消息，该请求消息意味着主叫方终端希望与被叫方终端协商相关参数信息。步骤S205，接收被叫方终端响应于更新参数请求消息返回的携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法。本步骤中，被叫方终端接收到携带第一通话加密信息的更新参数请求消息后，可以进行会话密钥的同步，并返回相应的更新参数应答消息，以使主叫方终端在接收到该更新参数应答消息后得知被叫方终端处理成功的结果。在一些实际应用中，本步骤中的更新参数应答消息可以是状态行状态代码为200的SIP应答消息。步骤S207，对更新参数应答消息进行解析，确定会话密钥同步成功以及获得目标加密算法，进而基于目标加密算法和会话密钥与被叫方终端进行加密通话。本步骤中，在主叫方终端解析更新参数应答消息获得会话密钥同步成功以及获得目标加密算法之后，可以确认被叫方终端已对会话密钥同步完成，且可以从被叫方终端返回的应答消息中获得双方协商好的加密算法，则可以利用协商好的加密算法和会话密钥进行后续的呼叫流程，从而进行加密通话。在本公开提供的用于加密通话的方法中，一方面主叫方终端和被叫方终端可以分别在各自发出的消息中携带本机对于是否支持密话功能的指示信息；另一方面，可以由应用服务器响应于主叫方终端发送的请求消息查询主叫方与被叫方均是否均已签约语音加密业务，以及查询被叫方终端是否处于指定驻网状态，并进行后续的消息转发处理；再一方面，主叫方终端和被叫方终端可以分别在各自发出的消息中携带与会话密钥及加密算法相关的标识信息，以对加密算法和会话密钥进行协商，进而可以利用协商好的加密算法和会话密钥进行后续的呼叫流程以实现加密通话。可见，通过本公开提供的用于加密通话的方法，可以在不改变现有语音业务模式和用户体验的前提下，在呼叫信令中携带终端能力、驻网状态及密钥协商等标识信息，并通过终端与网络协同的方式对呼叫信令中携带的标识信息进行处理，实现对终端能力、驻网状态、签约业务和密钥协商信息的判断，确保终端正常呼叫、接续和通话，实现语音加密业务，同时还避免了保密通信延迟的问题。基于同一发明构思，在图1所示的网络架构下，本公开实施例还提供一种用于加密通话的方法，可以应用但不限于图1所示的被叫方终端102，但本公开并不限定于此。图3示出了本公开实施例中一种应用于被叫方终端的用于加密通话的方法的流程图，如图3所示，该方法包括以下步骤。步骤S301，接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息；其中，更新参数请求消息是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息。在一些实施例中，在接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息之前，用于加密通话的方法还可以包括：接收应用服务器在确定主叫方与被叫方满足第一条件的情况下转发的携带第一指示信息的呼叫请求消息；其中，呼叫请求消息是由主叫方终端发送的，第一指示信息包括：主叫方终端支持密话功能；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；解析呼叫请求消息，响应于解析获得的第一指示信息，查询被叫方终端是否支持密话功能；在确定被叫方终端支持密话功能的情况下，向主叫方终端发送携带第二指示信息的呼叫应答消息；其中，第二指示信息包括：被叫方终端支持密话功能。在一些实际应用中，若确认被叫方终端未签约语音加密业务，且处于指定驻网状态，则被叫方终端可以回复正常的183消息给应用服务器；若确认被叫方终端未处于指定驻网状态，则被叫方终端可以回复振铃消息给应用服务器。在一些实际应用中，若被叫方终端确认本机不支持密话功能，则可以向主叫方终端发送不携带与密话功能相关的指示信息的呼叫应答消息。步骤S303，响应于更新参数请求消息从密钥服务器获取会话密钥，以确定会话密钥同步成功，并基于更新参数请求消息确定目标加密算法；其中，会话密钥是主叫方终端向密钥服务器申请后存储于密钥服务器上的。在一些实施例中，响应于更新参数请求消息从密钥服务器获取会话密钥，包括：解析更新参数请求消息，获得主叫方终端所支持的第一加密算法集合和密钥标识信息；向密钥服务器发送携带呼叫信息和密钥标识信息的被叫会话密钥申请，以使密钥服务器基于呼叫信息对被叫方进行第二认证鉴权；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；接收密钥服务器在确定第二认证鉴权通过后基于密钥标识信息返回的会话密钥。在一些实施例中，基于更新参数请求消息确定目标加密算法，包括：查询被叫方终端所支持的第二加密算法集合；基于第一加密算法集合和第二加密算法集合确定目标加密算法。步骤S305，向主叫方终端发送携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法。可见，通过本公开提供的用于加密通话的方法，可以在不改变现有语音业务模式和用户体验的前提下，在呼叫信令中携带终端能力、驻网状态及密钥协商等标识信息，并通过终端与网络协同的方式对呼叫信令中携带的标识信息进行处理，实现对终端能力、驻网状态、签约业务和密钥协商信息的判断，确保终端正常呼叫、接续和通话，实现语音加密业务，同时还避免了保密通信延迟的问题。图3实施例的其它内容可以参照上述其它实施例，此处不再进行赘述。基于同一发明构思，在图1所示的网络架构下，本公开实施例还提供一种用于加密通话的方法，可以应用但不限于图1所示的应用服务器103，但本公开并不限定于此。图4示出了本公开实施例中一种应用于应用服务器的用于加密通话的方法的流程图，如图4所示，该方法包括以下步骤。步骤S401，接收主叫方终端发送的携带第一指示信息的呼叫请求消息；其中，呼叫请求消息是主叫方终端在确认主叫方终端处于指定驻网状态且支持密话功能的情况下发送的，第一指示信息包括：主叫方终端支持密话功能。步骤S403，查询主叫方与被叫方是否满足第一条件；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态。在一些实施例中，查询主叫方与被叫方是否满足第一条件，包括：向统一数据管理网元UDM和/或归属用户服务器HSS进行查询，获得主叫方与被叫方的用户签约数据，以及获得被叫方终端的当前驻网情况；根据用户签约数据判断主叫方与被叫方是否签约语音加密业务，以及根据当前驻网情况判断被叫方终端是否处于指定驻网状态；其中，处于指定驻网状态包括：驻网在4G网络或5G网络上。步骤S405，在确定主叫方与被叫方满足第一条件的情况下，将携带第一指示信息的呼叫请求消息转发至被叫方终端。在一些实施例中，用于加密通话的方法还包括：在确定主叫方与被叫方不满足第一条件的情况下，去除呼叫请求消息中的第一指示信息，以获得普通呼叫请求消息；将普通呼叫请求消息转发至被叫方终端。本实施例中，若应用服务器确定主叫方与被叫方不满足第一条件，则可以删除主叫方终端发送的呼叫请求消息中的第一指示信息，这是因为不满足第一条件的普通被叫方终端通常无法处理该呼叫请求消息中所携带的指示信息，而删除第一指示信息则可以使删除后获得的普通呼叫请求消息与普通呼叫流程中的消息结构一致，从而便于普通被叫方终端进行消息接收处理。在一些实施例中，应用服务器还用于在主叫方终端与被叫方终端之间转发消息，包括：转发主叫方终端向被叫方终端发送的更新参数请求消息，以及转发被叫方终端向主叫方终端发送的呼叫应答消息和更新参数应答消息。可见，通过本公开提供的用于加密通话的方法，可以在不改变现有语音业务模式和用户体验的前提下，在呼叫信令中携带终端能力、驻网状态及密钥协商等标识信息，并通过终端与网络协同的方式对呼叫信令中携带的标识信息进行处理，实现对终端能力、驻网状态、签约业务和密钥协商信息的判断，确保终端正常呼叫、接续和通话，实现语音加密业务，同时还避免了保密通信延迟的问题。图4实施例的其它内容可以参照上述其它实施例，此处不再进行赘述。基于同一发明构思，在图1所示的网络架构下，本公开实施例还提供一种用于加密通话的方法，可以应用但不限于图1所示的密钥服务器104，但本公开并不限定于此。图5示出了本公开实施例中一种应用于密钥服务器的用于加密通话的方法的流程图，如图5所示，该方法包括以下步骤。步骤S501，响应于主叫方终端发送的主叫会话密钥申请，向主叫方终端发送会话密钥和相应的密钥标识信息；其中，主叫会话密钥申请是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的。在一些实施例中，响应于主叫方终端发送的主叫会话密钥申请，向主叫方终端发送会话密钥和相应的密钥标识信息，包括：接收主叫方终端发送的携带呼叫信息的主叫会话密钥申请；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；基于呼叫信息对主叫方进行第一认证鉴权；在确定第一认证鉴权通过后，生成并存储会话密钥和相应的密钥标识信息；向主叫方终端发送会话密钥和密钥标识信息。本实施例中，第一认证鉴权例如可以是基于主叫会话密钥申请中的呼叫信息向应用服务器查询以实现认证鉴权，查询内容例如可以是本次会话中的主叫方与被叫方是否签约了密话业务等。在第一认证鉴权通过后，密钥服务器可以建立与主叫方码号、被叫方码号、会话标识之间的映射关系，然后采用网络运营商的保护机制将会话密钥及密钥标识信息安全地返回至主叫方终端。步骤S503，响应于被叫方终端发送的携带密钥标识信息的被叫会话密钥申请，向被叫方终端发送与密钥标识信息对应的会话密钥；其中，被叫会话密钥申请是被叫方终端响应于主叫方终端发送的更新参数请求消息发送的。在一些实施例中，响应于被叫方终端发送的携带密钥标识信息的被叫会话密钥申请，向被叫方终端发送与密钥标识信息对应的会话密钥，包括：接收被叫方终端发送的携带呼叫信息和密钥标识信息的被叫会话密钥申请；其中，呼叫信息包括：主叫方码号、被叫方码号和会话标识；基于呼叫信息对被叫方进行第二认证鉴权；在确定第二认证鉴权通过后，确定与密钥标识信息对应的会话密钥；向被叫方终端发送会话密钥。本实施例中，第二认证鉴权例如可以是基于被叫会话密钥申请中的呼叫信息向应用服务器进行查询以实现认证鉴权，查询内容例如可以是本次会话中的主叫方与被叫方是否签约了密话业务等。在第二认证鉴权通过后，密钥服务器可以基于上一步骤中建立好的映射关系进行查询，获得与密钥标识信息对应的会话密钥，然后采用网络运营商的保护机制将该会话密钥安全地返回至主叫方终端。可见，通过本公开提供的用于加密通话的方法，可以在不改变现有语音业务模式和用户体验的前提下，在呼叫信令中携带终端能力、驻网状态及密钥协商等标识信息，并通过终端与网络协同的方式对呼叫信令中携带的标识信息进行处理，实现对终端能力、驻网状态、签约业务和密钥协商信息的判断，确保终端正常呼叫、接续和通话，实现语音加密业务，同时还避免了保密通信延迟的问题。图5实施例的其它内容可以参照上述其它实施例，此处不再进行赘述。图6示出了本公开一个实施例的用于加密通话的方法的交互流程图。本公开实施例提供的方法可以由如图1所示的主叫方终端101、被叫方终端102、应用服务器103以及密钥服务器104执行，但本公开并不限定于此，如图6所示，该方法可以包括以下步骤。步骤S01，主叫方终端向应用服务器发送携带本机支持VoLTE语音加密功能指示的SIP invite消息。步骤S02，应用服务器判断主被叫号码签约情况，向HSS/UDM查询被叫方终端的4G/5G驻网状态。步骤S03，在应用服务器确定主叫方与被叫方满足第一条件的情况下，应用服务器向被叫方终端转发含指示信息的SIP invite消息。其中，第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态。步骤S04，被叫方终端解析含有指示信息的SIP invite消息。步骤S05，被叫方终端向应用服务器发送携带本机支持VoLTE语音加密功能指示的183session progress消息。步骤S06，应用服务器向主叫方终端转发183session progress消息。步骤S07，主叫方终端解析含有指示信息的183session消息。步骤S08，在主叫方终端确定被叫方终端也支持语音加密功能的情况下，主叫方终端向密钥服务器申请会话密钥。步骤S09，密钥服务器进行认证鉴权，生成会话密钥及密钥标识。步骤S10，密钥服务器向主叫方终端安全返回会话密钥及密钥标识。步骤S11，主叫方终端向应用服务器发送携带本机支持的加密算法及密钥标识信息的SIP update消息。步骤S12，应用服务器向被叫方终端转发SIP update消息。步骤S13，被叫方终端解析含有指示信息的SIP update消息。步骤S14，被叫方终端向密钥服务器申请会话密钥。步骤S15，密钥服务器进行认证鉴权，基于密钥标识信息匹配获得主叫方终端所请求的会话密钥。步骤S16，密钥服务器向被叫方终端安全返回会话密钥。步骤S17，被叫方终端确定本次会话的加密算法。步骤S18，被叫方终端向应用服务器返回SIP update 200 OK消息，该SIP update 200 OK消息中可以携带本次会话加密算法及会话密钥同步成功指示信息。步骤S19，应用服务器向主叫方终端转发携带指示信息的SIP update 200 OK消息。步骤S20，主叫方终端解析SIP update 200 OK，确定本次会话为VoLTE加密通话。然后主叫方终端与被叫方终端之间可以利用上述过程中所确定的加密算法和会话秘钥进行后续的呼叫流程及VoLTE加密通话。图6实施例的其它内容可以参照上述其它实施例，此处不再进行赘述。图7示出了本公开又一个实施例的用于加密通话的方法的流程图，如图7所示，该方法可以包括以下步骤。首先，主被叫终端分别在SIP消息中携带本机支持VoLTE加密功能的指示。其中，主叫方终端在SIP invite消息相关字段中插入。被叫方终端根据接收到的主叫invite消息是否有VoLTE加密功能指示确定，如果主叫invite消息包含VoLTE加密功能指示，且被叫确认本机支持该功能，则在返回的183session progress消息字段中插入本机支持VoLTE加密功能的指示，否则，不插入本机VoLTE加密功能指示。其次，应用服务器可以先根据主被叫号码查询以判断用户是否签约。如签约，且主叫invite消息携带有本机VoLTE加密功能指示，则可以再向被叫用户数据库HSS/UDM查询被叫方终端的驻网状态，如果驻网在4G/5G网络状态，则应用服务器向被叫方终端转发主叫invite消息；否则，应用服务器删除主叫invite消息中携带的支持密话功能指示，再进行正常的呼叫消息转发。再次，主叫方终端对被叫方终端返回的183session progress消息进行解析判断，如果被叫183session progress消息中携带有VoLTE加密功能指示，则主叫方终端向密钥服务器申请会话密钥；如果不携带，则继续正常的呼叫流程。之后，在主叫方终端申请到会话密钥后，可以在发送给被叫方终端的update消息中携带密钥标识及本机支持的加密算法信息。然后，被叫方终端对接收到的主叫update消息进行解析判断，如果主叫update消息中携带密钥标识信息，则被叫方终端可以向密钥服务器申请与主叫相同的会话密钥。接着，在被叫方终端申请到会话密钥后，可以在发送给主叫方终端的SIP update200 ok消息中插入确定的加密算法及会话密钥同步成功的信息。最后，主叫方终端接收并解析SIP update 200 ok消息后，可以确定本次会话为VoLTE加密通话，主被叫可以继续后续呼叫流程以实现VoLTE加密通话。图7实施例的其它内容可以参照上述其它实施例，此处不再进行赘述。需要注意的是，上述附图仅是根据本发明示例性实施例的方法所包括的处理的示意性说明，而不是限制目的。易于理解，上述附图所示的处理并不表明或限制这些处理的时间顺序。另外，也易于理解，这些处理可以是例如在多个模块中同步或异步执行的。图8示出了本公开实施例中一种应用于主叫方终端的用于加密通话的装置的框图。如图8所示，用于加密通话的装置800包括：第一密钥获取模块801，用于在确定主叫方与被叫方满足通话加密条件的情况下，向密钥服务器申请获得会话密钥和相应的密钥标识信息；第一发送模块802，用于向被叫方终端发送携带第一通话加密信息的更新参数请求消息；其中，第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；第一接收模块803，用于接收被叫方终端响应于更新参数请求消息返回的携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法；解析模块804，用于对更新参数应答消息进行解析，确定会话密钥同步成功以及获得目标加密算法，进而基于目标加密算法和会话密钥与被叫方终端进行加密通话。图8实施例的其它内容可以参照上述其它实施例。图9示出了本公开实施例中一种应用于被叫方终端的用于加密通话的装置的框图。如图9所示，用于加密通话的装置900包括：第二接收模块901，用于接收主叫方终端发送的携带第一通话加密信息的更新参数请求消息；其中，更新参数请求消息是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；第一通话加密信息包括：主叫方终端所支持的第一加密算法集合和密钥标识信息；第二密钥获取模块902，用于响应于更新参数请求消息从密钥服务器获取会话密钥，以确定会话密钥同步成功，并基于更新参数请求消息确定目标加密算法；其中，会话密钥是主叫方终端向密钥服务器申请后存储于密钥服务器上的；第二发送模块903，用于向主叫方终端发送携带第二通话加密信息的更新参数应答消息；其中，第二通话加密信息包括：会话密钥同步成功的指示信息和目标加密算法。图9实施例的其它内容可以参照上述其它实施例。图10示出了本公开实施例中一种应用于应用服务器的用于加密通话的装置的框图。如图10所示，用于加密通话的装置1000包括：第三接收模块1001，用于接收主叫方终端发送的携带第一指示信息的呼叫请求消息；其中，呼叫请求消息是主叫方终端在确认主叫方终端处于指定驻网状态且支持密话功能的情况下发送的，第一指示信息包括：主叫方终端支持密话功能；查询模块1002，用于查询主叫方与被叫方是否满足第一条件；第一条件包括：主叫方与被叫方均已签约语音加密业务，以及被叫方终端处于指定驻网状态；第三发送模块1003，用于在确定主叫方与被叫方满足第一条件的情况下，将携带第一指示信息的呼叫请求消息转发至被叫方终端。图10实施例的其它内容可以参照上述其它实施例。图11示出了本公开实施例中一种应用于密钥服务器的用于加密通话的装置的框图。如图11所示，用于加密通话的装置1100包括：第四发送模块1101，用于响应于主叫方终端发送的主叫会话密钥申请，向主叫方终端发送会话密钥和相应的密钥标识信息；其中，主叫会话密钥申请是主叫方终端在确定主叫方与被叫方满足通话加密条件的情况下发送的；以及，第四发送模块1101还用于响应于被叫方终端发送的携带密钥标识信息的被叫会话密钥申请，向被叫方终端发送与密钥标识信息对应的会话密钥；其中，被叫会话密钥申请是被叫方终端响应于主叫方终端发送的更新参数请求消息发送的。图11实施例的其它内容可以参照上述其它实施例。所属技术领域的技术人员能够理解，本发明的各个方面可以实现为系统、方法或程序产品。因此，本发明的各个方面可以具体实现为以下形式，即：完全的硬件实施方式、完全的软件实施方式，或硬件和软件方面结合的实施方式，这里可以统称为“电路”、“模块”或“系统”。图12示出本公开实施例中一种用于加密通话的计算机设备的结构框图。需要说明的是，图示出的电子设备仅仅是一个示例，不应对本发明实施例的功能和使用范围带来任何限制。下面参照图12来描述根据本发明的这种实施方式的电子设备1200。图12显示的电子设备1200仅仅是一个示例，不应对本发明实施例的功能和使用范围带来任何限制。如图12所示，电子设备1200以通用计算设备的形式表现。电子设备1200的组件可以包括但不限于：上述至少一个处理单元1210、上述至少一个存储单元1220、连接不同系统组件的总线1230。其中，所述存储单元存储有程序代码，所述程序代码可以被所述处理单元1210执行，使得所述处理单元1210执行本说明书上述“示例性方法”部分中描述的根据本发明各种示例性实施方式的步骤。例如，所述处理单元1210可以执行如图2中所示的方法。存储单元1220可以包括易失性存储单元形式的可读介质，例如随机存取存储单元12201和/或高速缓存存储单元12202，还可以进一步包括只读存储单元12203。存储单元1220还可以包括具有一组程序模块12205的程序/实用工具12204，这样的程序模块12205包括但不限于：操作系统、一个或者多个应用程序、其它程序模块以及程序数据，这些示例中的每一个或某种组合中可能包括网络环境的实现。总线1230可以为表示几类总线结构中的一种或多种，包括存储单元总线或者存储单元控制器、外围总线、图形加速端口、处理单元或者使用多种总线结构中的任意总线结构的局域总线。电子设备1200也可以与一个或多个外部设备1300通信，还可与一个或者多个使得用户能与该电子设备1200交互的设备通信，和/或与使得该电子设备1200能与一个或多个其它计算设备进行通信的任何设备通信。这种通信可以通过输入/输出接口1250进行。并且，电子设备1200还可以通过网络适配器1260与一个或者多个网络，广域网和/或公共网络，例如因特网)通信。如图所示，网络适配器1260通过总线1230与电子设备1200的其它模块通信。应当明白，尽管图中未示出，可以结合电子设备1200使用其它硬件和/或软件模块，包括但不限于：微代码、设备驱动器、冗余处理单元、外部磁盘驱动阵列、RAID系统、磁带驱动器以及数据备份存储系统等。在本公开的示例性实施例中，还提供了一种计算机可读存储介质，其上存储有能够实现本说明书上述方法的程序产品。在一些可能的实施方式中，本发明的各个方面还可以实现为一种程序产品的形式，其包括程序代码，当所述程序产品在终端设备上运行时，所述程序代码用于使所述终端设备执行本说明书上述“示例性方法”部分中描述的根据本发明各种示例性实施方式的步骤。根据本发明实施方式的用于实现上述方法的程序产品，其可以采用便携式紧凑盘只读存储器并包括程序代码，并可以在终端设备，例如个人电脑上运行。然而，本发明的程序产品不限于此，在本文件中，可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。所述程序产品可以采用一个或多个可读介质的任意组合。可读介质可以是可读信号介质或者可读存储介质。可读存储介质例如可以为但不限于电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。计算机可读信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了可读程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。可读信号介质还可以是可读存储介质以外的任何可读介质，该可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于无线、有线、光缆、RF等等，或者上述的任意合适的组合。可以以一种或多种程序设计语言的任意组合来编写用于执行本发明操作的程序代码，所述程序设计语言包括面向对象的程序设计语言—诸如Java、C++等，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、作为一个独立的软件包执行、部分在用户计算设备上部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。在涉及远程计算设备的情形中，远程计算设备可以通过任意种类的网络，包括局域网或广域网，连接到用户计算设备，或者，可以连接到外部计算设备。应当注意，尽管在上文详细描述中提及了用于动作执行的设备的若干模块或者单元，但是这种划分并非强制性的。实际上，根据本公开的实施方式，上文描述的两个或更多模块或者单元的特征和功能可以在一个模块或者单元中具体化。反之，上文描述的一个模块或者单元的特征和功能可以进一步划分为由多个模块或者单元来具体化。此外，尽管在附图中以特定顺序描述了本公开中方法的各个步骤，但是，这并非要求或者暗示必须按照该特定顺序来执行这些步骤，或是必须执行全部所示的步骤才能实现期望的结果。附加的或备选的，可以省略某些步骤，将多个步骤合并为一个步骤执行，以及/或者将一个步骤分解为多个步骤执行等。通过以上的实施方式的描述，本领域的技术人员易于理解，这里描述的示例实施方式可以通过软件实现，也可以通过软件结合必要的硬件的方式来实现。因此，根据本公开实施方式的技术方案可以以软件产品的形式体现出来，该软件产品可以存储在一个非易失性存储介质中或网络上，包括若干指令以使得一台计算设备执行根据本公开实施方式的方法。本领域技术人员在考虑说明书及实践这里公开的发明后，将容易想到本公开的其它实施方案。本申请旨在涵盖本公开的任何变型、用途或者适应性变化，这些变型、用途或者适应性变化遵循本公开的一般性原理并包括本公开未公开的本技术领域中的公知常识或惯用技术手段。说明书和实施例仅被视为示例性的，本公开的真正范围和精神由所附的权利要求指出。
