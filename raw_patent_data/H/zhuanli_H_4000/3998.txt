标题title
消息队列的加密
摘要abst
在发布‑订阅消息队列中进行有针对性的基于话题的加密。由用于存储和接收消息两者的加密策略所驱动的基于话题的加密使用活动跟踪和日志记录来确保与所存储的经加密的消息相关联的某些话题的机密性。对发布者和消费者两者的认证确保了加密密钥和解密密钥被秘密地使用。
权利要求书clms
1.一种计算机实现的方法，包括：通过参考基于话题的加密策略来确定与第一消息相关联的第一话题需要第一加密级别；向第一实体提供加密密钥，所述加密密钥用于根据所述第一加密级别对所述第一消息进行加密以产生第一经加密的消息；根据所述第一话题将所述第一经加密的消息存储在消息排队系统中；从第二实体接收对包括所述第一经加密的消息的与所述第一话题相关联的消息的请求；参考所述第一话题、根据所述基于话题的加密策略来识别与所述经加密的消息相对应的解密密钥；以及向所述第二实体发送所述第一经加密的消息，以由所述消费者使用所述解密密钥来解密。2.根据权利要求1所述的计算机实现的方法，还包括：把向所述第一实体提供用于产生所述第一经加密的消息的所述加密密钥以及向所述第二实体发送所述第一经加密的消息的所述解密密钥记录到日志记录系统。3.根据权利要求2所述的计算机实现的方法，还包括：响应于对所述基于话题的加密策略的更新，把所述更新记录到所述日志记录系统。4.根据权利要求1所述的计算机实现的方法，还包括：从所述第一实体接收请求以确定所述第一话题是否需要加密以存储在所述消息排队系统中。5.根据权利要求1所述的计算机实现的方法，还包括：为所述第二实体建立订阅账户，包括向所述第二实体分配认证凭证；以及当所述第二实体经由所述订阅账户订阅所述第一话题时，接收到所述请求。6.根据权利要求1所述的计算机实现的方法，其中，通过所述基于话题的加密策略将所述解密密钥分配给所述第一话题。7.一种计算机程序产品，所述计算机程序产品包括其中存储有指令集的计算机可读存储介质，所述指令集在由处理器执行时使处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：通过参考基于话题的加密策略来确定与第一消息相关联的第一话题需要第一加密级别；向第一实体提供加密密钥，所述加密密钥用于根据所述第一加密级别对所述第一消息进行加密以产生第一经加密的消息；根据所述第一话题将所述第一经加密的消息存储在消息排队系统中；从第二实体接收对包括所述第一经加密的消息的与所述第一话题相关联的消息的请求；参考所述第一话题、根据所述基于话题的加密策略来识别与所述经加密的消息相对应的解密密钥；以及向所述第二实体发送所述第一经加密的消息，以由所述第二实体使用所述解密密钥来解密。8.根据权利要求7所述的计算机程序产品，还使得所述处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：把向所述用户提供用于产生所述第一经加密的消息的所述加密密钥以及向所述第二实体发送所述第一经加密的消息的所述解密密钥记录到日志记录系统。9.根据权利要求8所述的计算机程序产品，还使得所述处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：响应于对所述基于话题的加密策略的更新，把所述更新记录到所述日志记录系统。10.根据权利要求7所述的计算机程序产品，还使得所述处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：从所述第一实体接收请求以确定所述第一话题是否需要加密以存储在所述消息排队系统中。11.根据权利要求7所述的计算机程序产品，还使得所述处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：为所述第二实体建立订阅账户，包括向所述第二实体分配认证凭证；以及当所述第二实体经由所述订阅账户订阅所述第一话题时，接收到所述请求。12.根据权利要求7所述的计算机程序产品，其中，通过所述基于话题的加密策略将所述解密密钥分配给所述第一话题。13.一种计算机系统，包括：处理器组；以及计算机可读存储介质，其中存储有程序指令；其中：所述处理器组执行所述程序指令，所述程序指令使得所述处理器组通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：通过参考基于话题的加密策略来确定与第一消息相关联的第一话题需要第一加密级别；向第一实体提供加密密钥，所述加密密钥用于根据所述第一加密级别对所述第一消息进行加密以产生第一经加密的消息；根据所述第一话题将所述第一经加密的消息存储在消息排队系统中；从第二实体接收对包括所述第一经加密的消息的与所述第一话题相关联的消息的请求；参考所述第一话题、根据所述基于话题的加密策略来识别与所述经加密的消息相对应的解密密钥；以及向所述第二实体发送所述第一经加密的消息，以由所述第二实体使用所述解密密钥来解密。14.根据权利要求13所述的计算机系统，还使得所述处理器组通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：把向所述第一实体提供用于产生所述第一经加密的消息的所述加密密钥以及向所述第二实体发送所述第一经加密的消息的所述解密密钥记录到日志记录系统。15.根据权利要求14所述的计算机系统，还使得所述处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：响应于对所述基于话题的加密策略的更新，把所述更新记录到所述日志记录系统。16.根据权利要求13所述的计算机系统，还使得所述处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：从所述第一实体接收请求以确定所述第一话题是否需要加密以存储在所述消息排队系统中。17.根据权利要求13所述的计算机系统，还使得所述处理器通过以下操作在发布-订阅消息传递队列中进行基于话题的加密：为所述第二实体建立订阅账户，包括向所述第二实体分配认证凭证；以及当所述第二实体经由所述订阅账户订阅所述第一话题时，接收到所述请求。18.根据权利要求13所述的计算机系统，其中，通过所述基于话题的加密策略将所述解密密钥分配给所述第一话题。19.一种计算机实现的方法，包括：由生产者通过参考基于话题的加密策略来确定与第一消息相关联的第一话题需要第一加密级别；由所述生产者根据所述第一加密级别对所述第一消息进行加密以产生经加密的消息；根据所述第一话题将所述经加密的消息存储在消息排队系统中；从消费者接收对包括所述第一消息的与所述第一话题相关联的消息的订阅；由所述消费者参考所述第一话题、根据所述基于话题的加密策略来识别与所述经加密的消息相对应的解密密钥；以及由所述消费者利用所述解密密钥对所述经加密的消息进行解密以再现所述第一消息。20.根据权利要求19所述的计算机实现的方法，还包括：从所述生产者接收与所述第一话题相关联的所述第一消息。21.如权利要求19所述的计算机实现的方法，其中，所述消息排队系统是卡夫卡系统。22.根据权利要求19所述的计算机实现的方法，其中识别所述解密密钥包括：参考所述基于话题的加密策略来确定对与所述第一话题相关联的消息的所述订阅是否包括经加密的消息。23.根据权利要求19所述的计算机实现的方法，其中：所述经加密的消息包括消息认证码；以及只有当由所述消费者提供所述消息认证码时，对消息的所述订阅才包括所述经加密的消息。
说明书desc
背景技术本发明总体上涉及消息排队系统，并且尤其涉及以安全方式对消息排队系统中的消息进行处理。对企业内、企业间、从企业到消费者以及从消费者到消费者的消息和信息交换进行管理是信息技术的核心竞争力之一。消息传递系统已经被广泛地使用了几十年，以便将数据作为消息来存储、转发和分发。最近，诸如Kafka之类的消息传递系统也被认为是数据库的一种形式。在这种发展的同时，这些消息传递系统越来越多地在云计算系统中实例化。”可能受到全世界各种司法管辖区的商标权的约束，并且在这里仅用于指在这样的商标权可能存在的范围内由商标适当地命名的产品或服务。)已知安全密钥管理和数据传输系统包括转换系统、数据消费者网络设备、用户网络设备和数据传输网络。传输管理系统被配置为经由数据传输网络从用户网络设备接收特定于用户的数据，并且接收对服务的请求，该服务与根据由数据消费者网络设备提供的专有处理来处理特定于用户的数据相对应。另外，已知用于传播网络配置策略的系统使用发布/订阅消息传递系统。在操作期间，该系统通过发布/订阅消息传递系统从策略服务器接收包含配置策略的第一表示的一个或多个消息。发明内容在本发明的一个方面中，一种方法、计算机程序产品和系统包括：通过参考基于话题的加密策略来确定与第一消息相关联的第一话题需要第一加密级别；向用户提供加密密钥，所述加密密钥用于根据所述第一加密级别对所述第一消息进行加密以产生第一经加密的消息；根据所述第一话题将所述第一经加密的消息存储在消息排队系统中；从消费者接收对包括所述第一经加密的消息的与所述第一话题相关联的消息的请求；参考所述第一话题、根据所述基于话题的加密策略来识别与所述经加密的消息相对应的解密密钥；以及向所述消费者发送所述第一经加密的消息，以由所述消费者使用所述解密密钥来解密。根据本发明的另一方面，可以提供一种用于在发布/订阅消息排队系统中进行有针对性的基于策略的加密的计算机实现的方法。该方法可以包括由消息排队系统接收经加密的消息，其中，该消息已经通过参考加密策略系统和存储与话题相关的加密密钥的密钥管理系统进行了加密；存储接收到的与话题相关的经加密的消息；以及基于对话题的订阅来发送经加密的消息。根据本发明的又一方面，可以提供一种用于在发布-订阅消息队列中进行有针对性的基于策略的加密的系统。该系统可以包括：消息排队系统，所述消息排队系统适于接收经加密的消息，其中，该消息已经通过参考加密策略系统和存储与话题相关的加密密钥的密钥管理系统进行了加密；用于存储接收到的与话题相关的经加密的消息的装置；以及用于基于对话题的订阅来发送经加密的消息的装置。此外，实施例可以采用可从计算机可用或计算机可读介质访问的相关计算机程序产品的形式，该计算机可用或计算机可读介质提供由计算机或任何指令执行系统使用或与计算机或任何指令执行系统结合使用的程序代码。为了本说明书的目的，计算机可用或计算机可读介质可以是任何装置，其可以包含用于存储、传送、传播或传输程序的装置，该程序由指令执行系统、装置或设备使用或与指令执行系统、装置或设备结合使用。附图说明应当注意，参考不同主题描述了本发明的实施例。特别地，一些实施例是参考方法类型权利要求来描述的，而其他实施例是参考装置类型权利要求来描述的。然而，本领域技术人员将从以上和以下描述中了解到，除非另外指出，除了属于一种类型的主题的特征的任何组合之外，与不同主题相关的特征之间的任何组合，特别是方法类型权利要求的特征与装置类型权利要求的特征之间的任何组合，也被认为是在本文献内公开的。从下文将描述的实施例的示例中，本发明的上述方面和其它方面是明显的，并且将参考实施例的示例进行解释，但是本发明不限于此。将仅通过示例的方式并且参考以下附图来描述本发明的一些实施例：图1是用于在发布-订阅消息队列中进行有针对性的基于策略的加密的第一实施例方法的流程图。图2是支持图1的第一实施例方法的第一实施例系统的示意图。图3是使用图2的第一实施例系统来实现第一实施例方法的至少部分的活动的流程图。图4是用于在发布/订阅消息队列中进行有针对性的基于策略的加密的第一实施例系统的机器逻辑部分的示意图。图5是用于在发布-订阅消息队列中进行有针对性的基于策略的加密的第二实施例方法的流程图。图6是根据本发明的计算系统的示意图。具体实施方式在发布-订阅消息队列中进行有针对性的基于话题的加密。由用于存储和接收消息两者的加密策略所驱动的基于话题的加密使用活动跟踪和日志记录来确保与所存储的经加密的消息相关联的某些话题的机密性。对发布者和消费者两者的认证确保了加密密钥和解密密钥被秘密地使用。当消息传递系统移动诸如个人信息或财务数据之类的高度敏感数据时，由于监管要求、隐私策略和/或最佳实践，可能经常需要在消息传递服务器处对数据进行加密。一些消息传递系统存储所有想要通过消息传递服务器进行转发的数据。由于这个原因和其它原因，这些消息传递系统类似于数据库。对于这种类型的消息传递系统，因为完整敏感信息集合可能存在并且存储在消息传递服务器上，所以对加密存储的需求增加。如果没有加密，则整个敏感数据集合可能被暴露给未被允许的访问。一些消息传递系统可以支持对存储在消息传递服务器上的数据进行本地加密。然而，即使消息传递系统支持服务器上的加密存储，数据的原始生产者也不一定控制加密手段，并且尤其是不控制加密密钥。通常，静态加密是利用消息传递服务器上的磁盘或文件系统加密来解决的。虽然这些方法可以防止在盘丢失或被盗时的暴露，但是当用户具有对消息传递服务器上的所有文件的读取和访问权限时，它们通常不阻止对解密数据的访问。因此，文件系统将为这样的拥有读取权限的用户解密数据。为了防止这种所谓的“sysadmin攻击”，最佳安全实践要求对敏感数据进行加密，即，系统管理员不能访问相应解密密钥中的数据库或应用级别。在本说明书的上下文中，可以使用以下惯例、术语和/或表述：术语“基于策略的加密”可以表示：规则的储存库可以在例如加密策略数据库中可用。通过参考加密策略数据库并且请求标志、即对消息队列中的与特定话题相关的消息进行加密的要求，加密策略数据库可以通知请求者与所选择的话题相关的消息被加密或必须被加密。还可以注意到，“对消息进行加密”可以指使消息作为纯文本不可读的处理。它可能仅在其可能被解密之后才可被理解。还可以注意到，术语“加密”可以被广义地理解，即，还包括其他密码操作，诸如提供消息完整性和不可否认性的数字签名和MAC。术语“消息队列”可以表示便于进程间通信或用于同一进程内的线程间通信的数据存储组织。它们可以使用消息的队列，例如所定义的消息序列。这样，可以建立异步通信协议。这意味着消息的发送方和接收方不需要同时与消息队列进行交互。由发送方放置到队列上的消息可以被存储到队列上并且被接收和/或接收方可以检索它们。可以存在来自不同公司或作为开源实现方式的更多的多个不同的商业消息排队系统。有时，消息排队系统也可以被表示为消息代理器。因此，消息排队可以允许这样的消息传递模式，其中，在本文中被表示为发布者或消息生产者的消息发送方没有对要直接发送到在本文中被表示为消息消费者的特定接收方的消息进行编程。在本说明书的上下文中，术语“生产者”和“消费者”可以指操作计算机的人类用户或者根据程序指令进行操作的计算机程序以产生、加密、订阅、接收和/或解密消息排队系统的消息。相反，在不知道任何订阅者的情况下，可以将所发布的消息分类成不同的类别或话题。在不知道哪个消息生产者可能已经产生了消息的情况下，订阅者可以表达对这些消息类别中的一个或多个的兴趣，并且可以仅接收他们感兴趣的那些消息，诸如感兴趣的特定话题。术语“经加密的消息”可以表示不以明文形式存在而是通过加密密钥进行编码的数据。已知各种加密方法。所提出的概念可以独立于所选择的加密方法。经加密的消息只能在解密之后以明文形式读取。术语“加密策略系统”可以表示定义要应用于消息的密码操作和相关联的密钥材料的信息的策略数据库或储存库，例如发送消息排队系统的给定话题。具体地，对于要被保护以防止未授权访问的每个话题，可以存在详述以下信息中的至少一些的记录：消息服务器地址；话题名称；话题标识符；加密算法；加密/解密步骤；密码套件；密钥管理服务；服务地址；密钥标识符；和/或用于加密/解密的可选初始化信息。术语“密钥管理系统”可以表示用于加密和解密密钥对的存储系统--特别是用于非对称加密--或用于消息的对称加密/解密。密钥管理系统可以基于加密策略系统的所选择的规则或基于所选择的话题来提供特定加密密钥。术语“订阅”可以表示对指定类别或话题的消息的所指示的兴趣。具有订阅的消息消费者可以接收按照话题或类别存储在消息队列中的消息。术语“话题”可以表示多个消息的主题或标题。话题可以根据不同的规则来组织，例如，与相同或相似的内容有关、与特定的时间段有关和/或与作者有关。术语“Kafka”系统)--特别是版本0.9.0或更高版本--可以表示由阿帕奇软件基金会拥有的已知开源流处理软件平台。Kafka旨在提供统一的、高吞吐量的、低延迟时间的平台，以用于处理实时数据馈送。它也可以用作消息排队系统，其按照话题来组织接收到的消息并且将它们存储在相关数据库中。除了Kafka系统之外，所提出的方法和相关系统还可以与其它消息排队系统一起实现。”、“APACHE”和“APACHE SOFTWARE FOUNDATION”可能受到全世界各种司法管辖区的商标权的约束，并且在这里仅用于指在这样的商标权可能存在的范围内由商标适当地命名的产品或服务。)术语“消息生产者”可以表示消息的发起者。发起者也可以被表示为发布者。术语“消息消费者”可以表示消息的接收者。可以注意到，术语“生产者”和“消费者”可以与Kafka系统有关。本发明的一些实施例认识到以下事实、潜在问题和/或潜在领域，以便相对于现有技术状态进行改进：传播网络配置策略的常规系统不允许消息代理器系统中的话题相关消息的端到端加密，因此sysadmin攻击可能仍然是不可避免的，并且因此，可能需要克服传统消息排队系统中的这些缺陷，特别是在确保消息排队系统内的数据的安全方面；可以在没有对从生产者发送到消息排队系统的消息进行解密的情况下保证从生产者到消费者的端到端数据保护，因为存储在消息排队服务器上的数据库中的消息保持加密并且以加密形式存储在数据库中，所以由消息排队系统接收到的并且根据安全策略而需要加密的消息将永远不会被未授权人员访问；消息排队系统、加密策略系统以及相关密钥管理系统和/或服务的组合可以允许在发布/订阅环境中对话题相关消息的安全方面进行唯一控制；根据可以排除管理员对数据库中的话题的读取权限的加密策略系统，可以排除消息排队服务器的管理员访问消息排队系统的数据库中的指定话题中的经加密的消息；该控制不是被简单地委托给消息生产者，而是通过加密策略系统来控制，该加密策略系统可以独立地定义对于消息生产者和消息接收方的规则，以使得消息生产者可以简单地从与加密策略系统相关但不一定相同的密钥管理系统或服务请求加密密钥，然后在将消息传送到消息排队系统之前，可以在消息生产者一侧对该消息进行加密。；可以将消息作为话题相关消息存储在消息排队系统中，使得在消息排队系统的数据库中可以存在需要加密的话题和可能不需要任何加密的其他话题；和/或消息的生产者和/或加密数据库系统密钥用户可以保持对加密/解密处理的完全控制，使得加密没有被委托给消息排队系统操作员的操作员--并且同时可以保证话题中的消息的加密)。下面，将给出对附图的详细描述。图中的所有说明都是示意性的。首先，给出了用于在发布-订阅消息传递队列中进行有针对性的基于策略的加密的创造性的计算机实现的方法的实施例的框图。然后，将描述进一步的实施例以及用于在发布-订阅消息传递队列中进行有针对性的基于策略的加密的系统的实施例。图1是用于在发布-订阅消息队列中进行有针对性的、特别是在话题级别上有针对性的、基于策略的加密的第一实施例方法100的流程图。消息队列可以使用Kafka系统或者其他现在已知或将要开发的消息传递系统来实现。该方法包括由消息排队系统接收102经加密的消息。由此，消息已经被加密--特别是由消息生产者或相关消息产生系统通过参考加密策略系统和存储与话题相关的加密密钥的密钥管理系统进行了加密。替选地，基于策略的加密是针对类别级别的。方法100还包括存储104接收到的与话题相关的经加密的消息，以及特别地在消息消费者以发布/订阅方式请求时，基于对与消息相关的话题的订阅来发送106经加密的消息。替选地，消息类别的概念是用于组织消息和用于订阅的基础。在本公开中，术语“类别”涉及可能不容易被理解为话题的特性，诸如消息的紧急性、分类状态和洞察力水平。图2是支持图1的第一实施例方法的第一实施例系统200的示意图。消息生产者202参考加密策略系统210的加密策略，以用于确定是否必须加密关于特定话题的消息。消息生产者202从密钥管理系统212接收消息的加密密钥，无论是并行地还是经请求地，其中密钥管理系统经由访问控制模块213来授权访问。在该示例中，消息生产者可以使用密钥管理API214与密钥管理系统进行交互。密钥管理系统和加密策略系统经由访问控制模块211和213把密钥访问事务和策略改变记录到日志记录系统216。记录可以包括接收到的请求、接受、拒绝、相应的时间戳、授权级别、所搜索的话题和/或所提供的密钥。密钥管理系统还可以针对生产者和消费者管理对特定话题的访问控制。然后，消息以特定的加密形式被发送到消息代理器204，以用于将加密形式的消息存储为文件系统206中的指定话题或类别。在本发明的一些实施例中，文件系统206是Kafka集群的形式。在本发明的一些实施例中，加密和解密在代理器级别上执行，使得密钥访问在代理器处被合并。在发布/订阅模式中，代理器204向消费者发送与由消费者208订阅的话题相关的经加密的消息。响应于接收到消息，消费者208向加密策略系统210进行检查以确定与所订阅的话题相关的消息是否被加密。如果被加密，则消费者经请求而接收与上述加密密钥相关的解密密钥，其中使用订阅的话题作为密钥管理系统212的输入参数来进行请求。可以注意到，加密/解密可以是对称的或非对称的。加密/解密机制可以符合AES-256高级安全标准，或者密钥可以与任何其它合适的加密标准相兼容。在本发明的一些实施例中，代理器是消息排队系统。在本发明的一些实施例中，将密钥管理系统作为密钥管理服务来操作。在接收到解密密钥时，消息消费者使用消息消费者208的解密接口209和接收到的解密密钥来解密接收到的消息。图3是处理300的流程图，该处理300包括使用图2的第一实施例系统来实现第一实施例方法的至少部分的活动。在初始步骤302中，消息生产者准备经由代理器204向文件系统206发送被分配了订阅话题的消息。在发送之前，生产者以所订阅的话题作为输入变量来咨询304加密策略系统210。在该示例中，结果是所订阅的话题需要根据加密策略系统或数据库进行加密。然后，生产者向密钥管理系统212请求在加密策略中提及的加密密钥。假设在密钥管理服务处的访问控制策略允许生产者对密钥的访问--即允许生产者向文件系统发送针对指定话题的消息--则由密钥管理服务在对生产者的请求响应中返回密钥。同时，生产者的密钥请求被记录在日志记录系统216中的审计跟踪中。接着，306，生产者使用从密钥管理系统检索到的密钥对传出的消息主体进行加密，并且经由代理器204将消息发送到指定话题下的文件系统206。代理器接收308消息，并且以加密形式将消息存储在文件系统的有针对性的话题中。然后，代理器从消费者接收310关于指定话题的消息的请求。消费者请求被存储在诸如日志记录系统216之类的消息日志记录系统中。日志记录系统通过访问控制模块213与密钥管理系统212相关联，并且通过访问控制模块211与加密策略系统210相关联，以作为单个系统，使得在同一系统内对策略和访问进行跟踪。替选地，单独的日志记录系统可以与这两个系统相关联。代理器通过发送在步骤308中从生产者接收到的消息来响应该请求。在步骤314，消费者接收加密形式的被分配了指定话题的消息。然后，消费者检查或咨询316加密策略数据库系统以确定与话题相关的消息是否被加密，并且如果是，则从密钥管理系统请求解密该消息所需的密钥。在消费者从密钥管理系统接收到318解密密钥之后，消费者系统解密接收到的消息。在前面，在密钥管理系统或加密策略系统处，已经验证了消费者根据访问控制策略被允许接收解密密钥。应当注意，提出请求的消费者被禁止使用各自的审计服务、活动跟踪器、日志记录系统和/或经排序的追踪。最后，消费者使用从密钥管理系统接收到的密钥来解密消息。出于完整性原因，图4是用于在发布/订阅消息队列中进行有针对性的基于策略的加密的第一实施例系统的机器逻辑部分400的示意图。机器逻辑部分包括适于接收经加密的消息的消息排队系统402，其中，该消息已经通过参考加密策略系统404和存储与话题相关的加密密钥的密钥管理系统406进行了加密。此外，消息可以由生产者的加密系统来加密。机器逻辑部分还可以包括用于在数据库408中存储接收到的与话题相关的经加密的消息的装置，即，一组消息可以存储在一个话题下或与一个话题相关，而另一组消息可以存储在另一话题下或与另一话题相关。数据库408可以链接到消息排队系统402，或者可以是其物理部分。最后，机器逻辑部分包括用于基于对消息的所分配的话题的订阅将经加密的消息发送给消费者的装置。该发送可以被定向到装备有解密系统的消息接收方。本发明的一些实施例可以包括以下特征、特性和/或优点中的一个或多个：消息排队系统可以是Kafka系统，特别是版本0.9.0或更高版本的系统，并且当实施本发明的各种实施例时可以部署任何其他消息排队系统；本发明的方法可以与底层消息排队系统无关；该方法还可以包括在发送话题相关消息之前由消息生产者参考加密策略系统，使得消息生产者可以确定是否应当在将与特定话题相关的消息发送到消息排队系统之前对其进行加密；该方法可以包括：在由消息生产者确定加密策略数据库包括实施对话题相关消息的加密的规则时--即基于所选择的话题--如果消息生产者被允许从密钥管理系统接收加密密钥，则从密钥管理系统接收加密密钥，其中加密密钥可能已经由消息生产者从密钥管理系统请求；密钥管理系统和加密策略系统可以在同一安全系统中实现；和/或可以在不同位置处访问密钥管理系统和加密策略系统。本发明的一些实施例可以包括以下特征、特性和/或优点中的一个或多个：如下操作，其中在由消息消费者接收到所发送的消息--特别是从消息排队系统发送的消息时--参考加密策略系统并且确定接收到的消息是否已被加密，其中可以使得消息消费者能够区分来自消息排队系统的经加密的消息和未加密的消息，并且可以使得消息接收方无法区别地对待它们；如下操作，其中在确定接收到的消息被加密时，特别是在相关请求之后，由消息消费者特别是从密钥管理系统接收解密密钥，其中解密密钥应当与消息已经被加密的加密密钥相关，并且因为密钥可以按照话题来存储，所以消息接收方可以通过参考话题来请求解密密钥，然后消息接收方可以使用接收到的解密密钥来解密接收到的消息；加密/解密密钥可以用于对称加密或非对称加密；对加密策略系统的访问进行日志记录的操作；对密钥管理系统的访问进行日志记录的操作，使得可以对于加密策略系统以及密钥管理系统建立安全审计追踪，并且可以在任何时间点跟踪所有访问、密钥检索和改变，包括未经授权的用户或系统的访问尝试；无论发送到消息消费者的消息是否已经被解密，都可以跟踪所有访问、密钥检索和改变；由消息排队系统接收到的经加密的消息可以被数字签名；和/或由消息排队系统接收到的经加密的消息包括消息认证码，特别是HMAC，以确保经加密的消息的签名者的完整性以及消息的完整性。图5示出了描述根据本发明的第二方法的流程图600。处理开始于步骤S602，其中密钥管理系统确定第一加密级别。加密级别是指加密的类型和/或程度。根据加密策略，在基于话题的列表上提供加密级别。根据消息的相关联的话题对该消息进行加密。处理进行到步骤S604，其中密钥管理系统向希望将消息存储在诸如Kafka之类的消息排队系统的文件系统中的用户提供加密密钥。在本发明的一些实施例中，对密钥访问进行控制，使得在提供密钥之前必须对用户进行认证。处理进行到步骤S606，其中密钥管理系统存储经加密的消息。用户对与给定话题相关联的消息进行加密，并且将经加密的消息提供给代理器，以将经加密的消息存储在消息排队系统的文件系统中。处理进行到步骤S608，其中密钥管理系统接收对经加密的消息的请求。消费者可以订阅消息排队系统并且选择某些感兴趣的话题。当存储与所订阅的话题相关联的消息时，消费者可以请求该消息。在本发明的一些实施例中，消费者接收关于特定话题的消息的通知，并且在通知之后提交请求。替选地，为已经订阅了特定话题的每个消费者自动地生成请求。处理进行到步骤S610，其中密钥管理系统识别与经加密的消息相对应的解密密钥。解密密钥根据话题来存储，使得对于关于特定话题的给定消息，可以经由加密策略系统来识别解密密钥。处理结束于步骤S612，其中密钥管理系统向消费者发送经加密的消息和相对应的解密密钥。在本发明的一些实施例中，将经加密的消息发送给消费者，并且在确定需要解密密钥时，将解密密钥发送给消费者。替选地，消费者接收经加密的消息，并且请求解密密钥来解密该消息。本发明的实施例实际上可以与任何类型的计算机一起实现，而不管平台是否适合于存储和/或执行程序代码。作为示例，图6示出了适合于执行与所提出的方法相关的程序代码的计算系统500。计算系统500仅是适合的计算机系统的一个示例，并且不是旨在对本文中描述的本发明的实施例的使用范围或功能提出任何限制，无论计算机系统500是否能够实现和/或执行上文阐述的任何功能。在计算机系统500中，存在可与许多其它通用或专用计算系统环境或配置一起操作的组件。可适合与计算机系统/服务器500一起使用的公知的计算系统、环境和/或配置的示例包括但不限于个人计算机系统、服务器计算机系统、瘦客户端、胖客户端、手持式或膝上型设备、多处理器系统、基于微处理器的系统、机顶盒、可编程消费电子产品、网络PC、小型计算机系统、大型计算机系统、以及包括任何上述系统或设备的分布式云计算环境等。计算机系统/服务器500可以在由计算机系统500执行的诸如程序模块之类的计算机系统可执行指令的一般上下文中描述。通常，程序模块可以包括执行特定任务或实现特定抽象数据类型的例程、程序、对象、组件、逻辑、数据结构等。计算机系统/服务器500可以在分布式云计算环境中实施，其中任务由通过通信网络链接的远程处理设备来执行。在分布式云计算环境中，程序模块可以位于本地和远程计算机系统存储介质两者中，包括存储器存储设备。如图中所示，计算机系统/服务器500以通用计算设备的形式示出。计算机系统/服务器500的组件可以包括但不限于一个或多个处理器或处理单元502、系统存储器504以及将包括系统存储器504的各种系统组件耦合到处理器502的总线506。总线506是表示若干种类型的总线结构中的任何一种或多种的通信结构，包括存储器总线或存储器控制器、外围总线、加速图形端口、以及使用各种总线体系结构中的任何一种的处理器或局部总线。作为示例而非限制，这样的体系结构包括工业标准体系结构总线、微通道体系结构总线、增强型ISA总线、视频电子技术标准协会局部总线和外围部件互连总线。计算机系统/服务器500通常包括各种计算机系统可读介质。这样的介质可以是可由计算机系统/服务器500访问的任何可用介质，并且它包括易失性和非易失性介质、可移动和不可移动介质。系统存储器504可以包括易失性存储器形式的计算机系统可读介质，诸如随机存取存储器508和/或高速缓冲存储器510。计算机系统/服务器500还可以包括其他可移动/不可移动、易失性/非易失性计算机系统存储介质。仅作为示例，存储系统512可被提供用于从不可移动、非易失性磁介质读取并且向其写入。尽管未示出，但是可以提供用于从可移动、非易失性磁盘读取并且向其写入的磁盘驱动器，以及用于从诸如CD-ROM、DVD-ROM或其它光学介质之类的可移动、非易失性光盘读取或向其写入的光盘驱动器。在这样的情况下，每个都可以通过一个或多个数据介质接口连接到总线506。如下面将进一步描绘和描述的，存储器504可以包括至少一个程序产品，该程序产品具有一组程序模块，该程序模块被配置成执行本发明的实施例的功能。作为示例而非限制，具有一组程序模块516的程序/实用程序以及操作系统、一个或多个应用程序、其它程序模块和程序数据可以存储在存储器504中。操作系统、一个或多个应用程序、其它程序模块和程序数据或其某种组合中的每一个可以包括联网环境的实现方式。程序模块516通常执行如本文中所述的本发明的实施例的功能和/或方法。计算机系统/服务器500还可以与以下各项进行通信：一个或多个外部设备518，诸如键盘、指点设备、显示器520等；使得用户能够与计算机系统/服务器500进行交互的一个或多个设备；和/或使得计算机系统/服务器500能够与一个或多个其它计算设备进行通信的任何设备。这样的通信可以经由输入/输出接口514来进行。此外，计算机系统/服务器500可以经由网络适配器522与诸如局域网、通用广域网和/或公共网络之类的一个或多个网络进行通信。如所描绘的，网络适配器522可以经由总线506与计算机系统/服务器500的其他组件进行通信。应当理解，尽管未示出，但是可以结合计算机系统/服务器500使用其他硬件和/或软件组件。示例包括但不限于：微代码、设备驱动程序、冗余处理单元、外部磁盘驱动器阵列、RAID系统、磁带驱动器和数据档案存储系统等。另外，用于在发布-订阅消息传递队列中进行有针对性的基于策略的加密的系统400的至少部分可以被附接到总线系统506。整个系统400可能需要多个不同的计算系统500用于系统的不同部分，例如消息生产者系统、消息接收方系统、数据库系统、核心消息排队系统、密钥管理系统和加密策略系统。已经出于说明的目的给出了本发明的各种实施例的描述，但是其不是旨在是穷尽的或限于所公开的实施例。在不偏离所描述的实施例的范围和精神的情况下，许多修改和变化对于本领域的普通技术人员来说将是明显的。选择本文中所使用的术语以最好地解释实施例的原理、实际应用或对市场上发现的技术的技术改进，或使得本领域的其他普通技术人员能够理解本文中所公开的实施例。本发明可以被实现为系统、方法和/或计算机程序产品。计算机程序产品可以包括其上具有计算机可读程序指令的计算机可读存储介质，所述计算机可读程序指令用于使处理器执行本发明的各方面。介质可以是用于传播介质的电子、磁、光、电磁、红外或半导体系统。计算机可读介质的示例可以包括半导体或固态存储器、磁带、可移动计算机盘、随机存取存储器、只读存储器、硬磁盘和光盘。光盘的当前示例包括紧凑盘只读存储器、紧凑盘读/写、DVD和蓝光盘。计算机可读存储介质可以是有形设备，该有形设备可以保留和存储由指令执行设备使用的指令。计算机可读存储介质可以是例如但不限于电子存储设备、磁存储设备、光存储设备、电磁存储设备、半导体存储设备或前述各项的任何合适组合。计算机可读存储介质的更具体示例的非穷举列表包括以下：便携式计算机盘、硬盘、随机存取存储器、只读存储器、可擦除可编程只读存储器、静态随机存取存储器、便携式紧凑盘只读存储器、数字多功能盘、记忆棒、软盘、其上记录有指令的机械编码装置、以及前述各项的任何合适组合。如本文中所使用的计算机可读存储介质不应被解释为暂时性信号本身，诸如无线电波或其他自由传播的电磁波、通过波导或其他传输介质传播的电磁波、或通过导线传输的电信号。本文中描述的计算机可读程序指令可以从计算机可读存储介质下载到相应的计算/处理设备，或者经由网络下载到外部计算机或外部存储设备。网络可以包括铜传输电缆、光传输光纤、无线传输、路由器、防火墙、交换机、网关计算机和/或边缘服务器。每个计算/处理设备中的网络适配卡或网络接口从网络接收计算机可读程序指令，并且转发计算机可读程序指令以存储在相应计算/处理设备内的计算机可读存储介质中。用于执行本发明的操作的计算机可读程序指令可以是汇编指令、指令集架构指令、机器指令、机器相关指令、微代码、固件指令、状态设定数据、或者以一种或多种编程语言的任意组合编写的源代码或目标代码，所述编程语言包括面向对象的编程语言以及常规的过程编程语言。计算机可读程序指令可以完全在用户的计算机上执行，部分地在用户的计算机上作为独立软件包执行，部分地在用户的计算机上并且部分地在远程计算机上执行，或者完全在远程计算机或服务器上执行。在后一种情况下，远程计算机可以通过任何类型的网络或广域网)连接到用户的计算机，或者可以连接到外部计算机。在一些实施例中，为了执行本发明的各方面，包括例如可编程逻辑电路、现场可编程门阵列或可编程逻辑阵列的电子电路可以通过利用计算机可读程序指令的状态信息来执行计算机可读程序指令以使电子电路个性化。在本文中参考根据本发明的实施例的方法、装置和计算机程序产品的流程图和/或框图来描述本发明的各方面。将理解，流程图和/或框图的每个框以及流程图和/或框图中的各框的组合可以由计算机可读程序指令来实现。这些计算机可读程序指令可以被提供给通用计算机、专用计算机或其他可编程数据处理装置的处理器以产生机器，使得经由计算机或其他可编程数据处理装置的处理器执行的指令创建用于实现流程图和/或框图的一个或多个框中指定的功能/动作的装置。这些计算机可读程序指令还可以存储在计算机可读存储介质中，其可以引导计算机、可编程数据处理装置和/或其他设备以特定方式工作，使得其中存储有指令的计算机可读存储介质包括制品，该制品包括实现流程图和/或框图的一个或多个框中指定的功能/动作的各方面的指令。计算机可读程序指令还可以被加载到计算机、其他可编程数据处理装置或其他设备上，以使得在计算机、其他可编程装置或其他设备上执行一系列操作步骤，以产生计算机实现的处理，使得在计算机、其他可编程装置或其他设备上执行的指令实现流程图和/或框图的一个或多个框中指定的功能/动作。附图中的流程图和/或框图示出了根据本发明的各种实施例的系统、方法和计算机程序产品的可能实现方式的架构、功能和操作。在这方面，流程图或框图中的每个框可以表示指令的模块、段或部分，其包括用于实现指定的逻辑功能的一个或多个可执行指令。在一些替选实现方式中，框中所提及的功能可以不按照图中所提及的顺序进行。例如，连续示出的两个框实际上可以基本上同时执行，或者这些框有时可以按照相反的顺序执行，这取决于所涉及的功能。还将注意，框图和/或流程图的每个框以及框图和/或流程图中的各框的组合可以由专用的基于硬件的系统来实现，该专用的基于硬件的系统执行指定功能或动作或执行专用硬件和计算机指令的组合。本文中使用的术语仅是为了描述特定实施例的目的，而不是旨在限制本发明。如本文中使用的，单数形式“一”、“一个”和“该”旨在也包括复数形式，除非上下文另有明确指示。还将理解，当在本说明书中使用时，术语“包括”和/或“包含”指定所陈述的特征、整体、步骤、操作、元件和/或组件的存在，但不排除一个或多个其它特征、整体、步骤、操作、元件、组件和/或其组的存在或附加。以下权利要求中的所有装置或步骤加上功能元件的对应结构、材料、动作和等同物旨在包括用于与如具体地要求保护的其它要求保护的元件组合地执行功能的任何结构、材料或动作。已经出于说明和描述的目的给出了本发明的描述，但是其不是旨在是穷举的或者将本发明限制为所公开的形式。在不偏离本发明的范围和精神的情况下，许多修改和变化对于本领域的普通技术人员来说是明显的。选择和描述实施例是为了最好地解释本发明的原理和实际应用，并且使得本领域的其他普通技术人员能够理解本发明的具有各种修改的各种实施例，如适合于预期的特定用途。一些有用的定义如下：本发明：不应被认为是绝对的指示，即由术语“本发明”所描述的主题被提交的权利要求所涵盖，或者被在专利审查之后可能最终公告的权利要求所涵盖；虽然术语“本发明”用于帮助读者获得对本文中的哪些公开被认为可能是新的总体感觉，但是如通过使用术语“本发明”所指示的，该理解是试验性的和临时的，并且随着相关信息的发展和权利要求书的潜在修改，该理解在专利审查过程中会发生改变。实施例：参见“本发明”的定义--类似警告适用于术语“实施方式”。和/或：包括端值的或；例如，A、B“和/或”C表示A或B或C中的至少一个是真的并且是可适用的。用户/订户：包括但不必限于以下：单个个体的人；具有足够智能以充当用户或订户的人工智能实体；和/或一组相关的用户或订户。模块/子模块：可操作地工作以执行某种类型的功能的任何硬件、固件和/或软件集合，而不考虑模块是否：在单个局部邻近度中；分布在广阔的区域上；在较大的软件代码内的单个邻近度中；位于单个软件代码内；位于单个存储设备、存储器或介质中；机械连接；电连接；和/或以数据通信方式连接。计算机：具有重要的数据处理和/或机器可读指令读取能力的任何设备，包括但不限于：台式计算机、大型计算机、膝上型计算机、基于现场可编程门阵列的设备、智能电话、个人数字助理、机载或插入式计算机、嵌入式设备类型的计算机、基于专用集成电路的设备。本发明的一些实施例涉及以下创造性概念中的一个或多个。一种用于在发布-订阅消息传递队列中进行有针对性的基于策略的加密的计算机实现的方法，所述方法包括由消息排队系统接收经加密的消息，其中所述消息已经通过参考加密策略系统和存储与话题相关的加密密钥的密钥管理系统进行了加密；存储接收到的经加密的消息；以及基于对所述话题的订阅来发送所述经加密的消息。消息排队系统是Kafka系统。在发布-订阅消息传递队列中进行有针对性的基于策略的加密包括如下操作：在发送话题相关消息之前由消息生产者参考加密策略系统。在发布-订阅消息传递队列中进行有针对性的基于策略的加密包括如下操作：由消息生产者确定加密策略数据库包括实施对话题相关消息的加密的规则，并且如果消息生产者被允许接收加密密钥，则从密钥管理系统接收加密密钥。在同一安全系统中实现密钥管理系统和加密策略系统。可在不同位置处访问密钥管理系统和加密策略系统。在发布-订阅消息传递队列中进行有针对性的基于策略的加密包括如下操作：在由消息消费者接收到所发送的消息时，参考加密策略系统并且确定接收到的消息是否被加密。在发布-订阅消息传递队列中进行有针对性的基于策略的加密包括如下操作：在确定接收到的消息被加密时，由消息消费者接收解密密钥；以及对接收到的消息进行解密。在发布-订阅消息传递队列中进行有针对性的基于策略的加密包括对加密策略系统的访问进行日志记录的操作。在发布-订阅消息传递队列中进行有针对性的基于策略的加密包括对密钥管理系统的访问进行日志记录的操作。由消息排队系统接收到的经加密的消息被数字签名。由消息排队系统接收到的经加密的消息包括消息认证码。一种用于在发布-订阅消息传递队列中进行有针对性的基于策略的加密的计算机系统，所述计算机系统包括：消息排队系统，所述消息排队系统适于接收经加密的消息，其中所述消息已经通过参考加密策略系统和存储与话题相关的加密密钥的密钥管理系统进行了加密；用于存储接收到的经加密的消息的装置；以及用于基于对所述话题的订阅来发送所述经加密的消息的装置。一种用于在发布-订阅消息传递队列中进行有针对性的基于策略的加密的计算机系统，其中消息生产者适于：在确定加密策略数据库包括实施对话题相关消息的加密的规则时，如果消息生产者被允许接收加密密钥，则从密钥管理系统接收加密密钥。
