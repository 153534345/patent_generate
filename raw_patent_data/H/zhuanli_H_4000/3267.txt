标题title
一种获取交互信息的方法、系统及芯片
摘要abst
本发明公开了一种获取交互信息的方法、系统及芯片，涉及信息传输技术领域，其中所述方法包括：云应用服务器识别解码后的输入信息是否为正常状态或非正常状态；若为非正常状态，则调用云应用服务器中缓存的第一帧图像，计算其与第二帧图像之间的差值后，判断输入内容为文字元素或字符画元素，将其进行标记后通过输入内容套接字上传给后台服务器。通过本发明，使云应用服务器通过对发送图像帧和接收图像帧求差得到输入信息的轮廓，并通过人工智能方式判断输入信息类型以及采取对应方式提取保存和向后台服务器上传输入内容，使后台服务器可以正确显示所有类型的输入信息，解决用户交互信息传输的准确性问题，提高云应用使用过程中的用户体验。
权利要求书clms
1.一种获取交互信息的方法，所述方法包括：客户端捕捉用户在本地的操作，当检测到输入法触发操作时，向云应用服务器发起输入请求；所述云应用服务器接受所述输入请求后向所述客户端发送携带输入标签的第一帧图像数据包，所述云应用服务器将第一帧图像进行缓存，所述客户端接受并解码第一帧图像获取输入标签后在前景图层中渲染出对话框结构并调用本地输入法；所述客户端检测到本地输入完毕触发提交发送时，将客户端当前屏幕图像信息保存为第二帧图像，将第二帧图像和输入信息打包成第二帧图像数据包发送给云应用服务器；所述云应用服务器对所述第二帧图像数据包进行解码，获取解码后的输入信息和第二帧图像；所述云应用服务器识别解码后的输入信息是否为正常状态或非正常状态；若为正常状态，则将所述解码后的输入信息通过输入内容套接字上传给后台服务器；若为非正常状态，则调用云应用服务器中缓存的第一帧图像，计算其与第二帧图像之间的差值后，判断输入内容为文字元素或字符画元素，通过字符识别确定输入文字，以及通过数组形式表示字符画或表情符，将文字元素或字符画元素进行标记后通过输入内容套接字上传给所述后台服务器；所述后台服务器接收到输入内容套接字，进行解码后获得输入内容字段，使用所述输入内容字段更新界面显示内容字段。2.如权利要求1所述的方法，其特征在于，云应用服务器识别解码后的输入信息是否为正常状态或非正常状态，包括：提取所述解码后的输入信息的特征信息，将所述特征信息输入至语义理解深度神经网络模型中，根据所述深度神经网络的输出判断输入信息是否为正常状态；当根据所述语义理解深度神经网络模型的输出判断输入信息是否为非正常状态时，所述云应用服务器读取缓存中的第一帧图像，计算其与将解码后的第二帧图像之间的差值，将所述差值输入至文字输入异常深度神经网络模型中，根据文字输入异常深度神经网络模型的输出判断文字输入异常类型；所述文字输入异常类型包括文字乱码、字符画或表情符。3.如权利要求2所述的方法，其特征在于，当所述文字输入异常类型为文字乱码时，通过字符识别确定输入文字；当所述文字输入异常类型为字符画或者表情符时，通过数组形式表示字符画或表情符。4.如权利要求1所述的方法，其特征在于，在所述第一帧图像数据包中设置至少两个数据域，所述两个数据域分别用来承载第一帧图像数据和输入标签，并在数据包头中指示两个数据域的数据量大小，客户端解码所述第一帧图像数据包的包头获得非零数据量的输入标签数据域时，表明有输入信息获取的指示信息，所述客户端在前景图层中渲染出对话框结构并调用本地输入法。5.如权利要求4所述的方法，其特征在于，所述第一帧图像数据包用于承载输入标签的数据域中还包括用户预设的输入风格标签，所述客户端根据所述输入风格标签在前景图层中渲染出对话框结构。6.如权利要求1所述的方法，其特征在于，所述云应用服务器接收和解码客户端发送的第二帧图像数据包，所述第二帧图像数据包中至少包括两个数据域，所述两个数据域分别用于承载第二帧图像和输入信息，所述第二帧图像数据包的两个数据域都不能为空，否则云应用服务器指示客户端重传第二帧图像数据包。7.如权利要求1所述的方法，其特征在于，将文字元素或字符画元素进行标记后通过输入内容套接字上传给所述后台服务器包括：按照用户输入的先后顺序给不同的元素进行标号。8.如权利要求1所述的方法，其特征在于，当前服务存续期间，当满足多次返回的结果都为正常达到兼容性合格条件时，所述云应用服务器更改输入指令设置，向客户端发出指示客户端不再通过第二帧图像数据包发送输入信息，改用输入信息数据包发送所述输入信息。9.一种获取交互信息的系统，所述系统包括客户端，云应用服务器，后台服务器，其中所述客户端用于执行权利要求1-8任一项中客户端对应的所述方法，所述云应用服务器用于执行权利要求1-8任一项中云应用服务器对应的所述方法，所述后台服务器用于执行权利要求1-8任一项中后台服务器对应的所述方法。10.一种获取交互信息的芯片，用于执行计算机可读存储介质中的程序代码以实现权利要求1-8任一项中客户端的所述方法，或者用于执行计算机可读存储介质中的程序代码以实现权利要求1-8任一项中云应用服务器的所述方法；用于执行计算机可读存储介质中的程序代码以实现权利要求1-8任一项中后台服务器的所述方法。
说明书desc
技术领域本发明属于信息传输技术领域，尤其涉及一种获取交互信息的方法、系统及芯片。背景技术现有的云应用网络架构下，后台服务器提供全局数据存储处理，云应用服务器和客户端之间交互，部分之前全部需要由客户端处理和存储的数据在云应用架构下可以由云应用服务器进行处理，客户端捕捉用户操作后通过网络发送到云应用服务器进行交互，客户端从云应用服务器接收音视频流进行解码显示。但在进行交互信息传输时，由于客户端本地安装的输入法多种多样，来自不同操作系统和不同开发源的输入法有很多存在兼容问题，云应用服务器如果直接将客户端发送的输入信息直接上传到后台服务器，后台服务器经常遇到解码显示乱码的情形。此外，很多输入法还有个性化的字符画或者表情包，输入法程序繁多而且很多输入法还支持用户自定义字符画或表情符的功能，后台通常没有办法正常获得这些字符画和表情包的形象，或者显示排序混乱无法正确展示其本身的形象，这些问题降低了用户进行交互信息传输的准确性，影响了云应用使用中的用户体验。发明内容针对上述现有技术中存在的缺陷，本发明提供一种获取交互信息的方法，所述方法包括：客户端捕捉用户在本地的操作，当检测到输入法触发操作时，向云应用服务器发起输入请求；所述云应用服务器接受所述输入请求后向所述客户端发送携带输入标签的第一帧图像数据包，所述云应用服务器将第一帧图像进行缓存，所述客户端接受并解码第一帧图像获取输入标签后在前景图层中渲染出对话框结构并调用本地输入法；所述客户端检测到本地输入完毕触发提交发送时，将客户端当前屏幕图像信息保存为第二帧图像，将第二帧图像和输入信息打包成第二帧图像数据包发送给云应用服务器；所述云应用服务器对所述第二帧图像数据包进行解码，获取解码后的输入信息和第二帧图像；所述云应用服务器识别解码后的输入信息是否为正常状态或非正常状态；若为正常状态，则将所述解码后的输入信息通过输入内容套接字上传给后台服务器；若为非正常状态，则调用云应用服务器中缓存的第一帧图像，计算其与第二帧图像之间的差值后，判断输入内容为文字元素或字符画元素，通过字符识别确定输入文字，以及通过数组形式表示字符画或表情符，将文字元素或字符画元素进行标记后通过输入内容套接字上传给所述后台服务器；所述后台服务器接收到输入内容套接字，进行解码后获得输入内容字段，使用所述输入内容字段更新界面显示内容字段。其中，云应用服务器识别解码后的输入信息是否为正常状态或非正常状态，包括：提取所述解码后的输入信息的特征信息，将所述特征信息输入至语义理解深度神经网络模型中，根据所述深度神经网络的输出判断输入信息是否为正常状态；当根据所述语义理解深度神经网络模型的输出判断输入信息是否为非正常状态时，所述云应用服务器读取缓存中的第一帧图像，计算其与将解码后的第二帧图像之间的差值，将所述差值输入至文字输入异常深度神经网络模型中，根据文字输入异常深度神经网络模型的输出判断文字输入异常类型；所述文字输入异常类型包括文字乱码、字符画或表情符。其中，当所述文字输入异常类型为文字乱码时，通过字符识别确定输入文字；当所述文字输入异常类型为字符画或者表情符时，通过数组形式表示字符画或表情符。其中，在所述第一帧图像数据包中设置至少两个数据域，所述两个数据域分别用来承载第一帧图像数据和输入标签，并在数据包头中指示两个数据域的数据量大小，客户端解码所述第一帧图像数据包的包头获得非零数据量的输入标签数据域时，表明有输入信息获取的指示信息，所述客户端在前景图层中渲染出对话框结构并调用本地输入法。其中，所述第一帧图像数据包用于承载输入标签的数据域中还包括用户预设的输入风格标签，所述客户端根据所述输入风格标签在前景图层中渲染出对话框结构。其中，所述云应用服务器接收和解码客户端发送的第二帧图像数据包，所述第二帧图像数据包中至少包括两个数据域，所述两个数据域分别用于承载第二帧图像和输入信息，所述第二帧图像数据包的两个数据域都不能为空，否则云应用服务器指示客户端重传第二帧图像数据包。其中，将文字元素或字符画元素进行标记后通过输入内容套接字上传给所述后台服务器包括：按照用户输入的先后顺序给不同的元素进行标号。其中，当前服务存续期间，当满足多次返回的结果都为正常达到兼容性合格条件时，所述云应用服务器更改输入指令设置，向客户端发出指示客户端不再通过第二帧图像数据包发送输入信息，改用输入信息数据包发送所述输入信息。本发明还提出了一种基于上述方法的一种获取交互信息的系统，所述系统包括客户端，云应用服务器，后台服务器，其中所述客户端用于执行客户端对应的方法，所述云应用服务器用于执行云应用服务器对应的方法，所述后台服务器用于执行后台服务器对应的方法。本发明还提出了一种基于上述系统的获取交互信息的芯片，用于执行计算机可读存储介质中的程序代码以实现客户端的数据处理方法，或者用于执行计算机可读存储介质中的程序代码以实现云应用服务器的数据处理方法；用于执行计算机可读存储介质中的程序代码以实现后台服务器的数据处理方法。与现有技术相比，客户端在发送输入字符信息的同时上传字符发送时刻的图像帧，使得云应用服务器可以通过对发送图像帧和接收图像帧求差快速得到输入信息的轮廓，并通过人工智能方式来判断输入信息类型以及采取对应的方式提取保存和向后台服务器上传输入内容。通过实施本发明，使得后台服务器可以正确显示所有类型的输入信息，解决了用户交互信息传输的准确性问题，提高了云应用使用过程中的用户体验。附图说明通过参考附图阅读下文的详细描述，本公开示例性实施方式的上述以及其他目的、特征和优点将变得易于理解。在附图中，以示例性而非限制性的方式示出了本公开的若干实施方式，并且相同或对应的标号表示相同或对应的部分，其中：图1是示出根据本发明实施例的一种获取交互信息的方法流程图；图2是示出根据本发明实施例的一种获取交互信息的系统的示意图。具体实施方式为了使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作进一步地详细描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。在本发明实施例中使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本发明。在本发明实施例和所附权利要求书中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义，“多种”一般包含至少两种。应当理解，本文中使用的术语“和/或”仅仅是一种描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。另外，本文中字符“/”，一般表示前后关联对象是一种“或”的关系。取决于语境，如在此所使用的词语“如果”、“若”可以被解释成为“在……时”或“当……时”或“响应于确定”或“响应于检测”。类似地，取决于语境，短语“如果确定”或“如果检测”可以被解释成为“当确定时”或“响应于确定”或“当检测时”或“响应于检测”。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的商品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种商品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的商品或者装置中还存在另外的相同要素。下面结合附图详细说明本发明的可选实施例。实施例一、如图1所示，本发明公开了一种获取交互信息的方法，所述方法包括：客户端捕捉用户在本地的操作，当检测到输入法触发操作时，向云应用服务器发起输入请求；所述云应用服务器接受所述输入请求后向所述客户端发送携带输入标签的第一帧图像数据包，所述云应用服务器将第一帧图像进行缓存，所述客户端接受并解码第一帧图像获取输入标签后在前景图层中渲染出对话框结构并调用本地输入法；所述客户端检测到本地输入完毕触发提交发送时，将客户端当前屏幕图像信息保存为第二帧图像，将第二帧图像和输入信息打包成第二帧图像数据包发送给云应用服务器；所述云应用服务器对所述第二帧图像数据包进行解码，获取解码后的输入信息和第二帧图像；所述云应用服务器识别解码后的输入信息是否为正常状态或非正常状态；若为正常状态，则将所述解码后的输入信息通过输入内容套接字上传给后台服务器；若为非正常状态，则调用云应用服务器中缓存的第一帧图像，计算其与第二帧图像之间的差值后，判断输入内容为文字元素或字符画元素，通过字符识别确定输入文字，以及通过数组形式表示字符画或表情符，将文字元素或字符画元素进行标记后通过输入内容套接字上传给所述后台服务器；所述后台服务器接收到输入内容套接字，进行解码后获得输入内容字段，使用所述输入内容字段更新界面显示内容字段。通常情况下，用户在输入信息时不会同时进行其他操作，客户端接受的第一帧图像后，与第二帧图像不会发生除输入框和输入内容之间的变化，因此对第一帧图像和第二帧图像求差后，就可以获得输入信息的轮廓信息，此时判断轮廓信息对应的输入类型，通过OCR技术识别出文字，用OCR识别出来的文字使用云应用服务器和后台服务器支持的解码方式进行字符由云应用服务器向后台服务器进行传输；或者判断出是字符画或者表情符的时候，可以通过数组形式来存储，如可以将字符和表情以RGB矩阵形式进行存储。如果用户在输入信息时背景会发生变化，如有其他动态元素进行显示的时候，仍然可以将第一帧图像和第二帧图像求差，再通过特征点比对来找到对应的输入对话框轮廓，云应用服务器中有用户预设的输入风格标签和对应的对话框模板样式，根据对话框轮廓和对应的对话框模板样式可以快速定位到对话框区域，然后再对该区域进行分析确定对应的输入类型。在某一实施例中，所述输入类型包括文字、字符画、表情符中的至少一个或两个以上的组合。在某一实施例中，云应用服务器识别解码后的输入信息是否为正常状态或非正常状态，包括：提取所述解码后的输入信息的特征信息，将所述特征信息输入至语义理解深度神经网络模型中，根据所述深度神经网络的输出判断输入信息是否为正常状态；当根据所述语义理解深度神经网络模型的输出判断输入信息是否为非正常状态时，所述云应用服务器读取缓存中的第一帧图像，计算其与将解码后的第二帧图像之间的差值，将所述差值输入至文字输入异常深度神经网络模型中，根据文字输入异常深度神经网络模型的输出判断文字输入异常类型；所述文字输入异常类型包括文字乱码、字符画或表情符。对输入信息进行特征提取，特征信息可以为word2vector即w2v特征，在离线阶段，将打标的互动信息进行特征提取后训练得到输入异常深度神经网络模型，在在现阶段，对接收到的输入信息进行特征提取后放到输入异常深度神经网络模型中，根据输出结果确定该输入信息是正常的输入信息，还是异常的不具有任何语义表达的乱码或者是字符画等等。此外，还可以通过语义信息进行分析，根据需要过滤掉其中具有不恰当言论表达的内容，使得网络环境更加健康。在离线阶段，将各类形式的输入类型和异常情况的图像帧差值进行打标，作为训练数据，得到文字输入异常深度神经网络模型；在线阶段时将实时计算得到的图形帧差值作为输入，即可得到异常类型。字符画显示中常遇到的问题为虽然是字符，且以字符方式可以传输，但不同的显示界面差异较大，本地形成特定含义的字符画可能被后台服务器同步到其他客户端的交互信息时就完全变形如同乱码，或者跟显示尺寸不匹配，需要多页显示或者每行字符数不同排版混乱影响用户阅读和理解互动信息的内容。在某一实施例中，当所述文字输入异常类型为文字乱码时，通过字符识别确定输入文字；当所述文字输入异常类型为字符画或者表情符时，通过数组形式表示字符画或表情符。在某一实施例中，在所述第一帧图像数据包中设置至少两个数据域，所述两个数据域分别用来承载第一帧图像数据和输入标签，并在数据包头中指示两个数据域的数据量大小，客户端解码所述第一帧图像数据包的包头获得非零数据量的输入标签数据域时，表明有输入信息获取的指示信息，所述客户端在前景图层中渲染出对话框结构并调用本地输入法。在某一实施例中，所述第一帧图像数据包用于承载输入标签的数据域中还包括用户预设的输入风格标签，所述客户端根据所述输入风格标签在前景图层中渲染出对话框结构。对话框结构可以是用户个性化的，如个性化的轮廓、颜色、字体等等，对应的云应用服务器中也可以存储有对应用户选择确定的对话框模板。在某一实施例中，所述云应用服务器接收和解码客户端发送的第二帧图像数据包，所述第二帧图像数据包中至少包括两个数据域，所述两个数据域分别用于承载第二帧图像和输入信息，所述第二帧图像数据包的两个数据域都不能为空，否则云应用服务器指示客户端重传第二帧图像数据包。第二帧图像数据包的两个数据域都不能为空，使得本发明的方案可以正常运行得到正确的结果。在某一实施例中，将文字元素或字符画元素进行标记后通过输入内容套接字上传给所述后台服务器包括：按照用户输入的先后顺序给不同的元素进行标号。套接字是一种通信机制，可以用流套接字或者数据包套接字来上报输入内容，使用数据包套接字时，需要对不同的包进行编号，使得在接收端可以根据编号来恢复出正确顺序的输入内容。在某一实施例中，当前服务存续期间，当满足多次返回的结果都为正常达到兼容性合格条件时，所述云应用服务器更改输入指令设置，向客户端发出指示客户端不再通过第二帧图像数据包发送输入信息，改用输入信息数据包发送所述输入信息。达到兼容性合格条件，可以是接收到的输入类型为文字时解码正常，客户端可以在返回第二帧图像数据包时反馈本地所调用的输入法类型，云服务器可以查询数据库中的该输入法属性值，确定该输入法中是否包含自定义字符画功能或者其他不兼容的字符画和字符功能，否的话可以判定达到兼容性合格条件。通过实施本发明，客户端在发送输入字符信息的同时上传字符发送时刻的图像帧，使得云应用服务器可以通过对发送图像帧和接收图像帧求差快速得到输入信息的轮廓，并通过人工智能方式来判断输入信息类型以及采取对应的方式提取保存和向后台服务器上传输入内容。通过实施本发明，使得后台服务器可以正确显示所有类型的输入信息，解决了用户交互信息传输的准确性问题，提高了云应用使用过程中的用户体验。实施例二、如图2所示，本发明公开了一种基于上述方法的一种获取交互信息的系统，所述系统包括客户端，云应用服务器，后台服务器，其中所述客户端用于执行客户端对应的方法，所述云应用服务器用于执行云应用服务器对应的方法，所述后台服务器用于执行后台服务器对应的方法。通过实施本发明，客户端在发送输入字符信息的同时上传字符发送时刻的图像帧，使得云应用服务器可以通过对发送图像帧和接收图像帧求差快速得到输入信息的轮廓，并通过人工智能方式来判断输入信息类型以及采取对应的方式提取保存和向后台服务器上传输入内容。通过实施本发明，使得后台服务器可以正确显示所有类型的输入信息，解决了用户交互信息传输的准确性问题，提高了云应用使用过程中的用户体验。实施例三、本发明还提出了一种基于上述系统的获取交互信息的芯片，用于执行计算机可读存储介质中的程序代码以实现客户端的数据处理方法，或者用于执行计算机可读存储介质中的程序代码以实现云应用服务器的数据处理方法；用于执行计算机可读存储介质中的程序代码以实现后台服务器的数据处理方法。需要说明的是，本公开上述的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本公开中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本公开中，计算机可读信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读信号介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：电线、光缆、RF等等，或者上述的任意合适的组合。上述计算机可读介质可以是上述电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。可以以一种或多种程序设计语言或其组合来编写用于执行本公开的操作的计算机程序代码，上述程序设计语言包括面向对象的程序设计语言—诸如Java、Smalltalk、C++，还包括常规的过程式程序设计语言—诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算机上执行、部分地在用户计算机上执行、作为一个独立的软件包执行、部分在用户计算机上部分在远程计算机上执行、或者完全在远程计算机或服务器上执行。在涉及远程计算机的情形中，远程计算机可以通过任意种类的网络——包括局域网或广域网—连接到用户计算机，或者，可以连接到外部计算机。附图中的流程图和框图，图示了按照本公开各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。在这点上，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，该模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图和/或流程图中的每个方框、以及框图和/或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本公开实施例中所涉及到的单元可以通过软件的方式实现，也可以通过硬件的方式来实现。其中，单元的名称在某种情况下并不构成对该单元本身的限定。以上介绍了本发明的较佳实施方式，旨在使得本发明的精神更加清楚和便于理解，并不是为了限制本发明，凡在本发明的精神和原则之内，所做的修改、替换、改进，均应包含在本发明所附的权利要求概括的保护范围之内。
