标题title
微显示动态补偿方法及系统
摘要abst
本发明涉及一种微显示动态补偿方法及系统。该系统包括：将视频源数据交替缓存到奇数帧缓存区和偶数帧缓存区；采用可配置的特征提取标记模块对帧缓存区内的像素数据进行特征提取及标记，获得特征集；通过对奇数帧特征集1和偶数帧特征集2进行比对，锁定动态目标位置部分信息，再通过边缘检测，标记完整的目标，并更新特征提取标记窗；在一帧的消隐区内根据动态目标位置信息索引对应像素，并存储在动态目标缓存区；解析后，输出帧控制模块按照上一帧，插入融合帧或复制帧，当前帧的序列，输出物理像素点的像素值进行显示。本发明可使微显示系统在显示有快速移动目标的视频源时减弱拖影现象，达到提升视频源显示清晰流畅度的目的，提升观看体验。
权利要求书clms
1.一种微显示动态补偿方法，其特征在于，所述方法包括：S1、数据提取；根据显示方式对输入的视频源数据进行格式转换，获得转换后的数据流，将数据流交替缓存到奇数帧缓存区和偶数帧缓存区；S2、数据标记；采用可配置的特征提取标记模块选定的提取标记模式对奇数帧缓存区和偶数帧缓存区内的像素数据进行运算处理，分别获得特征集1和特征集2；S3、数据补全并更新特征提取标记模块中的特征提取标记窗；通过对特征集1和特征集2进行比对，得到动态目标的初始信息，然后进行边缘检测，得到完整目标的位置信息，更新特征提取标记模块中的特征提取标记窗；S4、索引像素值；在一帧的消隐区内，根据动态目标位置信息，索引对应的像素值，缓存到动态目标缓存区；S5、像素显示；对S4中动态目标缓存区的数据进行解析，输出物理像素点的像素值进行显示。2.根据权利要求1所述的方法，其特征在于，所述特征：在S3中，特征提取标记窗，在初始设置后，根据动态目标大小自动更新，m*n分辨率的视频源，按照i*j的特征窗提取特征值，其中i≤m,j≤n,i*j≤m*n。3.根据权利要求2所述的方法，其特征在于，在S3中，特征提取标记模块获得完整目标的位置信息的方式为：特征集比对和/或边缘检测；其中特征标记的内容包括：动态目标边缘位置信息、移动的速度及方向中的一种或几种；移动的速度为按照帧率计算的移动的像素个数，以便在插入的帧中确定移动目标的位置；目标搜素的成本可根据场景进行优化。4.根据权利要求1所述的方法，其特征在于，S5中，输出帧控制模块根据插入融合帧进行判别，选择输出帧的样式；判别方法如下：对于1920*1080分辨率，出口120Hz帧率，1920/120 = 16，移动16个像素以上的，才进行插入融合帧 ；对于1920*1080分辨率，出口240Hz帧率，1920/240 = 8，移动8个像素以上的，才进行插入融合帧；对于1280*720分辨率，出口120Hz帧率，1280/120 = 10.6，移动11个像素以上的，才进行插入融合帧；在场景切换的时候，直接复制前一帧进行输出即可。5.据权利要求4所述的方法，其特征在于，所述输出帧的样式为：上一帧，插入融合帧或复制帧，当前帧的序列。6.根据权利要求1所述的方法，其特征在于，视频源数据流的输出帧率大于输入帧率。7.根据权利要求6所述的方法，其特征在于，所述输出帧率为120Hz或360Hz或720Hz。8.根据权利要求1所述的方法，其特征在于，转换后的数据流对应的显示格式为空间彩色和时序彩色中的任意一种。9.一种微显示动态补偿系统，其特征在于，所述系统包括：寄存器配置模块、数据格式转换模块、特征提取标记模块、存储模块、解析模块、输出帧控制模块和微显示芯片模块；所述寄存器配置模块，用于配置特征提取标记窗大小、特征提取标记方法、动态目标缓存区和输出帧控制模式；所述数据格式转换模块，用于根据显示方式对输入的视频源数据流进行格式转换，获得转换后的数据流；所述特征提取标记模块，用于锁定动态目标，并标记位置信息；所述存储模块，用于存储奇数帧、偶数帧和动态目标；所述解析模块，用于解析处理后的数据流，并输出物理像素点的像素值到输出帧控制模块；所述输出帧控制模块，用于控制输出帧的样式，并输出物理像素点的像素值；所述微显示芯片模块，用于根据物理像素点的像素值进行显示。10.一种微显示芯片，其特征在于，包括寄存器配置模块、数据格式转换模块、特征提取标记模块、存储模块、解析模块和输出帧控制模块，所述微显示芯片执行时实现权利要求1至8中任一项所述方法的步骤。
说明书desc
技术领域本申请涉及微显示AR或VR领域，特别是涉及一种微显示动态补偿方法及系统。背景技术微显示作为AR、VR以及MR领域不可或缺的关键技术之一，显示画面的清晰度，画面的细腻程度，平滑流畅度，是否能捕捉到更多的动作细节，均对观看使用体验影响很大。在目前高帧率视频源内容缺乏的情况下，可用于提升观看使用体验的技术手段十分必要，如影片中原本眼花缭乱难以辨别的搏斗场面变得顺畅清晰；观看足球或者赛车竞速等体育赛事类节目时，画面的流畅度会得到质的提升，晃动感也会有所减弱；高帧率游戏画面能捕捉到更多的动作细节等。不过现有技术对于微显示并不适用，在微显示领域，微显示相对于传统显示有体积小、分辨率高等优势，但对性能、续航、散热更加看重。平衡好观看使用体验与续航、散热，芯片面积等是关键。因此，目前的微显示芯片不支持对静态场景下有高速移动物体时会出现不连贯、模糊等现象进行优化显示处理，使用体验差。发明内容基于此，有必要针对上述技术问题，提供一种能够改善在静态场景下有高速移动物体时会出现不连贯、模糊等现象的显示效果，使得画面过渡平滑流畅，清晰细腻。一种微显示动态补偿方法，所述方法包括如下步骤：所述方法包括：S1、数据提取；根据显示方式对输入的视频源数据进行格式转换，获得转换后的数据流，将数据流交替缓存到奇数帧缓存区和偶数帧缓存区；S2、数据标记；采用可配置的特征提取标记模块选定的提取标记模式对奇数帧缓存区和偶数帧缓存区内的像素数据进行运算处理，分别获得特征集1和特征集2；S3、数据补全并更新特征提取标记模块中的特征提取标记窗；通过对特征集1和特征集2进行比对，得到动态目标的初始信息，然后进行边缘检测，得到完整目标的位置信息，更新特征提取标记模块中的特征提取标记窗；S4、索引像素值；在一帧的消隐区内，根据动态目标位置信息，索引对应的像素值，缓存到动态目标缓存区；S5、像素显示；对S4中动态目标缓存区的数据进行解析，输出物理像素点的像素值进行显示。进一步的，在S3中，特征提取标记窗，在初始设置后，根据动态目标大小自动更新，m*n分辨率的视频源，按照i*j的特征窗提取特征值，其中i≤m,j≤n,i*j≤m*n。进一步的，在S3中，特征提取标记模块获得完整目标的位置信息的方式为：特征集比对和/或边缘检测；其中特征标记的内容包括：动态目标边缘位置信息、移动的速度及方向中的一种或几种；移动的速度为按照帧率计算的移动的像素个数，以便在插入的帧中确定移动目标的位置；目标搜素的成本可根据场景进行优化。进一步的，S5中，输出帧控制模块根据插入融合帧判据，选择输出帧的样式。进一步的，所述输出帧的样式为：上一帧，插入融合帧或复制帧，当前帧的序列。进一步的，视频源数据流的输出帧率大于输入帧率。进一步的，所述输出帧率为120Hz或360Hz或720Hz。进一步的，转换后的数据流对应的显示格式为空间彩色和时序彩色中的任意一种。一种微显示动态补偿系统，其特征在于，所述系统包括：寄存器配置模块，用于配置特征提取标记窗大小，输出帧率控制模式。数据格式转换模块，用于根据显示方式对输入的视频源数据流进行格式转换，获得转换后的数据流。特征提取标记模块，用于找到动态目标，并标记位置。存储模块，输入帧控制器将视频源数据依次缓存到奇数帧缓存区和偶数帧缓存区，通过对奇数帧标记集1和偶数帧标记集2进行比对，得到动态目标位置信息，在一帧的消隐区内根据动态目标位置信息查找对应像素，并存储在动态目标缓存区；解析模块，用于解析所述处理后的数据流，并输出物理像素点的像素值。输出帧控制模块，控制输出帧的样式，并输出物理像素点的像素值。微显示芯片模块，用于根据物理像素点的像素值进行显示。根据本发明的又一方面，提供了一种微显示芯片，包括寄存器配置模块、数据格式转换模块、特征提取标记模块、存储模块、解析模块和输出帧控制模块，所述微显示芯片执行时实现微显示动态补偿方法的步骤。本发明是有益效果：本发明将视频源数据交替缓存到奇数帧缓存区和偶数帧缓存区；采用可配置的特征提取标记模块对帧缓存区内的像素数据进行运算处理，获得特征集；通过对奇数帧特征集1和偶数帧特征集2进行比对，锁定动态目标位置部分信息，再通过边缘检测，标记完整的目标，得到动态目标的完整信息，并更新特征标记窗；在一帧的消隐区内根据动态目标位置信息索引对应像素，并存储在缓存区；解析后，输出帧控制模块按照上一帧，插入融合帧或复制帧，当前帧的序列，输出物理像素点的像素值进行显示。可使微显示系统在显示有快速移动目标的视频源时减弱拖影现象，达到优化提升视频源显示清晰流畅度的目的，提升观看体验，特别适用于微显示AR或VR领域中，有高速移动目标的场景会出现不连贯、模糊等现象，影响观看体验的场合。附图说明图1为本发明方法的流程示意图；图2为一个实施例中一帧1920×1080分辨率视频源的特征提取标记窗滑动的示意图；图3为一个实施例中特征比对，更新特征窗，获取完整目标信息示意图；图4为一个实施例中横向轨迹目标搜索及显示示意图；图5为一个实施例中纵向轨迹目标搜索及显示示意图；图6为一个实施例中斜向轨迹目标搜索及显示示意图；图7为一个实施例中目标像素值缓存，输出帧控制示意图；图8为一个实施例中微显示动态补偿系统的结构框图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。如图1~图8所示，本发明的微显示动态补偿方法，可以放在驱动模块中，与微显示芯片交互实现；也可以集成在微显示芯片中，作为微显示芯片的一部分，由微显示芯片执行所述显示方法。该微显示动态补偿方法可用于LCoS、OLED、MICRO-LED、Q-LED等。在一个实施例中，如图1所示，提供了一种微显示动态补偿方法，包括以下步骤：步骤S1，根据显示方式对输入的视频源数据流进行格式转换，获得转换后的数据流。其中，所述转换后的数据流对应的显示格式为空间彩色或时序彩色。格式转换包括信号类型的转换，以及输入的视频源数据流转换为所需数据格式等等，信号类型的转换可以如HDMI转RGB。然后，将数据流交替缓存到奇数帧缓存区和偶数帧缓存区。奇数帧缓存区为输入的第一帧、第三帧、第五帧...；偶数帧缓存区为输入的第二帧、第四帧、第六帧...；步骤S2，采用可配置的特征提取标记模块选定的提取标记模式对帧缓存器内的像素数据进行运算处理，获得标记特征集。需进行特征处理的视频源的分辨率表示为m*n，可以根据实际需要进行配置i*j的特征窗提取特征值，其中m、n、i、j为正整数， i≤m,j≤n,i*j≤m*n。特征提取算法包括但不限于：对原始图像进行二值化处理后，在特征窗内,按照以下公式进行运算：；特征提取标记模块，标记的内容包括但不限于动态目标移动的速度，及方向；其中速度为按照帧率计算的移动的像素个数，以便在插入的帧中确定移动目标的位置；步骤S3，通过对奇数帧特征集1和偶数帧特征集2进行比对，使用特征窗口1和特征窗口2的差异，过滤无效目标，得到有效动态目标部分位置信息，然后根据边缘检测算法得到完整目标的位置信息，将上下左右4个边缘的位置信息，反馈给特征提取标记模块，用于更新特征窗口，边缘检测算法可配置；目标移动的方向可为横向轨迹、纵向轨迹、斜向轨迹、不规则轨迹；在一个小区域内进行搜索，寻找匹配的特征窗，显然搜索区域越大计算的成本就越高，所以对于前三种规则的轨迹的场景应用，可减少定位目标的计算量，解决系统运算量，运算速度，算法复杂度之间的瓶颈。步骤S4，在一帧的消隐区内根据动态完整目标的位置信息，索引对应像素，并存储在缓存区；步骤S5，输出帧控制模块通过数据解析后的数据流输出，按照上一帧，插入融合帧或复制帧，当前帧的顺序，输出物理像素点的像素值进行显示。其中，插入融合帧或复制帧的判据：对于1920*1080分辨率，出口120Hz帧率，1920/120 = 16，移动16个像素以上的，才进行插融合帧 ；对于1920*1080分辨率，出口240Hz帧率，1920/240 = 8，移动8个像素以上的，才进行插融合帧；对于1280*720分辨率，出口120Hz帧率，1280/120 = 10.6，移动11个像素以上的，才进行插融合帧；在场景切换的时候，或者说两帧中的内容变化较大时，直接复制前一帧进行输出即可。上述方法，可提供一种能够提高在场景下有高速移动物体时会出现不连贯、模糊等现象显示效果，平滑流畅，清晰细腻。可平衡算力、功耗、微显示芯片的面积等多个因素。在一个实施例中，一种微显示动态补偿方法，以1920*1080分辨率的视频源为例进行说明，初始选择64*64的特征提取标记窗，首先进行二值化处理，使用初始特征标记窗获取第一帧奇数图像和第二帧偶数图像的特征标记集，将两帧的特征标记集依次比对，筛选无效目标，初步锁定动态目标位置部分信息，然后使用边缘检测得到完整的动态目标信息，更新特征标记窗，用于后续帧的目标预测，将完整的动态目标信息与原图像融合，得到插入融合帧，在输出帧控制模块下，按照序列输出显示。具体内容如下：如图2所示，输入一帧1920*1080分辨率的视频源的特征标记窗滑动的示意图，以左上角为原点位置，按照先横向再纵向的顺序进行滑动标记，并将每个位置的信息记录下来，包括特征值信息，位置索引信息等，存到一个255位宽512深度的ram中。在输入的第一帧缓存到奇数帧缓存区后，特征提取标记模块同时开始对此帧进行特征提取标记，记为特征集1；同时待输入的第二帧到来后，将输入的第二帧缓存到偶数帧缓存区，同时对此帧进行特征提取标记，记为特征集2；在输出端输出第一帧的信息后，再继续上述循环，做到输入与输出匹配即可；需要指出，初始设定的标记窗大小可选多种模式，包括但不限64×64、128×128。相应地，在视频源分辨率为多种，包括但不限1920×1080、1280×720。如图3所示，根据第一帧的特征集1与第二帧的特征集2进行逐一比对，比对方法为做差，设定阈值Q，大于阈值Q的向上反馈，小于阈值Q的舍弃，过滤无效目标，比如特征提取窗和特征提取窗被选中，将位置信息反馈给特征提取标记模块，启动边缘检测功能，在此位置的上下左右各2个窗口范围内进行边缘标记，识别出完整的目标边缘，得到上下左右4个极限值，用此去修正特征窗的大小，用于后面的特征窗特征提取，其中特征提取公式：其中边缘检测的运算公式为：为x方向上的检测，为y方向上的检测，检测后的结果，A为图像像素前一帧目标的位置：最左，最右，最上，最下依次为a,b,c,d,当前帧目标的位置最左，最右，最上，最下依次为，判断相邻两帧之间的位移为：插入融合帧的数量为n，则插入的第k帧目标所需融合的位置为：其中k为正整数，n。如图7所示，在一帧的消隐区内根据动态目标位置信息查找对应像素，并存储在缓存区；在芯片内部需开辟3个存储区，奇数帧缓存区，即输入的第一帧、第三帧、第五帧...；偶数帧缓存区，即输入的第二帧、第四帧、第六帧...；按照1帧频率更新，动态目标存储区，按照每2帧更新一次的频率更新；输出帧控制模块将数据解析后的数据流输出，如果满足插融合帧判据，则按照上一帧，插融合帧，当前帧的顺序输出，输出物理像素点的像素值进行显示；如果不满足插融合帧判据或特征集比对结果大于最大预设值M时，则按照上一帧，复制帧，当前帧的顺序输出，输出物理像素点的像素值进行显示；其中，根据相邻的奇数帧和相邻的偶数帧图像扣除掉目标后的图像融合在一起得到无目标融合图像A，，然后在合适的位置处将目标融合进去，得到有移动目标的融合图像B，即插帧融合图像。在一个实施例中，如图8所示，提供了微显示动态补偿系统，包括：寄存器配置模块、数据格式转换模块、存储模块、特征提取标记模块、解析模块、输出帧控制模块和微显示芯片模块。寄存器配置模块，用于配置特征提取标记窗大小、特征提取标记方法、动态目标缓存区和输出帧控制模式；数据格式转换模块，用于根据显示方式对输入的视频源数据流进行格式转换，获得转换后的数据流；特征提取标记模块，用于锁定动态目标，并标记位置信息；存储模块，用于存储奇数帧、偶数帧和动态目标；解析模块，用于解析处理后的数据流，并输出物理像素点的像素值到输出帧控制模块；输出帧控制模块，用于控制输出帧的样式，并输出物理像素点的像素值；微显示芯片模块，用于根据物理像素点的像素值进行显示。其中，寄存器配置模块、数据格式转换模块、特征提取标记模块、存储模块、解析模块和输出帧控制模块组成驱动模块，将物理像素点的像素值输出给微显示芯片模块进行显示，该驱动模块可支持但不限于RGB888接口、MIPI接口、HDMI接口和VGA等接口，通过数据转换模块转换成为内部需要使用的信号，并通过计算选择其中所需的数据输出给后面的模块。该驱动模块和该微显示芯片模块支持但不限1920*1080和1280*720的分辨率的视频源。上述微显示动态补偿系统中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的一种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
