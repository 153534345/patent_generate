标题title
一种基于空间关系的网络风险态势分析方法及系统
摘要abst
本发明涉及网络风险监测技术领域，提供了一种基于空间关系的网络风险态势分析方法及系统，包括：统计第一时段和第二时段的实体间行为频率特征矩阵，计算得到第二时段的行为频率特征变换率矩阵；对于每个实体，基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量后，结合第二时段风险变化率，更新风险变化系数；获取各实体在第三时段的行为数据，结合第二时段的行为数据和综合影响度向量，计算得到每个实体的风险量化的可信值；返回计算每个实体的风险变化率，直到风险变化系数趋向稳定，输出每个实体的风险量化的可信值。解决了目前实体风险评估相对孤立的问题，使得实体的量化风险评估更具可信性。
权利要求书clms
1.一种基于空间关系的网络风险态势分析方法，其特征在于，包括：获取各实体在第一时段和第二时段的行为数据，计算得到每个实体的第二时段风险变化率；统计第一时段和第二时段的实体间行为频率特征矩阵，计算得到第二时段的行为频率特征变换率矩阵；对于每个实体，基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量后，结合第二时段风险变化率，更新风险变化系数；获取各实体在第三时段的行为数据，结合第二时段的行为数据和综合影响度向量，计算得到每个实体的风险量化的可信值；返回计算每个实体的风险变化率，直到风险变化系数趋向稳定，输出每个实体的风险量化的可信值。2.如权利要求1所述的一种基于空间关系的网络风险态势分析方法，其特征在于，所述风险变化率的计算方法为：基于各实体在第一时段的行为数据，计算获得第一时段的风险量化值；基于各实体在第二时段的行为数据，计算获得第二时段的风险量化值，并结合第一时段的风险量化值，计算得到每个实体的风险变化率。3.如权利要求2所述的一种基于空间关系的网络风险态势分析方法，其特征在于，所述每个实体的风险变化率为：其中，表示实体xi在第二时段Tt+1的风险量化值，表示实体xi在第一时段Tt的风险量化值。4.如权利要求1所述的一种基于空间关系的网络风险态势分析方法，其特征在于，某实体的实体间行为频率特征矩阵中的元素为，针对该实体，在一时段内其余实体做为各行为的主体的次数。5.如权利要求1所述的一种基于空间关系的网络风险态势分析方法，其特征在于，所述风险变化系数的更新方法为：基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量；基于综合影响度向量，计算整体风险影响度；对于每个实体，将整体风险影响度与第二时段风险变化率的比值作为风险变化系数。6.如权利要求1所述的一种基于空间关系的网络风险态势分析方法，其特征在于，所述每个实体的风险量化的可信值为第三时段风险量化值与风险量化预估值的平均数。7.一种基于空间关系的网络风险态势分析系统，其特征在于，包括：第一计算模块，其被配置为：获取各实体在第一时段和第二时段的行为数据，计算得到每个实体的风险变化率；第二计算模块，其被配置为：统计第一时段和第二时段的实体间行为频率特征矩阵，计算得到第二时段的行为频率特征变换率矩阵；第三计算模块，其被配置为：对于每个实体，基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量后，结合第二时段风险变化率，更新风险变化系数；第四计算模块，其被配置为：获取各实体在第三时段的行为数据，结合第二时段的行为数据和综合影响度向量，计算得到每个实体的风险量化的可信值；输出模块，其被配置为：返回计算每个实体的风险变化率，直到风险变化系数趋向稳定，输出每个实体的风险量化的可信值。8.如权利要求7所述的一种基于空间关系的网络风险态势分析系统，其特征在于，所述每个实体的风险量化的可信值为第三时段风险量化值与风险量化预估值的平均数。9.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，该程序被处理器执行时实现如权利要求1-6中任一项所述的一种基于空间关系的网络风险态势分析方法中的步骤。10.一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述程序时实现如权利要求1-6中任一项所述的一种基于空间关系的网络风险态势分析方法中的步骤。
说明书desc
技术领域本发明属于网络风险监测技术领域，尤其涉及一种基于空间关系的网络风险态势分析方法及系统。背景技术本部分的陈述仅仅是提供了与本发明相关的背景技术信息，不必然构成在先技术。随着网络安全技术的不断进步，各类网络风险评估技术得到普遍发展和应用。而态势感知技术目前已成为网络安全技术的重要组成部分，该技术可以帮助安全人员从整体监测组织内资产个体或群组的风险状况。基于网络内资产的安全要素数据，如何进行更准确和动态的风险评估与监测，成为了各类态势感知技术的重点研究内容。现有网络风险态势的分析方法，一般是基于收集到资产实体的行为数据，围绕单个或单类资产实体，形成行为的分布特征，然后在多个评估维度，如脆弱性、威胁性、影响力等，构建具体的量化计算方法，实现对资产个体或群组风险态势的分析与评估。这些具体的量化计算方法，通常采用逻辑式的规则运算或公式化的数值运算，结合评估维度权重，最终得出归一化的计算结果，从而形成对风险态势的量化评估。总体来说，现有网络风险态势的分析方法更着力于对个体及群组自身的特征进行分析，是一种相对孤立的评估方法，这种方法通常不关注实体间风险关系的变化。如果实体自身的行为特征没有发生变化，通过这种方法对实体风险态势分析得出的评估结果也相对稳定，即使与之相关实体的风险态势发生变化，也不会对其风险的评估产生影响。而真实的业务环境中，即使实体自身的安全特征未发生明显变化，其真实的风险态势会受到相关联实体的风险变化的影响。而现有分析方法对关联实体的风险态势不敏感，这种特性会造成其风险评估的偏差和滞后性。发明内容为了解决上述背景技术中存在的技术问题，本发明提供一种基于空间关系的网络风险态势分析方法及系统，通过持续更新实体间实体行为风险变化系数，解决了目前实体风险评估相对孤立的问题，使得实体的量化风险评估更具可信性。为了实现上述目的，本发明采用如下技术方案：本发明的第一个方面提供一种基于空间关系的网络风险态势分析方法，其包括：获取各实体在第一时段和第二时段的行为数据，计算得到每个实体的第二时段风险变化率；统计第一时段和第二时段的实体间行为频率特征矩阵，计算得到第二时段的行为频率特征变换率矩阵；对于每个实体，基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量后，结合第二时段风险变化率，更新风险变化系数；获取各实体在第三时段的行为数据，结合第二时段的行为数据和综合影响度向量，计算得到每个实体的风险量化的可信值；返回计算每个实体的风险变化率，直到风险变化系数趋向稳定，输出每个实体的风险量化的可信值。进一步地，所述风险变化率的计算方法为：基于各实体在第一时段的行为数据，计算获得第一时段的风险量化值；基于各实体在第二时段的行为数据，计算获得第二时段的风险量化值，并结合第一时段的风险量化值，计算得到每个实体的风险变化率。进一步地，所述每个实体的风险变化率为：其中，表示实体xi在第二时段Tt+1计算得出的风险量化值，表示实体xi在第一时段Tt计算得出的风险量化值。进一步地，某实体的实体间行为频率特征矩阵中的元素为，针对该实体，在一时段内其余实体做为各行为的主体的次数。进一步地，所述风险变化系数的更新方法为：基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量；基于综合影响度向量，计算整体风险影响度；对于每个实体，将整体风险影响度与第二时段风险变化率的比值作为风险变化系数。进一步地，所述每个实体的风险量化的可信值为第三时段风险量化值与风险量化预估值的平均数。本发明的第二个方面提供一种基于空间关系的网络风险态势分析系统，其包括：第一计算模块，其被配置为：获取各实体在第一时段和第二时段的行为数据，计算得到每个实体的风险变化率；第二计算模块，其被配置为：统计第一时段和第二时段的实体间行为频率特征矩阵，计算得到第二时段的行为频率特征变换率矩阵；第三计算模块，其被配置为：对于每个实体，基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量后，结合第二时段风险变化率，更新风险变化系数；第四计算模块，其被配置为：获取各实体在第三时段的行为数据，结合第二时段的行为数据和综合影响度向量，计算得到每个实体的风险量化的可信值；输出模块，其被配置为：返回计算每个实体的风险变化率，直到风险变化系数趋向稳定，输出每个实体的风险量化的可信值。进一步地，所述每个实体的风险量化的可信值为第三时段风险量化值与风险量化预估值的平均数。本发明的第三个方面提供一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如上述所述的一种基于空间关系的网络风险态势分析方法中的步骤。本发明的第四个方面提供一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如上述所述的一种基于空间关系的网络风险态势分析方法中的步骤。与现有技术相比，本发明的有益效果是：本发明提供了一种基于空间关系的网络风险态势分析方法，其在实体独立的风险量化计算基础上，通过持续计算实体间实体行为风险变化系数，对风险量化值进行动态调整，解决了目前实体风险评估相对孤立的问题，使得实体的量化风险评估更具可信性。本发明提供了一种基于空间关系的网络风险态势分析方法，其在实体行为数据缺失的情况下，参照其相关联实体的风险值，结合实体行为风险变化系数，可以对实体的风险值进行预估。本发明提供了一种基于空间关系的网络风险态势分析方法，其通过观察风险量化调整值的变化幅度，可以察觉到实体行为数据评估无法观测到的潜在风险。本发明提供了一种基于空间关系的网络风险态势分析方法，其通过观察实体综合影响度向量，可以了解到对实体风险影响最大的实体行为来源，当实体风险超过阈值时，方便安全人员设置排查风险来源的优先级。附图说明构成本发明的一部分的说明书附图用来提供对本发明的进一步理解，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。图1是本发明实施例一的一种基于空间关系的网络风险态势分析方法的流程图；图2是本发明实施例一的有向关系网络示意图。具体实施方式下面结合附图与实施例对本发明作进一步说明。应该指出，以下详细说明都是例示性的，旨在对本发明提供进一步的说明。除非另有指明，本文使用的所有技术和科学术语具有与本发明所属技术领域的普通技术人员通常理解的相同含义。实施例一本实施例提供了一种基于空间关系的网络风险态势分析方法。在组织网络内存在各类资产实体，如终端、网络设备、服务器、业务系统、业务数据，这些资产实体间的各类行为交互，使得实体间构成一个有向关系网络。如图2所示的有向关系网络中的实体包括：主机A、文件B、主机C、日志D、网络E、主机F、主机G、主机I、打印机J、主机K、主机L、业务系统X、业务系统Y、服务器Z，每一个实体的风险状况构成了网络中的节点，实体间行为关系密切度，形成了网络中节点间的连接，不同的行为对实体间关系密切度的影响也不尽相同。通常认为，行为交互越频繁的实体之间关系密切度会更高，而其之间的风险影响也越高，即认为风险具备更高的传染性。本实施例提供的一种基于空间关系的网络风险态势分析方法，在实体独立的风险评估基础上，通过持续计算有向关系网络的时空变化，对风险态势的量化结果进行动态修正，从而提高风险态势分析的准确性，如图1所示，包括以下步骤：S1：对实体进行风险量化评估，构建实体风险量化集合；具体的，获取各实体在第一时段Tt的行为数据，计算获得各实体在第一时段Tt的风险量化值，实体风险量化集合包括所有实体在第一时段Tt的风险量化值；S2：基于行为数据构建实体间行为频率特征矩阵；具体的，对每个实体，统计在第一时段Tt的实体间行为频率特征矩阵；S3：构建下一时段实体风险变化率集合；具体的，获取各实体在第二时段Tt+1的行为数据，计算获得各实体在第二时段Tt+1的风险量化值，并结合各实体在第一时段Tt的风险量化值，计算得到每个实体的第二时段Tt+1风险变化率；S4：构建下一时段行为频率特征变换率矩阵；具体的，对每个实体，统计第二时段Tt+1实体间行为频率特征矩阵，并结合第一时段Tt实体间行为频率特征矩阵，计算得到第二时段Tt+1的行为频率特征变换率矩阵；S5：计算生成实体间行为综合影响度向量；具体的，对于每个实体，基于第二时段Tt+1的行为频率特征变换率矩阵，计算得到综合影响度向量后，结合第二时段Tt+1风险变化率，更新风险变化系数和风险影响力矩阵；S6：利用行为影响力向量对实体的量化风险进行调整；具体的，获取各实体在第三时段Tt+2的行为数据，对每个实体，统计第三时段Tt+2实体间风险变化率向量，并结合综合影响度向量，计算得到第三时段Tt+2每个实体的风险量化的可信值；S7：持续更新实体间行为风险影响度向量；具体的，重复步骤1-步骤6，直到整体风险变化系数趋向稳定，输出每个实体的风险量化的可信值。步骤S1中，对于实体集合G={x1,x2,x3,…,xn}，其中，xi表示实体i，i=1,2,…,n，n表示实体的个数，收集实体集合中各实体xi在第一时段Tt的行为数据，如主机间文件传输、敏感系统登录、关键数据访问等行为操作，按照既有的风险量化规则或计算公式，计算获得实体风险量化集合，其中，表示实体xi在第一时段Tt计算得出的风险量化值。步骤S2中，预先定义行为集合G={b1,b2,b3,…,bK}，其中，bk表示行为操作k，k=1,2,…,K，K表示行为操作的个数，对实体集合G中每个实体，在第一时段Tt做为G中行为客体的次数进行计数，形成统计向量矩阵：其中，表示实体xj做为行为主体，对实体xi在第一时段Tt发生行为bk的次数，即为实体xj与实体xi之间在第一时段Tt发生行为bk的次数。即，某实体的实体间行为频率特征矩阵中的元素为，针对该实体，在一时段内其余实体做各行为的主体的次数。步骤S3中，首先重复步骤S1，计算各实体在第二时段Tt+1的风险量化集合，其中，表示实体xi在第二时段Tt+1计算得出的风险量化值，然后使用以下公式计算每个实体的风险变化率：得到实体风险变化率集合，其中，表示实体xi在第二时段Tt+1针对第一时段Tt的风险变化率。步骤S4中，首先重复步骤S2，计算在第二时段Tt+1实体集合G中每个实体，针对不同行为做为行为客体的次数统计，形成统计向量矩阵，针对与中元素，然后使用下列公式计算每个实体作为行为客体与相关对象xj针对行为bk的计数变化率：得到第二时段Tt+1的行为统计变化率向量矩阵：其中，表示实体xi做为行为bk的客体时，实体xj做为行为bk的主体，在第二时段Tt+1针对第一时段Tt的行为次数统计变化率。步骤S5中，针对每个实体xi，设定与同维度大小的风险影响力矩阵：影响力矩阵Y中元素初始值为1；设定β为实体xi整体行为风险变化系数，初始值为1。对于矩阵与Y中的元素，使用以下公式计算得出综合影响度向量，其中，表示实体xj对实体xi的影响力：使用以下公式计算实体xi整体风险影响度λ：使用以下公式更新实体xi整体行为风险变化系数β：其中，m为对实体xi产生影响的实体个数。对特定实体来说，如果对其产生影响的关系实体集合S，如果S中实体的风险状态趋于稳定，β值也是趋于稳定的。使用以下公式更新实体xi的行为相关实体的风险影响力矩阵Y：。步骤S6中，重复步骤S1，计算各实体在第三时段Tt+2的风险量化集合；重复步骤S3，计算生成第三时段Tt+2的实体风险变化率集合，构建与实体xi行为相关实体的风险变化率向量，使用以下公式计算得出实体xi的风险量化预估值：取第三时段风险量化值与的平均数作为实体xi风险量化的可信值。步骤S7中，重复以上步骤，使实体行为风险变化系数β趋向稳定。本实施例的一种基于空间关系的网络风险态势分析方法，在实体独立的风险量化计算基础上，通过持续计算实体间实体行为风险变化系数，对风险量化值进行动态调整，解决了目前实体风险评估相对孤立的问题，使得实体的量化风险评估更具可信性，本实施例的一种基于空间关系的网络风险态势分析方法还可以带来以下好处：在实体行为数据缺失的情况下，参照其相关联实体的风险值，结合实体行为综合影响度向量，可以对实体的风险值进行预估；通过观察风险变化系数β的变化幅度，可以察觉到实体行为数据评估无法观测到的潜在风险；通过观察实体综合影响度向量，可以了解到对实体风险影响最大的实体行为来源，当实体风险超过阈值时，方便安全人员设置排查风险来源的优先级。实施例二本实施例提供了一种基于空间关系的网络风险态势分析系统，其具体包括如下模块：第一计算模块，其被配置为：获取各实体在第一时段和第二时段的行为数据，计算得到每个实体的风险变化率；第二计算模块，其被配置为：统计第一时段和第二时段的实体间行为频率特征矩阵，计算得到第二时段的行为频率特征变换率矩阵；第三计算模块，其被配置为：基于第二时段的行为频率特征变换率矩阵，计算得到综合影响度向量后，结合第二时段风险变化率，更新风险变化系数；第四计算模块，其被配置为：获取各实体在第三时段的行为数据，结合第二时段的行为数据和综合影响度向量，计算得到每个实体的风险量化的可信值；输出模块，其被配置为：返回计算每个实体的风险变化率，直到风险变化系数趋向稳定，输出每个实体的风险量化的可信值。此处需要说明的是，本实施例中的各个模块与实施例一中的各个步骤一一对应，其具体实施过程相同，此处不再累述。实施例三本实施例提供了一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现如上述实施例一所述的一种基于空间关系的网络风险态势分析方法中的步骤。实施例四本实施例提供了一种计算机设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述程序时实现如上述实施例一所述的一种基于空间关系的网络风险态势分析方法中的步骤。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用硬件实施例、软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
