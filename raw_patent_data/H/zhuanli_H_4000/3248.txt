标题title
一种面向嵌入式的分布式信息处理节点构建方法
摘要abst
本发明提供了一种面向嵌入式的分布式信息处理节点构建方法。通过构建数据处理单元、采用数据分发服务方式、定义嵌入式设备之间以及分布式信息处理节点与所在嵌入式设备的其它分系统之间的通信方式，实现嵌入式设备的综合信息处理、与外部系统的快速接入、多台嵌入式设备的分布式部署和互联互通，从而提高嵌入式设备的复用性，降低嵌入式设备更新和维护的难度。
权利要求书clms
1.一种面向嵌入式的分布式信息处理节点构建方法，其特征在于：分布式信息处理节点的硬件为数据处理单元；通过以太网与其它分布式信息处理节点或其它系统建立通信链路，每个分布式信息处理节点均有一个独立的IP地址；通过以太网、RS422、RS232或PCI-E总线与所在嵌入式设备的其它分系统之间建立通信链路，并采用与对外通信不同的网段IP地址；采用数据分发服务方式DDS与其它分布式信息处理节点或其它系统进行数据通信，采用自定义的数据格式与所在嵌入式设备的其它分系统进行数据通信；控制嵌入式设备的运行，并输出工作状态信息和健康信息；所述的数据处理单元，包括处理器CPU、可编程逻辑FPGA、DDR内存、FLASH存储器、NVRAM存储器、时统接口单元、电源单元、时钟单元、复位单元、以太网接口单元、RS422接口单元、RS232接口单元、PCI-E接口单元，为分布式信息处理节点的应用程序提供运行环境和通信功能；其中，处理器CPU至少具有2个以太网控制器；处理器CPU、DDR内存、FLASH存储器和NVRAM存储器共同为操作系统和分布式信息处理节点的应用程序提供硬件运行环境，并为以太网接口单元和PCI-E接口单元提供支持；分布式信息处理节点的应用程序的镜像存储在FLASH存储器；操作系统和分布式信息处理节点的应用程序上电后被加载到DDR内存中运行；NVRAM存储器存储分布式信息处理节点的应用程序的配置信息和重启后需要保持的状态信息；可编程逻辑FPGA实现RS422和RS232通讯协议，并为时统接口单元、复位单元提供支持；时统接口单元接收外部的授时信息号；电源单元为分布式信息处理节点提供指定功率的电源，并控制上电顺序；时钟单元为处理器CPU、可编程逻辑FPGA、DDR内存、RS422接口单元提供时钟晶振；复位单元为数据处理单元整体、处理器CPU、以太网接口单元提供复位信号；以太网接口单元、RS422接口单元、RS232接口单元、PCI-E接口单元为分布式信息处理节点对外通信提供通信接口；所述的分布式信息处理节点的应用程序，提供接收外部的控制命令和所在嵌入式设备的其它分系统的工作状态和运行结果、控制嵌入式设备运行、信息的综合处理和转换、输出嵌入式设备的工作状态信息和健康信息功能。2.如权利要求1所述的一种面向嵌入式的分布式信息处理节点构建方法，其特征在于：所述的采用数据分发服务方式DDS与其它分布式信息处理节点或其它系统进行数据通信的具体方式为：使用支持数据分发服务方式的网络中间件，采用以数据为中心的通信机制，包括底层使用TCP/IP或UDP协议、分布式信息处理节点使用订阅/分发的处理接口、支持动态发现新接入网络的分布式信息处理节点并使其与其它分布式信息处理节点或其它系统之间建立通信连接、支持动态删除已经下线或通信故障的分布式信息处理节点与其它分布式信息处理节点或其它系统之间建立的通信连接；其中，分布式信息处理节点使用订阅/分发的处理接口是指将分布式信息处理节点接收的控制命令和发送的工作状态信息定义为不同的主题，分布式信息处理节点通过发布对应主题的数据向其它分布式信息处理节点或其它系统发布信息，其它分布式信息处理节点或其它系统通过订阅对应主题获取该主题对应的信息。3.如权利要求1所述的一种面向嵌入式的分布式信息处理节点构建方法，其特征在于：所述的自定义的数据格式包括报文的报头、报体和校验三部分，其中，报头包含分系统标识、报文的来源和目的、报文的长度、报文的类型，报体是通信数据的具体内容，校验为报文的报头和报体数据的校验结果，用于验证报文的合法性。4.如权利要求1所述的一种面向嵌入式的分布式信息处理节点构建方法，其特征在于：所述的控制嵌入式设备的运行，并输出工作状态信息和健康信息是指：分布式信息处理节点接收其它分布式信息处理节点或其它系统的控制命令，将嵌入式设备的控制命令转换和分解为对应分系统的控制命令，下发控制命令到对应的分系统，控制所在嵌入式设备中其它分系统的运行；分布式信息处理节点周期采集所在嵌入式设备中其它分系统的工作状态和运行结果，进行信息汇总和数据格式转换，并将整理的工作状态信息通过对应的主题发布给其它分布式信息处理节点或其它系统；分布式信息处理节点周期执行所在数据处理单元的自检，周期采集所在嵌入式设备中其它分系统的自检信息，判断各个分系统的健康状态和整个嵌入式设备的健康状态，生成整个嵌入式设备的健康信息，通过对应的主题发布给其它分布式信息处理节点或其它系统。
说明书desc
技术领域本发明属嵌入式系统设计技术领域，具体涉及一种面向嵌入式的分布式信息处理节点构建方法。背景技术目前的嵌入式设备大多只能与固定的控制节点交互，与控制节点紧耦合，难以接入外部系统，并且嵌入式设备之间也难以交互。系统中增加新的嵌入设备或移除已有的嵌入式设备时，需要适应性的升级维护，重复工作多、工作量大，限制了嵌入式设备高效使用。发明内容为了克服现有技术的不足，本发明提供一种面向嵌入式的分布式信息处理节点构建方法。通过构建数据处理单元、采用数据分发服务方式、定义嵌入式设备之间以及分布式信息处理节点与所在嵌入式设备的其它分系统之间的通信方式，实现嵌入式设备的综合信息处理、与外部系统的快速接入、多台嵌入式设备的分布式部署和互联互通，从而提高嵌入式设备的复用性，降低嵌入式设备更新和维护的难度。本发明解决了嵌入式设备之间以及与其它系统之间耦合性高、复用性低、互换性差等问题。一种面向嵌入式的分布式信息处理节点构建方法，其特征在于：分布式信息处理节点的硬件为数据处理单元；通过以太网与其它分布式信息处理节点或其它系统建立通信链路，每个分布式信息处理节点均有一个独立的IP地址；通过以太网、RS422、RS232或PCI-E总线与所在嵌入式设备的其它分系统之间建立通信链路，并采用与对外通信不同的网段IP地址；采用数据分发服务方式DDS与其它分布式信息处理节点或其它系统进行数据通信，采用自定义的数据格式与所在嵌入式设备的其它分系统进行数据通信；控制嵌入式设备的运行，并输出工作状态信息和健康信息；所述的数据处理单元，包括处理器CPU、可编程逻辑FPGA、DDR内存、FLASH存储器、NVRAM存储器、时统接口单元、电源单元、时钟单元、复位单元、以太网接口单元、RS422接口单元、RS232接口单元、PCI-E接口单元，为分布式信息处理节点的应用程序提供运行环境和通信功能；其中，处理器CPU至少具有2个以太网控制器；处理器CPU、DDR内存、FLASH存储器和NVRAM存储器共同为操作系统和分布式信息处理节点的应用程序提供硬件运行环境，并为以太网接口单元和PCI-E接口单元提供支持；分布式信息处理节点的应用程序的镜像存储在FLASH存储器；操作系统和分布式信息处理节点的应用程序上电后被加载到DDR内存中运行；NVRAM存储器存储分布式信息处理节点的应用程序的配置信息和重启后需要保持的状态信息；可编程逻辑FPGA实现RS422和RS232通讯协议，并为时统接口单元、复位单元提供支持；时统接口单元接收外部的授时信息号；电源单元为分布式信息处理节点提供指定功率的电源，并控制上电顺序；时钟单元为处理器CPU、可编程逻辑FPGA、DDR内存、RS422接口单元提供时钟晶振；复位单元为数据处理单元整体、处理器CPU、以太网接口单元提供复位信号；以太网接口单元、RS422接口单元、RS232接口单元、PCI-E接口单元为分布式信息处理节点对外通信提供通信接口；所述的分布式信息处理节点的应用程序，提供接收外部的控制命令和所在嵌入式设备的其它分系统的工作状态和运行结果、控制嵌入式设备运行、信息的综合处理和转换、输出嵌入式设备的工作状态信息和健康信息功能。具体地，所述的采用数据分发服务方式DDS与其它分布式信息处理节点或其它系统进行数据通信的具体方式为：使用支持数据分发服务方式的网络中间件，采用以数据为中心的通信机制，包括底层使用TCP/IP或UDP协议、分布式信息处理节点使用订阅/分发的处理接口、支持动态发现新接入网络的分布式信息处理节点并使其与其它分布式信息处理节点或其它系统之间建立通信连接、支持动态删除已经下线或通信故障的分布式信息处理节点与其它分布式信息处理节点或其它系统之间建立的通信连接。其中，分布式信息处理节点使用订阅/分发的处理接口是指将分布式信息处理节点接收的控制命令和发送的工作状态信息定义为不同的主题，分布式信息处理节点通过发布对应主题的数据向其它分布式信息处理节点或其它系统发布信息，其它分布式信息处理节点或其它系统通过订阅对应主题获取该主题对应的信息。具体地，所述的自定义的数据格式包括报文的报头、报体和校验三部分，其中，报头包含分系统标识、报文的来源和目的、报文的长度、报文的类型，报体是通信数据的具体内容，校验为报文的报头和报体数据的校验结果，用于验证报文的合法性。具体地，所述的控制嵌入式设备的运行，并输出工作状态信息和健康信息的是指：分布式信息处理节点接收其它分布式信息处理节点或其它系统的控制命令，将嵌入式设备的控制命令转换和分解为对应分系统的控制命令，下发控制命令到对应的分系统，控制所在嵌入式设备中其它分系统的运行；分布式信息处理节点周期采集所在嵌入式设备中其它分系统的工作状态和运行结果，进行信息汇总和数据格式转换，并将整理的工作状态信息通过对应的主题发布给其它分布式信息处理节点或其它系统；分布式信息处理节点周期执行所在数据处理单元的自检，周期采集所在嵌入式设备中其它分系统的自检信息，判断各个分系统的健康状态和整个嵌入式设备的健康状态，生成整个嵌入式设备的健康信息，通过对应的主题发布给其它分布式信息处理节点或其它系统。本发明的有益效果是：1)降低嵌入式设备与其它嵌入式设备或其它系统的耦合度，便于整个系统的扩展。增加新的嵌入式设备或移除已有的嵌入式设备，分布式信息处理节点均能够自动发现新接入的节点并建立通信，自动删除通信失联节点的通信连接，减少资源开销；2)提高嵌入式设备的复用性，嵌入式设备的控制命令可以来源于任何一个与之通信的其它嵌入式设备或其它系统，嵌入式设备能够同时为这些控制命令发送方提供功能和工作状态信息；3)提高嵌入式设备的互换性，只要满足同样的通信接口和通信协议，便可以任意替换，支持嵌入式设备的更新换代或更换厂商；4)支持旧的嵌入式设备的改造，发挥新的作用。旧的嵌入式设备一般采用固定的总线与固定的系统进行交联，通过增加分布式信息处理节点，控制旧的嵌入式设备，便可以将旧的嵌入式设备方便的接入到新的系统中。具体实施方式本发明构建的面向嵌入式的分布式信息处理节点由以下部分组成：1)数据处理单元，包括处理器CPU、可编程逻辑FPGA、DDR内存、FLASH存储器、NVRAM存储器、时统接口单元、电源单元、时钟单元、复位单元、以太网接口单元、RS422接口单元、RS232接口单元、PCI-E接口单元，为分布式信息处理节点的应用程序提供运行环境和通信功能。其中，处理器CPU至少具有2个以太网控制器；处理器CPU、DDR内存、FLASH存储器和NVRAM存储器共同为操作系统和分布式信息处理节点的应用程序提供硬件运行环境，并为以太网接口单元和PCI-E接口单元提供支持；分布式信息处理节点的应用程序的镜像存储在FLASH存储器；操作系统和分布式信息处理节点的应用程序上电后被加载到DDR内存中运行；NVRAM存储器存储分布式信息处理节点的应用程序的配置信息和重启后需要保持的状态信息；可编程逻辑FPGA实现RS422和RS232通讯协议，并为时统接口单元、复位单元提供支持；时统接口单元接收外部的授时信息号；电源单元为分布式信息处理节点提供指定功率的电源，并控制上电顺序；时钟单元为处理器CPU、可编程逻辑FPGA、DDR内存、RS422接口单元提供时钟晶振；复位单元为数据处理单元整体、处理器CPU、以太网接口单元提供复位信号；以太网接口单元、RS422接口单元、RS232接口单元、PCI-E接口单元为分布式信息处理节点对外通信提供通信接口；2)分布式信息处理节点的应用程序，提供接收外部的控制命令和所在嵌入式设备的其它分系统的工作状态和运行结果、控制嵌入式设备运行、信息的综合处理和转换、输出嵌入式设备的工作状态信息和健康信息功能；3)支持数据分发服务方式DDS的网络中间件，提供订阅/分发的数据通信功能；4)嵌入式设备，需要与其它嵌入式设备或其它系统连接的嵌入式设备。实施本发明方案的前置准备工作包括：步骤1：制作嵌入式设备。针对不同的需求，制作对应的嵌入式设备；步骤2：制作数据处理单元。该数据处理单元为通用硬件，不同的分布式信息处理节点可以复用；步骤3：开发支持数据分发服务方式的网络中间件。该内容为通用功能，不同的分布式信息处理节点可以复用；步骤4：开发分布式信息处理节点的应用程序。针对不同的嵌入式设备开发对应的应用程序。本发明的具体实施方式如下：1)将开发的支持数据分发服务方式的网络中间件和分布式信息处理节点的应用程序以及操作系统烧录到数据处理单元的FLASH存储器；2)将数据处理单元与嵌入式设备连接，依据嵌入式设备的要求，可以选择以太网、RS422、RS232、PCI-E等总线。如果采用以太网的连接方式，需要分别设置数据处理单元和嵌入式设备的网络地址；3)将数据处理单元与路由器连，设置数据处理单元的网络地址；4)分布式信息处理节点上电后，自动加载并运行操作系统，然后依次加载并运行支持数据分发服务方式的网络中间件和分布式信息处理节点的应用程序；5)嵌入式设备上电后，与分布式信息处理节点建立通信连接，接收分布式信息处理节点发送的控制命令，发送除分布式信息处理节点外的各个分系统的工作状态、运行结果和健康信息到分布式信息处理节点；6)其它分布式信息处理节点或其它系统通过以太网接入同一个网络时，每个分布式信息处理节点均自动发现在线的所有其它分布式信息处理节点或其它系统，并与之建立通信连接，依据各自订阅/分发的主题进行数据传输；7)其它分布式信息处理节点或其它系统下电或网络断开时，在线的每个分布式信息处理节点均自动更新通信连接，删除网络失联的节点的通信连接，不在与这些网络失联的节点通信。
