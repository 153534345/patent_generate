标题title
对用于分段路由的具有不同大小的分段进行混合
摘要abst
一种由分段路由网络域中的第一节点实现的方法包括：从另一网络域中的第二节点接收根据分段标识符要经过所述SR网络域的报文。所述方法还包括：获取与一些所述SID对应的压缩SID。所述方法包括：所述第一节点生成包括分段列表和剩余分段字段的分段路由报头。最后，所述方法包括：将所述SRH添加到所述报文中，然后将包括所述SRH的所述报文转发给所述SR网络域中的第三节点。
权利要求书clms
1.一种由分段路由网络域中的第一节点实现的方法，其特征在于，所述方法包括：所述第一节点从另一网络域中的第二节点接收根据分段标识符要经过所述SR网络域的报文，其中，一组所述SID包括第一数量的公共连续数据单位；所述第一节点获取与一组所述SID对应的压缩SID，其中，每个cSID包括对应SID的唯一连续数据单位，所述唯一连续数据单位对应于第二数量的数据单位；所述第一节点生成包括分段列表和剩余分段字段的分段路由报头，其中，所述分段列表包括按顺序排列的分段，所述SL字段包括指示所述分段的由所述第二数量的数据单位表示的数量的值，所述分段包括所述cSID和不属于所述组的SID；所述第一节点将所述SRH添加到所述报文中；所述第一节点将包括所述SRH的所述报文转发给所述SR网络域中的第三节点。2.根据权利要求1所述的方法，其特征在于，所述生成SRH包括：响应于确定其余SID的长度不是所述第二数量的倍数，确定当与所述其余SID的长度相加时，使得相应的和是所述第二数量的倍数的数据单位数量；通过将所述cSID和包括所述数据单位数量的第一填充插入包括多个分段的桶中并将所述其余SID中的每个SID插入所述列表，生成所述分段列表。3.根据权利要求2所述的方法，其特征在于，所述生成SRH还包括：确定所述分段列表中的分段的数量；通过将所述分段数量乘以128个比特并将相应的乘积除以所述第二数量，计算所述SL字段的值；设置所述SL字段包括所述计算值。4.根据权利要求2所述的方法，其特征在于，所述生成SRH包括：响应于确定所述桶包括长度大于所述第二数量的空白，将一个或多个二次填充插入所述空白，直到所述空白的长度小于所述第二数量。5.根据上述权利要求中任一项所述的方法，其特征在于，所述SRH还包括具有第一子字段的标志字段、具有第二子字段的标签字段，其中，所述第一子字段包括所述第一数量的值，所述第二子字段包括所述第二数量的值。6.根据上述权利要求中任一项所述的方法，其特征在于，所述获取cSID还包括：根据所述SR网络域的SR策略生成所述SID；对于至少一些所述SID中的每个SID，提取相应SID中的唯一连续数据单位作为cSID。7.根据上述权利要求中任一项所述的方法，其特征在于，所述接收报文包括：接收包括所述cSID的所述报文；所述获取cSID包括：从包括所述cSID的所述报文中提取所述cSID。8.根据上述权利要求中任一项所述的方法，其特征在于，所述第一节点是所述SR网络域中的入口节点或边界节点。9.根据上述权利要求中任一项所述的方法，其特征在于，所述SR网络域是支持基于第六版互联网协议的SR数据面的网络域。10.根据上述权利要求中任一项所述的方法，其特征在于，所述数据单位是字节、半字节和比特中的一个。11.一种由分段路由网络域中的第一节点实现的方法，其特征在于，所述方法包括：所述第一节点从所述SR网络域中的第二节点接收包括互联网协议报头和分段路由报头的报文，其中，所述报文根据分段标识符经过所述SR网络域，一组所述SID包括第一数量的公共连续数据单位，所述IP报头包括所述报文的目的地址，所述SRH包括分段列表和剩余分段字段，所述分段列表包括按顺序排列的分段，所述分段包括与一组所述SID对应的压缩SID和不属于所述组的SID，每个cSID包括对应SID的唯一连续数据单位，所述唯一连续数据单位对应于第二数量的数据单位；响应于确定所述顺序中的下一个分段是cSID，所述第一节点更新所述SL字段的值以指示所述顺序中的下一个分段，其中，所述SL字段的更新后的值指示所述顺序中的剩余分段的由所述第二数量的数据单位表示的数量；所述第一节点根据所述SRH中的所述更新后的SL字段，使用所述顺序中的下一个分段来更新所述IP报头中的部分DA；所述第一节点根据所述更新后的DA将包括所述IP报头和所述SRH的所述报文转发给所述SR网络域中的第三节点。12.根据权利要求11所述的方法，其特征在于，所述SRH还包括标志字段和标签字段，其中，所述SRH中的所述标志字段包括用于指示一组所述SID中的公共连续数据单位的数量的第一子字段，所述SRH中的所述标签字段包括用于指示cSID中的连续唯一数据单位的数量的第二子字段，所述更新所述SL字段的值包括：确定所述第二子字段是否包括为0的值；响应于确定所述第二子字段包括为0的值，使用通过将所述接收到的SRH中的所述SL字段的值乘以128个比特并将相应的乘积除以所述第二数量计算到的新值替换所述接收到的SRH中的所述SL字段的值；响应于确定所述第二子字段包括不为0的值，将所述接收到的SRH中的所述SL字段的值递减以指示所述下一个分段。13.根据权利要求11所述的方法，其特征在于，所述接收到的SRH中的所述SL字段的值对应于剩余分段的由128个比特表示的数量，用于计算所述新值的所述第二数量是根据所述接收到的IP报头中的所述DA确定的。14.根据上述权利要求中任一项所述的方法，其特征在于，所述方法还包括：在更新部分DA之前，响应于确定所述顺序中的下一个分段不是cSID，所述第一节点更新所述SL字段的值以指示所述顺序中的下一个分段，其中，所述SL字段的更新后的值指示所述顺序中的剩余分段的由128个比特表示的数量。15.根据权利要求11所述的方法，其特征在于，所述更新所述SL字段的值包括：使用通过将所述接收到的SRH中的所述SL字段的值乘以所述第二数量、将相应的乘积除以128个比特并将相应的商减1计算到的新值替换所述接收到的SRH中的所述SL字段的值。16.根据权利要求11所述的方法，其特征在于，所述接收到的SRH中的所述SL字段的值对应于剩余分段的由所述第二数量的数据单位表示的数量。17.根据权利要求11所述的方法，其特征在于，所述SRH还包括标签字段，其中，所述SRH中的所述标签字段包括用于指示cSID中的连续唯一数据单位的数量的第二子字段，用于计算所述新值的所述第二数量是根据所述第二子字段确定的。18.根据权利要求11所述的方法，其特征在于，所述SRH还包括标志字段和标签字段，其中，所述SRH中的所述标志字段包括用于指示一组所述SID中的公共连续数据单位的数量的第一子字段，所述SRH中的所述标签字段包括用于指示cSID中的连续唯一数据单位的数量的第二子字段，所述方法还包括：响应于确定所述顺序中的下一个分段不是cSID，将所述第一子字段和所述第二子字段的值更新为0。19.根据权利要求11所述的方法，其特征在于，所述确定所述顺序中的下一个分段不是cSID包括：确定所述下一个分段是否对应于用于指示所有所述cSID都已被处理的预设指示符，其中，所述指示符具有所述第二数量的数据单位的长度。20.一种节点设备，其特征在于，所述节点设备包括：接收器，用于接收报文；发送器，用于发送所述报文；与所述接收器和所述发送器耦合的存储器，其中，所述存储器存储指令；与所述存储器耦合的处理器，其中，所述处理器用于执行所述指令，以使得所述节点设备执行根据权利要求1至10中任一项所述的方法和根据权利要求11至19中任一项所述的方法。21.一种系统，其特征在于，所述系统包括：第一节点设备；与所述第一节点设备进行通信的第二节点设备，其中，所述第一节点设备或所述第二节点设备包括执行根据权利要求1至10中任一项所述的方法和根据权利要求11至19中任一项所述的方法的所述节点设备。22.一种用于分段路由网络域中的报文转发装置，其特征在于，所述装置包括：报文接收模块，用于接收所述报文以处理所述报文；与所述报文接收模块耦合的报文发送模块，其中，所述报文发送模块用于将所述报文转发给另一节点；与所述报文接收模块或所述报文发送模块中的至少一个耦合的存储模块，其中，所述存储模块用于存储指令；与所述存储模块耦合的报文处理模块，其中，所述报文处理模块用于执行存储在所述存储模块中的所述指令，以执行根据权利要求1至10中任一项所述的方法和根据权利要求11至19中任一项所述的方法。
说明书desc
相关申请交叉引用本专利申请要求Huaimo Chen于2020年4月16日提交的申请号为63/011,118、发明名称为“对任何大小的分段进行混合的系统和方法”的美国临时专利申请的权益，其全部内容通过引用结合在本申请中。技术领域本发明大体上描述了用于在分段路由网络中转发报文的技术。更具体地，本发明确保所述报文使用压缩的分段路由报头进行转发。背景技术在传统的互联网协议网络路由中，IP报文是根据通过路由协议构建的路由表转发的。IP报文经过的路由通常是通过路由协议计算到的最短路径。在分段路由中，信源选择一条路径并将其编码在报头中作为一列按顺序排列的分段。网络的其余部分执行编码指令。在第六版互联网协议数据面中，一列按顺序排列的分段被编码在路由扩展头中，但是需要新的硬件。在基于IPv6的分段路由中，IPv6分段路由报头被添加到原始报文中作为IPv6扩展头，这可能会导致原始报文无限增大。IPv6扩展头会增大报文，导致报文可能超过报文大小限制。发明内容本文公开了通过以下方式压缩基于第六版互联网协议的分段路由报头：将一组包括公共的B个比特的位置信息和R个比特的功能的分段标识符压缩为只包括所述位置信息的唯一L个比特的压缩分段标识符。通过这种方式压缩这一组SID，转发封装报文降低了网络带宽利用率，从而提高了报文发送速率。第一方面涉及一种由分段路由网络域中的第一节点实现的方法。所述方法包括：所述第一节点从另一网络域中的第二节点接收根据分段标识符要经过所述SR网络域的报文，其中，一组所述SID包括第一数量的公共连续数据单位；所述第一节点获取与一组所述SID对应的压缩SID，其中，每个cSID包括对应SID的唯一连续数据单位，所述唯一连续数据单位对应于第二数量的数据单位；所述第一节点生成包括分段列表和剩余分段字段的分段路由报头，其中，所述分段列表包括按顺序排列的分段，所述SL字段包括指示所述分段的由所述第二数量的数据单位表示的数量的值，所述分段包括所述cSID和不属于所述组的SID；所述第一节点将所述SRH添加到所述报文中；所述第一节点将包括所述SRH的所述报文转发给所述SR网络域中的第三节点。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述生成SRH包括：响应于确定其余SID的长度不是所述第二数量的倍数，确定当与所述其余SID的长度相加时，使得相应的和是所述第二数量的倍数的数据单位数量；通过将所述cSID和包括所述数据单位数量的第一填充插入包括多个分段的桶中并将所述其余SID中的每个SID插入所述列表，生成所述分段列表。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述生成SRH还包括：确定所述分段列表中的分段的数量；通过将所述分段数量乘以128个比特并将相应的乘积除以所述第二数量，计算所述SL字段的值；设置所述SL字段包括所述计算值。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述生成SRH包括：响应于确定所述桶包括长度大于所述第二数量的空白，将一个或多个二次填充插入所述空白，直到所述空白的长度小于所述第二数量。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述SRH还包括具有第一子字段的标志字段、具有第二子字段的标签字段，其中，所述第一子字段包括所述第一数量的值，所述第二子字段包括所述第二数量的值。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述获取cSID包括：根据所述SR网络域的SR策略生成所述SID；对于至少一些所述SID中的每个SID，提取相应SID中的唯一连续数据单位作为cSID。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述接收报文包括：接收包括所述cSID的所述报文；所述获取cSID包括：从包括所述cSID的所述报文中提取所述cSID。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述第一节点是所述SR网络域中的入口节点或边界节点。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述SR网络域是支持基于第六版互联网协议的SR数据面的网络域。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述数据单位是字节、半字节和比特中的一个。第二方面涉及一种由分段路由网络域中的第一节点实现的方法。所述方法包括：所述第一节点从所述SR网络域中的第二节点接收包括互联网协议报头和分段路由报头的报文，其中，所述报文根据分段标识符经过所述SR网络域，一组所述SID包括第一数量的公共连续数据单位，所述IP报头包括所述报文的目的地址，所述SRH包括分段列表和剩余分段字段，所述分段列表包括按顺序排列的分段，所述分段包括与一组所述SID对应的压缩SID和不属于所述组的SID，每个cSID包括对应SID的唯一连续数据单位，所述唯一连续数据单位对应于第二数量的数据单位；响应于确定所述顺序中的下一个分段是cSID，所述第一节点更新所述SL字段的值以指示所述顺序中的下一个分段，其中，所述SL字段的更新值指示所述顺序中的剩余分段的由所述第二数量的数据单位表示的数量；所述第一节点根据所述SRH中的所述更新后的SL字段，使用所述顺序中的下一个分段来更新所述IP报头中的部分DA；所述第一节点根据所述更新后的DA将包括所述IP报头和所述SRH的所述报文转发给所述SR网络域中的第三节点。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述SRH还包括标志字段和标签字段，其中，所述SRH中的所述标志字段包括用于指示一组所述SID中的公共连续数据单位的数量的第一子字段，所述SRH中的所述标签字段包括用于指示cSID中的连续唯一数据单位的数量的第二子字段，所述更新所述SL字段的值包括：确定所述第二子字段是否包括为0的值；响应于确定所述第二子字段包括为0的值，使用通过将所述接收到的SRH中的所述SL字段的值乘以128个比特并将相应的乘积除以所述第二数量计算到的新值替换所述接收到的SRH中的所述SL字段的值；响应于确定所述第二子字段包括不为0的值，将所述接收到的SRH中的所述SL字段的值递减以指示所述下一个分段。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述接收到的SRH中的所述SL字段的值对应于剩余分段的由128个比特表示的数量，用于计算所述新值的所述第二数量是根据所述接收到的IP报头中的所述DA确定的。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述方法还包括：在更新部分DA之前，响应于确定所述顺序中的下一个分段不是cSID，所述第一节点更新所述SL字段的值以指示所述顺序中的下一个分段，其中，所述SL字段的更新后的值指示所述顺序中的剩余分段的由128个比特表示的数量；可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述更新所述SL字段的值包括：使用通过将所述接收到的SRH中的所述SL字段的值乘以所述第二数量、将相应的乘积除以128个比特并将相应的商减1计算到的新值替换所述接收到的SRH中的所述SL字段的值。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述接收到的SRH中的所述SL字段的值对应于剩余分段的由所述第二数量的数据单位表示的数量。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述SRH还包括标签字段，其中，所述SRH中的所述标签字段包括用于指示cSID中的连续唯一数据单位的数量的第二子字段，用于计算所述新值的所述第二数量是根据所述第二子字段确定的。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述SRH还包括标志字段和标签字段，其中，所述SRH中的所述标志字段包括用于指示一组所述SID中的公共连续数据单位的数量的第一子字段，所述SRH中的所述标签字段包括用于指示cSID中的连续唯一数据单位的数量的第二子字段，所述方法还包括：响应于确定所述顺序中的下一个分段不是cSID，将所述第一子字段和所述第二子字段的值更新为0。可选地，根据上述任一方面，在所述方面的另一种实现方式中，所述确定所述顺序中的下一个分段不是cSID包括确定所述下一个分段是否对应于用于指示所有所述cSID都已被处理的预设指示符，其中，所述指示符具有所述第二数量的数据单位的长度。第三方面涉及一种节点设备。所述节点设备包括：接收器，用于接收报文；发送器，用于发送所述报文；与所述接收器和所述发送器耦合的存储器，其中，所述存储器存储指令；与所述存储器耦合的处理器，其中，所述处理器用于执行所述指令，以使得所述节点设备执行根据任一公开实施例所述的方法。第四方面涉及一种系统。所述系统包括：第一节点设备；与所述第一节点设备进行通信的第二节点设备，其中，所述第一节点设备或所述第二节点设备包括执行根据权利要求1至10中任一项所述的方法和任一公开实施例所述的方法的所述节点设备。第五方面涉及用于分段路由网络域中的报文转发装置。所述装置包括：报文接收模块，用于接收所述报文以处理所述报文；与所述报文接收模块耦合的报文发送模块，其中，所述报文发送模块用于将所述报文转发给另一节点；与所述报文接收模块或所述报文发送模块中的至少一个耦合的存储模块，其中，所述存储模块用于存储指令；与所述存储模块耦合的报文处理模块，其中，所述报文处理模块用于执行存储在所述存储模块中的所述指令，以执行根据任一公开实施例所述的方法。为了清楚起见，任一上述实施例可以与上述其它任何一个或多个实施例组合以创建在本发明范围内的新实施例。根据以下结合附图和权利要求书的具体实施方式，将会更清楚地理解这些和其它特征。附图说明为了更全面地理解本发明，现在参考以下结合附图和具体实施方式进行的简要描述，其中，相似的附图标记表示相似的部件。图1示出了根据一个实施例操作的网络。图2示出了分段路由报头。图3为在分段路由网络域中的入口节点处生成一桶压缩分段标识符的示意图。图4示出了分段列表。图5为一种由SR网络域中的节点实现的转发报文的方法的一个实施例。图6为一种由SR网络域中的节点实现的转发报文的方法的另一个实施例。图7为SR网络域中的节点的示意图。图8为用于SR网络域中的报文转发装置的一个实施例的示意图。具体实施方式首先应该理解，尽管下文提供了一个或多个实施例的说明性实现方式，但所公开的系统和/或方法可使用任意数量的技术来实现，无论这些技术是当前已知还是现有的。本发明决不应限于下文所说明的说明性实现方式、附图和技术，包括本文说明并描述的示例性设计和实现方式，而是可以在所附权利要求书的范围以及其等同物的完整范围内修改。图1示出了根据一个实施例操作的网络150。如图所示，网络150包括客户端网络151和159，两者经由网络160中的边缘节点161和167进行通信耦合。网络160包括网络节点组成的N个域，其中，N是非零整数，这些网络节点经由一个或多个边界节点互连。客户端网络151和159都可以包括具有经由网络150进行通信的上层应用的主机。在一个实施例中，客户端网络151和/或159中的一些主机支持分段路由，因为它们可以生成和处理分段路由报文。客户端网络151和159中的终端节点可以将报文)发送到网络160中的边缘节点161和167。报文可以是第四版互联网协议报文、第六版互联网协议报文、以太网帧/报文或其它协议报文。在一个实施例中，边缘节点161和167处理从网络151和159接收到的报文，这种处理可以包括将这些报文封装或以其它方式处理成SR报文，例如，根据数据面确定的分段路由策略将SR报头添加到这些报文中。在一个实施例中，网络160中的边缘节点161和167或另一节点确定分段路由策略的分段)，以应用于不同报文流中的报文。这些策略可以根据网络条件、网络编程等而改变。在一个实施例中，分段路由策略指定添加一个或多个SRH 182，每个SRH 182包括一个或多个分段列表188，使得分段路由报文175包括一个或多个SRH 182。在一个实施例中，接收不包括SRH的原报文170/IP地址)，接收节点161或167将原报文170封装在SR报文175中。SR报文175包括一个或多个添加的SRH 182，每个SRH 182包括一个或多个分段列表188。节点161或167还添加包括报文的目的地址的IP报头181。在一个实施例中，接收包括分段路由扩展头的报文170，接收节点161或167添加一个或多个SRH 182，使得分段路由报文包括一个或多个添加的SRH 182，每个SRH 182包括一个或多个分段列表188。相比之下，对于这些场景中的每个场景，可以使用单个SRH 182，其包括一个分段列表188中的所有分段。SID包括位置信息和功能。位置信息指示为了执行功能，报文170要路由到多域网络160中的哪个节点。该功能可以是包括任何可选参数的任何可能功能。在一个实施例中，一组SID包括两个公共部分：一部分是前B个比特的相同公共前缀，另一部分是最后R个比特的公共功能和参数。这些SRv6 SID的中间L个比特是不同的，其中，L＝128–B–R个比特。相应地，这一组SID可以被压缩成cSID，每个cSID包括唯一位置信息的L个比特。在一个实施例中，SRH 182中的分段列表188包括一个或多个cSID。SRH 182还包括多个字段，例如具有B子字段183的标志字段、具有L子字段184的标签字段以及剩余分段字段185。在一个实施例中，B子字段183用于指示这一组SID中的公共连续数据单位的长度。L子字段184是针对cSID的大小定义的。SL字段185用于指向激活分段的指针。在将SRH 182和IP报头181添加到报文175中之后，边缘节点161和167将封装报文转发给中间节点165、166。中间节点165、166接收封装报文175，并根据分段列表188中的cSID更新IP报头181中的目的地址。相应地，中间节点165、166根据更新后的DA将封装报文175转发给多域网络160中的下一个节点。一旦封装报文175穿过多域网络160，边缘节点161和167最终解封装或移除SRH 182，并将原报文179转发到网络159或151中。本文公开了通过以下方式压缩SRH 182的技术：将一组包括公共的B比特位置信息和R比特功能的SID压缩为只包括唯一的L比特位置信息的cSID。通过这种方式压缩这一组SID，转发封装报文减少了网络带宽，从而提高了报文发送速率。图2示出了分段路由报头200。SRH 200类似于图1中的SRH 182。如图所示，SRH 200包括增大数据报文的多个字段。具体地，SRH 200包括下一报头字段211、头扩展长度字段213、路由类型字段215、剩余分段字段220、最后条目字段231、标志字段235、标签字段237和分段列表239。下一报头字段211包括8比特选择器。下一报头字段211用于标识紧跟SRH之后的报头类型。Hdr Ext Len字段213包括8比特无符号整数。Hdr Ext Len字段213用于指示路由报头的以8个八位字节为单位的长度，不包括前8个八位字节。路由类型字段215包括特定路由报头变体的8比特标识符。SL字段220包括8比特无符号整数。SL字段220用于标识在到达最终目的地之前的分段列表239中的剩余分段的数量。SL值在每个分段递减。最后条目字段231包括分段列表中的最后一个元素的索引。标志字段235包括8比特标志。在一个实施例中，标志字段235包括B子字段240。B子字段240用于指示一组SID中的公共连续数据单位的长度。长度可以用字节、半字节或比特来测量。在一个实施例中，如果使用字节作为数据单位，则B的大小为4个比特，如果使用半字节作为数据单位，则B的大小为5个比特，如果使用比特作为数据单位，则B的大小为7个比特。标签字段237用于对与SRH 200相关联的报文加标签，作为一类或一组报文的一部分。在一个实施例中，标签字段237包括L子字段250。L子字段250是针对cSID的大小定义的。在一个实施例中，如果分段列表239中的cSID的大小和位置以字节、半字节或比特为单位，则L子字段250的大小为4个、5个或7个比特。分段列表239包括一个或多个分段。这些分段的排列顺序反映了对应报文的路径。每个分段能够通过SL字段220的索引进行标识，每个分段的大小为128个比特或L个比特。128比特分段包括一个128比特SID，或一个或多个L比特cSID。如图2所示，分段列表239可以包括一桶cSID以及SID。在另一个实施例中，分段列表239可以只包括cSID。图3为在分段路由网络域中的入口节点处生成一桶压缩分段标识符的示意图。分段路由的定义在C.Filsfils等人于2020年10月7日发表的互联网工程任务组草案“SRv6 Network Programming”中详述。本文档介绍了如何使用分段路由报头将网络指令插入IPv6报头。例如，128比特的SRv6 SID的结构如图3所示。如图3所示，SID 301A至301N包括具有公共前缀位置信息310和唯一后缀320的位置信息。位置信息指示为了执行功能330，报文要路由到哪个节点。功能330可以是包括任何可选参数的任何可能功能。SID 301A至301N的长度通常是固定的。如图3所示，入口节点可以接收SRv6策略中的包括个128比特分段的分段列表300。在一个实施例中，分段列表301A至301N对应于基于IPv6的分段路由策略中的SRv6分段标识符。每个分段301A至301N表示128个比特的SRv6 SID。SID包括位置信息、功能和参数。这些SRv6 SID中的一些SID包括两个公共部分：一部分是前B个比特的相同公共前缀，另一部分是最后R个比特的公共功能和参数。这些SID 301I+1至301N的中间L个比特是不同的，其中，L＝128–B–R个比特。在一个实施例中，入口节点161、167可以将SID 301I+1至301N至个L比特cSID 341I+1至341N压缩为一桶cSID。因此，分段列表350包括SID 310A至310I和cSID 341I+1至341N。每个cSID 341I+1至341N要小于128个比特。入口节点161、167可以将分段列表350添加到SRH 200中，而不是分段列表300。相应地，入口节点161、167将SRH显著减小了×个比特。图4示出了分段列表400。如图4所示，分段列表400包括一桶cSID410和SID 450。桶410包括一个或多个压缩SID420。也就是说，桶410包括一个或多个128比特分段内的按顺序排列的cSID 420。每个cSID 420占用一个分段或两个相邻分段中的L个比特。在cSID的末尾，桶410包括最后一个cSID之后的cSID结束430，用于指示压缩结束。Endc 430与cSID具有相同的长度。在一个实施例中，Endc 430的L个比特都为0，这是为Endc 430保留的。在另一个实施例中，Endc 430的L个比特都为1。在Endc 430之后，可以添加填充440，以便使包括SID 450和填充的分段的长度是L个比特的倍数。例如，假设余数表示SRv6 SID除以L的大小，如图4所示。如果RR为0，则桶中没有填充440；否则，桶中存在个比特的填充440。具体地，对于从SID-I到SID-0的个SRv6 SID，RR＝×128％L。如果RR为0，则没有填充440；否则，桶中存在个比特的填充440。在一个选项中，填充440的个比特都为0。在添加填充440之后，如果桶410中存在任何空白，则可以添加二次填充，以便使剩余空间小于L个比特。桶420中cSID1右侧的二次填充的总数量通过Ne＝/L–计算得到。类似于填充440，二次填充可以设置为全0或全1。在一个实施例中，二次填充可以是另一个Endc。图5为一种由分段路由网络域中的节点实现的转发报文的方法500的一个实施例。通过显著减小要添加到报文中的分段路由报头，方法500改进了上述转发过程。通过实现这样压缩的分段路由报头，报文的传输需要更少的网络带宽，使得传输效率高。在步骤510中，节点从另一网络域中的节点接收报文。该报文根据分段标识符要经过SR网络域。在一个实施例中，节点是SR网络域中的入口节点。在另一个实施例中，节点是SR网络域中的边界节点。SR网络域是支持基于第六版互联网协议的SR数据面的网络域。SID的值为128个比特。在一个实施例中，SID包括位置信息、功能和参数。当用于显式流量工程路径的分段路由策略用于在网络域中的边缘节点处控制报文时，生成SID并将其添加到报文中，以指示网络域中的节点通过路径导航报文。在一个实施例中，一组SID包括多个公共连续数据单位。如图3所示，一组SID 301A至301N可以在位置信息310中包括B个比特的公共前缀。也就是说，这一组SID在位置信息中包括L个比特的唯一后缀。此外，这一组SID还可以包括R个比特的公共功能和参数。相应地，这一组中的SID按顺序包括B个比特的公共前缀、L个比特的唯一后缀和R个比特的公共功能和参数。在一个实施例中，这一组SID 301A-301N可以包括公共功能或参数中的至少一个。在步骤530中，节点获取与一组SID对应的压缩SID320。cSID 320包括对应SID的唯一连续数据单位。例如，cSID 320是位置信息310中的值为L个比特的唯一后缀，如图3所示。在一个实施例中，为了确定cSID，节点根据SR网络域的SR策略为报文生成SID。节点可以标识在位置信息中包括B个比特的公共前缀的一组SID。在一个实施例中，节点可以根据绑定SID标识一组SID。一旦确定了这一组SID，节点就会提取相应SID中的唯一后缀作为这一组中的每个SID对应的cSID。在一个实施例中，SID的大小或长度为128个比特。在这种情况下，对应cSID的大小小于128个比特。在另一个实施例中，在步骤510中，节点可以从相同或不同网络域中的另一节点接收cSID。因此，为了在步骤530中确定cSID，节点从包括cSID的报文中提取cSID。在步骤550中，节点生成分段路由报头200。在一个实施例中，节点创建SRH 200，其中，SRH 200包括分段列表和一组字段，例如剩余分段字段220、具有第一子字段的标志字段235以及具有第二子字段的标签字段237。在一个实施例中，标志字段235和标签字段237不包括任何其它子字段。在创建SRH 200之后，节点生成分段列表239。分段列表239的排列顺序反映了报文的路径。分段列表239包括按顺序排列的分段。相应地，每个分段包括一个或多个cSID，例如部分或整个SID。在一个实施例中，节点生成一桶cSID 410，如图4所示。一桶cSID 410包括按顺序排列的多个分段。在一种实现方式中，节点使用cSID填充这一组分段。相应地，这一组中的大多数分段都使用多个cSID填充。此外，节点在顺序中的最后一个cSID的后面插入压缩结束430。Endc 430指示没有更多cSID。Endc 430与cSID具有相同的长度。根据预定义设置，Endc 430可以是全0或全1。在一个实施例中，节点可以将全0或1的填充440添加到Endc 430，以便使包括SID的分段的长度是L个比特的倍数。在一种实现方式中，节点确定未由cSID表示的剩余SID的长度是否是L的倍数。响应于确定剩余SID的长度不是L的倍数，节点确定当与剩余SID的长度相加时，使得相应的和是L的倍数的数据单位数量。相应地，节点通过将cSID、Endc 430和包括数据单位数量的主填充440插入一桶cSID 410，然后将剩余SID 450中的每个SID插入分段400，生成分段列表239。另一方面，节点可以确定剩余SID的长度是L的倍数。在这种情况下，节点不将任何填充440添加到桶410中的Endc 430。此外，节点可以添加二次填充，以便填补桶中的任何空白，使得剩余空间的长度小于L。在一种实现方式中，节点确定桶410是否包括长度大于L的空白。响应于确定桶包括长度大于L的空白，节点将一个或多个二次填充插入或添加到空白中，直到空白的长度小于L。这样的二次填充可以预设为Endc 430或一系列长度为L个比特的1或0。一旦创建了SRH 200，节点还设置SRH 200中各个字段的值。在一个实施例中，节点将一个值插入SL字段220。在一种实现方式中，节点确定分段列表239中的分段的数量。随后，节点通过将分段数量乘以128个比特并将相应的乘积除以L，计算SL字段220的值。然后，节点将SL字段220设置为包括计算值。这样，SL字段220的值表示以L比特为单位的分段的数量。如果分段列表239包括cSID下面的128个比特的至少一个SID，节点以不同的方式计算SL字段220的值。SL的值表示128个比特的分段的数量。例如，对于图2中的分段列表，为SL计算的值是K，表示个128比特分段。在这种情况下，SRH 200中的标志字段235的B子字段240和标签字段237的L子字段250都被设置为0。另外，节点将一个值插入SRH 200中的标志字段235的B子字段240。在一个实施例中，节点标识一组SID中的公共连续数据单位。在一种实现方式中，节点确定SID的位置信息310中的公共前缀。节点还将公共前缀的大小确定为B个比特。相应地，节点将B插入标志字段235的B子字段240。例如，当一组SID在位置信息310中包括14个比特的公共前缀时，节点将数值14填入或插入B子字段240。因此，标志字段235中的B子字段240包括一组SID的位置信息310中的公共前缀的数据单位的数量的值。此外，节点将一个值插入SRH 200中的标签字段237的L子字段250。在一种实现方式中，节点标识一组SID中的一个SID中的唯一连续数据单位。也就是说，节点确定一组SID的位置信息中的唯一后缀。然后，节点将唯一后缀的大小确定为L个比特。相应地，节点将L插入标签字段237的L子字段250。例如，当这一组中的每个SID在位置信息310的末尾包括唯一的9个比特时，节点将数值9插入L子字段250。因此，标签字段237中的L子字段250包括一组SID的位置信息中的唯一后缀的数据单位的数量的值。在步骤570中，节点将SRH 182添加或压入到报文175中。在一个实施例中，节点还生成互联网协议报头181，并将IP报头181作为外层报头添加到包括SRH 182的报文175中，从而封装报文175和SRH 182。在一个实施例中，IP报头181是第六版IP报头。在另一个实施例中，IP报头181是第四版IP报头。IP报头181包括目的地址，其指示SR网络域中的节点的地址，报文175随后经过该SR网络域。节点地址由SID表示。相应地，DA也包括位置信息、功能和参数。节点根据分段列表239确定顺序中的下一个节点的地址。下个一节点的地址对应于分段列表239中的下一个SID。下一个SID可以由cSID表示。在这种情况下，节点可以根据cSID构建SID。也就是说，节点可以在cSID前添加位置信息中的公共前缀，并将公共功能和参数添加到cSID中。然后，节点将下一个节点的构建地址或SID插入DA。在步骤590中，节点将包括SRH 182的报文175转发给SR网络域中的下一个节点。在一个实施例中，报文175是根据IP报头181中的与报文175一起发送的DA转发的。图6为一种由分段路由网络域中的节点实现的转发报文175的方法600的另一个实施例。通过只更新报文的部分目的地址，而不是更新整个目的地址，方法600改进了上述转发过程。相应地，节点处理大量报文，但需要较少的处理时间资源。在步骤610中，节点从SR网络域中的另一节点接收包括互联网协议报头181和分段路由报头182的报文175。节点是SR网络域中的中间节点。另一方面，发送节点可以是入口节点、中间节点或边界节点。SR网络域162、164是支持基于第六版互联网协议的SR数据面的网络域。报文175用于根据分段标识符经过SR网络域。一些SID包括第一数量的公共连续数据单位。数据单位可以是字节、半字节或比特。如上文结合图5所述，当用于显式流量工程路径的分段路由策略用于在网络域中的边缘节点处控制报文时，生成SID并将其添加到报文中，以指示网络域中的节点通过路径导航报文。在一个实施例中，SID的值为128个比特，SID包括位置信息、功能和参数。在一个实施例中，至少一些SID包括多个公共连续数据单位。例如，如图3所示，一组SID可以在位置信息中包括B个比特的公共前缀和L个比特的唯一后缀。此外，这一组SID还可以包括R个比特的公共功能和参数。相应地，这一组中的SID按顺序包括B个比特的公共前缀、L个比特的唯一后缀和R个比特的公共功能和参数。与报文175一起接收的IP报头181包括目的地址，其指示SR网络域中的一个节点的地址，报文随后经过该SR网络域。节点地址由SID表示。在一个实施例中，IP报头181是第六版IP报头。在另一个实施例中，IP报头181是第四版IP报头。也与报文一起接收的SRH 200包括分段列表239、剩余分段字段220、标志字段235和标签字段237。这些分段的排列顺序反映了报文的路径。分段列表239包括分段，每个分段包括部分或整个SID。在一个实施例中，分段列表239包括与一组SID对应的一桶压缩SID410。一桶cSID 410包括一组按顺序填充有cSID的分段。桶中的每个cSID包括对应SID的唯一连续数据单位。在一个实施例中，cSID是位置信息中的值为L个比特的唯一后缀，如图3所示。此外，一桶cSID包括顺序中的最后cSID之后的压缩结束430。Endc 430指示没有更多cSID。Endc 430与cSID具有相同的长度。根据预定义设置，Endc430可以是全0或全1。在一个实施例中，节点可以将全0或1的主填充440添加到Endc 430，以便使包括SID的分段的长度是L个比特的倍数。此外，节点可以添加二次填充，以便填补桶中的任何空白，使得剩余空间的长度小于L。除一桶cSID 410之外，分段列表239还可以包括分段中的一个或多个SID。SID可以放置在一桶cSID的前面或后面。除分段列表之外，SRH 200还包括剩余分段字段220。如结合步骤630详述，SL字段220表示剩余分段的由128个比特或L个比特表示的数量。除SL字段220之外，SRH 200还包括标志字段235。SRH 200中的标志字段235包括第一子字段，标签字段237包括第二子字段。标志字段235的B子字段240用于指示一组SID中的公共连续数据单位的数量。例如，当B子字段240包括数值14时，这表示一组SID在位置信息中包括14个比特的公共前缀。标签字段237的L子字段250用于指示一组SID中的唯一连续数据单位的数量以及cSID的大小。例如，当L子字段250包括数值9时，该数值指示这一组中的每个SID在位置信息的末尾包括唯一的9个比特，因此，cSID的大小为9个比特。在步骤630中，响应于确定顺序中的下一个分段是cSID，更新SL字段220的值以指示顺序中的下一个分段。在一个实施例中，SL字段220的更新后的值等于顺序中的剩余分段的由L个比特表示的数量。例如，节点确定L子字段250是否包括为0的值。响应于确定L子字段250包括为0的值，节点使用通过将接收到的SRH 200中的SL字段220的值乘以128个比特并将相应的乘积除以L计算到的新值替换接收到的SRH200中的SL字段220的值。另一方面，响应于确定L子字段220包括不为0的值，节点将接收到的SRH 200中的SL字段220的值递减以指示下一个分段。另一方面，响应于确定顺序中的下一个分段不是cSID，节点更新接收到的SRH 200中的SL字段220的值以指示顺序中的下一个分段。SL字段220的更新后的值应该等于顺序中的剩余分段的由128个比特表示的数量。为了更新SL字段220的值，使得更新后的值指示顺序中的剩余分段的由128个比特表示的数量，节点使用通过将接收到的SRH 200中的SL字段220的值乘以L、将相应的乘积除以128并将相应的商减1计算到的新值替换接收到的SRH 200中的SL字段220的值。另外，响应于确定顺序中的下一个分段不是cSID，节点还可以将B子字段240和L子字段250的值更新为0。在确定顺序中的下一个分段不是cSID时，节点可以确定下一个分段是否对应于用于指示所有cSID都已被处理的预设指示符。在一个实施例中，预设指示符的长度为L个比特。在步骤650中，节点根据SRH 200中的更新后的SL字段220使用顺序中的下一个分段来更新IP报头181中的部分DA。为了更新部分DA，节点使用SRH 200中的B子字段240和L子字段250标识待更新的部分DA。在一个实施例中，节点根据SRH 200中的B子字段240的值确定部分DA的起始位置以及根据SRH 200中的L子字段250的值确定部分DA的长度。然后，节点进一步根据起始位置和长度确定部分DA的位置。例如，假设DA的长度为128个比特，节点可以在B子字段240中标识20个比特的值且在L子字段250中标识10个比特的值。相应地，节点可以确定应该更新第21个比特至第30个比特的部分DA。在标识待更新的部分DA之后，节点使用由SRH 200中的更新后的SL字段220指示的分段替换标识的部分DA。如果SL字段的值已经更新为剩余分段的由L个比特表示的数量，节点使用由SL字段220的更新后的值指示的cSID替换部分DA。另一方面，如果SL字段220的值已经更新为剩余分段的由由128个比特表示的数量，节点使用由SL字段的更新后的值指示的cSID替换整个DA。在步骤670中，在更新部分DA之后，节点根据更新后的DA将包括IP报头181和SRH182的报文转发给SR网络域162、164中的另一节点。相应地，报文被转发给在IP报头181的更新后的DA中指示的下一个节点。图7为本发明一个实施例提供的分段路由网络域中的节点700的示意图。节点700适合于实现本文中所述的公开实施例。节点700包括用于接收数据的入端口710和接收单元720，用于处理所述数据的处理器、逻辑单元或中央处理器730，用于发送所述数据的发送单元740和出端口750以及用于存储所述数据的存储器760。节点700还可以包括与入端口710、接收单元720、发送单元740和出端口750耦合的光电组件和电光组件，用于光信号或电信号的出口或入口。处理器730通过硬件和软件来实现。处理器730可以实现为一个或多个CPU芯片、一个或多个核、一个或多个现场可编程门阵列、一个或多个专用集成电路和一个或多个数字信号处理器。处理器730与入端口710、接收单元720、发送单元740、出端口750和存储器760进行通信。处理器730包括报文处理器770。报文处理器770实现上文描述的公开实施例。例如，报文处理器770执行、处理、准备或提供各种报文处理功能。因此，将报文处理器770包括在内为节点700的功能提供了实质性的改进，并且影响了节点700到不同状态的转换。可选地，以存储在存储器760中并由处理器730执行的指令来实现报文处理器770。存储器760包括一个或多个硬盘、一个或多个磁带机以及一个或多个固态硬盘，并且可以用作溢出数据存储设备，以在选择程序来执行时存储这些程序以及存储在执行程序过程中读取的指令和数据。存储器760可以是易失性和/或非易失性的，并且可以是只读存储器、随机存取存储器、三态内容寻址存储器和/或静态随机存取存储器。图8为用于分段路由网络域中的报文转发装置800的一个实施例的示意图。在一个实施例中，报文转发能力800在节点中实现。报文转发装置800包括报文接收模块801。报文接收模块801用于从节点接收报文。报文转发装置800包括与报文接收模块801耦合的报文发送模块807。报文发送模块807用于将所述报文发送到另一节点。报文转发装置800包括报文处理模块805。报文处理模块805与报文接收模块801或报文发送模块807中的至少一个耦合。报文转发装置800包括存储模块803。存储模块803与报文接收模块801或报文发送模块807中的至少一个耦合。存储模块803用于存储指令。报文转发装置800还包括报文处理模块805。报文处理模块805与存储模块803耦合。报文处理模块805用于执行存储在存储模块803中的指令，以执行本文中公开的方法。还当该理解，本文中阐述的示例性方法的步骤不一定需要按所描述的顺序执行，并且这些方法的步骤的顺序应当理解为仅仅是示例性的。同理，在与本发明各种实施例相一致的方法中，这些方法可以包括其它步骤，并且某些步骤可以省略或合并。虽然本发明提供了若干个实施例，但应当理解，在不脱离本发明的精神或范围的情况下，所公开的系统和方法可以通过其它多种具体形式体现。本发明示例应被视为说明性而非限制性的，且本发明并不限于本文所给出的详细内容。例如，各种元件或组件可以在另一系统中组合或集成，或者某些特征可以省略或不实现。另外，在不脱离本发明的范围的情况下，各种实施例中描述和说明为离散或单独的技术、系统、子系统和方法可以与其它系统、模块、技术或方法组合或集成。展示或论述为彼此耦合或直接耦合或通信的其它项也可以采用电方式、机械方式或其它方式通过某一接口、设备或中间组件间接地耦合或通信。变化、替换、变更的其它示例可由本领域技术人员确定，并可以在不脱离本文中公开的精神和范围的情况下举例。
