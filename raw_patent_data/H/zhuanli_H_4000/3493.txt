标题title
基于可信执行环境和分布式数据求交算法的多方隐私求交方案
摘要abst
本发明实施例提供一种基于可信执行环境和分布式数据求交算法的多方隐私求交方案，通过可信执行环境解决了多方求交场景下各方的数据隐私保护问题。通过将TEE与分布式隐私求交算法相结合，实现隐私数据少出域、出域数据不出TEE，在保护各方隐私数据的同时，实现多方数据的求交，打通多方数据孤岛。
权利要求书clms
1.一种基于基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，包括：基于TEE的隐私求交协调算子、基于TEE的隐私求交客户端、基于TEE远程证明和国密算法TLS构建的隐私求交协调算子与隐私求交客户端间的可信安全连接；所述基于TEE的隐私求交协调算子用于协调各个隐私求交参与方，通过协商保证各个参与方使用相同的布隆过滤器参数，构建各个参与方的布隆过滤器交集，对粗筛后的求交数据执行求交操作。所述基于TEE的隐私求交客户端用于在各个参与方域内执行，直接对接各个参与方数据仓库，获取明文数据，与隐私求交协调算子协商布隆过滤器参数，与隐私求交协调算子共同构建各个参与方的布隆过滤器交集，对明文数据进行粗筛，与隐私求交协调算子共同计算精确求交结果，与数据仓库对接存储求交结果。所述基于TEE远程证明和国密算法TLS构建的隐私求交协调算子与隐私求交客户端间的可信安全连接用于隐私求交客户端和隐私求交协调算子间的互认证与实现数据传输的保密性。2.根据权利要求1所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，所述基于TEE的隐私求交协调算子和基于TEE的隐私求交客户端还要求：该模块自身的所有计算逻辑都在TEE中执行，保证计算逻辑涉及的明文数据不能被该模块所在节点主机内其他的任何模块所访问，并能够对外提供远程证明报告，证明自身的计算逻辑的完整型。3.根据权利要求1所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，隐私求交协调算子和隐私求交客户端间构建的可信安全连接还要求：采用国产密码套件进行TLS连接的构建，对应客户端证书和服务端证书，采用X509证书V3拓展段保存权利要求2所属的模块的远程证明报告，TLS握手阶段隐私求交协调算子和隐私求交客户端都对远程证明报告进行验证，对证书合法性进行验证，实现对于对端的认证。4.根据权利要求1所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，所述基于TEE的隐私求交客户端还要求：隐私求交客户端支持连接不同类型数据仓库的协议，通过对接不同类型的数据仓库实现数据的读取和写入。5.根据权利要求1所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，使用分桶策略对求交数据在线下进行预处理，线上多方求交过程中各个桶内的数据的求交能够并行处理，提高求交速度。6.根据权利要求1所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，在线下预处理阶段对数据进行桶内的排序，线上的多方求交过程采用流式计算技术进行计算，减少在数据传输时的等待。7.根据权利要求1所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，通过协调算子协商各方布隆过滤器参数，各方构建布隆过滤器后，由协调算子进行布隆过滤器的求交，各方采用布隆过滤器交集进行数据的粗筛。8.根据权利要求1所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，协调算子进行精确求交时，通过bitmap记录交集索引，并通过bitmap将交集结果返回给各个参与方。
说明书desc
技术领域本发明涉及可信计算、隐私计算和多方数据求交领域，尤其涉及一种基于可信执行环境和分布式数据求交算法的多方隐私求交方案。背景技术目前，各行业积累的大量数据需要多方数据联合做风控、营销以便更好地挖掘数据的价值，很多数据多方联合计算的过程依赖对齐的数据，从而需要通过多方数据求交完成数据的对齐，而数据作为一种容易被复制挪用的资产，计算的参与方往往不希望别的参与方能够获取自己的明文数据，从而需要多方隐私求交计算。现有技术中实现多方隐私求交的方式通常包括：1)基于朴素哈希的数据共享的多方隐私求交；2)基于混淆电路的多方隐私求交；3) 基于同态加密的多方隐私求交；4)基于不经意传输的多方隐私求交。但是，无论是哪种方式，都难以兼顾数据安全与求交计算的性能，又或者对于参与方数量的增加的可拓展性不强。发明内容本发明实施例提供一种基于可信执行环境和分布式数据求交算法的多方隐私求交方案，用以解决现有技术中存在的缺陷。本发明实施例提供一种基于可信执行环境和分布式数据求交算法的多方隐私求交方案，包括：基于可信执行环境的隐私求交协调算子，基于可信执行环境的隐私求交客户端，隐私求交协调算子和客户端间的可信安全连接；所述基于可信执行环境的隐私求交协调算子用于协调各个隐私求交参与方，通过协商保证各个参与方使用相同的布隆过滤器参数，构建各个参与方的布隆过滤器交集，对粗筛后的求交数据执行求交操作。所述基于TEE的隐私求交客户端用于在各个参与方域内执行，直接对接各个参与方数据仓库，获取明文数据，与隐私求交协调算子协商布隆过滤器参数，与隐私求交协调算子共同构建各个参与方的布隆过滤器交集，对明文数据进行粗筛，与隐私求交协调算子共同计算精确求交结果，与数据仓库对接存储求交结果。所述基于TEE远程证明和国密算法TLS构建的隐私求交协调算子与隐私求交客户端间的可信安全连接用于隐私求交客户端和隐私求交协调算子间的互认证与实现数据传输的保密性。所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，所述基于TEE的隐私求交协调算子和基于TEE的隐私求交客户端还要求：该模块自身的所有计算逻辑都在TEE中执行，保证计算逻辑涉及的明文数据不能被该模块所在节点主机内其他的任何模块所访问，并能够对外提供远程证明报告，证明自身的计算逻辑的完整型。所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，隐私求交协调算子和隐私求交客户端间构建的可信安全连接还要求：采用国产密码套件进行TLS连接的构建，对应客户端证书和服务端证书，采用X509证书V3拓展段保存TEE远程证明报告，TLS握手阶段隐私求交协调算子和隐私求交客户端都对远程证明报告进行验证，对证书合法性进行验证，实现对于对端的认证。所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，所述基于TEE的隐私求交客户端还要求：隐私求交客户端支持连接不同类型数据仓库的协议，通过对接不同类型的数据仓库实现数据的读取和写入。所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，使用分桶策略对求交数据在线下进行预处理，线上多方求交过程中各个桶内的数据的求交能够并行处理，提高求交速度。所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，在线下预处理阶段对数据进行桶内的排序，线上的多方求交过程采用流式计算技术进行计算，减少在数据传输时的等待。所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，通过协调算子协商各方布隆过滤器参数，各方构建布隆过滤器后，由协调算子进行布隆过滤器的求交，各方采用布隆过滤器交集进行数据的粗筛。所述的基于可信执行环境和分布式数据求交算法的多方隐私求交方案，其特征在于，协调算子进行精确求交时，通过bitmap 记录交集索引，并通过bitmap将交集结果返回给各个参与方。本发明实施例的基于可信执行环境和分布式数据求交算法的多方隐私求交方案在采用TEE保证数据安全的前提下，减少了复制的密码算法与协议，增加了隐私求交的性能，并提供了参与方的线性拓展的能力。从而打造隐私、安全、可信、灵活部署的多方隐私求交系统，确保数据可用不可见、数据处理模块可信度量和多方数据求交。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作一简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例提供的一种系统的结构示意图。图2是本发明实施例提供的多方隐私求交的步骤划分图。图3是本发明实施例提供的两方求交数据粗筛时序图。图4是本发明实施例提供的精确求交阶段流程图。图5是本发明实施例提供的标准X509证书与远程验证报告的关联关系图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。图1为本发明实施例中提供的一种基于可信执行环境和分布式数据求交算法的多方隐私求交方案的结构示意图，如图1所示，该基于可信执行环境和分布式数据求交算法的多方隐私求交方案包括：方法涉及的各个参与方的隐私求交客户端与隐私求交协调算子均基于可信执行环境进行实现与生产部署。整体由图1例举的3个参与方组成。各参与方的隐私求交客户端连接自身域内的数据仓库，并与域外的隐私求交协调算子通过可信安全隧道进行连接，各个参与方的隐私求交客户端间网络隔离。具体地，依据本发明实施例中提供的基于可信执行环境 和分布式数据求交算法的多方隐私求交方案进行一次多方隐私求交，需要经过四个阶段。图2为本发明实施例中提供的一种基于可信执行环境和分布式数据求交算法的多方隐私求交方案的一次多方隐私求交的步骤划分图。如图2所示，完整步骤划分为：数据预处理、多方参数协商、求交数据粗筛、数据精确求交四个阶段，其中数据预处理阶段由各个参与方在线下离线执行，另外三个阶段在线上执行。数据预处理阶段仅涉及隐私求交客户端和数据仓库。由隐私求交客户端从数据仓库读取待求交数据，使用哈希算法对数据进行分桶，对分桶后的桶内数据进行排序，最后将处理后的数据存储到数据仓库。多方参数协商阶段涉及隐私求交客户端、隐私求交协调算子和数据仓库。各个参与方的隐私求交客户端从数据仓库获取各个桶内数据的数据量，通过可信安全连接发送给隐私求交协调算子，隐私求交协调算子收集各个参与方的各个桶内数据的数据量后，分别计算各个桶内数据的最大数据量，并把各个桶内数据的最大数据量通过可信安全连接发送给各个参与方的隐私求交客户端，隐私求交客户端使用该数据量作为构建本地布隆过滤器的参数。求交数据粗筛阶段涉及隐私求交客户端、隐私求交协调算子和数据仓库。以两方为例，如图3求交数据粗筛时序图所示，隐私求交客户端使用多方参数协商阶段的结果构建各个桶的本地布隆过滤器，然后通过可信安全连接分别发送各个桶的本地布隆过滤器给隐私求交协调算子，隐私求交协调算子在收集到各个参与方对各个桶构建的本地布隆过滤器后，对同一个桶不同参与方的本地布隆过滤器进行按位与操作，得到各个桶的布隆过滤器交集，通过可信安全连接把各个桶的布隆过滤器交集发送给各个参与方的隐私求交客户端，各个参与方的隐私求交客户端使用收到的各个桶的布隆过滤器分别对桶内的数据进行过滤，完成交集数据的粗筛。数据精确求交阶段涉及隐私求交客户端、隐私求交协调算子和数据仓库。隐私求交客户端分别对各个桶内的数据依次发送给隐私求交协调算子，同时分别接收从隐私计算协调算子发送的各个桶的交集数据的索引，根据索引获取到交集数据，并把交集数据存储到数据仓库。隐私求交协调算子接受各个参与方的隐私求交客户端发送的各个桶内的数据，对于每一个桶执行如图4的流程：先选择堆中缺少的一个参与方；判断其是否还有未入堆的数据，如果没有则说明求交结束，如果有则把一个数据入堆；判断此时最小堆是否是满的，如果未满，回到步骤，如果满，到步骤；判断最小堆中所有元素是否都相等，如果不都相等，取出最小元素，回到步骤，如果都相等，则找到一个交集数据，到步骤；堆中所有元素出堆，分别记录每个参与方该元素的索引到交集索引位图，回到步骤；隐私求交客户端和隐私求交协调算子间可信安全连接的建立基于标准的TLS握手协议，区别在于使用的X509证书由TEE内动态生成，并且把远程验证报告嵌入X509证书的V3拓展部分，从而验证X509证书的有效性从验证CA的签名变成验证远程验证报告。 X509证书与远程验证报告的关系如图5所示，其中X509证书的公钥和远程验证报告内容中的公钥是同一把公钥。综上所述，本发明实施例中提供的基于可信执行环境和分布式数据求交算法的多方隐私求交方案能够利用可信执行环境 保证原始求交数据只有大概率为交集数据的数据出域，所有原始数据不出TEE，从而保证数据的安全，同时较少的网络交互轮次与密码运算保证了性能对比明文的数据求交的损耗较少。以上所描述的装置实施例仅仅是示意性的，其中所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部模块来实现本实施例方案的目的。本领域普通技术人员在不付出创造性的劳动的情况下，即可以理解并实施。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
