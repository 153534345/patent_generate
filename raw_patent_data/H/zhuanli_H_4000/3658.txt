标题title
一种电磁泄漏视频检测及还原系统
摘要abst
本发明提出的一种电磁泄漏视频检测及还原系统，属于计算机安全防护技术领域。所述包括：射频模块、频谱分析模块、TEMPEST频点识别模块、数字下变频模块、行频识别模块、场频识别模块、参数计算模块、场同步检测模块和图像恢复模块。本发明首先使用TEMPEST频点识别算法筛选出疑似电磁泄漏信号，然后使用内部检测模块提取信号特征，从而自动识别电磁泄漏信号的参数，并通过高效同步检测模块确定场同步点，能够一次恢复出无需后续调整的图像。
权利要求书clms
1.一种电磁泄漏视频检测及还原系统，其特征在于，包括：射频模块、频谱分析模块、TEMPEST频点识别模块、数字下变频模块、行频识别模块、场频识别模块、参数计算模块、场同步检测模块和图像恢复模块；所述射频模块，用于将天线信号转换为中频数据；所述频谱分析模块，用于中频数据进行FFT变换，得到中频频谱，从中频频谱中识别出频点和带宽，并设定采样率为fs；所述TEMPEST频点识别模块，用于将频点和带宽与预设的泄露频率表进行比对，查找出带宽超过5M且频点和表内频点相近的频率，作为识别频率，并将识别频率发送至射频模块；所述数字下变频模块，用于接收射频模块发送的识别频率，并输出识别频率的基带信号S1；所述行频识别模块，用于判定基带信号S1是否TEMPEST信号，并计算出行频fH；所述场频识别模块，用于根据基带信号S1计算出场频fV；所述参数计算模块，用于通过行频fH和场频fV相应的时序参数；所述场同步检测模块，用于使用时序参数通过预设算法得到场同步点实际位置；所述图像恢复模块，用于根据场同步点实际位置输出图像并存储。2.根据权利要求1所述的电磁泄漏视频检测及还原系统，其特征在于，所述预设的泄露频率表在VESA标准的DMT表格定义的像素点频率列表基础上构建，表中涵盖了像素点频率的三次谐波。3.根据权利要求1所述的电磁泄漏视频检测及还原系统，其特征在于，所述判定基带信号S1是否TEMPEST信号，并计算出行频fH，包括：对基带信号S1取出N点进行FFT运算，得到功率谱值P1；检测所有的峰值，如果都是等间隔，则计算出频谱峰值间隔点m，根据采样率计算出频率间隔为fH = fs/N*m；在VESA标准的DMT表格定义的水平速率列表中搜索fH，如果能搜索到，则说明基带信号S1是TEMPEST频点，且行频为fH。4.根据权利要求1所述的电磁泄漏视频检测及还原系统，其特征在于，所述根据基带信号S1计算出场频fV，包括：对基带信号S1取出M点进行D1倍降采样和低通滤波，得到滤波信号S2；搜索S2的峰值，根据间隔点数k、采样率fs和降采样率D1可以得到峰值的频率fV=fs/；在VESA标准的DMT表格定义的刷新率列表中搜索fV，如果能搜索到，则说明基带信号S1的场频为fV。5.根据权利要求1所述的电磁泄漏视频检测及还原系统，其特征在于，所述通过行频fH和场频fV获取相应的时序参数，包括：在VESA标准的DMT表格中以行频fH作为水平速率、场频fV作为刷新率查找对应的像素格式；在时序定时标准中找到该像素格式对应的时序参数。6.根据权利要求5所述的电磁泄漏视频检测及还原系统，其特征在于，所述时序参数包括：V Front Porch、Ver Sync Time、V Back Porch、Ver Total Time和Hor Total Time。7.根据权利要求6所述的电磁泄漏视频检测及还原系统，其特征在于，所述使用时序参数通过预设算法得到场同步点实际位置，包括：根据时序参数VFP=V Front Porch 、VST=Ver Sync Time 、VBP=V Back Porch构造同步检测图样P1，同步检测图样P1长度为L=n1+n2+n3；其中， n1 = fs/fH*VFP，n2 = fs/fH*VST，n3= fs/fH*VBP；将输入基带数据S1进行求模运算，得到过程信号S3；将过程信号S3和同步检测图样P1分别降采样，降采样率为D2，得到过程信号S4和降采样图样P2；将过程信号S4和降采样图样P2互相关运算，记录第一个峰值点位置I1；将过程信号S3偏移到*D2的位置，取出长度的过程信号S5，并和同步检测图样P1进行互相关运算，记录最大峰值点位置I2，由此得到场同步位置为*D2+I2-n1；根据时序参数计算每行点数。8.根据权利要求7所述的电磁泄漏视频检测及还原系统，其特征在于，所述根据时序参数计算每行点数，包括：根据采样率fs、Tvt=Ver Total Time、THT=Hor Total Time计算出实际每行的采样点数。9.根据权利要求8所述的电磁泄漏视频检测及还原系统，其特征在于，所述图像恢复模块，具体用于：从过程信号S3的场同步点开始，读取一帧的数据，将数据按照行列进行排列、插值，最后按照YUV格式写入文件。
说明书desc
技术领域本发明涉及计算机安全防护技术领域，更具体的说是涉及一种电磁泄漏视频检测及还原系统。背景技术电子信息设备在工作时会以电磁波的形式泄漏辐射波，该辐射波在自由空间传播，可以使用接收机截获该信号并进行分析和还原，这种技术统称为电磁信息泄漏技术。计算机是非常通用的信息处理设备，它在工作中时会产生电磁泄漏，这些电磁泄漏信号可能包含显示器显示的图像、视频内容及计算机的硬件信息。攻击者可以获取显示器硬件信息及图像信息，造成严重的失密。同样地对于防控者来说，可以使用电磁泄漏信号识别技术对计算机进行识别，及时发现信息泄漏源并进行有效防控。当前，业界主要采用以下两种方案将电磁泄漏视频信号复原为图像或视频信息：1、首先对由电流卡钳从视频线缆处采集的电磁泄漏视频信号执行行频获取和点频获取，分别获取到该信号的行频及点频；再根据行频及点频的数值执行图像呈像步骤，则可实现将电磁泄漏视频信号复原为图像信息。但是，此方案要求采样频率在点频的2倍以上。根据VESA标准，点频最大可到552MHz,这就要求采样率达到1.1GHz以上，不光硬件难以实现，软件也会由于采样率过高带来的运算复杂度高、存储空间过大、传输带宽过大而难以工程化。而且，利用电流卡钳获取信号，难以应用于实际场景。另外，复原的图像会存在扭曲、偏移等问题：虽然会使用额外的步骤去做修复，但是需要人工操作，智能性不高。2、首先人工调节射频接收机的接收频段，使用20MHz左右的采样率接收电磁泄漏的射频信号，转换为基带信号；通过信号自相关得到场频，手动输入行频和分辨率，通过还原、插值等算法得到复原的图像信息。但是，此方案既无法自动识别射频的频点和带宽，也无法自动识别分辨率和行频等参数，均需要人工进行输入。而且，复原的图像会存在偏移等问题，需要人工操作去修正。发明内容针对现有技术中存在的问题，本发明的目的在于提供一种电磁泄漏视频检测及还原系统。本发明为实现上述目的，通过以下技术方案实现：一种电磁泄漏视频检测及还原系统，包括：射频模块、频谱分析模块、TEMPEST频点识别模块、数字下变频模块、行频识别模块、场频识别模块、参数计算模块、场同步检测模块和图像恢复模块；所述射频模块，用于将天线信号转换为中频数据；所述频谱分析模块，用于中频数据进行FFT变换，得到中频频谱，从中频频谱中识别出频点和带宽，并设定采样率为fs；所述TEMPEST频点识别模块，用于将频点和带宽与预设的泄露频率表进行比对，查找出带宽超过5M且频点和表内频点相近的频率，作为识别频率，并将识别频率发送至射频模块；所述数字下变频模块，用于接收射频模块发送的识别频率，并输出识别频率的基带信号S1；所述行频识别模块，用于判定基带信号S1是否TEMPEST信号，并计算出行频fH；所述场频识别模块，用于根据基带信号S1计算出场频fV；所述参数计算模块，用于通过行频fH和场频fV相应的时序参数；所述场同步检测模块，用于使用时序参数通过预设算法得到场同步点实际位置；所述图像恢复模块，用于根据场同步点实际位置输出图像并存储。进一步，预设的泄露频率表在VESA标准的DMT表格定义的像素点频率列表基础上构建，表中涵盖了像素点频率的三次谐波。进一步，所述判定基带信号S1是否TEMPEST信号，并计算出行频fH，包括：对基带信号S1取出N点进行FFT运算，得到功率谱值P1；检测所有的峰值，如果都是等间隔，则计算出频谱峰值间隔点m，根据采样率计算出频率间隔为fH = fs/N*m；在VESA标准的DMT表格定义的水平速率列表中搜索fH，如果能搜索到，则说明基带信号S1是TEMPEST频点，且行频为fH。进一步，所述根据基带信号S1计算出场频fV，包括：对基带信号S1取出M点进行D1倍降采样和低通滤波，得到滤波信号S2；搜索S2的峰值，根据间隔点数k、采样率fs和降采样率D1可以得到峰值的频率fV=fs/；在VESA标准的DMT表格定义的刷新率列表中搜索fV，如果能搜索到，则说明基带信号S1的场频为fV。进一步，所述通过行频fH和场频fV获取相应的时序参数，包括：在VESA标准的DMT表格中以行频fH作为水平速率、场频fV作为刷新率查找对应的像素格式；在时序定时标准中找到该像素格式对应的时序参数。进一步，时序参数包括：V Front Porch、Ver Sync Time、V Back Porch、VerTotal Time和Hor Total Time。进一步，所述使用时序参数通过预设算法得到场同步点实际位置，包括：根据时序参数VFP=V Front Porch 、VST=Ver Sync Time 、VBP=V Back Porch构造同步检测图样P1，同步检测图样P1长度为L=n1+n2+n3；其中， n1 = fs/fH*VFP，n2 = fs/fH*VST，n3 = fs/fH*VBP；将输入基带数据S1进行求模运算，得到过程信号S3；将过程信号S3和同步检测图样P1分别降采样，降采样率为D2，得到过程信号S4和降采样图样P2；将过程信号S4和降采样图样P2互相关运算，记录第一个峰值点位置I1；将过程信号S3偏移到*D2的位置，取出长度的过程信号S5，并和同步检测图样P1进行互相关运算，记录最大峰值点位置I2，由此得到场同步位置为*D2+I2-n1；根据时序参数计算每行点数。进一步，所述根据时序参数计算每行点数，包括：根据采样率fs、Tvt=Ver Total Time、THT=Hor Total Time计算出实际每行的采样点数。进一步，图像恢复模块，具体用于：从过程信号S3的场同步点开始，读取一帧的数据，将数据按照行列进行排列、插值，最后按照YUV格式写入文件。对比现有技术，本发明有益效果在于：本发明提供了一种电磁泄漏视频检测及还原系统，首先使用TEMPEST频点识别算法筛选出疑似电磁泄漏信号，然后使用内部检测模块提取信号特征，从而自动识别电磁泄漏信号的参数，并通过高效同步检测模块确定场同步点，能够一次恢复出无需后续调整的图像。本系统尤其适用于FPGA或DSP，可以自动识别市面上多种多样的泄露信号。由此可见，本发明与现有技术相比，具有突出的实质性特点和显著的进步，其实施的有益效果也是显而易见的。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据提供的附图获得其他的附图。附图1是本发明具体实施方式的系统结构图。附图2是本发明具体实施方式的基带信号功率谱示意图。附图3是本发明具体实施方式的基带信号滤波后的示意图。附图4是本发明具体实施方式的同步检测图样示意图。附图5是本发明具体实施方式的256倍降采样后的信号示意图。附图6是本发明具体实施方式的过程信号S4和降采样图样P2互相关的结果示意图。附图7是本发明具体实施方式的过程信号S5和同步检测图样P1互相关的结果示意图。具体实施方式下面结合附图对本发明的具体实施方式做出说明。如图1所示的一种电磁泄漏视频检测及还原系统，包括：射频模块、频谱分析模块、TEMPEST频点识别模块、数字下变频模块、行频识别模块、场频识别模块、参数计算模块、场同步检测模块和图像恢复模块。射频模块，用于将天线信号转换为中频数据。频谱分析模块，用于中频数据进行FFT变换，得到中频频谱，从中频频谱中识别出频点和带宽，并设定采样率为fs。TEMPEST频点识别模块，用于将频点和带宽与预设的泄露频率表进行比对，查找出带宽超过5M且频点和表内频点相近的频率，作为识别频率，并将识别频率发送至射频模块。其中，预设的泄露频率表在VESA标准的DMT表格定义的像素点频率列表基础上构建，表中涵盖了像素点频率的三次谐波。可见，本模块实现了通过有效射频信号中心频率值与带宽确定疑似TEMPEST频点，通过行频估计确定TEMPEST频点。数字下变频模块，用于接收射频模块发送的识别频率，并输出识别频率的基带信号S1。行频识别模块，用于判定基带信号S1是否TEMPEST信号，并计算出行频fH。具体来说，如图2所示，首先对基带信号S1取出N点进行FFT运算，得到功率谱值P1。然后，检测所有的峰值，如果都是等间隔，则计算出频谱峰值间隔点m，根据采样率计算出频率间隔为fH = fs/N*m。最后，在VESA标准的DMT表格定义的水平速率列表中搜索fH，如果能搜索到，则说明基带信号S1是TEMPEST频点，且行频为fH。场频识别模块，用于根据基带信号S1计算出场频fV。如图3所示场频识别模块首先对基带信号S1取出M点进行D1倍降采样和低通滤波，得到滤波信号S2。然后搜索S2的峰值，根据间隔点数k、采样率fs和降采样率D1可以得到峰值的频率fV=fs/。最后，在VESA标准的DMT表格定义的刷新率列表中搜索fV，如果能搜索到，则说明基带信号S1的场频为fV。可见，本模块通过滤波器设计及特征提取和计算，确定信号场频，以实现场频识别。参数计算模块，用于通过行频fH和场频fV获取相应的时序参数。具体的，参数计算模块用于：在VESA标准的DMT表格中以行频fH作为水平速率、场频fV作为刷新率查找对应的像素格式。然后，在时序定时标准中找到该像素格式对应的时序参数。时序参数包括：V Front Porch、Ver Sync Time、V Back Porch、Ver Total Time和Hor Total Time。场同步检测模块，用于使用时序参数通过预设算法得到场同步点实际位置。场同步检测模块具体用于：首先，根据时序参数VFP=V Front Porch 、VST=Ver Sync Time 、VBP=V Back Porch构造同步检测图样P1，同步检测图样P1长度为L=n1+n2+n3；如图4所示，图中，n1表示占据n1个样点，n2和n3相同,1和-1为设定的幅值。其中， n1 = fs/fH*VFP，n2 = fs/fH*VST，n3 = fs/fH*VBP。将输入基带数据S1进行求模运算，得到过程信号S3。此时，如图5、图6所示，将过程信号S3和同步检测图样P1分别降采样，降采样率为D2，得到过程信号S4和降采样图样P2。并将过程信号S4和降采样图样P2互相关运算，记录第一个峰值点位置I1。将过程信号S3偏移到*D2的位置，取出长度的过程信号S5，并如图7所示，将过程信号S5和同步检测图样P1进行互相关运算，记录最大峰值点位置I2，由此得到场同步位置为*D2+I2-n1。最后，根据时序参数计算每行点数。具体的，根据采样率fs、Tvt=Ver Total Time、THT=Hor Total Time计算出实际每行的采样点数。本模块通过构造同步序列，先将信号和同步序列降采样互相关得到同步点的大致位置，最后在小范围内将信号和同步序列互相关得到同步点的精确位置，从而实现了场同步位置检测功能。图像恢复模块，用于从过程信号S3的场同步点开始，读取一帧的数据，将数据按照行列进行排列、插值，最后按照YUV格式写入文件。需要特别说明的是，在本发明的实施例中，附图2至附图7均为使用软件无线电平台采集的电磁泄漏信号基带数据，然后通过matlab仿真得到的图样效果图。本领域的技术人员可以清楚地了解到本发明实施例中的技术可借助软件加必需的通用硬件平台的方式来实现。基于这样的理解，本发明实施例中的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中如U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质，包括若干指令用以使得一台计算机终端执行本发明各个实施例所述方法的全部或部分步骤。本说明书中各个实施例之间相同相似的部分互相参见即可。尤其，对于终端实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例中的说明即可。在本发明所提供的几个实施例中，应该理解到，所揭露的系统、系统和方法，可以通过其它的方式实现。例如，以上所描述的系统实施例仅仅是示意性的，例如，所述单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，系统或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本发明各个实施例中的各功能模块可以集成在一个处理单元中，也可以是各个模块单独物理存在，也可以两个或两个以上模块集成在一个单元中。同理，在本发明各个实施例中的各处理单元可以集成在一个功能模块中，也可以是各个处理单元物理存在，也可以两个或两个以上处理单元集成在一个功能模块中。结合附图和具体实施例，对本发明作进一步说明。应理解，这些实施例仅用于说明本发明而不用于限制本发明的范围。此外应理解，在阅读了本发明讲授的内容之后，本领域技术人员可以对本发明作各种改动或修改，这些等价形式同样落于本申请所限定的范围。
