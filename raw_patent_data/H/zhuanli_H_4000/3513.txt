标题title
中台评论系统
摘要abst
本申请涉及一种中台评论系统，包括：客户端，用于接收用户发布的至少一类评论；网关层，用于建立客户端与应用缓存层之间的连接，并对中台评论系统的流量进行监控；应用缓存层，用于通过网关层接收至少一类评论，并根据预设的第一多级缓存规则将至少一类评论存储至第一目标缓存空间；应用业务层，用于对第一目标缓存空间中存储的每类评论进行审核，得到每类评论的总评论数量和每类评论中每条评论对应曝光度，并基于每条评论对应曝光度，按照预设次序在目标显示位置对每类评论进行展示。由此，解决了相关技术中评论系统成本高，且不利于维护的问题，可以支撑所有资源，具备快速接入和扩展能力，具备可扩展性和高可靠性。
权利要求书clms
1.一种中台评论系统，其特征在于，包括：客户端，用于接收用户发布的至少一类评论；网关层，用于建立所述客户端与应用缓存层之间的连接，并对中台评论系统的流量进行监控；所述应用缓存层，用于通过所述网关层接收所述至少一类评论，并根据预设的第一多级缓存规则将所述至少一类评论存储至第一目标缓存空间；应用业务层，用于对所述第一目标缓存空间中存储的每类评论进行审核，得到所述每类评论的总评论数量和所述每类评论中每条评论对应曝光度，并基于所述每条评论对应曝光度，按照预设次序在目标显示位置对所述每类评论进行展示。2.根据权利要求1所述的中台评论系统，其特征在于，还包括：数据缓存层，用于通过设置于所述数据缓存层中的分布式缓存服务器将所述应用业务层的数据按照预设的第二多级缓存规则存储至第二目标缓存空间。3.根据权利要求2所述的中台评论系统，其特征在于，还包括：数据存储层，所述数据存储层中的分布式数据库与所述分布式缓存服务器相对应，以保持所述分布式数据库与所述分布式缓存服务器之间的数据一致性，便于所述中台评论系统中集群节点的添加或删除。4.根据权利要求1所述的中台评论系统，其特征在于，所述网关层包括：第一服务器代理和第二服务器代理，用于配置所述用户发布的所述至少一类评论；API网关，用于接收所述第一服务器代理和/或所述第二服务器代理访问数据API接口的请求，其中，所述请求包括所述至少一类评论的分发要求；RPC分发模块，用于在识别所述至少一类评论的分发要求为RPC分发时，发送所述至少一类评论至目标移动终端；异步MQ分发模块，用于在识别所述至少一类评论的分发要求为异步MQ分发时，发送所述至少一类评论至所述目标移动终端。5.根据权利要求4所述的中台评论系统，其特征在于，所述网关层还用于：接收所述中台评论系统发送的鉴权请求，所述鉴权请求用于请求所述至少一类评论的合法性；基于预设的鉴权算法，根据所述鉴权请求对所述至少一类评论进行鉴权处理，并将所述至少一类评论中鉴权通过的评论发送至所述应用缓存层。6.根据权利要求5所述的中台评论系统，其特征在于，所述网关层还用于：将所述至少一类评论中鉴权未通过的评论拉入黑名单。7.根据权利要求4所述的中台评论系统，其特征在于，所述网关层还用于：对所述API网关的流量和链路进行监控，并在所述API网关的流量和所述链路出现异常时，发送异常信息至预设终端。8.根据权利要求1所述的中台评论系统，其特征在于，还包括：数据日志服务模块，用于记录所述网关层、所述应用缓存层和所述应用业务层的处理日志。9.根据权利要求3所述的中台评论系统，其特征在于，所述分布式数据库还用于：识别当前评论系统是否为多个系统；如果所述当前评论系统为多个系统，则按照预设的分类原则对所述多个系统进行分类。10.根据权利要求9所述的中台评论系统，其特征在于，所述分布式数据库还用于：确定所述至少一类评论中每个评论的范围标识，其中，所述范围标识用于表征所述每个评论的资源范围。
说明书desc
技术领域本申请涉及网络通信技术领域，特别涉及一种中台评论系统。背景技术信息化时代，人们对于社交的需求与日俱增，在日常生活、工作、娱乐等等各方面，都或多或少的渴望分享，与人沟通，于是各大系统的评论系统往往都是很精彩的，从最开始的点评到现在可能涉及的做交流，记录等各方面的需求都日渐增多。然而，如果每个系统都单独设计一套评论系统，不仅增加了各自系统人员的开发成本，而且对于不同系统来说，同系统下的不同模块对评论的需求均会有所不同，评论系统的设计也是五花八门，也不利于统一维护。发明内容本申请提供一种中台评论系统，以解决相关技术中评论系统成本高，且不利于维护的问题，可以支撑所有资源，具备快速接入和扩展能力，具备可扩展性和高可靠性。本申请实施例提供一种中台评论系统，包括：客户端，用于接收用户发布的至少一类评论；网关层，用于建立所述客户端与应用缓存层之间的连接，并对中台评论系统的流量进行监控；所述应用缓存层，用于通过所述网关层接收所述至少一类评论，并根据预设的第一多级缓存规则将所述至少一类评论存储至第一目标缓存空间；应用业务层，用于对所述第一目标缓存空间中存储的每类评论进行审核，得到所述每类评论的总评论数量和所述每类评论中每条评论对应曝光度，并基于所述每条评论对应曝光度，按照预设次序在目标显示位置对所述每类评论进行展示。根据上述技术手段，解决了相关技术中评论系统成本高，且不利于维护的问题，可以支撑所有资源，具备快速接入和扩展能力。可选地，上述的中台评论系统，还包括：数据缓存层，用于通过设置于所述数据缓存层中的分布式缓存服务器将所述应用业务层的数据按照预设的第二多级缓存规则存储至第二目标缓存空间。根据上述技术手段，设置数据缓存层，对后台数据做Memcached缓存。可选地，上述的中台评论系统，还包括：数据存储层，所述数据存储层中的分布式数据库与所述分布式缓存服务器相对应，以保持所述分布式数据库与所述分布式缓存服务器之间的数据一致性，便于所述中台评论系统中集群节点的添加或删除。根据上述技术手段，设置有数据存储库，数据存储库由分布式数据库构成，分布式数据库会进行数据的复制，不仅有利于性能的提高，且还能够满足不同用户的需求。可选地，所述网关层包括：第一服务器代理和第二服务器代理，用于配置所述用户发布的所述至少一类评论；API网关，用于接收所述第一服务器代理和/或所述第二服务器代理访问数据API接口的请求，其中，所述请求包括所述至少一类评论的分发要求；RPC分发模块，用于在识别所述至少一类评论的分发要求为RPC分发时，发送所述至少一类评论至目标移动终端；异步MQ分发模块，用于在识别所述至少一类评论的分发要求为异步MQ分发时，发送所述至少一类评论至所述目标移动终端。根据上述技术手段，可以根据用户的需求实现RPC分发和异步MQ分发。可选地，所述网关层还用于：接收所述中台评论系统发送的鉴权请求，所述鉴权请求用于请求所述至少一类评论的合法性；基于预设的鉴权算法，根据所述鉴权请求对所述至少一类评论进行鉴权处理，并将所述至少一类评论中鉴权通过的评论发送至所述应用缓存层。根据上述技术手段，实现对至少一类评论的鉴权，使得最终发布的评论均为正能量评论。可选地，所述网关层还用于：将所述至少一类评论中鉴权未通过的评论拉入黑名单。根据上述技术手段，实现对至少一类评论的鉴权，使得最终发布的评论均为正能量评论。可选地，所述网关层还用于：对所述API网关的流量和链路进行监控，并在所述API网关的流量和所述链路出现异常时，发送异常信息至预设终端。根据上述技术手段，实现对流量的实时监控。可选地，还包括：数据日志服务模块，用于记录所述网关层、所述应用缓存层和所述应用业务层的处理日志。根据上述技术手段，通过设置有数据日志服务模块，对中台评论系统中的操作数据进行记录，便于后期查看。可选地，所述分布式数据库还用于：识别当前评论系统是否为多个系统；如果所述当前评论系统为多个系统，则按照预设的分类原则对所述多个系统进行分类。根据上述技术手段，可以根据实际需要进行扩展，且支持多资源。可选地，所述分布式数据库还用于：确定所述至少一类评论中每个评论的范围标识，其中，所述范围标识用于表征所述每个评论的资源范围。根据上述技术手段，可以更方便后期的查询与维护。由此，本申请实施例的中台评论系统，具有以下优点：支撑所有资源，且具备快速接入和扩展能力；具备各种功能，热评，盖楼等，且规则复杂，支持各种排序；能产生热门资源，支持常规流量高以及高QPS。本申请附加的方面和优点将在下面的描述中部分给出，部分将从下面的描述中变得明显，或通过本申请的实践了解到。附图说明本申请上述的和/或附加的方面和优点从下面结合附图对实施例的描述中将变得明显和容易理解，其中：图1为根据本申请实施例提供的一种中台评论系统的方框示意图；图2为根据本申请一个实施例的中台评论系统的结构示例图；图3为根据本申请一个实施例的网关设计的示例图；图4为根据本申请一个实施例的缓存设计的示例图；图5为根据本申请一个实施例的数据库ER的示例图；图6为根据本申请一个实施例的评论发布的流程图。附图标记：10-中台评论系统、100-客户端、200-网关层、300-应用缓存层、400-应用业务层、500-数据缓存层、600-数据存储层。具体实施方式下面详细描述本申请的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，旨在用于解释本申请，而不能理解为对本申请的限制。下面参考附图描述本申请实施例的中台评论系统。针对上述背景技术中心提到的相关技术中评论系统成本高，且不利于维护的问题，本申请提供了一种中台评论系统，可以通过客户端接收用户发布的至少一类评论，并通过应用缓存层将至少一类评论存储至目标缓存空间，并通过应用业务层对每类评论进行审核，得到每类评论的总评论数量和每类评论中每条评论对应曝光度，并基于每条评论对应曝光度，按照预设次序在目标显示位置对每类评论进行展示。由此，解决相关技术中评论系统成本高，且不利于维护的问题，可以支撑所有资源，具备快速接入和扩展能力，具备可扩展性和高可靠性。具体而言，图1为本申请实施例所提供的一种中台评论系统的方框示意图。如图1所示，该中台评论系统10包括：客户端100、网关层200、应用缓存层300和应用业务层400。其中，客户端100用于接收用户发布的至少一类评论；网关层200用于建立客户端100与应用缓存层300之间的连接，并对中台评论系统的流量进行监控；应用缓存层300用于通过网关层200接收至少一类评论，并根据预设的第一多级缓存规则将至少一类评论存储至第一目标缓存空间；应用业务层400用于对第一目标缓存空间中存储的每类评论进行审核，得到每类评论的总评论数量和每类评论中每条评论对应曝光度，并基于每条评论对应曝光度，按照预设次序在目标显示位置对每类评论进行展示。其中，第一目标缓存空间可以是用户预先设定的缓存空间，可以是通过有限次实验获取的缓存空间，也可以是通过有限次计算机仿真得到的缓存空间，在此不做具体限定，预设次序可以为曝光度由高到低的次序。可选地，在一些实施例中，如图2所示，上述的中台评论系统10，还包括：数据缓存层500。其中，用于通过设置于数据缓存层500中的分布式缓存服务器将应用业务层400的数据按照预设的第二多级缓存规则存储至第二目标缓存空间。其中，第二目标缓存空间可以是用户预先设定的缓存空间，可以是通过有限次实验获取的缓存空间，在此不做具体限定。可选地，在一些实施例中，如图2所示，上述的中台评论系统10，还包括：数据存储层600。其中，数据存储层600中的分布式数据库与分布式缓存服务器相对应，以保持分布式数据库与分布式缓存服务器之间的数据一致性，便于中台评论系统中集群节点的添加或删除。具体而言，如图2所示，客户端100可以包括手机、web端、电脑端、平板等，用户可以在手机、web端、电脑端或平板上面发表自己的评论。可选地，在一些实施例中，如图3所示，网关层200包括：第一服务器代理和第二服务器代理、API网关、RPC分发模块和异步MQ分发模块。其中，第一服务器代理和第二服务器代理用于配置用户发布的至少一类评论；API网关，用于接收第一服务器代理和/或第二服务器代理访问数据API接口的请求，其中，请求包括至少一类评论的分发要求；RPC分发模块，用于在识别至少一类评论的分发要求为RPC分发时，发送至少一类评论至目标移动终端；异步MQ分发模块，用于在识别至少一类评论的分发要求为异步MQ分发时，发送至少一类评论至目标移动终端，其中，目标移动终端指具有独立操作系统的电子终端设备，可以由用户自行安装软件、游戏的第三方服务商提供的程序，通过此类程序来不断对目标移动终端的功能进行扩充，并可以通过通信模块和其他智能设备进行数据交互的一类设备的总称。可选地，在一些实施例中，网关层200还用于：接收中台评论系统发送的鉴权请求，鉴权请求用于请求至少一类评论的合法性；基于预设的鉴权算法，根据鉴权请求对至少一类评论进行鉴权处理，并将至少一类评论中鉴权通过的评论发送至应用缓存层300，其中，预设的鉴权算法可以采用相关技术中的鉴权算法，主要是针对一些不符合规定评论，例如，恶意评论等。可选地，在一些实施例中，网关层200还用于：将至少一类评论中鉴权未通过的评论拉入黑名单。可选地，在一些实施例中，网关层200还用于：对API网关的流量和链路进行监控，并在API网关的流量和链路出现异常时，发送异常信息至预设终端。具体而言，网关作为关键的一环，需要具备重要的一项能力就是，常规单体服的更新发布是依赖于Nginx的配置，若需要上线新的服务，可能需要定向更改Nginx配置或者重启服务，故设计一个微服务网关，用来动态支持服务的更新以及缩扩容，可支持同城多活，异地多活，其应该支持的业务特性如下：异常流量拦截；流量控制；Api流量或者服务控制；风险控制；鉴权；链路监控等。并且，本申请实施例的网关层200的网关分发设计有常规RPC分发以及支持异步MQ分发，从而根据用户的需求选择RPC分发或异步MQ分发。进一步地，如图4所示，本申请实施例针对进行业务处理的需要返回给前端展示的数据做redis缓存，针对数据层的数据做Memcached缓存。需要说明的是，缓存设计原则是多级缓存，对各个层级分别做缓存，及应用展示层、数据缓存层500等都需要具备缓存，缓存会配置规则，比如热点key，长短key保证系统的高效。可选地，在一些实施例中，上述的中台评论系统，还包括：数据日志服务模块，用于记录网关层200、应用缓存层300和应用业务层400的处理日志。可选地，在一些实施例中，分布式数据库还用于：识别当前评论系统是否为多个系统；如果当前评论系统为多个系统，则按照预设的分类原则对多个系统进行分类。可选地，在一些实施例中，分布式数据库还用于：确定至少一类评论中每个评论的范围标识，其中，范围标识用于表征每个评论的资源范围。具体地，数据库的设计需要能扩展，支持多资源，常规的评论系统是为单一系统设计，涉及到多个系统接入的时候，需要对多个系统做对应的区分，当某个系统涉及到资源分层问题时，需要新增对应的资源标志，且如果时有父子层级的评论，其查询与维护都相当困难，本设计可以符合此需求，为每一个评论规划自己的资源范围，通过ID层面进行系统以及子模块的区分，无需关心我属于哪一个层级，只要ID符合规范，便只需要资源ID一个参数即可查出所有的数据，无需区分项目、资源、场景，然后在代码中进行评论快速分级组装成展示结构返回页面显示。具体而言，如图5所示，图5的和图5的为本申请一个实施例的中台评论系统最核心的ER示意图，其余需要根据自己业务去扩展，此ER图有一个相对需要重视的点，就是此处Comment表的ID主键，并非常规的自增、UUID、雪花算法等ID，而是采用了资源代号+ID的String字符串设计，以资源区分同项目不同模块，甚至可以以资源区分系统，这样无论接入什么资源，都可以通过ID去做筛选，不需要应对当接入系统过多时，查询的限制问题。当新的系统需要接入时，可以根据自己需要做评论的项目、模块申请对应的资源ID，可以选择是否具有父子或其他关联关系，也可以每个资源独立，后台在创建资源ID以后，进行对应的关系维护，配置扩展内容，如是否需要支持图片评论，是否支持视频评论等功能，根据配置同时进行建库建表，然后接入方根据统一的接入文档进行开发即可。为使得本领域技术人员进一步了解本申请实施例的中台评论系统，下面结合评论发布流程中异步处理的进行详细说明，具体而言，如图5所示，发布流程有一个非常关键的点就是异步，本申请实施例可以分两阶段提交，设计思想就是异步写入同步展示，即用户在前端发布之后，立即对C端可见，方案可以是异步返回之前展示，也可以是前端缓存展示，最终效果需要时本人立即可见，其他用户系统回馈成功之后可见。此外，本申请实施例可以通过异步化解决大批量热门资源同时评论点赞时采用同步方式会产生锁的问题，例如，本申请实施例可以采用评论不设计逻辑有序和消息体入库包含发表时间的方式解决消息有序问题；采用消息体包含数据库主键和数据库做唯一性约束的方式解决消息幂等问题；采用C端提前露出，其他人等待业务处理结果的方式解决消息延迟问题；并且，结合异步化解决数据库行锁问题，例如，本申请实施例可以设计一个手动事务，事务内部包含两个操作，即新增和更新操作，然后根据这两个事务的注解。根据本申请实施例提出的中台评论系统，可以通过客户端接收用户发布的至少一类评论，并通过应用缓存层将至少一类评论存储至目标缓存空间，并通过应用业务层对每类评论进行审核，得到每类评论的总评论数量和每类评论中每条评论对应曝光度，并基于每条评论对应曝光度，按照预设次序在目标显示位置对每类评论进行展示。由此，解决了相关技术中评论系统成本高，且不利于维护的问题，可以支撑所有资源，具备快速接入和扩展能力，具备可扩展性和高可靠性。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本申请的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不必须针对的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任一个或N个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本申请的描述中，“N个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。流程图中或在此以其他方式描述的任何过程或方法描述可以被理解为，表示包括一个或更N个用于实现定制逻辑功能或过程的步骤的可执行指令的代码的模块、片段或部分，并且本申请的优选实施方式的范围包括另外的实现，其中可以不按所示出或讨论的顺序，包括根据所涉及的功能按基本同时的方式或按相反的顺序，来执行功能，这应被本申请的实施例所属技术领域的技术人员所理解。在流程图中表示或在此以其他方式描述的逻辑和/或步骤，例如，可以被认为是用于实现逻辑功能的可执行指令的定序列表，可以具体实现在任何计算机可读介质中，以供指令执行系统、装置或设备使用，或结合这些指令执行系统、装置或设备而使用。就本说明书而言，"计算机可读介质"可以是任何可以包含、存储、通信、传播或传输程序以供指令执行系统、装置或设备或结合这些指令执行系统、装置或设备而使用的装置。计算机可读介质的更具体的示例包括以下：具有一个或N个布线的电连接部，便携式计算机盘盒，随机存取存储器，只读存储器，可擦除可编辑只读存储器，光纤装置，以及便携式光盘只读存储器。另外，计算机可读介质甚至可以是可在其上打印所述程序的纸或其他合适的介质，因为可以例如通过对纸或其他介质进行光学扫描，接着进行编辑、解译或必要时以其他合适方式进行处理来以电子方式获得所述程序，然后将其存储在计算机存储器中。应当理解，本申请的各部分可以用硬件、软件、固件或它们的组合来实现。在上述实施方式中，N个步骤或方法可以用存储在存储器中且由合适的指令执行系统执行的软件或固件来实现。如，如果用硬件来实现和在另一实施方式中一样，可用本领域公知的下列技术中的任一项或他们的组合来实现：具有用于对数据信号实现逻辑功能的逻辑门电路的离散逻辑电路，具有合适的组合逻辑门电路的专用集成电路，可编程门阵列，现场可编程门阵列等。本技术领域的普通技术人员可以理解实现上述实施例方法携带的全部或部分步骤是可以通过程序来指令相关的硬件完成，所述的程序可以存储于一种计算机可读存储介质中，该程序在执行时，包括方法实施例的步骤之一或其组合。此外，在本申请各个实施例中的各功能单元可以集成在一个处理模块中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个模块中。上述集成的模块既可以采用硬件的形式实现，也可以采用软件功能模块的形式实现。所述集成的模块如果以软件功能模块的形式实现并作为独立的产品销售或使用时，也可以存储在一个计算机可读取存储介质中。上述提到的存储介质可以是只读存储器，磁盘或光盘等。尽管上面已经示出和描述了本申请的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本申请的限制，本领域的普通技术人员在本申请的范围内可以对上述实施例进行变化、修改、替换和变型。
