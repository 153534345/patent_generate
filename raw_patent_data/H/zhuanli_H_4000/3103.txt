标题title
一种震荡检测方法、装置、电子设备和存储介质
摘要abst
本申请公开了一种震荡检测方法、装置、电子设备和存储介质，涉及计算机技术领域。所述方法包括：获取有效震荡事件次数以及相邻两次的有效震荡事件间隔；判断所述有效震荡事件间隔是否大于恢复间隔；若所述有效震荡事件间隔大于恢复间隔，计算所述有效震荡事件次数与第一震荡抑制阈值的比值；判断所述比值是否大于预警比值，得到第一判断结果；若所述第一判断结果为所述比值大于预警比值，记录当前所述有效震荡事件次数。本申请能够准确描述出当前链路的震荡情况，优化震荡检测，使得震荡检测更加准确。
权利要求书clms
1.一种震荡检测方法，其特征在于，包括：获取有效震荡事件次数以及相邻两次的有效震荡事件间隔；判断所述有效震荡事件间隔是否大于恢复间隔；若所述有效震荡事件间隔大于恢复间隔，计算所述有效震荡事件次数与第一震荡抑制阈值的比值；判断所述比值是否大于预警比值，得到第一判断结果；若所述第一判断结果为所述比值大于预警比值，记录当前所述有效震荡事件次数。2.根据权利要求1所述的震荡检测方法，其特征在于，在所述记录当前所述有效震荡事件次数之后，所述方法还包括：判断是否存在备份链路，得到第二判断结果；其中，第二判断结果包括存在备份链路以及不存在备份链路。3.根据权利要求2所述的震荡检测方法，其特征在于，若所述第二判断结果为存在备份链路，所述方法还包括：将当前震荡链路进入抑制状态，将业务流量路径切换到备份链路中；响应于检测到经过抑制时间，恢复所述震荡链路，将所述业务流量路径重新切换至所述震荡链路中；其中，所述抑制时间根据所述预警比值以及所述恢复间隔确定。4.根据权利要求2所述的震荡检测方法，其特征在于，若所述第二判断结果为不存在备份链路，所述方法还包括：将所述第一震荡抑制阈值进行动态修改，调整为当前所述有效震荡事件次数的数值，得到第二动态震荡抑制阈值。5.根据权利要求4所述的震荡检测方法，其特征在于，在所述将所述第一震荡抑制阈值进行动态修改，调整为当前所述有效震荡事件次数的数值，得到第二动态震荡抑制阈值之后，所述方法还包括：响应于检测到有效震荡事件次数大于等于所述第二动态震荡抑制阈值，将所述第二动态震荡抑制阈值重新调整为所述第一震荡抑制阈值。6.根据权利要求1所述的震荡检测方法，其特征在于，若所述第一判断结果为所述比值不大于预警比值，所述方法还包括：将所述有效震荡事件次数清零，以使得所述有效震荡事件次数重新进行计数。7.根据权利要求1所述的震荡检测方法，其特征在于，在所述记录当前所述有效震荡事件次数之后，所述方法还包括：将当前所述有效震荡事件次数上报至网管平台，以描述当前链路的链路情况。8.一种震荡检测装置，其特征在于，所述装置包括：震荡事件获取模块，用于获取有效震荡事件次数以及相邻两次的有效震荡事件间隔；第一判断模块，用于判断所述有效震荡事件间隔是否大于恢复间隔；计算模块，用于若所述有效震荡事件间隔大于恢复间隔，计算所述有效震荡事件次数与第一震荡抑制阈值的比值；第二判断模块，用于判断所述比值是否大于预警比值，得到第一判断结果；告警模块，用于若所述第一判断结果为所述比值大于预警比值，记录当前所述有效震荡事件次数。9.一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，其特征在于，所述处理器执行所述计算机程序时实现如权利要求1至7中任意一项所述震荡检测方法。10.一种计算机可读存储介质，存储有计算机可执行指令，其特征在于，所述计算机可执行指令用于执行权利要求1至7中任意一项所述震荡检测方法。
说明书desc
技术领域本申请涉及计算机技术领域，特别是涉及一种震荡检测方法、装置、电子设备和存储介质。背景技术开放式最短路径优先是广泛使用的一种动态路由协议，它属于链路状态路由协议。而OSPF接口状态在Up和Down之间切换，就会引起邻居状态的频繁震荡。此时，OSPF会快速发送Hello报文重新建立邻居，同步链路状态数据库，触发路由计算，会造成大量报文交互，影响现有邻居的稳定性，对OSPF业务造成较大影响，同时也会影响依赖OSPF的其他业务，如标签分发协议、边界网关协议的正常运行。OSPF业务的接口上最后一次邻居状态由Full切换为非Full，称之为震荡事件。震荡事件作为震荡源输入，用来触发检测机制启动工作。OSPF接口启动一个有效震荡事件计数器，相邻两次震荡事件的间隔在震荡检测间隔内，则记录为一次有效震荡，有效震荡事件计数器加一。当有效震荡事件次数大于等于震荡抑制阈值时，进入震荡抑制阶段。如果当有效震荡次数小于震荡抑制阈值时，且两次有效震荡事件的间隔大于恢复间隔，则有效震荡次数重新计数。在现有的震荡检测中，在有效震荡次数大于等于震荡阈值前，无论有效震荡次数积累多少次，只要两次有效震荡事件的间隔大于恢复间隔，则有效震荡次数就会重新进行计算，无法描述出链路情况。而且震荡检测间隔阈值为人为配置，可能会出现部分链路震荡导致业务受阻而无法抑制的情况。发明内容为了解决上述背景技术中提到的至少一个问题，本申请提供了一种震荡检测方法、装置、电子设备和存储介质，能够准确描述出当前链路的震荡情况，优化震荡检测，使得震荡检测更加准确。本申请实施例提供的具体技术方案如下：第一方面，提供一种震荡检测方法，包括：获取有效震荡事件次数以及相邻两次的有效震荡事件间隔；判断所述有效震荡事件间隔是否大于恢复间隔；若所述有效震荡事件间隔大于恢复间隔，计算所述有效震荡事件次数与第一震荡抑制阈值的比值；判断所述比值是否大于预警比值，得到第一判断结果；若所述第一判断结果为所述比值大于预警比值，记录当前所述有效震荡事件次数。进一步的，在所述记录当前所述有效震荡事件次数之后，所述方法还包括：判断是否存在备份链路，得到第二判断结果；其中，第二判断结果包括存在备份链路以及不存在备份链路。进一步的，若所述第二判断结果为存在备份链路，所述方法还包括：将当前震荡链路进入抑制状态，将业务流量路径切换到备份链路中；响应于检测到经过抑制时间，恢复所述震荡链路，将所述业务流量路径重新切换至所述震荡链路中；其中，所述抑制时间根据所述预警比值以及所述恢复间隔确定。进一步的，若所述第二判断结果为不存在备份链路，所述方法还包括：将所述第一震荡抑制阈值进行动态修改，调整为当前所述有效震荡事件次数的数值，得到第二动态震荡抑制阈值。进一步的，在所述将所述第一震荡抑制阈值进行动态修改，调整为当前所述有效震荡事件次数的数值，得到第二动态震荡抑制阈值之后，所述方法还包括：响应于检测到有效震荡事件次数大于等于所述第二动态震荡抑制阈值，将所述第二动态震荡抑制阈值重新调整为所述第一震荡抑制阈值。进一步的，若所述第一判断结果为所述比值不大于预警比值，所述方法还包括：将所述有效震荡事件次数清零，以使得所述有效震荡事件次数重新进行计数。进一步的，在所述记录当前所述有效震荡事件次数之后，所述方法还包括：将当前所述有效震荡事件次数上报至网管平台，以描述当前链路的链路情况。第二方面，提供一种震荡检测装置，所述装置包括：震荡事件获取模块，用于获取有效震荡事件次数以及相邻两次的有效震荡事件间隔；第一判断模块，用于判断所述有效震荡事件间隔是否大于恢复间隔；计算模块，用于若所述有效震荡事件间隔大于恢复间隔，计算所述有效震荡事件次数与第一震荡抑制阈值的比值；第二判断模块，用于判断所述比值是否大于预警比值，得到第一判断结果；告警模块，用于若所述第一判断结果为所述比值大于预警比值，记录当前所述有效震荡事件次数。第三方面，提供一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，所述处理器执行所述计算机程序时实现所述震荡检测方法。第四方面，提供一种计算机可读存储介质，存储有计算机可执行指令，所述计算机可执行指令用于执行所述震荡检测方法。本申请实施例具有如下有益效果：本申请实施例提供的一种震荡检测方法、装置、电子设备和存储介质，能够通过计算有效震荡事件次数与第一震荡抑制阈值的比值，并判断比值是否大于预警比值，来描述当前链路的链路情况，能够通过这种方式来优化震荡检测；另外，还能够根据当前链路是否存在备份链路，在震荡检测优化之后，针对不同的链路情况，采取不同的震荡抑制措施，使得震荡检测更加准确，同时能够让用户更清楚当前链路的链路情况。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1示出本申请实施例提供的震荡检测方法的总流程图；图2示出根据本申请一个实施例的震荡检测方法的具体流程图；图3示出本申请实施例提供的震荡检测装置的结构示意图；图4示出可被用于实施本申请中所述的各个实施例的示例性系统。具体实施方式为使本申请的目的、技术方案和优点更加清楚，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本申请保护的范围。应当理解，术语“第一”、“第二”等仅用于描述目的，而不能理解为指示或暗示相对重要性。此外，在本申请的描述中，除非另有说明，“多个”的含义是两个或两个以上。实施例一本申请提供了一种震荡检测方法，参照图1，包括：S1、获取有效震荡事件次数以及相邻两次的有效震荡事件间隔；S2、判断有效震荡事件间隔是否大于恢复间隔；S3、若有效震荡事件间隔大于恢复间隔，计算有效震荡事件次数与第一震荡抑制阈值的比值；S4、判断比值是否大于预警比值，得到第一判断结果；S5、若第一判断结果为比值大于预警比值，记录当前有效震荡事件次数。具体的，OSPF接口启动一个有效震荡事件计数器。其中，震荡事件是接口上最后一次邻居状态由Full切换为非Full，作为震荡源输入，用来触发检测机制启动工作。当相邻的两次震荡事件间隔小于震荡检测间隔时，将识别为一次有效震荡事件，有效震荡事件计数器加一，即上述获取的有效震荡事件次数，而根据有效震荡事件可以获取到相邻两次的有效震荡事件间隔。在震荡检测中，上述震荡检测间隔、第一震荡抑制阈值以及恢复间隔是重要的三个参数，用户可以根据业务需求自行配置。其中，当有效震荡事件次数大于等于第一震荡抑制阈值时，会触发进入震荡抑制阶段。而当有效震荡次数小于第一震荡抑制阈值时，同时相邻两次的有效震荡事件间隔大于恢复间隔，一般会重新进行计数，但是这样会导致无法体现出当前链路的链路情况。因此，还可以通过计算有效震荡事件次数与第一震荡抑制阈值的比值，判断该比值是否大于预警比值，来反映出当前链路的震荡水平，进而优化震荡检测，针对该链路作出不同的处理。其中，预警比值也可以根据用户的业务需求进行配置，例如可以配置为50％、60％、70％等等。下面将结合图2进行进一步的说明：在一些实施方式中，在S5之后，方法还包括：S6、判断是否存在备份链路，得到第二判断结果；其中，第二判断结果包括存在备份链路以及不存在备份链路。具体的，可以根据当前链路有无备份链路，将震荡检测优化之后，针对链路的不同情况，作出不同的处理，使得保证震荡检测更加准确的同时，避免对当前链路的业务产生影响。在一些实施方式中，若第二判断结果为存在备份链路，方法还包括：S71、将当前震荡链路进入抑制状态，将业务流量路径切换到备份链路中；S72、响应于检测到经过抑制时间，恢复震荡链路，将业务流量路径重新切换至震荡链路中；其中，抑制时间根据预警比值以及恢复间隔确定。具体的，如果存在备份链路，则该链路有效震荡次数虽然未达到第一震荡抑制阈值，但仍对该链路做抑制处理，可以将业务流量路径切换到备份链路中，但该抑制结束时间的判断条件不在是两次有效震荡事件的间隔大于恢复间隔，而是变为一个动态抑制时间。示例性的，假设预警比值a值为50％，恢复间隔为10s，则抑制时间为5s。当抑制时间过去之后，则重新恢复该震荡链路，通过采用这样的方式，对业务产生的影响较小。在一些实施方式中，若第二判断结果为不存在备份链路，方法还包括：101、将第一震荡抑制阈值进行动态修改，调整为当前有效震荡事件次数的数值，得到第二动态震荡抑制阈值。在一些实施方式中，在101之后，方法还包括：102、响应于检测到有效震荡事件次数大于等于第二动态震荡抑制阈值，将第二动态震荡抑制阈值重新调整为第一震荡抑制阈值。具体的，如果当前链路不存在备份链路，则不能进行备份链路的切换，但是此时链路可能存在震荡抑制阈值较大，链路可能发生较多震荡事件导致业务受到影响。因此，可以通过将下一次震荡抑制阈值进行动态修改，以防止震荡抑制阈值设置过大。如果下次产生了震荡抑制，则此时的震荡抑制阈值可以重新更改为默认值，即更改为之前的第一震荡抑制阈值。如未产生震荡抑制，则保持该值不变。在一些实施方式中，若第一判断结果为比值不大于预警比值，方法还包括：将有效震荡事件次数清零，以使得有效震荡事件次数重新进行计数。示例性的，例如若计算得到的有效震荡事件次数与第一震荡抑制阈值的比值不大于50％，则无需进行预警，即无需关注此时的链路状态，则可以使得有效震荡事件次数重新进行计数。当有效震荡事件次数与第一震荡抑制阈值的比值大于50％时，再预警提示管理人员需要对该链路进行关注。在一些实施方式中，在S5之后，方法还包括：将当前有效震荡事件次数上报至网管平台，以描述当前链路的链路情况。示例性的，例如当有效震荡事件次数与第一震荡抑制阈值的比值大于50％时，可以记录此时的当前有效震荡事件次数，并将当前有效震荡事件次数上报至网管平台，提醒管理人员需要对该链路进行关注；同时管理人员可以根据上报的当前有效震荡事件次数判断当前链路的链路情况。在本实施例中，能够通过计算有效震荡事件次数与第一震荡抑制阈值的比值，并判断比值是否大于预警比值，来描述当前链路的链路情况，能够通过这种方式来优化震荡检测；另外，还能够根据当前链路是否存在备份链路，在震荡检测优化之后，针对不同的链路情况，采取不同的震荡抑制措施，使得震荡检测更加准确，同时能够让用户更清楚当前链路的链路情况。需要注意的是，术语“S1”、“S2”等仅用于步骤的描述目的，并非特别指称次序或顺位的意思，亦非用以限定本申请，其仅仅是为了方便描述本申请的方法，而不能理解为指示步骤的先后顺序。另外，各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当认为这种技术方案的结合不存在，也不在本申请要求的保护范围之内。实施例二对应上述实施例，本申请还提供了一种震荡检测装置，参照图3，所述装置包括震荡事件获取模块、第一判断模块、计算模块、第二判断模块以及告警模块。其中，震荡事件获取模块，用于获取有效震荡事件次数以及相邻两次的有效震荡事件间隔；第一判断模块，用于判断所述有效震荡事件间隔是否大于恢复间隔；计算模块，用于若所述有效震荡事件间隔大于恢复间隔，计算所述有效震荡事件次数与第一震荡抑制阈值的比值；第二判断模块，用于判断所述比值是否大于预警比值，得到第一判断结果；告警模块，用于若所述第一判断结果为所述比值大于预警比值，记录当前所述有效震荡事件次数。进一步的，所述装置还包括第三判断模块，用于判断是否存在备份链路，得到第二判断结果；其中，第二判断结果包括存在备份链路以及不存在备份链路。进一步的，若所述第二判断结果为存在备份链路，装置还包括抑制管理模块，用于将当前震荡链路进入抑制状态，将业务流量路径切换到备份链路中；以及用于响应于检测到经过抑制时间，恢复所述震荡链路，将所述业务流量路径重新切换至所述震荡链路中；其中，所述抑制时间根据所述预警比值以及所述恢复间隔确定。进一步的，若所述第二判断结果为不存在备份链路，抑制管理模块还用于将所述第一震荡抑制阈值进行动态修改，调整为当前所述有效震荡事件次数的数值，得到第二动态震荡抑制阈值。进一步的，抑制管理模块还用于响应于检测到有效震荡事件次数大于等于所述第二动态震荡抑制阈值，将所述第二动态震荡抑制阈值重新调整为所述第一震荡抑制阈值。进一步的，若所述第一判断结果为所述比值不大于预警比值，计算模块还用于将所述有效震荡事件次数清零，以使得所述有效震荡事件次数重新进行计数。进一步的，告警模块还用于将当前所述有效震荡事件次数上报至网管平台，以描述当前链路的链路情况。关于震荡检测装置的具体限定可以参见上文中对于震荡检测方法实施例中的相关限定，故此处不作赘述。上述震荡检测装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。实施例三对应上述实施例，本申请还提供了一种电子设备，包括存储器、处理器及存储在存储器上并可在处理器上运行的计算机程序，处理器执行程序时可以实现上述震荡检测方法。如图4所示，在一些实施例中，系统能够作为各所述实施例中的任意一个用于震荡检测方法的上述电子设备。在一些实施例中，系统可包括具有指令的一个或多个计算机可读介质以及与该一个或多个计算机可读介质耦合并被配置为执行指令以实现模块从而执行本申请中所述的动作的一个或多个处理器处理器)。对于一个实施例，系统控制模块可包括任意适当的接口控制器，以向处理器中的至少一个和/或与系统控制模块通信的任意适当的设备或组件提供任意适当的接口。系统控制模块可包括存储器控制器模块，以向系统存储器提供接口。存储器控制器模块可以是硬件模块、软件模块和/或固件模块。系统存储器可被用于例如为系统加载和存储数据和/或指令。对于一个实施例，系统存储器可包括任意适当的易失性存储器，例如，适当的DRAM。在一些实施例中，系统存储器可包括双倍数据速率类型四同步动态随机存取存储器。对于一个实施例，系统控制模块可包括一个或多个输入/输出控制器，以向NVM/存储设备及通信接口提供接口。例如，NVM/存储设备可被用于存储数据和/或指令。NVM/存储设备可包括任意适当的非易失性存储器和/或可包括任意适当的非易失性存储设备、一个或多个光盘驱动器和/或一个或多个数字通用光盘驱动器)。NVM/存储设备可包括在物理上作为系统被安装在其上的设备的一部分的存储资源，或者其可被该设备访问而不必作为该设备的一部分。例如，NVM/存储设备可通过网络经由通信接口进行访问。通信接口可为系统提供接口以通过一个或多个网络和/或与任意其他适当的设备通信。系统可根据一个或多个无线网络标准和/或协议中的任意标准和/或协议来与无线网络的一个或多个组件进行无线通信。对于一个实施例，处理器中的至少一个可与系统控制模块的一个或多个控制器的逻辑封装在一起。对于一个实施例，处理器中的至少一个可与系统控制模块的一个或多个控制器的逻辑封装在一起以形成系统级封装。对于一个实施例，处理器中的至少一个可与系统控制模块的一个或多个控制器的逻辑集成在同一模具上。对于一个实施例，处理器中的至少一个可与系统控制模块的一个或多个控制器的逻辑集成在同一模具上以形成片上系统。在各个实施例中，系统可以但不限于是：服务器、工作站、台式计算设备或移动计算设备。在各个实施例中，系统可具有更多或更少的组件和/或不同的架构。例如，在一些实施例中，系统包括一个或多个摄像机、键盘、液晶显示器屏幕、非易失性存储器端口、多个天线、图形芯片、专用集成电路和扬声器。需要注意的是，本申请可在软件和/或软件与硬件的组合体中被实施，例如，可采用专用集成电路、通用目的计算机或任何其他类似硬件设备来实现。在一个实施例中，本申请的软件程序可以通过处理器执行以实现上文所述步骤或功能。同样地，本申请的软件程序可以被存储到计算机可读记录介质中，例如，RAM存储器，磁或光驱动器或软磁盘及类似设备。另外，本申请的一些步骤或功能可采用硬件来实现，例如，作为与处理器配合从而执行各个步骤或功能的电路。另外，本申请的一部分可被应用为计算机程序产品，例如计算机程序指令，当其被计算机执行时，通过该计算机的操作，可以调用或提供根据本申请的方法和/或技术方案。本领域技术人员应能理解，计算机程序指令在计算机可读介质中的存在形式包括但不限于源文件、可执行文件、安装包文件等，相应地，计算机程序指令被计算机执行的方式包括但不限于：该计算机直接执行该指令，或者该计算机编译该指令后再执行对应的编译后程序，或者该计算机读取并执行该指令，或者该计算机读取并安装该指令后再执行对应的安装后程序。在此，计算机可读介质可以是可供计算机访问的任意可用的计算机可读存储介质或通信介质。通信介质包括藉此包含例如计算机可读指令、数据结构、程序模块或其他数据的通信信号被从一个系统传送到另一系统的介质。通信介质可包括有导的传输介质)和能传播能量波的无线介质，诸如声音、电磁、RF、微波和红外。计算机可读指令、数据结构、程序模块或其他数据可被体现为例如无线介质中的已调制数据信号。术语“已调制数据信号”指的是其一个或多个特征以在信号中编码信息的方式被更改或设定的信号。调制可以是模拟的、数字的或混合调制技术。在此，根据本申请的一个实施例包括一个装置，该装置包括用于存储计算机程序指令的存储器和用于执行程序指令的处理器，其中，当该计算机程序指令被该处理器执行时，触发该装置运行基于前述根据本申请的多个实施例的方法和/或技术方案。实施例四对应上述实施例，本申请还提供了一种计算机可读存储介质，存储有计算机可执行指令，计算机可执行指令用于执行震荡检测方法。在本实施例中，计算机可读存储介质可包括以用于存储诸如计算机可读指令、数据结构、程序模块或其它数据的信息的任何方法或技术实现的易失性和非易失性、可移动和不可移动的介质。例如，计算机可读存储介质包括，但不限于，易失性存储器，诸如随机存储器；以及非易失性存储器，诸如闪存、各种只读存储器、磁性和铁磁/铁电存储器；以及磁性和光学存储设备；或其它现在已知的介质或今后开发的能够存储供计算机系统使用的计算机可读信息/数据。尽管已描述了本申请实施例中的优选实施例，但本领域内的技术人员一旦得知了基本创造性概念，则可对这些实施例作出另外的变更和修改。所以，所附权利要求意欲解释为包括优选实施例以及落入本申请实施例中范围的所有变更和修改。显然，本领域的技术人员可以对本申请进行各种改动和变型而不脱离本申请的精神和范围。这样，倘若本申请的这些修改和变型属于本申请权利要求及其等同技术的范围之内，则本申请也意图包含这些改动和变型在内。
