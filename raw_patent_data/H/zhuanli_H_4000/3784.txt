标题title
基于深度学习的智能反射面联合反馈和混合预编码方法
摘要abst
本发明公开了基于深度学习的智能反射面联合反馈和混合预编码方法，离线训练阶段中，首先根据信道计算模拟、数字预编码矩阵，并输入深度学习模型训练，然后将模型的信道压缩网络和混合预编码网络分别部署在用户端和基站端。在线预测阶段中，用户端将实时信道输入信道压缩网络，并将压缩信息反馈回基站端，基站端将反馈信息输入混合预编码网络，得到模拟、数字预编码矩阵，然后根据数字预编码矩阵对发送信号进行数字预编码，将数字预编码信号通过馈源传输至智能反射面，智能反射面根据模拟预编码矩阵对数字预编码信号进行相移处理，并发送至用户端。本发明利用深度学习技术，实现多用户的信道反馈和基于智能反射面的混合预编码，降低系统的功耗。
权利要求书clms
1.基于深度学习的智能反射面联合反馈和混合预编码方法，由离线训练阶段和在线预测阶段两部分实现；其特征在于，离线训练阶段包括如下步骤：S11：用户端接收到信道状态信息，根据信道计算基站的数字预编码矩阵和智能反射面的模拟预编码矩阵；S12：构建智能反射面的联合反馈和混合预编码的深度学习模型，将信道和基站的数字预编码矩阵、智能反射面的模拟预编码矩阵制作成数据集，对智能反射面的联合反馈和混合预编码的深度学习模型进行训练；S13：将训练完成的智能反射面的联合反馈和混合预编码的深度学习模型拆分为混合预编码网络和K个信道压缩网络，其中混合预编码网络为智能反射面的联合反馈和混合预编码的深度学习模型的4-10层，第k个信道压缩网络为智能反射面的联合反馈和混合预编码的深度学习模型中1-3层的K个网络中的第k个网络，k＝1,...,K，K为用户数，将K个信道压缩网络及其权重依次部署在K个用户端，将混合预编码网络及其权重部署在基站端；在线预测阶段包括如下步骤：S21：K个用户端获取实时的信道状态信息，将实时信道输入信道压缩网络，得到压缩的信道状态信息，并反馈回基站端；S22：基站端将K个用户的反馈信息输入混合预编码网络，根据混合预编码网络的输出得到数字预编码矩阵和模拟预编码矩阵，将模拟预编码矩阵通过馈源传输至智能反射面；S23：基站端根据数字预编码矩阵对发送信号进行数字预编码，得到数字预编码信号；S24：将数字预编码信号通过馈源传输至智能反射面的子表面上，子表面上的无源反射元件根据模拟预编码矩阵对数字预编码信号进行相移处理，并将相移后的信号发送至用户端。2.根据权利要求1所述的基于深度学习的智能反射面联合反馈和混合预编码方法，其特征在于，所述步骤S11中，根据信道计算基站的数字预编码矩阵和智能反射面的模拟预编码矩阵的步骤如下：T1、初始化概率向量其中i＝1,...,Nite，Nite为迭代次数，中的向量元素pn表示从{+1,-1}中选择+1的概率，1N为维度为N×1的全1向量，N为智能反射面的无源元件数；T2、使用概率向量与集合{+1,-1}产生C个维度为N×1的模拟预编码向量将作为智能反射面的模拟预编码矩阵的对角线元素，的其他元素为0，根据计算C个数字预编码矩阵其中ρ为发射功率，为智能反射面和K个用户之间的信道，为射频到智能反射面的链路矩阵；T3、根据计算第i次迭代的频谱效率R，其中为第k个用户的信干噪比，其中为数字预编码矩阵的第k个列向量，hk为智能反射面到用户k的信道，σ2为噪声功率；将计算得到的C个频谱效率从高到低排序，选择出前Nelite个频谱效率，将前Nelite个频谱效率对应的模拟预编码向量组合为Nelite×N的矩阵T4、计算的第n个列向量中+1的个数Sn，其中n＝1,...,N，将作为第i+1次迭代的概率向量中第n个元素的值；T5、将作为第i+1次迭代的概率向量，重复T2-T5步骤，共重复迭代Nite次；T6、在第Nite+1次迭代中，使用第Nite次迭代的产生的概率向量重复步骤T2，根据H,G计算频谱效率，其中和分别为第Nite+1次迭代产生的数字预编码矩阵和模拟预编码；将计算得到的C个频谱效率从高到低排序，选择出最高的频谱效率，将其对应的模拟预编码向量转换为模拟预编码矩阵，作为最优模拟预编码矩阵Fa，对应的数字预编码矩阵作为最优的数字预编码矩阵Fb。3.根据权利要求1所述的基于深度学习的智能反射面联合反馈和混合预编码方法，其特征在于，所述步骤S12中，智能反射面的联合反馈和混合预编码的深度学习模型由K个相同的信道压缩网络和混合预编码网络构成，其中K为用户数；第k个信道压缩网络中包含三层全连接层，k＝1,...,K，第一、二层的维度分别为1024、512，激活函数为Relu，激活函数后为dropout层，第三层维度为Q，其中Q为信道压缩的维度，无激活函数和dropout层；混合预编码网络中第一层为全连接层，维度为2048，第二层为Reshape层，将向量重构为32*32*2的三维矩阵，第三、四层为卷积层，卷积核个数为16，卷积核大小为2*2，卷积层后接批量归一化，激活函数为Relu，第五、六层为全连接层，维度为1024，激活函数为Relu，第七层为全连接层，维度为T，其中T＝N+2MK，N为智能反射面无源反射元件个数，M为射频链路数。4.根据权利要求1所述的基于深度学习的智能反射面联合反馈和混合预编码方法，其特征在于，所述步骤S12中，在智能反射面的联合反馈和混合预编码的深度学习模型的数据集中，第k个信道压缩网络的输入为智能反射面到用户k的信道hk，输出为其中k＝1,...,K，Fa,Fb分别为模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度。5.根据权利要求1所述的基于深度学习的智能反射面联合反馈和混合预编码方法，其特征在于，所述步骤S12中，训练联合反馈和混合预编码的深度学习模型时，损失函数设置为均方误差其中为数据集的标签，为输出数据，其中Fa,Fb分别为标签的模拟、数字预编码矩阵，分别为训练过程中模型输出的估计的模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度，学习率为0.0003，衰减因子为0.95，epoch设置为400。6.根据权利要求1所述的基于深度学习的智能反射面联合反馈和混合预编码方法，其特征在于，所述步骤S22中，网络的输出为其中分别为在线预测阶段模型输出的模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度，将变换为复数形式，将其与N×N的单位矩阵相乘得到模拟预编码矩阵将变换为M×K的矩阵形式，将实部与虚部结合，得到数字预编码矩阵其中N为智能反射面无源反射元件个数，M为射频链路数，K为用户数。7.根据权利要求1所述的基于深度学习的智能反射面联合反馈和混合预编码方法，其特征在于，所述步骤S24中，第m个射频上的数字预编码信号通过馈线将信号传输至第m个子表面上，第m个子表面上的第q个反射元件根据模拟预编码Fa中的第m个对角矩阵的第q个对角元素来设置相移，其中m＝1,...,M，q＝1,...,Q，M为射频链路数和子表面数，为子表面上的无源反射元件数，N为智能反射面上的总无源反射元件数，为智能反射面的模拟预编码矩阵，diag{}表示将向量转化成对角矩阵，θq,m为第m个子表面的第q个无源反射元件的相移；传输到智能反射面上的信号经过无源反射元件进行相移处理，将相移处理后的信号传输至K个用户。
说明书desc
技术领域本发明涉及无线通信技术领域，具体为基于深度学习的智能反射面联合反馈和混合预编码方法。背景技术随着无线技术的快速发展，通信数据量和业务量呈现出激增的态势。传统的MIMO系统通常采用全数字预编码，然而随着天线数的增长，全数字系统的RF链数将会大幅度增加，这不但会增加系统的整体功耗，也会提高硬件的复杂度和成本。目前的混合预编码架构利用较少的RF链实现了和全数字架构相近的性能，可以在频谱效率和系统功耗之间达到平衡。然而，在更高频段，如太赫兹场景中，天线数量会进一步增加，混合预编码架构中实现模拟预编码的移相器数量会变得很大，这大大增加了系统整体的复杂度和功耗。最近在探索下一代通信技术中，智能反射面以其低成本、低功耗、易部署等优点而备受学界和工业界关注。智能反射面是由大量低成本无源反射元件组成的平面，每个元件能够独立地改变入射信号的振幅或相位从而使其向一个或多个期望方向发送，可以在更低功耗下实现模拟预编码的功能。但是，由于具有大量无源反射元件，智能反射面与基站端的协同优化的复杂度变得非常高。在频分双工的模式下，用户获取到下行信道状态信息后，需要将下行CSI通过反馈链路反馈给基站，基站根据反馈的CSI进行预编码设计来提高系统整体性能。在THz场景下，天线数量非常大，信道维度增加，反馈开销会变得巨大，这会大大增加系统的负担，同时影响基站的混合预编码的性能。为了实现多用户的信道信息反馈和基站端的基于智能反射面的混合预编码，减小反馈开销，降低混合预编码的功耗和计算复杂度，本发明提出了基于深度学习的智能反射面联合反馈和混合预编码方法。发明内容本发明的目的在于提供基于深度学习的智能反射面联合反馈和混合预编码方法，以解决上述背景技术中提出的问题。为实现上述目的，本发明提供如下技术方案：基于深度学习的智能反射面联合反馈和混合预编码方法，由离线训练阶段和在线预测阶段两部分实现；其特征在于，离线训练阶段包括如下步骤：S11：用户端接收到信道状态信息，根据信道计算基站的数字预编码矩阵和智能反射面的模拟预编码矩阵；S12：构建智能反射面的联合反馈和混合预编码的深度学习模型，将信道和基站的数字预编码矩阵、智能反射面的模拟预编码矩阵制作成数据集，对智能反射面的联合反馈和混合预编码的深度学习模型进行训练；S13：将训练完成的智能反射面的联合反馈和混合预编码的深度学习模型拆分为混合预编码网络和K个信道压缩网络，其中混合预编码网络为智能反射面的联合反馈和混合预编码的深度学习模型的4-10层，第k个信道压缩网络为智能反射面的联合反馈和混合预编码的深度学习模型中1-3层的K个网络中的第k个网络，k＝1,...,K，K为用户数，将K个信道压缩网络及其权重依次部署在K个用户端，将混合预编码网络及其权重部署在基站端；在线预测阶段包括如下步骤：S21：K个用户端获取实时的信道状态信息，将实时信道输入信道压缩网络，得到压缩的信道状态信息，并反馈回基站端；S22：基站端将K个用户的反馈信息输入混合预编码网络，根据混合预编码网络的输出得到数字预编码矩阵和模拟预编码矩阵，将模拟预编码矩阵通过馈源传输至智能反射面；S23：基站端根据数字预编码矩阵对发送信号进行数字预编码，得到数字预编码信号；S24：将数字预编码信号通过馈源传输至智能反射面的子表面上，子表面上的无源反射元件根据模拟预编码矩阵对数字预编码信号进行相移处理，并将相移后的信号发送至用户端。优选的，所述步骤S11中，根据信道计算基站的数字预编码矩阵和智能反射面的模拟预编码矩阵的步骤如下：T1、初始化概率向量其中i＝1,...,Nite，Nite为迭代次数，中的向量元素pn表示从{+1,-1}中选择+1的概率，1N为维度为N×1的全1向量，N为智能反射面的无源元件数；T2、使用概率向量与集合{+1,-1}产生C个维度为N×1的模拟预编码向量将作为智能反射面的模拟预编码矩阵的对角线元素，的其他元素为0，根据计算C个数字预编码矩阵其中ρ为发射功率，为智能反射面和K个用户之间的信道。为射频到智能反射面的链路矩阵；T3、根据计算第i次迭代的频谱效率R，其中为第k个用户的信干噪比，其中为数字预编码矩阵的第k个列向量，hk为智能反射面到用户k的信道，σ2为噪声功率；将计算得到的C个频谱效率从高到低排序，选择出前Nelite个频谱效率，将前Nelite个频谱效率对应的模拟预编码向量组合为Nelite×N的矩阵T4、计算的第n个列向量中+1的个数Sn，其中n＝1,...,N，将作为第i+1次迭代的概率向量中第n个元素的值；T5、将作为第i+1次迭代的概率向量，重复T2-T5步骤，共重复迭代Nite次；T6、在第Nite+1次迭代中，使用第Nite次迭代的产生的概率向量重复步骤T2，根据G计算频谱效率，其中和分别为第Nite+1次迭代产生的数字预编码矩阵和模拟预编码；将计算得到的C个频谱效率从高到低排序，选择出最高的频谱效率，将其对应的模拟预编码向量转换为模拟预编码矩阵，作为最优模拟预编码矩阵Fa，对应的数字预编码矩阵作为最优的数字预编码矩阵Fb。优选的，所述步骤S12中，智能反射面的联合反馈和混合预编码的深度学习模型由K个相同的信道压缩网络和混合预编码网络构成，其中K为用户数；第k个信道压缩网络中包含三层全连接层，k＝1,...,K，第一、二层的维度分别为1024、512，激活函数为Relu，激活函数后为dropout层，第三层维度为Q，其中Q为信道压缩的维度，无激活函数和dropout层；混合预编码网络中第一层为全连接层，维度为2048，第二层为Reshape层，将向量重构为32*32*2的三维矩阵，第三、四层为卷积层，卷积核个数为16，卷积核大小为2*2，卷积层后接批量归一化，激活函数为Relu，第五、六层为全连接层，维度为1024，激活函数为Relu，第七层为全连接层，维度为T，其中T＝N+2MK，N为智能反射面无源反射元件个数，M为射频链路数。优选的，所述步骤S12中，在智能反射面的联合反馈和混合预编码的深度学习模型的数据集中，第k个信道压缩网络的输入为智能反射面到用户k的信道hk，输出为其中k＝1,...,K，Fa,Fb分别为模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度。优选的，所述步骤S12中，训练联合反馈和混合预编码的深度学习模型时，损失函数设置为均方误差其中为数据集的标签，为输出数据，其中Fa,Fb分别为标签的模拟、数字预编码矩阵，分别为训练过程中模型输出的估计的模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度，学习率为0.0003，衰减因子为0.95，epoch设置为400。优选的，所述步骤S22中，网络的输出为其中分别为在线预测阶段模型输出的模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度，将变换为复数形式，将其与N×N的单位矩阵相乘得到模拟预编码矩阵将变换为M×K的矩阵形式，将实部与虚部结合，得到数字预编码矩阵其中N为智能反射面无源反射元件个数，M为射频链路数，K为用户数。优选的，所述步骤S24中，第m个射频上的数字预编码信号通过馈线将信号传输至第m个子表面上，第m个子表面上的第q个反射元件根据模拟预编码Fa中的第m个对角矩阵的第q个对角元素来设置相移，其中m＝1,...,M，q＝1,...,Q，M为射频链路数和子表面数，为子表面上的无源反射元件数，N为智能反射面上的总无源反射元件数，为智能反射面的模拟预编码矩阵，diag{}表示将向量转化成对角矩阵，θq,m为第m个子表面的第q个无源反射元件的相移；传输到智能反射面上的信号经过无源反射元件进行相移处理，将相移处理后的信号传输至K个用户。与现有技术相比，本发明的有益效果是：本发明利用智能反射面，实现了基站的数字预编码和智能反射面的模拟预编码，在保证系统整体性能的同时，大幅降低了系统复杂度功耗。本发明利用深度学习技术，根据多用户反馈的信道状态信息来进行混合预编码设计，相较于传统算法，在性能接近的情况下，大幅降低了计算复杂度。本发明利用深度学习技术，对多用户估计的信道状态信息进行压缩并反馈给基站，相比于直接反馈高维的信道状态信息，大幅降低了反馈开销。本发明通过离线训练和在线预测，节省大量的计算开销，适用于室内和室外各种场景，并具有很好的鲁棒性。附图说明图1为本发明基于智能反射面的混合预编码系统示意图；图2为本发明智能反射面的联合反馈和混合预编码的深度学习模型示意图；图3为本发明提出的信道压缩神经网络的结构图；图4为本发明提出的混合预编码神经网络的结构图；图5为本发明提出的基于深度学习的智能反射面联合反馈和混合预编码方法的流程图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。如图1所示，在毫米波大规模MIMO系统中，基站端有M个射频链路，K个数据流，用户为单天线，个数为K，智能反射面由N个无源反射元件组成，且分为M个子表面，每个子表面里包含Q＝N/M个元件，考虑用户数、射频链路数相等的情况，即K＝M。射频链路与子表面通过馈源连接，每个射频链路只与其对应的一个子表面相连接，发送信号经数字预编码矩阵Fb处理传输至射频链路，射频链路将发送信号经过馈线发送至对应的子表面上的每个无源反射原件，子表面上的无源反射元件根据模拟预编码矩阵Fa对信号相位进行调节，然后传输至K个用户端。K个用户的接收信号y为：y＝HFaGFbs+n其中为基站的数字预编码矩阵，为智能反射面和K个用户之间的信道。为射频到智能反射面的链路矩阵，1Q为Q×1的全1向量，为智能反射面的模拟预编码矩阵，为第m个子表面的第q个无源反射元件的相移，H采用Saleh-Valenzuela模型来进行信道建模，Lk,m为第k个用户和第m个子表面之间的多径数，为第l条径的复增益，为方向向量，其中θ分别为方位角和俯仰角。在该系统模型中，频谱效率可以表示为：其中SINRk为第k个用户的信干噪比，表示为：其中fk为数字预编码矩阵Fb的第k列向量，σ2为噪声功率。在信道的每个相干时间内，第k个用户端估计出智能反射面到用户k的下行信道hk，其中k＝1,...,K，将hk输入用户k的信道压缩器来将信道hk压缩为低维度的码字sk，即K个用户将压缩的码字s＝发送至基站端，基站端将码字s输入混合预编码器得到基站的数字预编码矩阵Fb和智能反射面的模拟预编码矩阵Fa，即基站端根据数字预编码矩阵Fb对发送信号进行数字预编码，得到数字预编码信号，将数字预编码信号通过馈源传输至智能反射面的子表面上，子表面上的无源反射元件根据模拟预编码矩阵Fa对数字预编码信号进行相移处理，并将相移后的信号发送至用户端。基于以上系统，本发明提供的一种基于深度学习的智能反射面联合反馈和混合预编码方法，具体步骤如图5所示，下面对步骤进行详细说明。由离线训练阶段和在线预测阶段两部分实现；离线训练阶段包括如下步骤：S11：用户端接收到信道状态信息，根据信道计算基站的数字预编码矩阵和智能反射面的模拟预编码矩阵；S12：构建智能反射面的联合反馈和混合预编码的深度学习模型，将信道和基站的数字预编码矩阵、智能反射面的模拟预编码矩阵制作成数据集，对智能反射面的联合反馈和混合预编码的深度学习模型进行训练；S13：将训练完成的智能反射面的联合反馈和混合预编码的深度学习模型拆分为混合预编码网络和K个信道压缩网络，其中混合预编码网络为智能反射面的联合反馈和混合预编码的深度学习模型的4-10层，第k个信道压缩网络为智能反射面的联合反馈和混合预编码的深度学习模型中1-3层的K个网络中的第k个网络，k＝1,...,K，K为用户数，将K个信道压缩网络及其权重依次部署在K个用户端，将混合预编码网络及其权重部署在基站端；在线预测阶段包括如下步骤：S21：K个用户端获取实时的信道状态信息，将实时信道输入信道压缩网络，得到压缩的信道状态信息，并反馈回基站端；S22：基站端将K个用户的反馈信息输入混合预编码网络，根据混合预编码网络的输出得到数字预编码矩阵和模拟预编码矩阵，将模拟预编码矩阵通过馈源传输至智能反射面；S23：基站端根据数字预编码矩阵对发送信号进行数字预编码，得到数字预编码信号；S24：将数字预编码信号通过馈源传输至智能反射面的子表面上，子表面上的无源反射元件根据模拟预编码矩阵对数字预编码信号进行相移处理，并将相移后的信号发送至用户端。根据信道计算基站的数字预编码矩阵和智能反射面的模拟预编码矩阵的步骤如下：T1、初始化概率向量其中i＝1,...,Nite，Nite为迭代次数，中的向量元素pn表示从{+1,-1}中选择+1的概率，1N为维度为N×1的全1向量，N为智能反射面的无源元件数；T2、使用概率向量与集合{+1,-1}产生C个维度为N×1的模拟预编码向量将作为智能反射面的模拟预编码矩阵的对角线元素，的其他元素为0，根据计算C个数字预编码矩阵其中ρ为发射功率，为智能反射面和K个用户之间的信道。为射频到智能反射面的链路矩阵；T3、根据计算第i次迭代的频谱效率R，其中为第k个用户的信干噪比，其中为数字预编码矩阵的第k个列向量，hk为智能反射面到用户k的信道，σ2为噪声功率；将计算得到的C个频谱效率从高到低排序，选择出前Nelite个频谱效率，将前Nelite个频谱效率对应的模拟预编码向量组合为Nelite×N的矩阵T4、计算的第n个列向量中+1的个数Sn，其中n＝1,...,N，将作为第i+1次迭代的概率向量中第n个元素的值；T5、将作为第i+1次迭代的概率向量，重复T2-T5步骤，共重复迭代Nite次；T6、在第Nite+1次迭代中，使用第Nite次迭代的产生的概率向量重复步骤T2，根据H,G计算频谱效率，其中和分别为第Nite+1次迭代产生的数字预编码矩阵和模拟预编码；将计算得到的C个频谱效率从高到低排序，选择出最高的频谱效率，将其对应的模拟预编码向量转换为模拟预编码矩阵，作为最优模拟预编码矩阵Fa，对应的数字预编码矩阵作为最优的数字预编码矩阵Fb。智能反射面的联合反馈和混合预编码的深度学习模型的结构：如图2所示，智能反射面的联合反馈和混合预编码的深度学习模型由K个相同的信道压缩网络和混合预编码网络构成，其中K为用户数；如图3所示，第k个信道压缩网络中包含三层全连接层，k＝1,...,K，第一、二层的维度分别为1024、512，激活函数为Relu，激活函数后为dropout层，第三层维度为Q，其中Q为信道压缩的维度，无激活函数和dropout层；如图4所示，混合预编码网络中第一层为全连接层，维度为2048，第二层为Reshape层，将向量重构为32*32*2的三维矩阵，第三、四层为卷积层，卷积核个数为16，卷积核大小为2*2，卷积层后接批量归一化，激活函数为Relu，第五、六层为全连接层，维度为1024，激活函数为Relu，第七层为全连接层，维度为T，其中T＝N+2MK，N为智能反射面无源反射元件个数，M为射频链路数。智能反射面的联合反馈和混合预编码的深度学习模型的数据集制作：在智能反射面的联合反馈和混合预编码的深度学习模型的数据集中，第k个信道压缩网络的输入为智能反射面到用户k的信道hk，输出为其中k＝1,...,K，Fa,Fb分别为模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度。智能反射面的联合反馈和混合预编码的深度学习模型的训练：训练智能反射面的联合反馈和混合预编码的深度学习模型时，损失函数设置为均方误差其中为数据集的标签，为输出数据，其中Fa,Fb分别为标签的模拟、数字预编码矩阵，分别为训练过程中模型输出的估计的模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度，学习率为0.0003，衰减因子为0.95，epoch设置为400。在线预测阶段计算获得模拟、数字预编码矩阵的过程：网络的输出为其中分别为在线预测阶段模型输出的模拟、数字预编码矩阵，vecT表示将矩阵向量化并转置，diag表示取矩阵的对角线元素，分别表示取复数的实部、虚部，∠表示将复数变换为角度，将变换为复数形式，将其与N×N的单位矩阵相乘得到模拟预编码矩阵将变换为M×K的矩阵形式，将实部与虚部结合，得到数字预编码矩阵其中N为智能反射面无源反射元件个数，M为射频链路数，K为用户数。智能反射面对信号进行模拟预编码的过程：第m个射频上的数字预编码信号通过馈线将信号传输至第m个子表面上，第m个子表面上的第q个反射元件根据模拟预编码Fa中的第m个对角矩阵的第q个对角元素来设置相移，其中m＝1,...,M，q＝1,...,Q，M为射频链路数和子表面数，为子表面上的无源反射元件数，N为智能反射面上的总无源反射元件数，为智能反射面的模拟预编码矩阵，diag{}表示将向量转化成对角矩阵，θq,m为第m个子表面的第q个无源反射元件的相移；传输到智能反射面上的信号经过无源反射元件进行相移处理，将相移处理后的信号传输至K个用户。对于本领域技术人员而言，显然本发明不限于上述示范性实施例的细节，而且在不背离本发明的精神或基本特征的情况下，能够以其他的具体形式实现本发明。因此，无论从哪一点来看，均应将实施例看作是示范性的，而且是非限制性的，本发明的范围由所附权利要求而不是上述说明限定，因此旨在将落在权利要求的等同要件的含义和范围内的所有变化囊括在本发明内。不应将权利要求中的任何附图标记视为限制所涉及的权利要求。
