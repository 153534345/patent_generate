标题title
一种基于拟态防御的密码服务监控系统及方法
摘要abst
本发明提供一种基于拟态防御的密码服务监控系统及方法，属于电力物联网信息安全技术领域，包括：密码服务平台至少具有二个冗余备份系统，密码服务平台的一级密码服务监控系统生成密钥服务请求通过预设的网络协议发送至二级密码服务监控系统；一级密码服务监控系统包括密钥管理模块、证书管理模块、数字验签模块、身份认证模块和动态防御切换模块；二级密码服务监控系统包括密码服务模块、侦测模块、拟态异构防御模块；动态防御切换模块分析拟态异构防御模块的裁决结果并结合防御策略，用于当密钥服务请求存在威胁攻击时直接动态转移攻击面并将系统切换至冗余备份的密码服务平台。大大增加了攻击成本、消耗攻击时间，实现了系统的动态防御。
权利要求书clms
1.一种基于拟态防御的密码服务监控系统，其特征在于，所述系统包括：密码服务平台，所述密码服务平台至少具有二个冗余备份系统，所述密码服务平台包括一级密码服务监控系统，所述一级密码服务监控系统通信连接至少一个二级密码服务监控系统，所述一级密码服务监控系统生成密钥服务请求通过预设的网络协议发送至所述二级密码服务监控系统；所述一级密码服务监控系统包括密钥管理模块、证书管理模块、数字验签模块、身份认证模块和动态防御切换模块；所述身份认证模块用于对登入所述密码服务平台的用户标识授权对应的操作等级；所述密钥管理模块获取密码机产生的密钥对并对所述密钥对进行存储、加密和分发；所述证书管理模块基于所述密钥对的公钥结合不同操作等级的用户标识生成对应的签名证书；数字验签模块基于所述密钥对的私钥对所述密钥服务请求进行数字签名，以生成加密的所述密钥服务请求；所述一级密码服务监控系统将具有用户标识签名的加密的密钥服务请求下发至所述二级密码服务监控系统；所述二级密码服务监控系统包括密码服务模块、侦测模块、拟态异构防御模块；所述侦测模块用于自动侦测并获取带有用户标识签名的加密的密钥服务请求；所述密码服务模块获取签名证书中所述密钥对的公钥对所述密钥服务请求进行解密；所述拟态异构防御模块包括分发单元、调度单元、执行体单元、裁决单元、执行体池和执行体池中多个执行体；所述执行体单元从所述执行体池中获取具有相同功能的执行体；所述分发单元将解密后的所述密钥服务请求动态随机分发至所述执行体单元的多个所述执行体进行归一化处理并将处理结果返回至所述裁决单元；所述裁决单元对归一化处理结果进行比较和裁决，输出裁决结果；所述调度单元基于动态调度算法和裁决结果从所述执行体池调度若干执行体至所述执行体单元，替换所述执行体单元中具有异常输出的执行体；所述动态防御切换模块分析所述拟态异构防御模块的裁决结果并结合防御策略，用于当所述密钥服务请求存在威胁攻击时直接动态转移攻击面并将系统切换至冗余备份的所述密码服务平台。2.根据权利要求1所述的基于拟态防御的密码服务监控系统，其特征在于，所述二级密码服务监控系统根据所述密钥服务请求生成密钥获取请求并发送至所述一级密码服务监控系统，所述密钥管理模块包括密钥分发单元，所述密钥分发单元根据所述密钥获取请求，确定密钥下发方式，将存储的所述密钥对下发至所述密码服务模块，所述密码服务模块对所述密钥对进行解析，并下发至使用该密钥对的终端物联设备。3.根据权利要求1所述的基于拟态防御的密码服务监控系统，其特征在于，所述二级密码服务监控系统还包括异常报警模块，所述异常报警模块根据具有相同功能的执行体产生的执行日志对所述密钥服务请求存在的威胁程度进行信息分类并输出告警信息。4.根据权利要求1所述的基于拟态防御的密码服务监控系统，其特征在于，所述一级密码服务监控系统还包括安全分析模块，所述安全分析模块设置于所述一级密码服务监控系统的前端，所述安全分析模块预设特征信息规则库，对所述密码服务平台通信网络的运行状态进行监控，采集网络报文提取特征信息，基于所述特征信息规则库对通信网络的运行状态进行安全评估并对异常网络报文进行响应。5.根据权利要求1所述的基于拟态防御的密码服务监控系统，其特征在于，所述一级密码服务监控系统还包括监听模块和拦截模块，所述监听模块和所述拦截模块设置于所述一级密码服务监控系统的后端，所述监听模块捕获所述网络报文并解析该网络报文的数据包，所述拦截模块预设异常拦截规则库，所述拦截模块基于所述异常拦截规则库的异常判断规则，对解析后的数据包进行检测，以对异常网络报文进行捕获拦截。6.根据权利要求1所述的基于拟态防御的密码服务监控系统，其特征在于，所述防御策略由区间端点分别为表示最高优先级的需要防御策略类型和表示最低优先级的不需要防御策略类型组成的防御策略集合区间，根据防御策略权重因子从所述防御策略集合区间选取对应可用的防御策略。7.根据权利要求6所述的基于拟态防御的密码服务监控系统，其特征在于，所述二级密码服务监控系统还包括防御策略更新模块，所述防御策略更新模块实时监控并分析多个所述执行体生成的执行日志，用于更新所述防御策略权重因子，基于更新的所述防御策略权重因子从所述防御策略集合区间选取最优防御策略。8.根据权利要求6所述的基于拟态防御的密码服务监控系统，其特征在于，根据防御策略权重因子从所述防御策略集合区间选取防御策略的计算模型为：其中，D表示防御策略集合，为采用第i个防御策略的概率，n为攻击策略的总数，为根据多个所述执行体生成的执行日志计算生成对应的防御策略权重因子，α为当前防御策略与前一个防御策略的关联因子，为基于关联因子α与防御策略权重因子定义的防御策略，为防御策略的效用，为从从防御策略集合中选取对应可用的防御策略的效用。9.根据权利要求1所述的基于拟态防御的密码服务监控系统，其特征在于，所述密码服务平台采用分布式微服务架构。10.一种基于拟态防御的密码服务监控方法，应用权利要求1-9任意一项所述的基于拟态防御的密码服务监控系统，其特征在于，包括如下步骤：步骤S1：密码服务平台初始化配置，使其至少具有二个冗余备份系统，其中，所述密码服务平台配置有一级密码服务监控系统和至少一个二级密码服务监控系统；步骤S2：所述一级密码服务监控系统与所述二级密码服务监控系统建立通信连接；步骤S3：获取密码机产生的密钥对，将所述密钥对结合登入所述密码服务平台的用户标识对应授权的操作等级生成对应的签名证书；步骤S4：生成密钥服务请求，基于所述密钥对的私钥对所述密码服务请求进行数字签名，以生成加密的所述密码服务请求，并下发至所述二级密码服务监控系统；步骤S5：自动侦测并获取带有用户标识签名的加密的密码服务请求，基于签名证书中所述密钥对的公钥对所述密码服务请求进行解密；步骤S6：将解密后的所述密码服务请求动态随机分发至执行体单元中多个执行体进行归一化处理，对归一化处理结果进行比较和裁决，输出裁决结果；步骤S7：基于动态调度算法和裁决结果找出执行体单元中异常输出的执行体，从执行体池调度若干执行体替换具有异常输出的执行体；步骤S8：分析裁决结果并结合防御策略，当所述密码服务请求存在威胁攻击时直接动态转移攻击面并将系统切换至冗余备份的所述密码服务平台。
说明书desc
技术领域本发明属于电力物联网信息安全技术领域，更具体地，涉及一种基于拟态防御的密码服务监控系统及方法。背景技术随着智能电网的高速发展，感知、计算、通信、控制等先进信息技术的深入应用，电力系统逐渐实现信息化、网络化与智能化。在促进电力资源实时分析、科学决策、高效配置的同时，开放的通信网络与设备终端接口也带来了潜在的安全隐患。国家电网公司开发建设统一密码服务平台，用于将密码基础设施资源集中统一建设、管理和维护，规范密码在各业务系统中的规范应用。该密码服务平台为各业务系统提供了密码机、微服务、数据库等软硬件设施，用于支撑数字证书颁发、用户身份鉴别、实名认证、业务数据加解密等密码服务。但由于电力系统和通信与信息系统自身内在原因，通信与信息系统依然存在安全隐患，仍存在网络攻击无法防御、或者可防御但代价太高的可能性。为了保障密码服务平台中各类软硬件设备和服务的正常运行，需要构建有针对性的弹性防御体系，采取主动防御的方式执行合适的防御策略，降低系统面临的风险。发明内容本发明针对现有技术中存在的问题，旨在提供一种基于拟态防御的密码服务监控系统及方法，对密码服务平台系统进行冗余备份，实时监控网络之间传输的密钥服务请求，分析密钥服务请求是否带有威胁的数据，面对威胁攻击时，能直接动态转移攻击面并将密码服务平台系统切换至冗余备份系统，使得攻击时很难找到固定的漏洞，大大增加了攻击成本、消耗攻击时间。为了实现上述目的，本发明的技术方案如下：一种基于拟态防御的密码服务监控系统，所述系统包括：密码服务平台，所述密码服务平台至少具有二个冗余备份系统，所述密码服务平台包括一级密码服务监控系统，所述一级密码服务监控系统通信连接至少一个二级密码服务监控系统，所述一级密码服务监控系统生成密钥服务请求通过预设的网络协议发送至所述二级密码服务监控系统；所述一级密码服务监控系统包括密钥管理模块、证书管理模块、数字验签模块、身份认证模块和动态防御切换模块；所述身份认证模块用于对登入所述密码服务平台的用户标识授权对应的操作等级；所述密钥管理模块获取密码机产生的密钥对并对所述密钥对进行存储、加密和分发；所述证书管理模块基于所述密钥对的公钥结合不同操作等级的用户标识生成对应的签名证书；数字验签模块基于所述密钥对的私钥对所述密钥服务请求进行数字签名，以生成加密的所述密钥服务请求；所述一级密码服务监控系统将具有用户标识签名的加密的密钥服务请求下发至所述二级密码服务监控系统；所述二级密码服务监控系统包括密码服务模块、侦测模块、拟态异构防御模块；所述侦测模块用于自动侦测并获取带有用户标识签名的加密的密钥服务请求；所述密码服务模块获取签名证书中所述密钥对的公钥对所述密钥服务请求进行解密；所述拟态异构防御模块包括分发单元、调度单元、执行体单元、裁决单元、执行体池和执行体池中多个执行体；所述执行体单元从所述执行体池中获取具有相同功能的执行体；所述分发单元将解密后的所述密钥服务请求动态随机分发至所述执行体单元的多个所述执行体进行归一化处理并将处理结果返回至所述裁决单元；所述裁决单元对归一化处理结果进行比较和裁决，输出裁决结果；所述调度单元基于动态调度算法和裁决结果从所述执行体池调度若干执行体至所述执行体单元，替换所述执行体单元中具有异常输出的执行体；所述动态防御切换模块分析所述拟态异构防御模块的裁决结果并结合防御策略，用于当所述密钥服务请求存在威胁攻击时直接动态转移攻击面并将系统切换至冗余备份的所述密码服务平台。优选的，所述二级密码服务监控系统根据所述密钥服务请求生成密钥获取请求并发送至所述一级密码服务监控系统，所述密钥管理模块包括密钥分发单元，所述密钥分发单元根据所述密钥获取请求，确定密钥下发方式，将存储的所述密钥对下发至所述密码服务模块，所述密码服务模块对所述密钥对进行解析，并下发至使用该密钥对的终端物联设备。优选的，所述二级密码服务监控系统还包括异常报警模块，所述异常报警模块根据具有相同功能的执行体产生的执行日志对所述密钥服务请求存在的威胁程度进行信息分类并输出告警信息。优选的，所述一级密码服务监控系统还包括安全分析模块，所述安全分析模块设置于所述一级密码服务监控系统的前端，所述安全分析模块预设特征信息规则库，对所述密码服务平台通信网络的运行状态进行监控，采集网络报文提取特征信息，基于所述特征信息规则库对通信网络的运行状态进行安全评估并对异常网络报文进行响应。优选的，所述一级密码服务监控系统还包括监听模块和拦截模块，所述监听模块和所述拦截模块设置于所述一级密码服务监控系统的后端，所述监听模块捕获所述网络报文并解析该网络报文的数据包，所述拦截模块预设异常拦截规则库，所述拦截模块基于所述异常拦截规则库的异常判断规则，对解析后的数据包进行检测，以对异常网络报文进行捕获拦截。优选的，所述防御策略由区间端点分别为表示最高优先级的需要防御策略类型和表示最低优先级的不需要防御策略类型组成的防御策略集合区间，根据防御策略权重因子从所述防御策略集合区间选取对应可用的防御策略。优选的，所述二级密码服务监控系统还包括防御策略更新模块，所述防御策略更新模块实时监控并分析多个所述执行体生成的执行日志，用于更新所述防御策略权重因子，基于更新的所述防御策略权重因子从所述防御策略集合区间选取最优防御策略。优选的，根据防御策略权重因子从所述防御策略集合区间选取防御策略的计算模型为：其中，D表示防御策略集合，为采用第i个防御策略的概率，n为攻击策略的总数，为根据多个所述执行体生成的执行日志计算生成对应的防御策略权重因子，α为当前防御策略与前一个防御策略的关联因子，为基于关联因子α与防御策略权重因子定义的防御策略，为防御策略的效用，为从从防御策略集合中选取对应可用的防御策略的效用。优选的，所述密码服务平台采用分布式微服务架构。本发明还提供一种基于拟态防御的密码服务监控方法，应用上述所述的基于拟态防御的密码服务监控系统，包括如下步骤：步骤S1：密码服务平台初始化配置，使其至少具有二个冗余备份系统，其中，所述密码服务平台配置有一级密码服务监控系统和至少一个二级密码服务监控系统；步骤S2：所述一级密码服务监控系统与所述二级密码服务监控系统建立通信连接；步骤S3：获取密码机产生的密钥对，将所述密钥对结合登入所述密码服务平台的用户标识对应授权的操作等级生成对应的签名证书；步骤S4：生成密钥服务请求，基于所述密钥对的私钥对所述密码服务请求进行数字签名，以生成加密的所述密码服务请求，并下发至所述二级密码服务监控系统；步骤S5：自动侦测并获取带有用户标识签名的加密的密码服务请求，基于签名证书中所述密钥对的公钥对所述密码服务请求进行解密；步骤S6：将解密后的所述密码服务请求动态随机分发至执行体单元中多个执行体进行归一化处理，对归一化处理结果进行比较和裁决，输出裁决结果；步骤S7：基于动态调度算法和裁决结果找出执行体单元中异常输出的执行体，从执行体池调度若干执行体替换具有异常输出的执行体；步骤S8：分析裁决结果并结合防御策略，当所述密码服务请求存在威胁攻击时直接动态转移攻击面并将系统切换至冗余备份的所述密码服务平台。本发明的技术方案的有益效果在于：本发明基于拟态防御技术，对密码服务平台采用冗余备份的保护架构，对网络之间传输的密钥服务请求实时自动侦测，分析密钥服务请求是否带有威胁的数据，动态调度执行体使密钥服务请求存在的威胁处在动态变化当中，同时加上多模裁决的限制使得解密的数据被篡改的难度加大，设置拟态异构防御模块能直接动态转移攻击面并将密码服务平台系统切换至冗余备份系统，攻击时很难找到固定的漏洞，避免整个系统暴露在安全威胁当中，大大增加了攻击成本、消耗攻击时间，使平台能够带菌生存，实现了系统的动态防御。进一步地，一级密码服务监控系统获取本地密钥机产生的密钥对，基于授权登入密码服务平台的不同用户标识赋予不同的操作等级并生成对应的签名证书，该签名证书用于将密钥服务请求进行签名加密保护，防止该密钥数据在前期被恶意窃取和篡改攻击，按照通信协议发送对应的签名证书和密钥服务请求数据，二级密码服务监控系统利用签名证书对密钥服务请求进行解密，保证关键数据的正确性以及正常输出，保证了密码服务平台向智能物联网终端设备分发密钥的安全性。附图说明通过结合附图对本发明示例性实施方式进行更详细的描述，本发明的上述以及其它目的、特征和优势将变得更加明显，其中，在本发明示例性实施方式中，相同的参考标号通常代表相同部件。图1示出了本发明实施例提供的一种基于拟态防御的密码服务监控系统的结构示意图；图2示出了本发明实施例提供的一种基于拟态防御的密码服务监控系统的拟态异构防御模块的结构示意图；图3示出了本发明实施例提供的一种基于拟态防御的密码服务监控方法的流程示意图；附图标记说明：1、密码服务平台；11、一级密码服务监控系统；12、二级密码服务监控系统；111、密钥管理模块；112、证书管理模块；113、数字验签模块；114、身份认证模块；115、动态防御切换模块；116、安全分析模块；117、监听模块；118、拦截模块；121、密码服务模块；122、侦测模块；123、拟态异构防御模块；124、异常报警模块；125、防御策略更新模块；1231、分发单元；1232、调度单元；1233、执行体单元；1234、裁决单元；1235、执行体池；12351、执行体；2、终端物联设备。具体实施方式下面将更详细地描述本发明的优选实施方式。虽然以下描述了本发明的优选实施方式，然而应该理解，可以以各种形式实现本发明而不应被这里阐述的实施方式所限制。相反，提供这些实施方式是为了使本发明更加透彻和完整，并且能够将本发明的范围完整地传达给本领域的技术人员。实施例一参照图1、2所示，本发明提供一种基于拟态防御的密码服务监控系统，所述系统包括：密码服务平台1，密码服务平台1至少具有二个冗余备份系统，密码服务平台1包括一级密码服务监控系统11，一级密码服务监控系统通信连接至少一个二级密码服务监控系统12，一级密码服务监控系统11生成密钥服务请求通过预设的网络通信协议发送至二级密码服务监控系统12；一级密码服务监控系统11包括密钥管理模块111、证书管理模块112、数字验签模块113、身份认证模块114和动态防御切换模块115；身份认证模块114用于对登入密码服务平台1的用户标识授权对应的操作等级；密钥管理模块111获取密码机产生的密钥对并对密钥对进行存储、加密和分发；证书管理模块112基于密钥对的公钥结合不同操作等级的用户标识生成对应的签名证书；数字验签模块113基于密钥对的私钥对密钥服务请求进行数字签名，以生成加密的密钥服务请求；一级密码服务监控系统11将具有用户标识签名的加密的密钥服务请求下发至二级密码服务监控系统12；二级密码服务监控系统12包括密码服务模块121、侦测模块122、拟态异构防御模块123；侦测模块122用于自动侦测并获取带有用户标识签名的加密的密钥服务请求；密码服务模块121获取签名证书中密钥对的公钥对密钥服务请求进行解密；拟态异构防御模块123包括分发单元1231、调度单元1232、执行体单元1233、裁决单元1234、执行体池1235和执行体池中多个执行体12351；执行体单元1233从执行体池1235中获取具有相同功能的执行体12351；分发单元1231将解密后的密钥服务请求动态随机分发至执行体单元1233的多个执行体12351进行归一化处理并将处理结果返回至裁决单元1234；裁决单元1234对归一化处理结果进行比较和裁决，输出裁决结果；调度单元1232基于动态调度算法和裁决结果从执行体池1235调度若干执行体至执行体单元1233，替换执行体单元1233中具有异常输出的执行体12351；动态防御切换模块115分析拟态异构防御模块123的裁决结果并结合防御策略，用于当密钥服务请求存在威胁攻击时直接动态转移攻击面并将系统切换至冗余备份的密码服务平台1。具体的，本发明基于拟态防御技术，密码服务平台1采用冗余备份的保护架构，密码服务平台1包括相互通信的一级密码服务监控系统11和至少一个二级密码服务监控系统12，一级密码服务监控系统11为全局级密码服务监控系统，二级密码服务监控系统12为区域级密码服务监控系统，两者采用预设的通信协议传输数据，通信协议包括RPC、TCP、UDP、HTTP、HTTPS等各类网络协议。侦测模块122对一级密码服务监控系统11和二级密码服务监控系统12之间传输的密钥服务请求实时自动侦测，分析密钥服务请求是否带有威胁的数据，拟态异构防御模块123动态调度执行体12351使密钥服务请求存在的威胁处在动态变化当中，执行体池1235为N变体结构，每个执行体12351结构设置的后门不同，威胁攻击无法摸清执行体单元1233中异构体属性而进行有效攻击，同时加上裁决单元1234的多模裁决的限制使得解密的数据被篡改的难度加大。二级密码服务监控系统12设置的拟态异构防御模块123能直接动态转移攻击面并将密码服务平台系统切换至冗余备份系统，攻击时很难找到固定的漏洞，避免整个系统暴露在安全威胁当中，大大增加了攻击成本、消耗攻击时间，使平台能够带菌生存，实现了系统的动态防御。同时，调度单元1232会根据裁决单元1234发送来的反馈控制消息对执行体池1235中发生异常的执行体12351进行清洗或者下线处理，确保了执行体池1235的纯洁性。进一步地，一级密码服务监控系统11获取本地密钥机产生的密钥对，基于授权登入密码服务平台1的不同用户标识赋予不同的操作等级并生成对应的签名证书，该签名证书用于将密钥服务请求进行签名加密保护，防止该密钥数据在前期被恶意窃取和篡改攻击，按照通信协议发送对应的签名证书和密钥服务请求数据，二级密码服务监控系统12利用签名证书对密钥服务请求进行解密，保证关键数据的正确性以及正常输出，保证了密码服务平台1向智能物联网的终端物联设备2分发密钥的安全性。一种优选的示例，二级密码服务监控系统12根据密钥服务请求生成密钥获取请求并发送至一级密码服务监控系统11，密钥管理模块111包括密钥分发单元，密钥分发单元根据密钥获取请求，确定密钥下发方式，将存储的密钥对下发至密码服务模块121，密码服务模块121对密钥对进行解析，并下发至使用该密钥对的终端物联设备2。具体的，密钥下发方式可采用在线下发和离线下发两种方式，密钥分发单元采用确定密钥下发方式对应的获取规则向密钥管理模块111提出密钥获取申请，按照既定的通信协议，将获取的密钥对传输至密码服务模块121，密码服务模块121的密钥分发软件对密钥对进行解析，下发至使用密钥对的终端物联设备2。明确了密钥管理模块111和密码服务模块121之间密钥获取和分发的交互流程，使获得密钥对的终端物联设备2安全接入。一种优选的示例，二级密码服务监控系统12还包括异常报警模块124，异常报警模块124根据具有相同功能的执行体产生的执行日志对密钥服务请求存在的威胁程度进行信息分类并输出告警信息。具体的，异常报警模块124接收来自具有相同功能的执行体产生的所有执行日志进行关联分析，从拟态防御执行日志中提取出错误信息的关键特征信息，确定密钥服务请求存在的威胁程度，对存在的威胁程度进行信息分类并输出告警信息，告警信息记录关键特征信息的日志来源对应的执行体存在威胁及威胁程度，威胁程度分为高级威胁、中级威胁、低级威胁、无威胁，如果所述目标用户请求产生高级威胁，则发送调度请求至调度单元，由调度单元对产生威胁的执行体12351进行下线和异常数据消除处理，基于动态调度算法和裁决结果从执行体池1235调度若干执行体至执行体单元1233，替换执行体单元1233中具有异常输出的执行体12351，基于威胁程度信息分类，避免过度告警而导致频繁调度清洗，节省系统开销。一种优选的示例，一级密码服务监控系统11还包括安全分析模块116，安全分析模块116设置于一级密码服务监控系统11的前端，安全分析模块116预设特征信息规则库，对密码服务平台1通信网络的运行状态进行监控，采集网络报文提取特征信息，基于特征信息规则库对通信网络的运行状态进行安全评估并对异常网络报文进行响应。具体的，安全分析模块116采集网络报文提取特征信息，对通信网络中出现的异常情况进行归纳整理并将其结果按规定格式记录至特征信息规则库，形成训练样本用于特征信息规则库训练，不断地对该规则库进行修正和完善，通过设置在一级密码服务监控系统11的后台监控软件的网络端口可视化界面查询分析，尽可能地在一级密码服务监控系统11的前端过滤非法访问流量，响应并抑制异常网络报文的发送和接收，对网络中产生的异常变化进行迅速预判并给出辅助处理策略，保证了通行网络的正常运行。一种优选的示例，一级密码服务监控系统11还包括监听模块117和拦截模块118，监听模块117和拦截模块118设置于一级密码服务监控系统11的后端，监听模块117捕获网络报文并解析该网络报文的数据包，拦截模块118预设异常拦截规则库，拦截模块118基于异常拦截规则库的异常判断规则，对解析后的数据包进行检测，以对异常网络报文进行捕获拦截。具体的，拦截模块118预设的异常拦截规则库，由布置在全局网络监控主站的网络规则数据库，根据网络节点需要配置生成，并以文件形式存储至拦截模块118中。该异常拦截规则可以从逻辑上分为两个部分：规则头和规则选项。规则头定义了规则的行为、所匹配网络报文的协议、源地址、目标地址、源端口以及目标端口等信息；规则选项则包含了网络报文异常判断方法以及所需要的告警信息。安全分析模块116设置于一级密码服务监控系统11的前端，监听模块117和拦截模块118设置于一级密码服务监控系统11的后端，通过安全分析、主动监听与拦截，避免因被动防御而引起滞后性高的弊端，解决了在一级密码服务监控系统11的全局侧缺乏网络攻击监测分析能力而导致网络攻击漏报的问题。一种优选的示例，防御策略由区间端点分别为表示最高优先级的需要防御策略类型和表示最低优先级的不需要防御策略类型组成的防御策略集合区间，根据防御策略权重因子从防御策略集合区间选取对应可用的防御策略。具体的，防御策略类型包括预防、监测、恢复，其重要性则以关键或非关键衡量。C是最高优先级，表示需要的防御策略类型；N是最低优先级，也就是不需要的防御策略类型。本示例中，基于拟态防御动态切换条件下，衡量各防御策略类型在不同恶意目标下的重要性，最终确定针对性的防御策略区间，选取对应可用的防御策略，采取主动防御的方式执行该防御策略。一种优选的示例，二级密码服务监控系统12还包括防御策略更新模块125，防御策略更新模块125实时监控并分析多个执行体生成的执行日志，用于更新防御策略权重因子，基于更新的防御策略权重因子从防御策略集合区间选取最优防御策略。一种优选的示例，根据防御策略权重因子从防御策略集合区间选取防御策略的计算模型为：其中，D表示防御策略集合，为采用第i个防御策略的概率，n为攻击策略的总数，为根据多个执行体生成的执行日志计算生成对应的防御策略权重因子，α为当前防御策略与前一个防御策略的关联因子，为基于关联因子α与防御策略权重因子定义的防御策略，为防御策略的效用，为从从防御策略集合中选取对应可用的防御策略的效用。具体的，设置防御策略更新模块125实时监控并分析多个执行体生成的执行日志，根据防御策略权重因子从防御策略集合区间选取对应可用的防御策略。执行防御策略方案期间，系统可能仍会遭受新的攻击，因此，以确定是否有必要重新规划防御策略。当受到新的攻击时，由于拟态防御不会发生改变，所以新的攻击只会影响防御策略执行的顺序，因此通过引入防御策略权重因子、前后防御策略的关联因子α，建立防御策略选取的计算模型，选取具有最高效用的防御策略方案并执行。一种优选的示例，密码服务平台1采用分布式微服务架构。具体的，密码服务平台1采用分布式微服务架构设计，密码服务平台1按功能模块拆分为不同的服务，独立开发、独立部署、独立维护。相对于传统的服务，微服务架构具有更高的可靠性、可伸缩性，且每个模块职责单一，维护和开发都变得更加容易，系统集群化部署。采用WebService技术实现一级密码服务监控系统11后台和二级密码服务监控系统12后台之间的数据交互，方便快捷。实施例二参照图3所示，本实施例提供一种基于拟态防御的密码服务监控方法，应用上述的基于拟态防御的密码服务监控系统，包括如下步骤：步骤S1：密码服务平台1初始化配置，使其至少具有二个冗余备份系统，其中，密码服务平台1配置有一级密码服务监控系统11和至少一个二级密码服务监控系统12；步骤S2：一级密码服务监控系统11与二级密码服务监控系统12建立通信连接；步骤S3：获取密码机产生的密钥对，将密钥对结合登入密码服务平台的用户标识对应授权的操作等级生成对应的签名证书；步骤S4：生成密钥服务请求，基于密钥对的私钥对密码服务请求进行数字签名，以生成加密的密码服务请求，并下发至二级密码服务监控系统；步骤S5：自动侦测并获取带有用户标识签名的加密的密码服务请求，基于签名证书中密钥对的公钥对密码服务请求进行解密；步骤S6：将解密后的密码服务请求动态随机分发至执行体单元中多个执行体进行归一化处理，对归一化处理结果进行比较和裁决，输出裁决结果；步骤S7：基于动态调度算法和裁决结果找出执行体单元中异常输出的执行体，从执行体池调度若干执行体替换具有异常输出的执行体；步骤S8：分析裁决结果并结合防御策略，当密码服务请求存在威胁攻击时直接动态转移攻击面并将系统切换至冗余备份的密码服务平台1。该方法应用上述的基于拟态防御的密码服务监控系统，使系统受到攻击时很难找到固定的漏洞，避免整个系统暴露在安全威胁当中，大大增加了攻击成本、消耗攻击时间，使平台能够带菌生存，实现了系统的动态防御。具体参照实施例一相关描述，此处不再详细赘述。以上已经描述了本发明的各实施例，上述说明是示例性的，并非穷尽性的，并且也不限于所披露的各实施例。在不偏离所说明的各实施例的范围和精神的情况下，对于本技术领域的普通技术人员来说许多修改和变更都是显而易见的。
