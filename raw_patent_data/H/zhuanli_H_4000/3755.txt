标题title
电子标签芯片和充电线缆
摘要abst
本申请提供一种电子标签芯片和充电线缆，电子标签芯片包括：通信引脚，用于连接到供电设备；控制器，用于根据线缆信息生成第一电压信号；稳压器，其输入端连接预设电压端以接收第一供电电压，稳压器的输出端用于输出预设第一电压，预设第一电压为高电平；第一开关，控制端用于接收第一电压信号，第一端连接稳压器的输出端，第二端连接通信引脚，控制端在第一电压信号为高电平时控制第一开关导通以将预设第一电压输出至通信引脚；低电平输出支路，连接于控制器与通信引脚之间，用于接收第一电压信号，在第一电压信号为低电平时输出低电平信号至通信引脚。本申请能够使得电子标签芯片在应用于较长的充电线缆时，提高充电效率和安全性。
权利要求书clms
1.一种电子标签芯片，设置于充电线缆内，所述充电线缆包括位于两端的第一接口和第二接口，所述第一接口和第二接口可互换的连接供电设备与受电设备，所述电子标签芯片存有所述充电线缆的线缆信息，所述供电设备至少根据所述线缆信息输出充电信号至所述受电设备，其特征在于，所述电子标签芯片设置于所述充电线缆两端其中之一，所述电子标签芯片包括：通信引脚，用于连接到所述供电设备；控制器，用于根据所述线缆信息生成第一电压信号，所述第一电压信号包括高电平和低电平组成的电压序列；稳压器，其输入端连接预设电压端以接收第一供电电压，所述稳压器的输出端用于输出预设第一电压，其中所述预设第一电压为高电平；第一开关，所述第一开关的控制端用于接收所述第一电压信号，所述第一开关的第一端连接所述稳压器的输出端，所述第一开关的第二端连接所述通信引脚，所述第一开关的控制端在所述第一电压信号为高电平的时候控制所述第一开关导通以将所述预设第一电压输出至所述通信引脚；低电平输出支路，连接于所述控制器与所述通信引脚之间，所述低电平输出支路用于接收所述第一电压信号，并在所述第一电压信号为低电平的时候输出低电平信号至所述通信引脚。2.根据权利要求1所述的电子标签芯片，其特征在于，所述第一电压小于所述预设电压端的供电电压。3.根据权利要求1所述的电子标签芯片，其特征在于，进一步包括：第一电源接收引脚和第二电源接收引脚，分别用于连接所述第一接口和所述第二接口，所述第一电源接收引脚或者所述第二电源接收引脚连接所述供电设备的芯片供电端以接收第二供电电压，所述第二供电电压为所述控制器供电。4.根据权利要求1至3任一项所述的电子标签芯片，其特征在于，所述第一开关包括：第一NMOS管，其中，所述第一NMOS管的栅极作为所述第一开关的控制端，源极作为所述第一开关的第一端，漏极作为所述第一开关的第二端。5.根据权利要求1至3任一项所述的电子标签芯片，其特征在于，所述第一开关包括：第二NMOS管和第三NMOS管，其中，所述第二NMOS管的栅极以及所述第三NMOS管的栅极作为所述第一开关的控制端；所述第二NMOS管的源极作为所述第一开关的第二端，漏极连接所述第三NMOS管的漏极；所述第三NMOS管的源极作为所述第一开关的第一端。6.根据权利要求1至3任一项所述的电子标签芯片，其特征在于，所述第一开关包括：第一PMOS管，其中，所述第一PMOS管的栅极作为所述第一开关的控制端，漏极作为所述第一开关的第一端，源极作为所述第一开关的第二端。7.根据权利要求1至3任一项所述的电子标签芯片，其特征在于，所述第一开关包括：第二PMOS管和第三PMOS管，其中，所述第二PMOS管的栅极以及所述第三PMOS管的栅极作为所述第一开关的控制端；所述第二PMOS管的漏极作为所述第一开关的第二端，源极连接所述第三PMOS管的源极；所述第三PMOS管的漏极作为所述第一开关的第一端。8.根据权利要求1至3任一项所述的电子标签芯片，其特征在于，所述第一开关的第二端连接所述通信引脚，包括：所述第一开关的第二端连接第一电阻的第一端，所述第一电阻的第二端连接所述通信引脚。9.根据权利要求1至3任一项所述的电子标签芯片，其特征在于，所述低电平输出支路包括：反相器以及第二开关，其中，所述反相器的输入端用于接收所述第一电压信号，输出端连接所述第二开关的控制端，所述第二开关的第一端接地，所述第二开关的第二端连接所述通信引脚。10.根据权利要求9所述的电子标签芯片，其特征在于，所述第二开关的第二端连接所述通信引脚，包括：所述第二开关的第二端连接第二电阻的第一端，所述第二电阻的第二端连接所述通信引脚。11.根据权利要求9所述的电子标签芯片，其特征在于，所述第二开关包括：第四NMOS管，其中，所述第四NMOS管的栅极作为所述第二开关的控制端，源极作为所述第二开关的第一端，漏极作为所述第二开关的第二端。12.根据权利要求9所述的电子标签芯片，其特征在于，所述第二开关包括：第四PMOS管，其中，所述第四PMOS管的栅极作为所述第二开关的控制端，漏极作为所述第二开关的第一端，源极作为所述第二开关的第二端。13.根据权利要求1所述的电子标签芯片，其特征在于，所述线缆信息包括所述充电线缆的通流能力信息、传输速度和线缆标识其中至少之一。14.一种充电线缆，其特征在于，包括：传输线缆，至少包括充电连线和通信连线；分别位于所述传输线缆两端的第一接口和第二接口，所述第一接口和所述第二接口可用于分别接入供电设备与受电设备，以使供电设备与受电设备通过所述传输线缆产生连接；电子标签芯片，设置于所述充电线缆的任一端，并通过所述通信连线连接在所述供电设备和受电设备之间，所述电子标签芯片为权利要求1至13任意一项所述的电子标签芯片。
说明书desc
技术领域本申请涉及功率传输快充领域，特别涉及一种适用于充电线缆的电子标签芯片和充电线缆。背景技术随着PD快充技术的发展，充电功率不断提升，USB-IF协会规定当充电线缆的数据传输速度达到5Gbps或者充电线缆的传输电流大于3A时，充电线缆上必须搭载电子标签芯片，E-marker用于保存线缆信息如通流能力信息、传输速度、标识等。通流能力信息中记录有充电线缆可支持传输的最大充电电流。供电设备可通过通用串行总线-功率传输协议与E-marker通讯，在快充发起之前通过访问E-marker确认充电线缆的线缆信息。供电设备在为受电设备确定充电电流时，将线缆信息中的通流能力信息作为参考条件之一，防止充电电流大于线缆可支持传输的最大充电电流，保证充电的安全性。目前市面上的E-marker芯片在应用于较长的充电线缆，例如2m以上的充电线缆时，会出现E-marker与供电设备之间通信不稳定的问题，从而导致供电设备从E-marker无法获取或者无法准确获取充电线缆的线缆信息，进而导致供电设备无法使用合适的充电电流为受电设备充电，影响充电效率或者充电安全性。发明内容本申请提供了一种电子标签芯片和充电线缆，能够使得电子标签芯片在应用于较长的充电线缆时，提高充电效率和安全性。第一方面，本申请实施例提供一种电子标签芯片，设置于充电线缆内，所述充电线缆包括位于两端的第一接口和第二接口，所述第一接口和第二接口可互换的连接供电设备与受电设备，所述电子标签芯片存有所述充电线缆的线缆信息，所述供电设备至少根据所述线缆信息输出充电信号至所述受电设备，所述电子标签芯片设置于所述充电线缆两端其中之一，所述电子标签芯片包括：通信引脚，用于连接到所述供电设备；控制器，用于根据所述线缆信息生成第一电压信号，所述第一电压信号包括高电平和低电平组成的电压序列；稳压器，其输入端连接预设电压端以接收第一供电电压，所述稳压器的输出端用于输出预设第一电压，其中所述预设第一电压为高电平；第一开关，所述第一开关的控制端用于接收所述第一电压信号，所述第一开关的第一端连接所述稳压器的输出端，所述第一开关的第二端连接所述通信引脚，所述第一开关的控制端在所述第一电压信号为高电平的时候控制所述第一开关导通以将所述预设第一电压输出至所述通信引脚；低电平输出支路，连接于所述控制器与所述通信引脚之间，所述低电平输出支路用于接收所述第一电压信号，并在所述第一电压信号为低电平的时候输出低电平信号至所述通信引脚。该电子标签芯片中，在第一电压信号为高电平时，第一开关和稳压器所在支路导通，由于稳压器输出稳定的第一电压，也即高电平，因此，可以使得电子标签芯片的通信引脚输出稳定的高电平信号，在第一电压信号为低电平时，可以使得电子标签芯片的通信引脚输出低电平信号，实现通信信号的稳定输出，从而使得电子标签芯片应用于任何长度的充电线缆时，都能够向供电设备输出稳定的通信信号，提高电子标签芯片与供电设备之间通信的稳定性，使得供电设备能够更为准确地获取到电子标签芯片所属充电线缆的通流能力信息，进而使用合适的充电电流为受电设备充电，提高充电效率和充电的安全性。在一种可能的实现方式中，所述第一电压小于所述预设电压端的供电电压。在一种可能的实现方式中，进一步包括：第一电源接收引脚和第二电源接收引脚，分别用于连接所述第一接口和所述第二接口，所述第一电源接收引脚或者所述第二电源接收引脚连接所述供电设备的芯片供电端以接收第二供电电压，所述第二供电电压为所述控制器供电。在一种可能的实现方式中，所述第一开关包括：第一NMOS管，其中，所述第一NMOS管的栅极作为所述第一开关的控制端，源极作为所述第一开关的第一端，漏极作为所述第一开关的第二端。在一种可能的实现方式中，所述第一开关包括：第二NMOS管和第三NMOS管，其中，所述第二NMOS管的栅极以及所述第三NMOS管的栅极作为所述第一开关的控制端；所述第二NMOS管的源极作为所述第一开关的第二端，漏极连接所述第三NMOS管的漏极；所述第三NMOS管的源极作为所述第一开关的第一端。在一种可能的实现方式中，所述第一开关包括：第一PMOS管，其中，所述第一PMOS管的栅极作为所述第一开关的控制端，漏极作为所述第一开关的第一端，源极作为所述第一开关的第二端。在一种可能的实现方式中，所述第一开关包括：第二PMOS管和第三PMOS管，其中，所述第二PMOS管的栅极以及所述第三PMOS管的栅极作为所述第一开关的控制端；所述第二PMOS管的漏极作为所述第一开关的第二端，源极连接所述第三PMOS管的源极；所述第三PMOS管的漏极作为所述第一开关的第一端。在一种可能的实现方式中，所述第一开关的第二端连接所述通信引脚，包括：所述第一开关的第二端连接第一电阻的第一端，所述第一电阻的第二端连接所述通信引脚。在一种可能的实现方式中，所述低电平输出支路包括：反相器以及第二开关，其中，所述反相器的输入端用于接收所述第一电压信号，输出端连接所述第二开关的控制端，所述第二开关的第一端接地，所述第二开关的第二端连接所述通信引脚。在一种可能的实现方式中，所述第二开关的第二端连接所述通信引脚，包括：所述第二开关的第二端连接第二电阻的第一端，所述第二电阻的第二端连接所述通信引脚。在一种可能的实现方式中，所述第二开关包括：第四NMOS管，其中，所述第四NMOS管的栅极作为所述第二开关的控制端，源极作为所述第二开关的第一端，漏极作为所述第二开关的第二端。在一种可能的实现方式中，所述第二开关包括：第四PMOS管，其中，所述第四PMOS管的栅极作为所述第二开关的控制端，漏极作为所述第二开关的第一端，源极作为所述第二开关的第二端。在一种可能的实现方式中，所述线缆信息包括所述充电线缆的通流能力信息、传输速度和线缆标识其中至少之一。第二方面，本申请实施例提供一种充电线缆，包括：传输线缆，至少包括充电连线和通信连线；分别位于所述传输线缆两端的第一接口和第二接口，所述第一接口和所述第二接口可用于分别接入供电设备与受电设备，以使供电设备与受电设备通过所述传输线缆产生连接；电子标签芯片，设置于所述充电线缆的任一端，并通过所述通信连线连接在所述供电设备和受电设备之间，所述电子标签芯片为第一方面任意一项所述的电子标签芯片。该充电线缆中的电子标签芯片在第一电压信号为高电平时，第一开关和稳压器所在支路导通，由于稳压器输出稳定的第一电压，也即高电平，因此，可以使得电子标签芯片的通信引脚输出稳定的高电平信号，在第一电压信号为低电平时，可以使得电子标签芯片的通信引脚输出低电平信号，实现通信信号的稳定输出，从而使得电子标签芯片应用于任何长度的充电线缆时，都能够向供电设备输出稳定的通信信号，提高电子标签芯片与供电设备之间通信的稳定性，使得供电设备能够更为准确地获取到电子标签芯片所属充电线缆的通流能力信息，进而使用合适的充电电流为受电设备充电，提高充电效率和充电的安全性。附图说明图1为本申请快充场景示意图；图2为本申请双Type-C充电线缆内E-marker的设置位置示意图；图3为本申请E-marker芯片的内部结构示意图；图4A～图4C为本申请双Type-C充电线缆上设置E-marker时供电设备、E-marker以及受电设备之间的连接关系示意图；图5为本申请受电设备进入快充模式后供电设备、E-marker、受电设备之间的工作时序示意图；图6为通信信号波形示意图；图7为充电线缆寄生参数对供电设备与E-marker之间通信的影响示意图；图8为一种E-marker的CCIN引脚的输入输出电路结构示意图；图9为本申请电子标签芯片中通信引脚的输出电路结构示意图；图10为图8和图9所示电路结构下CCIN引脚输出的通信信号波形示意图；图11为本申请电子标签芯片中通信引脚的输出电路结构的另一个示意图；图12为本申请电子标签芯片中通信引脚的输出电路结构的又一个示意图；图13为本申请电子标签芯片中通信引脚的输出电路结构的又一个示意图；图14为本申请电子标签芯片中通信引脚的输出电路结构的又一个示意图；图15为本申请电子标签芯片中通信引脚的输出电路结构的又一个示意图。具体实施方式本申请的实施方式部分使用的术语仅用于对本申请的具体实施例进行解释，而非旨在限定本申请。快充是快速充电的简称。USB PD协议是目前主流的快充协议之一，它是由USB-IF组织制定的一种快速充电规范。USB接口有三种不同外观的接口，分别是Type-A、Type-B和Type-C，Type-C拥有相对于Type-A和Type-B更小的体积，是最新的USB接口外形标准。目前很多使用USB Type-C接口的设备支持USB PD协议。参见图1所示，在快充场景下可以包括：供电设备110、充电线缆120以及受电设备130，供电设备可以是我们平时所称的充电头，充电线缆是我们平时所称的数据线，在一个实施例中，充电线缆可以是快充线缆。受电设备可以是电子设备例如手机、平板电脑、笔记本电脑等。充电线缆可以使用充电接口例如USB Type-C接口分别与供电设备和受电设备连接，以下将使用USB Type-C接口的充电线缆称为Type-C充电线缆。USB-IF协会规定当充电线缆的数据传输速度达到5Gbps或者充电线缆的传输电流大于3A时，充电线缆上必须搭载E-marker。E-marker用于保存线缆信息如通流能力信息、传输速度、标识等。通流能力信息中记录有充电线缆能够支持传输的最大充电电流。在为受电设备充电之前，供电设备可通过USB-PD协议与E-marker通讯，从E-marker获取充电线缆的线缆信息，线缆信息中包括线缆的通流能力信息。线缆的通流能力信息是供电设备为受电设备确定充电电流的参考条件之一。供电设备在为受电设备确定充电电流时，需要根据供电设备自身能够支持的最大充电电流、充电线缆能够支持的最大充电电流、受电设备能够支持的最大充电电流这三个条件来确定。确定的充电电流应不超过供电设备、充电线缆和受电设备分别支持的最大充电电流，保证供电设备、充电线缆和受电设备充电的安全性；并且，确定的充电电流应在不超过供电设备、充电线缆和受电设备分别支持的最大充电电流的条件下尽量大，保证充电效率。参见图2，以双Type-C充电线缆为例，示出了双Type-C充电线缆内E-marker的设置位置示意图，双Type-C充电线缆的两端均设置Type-C接口以及接口对应的电缆室；E-marker一般设置于电缆室中。如果双Type-C充电线缆线长较短例如2m以下，双Type-C充电线缆中一般只在其中1个电缆室中设置1个E-marker，也即在双Type-C充电线缆中仅设置1个E-marker，例如图2所示，仅在左侧的电缆室中设置了1个E-marker。如果双Type-C充电线缆线长较长例如2m以上，如果仍然仅在其中1个电缆室中设置1个E-marker，会出现E-marker与供电设备之间通信不稳定的问题。E-marker与供电设备之间通信不稳定，可能会使得供电设备从E-marker无法获取或者无法准确获取充电线缆的线缆信息。如果供电设备从E-marker无法获取充电线缆的线缆信息，为了保证充电安全，供电设备一般会使用预设的相对较小的充电电流来为受电设备充电，从而降低了充电效率。如果供电设备从E-marker无法准确获取充电线缆的线缆信息，假设供电设备获取到的充电线缆支持传输的最大充电电流大于充电线缆实际支持传输的最大充电电流，此时，供电设备确定的充电电流可能会大于充电线缆支持传输的最大充电电流，从而影响充电的安全性。因此，E-marker与供电设备之间通信不稳定会影响供电设备对受电设备充电的效率或者安全性。目前为了解决该问题，在线长较长的充电线缆例如2m以上的双Type-C充电线缆内，一般在2个电缆室中分别设置1个E-marker，也即在双Type-C充电线缆中设置有2个E-marker，从而导致2m以上线长的双Type-C充电线缆成本增加。以下，对出现上述通信不稳定问题的原因进行详细说明。首先，对E-marker芯片的内部结构进行说明。图3是E-marker芯片的内部结构示意图。其中，VCONN1引脚和VCONN2引脚用于完成对E-marker的供电，VCONN1引脚和VCONN2引脚中每次仅有一个引脚作为电源接收端，并且作为E-marker芯片内部各器件的电源电压端，为各个器件例如控制器、寄存器、I2C控制器等供电。VCONN1引脚和VCONN2引脚之间设置有反向串联的二极管D11和二极管D12，用于隔离VCONN1引脚和VCONN2引脚。VCONN1引脚通过串联的电阻Ra1和开关K1接地，VCONN2引脚通过串联的电阻Ra2和开关K2接地，电阻Ra1和电阻Ra2的阻值可以相同。设置电阻Ra1和电阻Ra2的作用在于识别VCONN1引脚和VCONN2引脚中哪个引脚连接至供电设备，作为电源接收端。检测器即用于分别检测VCONN1引脚和VCONN2引脚上的电压，以确定VCONN1引脚和VCONN2引脚中是否有引脚连接至供电设备。在VCONN1引脚和VCONN2引脚中的一个引脚作为电源接收端，为E-marker内部的各个器件供电后，为了防止电阻Ra1和电阻Ra2耗电，达到省电的目的，开关K1和开关K2可以断开。E-marker芯片中的内部总线上连接有USB PD控制器、I2C控制器、M-一次性可编程等器件，此外，E-marker芯片中还可以设置有静电阻抗器以及通用输入输接口等器件。E-marker芯片中的程序数据以及线缆信息等不可更改的数据可以经由I2C接口的SCL引脚和SDA引脚写入M-OTP；USB PD控制器用于实现对于通信数据从应用层到协议层再到物理层的逐层处理，或者从物理层到协议层再到应用层的逐层处理。E-marker芯片的CCIN引脚可以用于完成E-marker与供电设备之间的数据通信，例如完成前述供电设备从E-marker获取线缆信息的数据通信。可选地，E-marker中还可以对应用层数据进行加密处理，加密算法可以由USB PD控制器实现，也可以设置独立的期间实现该加密算法，图3中以加密算法由独立于USB PD控制器的器件实现为例。以下，通过图4A～图4C对设置有E-marker的充电线缆与供电设备、受电设备之间的连接关系进行说明。图4A示意出了双Type-C充电线缆上设置1个E-marker时供电设备41、受电设备42以及E-marker之间的连接关系。充电线缆可以分为主动线缆和被动线缆，主动线缆中设置有信号中继器，能够对传输信号进行信号完整性恢复，被动线缆则未设置信号中继器。图4A中以充电线缆是被动线缆为例。Type-C接口中包括VBUS、CC、VCONN、GND、TX、RX、D+、D-等多个引脚，图4A中仅示出了其中的4个引脚，分别是VBUS、CC、VCONN以及GND。为了实现线缆两端的Type-C接口中对应引脚之间的相互连接，双Type-C充电线缆中设置有引脚对应的连线。例如，为了连接线缆两端的Type-C接口的CC引脚，双Type-C充电线缆中存在CC通信连线，即两端的Type-C接口的CC引脚通过CC通信连线相互连接；同理，双Type-C充电线缆中还存在VBUS充电连线、GND通信连线等。其中的VBUS引脚以及VBUS充电连线用于传输充电电流，实现供电设备41为受电设备42充电。应理解，充电线缆中的连线两端连接的引脚不一定是线缆两端Type-C接口的相同引脚，举例来说，充电线缆中存在通信连线一端连接一个Type-C接口的TX引脚，另一端连接另一Type-C接口的RX引脚。供电设备41的Type-C接口的VCONN引脚通过单刀双掷开关K3连接两条支路，一条支路VCONN引脚直接连接电源电压端VDD2，一条支路通过电阻Rp连接电源电压端VDD3，单刀双掷开关K3每次选通其中一条支路。电源电压端VDD2的电压等于E-marker芯片的工作电压。在充电线缆的Type-C接口未连接至供电设备41的Type-C接口时，单刀双掷开关K3可以选通电阻Rp所在支路，此时，VCONN引脚的电压等于电源电压端VDD2的电压；充电线缆的Type-C接口连接至供电设备41的Type-C接口时，E-marker的VCONN1引脚连接至供电设备41的VCONN引脚，结合图3所示E-marker的内部结构，由于电源电压端VDD3通过电阻Rp、单刀双掷开关K3、电阻Ra1接地，电阻Rp和电阻Ra1分压，供电设备41的VCONN引脚的电压降低，供电设备41检测到VCONN引脚的电压发生变化，控制单刀双掷开关K3选通直接连接电源电压端VDD2的支路，电源电压端VDD2通过单刀双掷开关K3以及引脚VCONN直接连接E-marker的VCONN1引脚，通过VCONN1引脚为E-marker内部的各个器件供电，也即为E-marker供电。E-marker的CCIN引脚连接CC通信线，在双Type-C充电线缆与供电设备41和受电设备42连接的情况下，E-marker的CCIN引脚分别与供电设备41以及受电设备42中Type-C接口的CC引脚对应连接，在供电设备的电源电压端VDD2通过VCONN1引脚为E-marker供电后，可以通过CCIN引脚和CC通信线完成与供电设备41之间的通信，将线缆信息传输至供电设备41。图4B示意出了双Type-C充电线缆是被动线缆且设置2个E-marker时供电设备41、受电设备42以及E-marker之间的连接关系。参见图4B，虽然充电线缆中设置有2个E-marker，但是，供电设备仅为与供电设备直接连接的E-marker43供电，并与E-marker43进行通信，获取线缆信息，供电设备为E-marker供电的原理参见图4A，这里不赘述；另一个E-marker44不工作。图4C示意出了双Type-C充电线缆是主动线缆且设置2个E-marker时供电设备41、受电设备42以及E-marker之间的连接关系。由于是主动线缆，充电线缆中还设置有2个USB-Redriver，用于在信号高速传输过程中对充电线缆中传输的信号进行完整性恢复，USB-Redriver可以通过I2C接口与对应的E-marker连接。主动线缆可以适用于信号高速传输的场景下。为了使得USB-Redriver能够正常工作，图4C与图4B的区别主要在于：供电设备41的VCONN引脚除了为E-marker45供电外，还通过低压差线性稳压器连接E-marker46的VCONN2引脚，通过VCONN2引脚为E-marker46内部的各个器件供电。但是，供电设备仅需与相对更为接近的E-marker45通信，从E-marker45获取线缆信息，无需与E-marker46通信，从E-marker46获取线缆信息。对于图4A～图4C所示的电路，通过图5示出了供电设备、E-marker、受电设备之间的工作时序示意图，以供电设备未连接受电设备时不为E-marker供电、连接受电设备后为E-marker供电为例，包括5个阶段，分别是：在第1个阶段：供电设备未连接受电设备时，供电设备不为E-marker供电，供电设备的VCONN引脚的电压为0V；CC引脚以及CC通信线上的电压等于供电设备中电源电压端VDD1的电压，图5中所示为3.3V；供电设备不为受电设备充电，Vbus通信线上的电压为0V；在第2个阶段：供电设备可以通过检测CC引脚的电压变化来识别充电线缆上是否连接受电设备，由于受电设备中CC引脚连接的电阻Rd的分压，供电设备连接受电设备后，供电设备的CC引脚的电压降低，例如图5所示，CC引脚的电压降低至小于2V，供电设备检测到已连接受电设备；之后，供电设备选通单刀双掷开关K3到存在电阻Rp的支路，通过检测VCONN引脚的电压来确定充电线缆是否设置有E-marker，如图5所示，VCONN引脚的电压不等于电源电压端VDD3的电压，且小于电源电压端VDD3的电压，因此，供电设备可以检测到充电线缆设置有E-marker。在第3个阶段：供电设备选通单刀双掷开关K3至直接连接电源电压端VDD2的支路，从而供电设备通过VCONN引脚为E-marker供电，VCONN引脚的电压升高至5V的工作电压；供电设备通过CC引脚从E-marker获取线缆信息，CC通信线上存在小于2V的电压；供电设备调整充电电压VBUS为较小的预设充电电压，开始为受电设备充电，这一预设充电电压对应的充电电流是普通充电线缆可支持的充电电流，小于充电线缆可支持传输的最大充电电流，例如图5中该预设充电电压为小于3V的电压。在第4个阶段：供电设备不再为E-marker供电，VCONN引脚的电压为0V，E-marker不工作；供电设备和受电设备之间进行通信，通信中可以获取受电设备可支持的最大充电电流，CC通信线上仍然存在小于2V的电压；供电设备继续按照预设充电电压为受电设备充电，VBUS通信线上的电压为小于3V的预设充电电压。在第5个阶段：供电设备在确定供电设备、充电线缆以及受电设备可支持的最大充电电流后，为受电设备确定充电电流，如果该充电电流大于上述预设充电电压对应的充电电流，调整充电电压至新确定的充电电流对应的充电电压，例如图5中该充电电压为4V，也即VBUS通信线上的电压调整为4V，实现快充。在供电设备与E-marker通信过程中，CC上的通信信号波形如图6所示，通信信号的高电平一般为1.2V，低电平一般为0V，频率为300kHZ±10％。也即是说，E-marker的CCIN引脚需要输出高电平为1.2V、低电平为0V的电压波形，高电平可以表示二进制数值1，低电平可以表示二进制数值0，通过该电压波形向供电设备传输数据例如线缆信息的二进制数据。以下说明充电线缆的线长对供电设备与E-marker之间通信的影响。图7为充电线缆寄生参数对供电设备与E-marker之间通信的影响示意图，如图7所示，如果充电线缆过长，例如超过2m，会导致CC通信线到地的电容过大，而每次E-marker输出的通信信号从低电平信号变为高电平信号时需要对线缆寄生电容充电，这一充电过程会导致通信信号的上边沿变化缓慢，进而使得通信信号的传输时延大，供电设备与E-marker之间的通信不稳定。为此，如图4B和4C所示，在超过2m的充电线缆上可以设置2个E-marker，以便解决该问题，此时，供电设备只需要识别到离供电设备最近的一个E-marker进行通信，来获取线缆信息，而离供电设备最近的E-marker由于只占到线缆总长的一小部分，所以线缆寄生电容小，不会出现上述因为线缆寄生电容过大导致的通信不稳定问题。但是设置2个E-marker会导致充电线缆的成本增加。在一个实例中，E-marker830内部CCIN引脚的输入输出电路结构如图8所示，输入输出电路831的第一端81连接E-marker830的CCIN引脚，用于接收通信信号或者输出通信信号；输入输出电路831的第二输入端82、第三输入端83、第一输出端84和第二输出端85分别连接E-marker830的控制器832；第二输入端用于接收控制器832输出的第一电压信号，第一电压信号是控制器832所需输出的通信信号对应的第一电压信号。对图8中输入输出电路831的工作原理进行说明：对于CCIN引脚的输入电路部分：对于CCIN引脚接收到的通信信号，比较器COMP2将其与参考电压REF2比较，通信信号的电压大于参考电压REF2时，可以输出高电平信号，通信信号的电压不大于参考电压REF2时，可以输出低电平信号，从而得到接收到的通信信号，该通信信号通过输入输出电路的第一输出端84输出至E-marker830的控制器832。对于CCIN引脚的输出电路部分：该部分的工作原理分为两种情况，情况一是受电设备已经与充电线缆连接，情况二是受电设备未与充电线缆连接。对于情况一，受电设备已经与充电线缆连接时，如果E-marker830的控制器832需要向供电设备810发送通信信号，可以根据所需发送的数据生成第一电压信号，将第一电压信号输出至输入输出电路831的第二输入端82，第二输入端82接收到该第一电压信号；所需发送的数据是线缆信息在物理层的二进制数值序列，相应的，第一电压信号也是由若干个对应的高低电平信号组成的连续信号序列，第一电压信号的波形具体可以参考图6所示，高电平表示二进制数值1，低电平表示二进制数值0；该第一电压信号为低电平信号时，反相器U将其反相后得到高电平信号，该高电平信号使得开关K1导通，从而第一端81输出低电平信号；此时，开关K2关断，开关K2和电阻Rd1构成的支路无信号输出；该第一电压信号为高电平信号时，开关K2导通，电源电压端VDD通过供电设备中的电阻Rp和E-marker中的电阻Rd1以及开关K2与地之间形成通路，电源电压端VDD的电压是芯片工作电压，通过电阻Rd1分压得到1.2V电压，从而第一端81输出1.2V电压，也即高电平信号；此时，开关K1关断，开关K1所在支路无信号输出。上述E-marker830在第一电压信号为高电平时第一端81输出1.2V电压是假定受电设备接入的情况下的输出电压，通过图8可知，在受电设备接入时，得到1.2V电压的分压电阻是E-marker830中的电阻Rd1以及受电设备820中的电阻Rd并联得到的。为了使得供电设备810和E-marker830之间在受电设备820没有接入的情况下也能够正常通信，需要在E-marker830中补偿受电设备中的电阻Rd，从而在没有受电设备中的电阻Rd的情况下，E-marker830也能够输出1.2V电压，因此，就需要在E-marker830的输入输出电路831中额外引入新的电阻，使用该新的电阻补偿受电设备中的电阻Rd，因此，图8所示的CCIN引脚的输出电路中，还设置有比较器COMP1构成的支路，以及开关K3和电阻Rd2构成的支路。比较器COMP1构成的支路用于检测受电设备是否接入，将检测结果通过第一输出端84输出至控制器832。控制器832在根据检测结果确定受电设备接入时，也即在上述情况一时，发送控制信号控制开关K3关断，开关K3所在支路不起作用。对于情况二，控制器832在根据检测结果确定受电设备未接入时，发送控制信号控制开关K3导通，此时，在第一电压信号为低电平信号时，开关K2关断，开关K2所在支路不起作用，开关K1导通，开关K3导通，开关K1所在支路和开关K3所在支路并联，由于开关K1所在支路无电阻，因此，虽然开关K3导通，但是，第一端81输出低电平信号；在第一电压信号为高电平信号时，开关K1关断，开关K1所在支路不起作用，开关K2和开关K3均导通，开关K2所在支路和开关K3所在支路并联，也即电阻Rd1和电阻Rd2并联，在电阻Rd2等于电阻Rd的情况下，电阻Rd1和电阻Rd2的并联电阻对供电设备810中的电源电压端VDD的电压进行分压也可以得到1.2V电压，也即第一端81输出1.2V电压，也即输出高电平信号。基于图8所示的输入输出电路831结构，如果充电线缆过长，例如超过2m，会导致CC通信线到地的线缆寄生电容C1过大，而每次通信信号从低电平信号变为高电平信号时需要对线缆寄生电容C1充电，这一充电过程会导致通信信号的上边沿变化缓慢，进而使得通信信号的传输时延大，供电设备810与E-marker830之间的通信不稳定，进而影响充电效率或者充电安全性。虽然在上述图4B和图4C中使用了2个E-marker解决了该问题，但是，设置2个E-marker会导致充电线缆的成本增加。为此，本申请提出一种电子标签芯片中通信引脚的输出电路和芯片，能够使得电子标签芯片在应用于较长的充电线缆时，仍然能够保证电子标签芯片与供电设备之间通信的稳定性，提高充电效率和安全性。使用本申请输出电路的E-marker，既能够应用于较短的充电线缆例如线长2m以内的充电线缆，也可以应用于较长的充电线缆例如线长2m以上的充电线缆，而且充电线缆上仅需设置1个E-marker，无需设置2个E-marker即可以保证电子标签芯片与供电设备之间通信的稳定性。以下实施例中以通信引脚是E-marker的CCIN引脚为例。图9为本申请E-marker中CCIN引脚的输出电路结构示意图。为了便于理解和说明，在图9中，示出了充电线缆的CC通信线、以及充电线缆连接的供电设备910和受电设备920，E-marker930的CCIN引脚连接至充电线缆的CC通信线。如图9所示，该输出电路931包括：第一开关S1和稳压器REG；其中，第一开关S1的控制端作为输出电路931的第一输入端IN1，用于接收第一电压信号，第一电压信号是E-marker930的控制器932基于所需输出的通信数据生成的电压信号。上述通信数据可以包括但不限于：E-marker930所属充电线缆的线缆信息。第一开关S1的第一端作为输出电路931的第一输出端OUT1，输出电路931的第一输出端OUT1用于连接通信引脚，例如图9中E-marker930的CCIN引脚；第一开关S1的第二端连接稳压器REG的输出端，稳压器REG的输入端连接预设电压端V1以接收第一供电电压，稳压器REG的输出端用于输出预设第一电压。其中，稳压器REG可以通过LDO实现。其中，预设电压端V1也可以由E-marker中作为电源接收端的引脚VCONN1或者引脚VCONN2供电。具体的，如果作为电源接收端的引脚VCONN1或者引脚VCONN2接收到的供电电压位于稳压器REG输入端的可输入电压范围内，则预设电压端V1可以是作为电源端的引脚VCONN1或者引脚VCONN2，也即稳压器REG的输入端连接作为电源接收端的引脚VCONN1或者引脚VCONN2；如果作为电源接收端的引脚VCONN1或者引脚VCONN2接收到的供电电压大于稳压器REG输入端支持的最大输入电压，则可以对作为电源接收端的引脚VCONN1或者引脚VCONN2的供电电压进行分压得到电压为第一供电电压的预设电压端V1，第一供电电压位于稳压器REG输入端的可输入电压范围内。对作为电源接收端的引脚VCONN1或者引脚VCONN2接收到的供电电压进行分压的具体实现方式本申请不作限定，例如可以将作为电源接收端的引脚VCONN1或者引脚VCONN2通过串联的两个电阻接地，两个电阻相互连接的一端作为预设电压端，通过选择合适阻值的两个电阻，预设电压端可以得到上述的第一供电电压。基于前述描述，E-marker930的CCIN引脚输出的通信信号的高电平一般为1.2V，因此，在一种可能的实现方式中，上述稳压器REG连接的预设电压端可以用于提供1.8V电压，稳压器REG的输出端输出的预设第一电压可以是1.2V，考虑实际电路中开关等器件的电压损耗，预设第一电压可以稍高于1.2V，例如1.25V。通过第一开关S1和稳压器REG构成的第一支路，可以在第一电压信号为高电平时，使得输出电路931的第一输出端输出高电平信号，例如前述举例的1.2V电压信号。为了使得输出电路931可以输出低电平信号，例如0V的电压信号，从而实现通信数据的输出，参见图9所示，该输出电路931还可以包括：反相器U1和第二开关S2；其中，反相器U1的输入端连接所述输出电路的第一输入端IN1，用于接收第一电压信号；反相器U1的输出端连接第二开关S2的控制端，第二开关S2的第一端接地，第二端连接输出电路的第一输出端OUT1。图10示出了第一电压信号和图9中CCIN引脚输出的通信信号的波形示意图，结合图9所示的输出电路931，在第一电压信号为低电平时，反相器U1和第二开关S2构成的第二支路可以使得输出电路931的第一输出端输出0V的电压信号，也即E-marker930的CCIN引脚输出的通信信号为低电平信号；在第一电压信号为高电平信号时，第一开关S1和稳压器REG所在支路导通，由于稳压器REG输出稳定的第一电压，也即高电平信号，因此，可以保证输出电路931的第一输出端OUT1输出稳定的高电平信号，也即E-marker930的CCIN引脚输出的通信信号为稳定的高电平信号。由于E-marker930的CCIN引脚输出高电平信号是由稳压器REG驱动的，并非通过对芯片的工作电压分压得到，因此，受电设备920是否接入对CCIN引脚输出的高电平信号没有影响，充电线缆的寄生电容对CCIN引脚输出的高电平信号也没有影响。因此，参见图10可知，相对于图8中CCIN引脚输出的通信信号，图9中CCIN引脚输出的通信信号可以更快速的从低电平信号转换为高电平信号，也即图8中CCIN引脚输出通信信号的上升沿电压升高较慢，而图9中CCIN引脚输出通信信号的上升沿电压升高较快。由于充电线缆的寄生电容对E-marker930的CCIN引脚输出的高电平信号没有影响，因此，充电线缆的长度对图9所示E-marker930的CCIN引脚输出的高电平信号没有影响，从而设置有该输出电路931的E-marker930可以适用于各种长度的充电线缆，且充电线缆上仅需设置1个E-marker，无需设置2个E-marker既可以保证E-marker与供电设备之间通信的稳定性，提高充电效率和安全性，又可以降低2m以上充电线缆的成本。由于受电设备是否接入对E-marker的CCIN引脚输出高电平信号没有影响，因此，CCIN引脚的输出电路中无需设置例如图8中由比较器COMP1构成的用于检测受电设备是否接入的支路、电阻Rd2和第三开关K3构成的用于电阻补偿的支路，降低了CCIN引脚的输出电路的结构复杂度。区别于图9所示的输出电路，为了防止电路的驱动能力过强，可以在上述第一支路和第二支路上可以分别增加一电阻，例如图11所示：第一开关S1的第一端可以连接第一电阻R1的第一端，第一电阻R1的第二端作为输出电路的第一输出端OUT1；第二开关S2的第二端可以连接第二电阻R2的第一端，第二电阻R2的第二端连接输出电路的第一输出端OUT1。在一种可能的实现方式中，如图12所示，第一开关S1可以包括：第一NMOS管N1，其中，第一NMOS管N1的栅极作为第一开关S1的控制端，源极作为第一开关S1的第一端，漏极作为第一开关S1的第二端。在另一种可能的实现方式中，如图13所示，第一开关S1可以包括：第二NMOS管N2和第三NMOS管N3；其中，第二NMOS管N2的栅极以及第三NMOS管N3的栅极作为第一开关S1的控制端；第二NMOS管N2的源极作为第一开关S1的第二端，漏极连接第三NMOS管N3的漏极；第三NMOS管N3的源极作为第一开关S1的第一端。在图13中，示出了第二NMOS管N2的体二极管D2，第三NMOS管N3的体二极管D3，基于图13所示的电路第一开关S1的结构，通过设置背靠背的第二NMOS管N2和第三NMOS管N3，可以防止CC通信线上的电压通过NMOS管的寄生体二极管反灌到稳压器REG的输出，导致总线电压不稳定。在一种可能的实现方式中，如图12和图13所示，第二开关S2可以包括：第四NMOS管N4，其中，第四NMOS管N4的栅极作为第二开关S2的控制端，源极作为第二开关S2的第一端，漏极作为第二开关S2的第二端。图12～图13中以第一开关和第二开关通过NMOS管实现为例，需要说明的是，构成上述第一开关和/或第二开关的NMOS管也可以替换为PMOS管。以图12中第一开关S1和第二开关S2均通过PMOS管实现为例，参见图14所示：第一开关S1可以包括：第一PMOS管P1，第一PMOS管P1的栅极作为第一开关S1的控制端，漏极作为第一开关S1的第一端，源极作为第一开关S1的第二端；第二开关S2可以包括：第四PMOS管P4，第四PMOS管P4的栅极作为第二开关S2的控制端，漏极作为第二开关S2的第一端，源极作为第二开关S2的第二端。以图13中第一开关S1通过PMOS管实现为例，参见图15所示：第一开关S1可以包括：第二PMOS管P2和第三PMOS管P3；其中，第二PMOS管P2的栅极以及第三PMOS管P3的栅极作为第一开关S1的控制端；第二PMOS管P2的漏极作为第一开关S1的第二端，源极连接第三PMOS管P3的源极；第三PMOS管P3的漏极作为第一开关S1的第一端。本申请实施例中，“至少一个”是指一个或者多个，“多个”是指两个或两个以上。“和/或”，描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B，可以表示单独存在A、同时存在A和B、单独存在B的情况。其中A，B可以是单数或者复数。字符“/”一般表示前后关联对象是一种“或”的关系。“以下至少一项”及其类似表达，是指的这些项中的任意组合，包括单项或复数项的任意组合。例如，a，b和c中的至少一项可以表示：a，b，c，a和b，a和c，b和c或a和b和c，其中a，b，c可以是单个，也可以是多个。本领域普通技术人员可以意识到，本文中公开的实施例中描述的各单元及算法步骤，能够以电子硬件、计算机软件和电子硬件的结合来实现。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本申请的范围。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的系统、装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在本申请所提供的几个实施例中，任一功能如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本申请各个实施例所述方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上所述，仅为本申请的具体实施方式，任何熟悉本技术领域的技术人员在本申请揭露的技术范围内，可轻易想到变化或替换，都应涵盖在本申请的保护范围之内。本申请的保护范围应以所述权利要求的保护范围为准。
