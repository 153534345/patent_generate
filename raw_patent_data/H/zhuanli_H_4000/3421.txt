标题title
一种基于区块链技术的数据溯源与加密的方法与系统
摘要abst
本发明公开一种基于区块链技术的数据溯源与加密的方法，通过物联网设备从环境中收集数据信息并将数据传递给网关节点和/或用户节点进行数据的第一数据处理，作为进行区块链存储的可溯源数据的来源；对经过所述第一数据处理后的数据执行第二数据处理，其中，所述第二数据处理判断数据是否为外部可追溯数据，并对数据进行分类，将数据分为外部可追溯数据和内部可追溯数据；判断获取的数据属于是否属于外部可追溯数据，当用户需要对存储的信息进行溯源追踪时，通过认证后获取第三方服务器中与身份认证权限相对应的秘钥，再从区块上获取加密的密文溯源数据。
权利要求书clms
1.一种基于区块链技术的数据溯源与加密的方法，其特征在于，所述方法包括如下步骤：步骤1，通过物联网设备从环境中收集数据信息并将数据传递给网关节点和/或用户节点进行数据的第一数据处理，作为进行区块链存储的可溯源数据的来源；步骤2，对经过所述第一数据处理后的数据执行第二数据处理，其中，所述第二数据处理判断数据是否为外部可追溯数据，并对数据进行分类，将数据分为外部可追溯数据和内部可追溯数据；步骤3，判断获取的数据属于是否属于外部可追溯数据，若属于所述外部可追溯数据，则直接上传至区块链进行存储，对于其余数据继续判断是否属于外部可追溯数据，若判断属于内部可追溯数据，则对判断为内部可追溯数据的数据先进行数据加密并加密信息存储于第三方服务器，然后再将加密后的密文信息上传至区块链，其中，所述加密信息为该数据对应的加密算法及解密秘钥；步骤4，当用户需要对存储的信息进行溯源追踪时，通过认证后获取第三方服务器中与身份认证权限相对应的秘钥，再从区块上获取加密的密文溯源数据。2.如权利要求1所述的一种基于区块链技术的数据溯源与加密的方法，其特征在于，所述步骤4进一步包括：对用户的身份信息认证，在用户身份认证通过后，判断所述用户的身份对应的权限，若判断所述用户仅允许查询外部可追溯数据，则不对其开放第三方服务器，若判断所述用户为内部可追溯数据的查询权限所有者则进行所述第三方服务器的第二次认证；每个用户身份在所述第三方服务器中对应一个加密算法，在进行所述第二次认证时，所述第三方服务器向用户节点发送采用该用户对应的加密算法进行加密的密文信息和加密秘钥，用户采用对应的加密算法进行解密，再将解密后的明文信息发送回第三方服务器，若信息正确则通过第二次认证；在用户通过认证后，发送解密秘钥和加密后的密文信息至该用户的用户节点。3.如权利要求1所述的一种基于区块链技术的数据溯源与加密的方法，其特征在于，所述第一数据处理包括数据预处理，并统一采集到的数据的格式。4.如权利要求1所述的一种基于区块链技术的数据溯源与加密的方法，其特征在于，所述物联网设备为数据采集设备，包括传感器、RFID标签、读写器。5.权利要求1所述的一种基于区块链技术的数据溯源与加密的方法，其特征在于，所述步骤3中的直接上传至区块链进行存储进一步包括：步骤301，区块链中的各节点服务层将可追溯数据的存证请求发送给验证节点，所述验证节点验证通过后,将可追溯数据的存证信息打包成新区块,向其他节点广播,并且自己也保存这个新区块；步骤302，区块链中的其他所有节点在收到新区块后,首先进行数据校验，其中，所述数据校验包括校验是否含有可追溯数据的有效签名；步骤303，任一节点在验证数据正确之后,将新区块暂存在自己的磁盘中,然后广播验证状态至其他节点；步骤304，所有节点都统计其他节点广播的验证状态,当验证状态的统计结果超过全部节点数量的一半时,节点将新区块数据写入到自己维护的区块链中,并反馈可追溯信息存储成功。6.一种基于区块链技术的数据溯源与加密的系统，其特征在于，所述系统包括如下模块：数据采集模块，通过物联网设备从环境中收集数据信息并将数据传递给网关节点和/或用户节点进行数据的第一数据处理，作为进行区块链存储的可溯源数据的来源，其中所述物联网设备为数据采集设备，包括传感器、RFID标签、读写器；数据分类模块，对经过所述第一数据处理后的数据执行第二数据处理，其中，所述第二数据处理判断数据是否为外部可追溯数据，并对数据进行分类，将数据分为外部可追溯数据和内部可追溯数据；数据存储模块，判断获取的数据属于是否属于外部可追溯数据，若属于所述外部可追溯数据，则直接上传至区块链进行存储，对于其余数据继续判断是否属于外部可追溯数据，若判断属于内部可追溯数据，则对判断为内部可追溯数据的数据先进行数据加密并加密信息存储于第三方服务器，然后再将加密后的密文信息上传至区块链，其中，所述加密信息为该数据对应的加密算法及解密秘钥；身份认证模块，当用户需要对存储的信息进行溯源追踪时，对用户的身份信息认证，在用户身份认证通过后，判断所述用户的身份对应的权限，若判断所述用户仅允许查询外部可追溯数据，则不对其开放第三方服务器，若判断所述用户为内部可追溯数据的查询权限所有者则进行所述第三方服务器的第二次认证；每个用户身份在所述第三方服务器中对应一个加密算法，在进行所述第二次认证时，所述第三方服务器向用户节点发送采用该用户对应的加密算法进行加密的密文信息和加密秘钥，用户采用对应的加密算法进行解密，再将解密后的明文信息发送回第三方服务器，若信息正确则通过第二次认证；数据查询模块，在用户通过认证后，发送解密秘钥和加密后的密文信息至该用户的用户节点。7.一种电子系统，其特征在于，包括存储器和处理器，所述存储器上存储有计算机程序，该计算机程序被所述处理器执行时，执行如权利要求1至5中任意一项中的基于区块链技术的数据溯源与加密的方法。8.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中包括实时风险控制程序，该实时风险控制程序被处理器执行时实现如权利要求1至5中任意一项所述的基于区块链技术的数据溯源与加密的方法的步骤。
说明书desc
技术领域本发明涉及区块链的技术领域，尤其涉及一种基于区块链技术的数据溯源与加密的方法与系统。背景技术区块链是一种由互不相信的节点维护同一个全局状态的数据库。区块链不同于普通数据库，有着自身的特性。首先，区块链存储数据时使用的是P2P网络，不存在中心化的管理机构，所有节点有着均等的权利和义务，因此区块链具有去中心化的特性。第二，区块链采用基于协商一致的协议，系统中所有节点无需信任就可以进行自由安全的数据交换，避免人为干预，因此区块链具有无需信任背书的特性。另外，信息添加至区块链后，除非能够控制大部分节点，否则无法修改，因此区块链具有数据防篡改的特性。基于以上特性，区块链适用于存储金融数据和医疗数据等需要较高安全性的数据。然而，现有的通过区块链进行可追溯的数据存储的方式，并不能区分何种数据适合上链存储，而何种数据不适合公开。发明内容本发明旨在至少解决现有技术中存在的技术问题之一。为此，本发明公开一种基于区块链技术的数据溯源与加密的方法，所述方法包括如下步骤：步骤1，通过物联网设备从环境中收集数据信息并将数据传递给网关节点和/或用户节点进行数据的第一数据处理，作为进行区块链存储的可溯源数据的来源；步骤2，对经过所述第一数据处理后的数据执行第二数据处理，其中，所述第二数据处理判断数据是否为外部可追溯数据，并对数据进行分类，将数据分为外部可追溯数据和内部可追溯数据；步骤3，判断获取的数据属于是否属于外部可追溯数据，若属于所述外部可追溯数据，则直接上传至区块链进行存储，对于其余数据继续判断是否属于外部可追溯数据，若判断属于内部可追溯数据，则对判断为内部可追溯数据的数据先进行数据加密并加密信息存储于第三方服务器，然后再将加密后的密文信息上传至区块链，其中，所述加密信息为该数据对应的加密算法及解密秘钥；步骤4，当用户需要对存储的信息进行溯源追踪时，通过认证后获取第三方服务器中与身份认证权限相对应的秘钥，再从区块上获取加密的密文溯源数据。更进一步地，所述步骤4进一步包括：对用户的身份信息认证，在用户身份认证通过后，判断所述用户的身份对应的权限，若判断所述用户仅允许查询外部可追溯数据，则不对其开放第三方服务器，若判断所述用户为内部可追溯数据的查询权限所有者则进行所述第三方服务器的第二次认证；每个用户身份在所述第三方服务器中对应一个加密算法，在进行所述第二次认证时，所述第三方服务器向用户节点发送采用该用户对应的加密算法进行加密的密文信息和加密秘钥，用户采用对应的加密算法进行解密，再将解密后的明文信息发送回第三方服务器，若信息正确则通过第二次认证；在用户通过认证后，发送解密秘钥和加密后的密文信息至该用户的用户节点。更进一步地，所述第一数据处理包括数据预处理，并统一采集到的数据的格式。更进一步地，所述物联网设备为数据采集设备，包括传感器、RFID标签、读写器。更进一步地，所述步骤3中的直接上传至区块链进行存储进一步包括：步骤301，区块链中的各节点服务层将可追溯数据的存证请求发送给验证节点，所述验证节点验证通过后,将可追溯数据的存证信息打包成新区块,向其他节点广播,并且自己也保存这个新区块；步骤302，区块链中的其他所有节点在收到新区块后,首先进行数据校验，其中，所述数据校验包括校验是否含有可追溯数据的有效签名；步骤303，任一节点在验证数据正确之后,将新区块暂存在自己的磁盘中,然后广播验证状态至其他节点；步骤304，所有节点都统计其他节点广播的验证状态,当验证状态的统计结果超过全部节点数量的一半时,节点将新区块数据写入到自己维护的区块链中,并反馈可追溯信息存储成功。本发明还公开了一种基于区块链技术的数据溯源与加密的系统，所述系统包括如下模块：数据采集模块，通过物联网设备从环境中收集数据信息并将数据传递给网关节点和/或用户节点进行数据的第一数据处理，作为进行区块链存储的可溯源数据的来源，其中所述物联网设备为数据采集设备，包括传感器、RFID标签、读写器；数据分类模块，对经过所述第一数据处理后的数据执行第二数据处理，其中，所述第二数据处理判断数据是否为外部可追溯数据，并对数据进行分类，将数据分为外部可追溯数据和内部可追溯数据；数据存储模块，判断获取的数据属于是否属于外部可追溯数据，若属于所述外部可追溯数据，则直接上传至区块链进行存储，对于其余数据继续判断是否属于外部可追溯数据，若判断属于内部可追溯数据，则对判断为内部可追溯数据的数据先进行数据加密并加密信息存储于第三方服务器，然后再将加密后的密文信息上传至区块链，其中，所述加密信息为该数据对应的加密算法及解密秘钥；身份认证模块，当用户需要对存储的信息进行溯源追踪时，对用户的身份信息认证，在用户身份认证通过后，判断所述用户的身份对应的权限，若判断所述用户仅允许查询外部可追溯数据，则不对其开放第三方服务器，若判断所述用户为内部可追溯数据的查询权限所有者则进行所述第三方服务器的第二次认证；每个用户身份在所述第三方服务器中对应一个加密算法，在进行所述第二次认证时，所述第三方服务器向用户节点发送采用该用户对应的加密算法进行加密的密文信息和加密秘钥，用户采用对应的加密算法进行解密，再将解密后的明文信息发送回第三方服务器，若信息正确则通过第二次认证；数据查询模块，在用户通过认证后，发送解密秘钥和加密后的密文信息至该用户的用户节点。更进一步地，本发明还公开了一种电子系统，包括存储器和处理器，所述存储器上存储有计算机程序，该计算机程序被所述处理器执行时，执行如上所述的基于区块链技术的数据溯源与加密的方法。更进一步地，本发明还公开了一种计算机可读存储介质，所述计算机可读存储介质中包括实时风险控制程序，该实时风险控制程序被处理器执行时实现如上所述的基于区块链技术的数据溯源与加密的方法的步骤。本发明与现有技术相比，本发明的有益效果是：①将采集的数据进行了格式统一的数据处理，然后将数据进行区分，以防止内部数据在公共区块上进行存储；②现有技术中一般采用全部密文或者明文上链可追溯存储，而本申请是对数据进行区分后，部分数据明文存储于区块链，部分密文存储于区块链；③对于密文存储部分，因为加密信息是中心化存储的缘故，设计双重认证的方式校验用户身份，并且一个身份仅对应一个加密算法，通过校验加密算法的方式判断用户的身份是否正确；相比于现有技术的验证方式，验证加密算法可以更快的实现身份认证的过程。附图说明从以下结合附图的描述可以进一步理解本发明。图中的部件不一定按比例绘制，而是将重点放在示出实施例的原理上。在图中，在不同的视图中，相同的附图标记指定对应的部分。图1是本发明的一种基于区块链技术的数据溯源与加密的方法的流程图。具体实施方式下面将结合附图及实施例对本发明的技术方案进行更详细的说明。现在将参考附图描述实现本发明各个实施例的移动终端。在后续的描述中，使用用于表示元件的诸如“模块”、“部件”或“单元”的后缀仅为了有利于本发明的说明，其本身并没有特定的意义。因此，"模块"与"部件"可以混合地使用。移动终端可以以各种形式来实施。例如，本发明中描述的终端可以包括诸如移动电话、智能电话、笔记本电脑、数字广播接收器、PDA、PAD、PMP、导航装置等等的移动终端以及诸如数字TV、台式计算机等等的固定终端。下面，假设终端是移动终端。然而，本领域技术人员将理解的是，除了特别用于移动目的的元件之外，根据本发明的实施方式的构造也能够应用于固定类型的终端。溯源信息可以是食品卫生溯源、物流传输溯源等，这里不再一一举例。如图1所示的一种基于区块链技术的数据溯源与加密的方法，所述方法包括如下步骤：步骤1，通过物联网设备从环境中收集数据信息并将数据传递给网关节点和/或用户节点进行数据的第一数据处理，作为进行区块链存储的可溯源数据的来源；步骤2，对经过所述第一数据处理后的数据执行第二数据处理，其中，所述第二数据处理判断数据是否为外部可追溯数据，并对数据进行分类，将数据分为外部可追溯数据和内部可追溯数据；步骤3，判断获取的数据属于是否属于外部可追溯数据，若属于所述外部可追溯数据，则直接上传至区块链进行存储，对于其余数据继续判断是否属于外部可追溯数据，若判断属于内部可追溯数据，则对判断为内部可追溯数据的数据先进行数据加密并加密信息存储于第三方服务器，然后再将加密后的密文信息上传至区块链，其中，所述加密信息为该数据对应的加密算法及解密秘钥；步骤4，当用户需要对存储的信息进行溯源追踪时，通过认证后获取第三方服务器中与身份认证权限相对应的秘钥，再从区块上获取加密的密文溯源数据。更进一步地，所述步骤4进一步包括：对用户的身份信息认证，在用户身份认证通过后，判断所述用户的身份对应的权限，若判断所述用户仅允许查询外部可追溯数据，则不对其开放第三方服务器，若判断所述用户为内部可追溯数据的查询权限所有者则进行所述第三方服务器的第二次认证；每个用户身份在所述第三方服务器中对应一个加密算法，在进行所述第二次认证时，所述第三方服务器向用户节点发送采用该用户对应的加密算法进行加密的密文信息和加密秘钥，用户采用对应的加密算法进行解密，再将解密后的明文信息发送回第三方服务器，若信息正确则通过第二次认证；在用户通过认证后，发送解密秘钥和加密后的密文信息至该用户的用户节点。更进一步地，所述第一数据处理包括数据预处理，并统一采集到的数据的格式。更进一步地，所述物联网设备为数据采集设备，包括传感器、RFID标签、读写器。更进一步地，所述步骤3中的直接上传至区块链进行存储进一步包括：步骤301，区块链中的各节点服务层将可追溯数据的存证请求发送给验证节点，所述验证节点验证通过后,将可追溯数据的存证信息打包成新区块,向其他节点广播,并且自己也保存这个新区块；步骤302，区块链中的其他所有节点在收到新区块后,首先进行数据校验，其中，所述数据校验包括校验是否含有可追溯数据的有效签名；步骤303，任一节点在验证数据正确之后,将新区块暂存在自己的磁盘中,然后广播验证状态至其他节点；步骤304，所有节点都统计其他节点广播的验证状态,当验证状态的统计结果超过全部节点数量的一半时,节点将新区块数据写入到自己维护的区块链中,并反馈可追溯信息存储成功。本发明还公开了一种基于区块链技术的数据溯源与加密的系统，所述系统包括如下模块：数据采集模块，通过物联网设备从环境中收集数据信息并将数据传递给网关节点和/或用户节点进行数据的第一数据处理，作为进行区块链存储的可溯源数据的来源，其中所述物联网设备为数据采集设备，包括传感器、RFID标签、读写器；数据分类模块，对经过所述第一数据处理后的数据执行第二数据处理，其中，所述第二数据处理判断数据是否为外部可追溯数据，并对数据进行分类，将数据分为外部可追溯数据和内部可追溯数据；数据存储模块，判断获取的数据属于是否属于外部可追溯数据，若属于所述外部可追溯数据，则直接上传至区块链进行存储，对于其余数据继续判断是否属于外部可追溯数据，若判断属于内部可追溯数据，则对判断为内部可追溯数据的数据先进行数据加密并加密信息存储于第三方服务器，然后再将加密后的密文信息上传至区块链，其中，所述加密信息为该数据对应的加密算法及解密秘钥；身份认证模块，当用户需要对存储的信息进行溯源追踪时，对用户的身份信息认证，在用户身份认证通过后，判断所述用户的身份对应的权限，若判断所述用户仅允许查询外部可追溯数据，则不对其开放第三方服务器，若判断所述用户为内部可追溯数据的查询权限所有者则进行所述第三方服务器的第二次认证；每个用户身份在所述第三方服务器中对应一个加密算法，在进行所述第二次认证时，所述第三方服务器向用户节点发送采用该用户对应的加密算法进行加密的密文信息和加密秘钥，用户采用对应的加密算法进行解密，再将解密后的明文信息发送回第三方服务器，若信息正确则通过第二次认证；数据查询模块，在用户通过认证后，发送解密秘钥和加密后的密文信息至该用户的用户节点。更进一步地，本发明还公开了一种电子系统，包括存储器和处理器，所述存储器上存储有计算机程序，该计算机程序被所述处理器执行时，执行如上所述的基于区块链技术的数据溯源与加密的方法。更进一步地，本发明还公开了一种计算机可读存储介质，所述计算机可读存储介质中包括实时风险控制程序，该实时风险控制程序被处理器执行时实现如上所述的基于区块链技术的数据溯源与加密的方法的步骤。在本实施例中，以原料供应的信息作为可追溯信息进行举例，原料供应商是供应环节的上游企业，通过物流运输将所需销售的原料卖给制造商，一个供应商可以将多种不同的原料提供给多个制造商。原料供应商首先在溯源数据信息流中提供公司的企业信息和原料详细信息。进而将所拥有原料交易给所需的制造商，并记录将原料所提供给的制造商信息，同时还要提供相应的交易订单辅助信息，通过加密存储在供应环节进行记录，并进行访问权限设置，进行交易数据信息的共享，最后选择合作的运输商进行原料的物流运输。在本实施例中，数据的采集环节可以是通过物联网设备，其用于从环境中收集数据信息并将数据传递给网关节点或用户节点进行处理，作为区块链数据的来源；而区块链网络由geth客户端共同搭建，用于存储溯源数据并提供基本的溯源数据查询服务，区块链节点参与、维护区块链，负责区块数据的生成、存储并为区块链网络提供所需的计算。还需要说明的是，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、商品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、商品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、商品或者设备中还存在另外的相同要素。本领域技术人员应明白，本申请的实施例可提供为方法、系统或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。虽然上面已经参考各种实施例描述了本发明，但是应当理解，在不脱离本发明的范围的情况下，可以进行许多改变和修改。因此，其旨在上述详细描述被认为是例示性的而非限制性的，并且应当理解，以下权利要求旨在限定本发明的精神和范围。以上这些实施例应理解为仅用于说明本发明而不用于限制本发明的保护范围。在阅读了本发明的记载的内容之后，技术人员可以对本发明作各种改动或修改，这些等效变化和修饰同样落入本发明权利要求所限定的范围。
