标题title
消息传输方法、装置、程序产品、介质及电子设备
摘要abst
本申请的实施例提供了一种消息传输方法、装置、程序产品、介质及电子设备，涉及通信技术领域。该方法包括：接收由目标客户端发出的第一消息，所述第一消息的消息格式为Socket格式；基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，所述目标服务端为所述目标客户端发送所述第一消息的目的地；将所述第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。本申请实施例的技术方案可以精简通信链路，降低对通信资源的消耗。
权利要求书clms
1.一种消息传输方法，其特征在于，所述方法包括：接收由目标客户端发出的第一消息，所述第一消息的消息格式为Socket格式；基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，所述目标服务端为所述目标客户端发送所述第一消息的目的地；将所述第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。2.根据权利要求1所述的方法，其特征在于，在接收由目标客户端发出的第一消息之前，所述方法还包括：接收由网关截取并转发的所述目标客户端向服务端发出的连接请求，所述连接请求为所述目标客户端首次向服务端发出的第一消息；响应于所述连接请求，按照长连接协议，通过所述网关建立与所述目标客户端之间的第一通信链路，所述第一通信链路用于在与所述目标客户端之间传输消息。3.根据权利要求2所述的方法，其特征在于，在接收由网关截取并转发的所述目标客户端向服务端发出的连接请求之后，所述方法还包括：获取关联记录，所述关联记录中保存有多个客户端的客户端网络地址与多个服务端的服务端网络地址之间的关联关系；根据所述关联记录，从多个服务端中为所述目标客户端分配一个服务端，作为目标服务端；建立所述目标客户端的客户端网络地址与所述目标服务端的服务端网络地址之间的目标关联关系，并将所述目标关联关系保存至关联记录中，所述目标关联关系用于所述目标客户端与所述目标服务端在通信过程中相互关联。4.根据权利要求3所述的方法，其特征在于，所述根据所述关联记录，从多个服务端中为所述目标客户端分配一个服务端，包括：根据所述关联记录，分别确定各个服务端与客户端的关联次数；从多个服务端中为所述目标客户端分配一个关联次数最少的服务端。5.根据权利要求3所述的方法，其特征在于，所述接收由目标客户端发出的第一消息，包括：在所述目标客户端向目标服务端发出第一消息时，通过网关判断所述第一消息是否属于长连接协议；如果所述第一消息属于长连接协议，则通过所述第一通信链路接收由网关截取并转发的所述目标客户端向所述目标服务端发出的第一消息。6.根据权利要求3所述的方法，其特征在于，所述基于所述第一消息确定目标服务端，包括：从所述第一消息中确定所述目标客户端的客户端网络地址；从所述关联记录中查询与所述目标客户端的客户端网络地址相关联的服务端网络地址，以在多个服务端中确定所述目标服务端。7.根据权利要求1所述的方法，其特征在于，在将所述第一消息投递至与所述目标服务端相对应的消息队列中之前，所述方法还包括：接收由各个服务端发送的第二通信链路注册请求，所述各个服务端中包括所述目标服务端；响应于所述第二通信链路注册请求，建立与各个服务端之间的第二通信链路，所述第二通信链路中包括消息队列。8.根据权利要求7所述的方法，其特征在于，所述将所述第一消息投递至与所述目标服务端相对应的消息队列中，包括：查询与所述目标服务端建立的第二通信链路，作为目标通信链路；将所述第一消息投递至所述目标通信链路中的消息队列中。9.根据权利要求2所述的方法，其特征在于，所述方法还包括：从与所述目标服务端相对应的消息队列中读取由所述目标服务端投递的第二消息，所述第二消息的消息格式为MQ格式；基于所述第二消息确定目标客户端，并将所述第二消息的消息格式由MQ格式转换为Socket格式；通过所述第一通信链路将所述第二消息发送至所述目标客户端。10.一种电子设备，其特征在于，所述电子设备包括一个或多个处理器和一个或多个存储器，所述一个或多个存储器中存储有至少一条程序代码，所述至少一条程序代码由所述一个或多个处理器加载并执行以实现如权利要求1至9任一项所述的消息传输方法所执行的操作。
说明书desc
技术领域本申请涉及通信技术领域，具体而言，涉及一种消息传输方法、装置、程序产品、介质及电子设备。背景技术目前，在客户端与服务端之间进行消息传输的场景下，通常是按照长连接协议建立客户端与服务端之间的通信链路，该通信链路中需要包括网关，核心路由器，分布式路由器等设备，可见，现有方案中用于消息传输的通信链路较为复杂。在存在大规模客户端与服务端进行消息传输的需求下，特别是在云场景下的大规模客户端与服务端进行消息传输，现有方案无疑会带来通信资源耗费大的问题。基于此，如何精简通信链路，降低对通信资源的消耗是亟待解决的技术问题。发明内容本申请的实施例提供了一种消息传输方法、装置、程序产品、介质及电子设备、计算机程序产品或计算机程序、计算机可读介质及电子设备，进而至少在一定程度上可以精简通信链路，降低对通信资源的消耗。本申请的其它特性和优点将通过下面的详细描述变得显然，或部分地通过本申请的实践而习得。根据本申请实施例的一个方面，提供了一种消息传输方法，所述方法包括：接收由目标客户端发出的第一消息，所述第一消息的消息格式为Socket格式；基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，所述目标服务端为所述目标客户端发送所述第一消息的目的地；将所述第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。在本申请的一些实施例中，基于前述方案，在接收由目标客户端发出的第一消息之前，所述方法还包括：按照长连接协议，建立与所述目标客户端之间的第一通信链路，所述第一通信链路用于在与所述目标客户端之间传输消息。在本申请的一些实施例中，基于前述方案，所述按照长连接协议，建立与所述目标客户端之间的第一通信链路，包括：接收由网关截取并转发的所述目标客户端向服务端发出的连接请求，所述连接请求为所述目标客户端首次向服务端发出的第一消息；响应于所述连接请求，按照长连接协议，通过所述网关建立与所述目标客户端之间的第一通信链路。在本申请的一些实施例中，基于前述方案，在接收由网关截取并转发的所述目标客户端向服务端发出的连接请求之后，所述方法还包括：获取关联记录，所述关联记录中保存有多个客户端的客户端网络地址与多个服务端的服务端网络地址之间的关联关系；根据所述关联记录，从多个服务端中为所述目标客户端分配一个服务端，作为目标服务端；建立所述目标客户端的客户端网络地址与所述目标服务端的服务端网络地址之间的目标关联关系，并将所述目标关联关系保存至关联记录中，所述目标关联关系用于所述目标客户端与所述目标服务端在通信过程中相互关联。在本申请的一些实施例中，基于前述方案，所述根据所述关联记录，从多个服务端中为所述目标客户端分配一个服务端，包括：根据所述关联记录，分别确定各个服务端与客户端的关联次数；从多个服务端中为所述目标客户端分配一个关联次数最少的服务端。在本申请的一些实施例中，基于前述方案，所述接收由目标客户端发出的第一消息，包括：在所述目标客户端向目标服务端发出第一消息时，通过网关判断所述第一消息是否属于长连接协议；如果所述第一消息属于长连接协议，则通过所述第一通信链路接收由网关截取并转发的所述目标客户端向所述目标服务端发出的第一消息。在本申请的一些实施例中，基于前述方案，所述基于所述第一消息确定目标服务端，包括：从所述第一消息中确定所述目标客户端的客户端网络地址；从所述关联记录中查询与所述目标客户端的客户端网络地址相关联的服务端网络地址，以在多个服务端中确定所述目标服务端。在本申请的一些实施例中，基于前述方案，在将所述第一消息投递至与所述目标服务端相对应的消息队列中之前，所述方法还包括：接收由各个服务端发送的第二通信链路注册请求，所述各个服务端中包括所述目标服务端；响应于所述第二通信链路注册请求，建立与各个服务端之间的第二通信链路，所述第二通信链路中包括消息队列。在本申请的一些实施例中，基于前述方案，所述将所述第一消息投递至与所述目标服务端相对应的消息队列中，包括：查询与所述目标服务端建立的第二通信链路，作为目标通信链路；将所述第一消息投递至所述目标通信链路中的消息队列中。在本申请的一些实施例中，基于前述方案，所述方法还包括：从与所述目标服务端相对应的消息队列中读取由所述目标服务端投递的第二消息，所述第二消息的消息格式为MQ格式；基于所述第二消息确定目标客户端，并将所述第二消息的消息格式由MQ格式转换为Socket格式；通过所述第一通信链路将所述第二消息发送至所述目标客户端。根据本申请实施例的一个方面，提供了一种消息传输装置，所述装置包括：接收单元，被用于接收由目标客户端发出的第一消息，所述第一消息的消息格式为Socket格式；确定单元，被用于基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，所述目标服务端为所述目标客户端发送所述第一消息的目的地；投递单元，被用于将所述第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。根据本申请实施例的一个方面，提供了一种计算机程序产品或计算机程序，该计算机程序产品或计算机程序包括计算机指令，该计算机指令存储在计算机可读存储介质中。电子设备的处理器从计算机可读存储介质读取该计算机指令，处理器执行该计算机指令，使得该电子设备执行上述实施例中所述的消息传输方法。根据本申请实施例的一个方面，提供了一种计算机可读介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现如上述实施例中所述的消息传输方法。根据本申请实施例的一个方面，提供了一种电子设备，包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述一个或多个处理器实现如上述实施例中所述的消息传输方法。在本申请一些实施例所提供的技术方案中，通过接收由目标客户端发出的第一消息，可以避免消息在目标客户端在与服务端之间原始的通信链路进行消息传输，从而可以精简消息传输的通信链路，降低对通信资源的消耗。此外，在多个客户端与目标服务端之间进行消息传输时，消息队列中可以保存有多个客户端发出的第一消息，一方面，不会影响用户在通过客户端与服务端进行消息传输时的感知和体验，另一方面，可以使得客户端与服务端之间能够传输离线消息，增强消息传输场景的适用性。应当理解的是，以上的一般描述和后文的细节描述仅是示例性和解释性的，并不能限制本申请。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本申请的实施例，并与说明书一起用于解释本申请的原理。显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。在附图中：图1示出了可以应用本申请实施例的技术方案的示例性系统架构的示意图；图2示出了根据本申请一个实施例的消息传输方法的流程图；图3示出了根据本申请一个实施例的建立与所述目标客户端之间的第一通信链路的细节流程图；图4示出了根据本申请一个实施例的在接收由网关截取并转发的所述目标客户端向服务端发出的连接请求之后的方法流程图；图5示出了根据本申请一个实施例的接收由目标客户端发出的第一消息的细节流程图；图6示出了根据本申请一个实施例的基于所述第一消息确定目标服务端的细节流程图；图7示出了根据本申请一个实施例的在将所述第一消息投递至与所述目标服务端相对应的消息队列中之前的方法流程图；图8示出了根据本申请一个实施例的消息传输方法的流程图；图9示出了根据本申请一个实施例的消息传输的演示图；图10示出了根据本申请一个实施例的消息传输装置的框图；图11示出了适于用来实现本申请实施例的电子设备的计算机系统的结构示意图。具体实施方式现在将参考附图更全面地描述示例实施方式。然而，示例实施方式能够以多种形式实施，且不应被理解为限于在此阐述的范例；相反，提供这些实施方式使得本申请将更加全面和完整，并将示例实施方式的构思全面地传达给本领域的技术人员。此外，所描述的特征、结构或特性可以以任何合适的方式结合在一个或更多实施例中。在下面的描述中，提供许多具体细节从而给出对本申请的实施例的充分理解。然而，本领域技术人员将意识到，可以实践本申请的技术方案而没有特定细节中的一个或更多，或者可以采用其它的方法、组元、装置、步骤等。在其它情况下，不详细示出或描述公知方法、装置、程序产品、介质及电子设备、实现或者操作以避免模糊本申请的各方面。附图中所示的方框图仅仅是功能实体，不一定必须与物理上独立的实体相对应。即，可以采用软件形式来实现这些功能实体，或在一个或多个硬件模块或集成电路中实现这些功能实体，或在不同网络和/或处理器装置和/或微控制器装置中实现这些功能实体。附图中所示的流程图仅是示例性说明，不是必须包括所有的内容和操作/步骤，也不是必须按所描述的顺序执行。例如，有的操作/步骤还可以分解，而有的操作/步骤可以合并或部分合并，因此实际执行的顺序有可能根据实际情况改变。需要说明的是：在本文中提及的“多个”是指两个或两个以上。“和/或”描述关联对象的关联关系，表示可以存在三种关系，例如，A和/或B可以表示：单独存在A，同时存在A和B，单独存在B这三种情况。字符“/”一般表示前后关联对象是一种“或”的关系。需要注意的是，本申请的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的对象在适当情况下可以互换，以便这里描述的本申请的实施例能够以除了在图示或描述的那些以外的顺序实施。图1示出了可以应用本申请实施例的技术方案的示例性系统架构的示意图。如图1所示，系统架构100可以包括客户端设备101、网络102、消息传输装置103和服务端104。网络用以在客户端设备、消息传输装置和服务端之间提供通信链路的介质。网络可以包括各种连接类型，例如有线通信链路、无线通信链路等等。在本申请的一个实施例中，在客户端与服务端之间需要相互传输消息的场景下，消息传输装置103可以接收由目标客户端设备101发出的消息格式为Socket格式的第一消息，然后，消息传输装置103基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，其中，所述目标服务端为所述目标客户端发送所述第一消息的目的地，最后，消息传输装置103可以将所述消息格式为MQ格式的第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。需要说明的是，本实施例中所提到的消息可以是客户端向服务端提交的一个HTTP请求，这个HTTP请求可以包括请求的网页内容，CSS文件，JS文件，图片等等，服务端也可以向客户端返回上述内容的消息。本申请通过消息传输装置将接收的第一消息的消息格式由Socket格式转换为MQ格式，并将所述消息格式为MQ格式的第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息，进而可以精简消息传输所需的通信链路，降低对通信资源的消耗。需要说明的是，本申请实施例所提供的消息传输方法可以由消息传输装置103执行。但是，在本申请的其它实施例中，执行本申请实施例所提供的消息传输方案的也可以是其它主体设备。还需要说明的是，图1中的客户端设备、网络和服务端的数目仅仅是示意性的。根据实现需要，服务端可以是独立的物理服务器，也可以是多个物理服务器构成的服务器集群或者分布式系统，还可以是提供云服务、云数据库、云计算、云函数、云存储、网络服务、云通信、中间件服务、域名服务、安全服务、CDN、以及大数据和人工智能平台等基础云计算服务的云服务器。终端设备也可以是智能手机、平板电脑、笔记本电脑、台式计算机、智能音箱、智能手表等，但并不局限于此，本申请在此不做限制。需要解释的是，如上所述的云计算是一种计算模式，它将计算任务分布在大量计算机构成的资源池上，使各种应用系统能够根据需要获取计算力、存储空间和信息服务。提供资源的网络被称为“云”。“云”中的资源在使用者看来是可以无限扩展的，并且可以随时获取，按需使用，随时扩展。通过建立云计算资源池平台，在资源池中部署多种类型的虚拟资源，供外部客户选择使用。云计算资源池中主要包括：计算设备、存储设备、网络设备。以下对本申请实施例的技术方案的实现细节进行详细阐述：图2示出了根据本申请一个实施例的消息传输方法的流程图，该消息传输方法可以由具有计算处理功能的设备来执行，比如可以由图1中所示的消息传输装置103来执行。参照图2所示，该消息传输方法至少包括步骤220至步骤260：步骤220，接收由目标客户端发出的第一消息，所述第一消息的消息格式为Socket格式。步骤240，基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，所述目标服务端为所述目标客户端发送所述第一消息的目的地。步骤260，将所述第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。在本申请中，需要说明的是，所提到的第一消息可以是客户端向服务端提交的一个HTTP请求，这个HTTP请求可以包括请求的网页内容，CSS文件，JS文件，图片等等。在本申请中，针对上述消息传输方案的详细介绍如下：参照图1，在步骤220中，接收由目标客户端发出的第一消息，所述第一消息的消息格式为Socket格式。目前，在客户端与服务端之间需要相互传输消息的场景下，现有方案一般是客户端与服务端按照长连接协议建立通信链路，然后基于该通信链路互传消息，其中，客户端与服务端之间在长连接协议下相互传输的消息一般是Socket格式的消息。首先，由客户端将Socket格式的消息发送至服务端在公网中的IP地址，服务端对应的网关接收到该Socket格式的消息之后，发送至核心路由器，然后由核心路由器发送至对应的分布式路由器，最后服务端从对应的分布式路由器获取该Socket格式的消息，从而完成一次消息的传输。而在本申请中，可以是由设置的消息传输装置接收由目标客户端发出的消息格式为Socket格式的第一消息。在本申请的一个实施例中，在接收由目标客户端发出的第一消息之前，还可以执行如下步骤210：步骤210，按照长连接协议，建立与所述目标客户端之间的第一通信链路，所述第一通信链路用于在与所述目标客户端之间传输消息。在本申请中，在消息传输装置接收由目标客户端发出的消息格式为Socket格式的第一消息之前，可以由消息传输装置建立与目标客户端之间的第一通信链路，以用于在与所述目标客户端之间传输消息。在本实施例中，所述按照长连接协议，建立与所述目标客户端之间的第一通信链路，还可以按照如图3所示的步骤执行。参见图3，示出了根据本申请一个实施例的建立与所述目标客户端之间的第一通信链路的细节流程图。具体包括步骤211至步骤212：步骤211，接收由网关截取并转发的所述目标客户端向服务端发出的连接请求，所述连接请求为所述目标客户端首次向服务端发出的第一消息。步骤212，响应于所述连接请求，按照长连接协议，通过所述网关建立与所述目标客户端之间的第一通信链路。在现有方案中，在目标客户端与服务端之间正式进行消息的相互传输之前，目标客户端一般会首先向服务端发送连接请求，以寻求按照长连接协议与服务端之间建立通信链路。而在本申请中，可以通过网关截取所述连接请求，并将所述连接请求引流至所述消息传输装置，使得所述消息传输装置响应于所述连接请求，按照长连接协议，通过所述网关建立与所述目标客户端之间的第一通信链路。在本申请中，需要说明的是，所谓的长连接协议，就是指客户端向服务端发起连接，服务端接受客户端的连接，双方建立连接之后。客户端与服务端完成一次消息读写之后，它们之间的连接并不会主动关闭，后续的消息读写操作会继续使用这个连接。在本申请的一个实施例中，在如图3所示步骤211之后，即在接收由网关截取并转发的所述目标客户端向服务端发出的连接请求之后，还可以执行如图4所示的步骤。参见图4，示出了根据本申请一个实施例的在接收由网关截取并转发的所述目标客户端向服务端发出的连接请求之后的方法流程图。具体包括步骤2111至步骤2113：步骤2111，获取关联记录，所述关联记录中保存有多个客户端的客户端网络地址与多个服务端的服务端网络地址之间的关联关系。步骤2112，根据所述关联记录，从多个服务端中为所述目标客户端分配一个服务端，作为目标服务端。步骤2113，建立所述目标客户端的客户端网络地址与所述目标服务端的服务端网络地址之间的目标关联关系，并将所述目标关联关系保存至关联记录中，所述目标关联关系用于所述目标客户端与所述目标服务端在通信过程中相互关联。在本申请中，所述消息传输装置中可以存储有关联记录，在客户端通过所述消息传输装置与服务端进行消息传输时，客户端的客户端网络地址与服务端的服务端网络地址之间的关联关系会保存在所述关联记录中。本申请中，在接收由网关截取并转发的所述目标客户端向服务端发出的连接请求之后，说明目标客户端和服务端之间在后续会通过所述消息传输装置进行消息传输，此时，可以从多个服务端中为所述目标客户端分配一个服务端，作为目标服务端，并建立所述目标客户端的客户端网络地址与所述目标服务端的服务端网络地址之间的目标关联关系，将所述目标关联关系保存至所述关联记录中，以用于所述目标客户端与所述目标服务端在通信过程中相互关联。在本实施例中，所述根据所述关联记录，从多个服务端中为所述目标客户端分配一个服务端，可以按照如下步骤21121至步骤21122执行。步骤21121，根据所述关联记录，分别确定各个服务端与客户端的关联次数。步骤21122，从多个服务端中为所述目标客户端分配一个关联次数最少的服务端。在本申请中，从多个服务端中为所述目标客户端分配一个关联次数最少的服务端，可以均衡各个服务端的消息传输负荷，有利于提高消息传输的效率，同时防止因某个服务端因消息传输负荷过重而崩溃，增强系统的稳定性。在本申请的一个实施例中，在如图2所示步骤220中，即所述接收由目标客户端发出的第一消息，可以按照如图5所示步骤执行。参见图5，示出了根据本申请一个实施例的接收由目标客户端发出的第一消息的细节流程图。具体包括步骤221至步骤222：步骤221，在所述目标客户端向目标服务端发出第一消息时，通过网关判断所述第一消息是否属于长连接协议。步骤222，如果所述第一消息属于长连接协议，则通过所述第一通信链路接收由网关截取并转发的所述目标客户端向所述目标服务端发出的第一消息。在本申请中，所述网关判断所述第一消息是否属于长连接协议，可以根据所述第一消息的消息头来判断，如果所述第一消息属于长连接协议，则说明第一消息会通过与服务端之间原始的通信链路进行消息传输，此时，可以通过所述网关对所述第一消息进行截取并将所述第一消息引流至所述消息传输装置，以使得所述消息传输装置通过所述第一通信链路接收所述目标客户端向所述目标服务端发出的第一消息。在本申请中，通过所述网关对所述第一消息进行截取并将所述第一消息引流至所述消息传输装置，可以避免消息目标客户端在与服务端之间原始的通信链路进行消息传输，从而可以精简消息传输的通信链路，降低对通信资源的消耗。继续参照图1，在步骤240中，基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，所述目标服务端为所述目标客户端发送所述第一消息的目的地。在本申请的一个实施例中，所述基于所述第一消息确定目标服务端，可以按照如图6所示的步骤执行。参见图6，示出了根据本申请一个实施例的基于所述第一消息确定目标服务端的细节流程图。具体包括步骤241至步骤242：步骤241，从所述第一消息中确定所述目标客户端的客户端网络地址。步骤242，从所述关联记录中查询与所述目标客户端的客户端网络地址相关联的服务端网络地址，以在多个服务端中确定所述目标服务端。在本申请中，由于第一消息由目标客户端发出，其中一般会包含有目标客户端的客户端网络地址，基于此，可以从所述关联记录中查询与所述目标客户端的客户端网络地址相关联的服务端网络地址，并根据与所述目标客户端的客户端网络地址相关联的服务端网络地址确定出目标服务端，进而确定出所述目标客户端发送所述第一消息的目的地。在本申请中，将所述第一消息的消息格式由Socket格式转换为MQ格式，是为了在后续过程中能够通过消息队列对所述第一消息中的消息内容进行传输。继续参照图1，在步骤260中，将所述第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。在本申请的一个实施例中，在如图2所示步骤260之间，即在将所述第一消息投递至与所述目标服务端相对应的消息队列中之前，还可以执行如图7所示的步骤。参见图7，示出了根据本申请一个实施例的在将所述第一消息投递至与所述目标服务端相对应的消息队列中之前的方法流程图。具体包括步骤251至步骤252：步骤251，接收由各个服务端发送的第二通信链路注册请求，所述各个服务端中包括所述目标服务端。步骤252，响应于所述第二通信链路注册请求，建立与各个服务端之间的第二通信链路，所述第二通信链路中包括消息队列。在本申请中，客户端与服务端之间要通过消息传输装置进行消息传输，除了需要按照长连接协议建立客户端与消息传输装置之间的第一通信链路之外，还需要按照长连接协议建立消息传输装置与服务端之间的第二通信链路，并且，消息传输装置与每一个服务端之间的第二通信链路中还包括有消息队列，以用于消息传输装置将消息格式为MQ格式的第一消息传输给服务端。在本申请的一个实施例中，在如图2所示步骤260中，即所述将所述第一消息投递至与所述目标服务端相对应的消息队列中，还可以按照如下步骤261至步骤262执行：步骤261，查询与所述目标服务端建立的第二通信链路，作为目标通信链路。步骤262，将所述第一消息投递至所述目标通信链路中的消息队列中。在本申请中，将消息格式为MQ格式的第一消息投递至与所述目标服务端相对应的消息队列中，首先可以查询与所述目标服务端建立的第二通信链路作为目标通信链路，从而可以进一步的将消息格式为MQ格式的第一消息投递至所述目标通信链路中的消息队列中。在本申请中，可以理解的是，在多个客户端与目标服务端之间进行消息传输时，在第二通信链路的消息队列中可以保存有多个客户端发出的第一消息，其好处在于，一方面，不会影响用户在通过客户端与服务端进行消息传输时的感知和体验，另一方面，可以使得客户端与服务端之间能够传输离线消息，增强消息传输场景的适用性。在本申请的一个实施例中，还可以执行如图8所示的步骤。参见图8，示出了根据本申请一个实施例的消息传输方法的流程图。具体包括步骤270至步骤290：步骤270，从与所述目标服务端相对应的消息队列中读取由所述目标服务端投递的第二消息，所述第二消息的消息格式为MQ格式。步骤280，基于所述第二消息确定目标客户端，并将所述第二消息的消息格式由MQ格式转换为Socket格式。步骤290，通过所述第一通信链路将所述第二消息发送至所述目标客户端。在本申请中，所提出的消息传输装置除了可以将目标客户端发出的第一消息传输给目标服务端之外，还可以将目标服务端回应的第二消息传输给目标客户端。具体的，可以是由目标服务端将其回应给目标客户端的第二消息投递至与消息传输装置建立的第二通信链路中的消息队列中，以使得消息传输装置从与所述目标服务端相对应的消息队列中读取由所述目标服务端投递的消息格式为MQ格式的第二消息，消息传输装置在读取到所述第二消息之后，基于所述第二消息确定目标客户端，并将所述第二消息的消息格式由MQ格式转换为Socket格式，最后通过所述第一通信链路将消息格式为Socket格式的第二消息发送至所述目标客户端，进而完成目标服务端与目标客户端之间消息传输。为了使本领域技术人员更好的理解本申请的进步性，下面将结合图9以一个具体的实施例进行说明。参见图9，示出了根据本申请一个实施例的消息传输的演示图。如图9所示，在现有方案中，一般是客户端901与服务端906按照长连接协议建立通信链路，通信链路中依次包括虚拟网关902，核心虚拟路由器904，分布式虚拟路由器905等设备，然后基于该通信链路互传消息，其中，客户端901与服务端906之间在长连接协议下相互传输的消息一般是Socket格式的消息。首先，由客户端901将Socket格式的消息发送至服务端906在公网中的IP地址，虚拟网关902接收到该Socket格式的消息之后，发送至核心虚拟路由器904，然后由核心虚拟路由器904发送至对应的虚拟分布式路由器905，最后服务端906从对应的虚拟分布式路由器获取该Socket格式的消息，从而完成一次消息的传输。而在本申请中，客户端901发出的消息在经过虚拟网关902时，由虚拟网关902判断其是否属于长连接协议，若是，则截取该消息流量并将其引流至消息传输装置903，消息传输装置903与客户端901按照长连接协议建立第一通信链路，并将消息格式为Socket格式的消息转换为消息格式为MQ格式的消息。另一方面，服务端906还向消息传输装置903发送第二通信链路注册请求，消息传输装置903则响应于所述第二通信链路注册请求，建立与服务端906之间的第二通信链路，所述第二通信链路中包括消息队列。在客户端901所发出消息的格式转换为MQ格式之后，查询到与服务端906对应的消息队列，然后进行消息投递。可见，在本申请中，通过所述网关对所述第一消息进行截取并将所述第一消息引流至所述消息传输装置，可以避免消息目标客户端在与服务端之间原始的通信链路进行消息传输，从而可以精简消息传输的通信链路，降低对通信资源的消耗。此外，在多个客户端与目标服务端之间进行消息传输时，在第二通信链路的消息队列中可以保存有多个客户端发出的第一消息，其好处在于，一方面，不会影响用户在通过客户端与服务端进行消息传输时的感知和体验，另一方面，可以使得客户端与服务端之间能够传输离线消息，增强消息传输场景的适用性。以下介绍本申请的装置实施例，可以用于执行本申请上述实施例中的消息传输方法。对于本申请装置实施例中未披露的细节，请参照本申请上述的消息传输方法的实施例。图10示出了根据本申请的一个实施例的消息传输装置的框图。参照图10所示，根据本申请的一个实施例的消息传输装置1000，包括：接收单元1001、确定单元1002和投递单元1003。其中，接收单元1001，被用于接收由目标客户端发出的第一消息，所述第一消息的消息格式为Socket格式；确定单元1002，被用于基于所述第一消息确定目标服务端，并将所述第一消息的消息格式由Socket格式转换为MQ格式，所述目标服务端为所述目标客户端发送所述第一消息的目的地；投递单元1003，被用于将所述第一消息投递至与所述目标服务端相对应的消息队列中，以使得所述目标服务端从与所述目标服务端相对应的消息队列中读取所述第一消息。在本申请的一些实施例中，基于前述方案，所述装置还包括第一建立单元，被用于在接收由目标客户端发出的第一消息之前，按照长连接协议，建立与所述目标客户端之间的第一通信链路，所述第一通信链路用于在与所述目标客户端之间传输消息。在本申请的一些实施例中，基于前述方案，所述第一建立单元配置为：接收由网关截取并转发的所述目标客户端向服务端发出的连接请求，所述连接请求为所述目标客户端首次向服务端发出的第一消息；响应于所述连接请求，按照长连接协议，通过所述网关建立与所述目标客户端之间的第一通信链路。在本申请的一些实施例中，基于前述方案，所述装置还包括：获取单元，被用于在接收由网关截取并转发的所述目标客户端向服务端发出的连接请求之后，获取关联记录，所述关联记录中保存有多个客户端的客户端网络地址与多个服务端的服务端网络地址之间的关联关系；分配单元，被用于根据所述关联记录，从多个服务端中为所述目标客户端分配一个服务端，作为目标服务端；第二建立单元，被用于建立所述目标客户端的客户端网络地址与所述目标服务端的服务端网络地址之间的目标关联关系，并将所述目标关联关系保存至关联记录中，所述目标关联关系用于所述目标客户端与所述目标服务端在通信过程中相互关联。在本申请的一些实施例中，基于前述方案，所述分配单元配置为：根据所述关联记录，分别确定各个服务端与客户端的关联次数；从多个服务端中为所述目标客户端分配一个关联次数最少的服务端。在本申请的一些实施例中，基于前述方案，所述接收单元1001配置为：在所述目标客户端向目标服务端发出第一消息时，通过网关判断所述第一消息是否属于长连接协议；如果所述第一消息属于长连接协议，则通过所述第一通信链路接收由网关截取并转发的所述目标客户端向所述目标服务端发出的第一消息。在本申请的一些实施例中，基于前述方案，所述确定单元1002配置为：从所述第一消息中确定所述目标客户端的客户端网络地址；从所述关联记录中查询与所述目标客户端的客户端网络地址相关联的服务端网络地址，以在多个服务端中确定所述目标服务端。在本申请的一些实施例中，基于前述方案，所述装置还包括：第三建立单元，被用于在将所述第一消息投递至与所述目标服务端相对应的消息队列中之前，接收由各个服务端发送的第二通信链路注册请求，所述各个服务端中包括所述目标服务端；响应于所述第二通信链路注册请求，建立与各个服务端之间的第二通信链路，所述第二通信链路中包括消息队列。在本申请的一些实施例中，基于前述方案，所述投递单元1003配置为：查询与所述目标服务端建立的第二通信链路，作为目标通信链路；将所述第一消息投递至所述目标通信链路中的消息队列中。在本申请的一些实施例中，基于前述方案，所述装置还包括读取单元，被用于从与所述目标服务端相对应的消息队列中读取由所述目标服务端投递的第二消息，所述第二消息的消息格式为MQ格式；所述确定单元1002还配置为：基于所述第二消息确定目标客户端，并将所述第二消息的消息格式由MQ格式转换为Socket格式；所述装置还包括发送单元，被用于通过所述第一通信链路将所述第二消息发送至所述目标客户端。图11示出了适于用来实现本申请实施例的电子设备的计算机系统的结构示意图。需要说明的是，图11示出的电子设备的计算机系统1100仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图11所示，计算机系统1100包括中央处理单元1101，其可以根据存储在只读存储器1102中的程序或者从储存部分1108加载到随机访问存储器1103中的程序而执行各种适当的动作和处理，例如执行上述实施例中所述的方法。在RAM 1103中，还存储有系统操作所需的各种程序和数据。CPU 1101、ROM 1102以及RAM 1103通过总线1104彼此相连。输入/输出接口1105也连接至总线1104。以下部件连接至I/O接口1105：包括键盘、鼠标等的输入部分1106；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分1107；包括硬盘等的储存部分1108；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分1109。通信部分1109经由诸如因特网的网络执行通信处理。驱动器1110也根据需要连接至I/O接口1105。可拆卸介质1111，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器1110上，以便于从其上读出的计算机程序根据需要被安装入储存部分1108。特别地，根据本申请的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本申请的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的程序代码。在这样的实施例中，该计算机程序可以通过通信部分1109从网络上被下载和安装，和/或从可拆卸介质1111被安装。在该计算机程序被中央处理单元1101执行时，执行本申请的系统中限定的各种功能。需要说明的是，本申请实施例所示的计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是——但不限于——电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、闪存、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本申请中，计算机可读存储介质可以是任何包含或存储程序的有形介质，该程序可以被指令执行系统、装置或者器件使用或者与其结合使用。而在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的程序代码。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的程序代码可以用任何适当的介质传输，包括但不限于：无线、有线等等，或者上述的任意合适的组合。附图中的流程图和框图，图示了按照本申请各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。其中，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本申请实施例中所涉及到的单元可以通过软件的方式实现，也可以通过硬件的方式来实现，所描述的单元也可以设置在处理器中。其中，这些单元的名称在某种情况下并不构成对该单元本身的限定。作为另一方面，本申请还提供了一种计算机程序产品或计算机程序，该计算机程序产品或计算机程序包括计算机指令，该计算机指令存储在计算机可读存储介质中。电子设备的处理器从计算机可读存储介质读取该计算机指令，处理器执行该计算机指令，使得该电子设备执行上述实施例中所述的消息传输方法。作为另一方面，本申请还提供了一种计算机可读介质，该计算机可读介质可以是上述实施例中描述的电子设备中所包含的；也可以是单独存在，而未装配入该电子设备中。上述计算机可读介质承载有一个或者多个程序，当上述一个或者多个程序被一个该电子设备执行时，使得该电子设备实现上述实施例中所述的消息传输方法。应当注意，尽管在上文详细描述中提及了用于动作执行的设备的若干模块或者单元，但是这种划分并非强制性的。实际上，根据本申请的实施方式，上文描述的两个或更多模块或者单元的特征和功能可以在一个模块或者单元中具体化。反之，上文描述的一个模块或者单元的特征和功能可以进一步划分为由多个模块或者单元来具体化。通过以上的实施方式的描述，本领域的技术人员易于理解，这里描述的示例实施方式可以通过软件实现，也可以通过软件结合必要的硬件的方式来实现。因此，根据本申请实施方式的技术方案可以以软件产品的形式体现出来，该软件产品可以存储在一个非易失性存储介质中或网络上，包括若干指令以使得一台计算设备执行根据本申请实施方式的方法。本领域技术人员在考虑说明书及实践这里公开的实施方式后，将容易想到本申请的其它实施方案。本申请旨在涵盖本申请的任何变型、用途或者适应性变化，这些变型、用途或者适应性变化遵循本申请的一般性原理并包括本申请未公开的本技术领域中的公知常识或惯用技术手段。应当理解的是，本申请并不局限于上面已经描述并在附图中示出的精确结构，并且可以在不脱离其范围进行各种修改和改变。本申请的范围仅由所附的权利要求来限制。
