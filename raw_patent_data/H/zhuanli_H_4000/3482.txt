标题title
服务器登入异常的监测方法、装置、设备、及存储介质
摘要abst
本发明提供的一种服务器登入异常的监测方法，适用于Linux系统的服务器，所述方法包括：通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库，所述待监测日志内容包括用户的登录状态；基于所述待监测日志内容及触发规则，确定触发器的状态；当所述触发器处于触发状态时，发出告警。本发明用以解决现有的Linux系统的服务器登入异常需要人工查看的问题。
权利要求书clms
1.一种服务器登入异常的监测方法，其特征在于，所述方法包括：通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库，所述待监测日志内容包括用户的登录状态；基于所述待监测日志内容及触发规则，确定触发器的状态；当所述触发器处于触发状态时，发出告警。2.根据权利要求1所述的服务器登入异常的监测方法，其特征在于，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库包括：预设代理采集所述待监测服务器的多个待监测日志、并通过正则关系表达式匹配所述待监测日志内的关键字；将匹配成功的关键字所属待监测日志的待监测日志内容发送给预设服务器；所述预设服务器将接收到的所述待监测日志内容保存至所述预设数据库。3.根据权利要求1所述的服务器登入异常的监测方法，其特征在于，所述预设服务器将接收到的信息保存至所述预设数据库包括：所述预设代理获取待监测日志的末次读取字节数和末次修改时间并发送给预设服务器；所述预设服务器将所述末次读取字节数和所述日志末次修改时间记录在预设数据库，并发送给预设代理，以使所述预设代理基于前次读取日志停止处继续读取所述待监测日志。4.根据权利要求3所述的服务器登入异常的监测方法，其特征在于，所述预设服务器将所述字节数和所述日志末次修改时间记录在预设数据库包括：所述预设服务器将所述末次读取字节数记录在字节计数器中；所述预设服务器将所述日志末次修改时间记录在最新时间计数器中；所述字节计数器和所述最新时间计数器存储于所述预设数据库中。5.根据权利要求4所述的服务器登入异常的监测方法，其特征在于，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库之前，所述方法还包括：判断当前读取的待监测日志的当前字节数是否大于或等于所述字节计数器中的末次读取字节数；若所述当前字节数大于或等于所述末次读取字节数，所述预设代理自前次读取日志停止处继续读取待监测日志。6.根据权利要求5所述的服务器登入异常的监测方法，其特征在于，若所述当前字节数小于所述末次读取字节数，所述预设代理从待监测日志的起始处开始重新读取日志。7.根据权利要求1-6任一项所述的服务器登入异常的监测方法，其特征在于，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库之前，所述方法包括：配置服务器监控，在预设服务器添加待监测服务器、并添加采集待监测日志的监控项；在所述待监测服务器上安装预设代理。8.根据权利要求1-6任一项所述的服务器登入异常的监测方法，其特征在于，所述告警通过触发器发出，所述触发规则包括：当用户的登入状态符合触发条件时，所述触发器处于触发状态发出告警，当用户的登入状态符合恢复条件时，所述触发器处于恢复状态。9.一种服务器登入异常的监测装置，其特征在于，包括：获取模块，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库，所述待监测日志内容包括用户的登录状态；处理模块，基于所述待监测日志内容及触发规则，确定触发器的状态；告警模块，当所述触发器处于触发状态时，发出告警。10.一种电子设备，其特征在于，所述电子设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述电子设备实现如权利要求1至8中任一项所述的服务器登入异常的监测方法。11.一种存储介质，其特征在于，其上存储有计算机程序，当所述计算机程序被处理器执行时，实现如权利要求1至8中任一项所述的服务器登入异常的监测方法。
说明书desc
技术领域本申请涉及服务器安全监测技术领域，具体涉及一种服务器登入异常的监测方法、装置、设备、及存储介质。背景技术Linux系统作为开源的操作系统，由于其成本低，可维护性高等优点，深受各大产品生产商的青睐，但是由于linux固有的一些特点使其也存在一定的弊端，如配置不当则很容易遭受黑客的攻击，尤其是基于linux系统的服务器等。为了保证服务器的安全运行，需要定期检查服务器是否被异常登录过，当前针对linux系统的服务器，其是否异常登录的检测方法是：人工登录linux服务器查看日志，或者登录日志统一收集，然后人工进行查看是否有过异常登录；这种处理方式做不仅容易漏看，同时无法做到时效性，当你看到有异常登录的时候，往往已经是过去时，服务器可能早已被人攻陷，而且大大的耗费了人力物力。发明内容鉴于以上所述现有技术的缺点，本发明提供一种服务器登入异常的监测方法、装置、设备、及存储介质，以解决现有的Linux系统的服务器登入异常需要人工查看的问题。本发明提供的一种服务器登入异常的监测方法，适用于Linux系统的服务器，所述方法包括：通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库，所述待监测日志内容包括用户的登录状态；基于所述待监测日志内容及触发规则，确定触发器的状态；当所述触发器处于触发状态时，发出告警。于本发明的一实施例中，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库包括：预设代理采集所述待监测服务器的多个待监测日志、并通过正则关系表达式匹配所述待监测日志内的关键字；将匹配成功的关键字所属待监测日志的待监测日志内容发送给预设服务器；所述预设服务器将接收到的所述待监测日志内容保存至所述预设数据库。于本发明的一实施例中，所述预设服务器将接收到的信息保存至所述预设数据库包括：所述预设代理获取待监测日志的末次读取字节数和末次修改时间并发送给预设服务器；所述预设服务器将所述末次读取字节数和所述日志末次修改时间记录在预设数据库，并发送给预设代理，以使所述预设代理基于前次读取日志停止处继续读取所述待监测日志。于本发明的一实施例中，所述预设服务器将所述字节数和所述日志末次修改时间记录在预设数据库包括：所述预设服务器将所述末次读取字节数记录在字节计数器中；所述预设服务器将所述日志末次修改时间记录在最新时间计数器中；所述字节计数器和所述最新时间计数器存储于所述预设数据库中。于本发明的一实施例中，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库之前，所述方法还包括：判断当前读取的待监测日志的当前字节数是否大于或等于所述字节计数器中的末次读取字节数；若所述当前字节数大于或等于所述末次读取字节数，所述预设代理自前次读取日志停止处继续读取待监测日志。于本发明的一实施例中，若所述当前字节数小于所述末次读取字节数，所述预设代理从待监测日志的起始处开始重新读取日志。于本发明的一实施例中，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库之前，所述方法包括：配置服务器监控，在预设服务器添加待监测服务器、并添加采集待监测日志的监控项；在所述待监测服务器上安装预设代理。于本发明的一实施例中，所述告警通过触发器发出，所述触发规则包括：当用户的登入状态符合触发条件时，所述触发器处于触发状态发出告警，当用户的登入状态符合恢复条件时，所述触发器处于恢复状态。本发明提供一种服务器登入异常的监测装置，包括：获取模块，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库，所述待监测日志内容包括用户的登录状态；处理模块，基于所述待监测日志内容及触发规则，确定触发器的状态；告警模块，当所述触发器处于触发状态时，发出告警。本发明提供一种电子设备，所述电子设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述电子设备实现所述的服务器登入异常的监测方法。本发明提供一种存储介质，所述存储介质上存储有计算机程序，当所述计算机程序被处理器执行时，实现所述的服务器登入异常的监测方法。本发明的有益效果：利用zabbix平台提供查看服务器异常登录日志的界面，以及可通过规则匹配实现的告警功能，能有效的减少人为从每一个服务器检查日志的人力资源消耗，同时能提供及时的异常告警，有效的降低了服务器异常登录发现的滞后性，提高了服务器和系统的安全性。应当理解的是，以上的一般描述和后文的细节描述仅是示例性和解释性的，并不能限制本申请。附图说明此处的附图被并入说明书中并构成本说明书的一部分，示出了符合本申请的实施例，并与说明书一起用于解释本申请的原理。显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术者来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。在附图中：图1是本发明的一示例性实施例示出的服务器登入异常的监测方法的流程图；图2是本发明的一示例性实施例示出的zabbix主动模式工作流程图；图3是本发明的一示例性实施例示出的zabbix告警工作流程图；图4是本发明的一示例性实施例示出的服务器登入异常的监测装置的结构框图；图5是本发明的一示例性实施例示出的适于用来实现本申请实施例的电子设备的计算机系统的结构示意图。具体实施方式以下将参照附图和优选实施例来说明本发明的实施方式，本领域技术人员可由本说明书中所揭露的内容轻易地了解本发明的其他优点与功效。本发明还可以通过另外不同的具体实施方式加以实施或应用，本说明书中的各项细节也可以基于不同观点与应用，在没有背离本发明的精神下进行各种修饰或改变。应当理解，优选实施例仅为了说明本发明，而不是为了限制本发明的保护范围。需要说明的是，以下实施例中所提供的图示仅以示意方式说明本发明的基本构想，遂图式中仅显示与本发明中有关的组件而非按照实际实施时的组件数目、形状及尺寸绘制，其实际实施时各组件的型态、数量及比例可为一种随意的改变，且其组件布局型态也可能更为复杂。在下文描述中，探讨了大量细节，以提供对本发明实施例的更透彻的解释，然而，对本领域技术人员来说，可以在没有这些具体细节的情况下实施本发明的实施例是显而易见的，在其他实施例中，以方框图的形式而不是以细节的形式来示出公知的结构和设备，以避免使本发明的实施例难以理解。Zabbix是一个基于web界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。Zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位、解决存在的各种问题。本发明主要包括zabbix系统、zabbix-agent、zabbix告警媒介、监控服务器。其中，zabbix告警媒介与zabbix-server是zabbix系统内的一部分，zabbix系统安装于独立的设备上或待监测的服务器上。当zabbix系统安装于待监测的服务器上时，意味着待监测的服务器与监测设备共用一个服务器，例如当需要监测某计算机上的登入状态时，可以通过在本计算机上安装zabbix系统。简要介绍如下:zabbix系统：主要负责监控收集服务器各类日志，可提供查看界面，也可根据日志内容匹配规则实现通过各种渠道进行告警通知。zabbix-agent，zabbix-agent安装在被监视的目标服务器上。zabbix-agent收集日志原理如下：zabbix-agent分为主动模式和被动模式，主动模式是由zabbix-agent主动采集数据并返回给zabbix-server。zabbix-agent搜索指定文本文件里内容，通过正则表达式匹配关键字，如果匹配成功，则把该行信息主动发送给zabbix-server；zabbix-server和zabbix-agent会追踪日志文件的大小和最后修改时间，并且分别记录在字节计数器和最新的时间计数器中；agent会从上次读取日志的地方开始读取日志；字节计数器和最新时间计数器的数据会被记录在zabbix数据库，并且发送给agent，这样能够保证agent从上次停止的地方开始读取日志；当日志文件大小小于字节计数器中的数字时，字节计数器会变为0，从头开始读取文件；所有符合配置的文件，都会被监控；一个目录下的多个文件如果修改时间相同，会按照字母顺序来读取。被动模式是被动获取其他的数据。zabbix告警媒介，zabbix提供短信，邮件，自定义脚本等多种方式进行告警的方式。服务器：需要被监控的服务器，服务器上需要安装zabbix-agent。请参阅图1至图3，一种服务器登入异常的监测方法，适用于Linux系统的服务器，所述方法包括：配置服务器监控，在zabbix系统中的预设服务器项添加待监测服务器、并添加采集待监测日志的监控项。具体地，zabbix系统web界面配置服务器监控，在zabbix-server添加需要被监控主机，在主机监控项中添加收集日志的监控项，监控项类型选择zabbix客户端，信息类型选择日志,键值为log。在所述待监测服务器上安装预设代理。在需要监控的服务器上安装zabbx-agent,给/var/log/secure日志授权，让zabbix-agent有权限能读取此日志,zabbix-agent会把收集到的日志，直接上报给zabbix-server的数据库。判断当前读取的待监测日志的当前字节数是否大于或等于所述字节计数器中的末次读取字节数；若所述当前字节数大于或等于所述末次读取字节数，所述预设代理自前次读取日志停止处继续读取待监测日志。若所述当前字节数小于所述末次读取字节数，所述预设代理从当前待监测日志的起始处开始重新读取日志。通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库，所述待监测日志内容包括用户的登录状态。在本步骤中，通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库包括：预设代理采集所述待监测服务器的多个待监测日志、并通过正则关系表达式匹配所述待监测日志内的关键字；将匹配成功的关键字所属待监测日志的待监测日志内容发送给预设服务器；所述预设服务器将接收到的所述待监测日志内容保存至所述预设数据库。zabbix-server收集到的日志格式如下，包含登录是否成功，访问IP，登录方式和账户等信息。具体形式可以如下：localhost sshd:Accepted password for root from 10.xx.xx.xxport 55454ssh2localhost sshd:Failed password for root from 10.xx.xx.xx port62826ssh2所述预设服务器将接收到的信息保存至所述预设数据库包括：所述预设代理获取待监测日志的末次读取字节数和末次修改时间并发送给预设服务器；所述预设服务器将所述末次读取字节数和所述日志末次修改时间记录在预设数据库，并发送给预设代理，以使所述预设代理基于前次读取日志停止处继续读取所述待监测日志。其中，所述预设服务器将所述字节数和所述日志末次修改时间记录在预设数据库包括：所述预设服务器将所述末次读取字节数记录在字节计数器中；所述预设服务器将所述日志末次修改时间记录在最新时间计数器中；所述字节计数器和所述最新时间计数器存储于所述预设数据库中。基于所述待监测日志内容及触发规则，确定触发器的状态。当所述触发器处于触发状态时，发出告警。所述告警通过触发器发出，所述触发规则包括：当用户的登入状态符合触发条件时，所述触发器处于触发状态发出告警，当用户的登入状态符合恢复条件时，所述触发器处于恢复状态。触发条件可以根据需要进行设定，例如一次异常登入立即触发触发器，或者设定的时长内异常登入次数符合设定值，或者连续几次登入时间异常等等。在zabbix系统web界面监控主机触发器处配置日志的触发告警规则，常用表达式如下：{log.str}＝1&amp;{Template OS Linux:log.nodata}＝0其中各表达式含义如下：log.str}＝1，表示如果字符串中包含"Failed"则表达式为真。log.nodata}＝0，表示60秒内有数据产生则表达式为真，即60秒内如果没有新数据了，则表达式为假。整个表达式的含义为：如果用户登录失败了，item返回数据中会包含"Failed"，则触发器被触发，60秒内没有新数据的话，触发器恢复。这样就保证了触发器不会一直在触发状态。在本示例中，逻辑为A&amp;B，表示同时符合A、B两个条件，触发器才会触发。zabbix系统web界面配置用户告警媒介。zabbix系统web界面添加动作，当配置的主机触发器触发后用配置好的告警媒介发出告警，通知运维人员。本发明的有益效果：利用zabbix平台提供查看服务器异常登录日志的界面，以及可通过规则匹配实现的告警功能，能有效的减少人为从每一个服务器检查日志的人力资源消耗，同时能提供及时的异常告警，有效的降低了服务器异常登录发现的滞后性，提高了服务器和系统的安全性。请参阅图4，本发明提供一种服务器登入异常的监测装置，包括：获取模块100、处理模块200以及告警模块300。其中，获取模块100通过预设代理获取待监测服务器的多个待监测日志内容并保存至预设数据库，所述待监测日志内容包括用户的登录状态；处理模块200基于所述待监测日志内容及触发规则，确定触发器的状态；告警模块当所述触发器处于触发状态时，发出告警。本发明提供一种电子设备，所述电子设备包括：一个或多个处理器；存储装置，用于存储一个或多个程序，当所述一个或多个程序被所述一个或多个处理器执行时，使得所述电子设备实现所述的服务器登入异常的监测方法。图5示出了适于用来实现本申请实施例的电子设备的计算机系统的结构示意图。需要说明的是，图5示出的电子设备的计算机系统400仅是一个示例，不应对本申请实施例的功能和使用范围带来任何限制。如图5所示，计算机系统400包括中央处理单元401，其可以根据存储在只读存储器402中的程序或者从储存部分408加载到随机访问存储器403中的程序而执行各种适当的动作和处理，例如执行上述实施例中所述的方法。在RAM 403中，还存储有系统操作所需的各种程序和数据。CPU 401、ROM 402以及RAM 403通过总线404彼此相连。输入/输出接口405也连接至总线404。以下部件连接至I/O接口405：包括键盘、鼠标等的输入部分406；包括诸如阴极射线管、液晶显示器等以及扬声器等的输出部分407；包括硬盘等的储存部分408；以及包括诸如LAN卡、调制解调器等的网络接口卡的通信部分409。通信部分409经由诸如因特网的网络执行通信处理。驱动器410也根据需要连接至I/O接口405。可拆卸介质411，诸如磁盘、光盘、磁光盘、半导体存储器等等，根据需要安装在驱动器410上，以便于从其上读出的计算机程序根据需要被安装入储存部分408。特别地，根据本申请的实施例，上文参考流程图描述的过程可以被实现为计算机软件程序。例如，本申请的实施例包括一种计算机程序产品，其包括承载在计算机可读介质上的计算机程序，该计算机程序包含用于执行流程图所示的方法的计算机程序。在这样的实施例中，该计算机程序可以通过通信部分409从网络上被下载和安装，和/或从可拆卸介质411被安装。在该计算机程序被中央处理单元401执行时，执行本申请的系统中限定的各种功能。本申请的另一方面还提供了一种存储介质，所述存储介质上存储有计算机程序，当所述计算机程序被处理器执行时，实现所述的服务器登入异常的监测方法。该存储介质可以是上述实施例中描述的电子设备中所包含的，也可以是单独存在，而未装配入该电子设备中。需要说明的是，本申请实施例所示的存储介质为计算机可读介质，所述计算机可读介质可以是计算机可读信号介质或者计算机可读存储介质或者是上述两者的任意组合。计算机可读存储介质例如可以是电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。计算机可读存储介质的更具体的例子可以包括但不限于：具有一个或多个导线的电连接、便携式计算机磁盘、硬盘、随机访问存储器、只读存储器、可擦式可编程只读存储器、闪存、光纤、便携式紧凑磁盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。在本申请中，计算机可读的信号介质可以包括在基带中或者作为载波一部分传播的数据信号，其中承载了计算机可读的计算机程序。这种传播的数据信号可以采用多种形式，包括但不限于电磁信号、光信号或上述的任意合适的组合。计算机可读的信号介质还可以是计算机可读存储介质以外的任何计算机可读介质，该计算机可读介质可以发送、传播或者传输用于由指令执行系统、装置或者器件使用或者与其结合使用的程序。计算机可读介质上包含的计算机程序可以用任何适当的介质传输，包括但不限于：无线、有线等等，或者上述的任意合适的组合。附图中的流程图和框图，图示了按照本申请各种实施例的系统、方法和计算机程序产品的可能实现的体系架构、功能和操作。其中，流程图或框图中的每个方框可以代表一个模块、程序段、或代码的一部分，上述模块、程序段、或代码的一部分包含一个或多个用于实现规定的逻辑功能的可执行指令。也应当注意，在有些作为替换的实现中，方框中所标注的功能也可以以不同于附图中所标注的顺序发生。例如，两个接连地表示的方框实际上可以基本并行地执行，它们有时也可以按相反的顺序执行，这依所涉及的功能而定。也要注意的是，框图或流程图中的每个方框、以及框图或流程图中的方框的组合，可以用执行规定的功能或操作的专用的基于硬件的系统来实现，或者可以用专用硬件与计算机指令的组合来实现。描述于本申请实施例中所涉及到的单元可以通过软件的方式实现，也可以通过硬件的方式来实现，所描述的单元也可以设置在处理器中。其中，这些单元的名称在某种情况下并不构成对该单元本身的限定。上述实施例仅示例性说明本发明的原理及其功效，而非用于限制本发明。任何熟悉此技术的人士皆可在不违背本发明的精神及范畴下，对上述实施例进行修饰或改变。因此，但凡所属技术领域中具有通常知识者在未脱离本发明所揭示的精神与技术思想下所完成的一切等效修饰或改变，仍应由本发明的权利要求所涵盖。
