标题title
基于像素环置乱的图像加密方法
摘要abst
本发明涉及加密传输技术领域，具体涉及基于像素环置乱的图像加密方法，包括：构建加密字典；对待加密图像进行扫描得到像素环；获取置乱次数及第一加密字典；获取像素环中的待置乱像素点，根据第一加密字典及置乱次数对像素环置乱；根据置乱后的像素环得到密文图像。本发明构建的加密字典数据量小，密钥空间大，可抵抗暴力破解攻击；本发明利用像素环置乱的方法，既打破了像素点之间的关联性，又通过像素环上像素点链式置乱的方式，使得密文图像具有非常好的雪崩效应及密钥敏感性，可抵抗统计分析攻击。
权利要求书clms
1.基于像素环置乱的图像加密方法，其特征在于，该方法包括以下步骤：S1:构建多个加密字典；S2:获取待加密图像，对待加密图像中所有像素点利用第一预设扫描方法进行扫描，按照扫描顺序将待加密图像中的所有像素点依次顺时针放入到圆环中得到像素环；S3:将待加密图像中像素点的个数作为置乱次数；构建一个空的已置乱像素点集合；选择一个加密字典作为第一加密字典；将第一个放入到像素环中的像素点作为待置乱像素点；初始化一个取值为0的重复次数；根据所述第一加密字典对待置乱像素点进行置乱操作，包括：S301:根据待置乱像素点的序号以及待置乱像素点的、以及通道的值获取待置乱像素点的置乱编码；将待置乱像素点的置乱编码在所述第一加密字典中对应的置乱编号作为待置乱像素点的置乱编号；S302:将像素环上顺时针方向以待置乱像素点为开始的第置乱编号个像素点作为待置乱像素点的第一像素点；获取所述第一像素点在像素环上顺时针方向的下一个像素点作为待置乱像素点的第二像素点；将待置乱像素点插入到所述第一像素点与所述第二像素点中间的位置；将待置乱像素点添加到已置乱像素点集合；S303:将所述第二像素点作为预估待置乱像素点，根据已置乱像素点集合对预估待置乱像素点进行停止点判断操作，并更新重复次数；当预估待置乱像素点为停止点时，将下一个加密字典作为第一加密字典，将第一个放入到像素环中的像素点作为待置乱像素点；当预估待置乱像素点不为停止点时，将预估待置乱像素点作为待置乱像素点；S4:重复置乱操作，直到重复次数等于置乱次数时停止；S5:对置乱后的像素环上的每个像素点按照顺时针方向利用第二预设扫描方法放入空白的图像，得到密文图像。2.根据权利要求1所述的基于像素环置乱的图像加密方法，其特征在于，所述构建多个加密字典包括：获取所有长度为第一预设位数的二进制串，记为置乱编码；为每个置乱编码进行多次随机编号，得到构建多个加密字典。3.根据权利要求1所述的基于像素环置乱的图像加密方法，其特征在于，所述根据待置乱像素点的序号以及待置乱像素点的、以及通道的值获取待置乱像素点的置乱编码包括：将待置乱像素点、以及通道的值分别转换为通道位二进制数、通道位二进制数、通道位二进制数；将通道位二进制数后第二预设位数的比特位作为通道的置乱元素；将通道位二进制数后第三预设位数的比特位作为通道的置乱元素；将通道位二进制数后第四预设位数的比特位作为通道的置乱元素；所述第二预设位数、第三预设位数以及第四预设位数之和等于第一预设位数；根据待置乱像素点的序号获取待置乱像素点的拼接顺序；根据所述拼接顺序将待置乱像素点通道的置乱元素、通道的置乱元素以及通道的置乱元素拼接起来，得到待置乱像素点的置乱编码。4.根据权利要求1所述的基于像素环置乱的图像加密方法，其特征在于，所述对预估待置乱像素点进行停止点判断操作包括：获取预估待置乱像素点的置乱编码；当预估待置乱像素点的序号小于第一预设阈值与置乱次数的乘积，且预估待置乱像素点属于已置乱像素点集合，且预估待置乱像素点的置乱编码与已置乱像素点集合中对应的已置乱像素点的置乱编码相同时，预估待置乱像素点为停止点；当预估待置乱像素点的序号大于或等于第一预设阈值与置乱次数的乘积，或预估待置乱像素点不属于已置乱像素点集合，或预估待置乱像素点的置乱编码与已置乱像素点集合中对应的已置乱像素点的置乱编码不相同时，预估待置乱像素点不为停止点。5.根据权利要求1所述的基于像素环置乱的图像加密方法，其特征在于，所述更新重复次数包括：当预估待置乱像素点为停止点，将重复次数重置为0；当预估待置乱像素点不为停止点时，将重复次数加一。6.根据权利要求1所述的基于像素环置乱的图像加密方法，其特征在于，所述根据待置乱像素点的序号获取待置乱像素点的拼接顺序包括：将待置乱像素点的序号除以6取余数，得到待置乱像素点的拼接顺序编号；将所述拼接顺序编号对应拼接顺序作为待置乱像素点的拼接顺序。7.根据权利要求1所述的基于像素环置乱的图像加密方法，其特征在于，所述第一预设扫描方式包括但不限于zigzag扫描、蛇形扫描、Hilbert扫描。8.根据权利要求1所述的基于像素环置乱的图像加密方法，其特征在于，所述第二预设扫描方式包括但不限于zigzag扫描、蛇形扫描、Hilbert扫描。
说明书desc
技术领域本发明涉及加密传输技术领域，具体涉及基于像素环置乱的图像加密方法。背景技术随着科技的发展，图像不断的产生，并在互联网中频繁传输。而图像可能涉及个人隐私、商业机密等，如个人照片、共享桌面等。为确保图像在传输过程中的机密性，需要对图像进行加密。图像具有冗余度高的特点，如图像中一个的图像特征内部像素点灰度高度相似。同时图像具有像素之间关联性强的特点，如图像中不同像素区域之间存在着相似的灰度过度关系，不同色块之间的分布关系具有规律性和关联性。传统的加密算法如AES、DSE等更适合于文本的加密，采用传统的加密算法难以打破像素之间的关联性、改变冗余度，易造成图像信息泄露。发明内容本发明提供基于像素环置乱的图像加密方法，以解决现有的问题。本发明的基于像素环置乱的图像加密方法采用如下技术方案：本发明一个实施例提供了基于像素环置乱的图像加密方法，该方法包括以下步骤：S1:构建多个加密字典；S2:获取待加密图像，对待加密图像中所有像素点利用第一预设扫描方法进行扫描，按照扫描顺序将待加密图像中的所有像素点依次顺时针放入到圆环中得到像素环；S3:将待加密图像中像素点的个数作为置乱次数；构建一个空的已置乱像素点集合；选择一个加密字典作为第一加密字典；将第一个放入到像素环中的像素点作为待置乱像素点；初始化一个取值为0的重复次数；根据所述第一加密字典对待置乱像素点进行置乱操作，包括：S301:根据待置乱像素点的序号以及待置乱像素点的、以及通道的值获取待置乱像素点的置乱编码；将待置乱像素点的置乱编码在所述第一加密字典中对应的置乱编号作为待置乱像素点的置乱编号；S302:将像素环上顺时针方向以待置乱像素点为开始的第置乱编号个像素点作为待置乱像素点的第一像素点；获取所述第一像素点在像素环上顺时针方向的下一个像素点作为待置乱像素点的第二像素点；将待置乱像素点插入到所述第一像素点与所述第二像素点中间的位置；将待置乱像素点添加到已置乱像素点集合；S303:将所述第二像素点作为预估待置乱像素点，根据已置乱像素点集合对预估待置乱像素点进行停止点判断操作，并更新重复次数；当预估待置乱像素点为停止点时，将下一个加密字典作为第一加密字典，将第一个放入到像素环中的像素点作为待置乱像素点；当预估待置乱像素点不为停止点时，将预估待置乱像素点作为待置乱像素点；S4:重复置乱操作，直到重复次数等于置乱次数时停止；S5:对置乱后的像素环上的每个像素点按照顺时针方向利用第二预设扫描方法放入空白的图像，得到密文图像。优选的，所述构建多个加密字典包括：获取所有长度为第一预设位数的二进制串，记为置乱编码；为每个置乱编码进行多次随机编号，得到构建多个加密字典。优选的，所述根据待置乱像素点的序号以及待置乱像素点的、以及通道的值获取待置乱像素点的置乱编码包括：将待置乱像素点、以及通道的值分别转换为通道位二进制数、通道位二进制数、通道位二进制数；将通道位二进制数后第二预设位数的比特位作为通道的置乱元素；将通道位二进制数后第三预设位数的比特位作为通道的置乱元素；将通道位二进制数后第四预设位数的比特位作为通道的置乱元素；所述第二预设位数、第三预设位数以及第四预设位数之和等于第一预设位数；根据待置乱像素点的序号获取待置乱像素点的拼接顺序；根据所述拼接顺序将待置乱像素点通道的置乱元素、通道的置乱元素以及通道的置乱元素拼接起来，得到待置乱像素点的置乱编码。优选的，所述对预估待置乱像素点进行停止点判断操作包括：获取预估待置乱像素点的置乱编码；当预估待置乱像素点的序号小于第一预设阈值与置乱次数的乘积，且预估待置乱像素点属于已置乱像素点集合，且预估待置乱像素点的置乱编码与已置乱像素点集合中对应的已置乱像素点的置乱编码相同时，预估待置乱像素点为停止点；当预估待置乱像素点的序号大于或等于第一预设阈值与置乱次数的乘积，或预估待置乱像素点不属于已置乱像素点集合，或预估待置乱像素点的置乱编码与已置乱像素点集合中对应的已置乱像素点的置乱编码不相同时，预估待置乱像素点不为停止点。优选的，所述更新重复次数包括：当预估待置乱像素点为停止点，将重复次数重置为0；当预估待置乱像素点不为停止点时，将重复次数加一。优选的，所述根据待置乱像素点的序号获取待置乱像素点的拼接顺序包括：将待置乱像素点的序号除以6取余数，得到待置乱像素点的拼接顺序编号；将所述拼接顺序编号对应拼接顺序作为待置乱像素点的拼接顺序。优选的，所述第一预设扫描方式包括但不限于zigzag扫描、蛇形扫描、Hilbert扫描。优选的，所述第二预设扫描方式包括但不限于zigzag扫描、蛇形扫描、Hilbert扫描。本发明的有益效果是：构建加密字典；对待加密图像进行扫描得到像素环；获取置乱次数及第一加密字典；获取像素环中的待置乱像素点，根据第一加密字典及置乱次数对像素环置乱；根据置乱后的像素环得到密文图像。本发明构建的加密字典数据量小，密钥空间大，可抵抗暴力破解攻击；本发明利用像素环置乱的方法，既打破了像素点之间的关联性，又通过像素环上像素点链式置乱的方式，使得密文图像具有非常好的雪崩效应，即改变待加密图像中的一个像素点可使得密文图像大不相同。同时本发明通过像素环上像素点链式置乱的方式，使得密文图像具有非常高的密钥敏感性，即改变加密字典中一个置乱编号可使得密文图像大不相同。可抵抗统计分析攻击。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明的基于像素环置乱的图像加密方法的步骤流程图；图2为本发明的基于像素环置乱的图像加密方法的一种加密字典示意图；图3为本发明的基于像素环置乱的图像加密方法的一种像素环获取示意图；图4为本发明的基于像素环置乱的图像加密方法的一种拼接顺序示意图；图5为本发明的基于像素环置乱的图像加密方法的一种像素环置乱示意图。具体实施方式为了更进一步阐述本发明为达成预定发明目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据本发明提出的基于像素环置乱的图像加密方法，其具体实施方式、结构、特征及其功效，详细说明如下。在下述说明中，不同的“一个实施例”或“另一个实施例”指的不一定是同一实施例。此外，一或多个实施例中的特定特征、结构或特点可由任何合适形式组合。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。下面结合附图具体的说明本发明所提供的基于像素环置乱的图像加密方法的具体方案。请参阅图1，其示出了本发明一个实施例提供的基于像素环置乱的图像加密方法的步骤流程图，该方法包括以下步骤：101．获取所有长度为第一预设位数的二进制串作为置乱编码，为每个置乱编码进行多次随机编号，得到多个加密字典。本发明实施例将图像转换为像素环，通过置乱像素环上的像素点的位置达到整个图像置乱加密的目的。因此需构建加密字典，根据加密字典确定每个像素点置乱的方法。获取所有长度为的二进制串，将此些二进制串作为置乱编码。长度为的二进制串共有种，则置乱编码共有种。为此些置乱编码进行到的随机编号，将置乱编码与编号的对应结果作为加密字典。为此些置乱编码进行到的随机编号，共有种可能的编号方式，即加密字典的复杂度为。为避免后期置乱时陷入循环，为置乱码进行次随机编号，得到个加密字典。本发明实施例，在其他实施例中实施人员可根据需要设置的值。当时，较小，加密字典存在被暴力破解的可能性，因此。由于后对像素环上的像素点进行置乱时需要为每个像素点分配一个置乱编码。每个像素点的置乱码依据像素点的RGB值来获得。而RGB值转换为二进制长度为。因此。本发明实施例中，在其他实施例中实施人员可根据需要设置的值。本发明实施例中加密字典复杂度大，可抵抗暴力破解攻击。一种可能的加密字典示意图参见图2。至此，获取了加密字典。将所有加密字典事先保存在加密端和解密端。102．获取待加密图像，对待加密图像中所有像素点进行扫描得到像素环。随着科技的发展，图像不断的产生，并在互联网中频繁传输。为确保图像在传输过程中的机密性，需要对图像进行加密。首先获取待加密的RGB图像，对待加密图像中所有像素点利用第一预设扫描方法进行扫描，本发明实施例采用的第一预设扫描方法为zigzag扫描，在其他实施例中实施人员可根据需要选择扫描方式，包括但不限于zigzag扫描、蛇形扫描、Hilbert扫描。将待加密图像大小记为。按照扫描顺序将所有像素点依次顺时针放入到一个圆环中，得到像素环。本发明以一个的图像为例，一种像素环获取示意图参见图3。至此，获取了像素环。103．获取置乱次数、第一加密字典以及重复次数，对像素环中的待置乱像素点进行置乱操作，得到密文图像。具体过程如下：1．获取置乱次数、第一加密字典以及重复次数。对图像进行置乱，目的是为了通过改变像素点的位置来破坏像素点之间的关联性，因此，将像素点的个数设置为置乱次数，尽可能使得每个像素点的位置都被改变。置乱次数用来表示。将所有加密字典中的第一个加密字典作为第一加密字典。设置一个重复次数，此时重复次数。将第一个放像素环的像素点作为待置乱像素点。2．对像素环中的待置乱像素点进行置乱操作。具体包括如下步骤：a．获取待置乱像素点的置乱元素。每个像素点的通道、通道、通道的值的取值范围为。将待置乱像素点通道、通道、通道的值分别转换为通道位二进制数、通道位二进制数、通道位二进制数。由于图像具有冗余度高、像素之间关联性强的特点，即相邻像素点的像素值差异较小。相邻像素点的像素值差异较小，在像素值转换成的位二进制数中表现为，相邻像素点的像素值8位二进制数的高位相同，低位存在差异。若相邻像素点的置乱编码相同，相邻像素点分别置乱后仍处于相邻的位置，此时未破坏相邻像素点之间的关联性，置乱效果差。因此本发明实施例根据待置乱像素点的通道位二进制数、通道位二进制数、通道位二进制数的低位来获取待置乱像素点的置乱编码，使得像素值差异较小的相邻像素点置乱编码不同。避免相邻像素点的置乱编码相同使得相邻像素点分别置乱后仍处于相邻的位置而导致置乱效果差的问题。置乱编码为位，获取待置乱像素点的通道位二进制数的后个比特位作为通道的置乱元素，获取待置乱像素点的通道位二进制数的后个比特位作为通道的置乱元素，获取待置乱像素点的通道位二进制数的后个比特位作为通道的置乱元素。其中需满足：，本实施例中。在其他实施例中，实施人员可根据需要设置以及的值。b．获取待置乱像素点的拼接顺序。将待置乱像素点每个通道的置乱元素拼接起来，即可得到位的置乱编码。但由于图像具有冗余度高的特点，部分相邻的像素点像素值相同。像素值相同的相邻像素点的对应通道的置乱元素均相同。对于像素值相同的相邻像素点，若按照相同的顺序将每个通道的置乱元素拼接起来，得到的置乱编码也相同。若相邻像素点的置乱编码相同，相邻像素点分别置乱后仍处于相邻的位置，此时未破坏相邻像素点之间的关联性，置乱效果差。因此，本发明实施例为不同的待置乱像素点设置不同的拼接顺序，使其得到的置乱编码不同，从而破坏像素点之间的关联性，达到更好的置乱效果。获取待置乱像素点拼接顺序的方法如下：三个置乱元素共有种排列方式，因此存在种拼接顺序。获取待置乱像素点的序号，根据序号获取待置乱像素点的拼接顺序编号：。其中为第个待置乱像素点的拼接顺序编号；为取余数符号。则拼接顺序编号可能的取值为。每种拼接顺序编号对应一种拼接顺序。一种拼接顺序编号与拼接顺序的对应关系参见图4。至此，获取了待置乱像素点的拼接顺序。c．获取待置乱像素点的置乱编号，根据置乱编码对待置乱像素点进行置乱。将待置乱像素点的通道的置乱元素、通道的置乱元素以及通道的置乱元素按照待置乱像素点的拼接顺序拼接起来，得到待置乱像素点的置乱编码。本发明实施例根据待置乱像素点的序号以及待置乱像素点的、以及通道的值获取待置乱像素点的置乱编码，可尽可能使得像素环上相邻像素点的置乱编码不相同，破坏了像素点之间的关联性，避免了相邻像素点的置乱编码相同使得相邻像素点分别置乱后仍处于相邻的位置而导致置乱效果差的问题，可达到更好的置乱效果。在第一加密字典中查找待置乱像素点的置乱编码对应的置乱编号，作为待置乱像素点的置乱编号。获取像素环上顺时针方向以当前待置乱像素点为开始的第置乱编号个像素点，将其作为待置乱像素点的第一像素点。获取待置乱像素点的第一像素点的下一个像素点作为待置乱像素点的第二像素点。将当前待置乱像素点插入到第一像素点与第二像素点中间的位置，完成当前待置乱像素点的置乱。d．获取预估待置乱像素点，对预估待置乱像素点进行停止点判断操作。将当前待置乱像素点标记为已置乱像素点，放入已置乱像素点集合。将该已置乱像素点的第二像素点作为预估待置乱像素点。在置乱过程中，可能出现预估待置乱像素点前期已置乱，即预估待置乱像素点为已置乱像素点集合中的像素点。由于待置乱像素点的置乱编码是根据待置乱像素点的序号获取，而预估待置乱像素点的序号与已置乱像素点为待置乱像素点时的序号不相同。因此，大部分情况下，预估待置乱像素点与前期置乱时的置乱编码不同，则置乱位置不同。但在极端情况下，可能存在预估待置乱像素点前期已置乱，并且预估待置乱像素点与前期置乱时的置乱编码相同，此时可能会导致置乱陷入循环，仅部分像素点循环置乱。待置乱像素点的置乱编码根据待置乱像素点的序号获取，使得置乱陷入循环的可能性很小，但仍有一定概率会发生。因此，需要判断预估待置乱像素点是否会导致置乱陷入循环，从而影响置乱效果。当循环发生在置乱前期时，仅小部分像素点参与置乱，此时置乱效果差。当循环发生在置乱后期时，大部分像素点已完成置乱，此时置乱陷入循环对最终置乱效果影响较小。因此，当预估待置乱像素点的序号小于时，判断预估待置乱像素点是否属于已置乱像素点集合。若预估待置乱像素点属于已置乱像素点集合，则判断预估待置乱像素点与集合中对应的已置乱像素点置乱时的置乱编码是否相同。若预估待置乱像素点与集合中对应的已置乱像素点置乱时的置乱编码相同，则会导致置乱陷入循环，置乱效果差，此时预估待置乱像素点为停止像素点。若预估待置乱像素点与集合中对应的已置乱像素点置乱时的置乱编码不相同，则不会导致置乱陷入循环，此时预估待置乱像素点不为停止像素点。若预估待置乱像素点不属于已置乱像素点集合，则也不会导致置乱陷入循环，此时预估待置乱像素点不为停止像素点。若预估待置乱像素点的序号大于等于时，认为已经达到置乱后期，不判断预估待置乱像素点是否属于已置乱像素点集合，此时预估待置乱像素点不为停止像素点。其中为置乱次数，为第一预设阈值，本发明实施例中。在其他实施例中实施人员可根据需要设置的值。当预估待置乱像素点不为停止像素点时，将预估待置乱像素点作为当前待置乱像素点，重复次数加一。当预估待置乱像素点为停止像素点时，停止当前置乱操作。将下一个加密字典作为第一加密字典。将第一个放入像素环的像素点作当前待置乱像素点，重复次数置为0。至此，完成了一次置乱操作。3．重复置乱操作，直到重复次数等于置乱次数时停止。根据置乱后的像素环得到密文图像。重复置乱操作，直到重复次数等于置乱次数时停止置乱。至此，完成了像素点的置乱，置乱后的像素环称为置乱像素环。一种像素环置乱示意图参见图5。从最后一个置乱的像素点开始，按照顺时针方向，将置乱像素环上的所有像素点利用第二预设扫描方法的顺序放入到一个大小的空矩阵中。所得结果即为密文图像。本发明实施例采用的第二预设扫描方法为蛇形扫描，在其他实施例中实施人员可根据需要选择第二预设扫描方法，包括但不限于zigzag扫描、蛇形扫描、Hilbert扫描。104．对密文图像进行传输解密。加密端将密文图像与所采用的加密字典编号共同传输至解密端。解密端对密文图像进行解密。解密端根据加密字典编号确定密文图像所采用的第一加密字典。解密端按照第二预设扫描方法对密文图像进行扫描，获取置乱像素环。以第一个放入置乱像素环的像素点为开始，将其作为待置乱像素点，对待置乱像素点从置乱次数开始倒着编号。根据待置乱像素点的通道、通道、通道的值以及序号获取待置乱像素点的置乱编码。在第一加密字典中获取置乱编号。根据置乱编号在像素环上按照逆时针的顺序进行置乱。直到待置乱像素点的序号为0时停止。在解密过程中，不进行预估待置乱像素点是否为停止像素点的判断。以序号为1的待置乱像素点为开始，按照顺时针的方向将像素环中所有像素点按照第一预设扫描方法的顺序放入到一个大小的空矩阵中。所得结果即为加密前的图像。至此，完成数据的解密。通过以上步骤，完成图像的加密传输与解密。本发明实施例通过构建加密字典；对待加密图像进行扫描得到像素环；获取置乱次数及第一加密字典；获取像素环中的待置乱像素点，根据第一加密字典及置乱次数对像素环置乱；根据置乱后的像素环得到密文图像。本发明构建的加密字典数据量小，密钥空间大，可抵抗暴力破解攻击；本发明利用像素环置乱的方法，即打破了像素点之间的关联性，又通过像素环上像素点链式置乱的方式，使得密文图像具有非常好的雪崩效应，即改变待加密图像中的一个像素点可使得密文图像大不相同。同时本发明通过像素环上像素点链式置乱的方式，使得密文图像具有非常高的密钥敏感性，即改变加密字典中一个置乱编号可使得密文图像大不相同。可抵抗统计分析攻击。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
