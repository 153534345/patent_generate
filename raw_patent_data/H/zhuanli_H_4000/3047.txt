标题title
一种用户行为基线生成方法及相关装置
摘要abst
本申请涉及一种用户行为基线生成方法及相关装置，用于提高用户行为基线的准确性，同时降低计算复杂度，该方法为：针对目标属性，将当前属性信息加入至历史访问记录中后，基于历史访问记录中包含的各历史属性信息和当前属性信息的加入顺序，以及基于各历史属性信息分别与当前属性信息之间的加入时间间隔，确定当前属性信息和各历史属性信息各自对应的目标权重，然后，将当前属性信息和各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，生成用户行为基线。
权利要求书clms
1.一种用户行为基线生成方法，其特征在于，包括：响应于目标对象针对目标业务触发的登录成功操作，获取所述登录成功操作中目标属性对应的当前属性信息；将所述当前属性信息加入至历史访问记录中，所述历史访问记录中包含有：所述目标对象针对所述目标业务触发的所述目标属性对应的各历史属性信息；基于所述当前属性信息和所述各历史属性信息的加入顺序，以及基于所述各历史属性信息分别与所述当前属性信息之间的加入时间间隔，确定所述当前属性信息和所述各历史属性信息各自对应的目标权重；将所述当前属性信息和所述各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，从所述当前属性信息和所述各历史属性信息中，确定出至少一个常用属性信息；基于所述目标属性和所述至少一个常用属性信息，生成用户行为基线。2.如权利要求1所述的方法，其特征在于，所述基于所述当前属性信息和所述各历史属性信息的加入顺序，以及基于所述各历史属性信息分别与所述当前属性信息之间的加入时间间隔，确定所述当前属性信息和所述各历史属性信息各自对应的目标权重，包括：针对所述当前属性信息和所述各历史属性信息，分别执行以下操作：将当前属性信息和所述各历史属性信息中的一个属性信息，作为目标属性信息，并基于所述加入顺序，确定所述目标属性信息对应的初始权重；基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，确定所述目标属性信息对应的权重修正值；基于所述初始权重和所述权重修正值，确定所述目标属性信息对应的目标权重。3.如权利要求2所述的方法，其特征在于，所述基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，确定所述目标属性信息对应的权重修正值，包括：基于所述目标属性信息与相邻属性信息之间的加入时间间隔，确定所述目标属性信息对应的参考时间间隔；所述相邻属性信息是指按照所述加入顺序与所述目标属性信息相邻的属性信息；基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，以及基于所述参考时间间隔，确定所述目标属性信息对应的权重修正值。4.如权利要求3所述的方法，其特征在于，所述基于所述目标属性信息与相邻属性信息之间的加入时间间隔，确定所述目标属性信息对应的参考时间间隔，包括：若所述目标属性信息为所述当前属性信息或最早加入所述历史访问记录的历史属性信息，则将所述目标属性信息与对应的一个相邻属性信息之间的加入时间间隔，作为所述目标属性信息对应的参考时间间隔；若所述目标属性信息不为所述当前属性信息和最早加入所述历史访问记录的历史属性信息，则将对应的两个相邻属性信息之间的入队时间间隔的平均值，作为所述目标属性信息对应的参考时间间隔。5.如权利要求3所述的方法，其特征在于，所述基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，以及基于所述参考时间间隔，确定所述目标属性信息对应的权重修正值，包括：若所述当前属性信息与所述目标属性信息之间的加入时间间隔，小于参考加入时长，则确定所述目标属性信息对应的权重修正值为第一设定数值；若所述当前属性信息与所述目标属性信息之间的加入时间间隔，不小于所述参考加入时长，则将第二设定数值和差异数值中的最小值，作为所述目标属性信息对应的权重修正值，所述差异数值是指相应加入时间间隔和所述参考加入时长之间的差值与所述参考加入时长的比值；其中，所述参考加入时长是根据所述参考时间间隔和所述目标属性信息在所述加入顺序中的位置确定的。6.如权利要求2-5中任一项所述的方法，其特征在于，所述基于所述初始权重和所述权重修正值，确定所述目标属性信息对应的目标权重，包括：获取针对所述目标属性信息预设的容易度；基于所述初始权重和所述权重修正值，以及基于所述容易度，确定所述目标属性信息对应的目标权重。7.如权利要求1-5中任一项所述的方法，其特征在于，所述将所述当前属性信息加入至历史访问记录中，包括：基于前一时刻常用属性信息的个数，确定当前时刻常用属性信息的个数，并基于当前时刻常用属性信息的个数，确定常用信息数目阈值，其中，当前时刻是指获取所述当前属性信息的时刻，前一时刻是指所述各历史属性信息的最晚进入时刻；若当前时刻常用属性信息的个数，大于所述常用信息数目阈值，则在所述历史访问记录中加入指定属性信息后，将所述当前属性信息加入所述历史访问记录。8.如权利要求7所述的方法，其特征在于，所述常用数据数目阈值采用以下公式计算得到：其中，H表示常用数据数目阈值，表示当前时刻常用属性信息的个数均值，countmax表示常用属性信息的历史最大个数，α、β均为预设参数，表示前一时刻常用属性信息的个数均值，count表示当前时刻常用属性信息的个数。9.如权利要求1-5中任一项所述的方法，其特征在于，所述基于权重累加值，从所述当前属性信息和所述各历史属性信息中，确定出至少一个常用属性信息，包括：针对所述当前属性信息和所述各历史属性信息中内容相同的属性信息，在所述权重累加值不小于预设权重阈值时，将所述内容相同的属性信息，作为常用属性信息；针对所述当前属性信息和所述各历史属性信息中，除所述内容相同的属性信息之外的其他属性信息，在所述其他属性信息的目标权重不小于预设权重阈值时，将所述其他属性信息，作为常用属性信息。10.一种用户行为基线生成装置，其特征在于，所述装置包括：获取单元，用于响应于目标对象针对目标业务触发的登录成功操作，获取所述登录成功操作中目标属性对应的当前属性信息；记录单元，用于将所述当前属性信息加入至历史访问记录中，所述历史访问记录中包含有：所述目标对象针对所述目标业务触发的所述目标属性对应的各历史属性信息；确定单元，用于基于所述当前属性信息和所述各历史属性信息的加入顺序，以及基于所述各历史属性信息分别与所述当前属性信息之间的加入时间间隔，确定所述当前属性信息和所述各历史属性信息各自对应的目标权重；累加单元，用于将所述当前属性信息和所述各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，从所述当前属性信息和所述各历史属性信息中，确定出至少一个常用属性信息；生成单元，用于基于所述目标属性和所述至少一个常用属性信息，生成用户行为基线。11.一种电子设备，其特征在于，所述电子设备至少包括处理器和存储器，所述处理器用于执行存储器中存储的计算机程序时实现如权利要求1-9中任一所述用户行为基线生成方法的步骤。12.一种计算机可读存储介质，其特征在于，其存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1-9中任一所述用户行为基线生成方法的步骤。13.一种计算机程序产品，其特征在于，所述计算机程序产品包括：计算机程序代码，当所述计算机程序代码在计算机上运行时，使得计算机执行上述如权利要求1-9中任一所述用户行为基线生成方法的步骤。
说明书desc
技术领域本申请涉及网络安全技术领域，特别涉及一种用户行为基线生成方法及相关装置。背景技术随着计算机网络的快速发展，如何基于用户行为基线，从海量的待识别行为中，识别出异常行为，对保证网络的安全尤为重要，其中，用户行为基线是指各种属性对应的常用属性信息集合，其中，属性可以是网际互连协议地址、物理地址、设备标识等。相关技术中，通常采用以下两种方式生成用户行为基线：第一种、基于机器学习的用户行为基线的生成方法。在第一种方式中，机器学习算法可以采用孤立森林、K均值聚类、时序分析等。但是，机器学习算法实现较为复杂，且需要大量的样本数据，在行为数据样本不足的情况下，难以保证异常行为识别准确率。此外，在实际中应用，为了满足实时性，用户行为每改变一次，均需要重新计算，影响识别性能。第二种、基于统计的用户行为基线的生成方法在第二种方式中，针对某一属性，将距当前时间最近的登录时间对应的属性信息作为常用属性信息，或者，将登录次数最多的属性信息作为常用属性信息。然而，单一维度的行为基线，无法真实的体现异常行为，导致计算出的常用属性信息与实际情况不符，难以识别保证准确性。发明内容本申请提供了一种用户行为基线生成方法及相关装置，用以提高用户行为基线的准确性，同时降低计算复杂度。第一方面，本申请实施例提供一种用户行为基线生成方法，包括：响应于目标对象针对目标业务触发的登录成功操作，获取所述登录成功操作中目标属性对应的当前属性信息；将所述当前属性信息加入至历史访问记录中，所述历史访问记录中包含有：所述目标对象针对所述目标业务触发的所述目标属性对应的各历史属性信息；基于所述当前属性信息和所述各历史属性信息的加入顺序，以及基于所述各历史属性信息分别与所述当前属性信息之间的加入时间间隔，确定所述当前属性信息和所述各历史属性信息各自对应的目标权重；将所述当前属性信息和所述各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，从所述当前属性信息和所述各历史属性信息中，确定出至少一个常用属性信息；基于所述目标属性和所述至少一个常用属性信息，生成用户行为基线。第二方面，本申请实施例提供一种用户行为基线生成装置，包括：获取单元，用于响应于目标对象针对目标业务触发的登录成功操作，获取所述登录成功操作中目标属性对应的当前属性信息；记录单元，用于将所述当前属性信息加入至历史访问记录中，所述历史访问记录中包含有：所述目标对象针对所述目标业务触发的所述目标属性对应的各历史属性信息；确定单元，用于基于所述当前属性信息和所述各历史属性信息的加入顺序，以及基于所述各历史属性信息分别与所述当前属性信息之间的加入时间间隔，确定所述当前属性信息和所述各历史属性信息各自对应的目标权重；累加单元，用于将所述当前属性信息和所述各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，从所述当前属性信息和所述各历史属性信息中，确定出至少一个常用属性信息；生成单元，用于基于所述目标属性和所述至少一个常用属性信息，生成用户行为基线。第三方面，本申请实施例提供一种电子设备，所述电子设备至少包括处理器和存储器，所述处理器用于执行存储器中存储的计算机程序时实现如上述所述用户行为基线生成方法的步骤。第四方面，本申请实施例提供一种计算机可读存储介质，其存储有计算机程序，所述计算机程序被处理器执行时实现如上述所述用户行为基线生成方法的步骤。第五方面，本申请实施例提供一种计算机程序产品，所述计算机程序产品包括：计算机程序代码，当所述计算机程序代码在计算机上运行时，使得计算机执行上述如上述所述用户行为基线生成方法的步骤。本申请实施例中，针对目标属性，将当前属性信息加入至历史访问记录中后，基于历史访问记录中包含的各历史属性信息和当前属性信息的加入顺序，以及基于各历史属性信息分别与当前属性信息之间的加入时间间隔，确定当前属性信息和各历史属性信息各自对应的目标权重，然后，将当前属性信息和各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，生成用户行为基线。这样，通过各历史属性信息和当前属性信息的加入顺序和相应时间间隔，可以获取时间维度上的行为基线，通过对内容相同的属性信息对应的目标权重进行累加，可以获取使用次数维度上的行为基线，生成的用户行为基线同时对时间和使用次数具有敏感性，从而提高了用户行为基线的准确性，进而提高了异常行为识别准确率，同时，降低了计算复杂度，提高了用户行为基线的生成效率，进而提升了异常行为识别性能。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本申请实施例中提供的一种用户行为基线生成方法的流程示意图；图2为本申请实施例中提供的一种队列的示意图；图3为本申请实施例中提供的一种目标权重的确定方法的流程示意图；图4为本申请实施例中提供的一种权重修正值的确定方法的流程示意图；图5为本申请实施例中提供的一种目标权重与索引号之间的映射关系；图6为本申请实施例中提供的一种确定目标权重的逻辑示意图；图7为本申请实施例中提供的一种确定最大常用属性信息个数的逻辑示意图；图8为本申请实施例中提供的空属性机制的逻辑示意图；图9为本申请实施例中提供的一种用户行为基线生成装置的结构示意图；图10为本申请实施例中提供的一种电子设备的结构示意图。具体实施方式为使本申请实施例的目的、技术方案和优点更加清楚，下面将结合本申请实施例中的附图，对本申请的技术方案进行清楚、完整地描述，显然，所描述的实施例是本申请技术方案的一部分实施例，而不是全部的实施例。基于本申请文件中记载的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本申请技术方案保护的范围。为了便于理解，先对本申请涉及的技术用语进行介绍：软件定义边界：基于零信任的新一代网络安全模型，通过软件定义的方式为企业或者组织机构在互联网上构建一个安全可信的虚拟边界。零信任：在假定网络环境已经被攻陷的前提下，当执行信息系统和服务中的每次访问请求时，降低其决策准确度的不确定性。用户行为基线：是指根据用户在登录和访问等过程中的各种行为，统计出来的各种常用属性的集合，例如，常用IP集合、常用登录地址集合，常用设备集合等。SDP构架中，通常情况下每个终端通常在连接服务器前必须进行身份验证，以确保与服务器连接的每个终端都是被允许接入的。通过SDP架构隐藏核心网络资产与设施，使之不直接暴露在互联网下，使得网络资产与设施免受外来安全威胁。通过SDP框架，分布式拒绝服务攻击、中间人攻击、漏洞扫描和高级持续性威胁)等攻击都被阻止。然而，对于用户在建立传输控制协议连接之后的异常认证和授权行为，如异常网络登录和异常时间段访问等，基于零信任的SDP框架难以做到实时的识别并拦截，如何提高异常行为的识别能力成为目前需要解决的问题。相关技术中，通常采用以下两种方式生成用户行为基线：第一种、基于机器学习的用户行为基线的生成方法。在第一种方式中，机器学习算法可以采用孤立森林、K均值聚类、时序分析等。但是，机器学习算法实现较为复杂，且需要大量的样本数据，在行为数据样本不足的情况下，难以保证异常行为识别准确率。此外，在实际中应用，为了满足实时性，用户行为每改变一次，均需要重新计算，影响识别性能。第二种、基于统计的用户行为基线的生成方法在第二种方式中，针对某一属性，将距当前时间最近的登录时间对应的属性信息作为常用属性信息，或者，将登录次数最多的属性信息作为常用属性信息。然而，单一维度的行为基线，往往无法真实的体现异常行为，导致计算出的常用属性信息与实际情况不符，难以识别保证准确性。有鉴于此，本申请实施例中，提供一种用户行为基线的生成方案，该方案包括：针对目标属性，将当前属性信息加入至历史访问记录中后，基于历史访问记录中包含的各历史属性信息和当前属性信息的加入顺序，以及基于各历史属性信息分别与当前属性信息之间的加入时间间隔，确定当前属性信息和各历史属性信息各自对应的目标权重，然后，将当前属性信息和各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，生成用户行为基线。这样，通过各历史属性信息和当前属性信息的加入顺序和相应时间间隔，可以获取时间维度上的行为基线，通过对内容相同的属性信息对应的目标权重进行累加，可以获取使用次数维度上的行为基线，生成的用户行为基线同时对时间和使用次数具有敏感性，从而提高了用户行为基线的准确性，进而提高了异常行为识别准确率，同时，降低了计算复杂度，提高了用户行为基线的生成效率，进而提升了异常行为识别性能。参见图1所示，为本申请实施例提供的一种用户行为基线生成方法的流程示意图，该方法流程可以由计算机、芯片、处理器或者服务器等具有运算功能的硬件设施来执行，该方法流程具体包括：S101、响应于目标对象针对目标业务触发的登录成功操作，获取登录成功操作中目标属性对应的当前属性信息。本申请实施例中，目标对象可以是指一个用户，也可以是指一个用户群组，用户群组中包含一个或多个用户。若目标对象为一个用户，终端响应于该用户针对目标业务触发的登录成功操作，获取目标属性对应的当前属性信息。若目标对象为一个群组，终端响应于群组中任意一个用户针对目标业务触发的登录成功操作，获取的目标属性对应的当前属性信息。目标业务包括但不限于终端与服务器连接后进行的认证、授权等业务。针对目标业务，当用户登录成功时，终端确定目标对象针对目标业务触发登录成功操作。登录成功可以是目标对象输入的口令或者目标对象的权限等信息通过校验，但不局限于此。目标属性可以是IP、终端标识或MAC地址，但不局限于此。属性信息也可以称为属性值。本文中，仅以目标属性为IP为例进行说明。例如，假设，目标对象为用户A，用户A使用IP：1.1.1.1登录成功时，响应于用户A针对目标业务触发的登录成功操作，获取目标属性IP对应的当前属性信息1.1.1.1。又例如，假设，目标对象为群组x，用户B为群组x中一个用户，用户B使用IP：2.2.2.2登录成功时，响应于群组x中的用户B针对目标业务触发的登录成功操作，获取目标属性IP对应的当前属性信息2.2.2.2。S102、将当前属性信息加入至历史访问记录中，历史访问记录中包含有：目标对象针对目标业务触发的目标属性对应的各历史属性信息。作为一种可能的实现方式，目标对象为一个用户，历史访问记录中包含有该用户针对目标业务触发的目标属性对应的各历史属性信息。仍以用户A为例，历史访问记录中包含用户A针对目标业务触发的各历史IP，各历史IP包括：1.1.2.1、1.1.1.1、1.1.6.1等。作为另一种可能的实现方式，目标对象为一个群组，历史访问记录中包含有该群组中所有用户针对目标业务触发的目标属性对应的各历史属性信息。仍以群组x为例，假设，群组x中包含用户B和用户C，历史访问记录中包含有用户A针对目标业务触发的各历史IP，以及包含用户B针对目标业务触发的各历史IP。本申请实施例中，历史访问记录可以采用先进先出的队列实现，也可以采用表格的形式实现，但不局限于此。本文中，仅以队列为例进行说明。参阅图2所示，其为本申请实施例中提供的一种队列的示意图，队列中包含IP0、IP1、IP2等20个IP属性信息，其中，IP0、IP1、IP2等20个IP属性信息的索引号依次为0至19，仅以IP0、IP1、IP2为例，IP0、IP1、IP2分别为1.1.2.1、1.1.1.1、1.1.2.1。将当前属性信息加入至队列中时，如果队列已满，进入队列时间最久的IP属性信息将会移出队列。需要说明的是，本申请实施例中，队列的索引号为从小到大排序，实际应用过程中，队列索引号也可以按照从大到小排序，对此不作限定。S103、基于当前属性信息和各历史属性信息的加入顺序，以及基于各历史属性信息分别与当前属性信息之间的加入时间间隔，确定当前属性信息和各历史属性信息各自对应的目标权重。S104、将当前属性信息和各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，从当前属性信息和各历史属性信息中，确定出至少一个常用属性信息。S105、基于目标属性和至少一个常用属性信息，生成用户行为基线。具体的，执行S105时，可以采用但不限于以下方式：针对当前属性信息和各历史属性信息中内容相同的属性信息，在权重累加值不小于预设权重阈值时，将内容相同的属性信息，作为常用属性信息；针对当前属性信息和各历史属性信息中，除内容相同的属性信息之外的其他属性信息，在其他属性信息的目标权重不小于预设权重阈值时，将其他属性信息，作为常用属性信息。示例性的，权重累加值可以采用以下公式计算得到：sum＝Σweight 公式其中，sum表示内容相同的属性信息对应的目标权重的累加值，weight表示当前属性信息的目标权重。例如，假设，图2所示的队列中，IP0为当前属性信息，IP1至IP19为历史属性信息，若IP0、IP2、IP3均为1.1.2.1，针对IP地址1.1.2.1，其权重累加值为IP0、IP2、IP3各自对应的目标权重的权重累加值，进而将权重累加值与预设权重阈值进行比较，若队列中仅IP1为1.1.1.1，那么，直接将IP1的目标权重与预设权重阈值进行比较。其中，预设权重阈值可以设置为队列长度，这样，一个属性信息进入队列后，就可以成为常用属性信息，而随着新属性信息入队，上述一个属性信息的目标权重将会减少，进而可能成为非常用属性信息。本申请实施例中，针对目标属性，将当前属性信息加入至历史访问记录中后，基于历史访问记录中包含的各历史属性信息和当前属性信息的加入顺序，以及基于各历史属性信息分别与当前属性信息之间的加入时间间隔，确定当前属性信息和各历史属性信息各自对应的目标权重，然后，将当前属性信息和各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，生成用户行为基线。这样，通过各历史属性信息和当前属性信息的加入顺序和相应时间间隔，可以获取时间维度上的行为基线，通过对内容相同的属性信息对应的目标权重进行累加，可以获取使用次数维度上的行为基线，生成的用户行为基线同时对时间和使用次数具有敏感性，从而提高了用户行为基线的准确性，进而提高了异常行为识别准确率，同时，降低了计算复杂度，提高了用户行为基线的生成效率，进而提升了异常行为识别性能。在一些实施例中，考虑到越长时间没有使用过的属性信息，其权重应该下降的更快，可以引入权重修正值，根据权重修正值，动态调节时间对权重的影响，具体的，执行S103时，参见图3，针对当前属性信息和各历史属性信息，分别执行以下步骤：S1031、将当前属性信息和各历史属性信息中的一个属性信息，作为目标属性信息，并基于加入顺序，确定目标属性信息对应的初始权重。由于队列中各属性信息是按照入队时间排序的，因此，队列中，当前属性信息和各历史属性信息的加入顺序，即为当前属性信息和各历史属性信息在队列中的顺序。示例性的，目标属性信息对应的初始权重可以是队列长度与索引号的差值。例如，图2的队列中，IP0为当前属性信息，IP1至IP19为各历史属性信息，IP0对应的初始权重为20-0＝20，IP1对应的初始权重为20-1＝19，IP2对应的初始权重为20-2＝18，类似的，IP3至IP19各自对应的初始权重分别为17至1。S1032、基于当前属性信息与目标属性信息之间的加入时间间隔，确定目标属性信息对应的权重修正值。在一些实施例中，考虑到当前属性信息与各历史属性信息之间的加入时间间隔对目标权重的影响，参见图4，执行S302时，可以采用以下步骤：S10321、基于目标属性信息与相邻属性信息之间的加入时间间隔，确定目标属性信息对应的参考时间间隔，其中，相邻属性信息是指按照加入顺序与目标属性信息相邻的属性信息。具体的，执行S10321时，存在以下两种情况：情况一：目标属性信息为当前属性信息或最早加入历史访问记录的历史属性信息，即目标属性信息是位于队首或队尾的属性信息，此时，目标属性信息存在一个相邻属性信息，将目标属性信息与对应的一个相邻属性信息之间的加入时间间隔，作为目标属性信息对应的参考时间间隔。例如，图2的队列中，最早加入历史访问记录的历史属性信息为IP19，当前属性信息为IP0，假设，目标属性信息为IP0，IP0的相邻属性信息为IP1，将IP0与IP1之间的加入时间间隔，作为IP0对应的参考时间间隔。又例如，假设，目标属性信息为IP19，IP19的相邻属性信息为IP18，将IP19与IP18之间的加入时间间隔，作为IP19对应的参考时间间隔。情况二：目标属性信息不为当前属性信息和最早加入历史访问记录的历史属性信息，即目标属性信息是位于除队首和队尾之外的属性信息，此时，目标属性信息存在两个相邻属性信息，将对应的两个相邻属性信息之间的加入时间间隔的平均值，作为目标属性信息对应的参考时间间隔。示例性的，参考时间间隔可以采用以下公式确定：其中，T表示目标属性信息对应的参考时间间隔，index为目标属性信息在队列中的索引号，tindex-1和tindex+1分别表示两个相邻属性信息的加入时间。若队列的长度为L，则index的取值范围为。例如，图2的队列中，若目标属性信息为IP1，IP1的相邻属性信息为IP0和IP2，将IP0和IP2之间的加入时间间隔的平均值，作为IP1对应的参考时间间隔，假设，IP0的加入时间为t0，IP2的加入时间为t2，IP1对应的参考时间间隔S10322、基于当前属性信息与目标属性信息之间的加入时间间隔，以及基于参考时间间隔，确定目标属性信息对应的权重修正值。具体的，执行S10322时，存在以下两种情况：情况A：若当前属性信息与目标属性信息之间的加入时间间隔，小于参考加入时长，则确定目标属性信息对应的权重修正值为第一设定数值。示例性的，第一设定数值可以为0。情况B：若当前属性信息与目标属性信息之间的加入时间间隔，不小于参考加入时长，则将第二设定数值和差异数值中的最小值，作为目标属性信息对应的权重修正值，差异数值是指相应加入时间间隔和参考加入时长之间的差值与参考加入时长的比值。其中，参考加入时长是根据参考时间间隔和目标属性信息在加入顺序中的位置确定的，即参考加入时长是根据参考时间间隔和目标属性信息的索引号确定的。示例性的，目标属性信息对应的权重修正值可以采用以下公式确定：其中，c表示目标属性信息对应的权重修正值，index为目标属性信息在队列中的索引号，tindex表示目标属性信息的加入时间，T表示目标属性信息对应的参考时间间隔，t0表示当前属性信息的索引号，min表示最小值函数。例如，图2的队列中，假设，目标属性信息为IP0，IP0对应的权重修正值为0。又例如，图2的队列中，假设，目标属性信息为IP3，假设，满足|t0-t3|-3×T≥2T，IP3对应的权重修正值为2。再例如，图2的队列中，假设，目标属性信息为IP4，假设，满足0＜|t0-t4|-4T≤T，IP4对应的权重修正值为1。S1033、基于初始权重和权重修正值，确定目标属性信息对应的目标权重。作为一种可能的实现方式，可以直接基于初始权重和权重修正值，确定目标属性信息对应的目标权重，示例性的，目标属性信息对应的目标权重可以采用以下公式计算：weight＝f＝length-index-c 公式其中，weight表示目标属性信息对应的目标权重，c表示目标属性信息对应的权重修正值，length表示队列长度，index表示目标属性信息的索引号，length与index的差值表示目标属性信息对应的初始权重。例如，图2的队列中，若目标属性信息为IP0，IP0对应的权重修正值为0，IP0对应的初始权重为20，IP0对应的目标权重为20-0＝20。又例如，图2的队列中，目标属性信息为IP3，IP3对应的初始权重为17，假设，IP3对应的权重修正值为2，IP3对应的目标权重为20-3-2＝15。再例如，图2的队列中，目标属性信息为IP4，IP4对应的初始权重为16，假设，IP4对应的权重修正值为1，IP4对应的目标权重为20-4-1＝15。显然，length-index反映了新进IP个数对队列中已有IP的权重造成的影响，c通过对权重变化做修正，反映所有入队IP间的时间间隔对权重造成的影响。可以理解的是，本申请中的当前属性信息也可以称为新IP属性信息，新IP属性信息的信息内容可以与各历史属性信息中的一个或多个历史属性信息相同，也可以与各历史属性信息均不同。参阅图5所示，由于在不考虑C函数的情况下，对目标权重的计算中采用了索引号作为参数，目标权重下降是线性的，这和每一次IP属性信息的进入的时间间隔Δt等长的情况相适应，即进入一个新IP属性信息+以等时间间隔进入新IP属性信息＝队列中的IP权重减1，也就是说，在队列中，新IP属性信息只能够一个一个地进入队列，所以进入新IP属性信息的个数是线性增加的，可认为其对目标权重的影响为定值。但是，由于目标权重的减少同时受进入新IP属性信息的个数和进入所有IP属性信息的时间间隔Δt的方差σ2的影响，而σ2越接近于0，认为更接近于等时间间隔进入。其中，X为变量值，即Δt，M为变量个数，μ为时间间隔Δt的平均值，一个IP属性信息的时间间隔Δt可以是该IP属性信息的加入队列时间与前一个属性信息加入队列时间的时间间隔。当一个IP属性信息进入队列的实际时间和预估时间差别很大时，认为σ2很大，如果σ2很大，目标权重受时间间隔的影响很大，所以短时间内进入新IP属性信息+时间间隔的方差σ2很大＝队列中对应IP属性信息的目标权重不变。所以，在进入的新IP属性信息的时间间隔Δt很短，进入的历史IP属性信息的时间间隔的方差很大的情况下，即使进入了新IP属性信息，对于队列中的历史IP属性信息而言，其权重会不变。参见图6，假设，针对IP：10.10.0.1，IP：10.10.0.1当前的索引值为3，即IP3为10.10.0.1，满足|t0-t3|-3×T≥2T，IP3对应的目标权重为：L-3-2，当进入一个新IP属性信息后，IP：10.10.0.1的索引值为4，即IP4为10.10.0.1，满足0＜|t0-t4|-4T≤T，IP4对应的目标权重为：L-4-1，当再次进入一个新IP属性信息后，IP：10.10.0.1的索引值为5，即IP5为10.10.0.1，满足|t0-t5|≤5T，IP5对应的目标权重为：L-5-0。可见，尽管连续进入了2个新IP属性信息，IP：10.10.0.1的目标权重一直为L-5，没有发生变化。这种情况不会一直持续，当连续进入时间间隔Δt很小的新IP属性信息后，σ2会逐渐减小，向零值靠近，接近于以等时间间隔进入新IP属性信息的情况，因此，队列中的IP属性信息的目标权重会在不变一段时间后开始线性减少。在一些实施例中，为了解决多个实际场景中，对成为常用IP的难度预期调整，例如，对于低授权级别的用户，其数量较多，安全风险较低，通过降低成为常用IP的难度，提高用户体验和运维效率，具体的，执行S2033时，包括：获取针对目标属性信息预设的容易度；基于初始权重和权重修正值，以及基于容易度，确定目标属性信息对应的目标权重。示例性的，目标属性信息对应的目标权重可以采用以下公式计算：weight＝f+N公式其中，weight表示目标权重，f采用公式计算得到，N为不小于0的整数。若N为非负整数，N表示一个属性信息成为常用属性信息的难易程度，N的取值越大，表示一个属性信息越容易成为常用属性信息。当N的取值越大，队列中，每一个IP属性信息对应的目标权重weight的取值也会越大，更加容易达到阈值，从而使得队列中的IP属性信息更容易成为常用IP，最大常用IP数量也会更大。参见图7，当预设权重阈值等于队列长度L的情况下，假设，不考虑C函数，在长度为L的队列里面，目标权重大于等于L的有L+N到L对应的属性信息，共N+1个，而剩下的L-个属性信息中，由于将头尾的属性信息的初始权重相加，+＝L+N＞L，所以剩下的L-个属性信息中，首尾一一对应匹配，最多匹配对。因此，最大常用属性信息个数可以采用以下公式计算得到：其中，max表示最大常用属性信息个数，在目标属性为IP的情况下，max也可以称为最大常用IP个数，显然，常用IP数量是动态变化的区间，该区间为。在一些实施例中，由于常用IP数量是动态变化的，为了解决常用IP数量过多，导致失去实际统计常用IP意义的问题，提出了空属性机制，具体的，执行S202时，可以采用以下方式：基于前一时刻常用属性信息的个数，确定当前时刻常用属性信息的个数，并基于当前时刻常用属性信息的个数，确定常用信息数目阈值，其中，当前时刻是指获取当前属性信息的时刻，前一时刻是指各历史属性信息的最晚进入时刻；若当前时刻常用属性信息的个数，大于常用信息数目阈值，则在历史访问记录中加入指定属性信息后，将当前属性信息加入历史访问记录。示例性的，指定属性信息可以采用空属性信息。本申请实施中，设置常用数据数目阈值H，当count≥H时，如果有新IP属性信息将要进入队列时，先进入一个值为设定数值的IP属性信息，然后再进入新IP属性信息，这样通过一个指定属性信息，影响了队列里面所有IP属性信息的目标权重的计算，使其衰减更快，从而控制了常用IP属性信息的数量，使得对于常用IP的判断更加的精准。具体的，常用数据数目阈值采用以下公式和公式计算得到：其中，H表示常用信息数目阈值，表示当前时刻常用属性信息的个数均值，countmax表示常用属性信息的历史最大个数，α、β均为预设参数，表示前一时刻常用属性信息的个数均值，count表示当前时刻常用属性信息的个数。示例性的，α＝0.125，β＝5。根据上述公式可知，是一个由历史常用IP属性信息的个数决定的平均值，受最近时间记录的count影响更大，假设，的取值为0，为第一时刻的常用属性信息的个数均值，为第二时刻的常用属性信息的个数均值，为第一时刻的常用属性信息的个数均推导如下：由于α＜1,＜1，所以2α＜α＜α，显然，最近时间统计出来的数据count3对影响的权重最大。需要说明的是本申请实施例中，也可以置一个权重函数以使所有IP属性信息的目标权重减少，但是相对于设置一个权重函数以使所有IP属性信息的目标权重减少，空属性机制具备以下优点：首先，空属性机制对目标权重的影响是有限时间的，且和时间相关的当常用IP属性信息的数量达到阈值的时候，在队列中会进入一个空IP，让所有IP属性信息的目标权重多减1。随着新IP属性信息的进入，空IP会向队列尾部移动，且会随着索引号的增大，对整个队列的影响减小，然后被移出队列，自动清除它对队列的影响。而直接使所有IP属性信息的目标权重减少，则需要设定这个变化生效的时间，增加了方案的设计复杂度。其次，空属性机制具有动态调节性，会随着常用IP属性信息的数量而变化。当常用IP属性信息的数量达到阈值的时候，会进入一个空IP，让所有IP属性信息的目标权重多减1，然而，如果此时常用IP属性信息的数量没有减少，那么会接着进入空IP，再次影响目标权重。最后，参阅图8所示，空属性机制对所有IP属性信息的目标权重的影响不是统一不变的。由于每一个空IP只会影响在它之前进入队列的IP属性信息，所以，如果在这个队列里面有多个空IP，那么它们对队列里面的IP属性信息的目标权重的影响是分阶段的，叠加程度是随着索引号的增加而逐渐增加的。而如果直接根据索引号分段，设定一个对IP属性信息的目标权重影响的分段函数，同样会增加方案设计的复杂度。本申请实施例中，该方案的时间复杂度为：O，空间复杂度为：O。利用简单队列模型，同时权重计算算法也不复杂，技术方案更为简洁。且统计出来的常用属性信息的数量是动态变化的，可以满足符合用户的个性化需求。进一步的，由于存储数据的队列大小的限制，根据之前的分析，常用属性信息的数量范围为，同时，由于引入了空属性机制，在常用属性信息的数量达到相应阈值后，会减缓常用属性信息的个数的增加，甚至是减少，从而将常用属性信息数量控制在一个合理范围，提高确定出的常见属性信息的精确度。进一步的，登录设备、登录地址等其他属性也可以通过上述用户行为基线生成方法，实现对常用属性信息的筛选，从而实现了高可复用性，避免了针对不同属性进行冗余的方案设计。基于同一发明构思，参阅图9所示，本申请实施例提供一种用户行为基线生成装置，该装置包括：获取单元901，用于响应于目标对象针对目标业务触发的登录成功操作，获取所述登录成功操作中目标属性对应的当前属性信息；记录单元902，用于将所述当前属性信息加入至历史访问记录中，所述历史访问记录中包含有：所述目标对象针对所述目标业务触发的所述目标属性对应的各历史属性信息；确定单元903，用于基于所述当前属性信息和所述各历史属性信息的加入顺序，以及基于所述各历史属性信息分别与所述当前属性信息之间的加入时间间隔，确定所述当前属性信息和所述各历史属性信息各自对应的目标权重；累加单元904，用于将所述当前属性信息和所述各历史属性信息中，内容相同的属性信息对应的目标权重进行累加，并基于权重累加值，从所述当前属性信息和所述各历史属性信息中，确定出至少一个常用属性信息；生成单元905，用于基于所述目标属性和所述至少一个常用属性信息，生成用户行为基线。作为一种可能的实现方式，所述基于所述当前属性信息和所述各历史属性信息的加入顺序，以及基于所述各历史属性信息分别与所述当前属性信息之间的加入时间间隔，确定所述当前属性信息和所述各历史属性信息各自对应的目标权重时，确定单元903具体用于：针对所述当前属性信息和所述各历史属性信息，分别执行以下操作：将当前属性信息和所述各历史属性信息中的一个属性信息，作为目标属性信息，并基于所述加入顺序，确定所述目标属性信息对应的初始权重；基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，确定所述目标属性信息对应的权重修正值；基于所述初始权重和所述权重修正值，确定所述目标属性信息对应的目标权重。作为一种可能的实现方式，所述基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，确定所述目标属性信息对应的权重修正值时，确定单元903具体用于：基于所述目标属性信息与相邻属性信息之间的加入时间间隔，确定所述目标属性信息对应的参考时间间隔；所述相邻属性信息是指按照所述加入顺序与所述目标属性信息相邻的属性信息；基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，以及基于所述参考时间间隔，确定所述目标属性信息对应的权重修正值。作为一种可能的实现方式，所述基于所述目标属性信息与相邻属性信息之间的加入时间间隔，确定所述目标属性信息对应的参考时间间隔时，确定单元903具体用于：若所述目标属性信息为所述当前属性信息或最早加入所述历史访问记录的历史属性信息，则将所述目标属性信息与对应的一个相邻属性信息之间的加入时间间隔，作为所述目标属性信息对应的参考时间间隔；若所述目标属性信息不为所述当前属性信息和最早加入所述历史访问记录的历史属性信息，则将所述目标属性信息分别与对应的两个相邻属性信息之间的入队时间间隔的平均值，作为所述目标属性信息对应的参考时间间隔。作为一种可能的实现方式，所述基于所述当前属性信息与所述目标属性信息之间的加入时间间隔，以及基于所述参考时间间隔，确定所述目标属性信息对应的权重修正值时，确定单元903具体用于：若所述当前属性信息与所述目标属性信息之间的加入时间间隔，小于或等于参考加入时长，则确定所述目标属性信息对应的权重修正值为第一设定数值；若所述当前属性信息与所述目标属性信息之间的加入时间间隔，大于不小于所述参考加入时长，则将第二设定数值和差异数值中的最小值，作为所述目标属性信息对应的权重修正值，所述差异数值是指相应加入时间间隔和所述参考加入时长之间的差值与所述参考加入时长的比值；其中，所述参考加入时长是根据所述参考时间间隔和所述目标属性信息在所述加入顺序中的位置确定的。作为一种可能的实现方式，所述基于所述初始权重和所述权重修正值，确定所述目标属性信息对应的目标权重时，确定单元903具体用于：获取针对所述目标属性信息预设的容易度；基于所述初始权重和所述权重修正值，以及基于所述容易度，确定所述目标属性信息对应的目标权重。作为一种可能的实现方式，所述将所述当前属性信息加入至历史访问记录中时，记录单元902具体用于：基于前一时刻常用属性信息的个数，确定当前时刻常用属性信息的个数，并基于当前时刻常用属性信息的个数，确定常用数据信息数目阈值，其中，当前时刻是指获取所述当前属性信息的时刻，前一时刻是指所述各历史属性信息的最晚进入时刻；若当前时刻常用属性信息的个数，大于所述常用数据信息数目阈值，则在所述历史访问记录中加入指定属性信息后，将所述当前属性信息加入所述历史访问记录。作为一种可能的实现方式，所述常用数据数目阈值采用以下公式计算得到：其中，H表示常用数据数目阈值，表示当前时刻常用属性信息的个数均值，countmax表示常用属性信息的历史最大个数，α、β均为预设参数，表示前一时刻常用属性信息的个数均值，count表示当前时刻常用属性信息的个数。作为一种可能的实现方式，所述基于权重累加值，从所述当前属性信息和所述各历史属性信息中，确定出至少一个常用属性信息时，累加单元904具体用于：针对所述当前属性信息和所述各历史属性信息中内容相同的属性信息，在所述权重累加值不小于大于预设阈值预设权重阈值时，将所述内容相同的属性信息，作为常用属性信息；针对所述当前属性信息和所述各历史属性信息中，除所述内容相同的属性信息之外的其他属性信息，在所述其他属性信息的目标权重不小于大于预设阈值预设权重阈值时，将所述其他属性信息，作为常用属性信息。基于同一发明构思，参阅图10所示，其为本申请实施例提供的一种电子设备结构示意图包括：处理器101、通信接口102、存储器103和通信总线104，其中，处理器101、通信接口102、存储器103通过通信总线104完成相互间的通信；存储器103中存储有计算机程序，当程序被处理器101执行时，使得处理器41执行如图1、图3或图4中的用户行为基线生成方法。上述电子设备提到的通信总线可以是外设部件互连标准总线或扩展工业标准结构总线等。该通信总线可以分为地址总线、数据总线、控制总线等。为便于表示，图中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。通信接口102用于上述电子设备与其他设备之间的通信。存储器可以包括随机存取存储器，也可以包括非易失性存储器，例如至少一个磁盘存储器。可选地，存储器还可以是至少一个位于远离前述处理器的存储装置。上述处理器可以是通用处理器，包括中央处理器、网络处理器等；还可以是数字指令处理器、专用集成电路、现场可编程门陈列或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。基于同一发明构思，本申请实施例提供一种计算机可读存储介质，计算机可读存储介质内存储有可由处理器执行的计算机程序，当所述程序在所述处理器上运行时，使得所述处理器能够执行上述如图1、图3或图4中的用户行为基线生成方法。基于同一发明构思，本申请实施例提供一种计算机程序产品，所述计算机程序产品包括：计算机程序代码，当所述计算机程序代码在计算机上运行时，使得计算机执行上述如图1、图3或图4中的用户行为基线生成方法。对于系统/装置实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者一个操作与另一个实体或者另一个操作区分开来，而不一定要求或者暗示这些实体或者操作之间存在任何这种实际的关系或者顺序。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。尽管已描述了本申请的优选实施例，但本领域内的技术人员一旦得知了基本创造性概念，则可对这些实施例做出另外的变更和修改。所以，所附权利要求意欲解释为包括优选实施例以及落入本申请范围的所有变更和修改。显然，本领域的技术人员可以对本申请进行各种改动和变型而不脱离本申请的精神和范围。这样，倘若本申请的这些修改和变型属于本申请权利要求及其等同技术的范围之内，则本申请也意图包含这些改动和变型在内。
