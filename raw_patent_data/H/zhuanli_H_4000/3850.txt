标题title
密码安全保护的实现方法、装置、存储介质及电子设备
摘要abst
本发明提供一种密码安全保护的实现方法及装置，包括密码哈希生成和密码哈希校验，通过置位规则、密码原文等共同决定盐值插入密码的具体位置的盐值动态置位技术使得攻击者无法从密码原文与盐值组合数据中获取密码原文。本发明所述的密码安全保护的实现方法及装置，增强密码保护方案抵抗彩虹表攻击和暴力字典攻击等攻击类型的能力，从而提高密码保护的安全强度。
权利要求书clms
1.一种密码安全保护的实现方法，其特征在于，包括密码哈希生成和密码哈希校验；所述密码哈希生成具体包括如下步骤：S1、输入密码数据，以预定义盐值长度范围生成密码的盐值长度，并根据盐值长度随机生成盐值；S2、根据预定义盐值质量判定策略判断盐值；若盐值不符合判定要求，重复执行S1中生成盐值长度和盐值的步骤至盐值符合判定要求；若盐值符合判定要求，执行下一步骤；S3、将盐值置位至密码字符串中，生成密码哈希原文；进行置位时的置位策略为：计算密码的哈希值hp＝H和盐值的哈希值hs＝H，再将L字节长度的密码哈希值和L字节长度盐值哈希值的每个字节的最低比特位进行异或运算得到L比特长度的比特位串b1b2…bL；若bi值为0，则在该位置的密码中不放置盐值字符；若bi值为1，则在该位置的密码中放入一个盐值字符；若已放置至密码最后一字符位时仍然存在未使用的盐值字符，将其余的盐值字符追加至密码的末尾；S4、根据迭代哈希策略及密码哈希原文生成密码哈希值；S5、输出密码盐值和密码哈希值；所述密码哈希校验具体包括如下步骤：S1a、输入密码、密码盐值和密码哈希值；S2a、通过如步骤S4中所述的置位策略将盐值置位至密码数据中，得到密码原文；S3a、选择哈希算法，并根据所述哈希生成中的步骤S4的所述迭代哈希策略生成最终哈希值；S4a、若步骤S3a中的最终哈希值与步骤S1a中的密码哈希值相同，通过验证；若不同，验证失败。2.根据权利要求1中所述的密码安全保护的实现方法，其特征在于，所述哈希生成的步骤S1中，所述预定义的盐值长度范围为10至哈希值长度L。3.根据权利要求1中所述的密码安全保护的实现方法，其特征在于，所述哈希生成的步骤S1中，采用随机比特生成器生成盐值。4.根据权利要求3中所述的密码安全保护的实现方法，其特征在于，所述哈希生成的步骤S2中，所述盐值质量判定策略包括：密码与盐值的组合数据为非全数字；密码与盐值的组合数据为非全字母；密码与盐值的组合数据为非全特殊字符。5.根据权利要求1中所述的密码安全保护的实现方法，其特征在于，所述哈希生成的步骤S4及所述哈希校验的S3a中，所述迭代策略具体包括：哈希算法和迭代次数；所述迭代次数为密码哈希值的最后一字节进行取模运算后加2，取模数为30，使迭代次数为2-32。6.一种密码安全保护的实现装置，其特征在于，包括：盐值生成单元，用于对输入的密码按照预定义的盐值长度范围随机生成盐值长度，并根据盐值长度随机生成盐值；盐值质量监测单元，用于根据盐值质量判定策略判定盐值是否符合要求；盐值置位单元，用于根据置位策略将盐值置位至密码字符串中，生成哈希原文；密码哈希生成及验证单元，用于根据迭代哈希策略以及密码哈希原文生成哈希值数据。7.一种计算机存储介质，其特征在于，所述存储介质存储有计算机程序，所述计算机程序用于执行上述权利要求1-5任一所述的密码安全保护的实现方法。8.一种电子设备，包括处理器和用于存储所述处理器可执行指令的存储器，其特征在于，所述处理器用于执行上述权利要求1-5任一所述的密码安全保护的实现方法。
说明书desc
技术领域本发明属于信息安全和密码技术领域，具体涉及一种密码安全保护的实现方法及装置。背景技术基于账号密码认证方式依然是当今电子商务、电子支付、移动办公等业务中认证用户的主要方法。账号密码认证方式简单便捷，但密码的安全保护却面临着巨大挑战。当前主流的密码保护方式如下：明文密码：直接以明文的方式将密码存储在数据库。此种密码处理方式安全性极低，攻击者一旦获取了数据库访问权限，即可直接获取到用户的密码。基于密钥加密的密码保护方式：通过加密密钥对密码加密后存储在数据库中。若攻击者无法获取加密密钥或调用加密密钥进行解密则该密码保护方式安全性很高，若攻击者能够获取加密密钥或调用加密密钥进行解密则也可以获取用户的密码。基于哈希值的密码保护方式：计算密码的哈希值后进行存储。由于哈希算法具有单向性，攻击者即使从数据库中获取了密码的哈希值，也无法通过哈希值推导出密码，因此很大程度上加强了密码存储安全。但此种密码保护方式容易遭受彩虹表攻击。攻击者预先计算大量密码的哈希值，并将它们存储在数据库中，这个预计算哈希值的数据库成为彩虹表。如果密码数据库泄露，借助彩虹表可查找到哈希值，进而找到匹配的密码。基于加盐哈希值的密码保护方式：将密码与盐值组合处理后进行哈希值再进行存储。即将直接密码哈希计算H更新为密码与盐值组合哈希运算H或H等形式，其中H代表哈希函数运算，||代表字符连接。通过盐值的引入，即使弱密码加盐值的哈希值也很难出现在彩虹表中，能够极大降低遭受彩虹表攻击的风险，具有比基于哈希值的密码保护方式更高的安全性。在不依托密钥加密存储的情况下，目前基于加盐哈希值的密码保护方式是最安全的。但当前加盐哈希值方案主要存在两方面缺点：低质量的盐值数据导致产生的哈希值容易被彩虹表命中：部分加盐哈希值方案采用固定的盐值，若密码数据库统一使用一个固定的盐值，那么攻击者可以基于固定盐值和已有的彩虹表重新生成一个针对固定盐值的彩虹表，进而利用新的彩虹表破解密码；大部分加盐哈希值方案没有对盐值质量做检测，导致密码与盐值组合后的哈希值也容易出现在彩虹表中，进而基于彩虹表破解密码。固定的盐值置位策略导致很容易从密码原文与盐值组合数据中获取密码原文：固定的盐值置位策略指盐值插入密码的具体位置只与置位规则关联，如盐值插入到密码字符串前面、盐值插入到密码字符串后面、盐值插入到密码字符串中间等。盐值固定置位策略下，一旦攻击者获取了密码原文与盐值的组合数据，很容易从组合数据中获取到密码原文。鉴于此，目前亟待提出一种密码安全保护的实现方法及装置，以提高密码保护的安全强度。发明内容为此，本发明提供一种密码安全保护的实现方法及装置，增强密码保护方案抵抗彩虹表攻击和暴力字典攻击等攻击类型的能力，从而提高密码保护的安全强度。本发明提供的密码安全保护的实现方法，包括密码哈希生成和密码哈希校验；所述密码哈希生成具体包括如下步骤：S1、输入密码数据，以预定义盐值长度范围生成密码的盐值长度，并根据盐值长度随机生成盐值；S2、根据预定义盐值质量判定策略判断盐值；若盐值不符合判定要求，重复执行S1中生成盐值长度和盐值的步骤至盐值符合判定要求；若盐值符合判定要求，执行下一步骤；S3、将盐值置位至密码字符串中，生成密码哈希原文；进行置位时的置位策略为：计算密码的哈希值hp＝H和盐值的哈希值hs＝H，再将L字节长度的密码哈希值和L字节长度盐值哈希值的每个字节的最低比特位进行异或运算得到L比特长度的比特位串b1b2…bL；若bi值为0，则在该位置的密码中不放置盐值字符；若bi值为1，则在该位置的密码中放入一个盐值字符；若已放置至密码最后一字符位时仍然存在未使用的盐值字符，将其余的盐值字符追加至密码的末尾；S4、根据迭代哈希策略及密码哈希原文生成密码哈希值；S5、输出密码盐值和密码哈希值；所述密码哈希校验具体包括如下步骤：S1a、输入密码、密码盐值和密码哈希值；S2a、通过如步骤S4中所述的置位策略将盐值置位至密码数据中，得到密码原文；S3a、选择哈希算法，并根据所述哈希生成中的步骤S4的所述迭代哈希策略生成最终哈希值；S4a、若步骤S3a中的最终哈希值与步骤S1a中的密码哈希值相同，通过验证；若不同，验证失败。进一步的，所述哈希生成的步骤S1中，所述预定义的盐值长度范围为10至哈希值长度L。进一步的，所述哈希生成的步骤S1中，采用随机比特生成器生成盐值。进一步的，所述哈希生成的步骤S2中，所述盐值质量判定策略包括：密码与盐值的组合数据为非全数字；密码与盐值的组合数据为非全字母；密码与盐值的组合数据为非全特殊字符。进一步的，所述哈希生成的步骤S4及所述哈希校验的S3a中，所述迭代策略具体包括：哈希算法和迭代次数；所述迭代次数为密码哈希值的最后一字节进行取模运算后加2，取模数为30，使迭代次数为2-32。本发明还提供一种密码安全保护装置，包括：盐值生成单元，用于对输入的密码按照预定义的盐值长度范围随机生成盐值长度，并根据盐值长度随机生成盐值；盐值质量监测单元，用于根据盐值质量判定策略判定盐值是否符合要求；盐值置位单元，用于根据置位策略将盐值置位至密码字符串中，生成哈希原文；密码哈希生成及验证单元，用于根据迭代哈希策略以及密码哈希原文生成哈希值数据。本发明还提供一种计算机存储介质，所述存储介质存储有计算机程序，所述计算机程序用于执行所述的密码安全保护的实现方法。本发明还提供一种电子设备，包括处理器和用于存储所述处理器可执行指令的存储器，还包括所述的密码安全保护的实现装置；所述处理器用于执行上述权利要求1-5任一所述的密码安全保护的实现方法。本发明的上述技术方案，相比现有技术具有以下优点：本发明通过盐值动态生成、盐值质量检测、迭代哈希等手段降低了彩虹表命中的概率，并且通过由置位规则、密码原文等共同决定盐值插入密码的具体位置的盐值动态置位技术使得攻击者无法从密码原文与盐值组合数据中获取密码原文，大大增强了密码保护方案抵抗彩虹表攻击和暴力字典攻击等攻击的能力，从而极大提高了密码保护安全强度。附图说明图1是本发明实施例提供的密码哈希生成的流程示意图；图2是本发明实施例提供的密码哈希验证的流程示意图；图3是本发明实施例提供的密码安全保护装置的模块连接示意图；图4是本发明实施例提供的电子设备的模块连接示意图。具体实施方式下面将结合附图对本发明的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。在本发明的描述中，需要说明的是，术语“中心”、“上”、“下”、“左”、“右”、“竖直”、“水平”、“内”、“外”等指示的方位或位置关系为基于附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”、“第三”仅用于描述目的，而不能理解为指示或暗示相对重要性。在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。本实施例提供一种用于密码安全保护的实现方法及装置。本实施例提供的融合盐值动态生成、盐值质量检测、盐值动态置位、迭代哈希计算等技术从而实现高强度的密码安全保护方法主要包含了两大流程：密码哈希值生成流程和密码哈希值校验流程。其中，如图1所示，密码哈希值生成流程如下：用户输入密码数据password作为密码哈希值计算的外部输入，password值为“fuzamima”字符串；盐值生成单元根据预定义的盐值长度范围随机生成盐值长度，并根据盐值长度随机生成盐值salt。生成的盐值长度为12，生成的盐值对应的字符串为“3D*8m％15&amp;kp！”。盐值质量检测单元根据盐值质量判定策略判定盐值是否符合要求。密码原文“fuzamima”与盐值“3D*8m％15&amp;kp！”符合盐值质量要求。盐值质量符合质量要求，继续执行后续步骤。盐值置位单元根据置位策略将盐值置位到密码字符串中，产生密码哈希原文数据。具体为：计算密码“fuzamima”的SM3哈希值hp＝0x35cd3fc6a5c58b7e8abf5179c0ad76b168e65ac343c92b6ab7259d706512d2bc和盐值“3D*8m％15&amp;kp！”的SM3哈希值hs＝0x740b2bc1eb2c168e1ed29aaab52dc8f9089cebba67d68d9d67d9c76c995e4a6c，再将32字节长度的密码哈希值和32字节长度盐值哈希值的每个字节的最低比特位进行异或运算得到32比特长度的比特位串b1b2…bL为10010110011110000011010100000000。若bi值为0，则在该位置的密码中不放置盐值字符。若bi值为1，则在该位置的密码中放入一个盐值字符。如果已放置到密码最后一字符时仍然有未使用的盐值字符，则将其余的盐值字符追加到密码的末尾，最终形成哈希原文数据为“f3uzaDmi*m8a％15&amp;kp！”。密码哈希生成及验证单元根据迭代哈希策略以及密码哈希原文生成哈希值数据。迭代哈希策略包含了哈希算法和迭代次数，迭代次数为原密码哈希值hp的最后一字节0xbc进行模30运算后再加2得到结果为10。对步骤5形成的哈希原文数据进行10轮迭代哈希运算计算出最终哈希值h为0xdf48baeaea878513ca6c32a69483782aeeb7766aaf03ff3aee8c6701529b993c。密码安全保护装置输出最终的密码盐值和密码哈希值数据。本实施中提供的密码安全保护方法中的密码哈希值验证流程，如图2所示，包括如下步骤：输入用户密码“fuzamima”、密码盐值“3D*8m％15&amp;kp！”、密码哈希值数据0xdf48baeaea878513ca6c32a69483782aeeb7766aaf03ff3aee8c6701529b993c；盐值置位单元根据置位策略将盐值置位到密码字符串中，产生密码哈希原文数据。具体为：计算密码“fuzamima”的SM3哈希值hp＝0x35cd3fc6a5c58b7e8abf5179c0ad76b168e65ac343c92b6ab7259d706512d2bc和盐值“3D*8m％15&amp;kp！”的SM3哈希值hs＝0x740b2bc1eb2c168e1ed29aaab52dc8f9089cebba67d68d9d67d9c76c995e4a6c，再将32字节长度的密码哈希值和32字节长度盐值哈希值的每个字节的最低比特位进行异或运算得到32比特长度的比特位串b1b2…bL为10010110011110000011010100000000。若bi值为0，则在该位置的密码中不放置盐值字符。若bi值为1，则在该位置的密码中放入一个盐值字符。如果已放置到密码最后一字符时仍然有未使用的盐值字符，则将其余的盐值字符追加到密码的末尾，最终形成哈希原文数据为“f3uzaDmi*m8a％15&amp;kp！”。密码哈希生成及验证单元选择哈希算法，根据迭代哈希策略以及密码哈希原文生成哈希值数据。迭代哈希策略包含了哈希算法和迭代次数，迭代次数为原密码哈希值hp的最后一字节进行取模运算后再加2，模数取值为30，确保迭代次数n在2到32之间。之后对形成的哈希原文数据进行n轮迭代哈希运算计算出最终哈希值h’为0xdf48baeaea878513ca6c32a69483782aeeb7766aaf03ff3aee8c6701529b993c。对哈希值h和h’是一致的。当哈希值h和h’一致时输出密码验证成功。本实施例中的用于密码安全保护的实现装置，如图3所示，包括盐值生成单元、盐值质量检测单元、盐值置位单元以及密码哈希生成及验证单元，对各单元的功能概述，如本实施例中关于密码安全保护的实现方法中的阐述。本实施例中的方法及装置通过盐值动态生成、盐值质量检测、迭代哈希等技术，大大增加了哈希原文的复杂性和输出哈希值的复杂性，从而相比其他密码保护方法极大降低了彩虹表命中的概率；又通过盐值动态置位技术，使得盐值插入密码的具体位置由置位规则、密码原文等共同决定，而其他密码方法的盐值插入密码具体位置只由置位规则决定。本实施例中中盐值插入密码的具体位置与未知的密码原文强关联，即使攻击者获取了系统源代码知晓了置位规则，攻击者也无法获取盐值插入密码的具体位置，从而无法获取密码原文。因此，本实施例具备很强的抵抗彩虹表攻击和暴力字典攻击等攻击的能力，本实施例的密码安全保护方法相比于明文密码、哈希密码保护方法、其他基于盐值哈希的密码保护方法等具有更高的安全性。下面，参考图4来描述根据本申请实施例的电子设备。该电子设备可以是第一设备和第二设备中的任一个或两者、或与它们独立的单机设备，该单机设备可以与第一设备和第二设备进行通信，以从它们接收所采集到的输入信号。图4示出了根据本申请实施例的电子设备的框图。如图4所示，电子设备10包括一个或多个处理器11和存储器12。处理器11可以是中央处理单元或者具有数据处理能力和/或指令执行能力的其他形式的处理单元，并且可以控制电子设备10中的其他组件以执行期望的功能。存储器12可以包括一个或多个计算机程序产品，所述计算机程序产品可以包括各种形式的计算机可读存储介质，例如易失性存储器和/或非易失性存储器。所述易失性存储器例如可以包括随机存取存储器和/或高速缓冲存储器等。所述非易失性存储器例如可以包括只读存储器、硬盘、闪存等。在所述计算机可读存储介质上可以存储一个或多个计算机程序指令，处理器11可以运行所述程序指令，以实现上文所述的本实施例中密码安全保护的实现方法以及/或者其他期望的功能。在所述计算机可读存储介质中还可以存储诸如输入信号、信号分量、噪声分量等各种内容。在一个示例中，电子设备10还可以包括：输入装置13和输出装置14，这些组件通过总线系统和/或其他形式的连接机构互连。在该电子设备是单机设备时，该输入装置13可以是通信网络连接器，用于从第一设备和第二设备接收所采集的输入信号。此外，该输入设备13还可以包括例如键盘、鼠标等等。该输出装置14可以向外部输出各种信息，包括确定出的距离信息、方向信息等。该输出设备14可以包括例如显示器、扬声器、打印机、以及通信网络及其所连接的远程输出设备等等。当然，为了简化，图4中仅示出了该电子设备10中与本申请有关的组件中的一些，省略了诸如总线、输入/输出接口等等的组件。除此之外，根据具体应用情况，电子设备10还可以包括任何其他适当的组件。除了上述方法和设备以外，本申请的实施例还可以是计算机程序产品，其包括计算机程序指令，所述计算机程序指令在被处理器运行时使得所述处理器执行本说明书上述“示例性方法”部分中描述的根据本申请各种实施例的密码安全保护的实现方法中的步骤。所述计算机程序产品可以以一种或多种程序设计语言的任意组合来编写用于执行本申请实施例操作的程序代码，所述程序设计语言包括面向对象的程序设计语言，诸如Java、C++等，还包括常规的过程式程序设计语言，诸如“C”语言或类似的程序设计语言。程序代码可以完全地在用户计算设备上执行、部分地在用户设备上执行、作为一个独立的软件包执行、部分在用户计算设备上部分在远程计算设备上执行、或者完全在远程计算设备或服务器上执行。此外，本申请的实施例还可以是计算机可读存储介质，其上存储有计算机程序指令，所述计算机程序指令在被处理器运行时使得所述处理器执行本说明书上述“示例性方法”部分中描述的根据本申请各种实施例的密码安全保护的实现方法中的步骤。所述计算机可读存储介质可以采用一个或多个可读介质的任意组合。可读介质可以是可读信号介质或者可读存储介质。可读存储介质例如可以包括但不限于电、磁、光、电磁、红外线、或半导体的系统、装置或器件，或者任意以上的组合。可读存储介质的更具体的例子包括：具有一个或多个导线的电连接、便携式盘、硬盘、随机存取存储器、只读存储器、可擦式可编程只读存储器、光纤、便携式紧凑盘只读存储器、光存储器件、磁存储器件、或者上述的任意合适的组合。显然，上述实施例仅仅是为清楚地说明所作的举例，而并非对实施方式的限定。对于所属领域的普通技术人员来说，在上述说明的基础上还可以做出其它不同形式的变化或变动。这里无需也无法对所有的实施方式予以穷举。而由此所引伸出的显而易见的变化或变动仍处于本发明创造的保护范围之中。
