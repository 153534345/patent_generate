标题title
基于OSPF协议的量子密钥分发路由方法
摘要abst
本发明提供一种基于OSPF协议的量子密钥分发路由方法，所述方法包括，设备接入与邻居发现建立、LSA泛洪、LSA确认与LSDB组建和更新、加权SPF计算最短路径和将最优路径更新至KM的路由表。本发明的方法提高网络可靠性和更好支持大范围网络。
权利要求书clms
1.基于OSPF协议的量子密钥分发路由方法，其特征在于，所述方法包括以下步骤：步骤1：设备接入与邻居发现建立，设备接入包含KM设备经典网络接入与对应QKD量子密码网络接入，设备接入网络前，KM设备配置量子密码网络的链路中邻居QKD与其对应的KM信息，设备启动后，KM通过组播的方式，向邻居节点互相发送hello报文以确认邻居关系，此后通过OSPF协议Keepalive机制定期检测KM邻居状态；步骤2：LSA泛洪，步骤1建立邻居关系后，DR向链路发送LSA更新报文，所述DR由KM执行OSPF协议选举产生，通过OSPF协议的LSA传递机制，量子链路变更信息将泛洪至整个区域，量子链路的路径剩余密钥量作为LSA报文体的其中一个参数；步骤3：LSA确认与LSDB组建和更新，量子密钥网络中的每个KM设备维护一个独立的量子链路数据库LSDB，在收到LSA报文后，KM设备根据LSA的类型与序号，判断是否更新量子链路数据库中的数据，判断依据与OSPF协议一致；步骤4：加权SPF算法计算最短路径，KM将本节点作为最短路径的树根，根据LSDB的链路拓扑信息，通过加权SPF算法计算；和步骤5：根据步骤4中的计算结果，将最优路径更新至KM的路由表，作为密钥中继的依据。2.根据权利要求1所述的量子密钥分发路由方法，其特征在于，步骤2中，DR向链路发送LSA更新报文进行量子链路的LSA更新，所述量子链路的LSA更新有两种更新方式，一种是由KM节点在固定周期产生新的LSA，另一种是触发式更新，包括新的节点接入到量子密码网络中更新传递LSA，或者某节点量子密码网络链路与路径密钥量发生变化后，触发更新LSA。3.根据权利要求1所述的量子密钥分发路由方法，其特征在于，步骤4中，通过加权SPF算法计算过程包括：遍历本KM的所有直连节点，遍历过程中，若与某节点的分支为新分支，则添加该分支到分支列表，并记录分支的权重、根的下一跳；已存在于分支列表，则与分支列表中已存在分支的权重值比较优劣，并把较优值更新到分支列表中；已存在于权重列表，则忽略；把分支列表中的最优分支移出至权重列表，并选定该分支的节点，若分支列表非空，则继续上面步骤，否则算法结束。4.根据权利要求3所述的量子密钥分发路由方法，其特征在于，如果存在多于一条的最短路径，则将各条最短路径的剩余量子密钥量各自按升序排列，首先比较剩余量子密钥量的最小值，选取最小值最大的路径若最小值均相同，则比较次最小值，选取次最小值最大的路径，若各条最短路径的剩余量子密钥量完全相同，则随机选取一条路径。5.根据权利要求1-4任一所述的量子密钥分发路由方法，其特征在于，所述KM包含了密钥管理模块与路由管理模块，所述密钥管理模块负责储存、管理与中继QKD密钥信息；和所述路由管理模块负责QKD状态收集、邻居信息确认与存储、KM链路信息的收集传递与存储、路由的计算与存储。
说明书desc
技术领域本发明涉及量子通信领域，具体涉及基于OSPF协议的量子密钥分发路由方法。背景技术中国专利CN104579964B中公开了一种量子密码网络路由方法，该技术方案中提到，位于集控站节点的路由客户端收集并处理本中继节点的状态信息，将结果上报于路由服务器，路由服务器收集各路由客户端拓扑状态信息后，生成下一个拓扑更新周期内的整个网络拓扑状态信息，包括中继节点信息、量子链路状态信息，标识网络拓扑结构的邻接矩阵以及可用的邻接路径两端所预测的剩余量子密钥量，并将其发送给网络的所有路由客户端。此方法采用集中收集链路拓扑信息-下发的方式。如图1所示，其处理流程如下：步骤1:设置路由服务器；步骤2:中继节点拓扑信息收集；步骤3:中继节点拓扑信息周期性上报；步骤4：路由服务器收集并处理各类中继节点的拓扑状态信息；步骤5：路由服务器向各个中继节点分发网络拓扑状态信息；和步骤6:中继节点最优路径计算。现有技术具有如下不足：集中式处理网络拓扑，关键的中心节点承受较大的压力，此节点需要接收处理每个节点的上报信息以及对每个节点下发路由，随着网络的扩展，链接数量增多，关系更复杂，单节点负载压力增加，此节点若发生故障，整个网络区域就无法更新路由。网络拓扑的变更只有周期性上传反馈机制，链路的变化反馈速度不够及时，对于网络变更收敛速度不够及时。由于是集中式处理路由，网络每层都需要拥有上级节点去处理，对于多个区域多个层级的网络，集中式路由必须拥有顶层节点处理，网络结构不够灵活，不利于扩展。发明内容为了解决上述问题，本发明提供基于OSPF协议的量子密钥分发路由方法，所述方法包括以下步骤：步骤1：设备接入与邻居发现建立，设备接入包含KM设备经典网络接入与对应QKD量子密码网络接入，设备接入网络前，KM设备配置量子密码网络的链路中邻居QKD与其对应的KM信息，设备启动后，KM通过组播的方式，向邻居节点互相发送hello报文以确认邻居关系，此后通过OSPF协议Keepalive机制定期检测KM邻居状态；步骤2：LSA泛洪，步骤1建立邻居关系后，DR向链路发送LSA更新报文，所述DR由KM执行OSPF协议选举产生，通过OSPF协议的LSA传递机制，量子链路变更信息将泛洪至整个区域，量子链路的路径剩余密钥量作为LSA报文体的其中一个参数；步骤3：LSA确认与LSDB组建和更新，量子密钥网络中的每个KM设备维护一个独立的量子链路数据库LSDB，在收到LSA报文后，KM设备根据LSA的类型与序号，判断是否更新量子链路数据库中的数据，判断依据与OSPF协议一致；步骤4：加权SPF计算最短路径，KM将本节点作为最短路径的树根，根据LSDB的链路拓扑信息，通过加权SPF算法计算；和步骤5：根据步骤4中的计算结果，将最优路径更新至KM的路由表，作为密钥中继的依据。在一种实施方式中，步骤2中，DR向链路发送LSA更新报文进行量子链路的LSA更新，所述量子链路的LSA更新有两种更新方式，一种是由KM节点在固定周期产生新的LSA，另一种是触发式更新，包括新的节点接入到量子密码网络中更新传递LSA，或者某节点量子密码网络链路与路径密钥量发生变化后，触发更新LSA。在一种实施方式中，步骤4中，通过加权SPF算法计算过程包括：遍历本KM的所有直连节点，遍历过程中，若与某节点的分支为新分支，则添加该分支到分支列表，并记录分支的权重、根的下一跳；已存在于分支列表，则与分支列表中已存在分支的权重值比较优劣，并把较优值更新到分支列表中；已存在于权重列表，则忽略；把分支列表中的最优分支移出至权重列表，并选定该分支的节点，若分支列表非空，则继续上面步骤，否则算法结束。在一种实施方式中，如果存在多于一条的最短路径，则将各条最短路径的剩余量子密钥量各自按升序排列，首先比较剩余量子密钥量的最小值，选取最小值最大的路径若最小值均相同，则比较次最小值，选取次最小值最大的路径，若各条最短路径的剩余量子密钥量完全相同，则随机选取一条路径。在一种实施方式中，所述KM包含了密钥管理模块与路由管理模块，所述密钥管理模块负责储存、管理与中继QKD密钥信息；和所述路由管理模块负责QKD状态收集、邻居信息确认与存储、KM链路信息的收集传递与存储、路由的计算与存储。量子密钥是以量子力学为基础，量子力学中的不可克隆原理和海森堡测不准原理保证了量子密钥的安全性，利用量子通信技术分发出来的量子密钥已经被证明过是无条件安全的。量子密码网络便是采用量子密码技术的一种安全通信网络。量子密码网络是由经典通信网络和量子密钥分发网络共同构建而成，规模较大的量子密码网络会具有大量的中继节点，终端节点间的加密通信数据会借助一个或几个中继节点的中转，而且在数据中转时会有不同的可选的中继节点。如何选择量子密码网络中任意两个节点的通信数据由初始节点到达目的节点所要按顺序经过的中继节点，我们称之为量子密码网络路由。当前已发布的量子密钥网络路由相关专利采用的都是集中式管理与计算量子密码网络的路由，集中式管理计算路由可能带来单点压力过大，一个节点出问题导致区域不可更新等问题，本发明提出一种基于OSPF协议的分布式量子密钥分发路由方法，此方法以OSPF路由协议为基础，融合了量子链路相关特征，使用此方法可获得较快收敛速度和较高的网络可靠性。本发明的方法提高网络可靠性，传统的集中式路由方式依靠单一节点收取链路信息进行路由计算下发，单节点负载过大容易出现故障，若出现故障，整网路由就无法更新。基于OSPF的分布式量子密钥分发网络通过OSPF协议将量子链路数据泛洪到每个节点，每个节点单独进行路由计算，网络中任意节点出现了故障，并不会响应到全网其他节点的链路更新与路由计算，从而提高了网络的可靠性。本发明的方法更好支持大范围网络，随着量子通信的发展，广域量子密钥分发网络中的节点数与链路数不断增多，连接关系也越来越复杂，由于网络的扩大造成收敛速度变慢，OSPF协议的特性可以将大范围的网络划分为若干小范围的区域，并通过区域间LSA传递链路信息加快传递和收敛，提高复杂的广域量子密钥分发网络。本发明中缩略语、英文和关键术语定义列表如下：Alice：客户端、消息发起端。Bob：服务端、消息接收端。QKD：全称Quantum Key Distribution，基于量子力学的基本原理保证通信双方之间能够生成一串完全相同且攻击者无法获取信息的随机数以作为共享密钥的设备。量子通信技术：量子通信作为量子信息科学的重要分支，是利用量子态作为信息载体来进行信息交互的通信技术，量子密钥分发是最先实用化的量子信息技术，是量子通信的重要方向。量子密钥可以在空间分离的用户之间以信息理论安全的方式共享密钥。密钥：控制密码算法运算的关键信息或参数。LSA：LSA是链接状态协议使用的一个分组，它包括有关邻居和通道成本的信息，LSA被节点接收用于维护它们的链路状态数据库。LSDB：LSDB是Link State DataBase的缩写，指链路状态数据库，通过路由信息交换，自治系统内部可以达到信息同步，即链路状态数据库描述的网络拓扑同步。量子密码网络路由：量子密码网路通信数据按顺序经由一个或几个中继节点从初始终端节点到达目的终端节点所经过的中继节点构成的路径。KM设备：KM为可信中继节点，用于存储和管理Alice和QKD的密钥信息并收集Alice和QKD状态信息，KM设备在本发明中，还负责链路信息收集、传递与路由计算。DR:DR是Designated Router的缩写，在OSPF协议中代表指定路由器，通过DR选举产生，作用是协助同步LSA，减少链路同步的消耗。本发明中的DR通过KM在经典网络中执行OSPF协议选举产生。SPF算法也被称为Dijkstra算法，SPF算法将每一个路由器作为根来计算其到每一个目的地路由器的距离，每一个路由器根据一个统一的数据库会计算出路由域的拓扑结构图，该结构图类似于一棵树，在SPF算法中，被称为最短路径树。SPF算法是OSPF路由协议的基础。在OSPF路由协议中，最短路径树的树干长度，即OSPF路由器至每一个目的地路由器的距离。附图说明为了更清楚地说明本申请实施例中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请中记载的一些实施例，对于本领域普通技术人员来说，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图。图1是现有技术采用集中收集链路拓扑信息-下发方式的处理流程图；图2是本发明基于OSPF量子密钥分发网络结构示意图图3是本发明基于OSPF分布式量子密钥分发路由处理流程图；和图4是本发明基于OSPF量子密钥分发网络KM结构示意图。具体实施方式为了使本领域技术领域人员更好地理解本申请中的技术方案，下面将结合实施例对本发明作进一步说明，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都应当属于本申请保护的范围。下面结合附图及实施例对本发明作进一步描述。开放式最短路径优先是广泛使用的一种动态路由协议，它属于链路状态路由协议，具有路由变化收敛速度快、无路由环路、支持变长子网掩码和汇总、层次区域划分等优点。在网络中使用OSPF协议后，大部分路由将由OSPF协议自行计算和生成，无须网络管理员人工配置，当网络拓扑发生变化时，协议可以自动计算、更正路由，极大地方便了网络管理。但如果使用时不结合具体网络应用环境，不做好细致的规划，OSPF协议的使用效果会大打折扣，甚至引发故障。OSPF协议是一种链路状态协议。每个路由器负责发现、维护与邻居的关系，并将已知的邻居列表和链路费用LSU报文描述，通过可靠的泛洪与自治系统AS内的其他路由器周期性交互，学习到整个自治系统的网络拓扑结构；并通过自治系统边界的路由器注入其他AS的路由信息，从而得到整个Internet的路由信息。每隔一个特定时间或当链路状态发生变化时，重新生成LSA，路由器通过泛洪机制将新LSA通告出去，以便实现路由的实时更新。在一种实施方式中，如图2所示，基于OSPF密钥生成网络路由结构由KM和QKD设备构成，KM之间通过经典网络进行连接，QKD之间通过量子链路进行密钥分发，每个KM都有其对应的QKD设备，并可获取对应QKD设备量子链路的连接情况。对于较大规模的网络，参照OSPF划分为若干区域，每个区域将一个KM-QKD设置为边界路由节点，边界路由节点接收其他区域的路由通告，并对本区域路由进行聚合，减少通告到其他区域的LSA数量。在一种实施例中，如图3所示，为实现上述基于OSPF密钥生成网络路由结构，采取技术方案步骤如下：步骤1，设备接入与邻居发现建立，设备接入包含KM设备经典网络，接入与对应QKD量子密码网络接入，设备接入网络前，KM设备配置量子密码网络的链路中邻居QKD与其对应的KM信息，设备启动后，KM通过组播的方式，向邻居节点互相发送hello报文以确认邻居关系，此后通过OSPF协议Keepalive机制定期检测KM邻居状态。步骤2，LSA泛洪，步骤1建立邻居关系后，DR向链路发送LSA更新报文，DR由KM执行OSPF协议选举产生；通过OSPF协议的LSA传递机制，量子链路变更信息将泛洪至整个区域，量子链路的路径剩余密钥量作为LSA报文体的其中一个参数。步骤3，LSA确认与LSDB组建和更新，量子密钥网络中的每个KM设备维护一个独立的量子链路数据库LSDB，在收到LSA报文后，KM设备根据LSA的类型与序号，判断是否更新量子链路数据库中的数据，判断依据与OSPF协议一致。步骤4，加权SPF计算最短路径，KM将本节点作为最短路径的树根，根据LSDB的链路拓扑信息，通过加权SPF算法计算，计算过程如下：a.遍历本KM的所有直连节点。遍历过程中，若与某节点的分支为：新分支，则添加该分支到分支列表，并记录分支的权重、根的下一跳；已存在于分支列表，则与分支列表中已存在分支的权重值比较优劣，并把较优值更新到分支列表中；已存在于权重列表，则忽略。b.把分支列表中的最优分支移出至权重列表，并选定该分支的节点，若分支列表非空，则继续上面步骤，否则算法结束c.如果存在多于一条的最短路径，则将各条最短路径的剩余量子密钥量各自按升序排列，首先比较剩余量子密钥量的最小值，选取最小值最大的路径若最小值均相同，则比较次最小值，选取次最小值最大的路径，若各条最短路径的剩余量子密钥量完全相同，则随机选取一条路径。步骤5，路由数据的更新，根据步骤4中的计算结果，将最优路径更新至KM的路由表，作为密钥中继的依据。下面对本技术方案流程进行进一步说明1.量子链路的LSA更新机制在步骤2中，量子链路的LSA有两种更新方式，一种是由KM节点在固定周期产生新的LSA，另一种是触发式更新，包括新的节点接入到量子密码网络中更新传递LSA，或者某节点量子密码网络链路与路径密钥量发生变化后，触发更新LSA。如图4所示，本发明中KM包含了密钥管理模块与路由管理模块。密钥管理模块负责储存、管理与中继QKD密钥信息。路由管理模块负责QKD状态收集、邻居信息确认与存储、KM链路信息的收集传递与存储、路由的计算与存储。本领域的技术人员容易理解的是，在不冲突的前提下，上述各有利方式可以自由地组合、叠加。以上仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。以上仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明技术原理的前提下，还可以做出若干改进和变型，这些改进和变型也应视为本发明的保护范围。
