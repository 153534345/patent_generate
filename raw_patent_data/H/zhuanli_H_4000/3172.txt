标题title
一种车辆安全防护控制方法及相关设备
摘要abst
本发明公开了一种车辆安全防护控制方法及相关设备。该方法包括：获取第三方应用发出的请求报文；基于上述请求报文和安全数据库确定报文处置方案，其中，上述安全数据库包括请求报文安全性与处置方案的对应关系；在上述请求报文为危险报文的情况下，基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作；将上述危险报文发送至目标服务器以使上述目标服务器基于上述请求报文升级上述安全数据库。本申请提出的车辆安全防护方法，车辆端在遭受攻击时进行安全防护并执行报警操作，云端可以基于危险报文升级本地端的安全数据库，为车辆安全提供了双重保证。
权利要求书clms
1.一种车辆安全防护控制方法，用于车辆端，其特征在于，包括：获取第三方应用发出的请求报文；基于所述请求报文和安全数据库确定报文处置方案，其中，所述安全数据库包括请求报文安全性与处置方案的对应关系；在所述请求报文为危险报文的情况下，基于所述报文处置方案向相应的控制器发送报警指令以使所述控制器对应的目标设备执行报警操作；将所述危险报文发送至目标服务器以使所述目标服务器基于所述请求报文升级所述安全数据库。2.如权利要求1所述的方法，其特征在于，所述基于所述报文处置方案向相应的控制器发送报警指令以使所述控制器对应的目标设备执行报警操作，包括：向车灯控制器发送第一报警指令以使目标车灯以既定策略闪烁；向喇叭控制器发送第二报警指令以使车辆喇叭以既定策略鸣笛。3.如权利要求1所述的方法，其特征在于，还包括：在所述请求报文为危险报文的情况下，将车辆运行信息记录在车辆端的应急存储器中并基于用户身份信息做加密处理，其中，车辆运行信息包括车辆行驶信息和车辆运行图像信息。4.如权利要求1所述的方法，其特征在于，还包括：在所述请求报文为危险报文的情况下，基于所述危险报文向TSP平台发送报警事件消息以提醒用户，其中，所述报警事件消息中包括车辆唯一识别码、攻击开始的时间、事件类型、事件名称、报警级别和处理建议中至少一种。5.一种车辆安全防护控制方法，用于服务器端，其特征在于，包括：接收目标车辆端发出的危险报文；统计目标区域内多个目标车辆发出的危险报文的危险关联程度；在所述危险关联程度超出预设关联程度的情况下，向所述目标区域内的所有目标车辆发送安全数据库更新包以提升所述目标车辆的安全等级。6.如权利要求5所述的方法，其特征在于，所述危险关联程度包括危险报文发出源关联程度，所述预设关联程度包括预设发出源关联程度；所述在所述危险关联程度超出预设关联程度的情况下，向所述目标区域内的所有目标车辆发送安全数据库更新包以提升所述目标车辆的安全等级，包括：获取所述危险报文对应发出源的位置信息；将所述位置信息小于预设距离的发出源确定为关联发出源；根据所述关联发出源确定危险报文发出源关联程度；基于所述危险报文发出源关联程度大于所述预设发出源关联程度对应的所述危险报文生成所述安全数据库更新包；将所述数据库更新包发送至所述目标区域内的所有所述目标车辆。7.如权利要求5所述的方法，其特征在于，所述危险关联程度包括危险报文重复率，所述预设关联程度包括预设重复率；所述在所述危险关联程度超出预设关联程度的情况下，向所述目标区域内的所有目标车辆发送安全数据库更新包以提升所述目标车辆的安全等级，包括：在所述危险报文重复率大于所述预设重复率的情况下，基于所述危险报文重复率大于所述预设重复率对应的所述危险报文生成所述安全数据库更新包；将所述数据库更新包发送至所述目标区域内的所有所述目标车辆。8.一种车辆安全防护控制装置，其特征在于，包括：获取单元，用于获取第三方应用发出的请求报文；确定单元，用于基于所述请求报文和安全数据库确定报文处置方案，其中，所述安全数据库包括请求报文安全性与处置方案的对应关系；控制单元，用于在所述请求报文为危险报文的情况下，基于所述报文处置方案向相应的控制器发送报警指令以使所述控制器对应的目标设备执行报警操作；上传单元，用于将所述危险报文发送至目标服务器以使所述目标服务器基于所述请求报文升级所述安全数据库。9.一种电子设备，包括：存储器和处理器，其特征在于，所述处理器用于执行存储器中存储的计算机程序时实现如权利要求1-7中任一项所述的车辆安全防护控制方法的步骤。10.一种计算机可读存储介质，其上存储有计算机程序，其特征在于：所述计算机程序被处理器执行时实现如权利要求1-7中任一项所述的车辆安全防护控制方法。
说明书desc
技术领域本说明书涉及车辆安全领域，更具体地说，本发明涉及一种车辆安全防护控制方法及相关设备。背景技术无论是防止非授权用户的破门而入，还是防止车辆本身的性能故障等，车辆安全防护的报警系统是增加车辆安全性的必备条件。传统的车辆防护仅停留在来自外部的暴力破解的报警状态，即车辆处于设防状态时，没有使用的合法的钥匙解锁车辆，导致门锁系统故障。还有一些常见的报警系统就是车辆仪表的状态报警，例如安全带未系、发动机故障、胎压异常等。随着新四化的发展，车辆智能网联的功能逐渐的强大起来，车辆与外界的交互也越发的频繁。来自外部网络的消息也越来越复杂。外部黑客的入侵车辆也时有发生，这给现在智能汽车的安全防护报警系统提出了很大的挑战。发明内容在发明内容部分中引入了一系列简化形式的概念，这将在具体实施方式部分中进一步详细说明。本发明的发明内容部分并不意味着要试图限定出所要求保护的技术方案的关键特征和必要技术特征，更不意味着试图确定所要求保护的技术方案的保护范围。第一方面，本发明提出一种车辆安全防护控制方法，用于车辆端，包括：获取第三方应用发出的请求报文；基于上述请求报文和安全数据库确定报文处置方案，其中，上述安全数据库包括请求报文安全性与处置方案的对应关系；在上述请求报文为危险报文的情况下，基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作；将上述危险报文发送至目标服务器以使上述目标服务器基于上述请求报文升级上述安全数据库。可选的，上述基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作，包括：向车灯控制器发送第一报警指令以使目标车灯以既定策略闪烁；向喇叭控制器发送第二报警指令以使车辆喇叭以既定策略鸣笛。可选的，上述方法还包括：在上述请求报文为危险报文的情况下，将车辆运行信息记录在车辆端的应急存储器中并基于用户身份信息做加密处理，其中，车辆运行信息包括车辆行驶信息和车辆运行图像信息。可选的，上述方法还包括：在上述请求报文为危险报文的情况下，基于上述危险报文向TSP平台发送报警事件消息以提醒用户，其中，上述报警事件消息中包括车辆唯一识别码、攻击开始的时间、事件类型、事件名称、报警级别和处理建议中至少一种。第二方面、本申请提出一种车辆安全防护控制方法，用于服务器端，包括：接收目标车辆端发出的危险报文；统计目标区域内多个目标车辆发出的危险报文的危险关联程度；在上述危险关联程度超出预设关联程度的情况下，向上述目标区域内的所有目标车辆发送安全数据库更新包以提升上述目标车辆的安全等级。可选的，上述危险关联程度包括危险报文发出源关联程度，上述预设关联程度包括预设发出源关联程度；上述在上述危险关联程度超出预设关联程度的情况下，向上述目标区域内的所有目标车辆发送安全数据库更新包以提升上述目标车辆的安全等级，包括：获取上述危险报文对应发出源的位置信息；将上述位置信息小于预设距离的发出源确定为关联发出源；根据上述关联发出源确定危险报文发出源关联程度；基于上述危险报文发出源关联程度大于上述预设发出源关联程度对应的上述危险报文生成上述安全数据库更新包；将上述数据库更新包发送至上述目标区域内的所有上述目标车辆。可选的，上述危险关联程度包括危险报文重复率，上述预设关联程度包括预设重复率；上述在上述危险关联程度超出预设关联程度的情况下，向上述目标区域内的所有目标车辆发送安全数据库更新包以提升上述目标车辆的安全等级，包括：在上述危险报文重复率大于上述预设重复率的情况下，基于上述危险报文重复率大于上述预设重复率对应的上述危险报文生成上述安全数据库更新包；将上述数据库更新包发送至上述目标区域内的所有上述目标车辆。第三方面，本发明还提出一种车辆安全防护控制装置，包括：获取单元，用于获取第三方应用发出的请求报文；确定单元，用于基于上述请求报文和安全数据库确定报文处置方案，其中，上述安全数据库包括请求报文安全性与处置方案的对应关系；控制单元，用于在上述请求报文为危险报文的情况下，基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作；上传单元，用于将上述危险报文发送至目标服务器以使上述目标服务器基于上述请求报文升级上述安全数据库。第四方面，一种电子设备，包括：存储器、处理器以及存储在上述存储器中并可在上述处理器上运行的计算机程序，上述处理器用于执行存储器中存储的计算机程序时实现如上述的第一方面任一项的车辆安全防护控制方法的步骤。第五方面，本发明还提出一种计算机可读存储介质，其上存储有计算机程序，上述计算机程序被处理器执行时实现第一方面上述任一项的车辆安全防护控制方法。综上，本申请实施例的车辆安全防护控制方法包括：获取第三方应用发出的请求报文；基于上述请求报文和安全数据库确定报文处置方案，其中，上述安全数据库包括请求报文安全性与处置方案的对应关系；在上述请求报文为危险报文的情况下，基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作；将上述危险报文发送至目标服务器以使上述目标服务器基于上述请求报文升级上述安全数据库。本申请提出的车辆安全防护方法，通过车辆端IDPS的安全数据库对第三方应用发出的请求报文进行安全筛查，在发现危险报文的情况下，基于危险报文对应的处置方案，向对应的控制器发出报警指令，控制对应的设备执行报警操作。并向云端IDPS发送加密后的危险报文，云端IDPS可以基于车辆端发出的IDPS报文制定对应的升级包，发送给目标车辆，车辆端的IDPS可以基于对应的升级包执行安全数据库升级操作，以提升车辆端的安全防护等级。本申请提出的车辆安全防护方法，车辆端在遭受攻击时进行安全防护并执行报警操作，云端可以基于危险报文升级本地端的安全数据库。为车辆安全提供了双重保证。本发明的车辆安全防护控制方法，本发明的其它优点、目标和特征将部分通过下面的说明体现，部分还将通过对本发明的研究和实践而为本领域的技术人员所理解。附图说明通过阅读下文优选实施方式的详细描述，各种其他的优点和益处对于本领域普通技术人员将变得清楚明了。附图仅用于示出优选实施方式的目的，而并不认为是对本说明书的限制。而且在整个附图中，用相同的参考符号表示相同的部件。在附图中：图1为本申请实施例提供的一种车辆安全防护控制方法流程示意图；图2为本申请实施例提供的另一种车辆安全防护控制方法流程示意图；图3为本申请实施例提供的一种车辆安全防护控制装置结构示意图；图4为本申请实施例提供的一种车辆安全防护控制电子设备结构示意图。具体实施方式本申请提出的车辆安全防护方法，通过车辆端IDPS的安全数据库对第三方应用发出的请求报文进行安全筛查，在发现危险报文的情况下，基于危险报文对应的处置方案，向对应的控制器发出报警指令，控制对应的设备执行报警操作。并向云端IDPS发送加密后的危险报文，云端IDPS可以基于车辆端发出的IDPS报文制定对应的升级包，发送给目标车辆，车辆端的IDPS可以基于对应的升级包执行安全数据库升级操作，以提升车辆端的安全防护等级。本申请提出的车辆安全防护方法，车辆端在遭受攻击时进行安全防护并执行报警操作，云端可以基于危险报文升级本地端的安全数据库。为车辆安全提供了双重保证。本申请的说明书和权利要求书及上述附图中的术语“第一”、“第二”、“第三”、“第四”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的实施例能够以除了在这里图示或描述的内容以外的顺序实施。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分实施例，而不是全部的实施例。请参阅图1，为本申请实施例提供的一种车辆安全防护控制方法流程示意图，具体可以包括：S110、获取第三方应用发出的请求报文；示例性的，随车车辆智能化的发展，车辆的智能网联的功能逐渐的强大起来，车辆与外界的交互也越发的频繁。来自外部网络的消息也越来越复杂，第三方应用发来的消息可能是车辆信任的第三方发来的执行某项服务的请求报文，还有可能是某些恶意第三方发来的，想要非法控制车辆的侵入请求报文，为了保护车辆信息和控制的安全性需要对第三方应用发出的请求报文进行安全筛查，并执行相应的处理。本申请提出的方案将IDPS系统安装在车端路由前用于接收第三方应用发出的请求报文并执行相应的安全判断与安全处置等操作，将经过解析和安全分析后，执行数据包丢弃或放行。IDPS支持以下L2～L4层网络协议的解析：支持以太头解析；支持IEEE 802.11协议解析；支持ARP协议解析；支持ICMP协议解析；支持IPv4协议解析；支持IPv6协议解析；支持TCP协议解析；支持UDP协议解析。本申请提出的IDPS系统主要包括车端IDPS和云端IDPS：车端本地保存的IDPS安全报警策略包括两个版本，一个为当前正在使用的策略，一个为备份策略。策略升级时，系统先更新备份策略，更新成功后，将系统当前策略切换到备份策略，最后将新的备份策略进行更新。车端记录的报警事件原始文件储存于车端，上报的报警事件是做加密处理，仅上报加密的事件标识。云端IDPS车辆安全运营中心设置用户报警模块，该模块主要用于解密事件标识，处理车端上报的和用户相关的报警事件汇总，同时会同步至用户的手机，允许用户通过手机查看车辆实时的安全状态，用户可以手机触发请求车端上传脱敏后历史的报警事件和相关音视频记录。上报给云端的威胁报警事件分类的主要原则：1.威胁事件和用户有关；2.威胁事件和财产安全有关；3.威胁事件和车辆本身安全有关。上报威胁报警事件的安全等级划分原则：依据威胁事件的严重程度划分为高、中、低。S120、基于上述请求报文和安全数据库确定报文处置方案，其中，上述安全数据库包括请求报文安全性与处置方案的对应关系；示例性的，车端IDPS存有安全数据库，安全数据库中包括有请求报文的安全性判断规则，以及出现危险报文的情况下，车辆的处置方案。通过安全数据库与请求报文比对筛选有危险的报文直接丢弃并激发安全处置方案，如果请求报文为安全报文则将报文传给车内路由，经由车内网络将请求报文对应的服务指令发送至对应的控制器，完成相应的操作。S130、在上述请求报文为危险报文的情况下，基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作；示例性的，在经过安全数据库筛选后发现请求报文为危险报文的情况下，根据既定的报文处置方案向对应的控制器发出报警指令，控制器在接收到报警指令后执行对应的报警操作，例如，打开警示灯，关闭车窗，关闭发动机等操作。控制器包括仪表控制器、车机控制器、整车控制器、车身控制器等。车端的报警时整车的状态有两种，分别为：整车控制器的电源模式为“OFF”，防盗状态为“设防”；整车控制器远程模式下的电源模式为“ON”，防盗状态为“设防S140、将上述危险报文发送至目标服务器以使上述目标服务器基于上述请求报文升级上述安全数据库。示例性的，在车辆端IDPS识别到危险报文的情况下，车辆端将该报文加密并通过车联网系统将加密后的危险报文上传至云端服务器的IDPS系统，云端的IDPS系统在接收到该危险报文基于危险报文的侵入原理做出分析，生成升级包，以弥补车辆的安全漏洞，云端IDPS系统将升级包发送到对应的目标车辆以完成车辆端的IDPS升级，提升车辆安全等级。综上，本申请提出的车辆安全防护方法，通过车辆端IDPS的安全数据库对第三方应用发出的请求报文进行安全筛查，在发现危险报文的情况下，基于危险报文对应的处置方案，向对应的控制器发出报警指令，控制对应的设备执行报警操作。并向云端IDPS发送加密后的危险报文，云端IDPS可以基于车辆端发出的IDPS报文制定对应的升级包，发送给目标车辆，车辆端的IDPS可以基于对应的升级包执行安全数据库升级操作，以提升车辆端的安全防护等级。本申请提出的车辆安全防护方法，车辆端在遭受攻击时进行安全防护并执行报警操作，云端可以基于危险报文升级本地端的安全数据库。为车辆安全提供了双重保证。基于IDPS的车辆安全防护报警系统有效地解决了因网络攻击事件引起的车辆安全问题。同时保证了安全防护的实时性和可追溯性，所以该安全防护报警系统是保证车辆安全的必要配置。在一些示例中，上述基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作，包括：向车灯控制器发送第一报警指令以使目标车灯以既定策略闪烁；向喇叭控制器发送第二报警指令以使车辆喇叭以既定策略鸣笛。示例性的，在车辆接收到危险报文的情况下，即当车辆受到网络入侵攻击时，车端IDPS组件会反馈给车身控制器，车身控制器使所有的转向灯同时闪烁亮起，喇叭随转向灯鸣笛，同时仪表控制器会使仪表上的转向指示灯会同步闪烁。可以通过灯光加鸣笛的方式，提醒驾驶者和路旁的人员及车辆，避免发生危险，用户可以在车机上选择的防盗设置是“灯光+喇叭”或者“灯光”，同时灯光的闪烁周期可以选择“快速、正常、慢”等。综上，本申请实施例提出的车辆安全控制方法，在车辆遭受到第三方应用攻击的情况下，通过灯光和喇叭的组合警报，可以有效提醒用户和周围车辆及行人，避免发生危险。在一些示例中，上述方法还包括：在上述请求报文为危险报文的情况下，将车辆运行信息记录在车辆端的应急存储器中并基于用户身份信息做加密处理，其中，车辆运行信息包括车辆行驶信息和车辆运行图像信息。示例性的，在车辆接收到的请求报文为危险报文的情况下，为了避免第三方应用截获车辆的行驶信息，此时控制车辆将车辆运行信息记录在车辆端的应急存储器中，并根据用户的身份信息进行加密处理，例如用户的面容，用户自设的密码等，车辆的运行信息可以包括车辆的行驶信息和车辆运行图像信息，车辆运行图像信息可以为车辆拍摄的行车记录，例如，车载行车记录仪自动录制30s视频存储于车机，不上传云端，用户通过车机查看视频时需要通过身份认证，保证视频不会被恶意删除。综上，本申请实施例提供的车辆安全控制方法，在车辆遭受第三方应用攻击的情况下，对车辆运行信息保存在车辆段等额应急存储器中，不上传云端，避免第三方应用截获车辆运行数据，影响车辆行驶安全。在一些示例中，上述方法还包括：在上述请求报文为危险报文的情况下，基于上述危险报文向TSP平台发送报警事件消息以提醒用户，其中，上述报警事件消息中包括车辆唯一识别码、攻击开始的时间、事件类型、事件名称、报警级别和处理建议中至少一种。示例性的，车端的IDPS组件会自动匹配攻击事件的规则，报警事件的信息打包上传给云端车辆运维管理平台，然后同步给TSP平台，TSP平台接收到推送的报警事件的消息时自动推送给用户的手机APP，推送的内容包括：车辆唯一识别码、攻击开始的时间、事件类型、事件名称、报警级别和处理建议。例如，安全事件检测策略是通过车辆的安全状态和对应的车辆实际工况分析和用户相关的攻击事件，从攻击事件触发的角度梳理和用户相关的功能，提取基于用户相关性的车辆安全报警通知特征值数据库。车辆处于设防状态，当攻击者在远程唤醒启动车辆后，通过触发远程记忆泊车指令移动车辆时，如果攻击者恶意的控制车速大于15KM/H或者路径长度大于100米或者环境感知传感器感知有障碍物或者胎压异常等，IDPS数据分析组件会调用用户相关性报警特征值数据库进行检测，一旦检测到特征值异常时，直接将数据包丢弃，防止攻击进入到系统或被系统路由转发。车端IDPS日志组件会记录攻击事件开始时间，攻击事件类型为远程，事件名称为非法记忆泊车攻击，报警级别高，处理建议是立刻检查车辆状态。综上，本申请实施例提供的车辆安全控制方法，在车辆遭受攻击的情况下，车辆端将包括车辆和时间的报警事件消息上传给云端的TSP平台，云端可以基于危险报文升级车辆端的安全数据库，提升车辆的安全性。第二方面、本申请提出一种车辆安全防护控制方法，用于服务器端，包括：S210、接收目标车辆端发出的危险报文；示例性的，本方法应用于服务器端是负责车辆安全的云端，服务器端配备有云端IDPS系统，通过与车辆端联网，在车辆端的IDPS系统检测到第三方应用发出的报文为危险报文的情况下，在车辆端会对危险报文做出抛弃处理，并在车辆端执行报警操作，并在在此时会将危险报文进行处理后发给服务器端，服务器端可以同时接收多个目标车辆发出的危险报文。S220、统计目标区域内多个目标车辆发出的危险报文的危险关联程度；示例性的，服务器端在接收到多个目标车辆发出的危险报文后，会判断这些危险报文之间的关联程度，判断这些危险报文是否为同一个第三方应用发车的，或者是否为同一区域内的不同第三方发出的。S230、在上述危险关联程度超出预设关联程度的情况下，向上述目标区域内的所有目标车辆发送安全数据库更新包以提升上述目标车辆的安全等级。示例性的，如果多个危险报文之间的关联程度较高，超出预设关联程度的情况下，则认为该目标区域内的车辆可能会收到集群攻击的可能，服务器端基于危险报文生成安全数据库更新包，并将该安全数据库更新包发送给该目标区域内的所有目标车辆，包括未收攻击的目标车辆，以提升目标车联过的安全等级，避免车辆遭受攻击。可以理解的是，目标区域的范围可以根据危险关联程度进行调整，可以有效避免区域性攻击。综上，本申请提出的车辆安全防护控制方法，服务器端根据多个客户端收到的危险报文分析危险报文之间的危险关联程度，在危险关联程度超出预设关联程度的情况下，目标区域所有的目标车辆发出安全数据库更新包，未遭受攻击的车辆的安全数据库也能得到及时更新，避免了目标车辆遭受区域性攻击。在一些示例中，上述危险关联程度包括危险报文发出源关联程度，上述预设关联程度包括预设发出源关联程度；上述在上述危险关联程度超出预设关联程度的情况下，向上述目标区域内的所有目标车辆发送安全数据库更新包以提升上述目标车辆的安全等级，包括：获取上述危险报文对应发出源的位置信息；将上述位置信息小于预设距离的发出源确定为关联发出源；根据上述关联发出源确定危险报文发出源关联程度；基于上述危险报文发出源关联程度大于上述预设发出源关联程度对应的上述危险报文生成上述安全数据库更新包；将上述数据库更新包发送至上述目标区域内的所有上述目标车辆。示例性的，关联程度可以包括危险报文发出源关联程度，通过获取危险报文发出源之间的位置信息，如果多个危险报文的发出位置距离小于预设距离则认为这些危险报文可能是来自于一个攻击者，那么这些危险报文的关联程度比较大，其攻击的手段或者攻击的服务类型应该是同种，此时将这些危险报文结合在一些进行分析能够得出更具有针对性的安全数据库更新包。综上，本申请实施例提出的车辆安全防护控制方法，通过获取危险报文发出源之间的距离确定报文关联程度，将危险报文发出源关联程度大于预设发出源关联程度对应的危险报文生成的安全数据库更新包对于这些危险报文的针对性更强，有利于提示区域内目标车辆的安全性能。在一些示例中，上述危险关联程度包括危险报文重复率，上述预设关联程度包括预设重复率；上述在上述危险关联程度超出预设关联程度的情况下，向上述目标区域内的所有目标车辆发送安全数据库更新包以提升上述目标车辆的安全等级，包括：在上述危险报文重复率大于上述预设重复率的情况下，基于上述危险报文重复率大于上述预设重复率对应的上述危险报文生成上述安全数据库更新包；将上述数据库更新包发送至上述目标区域内的所有上述目标车辆。示例性的，危险管理程度好包括危险报文重复率，危险报文的重复率可以是报文中非格式的内容的重复率，即属于同一种入侵策略下生成的多种报文，例如只是数值上的更改，或者建立信任连接的方式相同，如果危险报文内容的重复率大于预设重复率的情况下，可以认为这些报文是基于同一种入侵策略发出的，根据这些报文生成的安全数据库更新包，可以摸清这些报文之间的内在关系，避免此入侵源后续经简单更改后，继续对车辆发起攻击。综上，本申请实施例提出的车辆安全防护控制方法，通过危险报文重复率确定报文关联程度，基于危险报文重复率大于预设重复率对应的危险报文生成上述安全数据库更新包能够基于同一种入侵策略做出防范，提升车辆安全性能。请参阅图3，本申请实施例中车辆安全防护控制装置的一个实施例，可以包括：获取单元31，用于获取第三方应用发出的请求报文；确定单元32，用于基于上述请求报文和安全数据库确定报文处置方案，其中，上述安全数据库包括请求报文安全性与处置方案的对应关系；控制单元33，用于在上述请求报文为危险报文的情况下，基于上述报文处置方案向相应的控制器发送报警指令以使上述控制器对应的目标设备执行报警操作；上传单元34，用于将上述危险报文发送至目标服务器以使上述目标服务器基于上述请求报文升级上述安全数据库。如图4所示，本申请实施例还提供一种电子设备300，包括存储器310、处理器320及存储在存储器320上并可在处理器上运行的计算机程序311，处理器320执行计算机程序311时实现上述车辆安全防护控制的任一方法的步骤。由于本实施例所介绍的电子设备为实施本申请实施例中一种车辆安全防护控制装置所采用的设备，故而基于本申请实施例中所介绍的方法，本领域所属技术人员能够了解本实施例的电子设备的具体实施方式以及其各种变化形式，所以在此对于该电子设备如何实现本申请实施例中的方法不再详细介绍，只要本领域所属技术人员实施本申请实施例中的方法所采用的设备，都属于本申请所欲保护的范围。在具体实施过程中，该计算机程序311被处理器执行第一方面和第二方面任一方法中的步骤。需要说明的是，在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详细描述的部分，可以参见其它实施例的相关描述。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式计算机或者其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。本申请实施例还提供了一种计算机程序产品，该计算机程序产品包括计算机软件指令，当计算机软件指令在处理设备上运行时，使得处理设备执行如图1对应实施例中的车辆安全防护控制的流程。计算机程序产品包括一个或多个计算机指令。在计算机上加载和执行计算机程序指令时，全部或部分地产生按照本申请实施例的流程或功能。计算机可以是通用计算机、专用计算机、计算机网络、或者其他可编程装置。计算机指令可以存储在计算机可读存储介质中，或者从一个计算机可读存储介质向另一计算机可读存储介质传输，例如，计算机指令可以从一个网站站点、计算机、服务器或数据中心通过有线)或无线方式向另一个网站站点、计算机、服务器或数据中心进行传输。计算机可读存储介质可以是计算机能够存储的任何可用介质或者是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。可用介质可以是磁性介质，、光介质、或者半导体介质)等。所属领域的技术人员可以清楚地了解到，为描述的方便和简洁，上述描述的系统，装置和单元的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在本申请所提供的几个实施例中，应该理解到，所揭露的系统，装置和方法，可以通过其它的方式实现。例如，以上所描述的装置实施例仅仅是示意性的，例如，单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通信连接可以是通过一些接口，装置或单元的间接耦合或通信连接，可以是电性，机械或其它的形式。作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本申请各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。集成的单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分或者该技术方案的全部或部分可以以软件产品的形式体现出来，该计算机软件产品存储在一个存储介质中，包括若干指令用以使得一台计算机设备执行本申请各个实施例方法的全部或部分步骤。而前述的存储介质包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。以上，以上实施例仅用以说明本申请的技术方案，而非对其限制；尽管参照前述实施例对本申请进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本申请各实施例技术方案的精神和范围。
