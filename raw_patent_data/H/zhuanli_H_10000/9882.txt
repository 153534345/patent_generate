标题title
基于事件触发的平均一致性时间同步方法
摘要abst
本发明涉及一种基于事件触发的平均一致性时间同步方法，属于无线网络技术领域。该方法针对无线网络中通信时延与时钟时变频偏存在的情况，为网络中设置更新周期以及各节点初始的相对频偏估计值和逻辑时钟补偿值，并按此周期逐步进行逻辑频偏估计值的更新；依据最新更新的与上次广播的逻辑频偏值之差判断节点是否满足广播触发条件；若触发条件满足，节点将此时的硬件时钟以及逻辑时钟的相关参数广播给其他邻居节点；并利用序列最小二乘法进行相对频偏估计，采用比例积分估计器实现网络时钟的全局一致。本发明考虑了无线网络中传输时延以及时钟时变频偏的影响，在通信开销和同步精度间取得折衷，以合适的通信开销实现了较高的同步精度。
权利要求书clms
1.一种基于事件触发的平均一致性时间同步方法，其特征在于，针对无线网络中通信时延与时钟时变频偏存在的情况，该方法具体包括以下步骤：S1：为网络中设置更新周期以及各节点初始的相对频偏估计值和逻辑时钟补偿值，并按此周期逐步进行逻辑频偏估计值的更新；S2：依据最新更新的与上次广播的逻辑频偏值之差判断节点是否满足广播触发条件；S3：若触发条件满足，节点将此时的硬件时钟值以及逻辑时钟的相关参数广播给其他邻居节点，并记录下本次更新后的逻辑频偏估计值；S4：节点收到其他邻居节点发的数据包后，依据其中的时钟参数利用序列最小二乘法进行相对频偏值的估计，然后采用比例积分估计器计算出逻辑频偏值，最后进行逻辑时钟值的更新，周期性重复上述步骤，直至网络实现逻辑时钟的全局同步。2.根据权利要求1所述的基于事件触发的平均一致性时间同步方法，其特征在于，步骤S1具体包括：为网络设置一个更新周期T，对于网络中任意一个节点i，此时的更新次数设为k＝1；设为节点i第k次更新的绝对时间，为节点i相应的逻辑时钟读数，当k＝1或k＞2且节点i的硬件时钟值满足时间，逻辑频偏估计值根据当前所知的邻居节点信息采用比例积分估计器进行更新：其中，δi表示节点i的误差积分器，表示节点i的逻辑频偏值，表示节点i最近发送给邻居节点的逻辑频偏值，Kp,KI分别为比例项和积分项的估计量增益，μ表示信息更新率，ρ表示步长，表示节点i相对节点j的频偏估计值，表示网络中节点i的所有邻居节点。3.根据权利要求2所述的基于事件触发的平均一致性时间同步方法，其特征在于，步骤S2具体包括：为判断最新轮更新后的时钟参数是否需要广播给邻居节点，计算最新更新的与上次广播的逻辑频偏值之差，并将其与更新时间相关且随时间减少的阈值进行比较，若差值大于此阈值，则说明触发条件满足；其中，触发条件为：其中，ρ*为一个权衡精度与通信开销的参数；若上述的触发条件满足，节点i记录下最近更新的逻辑频偏估计值并将此逻辑频偏估计值、当前硬件时钟读数、逻辑时钟读数以及误差积分值广播给邻节点。4.根据权利要求3所述的基于事件触发的平均一致性时间同步方法，其特征在于，步骤S4具体包括：对于网络中节点i的任意一个邻居节点j，在接收到节点i发送的数据包后，将其接收的数据包数量设为l，并将收到数据包的时钟值记为数据包中来自节点i的硬件时钟值记为利用其传输的硬件时钟读数，首先利用序列最小二乘法估计出二者的相对频偏值，并将其代入比例积分估计器进行逻辑频偏估计值的更新，再由此计算出逻辑时钟值，具体包括以下步骤：S41：若l＝2，设置初始的相对频偏估计器，代表第一轮更新开始：Σ＝H)-1其中，为l＝2时的估计更新矩阵；Σ为相应的协方差更新矩阵，H＝T，若l＞2，采用相对频偏的迭代形式，在每轮相对频偏进行更新后，矩阵的第一个元素即是节点间的相对频偏值S42：根据步骤S41计算出的相对频偏值以及数据包中节点i的其他逻辑时钟参数，根据比例积分估计器对逻辑频偏值进行更新；S43：根据步骤S42计算出的逻辑频偏估计值，进行逻辑时钟值的更新。
说明书desc
技术领域本发明属于无线网络技术领域，涉及一种基于事件触发的平均一致性时间同步方法。背景技术时间同步是无线网络中的一项关键技术，为这种分布式系统中各个独立的节点提供了一个通用的全局时间尺度。这种技术满足了无线网络中众多应用的基本需求，例如数据融合、目标跟踪和协作传输等。网络中每个节点的时钟由晶体振荡器维持，然而在实际环境中，温度、压力等因素会对节点的时钟晶振造成影响，同时晶振本身也存在制作工艺的差异以及老化问题，导致晶振偏移带来的时钟频率误差累积，从而使网络中各节点的时钟无法实现同步。为了满足无线网络灵活性的需求，一种不依靠具体拓扑结构或参考节点的分布式时钟同步得到了广泛的研究。一致性理论的引入使时钟同步协议具有鲁棒性和可扩展性的同时，提高了同步精度。分布式时钟同步面临的两个挑战是通信时延的存在和时钟频偏的时变特性，上述两个因素在实际场景中是无法忽略的，并且将影响时间同步的精度，甚至阻碍全局时钟同步的实现。在节点间的信息交互过程中，时延使节点无法获得准确的时钟信息，需要对两个节点间的相对频偏进行估计。因此，基于最小二乘、基于序列最小二乘的一致性时间同步协议将统计信号的处理方法用于设计相对频偏估计器，能够较好地抵消时延的影响。另一方面，由于环境因素以及时钟晶振器本身的不确定性，节点时钟的频偏不再是一个常数，而是随时间变化的。考虑到这一特性，双积分器、比例积分一致性同步算法为时变频偏下的时钟同步问题提出了有效的解决方案。现有用于解决时延及时变频偏影响的分布式时钟同步均采用的是基于时间触发的节点交互机制。这种节点交互方式在进行信息传输前不会对本节点与邻居节点时钟信息之差进行评估，而是周期性地持续进行传输，即使是在同步误差很小、无需接收邻居节点信息来进行一致性过程的情况下。这样造成的通信开销对无线网络相关设备寿命有较大影响。事件触发的节点交互机制是节省通信过程中开销的有效解决方案，然而，目前尚无一致性时钟同步方法在解决时延和时变频偏影响的同时，抑制同步过程中所造成通信开销的浪费。因此，亟需一种能够在时延和时变频偏存在的无线网络中有效降低通信开销，并且实现全局时钟同步的平均一致性方法。发明内容有鉴于此，本发明的目的在于提供一种基于事件触发的平均一致性时间同步方法，同时考虑无线网络中通信时延与时钟时变频偏对同步精度的影响，针对采用事件触发节点交互方式的平均一致性时间同步方法尚未解决在上述因素影响下的时钟同步问题，提供一个适用于此场景基于事件触发的节点交互策略，其触发条件保持适当的收敛速度，使节点仅在满足此触发条件时对邻居节点进行广播，减小了通信开销；同时在提出的事件触发交互策略下利用序贯最小二乘法进行相对频偏估计，采用比例积分器对逻辑时钟的频偏值进行更新，使所有节点对时延以及时变频偏具有鲁棒性，从而实现全局时钟同步。为达到上述目的，本发明提供如下技术方案：一种基于事件触发的平均一致性时间同步方法，针对无线网络中通信时延与时钟时变频偏存在的情况，通过规定节点按一定的触发条件进行时间信息的广播，有效降低了通信开销，并在这样的节点交互策略下，采用了序列最小二乘法以及比例积分估计器使所有节点对时延以及时变频偏具有鲁棒性，从而达到全局时间同步。该方法具体包括以下步骤：S1：为网络中设置更新周期以及各节点初始的相对频偏估计值和逻辑时钟补偿值，并按此周期逐步进行逻辑频偏估计值的更新；S2：依据最新更新的与上次广播的逻辑频偏值之差判断节点是否满足广播触发条件；S3：若触发条件满足，节点将此时的硬件时钟值以及逻辑时钟的相关参数广播给其他邻居节点，并记录下本次更新后的逻辑频偏估计值；S4：节点收到其他邻居节点发的数据包后，依据其中的时钟参数利用序列最小二乘法进行相对频偏值的估计，然后采用比例积分估计器计算出逻辑频偏值，最后进行逻辑时钟值的更新，周期性重复上述步骤，直至网络实现逻辑时钟的全局同步。进一步，步骤S1具体包括：为网络设置一个更新周期T，对于网络中任意一个节点i，此时的更新次数设为k＝1；设为节点i第k次更新的绝对时间，为节点i相应的逻辑时钟读数，当k＝1或k＞2且节点i的硬件时钟值满足时间，逻辑频偏估计值根据当前所知的邻居节点信息采用比例积分估计器进行更新：其中，δi表示节点i的误差积分器，表示节点i的逻辑频偏值，表示节点i最近发送给邻居节点的逻辑频偏值，Kp,KI分别为比例项和积分项的估计量增益，μ表示信息更新率，ρ表示步长，表示节点i相对节点j的频偏估计值，表示网络中节点i的所有邻居节点。进一步，步骤S2具体包括：为判断最新轮更新后的时钟参数是否需要广播给邻居节点，计算最新更新的与上次广播的逻辑频偏值之差，并将其与更新时间相关且随时间减少的阈值进行比较，若差值大于此阈值，则说明触发条件满足；其中，触发条件为：其中，ρ*为一个权衡精度与通信开销的参数；进一步，步骤S3中，若上述步骤S2的触发条件满足，节点i记录下最近更新的逻辑频偏估计值并将此逻辑频偏估计值、当前硬件时钟读数、逻辑时钟读数以及误差积分值广播给邻节点。进一步，步骤S4具体包括：对于网络中节点i的任意一个邻居节点j，在接收到节点i发送的数据包后，将其接收的数据包数量设为l，并将收到数据包的时钟值记为数据包中来自节点i的硬件时钟值记为利用其传输的硬件时钟读数，首先利用序列最小二乘法估计出二者的相对频偏值，并将其代入比例积分估计器进行逻辑频偏估计值的更新，再由此计算出逻辑时钟值，具体包括以下步骤：S41：若l＝2，设置初始的相对频偏估计器，代表第一轮更新开始：Σ＝H)-1其中，为l＝2时的估计更新矩阵；Σ为相应的协方差更新矩阵，H＝T，若l＞2，采用相对频偏的迭代形式，在每轮相对频偏进行更新后，矩阵的第一个元素即是节点间的相对频偏值S42：根据步骤S41计算出的相对频偏值以及数据包中节点i的其他逻辑时钟参数，根据比例积分估计器对逻辑频偏值进行更新；S43：根据步骤S42计算出的逻辑频偏估计值，进行逻辑时钟值的更新。本发明的有益效果在于：1)本发明与现有的基于事件触发的平均一致性时间同步方法相比，考虑了无线网络中通信时延与时钟时变频偏存在的问题，利用序贯最小二乘法进行相对频偏估计以对抗时延的影响，在后续进行一致性同步的过程中，采用比例积分估计器使节点各时钟在时变频偏的影响下也能趋于一致，这有利于基于事件触发的平均一致性时钟同步机制在实际无线网络中的应用。2)本发明在基于事件触发节点交互机制的基础上，提出了适用于通信时延与时变频偏存在的场景下的触发策略，评估当前与最后一次发送的时钟信息之间的误差，将其与一个随时间减小且具有适当收敛速度的阈值相比作为触发方程，使各节点仅在此方程满足时才对各邻居节点进行时钟信息的广播，从而在保持较高同步精度的同时，降低同步过程中的通信开销。本发明的其他优点、目标和特征在某种程度上将在随后的说明书中进行阐述，并且在某种程度上，基于对下文的考察研究对本领域技术人员而言将是显而易见的，或者可以从本发明的实践中得到教导。本发明的目标和其他优点可以通过下面的说明书来实现和获得。附图说明为了使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明作优选的详细描述，其中：图1为本发明所采用的无线网络拓扑结构图；图2为本发明基于事件触发的平均一致性时间同步方法流程图。具体实施方式以下通过特定的具体实例说明本发明的实施方式，本领域技术人员可由本说明书所揭露的内容轻易地了解本发明的其他优点与功效。本发明还可以通过另外不同的具体实施方式加以实施或应用，本说明书中的各项细节也可以基于不同观点与应用，在没有背离本发明的精神下进行各种修饰或改变。需要说明的是，以下实施例中所提供的图示仅以示意方式说明本发明的基本构想，在不冲突的情况下，以下实施例及实施例中的特征可以相互组合。请参阅图1～图2，图1为本发明考虑无线网络中分布式的网络拓扑结构，如图1所示，网络中分布着若干节点，节点在通信范围中对邻居节点按照一定触发方式进行时钟信息的广播，同时也作为邻居节点接收其他节点发送的数据包。将网络中所有节点用一个集合表示为其中N代表节点数量；节点间可靠通信链路的集合表示为并且∈ε表示数据包可以成功地从节点i传播到节点j，也能从节点j传播到节点i；将网络中节点i的所有邻居节点表示为对于整个网络拓扑结构，将其表示为一个无向图为网络设置一个更新周期T，对于网络中任意一个节点i，此时的更新次数设为k＝1；设为节点i第k次更新的绝对时间，为节点i相应的逻辑时钟读数，当k＝1或k＞2且节点i的硬件时钟值满足时间，逻辑频偏估计值根据当前所知的邻居节点信息采用比例积分估计器进行更新：其中，δi表示节点i的误差积分器，表示节点i的逻辑频偏值，表示节点i最近发送给邻居节点的逻辑频偏值，Kp,KI分别为比例项和积分项的估计量增益，μ表示信息更新率，ρ表示步长，表示节点i相对节点j的频偏估计值，表示网络中节点i的所有邻居节点。为判断此轮更新后的时钟参数是否需要广播给邻居节点，计算最新更新的与上次广播的逻辑频偏值之差，并将其与更新时间相关且随时间减少的阈值进行比较，若差值大于此阈值，则说明触发条件满足，具体的触发条件方程为：其中，ρ*为一个权衡精度与通信开销的参数。若上述触发条件满足，节点i记录下最后更新的逻辑频偏估计值并将此估计值、当前硬件时钟读数、逻辑时钟读数以及误差积分值广播给邻节点。对于网络中节点i的任意一个邻居节点j，在接收到节点i发送的数据包后，将其接收的数据包数量设为l，并将收到数据包的时钟值记为数据包中来自节点i的硬件时钟值记为利用其传输的硬件时钟读数，首先利用序列最小二乘法估计出二者的相对频偏值，并将其代入比例积分控制器进行逻辑频偏估计值的更新，再由此计算出逻辑时钟值。若此时l＝2，设置初始的相对频偏估计器：Σ＝H)-1其中，为l＝2时的估计更新矩阵，Σ为相应的协方差更新矩阵，并且此矩阵中的具体表示为H＝T，若l＞2，采用序列最小二乘法的迭代形式，在每轮相对频偏进行更新后，矩阵的第一个元素即是节点间的相对频偏值在接下来的一致性同步过程中，将计算出的相对频偏值以及数据包中节点i的其他逻辑时钟参数，再次利用比例积分估计器对逻辑频偏值进行更新，最后进行逻辑时钟值的更新。实施例：图2为本发明基于事件触发的平均一致性时间同步方法流程图。本实施例提供了适用于通信时延以及时变频偏存在下基于事件触发的平均一致性时间同步方法，如图2所示，具体包括以下步骤：V1：一致性时钟同步过程开始。V2～V4：为网络中设置更新周期以及各节点初始的相对频偏估计值和逻辑时钟补偿值，并按此周期逐步进行逻辑频偏估计值的更新。V5：依据最新更新的与上次广播的逻辑频偏值之差判断此节点是否满足广播触发条件。V6：若触发条件满足，节点将此时的硬件时钟读数以及逻辑时钟的相关参数广播给其他邻居节点，并记录下本次更新后的逻辑频偏估计值。V7～V9：节点收到其邻居节点发的数据包后，依据其中的时钟参数利用序列最小二乘法进行相对频偏值的估计，由此采用比例积分估计器计算出逻辑频偏值，最终进行逻辑时钟值的更新，周期性重复上述步骤，直至网络实现逻辑时钟的全局同步。V10～V11：判断网络中所有时钟的最大逻辑频偏误差以及最大逻辑时钟误差是否保持在一个较小的范围，若这两个条件满足，则说明同步条件已满足，结束时钟同步的操作，否则继续上述步骤。最后说明的是，以上实施例仅用以说明本发明的技术方案而非限制，尽管参照较佳实施例对本发明进行了详细说明，本领域的普通技术人员应当理解，可以对本发明的技术方案进行修改或者等同替换，而不脱离本技术方案的宗旨和范围，其均应涵盖在本发明的权利要求范围当中。
