标题title
一种基于生成对抗网络的OFDM信号生成方法
摘要abst
本发明公开了一种基于生成对抗网络的OFDM信号生成方法，生成使用OFDM调制的复杂协议信号，属于通信对抗领域中的信号重构技术。本发明针对OFDM信号时域特征提取困难的问题，首先，使用FFT对时域OFDM信号进行预处理，并将处理后的频域符号向量拼接为二维数据矩阵；然后，将数据矩阵以灰度图像的方式存储为时频二维图样，用于GAN的训练和测试。此外，本发明中的双判别器GAN采用一个生成器与两个判别器同时进行博弈，生成器用于生成时频二维图样以欺骗两个判别器，两个判别器分别从子载波结构和调制符号的星座密度两个方面区分生成的图样和真实图样，以保证生成信号符合OFDM时频域特征的要求。
权利要求书clms
1.一种基于生成对抗网络的OFDM信号生成方法，其特征在于，包括以下步骤：a.对输入的OFDM时域信号进行预处理，将OFDM信号转换到频域，并将得到的频域信号进行归一化，将每个频域OFDM符号的时间顺序进行拼接，得到时频二维矩阵，然后将矩阵的实部和虚部分别以单通道灰度图的形式存储，得到时频二维图样，用于生成对抗网络的训练和验证；b.将步骤a得到的时频二维图样输入双判别器GAN进行训练，并且当训练收敛后将生成器模型保存；c.将特定的随机噪声输入训练好的生成器模型即得到满足相应协议的OFDM频域信号的实部或虚部时频二维图样；d.对步骤c中得到的时频二维图样的实部和虚部相加，并进行IFFT逆快速傅里叶变换和并串转换，即得到生成的OFDM时域信号。2.根据权利要求1所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，步骤a中所述的预处理包括串并转换、去循环前缀快速傅里叶变换两个步骤。3.根据权利要求1所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，步骤a中所述的归一化的处理方式为：rnorm＝r./2max)+0.5+0.5j其中，r表示将OFDM时域信号进行串并转换、去循环前缀、对每一个OFDM符号进行FFT后，将得到的向量按行拼接所得到的矩阵；./代表矩阵每一行与列向量中对应行的元素相除，max代表矩阵中每一行的最大值组成的列向量，abs代表矩阵中每个元素的幅度，j为虚数单位。4.根据权利要求1所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，步骤b中所述的双判别器GAN包含一个生成器和两个判别器。5.根据权利要求4所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，双判别器GAN中的生成器的输入为随机噪声，输出为时频二维图样，生成器的网络结构包含9层，具体如下：第1层为输入层，输入的随机噪声的维度为2×1×1；第2～6层和第8～9层为二维反卷积层，零填充为0×0，卷积核大小分别为2×2、2×2、5×2、2×2、5×2、1×2和1×2，步长分别为1×1、2×2、5×2、2×2、5×2、1×2和1×2，除第9层外均用BatchNorm函数进行批次归一化并用LeakyReLU函数作为激活函数，第9层用Tanh函数作为激活函数；第7层为二维卷积层，零填充为1×1，卷积核大小为3×3，步长为1×1，用BatchNorm函数进行批次归一化，并用LeakyReLU函数作为激活函数；输出的时频二维图样维度为1×100×64。6.根据权利要求4所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，双判别器GAN中的第一判别器的输入分别为真实的时频二维图样和生成器生成的时频二维图样，输出为1维实数，第一判别器的网络结构包含7层，具体如下：第1层为输入层，输入的时频二维图样维度为1×100×64；第2～7层为二维卷积层，零填充分别为1×0、1×1、1×1、1×0、1×1和0×0，卷积核大小分别为4×1、4×4、4×4、4×1、4×4和2×2，步长分别为2×1、5×4、4×4、2×1、2×2和1×1，除第7层外均用BatchNorm函数进行批次归一化并用LeakyReLU函数作为激活函数，第7层不使用激活函数，直接输出数字1或0作为判别结果，1、0分别代表真、假；输出维度为1×1×1。7.根据权利要求4所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，双判别器GAN中的第二判别器的输入分别为真实的时频二维图样经过图样-星座转换网络生成的星座密度图，以及生成器生成的时频二维图样经过图样-星座转换网络生成的星座密度图，输出为100维实数，第二判别器的网络结构包含6层，具体如下：第1层为输入层，输入的星座密度图维度为1×100×100；第2～6层为二维卷积层，零填充分别为1×0、1×0、1×0、1×0、和0×0，卷积核大小分别为4×1、4×1、4×1、4×1和2×1，步长分别为2×1、5×1、2×1、2×1和1×1，除第6层外均用BatchNorm函数进行批次归一化并用LeakyReLU函数作为激活函数，第6层不使用激活函数，直接输出数字1或0作为判别结果，1、0分别代表真、假；输出维度为1×1×100。8.根据权利要求7所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，所述的图样-星座转换网络利用神经网络将时频二维图样转换为星座密度图，其网络结构包含9层，具体如下：第1层为输入层，输入的时频二维图样维度为1×100×64；第2～9层为二维卷积层，输出维度分别为64×100×32、128×100×16、256×100×8、512×100×2、256×100×4、128×100×8、64×100×20、1×100×100，除第9层外均用BatchNorm函数进行批次归一化并用ReLU函数作为激活函数，第9层用Tanh函数作为激活函数；图样-星座转换网络的训练是离线进行的，优化器使用Adam优化器，学习率为5×10-6，训练的输入为时频二维图样，标签为该时频二维图样对应的星座密度图，训练时的目标函数为MSELoss；作为训练集标签的星座密度图生成方式如下：将等分为100份，并且统计时频二维图样中每一行像素点的幅度在这100个区间的概率密度；将每一行统计得到的概率密度分布进行归一化，分别保存到维度为1×100的向量中；对得到的向量按行拼接得到维度为100×100的矩阵并将该矩阵存储为单通道灰度图，即为作为训练标签的星座密度图。9.根据权利要求8所述的基于生成对抗网络的OFDM信号生成方法，其特征在于，步骤b中所述的训练使用Adam优化器，生成器的学习率为4×10-4，第一判别器的学习率为1×10-4，第二判别器的学习率为1×10-4，训练的目标函数如下：其中，V、V、V分别是第一判别器、第二判别器和生成器的损失函数，G为生成器，D1为第一判别器，D2为第二判别器，C为图样-星座转换网络，z为输入生成器的随机噪声，x为作为训练集的真实时频二维图样，E表示期望，x～pdata表示x服从真实数据集的概率分布，z～pz表示输入的噪声满足随机分布，λ1和λ2分别为第一判别器和第二判别器在生成器目标函数中所占的权重。
说明书desc
技术领域本发明属于通信对抗领域中的信号重构技术，具体涉及到一种对使用正交频分复用调制的复杂协议信号生成方法。背景技术面对未知的通信信号，传统的通信对抗机制需要进行信道估计和信号参数估计，如调制方式、码率、载波频率、频偏等等，再针对信号进行跟踪式干扰，或在对外部信号识别失败的情况下直接进行阻塞式干扰。但随着通信和网络技术的发展进步，电磁信号呈现出多模式、多制式、智能化、高度自适应和快速捷变等特点，并且由于不同通信场景的差异化需求，无线通信系统针对各类场景设计了多种复杂协议，面对未知的复杂协议信号，传统干扰方法存在识别难、生成难的问题。另外，在生成干扰信号时，传统干扰方法通过硬件调制实现，针对不同的复杂协议信号，需要不同的硬件系统实现，缺少足够的灵活性和泛化能力。在各类复杂协议信号的调制中，OFDM调制技术当前应用最为广泛，例如，移动通信中目前主流的4G及5G通信协议，数字视频广播、无线局域网中的IEEE 802.11a标准和HiperLAN标准等均使用了OFDM调制，但这些协议采用了不同的帧结构。面对敌方OFDM调制的复杂协议信号，传统的干扰方式需要不同的硬件系统实现对不同协议和参数信号的重构。基于机器学习的信号生成模型，可以实现统一架构下生成不同参数的信号，在硬件上更有灵活性。作为一种新兴的生成式模型，生成对抗网络能够学习高维度的、复杂的真实数据分布，在数据生成领域具有广泛应用。GAN通常由生成器和判别器两个部分的神经网络组成，通过生成器和判别器的对抗性训练，自主学习真实样本数据分布和统计特性，在合适条件下，可以达到或逼近纳什均衡，此时GAN的生成器可以生成类似真实样本的数据。GAN在诸多领域的数据生成和信号处理中取得应用，如语音信号增强、音乐序列生成等，尤其在计算机视觉领域应用非常广泛，例如，图像到图像的转换，图像超分辨，视频生成，文本生成等等。对于一组具有较好空间相关性的图片或数据，用GAN网络生成类似真实样本的数据是可行的。利用GAN强大的数据生成能力，可将GAN网络作为统一架构生成参数不同的OFDM信号。但是OFDM符号序列从时域观察具有类似噪声的特性，相关性差，不利于特征的提取和数据分布的拟合。对于生成模型而言难以学习到OFDM时域信号的分布特征，若以OFDM时域信号作为训练样本进行训练，容易出现生成的信号星座不符合要求的映射条件，时频域参数不符合协议帧结构要求等情况，不具有OFDM信号应有的特点。需要从更多维度，如时频域同时观察OFDM信号特征，让GAN生成符合要求的OFDM调制的复杂协议信号。发明内容针对上述存在的问题，本发明提出了一种基于生成对抗网络的OFDM信号生成方法，利用该方法，能够提取OFDM信号时域和频域两个维度特征，生成满足特定协议的OFDM信号。为了实现上述目的，本发明采用的技术方案为：一种基于生成对抗网络的OFDM信号生成方法，包括以下步骤：a.对输入的OFDM时域信号进行预处理，将OFDM信号转换到频域，并将得到的频域信号进行归一化，将每个频域OFDM符号的时间顺序进行拼接，得到时频二维矩阵，然后将矩阵的实部和虚部分别以单通道灰度图的形式存储，得到时频二维图样，用于生成对抗网络的训练和验证；b.将步骤a得到的时频二维图样输入双判别器GAN进行训练，并且当训练收敛后将生成器模型保存；c.将特定的随机噪声输入训练好的生成器模型即得到满足相应协议的OFDM频域信号的实部或虚部时频二维图样；d.对步骤c中得到的时频二维图样的实部和虚部相加，并进行IFFT逆快速傅里叶变换和并串转换，即得到生成的OFDM时域信号。进一步的，步骤a中所述的预处理包括串并转换、去循环前缀快速傅里叶变换两个步骤。进一步的，步骤a中所述的归一化的处理方式为：rnorm＝r./2max)+0.5+0.5j其中，r表示将OFDM时域信号进行串并转换、去循环前缀、对每一个OFDM符号进行FFT后，将得到的向量按行拼接所得到的矩阵；./代表矩阵每一行与列向量中对应行的元素相除，max代表矩阵中每一行的最大值组成的列向量，abs代表矩阵中每个元素的幅度，j为虚数单位。进一步的，步骤b中所述的双判别器GAN包含一个生成器和两个判别器。进一步的，双判别器GAN中的生成器的输入为随机噪声，输出为时频二维图样，生成器的网络结构包含9层，具体如下：第1层为输入层，输入的随机噪声的维度为2×1×1；第2～6层和第8～9层为二维反卷积层，零填充为0×0，卷积核大小分别为2×2、2×2、5×2、2×2、5×2、1×2和1×2，步长分别为1×1、2×2、5×2、2×2、5×2、1×2和1×2，除第9层外均用BatchNorm函数进行批次归一化并用LeakyReLU函数作为激活函数，第9层用Tanh函数作为激活函数；第7层为二维卷积层，零填充为1×1，卷积核大小为3×3，步长为1×1，用BatchNorm函数进行批次归一化，并用LeakyReLU函数作为激活函数；输出的时频二维图样维度为1×100×64。进一步的，双判别器GAN中的第一判别器的输入分别为真实的时频二维图样和生成器生成的时频二维图样，输出为1维实数，第一判别器的网络结构包含7层，具体如下：第1层为输入层，输入的时频二维图样维度为1×100×64；第2～7层为二维卷积层，零填充分别为1×0、1×1、1×1、1×0、1×1和0×0，卷积核大小分别为4×1、4×4、4×4、4×1、4×4和2×2，步长分别为2×1、5×4、4×4、2×1、2×2和1×1，除第7层外均用BatchNorm函数进行批次归一化并用LeakyReLU函数作为激活函数，第7层不使用激活函数，直接输出数字1或0作为判别结果，1、0分别代表真、假；输出维度为1×1×1。进一步的，双判别器GAN中的第二判别器的输入分别为真实的时频二维图样经过图样-星座转换网络生成的星座密度图，以及生成器生成的时频二维图样经过图样-星座转换网络生成的星座密度图，输出为100维实数，第二判别器的网络结构包含6层，具体如下：第1层为输入层，输入的星座密度图维度为1×100×100；第2～6层为二维卷积层，零填充分别为1×0、1×0、1×0、1×0、和0×0，卷积核大小分别为4×1、4×1、4×1、4×1和2×1，步长分别为2×1、5×1、2×1、2×1和1×1，除第6层外均用BatchNorm函数进行批次归一化并用LeakyReLU函数作为激活函数，第6层不使用激活函数，直接输出数字1或0作为判别结果，1、0分别代表真、假；输出维度为1×1×100。进一步的，所述的图样-星座转换网络利用神经网络将时频二维图样转换为星座密度图，其网络结构包含9层，具体如下：第1层为输入层，输入的时频二维图样维度为1×100×64；第2～9层为二维卷积层，输出维度分别为64×100×32、128×100×16、256×100×8、512×100×2、256×100×4、128×100×8、64×100×20、1×100×100，除第9层外均用BatchNorm函数进行批次归一化并用ReLU函数作为激活函数，第9层用Tanh函数作为激活函数；图样-星座转换网络的训练是离线进行的，优化器使用Adam优化器，学习率为5×10-6，训练的输入为时频二维图样，标签为该时频二维图样对应的星座密度图，训练时的目标函数为MSELoss；作为训练集标签的星座密度图生成方式如下：将等分为100份，并且统计时频二维图样中每一行像素点的幅度在这100个区间的概率密度；将每一行统计得到的概率密度分布进行归一化，分别保存到维度为1×100的向量中；对得到的向量按行拼接得到维度为100×100的矩阵并将该矩阵存储为单通道灰度图，即为作为训练标签的星座密度图。进一步的，步骤b中所述的训练使用Adam优化器，生成器的学习率为4×10-4，第一判别器的学习率为1×10-4，第二判别器的学习率为1×10-4，训练的目标函数如下：其中，V、V、V分别是第一判别器、第二判别器和生成器的损失函数，G为生成器，D1为第一判别器，D2为第二判别器，C为图样-星座转换网络，z为输入生成器的随机噪声，x为作为训练集的真实时频二维图样，E表示期望，x～pdata表示x服从真实数据集的概率分布，z～pz表示输入的噪声满足随机分布，λ1和λ2分别为第一判别器和第二判别器在生成器目标函数中所占的权重。本发明的有益效果是：本发明在对GAN网络进行训练时，设计了双判别器分别从时频域结构和符号星座分布对生成图样进行约束，使得生成图样能生成满足特定协议要求的子载波结构和调制方式的OFDM信号。附图说明图1为本发明实施例中基于生成对抗网络的OFDM信号生成方法的原理示意图。图2为WIFI 802.11a信号的实部对应的时频二维图样。图3为本发明实施例中双判别器GAN的网络结构图。图4是将一个子载波个数为64且使用QPSK调制的OFDM实部时频二维图样转换为分辨率为100的星座密度图的转换流程示意图。图5为本发明实施例中以FFT点数为64的OFDM信号时频二维图样为例的图样-星座转化器网络结构。图6为生成器网络结构示意图。图7为判别器1和判别器2的网络结构示意图。图8为生成器生成的调制方式分别为QPSK、信噪比为20dB的时频二维图样。图9为对生成的时频二维图样和真实的时频二维图样的真实星座密度图。图10为基于生成对抗网络的OFDM信号生成模型生成的数据段OFDM信号时域波形和WIFI 802.11a标准的数据段OFDM真实信号时域波形对比图。具体实施方式为使本发明的目的、技术方法和优点更加清楚，下面结合实施方式和附图，对本发明作进一步地详细描述。一种基于生成对抗网络的OFDM信号生成方法，其流程如图1所示，通过对符合某种特定协议的OFDM时域符号去CP后进行FFT预处理，得到OFDM信号的时频二维图样，将图样作为真实样本输入多判别器的GAN网络进行训练，在生成器和判别器达到纳什均衡后，将生成器生成的时频二维图样进行IFFT，即可得到同样符合该协议的时域信号。将参数不同的OFDM信号输入该系统进行训练，得到的GAN网络生成器可实现不同参数的OFDM复杂协议信号输出。该方法的步骤如下：a.根据图1所示，首先对接收到的OFDM时域信号r进行预处理。首先将r进行串并转换并去掉CP后，得到维度为NT×NFFT的矩阵r′，其中NT为OFDM符号数量，NFFT为FFT点数。矩阵的每一行代表一个OFDM符号的时域序列。将矩阵r′中的每一行进行FFT，将信号从时域变换到频域即得到时频二维矩阵经过式所示的归一化处理后，得到二维矩阵rnorm。式中，./代表矩阵每一行与列向量中对应行的元素相除，max代表矩阵中每一行的最大值组成的列向量，abs代表矩阵中每个元素的幅度，j为虚数单位。归一化后的矩阵rnorm的每个元素的实部和虚部的取值范围为。提取矩阵rnorm的每一个元素实部和虚部并且分别组成新的时频二维矩阵和以单通道灰度图像的形式存储上述矩阵并将其作为我们提出的双判别器GAN训练集。以WIFI 802.11a协议中数据部分的OFDM信号为例，该信号经过上述预处理后得到的实部时频二维图样如图2所示。在该协议中，FFT点数为64，因此图样有64列，分别代表64个频域子载波，图样的100行分别代表100个OFDM符号。在64个子载波中有48个数据子载波，每个数据子载波上搭载了随机的QPSK符号，在实部时频二维图样中为黑白交错的像素点；4个搭载导频的子载波为白色；剩余的12列为空子载波，在图样中为灰色。b.将步骤a得到的时频二维图样输入如图3所示的双判别器GAN进行训练，在双判别器GAN中，除了常规GAN中的判别器1以外，增加了一个判别器2。该判别器的目的是约束生成图样中调制符号的星座分布，判断生成图样的调制星座分布是否与真实图样相同。如果相同，则判断为真，如果不同，则判断为假。本实施例使用LSGAN作为基网络。分别采用0、1表示虚假样本和真实样本的标签，并且为使生成器生成样本尽可能真实，令判别器判别样本真假的决策边界为1。双判别器的GAN的目标函数定义如下：其中，G为生成器，D1为判别器1，D2为判别器2，C为图样星座转换网络，z为输入生成器的随机噪声，x为作为训练集的真实时频二维图样，E表示期望，x～pdata表示x服从真实数据集的概率分布，z～pz表示输入的噪声满足随机分布，λ1和λ2分别为判别器1和判别器2在生成器目标函数中所占的权重。为了判断时频二维图样中数据符号调制星座的分布的真假，判别器2的输入分别为真实图样和生成图样的星座密度图。本实施例提出了图样-星座转换网络，该网络是离线训练的，其功能是实现时频二维图样到星座密度图的转换，时频二维图样转换到星座密度图的方式如图4所示。以WIFI 802.11a协议中携带数据的OFDM信号为例，输入的时频二维图样尺寸为100×64，代表长度为100个OFDM符号周期的信号对应的时频二维实部图样。首先将等分为100份，并且统计时频二维图样中每一行像素点的幅度在这100个区间的概率密度。将每一行统计得到的概率密度分布进行归一化，分别保存到维度为1×100的向量中。最终对得到的向量按行拼接得到维度为100×100的矩阵，该矩阵即为星座密度图。本实施例使用类似卷积自编码器拟合上述的量化统计流程。通过卷积和反卷积等操作，提取时频二维图样数据点的星座分布特征，生成星座密度图。图样-星座转换网络结构如图5所示。生成器由反卷积和卷积神经网络模块构成，具体结构如图6所示。在图样结构和星座数据双判别器作用下，将输入的随机噪声转化逼近真实样本的时频二维图样。判别器由卷积网络模块构成，具体结构如图7所示。作用是尽可能正确区分输入的真实样本和生成样本。为了验证本实施例中的基于判别器的OFDM信号生成模型的有效性，选用了WIFI802.11a PLCP协议数据单元中的数据段作为真实信号进行了信号生成实验。数据段由OFDM符号构成，子载波个数64，其中搭载数据符号的子载波个数为48个，分别位于第2～7，9～21，23～27，39～43，45～57和59～64个子载波；导频占据4个子载波，分布在第8、22、44、58个子载波；其余的12个为空子载波。信号带宽为20MHz，每个OFDM符号持续时间为4us，CP长度为0.8us，在采样率为20MHz的情况下，一个OFDM符号包含80个采样点，其中CP包含16个采样点。表1和表2分别给出了仿真参数和模型训练所选用的超参数。表1仿真参数参数值数据子载波个数48导频子载波个数4NFFT：总子载波个数/FFT点数64B：带宽20MHz调制方式QPSKSNR：信道信噪比20dB预处理所得时频二维图尺寸100*64每一信噪比及调制下方式样本数据集大小10000表2双判别器LSGAN训练超参数参数值Batch_size40生成器学习率4e-4判别器1学习率1e-4判别器2学习率1e-4优化器Adam判别器1损失函数权重λ10.1判别器2损失函数权重λ20.4c.将随机噪声输入训练好的生成器模型即得到如图8所示的满足WIFI 802.11aPLCP协议的OFDM频域信号的实部或虚部时频二维图样，真实的和生成的时频二维图样对应的星座密度图如图9所示。d.对步骤c中得到的时频二维图样的实部和虚部相加，并进行IFFT和并串转换即得到如图10所示的满足WIFI 802.11a PLCP协议的的OFDM时域信号。总之，本发明针对OFDM信号时域特征提取困难的问题，首先，使用快速傅里叶变换对时域OFDM信号进行预处理，并将处理后的频域符号向量拼接为二维数据矩阵；然后，将数据矩阵以灰度图像的方式存储为时频二维图样，用于GAN的训练和测试。此外，本发明设计了双判别器GAN，使用一个生成器与两个判别器同时进行博弈，生成器的目的是生成时频二维图样以欺骗两个判别器，而两个判别器分别从子载波结构和调制符号的星座密度两个方面区分生成的图样和真实图样，以保证生成信号符合OFDM时频域特征的要求。本发明可以实现复杂协议OFDM信号生成。
