标题title
一种基于双预测控制的三相无功补偿器的控制方法
摘要abst
本发明涉及一种基于双预测控制的三相无功补偿器的控制方法，按如下步骤进行三相无功补偿器的控制：采样当前直流侧电压Udc，通过电压预测公式计算出当前所需要的参考电流Id_ref；设定所需要的无功电流参考值Iq_ref，并对有功无功参考电流进行坐标变换得到αβ坐标系下的电流参考值；同时采样电网侧的三相电网电流，代入电流模型预测控制计算公式，并带入代价函数，寻找最优开关矢量；将最优开关矢量作用至逆变器，得到接近参考电流值的真实电流，完成控制过程。该方法不仅可以避免双闭环控制的PI参数整定过程，而且能够加快系统的整体动态响应速度。
权利要求书clms
1.一种基于双预测控制的三相无功补偿器的控制方法，其特征在于，按如下步骤进行三相无功补偿器的控制：采样当前直流侧电压Udc，通过电压预测公式计算出当前所需要的参考电流Id_ref；设定所需要的无功电流参考值Iq_ref，并对有功无功参考电流进行坐标变换得到αβ坐标系下的电流参考值；同时采样电网侧的三相电网电流，代入电流模型预测控制计算公式，并带入代价函数，寻找最优开关矢量；将最优开关矢量作用至逆变器，得到接近参考电流值的真实电流，完成控制过程。2.根据权利要求1所述的一种基于双预测控制的三相无功补偿器的控制方法，其特征在于，不仅适用于三电平NPC拓扑结构的变换器，还适用于不同的三相拓扑结构，包括三相全桥、五电平NNPC和七电平CHB拓扑结构。3.根据权力要求1所述的一种基于双预测控制的三相无功补偿器的控制方法，其特征在于，采用包括电压外环预测控制和电流内环预测控制的双预测控制。4.根据权力要求1所述的一种基于双预测控制的三相无功补偿器的控制方法，其特征在于，所述三相无功补偿器为三相三电平NPC拓扑结构的无功功率补偿器，主要由三相三电平NPC变换器、直流侧电容、三相L型滤波器、三相电网、电压外环预测控制和电流内环模型预测控制组成；其中三相电网电压为Ua、Ub、Uc，三相电感电流为Ia、Ib、Ic，直流电容电压为Udc_upper和Udc_lower；为了实现三相三电平NPC拓扑结构的无功功率补偿器的控制，对直流侧电容电压、交流侧无功功率、直流侧电容平衡进行稳定控制，以完成无功补偿器的控制；为了对直流侧电容电压进行稳定控制，电容的电压方程如式所示，并对其进行离散化，求解出其差分方程如式所示；将电压的参考电压Uref代入下一时刻的电压Udck+1，和当前电容电压Udck做差，通过式进行计算，得到当前时刻所需要的直流电流Idc，并通过式进行瞬时功率的计算；Pdc＝Udc*Idc由于功率守恒原则，交流侧的电流由功率守恒转换到交流电网侧来计算；通过式计算出电网所需要的有功电流，由于Uq在旋转坐标系下为0，故Id＝Pactive/Ud；通过将系统的有功电流稳定控制后，将电压稳定在设定的参考值上；完成电压环的预测计算之后得到Id_ref，通过设定的参考无功功率Qref以及无功功率计算公式得到Iq_ref；将dq轴的电流分量转换成αβ坐标系下的电流分量；由式所示，将dq坐标系的电流转换为αβ坐标系下的电流；为了实现对电流的闭环控制，对电感建立方程；根据KVL方程，得出如式所示的计算公式，在已知电网电压Ugrid-αβ后，每一个电压矢量Vs-αβ唯一对应一个输出电流；对其离散化后，得到如式所示的电流预测计算公式；ILαβk+1＝ILαβk+*Ts/L再根据当前时刻的电感电流以及27个电压状态矢量来进行迭代计算，得到27个矢量的下一时刻的电感电流值，并与参考值进行对比，采用式所示的代价函数来进行计算，选择使代价函数G最小的开关矢量，并作用至变换器；G＝|Iαk+1-Iα_refk+1|+|Iβk+1-Iβ_refk+1|针对三电平变换器的拓扑结构的直流侧电容平衡问题，对上下两个电容的直流电压建立模型；电容电压如式所示；对上下电容电压进行做差，得到式；根据式，变换器下一时刻的电容电压与当前时刻的电容电压差值和当前时刻流过中性点电流有关，而中性点电流Io又与开关状态和三相电流Ia、Ib、Ic有关；联立式和，可以求解出27个矢量下一时刻的电容电压偏差，并与式求出的代价函数值进行权重分配，得到式的方程；Io＝Ia*+Ib*+Ic* G＝|Iαk+1-Iα_refk+1|+|Iβk+1-Iβ_refk+1|+λ*|ΔUdck+1|寻找最优矢量Vbest，确定好最优电压开关矢量后，在电压开关矢量图中，寻找到其对应的输出电平，再根据式中的开关状态产生IGBT的驱动信号；最终，完成基于双预测控制的三相无功补偿器的控制。
说明书desc
技术领域本发明属于电力电子技术领域，具体涉及一种基于双预测控制的三相无功补偿器的控制方法。背景技术随着电网的负荷的种类变得越来越多，接入电网的设备产生的有功和无功功率各不相同。由于电网中存在的无功功率会影响电网中的电能质量，当无功功率较多时，会使得电网的功率因数较低，波形质量较差。因此，电网对接入设备的功率因素有相应的规定。除此之外，当电网中的功率因素下降时，还会采用无功补偿器来对电网中无功功率进行补偿或者吸收，从而保证电网中的无功功率处于一个合理的范围。三相无功补偿器从变换器的角度来看，和功率双向流动三相整流器基本一致，只是两者的用途不一样。三相整流器通常从三相电网中取电，经过相应的控制将三相交流电整流为直流电，并提供给直流负载。而无功补偿器则是三相整流器工作在只发出或者吸收无功功率的工作模式下，变换器的直流端只有直流电容，不接负载电阻。从理论上，无功补偿器完全不消耗有功功率，只以纯无功工作状态下运行。但由于变换器系统中存在内阻，因此需要从电网中吸收少量的有功功率来维持直流侧电压的稳定，从而使得无功补偿器能够稳定的运行。目前，工业上对于三相无功补偿器运用的最成熟且最广泛的还是电压电流双闭环PI控制。电压电流双闭环控制因其稳定性而受到工业上广泛的运用。然而，双闭环PI控制也存在着许多问题。对于不同的无功补偿系统，其电压电流双闭环参数也不一样，双闭环控制系统的参数整定也是一个比较复杂的过程。此外，电压环和电流环的动态响应速度也受到PI参数的制约，动态响应速度无法达到非常快的速度。发明内容本发明的目的在于提供一种基于双预测控制的三相无功补偿器的控制方法，该方法不仅可以避免双闭环控制的PI参数整定过程，而且能够加快系统的整体动态响应速度。为实现上述目的，本发明采用的技术方案是：一种基于双预测控制的三相无功补偿器，按如下步骤进行三相无功补偿器的控制：采样当前直流侧电压Udc，通过电压预测公式计算出当前所需要的参考电流Id_ref；设定所需要的无功电流参考值Iq_ref，并对有功无功参考电流进行坐标变换得到αβ坐标系下的电流参考值；同时采样电网侧的三相电网电流，代入电流模型预测控制计算公式，并带入代价函数，寻找最优开关矢量；将最优开关矢量作用至逆变器，得到接近参考电流值的真实电流，完成控制过程。进一步地，不仅适用于三电平NPC拓扑结构的变换器，还适用于不同的三相拓扑结构，包括三相全桥、五电平NNPC和七电平CHB拓扑结构。进一步地，采用包括电压外环预测控制和电流内环预测控制的双预测控制。进一步地，所述三相无功补偿器为三相三电平NPC拓扑结构的无功功率补偿器，主要由三相三电平NPC变换器、直流侧电容、三相L型滤波器、三相电网、电压外环预测控制和电流内环模型预测控制组成；其中三相电网电压为Ua、Ub、Uc，三相电感电流为Ia、Ib、Ic，直流电容电压为Udc_upper和Udc_lower；为了实现三相三电平NPC拓扑结构的无功功率补偿器的控制，对直流侧电容电压、交流侧无功功率、直流侧电容平衡进行稳定控制，以完成无功补偿器的控制；为了对直流侧电容电压进行稳定控制，电容的电压方程如式所示，并对其进行离散化，求解出其差分方程如式所示；将电压的参考电压Uref代入下一时刻的电压Udck+1，和当前电容电压Udck做差，通过式进行计算，得到当前时刻所需要的直流电流Idc，并通过式进行瞬时功率的计算；Pdc＝Udc*Idc 由于功率守恒原则，交流侧的电流由功率守恒转换到交流电网侧来计算；通过式计算出电网所需要的有功电流，由于Uq在旋转坐标系下为0，故Id＝Pactive/Ud；通过将系统的有功电流稳定控制后，将电压稳定在设定的参考值上；完成电压环的预测计算之后得到Id_ref，通过设定的参考无功功率Qref以及无功功率计算公式得到Iq_ref；将dq轴的电流分量转换成αβ坐标系下的电流分量；由式所示，将dq坐标系的电流转换为αβ坐标系下的电流；为了实现对电流的闭环控制，对电感建立方程；根据KVL方程，得出如式所示的计算公式，在已知电网电压Ugrid-αβ后，每一个电压矢量Vs-αβ唯一对应一个输出电流；对其离散化后，得到如式所示的电流预测计算公式；ILαβk+1＝ILαβk+*Ts/L 再根据当前时刻的电感电流以及27个电压状态矢量来进行迭代计算，得到27个矢量的下一时刻的电感电流值，并与参考值进行对比，采用式所示的代价函数来进行计算，选择使代价函数G最小的开关矢量，并作用至变换器；G＝|Iαk+1-Iα_refk+1|+|Iβk+1-Iβ_refk+1| 针对三电平变换器的拓扑结构的直流侧电容平衡问题，对上下两个电容的直流电压建立模型；电容电压如式所示；对上下电容电压进行做差，得到式；根据式，变换器下一时刻的电容电压与当前时刻的电容电压差值和当前时刻流过中性点电流有关，而中性点电流Io又与开关状态和三相电流Ia、Ib、Ic有关；联立式和，求解出27个矢量下一时刻的电容电压偏差，并与式求出的代价函数值进行权重分配，得到式的方程；Io＝Ia*+Ib*+Ic* G＝|Iαk+1-Iα_refk+1|+|Iβk+1-Iβ_refk+1|+λ*|ΔUdck+1| 寻找最优矢量Vbest，确定好最优电压开关矢量后，在电压开关矢量图中，寻找到其对应的输出电平，再根据式中的开关状态产生IGBT的驱动信号；最终，完成基于双预测控制的三相无功补偿器的控制。与现有技术相比，本发明具有以下有益效果：1、采用电流内环模型预测控制，可以避免传统的电流内环参数整定过程。2、采用电压外环预测控制，可以避免传统电压外环的参数整定过程。3、采用双预测控制的三相无功补偿器，相较于传统的双闭环PI控制的三相无功补偿器，有着更快的动态响应速度。4、采用双预测控制的三相无功补偿器无需PWM调制模块，控制结构更加简洁。附图说明图1为本发明实施例中三电平NPC拓扑结构的无功补偿器；图2为本发明实施例中三电平空间矢量图；图3为本发明实施例中双预测控制的控制框图；图4为本发明实施例中无功电流变化时的电流动态响应波形；图5为本发明实施例中无功电流变化时的电压动态响应波形；图6为本发明实施例中直流电压参考值变化时的电压动态响应波形。具体实施方式下面结合附图及实施例对本发明做进一步说明。应该指出，以下详细说明都是示例性的，旨在对本申请提供进一步的说明。除非另有指明，本文使用的所有技术和科学术语具有与本申请所属技术领域的普通技术人员通常理解的相同含义。需要注意的是，这里所使用的术语仅是为了描述具体实施方式，而非意图限制根据本申请的示例性实施方式。如在这里所使用的，除非上下文另外明确指出，否则单数形式也意图包括复数形式，此外，还应当理解的是，当在本说明书中使用术语“包含”和/或“包括”时，其指明存在特征、步骤、操作、器件、组件和/或它们的组合。本实施例提供了一种基于双预测控制的三相无功补偿器，按如下步骤进行三相无功补偿器的控制：采样当前直流侧电压Udc，通过电压预测公式计算出当前所需要的参考电流Id_ref；设定所需要的无功电流参考值Iq_ref，并对有功无功参考电流进行坐标变换得到αβ坐标系下的电流参考值；同时采样电网侧的三相电网电流，代入电流模型预测控制计算公式，并带入代价函数，寻找最优开关矢量；将最优开关矢量作用至逆变器，得到接近参考电流值的真实电流，完成控制过程。本发明不仅适用于三电平NPC拓扑结构的变换器，还可推广至不同的三相拓扑结构，如三相全桥、五电平NNPC和七电平CHB拓扑结构等，具有很强的适用性。本发明采用了电压外环预测控制和电流内环预测控制，避免了传统PI控制带来的参数整定问题，降低了系统设计的复杂度。本发明采用的双预测控制相较于传统的PI控制方法有着较快的动态相应速度，能够使系统更快速的达到稳定。如图1所示，在本实施例中，所述三相无功补偿器为三相三电平NPC拓扑结构的无功功率补偿器，主要由三相三电平NPC变换器、直流侧电容、三相L型滤波器、三相电网、电压外环预测控制和电流内环模型预测控制组成；其中三相电网电压为Ua、Ub、Uc，三相电感电流为Ia、Ib、Ic，直流电容电压为Udc_upper和Udc_lower；为了实现三相三电平NPC拓扑结构的无功功率补偿器的控制，对直流侧电容电压、交流侧无功功率、直流侧电容平衡进行稳定控制，以完成无功补偿器的控制。整个双预测控制的控制框图如图3所示。为了对直流侧电容电压进行稳定控制，电容的电压方程如式所示，并对其进行离散化，求解出其差分方程如式所示。将电压的参考电压Uref代入下一时刻的电压Udck+1，和当前电容电压Udck做差，通过式进行计算，得到当前时刻所需要的直流电流Idc，并通过式进行瞬时功率的计算。Pdc＝Udc*Idc 由于功率守恒原则，交流侧的电流由功率守恒转换到交流电网侧来计算；通过式计算出电网所需要的有功电流，由于Uq在旋转坐标系下为0，故Id＝Pactive/Ud；通过将系统的有功电流稳定控制后，将电压稳定在设定的参考值上。完成电压环的预测计算之后得到Id_ref，通过设定的参考无功功率Qref以及无功功率计算公式得到Iq_ref；将dq轴的电流分量转换成αβ坐标系下的电流分量；由式所示，将dq坐标系的电流转换为αβ坐标系下的电流。为了实现对电流的闭环控制，对电感建立方程；根据KVL方程，得出如式所示的计算公式，在已知电网电压Ugrid-αβ后，每一个电压矢量Vs-αβ就能唯一对应一个输出电流；对其离散化后，得到如式所示的电流预测计算公式。ILαβk+1＝ILαβk+*Ts/L 再根据当前时刻的电感电流以及27个电压状态矢量来进行迭代计算，得到27个矢量的下一时刻的电感电流值，并与参考值进行对比，采用式所示的代价函数来进行计算，选择使代价函数G最小的开关矢量，并作用至变换器。G＝|Iαk+1-Iα_refk+1|+|Iβk+1-Iβ_refk+1| 针对三电平变换器的拓扑结构的直流侧电容平衡问题，对上下两个电容的直流电压建立模型；电容电压如式所示。对上下电容电压进行做差，得到式；根据式，变换器下一时刻的电容电压与当前时刻的电容电压差值和当前时刻流过中性点电流有关，而中性点电流Io又与开关状态和三相电流Ia、Ib、Ic有关。联立式和，求解出27个矢量下一时刻的电容电压偏差，并与式求出的代价函数值进行权重分配，得到式的方程。Io＝Ia*+Ib*+Ic* G＝|Iαk+1-Iα_refk+1|+|Iβk+1-Iβ_refk+1|+λ*|ΔUdck+1| 寻找最优矢量Vbest，确定好最优电压开关矢量后，在图2的电压开关矢量图中，寻找到其对应的输出电平，再根据式中的开关状态产生IGBT的驱动信号。最终，完成基于双预测控制的三相无功补偿器的控制。为了体现出本发明的优点，将双预测控制的三相无功补偿器和电压电流双闭环PI控制进行一些性能上的对比控制。从控制策略的角度来看，双闭环PI控制中需要对电压外环的PI参数以及电流内环的PI参数进行合适的选取，才能够达到较好的动态响应速度。然而，如何对PI参数进行整定也是一个比较复杂的过程。本发明采用的双预测控制不需要进行PI参数的整定，即可完成整个过程的控制，且能够实现较快的动态响应速度。从无功补偿器的性能角度来看，对两种方法进行了一些仿真的测试。分别测试了在直流电压参考值发生变化时的电压动态响应速度，以及在无功电流参考值发生变化时的电流动态响应速度以及电压动态响应速度。如图4、5所示的是在无功电流发生变化时的电流动态响应速度和直流电压波动情况。从图4中可以看出，双预测控制的电流动态相应波形要明显快于双闭环PI控制的速度。而图5中的电压抗扰动波形更加明显。双闭环PI控制的无功补偿器出现了明显的电压波动与调节过程。而双预测控制的无功补偿器仅出现了一个电压暂降尖峰就恢复稳定，响应速度在0.01s内完成。而图6中也同样印证了当电压参考值变化时，双预测控制的动态响应速度同样明显快于双闭环PI控制。综上所述，本发明所提的双预测控制从参数整定的角度、动态响应速度的角度均要优于双闭环PI控制。以上所述，仅是本发明的较佳实施例而已，并非是对本发明作其它形式的限制，任何熟悉本专业的技术人员可能利用上述揭示的技术内容加以变更或改型为等同变化的等效实施例。但是凡是未脱离本发明技术方案内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化与改型，仍属于本发明技术方案的保护范围。
