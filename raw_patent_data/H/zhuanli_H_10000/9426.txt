标题title
一种在不安全信道上交换秘钥的方法
摘要abst
本发明涉及信息技术领域，具体涉及一种在不安全信道上交换秘钥的方法，包括：公开正整数n；通信方甲生成正整数d，计算x1=sin，将x1发送给通信方乙；通信方乙生成正整数e，计算x2=sin，将x2发送给通信方甲；通信方甲收到x2后，使用正弦函数的倍角公式计算秘钥Key=floor))；通信方乙收到x1后，使用正弦函数的倍角公式计算秘钥Key=floor))；Key将相同。本发明的实质性效果是：秘钥不需要在信道上传播即可完成秘钥的交换，实现在不安全信道上建立安全的通信。
权利要求书clms
1.一种在不安全信道上交换秘钥的方法，其特征在于，包括：公开正整数n；通信方甲生成正奇数d，计算x1=sin，将x1发送给通信方乙；通信方乙生成正奇数e，计算x2=sin，将x2发送给通信方甲；通信方甲收到x2后，使用正弦函数的倍角公式计算秘钥Key=floor))，其中整数d为倍数，floor为向下取整，abs为取绝对值；通信方乙收到x1后，使用正弦函数的倍角公式计算秘钥Key= floor))，其中整数e为倍数；通信方甲和通信方乙计算获得的Key将相同，完成秘钥的交换。2.根据权利要求1所述的一种在不安全信道上交换秘钥的方法，其特征在于，将交换秘钥中使用的正弦函数全部替换为使用余弦函数。3.根据权利要求1或2所述的一种在不安全信道上交换秘钥的方法，其特征在于，公开正整数N，通信方甲计算x1=sin，通信方乙计算x2=sin，通信方甲计算秘钥Key=floor))，通信方乙计算秘钥Key=floor))，通信方甲和通信方乙计算获得的Key将相同。
说明书desc
技术领域本发明涉及信息技术领域，具体涉及一种在不安全信道上交换秘钥的方法。背景技术计算机网络已深入影响人们的生活和工作，网络的繁荣也极大的改善了人们的生活质量和工作效率。如今在网络上无时无刻不在传输着大量的数据。数据传输安全也成为领域始终重要的研究课题之一。一般来讲，在不安全的信道上传输加密数据是安全的，因为窃取者无法获得解密秘钥。但数据接收方同样需要由不安全信道从发送方处获取解密秘钥。导致解密秘钥存在被窃听的风险，一旦解密秘钥被窃听，就会导致加密数据泄露。为此需要研究一种在不安全信道上实现秘钥安全交换的技术。现有技术中与本专利申请技术最为接近的技术为DH算法，通信双方公开参数P和G，而后各自生成随机数A和B，第一个通信者将S1=G^A%P发送给对方，第二个通信者将S2=G^B%P发送给对方，第一个通信者计算S2^A%P即为秘钥，第二个通信者计算S2^B%P即为秘钥，实现秘钥的安全交换。在DH算法中需要P是一个非常大的质数才能保证秘钥的安全。发明内容本发明欲提供一种新的在不安全信道上交换秘钥的技术方案。为此，本发明所采取的技术方案为：一种在不安全信道上交换秘钥的方法，包括：公开正整数n；通信方甲生成正奇数d，计算x1=sin，将x1发送给通信方乙；通信方乙生成正奇数e，计算x2=sin，将x2发送给通信方甲；通信方甲收到x2后，使用正弦函数的倍角公式计算秘钥Key=floor))，其中整数d为倍数，floor为向下取整，abs为取绝对值；通信方乙收到x1后，使用正弦函数的倍角公式计算秘钥Key= floor))，其中整数e为倍数；通信方甲和通信方乙计算获得的Key将相同，完成秘钥的交换。作为优选，将交换秘钥中使用的正弦函数全部替换为使用余弦函数。作为优选，公开整数N，通信方甲计算x1=sin，通信方乙计算x2=sin，通信方甲计算秘钥Key=floor))，通信方乙计算秘钥Key=floor))，通信方甲和通信方乙计算获得的Key将相同。本发明的实质性效果是：秘钥不需要在信道上传播即可完成秘钥的交换，实现在不安全信道上建立安全的通信。附图说明图1为交换秘钥方法示意图。具体实施方式下面通过具体实施例，并结合附图，对本发明的具体实施方式作进一步具体说明。一种在不安全信道上交换秘钥的方法，请参阅附图1，包括：公开正整数n；通信方甲生成正奇数d，计算x1=sin，将x1发送给通信方乙；通信方乙生成正奇数e，计算x2=sin，将x2发送给通信方甲；通信方甲收到x2后，使用正弦函数的倍角公式计算秘钥Key=floor))，其中整数d为倍数，floor为向下取整，abs为取绝对值；通信方乙收到x1后，使用正弦函数的倍角公式计算秘钥Key= floor))，其中整数e为倍数；通信方甲和通信方乙计算获得的Key将相同，完成秘钥的交换。表1 秘钥交换过程表通信方甲窃听者通信方乙n=10n=10n=10d=7,x1=sin--x1=0.656986598718x1=0.656986598718x1=0.656986598718--e=3,x2=sinx2=0.141120008059x2=0.141120008059x2=0.141120008059Key=floor))-Key=floor))Key=8366556385-Key=8366556385如表1所示，为本实施例进行秘钥交换的过程中，通信方甲、通信方乙和窃听者获得的数据。通信方甲生成n=10发送给通信方乙，约定最终的秘钥取10位数字。而后通信方甲生成正整数d=7并保密。计算x1=sin=0.656986598718，将x1发送给通信方乙，窃听者能够窃听到x1的值。本实施例中n的值为10，x1的有效数字位数超过10即可，如表1中的x1有效数字的位数为12位。通信方乙生成正整数e=3，计算x2=sin=0.141120008059，将x2发送给通信方甲，窃听者能够窃听到x2的值。本领域已公开正弦函数的倍角公式为：sin=∑^k*m!/!*!)*^*^，其中m为偶数，k∈。sin=∑^k*m!/!*!)*^*^，其中m为奇数，k∈。余弦函数的倍角公式为：cos=∑^k*m!/!*!)*^*^，其中m为偶数，k∈。cos=∑^k*m!/!*!)*^*^，其中m为奇数，k∈。通信方甲通过倍角公式，并将其中)^2替换为)^2)，获得计算sin的计算式为：sin=7*sin-56*sin^3+112*sin^5-64*sin^7。将其中的sin使用x2的值代入，获得sin=7*x2-56*x2^3+112*x2^5-64*x2^7=0.83665563853606。从而获得Key=floor)=8366556385。通信方乙通过倍角公式，并将其中)^2替换为)^2)，获得计算sin的计算式为：sin=3*sin-4*sin^3=3*x1-4*x1^3=0.83665563853606。从而获得Key=floor)=8366556385。可见通信方甲和通信方乙获得的Key是相同的。当d和e为奇数时，正弦函数倍角公式中不含有余弦项，余弦函数倍角公式中不含有正弦项，能够仅依靠正弦函数值或者余弦函数值即可计算倍角的正弦函数值或者余弦函数值。将交换秘钥中使用的正弦函数全部替换为使用余弦函数，能够同样进行实施。本实施例的安全性建立在计算整数的正弦值快捷准确，而从正弦函数值反向推算整数则十分困难。由正弦函数值反向推算正奇数，有两种方式：穷举破解和反正弦函数计算。穷举破解需要逐个遍历每个可能值，即尝试生成猜测值d’，计算sin，使sin恰好与公开的x1相同。本实施例中x1=sin，具有12位有效数字。随机生成猜测值d’，猜测值的正弦值sin与sin相同的概率为1/10^12。即在12位有效需要数字的情况下，理论上需要进行10^12次正弦函数运算。当正弦值保留100位有效数字时，理论上需要进行10^100次正弦函数运算。以1GHz的计算频率，需要用时10^91秒，约3*10^82年。以537212.00Tflops的算力进行计算时， Tflops为每秒万亿次浮点运算，认为正弦函数计算与单次浮点运算时间相同，需要的时间仍为2*10^82秒，约6*10^73年。可见，通过增加有效数字数量，足以应对穷举破解。由于反正弦函数arcsin的值域为，得到反正弦函数arcsin的值后，还需要进行修正。例如，当d=7时，正弦函数值sin=0.65698659871879，窃听者尝试使用反正弦函数arcsin反推d的方法包括：计算arcsin=0.71681469282041；尝试找到正整数k，使得为整数，或者十分接近整数。尝试后得出当k=1时，=7。从而由正弦函数值，反推出整数值。但是当d的值较大时，如d=700时，正弦函数值sin=0.54397052336338，窃听者尝试反推d的方法为：计算arcsin=0.5751617505239；尝试找到正整数k，使得为整数，或者十分接近整数。尝试后发现，当k∈时，使用14位有效数字计算时，不存在正好使得为整数的k值。而其中最接近700的值为698.00873084746和704.29191615464，此时k的值分别为111和112。然而窃听者没有理由将698.00873084746规整为700，而应规整为698，也没有理由将704.29191615464规整为700，而应规整为704，因此当d和e的值稍大时，就使得以14位有效数字的精度进行计算时，无法正确由函数值反推出整数值。可见本实施例能够有效应对通过反正弦函数进行破解的攻击。计算已知大整数D的正弦函数值时，首先计算T=floor，k的值与大整数的位数有关，k小于等于大整数的位数，k的值越大计算精度越高。记大整数为D，计算D-T，若D-T为正，则再次计算D-T，直到D-T为负。而后更新T=floor，再不断计算D-T，直到D-T为负值。当T的值小于10时，获得最终的D-T的值记为_final，计算sin_final)，并保留预设个有效数字，即获得sin的值。本实施例的有益技术效果是：秘钥不需要在信道上传播即可完成秘钥的交换，实现在不安全信道上建立安全的通信。实施例二：为了进一步提高由正弦函数值，反向推断正奇数的值，本实施例在实施例一的基础上，进行了进一步的改进。本实施例中，通信方甲和通信方乙首先公开整数N，通信方甲计算x1=sin，通信方乙计算x2=sin，通信方甲计算秘钥Key=floor))，通信方乙计算秘钥Key=floor))，通信方甲和通信方乙计算获得的Key将相同。由已知正弦函数值反推整数值时，因整数N的影响，使窃听者需要遍历的区间将拉大。而采用实施例二的技术方案时，如设置N=700，设置d=1，则sin=sin=0.54397052336338，同样计算asin后，尝试找到正整数k，使得为整数，或者十分接近整数，且为700的倍数或者十分接近700的倍数。当k∈时，其中仅有180个接近700的倍数的值。即进行2万次计算后，仅能够获得180个可能的值。其中最接近d=1的相关值为698.00873084746和704.29191615464，k的值分别为111和112，由于窃听者无法确定d的值，因此必然尝试寻找最接近d=2时的k的值。最接近d=2的相关值为1395.4422999444和1401.7254852516，相应的k的值分别为222和223。可见1401.7254852516为最接近700的倍数的值。此时窃听者会认为d=2的概率大于d=1。再向后进行大量计算可能会获得更为接近700倍数的值，但均为错误值。因此本实施例足够产生混淆的效果。虽然仍要求d和e的值不能太小，但相对于DH算法已大幅减小。较小的d和e的值，占用通信长度较小，且计算更为快速。以上所述的实施例只是本发明的一种较佳的方案，并非对本发明作任何形式上的限制，在不超出权利要求所记载的技术方案的前提下还有其它的变体及改型。
