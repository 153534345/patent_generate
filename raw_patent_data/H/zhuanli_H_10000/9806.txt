标题title
一种适用于高速运动场景的同步帧结构及其同步方法
摘要abst
本发明属于通信技术领域，涉及一种适用于高速运动场景的同步帧结构及其同步方法。本发明所提出一种同步帧结构设计，同步帧包括依次拼接的第一同步头、第二同步头、第三同步头，并且第一同步头、第二同步头和第三同步头经过了DDC_num倍插值，DDC_num为正整数，第一同步头为将长度为L的第一PN序列复制Sync1_num份并依次拼接，采用长度为L的第二PN序列作为第二同步头，第三同步头为将长度为L的第三PN序列复制Sync3_num份并依次拼接。根据所给的实施例能够抵抗的频偏和10.48576ms以内的时延，并在‑25dB信噪比下达到99％以上的捕获概率，具有隐蔽性，适用于TDMA时分复用帧并可灵活调配时隙进行突发通信，并可通过简单灵活的扩展能够实现更宽的抗频偏性能和抗时延性能。
权利要求书clms
1.一种适用于高速运动场景的同步帧，其特征在于，所述同步帧包括依次拼接的第一同步头、第二同步头、第三同步头，并且第一同步头、第二同步头和第三同步头经过了DDC_num倍插值，DDC_num为正整数；所述第一同步头的生成方式为，将长度为L的第一PN序列复制Sync1_num份并依次拼接，得到第一同步头；所述第二同步头的生成方式为，采用长度为L的第二PN序列作为第二同步头；所述第三同步头的生成方式为，将长度为L的第三PN序列复制Sync3_num份并依次拼接，得到第三同步头；所述第一PN序列、第二PN序列和第三PN序列均为m序列，所述同步帧具备以下的特性：抗频偏性能为，其中Fs为抽样频率，X为接收端分段匹配滤波器的分段数，X＞＝1，X为正整数，Fd_num根据公式和实际需要的抗频偏性能来计算，Fd_num为正整数；Sync1_num与Fd_num有关，满足Sync1_num＞＝3*Fd_num+1；Sync3_num与精定时和精频偏误差有关，满足Sync3_num＞＝1，Sync3_num至少为1进行精定时和精频偏，当Sync3_num＞＝2时，利用第三同步头中的第一个长为L的PN序列做精定时，Sync3_num个长为L的PN序列做非相干累积求精频偏，从而降低低信噪比下的精频偏误差；粗频偏精度d_f1＝/，其中接收端分段匹配滤波器每段长X，共P段，L＝P*X，分段相关后得到P个相关值，将P个相关值做N点FFT，其中N＞＝P；精频偏精度d_f2＝/，其中N*M表示对P个相关值补零后做N*M点FFT，M＞＝1，M为正整数；抗时延性能为0～*L*DDC_num*4*2/Fs，T_num为总搜索个数。2.用于如权利要求1所述的一种适用于高速运动场景的同步帧的同步方法，其特征在于，包括以下步骤：S1、根据第一同步头，利用PMF-FFT算法取得伪码相位同步位置phase_temp、粗定时位置StartIdx_1和粗频偏fd_1；S2、根据第二同步头、伪码相位同步位置phase_temp和粗频偏fd_1，得到粗定时位置StartIdx_2；S3、根据第三同步头、伪码相位同步位置phase_temp、粗频偏fd_1和粗定时位置StartIdx_2，得到精定时位置StartIdx_3，此位置也是DDC_num倍插值的最佳采样点位置，从此处可依次下采样得到后续数据；S4、利用第三同步头、伪码相位同步位置phase_temp、粗频偏fd_1和精定时位置StartIdx_3，下采样后进行非相干累积，得到精频偏fd_2；S5、得到数据帧的定时位置StartIdx_4和频偏f_last，完成一帧数据的同步，其中StartIdx4＝StartIdx3+L*DDC_num*Sync3_num，f_last＝fd_1+fd_2。3.根据权利要求2所述的一种适用于高速运动场景的同步帧的同步方法，其特征在于，所述步骤S1的具体方法为：在接收端，进行粗定时和粗频偏估计，在一定延时范围内找到第一同步头，并估计出粗频偏fd_1；具体为：S11、首先对接收到的信号rx的第～个点和第～个点进行DDC_num倍下采样，1＜＝pp＜＝T_num，并累积一个码片中连续的DDC_num个采样点作为一个点，总搜索个数T_num与时延有关，得到L*DDC_num*2个点，以L点为一个小窗，得到Fd_num*2个小窗win8，1＜＝qq＜＝Fd_num*2；S12、对Fd_num*2个小窗，分别预置频偏，每个窗的预置频偏记作f，1＜＝qq＜＝Fd_num*2，当qq在1～Fd_num之间时，f＝*2)*1.024*Fs/；当qq在Fd_num+1～Fd_num*2之间时，f＝*2)*1.024*Fs/；S13、每个小窗win8的L点数据分别与第一同步头做部分匹配滤波和FFT，并记录FFT结果的幅度峰值和N点FFT中的峰值位置，其中部分匹配滤波器每段长X，共计P段，P*X＝L，得到P个部分相关值，对P个部分相关值做N点的FFT，其中N＞＝P，N的取值根据实际应用中对复杂度和频偏估计精度的考量自行调节；S14、每个小窗内的L点数据循环右移1点，即按照原数据索引从1,2,3,...,L-1,L变为L,1,2,...,L-2,L-1；S15、重复S13和S14，直到执行了L次，每个小窗得到L个PMF-FFT峰值和每个峰值出现的位置，求L个峰值的最大值Amax_4096，记录其出现在L个峰值中的索引位置idx_phase_4096，并记录该峰值出现在N点FFT中的索引位置idx_fft_4096；S16、按照S15中所述，共得到Fd_num*2个小窗的峰值Amax_8win、伪码相位idx_phase_8win、FFT峰值索引位置idx_fft_8win，1＜＝qq＜＝8,，求Fd_num*2个小窗各自峰值的最大值Amax和Amax出现在Fd_num*2个窗内的位置ss，则Amax8＝Amax_8win，1＜＝ss8＜＝Fd_num*2，记录伪码相位idx_phase8＝idx_phase_8win、峰值出现在N点FFT中的索引位置idx_fft8＝idx_fft_8win；S17、若pp＜T_num，则重复S11-S16，并令pp＝pp+1；若pp＝T_num，则记录T_num个Amax8、ss8、idx_phase8、和idx_fft8到Amax8_sum、idx_ss8_sum、idx_phase8_sum、idx_fft8_sum；S18、求Amax8_sum～Amax8_sum的最大值，得到其中的最大值A_temp及对应的索引pp5，即A_temp＝Amax8_sum，1＜＝pp5＜＝T_num；S19、基于pp5，得到伪码同步位置phase_temp＝idx_phase8_sum，该位置即为L长的PN码的伪码同步位置，1＜＝phase_temp＜＝L；S110、基于pp5，得到FFT中的峰值位置fft_temp＝idx_fft8_sum该位置即为N点FFT中峰值所处位置；S111、得到粗定时位置StartIdx_1_temp＝*L*DDC_num*4*2+*L*DDC_num+*DDC_num+1+ss8_4，其中当ss8_4取值为0或1，当且仅当ss8取值为1～Fd_num之间时ss8_4为0，ss8取值为Fd_num+1～Fd_num*2之间时ss8_4为1，粗定时位置StartIdx_1一定位于发送帧中的第一同步头中，接收端经过DDC_num倍下采样后，第二同步头最早可能出现在StartIdx_1_temp+L*DDC_num位置，从StartIdx_1_temp+L*DDC_num位置向后搜索Sync_num1个L点的小窗一定能搜索到第二同步头，即粗定时位置StartIdx_1＝StartIdx_1_temp+L*DDC_num＝*L*DDC_num*4*2+ss8*L*DDC_num+*DDC_num+1+ss8_4；S112、设频率间隔为d_f，则所求的该小窗内的频偏为fft_temp2*d_f，其中d_f＝/，当fft_temp在1～N/2范围内fft_temp2＝fft_temp；当fft_temp在N/2+1～N范围内，fft_temp2＝fft_temp-N；Fs为采样频率，DDC_num为采样抽取倍数，X为部分匹配滤波器分段数，N为FFT点数，得到粗频偏为fd_1＝fft_temp2*d_f+f，即窗内频偏+窗本身的预置频偏。4.根据权利要求3所述的一种适用于高速运动场景的同步帧的同步方法，其特征在于，所述步骤S2具体方法为：根据得到的StartIdx_1和粗频偏估计fd_1，寻找第二同步头的位置；具体为：S21、对接收到的信号rx的第～点，使用步骤S1得到的粗频偏fd_1进行频偏补偿，得到rx2；S22、对rx2的第～个点进行DDC_num倍下采样并累积一个码片中连续的DDC_num个采样点作为一个点，得到L*Sync1_num个点，以L点为一个小窗，得到Sync1_num个小窗win14_0；S23、对rx2的第～个点进行DDC_num倍下采样，得到L*Sync1_num个点，以L点为一个小窗，得到Sync1_num个小窗win14_1，1＜＝uu＜＝Sync1_num；S24、通过步骤S1后此时的同步头已经是伪码同步，对win14_0和win14_1的Sync1_num*2个小窗各进行一次步骤S1中的PMF-FFT运算，得到Sync1_num*2个FFT峰值fftM和对应的峰值位置fftM_L，1＜＝vv＜＝Sync1_num*2，其中1＜＝vv＜＝Sync1_num表示win14_0的Sync1_num个窗的数据，Sync1_num+1＜＝vv＜＝Sync1_num*2表示win14_1的Sync1_num个窗的数据；S25、求Sync1_num*2个FFT峰值fftM的最大值fftM_max并记录最大值出现在第vv28个窗，即fftM_max＝fftM，记录对应的峰值位置fftM_L_max＝fftM_L；S26、第二同步头的起始码片出现的位置为StartIdx2＝StartIdx1+*L*DDC_num+vv28_1，其中当vv28取值为1～Sync1_num时，vv14＝vv28，vv28_1＝0，当vv28取值Sync1_num+1～Sync1_num*2时，vv14＝vv28-Sync1_num，vv28_1＝1。5.根据权利要求4所述的一种适用于高速运动场景的同步帧的同步方法，其特征在于，所述步骤S3具体方法为：S31、第三同步头出现的位置为StartIdx3_temp＝StartIdx2+L*DDC_num；S32、考虑到步骤S1中求伪码同步时可能存在1个码片的误差，所以从该位置向前、向后均扩展搜索一个码片，得到第三同步头最早可能出现的位置为StartIdx3_temp2＝StartIdx3_temp-DDC_num；S33、取接收的rx信号的第～第点，使用步骤S1得到的粗频偏fd_1进行频偏补偿，得到rx3；S34、取rx3的第～点，并进行DDC_num倍下采样，得到DDC_num*3组数据win12，每组L个点；S35、由于步骤S1和步骤S2中已经确定了伪码同步，且第一同步头、第二同步头、第三同步头均使用相同长度L的PN序列，所以此时的同步头已经是伪码同步，对win12的DDC_num*3组数据各进行一次步骤S1中的PMF-FFT运算，得到DDC_num*3个FFT峰值fftM3和对应的峰值位置fftM_L3，1＜＝ww＜＝DDC_num*3；S36、求DDC_num*3个FFT峰值fftM3的最大值fftM3_max并记录最大值出现在第ww12组，即fftM3_max＝fftM3，记录对应的峰值位置fftM3_L_max＝fftM3_L；S37、第三同步头出现的起始码片中最佳采样点位置StartIdx3＝StartIdx3_temp2+ww12-1，1＜＝ww12＜＝DDC_num。6.根据权利要求5所述的一种适用于高速运动场景的同步帧的同步方法，其特征在于，所述步骤S4具体方法为：使用第三同步头进行精频偏估计，通过步骤S3已经找到第三同步头的起始码片中的最佳采样点位置；S41、取接收的rx信号的第～第点，使用步骤S1得到的粗频偏fd_1进行频偏补偿，得到rx4；S42、对rx4进行DDC_num倍下采样，得到L*Sync3_num点数据，按索引顺序划分为Sync3_num组，每组L点，记作win16，1＜＝xx＜＝Sync3_num；S43、将N取值扩大M倍后对win16的Sync3_num组数据各进行一次步骤S1中的PMF-FFT运算，即从N点FFT变为N*M点FFT，得到Sync3_num组FFT计算结果fft4，1＜＝xx＜＝Sync3_num，每组结果为N*M点；S44、求Sync3_num个FFT计算结果fft4取模值后进行非相干累积，得到N*M点的结果fft4_sum，求最大值fft4_sum_max并记录最大值出现在第yy点，1＜＝yy＜＝N*M；S45、设频率间隔为d_f2，则所求的该小窗内的频偏为yy*d_f2，其中d_f2＝/，Fs为采样频率，DDC_num为下采样抽取倍数，X为部分匹配滤波器分段数，N为粗频偏时的FFT点数，N*M为精频偏时的FFT点数，得到精频偏为fd_2＝yy*d_f2，其中M点可根据实际的精频偏精度需求选定。7.根据权利要求6所述的一种适用于高速运动场景的同步帧的同步方法，其特征在于，所述步骤S5具体方法为：S51、数据起始位置StartIdx4＝StartIdx3+L*DDC_num*Sync3_num，且该位置也是最佳采样点位置，从此位置开始可以进行数据的下采样；S52、频偏f_last＝fd_1+fd_2。整个同步帧完成伪码同步、定时同步、频偏估计，可抵抗0～*L*DDC_num*4*2/Fs的时延和的频偏，粗频偏精度d_f1＝/，精频偏精度d_f2＝/，为并可通过灵活扩展帧中的同步头1、同步头2、同步头3的长度和接收端的搜索长度，实现更大范围的抗时延特性和抗频偏特性。
说明书desc
技术领域本发明属于通信技术领域，涉及一种适用于高速运动场景的同步帧结构及其同步方法。背景技术随着以高速飞行器为例的高速运动物体之间的通信场景的不断涌现，且运动速度不断提高，由此在通信发射机和接收机之间存在的多普勒频偏越来越大，严重影响通信性能，亟需解决。现有的帧结构及检测算法存在复杂度高、易截获、低信噪比环境下适应性差、抗时延性能差，且很难适应突发通信。解决上述问题的难点在于：在低信噪比下，在有限的传输信号中尽量提高频偏估计和定时的准确度，尽量减少运算复杂度，尽量提高隐蔽性，适用于TDMA时分复用帧并可灵活调配时隙进行突发通信，并通过简单灵活的扩展能够实现更宽的抗频偏性能和抗时延性能。解决上述问题的意义在于：解决了适用于高速移动场景下低信噪比大频偏突发通信的同步帧结构设计和同步检测问题，在做到隐蔽通信的同时提高接收端的同步性能，提高通信质量，并具有可扩展性，为未来更高运动场景下的低信噪比通信、突发通信均奠定了基础。发明内容针对现上述问题，提出了适用于高速移动场景下低信噪比大频偏突发通信的同步帧结构设计和同步检测方案。本发明的技术方案是：提出了一种同步帧结构，并给出相应的同步方法。一种适用于高速运动场景的同步帧，所述同步帧包括依次拼接的第一同步头、第二同步头、第三同步头，并且第一同步头、第二同步头和第三同步头经过了DDC_num倍插值，DDC_num为正整数；所述第一同步头的生成方式为，将长度为L的第一PN序列复制Sync1_num份并依次拼接，得到第一同步头；所述第二同步头的生成方式为，采用长度为L的第二PN序列作为第二同步头；所述第三同步头的生成方式为，将长度为L的第三PN序列复制Sync3_num份并依次拼接，得到第三同步头；所述第一PN序列、第二PN序列和第三PN序列均为m序列，所述同步帧具备以下的特性：抗频偏性能为，其中Fs为抽样频率，X为接收端分段匹配滤波器的分段数，X＞＝1，X为正整数，Fd_num根据公式和实际需要的抗频偏性能来计算，Fd_num为正整数；Sync1_num与Fd_num有关，满足Sync1_num＞＝3*Fd_num+1；Sync3_num与精定时和精频偏误差有关，满足Sync3_num＞＝1，Sync3_num至少为1进行精定时和精频偏，当Sync3_num＞＝2时，利用第三同步头中的第一个长为L的PN序列做精定时，Sync3_num个长为L的PN序列做非相干累积求精频偏，从而降低低信噪比下的精频偏误差；粗频偏精度d_f1＝/，其中接收端分段匹配滤波器每段长X，共P段，L＝P*X，分段相关后得到P个相关值，将P个相关值做N点FFT，其中N＞＝P；精频偏精度d_f2＝/，其中N*M表示对P个相关值补零后做N*M点FFT，M＞＝1，M为正整数；抗时延性能为0～*L*DDC_num*4*2/Fs，T_num为总搜索个数。一种适用于高速运动场景的同步帧的同步方法，包括以下步骤：S1、根据第一同步头，利用PMF-FFT算法取得伪码相位同步位置phase_temp、粗定时位置StartIdx_1和粗频偏fd_1；S2、根据第二同步头、伪码相位同步位置phase_temp和粗频偏fd_1，得到粗定时位置StartIdx_2；S3、根据第三同步头、伪码相位同步位置phase_temp、粗频偏fd_1和粗定时位置StartIdx_2，得到精定时位置StartIdx_3，此位置也是DDC_num倍插值的最佳采样点位置，从此处可依次下采样得到后续数据；S4、利用第三同步头、伪码相位同步位置phase_temp、粗频偏fd_1和精定时位置StartIdx_3，下采样后进行非相干累积，得到精频偏fd_2；S5、得到数据帧的定时位置StartIdx_4和频偏f_last，完成一帧数据的同步，其中StartIdx4＝StartIdx3+L*DDC_num*Sync3_num，f_last＝fd_1+fd_2。进一步的，所述步骤S1的具体方法为：在接收端，进行粗定时和粗频偏估计，在一定延时范围内找到第一同步头，并估计出粗频偏fd_1；具体为：S11、首先对接收到的信号rx的第～个点和第～个点进行DDC_num倍下采样，1＜＝pp＜＝T_num，并累积一个码片中连续的DDC_num个采样点作为一个点，总搜索个数T_num与时延有关，得到L*DDC_num*2个点，以L点为一个小窗，得到Fd_num*2个小窗win8，1＜＝qq＜＝Fd_num*2；S12、对Fd_num*2个小窗，分别预置频偏，每个窗的预置频偏记作f，1＜＝qq＜＝Fd_num*2，当qq在1～Fd_num之间时，f＝*2)*1.024*Fs/；当qq在Fd_num+1～Fd_num*2之间时，f＝*2)*1.024*Fs/；S13、每个小窗win8的L点数据分别与第一同步头做部分匹配滤波和FFT，并记录FFT结果的幅度峰值和N点FFT中的峰值位置，其中部分匹配滤波器每段长X，共计P段，P*X＝L，得到P个部分相关值，对P个部分相关值做N点的FFT，其中N＞＝P，N的取值根据实际应用中对复杂度和频偏估计精度的考量自行调节；S14、每个小窗内的L点数据循环右移1点，即按照原数据索引从1,2,3,...,L-1,L变为L,1,2,...,L-2,L-1；S15、重复S13和S14，直到执行了L次，每个小窗得到L个PMF-FFT峰值和每个峰值出现的位置，求L个峰值的最大值Amax_4096，记录其出现在L个峰值中的索引位置idx_phase_4096，并记录该峰值出现在N点FFT中的索引位置idx_fft_4096；S16、按照S15中所述，共得到Fd_num*2个小窗的峰值Amax_8win、伪码相位idx_phase_8win、FFT峰值索引位置idx_fft_8win，1＜＝qq＜＝8,，求Fd_num*2个小窗各自峰值的最大值Amax和Amax出现在Fd_num*2个窗内的位置ss，则Amax8＝Amax_8win，1＜＝ss8＜＝Fd_num*2，记录伪码相位idx_phase8＝idx_phase_8win、峰值出现在N点FFT中的索引位置idx_fft8＝idx_fft_8win；S17、若pp＜T_num，则重复S11-S16，并令pp＝pp+1；若pp＝T_num，则记录T_num个Amax8、ss8、idx_phase8、和idx_fft8到Amax8_sum、idx_ss8_sum、idx_phase8_sum、idx_fft8_sum；S18、求Amax8_sum～Amax8_sum的最大值，得到其中的最大值A_temp及对应的索引pp5，即A_temp＝Amax8_sum，1＜＝pp5＜＝T_num；S19、基于pp5，得到伪码同步位置phase_temp＝idx_phase8_sum，该位置即为L长的PN码的伪码同步位置，1＜＝phase_temp＜＝L；S110、基于pp5，得到FFT中的峰值位置fft_temp＝idx_fft8_sum该位置即为N点FFT中峰值所处位置；S111、得到粗定时位置StartIdx_1_temp＝*L*DDC_num*4*2+*L*DDC_num+*DDC_num+1+ss8_4，其中当ss8_4取值为0或1，当且仅当ss8取值为1～Fd_num之间时ss8_4为0，ss8取值为Fd_num+1～Fd_num*2之间时ss8_4为1，粗定时位置StartIdx_1一定位于发送帧中的第一同步头中，接收端经过DDC_num倍下采样后，第二同步头最早可能出现在StartIdx_1_temp+L*DDC_num位置，从StartIdx_1_temp+L*DDC_num位置向后搜索Sync_num1个L点的小窗一定能搜索到第二同步头，即粗定时位置StartIdx_1＝StartIdx_1_temp+L*DDC_num＝*L*DDC_num*4*2+ss8*L*DDC_num+*DDC_num+1+ss8_4；S112、设频率间隔为d_f，则所求的该小窗内的频偏为fft_temp2*d_f，其中d_f＝/，当fft_temp在1～N/2范围内fft_temp2＝fft_temp；当fft_temp在N/2+1～N范围内，fft_temp2＝fft_temp-N；Fs为采样频率，DDC_num为采样抽取倍数，X为部分匹配滤波器分段数，N为FFT点数，得到粗频偏为fd_1＝fft_temp2*d_f+f，即窗内频偏+窗本身的预置频偏。进一步的，所述步骤S2具体方法为：根据得到的StartIdx_1和粗频偏估计fd_1，寻找第二同步头的位置；具体为：S21、对接收到的信号rx的第～点，使用步骤S1得到的粗频偏fd_1进行频偏补偿，得到rx2；S22、对rx2的第～个点进行DDC_num倍下采样并累积一个码片中连续的DDC_num个采样点作为一个点，得到L*Sync1_num个点，以L点为一个小窗，得到Sync1_num个小窗win14_0；S23、对rx2的第～个点进行DDC_num倍下采样，得到L*Sync1_num个点，以L点为一个小窗，得到Sync1_num个小窗win14_1，1＜＝uu＜＝Sync1_num；S24、通过步骤S1后此时的同步头已经是伪码同步，对win14_0和win14_1的Sync1_num*2个小窗各进行一次步骤S1中的PMF-FFT运算，得到Sync1_num*2个FFT峰值fftM和对应的峰值位置fftM_L，1＜＝vv＜＝Sync1_num*2，其中1＜＝vv＜＝Sync1_num表示win14_0的Sync1_num个窗的数据，Sync1_num+1＜＝vv＜＝Sync1_num*2表示win14_1的Sync1_num个窗的数据；S25、求Sync1_num*2个FFT峰值fftM的最大值fftM_max并记录最大值出现在第vv28个窗，即fftM_max＝fftM，记录对应的峰值位置fftM_L_max＝fftM_L；S26、第二同步头的起始码片出现的位置为StartIdx2＝StartIdx1+*L*DDC_num+vv28_1，其中当vv28取值为1～Sync1_num时，vv14＝vv28，vv28_1＝0，当vv28取值Sync1_num+1～Sync1_num*2时，vv14＝vv28-Sync1_num，vv28_1＝1。进一步的，所述步骤S3具体方法为：S31、第三同步头出现的位置为StartIdx3_temp＝StartIdx2+L*DDC_num；S32、考虑到步骤S1中求伪码同步时可能存在1个码片的误差，所以从该位置向前、向后均扩展搜索一个码片，得到第三同步头最早可能出现的位置为StartIdx3_temp2＝StartIdx3_temp-DDC_num；S33、取接收的rx信号的第～第点，使用步骤S1得到的粗频偏fd_1进行频偏补偿，得到rx3；S34、取rx3的第～点，并进行DDC_num倍下采样，得到DDC_num*3组数据win12，每组L个点；S35、由于步骤S1和步骤S2中已经确定了伪码同步，且第一同步头、第二同步头、第三同步头均使用相同长度L的PN序列，所以此时的同步头已经是伪码同步，对win12的DDC_num*3组数据各进行一次步骤S1中的PMF-FFT运算，得到DDC_num*3个FFT峰值fftM3和对应的峰值位置fftM_L3，1＜＝ww＜＝DDC_num*3；S36、求DDC_num*3个FFT峰值fftM3的最大值fftM3_max并记录最大值出现在第ww12组，即fftM3_max＝fftM3，记录对应的峰值位置fftM3_L_max＝fftM3_L；S37、第三同步头出现的起始码片中最佳采样点位置StartIdx3＝StartIdx3_temp2+ww12-1，1＜＝ww12＜＝DDC_num。进一步的，所述步骤S4具体方法为：使用第三同步头进行精频偏估计，通过步骤S3已经找到第三同步头的起始码片中的最佳采样点位置；S41、取接收的rx信号的第～第点，使用步骤S1得到的粗频偏fd_1进行频偏补偿，得到rx4；S42、对rx4进行DDC_num倍下采样，得到L*Sync3_num点数据，按索引顺序划分为Sync3_num组，每组L点，记作win16，1＜＝xx＜＝Sync3_num；S43、将N取值扩大M倍后对win16的Sync3_num组数据各进行一次步骤S1中的PMF-FFT运算，即从N点FFT变为N*M点FFT，得到Sync3_num组FFT计算结果fft4，1＜＝xx＜＝Sync3_num，每组结果为N*M点；S44、求Sync3_num个FFT计算结果fft4取模值后进行非相干累积，得到N*M点的结果fft4_sum，求最大值fft4_sum_max并记录最大值出现在第yy点，1＜＝yy＜＝N*M；S45、设频率间隔为d_f2，则所求的该小窗内的频偏为yy*d_f2，其中d_f2＝/，Fs为采样频率，DDC_num为下采样抽取倍数，X为部分匹配滤波器分段数，N为粗频偏时的FFT点数，N*M为精频偏时的FFT点数，得到精频偏为fd_2＝yy*d_f2，其中M点可根据实际的精频偏精度需求选定。进一步的，所述步骤S5具体方法为：S51、数据起始位置StartIdx4＝StartIdx3+L*DDC_num*Sync3_num，且该位置也是最佳采样点位置，从此位置开始可以进行数据的下采样；S52、频偏f_last＝fd_1+fd_2。至此，整个同步帧完成伪码同步、定时同步、频偏估计，可抵抗0～*L*DDC_num*4*2/Fs的时延和的频偏，粗频偏精度d_f1＝/，精频偏精度d_f2＝/，为并可通过灵活扩展帧中的同步头1、同步头2、同步头3的长度和接收端的搜索长度，实现更大范围的抗时延特性和抗频偏特性。本发明的有益效果为构造了一种单载波系统下解决大频偏、低信噪比通信的同步问题，能够抵抗几百kHz甚至更大的频偏，且能够通过灵活扩展帧结构继续扩展抗频偏性能，在-25dB下达到99％的捕获概率，且能够适用于突发通信。附图说明图1为本发明实施例提供的同步帧和传输帧结构的设计图2为本发明实施例提供的同步算法流程中的步骤三的流程图图3为本发明实施例提供的同步算法流程中的步骤三的示意图图4为本发明实施例提供的同步算法流程中的步骤四的流程图图5为本发明实施例提供的同步算法流程中的步骤四的示意图图6为本发明实施例提供的同步算法流程中的步骤五的流程图图7为本发明实施例提供的同步算法流程中的步骤五的示意图图8为本发明实施例提供的同步算法流程中的步骤六的流程图图9为本发明实施例提供的同步算法流程中的步骤六的示意图图10为本发明实施例提供的同步算法流程中的步骤七的示意图图11为本发明实施例提供的同步帧在不同信噪比下的捕获性能图图12为本发明实施例提供的同步帧在-24dB信噪比下的粗频偏误差图图13为本发明实施例提供的同步帧在-24dB信噪比下的精频偏误差图图14为本发明实施例提供的同步帧在-15dB信噪比下的粗频偏误差图图15为本发明实施例提供的同步帧在-15dB信噪比下的精频偏误差图图16为本发明实施例提供的同步帧在0dB信噪比下的粗频偏误差图图17为本发明实施例提供的同步帧在0dB信噪比下的精频偏误差图图18为本发明实施例提供的同步帧在20dB信噪比下的粗频偏误差图图19为本发明实施例提供的同步帧在20dB信噪比下的精频偏误差图具体实施方式为了使本发明的目的、技术方案及优点更加明白清楚，以下结合一个实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用于解释本发明，并不用于限定本发明。下面结合附图和实施例，详细描述本发明的技术方案：本实施例具体实施过程如下：步骤一：生成L＝4096长度的PN序列1、PN序列2、PN序列3，三者均为4096长度的m序列，分别记为m4096_1、m4096_2、m4096_3，生成多项式分别为：m4096_1生成多项式：；m4096_2生成多项式：；m4096_3生成多项式：；步骤二：如图1所示，对m4096_1复制14份并依次拼接，接着拼接1份m4096_2，然后拼接16份m4096_3，对上述数据经过做4倍插值，形成发送端的同步帧；其中：取Fd_num＝4，Fs＝50MHz，DDC_num＝4，X＝32，抗频偏性能为；Sync1_num＞＝3*Fd_num+1，取Sync1_num＝14；Sync3_num＝16，利用同步头3中的第一个长为4096的PN序列做精定时，精定时完成后，利用16个长为4096的PN序列做非相干累积求精频偏，降低低信噪比下的精频偏误差；粗频偏精度d_f1＝/＝1524Hz，其中接收端分段匹配滤波器每段长X＝32，共P＝128段，L＝4096＝P*X＝128*32，分段相关后得到P＝128个相关值，将P＝128个相关值做N＝256点FFT；精频偏精度d_f2＝/＝95Hz，其中M＝16，N*M表示对步骤二中的P个相关值补零后做N*M＝4096点FFT；抗时延性能为0～*L*DDC_num*4*2/Fs，即0～10.48576ms；步骤三：如图2所示的流程在0～10.48576ms延时范围内寻找同步头1，在对上述同步帧，在接收端，如图3所示找到同步头1后，进行粗定时StartIdx_1，并估计出粗频偏fd_1；首先对收到的信号rx的第～个点和第～个点进行4倍下采样并累积一个码片中连续的4个采样点作为一个点，例如当pp＝1时，累积第1、2、3、4点作为累计后的第1个点，累积第5、6、7、8点作为累计后的第2个点，累积后得到16384*2个点，以4096点为一个小窗，得到8个小窗win8；对8个小窗，分别预置频偏f＝-300kHz、f＝-100kHz、f＝100kHz、f＝300kHz、f＝-300kHz、f＝-100kHz、f＝100kHz、f＝300kHz，记作f；每个小窗win8的4096点数据分别与同步头1做部分匹配滤波和FFT，并记录FFT结果的幅度峰值和N点FFT中的峰值位置，其中部分匹配滤波器每段长X，共计P段，其中P*X＝L＝4096，得到P个部分相关值，对上述P个部分相关值做N点的FFT，其中N＞＝P，N的取值可根据实际应用中对复杂度和频偏估计精度的考量自行调节；每个小窗内的4096点数据循环右移1点，即按照原数据索引从1,2,3,...,4095,4096变为4096,1,2,...,4094,4095；重复，直到执行了L＝4096次，每个小窗得到L＝4096个PMF-FFT峰值和每个峰值出现的位置，求4096个峰值的最大值Amax_4096，记录其出现在4096个峰值中的索引位置idx_phase_4096，并记录该峰值出现在N点FFT中的索引位置idx_fft_4096；按照中所述，共得到8个小窗的峰值Amax_8win、伪码相位idx_phase_8win、FFT峰值索引位置idx_fft_8win，求8个小窗各自峰值的最大值Amax和Amax出现在8个窗内的位置ss，则Amax8＝Amax_8win，记录伪码相位idx_phase8＝idx_phase_8win、该峰值出现在N点FFT中的索引位置idx_fft8＝idx_fft_8win；若pp＜5，则重复，并pp＝pp+1；若pp＝5，则记录5个Amax8、ss8、idx_phase8、和idx_fft8到Amax8_sum、idx_ss8_sum、idx_phase8_sum、idx_fft8_sum；求Amax8_sum～Amax8_sum的最大值，得到其中的最大值A_temp及对应的索引pp5，即A_temp＝Amax8_sum；基于中的位置pp5，得到伪码同步位置phase_temp＝idx_phase8_sum，该位置即为L＝4096长的PN码的伪码同步位置；基于中的位置pp5，得到FFT中的峰值位置fft_temp＝idx_fft8_sum该位置即为N点FFT中峰值所处位置；基于，粗定时位置StartIdx_1_temp＝*65536*2+*16384+*4+1+ss8_4，其中当ss8_4取值为0或1，当且仅当ss8取值为1～4之间时ss8_4为0，ss8取值为5～8之间时ss8_4为1，粗定时位置StartIdx_1_temp一定位于发送帧中的同步头1中，接收端经过4倍下采样后，同步头2最早可能出现在StartIdx_1_temp+L*4位置，从StartIdx_1_temp+L*4位置向后搜索14个L＝4096点的小窗一定能搜索到同步头2，即粗定时位置为StartIdx_1＝StartIdx_1_temp+4096*4＝*65536*2+ss8*16384+*4+1+ss8_4；基于，设频率间隔为d_f，则所求的该小窗内的频偏为fft_temp2*d_f，其中d_f＝/，当fft_temp在1～N/2范围内fft_temp2＝fft_temp；当fft_temp在N/2+1～N范围内，fft_temp2＝fft_temp-N；Fs为采样频率，DDC_num为采样抽取倍数，X为部分匹配滤波器分段数，N为FFT点数，得到粗频偏为fd_1＝fft_temp2*d_f+f，即窗内频偏+窗本身的预置频偏；步骤四：如图4所示流程寻找同步头2，对上述同步帧，在接收端，如图5所示通过步骤三在0～10.48576ms时延范围内找到同步头1后，同步头2最早可能出现在StartIdx_1位置，后续数据粗频偏估计fd_1，接下来找到同步头2的位置StartIdx_2；对收到的信号rx的第～点，使用步骤三得到的粗频偏fd_1进行频偏补偿，得到rx2；对rx2的第～个点进行4倍下采样并累积一个码片中连续的4个采样点作为一个点，例如累积第1、2、3、4点作为累计后的第1个点，累积第5、6、7、8点作为累计后的第二个点，累积后，得到4096*14个点，以4096点为一个小窗，得到14个小窗win14_0；对rx2的第～个点进行4倍下采样并累积一个码片中连续的4个采样点作为一个点，例如累积rx2第2、3、4、5点作为累计后的第1个点，累积第6、7、8、9点作为累计后的第2个点，累积后，得到4096*14个点，以4096点为一个小窗，得到14个小窗win14_1；由于步骤三中已经确定了伪码同步，且同步头1和同步头2均使用相同长度L的PN序列，所以此时的同步头已经是伪码同步，对win14_0和win14_1的28个小窗各进行一次步骤三中的PMF-FFT运算，得到28个FFT峰值fftM和对应的峰值位置fftM_L；求28个FFT峰值fftM的最大值fftM_max并记录最大值出现在第vv28个窗，即fftM_max＝fftM，记录对应的峰值位置fftM_L_max＝fftM_L；同步头2起始码片出现的位置StartIdx2＝StartIdx1+*4096*4+vv28_1，其中当vv28取值为1～14时，vv14＝vv28，vv28_1＝0，当vv28取值15～28时，vv14＝vv28-14，vv28_1＝1；步骤五：如图6所示流程寻找同步头3，对上述同步帧，在接收端，如图7所示通过步骤四寻找同步头3的位置以及同步头3中每个码片的4个采样点中的最佳采样点StartIdx_3；通过同步帧的格式可以看出，同步头3出现的位置为StartIdx3_temp＝StartIdx2+4096*4；考虑到步骤三中求伪码同步时可能存在1个码片的误差，所以从该位置向前、向后均扩展搜索一个码片，所以同步头3最早可能出现的位置为StartIdx3_temp2＝StartIdx3_temp-4；取接收的rx信号的第～第点，使用步骤三得到的粗频偏fd_1进行频偏补偿，得到rx3；取rx3的第～点，并进行4倍下采样，得到12组数据win12，每组4096个点；由于步骤三和步骤四中已经确定了伪码同步，且同步头1、同步头2、同步头3均使用相同长度L的PN序列，所以此时的同步头已经是伪码同步，对win12的12组数据各进行一次步骤三中的PMF-FFT运算，得到12个FFT峰值fftM3和对应的峰值位置fftM_L3；求12个FFT峰值fftM3的最大值fftM3_max并记录最大值出现在第ww12组，即fftM3_max＝fftM3，记录对应的峰值位置fftM3_L_max＝fftM3_L；同步头3出现的起始码片中最佳采样点位置StartIdx3＝StartIdx3_temp2+ww12-1；步骤六：如图8所示流程进行进行精频偏估计，对上述同步帧，在接收端，如图9所示，使用同步头3进行精频偏估计fd_2，通过步骤五已经找到同步头3的起始码片中的最佳采样点位置StartIdx3；取接收的rx信号的第～第点，使用步骤三得到的粗频偏fd_1进行频偏补偿，得到rx4；对rx4进行4倍下采样，得到4096*16点数据，按索引顺序划分为16组，每组4096点，记作win16；由于步骤三、步骤四和步骤五中已经确定了伪码同步，且同步头1、同步头2、同步头3均使用相同长度L的PN序列，所以此时的同步头已经是伪码同步，将N取值扩大M倍后对win16的16组数据各进行一次步骤三中的PMF-FFT运算，得到16组FFT计算结果fft4，每组结果为N*M点；求16个FFT计算结果fft4取模值后进行非相干累积，得到N*M点的结果fft4_sum，求最大值fft4_sum_max并记录最大值出现在第yy点；设频率间隔为d_f2，则所求的该小窗内的频偏为yy*d_f2，其中d_f2＝/，Fs为采样频率，DDC_num为下采样抽取倍数，X为部分匹配滤波器分段数，N为粗频偏时的FFT点数，N*M为精频偏时的FFT点数，得到精频偏为fd_2＝yy*d_f2，其中M点可根据实际的精频偏精度需求选定；步骤七：对上述同步帧，在接收端，如图10所示，由上述得到同步帧后的数据帧的起始位置StartIdx4和频偏f_last；数据起始位置StartIdx4＝StartIdx3+L*DDC_num*Sync3_num，且该位置也是最佳采样点位置，从此位置开始可以进行数据的下采样；频偏f_last＝fd_1+fd_2；至此，整个同步帧完成伪码同步、定时同步、频偏估计，可抵抗0～10.48576ms时延和频偏，粗频偏精度d_f1＝1524Hz，精频偏精度d_f2＝95Hz，-25dB下实现99％以上的捕获概率，并可通过灵活扩展帧中的同步头1、同步头2、同步头3的长度和接收端的搜索长度，实现更大范围的抗时延特性和抗频偏特性。仿真结果下面结合图11～图15对仿真结果进行进一步分析，本发明的仿真基于Matlab2018.2软件，图11的仿真条件为固定频偏-400kHz，信噪比范围-25dB～-24dB，步进间隔0.1dB，每个信噪比环境测试1000次，采样频率Fs＝50MHz，插值和抽取倍数DDC_num＝4，PN序列长度L＝4096，PMF分段匹配滤波器分成P＝128段，每段长X＝32，做N＝256点FFT，精频偏中M＝16，做N*M＝4096点FFT，每个信噪比下仿真1000点，由图11可以看出提出的同步帧结构设计和相应的同步方法，能够对-400kHz频偏在-25dB下实现99％以上的捕获概率。由图12～图13可知，在固定-24dB信噪比下，频偏范围-400kHz～400kHz，步进间隔1kHz，依然使用上述的Fs、L、P、X、N、M参数进行仿真，可得粗频偏误差和精频偏误差，理论误差均为0.5，受此时过大的噪声影响，会有一定的恶化，可以将实施例中步骤六使用的16次非相干累积扩展到更多次的非相干累积来降低误差。由图14～图15可知，在固定-15dB信噪比下，频偏范围-400kHz～400kHz，步进间隔1kHz，依然使用上述的Fs、L、P、X、N、M参数进行仿真，可得粗频偏误差和精频偏误差，理论误差均为0.5，受此时较大的噪声影响，会有一定的恶化，相比-24dB时有所改善，可以将实施例中步骤六使用的16次非相干累积扩展到更多次的非相干累积来降低误差。由图16～图17可知，在固定0dB信噪比下，频偏范围-400kHz～400kHz，步进间隔1kHz，依然使用上述的Fs、L、P、X、N、M参数进行仿真，可得粗频偏误差和精频偏误差，理论误差均为0.5，受此时噪声影响，会有一定的恶化，相比-24dB和-15dB时有较大改善，粗频偏逼近理论误差，可以将实施例中步骤六使用的16次非相干累积扩展到更多次的非相干累积来降低误差。由图18～图19可知，在固定0dB信噪比下，频偏范围-400kHz～400kHz，步进间隔1kHz，依然使用上述的Fs、L、P、X、N、M参数进行仿真，可得粗频偏误差和精频偏误差，理论误差均为0.5，受此时噪声影响，会有一定的恶化，相比-24dB、-15dB和0dB时有较大改善，粗频偏和精频偏逼近理论误差，可以将实施例中步骤六使用的16次非相干累积扩展到更多次的非相干累积来降低误差。上述流程及仿真表明，本发明所述的同步帧结构和相应和同步方案解决了适用于高速移动场景下低信噪比大频偏突发通信的同步帧结构设计和同步检测问题，使用PN码增强了同步的隐蔽性，且在接收端有着非常好的同步性能，并具有可扩展性，为未来更高运动场景下的低信噪比通信、突发通信均奠定了基础。
