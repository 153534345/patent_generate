标题title
一种智能变电站以太网报文处理系统
摘要abst
本发明公开了一种智能变电站以太网报文处理系统，包括：GPS对时处理模块，用于实时接收并解析外部时钟源B码信息获取世纪秒信息和闰秒标识；原始报文预处理模块，用于实时接收原始报文并解析每帧以太网报文获取当前帧报文的Tick信息；对每帧以太网报文添加报文头；在线报文实时解析模块，用于解析报文头获取时间信息和闰秒标识并根据预设规则计算时间差，根据时间差进行异常报文判断；离线报文存储模块，用于将闰秒标识写入以太网报文；离线报文展示模块，用于解析每帧以太网报文的闰秒标识，对闰秒的每帧以太网报文进行时间信息和时间差展示；本发明可用于智能变电站数字录波器和网络分析仪报文采集处理，具有快速、准确显示闰秒报文等特点。
权利要求书clms
1.一种智能变电站以太网报文处理系统，其特征在于，包括：GPS对时处理模块，用于实时接收并解析外部时钟源B码信息获取世纪秒信息和闰秒标识；将世纪秒信息和闰秒标识定时发送至原始报文预处理模块；原始报文预处理模块，用于实时接收原始报文并解析每帧以太网报文获取当前帧报文的Tick信息；根据世纪秒信息、闰秒标识以及Tick信息对每帧以太网报文添加报文头；在线报文实时解析模块，用于解析每帧以太网报文的报文头获取时间信息和闰秒标识并根据预设规则计算时间差，根据时间差进行异常报文判断；离线报文存储模块，用于将闰秒标识写入以太网报文；离线报文展示模块，获取存储的以太网报文并解析每帧以太网报文的闰秒标识，根据闰秒标识对闰秒的每帧以太网报文进行时间信息和时间差展示。2.根据权利要求1所述的一种智能变电站以太网报文处理系统，其特征在于，所述闰秒标识包括正闰秒、负闰秒和无闰秒；在正闰秒第二个59秒时，世纪秒信息设置为59秒，闰秒标识为正闰秒；在负闰秒的00秒时，世纪秒信息设置为00秒，闰秒标识为负闰秒；在其他时刻时，世纪秒信息跟随B码信息，闰秒标识为无闰秒。3.根据权利要求1所述的一种智能变电站以太网报文处理系统，其特征在于，所述时间信息包括秒和纳秒，所述秒取自世纪秒信息，所述纳秒取自Tick信息。4.根据权利要求1所述的一种智能变电站以太网报文处理系统，其特征在于，所述根据预设规则计算时间差包括：当前帧以太网报文的闰秒标识为正闰秒，上一帧以太网报文的闰秒标识为无闰秒时，时间差＝当前帧以太网报文的时间信息+1-上一帧以太网报文的时间信息；当前帧以太网报文的闰秒标识为负闰秒，上一帧以太网报文的闰秒标识为无闰秒时，时间差＝当前帧以太网报文的时间信息-1-上一帧以太网报文的时间信息；在其他条件下，时间差＝当前帧以太网报文的时间信息-上一帧以太网报文的时间信息。5.根据权利要求1所述的一种智能变电站以太网报文处理系统，其特征在于，所述将闰秒标识写入以太网报文包括：扩展报文文件格式中的caplen字段含义，将当前帧以太网报文的闰秒标识存储至caplen字段高位2字节中：当前帧以太网报文的闰秒标识为无闰秒时，caplen字段高位2字节置0；当前帧以太网报文的闰秒标识为正闰秒时，caplen字段高位2字节置1；当前帧以太网报文的闰秒标识为负闰秒时，caplen字段高位2字节置2。6.根据权利要求1所述的一种智能变电站以太网报文处理系统，其特征在于，所述异常报文包括丢帧、超时、中断、抖动的报文。
说明书desc
技术领域本发明涉及一种智能变电站以太网报文处理系统，属于电力系统技术领域。背景技术智能变电站是指采用先进、可靠、集成和环保的智能设备，以全站信息数字化、通信平台网络化、信息共享标准化为基本要求，自动完成信息采集、测量、控制、保护、计量和检测等基本功能，同时，具备支持电网实时自动控制、智能调节、在线分析决策和协同互动等高级功能的变电站。智能变电站典型特征是使用数字化通信网络取代了电缆，进行状态量、电压及电流二次信号的传输。对智能变电站通信网络报文进行高精度采集，实时分析，异常判断，准确展示，对于智能变电站稳定运行具有重要意义。闰秒是指为了使基于原子钟的时间与基于天文观测的时间尽可能协调一致，对协调世界时增加或减少一秒。正闰秒是指在UTC中增加一秒，即当天的23:59:59的下一秒为23:59:60，然后才是第二天的00:00:00；负闰秒是指在UTC中减少一秒，即当天的23:59:58的下一秒为就是第二天的00:00:00。闰秒对智能变电站网络通信报文的高精度采集，实时分析，异常判断，准确展示会产生影响，例如会导致时间重复，时间跳变等。另外，依据《NB/T42015-2013智能变电站网络报文记录及分析装置技术条件》，在智能变电站网络报文文件格式中，报文头没有包含闰秒信息。通过报文分析软件解析时，不能正确区分、展示闰秒报文。发明内容本发明的目的在于克服现有技术中的不足，提供一种智能变电站以太网报文处理系统，能够较好的采集、解析和存储闰秒报文并且展示闰秒报文的时标。为达到上述目的，本发明是采用下述技术方案实现的：本发明提供了一种智能变电站以太网报文处理系统，包括：GPS对时处理模块，用于实时接收并解析外部时钟源B码信息获取世纪秒信息和闰秒标识；将世纪秒信息和闰秒标识定时发送至原始报文预处理模块；原始报文预处理模块，用于实时接收原始报文并解析每帧以太网报文获取当前帧报文的Tick信息；根据世纪秒信息、闰秒标识以及Tick信息对每帧以太网报文添加报文头；在线报文实时解析模块，用于解析每帧以太网报文的报文头获取时间信息和闰秒标识并根据预设规则计算时间差，根据时间差进行异常报文判断；离线报文存储模块，用于将闰秒标识写入以太网报文；离线报文展示模块，获取存储的以太网报文并解析每帧以太网报文的闰秒标识，根据闰秒标识对闰秒的每帧以太网报文进行时间信息和时间差展示。可选的，所述闰秒标识包括正闰秒、负闰秒和无闰秒；在正闰秒第二个59秒时，世纪秒信息设置为59秒，闰秒标识为正闰秒；在负闰秒的00秒时，世纪秒信息设置为00秒，闰秒标识为负闰秒；在其他时刻时，世纪秒信息跟随B码信息，闰秒标识为无闰秒。可选的，所述时间信息包括秒和纳秒，所述秒取自世纪秒信息，所述纳秒取自Tick信息。可选的，所述根据预设规则计算时间差包括：当前帧以太网报文的闰秒标识为正闰秒，上一帧以太网报文的闰秒标识为无闰秒时，时间差＝当前帧以太网报文的时间信息+1-上一帧以太网报文的时间信息；当前帧以太网报文的闰秒标识为负闰秒，上一帧以太网报文的闰秒标识为无闰秒时，时间差＝当前帧以太网报文的时间信息-1-上一帧以太网报文的时间信息；在其他条件下，时间差＝当前帧以太网报文的时间信息-上一帧以太网报文的时间信息。可选的，所述将闰秒标识写入以太网报文包括：扩展报文文件格式中的caplen字段含义，将当前帧以太网报文的闰秒标识存储至caplen字段高位2字节中：当前帧以太网报文的闰秒标识为无闰秒时，caplen字段高位2字节置0；当前帧以太网报文的闰秒标识为正闰秒时，caplen字段高位2字节置1；当前帧以太网报文的闰秒标识为负闰秒时，caplen字段高位2字节置2。可选的，所述异常报文包括丢帧、超时、中断、抖动的报文。与现有技术相比，本发明所达到的有益效果：本发明提供的一种智能变电站以太网报文处理系统，可用于智能变电站数字录波器和网络分析仪报文采集处理，具有处理速度快，处理逻辑简单，准确显示闰秒报文的特点。附图说明图1是本发明实施例提供的一种智能变电站以太网报文处理系统示意图；图2是本发明实施例提供的在正闰秒时每帧以太网报文的展示效果图；图3是本发明实施例提供的在负闰秒时每帧以太网报文的展示效果图。具体实施方式下面结合附图对本发明作进一步描述。以下实施例仅用于更加清楚地说明本发明的技术方案，而不能以此来限制本发明的保护范围。如图1所示，本发明实施例提供的一种智能变电站以太网报文处理系统，包括：GPS对时处理模块，用于实时接收并解析外部时钟源B码信息获取世纪秒信息和闰秒标识；将世纪秒信息和闰秒标识定时发送至原始报文预处理模块；其中，闰秒标识包括正闰秒、负闰秒和无闰秒；在正闰秒第二个59秒时，世纪秒信息设置为59秒，闰秒标识为正闰秒；在负闰秒的00秒时，世纪秒信息设置为00秒，闰秒标识为负闰秒；在其他时刻时，世纪秒信息跟随B码信息，闰秒标识为无闰秒。原始报文预处理模块，用于实时接收原始报文并解析每帧以太网报文获取当前帧报文的Tick信息；根据世纪秒信息、闰秒标识以及Tick信息对每帧以太网报文添加报文头；在线报文实时解析模块，用于解析每帧以太网报文的报文头获取时间信息和闰秒标识并根据预设规则计算时间差，根据时间差进行异常报文判断；异常报文包括丢帧、超时、中断、抖动的报文。其中，时间信息包括秒和纳秒，秒取自世纪秒信息，纳秒取自Tick信息。根据预设规则计算时间差如表1所示：表1报文时间差计算规则当前帧以太网报文的闰秒标识为正闰秒，上一帧以太网报文的闰秒标识为无闰秒时，时间差＝当前帧以太网报文的时间信息+1-上一帧以太网报文的时间信息；当前帧以太网报文的闰秒标识为负闰秒，上一帧以太网报文的闰秒标识为无闰秒时，时间差＝当前帧以太网报文的时间信息-1-上一帧以太网报文的时间信息；在其他条件下，时间差＝当前帧以太网报文的时间信息-上一帧以太网报文的时间信息。离线报文存储模块，用于将闰秒标识写入以太网报文；将闰秒标识写入以太网报文包括：扩展报文文件格式中的caplen字段含义，将当前帧以太网报文的闰秒标识存储至caplen字段高位2字节中：当前帧以太网报文的闰秒标识为无闰秒时，caplen字段高位2字节置0；当前帧以太网报文的闰秒标识为正闰秒时，caplen字段高位2字节置1；当前帧以太网报文的闰秒标识为负闰秒时，caplen字段高位2字节置2。离线报文展示模块，获取存储的以太网报文并解析每帧以太网报文的闰秒标识，根据闰秒标识对闰秒的每帧以太网报文进行时间信息和时间差展示。如图2-3所示，对时间信息和时间差展示；闰秒标识为正闰秒的报文帧，显示时间为“xxxx-xx-xx xx：xx：60.xxxxxxxxx”；闰秒标识为负闰秒的报文帧，显示时间为“xxxx-xx-xx xx：xx：00.xxxxxxxxx”。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。以上所述仅是本发明的优选实施方式，应当指出，对于本技术领域的普通技术人员来说，在不脱离本发明技术原理的前提下，还可以做出若干改进和变形，这些改进和变形也应视为本发明的保护范围。
