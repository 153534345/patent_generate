标题title
一种双级式矩阵变换器最优开关序列模型预测控制算法
摘要abst
本发明给出了一种双级式矩阵变换器最优开关序列模型预测控制算法，该策略将整流级、逆变级各个扇区空间矢量调制序列作为待选序列，利用两级离散域数学模型求取序列中各个开关矢量作用下的电流一步估计值并建立基于电流变化率的预测模型。为了最小化电流跟踪误差，通过求导公式来获得各个开关矢量的作用时间。将各个开关矢量作用下的电流误差的平方和作为价值函数，通过遍历寻优，选取两级价值函数最小的序列进行协调配合。本发明的有益之处是与传统的调制型模型预测相比，该策略不再将整个开关序列最终作用结果作为评判标准，而是充分考虑序列中各个开关矢量所产生的电流纹波，实现输出电流的谐波含量更低，稳态性能更好。
权利要求书clms
1.一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于该策略将整流级、逆变级各个扇区的空间矢量调制序列作为待选序列，利用两级电流预测模型得到各个开关矢量作用下的电流进行一步估计，并确定其作用下的电流变化率；为了最小化电流跟踪误差，通过对电流误差函数求导获得各个矢量的作用时间；价值函数采用序列中各个开关矢量作用下电流误差的平方和，以减小电流纹波；通过滚动优化选取整流级、逆变级价值函数最小的序列，并进行协调配合完成矩阵变换器的开关控制；具体包括以下步骤：步骤一：明确整流级、逆变级扇区；以各个扇区SVM序列作为两级待选序列；步骤二：建立整流级、逆变级的时域模型并将其离散化；根据离散模型对各个开关矢量作用下的电流进行一步估计，并得到该矢量作用下的电流变化率；步骤三：建立基于开关矢量电流变化率的预测模型；为了最小化电流跟踪误差，将各个开关序列作用下的电流预测值与期望电流的误差公式求偏导，得到各个矢量的最优作用时间；步骤四：为了缩小电流纹波，将各个矢量作用下的电流误差的平方和作为价值函数，选取整流级、逆变级价值函数最小的序列作为作用序列；步骤五：根据整流级、逆变级所选取的开关序列进行协调配合控制；所述步骤一中各个扇区的SVM序列；在空间矢量调制中，根据扇区选取开关矢量之后，需要考虑各个开关矢量作用的先后顺序；为了尽量减小谐波、减小开关管的切换次数以及通断过程中的损耗，需要选择一个最优的开关序列进行调制；本发明中为了提高网侧电压利用率，整流级采用无零矢量的调制方式，同时逆变级采用双有源矢量和零矢量搭配的七段式控制；根据两级所选取的调制方式，可以得到各个扇区的最优开关序列；所述步骤二中建立整流级、逆变级的时域模型并将其离散化；以整流级为例，为了预测网侧电流，根据基尔霍夫定律以及电容、电感的电压电流约束关系得到整流级的时域数学模型，并利用前向欧拉法对其离散化得到离散域的状态空间模型；所述步骤二中各个开关矢量作用下的电流一步估计及电流变化率；以逆变级为例，不同的开关矢量会产生不同的输出电压进而影响负载侧电流的预测值，该预测值为单个开关矢量作用一个采样周期Ts得到的，因此称为该开关矢量作用下的电流一步估计值；各个开关矢量作用下的负载电流变化值与采样周期Ts的比值即为该开关矢量作用下的电流变化率；所述步骤三中基于开关矢量电流变化率的预测模型；根据序列中各个开关矢量的电流变化率及作用时间，可以得到该序列作用下最终电流值；由于开关矢量的作用时间为未知量，通过将电流误差公式求偏导来得到各个开关矢量最优的作用时间。2.如权利要求1所述的一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于：根据两级离散域的预测模型，得到序列中每个开关矢量作用下的电流一步估计，并得到其电流变化率；以逆变级为例，利用欧拉法得到输出侧的离散域模型：式中，RL为负载电阻，LL为负载电感，io,k为负载侧电流采样值；当逆变级选取不同的开关矢量作用时，会根据直流侧电压udc和逆变级开关状态产生不同输出侧电压uo,k，进而根据输出侧离散域模型得到不同的负载侧电流预测值io,k+1；因此开关矢量与负载侧电流预测值是一一对应的，将该预测值作为该开关矢量作用下的电流一步估计值当逆变级开关矢量n作用时，其电流一步估计值io,k实际为该矢量作用一个采样周期Ts后的负载电流值，由此可以得到其电流变化率为：式中fn,k为n矢量作用下的负载电流变化率。3.如权利要求1所述的一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于：将各个开关矢量作用下的电流误差之和作为价值函数；由于一开关序列中各个开关矢量作用后都会产生一电流瞬时值，为了缩小电流纹波，将各个矢量作用后的电流瞬时值与期望电流值的误差之和作为价值函数：其中irefα,irefβ为电流期望值，iα,j,iβ,j为该序列第j个开关矢量作用后电流瞬时值，该价值函数充分考虑了一个序列中m个矢量作用下的电流瞬时值与期望电流的误差，可以有效缩小电流纹波。4.如权利要求1所述的一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于：整流级和逆变级的开关配合；为了改善输入输出的谐波特性，在两级待选序列采用通用的SVM序列，该序列在逆变级每个采样周期内应用两个零矢量，降低了开关次数，实现最小的开关损耗；此外当整流级开关矢量发生改变时，逆变级为零矢量作用时刻，这种安排可以实现整流级的零电流换流，不仅可以简化换流过程，而且可以确保双级式矩阵变换器的安全性。
说明书desc
技术领域本发明涉及电力电子变换器模型预测控制技术领域，具体涉及一种双级式矩阵变换器的最优开关序列模型预测控制算法。背景技术双级式矩阵变换器作为一种新型的交-交变换器，不仅继承了传统矩阵变换器能量可双向流动、输入功率因数灵活可调、输出频率可控、不含中间储能元件、结构紧凑等优点，还具有箝位电路简单、整流级可实现零电流换流等优点，在近20年受到国内外众多学者的关注。双级式矩阵变换器的常规控制一般基于比例积分控制器，当同时控制多个目标时，就需要设置多个控制回路，又因TSMC输入、输出级之间存在耦合，使得控制方法变得较为复杂。然而随着数字处理器和电源设备的快速发展，与线性控制器相结合的空间矢量调制正受到模型预测控制的挑战。与传统的调制与控制方法相比，模型预测具有较多优势，比如可以实现多个控制目标，高动态性能，灵活的约束限制等。有限控制集的模型预测控制由于其直观的概念成为电力转换器中最具有吸引力的模型预测算法并在双级式矩阵变换器的控制当中得到应用，其主要通过考虑到所有可能的切换状态，在每个采样周期内选择成本函数最小的开关状态，可以降低共模电压，控制输入无功功率，提高效率等。然而由于缺乏调制器，可变的开关频率导致电流纹波较大。为了固定开关频率，学者为TSMC提出了一种调制型模型预测策略，该策略保留了FCS-MPC的优点，在固定的开关周期内连续应用两个或多个开关状态，可以改善TSMC的输入电流和输出电流的质量。M2PC所选取的是单独作用一个控制周期后更接近于期望输出的开关状态，并没有考虑各个开关状态之间的配合。同时，在一个控制周期内，由于一个开关序列中不同的开关状态在先后作用下会产生不同的电流纹波，如果不将序列中每个开关状态的作用效果纳入考量范围，则无法保证最佳的稳态性能。因此对应用于TSMC的模型预测控制方法进行进一步的研究是非常有必要的。发明内容本发明的目的是保留传统调制型模型预测的固有特性，在不影响计算负担的前提下提高系统的控制性能，改善输入输出电流特性，降低纹波。基于对现有调制型的模型预测进行改进，提出一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于该策略将整流级、逆变级各个扇区的SVM序列作为待选序列，利用两级电流预测模型得到各个开关矢量作用下的电流一步估计，并确定其作用下的电流变化率；为了最小化电流跟踪误差，通过对电流误差函数求导获得各个矢量的作用时间；价值函数采用序列中各个开关矢量作用下电流误差的平方和，以减小电流纹波；通过滚动优化选取整流级、逆变级价值函数最小的序列，并进行协调配合完成矩阵变换器的开关控制；具体包括以下步骤：步骤一：明确整流级、逆变级扇区；以各个扇区的SVM序列作为两级待选序列；步骤二：建立整流级、逆变级的时域模型并将其离散化；根据离散模型对各个开关矢量作用下的电流进行一步估计，并得到该矢量作用下的电流变化率；步骤三：建立基于开关矢量电流变化率的预测模型；为了最小化电流跟踪误差，将各个开关序列作用下的电流预测值与期望电流的误差公式求偏导，得到各个矢量的最优作用时间；步骤四：为了缩小电流纹波，将各个矢量作用下的电流误差的平方和作为价值函数，选取整流级、逆变级价值函数最小的序列作为调制序列；步骤五：根据整流级、逆变级所选取的开关序列进行协调配合控制；所述步骤一中各个扇区的SVM序列；在空间矢量调制中，根据扇区选取开关矢量后，需要考虑各个开关矢量作用的先后顺序；为了尽量减小谐波、减小开关管的切换次数以及通断过程中的损耗，需要选择一个最优的开关序列进行调制；本发明中为了提高网侧电压利用率，整流级采用无零矢量的调制方式，同时逆变级采用双有源矢量和零矢量搭配的七段式控制；根据两级所选取的调制方式，可以得到各个扇区的最优开关序列；所述步骤二中建立整流级、逆变级的时域模型并将其离散化；以整流级为例，为了预测网侧电流，根据基尔霍夫定律以及电容、电感的电压电流约束关系得到整流级的时域数学模型，并利用前向欧拉法对其离散化得到离散域的状态空间模型；所述步骤二中各个开关矢量作用下的电流一步估计及电流变化率；以逆变级为例，不同的开关矢量会产生不同的输出电压进而影响负载侧电流的预测值，该预测值为单个开关矢量作用一个采样周期Ts得到的，因此称为该开关矢量作用下的电流一步估计值；各个开关矢量作用下的负载电流变化值与采样周期Ts的比值即为该开关矢量作用下的电流变化率；所述步骤三中基于开关矢量电流变化率的预测模型；根据序列中各个开关矢量的电流变化率及作用时间，可以得到该序列作用下最终电流值；由于开关矢量的作用时间为未知量，通过将电流误差公式求偏导来得到各个开关矢量最优的作用时间。进一步的，所述的一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于：根据两级离散域的预测模型，得到序列中每个开关矢量作用下的电流一步估计，并得到其电流变化率；以逆变级为例，利用欧拉法得到输出侧的离散域模型：式中，RL为负载电阻，LL为负载电感，io,k为负载侧电流采样值；当逆变级选取不同的开关矢量作用时，会根据直流侧电压udc和逆变级开关状态产生不同输出侧电压uo,k，进而根据输出侧离散域模型得到不同的负载侧电流预测值io,k+1；因此开关矢量与负载侧电流预测值是一一对应的，将该预测值作为该开关矢量作用下的电流一步估计值当逆变级开关矢量n作用时，其电流一步估计值io,k实际为该矢量作用一个采样周期Ts后的负载电流值，由此可以得到其电流变化率为：式中fn,k为开关矢量n作用下的负载电流变化率。进一步的，所述的一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于：将各个开关矢量作用下的电流误差之和作为价值函数；由于一开关序列中各个开关矢量作用后都会产生一电流瞬时值，为了缩小电流纹波，将各个矢量作用后的电流瞬时值与期望电流值的误差之和作为价值函数：式中irefα,irefβ为电流期望值，iα,j,iβ,j为该序列第j个开关矢量作用后电流瞬时值，该价值函数充分考虑了一个序列中m个矢量作用下的电流瞬时值与期望电流的误差，可以有效缩小电流纹波。进一步的，所述的一种双级式矩阵变换器最优开关序列模型预测控制算法，其特征在于：整流级和逆变级的开关配合；为了改善输入输出的谐波特性，在两级待选序列采用通用的SVM序列，该序列在逆变级每个采样周期内应用两个零矢量，降低了开关次数，实现最小的开关损耗；此外当整流级开关矢量发生改变时，逆变级为零矢量作用时刻，这种安排可以实现整流级的零电流换流，不仅可以简化换流过程，而且可以确保双级式矩阵变换器的安全性。与现有技术相比，本发明具有如下优势：1)相较于现有的调制型模型预测控制策略，本发明不再将整个开关序列的最终作用结果作为评判标准，而是充分考虑该序列下每个开关状态所产生的纹波，可以实现输入输出电流的谐波含量更低，动态响应更好，且不增加计算负担；2)为了进一步提高电流跟踪精度，对开关状态作用下的电流进行一步估计，在成本函数中考虑了不同开关状态间的相互影响，通过求取偏导来获得最优占空比，提高了稳态性能附图说明图1为双级式矩阵变换器电路拓扑图；图2为本发明最优开关序列的模型预测控制框架图；图3为整流级、逆变级空间矢量扇区分布图；图4为逆变级开关序列下的电流预测图；图5为本发明最优开关序列模型预测和M2PC成本函数比较图；图6为整流级和逆变级的协调控制图；具体实施方式为了阐明本发明的基本原理、技术方案及性能优势，下面将结合附图对本发明作进一步的说明：一种双级式矩阵变换器的拓扑如图1所示，主电路的拓扑主要分为整流级和逆变级两部分。整流级是由六个双向开关组成的电流源整流器，其作用是对直流侧高频斩波电流进行调制合成网侧电流，同时将输入电压斩波成直流侧高频电压。逆变级利用直流侧高频电压合成期望输出电压的同时，也将三相输出电流斩波成直流侧高频电流。整流级、逆变级通过协调控制可实现零电流换流方式。图2为本发明最优开关序列模型预测控制框架图，即本发明的概括图，具体实现包括如下步骤：步骤1：确定整流级、逆变级空间矢量扇区如图3所示。为了提高网侧电压利用率，整流级采用无零矢量的调制方式，同时逆变级采用双有源矢量和零矢量搭配的七段式控制，根据两级所选取的调制方式，可得整流级、逆变级各个扇区的待选序列如表1所示：表1待选矢量序列表中所示待选序列为各个扇区通用的SVM序列，该序列可实现开关次数最小且电流谐波较小，通断损耗低。步骤2：为预测网侧电流，对TSMC建立输入侧时域动态数学模型，并进行欧拉离散化得到网侧电流预测模型：式中Ts为采样周期。需要注意的是，当整流级序列中不同的开关矢量作用时，会根据开关状态产生不同的输入侧电流ii，进而根据网侧离散域模型得到不同的网侧电流预测值is,k+1。因此开关矢量与网侧电流预测值为一一对应的，将该预测值is,k+1作为该开关矢量作用下的电流一步估计值其实际为该矢量作用一个采样周期Ts后的网侧电流值。步骤3：求取整流级待选序列中不同开关矢量下的网侧电流一步估计值，得到网侧电流变化率为：为当整流级两个有效矢量作用下的网侧电流一步估计值。步骤4：结合表1中的矢量开关序列和网侧电流变化率，建立一个基于电流变化率的网侧电流预测模型：式中t1r,t2r为两个有效矢量的作用时间，且满足t1r+t2r＝Ts。步骤5：为了在一个控制周期内最优的跟踪网侧电流期望值，通过最小化电流跟踪误差来得到两个有效矢量在一个控制周期内的持续时间，网侧电流的跟踪误差可表示为：G＝2+2将t2r＝Ts-t1r代入上式，利用求导公式得到整流级两个有效矢量的最优持续时间：通过求解上式便可获得整流级两个最优矢量的持续时间t1r,t2r。步骤6：确定整流级序列的价值函数。由于直流侧电流Idc变化频率较高且远大于采样频率，为了减小计算量，根据伏秒平衡的原则将其等效为一直流量。然而这种简化导致整流级各个开关矢量所产生的电流并不能准确估计，所以将两个有效矢量作用下的最终结果作为评估标准得到的整流侧价值函数为：式中为网侧电流期望值，其幅值是由TSMC的效率、输入滤波器参数、电压源电压和输出电流期望值根据功率守恒的原则所得，根据价值函数最小的原则确定整流级的开关矢量序列。步骤7：通过整流级两个矢量的作用时间来求取占空比，得到逆变级控制所需的平均直流电压:udc＝d1rudc1+d2rudc2式中d1r,d2r为整流级两个矢量的占空比，udc1,udc2为两个有效矢量分别作用下的直流电压。步骤8：为预测输出电流建立输出侧的时域数学模型，利用前向欧拉法进行离散化可得：式中RL为负载电阻，LL为负载电感，io,k+1为不同开关矢量下的电流一步估计值。步骤9：求取逆变级不同开关矢量下负载侧的电流一步估计值，得到负载侧电流变化率为：式中为当逆变级两个有效矢量和零矢量作用下的负载电流一步估计值。步骤10：根据负载侧的电流变化率和表1中逆变级开关矢量序列得到一个Ts内的输出电流的轨迹如图4所示，并建立基于输出电流变化率的负载侧电流预测模型为：式中t1i,t2i,t0i为两个有效矢量和一个零矢量作用时间，且满足2t1i+2t2i+4t0i＝Ts.步骤5：为了更好地跟踪负载侧电流期望值，最小化电流跟踪误差可得两个有效矢量在一个控制周期内的持续时间，输出电流的跟踪误差可表示为：G＝2+2利用求偏导公式得到逆变级三个有效矢量的最优作用时间：通过求解上式便可获得逆变级三个最优矢量的持续时间t1i,t2i,t0i。步骤11：由于逆变级序列开关矢量较多，为了缩小输出电流纹波，一个采样周期内充分考虑每个开关矢量作用下的电流误差，建立一个新的逆变级成本函数：负载侧电流的递归形式为：式中ioα,0＝ioα,k,ioβ,0＝ioβ,k，即为负载电流采样值。根据图4可知，相同开关矢量作用下所产生的电流变化率是相同的，因此fiα0,k＝fiα3,k＝fiα4,k＝fiα7,k,fiα1,k＝fiα6,k,fiα2,k＝fiα4,k。矢量持续时间t0i＝t3i＝t4i＝t7i,t1i＝t6i.t2i＝t5i。同样在β坐标系下，上述依然成立。图5更加直观展示了本发明所提的最优开关序列模型预测与M2PC价值函数的差异。步骤12：根据价值函数最小的原则确定逆变级的开关矢量序列，并根据各个矢量的作用时间来求取占空比，同时得到整流级的平均直流电流：idc＝d1iidc1+d2iidc2式中d1i,d2i为整流级两个有效矢量的占空比，idc1,idc2为两个有效矢量分别作用下的直流电流。步骤13：为了改善输入和输出谐波特性，需要整流级、逆变级协调配合控制。如图6所示，当整流级发生换向时逆变级为零矢量作用，这可以实现整流级零电流换流，不仅简化了换流方式并且可以确保双级式矩阵变换器的安全性。
