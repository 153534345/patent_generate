标题title
一种跳频信号快速盲检测的方法
摘要abst
本发明提供了一种跳频信号快速盲检测方法，所属方法包括：通过二次灰度形态学滤波对灰度时频图进行预处理得到二值化时频图，采用基于行程的连通域标记算法对信号区域进行标记，计算连通域的最大持续时长，利用MeanShift算法对最大持续时长特征量进行聚类分析，结合自适应双门限对聚类结果进行判决。本发明实施一种跳频信号快速盲检测方法在低信噪比下能够快速分离各种干扰信号和尖锐噪声并以较高的检测概率检测到跳频信号，相对于传统的跳频信号盲检测方案，不仅抗干扰能力较强，检测性能较好，计算复杂度也较低，聚类结果稳定。
权利要求书clms
1.一种基于跳频信号快速盲检测的方法，其特征在于，所述方法包括：S1：构建信号数学模型，结合时频分析技术，利用二次灰度形态学滤波进行信号预处理；S2：提出一种基于连通域标记的特征集提取方法，对灰度时频图中的信号进行标记并计算信号连通域最大持续时长；S3：采用MeanShift算法对最大持续时长特征量进行聚类分析；S4：设置自适应双门限对聚类结果进行判决，根据判决结果推导提取跳频信号后的检测概率和虚警概率。2.根据权利要求1所述的基于跳频信号快速盲检测的方法，其特征在于，所述步骤S1具体包括：依据复杂的短波信道环境，跳频信号、定频信号、扫频信号、突发信号、色噪声等交错混杂，构建信号数学模型。分析各时频分析技术特点，生成信号时频数据，利用二次灰度形态学滤波对时频图进行预处理，降低干扰信号和噪声对跳频信号检测性能的影响。3.根据权利要求1所述的基于跳频信号快速盲检测的方法，其特征在于，所述步骤S2具体包括：提出一种基于连通域标记的特征集提取方法，通过基于行程的连通域标记算法对信号进行标记直至遍历完整个时频图，使每个信号均有专属的特定标号，统计连通域的最大行数和最小行数差，计算信号连通域的最大持续时长。4.根据权利要求1所述的基于跳频信号快速盲检测的方法，其特征在于，所述步骤S3具体包括：依据连通域标号顺序，将信号的最大持续时长组成特征集，利用MeanShift算法对该特征集进行聚类分析。5.根据权利要求1所述的基于跳频信号快速盲检测的方法，其特征在于，所述步骤S4具体包括：设置自适应双门限对聚类结果进行判决，根据判决结果将跳频信号的标号置为1，干扰信号的标号置为0，提取出跳频信号并推导提取跳频信号后的检测概率和虚警概率。
说明书desc
技术领域本发明属于通信技术领域，具体涉及一种跳频信号快速盲检测的方法。背景技术跳频通信作为一种特殊的扩频通信方式，能够按照一定规律随机跳变，具备了优越的抗衰落、抗干扰、抗截获能力。这一特性使得通信的抗干扰性和安全可靠性都大大加强。跳频通信诞生初期主要服务于军用通信，随着技术的发展与实际需求，跳频通信技术在民事通信领域的地位也是逐渐攀升，典型的应用如法国的SFH900以及欧洲的GSM系统等等，常见的蓝牙及家庭射频等应用也采用了跳频技术。目前，跳频通信技术已经跃升为现代军事通信的主导力量，因此，开展关于跳频信号侦察技术的分析研究至关重要。短波信道环境下的跳频通信，由于短波信道环境异常复杂，定频、突发等各种信号相互交织、分布密集，且环境噪声起伏大，严重影响了跳频信号低信噪比下的检测性能。随着跳频通信技术在短波频段的广泛应用，若在复杂的电磁环境下对跳频信号检测不准确，不仅耗费人力与时间成本，而且将会导致后面信息获取失败，通信对抗中处于劣势。如何从复杂的短波信道环境中检测跳频信号，是进行跳频信号参数估计和网台分选的前提和基础，也是对敌方进行通信干扰并破坏通信的关键，跳频信号的检测对通信系统的安全性具有重要意义。发明内容本发明的目的是为了在复杂的短波信道环境和低信噪比下有效分离各种干扰信号和噪声，实现跳频信号快速盲检测。第一方面，一种跳频信号快速盲检测的方法，包括：S1：构建信号数学模型，结合时频分析技术，利用二次灰度形态学滤波进行信号预处理。S2：提出一种基于连通域标记的特征集提取方法，对灰度时频图中的信号进行标记并计算信号连通域最大持续时长。S3：采用MeanShift算法对最大持续时长特征量进行聚类分析。S4：设置自适应双门限对聚类结果进行判决，根据判决结果推导提取跳频信号后的检测概率和虚警概率。优选地，所述步骤S1具体包括：依据复杂的短波信道环境，跳频信号、定频信号、扫频信号、突发信号、色噪声等交错混杂，构建信号数学模型。分析各时频分析技术特点，生成信号时频数据，利用二次灰度形态学滤波对时频图进行预处理，降低干扰信号和噪声对跳频信号检测性能的影响。优选地，所述步骤S2具体包括：提出一种基于连通域标记的特征集提取方法，通过基于行程的连通域标记算法对信号进行标记直至遍历完整个时频图，使每个信号均有专属的特定标号，统计连通域的最大行数和最小行数差，计算信号连通域的最大持续时长。优选地，所述步骤S3具体包括：依据连通域标号顺序，将信号的最大持续时长组成特征集，利用MeanShift算法对该特征集进行聚类分析。优选地，所述步骤S4具体包括：设置自适应双门限对聚类结果进行判决，根据判决结果将跳频信号的标号置为1，干扰信号的标号置为0，提取出跳频信号并推导提取跳频信号后的检测概率和虚警概率。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明实施例提供的一种跳频信号快速盲检测的方法流程示意图；图2是短波信道环境时频图；图3是本发明实施二次灰度形态学滤波后的灰度时频图；图4是本发明实施基于行程的连通域标记后的灰度时频图；图5是本发明实施MeanShift算法对最大持续时长特征集的聚类结果图；图6是本发明实施双门限判决后提取跳频信号的灰度时频图；图7是本发明实施提取跳频信号后随SNR变化的检测概率图；图8是本发明实施提取跳频信号后随SNR变化的虚警概率图；具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。S1：构建信号数学模型，结合时频分析技术，利用二次灰度形态学滤波进行信号预处理。S2：提出一种基于连通域标记的特征集提取方法，对灰度时频图中的信号进行标记并计算信号连通域最大持续时长。S3：采用MeanShift算法对最大持续时长特征量进行聚类分析。S4：设置自适应双门限对聚类结果进行判决，根据判决结果推导提取跳频信号后的检测概率和虚警概率。具体地，步骤S1包括：依据复杂的短波信道环境，跳频信号、定频信号、扫频信号、突发信号、色噪声等交错混杂，构建信号数学模型。信号数学模型：在一定的观测时间内，接收机在短波频段内接收到信号模型为：其中，r为接收的短波宽带信号，sFH是跳频信号，dk为第k个定频干扰信号，cl为第l个扫频干扰信号，n是均值为0、方差为σ2的加性高斯白噪声。假设跳频信号sFH的跳频周期为Th，信号幅度是A，表示矩形窗，且满足跳频信号的接收模型表达式为：其中θ表示初始相位，fn记作第n个时隙的跳频频率。本实施的短波信号参数如下表：信噪比SNR0～15dB信号采样率fs10MHz带宽B1.75MHz观测时间T04s跳频信号周期Th0.5s跳频频率集跳数8扫频信号起始频率3MHz扫频信号终止频率4MHz突发信号频率集定频信号频率集图2是本发明在观测时间内采集的短波信道环境时频图。本发明对观测时间内采集的信号进行短时傅里叶变换,窗长为2048，窗函数类型为Hamming窗。跳频信号sFH的STFT定义为：式中，h表示窗函数，τ为时延，STFTFH是跳频信号sFH时间和频率上的连续二维分布。跳频信号sFH在时间和频率上的离散二维分布可表示为：式中，k＝0,1,…,N-1，N是离散点数。图3是本发明实施二次灰度形态学滤波后的灰度时频图。信号数据经过STFT后生成时频矩阵，进行二次灰度形态学滤波处理，即分别在时频矩阵的频率分量和时间分量上进行灰度形态学滤波，为后续提取信号降低干扰的影响。预处理流程如下：1)在时频矩阵的频率分量上选择长度都小于跳频Hop的线性结构元素b1对时频图TF进行腐蚀运算去除雾状噪声、突发干扰信号和扫频干扰信号；TF1＝TFΘgb1＝min{TF-b1}2)选择长度略小于跳频Hop的线性结构元素b2对时频图TF1进行膨胀运算使跳频信号和定频干扰信号恢复原状；3)在时频矩阵的时间分量Pt上，使用长宽接近信号带宽的结构元素bt对Pt进行灰度闭运算再做底帽运算，并求其最大值P2＝max 此时P2能够跟踪填补频谱中波谷的极大值，再和Pt灰度开运算的结果相加，可以很好的反映低信噪比下Pt的起伏幅度，并得到二值化门限th，即4)选取th为最佳阈值，对Pt进行二值化分割，使信号的灰度为1，背景灰度为0，得到只含有跳频信号和定频干扰信号的二值化时频矩阵TF3。其中，TF、TF1、TF2、TF3均表示二维灰度时频图，x是像素点的横坐标，y是像素点的纵坐标，b1、b2、bt均表示结构元素，m是结构元素的横坐标，n是结构元素的纵坐标，Pt表示时间分量信号能量，P1表示Pt灰度闭运算，P2表示P1与Pt底帽运算的结果，Pt′表示时间分量二值化。Θg表示灰度腐蚀运算，表示灰度膨胀运算，·g表示灰度闭运算，表示灰度闭运算。进一步地，步骤S2包括：图4是本发明实施基于行程的连通域标记后的灰度时频图。为了更有效地去除定频信号且不会造成多余的突发干扰，对每一个信号进行8邻域连搜索，把属于同一信号的连通起来，并赋予各自的标记。为了降低复杂度，快速标记，采用基于行程的标记法，在遍历二值时频图像的过程中，记录每一个团的位置同时对其8邻域进行搜索，存在值则送到元组pair中，再对pair中每个数据对重新标记。标记流程如下：1)遍历时频图，把连续等于1的白色像素组成的序列称为团，并记下它的起止位置；2)依据团的起止位置，若当前团和前一个团之间不满足8邻域关系，则给当前团赋一个新的标号labelk,k＝1,2,3...；反之，将前一个团的标号赋给当前的团；若它与前2个及以上的团满足8邻域关系，则给当前的团赋上相连团中的最小标号，即min,i＝1,2,...,i＜j,j＜h并与之前几个团的标记写入数据对,k＝1,2,...，存储到pair中说明属于同一类；3)将数据对,k＝1,2,...转换为序列，因为它们满足8邻域关系，所以一个序列的标号相同，从1开始递增，给每个序列赋一个标号；4)将标记赋给团在时频图的相应位置上，重复步骤2和步骤3，直至遍历完整个时频图为止。5)求出信号标记个数n，找出各个连通区域所连通的所有行，计算连通域上的最大持续时长ωmax＝max-min,i＝1,2,...,n其中，min为连通域的最小行数，max为连通域的最大行数；其次，所述步骤S3具体包括：假设不同簇类的数据集符合不同的概率密度分布，找到任一样本点密度增大的最快方向，样本密度高的区域对应于该分布的最大值，最终样本点将在局部密度最大值收敛，且收敛到相同局部最大值的点被认为是统一簇类的成员。MeanShift向量的基本形式定义为：Ak＝{β:T≤r2} 其中Ak是一个高维球区域，半径为r，α是当前区域的质心，αi是第i个区域的质心，满足以下关系的β点集合，k表示在这n个样本点αi中有k个点落入Ak区域中。这个区域以圆心为起点，其余的点为终点形成不同梯度方向的距离向量。将区域内的距离向量相加，结果就是MeanShift向量。Dr作为α的偏移均值向量，可用来对α进行更新，在更新过程中可以发现其倾向于向有效区域中样本密度高的地方移动。为了增强MeanShift的适用范围，对MeanShift向量进行改进，加入高斯核函数，故改进后的统一表达式如下:其中S为高斯核函数，r表示带宽，ω为样本权重。在MeanShift的改进形式都是由概率密度的核函数估计推导出来，其核心是核函数，故其核函数估计的表示如下：对概率密度函数f求导如下：令整理可得：其中，n表示d维数据集{αi}的大小，Q同样表示核函数，fg表示概率密度的核函数估计，Dr为MeanShift的改进表达式。令求解概率密度局部极大值，由于fg＞0，故有：本发明实施基于行程的连通域标记算法，使每个信号均有专属的特定标号，采用MeanShift算法对信号的时频特征量进行聚类处理。连通域标记法将时频图中将跳频信号聚类标号都置为1，其余标号均置为0。对标记矩阵与原始时频图矩阵做哈达玛积运算，即可得到跳频信号的短时能量图，提取出跳频信号。检测流程如下：1)在所有连通域的最大持续时长集合中随机选择一个值作为圆心center；2)以center为原心，作半径为radius的圆形区域，搜索该区域内所有点，认为这些点属于簇c；3)计算圆心区域内每个点到圆心center的距离向量，并相加求均值，得到偏移向量shift；4)令新圆心newcenter＝center+shift，即center沿着shift方向移动到newcenter处，移动距离为||shift||；5)重复步骤2、3、4，直到shift小于偏移阈值，表示迭代到收敛，收敛的条件是搜索到局部极大值。迭代过程中区域内的点都应该归类到簇c；6)如果收敛时当前簇c的center与簇c1的center的距离小于距离阈值，那么把c1和c合并。否则，把c作为新的聚类，增加1类；7)重复步骤1-5直至所有的点均被访问；最后，所述步骤S4具体包括：对最终的聚类结果，结合自适应双门限法进行判决，提取出跳频信号并推导提取跳频信号后的检测概率和虚警概率。设置自适应双门限：th1＝φ* 其中，T0为观测时间，N是跳频跳数，φ∈，对每个簇的质心center进行判决，若th1≤center≤th2，判定为跳频信号，标记均置为1；若center＜th1，判定为突发干扰，标记置为0，若center＞th2，判定为定频干扰，标记同样置为0。图5是本发明实施MeanShift算法对最大持续时长特征集的聚类结果图。低SNR下，标号1、3、5、6、7、8、9和10为跳频信号，标号11、13和15为定频干扰信号，标号2、4、8、12、14和16为突发干扰。聚类结果稳定，能够正确分离干扰信号和跳频信号，提取出跳频信号。提取跳频信号后假设检测概率为Pd，虚警概率为Pf，跳频Hop个数的门限a，当前SNR下检测到跳频Hop的个数为b，进行M次测试，则检测概率Pd可描述为且虚警概率Pf可表示为图6是本发明实施双门限判决后提取跳频信号的灰度时频图。标号1、3、5、6、7、8、9和10的跳频信号重置为标号1，标号11、13和15的定频干扰信号重置为标号0，标号2、4、8、12、14和16为突发干扰信号重置为标号0，提取出跳频信号。图7是本发明实施提取跳频信号后随SNR变化的检测概率图。随SNR增大，本发明实施检测概率呈递增趋势，相较于其他聚类检测算法在低SNR下有较高的检测概率。图8是本发明实施提取跳频信号后随SNR变化的虚警概率图。本发明实施算法和对比算法的虚警概率均随SNR增大而下降，但本发明实施算法的虚警概率最小。相较于其他聚类算法，本发明实施算法的检测性能增益随SNR降低逐渐增大，更适合与实现低信噪比下对跳频信号的盲检测。
