标题title
一种基于FPGA处理的信号调制类型实时识别方法
摘要abst
本发明公开了一种基于FPGA处理的信号调制类型实时识别方法，包括以下步骤：获取待识别调制信号的幅度和瞬时相位；根据幅度，得到门限参数；其中，所述门限参数包括频率门限、带宽门限和幅度门限；根据瞬时相位，得到单点频率估计；根据单点频率估计和门限参数，得到待识别调制信号的信号调制类型。本发明通过FPGA的实时流水线处理提升了调制类型实时识别能力和处理速度。
权利要求书clms
1.一种基于FPGA处理的信号调制类型实时识别方法，其特征在于，包括以下步骤：步骤1：获取待识别调制信号的幅度和瞬时相位；步骤2：根据幅度，得到门限参数；其中，所述门限参数包括频率门限、带宽门限和幅度门限；步骤3：根据瞬时相位，得到单点频率估计；步骤4：根据单点频率估计和门限参数，得到待识别调制信号的信号调制类型。2.根据权利要求1所述的方法，其特征在于，所述步骤1具体包括：假设待识别调制信号为s，其采样率为fs，则采样间隔时间为其中，n为采样点；采用Cordic算法对待识别调制信号s的IQ波形进行估计，从而获得幅度A及瞬时相位所述步骤2具体包括：假设系统的噪底为NoiseBase，处理的积累点数为M，则基于幅度A的前M个点幅度均值估计SNR；SNR的估计公式为：根据信噪比SNR以及积累点数M估计频率门限Freq_Thres、带宽门限Band_Thres以及幅度门限Amp_Thres；3.根据权利要求2所述的方法，其特征在于，所述步骤3具体包括：根据瞬时相位进行流水线单点频率估计，将间隔N点提取瞬时单点频率，N由待识别调制信号的采样率fs及最大可适应的带宽Band决定，则其中，floor为向下取整；单点频率估计为：其中，Single_Freq为单点频率估计。4.根据权利要求3所述的方法，其特征在于，所述步骤4具体包括：步骤4-1：根据单点频率估计，得到多点平滑频率估计和多点平滑幅度估计；步骤4-2：根据多点平滑频率估计，得到多点频率差分估计；根据多点平滑幅度估计，得到多点幅度差分估计；步骤4-3：根据多点平滑频率估计，得到多点频率的带宽；步骤4-4：根据多点频率差分估计，得到待识别调制信号的差分带宽；根据多点差分幅度估计，得到待识别调制信号的差分幅度波动范围步骤4-5：根据单点频率估计，得到待识别调制信号的信号调制类型为PSK信号；根据多点频率的带宽、待识别调制信号的差分带宽、待识别调制信号的差分幅度波动范围，得到待识别调制信号的信号调制类型为点频信号、未知信号、线调信号、非线调信号中的任一种。5.根据权利要求4所述的方法，其特征在于，所述步骤4-1具体包括：基于单点频率估计，采用重心法进行多点频率估计；假设积累点数为M，则多点平滑频率估计的计算公式为：基于单点幅度值，采用多点平滑的方式获得多点幅度估计值：其中，Multi_Freq为多点平滑频率估计，Multi_Amp为多点平滑幅度估计，p为多点平滑频率估计采样点。6.根据权利要求5所述的方法，其特征在于，所述步骤4-2具体包括：对多点平滑频率估计Multi_Freq进行间隔M点的差分，获得多点差分频率估计Multi_FreqDiff：Multi_DiffFreq＝Multi_Freq-Multi_Freq对多点平滑幅度估计Multi_Amp进行间隔M点的差分，获得多点差分幅度估计Multi_AmpDiff：Multi_DiffAmp＝Multi_Amp-Multi_Amp 。7.根据权利要求6所述的方法，其特征在于，所述步骤4-3具体包括：步骤4-3-1：当多点平滑频率估计的第1点达到时，令Multi_Freqmax＝Multi_Freq，Multi_Freqmin＝Multi_Freq；步骤4-3-2：当多点平滑频率估计的第p点达到时，如果Multi_Freq大于Multi_Freqmax，则用Multi_Freq替换Multi_Freqmax，即Multi_Freqmax＝Multi_Freq；如果Multi_Freq小于Multi_Freqmin，则用Multi_Freq替换Multi_Freqmin，即Multi_Freqmin＝Multi_Freq；步骤4-3-3：当待识别调制信号脉宽结束时，通过Multi_Freqmax和Multi_Freqmin估计多点频率的带宽Multi_Band：Multi_Band＝Multi_Freqmax-Multi_Freqmin。8.根据权利要求7所述的方法，其特征在于，所述步骤4-4具体包括：基于多点平滑频率差分估计Multi_DiffFreq，统计待识别调制信号的差分带宽Multi_DiffBand；同时，基于多点差分幅度估计Multi_DiffAmp，统计待识别调制信号的差分幅度波动范围Multi_DiffAmpRange。9.根据权利要求8所述的方法，其特征在于，所述根据单点频率估计，得到待识别调制信号的信号调制类型为PSK信号，具体包括：根据单点频率估计，得到单点频率跳变次数；基于单点频率跳变次数识别PSK信号：对单点频率估计Single_Freq进行间隔N点差分获得单点差分频率值Single_DiffFreq，其中，N是所述步骤3中的间隔点数：Single_DiffFreq＝Single_Freq-Single_Freq如果Single_DiffFreq的绝对值大于Freq_Thres，则认为存在频率跳变；令跳变次数JumpCnt加1；如果跳变次数JumpCnt大于2，则识别为PSK信号；否则认为跳变次数不充分，识别成未知信号。10.根据权利要求8所述的方法，其特征在于，所述根据多点频率的带宽、待识别调制信号的差分带宽、待识别调制信号的差分幅度波动范围，得到待识别调制信号的信号调制类型为点频信号、未知信号、线调信号、非线调信号中的任一种，具体包括：如果多点频率的带宽Multi_Band小于带宽门限Band_Thres，并且待识别调制信号的差分幅度波动范围Multi_DiffAmpRange小于幅度门限Amp_Thres，则认为待识别调制信号的信号调制类型为点频信号；如果多点频率的带宽Multi_Band小于带宽门限Band_Thres，并且待识别调制信号的差分幅度波动范围Multi_DiffAmpRange大于等于幅度门限Amp_Thres，则认为待识别调制信号的信号调制类型为未知信号；如果多点频率的带宽Multi_Band大于等于带宽门限Band_Thres，并且Multi_DiffBand小于带宽门限Band_Thres，则认为待识别调制信号的信号调制类型为线调信号；如果多点频率的带宽Multi_Band大于等于带宽门限Band_Thres，并且Multi_DiffBand大于等于带宽门限Band_Thres，则认为待识别调制信号的信号调制类型为非线调信号。
说明书desc
技术领域本发明涉及调制识别技术领域，特别是一种基于FPGA处理的信号调制类型实时识别方法。背景技术信号调制识别技术，可将传统信号的认知从时域、频域、能量域扩展到更高层次的调制域，同时调制识别对于深入了解信号的用途、性能也可产生有力支撑。传统调制识别方法主要基于频域或者时频二维分布来进行，例如文献“王培培,徐才宏，瞬时频率雷达信号脉内调制识别技术，现代电子技术，2016.07”首先基于调频和调相两类信号的明显频谱差异特征实现分类识别，然后再进行类内细分类识别。但是，当前的调制识别方法由于需要首先估计出频谱或者时频分布，然后才能识别调制类型。处理速度通常来说较慢，难以满足时敏变化信号的调制识别需求。因此，本发明提出了，通过FPGA的实时流水线处理提升调制类型实时识别能力。发明内容鉴于此，本发明提供了一种基于FPGA处理的信号调制类型实时识别方法，通过FPGA的实时流水线处理提升调制类型实时识别能力和处理速度。本发明公开了一种基于FPGA处理的信号调制类型实时识别方法，包括以下步骤：步骤1：获取待识别调制信号的幅度和瞬时相位；步骤2：根据幅度，得到门限参数；其中，所述门限参数包括频率门限、带宽门限和幅度门限；步骤3：根据瞬时相位，得到单点频率估计；步骤4：根据单点频率估计和门限参数，得到待识别调制信号的信号调制类型。进一步地，所述步骤1具体包括：假设待识别调制信号为s，其采样率为fs，则采样间隔时间为其中，n为采样点；采用Cordic算法对待识别调制信号s的IQ波形进行估计，从而获得幅度A及瞬时相位所述步骤2具体包括：假设系统的噪底为NoiseBase，处理的积累点数为M，则基于幅度A的前M个点幅度均值估计SNR；SNR的估计公式为：根据信噪比SNR以及积累点数M估计频率门限Freq_Thres、带宽门限Band_Thres以及幅度门限Amp_Thres；进一步地，所述步骤3具体包括：根据瞬时相位进行流水线单点频率估计，将间隔N点提取瞬时单点频率，N由待识别调制信号的采样率fs及最大可适应的带宽Band决定，则其中，floor为向下取整；单点频率估计为：其中，Single_Freq为单点频率估计。进一步地，所述步骤4具体包括：步骤4-1：根据单点频率估计，得到多点平滑频率估计和多点平滑幅度估计；步骤4-2：根据多点平滑频率估计，得到多点频率差分估计；根据多点平滑幅度估计，得到多点幅度差分估计；步骤4-3：根据多点平滑频率估计，得到多点频率的带宽；步骤4-4：根据多点频率差分估计，得到待识别调制信号的差分带宽；根据多点差分幅度估计，得到待识别调制信号的差分幅度波动范围步骤4-5：根据单点频率估计，得到待识别调制信号的信号调制类型为PSK信号；根据多点频率的带宽、待识别调制信号的差分带宽、待识别调制信号的差分幅度波动范围，得到待识别调制信号的信号调制类型为点频信号、未知信号、线调信号、非线调信号中的任一种。进一步地，所述步骤4-1具体包括：基于单点频率估计，采用重心法进行多点频率估计；假设积累点数为M，则多点平滑频率估计的计算公式为：基于单点幅度值，采用多点平滑的方式获得多点幅度估计值：其中，Multi_Freq为多点平滑频率估计，Multi_Amp为多点平滑幅度估计，p为多点平滑频率估计采样点。进一步地，所述步骤4-2具体包括：对多点平滑频率估计Multi_Freq进行间隔M点的差分，获得多点差分频率估计Multi_FreqDiff：Multi_DiffFreq＝Multi_Freq-Multi_Freq对多点平滑幅度估计Multi_Amp进行间隔M点的差分，获得多点差分幅度估计Multi_AmpDiff：Multi_DiffAmp＝Multi_Amp-Multi_Amp进一步地，所述步骤4-3具体包括：步骤4-3-1：当多点平滑频率估计的第1点达到时，令Multi_Freqmax＝Multi_Freq，Multi_Freqmin＝Multi_Freq；步骤4-3-2：当多点平滑频率估计的第n点达到时，如果Multi_Freq大于Multi_Freqmax，则用Multi_Freq替换Multi_Freqmax，即Multi_Freqmax＝Multi_Freq；如果Multi_Freq小于Multi_Freqmin，则用Multi_Freq替换Multi_Freqmin，即Multi_Freqmin＝Multi_Freq；步骤4-3-3：当待识别调制信号脉宽结束时，通过Multi_Freqmax和Multi_Freqmin估计多点频率的带宽Multi_Band：Multi_Band＝Multi_Freqmax-Multi_Freqmin。进一步地，所述步骤4-4具体包括：基于多点平滑频率差分估计Multi_DiffFreq，统计待识别调制信号的差分带宽Multi_DiffBand；同时，基于多点差分幅度估计Multi_DiffAmp，统计待识别调制信号的差分幅度波动范围Multi_DiffAmpRange。进一步地，所述根据单点频率估计，得到待识别调制信号的信号调制类型为PSK信号，具体包括：根据单点频率估计，得到单点频率跳变次数；基于单点频率跳变次数识别PSK信号：对单点频率估计Single_Freq进行间隔N点差分获得单点差分频率值Single_DiffFreq，其中，N是所述步骤3中的过采样率：Single_DiffFreq＝Single_Freq-Single_Freq如果Single_DiffFreq的绝对值大于Freq_Thres，则认为存在频率跳变；令跳变次数JumpCnt加1；如果跳变次数JumpCnt大于2，则识别为PSK信号；否则认为跳变次数不充分，识别成未知信号。进一步地，所述根据多点频率的带宽、待识别调制信号的差分带宽、待识别调制信号的差分幅度波动范围，得到待识别调制信号的信号调制类型为点频信号、未知信号、线调信号、非线调信号中的任一种，具体包括：如果多点频率的带宽Multi_Band小于带宽门限Band_Thres，并且待识别调制信号的差分幅度波动范围Multi_DiffAmpRange小于幅度门限Amp_Thres，则认为待识别调制信号的信号调制类型为点频信号；如果多点频率的带宽Multi_Band小于带宽门限Band_Thres，并且待识别调制信号的差分幅度波动范围Multi_DiffAmpRange大于等于幅度门限Amp_Thres，则认为待识别调制信号的信号调制类型为未知信号；如果多点频率的带宽Multi_Band大于等于带宽门限Band_Thres，并且Multi_DiffBand小于带宽门限Band_Thres，则认为待识别调制信号的信号调制类型为线调信号；如果多点频率的带宽Multi_Band大于等于带宽门限Band_Thres，并且Multi_DiffBand大于等于带宽门限Band_Thres，则认为待识别调制信号的信号调制类型为非线调信号。由于采用了上述技术方案，本发明具有如下的优点：本发明首先通过SNR估计来自适应估计门限，然后利用FPGA的实时流水线处理能力，相继获得单点频率估计、多点频率估计、多点差分频率估计以及多点差分幅度估计的多种参数维度来识别调制类型；本发明可解决传统调制识别运算时间长的缺陷，处理速度快，充分利用FPGA的实时流水线处理能力，满足调制类型的实时识别需求。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明实施例中记载的一些实施例，对于本领域普通技术人员来讲，还可以根据这些附图获得其他的附图。图1为本发明实施例的一种基于FPGA处理的信号调制类型实时识别方法的示意图。具体实施方式结合附图和实施例对本发明作进一步说明，显然，所描述的实施例仅是本发明实施例一部分实施例，而不是全部的实施例。本领域普通技术人员所获得的所有其他实施例，都应当属于本发明实施例保护的范围。实施例一：参见图1，本发明提供了一种基于FPGA处理的信号调制类型实时识别方法的实施例。需要说明的是，本实施例中的方法步骤均是在FPGA处理芯片中运行。假设信号为s，其中n为采样点，其采样率为fs，则采样间隔时间为第一步：采用Cordic算法对信号s的IQ波形进行估计，从而获得幅度A及瞬时相位第二步：假设系统的噪底为NoiseBase，则基于幅度A的前M个点幅度均值估计SNR。SNR的估计公式为：第三步：根据信噪比SNR以及积累点数M来估计频率门限Freq_Thres、带宽门限Band_Thres以及幅度门限Amp_Thres。第三步：根据瞬时相位来进行流水线单点频率估计，将间隔N点来提取瞬时单点频率，通常N由信号的采样率fs及最大可适应的带宽Band来决定，则其中floor为向下取整。单点频率估计的结果为：第四步：进行流水线多点平滑频率估计Multi_Freq及多点平滑幅度估计Multi_Amp；为了减少信噪比带来的单点频率估计的误差大，因此采用重心法来进行多点频率估计，以此获得更高的频率估计精度。假设积累的点数为M，则多点平滑频率估计的计算公式为：针对多点幅度平滑，则直接采用平均方式来获得：第五步：对流水线多点平滑频率估计Multi_Freq进行间隔M点的差分，从而获得多点差分频率估计Multi_FreqDiff：Multi_DiffFreq＝Multi_Freq-Multi_Freq类似地，对流水线多点平滑幅度估计Multi_Amp进行间隔M点的差分，从而获得多点差分幅度估计Multi_AmpDiff：Multi_DiffAmp＝Multi_Amp-Multi_Amp第六步：基于多点平滑频率估计Multi_Freq，统计信号带宽Multi_Band。具体实施步骤如下：1、当Multi_Freq的第1点达到时，令Multi_Freqmax＝Multi_Freq，Multi_Freqmin＝Multi_Freq。当第n点达到时，2、如果Multi_Freq大于Multi_Freqmax，则用Multi_Freq替换Multi_Freqmax，即Multi_Freqmax＝Multi_Freq；3、如果Multi_Freq小于Multi_Freqmin，则用Multi_Freq替换Multi_Freqmin，即Multi_Freqmin＝Multi_Freq；4、当信号脉宽结束时，通过Multi_Freqmax和Multi_Freqmin来估计多点频率的带宽Multi_Band：Multi_Band＝Multi_Freqmax-Multi_Freqmin第七步：类似于第六步中的处理，基于多点平滑频率差分估计Multi_DiffFreq，统计信号的差分带宽Multi_DiffBand。同时，基于多点差分幅度估计Multi_DiffAmp，统计信号的差分幅度波动范围Multi_DiffAmpRange。第八步：根据单点频率估计，得到单点频率跳变次数：每当|Single_Freq-Single_Freq|＞Freq_Thres时，单点频率跳变次数加一；基于单点频率跳变次数来识别PSK信号：1、对单点频率估计Single_Freq进行间隔N点差分获得单点差分频率值Single_DiffFreq，其中N是第三步中的过采样率：Single_DiffFreq＝Single_Freq-Single_Freq如果Single_DiffFreq的绝对值大于Freq_Thres，则认为存在频率跳变。令跳变次数JumpCnt加1。2、如果跳变次数JumpCnt大于2，则识别为PSK信号；否则认为跳变次数不充分，识别成未知信号。第八步：点频及线调信号识别：1、如果Multi_Band小于Band_Thres，并且Multi_DiffAmpRange小于Amp_Thres，则认为是点频信号；2、如果Multi_Band小于Band_Thres，并且Multi_DiffAmpRange大于等于Amp_Thres，则认为是未知信号；3、如果Multi_Band大于等于Band_Thres，并且Multi_DiffBand小于Band_Thres，则认为是线调信号；4、如果Multi_Band大于等于Band_Thres，并且Multi_DiffBand大于等于Band_Thres，则认为是非线调信号。实施例二：为了便于理解，本发明提供了一个更为具体的实施例：假设信号为s，其中n为采样点，其采样率为fs＝40MHz，接收的滤波器带宽为Band＝20MHz。前沿SNR为20dB，对应于线性值为100。第一步：采用Cordic算法对信号s的IQ波形进行估计，从而获得幅度A及瞬时相位第二步：假设系统的噪底为NoiseBase，则基于幅度A的前M＝8个点幅度均值估计SNR。SNR的估计公式为：第三步：根据信噪比SNR以及积累点数M＝8来估计频率门限Freq_Thres、带宽门限Band_Thres以及幅度门限Amp_Thres。Freq_Thres＝5MHzBand_Thres＝0.48MHzAmp_Thres＝0.24dB第三步：根据瞬时相位来进行流水线单点频率估计，将间隔N点来提取瞬时单点频率，通常N由信号的采样率fs及最大可适应的带宽Band来决定，则其中floor为向下取整。单点频率估计的结果为：第四步：进行流水线多点平滑频率估计Multi_Freq及多点平滑幅度估计Multi_Amp；为了减少信噪比带来的单点频率估计的误差大，因此采用重心法来进行多点频率估计，以此获得更高的频率估计精度。假设积累的点数为M＝8，则多点平滑频率估计的计算公式为：针对多点幅度平滑，则直接采用平均方式来获得：第五步：对流水线多点平滑频率估计Multi_Freq进行间隔M＝8点的差分，从而获得多点差分频率估计Multi_FreqDiff：Multi_DiffFreq＝Multi_Freq-Multi_Freq类似地，对流水线多点平滑幅度估计Multi_Amp进行间隔M＝8点的差分，从而获得多点差分幅度估计Multi_AmpDiff：Multi_DiffAmp＝Multi_Amp-Multi_Amp第六步：基于多点平滑频率估计Multi_Freq，统计信号带宽Multi_Band。具体实施步骤如下：1、当Multi_Freq的第1点达到时，令Multi_Freqmax＝Multi_Freq，Multi_Freqmin＝Multi_Freq。当第n点达到时，2、如果Multi_Freq大于Multi_Freqmax，则用Multi_Freq替换Multi_Freqmax，即Multi_Freqmax＝Multi_Freq；3、如果Multi_Freq小于Multi_Freqmin，则用Multi_Freq替换Multi_Freqmin，即Multi_Freqmin＝Multi_Freq；4、当信号脉宽结束时，通过Multi_Freqmax和Multi_Freqmin来估计多点频率的带宽Multi_Band：Multi_Band＝Multi_Freqmax-Multi_Freqmin第七步：类似于第六步中的处理，基于多点平滑频率差分估计Multi_DiffFreq，统计信号的差分带宽Multi_DiffBand。同时，基于多点差分幅度估计Multi_DiffAmp，统计信号的差分幅度波动范围Multi_DiffAmpRange。第八步：每当 |Single_Freq-Single_Freq |＞Freq_Thres时，单点频率跳变次数加一；基于单点频率跳变次数来识别PSK信号：1、对单点频率估计Single_Freq进行间隔N＝2点差分获得单点差分频率值Single_DiffFreq，其中N＝2是第三步中的过采样率：Single_DiffFreq＝Single_Freq-Single_Freq如果Single_DiffFreq的绝对值大于Freq_Thres，则认为存在频率跳变。令跳变次数JumpCnt加1。2、如果跳变次数JumpCnt大于2，则识别为PSK信号；否则认为跳变次数不充分，识别成未知信号。第八步：点频及线调信号识别：1、如果Multi_Band小于Band_Thres，并且Multi_DiffAmpRange小于Amp_Thres，则认为是点频信号；2、如果Multi_Band小于Band_Thres，并且Multi_DiffAmpRange大于等于Amp_Thres，则认为是未知信号；3、如果Multi_Band大于等于Band_Thres，并且Multi_DiffBand小于Band_Thres，则认为是线调信号；4、如果Multi_Band大于等于Band_Thres，并且Multi_DiffBand大于等于Band_Thres，则认为是非线调信号。最后应当说明的是：以上实施例仅用以说明本发明的技术方案而非对其限制，尽管参照上述实施例对本发明进行了详细的说明，所属领域的普通技术人员应当理解：依然可以对本发明的具体实施方式进行修改或者等同替换，而未脱离本发明精神和范围的任何修改或者等同替换，其均应涵盖在本发明的权利要求保护范围之内。
