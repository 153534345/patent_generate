标题title
一种基于改进PSO优化双权值神经网络的风电功率预测方法
摘要abst
本发明涉及风电功率预测技术领域，具体涉及一种基于改进PSO优化双权值神经网络的风电功率预测方法，包括如下步骤：、获取风电功率预测数据，进行数据预处理，构建训练样本与预测样本；、构建双权值神经网络模型，初始化网络及相应参数，初始隐含层神经元个数k＝1，偏差精度为ε，样本数据归一化；、判别隐含层神经元个数，如k＝1，则选取原始样本输出为期望输出，否则选取第k‑1隐含层神经元输出偏差作为新的期望输出；、运用改进PSO算法修正、获取双权值神经网络的连接参数。本发明将改进的PSO优化算法用于双权值神经网络参数寻优，形成一种基于改进PSO优化双权值神经网络风电功率预测方法，能够在复杂的风电环境中，提高风电功率预测的精度。
权利要求书clms
1.一种基于改进PSO优化双权值神经网络的风电功率预测方法，其特征在于：包括如下步骤：步骤1、获取风电功率预测数据，进行数据预处理，构建训练样本与预测样本；步骤2、构建双权值神经网络模型，初始化网络及相应参数，初始隐含层神经元个数k＝1，偏差精度为ε，样本数据归一化；步骤3、判别隐含层神经元个数，如k＝1，则选取原始样本输出为期望输出，否则选取第k-1隐含层神经元输出偏差作为新的期望输出；步骤4、运用改进PSO算法修正、获取双权值神经网络的连接参数，包括方向权值，核心权值以及幅值，具体实施方法如下：步骤4.1、初始化种群，种群粒子包括3个方向权值、3个核心权值及1个幅值，采取实数编码并运用混沌算子进行初始化，设定最大迭代次数、种群个数、粒子范围；步骤4.2、计算粒子适应度值，计算全局最优值；步骤4.3、利用基本粒子群算法原理进行种群进化，粒子更新；步骤4.4、选取若干最优粒子进行局部深度优化；步骤4.5、选取若干最差粒子进行随机优化；步骤4.6、运用聚散度算子进行种群更新；步骤4.7、判别迭代次数是否达设定值，是则结束，否则执行步骤4.3；步骤5、判别是否满足偏差精度ε或达到设定的最大隐含层神经元个数，满足或达到，则结束训练；否则令k＝k+1，跳至步骤3；步骤6、用训练好的神经网络对预测样本进行风电功率预测，结合训练结果和预测结果进行神经网络评估；步骤7、重复步骤2至步骤6进行若干次训练与预测，根据每次神经网络评估结果，择优选取双权值神经网络用于风电功率预测。2.根据权利要求1所述的一种基于改进PSO优化双权值神经网络的风电功率预测方法，其特征在于：所述步骤1中，风电功率数据预处理的具体步骤如下：步骤1.1、基于事件异常的风电功率数据预处理，包括剔除不合理的数据、修正异常数据和补充丢失的数据；步骤1.2、基于数据参数合理范围的风电功率数据预处理，风电场数据参数主要包括风速V、风向DW、温度T、湿度H、功率、气压P，其参数合理范围设置表达如下：其中，Vmax为最大合理风速值，ΔV为单位时间风速变化值，ΔVmax为单位时间风速变化最大值，PW为单机容量功率值，ZPW为总装机容量功率值，PWmax和ZPWmax分别为单机和总装机功率的最大合理值，Pmin和Pmax分别为气压最小和最大合理值，ΔT为单位时间温度变化值，ΔTmax为单位时间温度变化最大值，ΔP为单位时间气压变化值，ΔPmax为单位时间气压变化最大值；步骤1.3、相似风电数据判别与检验，选取风速、舱外温度、塔外环境湿度为样本输入数据，风功率为样本输出数据，假设第i个样本数据为DWi，Ti，Hi和PWi，第j个样本数据为DWj，Tj，Hj和PWj，二者之间数据相似性可以用下式进行判别：式中SC为设定阀值，当上式成立则认为二者相似，此时检验二者输出功率偏差是否在合理范围，判别数据是否存在不合理现象。3.根据权利要求1所述的一种基于改进PSO优化双权值神经网络的风电功率预测方法，其特征在于：所述步骤4中，选取若干最优粒子进行局部深度优化的具体步骤如下：步骤4.4.1、初始化参数，随机产生m个方向6维角度；步骤4.4.2、第i个最优粒子为Xi更新方法如下：ΔXi＝C×，0＜C＜1，Xi＝Xi±ΔXi，式中D7＝cosα1cosα2cosα3cosα4cosα5cosα6，D3＝cosα1cosα2sinα3，D6＝cosα1cosα2cosα3cosα4cosα5sinα6，D5＝cosα1cosα2cosα3cosα4sinα5，D4＝cosα1cosα2cosα3sinα4，D2＝cosα1sinα2，D1＝sinα1，按照上述公式对m个方向及其反方向共计2m个方向分别计算粒子Xi的适应度值，然后选取最优适应度值并判别是否得到优化，是则更新粒子Xi最优解及最优适应度值，并记该最优更新方向为ΔXbest，否则返回步骤4.4.1；步骤4.4.3、沿最优方向继续最优粒子Xi优化，更新方法如下：Xi＝Xi+C1ΔXbest，C1＞1计算粒子Xi适应值并判别是否得到优化，是则更新粒子Xi最优解和粒子最优适应度值，更新C1＝C1,C2＞1，返回步骤4.4.3，否则执行步骤4.4.4；步骤4.4.4、判别所选若干最优粒子是否全部局部深度优化，是则更新全局最优值并结束，否则返回步骤4.4.1。4.根据权利要求1所述的一种基于改进PSO优化双权值神经网络的风电功率预测方法，其特征在于：所述步骤4中，运用聚散度算子进行种群更新的具体步骤如下：设粒子Xi的适应度值为Yi，粒子Xj的适应度值为Yj，以粒子Xi为中心，定义粒子Xi与粒子Xj的距离为定义适应度值之比为Fij＝Yi/Yj，距离聚散算子矩阵和适应度值聚散度算子分别为：式中的取值为1和0，当取值为1，反之取值为0，dS为设定常数，的取值为1和0，当Fij＜FS取值为1，反之取值为0，FS为设定常数；步骤4.6.1、判断当前总迭代次数是否小于设定值iter1，是则执行步骤4.6.2，初始化i＝1，否则算法结束；步骤4.6.2、运用距离聚散度算子判别第i个粒子是否需要更新，根据并判别该值是否大于设定值FdcS，是则执行步骤4.6.3，否则执行步骤4.6.4；步骤4.6.3、进一步运用距离聚散度算子和适应度值聚散度算子判别第i个粒子是否需要更新，根据并判别该值是否大于设定值FfcS，是则执行Xi＝Xi+rand×，Xpg为距离浓度低且适应值高的粒子，否则保持第i个粒子不变；步骤4.6.4、判别第i个粒子是否为种群最后一个粒子，是则算法结束，否则i＝i+1，返回步骤4.6.2。
说明书desc
技术领域本发明涉及风电功率预测技术领域，具体涉及一种基于改进PSO优化双权值神经网络的风电功率预测方法。背景技术随着社会的进步和科学技术的发展，人类对能源的需求日益增加，使得能源危机问题日益突出、严峻，诸如疫情期间拉闸限电现象时有发生，而石油、煤炭等能源作为传统能源，不可再生，以及造成对环境的污染等问题，使得人们迫切需求可再生新能源。因此，风能作为一种重要的低碳、环保、取之不尽，用之不竭新能源，越来越受到人类的青睐，风电已经成为全世界可持续再生能源发电战略的重要组成部分。然而，风能由于存在随机性、波动性、不连续性、难以控制等弊端，使得风电输出功率不稳定，不利于电网安全运行，为了规避该问题，必须对风电功率进行精确的预测，因此开展风电功率预测研究并逐步提高其预测精度是一项极具深远意义的工作。随着新兴群智能算法的发展及在工程领域的应用，且该类算法不依赖于对象问题的特征函数和解的形式，能有效解决多约束、非线性、多维度的复杂优化问题，故把该类方法与双权值神经网络相结合为风电功率预测精度问题的解决提供了一条新路。发明内容针对以上问题，本发明提供了一种基于改进PSO优化双权值神经网络的风电功率预测方法，能够在复杂的风电环境中，实现风电功率的精准预测。为了实现上述目的，本发明采用的技术方案如下：一种基于改进PSO优化双权值神经网络的风电功率预测方法，包括如下步骤：步骤1、获取风电功率预测数据，进行数据预处理，构建训练样本与预测样本；步骤2、构建双权值神经网络模型，初始化网络及相应参数，初始隐含层神经元个数k＝1，偏差精度为ε，样本数据归一化；步骤3、判别隐含层神经元个数，如k＝1，则选取原始样本输出为期望输出，否则选取第k-1隐含层神经元输出偏差作为新的期望输出；步骤4、运用改进PSO算法修正、获取双权值神经网络的连接参数，包括方向权值，核心权值以及幅值，具体实施方法如下：步骤4.1、初始化种群，种群粒子包括3个方向权值、3个核心权值及1个幅值，采取实数编码并运用混沌算子进行初始化，设定最大迭代次数、种群个数、粒子范围；步骤4.2、计算粒子适应度值，计算全局最优值；步骤4.3、利用基本粒子群算法原理进行种群进化，粒子更新；步骤4.4、选取若干最优粒子进行局部深度优化；步骤4.5、选取若干最差粒子进行随机优化；步骤4.6、运用聚散度算子进行种群更新；步骤4.7、判别迭代次数是否达设定值，是则结束，否则执行步骤4.3；步骤5、判别是否满足偏差精度ε或达到设定的最大隐含层神经元个数，满足或达到，则结束训练；否则令k＝k+1，跳至步骤3；步骤6、用训练好的神经网络对预测样本进行风电功率预测，结合训练结果和预测结果进行神经网络评估；步骤7、重复步骤2至步骤6进行若干次训练与预测，根据每次神经网络评估结果，择优选取双权值神经网络用于风电功率预测。优选地，所述步骤1中，风电功率数据预处理的具体步骤如下：步骤1.1、基于事件异常的风电功率数据预处理，事件异常是指诸如拉闸限电、天气异常等事件的发生导致风电数据不准确，此时要对所采集的历史数据进行有效处理，包括剔除不合理的数据、修正异常数据和补充丢失的数据；步骤1.2、基于数据参数合理范围的风电功率数据预处理，风电场数据参数主要包括风速V、风向DW、温度T、湿度H、功率、气压P，其参数合理范围设置表达如下：其中，Vmax为最大合理风速值，ΔV为单位时间风速变化值，ΔVmax为单位时间风速变化最大值，PW为单机容量功率值，ZPW为总装机容量功率值，PWmax和ZPWmax分别为单机和总装机功率的最大合理值，Pmin和Pmax分别为气压最小和最大合理值，ΔT为单位时间温度变化值，ΔTmax为单位时间温度变化最大值，ΔP为单位时间气压变化值，ΔPmax为单位时间气压变化最大值；步骤1.3、相似风电数据判别与检验，选取风速、舱外温度、塔外环境湿度为样本输入数据，风功率为样本输出数据，假设第i个样本数据为DWi，Ti，Hi和PWi，第j个样本数据为DWj，Tj，Hj和PWj，二者之间数据相似性可以用下式进行判别：式中SC为设定阀值，当上式成立则认为二者相似，此时检验二者输出功率偏差是否在合理范围，判别数据是否存在不合理现象。优选地，所述步骤4中，选取若干最优粒子进行局部深度优化的具体步骤如下：步骤4.4.1、初始化参数，随机产生m个方向6维角度；步骤4.4.2、第i个最优粒子为Xi更新方法如下：ΔXi＝C×，0＜C＜1，Xi＝Xi±ΔXi，式中D7＝cosα1 cosα2 cosα3 cosα4 cosα5 cosα6，D3＝cosα1 cosα2 sinα3，D6＝cosα1 cosα2 cosα3 cosα4 cosα5 sinα6，D5＝cosα1 cosα2 cosα3 cosα4 sinα5，D4＝cosα1 cosα2cosα3 sinα4，D2＝cosα1 sinα2，D1＝sinα1，按照上述公式对m个方向及其反方向共计2m个方向分别计算粒子Xi的适应度值，然后选取最优适应度值并判别是否得到优化，是则更新粒子Xi最优解及最优适应度值，并记该最优更新方向为ΔXbest，否则返回步骤4.4.1；步骤4.4.3、沿最优方向继续最优粒子Xi优化，更新方法如下：Xi＝Xi+C1ΔXbest，C1＞1计算粒子Xi适应值并判别是否得到优化，是则更新粒子Xi最优解和粒子最优适应度值，更新C1＝C1,C2＞1，返回步骤4.4.3，否则执行步骤4.4.4；步骤4.4.4、判别所选若干最优粒子是否全部局部深度优化，是则更新全局最优值并结束，否则返回步骤4.4.1。优选地，所述步骤4中，运用聚散度算子进行种群更新的具体步骤如下：设粒子Xi的适应度值为Yi，粒子Xj的适应度值为Yj，以粒子Xi为中心，定义粒子Xi与粒子Xj的距离为定义适应度值之比为Fij＝Yi/Yj，距离聚散算子矩阵和适应度值聚散度算子分别为：式中的取值为1和0，当取值为1，反之取值为0，dS为设定常数，的取值为1和0，当Fij＜FS取值为1，反之取值为0，FS为设定常数；步骤4.6.1、判断当前总迭代次数是否小于设定值iter1，是则执行步骤4.6.2，初始化i＝1，否则算法结束；步骤4.6.2、运用距离聚散度算子判别第i个粒子是否需要更新，根据并判别该值是否大于设定值FdcS，是则执行步骤4.6.3，否则执行步骤4.6.4；步骤4.6.3、进一步运用距离聚散度算子和适应度值聚散度算子判别第i个粒子是否需要更新，根据并判别该值是否大于设定值FfcS，是则执行Xi＝Xi+rand×，Xpg为距离浓度低且适应值高的粒子，否则保持第i个粒子不变；步骤4.6.4、判别第i个粒子是否为种群最后一个粒子，是则算法结束，否则i＝i+1，返回步骤4.6.2。本发明所述的一种基于改进PSO优化双权值神经网络的风电功率预测方法，具有以下有益效果：本发明将改进的PSO优化算法用于双权值神经网络参数寻优，形成一种基于改进PSO优化双权值神经网络风电功率预测方法，能够在复杂的风电环境中，更好的提高风电功率预测的精度。附图说明图1是本发明的双权值神经网络算法流程示意图；图2是本发明的改进PSO算法流程示意图；图3是本发明的三种不同算法风功率预测输出曲线图；图4是本发明的三种不同算法风功率预测偏差曲线图；图5是本发明的三种不同算法风功率预测相对偏差曲线图。其中，图3、图4和图5中BP和RBF曲线图为调用Matlab中自带BP和RBF神经网络函数预测运行结果，PSO-DWNN曲线图为本发明提出的改进PSO优化双权值神经网络预测运行结果，图3中RealValue为风电功率实际值。具体实施方式下面结合附图1-5和江苏某风电场实例对本发明的技术方案进行详细说明：步骤1：从江苏某风电场获取风电功率相关数据，对获取数据进行检测、修正，选取4个特征数据即风速、舱外温度、塔外环境湿度以及风功率为样本数据，样本更新周期为1小时，进行聚类处理，构建1080组训练样本和23组预测样本；步骤2：构建双权值神经网络模型，输入层个数为3，输出层个数为1，第j个隐含层神经元的输出表示为：ω为神经元的方向权值；ν为神经元的核心权值，A为神经元的幅值，运用min-max标准化方法进行样本数据归一化处理，初始隐含层神经元个数k＝1，偏差精度为ε＝0.01；步骤3、判别隐含层神经元个数，如k＝1，则选取原始样本输出为期望输出，否则选取第k-1隐含层神经元输出偏差作为新的期望输出；步骤4、运用改进PSO算法修正、获取双权值神经网络的连接参数，具体实施方法如下：步骤4.1、初始化种群，种群个数为40，种群粒子包括3个方向权值、3个核心权值及1个幅值，设定方向权值范围全为、核心权值范围分别为、和和幅值范围，采用混沌算子进行粒子初始化，设定最大迭代次数为maxiter＝1000，当前的迭代次数为iter＝1；步骤4.2、计算粒子适应度值，计算全局最优值；步骤4.3、设第i个粒子位置为Xi，粒子速度为Vi，粒子最好位置为pbesti，所有粒子全局最好位置为gbest，学习因子c1＝c2＝2，惯性因子w，并取wstar＝1，wend＝0.2，进行种群进化，粒子更新，具体实施方法如下：w＝×exp^2))+wend，Vi＝w×Vi+c1×rand×)+c2×rand×)，Xi＝Xi+Vi；步骤4.4、选取若干最优粒子进行局部深度优化，具体实施方法如下：步骤4.4.1、初始化参数，随机产生6个方向6维角度；步骤4.4.2、第i个最优粒子为Xi更新方法如下：ΔXi＝C×，C＝rand，Xi＝Xi±ΔXi，式中D7＝cosα1 cosα2 cosα3 cosα4 cosα5 cosα6，D3＝cosα1 cosα2 sinα3，D6＝cosα1 cosα2 cosα3 cosα4 cosα5 sinα6，D5＝cosα1 cosα2 cosα3 cosα4 sinα5，D4＝cosα1 cosα2cosα3 sinα4，D2＝cosα1 sinα2，D1＝sinα1，按照上述公式对6个方向及其反方向共计12个方向分别计算粒子Xi的适应度值，然后选取最优适应度值并判别是否得到优化，是则更新粒子Xi最优解及最优适应度值，并记该最优更新方向为ΔXbest，否则返回步骤4.4.1；步骤4.4.3、沿最优方向继续最优粒子Xi优化，更新方法如下：Xi＝Xi+C1ΔXbest，C1初始取值为2，计算粒子Xi适应值并判别是否得到优化，是则更新粒子Xi最优解和粒子最优适应度值，更新C1＝C1，返回步骤4.4.3，否则执行步骤4.4.4；步骤4.4.4、判别所选若干最优粒子是否全部局部深度优化，是则更新全局最优值并结束，否则返回步骤4.4.1；步骤4.5、选取若干最差粒子按照Xi＝Xi+rand×r1进行随机优化，r1取值为10；步骤4.6、运用聚散度算子进行种群更新，具体实施方法如下：设粒子Xi的适应度值为Yi，粒子Xj的适应度值为Yj，以粒子Xi为中心，定义粒子Xi与粒子Xj的距离为定义适应度值之比为Fij＝Yi/Yj，距离聚散算子矩阵和适应度值聚散度算子分别为：式中的取值为1和0，当取值为1，反之取值为0，dS为设定常数，的取值为1和0，当Fij＜FS取值为1，反之取值为0，FS为设定常数；步骤4.6.1、判断当前总迭代次数是否小于设定值iter1，是则执行步骤4.6.2，初始化i＝1，否则算法结束；步骤4.6.2、运用距离聚散度算子判别第i个粒子是否需要更新，根据并判别该值是否大于设定值FdcS，是则执行步骤4.6.3，否则执行步骤4.6.4；步骤4.6.3、进一步运用距离聚散度算子和适应度值聚散度算子判别第i个粒子是否需要更新，根据并判别该值是否大于设定值FfcS，是则执行Xi＝Xi+rand×，Xpg为距离浓度低且适应值高的粒子，否则保持第i个粒子不变；步骤4.6.4、判别第i个粒子是否为种群最后一个粒子，是则算法结束，否则i＝i+1，返回步骤4.6.2；步骤4.7、判别迭代次数是否达设定值，是则结束，否则执行步骤4.3；步骤5、判别是否满足偏差精度ε或达到设定的最大隐含层神经元个数，满足或达到，则结束训练；否则令k＝k+1，跳至步骤3；步骤6、用训练好的神经网络对预测样本进行风电功率预测，结合训练结果和预测结果进行神经网络评估；步骤7、重复步骤2至步骤6共进行10次训练与预测，根据每次神经网络评估结果，择优选取双权值神经网络用于风电功率预测。结果说明：BP算法和PSO-DWNN算法隐含层节点数都取10个，且皆连续运行10次取最优一个结果，从图3和图4的比较结果中可看出，本专利提出的PSO-DWNN算法预测结果与实际风电功率输出最为相似、预测结果偏差波动最小，其次为BP算法效果较好，而RBF算法预测结果最差且结果偏差比较大。由图5可以看出PSO-DWNN算法预测结果相对误差相比较其它两个算法普遍偏小，其中大于50％的为0个，50％至20％之间的也为0个，低于10％的高达20个，占总数的87％，BP和RBF算法预测结果相对误差大于10％的都为18个，占总数的78.3％，而大于20％的分别为10个和11个，占总数的43.5％和47.8％，大于50％的分别为2个和4个，占总数的8.7％和17.4％，可见BP和RBF算法预测结果可信度比PSO-DWNN算法低，特别是RBF算法预测结果较差，一定程度上达不到预期目的。PSO-DWNN算法之所以能获得比BP算法以及RBF算法更优的预测结果，其主要因为该算法的全局寻优能力和高维空间拟合能力都很强，对权值的初始化依赖程度远比其它两种算法小的多。综上所述，本发明在改进的PSO优化算法的基础上，将该算法用于双权值神经网络参数寻优，形成一种基于改进PSO优化双权值神经网络风电功率预测方法，该方法能更好的提高风电功率预测的精度。以上对本发明的一个实施例进行了详细说明，但所述内容仅为本发明的较佳实施例，不能被认为用于限定本发明的实施范围。凡依本发明申请范围所作的均等变化与改进等，均应仍归属于本发明的专利涵盖范围之内。
