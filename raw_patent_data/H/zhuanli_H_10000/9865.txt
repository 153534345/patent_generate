标题title
四极杆控制扫描质谱系统及其控制方法
摘要abst
本申请涉及一种四极杆控制扫描质谱系统及其控制方法，该系统包括下位机FPGA、放大电路和四级杆，下位机FPGA包括下行协议控制模块、扫描执行模块和DAC控制模块，扫描执行模块连接下行协议控制模块和DAC控制模块，DAC控制模块连接放大电路，放大电路连接四级杆。通过将下行协议控制模块、扫描执行模块和DAC控制模块集成到一块下位机FPGA中，集成度高，模块之间的协作同步性强，成本低且降低了系统体积。
权利要求书clms
1.一种四极杆控制扫描质谱系统，其特征在于，包括下位机FPGA、放大电路和四级杆，所述下位机FPGA包括下行协议控制模块、扫描执行模块和DAC控制模块，所述扫描执行模块连接所述下行协议控制模块和所述DAC控制模块，所述DAC控制模块连接所述放大电路，所述放大电路连接所述四级杆；所述下行协议控制模块对上位机下发的扫描参数进行解析和分块，得到参数块并发送至所述扫描执行模块；所述扫描执行模块根据所述参数块分阶段提取当前参数，并根据提取的当前参数控制所述DAC控制模块输出数字电压；所述放大电路对接收的数字电压进行数模转换和放大处理，并利用放大后的模拟电压激励所述四极杆。2.根据权利要求1所述的四极杆控制扫描质谱系统，其特征在于，还包括ADC芯片，所述下位机FPGA还包括图像数据整合存储模块、信号处理模块和ADC采集模块，所述扫描执行模块连接所述图像数据整合存储模块和所述ADC采集模块，所述信号处理模块连接所述图像数据整合存储模块和所述ADC采集模块，所述ADC采集模块连接所述ADC芯片；所述ADC采集模块对所述ADC芯片输出的数字信号进行数据采集，并将采集的数据发送至所述信号处理模块，所述信号处理模块对接收的数据进行处理后发送至所述图像数据整合存储模块进行整合存储。3.根据权利要求2所述的四极杆控制扫描质谱系统，其特征在于，所述扫描执行模块还根据提取的当前参数控制所述ADC采集模块进行数据采集，以及控制所述图像数据整合存储模块将存储的数据发送至上位机。4.根据权利要求3所述的四极杆控制扫描质谱系统，其特征在于，所述图像数据整合存储模块对接收的数据进行计数和存储，在数据达到预设条件后发送反馈信息至所述扫描执行模块，以及在接收到所述扫描执行模块返回的当前扫描完成指令后，将存储的数据按照谱图格式发送至上位机。5.根据权利要求2所述的四极杆控制扫描质谱系统，其特征在于，所述信号处理模块对接收的数据进行处理，包括基线校准、滤波、平滑、去噪、横向叠加和纵向叠加中的至少一种。6.根据权利要求1所述的四极杆控制扫描质谱系统，其特征在于，所述放大电路包括DAC芯片和射频放大电路，所述DAC芯片连接所述DAC控制模块和所述射频放大电路，所述射频放大电路连接所述四级杆。7.根据权利要求1-6任意一项所述的四极杆控制扫描质谱系统，其特征在于，还包括与所述下位机FPGA通信的上位机。8.根据权利要求7所述的四极杆控制扫描质谱系统，其特征在于，所述上位机包括扫描配置模块和下行通信模块，所述扫描配置模块连接所述下行通信模块，所述下行通信模块与所述下位机FPGA中的下行协议控制模块通信。9.根据权利要求8所述的四极杆控制扫描质谱系统，其特征在于，所述上位机还包括图像显示模块和上行通信模块，所述图像显示模块连接所述上行通信模块，所述上行通信模块与所述下位机FPGA中的图像数据整合存储模块通信。10.一种四极杆控制扫描质谱系统的控制方法，其特征在于，基于权利要求1-9任意一项所述的四极杆控制扫描质谱系统实现，包括：下行协议控制模块对上位机下发的扫描参数进行解析和分块，得到参数块并发送至扫描执行模块；所述扫描执行模块根据所述参数块分阶段提取当前参数，并根据提取的当前参数控制DAC控制模块输出数字电压；放大电路对接收的数字电压进行数模转换和放大处理，并利用放大后的模拟电压激励四极杆。
说明书desc
技术领域本申请涉及质谱仪设备技术领域，特别是涉及一种四极杆控制扫描质谱系统及其控制方法。背景技术质谱仪的四极杆扫描技术的基本原理是离子在电场的作用下聚焦在四极杆中心轴附近，电压施加方式为相对的一组极杆施加极性一致的电压，而相邻的极杆施加极性相反的电压，受到射频电场和直流电场的共同作用开始复杂的振荡运动，利用随时间变化的电场对不同质荷比的离子进行选择。在采集端，将离子的电荷数转化为电流，加倍放大，由模拟转数字信号，将不同的离子的信号强度汇集成图像，作为一幅四极杆扫描质谱图。传统的四极杆扫描质谱设备是采用多种集成电路系统分担不同责任，搭建起来的四极杆传输、扫描、采集、信号处理和存储功能，由于各种芯片都集成在硬件中，成本高且仪器体积大。发明内容基于此，有必要针对上述问题，提供一种成本低且可降低体积的四极杆控制扫描质谱系统及其控制方法。一种四极杆控制扫描质谱系统，包括下位机FPGA、放大电路和四级杆，所述下位机FPGA包括下行协议控制模块、扫描执行模块和DAC控制模块，所述扫描执行模块连接所述下行协议控制模块和所述DAC控制模块，所述DAC控制模块连接所述放大电路，所述放大电路连接所述四级杆；所述下行协议控制模块对上位机下发的扫描参数进行解析和分块，得到参数块并发送至所述扫描执行模块；所述扫描执行模块根据所述参数块分阶段提取当前参数，并根据提取的当前参数控制所述DAC控制模块输出数字电压；所述放大电路对接收的数字电压进行数模转换和放大处理，并利用放大后的模拟电压激励所述四极杆。在其中一个实施例中，四极杆控制扫描质谱系统还包括ADC芯片，所述下位机FPGA还包括图像数据整合存储模块、信号处理模块和ADC采集模块，所述扫描执行模块连接所述图像数据整合存储模块和所述ADC采集模块，所述信号处理模块连接所述图像数据整合存储模块和所述ADC采集模块，所述ADC采集模块连接所述ADC芯片；所述ADC采集模块对所述ADC芯片输出的数字信号进行数据采集，并将采集的数据发送至所述信号处理模块，所述信号处理模块对接收的数据进行处理后发送至所述图像数据整合存储模块进行整合存储。在其中一个实施例中，所述扫描执行模块还根据提取的当前参数控制所述ADC采集模块进行数据采集，以及控制所述图像数据整合存储模块将存储的数据发送至上位机。在其中一个实施例中，所述图像数据整合存储模块对接收的数据进行计数和存储，在数据达到预设条件后发送反馈信息至所述扫描执行模块，以及在接收到所述扫描执行模块返回的当前扫描完成指令后，将存储的数据按照谱图格式发送至上位机。在其中一个实施例中，所述信号处理模块对接收的数据进行处理，包括基线校准、滤波、平滑、去噪、横向叠加和纵向叠加中的至少一种。在其中一个实施例中，所述放大电路包括DAC芯片和射频放大电路，所述DAC芯片连接所述DAC控制模块和所述射频放大电路，所述射频放大电路连接所述四级杆。在其中一个实施例中，四极杆控制扫描质谱系统还包括与所述下位机FPGA通信的上位机。在其中一个实施例中，所述上位机包括扫描配置模块和下行通信模块，所述扫描配置模块连接所述下行通信模块，所述下行通信模块与所述下位机FPGA中的下行协议控制模块通信。在其中一个实施例中，所述上位机还包括图像显示模块和上行通信模块，所述图像显示模块连接所述上行通信模块，所述上行通信模块与所述下位机FPGA中的图像数据整合存储模块通信。一种四极杆控制扫描质谱系统的控制方法，基于上述的四极杆控制扫描质谱系统实现，包括：下行协议控制模块对上位机下发的扫描参数进行解析和分块，得到参数块并发送至扫描执行模块；所述扫描执行模块根据所述参数块分阶段提取当前参数，并根据提取的当前参数控制DAC控制模块输出数字电压；放大电路对接收的数字电压进行数模转换和放大处理，并利用放大后的模拟电压激励四极杆。上述四极杆控制扫描质谱系统及其控制方法，通过将下行协议控制模块、扫描执行模块和DAC控制模块集成到一块下位机FPGA中，集成度高，模块之间的协作同步性强，成本低且降低了系统体积。附图说明图1为一实施例中四极杆控制扫描质谱系统的结构示意图图；图2为一实施例中四极杆控制扫描质谱系统的控制流程图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。除非另有定义，本文所使用的所有的技术和科学术语与属于本申请的技术领域的技术人员通常理解的含义相同。本文中在本申请的说明书中所使用的术语只是为了描述具体的实施例的目的，不是旨在于限制本申请。需要说明的是，当一个元件被认为是“连接”另一个元件时，它可以是直接连接到另一个元件，或者通过居中元件连接另一个元件。以下实施例中的“连接”，如果被连接的电路、模块、单元等相互之间具有电信号或数据的传递，则应理解为“电连接”、“通信连接”等。在此使用时，单数形式的“一”、“一个”和“所述/该”也可以包括复数形式，除非上下文清楚指出另外的方式。还应当理解的是，术语“包括/包含”或“具有”等指定所陈述的特征、整体、步骤、操作、组件、部分或它们的组合的存在，但是不排除存在或添加一个或更多个其他特征、整体、步骤、操作、组件、部分或它们的组合的可能性。同时，在本说明书中使用的术语包括相关所列项目的任何及所有组合。在一个实施例中，如图1所示，提供了一种四极杆控制扫描质谱系统，包括下位机FPGA、放大电路和四级杆，下位机FPGA包括下行协议控制模块103、扫描执行模块104和DAC控制模块105，扫描执行模块104连接下行协议控制模块103和DAC控制模块105，DAC控制模块105连接放大电路，放大电路连接四级杆108；下行协议控制模块103对上位机下发的扫描参数进行解析和分块，得到参数块并发送至扫描执行模块104；扫描执行模块104根据参数块分阶段提取当前参数，并根据提取的当前参数控制DAC控制模块105输出数字电压；放大电路对接收的数字电压进行数模转换和放大处理，并利用放大后的模拟电压激励四极杆108。具体地，在一个实施例中，放大电路包括DAC芯片106和射频放大电路107，DAC芯片106连接DAC控制模块105和射频放大电路107，射频放大电路107连接四级杆108。进一步地，在一个实施例中，四极杆控制扫描质谱系统还包括ADC芯片109，下位机FPGA还包括图像数据整合存储模块112、信号处理模块111和ADC采集模块110，扫描执行模块104连接图像数据整合存储模块112和ADC采集模块110，信号处理模块111连接图像数据整合存储模块112和ADC采集模块110，ADC采集模块110连接ADC芯片109；ADC采集模块110对ADC芯片109输出的数字信号进行数据采集，并将采集的数据发送至信号处理模块111，信号处理模块111对接收的数据进行处理后发送至图像数据整合存储模块112进行整合存储。其中，下行协议控制模块103将上位机下发的扫描参数进行解析和分块，按照扫描模式将扫描参数区分不同的参数块。扫描执行模块104根据当前参数，计算和制定出阶梯扫描模型，其中包括初始电压、初始稳定时常、ADC采集点数及开始结束指示、台阶数、台阶步进计算、分段扫描、纵向叠加次数和循环扫描次数等。模型根据计算的DAC电压值按照时序规则发送给DAC芯片106，在每个DAC值达到稳定后会同时给ADC采集模块110发送采集开始指示信号。DAC控制模块105的作用在于，在扫描过程中不同台阶扫描执行模块104会发送不同的数字电压值给DAC控制模块105，进而来给到DAC芯片106。数字电压值是根据离子质量数决定，由下位机FPGA通过设定公式计算得出，DAC数字电压值同时决定了当前调谐参数的选择。DAC芯片106将下位机FPGA发送的数字电压转化成模拟电压，射频放大电路107将模拟电压进行放大来激励四极杆108，四极杆108产生磁场会选择指定质量的离子通过，将其余离子引向四极杆108上而淘汰。进一步地，ADC芯片109的作用是将通过的离子转换的电流强度进行采集，并转化为数字信号传递给下位机FPGA。在一个实施例中，扫描执行模块104还根据提取的当前参数控制ADC采集模块进行数据采集。具体地，ADC采集模块110在扫描执行模块104发送的采集开始指示信号到达后，开始接收ADC芯片109传递给下位机FPGA的数字信号，ADC采集模块110在每个阶段采集结束会返回采集结束指示信号给到扫描执行模块104。信号处理模块111对采集到的信号在数字域做一系列的处理，其作用一是弥补硬件方面的不足，其作用二是使质谱图像更加清晰和准确。信号处理模块对信号进行数据域处理的方式并不唯一，在一个实施例中，对接收的数据进行处理，包括基线校准、滤波、平滑、去噪、横向叠加和纵向叠加中的至少一种。其中，基线校准是处理芯片基准线为非0值带来的问题，同时将正负电压调整为正电压进行后期处理；滤波是使用低通滤波器将带外噪声减弱，提升信噪比，平滑算法是整合信号波形，同时将噪声取平均，为后面的降噪处理做准备，降噪则将区分出来的噪声再一次降低，得到较好的信噪比；数据横向叠加和纵向叠加，作用是增强信号的准确性，压缩数据量，可将10个以上数据通过累加计算，以1个数据来上传给上位机，大大减少了数据量，不需要外部存储芯片来做存储。此外，横向叠加和纵向叠加处理也可以是在图像数据整合存储模块112中完成。在一个实施例中，扫描执行模块104还控制图像数据整合存储模块112将存储的数据发送至上位机。进一步地，图像数据整合存储模块112对接收的数据进行计数和存储，在数据达到预设条件后发送反馈信息至扫描执行模块104，以及在接收到扫描执行模块104返回的当前扫描完成指令后，将存储的数据按照谱图格式发送至上位机。具体地，图像数据整合存储模块112的作用在于将处理后的数据进行存储和计数，达到一帧数据时会询问扫描执行模块104是否发送，在扫描执行模块104判断纵向叠加已完成时，会允许将整帧数据发送给上位机，其中数据的存储可以是使用下位机FPGA的内部资源来实现。在一个实施例中，四极杆控制扫描质谱系统还包括与下位机FPGA通信的上位机。具体地，上位机包括扫描配置模块101和下行通信模块102，扫描配置模块101连接下行通信模块102，下行通信模块102与下位机FPGA中的下行协议控制模块103通信。上位机的功能包括了扫描参数配置和扫描指令的下发，通过硬件接口、私有协议与下位机FPGA通信，其传输速率达到千兆传输。其中，扫描指令可包括开始命令和停止命令。具体地，扫描配置模块101的作用是定义每幅谱图扫描的方式，将需要下发的参数使用协议数据流方式下发给下位机FPGA，基本参数可包括初始电压、扫描离子个数、电压差值、扫描趋势、采集时间、叠加次数、循环模式以及阶段数扫描选择等。此外，在一个实施例中，上位机还包括图像显示模块114和上行通信模块113，图像显示模块114连接上行通信模块113，上行通信模块113与下位机FPGA中的图像数据整合存储模块112通信。上行通信模块113和图像显示模块114的功能是上位机将接收到的帧数据按照规定格式显示成质谱图像。上述四极杆控制扫描质谱系统，通过将下行协议控制模块、扫描执行模块和DAC控制模块集成到一块下位机FPGA中，集成度高，模块之间的协作同步性强，成本低且降低了系统体积。在一个实施例中，还提供了一种四极杆控制扫描质谱系统的控制方法，基于上述的四极杆控制扫描质谱系统实现，包括：下行协议控制模块对上位机下发的扫描参数进行解析和分块，得到参数块并发送至扫描执行模块；扫描执行模块根据参数块分阶段提取当前参数，并根据提取的当前参数控制DAC控制模块输出数字电压；放大电路对接收的数字电压进行数模转换和放大处理，并利用放大后的模拟电压激励四极杆。在一个实施例中，该方法还包括：ADC采集模块对ADC芯片输出的数字信号进行数据采集，并将采集的数据发送至信号处理模块；信号处理模块对接收的数据进行处理后发送至图像数据整合存储模块进行整合存储。在一个实施例中，对接收的数据进行处理，包括基线校准、滤波、平滑、去噪、横向叠加和纵向叠加中的至少一种。在一个实施例中，该方法还包括：图像数据整合存储模块对接收的数据进行计数和存储，在数据达到预设条件后发送反馈信息至扫描执行模块，以及在接收到扫描执行模块返回的当前扫描完成指令后，将存储的数据按照谱图格式发送至上位机。需要说明的是，关于四极杆控制扫描质谱系统的控制方法的具体限定可以参见上文中对于四极杆控制扫描质谱系统的限定，在此不再赘述。上述四极杆控制扫描质谱系统的控制方法，通过将下行协议控制模块、扫描执行模块和DAC控制模块集成到一块下位机FPGA中，集成度高，模块之间的协作同步性强，成本低且降低了系统体积。为便于更好地理解上述四极杆控制扫描质谱系统及其控制方法，下面结合具体实施例进行详细解释说明。正如背景技术所述，传统的四极杆扫描质谱设备采用多种集成电路系统分担不同责任，存在以下不足：1、由于各种芯片都集成在硬件中，成本高；2、由于各种芯片都集成在硬件中，功耗大，仪器体积大；3、各个系统都有自己的运行方式，每个模块之间的交互都需要协议握手和对于低速系统的迁就，整体联动差，数据信息交互的速率会降低，缓存资源增加。基于此，本申请提供了一种基于FPGA的高集成度四极杆控制扫描质谱系统，将四极杆系统的几大模块在FPGA系统中统一实现，使用相同的系统时钟，达到协调性一致和实时性高速性；联合上位机，实现千兆传输、多模式切灵活的四极杆扫描控制，同时联动数据采集模块，达到高速实时的扫描＝＞采集＝＞信号处理＝＞存储＝＞高速传输；在信号处理中，进行了基线校准算法、数字滤波、平滑、去噪，弥补了硬件方面的不足，切提升了频谱信号质量；在设计中使用了横向累加和纵向累加，将数据量减少10倍以上，存储在FPGA内部实现，不需要外部存储芯片，且为上位机节省了数据处理的负担，降低系统CPU负荷。具体地，如图1所示，一种基于FPGA的高集成度四极杆控制扫描质谱系统，包括了上位机、下位机FPGA、DAC芯片106、射频放大电路107、四极杆108和ADC芯片109。上位机实现扫描参数下发，质谱图像显示；FPGA作为下位机，在接收到上位机的扫描参数后，实现扫描执行，同时实现数据采集、信号处理、数据存储和数据上传；DAC芯片106实现数字信号转化模拟信号，射频放大电路107实现将DAC转化后的模拟信号进行电压放大，给四极杆108提供高电压激励。上位机部分，包括了扫描参数配置和扫描指令的下发，通过硬件接口、私有协议与FPGA通信，其传输速率达到千兆传输。扫描参数配置，其作用在于定义了每幅谱图扫描的方式，将需要下发的参数，使用协议数据流方式下发给下位机，基本的参数包括初始电压、扫描离子个数、电压差值、扫描趋势、采集时间、叠加次数、循环模式、阶段数扫描选择；扫描指令包括了开始命令和停止命令。通信协议部分，其作用在于上位机与FPGA之间所定义的收发格式的整合和解析，保证通信的安全性和保密性。质谱图像显示，是将FPGA上传来的数据按照规定格式在横轴为离子质量，纵轴为离子强度的坐标中显示出不同离子强度的质谱图像。FPGA部分，是整个系统的核心部分，包括了下行协议控制模块103、扫描执行模块104、DAC控制模块105、ADC采集模块110、信号处理模块111、图像数据整合存储模块112。其中，下行协议控制模块103用于将上位机下发的扫描参数进行解析和分块，按照扫描模式将扫描参数区分不同的参数块；扫描执行模块104的作用在于根据当前参数，计算和制定出阶梯扫描模型，其中包括初始电压、初始稳定时常、adc采集点数及开始结束指示、台阶数、台阶步进计算、分段扫描、纵向叠加次数和循环扫描次数，模型会根据计算的DAC电压值按照时序规则发送给DAC芯片106，在每个DAC值达到稳定后会同时给ADC采集模块110发送采集开始指示信号。DAC控制模块105的作用在于，扫描执行模块104在扫描过程中不同台阶会发送不同的数字电压值给DAC控制模块105，来给到DAC芯片106，数字电压值是根据离子质量数决定，由FPGA通过公式计算得出，DAC数字电压值同时决定了当前调谐参数的选择。DAC芯片106、射频放大电路107和四极杆108，其作用在于DAC芯片106将FPGA发送的数字电压转化成模拟电压，射频放大电路107将模拟电压进行放大来激励四极杆108，四极杆108产生磁场会选择指定质量的离子通过，将其余离子引向四极杆108上淘汰。ADC芯片109是将通过的离子转换的电流强度进行采集，并转化为数字信号传递给FPGA；ADC采集模块110的工作是在DAC的采集开始指示信号到达后开始接收ADC芯片109传递给FPGA的数字信号，每个阶段采集结束会返回采集结束指示信号给到扫描执行模块104；信号处理模块111是对于采集到的信号在数字域做一系列的处理，其作用一是弥补硬件方面的不足，其作用二是使质谱图像更加清晰和准确；信号处理主要包括了基线校准、滤波、平滑、去噪、横向叠加和纵向叠加。其中，数据横向叠加和纵向叠加，起作用是增强信号的准确性，压缩数据量，可将10个以上数据通过累加计算，以1个数据来上传给上位机，大大减少了数据量，不需要外部存储芯片来做存储。图像数据整合存储模块112的作用在于将处理后的数据进行存储和计数，达到一帧数据时，会询问扫描执行模块104是否发送，在扫描执行模块104判断纵向叠加已完成时，会允许将整帧数据发送给上位机，其中存储是使用FPGA内部资源来实现。上行通信模块113和图像显示模块114是上位机将接收到的帧数据按照规定格式显示成质谱图像。其中，上位机与下位机的通信方式并不唯一，可根据实际情况进行调整。四极杆108是指四极杆质量分析器里面的四根圆柱金属杆，其功能是实现通过控制射频电压，施加在每根杆上，一对极棒为正，另一对为负，幅值相同，相位相反，可使相对应的离子通过，其他离子会在极棒中被中和。DAC芯片106即数模转换器，将数字信号转换成模拟信号的器件。ADC芯片109即模数转换器，将模拟信号转换成数字信号的器件。具体地，上位机端，扫描配置模块101和下行通信模块102，为初始电压、扫描离子个数、电压差值、扫描趋势、采集时间、叠加次数、循环模式、阶段数扫描选择，所有参数根据用户需要来做选择配置，所有参数发送为2Byte，按照协议格式以数据流形式下发给下位机，待返回配置正常之后发送开始扫描指令。FPGA端，是以千兆速率与上位机进行上下行全双工传输，下行协议控制模块103是将下发参数解析出来后，按照规定格式存储，并按照扫描阶段来提取。扫描执行模块104，分阶段提取当前参数，计算和制定出阶梯扫描模型，其中包括初始电压、初始稳定时常、ADC采集点数及开始结束指示、台阶数、台阶步进计算、分段扫描、纵向叠加次数和循环扫描次数，此外会把实时调谐在扫描过程中实现，将建立的扫描模型，按照状态机时序控制DAC电压发送和ADC数据采集。DAC控制模块105，根据计算的DAC电压值发送给DAC芯片106电压，通过射频放大电路107形成当前高压激励四极杆108，使指定离子顺利通过。ADC采集模块110，在允许采集时间内，对允许离子通过时形成的电流的采集，采集时间是高压稳定后的持续时间。信号处理模块111，是将采集到的信号进行处理，其中基线校准是处理芯片基准线为非0值带来的问题，同时将正负电压调整为正电压进行后期处理，滤波是使用低通滤波器将带外噪声减弱，提升信噪比，平滑算法是整合信号波形，同时将噪声取平均，为后面的降噪处理做准备，降噪则将区分出来的噪声再一次降低，得到较好的信噪比。图像整合存储模块112，实现信号的纵向累加和横向累加，其目的是得到分辨率更高的质谱图，切数据量较少10倍以上，横向累加个数和纵向累加次数由扫描执行模块决定，图像整合存储模块将处理后的数据进行FPGA内部存储，完成一整帧数据后，由扫描执行模块判断是否完成了纵向叠加，如果已经完成，则将数据全部发送给上位机；上位机端，上行通信模块113和图像显示模块114，将接收到的数据按照坐标格式进行显示。如图2所示为基于fpga的高集成度四极杆控制扫描质谱系统的流程图，该过程包括以下步骤：步骤201，上位机发送扫描参数和开始命令；步骤202，通过通信协议将数据发给下位机FPGA；步骤203，FPGA将参数解析后，按照规定的计算规则来控制DAC扫描时序；步骤204，由内部状态机将扫描模型执行，实现阶梯式扫描，包括获取参数，初始电压配置、初始稳定时间、阶梯电压计算和配置、阶梯稳定时间和信号采集；步骤205，将采集数据进行信号处理；步骤206，处理后的数据进行计数和存储，在数据达到一幅谱图时，将信息反馈给扫描执行模块；步骤207，扫描执行模块判断当前扫描完成后，将存储的数据按图谱格式发送给上位机；步骤208，上位机按照离子质量数和离子强度坐标显示出谱图。上述基于FPGA的高集成度四极杆控制扫描质谱系统，具有以下优点：1.由一块FPGA芯片实现整体系统，节约成本，降低功耗，可以减小仪器体积；2.将通信模块、扫描模块、采集模块、信号处理模块、存储模块，统一由FPGA实现，都是独立开发技术，集成度高，模块之间的协作同步性强，且速度可达到ns级别，上位机由进程处理，通常要达到ms级别；3.FPGA来做底层算法实现，可以节省额外的算法芯片，可以分担CPU负荷，提升仪器整体性能；4.使用FPGA来设计算法或者功能模块，由于是是硬件顶层实现，稳定性和保密性强，且平台移植性好。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请专利的保护范围应以所附权利要求为准。
