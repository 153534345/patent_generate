标题title
基于非客户端模式被动检查离线非法外联方法和装置
摘要abst
本申请涉及一种基于非客户端模式被动检查离线非法外联方法、装置、计算机设备、存储介质和计算机程序产品。方法包括：获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；若第二访问报文中包含有与第一访问报文无关的行为信息，且成功解析外网地址至非法外联服务器，则将外网地址的访问痕迹和内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识。采用本方法能够保障内网设备中内部信息的安全性和保密性。
权利要求书clms
1.一种基于非客户端模式被动检查离线非法外联方法，其特征在于，包括：获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。2.根据权利要求1所述的方法，其特征在于，所述方法还包括：打开所述外网地址并向预设的DNS策略进行请求解析，通过分析判定是否解析所述外网地址到非法外联服务器；若解析不到所述外网地址，则判断当前连接为合法外联，允许所述内网终端执行正常访问操作。3.根据权利要求2所述的方法，其特征在于，所述预设的DNS策略识别所述内网终端的信息包括：所述内网终端访问数据库服务器信息、所述内网终端打印任务信息、所述内网终端上传下载记录信息、所述内网终端DNS解析记录信息、所述内网终端VPN服务器使用信息以及所述内网终端的网页浏览记录信息中的至少一种。4.根据权利要求1所述的方法，其特征在于，所述非法外联检测服务器，还用于生成非法外联日志，所述非法外联日志用于记录存在非法外联行为的内网终端。5.根据权利要求1所述的方法，其特征在于，所述非法外联检测服务器，还用所述非法外联检测服务器将禁止访问内网资源的事件返回给存在非法外联行为的内网终端，以提示用户所述内网终端存在非法外联的行为，并且立即终止非法外联的行为。6.根据权利要求1所述的方法，其特征在于，所述非法外联检测服务器，还用于禁止存在非法外联行为的内网终端服务内网资源。7.一种基于非客户端模式被动检查离线非法外联装置，其特征在于，所述装置包括：获取模块，用于获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；比对模块，用于在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；检测模块，用于若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。8.一种计算机设备，包括存储器和处理器，所述存储器存储有计算机程序，其特征在于，所述处理器执行所述计算机程序时实现权利要求1至6中任一项所述的方法的步骤。9.一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求1至6中任一项所述的方法的步骤。10.一种计算机程序产品，包括计算机程序，其特征在于，该计算机程序被处理器执行时实现权利要求1至6中任一项所述的方法的步骤。
说明书desc
技术领域本申请涉及网络安全技术领域，特别是涉及一种基于非客户端模式被动检查离线非法外联方法、装置、计算机设备、存储介质和计算机程序产品。背景技术为了提高内网的安全性，一些信息安全要求较高的单位，禁止内部网络与互联网等外部网络连接，采取物理隔离的方式进行控制。但在实际的工作中，由于一些用户的安全意识淡薄，会经常有意无意的非法外联。极易增加跳板攻击和非法入侵的风险。相关技术中存在内网设备中内部信息的安全性不高的问题。发明内容基于此，有必要针对上述技术问题，提供一种能够保障内网设备中内部信息的安全性和保密性的基于非客户端模式被动检查离线非法外联方法、装置、计算机设备、计算机可读存储介质和计算机程序产品。第一方面，本申请提供了一种基于非客户端模式被动检查离线非法外联方法，其特征在于，包括：获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。在其中一个实施例中，所述方法还包括：打开所述外网地址并向预设的DNS策略进行请求解析，通过分析判定是否解析所述外网地址到非法外联服务器；若解析不到所述外网地址，则判断当前连接为合法外联，允许所述内网终端执行正常访问操作。在其中一个实施例中，所述预设的DNS策略识别所述内网终端的信息包括：所述内网终端访问数据库服务器信息、所述内网终端打印任务信息、所述内网终端上传下载记录信息、所述内网终端DNS解析记录信息、所述内网终端VPN服务器使用信息以及所述内网终端的网页浏览记录信息中的至少一种。在其中一个实施例中，所述非法外联检测服务器，还用于生成非法外联日志，所述非法外联日志用于记录存在非法外联行为的内网终端。在其中一个实施例中，所述非法外联检测服务器，还用所述非法外联检测服务器将禁止访问内网资源的事件返回给存在非法外联行为的内网终端，以提示用户所述内网终端存在非法外联的行为，并且立即终止非法外联的行为。在其中一个实施例中，所述非法外联检测服务器，还用于禁止存在非法外联行为的内网终端服务内网资源。第二方面，本申请还提供了一种基于非客户端模式被动检查离线非法外联装置。所述装置包括：获取模块，用于获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；比对模块，用于在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；检测模块，用于若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。第三方面，本申请还提供了一种计算机设备。所述计算机设备包括存储器和处理器，所述存储器存储有计算机程序，所述处理器执行所述计算机程序时实现以下步骤：获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。第四方面，本申请还提供了一种计算机可读存储介质。所述计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现以下步骤：获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。第五方面，本申请还提供了一种计算机程序产品。所述计算机程序产品，包括计算机程序，该计算机程序被处理器执行时实现以下步骤：获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。上述基于非客户端模式被动检查离线非法外联方法、装置、计算机设备、存储介质和计算机程序产品，通过获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；第一访问报文为内网终端通过访问外网地址生成的报文；第二访问报文为内网终端通过访问内网地址生成的报文；在检测到内网终端访问目标浏览器时，将目标脚本程序加载至本地；目标脚本程序用于读取目标浏览器Cookie以模拟比对第一访问报文和第二访问报文；若第二访问报文中包含有与第一访问报文无关的行为信息，且成功解析外网地址至非法外联服务器，则将外网地址的访问痕迹和内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；非法外联检测服务器用于定位内网终端存在非法外联行为；非法外联标识用于供认证设备执行非法外联告警操作，能在未安装客户端代理软件的前提下，检测终端离开内网后的非法外联行为进行细致的监测。更好的无感知的将终端离开内网之后的非法外联进行监测，有效的避免了跳板攻击，信息泄露等网络安全事件的发生。附图说明图1为一个实施例中一种基于非客户端模式被动检查离线非法外联方法的应用环境图；图2为一个实施例中一种基于非客户端模式被动检查离线非法外联方法的流程示意图；图3为一个实施例中另一种基于非客户端模式被动检查离线非法外联方法的流程示意图；图4为一个实施例中一种基于非客户端模式被动检查离线非法外联装置的结构框图；图5为一个实施例中计算机设备的内部结构图。具体实施方式为了使本申请的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本申请进行进一步详细说明。应当理解，此处描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。本申请实施例提供的基于非客户端模式被动检查离线非法外联方法，可以应用于如图1所示的应用环境中。其中，内网终端110通过网络与非法外联检测服务器120进行通信。数据存储系统可以存储非法外联检测服务器120需要处理的数据。数据存储系统可以集成在非法外联检测服务器120上，也可以放在云上或其他网络服务器上。内网终端110获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；第一访问报文为内网终端通过访问外网地址生成的报文；第二访问报文为内网终端通过访问内网地址生成的报文；内网终端110在检测到内网终端访问目标浏览器时，将目标脚本程序加载至本地；目标脚本程序用于读取目标浏览器Cookie以模拟比对第一访问报文和第二访问报文；若第二访问报文中包含有与第一访问报文无关的行为信息，且成功解析外网地址至非法外联服务器，内网终端110则将外网地址的访问痕迹和内网地址的访问痕迹上报至非法外联检测服务器120，并生成非法外联标识；非法外联检测服务器120用于定位内网终端存在非法外联行为；非法外联标识用于供认证设备执行非法外联告警操作。实际应用中，内网终端110可以但不限于是各种个人计算机、笔记本电脑、智能手机、平板电脑、物联网设备和便携式可穿戴设备，物联网设备可为智能音箱、智能电视、智能空调、智能车载设备等。便携式可穿戴设备可为智能手表、智能手环、头戴设备等。非法外联检测服务器120可以用独立的服务器或者是多个服务器组成的服务器集群来实现。在一个实施例中，如图2所示，提供了一种基于非客户端模式被动检查离线非法外联方法，以该方法应用于图1中的内网终端为例进行说明，包括以下步骤：步骤S210，获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文.步骤S220，在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文.步骤S230，若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。上述一种基于非客户端模式被动检查离线非法外联方法，能在未安装客户端代理软件的前提下，检测终端离开内网后的非法外联行为进行细致的监测。更好的无感知的将终端离开内网之后的非法外联进行监测，有效的避免了跳板攻击，信息泄露等网络安全事件的发生。在非法外联检测服务器中设置内网IP网段范围进行非法外联扫描探测，当内网终端同时连接内网、连接互联网。非法外联检测服务器将内嵌外部公网取证平台IP及探测数据包则通过内网终端的路由转发服务进行数据转发，此时，外部公网服务器收到来自内网非法外联检测服务器发出的探测数据包,记录该非法外联终端的IP等信息，并对内网非法外联服务器进行回应，内网非法外联检查服务器告警，外部取证平台留存证据。该技术优点在于非客户端模式、主动检查机制。无需受制于终端对客户端的依赖性，降低被动检查带来的时效性掌握了主动权，具备时效性。在另一个实施例中，打开所述外网地址并向预设的DNS策略进行请求解析，通过分析判定是否解析所述外网地址到非法外联服务器；若解析不到所述外网地址，则判断当前连接为合法外联，允许所述内网终端执行正常访问操作。在另一个实施例中，所述预设的DNS策略识别所述内网终端的信息包括：所述内网终端访问数据库服务器信息、所述内网终端打印任务信息、所述内网终端上传下载记录信息、所述内网终端DNS解析记录信息、所述内网终端VPN服务器使用信息以及所述内网终端的网页浏览记录信息中的至少一种。在另一个实施例中，所述非法外联检测服务器，还用于生成非法外联日志，所述非法外联日志用于记录存在非法外联行为的内网终端。在另一个实施例中，所述非法外联检测服务器，还用所述非法外联检测服务器将禁止访问内网资源的事件返回给存在非法外联行为的内网终端，以提示用户所述内网终端存在非法外联的行为，并且立即终止非法外联的行为。在另一个实施例中，所述非法外联检测服务器，还用于禁止存在非法外联行为的内网终端服务内网资源。实施例1本实施例提供基于非客户端模式被动检查离线非法外联方法，其通过特定的JavaScript脚本程序被终端访问的浏览器加载到本地去核查DNS服务器解析外网访问痕迹，请参阅图3，根据本发明实施例1的基于非客户端模式被动检查离线非法外联方法，其步骤如下：步骤S1，内网终端通过认证操作连接到互联网并生成第一访问报文；步骤S2，所述内网终端连接至内网并生成第二访问报文，在访问浏览器时将JavaScript脚本程序加载到本地；步骤S3，所述JavaScript脚本程序通过读取所述内网终端浏览器Cooike模拟通过比对所述第一访问报文和所述第二访问报文，打开其访问的外网地址向预设的DNS策略进行请求解析；步骤S4，通过自动分析判定是否可以解析外网地址到非法外联服务器；其中通过自动分析判定是否可以解析外网地址到非法外联服务器的具体步骤为：步骤S41，当解析不到外网地址时，则当前连接为合法外联，执行正常访问；步骤S42，当解析到外网地址后将所述内网地址和所述外网地址的访问痕迹上报到非法外联检测服务器并生成非法外联标识；步骤S5，认证设备接收所述非法外联标识，确定存在非法外联的终端并立即进行非法外联告警；步骤S6，所述非法外联检测服务器禁止存在非法外联的终端访问内网资源。所述非法外联检测服务器生成非法外联日志，用于记录存在非法外联的内网终端。所述非法外联检测服务器将禁止访问内网资源的事件返回给存在非法外联的内网终端，提示用户存在非法外联的行为，并且立即终止非法外联的行为。本发明与以往的的外联检测手段相比，能在未安装客户端代理软件的前提下，检测终端离开内网后的非法外联行为进行细致的监测。更好的无感知的将终端离开内网之后的非法外联进行监测，有效的避免了跳板攻击，信息泄露等网络安全事件的发生。所述预设的DNS策略识别包括：所述内网终端访问数据库服务器信息、所述内网终端打印任务信息、所述内网终端上传下载记录信息、所述内网终端DNS解析记录信息、所述内网终端VPN服务器使用信息以及所述内网终端的网页浏览记录信息中的至少一种。当所述JavaScript脚本程序读取所述第一访问报文和所述第二访问报文时，若所述第二访问报文信息中包含与所述第一访问报文无关的行为信息,则根据所述非法外联检测服务器定位违规非法外联内网终端。所述内网终端的终端信息至少包括操作系统主机名和MAC地址中的一种或两种。所述数据包嵌入所述JavaScript脚本程序的IP地址及通信机制所述非法外联检测服务器连接外部公网，所述外部公网部署取证平台，当接收所述数据包并确认存在非法外联情况时，进行取证留存非法外联证据。在违规外联检测服务器中设置内网IP网段范围进行非法外联扫描探测，当内网终端同时连接内网、连接互联网。非法外联检测服务器将内嵌外部公网取证平台IP及探测数据包则通过内网终端的路由转发服务进行数据转发，此时，外部公网服务器收到来自内网非法外联检测服务器发出的探测数据包,记录该非法外联终端的IP等信息，并对内网非法外联服务器进行回应，内网非法外联检查服务器告警，外部取证平台留存证据。该技术优点在于非客户端模式、主动检查机制。无需受制于终端对客户端的依赖性，降低被动检查带来的时效性掌握了主动权，具备时效性。实施例2本实施例公开了实施例1的基于非客户端模式被动检查离线非法外联方法外，本实施例还公开所述非法外联检测服务器向所述被检测内网终端发送探测数据包，并在所述认证设备收到所述非法外联检测服务器发出的探测数据包后，记录并对其响应。所述数据包嵌入所述JavaScript脚本程序的IP地址及通信机制。所述非法外联检测服务器连接外部公网，所述外部公网部署取证平台，当接收所述数据包并确认存在非法外联情况时，进行取证留存非法外联证据。本发明与以往的的外联检测手段相比，能在未安装客户端代理软件的前提下，检测终端离开内网后的非法外联行为进行细致的监测。更好的无感知的将终端离开内网之后的非法外联进行监测，有效的避免了跳板攻击，信息泄露等网络安全事件的发生。在非法外联检测服务器中设置内网IP网段范围进行非法外联扫描探测，当内网终端同时连接内网、连接互联网。非法外联检测服务器将内嵌外部公网取证平台IP及探测数据包则通过内网终端的路由转发服务进行数据转发，此时，外部公网服务器收到来自内网非法外联检测服务器发出的探测数据包,记录该非法外联终端的IP等信息，并对内网非法外联服务器进行回应，内网非法外联检查服务器告警，外部取证平台留存证据。该技术优点在于非客户端模式、主动检查机制。无需受制于终端对客户端的依赖性，降低被动检查带来的时效性掌握了主动权，具备时效性。应该理解的是，虽然如上所述的各实施例所涉及的流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。而且，如上所述的各实施例所涉及的流程图中的至少一部分步骤可以包括多个步骤或者多个阶段，这些步骤或者阶段并不必然是在同一时刻执行完成，而是可以在不同的时刻执行，这些步骤或者阶段的执行顺序也不必然是依次进行，而是可以与其它步骤或者其它步骤中的步骤或者阶段的至少一部分轮流或者交替地执行。基于同样的发明构思，本申请实施例还提供了一种用于实现上述所涉及的一种基于非客户端模式被动检查离线非法外联方法的一种基于非客户端模式被动检查离线非法外联装置。该装置所提供的解决问题的实现方案与上述方法中所记载的实现方案相似，故下面所提供的一个或多个一种基于非客户端模式被动检查离线非法外联装置实施例中的具体限定可以参见上文中对于一种基于非客户端模式被动检查离线非法外联方法的限定，在此不再赘述。在一个实施例中，如图4所示，提供了一种基于非客户端模式被动检查离线非法外联装置，其特征在于，所述装置包括：获取模块410，用于获取通过认证操作连接到互联网而生成第一访问报文，以及，获取连接至目标内网而生成第二访问报文；所述第一访问报文为内网终端通过访问外网地址生成的报文；所述第二访问报文为所述内网终端通过访问内网地址生成的报文；比对模块420，用于在检测到所述内网终端访问目标浏览器时，将目标脚本程序加载至本地；所述目标脚本程序用于读取所述目标浏览器Cookie以模拟比对所述第一访问报文和所述第二访问报文；检测模块430，用于若所述第二访问报文中包含有与所述第一访问报文无关的行为信息，且成功解析所述外网地址至非法外联服务器，则将所述外网地址的访问痕迹和所述内网地址的访问痕迹上报至非法外联检测服务器，并生成非法外联标识；所述非法外联检测服务器用于定位所述内网终端存在非法外联行为；所述非法外联标识用于供认证设备执行非法外联告警操作。在一个实施例中，所述装置还包括：分析模块，用于打开所述外网地址并向预设的DNS策略进行请求解析，通过分析判定是否解析所述外网地址到非法外联服务器；允许模块，用于若解析不到所述外网地址，则判断当前连接为合法外联，允许所述内网终端执行正常访问操作。在一个实施例中，所述预设的DNS策略识别所述内网终端的信息包括：所述内网终端访问数据库服务器信息、所述内网终端打印任务信息、所述内网终端上传下载记录信息、所述内网终端DNS解析记录信息、所述内网终端VPN服务器使用信息以及所述内网终端的网页浏览记录信息中的至少一种。在一个实施例中，所述非法外联检测服务器，还用于生成非法外联日志，所述非法外联日志用于记录存在非法外联行为的内网终端。在一个实施例中，所述非法外联检测服务器，还用所述非法外联检测服务器将禁止访问内网资源的事件返回给存在非法外联行为的内网终端，以提示用户所述内网终端存在非法外联的行为，并且立即终止非法外联的行为。在一个实施例中，所述非法外联检测服务器，还用于禁止存在非法外联行为的内网终端服务内网资源。上述一种基于非客户端模式被动检查离线非法外联装置中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。在一个实施例中，提供了一种计算机设备，该计算机设备可以是终端，其内部结构图可以如图5所示。该计算机设备包括通过系统总线连接的处理器、存储器、通信接口、显示屏和输入装置。其中，该计算机设备的处理器用于提供计算和控制能力。该计算机设备的存储器包括非易失性存储介质、内存储器。该非易失性存储介质存储有操作系统和计算机程序。该内存储器为非易失性存储介质中的操作系统和计算机程序的运行提供环境。该计算机设备的通信接口用于与外部的终端进行有线或无线方式的通信，无线方式可通过WIFI、移动蜂窝网络、NFC或其他技术实现。该计算机程序被处理器执行时以实现一种基于非客户端模式被动检查离线非法外联方法。该计算机设备的显示屏可以是液晶显示屏或者电子墨水显示屏，该计算机设备的输入装置可以是显示屏上覆盖的触摸层，也可以是计算机设备外壳上设置的按键、轨迹球或触控板，还可以是外接的键盘、触控板或鼠标等。本领域技术人员可以理解，图5中示出的结构，仅仅是与本申请方案相关的部分结构的框图，并不构成对本申请方案所应用于其上的计算机设备的限定，具体的计算机设备可以包括比图中所示更多或更少的部件，或者组合某些部件，或者具有不同的部件布置。在一个实施例中，提供了一种计算机设备，包括存储器和处理器，存储器存储有计算机程序，计算机程序被处理器执行时，使得处理器执行上述一种基于非客户端模式被动检查离线非法外联方法的步骤。此处一种基于非客户端模式被动检查离线非法外联方法的步骤可以是上述各个实施例的一种基于非客户端模式被动检查离线非法外联方法中的步骤。在一个实施例中，提供了一种计算机可读存储介质，存储有计算机程序，计算机程序被处理器执行时，使得处理器执行上述一种基于非客户端模式被动检查离线非法外联方法的步骤。此处一种基于非客户端模式被动检查离线非法外联方法的步骤可以是上述各个实施例的一种基于非客户端模式被动检查离线非法外联方法中的步骤。在一个实施例中，提供了一种计算机程序产品，包括计算机程序，该计算机程序被处理器执行时，使得处理器执行上述一种基于非客户端模式被动检查离线非法外联方法的步骤。此处一种基于非客户端模式被动检查离线非法外联方法的步骤可以是上述各个实施例的一种基于非客户端模式被动检查离线非法外联方法中的步骤。需要说明的是，本申请所涉及的用户信息和数据，均为经用户授权或者经过各方充分授权的信息和数据。本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一非易失性计算机可读取存储介质中，该计算机程序在执行时，可包括如上述各方法的实施例的流程。其中，本申请所提供的各实施例中所使用的对存储器、数据库或其它介质的任何引用，均可包括非易失性和易失性存储器中的至少一种。非易失性存储器可包括只读存储器、磁带、软盘、闪存、光存储器、高密度嵌入式非易失性存储器、阻变存储器、磁变存储器、铁电存储器、相变存储器、石墨烯存储器等。易失性存储器可包括随机存取存储器或外部高速缓冲存储器等。作为说明而非局限，RAM可以是多种形式，比如静态随机存取存储器或动态随机存取存储器等。本申请所提供的各实施例中所涉及的数据库可包括关系型数据库和非关系型数据库中至少一种。非关系型数据库可包括基于区块链的分布式数据库等，不限于此。本申请所提供的各实施例中所涉及的处理器可为通用处理器、中央处理器、图形处理器、数字信号处理器、可编程逻辑器、基于量子计算的数据处理逻辑器等，不限于此。以上实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对本申请专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本申请构思的前提下，还可以做出若干变形和改进，这些都属于本申请的保护范围。因此，本申请的保护范围应以所附权利要求为准。
