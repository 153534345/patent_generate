标题title
一种基于IP的电路分组时隙突发产生与解析装置
摘要abst
本发明公开了一种基于IP的电路分组时隙突发产生与解析装置，涉及卫星通信领域。本发明由接口处理单元、电路分组模拟业务处理单元、时隙突发定时生成单元、模拟业务组帧单元、时隙突发发送单元、时隙突发配置单元组成。本装置可通过接收到的IP数据包分别产生模拟电路业务数据流和模拟分组业务数据帧，根据队列缓存状态、时隙长度、时隙类型、时隙数量等标识对模拟电路业务数据流和模拟分组业务数据帧进行切割、排队、缓存处理，并将切割后的模拟电路业务数据流和模拟分组业务数据帧分别插入到电路分组混合时隙突发中。本发明操作简单、集成化程度高，支持任意比例的电路分组业务时隙模拟需求，适用于星载交换设备的测试需要。
权利要求书clms
1.一种基于IP的电路分组时隙突发产生与解析装置，包括接口处理单元、时隙突发定时生成单元、模拟业务组帧单元、时隙突发发送单元、时隙突发配置单元，其特征在于：还包括电路分组模拟业务处理单元；接口处理单元接收到外部输入的IP数据包，根据目的MAC地址和类型字段对所有IP数据包进行数据区分处理，将非本接口目的MAC地址或者类型字段错误的IP数据包丢弃，并将正确的IP数据包发送至电路分组模拟业务处理单元；电路分组模拟业务处理单元将IP数据包根据源MAC地址进行分类处理，对于属于模拟电路业务的IP数据包，将其进行队列管理、队列缓存、数据切割操作后产生模拟电路业务数据流，当时隙突发定时生成单元产生的空的电路分组时隙突发到来时将模拟电路业务数据流发送至模拟业务组帧单元；对于属于模拟分组业务的IP数据包,首先根据时隙突发配置单元配置的映射表进行协议转换，将IP数据包的MAC头部替换成卫星专用链路头部,产生模拟分组业务数据帧，然后再将模拟分组业务数据帧进行队列管理、队列缓存、数据切割操作，当时隙突发定时生成单元产生的空的电路分组时隙突发到来时将模拟分组业务数据帧发送至模拟业务组帧单元；时隙突发定时生成单元根据时钟要求，定时产生空的电路分组时隙突发，并定时发送给模拟业务组帧单元；模拟业务组帧单元根据时隙突发配置单元的时隙分配规则，从电路分组模拟业务处理单元的队列缓存中分别取出模拟电路业务数据流和模拟分组业务数据帧并插入到各个电路分组时隙突发的时隙中，生成填充业务的电路分组时隙突发，并发送至时隙突发发送单元；时隙突发发送单元将电路分组时隙突发填充好校验、帧序号、模式字信息，然后通过卫星专用接口发送出去；时隙突发配置单元完成电路分组模拟业务处理单元和模拟业务组帧单元的配置管理。2.根据权利要求1所述的一种基于IP的电路分组时隙突发产生与解析装置，其特征在于：所述的电路分组模拟业务处理单元由接口选择单元、电路模拟业务队列处理单元、分组模拟业务协议转换单元、分组模拟业务队列处理单元、队列共享单元、电路分组模拟业务切割单元组成；接口选择单元接收到接口处理单元的IP数据包后根据源MAC地址中的高4字节进行分类处理，如果是模拟电路业务的IP数据包，则直接将该IP数据包发送至电路模拟业务队列处理单元，如果是模拟分组业务的IP数据包，则直接将该IP数据包发送至分组模拟业务协议转换单元；电路模拟业务队列处理单元判断IP数据包源MAC地址的低2字节，如果范围有效，则将该IP数据包直接发送至队列缓存单元相应的电路业务缓存位置以生成模拟电路业务数据流，该缓存位置的存储编号与IP数据包源MAC地址的低2字节相同；如果范围无效，则直接丢弃；分组模拟业务协议转换单元接收到IP数据包后根据源MAC地址字段查找时隙突发配置单元配置的映射表，识别查找到的相应转换规则，将IP数据包中的MAC头部字段替换成卫星专用链路头部生成模拟分组业务数据帧，并将模拟分组业务数据帧发送至分组模拟业务队列处理单元；分组模拟业务队列处理单元判断模拟分组业务数据帧帧头中的源站地址字段，并根据源站地址字段信息将该模拟分组业务数据帧发送至队列缓存单元相应的分组缓存位置，该缓存位置的存储编号与源站地址字段相同；队列缓存单元将接收到的来自于电路模拟业务队列处理单元的模拟电路业务数据流和来自于分组模拟业务队列处理单元的模拟分组业务数据帧进行数据缓存、队列管理；电路分组模拟业务切割单元根据时隙突发配置单元配置的时隙长度、时隙类型、时隙位置、时隙数量信息，将接收队列缓存单元中的模拟电路业务数据流和模拟分组业务数据帧分别进行切割，并发送至电路分组模拟业务组帧单元进行组帧。3.根据权利要求1所述的一种基于IP的电路分组时隙突发产生与解析装置，其特征在于：所述的接口处理单元、电路分组模拟业务处理单元、模拟业务组帧单元、时隙突发发送单元和时隙突发配置单元，具备以上过程的逆过程的处理功能，即具备将接收到的电路分组时隙突发转换成IP数据包的功能。
说明书desc
技术领域本发明涉及一种基于IP的电路分组时隙突发产生与解析装置，属于卫星通信领域。背景技术近年来，随着用户对卫星通信各类服务需求的不断提高，基于电路业务和分组业务融合处理的卫星通信网络已经成为目前星上处理卫星通信领域的研究热点之一，而星载交换设备作为卫星系统电路分组业务交换核心，可靠性要求极高，一旦星载交换设备出现异常，可能会造成整星功能丧失，造成不可估量的损失。因此，对于星载交换设备上星前的测试尤为重要，需要研制专用的测试设备来进行功能性能验证，但是目前暂无可同时支持任意比例的电路分组混合模拟业务接入的专用测试设备。发明内容本发明的目的在于解决上述背景技术中的问题而提供一种基于IP的电路分组时隙突发产生与解析装置。本发明采用单个通道同时支持任意比例的电路模拟业务流和分组模拟业务帧混合接入，可同时提供星载交换设备多个端口的测试验证。本发明具有操作简单、集成化程度高、性能稳定可靠、可扩展性强等特点，特别适用于星载交换设备的测试需要。本发明的目的是这样实现的：一种基于IP的电路分组时隙突发产生与解析装置，包括接口处理单元1、电路分组模拟业务处理单元2、时隙突发定期生成单元3、模拟业务组帧单元4、时隙突发发送单元5、时隙突发配置单元6；接口处理单元1接收到外部输入的IP数据包，根据目的MAC地址和类型字段对所有IP数据包进行数据区分处理，将非本接口目的MAC地址或者类型字段错误的IP数据包丢弃，并将正确的IP数据包发送至电路分组模拟业务处理单元2；电路分组模拟业务处理单元2将IP数据包根据源MAC地址进行分类处理，对于属于模拟电路业务的IP数据包，将其进行队列管理、队列缓存、数据切割等操作后产生模拟电路业务数据流，当时隙突发定时生成单元3产生的空的电路分组时隙突发到来时将模拟电路业务数据流发送至模拟业务组帧单元4；对于属于模拟分组业务的IP数据包，首先根据时隙突发配置单元6配置的映射表进行协议转换，将IP数据包的MAC头部替换成卫星专用链路头部产生模拟分组业务数据帧，然后再将模拟分组业务数据帧进行队列管理、队列缓存、数据切割等操作，当时隙突发定时生成单元3产生的空的电路分组时隙突发到来时将模拟分组业务数据帧发送至模拟业务组帧单元4；时隙突发定时生成单元3根据时钟要求，定时产生空的电路分组时隙突发，并定时发送给模拟业务组帧单元4；模拟业务组帧单元4根据时隙突发配置单元6的时隙分配规则，从电路分组模拟业务处理单元2的队列缓存中分别取出模拟电路业务数据流和模拟分组业务数据帧插入到各个电路分组时隙突发的时隙中，生成填充业务的电路分组时隙突发，并发送至时隙突发发送单元5；时隙突发发送单元5将电路分组时隙突发填充好校验、帧序号、模式字等信息后，通过卫星专用接口发送出去；时隙突发配置单元6主要完成电路分组模拟业务处理单元2和模拟业务组帧单元4的配置管理。进一步的，电路分组模拟业务处理单元2由接口选择单元2-1、电路模拟业务队列处理单元2-2、分组模拟业务协议转换单元2-3、分组模拟业务队列处理单元2-4、队列共享单元2-5、电路分组模拟业务切割单元2-6组成；接口选择单元2-1接收到接口处理单元1的IP数据包后根据源MAC地址中的高4字节进行分类处理，如果是模拟电路业务的IP数据包，则直接将该IP数据包发送至电路模拟业务队列处理单元2-2，如果是模拟分组业务的IP数据包，则直接将该IP数据包发送至分组模拟业务协议转换单元2-3；电路模拟业务队列处理单元2-2判断IP数据包源MAC地址的低2字节，如果范围有效，则将该IP数据包直接发送至队列缓存单元2-5相应的电路业务缓存位置生成模拟电路业务数据流，该缓存位置的存储编号与IP数据包源MAC地址的低2字节相同；如果范围无效，则直接丢弃；分组模拟业务协议转换单元2-3接收到IP数据包后根据源MAC地址字段查找时隙突发配置单元6配置的映射表，识别查找到的相应转换规则，将IP数据包中的MAC头部字段替换成卫星专用链路头部生成模拟分组业务数据帧，并将模拟分组业务数据帧发送至分组模拟业务队列处理单元2-4；分组模拟业务队列处理单元2-4判断模拟分组业务数据帧帧头中的源站地址字段，并根据源站地址字段信息将该模拟分组业务数据帧发送至队列缓存单元2-5相应的分组缓存位置，该缓存位置的存储编号与源站地址字段相同；队列缓存单元2-5负责将接收来自于电路模拟业务队列处理单元2-2的模拟电路业务数据流和来自于分组模拟业务队列处理单元2-4的模拟分组业务数据帧进行数据缓存、队列管理；电路分组模拟业务切割单元2-6根据时隙突发配置单元6配置的时隙长度、时隙类型、时隙位置、时隙数量等信息，将接收队列缓存单元2-5中模拟电路业务数据流和模拟分组业务数据帧分别进行切割，并发送至电路分组模拟业务组帧单元3进行组帧。进一步的，接口处理单元1、电路分组模拟业务处理单元2、模拟业务组帧单元4、时隙突发发送单元5和时隙突发配置单元6，具备以上过程的逆过程的处理功能，即具备将接收到的电路分组时隙突发转换成IP数据包的功能。本发明相比背景技术具有如下优点：1.本发明可支持任意比例的电路分组混合模拟业务接入至电路分组时隙突发中，且支持电路分组时隙突发的产生与解析。2.本发明支持测试端口可扩展，可支持星载交换设备多个端口的测试要求。3.本发明模拟电路分组业务灵活可调，占用资源少，可靠性高。附图说明图1是本发明实施例中基于IP的电路分组时隙突发产生与解析装置的电原理图。图2是图1中电路分组模拟业务处理单元的电原理图。具体实施方式下面结合附图和具体实施例对本发明做进一步的说明。参照图1，一种基于IP的电路分组时隙突发产生与解析装置，包括接口处理单元1、电路分组模拟业务处理单元2、时隙突发定时生成单元3、模拟业务组帧单元4、时隙突发发送单元5、时隙突发配置单元6。图1是该装置的电原理图，实施例按照图1连接线路。其中，接口处理单元1的作用是检查外部输入的IP数据包的目的MAC地址和类型，如果目的MAC地址非法或类型错误，则丢弃，防止输入错误数据包，对后面的处理单元产生影响；电路分组模拟业务处理单元2的作用是将IP数据包进行分类处理，对于模拟电路业务的IP数据包进行队列管理、队列缓存、数据切割等操作后生成模拟电路业务数据流，对于模拟分组业务的IP数据包，则首先根据映射表将IP数据包中的源MAC地址替换成卫星专用链路头部，产生模拟分组业务数据帧，然后再对产生的模拟分组业务数据帧进行队列管理、队列缓存、数据切割等操作；时隙突发定时生成单元3的作用是定时产生空的电路分组时隙突发；模拟业务组帧单元4的作用是根据时隙突发配置单元6的时隙分配规则，从电路分组模拟业务处理单元2的队列缓存中分别取出模拟电路业务数据流和模拟分组业务数据帧插入到各个时隙中，生成填充业务的电路分组时隙突发；时隙突发发送单元5的作用是填充电路分组时隙突发的校验、帧序号、模式字等信息后，并将电路分组时隙突发通过卫星专用接口发送出去；时隙突发配置单元6的作用是负责电路分组模拟业务处理单元2和模拟业务组帧单元4的配置功能。电路分组模拟业务处理单元2由接口选择单元2-1、电路模拟业务队列处理单元2-2、分组模拟业务协议转换单元2-3、分组模拟业务队列处理单元2-4、队列共享单元2-5、电路分组模拟业务切割单元2-6组成；实施例按照图2连接线路。接口选择单元2-1的作用是将接收的IP数据包进行分类处理，分别将IP数据包发送至电路模拟业务队列处理单元2-2和分组模拟业务协议转换单元2-3；电路模拟业务队列处理单元2-2的作用是将IP数据包根据源MAC地址的后2个字节标识进行队列缓存；分组模拟业务协议转换单元2-3的作用是根据时隙突发配置单元6配置的映射表，将标准的IP数据包转换成模拟分组业务数据帧；分组模拟业务队列处理单元2-4的作用是将IP数据包根据源MAC地址的后2个字节标识进行队列缓存；队列缓存单元2-5的作用是将接收来自于电路模拟业务队列处理单元2-2的模拟电路业务数据流和来自于分组模拟业务队列处理单元2-4的模拟分组业务数据帧根据相应的缓存规则进行缓存；电路分组模拟业务切割单元2-6的作用是根据时隙突发配置单元6配置的时隙长度、时隙类型、时隙位置、时隙数量等信息，将接收队列共享缓存单元2-5中模拟电路业务数据流和模拟分组业务数据帧分别进行切割、缓存，并发送出去。实施例中的各功能单元均可在一片Xilinx原厂生产的FPGA系列产品K7-325T型号上实现。本装置可使用1片K7-325T型FPGA实现4路IP数据包的输入和4路电路分组时隙突发的输出，以及4路电路分组时隙突发的输入和4路IP数据包的输出。若要求的输入输出接口较多时可进行调整，使用多片K7-325T型FPGA芯片。本装置的简要工作原理如下：接口处理单元1对接收到的IP数据包进行类型和地址判断，丢弃非本接口的数据包；电路分组模拟业务处理单元2根据相应规则IP数据包区分为模拟电路业务的IP数据包和模拟分组业务的IP数据包，模拟电路业务的IP数据包直接进行队列管理、队列缓存、数据切割等操作产生模拟电路业务数据流，模拟电路业务的IP数据包则首先进行协议转换，然后再进行模拟分组业务数据帧的队列管理、队列缓存、数据切割等操作；时隙突发定时生成单元3定时产生空的电路分组时隙突发帧；模拟业务组帧单元4则根据配置规则分别队列缓存中取出模拟电路业务数据流和模拟分组业务数据帧插入到电路分组时隙突发中；时隙突发发送单元5填充时隙帧的校验、帧序号、模式字等信息，并将信息发送出去；时隙突发配置单元6负责电路分组业务时隙接入和协议转换配置功能。总之，本发明可通过接收到的IP数据包分别产生模拟电路业务数据流和模拟分组业务数据帧，根据队列缓存状态、时隙长度、时隙类型、时隙数量等标识对模拟电路业务数据流和模拟分组业务数据帧进行切割、排队、缓存处理，并将切割后的模拟电路业务数据流和模拟分组业务数据帧分别插入到电路分组混合时隙突发中，然后发送至星载交换设备。同时，星载交换设备返回的电路分组时隙突发到IP数据包的转换过程为以上过程的逆过程。本发明具有操作简单、集成化程度高、性能稳定可靠、可扩展性强等特点，支持任意比例的电路分组业务时隙模拟需求，特别适用于星载交换设备的测试需要。
