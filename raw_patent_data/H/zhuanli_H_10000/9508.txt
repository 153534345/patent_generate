标题title
基于区块链跨链的安全可验证服务提供方法及系统
摘要abst
本发明提供基于区块链跨链的安全可验证服务提供方法及系统，属于网络通信技术领域，获取服务提供者和服务请求者的注册请求，验证成功后分别为其颁发数字证书，接收服务提供者服务数据密文；获取服务请求者的服务请求，验证通过后调用匹配合约进行服务匹配；对服务请求者的公钥进行密钥转换得到重加密密钥，利用重加密密钥对服务数据进行重加密；将重加密后的服务数据密文发布在代理链上，服务请求者解密获取服务数据明文，结合验证合约进行数据一致性验证。本发明采用代理重加密，并使用智能合约来对请求和服务进行匹配，通过智能合约和哈希函数保证了数据一致性和安全性；可扩展到多个应用链的互联互通，请求和服务可双向进行。
权利要求书clms
1.一种基于区块链跨链的安全可验证服务提供方法，其特征在于，包括：步骤S1：区块链认证中心获取代理节点的注册请求，验证成功后分别为其颁发数字证书，服务提供者加密服务数据，密文经由第一代理节点被转发至第一区块链认证中心并发布于代理链上；步骤S2：服务请求者调用请求合约发布服务请求，该请求经由第二代理节点被转发至第二区块链认证中心，第二区块链认证中心验证通过后调用匹配合约进行服务匹配；步骤S3：匹配成功后，服务提供者通过自身公钥和服务提供者的私钥进行密钥转换得到重加密密钥，第一区块链认证中心利用该重加密密钥对服务数据进行重加密；步骤S4：第一区块链认证中心将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。2.根据权利要求1所述的基于区块链跨链的安全可验证服务提供方法，其特征在于，所述步骤S1包括：代理链进行初始化，要求第一区块链认证中心和第二区块链认证中心各自控制一Peer节点并加入同一通道以进行数据共享，共识节点可按照创世区块中配置的策略加入或退出集群；代理节点向区块链认证中心发送注册请求，区块链认证中心验证其是否合法，并验证随机数和签名的有效性，若验证通过则视为注册成功，为其生成数字证书，并将数字证书哈希值写入区块链，区块链认证中心将哈希值返回给代理节点。服务提供者用自身公钥加密服务数据明文并调用第一区块链上发布合约发布，第一代理节点从账本获取到后发送给第一区块链认证中心，第一区块链认证中心验证通过后调用代理链上发布合约发布，存储在代理链上的服务列表中。3.根据权利要求1所述的基于区块链跨链的安全可验证服务提供方法，其特征在于，所述步骤S2包括：服务请求者调用第二区块链上的服务请求合约发布服务请求，第二代理节点从账本获取到后发送给第二区块链验证中心，第二区块链验证中心验证通过后调用代理链上匹配合约；其中，先根据服务请求数据判断该用户是否频繁发起请求，若超过设定阈值则调用惩罚合约对服务请求者进行惩罚；若未超过阈值则根据Sid的布隆过滤器存储表快速查找符合服务请求Sid的服务项；然后在Sid匹配成功的服务项里依次验证catg是否符合policy要求，若符合要求，则将所匹配成功的服务项发布在代理链上；若匹配失败，则返回提示信息并通过第二区块链认证中心和第二代理节点通知到服务请求者。4.根据权利要求1所述的基于区块链跨链的安全可验证服务提供方法，其特征在于，所述步骤S3包括：如果请求者属性满足服务策略，说明该请求者为合法用户，第一区块链认证中心用服务提供者的公钥加密服务请求者的公钥并发送给第一代理节点，第一代理节点将其发布到第一区块链上，服务提供者从账本获取到并用自身私钥解密，然后进行密钥转换，将重加密密钥通过第一代理节点发送给第一区块链认证中心；第一区块链认证中心用重加密密钥对服务提供者的C1＝Enc进行代理重加密后得到C3＝Enc,m)，然后将C3发布到代理链上；PKp表示服务提供者的公钥，m表示服务提供者提供的服务指令。5.根据权利要求1所述的基于区块链跨链的安全可验证服务提供方法，其特征在于，所述步骤S4包括：第二区块链认证中心从账本获取到C3后将其发送给第二代理节点，第二代理节点将C3发布到第二区块链上，服务请求者从账本获取到后用自身私钥解密获取服务数据明文，记为m'＝Dec，然后经哈希函数处理得到处理后的哈希值。服务请求者发送处理后的哈希值调用请求合约发起验证请求，该请求通过第二代理节点发送给第二区块链认证中心，第二区块链认证中心调用验证合约检查服务指令的Keccak256哈希函数处理结果是否等于处理后的哈希值，如果不相等则调用惩罚合约对服务提供者进行惩罚，并将验证及惩罚结果通知服务请求者和服务提供者。6.根据权利要求5所述的基于区块链跨链的安全可验证服务提供方法，其特征在于，服务请求者发送处理后的哈希值调用请求合约发起验证请求，该请求通过第二代理节点发送给第二区块链认证中心，第二区块链认证中心调用验证合约检查服务指令的Keccak256哈希函数处理结果是否等于处理后的哈希值，如果不相等则调用惩罚合约对服务提供者进行惩罚，并将验证及惩罚结果通知服务请求者和服务提供者。7.一种基于如权利要求1-6任一项所述的方法的基于区块链跨链的安全可验证服务提供系统，其特征在于，包括：初始化模块，用于获取服务提供者和服务请求者的注册请求，验证成功后分别为其颁发数字证书，接收服务提供者服务数据密文；匹配模块，用于获取服务请求者的服务请求，验证通过后调用匹配合约进行服务匹配；重加密模块，用于匹配成功后，通过服务提供者的私钥和服务请求者的公钥进行密钥转换得到重加密密钥，利用重加密密钥对服务数据进行重加密；解密模块，用于将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。8.一种计算机可读存储介质，其存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现如如权利要求1-6任一项所述的基于区块链跨链的安全可验证服务提供方法。9.一种计算机设备，其特征在于，包括存储器和处理器，所述处理器和所述存储器相互通信，所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令执行如权利要求1-6任一项所述的基于区块链跨链的安全可验证服务提供方法。10.一种电子设备，其特征在于，包括存储器和处理器，所述处理器和所述存储器相互通信，所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令执行如权利要求1-6任一项所述的基于区块链跨链的安全可验证服务提供方法。
说明书desc
技术领域本发明涉及网络通信技术领域，具体涉及一种基于区块链跨链的安全可验证服务提供方法及系统。背景技术随着信息技术的快速发展，物联网的智能化水平和部署规模也不断增长。近年来，区块链技术被广泛用于各行各业并取得了巨大的经济和社会效益，然而在目前的物联网服务场景下，由于物联网的底层异构性，不同信任域之间存在认证模式不同和地理分布上的差异性等，从而造成了数据隔离，不同物联网信任域如同一座座“信息孤岛”难以交互，然而单个信任域内的资源往往已经不能满足用户的需求，复杂的任务需要多个实体跨域协作及物联网服务互操作，此时就需要一种物联网跨域交互方法，以沟通处于不同信任域的服务提供者和服务请求者，实现物联网服务跨域提供。目前的解决方案通常是为每个物联网信任域独立部署区块链或者在整个物联网应用系统层次结构中部署区块链，而各种区块链的体系结构和数据格式等不尽相同，难以互联互通。区块链跨链技术指的是在不同区块链系统之间实现数据资产互联互通的技术。每条区块链可对应于物联网场景下的每个信任域，跨链技术为物联网数据跨域传递提供了可行的解决方案。物联网在给用户提供方便的同时，也带来了一些安全风险，如攻击范围广、安全边界模糊、节点可控性差等。此外，由于物联网数据的海量、高实时性和物联网设备的无人值守、移动性等特性，物联网服务比传统的信息系统更容易受到攻击。现有的一种基于区块链的轻量级客户端的安全服务提供方法，还提出了一种基于声誉的激励机制，但其方法是基于单区块链的，未解决“数据孤岛”问题，且服务指令采取链下提供，未保证其安全性。针对多个服务提供者提供服务的情形，一种跨联盟链和公链的方法，将处于联盟链的服务提供者和处于公链的终端用户连接起来进行服务提供，但其跨链方式是链对链的，如果要实现多个应用链的互通，系统复杂度会急剧增加，且仅能由公链发起请求、联盟链响应请求单向提供服务，且未进行服务匹配。发明内容本发明的目的在于提供一种利用跨链技术来沟通不同的信任域实现物联网跨域数据交互，采用代理重加密等技术保护服务数据的安全性，采用比较哈希值验证数据一致性以保证系统的可用性，并加入了惩罚机制对服务请求者和服务提供者进行双向约束的基于区块链跨链的安全可验证服务提供方法及系统，以解决上述背景技术中存在的至少一项技术问题。为了实现上述目的，本发明采取了如下技术方案：一方面，本发明提供一种基于区块链跨链的安全可验证服务提供方法，包括：步骤S1：区块链认证中心获取代理节点的注册请求，验证成功后分别为其颁发数字证书，服务提供者加密服务数据，密文经由第一代理节点被转发至第一区块链认证中心并发布于代理链上；步骤S2：服务请求者调用请求合约发布服务请求，该请求经由第二代理节点被转发至第二区块链认证中心，第二区块链认证中心验证通过后调用匹配合约进行服务匹配；步骤S3：匹配成功后，服务提供者通过自身公钥和服务提供者的私钥进行密钥转换得到重加密密钥，第一区块链认证中心利用该重加密密钥对服务数据进行重加密；步骤S4：第一区块链认证中心将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。可选的，所述步骤S1包括：代理链进行初始化，要求第一区块链认证中心和第二区块链认证中心各自控制一Peer节点并加入同一通道以进行数据共享，共识节点可按照创世区块中配置的策略加入或退出集群；代理节点向区块链认证中心发送注册请求，区块链认证中心验证其是否合法，并验证随机数和签名的有效性，若验证通过则视为注册成功，为其生成数字证书，并将数字证书哈希值写入区块链，区块链认证中心将哈希值返回给代理节点。服务提供者用自身公钥加密服务数据明文并调用第一区块链上发布合约发布，第一代理节点从账本获取到后发送给第一区块链认证中心，第一区块链认证中心验证通过后调用代理链上发布合约发布，存储在代理链上的服务列表中。可选的，所述步骤S2包括：服务请求者调用第二区块链上的服务请求合约发布服务请求，第二代理节点从账本获取到后发送给第二区块链验证中心，第二区块链验证中心验证通过后调用代理链上匹配合约；其中，先根据服务请求数据判断该用户是否频繁发起请求，若超过设定阈值则调用惩罚合约对服务请求者进行惩罚；若未超过阈值则根据Sid的布隆过滤器存储表快速查找符合服务请求Sid的服务项；然后在Sid匹配成功的服务项里依次验证catg是否符合policy要求，若符合要求，则将所匹配成功的服务项发布在代理链上；若匹配失败，则返回提示信息并通过第二区块链认证中心和第二代理节点通知到服务请求者。可选的，所述步骤S3包括：如果请求者属性满足服务策略，说明该请求者为合法用户，第一区块链认证中心用服务提供者的公钥加密服务请求者的公钥并发送给第一代理节点，第一代理节点将其发布到第一区块链上，服务提供者从账本获取到并用自身私钥解密，然后进行密钥转换，将重加密密钥通过第一代理节点发送给第一区块链认证中心；第一区块链认证中心用重加密密钥对服务提供者的C1＝Enc进行代理重加密后得到C3＝Enc,m)，然后将C3发布到代理链上；PKp表示服务提供者的公钥，m表示服务提供者提供的服务指令。可选的，所述步骤S4包括：第二区块链认证中心从账本获取到C3后将其发送给第二代理节点，第二代理节点将C3发布到第二区块链上，服务请求者从账本获取到后用自身私钥解密获取服务数据明文，记为m'＝Dec，然后经哈希函数处理得到处理后的哈希值。可选的，服务请求者发送处理后的哈希值调用请求合约发起验证请求，该请求通过第二代理节点发送给第二区块链认证中心，第二区块链认证中心调用验证合约检查服务指令的Keccak256哈希函数处理结果是否等于处理后的哈希值，如果不相等则调用惩罚合约对服务提供者进行惩罚，并将验证及惩罚结果通知服务请求者和服务提供者。第二方面，本发明提供一种基于区块链跨链的安全可验证服务提供系统，包括：初始化模块，用于获取服务提供者和服务请求者的注册请求，验证成功后分别为其颁发数字证书，接收服务提供者服务数据密文；匹配模块，用于获取服务请求者的服务请求，验证通过后调用匹配合约进行服务匹配；重加密模块，用于匹配成功后，通过服务提供者的私钥和服务请求者的公钥进行密钥转换得到重加密密钥，利用重加密密钥对服务数据进行重加密；解密模块，用于将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。第三方面，本发明提供一种计算机设备，包括存储器和处理器，所述处理器和所述存储器相互通信，所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令执行如上所述的基于区块链跨链的安全可验证服务提供方法。第四方面，本发明提供一种电子设备，包括存储器和处理器，所述处理器和所述存储器相互通信，所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令执行如上所述的基于区块链跨链的安全可验证服务提供方法。第五方面，本发明提供一种计算机可读存储介质，其存储有计算机程序，所述计算机程序被处理器执行时实现如上所述的基于区块链跨链的安全可验证服务提供方法。本发明有益效果：采用代理重加密对服务数据进行加密保护，并使用智能合约来对请求和服务进行匹配，通过智能合约和哈希函数保证了数据一致性，通过代理重加密保证了数据安全性；采用中继链跨链方案，可扩展到多个应用链的互联互通，请求和服务可双向进行，并采用惩罚合约对服务请求者和服务提供者进行双向约束，为服务请求者跨域提供安全可验证的服务。本发明附加的方面和优点将在下面的描述中部分给出，这些将从下面的描述中变得明显，或通过本发明的实践了解到。附图说明为了更清楚地说明本发明实施例的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1为本发明实施例所述的基于区块链跨链的安全可验证服务提供系统功能原理框图。图2为本发明实施例所述的系统初始化阶段方法流程图。图3为本发明实施例所述的服务请求及匹配阶段方法流程图。图4为本发明实施例所述的服务数据准备阶段流程图。图5为本发明实施例所述的服务数据获取及验证阶段流程图。图6为本发明实施例所述的基于区块链跨链的安全可验证服务提供方法整体方法流程示意图。具体实施方式下面详细叙述本发明的实施方式，所述实施方式的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过附图描述的实施方式是示例性的，仅用于解释本发明，而不能解释为对本发明的限制。本技术领域技术人员可以理解，除非另外定义，这里使用的所有术语具有与本发明所属领域中的普通技术人员的一般理解相同的意义。还应该理解的是，诸如通用字典中定义的那些术语应该被理解为具有与现有技术的上下文中的意义一致的意义，并且除非像这里一样定义，不会用理想化或过于正式的含义来解释。本技术领域技术人员可以理解，除非特意声明，这里使用的单数形式“一”、“一个”、“所述”和“该”也可包括复数形式。应该进一步理解的是，本发明的说明书中使用的措辞“包括”是指存在所述特征、整数、步骤、操作、元件和/或组件，但是并不排除存在或添加一个或多个其他特征、整数、步骤、操作、元件和/或它们的组。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。而且，描述的具体特征、结构、材料或者特点可以在任一个或多个实施例或示例中以合适的方式结合。此外，在不相互矛盾的情况下，本领域的技术人员可以将本说明书中描述的不同实施例或示例以及不同实施例或示例的特征进行结合和组合。为便于理解本发明，下面结合附图以具体实施例对本发明作进一步解释说明，且具体实施例并不构成对本发明实施例的限定。本领域技术人员应该理解，附图只是实施例的示意图，附图中的部件并不一定是实施本发明所必须的。实施例1本实施例1提供了一种基于区块链跨链的安全可验证服务提供系统，包括：初始化模块，用于获取服务提供者和服务请求者的注册请求，验证成功后分别为其颁发数字证书，接收服务提供者服务数据密文；匹配模块，用于获取服务请求者的服务请求，验证通过后调用匹配合约进行服务匹配；重加密模块，用于匹配成功后，通过服务提供者的私钥和服务请求者的公钥进行密钥转换得到重加密密钥，利用重加密密钥对服务数据进行重加密；解密模块，用于将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。本实施例1中，基于上述的系统实现了基于区块链跨链的安全可验证服务提供方法，包括：步骤S1：区块链认证中心获取代理节点的注册请求，验证成功后分别为其颁发数字证书，服务提供者加密服务数据，密文经由第一代理节点被转发至第一区块链认证中心并发布于代理链上；步骤S2：服务请求者调用请求合约发布服务请求，该请求经由第二代理节点被转发至第二区块链认证中心，第二区块链认证中心验证通过后调用匹配合约进行服务匹配；步骤S3：匹配成功后，服务提供者通过自身公钥和服务提供者的私钥进行密钥转换得到重加密密钥，第一区块链认证中心利用该重加密密钥对服务数据进行重加密；步骤S4：第一区块链认证中心将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。所述步骤S1包括：代理链进行初始化，要求第一区块链认证中心和第二区块链认证中心各自控制一Peer节点并加入同一通道以进行数据共享，共识节点可按照创世区块中配置的策略加入或退出集群；代理节点向区块链认证中心发送注册请求，区块链认证中心验证其是否合法，并验证随机数和签名的有效性，若验证通过则视为注册成功，为其生成数字证书，并将数字证书哈希值写入区块链，区块链认证中心将哈希值返回给代理节点。服务提供者用自身公钥加密服务数据明文并调用第一区块链上发布合约发布，第一代理节点从账本获取到后发送给第一区块链认证中心，第一区块链认证中心验证通过后调用代理链上发布合约发布，存储在代理链上的服务列表中。所述步骤S2包括：服务请求者调用第二区块链上的服务请求合约发布服务请求，第二代理节点从账本获取到后发送给第二区块链验证中心，第二区块链验证中心验证通过后调用代理链上匹配合约；其中，先根据服务请求数据判断该用户是否频繁发起请求，若超过设定阈值则调用惩罚合约对服务请求者进行惩罚；若未超过阈值则根据Sid的布隆过滤器存储表快速查找符合服务请求Sid的服务项；然后在Sid匹配成功的服务项里依次验证catg是否符合policy要求，若符合要求，则将所匹配成功的服务项发布在代理链上；若匹配失败，则返回提示信息并通过第二区块链认证中心和第二代理节点通知到服务请求者。所述步骤S3包括：如果请求者属性满足服务策略，说明该请求者为合法用户，第一区块链认证中心用服务提供者的公钥加密服务请求者的公钥并发送给第一代理节点，第一代理节点将其发布到第一区块链上，服务提供者从账本获取到并用自身私钥解密，然后进行密钥转换，将重加密密钥通过第一代理节点发送给第一区块链认证中心；第一区块链认证中心用重加密密钥对服务提供者的C1＝Enc进行代理重加密后得到C3＝Enc,m)，然后将C3发布到代理链上；PKp表示服务提供者的公钥，m表示服务提供者提供的服务指令。所述步骤S4包括：第二区块链认证中心从账本获取到C3后将其发送给第二代理节点，第二代理节点将C3发布到第二区块链上，服务请求者从账本获取到后用自身私钥解密获取服务数据明文，记为m'＝Dec，然后经哈希函数处理得到处理后的哈希值。服务请求者发送处理后的哈希值调用请求合约发起验证请求，该请求通过第二代理节点发送给第二区块链认证中心，第二区块链认证中心调用验证合约检查服务指令的Keccak256哈希函数处理结果是否等于处理后的哈希值，如果不相等则调用惩罚合约对服务提供者进行惩罚，并将验证及惩罚结果通知服务请求者和服务提供者。综上，本实施例1中，采用区块链跨链技术设计一种安全可验证的服务提供方法，跨链方案采用中继链模式，该方法使用中继链上的智能合约来对通过代理节点发来的请求和服务进行匹配，使用代理重加密和哈希算法来保证服务数据安全可验证。实现了四方面的功能，第一，由服务提供者跨链向服务请求者提供服务，实现跨链数据共享，解决“数据孤岛”问题；第二，服务数据以密文形式传输，保护服务数据的安全性和隐私性；第三，由智能合约通过哈希值验证服务数据是否被篡改，保证跨链数据一致性；第四，加入惩罚机制来对服务请求者和服务提供者进行约束，保证跨链服务提供方法的服务质量。实施例2本实施例2提供一种基于区块链跨链的安全可验证服务提供系统及方法，使用区块链跨链技术解决了传统物联网不同信任域间数据隔离的问题，通过代理重加密对服务数据进行安全保护，并根据服务请求者最终所获取服务数据哈希值与服务提供者提供原始哈希值验证来验证数据一致性，并加入了惩罚机制。结合图1、图6所示，本实施例提出的跨链系统及方法，系统中除了代理链外的任一应用链均处于平等地位，既可以请求服务也可以提供服务，即数据流是双向的，此处仅用第一区块链向第二区块链单向提供服务的流程进行说明，该模型包括三个实体：第一区块链、第二区块链和中继代理链。符号说明：IDa是第一代理节点的身份，PKa是第一代理节点的公钥，SKa是第一代理节点的私钥，Sig是签名函数，N1是随机数1，Cert1是第一区块链认证中心为第一代理节点颁发的数字证书，T1是数字证书Cert1的有效期，PKp是服务提供者的公钥，SKp是服务提供者的私钥，Sid是服务S的唯一标识号，m是服务提供者提供的服务指令，policy是服务提供者的服务策略，PKr是服务请求者的公钥，SKr是服务请求者的私钥，catg是服务请求者的属性。第一区块链和第二区块链采用公链，代理链采用联盟链。系统主体流程可分为以下四个阶段：S1系统初始化：代理链根据创世区块进行初始化，第一代理节点和第二代理节点分别在第一区块链认证中心和第二区块链认证中心上发送注册请求，第一区块链认证中心和第二区块链认证中心验证成功后分别为其颁发数字证书，然后服务提供者调用第一区块链上发布合约将服务数据密文发送到链上，并通过第一代理节点转移到代理链上。S2服务请求及匹配：第二区块链上的服务请求者任意时刻可调用第二区块链上请求合约发起服务请求，第二代理节点从账本获取到该请求后发送给第二区块链认证中心，第二区块链认证中心验证通过后调用代理链上匹配合约进行服务匹配。S3服务数据准备：匹配成功后，第一区块链认证中心将PKr以密文形式发送给第一代理节点，第一代理节点发布在第一区块链上后服务提供者即可在账本中获取到，服务提供者进行密钥转换后将重加密密钥通过第一代理节点发送给第一区块链认证中心，第一区块链认证中心利用重加密密钥对服务数据进行重加密。S4服务数据获取及验证：第一区块链认证中心将重加密后的服务数据密文发布在代理链上，第二区块链认证中心从账本获取到后发送给第二代理节点，第二代理节点发布在第二区块链上后服务请求者即可在账本中获取到并解密获取服务数据明文，然后将其哈希值通过第二代理节点发送给第二区块链认证中心，第二区块链认证中心调用代理链上验证合约进行数据一致性验证。每个阶段具体描述如下：所述步骤S1系统初始化阶段具体包括以下步骤，具体流程如图2所示：S11：代理链进行初始化，以Hyperledger Fabric联盟链为例，其中要求第一区块链认证中心和第二区块链认证中心各自控制一Peer节点并加入同一通道以进行数据共享，共识节点可按照创世区块中配置的策略加入或退出集群，更新将在链上留下记录。如区块链认证中心退出，其之前签发的代理节点仍在链上可查，不影响继续使用，但更新需要重新注册。如部分区块链认证中心认为某区块链认证中心不再具备提供验证服务的能力，可达成共识迫使其退出。与区块链认证中心主动退出集群的区别在于，该情况需对该区块链认证中心自不可信起发布的全部证书做过期处理。S12：第一代理节点和第二代理节点分别在第一区块链认证中心和第二区块链认证中心上注册，以第一代理节点注册为例：①第一代理节点向第一区块链认证中心发送注册请求Reg＝,N1)，其中IDa是②第一区块链认证中心接收到后通过IDa验证是否合法，并验证随机数和签名的有效性，若验证通过则视为注册成功，为其生成数字证书Cert1＝，并将数字证书哈希值Hash写入区块链③第一区块链认证中心将Hash返回给第一代理节点，此后每当第一代理节点向第一区块链认证中心发送消息时出示Hash，第一区块链认证中心即可进行验证，同理第二代理节点向第二区块链认证中心注册后获得Hash。S13：服务提供者调用第一区块链上发布合约将自身公钥PKp、唯一服务标识号Sid、C1＝Enc、服务明文m的Keccak256哈希函数处理结果Hash和策略policy这5项信息发布上链，即{Pkp,Sid,C1,Hash,policy}，第一代理节点从账本获取到后将{Pkp,Sid,C1,Hash,policy,Hash}发送给第一区块链认证中心，第一区块链认证中心验证Hash通过后调用代理链上发布合约发布{Pkp,Sid,C1,Hash,policy}，存储在代理链上的服务列表中。所述步骤S2服务请求及匹配阶段具体包括以下步骤，具体流程如图3所示：S21：服务请求者调用第二区块链上请求合约将自身公钥PKr、Sid和自身属性catg这3项信息发布上链，即服务请求{PKr,Sid,catg}，第二代理节点从账本获取到后将{PKr,Sid,catg,Hash}发送给第二区块链认证中心，第二区块链认证中心验证Hash通过后调用代理链上匹配合约。S22：匹配过程为：先根据服务请求数据判断该用户是否频繁发起请求，若超过设定阈值则调用惩罚合约对服务请求者进行惩罚；若未超过阈值则根据Sid的布隆过滤器存储表快速查找符合服务请求Sid的服务项。然后在Sid匹配成功的服务项里依次验证catg是否符合policy要求，若符合要求，则将所匹配成功的服务项发布在代理链上；若匹配失败，则返回提示信息提示第二区块链认证中心。所述步骤S3服务数据准备阶段具体包括以下步骤，具体流程如图4所示：S31：如果请求者属性满足服务策略，说明该请求者为合法用户，第一区块链认证中心用PKp加密PKr以抵抗第一代理节点可能发起的公钥替换攻击，即C2＝Enc，将C2发送给第一代理节点，第一代理节点将C2发布到第一区块链上，服务提供者从账本获取到并用自身私钥SKp解密后得到PKr，然后利用SKp和PKr进行密钥转换，将重加密密钥PK通过第一代理节点发送给第一区块链认证中心。S32：第一区块链认证中心用重加密密钥PK对C1＝Enc进行代理重加密后得到C3＝Enc,m)，然后将C3发布到代理链上。所述步骤S4服务数据获取及验证阶段具体包括以下步骤，具体流程如图5所示：S41：第二区块链认证中心从账本获取到C3后将其发送给第二代理节点，第二代理节点将C3发布到第二区块链上，服务请求者从账本获取到后用自身私钥解密获取服务数据明文，记为m'＝Dec，然后经同样的Keccak256哈希函数处理后得到Hash。S42：服务请求者发送Hash调用请求合约发起验证请求，该请求通过第二代理节点发送给第二区块链认证中心，第二区块链认证中心调用验证合约检查Hash是否等于Hash，如果不相等则调用惩罚合约对服务提供者进行惩罚，并将验证及惩罚结果通知服务请求者和服务提供者。本系统的应用链如第一区块链和第二区块链采用公链，代理链采用联盟链。攻击者要想达成51％攻击，PoW公链共识协议中需要控制全网至少51％算力，PoS公链共识协议中需要控制全网至少51％代币，PBFT联盟链共识协议中需要至少控制1/3联盟链网络节点，因此51％攻击是不可行的。服务提供者在系统初始化阶段将本地准备好的服务数据用自身私钥加密发布到第一区块链上，经由第一代理节点发送给第一区块链认证中心并存储于代理链，待匹配成功后，由第一区块链认证中心将服务请求者公钥用服务提供者公钥加密后发送给第一代理节点，第一代理节点发布到第一区块链上，服务提供者在账本获取到后本地生成重加密密钥，第一区块链认证中心收到重加密密钥后再对上述服务数据进行代理重加密后发布，最终服务请求者获取到密文并使用自身私钥成功解密，因此在系统模型运行的全过程中服务提供者的服务数据均是被加密保护的，第一代理节点或联盟链节点想要获取明文或推算密钥是不可行的。由于服务请求者每次与代理链交互都需要经由第一代理节点，所以第一代理节点有较高的攻击可能性，除了唯密文攻击，在代理重加密过程中，如果第一代理节点成功把服务请求者公钥替换为自身公钥，则可获取到重加密服务数据并解密，但服务请求者的公钥被第一区块链认证中心使用服务提供者公钥加密，所以第一代理节点想要恶意发起公钥替换攻击也是不可行的。若服务请求者频繁发起请求，则在服务匹配阶段会被匹配合约检出，进而调用惩罚合约对该服务请求者实施惩罚；若服务提供者频繁发布无用的或恶意的服务，则在服务验证阶段会被验证合约检出，进而调用惩罚合约对该服务提供者实施惩罚。因此，本系统在一定程度上能够抵抗DoS攻击。系统时间开销主要取决于服务匹配和代理重加密两部分：服务匹配部分包括Sid匹配和属性策略匹配，采用高效的布隆过滤器进行存储匹配且设置二级匹配，只有通过Sid匹配的服务才进入属性策略匹配，因此服务匹配部分时间开销较小。代理重加密虽然相较于普通对称或非对称加密有着更大的时间开销，但是本实施例采用公开算法，且第一区块链认证中心在获取到重加密密钥后仅对C1＝Enc进行重加密，数据量较小，从而有效减小系统时间开销。实施例3本发明实施例3提供一种电子设备，包括存储器和处理器，所述处理器和所述存储器相互通信，所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令执行基于区块链跨链的安全可验证服务提供方法，该方法包括如下流程步骤：步骤S1：区块链认证中心获取代理节点的注册请求，验证成功后分别为其颁发数字证书，服务提供者加密服务数据，密文经由第一代理节点被转发至第一区块链认证中心并发布于代理链上；步骤S2：服务请求者调用请求合约发布服务请求，该请求经由第二代理节点被转发至第二区块链认证中心，第二区块链认证中心验证通过后调用匹配合约进行服务匹配；步骤S3：匹配成功后，服务提供者通过自身公钥和服务提供者的私钥进行密钥转换得到重加密密钥，第一区块链认证中心利用该重加密密钥对服务数据进行重加密；步骤S4：第一区块链认证中心将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。实施例4本发明实施例4提供一种计算机可读存储介质，其存储有计算机程序，所述计算机程序被处理器执行时实现基于区块链跨链的安全可验证服务提供方法，该方法包括如下流程步骤：步骤S1：区块链认证中心获取代理节点的注册请求，验证成功后分别为其颁发数字证书，服务提供者加密服务数据，密文经由第一代理节点被转发至第一区块链认证中心并发布于代理链上；步骤S2：服务请求者调用请求合约发布服务请求，该请求经由第二代理节点被转发至第二区块链认证中心，第二区块链认证中心验证通过后调用匹配合约进行服务匹配；步骤S3：匹配成功后，服务提供者通过自身公钥和服务提供者的私钥进行密钥转换得到重加密密钥，第一区块链认证中心利用该重加密密钥对服务数据进行重加密；步骤S4：第一区块链认证中心将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。实施例5本发明实施例5提供一种计算机设备，包括存储器和处理器，所述处理器和所述存储器相互通信，所述存储器存储有可被所述处理器执行的程序指令，所述处理器调用所述程序指令执行基于区块链跨链的安全可验证服务提供方法，该方法包括如下步骤：步骤S1：区块链认证中心获取代理节点的注册请求，验证成功后分别为其颁发数字证书，服务提供者加密服务数据，密文经由第一代理节点被转发至第一区块链认证中心并发布于代理链上；步骤S2：服务请求者调用请求合约发布服务请求，该请求经由第二代理节点被转发至第二区块链认证中心，第二区块链认证中心验证通过后调用匹配合约进行服务匹配；步骤S3：匹配成功后，服务提供者通过自身公钥和服务提供者的私钥进行密钥转换得到重加密密钥，第一区块链认证中心利用该重加密密钥对服务数据进行重加密；步骤S4：第一区块链认证中心将重加密后的服务数据密文发布在代理链上，进而转移到第二区块链上，服务请求者在账本中获取到并解密获取服务数据明文，结合验证合约进行数据一致性验证。综上所述，本发明实施例所述的基于区块链跨链的安全可验证服务提供方法及系统，通过中继链实现了跨链服务，可实现物联网异构跨域的服务提供，且保证了服务数据安全性与一致性；通过每个应用链上的代理节点向代理链进行注册并获取证书以取得传输请求和服务信息的资格，并采用中继链及智能合约来存储服务数据、匹配服务以及实施惩罚等；利用区块链跨链技术实现跨异构信任域进行服务提供，采用代理重加密对服务数据进行加密保护，并使用智能合约来对请求和服务进行匹配，还加入惩罚机制。通过智能合约和哈希函数保证了数据一致性，通过代理重加密保证了数据安全性。本发明采用中继链跨链方案，可扩展到多个应用链的互联互通，请求和服务可双向进行，并采用惩罚合约对服务请求者和服务提供者进行双向约束。聚焦于具体的服务提供者为服务请求者跨域提供安全可验证的服务。本领域内的技术人员应明白，本发明的实施例可提供为方法、系统、或计算机程序产品。因此，本发明可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本发明可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本发明是参照根据本发明实施例的方法、设备、和计算机程序产品的流程图和/或方框图来描述的。应理解可由计算机程序指令实现流程图和/或方框图中的每一流程和/或方框、以及流程图和/或方框图中的流程和/或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和/或方框图一个方框或多个方框中指定的功能的步骤。上述虽然结合附图对本发明的具体实施方式进行了描述，但并非对本发明保护范围的限制，所属领域技术人员应该明白，在本发明公开的技术方案的基础上，本领域技术人员在不需要付出创造性劳动即可做出的各种修改或变形，都应涵盖在本发明的保护范围之内。
