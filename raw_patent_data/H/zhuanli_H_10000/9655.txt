标题title
适用于PLC载波安全的一表一PSK适配方法
摘要abst
本发明涉及一种适用于PLC载波安全的一表一PSK适配方法，所述方法包括S1、电表发送请求数据包至集中器，集中器上报至主站系统，主战系统依据接收到的信息回复集中器，集中器与当前电表建立正常连接，当前电表完成认证注册，所述请求数据包包括当前电表的MAC地址；S2、主站系统生成新的{Mi_PSK_id，Mi_PSK}信息，并将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time发送至当前电表；S3、主站系统将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time和MAC地址发送至集中器；S4、当前电表和集中器待各自接收到的PSK生效时间PSK_Valid_time起效后，分别以新的{Mi_PSK_id，Mi_PSK}信息运行，完成一表一PSK适配。该方法提高了智能电网的安全性。
权利要求书clms
1.一种适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述方法包括，S1、电表发送请求数据包至集中器，集中器上报至主站系统，主战系统依据接收到的信息回复集中器，集中器与当前电表建立正常连接，当前电表完成认证注册，所述请求数据包包括当前电表的MAC地址；S2、主站系统生成新的{Mi_PSK_id，Mi_PSK}信息，并将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time发送至当前电表；S3、主站系统将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time和MAC地址发送至集中器；S4、当前电表和集中器待各自接收到的PSK生效时间PSK_Valid_time起效后，分别以新的{Mi_PSK_id，Mi_PSK}信息运行，完成一表一PSK适配。2.根据权利要求1所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述S1中的电表发送请求数据包至集中器，集中器上报至主站系统，主站系统依据接收到的信息回复集中器，集中器与当前电表建立正常连接，当前电表完成认证注册，具体包括，S11、电表的STA模块向电表请求参数，得到{Mi_PSK_id，Mi_PSK}信息，STA模块将电表的MAC地址上报至集中器；S12、集中器查询自身是否初装有{Mi_PSK_id，Mi_PSK}信息，当未查询到信息时，发送请求信息至主站系统以期获取{Mi_PSK_id，Mi_PSK}信息；S13、主站系统将{Mi_PSK_id，Mi_PSK}信息回复至集中器，集中器接收此信息后将所述信息连同MAC地址回复至STA模块，与当前电表建立正常连接，完成当前电表的注册认证。3.根据权利要求2所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述S12中的集中器在查询自身是否初装有{Mi_PSK_id，Mi_PSK}信息时还包括，当其查询到自身具有{Mi_PSK_id，Mi_PSK}信息时，以{Mi_PSK_id，Mi_PSK}信息连同MAC地址回复至STA模块，与当前电表建立正常连接，完成当前电表的注册认证。4.根据权利要求3所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述S12中的集中器通过STA模块上报的MAC地址查询{Mi_PSK_id，Mi_PSK}信息。5.根据权利要求4所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述S13中的主站系统接收到集中器的请求信息后，根据自身携带的shipment文件，通过MAC地址查询当前电表的表号和{Mi_PSK_id，Mi_PSK}信息。6.根据权利要求1所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述S2中的主站系统通过秘钥管理系统，根据当前电表的表号生成与当前表号一一对应的新的{Mi_PSK_id，Mi_PSK}信息。7.根据权利要求1所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述适配方法还包括，在进行S1操作之前，电表需安装上电，在完成S4操作后，电表中的STA模块离网，并跳转执行S1。8.根据权利要求1所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述方法还包括电表在注册认证成功后，执行S2之前，电表会完成安装操作。9.根据权利要求3所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述Mi_PSK_id为32字节，所述Mi_PSK为15字节。10.根据权利要求3所述适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述PSK_Valid_time取值为5min。
说明书desc
技术领域本发明涉及电表技术领域，尤其涉及一种适用于PLC载波安全的一表一PSK适配方法。背景技术随着智能电网的飞速发展，一个台区下会集中管理多个电表，该多个电表通过电力线组成一个网络，该网络一旦遭受安全攻击，不仅会造成信息与经济上的巨大损失，而且会威胁到人身与社会安全，因而，电力线通信的安全问题备受关注。目前，国际上应用较广泛的G3-Prime载波技术方案，其一个网络下的所有设备均配备同一个PSK，一旦该PSK被攻破，则整个网络安全破防，受攻击风险性很高。发明内容鉴于上述问题，本发明的目的在于提供一种一表一密钥的适用于PLC载波安全的一表一PSK适配方式，以提高智能网络的安全性。为了实现上述目的，本发明的技术方案为：一种适用于PLC载波安全的一表一PSK适配方法，其特征在于：所述方法包括，S1、电表发送请求数据包至集中器，集中器上报至主站系统，主战系统依据接收到的信息回复集中器，集中器与当前电表建立正常连接，当前电表完成认证注册，所述请求数据包包括当前电表的MAC地址；S2、主站系统生成新的{Mi_PSK_id，Mi_PSK}信息，并将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time发送至当前电表；S3、主站系统将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time和MAC地址发送至集中器；S4、当前电表和集中器待各自接收到的PSK生效时间PSK_Valid_time起效后，分别以新的{Mi_PSK_id，Mi_PSK}信息运行，完成一表一PSK适配。进一步的，所述S1中的电表发送请求数据包至集中器，集中器上报至主站系统，主站系统依据接收到的信息回复集中器，集中器与当前电表建立正常连接，当前电表完成认证注册，具体包括，S11、电表的STA模块向电表请求参数，得到{Mi_PSK_id，Mi_PSK}信息，STA模块将电表的MAC地址上报至集中器；S12、集中器查询自身是否初装有{Mi_PSK_id，Mi_PSK}信息，当未查询到信息时，发送请求信息至主站系统以期获取{Mi_PSK_id，Mi_PSK}信息；S13、主站系统将{Mi_PSK_id，Mi_PSK}信息回复至集中器，集中器接收此信息后将所述信息连同MAC地址回复至STA模块，与当前电表建立正常连接，完成当前电表的注册认证。进一步的，所述S12中的集中器在查询自身是否初装有{Mi_PSK_id，Mi_PSK}信息时还包括，当其查询到自身具有{Mi_PSK_id，Mi_PSK}信息时，以{Mi_PSK_id，Mi_PSK}信息连同MAC地址回复至STA模块，与当前电表建立正常连接，完成当前电表的注册认证。进一步的，所述S12中的集中器通过STA模块上报的MAC地址查询{Mi_PSK_id，Mi_PSK}信息。进一步的，所述S13中的主站系统接收到集中器的请求信息后，根据自身携带的shipment文件，通过MAC地址查询当前电表的表号和{Mi_PSK_id，Mi_PSK}信息。进一步的，所述S2中的主站系统通过秘钥管理系统，根据当前电表的表号生成与当前表号一一对应的新的{Mi_PSK_id，Mi_PSK}信息。进一步的，所述适配方法还包括，在进行S1操作之前，电表需安装上电，在完成S4操作后，电表中的STA模块离网，并跳转执行S1。进一步的，所述方法还包括电表在注册认证成功后，执行S2之前，电表会完成安装操作。进一步的，所述Mi_PSK_id为32字节，所述Mi_PSK为15字节。进一步的，所述PSK_Valid_time取值为5min。与现有技术相比，本发明的优点在于：采用STA发送MAC地址方式，使集中器通过查询MAC地址确认是否包含与电表相匹配的PSK信息，以便建立正常连接，并在建立正常连接后，由主站通过MAC地址找到当前电表表号，根据当前电表表号生成对应的新的PSK信息，并发送至当前电表和集中器，从而实现一表一PSK，提高了智能网络的安全性。附图说明图1为本申请适配方法对应的流程原理图。具体实施方式下面详细描述本发明的实施例，所述实施例的示例在附图中示出，其中自始至终相同或类似的标号表示相同或类似的元件或具有相同或类似功能的元件。下面通过参考附图描述的实施例是示例性的，仅用于解释本发明，而不能理解为对本发明的限制。图1示出了本申请适用于PLC载波安全的一表一PSK适配方法的实施例流程图，如图所示，该方法包括，S1、电表发送请求数据包至集中器，集中器上报至主站系统，主战系统依据接收到的信息回复集中器，集中器与当前电表建立正常连接，当前电表完成认证注册，所述请求数据包包括当前电表的MAC地址；S2、主站系统生成新的{Mi_PSK_id，Mi_PSK}信息，并将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time发送至当前电表；S3、主站系统将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time和MAC地址发送至集中器；S4、当前电表和集中器待各自接收到的PSK生效时间PSK_Valid_time起效后，分别以新的{Mi_PSK_id，Mi_PSK}信息运行，完成一表一PSK适配。具体而言，该S1中的电表发送请求数据包至集中器，集中器上报至主站系统，主站系统依据接收到的信息回复集中器，集中器与当前电表建立正常连接，当前电表完成认证注册，具体包括，S11、电表的STA模块向电表请求参数，得到{Mi_PSK_id，Mi_PSK}信息，STA模块将电表的MAC地址上报至集中器；S12、集中器查询自身是否初装有{Mi_PSK_id，Mi_PSK}信息，当未查询到信息时，发送请求信息至主站系统以期获取{Mi_PSK_id，Mi_PSK}信息；S13、主站系统将{Mi_PSK_id，Mi_PSK}信息回复至集中器，集中器接收此信息后将所述信息连同MAC地址回复至STA模块，与当前电表建立正常连接，完成当前电表的注册认证。也即，电表安装上电后，STA模块向电表请求参数，得到{Mi_PSK_id，Mi_PSK}信息。在DCU/GW安装上电的条件下，PLC网络上，STA模块启动注册流程，将电表的MAC地址上报给DCU/GW，即上报给集中器。集中器初装没有{Mi_PSK_id，Mi_PSK}信息时，向主站系统请求，主站系统会根据shipment file，通过MAC地址查询到电表的表号和{Mi_PSK_id，Mi_PSK}信息，并将其发送给集中器，经过认证成功后，电表与集中器建立正常连接，完成认证注册。而当集中器查询到自身具有{Mi_PSK_id，Mi_PSK}信息时，其会以{Mi_PSK_id，Mi_PSK}信息连同MAC地址回复至STA模块，与当前电表建立正常连接，完成当前电表的注册认证。在执行S12过程中，集中器通过STA模块上报的MAC地址查询{Mi_PSK_id，Mi_PSK}信息。电表在完成注册认证后，会完成安装操作，此操作属于电表的应用层协议交互流程，且为本领域技术人员均知晓的普通技术知识，此处就不再详细展开。主站系统会通过KMS，根据表号生成新的{Mi_PSK_id，Mi_PSK}信息，电表状态为安装态后，主站系统会将新的{Mi_PSK_id，Mi_PSK}信息连同对应于电表的PSK生效时间PSK_Valid_time发送至当前电表。同时，主站会将{Mi_new_PSK_id，Mi_new_PSK，PSK_Valid_time}下发至集中器，一更新集中器中的PSK。当新的PSK生效时间PSK_Valid_time起效后，集中器、电表以{Mi_new_PSK_id，Mi_new_PSK}信息运行。此后，STA离网，转而继续执行S1，以对剩余电表进行一表一PSK的适配操作。本方法为每个表配置了唯一的PSK，提高了智能网络的安全性，同时，所有的PSK管理都在主站系统中，也确保了设备的安全性。作为一种优选，本申请中的Mi_PSK_id、Mi_new_PSK_id均为32字节，Mi_PSK、Mi_new_PSK均为15字节，PSK_Valid_time取值为5min。本发明通过采用STA发送MAC地址方式，使集中器通过查询MAC地址确认是否包含与电表相匹配的PSK信息，以便建立正常连接，并在建立正常连接后，由主站通过MAC地址找到当前电表表号，根据当前电表表号生成对应的新的PSK信息，并发送至当前电表和集中器，从而实现一表一PSK，提高了智能网络的安全性。尽管已经示出和描述了本发明的实施例，本领域技术人员可以理解：在不脱离本发明的原理和宗旨的情况下可以对这些实施例进行多种变化、修改、替换和变形，本发明的范围由权利要求及其等同物限定。
