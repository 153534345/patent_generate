标题title
一种基于TOD的跳频同步方法及系统
摘要abst
本发明提出一种基于TOD的跳频同步方法及系统，该方法对现有基于TOD的跳频同步方法中的跳频频率生成方法进行改进，包括步骤：发送方将与接收方之间的对称密钥用n个不同的哈希函数进行计算，得到n个哈希值；发送方获取当前时刻的TOD信息，并以相同步长取之前n‑1个时刻的TOD信息，然后为每个TOD信息的高位内容TODH计算出一个随机码；最后用对应的TODH、随机码和哈希值联合运算，计算出n个跳频频率。本发明将TOD信息转为敌方无法获取的随机码，同时，设计了独特的频率计算方法，每当TODH更新时，n个跳频频率均随之变化，一个跳频频率仅在一个周期内使用，增加了跳频频率的多变性，也增加了敌方破解跳频频率的难度，提高跳频同步过程中的抗扰性和保密性。
权利要求书clms
1.一种基于TOD的跳频同步方法，包括步骤：发送方生成跳频频率和同步序列，然后在跳频频率上发送同步序列，接收方通过频率扫描捕获同步频率，在同步频率上接收同步序列，用接收到的同步序列修正本地TOD；其特征在于：发送方生成用于发送同步序列的n个跳频频率的方法包括以下步骤：发送方将与接收方之间的对称密钥用n个不同的哈希函数进行计算，得到n个哈希值；发送方获取当前时刻的TOD信息，并以相同步长取之前n-1个时刻的TOD信息，共计n个TOD信息；然后为每个TOD信息的高位内容TODH计算出一个随机码，共得到n个随机码；用对应的TODH、随机码和哈希值联合运算，计算出n个跳频频率：f1＝F,RF,R1)f2＝F,RF,R2)fn＝Ft),RFt),Rn)其中，fi表示当前时刻发送方生成的第i个跳频频率，F表示联合运算函数，TODH表示发送方在时刻t的本地TOD信息的高段内容，RF表示TODH对应的随机码，Ri表示第i个哈希值。2.根据权利要求1所述的一种基于TOD的跳频同步方法，其特征在于，接收方修正本地TOD的具体步骤包括：接收方计算出至少一个扫描频组，一个扫描频组中包括n个扫描频率，每个扫描频率由接收方基于本地TOD信息、采用与发送方相同的计算方法计算得到；接收方在每个扫描频组上扫描同步序列中的频率，直至捕获已端与发送方同步的频率；接收方根据两个同步频率索引之间的差值校正本地TOD信息的高位内容；接收方校正本地TOD信息的高位内容后，重新计算同步频率，并在同步频率上进行同步跟跳，接收同步序列中发送方TOD信息的低位内容TODL，根据TODL矫正本地TOD信息的低位内容，实现同步。3.根据权利要求2所述的一种基于TOD的跳频同步方法，其特征在于，所述发送方在发送同步序列前，还采用与接收方预先约定好的方式对TODL进行加密，接收方在接收到发送方的TODL时，采用约定好的方式进行解密，即可得到发送方的TODL。4.根据权利要求3所述的一种基于TOD的跳频同步方法，其特征在于，所述对TODL进行加密的加密方式为：发送端用当前时刻的TODH相应的随机码生成一个加密密钥，用生成的加密密钥加密TODL。5.根据权利要求1至4任意一项所述的一种基于TOD的跳频同步方法，其特征在于，所述随机码采用以下方式得到：用对称密钥加密TODH，得到随机码的初始位置指针；用对称密钥和TODH联合计算，为随机码的每一位计算出一个步长；用初始位置指针和随机码第一位的步长联合计算，得到随机码第一位的提取指针；用随机码第一位的提取指针和随机码第二位的步长联合计算，得到随机码第二位的提取指针，以此类推，计算出随机码每一位的提取指针；根据提取指针从预先存储在本地的对称密钥池中提取相应的每一位密钥数据，得到随机码。6.根据权利要求5所述的一种基于TOD的跳频同步方法，其特征在于，所述发送方与接收方之间的对称密钥采用以下方法得到：发送方和接收方在跳频同步之前，预先向密钥颁发服务器申请用户端公私钥；密钥颁发服务器根据用户申请，为用户端分配一个唯一的ID，然后采用第一哈希函数将客户端ID映射为用户端公钥，再用密钥颁发服务器的系统私钥与用户公钥计算出用户私钥，最后将计算出的用户私钥、用户ID颁发给用户端；发送方和接收方存储有相同的对称密钥计算函数和第一哈希函数，在计算与对方的对称密钥时，先用第一哈希函数计算对方ID，得到对方的公钥，然后用对称密钥计算函数对自己的私钥和对方的公钥进行联合计算，得到对称密钥。7.根据权利要求6所述的一种基于TOD的跳频同步方法，其特征在于，还包括步骤：在发送方和接收方本地配置密钥卡，用于存储对称密钥池和计算跳频频率过程中用到的各个函数，所述密钥卡中还部署抗拆解的TPM/TCM芯片，用于存储用户公私钥；在密钥颁发服务器本地部署抗拆解的TPM/TCM芯片，用于存储系统公私钥。8.一种基于TOD的跳频同步系统，其特征在于，所述系统包括发送方和接收方，而所述发送方和接收方之间采用权利要求1至6任意一项所述方法进行跳频同步。
说明书desc
技术领域本发明涉及数据链系统领域，尤其涉及一种基于TOD的跳频同步方法及系统。背景技术跳频是指信号载波不停跳变，达到不可被敌方预测的目的。跳频分为跳频同步和跳频传输数据两个步骤。其中跳频同步是指双方约定好跳频的时间点和跳频规律，是传输数据前必须事先完成的步骤。有大约4种主要的跳频同步方法，其中较重要的是同步字头法。目前的同步字头法通常为基于TOD的同步字头法，“基于Simulink的跳频同步技术仿真平台设计与实现窦秀娟.电子科技大学.2013”中提及了现有的基于TOD的同步字头法的相关原理。在现有的基于TOD的同步字头法中，发送方和接收方通常拥有相同的对称密钥和跳频频率表，然后发送方根据TOD和对称密钥计算出跳频序列，通过跳频序列控制跳频频率表进而控制本地频率合成器生成跳频频率。为了保证当收发双方时钟存在一定差异的情况下仍可实现同步，通常将TOD信息中的高位信息提取出来作为TOD高段，比如分钟及其高位信息，系统根据TODH而不是全部的TOD信息来计算同步频率，由此可保证，当收发双方时钟存在一定差异的情况下仍存在相同的同步频率。除TODH外，TOD的剩余部分作为TOD低段，TODL则以跳频间隔为计时单位，该值参与通信频率的计算，但不参与同步频率的计算。在基于TOD的同步字头法中，同步头结构主要包括相关码部分和TODL信息。相关码部分对于接收方来说用于完成同步频率的捕获，进而完成接收方本地TOD中高段内容TODH的校正。一段完整的相关码通常根据系统要求被分为n个码序列，然后一一对应地在n个跳频频率上传输，将相关码的一次完整传输记为一次相关跳，一次相关跳中包含频率为f1至fn的n跳跳频传输，f1至fn就是同步头的跳频频率集。为增加接收方同步频率的捕获几率，通常在一个同步头结构中传输多次完整的相关码，则一个同步头结构中包含若干相关跳。TODL信息在同步头结构中位于后半部分，用于完成接收方本地TODL的校正，以实现接收方同步跟踪。为提高同步头的保密性，TODL信息通常也被分为n段在n个跳频频率上传输，每次个频率上只传输一部分TODL的内容。现有基于TOD的同步字头法中，为了提高同步头频率的抗干扰性，因此这些频率随时间变化而变化：设TODH每隔时间T更新一次，则每更新一次TODH，就更新跳频频率集中的一个频率，这样，经过时长nT后，跳频频率集中的所有频率都更新了一遍。但是，现有的基于TOD的同步字头法虽然具有一定程度的抗扰性和保密性，但是仍然存在以下缺陷：1、现有的基于TOD的同步字头法中，跳频频率是基于TOD的高位信息TODH直接进行频率变换得到频率，由于TODH容易被敌方所得，因此计算出的跳频频率易被敌方破解；另一方面，同步头的频率集中跳频频率的更新较慢，每更新一次TODH，仅更新频率集中的一个频率，这必然会导致大部分频率被使用多次，而这些频率在多次使用的过程中易被敌方捕获，从而导致同步头极易被敌方窃取或干扰；2、现有的基于TOD的同步字头法中，收发端共享的对称密钥通常是伪随机数，计算出来的跳频序列也是伪随机数，而伪随机数具有可预测性，因此导致跳频过程中安全性不高，无法实现抗量子计算；3.现有技术的基于TOD的同步字头法中，TODL未有加密保护，易被窃取。发明内容发明目的：为克服现有技术的缺陷，本发明提出一种基于TOD的跳频同步方法及系统。发明内容：为了克服现有的基于TOD的同步字头法中，跳频频率和TOD信息容易被破解的问题，本发明提出一种基于TOD的跳频同步方法，该方法对跳频同步方法中的跳频频率生成方法进行改进，若根据需求，传输同步序列需要n个跳频，则发送方生成用于发送同步序列的n个跳频频率的方法包括以下步骤：发送方将与接收方之间的对称密钥用n个不同的哈希函数进行计算，得到n个哈希值；发送方获取当前时刻的TOD信息，并以相同步长取之前n-1个时刻的TOD信息，共计n个TOD信息；然后根据每个TOD信息的高位内容TODH计算出一个由真随机数组成的随机码，共得到n个随机码；用对应的TODH、随机码和哈希值联合运算，计算出n个跳频频率：其中，fi表示当前时刻发送方生成的第i个跳频频率，F表示联合运算函数，TODH表示发送方在时刻t的本地TOD信息的高段内容，RF表示TODH对应的随机码，Ri表示第i个哈希值。在本发明中，我们一方面将易于被敌方获取的TODH转化为一个由真随机数组成的随机码，然后用这个随机码去计算跳频频率，使得敌方获取的TOD信息成为无用信息。另一方面，我们设计了独特的频率计算方法，用TODH、随机码和对称密钥计算出的哈希值联合计算出跳频频率，且每当TODH更新时，n个跳频频率均随之变化，一个跳频频率仅在一个周期内使用，相对于现有技术中一个跳频频率在多个周期使用的情况，本发明显然增加了跳频频率的多变性，也增加了敌方破解跳频频率的难度，提高跳频同步过程中的抗扰性和保密性。对于上述基于TOD的跳频同步方法，以下还提供了若干可选方式，但并不作为对上述总体方案的额外限定，仅仅是进一步的增补或优选，在没有技术或逻辑矛盾的前提下，各可选方式可单独针对上述总体方案进行组合，还可以是多个可选方式之间进行组合。可选的，接收方修正本地TOD的具体步骤包括：接收方计算出至少一个扫描频组，一个扫描频组中包括n个扫描频率，每个扫描频率由接收方基于本地TOD信息、采用与发送方相同的计算方法计算得到；接收方在每个扫描频组上扫描同步序列中的频率，直至捕获已端与发送方同步的频率；接收方根据两个同步频率索引之间的差值校正本地TOD信息的高位内容；接收方校正本地TOD信息的高位内容后，重新计算同步频率，并在同步频率上进行同步跟跳，接收同步序列中发送方TOD信息的低位内容TODL，根据TODL矫正本地TOD信息的低位内容，实现同步。可选的，所述发送方在发送同步序列前，还采用与接收方预先约定好的方式对TODL进行加密，接收方在接收到发送方的TODL时，采用约定好的方式进行解密，即可得到发送方的TODL。可选的，所述对TODL进行加密的加密方式为：发送端用当前时刻的TODH相应的随机码生成一个加密密钥，用生成的加密密钥加密TODL。可选的，所述随机码采用以下方式得到：用对称密钥加密TODH，得到随机码的初始位置指针；用对称密钥和TODH联合计算，为随机码的每一位计算出一个步长；用初始位置指针和随机码第一位的步长联合计算，得到随机码第一位的提取指针；用随机码第一位的提取指针和随机码第二位的步长联合计算，得到随机码第二位的提取指针，以此类推，计算出随机码每一位的提取指针；根据提取指针从预先存储在本地的对称密钥池中提取相应的每一位密钥数据，得到随机码。可选的，所述发送方与接收方之间的对称密钥采用以下方法得到：发送方和接收方在跳频同步之前，预先向密钥颁发服务器申请用户端公私钥；密钥颁发服务器根据用户申请，为用户端分配一个唯一的ID，然后采用第一哈希函数将客户端ID映射为用户端公钥，再用密钥颁发服务器的系统私钥与用户公钥计算出用户私钥，最后将计算出的用户私钥、用户ID颁发给用户端；发送方和接收方存储有相同的对称密钥计算函数和第一哈希函数，在计算与对方的对称密钥时，先用第一哈希函数计算对方ID，得到对方的公钥，然后用对称密钥计算函数对自己的私钥和对方的公钥进行联合计算，得到对称密钥。可选的，所述方法还包括步骤：在发送方和接收方本地配置密钥卡，用于存储对称密钥池和计算跳频频率过程中用到的各个函数，所述密钥卡中还部署抗拆解的TPM/TCM芯片，用于存储用户公私钥；在密钥颁发服务器本地部署抗拆解的TPM/TCM芯片，用于存储系统公私钥。本发明还提出一种基于TOD的跳频同步系统，所述系统包括发送方和接收方，而所述发送方和接收方之间采用所述方法进行跳频同步。有益效果：1.本发明中，将TOD信息转为敌方无法获取的随机码，使得敌方获取的TOD信息成为无用信息，同时，设计了独特的频率计算方法，用TODH、随机码和对称密钥计算出的哈希值联合计算出跳频频率，且每当TODH更新时，n个跳频频率均随之变化，一个跳频频率仅在一个周期内使用，相对于现有技术中一个跳频频率在多个周期使用的情况，本发明显然增加了跳频频率的多变性，也增加了敌方破解跳频频率的难度，提高跳频同步过程中的抗扰性和保密性。2、本发明中采用对称密钥和TODH计算真随机数组成的随机码，真随机数本身具有不可预测性，且这些真随机数从密钥池中采用不同的步长逐个取出多个随机数比特，每次步长均不同，大大增加敌方破解的难度，能够实现发送方和接收方之间的抗量子计算通信。3、本发明中，对TODL进行加密保护，不易被窃取。附图说明图1为基于TOD的同步字头法序列格式图；图2为本发明中涉及的获取随机码的流程的示例性示意图。具体实施方式下面将结合附图和具体实施例对本发明作更进一步的说明。但应当理解的是，本发明可以以各种形式实施，以下在附图中出示并且在下文中描述的一些示例性和非限制性实施例，并不意图将本发明限制于所说明的具体实施例。应当理解的是，在技术上可行的情况下，以上针对不同实施例所列举的技术特征可以相互组合，从而形成本发明范围内的另外的实施例。此外，本发明所述的特定示例和实施例是非限制性的，并且可以对以上所阐述的结构、步骤、顺序做出相应修改而不脱离本发明的保护范围。本发明旨在克服现有基于TOD的跳频同步方法中，同步头易被攻击，导致跳频同步过程中安全性不高的问题。有鉴于此，本发明提出一种基于TOD的跳频同步方法及系统。下面将通过具体实施例来进行进一步阐述。实施例：基于TOD信息的跳频同步方法实现在发送方和接收方。本实施例中，设发送方为A，接收方为B。发送方与接收方均配有密钥卡，密钥卡存储有对称密钥池，即发送方与接收方的密钥池相等。密钥卡还存储有基于ID密码学的公私钥参数，由密钥颁发服务器颁发，具体步骤如下：密钥颁发服务器首先需要建立一套基于ID密钥学的系统参数，步骤如下：设q为大素数，生成G1和G2，G1和G2分别为q阶加法循环群和乘法循环群。映射成为双线性映射。随机选择G1的生成元P；定义hash函数H：{0，1}*→G1*；设定其他系统参数ad_paras；随机地取s∈Zq*作为该算法的系统私钥，s仅保存在密钥颁发服务器KS，计算系统公钥Ppub＝s·P。所述算法参数为密钥颁发服务器保存上述基于ID密钥学的系统参数，用于生成系统公钥、系统私钥、请求方的ID、公钥和私钥。以发送方A，接收方B为例：密钥颁发服务器为发送方A颁发公私钥时，会生成唯一编码作为IDA，然后调用哈希函数H1计算公钥PKA＝H，再根据公钥PKA计算私钥SKA＝s*PKA。接收方B同理，密钥颁发服务器计算IDB，公钥PKB＝H，私钥SKB＝s*PKB。然后密钥颁发服务器将IDA、SKA颁发给发送方A的密钥卡，将IDB、SKB颁发给接收方B的密钥卡；发送方A可计算得到与接收方B的对称密钥接收方B可计算得到与发送方A的对称密钥根据ID密码学可得：在上述方案中，系统私钥s和系统公钥Ppub存储于密钥颁发服务器本地，可以在密钥颁发服务器本地部署抗拆解的TPM/TCM芯片，将系统主密钥和系统公钥存储在芯片中。终端的私钥和系统公钥也存储在终端密钥卡的内置TPM/TCM芯片中。这类保密芯片具有抗拆解功能，敌方无法获取芯片内的数据。即使密钥卡丢失被破解，敌方也仅能得到ID和哈希函数H进而计算出终端的公钥，在没有终端私钥和系统主密钥的前提下，无法得到对称密钥，同时敌方因无法得到系统公钥从而无法得到系统私钥，实现抗量子计算。除此之外，密钥卡中还存储有哈希函数数组，表示为{H1,H2,H3,……,HN}。在发送方和接收方都成功获取自己的用户公私钥后，开始进行跳频同步，整个流程如下：S1发送方生成同步序列和用于发送同步序列的跳频频率，同步序列的结构如图1所示，包含相关码部分、发送方当前时刻的本地TOD中的低位内容TODL和网号。相关码部分被分为n个码序列，并在一个相关跳中传输，一个相关跳包含n个跳频频率，这n个跳频频率的生成方法如下：1.1.假设一个相关跳的跳频频率个数为5个，记当前时刻为t0，取步长为t，获取前4个时刻的TODH，则连同当前时刻的TODH，共有5个TODH、TODH、TODH、TODH、TODH)，各频率的频率号按照顺序称为频率1至频率5；每个频率号对应了一个码序列，按照顺序称为码序列1至码序列5。发送方A根据接收方B的IDB计算得到对称密钥KAB，然后从哈希数组中取出五个哈希函数{H1,H2,H3,H4,H5}，利用五个哈希函数依次对KAB进行计算得到五个哈希值{R1,R2,R3,R4,R5}。1.2.每个相关跳中有5个频率，每个频率对应一个TODH，发送方为每个TODH计算一个随机码RF，计算过程如图2所示，包括如下步骤：计算得到随机码RF的初始位置指针PRF＝FPRFmod KPL，其中，mod表示取模运算，KPL为密钥池大小即总bit数，PRF为一个指针，指向密钥池中的某一个位置。设RF所需长度为N个bit，依次计算步长：LRF1＝FLRF，LRF2＝FLRF，LRF3＝FLRF，…，LRFN＝FLRF。函数FPRF和FLRF为任意指定的函数。再依次计算用于提取随机码的指针PRF1＝PRF+LRF1mod KPL，PRF2＝PRF1+LRF2mod KPL，…，PRFN＝PRFN-1+LRFNmod KPL。PRF1指向随机码RF的开始位置，也就是第一个bit的位置，PRF2指向随机码RF的第二个bit的位置，以此类推。根据PRF1、PRF2、…、PRFN从密钥池中依次取出对应位置的共N个bit的密钥数据。如超出密钥池大小KPL则利用对KPL取模的方式回到密钥池头部。现有技术中从密钥池获取密钥的方法主要有两种：第一种是通过密钥种子ID在密钥池中直接提取，这种方式中的密钥种子ID与密钥是一一对应的关系；第二种是选取一个位置，然后获取该位置的整段密钥。以总长度为230bit，密钥长度为210bit为例，第一种方法可使用的密钥个数为220个，第二种方法可使用的密钥个数为230个，均需要在较短时间周期内进行密钥池的更新。而本专利使用的通过为密钥中的每一位数据计算一个步长的方式从密钥池中选取密钥，可使用的密钥个数为21024个。这种方法提高了密钥的利用率，减少了用户补充密钥的次数，降低了用户的维护成本，使得对称密钥池的使用更加方便。1.3.计算出随机码之后，开始计算跳频频率，每个TODH都对应一个跳频频率，因此5个TODH就计算出5个频率，每个频率由3个参数决定，即：TODH、RF和R。本实施例中仅提出两种计算频率的方式，但其余基于以上3个参数计算频率的方法也应纳入本发明保护范围。方法1：通过同步频率计算公式计算出基础频率fsi＝Fft),RFt))，i＝1,2,…,5，其中Ff为根据需求设计的同步频率计算函数。然后对基础频率进行偏移计算得到同步频率fi＝fsi+c*Ri，其中c为使fi落于合理频率范围内的系数，Ri为步骤1中计算得到的哈希值。方法2：直接通过同步频率算法计算得到假设采用方法1计算f1至f5，则在不同时刻发送方计算出的f1至f5值如下：时刻t0：时刻t0+t：时刻t0+2t：时刻t0+3t：时刻t0+4t：从上述f1至f5的表达式可以看出，由于在计算频率的时候考虑了Ri，在不同时刻的5个频率各不相同，每当TODH发生一次变化，则5个频率都发生变化。1.4.利用当前时刻TODH对应的取出随机码RF，通过密钥生成算法FL计算得到KL＝FL。利用KL对TOD信息低段TODL加密后，将同步序列发送至接收方。S2接收方通过频率扫描捕获同步频率，在同步频率上接收同步序列，用接收到的同步序列修正本地TOD，具体步骤如下：2.1.接收方收到同步序列，设接收方当前的TOD高段为TODH′，接收方还是以t为时间间隔，取前4个时刻的TOD高段TODH′、TODH′、TODH、TODH′，5个TODH值对应的随机码分别为：RF′、RF′、RF′、RF、RF′。发送端同样计算出对称密钥，然后根据对称密钥计算出R1至R5。2.2.扫描频组生成我们基于TODH′生成5个频率作为扫描频组1，基于TODH′生成5个频率作为扫描频组2，以此类推，生成5个扫描频组，共计25个扫描频率。具体如下：频组1：频组2：频组3：频组4：频组5：2.3.接收方通过这五个频率组对发送方的五个频率进行慢扫描。慢扫描各类结果如下：假设现在发送方在t0发送了5个频率，因为我们这个方案里频率是跟3个参数相关的，就写成下面的形式：TODH,RF,R1→f1TODH,RF,R2→f2TODH,RF,R3→f3TODH,RF,R4→f4TODH,RF,R5→f5接收方在t′0生成5个扫描频组如下：频组1：频组2：频组3：频组4：频组5：因为我们频率里面有R1到R5在，所以是用f′1、f′6、f′11、f′16、f′21去匹配f1，用f′2、f′7、f′12、f′17、f′22去匹配f2，以此类推。假如TODH′和TODH相等，那用频组1去扫描时，就会扫描得到f′1＝f1，此时就说明接收方本地TOD的高段与发送方本地TOD的高段一致。假如TODH′和TODH相等，那用频组1去扫描时，就会发现频组1里面所有频率不匹配，频组2中f′6＝f1，频组3中f′12＝f2，频组4中f′18＝f3，频组5中f′24＝f4。那么此时接收方本地TOD的高段要滞后发送方本地TOD高段一个t的时差，此时校正接收方本地TOD的高段，实现同步跟跳，在同步频率上，接收方接收同步序列。2.3.接收方利用更新后的本地TOD高段TODH″，根据前文所述方式计算得到对应的随机码RF0”。利用密钥生成算法FL计算得到KL”＝FL。接收方利用KL”对同步序列中TODL信息进行解密，得到发送方的TODL，根据接收方的TODL校正自身本地TOD的低段，完成跳频同步。以上所述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本发明的几种实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干变形和改进，这些都属于本发明的保护范围。因此，本发明专利的保护范围应以所附权利要求为准。
