标题title
视频网站内传播恶意软件的检测方法、装置、设备及介质
摘要abst
本发明提供了一种视频网站内传播恶意软件的检测方法、装置、设备及介质，方法包括：获取待检测视频文件的相关字符信息；待检测视频文件为用户上传至目标视频网站的视频文件；检测待检测视频文件的相关字符信息中是否存在可疑下载链接；若存在，则根据待检测视频文件的上传时间确定检测时间范围；确定用户是否在检测时间范围内，向目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且其它视频文件的数量超出设定数量阈值，若是，则确定待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。本方案，无需下载链接中的软件并分析，即可检测出视频文件的相关字符信息中的下载链接是否用于传播恶意软件。
权利要求书clms
1.一种视频网站内传播恶意软件的检测方法，其特征在于，包括：获取待检测视频文件的相关字符信息；所述待检测视频文件为用户上传至目标视频网站的视频文件；检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接；若存在，则根据所述待检测视频文件的上传时间确定检测时间范围；确定所述用户是否在所述检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且所述其它视频文件的数量超出设定数量阈值；若是，则确定所述待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。2.根据权利要求1所述的方法，其特征在于，确定相关字符信息存在可疑下载链接的方式，包括：确定相关字符信息中是否存在下载链接；若存在，则确定该相关字符信息中是否存在语义为密码的字符、所述下载链接是否为短链接以及所述下载链接是否为用于跳转至链接分享页面的链接中的一种或多种，若是，则确定该相关字符信息中存在可疑下载链接。3.根据权利要求1所述的方法，其特征在于，在所述获取待检测视频文件的相关字符信息之后，检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接之前，还包括：确定所述待检测视频文件的内容是否为预设敏感内容，若是，则执行所述检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接。4.根据权利要求1所述的方法，其特征在于，还包括：将所述其它视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接。5.根据权利要求4所述的方法，其特征在于，还包括：基于被确定为传播恶意软件的链接的恶意视频文件，确定恶意视频文件中上传的最早时间和最晚时间；确定所述用户是否在所述最早时间前的第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第一视频文件，若是，将所述第一视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第一视频文件确定为恶意视频文件，并更新所述最早时间；确定用户是否在所述最晚时间后的所述第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第二视频文件，若是，将所述第二视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第二视频文件确定为恶意视频文件，并更新所述最晚时间。6.根据权利要求1-5中任一所述的方法，其特征在于，所述根据所述待检测视频文件的上传时间确定检测时间范围，包括：根据第二时间阈值和所述待检测视频文件的上传时间，确定检测时间范围；其中，所述检测时间范围的两个时间端点值之差等于所述第二时间阈值，且所述待检测视频文件的上传时间位于所述检测时间范围内。7.根据权利要求6所述的方法，其特征在于，所述根据第二时间阈值和所述待检测视频文件的上传时间，确定检测时间范围，包括：将比所述待检测视频文件的上传时间早所述第二时间阈值的时间，以及所述待检测视频文件的上传时间，确定为初始检测时间范围的两个端点时间；确定该用户是否在该初始检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件；若存在，则将其它视频文件中距离所述待检测视频文件的上传时间最远的上传时间确定为第一端点时间，将比所述第一端点时间晚所述第二时间阈值的时间确定为第二端点时间，将所述第一端点时间至所述第二端点时间的时间范围确定为最终的检测时间范围；若不存在，则将所述待检测视频文件的上传时间，以及比所述待检测视频文件的上传时间晚所述第二时间阈值的时间，确定为最终的检测时间范围的两个端点时间。8.一种视频网站内传播恶意软件的检测装置，其特征在于，包括：字符获取单元，用于获取待检测视频文件的相关字符信息；所述待检测视频文件为用户上传至目标视频网站的视频文件；恶意检测单元，用于检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接；若存在，则触发时间范围确定单元执行相应操作；所述时间范围确定单元，用于根据所述待检测视频文件的上传时间确定检测时间范围；所述恶意检测单元，还用于确定所述用户是否在所述检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且所述其它视频文件的数量超出设定数量阈值，若是，则确定所述待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。9.一种计算设备，包括存储器和处理器，所述存储器中存储有计算机程序，所述处理器执行所述计算机程序时，实现如权利要求1-7中任一项所述的方法。10.一种计算机可读存储介质，其上存储有计算机程序，当所述计算机程序在计算机中执行时，令计算机执行权利要求1-7中任一项所述的方法。
说明书desc
技术领域本发明实施例涉及网络安全技术领域，特别涉及一种视频网站内传播恶意软件的检测方法、装置、设备及介质。背景技术随着互联网的快速发展，人们在享受着网络带来便利的同时，也带来了安全隐患。攻击者开发了窃密木马、勒索软件、挖矿木马等多种恶意代码，尝试通过多种途径入侵用户的计算机以谋取不法收益，其中较为常见的一种途径为借助视频网站传播。攻击者通过在视频网站中上传用于介绍某种软件的视频文件，并在视频文件的相关字符信息中比如标题、文字描述中提供该软件的下载链接，而实际情况下该软件为恶意软件。由于视频网站是合法的，用户通常不会怀疑下载链接的真实性。并且，视频网站目前仅对上传的视频内容是否合规进行检测，并不会对相关字符信息中包括的链接下载得到的文件安全性进行检测。因此，亟需提供一种视频网站内传播恶意软件的检测方法。发明内容基于视频网站仅对上传视频内容是否回归进行检测，而不会对相关字符信息中包括的链接下载得到的文件安全性进行检测的问题，本发明实施例提供了一种视频网站内传播恶意软件的检测方法、装置、设备及介质，能够检测出视频文件的相关字符信息中的下载链接是否用于传播恶意软件。第一方面，本发明实施例提供了一种视频网站内传播恶意软件的检测方法，包括：获取待检测视频文件的相关字符信息；所述待检测视频文件为用户上传至目标视频网站的视频文件；检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接；若存在，则根据所述待检测视频文件的上传时间确定检测时间范围；确定所述用户是否在所述检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且所述其它视频文件的数量超出设定数量阈值，若是，则确定所述待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。优选地，确定相关字符信息存在可疑下载链接的方式，包括：确定相关字符信息中是否存在下载链接；若存在，则确定该相关字符信息中是否存在语义为密码的字符、所述下载链接是否为短链接以及所述下载链接是否为用于跳转至链接分享页面的链接中的一种或多种，若是，则确定该相关字符信息中存在可疑下载链接。优选地，在所述获取待检测视频文件的相关字符信息之后，检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接之前，还包括：确定所述待检测视频文件的内容是否为预设敏感内容，若是，则执行所述检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接。优选地，还包括：将所述其它视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接。优选地，还包括：基于被确定为传播恶意软件的链接的恶意视频文件，确定恶意视频文件中上传的最早时间和最晚时间；确定所述用户是否在所述最早时间前的第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第一视频文件，若是，将所述第一视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第一视频文件确定为恶意视频文件，并更新所述最早时间；确定该用户是否在所述最晚时间后的所述第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第二视频文件，若是，将所述第二视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第二视频文件确定为恶意视频文件，并更新所述最晚时间。优选地，所述根据所述待检测视频文件的上传时间确定检测时间范围，包括：根据第二时间阈值和所述待检测视频文件的上传时间，确定检测时间范围；其中，所述检测时间范围的两个时间端点值之差等于所述第二时间阈值，且所述待检测视频文件的上传时间位于所述检测时间范围内。优选地，所述根据第二时间阈值和所述待检测视频文件的上传时间，确定检测时间范围，包括：将比所述待检测视频文件的上传时间早所述第二时间阈值的时间，以及所述待检测视频文件的上传时间，确定为初始检测时间范围的两个端点时间；确定该用户是否在该初始检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件；若存在，则将该其它视频文件中距离所述待检测视频文件的上传时间最远的上传时间确定为第一端点时间，将比所述第一端点时间晚所述第二时间阈值的时间确定为第二端点时间，将所述第一端点时间至所述第二端点时间的时间范围确定为最终的检测时间范围；若不存在，则将所述待检测视频文件的上传时间，以及比所述待检测视频文件的上传时间晚所述第二时间阈值的时间，确定为最终的检测时间范围的两个端点时间。第二方面，本发明实施例还提供了一种视频网站内传播恶意软件的检测装置，包括：字符获取单元，用于获取待检测视频文件的相关字符信息；所述待检测视频文件为用户上传至目标视频网站的视频文件；恶意检测单元，用于检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接；若存在，则触发时间范围确定单元执行相应操作；所述时间范围确定单元，用于根据所述待检测视频文件的上传时间确定检测时间范围；所述恶意检测单元，还用于确定所述用户是否在所述检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且所述其它视频文件的数量超出设定数量阈值，若是，则确定所述待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。第三方面，本发明实施例还提供了一种计算设备，包括存储器和处理器，所述存储器中存储有计算机程序，所述处理器执行所述计算机程序时，实现本说明书任一实施例所述的方法。第四方面，本发明实施例还提供了一种计算机可读存储介质，其上存储有计算机程序，当所述计算机程序在计算机中执行时，令计算机执行本说明书任一实施例所述的方法。本发明实施例提供了一种视频网站内传播恶意软件的检测方法、装置、设备及介质，当待检测视频文件的相关字符信息中存在可疑下载链接，且该用户在一段检测时间范围内上传了超出设定数量阈值且相关字符信息中存在可疑下载链接的其它视频文件，则表明该用户在利用视频网站传播恶意软件，将该待检测视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接。可见本方案无需下载链接中的软件并分析，即可检测出视频文件的相关字符信息中的下载链接是否用于传播恶意软件。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明一实施例提供的一种视频网站内传播恶意软件的检测方法流程图；图2是本发明一实施例提供的一种计算设备的硬件架构图；图3是本发明一实施例提供的一种视频网站内传播恶意软件的检测装置结构图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例，基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。如前所述，攻击者通过在视频网站中上传用于介绍某种软件的视频文件，并在视频文件的相关字符信息中比如标题、文字描述中提供该软件的下载链接，而实际情况下该软件为恶意软件。由于视频网站是合法的，用户通常不会怀疑下载链接的真实性。并且，视频网站目前仅对上传的视频内容是否合规进行检测，并不会对相关字符信息中包括的链接下载得到的文件安全性进行检测。基于该问题，若直接通过链接下载软件，并对下载得到的软件分析其安全性，不仅消耗资源，且检测成本和检测效率均较高。若能够在不下载软件的情况下，检测出该链接是用于传播恶意软件的链接，则可以大大减少系统资源。考虑到正常情况下，用户在一个较短时间范围内向视频网站上传视频文件的数量一般不会太多，若同一个用户在较短时间范围内向视频网站上传视频文件的数量较大，且这些视频文件的相关字符信息中均存在可疑下载链接，则这些可疑下载链接是传播恶意软件的链接的概率会非常大，因此，可疑基于该特征实现视频网站内传播恶意软件的检测。下面描述以上构思的具体实现方式。请参考图1，本发明实施例提供了一种视频网站内传播恶意软件的检测方法，该方法包括：步骤100，获取待检测视频文件的相关字符信息；所述待检测视频文件为用户上传至目标视频网站的视频文件；步骤102，检测待检测视频文件的相关字符信息中是否存在可疑下载链接；步骤104，若存在，则根据所述待检测视频文件的上传时间确定检测时间范围；步骤106，确定所述用户是否在所述检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且所述其它视频文件的数量超出设定数量阈值；若是，则确定所述待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。本发明实施例中，当待检测视频文件的相关字符信息中存在可疑下载链接，且该用户在一段检测时间范围内上传了超出设定数量阈值且相关字符信息中存在可疑下载链接的其它视频文件，则表明该用户在利用视频网站传播恶意软件，将该待检测视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接。可见本方案无需下载链接中的软件并分析，即可检测出视频文件的相关字符信息中的下载链接是否用于传播恶意软件。下面描述图1所示的各个步骤的执行方式。首先针对步骤100，获取待检测视频文件的相关字符信息；所述待检测视频文件为用户上传至目标视频网站的视频文件。本实施例可以应用在任意可提供用户上传视频文件的视频网站中，比如，该目标视频网站为Youtube、Bilibili等。本实施例中，可以每检测到用户上传视频文件后，则执行检测过程，也可以是设定检测周期，每当到达该检测周期时，则对该检测周期内上传的视频文件进行检测。由于视频文件在上传到目标视频网站时需要添加该视频文件的标题、用于简介视频内容的文字描述等，因此，将这些除视频文件以外的且与视频文件相关的标题、文字描述等内容确定为视频文件的相关字符信息。然后针对步骤102，检测待检测视频文件的相关字符信息中是否存在可疑下载链接。本发明一个实施例中，可以通过如下方式确定相关字符信息存在可疑下载链接，包括：S21、确定相关字符信息中是否存在下载链接。其中，可以通过检测相关字符信息中是否存在“下载”“download”等语义为“下载”的字样确定是否存在下载链接，或者，还可以通过检测相关字符信息中是否存在网址来确定是否存在下载链接。需要说明的是，若相关字符信息中不存在下载链接，则结束对该待检测视频文件的检测，继续对下一个视频文件进行检测。S22、若存在，则确定该相关字符信息中是否存在语义为密码的字符、该下载链接是否为短链接以及该下载链接是否为用于跳转至链接分享页面的链接中的一种或多种，若是，则确定该相关字符信息中存在可疑下载链接。本步骤S22中，需要判定相关字符信息中存在的下载链接是否为可疑下载链接，判定方式至少可以包括如下三种：第一种判定方式、相关字符信息中还存在语义为“密码”的字符。第二种判定方式、该下载链接为短链接。第三种判定方式、该下载链接为用于跳转至链接分享页面的链接。下面对上述三种判定方式分别进行说明。在第一种判定方式中，由于用户通过下载链接下载得到软件之后，用户终端设备上的杀毒软件会对下载的该软件进行病毒检测，攻击者为了避免软件下载后被杀毒软件检测出该软件为恶意软件的情况，对软件进行加密，并将密码提供在相关字符信息中。若相关字符信息中包含语义为“密码”的字样，则表明该下载链接是用于传播恶意软件的概率较大。因此，通过判定相关字符信息中是否包含语义为“密码”字样，若包括，则将该相关字符信息中存在的下载链接确定为可疑下载链接。在第二种判定方式中，短链接是对原始长链接执行短链接生成算法后转换得来的，举例来说，对于原始长链接http://ganmall.com.cn/h/detail/366.html，采用短链接生成算法，得到短链接为http://980.so/k4e8，将k4e8--＞http://ganmall.com.cn/h/detail/366.html的关系保存到数据库中，当用户访问http://980.so/k4e8网址时，系统到数据库找到对应的URL地址，实现跳转。可见采用短链接，可疑提高用户原址的隐蔽性，增加了溯源难度，若下载链接采用短链接，则表明用户不希望被溯源到，进一步表明该短链接下载得到的软件是恶意软件的概率较大，因此，通过判定下载链接是否为短链接，若是短链接，则将该相关字符信息中存在的下载链接确定为可疑下载链接。在该第二种判定方式之前，可以预先收集恶意软件经常使用的短链接特征，比如，分析短链接满足字符串特征、字符串格式等特征，若检测到下载链接满足这些短链接特征，则确定该下载链接为短链接。在第三种判定方式中，与短链接同理，攻击者为了提高用户原址的隐蔽性，增加溯源难度，在将恶意软件放置在文件共享站点之后，还可以使用链接分享页面的制作网站制作一个可以跳转至链接分享页面的链接。若下载链接采用可以跳转至链接分享页面的链接，则表明用户不希望被溯源到，进一步表明该下载链接下载得到的软件是恶意软件的概率较大，因此，可以通过判定下载链接是否为用于跳转至链接分享页面的链接，若是，则将该相关字符信息中存在的下载链接确定为可疑下载链接。在该第三种判定方式之前，可以预先收集恶意软件经常使用的链接分享页面制作网站，以及使用这些制作网站制作出的链接特征，比如，采用taplink.cc网站制作出来的链接中包含“taplink.cc”特征字符，若检测到下载链接中包含这些特征字符，则确定该下载链接为用于跳转至链接分享页面的链接。考虑到攻击者一般会通过发布视频内容为软件破解、注册工具、操作指南、加密货币、挖矿、游戏外挂、VPN软件等的视频文件，来吸引用户观看，并在相关字符信息中提供下载链接以引导用户下载软件，因此，在本发明一个实施例中，在步骤100之后，步骤102之前，还可以包括：确定所述待检测视频文件的内容是否为预设敏感内容，若是，则执行所述检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接。其中，该预设敏感内容可以为软件破解、注册工具、操作指南、加密货币、挖矿、游戏外挂和VPN软件中的一种或多种，可以基于相关字符信息确定待检测视频文件的内容。通过检测视频内容是否为预设敏感内容来进一步提高检测效率。接下来针对步骤104，若存在，则根据所述待检测视频文件的上传时间确定检测时间范围。本发明一个实施例中，根据待检测视频文件的上传时间确定检测时间范围的方式可以包括：根据第二时间阈值和待检测视频文件的上传时间，确定检测时间范围；其中，该检测时间范围的两个时间端点值之差等于所述第二时间阈值，且该待检测视频文件的上传时间位于该检测时间范围内。其中，满足上述特征的检测时间范围至少可以包括：、、。其中，t为该待检测视频文件的上传时间，t0为第二时间阈值。由于该检测时间范围确定的目的，是为了确定该检测时间范围内该用户是否向目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，以及该其它视频文件的数量，用来与设定数量阈值进行比较，根据比较结果确定该可以下载链接是否为传播恶意软件的链接，因此，该检测时间范围的确定非常重要，如果确定结果存在偏差，该偏差导致其它视频文件的数量未能超过设定数量阈值，使得本应该是传播恶意软件的链接，检测结果为不是传播恶意软件的链接，给用户安全性带来极大隐患。举例来说，设定数量阈值为5个，第二时间阈值为30分钟，待检测视频文件的上传时间为8:10，该用户还在8:00、8:05、8:15、8:20、8:25上传了相关字符信息中存在可疑下载链接的其它视频文件。若检测时间范围确定为，则其它视频文件的数量为2个，检测结果为该下载链接不是传播恶意软件的链接。若检测时间范围确定为，则其它视频文件的数量为2个，检测结果同样为该下载链接不是传播恶意软件的链接。若检测时间范围确定为，则其它视频文件的数量为5个，检测结果则为该下载链接是传播恶意软件的链接。可见，若检测时间范围存在偏差，会对检测结果的是与否造成影响。因此，需要保证确定的检测时间范围能够得出准确的检测结果。在本发明一个实施例中，为保证确定的检测时间范围能够得出准确的检测结果，可以通过如下方式以根据第二时间阈值和所述待检测视频文件的上传时间确定检测时间范围，具体包括：S40、将比所述待检测视频文件的上传时间早所述第二时间阈值的时间，以及所述待检测视频文件的上传时间，确定为初始检测时间范围的两个端点时间。该初始检测时间范围为，其中，t为该待检测视频文件的上传时间，t0为第二时间阈值。继续以上举例为例，该初始检测时间范围为。S41、确定该用户是否在该初始检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件。根据上述举例可知，在该初始检测时间范围内上传了2个其它视频文件，上传时间分别为8:00和8:05。S42、若存在，则将该其它视频文件中距离所述待检测视频文件的上传时间最远的上传时间确定为第一端点时间，将比所述第一端点时间晚所述第二时间阈值的时间确定为第二端点时间，将所述第一端点时间至所述第二端点时间的时间范围确定为最终的检测时间范围。可以理解，举例待检测视频文件的上传时间8:10最远的上传时间为8:00，将8:00确定为第一端点时间，第二端点时间为8:30，如此可出最终的检测时间范围为。S43、若不存在，则将所述待检测视频文件的上传时间，以及比所述待检测视频文件的上传时间晚所述第二时间阈值的时间，确定为最终的检测时间范围的两个端点时间。若不存在，则最终的检测时间范围为。通过上述步骤S40-S43确定的检测时间范围偏差较小，使得利用该检测时间范围检测出的结果更加准确，进一步提高用户安全性。最后针对步骤106，确定该用户是否在所述检测时间范围内，向目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且该其它视频文件的数量超出设定数量阈值；若是，则确定所述待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。在确定该用户是否向目标视频网站上传其它视频文件时，可以基于该用户标识对目标视频网站上传的视频文件进行遍历，也可以直接定位到该用户的主页确定该用户上传的各视频文件的信息。本步骤中在确定其它视频文件的相关字符信息中是否存在可疑下载链接的方式与步骤102中的确定方式相同，本实施例在此不在赘述。若该其它视频文件的数量超出设定数量阈值，且该其它视频文件的相关字符信息中也均存在可疑下载链接，因此，可疑判定该待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。进一步地，由于该待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接，且该其它视频文件的相关字符信息中也同样存在可疑下载链接，因此，本发明一个实施例中，还可以包括：将该其它视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接。如此，无需对其它视频文件按照本实施例的各步骤进行再次检测，不仅可以降低计算量，且可以提高对该用户上传的其它视频文件的检测效率以及准确性。在本发明一个实施例中，当将其它视频文件相关字符信息中存在的可疑下载链接同样确定为传播恶意软件的链接之后，则可以判定该用户为恶意用户，其上传的其它视频文件存在传播恶意软件的概率较大，因此，为了进一步提高检测效率，还可以通过如下方式对该用户上传的其它未被确定为传播恶意软件的链接的恶意视频文件的视频文件进行快速检测：S60、基于被确定为传播恶意软件的链接的恶意视频文件，确定恶意视频文件中上传的最早时间和最晚时间。由于通过上述方式确定出的恶意视频文件其上传时间是具有连续性的，因此，可以确定出恶意视频文件中上传的最早时间和最晚时间。比如，用户在7:48、7:56、8:00、8:05、8:10、8:15、8:20、8:25、8:32、8:40、18:00均上传了视频文件，而7:48上传的视频文件相关字符信息中不包括下载链接，利用上述方式确定了8:00、8:05、8:10、8:15、8:20、8:25上传的视频文件均为恶意视频文件，那么此时确定的该最早时间为8:00，最晚时间为8:25。S61、确定该用户是否在该最早时间前的第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第一视频文件，若是，将所述第一视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第一视频文件确定为恶意视频文件，并更新该最早时间。由于第二时间阈值是针对上传数量与设定数量阈值进行比较的，而第一时间阈值是用于确定距离恶意视频文件上传时间较近的一个时间段内是否还上传存在可疑下载链接的视频文件，因此，该第一时间阈值小于该第二时间阈值，比如，第一时间阈值为10分钟，那么该比该最早时间早第一时间阈值的时间范围为，可知在7:50上传的视频文件为第一视频文件，将该在7:50上传的视频文件确定为恶意视频文件，此时步骤S60中的最早时间更新为7:50，而7:48上传的视频文件相关字符信息中不包括下载链接，因此7:48上传的视频文件不是恶意视频文件。需要说明的是，在该步骤S61中，若确定该用户在该最早时间前的第一时间阈值的时间范围内，未向所述目标视频网站上传相关字符信息中存在可疑下载链接的第一视频文件，则停止对最早时间前上传的视频文件的检测。S62、确定该用户是否在该最晚时间晚所述第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第二视频文件，若是，将所述第二视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第二视频文件确定为恶意视频文件，并更新该最晚时间。基于S61中的举例，该用户是否在晚于该最晚时间为所述第一时间阈值的时间范围为，因此，8:32上传的视频文件为第二视频文件，此时最晚时间更新为8:32，进一步确定8:40上传的视频文件为第二视频文件，而18:00上传的视频文件不在第一时间阈值的时间范围内，因此18:00上传的视频文件不是恶意视频文件。需要说明的是，在该步骤S62中，若确定该用户在该最晚时间晚所述第一时间阈值的时间范围内，未向所述目标视频网站上传相关字符信息中存在可疑下载链接的第二视频文件，则停止对最晚时间后上传的视频文件的检测。通过上述方式逐渐迭代检测该用户上传的各视频文件，从而可以快速确定出该用户上传的各视频文件是否为恶意视频文件，其相关字符信息中存在的下载链接是否为用于传播恶意软件的链接。需要说明的是，上述S61和S62不具有先后执行顺序，两个步骤可以同时执行。如图2、图3所示，本发明实施例提供了一种视频网站内传播恶意软件的检测装置。装置实施例可以通过软件实现，也可以通过硬件或者软硬件结合的方式实现。从硬件层面而言，如图2所示，为本发明实施例提供的一种视频网站内传播恶意软件的检测装置所在计算设备的一种硬件架构图，除了图2所示的处理器、内存、网络接口、以及非易失性存储器之外，实施例中装置所在的计算设备通常还可以包括其他硬件，如负责处理报文的转发芯片等等。以软件实现为例，如图3所示，作为一个逻辑意义上的装置，是通过其所在计算设备的CPU将非易失性存储器中对应的计算机程序读取到内存中运行形成的。本实施例提供的一种视频网站内传播恶意软件的检测装置，包括：字符获取单元301，用于获取待检测视频文件的相关字符信息；所述待检测视频文件为用户上传至目标视频网站的视频文件；恶意检测单元302，用于检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接；若存在，则触发时间范围确定单元303执行相应操作；所述时间范围确定单元303，用于根据所述待检测视频文件的上传时间确定检测时间范围；所述恶意检测单元302，还用于确定所述用户是否在所述检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件，且所述其它视频文件的数量超出设定数量阈值，若是，则确定所述待检测视频文件的相关字符信息中存在的可疑下载链接为传播恶意软件的链接。在本发明一个实施例中，恶意检测单元302在确定相关字符信息存在可疑下载链接时，具体用于确定相关字符信息中是否存在下载链接；若存在，则确定该相关字符信息中是否存在语义为密码的字符、所述下载链接是否为短链接以及以及所述下载链接是否为用于跳转至链接分享页面的链接中的一种或多种，若是，则确定该相关字符信息中存在可疑下载链接。在本发明一个实施例中，所述恶意检测单元302，还用于确定所述待检测视频文件的内容是否为预设敏感内容，若是，则执行所述检测所述待检测视频文件的相关字符信息中是否存在可疑下载链接。在本发明一个实施例中，所述恶意检测单元302，还用于将所述其它视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接。在本发明一个实施例中，所述恶意检测单元302，还用于基于被确定为传播恶意软件的链接的恶意视频文件，确定恶意视频文件中上传的最早时间和最晚时间；确定所述用户是否在该最早时间前的第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第一视频文件，若是，将所述第一视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第一视频文件确定为恶意视频文件，并更新所述最早时间；确定所述用户是否在该最晚时间后的所述第一时间阈值的时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的第二视频文件，若是，将所述第二视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接，以及将所述第二视频文件确定为恶意视频文件，并更新所述最晚时间。在本发明一个实施例中，所述时间范围确定单元303，具体用于根据第二时间阈值和所述待检测视频文件的上传时间，确定检测时间范围；其中，所述检测时间范围的两个时间端点值之差等于所述第二时间阈值，且所述待检测视频文件的上传时间位于所述检测时间范围内。在本发明一个实施例中，所述时间范围确定单元303在根据第二时间阈值和所述待检测视频文件的上传时间确定检测时间范围时，具体用于将比所述待检测视频文件的上传时间早所述第二时间阈值的时间，以及所述待检测视频文件的上传时间，确定为初始检测时间范围的两个端点时间；确定该用户是否在该初始检测时间范围内，向所述目标视频网站上传相关字符信息中存在可疑下载链接的其它视频文件；若存在，则将该其它视频文件中距离所述待检测视频文件的上传时间最远的上传时间确定为第一端点时间，将比所述第一端点时间晚所述第二时间阈值的时间确定为第二端点时间，将所述第一端点时间至所述第二端点时间的时间范围确定为最终的检测时间范围；若不存在，则将所述待检测视频文件的上传时间，以及比所述待检测视频文件的上传时间晚所述第二时间阈值的时间，确定为最终的检测时间范围的两个端点时间。可以理解的是，本发明实施例示意的结构并不构成对一种视频网站内传播恶意软件的检测装置的具体限定。在本发明的另一些实施例中，一种视频网站内传播恶意软件的检测装置可以包括比图示更多或者更少的部件，或者组合某些部件，或者拆分某些部件，或者不同的部件布置。图示的部件可以以硬件、软件或者软件和硬件的组合来实现。上述装置内的各模块之间的信息交互、执行过程等内容，由于与本发明方法实施例基于同一构思，具体内容可参见本发明方法实施例中的叙述，此处不再赘述。本发明实施例还提供了一种计算设备，包括存储器和处理器，所述存储器中存储有计算机程序，所述处理器执行所述计算机程序时，实现本发明任一实施例中的一种视频网站内传播恶意软件的检测方法。本发明实施例还提供了一种计算机可读存储介质，所述计算机可读存储介质上存储有计算机程序，所述计算机程序在被处理器执行时，使所述处理器执行本发明任一实施例中的一种视频网站内传播恶意软件的检测方法。具体地，可以提供配有存储介质的系统或者装置，在该存储介质上存储着实现上述实施例中任一实施例的功能的软件程序代码，且使该系统或者装置的计算机读出并执行存储在存储介质中的程序代码。在这种情况下，从存储介质读取的程序代码本身可实现上述实施例中任何一项实施例的功能，因此程序代码和存储程序代码的存储介质构成了本发明的一部分。用于提供程序代码的存储介质实施例包括软盘、硬盘、磁光盘、光盘、磁带、非易失性存储卡和ROM。可选择地，可以由通信网络从服务器计算机上下载程序代码。此外，应该清楚的是，不仅可以通过执行计算机所读出的程序代码，而且可以通过基于程序代码的指令使计算机上操作的操作系统等来完成部分或者全部的实际操作，从而实现上述实施例中任意一项实施例的功能。此外，可以理解的是，将由存储介质读出的程序代码写到插入计算机内的扩展板中所设置的存储器中或者写到与计算机相连接的扩展模块中设置的存储器中，随后基于程序代码的指令使安装在扩展板或者扩展模块上的CPU等来执行部分和全部实际操作，从而实现上述实施例中任一实施例的功能。本发明各实施例至少具有如下有益效果：1、在本发明一个实施例中，当待检测视频文件的相关字符信息中存在可疑下载链接，且该用户在一段检测时间范围内上传了超出设定数量阈值且相关字符信息中存在可疑下载链接的其它视频文件，则表明该用户在利用视频网站传播恶意软件，将该待检测视频文件的相关字符信息中存在的可疑下载链接确定为传播恶意软件的链接。可见本方案无需下载链接中的软件并分析，即可检测出视频文件的相关字符信息中的下载链接是否用于传播恶意软件。2、在本发明一个实施例中，通过确定该相关字符信息中是否存在语义为密码的字符、该下载链接是否为短链接以及该下载链接是否为用于跳转至链接分享页面的链接中的一种或多种，来确定该相关字符信息中是否存在可疑下载链接，可以基于攻击者意图更高概率的确定出该下载链接是否为可疑下载链接。3、在本发明一个实施例中，利用时间阈值和待检测视频文件的上传时间确定初始检测时间范围，然后利用初始检测时间范围确定出最终的检测时间范围，该方式确定得到的检测时间范围偏差较小，使得利用该检测时间范围检测出的结果更加准确，进一步提高用户安全性。4、在本发明一个实施例中，基于被确定为传播恶意软件的链接的恶意视频文件，确定恶意视频文件中上传的最早时间和最晚时间，然后利用最早时间和最晚时间迭代检测该用户上传的各视频文件，从而可以快速确定出该用户上传的各视频文件是否为恶意视频文件，其相关字符信息中存在的下载链接是否为用于传播恶意软件的链接。需要说明的是，在本文中，诸如第一和第二之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。而且，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个…”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同因素。本领域普通技术人员可以理解：实现上述方法实施例的全部或部分步骤可以通过程序指令相关的硬件来完成，前述的程序可以存储在计算机可读取的存储介质中，该程序在执行时，执行包括上述方法实施例的步骤；而前述的存储介质包括：ROM、RAM、磁碟或者光盘等各种可以存储程序代码的介质中。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
