标题title
Modbus TCP协议通信方法及通信系统
摘要abst
本发明提供一种Modbus TCP协议通信方法及通信系统，Modbus客户端与Modbus服务端建立至少两条Modbus TCP路径，并通过这至少两条Modbus TCP路径与Modbus服务端进行信息交互，这样即使其中的某一条Modbus TCP路径故障或中断，Modbus客户端与Modbus服务端之间仍可通过其他的Modbus TCP路径正常的进行信息交互，从而可提升Modbus通信的可靠性；另外，本发明实施例中，Modbus客户端和Modbus服务端对重复消息进行重复处理，可在提升通信的可靠性的同时，保证资源利用率以及消息处理的及时性。
权利要求书clms
1.一种Modbus TCP协议通信方法，其特征在于，包括：Modbus客户端向Modbus服务端发送至少两个Modbus TCP建链帧，以与所述Modbus服务端建立至少两条Modbus TCP路径；所述Modbus TCP建链帧包括所述Modbus客户端的唯一识别标识，以供所述Modbus服务端根据所述唯一识别标识识别发送所述Modbus TCP建链帧的Modbus客户端，并根据识别结果控制建立所述至少两条Modbus TCP路径；所述Modbus客户端将待发送的第一消息通过所述至少两条Modbus TCP路径同时向所述Modbus服务端发送，并通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的第二消息；所述Modbus客户端将通过所述至少两条Modbus TCP路径接收的所述第二消息进行去重处理，并仅对重复的所述第二消息中的一个进行处理。2.如权利要求1所述的Modbus TCP协议通信方法，其特征在于，所述Modbus客户端向Modbus服务端发送至少两个Modbus TCP建链帧包括：所述Modbus客户端向所述Modbus服务端发送UDP组播报文以请求获取所述Modbus服务端的IP地址和端口；所述Modbus客户端根据获取的所述Modbus服务端的IP地址和端口生成所述至少两个Modbus TCP建链帧，并将生成的所述至少两个Modbus TCP建链帧发送至所述Modbus服务端。3.如权利要求1或2所述的Modbus TCP协议通信方法，其特征在于，所述Modbus客户端将待发送的第一消息通过所述至少两条Modbus TCP路径同时向所述Modbus服务端发送包括：所述Modbus客户端构建包含所述第一消息的第一Modbus消息帧，所述第一Modbus消息帧中包含第一帧序号，不同的所述第一Modbus消息帧中的所述第一帧序号不同；所述Modbus客户端将所述第一Modbus消息帧分别通过所述至少两条Modbus TCP路径同时向所述Modbus服务端发送。4.如权利要求1或2所述的Modbus TCP协议通信方法，其特征在于，所述Modbus客户端通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的第二消息包括：所述Modbus客户端通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的携带所述第二消息的第二Modbus消息帧，所述第二Modbus消息帧包括第二帧序号；所述Modbus客户端将通过所述至少两条Modbus TCP路径接收的所述第二消息进行去重处理，并仅对重复的所述第二消息中的一个进行处理包括：所述Modbus客户端筛选出第二帧序号相同的各所述第二Modbus消息帧作为重复的第二Modbus消息帧，并仅对所述重复的第二Modbus消息帧中的一个第二Modbus消息帧进行处理。5.如权利要求4所述的Modbus TCP协议通信方法，其特征在于，所述Modbus TCP协议通信方法还包括：所述Modbus客户端筛选出第二帧序号相同的各所述第二Modbus消息帧作为重复的第二Modbus消息帧后，还包括按第一预警比对规则判断重复的第二Modbus消息帧的个数与所述Modbus TCP路径的条数是否相同，如否，则发送第一通信链路异常预警信息。6.一种Modbus TCP协议通信方法，其特征在于，包括：Modbus服务端的负载均衡器接收Modbus客户端发送的至少两个Modbus TCP建链帧，所述Modbus TCP建链帧包括所述Modbus客户端的唯一识别标识；所述Modbus服务端的负载均衡器根据所述唯一识别标识，将来自同一所述Modbus客户端的所述Modbus TCP建链帧在所述Modbus服务端的同一Modbus处理模块和所述Modbus客户端之间建立至少两条Modbus TCP路径；所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的第一消息，以及通过所述至少两条Modbus TCP路径向所述Modbus客户端发送第二消息；所述Modbus服务端的所述Modbus处理模块将通过所述至少两条Modbus TCP路径接收的所述第一消息进行去重处理，并仅对重复的所述第一消息中的一个进行处理。7.如权利要求6所述的Modbus TCP协议通信方法，其特征在于，所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径向所述Modbus客户端发送第二消息包括：所述Modbus服务端的所述Modbus处理模块构建包含所述第二消息的第二Modbus消息帧，所述第二Modbus消息帧中包含第二帧序号，不同的所述第二Modbus消息帧中的所述第二帧序号不同；所述Modbus服务端的所述Modbus处理模块将所述第二Modbus消息帧分别通过所述至少两条Modbus TCP路径同时向所述Modbus客户端发送。8.如权利要求6或7所述的Modbus TCP协议通信方法，其特征在于，所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的第一消息包括：所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的携带所述第一消息的第一Modbus消息帧，所述第一Modbus消息帧包括第一帧序号；所述Modbus服务端的所述Modbus处理模块将通过所述至少两条Modbus TCP路径接收的所述第一消息进行去重处理，并仅对重复的所述第一消息中的一个进行处理包括：所述Modbus服务端的所述Modbus处理模块筛选出第一帧序号相同的各所述第一Modbus消息帧作为重复的第一Modbus消息帧，并仅对所述重复的第一Modbus消息帧中的一个第一Modbus消息帧进行处理。9.如权利要求8所述的Modbus TCP协议通信方法，其特征在于，所述Modbus TCP协议通信方法还包括：所述Modbus服务端的所述Modbus处理模块筛选出第一帧序号相同的各所述第一Modbus消息帧作为重复的第一Modbus消息帧后，还包括按第二预警比对规则判断重复的第一Modbus消息帧的个数与所述Modbus TCP路径的条数是否相同，如否，则发送第二通信链路异常预警信息。10.一种Modbus TCP协议通信系统，其特征在于，包括Modbus客户端和Modbus服务端，所述Modbus服务端包括负载均衡器和与所述负载均衡器连接的至少一个Modbus处理模块；所述Modbus客户端用于向Modbus服务端发送至少两个Modbus TCP建链帧，以与所述Modbus服务端建立至少两条Modbus TCP路径，所述Modbus TCP建链帧包括所述Modbus客户端的唯一识别标识；以及用于将待发送的第一消息通过所述至少两条Modbus TCP路径同时向所述Modbus服务端发送，并通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的第二消息，将通过所述至少两条Modbus TCP路径接收的所述第二消息进行去重处理，并仅对重复的所述第二消息中的一个进行处理；所述负载均衡器用于接收所述Modbus客户端发送的至少两个Modbus TCP建链帧，根据所述唯一识别标识，将来自同一所述Modbus客户端的所述Modbus TCP建链帧在所述Modbus服务端的同一Modbus处理模块和所述Modbus客户端之间建立至少两条Modbus TCP路径；所述Modbus处理模块用于通过所述至少两条Modbus TCP路径向所述Modbus客户端发送第二消息，以及通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的第一消息，将通过所述至少两条Modbus TCP路径接收的所述第一消息进行去重处理，并仅对重复的所述第一消息中的一个进行处理。
说明书desc
技术领域本发明涉及通信领域，尤其涉及一种Modbus TCP协议通信方法及通信系统。背景技术Modbus是一种串行通信协议，是Modicon公司于1979年为使用PLC通信而发表。Modbus已经成为工业领域通信协议的业界标准，并且现在是工业电子设备之间常用的连接方式。目前业界采用Modbus，主要采用Modbus RTU,Modbus ASCII和Modbus TCP这些传输协议，但是这些传输都只支持单条通信路径，当这条通信路径故障或中断时，就无法进行数据的上传和下行控制。而目前为了满足智能工厂的对生产设备的实时控制要求，业界对通信可靠性提出了5个9*365*24*60＝5.26分钟，表示该系统在连续运行1年时间里最多可能的业务中断时间是5.26分钟)的要求，而由于现有Modbus通信协议无法支持多路径通信，导致其可靠性差，更无法满足业界提出的5个9的可靠性要求。因此，如何提升Modbus通信的可靠性是目前亟需解决的技术问题。发明内容本发明提供了一种Modbus TCP协议通信方法及通信系统，解决现有Modbus通信的可靠性差的问题。为了解决上述问题，本发明实施例提供了一种Modbus TCP协议通信方法，包括：Modbus客户端向Modbus服务端发送至少两个Modbus TCP建链帧，以与所述Modbus服务端建立至少两条Modbus TCP路径；所述Modbus TCP建链帧包括所述Modbus客户端的唯一识别标识，以供所述Modbus服务端根据所述唯一识别标识识别发送所述Modbus TCP建链帧的Modbus客户端，并根据识别结果控制建立所述至少两条Modbus TCP路径；所述Modbus客户端将待发送的第一消息通过所述至少两条Modbus TCP路径同时向所述Modbus服务端发送，并通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的第二消息；所述Modbus客户端将通过所述至少两条Modbus TCP路径接收的所述第二消息进行去重处理，并仅对重复的所述第二消息中的一个进行处理。一些实施例中，所述Modbus客户端向Modbus服务端发送至少两个Modbus TCP建链帧包括：所述Modbus客户端向所述Modbus服务端发送UDP组播报文以请求获取所述Modbus服务端的IP地址和端口；所述Modbus客户端根据获取的所述Modbus服务端的IP地址和端口生成所述至少两个Modbus TCP建链帧，并将生成的所述至少两个Modbus TCP建链帧发送至所述Modbus服务端。一些实施例中，所述Modbus客户端将待发送的第一消息通过所述至少两条ModbusTCP路径同时向所述Modbus服务端发送包括：所述Modbus客户端构建包含所述第一消息的第一Modbus消息帧，所述第一Modbus消息帧中包含第一帧序号，不同的所述第一Modbus消息帧中的所述第一帧序号不同；所述Modbus客户端将所述第一Modbus消息帧分别通过所述至少两条Modbus TCP路径同时向所述Modbus服务端发送。一些实施例中，所述Modbus客户端通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的第二消息包括：所述Modbus客户端通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的携带所述第二消息的第二Modbus消息帧，所述第二Modbus消息帧包括第二帧序号；所述Modbus客户端将通过所述至少两条Modbus TCP路径接收的所述第二消息进行去重处理，并仅对重复的所述第二消息中的一个进行处理包括：所述Modbus客户端筛选出第二帧序号相同的各所述第二Modbus消息帧作为重复的第二Modbus消息帧，并仅对所述重复的第二Modbus消息帧中的一个第二Modbus消息帧进行处理。一些实施例中，所述Modbus TCP协议通信方法还包括：所述Modbus客户端筛选出第二帧序号相同的各所述第二Modbus消息帧作为重复的第二Modbus消息帧后，还包括按第一预警比对规则判断重复的第二Modbus消息帧的个数与所述Modbus TCP路径的条数是否相同，如否，则发送第一通信链路异常预警信息。基于同样的发明构思，本发明实施例还提供了一种Modbus TCP协议通信方法，包括：Modbus服务端的负载均衡器接收Modbus客户端发送的至少两个Modbus TCP建链帧，所述Modbus TCP建链帧包括所述Modbus客户端的唯一识别标识；所述Modbus服务端的负载均衡器根据所述唯一识别标识，将来自同一所述Modbus客户端的所述Modbus TCP建链帧在所述Modbus服务端的同一Modbus处理模块和所述Modbus客户端之间建立至少两条Modbus TCP路径；所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的第一消息，以及通过所述至少两条Modbus TCP路径向所述Modbus客户端发送第二消息；所述Modbus服务端的所述Modbus处理模块将通过所述至少两条Modbus TCP路径接收的所述第一消息进行去重处理，并仅对重复的所述第一消息中的一个进行处理。一些实施例中，所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径向所述Modbus客户端发送第二消息包括：所述Modbus服务端的所述Modbus处理模块构建包含所述第二消息的第二Modbus消息帧，所述第二Modbus消息帧中包含第二帧序号，不同的所述第二Modbus消息帧中的所述第二帧序号不同；所述Modbus服务端的所述Modbus处理模块将所述第二Modbus消息帧分别通过所述至少两条Modbus TCP路径同时向所述Modbus客户端发送。一些实施例中，所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的第一消息包括：所述Modbus服务端的所述Modbus处理模块通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的携带所述第一消息的第一Modbus消息帧，所述第一Modbus消息帧包括第一帧序号；所述Modbus服务端的所述Modbus处理模块将通过所述至少两条Modbus TCP路径接收的所述第一消息进行去重处理，并仅对重复的所述第一消息中的一个进行处理包括：所述Modbus服务端的所述Modbus处理模块筛选出第一帧序号相同的各所述第一Modbus消息帧作为重复的第一Modbus消息帧，并仅对所述重复的第一Modbus消息帧中的一个第一Modbus消息帧进行处理。一些实施例中，所述Modbus TCP协议通信方法还包括：所述Modbus服务端的所述Modbus处理模块筛选出第一帧序号相同的各所述第一Modbus消息帧作为重复的第一Modbus消息帧后，还包括按第二预警比对规则判断重复的第一Modbus消息帧的个数与所述Modbus TCP路径的条数是否相同，如否，则发送第二通信链路异常预警信息。基于同样的发明构思，本发明实施例还提供了一种Modbus TCP协议通信系统，包括Modbus客户端和Modbus服务端，所述Modbus服务端包括负载均衡器和与所述负载均衡器连接的至少一个Modbus处理模块；所述Modbus客户端用于向Modbus服务端发送至少两个Modbus TCP建链帧，以与所述Modbus服务端建立至少两条Modbus TCP路径，所述Modbus TCP建链帧包括所述Modbus客户端的唯一识别标识；以及用于将待发送的第一消息通过所述至少两条Modbus TCP路径同时向所述Modbus服务端发送，并通过所述至少两条Modbus TCP路径接收所述Modbus服务端发送的第二消息，将通过所述至少两条Modbus TCP路径接收的所述第二消息进行去重处理，并仅对重复的所述第二消息中的一个进行处理；所述负载均衡器用于接收所述Modbus客户端发送的至少两个Modbus TCP建链帧，根据所述唯一识别标识，将来自同一所述Modbus客户端的所述Modbus TCP建链帧在所述Modbus服务端的同一Modbus处理模块和所述Modbus客户端之间建立至少两条Modbus TCP路径；所述Modbus处理模块用于通过所述至少两条Modbus TCP路径向所述Modbus客户端发送第二消息，以及通过所述至少两条Modbus TCP路径接收所述Modbus客户端发送的第一消息，将通过所述至少两条Modbus TCP路径接收的所述第一消息进行去重处理，并仅对重复的所述第一消息中的一个进行处理。有益效果：本发明实施例提供的Modbus TCP协议通信方法及通信系统，Modbus客户端向Modbus服务端发送至少两个Modbus TCP建链帧，以与Modbus服务端建立至少两条ModbusTCP路径；Modbus客户端将待发送的第一消息通过建立的至少两条Modbus TCP路径同时向Modbus服务端发送，且可并通过这至少两条Modbus TCP路径接收Modbus服务端发送的第二消息，这样即使其中的某一条Modbus TCP路径故障或中断，Modbus客户端与Modbus服务端之间仍可通过其他的Modbus TCP路径正常的进行信息交互，从而可提升Modbus通信的可靠性，能更好的智能工厂的对生产设备的实时控制要求和可靠性要求；另外，本发明实施例中，Modbus客户端将通过至少两条Modbus TCP路径从Modbus服务端接收的第二消息进行去重处理，并仅对重复的所述第二消息中的一个进行处理；Modbus服务端将通过至少两条Modbus TCP路径从Modbus客户端接收的第一消息进行去重处理，并仅对重复的第一消息中的一个进行处理，从而避免Modbus客户端和Modbus服务端对重复消息进行重复处理，可在提升通信的可靠性的同时，保证资源利用率以及消息处理的及时性。附图说明图1为本发明实施例提供的Modbus TCP协议通信系统结构示意图一；图2为本发明实施例提供的Modbus TCP协议通信系统结构示意图二；图3为本发明实施例提供的Modbus TCP协议通信系统结构示意图三；图4为本发明实施例提供的Modbus客户端侧的Modbus TCP协议通信方法流程示意图；图5-1为本发明实施例提供的Modbus客户端获取IP地址和端口的流程示意图；图5-2为本发明实施例提供的Modbus客户端获取IP地址和端口的过程示意图；图6为本发明实施例提供的Modbus客户端发送第一消息的流程示意图；图7为本发明实施例提供的Modbus服务端侧的Modbus TCP协议通信方法流程示意图；图8为本发明实施例提供的Modbus客户端发送第二消息的流程示意图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，下面通过具体实施方式结合附图对本发明实施例作进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。针对目前业界采用Modbus RTU,Modbus ASCII和Modbus TCP这些传输协议只支持单条通信路径，当这条通信路径故障或中断时，就无法进行数据的上传和下行控制，导致其可靠性差，更无法满足智能工厂的对生产设备的实时控制要求和可靠性要求的问题。本实施例提供了一种可靠性更好的Modbus TCP协议通信系统，参见图1所示，其包括至少一个Modbus客户端，还包括Modbus服务端。其中，Modbus服务端包括负载均衡器和与负载均衡器连接的至少一个Modbus处理模块。Modbus客户端也包括Modbus处理模块。应当理解的是，本实施例中的Modbus客户端和Modbus服务端的具体实现形式可根据具体的应用场景灵活设置。且Modbus TCP协议通信系统中所包括的Modbus客户端的数量和类型也可根据具体应用场景设置，本实施例对其不做限制。例如在一些示例中，参见图3所示，Modbus客户端可为但不限于工业控制适配器ICA，Modbus服务端可采用但不限于工业集中控制装置，例如DCS平台或IoT平台。参见图1所示，在本实施例中，Modbus客户端用于向Modbus服务端发送至少两个Modbus TCP建链帧，以与Modbus服务端建立至少两条Modbus TCP路径。在本实施例的一些示例中，Modbus客户端发送的Modbus TCP建链帧可包括Modbus客户端的唯一识别标识，该Modbus客户端的唯一识别标识可以包括各种能唯一识别Modbus客户端各种标识信息中的至少之一，例如可以包括但不限于设备I D。这样Modbus服务端在收到Modbus客户端发送的Modbus TCP建链帧后，即可根据Modbus TCP建立帧中的唯一识别标识识别出所接收到的Modbus TCP建链帧是哪个Modbus客户端发送的，以及哪些Modbus TCP建链帧是同一个Modbus客户端发送的，从而便于后续控制建立Modbus TCP路径。在本实施例中，Modbus客户端还用于在与Modbus服务端建立好至少两条ModbusTCP路径后，通过建立的这至少两条Modbus TCP路径与Modbus服务端进行信息交互和处理。为了便于理解，本实施例中将Modbus客户端侧发送给Modbus服务端侧的消息称之为第一消息，将Modbus服务端侧发送给Modbus客户端侧的消息称之为第二消息。本实施例中，Modbus客户端将待发送的第一消息通过建立的至少两条Modbus TCP路径同时向Modbus服务端发送，这样即使某一条Modbus TCP路径出现故障或中断，Modbus客户端也可通过其他ModbusTCP路径将第一消息发送至Modbus服务端，从而提升上行数据发送的可靠性，并提升系统的容灾性。Modbus客户端还通过至少两条Modbus TCP路径接收Modbus服务端发送的第二消息，这样即使某一条Modbus TCP路径出现故障或中断，Modbus客户端也可通过其他ModbusTCP路径接收到Modbus服务端发送的第二消息，从而提升下行数据控制的可靠性以及系统的容灾性。在本实施例的一些示例中，Modbus客户端可以对从Modbus服务端接收到的第二消息进行一一处理。但为了提升Modbus客户端的资源利用率以及消息处理的及时性，Modbus客户端可以对通过至少两条Modbus TCP路径接收的第二消息进行去重处理，并仅对重复的第二消息中的一个进行处理。应当理解的是，本实施例中Modbus客户端对第二消息进行去重的方式可以包括：先筛选出接收到的第二消息中重复的消息，然后对重复的第二消息中的一个进行处理；也可以在接收到首条第二消息后，先对首条第二消息进行处理，在后续又接收到第二消息后对其处理之前，可以将其与之前已处理的第二消息进行比对以确认是否重复，如是，则不对其处理，否则，对其进行正常处理。本实施例中判断两条第二消息是否重复，可以判断两条第二消息的内容是否相同，或两条第二消息中是否包含有相同的消息识别信息，本实施例中设不同的第二消息所包括的消息识别信息不同，例如消息通过Modbus消息帧的发送时，可以在Modbus消息帧中设置帧序号，且不同的Modbus消息帧中的帧序号不同。其中不同Modbus消息帧中的帧序号可以采用递增或递减或其他规则或算法进行确认，只要能保证不同Modbus消息帧的帧序号不同即可。本实施例中，Modbus服务端的负载均衡器用于接收Modbus客户端发送的至少两个Modbus TCP建链帧，根据唯一识别标识，将来自同一Modbus客户端的Modbus TCP建链帧在Modbus服务端的同一Modbus处理模块和Modbus客户端之间建立至少两条Modbus TCP路径，例如负载均衡器将包含同一ID的Modbus TCP建链帧进行一致性hash分布，保证同一个Modbus客户端发送的至少两个Modbus TCP建链帧在负载均衡器重新发起这两条ModbusTCP建链时，向Modbus服务端内的同一个Modbus处理模块发起建链请求；从而在Modbus服务端的一个Modbus处理模块与Modbus客户端之间建立至少两条Modbus TCP路径。本实施例中对于每一条Modbus TCP路径的建立过程不做限制，可以采用但不限于现有的各种ModbusTCP路径建立方式。本实施例中，Modbus服务端的Modbus处理模块与Modbus客户端建立好至少两条Modbus TCP路径后，Modbus服务端的Modbus处理模块用于通过至少两条Modbus TCP路径向Modbus客户端发送第二消息，这样即使其中的一条或一部分Modbus TCP路径故障或中断时，Modbus服务端的Modbus处理模块还可采用其他Modbus TCP路径向Modbus客户端发送第二消息，从而提升系统下行数据传输的可靠性。Modbus服务端的Modbus处理模块还通过至少两条Modbus TCP路径接收Modbus客户端发送的第一消息，这样即使某一条Modbus TCP路径出现故障或中断，Modbus服务端也可通过其他Modbus TCP路径接收到Modbus客户端发送的第一消息，从而提升上行数据发送的可靠性以及系统的容灾性，能更好的智能工厂的对生产设备的实时控制要求和可靠性要求。在本实施例的一些示例中，Modbus服务端可以对从Modbus客户端接收到的第一消息进行一一处理。但为了提升Modbus服务端的资源利用率以及消息处理的及时性，Modbus服务端可以对通过至少两条Modbus TCP路径接收的第一消息进行去重处理，并仅对重复的第一消息中的一个进行处理。应当理解的是，本实施例中Modbus服务端对第一消息进行去重的方式可以采用但不限于与上述第二消息去重的类似做法，在此不再赘述。应当理解的是，本实施例中在Modbus客户端和Modbus服务端之间的建立的ModbusTCP路径的数量可以为2，例如图3所示。也可以为3、4、8等，具体可根据具体应用需求灵活设置。且应当理解的是，在本实施例中，当Modbus TCP协议通信系统包括多个Modbus客户端时，每一个Modbus客户端与Modbus服务端之间可以都建立两条以上的Modbus TCP路径，也可根据需求设置为：其中一部分Modbus客户端与Modbus服务端之间建立两条以上的ModbusTCP路径，另一部分Modbus客户端与Modbus服务端之间建立一条Modbus TCP路径，如图2所示。例如在一些应用场景中，对于通信可靠性要求高的Modbus客户端B，则可与Modbus服务端之间建立两条以上的Modbus TCP路径；而对于通信可靠性要求一般或可以低一些的Modbus客户端A，则可与Modbus服务端之间建立一条Modbus TCP路径。因此可以与现有的Modbus TCP协议通信系统进行更好的兼容，灵活好且适用场景广。为了便于理解，本实施例下面分别对Modbus客户端和Modbus服务侧在Modbus TCP协议通信方法中的过程进行示例说明。其中，Modbus客户端的Modbus TCP协议通信方法参见图4所示，其包括但不限于：S401：Modbus客户端向Modbus服务端发送至少两个Modbus TCP建链帧，以与Modbus服务端建立至少两条Modbus TCP路径。如上所述，本实施例中Modbus TCP建链帧包括Modbus客户端的唯一识别标识，以供Modbus服务端根据唯一识别标识识别发送ModbusTCP建链帧的Modbus客户端，并根据识别结果控制建立至少两条Modbus TCP路径。在本实施例的一些示例中，为了提升通信系统的智能性和便利性，可采用ModbusTCP协议的IP地址的自动发现，从而省略IP地址的手动配置。在本示例中，Modbus客户端向Modbus服务端发送至少两个Modbus TCP建链帧的过程参见图5-1所示，其包括但不限于：S501：Modbus客户端向Modbus服务端发送UDP组播报文以请求获取Modbus服务端的IP地址和端口。其中获取Modbus服务端的IP地址和端口的过程参见图5-2所示：Modbus客户端主动发起UDP组播报文，请求Modbus服务端的IP地址信息，Modbus服务端相关服务响应该UDP组播报文，回应Modbus服务端的IP地址、端口。Modbus客户端获取到Modbus服务端的IP地址、端口后，主动发起TCP建链请求，通过三次交互完成TCP建链请求，实现Modbus TCP的地址自动发现、免配置。S502：Modbus客户端根据获取的Modbus服务端的IP地址和端口生成至少两个Modbus TCP建链帧，并将生成的至少两个Modbus TCP建链帧发送至Modbus服务端。S402：Modbus客户端将待发送的第一消息通过至少两条Modbus TCP路径同时向Modbus服务端发送，并通过至少两条Modbus TCP路径接收Modbus服务端发送的第二消息。例如，一种示例参见图6所示，Modbus客户端将待发送的第一消息通过至少两条Modbus TCP路径同时向Modbus服务端发送包括：S601：Modbus客户端构建包含第一消息的第一Modbus消息帧，第一Modbus消息帧中包含第一帧序号，不同的第一Modbus消息帧中的第一帧序号不同，例如可第一帧序号可采用按发送消息序列采用递增或递减或采用其他的算法进行设置。S602：Modbus客户端将第一Modbus消息帧分别通过至少两条Modbus TCP路径同时向Modbus服务端发送。S403：Modbus客户端将通过至少两条Modbus TCP路径接收的第二消息进行去重处理，并仅对重复的第二消息中的一个进行处理。例如，一种示例中，Modbus客户端通过至少两条Modbus TCP路径接收Modbus服务端发送的第二消息可包括：Modbus客户端通过至少两条Modbus TCP路径接收Modbus服务端发送的携带第二消息的第二Modbus消息帧，第二Modbus消息帧包括第二帧序号；Modbus客户端将通过至少两条Modbus TCP路径接收的第二消息进行去重处理，并仅对重复的第二消息中的一个进行处理包括：Modbus客户端筛选出第二帧序号相同的各第二Modbus消息帧作为重复的第二Modbus消息帧，并仅对重复的第二Modbus消息帧中的一个第二Modbus消息帧进行处理。例如先筛选出接收到的第二消息中重复的消息，然后对重复的第二消息中的一个进行处理；也可以在接收到首条第二消息后，先对首条第二消息进行处理，在后续又接收到第二消息后对其处理之前，可以将其与之前已处理的第二消息进行比对以确认是否重复，如是，则不对其处理，否则，对其进行正常处理。本实施例中判断两条第二消息是否重复，可以判断两条第二消息的内容是否相同，或两条第二消息中是否包含有相同的消息识别信息，本实施例中设不同的第二消息所包括的消息识别信息不同，例如消息通过Modbus消息帧的发送时，可以在Modbus消息帧中设置帧序号，且不同的Modbus消息帧中的帧序号不同。其中不同Modbus消息帧中的帧序号可以采用递增或递减或其他规则或算法进行确认，只要能保证不同Modbus消息帧的帧序号不同即可。在本实施例的一些示例中，Modbus TCP协议通信方法还包括：Modbus客户端筛选出第二帧序号相同的各第二Modbus消息帧作为重复的第二Modbus消息帧后，还包括按第一预警比对规则判断重复的第二Modbus消息帧的个数与Modbus TCP路径的条数是否相同，如否，则发送第一通信链路异常预警信息；该第一通信链路异常预警信息可以向Modbus服务端发送，也可向后台发送，从而便于对异常链路进行及时的修复或重新建立新的链路等，进一步提升系统的可靠性。在本实施例中，第一预警比对规则可以设置为连续N次比对结果为不一致或连续的T时间段内的比对结果不一致等，具体可根据应用需求灵活设置，从而可避免乒乓效应。Modbus服务端的Modbus TCP协议通信方法参见图7所示，其包括但不限于：S701：Modbus服务端的负载均衡器接收Modbus客户端发送的至少两个Modbus TCP建链帧，Modbus TCP建链帧包括Modbus客户端的唯一识别标识。S702：Modbus服务端的负载均衡器根据唯一识别标识，将来自同一Modbus客户端的Modbus TCP建链帧在Modbus服务端的同一Modbus处理模块和Modbus客户端之间建立至少两条Modbus TCP路径。建立过程参见但不限于上述示例所示，在此不再赘述。S703：Modbus服务端的Modbus处理模块通过至少两条Modbus TCP路径接收Modbus客户端发送的第一消息，以及通过至少两条Modbus TCP路径向Modbus客户端发送第二消息。一种示例中，Modbus服务端的Modbus处理模块通过至少两条Modbus TCP路径向Modbus客户端发送第二消息的过程参见图8所示，其包括但不限于：S801：Modbus服务端的Modbus处理模块构建包含第二消息的第二Modbus消息帧，第二Modbus消息帧中包含第二帧序号，不同的第二Modbus消息帧中的第二帧序号不同。S802：Modbus服务端的Modbus处理模块将第二Modbus消息帧分别通过至少两条Modbus TCP路径同时向Modbus客户端发送。一种示例中，Modbus服务端的Modbus处理模块通过至少两条Modbus TCP路径接收Modbus客户端发送的第一消息的过程包括但不限于：Modbus服务端的Modbus处理模块通过至少两条Modbus TCP路径接收Modbus客户端发送的携带第一消息的第一Modbus消息帧，第一Modbus消息帧包括第一帧序号。S704：Modbus服务端的Modbus处理模块将通过至少两条Modbus TCP路径接收的第一消息进行去重处理，并仅对重复的第一消息中的一个进行处理。一种示例中，Modbus服务端的Modbus处理模块将通过至少两条Modbus TCP路径接收的第一消息进行去重处理，并仅对重复的第一消息中的一个进行处理包括：Modbus服务端的Modbus处理模块筛选出第一帧序号相同的各第一Modbus消息帧作为重复的第一Modbus消息帧，并仅对重复的第一Modbus消息帧中的一个第一Modbus消息帧进行处理。在一些示例中，Modbus TCP协议通信方法还可包括：Modbus服务端的Modbus处理模块筛选出第一帧序号相同的各第一Modbus消息帧作为重复的第一Modbus消息帧后，还包括按第二预警比对规则判断重复的第一Modbus消息帧的个数与Modbus TCP路径的条数是否相同，如否，则发送第二通信链路异常预警信息。该第二通信链路异常预警信息可以向Modbus客户端发送，也可向后台发送，从而便于对异常链路进行及时的修复或重新建立新的链路等，进一步提升系统的可靠性。在本实施例中，第二预警比对规则也可以设置为连续N次比对结果为不一致或连续的T时间段内的比对结果不一致等，具体可根据应用需求灵活设置，从而可避免乒乓效应。可见，本实施例通过Modbus支持Modbus TCP多路径实时传输，可提高Modbus通信的高可靠性、实时性，满足工业5个9以上的高可靠控制、10ms级时延控制要求。且通过实现Modbus协议的服务端IP地址自动发现，实现通信协议的IP地址自动发现、免配置，提升系统的智能性。且可应用到所有工业的工厂级、工业过程控制对通信高可靠性、实时性的场景。本实施例还提供了一种通信设备，该通信设备可以为Modbu客户端或Modbu服务端，其包括处理器、存储器及通信总线，其中：通信总线用于实现处理器和存储器之间的连接通信；处理器用于执行存储器中存储的一个或者多个计算机程序，以执行上述的ModbusTCP协议通信方法中的至少一个步骤。本实施例还提供了一种计算机可读存储介质，该计算机可读存储介质包括在用于存储信息的任何方法或技术中实施的易失性或非易失性、可移除或不可移除的介质。计算机可读存储介质包括但不限于RAM,ROM,EEPROM、闪存或其他存储器技术、CD-ROM，数字多功能盘或其他光盘存储、磁盒、磁带、磁盘存储或其他磁存储装置、或者可以用于存储期望的信息并且可以被计算机访问的任何其他的介质。本实施例中的计算机可读存储介质可用于存储一个或者多个计算机程序，其存储的一个或者多个计算机程序可被处理器执行，以执行上述的Modbus TCP协议通信方法中的至少一个步骤。可见，本领域的技术人员应该明白，上文中所公开方法中的全部或某些步骤、系统、装置中的功能模块/单元可以被实施为软件、固件、硬件及其适当的组合。在硬件实施方式中，在以上描述中提及的功能模块/单元之间的划分不一定对应于物理组件的划分；例如，一个物理组件可以具有多个功能，或者一个功能或步骤可以由若干物理组件合作执行。某些物理组件或所有物理组件可以被实施为由处理器，如中央处理器、数字信号处理器或微处理器执行的软件，或者被实施为硬件，或者被实施为集成电路，如专用集成电路。此外，本领域普通技术人员公知的是，通信介质通常包含计算机可读指令、数据结构、计算机程序模块或者诸如载波或其他传输机制之类的调制数据信号中的其他数据，并且可包括任何信息递送介质。所以，本发明不限制于任何特定的硬件和软件结合。以上内容是结合具体的实施方式对本发明实施例所作的进一步详细说明，不能认定本发明的具体实施只局限于这些说明。对于本发明所属技术领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干简单推演或替换，都应当视为属于本发明的保护范围。
