标题title
一种面向工业互联网收益优化的计算任务分配方法
摘要abst
本发明公开了一种面向工业互联网收益优化的计算任务分配方法，包括以下步骤：节点将计算任务以交易的形式发出至工业互联网系统；工业互联网系统根据网关和节点的属性得到计算任务的效益矩阵；工业互联网系统计算最大化收益得到最终分配策略；根据分配策略将每个计算任务分配给对应的网关，触发交易排序机制；网关打包计算任务成区块并计算来自区块链的工作量证明机制当中的哈希难题获得记账权，获得记账权的网关执行计算任务，将计算任务的结果返回给节点。该方法使得交易被分配给执行该交易能够为工厂带来更高效益的网关，使得工业互联网系统在有限的资源里为工厂带来更多的收益。
权利要求书clms
1.一种面向工业互联网收益优化的计算任务分配方法，其特征在于，包括以下步骤：S1，节点将计算任务以交易的形式发出至工业互联网系统；S2，工业互联网系统根据计算任务的重要度、网关执行计算任务的时间花费、网关到节点的信号衰减得到计算任务的收益矩阵；S3，工业互联网系统根据收益矩阵计算最大化收益得到分配策略；S4，根据分配策略将每个计算任务分配给对应的网关，并根据计算任务的属性触发交易排序机制，更新网关交易池当中的交易；S5，网关将分配的计算任务打包成区块，并计算来自区块链的工作量证明机制当中的哈希难题获得记账权，获得记账权的网关执行计算任务，将计算任务的结果返回给节点。2.根据权利要求1所述的一种面向工业互联网收益优化的计算任务分配方法，其特征在于，所述步骤S2包括以下子步骤：S21：根据计算任务的字节数，计算每个计算任务的存储成本；当k个计算任务被k个低算力节点以交易的形式发出，且准备发送给网关时，计算存储成本：其中sci是来自节点i的计算任务cti的存储成本，即燃料消耗；Xi是计算任务cti的零字节数；Yi是计算任务cti的非零字节数；S22：根据存储成本计算每个计算任务的代币花费；其中qi为计算任务cti的代币花费，sci为来自节点i的计算任务cti的存储成本，priceweight是将燃料消耗转换为代币消耗的常数；S23：根据代币花费和网关到节点的距离计算每个计算任务的重要度；其中Iij是计算任务cti对于网关j的重要度；θprice和θdistance分别为人为可控参数，在工业互联网系统中分别代表工厂的计算能力和通信能力，计算能力越强，θprice越小，即工厂为提高计算能力付出代价的意愿越低，通信能力越强，θdistance越小；为网关j到节点i的距离；S24：根据网关到节点的距离和网关的功率与算力计算网关执行计算任务的时间花费与网关到节点的信号衰减：其中，为网关j执行计算任务cti所需要花费的时间；oij为网关j到节点i的信号衰减； fj为网关j的功率；cpj为网关j的算力；δ是将计算任务的重要度转换为数据量的常数；S25：根据信号衰减、重要度和时间花费计算任务收益矩阵；其中G为任务收益矩阵；m为节点的数量；n为网关的数量；为网关j执行cti后为工厂带来的收益；αt，αi，αo分别为时间常数，重要度常数，信号强度常数。3.根据权利要求1所述的一种面向工业互联网收益优化的计算任务分配方法，其特征在于，所述步骤S4具体为：当计算任务cti加入网关的交易池当中时，若待处理交易池当中不存在与cti具有相同nonce值的计算任务，则直接插入待处理交易池，并按降序排列；若待处理交易池当中的计算任务ctt与cti有相同的nonce值，则触发以下的交易排序机制：若，用cti来替换ctt，且将ctt加入到队列交易池当中；否则，将cti加入到队列交易池当中；若，将对应的交易加入到待处理交易池中；更新副本交易池中的交易副本；其中为网关j执行cti后为工厂带来的收益；为网关j执行ctt后为工厂带来的收益；为队列交易池当中的一个交易被网关执行后为工厂带来的收益；为待处理交易池当中的一个交易被网关执行后为工厂带来的收益。
说明书desc
技术领域本发明属于控制科学与工程领域，具体涉及一种面向工业互联网收益优化的计算任务分配方法。背景技术工业互联网作为传统工业和现代信息技术的有机结合，能够实现全生产要素的连接，有效地提高生产力，进而解放劳动力。然而工业互联网系统面临着一系列的安全威胁，因而工业界将区块链技术作为工业互联网的底层架构，从而提出了基于区块链的工业互联网系统。工业互联网系统包含现场层，网关层，云层，其中现场层包含各个智能体来充当节点，网关层包含边缘网关，作为边缘计算的实施者，将来自现场层智能体的计算任务上传至边缘网关进行处理。云层将算力卸载到网关层，为边缘计算提供条件。基于区块链的工业互联网系统，网关层与现场层的网关和智能体在区块链当中充当节点，节点之间的通信，都是在区块链中完成的。以太坊作为区块链架构当中的一种，由于其独有的智能合约与以太坊虚拟机而被认为是区块链的发展方向，并被称为区块链2.0，其内部的节点具有交易池，交易池当中的交易根据该交易的nonce值的大小降序排列，且每当有新的交易将要加入交易池后，都会造成交易池的更新。以太坊的交易池主要分为三类，待处理交易池、队列交易池和副本交易池。待处理交易池中保存着可执行交易，队列交易池当中保存着当前不可执行交易，副本交易池保存着待处理交易池、队列交易池中的的交易的副本。这些交易按顺序被打包成区块，并上传到区块链当中。若交易中涉及了合约账户的生成，即调用了智能合约，则调用智能合约执行交易。通过查阅现有文献，在现有的以区块链为底层的工业互联网当中，大部分都是ETH，其计算任务分配的逻辑是基于工作量证明机制。在这样的机制下，先解出哈希难题的节点将会获得记账权去上传区块并执行智能合约从而计算计算任务。在节点的交易池当中，nonce值高的交易会优先被打包进区块当中，这种交易排序机制对于资源限制较大的工业互联网来说并不是最优选项。由于工业互联网场景下每项计算任务的优先级并不是相同的，若高优先级的任务由于在负责计算的节点的交易池当中的顺序靠后，会造成整个工厂的运行堵塞。发明内容有鉴于此，本发明提供了一种面向工业互联网收益优化的计算任务分配方法，在默认工厂部署了工业互联网的基础上，将节点完成该项任务为工厂带来的综合效益与该计算任务的重要度、信号的衰减程度和完成交易所需要的时间联系起来，并改进了以太坊当中的交易池的交易排序机制，使其更适用于工业互联网场景。该分配方法能够将不同的计算任务分配给执行该任务可以为工厂提供最大收益的网关，从而达到最大化工厂效益的目的。本发明采用以下技术方案：一种面向工业互联网收益优化的计算任务分配方法，包括以下步骤：S1，节点将计算任务以交易的形式发出至工业互联网系统；S2，工业互联网系统根据计算任务的重要度、网关执行计算任务的时间花费、网关到节点的信号衰减得到计算任务的收益矩阵；S3，工业互联网系统根据收益矩阵计算最大化收益得到分配策略；S4，根据分配策略将每个计算任务分配给对应的网关，并根据计算任务的属性触发交易排序机制，更新网关交易池当中的交易；S5，网关将分配的计算任务打包成区块，并计算来自区块链的工作量证明机制当中的哈希难题获得记账权，获得记账权的网关执行计算任务，将计算任务的结果返回给节点。进一步，所述步骤S2包括以下子步骤：S21：根据计算任务的字节数，计算每个计算任务的存储成本；当k个计算任务被k个低算力节点以交易的形式发出，且准备发送给网关时，计算存储成本：其中sci是来自节点i的计算任务cti的存储成本，即燃料消耗；Xi是计算任务cti的零字节数；Yi是计算任务cti的非零字节数；S22：根据存储成本计算每个计算任务的代币花费；其中qi为计算任务cti的代币花费，sci为来自节点i的计算任务cti的存储成本，priceweight是将燃料消耗转换为代币消耗的常数；S23：根据代币花费和网关到节点的距离计算每个计算任务的重要度；其中Iij是计算任务cti对于网关j的重要度；θprice和θdistance分别为人为可控参数，在工业互联网系统中分别代表工厂的计算能力和通信能力，计算能力越强，θprice越小，即工厂为提高计算能力付出代价的意愿越低，通信能力越强，θdistance越小；为网关j到节点i的距离；S24：根据网关到节点的距离和网关的功率与算力计算网关执行计算任务的时间花费与网关到节点的信号衰减：其中，为网关j执行计算任务cti所需要花费的时间；oij为网关j到节点i的信号衰减； fj为网关j的功率；cpj为网关j的算力；δ是将计算任务的重要度转换为数据量的常数；S25：根据信号衰减、重要度和时间花费计算任务收益矩阵；其中G为任务收益矩阵；m为节点的数量；n为网关的数量；为网关j执行cti后为工厂带来的收益；αt，αi，αo分别为时间常数，重要度常数，信号强度常数。进一步，所述步骤S4具体为：当计算任务cti加入网关的交易池当中时，若待处理交易池当中不存在与cti具有相同nonce值的计算任务，则直接插入待处理交易池，并按降序排列；若待处理交易池当中的计算任务ctt与cti有相同的nonce值，则触发以下的交易排序机制：若，用cti来替换ctt，且将ctt加入到队列交易池当中；否则，将cti加入到队列交易池当中；若，将对应的交易加入到待处理交易池中；更新副本交易池中的交易副本；其中为网关j执行cti后为工厂带来的收益；为网关j执行ctt后为工厂带来的收益；为队列交易池当中的一个交易被网关执行后为工厂带来的收益；为待处理交易池当中的一个交易被网关执行后为工厂带来的收益。本发明与现有技术相比所具有的有益效果：从计算任务的重要度、信号的衰减程度和完成该任务所需要的时间三个方面去考虑了将该计算任务分配给某个网关去执行为工厂带来的收益，得到最优的分配策略，从而最大化该工厂的收益。改进了传统以太坊交易池当中的交易排序机制，能够使得交易被分配给执行该交易能够为工厂带来更高效益的网关，使得工业互联网系统在有限的资源里能够为工厂带来更多的收益，提升工厂的综合效益。附图说明图1是本发明的面向工业互联网收益优化的计算任务分配方法的流程图。图2是系统根据网关和节点的属性得到计算任务的效益矩阵的流程图。图3-3是在以太坊的私有链上进行仿真实验获得的仿真结果。其中，图3是采用本发明的方法，系统的总收益随θdistance和θprice的变化；图3是采用传统ETH的方法，系统的总收益随θdistance和θprice的变化；图3是两种方法的总收益差值图。具体实施方式本发明提供了一种面向工业互联网收益优化的计算任务分配方法，将节点完成该项任务为该工厂带来的综合效益与该计算任务的重要度、信号的衰减程度和完成交易所需要的时间联系起来，从而将不同的任务分配给最佳的网关，从而达到最大化工厂效益的目的。本发明将传统的以太坊的交易池中的排序机制进行改进，更加适用于工业互联网场景。如图1所示，本发明提出的一种面向工业互联网收益优化的计算任务分配方法，包括以下步骤：步骤S1，节点将计算任务以交易的形式发出至工业互联网系统；节点将计算复杂度高，且实时性要求低的任务，以交易的形式发出，该任务存储在交易的数据字段。步骤S2，工业互联网系统根据网关和节点的属性得到计算任务的效益矩阵，如图2所示，具体包括以下步骤：S21：根据计算任务的字节数，计算每个计算任务的存储成本，得到计算任务的存储成本向量；当k个计算任务被k个低算力节点以交易的形式发出，且准备发送给网关时，将会计算存储成本向量SC：其中sci是来自节点i的计算任务cti的存储成本，即燃料消耗；Xi是计算任务cti的零字节数；Yi是计算任务cti的非零字节数。S22：根据存储成本计算每个任务的代币花费向量；其中Q为代币花费向量，qi为计算任务cti的代币花费，sci为来自节点i的计算任务cti的存储成本，priceweight是将燃料消耗转换为代币消耗的常数。S23：根据代币花费和距离计算每个计算任务的重要度；其中Iij是计算任务cti对于网关j的重要度；θprice和θdistance分别为人为可控参数，在工业互联网系统中分别代表着该工厂的计算能力和通信能力，若计算能力越强，θprice越小，即工厂为提高计算能力付出代价的意愿越低，同理若通信能力越强，θdistance越小；为节点i到网关j的距离。S24：根据网关到节点的距离和网关的功率与算力来计算网关执行计算任务的时间花费与网关到节点的信号衰减：其中，为网关j执行计算任务cti所需要花费的时间；oij为网关j到节点i的信号衰减； fj为网关j的功率；cpj为网关j的算力；δ是将计算任务的重要度转换为数据量的常数。S25：根据信号衰减、重要度和时间花费计算任务效益矩阵；其中G为任务效益矩阵；m为节点的数量；n为网关的数量；为网关j执行cti后为工厂带来的收益；αt，αi，αo分别为时间常数，重要度常数，信号强度常数，表征着工厂对这三个因素的关心程度。步骤S3，工业互联网系统计算最大化收益得到最终分配策略；在系统中模拟将计算任务分配给各个网关，最后得到的分配策略使得目标函数最大。步骤S4，根据分配策略将每个计算任务分配给对应的网关，触发交易排序机制；当计算任务cti要被加入到网关的交易池当中时，若待处理交易池当中不存在与cti具有相同nonce的计算任务，则直接插入待处理交易池，并按降序排列；若待处理交易池当中的计算任务ctt与cti有相同的nonce，会触发以下的交易排序机制：若，用cti来替换ctt，且将ctt加入到队列交易池当中；否则，将cti加入到队列交易池当中；若，将对应的交易加入到待处理交易池中；更新副本交易池中的交易副本；其中为网关j来执行cti后为工厂带来的收益；为网关j来执行ctt后为工厂带来的收益；代表着队列交易池当中的一个交易被网关执行后为工厂带来的收益；代表着待处理交易池当中的一个交易被网关执行后为工厂带来的收益。步骤S5，网关打包计算任务成区块，并计算来自区块链的工作量证明机制当中的哈希难题来获得记账权，获得记账权的网关来执行计算任务，将任务的结果返回给节点；网关从自己的待处理交易池中按顺序获取m个计算任务，将其打包成区块并计算来自区块链的工作量证明机制当中的哈希难题来获得记账权，在获得记账权后，调用智能合约执行计算任务，将执行后的结果返回给发送计算任务的节点。实施例1：在以太坊的私有链上进行仿真实验，得到图3-3所示的仿真结果。其中，图3是采用本发明的方法，系统的总收益SA随θdistance和θprice的变化；图3是传统ETH中，系统的总收益SB随θdistance和θprice的变化；图3是两种方法的总收益差值图，可以看出，在执行完所有的计算任务后，本发明的方法能够为系统带来更高的收益。综上所述，以上仅为本发明的较佳实施例而已，并非用于限定本发明的保护范围。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护。
