标题title
一种运载火箭地面一体化测控系统
摘要abst
本发明公开了一种运载火箭地面一体化测控系统，包括：网络通信模块、指令解析模块、心跳检测模块、总线通信模块、功能模块、故障诊断模块和主从切换模块；其中，所述网络通信模块接收到上位机的指令后，将接收到的指令发送至指令解析模块；所述指令解析模块将指令与预设配置文件进行比对，配置文件中有指令与具体内容的映射表，比对得到具体的指令内容，根据指令内容调用功能模块中的与指令内容相对应的模块。本发明实现了不同功能对应不同模块，通过不同的模块实现不同的功能，模块之间相互独立，方便功能的拓展和裁剪。
权利要求书clms
1.一种运载火箭地面一体化测控系统，其特征在于包括：网络通信模块、指令解析模块、心跳检测模块、总线通信模块、功能模块、故障诊断模块和主从切换模块；其中，所述网络通信模块接收到上位机的指令后，将接收到的指令发送至指令解析模块；所述指令解析模块将指令与预设配置文件进行比对，配置文件中有指令与具体内容的映射表，比对得到具体的指令内容，根据指令内容调用功能模块中的与指令内容相对应的模块；所述功能模块通过调用总线通信模块，通过机内总线与模块化板卡通信，指挥模块化板卡，功能模块与模块化板卡一起完成对应指令的执行动作；执行完成后，进行判断，若执行完成，则调用网络通信模块将执行结果发送至上位机，若尚未执行完成，则重新调用功能模块，若执行错误，则将错误信息发送至故障诊断模块；所述故障诊断模块接收到错误信息后，将错误信息与预设的配置文件进行比对，若判断错误信息为非严重故障，则重新调用功能模块尝试执行，若为严重故障，则调用主从切换模块执行主动切换动作；所述主从切换模块接收到主从切换指令后，则会进行判断，若本机为主机，则向从机发送主从切换请求，然后将本机降级成为从机，若本机为从机，则等待主机的主从切换请求，收到主从切换请求后，将本机升级为主机；所述心跳检测模块用于实时向对机发送心跳包，并监测对机的心跳包，若心跳包异常，则向故障诊断模块发送心跳检测异常，故障诊断收到心跳检测异常后，同样会触发主从切换。2.根据权利要求1所述的运载火箭地面一体化测控系统，其特征在于还包括：日志模块；其中，所述日志模块用于记录软件运行的信息。3.根据权利要求1所述的运载火箭地面一体化测控系统，其特征在于：所述网络通信模块为整个软件与上位机之间的接口，用于接收上位机的指令，以及向上位机发送数据。4.根据权利要求1所述的运载火箭地面一体化测控系统，其特征在于：功能模块包括模拟量采集模块、模拟量输出模块、开关量采集模块和开关量输出模块；其中，若具体的指令内容为需要打开某开关量通道，则调用开关量输出模块；若具体的指令内容为需要采集开关量，则调用开关量采集模块；若具体的指令内容为需要打开某模拟量通道，则调用模拟量输出模块；若具体的指令内容为需要采集模拟量，则调用模拟量采集模块。5.根据权利要求1所述的运载火箭地面一体化测控系统，其特征在于：多次的重复非严重故障同样认为是严重故障。6.根据权利要求1所述的运载火箭地面一体化测控系统，其特征在于：预设的配置文件内容包括网络配置、指令配置、心跳配置、日志配置、总线通信配置、功能模块配置、故障诊断配置、主从切换配置。7.根据权利要求1所述的运载火箭地面一体化测控系统，其特征在于：硬件失效或某一软件模块异常均为严重故障。
说明书desc
技术领域本发明属于航天电子系统设计技术领域，尤其涉及一种运载火箭地面一体化测控系统。背景技术随着运载火箭地面测控设备装备化的发展，“机内总线+模块化板卡”的通用型前端测控设备将是未来的趋势。由于此类测控设备采用的处理器不同、操作系统不同，内部的模块化板卡种类和数量不同，因此目前尚无一种通用的软件架构。另一方面，即使对于同一种设备，由于用户不同，往往存在一些需求的差异，这就给软件架构的伸缩性和扩展性带来了比较高的要求。发明内容本发明解决的技术问题是：克服现有技术的不足，提供了一种运载火箭地面一体化测控系统，实现了不同功能对应不同模块，通过不同的模块实现不同的功能，模块之间相互独立，方便功能的拓展和裁剪。本发明目的通过以下技术方案予以实现：一种运载火箭地面一体化测控系统，包括：网络通信模块、指令解析模块、心跳检测模块、总线通信模块、功能模块、故障诊断模块和主从切换模块；其中，所述网络通信模块接收到上位机的指令后，将接收到的指令发送至指令解析模块；所述指令解析模块将指令与预设配置文件进行比对，配置文件中有指令与具体内容的映射表，比对得到具体的指令内容，根据指令内容调用功能模块中的与指令内容相对应的模块；所述功能模块通过调用总线通信模块，通过机内总线与模块化板卡通信，指挥模块化板卡，功能模块与模块化板卡一起完成对应指令的执行动作；执行完成后，进行判断，若执行完成，则调用网络通信模块将执行结果发送至上位机，若尚未执行完成，则重新调用功能模块，若执行错误，则将错误信息发送至故障诊断模块；所述故障诊断模块接收到错误信息后，将错误信息与预设的配置文件进行比对，若判断错误信息为非严重故障，则重新调用功能模块尝试执行，若为严重故障，则调用主从切换模块执行主动切换动作；所述主从切换模块接收到主从切换指令后，则会进行判断，若本机为主机，则向从机发送主从切换请求，然后将本机降级成为从机，若本机为从机，则等待主机的主从切换请求，收到主从切换请求后，将本机升级为主机；所述心跳检测模块用于实时向对机发送心跳包，并监测对机的心跳包，若心跳包异常，则向故障诊断模块发送心跳检测异常，故障诊断收到心跳检测异常后，同样会触发主从切换。上述运载火箭地面一体化测控系统中，还包括：日志模块；其中，所述日志模块用于记录软件运行的信息。上述运载火箭地面一体化测控系统中，所述网络通信模块为整个软件与上位机之间的接口，用于接收上位机的指令，以及向上位机发送数据。上述运载火箭地面一体化测控系统中，功能模块包括模拟量采集模块、模拟量输出模块、开关量采集模块和开关量输出模块；其中，若具体的指令内容为需要打开某开关量通道，则调用开关量输出模块；若具体的指令内容为需要采集开关量，则调用开关量采集模块；若具体的指令内容为需要打开某模拟量通道，则调用模拟量输出模块；若具体的指令内容为需要采集模拟量，则调用模拟量采集模块。上述运载火箭地面一体化测控系统中，多次的重复非严重故障同样认为是严重故障。上述运载火箭地面一体化测控系统中，预设的配置文件内容包括网络配置、指令配置、心跳配置、日志配置、总线通信配置、功能模块配置、故障诊断配置、主从切换配置。上述运载火箭地面一体化测控系统中，硬件失效或某一软件模块异常均为严重故障。本发明与现有技术相比具有如下有益效果：本发明通过软件功能模块的特征，实现了不同功能对应不同模块，通过不同的模块实现不同的功能，模块之间相互独立，方便功能的拓展和裁剪；本发明通过软件主体及所属的八个模块的特征，实现了整个软件架构，采用多线程的设计思路，多个功能同时执行，保证实时性；适应多种开发语言，能够兼容多种操作系统；本发明通过软件配置文件的特征，实现了通过修改配置文件即可适应不同规模、不同功能的设备，无需修改代码。附图说明通过阅读下文优选实施方式的详细描述，各种其他的优点和益处对于本领域普通技术人员将变得清楚明了。附图仅用于示出优选实施方式的目的，而并不认为是对本发明的限制。而且在整个附图中，用相同的参考符号表示相同的部件。在附图中：图1是本发明实施例提供的前后端设备连接关系示意图；图2是本发明实施例提供的运载火箭地面一体化测控系统的结构框图。具体实施方式下面将参照附图更详细地描述本公开的示例性实施例。虽然附图中显示了本公开的示例性实施例，然而应当理解，可以以各种形式实现本公开而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更透彻地理解本公开，并且能够将本公开的范围完整的传达给本领域的技术人员。需要说明的是，在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。下面将参考附图并结合实施例来详细说明本发明。图1是本发明实施例提供的前后端设备连接关系示意图。如图1所示，“机内总线+模块化板卡”的通用型前端测控设备软件架构设计主要面临两个亟待解决的问题：一是设计一种可以实现通用化的软件基本架构，在同一设备内，不改动代码的前提下，可以满足不同用户的需求；二是其基本逻辑足够清晰，能够适应不同开发语言，适应不同操作系统。通用化运载火箭地面测控设备的特点是一套方案可以满足多种需求，即设备架构是相同的，通过调整机箱数量、功能板卡数量即可实现动力系统、测量系统、控制系统的测控功能。因此该软件架构需要满足不同规模设备的需求，将软件需要实现的不同功能采用不同模块实现，不同模块为不同的线程，具体功能模块运行所需的输入通过配置文件实现。软件主程序通过读取配置文件获得需要完成的功能，然后启动相应的功能模块的线程，各线程通过读取配置文件获得所需的输入。图2是本发明实施例提供的运载火箭地面一体化测控系统的结构框图。如图2所示，该运载火箭地面一体化测控系统包括网络通信模块、指令解析模块、心跳检测模块、日志模块、总线通信模块、功能模块、故障诊断模块、主从切换模块，各模块之间的信息流如图2所示。各模块的说明如下:a)网络通信模块：前端设备与上位机的通信模块，用于接收上位机指令及向上位机发送状态；b)指令解析模块：解析上位机指令，读取配置文件，根据上位机指令和配置文件通知不同的功能线程，实现任务分配；c)心跳检测模块：完成主从之间的状态监测及切换功能。d)日志模块：独立运行，用于记录软件运行的关键信息，所有模块都调用日志模块，实现关键日志信息的存储；e)总线通信模块：调用相应机内总线的驱动，向机内的模块化板卡发送指令，指挥模块化板卡执行相应的功能；f)功能模块：每个模块完成一项具体的功能，如模拟量采集、状态量采集、时序流程、配电通道控制等，该模块可根据具体运行的设备功能进行相应的增减；g)故障诊断模块：根据软件运行的信息，判断当前出现的错误是否为严重错误，若为严重错误，则启动主从切换模块，请求切换备份机执行；h)主从切换模块：执行具体的主从切换动作，如发出/接收主从切换请求，设置本机为主机/从机。各模块之间的信息流说明如下：网络通信模块为整个软件与上位机之间的接口，用于接收上位机的指令，以及向上位机发送数据，网络通信模块接收到上位机的指令后，将接收到的指令发送至指令解析模块；指令解析模块将指令与配置文件进行比对，配置文件中有指令与具体内容的映射表，比对得到具体的指令内容，根据指令内容调用相应的功能模块，如需要打开某开关量通道则调用开关量输出模块；功能模块通过调用总线通信模块，通过机内总线与模块化板卡通信，指挥模块化板卡，功能模块与模块化板卡一起完成对应指令的执行动作；执行完成后，进行判断，若执行完成，则调用网络通信模块将执行结果发送至上位机，若尚未执行完成，则重新调用功能模块，若执行错误，则将错误信息发送至故障诊断模块；故障诊断模块接收到错误信息后，将错误信息与配置文件进行比对，若判断错误信息为非严重故障，则重新调用功能模块尝试执行，若为严重故障，则调用主从切换模块执行主动切换动作；主从切换模块接收到主从切换指令后，则会进行判断，若本机为主机，则向从机发送主从切换请求，然后将本机降级成为从机，若本机为从机，则等待主机的主从切换请求，收到主从切换请求后，将本机升级为主机；心跳检测模块用于实时向对机发送心跳包，并监测对机的心跳包，若心跳包异常，则向故障诊断模块发送心跳检测异常，故障诊断收到心跳检测异常后，同样会触发主从切换。日志模块用于记录软件运行的关键信息，不参与整个指令处理流程。配置文件内容包括网络配置、指令配置、心跳配置、日志配置、总线通信配置、功能模块配置、故障诊断配置、主从切换配置，与各个模块互相对应。以某型号三级动力测控组合为例，三级动力测控组合主要由电源模块、主控模块、功能模块、底板等组成。主控模块为两块互为冗余的Menlow主板，采用实时操作系统。功能模块包括模拟量采集模块，开关量输入模块，开关量输出模块，完成各个节点不同信号的采集和控制。主控模块与各个功能模块通过数据总线和管理总线实现互联，完成各个功能模块的数据采集和控制。在三级动力测控组合中，主控模块与各个功能模块通过数据总线和管理总线实现互联，完成各个功能模块的数据采集和控制。其中，数据总线负责点名、自检、功能板卡控制、CPU板主从切换结果下传等；管理总线负责上报板卡健康状态。其中，数据总线和管理总线均为双路冗余。在三级动力测控组合中运行三级动力测控组合嵌入式测控软件，运行在VxWorks6.8操作系统上。主要完成以下功能：a)单点控制功能：接收三级动力测控指挥控制软件的单点控制指令，经逻辑判断后控制配气台及箭上相应的电磁阀动作；b)工序控制功能：接收三级动力测控指挥控制软件的工序控制指令，经逻辑判断后按照工序要求完成相应的工序控制动作；c)应急控制功能：通过前后端应急通路，接收后端三级应急控制指令，执行相应的应急工序控制功能；d)状态采集及反馈功能：将采集的设备内部控制通道的动作回令、设备内部的状态信息以及气脱好、脱插脱落好等状态量信号反馈后端三级动力指挥控制软件；e)模拟量采集功能：将采集的配气台、管路的压力、温度等模拟量信号反馈后端三级动力指挥控制软件。三级动力测控组合上电后，自动加载VXWorks6.8操作系统，完成系统初始化后，进入正常工作模式，三级动力测控组合嵌入式测控软件正常工作模式下的主要功能包括：软件各模块初始化；周期通过总线通信与各功能板卡通信，将各功能板卡采集的信息反馈至后端三级动力指挥控制软件；接收三级动力指挥控制软件的控制指令，经逻辑判断后控制KO板进行输出；接收后端应急控制指令，执行时序流程控制；具备日志记录功能，能将软件运行的日志记录并存储于文件中。该系统包括日志模块、总线通信模块、功能模块、网络通信模块、指令解析模块、心跳检测模块、主从切换模块、故障诊断模块等。各种部件之间存在如下关系：a)所有模块都调用日志模块，实现关键日志信息的存储；b)动力测控各系统之间网络通信采用了通用的通信协议，所有的网络通信均调用网络通信模块实现；c)指令解析模块完成配电输出单步控制指令解析，调用配电控制模块完成配电输出控制，调用自动流程模块实现自动流程控制功能,调用CAN总线通信模块完成自检、复位、开始/停止漏电检测、主从切换等功能，调用RS485总线通信模块完成主从切换功能；d)自动流程模块完成自动流程指令解析，调用配电控制模块完成配电输出控制；e)配电控制模块调用CAN总线通信模块完成配电输出控制；f)CAN总线周期采集模块调用CAN总线通信模块完成点名、模拟量采集、开关量采集、配电状态采集等周期通信功能；g)RS485总线周期采集模块调用RS485总线通信模块完成健康状态等周期通信功能；h)心跳检测模块调用CAN总线通信模块、RS485总线通信模块完成主从切换功能。配置文件格式设计：动力测控前端软件中重要的数据结构是各模块的配置信息，各模块的大部分功能都可通过配置文件进行配置，配置文件采用XML格式，下面对各模块的配置文件进行设计。主从切换配置：主从切换配置定义了当前CPU板的使能状态和主从状态，内容如下：＜标志使能＝"1"主从＝"1"/＞日志配置：日志配置定义了当前日志的起始序号、最大队列长度、输出方式等，内容如下：＜日志FileLimit_M＝"500"CheckFreePeriod_s＝"3600"DiskFreeLimit_M＝"1024"文件起始序号＝"1"LogLevel＝"Info"最大队列长度＝"10000"是否屏幕输出＝"1"是否文件输出＝"1"是否网络输出＝"0"/＞网络配置：网络配置定义了网络通信的相关配置，包括网络通信协议中的本机系统编码和节点编码，指令解析模块的网络配置，周期采集的网络配置，内容如下＜网络＞＜指令远程端口＝"4107"本地端口＝"4021"远程地址＝"192.168.241.7"/＞＜指令远程端口＝"4107"本地端口＝"4022"远程地址＝"192.168.241.7"/＞＜/网络＞CAN周期采集配置：CAN周期采集配置由五个部分组成，分别是CAN周期处理、模拟量采集、开关量采集、应急控制和配电采集。CAN周期处理定义了处理周期，超时判断时间，各个功能板卡周期采集的内容和各个功能板卡的信息，内容如下：＜CAN周期处理处理周期＝"1000"KI处理周期＝"1000"超时判断时间＝"5"＞＜处理类型＝"点名"名称＝"设备一AD板"设备号＝"0"最高有效位＝"0"板卡地址码＝"1"板卡类型码＝"1"/＞＜/CAN周期处理＞模拟量采集定义了各个模拟量的表号、编码、代号、名称和AD板卡序号、通路以及计算公式，内容如下：＜模拟量采集＞＜模拟量类型＝"模拟量采集"表号＝"1433"编码＝"1"代号＝"X3-BP_G35A"名称＝"35MPa高压气源压力"AD板卡A＝"1"AD板卡B＝"2"路数＝"1"公式＝"x*6.748830132975+1.29278762544283"/＞＜/模拟量采集＞开关量采集定义了各个开关量的表号、编码、名称和KI板卡序号、通路，内容如下：＜开关量采集＞＜开关量类型＝"开关量采集"表号＝"1441"编码＝"10"名称＝"脱插脱落好"KI板卡＝"1"路数＝"16"/＞＜/开关量采集＞应急控制定义了各应急控制的名称和KI板卡序号、通路，内容如下：＜应急控制＞＜应急控制类型＝"应急控制"名称＝"氢箱泄压"KI板卡＝"1"路数＝"7"路数＝"8"路数＝"9"/＞＜/应急控制＞配电采集定义了各个配电采集的表号、编码、代号、名称和KO板卡序号、通路，内容如下：＜配电采集＞＜配电采集类型＝"配电采集"表号＝"1442"编码＝"1"代号＝"3BQ"名称＝"芯三级氢、氧泵前阀开关腔控制电磁阀"控制板卡A＝"7"控制板卡B＝"8"路数＝"1"/＞＜/配电采集＞RS485周期采集配置：RS485周期处理定义了处理周期，超时判断时间，各个功能板卡周期采集的内容和各个功能板卡的信息，内容如下：＜RS485周期处理处理周期＝"500"超时判断时间＝"100"＞＜处理类型＝"健康状态查询"名称＝"设备一AD板"设备号＝"0"最高有效位＝"0"板卡地址码＝"1"板卡类型码＝"1"/＞＜/RS485周期处理＞配电控制配置：配电控制定义了超时判断时间，各个功能板卡的板卡序号和信息，内容如下：＜开关量控制超时判断时间＝"1"＞＜处理类型＝"开关量输出"板卡序号＝"1"设备号＝"0"最高有效位＝"0"板卡地址码＝"4"板卡类型码＝"4"/＞＜/开关量控制＞控制指令配置：控制指令配置定义了控制指令的类型、表号、编码、名称，若控制指令为配点控制或节能配电控制，则控制指令还有代号、板卡序号和通路，内容如下：＜控制指令集＞＜指令类型＝"配电控制"表号＝"1433"编码＝"1"代号＝"X3-DJQ1"名称＝"断JQ1减压阀"控制板卡A＝"1"控制板卡B＝"2"路数＝"1"/＞＜/控制指令集＞自动流程配置：自动流程配置定义了自动流程的名称，各个动作的代号、输出值以及延时，内容如下：＜自动流程集＞＜自动流程名称＝"氢泵箱吹除"＞＜动作数字量输出代号＝"X3-CD1A"输出值＝"1"延时＝"0"/＞＜动作数字量输出代号＝"X3-CD1B"输出值＝"1"延时＝"0"/＞＜动作数字量输出代号＝"3FK-H-I"输出值＝"1"延时＝"60"/＞＜动作数字量输出代号＝"3FK-H-II"输出值＝"1"延时＝"0"/＞＜动作数字量输出代号＝"3YX-H-I"输出值＝"1"延时＝"120"/＞＜动作数字量输出代号＝"3YX-H-II"输出值＝"1"延时＝"0"/＞＜动作数字量输出代号＝"3FK-H-I"输出值＝"0"延时＝"0"/＞＜动作数字量输出代号＝"3FK-H-II"输出值＝"0"延时＝"0"/＞＜/自动流程＞＜/自动流程集＞故障诊断配置：＜故障诊断＞＜故障故障编码＝"101"故障标志＝"严重"故障名称＝"心跳异常"/＞＜故障故障编码＝"201"故障标志＝"非严重"故障名称＝"总线通信超时"/＞＜/故障诊断＞本发明通过软件功能模块的特征，实现了不同功能对应不同模块，通过不同的模块实现不同的功能，模块之间相互独立，方便功能的拓展和裁剪；本发明通过软件主体及所属的八个模块的特征，实现了整个软件架构，采用多线程的设计思路，多个功能同时执行，保证实时性；适应多种开发语言，能够兼容多种操作系统；本发明通过软件配置文件的特征，实现了通过修改配置文件即可适应不同规模、不同功能的设备，无需修改代码。本发明虽然已以较佳实施例公开如上，但其并不是用来限定本发明，任何本领域技术人员在不脱离本发明的精神和范围内，都可以利用上述揭示的方法和技术内容对本发明技术方案做出可能的变动和修改，因此，凡是未脱离本发明技术方案的内容，依据本发明的技术实质对以上实施例所作的任何简单修改、等同变化及修饰，均属于本发明技术方案的保护范围。
