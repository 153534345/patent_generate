标题title
基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法及系统
摘要abst
本发明提供了一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法及系统，所述方法用hadoop大数据框架对数据预处理，对基站下的上网用户的上网数据进行特征提取，计算不同时间窗下在某个基站的用户的多源数据构建用户多维画像，基于flink在不同时间窗口内进行用户画像特征到基站画像特征的映射计算，得到不同时间窗下的基站特征画像及其相邻基站的基站特征画像；采用Attention‑LSTM的多模型集成投票方法进行预测，使用RAPIDS对模型训练进行多GPU加速；针对基站下人流变化和人群行为变化对APP使用进行预测，构建特征映射方法，在个体组成的群体层面进行特征抽取和映射，使得模型方法和特征更能反应个体行为对基站下APP使用的影响，最终使得APP使用预测更加准确，效果更好。
权利要求书clms
1.一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，其特征在于，包括以下步骤：获取当前基站的历史数据，存入Hadoop集群，并采用MapReduce/Spark计算引擎对数据进行预处理，包括数据异常值清洗、数据格式统一以及数据类型转换的方式对数据集进行清洗重构，并按照时间进行排序；对清洗和排序以后的数据进行时间窗划分，并对时间窗口内的特征进行特征过滤和混合采样，并采用滑动时间窗的方式构建数据集；对时间窗下平衡以后的数据集进行分类，分类前使用已有的APP类别的使用特性，将APP按照适用场景分为低延迟、高带宽以及多连接三类，采用基于Attention-LSTM模型的投票机制预测出下一个时间窗最可能使用的APP类别；所述Attention-LSTM模型优化过程如下：获取用户连接基站的上网数据，所述上网数据包括用户个体数据及上网数据；基于用户上网数据获取所用APP名称及上网URL，并根据APP名称及上网URL与APP种类的对应关系映射为APP所属种类，采用时间和流量双重加权的方式得到当前时间窗下基站使用最多的APP种类；针对当前时间窗下基站使用最多的APP种类的数据构建当前基站下用户的基础特征，再基于所述基础特征构建用户的多维画像；基于所述用户的多维画像，基于flink在不同时间窗口内进行用户画像特征到基站画像特征的映射计算，得到不同时间窗下的基站特征画像及其相邻基站的基站特征画像；对时间窗口内的特征进行特征过滤和混合采样，并采用滑动时间窗的方式构建数据集，对Attention-LSTM模型进行训练和预测，在训练过程中基于RAPIDS进行多GPU加速，得到优化后的Attention-LSTM模型。2.根据权利要求1所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，其特征在于，获取用户连接基站的上网数据具体为：从基站数据中提取用于训练模型的用户上网数据，用户上网数据包含url、请求开始时间、请求结束时间、上行流量，下行流量、用户个人数据以及基站位置。3.根据权利要求1所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，其特征在于，使用flink构建一个固定步长的滑动时间窗口，并在时间窗口内进行第二次数据清洗、转换以及异常值处理，对时间窗口内的数据进行滑动处理，计算基站和用户特征画像，得到固定时间步长下的用户在基站下的上网数据，并使用APP类别对照表，根据上网请求的url解析出用户使用的APP名称，再根据APP名称及上网URL与APP种类的对应关系和APP的使用特性，将用户使用的APP分为低延迟、高带宽和多连接三类；基于使用的APP种类，按照使用时间和流量进行APP加权，计算出权重最大的APP类别，作为当前基站下使用最多的APP种类；加权计算公式为：其中：Wj表示APP j在当前基站下的权重大小，tij表示第i个人使用APP j的时间，dij表示APP j在当前基站下的下行流量，upij表示APP j在当前基站下的上行流量大小，SUM表示当前基站下所有APP的使用时长和，SUM和SUM分别表示当前基站下所有APP的上行流量和下行流量之和，a、b、c为加权系数。4.根据权利要求1所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，其特征在于，使用多个固定时间窗内的用户滑动上网数据，提取固定时间窗内用户的用户统计学特征、上网特征和用户移动数据，包括用户统计学特征包括年龄和性别；用户移动数据特征包括移动距离、停留点个数、停留点时长、回转半径和平均移动速度；上网特征：上网时长和上网时间段，其中a.活动范围的计算公式为：计算用户位置点集合的最小外接圆，每小时的活动范围就是外接圆的面积，计算公式为：f＝max)≤r其中，f表示以经纬度为圆心，r为半径的圆，Dis表示和之间的直线距离，其中pi,j∈R，R是用户的位置点集合，为计算用户位置点集合R的外接圆表达式；b.回转半径计算公式为：r＝max))c.新地点的出现次数：c＝Count其中，count代表计算数目，pi,j∈R′，R′是用户的这一时间段与上一时间段位置点的差集pi,j∈R，R是用户的位置点集合，r是回转半径。5.根据权利要求1所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，其特征在于，用户的多维画像到基站画像映射的关系为：aij为基站下第j个人的第i个特征向量，Dnj为第n个基站下用群体特征映射到基站的特征向量j，p表示aij在整个序列中出现的概率，T为当前时间窗的截至时间，t为个体特征的发生时间，α为时间衰减因子；根据以上映射关系，根据基站下人群的基础特征向量计算出基站的基础特征向量，得到基站画像。6.根据权利要求1所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，其特征在于，采用flink计算滑动时间窗口的用户画像和基站画像进行特征过滤和数据混合采样时，使用GBDT模型对已有数据进行特征评估，将特征评估得分在设定阈值以下的特征都过滤掉，对特征进行剪枝形成数据集；然后将所述数据集划分成训练集和测试集；基于Borderline-SMOTE过采样技术，操作训练集，将训练集中少数的类别样本类分为三类，分别为Safe、Danger和Noise，其中，Safe类为样本周围一半以上均为少数类样本，Danger类为样本周围一半以上均为多数类样本，视为在边界上的样本，Noise类为样本周围均为多数类样本，视为噪音；对Danger类的少数类进行过采样，采用K近邻方法随机选择少数类样本，进行少数样本的过采样。7.根据权利要求1所述基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，其特征在于，采用基于Attention-LSTM模型的投票机制预测出下一个时间窗最可能使用的APP实际类别具体如下：基于提取到的基站特征画像、人群特征和划分好的APP类别，使用Attention机制和LSTM模型结合的方法，采用LSTM模型提取基站的数据的时序特征画像，与基站上一步通过用户转换得到的多维画像一起构建特征集；构建包括boosting和bagging的多种不同集成学习组合，采用GBDT、随机森林、SVM和KNN进行多模型预测投票，对GBDT、随机森林、SVM和KNN模型设定初始投票权重0.25；采用k折交叉验证的方式进行模型选择，每次训练和预测均采用有放回地方式抽取测试集和训练集；基于贝叶斯优化的方法调节GBDT、随机森林、SVM、KNN和Attention-LSTM模型的超参数，在k折交叉验证中选取一个评价最好的模型组合进行最终的预测，构建三分类模型，训练模型期间，基于RAPIDS进行多GPU加速训练，预测下一时刻指定基站下使用最多的APP属于低延迟、高带宽、多连接APP中的某一种。8.一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测系统，其特征在于，包括基础特征提取模块、APP识别模块、画像构建合构建模块、时序特征构建模块、特征样本数据集平衡模块、基于RAPIDS的多GPU加速模块以及深度学习分类识别模块；基础特征提取模块用于构建用户上网记录和用户移动位置记录，并基于以上两种数据提取用户的APP使用偏好和用户行为特征；APP识别模块用于将用户使用流量的上网记录转换为用户使用APP的记录，并识别不同时间窗下基站下APP的使用特征；画像构建模块用于基于基础特征提取模块构建用户画像，并将用户画像映射为基站APP使用画像，识别出基站APP使用序列和使用特征；特征样本构建模块用于对基础特征提取模块进行时序特征提取，输出用户行为的时序特征；特征样本数据集平衡模块采用改进的SMOTE算法进行数据集调整，对不同类别进行样本采样和平衡，得到一个样本平衡的测试集和训练集；多GPU加速模块基于RAPIDS对深度学习模型训练进行多卡并行加速，用于加快模型训练速度；深度学习预测模块用基于平衡后的特征样本数据集，构建包括boosting和bagging的多种不同集成学习组合，基于所述的k折交叉验证和贝叶斯调参的方式进行投票权重调整，构建低延迟、高带宽、多连接APP的预测模型，预测指定基站下一时刻最可能使用的APP种类。9.一种计算机设备，其特征在于，包括处理器以及存储器，存储器用于存储计算机可执行程序，处理器从存储器中读取部分或全部所述计算机可执行程序并执行，处理器执行部分或全部计算可执行程序时能实现权利要求1-7任一项所述基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法。10.一种计算机可读存储介质，其特征在于，计算机可读存储介质中存储有计算机程序，所述计算机程序被处理器执行时，能实现如权利要求1-7任一项所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法。
说明书desc
技术领域本发明属于信息技术领域，具体涉及一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法及系统。背景技术随着移动互联网的发展，智能手机已经成为我们生活中不可或缺的个人设备，几乎涵盖了我们生活的方方面面，根据中国信通院披露的数据，2019年12月国内智能手机出货量2893.1万部，同比下降13.7％，其中5G手机541.4万部。2019年全年，国内智能手机出货量3.72亿部，同比下降4.7％，其中5G手机1376.9万部，从市场及企业角度来看，虽然智能手机的普及率越来越高，但是市场还没有饱和，仍旧可以快速发展。广阔的手机市场驱动华为、苹果、小米等手机制造商提供和开发更好的手机平台，于是在智能手机技术、平台的巨大进步，以及个人开发者的热情的驱动下，大量的移动应用程序被创造出来，服务于广泛的使用厂家，使我们的日常生活更加方便，使用这些APP对我们的生活带来了极大的便利。但是从互联网服务提供商角度来看，飞速增长的手机市场和手机拥有量对全球的数字基建带来了巨大的考验。由于智能手机的大部分服务都依赖于终端云服务器，例如在线游戏、视频导航等，这就导致了手机对基站或者室内外WiFi的严重依赖，尤其是出门在外没有WiFi的情况下，手机的使用体验极度依靠附近基站提供的信号质量，而城市的基站布局变化会滞后于城市布局、手机市场的发展，这就要求互联网服务提供商能够在手机人均拥有量飞速发展的情况下，还能为室内外连接基站上网的用户提供良好的上网体验。5G时代的到来，基站建设技术快速发展，数字基建的快速推进，智慧城市的构建，宏基站、微基站的配合，这些都使得互联网服务提供商能够基于城市宏观的手机使用情况动态改变城市内基站的布局，于是本发明基于基站和地理位置的基站连接数目预测研究和不同于以往的APP使用预测研究，为5G时代基站动态规划，智慧城市提供参考。发明内容为了解决现有技术中存在的问题，本发明提供一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法及系统，基于Hadoop大数据框架进行数据处理、存储、计算，并结合flink及深度学习技术，基于RAPIDS进行多GPU加速，针对基站下人流变化和人群行为变化对APP使用进行预测，构建特征映射方法，在个体组成的群体层面进行特征抽取和映射，使得模型方法和特征更能反应个体行为对基站下APP使用的影响，最终使得APP使用预测更加准确，效果更好。为了实现上述目的，本发明采用的技术方案是：一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，包括以下步骤：获取当前基站的历史数据，存入Hadoop集群，并采用MapReduce/Spark计算引擎对数据进行预处理，包括数据异常值清洗、数据格式统一以及数据类型转换的方式对数据集进行清洗重构，并按照时间进行排序；对清洗和排序以后的数据进行时间窗划分，并对时间窗口内的特征进行特征过滤和混合采样，并采用滑动时间窗的方式构建数据集；对时间窗下平衡以后的数据集进行分类，分类前使用已有的APP类别的使用特性，将APP按照适用场景分为低延迟、高带宽以及多连接三类，采用基于Attention-LSTM模型的投票机制预测出下一个时间窗最可能使用的APP类别；所述Attention-LSTM模型优化过程如下：获取用户连接基站的上网数据，所述上网数据包括用户个体数据及上网数据；基于用户上网数据获取所用APP名称及上网URL，并根据APP名称及上网URL与APP种类的对应关系映射为APP所属种类，采用时间和流量双重加权的方式得到当前时间窗下基站使用最多的APP种类；针对当前时间窗下基站使用最多的APP种类的数据构建当前基站下用户的基础特征，再基于所述基础特征构建用户的多维画像；基于所述用户的多维画像，基于flink在不同时间窗口内进行用户画像特征到基站画像特征的映射计算，得到不同时间窗下的基站特征画像及其相邻基站的基站特征画像；对时间窗口内的特征进行特征过滤和混合采样，并采用滑动时间窗的方式构建数据集，对Attention-LSTM模型进行训练和预测，在训练过程中基于RAPIDS进行多GPU加速，得到优化后的Attention-LSTM模型。获取用户连接基站的上网数据具体为：从基站数据中提取用于训练模型的用户上网数据，用户上网数据包含url、请求开始时间、请求结束时间、上行流量，下行流量、用户个人数据以及基站位置。使用flink构建一个固定步长的滑动时间窗口，并在时间窗口内进行第二次数据清洗、转换以及异常值处理，对时间窗口内的数据进行滑动处理，计算基站和用户特征画像，得到固定时间步长下的用户在基站下的上网数据，并使用APP类别对照表，根据上网请求的url解析出用户使用的APP名称，再根据APP名称及上网URL与APP种类的对应关系和APP的使用特性，将用户使用的APP分为低延迟、高带宽和多连接三类；基于使用的APP种类，按照使用时间和流量进行APP加权，计算出权重最大的APP类别，作为当前基站下使用最多的APP种类；加权计算公式为：其中：Wj表示APPj在当前基站下的权重大小，tij表示第i个人使用APPj的时间，dij表示APPj在当前基站下的下行流量，upij表示APPj在当前基站下的上行流量大小，SUM表示当前基站下所有APP的使用时长和，SUM和SUM分别表示当前基站下所有APP的上行流量和下行流量之和，a、b、c为加权系数。使用多个固定时间窗内的用户滑动上网数据，提取固定时间窗内用户的用户统计学特征、上网特征和用户移动数据，包括用户统计学特征包括年龄和性别；用户移动数据特征包括移动距离、停留点个数、停留点时长、回转半径和平均移动速度；上网特征：上网时长和上网时间段，其中a.活动范围的计算公式为：计算用户位置点集合的最小外接圆，每小时的活动范围就是外接圆的面积，计算公式为：f＝max)≤r其中，f表示以经纬度为圆心，r为半径的圆，Dis表示和之间的直线距离，其中pi,j∈R，R是用户的位置点集合，这个公式代表计算用户位置点集合R的外接圆表达式b.回转半径计算公式为：r＝max))c.新地点的出现次数c＝Count其中count代表计算数目，pi,j∈R′，R′是用户的这一时间段与上一时间段位置点的差集其中，pi,j∈R，R是用户的位置点集合，r是回转半径。用户的多维画像到基站画像映射的关系为：aij为基站下第j个人的第i个特征向量，Dnj为第n个基站下用群体特征映射到基站的特征向量j，p表示aij在整个序列中出现的概率，T为当前时间窗的截至时间，t为个体特征的发生时间，α为时间衰减因子；根据以上映射关系，根据基站下人群的基础特征向量计算出基站的基础特征向量，得到基站画像。采用flink计算滑动时间窗口的用户画像和基站画像进行特征过滤和数据混合采样时，使用GBDT模型对已有数据进行特征评估，将特征评估得分在设定阈值以下的特征都过滤掉，对特征进行剪枝形成数据集；然后将所述数据集划分成训练集和测试集；基于Borderline-SMOTE过采样技术，操作训练集，将训练集中少数的类别样本类分为三类，分别为Safe、Danger和Noise，其中，Safe类为样本周围一半以上均为少数类样本，Danger类为样本周围一半以上均为多数类样本，视为在边界上的样本，Noise类为样本周围均为多数类样本，视为噪音；对Danger类的少数类进行过采样，采用K近邻方法随机选择少数类样本，进行少数样本的过采样。采用基于Attention-LSTM模型的投票机制预测出下一个时间窗最可能使用的APP实际类别具体如下：基于提取到的基站特征画像、人群特征和划分好的APP类别，使用Attention机制和LSTM模型结合的方法，采用LSTM模型提取基站的数据的时序特征画像，与基站上一步通过用户转换得到的多维画像一起构建特征集；构建包括boosting和bagging的多种不同集成学习组合，采用GBDT、随机森林、SVM和KNN进行多模型预测投票，对GBDT、随机森林、SVM和KNN模型设定初始投票权重0.25；采用k折交叉验证的方式进行模型选择，每次训练和预测均采用有放回地方式抽取测试集和训练集；基于贝叶斯优化的方法调节GBDT、随机森林、SVM、KNN和Attention-LSTM模型的超参数，在k折交叉验证中选取一个评价最好的模型组合进行最终的预测，构建三分类模型，训练模型期间，基于RAPIDS进行多GPU加速训练，预测下一时刻指定基站下使用最多的APP属于低延迟、高带宽、多连接APP中的某一种。另一方面，本发明还可以提供一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测系统，包括基础特征提取模块、APP识别模块、画像构建合构建模块、时序特征构建模块、特征样本数据集平衡模块、基于RAPIDS的多GPU加速模块以及深度学习分类识别模块；基础特征提取模块用于构建用户上网记录和用户移动位置记录，并基于以上两种数据提取用户的APP使用偏好和用户行为特征；APP识别模块用于将用户使用流量的上网记录转换为用户使用APP的记录，并识别不同时间窗下基站下APP的使用特征；画像构建模块用于基于基础特征提取模块构建用户画像，并将用户画像映射为基站APP使用画像，识别出基站APP使用序列和使用特征；特征样本构建模块用于对基础特征提取模块进行时序特征提取，输出用户行为的时序特征；特征样本数据集平衡模块采用改进的SMOTE算法进行数据集调整，对不同类别进行样本采样和平衡，得到一个样本平衡的测试集和训练集；多GPU加速模块基于RAPIDS对深度学习模型训练进行多卡并行加速，用于加快模型训练速度；深度学习预测模块用基于平衡后的特征样本数据集，构建包括boosting和bagging的多种不同集成学习组合，基于所述的k折交叉验证和贝叶斯调参的方式进行投票权重调整，构建低延迟、高带宽、多连接APP的预测模型，预测指定基站下一时刻最可能使用的APP种类。另外，本发明还提供一种计算机设备，包括处理器以及存储器，存储器用于存储计算机可执行程序，处理器从存储器中读取部分或全部所述计算机可执行程序并执行，处理器执行部分或全部计算可执行程序时能实现本发明所述基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法。一种计算机可读存储介质，计算机可读存储介质中存储有计算机程序，所述计算机程序被处理器执行时，能实现本发明所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法。与现有技术相比，本发明至少具有以下有益效果：与现有技术相比，本发明提出的一整套的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，基于Hadoop大数据框架进行数据处理、存储、计算，并结合flink及深度学习技术，基于RAPIDS进行多GPU加速，并针对基站下人流变化和人群行为变化对APP使用进行预测，构建特征映射方法，在个体组成的群体层面进行特征抽取和映射，使得模型方法和特征更能反应个体行为对基站下APP使用的影响，最终使得APP使用预测更加准确，效果更好；本发明提出的一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法，将类别繁多的APP按照各自特点划分为低延迟、高带宽、多链接三类，通过三分类预测模型，来预测基站下一时刻使用的APP；本发明基于Hadoop大数据框架进行数据处理、存储、计算，并结合flink及深度学习技术，基于RAPIDS进行多GPU加速；本发明提取用户上网、移动行为特征，从用户行为角度解释APP使用变化，对用户的上网行为进行更深层次地解析，获得用户更多得隐含特征；基于用户到基站特征映射，将用户的个体行为转变为基站在不同时刻下的行为特征，从用户角度提取基站下APP使用的潜在变化情况，基于flink设计了一个端到端的预测模型，将数据按照时间窗进行截断、滑动计算；本发明基于Attention-LSTM的多模型集成投票机制，Attention-LSTM进行进一步的时序特征提取，GBDT、随机森林、SVM、KNN这四个模型进行预测投票，采用投票权重分配方式，同时基于贝叶斯优化和k折交叉验证进行实时在线调参，选择表现最好的模型进行预测。附图说明图1为本发明的一种可实施的预测方法流程图。具体实施方式本发明提供了一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法及系统，所述方法使用hadoop大数据框架对数据进行存储、清洗、计算，并对基站下的上网用户的上网数据进行特征提取，计算不同时间窗下在某个基站的用户的上网数据、位置数据、个人数据等多源数据构建用户多维画像，通过flink构建时序画像，采用流量时间加权方式计算基站下不同时间窗的APP使用偏好，并基于已有的APP类别的使用特性将APP名称转换为低延迟、高带宽、多链接这三类APP；然后基于用户多维画像到基站多维画像的转化公式，将用户多维画像转变为基站画像；在以上构建成功的基站多维特征画像的基础上使用GBDT和改进的SMOTE进行特征选择和数据集平衡，用于模型训练和预测；之后基于处理过的数据集进行k折交叉验证，本发明采用基于Attention-LSTM的多模型集成投票方法进行预测，并基于RAPIDS对模型训练进行多GPU加速，具体是Attention-LSTM进行特征提取，GBDT、随机森林、SVM、KNN这四个模型进行预测投票，通过贝叶斯优化和k折交叉验证调节模型超参，并选择表现最好的模型进行预测，实现基站下APP使用的预测。具体包括以下步骤：步骤一，通过用户上网数据构建基础数据，并基于Hadoop进行数据存储和数据预处理，使用MapReduce/Spark进行数据的第一次清洗、转换、格式统一操作，构成初步可用的基础数据，并基于flink对这些基础数据进行用户上网特征、行为特征、个体特征等基础特征提取；步骤二，使用APP-url转换单元，将用户的上网url转换成用户所使用的APP名称；并采用流量加权的方式，计算出特定时间窗下基站的APP使用偏好；然后基于APP类别的使用特性进行APP名称到APP类别的转换；表1 app-url与app类型转换表表2 app类型与预测类型转换关系步骤三，在flink时间窗内进行特征映射，将用户个体特征转换为基站特征；步骤四，利用改进的SMOTE算法和GBDT进行特征选择和样本重平衡，得到训练预测的数据集；步骤五，基于数据集，构建Attetion-LSTM进行时序特征提取，使用GBDT、随机森林、SVM、KNN构建集成学习模型，并基于RAPIDS对模型训练进行多GPU训练加速，进行投票预测；采用k折交叉验证和贝叶斯优化选择最优的模型参数，进行APP使用预测。为使本发明的目的，技术方案和优点更加清楚，下面结合附图对本发明作进一步的详细描述。针对运营商大数据提的用户在基站下的全量上网数据和用户匿名个体数据，基于Hadoop大数据框架对以上数据的通话数据、画像数据、位置数据以及上网数据进行第一次数据清洗、计算，并将得到的数据进行基于flink的ETL和滑动计算；为后面的几个步骤奠定数据基础。步骤一，通过用户上网数据构建基础数据，并基于Hadoop进行数据存储和数据预处理，使用MapReduce/Spark进行数据的第一次清洗、转换、格式统一操作，构成初步可用的基础数据，并基于flink对这些基础数据进行用户上网特征、行为位置特征、个体特征等基础特征提取；其中上网信息特征包括：时间窗内流量使用总量、均值、方差及使用趋势，url请求使用统计，如：百度、谷歌、QQ、微信等访问趋势及次数等统计，APP使用统计，如：常用APP使用次数、占比、时长，特殊类APP使用统计等。行为位置特征包括：用户移动距离、平均移动速度、访问基站的实时最大距离、平均次数及熵值、上网发生在工作地和家中的次数及比例、白天和夜晚位置记录条数及占比以及用户移动的回转半径；个体特征包括：用户性别、年龄、手机开户时间以及累计活跃天数。步骤二，使用已有的APP-URL转换单元，将用户的上网URL转换成用户所使用的APP名称；并采用流量加权的方式，计算出特定时间窗下基站的APP使用偏好；然后基于已有规则进行APP名称到APP类别的转换；使用flink构建一个固定步长的滑动时间窗口，并在时间窗口内进行数据ETL处理，对窗内的数据进行滑动处理，进行基站特征画像和用户的多维画像的计算，得到固定时间步长下的用户在基站下的上网数据，并使用APP类别对照表，根据上网请求的URL解析出用户使用的APP名称，再根据已有的规则，按照APP类别对照表，将用户使用的APP分为低延迟、高带宽、多连接三类；基于使用的APP种类，按照使用时间和流量进行APP加权，计算出权重最大的APP类别，作为当前基站下使用最多的APP种类；加权公式为：其中：Wj表示APPj在当前基站下的权重大小，tij表示第i个人使用APPj的时间，dij表示APPj在当前基站下的下行流量，upij表示APPj在当前基站下的上行流量大小，SUM表示当前基站下所有APP的使用时长和，SUM和SUM分别表示当前基站下所有APP的上行流量和下行流量之和，a、b、c为加权系数。步骤三，在flink时间窗内进行特征映射，将用户个体特征转换为基站特征：用户画像到基站画像映射的方法：aij为基站下第j个人的第i个特征向量，Dnj为第n个基站下用群体特征映射到基站的特征向量j，p表示aij在整个序列中出现的概率,T为当前时间窗的截至时间，t为个体特征的发生时间，α为时间衰减因子，根据以上映射关系，可以根据基站下人群的特征向量计算出基站的特征向量，进而得到画像。步骤四，利用改进的SMOTE算法和GBDT进行特征选择和样本重平衡，得到训练预测的数据集；对得到的时间窗口的用户的多维画像和基站特征画像进行特征过滤和数据混合采样，使用GBDT模型对已有数据进行特征评估，将特征评估得分在设定阈值以下的特征都过滤掉，对特征进行剪枝形成数据集；本发明中设定阈值为0.2，然后将数据集划分成训练集和测试集。基于Borderline-SMOTE过采样技术，操作训练集，将训练集中少数的类别样本类分为三类，分别为Safe、Danger和Noise，其中，Safe类为样本周围一半以上均为少数类样本，Danger类为样本周围一半以上均为多数类样本，视为在边界上的样本，Noise类为样本周围均为多数类样本，视为噪音；对Danger类的少数类进行过采样，采用K近邻方法随机选择少数类样本，进行少数样本的过采样。步骤五，基于数据集，构建Attetion-LSTM进行时序特征提取，使用GBDT、随机森林、SVM、KNN构建集成学习模型，并基于RAPIDS对模型训练进行多GPU训练加速，最后进行投票预测；采用k折交叉验证和贝叶斯优化选择最优的模型参数，进行APP使用预测基于已经提取到的基站画像特征和人群特征和划分好的APP类别，使用Attention机制和LSTM模型结合的方法，采用LSTM提取画像的时序特征，与原有的基础画像特征一起构建特征集；构建包括boosting和bagging的多种不同集成学习组合，选取GBDT、随机森林、SVM、KNN进行多模型预测投票，对这四个模型初始化投票权重0.25；采用k折交叉验证的方式进行模型选择，每次训练和预测均采用有放回地方式抽取测试集和训练集；基于贝叶斯优化的方法调节GBDT、随机森林、SVM、KNN和Attention-LSTM模型的超参，在k折交叉验证中选取一个评价最好的模型组合进行最终的预测，构建三分类模型，预测下一时刻指定基站下使用最多的APP属于低延迟、高带宽、多连接APP中的某一种。另一方面，本发明还提供一种基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测系统，包括基础特征提取模块、APP识别模块、画像构建合构建模块、时序特征构建模块、特征样本数据集平衡模块、基于RAPIDS的多GPU加速模块以及深度学习分类识别模块；基础特征提取模块用于构建用户上网记录和用户移动位置记录，并基于以上两种数据提取用户的APP使用偏好和用户行为特征；APP识别模块用于将用户使用流量的上网记录转换为用户使用APP的记录，并识别不同时间窗下基站下APP的使用特征；画像构建模块用于基于基础特征提取模块构建用户画像，并将用户画像映射为基站APP使用画像，识别出基站APP使用序列和使用特征；特征样本构建模块用于对基础特征提取模块进行时序特征提取，输出用户行为的时序特征；特征样本数据集平衡模块采用改进的SMOTE算法进行数据集调整，对不同类别进行样本采样和平衡，得到一个样本平衡的测试集和训练集；多GPU加速模块基于RAPIDS对深度学习模型训练进行多卡并行加速，用于加快模型训练速度；深度学习预测模块用基于平衡后的特征样本数据集，构建包括boosting和bagging的多种不同集成学习组合，基于所述的k折交叉验证和贝叶斯调参的方式进行投票权重调整，构建低延迟、高带宽、多连接APP的预测模型，预测指定基站下一时刻最可能使用的APP种类。另外，本发明还可以提供一种计算机设备，包括处理器以及存储器，存储器用于存储计算机可执行程序，处理器从存储器中读取部分或全部所述计算机可执行程序并执行，处理器执行部分或全部计算可执行程序时能实现本发明所述基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法。也可以提供一种计算机可读存储介质，计算机可读存储介质中存储有计算机程序，所述计算机程序被处理器执行时，能实现本发明所述的基于Hadoop和RAPIDS的多源特征转换基站下APP使用预测方法。所述预测APP使用的设备可以是笔记本电脑、平板电脑、桌面型计算机或工作站。处理器可以是图形处理器、中央处理器、数字信号处理器、专用集成电路或现成可编程门阵列。对于本发明所述存储器，可以是笔记本电脑、平板电脑、桌面型计算机、手机或工作站的内部存储单元，如内存、硬盘；也可以采用外部存储单元，如移动硬盘、闪存卡。计算机可读存储介质可以包括计算机存储介质和通信介质。计算机存储介质包括以用于存储诸如计算机可读指令、数据结构、程序模块或其他数据等信息的任何方法或技术实现的易失性和非易失性、可移动和不可移动介质。计算机可读存储介质可以包括：只读存储器、随机存取记忆体、固态硬盘或光盘等。其中随机存取记忆体可以包括电阻式随机存取记忆体。
