标题title
一种基于Zigbee网络的提高通信效率的方法
摘要abst
本发明属于Zigbee通信领域，公开了一种基于Zigbee网络的提高通信效率的方法，包括ZC构建网络，ZR和/或ZED加入网络，并构成Zigbee网络；ZR和ZED将自身短地址p和父设备的短地址f反馈给ZC，ZC将所有数据存储至动态二维数组A中；随后，ZC提取A中的所有f值，和ZC的短地址进行对比，判断Zigbee网络的拓扑结构；当网络为星形拓扑时，ZC将在网所有设备配置成禁止闭环Rejoin操作，直接上报报警，若网络为Mesh拓扑或树形拓扑，则将父设备是ZC的所有设备配置成禁止闭环Rejoin操作，直接上报报警，其余设备正常Rejoin。本发明的有益效果：智能识别网络拓扑类型，对一些进行Rejoin无意义的拓扑关系，不进入网络修复的环节，提高了上报数据实时性和网络通信效率。
权利要求书clms
1.一种基于Zigbee网络的提高通信效率的方法，其特征在于，包括以下步骤：S1、ZC在合适信道创建网络，生成信道唯一网络标识符PANID，并对符合Zigbee协议的ZED和/或ZR进行组网，共同构成Zigbee网络，ZED和ZR共组成X个网络节点，任意一个网络节点i具有一个短地址pi，ZC的短地址为Q；S2、ZC构建一个动态二维数组A，其中fi表示网络节点i的父设备的短地址，n取值0或1，n＝0时，数组A内数值为X个网络节点自身的短地址，n＝1时，数组A内数值为X个网络节点的父设备的短地址；S3、ZC对A进行分析，判断X个值是否都和Q相同，若是，则所述Zigbee网络为星形拓扑；若否，则所述Zigbee网络为树形拓扑或网状拓扑；S4、ZC根据所述Zigbee网络的拓扑结构，执行以下操作：若所述Zigbee网络为星形拓扑，则ZC将X个网络节点均配置成禁止闭环Rejoin操作，直接上报报警；若所述Zigbee网络为树形拓扑或网状拓扑，则判断任意网络节点i的父设备的短地址fi是否和Q相同，若是，则将该网络节点i配置成禁止闭环Rejoin操作，直接上报报警；若否，则将该网络节点i配置成正常Rejoin操作。2.根据权利要求1所述的一种基于Zigbee网络的提高通信效率的方法，其特征在于：所述Zigbee网络中，任意一个网络节点i的短地址pi唯一。3.根据权利要求1所述的一种基于Zigbee网络的提高通信效率的方法，其特征在于：所述Q为0×0000。4.根据权利要求1所述的一种基于Zigbee网络的提高通信效率的方法，其特征在于：所述ZED为安防类设备。
说明书desc
【技术领域】本发明涉及Zigbee通信领域，尤其涉及一种基于Zigbee网络的提高通信效率的方法。【背景技术】在万物互联的时代背景下，zigbee网络主要作为感知层数据传输而建立，在传感器网络等领域应用非常广泛。zigbee作为一种近距离、低功耗、低数据传输速率、低成本的无线网络技术，具有强大的组网能力，可以形成如图2所示的星型拓扑、树型拓扑和Mesh拓扑网络，不同网络结构具有不同优势，实际项目中可以根据需要来选择合适的zigbee网络结构。星形拓扑由Coordinator和EndDevice组成的一种拓扑形式，ZED只能与ZC通信，ZED节点之间进行通讯必须通过ZC节点进行信息的转发。树形拓扑由Coordinator和一系列Router及EndDevice组成的一种拓扑形式，ZR可以连接一系列的ZED及ZR，允许多层级重复，每个节点只能与父节点及子节点通信，信息只有唯一的通路。Mesh拓扑由Coordinator和一系列Router及EndDevice组成的一种拓扑形式，Mesh拓扑形式相对于树形拓扑具有更加灵活的信息路由规则，如果一个路由路径出现了问题，信息可以自动的沿着其他的路由路径进行传输。在这三种网络拓扑实现中，ZED或ZR设备在失去父设备的情况下，依通信协议会进行网络修复操作，而网络修复是一个较复杂的连续多环节交互过程。在实际物理环境中，ZC是ZED或ZR设备的父节点的情况下，当ZED或ZR设备因通信环境突变失去父节点ZC时，依zigbee协议机制，在满足条件后会进行网络修复。走完Rejoin整个过程需要比较长的时间，且不一定一次就能成功。在此期间，因网络还未通，ZED或ZR的消息是上报不了的，造成上报数据实时性和影响网络通信效率。特别在ZED为安防类设备的网络中，会造成重要警讯的延误。因此，有必要提供一种基于Zigbee网络的提高通信效率的方法，解决目前Zigbee通信网络因缺乏灵活识别网络拓扑的方法，而进行单一的相关网络操作的缺点，提高上报数据实时性和网络通信效率，同时解决无线通信“长短手”问题。【发明内容】本发明公开了一种基于Zigbee网络的提高通信效率的方法，其可以有效解决背景技术中涉及的技术问题。为实现上述目的，本发明的技术方案为：一种基于Zigbee网络的提高通信效率的方法，包括以下步骤：S1、ZC在合适信道创建网络，生成信道唯一网络标识符PANID，并对符合Zigbee协议的ZED和/或ZR进行组网，共同构成Zigbee网络，ZED和ZR共组成X个网络节点，任意一个网络节点i具有一个短地址pi，ZC的短地址为Q；S2、ZC构建一个动态二维数组A，其中fi表示网络节点i的父设备的短地址，n取值0或1，n＝0时，数组A内数值为X个网络节点自身的短地址，n＝1时，数组A内数值为X个网络节点的父设备的短地址；S3、ZC对A进行分析，判断X个值是否都和Q相同，若是，则所述Zigbee网络为星形拓扑；若否，则所述Zigbee网络为树形拓扑或网状拓扑；S4、ZC根据所述Zigbee网络的拓扑结构，执行以下操作：若所述Zigbee网络为星形拓扑，则ZC将X个网络节点均配置成禁止闭环Rejoin操作，直接上报报警；若所述Zigbee网络为树形拓扑或网状拓扑，则判断任意网络节点i的父设备的短地址fi是否和Q相同，若是，则将该网络节点i配置成禁止闭环Rejoin操作，直接上报报警；若否，则将该网络节点i配置成正常Rejoin操作。作为本发明的一种优选改进：所述Zigbee网络中，任意一个网络节点i的短地址pi唯一。作为本发明的一种优选改进：所述Q为0×0000。作为本发明的一种优选改进：所述ZED为安防类设备。本发明的有益效果如下：与现有技术相比，解决了目前Zigbee3.0通信网络中因缺乏灵活识别网络拓扑的方法，而进行单一的相关网络操作的缺点，通过分析网络节点的父设备的短地址，智能识别网络拓扑类型后执行不同的程序逻辑，达到了提高通信效率的效果。【附图说明】为了更清楚地说明本发明实施例中的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其它的附图，其中：图1为本发明一种基于Zigbee网络的提高通信效率的方法的流程图；图2为zigbee网络三种拓扑结构的示意图。【具体实施方式】下面将结合本发明实施例对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其它实施例，都属于本发明保护的范围。需要说明，本发明实施例中所有方向性指示仅用于解释在某一特定姿态下各部件之间的相对位置关系、运动情况等，如果该特定姿态发生改变时，则该方向性指示也相应地随之改变。另外，在本发明中如涉及“第一”、“第二”等的描述仅用于描述目的，而不能理解为指示或暗示其相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。在本发明的描述中，“多个”的含义是至少两个，例如两个，三个等，除非另有明确具体的限定。在本发明中，除非另有明确的规定和限定，术语“连接”、“固定”等应做广义理解，例如，“固定”可以是固定连接，也可以是可拆卸连接，或成一体；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通或两个元件的相互作用关系，除非另有明确的限定。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。另外，本发明各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当认为这种技术方案的结合不存在，也不在本发明要求的保护范围之内。请参阅图1所示，本发明提供一种基于Zigbee网络的提高通信效率的方法，包括以下步骤：S1、ZC在合适信道创建网络，生成信道唯一网络标识符PANID，并对符合Zigbee协议的ZED和/或ZR进行组网，共同构成Zigbee网络，ZED和ZR共组成X个网络节点，任意一个网络节点i具有一个短地址pi，ZC的短地址为Q；S2、ZC构建一个动态二维数组A，其中fi表示网络节点i的父设备的短地址，n取值0或1，n＝0时，数组A内数值为X个网络节点自身的短地址，n＝1时，数组A内数值为X个网络节点的父设备的短地址；S3、ZC对A进行分析，判断X个值是否都和Q相同，若是，则所述Zigbee网络为星形拓扑；若否，则所述Zigbee网络为树形拓扑或网状拓扑；S4、ZC根据所述Zigbee网络的拓扑结构，执行以下操作：若所述Zigbee网络为星形拓扑，则ZC将X个网络节点均配置成禁止闭环Rejoin操作，直接上报报警；若所述Zigbee网络为树形拓扑或网状拓扑，则判断任意网络节点i的父设备的短地址fi是否和Q相同，若是，则将该网络节点i配置成禁止闭环Rejoin操作，直接上报报警；若否，则将该网络节点i配置成正常Rejoin操作。具体的，在一个网络中，每个设备的短地址必须唯一，当网络节点加入网络时由其父设备节点分配并通过使用短地址来通信。对于协调器ZC来说，短地址协议设定为0x0000。ZR或ZED设备i扫描到ZC信标后，向ZC发出连接请求，ZC依情况处理其请求，若入网条件允许，ZC会给此节点分配一个16位的短地址，完成入网流程。ZC将i节点SAddr存入动态二维数组A中pi位置，在交互完成后，将收到的i节点父设备的SAddr存入fi位置。ZC对二维数组A中fx的值集进行分析，若其值皆为0x0000，就可判定所有子设备的父设备为ZC，即网络拓扑为星形拓扑，否则网络拓扑为树形拓扑或Mesh拓扑。对一些进行Rejoin无意义的拓扑关系，直接上报数据，不进入网络修复的环节，这样提高了上报数据实时性和网络通信效率，同时解决了无线通信“长短手”问题。作为一种实施方式，基于Zigbee网络的提高通信效率的方法，包括以下步骤：S1：ZC在合适信道创建网络，生成信道唯一网络标识符PANID，在一个网络中，每个设备的短地址必须唯一，当网络节点加入网络时由其父节点分配并通过使用短地址来通信，对于协调器ZC来说，短地址协议设定为0x0000。S2：ZR或ZED设备e扫描到ZC信标后，向ZC发出连接请求，ZC依情况处理其请求，若入网条件允许，ZC会给此节点分配一个16位的短地址，完成入网流程。S3：ZC将e节点SAddr存入二维数组A中pe位置，在交互完成后，将收到的e节点父设备的SAddr存入fe位置。S4：重复步骤S2和S3，直到所有设备完成入网流程且ZC构建完成二维数组A。S5：ZC对动态二维数组A中fx的值集进行分析，若其值皆为0x0000，就可判定所有子设备的父设备为ZC，即网络拓扑为星形拓扑；若否，则网络拓扑为树形拓扑或Mesh拓扑。S6：当网络为星形拓扑时，ZC将在网所有子设备配置成禁止闭环Rejoin操作，直接上报报警；若当前为Mesh拓扑或树形拓扑，则将父设备是ZC的所有子设备配置成禁止闭环Rejoin操作，直接上报报警，其余子设备正常Rejoin。通过上述方法，可以智能识别出网络拓扑，根据节点的拓扑关系，应进行网络修复的执行Rejoin流程。对一些进行Rejoin无意义的拓扑关系，直接上报数据，不进入网络修复的环节，这样提高了上报数据实时性和网络通信效率。工作原理：ZC构建网络，ZR和/或ZED加入网络，并构成Zigbee网络。ZR和ZED将自身短地址p和父设备的短地址f反馈给ZC，ZC将所有数据存储至动态二维数组A中。随后，ZC提取A中的所有f值，和ZC的短地址进行对比，判断Zigbee网络的拓扑结构。当网络为星形拓扑时，ZC将在网所有设备配置成禁止闭环Rejoin操作，直接上报报警。若当前为Mesh拓扑或树形拓扑，则将父设备是ZC的所有设备配置成禁止闭环Rejoin操作，直接上报报警，其余设备正常Rejoin。尽管本发明的实施方案已公开如上，但并不仅仅限于说明书和实施方案中所列运用，它完全可以被适用于各种适合本发明的领域，对于熟悉本领域的人员而言，可容易地实现另外的修改，因此在不背离权利要求及等同范围所限定的一般概念下，本发明并不限于特定的细节和这里所示出与描述的图例。
