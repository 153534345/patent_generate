标题title
基于LSTM的同时同频全双工数字域自干扰抑制方法
摘要abst
本发明公开了一种基于LSTM的同时同频全双工数字域自干扰抑制方法，利用具有记忆性的LSTM网络对非线性和线性自干扰同时进行抑制，根据发射信号估计出自干扰信号，并从接收信号中减去以达到较好的自干扰抑制效果，无需采用额外的模块，简化流程，降低了过程的复杂度。同时利用记忆多项式对收发链路产生的非线性失真进行建模，降低计算复杂度，同时保证系统精度。此外设计了一种自适应的数据预处理方法，采用头脑风暴优化算法对多径信道的时延和衰减进行自适应估计，将发射信号进行多段延时作为训练样本的多个特征，以有效适应多种多径信道情况，为具体延时的时间单位建立了统一的理论指导。
权利要求书clms
1.一种基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，包括以下步骤：S1、获取参考信号：发射信号经过实部虚部的分离重构为只包含实值的参考信号；S2、构建自干扰信道，并得到自干扰信号：自干扰信道由非线性模型、多径信道和高斯信道组成，其中，非线性模型采用记忆多项式来建模；S3、数据预处理：通过BSO优化算法计算多径信道最大时延，将参考信号进行时间延时产生多个特征；S4、构建LSTM网络：LSTM网络由输入层、隐藏层和输出层构成全连接结构，隐藏层包含多个LSTM单元；时间延时产生的多个特征输入LSTM网络输入层，最终LSTM网络输出数据包含2个特征，分别为信号的实部和虚部；S5、利用LSTM网络对自干扰信号进行训练和预测，计算自干扰抑制能力。2.根据权利要求1所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，步骤S2非线性模型采用记忆多项式来建模，表达式表示如下：式中，P，M分别表示多项式的阶数和记忆深度。3.根据权利要求1所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，步骤S2多径信道用以下公式进行建模：其中，k为多径数，rk为多径衰减参数，τk为多径时延参数。4.根据权利要求1所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，步骤S3中通过BSO算法优化确定延时的时间单位的过程为：首先随机初始化生成N个在搜索空间内均匀分布的个体，然后依据相似性利用K均值聚类将所有个体分为M个类；再依照所给适应度函数计算所有个体的适应度，并挑选出M个类中适应度最优的个体；最后通过迭代选出全局最优个体，即延时的时间单位。5.根据权利要求1所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，步骤S4中，LSTM单元输入参数为当前时刻的输入Xt、上一时刻的单元状态输出Ct-1和上一时刻的隐藏层状态输出ht-1，输出参数为当前时刻单元状态输出Ct和当前时刻隐藏层状态输出ht。6.根据权利要求5所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，LSTM单元内部由遗忘门f、输入门i、候选门g和输出门o组成，其中输入门i和候选门g用于输入，引入门用于保护和控制单元状态，遗忘门用于决定从细胞状态中丢弃的信息，输入门用于决定加入到单元状态中新的信息的数量，输出门用于基于单元状态决定最终的输出值。7.根据权利要求6所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，状态参数Ct，ht的更新公式为：Ct＝ft⊙Ct-1+it⊙gtht＝ot⊙tanh 门结构的输出公式为：ft＝σit＝σgt＝tanhot＝σ LSTM网络在反向传播过程中每次迭代需要更新的参数如下：其中W为输入权重、R为循环权重、b为偏置。8.根据权利要求1所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，步骤S5中，LSTM网络包括离线训练和在线预测两个过程，其中：离线训练，即在不接收期望信号的情况下，将预处理后的训练样本的参考信号作为LSTM网络的输入，训练样本的自干扰信号作为LSTM网络的输出进行训练；在线预测，即在训练过程结束后，在接收期望信号的同时，将预测样本的参考信号送入LSTM网络进行预测，然后从接收信号中减去预测的自干扰信号，从而实现自干扰抑制。9.根据权利要求1所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，自干扰能力的计算公式如下：10.根据权利要求1所述的基于LSTM的同时同频全双工数字域自干扰抑制方法，其特征在于，LSTM网络损失函数计算公式如下：其中，R是预测样本的特征维度，L是预测样本的时间序列长度，S＝R×L为数据总数，y为网络预测输出，y′为预测样本的实际自干扰信号。
说明书desc
技术领域本发明涉及数字域自干扰抑制领域，尤其涉及一种基于LSTM的同时同频全双工数字域自干扰抑制方法。背景技术随着卫星互联网巨星座的构建、空天地一体化通信网技术的发展，通信系统中的终端设备对数据量以及数据种类的要求有了前所未有的提升，同时带来频谱资源紧张、频谱效率低下以及与地面5G通信网络融合不够等问题。众所周知，现实中的频谱资源是十分有限的，因此需要提高频谱资源的利用率，以达到在有限频谱资源的限制下，传输大量、多种数据的需求。同时同频全双工技术正是在这样的背景之下应运产生，它可以在相同的频率同时发送和接收信号，能够使频谱效率提升一倍。但是，这项技术需要解决的一项重要问题是，同时同频全双工系统中，由于发射天线与接收天线相隔较近，自干扰信号强度远大于期望信号强度，会对系统产生严重干扰，因此同时同频全双工的首要工作是抑制强自干扰。目前数字域自干扰抑制常用的技术主要有自适应滤波和深度学习方法。自适应滤波可以在给定期望信号的情况下，通过更新滤波器的权重来使输入信号尽可能地拟合期望信号。为了在数字域中从接收信号中滤除发射机产生的自干扰信号，采用自适应滤波技术对干扰信号进行精确拟合，原理是将发射机的发射信号作为输入信号，接收信号作为期望信号，通过自适应滤波器来拟合接收信号中的自干扰成分，再将拟合得到的输出信号从接收信号中减去，进而达到自干扰抑制的目的。该技术的缺点在于，第一，只能处理线性自干扰，对于使用放大器的通信链路，放大器的输出为非线性信号，此时自适应滤波将无法准确处理。第二，自适应滤波技术的收敛速度较慢，无法满足系统设计要求。近年来深度学习技术不断进步，数据处理能力不断提升。在2014年，基于深度学习的人脸识别技术准确率已经达到了97％以上，这足以说明深度学习在图像识别这一领域的一骑绝尘。此外，深度学习的相关算法在医疗、金融、艺术、无人驾驶等多个领域均取得了显著的成果。深度学习近年来在计算机领域的发展有目共睹，取得了巨大成就，这也为改善通信系统，提高通信质量提供了新的解决思路和应对办法。现有的基于深度学习的方法通常仅利用深度学习网络来对非线性自干扰进行有效抑制，在实现过程中还需要采用额外的模块对线性自干扰进行消除，这极大增加了过程的复杂度。此外，为了提高深度学习网络的训练能力，现有的基于深度学习的方法均将发射信号进行多段时间单位延时作为训练样本的多个特征，然而，具体延时的时间单位并没有统一的理论指导。延时过小会使训练样本的特征过少，无法真实反映多径信道，导致训练出来的网络效果较差；延时过大会使训练样本的特征过多，导致网络训练时间过长。发明内容本发明针对上述技术问题，提出一种基于LSTM的同时同频全双工数字域自干扰抑制方法，根据发射信号采用长短时记忆网络估计出自干扰信号，并从接收信号中减去以达到较好的自干扰抑制效果，大大降低运算的复杂度。为了实现上述目的，本发明提供如下技术方案：本发明提供一种基于LSTM的同时同频全双工数字域自干扰抑制方法，包括以下步骤：S1、获取参考信号：发射信号经过实部虚部的分离重构为只包含实值的参考信号；S2、构建自干扰信道，并得到自干扰信号：自干扰信道由非线性模型、多径信道和高斯信道组成，其中，非线性模型采用记忆多项式来建模；S3、数据预处理：通过BSO优化算法计算多径信道最大时延，将参考信号进行时间延时产生多个特征；S4、构建LSTM网络：LSTM网络由输入层、隐藏层和输出层构成全连接结构，隐藏层包含多个LSTM单元；时间延时产生的多个特征输入LSTM网络输入层，最终LSTM网络输出数据包含2个特征，分别为信号的实部和虚部；S5、利用LSTM网络对自干扰信号进行训练和预测，计算自干扰抑制能力。进一步地，步骤S2非线性模型采用记忆多项式来建模，表达式表示如下：式中，P，M分别表示多项式的阶数和记忆深度。进一步地，步骤S2多径信道用以下公式进行建模：其中，k为多径数，rk为多径衰减参数，τk为多径时延参数。进一步地，步骤S3中通过BSO算法优化确定延时的时间单位的过程为：首先随机初始化生成N个在搜索空间内均匀分布的个体，然后依据相似性利用K均值聚类将所有个体分为M个类；再依照所给适应度函数计算所有个体的适应度，并挑选出M个类中适应度最优的个体；最后通过迭代选出全局最优个体，即延时的时间单位。进一步地，步骤S4中，LSTM单元输入参数为当前时刻的输入Xt、上一时刻的单元状态输出Ct-1和上一时刻的隐藏层状态输出ht-1，输出参数为当前时刻单元状态输出Ct和当前时刻隐藏层状态输出ht。进一步地，LSTM单元内部由遗忘门f、输入门i、候选门g和输出门o组成，其中输入门i和候选门g用于输入，引入门用于保护和控制单元状态，遗忘门用于决定从细胞状态中丢弃的信息，输入门用于决定加入到单元状态中新的信息的数量，输出门用于基于单元状态决定最终的输出值。进一步地，状态参数Ct，ht的更新公式为：Ct＝ft⊙Ct-1+it⊙gtht＝ot⊙tanh 门结构的输出公式为：ft＝σit＝σgt＝tanhot＝σ LSTM网络在反向传播过程中每次迭代需要更新的参数如下：其中W为输入权重、R为循环权重、b为偏置。进一步地，步骤S5中，LSTM网络包括离线训练和在线预测两个过程，其中：离线训练，即在不接收期望信号的情况下，将预处理后的训练样本的参考信号作为LSTM网络的输入，训练样本的自干扰信号作为LSTM网络的输出进行训练；在线预测，即在训练过程结束后，在接收期望信号的同时，将预测样本的参考信号送入LSTM网络进行预测，然后从接收信号中减去预测的自干扰信号，从而实现自干扰抑制。进一步地，自干扰能力的计算公式如下：进一步地，LSTM网络损失函数计算公式如下：其中，R是预测样本的特征维度，L是预测样本的时间序列长度，S＝R×L为数据总数，y为网络预测输出，y′为预测样本的实际自干扰信号。与现有技术相比。本发明的有益效果为：1、现有的基于深度学习的方法通常仅利用深度学习网络来对非线性自干扰进行有效抑制，在实现过程中还需要采用额外的模块对线性自干扰进行消除，这极大增加了过程中的复杂度。本发明提出的一种基于LSTM的同时同频全双工数字域自干扰抑制方法，考虑到系统中非线性和线性自干扰都具有记忆性这一特点，利用具有记忆性的LSTM网络对非线性和线性自干扰同时进行抑制，无需采用额外的模块，简化流程，降低了过程的复杂度。同时利用记忆多项式对收发链路产生的非线性失真进行建模，降低计算复杂度，同时保证系统精度。2、现有的基于深度学习的方法将发射信号进行多段时间单位延时作为训练样本的多个特征，然而，具体延时的时间单位并没有统一的理论指导。本发明提出的一种基于LSTM的同时同频全双工数字域自干扰抑制方法，设计了一种自适应的数据预处理方法，采用头脑风暴优化算法对多径信道的时延和衰减进行自适应估计，将发射信号进行多段延时作为训练样本的多个特征，以有效适应多种多径信道情况，为具体延时的时间单位建立了统一的理论指导。附图说明为了更清楚地说明本申请实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明中记载的一些实施例，对于本领域普通技术人员来讲，还可以根据这些附图获得其他的附图。图1为本发明实施例提供的基于LSTM的同时同频全双工数字域自干扰抑制方法流程图。图2为本发明实施例提供的LSTM网络结构示意图。图3为本发明实施例提供的LSTM单元结构示意图。图4为本发明实施例提供的LSTM训练和预测过程示意图。图5为本发明实施例提供的OFDM参考信号产生过程示意图。图6为本发明实施例提供的OFDM信号帧结构示意图。图7为本发明实施例提供的利用LSTM网络进行信号预测的训练进度图。图8为本发明实施例提供的实际和预测自干扰信号频谱对比图。图9为本发明实施例提供的实际和预测自干扰信号模对比图。图10为本发明实施例提供的自干扰抑制能力随隐藏层单元数变化曲线。具体实施方式为了更好地理解本技术方案，下面结合附图对本发明的方法做详细的说明。在同时同频全双工通信系统中，由于收发链路采用了一些具有记忆性的非线性器件，例如数模转换器DAC、混频器、功率放大器PA、低噪声放大器LNA、模数转换器ADC等，导致接收到的自干扰信号存在非线性失真。自干扰信号经过的空间信道可以建模为多径信道，导致接收到的自干扰信号存在线性失真。本发明的技术方案以同时同频全双工系统架构为基础，产生发射信号作为参考信号，利用LSTM网络对自干扰信号进行预测。构建深度学习网络模型的目的是能够基于参考信号精确地重建出经过线性和非线性成分的自干扰信号，并将其在接收信号中减去，最终达到抑制自干扰信号的目的。由于非线性失真和线性失真都具有记忆性，LSTM网络能够有效处理时间序列相关的数据，因此可以采用LSTM网络来对自干扰信号进行重建。如图1所示，本发明提出一种基于LSTM的同时同频全双工数字域自干扰抑制方法，具体包括以下步骤：产生发射信号作为参考信号；随机生成多组发射信号作为LSTM网络的训练样本。因产生的发射信号为复数信号，而LSTM网络无法处理复数运算，因此需要将复数信号重构为只包含实值的形式。构建自干扰信道，并得到自干扰信号；自干扰信道由非线性模型、多径信道和高斯信道组成。非线性模型表征收发链路中使用的非线性器件产生的失真，设计中采用记忆多项式来建模，表达式可表示如下：式中，P，M分别表示多项式的阶数和记忆深度。多径信道表征发射信号在到达接收端之前所经历的直射路径和反射路径，以及由于传播距离、“阴影效应”等因素造成的信号幅度、相位和到达时间的不同。多条路径上的信号在接收端相互叠加会产生电平衰落和时延扩展。多径信道可用以下公式进行建模：其中，k为多径数，rk为多径衰减参数，τk为多径时延参数。高斯信道表征信号在空间传播过程中所受到的高斯噪声的影响，构建高斯信道时，添加高斯噪声，为信号设置合适的信噪比数据预处理，估计多径信道最大时延，将参考信号进行时间延时产生多个特征；为了提高LSTM网络的训练能力，将发射信号进行多段时间单位延时作为训练样本的多个特征，为了确定具体延时的时间单位，本设计采用了BSO算法寻找最优解。BSO算法采用聚类的思想寻找局部最优解，然后通过迭代确定全局最优解，可以应用其确定具体延时的时间单位。具体过程是，首先随机初始化生成N个在搜索空间内均匀分布的个体，然后依据相似性利用K均值聚类将所有个体分为M个类，再依照所给适应度函数计算所有个体的适应度，并挑选出M个类中适应度最优的个体，最后通过迭代选出全局最优个体，即时延单位。通过优化确定延时的时间单位后，将发射信号进行多段时间单位延时作为训练样本的多个特征。构建LSTM网络，设置网络参数；LSTM网络结构如图2所示，输入层、隐藏层和输出层构成全连接结构。OFDM信号经过实部虚部的分离重构为参考信号，经过时延扩展形成多个特征之后送入网络输入层。隐藏层包含多个LSTM单元，将隐藏层输出送入输出层，最终网络输出数据包含2个特征，分别为信号的实部虚部。图2中R为参考信号的实部，I为参考信号的虚部。隐藏层中每个LSTM单元结构如图3所示。LSTM单元输入参数为当前时刻的输入Xt、上一时刻的单元状态输出Ct-1和上一时刻的隐藏层状态输出ht-1，输出参数为当前时刻单元状态输出Ct和当前时刻隐藏层状态输出ht。LSTM单元内部由遗忘门f、输入门i、候选门g和输出门o组成，其中输入门i和候选门g用于输入，引入门用于保护和控制单元状态，遗忘门用于决定从细胞状态中丢弃的信息，输入门用于决定加入到单元状态中新的信息的数量，输出门用于基于单元状态决定最终的输出值。状态参数Ct，ht的更新公式为：Ct＝ft⊙Ct-1+it⊙gtht＝ot⊙tanh 门结构的输出公式为：ft＝σit＝σgt＝tanhot＝σ LSTM网络在反向传播过程中每次迭代需要更新的参数如下：其中W为输入权重、R为循环权重、b为偏置。LSTM网络训练和预测；如图4所示，LSTM网络包括离线训练和在线预测两个过程，其中：离线训练，即在不接收期望信号的情况下进行网络训练。设置迭代次数、隐含层数、小批量大小、学习率等参数，将预处理后的训练样本的参考信号作为LSTM网络的输入，训练样本的自干扰信号作为LSTM网络的输出进行训练；在线预测，即在训练过程结束后，在接收期望信号的同时，将预测样本的参考信号送入LSTM网络进行预测，然后从接收信号中减去预测的自干扰信号，从而实现自干扰抑制。计算自干扰抑制能力。本发明数字域自干扰消除的目的在于通过参考信号精确估计出自干扰信号的近似值，并从接收信号中减去以达到抑制自干扰的目的。自干扰能力的计算通常是在离线状态下进行计算的，计算公式如下：LSTM网络需解决的是一个回归问题，其参数迭代的最终目的在于最小化实际自干扰信号与估计自干扰信号之间的误差，得到损失函数loss的最小值，LSTM网络损失函数计算公式如下：其中，R是预测样本的特征维度，L是预测样本的时间序列长度，S＝R×L为数据总数，y为网络预测输出，y′为预测样本的实际自干扰信号。为了验证方法的有效性，本发明以OFDM信号作为参考信号进行软件仿真，具体过程如图5所示。随机生成多组OFDM信号作为LSTM网络的训练样本，OFDM信号的帧结构如图6所示。利用LSTM网络进行信号预测的训练进度如图7所示。由图7可得出，随着迭代次数的增加，均方根误差RMSE值下降，迭代结束之后RMSE值达到0.00035左右，说明预测值与真实值偏差很小。实际自干扰信号和预测自干扰信号频谱和模的对比如图8和图9所示。由图8和图9得出，实际自干扰信号和预测自干扰信号的频谱之差以及残留自干扰信号的模数值很小，可忽略不计，说明预测出的自干扰信号和实际自干扰信号误差较小，相似度较高。自干扰抑制能力随LSTM单元数的变化曲线如图10所示。由图10可得，过少或过多的LSTM单元数都不能使自干扰抑制能力达到最优，实验得出当LSTM单元数为50时，自干扰抑制能力达到最高，为47.7871dB。本发明提出的一种基于LSTM的同时同频全双工数字域自干扰抑制方法，利用具有记忆性的LSTM网络对非线性和线性自干扰同时进行抑制，达到较好的自干扰抑制效果，无需采用额外的模块，简化流程，降低了过程的复杂度。同时利用记忆多项式对收发链路产生的非线性失真进行建模，降低计算复杂度，同时保证系统精度。此外设计了一种自适应的数据预处理方法，采用头脑风暴优化算法对多径信道的时延和衰减进行自适应估计，将发射信号进行多段延时作为训练样本的多个特征，以有效适应多种多径信道情况，为具体延时的时间单位建立了统一的理论指导。以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换，但这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
