标题title
微型光伏系统多模式升压电路、装置、控制方法和介质
摘要abst
本申请涉及了一种微型光伏系统多模式升压电路、装置、控制方法和介质，包括主电路、信号采集装置、恒压控制回路、光伏并网恒流控制回路、光伏动态输出控制回路、三端口输入继电器和驱动电路；通过选择不同输入源、输出端和控制回路，分别实现独立恒压运行模式、并网恒流运行模式和光伏最大功率点动态稳定运行模式等多种运行模式；通过滤波网络平衡输入功率和输出功率的功率脉动，使得微型光伏系统的升压电路在高增益电压输出的同时，无需电解电容，提高光伏系统的集成度，延长系统使用寿命，并提高系统效率；通过滑膜控制回路，抑制并网所产生的高频电压振荡，保证微型光伏系统在最大功率点附近的动态运行稳定性。
权利要求书clms
1.一种微型光伏系统多模式升压电路，其特征在于，包括：主电路、信号采集装置、恒压控制回路、光伏并网恒流控制回路、光伏动态输出控制回路、三端口输入继电器JG和驱动电路；所述主电路用于选择不同输入源、输出端和控制回路，相应切换为独立恒压运行模式或并网运行模式，其中并网运行模式包括并网恒流运行模式和光伏最大功率点动态稳定运行模式，实现微型光伏系统多模式运行；所述主电路包括：光伏板vPV、直流电源Vin、二端口输入继电器J1、二端口输出继电器J2、光伏板滤波电容CPV、储能电容CS、输出第一滤波电容Co1、输出第二滤波电容Co2、第一二极管D1、第二二极管D2、第三二极管D3、第一开关管S1、第二开关管S2、第一电感L1、第二电感L2、负载R、电网直流链电压源vg；所述直流电源Vin的正极与二端口输入继电器J1的a端输入口连接；所述光伏板vPV的正极与二端口输入继电器J1的b端输入口连接；所述二端口输入继电器J1的输出端与第一二极管D1的阳极、光伏板滤波电容CPV的一端连接；所述光伏板滤波电容CPV的另一端与直流电源Vin的负极、光伏板vPV的负极连接；所述第一二极管D1的阴极与第一电感L1的正极、第一开关管S1的漏极连接；所述第一开关管S1的源极与第二二极管D2的阴极、第二电感L2的正极和储能电容CS的一端连接；所述储能电容CS的另一端与第二开关管S2的源极、第三二极管D3的阴极、光伏板滤波电容CPV的另一端连接；所述第一电感L1的负极与第二二极管D2的阳极、第二开关管S2的漏极和输出第一滤波电容Co1的一端连接；所述输出第一滤波电容Co1的另一端与第三二极管D3的阳极连接；所述第二电感L2的负极与二端口输出继电器J2的输入端、输出第二滤波电容Co2的一端连接；所述输出第二滤波电容Co2的另一端与负载R的负极、电网直流链电压源vg的负极和输出第一滤波电容Co1的另一端连接；所述二端口输出继电器J2的a端输出口与负载R的正极连接；所述二端口输出继电器J2的b端输出口与电网直流链电压源vg的正极连接。2.根据权利要求1所述的微型光伏系统多模式升压电路，其特征在于，所述信号采集装置包括：第一电压传感器M1、第二电压传感器M2、第三电压传感器M3、第一电流传感器T1、第二电流传感器T2、第三电流传感器T3、第四电流传感器T4；所述第一电压传感器M1的正极输入端与输出第二滤波电容Co2的一端连接，负极输入端与输出第二滤波电容Co2的另一端连接；所述第二电压传感器M2的正极输入端与电网直流链电压源vg的正极连接，负极输入端与电网直流链电压源vg的负极连接；所述第三电压传感器M3的正极输入端与光伏板vPV的正极连接，负极输入端与光伏板vPV的负极连接；所述第一电流传感器T1的输入端与电网直流链电压源vg的正极连接；所述第二电流传感器T2的输入端与光伏板vPV的正极连接；所述第三电流传感器T3的输入端与第一电感L1的正极连接；所述第四电流传感器T4的输入端与第二电感L2的正极连接；所述恒压控制回路包括：第一减法器Sub1、第一PI控制器、第一PWM信号发生器、输出第二滤波电容电压参考值VCo2*；所述第一减法器Sub1的正极输入端与输出第二滤波电容电压参考值VCo2*连接，第一减法器Sub1的负极输入端与第一电压传感器M1的输出端连接；所述第一减法器Sub1的输出端与第一PI控制器的输入端连接；所述第一PI控制器的输出端与第一PWM信号发生器的输入端连接；所述第一PWM信号发生器的输出端与三端口输入继电器JG的a端输入口连接；所述光伏并网恒流控制回路包括：锁相环PLL、正弦模块、第一乘法器Mul1、第二减法器Sub2、第二PI控制器、第二PWM信号发生器、峰值电网电流参考值ipref*；所述锁相环PLL的输入端与第二电压传感器M2的输出端连接；所述锁相环PLL的输出端与正弦模块的输入端连接；所述正弦模块的输出端与第一乘法器Mul1的第一输入端连接；所述第一乘法器Mul1的第二输入端与峰值电网电流参考值ipref*连接；所述第一乘法器Mul1的输出端与第二减法器Sub2的正极输入端连接；所述第二减法器Sub2的负极输入端与第一电流传感器T1的输出端连接；所述第二减法器Sub2的输出端与第二PI控制器的输入端连接；所述第二PI控制器的输出端与第二PWM信号发生器的输入端连接；所述第二PWM信号发生器的输出端与三端口输入继电器JG的b端输入口连接。3.根据权利要求1的微型光伏系统多模式升压电路，其特征在于，所述光伏动态输出控制回路由滑膜控制回路、滞后带控制回路和PWM信号发生器组成；所述滑膜控制回路包括：PO算法处理器、第一除法器Div1、第一加法器Sum1、第二加法器Sum2、第二乘法器Mul2、第三减法器Sub3、第四减法器Sub4、第五减法器Sub5、第三PI控制器；所述PO算法处理器的第一输入端与第三电压传感器M3的输出端连接；所述PO算法处理器的第二输入端与第二电流传感器T2的输出端连接；所述PO算法处理器的输出端与第三减法器Sub3的正极输入端连接；所述第三减法器Sub3的负极输入端与第三电压传感器M3的输出端连接；所述第三减法器Sub3的输出端与第三PI控制器的输入端连接；所述第三PI控制器的输出端与第五减法器Sub5的负极输入端连接；所述第一除法器Div1的第一输入端与第一电流传感器T1的输出端连接，第一除法器Div1的第二输入端与第四电流传感器T4的输出端连接；所述第一除法器Div1的输出端与第一加法器Sum1的第一输入端连接；所述第一加法器Sum1的第二输入端与常数1/2连接；所述第一加法器Sum1的输出端与第二乘法器Mul2的第一输入端连接；所述第二乘法器Mul2的第二输入端与第三电流传感器T3的输出端连接；所述第二乘法器Mul2的输出端与第二加法器Sum2的第一输入端连接；所述第二加法器Sum2的第二输入端与第一电流传感器T1的输出端连接，第二加法器Sum2的输出端与第四减法器Sub4的正极输入端连接；所述第四减法器Sub4的负极输入端与第二电流传感器T2的输出端连接，第四减法器Sub4的输出端与第五减法器Sub5的正极输入端连接；所述滞后带控制回路包括：第一比较器Comp1、第二比较器Comp2、5V稳压二极管DV、8个电阻R1至R8；电阻R1的正极与第五减法器Sub5的输出端连接；所述电阻R1的负极与第一比较器Comp1的正极输入端、电阻R2的负极连接；所述电阻R2的正极与5V稳压二极管DV的阴极、电阻R3的负极连接；所述5V稳压二极管DV的阳极与地连接；所述电阻R3的正极与5V电压连接；所述第一比较器Comp1的负极输入端与电阻R4的负极、电阻R5的正极连接；所述电阻R4的正极与地连接；所述电阻R5的负极与第一比较器Comp1的输出端、第二比较器Comp2的负极输入端连接；所述第二比较器Comp2的正极输入端与电阻R6、电阻R7的正极和电阻R8的负极连接；所述电阻R6的负极与地连接；所述电阻R8的正极与5V电压连接；所述第二比较器Comp2的输出端与电阻R7的负极、第三PWM信号发生器的输入端连接；所述第三PWM信号发生器的输出端与三端口输入继电器JG的c端输入口连接。4.根据权利要求1所述的微型光伏系统多模式升压电路，其特征在于：所述第一开关管S1和第二开关管S2为IGBT管；或所述第一开关管S1和第二开关管S2为NMOS管；所述第一开关管S1和第二开关管S2共用一个驱动信号；所述光伏板滤波电容CPV、储能电容CS、输出第一滤波电容Co1、输出第二滤波电容Co2均为非电解电容中的多层陶瓷电容，电容值均为10μF；所述第一电感L1的电感值为330μH，第二电感L2的电感值为33μH。5.根据权利要求2所述的微型光伏系统多模式升压电路，其特征在于：当恒压控制回路运行时，微型光伏系统多模式升压电路切换为独立恒压运行模式时，此时输出电压vo表达式为：其中，d为第一开关管S1和第二开关管S2的占空比；输出电压纹波Δvo表达式为：其中，f为微型光伏系统多模式升压电路在独立恒压运行模式下的开关管开关频率。6.根据权利要求3所述的微型光伏系统多模式升压电路，其特征在于，所述滑膜控制回路经第五减法器Sub5输出滑膜控制开关函数Ψ，该滑膜控制开关函数Ψ为：Ψ＝iL1+diL2-iPV-iPV-ref*，其中，iPV-ref*为光伏板PV电流参考值；所述滞后带控制回路通过引入滞后带H限制第一开关管S1和第二开关管S2的开关频率，该滞后带H表达式为：其中，fmax为第一开关管S1和第二开关管S2所支持开关频率最大实用值。7.一种微型光伏系统多模式升压电路装置，其特征在于，包括：权利要求1-6任一项所述的微型光伏系统多模式升压电路。8.一种微型光伏系统多模式升压控制方法，其特征在于，用于控制权利要求1-7任一项所述的微型光伏系统多模式升压电路；所述微型光伏系统多模式升压控制方法包括：S1：二端口输入继电器J1切换不同输入端口；若二端口输入继电器J1切换a端输入口直流电源Vin，微型光伏系统多模式升压电路实现独立恒压运行模式，进入步骤S2-11；若二端口输入继电器J1切换b端输入口光伏板vPV，微型光伏系统多模式升压电路实现并网运行模式，进入步骤S2-21；S2-11：二端口输出继电器J2切换a端输出口负载R；S2-12：第一电压传感器M1采集输出第二滤波电容电压实际值vCo2；S2-13：输出第二滤波电容电压实际值vCo2与输出第二滤波电容电压参考值VCo2*进行误差比较，并输出差值信号进入第一PI控制器；S2-14：第一PI控制器输出调节信号到第一PWM信号发生器，输出独立恒压控制信号G1，并进入步骤S3；S2-21：二端口输出继电器J2切换b端输出口电网直流链电压源vg；S2-22：第二电压传感器M2采集电网直流链实际电压值vg，第一电流传感器T1采集电网直流链实际电流值ig；若运行光伏并网恒流控制回路，微型光伏系统多模式升压电路实现并网恒流运行模式，进入步骤S2-23-11；若运行光伏动态输出控制回路，微型光伏系统多模式升压电路实现光伏最大功率点动态稳定运行模式，进入步骤S2-23-21；S2-23-11：电网直流链实际电压值vg依次经过锁相环PLL和正弦模块，并与峰值电网电流参考值ipref*相乘，生成电网电流参考值igref*；S2-23-12：电网电流参考值igref*与电网直流链实际电流值ig进行误差比较，并输出差值信号进入第二PI控制器；S2-23-13：第二PI控制器输出调节信号到第二PWM信号发生器，输出并网恒流控制信号G2，并进入步骤S3；S2-23-21：第三电压传感器M3采集光伏板实际电压值vPV，第二电流传感器T2采集光伏板实际输入电流值iPV，第三电流传感器T3采集第一电感实际电流值iL1，第四电流传感器T4采集第二电感实际电流值iL2；S2-23-22：光伏板实际电压值vPV和光伏板实际输入电流值iPV经过PO算法处理器生成PV电压参考值vPV-ref*，并输入到第三PI控制器中调节生成光伏板PV电流参考值iPV-ref*；S2-23-23：第一电感实际电流值iL1、第二电感实际电流值iL2、电网直流链实际电流值ig和光伏板PV电流参考值iPV-ref*经过数字运算电路输出滑膜控制开关函数Ψ；S2-23-24：滑膜控制开关函数Ψ经过滞后带开关电路后，输入到第三PWM信号发生器，输出符合运行频率规范的开关控制信号G3，并进入步骤S3；S3：独立恒压控制信号G1，并网恒流控制信号G2和开关控制信号G3分别输入到三端口输入继电器JG的a，b，c输入端口当中，三端口输入继电器JG的输出端口经驱动电路输出驱动信号到第一开关管S1和第一开关管S2。9.一种存储介质，其特征在于，所述存储介质是计算机可读的，且存储介质上存储有微型光伏系统多模式升压控制程序，所述微型光伏系统多模式升压控制程序被处理器执行时实现如权利要求8中S2-13、S2-14、S2-23-11至S2-23-13及S2-23-22至S2-23-24所述的微型光伏系统多模式升压控制方法的步骤。
说明书desc
技术领域本发明涉及光伏系统的前级电压变换技术领域，具体涉及一种微型光伏系统多模式升压电路、装置、控制方法和存储介质。背景技术全球环境问题引发了强烈关注，而大量使用化石能源导致的高碳排放量加剧生态环境污染问题。因此，开发利用低成本、低风险、低污染、可再生的新能源变得尤为重要，其中基于太阳能的光伏发电系统是目前热度较高、且技术发展较为成熟的新能源发电系统。然而，光伏发电系统中存在输出电压低、易受环境影响等问题,不能满足电网对光伏发电的并网要求。传统DC-DC升压变换器的电压增益也不足以满足光伏发电结构所需的宽范围和大波动性的升压条件。针对以上问题，目前已开发出多种高电压增益DC-DC变换器，这些变换器往往需要较大容值与耐压值的电解电容，降低光伏发电系统的使用寿命，与此同时，也会相应大幅增加变换器的体积和成本，降低电路功率密度和光伏系统发电效率。因此，如何设计一种无需电解电容的光伏系统电压变换装置，提高输出电压增益，并将高功率脉动的输出电压变化为稳定的并网电压，延长系统寿命并加速光伏发电系统的发展小型化，是本领域人员亟需解决的问题。发明内容基于以上技术问题，本发明提供一种微型光伏系统多模式升压电路、装置、控制方法和存储介质，可以在提高输出电压增益的同时平衡输入功率和输出功率的功率脉动，避免使用大容量、大体积的电解电容，减小光伏发电系统的功率密度，同时延长系统寿命并实现微型光伏系统的多种运行模式，并进一步优化光伏发电系统的整体性能。本发明一方面提供了一种微型光伏系统多模式升压电路，在其中一个实施例中，所述微型光伏系统多模式升压电路具体包括：主电路、信号采集装置、恒压控制回路、光伏并网恒流控制回路、光伏动态输出控制回路、三端口输入继电器JG和驱动电路；所述主电路用于选择不同输入源、输出端和控制回路，相应切换为独立恒压运行模式或并网运行模式，其中并网运行模式包括并网恒流运行模式和光伏最大功率点动态稳定运行模式，实现微型光伏系统多模式运行；所述主电路包括：光伏板vPV、直流电源Vin、二端口输入继电器J1、二端口输出继电器J2、光伏板滤波电容CPV、储能电容CS、输出第一滤波电容Co1、输出第二滤波电容Co2、第一二极管D1、第二二极管D2、第三二极管D3、第一开关管S1、第二开关管S2、第一电感L1、第二电感L2、负载R、电网直流链电压源vg；所述直流电源Vin的正极与二端口输入继电器J1的a端输入口连接；所述光伏板vPV的正极与二端口输入继电器J1的b端输入口连接；所述二端口输入继电器J1的输出端与第一二极管D1的阳极、光伏板滤波电容CPV的一端连接；所述光伏板滤波电容CPV的另一端与直流电源Vin的负极、光伏板vPV的负极连接；所述第一二极管D1的阴极与第一电感L1的正极、第一开关管S1的漏极连接；所述第一开关管S1的源极与第二二极管D2的阴极、第二电感L2的正极和储能电容CS的一端连接；所述储能电容CS的另一端与第二开关管S2的源极、第三二极管D3的阴极、光伏板滤波电容CPV的另一端连接；所述第一电感L1的负极与第二二极管D2的阳极、第二开关管S2的漏极和输出第一滤波电容Co1的一端连接；所述输出第一滤波电容Co1的另一端与第三二极管D3的阳极连接；所述第二电感L2的负极与二端口输出继电器J2的输入端、输出第二滤波电容Co2的一端连接；所述输出第二滤波电容Co2的另一端与负载R的负极、电网直流链电压源vg的负极和输出第一滤波电容Co1的另一端连接；所述二端口输出继电器J2的a端输出口与负载R的正极连接；所述二端口输出继电器J2的b端输出口与电网直流链电压源vg的正极连接。在其中一个实施例中，所述信号采集装置包括：第一电压传感器M1、第二电压传感器M2、第三电压传感器M3、第一电流传感器T1、第二电流传感器T2、第三电流传感器T3、第四电流传感器T4；所述第一电压传感器M1的正极输入端与输出第二滤波电容Co2的一端连接，负极输入端与输出第二滤波电容Co2的另一端连接；所述第二电压传感器M2的正极输入端与电网直流链电压源vg的正极连接，负极输入端与电网直流链电压源vg的负极连接；所述第三电压传感器M3的正极输入端与光伏板vPV的正极连接，负极输入端与光伏板vPV的负极连接；所述第一电流传感器T1的输入端与电网直流链电压源vg的正极连接；所述第二电流传感器T2的输入端与光伏板vPV的正极连接；所述第三电流传感器T3的输入端与第一电感L1的正极连接；所述第四电流传感器T4的输入端与第二电感L2的正极连接；所述微型光伏系统多模式升压电路中的恒压控制回路包括：第一减法器Sub1、第一PI控制器、第一PWM信号发生器、输出第二滤波电容电压参考值VCo2*；所述第一减法器Sub1的正极输入端与输出第二滤波电容电压参考值VCo2*连接，第一减法器Sub1的负极输入端与第一电压传感器M1的输出端连接；所述第一减法器Sub1的输出端与第一PI控制器的输入端连接；所述第一PI控制器的输出端与第一PWM信号发生器的输入端连接；所述第一PWM信号发生器的输出端与三端口输入继电器JG的a端输入口连接；所述光伏并网恒流控制回路包括：锁相环PLL、正弦模块、第一乘法器Mul1、第二减法器Sub2、第二PI控制器、第二PWM信号发生器、峰值电网电流参考值ipref*；所述锁相环PLL的输入端与第二电压传感器M2的输出端连接；所述锁相环PLL的输出端与正弦模块的输入端连接；所述正弦模块的输出端与第一乘法器Mul1的第一输入端连接；所述第一乘法器Mul1的第二输入端与峰值电网电流参考值ipref*连接；所述第一乘法器Mul1的输出端与第二减法器Sub2的正极输入端连接；所述第二减法器Sub2的负极输入端与第一电流传感器T1的输出端连接；所述第二减法器Sub2的输出端与第二PI控制器的输入端连接；所述第二PI控制器的输出端与第二PWM信号发生器的输入端连接；所述第二PWM信号发生器的输出端与三端口输入继电器JG的b端输入口连接。在其中一个实施例中，所述微型光伏系统多模式升压电路中的光伏动态输出控制回路由滑膜控制回路、滞后带控制回路和PWM信号发生器组成；所述滑膜控制回路包括：PO算法处理器、第一除法器Div1、第一加法器Sum1、第二加法器Sum2、第二乘法器Mul2、第三减法器Sub3、第四减法器Sub4、第五减法器Sub5、第三PI控制器；所述PO算法处理器的第一输入端与第三电压传感器M3的输出端连接；所述PO算法处理器的第二输入端与第二电流传感器T2的输出端连接；所述PO算法处理器的输出端与第三减法器Sub3的正极输入端连接；所述第三减法器Sub3的负极输入端与第三电压传感器M3的输出端连接；所述第三减法器Sub3的输出端与第三PI控制器的输入端连接；所述第三PI控制器的输出端与第五减法器Sub5的负极输入端连接；所述第一除法器Div1的第一输入端与第一电流传感器T1的输出端连接，第一除法器Div1的第二输入端与第四电流传感器T4的输出端连接；所述第一除法器Div1的输出端与第一加法器Sum1的第一输入端连接；所述第一加法器Sum1的第二输入端与常数1/2连接；所述第一加法器Sum1的输出端与第二乘法器Mul2的第一输入端连接；所述第二乘法器Mul2的第二输入端与第三电流传感器T3的输出端连接；所述第二乘法器Mul2的输出端与第二加法器Sum2的第一输入端连接；所述第二加法器Sum2的第二输入端与第一电流传感器T1的输出端连接，第二加法器Sum2的输出端与第四减法器Sub4的正极输入端连接；所述第四减法器Sub4的负极输入端与第二电流传感器T2的输出端连接，第四减法器Sub4的输出端与第五减法器Sub5的正极输入端连接；所述滞后带控制回路包括：第一比较器Comp1、第二比较器Comp2、5V稳压二极管DV、8个电阻R1至R8；电阻R1的正极与第五减法器Sub5的输出端连接；所述电阻R1的负极与第一比较器Comp1的正极输入端、电阻R2的负极连接；所述电阻R2的正极与5V稳压二极管DV的阴极、电阻R3的负极连接；所述5V稳压二极管DV的阳极与地连接；所述电阻R3的正极与5V电压连接；所述第一比较器Comp1的负极输入端与电阻R4的负极、电阻R5的正极连接；所述电阻R4的正极与地连接；所述电阻R5的负极与第一比较器Comp1的输出端、第二比较器Comp2的负极输入端连接；所述第二比较器Comp2的正极输入端与电阻R6、电阻R7的正极和电阻R8的负极连接；所述电阻R6的负极与地连接；所述电阻R8的正极与5V电压连接；所述第二比较器Comp2的输出端与电阻R7的负极、第三PWM信号发生器的输入端连接；所述第三PWM信号发生器的输出端与三端口输入继电器JG的c端输入口连接。在其中一个实施例中，所述微型光伏系统多模式升压电路中的第一开关管S1和第二开关管S2为IGBT管；或所述第一开关管S1和第二开关管S2为NMOS管；所述第一开关管S1和第二开关管S2共用一个驱动信号；所述光伏板滤波电容CPV、储能电容CS、输出第一滤波电容Co1、输出第二滤波电容Co2均为非电解电容中的多层陶瓷电容，电容值均为10μF；所述第一电感L1的电感值为330μH，第二电感L2的电感值为33μH。在其中一个实施例中，所述微型光伏系统多模式升压电路，其特征在于：当恒压控制回路运行时，微型光伏系统多模式升压电路切换为独立恒压运行模式时，此时输出电压vo表达式为：其中，d为第一开关管S1和第二开关管S2的占空比；输出电压纹波Δvo表达式为：其中，f为微型光伏系统多模式升压电路在独立恒压运行模式下的开关管开关频率。在其中一个实施例中，所述微型光伏系统多模式升压电路，其特征在于，所述滑膜控制回路经第五减法器Sub5输出滑膜控制开关函数Ψ，该滑膜控制开关函数Ψ为：Ψ＝iL1+diL2-iPV-iPV-ref*，其中，iPV-ref*为光伏板PV电流参考值；所述滞后带控制回路通过引入滞后带H限制第一开关管S1和第二开关管S2的开关频率，该滞后带H表达式为：其中，fmax为第一开关管S1和第二开关管S2所支持开关频率最大实用值。本发明第二方面还提供了一种微型光伏系统多模式升压电路装置，其特征在于，包括：前述任一实施案例中所述的微型光伏系统多模式升压电路。本发明第三方面还提供了一种微型光伏系统多模式升压控制方法，其特征在于，用于控制前述任一实施案例中所述的微型光伏系统多模式升压电路；所述微型光伏系统多模式升压控制方法包括：S1：二端口输入继电器J1切换不同输入端口；若二端口输入继电器J1切换a端输入口直流电源Vin，微型光伏系统多模式升压电路实现独立恒压运行模式，进入步骤S2-11；若二端口输入继电器J1切换b端输入口光伏板vPV，微型光伏系统多模式升压电路实现并网运行模式，进入步骤S2-21；S2-11：二端口输出继电器J2切换a端输出口负载R；S2-12：第一电压传感器M1采集输出第二滤波电容电压实际值vCo2；S2-13：输出第二滤波电容电压实际值vCo2与输出第二滤波电容电压参考值VCo2*进行误差比较，并输出差值信号进入第一PI控制器；S2-14：第一PI控制器输出调节信号到第一PWM信号发生器，输出独立恒压控制信号G1，并进入步骤S3；S2-21：二端口输出继电器J2切换b端输出口电网直流链电压源vg；S2-22：第二电压传感器M2采集电网直流链实际电压值vg，第一电流传感器T1采集电网直流链实际电流值ig；若运行光伏并网恒流控制回路，微型光伏系统多模式升压电路实现并网恒流运行模式，进入步骤S2-23-11；若运行光伏动态输出控制回路，微型光伏系统多模式升压电路实现光伏最大功率点动态稳定运行模式，进入步骤S2-23-21；S2-23-11：电网直流链实际电压值vg依次经过锁相环PLL和正弦模块，并与峰值电网电流参考值ipref*相乘，生成电网电流参考值igref*；S2-23-12：电网电流参考值igref*与电网直流链实际电流值ig进行误差比较，并输出差值信号进入第二PI控制器；S2-23-13：第二PI控制器输出调节信号到第二PWM信号发生器，输出并网恒流控制信号G2，并进入步骤S3；S2-23-21：第三电压传感器M3采集光伏板实际电压值vPV，第二电流传感器T2采集光伏板实际输入电流值iPV，第三电流传感器T3采集第一电感实际电流值iL1，第四电流传感器T4采集第二电感实际电流值iL2；S2-23-22：光伏板实际电压值vPV和光伏板实际输入电流值iPV经过PO算法处理器生成PV电压参考值vPV-ref*，并输入到第三PI控制器中调节生成光伏板PV电流参考值iPV-ref*；S2-23-23：第一电感实际电流值iL1、第二电感实际电流值iL2、电网直流链实际电流值ig和光伏板PV电流参考值iPV-ref*经过数字运算电路输出滑膜控制开关函数Ψ；S2-23-24：滑膜控制开关函数Ψ经过滞后带开关电路后，输入到第三PWM信号发生器，输出符合运行频率规范的开关控制信号G3，并进入步骤S3；S3：独立恒压控制信号G1，并网恒流控制信号G2和开关控制信号G3分别输入到三端口输入继电器JG的a，b，c输入端口当中，三端口输入继电器JG的输出端口经驱动电路输出驱动信号到第一开关管S1和第一开关管S2。本发明第四方面还提供了一种存储介质，其特征在于，所述存储介质是计算机可读的，且存储介质上存储有微型光伏系统多模式升压控制程序，所述微型光伏系统多模式升压控制程序被处理器执行时实现上一实施案例中S2-13、S2-14、S2-23-11至S2-23-13及S2-23-22至S2-23-24所述的微型光伏系统多模式升压控制方法的步骤。本发明的上述技术方案相比较现有技术，具有以下有益效果：本发明的微型光伏系统多模式升压电路相比传统电路，在具有更高的增益的同时，可以平衡输入功率和输出功率的功率脉动，具有更小的输出电压纹波；本发明可以避免使用大容量、大体积的电解电容，使用小容值的多层陶瓷电容，减小光伏发电系统的功率密度，同时延长系统寿命；通过多端口继电器和多个控制回路等微型光伏系统的多模式运行，并网模式下通过滑膜控制回路，抑制并网时产生的高频电压振荡，保证系统在最大功率点附近的动态运行稳定性。附图说明为了更清楚地说明本发明实施例中的技术方案，下面将对现有技术和实施例中所需要使用的附图作简单地介绍。图1为本申请提供的一种微型光伏系统多模式升压电路的结构及拓扑示意图；图2为本申请提供的一种微型光伏系统多模式升压控制方法的工作流程图；图3为本申请一个实施案例中提供的微型光伏系统多模式升压电路在独立恒压运行模式下的模态1示意图；图4为本申请一个实施案例中提供的微型光伏系统多模式升压电路在独立恒压运行模式下的模态2示意图；图5为本申请一个实施案例中提供的微型光伏系统多模式升压电路在独立恒压运行模式下一个工作周期的工作波形图；图6为本申请一个实施案例中提供的微型光伏系统多模式升压电路与传统电解电容开关升压变换器的增益曲线图。具体实施方式为了能够更清楚地理解本发明的上述目的、特征和优点，下面结合附图中的实例对本发明作进一步的描述。附图中给出仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。需要说明的是，在本说明书中，诸如第一和第二等之类的关系术语仅仅用来将一个实体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存在任何这种实际的关系或者顺序。术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。如图一所示为本发明提出的一种微型光伏系统多模式升压电路的结构及拓扑示意图。在其中一个实施例中，如图1所示，所述微型光伏系统多模式升压电路具体包括：主电路、信号采集装置、恒压控制回路、光伏并网恒流控制回路、光伏动态输出控制回路、三端口输入继电器JG和驱动电路；所述主电路用于选择不同输入源、输出端和控制回路，相应切换为独立恒压运行模式或并网运行模式，其中并网运行模式包括并网恒流运行模式和光伏最大功率点动态稳定运行模式，实现微型光伏系统多模式运行；所述主电路包括：光伏板vPV、直流电源Vin、二端口输入继电器J1、二端口输出继电器J2、光伏板滤波电容CPV、储能电容CS、输出第一滤波电容Co1、输出第二滤波电容Co2、第一二极管D1、第二二极管D2、第三二极管D3、第一开关管S1、第二开关管S2、第一电感L1、第二电感L2、负载R、电网直流链电压源vg；所述直流电源Vin的正极与二端口输入继电器J1的a端输入口连接；所述光伏板vPV的正极与二端口输入继电器J1的b端输入口连接；所述二端口输入继电器J1的输出端与第一二极管D1的阳极、光伏板滤波电容CPV的一端连接；所述光伏板滤波电容CPV的另一端与直流电源Vin的负极、光伏板vPV的负极连接；所述第一二极管D1的阴极与第一电感L1的正极、第一开关管S1的漏极连接；所述第一开关管S1的源极与第二二极管D2的阴极、第二电感L2的正极和储能电容CS的一端连接；所述储能电容CS的另一端与第二开关管S2的源极、第三二极管D3的阴极、光伏板滤波电容CPV的另一端连接；所述第一电感L1的负极与第二二极管D2的阳极、第二开关管S2的漏极和输出第一滤波电容Co1的一端连接；所述输出第一滤波电容Co1的另一端与第三二极管D3的阳极连接；所述第二电感L2的负极与二端口输出继电器J2的输入端、输出第二滤波电容Co2的一端连接；所述输出第二滤波电容Co2的另一端与负载R的负极、电网直流链电压源vg的负极和输出第一滤波电容Co1的另一端连接；所述二端口输出继电器J2的a端输出口与负载R的正极连接；所述二端口输出继电器J2的b端输出口与电网直流链电压源vg的正极连接。所述微型光伏系统多模式升压电路中的信号采集装置包括：第一电压传感器M1、第二电压传感器M2、第三电压传感器M3、第一电流传感器T1、第二电流传感器T2、第三电流传感器T3、第四电流传感器T4；所述第一电压传感器M1的正极输入端与输出第二滤波电容Co2的一端连接，负极输入端与输出第二滤波电容Co2的另一端连接；所述第二电压传感器M2的正极输入端与电网直流链电压源vg的正极连接，负极输入端与电网直流链电压源vg的负极连接；所述第三电压传感器M3的正极输入端与光伏板vPV的正极连接，负极输入端与光伏板vPV的负极连接；所述第一电流传感器T1的输入端与电网直流链电压源vg的正极连接；所述第二电流传感器T2的输入端与光伏板vPV的正极连接；所述第三电流传感器T3的输入端与第一电感L1的正极连接；所述第四电流传感器T4的输入端与第二电感L2的正极连接；所述微型光伏系统多模式升压电路中的恒压控制回路包括：第一减法器Sub1、第一PI控制器、第一PWM信号发生器、输出第二滤波电容电压参考值VCo2*；所述第一减法器Sub1的正极输入端与输出第二滤波电容电压参考值VCo2*连接，第一减法器Sub1的负极输入端与第一电压传感器M1的输出端连接；所述第一减法器Sub1的输出端与第一PI控制器的输入端连接；所述第一PI控制器的输出端与第一PWM信号发生器的输入端连接；所述第一PWM信号发生器的输出端与三端口输入继电器JG的a端输入口连接；所述光伏并网恒流控制回路包括：锁相环PLL、正弦模块、第一乘法器Mul1、第二减法器Sub2、第二PI控制器、第二PWM信号发生器、峰值电网电流参考值ipref*；所述锁相环PLL的输入端与第二电压传感器M2的输出端连接；所述锁相环PLL的输出端与正弦模块的输入端连接；所述正弦模块的输出端与第一乘法器Mul1的第一输入端连接；所述第一乘法器Mul1的第二输入端与峰值电网电流参考值ipref*连接；所述第一乘法器Mul1的输出端与第二减法器Sub2的正极输入端连接；所述第二减法器Sub2的负极输入端与第一电流传感器T1的输出端连接；所述第二减法器Sub2的输出端与第二PI控制器的输入端连接；所述第二PI控制器的输出端与第二PWM信号发生器的输入端连接；所述第二PWM信号发生器的输出端与三端口输入继电器JG的b端输入口连接。所述微型光伏系统多模式升压电路中的光伏动态输出控制回路由滑膜控制回路、滞后带控制回路和PWM信号发生器组成；所述滑膜控制回路包括：PO算法处理器、第一除法器Div1、第一加法器Sum1、第二加法器Sum2、第二乘法器Mul2、第三减法器Sub3、第四减法器Sub4、第五减法器Sub5、第三PI控制器；所述PO算法处理器的第一输入端与第三电压传感器M3的输出端连接；所述PO算法处理器的第二输入端与第二电流传感器T2的输出端连接；所述PO算法处理器的输出端与第三减法器Sub3的正极输入端连接；所述第三减法器Sub3的负极输入端与第三电压传感器M3的输出端连接；所述第三减法器Sub3的输出端与第三PI控制器的输入端连接；所述第三PI控制器的输出端与第五减法器Sub5的负极输入端连接；所述第一除法器Div1的第一输入端与第一电流传感器T1的输出端连接，第一除法器Div1的第二输入端与第四电流传感器T4的输出端连接；所述第一除法器Div1的输出端与第一加法器Sum1的第一输入端连接；所述第一加法器Sum1的第二输入端与常数1/2连接；所述第一加法器Sum1的输出端与第二乘法器Mul2的第一输入端连接；所述第二乘法器Mul2的第二输入端与第三电流传感器T3的输出端连接；所述第二乘法器Mul2的输出端与第二加法器Sum2的第一输入端连接；所述第二加法器Sum2的第二输入端与第一电流传感器T1的输出端连接，第二加法器Sum2的输出端与第四减法器Sub4的正极输入端连接；所述第四减法器Sub4的负极输入端与第二电流传感器T2的输出端连接，第四减法器Sub4的输出端与第五减法器Sub5的正极输入端连接；所述滞后带控制回路包括：第一比较器Comp1、第二比较器Comp2、5V稳压二极管DV、8个电阻R1至R8；电阻R1的正极与第五减法器Sub5的输出端连接；所述电阻R1的负极与第一比较器Comp1的正极输入端、电阻R2的负极连接；所述电阻R2的正极与5V稳压二极管DV的阴极、电阻R3的负极连接；所述5V稳压二极管DV的阳极与地连接；所述电阻R3的正极与5V电压连接；所述第一比较器Comp1的负极输入端与电阻R4的负极、电阻R5的正极连接；所述电阻R4的正极与地连接；所述电阻R5的负极与第一比较器Comp1的输出端、第二比较器Comp2的负极输入端连接；所述第二比较器Comp2的正极输入端与电阻R6、电阻R7的正极和电阻R8的负极连接；所述电阻R6的负极与地连接；所述电阻R8的正极与5V电压连接；所述第二比较器Comp2的输出端与电阻R7的负极、第三PWM信号发生器的输入端连接；所述第三PWM信号发生器的输出端与三端口输入继电器JG的c端输入口连接。如图二所示为本发明提出的一种微型光伏系统多模式升压控制方法的工作流程图，该控制方法的特征在于，用于控制前述实施案例中所述的微型光伏系统多模式升压电路；所述微型光伏系统多模式升压控制方法包括：S1：二端口输入继电器J1切换不同输入端口；若二端口输入继电器J1切换a端输入口直流电源Vin，微型光伏系统多模式升压电路实现独立恒压运行模式，进入步骤S2-11；若二端口输入继电器J1切换b端输入口光伏板vPV，微型光伏系统多模式升压电路实现并网运行模式，进入步骤S2-21；S2-11：二端口输出继电器J2切换a端输出口负载R；S2-12：第一电压传感器M1采集输出第二滤波电容电压实际值vCo2；S2-13：输出第二滤波电容电压实际值vCo2与输出第二滤波电容电压参考值VCo2*进行误差比较，并输出差值信号进入第一PI控制器；S2-14：第一PI控制器输出调节信号到第一PWM信号发生器，输出独立恒压控制信号G1，并进入步骤S3；S2-21：二端口输出继电器J2切换b端输出口电网直流链电压源vg；S2-22：第二电压传感器M2采集电网直流链实际电压值vg，第一电流传感器T1采集电网直流链实际电流值ig；若运行光伏并网恒流控制回路，微型光伏系统多模式升压电路实现并网恒流运行模式，进入步骤S2-23-11；若运行光伏动态输出控制回路，微型光伏系统多模式升压电路实现光伏最大功率点动态稳定运行模式，进入步骤S2-23-21；S2-23-11：电网直流链实际电压值vg依次经过锁相环PLL和正弦模块，并与峰值电网电流参考值ipref*相乘，生成电网电流参考值igref*；S2-23-12：电网电流参考值igref*与电网直流链实际电流值ig进行误差比较，并输出差值信号进入第二PI控制器；S2-23-13：第二PI控制器输出调节信号到第二PWM信号发生器，输出并网恒流控制信号G2，并进入步骤S3；S2-23-21：第三电压传感器M3采集光伏板实际电压值vPV，第二电流传感器T2采集光伏板实际输入电流值iPV，第三电流传感器T3采集第一电感实际电流值iL1，第四电流传感器T4采集第二电感实际电流值iL2；S2-23-22：光伏板实际电压值vPV和光伏板实际输入电流值iPV经过PO算法处理器生成PV电压参考值vPV-ref*，并输入到第三PI控制器中调节生成光伏板PV电流参考值iPV-ref*；S2-23-23：第一电感实际电流值iL1、第二电感实际电流值iL2、电网直流链实际电流值ig和光伏板PV电流参考值iPV-ref*经过数字运算电路输出滑膜控制开关函数Ψ；S2-23-24：滑膜控制开关函数Ψ经过滞后带开关电路后，输入到第三PWM信号发生器，输出符合运行频率规范的开关控制信号G3，并进入步骤S3；S3：独立恒压控制信号G1，并网恒流控制信号G2和开关控制信号G3分别输入到三端口输入继电器JG的a，b，c输入端口当中，三端口输入继电器JG的输出端口经驱动电路输出驱动信号到第一开关管S1和第一开关管S2。特别地，为了对本发明所述微型光伏系统多模式升压电路在各个模态的工作状态进行分析，在本说明书中，以本发明在独立恒压运行模式下的运行状况作为实例，进行解释说明，其中图3和图4为该实例在独立恒压运行模式下的不同模态的等效电路示意图，图5为该实例在独立恒压运行模式下一个工作周期的工作波形图。当本发明所提出的微型光伏系统多模式升压电路切换为独立恒压运行模式时，此时恒压控制回路运行，二端口输入继电器J1切换a端输入口直流电源Vin，二端口输出继电器J2切换a端输出口负载R。具体地，当电路工作在独立恒压运行模式的模态1时，如图3所示，此时第一开关管S1和第一开关管S2均导通，第一二极管D1、第二二极管D2和第三二极管D3均关断，储能电容CS和输出第一滤波电容Co1同时给输出第二滤波电容Co2和负载R充电，第一电感L1、第二电感L2和负载R共同组成了图5中的LC振荡电路结构，以减小电路的结构纹波和陡度；第二电感L2的电流iL2逐渐上升，该模态的工作波形如图5所示；当电路工作在直流驱动模式的模态2时，如图3所示，此时第一开关管S1和第一开关管S2均关断，第一二极管D1、第二二极管D2和第三二极管D3均正向导通，输入电源Vin和第一电感L1为储能电容CS和输出第一滤波电容Co1充电，输出第二滤波电容Co2维持负载电压R，第二电感L2的电流iL2逐渐下降，该模态的工作波形如图5所示。作为一种优选地实施例，所述光伏板滤波电容CPV、储能电容CS、输出第一滤波电容Co1、输出第二滤波电容Co2均为非电解电容中的多层陶瓷电容，电容值均为10μF；所述第一电感L1的电感值为330μH，第二电感L2的电感值为33μH。由前述的模态分析，可得第一电感L1的电压为：对于，第二电感L2，其电压为：第二电感L2的平均电流和电流纹波分别为：根据伏秒平衡原理可得，储能电容CS的电压为：其中，d为第一开关管S1和第二开关管S2的占空比。由图4可得，输出第一滤波电容Co1的电压为：由图3和伏秒平衡原理可得，输出电压vo表达式为：由公式、、、电感电容参数值和图5结合可推导出，输出电压纹波Δvo表达式为：其中，f为微型光伏系统多模式升压电路在独立恒压运行模式下的开关管开关频率。图6所示为本实例中的微型光伏系统多模式升压电路与传统电解电容开关升压变换器的增益曲线图，其中微型光伏系统多模式升压电路的增益是传统电解电容开关升压变换器的增益是/＞可见本实例的电路增益得到提升。当微型光伏系统多模式升压电路中切换到光伏最大功率点动态稳定运行模式，此时光伏动态输出控制回路运行，对于输出第一滤波电容Co1，当第一开关管S1和第二开关管S2均导通时，其导通时电容电流iCo1-on为iL2，当第一开关管S1和第二开关管S2均关断时，其关断时电容电流iCo1-off为：因此输出第一滤波电容Co1的安秒平衡表达式为：由此得到电感电流平衡表达式为：光伏并网模式下，对光伏板滤波电容CPV电流iCPV的安秒平衡表达式进行建模，得到本案例电路的光伏输入电流控制表达式为：iCPV＝iL1-iPV-iPV-ref＝0 其中滑膜控制回路经第五减法器Sub5输出滑膜控制开关函数Ψ，该滑膜控制开关函数Ψ应为电感电流平衡表达式和输入电流控制表达式的和，因此，滑膜控制开关函数Ψ的表达式：Ψ＝iL1+diL2-iPV-iPV-ref* 其中，iPV-ref*为光伏板PV电流参考值；其中，滑膜控制开关函数存在纹波ΔΨ，通过滞后带控制回路引入和滑膜控制开关函数纹波ΔΨ相等的滞后带H，以此来限制第一开关管S1和第二开关管S2的开关频率，其中滞后带H产生较长的开关周期Tmax；对于第一电感L1和第一电感L2，从光伏板vPV处分析可得，电流纹波表达式为：在考虑电流纹波的情况下，由公式和可推导出：iL1-iPV-iPV-ref＝0+ΔiL1 综上，将公式和相加可得，滑膜控制开关函数纹波ΔΨ的表达式为：联立公式、和得到滞后带H表达式为：其中，fmax为第一开关管S1和第二开关管S2所支持开关频率最大实用值。作为一种优选地实施例，所述第一开关管S1和第二开关管S2共用一个驱动信号；作为一种优选地实施例，所述微型光伏系统多模式升压电路中的第一开关管S1和第二开关管S2均为NMOS管；作为一种优选地实施例，所述微型光伏系统多模式升压电路中的第一开关管S1和第二开关管S2均为IGBT管。另外，这里的第一开关管S1和第二开关管S2还可以选择其他类型的开关管，本申请在此不做特别的限定，根据实际情况来定。以上所述，仅是本发明的较佳实施例，并非对本发明做任何限制，凡是根据本发明技术实质对以上实施例所做的任何简单修改、变更以及等效结构变化，均仍属于本发明技术方案的保护范围内。
