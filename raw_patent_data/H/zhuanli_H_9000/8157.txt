标题title
一种高效恒定轮次安全多方计算协议的优化方法和系统
摘要abst
本申请涉及计算机技术领域，提供一种高效恒定轮次安全多方计算协议的优化方法和系统。该方法包括：所有参与方并行执行优化的Tiny‑OT协议，以生成多个Beaver乘法三元组；AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路；各参与方Pi将多个AND三元组的承诺值进行线性组合，得到承诺组合结果；各参与方Pi打开承诺组合结果并检查多个AND三元组的正确性。通过在优化的Tiny‑OT协议中批量处理AND三元组的正确性检查，实现将AND三元组生成和正确性检查集成到一个协议中，减少了AND三元组的正确性检查的承诺数量和调用哈希函数的数量，并避免使用额外的OT操作来解密电路，优化了通信效率。
权利要求书clms
1.一种高效恒定轮次安全多方计算协议的优化方法，其特征在于，所述安全多方计算协议包括预处理阶段和在线评估阶段；所述安全多方协议的参与方有多个，Pi表示第i个参与方，i取值为1，2，…n；n表示参与方的总数；包括：所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；所述AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路；各参与方Pi将所述多个AND三元组的承诺值进行线性组合，得到承诺组合结果；各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性。2.根据权利要求1所述的高效恒定轮次安全多方计算协议的优化方法，其特征在于，所述多个AND三元组中的每个AND三元组包括第一秘密分享、第二秘密分享、第三秘密分享；执行优化的Tiny-OT协议，以生成多个AND三元组中的第τ个AND三元组步骤如下：步骤S201、每个参与方Pi生成全局密钥Δi，且其中，Δi为k位二进制数，k为预设的安全参数；lsb表示取Δi的最后一个比特；表示异或操作；步骤S202、每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享、第二秘密分享、第四秘密分享；所述第一秘密分享、第二秘密分享、第四秘密分享分别包括参与方Pi持有的秘密分享值xi、yi、ri以及xi、yi、ri分别对应的消息验证码和xi、yi、ri分别对应的密钥；步骤S203、每个参与方Pi本地计算第一中间值式中：表示Pi持有的yl对应的密钥；yl表示第l个参与方Pl持有的第二秘密分享的值；/＞表示Pi持有的yi对应的消息验证码；yi为Pi持有的第二秘密分享的值；Δi为全局密钥Δi；步骤S204、对于参与方Pi和Pj组成的有序对，j≠i：每个参与方Pi计算第二中间值ui,j：ui,j＝H式中，H表示哈希函数；Ki表示Pi持有的xj对应的密钥；xj为第l个参与方Pj持有的第一秘密分享的值；参与方Pi计算第三中间值vi,j：式中，为第一中间值；Δj为参与方pj持有的全局秘钥；参与方Pi将vi,j发送给pj；参与方Pj计算第四中间值wi,j：步骤S205、每个参与方Pi计算第五中间值Ui：步骤S206、每个参与方Pi计算每个AND三元组的承诺值：式中，d＝{di}；di＝lsb；lsb表示取Ui的最后一个比特；步骤S207、当i≠1时，令i＝i；否则，令得到、、。3.根据权利要求2所述的高效恒定轮次安全多方计算协议的优化方法，其特征在于，步骤S202中，所述每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享，具体包括：步骤S301、每个参与方Pi生成长度为m的随机比特序列作为第一随机比特序列x，并额外生成长度为k的随机比特序列/＞作为额外随机比特序列o，用于确保全局密钥Δi的一致性；步骤S302、对于参与方Pi和Pj组成的有序对，j≠i，以参与方Pi作为发送方，执行相关不经意传输协议COT以获取第一随机比特序列x、额外随机比特序列o分别对应的第一秘密分享、第四秘密分享以及、各自对应的消息验证码和密钥；步骤S303、基于第一秘密分享、第四秘密分享，对全局密钥Δi进行一致性验证，若通过验证，则输出第一秘密分享。4.根据权利要求3所述的高效恒定轮次安全多方计算协议的优化方法，其特征在于，步骤S303中，所述基于随机份额、，对全局密钥Δi进行一致性验证，包括：对于参与方Pi和Pj组成的有序对，Pi、Pj为n个参与方中的任意两方，j≠i，参与方Pi根据第一秘密分享、第四秘密分享本地计算第一映射值Ci，并获取Ci对应的消息验证码Mj和密钥Ki；每个参与方Pi获取随机零分享其中，/＞每个参与方Pi根据第一映射值Ci和随机零分享ρi计算第二映射值并将第二映射值广播至各个参与方；每个参与方Pi根据第二映射值重构第三映射值c；每个参与方Pi根据第一映射值Ci、第三映射值c以及Ci对应的消息验证码Mj和密钥Ki，检查全局密钥Δi的一致性。5.根据权利要求1所述的高效恒定轮次安全多方计算协议的优化方法，其特征在于，在所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组之后，所述方法还包括：将多个AND三元组分组；对于每一个分组，将分组内所有AND三元组组合成一个，以得到多个组合；将多个组合进行两两配对，对于配对中的第一组合{,,}和配对中的第二组合{,,}，执行如下步骤以消除泄漏：各个参与方Pi检查的一致性；令＝，/＞/＞输出AND三元组、、，其中，＝×。6.根据权利要求1所述的高效恒定轮次安全多方计算协议的优化方法，其特征在于，在各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性之后，所述方法还包括：获取布尔电路；基于所述多个AND三元组生成用于构造未经身份验证的混淆电路的相关随机信息；根据所述相关随机信息，生成所述布尔电路对应的所述混淆电路。7.根据权利要求6所述的高效恒定轮次安全多方计算协议的优化方法，其特征在于，所述混淆电路的与门混淆表包括混淆方半门和评估方半门；所述混淆电路的与门包括第一输入线、第二输入线和输出线；所述方法还包括：将输出线的掩码值拆分为第一子掩码和第二子掩码，并将输出线的密钥拆分为第一子密钥和第二子密钥；基于第一子掩码、第二子掩码、第一子密钥和第二子密钥，分别计算混淆方半门和评估方半门；对混淆方半门和评估方半门进行异或操作，得到输出线的外部值。8.一种高效恒定轮次安全多方计算协议的优化系统，其特征在于，所述安全多方计算协议包括预处理阶段和在线评估阶段；所述安全多方协议的参与方有多个，Pi表示第i个参与方，i取值为1，2，…n；n表示参与方的总数；包括：生成单元，配置为所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；所述AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路；组合单元，配置为各参与方Pi将所述多个AND三元组的承诺值进行线性组合，得到承诺组合结果；检查单元，配置为各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性。9.根据权利要求8所述的高效恒定轮次安全多方计算协议的优化系统，其特征在于，所述多个AND三元组中的每个AND三元组包括第一秘密分享、第二秘密分享、第三秘密分享；所述生成单元进一步配置为：执行优化的Tiny-OT协议，以生成多个AND三元组中的第τ个AND三元组步骤如下：步骤S201、每个参与方Pi生成全局密钥Δi，且其中，Δi为k位二进制数，k为预设的安全参数；lsb表示取Δi的最后一个比特；表示异或操作；步骤S202、每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享、第二秘密分享、第四秘密分享；所述第一秘密分享、第二秘密分享、第四秘密分享分别包括参与方Pi持有的秘密分享值xi、yi、ri以及xi、yi、ri分别对应的消息验证码和xi、yi、ri分别对应的密钥；步骤S203、每个参与方Pi本地计算第一中间值/＞式中：表示Pi持有的yl对应的密钥；yl表示第l个参与方Pl持有的第二秘密分享的值；/＞表示Pi持有的yi对应的消息验证码；yi为Pi持有的第二秘密分享的值；Δi为全局密钥Δi；步骤S204、对于参与方Pi和Pj组成的有序对，j≠i：每个参与方Pi计算第二中间值ui,j：ui,j＝H式中，H表示哈希函数；Ki表示Pi持有的xj对应的密钥；xj为第l个参与方Pj持有的第一秘密分享的值；参与方Pi计算第三中间值vi,j：式中，为第一中间值；Δj为参与方pj持有的全局秘钥；参与方Pi将vi,j发送给pj；参与方Pj计算第四中间值wi,j：步骤S205、每个参与方Pi计算第五中间值Ui：步骤S206、每个参与方Pi计算每个AND三元组的承诺值：式中，d＝{di}；di＝lsb；lsb表示取Ui的最后一个比特；步骤S207、当i≠1时，令i＝i；否则，令得到、、。/＞
说明书desc
技术领域本申请涉及计算机技术领域，特别涉及一种高效恒定轮次安全多方计算协议的优化方法和系统。背景技术在安全多方计算中，每个参与方都有其私有输入并共同计算函数f，同时确保输入的隐私和计算的正确性。基于姚氏混淆电路的安全两方计算协议实现了半诚实敌手模型下的安全性。然而，n个参与方的安全多方计算协议受到的关注较少，特别是在不诚实多数和常数轮次方面进展相对缓慢。在n个参与方的安全多方计算协议设置中，混淆电路的构造复杂度升高，各参与方需要以分布式的方式构建混淆电路，这种实现分布式混淆的方法称为BMR协议，BMR协议将MPC协议分为预处理阶段和在线评估阶段，且只需要一个恒定深度电路。具体而言，BMR协议的预处理阶段包括用于生成相关随机信息的Tiny-OT协议和用于生成未经身份验证的混淆电路的分布式混淆协议，这种结构将大量的计算转移到预处理阶段，其主要成本是每个与门的F2乘法计算。尽管这种结构有效的提高了在线评估阶段的计算效率，但是在Tiny-OT协议中还有许多关键的构建块需要改进。因此，需要提供一种针对上述现有技术不足的改进技术方案。发明内容本申请的目的在于提供一种高效恒定轮次安全多方计算协议的优化方法和系统，通过对Tiny-OT协议中的AND三元组和正确性检查的关键构建块进行改进，以解决或缓解上述现有技术中存在的问题。为了实现上述目的，本申请提供如下技术方案：本申请提供了一种高效恒定轮次安全多方计算协议的优化方法，所述安全多方计算协议包括预处理阶段和在线评估阶段；所述安全多方协议的参与方有多个，Pi表示第i个参与方，i取值为1，2，…n；n表示参与方的总数；包括：所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；所述AND三元组用于生成所述预处理阶段的混淆电路，以及用于所述在线评估阶段的计算；各参与方Pi将所述多个AND三元组的承诺值进行线性组合，得到承诺组合结果；各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性。优选地，所述多个AND三元组中的每个AND三元组包括第一秘密分享、第二秘密分享、第三秘密分享；执行优化的Tiny-OT协议以生成多个AND三元组中的第τ个AND三元组步骤如下：步骤S201、每个参与方Pi生成全局密钥Δi，且其中，Δi为k位二进制数，k为预设的安全参数；lsb表示取Δi的最后一个比特；表示异或操作；步骤S202、每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享、第二秘密分享、第四秘密分享；所述第一秘密分享、第二秘密分享、第四秘密分享分别包括参与方Pi持有的秘密分享值xi、yi、ri以及xi、yi、ri分别对应的消息验证码和xi、yi、ri分别对应的密钥；步骤S203、每个参与方Pi本地计算第一中间值式中：表示Pi持有的yl对应的密钥；yl表示第l个参与方Pl持有的第二秘密分享的值；/＞表示Pi持有的yi对应的消息验证码；yi为Pi持有的第二秘密分享的值；Δi为全局密钥Δi；步骤S204、对于参与方Pi和Pj组成的有序对，j≠i：每个参与方Pi计算第二中间值ui,j：ui,j＝H式中，H表示哈希函数；Ki表示Pi持有的xj对应的密钥；xj为第l个参与方Pj持有的第一秘密分享的值；参与方Pi计算第三中间值vi,j：式中，为第一中间值；Δj为参与方pj持有的全局秘钥；参与方Pi将vi,j发送给pj；参与方Pj计算第四中间值wi,j：步骤S205、每个参与方Pi计算第五中间值Ui：步骤S206、每个参与方Pi计算每个AND三元组的承诺值：式中，d＝{di}；di＝lsb；lsb表示取Ui的最后一个比特；步骤S207、当i≠1时，令i＝i；否则，令得到、、。优选地，步骤S202中，所述每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享，具体包括：步骤S301、每个参与方Pi生成长度为m的随机比特序列作为第一随机比特序列x，并额外生成长度为k的随机比特序列/＞作为额外随机比特序列o，用于确保全局密钥Δi的一致性；/＞步骤S302、对于参与方Pi和Pj组成的有序对，j≠i，以参与方Pi作为发送方，执行相关不经意传输协议COT以获取第一随机比特序列x、额外随机比特序列o分别对应的第一秘密分享、第四秘密分享以及、各自对应的消息验证码和密钥；步骤S303、基于第一秘密分享、第四秘密分享，对全局密钥Δi进行一致性验证，若通过验证，则输出第一秘密分享。上述技术方案中，步骤S303中，所述基于随机份额、，对全局密钥Δi进行一致性验证，包括：对于参与方Pi和Pj组成的有序对，Pi、Pj为n个参与方中的任意两方，j≠i，参与方Pi根据第一秘密分享、第四秘密分享本地计算第一映射值Ci，并获取Ci对应的消息验证码Mj和密钥Ki；每个参与方Pi获取随机零分享其中，/＞每个参与方Pi根据第一映射值Ci和随机零分享ρi计算第二映射值并将第二映射值/＞广播至各个参与方；每个参与方Pi根据第二映射值重构第三映射值c；每个参与方Pi根据第一映射值Ci、第三映射值c以及Ci对应的消息验证码Mj和密钥Ki，检查全局密钥Δi的一致性。上述技术方案中，在所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组之后，所述方法还包括：将多个AND三元组分组；对于每一个分组，将分组内所有AND三元组组合成一个，以得到多个组合；将多个组合进行两两配对，对于配对中的第一组合{,,}和配对中的第二组合{,,}，执行如下步骤以消除泄漏：各个参与方检查的一致性；令＝，/＞输出AND三元组、、，其中，＝×。上述技术方案中，在各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性之后，所述方法还包括：获取布尔电路；基于所述多个AND三元组生成用于构造未经身份验证的混淆电路的相关随机信息；根据所述相关随机信息，生成所述布尔电路对应的所述混淆电路。上述技术方案中，所述混淆电路的与门混淆表包括混淆方半门和评估方半门；所述混淆电路的与门包括第一输入线、第二输入线和输出线；所述方法还包括：将输出线的掩码值拆分为第一子掩码和第二子掩码，并将输出线的密钥拆分为第一子密钥和第二子密钥；基于第一子掩码、第二子掩码、第一子密钥和第二子密钥，分别计算混淆方半门和评估方半门；对混淆方半门和评估方半门进行异或操作，得到输出线的外部值。本申请实施例还提供一种高效恒定轮次安全多方计算协议的优化系统，所述安全多方计算协议包括预处理阶段和在线评估阶段；所述安全多方协议的参与方有多个，Pi表示第i个参与方，i取值为1，2，…n；n表示参与方的总数；包括：生成单元，配置为所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；所述AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路；组合单元，配置为各参与方Pi将所述多个AND三元组的承诺值进行线性组合，得到承诺组合结果；检查单元，配置为各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性。上述技术方案中，所述多个AND三元组中的每个AND三元组包括第一秘密分享、第二秘密分享、第三秘密分享；所述生成单元进一步配置为：执行优化的Tiny-OT协议以生成多个AND三元组中的第τ个AND三元组步骤如下：步骤S201、每个参与方Pi生成全局密钥Δi，且其中，Δi为k位二进制数，k为预设的安全参数；lsb表示取Δi的最后一个比特；表示异或操作；步骤S202、每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享、第二秘密分享、第四秘密分享；所述第一秘密分享、第二秘密分享、第四秘密分享分别包括参与方Pi持有的秘密分享值xi、yi、ri以及xi、yi、ri分别对应的消息验证码和xi、yi、ri分别对应的密钥；步骤S203、每个参与方Pi本地计算第一中间值式中：表示Pi持有的yl对应的密钥；yl表示第l个参与方Pl持有的第二秘密分享的值；/＞表示Pi持有的yi对应的消息验证码；yi为Pi持有的第二秘密分享的值；Δi为全局密钥Δi；步骤S204、对于参与方Pi和Pj组成的有序对，j≠i：每个参与方Pi计算第二中间值ui,j：ui,j＝H式中，H表示哈希函数；Ki表示Pi持有的xj对应的密钥；xj为第l个参与方Pj持有的第一秘密分享的值；参与方Pi计算第三中间值vi,j：式中，为第一中间值；Δj为参与方pj持有的全局秘钥；参与方Pi将vi,j发送给pj；参与方Pj计算第四中间值wi,j：步骤S205、每个参与方Pi计算第五中间值Ui：步骤S206、每个参与方Pi计算每个AND三元组的承诺值：式中，d＝{di}；di＝lsb；lsb表示取Ui的最后一个比特；步骤S207、当i≠1时，令i＝i；否则，令得到、、。有益效果：本申请的技术方案中，所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路；各参与方Pi将多个AND三元组的承诺值进行线性组合，得到承诺组合结果；各参与方Pi打开承诺组合结果并检查多个AND三元组的正确性。通过在优化的Tiny-OT协议中批量处理AND三元组的正确性检查，实现将AND三元组生成和正确性检查集成到一个协议中，减少了AND三元组的正确性检查的通信数量和调用哈希函数的数量，优化了通信效率。附图说明构成本申请的一部分的说明书附图用来提供对本申请的进一步理解，本申请的示意性实施例及其说明用于解释本申请，并不构成对本申请的不当限定。其中：图1为根据本申请的一些实施例提供的高效恒定轮次安全多方计算协议的优化方法的流程示意图；图2为根据本申请的一些实施例提供的执行优化的Tiny-OT协议生成AND三元组的流程示意图；图3为根据本申请的一些实施例提供的执行相关不经意传输协议COT获取第一秘密分享的流程示意图；图4为根据本申请的一些实施例提供的高效恒定轮次安全多方计算协议的优化系统的结构示意图。具体实施方式下面将参考附图并结合实施例来详细说明本申请。各个示例通过本申请的解释的方式提供而非限制本申请。实际上，本领域的技术人员将清楚，在不脱离本申请的范围或精神的情况下，可在本申请中进行修改和变型。例如，示为或描述为一个实施例的一部分的特征可用于另一个实施例，以产生又一个实施例。因此，所期望的是，本申请包含归入所附权利要求及其等同物的范围内的此类修改和变型。在以下描述中，所涉及的术语“第一/第二/第三”仅仅是区别类似的对象，不代表对对象的特定排序，可以理解地，“第一/第二/第三”在允许的情况下可以互换特定的顺序或先后次序，以使这里描述的本申请实施例能够以除了在这里图示或描述的以外的顺序实施。除另有定义，本文所使用的所有的技术和科学术语与属于本公开的技术领域的技术人员通常理解的含义相同。本文中所使用的术语只是为了描述本公开实施例的目的，不是旨在限制本公开。在安全多方计算中，每个参与方都有其私有输入并共同计算函数f，同时确保输入的隐私和计算的正确性。基于姚氏混淆电路的安全两方计算协议实现了半诚实敌手模型下的安全性。后来，Lindell和Pinkas提出的cut-and-choose技术实现了恶意敌手模型中的安全性。目前，恶意模型中两方协议的计算效率以及提高了几个数量级。然而，n方计算协议受到的关注较少，其进展相对缓慢，特别是在不诚实多数和常数轮次方面。在n方设置中，混淆电路的构造变得复杂。各方需要以分布式的方式构建混淆电路。这种实现分布式混淆的方法称为BMR协议，它将MPC协议分为预处理阶段和在线阶段，且只需要一个恒定深度电路。分布式混淆是恒定轮次MPC协议的核心工具。根据混淆的方法，现有的多方常数轮次MPC协议可以分为两种风格。一个是Wang等人提出的认证混淆，另一个是Hazay等人改进后的SPDZ-BMR。它们都以分布式方式构造电路，但底层协议是不同的。Wang等人的协议必须生成某些经过身份验证的信息，并且它们的计算协议是不对称的，因为经过认证的电路由一个参与方构造，然后由其他n-1方进行评估。相比之下，Hazay等人的SPDZ-BMR协议是对称的，且遵循BMR范式，n方共同构建未经身份认证的电路并获得电路的份额。针对SPDZ-BMR协议，预处理阶段包括用于创建未经身份验证的AND三元组的Tiny-OT协议和分布式混淆协议。这种通用结构将大量的计算转移到预处理阶段，其主要成本是每个AND门的乘法。虽然这种范式显着提高了在线阶段的效率，但我们发现仍有许多关键构建块需要改进，主要包括未经身份验证的AND三元组生成，正确性检查。直观地说，Tiny-OT协议对于基于秘密共享和基于BMR协议的安全多方计算协议非常实用，但其计算复杂性仍有待提高。为此，本申请基于SPDZ-BMR协议的结构，提供一种高效恒定轮次安全多方计算协议的优化方法和系统，该方法通过执行主动的、常数轮次的安全多方计算协议，能够容忍任意n-1个腐败方。特别地，该方法遵循Tiny-OT协议以及未经身份验证的混淆方案，在高层次上，首先提出了一种优化的Tiny-OT协议，用于生成未经身份验证的AND三元组，它减少了生成AND三元组时一致性检查数量和调用哈希函数的数量，并且避免使用额外的OT操作来计算混淆电路，从而提高了通信效率。确切地说，通过本申请提供的方法，能够减少大约50％的对哈希函数的调用，用于生成共享随机位，并将AND三元组的一致性检查协议中使用的承诺数减少到1个。本申请提供一种高效恒定轮次安全多方计算协议的优化方法，其通信复杂度为O，极大地优化了通信效率。为了便于理解本申请的技术方案，对相关参数进行定义：f：由多个参与方共同计算的函数；k：预设的计算安全参数；s：预设的统计安全参数；a.b：表示值域为的乘法或者逻辑与计算；四元组：表示电路中的门，其中，x、y表示电路中门的输入线，z表示输出线。.表示门的类型，在混淆电路中，门的类型可以为XOR门或AND门。三元组表示一个AND三元组，其中x，y，z都为秘密分享的份额。在混淆电路中，w表示任意一条线路，所有的w组成线路集合，用W表示，其中，输入线的集合用Win表示，输出线的集合用Wout表示。下面对相关技术进行详细说明：首先对BMR协议进行说明。在基于姚氏混淆电路的安全两方计算协议中，AND门的混淆表可以用如下公式表示：C0,0＝Ex,0)C0,1＝Ex,0)C1,0＝Ex,1)C1,1＝Ex,1)其中，C表示输出值，E为对称加密算法，k为密钥。BMR协议是姚氏混淆电路协议在多方设置中的扩展，其基本思想是以分布式方式生成电路，以便没有任何参与方能够得知电路生成的所有信息。此外，基于BMR协议能够以并行方式生成混淆表，从而生成混淆电路时能够独立于计算电路深度，混淆电路的生成过程在预处理阶段完成。在生成混淆电路之后，各个参与方获得混淆电路和相关密钥的份额，然后在在线阶段进行本地评估。在BMR混淆协议中，每个参与方Pi随机为混淆电路中的每条线路w选择一对密钥和/＞然后使用输入线上的密钥加密输出线上的密钥，以构造AND门的混淆表。具体来说，使用输入线的密钥/＞和/＞加密输出线的密钥，得到的混淆表公式如下：其中，F是伪随机函数，||表示串联，g是门的索引。上述AND门的混淆表可以简写为：其中，j∈，a,b,c∈。从上述AND门的混淆表可以看出，在n个参与方的安全多方计算协议中，一个AND门需要4n个加密密文，是安全两方计算协议的混淆电路的n倍，如果任意一个参与方是诚实的，那么，上述加密就是安全的。在n个参与方的安全多方计算协议中，使用Free-XOR技术可以使得XOR门的评估免费。具体来说，当计算混淆电路中的XOR门时，使用Free-XOR技术不再需要发送密文和执行加密解密操作，也就不必处理XOR门的乱码。在Free-XOR技术中，n个参与方中的每个参与方Pi随机选择一个全局密钥Δi，设和/＞为线路w的密钥，x、y为线路w的输入，z为线路w的输出，λw为线路w的掩码值。结合Free-XOR技术，AND门的混淆如下：式中，j∈,a,b,λx,λy,λz∈。在线评估阶段，各参与方拥有私有输入vw并获的外部值Λw，其中在混淆阶段，输出线的密钥都被输入线键的混淆表/＞所掩盖。由于掩码值λw是随机的，因此外部值Λw不会泄露有关真实值vw的任何信息。最后，各参与方获得输出线的外部值Λz和对应的密钥，然后评估混淆电路中的混淆门。为了实现主动安全性，SPDZ-BMR协议允许敌手控制的腐败方输入不正确的PRF值因为诚实的参与方Pj可以在在线评估阶段评估混淆门以获取密钥/＞或者/＞如果有任何不正确的PRF值，Pj将中止协议。另一个好处是显而易见的：SPDZ-BMR协议将大量计算转移到预处理阶段，从而提高了在线评估的效率。此外，预处理阶段的主要开销是计算混淆门的未经过身份验证的秘密分享。示例性方法本申请实施例提供一种高效恒定轮次安全多方计算协议的优化方法，所述安全多方计算协议包括预处理阶段和在线评估阶段；所述安全多方协议的参与方有多个，Pi表示第i个参与方，i取值为1，2，…n；n表示参与方的总数；包括，如图1-3所示，该方法包括：步骤S101、所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路。本申请实施例中，MPC协议是主动的、常数轮次的，该协议使用SPDZ-BMR的结构，基于优化的Tiny-OT协议执行，可以容忍任意n-1个腐败方。该MPC协议的具体流程如下：各参与方在预处理阶段生成正确的AND三元组；然后，使用分布式混淆协议来创建混淆电路；随后，各参与方在在线阶段获得混淆电路和相关密钥的秘密分享；最后，各参与方在本地对混淆电路进行评估以获得输出。与传统的SPDZ-BMR不同的是，本申请实施例在AND三元组生成和正确性检查的两个结构块对Tiny-OT协议进行了优化。具体来说，传统的Tiny-OT协议基于cut-and-choose技术来进行AND三元组的正确性检查，本申请实施例基于优化的Tiny-OT协议提供一种新的AND三元组生成方法，在优化的Tiny-OT协议中，通过将AND三元组生成和正确性检查集成到一个协议中，采用批量进行AND三元组正确性检查的方法，使得多个AND三元组的正确性检查只需要一次承诺，而不是传统的m’个承诺，其中，m’为AND三元组的个数，并且，减少了一半的哈希函数调用。批处理进行AND三元组的检查将MPC协议的计算复杂性由m’×k比特降低到k比特，取得了比传统Tiny-OT协议更高的计算效率。此外，基于优化的Tiny-OT协议的MPC协议能够获得主动安全性，并且每个参与方的通信复杂度为O。表1示出了本申请实施例提供的多方MPC协议与其他多方MPC协议的通信复杂度的比较结果，表1如下：表1通信复杂度的比较结果上表中，O表示复杂度，|C|表示电路中与门的个数，d表示电路深度，B＝O。从表中可以看出，本申请实施例提供的方法通信效率大大提高。具体实施时，优化的Tiny-OT协议用于在预处理阶段生成带有一致性检查的随机秘密分享和带有正确性检查的AND三元组，所生成的AND三元组将用于在线评估阶段的计算。下面将详细描述优化的Tiny-OT协议。在生成带有一致性检查的随机秘密分享和带有正确性检查的AND三元组之前，优化的Tiny-OT协议还包括初始化，初始化执行如下步骤：步骤S2011、对于i∈,Pi随机选择一个全局密钥Δi←{0,1}k。步骤S2012、对于每个有序对，其中j≠i,Pi和Pj分别发送和给为了获得带有正确性检查的AND三元组，在一些实施例中，多个AND三元组中的每个AND三元组包括第一秘密分享、第二秘密分享、第三秘密分享；执行优化的Tiny-OT协议，以生成多个AND三元组中的第τ个AND三元组步骤如下：步骤S201、每个参与方Pi生成全局密钥Δi←{0,1}k，且其中，Δi为k位二进制数，k为预设的安全参数；lsb表示取Δi的最后一个比特；表示异或操作。步骤S202、每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享、第二秘密分享、第四秘密分享；所述第一秘密分享、第二秘密分享、第四秘密分享分别包括参与方Pi持有的秘密分享值xi、yi、ri以及xi、yi、ri分别对应的消息验证码和xi、yi、ri分别对应的密钥。步骤S203、每个参与方Pi本地计算第一中间值式中：表示Pi持有的yl对应的密钥；yl表示第l个参与方Pl持有的第二秘密分享的值；/＞表示Pi持有的yi对应的消息验证码；yi为Pi持有的第二秘密分享的值；Δi为全局密钥Δi。步骤S204、对于参与方Pi和Pj组成的有序对，j≠i：每个参与方Pi计算第二中间值ui,j：ui,j＝H式中，H表示哈希函数；Ki表示Pi持有的xj对应的密钥；xj为第l个参与方Pj持有的第一秘密分享的值；参与方Pi计算第三中间值vi,j：式中，为第一中间值；Δj为参与方pj持有的全局秘钥；参与方Pi将vi,j发送给pj；参与方Pj计算第四中间值wi,j：步骤S205、每个参与方Pi计算第五中间值Ui：步骤S206、每个参与方Pi计算每个AND三元组的承诺值：式中，d＝{di}；di＝lsb；lsb表示取Ui的最后一个比特。步骤S207、当i≠1时，令i＝i；否则，令得到、、。本申请实施例中，创建AND三元组包括两个步骤：AND三元组生成和AND三元组的正确性检查。恶意的敌手可以猜测有关随机秘密分享的信息，例如查询和全局密钥与xi的线性组合，因为恶意的敌手无法获取有关xi，yi和zi的更多信息，因此，上述猜测行为对本申请实施例的优化的Tiny-OT协议没有影响。传统的Tiny-OT协议使用cut-and-choose技术来确保AND三元组的正确性，导致大大浪费AND三元组，并且效率低下。优化的Tiny-OT协议没有使用cut-and-choose，而是将AND三元组生成和正确性检查结合到一起，从而有效地减少了用于正确性检查的哈希函数的数量。下面具体分析优化的Tiny-OT协议的执行过程：在上述步骤S203中，第一中间值为：也就是说：在步骤S204创建AND三元组时，有：然后，可以计算下式：在步骤S206中，有：因此，可以得到：最后，在步骤S207中有：故，＝·，并得到AND三元组。为了生成带有一致性检查的随机秘密分享，在一些实施例中，步骤S202中，每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享，具体包括：步骤S301、每个参与方Pi生成长度为m的随机比特序列作为第一随机比特序列x，并额外生成长度为k的随机比特序列/＞作为额外随机比特序列o，用于确保全局密钥Δi的一致性；步骤S302、对于参与方Pi和Pj组成的有序对，j≠i，以参与方Pi作为发送方，执行相关不经意传输协议COT以获取第一随机比特序列x、额外随机比特序列o分别对应的第一秘密分享、第四秘密分享以及、各自对应的消息验证码和密钥；步骤S303、基于第一秘密分享、第四秘密分享，对全局密钥Δi进行一致性验证，若通过验证，则输出第一秘密分享。重复执行步骤S301～S303，获得第二秘密分享、第三秘密分享。本申请实施例中，每对参与方可以通过执行相关不经意传输协议来生成随机秘密分享，但是，恶意的参与方可能会在每次执行中输入不一致的全局密钥，导致多个不同的随机秘密分享将由多个全局密钥进行验证，为了确保全局密钥的一致性，本申请实施引入重随机技术。具体来说，通过线性映射将每个Pi的随机秘密分享映射到中的随机值Ci，然后，每一方Pi都通过随机的零分享重新随机化Ci，为了生成m个随机秘密分享，在优化的Tiny-OT协议中，每一方额外生成k个随机比特，然后打开它们以检查全局密钥Δi的一致性。为了验证全局密钥Δi的一致性，在一些实施例中，步骤S303中，基于随机份额、，对全局密钥Δi进行一致性验证，包括：对于参与方Pi和Pj组成的有序对，Pi、Pj为n个参与方中的任意两方，j≠i，参与方Pi根据第一秘密分享、第四秘密分享本地计算第一映射值Ci，并获取Ci对应的消息验证码Mj和密钥Ki；每个参与方Pi获取随机零分享其中，/＞每个参与方Pi根据第一映射值Ci和随机零分享ρi计算第二映射值并将第二映射值/＞广播至各个参与方；每个参与方Pi根据第二映射值重构第三映射值c；每个参与方Pi根据第一映射值Ci、第三映射值c以及Ci对应的消息验证码Mj和密钥Ki，检查全局密钥Δi的一致性。具体包括：每个Pi设置然后调用/＞并承诺各方打开他们的承诺并检查如果检查失败，各方中止协议。上述全局密钥Δi的一致性验证过程中，只需要每一个参与方做出一个承诺即可验证全局密钥Δi的一致性，以防止恶意的参与方串通，确保了全局密钥的一致性。其中：因此，各方只需要承诺并检查即可确保全局密钥的一致性。在一个示例中，优化的Tiny-OT协议如下：/＞其中，相关不经意传输协议的执行过程如下：所调用的函数包括承诺命令和打开命令，执行过程如下：/＞需要说明的是，在AND三元组的正确性检查过程中，恶意的敌手可能会发现一些泄漏，为此，在一些实施例中，在所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组之后，所述方法还包括：将多个AND三元组分组；对于每一个分组，将分组内所有AND三元组组合成一个，以得到多个组合；将多个组合进行两两配对，对于配对中的第一组合{,,}和配对中的第二组合{,,}，执行如下步骤以消除泄漏：各个参与方检查的一致性；令＝，/＞输出AND三元组、、，其中，＝×。本申请实施例中，在子协议中采用桶技术，每个桶中组合几个AND三元组，以消除AND三元组的泄漏。具体地，在一个示例中，采用桶技术的子协议如下：步骤S102、各参与方Pi将多个AND三元组的承诺值进行线性组合，得到承诺组合结果。执行上述优化的Tiny-OT协议能够生成一个AND三元组，实际应用中，MPC协议执行过程需要消耗大量的AND三元组，因此，AND三元组通常以批量方式生成。具体实施时，可以通过并行执行上述优化的Tiny-OT协议生成多个AND三元组，比如并行生成m’个AND三元组，并计算每个AND三元组的承诺值。在并行执行m’次优化的Tiny-OT协议后，对m’个AND三元组进行正确性检查时，每个参与方Pi都通过如下公式：计算得到多个AND三元组的承诺值的线性组合；式中，στ为通过随机函数生成的随机数。然后，调用函数的承诺命令承诺Zi。上述随机函数的具体过程如下：步骤S103、各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性。各参与方调用函数的打开命令，打开承诺Zi，并检查是否/＞当等于0时，各方终止协议。在一些实施例中，在各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性之后，所述方法还包括：获取布尔电路；基于所述多个AND三元组生成用于生成构造未经身份验证的混淆电路的相关随机信息；根据所述相关随机信息，生成所述布尔电路对应的所述混淆电路。其中，布尔电路是基于函数f的运算逻辑进行构建的。本申请实施例中，各参与方在预处理阶段生成正确的AND三元组；然后，基于AND三元组使用分布式混淆协议来创建布尔电路的混淆电路；通过多方混淆协议生成混淆电路。其中，多方混淆协议由各参与方通过分布式混淆共同生成混淆电路。具体而言，每个Pi首先生成混淆电路中电路门的密钥和全局密钥，其中然后随机选择电路门每条线上的掩码值秘密分享λw，接下来，各方计算秘密分享的乘积λw·Δi并定义混淆电路，最后，向各方计算输出线的掩码值。下面是分布式混淆协议的一个示例：其中，打开子协议Πopen按照如下步骤执行：/＞在生成混淆电路过程中，使用带有消息验证码MACs的Tiny-OT生成秘密分享，并基于优化的Tiny-OT协议分布式混淆来构建未经验证的混淆电路，无需额外的开销来获取经过验证的信息。在预处理阶段，使用带有MACs的优化的Tiny-OT协议来获得未经验证的AND三元组，这些AND三元组用于计算掩码值共享的乘积λx·λy，并且每个参与方Pj分别计算λx，λy，λx·λy与Δj的乘积。基于检查机制将电路打开并检查混淆电路的正确性，从而防止腐败方改变他们的秘密分享导致生成不正确的混淆门，如果混淆电路检查错误，在线阶段将中止。在在线评估阶段，每个Pi计算其输入线上的外部值Λw，然后广播Λw以及与外部值Λw对应的密钥然后，每个Pi都使用这些值来评估混淆电路，以获得输出线的密钥/＞和外部值Λz；最后，每个Pi根据掩码值计算输出真实值/＞一个具体的MPC协议执行过程如下：其中，打开混淆协议ΠOpengarbling用于重构混淆电路中的混淆表以对混淆电路进行检测，确保电路的正确，该协议按照如下步骤执行：由于在预处理阶段中，各方产生了未经身份验证的混淆电路的秘密分享，这意味着恶意的参与方可能会往混淆电路中引入错误，本实施例中，通过在在线评估阶段增加一个简单的打开混淆协议ΠOpengarbling来检测以确保电路的正确。相比之下，身份验证的混淆电路比未经身份验证的混淆电路更加昂贵。为了减少混淆电路构建过程中电路门之间的数据传输量和混淆表的大小，在一些实施例中，所述混淆电路的与门混淆表包括混淆方半门和评估方半门；所述混淆电路的与门包括第一输入线、第二输入线和输出线；所述方法还包括：将输出线的掩码值拆分为第一子掩码和第二子掩码，并将输出线的密钥拆分为第一子密钥和第二子密钥；基于第一子掩码、第二子掩码、第一子密钥和第二子密钥，分别计算混淆方半门和评估方半门；对混淆方半门和评估方半门进行异或操作，得到输出线的外部值。本申请实施例中，将Half-Gate技术引入到多方分布式混淆协议中，并使得Half-Gate技术与free-XOR技术优化兼容，从而使混淆电路中每个AND门的混淆表只消耗2n比特位的数据传输量，减少了混淆表的大小，提高了MPC协议的效率。其中，本申请对Half-Gate技术进行了优化，使多方分布式混淆电路中的AND门仅需要消耗两个密文，同时与Free-XOR兼容。下面对Half-Gate技术的优化内容进行详细说明：本申请实施例中，两个Half-Gate分别表示为“混淆方半门”和“评估方半门”。设为外部值，vw为真实值。对于一个AND门vz＝vx∧vy，其中，x，y为AND门的输入线，z为AND门的输出线有：在基于两方的Half-Gate技术中，计算包含两个半门，第一个半门用于计算λy·vx，第二个半门用于计算最后，通过XOR两次计算得到的结果vz＝vx·vy如下：/＞本申请实施例中，将Half-Gate技术引入到多方分布式混淆协议过程中，进行如下调整：首先，将输出线的掩码值拆分为第一子掩码λ′z和第二子掩码λ″z，其中，通过将输出线的掩码值拆分为第一子掩码λ′z和第二子掩码λ″z，能够防止两个半门的输出被泄漏。然后，将输出线的密钥/＞拆分为第一子密钥/＞和第二子密钥/＞其中，通过拆分输出线的零密钥/＞为第一子密钥和第二子密钥，能够确保两个半门的输出线的密钥不会透露各方的全局密钥Δi。对于混淆电路中的AND门，有：下面分别对“混淆方半门”和“评估方半门”进行详细说明。混淆方半门：由于掩码值是随机的并且秘密分享的，因此，可以利用混淆方知道自己的掩码值的事实来计算多方安全计算情景下的混淆半门。在在线评估阶段，混淆方获得线路x的外部值根据上面的分析，混淆方半门用于计算：需要说明的是，外部值Λx在在线阶段计算得到，那么混淆方的半门如下：其中/＞i∈通过解密来验证等式的正确性，以获得输出线的密钥，如下所示：评估方半门：在在线评估阶段，评估方获得导线的外部值与混淆方半门类似，评估方半门用于计算：/＞其中，通过类似于混淆方半门的方式计算得到。上式的重点在于：计算Λx·Λy，即因为在在线评估阶段，和/＞两者都被揭露，所以，Λx·Λy可以在在线评估阶段直接计算得到。此外，还需要计算与Λx·Λy对应的密钥。在两个参与方的安全计算协议，输入线x的密钥需要转移到输出线z的密钥上，当需要计算输入线x的密钥和输出线z的密钥的异或值。在由n个参与方的多方安全计算场景下，在线评估过程中，评估方将输入线x的密钥数乘以外部值Λy，然后将结果与输出线z的密钥进行XOR，那么评估方的半门如下：其中/＞i∈通过解密获得请求值/＞对应的密钥，以验证上式的正确性：然后，将与输入线x的密钥和外部值Λy的乘积进行XOR计算，计算的结果确实为请求值/＞对应的密钥：通过上述步骤计算出“混淆方半门”和“评估方半门”后，只需对它们进行XOR即可获得输出线z的外部值Λz。综上所述，本申请中，所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路；各参与方Pi将多个AND三元组的承诺值进行线性组合，得到承诺组合结果；各参与方Pi打开承诺组合结果并检查多个AND三元组的正确性。通过在优化的Tiny-OT协议中批量处理AND三元组的正确性检查，实现将AND三元组生成和正确性检查集成到一个协议中，减少了AND三元组的正确性检查的承诺数量和调用哈希函数的数量，优化了通信效率。本申请实施例中，MPC协议是主动的、常数轮次的，该协议使用SPDZ-BMR的结构，基于优化的Tiny-OT协议执行，可以容忍任意n-1个腐败方。在生成混淆电路过程中，使用带有消息验证码MACs的Tiny-OT生成秘密分享，并基于优化的Tiny-OT协议分布式混淆来构建未经验证的混淆电路，无需额外的开销来获取经过验证的信息。本申请实施例中，将Half-Gate技术引入到多方分布式混淆协议中，并使得Half-Gate技术与free-XOR技术优化兼容，从而使混淆电路中每个AND门的混淆表只消耗2n比特位的数据传输量，减少了混淆表的大小，提高了MPC协议的效率。示例性系统本申请实施例提供一种高效恒定轮次安全多方计算协议的优化系统，所述安全多方计算协议包括预处理阶段和在线评估阶段；所述安全多方协议的参与方有多个，Pi表示第i个参与方，i取值为1，2，…n；n表示参与方的总数；该系统包括：生成单元401、组合单元402和检查单元403，其中：生成单元401，配置为所有参与方并行执行优化的Tiny-OT协议，以生成多个AND三元组；所述AND三元组用于生成构造未经身份验证的混淆电路的相关随机信息，以及用于在线评估阶段进行随机份额的乘法计算以解密电路；组合单元402，配置为各参与方Pi将所述多个AND三元组的承诺值进行线性组合，得到承诺组合结果；检查单元403，配置为各参与方Pi打开承诺组合结果并检查所述多个AND三元组的正确性。所述多个AND三元组中的每个AND三元组包括第一秘密分享、第二秘密分享、第三秘密分享；所述生成单元401进一步配置为：执行优化的Tiny-OT协议以生成多个AND三元组中的第τ个AND三元组步骤如下：第一、每个参与方Pi生成全局密钥Δi，且其中，Δi为k位二进制数，k为预设的安全参数；lsb表示取Δi的最后一个比特；表示异或操作；步骤S202、每个参与方Pi通过执行相关不经意传输协议COT获取第一秘密分享、第二秘密分享、第四秘密分享；所述第一秘密分享、第二秘密分享、第四秘密分享分别包括参与方Pi持有的秘密分享值xi、yi、ri以及xi、yi、ri分别对应的消息验证码和xi、yi、ri分别对应的密钥；步骤S203、每个参与方Pi本地计算第一中间值式中：表示Pi持有的yl对应的密钥；yl表示第l个参与方Pl持有的第二秘密分享的值；/＞表示Pi持有的yi对应的消息验证码；yi为Pi持有的第二秘密分享的值；Δi为全局密钥Δi；步骤S204、对于参与方Pi和Pj组成的有序对，j≠i：每个参与方Pi计算第二中间值ui,j：ui,j＝H式中，H表示哈希函数；Ki表示Pi持有的xj对应的密钥；xj为第l个参与方Pj持有的第一秘密分享的值；参与方Pi计算第三中间值vi,j：式中，为第一中间值；Δj为参与方pj持有的全局秘钥；参与方Pi将vi,j发送给pj；参与方Pj计算第四中间值wi,j：步骤S205、每个参与方Pi计算第五中间值Ui：步骤S206、每个参与方Pi计算每个AND三元组的承诺值：式中，d＝{di}；di＝lsb；lsb表示取Ui的最后一个比特；步骤S207、当i≠1时，令i＝i；否则，令得到、、。本申请实施例提供的高效恒定轮次安全多方计算协议的优化系统，能够实现上述任一实施例的高效恒定轮次安全多方计算协议的优化方法的步骤、流程，并达到相同的技术效果，在此不做一一赘述。以上所述仅为本申请的优选实施例，并不用于限制本申请，对于本领域的技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
