标题title
一种保护隐私的身份凭证背书生成和验证方法
摘要abst
本发明公开了一种保护隐私的身份凭证背书生成和验证方法。本发明的身份凭证背书生成方法为：身份管理机构根据背书申请人的身份信息构造待签名的数字证书；对身份信息中每一项需要保护的真实身份信息产生一随机数作为对应真实信息项的盐值；将每一项真实身份信息及其对应盐值进行不可逆密码函数计算、编码得到对应项的身份信息码；将各项身份信息码替换数字证书中的对应真实信息，然后对所得数字证书数字签名，将签名的数字证书作为身份凭证背书的封面；将第i项真实身份信息及其对应的盐值、身份信息码作为所述身份凭证背书的第i个内容页；将身份凭证背书的封面和身份凭证背书的各内容页合并，作为该背书申请人的身份凭证背书发给该背书申请人。
权利要求书clms
1.一种保护隐私的身份凭证背书生成方法，其步骤包括：1)身份管理机构获得背书申请人的身份信息；2)身份管理机构根据背书申请人的身份信息构造待签名的数字证书；3)身份管理机构对所述身份信息中每一项需要保护的真实身份信息产生一随机数作为对应真实信息项的盐值；4)身份管理机构将每一项所述真实身份信息及其对应盐值，进行不可逆密码函数计算，对计算结果进行编码得到对应真实身份信息项的身份信息码；5)身份管理机构将各项身份信息码替换所述数字证书中的对应真实身份信息项；6)身份管理机构按照数字证书格式要求，对步骤5)所得数字证书进行数字签名，将已签名的数字证书作为该背书申请人的身份凭证背书的封面；将第i项真实身份信息及其对应的盐值、身份信息码作为所述身份凭证背书的第i个内容页；i＝1～n，n为需要隐私保护的真实身份信息总项数；7)身份管理机构将所述身份凭证背书的封面和所述身份凭证背书的各内容页合并，作为该背书申请人的身份凭证背书发给该背书申请人。2.根据权利要求1所述的方法，其特征在于，所述密码函数为密码杂凑算法。3.根据权利要求1所述的方法，其特征在于，所述密码函数为加密算法。4.根据权利要求1所述的方法，其特征在于，所述的数字证书的格式采用X.509证书的格式，数字证书的编码方法采用DER编码方法；身份信息码的编码方法为BASE64编码。5.根据权利要求1所述的方法，其特征在于，所述身份信息包括背书申请人的姓名、电话、身份证号、生日、住址和工作单位或生物特征信息，照片、视频、指纹、声纹、人脸、虹膜、步态信息等。6.根据权利要求1所述的方法，其特征在于，所述身份凭证背书的有效期、签发机构、证书策略、证书序列号采用明文展示。7.一种基于权利要求1所述方法生成的身份凭证背书的验证方法，其步骤包括：1)背书持有人将所述身份凭证背书存储于IC卡、U盘或智能移动终端上，当验证方需要对背书持有人进行鉴别时，将存储设备与验证方进行交互，仅提供背书的封面，验证方验证背书封面的合法性；i.当验证方需要验证所述身份凭证背书中第i项真实身份信息时，背书持有人确认后，通过存储所述身份凭证背书的相关设备向验证方提供身份凭证背书中第i个内容页所存储的第i项真实身份信息和对应盐值；ii.验证方将第i项真实身份信息和对应盐值按照所述密码函数进行计算，将计算结果和身份凭证背书封面第i项的用户信息码进行比对，如果结果相等，则通过验证，如果结果不相等，则验证失败。8.根据权利要求6所述的方法，其特征在于，验证方通过身份凭证背书中的背书持有人公钥，验证被验证者是否为背书持有人。9.根据权利要求6所述的方法，其特征在于，验证方通过获取身份凭证背书中的生物特征，对比被验证方的对应生物特征，以验证被验证者是否为背书持有人。10.根据权利要求6所述的方法，背书持有人通过用户名口令、PIN码、指纹或人脸识别方式对提供背书内容页的查看进行确认。
说明书desc
技术领域本发明涉及一种保护隐私的身份凭证背书生成和验证方法，属于信息安全领域。背景技术随着信息技术的不断发展，个人信息的过度收集、分析、共享、滥用的现象也愈发活跃。商业和行政机构出于合法的目的，需要通过信息化手段获知必要的个人信息，如需要实名制的场所需要获知用户的公民身份。个人信息身份鉴别和个人信息隐私保护的矛盾成为当前信息化发展中亟需解决的重要问题。在实施实名制的背景下，避免证件中的隐私信息泄露是亟待解决的问题。即既能出示合法的数字证件，又不泄露个人隐私。发明内容本发明提出一种保护隐私的身份凭证背书的生成和验证方法，所述背书申请人是申请身份凭证背书的用户；背书持有人是获得身份凭证背书的用户；身份管理机构是指核实背书申请人身份信息并对身份凭证背书进行签名认证的机构。该方法利用数字签名签发数字身份凭证背书，结合原始内容的摘要组合，可选择地证明背书持有人的身份信息。该方法保护背书持有人在网络应用中的真实身份信息不被全部泄露，以避免不同应用系统对背书持有人的行为进行汇聚、分析和追踪。在需要时，经背书持有人认可，可以向验证方展示受保护的背书持有人的其他身份信息。本发明所述的身份凭证背书包括封面和内容页。背书封面中，利用身份信息码代替需要保护的背书持有人的真实身份信息进行展示。由于身份信息码是不可逆密码函数处理后的真实身份信息，能够确保对方无法知道其真实内容。本发明所述方法能够在证明背书持有人具有可信身份的同时保护需要保护的背书持有人的真实身份信息。背书持有人的身份信息码可以由身份信息、身份信息盐值进行不可逆密码函数的计算后获得，无法进行反向计算和推导。验证方获取身份凭证背书封面后，可以使用身份管理机构的公钥验证身份管理机构对身份凭证背书封面的签名，从而验证身份凭证背书的合法性。当身份凭证背书封面中含有背书持有人公钥时，还可以通过挑战响应方式，验证对方是否为该身份凭证背书的持有人。验证方通过获知身份背书凭证的签发机构和有效期，确知该身份有效，但无法知道背书持有人的真实身份信息，从而在验证背书持有人身份的同时保护背书持有人的身份隐私。背书持有人的身份信息和对应盐值及其与身份信息码的对应关系，作为身份凭证内容页存放在身份凭证背书中，在必要时可以取出展示。身份凭证背书封面和身份凭证背书内容页组成完整的身份凭证背书。在不同应用场景，背书持有人根据需要向验证方提供身份凭证背书的封面，或进一步提供身份背书凭证内容页，以达到充分保护背书持有人的身份隐私的情况下，完成验证方对背书持有人的身份鉴别。本发明提出的一种保护隐私的身份凭证背书生成和验证方法，其技术方案包括以下步骤：身份管理机构获得背书申请人的身份信息。身份管理机构根据背书申请人身份信息构造待签名的数字证书。对需要隐私保护的每一项背书申请人的真实身份信息，产生新的随机数作为该项真实身份信息的盐值，将该项身份真实信息和对应盐值进行拼接后，进行密码函数计算，对计算结果进行编码后，得到该项身份信息的身份信息码。密码函数为不可逆密码函数，应确保通过身份信息码无法推导出身份信息。身份管理机构将背书申请人的各项身份信息的身份信息码替换数字证书中对应该项的真实身份信息。身份管理机构按照数字证书格式要求，对以上形成的数字证书进行数字签名，得到的已签名的数字证书，即为完整的身份凭证背书的封面。将需要保护的背书申请人的第i项身份信息和对应的盐值，及其与身份信息码的对应关系，作为身份凭证背书的第i个内容页。身份管理机构将身份凭证背书的封面和身份凭证背书的各内容页，作为完整的身份凭证背书发给背书申请人。当验证方完成身份凭证背书的验证后，还需要获知并验证某一项受保护的身份信息时，背书持有人可以向验证方提供身份凭证背书中对应的内容页中的身份信息和对应的盐值。验证方将该项用户信息和盐值按照步骤计算，计算结果和身份凭证背书封面对应项的身份信息码进行比对，如果结果相等，则通过验证，如果结果不相等，则验证失败。背书持有人可以根据验证方的安全状况决定是否进一步提供身份凭证背书的其他内容页。上述步骤中的背书申请人身份信息可以包括背书申请人的姓名、电话、身份证号、生日、住址、工作单位等，也可以包含背书申请人生物特征信息如照片、指纹、人脸录像和声纹等。上述步骤身份管理机构根据背书申请人身份信息构造数字证书，可以按照X.509的格式进行构造并完成签名和编码。上述步骤所述密码函数可以是任何具有单向性的密码原语，如单向函数或加密函数。上述步骤对需要隐私保护的每一项待保护真实身份信息Mi和其对应盐值Ri拼接后进行单向函数计算得到消息摘要，即身份信息码hi，计算式如下：hi＝H单向函数通常使用密码杂凑算法，如SM3密码算法。密码杂凑算法可以对任意长度消息进行压缩，输出定长的消息摘要。上述步骤对需要隐私保护的每一项待保护真实身份信息Mi，使用对应盐值Ri作为密钥，进行加密计算得到密文，即身份信息码ei，计算式如下：ei＝ERi加密函数通常使用对称加密，如SM4密码算法。也可以使用公钥加密，如SM2密码算法。身份信息码是对计算结果hi进行编码后得到的，因此，使用身份信息码代替背书申请人真实身份信息作为封面可以保护背书申请人的隐私信息。多项身份信息码和身份凭证背书的有效期等共同构成身份凭证背书的封面的待签名部分。身份管理机构对封面的待签名部分进行数字签名，将签名值并入待签名部分就得到身份凭证背书的完整封面。身份凭证背书有效期是按照现有数字证书标准明文展示的，方便验证方对身份凭证背书有效期的验证。身份凭证背书的封面可以不包含背书持有人公钥信息，身份凭证背书的内容页根据应用场景是可选的。待保护的身份信息和对应盐值，及其与身份信息码的对应关系，作为身份凭证背书内容页。身份凭证背书封面和身份凭证背书内容页共同构成背书申请人的身份凭证背书，由身份管理机构发送给背书持有人。上述步骤的验证方法为：身份凭证背书可以存储到IC卡中，验证方对背书持有人进行鉴别时，需要背书持有人确认。身份凭证背书可以存储到U盘中，验证方对背书持有人进行鉴别时，需要背书持有人确认。身份凭证背书可以存储到智能移动终端中，验证方对背书持有人进行鉴别时，需要背书持有人确认。本发明提出的一种保护隐私的身份凭证背书生成和验证方法，其特点和优点是：1、本发明提出的一种保护隐私的身份凭证背书生成和验证方法，利用数字签名签发数字身份凭证背书的封面，加上原始内容信息页的组合来证明背书持有人的身份。通过公正权威的身份管理机构对背书申请人的身份凭证背书签名，可以确保背书持有人身份信息的真实性，同时使用身份信息码代替背书申请人隐私信息，可以保护背书申请人的隐私。2、本发明为背书申请人隐私信息加上盐值，可以更好抵制字典攻击和暴力攻击，确保身份信息不泄露。3、本发明提出的身份凭证背书的封面可以根据场景需求，选择可公开的背书持有人身份信息，在特定应用场景经过背书持有人认可可以向验证方进一步展示经过证明的部分背书持有人身份信息，可操作性强。4、本发明提出的身份凭证背书本质上是一种数字证书，方便部署，便于大规模使用。5、本发明提出的身份凭证背书验证方法，背书持有人确认后完成身份信息鉴别，保护背书持有人隐私信息的同时灵活的实现背书持有人身份信息验证。附图说明图1为一种保护隐私的身份凭证背书生成和验证方法的流程图。具体实施方式本发明提出的一种保护隐私的身份凭证背书生成和验证方法，如图1所示，本发明具体实施步骤如下：首先背书申请人通过在线或离线的方式在身份管理机构登记身份信息。身份信息可以包括背书申请人的姓名、电话、身份证号、生日、住址、工作单位等，也可以包含背书申请人生物特征信息如用户照片、视频、指纹、人脸和声纹等。身份管理机构根据背书申请人身份信息构造待数字签名证书。身份管理机构根据身份信息构造数字签名证书，可以按照X.509的格式进行构造。实施例的身份凭证背书具体格式如下：上述身份凭证背书的有效期是明文显示的，其他信息可根据实际使用场景选择是否进行隐私保护。身份凭证背书的扩展信息可以在extensions域中定义。针对需要隐私保护的每一项待保护背书申请人信息，身份管理机构为身份信息产生唯一随机数作为该项待保护背书申请人身份信息的盐值进行密码函数运算。密码函数是具有单向性的函数，可以是身份信息和盐值进行拼接后，进行单向函数计算；也可以是将盐值作为密钥，对身份信息进行加密运算。对结果进行编码后，得到身份信息码。将身份信息码替代该项待保护背书申请人身份信息信息，得到待签名身份凭证背书封面。身份管理机构，按照数字证书格式对待签名身份凭证背书的封面进行数字签名，得到已签名的完整身份凭证背书封面。将背书申请人所有身份信息和对应盐值，及其与身份信息码的对应关系，作为身份凭证背书内容页。身份管理机构将身份凭证背书封面和身份凭证背书的内容页作为完整身份凭证背书发给背书持有人。当验证方验证背书持有人的某项待保护身份信息时，背书持有人向验证方提供身份凭证背书内容页中的身份信息和对应的盐值。验证方将身份信息和盐值按照步骤计算，计算结果和身份凭证背书封面对应的身份信息码进行比对，如果结果相等，则通过验证，如果结果不相等，则验证失败。背书持有人可以根据验证方的安全等级决定是否进一步提供身份凭证背书的身份信息。本发明的目的是提出一种保护隐私的身份凭证背书生成和验证方法，利用数字签名签发数字身份凭证背书的封面，加上原始内容组合来证明背书持有人的身份。该方法保护用户在网络应用中的部分真实身份信息，以避免不同应用系统对用户的行为进行汇聚、分析和追踪，在需要时，经用户认可可以向验证方展示经过证明的部分用户身份信息。本发明使用身份信息码代替背书申请人真实身份信息出现在证书的封面，从而能够证明背书申请人具有可信身份同时保护了需要保护的背书申请人身份隐私。身份信息码是由背书申请人身份信息、身份信息盐值进行单向函数或加密函数计算后获得，无法进行反向计算，验证方获取身份凭证背书封面页后，可以验证身份凭证背书的正确性，但不知道某些背书持有人身份信息的具体内容。身份信息和对应盐值及其与身份信息码的对应关系，作为身份凭证背书内容页存放，便于必要时向检查机构展示。身份凭证背书封面和身份凭证背书内容页组成完整的身份凭证背书。以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明保护的范围之内。
