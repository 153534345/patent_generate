标题title
一种用于射频系统的搜索记忆式阻抗匹配调节方法
摘要abst
本发明公开了一种用于射频系统的搜索记忆式阻抗匹配调节方法，适用于L型阻抗匹配电路的可调电容调节。本方法不需要建立准确的匹配电路模型，利用匹配电路前端的传输线终端阻抗和当前并联电容Cp的容值直接计算得到并联电容Cp的调节量，并以此作为电容Cp的调节依据，提升了电容Cp的调节收敛速度，减少了Cp电容无效调节的次数；针对串联电容Cs采用试探调节方法，每次试探调节后，依靠调节前后反射系数模值变化情况来对电容进行自适应的调节，针对不同的反射系数模值采取不同的调节步长。电容Cp和Cs交替调节，减小了彼此耦合带来的锯齿现象。此外，通过在局部最优点范围大步长调节和数值滤波方法的处理尽可能避免产生局部最优的问题。
权利要求书clms
1.一种用于射频系统的搜索记忆式阻抗匹配调节方法，所述射频系统包括射频功率源、传输线、匹配电路以及负载，所述匹配电路包括与负载并联的可调电容Cp以及与负载串联的可调电容Cs，其特征在于，所述方法包括以下步骤：S1，根据测量得到的传输线终端阻抗ZL和可调电容Cp当前的容值Cp1，计算得到ZA；其中，ZA是除Cp之外的匹配电路与负载组成的二端网络的等效阻抗；S2，按照预设规则确定可调电容Cp的若干搜索容值，分别计算各搜索容值与ZA的并联阻抗值，作为电容调节后的传输线终端阻抗；再根据电容调节前后的传输线终端阻抗计算相应的反射系数模值，并取最小的反射系数模值对应的搜索容值作为目标容值Cp2；S3，将可调电容Cp的容值调节为Cp2，并测量当前的反射系数模值，若较上一次测量的反射系数模值减小了，执行S4；否则，执行S1；S4，若减小量大于阈值Γs1，且可调电容Cp没有超过调节范围，则执行S1；否则，执行S5；S5，随机确定可调电容Cs的调节方向，测量调节后的反射系数模值，若较上一次测量的反射系数模值增大了，反方向调节可调电容Cs，并执行S6；若减小了，按原方向继续调节，并执行S6；S6，调节可调电容Cs后，测量当前的反射系数模值，若较上一次测量的反射系数模值减小了，执行S7；否则，反方向按原步长调节，并执行S8；S7，若减小量大于阈值Γs2，且可调电容Cs没有超过调节范围，则按原方向继续调节，并执行S6；否则，执行S8；S8，若当前反射系数模值小于等于稳态阈值，输出阻抗匹配结果；否则，执行S1。2.根据权利要求1所述的用于射频系统的搜索记忆式阻抗匹配调节方法，其特征在于，所述S2中，按照预设规则确定可调电容Cp的若干搜索容值，包括：以第一步长在容值Cp1左右各取多个容值，作为可调电容Cp的若干搜索容值。3.根据权利要求2所述的用于射频系统的搜索记忆式阻抗匹配调节方法，其特征在于，所述方法还包括：S0，获取初始反射系数模值，若所述初始反射系数模值大于区分阈值，则以第二步长调节可调电容Cp，并测量调节后的反射系数模值，直至测量的反射系数模值小于等于区分阈值；其中，若测量的反射系数模值大于安全阈值，则进行反方向调节；所述安全阈值大于区分阈值，所述第二步长大于第一步长。4.根据权利要求1所述的用于射频系统的搜索记忆式阻抗匹配调节方法，其特征在于，所述方法还包括：S0＇，获取初始反射系数模值，若所述初始反射系数模值大于区分阈值，则以第三步长调节可调电容Cs，并测量调节后的反射系数模值，直至测量的反射系数模值小于等于区分阈值；其中，若测量的反射系数模值大于安全阈值，则进行反方向调节；所述安全阈值大于区分阈值，所述第三步长大于步骤S5中首次调节可调电容Cs的步长。5.根据权利要求3或4所述的用于射频系统的搜索记忆式阻抗匹配调节方法，其特征在于，当测量的反射系数模值大于所述区分阈值时，进行多次测量并采用数值滤波方法进行处理得到去噪后的反射系数模值，作为当前的反射系数模值。6.根据权利要求1所述的用于射频系统的搜索记忆式阻抗匹配调节方法，其特征在于，每次调节可调电容Cp或Cs时，根据当前的反射系数模值所在区间范围，调整相应的调节步长；所述区间范围的值越小，相应的调节步长也越小。7.根据权利要求6所述的用于射频系统的搜索记忆式阻抗匹配调节方法，其特征在于，所述区间范围按反射系数模值对电容值的梯度来确定。8.根据权利要求1所述的用于射频系统的搜索记忆式阻抗匹配调节方法，其特征在于，在停止射频功率输出时，将匹配电路恢复至初始状态，为下一次阻抗匹配调节做好准备。
说明书desc
技术领域本发明属于阻抗匹配技术领域，更具体地，涉及一种用于射频系统的搜索记忆式阻抗匹配调节方法。背景技术在受控磁约束核聚变中，大功率射频负离子源被应用于高能中性束注入辅助加热系统。其中，射频负离子源的射频系统一般由射频功率源、传输线、阻抗匹配电路以及等离子体激励器负载等组成。阻抗匹配电路与激励器负载相连，以期将激励器阻抗变换至传输线特征阻抗，避免阻抗失配造成较大的功率反射，实现功率传输效率最大化。在射频离子源中常见的阻抗匹配电路为L型，至少含连接在传输线末端内外导体间的并联可调电容Cp、与激励器负载串联的可调电容Cs。射频离子源运行过程中，激励器的等效阻抗会随着内部等离子体参数的变化而变化，为此，阻抗匹配电路需要根据匹配电路入口的反射系数等参量对可调电容进行调节，以实现较好的匹配状态。由于射频负离子源通常工作在射频频段，阻抗匹配电路尺寸较大，寄生参数对阻抗匹配电路的影响不可忽略，难以获得电路的准确数学模型，也就无法通过电路模型进行匹配电容调节量的精确计算。另外，可调电容的调节与激励器负载阻抗之间存在耦合关系，具体而言，匹配状态的改变会引起激励器负载吸收功率的变化，进而影响激励器负载的阻抗变化，需要进一步调节电容。因此，可调电容的调节也不可能由一个电路模型一次性直接计算得到最优调节量。基于这种背景，一种稳健、高效的阻抗匹配控制方法对大功率射频负离子源系统及类似系统的运行具有重要意义。现有的阻抗匹配方案大体可分为离线调节与在线调节。离线调节方法需要在等离子体激发前计算最佳匹配参数，手动完成匹配电路调节后直接开始激发过程，这种方式在激发过程中不会再次调节阻抗匹配电路，因此无法解决等离子体激发过程中阻抗参数动态变化的问题。在线调节方法中主要有坐标轮换法与梯度下降法，它们都检测实时反射系数模值来完成阻抗匹配控制。坐标轮换法轮流将各个电容值按反射系数模值下降的方向以固定步长进行对电容进行调节。以反射系数模的差值为限使电容进行切换调节，即认为本轮该电容的调节满足了设定要求。最后以反射系数模值小于设定的阻抗匹配要求最小阈值为限来结束整个控制过程；梯度下降法中将调节前后反射系数模差值与电容调节步长的比值来估计反射系数模与两个电容的偏导数，以此作为下一次电容调节步长与方向的依据来实现阻抗匹配控制。然而，这两种方法都将匹配电路或系统当成一个未知的整体，完全依靠阻抗匹配模值进行试探性的电容调节，未充分利用匹配电路的特点，电容的调节存在一定的反复问题，因此调节的有效性不够理想。此外，传统坐标轮换法并没有考虑实际系统中反射系数模值与电容容值的关系，采用了固定的调节步长，对负载变化的适应性不强，收敛速度很慢。并且当离起始匹配的电容参数离最优匹配点较远时，固定步长取的不合理容易导致控制方法陷入噪声引起的局部最优点；而梯度下降法中虽然依靠反射系数模值与电容的偏导数关系进行步长的适应，但由于同时调节两个电容，因此在最优点附近容易出现锯齿现象，即存在某些电容在已经到达了阻抗匹配稳态值后，还存在反复的无效调节情况，这严重降低控制方法的收敛速度。同时由于梯度下降法步长完全依靠梯度，当在局部最优点附近时由于梯度也会趋近0而更容易陷入局部最优。为进一步解决局部最优问题，模拟退火算法、粒子群算法、遗传算法等智能算法在许多文献被引入到阻抗匹配方法中，但它们为了跳出局部最优的区间往往引入了随机性算法，通过随机跳转的方法在整个匹配范围中进行搜索，完全的依靠随机性来解决局部最优问题，会存在搜索过程中反射系数过大而损坏射频功率源的问题，此外，搜索时间也可能较长，无法满足高实时性阻抗匹配要求。发明内容针对现有技术的缺陷和改进需求，本发明提供了一种用于射频系统的搜索记忆式阻抗匹配调节方法，旨在解决现有阻抗匹配调节速度慢、易落入局部最优点的技术问题。为实现上述目的，本发明提供了一种用于射频系统的搜索记忆式阻抗匹配调节方法，所述射频系统包括射频功率源、传输线、匹配电路以及负载，所述匹配电路包括与负载并联的可调电容Cp以及与负载串联的可调电容Cs，所述方法包括以下步骤：S1，根据测量得到的传输线终端阻抗ZL和可调电容Cp当前的容值Cp1，计算得到ZA；其中，ZA是除Cp之外的匹配电路与负载组成的二端网络的等效阻抗；S2，按照预设规则确定可调电容Cp的若干搜索容值，分别计算各搜索容值与ZA的并联阻抗值，作为电容调节后的传输线终端阻抗；再根据电容调节前后的传输线终端阻抗计算相应的反射系数模值，并取最小的反射系数模值对应的搜索容值作为目标容值Cp2；S3，将可调电容Cp的容值调节为Cp2，并测量当前的反射系数模值，若较上一次测量的反射系数模值减小了，执行S4；否则，执行S1；S4，若减小量大于阈值Γs1，且可调电容Cp没有超过调节范围，则执行S1；否则，执行S5；S5，随机确定可调电容Cs的调节方向，测量调节后的反射系数模值，若较上一次测量的反射系数模值增大了，反方向调节可调电容Cs，并执行S6；若减小了，按原方向继续调节，并执行S6；S6，调节可调电容Cs后，测量当前的反射系数模值，若较上一次测量的反射系数模值减小了，执行S7；否则，反方向按原步长调节，并执行S8；S7，若减小量大于阈值Γs2，且可调电容Cs没有超过调节范围，则按原方向继续调节，并执行S6；否则，执行S8；S8，若当前反射系数模值小于等于稳态阈值，输出阻抗匹配结果；否则，执行S1。进一步地，所述S2中，按照预设规则确定可调电容Cp的若干搜索容值，包括：以第一步长在容值Cp1左右各取多个容值，作为可调电容Cp的若干搜索容值。进一步地，所述方法还包括：S0，获取初始反射系数模值，若所述初始反射系数模值大于区分阈值，则以第二步长调节可调电容Cp，并测量调节后的反射系数模值，直至测量的反射系数模值小于等于区分阈值；其中，若测量的反射系数模值大于安全阈值，则进行反方向调节；所述安全阈值大于区分阈值，所述第二步长大于第一步长。进一步地，所述方法还包括：S0＇，获取初始反射系数模值，若所述初始反射系数模值大于区分阈值，则以第三步长调节可调电容Cs，并测量调节后的反射系数模值，直至测量的反射系数模值小于等于区分阈值；其中，若测量的反射系数模值大于安全阈值，则进行反方向调节；所述安全阈值大于区分阈值，所述第三步长大于步骤S5中首次调节可调电容Cs的步长。进一步地，当测量的反射系数模值大于所述区分阈值时，进行多次测量并采用数值滤波方法进行处理得到去噪后的反射系数模值，作为当前的反射系数模值。进一步地，每次调节可调电容Cp或Cs时，根据当前的反射系数模值所在区间范围，调整相应的调节步长；所述区间范围的值越小，相应的调节步长也越小。进一步地，所述区间范围按反射系数模值对电容值的梯度来确定。进一步地，在停止射频功率输出时，将匹配电路恢复至初始状态，为下一次阻抗匹配调节做好准备。总体而言，通过本发明所构思的以上技术方案，能够取得以下有益效果：本发明通过将传输线终端阻抗ZL等效为可调电容Cp与ZA并联；接着，按照预设规则确定可调电容Cp的若干搜索容值，分别计算各搜索容值与ZA的并联阻抗值，作为电容调节后的传输线终端阻抗；再根据电容调节前后的传输线终端阻抗计算相应的反射系数模值，并取最小的反射系数模值对应的搜索容值作为目标容值，以确定可调电容Cp的调节量。如此，提升了可调电容Cp的调节收敛速度，减少了无效调节的次数。为了避免局部最优的问题，设置了反射系数模值的区分阈值，并将大于区分阈值划为平坦区，小于区分阈值划为快速下降区。在平坦区进行梯度法搜索会导致收敛速度慢以及陷入局部最优的问题，因此在此范围在进行多次冗余反射系数模值检查并进行数值滤波后，通过大步长固定间距搜索来跳出局部最优。在快速下降区则轮换调整电容，每个电容按照梯度法设置不同的搜索步长来实现随反射系数模值的自适应，以进一步加快整体的调节速度、提升调节过程的优化效率和稳定程度；而试探调节中的调节步长也有随反射系数模值自适应变换的特点。附图说明图1为本发明实施例提供的被控对象电路模型；图2为本发明实施例提供的被控对象电路简化模型；图3为本发明实施例提供的反射系数模值随单个电容调节变化的示意图；图4为本发明实施例提供的一种用于射频系统的搜索记忆式阻抗匹配调节方法流程图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。此外，下面所描述的本发明各个实施方式中所涉及到的技术特征只要彼此之间未构成冲突就可以相互组合。在本发明中，本发明及附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。参见图1，本发明实施例可应用在包括但不限于图1中所示射频系统中，在本实施例中，以射频负离子源的系统为例，其一般由射频功率源、传输线、匹配电路以及激励器负载等部分构成。所示匹配电路即为前文所提加入了射频变压器的L型匹配电路。参见图2，本发明实施例在进行搜索记忆式控制算法时，传输线终端阻抗ZL与除去电容Cp后从变压器原边看进去的等效阻抗ZA在图2中进行标识。Cp为并联可调电容，Cs为串联可调电容，RD、LD为激励器负载等效阻抗的电阻和电感等效值。本实施例中，传输线终端阻抗测量点与并联可调电容Cp位置接近。参见图3，本发明实施例中，多次实验整理出的反射系数模值随单个电容的关系由图3中曲线表明。此外，图3中标注了由噪声引起的局部最优点。当反射系数模值较大、远离匹配点时，反射系数模值随电容的变化不大；当电容容值落入最优阻抗匹配附近时，反射系数模值开始快速下降，在接近最优匹配点时再逐渐变缓。在本发明实施例中，最优阻抗匹配点即为图中所示反射系数模值最小点3。参见图4，本发明实施例提供了一种适用于上述系统的的搜索记忆式阻抗匹配调节方法，包括以下步骤：步骤1：开始阻抗匹配控制；步骤2：控制系统初始化，完成设备上电、设置初始的电容调节参数，设置电容调节范围、变量设置、设置自适应搜索步长区间、设置自适应调节步长区间以及其他初始化工作；步骤3：判断是否检测到了射频功率信号。若未接收到射频功率触发有效信号则一直等待该触发来临，此时不会进行电容调节实现阻抗匹配。当接收到外部触发有效信号后，执行步骤4；步骤4：通过伏安测量法计算得到电容调节前的传输线终端阻抗值与反射系数模值，并计算并联电容Cp的调节量。具体过程如下：调节量的获取需要根据图1被控对象电路模型完成计算，其中ZL是传输线终端阻抗，可通过检测电压电流值后进行计算得到，ZA是除Cp之外的阻抗匹配电路与离子源负载组成的二端网络的等效阻抗。根据ZA与ZL的串并联关系，则传输线终端阻抗ZL可表示为：此时，调节前的反射系数模值为：其中ZTL为特性阻抗，为50欧姆。经过转换，ZA的形式可表达为：即在已知传输线终端阻抗ZL和当前Cp的容值Cp1的情况下，可计算出ZA的值。在此ZA下，可将电容调节后的传输线终端阻抗表示为：′其中Cp为在Cp基础上经过调节后的电容值，需要根据搜索步长在实测电容值附近的电容值点进行确定。此时反射系数模值可表示为：由以上表达式可知，可以通过在一定范围内遍历搜索的方式计算出使′得|Γ|最小时的Cp2，则电容调节量可表示为：ΔCp＝Cp2-Cp1在求解Cp2时，为避免在控制器中求解过于复杂，采用搜索方式，按第一步长在可调电容Cp当前的容值Cp1附近取多个搜索电容值，计算对应反射系数模值，并以搜索范围内反射系数模值最优的电容值作为本次搜索的目标容值Cp2。搜索点在本实施例中设置为20个，搜索步长也满足自适应的特点，可依据自适应搜索步长区间进行确定。下表1是根据实验整理出自适应搜索步长区间。第一步长的确定依据了梯度计算的特点，本发明中梯度近似为调节前后反射系数模值之差与上一次调节步长的比值。对于反射系数|Γ|小于0.1的范围，第一步长的调节可以进一步按梯度计算的方式完成细化，以不等间距步长进行搜索，本实施例直接按表1中的区间进行步长调整。表1快速下降区自适应搜索步长区间划分记录调节后的反射系数模值；此外，在步骤3和步骤4之间，还包括：步骤3＇：以反射系数模值|Γ|＝0.7作为平坦区与快速下降区的区分阈值，反射系数模值的获取在反射系数模值|Γ|大于0.7时需要多次测量并取中值以滤除噪声，避免局部最优点的出现。在此区域，可调电容Cp的调节步长选择40pF，初始调节方向随机，若没有达到反射系数模值的安全阈值限值，则以此步长和方向继续调节直到进入快速下降区，否则要反向调节直到进入快速下降区。然后再执行步骤4；步骤5：将电容Cp调节前后的反射系数模值进行比较运算，若反射系数模值减小且减小量大于阈值Γs1则执行步骤6，否则执行步骤7；步骤6：判断可调电容Cp是否超过调节范围，若未超过则执行步骤4，否则执行步骤7；步骤7：记录串联电容Cs调节前的反射系数模值信息，根据自适应调节步长区间确定步长并先试探性选择调节方向。下表2是基于大量实验建立的自适应调节步长区间划分表。根据反射系数模值的不同划分为三段步长区间，电容调节步长的确定可以依靠反射系数模的测量值来确定。这里步长划分并不完全依靠梯度法进行，因为对于串联电容的调节往往比较细微，经过控制器计算后得到的步长值容易有较大误差。表2自适应调节步长区间划分记录调节后的反射系数模值；同样地，在步骤3和步骤4之间，还包括：步骤3＇＇：以反射系数模值|Γ|＝0.7作为平坦区与快速下降区的区分阈值，反射系数模值的获取在反射系数模值|Γ|大于0.7时需要多次测量并取中值以滤除噪声，避免局部最优点的出现。在此区域，可调电容Cs的调节步长选择5pF，初始调节方向随机，若没有达到反射系数模值的安全阈值，则以此步长和方向继续调节直到进入快速下降区，否则要反向调节直到进入快速下降区。然后再执行步骤4；需要说明的是，为防止调节过程落入局部最优，划定了反射系数模值随电容变化的快速下降区与平坦区。平坦区的反射系数模值较大，容易由噪声引起范围较小的局部最优点。为了能跨过此范围，在平坦区中，匹配调节方法以大步长进行试探调节。本发明中，在执行步骤4之前，可以通过加大步长调节可调电容Cs、或调节可调电容Cp、或同时调节可调电容Cs和Cp，以进入快速下降区。步骤8：将电容Cs调节前后的反射系数模值进行比较运算，若反射系数减小且减小量大于阈值Γs2则执行步骤9，否则执行步骤12；步骤9：判断是否超过可调电容Cs的调节范围，若未超过依据按“记忆”继续执行步骤7，否则执行步骤10；步骤10：判断反射系数模值是否到达设定的稳态阈值，若未到达执行步骤14，否则执行步骤11；步骤11：保持Cp、Cs电容值。执行步骤13；步骤12：记录电容Cs调节前的反射系数模值，以上一次电容调节时相同的步长反向调节电容Cs并记录调节后的反射系数模值；步骤13：判断外部触发是否有效，即是否检测到射频功率，无效则执行步骤16，否则执行步骤10；步骤14：判断外部触发是否有效，即是否检测到射频功率，无效则执行步骤15，否则执行步骤4开始新一轮的匹配控制。步骤15：匹配失败报警。步骤16：结束调节过程。本实施例不再将被控对象完全视作一个未知的模型，而是充分利用被控对象电路模型的特点，有针对性地确定并联电容的调节方向和调节量。对于串联电容的控制则继续采取试探性的匹配调节控制方法通过实时检测匹配电容调节前后的反射系数模值，依靠之前调剂的“记忆”来动态调整电容。本发明实施例提供的搜索记忆式阻抗匹配控制方法能比较精确的完成并联电容的调节，降低了其反复调节纠正的频次，进一步提升了调节过程的优化效率和稳定程度，并同时具有较快的调节速度。在反射系数模值较大时选择大步长试探调节和大步长的电容容值搜索以及数值滤波等方式，能更有效的跳出在偏离最优匹配点较远处由误差导致的局部最优点问题。后续电路的可调电容依据反射系数模值变化情况与模值大小自适应来选择调整方向和调节步长，从而使匹配控制具有较快的调节速度和鲁棒性。两个电容的调节具有独立性，不会导致在最优点附近发生锯齿现象。本领域的技术人员容易理解，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
