标题title
一种基于端口能量重塑的虚拟同步控制方法
摘要abst
本发明提供一种基于端口能量重塑的虚拟同步控制方法，包括：建立基于虚拟同步发电机并入无穷大电网系统的动态模型，根据虚拟同步机并入无穷大电网系统的动态模型，塑造所述虚拟同步机并入无穷大电网系统的动态模型对应的能量函数，进而建立虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统数学模型，并推导得到所建立的哈密尔顿受控系统数学模型的参数，校验哈密尔顿受控系统数学模型的零状态可检测性；根据哈密尔顿受控系统数学模型及推导得到的参数，反推得到使所建立哈密尔顿受控系统数学模型在平衡点x0处渐近稳定的励磁电压调节量对应的控制策略。本发明可有效抑制由故障工况诱发的功率振荡，改善风机并网端的电压和频率质量。
权利要求书clms
1.一种基于端口能量重塑的虚拟同步控制方法，其特征在于，包括如下步骤：步骤S1：建立基于虚拟同步发电机并入无穷大电网系统的动态模型；步骤S2：根据步骤S1建立的虚拟同步机并入无穷大电网系统的动态模型，塑造所述虚拟同步机并入无穷大电网系统的动态模型对应的能量函数，进而建立虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统数学模型，并进一步推导得到所建立的哈密尔顿受控系统数学模型的参数，最后校验所建立哈密尔顿受控系统数学模型的零状态可检测性；步骤S3：根据步骤S2建立的哈密尔顿受控系统数学模型及推导得到的参数，反推得到使所建立哈密尔顿受控系统数学模型在平衡点x0处渐近稳定的励磁电压调节量对应的控制策略。2.根据权利要求1所述的方法，其特征在于，步骤S1建立基于虚拟同步发电机并入无穷大电网系统的动态模型，具体包括：在新能源场站的虚拟同步电动机模型，以风机电网侧变流器控制的角度为控制变量，考虑虚拟同步发电机励磁控制方程和运动微分方程，建立虚拟同步发电机并入无穷大电网系统的动态模型的方程，如式所示，各参数如式所示；其中，δ是虚拟同步发电机的功角，ωm和ω分别为虚拟同步发电机的机械角速度标幺值和电气角速度，H为虚拟同步发电机的惯性时间常数，Pm和Pe分别为虚拟同步发电机的机械转矩和电磁转矩，D为虚拟同步发电机的阻尼，Eq’和Efds分别为虚拟同步发电机的交轴暂态电势和系统稳态运行时励磁电压，uf为励磁电压调节量，Td0’为虚拟同步发电机的直轴暂态短路时间常数，Xd和Xd’分别为虚拟同步发电机的直轴稳态电抗和直轴暂态电抗，Us＝1∠0°为无穷大电网电压，XT1为升压变T1电抗，XT2为升压变T2电抗，XL为线路电抗，XdΣ和XdΣ'分别为稳态等效电抗和暂态等效电抗。3.根据权利要求1所述的方法，其特征在于，步骤S2具体包括：S2.1：根据虚拟同步发电机并入无穷大电网系统的动态模型的方程，塑造该模型对应的能量函数H，即哈密尔顿函数，并对塑造的能量函数H进行求导，并参照广义哈密尔顿受控系统模型，建立虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统数学模型；S2.2：根据步骤S2.1所建立的虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统数学模型，进一步推导系统阻尼矩阵R、系统结构矩阵J和输入变量控制矩阵g，从而推导得到所建立的虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统的数学模型的具体参数，最后根据推导得到的参数，校验所建立哈密尔顿受控系统的零状态可检测性，以保证哈密尔顿受控系统在平衡点x0处渐近稳定。4.根据权利要求3所述的方法，其特征在于，步骤S2.1塑造虚拟同步机注入电网的能量函数H的步骤包括：首先建立能量函数：再将H对状态变量ω，δ，Eq’求偏导，结果如所示；参照广义哈密尔顿受控系统模型方程：并根据所建立的虚拟同步机并入无穷大电网系统的动态模型方程和/＞建立虚拟同步机并入无穷大电网系统对应的哈密尔顿受控系统数学模型：/＞其中，为状态变量对时间的梯度；J为系统结构矩阵，其为反对称矩阵；R为系统阻尼矩阵，其为半正定对称矩阵；u和y是共轭变量，分别表示输入和输出向量；g为输入向量控制矩阵，gT为其转置矩阵。5.根据权利要求4所述的方法，其特征在于，步骤S2.2推导得到所建立的虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统的数学模型的具体参数的步骤包括：首先由建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿受控系统数学模型和所建立的虚拟同步机并入无穷大电网系统的动态模型的方程/＞求得其系数矩阵：由于R是半正定对称矩阵，满足R＝RT≥0，J为反对称矩阵，满足J＝-JT，进而推导得到系统阻尼矩阵R、系统结构矩阵J和输入变量控制矩阵g分别为：/＞最后得到输出方程为：即推导得到了所建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿受控系统的具体参数；为保证所建立哈密尔顿受控系统在平衡点x0处渐近稳定，所建立系统必须满足零状态可检测性，得到所建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿受控系统收敛的最大的不变子集，如式/＞所示，该不变子集是该系统的平衡点，因此满足零状态可检测性。6.根据权利要求1所述的方法，其特征在于，步骤S3具体包括：首先根据系统的零状态可检测性可知，当励磁电压调节量对应的控制策略uf满足且K为正定矩阵时，所建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿受控系统在平衡点x0处渐近稳定；根据建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿受控系统和推导得到的参数，反推得到励磁电压调节量对应的控制策略uf：其中，k1≥0是正定反馈控制比例系数，利用反推得到励磁电压调节量对应的控制策略uf，建立基于端口能量重塑的虚拟同步发电机并入无穷大电网系统的完整控制模型，其中端口受控哈密尔顿反馈控制uf接于虚拟同步发电机的励磁环节输入端，用来抑制虚拟同步发电机并入无穷大电网系统的振荡，其中，模型中的各参数如式所示，Xd和Xd’分别为虚拟同步发电机的直轴稳态电抗和直轴暂态电抗，Td0’为虚拟同步发电机的直轴暂态短路时间常数，XdΣ和XdΣ'分别为稳态等效电抗和暂态等效电抗。/＞
说明书desc
技术领域本发明属于电力系统运行稳定分析领域，涉及一种基于端口能量 重塑的虚拟同步控制方法，尤其是涉及一种抑制由故障工况诱发的功 率振荡的基于端口能量重塑的虚拟同步控制方法。背景技术伴随我国“双碳”目标的提出，以风能和光伏为主体的可再生能源 得到了大力发展，而以传统化石能源为主要能量来源的传统同步发电 机被广泛取代，导致电力系统的惯量和阻尼减小，从而制约了系统的 调频调压能力，威胁电网的安全稳定运行。虚拟同步发电机技术被广泛应用于解决新型电力系统电力电子 化带来的弱阻尼和低惯量问题。有些学者提出虚拟同步化微电网的虚 拟惯量和虚拟阻尼参数优化设计方法。有些学者提出一种基于模糊控 制的虚拟同步发电机参数自适应控制策略，根据角频率偏差及其变化 率，在不同工况下实时调节转动惯量和阻尼系数，从而提高微电网频 率的稳定性。大部分改进虚拟控制策略多基于线性化的系统模型开展。 然而，电力系统是较为复杂的非线性系统，许多线性控制方法难以适 用，而广义哈密尔顿系统为解决非线性系统控制问题提供了新思路。 有些学者基于广义耗散哈密尔顿理论设计一种新型多机励磁和统一 潮流的非线性协调控制器，解决了多机电力系统中由于参数不确定扰 动给系统稳定控制器带来的影响。有些学者提出了一种基于耗散哈密 尔顿理论的虚拟同步发电机控制方法，利用自抗扰控制解耦算法来提 升系统的抗干扰能力和稳定性，为系统提供虚拟惯性和正阻尼的同时， 消除了参数摄动和耦合。有些学者基于电力系统能量的哈密尔顿函数，设计了抑制低频振荡的电力系统控制器，并提出了附加阻尼的设计方 法。在风电场并网系统中，虽然在风电机组控制策略中引入虚拟同步 发电机控制，能够有效提高系统的稳定性，但在某些故障扰动下仍然 可能会伴随不同程度的功率振荡发生。发明内容针对现有技术的以上缺陷或改进需求，本发明提出一种基于端口 能量重塑的虚拟同步控制方法，抑制由故障工况诱发的功率振荡，同 时还能改善风机并网端的电压和频率质量。为实现上述目的能，本发明提供了一种基于端口能量重塑的虚拟 同步控制方法，包括：步骤S1：建立基于虚拟同步发电机并入无穷大电网系统的动态 模型；步骤S2：根据步骤S1建立的虚拟同步机并入无穷大电网系统的 动态模型，塑造所述虚拟同步机并入无穷大电网系统的动态模型对应 的能量函数，进而建立虚拟同步发电机并入无穷大电网系统对应的哈 密尔顿受控系统数学模型，并进一步推导得到所建立的哈密尔顿受控 系统数学模型的参数，最后校验所建立哈密尔顿受控系统数学模型的 零状态可检测性；步骤S3：根据步骤S2建立的哈密尔顿受控系统数学模型及推导 得到的参数，反推得到使所建立哈密尔顿受控系统数学模型在平衡点 x0处渐近稳定的励磁电压调节量对应的控制策略。进一步的，步骤S1建立基于虚拟同步发电机并入无穷大电网系 统的动态模型，具体包括：在新能源场站的虚拟同步电动机模型，以风机电网侧变流器控制 的角度为控制变量，考虑虚拟同步发电机励磁控制方程和运动微分方 程，建立虚拟同步发电机并入无穷大电网系统的动态模型的方程，如 式所示，各参数如式所示；其中，δ是虚拟同步发电机的功角，ωm和ω分别为虚拟同步发 电机的机械角速度标幺值和电气角速度，H为虚拟同步发电机的惯性 时间常数，Pm和Pe分别为虚拟同步发电机的机械转矩和电磁转矩， D为虚拟同步发电机的阻尼，Eq’和Efds分别为虚拟同步发电机的交轴 暂态电势和系统稳态运行时励磁电压，uf为励磁电压调节量，Td0’为 虚拟同步发电机的直轴暂态短路时间常数，Xd和Xd’分别为虚拟同步 发电机的直轴稳态电抗和直轴暂态电抗，Us＝1∠0°为无穷大电网电压， XT1为升压变T1电抗，XT2为升压变T2电抗，XL为线路电抗，XdΣ和 XdΣ'分别为稳态等效电抗和暂态等效电抗。进一步的，步骤S2具体包括：S2.1：根据虚拟同步发电机并入无穷大电网系统的动态模型的方 程，塑造该模型对应的能量函数H，即哈密尔顿函数，并对塑造的 能量函数H进行求导，并参照广义哈密尔顿受控系统模型，建立虚 拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统数学模 型；S2.2：根据步骤S2.1所建立的虚拟同步发电机并入无穷大电网系 统对应的哈密尔顿受控系统数学模型，进一步推导系统阻尼矩阵R、 系统结构矩阵J和输入变量控制矩阵g，从而推导得到所建立的 虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统的数 学模型的具体参数，最后根据推导得到的参数，校验所建立哈密尔顿 受控系统的零状态可检测性，以保证哈密尔顿受控系统在平衡点x0处渐近稳定。进一步的，步骤S2.1塑造虚拟同步机注入电网的能量函数H 的步骤包括：首先建立能量函数：再将H对状态变量ω，δ，Eq’求偏导，结果如 所示；参照广义哈密尔顿受控系统模型方程：并根据所建立的虚拟同步机并入无穷大电网系统的动态模型方程和/＞建立虚 拟同步机并入无穷大电网系统对应的哈密尔顿受控系统数学模型：其中，为状态变量对时间的梯度；J为系统结构矩阵，其为 反对称矩阵；R为系统阻尼矩阵，其为半正定对称矩阵；u和y是共 轭变量，分别表示输入和输出向量；g为输入向量控制矩阵，gT为 其转置矩阵。进一步的，步骤S2.2推导得到所建立的虚拟同步发电机并入无穷 大电网系统对应的哈密尔顿受控系统的数学模型的具体参数的步骤 包括：首先由建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿 受控系统数学模型和所建立 的虚拟同步机并入无穷大电网系统的动态模型的方程/＞求得其系数矩阵：由于R是半正定对称矩阵，满足R＝RT≥0，J为反对称矩 阵，满足J＝-JT，进而推导得到系统阻尼矩阵R、系统结构矩阵 J和输入变量控制矩阵g分别为：最后得到输出方程为：即推导得到了所建立的虚拟同步机并入无穷大电网系统对应的 哈密尔顿受控系统的具体参数；为保证所建立哈密尔顿受控系统在平衡点x0处渐近稳定，所建 立系统必须满足零状态可检测性，得到所建立的虚拟同步 机并入无穷大电网系统对应的哈密尔顿受控系统收敛的最大的不变 子集，如式/＞所示，该不变子集 是该系统的平衡点，因此满足零状态可检测性。进一步的，步骤S3具体包括：首先根据系统的零状态可检测性可知，当励磁电压调节量对应的 控制策略uf满足且K为正定矩阵时，所建立的虚拟 同步机并入无穷大电网系统对应的哈密尔顿受控系统在平衡点x0处 渐近稳定；根据建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿受 控系统和推导得到的参数，反推得到励磁电压调节量对应的控制策略 uf：其中，k1≥0是正定反馈控制比例系数，利用反推得到励磁电压调 节量对应的控制策略uf，建立基于端口能量重塑的虚拟同步发电机并 入无穷大电网系统的完整控制模型，其中端口受控哈密尔顿反馈控制 uf接于虚拟同步发电机的励磁环节输入端，用来抑制虚拟同步发电机 并入无穷大电网系统的振荡，其中，模型中的各参数如式 所示，Xd和Xd’分别为虚拟同步发电机的直轴 稳态电抗和直轴暂态电抗，Td0’为虚拟同步发电机的直轴暂态短路时 间常数，Xd∑和Xd∑'分别为稳态等效电抗和暂态等效电抗。总体而言，通过本发明所构思的以上技术方案与现有技术相比， 能够取得下列有益效果：1、所提基于端口能量重塑的虚拟同步控制方法能够有效抑制由 故障工况诱发的功率振荡；2、所提基于端口能量重塑的虚拟同步控制方法能够改善风机并 网端的电压和频率质量。附图说明图1是本发明实施例提供的一种基于端口能量重塑的虚拟同步 控制方法的流程图；图2是本发明实施例提供的虚拟同步发电机模型图；图3是本发明实施例提供的风电场接入无穷大电网模型图；图4是本发明实施例提供的有无VSG的风场有功图；图5是本发明实施例提供的有无VSG的电压波动图；图6是本发明实施例提供的有无VSG的电流波动图；图7是本发明实施例提供的有无VSG的风场有功图；图8是本发明实施例提供的有无PCH的风场有功图；图9是本发明实施例提供的有无PCH的电压波动图；图10是本发明实施例提供的有无PCH的电流波动图；图11是本发明实施例提供的有无VSG和PCH的转速波动图。具体实施方式为了使本发明的目的、技术方案及优点更加清楚明白，以下结合 附图及实施例，对本发明进行进一步详细说明。应当理解，此处所描 述的具体实施例仅仅用以解释本发明，并不用于限定本发明。此外， 下面所描述的本发明各个实施方式中所涉及到的技术特征只要彼此 之间未构成冲突就可以相互组合。如图1所示是本发明实施例提供的一种基于端口能量重塑的虚 拟同步控制方法的流程图，所述方法包括以下步骤：S1：建立基于虚拟同步发电机并入无穷大电网系统的动态模型。在本发明实施例中，步骤S1可以通过以下方式实现：以建立风电场并入无穷大电网为例，所建虚拟同步控制模型如图 2所示，风电场并网模型如图3所示。在新能源场站的虚拟同步电动机 模型，以风机电网侧变流器控制的角度为控制变量，考虑虚拟同步发 电机励磁控制方程和运动微分方程，建立虚拟同步机并入大电网系统 的动态模型的方程，如式所示，各参数如式所示。其中，δ是虚拟同步发电机的功角，ωm和ω分别为虚拟同步发电 机的机械角速度标幺值和电气角速度，H为虚拟同步发电机的惯性时 间常数，Pm和Pe分别为虚拟同步发电机的机械转矩和电磁转矩，D为 虚拟同步发电机的阻尼，Eq’和Efds分别为虚拟同步发电机的交轴暂态 电势和系统稳态运行时励磁电压，uf为励磁电压调节量，Td0’为虚拟 同步发电机的直轴暂态短路时间常数，Xd和Xd’分别为虚拟同步发电 机的直轴稳态电抗和直轴暂态电抗，Us＝1∠0°为无穷大电网电压，XT1为升压变T1电抗，XT2为升压变T2电抗，XL为线路电抗，Xd∑和Xd∑'分 别为稳态等效电抗和暂态等效电抗。图3中，风电场各台风力发电机的额定功率为1.5MW，风机出口 母线电压为575V，经单台额定容量为1.75MW的风机升压变接入25kV 母线，再经输电线路接入额定容量为47MVA的25kV/120kV升压变压 器，最后通过额定容量为2500MVA的限流电抗器接入无穷大电网。 电网频率为60Hz，背靠背装置电容为0.01C，电容参考电压Vdc取1150V， E0取值为155/575V。虚拟同步发电机的阻尼D取5，惯性时间常数H取 5.04，ku取值为0.035。端口受控拟哈密尔顿系统中的参数设置如下： 虚拟同步发电机的直轴暂态短路时间常数Td0’取值为1.5，虚拟同步发 电机的机组直轴电抗Xd和直轴暂态电抗Xd’分别取值为0.5和0.3，25kV 线路电抗XL取值为0.105。S2：根据步骤S1建立的虚拟同步机并入无穷大电网系统的动态 模型，塑造所述虚拟同步机并入无穷大电网系统的动态模型对应的能 量函数，进而建立虚拟同步发电机并入无穷大电网系统对应的哈密尔 顿受控系统数学模型，并进一步推导得到所建立的哈密尔顿受控系统 数学模型的参数，最后校验所建立哈密尔顿受控系统数学模型的零状 态可检测性。在本发明实施例中，步骤S2可以通过以下方式实现：S2.1：根据虚拟同步发电机并入无穷大电网系统的动态模型的方 程，塑造该模型对应的能量函数H，即哈密尔顿函数，并对塑造的 能量函数H进行求导，并参照广义哈密尔顿受控系统模型，建立虚 拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统数学模 型；具体如下：塑造虚拟同步机注入电网的能量函数H，即哈密尔顿函数，如所示，分别将H对状态变量ω，δ，Eq’求偏导，结果如 所示。参照广义哈密尔顿受控系统模型方程：并根据所建立的虚拟同步机并入无穷大电网系统的动态模型方 程和/＞建 立虚拟同步机并入无穷大电网系统对应的哈密尔顿受控系统数学模 型：其中，为状态变量对时间的梯度；J为系统结构矩阵，其为 反对称矩阵；R为系统阻尼矩阵，其为半正定对称矩阵；u和y是共 轭变量，分别表示输入和输出向量；g为输入向量控制矩阵，gT为 其转置矩阵。S2.2：根据步骤S2.1所建立的虚拟同步发电机并入无穷大电网系 统对应的哈密尔顿受控系统数学模型，进一步推导系统阻尼矩阵R 、系统结构矩阵J和输入变量控制矩阵g，从而推导得到所建立的 虚拟同步发电机并入无穷大电网系统对应的哈密尔顿受控系统的数 学模型的具体参数，最后根据推导得到的参数，校验所建立哈密尔顿 受控系统的零状态可检测性，以保证哈密尔顿受控系统在平衡点x0处 渐近稳定。其中，步骤S2.2推导得到所建立的虚拟同步发电机并入无穷大电 网系统对应的哈密尔顿受控系统的数学模型的具体参数的步骤包括：首先由建立的虚拟同步机并入无穷大电网系统对应的哈密尔顿 受控系统数学模型和所建立 的虚拟同步机并入无穷大电网系统的动态模型的方程 /＞求得其系数矩阵：/＞由于R是半正定对称矩阵，满足R＝RT≥0，J为反对称矩 阵，满足J＝-JT，进而推导得到系统阻尼矩阵R、系统结构矩阵 J和输入变量控制矩阵g分别为：最后得到输出方程为：即推导得到了所建立的虚拟同步机并入无穷大电网系统对应的 哈密尔顿受控系统的具体参数；为保证所建立哈密尔顿受控系统在平衡点x0处渐近稳定，所建立 系统必须满足零状态可检测性，得到所建立的虚拟同步机 并入无穷大电网系统对应的哈密尔顿受控系统收敛的最大的不变子 集，如式/＞所示，该不变子集是 该系统的平衡点，因此满足零状态可检测性。S3：根据步骤S2建立的哈密尔顿受控系统数学模型及推导得到 的参数，反推得到使所建立哈密尔顿受控系统数学模型在平衡点x0处渐近稳定的励磁电压调节量对应的控制策略。在本发明实施例中，步骤S3可以通过以下方式实现：对于式所示的非线性受控哈密尔顿系 统，设计控制策略uf满足：/＞中，K为正定矩阵， 可以保证非线性受控哈密尔顿系统在平衡点x0处渐近稳定。进一步可得如式所示的非线性受 控哈密尔顿系统。构造一个非线性受控哈密尔顿系统的李亚普诺夫函 数h，如式h＝H-H所示。由于K为正定矩阵，R为半正定 矩阵，因而h的导数小于等于0，如式所示。当令/＞时，易推得μ＝0，y＝0 。又由系统的零状态可检测性可知在控制率μ的作用下，非线性受控 哈密尔顿系统在平衡点x0处逐渐稳。根据上述原理，存在满足式所示的控制规律，使非线性受控哈密尔顿系统渐进稳定。其中， 模型中的各参数如式所示，Xd和Xd’分别为虚拟 同步发电机的直轴稳态电抗和直轴暂态电抗，Td0’为虚拟同步发电机 的直轴暂态短路时间常数，Xd∑和Xd∑'分别为稳态等效电抗和暂态等 效电抗其中，k1≥0是正定反馈控制比例系数。利用端口受控哈密尔顿原 理，建立的基于端口能量重塑的虚拟同步发电机模型，PCH反馈控制 uf接于虚拟同步发电机的励磁环节输入端，用来实现系统的稳定控。对实施例仿真结果进行分析，当风场的容量为9MW，风场风速为 15m/s，分别在含有VSG控制和无VSG控制的电网模型中进行故障 仿真试验，即在0.1s时输电线路电网侧发生三相接地短路故障，在 0.2s时故障切除。仿真结果分别如图4-5所示。当风电场未采用虚拟 同步发电机控制时，发生三相短路故障后，风电场输出有功功 率发生较大幅度的波动，在1.5s后，风电场输出功率出现频率为6HZ 左右的等幅次同步振荡，有功波动幅值稳定在-1pu到2pu之间，风电 场出口母线电压波动幅值稳定在1.0pu到2.5pu之间，电流波动幅值 稳定在1.0pu到1.5pu之间，分别如图4-6所示，此时风电场无法正 常运行。当风电场采用虚拟同步发电机控制方式时，发生三相 短路故障后，风电场输出有功功率波动幅值较小，1.5s后，输出有功 功率基本稳定在1.0pu左右，风电场出口母线的电压和电流也基未出 现大幅波动，分别如图4-6所示。因此，新能源场站采用虚拟同步发 电机控制方式能够提高电力系统故障扰动时的稳定性。当风场的容量为15MW，风场风速为17m/s，分别在含有VSG控 制和无VSG控制的电网模型中进行与上述同样的故障仿真试验，得到 风场输出有功波动曲线如图7所示。和无VSG控制的风电场输出功率 相比，含VSG控制的风电场输出功率波动幅度大大减小，但依然存在 幅值较小频率为6HZ的稳定功率振荡，即在该工况下VSG控制无法完 全消除短路故障诱发的功率振荡。为了在风电场虚拟同步控制的基础上进一步抑制故障引发的功 率振荡，分别在含有VSG和无PCH控制的电网模型以及有VSG和有 PCH控制的电网模型中，进行如下故障仿真试验，即在0.03s时输电线 路电网侧发生三相接地短路故障，在0.04s时故障切除，仿真结果分别 如图8-10所示。当采用基于端口受控哈密尔顿的虚拟同步发电机控制方式时，故 障1.2s后，系统输出有功功率基本稳定在1.0pu左右，如图8所示，和 无PCH控制方式相比，风电场输出功率振荡得到进一步抑制。稳定后 ，风电场出口母线电压和电流周期性波动基本被消除，分别稳定在 1.0pu和2.0pu左右，如图9-10紫色曲线所示。因此，所提基于端口受 控哈密尔顿的虚拟同步发电控制能够有效抑制系统故障可能引发的 功率振荡，保证系统电压和电流质量。无SVG控制方式或只有SVG控制而无PCH控制方式时，转子转速 都发生较为明显的波动，如图11所示，而采用基于端口受控哈密尔顿 的虚拟同步发电机控制方式，在故障恢复后，转子转速始终保持稳定 ，从而提高了系统的频率质量。此实施例证明了本发明提出的一种基于端口能量重塑的虚拟同 步控制方法的可行性，所提策略能够有效抑制短路故障引起的功率振 荡，改善系统电压和频率质量。需要指出，根据实施的需要，可将本申请中描述的各个步骤/部 件拆分为更多步骤/部件，也可将两个或多个步骤/部件或者步骤/部件 的部分操作组合成新的步骤/部件，以实现本发明的目的。尽管本发明较多地使用了风电场、虚拟同步发电机，端口能量重 塑，端口受控哈密尔顿法，功率振荡等术语，但并不排除使用其它术 语的可能性。使用这些术语仅仅是为了更方便地描述和解释本发明的 本质；把它们解释成任何一种附加的限制都是与本发明精神相违背的。为了本领域的技术人员容易理解，以上所述仅为本发明的较佳实 施例而已，并不用以限制本发明，凡在本发明的精神和原则之内所作 的任何修改、等同替换和改进等，均应包含在本发明的保护范围之内。
