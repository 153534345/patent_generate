标题title
一种多路HDMI协同控制方法及系统
摘要abst
本申请涉及一种多路HDMI协同控制方法及系统，涉及通信技术领域，其方法包括在视频播放器开机时，通过GPIO识别各HDMI电视的HPD信号；基于所述HPD信号判断对应的所述HDMI电视是否接入；对于判定接入的HDMI电视，通过I2C总线读取各个HDMI电视的EDID；基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，基于所述CEC物理地址分别向所述接入的HDMI电视发送开机指令使得所有的HDMI电视开机；所述开机指令为CEC命令。本申请具有便于对视频播放器和多电视组成的多显示系统协同控制的效果。
权利要求书clms
1.一种多路HDMI协同控制方法，其特征在于，包括：在视频播放器开机时，通过GPIO识别各HDMI电视的HPD信号；基于所述HPD信号判断对应的所述HDMI电视是否接入；对于判定接入的HDMI电视，通过I2C总线读取各个HDMI电视的EDID；基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，基于所述CEC物理地址分别向所述接入的HDMI电视发送开机指令使得所有的HDMI电视开机；所述开机指令为CEC命令。2.根据权利要求1所述的一种多路HDMI协同控制方法，其特征在于，在视频播放器开机时，所述方法还包括：实时监测HPD信号以对新接入的HDMI电视进行识别；在识别到新接入的HDMI电视的情况下，读取所述新接入的HDMI电视的EDID；基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，基于所述CEC物理地址向所述新接入的HDMI电视发送开机指令。3.根据权利要求2所述的一种多路HDMI协同控制方法，其特征在于，所述方法还包括：在所述视频播放器关机时，通过GPIO识别各HDMI电视的HPD信号，基于所述HPD信号判断对应的所述HDMI电视是否接入；在判定对应的HDMI电视已经接入的情况下，基于所述CEC物理地址分别向所述接入的HDMI电视发送关机指令使得所有的HDMI电视关机；所述关机指令为CEC命令。4.根据权利要求1所述的一种多路HDMI协同控制方法，其特征在于，所述方法还包括CEC信号响应步骤；所述CEC信号响应步骤包括：实时监测CEC总线是否中断；在接收到HDMI电视发出的CEC命令后，对接收的CEC命令进行识别；以及，根据CEC协议对所述接收的CEC命令进行解析及响应。5.根据权利要求4所述的一种多路HDMI协同控制方法，其特征在于，所述CEC信号响应步骤具体包括：在控制单元上电后，设定HDMI_n HPD中断；设定CEC_n GPIO中断，控制MCU处于运行状态；判断HDMI_n HPD是否中断；如果是，判断HPD是否为高电平；如果HPD为高电平，则判定有新的HDMI电视接入；读取所述新接入的HDMI电视的EDID；基于所述EDID得到新接入的HDMI电视的CEC物理地址；通过对应的GPIO发送开机指令；以及，HDMI_n HPD中断结束；如果HPD不为高电平，则判定HDMI电视接口被拔出；清除HDMI_n相关数据；以及，HDMI_nHPD中断结束。6.根据权利要求5所述的一种多路HDMI协同控制方法，其特征在于，若判定HDMI_n HPD未中断，则判断CEC_n GPIO是否中断；若判定CEC_n GPIO中断，则根据CEC_n高低电平持续时间，确定当前数据位；基于CEC协议将所述数据位组成数据帧；解析数据帧，获取HDMI电视发出的CEC命令；判断所述CEC命令是否需要响应；如果需要响应，组织发送响应数据帧并按数据位发送所述响应数据帧；以及，HDMI_nHPD中断结束；如果不需要响应，则HDMI_n HPD中断结束。7.根据权利要求6所述的一种多路HDMI协同控制方法，其特征在于，若判定CEC_n GPIO未中断，则判断是否接收外部CEC控制命令；如果是，则组织发送响应数据帧，按数据位发送所述响应数据帧。8.一种多路HDMI协同控制系统，其特征在于，包括：第一处理模块，用于：在视频播放器开机时，通过GPIO识别各HDMI电视的HPD信号；第二处理模块，用于：基于所述HPD信号判断对应的所述HDMI电视是否接入；第三处理模块，用于：对于判定接入的HDMI电视，通过I2C总线读取各个HDMI电视的EDID；第四处理模块，用于：基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，第五处理模块，用于：基于所述CEC物理地址分别向所述接入的HDMI电视发送开机指令使得所有的HDMI电视开机；所述开机指令为CEC命令。9.一种计算机设备，其特征在于：包括存储器和服务器，所述存储器上存储有被服务器加载并执行的如权利要求1至7中任一方法的计算机程序。10.一种计算机可读存储介质，其特征在于，存储有能够被服务器加载并执行如权利要求1至7中任一方法的计算机程序。
说明书desc
技术领域本申请涉及通信技术领域，尤其是涉及一种多路HDMI协同控制方法及系统。背景技术现如今广泛应用的智能及非智能设备通常带有多个HDMI端口，用于连接各种设备，例如机顶盒，游戏机，媒体播放器，家庭影院等。视频播放器在连接电视作为显示器时，会产生以下问题：1)系统开机时，需要分别手动或用遥控器打开播放器和电视；2)系统关机时，需要分别手动或用遥控器关闭播放器和电视；3)由于电视通常具有多个显示通道，因此需要手动或用遥控器调整实际连接的显示通道，以显示正确的内容。同时，由于大尺寸电视的普及，视频会议、电子白板等场景越来多采用数个HDMI电视作为内容输出，由此导致视频播放器和多个HDMI电视组成整套系统时，播放器和各电视的开关机变得非常不便；并且，在这些使用场景下，为了避免遥控器丢失或者使用混乱，通常不放置多个遥控器，所以如何针对这些设备，实现协同控制是需要解决的技术难题。发明内容为了便于对视频播放器和多电视组成的多显示系统协同控制，本申请提供了一种多路HDMI协同控制方法及系统。第一方面，本申请提供的一种多路HDMI协同控制方法采用如下的技术方案。一种多路HDMI协同控制方法，包括：在视频播放器开机时，通过GPIO识别各HDMI电视的HPD信号；基于所述HPD信号判断对应的所述HDMI电视是否接入；对于判定接入的HDMI电视，通过I2C总线读取各个HDMI电视的EDID；基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，基于所述CEC物理地址分别向所述接入的HDMI电视发送开机指令使得所有的HDMI电视开机；所述开机指令为CEC命令。通过采用上述技术方案，在视频播放器开机时，处理器通过GPIO识别各HDMI电视的HPD信号；处理器基于所述HPD信号判断对应的所述HDMI电视是否接入；对于判定接入的HDMI电视，处理器通过I2C总线读取各个HDMI电视的EDID；处理器基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；处理器基于所述CEC物理地址分别向所述接入的HDMI电视发送开机指令使得所有的HDMI电视开机，使得所有的HDMI电视同步开启；实现多路HDMI CEC控制器功能，同时完成对多路HDMI电视的开关控制，便于对视频播放器和多电视组成的多显示系统协同控制。可选的，在视频播放器开机时，所述方法还包括：实时监测HPD信号以对新接入的HDMI电视进行识别；在识别到新接入的HDMI电视的情况下，读取所述新接入的HDMI电视的EDID；基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，基于所述CEC物理地址向所述新接入的HDMI电视发送开机指令。可选的，所述方法还包括：在所述视频播放器关机时，通过GPIO识别各HDMI电视的HPD信号，基于所述HPD信号判断对应的所述HDMI电视是否接入；在判定对应的HDMI电视已经接入的情况下，基于所述CEC物理地址分别向所述接入的HDMI电视发送关机指令使得所有的HDMI电视关机；所述关机指令为CEC命令。可选的，所述方法还包括CEC信号响应步骤；所述CEC信号响应步骤包括：实时监测CEC总线是否中断；在接收到HDMI电视发出的CEC命令后，对接收的CEC命令进行识别；以及，根据CEC协议对所述接收的CEC命令进行解析及响应。可选的，所述CEC信号响应步骤具体包括：在控制单元上电后，设定HDMI_n HPD中断；设定CEC_n GPIO中断，控制MCU处于运行状态；判断HDMI_n HPD是否中断；如果是，判断HPD是否为高电平；如果HPD为高电平，则判定有新的HDMI电视接入；读取所述新接入的HDMI电视的EDID；基于所述EDID得到新接入的HDMI电视的CEC物理地址；通过对应的GPIO发送开机指令；以及，HDMI_n HPD中断结束；如果HPD不为高电平，则判定HDMI电视接口被拔出；清除HDMI_n相关数据；以及，HDMI_n HPD中断结束。可选的，若判定HDMI_n HPD未中断，则判断CEC_n GPIO是否中断；若判定CEC_n GPIO中断，则根据CEC_n高低电平持续时间，确定当前数据位；基于CEC协议将所述数据位组成数据帧；解析数据帧，获取HDMI电视发出的CEC命令；判断所述CEC命令是否需要响应；如果需要响应，组织发送响应数据帧并按数据位发送所述响应数据帧；以及，HDMI_n HPD中断结束；如果不需要响应，则HDMI_n HPD中断结束。可选的，若判定CEC_n GPIO未中断，则判断是否接收外部CEC控制命令；如果是，则组织发送响应数据帧，按数据位发送所述响应数据帧。第二方面，本申请提供的一种多路HDMI协同控制系统采用如下的技术方案。一种多路HDMI协同控制系统，包括：第一处理模块，用于：在视频播放器开机时，通过GPIO识别各HDMI电视的HPD信号；第二处理模块，用于：基于所述HPD信号判断对应的所述HDMI电视是否接入；第三处理模块，用于：基于所述HPD信号判断对应的所述HDMI电视是否接入；第四处理模块，用于：基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，第五处理模块，用于：基于所述CEC物理地址分别向所述接入的HDMI电视发送开机指令使得所有的HDMI电视开机；所述开机指令为CEC命令。第三方面，本申请公开一种计算机设备，包括存储器和服务器，所述存储器上存储有被服务器加载并执行上述的任一方法的计算机程序。第四方面，本申请公开一种计算机可读存储介质，存储有能够被服务器加载并执行上述的任一方法的计算机程序。附图说明图1是本申请一种多路HDMI协同控制方法其中一种实施例的流程图；图2是本申请一种多路HDMI协同控制系统其中一种实施例的系统框图；图中，201、第一处理器；202、第二处理器；203、第三处理器；204、第四处理器；205、第五处理器；206、第六处理器；207、第七处理器；208、第八处理器。具体实施方式下面结合附图和具体实施例对本申请作进一步说明：本申请实施例公开一种多路HDMI协同控制方法。参照图1，作为一种多路HDMI协同控制方法的一种实施方式，包括以下步骤：步骤101、在视频播放器开机时，通过GPIO识别各HDMI电视的HPD信号。具体地，GPIO；上述的视频播放器包括但不限于通用计算机、会议编解码终端及机顶盒；HPD是一种从HDMI显示器端生成并传输至HDMI源端的检测信号。HDMI中的Pin 19引脚的功能是检测热插拔，即HPD，Pin 19引脚上传输的信号是判断HDMI源端是否发起EDID读与发送TMDS信号的凭证标准。在视频播放器开机时，处理器通过GPIO识别各HDMI电视的HPD信号。上述的处理器可以是微控制单元或嵌入器控制器。步骤102、基于HPD信号判断对应的HDMI电视是否接入。具体地，处理器基于HPD信号判断对应的HDMI电视是否接入。步骤103、对于判定接入的HDMI电视，通过I2C总线读取各个HDMI电视的EDID。具体地，可以通过I2C总线读取各个HDMI电视的EDID。I2C总线是一种简单、双向二线制同步串行总线；它只需要两根线即可在连接于总线上的器件之间传送信息。上述的EDID中包含有关显示器及其性能的参数，包括供应商信息、最大图像大小、颜色设置、厂商预设置、频率范围的限制以及显示器名和序列号的字符串等。步骤104、基于EDID得到对应的HDMI电视的CEC物理地址并通过GPIO模拟HDMI电视的CEC总线控制器。具体地，处理器通过I2C总线读取各个HDMI电视的EDID以确认其CEC物理地址；所有CEC设备都有一个物理地址和逻辑地址，物理地址可以通过EDID来识别，此后处理器通过GPIO模拟每个HDMI电视的CEC总线控制器，每根CEC总线遵从《CEC规范》中的数据位逻辑和数据帧；进而能够通过处理器直接同步控制所有的HDMI电视。步骤105、基于CEC物理地址分别向接入的HDMI电视发送开机指令使得所有的HDMI电视开机。开机指令为CEC命令。具体地，CEC。处理器同步向多个HDMI电视发送开机指令使得所有的HDMI电视同步开启，开机指令可以是发送CEC ＜Image View On＞和＜Active Source＞使得HDMI电视开机，发送＜Standby＞命令使得HDMI电视待机。在本申请中，通过微控制单元或嵌入器控制器执行上述控制方法，实现多路HDMI CEC控制器功能，同时完成对多路HDMI电视的开关控制。本申请在单一控制芯片上实现了多路HDMI CEC，降低了制造成本；同时集约化控制减少了电路板面积，便于多路HDMI CEC功能在小型物联网系统中的普及。作为一种多路HDMI协同控制方法的其中一种实施方式，在视频播放器开机时，该方法还包括：实时监测HPD信号以对新接入的HDMI电视进行识别；在识别到新接入的HDMI电视的情况下，读取新接入的HDMI电视的EDID；基于EDID得到对应的HDMI电视的CEC物理地址并通过GPIO模拟HDMI电视的CEC总线控制器；以及，基于CEC物理地址向新接入的HDMI电视发送开机指令。具体地，为了便于对新接入的HDMI电视进行同步控制，在视频播放器开机时，处理器实时监测HPD信号以对新接入的HDMI电视进行识别，进而能够在接入新的HDMI电视的情况下，读取新接入的HDMI电视的EDID，进而能够基于CEC物理地址向新接入的HDMI电视发送开机指令，进而能够使得新接入的HDMI电视同步开机。作为一种多路HDMI协同控制方法的其中一种实施方式，该方法还包括：在视频播放器关机时，通过GPIO识别各HDMI电视的HPD信号，基于HPD信号判断对应的HDMI电视是否接入；在判定对应的HDMI电视已经接入的情况下，基于CEC物理地址分别向接入的HDMI电视发送关机指令使得所有的HDMI电视关机；关机指令为CEC命令。具体地，通过上述设置，处理器能够同步使得接入的所有HDMI电视同步关机，进而无需人工多次分别控制每个HDMI电视关机，便于用户进行操作。作为一种多路HDMI协同控制方法的其中一种实施方式，该方法还包括CEC信号响应步骤；CEC信号响应步骤包括：实时监测CEC总线是否中断；在接收到HDMI电视发出的CEC命令后，对接收的CEC命令进行识别；以及，根据CEC协议对接收的CEC命令进行解析及响应。作为一种多路HDMI协同控制方法的其中一种实施方式，CEC信号响应步骤具体包括：在控制单元上电后，设定HDMI_n HPD中断；设定CEC_n GPIO中断，控制MCU处于运行状态；判断HDMI_n HPD是否中断；如果是，判断HPD是否为高电平；如果HPD为高电平，则判定有新的HDMI电视接入；读取新接入的HDMI电视的EDID；基于EDID得到新接入的HDMI电视的CEC物理地址；通过对应的GPIO发送开机指令；以及，HDMI_n HPD中断结束；如果HPD不为高电平，则判定HDMI电视接口被拔出；清除HDMI_n相关数据；以及，HDMI_n HPD中断结束。作为一种多路HDMI协同控制方法的其中一种实施方式，若判定HDMI_n HPD未中断，则判断CEC_n GPIO是否中断；若判定CEC_n GPIO中断，则根据CEC_n高低电平持续时间，确定当前数据位；基于CEC协议将数据位组成数据帧；解析数据帧，获取HDMI电视发出的CEC命令；判断CEC命令是否需要响应；如果需要响应，组织发送响应数据帧并按数据位发送响应数据帧；以及，HDMI_nHPD中断结束；如果不需要响应，则HDMI_n HPD中断结束。作为一种多路HDMI协同控制方法的其中一种实施方式，若判定CEC_n GPIO未中断，则判断是否接收外部CEC控制命令；如果是，则组织发送响应数据帧，按数据位发送响应数据帧。综上，本申请利用微控制单元或嵌入器控制器，通过GPIO实现多路CEC控制器，遵从CEC协议传输规范；各路CEC控制器分别对应独立的HDMI输出口，以正确识别与其连接的电视的HDMI物理地址 ，并发送、接收和响应相关CEC命令；同时，支持电视的热拔插，即视频播放器开机状态下后接入电视，依然可以实现CEC开关机控制;开放软硬件对外接口，方便应用层调用该接口实现对电视的实时控制。参照图2，本申请还提供了一种多路HDMI协同控制系统，作为一种多路HDMI协同控制系统其中一种实施方式，该系统包括：第一处理模块201，用于：在视频播放器开机时，通过GPIO识别各HDMI电视的HPD信号；第二处理模块202，用于：基于HPD信号判断对应的HDMI电视是否接入；第三处理模块203，用于：对于判定接入的HDMI电视，通过I2C总线读取各个HDMI电视的EDID；第四处理模块204，用于：基于EDID得到对应的HDMI电视的CEC物理地址并通过GPIO模拟HDMI电视的CEC总线控制器；以及，第五处理模块205，用于：基于CEC物理地址分别向接入的HDMI电视发送开机指令使得所有的HDMI电视开机；开机指令为CEC命令。继续参照图2，作为一种多路HDMI协同控制系统其中一种实施方式，该系统还包括第六处理模块206，第六处理模块206用于在视频播放器开机时，实时监测HPD信号以对新接入的HDMI电视进行识别；在识别到新接入的HDMI电视的情况下，读取所述新接入的HDMI电视的EDID；基于所述EDID得到对应的HDMI电视的CEC物理地址并通过所述GPIO模拟所述HDMI电视的CEC总线控制器；以及，基于所述CEC物理地址向所述新接入的HDMI电视发送开机指令。继续参照图2，作为一种多路HDMI协同控制系统其中一种实施方式，该系统还包括第七处理模块207，第七处理模块207用于：在所述视频播放器关机时，通过GPIO识别各HDMI电视的HPD信号，基于所述HPD信号判断对应的所述HDMI电视是否接入；在判定对应的HDMI电视已经接入的情况下，基于所述CEC物理地址分别向所述接入的HDMI电视发送关机指令使得所有的HDMI电视关机；所述关机指令为CEC命令。继续参照图2，作为一种多路HDMI协同控制系统其中一种实施方式，该系统还包括第八处理模块208，第八处理模块208用于执行CEC信号响应步骤；所述CEC信号响应步骤包括：实时监测CEC总线是否中断；在接收到HDMI电视发出的CEC命令后，对接收的CEC命令进行识别；以及，根据CEC协议对所述接收的CEC命令进行解析及响应。CEC信号响应步骤的具体方式与上述方法相同，在此不进行赘述。本申请实施例还公开一种电子设备。具体来说，该设备包括存储器和服务器，存储器上存储有能够被服务器加载并执行上述任意一种多路HDMI协同控制方法的计算机程序。本申请实施例还公开一种计算机可读存储介质。具体来说，该计算机可读存储介质，其存储有能够被服务器加载并执行如上述任意一种多路HDMI协同控制方法的计算机程序，该计算机可读存储介质例如包括：U盘、移动硬盘、只读存储器、随机存取存储器、磁碟或者光盘等各种可以存储程序代码的介质。需要说明的是：以上实施例仅用于说明本申请而并非限制本申请所描述的技术方案，尽管本说明书参照上述的实施例对本申请已进行了详细的说明，但是，本领域的普通技术人员应当理解，所属技术领域的技术人员仍然可以对本申请进行修改或者等同替换，而一切不脱离本申请的精神和范围的技术方案及其改进，均应涵盖在本申请的权利要求范围内。
