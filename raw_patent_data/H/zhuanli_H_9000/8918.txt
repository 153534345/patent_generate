标题title
攻击侦测方法及其系统、车辆、计算机可读存储介质
摘要abst
本申请公开了一种攻击侦测方法及其系统、车辆、计算机可读存储介质，其中，方法包括：基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；定时获取所述报文数据库中的待处理报文协议头数据；基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。本申请通过上传攻击事件降低了安全威胁分析过程中车辆上报的数据量，有效避免了车辆带宽资源的浪费，提高了车辆进行以太网攻击检测的准确性以及效率。
权利要求书clms
1.一种攻击侦测方法，其特征在于，所述攻击侦测方法包括以下步骤：基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；定时获取所述报文数据库中的待处理报文协议头数据；基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。2.如权利要求1所述的攻击侦测方法，其特征在于，所述基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库的步骤包括：对所述待检测报文进行报文解析，以获得所述待检测报文对应的待筛选报文协议头数据；若待筛选报文协议头数据与所述预设协议分析规则对应的协议数据匹配，则将所述待筛选报文协议头数据作为所述报文协议头数据。3.如权利要求1所述的攻击侦测方法，其特征在于，所述基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据的步骤包括：获取各个待处理报文协议头数据中的特征信息；确定所述特征信息是否满足预设攻击特征信息对应的预设条件，其中，若满足所述预设条件，则确定所述待处理报文协议头数据中存在目标报文协议头数据。4.如权利要求1所述的攻击侦测方法，其特征在于，所述若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件的步骤包括：若存在目标报文协议头数据，则获取所述目标报文协议头数据对应的特征信息，并基于所述特征信息确定所述攻击事件。5.如权利要求1所述的攻击侦测方法，其特征在于，所述将所述攻击事件上传至VSOC平台的步骤包括：确定抑制列表中是否存在所述攻击事件；若所述抑制列表中不存在所述攻击事件，则将所述攻击事件上传至VSOC平台，并将所述攻击事件添加至所述抑制列表。6.如权利要求5所述的攻击侦测方法，其特征在于，所述攻击侦测方法还包括：实时确定所述抑制列表中的各个攻击事件中，是否存在超时的目标攻击事件；若所述抑制列表中存在所述目标攻击事件，则在所述抑制列表中删除所述目标攻击事件。7.如权利要求1所述的攻击侦测方法，其特征在于，所述攻击侦测方法还包括：实时确定所述报文数据库的各个报文协议头数据中，是否存在超时的待删除报文协议头数据；若存在所述待删除报文协议头数据，则在所述报文数据库中删除所述待删除报文协议头数据。8.如权利要求1至7任一项所述的攻击侦测方法，其特征在于，所述攻击侦测方法还包括：在检测到云服务器发送的预设协议分析规则对应的第一更新指令时，从所述云服务器获取所述第一更新指令对应的待更新协议分析规则，并基于所述待更新协议分析规则更新所述预设协议分析规则；或者，在检测到云服务器发送的攻击特征数据库对应的第二更新指令时，从所述云服务器获取所述第二更新指令对应的待更新攻击特征信息，并基于所述待更新攻击特征信息更新所述攻击特征数据库。9.一种攻击侦测系统，其特征在于，所述攻击侦测系统包括：报文数据库、VSOC平台以及车辆，所述车辆包括应用模块以及内核模块，其中，所述内核模块分别与所述报文数据库以及所述应用模块通信连接，用于基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；所述应用模块用于定时获取所述报文数据库中的待处理报文协议头数据；所述应用模块用于基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；所述应用模块用于若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。10.一种车辆，其特征在于，所述车辆包括应用模块以及与所述应用模块通信连接的内核模块，其中，所述内核模块用于基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；所述应用模块用于定时获取所述报文数据库中的待处理报文协议头数据；所述应用模块用于基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；所述应用模块用于若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。11.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质上存储有攻击侦测程序，所述攻击侦测程序被处理器执行时实现如权利要求1至8中任一项所述的攻击侦测方法的步骤。
说明书desc
技术领域本申请涉及车辆信息安全技术领域，尤其涉及一种攻击侦测方法及其系统、车辆、计算机可读存储介质。背景技术智能化促进了汽车内部电控单元数量的不断增加，网联化的升级增加了车载信息与外界的互联互通，使得车载以太网的数据量大大提升，导致智能网联汽车信息安全风险不断增加，车辆信息及用户隐私面临着巨大的安全考验。智能网联汽车信息安全问题在给用户带来隐私泄漏、财产损失的同时，也会造成人身伤害，甚至引发公共安全问题。目前，由于车辆硬件性能的限制，现有的攻击侦测策略都是考虑在本机搜集满足一定特征码的报文数据，然后上传到云平台，云平台对报文数据进行攻击侦测，得出分析结论，这种方式需要上传大量的报文数据，造成车辆带宽资源的浪费。上述内容仅用于辅助理解本申请的技术方案，并不代表承认上述内容是现有技术。发明内容本申请的主要目的在于提供一种攻击侦测方法及其系统、车辆、计算机可读存储介质，旨在解决现有车辆攻击检测的方式导致车辆带宽资源的浪费的技术问题。为实现上述目的，提供一种攻击侦测方法，所述攻击侦测方法包括以下步骤：基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；定时获取所述报文数据库中的待处理报文协议头数据；基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。进一步地，所述基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库的步骤包括：对所述待检测报文进行报文解析，以获得所述待检测报文对应的待筛选报文协议头数据；若待筛选报文协议头数据与所述预设协议分析规则对应的协议数据匹配，则将所述待筛选报文协议头数据作为所述报文协议头数据。进一步地，所述基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据的步骤包括：获取各个待处理报文协议头数据中的特征信息；确定所述特征信息是否满足预设攻击特征信息对应的预设条件，其中，若满足所述预设条件，则确定所述待处理报文协议头数据中存在目标报文协议头数据。进一步地，所述若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件的步骤包括：若存在目标报文协议头数据，则获取所述目标报文协议头数据对应的特征信息，并基于所述特征信息确定所述攻击事件。进一步地，所述将所述攻击事件上传至VSOC平台的步骤包括：确定抑制列表中是否存在所述攻击事件；若所述抑制列表中不存在所述攻击事件，则将所述攻击事件上传至VSOC平台，并将所述攻击事件添加至所述抑制列表。进一步地，所述攻击侦测方法还包括：实时确定所述抑制列表中的各个攻击事件中，是否存在超时的目标攻击事件；若所述抑制列表中存在所述目标攻击事件，则在所述抑制列表中删除所述目标攻击事件。进一步地，所述攻击侦测方法还包括：实时确定所述报文数据库的各个报文协议头数据中，是否存在超时的待删除报文协议头数据；若存在所述待删除报文协议头数据，则在所述报文数据库中删除所述待删除报文协议头数据。进一步地，所述攻击侦测方法还包括：在检测到云服务器发送的预设协议分析规则对应的第一更新指令时，从所述云服务器获取所述第一更新指令对应的待更新协议分析规则，并基于所述待更新协议分析规则更新所述预设协议分析规则；或者，在检测到云服务器发送的攻击特征数据库对应的第二更新指令时，从所述云服务器获取所述第二更新指令对应的待更新攻击特征信息，并基于所述待更新攻击特征信息更新所述攻击特征数据库。此外，为实现上述目的，还提供一种攻击侦测系统，所述攻击侦测系统包括：报文数据库、VSOC平台以及车辆，所述车辆包括应用模块以及内核模块，其中，所述内核模块分别与所述报文数据库以及所述应用模块通信连接，用于基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；所述应用模块用于定时获取所述报文数据库中的待处理报文协议头数据；所述应用模块用于基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；所述应用模块用于若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。此外，为实现上述目的，还提供一种车辆，所述车辆包括应用模块以及与所述应用模块通信连接的内核模块，其中，所述内核模块用于基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；所述应用模块用于定时获取所述报文数据库中的待处理报文协议头数据；所述应用模块用于基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；所述应用模块用于若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。此外，为实现上述目的，还提供一种计算机可读存储介质，所述可读存储介质上存储有攻击侦测程序，所述攻击侦测程序被处理器执行时实现如上所述的攻击侦测方法的步骤。本申请通过基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；接着定时获取所述报文数据库中的待处理报文协议头数据；而后基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；最后若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台，能够根据报文的协议头数据实现车辆的安全威胁分析，并通过在监测到攻击事件时仅上传攻击事件，降低了安全威胁分析过程中车辆上报的数据量，有效避免了车辆带宽资源的浪费，提高了车辆进行以太网攻击检测的准确性以及效率。附图说明图1是本申请实施例方案涉及的硬件运行环境中攻击侦测装置的结构示意图；图2为本申请攻击侦测方法第一实施例的流程示意图；图3为本申请攻击侦测系统一实施例的结构示意图；图4为本申请车辆一实施例的结构示意图。本申请目的的实现、功能特点及优点将结合实施例，参照附图做进一步说明。具体实施方式应当理解，此处所描述的具体实施例仅仅用以解释本申请，并不用于限定本申请。如图1所示，图1是本申请实施例方案涉及的硬件运行环境中攻击侦测装置的结构示意图。本申请实施例攻击侦测装置可以是车辆，或者设置在车辆中的攻击侦测设备，如图1所示，该攻击侦测装置可以包括：处理器1001，例如CPU，网络接口1004，用户接口1003，存储器1005，通信总线1002。其中，通信总线1002用于实现这些组件之间的连接通信。用户接口1003可以包括显示屏、输入单元比如键盘，可选用户接口1003还可以包括标准的有线接口、无线接口。网络接口1004可选的可以包括标准的有线接口、无线接口。存储器1005可以是高速RAM存储器，也可以是稳定的存储器，例如磁盘存储器。存储器1005可选的还可以是独立于前述处理器1001的存储装置。可选地，攻击侦测装置还可以包括摄像头、RF电路，传感器、音频电路、WiFi模块等等。其中，传感器比如光传感器、运动传感器以及其他传感器，在此不再赘述。本领域技术人员可以理解，图1中示出的终端结构并不构成对攻击侦测装置的限定，可以包括比图示更多或更少的部件，或者组合某些部件，或者不同的部件布置。如图1所示，作为一种计算机存储介质的存储器1005中可以包括操作系统、网络通信模块、用户接口模块以及攻击侦测程序。在图1所示的攻击侦测装置中，网络接口1004主要用于连接后台服务器，与后台服务器进行数据通信；用户接口1003主要用于连接客户端，与客户端进行数据通信；而处理器1001可以用于调用存储器1005中存储的攻击侦测程序。在本实施例中，攻击侦测装置包括：存储器1005、处理器1001及存储在所述存储器1005上并可在所述处理器1001上运行的攻击侦测程序，其中，处理器1001调用存储器1005中存储的攻击侦测程序时，执行以下各个实施例中攻击侦测方法的步骤。本申请还提供一种攻击侦测方法，参照图2，图2为本申请攻击侦测方法第一实施例的流程示意图。该攻击侦测方法包括：步骤S101，基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；待检测报文可以为车辆的网关或者TBOX所接收到的以太网报文，为提高车辆的攻击侦测效率，对车辆所接收到的待检测报文进行实时处理，基于预设协议分析规则确定待检测报文对应的报文协议头数据，具体地，车辆的攻击侦测装置获取待检测报文的待筛选报文协议头数据，将待筛选报文协议头数据与预设协议分析规则中的协议数据进行匹配，若待筛选报文协议头数据与协议数据匹配，则攻击侦测装置确定该待筛选报文协议头数据为报文协议头数据，然后攻击侦测装置将报文协议头数据挂载至报文数据库，若待筛选报文协议头数据与协议数据不匹配，则结束流程。需要说明的是，车辆在首次与云服务器建立通信连接时，云服务器将该车辆对应的预设协议分析规则下发至该车辆，车辆存储接收到的预设协议分析规则的协议数据可包括二层协议：DMAC+SMAC+*VLAN；三层协议：DMAC+SMAC+*VLAN+IPHDR/ARP/RAW；四层协议：DMAC+SMAC+*VLAN+IPHDR+TCPHDR/UDPHDR；应用协议1：DMAC+SMAC+*VLAN+IPHDR+TCPHDR+HTTP/FTP/RTSP/SIP；以及应用协议2：DMAC+SMAC+*VLAN+IPHDR+TCPHDR+TFTP/Game。其中应用协议可以根据具体的应用确定协议头。步骤S102，定时获取所述报文数据库中的待处理报文协议头数据；攻击侦测装置定时进行攻击侦测，即定时获取所述报文数据库中的待处理报文协议头数据，其中，待处理报文协议头数据为报文数据库中的所有报文协议头数据，定时获取待处理报文协议头数据的时间间隔可以进行合理设置，例如，该时间间隔可以设置为10秒。步骤S103，基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；在获取到待处理报文协议头数据时，攻击侦测装置获取攻击特征数据库中的预设攻击特征信息，并基于预设攻击特征信息确定待处理报文协议头数据中是否存在目标报文协议头数据，具体地，预设攻击特征信息包括各种攻击类型对应的攻击特征信息，攻击侦测装置可获取各个待处理报文协议头数据的特征信息，根据特征信息确定各个待处理报文协议头数据是否满足各个攻击类型对应的攻击特征信息，得到满足各个攻击类型对应的攻击特征信息的报文协议头数据，对于每一个攻击类型，攻击侦测装置对其攻击特征信息对应的报文协议头数据进行统计，得到各个攻击特征信息对应的报文数量，若该报文数量满足该攻击特征信息对应的攻击条件，则确定当前存在该目标攻击类型，该目标攻击类型对应的报文协议头数据即为目标报文协议头数据，即当前存在目标报文协议头数据。步骤S104，若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。若存在目标报文协议头数据，则攻击侦测装置基于所述目标报文协议头数据确定攻击事件，具体地，攻击事件包括目标攻击类型对应的攻击事件，然后将攻击事件上传至VSOC平台，以在VSOC平台展示该攻击事件，其中，攻击事件的显示信息包括攻击类型、攻击特征信息以及报文协议头数据的数量等。其中，攻击事件的攻击行为包括：ICMP主机存活探测，UDP主机存活探测，TCP NULL端口扫描，TCP SYN端口扫描，ACK端口扫描，UDP端口扫描，Ping of death，Large ping，ICMP-Echo flooding，ICMP flood，ICMP-Smurf attack，UDPflood，ACK Flood，Non-spoofed UDP flood，DNS-Query flooding，TCP Syn Flood，TCPSyn-Ack flood，DNS flood等。需要说明的是，在将攻击事件上传至VSOC平台时，还可以上传该攻击事件所对应的报文或报文协议头数据，通过VSOC平台对攻击事件所对应的报文或报文协议头数据进行二次攻击侦测，以进一步确保攻击侦测的准确性。具体地，步骤S104包括：若存在目标报文协议头数据，则获取所述目标报文协议头数据对应的特征信息，并基于所述特征信息确定所述攻击事件。在确定待处理报文协议头数据中存在目标报文协议头数据，获取获取所述目标报文协议头数据对应的特征信息，并基于特征信息确定攻击事件，具体地，通过与该目标报文协议头数据的特征信息匹配的预设攻击特征信息所对应的攻击类型、匹配的预设攻击特征信息以及目标报文协议头数据的数量确定攻击事件，对于每一个攻击事件，该攻击事件可包括攻击类型、攻击特征信息以及报文协议头数据的数量等。进而可准确确定攻击事件，便于VSOC平台显示该攻击事件。进一步地，该攻击侦测方法还包括：步骤a，在检测到云服务器发送的预设协议分析规则对应的第一更新指令时，从所述云服务器获取所述第一更新指令对应的待更新协议分析规则，并基于所述待更新协议分析规则更新所述预设协议分析规则；或者，步骤b，在检测到云服务器发送的攻击特征数据库对应的第二更新指令时，从所述云服务器获取所述第二更新指令对应的待更新攻击特征信息，并基于所述待更新攻击特征信息更新所述攻击特征数据库。随着车辆的攻击侦测，云服务器会接收到大量的攻击事件，为提高攻击事件的侦测准确性，可以在云服务器更新预设协议分析规则和/或的攻击特征数据库中的攻击特征信息，例如由管理人员根据当前VSOC平台接收到的攻击事件进行预设协议分析规则和/或的攻击特征数据库中的攻击特征信息的更新，在每次进行预设协议分析规则和/或的攻击特征数据库中的攻击特征信息的更新时，云服务器会发生更新指令至其所对应的各个车辆。在检测到云服务器发送的预设协议分析规则对应的第一更新指令时，攻击侦测装置从云服务器获取所述第一更新指令对应的待更新协议分析规则，并基于所述待更新协议分析规则更新所述预设协议分析规则，也就是说，攻击侦测装置仅需要下载当前需要进行更新的协议分析规则进行更新，而无需下载所有的协议分析规则，进而实现协议数据的灵活配置以及实时动态远程更新，进而能够为攻击侦测提供更加全面的协议分析规则。在检测到云服务器发送的攻击特征数据库对应的第二更新指令时，从云服务器获取所述第二更新指令对应的待更新攻击特征信息，并基于待更新攻击特征信息更新所述攻击特征数据库，也就是说，攻击侦测装置仅需要下载当前需要进行更新的攻击特征信息进行更新，而无需下载所有的攻击特征信息，进而实现攻击特征信息的灵活配置以及实时动态远程更新，进而能够为攻击侦测提供更加全面的攻击特征信息。通过基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；接着定时获取所述报文数据库中的待处理报文协议头数据；而后基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；最后若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台，能够根据报文的协议头数据实现车辆的安全威胁分析，并通过在监测到攻击事件时仅上传攻击事件，降低了安全威胁分析过程中车辆上报的数据量，有效避免了车辆带宽资源的浪费，提高了车辆进行以太网攻击检测的准确性以及效率。基于第一实施例，提出本申请攻击侦测方法的第二实施例，包括第一实施例的全部内容，其中，步骤S101包括：步骤S201，对所述待检测报文进行报文解析，以获得所述待检测报文对应的待筛选报文协议头数据；步骤S202，若待筛选报文协议头数据与所述预设协议分析规则对应的协议数据匹配，则将所述待筛选报文协议头数据作为所述报文协议头数据。在获取到待检测报文时，攻击侦测装置对待检测报文进行报文解析，以获得待检测报文对应的待筛选报文协议头数据，接着，攻击侦测装置将待筛选报文协议头数据与预设协议分析规则中的协议数据进行匹配，若待筛选报文协议头数据与预设协议分析规则对应的协议数据匹配，例如，预设协议分析规则对应的协议数据存在该待筛选报文协议头数据，则攻击侦测装置确定该待筛选报文协议头数据为报文协议头数据，然后攻击侦测装置将报文协议头数据挂载至报文数据库，若待筛选报文协议头数据与协议数据不匹配，则结束流程。需要说明的是，为提高攻击侦测效率，上述步骤S201以及步骤S202均可通过车辆的kernel内核进行处理。即，通过kernel内核对所述待检测报文进行报文解析，以获得所述待检测报文对应的待筛选报文协议头数据，通过kernel内核获取预设协议分析规则对应的协议数据，并通过通过kernel内核确定待筛选报文协议头数据与所述预设协议分析规则对应的协议数据是否匹配，若待筛选报文协议头数据与所述预设协议分析规则对应的协议数据匹配，则通过kernel内核将所述待筛选报文协议头数据作为所述报文协议头数据，而后，通过kernel内核先通过netlink将报文协议头数据发生到攻击侦测装置对应的应用程序，由应用程序执行后续的流程。其中，kernel内核通过注册netfilter的PRE_ROUTING的rx_hook对待检测报文进行报文解析。通过对所述待检测报文进行报文解析，以获得所述待检测报文对应的待筛选报文协议头数据；接着若待筛选报文协议头数据与所述预设协议分析规则对应的协议数据匹配，则将所述待筛选报文协议头数据作为所述报文协议头数据，能够通过预设协议分析规则对应的协议数据实现待检测报文的首次筛选，进而提高了车辆进行以太网攻击检测的准确性以及效率。基于第一实施例，提出本申请攻击侦测方法的第三实施例，包括第一实施例的全部内容，其中，步骤S102包括：步骤S301，获取各个待处理报文协议头数据中的特征信息；步骤S302，确定所述特征信息是否满足预设攻击特征信息对应的预设条件，其中，若满足所述预设条件，则确定所述待处理报文协议头数据中存在目标报文协议头数据。在获取到报文数据库中的待处理报文协议头数据时，攻击侦测装置获取各个待处理报文协议头数据中的特征信息以及攻击特征数据库中的预设攻击特征信息。接着，确定特征信息是否满足预设攻击特征信息对应的预设条件，预设攻击特征信息包括各种攻击类型对应的攻击特征信息，攻击侦测装置可根据特征信息确定各个待处理报文协议头数据是否满足各个攻击类型对应的攻击特征信息，得到满足各个攻击类型对应的攻击特征信息的报文协议头数据，对于每一个攻击类型，攻击侦测装置对其攻击特征信息对应的报文协议头数据进行统计，得到各个攻击特征信息对应的报文数量，若该报文数量满足该攻击特征信息对应的攻击条件，则报文协议头数据对应的特征信息确定预设条件，进而确定待处理报文协议头数据中存在目标报文协议头数据，其中目标报文协议头数据包括该目标攻击类型对应的报文协议头数据。需要说明的是，预设攻击特征信息所对应的攻击类型包括ICMP flood1、UDPflood、TCP Syn Flood、DNS flood以及ARP flood。其中，ICMP flood1对应的攻击特征信息包括：报文协议头数据中存在异常的ICMPheader以及异常的ICMP data的第一异常报文协议头数据，第一异常报文协议头数据对应的源IP地址满足预设规律，且第一异常报文协议头数据对应的连续报文的数量大于第一预设数量例如100个。UDP flood对应的攻击特征信息包括：报文协议头数据中存在异常的UDP header以及异常的UDP data的第二异常报文协议头数据，第二异常报文协议头数据对应的源IP地址满足预设规律，且第二异常报文协议头数据对应的连续报文的数量大于第二预设数量例如400个。TCP Syn Flood对应的攻击特征信息包括：报文协议头数据中存在异常的TCPheader、异常的TCP data以及异常的TCP flag的第三异常报文协议头数据，第三异常报文协议头数据对应的源IP地址满足预设规律，且第三异常报文协议头数据对应的连续报文的数量大于第三预设数量例如100个。DNS flood对应的攻击特征信息包括：报文协议头数据中存在异常的UDP header以及异常的UDP data的第四异常报文协议头数据，第四异常报文协议头数据对应的源IP地址满足预设规律，且第四异常报文协议头数据对应的连续报文的数量大于第三预设数量例如200个。ARP flood对应的攻击特征信息包括：报文协议头数据中存在异常的ARP header以及异常的ARP data的第五异常报文协议头数据，第五异常报文协议头数据对应的MAC地址满足预设规律，且第五异常报文协议头数据对应的连续报文的数量大于第三预设数量例如200个。通过获取各个待处理报文协议头数据中的特征信息；接着确定所述特征信息是否满足预设攻击特征信息对应的预设条件，其中，若满足所述预设条件，则确定所述待处理报文协议头数据中存在目标报文协议头数据，能够根据报文协议头数据中的特征信息准确确定目标报文协议头数据，进一步提高了车辆进行以太网攻击检测的准确性以及效率。基于第一实施例，提出本申请攻击侦测方法的第四实施例，包括第一实施例的全部内容，其中，步骤S104包括：步骤S401，确定抑制列表中是否存在所述攻击事件；步骤S402，若所述抑制列表中不存在所述攻击事件，则将所述攻击事件上传至VSOC平台，并将所述攻击事件添加至所述抑制列表。为避免同一车辆中存在短时间内攻击事件的频繁上报，预设在攻击侦测装置中设置一抑制列表，该攻击侦测中保持当前已经上报至VSOC平台的攻击事件。在获取到攻击事件时，攻击侦测装置确定抑制列表中是否存在所述攻击事件，若存在该攻击事件，则确定当前时刻之前该攻击事件已上报至VSOC平台，进而无需再次上报高攻击事件。若抑制列表中不存在所述攻击事件，则将所述攻击事件上传至VSOC平台，并将攻击事件添加至抑制列表，以避免在短期内频繁上报该攻击事件。需要说明的是，在获取到攻击事件时，可先将攻击事件加入事件列表，然后遍历事件列表得到待发送攻击事件，确定抑制列表中是否存在待发送攻击事件；若不存在，则将待发送攻击事件上传至VSOC平台，并将待发送攻击事件添加至所述抑制列表，同时清空事件列表。进一步地，该攻击侦测方法还包括：步骤S403，实时确定所述抑制列表中的各个攻击事件中，是否存在超时的目标攻击事件；步骤S404，若所述抑制列表中存在所述目标攻击事件，则在所述抑制列表中删除所述目标攻击事件。其中，在抑制列表添加攻击事件时，预设设置该攻击事件对应的超时信息，例如，超时信息可以为一个上电周期内或者24h等超时时刻。实时确定抑制列表中的各个攻击事件中是否存在超时的目标攻击事件，例如超时信息为一个上电周期内，则确定抑制列表中的各个攻击事件是否存在车辆上一个上电周期的攻击事件，若存在，则将车辆上一个上电周期的攻击事件作为目标攻击事件，若超时信息为超时时刻，则确定抑制列表的各个攻击事件中是否存在达到超时时刻的攻击事件，若存在，则将达到超时时刻的攻击事件作为目标攻击事件。并在所述抑制列表中删除所述目标攻击事件。进而可及时删除抑制列表超时的攻击事件，实现攻击事件的准确上报。通过确定抑制列表中是否存在所述攻击事件；接着若所述抑制列表中不存在所述攻击事件，则将所述攻击事件上传至VSOC平台，并将所述攻击事件添加至所述抑制列表，通过抑制列表能够避免在短期内频繁上报该攻击事件，进而有效避免短期内VSOC平台接收大量相同的攻击事件而浪费VSOC平台的系统资源。基于第一实施例，提出本申请攻击侦测方法的第五实施例，包括第一实施例的全部内容，其中，攻击侦测方法还包括：步骤S501，实时确定所述报文数据库的各个报文协议头数据中，是否存在超时的待删除报文协议头数据；步骤S502，若存在所述待删除报文协议头数据，则在所述报文数据库中删除所述待删除报文协议头数据。在将报文协议头数据上传至报文数据库时，设置报文协议头数据的报文超时时刻，并实时确定所述报文数据库的各个报文协议头数据中，是否存在超时的待删除报文协议头数据，具体地，确定报文数据库的各个报文协议头数据中是否存在达到报文超时时刻的报文协议头数据，若存在，则确定存在待删除报文协议头数据，该待删除报文协议头数据即为达到报文超时时刻的报文协议头数据。接着，若存在待删除报文协议头数据，则在所述报文数据库中删除待删除报文协议头数据，进而实现报文数据库中报文协议头数据的及时删除，进一步降低攻击侦测的数据量。通过实时确定所述报文数据库的各个报文协议头数据中，是否存在超时的待删除报文协议头数据；接着若存在所述待删除报文协议头数据，则在所述报文数据库中删除所述待删除报文协议头数据，进而实现报文数据库中报文协议头数据的及时删除，降低攻击侦测的数据量，进一步提高了车辆进行以太网攻击检测的准确性以及效率。此外，本申请实施例还提出一种攻击侦测系统100，所述攻击侦测系统包括：报文数据库110、VSOC平台120以及车辆130，车辆130包括应用模块131以及内核模块132，其中，所述内核模块132分别与所述报文数据库110以及所述应用模块131通信连接，用于基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；所述应用模块131用于定时获取所述报文数据库中的待处理报文协议头数据；所述应用模块131用于基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；所述应用模块131用于若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。其中，内核模块为车辆的kernel内核，应用模块为应用程序。进一步地，所述内核模块132还用于：对所述待检测报文进行报文解析，以获得所述待检测报文对应的待筛选报文协议头数据；若待筛选报文协议头数据与所述预设协议分析规则对应的协议数据匹配，则将所述待筛选报文协议头数据作为所述报文协议头数据。进一步地，所述应用模块131还用于：获取各个待处理报文协议头数据中的特征信息；确定所述特征信息是否满足预设攻击特征信息对应的预设条件，其中，若满足所述预设条件，则确定所述待处理报文协议头数据中存在目标报文协议头数据。进一步地，所述应用模块131还用于：若存在目标报文协议头数据，则获取所述目标报文协议头数据对应的特征信息，并基于所述特征信息确定所述攻击事件。进一步地，所述应用模块131还用于：确定抑制列表中是否存在所述攻击事件；若所述抑制列表中不存在所述攻击事件，则将所述攻击事件上传至VSOC平台，并将所述攻击事件添加至所述抑制列表。进一步地，所述应用模块131还用于：实时确定所述抑制列表中的各个攻击事件中，是否存在超时的目标攻击事件；若所述抑制列表中存在所述目标攻击事件，则在所述抑制列表中删除所述目标攻击事件。进一步地，所述应用模块131还用于：实时确定所述报文数据库的各个报文协议头数据中，是否存在超时的待删除报文协议头数据；若存在所述待删除报文协议头数据，则在所述报文数据库中删除所述待删除报文协议头数据。进一步地，所述应用模块131还用于：在检测到云服务器发送的预设协议分析规则对应的第一更新指令时，从所述云服务器获取所述第一更新指令对应的待更新协议分析规则，并基于所述待更新协议分析规则更新所述预设协议分析规则；或者，在检测到云服务器发送的攻击特征数据库对应的第二更新指令时，从所述云服务器获取所述第二更新指令对应的待更新攻击特征信息，并基于所述待更新攻击特征信息更新所述攻击特征数据库。上述各程序单元所执行的方法可参照本申请攻击侦测方法各个实施例，此处不再赘述。此外，本申请实施例还提出一种车辆130，所述车辆130包括应用模块131以及与所述应用模块通信连接的内核模块132，其中，所述内核模块132用于基于预设协议分析规则确定待检测报文对应的报文协议头数据，并将所述报文协议头数据挂载至报文数据库；所述应用模块131用于定时获取所述报文数据库中的待处理报文协议头数据；所述应用模块131用于基于攻击特征数据库中的预设攻击特征信息，确定待处理报文协议头数据中是否存在目标报文协议头数据；所述应用模块131用于若存在目标报文协议头数据，则基于所述目标报文协议头数据确定攻击事件，并将所述攻击事件上传至VSOC平台。其中，内核模块为车辆的kernel内核，应用模块为应用程序。进一步地，所述内核模块132还用于：对所述待检测报文进行报文解析，以获得所述待检测报文对应的待筛选报文协议头数据；若待筛选报文协议头数据与所述预设协议分析规则对应的协议数据匹配，则将所述待筛选报文协议头数据作为所述报文协议头数据。进一步地，所述应用模块131还用于：获取各个待处理报文协议头数据中的特征信息；确定所述特征信息是否满足预设攻击特征信息对应的预设条件，其中，若满足所述预设条件，则确定所述待处理报文协议头数据中存在目标报文协议头数据。进一步地，所述应用模块131还用于：若存在目标报文协议头数据，则获取所述目标报文协议头数据对应的特征信息，并基于所述特征信息确定所述攻击事件。进一步地，所述应用模块131还用于：确定抑制列表中是否存在所述攻击事件；若所述抑制列表中不存在所述攻击事件，则将所述攻击事件上传至VSOC平台，并将所述攻击事件添加至所述抑制列表。进一步地，所述应用模块131还用于：实时确定所述抑制列表中的各个攻击事件中，是否存在超时的目标攻击事件；若所述抑制列表中存在所述目标攻击事件，则在所述抑制列表中删除所述目标攻击事件。进一步地，所述应用模块131还用于：实时确定所述报文数据库的各个报文协议头数据中，是否存在超时的待删除报文协议头数据；若存在所述待删除报文协议头数据，则在所述报文数据库中删除所述待删除报文协议头数据。进一步地，所述应用模块131还用于：在检测到云服务器发送的预设协议分析规则对应的第一更新指令时，从所述云服务器获取所述第一更新指令对应的待更新协议分析规则，并基于所述待更新协议分析规则更新所述预设协议分析规则；或者，在检测到云服务器发送的攻击特征数据库对应的第二更新指令时，从所述云服务器获取所述第二更新指令对应的待更新攻击特征信息，并基于所述待更新攻击特征信息更新所述攻击特征数据库。上述各程序单元所执行的方法可参照本申请攻击侦测方法各个实施例，此处不再赘述。此外，本申请实施例还提出一种计算机可读存储介质，所述可读存储介质上存储有攻击侦测程序，所述攻击侦测程序被处理器执行时实现如上所述的攻击侦测方法的步骤。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者系统不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者系统所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者系统中还存在另外的相同要素。上述本申请实施例序号仅仅为了描述，不代表实施例的优劣。通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到上述实施例方法可借助软件加必需的通用硬件平台的方式来实现，当然也可以通过硬件，但很多情况下前者是更佳的实施方式。基于这样的理解，本申请的技术方案本质上或者说对现有技术做出贡献的部分可以以软件产品的形式体现出来，该计算机软件产品存储在如上所述的一个存储介质中，包括若干指令用以使得一台终端设备执行本申请各个实施例所述的方法。以上仅为本申请的优选实施例，并非因此限制本申请的专利范围，凡是利用本申请说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本申请的专利保护范围内。
