标题title
基于SRS的多进程直播方法、装置、电子设备以及存储介质
摘要abst
本申请涉及一种基于SRS的多进程直播方法、装置、电子设备及存储介质，方法包括：获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据；将若干个直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个SRS进程，以分别通过各个SRS进程并行获取各组直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组直播视频流数据并行进行存储，获取通过反代理监听端口接收的直播视频流播放请求；根据直播视频流播放请求，获取对应存储的直播视频流数据，并将直播视频流数据发送至对应的直播视频流播放请求客户端。将推流请求分配至后端的多个SRS进程，实现多线程的模拟，充分利用服务器资源。
权利要求书clms
1.一种基于SRS的多进程直播方法，其特征在于，包括：获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据；其中，所述直播推流请求包括直播推流地址；所述直播视频流数据与所述直播推流地址一一对应；所述反代理监听端口配置有若干个监听子端口，每个所述监听子端口均配置有一个SRS进程；将若干个所述直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据并行进行存储；其中，每组直播推流请求至少包括一个所述直播推流请求；获取通过所述反代理监听端口接收的直播视频流播放请求；根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。2.根据权利要求1所述的基于SRS的多进程直播方法，其特征在于，所述将若干个所述直播推流请求进行划分，获得若干组直播推流请求，包括步骤：获取各个所述SRS进程的负载信息，其中，所述负载信息包括所述SRS进程允许执行的直播推流请求数目；根据所述各个SRS进程允许执行的直播推流请求数目，将若干个所述直播推流请求进行划分，获得若干组直播推流请求。3.根据权利要求1或2所述的基于SRS的多进程直播方法，其特征在于，所述直播推流地址包括直播推流标识，各个直播推流标识均有唯一对应的直播视频流数据；所述将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据进行存储，包括步骤：获取预设的虚拟内存目录的路径，通过各个所述SRS进程并行将各组所述直播视频流数据存储于所述虚拟内存目录中。4.根据权利要求3所述的基于SRS的多进程直播方法，其特征在于，所述虚拟内存目录中包括若干个与所述直播推流标识相应的子虚拟内存目录；所述获取预设的虚拟内存目录的路径，通过各个所述SRS进程并行将各组所述直播视频流数据存储于所述虚拟内存目录中，还包括步骤：获取各组所述直播推流请求相应的直播推流地址中的直播推流标识，根据所述直播推流标识，获得各组所述直播推流标识对应的直播视频流数据；根据所述直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径；通过各个所述SRS进程将各组所述直播推流标识对应的所述直播视频流数据存储于相应的子虚拟内存目录。5.根据权利要求4所述的基于SRS的多进程直播方法，其特征在于，所述通过各个所述SRS进程将各组所述直播推流标识对应的所述直播视频流数据存储于相应的子虚拟内存目录，包括步骤：通过配置各个SRS进程的分发方式，各个所述SRS进程将所述直播视频流数据按预设顺序生成若干个直播视频片段文件，根据需要录制直播视频的起始时间和结束时间对所述直播视频片段文件进行编号，并储存于所述直播推流标识相应的子虚拟内存目录。6.根据权利要求5所述的基于SRS的多进程直播方法，其特征在于，所述通过各个所述SRS进程将各组所述直播推流标识对应的所述直播视频流数据存储于相应的子虚拟内存目录，还包括步骤：通过各个所述SRS进程遍历对应的所述子虚拟内存目录下的直播视频片段文件，获取所述直播视频片段文件的特征信息，其中，所述特征信息包括直播视频流数据的名称、编号和播放时长；通过各个所述SRS进程对所述直播视频片段文件的特征信息进行动态组装，获得所述直播视频片段文件相应的索引文件，并将所述索引文件存储于对应的所述子虚拟内存目录中。7.根据权利要求6所述的基于SRS的多进程直播方法，其特征在于：所述直播视频流播放请求包括直播请求地址，其中，所述直播请求地址包括直播推流标识以及索引文件标识；所述根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端，包括步骤：将所述直播视频流播放请求发送至一个所述SRS进程中，根据所述直播视频流播放请求中的直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径；根据所述直播地址中的索引文件标识以及与所述直播推流标识相应的子虚拟内存目录的路径，在所述子虚拟内存目录中获取与所述直播请求地址中的直播推流标识相应的索引文件，并根据所述索引文件，获取与所述索引文件相应的直播视频片段文件，并将所述直播视频片段文件发送至对应的直播视频流播放请求客户端。8.一种基于SRS的多进程直播装置，其特征在于，包括：数据获取模块，用于获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据；其中，所述直播推流请求包括直播推流地址；所述直播视频流数据与所述直播推流地址一一对应；所述反代理监听端口配置有若干个监听子端口，每个监听子端口均配置有一个SRS进程；数据存储模块，用于将若干个所述直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据并行进行存储，其中，每组直播推流请求至少包括一个所述直播推流请求；数据播放模块，用于获取通过所述反代理监听端口接收的直播视频流播放请求；根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。9.一种电子设备，其特征在于，包括处理器、存储器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器与所述显示器、储存器连接；所述处理器执行所述计算机程序时实现如权利要求1至7任一项所述的基于SRS的多进程直播方法的步骤。10.一种存储介质，其特征在于：所述存储介质存储有计算机程序，所述计算机程序被处理器执行时实现如权利要求1至7任一项所述的基于SRS的多进程直播方法的步骤。
说明书desc
技术领域本申请涉及通信技术领域，特别涉及一种基于SRS的多进程直播方法、装置、电子设备及存储介质。背景技术SRS是一款非常优秀的开源流媒体服务器软件，可用于直播/录播/视频客服等多种场景，其定位是运营级的互联网直播服务器集群。对于大多数的小企业的直播业务，为了节约成本，满足直播需求，基本采用一台服务器来执行，具体的，通过SRS线程来实现直播视频流处理。然而，SRS本身只支持单线程，不支持多线程，在执行多个直播推流请求时，只能单独执行一个直播推流请求，导致无法充分利用多核，浪费服务器资源，且效率低下。发明内容基于此，本申请提供一种基于SRS的多进程直播方法、装置、电子设备及存储介质，通过设置反代理监听端口，将多个推流请求分配至后端的多个SRS进程，实现多线程的模拟，改善了单个SRS进程执行单个推流请求导致的效率低的问题，充分利用服务器资源。作为本申请实施例的第一方面，提供一种基于SRS的多进程直播方法，包括以下步骤：获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据；其中，所述直播推流请求包括直播推流地址；所述直播视频流数据与所述直播推流地址一一对应；所述反代理监听端口配置有若干个监听子端口，每个监听子端口均配置有一个SRS进程；将若干个所述直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据并行进行存储，其中，每组直播推流请求至少包括一个所述直播推流请求；获取通过所述反代理监听端口接收的直播视频流播放请求；根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。作为本申请实施例的第二方面，提供了一种基于SRS的多进程直播装置，包括：数据获取模块，用于获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据；其中，所述直播推流请求包括直播推流地址；所述直播视频流数据与所述直播推流地址一一对应；所述反代理监听端口配置有若干个监听子端口，每个监听子端口均配置有一个SRS进程；数据存储模块，用于将若干个所述直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据并行进行存储，其中，每组直播推流请求至少包括一个所述直播推流请求；数据播放模块，用于获取通过所述反代理监听端口接收的直播视频流播放请求；根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。作为本申请实施例的第三方面，提供了一种电子设备，包括处理器、存储器以及存储在所述存储器中并可在所述处理器上运行的计算机程序，所述处理器与所述显示器、储存器连接；所述计算机程序被所述处理器执行时实现如第一方面所述的基于SRS的多进程直播方法的步骤。作为本申请实施例的第四方面，提供了一种存储介质，所述存储介质存储有计算机程序，所述计算机程序被处理器执行时实现如第一方面所述的基于SRS的多进程直播方法的步骤。在本申请的实施例中，通过设置反代理监听端口，将推流请求分配至后端的多个SRS进程，实现多线程的模拟，改善了单个SRS进程执行推流请求的效果，充分利用服务器资源，从而提高了直播的效率。为了更好地理解和实施，下面结合附图详细说明本申请。附图说明图1为本申请一个实施例提供的基于SRS的多进程直播方法的应用场景示意图；图2为本申请第一实施例提供的基于SRS的多进程直播方法的流程示意图；图3为本申请第一实施例提供的基于SRS的多进程直播方法中S2的流程示意图；图4为本申请第二实施例提供的基于SRS的多进程直播方法中S2的流程示意图；图5为本申请第三实施例提供的基于SRS的多进程直播方法中S2的流程示意图；图6为本申请第三实施例提供的基于SRS的多进程直播方法中S25的流程示意图；图7为本申请第三实施例提供的基于SRS的多进程直播方法中S251的流程示意图；图8为本申请第四实施例提供的基于SRS的多进程直播方法中S3的流程示意图；图9为本申请第五实施例提供的基于SRS的多进程直播装置的结构示意图；图10为本申请第五实施例提供的基于SRS的多进程直播装置的数据存储模块的结构示意图；图11为本申请第五实施例提供的基于SRS的多进程直播装置的数据播放模块的结构示意图；图12为本申请第六实施例提供的电子设备的结构示意图。具体实施方式为使本申请的目的、技术方案和优点更加清楚，下面将结合附图对本申请实施例做进一步地详细描述。其中，下面的描述涉及附图时，除非另有表示，不同附图中的相同数字表示相同或相似的要素。应当明确，以下描述的实施例中所描述的实施方式并不代表与本申请相一致的所有实施方式。相反，它们仅是与如所附权利要求书中所详述的、本申请的一些方面相一致的装置和方法的例子。基于本申请实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其它实施例，都属于本申请保护的范围。在本申请使用的术语是仅仅出于描述特定实施例的目的，而非旨在限制本申请。在本申请中所使用的单数形式的“一种”、“所述”和“该”也旨在包括多数形式，除非上下文清楚地表示其他含义。此外，在本申请的描述中，除非另有说明，“多个”是指两个或两个以上。还应当理解，本文中使用的术语“和/或”是指并包含一个或多个相关联的列出项目的任何或所有可能组合，例如，A和/或B，可以表示：单独存在A，同时存在A和B，单独存在B这三种情况；字符“/”一般表示前后关联对象是一种“或”的关系。应当理解，尽管在本申请可能采用术语第一、第二、第三等来描述各种信息，但这些信息不应限于这些术语，而且，这些术语仅用来区别类似的对象，而不必用于描述特定的顺序或先后次序，也不能理解为指示或暗示相对重要性。对于本领域的普通技术人员而言，可以根据具体情况理解上述术语在本申请中的具体含义。取决于语境，本申请所使用的词语“如果”/“若”可以被解释成为“在……时”或“当……时”或“响应于确定”。请参考图1，图1为本申请一个实施例提供的基于SRS的多进程直播方法的应用场景示意图，应用场景包括主播客户端110、观众客户端120和服务器130。所述主播客户端110与所述观众客户端120通过所述服务器130进行交互。具体的，所述主播客户端110和所述观众客户端120均可以通过网络接入方式接入互联网，与所述服务器130建立数据通信链路。其中，网络可以是能够在所述主播客户端110与所述服务器130之间以及所述观众客户端120与所述服务器130之间实现通信的各种连接类型的通信介质，例如可以是有线通信链路、无线通信链路或者光纤电缆等等，本申请在此不做限制。需要说明的是，本申请实施例提出的客户端包括主播客户端110和观众客户端120。需要指出的是，在现有技术中会存在对“客户端”这一概念的多种理解，例如：可以将其理解为安装在计算机设备中的应用程序，或者，也可以将其理解为相对应于服务器的硬件设备。在本申请实施例中，所称的“客户端”是指相对应于服务器的硬件设备，更具体来说，是指计算机设备，例如：智能手机、智能交互平板以及个人计算机等。在客户端为智能手机、智能交互平板等移动设备时，用户可以在客户端上安装匹配的移动端应用程序，也可以在客户端上访问Web端应用程序。在客户端为个人计算机等非移动设备时，用户可以在客户端上安装匹配的PC端应用程序，同样也可以在客户端上访问Web端应用程序。其中，移动端应用程序是指可安装在移动设备中的应用程序，PC端应用程序是指可安装在非移动设备中的应用程序，Web端应用程序是指需通过浏览器访问的应用程序。具体地，Web端应用程序依据客户端类型的差异，又可以分为移动版本和PC版本，两者的页面布局方式以及可提供的服务器支持可能存在差别。在本申请实施例中，提供至用户的直播应用程序的类型分为移动端直播应用程序、PC端直播应用程序和Web端直播应用程序。用户可以依据其采用客户端的类型不同，自主选择其参与网络直播的方式。本申请依据进入直播间的客户端的用户身份的不同，将客户端分为主播客户端110和观众客户端120。应当说明，在实际应用中，可以由同一个客户端在不同时间分别执行所述观众客户端120与所述主播客户端110的功能。因此，同一个客户端在观看网络直播时，可以作为所述观众客户端120，在发布直播视频时，可以作为所述主播客户端110。所述主播客户端110是指发送网络直播视频的一端，通常来说是网络直播中主播用户所采用的客户端。所述主播客户端110所指向的硬件，本质上是指计算机设备，具体地，如图1所示，其可以是智能手机、智能交互平板和个人计算机等类型的计算机设备。所述观众客户端120是指接收和观看网络直播视频的一端，通常来说是网络直播中观看视频的观众用户所采用的客户端。所述观众客户端120所指向的硬件，本质上是指计算机设备，具体地，如图1所示，其可以是智能手机、智能交互平板和个人计算机等类型的计算机设备。所述服务器130可作为一个业务服务器，其可以负责进一步连接起相关音频数据服务器、视频流服务器以及其他提供相关支持的服务器等，以此构成逻辑上相关联的服务机群，来为相关的终端设备，例如图1中所示的主播客户端110和观众客户端120提供服务。主播用户在使用主播客户端110进行直播推流时，主播客户端110会生成直播推流请求，并将该直播推流请求以及相关联的直播视频流发送至服务端上，服务端130进行响应，将直播视频流进行储存，观众用户在使用观众客户端120进行直播播放时，观众客户端120会生成直播播放请求，发送至服务端130上，服务端130进行响应，获取相应的直播视频流，发送至观众客户端中120进行播放。其中，在直播视频流的处理上，通常采用SRS来实现。在实际情况中，对于大多数的小企业的直播业务，为了节约成本，满足直播需求，基本采用一台服务器来执行，具体而言，通过一个端口来获取直播推流请求，从而通过端口对应的SRS进程对直播推流请求对应的直播视频流进行处理，然而，SRS本身只支持单线程，不支持多线程，在执行多个直播推流请求时，只能单独执行一个直播推流请求，导致无法充分利用多核，浪费服务器资源，且效率低下。请参阅图2，图2为本申请第一实施例提供的基于SRS的多进程直播方法的流程示意图，本申请实施例的基于SRS的多进程直播方法应用于企业直播业务中，尤其是由一台服务器执行的直播业务中，具体的，本申请实施例的基于SRS的多进程直播方法由该服务器作为执行主体执行，所述方法包括如下步骤：S1：获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据。在本实施例中，服务器基于NGINX进行反代理监听端口的设置，其中，所述NGINX为一个高性能的WEB服务端软件，支持多协议的端口反向代理，支持TCP端口反向代理，即stream代理。通过该反代理监听端口，接收各个主播客户端发送的直播推流请求以及直播视频流数据集，其中，所述直播推流请求包括直播推流地址；所述直播视频流数据与所述直播推流地址一一对应。所述反代理监听端口配置有若干个监听子端口，每个监听子端口均配置有一个SRS进程；各个SRS进程都具有相应的编号，例如SRS1、SRS2、SRS3等等；SRS是一个简单高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB29191。S2：将若干个所述直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据并行进行存储。在本实施例中，服务器将若干个所述直播推流请求进行划分，获得若干组直播推流请求；其中，每组直播推流请求至少包括一个所述直播推流请求；为了充分利用多核资源，服务器分别启动各个SRS进程，通过相应的监听子端口，将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据并行进行存储，以多进程的方式，改善了单个SRS进程执行推流请求的效果，充分利用服务器资源，提高了直播推流的效率。在一可选的实施例中，服务器可以根据所述SRS进程数量，将若干个所述直播推流请求进行平均划分，划分成与所述SRS进程数量一致的直播推流请求。例如：当前的直播推流请求数目为12，SRS进程的数目为3，则将分成3组直播推流请求，每组直播推流请求包括4个直播推流请求，以让各个SRS进程可以进行持续工作，能够及时地去执行直播推流请求。在另一可选的实施例中，请参阅图3，图3为本申请第一实施例提供的基于SRS的多进程直播方法中S2的流程示意图，包括步骤S21～S22，具体如下：S21：获取各个所述SRS进程的负载信息。在本实施例中，服务器对各个SRS进程进行分析，获取各个SRS进程的允许执行的直播推流请求数目，作为各个所述SRS进程的负载信息。S22：根据所述各个SRS进程允许执行的直播推流请求数目，将若干个所述直播推流请求进行划分，获得若干组直播推流请求。为了充分利用多核资源，在本实施例中，服务器根据所述各个SRS进程允许执行的直播推流请求数目，将若干个所述直播推流请求进行划分，获得若干组直播推流请求；具体地，服务器可以按照预设的比例将若干个所述直播推流请求进行划分，其中，所述比例可以是与允许执行的直播推流请求数目相关联的系数，例如：编号为SRS1对应的SRS进程的允许执行的直播推流请求数目为1，编号为SRS2对应的SRS进程的允许执行的直播推流请求数目为2，编号为SRS3对应的SRS进程的允许执行的直播推流请求数目为3，则该SRS1进程、SRS2进程、SRS3进程的比例设置为1:2:3；若当前的直播推流请求数目为12，则按照各个SRS进程对应的比例，将若干个所述直播推流请求进行划分，各个SRS进程能够分到对应的比例与预设的计量数目相乘的直播推流请求数目，即编号为SRS1对应的SRS进程对应的直播推流请求数目为2，编号为SRS2对应的SRS进程对应的直播推流请求数目为4，编号为SRS3对应的SRS进程对应的直播推流请求数目为6，从而将若干个所述直播推流请求进行划分为数目为2的一组直播推流请求、数目为4的一组直播推流请求以及数目为6的一组直播推流请求，实现直播推流请求的划分。在一个可选的实施例中，所述直播推流地址包括直播推流标识，各个直播推流标识均有唯一对应的直播视频流数据。请参阅图4，图4为本申请第二实施例提供的基于SRS的多进程直播方法中S2的流程示意图，还包括步骤S23，具体如下：S23：获取预设的虚拟内存目录的路径，通过各个所述SRS进程并行将各组所述直播视频流数据存储于所述虚拟内存目录中。在本实施例中，服务器预先配置虚拟内存目录，并获取该虚拟内存目录的路径，通过各个所述SRS进程并行将各组所述直播视频流数据存储于所述虚拟内存目录中，通过降低了磁盘I/O的占用率，提高读写效率，从而提高了直播的效率。在一个可选的实施例中，所述虚拟内存目录中包括若干个与所述直播推流标识相应的子虚拟内存目录，其中，所述子虚拟内存目录为所述虚拟内存目录下的进一步划分的存储空间。请参阅图5，图5为本申请第三实施例提供的基于SRS的多进程直播方法中S2的流程示意图，还包括步骤S24～S25，具体如下：S24：获取各组所述直播推流请求相应的直播推流地址中的直播推流标识，根据所述直播推流标识，获得各组所述直播推流标识对应的直播视频流数据。在本实施例中，服务器获取所述直播推流请求相应的直播推流地址中的直播推流标识，根据所述直播推流标识，获得各组所述直播推流标识对应的直播视频流数据，其中，所述直播推流标识为每个使用主播客户端进行直播推流的用户的唯一标识，所述直播推流标识可以为用户的注册名称、也可以为用户的注册编号等等，在此不进行详细限定。S25：根据所述直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径；通过各个所述SRS进程将各组所述直播推流标识对应的所述直播视频流数据存储于相应的子虚拟内存目录。在本实施例中，服务器根据所述直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径；通过各个所述SRS进程将各组所述直播推流标识对应的所述直播视频流数据存储于相应的子虚拟内存目录，提高了用户检索相应的直播推流标识对应的直播视频流数据的效率。请参阅图6，图6为本申请第三实施例提供的基于SRS的多进程直播方法中S25的流程示意图，包括步骤S251，具体如下：S251：通过配置各个SRS进程的分发方式，各个所述SRS进程将所述直播视频流数据按预设顺序生成若干个直播视频片段文件，根据需要录制直播视频的起始时间和结束时间对所述直播视频片段文件进行编号，并储存于所述直播推流标识相应的子虚拟内存目录。所述SRS进程的分发方式为HLS分发方式，具体地，在本实施例中，服务器在获取到直播视频流后，为各个SRS进程进行HLS分发方式的配置，各个所述SRS进程将所述直播视频流数据按预设顺序生成若干个直播视频片段文件，据需要录制直播视频的起始时间和结束时间对所述直播视频片段文件进行编号，并储存于所述直播推流标识相应的子虚拟内存目录。其中，该预设的顺序可以是时间顺序，例如：直播视频流的画面播放的时间顺序。由于每个直播视频片段文件对应的播放时间的长度不等，同时根据需要直播录制视频的起始时间和结束时间对直播视频片段文件进行编号，具体地，将直播视频流的0-3秒生成第一个直播视频片段文件、4-8秒生成第二个直播视频片段文件、9-10秒生成第三个直播视频片段文件，如此类推，随着播放的时间的延长，生成的直播视频片段文件就会越多，同时对生成的直播视频片段文件进行编号，编号从1开始，每次加1，即第一个直播视频片段文件的编号为1、第二个直播视频片段文件的编号为2，第n个直播视频片段文件的编号为n，并储存于所述直播推流标识相应的子虚拟内存目录。请参阅图7，图7为本申请第三实施例提供的基于SRS的多进程直播方法中S251的流程示意图，包括步骤S2511～S2512，具体如下：S2511：通过各个所述SRS进程遍历对应的所述子虚拟内存目录下的直播视频片段文件，获取所述直播视频片段文件的特征信息。随着直播时间的延长，服务器通过SRS的分发方式，在子虚拟内存目录下生成的直播视频片段文件则会越来越多。为了快速进行直播视频片段文件的检索，在本实施例中，服务器通过各个所述SRS进程，遍历所述子虚拟内存目录下的直播视频片段文件，获取所述直播视频片段文件的特征信息，用以生成所述直播视频片段文件相应的索引文件，其中，所述特征信息包括直播视频流数据的名称、编号和播放时长；具体地，服务器可以采用SHELL脚本遍历子虚拟内存目录下的直播视频片段文件，并采用多媒体流信息提取工具获取直播视频片段文件的文件特征信息，其中，所述多媒体流信息提取工具可以为执行FFprobe命令的信息提取工具。S2512：通过各个所述SRS进程对所述直播视频片段文件的特征信息进行动态组装，获得所述直播视频片段文件相应的索引文件，并将所述索引文件存储于对应的所述子虚拟内存目录中。在本实施例中，服务器根据所述直播视频片段文件的特征信息，通过各个所述SRS进程对所述直播视频片段文件的特征信息进行动态组装，获得所述直播视频片段文件相应的索引文件，并将所述索引文件存储于对应的所述子虚拟内存目录中；具体的，当服务器通过多媒体流信息提取工具动态获取直播视频片段文件的名称和播放时长，利用直播视频片段文件的名称和播放时长重新组装出索引文件，例如live001.m3u8。S3：获取通过所述反代理监听端口接收的直播视频流播放请求；根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。在本实施例，服务器获取通过所述反代理监听端口接收的直播视频流播放请求，根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。在一个可选的实施例中，所述直播视频流播放请求包括直播请求地址，其中，所述直播请求地址包括直播推流标识以及索引文件标识，所述索引文件表示为每个索引文件的唯一标识，所述索引文件标识可以为索引文件的名称、编号等等，在此不进行详细限定。请参阅图8，图8为本申请第四实施例提供的基于SRS的多进程直播方法中S3的流程示意图，包括步骤S31～S32，具体如下：S31：将所述直播视频流播放请求发送至一个所述SRS进程中，根据所述直播视频流播放请求中的直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径。在本实施例中，服务器将所述直播视频流播放请求发送至一个所述SRS进程中，具体地，服务器可以根据通过获取所述各个SRS进程的负载信息，从所述若干个SRS进程中获得允许执行的直播推流请求数目最少的SRS进程，作为目标SRS进程，调用相应的监听子端口，将将所述直播视频流播放请求发送至该目标SRS进程中，SRS进程执行所述直播视频流播放请求，根据所述直播视频流播放请求中的直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径。S32：根据所述直播地址中的索引文件标识以及与所述直播推流标识相应的子虚拟内存目录的路径，在所述子虚拟内存目录中获取与所述直播请求地址中的直播推流标识相应的索引文件，并根据所述索引文件，获取与所述索引文件相应的直播视频片段文件，并将所述直播视频片段文件发送至对应的直播视频流播放请求客户端。在本实施例中，服务器根据所述直播地址中的索引文件标识以及与所述直播推流标识相应的子虚拟内存目录的路径，在所述子虚拟内存目录中获取与所述直播请求地址中的直播推流标识相应的索引文件，并根据所述索引文件，获取与所述索引文件相应的直播视频片段文件，并将所述直播视频片段文件发送至对应的直播视频流播放请求客户端，改善了常规的直播视频流播放的延迟和滞后的问题，提高用户体验。请参考图9，图9为本申请第五实施例提供的基于SRS的多进程直播装置的结构示意图，该装置可以通过软件、硬件或两者的结合实现基于SRS的多进程直播方法的全部或一部分，该装置9包括：数据获取模块91，用于获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据；其中，所述直播推流请求包括直播推流地址；所述直播视频流数据与所述直播推流地址一一对应；所述反代理监听端口配置有若干个监听子端口，每个监听子端口均配置有一个SRS进程；数据存储模块92，用于将若干个所述直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据并行进行存储，其中，每组直播推流请求至少包括一个所述直播推流请求；数据播放模块93，用于获取通过所述反代理监听端口接收的直播视频流播放请求；根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。请参考图10，图10为本申请第五实施例提供的基于SRS的多进程直播装置的数据存储模块的结构示意图，在一可选的实施例中，数据存储模块92包括：负载信息获取模块921，用于获取各个所述SRS进程的负载信息，其中，所述负载信息包括所述SRS进程允许执行的直播推流请求数目；直播推流请求获取模块922，用于根据所述各个SRS进程允许执行的直播推流请求数目，将若干个所述直播推流请求进行划分，获得若干组直播推流请求。在一可选的实施例中，数据存储模块92包括：第一路径获取模块923，用于获取预设的虚拟内存目录的路径，通过各个所述SRS进程并行将各组所述直播视频流数据存储于所述虚拟内存目录中。在一可选的实施例中，数据存储模块92包括：直播推流标识获取模块924，用于获取各组所述直播推流请求相应的直播推流地址中的直播推流标识，根据所述直播推流标识，获得各组所述直播推流标识对应的直播视频流数据；直播视频流数据存储模块925根据所述直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径；通过各个所述SRS进程将各组所述直播推流标识对应的所述直播视频流数据存储于相应的子虚拟内存目录；在一可选的实施例中，数据存储模块92包括：直播视频片段文件生成模块926，用于通过配置各个SRS进程的分发方式，各个所述SRS进程将所述直播视频流数据按预设顺序生成若干个直播视频片段文件，根据需要录制直播视频的起始时间和结束时间对所述直播视频片段文件进行编号，并储存于所述直播推流标识相应的子虚拟内存目录。在一可选的实施例中，数据存储模块92包括：特征信息获取模块927，用于通过各个所述SRS进程遍历对应的所述子虚拟内存目录下的直播视频片段文件，获取所述直播视频片段文件的特征信息，其中，所述特征信息包括直播视频流数据的名称、编号和播放时长；索引文件生成模块928，用于通过各个所述SRS进程对所述直播视频片段文件的特征信息进行动态组装，获得所述直播视频片段文件相应的索引文件，并将所述索引文件存储于对应的所述子虚拟内存目录中。请参考图11，图11为本申请第五实施例提供的基于SRS的多进程直播装置的数据播放模块的结构示意图，在一可选的实施例中，数据播放模块93包括：第二路径获取模块931，用以将所述直播视频流播放请求发送至一个所述SRS进程中，根据所述直播视频流播放请求中的直播推流标识，获取与所述直播推流标识相应的子虚拟内存目录的路径；直播视频流播放模块932，用于根据所述直播地址中的索引文件标识以及与所述直播推流标识相应的子虚拟内存目录的路径，在所述子虚拟内存目录中获取与所述直播请求地址中的直播推流标识相应的索引文件，并根据所述索引文件，获取与所述索引文件相应的直播视频片段文件，并将所述直播视频片段文件发送至对应的直播视频流播放请求客户端。在本实施例中，通过获取模块，获取通过预设的反代理监听端口接收的若干个直播推流请求以及对应的直播视频流数据；其中，所述直播推流请求包括直播推流地址；所述直播视频流数据与所述直播推流地址一一对应；所述反代理监听端口配置有若干个监听子端口，每个监听子端口均配置有一个SRS进程；通过存储模块，将若干个所述直播推流请求进行划分，获得若干组直播推流请求；将每组直播推流请求分配至对应的一个所述SRS进程，以分别通过各个所述SRS进程并行获取各组所述直播推流请求相应的直播推流地址对应的直播视频流数据，并将各组所述直播视频流数据进行存储，其中，每组直播推流请求至少包括一个所述直播推流请求；通过播放模块，获取通过所述反代理监听端口接收的直播视频流播放请求；根据所述直播视频流播放请求，获取对应存储的直播视频流数据，并将所述直播视频流数据发送至对应的直播视频流播放请求客户端。通过设置监听端口，将推流请求分配至后端的多个SRS进程，实现多线程的模拟，改善了单个SRS进程执行推流请求的效果，充分利用服务器资源，且将推流请求对应的视频流数据存储于虚拟内存中，降低了磁盘I/O的占用率，提高读写效率，从而提高了直播的效率。请参考图12，图12为本申请第六实施例提供的电子设备的结构示意图，电子设备10包括：处理器101、存储器102以及存储在存储器102上并可在处理器101上运行的计算机程序103；处理器101与显示器91、储存器连接102；电子设备10可以存储有多条指令，指令适用于由处理器101加载并执行上述实施例的基于SRS的多进程直播方法步骤，具体执行过程可以参见上述第一实施例至第四实施例的具体说明，在此不进行赘述。其中，处理器101可以包括一个或多个处理核心。处理器101利用各种接口和线路连接服务器内的各个部分，通过运行或执行存储在存储器102内的指令、程序、代码集或指令集，以及调用存储器102内的数据，执行基于SRS的多进程直播装置9的各种功能和处理数据，可选的，处理器101可以采用数字信号处理、现场可编程门阵列、可编程逻辑阵列中的至少一个硬件形式来实现。处理器101可集成中央处理器101、图像处理器101和调制解调器等中的一个或几种的组合。其中，CPU主要处理操作系统、用户界面和应用程序等；GPU用于负责触摸显示屏所需要显示的内容的渲染和绘制；调制解调器用于处理无线通信。可以理解的是，上述调制解调器也可以不集成到处理器101中，单独通过一块芯片进行实现。其中，存储器102可以包括随机存储器102，也可以包括只读存储器102。可选的，该存储器102包括非瞬时性计算机可读介质。存储器102可用于存储指令、程序、代码、代码集或指令集。存储器102可包括存储程序区和存储数据区，其中，存储程序区可存储用于实现操作系统的指令、用于至少一个功能的指令、用于实现上述各个方法实施例的指令等；存储数据区可存储上面各个方法实施例中涉及到的数据等。存储器102可选的还可以是至少一个位于远离前述处理器101的存储装置。本申请实施例还提供了一种存储介质，所述存储介质可以存储有多条指令，所述指令适用于由处理器加载并执行上述第一实施例至第四实施例的方法步骤，具体执行过程可以参见第一实施例至第四实施例所示实施例的具体说明，在此不进行赘述。所属领域的技术人员可以清楚地了解到，为了描述的方便和简洁，仅以上述各功能单元、模块的划分进行举例说明，实际应用中，可以根据需要而将上述功能分配由不同的功能单元、模块完成，即将所述装置的内部结构划分成不同的功能单元或模块，以完成以上描述的全部或者部分功能。实施例中的各功能单元、模块可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中，上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。另外，各功能单元、模块的具体名称也只是为了便于相互区分，并不用于限制本申请的保护范围。上述系统中单元、模块的具体工作过程，可以参考前述方法实施例中的对应过程，在此不再赘述。在上述实施例中，对各个实施例的描述都各有侧重，某个实施例中没有详述或记载的部分，可以参见其它实施例的相关描述。本领域普通技术人员可以意识到，结合本文中所公开的实施例描述的各示例的单元及算法步骤，能够以电子硬件、或者计算机软件和电子硬件的结合来实现。这些功能究竟以硬件还是软件方式来执行，取决于技术方案的特定应用和设计约束条件。专业技术人员可以对每个特定的应用来使用不同方法来实现所描述的功能，但是这种实现不应认为超出本申请的范围。在本申请所提供的实施例中，应该理解到，所揭露的装置/终端设备和方法，可以通过其它的方式实现。例如，以上所描述的装置/终端设备实施例仅是示意性的，例如，所述模块或单元的划分，仅仅为一种逻辑功能划分，实际实现时可以有另外的划分方式，例如多个单元或组件可以结合或者可以集成到另一个系统，或一些特征可以忽略，或不执行。另一点，所显示或讨论的相互之间的耦合或直接耦合或通讯连接可以是通过一些接口，装置或单元的间接耦合或通讯连接，可以是电性，机械或其它的形式。所述作为分离部件说明的单元可以是或者也可以不是物理上分开的，作为单元显示的部件可以是或者也可以不是物理单元，即可以位于一个地方，或者也可以分布到多个网络单元上。可以根据实际的需要选择其中的部分或者全部单元来实现本实施例方案的目的。另外，在本申请各个实施例中的各功能单元可以集成在一个处理单元中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个单元中。上述集成的单元既可以采用硬件的形式实现，也可以采用软件功能单元的形式实现。所述集成的模块/单元如果以软件功能单元的形式实现并作为独立的产品销售或使用时，可以存储在一个计算机可读取存储介质中。基于这样的理解，本申请实现上述实施例方法中的全部或部分流程，也可以通过计算机程序来指令相关的硬件来完成，所述的计算机程序可存储于一计算机可读存储介质中，该计算机程序在被处理器执行时，可实现上述各个方法实施例的步骤。其中，所述计算机程序包括计算机程序代码，所述计算机程序代码可以为源代码形式、对象代码形式、可执行文件或某些中间形式等。本申请并不局限于上述实施方式，如果对本申请的各种改动或变形不脱离本申请的精神和范围，倘若这些改动和变形属于本申请的权利要求和等同技术范围之内，则本申请也意图包含这些改动和变形。
