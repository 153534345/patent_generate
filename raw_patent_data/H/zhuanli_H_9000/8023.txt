标题title
一种汽车网络安全检测的测试用例生成方法、系统和设备
摘要abst
本发明提供的一种汽车网络安全检测的测试用例生成方法、系统和设备，主要针对于汽车网络安全的法规检测，适用于基于汽车网络安全开发流程的汽车安全性检测认证；该发明通过风险的影响参数拆分，构建攻击向量，以确定对于整车风险贡献最大的向量值；通过主成分分析将攻击向量进行降维，实现了分析的快速和可操作性；通过聚类分析并在每一类中通过卡方分析，构建每一类的主要影响风险，形成风险集合；依托风险集合构建攻击路径和测试用例，实现了检测的测试用例构建。本发明采用的实现整车级网络安全的用例构建方案能够以最少的成本获得整车的风险率贡献率最高的风险，从而实现低成本快速测试，适用于整车级的检测认证测试。
权利要求书clms
1.一种汽车网络安全检测的测试用例生成方法，其特征在于，包括：输入被检测车辆的概念层的风险评估结果，对所述风险评估结果的多维度信息构建风险评估结果的攻击向量；对所述攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对所述攻击向量类簇进行均值计算，获得聚类特征向量均值；将所述攻击向量与对应类的所述聚类特征向量均值进行卡方检验，得到风险匹配项集合；将风险匹配集合中对应的攻击方式构建成作用于所述被检测车辆的攻击测试用例集。2.如权利要求1所述的一种汽车网络安全检测的测试用例生成方法，其特征在于，所述输入被检测车辆的概念层的风险评估结果，对所述风险评估结果的多维度信息构建风险评估结果的攻击向量，具体包括：所述风险评估结果为由TARA报告提取的检测数据项；所述多维度信息包括所述风险评估结果的危害影响等级、攻击可行性和风险值；所述攻击向量基于所述风险评估结果中的多维度信息的信息值构建三元组向量。3.如权利要求1所述的一种汽车网络安全检测的测试用例生成方法，其特征在于，所述对所述攻击向量进行聚类分析前，还包括：对所述攻击向量进行主成分分析，进行所述攻击向量的向量值降维处理，获得降维后的关键攻击向量；所述对所述攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对所述攻击向量类簇进行均值计算，获得聚类特征向量均值，具体包括：对所述关键攻击向量进行聚类分析；所述聚类分析时采用K-均值聚类方法；所述聚类分析后，至少得到内部接口、物理连接口、近程通信、外部通信的攻击向量类簇；对每一个所述攻击向量类簇进行均值计算，获得每一类所述攻击向量类簇的向量均值。4.如权利要求1所述的一种汽车网络安全检测的测试用例生成方法，其特征在于，所述将所述攻击向量与对应类的所述聚类特征向量均值进行卡方检验，得到风险匹配项集合，包括：将所述攻击向量与对应类的所述聚类特征向量均值进行卡方检验，得到卡方值；当所述卡方值小于差异阈值时，将所述攻击向量对应的风险评估结果列为风险匹配项，否则丢弃所述攻击向量；当所有的所述攻击向量均完成卡方检验后，将所有的风险匹配项形成风险匹配集合。5.如权利要求1所述的一种汽车网络安全检测的测试用例生成方法，其特征在于，所述将风险匹配集合中对应的攻击方式构建成作用于所述被检测车辆的攻击测试用例集，具体包括：提取所述风险匹配集合中的每一个攻击向量，得到所述攻击向量的攻击路径；对所述攻击路径进行语义处理，得到攻击步骤，将所述攻击步骤进行汇总，得到测试用例集。6.一种汽车网络安全检测的测试用例生成系统，其特征在于，包括：向量构建模块，输入被检测车辆的概念层的风险评估结果，对所述风险评估结果的多维度信息构建风险评估结果的攻击向量；聚类模块，对所述攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对所述攻击向量类簇进行均值计算，获得聚类特征向量均值；卡方检验模块，将所述攻击向量与对应类的所述聚类特征向量均值进行卡方检验，得到风险匹配项集合；测试用例构建模块，将风险匹配集合中对应的攻击方式构建成作用于所述被检测车辆的攻击测试用例集。7.如权利要求6所述的一种汽车网络安全检测的测试用例生成系统，其特征在于，所述向量构建模块中还包括：所述风险评估结果为由TARA报告提取的检测数据项；所述多维度信息包括所述风险评估结果的危害影响等级、攻击可行性和风险值；所述攻击向量基于所述风险评估结果中的多维度信息的信息值构建三元组向量。8.如权利要求6所述的一种汽车网络安全检测的测试用例生成系统，其特征在于，所述系统还包括：降维模块，对所述攻击向量进行主成分分析，进行所述攻击向量的向量值降维处理，获得降维后的关键攻击向量；所述聚类模块，还包括：对所述关键攻击向量进行聚类分析；所述聚类分析时采用K-均值聚类方法；所述聚类分析后，至少得到内部接口、物理连接口、近程通信、外部通信的攻击向量类簇；对每一个所述攻击向量类簇进行均值计算，获得每一类所述攻击向量类簇的向量均值。9.如权利要求6所述的一种汽车网络安全检测的测试用例生成系统，其特征在于，所述卡方检验模块还包括：将所述攻击向量与对应类的所述聚类特征向量均值进行卡方检验，得到卡方值；当所述卡方值小于差异阈值时，将所述攻击向量对应的风险评估结果列为风险匹配项，否则丢弃所述攻击向量；当所有的所述攻击向量均完成卡方检验后，将所有的风险匹配项形成风险匹配集合；所述测试用例构建模块，还包括：提取所述风险匹配集合中的每一个攻击向量，得到所述攻击向量的攻击路径；对所述攻击路径进行语义处理，得到攻击步骤，将所述攻击步骤进行汇总，得到测试用例集。10.一种设备，包括：存储器，处理器，通过设置所述存储器，用于存储计算机可执行程序，处理器从存储器中读取部分或全部所述计算机可执行程序并执行，处理器执行部分或全部计算可执行程序时能实现权利要求1～5任一项所述一种汽车网络安全检测的测试用例生成方法。
说明书desc
技术领域本发明属于计算机技术领域，特别是针对UNECE R155法规规定的一种汽车网络安全检测的测试用例生成方法、系统和设备。背景技术网络已经让生产生活走入物联网的时代，物联网是基于互联网、传统电信网等信息承载体，让所有能够被独立寻址的普通物理对象实现互联互通的网络。可以说物联网是继计算机、互联网之后世界信息产业发展的第三次浪潮。因此越来越多的行业、企业投入到物联网技术的革新中。随着社会的飞速发展，交通越来越便捷，便利自由的私家车逐渐得到普及，汽车行业得以飞速发展，这促进了车联网以及智能网联汽车的诞生与蓬勃发展。汽车厂商们通过便捷的互联网为汽车提供更多便利、新颖的功能，从最初的汽车导航、防盗追踪，到现在热门的自动驾驶、远程升级、智能化交通管理等功能，汽车已逐步接入互联网。近年来，智能网联汽车被认为是物联网体系中最有产业潜力、市场需求最明确的领域之一，是信息化与工业化深度融合的重要方向，具有应用空间广、产业潜力大、社会效益强的特点，对促进汽车和信息通信产业创新发展，构建汽车和交通服务新模式新业态，推动自动驾驶技术创新和应用，提高交通效率和安全水平具有重要意义。但是汽车通过互联网获取便捷服务的同时，也承担着网络攻击的安全风险。对于网络安全而言，每一个新的服务和功能都会引入额外的风险和入口点。使用联网车辆和智能移动服务的增长，越来越多的网络、欺诈和数据泄露事件，这将威胁着这企业和消费者。黑客们可以通过网络入侵汽车，扰乱车内通信网络，甚至通过解析车内网络通信协议以实现远程控制汽车。在过去的10年里，汽车网络安全事件的数量一直在急剧增加。随着越来越多的联网车辆上路行驶，每一起事故的潜在损害都在上升，将汽车厂商和消费者置于危险之中。发明内容为了解决当前网络汽车的测试用例不科学、测试内容不全面客观的缺陷，本发明请求保护一种汽车网络安全检测的测试用例生成方法、系统和设备。根据本发明第一方面，本发明请求保护一种汽车网络安全检测的测试用例生成方法，其特征在于，包括：输入被检测车辆的概念层的风险评估结果，对风险评估结果的多维度信息构建风险评估结果的攻击向量；对攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对攻击向量类簇进行均值计算，获得聚类特征向量均值；将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到风险匹配项集合；将风险匹配集合中对应的攻击方式构建成作用于被检测车辆的攻击测试用例集。进一步地，输入被检测车辆的概念层的风险评估结果，对风险评估结果的多维度信息构建风险评估结果的攻击向量，具体包括：风险评估结果为由TARA报告提取的检测数据项；多维度信息包括风险评估结果的危害影响等级、攻击可行性和风险值；攻击向量基于风险评估结果中的多维度信息的信息值构建三元组向量。进一步地，对攻击向量进行聚类分析前，还包括：对攻击向量进行主成分分析，进行攻击向量的向量值降维处理，获得降维后的关键攻击向量；进一步地，对攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对攻击向量类簇进行均值计算，获得聚类特征向量均值，具体包括：对关键攻击向量进行聚类分析；聚类分析时采用K-均值聚类方法；聚类分析后，至少得到内部接口、物理连接口、近程通信、外部通信的攻击向量类簇；对每一个攻击向量类簇进行均值计算，获得每一类攻击向量类簇的向量均值。进一步地，将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到风险匹配项集合，包括：将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到卡方值；当卡方值小于差异阈值时，将攻击向量对应的风险评估结果列为风险匹配项，否则丢弃攻击向量；当所有的攻击向量均完成卡方检验后，将所有的风险匹配项形成风险匹配集合。进一步地，将风险匹配集合中对应的攻击方式构建成作用于被检测车辆的攻击测试用例集，具体包括：提取风险匹配集合中的每一个攻击向量，得到攻击向量的攻击路径；对攻击路径进行语义处理，得到攻击步骤，将攻击步骤进行汇总，得到测试用例集。根据本发明第二方面，本发明请求保护一种汽车网络安全检测的测试用例生成系统，其特征在于，包括：向量构建模块，输入被检测车辆的概念层的风险评估结果，对风险评估结果的多维度信息构建风险评估结果的攻击向量；聚类模块，对攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对攻击向量类簇进行均值计算，获得聚类特征向量均值；卡方检验模块，将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到风险匹配项集合；测试用例构建模块，将风险匹配集合中对应的攻击方式构建成作用于被检测车辆的攻击测试用例集。进一步地，向量构建模块中还包括：风险评估结果为由TARA报告提取的检测数据项；多维度信息包括风险评估结果的危害影响等级、攻击可行性和风险值；攻击向量基于风险评估结果中的多维度信息的信息值构建三元组向量。进一步地，系统还包括：降维模块，对攻击向量进行主成分分析，进行攻击向量的向量值降维处理，获得降维后的关键攻击向量；聚类模块，还包括：对关键攻击向量进行聚类分析；聚类分析时采用K-均值聚类方法；聚类分析后，至少得到内部接口、物理连接口、近程通信、外部通信的攻击向量类簇；对每一个攻击向量类簇进行均值计算，获得每一类攻击向量类簇的向量均值。进一步地，卡方检验模块还包括：将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到卡方值；当卡方值小于差异阈值时，将攻击向量对应的风险评估结果列为风险匹配项，否则丢弃攻击向量；当所有的攻击向量均完成卡方检验后，将所有的风险匹配项形成风险匹配集合；测试用例构建模块，还包括：提取风险匹配集合中的每一个攻击向量，得到攻击向量的攻击路径；对攻击路径进行语义处理，得到攻击步骤，将攻击步骤进行汇总，得到测试用例集。根据本发明第三方面，本发明还请求保护一种设备，包括：存储器，处理器，通过设置存储器，用于存储计算机可执行程序，处理器从存储器中读取部分或全部计算机可执行程序并执行，处理器执行部分或全部计算可执行程序时能实现一种汽车网络安全检测的测试用例生成方法。本发明提供的一种汽车网络安全检测的测试用例生成方法、系统和设备，主要针对于汽车网络安全的法规检测，适用于基于汽车网络安全开发流程的汽车安全性检测认证；该发明通过风险的影响参数拆分，构建攻击向量，以确定对于整车风险贡献最大的向量值；通过主成分分析将攻击向量进行降维，实现了分析的快速和可操作性；通过聚类分析并在每一类中通过卡方分析，构建每一类的主要影响风险，形成风险集合；依托风险集合构建攻击路径和测试用例，实现了检测的测试用例构建。本发明采用的实现整车级网络安全的用例构建方案能够以最少的成本获得整车的风险率贡献率最高的风险，从而实现低成本快速测试，适用于整车级的检测认证测试。附图说明图1为本发明所涉及的一种汽车网络安全检测的测试用例生成方法的第一工作流程图；图2为本发明所涉及的一种汽车网络安全检测的测试用例生成方法的第二工作流程图；图3为本发明所涉及的一种汽车网络安全检测的测试用例生成方法的第三工作流程图；图4为本发明所涉及的一种汽车网络安全检测的测试用例生成系统的结构模块图；图5为本发明所涉及的一种设备的系统结构图。具体实施方式下面将参照附图更详细地描述本公开的示例性实施例。可以理解，本申请所使用的的术语“第一”、“第二”等可在本文本中用于描述各种元件，但除非特别说明，这些元件不受这些术语限制。这些术语仅用于将第一个元件与另外一个元件区分。虽然附图中显示了本公开的示例性实施例，然而应当理解，可以以各种形式实现本公开而不应被这里阐述的实施例所限制。相反，提供这些实施例是为了能够更透彻地理解本公开，并且能够将本公开的范围完整的传达给本领域的技术人员。WP29发布了UNECE第155号法规《汽车网络安全管理系统与网络安全》，欧盟、日本等对新车型强制实施。我国也正在制定强制性标准《汽车整车信息安全技术要求与试验方法》，其架构和核心内容与R155相同。在国际、国内法规标准的要求下，企业车辆出口面临网络安全检测认证的考验。目前我国自主品牌企业具有较大的汽车出口量，后续车辆出口将成为我国汽车产业发展的方向之一。但是随着R155的实施，要求出口欧盟的车必须有网络安全认证，其中包含了体系认证和车型网络安全认证。目前德国、荷兰等国家已经发布了实施细则，针对R155的要求，还欠缺网络安全测试用例构建方法。本发明的目的是提供一种汽车网络安全检测的测试用例生成方法，以解决上述现有技术存在的问题，可满足汽车企业、零部件厂商、汽车检测机构等在汽车网络安全测试中的测试用例生成。根据本发明第一实施例，参照附图1，本发明请求保护一种汽车网络安全检测的测试用例生成方法，其特征在于，包括步骤：S101:输入被检测车辆的概念层的风险评估结果，对风险评估结果的多维度信息构建风险评估结果的攻击向量；S102:对攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对攻击向量类簇进行均值计算，获得聚类特征向量均值；S103:将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到风险匹配项集合；S104:将风险匹配集合中对应的攻击方式构建成作用于被检测车辆的攻击测试用例集。进一步地，步骤S101具体包括：风险评估结果为由TARA报告提取的检测数据项；多维度信息包括风险评估结果的危害影响等级、攻击可行性和风险值；攻击向量基于风险评估结果中的多维度信息的信息值构建三元组向量。其中，风险评估结果至少包含攻击路径、威胁场景、风险值、攻击可行性、攻击方式；在该实施例中，使用被检测车辆在开发过程中的风险评估结果，对风险评估结果的资产价值、影响值、攻击值以及风险预置值进行聚类分析。其中，资产价值按照概念设计中对车辆安全、节能、环保、防盗的贡献值确定资产价值向量；影响值在进行聚类前按照内部接口、物理连接口、近程通信、外部通信四个方面构建影响值向量；攻击可行性依据攻击向量、攻击复杂性、权限要求和用户交互构建攻击可行性向量。优先的，影响值包含威胁场景，专业知识、产品公开性、机会窗口、攻击装备、威胁等级、功能安全、财务损失、可操作性、隐私法规等选项。进一步地，步骤S102前，还包括：S1020:对攻击向量进行主成分分析，进行攻击向量的向量值降维处理，获得降维后的关键攻击向量；其中，主成分分析采用如下步骤计算：设有 m 个 n 维攻击向量样本 ，我们的目标是将原始攻击向量数据降到k 维，然后用降维后的数据去完成聚类分析。先将攻击向量按列组成n行m列矩阵X，然后X 中每一维数据都减去该维的均值得到 X’。计算样本的协方差矩阵 。求出协方差矩阵的特征值及对应的特征向量。将特征向量按对应特征值大小从上到下按行排列成矩阵，取前k 行组成矩阵P。Y=PY即为降维到k维后的攻击向量数据。进一步地，参照图2，步骤S102，具体包括：S1021:对关键攻击向量进行聚类分析；聚类分析时采用K-均值聚类方法；S1022:聚类分析后，至少得到内部接口、物理连接口、近程通信、外部通信的攻击向量类簇；S1023:对每一个攻击向量类簇进行均值计算，获得每一类攻击向量类簇的向量均值。其中，聚类分析算法采用的K-均值聚类算法是迭代求解聚类分析算法，其步骤是随机选取A个攻击向量作为初始的聚类中心，然后计算每个攻击向量与各个种子聚类中心之间的距离，把每个攻击向量分配给距离它最近的聚类中心。聚类中心以及分配给它们的攻击向量就代表一个聚类。每分配一个样本，聚类的聚类中心会根据聚类中现有的攻击向量被重新计算，该过程将不断重复直到满足某个终止条件。终止条件可以是没有攻击向量被重新分配给不同的聚类，没有聚类中心再发生变化，误差平方和局部最小。进一步地，参照附图3，步骤S103，包括：S1031:将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到卡方值；S1032:当卡方值小于差异阈值时，将攻击向量对应的风险评估结果列为风险匹配项，否则丢弃攻击向量；S1033:当所有的攻击向量均完成卡方检验后，将所有的风险匹配项形成风险匹配集合。卡方检验基本公式：式中：K为类别的数目；是攻击向量值；是特征向量均值；M是约束条件数或利用观察数据时使用的样本统计量的数目。设定差异阈值为0.1；具体的，计算攻击向量和聚类特征向量均值的卡方系数，当卡方系数小于0.1时，表明该攻击向量和对应类的类簇的向量均值的相似度高，则该项风险对应的攻击路径设置为该簇的测试用例，各个簇形成的测试用例集即为构建的测试用例集进一步地，步骤S104，具体包括：S1041:提取风险匹配集合中的每一个攻击向量，得到攻击向量的攻击路径；S1042:对攻击路径进行语义处理，得到攻击步骤，将攻击步骤进行汇总，得到测试用例集。在本实施例中，对所涉及的部分攻击向量的攻击路径和针对威胁进行示例阐述：攻击向量1：威胁描述：通过网络攻击或ECU攻击，篡改身份和配置数据；攻击路径：车辆的身份和配置信息被非法进行篡改，车辆功能在非正常情况下的变更；攻击路径实例：Ecall号码或联系电话号码被篡改，紧急电话无法建立连接，无法进行及时的救援。攻击向量2：威胁描述：通过网络攻击或ECU攻击，移除身份和配置数据；攻击路径：车辆的身份和配置信息无法获取或使用，造成车辆基础功能的丧失；攻击路径实例：Ecall号码或联系电话号码被删除，造成紧急电话无法建立连接，无法进行及时的救援。攻击向量3：威胁描述：通过网络攻击或ECU攻击，获取程序和算法信息；攻击路径：零部件固件和应用被未经授权的攻击者获取，知识产权以及车辆功能等损失；攻击路径实例：通过刷新手段攻击者非法获取固件或应用程序，了解内部算法设计和代码实现。攻击向量4：威胁描述：通过网络攻击或ECU攻击，篡改车辆控制程序和应用；攻击路径：零部件固件和应用被攻击者非法篡改，车辆功能被攻击者劫持；攻击路径实例：攻击者对Ecall固件进行篡改，更改功能，直接影响车辆的行驶安全。攻击向量5：威胁描述：通过网络攻击或ECU攻击，移除车辆控制程序或应用；攻击路径：零部件固件和应用无法获取或使用，造成ECU无法升级或应用功能异常；攻击路径实例：攻击者对Ecall固件进行删除，Ecall功能无法实现，紧急电话无法接通，救援无法及时进行。攻击向量6：威胁描述：通过网络攻击或ECU攻击，获取车辆或用户数据；攻击路径：车辆数据和用户数据被未经授权的攻击者获取，造成车主或车厂损失；攻击路径实例：Ecall功能日志信息被非法用户获取，攻击者可以掌握发生紧急状况时日志的内容。攻击向量7：威胁描述：通过网络攻击或ECU攻击，篡改车辆或用户数据；攻击路径：车辆数据和用户数据被攻击者非法篡改，造成相关信息无法追溯，或相关功能无法正常使用；攻击路径实例：车辆位置信息被非法更改，车辆寻址错误；日志信息被非法篡改，车辆问题取证错误。攻击向量8：威胁描述：通过网络攻击或ECU攻击，篡改车辆或用户数据；攻击路径：车辆数据和用户数据无法获取或使用，相关信息、功能无法追溯、使用；攻击路径实例：Ecall功能日志被非法删除，导致事件调查时无相关数据。攻击向量9：威胁描述：通过网络攻击或ECU攻击，篡改通信指令和信号；攻击路径：车辆控制指令和车辆状态信息被攻击者非法篡改，相关功能被攻击者劫持；攻击路径实例：攻击者对Ecall传送的信息进行篡改，比如定位信息，导致定位错误。攻击向量10：威胁描述：通过网络攻击或ECU攻击，阻断通信指令和信号；攻击路径：车辆控制指令和车辆状态信息无法获取或使用，相关功能无法正常使用；攻击路径实例：攻击者对通讯网络进行攻击，Ecall的通讯无法进行连接，救援无法及时进行。攻击向量11：威胁描述：通过网络攻击或ECU攻击，篡改身份和配置数据；攻击路径：车辆的身份和配置信息被非法进行篡改，车辆功能在非正常情况下的变更；攻击路径实例：智能驾驶配置参数的篡改，造成车厂销售经济损失，并带来潜在的索赔可能。攻击向量12：威胁描述：通过网络攻击或ECU攻击，移除身份和配置数据；攻击路径：车辆的身份和配置信息无法获取或使用，造成车辆基础功能的丧失；攻击路径实例：对智能驾驶配置参数的擦除，造成车辆无法启动或功能无法发生。攻击向量13：威胁描述：通过网络攻击或ECU攻击，获取程序和算法信息；攻击路径：零部件固件和应用被未经授权的攻击者获取，在知识产权以及车辆功能等方面的损失；攻击路径实例：攻击者非法获取智能辅助驾驶的固件，逆向获得相关算法，企业知识产权损失。攻击向量14：威胁描述：通过网络攻击或ECU攻击，篡改车辆控制程序和应用；攻击路径：零部件固件和应用被攻击者非法篡改，造成车辆功能被攻击者劫持；攻击路径实例：攻击者对智能辅助驾驶的固件进行篡改，直接影响车辆的安全驾驶。攻击向量15：威胁描述：通过网络攻击或ECU攻击，移除车辆控制程序或应用；攻击路径：零部件固件和应用无法获取或使用，造成ECU无法升级或应用功能异常；攻击路径实例：攻击者对智能驾驶辅助功能的固件和应用作了删除，车辆智能辅助驾驶功能无法使用。攻击向量16：威胁描述：通过网络攻击或ECU攻击，获取车辆或用户数据；攻击路径：车辆数据和用户数据被未经授权的攻击者获取，造成车主或车厂损失；攻击路径实例：自动驾驶的日志信息被非法用户获取，片面或不准确解读，车辆事故场景的错误责任和赔偿判别。在该实施例的具体应用场景中，某车型的项目中输出TARA报告，其中包含TARA的检测数据项为91个，每个条目包含风险评估结果的影响等级、攻击可行性和风险结果三个数值，由这三个数值的顺序组成这个风险评估结果的攻击向量，例如ecall的第一条风险评估结果的攻击向量为，ecall第二条风险评估结果的攻击向量为;91个风险评估结果条目组成本次部件的攻击向量。对91个攻击向量进行K-均值聚类分析，将91个攻击向量条目分成四个大类，第一类32个攻击向量条目，第二类41个攻击向量条目，第三类11个攻击向量条目，第四类7个攻击向量条目。对每一类计算攻击向量均值，第一类均值为,第二类均值为，第三类均值为，第四类为。四类每一类的攻击向量分别与各自类的向量均值进行卡方检验。例如第一类第一个攻击向量条目与第一类均值进行卡方检验，卡方值如果小于0.1则认为第一个攻击向量条目为可选风险项目。将此风险项目的攻击路径方法转化为测试用例。待第一类卡方完成后，形成第一类的测试用例子集。四类测试用例子集构建完成后形成车型测试用例集。以下给出了部分攻击向量的TARA报告风险评估结果内容：攻击向量1：Impactrating：Medium；TargetThreatFeasibility：VeryLow；Riskvalue：Low；攻击向量2：Impactrating：Medium；TargetThreatFeasibility：VeryLow；Riskvalue：Low；攻击向量3：Impactrating：Low；TargetThreatFeasibility：Medium；Riskvalue：Low；攻击向量4：Impactrating：High；TargetThreatFeasibility：VeryLow；Riskvalue：Medium；攻击向量5：Impactrating：High；TargetThreatFeasibility：VeryLow；Riskvalue：Medium；攻击向量6：Impactrating：Low；TargetThreatFeasibility：Medium；Riskvalue：VeryLow；攻击向量7：Impactrating：Low；TargetThreatFeasibility：Medium；Riskvalue：VeryLow；攻击向量8：Impactrating：Low；TargetThreatFeasibility：Medium；Riskvalue：VeryLow；攻击向量9：Impactrating：Low；TargetThreatFeasibility：Medium；Riskvalue：VeryLow；攻击向量10：Impactrating：Low；TargetThreatFeasibility：Medium；Riskvalue：VeryLow；攻击向量11：Impactrating：Medium；TargetThreatFeasibility：VeryLow；Riskvalue：Low；攻击向量12：Impactrating：Medium；TargetThreatFeasibility：VeryLow；Riskvalue：Low；攻击向量13：Impactrating：Low；TargetThreatFeasibility：Medium；Riskvalue：VeryLow；攻击向量14：Impactrating：Critical；TargetThreatFeasibility：VeryLow；Riskvalue：High；攻击向量15：Impactrating：Medium；TargetThreatFeasibility：VeryLow；Riskvalue：Low；攻击向量16：Impactrating：High；TargetThreatFeasibility：VeryLow；Riskvalue：Medium。根据本发明第二实施例，参照附图4，本发明请求保护一种汽车网络安全检测的测试用例生成系统，其特征在于，包括：向量构建模块100，输入被检测车辆的概念层的风险评估结果，对风险评估结果的多维度信息构建风险评估结果的攻击向量；聚类模块200，对攻击向量进行聚类分析，获取聚类后的攻击向量类簇并对攻击向量类簇进行均值计算，获得聚类特征向量均值；卡方检验模块300，将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到风险匹配项集合；测试用例构建模块400，将风险匹配集合中对应的攻击方式构建成作用于被检测车辆的攻击测试用例集。进一步地，向量构建模块100中还包括：风险评估结果为由TARA报告提取的检测数据项；多维度信息包括风险评估结果的危害影响等级、攻击可行性和风险值；攻击向量基于风险评估结果中的多维度信息的信息值构建三元组向量。进一步地，系统还包括：降维模块，对攻击向量进行主成分分析，进行攻击向量的向量值降维处理，获得降维后的关键攻击向量；聚类模块200，还包括：对关键攻击向量进行聚类分析；聚类分析时采用K-均值聚类方法；聚类分析后，至少得到内部接口、物理连接口、近程通信、外部通信的攻击向量类簇；对每一个攻击向量类簇进行均值计算，获得每一类攻击向量类簇的向量均值。进一步地，卡方检验模块300还包括：将攻击向量与对应类的聚类特征向量均值进行卡方检验，得到卡方值；当卡方值小于差异阈值时，将攻击向量对应的风险评估结果列为风险匹配项，否则丢弃攻击向量；当所有的攻击向量均完成卡方检验后，将所有的风险匹配项形成风险匹配集合；测试用例构建模块400，还包括：提取风险匹配集合中的每一个攻击向量，得到攻击向量的攻击路径；对攻击路径进行语义处理，得到攻击步骤，将攻击步骤进行汇总，得到测试用例集。根据本发明第三实施例，参照图5，本发明还请求保护一种设备900，包括：存储器901，处理器902，通过设置存储器901，用于存储计算机可执行程序，处理器902从存储器901中读取部分或全部计算机可执行程序并执行，处理器902执行部分或全部计算可执行程序时能实现一种汽车网络安全检测的测试用例生成方法。本领域技术人员能够理解，本公开所披露的内容可以出现多种变型和改进。例如，以上所描述的各种设备或组件可以通过硬件实现，也可以通过软件、固件、或者三者中的一些或全部的组合实现。本公开中使用了流程图用来说明根据本公开的实施例的方法的步骤。应当理解的是，前面或后面的步骤不一定按照顺序来精确的进行。相反，可以按照倒序或同时处理各种步骤。同时，也可以将其他操作添加到这些过程中。本领域普通技术人员可以理解上述方法中的全部或部分的步骤可通过计算机程序来指令相关硬件完成，程序可以存储于计算机可读存储介质中，如只读存储器、磁盘或光盘等。可选地，上述实施例的全部或部分步骤也可以使用一个或多个集成电路来实现。相应地，上述实施例中的各模块/单元可以采用硬件的形式实现，也可以采用软件功能模块的形式实现。本公开并不限制于任何特定形式的硬件和软件的结合。除非另有定义，这里使用的所有术语具有与本公开所属领域的普通技术人员共同理解的相同含义。还应当理解，诸如在通常字典里定义的那些术语应当被解释为具有与它们在相关技术的上下文中的含义相一致的含义，而不应用理想化或极度形式化的意义来解释，除非这里明确地这样定义。以上是对本公开的说明，而不应被认为是对其的限制。尽管描述了本公开的若干示例性实施例，但本领域技术人员将容易地理解，在不背离本公开的新颖教学和优点的前提下可以对示例性实施例进行许多修改。因此，所有这些修改都意图包含在权利要求书所限定的本公开范围内。应当理解，上面是对本公开的说明，而不应被认为是限于所公开的特定实施例，并且对所公开的实施例以及其他实施例的修改意图包含在所附权利要求书的范围内。本公开由权利要求书及其等效物限定。在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示意性实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不一定指的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任何的一个或多个实施例或示例中以合适的方式结合。尽管已经示出和描述了本发明的实施例，本领域的普通技术人员可以理解：在不脱离本发明的原理和宗旨的情况下可以对这些实施例进行多种变化、修改、替换和变型，本发明的范围由权利要求及其等同物限定。
