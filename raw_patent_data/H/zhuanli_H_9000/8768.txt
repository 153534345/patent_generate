标题title
一种基于优先级动态调整的共享策略验证与冲突检测方法
摘要abst
本发明提出了一种基于优先级动态调整的共享策略验证与冲突检测方法，根据数据共享请求涉及到的信息字段设计合理的共享规则格式，以规则为基础构建数据共享策略；再根据实时接收的数据共享请求和共享规则匹配情况，重新计算相关规则的优先级，根据规则优先级动态调整规则匹配顺序；根据被请求数据的类型获取策略对应的规则，根据所述规则和默认操作对数据共享请求进行匹配验证；最后进行共享策略冲突检测，对有策略冲突的新增或修改规则不予执行，实现了面向策略的匹配优化和冲突检测算法，解决了大量无序规则导致的响应时间过长和多次请求结果冲突的问题，增强了数据共享过程中的安全性和稳定性。
权利要求书clms
1.一种基于优先级动态调整的共享策略验证与冲突检测方法，其特征在于，包括如下步骤：S1，共享规则格式设计：根据数据共享请求涉及到的信息字段数据设计合理的共享规则格式，以规则为基础构建数据共享策略；所述共享规则至少包括优先级priority、规则匹配条件match、匹配动作action和规则状态status；S2，规则优先级动态调整：根据实时接收的数据共享请求和共享规则匹配情况，重新计算相关规则的优先级priority，根据规则优先级动态调整规则匹配顺序；所述优先级priority由规则的匹配总次数matchTimes和最近匹配时间matchLast决定，每一次规则被匹配后都需要动态调整,优先级priority计算公式为：priority＝w*+*其中，al lmatch表示当前已经接收过的数据共享请求数量；w表示mathchTimes对优先级的影响权重；S3，共享策略验证：根据被请求数据的类型获取策略对应的规则，根据所述规则和默认操作对数据共享请求进行匹配验证；S4，共享策略冲突检测：对所有新增或者修改的共享规则，与已存在的所有规则进行比对判断，检测是否存在策略冲突，若存在策略冲突，新增或修改的共享规则失败；否则，新增或修改共享规则；所述策略冲突包括但不限于规则冗余和规则冲突。2.如权利要求1所述的一种基于优先级动态调整的共享策略验证与冲突检测方法，其特征在于：所述步骤S1中，信息字段数据包括但不限于：源物联网平台、目的物联网平台、共享资源类型、资源安全级别、安全运算符、是否启用、匹配动作、匹配次数、最近匹配时间及优先级。3.如权利要求1所述的一种基于优先级动态调整的共享策略验证与冲突检测方法，其特征在于：所述步骤S1的共享规则中，所述规则匹配条件至少包括源物联网平台、目的物联网平台、共享资源类型、资源安全级别和安全运算符；所述匹配动作为accept或者deny，当数据共享请求满足规则匹配条件后，执行accept；若共享规则在创建时未设置action的值或当数据共享请求与所有规则都不匹配时，默认执行deny动作；所述规则状态取值为true或者false，分别表示在数据共享请求进行共享策略验证时是否启用该规则，不启用则无需计算该共享规则的优先级，无需与数据请求进行匹配；若某共享规则在创建时未设置status的值，默认启用该规则。4.如权利要求2或3所述的一种基于优先级动态调整的共享策略验证与冲突检测方法，其特征在于：所述步骤S2中，按优先级顺序对数据共享请求进行规则匹配，若匹配成功，更新全局变量al lmatch，更新规则的匹配总次数matchTimes和最近匹配时间matchLast，继续计算新的优先级prioity；若匹配全部失败则不进行优先级调整。5.如权利要求4所述的一种基于优先级动态调整的共享策略验证与冲突检测方法，其特征在于：所述步骤S3进一步包括：S31:根据被请求数据的类型对数据共享请求进行分类，获取针对该类别数据的共享策略，所述共享策略包括规则和默认动作；S32:根据步骤S2，对该类型下的共享规则按优先级降序排列；S33:对不同物联网平台间的数据共享请求进行共享策略匹配，若匹配成功则执行对应的动作，否则执行默认动作；S34:根据步骤S33的动作类型判断该请求进行共享策略验证是否成功。6.如权利要求5所述的一种基于优先级动态调整的共享策略验证与冲突检测方法，其特征在于：所述步骤S4中，通过判断规则匹配条件match是否部分重合来进行所有新增或者修改的共享规则与已存在的所有规则的比对判断，若无重合部分，则无策略冲突，新增或修改规则成功；若存在重合部分，且匹配动作action相同，则判断为规则冗余；若存在重合部分，但匹配动作action不同，则判断为规则冲突；规则冗余和规则冲突均指向新增或修改共享规则失败。
说明书desc
技术领域本发明属于物联网数据交换共享技术领域，涉及一种基于优先级动态调整的共享策略验证与冲突检测方法。背景技术随着信息化技术的高速发展，物联网平台对数据的需求日益增加，不同物联网平台之间的数据交互日趋复杂，数据跨域共享在不同物联网平台的构建和使用中发挥出重要的作用。数据的跨域授权共享能有效的解决数据滥用和隐私泄露等数据安全问题，在不同物联网平台数据跨域共享过程中，核心问题之一便是如何进行共享策略验证和冲突检测，以保证共享数据在数据供应方安全许可范围内被传输。传统的共享策略验证与冲突检测方法基于多条安全规则，系统通过安全规则对数据共享请求进行匹配，筛选出符合安全设定的共享请求，在共享请求验证时需逐条对比规则，直到请求匹配成功或所有规则都匹配失败而进入默认操作。但是当共享策略中设定的规则数量过多时，每一次逐条匹配规则都会消耗大量的时间，从而降低了共享策略验证的执行效率。因此，设计合理的数据共享策略验证与冲突检测方法，是进行物联网平台跨域数据共享的关键问题之一。发明内容本发明正是针对多个物联网平台进行数据跨域授权共享时面临的共享权限与权限安全问题，提出了一种基于优先级动态调整的共享策略验证与冲突检测方法，包括共享负责格式设计、规则优先级动态调整、共享策略验证及共享策略冲突检测四个步骤，根据数据共享请求涉及到的信息字段设计合理的共享规则格式，以规则为基础构建数据共享策略；再根据实时接收的数据共享请求和共享规则匹配情况，重新计算相关规则的优先级，根据规则优先级动态调整规则匹配顺序；随后，根据被请求数据的类型获取策略对应的规则，根据所述规则和默认操作对数据共享请求进行匹配验证；最后进行共享策略冲突检测，对有策略冲突的新增或修改规则不予执行，实现了面向策略的匹配优化和冲突检测算法，解决了大量无序规则导致的响应时间过长和多次请求结果冲突的问题，增强了数据共享过程中的安全性和稳定性。为了实现上述目的，本发明采取的技术方案是：一种基于优先级动态调整的共享策略验证与冲突检测方法，包括如下步骤：S1，共享规则格式设计：根据数据共享请求涉及到的信息字段数据设计合理的共享规则格式，以规则为基础构建数据共享策略；所述共享规则至少包括优先级priority、规则匹配条件match、匹配动作action和规则状态status；S2，规则优先级动态调整：根据实时接收的数据共享请求和共享规则匹配情况，重新计算相关规则的优先级priority，根据规则优先级动态调整规则匹配顺序；所述优先级priority由规则的匹配总次数matchTimes和最近匹配时间matchLast决定，每一次规则被匹配后都需要动态调整,优先级priority计算公式为：priority＝w*+*其中，allmatch表示当前已经接收过的数据共享请求数量；w表示mathchTimes对优先级的影响权重；S3，共享策略验证：根据被请求数据的类型获取策略对应的规则，根据所述规则和默认操作对数据共享请求进行匹配验证；S4，共享策略冲突检测：对所有新增或者修改的共享规则，与已存在的所有规则进行比对判断，检测是否存在策略冲突，若存在策略冲突，新增或修改的共享规则失败；否则，新增或修改共享规则；所述策略冲突包括但不限于规则冗余和规则冲突。与现有技术相比，本发明提供了充分考虑了匹配次数和匹配时间对共享策略验证和冲突检测的影响，通过分类判断缩小了策略验证时的规则数量级，通过优先级的方式将影响量化，从而极大地缩小了共享策略的验证时间，提高了整个物联网数据跨域授权共享的运行效率。同时，本发明对于共享策略的冲突检测的实现，也增强了不同物联网平台数据跨域授权共享时的安全性。附图说明图1为本发明步骤S1中共享规则的结构组成图；图2为现有技术中无优先级的共享策略示意图；图3为本发明步骤S2中优先级动态调整的共享策略示意图；图4为本发明步骤S4共享策略冲突检测流程图。具体实施方式下面结合附图和具体实施方式，进一步阐明本发明，应理解下述具体实施方式仅用于说明本发明而不用于限制本发明的范围。实施例1本实施例中设有4个规则r1，r2，r3，r4，一种基于优先级动态调整的共享策略验证与冲突检测方法，包括如下步骤：步骤S1，共享规则格式设计。步骤S1中所述的共享规则涉及到的数据包括源物联网平台、目的物联网平台、共享资源类型、资源安全级别、安全运算符、匹配次数、最近匹配时间、优先级、匹配动作、是否启用，具体描述见下表1。表1微服务组合信息描述对表1中的部分元素进行合并操作，并提取优先级、规则匹配条件、匹配动作、规则状态组成共享规则的描述四元组，如图1所示。共享规则描述四元组格式表示为：r＝＜priority,match,action,status＞下面分别对这四个元素进行介绍。优先级：优先级决定数据共享请求在进行共享策略验证时的规则匹配顺序，由规则的匹配总次数、最近匹配时间决定，每一次规则被匹配后都需要动态调整。优先级越大，在共享策略验证时越先进行规则匹配。规则匹配条件：当规则匹配条件与数据共享请求一致或者包含数据共享请求时，则匹配成功，执行后续的匹配动作，进而判断数据共享请求在进行共享策略验证时是否成功。数据共享请求包含“源物联网平台、目的物联网平台、被请求的共享资源”的信息，在经过数据共享系统的请求筛选后，可获得被请求的共享资源的资源类型和安全级别，规则匹配条件可用如下五元组表示：源物联网平台、目的物联网平台、共享资源类型、资源安全级别、安全运算符。即：match＝＜srcPlatform,dstPaltform,resourceType,safeLevel,opereation＞其中，match为规则匹配条件。operation包含“大于、大于等于、等于、小于等于、小于”五种选择。资源安全级别包含最大、最小的范围限定，即safeLevel∈。五元组中，以safeLevel为起始点，operation为运算符可以用来确定资源安全级别的范围。如safeLevel＝3，operation＝‘＞’,表示在源物联网平台、目的物联网平台、共享资源类型一致的情况下，被请求的资源安全级别大于3即可匹配该规则，执行后续的匹配动作。匹配动作：匹配动作为accept或者deny，分别表示在数据共享请求满足规则匹配条件后接受请求或者拒绝请求。若某共享规则在创建时未设置action的值，默认为deny。当数据共享请求与所有规则都不匹配时，默认执行deny动作。规则状态：规则状态取值可以为true或者false，分别表示在数据共享请求进行共享策略验证时是否启用该规则，不启用则无需计算该共享规则的优先级，无需与数据请求进行匹配。若某共享规则在创建时未设置status的值，默认启用该规则。步骤S2，规则优先级动态调整。规则的优先级由规则匹配总次数matchTimes和最近匹配时间matchLast共同决定。整个系统为共享策略维持一个整型变量：allmatch，表示当前已经接收过的数据共享请求数量。数据共享请求在共享规则中匹配成功时，匹配成功的规则matchTimes自增，allmatch自增，同时该规则的matchLast更新为allmatch，表示为最新的规则匹配序号。数据共享请求进行规则匹配成功，共享规则的matchTimes和matchLast需要进行修改，同时重新计算priority。priority的计算公式是：priority＝w*+*其中，w表示规则匹配总次数对优先级的影响权重，w可以根据具体的使用场景进行赋值。在本方法运用的数据共享策略匹配环境下，w设置为0.6，表示在优先级计算中，匹配次数的权重为60％，最近匹配时间的权重为40％。此外，matchTimes和matchLast都除以allmatch是为了对数据进行归一化处理，将matchTimes和matchLast的绝对值大小对priority的影响使用相对值体现，以处理matchTimes和matchLast过大的情况。matchTimes/allmatch表示数据共享规则被匹配到的次数占全部请求总数的比例；matchLast/allmatch表示数据共享规则被匹配到的时间越近与最新时间的相对关系。如图2所示，现有技术中无优先级的共享策略通常是依据策略中规则生成的时间进行顺序匹配，对于任意数据共享请求，所有的共享规则匹配顺序都是相同且不变的，匹配的执行时间极大程度受共享策略中规则的生成顺序影响。在同一数据数据共享请求短时间内多次出现的情况下，匹配顺序靠后将严重影响共享策略验证的执行时间，如图2中多次数据共享请求b都必须经历相同的4次匹配，三次数据共享请求一共进行了11次规则匹配。而本发明中，，优先级动态调整过程如图3所示：每次进行共享策略验证前，所有的共享规则按优先级从大到小排序；按优先级顺序对数据共享请求进行规则匹配；匹配成功，更新全局变量allmatch，更新规则的matchTimes和matchLast，计算新的prioity；匹配全部失败则不进行优先级调整。在图3中，前两次数据共享请求a、b在匹配成功后，全局变量allmatch依次更新，规则r3、r4的matchTimes与matchLast依次更新。规则r3、r4的优先级动态更新，共享策略中的规则根据更新后的优先级重新排序，近期被匹配成功的规则r3、r4的匹配顺序提前，在第二个数据共享请求b进行共享策略验证时，匹配1次成功，三次数据共享请求一共进行了8次规则匹配。步骤S3，共享策略验证。当系统接收到不同物联网平台间的数据共享请求时，会在验证被请求资源的存在性后通过被请求数据的类别对请求进行分类，获取该请求对应的共享策略。策略验证的具体方法是：数据共享请求与该类别下的共享规则匹配，若存在共享规则与之匹配，则通过对应的匹配动作为accept或者deny判断该请求是否符合系统设定的共享策略，匹配动作为accept则表示符合系统设定的不同物联网平台间的数据共享策略，验证通过；匹配动作为deny则表示该数据共享请求未通过系统的共享策略验证，对该请求返回拒绝信息。为保护不同平台间数据的安全性，每一类共享策略都会对应一个默认操作，认为在系统中的所有共享规则与数据共享请求都不匹配的情况下，执行默认操作。在非特殊设定的情况下，默认操作一般为deny，拒绝数据共享请求。步骤S4，共享策略冲突检测当数据共享策略中增加新的共享规则或者某条规则发生改变时，可能存在规则间的冗余，以规则r1，r2为例，规则r1已存在，新增规则r2会使得规则中存在冗余部分：规则r2的匹配情况完全可以被r1覆盖，r2没有单独存在的意义，同时在进行步骤3共享策略验证时会增加额外的时间消耗。r1，r2如下：r1＝＜p1,＜platform1,platform2,video,1,＞＞,accept,true＞r2＝＜p2,＜platform1,platform2,video,3,＝＞,accept,true＞此外，规则冲突的情况：以规则r1，r3为例，规则r1已存在，新增或者修改规则至r3会导致两条规则存在相悖的情况，r3如下：r3＝＜p3,＜any,platform2,video,2,＞＞,deny,true＞数据共享请求：“srcPlatform＝platform1,dstPlatform＝platform2,resourceType＝video，safeLevel＝3”在优先级p1＞p3情况下，请求与规则r1匹配成功通过共享策略验证，会转发该请求给platform2；在优先级p1＜p3情况下,请求与规则r3匹配成功拒绝该请求。由于两条规则的匹配范围存在重合部分但是匹配动作不一致，规则出现冲突，会导致同一数据共享请求因为规则优先级的变化而获得不同的返回结果，影响数据共享中的安全性和稳定性。规则冗余和规则冲突的前提条件为规则的match部分存在重合部分。新增或者修改的规则时，需要与已存在且未变化的所有规则一一比较判断match部分是否重合。如无重合部分，则新增或者修改规则成功；若存在重合部分，action相同判断为规则冗余，action不同判断为规则冲突，新增或者修改规则失败。match五元组中，srcPlatform、dstPlatform可以取值为具体值或者any，safeLevel和operation组合得到一个取值范围，所以请求与规则的匹配不仅是各个元素值的比较，需要对两个范围进行取交集，判断交集是否为空。共享策略冲突检测的流程如图4所示，以下以新增规则r4为例，共享策略冲突检测的具体过程如下：r4与已存在的规则的srcPlatform相同或者至少其中一个为any，转入；否则r4与已存在的下一规则比较，转入；r4与已存在的规则的dstPlatform相同或者至少其中一个为any，转入；否则r4与已存在的下一规则比较，转入；r4与已存在的规则的resourceType相同，转入；否则r4与已存在的下一规则比较，转入；r4根据safeLevel和operation，共享策略规定的minSafeLevel,maxSafeLevel计算r4的安全级别范围。具体如下：operation＝“＞”,则start1＝safeLeve+1,end1＝maxSafeLevel；operation＝“＞＝”,则start1＝safeLeve,end1＝maxSafeLevel；operation＝“＝”,则start1＝safeLeve,end1＝safeLeve；operation＝“＜＝”,则start1＝minSafeLevel,end1＝safeLeve；operation＝“＜”,则start1＝minSafeLevel,end1＝safeLeve-1；已存在的共享规则同理计算自己的安全级别范围。如果start2＞end1或者end2＜start1，转入；否则转入；检测到存在共享策略冲突。具体冲突类型为：r4与已存在的规则的action相同，存在规则冗余；否则存在规则冲突，新增或者修改共享规则失败。检测到无共享策略冲突，增加或者修改共享规则。实验测试例本实验测试例中，规则集初始状态如表2所示表2实施例2规则集初始状态IdsrcPlatformdstPlatformresourceTypesafeLeveloperationmatchTimesmatchLastpriorityactionstatus1物联网平台2物联网平台1视频＞2000accepttrue2物联网平台1物联网平台3视频＞1000accepttrue3物联网平台2物联网平台4音频＝2000denytrue4物联网平台1物联网平台2音频＞1000accepttrue5物联网平台1物联网平台2Humidity＞1000accepttrue6物联网平台1物联网平台2Humidity＝1000denytrue数据共享请求如表3所示表3数据共享请求其中，数据共享请求a与规则5匹配，b与规则3匹配，c无匹配项，依据共享策略执行默认操作，d与规则2匹配。测试过程中，依次发送了10次a请求、5次b请求、8次c请求、13次d请求、14次a请求。在不进行共享策略优先级动态调整的情况下，执行时间和匹配次数如表4所示。在基于优先级的共享策略动态调整后，执行时间和匹配次数如表5所示。表4无优先级动态调整时的测试结果表5共享策略优先级动态调整时的测试结果可见，共享策略在优先级动态调整的情况下，平均执行时间从3822纳米降至2094纳米，执行效率提升45％，匹配总次数从209降至104。可见，基于优先级动态调整的共享策略考虑了相同数据共享请求的集中性的时间特征，极大程度上优化了大量数据共享请求情况下的执行效率。综上，本发明提供了充分考虑了匹配次数和匹配时间对共享策略验证和冲突检测的影响，通过分类判断缩小了策略验证时的规则数量级，通过优先级的方式将影响量化，极大地缩小了共享策略的验证时间，提高了整个物联网数据跨域授权共享的运行效率。需要说明的是，以上内容仅仅说明了本发明的技术思想，不能以此限定本发明的保护范围，对于本技术领域的普通技术人员来说，在不脱离本发明原理的前提下，还可以做出若干改进和润饰，这些改进和润饰均落入本发明权利要求书的保护范围之内。
