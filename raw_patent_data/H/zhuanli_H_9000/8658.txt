标题title
一种水声信道双模盲均衡方法、系统、设备及介质
摘要abst
本发明针对水声信道的时变特性，为进一步提高均衡器的性能，公开了一种水声信道双模盲均衡方法、系统、设备及介质，其中方法包括：获取发送信号，并对双模均衡器权值系数矢量及相关参数进行初始化设置；构建当前时刻的输入信号矢量，并计算双模均衡器及判决器的输出信号；基于改进的MCMA‑DD算法计算输出信号的算法误差，自定义短时均值误差能量来设置双模盲均衡器的重启动规则；并对双模均衡器相关参数及其权值系数矢量进行更新，以获取更新后的双模均衡器及判决器的输出信号进行输出。本发明使均衡后的信号聚敛性更好，剩余码间干扰更小，对不同调制阶数的信号和不同信噪比条件下的应用具有更好的适应性和可操作性。
权利要求书clms
1.一种水声信道双模盲均衡方法，其特征在于，包括以下步骤：获取发送信号，并对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，所述双模均衡器参数包括所述权值系数矢量的更新步长、加权因子、加权因子参数及加权因子参数的更新步长；通过所述发送信号构建当前时刻的输入信号矢量，并通过所述输入信号矢量与初始化后的双模均衡器权值系数矢量获取双模均衡器及判决器的输出信号；通过改进的MCMA算法和DD算法分别对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差，并根据所述DD瞬时误差获取短时均值误差能量；判断所述短时均值误差能量是否满足双模算法重置条件，若满足，则将加权因子参数重置为初始值，使所述双模均衡器及判决器的输出信号重新通过改进的MCMA算法进行误差迭代计算，并通过重置后的加权因子参数更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号；其中，所述双模算法重置条件为当前时刻的短时均值误差能量的增量大于当前时刻的短时均值误差能量的预设倍数；若不满足，则使所述双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，并更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号。2.根据权利要求1所述的一种水声信道双模盲均衡方法，其特征在于，所述对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，包括：将所述双模均衡器权值系数矢量中的中心值设置为1，其余系数设置为0；将所述加权因子初始化为1，所述加权因子参数初始化为5。3.根据权利要求1所述的一种水声信道双模盲均衡方法，其特征在于，所述通过改进的MCMA算法对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差，包括：通过MCMA算法对所述双模均衡器及判决器的输出信号进行误差迭代计算，获取MCMA瞬时误差；去除所述MCMA瞬时误差中的偏差成分，得到修正MCMA瞬时误差；其中，所述修正MCMA瞬时误差通过以下公式表示：式中，e1为修正MCMA瞬时误差，为双模均衡器的输出信号，和分别为双模均衡器输出信号的实部和虚部，为判决器的输出信号，和分别为判决器输出信号的实部和虚部，RR和RI分别表示发送信号x实部和虚部的常模。4.根据权利要求3所述的一种水声信道双模盲均衡方法，其特征在于，所述通过改进的MCMA算法和DD算法分别对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差之后，包括：通过组合MCMA-DD算法对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到双模均衡器误差；其中，所述双模均衡器误差通过下式表示：eC＝λe1+e2式中，eC为双模均衡器误差，λ为加权因子，e2为DD瞬时误差，通过以下公式获取：5.根据权利要求4所述的一种水声信道双模盲均衡方法，其特征在于，所述根据所述DD瞬时误差获取短时均值误差能量，包括：所述DD瞬时误差通过以下公式获取加权误差能量：eT＝ηe22+eT式中，eT为加权误差能量，η为遗忘因子；将当前时刻的加权误差能量与所述当前时刻之前所有时刻加权误差能量取平均，得到短时均值误差能量。6.根据权利要求4所述的一种水声信道双模盲均衡方法，其特征在于，所述更新所述双模均衡器权值系数矢量及双模均衡器参数，包括：通过以下公式更新加权因子：式中，γ为加权因子控制参数，a为加权因子参数；通过以下公式更新加权因子参数：式中，μa为加权因子参数的更新步长；通过以下公式更新权值系数矢量的更新步长：式中，μ为权值系数矢量的更新步长，μ0为μ的初始值；通过以下公式更新双模均衡器权值系数矢量：W＝w+μeCY*式中，W为权值系数矢量，Y*为输入信号矢量的共轭。7.根据权利要求6所述的一种水声信道双模盲均衡方法，其特征在于，所述双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，包括：当所述加权因子的值为最大时，所述双模均衡器及判决器的输出信号通过改进的MCMA算法进行误差迭代计算；随着所述加权因子的值逐渐减小，所述双模均衡器及判决器的输出信号的误差迭代计算逐步从改进的MCMA算法切换为DD算法进行；当所述加权因子的值为最小时，所述双模均衡器及判决器的输出信号通过DD算法进行误差迭代计算。8.一种水声信道双模盲均衡系统，其特征在于，包括：初始设置模块，用于获取发送信号，并对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，所述双模均衡器参数包括所述权值系数矢量的更新步长、加权因子、加权因子参数及加权因子参数的更新步长；信号获取模块，用于通过所述发送信号构建当前时刻的输入信号矢量，并通过所述输入信号矢量与初始化后的双模均衡器权值系数矢量获取双模均衡器及判决器的输出信号；误差计算模块，用于通过改进的MCMA算法和DD算法分别对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差，并根据所述DD瞬时误差获取短时均值误差能量；信号均衡模块，用于判断所述短时均值误差能量是否满足双模算法重置条件，若满足，则将加权因子参数重置为初始值，使所述双模均衡器及判决器的输出信号重新通过改进的MCMA算法进行误差迭代计算，并通过重置后的加权因子参数更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号；其中，所述双模算法重置条件为当前时刻的短时均值误差能量的增量大于当前时刻的短时均值误差能量的预设倍数；若不满足，则使所述双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，并更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的双模均衡器及判决器的输出信号。9.一种电子设备，其特征在于，包括处理器、存储器以及存储在所述存储器中且被配置为由所述处理器执行的计算机程序，所述处理器执行所述计算机程序时实现如权利要求1至7中任意一项所述的水声信道双模盲均衡方法。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质包括存储的计算机程序，其中，在所述计算机程序运行时控制所述计算机可读存储介质所在设备执行如权利要求1至7中任意一项所述的水声信道双模盲均衡方法。
说明书desc
技术领域本发明涉及通讯技术领域，特别是涉及一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法、系统、设备及介质。背景技术迄今为止，声波是唯一能够实现水下远距离信息传播的媒介，水声通信也因此在水下探测、水下目标识别和水下目标跟踪等领域具有广泛的应用价值。然而，由于水声信道的复杂性和多径效应，不可避免的产生码间干扰。自适应均衡技术是克服码间干扰提高通信质量的主要有效手段。传统自适应均衡技术采用定期发送收发双方已知的训练序列来捕获信道特性，而盲均衡技术无需训练序列即可实现对信道特性的补偿和跟踪，在提高通信质量的同时可有效节省通信带宽，提高通信效率。目前盲均衡技术中应用最广泛的是恒模算法，它具有性能稳健、实现简单的优点，但收敛速度慢、收敛后稳态剩余误差大且无法矫正相位偏转。修正恒模算法具有矫正相位的能力，但在收敛速度和稳态误差无显著改善。判决引导算法收敛速度快，收敛后具有较小的稳态剩余误差，但在接收信号眼图未张开时缺乏稳健性，常导致发散或误收敛。为了克服CMA算法和DD算法的缺点，同时融合两者的优点，不断有学者提出结合不同算法的联合算法。联合算法大体可分为两大类：并联双模盲均衡算法。此类算法是将两种不同算法并行独立运算，或者是同一种算法但分别以不同步长并行独立运算，然后组合其输出和误差，对权值系数及相关参数进行更新。例如，肖瑛等提出一种基于CMA算法和DD算法并联滤波的双模盲均衡器，两均衡器的输出加权融合得到双模均衡器的输出，并根据均方误差函数调整加权因子。曾乐雅等提出一种基于MCMA和DD算法的并联双模盲均衡器，两者的输出通过sigmoid函数更新的加权因子进行凸组合作为均衡器的输出，并利用输出误差来调整sigmoid函数中的混合参数。王旭光等文献针对脉冲噪声环境提出一种基于余弦代价函数的凸组合并联滤波盲均衡算法，其中基于余弦代价函数的盲均衡算法用于快速收敛，基于判决反馈的盲均衡算法用于降低稳态误差。切换双模盲均衡算法。此类算法始终只有一个均衡算法在运行，即权值系数和输出信号只需计算一次，其在初始阶段以收敛性能较稳健的CMA或MCMA算法进行迭代，然后通过给定的门限切换到DD算法，或者通过加权因子的更新来增大DD算法在输出或误差中的占比。例如，姜晖等在双模式修正恒模算法的基础上引入局部信息量和变步长思想，提出一种新的双模式变步长修正多模算法，从而获得更好的均衡性能，但需要根据信噪比人为给定门限及迭代次数在双模算法之间进行硬切换，当信噪比变化或信号调制方式变化后，参数需经过多次试验重新获取。肖瑛等提出基于组合代价函数的双模式盲均衡算法，利用MCMA和DD准则通过加权设计代价函数，均衡过程中自适应调节权值实现算法在MCAM算法和DD算法之间切换，无需人为设定双模算法切换阈值参数，算法具有更好的泛化能力，但该文中缺少应对信道突变的算法重启动机制。Sun J等提出了一种变步长的CMA+DD双模式盲均衡算法，利用均衡器输出误差及误差均值的乘积作为反双曲正弦函数的输入来自适应更新步长，并根据设定的阈值在两种盲均衡算法之间切换，但该算法的收敛性能对初始参数设置较敏感。胡婉如等提出了一种切换、加权模式联合CMA+DD的双模式盲均衡算法，根据DD算法输出的误差函数与设定的相关阈值大小关系来切换均衡算法，其阈值参数选定需要根据不同信道和噪声特性人为指定，不具有普适性。现有的双模盲均衡在满足一定的条件下能取得较好的结果，但仍存在一定的局限性，具体表现在：第一类并联双模盲均衡算法中的两个均衡器始终同时工作，计算复杂度相对较高；第二类切换双模盲均衡算法中大部分需要根据实验经验人为设定的算法切换阈值，当面对不同信道或信道变化时需重新给定阈值，否则可能出现收敛变慢甚至不收敛的情况，普适性较差。另外，双模盲均衡算法的稳态误差和剩余码间干扰有待进一步减小。大部分算法实验测试时的信号仅采用1～2种较低阶的调制方式，但实际中可能出现多种不同调制方式，调制阶数越高均衡难度越大，此时盲均衡算法的有效性有待验证，可能收敛性能变差甚至不收敛。大部分算法实验测试时是根据多次蒙特卡洛测试结果进行讨论，由于大部分双模算法最初是以CMA或MCMA算法迭代，然后逐渐过渡到以DD算法进行迭代，通过实验发现，其过渡过程通常是在第1～2次的重复迭代中完成，多次蒙特卡洛测试实际上是以1～2次的双模算法结果叠加上多次DD算法结果进行平均得到的。而在实际的水声通信中，水声信道通常具有时变特性，信道参数对接收信号的影响是变化的，因此较少次数的蒙特卡洛测试结果更具有实际意义。发明内容本发明提供一种水声信道双模盲均衡方法、系统、设备及介质，达到针对水声信道的时变特性，进一步提高均衡器的性能并降低码间干扰，使自适应切换双模盲均衡方法无需同时运行两个均衡器，并有效作用于高阶调制信号，且证明面向短时平稳的信道进行盲均衡时，较少次数的蒙特卡洛测试结果更具有实际参考价值的目的。为达到上述目的，本发明第一方面提供一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法，包括：获取发送信号，并对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，所述双模均衡器参数包括所述权值系数矢量的更新步长、加权因子、加权因子参数及加权因子参数的更新步长；通过所述发送信号构建当前时刻的输入信号矢量，并通过所述输入信号矢量与初始化后的双模均衡器权值系数矢量获取双模均衡器及判决器的输出信号；通过改进的MCMA算法和DD算法分别对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差，并根据所述DD瞬时误差获取短时均值误差能量；判断所述短时均值误差能量是否满足双模算法重置条件，若满足，则将加权因子参数重置为初始值，使所述双模均衡器及判决器的输出信号重新通过改进的MCMA算法进行误差迭代计算，并通过重置后的加权因子参数更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号；其中，所述双模算法重置条件为当前时刻的短时均值误差能量的增量大于当前时刻的短时均值误差能量的预设倍数；若不满足，则使所述双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，并更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号。进一步地，对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，包括：将所述双模均衡器权值系数矢量中的中心值设置为1，其余系数设置为0；将所述加权因子初始化为1，所述加权因子参数初始化为5。进一步地，通过改进的MCMA算法对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差，包括：通过MCMA算法对所述双模均衡器及判决器的输出信号进行误差迭代计算，获取MCMA瞬时误差；去除所述MCMA瞬时误差中的偏差成分，得到修正MCMA瞬时误差；其中，所述修正MCMA瞬时误差通过以下公式表示：式中，e1为修正MCMA瞬时误差，为双模均衡器的输出信号，和分别为双模均衡器输出信号的实部和虚部，为判决器的输出信号，和分别为判决器输出信号的实部和虚部，RR和RI分别表示发送信号x实部和虚部的常模。进一步地，通过改进的MCMA算法和DD算法分别对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差之后，包括：通过组合MCMA-DD算法对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到双模均衡器误差；其中，所述双模均衡器误差通过下式表示：eC＝λe1+e2式中，eC为双模均衡器误差，λ为加权因子，e2为DD瞬时误差，通过以下公式获取：进一步地，根据所述DD瞬时误差获取短时均值误差能量，包括：所述DD瞬时误差通过以下公式获取加权误差能量：eT＝ηe22+eT式中，eT为加权误差能量，η为遗忘因子；将当前时刻的加权误差能量与所述当前时刻之前所有时刻加权误差能量取平均，得到短时均值误差能量。进一步地，更更新所述双模均衡器权值系数矢量及双模均衡器参数，包括：通过以下公式更新加权因子：式中，γ为加权因子控制参数，a为加权因子参数；通过以下公式更新加权因子参数：式中，μa为加权因子参数的更新步长；通过以下公式更新权值系数矢量的更新步长：式中，μ为权值系数矢量的更新步长，μ0为μ的初始值；通过以下公式更新双模均衡器权值系数矢量：W＝w+μeCY*式中，W为权值系数矢量，Y*为输入信号矢量的共轭。进一步地，双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，包括：当所述加权因子的值为最大时，所述双模均衡器及判决器的输出信号通过改进的MCMA算法进行误差迭代计算；随着所述加权因子的值逐渐减小，所述双模均衡器及判决器的输出信号的误差迭代计算逐步从改进的MCMA算法切换为DD算法进行；当所述加权因子的值为最小时，所述双模均衡器及判决器的输出信号通过DD算法进行误差迭代计算。本发明第二方面提供一种基于改进的MCMA-DD算法的水声信道双模盲均衡系统，包括：初始设置模块，用于获取发送信号，并对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，所述双模均衡器参数包括所述权值系数矢量的更新步长、加权因子、加权因子参数及加权因子参数的更新步长；信号获取模块，用于通过所述发送信号构建当前时刻的输入信号矢量，并通过所述输入信号矢量与初始化后的双模均衡器权值系数矢量获取双模均衡器及判决器的输出信号；误差计算模块，用于通过改进的MCMA算法和DD算法分别对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差，并根据所述DD瞬时误差获取短时均值误差能量；信号均衡模块，用于判断所述短时均值误差能量是否满足双模算法重置条件，若满足，则将加权因子参数重置为初始值，使所述双模均衡器及判决器的输出信号重新通过改进的MCMA算法进行误差迭代计算，并通过重置后的加权因子参数更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号；其中，所述双模算法重置条件为当前时刻的短时均值误差能量的增量大于当前时刻的短时均值误差能量的预设倍数；若不满足，则使所述双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，并更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的双模均衡器及判决器的输出信号。本发明第三方面提供一种电子设备，包括处理器、存储器以及存储在所述存储器中且被配置为由所述处理器执行的计算机程序，所述处理器执行所述计算机程序时实现如上述第一方面中任意一项所述的基于改进的MCMA-DD算法的水声信道双模盲均衡方法。本发明第四方面提供一种计算机可读存储介质，所述计算机可读存储介质包括存储的计算机程序，其中，在所述计算机程序运行时控制所述计算机可读存储介质所在设备执行如上述第一方面中任意一项所述的基于改进的MCMA-DD算法的水声信道双模盲均衡方法。与现有技术相比，本发明实施例的有益效果在于：本发明提供一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法、系统、设备及介质，通过分析MCMA算法的瞬时误差的组成成分，去除了其中的偏差成分，重新定义了修正的MCMA算法误差计算方法；然后通过设置与当前收敛状态以及组合误差相关的更新步长来更新双模均衡器的权值系数；最后再通过定义的短时均值误差能量来设置双模盲均衡器的重启动规则，使得均衡器的性能得到进一步提高，均衡后的信号具有更好的聚敛性，对信道冲激响应逼近效果更好；并使自适应切换双模盲均衡方法无需同时运行两个均衡器，该方法可有效作用于高阶调制信号，且证明面向短时平稳的信道进行盲均衡时，较少次数的蒙特卡洛测试结果更具有实际参考价值的目的；同时给出了相关参数设置的一般规律，对不同调制阶数的信号和不同信噪比条件下的应用具有更好的适应性和可操作性。附图说明为了更清楚地说明本发明的技术方案，下面将对实施方式中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施方式，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明某一实施例提供的一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法的流程图；图2是本发明某一实施例提供的双模盲均衡基本原理框图；图3是2次MonteCarlo实验后输出结果图，图3是MCMA算法输出信号星座图，图3是组合MCMA-DD算法输出信号星座图，图3是本发明改进的MCMA-DD算法输出信号星座图，图3是2次MonteCarlo测试后的剩余码间干扰；图4是信道突变时3种算法的剩余ISI曲线图；图5是本发明又一实施例提供的一种基于改进的MCMA-DD算法的水声信道双模盲均衡系统的装置图；图6是本发明某一实施例提供的一种电子设备的结构图。具体实施方式下面结合附图和实施例，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。应当理解，文中所使用的步骤编号仅是为了方便描述，不对作为对步骤执行先后顺序的限定。应当理解，在本发明说明书中所使用的术语仅仅是出于描述特定实施例的目的而并不意在限制本发明。如在本发明说明书和所附权利要求书中所使用的那样，除非上下文清楚地指明其它情况，否则单数形式的“一”、“一个”及“该”意在包括复数形式。术语“包括”和“包含”指示所描述特征、整体、步骤、操作、元素和/或组件的存在，但并不排除一个或多个其它特征、整体、步骤、操作、元素、组件和/或其集合的存在或添加。术语“和/或”是指相关联列出的项中的一个或多个的任何组合以及所有可能组合，并且包括这些组合。在一实施例中，如图1所示，本发明第一方面提供一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法，包括：S1、获取发送信号，并对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，双模均衡器参数包括所述权值系数矢量的更新步长、加权因子、加权因子参数及加权因子参数的更新步长；具体的，本发明提出的双模盲均衡方法，无需同时运行两个均衡器，仅需一个均衡器即可对信号进行均衡处理，其中双模盲均衡基本原理框图如图2所示，虚线框内为双模盲均衡器。获取发送信号后，该信号在发送端经过存在加性噪声的未知信道产生冲激响应，得到双模均衡器的输入信号，也就是待均衡信号；其中，待均衡信号通过以下公式获得：式中，x为发送信号，y为待均衡信号，h为信道，v为信道中的加性噪声，M为信道阶数。而发送信号的常模通过以下公式计算获得：式中，xR和xI分别为发送信号x的实部和虚部，RR和RI分别表示发送信号x实部和虚部的常模，E表示求信号的期望，|·|表示求信号的绝对值。在一具体实施例中，对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，具体为：将双模均衡器权值系数矢量中的中心值设置为1，其余系数设置为0，在该过程之前可先通过对双模均衡器权值系数矢量进行转置运算：W＝T式中，W为权值系数矢量，N为双模均衡器长度，符号“T”表示转置运算，此处N值为信道长度M的3倍以上，均衡效果更好。双模均衡器参数包括权值系数矢量的更新步长、加权因子、加权因子参数及加权因子参数的更新步长。对双模均衡器参数进行初始化设置，包括：将加权因子初始化为1，加权因子参数初始化为5。本发明提出的双模盲均衡方法中采用的双模算法是将改进的MCMA算法和DD算法以加权因子进行组合，初始化设置使得双模均衡器在初始阶段以改进的MCMA算法进行迭代，从而保证双模均衡器能稳健收敛；并根据经验设置双模均衡器权值系数矢量的更新初始步长和加权因子参数的更新步长。其中，双模均衡器权值系数矢量的更新初始步长取值越大，权值系数更新越快，但稳态误差越大；加权因子参数的更新步长取值越小，由改进的MCMA算法切换到DD算法的速度越快。S2、通过发送信号构建当前时刻的输入信号矢量，并通过输入信号矢量与初始化后的双模均衡器权值系数矢量获取双模均衡器及判决器的输出信号；具体的，先将发送信号转换为待均衡信号，再通过以下公式使待均衡信号构建当前时刻的输入信号矢量：Y＝T式中，Y为当前时刻的输入信号矢量。输入信号矢量与初始化后的双模均衡器权值系数矢量通过以下公式获取双模均衡器的输出信号：式中，为双模均衡器的输出信号。将双模均衡器的输出信号通过判决器，则接收端得到最终的输出信号，也即判决器的输出信号，该信号可通过以下公式表示：式中，为判决器的输出信号，D为判决函数，将判定为与MQAM星座图中欧氏距离最小的星座点。S3、通过改进的MCMA算法和DD算法分别对双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差，并根据DD瞬时误差获取短时均值误差能量；具体的，本申请通过分析MCMA算法的瞬时误差的组成成分，去除了其中的偏差成分，重新定义了修正的MCMA算法误差计算方法。在一具体实施例中，先通过MCMA算法对双模均衡器及判决器的输出信号进行误差迭代计算，获取的MCMA瞬时误差通过下式表示：式中，eMCMA为MCMA瞬时误差，和分别为双模均衡器输出信号的实部和虚部，为判决器的输出信号，和分别为判决器输出信号的实部和虚部。再去除MCMA瞬时误差中的偏差成分，得到改进的MCMA算法对双模均衡器及判决器的输出信号的修正MCMA瞬时误差；其中，修正MCMA瞬时误差通过以下公式表示：式中，e1为修正MCMA瞬时误差。也就是说，改进的MCMA算法是在MCMA算法基础上，去除由MCMA算法对双模均衡器及判决器的输出信号计算出的MCMA瞬时误差中的偏差成分。一般来说，对于常模信号如4QAM，理论上误差可趋于零；但对于非常模信号，如16QAM、64QAM、128QAM、256QAM等，误差并不为零，误差函数中会叠加一定的偏差，去除MCMA瞬时误差中叠加的偏差后，可获得改进的MCMA算法对双模均衡器及判决器的输出信号的修正MCMA瞬时误差，可减少误差中的偏差以及噪声成分，从而减小双模算法的误差以及权值系数的波动范围，使得双模算法具有更小的稳态剩余码间干扰。而且随着MQAM调制阶数的增加，修正误差对算法性能的改善效果将越明显。在一具体实施例中，误差计算还包括通过组合MCMA-DD算法对双模均衡器及判决器的输出信号进行误差迭代计算，得到的双模均衡器误差；eC＝λe1+e2式中，eC为双模均衡器误差，λ为加权因子，e2为DD瞬时误差，通过以下公式获取：瞬时误差中的双模均衡器误差可用于双模均衡器权值系数矢量及双模均衡器参数的更新。组合MCMA-DD算法通过将MCMA算法和DD算法的瞬时误差进行线性组合，实现了融合MCMA算法的稳健收敛和DD算法的较小剩余码间干扰的优点。但其组合因子的更新近似线性，且最终切换到DD算法后无法回到MCMA算法。与组合MCMA-DD算法相比，本申请所采用的改进的MCMA-DD算法是将改进的MCMA算法和DD双模算法进行组合，组合因子采用非线性函数更新，在数据迭代初期，以较慢速度更新从而保证双模算法有效收敛；在双模算法收敛后，则以较快速度更新从而快速切换到DD算法，因此使得均衡后的信号具有更好的聚敛性及更小的剩余码间干扰。另外本申请的改进的MCMA-DD算法设置了双模算法重置规则，使其能在信道突变后重新回到初始化状态。在一具体实施例中，DD瞬时误差通过以下公式获取加权误差能量，具体将当前n时刻的瞬时误差能量和时刻的加权误差能量以遗忘因子η和进行加权：eT＝ηe22+eT式中，eT为加权误差能量，带有遗忘因子η：η值为0.9。一方面，加权误差能量是为了后面的双模算法重置而计算的，由于双模算法通过迭代逐步从改进的MCMA算法自适应切换到DD算法，即最终的状态是DD算法，因此采用DD算法的瞬时误差来计算；另一方面，发送信号的常模值对修正MCMA瞬时误差的影响很大，不利于反映信道突变的影响，而加权误差能量既能反映当前时刻输出误差的特性，又保留了之前时刻的误差特性，能较好的反映信道突变所引起的误差突变，且在信道无突变时其值波动较小，因此可用于反映当前时刻输出误差的变化以及信道是否发生突变。将当前时刻的加权误差能量与所述当前时刻之前所有时刻加权误差能量取平均，得到短时均值误差能量：式中，eS为短时均值误差能量。根据双模均衡器的结构可知，当前时刻的输出信号与当前时刻之前所有时刻的N-1个信号具有相关性，因此将这N个时刻的加权误差能量求平均，得到自定义的短时均值误差能量能减小噪声对加权误差能量的影响，从而提高下一步双模算法重置判决的鲁棒性。S4、判断短时均值误差能量是否满足双模算法重置条件，若满足，则将加权因子参数重置为初始值，使双模均衡器及判决器的输出信号重新通过改进的MCMA算法进行误差迭代计算，并通过重置后的加权因子参数更新双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号；其中，双模算法重置条件为当前时刻的短时均值误差能量的增量大于当前时刻的短时均值误差能量的预设倍数；具体的，双模算法重置条件为重启动规则，即当当前时刻的短时均值误差能量的增量大于当前时刻的短时均值误差能量的预设倍数时，算法启动重置，即将加权因子参数a值重置为初始值5，并更新双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号。if eS＞KeSa＝5；end该规则本质上是当短时均值误差能量的增量过大时，启动算法重置。其中预设倍数K为正的常数，一般取2～5之间，一般信噪比越低，其取值应越大。在一具体实施例中，更新双模均衡器权值系数矢量及双模均衡器参数，包括：通过以下公式更新加权因子：式中，γ为加权因子控制参数，a为加权因子参数；通过以下公式更新加权因子参数：式中，μa为加权因子参数的更新步长；通过以下公式更新权值系数矢量的更新步长：式中，μ为权值系数矢量的更新步长，μ0为μ的初始值；通过以下公式更新双模均衡器权值系数矢量：W＝w+μeCY*式中，Y*为输入信号矢量的共轭。本发明提出的是自适应切换双模盲均衡方法，无需同时运行两个均衡器，且该方法针对不同情况需要设定的参数主要仅有3个，分别是均衡器权值系数的更新步长、加权因子参数更新步长以及双模算法重置预设倍数K，并给出适合不同条件的取值趋势，其他参数可固定不变，从而提高了本文算法的普适性。S5、若不满足，则使双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，并更新双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号；在一具体实施例中，双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，具体包括：当加权因子的值为最大时，双模均衡器及判决器的输出信号通过改进的MCMA算法进行误差迭代计算；随着加权因子的值逐渐减小，双模均衡器及判决器的输出信号的误差迭代计算逐步从改进的MCMA算法切换为DD算法进行；当加权因子的值为最小时，双模均衡器及判决器的输出信号通过DD算法进行误差迭代计算。具体的，双模算法通过加权因子λ从改进的MCMA算法自适应切换到DD算法，即在初始阶段λ＝1，以改进的MCMA算法进行迭代计算误差，使其能稳健收敛；随着λ逐渐减小，改进的MCMA算法的作用逐渐减小，而DD算法的作用逐渐增大；直到最后算法完全收敛后以DD算法进行迭代计算误差，使均衡后的信号聚敛性更好，剩余码间干扰更小，对不同调制阶数的信号和不同信噪比条件下的应用具有更好的适应性和可操作性。加权因子参数的更新步长取值越大则由改进的MCMA算法自适应切换到DD算法的速度越快。一般MQAM调制阶数越高或信噪比越低，其取值应越小；一般MQAM调制阶数越高或信噪比越低，权值系数矢量的更新步长的初始值应越小，否则可能导致不收敛。在一具体实施例中，发送信号是对随机二进制序列进行256QAM调制后的信号，信道脉冲响应为h1＝，信道噪声为加性高斯白噪声，信噪比SNR＝20dB。双模均衡器长度设为信道长度的4倍，即28阶，抽头权值系数初始化中心为1其余为0。MCMA算法步长0.5*10-8，改进的MCMA-DD算法中权值更新步长μ＝2×10-7，加权因子更新步长μλ＝2×10-8，本文算法中μ0＝10-7，μa＝5×10-8。考虑实际水声信道的时变特性，对测试数据进行较少次数的重复迭代更具有实际意义，2次MonteCarlo实验后输出结果图如图3所示。其中，图3是MCMA算法输出信号星座图，图3是组合MCMA-DD算法输出信号星座图，图3是本发明改进的MCMA-DD算法输出信号星座图。可发现，在相同条件下，MCMA算法无法得到清晰的星座图，组合MCMA-DD切换算法星座图较清晰，本发明改进的MCMA-DD算法输出信号聚敛性更好，星座图更清晰，均衡效果最好。图3给出了三种均衡算法2次MonteCarlo测试后的剩余码间干扰，MCMA算法的剩余码间干扰在-19dB左右，组合MCMA-DD切换算法剩余码间干扰约为-35dB，本发明改进的MCMA-DD算法剩余码间干扰达到-42dB以下，较前者降低了7dB以上。为了验证本文算法重置规则的有效性，40000点后的数据所通过的信道突变为信道脉冲响应为h2＝的水声信道，K＝2.5，其他参数设置同上。信道突变时3种算法的剩余ISI曲线如图4所示，其是单次数据迭代后的结果，其中前半段是对信道h1的均衡结果，后半段是对信道h2的均衡结果。从图4可以看出，在信道突变前，MCMA算法的剩余ISI在-18dB上下波动，组合MCMA-DD算法最终的剩余ISI为-26.58dB，本发明改进的MCMA-DD算法最终的剩余ISI为-29.72dB，即本发明的方法比MCMA算法减小剩余ISI约12dB，比组合MCMA-DD算法减小剩余ISI约3dB。在信道突变后，MCMA算法能较快地重新收敛，剩余ISI仍在-18dB上下波动；组合MCMA-DD算法由于无算法重置规则，则无法重新收敛；本发明改进的MCMA-DD算法也能较快重新进入收敛状态，且收敛后最终的剩余ISI达到-31.94dB，比MCMA算法减小剩余ISI约14dB。由此可见，本发明改进的MCMA-DD算法不但具有较好的信道跟踪能力，且在收敛后比MCMA算法和组合MCMA-DD算法具有更小的剩余码间干扰。本申请实施例设计了一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法，其实现了获取发送信号，并对双模均衡器权值系数矢量及相关参数进行初始化设置；构建当前时刻的输入信号矢量，计算双模均衡器及判决器的输出信号；并基于改进的MCMA-DD算法计算输出信号的算法误差，自定义短时均值误差能量来设置双模盲均衡器的重启动规则；并对双模均衡器相关参数及其权值系数矢量进行更新，以获取更新后的双模均衡器及判决器的输出信号进行输出的技术方案，可达到针对水声信道的时变特性，进一步提高均衡器的性能并降低码间干扰，使自适应切换双模盲均衡方法无需同时运行两个均衡器，并有效作用于高阶调制信号，且证明面向短时平稳的信道进行盲均衡时，较少次数的蒙特卡洛测试结果更具有实际参考价值的目的。需要说明的是，虽然上述流程图中的各个步骤按照箭头的指示依次显示，但是这些步骤并不是必然按照箭头指示的顺序依次执行。除非本文中有明确的说明，这些步骤的执行并没有严格的顺序限制，这些步骤可以以其它的顺序执行。在另一实施例中，如图5所示，本发明第二方面提供一种基于改进的MCMA-DD算法的水声信道双模盲均衡系统，包括：初始设置模块10，用于获取发送信号，并对双模均衡器权值系数矢量及双模均衡器参数进行初始化设置，所述双模均衡器参数包括所述权值系数矢量的更新步长、加权因子、加权因子参数及加权因子参数的更新步长；信号获取模块20，用于通过所述发送信号构建当前时刻的输入信号矢量，并通过所述输入信号矢量与初始化后的双模均衡器权值系数矢量获取双模均衡器及判决器的输出信号；误差计算模块30，用于通过改进的MCMA算法和DD算法分别对所述双模均衡器及判决器的输出信号进行误差迭代计算，得到修正MCMA瞬时误差和DD瞬时误差，并根据所述DD瞬时误差获取短时均值误差能量；信号均衡模块40，用于判断所述短时均值误差能量是否满足双模算法重置条件，若满足，则将加权因子参数重置为初始值，使所述双模均衡器及判决器的输出信号重新通过改进的MCMA算法进行误差迭代计算，并通过重置后的加权因子参数更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的输出信号；其中，所述双模算法重置条件为当前时刻的短时均值误差能量的增量大于当前时刻的短时均值误差能量的预设倍数；若不满足，则使所述双模均衡器及判决器的输出信号的误差迭代计算在改进的MCMA算法和DD算法之间自适应切换，并更新所述双模均衡器权值系数矢量及双模均衡器参数，以获取双模均衡器及判决器经更新后的双模均衡器及判决器的输出信号。需要说明的是，上述一种基于改进的MCMA-DD算法的水声信道双模盲均衡系统中的各个模块可全部或部分通过软件、硬件及其组合来实现。上述各模块可以硬件形式内嵌于或独立于计算机设备中的处理器中，也可以以软件形式存储于计算机设备中的存储器中，以便于处理器调用执行以上各个模块对应的操作。关于一种基于改进的MCMA-DD算法的水声信道双模盲均衡系统的具体限定参见上文中对于一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法的限定，二者具有相同的功能和作用，在此不再赘述。本发明第三方面提供了一种电子设备，该电子设备包括：处理器、存储器和总线；所述总线，用于连接所述处理器和所述存储器；所述存储器，用于存储操作指令；所述处理器，用于通过调用所述操作指令，可执行指令使处理器执行如本申请的第一方面所示的一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法对应的操作。在一个可选实施例中提供了一种电子设备，如图6所示，图6所示的电子设备5000包括：处理器5001和存储器5003。其中，处理器5001和存储器5003相连，如通过总线5002相连。可选地，电子设备5000还可以包括收发器5004。需要说明的是，实际应用中收发器5004不限于一个，该电子设备5000的结构并不构成对本申请实施例的限定。处理器5001可以是CPU，通用处理器，DSP，ASIC，FPGA或者其他可编程逻辑器件、晶体管逻辑器件、硬件部件或者其任意组合。其可以实现或执行结合本申请公开内容所描述的各种示例性的逻辑方框，模块和电路。处理器5001也可以是实现计算功能的组合，例如包含一个或多个微处理器组合，DSP和微处理器的组合等。总线5002可包括一通路，在上述组件之间传送信息。总线5002可以是PCI总线或EISA总线等。总线5002可以分为地址总线、数据总线、控制总线等。为便于表示，图6中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总线。存储器5003可以是ROM或可存储静态信息和指令的其他类型的静态存储设备，RAM或者可存储信息和指令的其他类型的动态存储设备，也可以是EEPROM、CD-ROM或其他光盘存储、光碟存储、磁盘存储介质或者其他磁存储设备、或者能够用于携带或存储具有指令或数据结构形式的期望的程序代码并能够由计算机存取的任何其他介质，但不限于此。存储器5003用于存储执行本申请方案的应用程序代码，并由处理器5001来控制执行。处理器5001用于执行存储器5003中存储的应用程序代码，以实现前述任一方法实施例所示的内容。其中，电子设备包括但不限于：移动电话、笔记本电脑、数字广播接收器、PDA、PAD、PMP、车载终端等等的移动终端以及诸如数字TV、台式计算机等等的固定终端。本发明第四方面提供了一种计算机可读存储介质，计算机可读存储介质上存储有计算机程序，该程序被处理器执行时实现本申请第一方面所示的一种基于改进的MCMA-DD算法的水声信道双模盲均衡方法。本申请的又一实施例提供了一种计算机可读存储介质，该计算机可读存储介质上存储有计算机程序，当其在计算机上运行时，使得计算机可以执行前述方法实施例中相应内容。此外，本发明的实施例还提出一种计算机可读存储介质，其上存储有计算机程序，该程序被处理器执行时实现上述方法的步骤。综上，本发明针对水声信道的时变特性，为了进一步提高均衡器的性能，公开了一种水声信道双模盲均衡方法、系统、设备及介质，其中方法包括：获取发送信号，并对双模均衡器权值系数矢量及相关参数进行初始化设置；构建当前时刻的输入信号矢量，计算双模均衡器及判决器的输出信号；并基于改进的MCMA-DD算法计算输出信号的算法误差，自定义短时均值误差能量来设置双模盲均衡器的重启动规则；并对双模均衡器相关参数及其权值系数矢量进行更新，以获取更新后的双模均衡器及判决器的输出信号进行输出。本发明使均衡后的信号聚敛性更好，剩余码间干扰更小，对不同调制阶数的信号和不同信噪比条件下的应用具有更好的适应性和可操作性。本说明书中的各个实施例均采用递进的方式描述，各个实施例直接相同或相似的部分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于系统实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参见方法实施例的部分说明即可。需要说明的是，上述实施例的各技术特征可以进行任意的组合，为使描述简洁，未对上述实施例中的各个技术特征所有可能的组合都进行描述，然而，只要这些技术特征的组合不存在矛盾，都应当认为是本说明书记载的范围。以上所述实施例仅表达了本申请的几种优选实施方式，其描述较为具体和详细，但并不能因此而理解为对发明专利范围的限制。应当指出的是，对于本技术领域的普通技术人员来说，在不脱离本发明技术原理的前提下，还可以做出若干改进和替换，这些改进和替换也应视为本申请的保护范围。因此，本申请专利的保护范围应以所述权利要求的保护范围为准。
