标题title
一种药品防伪溯源云链数据多方安全计算方法
摘要abst
本发明公开了一种药品防伪溯源云链数据多方安全计算方法，解决了药品防伪溯源区块链系统中多家参与方对数据所有权和数据使用权的分离应用问题，确保数据拥有者在不泄露自身所拥有的数据所有权基础上，通过多方安全计算获得正确的计算结果。本发明通过数据参与方协同计算，采用协议标准，使得多个参与方协同完成计算，在整个计算过程中始终保存在本地数据库，确保数据的隐私性，计算任务完成后返回各自的正确计算结果。本发明方法运用区块链技术体系对已上链确认数据难以篡改的时间戳追踪特点，融合云计算海量处理数据能力，构建多节点共识的药品信息与合格药品真实对应记录，实现药品全流通多方安全数据共享与交换应用新模式。
权利要求书clms
1.一种药品防伪溯源云链数据多方安全计算方法，其特征在于，包括以下步骤：S1、药品防伪溯源各参与方按规定进行注册；S2、药品防伪溯源参与方注册并请求权威节点审核；如审核参与方信息合规，跳转至步骤S3；否则，重新执行步骤S1；S3、药品防伪溯源区块链系统参与方隐私数据进行加密处理；S4、药品溯源全部参与方根据数据进行多方安全计算；S5、药品防伪溯源权威节点处理多方安全计算结果；S6、药品防伪溯源权威节点确认发布药品流过程信息。2.根据权利要求1所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，所述药品防伪溯源区块链系统存在个彼此互不信任的参与方，分别表示为，且第个参与方所拥有的数据集表示为，确定区块链参与方主体角色。3.根据权利要求1所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，药品防伪溯源数据模型要素包括个参与方的数据和加密数据，以及云存储加密数据和区块链网络；并运用区块链底层技术框架和go语言编程完成药品防伪溯源系统建模。4.根据权利要求3所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，对个参与方拥有的数据进行加密计算，采用同态加密、零知识证明和非对称加密的混合策略，对各参与方隐私数据进行加密处理，生成共钥和任意参与方私钥；计算任意参与方存在私钥，个参与方协同运算函数为： ；在计算过程中，任意一个参与方都无法获得其他参与方拥有的数据；其中，，且。5.根据权利要求4所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，采用加密系统实现私钥分离，若任意参与方想要破解其他参与方拥有的数据密码，则至少需要其他个参与方合作才能实现；其中，，且。6.根据权利要求4所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，设置全部个参与方准入机制，全部个参与方使用私钥进行解密。7.根据权利要求4所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，药品溯源区块链系统包括个参与节点用户和个对象，，个对象指参与方，；表示第用户提供给第个对象的值，对其他参与节点用户保密，。8.根据权利要求4所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，设个药品溯源节点用户的前t部分数据经加密后存储在云数据库，密钥分配给前t个用户进行解密使用，用户的另外一部分数据以散列哈希值存储在区块链上；其中，t＜m，。9.根据权利要求4所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，进行同态加密的明文为，且，公钥，则同态加密密文为：； ；上述公式和中，是随机常数。10.根据权利要求4所述的一种药品防伪溯源云链数据多方安全计算方法，其特征在于，每个参与方使用私钥加密隐私数据，；且将密文传送到药品管理云计算数据中心，计算公式为： ；将公式计算得出的值发送给药品信息管理云端服务中随机挑选个使用者计算值的部分密文。
说明书desc
技术领域本发明涉及计算机安全技术领域，尤其涉及一种药品防伪溯源云链数据多方安全计算方法。背景技术随着经济社会的发展，人们对药品防伪溯源的需要越来越突出。目前，我国药品防伪溯源信息服务系统大多采用数据库集中式管理和查询，存在着存储在集中防伪溯源码比对数据库中的数据易于被人为篡改、伪造药品生产信息和流通信息等风险隐患，导致出现假冒伪劣药品时无法及时追踪溯源追踪，给患者财产和生命安全造成威胁。发明内容本发明的目的在于提供一种药品防伪溯源云链数据多方安全计算方法，以解决背景技术中提出的问题。为实现上述目的，本发明提供了一种药品防伪溯源云链数据多方安全计算方法，包括以下步骤：S1、药品防伪溯源各参与方按规定进行注册；S2、药品防伪溯源参与方注册并请求权威节点审核；如审核参与方信息合规，跳转至步骤S3；否则，重新执行步骤S1；S3、药品防伪溯源区块链系统参与方隐私数据进行加密处理；S4、药品溯源全部参与方根据数据进行多方安全计算；S5、药品防伪溯源权威节点处理多方安全计算结果；S6、药品防伪溯源权威节点确认发布药品流过程信息。进一步的，所述药品防伪溯源区块链系统存在个彼此互不信任的参与方，分别表示为，且第个参与方所拥有的数据集表示为，确定区块链参与方主体角色。进一步的，药品防伪溯源数据模型要素包括个参与方的数据和加密数据，以及云存储加密数据和区块链网络；并运用区块链底层技术框架和go语言编程完成药品防伪溯源系统建模。进一步的，对个参与方拥有的数据进行加密计算，采用同态加密、零知识证明和非对称加密的混合策略，对各参与方隐私数据进行加密处理，生成共钥和任意参与方私钥；计算任意参与方存在私钥，个参与方协同运算函数为： ；在计算过程中，任意一个参与方都无法获得其他参与方拥有的数据；其中，，且。进一步的，采用加密系统实现私钥分离，若任意参与方想要破解其他参与方拥有的数据密码，则至少需要其他个参与方合作才能实现；其中，，且。进一步的，设置全部个参与方准入机制，全部个参与方使用私钥进行解密。进一步的，药品溯源区块链系统有个参与节点用户和个对象，，个对象指参与方，；表示第用户提供给第个对象的值，对其他参与节点用户保密，。进一步的，设个药品溯源节点用户的前t部分数据经加密后存储在云数据库，密钥分配给前t个用户进行解密使用，用户的另外一部分数据以散列哈希值存储在区块链上；其中，t＜m，。进一步的，进行同态加密的明文为，且，公钥，则同态加密密文为：； ；上述公式和中，是随机常数。进一步的，每个参与方使用私钥加密隐私数据，；且将密文传送到药品管理云计算数据中心，计算公式为： ；将公式计算得出的值发送给药品信息管理云端服务中随机挑选个使用者计算值的部分密文。相比于现有技术，本发明具有以下有益效果：本发明的一种药品防伪溯源云链数据多方安全计算方法，运用区块链技术体系对已上链确认数据难以篡改的时间戳追踪特点，融合云计算海量处理数据能力，构建涵盖药品监管机构、药品生产商、经销商和消费者等多节点共识的药品信息与合格药品真实对应记录，实现药品全流通多方安全数据共享与交换应用新模式。除了上面所描述的目的、特征和优点之外，本发明还有其它的目的、特征和优点。下面将参照图，对本发明作进一步详细的说明。附图说明附图是用来提供对本发明实施例的进一步理解，并且构成说明书的一部分，与下面的具体实施方式一起用于解释本发明实施例，但并不构成对本发明实施例的限制。在附图中：图1是本发明中一种药品防伪溯源云链数据多方安全计算方法的流程图；图2是本发明中药品防伪溯源区块链多方安全计算应用框架图。具体实施方式以下结合附图对本发明的实施例进行详细说明，但是本发明可以根据权利要求限定和覆盖的多种不同方式实施。请参见图1，本实施例提供一种药品防伪溯源云链数据多方安全计算方法，包括以下步骤：S1、药品防伪溯源各参与方按规定进行注册；S2、药品防伪溯源参与方注册并请求权威节点审核；如审核参与方信息合规，跳转至步骤S3；否则，重新执行步骤S1；S3、药品防伪溯源区块链系统参与方隐私数据进行加密处理；药品防伪溯源区块链系统存在个彼此互不信任的参与方，分别表示为，且第个参与方所拥有的数据集表示为，确定区块链参与方主体角色。药品防伪溯源数据模型要素包括个参与方的数据和加密数据，以及云存储加密数据和区块链网络；并运用区块链底层技术框架和go语言编程完成药品防伪溯源系统建模。其中，药品防伪溯源数据经加密和多方安全计算后，存储在云服务器中。S4、药品溯源全部参与方根据数据进行多方安全计算；S5、药品防伪溯源权威节点处理多方安全计算结果；S6、药品防伪溯源权威节点确认发布药品流过程信息。在本发明较佳的实施例中，对个参与方拥有的数据进行加密计算，采用同态加密、零知识证明和非对称加密的混合策略，对各参与方隐私数据进行加密处理，生成共钥和任意参与方私钥。计算任意参与方存在私钥，个参与方协同运算函数为： ；在计算过程中，任意一个参与方都无法获得其他参与方拥有的数据。个参与方拥有的公钥存放在区块链网络各个节点中；任意参与方保存私钥。在本发明较佳的实施例中，采用加密系统实现私钥分离，若任意参与方想要破解其他参与方拥有的数据密码，则至少需要其他个参与方合作才能实现。其中，，且。设置全部个参与方准入机制，全部个参与方使用私钥进行解密。在本发明较佳的实施例中，药品溯源区块链系统包括个参与节点用户和个对象，，个对象指参与方，；表示第用户提供给第个对象的值，对其他参与节点用户保密，。在本发明较佳的实施例中，设个药品溯源节点用户的前t部分数据经加密后存储在云数据库，密钥分配给前t个用户进行解密使用，用户的另外一部分数据以散列哈希值存储在区块链上。在本发明较佳的实施例中，进行同态加密的明文为，且，公钥，则同态加密密文为： ； ；上述公式和中，是随机常数。在本发明较佳的实施例中，每个参与方使用私钥加密隐私数据，；且将密文传送到药品管理云计算数据中心，计算公式为： ；将公式计算得出的值发送给药品信息管理云端服务中随机挑选个使用者计算值的部分密文。在本发明的多方安全计算解决了药品防伪溯源区块链系统中多家参与方对数据所有权和数据使用权的分离应用问题，确保数据拥有者在不泄露自身所拥有的数据所有权基础上，通过多方安全计算获得正确的计算结果。区块链参与方既是数据的拥有者，也是其他数据的使用者。通过数据参与方协同计算，采用协议标准，使得多个参与方协同完成计算，在整个计算过程中始终保存在本地数据库，确保数据的隐私性，计算任务完成后返回各自的正确计算结果。区块链技术体系适合多方安全计算协议。药品防伪溯源区块链系统包括链上计算和本地预处理，达到药品交易数据的隐私保护。遵照国家推出的多方安全计算标准规范制。在本发明较佳的实施例中，每个参与方都有一个私有输入数据，个参与方共同计算函数，当计算结束时，每个参与方只能得到私有输入数据的输出，不能获取其他参与方的输入数据和输出。在本发明药品防伪溯源区块链系统中，区块链个参与方都要通过身份验证流程确定合法操作身份。设药品监管机构为区块链权威节点，负责验证其他参与方合法身份。只允许具有合法身份的参与方调用智能合约进行私有数据加密处理，并发送经过加密的数据参与多方安全计算。由权威节点负责处理多方安全计算结果并上链发布，实现药品溯源多方安全应用需求，且保护个参与方各自的私有数据。本发明的药品防伪溯源区块链多方安全计算应用框架图如图2所示；其中：、药品生产商上链应用。设药品防伪溯源区块链系统参与方药品生产商用表示，药品生产商需要上链监管的数据集表示成，其中，表示企业名称；表示药品GMP证书；表示生产资质；表示药品名称；表示批号；表示规格；表示生产日期；表示有效期；表示药品状态；表示药品批准号。药品生产商节点完成上链操作并得到其他节点共识确认，发起药品交易，将药品拥有权转让给药品经销商。若发现药品质量问题，支持发起药品召回操作，召回药品无法进行交易。、药品经销商上链应用。药品经销商表示为在区块链应用中发现可交易药品，运用药品防伪溯源码验证药品信息，操作订单管理进行交易、支付和配送服务。经区块链个参与方达成共识确认出块，获得药品的所有权。药品经销商需要参与多方安全计算的数据可表示为,其中，表示药品经销商单位名称；表示药品经销商的药品经营许可证；表示药品经销商法人代表信息；表示购买药品种类；表示购买药品规格型号；表示购买数量；表示购买药品价格。支持经销商查询药品生产商上链操作记录、药品历次交易记录，查询历史交易信息，大规模经销商可作为区块链节点服务器，存储账本副本，参与区块链共识。、药品消费者上链应用场景。药品溯源区块链系统支持药品消费者分辨药品真伪，保护消费者权益，实现药品在区块链系统发起购买订单，完成支付交易。消费者运用药品防伪溯源码查询药品信息和药品流通记录，通过对比线上卖家信息与药品所有者信息验证药品真伪。、药品监管机构应用场景。药品监管机构作为药品防伪溯源区块链系统权威审核节点，负责审核区块链上链节点注册信息的真实性筛选和确认，设置区块监管策略、部署和更新智能合约应用功能。部署区块链节点物理机，分为排序节点物理机和提交节点物理机，实施区块链药品交易背书并参加区块链共识策略。药品监督管机构有权限查看区块链上所有的信息，包括药品上链信息、药品交易信息、药品溯源信息等。支持药品防伪举报，冻结不合格药品交易。通过药品溯源记录定位已发生交易信息和药品批次，阻止不合格药品继续流通。以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。
