标题title
一种功率模块电能质量优化控制系统及方法
摘要abst
本发明涉及电力系统技术领域，具体涉及一种功率模块电能质量优化控制系统及方法，系统包括电压采样模块、谐波检测模块、谐波判断模块、谐波补偿模块、基波控制模块、信号调制模块和滤波器设计模块；电压采样模块接到逆变器三相交流线上，输出信号分别给谐波检测模块和基波控制模块，谐波检测模块输出连接谐波判断模块，谐波判断模块输出与基波控制模块叠加，作为信号调制模块的输入，信号调制模块输出驱动信号给开关管，滤波器设计模块分别连接谐波检测模块和谐波补偿模块；本发明可以实现逆变器输出电压中叠加的多种谐波分量自适应检测及消除，降低电压畸变率，有效提高电能质量。
权利要求书clms
1.一种功率模块电能质量优化控制系统，其特征在于，包括，电压采样模块，连接外部逆变器的三相交流输出电压端，用于采集所述逆变器的三相交流电压信号、、以及用于对所述逆变器的三相交流电压信号、、进行坐标变换获得d-q轴电压分量、；谐波检测模块，连接所述电压采样模块，接收所述d-q轴电压分量、，所述谐波检测模块用于获得与谐波的频率值对应的谐波的幅值；谐波判断模块，连接所述谐波检测模块，接收所述谐波的幅值，所述谐波判断模块用于判断所述谐波的幅值的最大值与一阈值的大小关系；谐波补偿模块，连接所述谐波判断模块，基于所述谐波判断模块的判断结果输出谐波补偿量、；基波控制模块，连接所述逆变器的三相交流输出电压端采集所述逆变器的三相交流电流信号，以及连接所述电压采样模块接收所述d-q轴电压分量、，所述基波控制模块基于所述d-q轴电压分量、输出基波电压控制量、；信号调制模块，连接所述谐波补偿模块和所述基波控制模块，接收所述谐波补偿量和所述基波电压控制量的叠加量，所述信号调制模块基于所述谐波补偿量和所述基波电压控制量的叠加量向所述逆变器输出开关管驱动信号。2.根据权利要求1所述的功率模块电能质量优化控制系统，其特征在于，还包括滤波器设计模块，所述滤波器设计模块连接所述谐波检测模块向所述谐波检测模块输出二阶低通滤波器各项系数，以及连接所述谐波补偿模块向所述谐波补偿模块输出二阶带通滤波器各项系数。3.根据权利要求1所述的功率模块电能质量优化控制系统，其特征在于，所述谐波检测模块包括，第一二阶低通滤波器，所述第一二阶低通滤波器的接收端连接一第一运算器和一第二运算器的输出端，所述第一运算器用于将d轴电压分量与相乘，所述第二运算器用于将d轴电压分量与相乘；其中t表示时间值；第二二阶低通滤波器，所述第二二阶低通滤波器的接收端连接一第三运算器和一第四运算器的输出端，所述第三运算器用于将q轴电压分量与相乘，所述第二运算器用于将q轴电压分量与相乘；幅值运算器，连接所述第一二阶低通滤波器和所述第二二阶低通滤波器的输出端，基于接收所述第一二阶低通滤波器输出的d轴电压中谐波2倍频分量的实部和虚部以及接收所述第二二阶低通滤波器输出的q轴电压中谐波2倍频分量的实部和虚部输出与所述谐波的频率值对应的所述谐波的幅值。4.根据权利要求1所述的功率模块电能质量优化控制系统，其特征在于，所述谐波补偿模块包括，增益运算器，连接所述谐波判断模块，接收所述谐波判断模块传输的所述d-q轴电压分量、，所述增益运算器用于对所述d-q轴电压分量、执行增益运算；第一二阶带通滤波器，连接所述增益运算器的第一输出端，接收所述增益运算器的第一运算结果并输出d轴谐波补偿量；第二二阶带通滤波器，连接所述增益运算器的第二输出端，接收所述增益运算器的第二运算结果并输出q轴谐波补偿量。5.根据权利要求1所述的功率模块电能质量优化控制系统，其特征在于，所述基波控制模块包括，一电压环，所述电压环连接所述电压采样模块，接收所述d-q轴电压分量、，并基于给定的一电压目标控制值进行电压调节；一电流环，连接所述电压环的输出端接收所述电压环的输出值，并基于接收的三相交流电流信号进行电流调节，输出所述基波电压控制量、。6.一种功率模块电能质量优化控制方法，应用于如权利要求1-5中任意一项所述的功率模块电能质量优化控制系统，其特征在于，包括，步骤S1，所述电压采样模块采集所述逆变器的三相交流电压信号、、，对所述逆变器的三相交流电压信号、、进行坐标变换获得d-q轴电压分量、；步骤S2，将所述d-q轴电压分量、输入所述谐波检测模块，获得与所述谐波的频率值对应的所述谐波的幅值；步骤S3，将所述谐波的幅值输入所述谐波判断模块，所述谐波判断模块选择所述谐波的幅值的最大值，并判断与所述阈值的大小关系，若所述谐波的幅值的最大值大于所述阈值，则执行步骤S4；否则，设置所述谐波补偿量、为0，执行步骤S5；步骤S4，将所述d-q轴电压分量、、所述谐波的幅值的最大值以及与所述谐波的幅值的最大值相对应的频率值输入所述谐波补偿模块，获得所述谐波补偿量、；步骤S5，所述基波控制模块基于所述d-q轴电压分量、以及三相交流电压信号输出基波电压控制量、；将所述谐波补偿量、和所述基波电压控制量、叠加后输入至所述信号调制模块，获得所述开关管驱动信号。7.根据权利要求6所述的功率模块电能质量优化控制方法，其特征在于，步骤S2包括，步骤S20，将截止频率、品质因数输入一滤波器设计模块，获得二阶低通滤波器各项系数，其表达式为：其中，z为离散拉普拉斯算子，、、为分子项系数，、为分母项系数；步骤S21，将d轴电压分量与和相乘，经过第一二阶低通滤波器得到d轴电压中谐波2倍频分量的实部和虚部，其中t表示时间值；以及；将q轴电压分量与和相乘，经过第二二阶低通滤波器得到q轴电压中谐波2倍频分量的实部和虚部；步骤S22，将所述d轴电压中谐波2倍频分量的实部和虚部和所述q轴电压中谐波2倍频分量的实部和虚部通过一幅值运算器，获得与所述谐波的频率值对应的所述谐波的幅值。8.根据权利要求7所述的功率模块电能质量优化控制方法，其特征在于，所述幅值运算器的表达式为，。9.根据权利要求6所述的功率模块电能质量优化控制方法，其特征在于，步骤S4包括，步骤S40，将与所述谐波的幅值的最大值相对应的频率值、品质因数输入一滤波器设计模块，获得二阶带通滤波器各项系数，其表达式为：其中，z为离散拉普拉斯算子，、、为分子项系数，、为分母项系数；步骤S41，将所述d-q轴电压分量、输入一增益运算器，将所述d轴电压分量与增益相乘，输出第一运算结果，将所述q轴电压分量与所述增益相乘，输出第二运算结果；步骤S42，将所述第一运算结果经过一第一二阶带通滤波器获得d轴谐波补偿量，以及将所述第二运算结果经过一第二二阶带通滤波器获得q轴谐波补偿量。10.根据权利要求6所述的功率模块电能质量优化控制方法，其特征在于，步骤S5中所述基波控制模块工作过程包括，步骤S51，将一电压目标控制值作为给定值，将所述d-q轴电压分量、，作为反馈值输入至一电压环，所述电压环进行电压调节，表达式为，其中为电压环比例项系数，为电压环积分项系数；步骤S52，将所述电压环的输出值作为给定值，将经坐标变换后的所述逆变器的三相交流电流信号作为反馈值输入一电流环，所述电流环进行电流调节，输出所述基波电压控制量、，表达式为，其中为电流环比例项系数，为电流环积分项系数。
说明书desc
技术领域本发明涉及电力系统技术领域，具体涉及一种电能质量优化控制系统及方法。背景技术传统以柴油机作为动力系统的船舶，由于在航行过程中会产生大量的废弃物排放污染，也逐渐遭遇淘汰，而电动船舶凭借零排放、低噪音的优势，逐渐成为市场发展的趋势。预计到2025年，我国电动船舶锂电化渗透率将达到20％，对应的市场规模将达到550亿元。日用逆变器是电动船舶电机驱动的动力来源，主要功能是将直流母排上直流电逆变成日用负载可使用的三相交流电。日用逆变器配置电压采集卡，该采集信号用于电压闭环控制，可以有效控制输出电压的稳定。通常要求逆变器输出完美正弦波，电网谐波水平被严格控制在5%以内，可以满足船级社要求和船舶日用电的需求。然而受到脉冲宽度调制载波比相对较低、死区和非线性负载等因素的影响，逆变器输出电压容易发生畸变，降低了供电系统电能质量。中国发明申请CN109361227A于2019年2月公布的《一种基于LADRC优化逆变器电能质量的系统》，在组合式三相逆变器拓扑结构电路中用以解决逆变器交流侧因带不平衡负载引起的电能质量问题，达到降低电压三相不平衡度，减小电压波动，但是未提及谐波消除解决措施。中国发明申请CN113630019A于2021年11月公布的《一种电力系统高次谐波检测的方法》，提出基于ip-iq谐波检测法，利用自适应陷波器对同步坐标系锁相环进行改进，得到自适应陷波器ANF-PLL，实现电网电压不平衡且畸变时仍能提取基波正序相位，但是采用滑动平均滤波器提取谐波，需要提取获得谐波次数才能设置窗口值，此外并没有提出谐波消除方法。期刊《微特电机》2022年第50期第2卷发表的《基于PR控制器与不对称SVPWM的永磁电机电流谐波抑制策略》提出采用准比例谐振控制器见电机谐波电流抑制，但是只能针对特定次谐波进行消除，无法实现自适应消除，此外对于滤波器的参数设计是按照典型I型系统最佳整定规则设计的，不能满足二阶滤波器最佳性能整定要求。发明内容本发明的目的在于，提供一种功率模块电能质量优化控制系统，解决以上技术问题；本发明的目的还在于，提供一种功率模块电能质量优化控制方法，解决以上技术问题。本发明所解决的技术问题可以采用以下技术方案来实现：一种功率模块电能质量优化控制系统，包括，电压采样模块，连接外部逆变器的三相交流输出电压端，用于采集所述逆变器的三相交流电压信号、、以及用于对所述逆变器的三相交流电压信号、、进行坐标变换获得d-q轴电压分量、；谐波检测模块，连接所述电压采样模块，接收所述d-q轴电压分量、，所述谐波检测模块用于获得与谐波的频率值对应的谐波的幅值；谐波判断模块，连接所述谐波检测模块，接收所述谐波的幅值，所述谐波判断模块用于判断所述谐波的幅值的最大值与一阈值的大小关系；谐波补偿模块，连接所述谐波判断模块，基于所述谐波判断模块的判断结果输出谐波补偿量、；基波控制模块，连接所述逆变器的三相交流输出电压端采集所述逆变器的三相交流电流信号，以及连接所述电压采样模块接收所述d-q轴电压分量、，所述基波控制模块基于所述d-q轴电压分量、输出基波电压控制量、；信号调制模块，连接所述谐波补偿模块和所述基波控制模块，接收所述谐波补偿量和所述基波电压控制量的叠加量，所述信号调制模块基于所述谐波补偿量和所述基波电压控制量的叠加量向所述逆变器输出开关管驱动信号。优选的，还包括滤波器设计模块，所述滤波器设计模块连接所述谐波检测模块向所述谐波检测模块输出二阶低通滤波器各项系数，以及连接所述谐波补偿模块向所述谐波补偿模块输出二阶带通滤波器各项系数。优选的，所述谐波检测模块包括，第一二阶低通滤波器，所述第一二阶低通滤波器的接收端连接一第一运算器和一第二运算器的输出端，所述第一运算器用于将d轴电压分量与相乘，所述第二运算器用于将d轴电压分量与相乘；其中t表示时间值；第二二阶低通滤波器，所述第二二阶低通滤波器的接收端连接一第三运算器和一第四运算器的输出端，所述第三运算器用于将q轴电压分量与相乘，所述第二运算器用于将q轴电压分量与相乘；幅值运算器，连接所述第一二阶低通滤波器和所述第二二阶低通滤波器的输出端，基于接收所述第一二阶低通滤波器输出的d轴电压中谐波2倍频分量的实部和虚部以及接收所述第二二阶低通滤波器输出的q轴电压中谐波2倍频分量的实部和虚部输出与所述谐波的频率值对应的所述谐波的幅值。优选的，所述谐波补偿模块包括，增益运算器，连接所述谐波判断模块，接收所述谐波判断模块传输的所述d-q轴电压分量、，所述增益运算器用于对所述d-q轴电压分量、执行增益运算；第一二阶带通滤波器，连接所述增益运算器的第一输出端，接收所述增益运算器的第一运算结果并输出d轴谐波补偿量；第二二阶带通滤波器，连接所述增益运算器的第二输出端，接收所述增益运算器的第二运算结果并输出q轴谐波补偿量。优选的，所述基波控制模块包括，一电压环，所述电压环连接所述电压采样模块，接收所述d-q轴电压分量、，并基于给定的一电压目标控制值进行电压调节；一电流环，连接所述电压环的输出端接收所述电压环的输出值，并基于接收的三相交流电流信号进行电流调节，输出所述基波电压控制量、。一种功率模块电能质量优化控制方法，应用于所述的功率模块电能质量优化控制系统，包括，步骤S1，所述电压采样模块采集所述逆变器的三相交流电压信号、、，对所述逆变器的三相交流电压信号、、进行坐标变换获得d-q轴电压分量、；步骤S2，将所述d-q轴电压分量、输入所述谐波检测模块，获得与所述谐波的频率值对应的所述谐波的幅值；步骤S3，将所述谐波的幅值输入所述谐波判断模块，所述谐波判断模块选择所述谐波的幅值的最大值，并判断与所述阈值的大小关系，若所述谐波的幅值的最大值大于所述阈值，则执行步骤S4；否则，设置所述谐波补偿量、为0，执行步骤S5；步骤S4，将所述d-q轴电压分量、、所述谐波的幅值的最大值以及与所述谐波的幅值的最大值相对应的频率值输入所述谐波补偿模块，获得所述谐波补偿量、；步骤S5，所述基波控制模块基于所述d-q轴电压分量、以及三相交流电压信号输出基波电压控制量、；将所述谐波补偿量、和所述基波电压控制量、叠加后输入至所述信号调制模块，获得所述开关管驱动信号。优选的，步骤S2包括，步骤S20，将截止频率、品质因数输入一滤波器设计模块，获得二阶低通滤波器各项系数，其表达式为：其中，z为离散拉普拉斯算子，、、为分子项系数，、为分母项系数；步骤S21，将d轴电压分量与和相乘，经过第一二阶低通滤波器得到d轴电压中谐波2倍频分量的实部和虚部，其中t表示时间值；以及；将q轴电压分量与和相乘，经过第二二阶低通滤波器得到q轴电压中谐波2倍频分量的实部和虚部；步骤S22，将所述d轴电压中谐波2倍频分量的实部和虚部和所述q轴电压中谐波2倍频分量的实部和虚部通过一幅值运算器，获得与所述谐波的频率值对应的所述谐波的幅值。优选的，所述幅值运算器的表达式为，。优选的，步骤S4包括，步骤S40，将与所述谐波的幅值的最大值相对应的频率值、品质因数输入一滤波器设计模块，获得二阶带通滤波器各项系数，其表达式为：其中，z为离散拉普拉斯算子，、、为分子项系数，、为分母项系数；步骤S41，将所述d-q轴电压分量、输入一增益运算器，将所述d轴电压分量与增益相乘，输出第一运算结果，将所述q轴电压分量与所述增益相乘，输出第二运算结果；步骤S42，将所述第一运算结果经过一第一二阶带通滤波器获得d轴谐波补偿量，以及将所述第二运算结果经过一第二二阶带通滤波器获得q轴谐波补偿量。优选的，步骤S5中所述基波控制模块工作过程包括，步骤S51，将一电压目标控制值作为给定值，将所述d-q轴电压分量、，作为反馈值输入至一电压环，所述电压环进行电压调节，表达式为，其中为电压环比例项系数，为电压环积分项系数；步骤S52，将所述电压环的输出值作为给定值，将经坐标变换后的所述逆变器的三相交流电流信号作为反馈值输入一电流环，所述电流环进行电流调节，输出所述基波电压控制量、，表达式为，其中为电流环比例项系数，为电流环积分项系数。本发明的有益效果：由于采用以上技术方案，本发明通过功率模块电能质量优化控制方法及系统，可以实现逆变器输出电压中叠加的多种谐波分量自适应检测及消除，降低电压畸变率，有效提高电能质量。附图说明图1为本发明实施例中功率模块电能质量优化控制系统架构图；图2为本发明实施例中谐波检测模块结构图；图3为本发明实施例中谐波补偿模块结构图；图4为本发明实施例中基波控制模块结构图；图5为本发明实施例中功率模块电能质量优化控制方法流程图；图6为本发明实施例中功率模块电能质量优化控制方法步骤示意图；图7为本发明实施例中步骤S2的步骤示意图；图8为本发明实施例中步骤S4的步骤示意图；图9为本发明实施例中基波控制模块的工作步骤示意图。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。需要说明的是，在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。下面结合附图和具体实施例对本发明作进一步说明，但不作为本发明的限定。一种功率模块电能质量优化控制系统，如图1所示，包括，电压采样模块1，连接外部逆变器的三相交流输出电压端，用于采集逆变器的三相交流电压信号、、以及用于对逆变器的三相交流电压信号、、进行坐标变换获得d-q轴电压分量、；谐波检测模块2，连接电压采样模块1，接收d-q轴电压分量、，谐波检测模块2用于获得与谐波的频率值对应的谐波的幅值；谐波判断模块3，连接谐波检测模块2，接收谐波的幅值，谐波判断模块3用于判断谐波的幅值的最大值与一阈值的大小关系；谐波补偿模块4，连接谐波判断模块3，基于谐波判断模块3的判断结果输出谐波补偿量、；基波控制模块5，连接逆变器的三相交流输出电压端采集逆变器的三相交流电流信号，以及连接电压采样模块1接收d-q轴电压分量、，基波控制模块5基于d-q轴电压分量、输出基波电压控制量、；信号调制模块6，连接谐波补偿模块4和基波控制模块5，接收谐波补偿量和基波电压控制量的叠加量，信号调制模块6基于谐波补偿量和基波电压控制量的叠加量向逆变器输出开关管驱动信号。现有技术中，日用逆变器是电动船舶电机驱动的动力来源，主要功能是将直流母排上直流电逆变成日用负载可使用的三相交流电。日用逆变器配置电压采集卡，该采集信号用于电压闭环控制，可以有效控制输出电压的稳定。通常要求逆变器输出完美正弦波，电网谐波水平被严格控制在5%以内，可以满足船级社要求和船舶日用电的需求，现有技术中由于受到脉冲宽度调制载波比相对较低、死区和非线性负载等因素的影响，逆变器输出电压容易发生畸变，降低了供电系统电能质量；本发明的目的是为了解决逆变器低载波比、死区和非线性负载造成输出电压畸变问题，提出一种功率模块电能质量优化控制系统及方法，可以适用于电动船日用逆变器应用场合。在一种较优的实施例中，请进一步参照图1所示，本发明还包括滤波器设计模块7，滤波器设计模块7连接谐波检测模块2向谐波检测模块2输出二阶低通滤波器各项系数，以及连接谐波补偿模块4向谐波补偿模块4输出二阶带通滤波器各项系数。本发明所述控制系统包括电压采样模块1、谐波检测模块2、谐波判断模块3、谐波补偿模块4、基波控制模块5、信号调制模块6和滤波器设计模块7组成；电压采样模块1接到逆变器三相交流线上，输出信号分别给谐波检测模块2和基波控制模块5，谐波检测模块2输出连接谐波判断模块3，谐波判断模块3输出与基波控制模块5叠加，作为信号调制模块6的输入，信号调制模块6输出驱动信号给开关管，滤波器设计模块7分别连接谐波检测模块2和谐波补偿模块4；较优的，本发明可以实现逆变器输出电压中叠加的多种谐波分量自适应检测及消除，降低电压畸变率，有效提高电能质量。请进一步参照图1所示，本发明所连接的逆变器主回路含有储能电池、电压源型逆变器、电流互感器、输出LC滤波器、电压互感器和负载，其中电压源型变流器由三相桥式全控型电力电子器件构成，电流互感器采集桥臂侧三相电流信号，电压互感器采集负载侧三相电压信号，负载可以为电阻、电容、电感或者非线性等负载。在一种较优的实施例中，如图2所示，谐波检测模块2包括，第一二阶低通滤波器21，第一二阶低通滤波器21的接收端连接一第一运算器23和一第二运算器24的输出端，第一运算器23用于将d轴电压分量与相乘，第二运算器24用于将d轴电压分量与相乘；其中t表示时间值；第二二阶低通滤波器22，第二二阶低通滤波器22的接收端连接一第三运算器25和一第四运算器26的输出端，第三运算器25用于将q轴电压分量与相乘，第二运算器24用于将q轴电压分量与；幅值运算器23，连接第一二阶低通滤波器21和第二二阶低通滤波器22的输出端，基于接收第一二阶低通滤波器21输出的d轴电压中谐波2倍频分量的实部和虚部以及接收第二二阶低通滤波器22输出的q轴电压中谐波2倍频分量的实部和虚部输出与谐波的频率值对应的谐波的幅值。具体地，第一二阶低通滤波器21和第二二阶低通滤波器22分别连接滤波器设计模块7，接收滤波器设计模块7提供的二阶低通滤波器各项系数。具体地，由于逆变器低载波比、死区和非线性负载会造成电压信号中含有多次谐波分量，其表达式为，其中，表示电压直流分量幅值，X和Y分别表示信号正弦和余弦分量幅值，下标j表示谐波次数；具体地，谐波检测模块2将d轴电压分量与和相乘，其表达式为，；；进一步地，再经过第一二阶低通滤波器21得到d轴电压中谐波2倍频分量的实部和虚部，其表达式为：；；将截止频率、品质因数输入滤波器设计模块7，二阶低通滤波器的时域表达式为，其中为截止频率，为品质因数，s为拉普拉斯算子；进一步的，通过进行s域到z域变换，可以得到滤波器的离散表达式为，其中，z为离散拉普拉斯算子，、、为分子项系数，、为分母项系数，该系数与输入频率值和品质因数相关。在一种较优的实施例中，如图3所示，谐波补偿模块4包括，增益运算器41，连接谐波判断模块3，接收谐波判断模块3传输的d-q轴电压分量、，增益运算器41用于对d-q轴电压分量、执行增益运算；第一二阶带通滤波器42，连接增益运算器41的第一输出端，接收增益运算器41的第一运算结果并输出d轴谐波补偿量；第二二阶带通滤波器43，连接增益运算器41的第二输出端，接收增益运算器41的第二运算结果并输出q轴谐波补偿量。具体地，第一二阶带通滤波器42和第二二阶带通滤波器43分别连接滤波器设计模块7，接收滤波器设计模块7提供的二阶带通滤波器各项系数。具体地，将与谐波的幅值的最大值相对应的频率值、品质因数输入一滤波器设计模块7，获得二阶带通滤波器各项系数。具体地，二阶带通滤波器的时域表达式为，进一步的，将d轴电压分量与增益相乘，再经过一第一二阶带通滤波器42获得d轴谐波补偿量；将q轴电压分量与增益相乘，再经过一第二二阶带通滤波器43获得q轴谐波补偿量。在一种较优的实施例中，如图4所示，基波控制模块5包括，一电压环51，电压环51连接电压采样模块1，接收d-q轴电压分量、，并基于给定的一电压目标控制值进行电压调节；一电流环52，连接电压环51的输出端接收电压环51的输出值，并基于接收的三相交流电流信号进行电流调节，输出基波电压控制量、。具体地，基波控制模块5采用双环控制形式，包括电压环51和电流环52控制，输出基波电压控制量、，电压环51给定值为电压目标控制值，反馈值为电压互感器采集的三相电压信号，本发明采用一个比例积分调节器进行电压调节，PI表达式为：其中为电压环51比例项系数，为电压环51积分项系数；电流环52给定值为电压环51的输出值，反馈至为电流互感器采集的三相电流信号、，本发明同样采用一个比例积分调节器进行位置电流调节，PI表达式为：其中为电流环52比例项系数，为电流环52积分项系数。一种功率模块电能质量优化控制方法，应用于任意一项实施例中的功率模块电能质量优化控制系统，如图5，图6所示，包括，步骤S1，电压采样模块1采集逆变器的三相交流电压信号、、，对逆变器的三相交流电压信号、、进行坐标变换获得d-q轴电压分量、；步骤S2，将d-q轴电压分量、输入谐波检测模块2，获得与谐波的频率值对应的谐波的幅值；步骤S3，将谐波的幅值输入谐波判断模块3，谐波判断模块3选择谐波的幅值的最大值，并判断与阈值的大小关系，若谐波的幅值的最大值大于阈值AT，则执行步骤S4；否则，设置谐波补偿量、为0，执行步骤S5；步骤S4，将d-q轴电压分量、、谐波的幅值的最大值以及与谐波的幅值的最大值相对应的频率值输入谐波补偿模块4，获得谐波补偿量、；步骤S5，基波控制模块5基于d-q轴电压分量、以及三相交流电压信号输出基波电压控制量、；将谐波补偿量、和基波电压控制量、叠加后输入至信号调制模块6，获得开关管驱动信号。具体地，本实施例中电压采样模块1采集逆变器的三相交流电压信号、、，将逆变器的三相交流电压信号、、坐标变换到与逆变器角频率同步旋转的d-q坐标系中，获得d-q轴电压分量、。需要说明的是，本发明所提到的阈值由谐波总畸变率目标值以及基波分量幅值决定。在一种较优的实施例中，如图7所示，步骤S2包括，步骤S20，将截止频率、品质因数输入一滤波器设计模块7，获得二阶低通滤波器各项系数，其表达式为：其中，z为离散拉普拉斯算子，、、为分子项系数，、为分母项系数；步骤S21，将d轴电压分量与和相乘，经过第一二阶低通滤波器21得到d轴电压中谐波2倍频分量的实部和虚部，其中t表示时间值；以及；将q轴电压分量与和相乘，经过第二二阶低通滤波器22得到q轴电压中谐波2倍频分量的实部和虚部；步骤S22，将d轴电压中谐波2倍频分量的实部和虚部和q轴电压中谐波2倍频分量的实部和虚部通过一幅值运算器23，获得与谐波的频率值对应的谐波的幅值。在一种较优的实施例中，幅值运算器23的表达式为，。具体地，幅值运算器23将d轴电压中谐波2倍频分量的实部和虚部和q轴电压中谐波2倍频分量的实部和虚部相加并开根号，得到谐波的频率值对应的谐波的幅值。在一种较优的实施例中，如图8所示，步骤S4包括，步骤S40，将与谐波的幅值的最大值相对应的频率值、品质因数输入一滤波器设计模块7，获得二阶带通滤波器各项系数，其表达式为：其中，z为离散拉普拉斯算子，、、为分子项系数，、为分母项系数；步骤S41，将d-q轴电压分量、输入一增益运算器41，将d轴电压分量与增益相乘，输出第一运算结果，将q轴电压分量与增益相乘，输出第二运算结果；步骤S42，将第一运算结果经过一第一二阶带通滤波器42获得d轴谐波补偿量，以及将第二运算结果经过一第二二阶带通滤波器43获得q轴谐波补偿量。在一种较优的实施例中，如图9所示，步骤S5中基波控制模块5工作过程包括，步骤S51，将一电压目标控制值作为给定值，将d-q轴电压分量、，作为反馈值输入至一电压环51，电压环51进行电压调节，表达式为，其中为电压环51比例项系数，为电压环51积分项系数；步骤S52，将电压环51的输出值作为给定值，将经坐标变换后的逆变器的三相交流电流信号作为反馈值输入一电流环52，电流环52进行电流调节，输出基波电压控制量、，表达式为，其中为电流环52比例项系数，为电流环52积分项系数。综上，本发明提出基于多种谐波分量的自适应检测及消除算法，并且考虑品质因数对滤波器进行在线式设计，无需增加额外谐波检测及补偿装置，即可以实现逆变器实时谐波补偿，可以适用于负荷变换、投切等各种动态工况；本发明提出融合基波控制模块5和谐波补偿模块4的电能质量优化控制系统，当检测谐波含量高于目标值时，谐波补偿模块4和基波控制模块5共同工作；当检测谐波含量低于目标值时，切除谐波补偿模块4，单独保留基波控制模块5，可以降低运算成本，同时保证供电系统具有较高的电能质量。以上所述仅为本发明较佳的实施例，并非因此限制本发明的实施方式及保护范围，对于本领域技术人员而言，应当能够意识到凡运用本发明说明书及图示内容所作出的等同替换和显而易见的变化所得到的方案，均应当包含在本发明的保护范围内。
