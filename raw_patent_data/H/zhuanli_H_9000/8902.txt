标题title
一种多中心的群签名密钥生成方法
摘要abst
本发明公开一种多中心的群签名密钥生成方法，涉及密钥生成技术领域；本发明为用户生成私钥的主密钥由多个密钥生成中心联合生成且分散在不同的密钥生成中心，有利于防止密钥泄露，在追踪和撤销非法用户时，同样需要多个密钥生成中心协作完成，与单个密钥生成中心的功能相比，有利于防止用户身份泄露，并且本发明方法可以很好应用在依赖原BBS04群签名的场景中，具有较强的普适性。
权利要求书clms
1.一种多中心的群签名密钥生成方法，其特征是通过各密钥生成中心分别利用KeyGen算法生成各自的加法同态加密公钥和私钥，并公布各自的加法同态加密公钥；通过各密钥生成中心进行交互，生成用户的群私钥并安全发放给用户，其中通过各密钥生成中心利用KeyGen算法生成主私钥份额，公钥份额及承诺，并广播承诺，通过各密钥生成中心均收到全部的承诺后广播公钥份额，各密钥生成中心收到其它密钥生成中心广播的公钥份额后，验证承诺，验证通过则使用公钥份额计算获得群公钥，通过各密钥生成中心生成用户私钥的第一部分份额，对主私钥份额和用户私钥的第一部分份额之和进行同态加密，生成私钥份额密文并广播，通过各密钥生成中心生成随机数，用随机数对其他密钥生成中心的私钥份额密文随机化，并将随机化后的私钥份额密文发送给对应的密钥生成中心，通过各密钥生成中心收到其他密钥生成中心随机化的私钥份额密文后，解密私钥份额密文得到随机化后的私钥份额明文，对私钥份额明文进行处理操作，将操作后的私钥份额明文进行广播，通过各密钥生成中心利用操作后的私钥份额明文生成用户私钥第二部分份额和用户私钥第二部分份额的承诺，并广播所述承诺，通过各密钥生成中心均收到所述承诺后，广播所述用户私钥第二部分份额，通过各密钥生成中心验证用户私钥第二部分份额的承诺，验证通过后通过用户私钥第二部分份额计算用户私钥的第二部分，并将用户私钥的第一部分份额和第二部分安全发放给用户，通过用户利用用户私钥的第一部分份额和第二部分计算获得完整的用户私钥；通过用户利用群公钥和用户私钥对相关信息进行签名和验签；通过各密钥生成中心进行交互，若存在被撤销用户则揭示被撤销用户的用户私钥；通过各密钥生成中心进行交互，更新群公钥和用户私钥，并安全发放给用户。2.根据权利要求1所述的一种多中心的群签名密钥生成方法，其特征是所述通过用户利用群公钥和用户私钥对相关信息进行签名和验签，包括：利用BBS04群签名的签名算法根据群公钥和用户私钥对相关消息进行签名，利用BBS04群签名的验证算法对相关消息进行验签。3.根据权利要求1或2所述的一种多中心的群签名密钥生成方法，其特征是所述揭示被撤销用户的用户私钥，包括：通过各密钥生成中心计算主私钥份额相关的揭示数据和主私钥份额相关的揭示数据的承诺，并广播承诺，通过各密钥生成中心在均收到承诺后，广播主私钥份额相关的揭示数据，通过各密钥生成中心验证承诺是否正确，若正确，计算用户私钥的第二部分，并广播用户私钥的第一部分份额，否则，退出，通过各密钥生成中心生计算出完整的用户私钥并向其他所有用户公布被撤销的用户私钥。4.根据权利要求1所述的一种多中心的群签名密钥生成方法，其特征是所述更新群公钥和用户私钥，包括：通过各密钥生成中心更新群公钥，通过各密钥生成中心计算更新后用户私钥的第二部分份额，并计算更新后用户私钥的第二部分份额的承诺进行广播，通过各密钥生成中心均收到承诺后，广播更新后用户私钥的第二部分份额，通过各密钥生成中心验证承诺是否正确，若正确，计算出更新后用户私钥的第二部分并安全发送至用户，否则，结束，通过更新后用户私钥的第二部分进行用户私钥的更新。5.一种多中心的群签名密钥生成装置，其特征是包括密钥生成管理模块及发送模块，通过密钥生成管理模块各密钥生成中心分别利用KeyGen算法生成各自的加法同态加密公钥和私钥，并公布各自的加法同态加密公钥；通过密钥生成管理模块各密钥生成中心进行交互，生成用户的群私钥并安全发放给用户，其中通过各密钥生成中心利用KeyGen算法生成主私钥份额，公钥份额及承诺，并广播承诺，通过密钥生成管理模块各密钥生成中心均收到全部的承诺后广播公钥份额，各密钥生成中心收到其它密钥生成中心广播的公钥份额后，验证承诺，验证通过则使用公钥份额计算获得群公钥，通过密钥生成管理模块各密钥生成中心生成用户私钥的第一部分份额，对主私钥份额和用户私钥的第一部分份额之和进行同态加密，生成私钥份额密文并广播，通过密钥生成管理模块各密钥生成中心生成随机数，用随机数对其他密钥生成中心的私钥份额密文随机化，并将随机化后的私钥份额密文发送给对应的密钥生成中心，通过密钥生成管理模块各密钥生成中心收到其他密钥生成中心随机化的私钥份额密文后，解密私钥份额密文得到随机化后的私钥份额明文，对私钥份额明文进行处理操作，将操作后的私钥份额明文进行广播，通过密钥生成管理模块各密钥生成中心利用操作后的私钥份额明文生成用户私钥第二部分份额和用户私钥第二部分份额的承诺，并广播所述承诺，通过密钥生成管理模块各密钥生成中心均收到所述承诺后，广播所述用户私钥第二部分份额，通过密钥生成管理模块各密钥生成中心验证用户私钥第二部分份额的承诺，验证通过后通过用户私钥第二部分份额计算用户私钥的第二部分，并通过发送模块将用户私钥的第一部分份额和第二部分安全发放给用户，通过密钥生成管理模块用户利用用户私钥的第一部分份额和第二部分计算获得完整的用户私钥；通过密钥生成管理模块用户利用群公钥和用户私钥对相关信息进行签名和验签；通过密钥生成管理模块各密钥生成中心进行交互，若存在被撤销用户则揭示被撤销用户的用户私钥；通过密钥生成管理模块各密钥生成中心进行交互，更新群公钥和用户私钥，并通过发送模块将更新的群公钥和用户私钥安全发放给用户。6.根据权利要求5所述的一种多中心的群签名密钥生成装置，其特征是所述通过密钥生成管理模块用户利用群公钥和用户私钥对相关信息进行签名和验签，包括：利用BBS04群签名的签名算法根据群公钥和用户私钥对相关消息进行签名，利用BBS04群签名的验证算法对相关消息进行验签。7.根据权利要求5或6所述的一种多中心的群签名密钥生成装置，其特征是所述通过密钥生成管理模块揭示被撤销用户的用户私钥，包括：通过密钥生成管理模块各密钥生成中心计算主私钥份额相关的揭示数据和主私钥份额相关的揭示数据的承诺，并广播承诺，通过密钥生成管理模块各密钥生成中心在均收到承诺后，广播主私钥份额相关的揭示数据，通过密钥生成管理模块各密钥生成中心验证承诺是否正确，若正确，计算用户私钥的第二部分，并广播用户私钥的第一部分份额，否则，退出，通过密钥生成管理模块各密钥生成中心生计算出完整的用户私钥并向其他所有用户公布被撤销的用户私钥。8.根据权利要求5所述的一种多中心的群签名密钥生成装置，其特征是所述通过密钥生成管理模块更新群公钥和用户私钥，包括：通过密钥生成管理模块各密钥生成中心更新群公钥，通过密钥生成管理模块各密钥生成中心计算更新后用户私钥的第二部分份额，并计算更新后用户私钥的第二部分份额的承诺进行广播，通过密钥生成管理模块各密钥生成中心均收到承诺后，广播更新后用户私钥的第二部分份额，通过密钥生成管理模块各密钥生成中心验证承诺是否正确，若正确，计算出更新后用户私钥的第二部分并安全发送至用户，否则，结束，通过密钥生成管理模块更新后用户私钥的第二部分进行用户私钥的更新。
说明书desc
技术领域本发明公开一种方法，涉及密钥生成技术领域，具体地说是一种多中心的群签名密钥生成方法。背景技术为了实现用户匿名、以及对非法匿名用户的签名追踪，群签名得到了广泛的应用。但在群签名中，密钥分发和签名追踪相关的密钥都完全掌握在一个密钥生成中心中，不能完全避免密钥和用户身份隐私的泄露。发明内容本发明针对现有技术的问题，提供一种多中心的群签名密钥生成方法，实现群签名实现多中心的密钥分发与用户追踪，以增强群签名用户的密钥安全,更好地保护用户隐私。本发明提出的具体方案是：一种多中心的群签名密钥生成方法，通过各密钥生成中心分别利用KeyGen算法生成各自的加法同态加密公钥和私钥，并公布各自的加法同态加密公钥；通过各密钥生成中心进行交互，生成用户的群私钥并安全发放给用户，其中通过各密钥生成中心利用KeyGen算法生成主私钥份额，公钥份额及承诺，并广播承诺，通过各密钥生成中心均收到全部的承诺后广播公钥份额，各密钥生成中心收到其它密钥生成中心广播的公钥份额后，验证承诺，验证通过则使用公钥份额计算获得群公钥，通过各密钥生成中心生成用户私钥的第一部分份额，对主私钥份额和用户私钥的第一部分份额之和进行同态加密，生成私钥份额密文并广播，通过各密钥生成中心生成随机数，用随机数对其他密钥生成中心的私钥份额密文随机化，并将随机化后的私钥份额密文发送给对应的密钥生成中心，通过各密钥生成中心收到其他密钥生成中心随机化的私钥份额密文后，解密私钥份额密文得到随机化后的私钥份额明文，对私钥份额明文进行处理操作，将操作后的私钥份额明文进行广播，通过各密钥生成中心利用操作后的私钥份额明文生成用户私钥第二部分份额和用户私钥第二部分份额的承诺，并广播所述承诺，通过各密钥生成中心均收到所述承诺后，广播所述用户私钥第二部分份额，通过各密钥生成中心验证用户私钥第二部分份额的承诺，验证通过后通过用户私钥第二部分份额计算用户私钥的第二部分，并将用户私钥的第一部分份额和第二部分安全发放给用户，通过用户利用用户私钥的第一部分份额和第二部分计算获得完整的用户私钥；通过用户利用群公钥和用户私钥对相关信息进行签名和验签；通过各密钥生成中心进行交互，若存在被撤销用户则揭示被撤销用户的用户私钥；通过各密钥生成中心进行交互，更新群公钥和用户私钥，并安全发放给用户。进一步，所述的一种多中心的群签名密钥生成方法中所述通过用户利用群公钥和用户私钥对相关信息进行签名和验签，包括：利用BBS04群签名的签名算法根据群公钥和用户私钥对相关消息进行签名，利用BBS04群签名的验证算法对相关消息进行验签。进一步，所述的一种多中心的群签名密钥生成方法中所述揭示被撤销用户的用户私钥，包括：通过各密钥生成中心计算主私钥份额相关的揭示数据和主私钥份额相关的揭示数据的承诺，并广播承诺，通过各密钥生成中心在均收到承诺后，广播主私钥份额相关的揭示数据，通过各密钥生成中心验证承诺是否正确，若正确，计算用户私钥的第二部分，并广播用户私钥的第一部分份额，否则，退出，通过各密钥生成中心生计算出完整的用户私钥并向其他所有用户公布被撤销的用户私钥。进一步，所述的一种多中心的群签名密钥生成方法中所述更新群公钥和用户私钥，包括：通过各密钥生成中心更新群公钥，通过各密钥生成中心计算更新后用户私钥的第二部分份额，并计算更新后用户私钥的第二部分份额的承诺进行广播，通过各密钥生成中心均收到承诺后，广播更新后用户私钥的第二部分份额，通过各密钥生成中心验证承诺是否正确，若正确，计算出更新后用户私钥的第二部分并安全发送至用户，否则，结束，通过更新后用户私钥的第二部分进行用户私钥的更新。本发明还提供一种多中心的群签名密钥生成装置，包括密钥生成管理模块及发送模块，通过密钥生成管理模块各密钥生成中心分别利用KeyGen算法生成各自的加法同态加密公钥和私钥，并公布各自的加法同态加密公钥；通过密钥生成管理模块各密钥生成中心进行交互，生成用户的群私钥并安全发放给用户，其中通过各密钥生成中心利用KeyGen算法生成主私钥份额，公钥份额及承诺，并广播承诺，通过密钥生成管理模块各密钥生成中心均收到全部的承诺后广播公钥份额，各密钥生成中心收到其它密钥生成中心广播的公钥份额后，验证承诺，验证通过则使用公钥份额计算获得群公钥，通过密钥生成管理模块各密钥生成中心生成用户私钥的第一部分份额，对主私钥份额和用户私钥的第一部分份额之和进行同态加密，生成私钥份额密文并广播，通过密钥生成管理模块各密钥生成中心生成随机数，用随机数对其他密钥生成中心的私钥份额密文随机化，并将随机化后的私钥份额密文发送给对应的密钥生成中心，通过密钥生成管理模块各密钥生成中心收到其他密钥生成中心随机化的私钥份额密文后，解密私钥份额密文得到随机化后的私钥份额明文，对私钥份额明文进行处理操作，将操作后的私钥份额明文进行广播，通过密钥生成管理模块各密钥生成中心利用操作后的私钥份额明文生成用户私钥第二部分份额和用户私钥第二部分份额的承诺，并广播所述承诺，通过密钥生成管理模块各密钥生成中心均收到所述承诺后，广播所述用户私钥第二部分份额，通过密钥生成管理模块各密钥生成中心验证用户私钥第二部分份额的承诺，验证通过后通过用户私钥第二部分份额计算用户私钥的第二部分，并通过发送模块将用户私钥的第一部分份额和第二部分安全发放给用户，通过密钥生成管理模块用户利用用户私钥的第一部分份额和第二部分计算获得完整的用户私钥；通过密钥生成管理模块用户利用群公钥和用户私钥对相关信息进行签名和验签；通过密钥生成管理模块各密钥生成中心进行交互，若存在被撤销用户则揭示被撤销用户的用户私钥；通过密钥生成管理模块各密钥生成中心进行交互，更新群公钥和用户私钥，并通过发送模块将更新的群公钥和用户私钥安全发放给用户。进一步，所述的一种多中心的群签名密钥生成装置中所述通过密钥生成管理模块用户利用群公钥和用户私钥对相关信息进行签名和验签，包括：利用BBS04群签名的签名算法根据群公钥和用户私钥对相关消息进行签名，利用BBS04群签名的验证算法对相关消息进行验签。进一步，所述的一种多中心的群签名密钥生成装置中所述通过密钥生成管理模块揭示被撤销用户的用户私钥，包括：通过密钥生成管理模块各密钥生成中心计算主私钥份额相关的揭示数据和主私钥份额相关的揭示数据的承诺，并广播承诺，通过密钥生成管理模块各密钥生成中心在均收到承诺后，广播主私钥份额相关的揭示数据，通过密钥生成管理模块各密钥生成中心验证承诺是否正确，若正确，计算用户私钥的第二部分，并广播用户私钥的第一部分份额，否则，退出，通过密钥生成管理模块各密钥生成中心生计算出完整的用户私钥并向其他所有用户公布被撤销的用户私钥。进一步，所述的一种多中心的群签名密钥生成装置中所述通过密钥生成管理模块更新群公钥和用户私钥，包括：通过密钥生成管理模块各密钥生成中心更新群公钥，通过密钥生成管理模块各密钥生成中心计算更新后用户私钥的第二部分份额，并计算更新后用户私钥的第二部分份额的承诺进行广播，通过密钥生成管理模块各密钥生成中心均收到承诺后，广播更新后用户私钥的第二部分份额，通过密钥生成管理模块各密钥生成中心验证承诺是否正确，若正确，计算出更新后用户私钥的第二部分并安全发送至用户，否则，结束，通过密钥生成管理模块更新后用户私钥的第二部分进行用户私钥的更新。本发明的有益之处是：本方案提出了一种多中心的群签名密钥生成方法，为用户生成私钥的主密钥由多个密钥生成中心联合生成且分散在不同的密钥生成中心，有利于防止密钥泄露，在追踪和撤销非法用户时，同样需要多个密钥生成中心协作完成，与单个密钥生成中心的功能相比，有利于防止用户身份泄露，并且本发明方法可以很好应用在依赖原BBS04群签名的场景中，具有较强的普适性。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。图1是本发明方法流程示意图。具体实施方式非对称加密：非对称加密包含如下算法：1.密钥生成KeyGen：生成公私钥pk,sk；2.加密Enc:输入公钥pk和明文m，输出密文c；3.解密Dec:输入私钥sk和密文c,输出明文m。加法同态加密：加法同态加密是特殊的非对称加密算法，除了具有非对称加密的密钥生成KeyGen、加密Enc、解密Dec算法外，还支持加法同态运算和数乘运算，设x,y,z均为整数，则上述运算满足如下性质：双线性映射：本文涉及的双线性映射的参数含义和性质如下：1.G1和G2都是阶为p的循环群；2g1是G1的生成元，g2是G2的生成元；3.ψ是G2到G1的可计算同构，有ψ＝g1；4.e是可计算的映射，可以将G1,G2映射到GT群,且满足：对任意的u∈G1,v∈G2和整数a,b,有e＝eab且e≠1。BBS04群签名：在群签名中，群体中的任意一个成员能够以匿名的方式对消息进行签名,且验证者无法区分是群体中的哪个成员生成的该签名，只有密钥生成中心可以追踪到签名由哪个用户生成。BBS04签名是基于双线性映射的一种群签名。密钥生成KeyGen：选择G2群中的生成元g2，计算g1＝ψ；随机选择G1中非g1的元素h和中的元素ξ1,ξ2并计算从中随机选择γ,计算对用户i,随机选择模p整数群中的xi，计算群公钥为gpk＝，主私钥为gmsk＝，第i个用户的私钥为gsk＝；签名Sign:输入用户自己的私钥gsk、群公钥gpk、消息M，输出签名σ,具体流程为：在Zp中随机选择α,β,rα,rβ,rx,计算R2＝vβ,c＝H,sα＝rα+cα,sβ＝rβ+cβ,sx＝rx+cx,签名验证Verify,输入群公钥gpk，消息M，签名σ,输出σ是否是M签名。具体流程为:计算验证c＝H是否成立，成立说明签名有效，否则，说明签名无效。揭示Open,输入群公钥gpk，主私钥gmsk，签名σ,输出对应用户的身份，具体流程为:计算通过A检索用户的私钥x，并公布。撤销Revoke,输入被撤销用户的私钥,群公钥gpk,用户私钥gsk,输出更新后的群公钥和群私钥gpk′,gsk′,具体流程为：g′1＝ψ,g′2＝A,w′＝g2A-x,则更新后的群公钥gpk′＝,更新后用户私钥为gsk′＝。下面结合附图和具体实施例对本发明作进一步说明，以使本领域的技术人员可以更好地理解本发明并能予以实施，但所举实施例不作为对本发明的限定。本发明提供一种多中心的群签名密钥生成方法，通过各密钥生成中心分别利用KeyGen算法生成各自的加法同态加密公钥和私钥，并公布各自的加法同态加密公钥；通过各密钥生成中心进行交互，生成用户的群私钥并安全发放给用户，其中通过各密钥生成中心利用KeyGen算法生成主私钥份额，公钥份额及承诺，并广播承诺，通过各密钥生成中心均收到全部的承诺后广播公钥份额，各密钥生成中心收到其它密钥生成中心广播的公钥份额后，验证承诺，验证通过则使用公钥份额计算获得群公钥，通过各密钥生成中心生成用户私钥的第一部分份额，对主私钥份额和用户私钥的第一部分份额之和进行同态加密，生成私钥份额密文并广播，通过各密钥生成中心生成随机数，用随机数对其他密钥生成中心的私钥份额密文随机化，并将随机化后的私钥份额密文发送给对应的密钥生成中心，通过各密钥生成中心收到其他密钥生成中心随机化的私钥份额密文后，解密私钥份额密文得到随机化后的私钥份额明文，对私钥份额明文进行处理操作，将操作后的私钥份额明文进行广播，通过各密钥生成中心利用操作后的私钥份额明文生成用户私钥第二部分份额和用户私钥第二部分份额的承诺，并广播所述承诺，通过各密钥生成中心均收到所述承诺后，广播所述用户私钥第二部分份额，通过各密钥生成中心验证用户私钥第二部分份额的承诺，验证通过后通过用户私钥第二部分份额计算用户私钥的第二部分，并将用户私钥的第一部分份额和第二部分安全发放给用户，通过用户利用用户私钥的第一部分份额和第二部分计算获得完整的用户私钥；通过用户利用群公钥和用户私钥对相关信息进行签名和验签；通过各密钥生成中心进行交互，若存在被撤销用户则揭示被撤销用户的用户私钥；通过各密钥生成中心进行交互，更新群公钥和用户私钥，并安全发放给用户。具体应用中，在本发明方法的实施例中，例如包含m个密钥生成中心，分别为KGCj,1≤j≤m；包含n个用户,分别为Useri,1≤i≤n；使用了同态加密技术和BBS04群签名算法；涉及的参数及其含义分别为：H为哈希函数,p为大素数，G1,G2为双线性映射相关的阶为p的循环群；ψ:G2群到G1群的映射，g1,h:G1群中的生成元，g2:G2群中的生成元。每个密钥生成中心KGCj都运行加法同态加密的KeyGen算法，分别生成各自的加法同态加密公钥hpkj和私钥hskj，并公布各自的加法同态加密公钥hpkj；通过各密钥生成中心进行交互，生成用户的群私钥并安全发放给用户，具体步骤为：2.1每个密钥生成中心KGCj随机在中选择ξj1,ξj2,γj作为主私钥份额，计算Cj1＝H作为公钥份额和公钥份额的承诺，并广播承诺Cj1，2.2每个密钥生成中心KGCj在所有密钥生成中心收到全部的承诺Cj1后，广播公钥份额uj,vj,wj，2.3每个密钥生成中心KGCj收到其它密钥生成中心在步骤2.2广播的公钥份额uj,vj,wj后，验证Cj1＝H是否成立：若成立，计算u＝u1+u2+…+um,v＝v1+v2+…+vm,w＝w1+w2+…+wm作为公钥；否则，说明有密钥生成中心造假，结束执行该方案，2.4对每个用户Useri,每个密钥生成中心KGCj随机在中选择xji用户私钥第一部分的份额,计算dji＝xji+γj,cji24＝Enc，广播该轮密文cji24，2.5每个密钥生成中心KGCj从中随机选择wji。每收到来自其他密钥生成中心KGCk广播的密文cki24后,从中随机选择vjik，计算密文并将密文cji25k发送给对应的KGCk，2.6每个密钥生成中心KGCj在收到其余密钥生成中心KGCk发送给自己的密文cki25j后，解密得到明文mki25j＝Dec；计算yji＝wjidji+∑1≤k≤m,k≠j mki25j-vjik并广播yji，2.7每个密钥生成中心KGCj收到其他密钥生成中心广播的yji后，计算sji27＝-1wji,计算用户私钥的第二部分份额及其承诺Cj2＝H,广播承诺Cj2，2.8每个密钥生成中心KGCj在所有密钥生成中心收到全部承诺Cj2后，广播用户私钥的第二部分份额Aji，2.9每个密钥生成中心KGCj在收到所有的Aji后，验证Cj2＝H是否成立，若成立，计算Ai＝∑1≤j≤mAji,将xji和Ai安全发送给Useri；否则，结束执行协议，2.10Useri计算xi＝∑1≤j≤mxji作为用户私钥的第一部分，用户私钥gsk＝,群公钥gpk＝；通过用户利用群公钥和用户私钥对相关信息进行签名和验签，进一步，具体步骤为：3.1通过用户Useri调用BBS04的签名算法Sign可生成签名3.2调用BBS04的验证算法Verify可对群签名是否有效进行验证；通过各密钥生成中心进行交互，若存在被撤销用户则揭示被撤销用户的用户私钥，进一步地，具体步骤为：设要揭示的签名为每个密钥生成中心KGCj计算部分揭示参数份额及其承诺：广播承诺4.2每个密钥生成中心KGCj在所有密钥生成中心都接收到承诺后，广播揭示参数份额Tj，4.3每个密钥生成中心KGCj在收到Tj后，验证是否成立：若成立，计算揭示参数A＝T3/，并检索步骤2.9中生成A时使用的用户私钥的第一部分份额xji,广播xji；否则，退出执行协议，4.4每个密钥生成中心KGCj计算用户私钥的第一部分x＝∑1≤j≤mxji,向所有用户公布被撤销用户的私钥；通过各密钥生成中心进行交互，更新群公钥和用户私钥，并安全发放给用户，进一步地，具体步骤为：5.1对于撤销用户的私钥，各密钥生成中心KGCj计算g′2＝A,g′1＝ψ,w′＝g2A-x,更新群公钥为gpk′＝，5.2对每个没有被撤销的用Useri,每个密钥生成中心KGCj计算新用户私钥的第二部分份额及承诺：Cj3＝H,广播承诺Cj3，5.3每个密钥生成中心KGCj在所有密钥生成中心收到全部承诺Cj3后，广播新用户私钥的第二部分份额A’ji，5.4每个密钥生成中心KGCj在收到所有的A′ji后，验证Cj3＝H是否成立，若成立，计算新用户私钥的第二部分A′i＝∑1≤j≤mA′ji,将A′i安全发送给未被撤销的用户Useri；否则，结束执行协议，5.5未被撤销的用户Useri将私钥更新为gsk＝。本发明方法为群签名实现多中心的密钥分发与用户追踪方案，以增强群签名用户的密钥安全,更好地保护用户隐私。本发明还提供一种多中心的群签名密钥生成装置，包括密钥生成管理模块及发送模块，通过密钥生成管理模块各密钥生成中心分别利用KeyGen算法生成各自的加法同态加密公钥和私钥，并公布各自的加法同态加密公钥；通过密钥生成管理模块各密钥生成中心进行交互，生成用户的群私钥并安全发放给用户，其中通过各密钥生成中心利用KeyGen算法生成主私钥份额，公钥份额及承诺，并广播承诺，通过密钥生成管理模块各密钥生成中心均收到全部的承诺后广播公钥份额，各密钥生成中心收到其它密钥生成中心广播的公钥份额后，验证承诺，验证通过则使用公钥份额计算获得群公钥，通过密钥生成管理模块各密钥生成中心生成用户私钥的第一部分份额，对主私钥份额和用户私钥的第一部分份额之和进行同态加密，生成私钥份额密文并广播，通过密钥生成管理模块各密钥生成中心生成随机数，用随机数对其他密钥生成中心的私钥份额密文随机化，并将随机化后的私钥份额密文发送给对应的密钥生成中心，通过密钥生成管理模块各密钥生成中心收到其他密钥生成中心随机化的私钥份额密文后，解密私钥份额密文得到随机化后的私钥份额明文，对私钥份额明文进行处理操作，将操作后的私钥份额明文进行广播，通过密钥生成管理模块各密钥生成中心利用操作后的私钥份额明文生成用户私钥第二部分份额和用户私钥第二部分份额的承诺，并广播所述承诺，通过密钥生成管理模块各密钥生成中心均收到所述承诺后，广播所述用户私钥第二部分份额，通过密钥生成管理模块各密钥生成中心验证用户私钥第二部分份额的承诺，验证通过后通过用户私钥第二部分份额计算用户私钥的第二部分，并通过发送模块将用户私钥的第一部分份额和第二部分安全发放给用户，通过密钥生成管理模块用户利用用户私钥的第一部分份额和第二部分计算获得完整的用户私钥；通过密钥生成管理模块用户利用群公钥和用户私钥对相关信息进行签名和验签；通过密钥生成管理模块各密钥生成中心进行交互，若存在被撤销用户则揭示被撤销用户的用户私钥；通过密钥生成管理模块各密钥生成中心进行交互，更新群公钥和用户私钥，并通过发送模块将更新的群公钥和用户私钥安全发放给用户。上述装置内的各模块之间的信息交互、执行过程等内容，由于与本发明方法实施例基于同一构思，具体内容可参见本发明方法实施例中的叙述，此处不再赘述。同样地，通过本发明装置可以实现用户生成私钥的主密钥由多个密钥生成中心联合生成且分散在不同的密钥生成中心，有利于防止密钥泄露，在追踪和撤销非法用户时，同样需要多个密钥生成中心协作完成，与单个密钥生成中心的功能相比，有利于防止用户身份泄露，并且本发明方法可以很好应用在依赖原BBS04群签名的场景中，具有较强的普适性。需要说明的是，上述各流程和各装置结构中不是所有的步骤和模块都是必须的，可以根据实际的需要忽略某些步骤或模块。各步骤的执行顺序不是固定的，可以根据需要进行调整。上述各实施例中描述的系统结构可以是物理结构，也可以是逻辑结构，即，有些模块可能由同一物理实体实现，或者，有些模块可能分由多个物理实体实现，或者，可以由多个独立设备中的某些部件共同实现。以上所述实施例仅是为充分说明本发明而所举的较佳的实施例，本发明的保护范围不限于此。本技术领域的技术人员在本发明基础上所作的等同替代或变换，均在本发明的保护范围之内。本发明的保护范围以权利要求书为准。
