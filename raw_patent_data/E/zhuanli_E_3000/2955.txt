标题title
基于贝叶斯的抽油机无监督在线突变点检测及融合方法
摘要abst
本发明涉及一种基于贝叶斯的抽油机无监督在线突变点检测及融合方法。首先，利用示功图和五个过程测量变量对设备的运行状态监测；为了解决示功图数据维数较高且存在异常值的问题，定义了一种基于弦比指数的鲁棒Douglas‑Peucker压缩算法，并且在示功图近似过程中，利用两个矩阵范数获取DP算法中阈值的大小；此外，利用基于贝叶斯的在线突变点检测方法检测抽油机中的单变量故障；最后，基于贝叶斯全概率公式的故障决策级融合算法，实现抽油机设备的在线无监督突变点检测。本发明能够将多个变量的故障检测结果进行决策级融合，并解决了数据标签困难，复杂工业设备故障检测实时性较差的问题，有效提高了抽油机设备的故障检测效果。
权利要求书clms
1.基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，包括以下步骤：变量选择：采集抽油机的位移数据、载荷数据以及5个过程测量变量数据构成测试矩阵；示功图近似：根据抽油机某一时刻的位移数据和载荷数据，绘制该时刻的示功图，并利用压缩算法，对示功图进行压缩，进而获得处理后的抽油机位移数据和载荷数据，并替换测试矩阵中对应采样时刻的原抽油机位移数据和载荷数据；突变点检测及融合：利用基于贝叶斯的无监督在线突变点检测方法，计算测试矩阵中某一个变量在当前时刻的运行长度概率分布即突变点检测结果，利用贝叶斯全概率公式对测试矩阵中多个变量的突变点检测结果进行决策级融合，实现抽油机设备的故障诊断。2.根据权利要求1所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述5个过程测量变量数据分别为：电压、电流、功率、冲程及冲次。3.根据权利要求1所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述测试矩阵A为：A∈Rp×m其中，R表示实数集，p表示采样观测值的数目，m表示采样观测值包含的变量数，其中前m-5个变量为该采样观测值对应时刻的多个位移数据变量和载荷数据变量，后5个变量分别为电压、电流、功率、冲程及冲次变量。4.根据权利要求1所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述示功图近似，具体包括以下步骤：阈值选择：选择某一个示功图矩阵X作为标准示功图，分别设置Douglas-Peucker压缩算法中的不同阈值设置，获取压缩后的示功图矩阵X’，根据矩阵X和矩阵X’分别计算两个矩阵范数||·||0和||·||F，绘制不同阈值情况下，两个矩阵范数的数值曲线，取二者的交集作为Douglas-Peucker压缩算法中的阈值；异常值移除：根据得到的阈值，利用Douglas-Peucker压缩算法对示功图矩阵X进行压缩，在压缩过程中，如果某一个采样观测值的距离大于阈值，则将该采样观测值作为分割点，并计算该分割点的弦比指数cho，如果分割点的cho值大于设定值，则将该分割点认定为异常值，利用分割点前后的点的平均代替此分割点，并重新利用Douglas-Peucker算法对去除异常值后的示功图进行压缩，遍历所有分割点，直到得到最终的压缩曲线，并从压缩曲线中获得抽油机位移数据和载荷数据。5.根据权利要求4所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述两个矩阵范数||·||0和||·||F的计算方法分别为：||·||0：矩阵的l0范数是指矩阵中非0元素的数量，将压缩后的示功图组成的矩阵X’扩展到与原示功图组成的矩阵X相同维度，得到新的示功图矩阵Y，其中缺失的部分利用0元素添加，并计算矩阵Y的零范数，||Y||0表示矩阵Y中非零的个数，可视为示功图的压缩程度；||·||F：矩阵的lF范数是指矩阵中所有元素的平方和的平方根，将压缩后的示功图组成的矩阵X’扩展到与原示功图组成的矩阵X相同维度，得到新的示功图矩阵Z，其中缺失的部分分别利用相邻的两个位移和载荷数据进行补充，分别计算两个相邻位移和载荷数据的位移与载荷斜率，按照缺失的数量进行相应补充。6.根据权利要求4所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述采样观测值的距离为：采样观测值中，某一个包含相应的位移和载荷数据的点到边界点组成的直线的距离，所述边界点为待压缩曲线的两个端点。7.根据权利要求4所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述观测值的弦比指数cho为：其中，pi表示分割点，pi-1表示分割点的前一个点，pi+1表示分割点的后一个点，pp表示直线的中心点，dis表示两点之间距离。8.根据权利要求1所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述利用基于贝叶斯的无监督在线突变点检测方法，计算测试矩阵中某一个数据变量在当前时刻的运行长度概率分布即突变点检测结果，具体为：根据当前时刻t采集到的全部采样观测值x1:t，计算出当前时刻运行长度的概率分布P，即其中，rt是设备在当前采样时刻t的运行长度，x1:t是指1～t的采样点包含的采样观测值。9.根据权利要求1所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述利用贝叶斯全概率公式对测试矩阵中多个变量的突变点检测结果进行决策级融合，具体为：根据单个变量在全部待检测时刻的设备运行长度概率分布P),i＝1,2,...,m，简写为P,i＝1,2,...,m，利用贝叶斯全概率公式对m个变量的突变点检测结果进行融合，得到最终的在每个采样时刻设备运行长度的概率分布PP＝P*P,...,P其中，概率P根据m个变量的运行长度概率分布决定，如果P大于设定值的数量小于阈值,i＝1,2,...,m，则概率P为1，否则概率P为1，rt＝0表示抽油机运行出现故障，rt＝q表示抽油机运行正常，q为抽油机设备的运行长度数值。10.根据权利要求1所述的基于贝叶斯的抽油机无监督在线突变点检测及融合方法，其特征在于，所述抽油机设备的故障诊断，具体为：根据运行长度的后验概率分布判断抽油机是否出现故障，P为当前时刻所有运行长度的概率分布，当设备运行长度为0即P的概率最大时，则说明抽油机设备出现故障，否则无故障。
说明书desc
技术领域本发明涉及石油生产抽油机设备的故障检测领域，具体地说是一种基于贝叶斯的抽油机无监督在线突变点检测及融合方法。背景技术随着国家经济的快速发展，对能源的需求变得越来越大。提高石油开采与监管水平是一个热点的研究话题。在石油生产过程中最重要的部分就是抽油机的管理，每天都需要技术人员进行巡回检查，并主观地记录抽油机的工作状态。然而，油井的分布是杂乱无章的，自然条件也十分恶劣。对抽油机进行实时的故障检测是比较费时和困难的，可能会降低故障响应的速度，降低石油产量。此外，考虑到井下复杂不可预料的运行环境，对于抽油机设备获得有标签的数据是比较难实现的。石油生产是保障民生的一个重要任务，并且安全是第一要素。在选择相应的故障检测方法时，检测时间是一个需要着重考虑的因素。检测时间是指故障被检测出的采样时刻。因此，研究无监督在线的抽油机设备故障检测具有重要意义。发明内容针对现有技术的不足，本发明提供一种基于贝叶斯的抽油机无监督在线突变点检测及融合方法，解决了目前抽油机设备检测存在时滞、数据标签困难及主观性较强的问题。本发明为实现上述目的所采用的技术方案是：基于贝叶斯的抽油机无监督在线突变点检测及融合方法，包括以下步骤：变量选择：采集抽油机的位移数据、载荷数据以及5个过程测量变量数据构成测试矩阵；示功图近似：根据抽油机某一时刻的位移数据和载荷数据，绘制该时刻的示功图，并利用压缩算法，对示功图进行压缩，进而获得处理后的抽油机位移数据和载荷数据，并替换测试矩阵中对应采样时刻的原抽油机位移数据和载荷数据；突变点检测及融合：利用基于贝叶斯的无监督在线突变点检测方法，计算测试矩阵中某一个变量在当前时刻的运行长度概率分布即突变点检测结果，利用贝叶斯全概率公式对测试矩阵中多个变量的突变点检测结果进行决策级融合，实现抽油机设备的故障诊断。所述5个过程测量变量数据分别为：电压、电流、功率、冲程及冲次。所述测试矩阵A为：A∈Rp×m其中，R表示实数集，p表示采样观测值的数目，m表示采样观测值包含的变量数，其中前m-5个变量为该采样观测值对应时刻的多个位移数据变量和载荷数据变量，后5个变量分别为电压、电流、功率、冲程及冲次变量。所述示功图近似，具体包括以下步骤：阈值选择：选择某一个示功图矩阵X作为标准示功图，分别设置Douglas-Peucker压缩算法中的不同阈值设置，获取压缩后的示功图矩阵X’，根据矩阵X和矩阵X’分别计算两个矩阵范数||·||0和||·||F，绘制不同阈值情况下，两个矩阵范数的数值曲线，取二者的交集作为Douglas-Peucker压缩算法中的阈值；异常值移除：根据得到的阈值，利用Douglas-Peucker压缩算法对示功图矩阵X进行压缩，在压缩过程中，如果某一个采样观测值的距离大于阈值，则将该采样观测值作为分割点，并计算该分割点的弦比指数cho，如果分割点的cho值大于设定值，则将该分割点认定为异常值，利用分割点前后的点的平均代替此分割点，并重新利用Douglas-Peucker算法对去除异常值后的示功图进行压缩，遍历所有分割点，直到得到最终的压缩曲线，并从压缩曲线中获得抽油机位移数据和载荷数据。所述两个矩阵范数||·||0和||·||F的计算方法分别为：||·||0：矩阵的l0范数是指矩阵中非0元素的数量，将压缩后的示功图组成的矩阵X’扩展到与原示功图组成的矩阵X相同维度，得到新的示功图矩阵Y，其中缺失的部分利用0元素添加，并计算矩阵Y的零范数，||Y||0表示矩阵Y中非零的个数，可视为示功图的压缩程度；||·||F：矩阵的lF范数是指矩阵中所有元素的平方和的平方根，将压缩后的示功图组成的矩阵X’扩展到与原示功图组成的矩阵X相同维度，得到新的示功图矩阵Z，其中缺失的部分分别利用相邻的两个位移和载荷数据进行补充，分别计算两个相邻位移和载荷数据的位移与载荷斜率，按照缺失的数量进行相应补充。所述采样观测值的距离为：采样观测值中，某一个包含相应的位移和载荷数据的点到边界点组成的直线的距离，所述边界点为待压缩曲线的两个端点。所述观测值的弦比指数cho为：其中，pi表示分割点，pi-1表示分割点的前一个点，pi+1表示分割点的后一个点，pp表示直线的中心点，dis表示两点之间距离。所述利用基于贝叶斯的无监督在线突变点检测方法，计算测试矩阵中某一个数据变量在当前时刻的运行长度概率分布即突变点检测结果，具体为：根据当前时刻t采集到的全部采样观测值x1:t，计算出当前时刻运行长度的概率分布P，即其中，rt是设备在当前采样时刻t的运行长度，x1:t是指1～t的采样点包含的采样观测值。所述利用贝叶斯全概率公式对测试矩阵中多个变量的突变点检测结果进行决策级融合，具体为：根据单个变量在全部待检测时刻的设备运行长度概率分布P),i＝1,2,...,m，简写为P,i＝1,2,...,m，利用贝叶斯全概率公式对m个变量的突变点检测结果进行融合，得到最终的在每个采样时刻设备运行长度的概率分布PP＝P*P,...,PP＝P*P+P*P+,...,+P*P其中，概率P根据m个变量的运行长度概率分布决定，如果P大于设定值的数量小于阈值,i＝1,2,...,m，则概率P为1，否则概率P为1，rt＝0表示抽油机运行出现故障，rt＝q表示抽油机运行正常，q为抽油机设备的运行长度数值。所述抽油机设备的故障诊断，具体为：根据运行长度的后验概率分布判断抽油机是否出现故障，P为当前时刻所有运行长度的概率分布，当设备运行长度为0即P的概率最大时，则说明抽油机设备出现故障，否则无故障。本发明具有以下有益效果及优点：1.本发明利用示功图及五个过程测量变量对抽油机设备的运行状态进行监测，更加完整地利用了设备采集到的信息。在传统利用示功图数据进行故障检测的基础上，考虑了变量的多样性，从多个方面验证设备的运行状态，准确性更好。2.本发明在对示功图数据压缩的过程中，考虑到了异常值的影响，定义一种弦比指数的衡量标准，在数据压缩降低计算复杂性的同时提高了算法的鲁棒性，更加符合抽油机设备运行情况复杂的特征。在示功图压缩过程中，利用两个矩阵范数，同时考虑压缩率与压缩的准确性，在提高运算速度的同时保证了示功图信息的完整性。3.本发明尝试采用一种基于贝叶斯的无监督在线突变点检测方法对抽油机设备进行故障检测，不需要利用任何有标签的数据，并且可以实现实时检测，有效地降低了模型建立的难度，在实际生产中更容易推广。4.本发明再次利用贝叶斯全概率公式，对单变量的故障决策结果进行融合，提高了抽油机设备的故障检测效果。附图说明图1为矩阵范数确定压缩算法阈值的示意图；图2为本发明的方法流程图。具体实施方式下面结合附图及实施例对本发明做进一步的详细说明。为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图对本发明的具体实施方式做详细的说明。在下面的描述中阐述了很多具体细节以便于充分理解本发明。但本发明能够以很多不同于在此描述的其他方式来实施，本领域技术人员可以在不违背发明内涵的情况下做类似改进，因此本发明不受下面公开的具体实施的限制。除非另有定义，本文所使用的所有的技术和科学术语与属于本发明的技术领域的技术人员通常理解的含义相同。本文中在发明的说明书中所使用的术语只是为了描述具体的实施例的目的，不是旨在于限制本发明。如图2所示，一种基于贝叶斯的抽油机无监督在线突变点检测及融合方法包括以下步骤：步骤一：变量选择：分析抽油机运行原理，采集示功图及5个过程测量变量作为后续突变点检测的数据依据。其中示功图利用位移和载荷数据绘制，5个过程测量变量分别为：电压、电流、功率、冲程及冲次。步骤二：示功图近似：采集某一个时刻的位移与载荷数据，绘制相应的示功图。基于Douglas-Peucker压缩算法，设置多个不同阈值，获取压缩前后示功图的两个矩阵范数，绘制矩阵范数曲线，并将交点作为最终DP压缩算法阈值；定义弦比指数剔除示功图中的异常值，并利用鲁棒Douglas-Peucker算法将示功图压缩。步骤三：突变点检测及融合：利用基于贝叶斯的无监督在线突变点检测方法，计算单个变量在当前时刻的运行长度概率分布，并利用贝叶斯全概率公式对多个变量的突变点检测结果进行决策级融合，实现抽油机设备的故障诊断。所述变量选择具体为：采集抽油机运行过程中的变量组成测试矩阵A:A∈Rp×m其中，A表示测试观测值组成的矩阵，R表示实数集，p表示采样观测值的数目，m表示采样观测值包含的变量数，其中前m-5为相应的位移和载荷变量，后5个分别为电压、电流、功率、冲程及冲次变量，采样观测值泛指某一个采样时刻所有的值。所述示功图近似具体为：阈值选择。选择第一个示功图X作为标准示功图，分别将Douglas-Peucker压缩算法中的阈值设置为0.01～0.1,0.2～1,2,3，获取压缩后的示功图X’，根据矩阵X和X’分别计算两个矩阵范数：||·||0和||·||F。具体计算步骤如下：||·||0：矩阵的l0范数是指矩阵中非0元素的数量。将压缩后的示功图组成的矩阵X’扩展到与原始矩阵X相同维度，得到新的示功图矩阵Y，其中缺失的部分利用0元素添加，并计算矩阵Y的零范数，||Y||0表示矩阵Y中非零的个数，可视为示功图的压缩程度；||·||F：矩阵的lF范数是指矩阵中所有元素的平方和的平方根。将压缩后的示功图组成的矩阵X’扩展到与原始矩阵X相同维度，得到新的示功图矩阵Z，其中缺失的部分利用相邻的两个数据进行补充，计算两个相邻数据的位移与载荷斜率，按照缺失的数量进行相应补充。矩阵X与矩阵Z之间的差别可以近似用来描述示功图压缩后的准确性。因此，本发明利用||X-Z||F来描述示功图的压缩效果。绘制不同阈值情况下，两个矩阵范数的数值曲线，取二者的交集作为DP压缩算法中的阈值，示意图如图1所示，其中，横坐标表示阈值的大小，纵坐标则为相应矩阵范数的数值。其中，上图则是在不同阈值情况下，两个矩阵范数的数值；下图则是对交点处进行了放大。从图1中可以看出，对于当前的示功图，两个矩阵范数的交点在0.1处，因此可以将DP压缩算法中的阈值设置为0.1。异常值移除Douglas-Peucker算法是常用的曲线压缩算法之一，下面进行简单叙述。a)在曲线首尾两点A，B之间连接一条直线AB，该直线为曲线的弦；b)得到曲线上离该直线段距离最大的点C，计算其与AB的距离d；c)比较该距离d与预先给定的阈值的大小，如果小于阈值，则该直线段作为曲线的近似，该段曲线处理完毕。d)如果距离大于阈值，则用C将曲线分为两段AC和BC，点C被称作分割点，并分别对两段继续进行前三个步骤的处理。e)当所有曲线都处理完毕时，依次连接各个分割点形成的折线，即可以作为曲线的近似。根据选定的阈值，首先利用传统的Douglas-Peucker算法对示功图进行压缩。在压缩过程中，如果某一个采样观测值的距离大于设定的阈值，则计算该采样观测值的弦比指数，弦比指数的定义为：其中，pi表示分割点，pi-1是分割点的前一个点，pi+1是分割点的后一个点，pp是直线的中心点。如果分割点的cho值大于3，则将该点认定为异常值，利用分割点前后的点的平均代替此分割点，并重新利用Douglas-Peucker算法对示功图进行压缩，直到得到最终的压缩曲线。所述单变量突变点检测具体为：基于贝叶斯的单变量在线无监督突变点检测是根据当前时刻t采集到的全部观测值x1:t，计算出当前时刻过程运行长度的概率分布P，即其中，rt是设备在当前采样时刻t的运行长度，x1:t是指1～t的采样点包含的采样观测值。待检测采样观测值和设备运行长度的联合概率分布P，计算方式具体描述如下。当抽油机运行在正常工况下，设备的运行长度rt则在原来长度的基础上增加1，此时的设备运行长度联合概率分布为：其中，rt是指抽油机运行到当前采样时刻t的运行长度，rt＝rt-1+1表示抽油机处于正常运行状态，运行长度加1；是根据待检测采样观测值以及抽油机运行长度利用指数家族似然公式计算得到的运行长度的预测概率，根据指数家族具有共轭先验的特征，利用指数家族似然公式计算；Pfault是根据专家知识得到的故障发生的先验概率；当抽油机出现故障时，设备的运行长度rt则变为0，此时的设备运行长度联合概率分布为：其中，rt是指抽油机运行到当前采样时刻t的运行长度，rt＝0表示抽油机运行出现故障，运行长度变为0；是根据待检测采样观测值以及抽油机运行长度利用指数家族似然公式计算得到的运行长度的预测概率，根据指数家族具有共轭先验的特征，利用指数家族似然公式计算；Pfault是根据专家知识得到的故障发生的先验概率；根据抽油机运行在正常状态及故障状态下的运行长度概率分布，可以计算联合概率分布，计算方式如下：其中，P是指待检测采样观测值和运行长度的联合概率分布，P是根据专家知识得到的故障发生的先验概率，是指预测概率分布，表示为运行时长rt对应的采样观测值。所述多变量突变点检测结果决策级融合具体为：根据计算得到的单个变量在全部待检测时刻的设备运行长度概率分布P),i＝1,2,...,m，为了简便起见，将P),i＝1,2,...,m简写为P,i＝1,2,...,m，利用贝叶斯全概率公式对m个变量的突变点检测结果进行融合，得到最终的在每个采样时刻设备运行长度的概率分布P。P＝P*P,...,PP＝P*P+P*P+,，,+P*P其中，概率P根据m个变量的运行长度概率分布决定，如果P＞0.75,i＝1,2,...,m的数量小于20％，则概率P为1，否则概率P为1。所述抽油机多变量突变点检测结果具体为：根据运行长度的后验概率分布判断抽油机是否出现故障，P为当前时刻所有运行长度的概率分布，是一个向量，当设备运行长度为0的概率最大时，则说明抽油机设备出现故障，否则无故障。本发明首先采集抽油机设备运行过程中存在的示功图及五个过程测量变量数据，提高了采集数据的完整性；其次，计算在不同阈值情况下两个矩阵范数的数值，绘制相关曲线确定阈值大小，能够在保证压缩信息准确性的同时降低计算复杂度；并定义一个被称作弦比指数的标准用来去除示功图数据的异常值，有效地提高了算法的鲁棒性；接下来，利用一个无监督在线的突变点检测方法，可以实现抽油机设备的实时检测及解决了数据标签困难的问题；最后，利用贝叶斯全概率公式将单变量的突变点检测结果进行决策级融合，实现抽油机设备的故障检测。本发明通过一种鲁棒的图像压缩方法，降低了异常值的影响，并利用无监督在线的突变点检测方法实现设备的故障检测，最后，还将多个变量的突变点检测结果进行融合，考虑了设备运行过程中整体的重要信息，简单易行，效果明显。实施例抽油机是石油开采的一种重要设备，也被称为“磕头机”。抽油机是有杆抽油系统中的一个主要举升装置。游梁式抽油机的主要特征是结构简单，操作方便，使用寿命长。游梁式抽油机的工作原理是：由动力机供给动力，经减速器将动力机的高速转动变为抽油机曲柄的低速转动，并由曲柄—连杆—游梁机构将旋转运动变为抽油机驴头的上、下往复运动，经悬绳器总成带动深井泵工作。抽油机设备主要会发生三种故障：供液不足、气体影响以及结蜡。其中供液不足是最常见的抽油机故障。出现的原因则是深井泵的排液能力大于油层的供液能力，导致液体不能充满。气体影响出现的主要原因是在上冲程过程中，抽油机深井泵中压力降低导致油气液体中气体分离并膨胀，使得增载变慢，吸入阀开启滞后，气体影响示功图增载线的斜率比正常示功图增载线的斜率小。在抽油机下冲程过程中，抽油机深井泵中气体压缩导致泵筒中压力变大，此时游动阀开启滞后，悬点载荷卸载变慢，示功图卸载线斜率比正常示功图卸载线斜率小，且为一条弧线。结蜡故障出现的主要原因是蜡一般存在于石油中，当温度较低时，蜡会析出，导致设备运行不畅。
