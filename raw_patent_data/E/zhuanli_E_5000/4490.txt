标题title
一种基于数据驱动的抽油机井故障判别方法
摘要abst
本申请公开了一种基于数据驱动的抽油机井故障判别方法，包括：步骤一、建立抽油机井故障参数数据库，对于抽油机井记录其工况类型码与正常示功图的最大载荷Pmax、最小载荷Pmin；步骤二、提取抽油机井运行最近1小时的示功图，按时间序列计算其最大载荷与最小载荷查询数据库中工况类型码与正常工作状况下的最大载荷Pmax与最小载荷Pmin；步骤三、建立抽油机井工况与地面示功图最大载荷、最小载荷变化模式的对应关系，形成抽油机井故障工况分类模型；步骤四、将与Pmax、Pmin对比，根据抽油机井故障工况分类模型，判断当前抽油机井工况。本申请提供的抽油机井故障判别方法，区分度高，判断简单，方便进行抽油机井连续实时工况诊断与预警。
权利要求书clms
1.一种基于数据驱动的抽油机井故障判别方法，其特征在于，包括以下步骤：步骤一、建立抽油机井故障参数数据库，对于抽油机井记录其工况类型码；在抽油机井正常生产时，提取其地面示功图的正常最大载荷Pmax、正常最小载荷Pmin，工况类型码为0，更新数据库中的参数；步骤二、根据示功图采集频率，提取抽油机井运行最近1小时的n个示功图和当前最新示功图，按时间序列计算其最大载荷与最小载荷i＝0，1，2...n，i＝0代表最新示功图，查询此抽油机井故障参数数据库中工况类型码与正常工作状况下的正常最大载荷Pmax与正常最小载荷Pmin；步骤三、建立抽油机井工况与地面示功图最大载荷、最小载荷变化模式的对应关系，形成抽油机井故障工况分类模型；步骤四、将与正常最大载荷Pmax、正常最小载荷Pmin对比，根据抽油机井故障工况分类模型，判断当前抽油机井工况；步骤五、重复步骤二到步骤四，进行抽油机井连续实时工况诊断与预警。2.根据权利要求1所述的基于数据驱动的抽油机井故障判别方法，其特征在于，所述工况类型码包括：0-正常，1-抽油杆断脱，2-油管漏失，3-卡泵，4-固定阀失灵，5-动液面上升，6-修井，7-疑似故障。3.根据权利要求2所述的基于数据驱动的抽油机井故障判别方法，其特征在于，所述抽油机井故障工况分类模型为：对于1-抽油杆断脱，最大载荷、最小载荷突然同时下降，且最大载荷ΔPmax下降幅度大于最小载荷ΔPmin下降幅度；对于2-油管漏失，最大载荷减小、最小载荷增大，且随时间逐步发展；对于3-卡泵，最大载荷增大、最小载荷减小，且随时间逐步发展；对于4-固定阀失灵，最大载荷不变，最小载荷突然增大；对于5-动液面上升，最小载荷不变，最大载荷缓慢下降。4.根据权利要求3所述的基于数据驱动的抽油机井故障判别方法，其特征在于，所述步骤四中，将分别与Pmax、Pmin比较，若最大载荷与最小载荷在微小范围内波动，抽油机井运行正常，工况类型码更新为0，令若且当前工况类型码为0，即上一功图正常，此功图出现最大载荷突然下降，最大载荷下降幅度大于最小载荷下降幅度，判断为抽油杆断脱，将工况类型码更新为1；若且当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续减小，最小载荷继续增大，判断为油管漏失，将工况类型码更新为2；若且当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续增大，最小载荷继续减小，判断为卡泵，将工况类型码更新为3；若当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续减小，最小载荷保持不变，判断为动液面上升，将工况类型码更新为5；若且当前工况类型码为0，即上一功图正常，此功图出现最大载荷保持不变，最小载荷增大，判断为固定阀失灵，将工况类型码更新为4；除正常工况外，上述情况Pmax、Pmin均不更新，并对工作人员发出该抽油机井故障预警，提示现场确认；若将工况类型码置为7疑似故障，Pmax、Pmin不更新，待下一张示功图继续判断。5.根据权利要求4所述的基于数据驱动的抽油机井故障判别方法，其特征在于，现场确认抽油机井故障停井后，该抽油机井故障参数数据库中工况类型码更新为6修井，其他参数不再更新，该抽油机井安排检泵上修；修井完后，示功图开始采集上传，待该抽油机井稳定生产3天，产量正常时，更新故障参数数据库中工况类型码为0-正常，用稳定后的示功图最大载荷最小载荷更新Pmax、Pmin值。
说明书desc
技术领域本申请涉及一种基于数据驱动的抽油机井故障判别方法，特别是利用抽油机井地面示功图动态变化特征对其进行故障判别与分类的方法，属于石油天然气开采技术领域。背景技术在石油开采中，游梁式抽油机配合有杆泵采油是应用最广泛的采油方式，示功图是反映游梁式抽油机在工作时悬点载荷与位移关系的曲线，可以反映抽油机的实时工作状况，通过安装在抽油机上的示功仪测量得到。在油田数字化转型的背景下，目前国内外绝大多数抽油机井已安装示功仪，实现了数字化示功图的实时采集与监控，然而采集到的大量数据未得到有效分析与应用。油田现场采用人工识别示功图的方法来进行抽油机井的故障诊断，为了及时发现出现故障的抽油机井，需要经验丰富的采油工程师实时查看每口井的示功图，工作强度高，效率低下。抽油机井计算机诊断技术在一定程度上解决了此问题，此技术利用吉布斯一维振动方程与傅立叶变换方法将地面示功图转换为井下泵功图，再通过人工神经网络、模式识别等方法进行工况诊断分类，这是对单一时刻示功图诊断的静态方法，未结合抽油机井动态变化，且此方法需要参数多、计算复杂，只能反映抽油泵工作状况而无法反映管杆情况，对于形状相近的示功图无法区分。现有的抽油机井计算机诊断技术是对抽油机井某一时刻的示功图进行诊断判别，是静态的判别，没有结合抽油机井的生产动态变化数据；现有的抽油机井计算机诊断技术是一种运用人工神经网络的图形模式识别方法，在诊断之前需要大量不同工况的示功图样本对神经网络进行学习与训练，一是样本收集与选取难度大、神经网络训练过程繁琐，二是对于形状相似而工况不同的示功图无法区分；现有的抽油机井计算机诊断技术是在假设井下油管杆工作正常情况下将地面示功图转换为井下泵功图，反映泵的工作状况，无法反映管杆故障，而在油田现场生产中，泵故障约占1/3，管杆故障约占2/3；现有的抽油机井计算机诊断技术需要参数多、计算复杂，在实施时需要每口抽油机井的大量参数，现场参数收集困难，参数不准确时对判断结果影响大，参数更新时维护工作量大，且计算原理复杂，对操作人员技术要求高，现场推广难度大。发明内容本申请的目的是解决现有技术中的缺陷，提供一种利用数据分析技术与采油技术相结合的抽油机井故障判别方法。为了解决上述技术问题，本申请的技术方案是提供了一种基于数据驱动的抽油机井故障判别方法，包括以下步骤：步骤一、建立抽油机井故障参数数据库，对于抽油机井记录其工况类型码；在抽油机井正常生产时，提取其地面示功图的正常最大载荷Pmax、正常最小载荷Pmin，工况类型码为0，更新数据库中的参数；步骤二、根据示功图采集频率，提取抽油机井运行最近1小时的n个示功图和当前最新示功图，按时间序列计算其最大载荷与最小载荷i＝0,1,2...n，i＝0代表最新示功图，查询此抽油机井故障参数数据库中工况类型码与正常工作状况下的正常最大载荷Pmax与正常最小载荷Pmin；步骤三、建立抽油机井工况与地面示功图最大载荷、最小载荷变化模式的对应关系，形成抽油机井故障工况分类模型；步骤四、将与正常最大载荷Pmax、正常最小载荷Pmin对比，根据抽油机井故障工况分类模型，判断当前抽油机井工况；步骤五、重复步骤二到步骤四，进行抽油机井连续实时工况诊断与预警。其中，所述工况类型码包括：0-正常，1-抽油杆断脱，2-油管漏失，3-卡泵，4-固定阀失灵，5-动液面上升，6-修井，7-疑似故障。其中，所述抽油机井故障工况分类模型为：对于1-抽油杆断脱，最大载荷、最小载荷突然同时下降，且最大载荷ΔPmax下降幅度大于最小载荷ΔPmin下降幅度；对于2-油管漏失，最大载荷减小、最小载荷增大，且随时间逐步发展；对于3-卡泵，最大载荷增大、最小载荷减小，且随时间逐步发展；对于4-固定阀失灵，最大载荷不变，最小载荷突然增大；对于5-动液面上升，最小载荷不变，最大载荷缓慢下降。具体的，所述步骤四中，将分别与Pmax、Pmin比较，若最大载荷与最小载荷在微小范围内波动，抽油机井运行正常，工况类型码更新为0，令若且当前工况类型码为0，即上一功图正常，此功图出现最大载荷突然下降，最大载荷下降幅度大于最小载荷下降幅度，判断为抽油杆断脱，将工况类型码更新为1；若且当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续减小，最小载荷继续增大，判断为油管漏失，将工况类型码更新为2；若且当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续增大，最小载荷继续减小，判断为卡泵，将工况类型码更新为3；若当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续减小，最小载荷保持不变，判断为动液面上升，将工况类型码更新为5；若且当前工况类型码为0，即上一功图正常，此功图出现最大载荷保持不变，最小载荷增大，判断为固定阀失灵，将工况类型码更新为4；除正常工况外，上述情况Pmax、Pmin均不更新，并对工作人员发出该抽油机井故障预警，提示现场确认；若将工况类型码更新为7疑似故障，Pmax、Pmin不更新，待下一张示功图继续判断；现场确认抽油机井故障停井后，该抽油机井故障参数数据库中工况类型码更新为6修井，其他参数不再更新，该抽油机井安排检泵上修；修井完后，示功图开始采集上传，待该抽油机井稳定生产3天，产量正常时，更新故障参数数据库中工况类型码为0-正常，用稳定后的示功图最大载荷最小载荷更新Pmax、Pmin值。本申请优点在于：1、现场油井常见的故障工况本发明均有对应的载荷变化特征模式；2、载荷变化模式区分度高，在示功图相近用传统方法难以分类的几种工况，载荷变化特征明显，本发明模式区分度高，误判率低；3、本发明判别简单，不需要油井具体参数，不需要求解波动方程、傅立叶级数、神经网络等复杂的理论计算，不需要神经网络样本选取、学习训练，只需油井地面示功图；4、模式具有通用性，适用范围广，在油井数量多时，易于推广。附图说明图1为正常工况地面示功图；图2为正常工况示功图最大载荷和最小载荷随时间变化规律；图3为抽油杆断脱示功图最大载荷和最小载荷随时间变化规律；图4为油管漏示功图最大载荷和最小载荷随时间变化规律；图5为卡泵示功图最大载荷和最小载荷随时间变化规律；图6为固定阀失灵示功图最大载荷和最小载荷随时间变化规律图7为抽油机井动液面上升时示功图最大载荷和最小载荷随时间变化规律。具体实施方式为使本申请更明显易懂，兹以优选实施例，并配合附图作详细说明如下。实施例本实施例提供的是基于数据驱动的抽油机井故障判别方法，该方法可以判断的故障类型包括卡泵、抽油杆断脱、油管漏、固定阀失灵、动液面上升等现场最常见的影响抽油机井正常生产的抽油机井故障与状态。本实施例采用数据驱动的方法对抽油机井进行实时工况判别与诊断，选取可以表征抽油机井工况特点的示功图特征值并分析其随时间的变化规律与抽油机井工况之间的关系，建立工况诊断模型：一、对抽油机进行悬点受力分析，根据悬点受力情况对地面示功图载荷变化进行定性分析：图1所示为正常工况的地面示功图，其中上冲程：Pup＝Wr+Wl+Iu+Phu+Fu+Pv-PiPup——上冲程悬点受力Wr——抽油杆柱重力Wl——作用在泵柱塞上的液柱载荷Iu——惯性载荷Phu——上冲程井口回压造成的悬点载荷Fu——摩擦载荷Pv——振动载荷Pi——泵吸入口沉没压力作用在柱塞上的载荷下冲程：Pdown＝W′r+Id-Phd-Fd-PvPdown——下冲程悬点受力W′r——抽油杆柱在液柱中的重力Id——惯性载荷Phd——下冲程井口回压造成的悬点载荷Fd——摩擦载荷Pv——振动载荷由抽油机工作运行规律及悬点受力分析可知，最大载荷发生在上冲程，最小载荷发生在下冲程；因此，悬点最大载荷Pmax＝Wr+Wl+Iu+Phu+Fu+Pv-Pi悬点最小载荷Pmin＝W′r+Id-Phd-Fd-Pv二、抽油机井正常工作状况下，地面示功图在短期内无显著变化，最大载荷最小载荷均稳定在一定范围内，微小波动，如图2所示，横轴为时间轴，纵轴为载荷轴，每一对圆点和菱形点表示某一时刻地面示功图的最大和最小载荷，此图反映了正常工况下抽油机井地面示功图最大载荷和最小载荷随时间的变化情况。下述为几种常见的影响抽油机井正常生产的抽油机井故障与状态：①抽油杆断脱：悬点载荷构成中，抽油杆柱重力占比最大，因此抽油杆断脱后，杆柱重力Wr减小，同时上冲程液柱载荷Wl卸载，出现最大载荷、最小载荷均减小的情况，最大载荷下降幅度大于最小载荷下降幅度，且在抽油杆发生断脱的时刻突然出现，其示功图载荷变化如图3所示；②油管漏失：油管破裂或油管丝扣损坏时，出现漏失现象，油管内液面降低，上冲程液柱载荷Wl减小，下冲程抽油杆浮重增大W′r，出现最大载荷减小、最小载荷上升的情况，且随着漏失量的增加逐步发展，直至油管内液面漏至油管破损位置，最大载荷和最小载荷平稳不再变化，其载荷变化情况如图4所示；③卡泵：当井筒结蜡或地层出砂影响时，抽油杆上行下行摩擦阻力Fu增大，Fu增加最大载荷，Fd减小最小载荷，出现最大载荷增大、最小载荷减小的情况，随着结蜡或出砂的严重程度最大最小载荷差逐步扩大直至平衡其阻力或将抽油机卡死，出现卡泵，其示功图载荷变化如图5所示；④固定阀失灵：抽油泵固定阀由于泵筒脏物影响，出现固定阀无法关闭，或是地层能量不足，抽油机井动液面低，沉没压力不足以打开固定阀，出现泵筒不进液，此两种情况均会导致下冲程液柱载荷Wl无法卸载，出现最大载荷不变、最小载荷增大的情况，一般在沉没压力不足或固定阀无法关闭时突然发生，其示功图载荷变化如图6所示；⑤动液面上升：当油井地层能量升高，动液面上升时，沉没压力增大，在上冲程时，Pi增大，降低最大载荷，出现最大载荷减小、最小载荷不变的情况，随着动液面的上升逐步发展，其示功图载荷变化如图7所示。⑶由⑵可知，对于抽油机井常见的几种严重故障，其地面示功图最大载荷与最小载荷均有明显的变化特征，且变化模式与故障工况存在一一对应关系，因此可由抽油机井地面示功图最大载荷、最小载荷的变化模式建立工况诊断模型。分析实时采集到的地面示功图与历史示功图数据，得到其最大最小载荷变化规律，将变化模式与⑵分析中的工况模型对比，即可得到目前抽油机井的工作状况。根据上述分析规律，本实施例具体实施步骤：一、建立抽油机井故障参数数据库，对于每一口抽油机井记录其工况类型码，正常工作状况下的地面示功图正常最大载荷Pmax与正常最小载荷Pmin，此参数随抽油机井生产动态变化自动调整，在抽油机井正常生产时，提取其地面示功图的最大载荷、最小载荷，工况类型码为0，更新数据库中的参数；二、根据示功图采集频率，提取抽油机井运行最近1小时的n个示功图和当前最新示功图，按时间序列计算其最大载荷与最小载荷，查询此抽油机井故障参数数据库中工况类型码与正常工作状况下的正常最大载荷Pmax与正常最小载荷Pmin；三、建立抽油机井工况与地面示功图最大载荷最小载荷变化模式的对应关系，形成抽油机井故障工况分类模型；对于①抽油杆断脱，其最大载荷、最小载荷突然同时下降，且最大载荷下降幅度大于最小载荷下降幅度ΔPmax＞ΔPmin；②油管漏失，最大载荷减小、最小载荷增大，且随时间逐步发展；③卡泵，最大载荷增大、最小载荷减小，且随时间逐步发展；④固定阀失灵，最大载荷不变，最小载荷突然增大；⑤动液面上升，最小载荷不变，最大载荷缓慢下降；四、将分别与Pmax、Pmin比较，若最大载荷与最小载荷在微小范围内波动，抽油机井运行正常，工况类型码更新为0，令若.当前工况类型码为0，即上一功图正常，此功图出现最大载荷突然下降，最大载荷下降幅度大于最小载荷下降幅度，判断为抽油杆断脱，将工况类型码更新为1；.当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续减小，最小载荷继续增大，判断为油管漏失，将工况类型码更新为2；.当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续增大，最小载荷继续减小，判断为卡泵，将工况类型码更新为3；.当前工况类型码为7，即上一功图疑似故障，此功图出现最大载荷较上一张功图继续减小，最小载荷保持不变，判断为动液面上升，将工况类型码更新为5；若且当前工况类型码为0，即上一功图正常，此功图出现最大载荷保持不变，最小载荷增大，判断为固定阀失灵，将工况类型码更新为4；除正常工况外，其他情况Pmax、Pmin均不更新，对工作人员发出该抽油机井故障预警，提示现场确认；若将工况类型码置为7疑似故障，Pmaz、Pmin不更新，待下一张示功图继续判断；五、现场确认抽油机井故障停井后，该井故障参数数据库中工况类型码更新为6上修，其他参数不再更新，该井安排检泵上修。修井完井后，示功图开始采集上传，待该井稳定生产3天，产量正常时，更新故障参数数据库中工况类型码为0正常，用稳定后的示功图最大载荷最小载荷更新Pmax、Pmin值。六、重复步骤二-四，实现抽油机井连续实时工况诊断与预警。本实施例的关键技术点在于：⑴现有的抽油机井工况诊断，是对油井单一时刻单张示功图进行诊断，是静态的诊断方法，未结合油井生产动态变化；本实施例采用动态数据分析的方法，考虑了油井的动态变化，分析油井示功图在时间维度上的变化特征，可以更全面准确的反映油井生产工况状态；⑵现有的抽油机井工况诊断，是对油井示功图形状进行诊断，本实施例采用示功图特征值的方法；⑶现有的抽油机井工况诊断，是将地面示功图转换为井下泵功图进行识别诊断，计算复杂，受参数准确性影响较大，本实施例直接使用地面示功图特征值诊断，计算简单，模式清晰，误判率低。
