标题title
作业机械
摘要abst
本发明提供一种作业机械，其能够确保执行机构的位置控制精度并基于再生功能使执行机构的工作速度加快。控制器基于操作杆的输入量和目标执行机构流量计算再生流量，从所述目标执行机构流量减去所述再生流量来计算目标执行机构供给流量，基于所述目标执行机构供给流量计算目标流量控制阀开口量，计算所述目标执行机构供给流量的合计以上的目标泵流量，基于所述操作杆的输入量控制切换阀，对应于所述目标流量控制阀开口量来控制流量控制阀，对应于所述目标泵流量来控制液压泵。
权利要求书clms
1.一种作业机械，其包括：车身；作业装置，其安装于所述车身；执行机构，其驱动所述车身或所述作业装置；工作油箱；液压泵，其从所述工作油箱吸入工作油并向所述执行机构供给；流量控制阀，其与所述液压泵的排出管路并行连接，控制从所述液压泵向所述执行机构供给的液压油的流动；操作杆，其用于指示所述执行机构的动作；以及控制器，其对应于所述操作杆的输入量来控制所述流量控制阀，所述作业机械的特征在于，包括：再生阀，其容许所述流量控制阀的从出口节流侧向入口节流侧的工作油的流动；以及切换阀，其设置于将所述流量控制阀与所述工作油箱连接的油箱管路，使所述油箱管路开放或阻断，所述控制器基于所述操作杆的输入量计算作为所述执行机构的目标流量的目标执行机构流量，基于所述操作杆的输入量和所述目标执行机构流量计算作为所述再生阀的通过流量的再生流量，从所述目标执行机构流量减去所述再生流量来计算目标执行机构供给流量，基于所述目标执行机构供给流量计算目标流量控制阀开口量，计算所述目标执行机构供给流量的合计以上的目标泵流量，基于所述操作杆的输入量来控制所述切换阀，对应于所述目标流量控制阀开口量来控制所述流量控制阀，对应于所述目标泵流量来控制所述液压泵。2.根据权利要求1所述的作业机械，其特征在于，所述流量控制阀具有：方向控制阀，其控制从所述液压泵向所述执行机构供给的液压油的方向；以及辅助流量控制阀，其限制从所述液压泵向所述方向控制阀的入口节流端口供给的液压油的流量，所述再生阀配置于将所述方向控制阀的出口节流端口与入口节流端口连接的油路。3.根据权利要求1所述的作业机械，其特征在于，所述流量控制阀是对从所述液压泵向所述执行机构供给的液压油的方向及流量进行控制的方向控制阀，所述再生阀配置在所述方向控制阀的滑阀的内部。4.根据权利要求1所述的作业机械，其特征在于，具备自动控制功能切换开关，其指示所述车身或所述作业装置的自动控制功能的有效化或无效化，在由所述自动控制功能切换开关指示所述自动控制功能无效化的情况下，所述控制器基于所述操作杆的输入量计算所述目标流量控制阀开口量及所述目标泵流量。
说明书desc
技术领域本发明涉及液压挖掘机等作业机械。背景技术液压挖掘机等作业机械具备包含回转体的车身和安装于回转体的作业装置，作业装置包含：与回转体连接的动臂；与动臂的前端连接的斗杆；与斗杆的前端连接的铲斗；驱动动臂的动臂缸；驱动斗杆的斗杆缸；以及驱动铲斗的铲斗缸。在这样的作业机械中，在使动臂、斗杆或铲斗单独动作时，铲斗前端形成圆弧状的轨迹。因此，例如在通过拉动斗杆的动作以铲斗前端形成直线状的修整面的情况下，需要由操作者复合地进行动臂、斗杆及铲斗的操作，要求操作者具有熟练的操作技术。因而，已有将利用控制装置自动或半自动地控制液压执行机构的驱动的功能应用于挖掘作业，使铲斗前端在挖掘动作时沿着设计面移动的技术。另一方面，存在在现有的液压挖掘机中具备液压油再生装置的技术，其中，该液压油再生装置能够通过使液压执行机构的油箱侧流路的液压油合流到泵侧流路而使该液压执行机构的工作速度加快。在这样的背景下，在对具备能够使斗杆缸的伸缩速度加快的液压再生装置的液压挖掘机应用机械控制的情况下，若在通过该机械控制使铲斗前端沿着目标挖掘面移动的过程中在斗杆缸中进行液压油再生，则存在斗杆的工作速度变化，铲斗前端相对于目标挖掘面更深陷入地下的可能。即，在使执行机构的返回油合流到泵侧流路的构成中，在通过机械控制设定执行机构的目标流量执行使从泵向执行机构供给的流量与目标流量一致的控制的情况下，向执行机构供给的流量比目标流量多，无法确保执行机构的位置控制精度。为了解决上述课题而存在下述技术：在具备能够使液压缸的伸缩速度加快的液压再生装置的液压挖掘机中，在通过机械控制进行作业的情况下，若液压再生的影响大，则通过使再生流量下降来限制液压油再生功能，确保使用机械控制的执行机构位置控制精度。现有技术文献专利文献专利文献1：日本专利第3056254号公报专利文献2：日本专利第3594680号公报专利文献3：日本特开2018-3516号公报发明内容发明要解决的课题但是，在专利文献3记载的作业机械中，在通过机械控制进行作业时限制再生功能的情况下，虽然能够确保执行机构的位置控制精度，但无法使执行机构的工作速度加快，存在导致作业效率降低的可能。即，在通过机械控制设定执行机构的目标流量并通过使从泵向执行机构供给的流量与目标流量一致来确保执行机构的位置控制精度的构成中，无法使执行机构的返回油合流到泵侧流路以加快执行机构的工作速度。本发明是鉴于上述课题提出的，其目的在于提供能够确保执行机构的位置控制精度并基于再生功能使执行机构的工作速度加快的作业机械。用于解决课题的手段为了达成上述目的，本发明的作业机械包括：车身；作业装置，其安装于所述车身；执行机构，其驱动所述车身或所述作业装置；工作油箱；液压泵，其从所述工作油箱吸入工作油并向所述执行机构供给；流量控制阀，其与所述液压泵的排出管路并行连接，控制从所述液压泵向所述执行机构供给的液压油的流动；操作杆，其用于指示所述执行机构的动作；以及控制器，其对应于所述操作杆的输入量来控制所述流量控制阀，所述作业机械包括：再生阀，其容许所述流量控制阀的从出口节流侧向入口节流侧的工作油的流动；以及切换阀，其设置于将所述流量控制阀与所述工作油箱连接的油箱管路，使所述油箱管路开放或阻断，所述控制器基于所述操作杆的输入量计算作为所述执行机构的目标流量的目标执行机构流量，基于所述操作杆的输入量和所述目标执行机构流量计算作为所述再生阀的通过流量的再生流量，从所述目标执行机构流量减去所述再生流量来计算目标执行机构供给流量，基于所述目标执行机构供给流量计算目标流量控制阀开口量，计算所述目标执行机构供给流量的合计以上的目标泵流量，基于所述操作杆的输入量来控制所述切换阀，对应于所述目标流量控制阀开口量来控制所述流量控制阀，对应于所述目标泵流量来控制所述液压泵。根据按照上述方式构成的本发明，以使得液压泵向执行机构供给的目标流量和执行机构的再生流量的合计与执行机构的目标流量相等的方式控制流量控制阀及液压泵。由此，能够在确保执行机构的位置控制精度的同时利用再生功能使执行机构的工作速度加快。发明效果根据本发明的作业机械，能够在确保执行机构的位置控制精度的同时利用再生功能使执行机构的工作速度加快。附图说明图1是本发明实施方式的液压挖掘机的侧视图图2A是本发明第1实施例中的液压驱动装置的回路图。图2B是本发明第1实施例中的液压驱动装置的回路图。图3是示出本发明第1实施例中的控制器的功能框图。图4是示出本发明第1实施例中的控制器的与方向控制阀的控制相关的处理的流程图。图5是示出本发明第1实施例中的控制器的与辅助流量控制阀的控制相关的处理的流程图。图6是示出本发明第1实施例中的控制器的与液压泵的控制相关的处理的流程图。图7是示出本发明第1实施例中的控制器的与切换阀的控制相关的处理的流程图。图8A是本发明第2实施例中的液压驱动装置的回路图。图8B是本发明第2实施例中的液压驱动装置的回路图。图9是本发明第2实施例中的控制器的功能框图。图10是示出本发明第2实施例中的控制器的与方向控制阀的控制相关的处理的流程图。具体实施方式以下，作为本发明实施方式的作业机械以液压挖掘机为例，参照附图进行说明。需要说明的是，在各图中，对等同的部件标注同一附图标记并适当省略重复的说明。图1是本实施方式的液压挖掘机的侧视图。如图1所示，液压挖掘机300包括：行驶体201；回转体202，其以能够回转的方式配置在行驶体201上，构成车身；以及作业装置203，其以能够在上下方向上转动的方式安装于回转体202，进行砂土的挖掘作业等。回转体202由回转马达211驱动。作业装置203包含：动臂204，其以能够在上下方向上转动的方式安装于回转体202；斗杆205，其以能够在上下方向上转动的方式安装于动臂204的前端；以及铲斗206，其以能够在上下方向上转动的方式安装于斗杆205的前端。动臂204由动臂缸204a驱动，斗杆205由斗杆缸205a驱动，铲斗206由铲斗缸206a驱动。驾驶室207设置在回转体202上的前侧位置，用于确保重量平衡的配重209设置在后侧位置。在驾驶室207与配重209之间设有收容发动机及液压泵等的机械室208，机械室208中设置有控制阀210。控制阀210控制从液压泵向各执行机构的工作油的流动。本实施方式的液压挖掘机300搭载有以下各实施例中说明的液压驱动装置。实施例1图2A及图2B是本发明第1实施例中的液压驱动装置的回路图。构成第1实施例中的液压驱动装置400包括由发动机驱动的3个主液压泵，例如分别由可变容量型液压泵构成的第1液压泵1、第2液压泵2及第3液压泵3。另外，具备由发动机驱动的先导泵91，并具备向液压泵1～3及先导泵91供给油的工作油箱5。第1液压泵1的倾转角由第1液压泵1中附设的调节器控制。第1液压泵1的调节器包含流量控制指令压力端口1a、第1液压泵自身压力端口1b及第2液压泵自身压力端口1c。第2液压泵2的倾转角由第2液压泵2中附设的调节器控制。第2液压泵2的调节器包含流量控制指令压力端口2a、第2液压泵自身压力端口2b及第1液压泵自身压力端口2c。第3液压泵3的倾转角由第3液压泵3中附设的调节器控制。第3液压泵3的调节器包含流量控制指令压力端口3a及第3液压泵自身压力端口3b。第1液压泵1的排出管路40经由中央旁通管路41与工作油箱5连接。在中央旁通管路41上从上游侧起依次配置有：右行驶用方向控制阀6，其对驱动行驶体201的一对行驶马达中的未图示的右行驶马达的驱动进行控制；铲斗用方向控制阀7，其对向铲斗缸206a供给的液压油的流动进行控制；第2斗杆用方向控制阀8，其控制向斗杆缸205a供给的液压油的流动；以及第1动臂用方向控制阀9，其控制向动臂缸204a供给的液压油的流动。铲斗用方向控制阀7、第2斗杆用方向控制阀8及第1动臂用方向控制阀9各自的入口节流端口分别经由油路42、43、油路44、45及油路46、47与将右行驶用方向控制阀6和铲斗用方向控制阀7连接的中央旁通管路41的一部分并行连接。另外，为了针对过大的压力上升保护回路，排出管路40借助主溢流阀18与工作油箱5连接。在排出管路40上设有检测第1液压泵1的压力的压力传感器。第2液压泵2的排出管路50经由中央旁通管路51与工作油箱5连接。在中央旁通管路51上从上游侧起依次配置有：第2动臂用方向控制阀10，其控制向动臂缸204a供给的液压油的流动；第1斗杆用方向控制阀11，其控制向斗杆缸205a供给的液压油的流动；第1附属装置用方向控制阀12，其控制向驱动第1特殊附属装置的未图示的第1执行机构供给的液压油的流动，其中，第1特殊附属装置为例如取代铲斗206而设置的粉碎机等；以及左行驶用方向控制阀13，其控制驱动行驶体201的一对行驶马达中的未图示的左行驶马达的驱动。第2动臂用方向控制阀10、第1斗杆用方向控制阀11、第1附属装置用方向控制阀12及左行驶用方向控制阀13各自的入口节流端口分别经由油路52、53、油路54、55、油路56、57及油路58与第2液压泵2的排出管路50并行连接。油路58借助合流阀17与第1液压泵1的排出管路40连接。在油路58与第2液压泵2的排出管路50之间设有单向阀30。单向阀30防止从第1液压泵1经由合流阀17向排出管路50供给的工作油流入配置在行驶左用方向控制阀13的上游侧的方向控制阀10～12。另外，为了针对过大的压力上升保护流路，排出管路50借助主溢流阀19与工作油箱5连接。在排出管路50上设有检测第2液压泵2的压力的压力传感器81。第1斗杆用方向控制阀11的出口节流端口经由油箱管路70与工作油箱5连接。在油箱管路70上配置有切换阀36。切换阀36的上游侧借助再生阀35与油路55连接。再生阀35容许工作油从油箱管路70向油路55流动，而阻止反方向的流动。第3液压泵3的排出管路60经由中央旁通管路61与工作油箱5连接。在中央旁通管路61上从上游侧起依次配置有：第2附属装置用方向控制阀16；回转用方向控制阀14，其控制向回转马达211供给的液压油的流动；以及第3动臂用方向控制阀15，其控制向动臂缸204a供给的液压油的流动。在除了第1特殊附属装置以外安装有具备第2执行机构的第2特殊附属装置时，或者在取代第1特殊执行机构而安装有具备第1执行机构和第2执行机构这2个执行机构的第2特殊附属装置时，第2附属装置用方向控制阀16被用于控制向第2执行机构供给的液压油的流动。回转用方向控制阀14、第3动臂用方向控制阀15及第2附属装置用方向控制阀16各自的入口节流端口分别经由油路62、63、油路64、65及油路66、67与第3液压泵3的排出管路60并行连接。另外，为了针对过大的压力上升保护流路，排出管路60借助主溢流阀20与工作油箱5连接。在排出管路60上设有检测第3液压泵3的压力的压力传感器。为了获取液压挖掘机300的动作状态，在动臂缸204a、斗杆缸205a及铲斗缸206a上分别设有检测行程量的行程传感器84、85、86。需要说明的是，获取液压挖掘机300的动作状态的机构为倾斜传感器、旋转角传感器、IMU等多种，不限于上述的行程传感器。在与铲斗用方向控制阀7连接的油路42、43、与第2斗杆用方向控制阀8连接的油路44、45及与第1动臂用方向控制阀9连接的油路46、47上分别设有在复合操作时限制从第1液压泵1向方向控制阀7至9供给的液压油的流量的辅助流量控制阀21、22、23。在与第2动臂用方向控制阀10的入口节流端口连接的油路52、53、与第1斗杆用方向控制阀11的入口节流端口连接的油路54、55及与第1附属装置用方向控制阀12的入口节流端口连接的油路56、57上分别设有在复合操作时限制从第2液压泵2向方向控制阀10至12供给的液压油的流量的辅助流量控制阀24、25、26。在与回转用方向控制阀14的入口节流端口连接的油路62、63、与第3动臂用方向控制阀15的入口节流端口连接的油路64、65及与第2附属装置用方向控制阀16的入口节流端口连接的油路66、67上分别设有在复合操作时限制从第3液压泵3向方向控制阀14至16供给的液压油的流量的辅助流量控制阀27、28、29。先导泵91的排出端口借助先导1次压生成用的先导溢流阀92与工作油箱5连接，并经由油路97与电磁阀单元93中内置的电磁比例阀93a～93h的一个输入端口连接。电磁比例阀93a～93h的另一输入端口与工作油箱5连接。电磁比例阀93a～93h分别对应于来自控制器94的指令信号使先导1次压减压并生成先导指令压力。电磁比例阀93a的输出端口与第2液压泵2的调节器的流量控制指令压力端口2a连接。电磁比例阀93b、93c的输出端口与第2动臂用方向控制阀10的先导端口连接。电磁比例阀93d、93e的输出端口与第1斗杆用方向控制阀11的先导端口连接。电磁比例阀93f的输出端口经由油路71与辅助流量控制阀24的先导端口连接。电磁比例阀93g的输出端口经由油路72与辅助流量控制阀25的先导端口连接。电磁比例阀93h的输出端口经由油路73与切换阀36的先导端口连接。需要说明的是，为了简化说明，关于第1液压泵1及第3液压泵3的调节器的流量控制指令压力端口1a、3a用的电磁比例阀、右行驶用方向控制阀6用的电磁比例阀、铲斗用方向控制阀7用的电磁比例阀、第2斗杆用方向控制阀8用的电磁比例阀、第1动臂用方向控制阀9用的电磁比例阀、第1附属装置用方向控制阀12用的电磁比例阀、左行驶用方向控制阀13用的电磁比例阀、回转用方向控制阀14用的电磁比例阀、第3动臂用方向控制阀15用的电磁比例阀、第2附属装置用方向控制阀16用的电磁比例阀及辅助流量控制阀21～23、26～29用的电磁比例阀省略图示。辅助流量控制阀24由形成辅助可变节流器的座式主阀31、设置于主阀31的阀芯31a并对应于阀芯31a的移动量使开口量变化的控制可变节流器31b、以及先导可变节流器32构成。内置有主阀31的壳体具有：第1压力室31c，其形成于主阀31与油路52的连接部；第2压力室31d，其形成于主阀31与油路53的连接部；以及第3压力室31e，其形成为借助控制可变节流器31b与第1压力室31c连通。先导可变节流器32配置在将第3压力室31e与油路53连接的油路68上。先导可变节流器32的先导端口32a与电磁比例阀93f的输出端口连接。在将第2动臂用方向控制阀10与辅助流量控制阀24连接的油路53上设有压力传感器82。需要说明的是，为了简化说明而局部省略图示，辅助流量控制阀21～29及周边的设备、配管、布线全部为相同的构成。液压驱动装置400具备第1动臂用方向控制阀9、第2动臂用方向控制阀10及能够进行第3动臂用方向控制阀15的切换操作的动臂用操作杆95a、以及能够进行第1斗杆用方向控制阀11及第2斗杆用方向控制阀8的切换操作的斗杆用操作杆95b。需要说明的是，为了简化说明，对于进行右行驶用方向控制阀6的切换操作的右行驶用操作杆、进行铲斗用方向控制阀7的切换操作的铲斗用操作杆、进行第1附属装置用方向控制阀12的切换操作的第1附属装置用操作杆、进行左行驶用方向控制阀13的切换操作的左行驶用操作杆、进行回转用方向控制阀14的切换操作的回转用操作杆、进行第2附属装置用方向控制阀16的切换操作的第2附属装置用操作杆省略图示。液压驱动装置400具备控制器94，操作杆95a、95b的输入量、压力传感器81～83的输出值及行程传感器84～86的输出值被输入控制器94。另外，控制器94向电磁阀单元93所具有的电磁比例阀93a～93h输出指令信号。图3是控制器94的功能框图。在图3中，控制器94具有控制有效化判定部94a、请求执行机构流量运算部94b、限制执行机构流量运算部94c、再生对象动作判定部94k、目标执行机构流量运算部94e、再生流量运算部94d、目标执行机构供给流量运算部94f、目标泵流量运算部94g、目标方向控制阀开口运算部94h、目标流量控制阀开口运算部94i、以及目标切换阀开口运算部94j。控制有效化判定部94a基于自动控制功能切换开关96的信号判定自动控制功能是否有效。请求执行机构流量运算部94b基于操作杆输入量计算执行机构的请求流量。限制执行机构流量运算部94c基于从行程传感器84～86的信号等获得的车身202或作业装置203的姿态信息及预先设定的设计面信息计算用于控制使得车身202或作业装置203不脱离所设定的限制区域的执行机构流量作为限制流量。再生对象动作判定部94k基于操作杆95a、95b的输入量判定执行机构的动作是否是能够应用再生功能的动作。目标执行机构流量运算部94e基于控制有效化判定部94a的判定结果、来自请求执行机构流量运算部94b的执行机构的请求流量及来自限制执行机构流量运算部94c的执行机构的限制流量计算向执行机构供给的目标流量。再生流量运算部94d基于来自目标执行机构流量运算部94e的目标执行机构流量和来自再生对象动作判定部94k的判定结果计算通过再生阀35的流量。目标执行机构供给流量运算部94f基于来自目标执行机构流量运算部94e的目标执行机构流量和来自再生流量运算部94d的再生流量计算从液压泵向执行机构供给的目标流量。目标泵流量运算部94g基于控制有效化判定部94a的判定结果、来自目标执行机构供给流量运算部94f的目标执行机构供给流量及操作杆输入量计算液压泵1～3的目标流量，并输出与目标泵流量对应的指令信号。目标方向控制阀开口运算部94h基于操作杆95a、95b的输入量计算方向控制阀6～16的目标开口量，并输出与目标开口量对应的指令信号。目标流量控制阀开口运算部94i基于控制有效化判定部94a的判定结果、来自目标执行机构供给流量运算部94f的目标执行机构供给流量、操作杆输入量以及压力传感器输出值计算辅助流量控制阀21～29的目标开口量，并输出与目标开口量对应的指令信号。目标切换阀开口运算部94j基于再生对象动作判定部94k的判定结果计算切换阀36的目标开口量，并输出与目标开口量对应的指令信号。图4是示出控制器94的与方向控制阀6～16的控制相关的处理的流程图。以下仅说明与第1斗杆用方向控制阀11相关的处理。与其他方向控制阀相关的处理由于与之相同而省略说明。首先，控制器94判定是否没有斗杆用操作杆95b的输入。在步骤S101中判定为无斗杆用操作杆95b输入的情况下，结束该流程。在步骤S101中判定为有斗杆用操作杆95b输入的情况下，由控制器94的目标方向控制阀开口运算部94h计算与斗杆用操作杆95b的输入量对应的方向控制阀11的目标开口量Ams。接着步骤S102，从控制器94向方向控制阀10用的电磁比例阀93d、93e输出与目标开口量Ams对应的指令信号，使电磁比例阀93d、93e生成方向控制阀11的先导指令压力，对应于先导指令压力使方向控制阀10开口，结束该流程。图5是示出控制器94的与辅助流量控制阀21～29的控制相关的处理的流程图。以下仅说明与第1斗杆用方向控制阀11所对应的辅助流量控制阀25的控制相关的处理。与其他辅助流量控制阀的控制相关的处理由于与之相同而省略说明。首先，控制器94判定是否没有斗杆用操作杆95b的输入。在步骤S201中判定为无斗杆用操作杆95b输入的情况下，结束该流程。在步骤S201中判定为有斗杆用操作杆95b输入的情况下，判定自动控制功能是否有效。在步骤S202中判定为自动控制功能无效的情况下，由控制器94的目标流量控制阀开口运算部94i计算与斗杆用操作杆95b的输入量对应的辅助流量控制阀25的目标开口量Afcv_M，将与目标开口量Afcv_M对应的指令信号向辅助流量控制阀25用的电磁比例阀93g输出，使电磁比例阀93g生成辅助流量控制阀25的先导指令压力，对应于先导指令压力使辅助流量控制阀25开口，结束该流程。在步骤S202中判定为自动控制功能有效的情况下，由控制器94的再生对象动作判定部94k基于斗杆用操作杆95b的输入量来判定斗杆缸205a的动作是否为再生对象动作。在本实施例中，在斗杆用操作杆95b向斗杆收回方向操作的情况下判定为是再生对象动作，在向斗杆卸放方向操作的情况下判定为非再生对象动作。在步骤S211中判定为非再生对象动作的情况下，由控制器94的再生流量运算部94d将再生流量Qreg设定为零，在判定为是再生对象动作的情况下，将目标执行机构流量Qreg乘以入口节流/出口节流流量比α来计算再生流量Qreg。在此，入口节流/出口节流流量比α是执行机构动作时出口节流流量Qact_MO相对于入口节流流量Qact_MI的比值，由下式定义。α＝Qact_MO/Qact_MI…需要说明的是，入口节流/出口节流流量比α未必基于流量计算，例如也可以基于液压缸柱塞的底侧和杆侧的受压面积计算。接着步骤S212或步骤S221，由控制器94的目标执行机构供给流量运算部94f从目标执行机构流量Qref减去再生流量Qreg来计算目标执行机构供给流量Qact_A，由控制器94的目标流量控制阀开口运算部94i基于目标执行机构供给流量Qact_A和辅助流量控制阀24的前后压差ΔPfcv来计算辅助流量控制阀24的目标开口量Afcv_A，将与目标开口量Afcv_A对应的指令信号向辅助流量控制阀24用的电磁比例阀93f输出，在执行步骤S205、S206的处理后，结束该流程。图6是示出与控制器94的液压泵1～3的控制相关的处理的流程图。以下仅说明与第2液压泵2的控制相关的处理。与其他液压泵的控制相关的处理由于与之相同而省略说明。首先，控制器94判定有无操作杆95a、95b的输入。在步骤S301中判定为无操作杆95a、95b输入的情况下，结束该流程。在步骤S301中判定为有操作杆95a、95b输入的情况下，判定自动控制功能是否有效。在步骤S302中判定为自动控制功能无效的情况下，由控制器94的目标泵流量运算部94g计算与操作杆95a、95b的输入量对应的液压泵2的目标泵流量Qpmp_M，向液压泵2的流量控制用的电磁比例阀93a输出与目标泵流量Qpmp_M对应的指令信号，使电磁比例阀93a生成液压泵2的流量控制指令压力PiP2，对应于流量控制指令压力PiP2使第2液压泵2的倾转变化，结束该流程。在步骤S302中判定为自动控制功能有效的情况下，由控制器94的目标执行机构供给流量运算部94f计算目标执行机构供给流量Qact_Aa、QactAb、……。在此，目标执行机构供给流量Qact_Aa是从液压泵2向动臂缸204a供给的目标流量，目标执行机构供给流量Qact_Ab是从液压泵2向斗杆缸205a供给的目标流量。接着步骤S311a、S311b、……，由控制器94的目标泵流量运算部94g计算各执行机构的目标流量Qact_Aa、Qact_Ab、……的合计作为目标泵流量Qpmp_A，将与目标泵流量Qpmp_A对应的指令信号向液压泵2的流量控制用的电磁比例阀93a输出，在执行步骤S305、S306的处理后，结束该流程。在此，目标泵流量Qpmp_A由设计者适当设定，无需与各执行机构的目标流量的合计严格一致，也可以加入溢流流量、排泄流量等。图7是示出控制器94的与切换阀36的控制相关的处理的流程图。以下仅说明与第1斗杆用方向控制阀11对应的切换阀36的控制相关的处理。与其他切换阀的控制相关的处理由于与之相同而省略说明。首先，控制器94判定是否没有斗杆用操作杆95b的输入。在步骤S401中判定为无斗杆用操作杆95b输入的情况下，结束该流程。在步骤S401中判定为有斗杆用操作杆95b输入的情况下，判定是否为再生对象动作。在本实施例中，在斗杆用操作杆95b向斗杆收回方向操作的情况下判定为是再生对象动作，在向斗杆卸放方向操作的情况下判定为非再生对象动作。在步骤S402中判定为再生对象动作的情况下，由控制器94的目标切换阀开口运算部94j将切换阀36的目标开口量Avtv_M设定为全开，在判定为非再生对象动作的情况下，将切换阀36的目标开口量Aswv设定为全闭。接着步骤S403或步骤S411，控制器94的目标切换阀开口运算部94j将与目标开口量Aswv对应的指令信号向切换阀36用的电磁比例阀93h输出，使电磁比例阀93h生成切换阀36的先导指令压力，对应于先导指令压力使切换阀36开口，结束该流程。由此，通过在斗杆卸放时将切换阀36打开，从而斗杆缸205a的底侧的工作油向工作油箱5排出，通过在斗杆收回时将切换阀36关闭，从而斗杆缸205a的杆侧的工作油经由再生阀35向底侧供给。动作基于与第2液压泵2相关的部分来说明液压驱动装置400的动作。与其他液压泵相关的部分的动作由于与之相同而省略说明。自动控制功能无效状态的操作说明自动控制功能无效状态时操作斗杆用操作杆95b的情况下的各设备的动作。·方向控制阀控制器94计算与斗杆用操作杆95b的输入量对应的第1斗杆用方向控制阀11的目标开口量Ams，将与目标开口量Ams对应的指令信号向电磁比例阀93d、93e输出。电磁比例阀93d、93e对应于指令信号生成先导指令压力PiAm1U、PiAm1D，对第1斗杆用方向控制阀11的开口量进行控制。·辅助流量控制阀控制器94计算与斗杆用操作杆95b的输入量对应的辅助流量控制阀25的目标开口量Afcv_M，将与目标开口量Afcv_M对应的指令信号向电磁比例阀93g输出。电磁比例阀93g对应于指令信号生成先导指令压力，对辅助流量控制阀25的开口量进行控制。在该动作例中，控制使得辅助流量控制阀25全开。·液压泵控制器94计算与斗杆用操作杆95b的输入量对应的第2液压泵2的目标流量Qpmp_M，将与目标流量Qpmp_M对应的指令信号向电磁比例阀93a输出。电磁比例阀93a对应于指令信号生成流量控制指令压力PiP2，对第2液压泵2的流量进行控制。·切换阀控制器94基于斗杆用操作杆95b的输入量来判定是否为再生对象动作，在判定结果为是的情况下将切换阀36的目标开口量Aswv设定为全闭，在判定结果为否的情况下将目标开口量Aswv设定为全开，将与目标开口量Aswv对应的指令信号向电磁比例阀93h输出。电磁比例阀93h对应于指令信号生成先导指令压力，对切换阀36的开口量进行控制。自动控制功能有效状态的操作说明自动控制功能有效状态时操作斗杆用操作杆95b的情况下的各设备的动作。·方向控制阀控制器94计算与斗杆用操作杆95b的输入量对应的第1斗杆用方向控制阀11的目标开口量Ams，将与目标开口量Ams对应的指令信号向电磁比例阀93d、93e输出。电磁比例阀93d、93e对应于指令信号生成先导指令压力PiAm1U、PiAm1D，对第1斗杆用方向控制阀11的开口量进行控制。·辅助流量控制阀控制器94基于斗杆用操作杆95b的输入量、车身202或作业装置203的姿态信息、设计面信息及压力传感器输出值计算目标执行机构流量Qref和再生流量Qreg，从目标执行机构流量Qref减去再生流量Qreg来计算目标执行机构供给流量Qact_A，基于目标执行机构供给流量Qact_A和辅助流量控制阀25的前后压差ΔPfcv来计算辅助流量控制阀25的目标开口量Afcv_A，将与目标开口量Afcv_A对应的指令信号向电磁比例阀93g输出。电磁比例阀93g对应于指令信号生成先导指令压力，对辅助流量控制阀25的开口量进行控制。·液压泵控制器94将各执行机构的目标供给流量Qact_A相加来计算目标泵流量Qpmp_A，将与目标泵流量Qpmp_A对应的指令信号向电磁比例阀93a输出。电磁比例阀93a对应于指令信号生成流量控制指令压力Pip2，对第2液压泵2的流量进行控制。需要说明的是，该动作由于是斗杆缸205a的单独动作，因此目标泵流量Qpmp_A与斗杆缸205a的目标供给流量Qact_A相等。·切换阀控制器94基于斗杆用操作杆95b的输入量来判定再生功能是否有效，在判定结果为是的情况下将切换阀36的目标开口量Aswv设定为全闭，在判定结果为否的情况下将目标开口量Aswv设定为全开，将与目标开口量Aswv对应的指令信号向电磁比例阀93h输出。电磁比例阀93h对应于指令信号生成先导指令压力，对切换阀36的开口量进行控制。效果在本实施方式中，在具备车身202、安装于车身202的作业装置203、驱动车身202或作业装置203的执行机构204a、205a、206a、211、工作油箱5、从工作油箱5吸入工作油并向执行机构204a、205a、206a、211供给的液压泵1～3、与液压泵1～3的排出管路40、50、60并行连接并对从液压泵1～3向执行机构204a、205a、206a、211供给的液压油的流动进行控制的流量控制阀6～16、21～29、用于指示执行机构204a、205a、206a、211的动作的操作杆95a、95b、以及对应于操作杆95a、95b的输入量对流量控制阀6～16、21～29进行控制的控制器94的作业机械300中，具备：再生阀35，其容许从流量控制阀11的出口节流侧向入口节流侧的工作油的流动；以及切换阀36，其设置于将流量控制阀11与工作油箱5连接的油箱管路70，使油箱管路70开放或阻断，控制器94基于操作杆95a、95b的输入量计算作为执行机构204a、205a、206a、211的目标流量的目标执行机构流量Qref，基于操作杆95a、95b的输入量和目标执行机构流量Qref计算作为再生阀35的通过流量Qreg的再生流量Qreg，从目标执行机构流量Qref减去再生流量Qreg来计算目标执行机构供给流量Qact_A，基于目标执行机构供给流量Qact_A计算目标流量控制阀开口量Afcv_A，计算目标执行机构供给流量Afcv_A的合计以上的目标泵流量Qpmp_A，基于操作杆95a、95b的输入量控制切换阀36，对应于目标流量控制阀开口量Afcv_A控制流量控制阀21～29，对应于目标泵流量Qpmp_A控制液压泵1～3。另外，流量控制阀6～16、21～29具有：方向控制阀6～16，其对从液压泵1～3向执行机构204a、205a、206a、211供给的液压油的方向进行控制；以及辅助流量控制阀21～29，其限制从液压泵1～3向方向控制阀6～16的入口节流端口供给的液压油的流量，再生阀35配置在将方向控制阀11的出口节流端口与入口节流端口连接的油路上。根据按照上述方式构成的本实施例，以使得液压泵1～3向执行机构供给的目标流量和执行机构的再生流量Qreg的合计与执行机构的目标流量相等的方式控制流量控制阀21～29及液压泵1～3。由此，能够在确保执行机构的位置控制精度的同时利用再生功能使执行机构的工作速度加快。由此能够提高作业机械100的作业效率。另外，通过在再生时使切换阀36关闭，从而能够可靠地再生执行机构的全部返回流量。此外，由于再生流量与执行机构的返回流量一致，因此不需要进行基于再生阀35的前后压差的再生流量控制。通过像这样将切换阀36的动作设为简单的ON/OFF动作，从而不需要检测再生阀35的前后压差的压力传感器，因此能够简化液压驱动装置400的构成。另外，本实施例的作业机械300具备指示车身202或作业装置203的自动控制功能的有效化或无效化的自动控制功能切换开关96，控制器94在利用自动控制功能切换开关96指示自动控制功能无效化的情况下，基于来自操作杆95a、95b的输入量计算目标流量控制阀开口量Afcv_M及目标泵流量Qpmp_M。由此，在自动控制功能无效的情况下，能够与现有的作业机械同样地利用再生功能使执行机构的工作速度。实施例2图8A及图8B是本发明第2实施例中的液压驱动装置的回路图。构成本实施例中的液压驱动装置400A的构成与第1实施例中的液压驱动装置400大致相同，而以下方面不同。本实施例中的液压驱动装置400A取代第1实施例中的辅助流量控制阀21～29而具备防止从执行机构侧向排出管路40、50、60的逆流的单向阀101～109。本实施例中的再生阀35配置在第1斗杆用方向控制阀11的滑阀的内部，第1斗杆用方向控制阀11设有再生端口121、122。再生端口121与从与第1斗杆用方向控制阀11的出口节流端口连接的油箱管路70分支的油路111连接。再生端口122与从将第1斗杆用方向控制阀11与斗杆缸205a的底侧连接的油路114分支的油路112连接。在第1斗杆用方向控制阀11的滑阀被切换操作为收回方向时，再生阀35的上游侧与油路111连接，再生阀35的下游侧与油路112连接。由此，从斗杆缸205a的杆侧排出的工作油经由再生阀35向底侧供给。在将第1斗杆用方向控制阀11与斗杆缸205a连接的油路113、114上设有压力传感器117、118。需要说明的是，为了简化说明而局部省略图示，方向控制阀6～16及周边的设备、配管、布线全部为相同的构成。图9是本实施例中的控制器94A的功能框图。在图9中，本实施例中的控制器94A取代第1实施例中的目标方向控制阀开口运算部94h及目标流量控制阀开口运算部94i而具有目标方向控制阀开口运算部94l。目标方向控制阀开口运算部94l基于来自控制有效化判定部94a的判定结果、来自目标执行机构供给流量运算部94f的目标执行机构供给流量、操作杆输入量以及压力传感器输出值计算方向控制阀6～16的目标开口量，并输出与目标开口量对应的指令信号。图10是示出控制器94A的与方向控制阀6～16的控制相关的处理的流程图。以下仅说明与第1斗杆用方向控制阀11的控制相关的处理。与其他方向控制阀的控制相关的处理由于与之相同而省略说明。首先，控制器94判定是否没有斗杆用操作杆95b的输入。在步骤S501中判定为无斗杆用操作杆95b输入的情况下，结束该流程。在步骤S501中判定为有斗杆用操作杆95b输入的情况下，判定自动控制功能是否有效。在步骤S502中判定自动控制功能无效的情况下，由控制器94的目标流量控制阀开口运算部94i计算与斗杆用操作杆95b的输入量对应的方向控制阀11的目标开口量Ams_M，将与目标开口量Ams_M对应的指令信号向方向控制阀11用的电磁比例阀93d、93e输出，使电磁比例阀93d、93e生成方向控制阀11的先导指令压力，对应于先导指令压力使方向控制阀11开口，结束该流程。在步骤S502中判定为自动控制功能有效的情况下，由控制器94的再生对象动作判定部94k基于斗杆用操作杆95b的输入量来判定是否为判定再生对象动作。在本实施例中，在斗杆用操作杆95b向斗杆收回方向操作的情况下判定为是再生对象动作，在向斗杆卸放方向操作的情况下判定为非再生对象动作。在步骤S511中判定为非再生对象动作的情况下，由控制器94的再生流量运算部94d将再生流量Qreg设定为零，在判定为是再生对象动作的情况下，将目标执行机构流量Qreg乘以入口节流/出口节流流量比α来计算再生流量Qreg。接着步骤S512或步骤S521，由控制器94的目标执行机构供给流量运算部94f从目标执行机构流量Qref减去再生流量Qreg来计算目标执行机构供给流量Qact_A，由控制器94的目标流量控制阀开口运算部94i基于目标执行机构供给流量Qact_A和方向控制阀11的前后压差ΔPms来计算方向控制阀11的目标开口量Ams_A，并将与目标开口量Ams_A对应的指令信号向方向控制阀11用的电磁比例阀93d、93e输出，在执行步骤S505、S506的处理后，结束该流程。动作基于与第2液压泵2相关的部分来说明第2实施例中的液压驱动装置400A的动作。与其他液压泵相关的部分的动作由于与之相同而省略说明。自动控制功能无效状态的操作说明自动控制功能无效状态时操作斗杆用操作杆95b的情况下的各设备的动作。·方向控制阀控制器94A计算与斗杆用操作杆95b的输入量对应的第1斗杆用方向控制阀11的目标开口量Ams_M，将与目标开口量Ams_M对应的指令信号向电磁比例阀93d、93e输出。电磁比例阀93d、93e对应于指令信号生成先导指令压力PiAm1U、PiAm1D，对第1斗杆用方向控制阀11的开口量进行控制。·液压泵由于与第1实施例相同而省略说明。·切换阀由于与第1实施例相同而省略说明。自动控制功能有效状态的操作说明自动控制功能有效状态时操作斗杆用操作杆95b的情况下的各设备的动作。·方向控制阀控制器94A基于斗杆用操作杆95b的输入量、车身202或作业装置203的姿态信息、设计面信息及压力传感器输出值计算目标执行机构流量Qref和再生流量Qreg，从目标执行机构流量Qref减去再生流量Qreg来计算目标执行机构供给流量Qact_A，基于目标执行机构供给流量Qact_A和方向控制阀11的前后压差ΔPms计算方向控制阀11的目标开口量Ams_A，将与目标开口量Ams_A对应的指令信号向电磁比例阀93d、93e输出。电磁比例阀93d、93e对应于指令信号生成先导指令压力PiAm1U、PiAm1D，对方向控制阀11的开口量进行控制。·液压泵与第1实施例相同而省略说明。·切换阀与第1实施例相同而省略说明。效果在第2实施例中，对从液压泵1～3向执行机构204a、205a、206a、211供给的液压油的流动进行控制的流量控制阀6～16是对从液压泵1～3向执行机构204a、205a、206a、211供给的液压油的方向及流量进行控制的方向控制阀，再生阀115配置在方向控制阀11的滑阀的内部。根据按照上述方式构成的第2实施例，能够以比第1实施例简单的构成在确保执行机构的位置控制精度的同时利用再生功能使执行机构的工作速度加快。由此，能够抑制成本并提高作业机械100的作业效率。以上对本发明的实施例进行了详细说明，但本发明并非限定于上述实施例，而包含多种变形例。例如，上述实施例为了使本发明清楚易懂而进行了详细说明，但并非限定于具备所说明的全部构成。另外，也可以在某一实施例的构成中加入其他实施例的部分构成、将某一实施例的部分构成删除或与其他实施例的一部分置换。附图标记说明1…第1液压泵、1a…流量控制指令压力端口、1b…第1液压泵自身压力端口、1c…第2液压泵自身压力端口、2…第2液压泵、2a…流量控制指令压力端口、2b…第2液压泵自身压力端口、2c…第1液压泵自身压力端口、3…第3液压泵、3a…流量控制指令压力端口、3b…第3液压泵自身压力端口、5…工作油箱、6…右行驶用方向控制阀、7…铲斗用方向控制阀、8…第2斗杆用方向控制阀、9…第1动臂用方向控制阀、10…第2动臂用方向控制阀、11…第1斗杆用方向控制阀、12…第1附属装置用方向控制阀、13…左行驶用方向控制阀、14…回转用方向控制阀、15…第3动臂用方向控制阀、16…第2附属装置用方向控制阀、17…合流阀、18～20…主溢流阀、21～29…辅助流量控制阀、30…单向阀、31…主阀、31a…阀芯、31b…控制可变节流器、31c…第1压力室、31d…第2压力室、31e…第3压力室、32…先导可变节流器、32a…先导端口、33…主阀、33a…阀芯、33b…控制可变节流器、33c…第1压力室、33d…第2压力室、33e…第3压力室、34…先导可变节流器、34a…先导端口、35…再生阀、36…切换阀、41…中央旁通管路、42～47…油路、51…中央旁通管路、52～58…油路、61…中央旁通管路、62～69…油路、70…油箱管路、71～75…油路、81～83…压力传感器、84～86…行程传感器、91…先导泵、92…先导溢流阀、93…电磁阀单元、93a～93h…电磁比例阀、94、94A…控制器、94a…控制有效化判定部、94b…请求执行机构流量运算部、94c…限制执行机构流量运算部、94d…再生流量运算部、94e…目标执行机构流量运算部、94f…目标执行机构供给流量运算部、94g…目标泵流量运算部、94h…目标方向控制阀开口运算部、94i…目标流量控制阀开口运算部、94j…目标切换阀开口运算部、94k…再生对象动作判定部、94l…目标方向控制阀开口运算部、95a…动臂用操作杆、95b…斗杆用操作杆、96…自动控制功能切换开关、97…油路、101～109…单向阀、111～114…油路、117～120…压力传感器、121、122…再生端口、201…行驶体、202…回转体、203…作业装置、204…动臂、204a…动臂缸、205…斗杆、205a…斗杆缸、206…铲斗、206a…铲斗缸、207…驾驶室、208…机械室、209…配重、210…控制阀、211…回转马达、300…液压挖掘机、400、400A…液压驱动装置。
