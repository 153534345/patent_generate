标题title
挖土机
摘要abst
本发明涉及一种挖土机，具有：异常检测部，根据从状态检测传感器收集的诊断数据检测异常；及数据收集部，在所述诊断数据的收集中检测到所述异常时，在检测到所述异常之后也持续收集所述诊断数据。
权利要求书clms
1.一种挖土机，其具有：异常检测部，根据从状态检测传感器收集的诊断数据检测异常；及数据收集部，在所述诊断数据的收集中检测到所述异常时，在检测到所述异常之后也持续收集所述诊断数据。2.根据权利要求1所述的挖土机，其具有：控制部，在检测到所述异常之后，将存储于易失性存储器的所述诊断数据传输至非易失性存储器，在传输所述诊断数据期间，将所述控制部维持为启动的状态。3.根据权利要求2所述的挖土机，其中，在所述诊断数据的传输完成之后，停止向所述控制部供给电源。4.根据权利要求1所述的挖土机，其具有：输出部，输出将在检测到所述异常之前收集的所述诊断数据、在检测到所述异常之后收集的所述诊断数据、以及表示检测到所述异常的信息建立对应关联的信息。5.根据权利要求4所述的挖土机，其输出如下信息：将表示收集到所述诊断数据时的挖土机的动作的信息、在检测到所述异常之前收集的所述诊断数据、在检测到所述异常之后收集到的所述诊断数据、以及表示检测到所述异常的信息建立对应关联的信息。6.根据权利要求5所述的挖土机，其中，所述挖土机的动作为预先规定的规定动作。
说明书desc
技术领域本发明涉及一种挖土机。背景技术以往，已知有如下挖土机：按照显示于驾驶舱内的显示部的规定动作的指示，操作者进行规定动作，将操作者执行规定动作期间的来自传感器的检测值与规定动作建立对应关联来存储于存储部。例如，将与规定动作建立对应关联的来自传感器的检测值发送至管理装置，用于挖土机的故障诊断等。现有技术文献专利文献专利文献1：日本特开2015-63864号公报发明内容发明要解决的技术课题在上述以往技术中，未考虑到因动作中发生的异常导致动作停止的情况。因此，在以往的挖土机中，因异常的发生导致动作停止时，此前收集并临时保存的检测值消失并无法获取表示异常发生时的挖土机的状态的信息。因此，鉴于上述情况，目的在于收集表示发生异常时的挖土机的状态的信息。用于解决技术课题的手段本发明的实施方式所涉及的挖土机具有：异常检测部，根据从状态检测传感器收集的诊断数据检测异常；及数据收集部，在所述诊断数据的收集中检测到所述异常时，在检测到所述异常之后也持续收集所述诊断数据。发明的效果能够收集表示异常发生时的挖土机的状态的信息。附图说明图1是本发明的实施方式所涉及的挖土机的侧视图。图2是表示图1的挖土机PS的驱动系统的结构例的框图。图3是说明控制器的功能的图。图4是表示显示于图像显示部的诊断菜单的选择画面的一例的图。图5是说明挖土机的控制器的处理的流程图。图6是表示异常时发送信息的显示例的图。具体实施方式以下，参考附图，对实施方式进行说明。图1是表示本发明的实施方式所涉及的挖土机的一例的侧视图。在挖土机PS的下部行走体1上通过回转机构2可回转地搭载有上部回转体3。在上部回转体3上安装有动臂4。在动臂4的前端安装有斗杆5。作为端接附属装置，在斗杆5的前端通过斗杆顶销P1以及铲斗连杆销P2安装有铲斗6。作为端接附属装置，可安装斜坡用铲斗、疏浚用铲斗、破碎锤等。动臂4、斗杆5及铲斗6为，作为附属装置的一例而构成挖掘附属装置，并通过动臂缸7、斗杆缸8及铲斗缸9分别被液压驱动。在动臂4上安装有动臂角度传感器S1，在斗杆5上安装有斗杆角度传感器S2，在铲斗6上安装有铲斗角度传感器S3。可在挖掘附属装置设置铲斗倾斜机构。有时还将动臂角度传感器S1、斗杆角度传感器S2及铲斗角度传感器S3称为“姿势传感器”。在图1的实施方式中，动臂角度传感器S1、斗杆角度传感器S2及铲斗角度传感器S3分别由加速度传感器和陀螺仪传感器的组合构成。然而，动臂角度传感器S1、斗杆角度传感器S2及铲斗角度传感器S3中的至少1个可以仅由加速度传感器构成。并且，动臂角度传感器S1可以为安装于动臂缸7的行程传感器，也可以为旋转式编码器、电位器或惯性测量装置等。关于斗杆角度传感器S2及铲斗角度传感器S3也相同。在上部回转体3上搭载发动机11等动力源、车体倾斜传感器S4，并通过罩3a盖住。在上部回转体3的罩3a的上部设置有摄像装置80。摄像装置80包括前方监控摄像机80F、左侧监控摄像机80L、后方监控摄像机80B及右侧监控摄像机80R。在上部回转体3上设置有作为驾驶室的驾驶舱10。在驾驶舱10的顶部设置有GPS装置G1及发送装置T1。GPS装置G1通过GPS功能检测挖土机PS的位置，将位置数据提供给控制器30内的设备引导装置50。发送装置T1向挖土机PS的外部发送信息。发送装置T1例如发送后述管理装置90能够接收的信息。并且，在驾驶舱10内设置有控制器30、显示装置40、声音输出装置43、输入装置45及存储装置47。控制器30作为进行挖土机PS的驱动控制的主控制部发挥作用。控制器30由包括CPU以及内部存储器的运算处理装置构成。控制器30的各种功能通过CPU执行存储于内部存储器的程序来实现。控制器30还作为引导挖土机PS的操作的设备引导装置50发挥作用。设备引导装置50例如向操作者通知操作者设定的目标地形的表面即目标面与附属装置的作业部位的距离等作业信息。目标面与附属装置的作业部位的距离，例如是指作为端接附属装置的铲斗6的前端、铲斗6的背面、作为端接附属装置的破碎锤的前端等与目标面之间的距离。设备引导装置50通过显示装置40或声音输出装置43等向操作者通知作业信息，引导挖土机PS的操作。在本实施方式中，设备引导装置50组装到控制器30，但设备引导装置50与控制器30也可以分开设置。此时，与控制器30相同地，设备引导装置50由包括CPU及内部存储器的运算处理装置构成。设备引导装置50的各种功能通过CPU执行存储于内部存储器的程序来实现。显示装置40根据来自控制器30所包括的设备引导装置50的指令显示包括各种作业信息的图像。显示装置40例如为连接于设备引导装置50的车载液晶显示器。声音输出装置43根据来自控制器30所包括的设备引导装置50的声音输出指令输出各种声音信息。声音输出装置43例如包括连接于设备引导装置50的车载扬声器。并且，声音输出装置43可包括蜂鸣器等警报器。输入装置45是用于供挖土机PS的操作者向包括设备引导装置50的控制器30输入各种信息的装置。输入装置45例如构成为包括设置于显示装置40的表面的薄膜开关。并且，输入装置45也可以构成为包括触控面板等。存储装置47是用于存储各种信息的装置。存储装置47例如为半导体存储器等非易失性存储介质。存储装置47存储包括设备引导装置50的控制器30等输出的各种信息。门锁杆49设置于驾驶舱10的门与驾驶座之间，是防止挖土机PS被误操作的机构。控制器30进行如下控制：在门锁杆49被按下的状态下，将门锁阀49a设为“关”的状态，在门锁杆49被拉起的状态下，将门锁阀49a设为“开”的状态。门锁阀49a是设置于控制阀17与操作杆26A～26C等之间的油路的切换阀。另外，门锁阀49a为通过来自控制器30的指令进行开闭的结构，但也可以为与门锁杆49机械连接，根据门锁杆49的动作进行开闭的结构。门锁阀49a在“关”的状态下，切断控制阀17与操作杆26A～26C等之间的工作油的流动而使操作杆26A～26C等的操作无效。并且，门锁阀49a在“开”的状态下，在控制阀17与操作杆等之间连通工作油，使操作杆26A～26C等的操作有效。即，操作者乘坐在驾驶座，将门锁杆49拉起时，成为操作者无法从驾驶舱10退出但能够操作各种操作装置26的状态。操作者按下门锁杆49时，成为操作者可以从驾驶舱10退出但无法操作各种操作装置26的状态。图2是表示图1的挖土机PS的驱动系统的结构例的框图。在图2的例子中，挖土机PS包括在挖土机PS的管理系统300中。管理系统300包括挖土机PS及与挖土机PS进行通信的管理装置90。另外，管理系统300所包括的挖土机PS的台数可以是任意数。挖土机PS的驱动系统主要包括发动机11、主泵14、先导泵15、控制阀17、操作装置26、控制器30、发动机控制装置74、发动机转速调整刻度盘75、操作阀100等。发动机11是挖土机PS的驱动源，例如为以保持规定转速的方式工作的柴油发动机。发动机11的输出轴连接于主泵14以及先导泵15的输入轴。主泵14是通过高压液压管路16将工作油供给至控制阀17的液压泵，例如为斜板式可变容量式液压泵。先导泵15是用于通过先导管路25向各种液压控制设备供给工作油的液压泵，例如为固定容量式液压泵。控制阀17是控制挖土机PS的液压系统的液压控制阀。控制阀17例如向动臂缸7、斗杆缸8、铲斗缸9、行走用液压马达1A、行走用液压马达1B及回转用液压马达2A中的一个以上选择性地供给从主泵14供给的工作油。另外，以下说明中，将动臂缸7、斗杆缸8、铲斗缸9、行走用液压马达1A、行走用液压马达1B及回转用液压马达2A统称为“液压驱动器”。操作装置26是操作者为了操作液压驱动器而使用的装置，通过先导管路25将从先导泵15供给的工作油供给至对应于各液压驱动器的流量控制阀的先导端口。另外，供给至各先导端口的工作油的压力成为与对应于各液压驱动器的操作杆26A～26C的操作方向以及操作量对应的压力。控制器30是用于控制挖土机PS的控制装置，例如由具备CPU、RAM、ROM等的计算机构成。控制器30的CPU通过从ROM读取对应于挖土机PS的动作或功能的程序并展开至RAM的同时执行程序，能够执行对应于这些各程序的处理。ECU74是控制发动机11的装置。ECU74例如根据来自控制器30的指令值，按照操作者通过发动机转速调整刻度盘75设定的发动机转速，将用于控制发动机11的转速的燃料喷射量等输出至发动机11。发动机转速调整刻度盘75是用于调整发动机的转速的刻度盘，本发明的实施方式中，发动机转速能够进行4阶段切换。例如，发动机转速调整刻度盘75能够以SP模式、H模式、A模式及IDLE模式这4阶段切换发动机转速。另外，图2表示通过发动机转速调整刻度盘75选择H模式的状态。SP模式是欲优先考虑作业量时选择的作业模式，利用最高的发动机转速。H模式是欲兼顾作业量和油耗时选择的作业模式，利用第二高的发动机转速。A模式是优先考虑油耗的同时欲以低噪音运行挖土机PS时选择的作业模式，利用第三高的发动机转速。IDLE模式是欲将发动机设为怠速状态时选择的作业模式，利用最低的发动机转速。而且，发动机11以通过发动机转速调整刻度盘75设定的作业模式的发动机转速恒定地进行转速控制。操作阀100是控制器30为了操作液压驱动器而使用的阀，通过先导管路25将从先导泵15供给的工作油供给至对应于各液压驱动器的流量控制阀的先导端口。另外，供给至各先导端口的工作油的压力成为与来自控制器30的控制信号对应的压力。操作阀100相对于构成附属装置的动臂4、斗杆5、铲斗6的缸，对应于规定动作而设置于杆侧和底侧中的至少一侧。也可以设置于杆侧和底侧的两侧。并且，行走用液压马达1A、行走用液压马达1B及回转用液压马达2A中，设置于吐出侧和吸入侧的至少一侧。也可以设置于吐出侧和吸入侧这两侧。此时，操作装置26即使在中立位置的状态下，也能够执行规定动作。并且，也可以使配置于操作装置26与控制阀17之间的减压阀作为操作阀100发挥作用。此时，通过在将操作装置26最大限度地推倒的状态下从控制器30向减压阀发送减压指令，能够对控制阀17传递稳定的动作指令。并且，在挖土机PS设置有显示装置40。显示装置40通过CAN、LIN等通信网络连接于控制器30。另外，显示装置40也可以通过专用线连接于控制器30。并且，显示装置40包括生成显示于图像显示部41上的图像的转换处理部40a。转换处理部40a根据摄像装置80的输出生成显示于图像显示部41上的摄像机图像。因此，摄像装置80例如通过专用线连接于显示装置40。并且，转换处理部40a根据控制器30的输出生成显示于图像显示部41上的图像。摄像装置80包括前方监控摄像机80F、左侧监控摄像机80L、后方监控摄像机80B及右侧监控摄像机80R。前方监控摄像机80F设置于驾驶舱10的前侧，例如设置于驾驶舱10的顶棚部分等，拍摄挖土机PS的前方及动臂4、斗杆5以及铲斗6的动作。左侧监控摄像机80L例如设置于上部回转体3的罩3a上部的左侧，拍摄挖土机PS的左侧。后方监控摄像机80B设置于上部回转体3的后侧，例如设置于上部回转体3的罩3a上部的后侧，拍摄挖土机PS的后方。右侧监控摄像机80R例如设置于上部回转体3的罩3a上部的右侧，拍摄挖土机PS的右侧。前方监控摄像机80F、左侧监控摄像机80L、后方监控摄像机80B及右侧监控摄像机80R例如为具有CCD或CMOS等摄像元件的数码摄像机，将分别拍摄的图像发送至设置于驾驶舱10内的显示装置40。另外，转换处理部40a也可以作为控制器30具有的功能来实现，而非作为显示装置40具有的功能。此时，摄像装置80连接于控制器30，而不是连接于显示装置40。并且，显示装置40包括作为输入部42的开关面板。开关面板是包括各种硬件开关的面板。开关面板例如包括作为硬件按钮的照明开关42a、刮水器开关42b及玻璃窗清洗器开关42c。照明开关42a是用于切换安装于驾驶舱10的外部的车灯的开灯/熄灯的开关。刮水器开关42b是用于切换刮水器的工作/停止的开关。并且，玻璃窗清洗器开关42c是用于喷射玻璃窗清洗液的开关。并且，显示装置40从蓄电池70接收供电来动作。另外，蓄电池70通过由发动机11的交流发电机11a发电的电力充电。蓄电池70的电力还供给至控制器30以及显示装置40以外的挖土机PS的电气安装件72等。并且，发动机11的启动装置11b通过来自蓄电池70的电力驱动，启动发动机11。发动机11受到ECU74的控制。通过CAN等通信网络从ECU74始终向控制器30发送表示发动机11的状态的各种数据。因此，控制器30将该数据存储于临时存储部30a，必要时能够发送至显示装置40。另外，以下说明中，有时将通过CAN从ECU74发送至控制器30的表示发动机状态的各种数据称为CAN数据。因此，表示通过水温传感器11c检测到的冷却水温的数据为CAN数据所包括的数据。并且，CAN数据中包括从控制器30输入至ECU74的指令值、发动机11的转速、燃料喷射量等。在本实施方式中，ECU74可以是用于检测发动机11的状态的状态检测传感器之一。此时，CAN数据包括在状态检测传感器的检测值中。以下说明中，状态检测传感器的检测值还包括CAN数据。并且，如下向控制器30供给各种数据，并存储于控制器30的临时存储部30a。所存储的数据在必要时能够发送至显示装置40。首先，表示斜板角度的数据从可变容量式液压泵即主泵14的调节器14a发送至控制器30。并且，表示主泵14的吐出压力的数据从吐出压力传感器14b发送至控制器30。并且，在存储有主泵14吸入的工作油的罐与主泵14之间的管路上设置有油温传感器14c，表示流过该管路的工作油的温度的数据从油温传感器14c发送至控制器30。并且，由液压传感器15a、15b检测对操作杆26A～26C进行操作时输送至控制阀17的先导压，并将表示检测到的先导压的数据发送至控制器30。并且，从发动机转速调整刻度盘75始终向控制器30发送表示发动机转速的设定状态的数据。并且，挖土机PS能够通过通信网络93与管理装置90相互通信。管理装置90例如为设置于挖土机PS的制造商、服务中心的计算机等，专业人员能够远程掌握挖土机PS的状况。控制器30能够将来自挖土机PS所包括的各种状态检测传感器的检测值的数据存储于临时存储部30a等并发送至管理装置90。如此，将在规定动作中获取的数据发送至管理装置90作为诊断数据。另外，控制器30具有无线通信功能，能够通过通信网络93与管理装置90进行通信。专业人员分析从挖土机PS发送至管理装置90并由管理装置90的接收部90a接收的来自各种状态检测传感器的检测值的数据，并判定挖土机PS的状态。例如，专业人员诊断有无故障、不正常，在存在故障、不正常的情况下，可以确定故障、不正常的部位、故障、不正常的原因等。由此，能够提前准备修理挖土机PS所需的部件等，能够缩短维护、修理所耗费的时间。控制器30的功能的详细内容在后面叙述。并且，管理装置90具有处理部90b。处理部90b中输入有预先设定的程序，可以通过程序进行从挖土机PS发送的来自各种状态检测传感器的检测值的运算处理。例如，处理部90b包括所输入的诊断程序，可以通过诊断程序，利用从挖土机PS发送的状态检测传感器的检测值，进行故障诊断、故障预测。基于处理部90b的运算处理结果可以显示于管理装置90的显示部90c。另外，管理装置90可以为能够通过设置于挖土机PS的制造商、服务中心的服务器等间接地与挖土机PS进行通信的装置。并且，管理装置90可以为配备在制造商、服务中心的常设型计算机，也可以为作业负责人能够携带的便携型计算机，例如作为便携终端的多功能型便携信息终端即所谓的智能手机、平板终端等。管理装置90为便携型时，能够携带到检查修理现场，因此能够一边观察管理装置90的显示器，一边实施检查修理作业，其结果，检查修理的作业效率得到提高。并且，利用便携终端时，可以通过Bluetooth、红外线通信等近距离通信而不通过通信网络，直接与挖土机进行通信。此时，通过向便携终端进行画面输入、声音输入等操作，将规定动作的执行指示从便携终端发送至挖土机。即，将使来自执行规定动作期间的状态检测传感器的检测值与规定动作建立对应关联来存储的指示从便携终端发送至挖土机。而且，通过将规定动作的动作结果从挖土机发送至便携终端，能够在便携终端的画面上确认规定动作的动作结果。挖土机PS所包括的各种状态检测传感器是检测挖土机PS的各部的动作的传感器。各种状态检测传感器包括动臂角度传感器S1、斗杆角度传感器S2、铲斗角度传感器S3、车体倾斜传感器S4、回转角度传感器S5、行走旋转传感器S6A、行走旋转传感器S6B等。动臂角度传感器S1设置于上部回转体3上的动臂4的支撑部，检测动臂4从水平面起的角度。作为动臂角度传感器S1，例如可使用旋转式电位器等任意角度传感器，对于后述斗杆角度传感器S2、铲斗角度传感器S3也相同。将检测到的动臂角度发送至控制器30。斗杆角度传感器S2设置于动臂4上的斗杆5的支撑部，检测斗杆5相对于动臂4的角度。将检测到的斗杆角度发送至控制器30。铲斗角度传感器S3设置于斗杆5上的铲斗6的支撑部，检测铲斗6相对于斗杆5的角度。将检测到的铲斗角度发送至控制器30。车体倾斜传感器S4是检测挖土机PS相对于水平面的2轴方向的倾斜角的传感器。车体倾斜传感器S4例如可使用液体封入静电电容式倾斜传感器、任意的倾斜传感器。将检测到的倾斜角发送至控制器30。回转角度传感器S5检测基于回转机构2的上部回转体3的回转角度。回转角度传感器S5例如可使用旋转式编码器等任意角度传感器。将检测到的回转角度发送至控制器30。行走旋转传感器S6A以及行走旋转传感器S6B分别检测行走用液压马达1A以及行走用液压马达1B的转速。作为行走旋转传感器S6A以及行走旋转传感器S6B，例如可使用磁式等任意的旋转传感器。将检测到的各转速发送至控制器30。并且，如上所述，作为挖土机PS所包括的各种状态检测传感器，有调节器14a、吐出压力传感器14b、油温传感器14c、液压传感器15a、15b、发动机转速调整刻度盘75、摄像装置80、ECU74等。将通过这些传感器检测到的检测值也发送至控制器30。因此，本实施方式的状态检测传感器的检测值包括表示挖土机PS的各部的动作的动作信息和表示挖土机PS的发动机状态的信息。将从上述挖土机PS所包括的各种状态检测传感器发送至控制器30的数据存储于控制器30的临时存储部30a。接着，参考图3，对本实施方式的控制器30的功能进行说明。图3是说明控制器的功能的图。本实施方式的控制器30具有临时存储部30a、发送信息存储部30b、人体检测部30c、诊断处理部30d、数据收集部30e、数据存储部30f、异常检测部30g、输出部30h。临时存储部30a是通过易失性存储器实现的存储部。在临时存储部30a中临时存储来自挖土机PS所包括的各种状态检测传感器的检测值的数据。存储于临时存储部30a的状态检测传感器的检测值可以包括CAN数据。具体而言，在临时存储部30a中存储在规定动作中获取的状态检测传感器的检测值。发送信息存储部30b是通过非易失性存储器实现的存储部。在发送信息存储部30b中存储发送至管理装置90的发送信息。发送信息的详细内容在后面叙述。人体检测部30c根据由摄像装置80拍摄的挖土机PS周围的图像数据，检测存在于挖土机PS周围的人。换言之，人体检测部30c判定在挖土机PS周围是否存在人等。另外，在判定挖土机PS周围是否有人等时，能够使用可以检测人体的各种人体检测传感器。诊断处理部30d利用状态检测传感器的检测值，根据挖土机PS的诊断部位等进行各种诊断。因此，状态检测传感器的检测值可以说是在基于诊断处理部30d的挖土机PS的诊断中所使用的诊断数据。诊断处理部30d的处理的详细内容在后面叙述。数据收集部30e在用于进行基于诊断处理部30d的诊断的规定动作中收集各种状态检测传感器的检测值，并存储于临时存储部30a。换言之，数据收集部30e从状态检测传感器收集用于挖土机PS的诊断处理的诊断数据。并且，本实施方式的数据收集部30e在通过后述异常检测部30g检测到异常时，在检测到异常之后，也在一定期间内持续收集状态检测传感器的检测值，并存储于临时存储部30a。数据存储部30f在发送信息存储部30b中存储临时存储于临时存储部30a的状态检测传感器的检测值，作为发送至管理装置90的发送信息。具体而言，数据存储部30f将确定为了通过诊断处理部30d进行诊断而执行的规定动作的信息与状态检测传感器的检测值建立对应关联来存储于发送信息存储部30b。此时，数据存储部30f在规定动作中未检测到异常而结束时，作为将确定此时执行的规定动作的信息与该规定动作中获取的状态检测传感器的检测值建立了对应关联的正常时发送信息，存储于发送信息存储部30b。另外，此时，用于确定挖土机PS的机身识别信息和表示执行了规定动作的日期的信息可以包括在正常时发送信息。并且，数据存储部30f在因规定动作中发生的异常而规定动作在中途结束时，作为将分别在检测到异常之前和检测到异常之后获取的状态检测传感器的检测值、确定规定动作的信息、以及表示在规定动作中检测到异常的信息建立了对应关联的异常时发送信息，存储于发送信息存储部30b。另外，此时，异常时发送信息中可以包括用于确定挖土机PS的机身识别信息和表示进行了规定动作的日期的信息。并且，异常时发送信息中可以包括表示由异常检测部30g检测到的异常的种类的异常编码。例如，异常编码在异常检测部30g中与异常的种类建立对应关联来保存，可以在异常检测部30g检测到异常时确定。如此，发送信息存储部30b中存储规定动作正常结束时的正常时发送信息和在规定动作中检测到异常时的异常时发送信息。如此，诊断数据包括正常时发送信息和异常时发送信息。异常检测部30g检测用于进行基于诊断处理部30d的诊断的规定动作中的挖土机PS的异常。具体而言，异常检测部30g根据数据收集部30e收集的状态检测传感器的检测值，检测挖土机PS中发生的异常。换言之，异常检测部30g在基于状态检测传感器的诊断数据的收集中，根据诊断数据检测异常。由异常检测部30g检测到的异常例如是指发动机11停止的状态、决定为规定动作的指令值未从控制器30输出的状态、先导配管的异常等。输出部30h输出存储于发送信息存储部30b的发送信息。更具体而言，本实施方式的输出部30h在控制器30启动时，在发送信息存储部30b中存储有异常时发送信息时，将该异常时发送信息发送至管理装置90。控制器30启动的时间是指开始向控制器30供给电力的时间。在本实施方式中，有时将存储于发送信息存储部30b的发送信息发送至管理装置90的情况表示为输出发送信息。并且，在本实施方式中，有时将使存储于发送信息存储部30b的发送信息显示于挖土机PS的显示装置40的情况表示为输出发送信息。接着，对本实施方式的诊断处理部30d的处理进行说明。图4是表示显示于图像显示部的诊断菜单的选择画面的一例的图。如图4所示，诊断菜单的选择画面具有诊断菜单显示部410。显示于诊断菜单显示部410的图像，通过显示装置40的转换处理部40a，由从控制器30发送的各种数据生成。诊断菜单显示部410根据诊断部位等，显示多个诊断项目的一览。在图4所示的例子中，诊断菜单显示部410中显示有“综合诊断”、“简易诊断”、“铲斗诊断”、“发动机相关”、“液压相关”及“回转相关”这6个诊断项目的一览。诊断项目预先存储于控制器30的ROM等。关于每个诊断项目，为了进行诊断而执行的规定动作可以是一种，也可以是多种。并且，在图像显示部41上显示结束显示有诊断菜单的选择画面时使用的“结束”菜单。操作者通过对显示于图像显示部41的诊断菜单的选择画面中欲执行的诊断项目进行触控操作，能够选择任意诊断项目。另外，选择诊断项目的方法可以代替触控操作，例如为按钮操作。“综合诊断”是综合诊断挖土机PS的各部是否正常的诊断项目，例如与发动机相关、液压相关及回转相关的规定动作建立有对应关联。若操作者选择“综合诊断”，则通过控制器30按照规定的顺序执行挖土机PS的发动机相关、液压相关及回转相关的规定动作，并将确定所执行的规定动作的信息与在规定动作中获取的状态检测传感器的检测值建立对应关联。并且，“综合诊断”可以代替上述规定动作或者与上述规定动作一同，与其他规定动作建立有对应关联。用于收集该诊断数据的规定动作可以自动执行，也可以通过将诊断的规定动作引导显示于显示装置，由操作者进行操作杆操作而手动执行各动作。规定动作是控制器30通过根据预先规定的图案的指令值驱动挖土机PS来执行的动作，且是减少了人为操作偏差的动作。“简易诊断”是简易诊断挖土机PS的各部是否正常的诊断项目，例如为发动机相关的一部分、液压相关的一部分，并且与不包括挖土机PS的附属装置动作以及回转动作的规定动作建立有对应关联。若操作者选择“简易诊断”，则通过控制器30执行挖土机PS的发动机相关的一部分、液压相关的一部分的规定动作，并将确定所执行的规定动作的信息与在规定动作中获取的状态检测传感器的检测值建立对应关联。并且，“简易诊断”可以代替上述规定动作或者与上述规定动作一同，与其他规定动作建立有对应关联。“发动机相关”是包括用于诊断发动机11是否正常的一个以上规定动作的诊断项目。若操作者选择“发动机相关”，则通过控制器30执行挖土机PS的发动机相关的规定动作。“液压相关”是包括用于诊断液压系统是否正常的一个以上规定动作的诊断项目，例如包括用于诊断主泵14、先导泵15等液压泵、液压驱动器的一个以上规定动作。“液压相关”例如包括作为规定动作α的“将斗杆闭合至行程终点”、作为规定动作β的“在闭合了斗杆的状态下，将动臂提升至行程终点”。并且，“液压相关”可以代替上述规定动作或者与上述规定动作一同包括其他规定动作。其中，对动臂4或斗杆5等附属装置的规定动作的例子进行说明。首先，通过从控制器30向操作阀100输出指令，将动臂4转动至动臂提升时的行程终点。之后，持续施加负荷。即，通过控制阀17向动臂缸7持续供给工作油。该状态下，由于动臂4到达行程终点，因此工作油从安全阀向罐吐出。如此，通过到达缸的行程终点，能够设为持续施加负荷的状态。由此，无论在何种作业环境下，均能够以再现性良好且稳定的状态检测诊断用数据。对于斗杆5或铲斗6也相同。而且，到达缸的行程终点之后，可通过调整主泵14的调节器14a或者变更发动机转速来变更负荷。通过检测变更负荷时的动臂4等附属装置的缸压的变化或主泵14的吐出压的变化，可再现动态的状态，能够进一步提高诊断精度。其结果，除了液压回路的诊断，还能够诊断主泵14或发动机11。“回转相关”是包括用于诊断回转机构2是否正常的一个以上规定动作的诊断项目。“回转相关”例如包括作为规定动作的“在闭合了附属装置的状态下回转”。并且，“回转相关”可以代替上述规定动作或者与上述规定动作一同包括其他规定动作。其中，对回转或行走等针对利用液压马达的驱动部的规定动作的例子进行说明。首先，通过从控制器30向操作阀100输出指令，将动臂4等附属装置设为规定姿势。这是因为，尤其在回转的诊断中，回转负荷受到由附属装置的姿势变化带来的回转惯性力矩的影响较大。因此，驱动动臂4、斗杆5、铲斗6等，以使附属装置成为规定的姿势。而且，在安装有铲斗6、破碎锤等相对重的端接附属装置时，可以通过声音、画面显示等通知驾驶员变更为规定的铲斗6。如此，在以回转时产生的惯性力矩变得相同的方式驱动回转驱动部之前，进行附属装置的调整。完成调整之后，通过从控制器30向操作阀100输出预先设定的驱动指令，使其执行回转动作。根据使回转用液压马达2A加速、等速、减速的驱动指令，回转用液压马达2A能够执行回转用规定动作。由此，能够进行回转用液压马达2A、回转用液压马达2A所使用的液压回路、回转减速机的诊断。例如，在液压回路的安全阀发生异常时，回转加速度变差。该异常能够根据回转用液压马达2A的液压回路的压力检测值的变化来掌握。接着，参考图5，对本实施方式的控制器30的处理进行说明。图5是说明控制器的处理的流程图。本实施方式的控制器30在启动时，通过输出部30h判定发送信息存储部30b中是否存储有异常时发送信息。在步骤S501中，发送信息存储部30b中存储有异常时发送信息时，输出部30h将该异常时发送信息发送至管理装置90，并进入步骤S503。在步骤S501中，发送信息存储部30b中未存储异常时发送信息时，控制器30进入步骤S503。控制器30通过诊断处理部30d判定操作者是否从诊断菜单的选择画面选择了诊断项目。在步骤S503中，诊断项目未被选择时，控制器30待机至诊断项目被选择。在步骤S503中，诊断项目被选择时，控制器30通过人体检测部30c判定在挖土机PS周围是否存在人等。在步骤S504中，在周围检测到人体时，控制器30使显示装置40显示表示周围存在人的警告，使挖土机PS的动作停止，并使基于诊断处理部30d的处理结束。在步骤S504中，在周围未检测到人体时，控制器30通过诊断处理部30d使与被选择的诊断项目建立对应关联的规定动作开始。接着，控制器30通过数据收集部30e收集状态检测传感器的检测值，并存储于临时存储部30a。接着，控制器30通过诊断处理部30d判定规定动作是否结束。在步骤S508中，规定动作结束时，进入后述步骤S513。在步骤S508中，规定动作未结束时，控制器30通过异常检测部30g判定是否检测到异常。在步骤S509中，未检测到异常时，控制器30返回步骤S506。在步骤S509中，检测到异常时，控制器30通过数据收集部30e，在一定期间内持续收集状态检测传感器的检测值，并存储于临时存储部30a。接着，控制器30通过数据存储部30f，将用于确定规定动作的信息和表示检测到异常的信息与状态检测传感器的检测值建立对应关联作为异常时发送信息，并存储于发送信息存储部30b。接着，控制器30关闭电源，并结束处理。在步骤S508中，结束规定动作时，数据存储部30f将用于确定规定动作的信息与状态检测传感器的检测值建立对应关联作为正常时发送信息，并存储于发送信息存储部30b。接着，控制器30通过输出部30h将存储于发送信息存储部30b的正常时发送信息发送至管理装置90，并结束处理。管理装置90利用从控制器30接收的信息，根据预先设定的算法进行诊断。管理装置90可以利用算法执行诊断之后，从管理装置90向挖土机PS的控制器30、支援装置200发送诊断结果。由此，能够通过挖土机PS的显示装置40、支援装置200确认诊断结果。以下，在步骤S509中，对检测到异常的情况进行具体说明。例如，本实施方式的异常检测部30g根据状态检测传感器的检测值所包括的CAN数据，在发动机11的转速成为规定数以下时，判定为发动机11停止，并检测为异常。挖土机PS中，若检测到发动机11的停止，则停止通过交流发电机11a发电。因此，控制器30的供电源为交流发电机11a时，发动机11的停止也会导致停止向控制器30的电力供给。因此，在本实施方式中，控制器30在通过异常检测部30g检测到发动机11的停止时，将供电源从交流发电机11a切换成蓄电池70。而且，控制器30通过从蓄电池70供给的电力与ECU74通信，获取在检测到发动机11的停止之后由ECU74获取的CAN数据。换言之，控制器30在发动机11的转速成为规定数以下之后，通过从蓄电池70供给的电力工作，并从状态检测传感器之一的ECU74获取表示发动机11的状态的信息。并且，控制器30可以在检测到发动机11的转速成为规定数以下之后到发动机11的旋转完全停止为止的期间，与ECU74进行通信，并获取表示发动机11的状态的信息。在存储于临时存储部30a的状态检测传感器的检测值从临时存储部30a传输至永久存储器即发送信息存储部30b并保存之后，切断来自蓄电池70的电力的供给，并关闭控制器30。如此，在本实施方式中，检测到发动机11的停止时，将存储于临时存储部30a的检测值保存在发送信息存储部30b之后，关闭控制器30。并且，在本实施方式中，可以在检测到发动机11的停止之后，在一定期间内持续收集检测值，并存储于临时存储部30a。而且，在存储于临时存储部30a的检测值作为异常时发送信息传输至永久存储器即发送信息存储部30b并保存之后关闭控制器30。因此，根据本实施方式，即使在检测到发动机11停止的情况下，控制器30也不会立即被关闭而能够获取检测到发动机11停止的定时前后的状态检测传感器的检测值。如此，即使规定动作尚未完成，诊断数据仍会可靠地存储于存储部。并且，在本实施方式中，控制器30启动时，判定发送信息存储部30b中是否存储有未发送的异常时发送信息。发送信息存储部30b中存储有异常时发送信息的情况表示在上次动作中检测到异常并强制结束了动作。因此，本实施方式的控制器30启动时，判定发送信息存储部30b中是否存储有异常时发送信息，在存储有异常时发送信息时，将该异常时发送信息发送至管理装置90。如此，在本实施方式中，即使规定动作尚未完成，诊断数据仍会可靠地发送至管理装置90。所发送的诊断数据例如为指令值、操作杆操作量、发动机冷却水温度、工作油温度、增压压力、发动机转速、泵吐出压力、发动机燃料喷射压力、负荷率、大气压等。根据该诊断数据，能够分析是指令值存在异常还是发动机等驱动部存在异常等。并且，例如，本实施方式的异常检测部30g可以在从控制器30输入至ECU74的指令值与用于执行规定动作的指令值为不同值时等，检测为异常。若如此处理，即使挖土机PS的动作因检测到异常而被中断，也能够将检测到该异常时的异常时发送信息发送至管理装置90。另外，管理装置90可以在从挖土机PS接收到异常时发送信息时，使异常时发送信息显示于管理装置90的显示器等。并且，挖土机PS的输出部30h可以使异常时发送信息显示于挖土机PS的显示装置40。图6是表示异常时发送信息的显示例的图。例如，图6所示的画面61示出异常时发送信息显示于管理装置90的显示部90c的例子。另外，画面61也可以显示于挖土机PS的显示装置40。画面61具有显示区域62、显示区域63、显示区域64。显示区域62中显示表示在规定动作中检测到移动的信息。具体而言，图6中，显示区域62中显示有表示在规定动作中检测到异常的信息62a和表示所检测到的异常的种类的信息62b。在图6的例子中，所检测到的异常为发动机的停止。并且，规定动作是指从预先规定的第一规定姿势过渡到预先规定的第二规定姿势的动作。因此，规定动作是从第一规定姿势开始且在成为第二规定姿势时结束的动作。第一规定姿势和第二规定姿势可以为分别不同的姿势，也可以为相同的姿势。即，规定动作可以是将姿势从某一规定姿势改变成另一规定姿势的动作，也可以是从某一规定姿势开始进行规定的动作并再次恢复某一规定姿势的动作。显示区域63中显示确定挖土机PS的机身识别信息、表示执行了规定动作的日期的信息、确定所执行的规定动作的信息、异常编码。确定规定动作的信息例如为规定动作的名称。在图6中，根据显示区域62的显示内容和显示区域63的显示内容可知，在2019年8月12日进行的规定动作“动臂提升”的动作中，在显示区域64所示的定时t1检测到发动机11的停止。在显示区域64中，将状态检测传感器的检测值中发动机11的转速及从控制器30输出至操作阀100的动臂提升所涉及的指令值各自相对于时间的变动显示为曲线图。如显示于显示区域64的曲线图所示，在时刻0，生成动臂提升指令。根据该动臂提升指令，不仅是动臂4上升，斗杆5、铲斗6也上升。由于此时产生的负荷，发动机转速虽下降，但ECU74会检测该发动机转速的下降并根据发动机转速的下降量输出喷射指令。由此，发动机转速在时刻2恢复。然而，若在时刻4，动臂缸7内的活塞到达行程终点，则会导致液压回路内的压力上升。因此，施加于发动机11的负荷进一步变大，并导致发动机转速再次下降。如此，显示于显示区域64的曲线图中，可知从通过异常检测部30g判定为发动机11停止的定时t1之前到定时t1之后为止，持续获取状态检测传感器的检测值。因此，根据本实施方式，能够可视化从定时t1到发动机11的转速成为0的定时t2为止的期间转速如何变化的情况。另外，画面61中可以显示除显示区域62、63、64所示的信息以外的信息。具体而言，在画面61中，表示挖土机PS中发生异常的部位的信息可以用表示挖土机PS的形状的图像等显示。并且，画面61中也可以不显示所有显示区域62、63、64。画面61中至少显示有显示区域64即可。并且，在显示区域64中显示的曲线图中，设定为时刻“0”的定时是开始记录诊断数据的时刻。并且，设定为时刻“0”的定时也可以是开始规定动作的时刻。并且，工作人员能够任意显示操作杆操作量、发动机冷却水温度、工作油温度、增压压力、泵吐出压力、发动机燃料喷射压力、负荷率、大气压等物理量，而不限于图6所示的指令值、发动机转速。并且，在本实施方式中，可以将在发动机的转速成为0的定时t2为止的期间收集而存储于临时存储部30a的检测值，在从定时t2到定时t3为止的期间传输至发送信息存储部30b。在此期间，控制器30接收来自蓄电池70的电力供给而维持开启状态。并且，在本实施方式中，可以将从定时t1到定时t3为止作为规定期间，对到定时t3为止的状态检测传感器的检测值进行收集而存储于临时存储部30a。此时，在定时t3以后到存储于临时存储部30a的检测值向发送信息存储部30b的传输完成为止，控制器30处于开启状态。换言之，在将诊断数据从易失性存储器即临时存储部30a传输到非易失性存储器即发送信息存储部30b的期间，控制器30维持启动状态。如此，在本实施方式中，即使在通过异常检测部30g检测到发动机11的停止的情况下，也维持控制器30的开启状态，并将存储于临时存储部30a的表示挖土机PS的状态的信息传输至发送信息存储部30b。而且，控制器30在完成传输之后成为关闭状态。换言之，在本实施方式中，若完成诊断数据从易失性存储器即临时存储部30a向非易失性存储器即发送信息存储部30b的传输，则切断向控制器30的电力供给。因此，根据本实施方式，能够收集并保存异常发生的定时的表示挖土机PS的各部的动作的动作信息和表示发动机状态的信息。即，根据本实施方式，能够收集表示异常发生的时的挖土机PS的状态的信息。而且，根据本实施方式，在检测到异常之后，也能够获取表示挖土机PS的各部的动作的动作信息和表示发动机状态的信息。因此，根据本实施方式，能够比较异常发生前的挖土机PS的状态与异常发生后的挖土机PS的状态。而且，在本实施方式中，与收集表示发动机状态的信息一同收集表示挖土机PS的动作的动作信息。因此，根据本实施方式，例如，能够将其与检测到发动机11的异常时的挖土机PS的动作建立对应关联。从这些内容可知，本实施方式能够有助于确定挖土机PS中发生的异常的原因。另外，在图6的例子中，作为状态检测传感器的检测值的变化，将发动机11的转速和指令值显示为曲线图，但并不限定于此。在本实施方式中，例如，也可以显示除发动机11的转速和指令值以外的值。并且，在本实施方式中，异常检测部30g在规定动作中检测异常的发生，但并不限定于此。例如，异常检测部30g在如暖机运转、排气处理装置的再生运转等使挖土机PS静止的状态下仅运转发动机11的情况下，也能够检测异常。并且，异常检测部30g也可以在挖土机PS进行除规定动作以外的动作期间检测异常。具体而言，例如，即使在操作者操作挖土机PS来进行作业期间，只要发生异常，则异常检测部30g可以检测该异常。控制器30在通过异常检测部30g检测到异常时，与上述规定动作中同样地，在检测到异常之后也持续收集状态检测传感器的检测值即可。以上，对本发明的优选实施例进行了详细说明，但本发明并不限于上述实施例，在不脱离本发明的范围内，能够对上述实施例施加各种变形及替换。并且，本国际申请主张基于2019年9月18日申请的日本专利申请2019-169179的优先权，将日本专利申请2019-169179的全部内容援用于本国际申请。符号说明PS-挖土机，30-控制器，30a-临时存储部，30b-发送信息存储部，30c-人体检测部，30d-诊断处理部，30e-数据收集部，30f-数据存储部，30e-异常检测部，30h-输出部，40-显示装置，42-输入装置，80-摄像装置，80B、80F、80L、80R-摄像机，90-管理装置，92B、92F、92L、92R-麦克风，300-管理系统。权利要求书1.一种挖土机，其具有：异常检测部，根据从状态检测传感器收集的诊断数据检测异常；及数据收集部，在所述诊断数据的收集中检测到所述异常时，在检测到所述异常之后也持续收集所述诊断数据。2.根据权利要求1所述的挖土机，其具有：控制部，在检测到所述异常之后，将存储于易失性存储器的所述诊断数据传输至非易失性存储器，在传输所述诊断数据期间，将所述控制部维持为启动的状态。3.根据权利要求2所述的挖土机，其中，在所述诊断数据的传输完成之后，停止向所述控制部供给电源。4.根据权利要求1所述的挖土机，其具有：输出部，输出将在检测到所述异常之前收集的所述诊断数据、在检测到所述异常之后收集的所述诊断数据、以及表示检测到所述异常的信息建立对应关联的信息。5.根据权利要求4所述的挖土机，其输出如下信息：将表示收集到所述诊断数据时的挖土机的动作的信息、在检测到所述异常之前收集的所述诊断数据、在检测到所述异常之后收集到的所述诊断数据、以及表示检测到所述异常的信息建立对应关联的信息。6.根据权利要求5所述的挖土机，其中，所述挖土机的动作为预先规定的规定动作。7.根据权利要求6所述的挖土机，其中，所述规定动作与被选择的诊断项目建立有对应关联。8.根据权利要求1所述的挖土机，其中，在异常检测后，进行诊断数据的收集。9.根据权利要求1所述的挖土机，其中，在开始所述规定动作之前，判定在所述挖土机的周围是否存在人。10.根据权利要求1所述的挖土机，其中，所述数据收集部在所述诊断数据的收集中检测到所述异常时，将用于确定所述规定动作的信息和表示检测到异常的信息与所述诊断数据建立对应关联并存储于存储部。11.根据权利要求1所述的挖土机，其中，所述数据收集部在所述诊断数据的收集正常结束时，将所述诊断数据与用于确定所述规定动作的信息建立对应关联并存储于存储部。
