标题title
一种无人机高边坡危岩体智能识别方法
摘要abst
本发明涉及一种无人机高边坡危岩体智能识别方法，涉及图像处理技术领域，包括以下步骤，构建无人机航线，通过无人机飞行拍摄高边坡危岩体，从左到右、从上到下依次进行拍摄；将无人机拍摄的相片导入计算机并获取危岩体的点云数据；对点云数据进行预处理以降低数据量并平滑点云，然后利用种子点滤波算法或拟斜率滤波算法从去噪点云中提取地面点云；采用聚类算法对各边界点云进行分类并对聚类后的点云进行三维重构生成DEM，通过筛选规则提取危岩体对象，本发明具有高效、自动化和精确提取孤立危岩数据的优点。
权利要求书clms
1.一种无人机高边坡危岩体智能识别方法，其特征在于：包括以下步骤，Ⅰ.构建无人机航线，通过无人机飞行拍摄高边坡危岩体，从左到右、从上到下依次进行拍摄；Ⅱ.将无人机拍摄的相片导入计算机并获取危岩体的点云数据；Ⅲ.对点云数据进行预处理以降低数据量并平滑点云，然后利用种子点滤波算法或拟斜率滤波算法从去噪点云中提取地面点云；Ⅳ.采用聚类算法对各边界点云进行分类并对聚类后的点云进行三维重构生成DEM，通过筛选规则提取危岩体对象。2.根据权利要求1所述的一种无人机高边坡危岩体智能识别方法，其特征在于：无人机的航线范围超出测量范围，无人机的飞行高度超过飞行区域最高障碍物。3.根据权利要求1所述的一种无人机高边坡危岩体智能识别方法，其特征在于：无人机航向保持80%的重叠度，旁向保持50%的重叠度，相机角度选择45°。4.根据权利要求1所述的一种无人机高边坡危岩体智能识别方法，其特征在于：通过Kd-tree进行拓扑结构构建，采用基于局部表面拟合方法进行离散点云数据的法向量和曲率计算，以直接通过点云模型获取点云的几何特征。5.根据权利要求1所述的一种无人机高边坡危岩体智能识别方法，其特征在于：种子点滤波算法具体流程如下：①对整体构建三角网；②找到三角面片边长较大的三角网，遍历顶点，找到高程最大的顶点，标识为噪声点；③对三角网进行泛洪增长，其中找到点的周围邻接三角网，将不含噪声点的三角网标识为一簇，直到找到所有三角网簇；④最后移除噪声面片获得准确地面种子点。6.根据权利要求5所述的一种无人机高边坡危岩体智能识别方法，其特征在于：将种子点云投影到种子点最低点对应的XY平面中，外扩种子点云的外包围盒形成缓冲区域，沿着缓冲区域均匀插值，获取每个插值点到种子点的最近邻点，将该点的高程值赋给插值点以确保所有点都位于TIN中，随后迭代以遍历所有的地物点。7.根据权利要求6所述的一种无人机高边坡危岩体智能识别方法，其特征在于：每次迭代遍历所有的地物点，将满足条件的点作为地面种子点，一次性插入到上一步构建的TIN中，继续遍历剩下的地物点，根据新的TIN，计算迭代角度和迭代阈值，将满足条件的点作为新的地面种子点，重复上述构网过程和迭代过程，直到迭代次数超过阈值或没有新的地面点加入到种子点中为止，以使最后的种子点包含了所有的地面点。8.根据权利要求1所述的一种无人机高边坡危岩体智能识别方法，其特征在于：拟斜率滤波算法具体流程如下：①翻转原始激光点云；②自定义基准面，该基准面可为水平面或竖直面或于点云分布基本平行的面，并在该基准面上选择一条基准线，该基准线为直线；③获取等距的部分点云投影到该基准面上，获取这些投影点与基准面之间的距离，同时获取这些点与基准线的距离；④通过计算选取点的优选正切值并记录，并与在先记录的正切值进行差值计算；⑤通过将各项差值导入图表中进行对比；⑥由计算机自动选取差值小以及正切值基本接近的点云，即可判断为地面点。9.根据权利要求1所述的一种无人机高边坡危岩体智能识别方法，其特征在于：所述聚类算法具体方法如下：①从模型边界点中选取高程最高点，作为搜索起点，加入待检测点列表；②从待检测点列表中提取一个点，从该点出发通过k-邻域算法找出其邻域点云；③依次对比当前待检测点与邻域点云中每个点的高程，如果其差值满足给定阈值，则标记该邻域点，并将其加入待检测点列表；如果该邻域点已经被标记跳过该点；④不断重复第②、③步，直到所有待检测点都已经处理完成；⑤检查模型边界点中是否还有未标记的点，如果有，选取其高程最高点加入待检测点列表，重复②～④步，直到模型边界点都已经处理完成；⑥通过上述步骤，已标记区域均不属于岩石块体，而未标记点云区域则为岩石块体，然后利用聚类算法进行分类，确定属于各块体的点云。10.根据权利要求9所述的一种无人机高边坡危岩体智能识别方法，其特征在于：在获得岩石块体点云后，采用三维重建技术重构岩石块体DEM模型，得出提取规则筛选确定各危岩体。
说明书desc
技术领域本发明涉及图像处理技术领域，尤其涉及一种无人机高边坡危岩体智能识别方法。背景技术危岩是指由多组岩体结构面切割，并且位于陡坡或者陡崖上的不稳定岩体。对于高边坡表面孤立的危岩体，其外部形态通常表现为凸起的块体，在高边坡中具有较为明显的外部边缘。为了对危岩体的稳定性进行评价，传统方式是依靠人工接触式测量，其具有工作效率低、危险性大、且受地形条件及外业环境的限制较大的问题。显然，基于边坡三维模型的危岩体自动识别可以有效的解决这个问题，该技术可以提供从数据非接触式采集到危岩体自动识别的一整套解决方案，从而极大地提高危岩体勘察的效率。然而，由于危岩体的不规则形和判断标准不一致性等特点，目前基于边坡三维模型的危岩体自动识别研究颇为罕见。因此，针对以上不足，需要提供一种无人机高边坡危岩体智能识别方法。发明内容要解决的技术问题本发明要解决的技术问题是现有对危岩体的自动识别研究不足的问题。技术方案为了解决上述技术问题，本发明提供了一种无人机高边坡危岩体智能识别方法，包括以下步骤，Ⅰ.构建无人机航线，通过无人机飞行拍摄高边坡危岩体，从左到右、从上到下依次进行拍摄；Ⅱ.将无人机拍摄的相片导入计算机并获取危岩体的点云数据；Ⅲ.对点云数据进行预处理以降低数据量并平滑点云，然后利用种子点滤波算法或拟斜率滤波算法从去噪点云中提取地面点云；Ⅳ.采用聚类算法对各边界点云进行分类并对聚类后的点云进行三维重构生成DEM，通过筛选规则提取危岩体对象。作为对本发明的进一步说明，优选地，无人机的航线范围超出测量范围，无人机的飞行高度超过飞行区域最高障碍物。作为对本发明的进一步说明，优选地，无人机航向保持80%的重叠度，旁向保持50%的重叠度，相机角度选择45°。作为对本发明的进一步说明，优选地，通过Kd-tree进行拓扑结构构建，采用基于局部表面拟合方法进行离散点云数据的法向量和曲率计算，以直接通过点云模型获取点云的几何特征。作为对本发明的进一步说明，优选地，种子点滤波算法具体流程如下：①对整体构建三角网；②找到三角面片边长较大的三角网，遍历顶点，找到高程最大的顶点，标识为噪声点；③对三角网进行泛洪增长，其中找到点的周围邻接三角网，将不含噪声点的三角网标识为一簇，直到找到所有三角网簇；④最后移除噪声面片获得准确地面种子点。作为对本发明的进一步说明，优选地，将种子点云投影到种子点最低点对应的XY平面中，外扩种子点云的外包围盒形成缓冲区域，沿着缓冲区域均匀插值，获取每个插值点到种子点的最近邻点，将该点的高程值赋给插值点以确保所有点都位于TIN中，随后迭代以遍历所有的地物点。作为对本发明的进一步说明，优选地，每次迭代遍历所有的地物点，将满足条件的点作为地面种子点，一次性插入到上一步构建的TIN中，继续遍历剩下的地物点，根据新的TIN，计算迭代角度和迭代阈值，将满足条件的点作为新的地面种子点，重复上述构网过程和迭代过程，直到迭代次数超过阈值或没有新的地面点加入到种子点中为止，以使最后的种子点包含了所有的地面点。作为对本发明的进一步说明，优选地，拟斜率滤波算法具体流程如下：①翻转原始激光点云；②自定义基准面，该基准面可为水平面或竖直面或于点云分布基本平行的面，并在该基准面上选择一条基准线，该基准线为直线；③获取等距的部分点云投影到该基准面上，获取这些投影点与基准面之间的距离，同时获取这些点与基准线的距离；④通过计算选取点的优选正切值并记录，并与在先记录的正切值进行差值计算；⑤通过将各项差值导入图表中进行对比；⑥由计算机自动选取差值小以及正切值基本接近的点云，即可判断为地面点。作为对本发明的进一步说明，优选地，所述聚类算法具体方法如下：①从模型边界点中选取高程最高点，作为搜索起点，加入待检测点列表；②从待检测点列表中提取一个点，从该点出发通过k-邻域算法找出其邻域点云；③依次对比当前待检测点与邻域点云中每个点的高程，如果其差值满足给定阈值，则标记该邻域点，并将其加入待检测点列表；如果该邻域点已经被标记跳过该点；④不断重复第②、③步，直到所有待检测点都已经处理完成；⑤检查模型边界点中是否还有未标记的点，如果有，选取其高程最高点加入待检测点列表，重复②～④步，直到模型边界点都已经处理完成；⑥通过上述步骤，已标记区域均不属于危岩块体，而未标记点云区域则为危岩块体，然后利用聚类算法进行分类，确定属于各块体的点云。作为对本发明的进一步说明，优选地，在获得危岩体点云后，采用三维重建技术重构危岩体DEM模型，得出提取规则确定各危岩体。有益效果本发明的上述技术方案具有如下优点：本发明使用无人机采集研究区域的点云数据，通过新式的滤波算法以及聚类算法准确地获取将地面点和非地面点区分开，通过危岩体提取规则可进行危岩体识别工作。在获取危岩体后，可在此基础上进一步提取结构面等，对危岩体进行更为细致的研究，实现危岩体安全评价。附图说明图1是本发明的危岩体识别流程图；图2是本发明的Kd-tree拓扑结构二维和三维划分图；图3是本发明的点在二维平面的分布图；图4是本发明的点的树状结构图；图5是本发明的地面点以及噪点构成的三角网图；图6是本发明的添加缓冲区域后的三角网图；图7是本发明的实例验证对比图。具体实施方式为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。一种无人机高边坡危岩体智能识别方法，如图1所示，包括以下步骤：Ⅰ.到达场地后先勘查现场条件，确定测量范围，作好标记构建无人机航线，画航线时要超出测量范围。随后通过无人机从左到右、从上到下依次进行飞行拍摄高边坡危岩体，其中无人机航向保持80%的重叠度，旁向保持50%的重叠度，相机角度选择45°以将所测区域拍全，通过多拍带有相同局部特征的照片，在进行处理时将相同的区域进行人工或自动重叠，以尽可能弥补因镜头的畸变导致的图像变形。同时，飞行高度要超过飞行区域内最高的障碍物以免发生碰撞。Ⅱ.将无人机拍摄的相片导入Smart3D中的ContextCapture模块中，再用计算机中的Acute3D Viewer软件获取危岩体的点云数据。Ⅲ.通过Kd-tree进行拓扑结构构建，然后对点云数据进行预处理，即利用体素滤波降低数据量，利用双边滤波平滑点云，然后利用种子点滤波算法或拟斜率滤波从去噪点云中提取地面点云。Ⅳ. 采用聚类算法对各边界点云进行分类并对聚类后的点云进行三维重构生成DEM，通过筛选规则提取危岩体对象。针对相片的三维点云数据处理，需要在三个维度上建立点云数据之间的拓扑信息，即采用Kd-tree方式。如图2所示，为点云建立拓扑结构的二维和三维划分规则。如图3所示，假设在三维空间中存在a,b,c,d,e,f,g七个点，三个维度分别称作x维度、y维度、z维度，首先对x维度上七个点的坐标值进行排序，选出中值点为a，将该点作为根节点，通过点a将点云数据垂直划分为两个区域，在x维度上比点a的值小的点划分到左子树中，在x维度上比点a的值大的点划分到右子树中。假设最终b,e,f划分到左子树，c,d,g划分到右子树。再分别计算左右子树中，y维度的中值点，假设e是左子树在y维度上的中值点，d是右子树在y维度上的中值点。如图4所示，以此类推，分别计算所有子树中在z维度上的中值点，再沿着z维度进行划分，直到最后一个子树只有一个节点为止。对于离散点云数据的法向量和曲率计算，可采用基于局部表面拟合方法可直接通过点云模型获取点云的几何特征。本发明提供法向量检测的简单示例：对于点云模型中的任一点p，通过k-邻域搜索算法获取其邻域点，然后为这些点计算一个最小二乘意义上的局部平面，于是确定一点法向量的问题近似于估计拟合平面的一个相切法线的问题，即对顶点p的协方差矩阵进行主成分分析。协方差矩阵构建如下：一个点云数据集作为一个样本集，每个点看作一个样本。假设样本集为X，里面有N个样本，每个样本的维度为d。将这些样本组织成样本矩阵的形式，即每行为一个样本，每列为一个维度，得到样本矩阵S，然后将样本进行中心化，即保证每个维度的均值为零，让矩阵的每一列减去对应的均值。很多算法都会首先将样本进行中心化，以保证所有维度上的偏移都是以零为基点的。协方差矩阵可以简单的按照下列式子计算得到：这样协方差矩阵构建完成，根据协方差矩阵计算特征值和对应的特征向量，设分别为协方差矩阵C的第m个特征值及其对应的特征向量，则最小特征值对应的特征向量为法向量，该点的曲率可以由下式估算得出：高陡边坡数据量往往巨大，会导致整体算法的运行效率变低，在算法一开始可以采用体素化网格的方法实现下采样，又称体素滤波，即减少点云数据，并同时保存点云的形状特征。具体步骤是：通过输入的点云数据创建一个三维体素栅格，再用每个体素内所有点的重心来近似表示该体素以保留曲面形状以降低数据量。点云的平滑去噪，本发明采用了双边滤波方法，该算法首先为每个采样点建立k-邻域并估算法向量，然后以该点处的微切平面为视平面，设计一个双边滤波器。该方法在滤除点云噪声的同时，能够适度的平滑点云表面，并且在保持原始点云模型的边缘及其他特征信息上有突出优势，可以避免因过光顺而导致点云模型失真。在提取地面点方面，本发明采用种子点滤波法，先对双边滤波后的整体点云构建三角网，依据非地面点会形成较大狭长的三角形，对聚集的高噪声点而言，会形成小的、局部突出的高程面，因此可准确分离地面点和非地面点。具体流程如下：①对整体构建三角网；②找到三角面片边长较大的三角网，遍历顶点，找到高程最大的顶点，标识为噪声点；③对三角网进行泛洪增长，其中找到点的周围邻接三角网，将不含噪声点的三角网标识为一簇，如图5所示，直到找到所有三角网簇；④经过上述滤波过程，获取到的种子点更贴近实际地形，将这些地面点作为PTD算法的种子点，进行迭代渐进加密，最后移除噪声面片获得准确地面种子点。其中经过滤波后的种子点用来构建基初始的TIN，为了确保所有点都位于TIN中，如图6所示，需要构建缓冲区域。将种子点云投影到种子点最低点对应的XY平面中，外扩种子点云的外包围盒形成缓冲区域，沿着缓冲区域均匀插值，获取每个插值点到种子点的最近邻点，将该点的高程值赋给插值点。这样可以避免边界处三角网的丢失导致边界处的点无法进行迭代计算。与此同时，将边界处的插值点和边界种子点处在同一高程平面，可有效防止边界处坡度的急剧变化，无法将地面点加入到三角网中，然后就是三角网的迭代加密。传统的三角网的迭代加密是逐步插入的方式进行的，利用种子点构建原始的TIN，计算每个地物点在三角网中的位置、点到三角形的最大迭代角、点到三角平面的垂直距离，根据设定的阈值大小，判断该点是否为地面点。将单个点插入到上一步构建的TIN中，但是单个点的插入效率相对较低。本发明则是在每次迭代时，遍历所有的地物点，将满足条件的点作为地面种子点，一次性插入到上一步构建的TIN中。继续遍历剩下的地物点，根据新的TIN，计算迭代角度和迭代阈值，将满足条件的点作为新的地面种子点，重复上述构网过程和迭代过程，直到迭代次数超过阈值或没有新的地面点加入到种子点中为止。最后的种子点包含了所有的地面点。由于第一步格网化存在种子点插值的过程，在迭代渐进三角网插值前也有一个缓冲区插值的过程，但是插值点并不属于实际的地面，将这些点移除，最终获取的点为实际的地面点。为了评估种子点滤波算法的性能，本发明采用3个精度指标定量分析算法精度，其中包括Ⅰ类误差、Ⅱ类误差和总误差T.E，Ⅰ类误差反映算法保留地面点的性能，Ⅱ类误差反映算法去除非地面点的性能，总误差则整体反映算法的平衡性和实用性。三类误差的计算方式如下表所示：其中 a和d分别表示正确分类的地面点数和非地面点数，b和c分别表示错分的地面点数和非地面点）。f和g表示原始点云地面点和地物点的比例，h和i表示滤波后点云地面点和地物点的比例。如下表所示，本发明列举了本文算法和PTD算法对ISPRS提供15个样本三类误差的测试结果：该计算方式相比传统的计算方式计算步骤更为简洁，而且精度也有所提高。本发明还可采用拟斜率滤波算法进行地面点和非地面点的分离。拟斜率滤波算法通过自定义基准面和基准线，通过对点云在该基准面的投影距离和与基准线的距离，通过对比差值可获得地面点。该算法的具体流程如下：①翻转原始激光点云。②自定义基准面，该基准面可为水平面或竖直面或于点云分布基本平行的面。并在该基准面上选择一条基准线，该基准线为直线。③获取等距的部分点云投影到该基准面上，获取这些投影点与基准面之间的距离，同时获取这些点与基准线的距离。④通过计算选取点的三角函数值并记录，并与在先记录的三角函数值进行差值计算。⑤通过将各项差值导入图表中进行对比，趋近于0则说明点云之间基本处于同一平面，差值越大则说明与在先点云不在同一平面内。⑥由计算机自动选取差值小以及三角函数值基本接近的点云，即可判断为地面点。该方法区别地面点和非地面点，判断精度由选取的距离大小决定，其中距离越小获取的点云数量越多，则后期判断精度越高。本发明的拟斜率滤波算法，相比较为常用的布料拟合滤波算法，因只选等距的部分点进行计算，计算量更少，使得计算机处理速度更快。而且通过获取点云的斜率来近似判断平面，若单位范围内的点云正切值基本相同，即可判断该点云围成的范围为一整个平面，即使实际在该小范围内具有突出的石块，但是小范围突出的石块体积必然不大，则无需作为识别区域。因此利用该方法不仅计算量小，其准确度也能达到92%左右，后续为进一步提高计算机的判断精度，可调整判定的差值范围以及人为少量补足，即可能获得准确的地面点。获取完地面点后，本发明还提供一种新式的聚类算法，可直接从模型边界的高点出发进行填充，得到点云聚类结果，具体方法如下：①从模型边界点中选取高程最高点，作为搜索起点，加入待检测点列表；②从待检测点列表中提取一个点，从该点出发通过k-邻域算法找出其邻域点云；③依次对比当前待检测点与邻域点云中每个点的高程，如果其差值满足给定阈值，则标记该邻域点，并将其加入待检测点列表；如果该邻域点已经被标记跳过该点；④不断重复第②、③步，直到所有待检测点都已经处理完成；⑤检查模型边界点中是否还有未标记的点，如果有，选取其高程最高点加入待检测点列表，重复②～④步，直到模型边界点都已经处理完成；⑥通过上述步骤，已标记区域均不属于危岩块体，而未标记点云区域则为危岩块体，然后利用聚类算法进行分类，确定属于各块体的点云。在获得危岩体点云后，采用三维重建技术重构危岩体DEM模型，最后得出提取规则，进而确定各危岩体。通过以上方法，如图7所示，本发明实地勘测了某地的高边坡危岩体数据，对拍摄的相片和最终的计算结果图进行人工对比。通过对图7的各个块体进行分析，很明显计算的结果图和相片拍摄的图基本相同，相似度极高，说明该方法得到的计算结果和实际危岩体的结构数据相同，具有分析研究的价值。综上所述，本发明提出了一种基于无人机的高边坡危岩体识别方法。该方法利用无人机机动性高，操作方便，使用成本低，并且不受地形限制，十分适合于高陡边坡的危险源勘测工作的优点，以获取边坡点云数据，通过特征计算精确提取孤立危岩。然后以无人机采集研究区域点云数据，通过计算点云的法向量和曲率特征，根据边缘指标结合曲率极值提取点云边界点，然后采用新式的聚类算法形成待分类危岩体对象，然后生成DEM后，从DEM提取待分类对象的后壁面积、后壁倾角以及最大高差，通过危岩体提取规则可进行危岩体识别工作。在获取危岩体后，可在此基础上进一步提取结构面等，对危岩体进行更为细致的研究，实现危岩体安全评价。最后应说明的是：以上实施例仅用以说明本发明的技术方案，而非对其限制；尽管参照前述实施例对本发明进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明各实施例技术方案的精神和范围。
