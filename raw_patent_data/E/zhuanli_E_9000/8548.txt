标题title
用于时序管理的井下UWB定位方法、设备及存储介质
摘要abst
本申请公开了一种用于时序管理的井下UWB定位方法、设备及存储介质。该方法包括：UWB定位标签基于定位周期和定位频率，广播测距请求消息；接收UWB定位基站返回的测距应答消息，测距应答消息基于UWB定位基站自身的时钟和时间槽占用状态轮盘生成，且测距应答消息至少包括：指示与UWB定位标签的冲突状态的第一信息和指示定位周期内各时间槽的占用状态的第二信息；基于接收的测距应答消息，广播响应消息；其中，定位周期被划分为N个时间槽，N为大于1的整数，时间槽占用状态轮盘对应N个时间槽。如此，可以在井下定位场景下，可以基于时间槽占用状态轮盘实现UWB定位时序管理，有效规避测距失效，进而提高UWB定位测距的可靠性。
权利要求书clms
1.一种用于时序管理的井下超带宽UWB定位方法，其特征在于，应用于UWB定位标签，所述方法包括：基于定位周期和定位频率，广播测距请求消息；接收UWB定位基站返回的测距应答消息，所述测距应答消息基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成，且所述测距应答消息至少包括：指示与所述UWB定位标签的冲突状态的第一信息和指示所述定位周期内各时间槽的占用状态的第二信息；基于接收的所述测距应答消息，广播响应消息；其中，所述定位周期被划分为N个时间槽，N为大于1的整数，所述时间槽占用状态轮盘对应所述N个时间槽。2.根据权利要求1所述的方法，其特征在于，所述基于接收的所述测距应答消息，广播响应消息，包括：若确定接收的各所述测距应答消息的第一信息均为不冲突状态且第二信息中首个时间槽的占用状态均相同，则广播测距最终消息；或者，若确定接收的各所述测距应答消息中的至少一个第一信息为冲突状态，和/或至少两个第二信息中首个时间槽的占用状态不相同，则终止当前测距，并重新广播测距请求消息。3.根据权利要求2所述的方法，其特征在于，所述重新广播测距请求消息，包括：依次遍历接收的各测距应答消息的第二信息，直至确定出所有第二信息中时间槽的占用状态均为当前定位周期内未被占用状态对应的时间槽序号；基于确定出的时间槽序号确定重新广播测距请求消息的校准时间；在所述校准时间广播测距请求消息。4.根据权利要求3所述的方法，其特征在于，所述方法还包括：基于各测距应答消息的第二信息计算相应的UWB定位基站的时间槽占用率；基于最大的所述时间槽占用率调整所述UWB定位标签的所述定位频率；其中，所述时间槽占用率为当前定位周期内未被占用状态的时间槽的数量与N的比值，重新广播的所述测距请求消息携带调整后的所述定位频率。5.一种用于时序管理的井下UWB定位方法，其特征在于，应用于UWB定位基站，所述方法包括：接收来自UWB定位标签的测距请求消息；针对所述测距请求消息，基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成测距应答消息，且所述测距应答消息至少包括：指示与所述UWB定位标签的冲突状态的第一信息和指示定位周期内各时间槽的占用状态的第二信息；发送所述测距应答消息给所述UWB定位标签；其中，所述定位周期被划分为N个时间槽，N为大于1的整数，所述时间槽占用状态轮盘对应所述N个时间槽。6.根据权利要求5所述的方法，其特征在于，所述方法还包括：构建所述时间槽占用状态轮盘；其中，所述时间槽占用状态轮盘包括与所述N个时间槽对应的占用状态标识位，各所述占用状态标识位标识相应的所述时间槽的占用状态码。7.根据权利要求6所述的方法，所述基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成测距应答消息，包括：基于所述UWB定位基站自身的时钟，以当前时间指向的时间槽为起点，将所述时间槽占用状态轮盘序列化为时间槽占用状态数组；基于所述时间槽占用状态数组中元素值得到所述第一信息和所述第二信息；所述方法还包括：每间隔所述定位周期，更新所述时间槽占用状态轮盘。8.一种UWB定位标签，其特征在于，包括：处理器和用于存储能够在处理器上运行的计算机程序的存储器，其中，所述处理器，用于运行计算机程序时，执行权利要求1至4任一项所述方法的步骤。9.一种UWB定位基站，其特征在于，包括：处理器和用于存储能够在处理器上运行的计算机程序的存储器，其中，所述处理器，用于运行计算机程序时，执行权利要求5至7任一项所述方法的步骤。10.一种存储介质，所述存储介质上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时，实现权利要求1至7任一项所述方法的步骤。
说明书desc
技术领域本申请涉及井下定位领域，尤其涉及一种用于时序管理的井下UWB定位方法、设备及存储介质。背景技术矿山井下开采有一定的危险性，开采需要在井下布置大量的设备、车辆、人员，各种自然或人为因素造成的灾害、事故对井下工作人员的人身安全造成了极大的威胁。对井下人员、车辆有效的组织管理，以及事故、灾害的救援都需要掌握井下人员、车辆、设备的精确位置数据，井下设备的远程控制、智能控制更离不开井下设备的实时精确位置数据。精确定位技术已成为矿井安全生产的重要技术支撑，相关技术中，往往基于UWB定位技术实现井下精确定位，在井下每隔一定距离布置UWB定位基站，人员、车辆或设备携带UWB定位标签，UWB定位基站与UWB定位标签之间通过测量脉冲信号的飞行时间，精确计算UWB定位标签到UWB定位基站之间的距离。由于UWB定位基站的坐标是已知的，根据UWB定位标签与多个UWB定位基站之间的精确距离，可精确计算出UWB定位标签的坐标。由于井下UWB定位标签通常多于1个，若多个UWB定位标签不进行时序管理，则极易发生冲突，即若多个UWB定位标签的请求报文同时到达某个基站，基站在一个测距周期内仅能有效答复一个请求，从而导致其他UWB定位标签测距失败。此外，由于UWB定位标签是按固定时间周期循环发出请求报文的，故严重时将导致部分UWB定位标签测距一直失败。相关技术中，往往通过主UWB定位基站对各UWB定位标签进行轮询调度，即主UWB定位基站按时序轮询各个UWB定位标签，轮询到的UWB定位标签才可以广播请求报文，从而避免冲突。然而，该方法要求所有UWB定位标签一直处于接收状态，等待主UWB定位基站轮询，UWB定位标签持续处于接收状态时功耗较大，而井下UWB定位标签一般是电池供电，无法满足井下UWB定位标签待机时长的要求。发明内容有鉴于此，本申请实施例提供了一种用于时序管理的井下UWB定位方法、设备及存储介质，旨在实现UWB定位时序管理，提高定位可靠性。本申请实施例的技术方案是这样实现的：第一方面，本申请实施例提供了一种用于时序管理的井下UWB定位方法，应用于UWB定位标签，该方法包括：基于定位周期和定位频率，广播测距请求消息；接收UWB定位基站返回的测距应答消息，所述测距应答消息基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成，且所述测距应答消息至少包括：指示与所述UWB定位标签的冲突状态的第一信息和指示所述定位周期内各时间槽的占用状态的第二信息；基于接收的所述测距应答消息，广播响应消息；其中，所述定位周期被划分为N个时间槽，N为大于1的整数，所述时间槽占用状态轮盘对应所述N个时间槽。在一些实施例中，所述基于接收的所述测距应答消息，广播响应消息，包括：若确定接收的各所述测距应答消息的第一信息均为不冲突状态且第二信息中首个时间槽的占用状态均相同，则广播测距最终消息；或者，若确定接收的各所述测距应答消息中的至少一个第一信息为冲突状态，和/或至少两个第二信息中首个时间槽的占用状态不相同，则终止当前测距，并重新广播测距请求消息。在一些实施例中，所述重新广播测距请求消息，包括：依次遍历接收的各测距应答消息的第二信息，直至确定出所有第二信息中时间槽的占用状态均为当前定位周期内未被占用状态对应的时间槽序号；基于确定出的时间槽序号确定重新广播测距请求消息的校准时间；在所述校准时间广播测距请求消息。在一些实施例中，所述方法还包括：基于各测距应答消息的第二信息计算相应的UWB定位基站的时间槽占用率；基于最大的所述时间槽占用率调整所述UWB定位标签的所述定位频率；其中，所述时间槽占用率为当前定位周期内未被占用状态的时间槽的数量与N的比值，重新广播的所述测距请求消息携带调整后的所述定位频率。第二方面，本申请实施例提供了一种用于时序管理的井下UWB定位方法，应用于UWB定位基站，所述方法包括：接收来自UWB定位标签的测距请求消息；针对所述测距请求消息，基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成测距应答消息，且所述测距应答消息至少包括：指示与所述UWB定位标签的冲突状态的第一信息和指示定位周期内各时间槽的占用状态的第二信息；发送所述测距应答消息给所述UWB定位标签；其中，所述定位周期被划分为N个时间槽，N为大于1的整数，所述时间槽占用状态轮盘对应所述N个时间槽。在一些实施例中，所述方法还包括：构建所述时间槽占用状态轮盘；其中，所述时间槽占用状态轮盘包括与所述N个时间槽对应的占用状态标识位，各所述占用状态标识位标识相应的所述时间槽的占用状态码。在一些实施例中，所述基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成测距应答消息，包括：基于所述UWB定位基站自身的时钟，以当前时间指向的时间槽为起点，将所述时间槽占用状态轮盘序列化为时间槽占用状态数组；基于所述时间槽占用状态数组中元素值得到所述第一信息和所述第二信息；所述方法还包括：每间隔所述定位周期，更新所述时间槽占用状态轮盘。第三方面，本申请实施例提供了一种UWB定位标签，包括：处理器和用于存储能够在处理器上运行的计算机程序的存储器，其中，所述处理器，用于运行计算机程序时，执行本申请实施例第一方面所述方法的步骤。第四方面，本申请实施例提供了一种UWB定位基站，包括：处理器和用于存储能够在处理器上运行的计算机程序的存储器，其中，所述处理器，用于运行计算机程序时，执行本申请实施例第二方面所述方法的步骤。第五方面，本申请实施例提供了一种存储介质，所述存储介质上存储有计算机程序，所述计算机程序被处理器执行时，实现本申请实施例第一方面或者第二方面所述方法的步骤。本申请实施例提供的技术方案，UWB定位标签基于定位周期和定位频率，广播测距请求消息；接收UWB定位基站返回的测距应答消息，测距应答消息基于UWB定位基站自身的时钟和时间槽占用状态轮盘生成，且测距应答消息至少包括：指示与UWB定位标签的冲突状态的第一信息和指示定位周期内各时间槽的占用状态的第二信息；基于接收的测距应答消息，广播响应消息；其中，定位周期被划分为N个时间槽，N为大于1的整数，时间槽占用状态轮盘对应N个时间槽。如此，可以在井下定位场景下，可以基于时间槽占用状态轮盘实现UWB定位时序管理，有效规避测距失效，进而提高UWB定位测距的可靠性。附图说明图1为本申请实施例UWB定位标签侧的井下UWB定位方法的流程示意图；图2为本申请实施例UWB定位基站侧的井下UWB定位方法的流程示意图；图3为本申请一应用示例初始状态UWB定位基站的时间槽占用状态轮盘示意图；图4为本申请一应用示例UWB定位基站1的时间槽占用状态轮盘示意图；图5为图4所示的时间槽占用状态轮盘的时间槽占用状态数组示意图；图6为本申请一应用示例UWB定位基站2的时间槽占用状态轮盘示意图；图7为图6所示的时间槽占用状态轮盘的时间槽占用状态数组示意图；图8为本申请实施例井下UWB定位基站的结构示意图。具体实施方式下面结合附图及实施例对本申请再作进一步详细的描述。除非另有定义，本文所使用的所有的技术和科学术语与属于本申请的技术领域的技术人员通常理解的含义相同。本文中在本申请的说明书中所使用的术语只是为了描述具体的实施例的目的，不是旨在于限制本申请。相关技术中，为了降低UWB定位标签待机功耗，可以基于主UWB定位基站对UWB定位标签进行请求时间校准的时序管理方法，由于各UWB定位基站和各UWB定位标签的时钟均无法完全同步，选取任意UWB定位基站为主UWB定位基站，以主UWB定位基站的时钟为基准时钟，系统初始化时按主UWB定位基站的基准时钟为所有UWB定位标签分配固定的时间槽，各UWB定位只能在对应的时间槽范围内广播请求消息，且各时间槽均预留一定的保护时隙，用于向接收到的非应在该时隙发送请求消息的UWB定位标签回复冲突状态和校准下一次应发送请求消息的时间。基于主UWB定位基站对UWB定位标签进行请求时间校准的时序管理方法前提是，UWB定位场景中存在能接收到所有UWB定位标签的主UWB定位基站，故该方法仅适用于有限空间范围内的定位，不适用于井下大规模范围的定位。相关技术中，还可以通过时间同步器将所有UWB定位基站的时钟进行同步，以解决基于主UWB定位基站对UWB定位标签进行请求时间校准的时序管理方法不适用于井下大规模范围定位的问题，即场景中所有UWB定位基站的时钟均同步后，任意UWB定位基站均可以对UWB定位标签请求时间进行校准，但使用时间同步器会使系统建设和维护成本大幅增加，不具备经济性。基于此，本申请实施例提供了一种井下UWB定位方法，考虑到携带UWB定位标签的对象活动范围受限的特点，即仅能在井下巷道近似一维的空间范围内活动，使得井下UWB定位场景具有UWB定位标签数量大、局部聚集程度低的特征，其可以在无需使用时间同步器对所有UWB定位基站的时钟进行同步的基础上，实现UWB定位时序管理，满足系统的经济性要求。本申请实施例中，提供了一种用于时序管理的井下UWB定位方法，应用于UWB定位标签，如图1所示，该方法包括：步骤101，基于定位周期和定位频率，广播测距请求消息。这里，任意的UWB定位标签可以在进入井下定位系统后从任意时刻开始，基于初始的定位周期和定位频率，广播测距请求消息。举例来说，测距请求消息可以为测距请求报文，定位周期对应时间槽占用状态轮盘的总时长，假定定位周期为∆T，定位频率为单位时长内定位测距的频率，假定定位频率为f，UWB定位标签可以每间隔∆T/f广播一次测距请求报文。示例性地，测距请求报文的负载内容数据结构如下表1所示：表1名称占用大小备注请求报文流水号1字节定位频率1字节默认为1即测距请求报文可以携带请求报文流水号和定位频率。步骤102，接收UWB定位基站返回的测距应答消息，所述测距应答消息基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成，且所述测距应答消息至少包括：指示与所述UWB定位标签的冲突状态的第一信息和指示所述定位周期内各时间槽的占用状态的第二信息。需要说明的是，各UWB定位基站预先构建有时间槽占用状态轮盘。时间槽占用状态轮盘的周期为前述的定位周期∆T，将时间槽占用状态轮盘划分为个N个时间槽，N为大于1的整数，各时间槽的时长应满足1个UWB定位标签完成1次测距的时间要求。这里，UWB定位基站在接收到测距请求报文后，可以根据自身的时钟，将当前时间指向时间槽占用状态轮盘中相应的时间槽，并以该时间槽为起点，将时间槽占用状态轮盘序列化为时间槽占用状态数组，进而根据该时间槽占用状态数组生成测距应答消息，并返回测距应答消息给UWB定位标签。示例性地，测距应答消息可以为测距应答报文，该测距应答报文的负载内容数据结构如下表2所示：表2名称占用大小备注应答报文流水号1字节冲突状态码1比特位0-未冲突；1-冲突时间槽占用状态数组N/4个字节在一应用示例中，时间槽占用状态轮盘中各时间槽占2比特位，故时间槽占用状态轮盘采用N/4个字节表示，其中，各时间槽的占用状态码包括“0”、“1”、“2”和“3”，各占用状态码的含义为：“0”表示该时间槽未被占用，“1”表示该时间槽在本定位周期内被占用，“2”表示该时间槽在∆T时间之前的定位周期内被占用，“3”表示该时间槽在2∆T时间之前的定位周期内被占用。需要说明的是，此处仅为举例，在其他示例中，占用状态码还可以包括更多的定位周期内是否被占用的状态，相应地，各时间槽可以采用更多的比特位来表示，本申请实施例对此不做限定。可以理解的是，前述的第一消息即表2中的冲突状态码，前述的第二消息即表2中的时间槽占用状态数组。下面对冲突状态码的生成机制说明如下：、当时间槽占用状态数组的第1个元素的占用状态码为“0”时，将该占用状态码赋值为“1”，冲突状态码为“0”；、当时间槽占用状态数组的第1个元素的占用状态码为“1”时，冲突状态码为“1”；、当时间槽占用状态数组的第1个元素的占用状态码为“2”或“3”时，冲突状态码为“0”。需要说明的是，上述第1元素对应UWB定位基站的前时间指向的时间槽。步骤103，基于接收的所述测距应答消息，广播响应消息。这里，UWB定位标签可以基于UWB定位基站返回的测距应答消息，判断是否存在时隙冲突，从而根据是否存在时隙冲突的结果来广播响应消息，可以在井下定位场景下，可以基于时间槽占用状态轮盘实现UWB定位时序管理，有效规避测距失效，进而提高UWB定位测距的可靠性。在一些实施例中，所述基于接收的所述测距应答消息，广播响应消息，包括：若确定接收的各所述测距应答消息的第一信息均为不冲突状态且第二信息中首个时间槽的占用状态均相同，则广播测距最终消息；或者，若确定接收的各所述测距应答消息中的至少一个第一信息为冲突状态，和/或至少两个第二信息中首个时间槽的占用状态不相同，则终止当前测距，并重新广播测距请求消息。需要说明的是，UWB定位标签若确定接收的各所述测距应答消息中的至少一个第一信息为冲突状态，和/或至少两个第二信息中首个时间槽的占用状态不相同，则判定存在时隙冲突，不回复该测距应答消息，本次测距终止，并重新广播测距请求消息。在一些实施例中，所述重新广播测距请求消息，包括：依次遍历接收的各测距应答消息的第二信息，直至确定出所有第二信息中时间槽的占用状态均为当前定位周期内未被占用状态对应的时间槽序号；基于确定出的时间槽序号确定重新广播测距请求消息的校准时间；在所述校准时间广播测距请求消息。示例性地，UWB定位标签在当前接收到的测距应答报文中，依次向后遍历时间槽占用状态数组后面的各元素，至第一次出现各个UWB定位基站回复的测距应答报文中的时间槽占用状态数组的元素值均为“0”，设此元素在数组中的序号为j，则将该UWB定位标签下一次广播测距请求报文的时间校准为*∆T /N之后。在一些实施例中，所述方法还包括：基于各测距应答消息的第二信息计算相应的UWB定位基站的时间槽占用率；基于最大的所述时间槽占用率调整所述UWB定位标签的所述定位频率；其中，所述时间槽占用率为当前定位周期内未被占用状态的时间槽的数量与N的比值，重新广播的所述测距请求消息携带调整后的所述定位频率。需要说明的是，现有的UWB定位标签的定位频率是固定不变的，本申请实施例可以结合结合局部场景的聚集程度对UWB定位标签进行自动变频，例如，在UWB定位标签聚集程度较低时，适时提高定位频率，并当聚集程度提高时再自动降低定位频率，如此，能够智能化地调节定位频率，动态地满足UWB定位性能要求。在一应用示例中，假定UWB定位标签接收到M个UWB定位基站回复的测距应答报文后，其处理逻辑如下：、计算M个UWB定位基站的时间槽占用率，即占用状态码为“0”的时间槽数量与N的比值，并选出占用率最大值，设为Ψmax，进而自动调整该UWB定位标签的定位频率为int，其中，int为向下取整函数；当M个UWB定位基站回复的测距应答报文中不含冲突状态为“1”的应答报文，且M个UWB定位基站回复的测距应答报文中的时间槽占用状态数组的第1个值相同，则该UWB定位标签广播测距最终报文，该测距最终报文用于实现UWB测距。示例性地，测距最终报文的负载内容数据结构如下表3所示：表3名称占用大小备注最终报文流水号1字节请求报文广播时间4字节应该基站数目1字节第1个基站ID4字节第1个基站应答报文接收时间4字节第2个基站ID4字节第2个基站应答报文接收时间4字节…4字节第M个基站ID4字节第M个基站应答报文接收时间4字节最终报文广播时间4字节否则，则该UWB定位标签不回复该应答报文，本次测距终止，并依次向后遍历各个UWB定位基站回复的应答报文中的时间槽占用状态数组，至第一次出现各个UWB定位基站回复的应答报文中的时间槽占用状态数组的元素值均为“0”，设此元素在数组中的序号为j，则将该UWB定位标签下一次广播测距请求报文的时间校准为*∆T/N之后。需要说明的是，每隔∆T时间，各UWB定位基站还需对自身的时间槽占用状态轮盘进行更新。示例性地，更新的逻辑如下：当时间槽的占用状态码为“0”时，不更新；当时间槽的占用状态码为“1”时，将该状态码赋值为“2”；当时间槽的占用状态码为“2”时，将该状态码赋值为“3”；当时间槽的占用状态码为“3”时，将该状态码赋值为“0”。本申请实施例还提供了一种用于时序管理的井下UWB定位方法，应用于UWB定位基站，如图2所示，该定位方法包括：步骤201，接收来自UWB定位标签的测距请求消息。这里，UWB定位基站接收UWB定位标签广播的测距请求消息。例如，UWB定位基站可以接收UWB定位标签每间隔∆T/f广播的测距请求报文。步骤202，针对所述测距请求消息，基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成测距应答消息，且所述测距应答消息至少包括：指示与所述UWB定位标签的冲突状态的第一信息和指示定位周期内各时间槽的占用状态的第二信息。这里，UWB定位基站在接收到测距请求报文后，可以根据自身的时钟，将当前时间指向时间槽占用状态轮盘中相应的时间槽，并以该时间槽为起点，将时间槽占用状态轮盘序列化为时间槽占用状态数组，进而根据该时间槽占用状态数组生成测距应答消息，并返回测距应答消息给UWB定位标签。示例性地，所述基于所述UWB定位基站自身的时钟和时间槽占用状态轮盘生成测距应答消息，包括：基于所述UWB定位基站自身的时钟，以当前时间指向的时间槽为起点，将所述时间槽占用状态轮盘序列化为时间槽占用状态数组；基于所述时间槽占用状态数组中元素值得到所述第一信息和所述第二信息。在一应用示例中，时间槽占用状态轮盘中各时间槽占2比特位，故时间槽占用状态轮盘采用N/4个字节表示，其中，各时间槽的占用状态码包括“0”、“1”、“2”和“3”，各占用状态码的含义为：“0”表示该时间槽未被占用，“1”表示该时间槽在本定位周期内被占用，“2”表示该时间槽在∆T时间之前的定位周期内被占用，“3”表示该时间槽在2∆T时间之前的定位周期内被占用。需要说明的是，此处仅为举例，在其他示例中，占用状态码还可以包括更多的定位周期内是否被占用的状态，相应地，各时间槽可以采用更多的比特位来表示，本申请实施例对此不做限定。可以理解的是，前述的第一消息即表2中的冲突状态码，前述的第二消息即表2中的时间槽占用状态数组。步骤203，发送所述测距应答消息给所述UWB定位标签。这里，UWB定位标签接收到来自UWB定位基站的测距应答消息后，可以基于接收的所述测距应答消息，广播响应消息，具体可以参照前述步骤103的相关描述，在此不再赘述。在一些实施例中，该定位方法还包括：构建所述时间槽占用状态轮盘。可以理解的是，各UWB定位基站预先构建有时间槽占用状态轮盘。时间槽占用状态轮盘的周期为前述的定位周期∆T，将时间槽占用状态轮盘划分为个N个时间槽，N为大于1的整数，各时间槽的时长应满足1个UWB定位标签完成1次测距的时间要求。在一些实施例中，UWB定位基站每间隔所述定位周期，更新所述时间槽占用状态轮盘。下面结合一应用示例，对本申请实施例的井下UWB定位方法进行示例性说明：本应用示例针对某井下矿山，采用UWB进行人员高精度定位，为各UWB定位基站构建对应的时间槽占用状态轮盘，时间槽占用状态轮盘的定位周期为1s，将时间槽占用状态轮盘划分为64个时间槽，各时间槽的时长满足1个UWB定位标签完成1次测距的时间要求。初始状态UWB定位基站的时间槽占用状态轮盘如图3所示。T1时刻，UWB定位标签1广播测距请求报文，UWB定位基站1、2、3和4接收到测距请求报文后，根据UWB定位基站自身的时钟，将当前时间指向时间槽占用状态轮盘中相应的时间槽，并以该时间槽为起点，将时间槽占用状态轮盘序列化为时间槽占用状态数组如图4至图7所示，以UWB定位基站1和2为例，图4示出了UWB定位基站1的时间槽占用状态轮盘示意图；图5示出了图4所示的时间槽占用状态轮盘的时间槽占用状态数组示意图；图6示出了UWB定位基站2的时间槽占用状态轮盘示意图；图7示出了图6所示的时间槽占用状态轮盘的时间槽占用状态数组示意图。UWB定位标签接收到4个UWB定位基站回复的应答报文后，计算4个UWB定位基站的时间槽占用率，并选出占用率最大值为0.281，进而自动调整该UWB定位标签的定位频率为3。由于4个UWB定位基站回复的应答报文中含冲突状态为“1”的应答报文，该UWB定位标签本次测距终止，依次向后遍历各个UWB定位基站回复的应答报文中的时间槽占用状态数组，至第1次出现各个UWB定位基站回复的应答报文中的时间槽占用状态数组的元素值均为“0”，此元素在数组中的序号为2，则将该UWB定位标签下一次广播测距请求报文的时间校准为15.6ms之后。1s后，各UWB定位基站对自身的时间槽占用状态轮盘进行更新的逻辑如下：当时间槽的占用状态码为“0”时，不更新；当时间槽的占用状态码为“1”时，将该状态码赋值为“2”；当时间槽的占用状态码为“2”时，将该状态码赋值为“3”；当时间槽的占用状态码为“3”时，将该状态码赋值为“0”。需要说明的是，本应用示例的井下UWB定位方法，实现适用于UWB定位标签运行功耗低、定位场景分布范围广，无具备条件的主UWB定位基站、UWB定位标签数量大、局部聚集程度低等特征的井下UWB定位场景，且可结合局部场景的聚集程度对UWB定位标签进行自动变频，适时提高定位频率，此外，无需使用时间同步器对所有UWB定位基站的时钟进行同步，满足系统的经济性要求。为了实现本申请实施例的方法，本申请实施例还提供一种UWB定位标签。该UWB定位标签，包括：处理器和用于存储能够在处理器上运行的计算机程序的存储器，其中，所述处理器，用于运行计算机程序时，执行本申请实施例UWB定位标签侧的UWB定位方法的步骤。为了实现本申请实施例的方法，本申请实施例还提供一种UWB定位基站。图8仅仅示出了该UWB定位标签的示例性结构而非全部结构，根据需要可以实施图8示出的部分结构或全部结构。如图8所示，本申请实施例提供的井下UWB定位基站800包括：至少一个处理器801、存储器802、用户接口803和至少一个网络接口804。井下UWB定位基站800中的各个组件通过总线系统805耦合在一起。可以理解，总线系统805用于实现这些组件之间的连接通信。总线系统805除包括数据总线之外，还包括电源总线、控制总线和状态信号总线。但是为了清楚说明起见，在图8中将各种总线都标为总线系统805。其中，用户接口803可以包括显示器、键盘、鼠标、轨迹球、点击轮、按键、按钮、触感板或者触摸屏等。本申请实施例中的存储器802用于存储各种类型的数据以支持井下UWB定位基站的操作。这些数据的示例包括：用于在井下UWB定位基站上操作的任何计算机程序。本申请实施例揭示的井下高精度定位方法可以应用于处理器801中，或者由处理器801实现。处理器801可能是一种集成电路芯片，具有信号的处理能力。在实现过程中，井下高精度定位方法的各步骤可以通过处理器801中的硬件的集成逻辑电路或者软件形式的指令完成。上述的处理器801可以是通用处理器、数字信号处理器，或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件等。处理器801可以实现或者执行本申请实施例中的公开的各方法、步骤及逻辑框图。通用处理器可以是微处理器或者任何常规的处理器等。结合本申请实施例所公开的方法的步骤，可以直接体现为硬件译码处理器执行完成，或者用译码处理器中的硬件及软件模块组合执行完成。软件模块可以位于存储介质中，该存储介质位于存储器802，处理器801读取存储器802中的信息，结合其硬件完成本申请实施例提供的井下高精度定位方法的步骤。在示例性实施例中，井下UWB定位基站可以被一个或多个应用专用集成电路、DSP、可编程逻辑器件、复杂可编程逻辑器件、FPGA、通用处理器、控制器、微控制器、微处理器、或者其他电子元件实现，用于执行前述方法。可以理解，存储器802可以是易失性存储器或非易失性存储器，也可包括易失性和非易失性存储器两者。其中，非易失性存储器可以是只读存储器、可编程只读存储器、可擦除可编程只读存储器、电可擦除可编程只读存储器、磁性随机存取存储器、快闪存储器、磁表面存储器、光盘、或只读光盘；磁表面存储器可以是磁盘存储器或磁带存储器。易失性存储器可以是随机存取存储器，其用作外部高速缓存。通过示例性但不是限制性说明，许多形式的RAM可用，例如静态随机存取存储器、同步静态随机存取存储器、动态随机存取存储器、同步动态随机存取存储器、双倍数据速率同步动态随机存取存储器、增强型同步动态随机存取存储器、同步连接动态随机存取存储器、直接内存总线随机存取存储器。本申请实施例描述的存储器旨在包括但不限于这些和任意其它适合类型的存储器。在示例性实施例中，本申请实施例还提供了一种UWB定位系统，包括多个前述的UWB定位基站和多个前述的UWB定位标签，具体地的UWB定位方法，可以参照前述描述，在此不再赘述。在示例性实施例中，本申请实施例还提供了一种存储介质，即计算机存储介质，具体可以是计算机可读存储介质，例如包括存储计算机程序的存储器，上述计算机程序可由处理器执行，以完成本申请实施例方法所述的步骤。计算机可读存储介质可以是ROM、PROM、EPROM、EEPROM、Flash Memory、磁表面存储器、光盘、或CD-ROM等存储器。需要说明的是：“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。另外，本申请实施例所记载的技术方案之间，在不冲突的情况下，可以任意组合。以上所述，仅为本申请的具体实施方式，但本申请的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本申请披露的技术范围内，可轻易想到变化或替换，都应涵盖在本申请的保护范围之内。因此，本申请的保护范围应以权利要求的保护范围为准。
