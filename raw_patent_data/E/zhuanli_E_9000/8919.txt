标题title
一种电机扭力调节方法、智能门锁及计算机可读存储介质
摘要abst
本发明公开了一种电机扭力调节方法、智能门锁及计算机可读存储介质，所述方法包括：当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位；驱动电机运行，检测智能门锁的锁舌状态，当检测到锁舌状态未到位时，将电机扭力参数上调一个档位；当检测到锁舌状态到位时，增加检测次数，并判断检测次数是否达到预设门限值；当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力。本发明通过开关门方式触发智能门锁进行自动适应调节电机扭力参数，使得智能门锁工作在最优电机扭力参数档位下，从而节约功耗延长智能门锁的使用寿命。
权利要求书clms
1.一种电机扭力调节方法，其特征在于，所述电机扭力调节方法包括：当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位；驱动电机运行，检测智能门锁的锁舌状态，当检测到锁舌状态未到位时，将电机扭力参数上调一个档位；当检测到锁舌状态到位时，增加检测次数，并判断检测次数是否达到预设门限值；当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力。2.根据权利要求1所述的电机扭力调节方法，其特征在于，所述当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位，具体包括：当首次检测开门或者关门动作时，判断电机扭力参数是否为空；当检测到电机扭力参数为空时，将电机扭力参数设置为预设档位。3.根据权利要求2所述的电机扭力调节方法，其特征在于，所述判断电机扭力参数是否为空，之后还包括：当检测到电机扭力参数不为空时，根据预先设置的电机扭力参数调整电机扭力。4.根据权利要求1所述的电机扭力调节方法，其特征在于，所述判断测试次数是否达到预设门限值，之后还包括：当检测次数未达到预设门限值时，判断所述智能门锁当前结束的动作是否为开门动作。5.根据权利要求4所述的电机扭力调节方法，其特征在于，所述判断门锁当前结束的动作是否为开门动作，之后还包括：当判断出所述智能门锁当前结束的动作是开门动作时，则控制电机执行关门动作，并继续驱动电机运行，直到检测次数达到预设门限值。6.根据权利要求4所述的电机扭力调节方法，其特征在于，所述判断门锁当前结束的动作是否为开门动作，之后还包括：当判断出所述智能门锁当前结束的动作是关门动作时，则控制电机执行开门动作，并继续驱动电机运行，直到检测次数达到预设门限值。7.根据权利要求1所述的电机扭力调节方法，其特征在于，所述检测锁舌状态具体为检测锁舌传感器反馈的值。8.根据权利要求1所述的电机扭力调节方法，其特征在于，所述预设门限值的范围为5-10次。9.一种智能门锁，其特征在于，所述智能门锁包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的电机扭力调节程序，所述电机扭力调节程序被所述处理器执行时实现如权利要求1-8任一项所述的电机扭力调节方法的步骤。10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质存储有电机扭力调节程序，所述电机扭力调节程序被处理器执行时实现如权利要求1-8任一项所述的电机扭力调节方法的步骤。
说明书desc
技术领域本发明涉及智能门锁技术领域，尤其涉及一种电机扭力调节方法、智能门锁及计算机可读存储介质。背景技术智能门锁是指区别于传统机械锁的基础上改进的，在用户安全性、识别、管理性方面更加智能化简便化的锁具。智能门锁是门禁系统中锁门的执行部件。智能门锁区别于传统机械锁，是具有安全性、便利性、先进技术的复合型锁具。在智能门锁领域，电机是一个重要的核心部件，也是连接电子和机械部件的桥梁纽带，对于全自动门锁尤其重要。而电机扭力的大小也直接影响到了门锁的使用和安装，扭力过大，则功耗和寿命都会受到影响，扭力过小，则可能不足以保证正常开锁。现有技术中，为了保证智能门锁的开关锁正常，经过多次实验评估给出一个固定的扭力参数，可以确保符合大多数智能门锁的情况，但是缺点是功耗相对大，对一些门框适应性差，如果摩擦力较大时，可能导致电机扭力不足而无法开门；或者，在智能门锁的系统中增加入口菜单，工程安装维修时，可以进行扭力参数设置，但是缺点时需要工程人员在安装时，根据实际情况进行手动设置调整，参数是否合适全凭工程人员确定，可能不是最优参数，同时也对安装工提出了更高的能力要求。因此，现有技术还有待于改进和发展。发明内容本发明的主要目的在于提供一种电机扭力调节方法、智能门锁及计算机可读存储介质，旨在解决现有技术中无法自动将智能门锁的电机扭力调整为最优参数的问题。为实现上述目的，本发明提供一种电机扭力调节方法，所述电机扭力调节方法包括如下步骤：当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位；驱动电机运行，检测所述智能门锁的锁舌状态，当检测到锁舌状态未到位时，将电机扭力参数上调一个档位；当检测到锁舌状态到位时，增加检测次数，并判断检测次数是否达到预设门限值；当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力。可选地，所述的电机扭力调节方法，其中，所述当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位，具体包括：当首次检测开门或者关门动作时，判断电机扭力参数是否为空；当检测到电机扭力参数为空时，将电机扭力参数设置为预设档位。可选地，所述的电机扭力调节方法，其中，所述判断电机扭力参数是否为空，之后还包括：当检测到电机扭力参数不为空时，根据预先设置的电机扭力参数调整电机扭力。可选地，所述的电机扭力调节方法，其中，所述判断测试次数是否达到预设门限值，之后还包括：当检测次数未达到预设门限值时，判断所述智能门锁当前结束的动作是否为开门动作。可选地，所述的电机扭力调节方法，其中，所述判断门锁当前结束的动作是否为开门动作，之后还包括：当判断出所述智能门锁当前结束的动作是开门动作时，则控制电机执行关门动作，并继续驱动电机运行，直到检测次数达到预设门限值。可选地，所述的电机扭力调节方法，其中，所述判断门锁当前结束的动作是否为开门动作，之后还包括：当判断出所述智能门锁当前结束的动作是关门动作时，则控制电机执行开门动作，并继续驱动电机运行，直到检测次数达到预设门限值。可选地，所述的电机扭力调节方法，其中，所述检测锁舌状态具体为检测锁舌传感器反馈的值。可选地，所述的电机扭力调节方法，其中，所述预设门限值的范围为5-10次。此外，为实现上述目的，本发明还提供一种智能门锁，其中，所述智能门锁包括：存储器、处理器及存储在所述存储器上并可在所述处理器上运行的电机扭力调节程序，所述电机扭力调节程序被所述处理器执行时实现如上所述的电机扭力调节方法的步骤。此外，为实现上述目的，本发明还提供一种计算机可读存储介质，其中，所述计算机可读存储介质存储有电机扭力调节程序，所述电机扭力调节程序被处理器执行时实现如上所述的电机扭力调节方法的步骤。本发明中，当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位；驱动电机运行，检测所述智能门锁的锁舌状态，当检测到锁舌状态未到位时，将电机扭力参数上调一个档位，当检测到锁舌状态到位时，增加检测次数，并判断检测次数是否达到预设门限值；当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力。本发明通过开关门方式触发智能门锁进行自动适应调节电机扭力参数，使得智能门锁能工作在最优的电机扭力参数档位下，从而节约功耗延长智能门锁的使用寿命。附图说明图1是本发明电机扭力调节方法的较佳实施例的流程图；图2是本发明电机扭力调节方法的较佳实施例中步骤S10的流程图；图3是本发明电机扭力调节方法的较佳实施例中自适应电机扭力参数整个执行过程的示意图；图4为本发明智能门锁的较佳实施例的运行环境示意图。具体实施方式为使本发明的目的、技术方案及优点更加清楚、明确，以下参照附图并举实施例对本发明进一步详细说明。应当理解，此处所描述的具体实施例仅仅用以解释本发明，并不用于限定本发明。本发明较佳实施例所述的电机扭力调节方法，如图1所示，所述电机扭力调节方法包括以下步骤：步骤S10、当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位。具体的过程请参阅图2，其为本发明提供的电机扭力调节方法中步骤S10的流程图。如图2所示，所述步骤S10包括：S11、当首次检测开门或者关门动作时，判断电机扭力参数是否为空；S12、当检测到电机扭力参数为空时，将电机扭力参数设置为预设档位。具体地，本发明的所述智能门锁在安装完成后，安装人员可以通过开门或者关门的方式触发所述智能门锁进行自动适应调节电机扭力参数的流程，因为只有在开门或者关门时电机才会运行，才可以检测锁舌的状态。因此，当首次检测到开门动作或者关门动作后，再判断电机的电机扭力参数此时是否为空，当此时检测到电机扭力参数为空时，则将电机扭力参数设置为预设档位，例如所述预设档位优选为最低档位，因为电机扭力参数的档位越低，则所述智能门锁的功耗越低，因此最开始将电机扭力参数设置为最低档位，当最低档位无法满足开关门需求时再逐步调节电机扭力参数的档位，可以预先设置多个档位。进一步地，当检测到电机扭力参数不为空时，则根据预先设置的电机扭力参数调整电机扭力，或者直接按照预先设置的电机扭力参数进行工作，即此时的电机扭力参数已经设置好了，那么就不需要再自动适应调节电机扭力参数，即使用已设置好的电机扭力参数进行工作即可。其中，电机一般是通过PWM方式控制的；所以通过信号波形的占空比进行控制，占空比为100％，则功耗最大，电机扭力也最大；如果占空比设置为0，则相当于电机不工作，功耗为0；理论上，不同电机控制的占空比需要参考电机手册和门锁设计结合确定一个合适的范围；智能门锁厂家会在这个范围内，按照功耗和待机时间要求划分成不同的档位；比如常见的档位有：50％，60％，70％，80％等。步骤S20、驱动电机运行，检测所述智能门锁的锁舌状态，当检测到锁舌状态未到位时，将电机扭力参数上调一个档位；当检测到锁舌状态到位时，增加检测次数，并判断检测次数是否达到预设门限值。具体地，当电机扭力参数设置为最低档位，例如所述智能门锁中电机扭力参数的最低档位为50％，那么此时将电机扭力参数设置为50％，最低档位根据实际的智能门锁划分的档位来确定之后，此时驱动电机开始工作，在电机运行后，需要检测锁舌的状态，其中，锁舌就是在关门时弹出来卡到门框里预留的孔里，控制门无法打开的结构。本发明中，检测锁舌状态具体可以是检测锁舌传感器反馈的值来完成检测，例如目前的全自动电子锁体，如果自身设计有到位传感器的，直接根据锁舌传感器返回的值进行判断即可，例如锁舌传感器返回的值达到预设值即可认为锁舌到位，即所述锁舌传感器返回的值为1时则表示锁舌到位，或者锁舌传感器返回的值未达到预设值即可认为锁舌未到位，例如所述锁舌传感器返回的值为2时则表示锁舌未到位。进一步地，对于不带到位传感器的智能门锁，还可以通过电机反馈电流信号进行判断，依据原理如下：电机工作时，正常的工作电流是已知的，当电机伸缩到位后如果继续驱动电机伸缩，则电机电流会超过工作电流，这个就是电机的“堵转”现象，通过检测堵转电流大小可以判断出来电机伸缩是否到位，如果发生堵转，则锁舌到位；否则继续驱动电机，这类型设计，需要门锁电路增加堵转电流检测。根据上述检测锁舌状态的方式，就可以判断锁舌状态是否到位，那么当检测到锁舌状态未到位时，也就是无法正常开关门时，说明此时最低档位的电机扭力参数不符合要求，即说明最低档位电机扭力参数不足以驱动锁舌正常开关门，那么就需要调整电机扭力参数，此时可以将电机扭力参数上调一个档位，例如所述智能门锁中电机扭力参数的最低档位为50％的时候，上调一个档位后所述智能门锁中电机扭力参数的档位为60％，上调所述智能门锁中电机扭力参数的档位后，继续驱动电机，再次检测锁舌状态，继续判断锁舌是否到位，如果锁舌状态还没有到位，则继续将电机扭力上调一个档位，例如上调一个档位后所述智能门锁中电机扭力参数的档位为70％，如此循环直到锁舌到位为止。另外，当检测到锁舌状态到位时，证明此时可以正常开关门，视为当前电机扭力能驱动智能门锁开关门，此时虽然可以表示电机扭力参数的设置可以满足正常开关门，但是这只是一次测试的结果，无法表示数据的真实性和可靠性，那么，为了避免出现这样的偶然性，本发明通过增加检测次数的方式来验证当前电机扭力参数是否真正符合要求，那么在增加检测次数后需要判断检测次数是否达到预设门限值，因为检测次数过多会浪费时间且无法再带来更好的测试效果，检测次数过少又无法保证数据的可靠性，因此经过多次试验的结果，预设门限值的合适范围为5-10次，可以根据实际情况进行设置，本发明中预设门限值优选为5次。进一步地，在增加检测次数后，需要判断检测次数是否达到预设门限值，当检测次数未达到预设门限值时，则继续判断门锁当前结束的动作是否为开门动作，当判断出门锁当前结束的动作是开门动作时，则控制电机执行关门动作，并继续驱动电机运行，直到检测次数达到预设门限值为止；当判断出门锁当前结束的动作是关门动作时，则控制电机执行开门动作，并继续驱动电机运行，直到检测次数达到预设门限值为止。步骤S30、当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力。具体地，当检测次数达到预设门限值且每次均正常开门或者关门时，将当前的电机扭力设置为目标参数，所述目标参数是通过多次验证得到的，其具有可靠性和稳定性；例如经过5次检测，且每次检测都可以正常开门或者关门，当前的电机扭力参数的档位为60％，那么就将此时的电机扭力设置为目标参数，也就是所述智能门锁自动适应选择合适的电机扭力参数，那么当再次进行开门或者关门时使用所述目标参数作为电机扭力的默认参数，即设定了默认的电机扭力参数后，以后再开门或者关门，则使用该目标参数进行工作，从而完成了智能门锁电机参数的自动适应过程。智能门锁按电机的启动方式可分为两种：全自动智能门锁、半自动智能门锁。其中，半自动智能门锁是指人力操作+机器装置操作的门锁，它的启动是由于电机带动小离合，但是仍需要依靠人为拧把手开门。而全自动智能门锁就是指机械装置、门锁生产过程全面实现自动化，这样的智能门锁对电机要求很大，需要很大的扭力来保障智能锁的正常开启，全自动智能锁由电机带动锁的运作，完全不受外力影响，本发明的智能门锁优选为全自动智能门锁。本发明通过开关门方式触发智能门锁进行自动适应调节电机扭力参数，使得智能门锁能工作在最优的参数档位下，自动优化电机扭力参数，确保智能门锁总能工作在较低功耗下，延长智能门锁电池使用时间，从而节约功耗延长智能门锁的使用寿命，同时也降低了安装工的安装时间和对安装工的能力要求。进一步地，如图3所示，本发明中自适应电机扭力参数整个执行过程如下：步骤S101、开始；步骤S102、侦测开门动作或者关门动作，当侦测开门动作或者关门动作后执行步骤S103；步骤S103、判断此时电机扭力参数是否为空，当是时，执行步骤S105，当否时，执行步骤S104；步骤S104，当检测到电机扭力参数不为空时，根据预先设置的电机扭力参数调整电机扭力，即此时的电机扭力参数已经设置好了，表示所述智能门锁安装完成后，不是首次开门或者关门，那么就不需要再自动适应调节电机扭力参数，即使用已设置好的电机扭力参数进行工作即可；步骤S105，此时所述智能门锁进入自适应电机参数设置流程，即首次检测到开门或者关门动作且电机扭力参数为空时，将电机扭力参数设置为预设档位；步骤S106，驱动电机开始工作；步骤S107，在电机运行后，检测锁舌的状态，检测锁舌状态具体可以是检测锁舌传感器反馈的值来完成检测，如上述介绍的检测原理；步骤S108，判断锁舌是否到位，当是时，执行步骤S110，当否时，执行步骤S109；步骤S109，当检测到锁舌状态未到位时，也就是无法正常开关门时，说明此时最低档位的电机扭力参数不符合要求，那么就需要调整电机扭力参数，此时可以将电机扭力上调一个档位，然后返回继续执行步骤S106；步骤S110，当检测到锁舌状态到位时，证明此时可以正常开关门，为了避免出现数据的偶然性，增加1次检测次数的方式来验证当前电机扭力参数是否真正符合要求；步骤S111，在增加检测次数后判断检测次数是否达到预设门限值，当是时，执行步骤S115，当否时，执行步骤S112，其中，预设门限值的合适范围为5-10次，本发明中预设门限值优选为5次；步骤S112，即当检测次数未达到预设门限值时，判断所述智能门锁当前结束的动作是否为开门动作，当是时，执行步骤S113，当否时，执行步骤S114；步骤S113，当判断出门锁当前结束的动作是开门动作时，则控制电机执行关门动作，并返回执行步骤S106，即继续驱动电机运行，直到检测次数达到预设门限值为止；步骤S114，当判断出门锁当前结束的动作是关门动作时，则控制电机执行开门动作，并返回执行步骤S106，即继续驱动电机运行，直到检测次数达到预设门限值为止；步骤S115，当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力，即设定了默认的电机扭力参数后，以后再开门或者关门，则使用目标参数进行工作，从而完成了智能门锁电机参数的自动适应过程；步骤S116，结束。上述流程展示了整个电机扭力自动调节的过程，在首次检测到开门或者关门动作且电机扭力参数为空时，将电机扭力参数设置为最低档位，如果最低档位的电机扭力参数不符合开门或者关门的要求，那么就逐步增加电机扭力参数的档位，直到所调节的电机扭力参数符合开门或者关门的要求为止，此时的电机扭力参数就是最终需要得到的默认参数，并且这个默认参数还需要经过多次检测后才会最终认定为最优参数，那么后面再次进行开门或者关门时就使用所述最优参数作为电机扭力的默认参数，自动完成电机扭力参数的调节，使得智能门锁能工作在最优的参数档位下，从而节约功耗延长智能门锁的使用寿命。进一步地，如图4所示，基于上述电机扭力调节方法，本发明还相应提供了一种智能门锁，所述智能门锁包括处理器10、存储器20及显示器30。图4仅示出了智能门锁的部分组件，但是应理解的是，并不要求实施所有示出的组件，可以替代的实施更多或者更少的组件。所述存储器20在一些实施例中可以是所述智能门锁的内部存储单元，例如智能门锁的硬盘或内存。所述存储器20在另一些实施例中也可以是所述智能门锁的外部存储设备，例如所述智能门锁上配备的插接式硬盘，智能存储卡，安全数字卡，闪存卡等。进一步地，所述存储器20还可以既包括所述智能门锁的内部存储单元也包括外部存储设备。所述存储器20用于存储安装于所述智能门锁的应用软件及各类数据，例如所述安装智能门锁的程序代码等。所述存储器20还可以用于暂时地存储已经输出或者将要输出的数据。在一实施例中，存储器20上存储有电机扭力调节程序40，该电机扭力调节程序40可被处理器10所执行，从而实现本申请中电机扭力调节方法。所述处理器10在一些实施例中可以是一中央处理器，微处理器或其他数据处理芯片，用于运行所述存储器20中存储的程序代码或处理数据，例如执行所述电机扭力调节方法等。所述显示器30在一些实施例中可以是LED显示器、液晶显示器、触控式液晶显示器以及OLED触摸器等。所述显示器30用于显示在所述智能门锁的信息以及用于显示可视化的用户界面。所述智能门锁的部件10-30通过系统总线相互通信。在一实施例中，当处理器10执行所述存储器20中电机扭力调节程序40时实现以下步骤：当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位；驱动电机运行，检测所述智能门锁的锁舌状态，当检测到锁舌状态未到位时，将电机扭力参数上调一个档位；当检测到锁舌状态到位时，增加检测次数，并判断检测次数是否达到预设门限值；当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力。其中，所述当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位，具体包括：当首次检测开门或者关门动作时，判断电机扭力参数是否为空；当检测到电机扭力参数为空时，将电机扭力参数设置为预设档位。其中，所述判断电机扭力参数是否为空，之后还包括：当检测到电机扭力参数不为空时，根据预先设置的电机扭力参数调整电机扭力。其中，所述判断测试次数是否达到预设门限值，之后还包括：当检测次数未达到预设门限值时，判断所述智能门锁当前结束的动作是否为开门动作。其中，所述判断门锁当前结束的动作是否为开门动作，之后还包括：当判断出所述智能门锁当前结束的动作是开门动作时，则控制电机执行关门动作，并继续驱动电机运行，直到检测次数达到预设门限值。其中，所述判断门锁当前结束的动作是否为开门动作，之后还包括：当判断出所述智能门锁当前结束的动作是关门动作时，则控制电机执行开门动作，并继续驱动电机运行，直到检测次数达到预设门限值。其中，所述检测锁舌状态具体为检测锁舌传感器反馈的值。其中，所述预设门限值的范围为5-10次。本发明还提供一种计算机可读存储介质，其中，所述计算机可读存储介质存储有电机扭力调节程序，所述电机扭力调节程序被处理器执行时实现如上所述的电机扭力调节方法的步骤。综上所述，本发明提供一种电机扭力调节方法、智能门锁及计算机可读存储介质，所述方法包括：当检测到开门或者关门动作时，将智能门锁的电机扭力参数设置为预设档位；驱动电机运行，检测所述智能门锁的锁舌状态，当检测到锁舌状态未到位时，将电机扭力参数上调一个档位，当检测到锁舌状态到位时，增加检测次数，并判断检测次数是否达到预设门限值；当检测次数达到预设门限值且每次开门或者关门的状态为正常时，将当前的电机扭力参数设置为目标参数，则再次进行开门或者关门时使用所述目标参数调整电机扭力。本发明通过开关门方式触发智能门锁进行自动适应调节电机扭力参数，使得智能门锁能工作在最优的电机扭力参数档位下，从而节约功耗延长智能门锁的使用寿命。需要说明的是，在本文中，术语“包括”、“包含”或者其任何其他变体意在涵盖非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者装置不仅包括那些要素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者装置所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在包括该要素的过程、方法、物品或者装置中还存在另外的相同要素。当然，本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关硬件来完成，所述的程序可存储于一计算机可读取的计算机可读存储介质中，所述程序在执行时可包括如上述各方法实施例的流程。其中所述的计算机可读存储介质可为存储器、磁碟、光盘等。应当理解的是，本发明的应用不限于上述的举例，对本领域普通技术人员来说，可以根据上述说明加以改进或变换，所有这些改进和变换都应属于本发明所附权利要求的保护范围。
