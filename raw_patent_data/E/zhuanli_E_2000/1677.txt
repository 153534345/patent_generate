标题title
装载机工作装置的控制方法、装置及系统
摘要abst
本发明公开了一种装载机工作装置的控制方法、装置及系统，包括对翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；将翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；将铲斗位置作为反馈信号，结合闭环控制算法，对铲斗轨迹进行闭环控制；基于计算得到的翻斗缸活塞速度、动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动装载机工作装置。本发明计算效率高，具有非常好的实时性，可实现对装载机的闭环控制，还可用于装载机的HIL测试，提高产品开发效率，缩短产品开发周期，节省研发成本。
权利要求书clms
1.一种装载机工作装置的控制方法，所述装载机工作装置包括翻斗缸、动臂缸、前车架和若干个铰点，其特征在于，所述控制方法包括：获取翻斗缸长度、动臂缸长度和前车架转动角度；对所述翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；将所述翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；将计算得到的铲斗位置作为反馈信号，结合闭环控制算法，对铲斗轨迹进行闭环控制；基于计算得到的翻斗缸活塞速度、动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动装载机工作装置。2.根据权利要求1所述的一种装载机工作装置的控制方法，其特征在于，所述装载机工作装置动力学模型的构建方法包括：约定装载机工作装置的初始姿态、坐标原点和坐标轴方向，得到各铰点、各构件质心的初始坐标；以各铰点、各构件质心的初始坐标作为初始条件，根据装载机工作装置的结构，按照预设的求解顺序，求解出不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度；其中，翻斗缸长度、动臂缸长度和前车架转动角度的不同数值组合对应不同姿态；对求得的不同姿态下各构件质心的坐标，以及各构件的转动角度进行二阶求导；基于不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度，结合二阶求导的结果，利用牛顿欧拉法构建出装载机工作装置动力学模型。3.根据权利要求2所述的一种装载机工作装置的控制方法，其特征在于，所述各铰点、各构件的初始坐标的获取方法包括：对装载机工作装置进行结构简化，生成对应的二维模型；约定装载机工作装置的初始姿态、坐标原点和坐标轴方向，结合所述二维模型计算出各铰点、各构件的初始坐标。4.根据权利要求2所述的一种装载机工作装置的控制方法，其特征在于，不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度的求解方法包括：按照预设的求解顺序，计算前车架转动角度为零时，不同翻斗缸长度和动臂缸长度下各铰点、各构件质心的坐标以及各构件转动角度；基于前车架的不同转角，生成坐标变换矩阵，基于所述坐标变换矩阵对前车架转动角度为零时各铰点、各构件质心的坐标进行坐标变换，得到前车架转动角度不为零时各铰点、各构件质心的坐标。5.根据权利要求4所述的一种装载机工作装置的控制方法，其特征在于，所述预设的求解顺序，具体为：首先，求解动臂缸与动臂间铰点的坐标；然后，求解动臂上其它各铰点以及动臂质心的坐标；再次，根据前车架到铲斗之间所有构件间连接关系，顺序求解其它铰点的坐标；最后，根据同一构件上两个铰点的坐标计算该构件质心的坐标。6.根据权利要求4或5所述的一种装载机工作装置的控制方法，其特征在于，当前车架转动角度为零，且铰点所属的两个构件中至少有一个构件可确定两个或两个以上质心或铰点的坐标时，则待求质心或铰点的坐标通过以下公式求解：，其中，矩阵Ta满足：，其中，当、/＞为待求质心在k+1时刻的坐标，/＞、/＞为待求质心在k时刻的坐标时，/＞、/＞为待求质心所属构件u上铰点p在k+1时刻的坐标，/＞、/＞为待求质心所属构件u上铰点p在k时刻的坐标，/＞、/＞为待求铰点所属构件u上铰点q在k+1时刻的坐标，/＞、/＞为待求铰点所属构件u上铰点q在k时刻的坐标；当/＞、/＞为待求铰点在k+1时刻的坐标时，/＞、/＞为待求铰点所属构件u上质心或铰点p在k+1时刻的坐标，/＞、/＞为待求铰点所属构件u上质心或铰点q在k+1时刻的坐标；当铰点所属的构件均仅可确定一个铰点的坐标，则待求铰点的坐标通过以下公式求解：，，其中，、/＞为待求铰点所属构件v上铰点r在k+1时刻的坐标；l1、l2分别为待求铰点到所属构件u上铰点p和所属构件v上铰点r的距离；/＞、/＞为选取的参考点在k时刻的坐标，该参考点是其它待求铰点中的任意一个；e为判断容差；/＞为所选参考点到待求点的距离。7.根据权利要求4所述的一种装载机工作装置的控制方法，其特征在于，各构件的转动角度的计算公式为：，其中，为构件i在k+1时刻的转动角度；/＞、/＞为铰点Mj在初始姿态的坐标；/＞、为铰点Mj在k+1时刻的坐标；/＞、/＞为构件i的质心在初始姿态的坐标；/＞、/＞为构件i的质心在k+1时刻的坐标。8.根据权利要求4所述的一种装载机工作装置的控制方法，其特征在于，当前车架转动角度为零时，装载机工作装置位于xy平面内，各铰点、各构件质心在z方向的坐标为零，当前车架旋转轴与x轴平行时，所述坐标变换矩阵的表达式为：，当前车架旋转轴与y轴平行时，所述坐标变换矩阵的表达式为：，式中，为前车架转动角度；利用坐标变换矩阵计算转向后各铰点、各构件质心的坐标，采用的计算公式为：，式中，为前车架转动角度φ=0时某铰点或某构件质心的坐标；为前车架转动角度φ≠0时某铰点或某构件质心的坐标。9.根据权利要求8所述的一种装载机工作装置的控制方法，其特征在于，所述对求得的不同姿态下各构件质心的坐标，以及各构件的转动角度进行二阶求导，具体包括：对各个构件质心的坐标求二阶导，得到各个构件在三个方向上的平移加速度、、/＞；对各个构件的转动角度求二阶导，根据前车架转动角度得到各个构件在三个方向上的转动加速度/＞、/＞、/＞；当前车架旋转轴与x轴平行时，；当前车架旋转轴与y轴平行时，；式中，为在k+1时刻前车架转动角加速度，/＞为前车架转动角度。10.根据权利要求2所述的一种装载机工作装置的控制方法，其特征在于，基于不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度，结合二阶求导的结果，利用牛顿欧拉法构建出装载机工作装置动力学模型，包括：利用牛顿欧拉法，根据装载机工作装置中各构件间的连接关系构建动力学方程，即为装载机工作装置动力学模型，所述动力学方程的表达式为：，其中，矩阵M为：，其中，n为构件数，m为铰点数，子矩阵mij表示第j个铰点处的力对第i个构件的力平衡、力矩平衡的贡献，其元素为：，其中，、/＞、/＞为在k+1时刻铰点Mj相对于第i个构件质心Oi的坐标；当前i-1个构件中不包含铰点Mj时，/＞=1，否则，/＞=2；子矩阵mi、mi分别表示翻斗油缸和动臂油缸输出力对第i个构件的力平衡、力矩平衡的贡献；当前车架旋转轴与x轴平行时：，，当前车架旋转轴与y轴平行时：，，式中，当翻斗缸液压力F1对构件i的质心Oi所产生的力矩为正时，s=0，否则，s=1；当动臂缸液压力F2对构件i的质心Oi所产生的力矩为正时，t=0，否则，t=1；L1和L2分别为翻斗缸液压力F1在摇臂质心处的力臂、动臂缸液压力F2对动臂质心处的力臂；cosx1、cosy1和cosz1分别为翻斗缸液压力在三个坐标轴方向上的方向余弦；cosx2、cosy2和cosz2分别为计算动臂缸液压力在三个坐标轴方向上的方向余弦；矩阵X为：，，式中，、/＞、/＞表示铰点Mj处的作用力，/＞为第k+1时刻翻斗缸液压力，为第k+1时刻动臂缸液压力；矩阵N为：，，式中，mi表示构件i的质量；Ii_x、Ii_y、Ii_z分别表示构件i绕x、y、z轴的转动惯量；、、/＞分别表示k+1时刻构件i沿x、y、z轴的平移加速度，/＞、/＞、/＞分别为各个构件在三个方向上的转动加速度，/＞为重力加速度。11.一种装载机工作装置的控制装置，所述装载机工作装置包括翻斗缸、动臂缸、前车架和若干个铰点，其特征在于，所述控制装置包括：获取模块，用于获取翻斗缸长度、动臂缸长度和前车架转动角度；第一计算模块，用于对所述翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；第二计算模块，用于将所述翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；控制模块，包含铲斗轨迹控制模块和功率匹配控制模块，所述铲斗轨迹控制模块用于将计算得到的铲斗位置作为反馈信号，结合闭环控制算法，对铲斗轨迹进行闭环控制；所述功率匹配模块用于基于计算得到的翻斗缸活塞速度、动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动装载机工作装置。12.一种装载机工作装置的控制系统，其特征在于，包括存储介质和处理器；所述存储介质用于存储指令；所述处理器用于根据所述指令进行操作以执行根据权利要求1-10中任一项所述的方法。
说明书desc
技术领域本发明属于装载机控制技术领域，具体涉及一种装载机工作装置的控制方法、装置及系统。背景技术装载机由于其作业速度快、效率高、机动性好等优点，被广泛应用于公路、铁路、建筑、水电、港口、矿山等建筑工程中。随着现代施工项目大型化、客户对产品价值的诉求提升等变化出现，智能化、数字化发展正成为工程机械行业的重要趋势。无人装载机作为一种典型的工程机械智能化产品，可适应各种恶劣环境，对减轻工作人员的劳动强度，保障职业健康、人身安全等，有着十分关键的作用。在无人装载机关键技术中，除无人驾驶技术外，另一个关键技术是自主铲掘功能的实现，即对铲斗轨迹的控制。但装载机作业时的铲斗位置难以直接测量。从机构学的角度，可将装载机工作装置视为空间连杆机构，翻斗缸和动臂缸作为驱动元件，翻斗缸、动臂缸的长度与铲斗位置存在对应关系，即可由翻斗缸、动臂缸的长度间接得到铲斗位置。除此之外，现有技术中，翻斗缸、动臂缸的驱动功率不是按需输出，在动力系统的设计过程中，往往按最大消耗功率计算，使得功率浪费，不利于去冗余设计。解决上述问题的关键，在于工作装置的动力学模型的建立。目前对装载机虚拟样机模型的搭建主要通过两种方式，一种是基于ADAMS、RecurDyn等商业多体动力学软件，这类动力学软件具有建模过程直观、计算结果可靠等优点，但其数学模型复杂、计算成本高，不适用于闭环控制、硬件在环测试等对仿真实时性要求较高的场合；另一种是采用公式化建模的方式，首先根据实际问题的需要对模型作出简化假设，再使用适当的方法描述各变量间的数学关系。对于连杆机构动力学建模，常采用D-H参数法或矢量法建立运动学方程，使用牛顿欧拉法或拉格朗日法建立动力学方程。其中D-H参数常用于对工业机械人的运动学分析，此类装置中构件多为二副杆，即每个构件只有两个运动副，而在装载机工作装置中，尽管铲斗、拉杆上仅有两个运动副，但摇臂上有三个运动副，动臂上有四个运动副，故此方法不适用用于装载机工作装置动力学建模；矢量法构建的机构运动学方程为非线性方程组，通常需要通过牛顿拉夫逊迭代法来求解，计算成本较高。牛顿欧拉法属于矢量力学范畴，其基于牛顿第二定律和欧拉方程，将机构中的每个构件进行隔离单独分析，具有直观性强、计算效率高的特点；拉格朗日法属于分析力学范畴，其基于系统能量的概念，以简单形式求得非常复杂的系统动力学方程，并具有显示结构，但其推导过程繁琐，且随着机构构件数和自由度的增加，动能和势能方程中的项数大幅增加，计算量相当大。发明内容针对上述问题，本发明提出一种装载机工作装置的控制方法、装置及系统，不仅计算效率高，而且具有非常好的实时性，可实现对装载机的闭环控制，还可用于装载机的HIL测试，提高产品开发效率，缩短产品开发周期，节省研发成本。为了实现上述技术目的，达到上述技术效果，本发明通过以下技术方案实现：第一方面，本发明提供了一种装载机工作装置的控制方法，所述装载机工作装置包括翻斗缸、动臂缸、前车架和若干个铰点，所述控制方法包括：获取翻斗缸长度、动臂缸长度和前车架转动角度；对所述翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；将所述翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；将计算得到的铲斗位置作为反馈信号，结合闭环控制算法，对铲斗轨迹进行闭环控制；基于计算得到的翻斗缸活塞速度、动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动装载机工作装置。可选地，所述装载机工作装置动力学模型的构建方法包括：约定装载机工作装置的初始姿态、坐标原点和坐标轴方向，得到各铰点、各构件质心的初始坐标；以各铰点、各构件质心的初始坐标作为初始条件，根据装载机工作装置的结构，按照预设的求解顺序，求解出不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度；其中，翻斗缸长度、动臂缸长度和前车架转动角度的不同数值组合对应不同姿态；对求得的不同姿态下各构件质心的坐标，以及各构件的转动角度进行二阶求导；基于不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度，结合二阶求导的结果，利用牛顿欧拉法构建出装载机工作装置动力学模型。可选地，所述各铰点、各构件的初始坐标的获取方法包括：对装载机工作装置进行结构简化，生成对应的二维模型；约定装载机工作装置的初始姿态、坐标原点和坐标轴方向，结合所述二维模型计算出各铰点、各构件的初始坐标。可选地，不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度的求解方法包括：按照预设的求解顺序，计算前车架转动角度为零时，不同翻斗缸长度和动臂缸长度下各铰点、各构件质心的坐标以及各构件转动角度；基于前车架的不同转角，生成坐标变换矩阵，基于所述坐标变换矩阵对前车架转动角度为零时各铰点、各构件质心的坐标进行坐标变换，得到前车架转动角度不为零时各铰点、各构件质心的坐标。可选地，所述预设的求解顺序，具体为：首先，求解动臂缸与动臂间铰点的坐标；然后，求解动臂上其它各铰点以及动臂质心的坐标；再次，根据前车架到铲斗之间所有构件间连接关系，顺序求解其它铰点的坐标；最后，根据同一构件上两个铰点的坐标计算该构件质心的坐标。可选地，当前车架转动角度为零，且铰点所属的两个构件中至少有一个构件可确定两个或两个以上质心或铰点的坐标时，则待求质心或铰点的坐标通过以下公式求解：，其中，矩阵Ta满足：，其中，当、/＞为待求质心在k+1时刻的坐标，/＞、/＞为待求质心在k时刻的坐标时，/＞、/＞为待求质心所属构件u上铰点p在k+1时刻的坐标，/＞、/＞为待求质心所属构件u上铰点p在k时刻的坐标，/＞、/＞为待求铰点所属构件u上铰点q在k+1时刻的坐标，/＞、/＞为待求铰点所属构件u上铰点q在k时刻的坐标；当/＞、/＞为待求铰点在k+1时刻的坐标时，/＞、/＞为待求铰点所属构件u上质心或铰点p在k+1时刻的坐标，/＞、/＞为待求铰点所属构件u上质心或铰点q在k+1时刻的坐标；当铰点所属的构件均仅可确定一个铰点的坐标，则待求铰点的坐标通过以下公式求解：，，其中，、/＞为待求铰点所属构件v上铰点r在k+1时刻的坐标；l1、l2分别为待求铰点到所属构件u上铰点p和所属构件v上铰点r的距离；/＞、/＞为选取的参考点在k时刻的坐标，该参考点是其它待求铰点中的任意一个；e为判断容差；/＞为所选参考点到待求点的距离。可选地，各构件的转动角度的计算公式为：，其中，为构件i在k+1时刻的转动角度，/＞、/＞为铰点Mj在初始姿态的坐标；、/＞为铰点Mj在k+1时刻的坐标；/＞、/＞为构件i的质心在初始姿态的坐标；/＞、为构件i的质心在k+1时刻的坐标。可选地，当前车架转动角度为零时，装载机工作装置位于xy平面内，各铰点、各构件质心在z方向的坐标为零，当前车架旋转轴与x轴平行时，所述坐标变换矩阵的表达式为：，当前车架旋转轴与y轴平行时，所述坐标变换矩阵的表达式为：，式中，为前车架转动角度；利用坐标变换矩阵计算转向后各铰点、各构件质心的坐标，采用的计算公式为：，式中，为前车架转动角度φ=0时某铰点或某构件质心的坐标；为前车架转动角度φ≠0时某铰点或某构件质心的坐标。可选地，所述对求得的不同姿态下各构件质心的坐标，以及各构件的转动角度进行二阶求导，具体包括：对各个构件质心的坐标求二阶导，得到各个构件在三个方向上的平移加速度、/＞、/＞；对各个构件的转动角度求二阶导，根据前车架转动角度得到各个构件在三个方向上的转动加速度/＞、/＞、/＞；当前车架旋转轴与x轴平行时，；当前车架旋转轴与y轴平行时，；式中，为在k+1时刻前车架转动角加速度，/＞为前车架转动角度。可选地，基于不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度，结合二阶求导的结果，利用牛顿欧拉法构建出装载机工作装置动力学模型，包括：利用牛顿欧拉法，根据装载机工作装置中各构件间的连接关系构建动力学方程，即为装载机工作装置动力学模型，所述动力学方程的表达式为：，其中，矩阵M为：，其中，n为构件数，m为铰点数，子矩阵mij表示第j个铰点处的力对第i个构件的力平衡、力矩平衡的贡献，其元素为：，其中，、/＞、/＞为在k+1时刻铰点Mj相对于第i个构件质心Oi的坐标；当前i-1个构件中不包含铰点Mj时，/＞=1，否则，/＞=2；子矩阵mi、mi分别表示翻斗油缸和动臂油缸输出力对第i个构件的力平衡、力矩平衡的贡献；当前车架旋转轴与x轴平行时：，；当前车架旋转轴与y轴平行时：，；式中，当翻斗缸液压力F1对构件i的质心Oi所产生的力矩为正时，s=0，否则，s=1；当动臂缸液压力F2对构件i的质心Oi所产生的力矩为正时，t=0，否则，t=1；L1和L2分别为翻斗缸液压力F1在摇臂质心处的力臂、动臂缸液压力F2对动臂质心处的力臂；cosx1、cosy1和cosz1分别为翻斗缸液压力在三个坐标轴方向上的方向余弦；cosx2、cosy2和cosz2分别为计算动臂缸液压力在三个坐标轴方向上的方向余弦；矩阵X为：，，式中，、/＞、/＞表示铰点Mj处的作用力，/＞为第k+1时刻翻斗缸液压力，/＞为第k+1时刻动臂缸液压力；矩阵N为：，，式中，mi表示构件i的质量；Ii_x、Ii_y、Ii_z分别表示构件i绕x、y、z轴的转动惯量；、/＞、/＞分别表示k+1时刻构件i沿x、y、z轴的平移加速度，/＞、/＞、分别为各个构件在三个方向上的转动加速度，/＞为重力加速度。第二方面，本发明提供了一种装载机工作装置的控制装置，所述装载机工作装置包括翻斗缸、动臂缸、前车架和若干个铰点，所述控制装置包括：获取模块，用于获取翻斗缸长度、动臂缸长度和前车架转动角度；第一计算模块，用于对所述翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；第二计算模块，用于将所述翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；控制模块，包含铲斗轨迹控制模块和功率匹配控制模块，所述铲斗轨迹控制模块用于将计算得到的铲斗位置作为反馈信号，结合闭环控制算法，对铲斗轨迹进行闭环控制；所述功率匹配模块用于基于计算得到的翻斗缸活塞速度、动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动装载机工作装置。第三方面，本发明提供了一种装载机工作装置的控制系统，包括存储介质和处理器；所述存储介质用于存储指令；所述处理器用于根据所述指令进行操作以执行根据第一方面中任一项所述的方法。与现有技术相比，本发明的有益效果：相比于现有技术，本发明中通过对翻斗缸长度、动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；通过将翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力，其中铲斗位置作为反馈信号，结合PID等控制算法，实现对铲斗轨迹的闭环控制，同时基于翻斗缸活塞速度、动臂缸活塞速度，以及翻斗缸液压力和动臂缸液压力控制动力系统输出相应大小的功率以驱动装载机工作装置。不仅计算效率高，而且具有非常好的实时性，可实现对装载机的闭环控制，还可用于装载机的HIL测试，提高产品开发效率，缩短产品开发周期，节省研发成本。附图说明为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其他的附图，其中：图1为现有技术中某一装载机工作装置的结构示意图；图2为本发明提供的装载机工作装置控制方法的示意图；图3为本发明提供的一种简化后的装载机z字形反转六连杆工作装置示意图；图4为将本发明的建模方法与商业动力学软件关于铲斗与拉杆间铰点坐标的计算结果对比图之一；图5为将本发明的建模方法与商业动力学软件关于铲斗与拉杆间铰点坐标的计算结果对比图之二；图6为将本发明的建模方法与商业动力学软件关于铲斗与拉杆间铰点坐标的计算结果对比图之三；图7为本发明的建模方法与商业动力学软件关于动臂缸、翻斗缸液压力的计算结果对比图之一；图8为本发明的建模方法与商业动力学软件关于动臂缸、翻斗缸液压力的计算结果对比图之二。具体实施方式下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅是本发明的一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。另外，若本发明实施例中有涉及“第一”、“第二”等的描述，则该“第一”、“第二”等的描述仅用于描述目的，而不能理解为指示或暗示其相对重要性或者隐含指明所指示的技术特征的数量。由此，限定有“第一”、“第二”的特征可以明示或者隐含地包括至少一个该特征。另外，各个实施例之间的技术方案可以相互结合，但是必须是以本领域普通技术人员能够实现为基础，当技术方案的结合出现相互矛盾或无法实现时应当认为这种技术方案的结合不存在，也不在本发明要求的保护范围之内。实施例1本发明实施例中提供了一种装载机工作装置的控制方法，所述装载机工作装置包括翻斗缸、动臂缸、前车架和若干个铰点，所述控制方法包括：获取翻斗缸长度、动臂缸长度和前车架转动角度；在具体实施过程中，翻斗缸长度、动臂缸长度和前车架转动角度均采用对应的传感器进行获取；对所述翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；将所述翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；将计算得到的铲斗位置作为反馈信号，结合闭环控制算法，对铲斗轨迹进行闭环控制；基于计算得到的翻斗缸活塞速度、动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动装载机工作装置，起到节能效果。相比于现有技术，本发明实施例中的方法，通过对翻斗缸长度、动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；通过将翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力，其中铲斗位置作为反馈信号，结合PID等控制算法，实现对铲斗轨迹的闭环控制，同时基于翻斗缸活塞速度、动臂缸活塞速度，以及翻斗缸液压力和动臂缸液压力控制动力系统输出相应大小的功率以驱动装载机工作装置。不仅计算效率高，而且具有非常好的实时性，可实现对装载机的闭环控制，还可用于装载机的HIL测试，提高产品开发效率，缩短产品开发周期，节省研发成本。在本发明实施例的一种具体实施方式中，所述装载机工作装置动力学模型的构建方法包括：约定装载机工作装置的初始姿态、坐标原点和坐标轴方向，得到各铰点、各构件质心的初始坐标；以各铰点、各构件质心的初始坐标作为初始条件，根据装载机工作装置的结构，按照预设的求解顺序，求解出不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度；其中，翻斗缸长度、动臂缸长度和前车架转动角度的不同数值组合对应不同姿态；对求得的不同姿态下各构件质心的坐标，以及各构件的转动角度进行二阶求导；基于不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度，结合二阶求导的结果，利用牛顿欧拉法构建出装载机工作装置动力学模型。在本发明实施例的一种具体实施方式中，所述各铰点、各构件的初始坐标的获取方法包括：对装载机工作装置进行结构简化，生成对应的二维模型；在具体实施过程中，结构简化的原则为：动臂轴线与摇臂、拉杆轴线处于同一平面内，即将工作装置由空间连杆机构简化为一个平面连杆机构，图3为对图1所示结构进行简化后的结果；将动臂缸、翻斗缸视为无质量的构件且不考虑移动副的作用，即将动臂缸、翻斗缸视为二力杆；所有构件均视为刚体，即不考虑构件在力作用下所产生的形变；约定装载机工作装置的初始姿态、坐标原点和坐标轴方向，结合所述二维模型计算出各铰点、各构件的初始坐标；在具体实施过程中，所述的初始姿态、坐标原点和坐标轴的定义可以是任意的。为了方便建模，通常将重力方向作为其中一个坐标轴方向。为便于说明，这里假设前车架转动角度为零时工作装置位于xy平面内，即各铰点、各构件质心在z方向的坐标为零。在本发明实施例的一种具体实施方式中，不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度的求解方法包括：按照预设的求解顺序，计算前车架转动角度为零时，不同翻斗缸长度和动臂缸长度下各铰点、各构件质心的坐标以及各构件转动角度；基于前车架的不同转角，生成坐标变换矩阵，基于所述坐标变换矩阵对前车架转动角度为零时各铰点、各构件质心的坐标进行坐标变换，得到前车架转动角度不为零时各铰点、各构件质心的坐标。其中，所述预设的求解顺序，具体为：首先，求解动臂缸与动臂间铰点的坐标；然后，求解动臂上其它各铰点以及动臂质心的坐标；再次，根据前车架到铲斗之间所有构件间连接关系，顺序求解其它铰点的坐标；比如：先求解翻斗缸与摇臂间铰点的坐标，再求解摇臂与拉杆间铰点的坐标，最后求解拉杆与铲斗间铰点的坐标；最后，根据同一构件上两个铰点的坐标计算该构件质心的坐标。在本发明实施例的一种具体实施方式中，前车架转动角度φ=0时，不同翻斗缸长度和动臂缸长度下各铰点、各构件质心坐标的计算方法为：当前车架转动角度为零，且铰点所属的两个构件中至少有一个构件可确定两个或两个以上质心或铰点的坐标时，则待求质心或铰点的坐标通过以下公式求解：，其中，矩阵Ta满足：，其中，当、/＞为待求质心在k+1时刻的坐标，/＞、/＞为待求质心在k时刻的坐标时，/＞、/＞为待求质心所属构件u上铰点p在k+1时刻的坐标，/＞、/＞为待求质心所属构件u上铰点p在k时刻的坐标。/＞、/＞为待求铰点所属构件u上铰点q在k+1时刻的坐标，/＞、/＞为待求铰点所属构件u上铰点q在k时刻的坐标；当/＞、为待求铰点在k+1时刻的坐标时，/＞、/＞为待求铰点所属构件u上质心或铰点p在k+1时刻的坐标，/＞、/＞为待求铰点所属构件u上质心或铰点q在k+1时刻的坐标；当铰点所属的构件均仅可确定一个铰点的坐标，则待求铰点的坐标通过以下公式求解：，，其中，、/＞为待求铰点所属构件v上铰点r在k+1时刻的坐标；l1、l2分别为待求铰点到所属构件u上铰点p和所属构件v上铰点r的距离；/＞、/＞为选取的参考点在k时刻的坐标，该参考点是其它待求铰点中的任意一个；e为判断容差；/＞为所选参考点到待求点的距离。各构件的转动角度的计算公式为：，其中，、/＞为铰点Mj在初始姿态的坐标；/＞、/＞为铰点Mj在k+1时刻的坐标；、/＞为构件i的质心在初始姿态的坐标；/＞、/＞为构件i的质心在k+1时刻的坐标。当前车架转动角度为零时，装载机工作装置位于xy平面内，各铰点、各构件质心在z方向的坐标为零，当前车架旋转轴与x轴平行时，所述坐标变换矩阵的表达式为：，当前车架旋转轴与y轴平行时，所述坐标变换矩阵的表达式为：，式中，为前车架转动角度；利用坐标变换矩阵计算转向后各铰点、各构件质心的坐标，采用的计算公式为：，式中，为前车架转动角度φ=0时某铰点或某构件质心的坐标；为前车架转动角度φ≠0时某铰点或某构件质心的坐标。在本发明实施例的一种具体实施方式中，所述对求得的不同姿态下各构件质心的坐标，以及各构件的转动角度进行二阶求导，具体包括：对各个构件质心的坐标求二阶导，得到各个构件在三个方向上的平移加速度、/＞、/＞；对各个构件的转动角度求二阶导，根据前车架转动角度得到各个构件在三个方向上的转动加速度/＞、/＞、/＞；/＞当前车架旋转轴与x轴平行时，；当前车架旋转轴与y轴平行时，；式中，为在k+1时刻前车架转动角加速度。在本发明实施例的一种具体实施方式中，基于不同姿态下各铰点、各构件质心的坐标，以及各构件的转动角度，结合二阶求导的结果，利用牛顿欧拉法构建出装载机工作装置动力学模型，包括：利用牛顿欧拉法，根据装载机工作装置中各构件间的连接关系构建动力学方程，即为装载机工作装置动力学模型，所述动力学方程的表达式为：，其中，矩阵M为：，其中，n为构件数，m为铰点数，子矩阵mij表示第j个铰点处的力对第i个构件的力平衡、力矩平衡的贡献，其元素为：，其中，、/＞、/＞为在k+1时刻铰点Mj相对于第i个构件质心Oi的坐标；当前i-1个构件中不包含铰点Mj时，/＞=1，否则，/＞=2；子矩阵mi、mi分别表示翻斗油缸和动臂油缸输出力对第i个构件的力平衡、力矩平衡的贡献；当前车架旋转轴与x轴平行时：，，当前车架旋转轴与y轴平行时：，，式中，当翻斗缸液压力F1对构件i的质心Oi所产生的力矩为正时，s=0，否则，s=1；当动臂缸液压力F2对构件i的质心Oi所产生的力矩为正时，t=0，否则，t=1；L1和L2分别为翻斗缸液压力F1在摇臂质心处的力臂、动臂缸液压力F2对动臂质心处的力臂；cosx1、cosy1和cosz1分别为翻斗缸液压力在三个坐标轴方向上的方向余弦；cosx2、cosy2和cosz2分别为计算动臂缸液压力在三个坐标轴方向上的方向余弦；矩阵X为：，，式中，、/＞、/＞表示铰点Mj处的作用力；矩阵N为：，，式中，mi表示构件i的质量；Ii_x、Ii_y、Ii_z分别表示构件i绕x、y、z轴的转动惯量；、/＞、/＞分别表示k+1时刻构件i沿x、y、z轴的平移加速度。下面结合一具体实施方式对本发明实施例中的方法进行详细说明。如图1所示，装载机工作装置按结构类型可分为反转六连杆工作装置、正转六连杆工作装置、反转八连杆工作装置和正转八连杆工作装置等。其中，反转六连杆工作装置由铲斗1、拉杆2、摇臂3、动臂4以及翻斗缸5和动臂缸6组成。铲斗1与动臂4间通过铰点M1连接在一起；拉杆2的一端通过铰点M2与铲斗1相连，另一端通过铰点M3与摇臂3相连；摇臂3通过铰点M4安装在动臂4上，另一端通过铰点M5与翻斗缸5相连；翻斗缸5另一端通过铰点M7安装在前车架7上；动臂缸6一端通过铰点M6与动臂4相连，另一端通过铰点M9与前车架7相连；动臂4与前车架7通过铰点M8相连。步骤对装载机工作装置按如下规则进行简化：a.动臂轴线与摇臂、拉杆轴线处于同一平面内，即：将装载机工作装置简化由空间连杆机构为一个平面连杆机构；b.将动臂缸、翻斗缸视为无质量的构件，且不考虑移动副的作用，即：将动臂缸、翻斗缸视为二力杆；c.所有构件均视为刚体，即：不考虑构件在力作用下所产生的形变。然后，设定初始姿态下铲斗平放于地面、前车架转动角度为零度，坐标原点与M1点重合，坐标轴方向如图3所示。步骤根据装载机工作装置的结构按一定的先后顺序求解不同姿态下各铰点、各构件质心的坐标以及各构件转动角度，具体步骤为：根据铰点的初始坐标计算|M1M2|、|M2M3|、|M4M5|和| M6M8|；输入k+1时刻翻斗缸|M5M7|k+1、动臂缸长度|M6M9|k+1，以及前车架相对转角φ；根据|M6M9|k+1、| M6M8|，求解如下方程组计算动臂与动臂缸间铰点M6：，/＞其中，，求解动臂相关的其它点的位置，铲斗与动臂间铰点M1：，其中，矩阵T1满足，同理，可得摇臂与动臂间铰点M4：，动臂质心O4：，根据|M5M7|k+1、|M4M5|，求解如下方程组计算摇臂与翻斗缸间铰点M5：，其中，，求解摇臂相关的其它点的位置，拉杆与摇臂间铰点M3：，其中，矩阵T2满足，同理可得摇臂质心O3：，根据|M1M2|、|M2M3|求解如下方程组计算铲斗与拉杆间铰点M2：，其中，，求解拉杆和铲斗上的其它点，拉杆质心O2：，其中矩阵T3满足，铲斗质心O1点：，其中矩阵T4满足，计算各构件的转动角度，铲斗转动角度：，拉杆转动角度：，摇臂转动角度：，动臂转动角度：，计算转向后各铰点、质心的实际位置，以M1点为例，步骤基于牛顿欧拉法建立装载机工作装置动力学模型，具体步骤为：1）对各个构件质心坐标求二阶导，得到各个构件在三个方向上的平移加速度ai_xk+1、ai_yk+1、ai_zk+1；对各个构件转动角度、/＞、/＞、/＞求二阶导，以铲斗为例，其在三个方向上的角加速度为：，利用海伦公式计算翻斗缸液压力F1在摇臂质心O3处的力臂L1、翻斗缸液压力F2在动臂质心O4处的力臂L2计算翻斗缸液压力在三个坐标轴方向上的方向余弦cosx1、cosy1和cosz1；计算表示动臂缸液压力在三个坐标轴方向上的方向余弦cosx2、cosy2和cosz2；2）利用牛顿欧拉法，构建如下的动力学方程：，其中，M为24×17矩阵，，，，/＞，，，，/＞，，，，X为17×1矩阵，，，/＞，，，N为24×1矩阵，，，，，根据装载机工作装置动力学建模方法，在MATLAB中的Simulink中搭建模型，采用定步长求解器，步长大小1ms，与商业多体动力学软件计算结果做对比，结果如图4-图6，以及图7-图8所示。由此可以看出基于本发明实施例中的动力学模型更准确。步骤获取翻斗缸长度、动臂缸长度和前车架转动角度；步骤将所述翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；对所述翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；步骤将铲斗位置的计算值作为反馈信号，结合PID等控制算法，实现对铲斗轨迹的闭环控制；基于翻斗缸活塞速度和动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动工作装置，起到节能效果。本发明实施例中根据装载机工作装置中各构件间的连接关系，结合构件长度这一信息，得到各个铰点、各构件质心坐标的解析表达式，无需进行数值迭代，因而相比于现有技术其计算效率高，实时性好，可用于实现对装载机的闭环控制，还可用于装载机的HIL测试，提高产品开发效率，缩短产品开发周期，节省研发成本。实现对装载机的闭环控制。实施例2基于与实施例1相同的发明构思，本发明实施例中提供了一种装载机工作装置的控制装置，所述装载机工作装置包括翻斗缸、动臂缸、前车架和若干个铰点，如图2所述，所述控制装置包括：获取模块，用于获取翻斗缸长度、动臂缸长度和前车架转动角度；在具体实施过程，所述翻斗缸长度、动臂缸长度和前车架转动角度由对应的传感器去采集；第一计算模块，用于对所述翻斗缸长度和动臂缸长度进行微分计算，得到翻斗缸活塞速度和动臂缸活塞速度；第二计算模块，用于将所述翻斗缸长度、动臂缸长度和前车架转动角度输入至预先建立好的装载机工作装置动力学模型中，计算得到铲斗位置、翻斗缸液压力和动臂缸液压力；控制模块，包含铲斗轨迹控制模块和功率匹配控制模块，所述铲斗轨迹控制模块用于将计算得到的铲斗位置作为反馈信号，结合闭环控制算法，对铲斗轨迹进行闭环控制；所述功率匹配模块用于基于计算得到的翻斗缸活塞速度、动臂缸活塞速度、翻斗缸液压力和动臂缸液压力，控制动力系统输出相应大小的功率来驱动装载机工作装置，起到节能效果。其余部分均与实施例1相同。实施例3基于与实施例1相同的发明构思，本发明实施例中提供了一种装载机工作装置动力学建模系统，包括存储介质和处理器；所述存储介质用于存储指令；所述处理器用于根据所述指令进行操作以执行实施例1中任一项所述的方法。本领域内的技术人员应明白，本申请的实施例可提供为方法、系统、或计算机程序产品。因此，本申请可采用完全硬件实施例、完全软件实施例、或结合软件和硬件方面的实施例的形式。而且，本申请可采用在一个或多个其中包含有计算机可用程序代码的计算机可用存储介质上实施的计算机程序产品的形式。本申请是参照根据本申请实施例的方法、设备、和计算机程序产品的流程图和／或方框图来描述的。应理解可由计算机程序指令实现流程图和／或方框图中的每一流程和／或方框、以及流程图和／或方框图中的流程和／或方框的结合。可提供这些计算机程序指令到通用计算机、专用计算机、嵌入式处理机或其他可编程数据处理设备的处理器以产生一个机器，使得通过计算机或其他可编程数据处理设备的处理器执行的指令产生用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的装置。这些计算机程序指令也可存储在能引导计算机或其他可编程数据处理设备以特定方式工作的计算机可读存储器中，使得存储在该计算机可读存储器中的指令产生包括指令装置的制造品，该指令装置实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能。这些计算机程序指令也可装载到计算机或其他可编程数据处理设备上，使得在计算机或其他可编程设备上执行一系列操作步骤以产生计算机实现的处理，从而在计算机或其他可编程设备上执行的指令提供用于实现在流程图一个流程或多个流程和／或方框图一个方框或多个方框中指定的功能的步骤。以上结合附图对本发明的实施例进行了描述，但是本发明并不局限于上述的具体实施方式，上述的具体实施方式仅仅是示意性的，而不是限制性的，本领域的普通技术人员在本发明的启示下，在不脱离本发明宗旨和权利要求所保护的范围情况下，还可做出很多形式，这些均属于本发明的保护之内。以上显示和描述了本发明的基本原理和主要特征和本发明的优点。本行业的技术人员应该了解，本发明不受上述实施例的限制，上述实施例和说明书中描述的只是说明本发明的原理，在不脱离本发明精神和范围的前提下，本发明还会有各种变化和改进，这些变化和改进都落入要求保护的本发明范围内。本发明要求保护范围由所附的权利要求书及其等效物界定。
