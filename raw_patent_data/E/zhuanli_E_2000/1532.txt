标题title
电泵井的智能诊断方法、装置、存储介质及服务器
摘要abst
本申请公开了一种电泵井的智能诊断方法、装置、存储介质及服务器。该智能诊断方法包括：接收采集得到的电泵井实时运行参数；对所述电泵井实时运行参数执行预处理操作；基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；参照特征‑故障表确定与所述多个变化趋势特征相对应的第一故障类型。本申请解决了由于技术人员依据描绘的电流卡片形态进行诊断造成的数据考虑不充分，诊断结果可靠性差，且诊断速度慢的技术问题。
权利要求书clms
1.一种电泵井的智能诊断方法，其特征在于，包括：接收采集得到的电泵井实时运行参数；对所述电泵井实时运行参数执行预处理操作；基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。2.根据权利要求1所述的智能诊断方法，其特征在于，接收采集得到的电泵井实时运行参数之后还包括：根据预设周期内的多个电泵井实时运行参数中的电流参数和预设的卡片模板，绘制实测电流卡片；将所述实测电流卡片输入预先训练好的CNN工况诊断模型，得到第二故障类型。3.根据权利要求2所述的智能诊断方法，其特征在于，所述CNN工况诊断模型的训练过程包括：获取标记有故障类型的样本电流卡片集；对所述样本电流卡片集中的样本电流卡片进行灰度转化；将转化后的灰度电流卡片以预设比例划分为训练集和测试集；利用Numpy库中的random.shuffle方法将训练集和测试集执行随机打乱操作；将打乱后的训练集输入CNN工况诊断模型进行训练并优化模型参数，同时通过打乱后的测试集对CNN工况诊断模型进行测试。4.根据权利要求1所述的智能诊断方法，其特征在于，接收采集得到的电泵井实时运行参数之后还包括：判断所述电泵井实时运行参数是否在预设的参数阈值范围内；如果是，则根据预设的参数阈值范围确定报警等级；根据所述报警等级生成报警信息，并以web或短信的形式进行报警。5.根据权利要求1所述的智能诊断方法，其特征在于，参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型之后，或，将所述实测电流卡片输入预先训练好的CNN工况诊断模型，得到第二故障类型之后还包括：根据第一故障类型或第二故障类型自动生成对电泵进行控制的控制信号；通过控制信号控制电泵井的启停或频率调整。6.根据权利要求1所述的智能诊断方法，其特征在于，利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征包括：采用线性回归算法求得多个参数的变化曲线的斜率；判断所述多个参数的变化曲线对应的斜率满足预设SPC规则中的哪条准则，并基于满足的准则确定对应的变化趋势特征。7.根据权利要求1所述的智能诊断方法，其特征在于，参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型包括：确定所述多个变化趋势特征与特征-故障表中每种故障类型所对应的预设特征值的匹配数量；基于预设的故障概率模型和所述匹配数量，计算每种故障类型的故障概率；选择故障概率最大的故障类型作为第一故障类型。8.一种电泵井的智能诊断装置，其特征在于，包括：接收模块，用于接收采集得到的电泵井实时运行参数；执行模块，用于对所述电泵井实时运行参数执行预处理操作；绘制模块，用于基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；判断模块，用于利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；确定模块，用于参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。9.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质中存储有计算机程序，其中，所述计算机程序被设置为运行时执行所述权利要求1至7中任一项所述的电泵井的智能诊断方法。10.一种服务器，包括：存储器和处理器，其特征在于，所述存储器中存储有计算机程序，其中，所述处理器被设置为运行所述计算机程序以执行所述权利要求1至7中任一项所述的电泵井的智能诊断方法。
说明书desc
技术领域本申请涉及电泵井监测领域，具体而言，涉及一种电泵井的智能诊断方法、装置、存储介质及服务器。背景技术气井电泵井的运行电流数据是判断电泵井故障原因的主要依据。以往电泵井故障诊断主要是技术人员依据描绘的电流卡片形态进行诊断，导致并未充分考虑其他运行参数，诊断结果可靠性差，且诊断速度慢。针对相关技术中技术人员依据描绘的电流卡片形态进行诊断造成的数据考虑不充分，诊断结果可靠性差，且诊断速度慢的问题，目前尚未提出有效的解决方案。发明内容本申请的主要目的在于提供一种电泵井的智能诊断方法、装置、存储介质及服务器，以解决技术人员依据描绘的电流卡片形态进行诊断造成的数据考虑不充分，诊断结果可靠性差，且诊断速度慢的问题。为了实现上述目的，根据本申请的一个方面，提供了一种电泵井的智能诊断方法。根据本申请的电泵井的智能诊断方法包括：接收采集得到的电泵井实时运行参数；对所述电泵井实时运行参数执行预处理操作；基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。进一步的，接收采集得到的电泵井实时运行参数之后还包括：根据预设周期内的多个电泵井实时运行参数中的电流参数和预设的卡片模板，绘制实测电流卡片；将所述实测电流卡片输入预先训练好的CNN工况诊断模型，得到第二故障类型。进一步的，所述CNN工况诊断模型的训练过程包括：获取标记有故障类型的样本电流卡片集；对所述样本电流卡片集中的样本电流卡片进行灰度转化；将转化后的灰度电流卡片以预设比例划分为训练集和测试集；利用Numpy库中的random.shuffle方法将训练集和测试集执行随机打乱操作；将打乱后的训练集输入CNN工况诊断模型进行训练并优化模型参数，同时通过打乱后的测试集对CNN工况诊断模型进行测试。进一步的，接收采集得到的电泵井实时运行参数之后还包括：判断所述电泵井实时运行参数是否在预设的参数阈值范围内；如果是，则根据预设的参数阈值范围确定报警等级；根据所述报警等级生成报警信息，并以web或短信的形式进行报警。进一步的，参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型之后，或，将所述实测电流卡片输入预先训练好的CNN工况诊断模型，得到第二故障类型之后还包括：根据第一故障类型或第二故障类型自动生成对电泵进行控制的控制信号；通过控制信号控制电泵井的启停或频率调整。进一步的，利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征包括：采用线性回归算法求得多个参数的变化曲线的斜率；判断所述多个参数的变化曲线对应的斜率满足预设SPC规则中的哪条准则，并基于满足的准则确定对应的变化趋势特征。进一步的，参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型包括：确定所述多个变化趋势特征与特征-故障表中每种故障类型所对应的预设特征值的匹配数量；基于预设的故障概率模型和所述匹配数量，计算每种故障类型的故障概率；选择故障概率最大的故障类型作为第一故障类型。为了实现上述目的，根据本申请的另一方面，提供了一种电泵井的智能诊断装置。根据本申请的电泵井的智能诊断装置包括：接收模块，用于接收采集得到的电泵井实时运行参数；执行模块，用于对所述电泵井实时运行参数执行预处理操作；绘制模块，用于基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；判断模块，用于利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；确定模块，用于参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。为了实现上述目的，根据本申请的另一方面，提供了一种计算机可读存储介质。根据本申请的计算机可读存储介质，所述计算机可读存储介质中存储有计算机程序，其中，所述计算机程序被设置为运行时执行所述的电泵井的智能诊断方法。为了实现上述目的，根据本申请的另一方面，提供了一种服务器。根据本申请的服务器，包括：存储器和处理器，所述存储器中存储有计算机程序，其中，所述处理器被设置为运行所述计算机程序以执行所述的电泵井的智能诊断方法。在本申请实施例中，采用智能诊断电泵井的方式，通过接收采集得到的电泵井实时运行参数；对所述电泵井实时运行参数执行预处理操作；基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。达到了机器基于多个运行参数进行智能诊断的目的，从而实现了充分考虑各方面数据，有效提升诊断结果可靠性，且有效提高诊断速度的技术效果，进而解决了由于技术人员依据描绘的电流卡片形态进行诊断造成的数据考虑不充分，诊断结果可靠性差，且诊断速度慢的技术问题。附图说明构成本申请的一部分的附图用来提供对本申请的进一步理解，使得本申请的其它特征、目的和优点变得更明显。本申请的示意性实施例附图及其说明用于解释本申请，并不构成对本申请的不当限定。在附图中：图1是根据本申请实施例的电泵井的智能诊断方法的流程示意图；图2是根据本申请实施例的电泵井的智能诊断装置的结构示意图；图3是根据本申请实施例的基于GIS地图的井位坐标导航示意图；图4是根据本申请实施例的根据时间与参数的曲线示意图；图5是根据本申请实施例的相应时段的电流卡片示意图；图6-图6是根据本申请实施例的不同故障对应的电流卡片示意图；其中，图6为正常工况实测电流样本图，图6为过载停机实测电流样本图，图6为供液不足实测电流样本图，图6为气体影响实测电流样本图，图6为频繁启停实测电流样本图，图6为出砂实测电流样本图，图6为气锁实测电流样本图，图6为负载增加实测电流样本图，图6为卡泵停机实测电流样本图，图6为电压波动实测电流样本图;图7是根据本申请实施例的不同故障对应的电流卡片示意图；图8-图8是根据本申请实施例的不同时间间隔的电流卡片示意图；其中，图8为间隔是0.5小时的电流卡片图，图8为间隔是1小时的电流卡片图，图8为间隔是1.5小时的电流卡片图，图8为间隔是2小时的电流卡片图，图8为间隔是2.5小时的电流卡片图，图8为间隔是3小时的电流卡片图;图9是根据本申请实施例的阈值设置界面示意图；图10是根据本申请实施例的阈值报警界面示意图；图11是根据本申请实施例的电泵井启停控制界面示意图；图12是根据本申请实施例的电泵井频率调整界面示意图。具体实施方式为了使本技术领域的人员更好地理解本申请方案，下面将结合本申请实施例中的附图，对本申请实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本申请一部分的实施例，而不是全部的实施例。基于本申请中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都应当属于本申请保护的范围。需要说明的是，本申请的说明书和权利要求书及上述附图中的术语“第一”、“第二”等是用于区别类似的对象，而不必用于描述特定的顺序或先后次序。应该理解这样使用的数据在适当情况下可以互换，以便这里描述的本申请的实施例。此外，术语“包括”和“具有”以及他们的任何变形，意图在于覆盖不排他的包含，例如，包含了一系列步骤或单元的过程、方法、系统、产品或设备不必限于清楚地列出的那些步骤或单元，而是可包括没有清楚地列出的或对于这些过程、方法、产品或设备固有的其它步骤或单元。在本申请中，术语“上”、“下”、“左”、“右”、“前”、“后”、“顶”、“底”、“内”、“外”、“中”、“竖直”、“水平”、“横向”、“纵向”等指示的方位或位置关系为基于附图所示的方位或位置关系。这些术语主要是为了更好地描述本发明及其实施例，并非用于限定所指示的装置、元件或组成部分必须具有特定方位，或以特定方位进行构造和操作。并且，上述部分术语除了可以用于表示方位或位置关系以外，还可能用于表示其他含义，例如术语“上”在某些情况下也可能用于表示某种依附关系或连接关系。对于本领域普通技术人员而言，可以根据具体情况理解这些术语在本发明中的具体含义。此外，术语“安装”、“设置”、“设有”、“连接”、“相连”、“套接”应做广义理解。例如，可以是固定连接，可拆卸连接，或整体式构造；可以是机械连接，或电连接；可以是直接相连，或者是通过中间媒介间接相连，又或者是两个装置、元件或组成部分之间内部的连通。对于本领域普通技术人员而言，可以根据具体情况理解上述术语在本发明中的具体含义。需要说明的是，在不冲突的情况下，本申请中的实施例及实施例中的特征可以相互组合。下面将参考附图并结合实施例来详细说明本申请。根据本发明实施例，提供了一种电泵井的智能诊断方法，如图1所示，该方法包括如下的步骤S101至步骤S105：步骤S101、接收采集得到的电泵井实时运行参数；电泵井实时运行参数包括但不限于，流量、压力、温度、振动和电流。本实施例中，井场现有的RTU采集了流量、压力、温度等数据；软件通过ModbusTcp访问RTU的寄存器地址，读取相关的数据。在一些示例中，潜油泵传感器通过电力载波的方式将信号传输到地面；地面接受终端通过解调制将信号转变为数据信号，以对外提供Modbus通讯。在一些示例中，通过Modbus 与电力保护仪通讯，获取A,B，C三项电流、三项电压、功率因素等；通过Modbus与变频器通讯，控制变频器的启动与关闭。RTU通过ModbusTcp与变频柜PLC通讯，以从RTU读取数据并本地缓存，最后通过软件读取缓存中的数据。在一些示例中，可以按照电泵井位置分别以结构化的形式存储上述的数据，并基于这些数据分别生成相应位置电泵井的历史数据。在一些示例中，如图3所示，构建了不同位置处每一项历史数据和地图上的位置之间的关联关系，生成基于GIS地图的井位坐标导航，以直观的在大地坐标显示所有井；根据单井当前状态以不同颜色来显示图标，比如：状态未知白色图标，正常运行绿色图标，停井红色图标。在一些示例中，如图4所示，可根据时间轴显示采集到的不同参数的曲线和表格，曲线可以通过勾选确定显示哪一个或哪几个参数。通过选择不同的时间点可查看任意时间点或者时间段的气井信息。曲线和表格可以进行下载保存。曲线和表格配置了查询功能，可通过操作查全部参数，也可通过操作查单个参数。步骤S102、对所述电泵井实时运行参数执行预处理操作；对所述电泵井实时运行参数执行预设的异常数据剔除、数据插值补全和数据标准化处理操作。在一种具体的实施方式中，电泵机组多传感器的数据值往往都是有一定的运行区间，当数据值超过正常区间，将正常区间之外的数据进行剔除，即为异常数据剔除。例如泵入口压力大于泵出口压力、电压值低于800V、电流值小于0A、井口油压小于井口回压、泵入口压力小于0MPa、泵入口压力小于0MPa、井口温度大于100℃等，这些数据可以列为异常数据，并直接剔除此条数据。在一种具体的实施方式中，电泵井的工作参数可以达到秒级的采集频次，但是由于设备原因和人为原因导致数据缺失。设备原因是由于机械设备导致的数据收集或保存失败造成的数据缺失，比如数据存储的失败，存储器损坏，传感器故障导致某段时间数据未能收集。人为原因是由于人的主观失误、历史局限或有意隐瞒造成数据缺失，例如产液量不能及时的上报等。为了保障数据的时间序列完整性，有必要进行数据插值补全。常用的缺失值填充方法有平均数、中位数、众数、最大值、最小值、固定值、最近邻插值等。在一些实施例中，当缺失数据基本呈对称分布时，可以计算其附近一段时间的平均数或中位数填充，而当数据不对称时采用中位数填充。在一些实施例中，常量填充为用同一个常量替换缺失值，但该填充可靠性不高。在一些实施例中，估计值填充为根据数据类型的不同，运用回归分析、预测等方法估计缺失值。优选的采用最近邻插值方法，即缺失值等于离它所映射到的位置最近的输入参数值。在一种具体的实施方式中，数据标准化处理是数据挖掘的一项基础工作，不同评价指标往往具有不同的量纲和量纲单位，若直接输入网络进行训练，会使各层输出的误差变大，这样的情况会影响到数据分析的结果，为了消除指标之间的量纲影响，需要进行数据标准化处理，以解决数据指标之间的可比性。原始数据经过数据标准化处理后，各指标处于同一数量级，适合进行综合对比评价。数据标准化常用方法有：min-max标准化、z分数规范化、小数定标规范化、atan函数转换、log函数转换、Z-score标准化等。在一些实施例中，最小-最大标准化为对原数据做线性变换，设是气井的某一个指标，其最大值和最小值分别为/＞和/＞，/＞为第/＞个气井的/＞的属性值，则规范化后的值/＞的计算见下式：/＞,在一些实施例中，分数规范化为使用某参数的平均值和标准化做规范化处理，见下式：其中，/＞为某一生产参数/＞的平均值；/＞为参数/＞的标准差。在一些实施例中，小数缩放为在原始数据的基础上移动其小数点。移动某属性的值的小数点，使变化后的值的绝对值小于1，可表示为公式：其中，/＞为使/＞的最小整数。步骤S103、基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；预设了时间窗口，使得处理器在判断达到了该时间窗口后，基于先前采集的每个电泵井实时运行参数绘制时间和参数的变化曲线，为后续的判断提供数据支持。步骤S104、利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征包括：采用线性回归算法求得多个参数的变化曲线的斜率；判断所述多个参数的变化曲线对应的斜率满足预设SPC规则中的哪条准则，并基于满足的准则确定对应的变化趋势特征。具体地，对数据进行预处理后，为了能够挖掘电潜泵井不同故障发生时的不同参数变化规律，需要对特征参数进行斜率计算，选择特定时间窗口内的数据利用线性回归获取斜率，根据斜率的大小判断出趋势的变化情况，再查表判断出对应的变化趋势特征。实现了智能确定变化趋势特征，进而为智能确定故障类型提供数据支持。SPC准则在应用于电潜泵故障诊断的过程中，不仅希望能够对运行参数的异常趋势进行判别，还希望能够具体描述其变化趋势，所以对标准的SPC准则稍作修改，且将八条规则拆分成十三个准则，五类趋势特征。SPC判断准则参见下表：步骤S105、参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。在电泵产液过程中，由于工作环境的温度、压力较高，抽汲的液体中含气和含砂量较大，再加上电泵自身的结构比较复杂，其工作性能受到多方面的因素影响，经常会发生各种故障，使得电泵的故障呈现出多样性、多态性，从现场电泵的使用情况来看，其故障主要表现为轴断、管柱漏失、泵入口堵、气体影响、叶轮磨损、泵反转、供液不足、出砂、气锁、泵内堵塞和正常。基于此，预先构建了特征-故障表。如下表所示：其中：“2”—突然上升；“1”—缓慢上升；“0”—稳定不变；“-1”：缓慢下降；“-2”：突然下降。具体地，参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型包括：确定所述多个变化趋势特征与特征-故障表中每种故障类型所对应的预设特征值的匹配数量；基于预设的故障概率模型和所述匹配数量，计算每种故障类型的故障概率；选择故障概率最大的故障类型作为第一故障类型。实现结合特征-故障表综合不同特征参数变化情况进行模式匹配，不同特征参数趋势匹配的个数为n，利用下式计算特定时间窗口内不同故障的概率值，选择最大故障概率值所对应的工况类型为当前故障类型。式中：P为特定时间窗口内不同故障的概率值；n为特定时间窗口内不同特征参数趋势匹配的个数；m为当前电泵井能够采集到的特征参数种类数。从以上的描述中，可以看出，本发明实现了如下技术效果：在本申请实施例中，采用智能诊断电泵井的方式，通过接收采集得到的电泵井实时运行参数；对所述电泵井实时运行参数执行预处理操作；基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。达到了机器基于多个运行参数进行智能诊断的目的，从而实现了充分考虑各方面数据，有效提升诊断结果可靠性，且有效提高诊断速度的技术效果，进而解决了由于技术人员依据描绘的电流卡片形态进行诊断造成的数据考虑不充分，诊断结果可靠性差，且诊断速度慢的技术问题。根据本发明实施例，优选的，接收采集得到的电泵井实时运行参数之后还包括：根据预设周期内的多个电泵井实时运行参数中的电流参数和预设的卡片模板，绘制实测电流卡片；将所述实测电流卡片输入预先训练好的CNN工况诊断模型，得到第二故障类型。如图5所示，可以通过操作调用相应时段的电流卡片，电流卡片上记录的电流值反映了潜油电机的工作电流随时间变化的关系，因此电流卡片上记载的电流变化趋势也反映着井下电泵机组的运行情况。本实施例中，井常见的故障模式主要以下几种：机组正常运行、电源电压波动、气体影响、泵抽空、供液不足、气井含气、频繁起动、气井含杂质、机组欠载、机组过载、欠载保护失灵、延时太短、负载波动等。在一些实施例中，如图6为正常工况实测电流样本图。参照该图可以知晓，电泵机组在正常运行时，电流值接近电机的额定电流，即使电流发生波动，也略高于或低于额定电流，仍在正常波动范围之内，电流卡片记录的是一条光滑的对称曲线。在一些实施例中，如图6为过载停机实测电流样本图。参照该图可以知晓，发生过载停机时，刚启动时电机电流值略低于额定值，随后电泵逐渐正常运行，恢复为正常电流；最后电流逐渐升高超过电机的过载电流，导致过载停机。在一些实施例中，如图6为供液不足实测电流样本图。参照该图可以知晓，在泵机组启动时，环形液面较高，液柱压力下降，电流值略高于正常值；过段时间泵排量接近设计要求，电流值恢复正常值；随着电泵机组运行，泵排量小于额定排量，电流值降低，液面接近泵吸入口,工作载荷降低，机组欠载停机。在泵机组再次运行时，将会重复上述过程。在一些实施例中，如图6为气体影响实测电流样本图。参照该图可以知晓，当流体中含有大量气体时，游离气占据泵的部分空间，使泵的负载不稳定，电流值有规律的长期波动，波动周期和幅度几乎相同，波动时间很长，但不会造成欠载停机。在一些实施例中，如图6为频繁启停实测电流样本图。参照该图可以知晓，当电泵启动时，机组载荷很快下降，电机负荷变小，电流值降到欠载电流以下，导致停机发生，经过一段时间再重启，电流曲线将呈周期性波动。在一些实施例中，如图6为出砂实测电流样本图。参照该图可以知晓，当电泵井发生出砂时，由于电泵机组载荷增大，导致电流值略高于电机正常工作电流；当出砂严重时，电流值会高于电机的过载电流引起过载停机。在一些实施例中，如图6为气锁实测电流样本图。参照该图可以知晓，当电泵内含有气体过多，将会出现气锁，游离气导致泵机组的工作电流减小并且存在有一定的波动特征，当动液面接近泵吸入口，电流值快速下降导致电泵欠载停机，在电泵重新启动过程中，电流卡片重复这个变化过程。在一些实施例中，如图6为负载增加实测电流样本图。参照该图可以知晓，当电泵机组启动后，运行一段时间后电流值突然下降，一直降到接近空载电流为止，严重时，在空载条件下运行一段时间突然欠载停机。在一些实施例中，如图6为卡泵停机实测电流样本图。参照该图可以知晓，卡泵时电泵无法正常工作，电流值波动并不断增加，严重情况下，增加到过载电流造成停机。在一些实施例中，如图6为电压波动实测电流样本图。参照该图可以知晓，电源电压不稳定时，将导致电压波动，此时电流值表现为不时的波动。以某作业区实测XXX-01井实时电流数据为例，该作业区实时数据达到秒级采集，但由于数据量过大，存储时仅有1min、30s和20s时间间隔的实时数据。2019年2月11日，XXX-01井实时电流值出现波动，该井电流值每分钟保存一次，3小时的实测电流变化曲线如图7所示，将电流数据归一化后绘制故障前不同时间间隔的电流卡片如图8-图8所示。应用本实施例中的电流卡片工况诊断方法，对XXX-01井实测不同时间间隔的电流卡片进行工况诊断，诊断所得各种工况的相似度如下表：根据图8-图8和上表分析可知，一开始电流比较平稳，所以正常类型的相似度比较高。随着时间增长，电流降低，并且出现了一些波动，符合供液不足的图像特征，因此供液不足的相似度较高。随着时间增长，电流卡片的特征越来越全面，电流卡片诊断的效果越来越准确，气锁类型的诊断相似度不断增加，并最终达到最大，同时供液不足的相似度随着时间间隔增大而减小，最终排在第二，故诊断的结果为气锁类型。因此时间间隔的选取对于电流卡片故障诊断尤其重要，当选取时间间隔较小时，电流卡片形状特征不明显，模型诊断结果影响较大；当时间间隔较大时，电流卡片形状特征全局包络，适合模型诊断，但不能及时发现故障，而且在现场应用过程中还需考虑到设备计算资源，因此在实际应用中应综合考虑现场情况进行选取。本论文选取时间间隔为3小时进行工况诊断，其诊断结果气锁。根据电泵井检修报告发现该井的井下气油比过高，油井出现供液不足，导致泵吸入口处气锁严重，诊断结果与实际情况相符合，进一步体现了人工智能在电泵井工况诊断上的应用前景。根据本发明实施例，优选的，所述CNN工况诊断模型的训练过程包括：获取标记有故障类型的样本电流卡片集；对所述样本电流卡片集中的样本电流卡片进行灰度转化；将转化后的灰度电流卡片以预设比例划分为训练集和测试集；利用Numpy库中的random.shuffle方法将训练集和测试集执行随机打乱操作；将打乱后的训练集输入CNN工况诊断模型进行训练并优化模型参数，同时通过打乱后的测试集对CNN工况诊断模型进行测试。在机器学习中，卷积神经网络是一种深度前馈人工神经网络。一般地，CNN的基本结构包括2层，其一为特征提取层，每个神经元的输入与前一层的局部接受域相连，并提取该局部的特征，一旦该局部特征被提取后，它与其他特征间的位置关系也随之确定下来；其二是特征映射层，网络的每个计算层由多个特征映射组成，每个特征映射是一个平面，平面上所有神经元的权值相等。特特征映射结构采用影响函数核小的sigmoid函数作为卷积网络的激活函数，使得特征映射具有位移不变性。此外，由于一个映射面上的神经元共享权值，因而减少了网络自由参数的个数。卷积神经网络中的每一个卷积层都紧跟着一个用来求局部平均与二次提取的计算层，这种特有的两次特征提取结构减小了特征分辨率。通过卷积-池化过程完成图形特征抽取后，最后使用全链接的神经网络进行样本的学习，将知识以权值和阈值的形式存储在网络中，网络的输入是被诊断对象的征兆即特征值，输出则表示发生故障类型的概率值，通过训练逐层修改权值和阈值获得均衡收敛，使网络的分类性能收敛到最佳点。在卷积神经网络的结构设计中，需要确定的模型结构及参数很多。系统将采用卷积神经网络模型，该模型由输入层、五个卷积层、五个激活层、五个池化层、一个全连接层和输出层组成。由于交叉熵能够评估当前训练得到的概率分布与真实分布的差异情况，准确率是最常用的分类性能指标，选择多分类交叉熵损失函数计算模型损失值，多分类准确率作为评估模型分类指标。卷积神经网络模型的优化主要通过调整卷积神经网络的结构，包括卷积层的结构及后面全连接层的结构，还有设置每层网络的漏失节点比例、激活函数类型、批量标准化、添加惩罚项、设置动量、定义损失函数类型等来实现。通过不断地调整参数，来达到更好的训练效果。本方法根据建立的10种故障电流卡片数据集，每种故障100种变化情况的电流卡片作为数据集，在对电流卡片进行卷积神经网络诊断时，只有电流值进行变化，不必对颜色信息进行保留，同时为了减少卷积过程中的参数计算量，将电流卡片数据集进行灰度转化。根据转化后的灰度电流卡片以4:1的比例将电流卡片数据集划分为训练集和测试集，为了保证数据的随机性，利用Numpy库中的random.shuffle方法将训练集和测试集进行随机打乱操作，最终得到800个训练集，200个测试集。将随机打乱后的训练集作为输入层，结合建立的工况诊断模型对电流卡片进行诊断，并对电流卡片诊断模型进行优化，其对应的优化参数如下表：根据本发明实施例，优选的，接收采集得到的电泵井实时运行参数之后还包括：判断所述电泵井实时运行参数是否在预设的参数阈值范围内；如果是，则根据预设的参数阈值范围确定报警等级；根据所述报警等级生成报警信息，并以web或短信的形式进行报警。如图9所示，对每口井进行阈值设置，管理人员可以根据经验及历史数据对每口井的每个参数进行单独设置；根据阈值对数据进行实时监测，发现数据超过阈值范围，则进行报警。需要了解的是，报警类别有两种：一种是阈值报警，一种是趋势报警，且阈值分为4个报警等级，高报，高高报，低报，低低报。还可以人工设置在某个时长内，某个值的增加或者降低的百分比；比如A相电流在5分钟之内，变化超过5%进行报警。需要了解的是，如图10所示，所有阈值报警，在web页可以查询；低低报和高高报发送短信。在一些实施例中，电流阈值可以设置为0，电流从有数值到变为0，变0之前电压范围是800到1500，认为停泵，30S后复核一次，如果电流依然为0，确认停泵，发送短信，如果不为0，忽略。在一些实施例中，电压阈值可以设置为1.5倍的额定电压，设置0.8倍额定电压和电流；电压升到之前的1.5倍为过载；电压和电流都降为原来的80%及以下为欠载。短信报警推送功能。根据本发明实施例，优选的，参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型之后，或，将所述实测电流卡片输入预先训练好的CNN工况诊断模型，得到第二故障类型之后还包括：根据第一故障类型或第二故障类型自动生成对电泵进行控制的控制信号；通过控制信号控制电泵井的启停或频率调整。基于第一故障类型或第二故障类型可以实现对电泵井的启停控制或频率调整。具体地，如图11所示，实现启停井控制操作，每行最后列为控制列，点击按钮弹出权限密码框，填写正确，实现启停井，并把信息保存入表。如图12所示，取到井当前频率，实现点击控制按钮输入密码，成功后调频，并保存入表。需要说明的是，在附图的流程图示出的步骤可以在诸如一组计算机可执行指令的计算机系统中执行，并且，虽然在流程图中示出了逻辑顺序，但是在某些情况下，可以以不同于此处的顺序执行所示出或描述的步骤。根据本发明实施例，还提供了一种用于实施上述电泵井的智能诊断方法的装置，如图2所示，该装置包括：接收模块10，用于接收采集得到的电泵井实时运行参数；执行模块20，用于对所述电泵井实时运行参数执行预处理操作；绘制模块30，用于基于预处理后的电泵井实时运行参数绘制预设时间窗口内的多个参数的变化曲线；判断模块40，用于利用预设的趋势判断算法判断出所述多个参数的变化曲线的多个变化趋势特征；确定模块50，用于参照特征-故障表确定与所述多个变化趋势特征相对应的第一故障类型。实现了与电泵井的智能诊断方法相同的技术效果。显然，本领域的技术人员应该明白，上述的本发明的各模块或各步骤可以用通用的计算装置来实现，它们可以集中在单个的计算装置上，或者分布在多个计算装置所组成的网络上，可选地，它们可以用计算装置可执行的程序代码来实现，从而，可以将它们存储在存储装置中由计算装置来执行，或者将它们分别制作成各个集成电路模块，或者将它们中的多个模块或步骤制作成单个集成电路模块来实现。这样，本发明不限制于任何特定的硬件和软件结合。以上所述仅为本申请的优选实施例而已，并不用于限制本申请，对于本领域的技术人员来说，本申请可以有各种更改和变化。凡在本申请的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本申请的保护范围之内。
